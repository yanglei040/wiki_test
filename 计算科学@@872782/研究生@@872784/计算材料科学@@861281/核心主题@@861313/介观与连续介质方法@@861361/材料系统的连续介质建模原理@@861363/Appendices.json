{"hands_on_practices": [{"introduction": "本练习为描述材料变形奠定了基础。在分析材料如何响应力之前，我们需要一个精确的数学框架来量化其形状变化。此实践从一个给定的变形映射出发，计算格林-拉格朗日应变张量（Green-Lagrange strain tensor）和张量不变量等基本运动学量，这是连续介质力学中的一项核心技能 [@problem_id:3440412]。", "problem": "考虑一个连续体的均匀有限变形，其映射关系为 $\\varphi:\\Omega_0 \\subset \\mathbb{R}^3 \\to \\Omega \\subset \\mathbb{R}^3$，该映射将参考构形中位置向量为 $X$ 的物质点映至当前位置 $x=\\varphi(X)=\\text{diag}(\\lambda_1,\\lambda_2,\\lambda_3)\\,X$，其中 $\\lambda_1$、$\\lambda_2$ 和 $\\lambda_3$ 为正的主伸长。从连续介质力学的运动学基础出发，即变形梯度 $F=\\nabla_X \\varphi$、右柯西-格林变形张量 $C=F^{\\top}F$、左柯西-格林变形张量 $B=FF^{\\top}$ 以及格林-拉格朗日应变张量 $E=\\frac{1}{2}(C-I)$（其中 $I$ 是单位张量）的定义，推导 $E$ 和 $B$ 各分量关于 $\\lambda_1$、$\\lambda_2$ 和 $\\lambda_3$ 的解析表达式。然后，利用 $C$ 的不变量的定义，即 $I_1=\\text{tr}(C)$ 和 $I_2=\\frac{1}{2}\\big((\\text{tr}\\,C)^2-\\text{tr}(C^2)\\big)$，推导 $I_1$ 和 $I_2$ 关于 $\\lambda_1$、$\\lambda_2$ 和 $\\lambda_3$ 的表达式。\n\n将最终答案以一个包含 $\\big(E_{11},E_{22},E_{33},B_{11},B_{22},B_{33},I_1,I_2\\big)$ 的行矩阵形式给出，该矩阵完全用 $\\lambda_1$、$\\lambda_2$ 和 $\\lambda_3$ 表示。不需要数值近似或四舍五入。", "solution": "所给问题是非线性连续介质力学中的一个标准练习。有效性检查确认了其有效性。\n\n**1. 科学依据：** 该问题牢固地植根于已建立的有限变形运动学理论。所有术语——变形梯度、柯西-格林张量、格林-拉格朗日应变和张量不变量——都是标准的且定义正确。\n**2. 适定性：** 该问题是自洽的，为所有待求量提供了特定的变形映射和清晰的定义。它导向一个唯一、稳定且有意义的解。\n**3. 客观性：** 该问题以精确的数学语言陈述，没有任何主观性或模糊性。\n\n因此，该问题是有效的，我们可以进行求解。\n\n参考构形中物质点的位置向量为 $X = X_1 e_1 + X_2 e_2 + X_3 e_3$，当前构形中的位置向量为 $x = x_1 e_1 + x_2 e_2 + x_3 e_3$。变形映射 $\\varphi$ 由 $x=\\text{diag}(\\lambda_1,\\lambda_2,\\lambda_3)\\,X$ 给出。其分量形式为：\n$$x_1 = \\lambda_1 X_1$$\n$$x_2 = \\lambda_2 X_2$$\n$$x_3 = \\lambda_3 X_3$$\n\n首先，我们计算变形梯度张量 $F$，其分量定义为 $F_{ij} = \\frac{\\partial x_i}{\\partial X_j}$。\n$$F_{11} = \\frac{\\partial x_1}{\\partial X_1} = \\lambda_1, \\quad F_{12} = \\frac{\\partial x_1}{\\partial X_2} = 0, \\quad F_{13} = \\frac{\\partial x_1}{\\partial X_3} = 0$$\n$$F_{21} = \\frac{\\partial x_2}{\\partial X_1} = 0, \\quad F_{22} = \\frac{\\partial x_2}{\\partial X_2} = \\lambda_2, \\quad F_{23} = \\frac{\\partial x_2}{\\partial X_3} = 0$$\n$$F_{31} = \\frac{\\partial x_3}{\\partial X_1} = 0, \\quad F_{32} = \\frac{\\partial x_3}{\\partial X_2} = 0, \\quad F_{33} = \\frac{\\partial x_3}{\\partial X_3} = \\lambda_3$$\n以矩阵形式表示，变形梯度 $F$ 是一个对角张量：\n$$F = \\begin{pmatrix} \\lambda_1  0  0 \\\\ 0  \\lambda_2  0 \\\\ 0  0  \\lambda_3 \\end{pmatrix}$$\n\n接下来，我们计算右柯西-格林变形张量 $C = F^{\\top}F$。由于 $F$ 是一个对角矩阵，其转置 $F^{\\top}$ 等于 $F$。\n$$C = F^{\\top}F = F^2 = \\begin{pmatrix} \\lambda_1  0  0 \\\\ 0  \\lambda_2  0 \\\\ 0  0  \\lambda_3 \\end{pmatrix} \\begin{pmatrix} \\lambda_1  0  0 \\\\ 0  \\lambda_2  0 \\\\ 0  0  \\lambda_3 \\end{pmatrix} = \\begin{pmatrix} \\lambda_1^2  0  0 \\\\ 0  \\lambda_2^2  0 \\\\ 0  0  \\lambda_3^2 \\end{pmatrix}$$\n\n利用 $C$ 的这个结果，我们推导格林-拉格朗日应变张量 $E = \\frac{1}{2}(C-I)$ 的分量，其中 $I$ 是二阶单位张量。\n$$E = \\frac{1}{2} \\left( \\begin{pmatrix} \\lambda_1^2  0  0 \\\\ 0  \\lambda_2^2  0 \\\\ 0  0  \\lambda_3^2 \\end{pmatrix} - \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} \\right) = \\begin{pmatrix} \\frac{1}{2}(\\lambda_1^2 - 1)  0  0 \\\\ 0  \\frac{1}{2}(\\lambda_2^2 - 1)  0 \\\\ 0  0  \\frac{1}{2}(\\lambda_3^2 - 1) \\end{pmatrix}$$\n因此，所求的 $E$ 的对角分量为：\n$$E_{11} = \\frac{1}{2}(\\lambda_1^2 - 1)$$\n$$E_{22} = \\frac{1}{2}(\\lambda_2^2 - 1)$$\n$$E_{33} = \\frac{1}{2}(\\lambda_3^2 - 1)$$\n\n现在，我们计算左柯西-格林变形张量 $B = FF^{\\top}$。如前所述，对于 $F$ 的这种特定对角形式，我们有 $F^{\\top}=F$。因此，$B$ 与 $C$ 相同。\n$$B = FF^{\\top} = F^2 = \\begin{pmatrix} \\lambda_1^2  0  0 \\\\ 0  \\lambda_2^2  0 \\\\ 0  0  \\lambda_3^2 \\end{pmatrix}$$\n所求的 $B$ 的对角分量为：\n$$B_{11} = \\lambda_1^2$$\n$$B_{22} = \\lambda_2^2$$\n$$B_{33} = \\lambda_3^2$$\n\n最后，我们推导 $C$ 的第一和第二主不变量，记为 $I_1$ 和 $I_2$。\n第一不变量 $I_1$ 是 $C$ 的迹。\n$$I_1 = \\text{tr}(C) = C_{11} + C_{22} + C_{33} = \\lambda_1^2 + \\lambda_2^2 + \\lambda_3^2$$\n\n第二不变量 $I_2$ 定义为 $I_2 = \\frac{1}{2}\\big((\\text{tr}\\,C)^2 - \\text{tr}(C^2)\\big)$。\n我们已经求得 $\\text{tr}(C) = I_1$。现在我们需要计算 $\\text{tr}(C^2)$。\n$$C^2 = C \\cdot C = \\begin{pmatrix} \\lambda_1^2  0  0 \\\\ 0  \\lambda_2^2  0 \\\\ 0  0  \\lambda_3^2 \\end{pmatrix} \\begin{pmatrix} \\lambda_1^2  0  0 \\\\ 0  \\lambda_2^2  0 \\\\ 0  0  \\lambda_3^2 \\end{pmatrix} = \\begin{pmatrix} \\lambda_1^4  0  0 \\\\ 0  \\lambda_2^4  0 \\\\ 0  0  \\lambda_3^4 \\end{pmatrix}$$\n$C^2$ 的迹为：\n$$\\text{tr}(C^2) = \\lambda_1^4 + \\lambda_2^4 + \\lambda_3^4$$\n将 $\\text{tr}(C)$ 和 $\\text{tr}(C^2)$ 代入 $I_2$ 的公式中：\n$$I_2 = \\frac{1}{2} \\big( (\\lambda_1^2 + \\lambda_2^2 + \\lambda_3^2)^2 - (\\lambda_1^4 + \\lambda_2^4 + \\lambda_3^4) \\big)$$\n展开平方项：\n$$(\\lambda_1^2 + \\lambda_2^2 + \\lambda_3^2)^2 = (\\lambda_1^2)^2 + (\\lambda_2^2)^2 + (\\lambda_3^2)^2 + 2\\lambda_1^2\\lambda_2^2 + 2\\lambda_1^2\\lambda_3^2 + 2\\lambda_2^2\\lambda_3^2$$\n$$(\\lambda_1^2 + \\lambda_2^2 + \\lambda_3^2)^2 = \\lambda_1^4 + \\lambda_2^4 + \\lambda_3^4 + 2(\\lambda_1^2\\lambda_2^2 + \\lambda_1^2\\lambda_3^2 + \\lambda_2^2\\lambda_3^2)$$\n将此结果代回 $I_2$ 的表达式中：\n$$I_2 = \\frac{1}{2} \\big( [\\lambda_1^4 + \\lambda_2^4 + \\lambda_3^4 + 2(\\lambda_1^2\\lambda_2^2 + \\lambda_1^2\\lambda_3^2 + \\lambda_2^2\\lambda_3^2)] - (\\lambda_1^4 + \\lambda_2^4 + \\lambda_3^4) \\big)$$\n$$I_2 = \\frac{1}{2} \\big( 2(\\lambda_1^2\\lambda_2^2 + \\lambda_1^2\\lambda_3^2 + \\lambda_2^2\\lambda_3^2) \\big)$$\n$$I_2 = \\lambda_1^2\\lambda_2^2 + \\lambda_1^2\\lambda_3^2 + \\lambda_2^2\\lambda_3^2$$\n\n我们已经推导出所有需要的量。现在我们将它们组合成指定的行矩阵作为最终答案。\n各分量为：\n$E_{11} = \\frac{1}{2}(\\lambda_1^2 - 1)$\n$E_{22} = \\frac{1}{2}(\\lambda_2^2 - 1)$\n$E_{33} = \\frac{1}{2}(\\lambda_3^2 - 1)$\n$B_{11} = \\lambda_1^2$\n$B_{22} = \\lambda_2^2$\n$B_{33} = \\lambda_3^2$\n$I_1 = \\lambda_1^2 + \\lambda_2^2 + \\lambda_3^2$\n$I_2 = \\lambda_1^2\\lambda_2^2 + \\lambda_1^2\\lambda_3^2 + \\lambda_2^2\\lambda_3^2$", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{2}(\\lambda_1^{2} - 1)  \\frac{1}{2}(\\lambda_2^{2} - 1)  \\frac{1}{2}(\\lambda_3^{2} - 1)  \\lambda_1^{2}  \\lambda_2^{2}  \\lambda_3^{2}  \\lambda_1^{2} + \\lambda_2^{2} + \\lambda_3^{2}  \\lambda_1^{2}\\lambda_2^{2} + \\lambda_1^{2}\\lambda_3^{2} + \\lambda_2^{2}\\lambda_3^{2} \\end{pmatrix}}\n$$", "id": "3440412"}, {"introduction": "本问题在运动学原理的基础上，深入探讨了本构模型。它要求您应用一个特定的超弹性应变能函数——可压缩Neo-Hookean模型——来确定单轴拉伸材料中的应力。这个练习通过应用边界条件求解材料响应，从而在抽象的材料模型和具体的物理预测之间架起了一座桥梁 [@problem_id:3440421]。", "problem": "一个均匀、各向同性、可压缩的超弹性固体由可压缩的 Neo-Hookean 应变能密度函数来描述\n$$\nW(\\mathbf{B},J) = \\frac{\\mu}{2}\\left(I_{1}-3\\right) - \\mu \\ln J + \\frac{K}{2}\\left(\\ln J\\right)^{2},\n$$\n其中 $\\mu$ 是剪切模量，$K$ 是体积模量，$\\mathbf{F}$ 是变形梯度，$\\mathbf{B}=\\mathbf{F}\\mathbf{F}^{\\top}$ 是左 Cauchy-Green 变形张量，$J=\\det(\\mathbf{F})$ 是变形的雅可比行列式，$I_{1}=\\operatorname{tr}(\\mathbf{B})$ 是 $\\mathbf{B}$ 的第一不变量。超弹性材料的 Cauchy 应力 $\\boldsymbol{\\sigma}$ 是通过标准的基于不变量的关系式从 $W$ 得到的。\n\n考虑沿 $x_{1}$ 方向施加的单轴拉伸，其给定的主拉伸为 $\\lambda0$，因此变形梯度是对角矩阵，\n$$\n\\mathbf{F}=\\operatorname{diag}\\!\\left(\\lambda,\\lambda_{\\perp},\\lambda_{\\perp}\\right),\n$$\n其中 $\\lambda_{\\perp}0$ 是横向拉伸，它会动态调整以满足无牵引力的横向边界条件。假设垂直于 $x_{2}$ 和 $x_{3}$ 的侧面是无牵引力的，即，\n$$\n\\sigma_{22}=0,\\quad \\sigma_{33}=0.\n$$\n仅从运动学度量的定义和给定的应变能函数出发，推导轴向 Cauchy 应力分量 $\\sigma_{11}$ 作为给定轴向拉伸 $\\lambda$ 和材料参数 $\\mu$、$K$ 的函数的闭式解析表达式。你的最终表达式必须消去 $\\lambda_{\\perp}$，并用 $\\lambda$、$\\mu$ 和 $K$ 来表示。如有必要，请用 Lambert W 函数表示你的答案。请将 $\\sigma_{11}$ 的最终表达式以单一解析表达式的形式给出。无需进行数值计算，也无需四舍五入。如果在应用中需要单位，应力单位用帕斯卡 (Pa) 表示，但最终表达式中不要包含单位。", "solution": "该材料是超弹性的，其应变能密度为\n$$\nW(\\mathbf{B},J) = \\frac{\\mu}{2}\\left(I_{1}-3\\right) - \\mu \\ln J + \\frac{K}{2}\\left(\\ln J\\right)^{2}.\n$$\n对于一个用不变量 $\\left(I_{1},J\\right)$ 表示的各向同性超弹性材料，Kirchhoff 应力 $\\boldsymbol{\\tau}=J\\boldsymbol{\\sigma}$ 由下式给出\n$$\n\\boldsymbol{\\tau} = 2\\frac{\\partial W}{\\partial I_{1}}\\,\\mathbf{B} + J\\frac{\\partial W}{\\partial J}\\,\\mathbf{I},\n$$\n其中 $\\mathbf{I}$ 是单位张量，并且已使用了关系式 $\\partial I_{1}/\\partial \\mathbf{B}=\\mathbf{I}$。对于当前的 $W$，\n$$\n\\frac{\\partial W}{\\partial I_{1}} = \\frac{\\mu}{2},\\qquad \\frac{\\partial W}{\\partial J} = -\\frac{\\mu}{J} + \\frac{K}{J}\\ln J.\n$$\n因此，\n$$\n\\boldsymbol{\\tau} = \\mu\\,\\mathbf{B} + \\left(-\\mu + K\\ln J\\right)\\mathbf{I},\n$$\nCauchy 应力为\n$$\n\\boldsymbol{\\sigma} = \\frac{1}{J}\\boldsymbol{\\tau} = \\frac{\\mu}{J}\\mathbf{B} + \\left(-\\frac{\\mu}{J} + \\frac{K\\ln J}{J}\\right)\\mathbf{I} = \\frac{\\mu}{J}\\left(\\mathbf{B}-\\mathbf{I}\\right) + \\frac{K\\ln J}{J}\\mathbf{I}.\n$$\n\n在单轴拉伸下，\n$$\n\\mathbf{F}=\\operatorname{diag}\\!\\left(\\lambda,\\lambda_{\\perp},\\lambda_{\\perp}\\right),\\quad \\mathbf{B}=\\operatorname{diag}\\!\\left(\\lambda^{2},\\lambda_{\\perp}^{2},\\lambda_{\\perp}^{2}\\right),\\quad J=\\lambda\\,\\lambda_{\\perp}^{2}.\n$$\n因此，主 Cauchy 应力为\n\\begin{align*}\n\\sigma_{11} = \\frac{\\mu}{J}\\left(\\lambda^{2}-1\\right) + \\frac{K\\ln J}{J},\\\\\n\\sigma_{22} = \\frac{\\mu}{J}\\left(\\lambda_{\\perp}^{2}-1\\right) + \\frac{K\\ln J}{J},\\\\\n\\sigma_{33} = \\frac{\\mu}{J}\\left(\\lambda_{\\perp}^{2}-1\\right) + \\frac{K\\ln J}{J}.\n\\end{align*}\n无牵引力的横向边界条件要求\n$$\n\\sigma_{22}=\\sigma_{33}=0 \\quad\\Rightarrow\\quad \\frac{\\mu}{J}\\left(\\lambda_{\\perp}^{2}-1\\right) + \\frac{K\\ln J}{J} = 0.\n$$\n两边乘以 $J$ 得到\n$$\nK\\ln J = -\\mu\\left(\\lambda_{\\perp}^{2}-1\\right).\n$$\n使用 $J=\\lambda\\,\\lambda_{\\perp}^{2}$，该关系式变为\n$$\nK\\ln\\!\\left(\\lambda\\,\\lambda_{\\perp}^{2}\\right) = -\\mu\\left(\\lambda_{\\perp}^{2}-1\\right).\n$$\n定义 $x=\\lambda_{\\perp}^{2}0$ 和 $\\alpha=\\mu/K0$。则\n$$\n\\ln\\!\\left(\\lambda x\\right) = -\\alpha\\left(x-1\\right),\n$$\n整理后可得\n$$\n\\ln x + \\ln \\lambda = -\\alpha x + \\alpha \\quad\\Rightarrow\\quad \\ln x = -\\alpha x + \\alpha - \\ln \\lambda.\n$$\n对两边取指数，得到\n$$\nx = \\exp\\!\\left(-\\alpha x\\right)\\exp\\!\\left(\\alpha\\right)\\lambda^{-1},\n$$\n所以\n$$\nx\\,\\exp\\!\\left(\\alpha x\\right) = \\exp\\!\\left(\\alpha\\right)\\lambda^{-1}.\n$$\n两边同乘以 $\\alpha$，并引入由 $\\mathrm{W}(z)\\exp\\!\\left(\\mathrm{W}(z)\\right)=z$ 定义的 Lambert W 函数，我们得到\n$$\n\\alpha x\\,\\exp\\!\\left(\\alpha x\\right) = \\alpha\\,\\exp\\!\\left(\\alpha\\right)\\lambda^{-1} \\quad\\Rightarrow\\quad \\alpha x = \\mathrm{W}\\!\\left(\\alpha\\,\\exp\\!\\left(\\alpha\\right)\\lambda^{-1}\\right).\n$$\n因此，\n$$\nx = \\frac{1}{\\alpha}\\,\\mathrm{W}\\!\\left(\\alpha\\,\\exp\\!\\left(\\alpha\\right)\\lambda^{-1}\\right) = \\frac{K}{\\mu}\\,\\mathrm{W}\\!\\left(\\frac{\\mu}{K}\\,\\exp\\!\\left(\\frac{\\mu}{K}\\right)\\lambda^{-1}\\right).\n$$\n当 $x=\\lambda_{\\perp}^{2}$ 时，雅可比行列式变为\n$$\nJ = \\lambda x = \\lambda\\,\\frac{K}{\\mu}\\,\\mathrm{W}\\!\\left(\\frac{\\mu}{K}\\,\\exp\\!\\left(\\frac{\\mu}{K}\\right)\\lambda^{-1}\\right).\n$$\n在 $\\sigma_{11}$ 的表达式中使用横向平衡关系 $K\\ln J = -\\mu\\left(x-1\\right)$，\n$$\n\\sigma_{11} = \\frac{\\mu}{J}\\left(\\lambda^{2}-1\\right) + \\frac{K\\ln J}{J} = \\frac{\\mu}{J}\\left(\\lambda^{2}-1\\right) - \\frac{\\mu}{J}\\left(x-1\\right) = \\frac{\\mu}{J}\\left(\\lambda^{2}-x\\right).\n$$\n将来自 Lambert W 表达式的 $x$ 和 $J$ 代入，\n\\begin{align*}\n\\sigma_{11} = \\frac{\\mu}{\\lambda\\,\\frac{K}{\\mu}\\,\\mathrm{W}\\!\\left(\\frac{\\mu}{K}\\,\\exp\\!\\left(\\frac{\\mu}{K}\\right)\\lambda^{-1}\\right)}\\left(\\lambda^{2} - \\frac{K}{\\mu}\\,\\mathrm{W}\\!\\left(\\frac{\\mu}{K}\\,\\exp\\!\\left(\\frac{\\mu}{K}\\right)\\lambda^{-1}\\right)\\right)\\\\\n= \\frac{\\mu^{2}}{\\lambda K\\,\\mathrm{W}\\!\\left(\\frac{\\mu}{K}\\,\\exp\\!\\left(\\frac{\\mu}{K}\\right)\\lambda^{-1}\\right)}\\,\\lambda^{2} \\;-\\; \\frac{\\mu^{2}}{\\lambda K\\,\\mathrm{W}\\!\\left(\\frac{\\mu}{K}\\,\\exp\\!\\left(\\frac{\\mu}{K}\\right)\\lambda^{-1}\\right)}\\cdot\\frac{K}{\\mu}\\,\\mathrm{W}\\!\\left(\\frac{\\mu}{K}\\,\\exp\\!\\left(\\frac{\\mu}{K}\\right)\\lambda^{-1}\\right)\\\\\n= \\frac{\\mu^{2}\\lambda}{K\\,\\mathrm{W}\\!\\left(\\frac{\\mu}{K}\\,\\exp\\!\\left(\\frac{\\mu}{K}\\right)\\lambda^{-1}\\right)} \\;-\\; \\frac{\\mu}{\\lambda}.\n\\end{align*}\n这就得到了用给定轴向拉伸 $\\lambda$ 和材料模量 $\\mu$、$K$ 表示的所求的闭式轴向 Cauchy 应力。由于 $\\lambda0$, $\\mu0$ 和 $K0$ 使得宗量为正，物理上相关的解取 Lambert W 函数的主支。", "answer": "$$\\boxed{\\mu\\left(\\frac{\\mu\\,\\lambda}{K\\,\\mathrm{W}\\!\\left(\\frac{\\mu}{K}\\,\\exp\\!\\left(\\frac{\\mu}{K}\\right)\\lambda^{-1}\\right)}-\\frac{1}{\\lambda}\\right)}$$", "id": "3440421"}, {"introduction": "解析解能提供深刻的洞察力，但仅限于简单情况；大多数现实世界的工程问题都需要计算方法。这最后一个实践将指导您通过为单个三角形单元实现有限元法（FEM），将连续介质理论转化为计算工具。您将构建核心组件——刚度矩阵和力向量——并求解位移，从而将抽象的弱形式与实际的数值解直接联系起来 [@problem_id:3440488]。", "problem": "考虑一个二维（$2$D）平面应力状态下的连续体，其小应变、线弹性弱形式通过一个具有三个节点的线性三角形有限元进行离散化。设位移场由节点 $i \\in \\{1,2,3\\}$ 的节点自由度 $u_{ix}$ 和 $u_{iy}$ 表示，应变为位移的对称梯度。材料行为是各向同性的，在平面应力条件下，应力通过线性材料切线矩阵 $C$ 与应变相关联。该矩阵由杨氏模量 $E$（单位：帕斯卡，$\\mathrm{Pa}$）和泊松比 $\\nu$（无量纲）参数化。单元厚度为 $t$ 米（$\\mathrm{m}$）。自然边界条件通过在指定单元边上施加的面力 $\\mathbf{p}$ 来引入，其中 $\\mathbf{p}$ 是一个单位面積上的常数矢量（单位：$\\mathrm{N/m^2}$），沿中面产生的线面力为 $\\mathbf{p}\\,t$（单位：$\\mathrm{N/m}$）。本质（Dirichlet）边界条件施加在选定的节点位移分量上。\n\n您的任务是实现这个单一三角形单元的弱形式并计算：\n- 根据单元域上的线性形函数梯度计算单元应变-位移矩阵 $B$，\n- 根据给定的 $(E,\\nu)$ 计算平面应力下的材料切线矩阵 $C$，\n- 通过在单元域上积分双线性形式来计算单元刚度矩阵 $K$，\n- 根据指定单元边上的面力边界项计算一致节点力向量，\n- 通过代数消元法精确施加 Dirichlet 边界条件，然后求解线性系统 $K\\,u = f$ 以得到节点位移解。\n\n所有几何量均以米（$\\mathrm{m}$）为单位。力以牛顿（$\\mathrm{N}$）为单位。应力以帕斯卡（$\\mathrm{Pa}$）为单位。位移必须以米（$\\mathrm{m}$）报告。不使用角度。您必须在不依赖任何预编码的有限元程序的情况下实现上述内容。\n\n对于下面的每个测试用例，组装单单元系统，施加指定的 Dirichlet 和 Neumann 边界条件，求解节点位移向量 $u = [u_{1x},u_{1y},u_{2x},u_{2y},u_{3x},u_{3y}]^\\top$（单位：米），并报告所要求的标量值。材料模型为平面应力线弹性，您必须将面力 $\\mathbf{p}$ 视为沿指定边均匀分布且在厚度方向上恒定，因此边界积分中使用的总线面力为 $\\mathbf{p}\\,t$（单位：$\\mathrm{N/m}$）。\n\n测试套件：\n- 测试用例 $1$（一般情况）：\n  - 节点坐标（单位：$\\mathrm{m}$）：节点 $1$ 位于 $(x_1,y_1)=(0,0)$，节点 $2$ 位于 $(x_2,y_2)=(1.0,0)$，节点 $3$ 位于 $(x_3,y_3)=(0,1.0)$。\n  - 材料参数：$E=70\\times 10^9\\,\\mathrm{Pa}$，$\\nu=0.33$，厚度 $t=0.01\\,\\mathrm{m}$。\n  - Dirichlet 边界条件：$u_{1x}=0$, $u_{1y}=0$, $u_{2y}=0$。\n  - Neumann 边界条件：沿边 $(2,3)$ 施加均匀面力 $\\mathbf{p}=(5\\times 10^6,\\,0)\\,\\mathrm{Pa}$。\n  - 报告：标量位移 $u_{3x}$（单位：$\\mathrm{m}$）。\n- 测试用例 $2$（承受向下面力的薄单元）：\n  - 节点坐标（单位：$\\mathrm{m}$）：节点 $1$ 位于 $(0,0)$，节点 $2$ 位于 $(2.0,0)$，节点 $3$ 位于 $(0,0.5)$。\n  - 材料参数：$E=200\\times 10^9\\,\\mathrm{Pa}$，$\\nu=0.29$，厚度 $t=1\\times 10^{-4}\\,\\mathrm{m}$。\n  - Dirichlet 边界条件：$u_{1x}=0$, $u_{1y}=0$, $u_{3x}=0$。\n  - Neumann 边界条件：沿边 $(1,2)$ 施加均匀面力 $\\mathbf{p}=(0,\\,-1\\times 10^6)\\,\\mathrm{Pa}$。\n  - 报告：标量位移 $u_{2y}$（单位：$\\mathrm{m}$）。\n- 测试用例 $3$（斜向面力及混合约束）：\n  - 节点坐标（单位：$\\mathrm{m}$）：节点 $1$ 位于 $(0,0)$，节点 $2$ 位于 $(0.5,0)$，节点 $3$ 位于 $(0,0.5)$。\n  - 材料参数：$E=210\\times 10^9\\,\\mathrm{Pa}$，$\\nu=0.30$，厚度 $t=0.02\\,\\mathrm{m}$。\n  - Dirichlet 边界条件：$u_{2x}=0$, $u_{2y}=0$, $u_{1y}=0$。\n  - Neumann 边界条件：沿边 $(1,3)$ 施加均匀面力 $\\mathbf{p}=(2\\times 10^6,\\,2\\times 10^6)\\,\\mathrm{Pa}$。\n  - 报告：欧几里得范数 $\\|u\\|_2$（单位：$\\mathrm{m}$）。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含按测试用例 1 至 3 的顺序排列的结果，形式为逗号分隔的列表并用方括号括起。例如，形如 $[r_1,r_2,r_3]$ 的输出，其中每个 $r_i$ 是一个以米（$\\mathrm{m}$）为单位的浮点数。", "solution": "该问题是有效的，因为它科学地基于连续介质力学和有限元法的原理，具有充分的边界条件以确保唯一解，因此是适定的，并且以客观、正式的语言陈述，提供了所有必要的数据。该问题是计算固体力学中一个标准的、非平凡的练习。\n\n求解过程涉及推导和实现平面应力条件下单个三节点线性三角形有限元的矩阵方程。控制方程为线性系统 $K\\mathbf{d} = \\mathbf{f}$，其中 $K$ 是单元刚度矩阵，$\\mathbf{d}$ 是节点位移向量，$\\mathbf{f}$ 是节点力向量。\n\n首先，我们定义线性三角形单元的几何形状和插值。该单元由三个坐标分别为 $(x_1, y_1)$、$(x_2, y_2)$ 和 $(x_3, y_3)$ 的节点定义。单元内的位移场 $\\mathbf{u}(x,y) = [u_x(x,y), u_y(x,y)]^\\top$ 使用线性形函数 $N_i(x,y)$ 从节点位移 $\\mathbf{d}_i = [u_{ix}, u_{iy}]^\\top$ 插值得到：\n$$\n\\mathbf{u}(x,y) = \\sum_{i=1}^3 N_i(x,y) \\mathbf{d}_i\n$$\n线性三角形的形函数由下式给出：\n$$\nN_i(x,y) = \\frac{1}{2A}(a_i + b_i x + c_i y)\n$$\n其中 $A$ 是三角形的面积，计算如下：\n$$\nA = \\frac{1}{2} \\det \\begin{pmatrix} 1  x_1  y_1 \\\\ 1  x_2  y_2 \\\\ 1  x_3  y_3 \\end{pmatrix} = \\frac{1}{2} [x_1(y_2 - y_3) + x_2(y_3 - y_1) + x_3(y_1 - y_2)]\n$$\n系数 $b_i$ 和 $c_i$ 是节点坐标的函数：\n$b_1 = y_2 - y_3$, $b_2 = y_3 - y_1$, $b_3 = y_1 - y_2$\n$c_1 = x_3 - x_2$, $c_2 = x_1 - x_3$, $c_3 = x_2 - x_1$\n系数 $a_i$ 对于依赖于导数的应变计算不是必需的。\n\n小应变理论的应变分量由位移场的对称梯度给出。在 Voigt 标记法中，应变向量为 $\\boldsymbol{\\epsilon} = [\\epsilon_{xx}, \\epsilon_{yy}, \\gamma_{xy}]^\\top$，其中 $\\gamma_{xy}$ 是工程剪应变。\n$$\n\\epsilon_{xx} = \\frac{\\partial u_x}{\\partial x}, \\quad \\epsilon_{yy} = \\frac{\\partial u_y}{\\partial y}, \\quad \\gamma_{xy} = \\frac{\\partial u_x}{\\partial y} + \\frac{\\partial u_y}{\\partial x}\n$$\n代入插值位移场，我们通过应变-位移矩阵 $B$ 将应变与节点位移向量 $\\mathbf{d} = [u_{1x}, u_{1y}, u_{2x}, u_{2y}, u_{3x}, u_{3y}]^\\top$ 关联起来：\n$$\n\\boldsymbol{\\epsilon} = B \\mathbf{d}\n$$\n对于线性三角形，形函数的导数是常数，这使得 $B$ 矩阵在整个单元内是恒定的。它是一个 $3 \\times 6$ 的矩阵，如下所示：\n$$\nB = \\begin{pmatrix}\n\\frac{\\partial N_1}{\\partial x}  0  \\frac{\\partial N_2}{\\partial x}  0  \\frac{\\partial N_3}{\\partial x}  0 \\\\\n0  \\frac{\\partial N_1}{\\partial y}  0  \\frac{\\partial N_2}{\\partial y}  0  \\frac{\\partial N_3}{\\partial y} \\\\\n\\frac{\\partial N_1}{\\partial y}  \\frac{\\partial N_1}{\\partial x}  \\frac{\\partial N_2}{\\partial y}  \\frac{\\partial N_2}{\\partial x}  \\frac{\\partial N_3}{\\partial y}  \\frac{\\partial N_3}{\\partial x}\n\\end{pmatrix} = \\frac{1}{2A} \\begin{pmatrix}\nb_1  0  b_2  0  b_3  0 \\\\\n0  c_1  0  c_2  0  c_3 \\\\\nc_1  b_1  c_2  b_2  c_3  b_3\n\\end{pmatrix}\n$$\n\n材料行为是平面应力下的各向同性线弹性。应力向量 $\\boldsymbol{\\sigma} = [\\sigma_{xx}, \\sigma_{yy}, \\tau_{xy}]^\\top$ 通过本构矩阵 $C$ 与应变向量相关：\n$$\n\\boldsymbol{\\sigma} = C \\boldsymbol{\\epsilon}\n$$\n对于平面应力， $3 \\times 3$ 矩阵 $C$ 为：\n$$\nC = \\frac{E}{1 - \\nu^2} \\begin{pmatrix}\n1  \\nu  0 \\\\\n\\nu  1  0 \\\\\n0  0  \\frac{1-\\nu}{2}\n\\end{pmatrix}\n$$\n其中 $E$ 是杨氏模量，$\\nu$ 是泊松比。\n\n单元刚度矩阵 $K$ 由应变能导出，并通过在单元体积 $V$ 上对 $B^\\top C B$ 进行积分得到。对于厚度为 $t$ 的常应变三角形，这可以简化为：\n$$\nK = \\int_V B^\\top C B \\, dV = (B^\\top C B) \\int_V dV = B^\\top C B \\cdot A \\cdot t\n$$\n得到的矩阵 $K$ 是一个对称的 $6 \\times 6$ 矩阵。\n\n由施加在长度为 $L$ 的边上的均匀面力 $\\mathbf{p} = [p_x, p_y]^\\top$ 引起的一致节点力向量 $\\mathbf{f}$ 是通过沿该边积分面力与形函数的乘积来计算的。对于线性单元，总力 $\\mathbf{F}_{tot} = \\mathbf{p} \\, t \\, L$ 平均分配给边上的两个节点。如果面力施加在连接节点 $i$ 和 $j$ 且长度为 $L_{ij}$ 的边上，这些节点上的力为：\n$$\n\\mathbf{f}_i = \\frac{1}{2} \\mathbf{p} \\, t \\, L_{ij}, \\quad \\mathbf{f}_j = \\frac{1}{2} \\mathbf{p} \\, t \\, L_{ij}\n$$\n这些向量的分量被组装到全局 $6 \\times 1$ 力向量 $\\mathbf{f}$ 中。\n\n在组装好 $K$ 和 $\\mathbf{f}$ 后，我们得到系统 $K\\mathbf{d} = \\mathbf{f}$。通过对系统进行分区来施加 Dirichlet 边界条件（指定位移）。所有自由度（DOFs）的集合（索引从 $0$ 到 $5$）被分成自由自由度集合 $S_f$ 和指定自由度集合 $S_p$。系统被重新排列为：\n$$\n\\begin{pmatrix} K_{ff}  K_{fp} \\\\ K_{pf}  K_{pp} \\end{pmatrix} \\begin{pmatrix} \\mathbf{d}_f \\\\ \\mathbf{d}_p \\end{pmatrix} = \\begin{pmatrix} \\mathbf{f}_f \\\\ \\mathbf{f}_p \\end{pmatrix}\n$$\n其中 $\\mathbf{d}_f$ 是未知位移，$\\mathbf{d}_p$ 是已知的指定位移。我们求解简化后的系统以获得未知位移：\n$$\nK_{ff} \\mathbf{d}_f = \\mathbf{f}_f - K_{fp} \\mathbf{d}_p\n$$\n在所提供的所有测试用例中，指定位移均为零，因此 $\\mathbf{d}_p = \\mathbf{0}$，从而将系统简化为 $K_{ff} \\mathbf{d}_f = \\mathbf{f}_f$。在求解这个较小的线性系统后，通过组合计算出的 $\\mathbf{d}_f$ 和已知的 $\\mathbf{d}_p$ 来构建完整的位移向量 $\\mathbf{d}$。然后从 $\\mathbf{d}$ 中提取所需的标量输出。此过程系统地应用于每个测试用例。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    test_cases = [\n        {\n            \"nodes\": np.array([[0.0, 0.0], [1.0, 0.0], [0.0, 1.0]]),\n            \"material\": {\"E\": 70e9, \"nu\": 0.33, \"t\": 0.01},\n            \"bcs\": {\n                \"dirichlet\": {0: 0.0, 1: 0.0, 3: 0.0},  # u1x, u1y, u2y\n                \"neumann\": {\"edge\": (1, 2), \"traction\": np.array([5e6, 0.0])}\n            },\n            \"report\": (\"scalar\", 4)  # u3x, index 4\n        },\n        {\n            \"nodes\": np.array([[0.0, 0.0], [2.0, 0.0], [0.0, 0.5]]),\n            \"material\": {\"E\": 200e9, \"nu\": 0.29, \"t\": 1e-4},\n            \"bcs\": {\n                \"dirichlet\": {0: 0.0, 1: 0.0, 4: 0.0},  # u1x, u1y, u3x\n                \"neumann\": {\"edge\": (0, 1), \"traction\": np.array([0.0, -1e6])}\n            },\n            \"report\": (\"scalar\", 3)  # u2y, index 3\n        },\n        {\n            \"nodes\": np.array([[0.0, 0.0], [0.5, 0.0], [0.0, 0.5]]),\n            \"material\": {\"E\": 210e9, \"nu\": 0.30, \"t\": 0.02},\n            \"bcs\": {\n                \"dirichlet\": {3: 0.0, 1: 0.0, 2: 0.0},  # u2y, u1y, u2x\n                \"neumann\": {\"edge\": (0, 2), \"traction\": np.array([2e6, 2e6])}\n            },\n            \"report\": (\"norm\", None)\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = solve_fem_case(case[\"nodes\"], case[\"material\"], case[\"bcs\"], case[\"report\"])\n        results.append(f\"{result:.7e}\")\n\n    print(f\"[{','.join(results)}]\")\n\ndef solve_fem_case(nodes, material, bcs, report_spec):\n    \"\"\"\n    Solves a single 2D plane stress linear elastic finite element problem.\n\n    Args:\n        nodes (np.ndarray): A 3x2 array of nodal coordinates.\n        material (dict): Dictionary with keys 'E', 'nu', 't'.\n        bcs (dict): Dictionary with 'dirichlet' and 'neumann' boundary conditions.\n        report_spec (tuple): Specification of what to report ('scalar' or 'norm').\n\n    Returns:\n        float: The requested result.\n    \"\"\"\n    # 1. Element Area and Shape Function Derivatives\n    x1, y1 = nodes[0]\n    x2, y2 = nodes[1]\n    x3, y3 = nodes[2]\n    \n    area = 0.5 * (x1 * (y2 - y3) + x2 * (y3 - y1) + x3 * (y1 - y2))\n    \n    b = np.array([y2 - y3, y3 - y1, y1 - y2])\n    c = np.array([x3 - x2, x1 - x3, x2 - x1])\n\n    # 2. Strain-Displacement Matrix (B)\n    B = np.zeros((3, 6))\n    for i in range(3):\n        B[0, 2 * i] = b[i]\n        B[1, 2 * i + 1] = c[i]\n        B[2, 2 * i] = c[i]\n        B[2, 2 * i + 1] = b[i]\n    B /= (2 * area)\n\n    # 3. Material Tangent Matrix (C) for Plane Stress\n    E, nu, t = material['E'], material['nu'], material['t']\n    C = (E / (1 - nu**2)) * np.array([\n        [1, nu, 0],\n        [nu, 1, 0],\n        [0, 0, (1 - nu) / 2]\n    ])\n\n    # 4. Element Stiffness Matrix (K)\n    K = B.T @ C @ B * area * t\n\n    # 5. Nodal Force Vector from Traction (f)\n    f = np.zeros(6)\n    neumann_bc = bcs[\"neumann\"]\n    n1_idx, n2_idx = neumann_bc[\"edge\"]\n    p = neumann_bc[\"traction\"]\n    \n    node1_coords = nodes[n1_idx]\n    node2_coords = nodes[n2_idx]\n    \n    edge_length = np.linalg.norm(node2_coords - node1_coords)\n    \n    total_force = p * t * edge_length\n    \n    f[2 * n1_idx : 2 * n1_idx + 2] += total_force / 2\n    f[2 * n2_idx : 2 * n2_idx + 2] += total_force / 2\n\n    # 6. Apply Boundary Conditions and Solve\n    dirichlet_dofs = list(bcs[\"dirichlet\"].keys())\n    dirichlet_vals = np.array(list(bcs[\"dirichlet\"].values()))\n    \n    all_dofs = list(range(6))\n    free_dofs = sorted(list(set(all_dofs) - set(dirichlet_dofs)))\n\n    K_ff = K[np.ix_(free_dofs, free_dofs)]\n    K_fp = K[np.ix_(free_dofs, dirichlet_dofs)]\n    f_f = f[free_dofs]\n    \n    # Solve K_ff * d_f = f_f - K_fp * d_p\n    # Here, d_p is zero for all test cases.\n    d_p = dirichlet_vals\n    \n    rhs = f_f - K_fp @ d_p\n    d_f = np.linalg.solve(K_ff, rhs)\n\n    # Reconstruct full displacement vector\n    d = np.zeros(6)\n    d[free_dofs] = d_f\n    d[dirichlet_dofs] = d_p\n\n    # Report the required result\n    report_type, report_idx = report_spec\n    if report_type == \"scalar\":\n        return d[report_idx]\n    elif report_type == \"norm\":\n        return np.linalg.norm(d)\n    else:\n        return 0.0\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3440488"}]}