{"hands_on_practices": [{"introduction": "有限元方法的通用性在很大程度上源于等参概念，即通过映射将简单的“父”单元转换为复杂的物理形状。雅可比矩阵是这一变换的数学核心，其行列式是衡量单元质量的关键指标，可确保映射在物理上有效。这项动手编程练习 [@problem_id:3452244] 将指导您实现这一检查，这是开发和调试有限元模型的一项基本技能。", "problem": "考虑一个用于平面实体力学的四节点双线性等参四边形有限元。令母（自然）坐标表示为 $(\\xi,\\eta)\\in[-1,1]\\times[-1,1]$，节点的物理坐标为 $(x_i,y_i)$，其中节点 $i=1,2,3,4$ 沿边界连续排列。等参映射对几何和位移使用相同的双线性形函数，其雅可比矩阵 $\\mathbf{J}(\\xi,\\eta)$ 将母空间中的微分长度映射到物理空间。行列式 $\\det \\mathbf{J}(\\xi,\\eta)$ 具有面积的物理单位，并且必须在整个单元上保持严格为正，以确保映射是一对一的（无反转）。此要求与几何畸变和单元凸性密切相关。\n\n您的任务是编写一个完整的、可运行的程序，对于每个给定的单元，在标准的 $2\\times 2$ 高斯求积点 $(\\xi,\\eta)\\in\\{\\pm 1/\\sqrt{3}\\}\\times\\{\\pm 1/\\sqrt{3}\\}$ 处计算 $\\det \\mathbf{J}$，并应用一个保证在整个单元上 $\\det \\mathbf{J}(\\xi,\\eta)>0$ 的几何畸变准则。具体来说，计算：\n- 在 $2\\times 2$ 个点上按顺序 $[(\\xi,\\eta)=(-1/\\sqrt{3},-1/\\sqrt{3}),(\\xi,\\eta)=(+1/\\sqrt{3},-1/\\sqrt{3}),(\\xi,\\eta)=(+1/\\sqrt{3},+1/\\sqrt{3}),(\\xi,\\eta)=(-1/\\sqrt{3},+1/\\sqrt{3})]$ 计算的四个 $\\det \\mathbf{J}$ 值的列表。\n- 一个布尔值，指示所有四个高斯点上的 $\\det \\mathbf{J}$ 值是否均为严格正值。\n- 一个布尔值，指示保证 $\\det \\mathbf{J}$ 处处为正的充分几何畸变准则是否得到满足。对于双线性等参四边形，利用 $\\det \\mathbf{J}(\\xi,\\eta)$ 在 $(\\xi,\\eta)$ 中是双线性的理论性质，其在正方形 $[-1,1]\\times[-1,1]$ 上的最小值出现在四个角点之一。因此，在四个角点 $(\\xi,\\eta)\\in\\{(-1,-1),(+1,-1),(+1,+1),(-1,+1)\\}$ 处计算 $\\det \\mathbf{J}$，并且当且仅当这四个角点值的最小值为严格正值时，才宣布该准则得到满足。\n- 四个角点上 $\\det \\mathbf{J}$ 值的最小值。\n\n所有物理坐标均以米为单位给出，您必须以平方米（$\\mathrm{m}^2$）表示 $\\det \\mathbf{J}$。将报告的每个 $\\det \\mathbf{J}$ 值四舍五入到小数点后 $6$ 位。布尔值输出必须是严格的：在检查正性时使用 $>$ 而不是 $\\geq$。\n\n使用以下单元测试套件，每个单元均由其节点坐标 $(x_i,y_i)$（以米为单位）定义，按节点顺序 $i=1,2,3,4$ 列出：\n1. 单元 A（凸形，扭斜）：$[(x_1,y_1)=(0.0,0.0),(x_2,y_2)=(2.0,0.3),(x_3,y_3)=(1.8,1.6),(x_4,y_4)=(0.2,1.7)]$。\n2. 单元 B（平行四边形，中度扭斜）：$[(x_1,y_1)=(0.0,0.0),(x_2,y_2)=(1.2,0.3),(x_3,y_3)=(2.2,1.3),(x_4,y_4)=(1.0,1.0)]$。\n3. 单元 C（狭长形，近奇异高度）：$[(x_1,y_1)=(0.0,0.0),(x_2,y_2)=(1.0,0.0),(x_3,y_3)=(1.001,0.001),(x_4,y_4)=(0.001,0.001)]$。\n4. 单元 D（扭曲，蝶形排序）：$[(x_1,y_1)=(0.0,0.0),(x_2,y_2)=(1.0,1.0),(x_3,y_3)=(0.0,1.0),(x_4,y_4)=(1.0,0.0)]$。\n\n您的程序必须生成单行输出，其中包含所有四个测试用例的汇总结果，格式为方括号括起来的逗号分隔列表。对于每个单元，报告一个形式为 $[\\,[d_1,d_2,d_3,d_4],\\,b_{\\mathrm{GP}},\\,b_{\\mathrm{corner}},\\,d_{\\min,\\mathrm{corner}}\\,]$ 的列表，其中 $d_1,\\dots,d_4$ 是四个高斯点上 $\\det \\mathbf{J}$ 的值，以 $\\mathrm{m}^2$ 为单位，四舍五入到小数点后 $6$ 位；$b_{\\mathrm{GP}}$ 是高斯点正性布尔值；$b_{\\mathrm{corner}}$ 是基于角点正性的充分几何畸变准则的布尔值；$d_{\\min,\\mathrm{corner}}$ 是角点最小值的 $\\det \\mathbf{J}$ 值，以 $\\mathrm{m}^2$ 为单位，四舍五入到小数点后 $6$ 位。所有四个单元的总输出格式必须是：\n$[\\,[\\,[d_1,d_2,d_3,d_4],b_{\\mathrm{GP}},b_{\\mathrm{corner}},d_{\\min,\\mathrm{corner}}],\\dots\\,]$。", "solution": "我们从四节点双线性四边形的等参概念开始。从母坐标 $(\\xi,\\eta)$ 到物理坐标 $(x,y)$ 的映射定义为\n$$\nx(\\xi,\\eta)=\\sum_{i=1}^{4} N_i(\\xi,\\eta)\\,x_i,\\qquad\ny(\\xi,\\eta)=\\sum_{i=1}^{4} N_i(\\xi,\\eta)\\,y_i,\n$$\n其中双线性形函数 $N_i(\\xi,\\eta)$ 为\n$$\nN_1(\\xi,\\eta)=\\tfrac{1}{4}(1-\\xi)(1-\\eta),\\quad\nN_2(\\xi,\\eta)=\\tfrac{1}{4}(1+\\xi)(1-\\eta),\\quad\nN_3(\\xi,\\eta)=\\tfrac{1}{4}(1+\\xi)(1+\\eta),\\quad\nN_4(\\xi,\\eta)=\\tfrac{1}{4}(1-\\xi)(1+\\eta).\n$$\n雅可比矩阵 $\\mathbf{J}(\\xi,\\eta)$ 是 $(x,y)$ 关于 $(\\xi,\\eta)$ 的梯度：\n$$\n\\mathbf{J}(\\xi,\\eta)=\n\\begin{bmatrix}\n\\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\\n\\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta}\n\\end{bmatrix}\n=\n\\begin{bmatrix}\nx_{,\\xi} & x_{,\\eta} \\\\\ny_{,\\xi} & y_{,\\eta}\n\\end{bmatrix}.\n$$\n由于 $x(\\xi,\\eta)$ 和 $y(\\xi,\\eta)$ 是形函数的线性组合，且形函数是双线性的，因此它们的导数在 $\\xi$ 或 $\\eta$ 中是线性的：\n$$\nx_{,\\xi}(\\xi,\\eta)=\\sum_{i=1}^4 x_i\\,\\frac{\\partial N_i}{\\partial \\xi}(\\xi,\\eta),\\qquad\ny_{,\\xi}(\\xi,\\eta)=\\sum_{i=1}^4 y_i\\,\\frac{\\partial N_i}{\\partial \\xi}(\\xi,\\eta),\n$$\n$$\nx_{,\\eta}(\\xi,\\eta)=\\sum_{i=1}^4 x_i\\,\\frac{\\partial N_i}{\\partial \\eta}(\\xi,\\eta),\\qquad\ny_{,\\eta}(\\xi,\\eta)=\\sum_{i=1}^4 y_i\\,\\frac{\\partial N_i}{\\partial \\eta}(\\xi,\\eta).\n$$\n对于上述双线性形函数，其导数为\n$$\n\\frac{\\partial N_1}{\\partial \\xi}=-\\tfrac{1}{4}(1-\\eta),\\quad\n\\frac{\\partial N_2}{\\partial \\xi}=+\\tfrac{1}{4}(1-\\eta),\\quad\n\\frac{\\partial N_3}{\\partial \\xi}=+\\tfrac{1}{4}(1+\\eta),\\quad\n\\frac{\\partial N_4}{\\partial \\xi}=-\\tfrac{1}{4}(1+\\eta),\n$$\n$$\n\\frac{\\partial N_1}{\\partial \\eta}=-\\tfrac{1}{4}(1-\\xi),\\quad\n\\frac{\\partial N_2}{\\partial \\eta}=-\\tfrac{1}{4}(1+\\xi),\\quad\n\\frac{\\partial N_3}{\\partial \\eta}=+\\tfrac{1}{4}(1+\\xi),\\quad\n\\frac{\\partial N_4}{\\partial \\eta}=+\\tfrac{1}{4}(1-\\xi).\n$$\n雅可比行列式为\n$$\n\\det \\mathbf{J}(\\xi,\\eta)=x_{,\\xi}(\\xi,\\eta)\\,y_{,\\eta}(\\xi,\\eta)-x_{,\\eta}(\\xi,\\eta)\\,y_{,\\xi}(\\xi,\\eta),\n$$\n其单位为面积，当 $(x_i,y_i)$ 以米为单位指定时，具体为 $\\mathrm{m}^2$。由于形函数导数在 $\\xi$ 和 $\\eta$ 中是线性的，$\\det \\mathbf{J}(\\xi,\\eta)$ 是 $(\\xi,\\eta)$ 的双线性函数，即\n$$\n\\det \\mathbf{J}(\\xi,\\eta)=a+b\\,\\xi+c\\,\\eta+d\\,\\xi\\,\\eta,\n$$\n其中 $a,b,c,d$ 是由节点坐标决定的常数。\n\n我们现在建立保证单元内 $\\det \\mathbf{J}$ 恒为正的几何畸变准则。矩形上的双线性函数在其角点处达到其最小值和最大值。具体而言，对于在 $[-1,1]\\times[-1,1]$ 上的函数 $f(\\xi,\\eta)=a+b\\,\\xi+c\\,\\eta+d\\,\\xi\\,\\eta$，其极值出现在 $(\\xi,\\eta)\\in\\{(-1,-1),(+1,-1),(+1,+1),(-1,+1)\\}$ 处。因此，\n$$\n\\min_{(\\xi,\\eta)\\in[-1,1]^2}\\det \\mathbf{J}(\\xi,\\eta)=\\min\\{\\det \\mathbf{J}(-1,-1),\\det \\mathbf{J}(+1,-1),\\det \\mathbf{J}(+1,+1),\\det \\mathbf{J}(-1,+1)\\}.\n$$\n因此，保证无反转（在母方块上为一对一映射）的充分必要条件是这四个角点值的最小值为严格正值。该条件与凸性和无扭曲密切相关；一个扭曲（蝶形）单元将在某个角点或域内违反此正性条件，而一个近奇异的狭长单元将产生任意接近于零的角点值。\n\n每个单元的算法步骤：\n1. 读取以米为单位的节点坐标 $(x_i,y_i)$，$i=1,2,3,4$。\n2. 对于每个高斯点 $(\\xi,\\eta)\\in\\{\\pm 1/\\sqrt{3}\\}\\times\\{\\pm 1/\\sqrt{3}\\}$，计算 $\\frac{\\partial N_i}{\\partial \\xi}$ 和 $\\frac{\\partial N_i}{\\partial \\eta}$，然后计算 $x_{,\\xi}$、$y_{,\\xi}$、$x_{,\\eta}$、$y_{,\\eta}$ 并构建 $\\det \\mathbf{J}(\\xi,\\eta)=x_{,\\xi}y_{,\\eta}-x_{,\\eta}y_{,\\xi}$。\n3. 将每个高斯点上的 $\\det \\mathbf{J}$ 四舍五入到小数点后 6 位，并按指定顺序记录这四个值。检查所有四个四舍五入后的值是否严格大于 0，并记录布尔值 $b_{\\mathrm{GP}}$。\n4. 使用相同的过程计算四个角点 $(\\xi,\\eta)\\in\\{(-1,-1),(+1,-1),(+1,+1),(-1,+1)\\}$ 处的 $\\det \\mathbf{J}$。计算这四个角点值的最小值，将其四舍五入到小数点后 6 位，并记录布尔值 $b_{\\mathrm{corner}}$，指示此最小值是否严格大于 0。\n5. 将所有单元的结果汇总到最终的单行输出中，格式为 $[\\,[\\,[d_1,d_2,d_3,d_4],b_{\\mathrm{GP}},b_{\\mathrm{corner}},d_{\\min,\\mathrm{corner}}],\\dots\\,]$。\n\n提供的测试套件涵盖：\n- 一个凸形扭斜单元（单元 A），预计其在高斯点和角点处的 $\\det \\mathbf{J}$ 均为严格正值。\n- 一个中度扭斜的平行四边形（单元 B），预计也有效。\n- 一个近奇异的狭长单元（单元 C），其保持正性但 $\\det \\mathbf{J}$ 值非常小，凸显了数值敏感性。\n- 一个扭曲单元（单元 D），其未能通过角点正性准则，并可能在某些高斯点处表现出负的 $\\det \\mathbf{J}$ 值，表明发生了反转。\n\n程序实现了这些步骤，并打印所需的单行输出，其中 $\\det \\mathbf{J}$ 以 $\\mathrm{m}^2$ 为单位，四舍五入到小数点后 6 位，并附带布尔指示符。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef dN_dxi_eta_bilinear(xi, eta):\n    \"\"\"\n    Compute derivatives of bilinear shape functions for a 4-node quadrilateral.\n    Order of nodes: 1:(-1,-1), 2:(+1,-1), 3:(+1,+1), 4:(-1,+1) in parent space.\n    \"\"\"\n    dN_dxi = np.array([\n        -0.25 * (1.0 - eta),   # dN1/dxi\n         0.25 * (1.0 - eta),   # dN2/dxi\n         0.25 * (1.0 + eta),   # dN3/dxi\n        -0.25 * (1.0 + eta)    # dN4/dxi\n    ])\n    dN_deta = np.array([\n        -0.25 * (1.0 - xi),    # dN1/deta\n        -0.25 * (1.0 + xi),    # dN2/deta\n         0.25 * (1.0 + xi),    # dN3/deta\n         0.25 * (1.0 - xi)     # dN4/deta\n    ])\n    return dN_dxi, dN_deta\n\ndef jacobian_det(xy_nodes, xi, eta):\n    \"\"\"\n    Compute det(J) at (xi, eta) for a 4-node bilinear quad with given physical nodes.\n    xy_nodes: array-like shape (4,2) with node coordinates [(x1,y1),...,(x4,y4)] in meters.\n    Returns detJ in m^2.\n    \"\"\"\n    dN_dxi, dN_deta = dN_dxi_eta_bilinear(xi, eta)\n    x = np.array([n[0] for n in xy_nodes])\n    y = np.array([n[1] for n in xy_nodes])\n\n    x_xi = float(np.dot(x, dN_dxi))\n    y_xi = float(np.dot(y, dN_dxi))\n    x_eta = float(np.dot(x, dN_deta))\n    y_eta = float(np.dot(y, dN_deta))\n\n    detJ = x_xi * y_eta - x_eta * y_xi\n    return detJ\n\ndef evaluate_element(xy_nodes):\n    \"\"\"\n    Evaluate detJ at 2x2 Gauss points and corner distortion criterion.\n    Returns:\n      [ [d1,d2,d3,d4], gp_ok, corner_ok, min_corner_detJ ]\n    where di are rounded to 6 decimals (m^2).\n    \"\"\"\n    g = 1.0 / np.sqrt(3.0)\n    gauss_pts = [(-g, -g), ( +g, -g), ( +g, +g), ( -g, +g)]\n    dets_gp = []\n    for (xi, eta) in gauss_pts:\n        det = jacobian_det(xy_nodes, xi, eta)\n        dets_gp.append(round(det, 6))\n\n    gp_ok = all(d > 0.0 for d in dets_gp)\n\n    corners = [(-1.0, -1.0), ( +1.0, -1.0), ( +1.0, +1.0), ( -1.0, +1.0)]\n    dets_corner = []\n    for (xi, eta) in corners:\n        det = jacobian_det(xy_nodes, xi, eta)\n        dets_corner.append(det)\n\n    min_corner = min(dets_corner)\n    min_corner_rounded = round(min_corner, 6)\n    corner_ok = (min_corner_rounded > 0.0)\n\n    return [dets_gp, gp_ok, corner_ok, min_corner_rounded]\n\ndef solve():\n    # Define the test cases from the problem statement (coordinates in meters).\n    test_cases = [\n        # Element A (convex, skewed)\n        [(0.0, 0.0), (2.0, 0.3), (1.8, 1.6), (0.2, 1.7)],\n        # Element B (parallelogram, moderate skew)\n        [(0.0, 0.0), (1.2, 0.3), (2.2, 1.3), (1.0, 1.0)],\n        # Element C (sliver, near-singular height)\n        [(0.0, 0.0), (1.0, 0.0), (1.001, 0.001), (0.001, 0.001)],\n        # Element D (twisted, bow-tie ordering)\n        [(0.0, 0.0), (1.0, 1.0), (0.0, 1.0), (1.0, 0.0)],\n    ]\n\n    results = []\n    for xy_nodes in test_cases:\n        res = evaluate_element(xy_nodes)\n        results.append(res)\n\n    # Final print statement in the exact required format.\n    # Ensure booleans and floats are printed in a single-line Python list representation.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3452244"}, {"introduction": "在每个单元内部，位移场是通过多项式形函数来近似的。本练习 [@problem_id:3452261] 直接应用了这一原理，从一个给定的线性位移场出发，推导相应的应变和应力张量。通过进一步检验平衡条件（应力散度），本练习巩固了运动学、动力学和固体力学控制方程之间的基本联系。", "problem": "考虑一个用于计算材料科学的有限元方法（FEM；Finite Element Method）中的二维小应变固体力学背景。设位移场为 $u(x,y) = \\begin{bmatrix} a x + b y \\\\ c x + d y \\end{bmatrix}$，其中 $a$、$b$、$c$ 和 $d$ 是实常数。假设材料为各向同性、均匀、线弹性材料，处于平面应变状态，其 Lamé 参数为 $\\lambda$ 和 $\\mu$，且没有体力（即体力矢量 $\\mathbf{f} = \\mathbf{0}$）。\n\n从微小应变的运动学和线动量守恒出发，推导应变张量 $\\epsilon$ 和 Cauchy 应力张量 $\\sigma$，用 $a$、$b$、$c$、$d$、$\\lambda$ 和 $\\mu$ 表示。然后，计算应力场的散度 $\\nabla \\cdot \\sigma$，并在 $b = 0$（即 $u_{x}$ 中乘以 $y$ 的系数为零）的特殊情况下，确定 $a$、$c$ 和 $d$ 取何值时应力场为无散场。\n\n您的最终答案必须是一个单行矩阵，其条目按顺序为三个独立的应变分量 $\\epsilon_{xx}$、$\\epsilon_{yy}$、$\\epsilon_{xy}$（用 $a$、$b$、$c$、$d$ 表示），然后是在 $b=0$ 条件下计算的应力场散度的两个分量 $\\left(\\nabla \\cdot \\sigma\\right)_{x}$ 和 $\\left(\\nabla \\cdot \\sigma\\right)_{y}$。无需四舍五入，最终答案中不应包含单位。", "solution": "首先验证问题，以确保其科学上合理、适定且客观。\n\n### 步骤 1：提取已知条件\n-   位移场：$\\mathbf{u}(x,y) = \\begin{bmatrix} u_x \\\\ u_y \\end{bmatrix} = \\begin{bmatrix} a x + b y \\\\ c x + d y \\end{bmatrix}$\n-   常数：$a$、$b$、$c$ 和 $d$ 是实常数。\n-   材料模型：各向同性、均匀、线弹性。\n-   材料参数：Lamé 参数 $\\lambda$ 和 $\\mu$。\n-   力学条件：二维（$2$D）、小应变、平面应变。\n-   体力：$\\mathbf{f} = \\mathbf{0}$。\n-   任务：\n    1.  推导应变张量 $\\epsilon$。\n    2.  推导 Cauchy 应力张量 $\\sigma$。\n    3.  计算应力场的散度 $\\nabla \\cdot \\sigma$。\n    4.  对于 $b=0$ 的特殊情况，确定使 $\\nabla \\cdot \\sigma = \\mathbf{0}$ 成立的关于 $a$、$c$ 和 $d$ 的条件。\n    5.  提供一个行矩阵作为最终答案，其中包含 $\\epsilon_{xx}$、$\\epsilon_{yy}$、$\\epsilon_{xy}$ 以及在 $b=0$ 时计算的 $\\nabla \\cdot \\sigma$ 的两个分量。\n\n### 步骤 2：使用提取的已知条件进行验证\n-   **科学基础**：该问题牢固地植根于连续介质力学的基本原理。它采用了小应变张量的标准定义、线弹性各向同性材料的本构定律（胡克定律）以及力学平衡方程（线动量守恒）。所给定的线性位移场是一个有效且常见的情况，代表了均匀变形状态。该问题在科学上是正确的。\n-   **适定性**：该问题是适定的。它提供了所有必要的信息（位移场、材料属性和条件）来唯一确定所需的量。任务规定清晰，并导向唯一的数学结果。\n-   **客观性**：该问题以精确、形式化的数学和物理语言陈述，没有任何主观性或模糊性。\n\n### 步骤 3：结论与行动\n问题有效。将提供完整解答。\n\n### 解题推导\n\n求解过程首先根据给定的位移场计算应变张量，然后使用本构定律计算应力张量，最后计算应力张量的散度。\n\n**1. 应变张量计算**\n小应变张量 $\\epsilon$ 是位移梯度 $\\nabla \\mathbf{u}$ 的对称部分。其分量由 $\\epsilon_{ij} = \\frac{1}{2}(\\frac{\\partial u_i}{\\partial x_j} + \\frac{\\partial u_j}{\\partial x_i})$ 给出。\n给定的位移场为 $\\mathbf{u} = \\begin{bmatrix} u_x \\\\ u_y \\end{bmatrix} = \\begin{bmatrix} a x + b y \\\\ c x + d y \\end{bmatrix}$。\n\n首先，我们计算位移梯度张量 $\\nabla \\mathbf{u}$：\n$$\n\\nabla \\mathbf{u} = \\begin{bmatrix} \\frac{\\partial u_x}{\\partial x} & \\frac{\\partial u_x}{\\partial y} \\\\ \\frac{\\partial u_y}{\\partial x} & \\frac{\\partial u_y}{\\partial y} \\end{bmatrix} = \\begin{bmatrix} \\frac{\\partial}{\\partial x}(a x + b y) & \\frac{\\partial}{\\partial y}(a x + b y) \\\\ \\frac{\\partial}{\\partial x}(c x + d y) & \\frac{\\partial}{\\partial y}(c x + d y) \\end{bmatrix} = \\begin{bmatrix} a & b \\\\ c & d \\end{bmatrix}\n$$\n应变张量 $\\epsilon$ 的分量为：\n$$\n\\epsilon_{xx} = \\frac{\\partial u_x}{\\partial x} = a\n$$\n$$\n\\epsilon_{yy} = \\frac{\\partial u_y}{\\partial y} = d\n$$\n$$\n\\epsilon_{xy} = \\epsilon_{yx} = \\frac{1}{2}\\left(\\frac{\\partial u_x}{\\partial y} + \\frac{\\partial u_y}{\\partial x}\\right) = \\frac{1}{2}(b + c)\n$$\n在平面应变条件下，面外应变分量为零：$\\epsilon_{zz} = \\epsilon_{xz} = \\epsilon_{yz} = 0$。\n$x-y$ 平面内的应变张量为：\n$$\n\\epsilon = \\begin{bmatrix} a & \\frac{1}{2}(b+c) \\\\ \\frac{1}{2}(b+c) & d \\end{bmatrix}\n$$\n\n**2. 应力张量计算**\n对于均匀、各向同性、线弹性材料，Cauchy 应力张量 $\\sigma$ 通过本构方程与应变张量 $\\epsilon$ 相关：\n$$\n\\sigma = \\lambda (\\text{tr}(\\epsilon)) \\mathbf{I} + 2\\mu\\epsilon\n$$\n其中 $\\mathbf{I}$ 是单位张量，$\\lambda$ 和 $\\mu$ 是 Lamé 参数。\n对于平面应变，应变张量的迹为 $\\text{tr}(\\epsilon) = \\epsilon_{xx} + \\epsilon_{yy} + \\epsilon_{zz} = a + d + 0 = a+d$。\n\n应力张量的分量为：\n$$\n\\sigma_{xx} = \\lambda (\\text{tr}(\\epsilon)) + 2\\mu \\epsilon_{xx} = \\lambda(a+d) + 2\\mu a\n$$\n$$\n\\sigma_{yy} = \\lambda (\\text{tr}(\\epsilon)) + 2\\mu \\epsilon_{yy} = \\lambda(a+d) + 2\\mu d\n$$\n$$\n\\sigma_{xy} = \\sigma_{yx} = 2\\mu \\epsilon_{xy} = 2\\mu \\left(\\frac{1}{2}(b+c)\\right) = \\mu(b+c)\n$$\n值得注意的是，面外正应力 $\\sigma_{zz}$ 通常不为零：$\\sigma_{zz} = \\lambda(\\text{tr}(\\epsilon)) + 2\\mu\\epsilon_{zz} = \\lambda(a+d)$。\n\n由于 $a、b、c、d、\\lambda$ 和 $\\mu$ 都是常数，所以应力张量 $\\sigma$ 的所有分量在空间上都是恒定的。\n\n**3. 应力场的散度**\n在静态情况下，如果没有体力（$\\mathbf{f}=\\mathbf{0}$），线动量守恒要求应力场是无散的：$\\nabla \\cdot \\sigma = \\mathbf{0}$。我们将显式计算散度以验证这一点。\n\n应力张量 $\\sigma$ 的散度是一个矢量场，其在笛卡尔坐标系中的分量为：\n$$\n(\\nabla \\cdot \\sigma)_x = \\frac{\\partial \\sigma_{xx}}{\\partial x} + \\frac{\\partial \\sigma_{xy}}{\\partial y}\n$$\n$$\n(\\nabla \\cdot \\sigma)_y = \\frac{\\partial \\sigma_{yx}}{\\partial x} + \\frac{\\partial \\sigma_{yy}}{\\partial y}\n$$\n代入应力分量的表达式：\n$$\n(\\nabla \\cdot \\sigma)_x = \\frac{\\partial}{\\partial x}(\\lambda(a+d) + 2\\mu a) + \\frac{\\partial}{\\partial y}(\\mu(b+c))\n$$\n$$\n(\\nabla \\cdot \\sigma)_y = \\frac{\\partial}{\\partial x}(\\mu(b+c)) + \\frac{\\partial}{\\partial y}(\\lambda(a+d) + 2\\mu d)\n$$\n由于所有应力分量相对于空间坐标 $x$ 和 $y$ 都是常数，因此它们的偏导数为零。\n$$\n\\frac{\\partial}{\\partial x}(\\text{constant}) = 0, \\quad \\frac{\\partial}{\\partial y}(\\text{constant}) = 0\n$$\n因此，\n$$\n(\\nabla \\cdot \\sigma)_x = 0 + 0 = 0\n$$\n$$\n(\\nabla \\cdot \\sigma)_y = 0 + 0 = 0\n$$\n这表明对于常数 $a、b、c$ 和 $d$ 的任何值，$\\nabla \\cdot \\sigma = \\mathbf{0}$。\n\n**4. 应力无散的条件**\n问题要求在 $b=0$ 的特殊情况下，确定使应力场无散的 $a、c$ 和 $d$ 的值。如上所示，对于 $a、b、c$ 和 $d$ 的*所有*实数值，应力场的散度恒为零。因此，特殊化到 $b=0$ 不会改变这个结果。对于 $a, c, d \\in \\mathbb{R}$ 的任何选择，应力场都是无散的。\n\n**5. 组合最终答案**\n最终答案需要一个包含五个条目的行矩阵：\n1.  $\\epsilon_{xx} = a$\n2.  $\\epsilon_{yy} = d$\n3.  $\\epsilon_{xy} = \\frac{1}{2}(b+c)$\n4.  在 $b=0$ 时计算的 $(\\nabla \\cdot \\sigma)_{x}$：如上所示，结果为 $0$。\n5.  在 $b=0$ 时计算的 $(\\nabla \\cdot \\sigma)_{y}$：如上所示，结果为 $0$。\n\n最终的行矩阵由这五个表达式组成。", "answer": "$$\n\\boxed{\\begin{pmatrix} a & d & \\frac{1}{2}(b+c) & 0 & 0 \\end{pmatrix}}\n$$", "id": "3452261"}, {"introduction": "计算材料科学的一个主要挑战是精确模拟非线性材料行为，例如塑性。本练习 [@problem_id:3452269] 深入探讨了非线性有限元模拟的核心：在单个积分点上的本构更新。您将实现经典的预测-校正返回映射算法，这是积分弹塑性模型和确定材料加载响应的基本过程。", "problem": "在一个有限元方法（FEM）模拟中，一个三维小应变固体中的单个高斯积分点前进一个载荷/时间增量。该材料遵循各向同性线弹性与率无关的 von Mises（也称 $J_{2}$）塑性，并伴有线性各向同性硬化。本构定义如下：\n\n- 小应变运动学，从步骤 $n$ 到 $n+1$ 的总应变增量记为 $\\Delta \\boldsymbol{\\varepsilon}$。\n- 各向同性线弹性的胡克定律，杨氏模量为 $E$，泊松比为 $\\nu$。\n- 柯西应力 $\\boldsymbol{\\sigma}$ 分解为静水应力部分和偏应力部分 $\\boldsymbol{\\sigma} = p \\mathbf{I} + \\boldsymbol{s}$，其中 $p = \\tfrac{1}{3} \\operatorname{tr}(\\boldsymbol{\\sigma})$，$ \\boldsymbol{s} = \\boldsymbol{\\sigma} - p \\mathbf{I}$。\n- von Mises 等效应力为 $\\sigma_{\\mathrm{eq}} = \\sqrt{\\tfrac{3}{2}\\,\\boldsymbol{s}:\\boldsymbol{s}}$。\n- 屈服函数为 $f(\\boldsymbol{\\sigma}, \\varepsilon_{p}^{\\mathrm{eq}}) = \\sigma_{\\mathrm{eq}} - \\sigma_{y}(\\varepsilon_{p}^{\\mathrm{eq}})$，其中 $\\sigma_{y}(\\varepsilon_{p}^{\\mathrm{eq}}) = \\sigma_{y0} + H\\,\\varepsilon_{p}^{\\mathrm{eq}}$，$\\sigma_{y0}$ 是初始屈服强度，$H$ 是各向同性硬化模量，$\\varepsilon_{p}^{\\mathrm{eq}}$ 是等效塑性应变。\n- 相关联的塑性流动：$\\Delta \\boldsymbol{\\varepsilon}_{p} = \\Delta \\gamma \\,\\dfrac{\\partial f}{\\partial \\boldsymbol{\\sigma}}$，其中 $\\Delta \\gamma \\ge 0$ 是塑性乘子增量。\n\n在该步骤开始时，状态为\n- 步骤 $n$ 时的应力：$\\boldsymbol{\\sigma}_{n} = \\mathbf{0}$，\n- 步骤 $n$ 时的塑性应变：$\\boldsymbol{\\varepsilon}_{p,n} = \\mathbf{0}$，\n- 步骤 $n$ 时的等效塑性应变：$\\varepsilon_{p,n}^{\\mathrm{eq}} = 0$。\n\n材料参数：\n- 杨氏模量 $E = 210 \\times 10^{3}\\,\\text{MPa}$，\n- 泊松比 $\\nu = 0.3$，\n- 初始屈服应力 $\\sigma_{y0} = 250\\,\\text{MPa}$，\n- 各向同性硬化模量 $H = 1000\\,\\text{MPa}$。\n\n该步骤的总应变增量：\n$$\n\\Delta \\boldsymbol{\\varepsilon} = \\begin{pmatrix}\n0.004 & 0 & 0 \\\\\n0 & -0.001 & 0 \\\\\n0 & 0 & -0.001\n\\end{pmatrix}.\n$$\n\n任务：\n1. 执行弹性试算（预测）步骤，计算试算应力 $\\boldsymbol{\\sigma}^{\\mathrm{tr}}$。\n2. 在试算状态下评估屈服函数，以确定此增量中是否发生屈服。\n3. 如果发生塑性屈服，对伴有线性各向同性硬化的相关联 $J_{2}$ 塑性执行返回映射算法，以计算：\n   - 塑性乘子增量 $\\Delta \\gamma$，\n   - 更新后的柯西应力 $\\boldsymbol{\\sigma}_{n+1}$，\n   - 更新后的塑性应变张量 $\\boldsymbol{\\varepsilon}_{p,n+1}$，\n   - 更新后的等效塑性应变 $\\varepsilon_{p,n+1}^{\\mathrm{eq}}$。\n4. 将应力分量以 $\\text{MPa}$ 表示，应变为无量纲量。\n5. 为便于评分，仅报告塑性乘子增量 $\\Delta \\gamma$ 作为最终答案。将报告的数值四舍五入至四位有效数字，并以无量纲量形式提供。", "solution": "该问题经确认具有科学依据、提法恰当、客观且完整。它代表了计算塑性力学中的一个标准练习。求解过程遵循用于积分弹塑性本构模型的经典算子分裂算法，该算法包括一个弹性预测步和一个塑性修正（返回映射）步。\n\n首先，我们根据给定的杨氏模量 $E = 210 \\times 10^{3}\\,\\text{MPa}$ 和泊松比 $\\nu = 0.3$ 计算必要的弹性常数。\n剪切模量 $G$ 为：\n$$G = \\frac{E}{2(1+\\nu)} = \\frac{210 \\times 10^{3}\\,\\text{MPa}}{2(1+0.3)} = \\frac{210000}{2.6}\\,\\text{MPa} = \\frac{105000}{1.3}\\,\\text{MPa}$$\n体积模量 $K$ 为：\n$$K = \\frac{E}{3(1-2\\nu)} = \\frac{210 \\times 10^{3}\\,\\text{MPa}}{3(1-2 \\times 0.3)} = \\frac{210000}{3 \\times 0.4} = \\frac{210000}{1.2}\\,\\text{MPa} = 175000\\,\\text{MPa}$$\n各向同性弹性应力-应变关系由胡克定律给出，$\\boldsymbol{\\sigma} = \\mathbf{C} : \\boldsymbol{\\varepsilon}_{e}$，其中 $\\mathbf{C}$ 是四阶弹性张量，$\\boldsymbol{\\sigma}$ 是柯西应力，$\\boldsymbol{\\varepsilon}_{e}$ 是弹性应变。这可以方便地分解为体积部分和偏量部分：\n$$p = K \\operatorname{tr}(\\boldsymbol{\\varepsilon}_{e})$$\n$$\\boldsymbol{s} = 2G \\boldsymbol{e}_{e}$$\n其中 $p = \\frac{1}{3}\\operatorname{tr}(\\boldsymbol{\\sigma})$ 是静水应力，$\\boldsymbol{s} = \\boldsymbol{\\sigma} - p\\mathbf{I}$ 是偏应力，$\\boldsymbol{e}_{e} = \\boldsymbol{\\varepsilon}_{e} - \\frac{1}{3}\\operatorname{tr}(\\boldsymbol{\\varepsilon}_{e})\\mathbf{I}$ 是弹性应变的偏量部分。\n\n步骤 $n$ 的初始状态已完全指定：$\\boldsymbol{\\sigma}_{n} = \\mathbf{0}$，$\\boldsymbol{\\varepsilon}_{p,n} = \\mathbf{0}$，且 $\\varepsilon_{p,n}^{\\mathrm{eq}} = 0$。因此，初始屈服应力为 $\\sigma_{y,n} = \\sigma_{y0} = 250\\,\\text{MPa}$。\n\n**1. 弹性预测步**\n在试算步骤中，我们假设整个应变增量 $\\Delta\\boldsymbol{\\varepsilon}$ 完全是弹性的。应变的加法分解为 $\\Delta\\boldsymbol{\\varepsilon} = \\Delta\\boldsymbol{\\varepsilon}_{e} + \\Delta\\boldsymbol{\\varepsilon}_{p}$。将塑性应变增量设为零（$\\Delta\\boldsymbol{\\varepsilon}_{p} = \\mathbf{0}$），得到试算弹性应变增量为 $\\Delta\\boldsymbol{\\varepsilon}_{e}^{\\mathrm{tr}} = \\Delta\\boldsymbol{\\varepsilon}$。\n增量结束时的试算应力 $\\boldsymbol{\\sigma}^{\\mathrm{tr}}$ 计算如下：\n$$\\boldsymbol{\\sigma}^{\\mathrm{tr}} = \\boldsymbol{\\sigma}_{n} + \\mathbf{C} : \\Delta\\boldsymbol{\\varepsilon} = \\mathbf{0} + \\mathbf{C} : \\Delta\\boldsymbol{\\varepsilon} = \\mathbf{C} : \\Delta\\boldsymbol{\\varepsilon}$$\n我们可以分别计算试算应力的静水应力部分和偏应力部分。应变增量的体积部分是：\n$$\\operatorname{tr}(\\Delta\\boldsymbol{\\varepsilon}) = 0.004 + (-0.001) + (-0.001) = 0.002$$\n试算静水应力为：\n$$p^{\\mathrm{tr}} = K \\operatorname{tr}(\\Delta\\boldsymbol{\\varepsilon}) = (175000\\,\\text{MPa}) \\times 0.002 = 350\\,\\text{MPa}$$\n应变增量的偏量部分 $\\Delta\\boldsymbol{e} = \\Delta\\boldsymbol{\\varepsilon} - \\frac{1}{3}\\operatorname{tr}(\\Delta\\boldsymbol{\\varepsilon})\\mathbf{I}$ 为：\n$$\\Delta\\boldsymbol{e} = \\begin{pmatrix} 0.004 & 0 & 0 \\\\ 0 & -0.001 & 0 \\\\ 0 & 0 & -0.001 \\end{pmatrix} - \\frac{0.002}{3} \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 0.004 - \\frac{0.002}{3} & 0 & 0 \\\\ 0 & -0.001 - \\frac{0.002}{3} & 0 \\\\ 0 & 0 & -0.001 - \\frac{0.002}{3} \\end{pmatrix} = \\begin{pmatrix} \\frac{0.01}{3} & 0 & 0 \\\\ 0 & -\\frac{0.005}{3} & 0 \\\\ 0 & 0 & -\\frac{0.005}{3} \\end{pmatrix}$$\n试算偏应力为：\n$$\\boldsymbol{s}^{\\mathrm{tr}} = 2G \\Delta\\boldsymbol{e} = 2 \\left(\\frac{105000}{1.3}\\,\\text{MPa}\\right) \\begin{pmatrix} \\frac{0.01}{3} & 0 & 0 \\\\ 0 & -\\frac{0.005}{3} & 0 \\\\ 0 & 0 & -\\frac{0.005}{3} \\end{pmatrix} = \\frac{1}{1.3} \\begin{pmatrix} 700 & 0 & 0 \\\\ 0 & -350 & 0 \\\\ 0 & 0 & -350 \\end{pmatrix}\\,\\text{MPa}$$\n\n**2. 屈服条件评估**\n我们评估试算状态下的 von Mises 等效应力，$\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} = \\sqrt{\\frac{3}{2}\\boldsymbol{s}^{\\mathrm{tr}}:\\boldsymbol{s}^{\\mathrm{tr}}}$：\n$$\\boldsymbol{s}^{\\mathrm{tr}}:\\boldsymbol{s}^{\\mathrm{tr}} = \\left(\\frac{700}{1.3}\\right)^2 + \\left(-\\frac{350}{1.3}\\right)^2 + \\left(-\\frac{350}{1.3}\\right)^2 = \\frac{1}{(1.3)^2} [700^2 + 2 \\times 350^2] = \\frac{350^2}{(1.3)^2} [2^2 + 2] = \\frac{6 \\times 350^2}{(1.3)^2}\\,\\text{MPa}^2$$\n$$\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} = \\sqrt{\\frac{3}{2} \\left( \\frac{6 \\times 350^2}{(1.3)^2} \\right)} = \\sqrt{\\frac{9 \\times 350^2}{(1.3)^2}} = \\frac{3 \\times 350}{1.3}\\,\\text{MPa} = \\frac{1050}{1.3}\\,\\text{MPa}$$\n数值上，$\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} \\approx 807.69\\,\\text{MPa}$。\n试算状态下的屈服函数为 $f^{\\mathrm{tr}} = \\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} - \\sigma_{y,n}$。\n$$f^{\\mathrm{tr}} = \\frac{1050}{1.3}\\,\\text{MPa} - 250\\,\\text{MPa} = \\frac{1050 - 250 \\times 1.3}{1.3}\\,\\text{MPa} = \\frac{1050-325}{1.3}\\,\\text{MPa} = \\frac{725}{1.3}\\,\\text{MPa} \\approx 557.69\\,\\text{MPa}$$\n由于 $f^{\\mathrm{tr}} > 0$，弹性试算状态位于屈服面之外，发生塑性变形。需要进行塑性修正。\n\n**3. 塑性修正（返回映射）步**\n执行塑性修正是为了将应力状态返回到更新后的屈服面上。对于相关联的 $J_2$ 塑性，塑性流动方向垂直于屈服面：\n$$\\Delta\\boldsymbol{\\varepsilon}_{p} = \\Delta\\gamma \\frac{\\partial f}{\\partial \\boldsymbol{\\sigma}} = \\Delta\\gamma \\frac{\\partial \\sigma_{\\mathrm{eq}}}{\\partial \\boldsymbol{\\sigma}} = \\Delta\\gamma \\left(\\frac{3}{2}\\frac{\\boldsymbol{s}_{n+1}}{\\sigma_{\\mathrm{eq},n+1}}\\right)$$\n应力更新为 $\\boldsymbol{\\sigma}_{n+1} = \\boldsymbol{\\sigma}^{\\mathrm{tr}} - \\mathbf{C} : \\Delta\\boldsymbol{\\varepsilon}_{p}$。\n由于塑性流动是等体积的（$\\operatorname{tr}(\\Delta\\boldsymbol{\\varepsilon}_{p}) = 0$），静水应力不受影响：$p_{n+1} = p^{\\mathrm{tr}}$。\n偏应力根据径向返回算法进行更新：\n$$\\boldsymbol{s}_{n+1} = \\boldsymbol{s}^{\\mathrm{tr}} - 2G\\Delta\\boldsymbol{\\varepsilon}_{p} = \\boldsymbol{s}^{\\mathrm{tr}} - 2G \\Delta\\gamma \\left(\\frac{3}{2}\\frac{\\boldsymbol{s}_{n+1}}{\\sigma_{\\mathrm{eq},n+1}}\\right) = \\boldsymbol{s}^{\\mathrm{tr}} - 3G\\Delta\\gamma \\frac{\\boldsymbol{s}_{n+1}}{\\sigma_{\\mathrm{eq},n+1}}$$\n该关系意味着 $\\boldsymbol{s}_{n+1}$ 与 $\\boldsymbol{s}^{\\mathrm{tr}}$ 成正比，因此：\n$$\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} = \\sigma_{\\mathrm{eq},n+1} + 3G\\Delta\\gamma$$\n这是第一个关键方程。第二个是一致性条件，$f(\\boldsymbol{\\sigma}_{n+1}, \\varepsilon_{p,n+1}^{\\mathrm{eq}}) = 0$：\n$$\\sigma_{\\mathrm{eq},n+1} = \\sigma_{y,n+1} = \\sigma_{y0} + H\\varepsilon_{p,n+1}^{\\mathrm{eq}}$$\n对于此模型，等效塑性应变增量 $\\Delta\\varepsilon_{p}^{\\mathrm{eq}}$ 等于塑性乘子 $\\Delta\\gamma$：\n$$\\Delta\\varepsilon_{p}^{\\mathrm{eq}} = \\sqrt{\\frac{2}{3}\\Delta\\boldsymbol{\\varepsilon}_{p}:\\Delta\\boldsymbol{\\varepsilon}_{p}} = \\sqrt{\\frac{2}{3}\\left(\\Delta\\gamma^2 \\frac{9}{4}\\frac{\\boldsymbol{s}_{n+1}:\\boldsymbol{s}_{n+1}}{\\sigma_{\\mathrm{eq},n+1}^2}\\right)} = \\sqrt{\\frac{2}{3}\\Delta\\gamma^2 \\frac{9}{4}\\frac{\\frac{2}{3}\\sigma_{\\mathrm{eq},n+1}^2}{\\sigma_{\\mathrm{eq},n+1}^2}} = \\Delta\\gamma$$\n由于 $\\varepsilon_{p,n}^{\\mathrm{eq}} = 0$，我们有 $\\varepsilon_{p,n+1}^{\\mathrm{eq}} = \\Delta\\gamma$。所以一致性条件变为：\n$$\\sigma_{\\mathrm{eq},n+1} = \\sigma_{y0} + H\\Delta\\gamma$$\n将此代入径向返回方程：\n$$\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} = (\\sigma_{y0} + H\\Delta\\gamma) + 3G\\Delta\\gamma$$\n我们现在可以求解塑性乘子增量 $\\Delta\\gamma$：\n$$\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} - \\sigma_{y0} = (3G + H)\\Delta\\gamma$$\n$$\\Delta\\gamma = \\frac{\\sigma_{\\mathrm{eq}}^{\\mathrm{tr}} - \\sigma_{y0}}{3G + H} = \\frac{f^{\\mathrm{tr}}}{3G + H}$$\n我们代入数值：\n$$3G + H = 3\\left(\\frac{105000}{1.3}\\,\\text{MPa}\\right) + 1000\\,\\text{MPa} = \\frac{315000 + 1300}{1.3}\\,\\text{MPa} = \\frac{316300}{1.3}\\,\\text{MPa}$$\n$$\\Delta\\gamma = \\frac{\\frac{725}{1.3}\\,\\text{MPa}}{\\frac{316300}{1.3}\\,\\text{MPa}} = \\frac{725}{316300}$$\n计算数值：\n$$\\Delta\\gamma = 0.0022921277...$$\n\n**4. 最终答案计算**\n问题要求将塑性乘子增量 $\\Delta\\gamma$ 四舍五入到四位有效数字。\n$$\\Delta\\gamma \\approx 0.002292$$\n该值为无量纲量，符合要求。尽管最终答案未要求，但其他最终状态变量可以由此值计算得出。例如，$\\varepsilon_{p,n+1}^{\\mathrm{eq}} = \\Delta\\gamma$ 且 $\\boldsymbol{\\sigma}_{n+1} = p^{\\mathrm{tr}}\\mathbf{I} + \\boldsymbol{s}^{\\mathrm{tr}}(1 - 3G\\Delta\\gamma / \\sigma_{\\mathrm{eq}}^{\\mathrm{tr}})$。要求的最终答案仅为 $\\Delta\\gamma$。", "answer": "$$\n\\boxed{0.002292}\n$$", "id": "3452269"}]}