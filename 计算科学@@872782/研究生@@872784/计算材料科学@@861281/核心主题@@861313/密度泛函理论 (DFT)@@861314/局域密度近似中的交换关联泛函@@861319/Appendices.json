{"hands_on_practices": [{"introduction": "要掌握局域密度近似（LDA）中的交换势，第一步是理解它如何从均匀电子气的模型中推导出来。这个练习将引导你从基本的交换能量密度出发，通过第一性原理推导出交换势的表达式。接着，通过将其应用于一个正弦调制的电子密度，你将亲身体验到 LDA 中势与密度之间的非线性关系如何催生出简单的线性理论中不存在的物理现象，例如高次谐波的产生 [@problem_id:3450841]。", "problem": "在密度泛函理论 (DFT) 中，局域密度近似 (LDA) 通过将非均匀电子体系的交换能局域地近似为均匀电子气的单个粒子交换能来对其进行建模。考虑均匀电子气的单个粒子交换能为 $e_{x}(n)=-\\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}n^{1/3}$，其中 $n$ 是电子密度。交换能泛函为 $E_{x}[n]=\\int n(\\mathbf{r})\\,e_{x}(n(\\mathbf{r}))\\,d^{3}\\mathbf{r}$，且 LDA 交换势定义为 $v_{x}^{\\text{LDA}}(\\mathbf{r})=\\frac{\\delta E_{x}[n]}{\\delta n(\\mathbf{r})}$。\n\n从这些定义和给定的 $e_{x}(n)$ 出发，完成以下任务：\n- 通过从第一性原理出发进行泛函求导，推导 $v_{x}^{\\text{LDA}}(n)$ 作为 $n$ 的函数的显式局域表达式。\n- 对于非均匀一维调制 $n(\\mathbf{r})=n_{0}\\left[1+\\alpha\\cos(kx)\\right]$（其中 $n_{0}0$, $|\\alpha|\\ll 1$, 且 $k0$），通过按 $\\alpha$ 的幂次展开到并包括 $\\alpha^{2}$ 阶项，计算 $v_{x}^{\\text{LDA}}(\\mathbf{r})$。使用三角恒等式重写 $\\cos(kx)$ 的任何幂，以 $\\cos(kx)$ 和 $\\cos(2kx)$ 的形式表示结果，并合并项以揭示 $v_{x}^{\\text{LDA}}$ 中的谐波产生。\n\n以 $v_{x}^{\\text{LDA}}(\\mathbf{r})$ 的单一闭合形式解析表达式提供最终答案，展开至 $\\alpha^{2}$ 阶。不需要四舍五入，最终表达式中不应包含单位。", "solution": "该问题陈述具有科学依据、提法恰当、客观且完整。这是应用密度泛函理论 (DFT) 基本原理，特别是局域密度近似 (LDA) 的一个标准练习。所有给出的定义和表达式在该领域都是正确和标准的。因此，该问题是有效的，并将提供解答。\n\n该问题分为两部分。第一部分是推导 LDA 交换势 $v_{x}^{\\text{LDA}}(n)$ 作为电子密度 $n$ 的函数的一般表达式。第二部分是将此结果应用于特定的空间变化密度 $n(\\mathbf{r})$，并求出在调制振幅 $\\alpha$ 的二阶精度内的相应势。\n\n第一部分：LDA 交换势 $v_{x}^{\\text{LDA}}(n)$ 的推导\n\n在 LDA 中，交换能泛函由下式给出\n$$E_{x}[n]=\\int n(\\mathbf{r})\\,e_{x}(n(\\mathbf{r}))\\,d^{3}\\mathbf{r}$$\n其中 $e_{x}(n)$ 是密度为 $n$ 的均匀电子气的单个粒子交换能。问题给出了 $e_{x}(n)$ 的表达式：\n$$e_{x}(n)=-\\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}n^{1/3}$$\n为方便起见，我们定义一个常数 $C_{x} = \\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}$，因此 $e_{x}(n) = -C_{x}n^{1/3}$。\n将此代入 $E_{x}[n]$ 的泛函，我们得到：\n$$E_{x}[n]=\\int n(\\mathbf{r})\\left(-C_{x}\\left(n(\\mathbf{r})\\right)^{1/3}\\right)d^{3}\\mathbf{r} = -C_{x}\\int \\left(n(\\mathbf{r})\\right)^{4/3}d^{3}\\mathbf{r}$$\n被积函数是密度的局域函数，形式为 $f(n(\\mathbf{r})) = -C_{x}(n(\\mathbf{r}))^{4/3}$。LDA 交换势 $v_{x}^{\\text{LDA}}(\\mathbf{r})$ 定义为交换能泛函相对于密度的泛函导数：\n$$v_{x}^{\\text{LDA}}(\\mathbf{r})=\\frac{\\delta E_{x}[n]}{\\delta n(\\mathbf{r})}$$\n对于形式为 $F[n] = \\int f(n(\\mathbf{r}))\\,d^{3}\\mathbf{r}$ 的局域泛函，其泛函导数由被积函数对密度的普通导数给出：\n$$\\frac{\\delta F[n]}{\\delta n(\\mathbf{r})} = \\frac{d f(n)}{dn}\\bigg|_{n=n(\\mathbf{r})}$$\n将此规则应用于我们的交换泛函 $E_{x}[n]$：\n$$v_{x}^{\\text{LDA}}(\\mathbf{r}) = \\frac{d}{dn}\\left(-C_{x}n^{4/3}\\right)\\bigg|_{n=n(\\mathbf{r})} = -C_{x}\\frac{d}{dn}\\left(n^{4/3}\\right)\\bigg|_{n=n(\\mathbf{r})}$$\n进行微分得到：\n$$v_{x}^{\\text{LDA}}(\\mathbf{r}) = -C_{x}\\left(\\frac{4}{3}n^{1/3}\\right)\\bigg|_{n=n(\\mathbf{r})} = -\\frac{4}{3}C_{x}\\left(n(\\mathbf{r})\\right)^{1/3}$$\n这给出了作为密度局域函数的交换势。将常数 $C_{x}$ 代回：\n$$v_{x}^{\\text{LDA}}(n) = -\\frac{4}{3}\\left(\\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}\\right)n^{1/3} = -\\left(\\frac{3}{\\pi}\\right)^{1/3}n^{1/3}$$\n这是 LDA 交换势作为局域电子密度 $n$ 的函数的一般表达式。\n\n第二部分：对 $n(\\mathbf{r})=n_{0}\\left[1+\\alpha\\cos(kx)\\right]$ 进行求值\n\n给定一维密度调制：\n$$n(\\mathbf{r}) = n(x) = n_{0}\\left[1+\\alpha\\cos(kx)\\right]$$\n其中 $n_{0}0$，$k0$，且微扰振幅 $|\\alpha| \\ll 1$。我们需要使用第一部分推导的表达式计算 $v_{x}^{\\text{LDA}}(\\mathbf{r})$，并将结果按 $\\alpha$ 的幂次展开至 $\\alpha^{2}$ 阶。\n\n将 $n(\\mathbf{r})$ 代入 $v_{x}^{\\text{LDA}}(n)$ 的表达式：\n$$v_{x}^{\\text{LDA}}(\\mathbf{r}) = -\\left(\\frac{3}{\\pi}\\right)^{1/3}\\left(n(\\mathbf{r})\\right)^{1/3} = -\\left(\\frac{3}{\\pi}\\right)^{1/3}\\left(n_{0}\\left[1+\\alpha\\cos(kx)\\right]\\right)^{1/3}$$\n我们可以分离出常数部分：\n$$v_{x}^{\\text{LDA}}(\\mathbf{r}) = -\\left(\\frac{3n_{0}}{\\pi}\\right)^{1/3}\\left[1+\\alpha\\cos(kx)\\right]^{1/3}$$\n由于 $|\\alpha| \\ll 1$，我们可以对 $\\left[1+\\alpha\\cos(kx)\\right]^{1/3}$ 项进行泰勒展开。令 $u = \\alpha\\cos(kx)$。我们使用 $(1+u)^{p}$ 的二项式展开，直到 $u$ 的二阶：\n$$(1+u)^{p} \\approx 1 + pu + \\frac{p(p-1)}{2!}u^{2} + O(u^{3})$$\n在我们的情况下，指数为 $p = 1/3$。系数为：\n- 零阶：$1$\n- 一阶：$p = 1/3$\n- 二阶：$\\frac{p(p-1)}{2} = \\frac{(1/3)(1/3 - 1)}{2} = \\frac{(1/3)(-2/3)}{2} = -\\frac{1}{9}$\n代入这些系数和 $u = \\alpha\\cos(kx)$，我们得到：\n$$\\left[1+\\alpha\\cos(kx)\\right]^{1/3} \\approx 1 + \\frac{1}{3}\\left(\\alpha\\cos(kx)\\right) - \\frac{1}{9}\\left(\\alpha\\cos(kx)\\right)^{2}$$\n$$ = 1 + \\frac{1}{3}\\alpha\\cos(kx) - \\frac{1}{9}\\alpha^{2}\\cos^{2}(kx)$$\n问题要求结果用 $\\cos(kx)$ 和 $\\cos(2kx)$ 表示。我们使用三角恒等式 $\\cos^{2}(\\theta) = \\frac{1+\\cos(2\\theta)}{2}$。将其应用于 $\\cos^{2}(kx)$：\n$$\\cos^{2}(kx) = \\frac{1+\\cos(2kx)}{2}$$\n将此代入我们的展开式：\n$$\\left[1+\\alpha\\cos(kx)\\right]^{1/3} \\approx 1 + \\frac{1}{3}\\alpha\\cos(kx) - \\frac{1}{9}\\alpha^{2}\\left(\\frac{1+\\cos(2kx)}{2}\\right)$$\n$$ = 1 + \\frac{1}{3}\\alpha\\cos(kx) - \\frac{1}{18}\\alpha^{2} - \\frac{1}{18}\\alpha^{2}\\cos(2kx)$$\n现在，我们合并各项：一个常数项（零次谐波），一个含 $\\cos(kx)$ 的项（基波），以及一个含 $\\cos(2kx)$ 的项（二次谐波）。\n$$\\left[1+\\alpha\\cos(kx)\\right]^{1/3} \\approx \\left(1 - \\frac{1}{18}\\alpha^{2}\\right) + \\frac{1}{3}\\alpha\\cos(kx) - \\frac{1}{18}\\alpha^{2}\\cos(2kx)$$\n最后，我们将这个展开式代回 $v_{x}^{\\text{LDA}}(\\mathbf{r})$ 的表达式中：\n$$v_{x}^{\\text{LDA}}(\\mathbf{r}) = -\\left(\\frac{3n_{0}}{\\pi}\\right)^{1/3} \\left[ \\left(1 - \\frac{1}{18}\\alpha^{2}\\right) + \\frac{1}{3}\\alpha\\cos(kx) - \\frac{1}{18}\\alpha^{2}\\cos(2kx) \\right]$$\n这就是给定密度调制的 LDA 交换势的最终表达式，展开到 $\\alpha$ 的二阶，展示了二次谐波的产生。", "answer": "$$ \\boxed{-\\left(\\frac{3n_{0}}{\\pi}\\right)^{1/3} \\left(1 - \\frac{1}{18}\\alpha^{2} + \\frac{1}{3}\\alpha\\cos(kx) - \\frac{1}{18}\\alpha^{2}\\cos(2kx)\\right)} $$", "id": "3450841"}, {"introduction": "尽管 LDA 功能强大，但它建立在一个存在已知局限性的近似之上，其中最显著的便是自相互作用误差（SIE）。这个实践练习提供了一个绝佳的动手机会，让你能够在一个最简单也最极端的情况下——单个电子——来量化这一误差 [@problem_id:3450830]。对于单电子体系，精确的交换相关能应恰好抵消哈特里（Hartree）能量中的伪自相互作用，但 LDA 并不能满足此要求。通过计算哈特里能量与 LDA 交换相关能量之和，你将直接衡量这一基本缺陷的大小。", "problem": "考虑一个处于三维各向同性谐振子势阱中的单个电子，其角频率为 $\\omega$（原子单位）。在此单位制下，电子质量 $m=1$，约化普朗克常数 $\\hbar=1$。基态波函数是归一化的高斯函数\n$$\n\\psi(\\mathbf{r})=\\left(\\frac{\\alpha}{\\pi}\\right)^{3/4}\\exp\\left(-\\frac{\\alpha r^2}{2}\\right),\n$$\n相应的电子密度为\n$$\nn(\\mathbf{r})=\\left|\\psi(\\mathbf{r})\\right|^2=\\left(\\frac{\\alpha}{\\pi}\\right)^{3/2}\\exp\\left(-\\alpha r^2\\right),\n$$\n其中 $\\alpha\\equiv\\omega$。使用此密度，计算自相互作用误差\n$$\nE_{\\text{SIE}}[n]=E_{\\text{H}}[n]+E_{xc}^{\\text{LDA}}[n],\n$$\n其中 $E_{\\text{H}}[n]$ 是 Hartree 能量，$E_{xc}^{\\text{LDA}}[n]$ 是局域密度近似 (LDA) 中的交换相关能。\n\n从以下基本定义和事实出发：\n\n1. Hartree 能量泛函为\n$$\nE_{\\text{H}}[n]=\\frac{1}{2}\\int d^3\\mathbf{r}\\int d^3\\mathbf{r}'\\frac{n(\\mathbf{r})\\,n(\\mathbf{r}')}{\\left\\|\\mathbf{r}-\\mathbf{r}'\\right\\|}.\n$$\n\n2. 对于自旋相关的局域自旋密度近似 (LSDA)，交换能为\n$$\nE_{x}^{\\text{LSDA}}[n_\\uparrow,n_\\downarrow]=-\\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}\\int d^3\\mathbf{r}\\,\\left[n_\\uparrow(\\mathbf{r})^{4/3}+n_\\downarrow(\\mathbf{r})^{4/3}\\right].\n$$\n对于单个电子，假设其完全自旋极化，因此 $n_\\uparrow(\\mathbf{r})=n(\\mathbf{r})$ 且 $n_\\downarrow(\\mathbf{r})=0$。\n\n3. LSDA 中的相关能由下式给出\n$$\nE_{c}^{\\text{LSDA}}[n_\\uparrow,n_\\downarrow]=\\int d^3\\mathbf{r}\\, n(\\mathbf{r})\\,\\varepsilon_c\\!\\left(r_s(\\mathbf{r}),\\zeta\\right),\n$$\n其中 Wigner–Seitz 半径为 $r_s(\\mathbf{r})=\\left(\\frac{3}{4\\pi n(\\mathbf{r})}\\right)^{1/3}$，自旋极化率为 $\\zeta=\\frac{n_\\uparrow-n_\\downarrow}{n_\\uparrow+n_\\downarrow}$。对于单个电子，取 $\\zeta=1$。对于完全自旋极化情况 ($\\zeta=1$)，使用 Perdew–Zunger 1981 (PZ81) 参数化方案计算单个电子的相关能 $\\varepsilon_c(r_s,\\zeta)$，具体如下：\n- 对于 $r_s  1$：\n$$\n\\varepsilon_c(r_s,1)=A_p\\ln r_s + B_p + C_p r_s \\ln r_s + D_p r_s,\n$$\n- 对于 $r_s\\ge 1$：\n$$\n\\varepsilon_c(r_s,1)=\\frac{\\gamma_p}{1+\\beta_{1p}\\sqrt{r_s}+\\beta_{2p}r_s},\n$$\n其中常数为\n$$\nA_p=0.01555,\\quad B_p=-0.0269,\\quad C_p=0.0007,\\quad D_p=-0.0048,\n$$\n$$\n\\gamma_p=-0.0843,\\quad \\beta_{1p}=1.3981,\\quad \\beta_{2p}=0.2611.\n$$\n\n您的任务是实现一个程序，对于每个指定的 $\\omega$ 值，构建 $n(\\mathbf{r})$ 并计算\n$$\nE_{\\text{SIE}}(\\omega)=E_{\\text{H}}[n]+E_{x}^{\\text{LSDA}}[n]+E_{c}^{\\text{LSDA}}[n],\n$$\n结果以 Hartree（原子单位）表示。\n\n为确保数值稳健性，请在适当之处利用球对称性，并对相关能部分使用稳定的数值积分方法。您可以进行基于上述基本定义的解析简化，但不得引入任何非标准近似。\n\n物理单位：所有能量均以 Hartree 报告。最终输出必须将计算值列为浮点数。\n\n测试用例：\n- 情况 1：$\\omega=0.01$，\n- 情况 2：$\\omega=0.10$，\n- 情况 3：$\\omega=1.00$，\n- 情况 4：$\\omega=5.00$，\n- 情况 5：$\\omega=20.00$，\n- 情况 6：$\\omega=50.00$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含六个结果，以逗号分隔，并用方括号括起来（例如，“[result1,result2,result3,result4,result5,result6]”）。", "solution": "用户提供的问题是有效的，因为它在密度泛函理论中有科学依据，在数学上是适定的，并且为获得唯一解提供了所有必要信息。\n\n我们的目标是计算由高斯密度描述的单电子体系的自相互作用误差 $E_{\\text{SIE}}$。自相互作用误差定义为 Hartree 能量 $E_{\\text{H}}$ 与局域密度近似 (LDA) 下的交换相关能 $E_{xc}^{\\text{LDA}}$ 之和。对于单电子体系，精确的交换相关泛函必须能精确抵消虚假的 Hartree 自相互作用，从而使总自相互作用能为零。因此，计算出的 $E_{\\text{SIE}}$ 量化了 LDA 对于该体系的误差。\n\n总自相互作用误差由下式给出：\n$$\nE_{\\text{SIE}}(\\omega) = E_{\\text{H}}[n] + E_{x}^{\\text{LSDA}}[n] + E_{c}^{\\text{LSDA}}[n]\n$$\n对于角频率为 $\\omega$ 的三维各向同性谐振子势阱中的电子，其电子密度 $n(\\mathbf{r})$ 如下：\n$$\nn(\\mathbf{r}) = \\left(\\frac{\\alpha}{\\pi}\\right)^{3/2}\\exp\\left(-\\alpha r^2\\right)\n$$\n其中 $\\alpha \\equiv \\omega$ 且 $r = \\left\\|\\mathbf{r}\\right\\|$。该密度是归一化的，满足 $\\int n(\\mathbf{r}) d^3\\mathbf{r} = 1$。下面将分别讨论每个能量分量的计算。\n\n**1. Hartree 能量, $E_{\\text{H}}[n]$**\n\nHartree 能量表示电荷分布 $n(\\mathbf{r})$ 的经典静电自能：\n$$\nE_{\\text{H}}[n]=\\frac{1}{2}\\int d^3\\mathbf{r}\\int d^3\\mathbf{r}'\\frac{n(\\mathbf{r})\\,n(\\mathbf{r}')}{\\left\\|\\mathbf{r}-\\mathbf{r}'\\right\\|}\n$$\n对于球对称高斯电荷分布，该积分有著名的解析解。首先，我们计算由密度 $n(r)$ 产生的静电势 $\\phi(r)$：\n$$\n\\phi(r) = \\int d^3\\mathbf{r}' \\frac{n(r')}{\\left\\|\\mathbf{r}-\\mathbf{r}'\\right\\|} = \\frac{\\text{erf}(\\sqrt{\\alpha}r)}{r}\n$$\n其中 $\\text{erf}(x)$ 是误差函数。Hartree 能量则为：\n$$\nE_{\\text{H}}[n] = \\frac{1}{2} \\int n(\\mathbf{r}) \\phi(\\mathbf{r}) d^3\\mathbf{r} = \\frac{1}{2} \\int_0^\\infty 4\\pi r^2 dr \\, \\left(\\frac{\\alpha}{\\pi}\\right)^{3/2} e^{-\\alpha r^2} \\frac{\\text{erf}(\\sqrt{\\alpha}r)}{r}\n$$\n该积分的计算结果为：\n$$\nE_{\\text{H}}[n] = \\sqrt{\\frac{\\alpha}{2\\pi}}\n$$\n由于 $\\alpha = \\omega$，Hartree 能量为 $E_{\\text{H}} = \\sqrt{\\frac{\\omega}{2\\pi}}$。\n\n**2. 交换能, $E_{x}^{\\text{LSDA}}[n]$**\n\n对于单个完全自旋极化的电子 ($n_\\uparrow = n$, $n_\\downarrow = 0$)，LSDA 交换能泛函为：\n$$\nE_{x}^{\\text{LSDA}}[n] = -\\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}\\int d^3\\mathbf{r}\\,n(\\mathbf{r})^{4/3}\n$$\n我们将高斯密度代入此表达式：\n$$\nn(\\mathbf{r})^{4/3} = \\left[\\left(\\frac{\\alpha}{\\pi}\\right)^{3/2} e^{-\\alpha r^2}\\right]^{4/3} = \\left(\\frac{\\alpha}{\\pi}\\right)^2 e^{-\\frac{4\\alpha}{3} r^2}\n$$\n对全空间的积分变为：\n$$\n\\int n(\\mathbf{r})^{4/3} d^3\\mathbf{r} = 4\\pi \\left(\\frac{\\alpha}{\\pi}\\right)^2 \\int_0^\\infty r^2 e^{-\\frac{4\\alpha}{3} r^2} dr\n$$\n这是一个标准的高斯积分，其值为 $\\frac{\\sqrt{\\pi}}{4(4\\alpha/3)^{3/2}}$。因此，完整的积分为 $\\frac{3\\sqrt{3}}{8\\sqrt{\\pi}}\\sqrt{\\alpha}$。\n将此结果代回 $E_{x}^{\\text{LSDA}}[n]$ 的表达式中，得到解析结果：\n$$\nE_{x}^{\\text{LSDA}}[n] = -\\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3} \\frac{3\\sqrt{3}}{8\\sqrt{\\pi}}\\sqrt{\\alpha} = -\\frac{3^{17/6}}{32 \\pi^{5/6}} \\sqrt{\\omega}\n$$\n\n**3. 相关能, $E_{c}^{\\text{LSDA}}[n]$**\n\n相关能由一个必须进行数值计算的积分给出：\n$$\nE_{c}^{\\text{LSDA}}[n]=\\int d^3\\mathbf{r}\\, n(\\mathbf{r})\\,\\varepsilon_c(r_s(\\mathbf{r}),1) = \\int_0^\\infty 4\\pi r^2 n(r) \\varepsilon_c(r_s(r),1) dr\n$$\nWigner-Seitz 半径 $r_s$ 取决于局域密度 $n(r)$：\n$$\nr_s(r) = \\left(\\frac{3}{4\\pi n(r)}\\right)^{1/3} = \\left(\\frac{3}{4\\pi} \\left(\\frac{\\pi}{\\alpha}\\right)^{3/2} e^{\\alpha r^2}\\right)^{1/3} = \\left(\\frac{3 \\pi^{1/2}}{4 \\alpha^{3/2}}\\right)^{1/3} e^{\\alpha r^2/3}\n$$\n单粒子相关能 $\\varepsilon_c(r_s,1)$ 由 Perdew-Zunger 1981 (PZ81) 参数化方案给出，这是一个分段函数，具体形式取决于 $r_s  1$（高密度区）还是 $r_s \\ge 1$（低密度区）。\n\n条件 $r_s(r)=1$ 定义了一个过渡半径 $r_t$。$r_s(r)$ 是 $r$ 的单调递增函数。其最小值出现在 $r=0$ 处。$r_s(0)$ 的值取决于 $\\alpha$：\n$$\nr_s(0) = \\left(\\frac{3 \\pi^{1/2}}{4 \\alpha^{3/2}}\\right)^{1/3}\n$$\n存在一个 $\\alpha$ 的临界值，记为 $\\alpha_{\\text{crit}}$，在该值处 $r_s(0)=1$：\n$$\n\\alpha_{\\text{crit}} = \\left(\\frac{3\\sqrt{\\pi}}{4}\\right)^{2/3} \\approx 1.2106\n$$\n- 如果 $\\omega = \\alpha \\le \\alpha_{\\text{crit}}$，那么对于所有 $r \\ge 0$，都有 $r_s(r) \\ge 1$。整个积分域都使用低密度（$r_s \\ge 1$）的 $\\varepsilon_c$ 公式。\n- 如果 $\\omega = \\alpha  \\alpha_{\\text{crit}}$，那么 $r_s(r)$ 会在一个特定的半径 $r_t$ 处穿过值 1。积分必须被分成两部分。通过求解 $r_s(r_t)=1$ 可以找到过渡半径 $r_t$：\n$$\nr_t = \\sqrt{\\frac{1}{\\alpha} \\ln\\left(\\frac{4 \\alpha^{3/2}}{3 \\pi^{1/2}}\\right)}\n$$\n对于 $\\alpha  \\alpha_{\\text{crit}}$，相关能计算如下：\n$$\nE_c = \\int_0^{r_t} 4\\pi r^2 n(r) \\varepsilon_c(r_s  1) dr + \\int_{r_t}^{\\infty} 4\\pi r^2 n(r) \\varepsilon_c(r_s\\ge1) dr\n$$\n\n**数值算法**\n整体算法如下：\n1. 对于每个给定的 $\\omega$ 值，设置 $\\alpha = \\omega$。\n2. 使用推导出的对 $\\sqrt{\\omega}$ 的依赖关系，解析地计算 $E_{\\text{H}}$ 和 $E_{x}^{\\text{LSDA}}$。\n3. 对于 $E_{c}^{\\text{LSDA}}$，判断是 $\\alpha \\le \\alpha_{\\text{crit}}$ 还是 $\\alpha  \\alpha_{\\text{crit}}$。\n4. 根据此条件，使用相应的 PZ81 公式为 $E_c$ 建立合适的数值积分。可以使用像 `scipy.integrate.quad` 这样的求积方法高效地计算这些积分。无限积分域在一个 $r_{\\text{max}}$ 值处被截断，在该处高斯密度 $n(r)$ 变得可以忽略不计（例如，$\\alpha r_{\\text{max}}^2 \\approx 30$）。\n5. 将三个能量分量相加：$E_{\\text{SIE}} = E_{\\text{H}} + E_{x}^{\\text{LSDA}} + E_{c}^{\\text{LSDA}}$。\n\n此过程为每个指定的频率 $\\omega$ 提供了稳健且准确的自相互作用误差值。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Computes the self-interaction error for a single electron in a 3D harmonic trap\n    using the Local Density Approximation (LDA) for exchange-correlation.\n    \"\"\"\n    \n    # Define the constants for the PZ81 correlation functional (spin-polarized case, zeta=1)\n    # High-density regime (rs  1)\n    AP = 0.01555\n    BP = -0.0269\n    CP = 0.0007\n    DP = -0.0048\n    # Low-density regime (rs = 1)\n    GAMMA_P = -0.0843\n    BETA_1P = 1.3981\n    BETA_2P = 0.2611\n\n    def calculate_sie(omega):\n        \"\"\"\n        Calculates E_SIE for a given angular frequency omega.\n        \"\"\"\n        alpha = float(omega)\n\n        # 1. Hartree Energy (analytical result)\n        # E_H = sqrt(alpha / (2*pi))\n        e_h = np.sqrt(alpha / (2 * np.pi))\n\n        # 2. Exchange Energy (analytical result for LSDA)\n        # E_x = - (3**(17/6)) / (32 * pi**(5/6)) * sqrt(alpha)\n        exch_coeff = (3**(17/6)) / (32 * np.pi**(5/6))\n        e_x = -exch_coeff * np.sqrt(alpha)\n\n        # 3. Correlation Energy (numerical integration)\n        # Define helper functions for the integrand\n        def n_func(r, a):\n            # Electron density n(r)\n            return (a / np.pi)**1.5 * np.exp(-a * r**2)\n\n        def rs_func_direct(r, a):\n            # Wigner-Seitz radius r_s(r)\n            # This form is numerically stable and avoids underflow of n(r)\n            return ((3 * np.sqrt(np.pi)) / (4 * a**1.5))**(1/3) * np.exp(a * r**2 / 3)\n        \n        # Determine if the integral needs to be split\n        alpha_crit = (3 * np.sqrt(np.pi) / 4)**(2/3) # ~1.2106\n\n        e_c = 0.0\n        # The integration upper bound can be truncated as the Gaussian decays rapidly.\n        # A limit where alpha * r^2 = 35 is sufficient for double precision.\n        r_max_integration = np.sqrt(35 / alpha)\n\n        if alpha = alpha_crit:\n            # For small alpha, rs = 1 for all r. Use only the low-density formula.\n            def ec_integrand_low(r, a):\n                rs = rs_func_direct(r, a)\n                n_r = n_func(r, a)\n                eps_c = GAMMA_P / (1 + BETA_1P * np.sqrt(rs) + BETA_2P * rs)\n                return 4 * np.pi * r**2 * n_r * eps_c\n            \n            e_c, _ = integrate.quad(ec_integrand_low, 0, r_max_integration, args=(alpha,), epsabs=1e-12, epsrel=1e-12)\n        else:\n            # For large alpha, rs crosses 1. Split the integral at r_t.\n            r_t = np.sqrt((1/alpha) * np.log( (4 * alpha**1.5) / (3 * np.sqrt(np.pi)) ))\n\n            # Integrand for high-density regime (rs  1)\n            def ec_integrand_high(r, a):\n                rs = rs_func_direct(r, a)\n                # rs can be very small, so log(rs) might be an issue, but quad handles it.\n                if rs == 0: return 0.0\n                n_r = n_func(r, a)\n                eps_c = AP * np.log(rs) + BP + CP * rs * np.log(rs) + DP * rs\n                return 4 * np.pi * r**2 * n_r * eps_c\n\n            # Integrand for low-density regime (rs = 1)\n            def ec_integrand_low(r, a):\n                rs = rs_func_direct(r, a)\n                n_r = n_func(r, a)\n                eps_c = GAMMA_P / (1 + BETA_1P * np.sqrt(rs) + BETA_2P * rs)\n                return 4 * np.pi * r**2 * n_r * eps_c\n\n            # Part 1: Integral from 0 to r_t (high-density)\n            e_c1, _ = integrate.quad(ec_integrand_high, 0, r_t, args=(alpha,), epsabs=1e-12, epsrel=1e-12)\n            \n            # Part 2: Integral from r_t to infinity (low-density)\n            e_c2, _ = integrate.quad(ec_integrand_low, r_t, r_max_integration, args=(alpha,), epsabs=1e-12, epsrel=1e-12)\n\n            e_c = e_c1 + e_c2\n\n        # Total Self-Interaction Error\n        return e_h + e_x + e_c\n\n    # Define the test cases from the problem statement.\n    test_cases = [0.01, 0.10, 1.00, 5.00, 20.00, 50.00]\n\n    results = []\n    for omega_val in test_cases:\n        result = calculate_sie(omega_val)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3450830"}]}