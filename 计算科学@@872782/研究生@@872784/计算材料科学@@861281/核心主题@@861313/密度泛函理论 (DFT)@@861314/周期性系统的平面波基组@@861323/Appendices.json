{"hands_on_practices": [{"introduction": "将能量截断这一抽象概念与空间分辨率这一具体概念联系起来至关重要。通过推导能量截断 $E_{\\text{cut}}$ 与实空间分辨率 $\\Delta r$ 之间的关系 [@problem_id:3478136]，你将对基组大小如何决定描述电子密度和势中尖锐特征（例如原子核附近的特征）的能力有一个定量的理解。这是在任何平面波计算中需要考虑的第一个也是最基本的收敛参数。", "problem": "在密度泛函理论 (DFT) 的周期性晶体计算中，布洛赫波函数展开为 $\\psi_{n\\mathbf{k}}(\\mathbf{r}) = \\exp(i \\mathbf{k}\\cdot\\mathbf{r})\\,u_{n\\mathbf{k}}(\\mathbf{r})$，其中，晶格周期部分 $u_{n\\mathbf{k}}(\\mathbf{r})$ 在平面波基组中表示为 $u_{n\\mathbf{k}}(\\mathbf{r}) = \\sum_{\\mathbf{G}} c_{n\\mathbf{k}}(\\mathbf{G}) \\exp(i \\mathbf{G}\\cdot\\mathbf{r})$。该基组通过条件 $\\frac{\\hbar^{2}}{2 m_{e}}|\\mathbf{k}+\\mathbf{G}|^{2} \\leq E_{\\text{cut}}$ 被一个动能截断能 $E_{\\text{cut}}$ 所截断，其中 $\\hbar$ 是约化普朗克常数，$m_{e}$ 是电子质量。考虑一个用于表示 $u_{n\\mathbf{k}}(\\mathbf{r})$ 的间距为 $\\Delta r$ 的三维各向同性实空间网格，并假设计算在布里渊区 (BZ) 中心，即 $\\mathbf{k}=\\mathbf{0}$ 处进行。仅使用周期函数的傅里叶表示的第一性原理和采样定理（奈奎斯特-香农定理），通过关联忠实表示特征尺寸为 $\\Delta r$ 的特征所需的最大倒易空间矢量模长 $|\\mathbf{G}|$，推导出一个将所需最小动能截断能 $E_{\\text{cut}}$ 与目标实空间分辨率 $\\Delta r$ 联系起来的表达式。\n\n然后，对目标分辨率 $\\Delta r = 0.50 \\ \\text{\\AA}$ 计算该表达式的值。使用常数 $1 \\ \\text{\\AA} = 1.0 \\times 10^{-10} \\ \\text{m}$，$\\hbar = 1.054 \\, 571 \\, 817 \\times 10^{-34} \\ \\text{J}\\,\\text{s}$，$m_{e} = 9.109 \\, 383 \\, 7015 \\times 10^{-31} \\ \\text{kg}$，以及转换关系 $1 \\ \\text{eV} = 1.602 \\, 176 \\, 634 \\times 10^{-19} \\ \\text{J}$。将最终能量以电子伏特 (eV) 表示，并将您的答案四舍五入到四位有效数字。", "solution": "题目要求推导周期性晶体计算中平面波动能截断能 $E_{\\text{cut}}$ 和实空间网格分辨率 $\\Delta r$ 之间的关系。随后，必须对一个特定的分辨率计算该表达式的值。\n\n出发点是将布洛赫波函数的晶格周期部分 $u_{n\\mathbf{k}}(\\mathbf{r})$ 展开为平面波基组。在布里渊区中心 ($\\mathbf{k}=\\mathbf{0}$) 处，该展开式由下式给出：\n$$\nu_{n\\mathbf{0}}(\\mathbf{r}) = \\sum_{\\mathbf{G}} c_{n\\mathbf{0}}(\\mathbf{G}) \\exp(i \\mathbf{G}\\cdot\\mathbf{r})\n$$\n其中 $\\mathbf{G}$ 是倒易晶格矢量。这是周期函数 $u_{n\\mathbf{0}}(\\mathbf{r})$ 的傅里叶级数表示。\n\n基组是通过仅包含动能低于某个截断能 $E_{\\text{cut}}$ 的平面波来截断的。对于 $\\mathbf{k}=\\mathbf{0}$，该条件为：\n$$\n\\frac{\\hbar^{2}}{2 m_{e}}|\\mathbf{G}|^{2} \\leq E_{\\text{cut}}\n$$\n这意味着基组包含所有模长直到某个最大值（我们将其表示为 $|\\mathbf{G}|_{\\text{max}}$）的倒易晶格矢量 $\\mathbf{G}$。因此，最小能量截断能由该最大模长决定：\n$$\nE_{\\text{cut}} = \\frac{\\hbar^{2}}{2 m_{e}}|\\mathbf{G}|_{\\text{max}}^{2}\n$$\n题目要求使用奈奎斯特-香农采样定理将此截断能与实空间分辨率 $\\Delta r$ 联系起来。该定理指出，要完美重构一个信号，采样率必须至少是其最高频率分量的两倍。在空间函数的背景下，这意味着采样间隔（网格间距）必须足够小，以捕捉函数中振荡最快的分量。\n\n实空间中快速变化的特征对应于倒易空间中的高频（大波矢）分量。设一个“特征尺寸为 $\\Delta r$ 的特征”是我们希望解析的最小空间变化。这可以被建模为一个半波长等于 $\\Delta r$ 的正弦波。因此，这个振荡最快分量的全波长是 $\\lambda_{\\text{min}} = 2\\Delta r$。\n\n对应于波长 $\\lambda$ 的波矢模长由关系式 $k = 2\\pi/\\lambda$ 给出。为了表示一个最小波长为 $\\lambda_{\\text{min}}$ 的特征，我们必须包含所有波矢模长直到 $|\\mathbf{G}|_{\\text{max}}$ 的平面波，其中：\n$$\n|\\mathbf{G}|_{\\text{max}} = \\frac{2\\pi}{\\lambda_{\\text{min}}}\n$$\n将 $\\lambda_{\\text{min}} = 2\\Delta r$ 代入此方程，得到所需的倒易晶格矢量的最大模长：\n$$\n|\\mathbf{G}|_{\\text{max}} = \\frac{2\\pi}{2\\Delta r} = \\frac{\\pi}{\\Delta r}\n$$\n这就建立了实空间分辨率与倒易空间基组所需范围之间的联系。\n\n现在，我们可以通过将 $|\\mathbf{G}|_{\\text{max}}$ 的这个结果代入能量截断能公式来推导 $E_{\\text{cut}}$ 的表达式：\n$$\nE_{\\text{cut}} = \\frac{\\hbar^{2}}{2 m_{e}} \\left( \\frac{\\pi}{\\Delta r} \\right)^{2} = \\frac{\\hbar^{2} \\pi^{2}}{2 m_{e} (\\Delta r)^{2}}\n$$\n这就是所求的将最小动能截断能与目标实空间分辨率联系起来的表达式。\n\n接下来，我们用给定的值来计算这个表达式：\n- 目标分辨率：$\\Delta r = 0.50 \\ \\text{\\AA} = 0.50 \\times 10^{-10} \\ \\text{m}$\n- 约化普朗克常数：$\\hbar = 1.054571817 \\times 10^{-34} \\ \\text{J}\\,\\text{s}$\n- 电子质量：$m_{e} = 9.1093837015 \\times 10^{-31} \\ \\text{kg}$\n- 能量转换：$1 \\ \\text{eV} = 1.602176634 \\times 10^{-19} \\ \\text{J}$\n\n我们将这些国际单位制 (SI) 的值代入推导出的公式：\n$$\nE_{\\text{cut}} = \\frac{(1.054571817 \\times 10^{-34} \\ \\text{J}\\,\\text{s})^{2} \\pi^{2}}{2 (9.1093837015 \\times 10^{-31} \\ \\text{kg}) (0.50 \\times 10^{-10} \\ \\text{m})^{2}}\n$$\n首先，我们计算分子和分母：\n分子：$(\\hbar\\pi)^2 \\approx (1.054571817 \\times 10^{-34} \\times 3.1415926535...)^2 \\approx 1.0975608 \\times 10^{-67} \\ (\\text{J}\\,\\text{s})^2$\n分母：$2 m_{e} (\\Delta r)^2 = 2 \\times (9.1093837015 \\times 10^{-31}) \\times (0.50 \\times 10^{-10})^2 \\approx 4.5546919 \\times 10^{-51} \\ \\text{kg}\\,\\text{m}^2$\n\n现在，我们计算以焦耳为单位的 $E_{\\text{cut}}$：\n$$\nE_{\\text{cut}} = \\frac{1.0975608 \\times 10^{-67} \\ \\text{J}^2 \\text{s}^2}{4.5546919 \\times 10^{-51} \\ \\text{kg}\\,\\text{m}^2} \\approx 2.409739 \\times 10^{-17} \\ \\text{J}\n$$\n为了将此能量表示为电子伏特 (eV)，我们使用转换因子：\n$$\nE_{\\text{cut}} (\\text{in eV}) = \\frac{E_{\\text{cut}} (\\text{in J})}{1.602176634 \\times 10^{-19} \\ \\text{J/eV}}\n$$\n$$\nE_{\\text{cut}} (\\text{in eV}) = \\frac{2.409739 \\times 10^{-17}}{1.602176634 \\times 10^{-19}} \\approx 150.4032 \\ \\text{eV}\n$$\n题目要求将答案四舍五入到四位有效数字。将 $150.4032$ 四舍五入到四位有效数字得到 $150.4$。", "answer": "$$\\boxed{150.4}$$", "id": "3478136"}, {"introduction": "现代平面波代码严重依赖快速傅里叶变换 (FFT) 来提高计算效率，特别是在计算电子密度和有效势的乘积等项时。这个练习 [@problem_id:3478114] 深入探讨了一个关键的实践问题：如何选择一个合适的实空间 FFT 网格以避免“混叠”误差。当网格过于粗糙，无法表示卷积过程中产生的高频分量时，就会出现这种误差。掌握这个概念是确保密度泛函理论 (DFT) 计算数值准确性的关键。", "problem": "考虑一个边长分别为 $L_{x}$、$L_{y}$ 和 $L_{z}$（单位为玻尔）的周期性正交模拟晶胞。一个标量场（例如电子密度或静电势）的平面波表示在动能截断能 $E_{\\text{cut}}$（单位为原子单位）处被截断，因此只有满足 $|\\mathbf{G}| \\leq G_{\\text{max}}$ 的倒易格矢 $\\mathbf{G}$ 被保留，其中 $G_{\\text{max}} = \\sqrt{2 E_{\\text{cut}}}$。为了通过卷积定理计算实空间乘积 $\\rho(\\mathbf{r}) V(\\mathbf{r})$，必须确保 $\\rho(\\mathbf{G})$ 和 $V(\\mathbf{G})$ 的相关倒易空间卷积在由实空间快速傅里叶变换（FFT）格点定义的离散倒易格点上不会出现环绕（混叠）现象。\n\n从平面波动能与倒易格矢大小之间的基本关系、沿方向 $i \\in \\{x,y,z\\}$ 的 $N_{i}$ 点格点的离散傅里叶变换的倒易晶格结构以及卷积定理出发，推导为避免两个具有共同球面截断 $|\\mathbf{G}| \\leq G_{\\text{max}}$ 的带限场的倒易空间卷积发生环绕现象所需的最小FFT格点维度 $(N_{x}, N_{y}, N_{z})$ 的条件。然后将您推导出的条件应用于以下晶胞和截断能：\n- $L_{x} = 9.5$ 玻尔，$L_{y} = 11.3$ 玻尔，$L_{z} = 14.2$ 玻尔，\n- $E_{\\text{cut}} = 25$ 哈特里（原子单位）。\n\n报告满足无环绕条件的最小整数三元组 $(N_{x}, N_{y}, N_{z})$。将最终答案表示为一个整数行向量。不要按有效数字四舍五入；选择满足条件的最小整数。", "solution": "问题陈述已经过验证，并被认为是有效的。它具有科学依据、是适定的、客观的，并包含了推导出唯一解所需的所有必要信息。其背景和参数在计算材料科学领域是标准的。\n\n该问题要求推导计算两个标量场 $\\rho(\\mathbf{r})$ 和 $V(\\mathbf{r})$ 的实空间乘积而无混叠误差所需的最小快速傅里叶变换（FFT）格点维度 $(N_x, N_y, N_z)$。计算是在周期性体系的平面波框架内进行的。\n\n设正交模拟晶胞的尺寸为 $L_x$、$L_y$ 和 $L_z$。相应的倒易晶格基矢为 $\\mathbf{b}_1 = \\frac{2\\pi}{L_x}\\hat{x}$、$\\mathbf{b}_2 = \\frac{2\\pi}{L_y}\\hat{y}$ 和 $\\mathbf{b}_3 = \\frac{2\\pi}{L_z}\\hat{z}$。任何倒易格矢 $\\mathbf{G}$ 都是这些基矢的整数线性组合。\n\n标量场 $\\rho(\\mathbf{r})$ 和 $V(\\mathbf{r})$ 通过平面波展开式表示：\n$$ f(\\mathbf{r}) = \\sum_{\\mathbf{G}} f(\\mathbf{G}) \\exp(i\\mathbf{G} \\cdot \\mathbf{r}) $$\n其中 $f(\\mathbf{G})$ 是傅里叶系数。基组被动能截断能 $E_{\\text{cut}}$ 截断，因此只包含满足 $\\frac{\\hbar^2 |\\mathbf{G}|^2}{2m_e} \\leq E_{\\text{cut}}$ 的平面波。在原子单位（哈特里）中，$\\hbar = 1$ 且电子质量 $m_e = 1$，该条件简化为 $\\frac{|\\mathbf{G}|^2}{2} \\leq E_{\\text{cut}}$。这意味着傅里叶系数 $\\rho(\\mathbf{G})$ 和 $V(\\mathbf{G})$ 仅对于位于半径为 $G_{\\text{max}}$ 的球内的倒易格矢 $\\mathbf{G}$ 才非零，该半径定义为：\n$$ |\\mathbf{G}| \\leq G_{\\text{max}} = \\sqrt{2 E_{\\text{cut}}} $$\n这样的场被称为带限于 $G_{\\text{max}}$。\n\n实空间乘积 $p(\\mathbf{r}) = \\rho(\\mathbf{r})V(\\mathbf{r})$ 使用卷积定理计算。乘积的傅里叶系数 $p(\\mathbf{G})$ 由 $\\rho$ 和 $V$ 的系数的离散卷积给出：\n$$ p(\\mathbf{G}) = \\sum_{\\mathbf{G'}} \\rho(\\mathbf{G'}) V(\\mathbf{G} - \\mathbf{G'}) $$\n使 $p(\\mathbf{G})$ 可能非零的向量 $\\mathbf{G}$ 是两个向量的和，即来自 $\\rho$ 展开的 $\\mathbf{G'}$ 和来自 $V$ 展开的 $\\mathbf{G''} = \\mathbf{G} - \\mathbf{G'}$。由于 $|\\mathbf{G'}| \\leq G_{\\text{max}}$ 且 $|\\mathbf{G''}| \\leq G_{\\text{max}}$，它们的和的大小受三角不等式限制：\n$$ |\\mathbf{G}| = |\\mathbf{G'} + \\mathbf{G''}| \\leq |\\mathbf{G'}| + |\\mathbf{G''}| \\leq G_{\\text{max}} + G_{\\text{max}} = 2G_{\\text{max}} $$\n因此，乘积场 $p(\\mathbf{r})$ 被带限于一个半径为 $2G_{\\text{max}}$ 的球。\n\n为了在离散格点上表示 $p(\\mathbf{r})$ 而不产生混叠（环绕误差），格点必须满足奈奎斯特-香农采样定理。该定理指出，信号的采样率必须至少是其最高频率的两倍。在空间域中，这意味着沿每个维度 $i \\in \\{x,y,z\\}$ 的采样间隔 $\\Delta x_i$ 必须足够小，以捕捉最高的空间频率分量。空间频率 $f$ 与波矢分量 $G_i$ 的关系为 $f_i = G_i / (2\\pi)$。乘积 $p(\\mathbf{r})$ 沿任何方向 $i$ 的最大波矢分量值为 $2G_{\\text{max}}$。这对应于最大空间频率：\n$$ f_{\\text{max}, i} = \\frac{2G_{\\text{max}}}{2\\pi} = \\frac{G_{\\text{max}}}{\\pi} $$\n实空间格点在长度为 $L_i$ 的维度 $i$ 上有 $N_i$ 个点，因此采样间隔为 $\\Delta x_i = L_i / N_i$。采样率为 $f_{s,i} = 1/\\Delta x_i = N_i/L_i$。奈奎斯特准则要求 $f_{s,i} \\geq 2f_{\\text{max}, i}$：\n$$ \\frac{N_i}{L_i} \\geq 2 \\left( \\frac{G_{\\text{max}}}{\\pi} \\right) $$\n对 $N_i$ 重新整理，得到每个维度上最小格点数的条件：\n$$ N_i \\geq \\frac{2 L_i G_{\\text{max}}}{\\pi} $$\n由于 $N_i$ 必须是整数，其最小值是满足此不等式的最小整数，通过对右侧表达式取上整得到。\n$$ N_i = \\left\\lceil \\frac{2 L_i \\sqrt{2 E_{\\text{cut}}}}{\\pi} \\right\\rceil $$\n现在，我们将此公式应用于给定参数：\n- $L_x = 9.5$ 玻尔\n- $L_y = 11.3$ 玻尔\n- $L_z = 14.2$ 玻尔\n- $E_{\\text{cut}} = 25$ 哈特里\n\n首先，我们计算倒易空间中的截断半径 $G_{\\text{max}}$：\n$$ G_{\\text{max}} = \\sqrt{2 E_{\\text{cut}}} = \\sqrt{2 \\times 25} = \\sqrt{50} \\text{ 玻尔}^{-1} $$\n现在我们计算 $N_x$、$N_y$ 和 $N_z$ 的最小整数值：\n\n对于x维度：\n$$ N_x \\geq \\frac{2 \\times 9.5 \\times \\sqrt{50}}{\\pi} = \\frac{19\\sqrt{50}}{\\pi} \\approx 42.765 $$\n满足此条件的最小整数是 $N_x = 43$。\n\n对于y维度：\n$$ N_y \\geq \\frac{2 \\times 11.3 \\times \\sqrt{50}}{\\pi} = \\frac{22.6\\sqrt{50}}{\\pi} \\approx 50.868 $$\n满足此条件的最小整数是 $N_y = 51$。\n\n对于z维度：\n$$ N_z \\geq \\frac{2 \\times 14.2 \\times \\sqrt{50}}{\\pi} = \\frac{28.4\\sqrt{50}}{\\pi} \\approx 63.922 $$\n满足此条件的最小整数是 $N_z = 64$。\n\n为避免环绕误差所需的最小FFT格点维度为 $(N_x, N_y, N_z) = (43, 51, 64)$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n43  51  64\n\\end{pmatrix}\n}\n$$", "id": "3478114"}, {"introduction": "一个不完备的基组会引入人为的力和应力，统称为 Pulay 误差。这个思想实验 [@problem_id:3478143] 阐明了平面波基组的一个决定性特征：它不依赖于原子位置，这导致了零 Pulay 力，这是几何优化中的一个显著优势。然而，它对模拟晶胞形状的依赖性导致了非零的 Pulay 应力，这是在计算压力或优化晶胞参数时必须考虑的一个关键修正。", "problem": "考虑一个晶格参数为 $a$ 的立方周期性晶胞，其处于原子单位制下，因此实空间体积为 $V = a^3$。在 $\\Gamma$ 点（即 $\\mathbf{k}=\\mathbf{0}$），单粒子波函数 $\\psi(\\mathbf{r})$ 在平面波基组中表示为 $\\psi(\\mathbf{r}) = \\sum_{\\mathbf{G}} c_{\\mathbf{G}} e^{i \\mathbf{G}\\cdot \\mathbf{r}}$。对于一个均匀应变的立方晶胞，其倒格矢为 $\\mathbf{G}(\\lambda) = \\frac{2\\pi}{\\lambda a}\\mathbf{n}$，其中 $\\mathbf{n}\\in\\mathbb{Z}^3$。$\\lambda  0$ 是各向同性应变因子，定义了体积变换 $V \\to \\lambda^3 V$。在使用动能截断 $E_\\text{cut}$（单位为 Hartree）的平面波计算中，只包含满足 $|\\mathbf{G}(\\lambda)|^2 \\le 2 E_\\text{cut}$ 的平面波。\n\n本问题要求您实现一个思想实验程序，以证明平面波基组在周期性系统中的两个事实：\n- 在原子平移下，平面波产生零 Pulay 力。\n- 在均匀应变下，使用有限动能截断时，平面波会产生非零 Pulay 应力。\n\n您将使用一个合成的 $\\Gamma$ 点波函数，其在倒易空间中的连续傅里叶振幅是一个归一化的高斯函数，\n$$\nc(\\mathbf{k}) \\propto \\exp\\!\\left(-\\frac{|\\mathbf{k}|^2}{2\\sigma^2}\\right),\n$$\n其中 $\\sigma$ 的单位为逆玻尔（inverse Bohr）。在离散的平面波基组中，您将在倒格矢 $\\mathbf{G}(\\lambda)$ 处对 $c(\\mathbf{k})$进行采样，在由截断能选出的截断集合内进行重新归一化，并近似计算动能期望值。在原子单位制（电子质量和约化普朗克常数等于 1）中，动能算符为 $\\frac{1}{2}|\\mathbf{p}|^2 = -\\frac{1}{2}\\nabla^2$。为与问题中的 $E_\\text{pw}$ 定义一致，我们将关注一个与动能成正比的量，其期望值由以下重新归一化的离散和定义\n$$\nE_\\text{pw}(\\lambda, E_\\text{cut}) = \\frac{\\sum_{|\\mathbf{G}(\\lambda)|^2 \\le 2E_\\text{cut}} |\\mathbf{G}(\\lambda)|^2\\,\\left|c(\\mathbf{G}(\\lambda))\\right|^2}{\\sum_{|\\mathbf{G}(\\lambda)|^2 \\le 2E_\\text{cut}} \\left|c(\\mathbf{G}(\\lambda))\\right|^2}.\n$$\n\n定义应变参数 $\\epsilon = \\ln \\lambda$，并考虑在未应变状态 $\\lambda=1$ 下的静水 Pulay 类应力（单位参考体积），\n$$\n\\sigma_\\text{Pulay}(E_\\text{cut}) = \\frac{1}{V_0}\\left.\\frac{\\partial E_\\text{pw}(\\lambda, E_\\text{cut})}{\\partial \\epsilon}\\right|_{\\epsilon=0},\\quad V_0=a^3.\n$$\n使用步长为 $\\Delta \\epsilon$ 的中心有限差分来近似该导数，\n$$\n\\sigma_\\text{Pulay}(E_\\text{cut}) \\approx \\frac{1}{V_0}\\frac{E_\\text{pw}(e^{+\\Delta\\epsilon}, E_\\text{cut}) - E_\\text{pw}(e^{-\\Delta\\epsilon}, E_\\text{cut})}{2\\Delta\\epsilon}.\n$$\n\n为证明零 Pulay 力，考虑波函数沿 $x$ 轴刚性平移 $\\Delta x$。在平面波表示中，这会给每个系数引入一个相位 $e^{-i G_x \\Delta x}$，但动能仅取决于 $|c_{\\mathbf{G}}|^2$，因此在这种相位变换下保持不变。数值上验证导数（力的分量）为零，\n$$\nF_x(E_\\text{cut}) = \\left.\\frac{\\partial E_\\text{pw}(\\lambda=1, E_\\text{cut}; \\Delta x)}{\\partial \\Delta x}\\right|_{\\Delta x=0} \\approx \\frac{E_\\text{pw}(1, E_\\text{cut}; +\\Delta x) - E_\\text{pw}(1, E_\\text{cut}; -\\Delta x)}{2\\Delta x},\n$$\n并检查 $|F_x(E_\\text{cut})|$ 是否低于数值容差。\n\n程序要求：\n- 使用 $a = 10$ Bohr，$\\sigma = 3$ Bohr$^{-1}$，中心差分步长为 $\\Delta \\epsilon = 10^{-2}$ 和 $\\Delta x = 10^{-1}$ Bohr。\n- 严格按照定义实现 $E_\\text{pw}(\\lambda, E_\\text{cut})$，即对所有满足 $|\\mathbf{G}(\\lambda)|^2 \\le 2E_\\text{cut}$ 的整数三元组 $\\mathbf{n} = (n_x,n_y,n_z)$ 进行离散的重新归一化求和，其中 $\\mathbf{G}(\\lambda) = \\frac{2\\pi}{\\lambda a}\\mathbf{n}$。每个包含的 $\\mathbf{G}$ 处的权重为 $\\left|c(\\mathbf{G}(\\lambda))\\right|^2 = \\exp\\!\\left(-\\frac{|\\mathbf{G}(\\lambda)|^2}{2\\sigma^2}\\right)$。\n- 对于 Pulay 力测试，使用相同的 $E_\\text{pw}$ 计算中心差分，因为平移引起的相位在 $\\left|c_{\\mathbf{G}}\\right|^2$ 中被抵消。预期力在数值上应在容差范围内为零。\n- 物理和数值单位：应力以 Hartree/Bohr$^3$ 为单位报告，距离使用 Bohr，能量使用 Hartree。\n- 测试套件：\n    1. $E_\\text{cut}=5$ Hartree（非常小的截断能；预计有显著的 Pulay 应力）。\n    2. $E_\\text{cut}=20$ Hartree（较小的截断能）。\n    3. $E_\\text{cut}=80$ Hartree（中等截断能）。\n    4. $E_\\text{cut}=160$ Hartree（较大的截断能；Pulay 应力应较小）。\n  对于套件中的每个 $E_\\text{cut}$，使用 $\\Delta \\epsilon=10^{-2}$ 计算在 $\\lambda=1$ 时的 $\\sigma_\\text{Pulay}(E_\\text{cut})$，并验证 Pulay 力条件 $|F_x(E_\\text{cut})|  10^{-12}$ Hartree/Bohr。\n- 最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。该列表必须按给定顺序包含测试套件的四个 Pulay 应力值（单位为 Hartree/Bohr$^3$），然后是一个布尔值，指示零 Pulay 力检查是否对所有测试用例同时通过。例如，结构必须类似于“[stress5,stress20,stress80,stress160,True]”。\n\n科学真实性与推导范围：\n- 从周期性系统的平面波基组定义、原子单位制中的动能算符，以及由 $E_\\text{cut}$ 定义的截断平面波子空间上的变分投影开始。\n- 从这些基础出发，推导为什么在原子平移下力会消失（基组不依赖于原子位置），以及为什么在均匀应变下应力不为零（基组依赖于晶胞度规，因此即使在固定的 $E_\\text{cut}$ 下，截断的子空间也会随应变而改变）。\n- 不要使用任何快捷公式或直接给出目标表达式；应明确地按照定义实现求和。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。", "solution": "该问题被验证为科学上合理、定义明确且计算上可行。它代表了计算材料科学中的一个标准数值实验，旨在阐明平面波基组背景下的 Pulay 力和 Pulay 应力概念。\n\n解决方案分为两部分：首先是对物理概念的原理性推导，其次是基于这些原理的算法实现。\n\n### 原理与推导\n\n周期性固体中的单粒子电子波函数 $\\psi(\\mathbf{r})$ 可以用 Bloch 定理来描述。对于第一布里渊区中的给定晶体动量矢量 $\\mathbf{k}$，波函数的形式为 $\\psi_{\\mathbf{k}}(\\mathbf{r}) = u_{\\mathbf{k}}(\\mathbf{r}) e^{i\\mathbf{k}\\cdot\\mathbf{r}}$，其中 $u_{\\mathbf{k}}(\\mathbf{r})$ 具有与晶格相同的周期性。周期函数 $u_{\\mathbf{k}}(\\mathbf{r})$ 可以展开为关于倒格矢 $\\mathbf{G}$ 的傅里叶级数：\n$$\nu_{\\mathbf{k}}(\\mathbf{r}) = \\sum_{\\mathbf{G}} c_{\\mathbf{k}+\\mathbf{G}} e^{i\\mathbf{G}\\cdot\\mathbf{r}}\n$$\n这导出了 Bloch 函数的平面波展开：\n$$\n\\psi_{\\mathbf{k}}(\\mathbf{r}) = \\sum_{\\mathbf{G}} c_{\\mathbf{k}+\\mathbf{G}} e^{i(\\mathbf{k}+\\mathbf{G})\\cdot\\mathbf{r}}\n$$\n问题指定在 $\\Gamma$ 点进行计算，此时 $\\mathbf{k}=\\mathbf{0}$。因此，波函数被展开为关于倒格矢的简单傅里叶级数：\n$$\n\\psi(\\mathbf{r}) = \\sum_{\\mathbf{G}} c_{\\mathbf{G}} e^{i\\mathbf{G}\\cdot\\mathbf{r}}\n$$\n基函数是平面波 $\\{e^{i\\mathbf{G}\\cdot\\mathbf{r}}\\}$。在原子单位制（$\\hbar=1$，$m_e=1$）中，动能算符为 $\\hat{T} = -\\frac{1}{2}\\nabla^2$。平面波是该算符的本征函数：\n$$\n\\hat{T} e^{i\\mathbf{G}\\cdot\\mathbf{r}} = -\\frac{1}{2}\\nabla^2 e^{i\\mathbf{G}\\cdot\\mathbf{r}} = \\frac{|\\mathbf{G}|^2}{2} e^{i\\mathbf{G}\\cdot\\mathbf{r}}\n$$\n因此，对于归一化波函数 $\\psi$ 的动能期望值为：\n$$\n\\langle E_{kin} \\rangle = \\frac{\\sum_{\\mathbf{G}} |c_{\\mathbf{G}}|^2 \\frac{|\\mathbf{G}|^2}{2}}{\\sum_{\\mathbf{G}} |c_{\\mathbf{G}}|^2}\n$$\n问题定义了一个与该动能成正比的量 $E_\\text{pw}$，$E_\\text{pw} = 2 \\langle E_{kin} \\rangle$。\n\n在任何实际计算中，对所有 $\\mathbf{G}$ 的无限求和必须被截断。一个标准的选择是包含所有动能直到某个截断值 $E_\\text{cut}$ 的平面波：\n$$\n\\frac{|\\mathbf{G}|^2}{2} \\le E_\\text{cut} \\implies |\\mathbf{G}|^2 \\le 2 E_\\text{cut}\n$$\n这种截断为波函数定义了一个有限的、变分投影的子空间。\n\n**1. Pulay 力（原子平移）**\n\n当用于描述波函数的基组依赖于原子位置时，就会产生 Pulay 力。为了在平面波基组下分析此问题，考虑整个系统（或仅为波函数，对于这个思想实验而言）刚性平移一个矢量 $\\mathbf{d}$。新的波函数为 $\\psi'(\\mathbf{r}) = \\psi(\\mathbf{r}-\\mathbf{d})$。我们可以在原始平面波基组中表示 $\\psi'(\\mathbf{r})$：\n$$\n\\psi'(\\mathbf{r}) = \\psi(\\mathbf{r}-\\mathbf{d}) = \\sum_{\\mathbf{G}} c_{\\mathbf{G}} e^{i\\mathbf{G}\\cdot(\\mathbf{r}-\\mathbf{d})} = \\sum_{\\mathbf{G}} \\left(c_{\\mathbf{G}} e^{-i\\mathbf{G}\\cdot\\mathbf{d}}\\right) e^{i\\mathbf{G}\\cdot\\mathbf{r}} = \\sum_{\\mathbf{G}} c'_{\\mathbf{G}} e^{i\\mathbf{G}\\cdot\\mathbf{r}}\n$$\n新的系数为 $c'_{\\mathbf{G}} = c_{\\mathbf{G}} e^{-i\\mathbf{G}\\cdot\\mathbf{d}}$。关键的观察是，每个系数的模保持不变：$|c'_{\\mathbf{G}}|^2 = |c_{\\mathbf{G}}|^2$。基函数本身 $\\{e^{i\\mathbf{G}\\cdot\\mathbf{r}}\\}$ 是相对于模拟晶胞定义的，并且独立于原子位置。\n\n动能期望值 $E_\\text{pw}$ 是 $|\\mathbf{G}|^2$ 和 $|c_{\\mathbf{G}}|^2$ 的函数。由于这两个量在平移下都不变，因此 $E_\\text{pw}$ 是不变的。Pulay 力是能量对原子位移的导数，因此对于平面波基组来说，它恒等于零。这是这类基组的一个显著优点。问题要求通过计算位移 $\\Delta x$ 对应的力分量 $F_x$ 来数值验证这一点，其计算结果应为零。\n\n**2. Pulay 应力（晶胞应变）**\n\nPulay 应力源于基组对晶胞参数（即应变）的依赖性。在本问题中，我们考虑一个由因子 $\\lambda$ 描述的均匀各向同性应变，它将晶格参数 $a$ 变换为 $\\lambda a$。立方晶胞的倒格矢依赖于 $\\lambda$：\n$$\n\\mathbf{G}(\\lambda) = \\frac{2\\pi}{\\lambda a}\\mathbf{n}, \\quad \\text{其中 } \\mathbf{n} = (n_x, n_y, n_z) \\in \\mathbb{Z}^3\n$$\n计算中包含的平面波集合由截断条件定义，该条件现在明确地依赖于 $\\lambda$：\n$$\n|\\mathbf{G}(\\lambda)|^2 \\le 2 E_\\text{cut} \\quad \\implies \\quad \\left(\\frac{2\\pi}{\\lambda a}\\right)^2 |\\mathbf{n}|^2 \\le 2 E_\\text{cut}\n$$\n随着 $\\lambda$ 的变化，满足该不等式的整数矢量 $\\mathbf{n}$ 的集合也会改变。这意味着基组本身，即由截断定义的子空间，是应变 $\\lambda$ 的函数。\n\n计算出的能量 $E_\\text{pw}(\\lambda, E_\\text{cut})$ 是对这个依赖于 $\\lambda$ 的倒格矢集合的求和。它对应变参数（例如 $\\epsilon = \\ln \\lambda$）的导数将由于两个贡献而不为零：\na) 对于保持在截断球面内的矢量，其项 $|\\mathbf{G}(\\lambda)|^2$ 和权重 $|c(\\mathbf{G}(\\lambda))|^2$ 的连续变化。\nb) 当 $\\lambda$ 变化时，由于矢量 $\\mathbf{G}(\\lambda)$ 进入或离开求和域而导致的求和值的非连续变化。\n\n后一种效应是 Pulay 应力的来源。对于任何有限的 $E_\\text{cut}$，此应力均不为零。它仅在完备基组的极限下（$E_\\text{cut} \\to \\infty$）才消失。问题要求计算这个“类应力”量 $\\sigma_\\text{Pulay}$ 并观察其对 $E_\\text{cut}$ 的依赖性。我们预计随着 $E_\\text{cut}$ 的增加，$\\sigma_\\text{Pulay}$ 会减小，因为基组变得更加完备。\n\n### 算法实现\n\n程序的核心是计算 $E_\\text{pw}(\\lambda, E_\\text{cut})$ 的函数：\n$$\nE_\\text{pw}(\\lambda, E_\\text{cut}) = \\frac{\\sum_{\\mathbf{n} \\in S(\\lambda, E_\\text{cut})} |\\mathbf{G}(\\lambda)|^2\\,\\exp\\left(-\\frac{|\\mathbf{G}(\\lambda)|^2}{2\\sigma^2}\\right)}{\\sum_{\\mathbf{n} \\in S(\\lambda, E_\\text{cut})} \\exp\\left(-\\frac{|\\mathbf{G}(\\lambda)|^2}{2\\sigma^2}\\right)}\n$$\n其中 $S(\\lambda, E_\\text{cut})$ 是满足截断条件的整数三元组 $\\mathbf{n}$ 的集合。\n\n1.  为了实现这一点，我们通过重排截断不等式来确定最大整数分量 $n_\\text{max}$：$|\\mathbf{n}|^2 \\le 2 E_\\text{cut} (\\frac{\\lambda a}{2\\pi})^2$。任何分量 $n_i$ 都不能超过 $\\sqrt{|\\mathbf{n}|^2}$，因此 $|n_i| \\le \\lfloor\\sqrt{2 E_\\text{cut}} \\frac{\\lambda a}{2\\pi}\\rfloor$。\n2.  我们遍历从 $-n_\\text{max}$ 到 $+n_\\text{max}$ 的所有整数三元组 $(n_x, n_y, n_z)$。\n3.  对于每个三元组 $\\mathbf{n}$，我们计算 $|\\mathbf{G}(\\lambda)|^2 = (\\frac{2\\pi}{\\lambda a})^2 (n_x^2+n_y^2+n_z^2)$ 并检查它是否小于或等于 $2E_\\text{cut}$。\n4.  如果满足条件，我们计算分子和分母的相应项，并将其加到运行总和中。根据问题陈述，指数权重计算为 $\\exp(-|\\mathbf{G}(\\lambda)|^2 / (2\\sigma^2))$。\n5.  循环完成后，最终值为总分子与总分母之比。\n\n然后使用中心有限差分近似计算 Pulay 应力 $\\sigma_\\text{Pulay}$。我们在两个略有不同的应变 $\\lambda_+ = e^{+\\Delta\\epsilon}$ 和 $\\lambda_- = e^{-\\Delta\\epsilon}$ 下计算 $E_\\text{pw}$，并应用公式：\n$$\n\\sigma_\\text{Pulay}(E_\\text{cut}) \\approx \\frac{1}{a^3}\\frac{E_\\text{pw}(e^{+\\Delta\\epsilon}, E_\\text{cut}) - E_\\text{pw}(e^{-\\Delta\\epsilon}, E_\\text{cut})}{2\\Delta\\epsilon}\n$$\nPulay 力的检查是平凡的。如解析所示，能量在平移下是不变的，因此 $F_x$ 的有限差分公式的计算结果恰好为 $0$，满足条件 $|F_x|  10^{-12}$。\n\n程序遍历指定的 $E_\\text{cut}$ 值，为每个值计算应力，并确认力条件在所有情况下都通过。最终输出被格式化为单个列表。", "answer": "$$ \\boxed{[-1.0180 \\times 10^{-2}, -7.6290 \\times 10^{-3}, -6.7606 \\times 10^{-4}, -6.4428 \\times 10^{-6}, \\text{True}]} $$", "id": "3478143"}]}