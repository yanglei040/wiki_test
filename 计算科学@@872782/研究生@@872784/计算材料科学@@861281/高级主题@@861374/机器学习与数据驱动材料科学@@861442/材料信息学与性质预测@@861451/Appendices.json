{"hands_on_practices": [{"introduction": "凸包的概念是计算热力学的基石，为判断相稳定性提供了直观且定量的标准。本练习将指导您如何从一系列形成能数据中，通过计算构建二元体系的相图。通过亲手实现一个凸包算法 [@problem_id:3464191]，您将获得将原始理论数据转化为有物理意义的洞见的实践经验，从而判断哪些材料是热力学稳定的，哪些则可能分解。", "problem": "给定一个二元材料体系 $\\mathrm{A}$–$\\mathrm{B}$ 中的一组候选相，每个相由一个组分 $x \\in [0,1]$ 和一个以电子伏特/原子 (eV/atom) 为单位的生成能 $E_f(x)$ 表示。计算材料科学中的一个基本原理是，在给定组分 $x$ 下，热力学上最有利的能量是与质量守恒一致的所有可能的两相混合物的能量最小值。在数学上，对于任意两个组分 $x_a$ 和 $x_b$（其中 $x_a  x_b$），通过凸组合 $x = \\lambda x_b + (1-\\lambda) x_a$（其中 $\\lambda \\in [0,1]$）得到组分 $x$ 的混合物能量由 $E_{\\mathrm{mix}}(x) = \\lambda E_f(x_b) + (1-\\lambda) E_f(x_a)$ 给出。点集 $\\{(x_i, E_f(x_i))\\}$ 的凸包是所有此类弦的下包络。\n\n您的任务是推导并实现一个算法，该算法能够：\n- 按组分 $x_i$ 对输入点 $(x_i, E_i)$ 进行排序。\n- 通过迭代添加点并移除违反凸性的点来构建下凸包。\n- 对每个原始输入点，计算有符号距离 $d_i = E_i - E_{\\mathrm{hull}}(x_i)$，其中 $E_{\\mathrm{hull}}(x)$ 是在 $x$ 处评估的下凸包的分段线性函数能量。\n- 对于一个容差 $\\varepsilon$，如果 $d_i \\le \\varepsilon$，则将每个输入点分类为稳定，否则为不稳定。\n\n从以下基本依据开始：\n- 在组分 $x$ 处，理想两相混合物的能量为 $E_{\\mathrm{mix}}(x) = \\lambda E_f(x_b) + (1-\\lambda) E_f(x_a)$，其中 $\\lambda = \\dfrac{x - x_a}{x_b - x_a}$，且 $x \\in [x_a, x_b]$。\n- 二维中的下凸包可以通过单调链方法构建：按 $x$ 排序后，迭代地维护一个凸包点的堆栈，当方向测试表明下凸包出现非凸（顺时针或共线，对于严格凸性而言）转角时，移除最后一个点。\n\n算法规范：\n1. 预处理：如果两个点共享相同的组分 $x$，只保留能量 $E$ 最小的那个点，因为在相同 $x$ 处能量较高的条目不可能位于下凸包上。保留所有原始点用于距离评估。\n2. 凸包构建：将去重后的点集 $(x_j, E_j)$ 按 $x_j$ 升序排序。对于下凸包，使用由叉积定义的向量方向测试\n   $$\\mathrm{cross}(o,a,b) = (x_a - x_o)(E_b - E_o) - (E_a - E_o)(x_b - x_o)。$$\n   当凸包上至少有两个点且 $\\mathrm{cross}(o,a,b) \\le 0$ 时，从凸包中移除点 $a$；最后附加点 $b$。\n3. 凸包评估：对于任意 $x$，找到线段端点 $(x_L,E_L)$ 和 $(x_R,E_R)$ 使得 $x_L \\le x \\le x_R$，并计算\n   $$E_{\\mathrm{hull}}(x) = E_L + \\frac{E_R - E_L}{x_R - x_L}(x - x_L)。$$\n4. 有符号距离和分类：对每个原始点 $(x_i,E_i)$，计算 $d_i = E_i - E_{\\mathrm{hull}}(x_i)$ 并将其分类为稳定如果 $d_i \\le \\varepsilon$。距离单位为 eV/atom；由于数值舍入误差，将小的负值 $d_i$ 截断为 $0$。使用 $\\varepsilon = 10^{-8}$ eV/atom。\n\n物理单位和输出要求：\n- 能量和距离必须以 eV/atom 为单位处理。\n- 最终输出必须是单行，包含一个列表，其第 $k$ 个元素对应第 $k$ 个测试用例。每个元素本身也必须是一个列表：第一项是该测试用例的稳定索引的排序列表（指原始输入顺序的整数），第二项是该测试用例中所有点的最大有符号距离，四舍五入到 $6$ 位小数 (eV/atom)。例如：$[[[i_1,i_2],d_1],[[j_1],d_2]]$。\n- 此问题不涉及角度。\n\n测试套件：\n实现您的程序以处理以下五个测试用例。对于每个用例，按规定报告 $[ \\text{stable\\_indices}, \\text{max\\_distance\\_rounded} ]$。\n- 用例 1（一般情况）：$x = [0.0, 0.2, 0.5, 0.8, 1.0]$，$E = [0.0, -0.05, -0.2, -0.05, 0.0]$ eV/atom。\n- 用例 2（相同组分处有重复点）：$x = [0.0, 0.5, 0.5, 1.0]$，$E = [0.0, -0.15, -0.10, 0.0]$ eV/atom。\n- 用例 3（仅端点在凸包上）：$x = [0.0, 0.3, 0.6, 1.0]$，$E = [0.0, 0.05, 0.04, 0.0]$ eV/atom。\n- 用例 4（凸包线段上的共线内部点）：$x = [0.0, 0.25, 0.5, 1.0]$，$E = [0.0, -0.05, -0.1, 0.0]$ eV/atom。\n- 用例 5（近凸包容差）：$x = [0.0, 0.4, 1.0]$，$E = [0.0, 1\\times 10^{-12}, 0.0]$ eV/atom。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的、以逗号分隔的结果列表，格式与上述完全一致。", "solution": "用户提供了一个来自计算材料科学领域的明确问题，具体涉及根据生成能数据确定相稳定性。该问题具有科学依据、数学上一致且算法上明确。任务的核心是计算一组二维点（表示生成能与组分的关系）的下凸包，然后根据每个输入相与此凸包的能量差来评估其稳定性。\n\n解决方案通过实现指定的算法来推进，该算法是用于构建凸包的单调链方法的一个变体。步骤如下：\n\n1.  **数据表示与预处理**：输入由组分 $x_i$ 和生成能 $E_i$ 组成。它们被配对为二维平面中的点 $(x_i, E_i)$，同时保留其原始索引以用于最终输出。根据问题规范，对于共享相同组分 $x$ 的任意点集，只有生成能最小的点才能位于下凸包上。因此，执行一个初步的筛选步骤，为凸包构建算法创建一个唯一的点集，其中唯一性由组分定义。然后，这个去重后的点集按组分 $x$ 的升序排序。\n\n2.  **下凸包构建**：下凸包是使用单调链算法在预处理过的、已排序的点列表上构建的。维护一个列表（我们可以称之为 `hull`）来存储凸包的顶点。点按排序顺序逐一处理。对于每个正在考虑的新点 $b$，我们查看 `hull` 上的最后两个点，设它们为 $o$（倒数第二个）和 $a$（最后一个）。我们使用二维叉积进行方向测试：\n    $$ \\mathrm{cross}(o,a,b) = (x_a - x_o)(E_b - E_o) - (E_a - E_o)(x_b - x_o) $$\n    正结果表示逆时针（或“左”）转，负结果表示顺时针（或“右”）转，零表示点共线。对于下凸包，顶点序列必须形成一个连续的“左”转链（或保持共线）。如果添加点 $b$ 会产生一个“右”转（即 $\\mathrm{cross}(o,a,b) \\le 0$），这意味着点 $a$ 位于连接 $o$ 和 $b$ 的线段之上，因此不在下凸包上。在这种情况下，点 $a$ 从 `hull` 中移除。重复此检查，直到 `hull` 的点少于两个或转角变为凸的（左转）。最后，点 $b$ 被添加到 `hull` 中。此过程确保生成的 `hull` 列表按组分递增的顺序列出了下凸包的顶点。\n\n3.  **凸包能量评估**：确定下凸包的顶点后，可以为任何组分 $x$ 计算凸包能量 $E_{\\mathrm{hull}}(x)$。凸包本身是一个分段线性函数。对于来自原始输入点的给定 $x_i$，我们必须首先确定它对应于凸包的哪个线性段。凸包顶点已按组分排序。我们可以高效地找到由顶点 $(x_L, E_L)$ 和 $(x_R, E_R)$ 定义的线段，使得 $x_L \\le x_i \\le x_R$。这可以通过二分搜索来完成，`numpy.searchsorted` 非常适合此任务。找到线段后，通过线性插值计算凸包能量：\n    $$ E_{\\mathrm{hull}}(x_i) = E_L + \\frac{E_R - E_L}{x_R - x_L}(x_i - x_L) $$\n    如果 $x_i$ 与凸包顶点重合，此公式能正确地给出该顶点的能量。\n\n4.  **稳定性分析**：对于每个原始输入点 $(x_i, E_i)$，计算其到凸包的有符号距离 $d_i$，也称为分解能：\n    $$ d_i = E_i - E_{\\mathrm{hull}}(x_i) $$\n    根据下凸包的构造，$d_i$ 必须为非负值。然而，由于有限的浮点精度，恰好位于凸包上的点可能会产生一个非常小的负距离。按照指示，任何这样的小负值都被截断为 $0$。如果一个点的能量在凸包上或非常接近凸包，则该点被分类为热力学“稳定”。这是通过将其距离 $d_i$ 与一个小的容差 $\\varepsilon = 10^{-8}$ eV/atom 进行比较来确定的。如果 $d_i \\le \\varepsilon$，则该点（及其对应的相）被分类为稳定。否则，它是不稳定的。\n\n5.  **输出格式化**：在分析完一个测试用例中的所有点之后，收集并排序稳定点的原始索引列表。同时确定该测试用例中所有点的最大有符号距离 $d_i$。对于每个测试用例，将这两部分信息格式化为所需的字符串表示 `[[stable_indices], max_distance_rounded]`。最终输出是所有测试用例结果的聚合，形成一个单行列表。\n\n该过程正确地模拟了零温下相稳定性分析的物理原理，并提供了一种执行此分析的稳健计算方法。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the convex hull phase stability problem for a set of test cases.\n    \"\"\"\n    # Tolerance for stability classification\n    EPSILON = 1e-8\n\n    # Test cases as provided in the problem description\n    test_cases = [\n        # Case 1 (general)\n        {'x': [0.0, 0.2, 0.5, 0.8, 1.0], 'E': [0.0, -0.05, -0.2, -0.05, 0.0]},\n        # Case 2 (duplicates at same composition)\n        {'x': [0.0, 0.5, 0.5, 1.0], 'E': [0.0, -0.15, -0.10, 0.0]},\n        # Case 3 (endpoints only on hull)\n        {'x': [0.0, 0.3, 0.6, 1.0], 'E': [0.0, 0.05, 0.04, 0.0]},\n        # Case 4 (colinear interior point on a hull segment)\n        {'x': [0.0, 0.25, 0.5, 1.0], 'E': [0.0, -0.05, -0.1, 0.0]},\n        # Case 5 (near-hull tolerance)\n        {'x': [0.0, 0.4, 1.0], 'E': [0.0, 1e-12, 0.0]},\n    ]\n    \n    final_results = []\n\n    for case_data in test_cases:\n        x_coords, e_vals = case_data['x'], case_data['E']\n        \n        # Store original points with their indices\n        original_points = [(x, e, i) for i, (x, e) in enumerate(zip(x_coords, e_vals))]\n\n        # 1. Preprocessing: Keep only the point with minimum energy for each unique composition\n        unique_points_map = {}\n        for x, e, _ in original_points:\n            if x not in unique_points_map or e  unique_points_map[x][1]:\n                unique_points_map[x] = (x, e)\n        \n        # Sort the unique points by composition for the hull algorithm\n        points_for_hull = sorted(unique_points_map.values())\n\n        # 2. Hull construction (Monotone Chain Algorithm)\n        def cross_product(p1, p2, p3):\n            # (x_a - x_o)(E_b - E_o) - (E_a - E_o)(x_b - x_o)\n            # o=p1, a=p2, b=p3\n            return (p2[0] - p1[0]) * (p3[1] - p1[1]) - (p2[1] - p1[1]) * (p3[0] - p1[0])\n\n        lower_hull = []\n        for p in points_for_hull:\n            while len(lower_hull) >= 2 and cross_product(lower_hull[-2], lower_hull[-1], p) = 0:\n                lower_hull.pop()\n            lower_hull.append(p)\n        \n        # 3. Hull evaluation and 4. Signed distance calculation\n        distances = []\n        stable_indices = []\n        \n        hull_x = [p[0] for p in lower_hull]\n\n        for x_i, e_i, original_idx in original_points:\n            # Find the hull segment for the current point x_i\n            # np.searchsorted finds insertion point, which helps locate the segment\n            j = np.searchsorted(hull_x, x_i, side='left')\n            \n            e_hull = 0.0\n            if j  len(hull_x) and np.isclose(hull_x[j], x_i):\n                # Point x_i is a hull vertex\n                e_hull = lower_hull[j][1]\n            else:\n                # Point x_i is between two hull vertices\n                p_left = lower_hull[j - 1]\n                p_right = lower_hull[j]\n                \n                x_L, e_L = p_left\n                x_R, e_R = p_right\n                \n                # Linear interpolation\n                if np.isclose(x_R, x_L):\n                    e_hull = e_L\n                else:\n                    slope = (e_R - e_L) / (x_R - x_L)\n                    e_hull = e_L + slope * (x_i - x_L)\n\n            # Compute signed distance, clip small negative values to 0\n            d_i = e_i - e_hull\n            d_i = max(0.0, d_i)\n            distances.append(d_i)\n\n            # Classify as stable if distance is within tolerance\n            if d_i = EPSILON:\n                stable_indices.append(original_idx)\n\n        # Prepare results for the current test case\n        max_distance = max(distances) if distances else 0.0\n        stable_indices.sort()\n        \n        # Format the result list as a string\n        case_result_str = f\"[[{','.join(map(str, stable_indices))}],{max_distance:.6f}]\"\n        final_results.append(case_result_str)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(final_results)}]\")\n\nsolve()\n```", "id": "3464191"}, {"introduction": "在材料信息学中，我们常常需要在计算成本和模型精度之间做出权衡。本练习 [@problem_id:3464227] 深入探讨了多保真度建模，这是一种强大的策略，它利用廉价的低保真度预测来提升模型的整体精度，而无需完全依赖昂贵的高保真度计算。您将应用普通最小二乘法回归来校准一个简单的线性模型，并且更重要的是，学会量化预测的方差，这是评估任何预测模型可靠性的关键技能。", "problem": "一个材料信息学团队试图在一个多保真度学习框架内，将低保真度的形成能预测校准到高保真度的计算结果。令 $f_L$ 表示低保真度预测（例如，来自粗粒度代理模型），$f_H$ 表示来自密度泛函理论（DFT）的高保真度形成能。假设一个线性校正模型 $f_H=\\rho f_L+\\beta+\\varepsilon$，其中 $\\varepsilon$ 是一个零均值随机误差，在所有观测中具有恒定方差 $\\sigma^{2}$（同方差性）。使用普通最小二乘法（OLS），通过最小化基于成对观测校准集 $(f_L,f_H)=\\{(1.2,1.8),(2.0,2.7),(0.8,1.3)\\}$ 的残差平方和，来确定最佳拟合参数 $\\rho$ 和 $\\beta$，所有单位均为电子伏特（eV）。然后，使用拟合的校正模型，为一个低保真度预测为 $f_L=1.5$ 的新材料预测其高保真度形成能 $f_H$。在同方差残差模型下，计算在 $f_L=1.5$ 处一个未观测的新高保真度测量的预测方差（即，包括来自参数不确定性和新观测噪声的方差贡献）。将预测的形成能以 eV 表示，预测方差以 $\\text{eV}^{2}$ 表示。将最终数值结果四舍五入至四位有效数字。", "solution": "该问题要求应用普通最小二乘法（OLS）线性回归，将低保真度模型校准到高保真度数据，然后使用得到的模型进行预测和不确定性量化。模型是高保真度形成能 $f_H$ 和低保真度预测 $f_L$ 之间的线性关系，由 $f_H = \\rho f_L + \\beta + \\varepsilon$ 给出。\n\n首先，我们验证问题陈述。\n**步骤 1：提取给定信息**\n- 线性模型：$f_H = \\rho f_L + \\beta + \\varepsilon$\n- 误差项属性：$\\varepsilon$ 是一个零均值随机误差，具有恒定方差 $\\sigma^2$。\n- 方法：普通最小二乘法（OLS）。\n- 校准数据 $(f_L, f_H)$: $\\{(1.2, 1.8), (2.0, 2.7), (0.8, 1.3)\\}$。所有值的单位都是电子伏特（eV）。\n- 寻求高保真度预测的新低保真度预测值：$f_L = 1.5$。\n- 要求输出：\n  1. 最佳拟合参数 $\\rho$ 和 $\\beta$。\n  2. 在 $f_L = 1.5$ 时的预测高保真度形成能 $\\hat{f}_H$。\n  3. 在 $f_L=1.5$ 处一个新高保真度测量的预测方差。\n- 四舍五入：最终数值结果保留四位有效数字。\n\n**步骤 2：使用提取的给定信息进行验证**\n该问题具有科学依据，采用了材料信息学中常见的一种标准多保真度校准技术（线性回归）。DFT、形成能和代理模型的使用都是计算材料科学中的标准概念。这个问题是适定的，因为所提供的数据允许回归参数有唯一解。这个问题是自洽的，提供了所有必要的数据和定义。数据值在物理上是现实的。这个问题并非微不足道，需要计算回归参数、一个点预测，以及更复杂的预测方差。\n\n**步骤 3：结论和行动**\n该问题被认为是有效的。我们进行完整解答。\n\n让我们用 $x=f_L$ 表示自变量，用 $y=f_H$ 表示因变量。校准集由 $n=3$ 对 $(x_i, y_i)$ 组成：\n$(x_1, y_1) = (1.2, 1.8)$\n$(x_2, y_2) = (2.0, 2.7)$\n$(x_3, y_3) = (0.8, 1.3)$\n\n斜率 $\\hat{\\rho}$ 和截距 $\\hat{\\beta}$ 的 OLS 估计量是通过最小化残差平方和找到的。这些估计量的标准公式取决于数据的几个汇总统计量。\n\n我们首先计算必要的和与均值：\n$\\sum_{i=1}^{3} x_i = 1.2 + 2.0 + 0.8 = 4.0$\n$\\sum_{i=1}^{3} y_i = 1.8 + 2.7 + 1.3 = 5.8$\n样本均值为：\n$\\bar{x} = \\frac{\\sum x_i}{n} = \\frac{4.0}{3}$\n$\\bar{y} = \\frac{\\sum y_i}{n} = \\frac{5.8}{3}$\n\n接下来，我们计算平方和与交叉乘积：\n$\\sum_{i=1}^{3} x_i^2 = (1.2)^2 + (2.0)^2 + (0.8)^2 = 1.44 + 4.00 + 0.64 = 6.08$\n$\\sum_{i=1}^{3} y_i^2 = (1.8)^2 + (2.7)^2 + (1.3)^2 = 3.24 + 7.29 + 1.69 = 12.22$\n$\\sum_{i=1}^{3} x_i y_i = (1.2)(1.8) + (2.0)(2.7) + (0.8)(1.3) = 2.16 + 5.40 + 1.04 = 8.60$\n\n校正后的平方和与交叉乘积 $S_{xx}$、$S_{yy}$ 和 $S_{xy}$ 为：\n$S_{xx} = \\sum x_i^2 - n\\bar{x}^2 = 6.08 - 3\\left(\\frac{4.0}{3}\\right)^2 = 6.08 - \\frac{16.0}{3} = \\frac{18.24 - 16.0}{3} = \\frac{2.24}{3} = \\frac{56}{75}$\n$S_{xy} = \\sum x_i y_i - n\\bar{x}\\bar{y} = 8.60 - 3\\left(\\frac{4.0}{3}\\right)\\left(\\frac{5.8}{3}\\right) = 8.60 - \\frac{23.2}{3} = \\frac{25.8 - 23.2}{3} = \\frac{2.6}{3} = \\frac{13}{15}$\n\n斜率 $\\rho$ 的 OLS 估计为：\n$\\hat{\\rho} = \\frac{S_{xy}}{S_{xx}} = \\frac{13/15}{56/75} = \\frac{13}{15} \\times \\frac{75}{56} = \\frac{13 \\times 5}{56} = \\frac{65}{56}$\n\n截距 $\\beta$ 的 OLS 估计为：\n$\\hat{\\beta} = \\bar{y} - \\hat{\\rho}\\bar{x} = \\frac{5.8}{3} - \\left(\\frac{65}{56}\\right)\\left(\\frac{4.0}{3}\\right) = \\frac{5.8}{3} - \\frac{65}{42} = \\frac{5.8 \\times 14 - 65}{42} = \\frac{81.2 - 65}{42} = \\frac{16.2}{42} = \\frac{27}{70}$\n\n拟合的线性校正模型是 $\\hat{f}_H = \\frac{65}{56} f_L + \\frac{27}{70}$。数值上，$\\hat{\\rho} \\approx 1.1607$ 且 $\\hat{\\beta} \\approx 0.3857$。\n\n接下来，我们为一个新材料预测其高保真度形成能 $f_H$，该材料的 $f_L = x_0 = 1.5$。\n$\\hat{f}_H(x_0) = \\hat{y}_0 = \\hat{\\rho} x_0 + \\hat{\\beta} = \\left(\\frac{65}{56}\\right)(1.5) + \\frac{27}{70}$\n使用 $x_0 = 1.5 = \\frac{3}{2}$：\n$\\hat{y}_0 = \\left(\\frac{65}{56}\\right)\\left(\\frac{3}{2}\\right) + \\frac{27}{70} = \\frac{195}{112} + \\frac{27}{70} = \\frac{195 \\times 5}{560} + \\frac{27 \\times 8}{560} = \\frac{975 + 216}{560} = \\frac{1191}{560}$\n$\\hat{y}_0 \\approx 2.1267857...$\n四舍五入到四位有效数字，预测的形成能是 $2.127$ eV。\n\n最后，我们计算在 $x_0=1.5$ 处一个未观测的新测量的预测方差。该方差考虑了估计参数 $(\\hat{\\rho}, \\hat{\\beta})$ 的不确定性和新观测的内在噪声 $\\sigma^2$。预测方差的公式是：\n$Var_{pred}(y_0) = \\hat{\\sigma}^2 \\left(1 + \\frac{1}{n} + \\frac{(x_0 - \\bar{x})^2}{S_{xx}}\\right)$\n首先，我们需要误差方差的无偏估计 $\\hat{\\sigma}^2$，即均方误差（MSE）：\n$\\hat{\\sigma}^2 = \\frac{SSR}{n-p}$，其中 $SSR$ 是残差平方和，$p$ 是模型中的参数数量（对于 $\\rho$ 和 $\\beta$，$p=2$）。\n$SSR = S_{yy} - \\frac{S_{xy}^2}{S_{xx}}$\n我们计算 $S_{yy}$：\n$S_{yy} = \\sum y_i^2 - n\\bar{y}^2 = 12.22 - 3\\left(\\frac{5.8}{3}\\right)^2 = 12.22 - \\frac{33.64}{3} = \\frac{36.66 - 33.64}{3} = \\frac{3.02}{3} = \\frac{151}{150}$\n现在我们计算 $SSR$：\n$SSR = \\frac{151}{150} - \\frac{(13/15)^2}{56/75} = \\frac{151}{150} - \\frac{169/225}{56/75} = \\frac{151}{150} - \\frac{169}{225} \\frac{75}{56} = \\frac{151}{150} - \\frac{169}{3 \\times 56} = \\frac{151}{150} - \\frac{169}{168}$\n$150$ 和 $168$ 的最小公倍数是 $4200$。\n$SSR = \\frac{151 \\times 28}{4200} - \\frac{169 \\times 25}{4200} = \\frac{4228 - 4225}{4200} = \\frac{3}{4200} = \\frac{1}{1400}$\n误差方差的估计为：\n$\\hat{\\sigma}^2 = \\frac{SSR}{n-2} = \\frac{1/1400}{3-2} = \\frac{1}{1400}$\n\n现在我们将所有分量代入预测方差公式：\n$x_0 = 1.5 = \\frac{3}{2}$\n$\\bar{x} = \\frac{4}{3}$\n$n=3$\n$S_{xx} = \\frac{56}{75}$\n$\\hat{\\sigma}^2 = \\frac{1}{1400}$\n项 $(x_0 - \\bar{x})^2$ 为：\n$(x_0 - \\bar{x})^2 = \\left(\\frac{3}{2} - \\frac{4}{3}\\right)^2 = \\left(\\frac{9-8}{6}\\right)^2 = \\left(\\frac{1}{6}\\right)^2 = \\frac{1}{36}$\n$Var_{pred}(y_0) = \\frac{1}{1400} \\left(1 + \\frac{1}{3} + \\frac{1/36}{56/75}\\right) = \\frac{1}{1400} \\left(\\frac{4}{3} + \\frac{1}{36} \\frac{75}{56}\\right)$\n$Var_{pred}(y_0) = \\frac{1}{1400} \\left(\\frac{4}{3} + \\frac{75}{2016}\\right) = \\frac{1}{1400} \\left(\\frac{4}{3} + \\frac{25}{672}\\right)$\n$3$ 和 $672$ 的最小公倍数是 $672$。\n$Var_{pred}(y_0) = \\frac{1}{1400} \\left(\\frac{4 \\times 224}{672} + \\frac{25}{672}\\right) = \\frac{1}{1400} \\left(\\frac{896 + 25}{672}\\right) = \\frac{1}{1400} \\left(\\frac{921}{672}\\right)$\n$Var_{pred}(y_0) = \\frac{1}{1400} \\left(\\frac{307}{224}\\right) = \\frac{307}{313600}$\n$Var_{pred}(y_0) \\approx 0.000978954...$\n四舍五入到四位有效数字，预测方差是 $9.790 \\times 10^{-4}$ $\\text{eV}^2$。\n\n最终结果是预测的形成能 $\\hat{f}_H(1.5)$ 和预测方差 $Var_{pred}(y_0)$。\n预测能量：$2.127$ eV。\n预测方差：$9.790 \\times 10^{-4}$ $\\text{eV}^2$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2.127  9.790 \\times 10^{-4}\n\\end{pmatrix}\n}\n$$", "id": "3464227"}, {"introduction": "除了构建预测模型，材料信息学的一个核心目标是加速新材料的发现。本练习将介绍贝叶斯优化，这是一种强大的主动学习策略，能够智能地指导对最优材料的搜索。通过推导并应用期望提升（Expected Improvement, EI）采集函数 [@problem_id:3464220]，您将学习如何利用模型的预测及其不确定性，来策略性地选择下一个最有希望的候选材料进行实验，从而在“利用”已知高性能区域和“探索”不确定区域之间取得高效平衡。", "problem": "您正在运行贝叶斯优化，以在一个离散的合金成分集合上最大化一个评估成本高昂的材料属性（例如，室温体积模量）。对于每个候选成分，高斯过程（GP）代理模型（高斯过程）提供一个后验预测分布，该分布是均值为 $\\mu$、标准差为 $\\sigma$ 的高斯分布。在所有已完成的实验中，当前观测到的最佳属性值为 $y^{*}$。\n\n对于三个新的候选成分，GP后验摘要如下：\n- 均值：$\\boldsymbol{\\mu} = [0.5, 0.7, 0.6]$，\n- 标准差：$\\boldsymbol{\\sigma} = [0.1, 0.2, 0.15]$，\n- 当前最佳值：$y^{*} = 0.65$。\n\n假设在任何候选点上，未知属性 $Y$ 的预测分布为 $Y \\sim \\mathcal{N}(\\mu, \\sigma^{2})$，并将最大化问题中相对于当前最佳值的改进定义为 $I = \\max(0, Y - y^{*})$。从 $I$ 的定义以及高斯概率密度函数和累积分布函数出发，推导单个候选点的期望改进 $\\operatorname{EI} = \\mathbb{E}[I]$ 的解析表达式，该表达式应使用 $\\mu$、$\\sigma$ 和 $y^{*}$ 表示，且不得使用任何预先记忆的公式。然后，使用给定的 $\\boldsymbol{\\mu}$、$\\boldsymbol{\\sigma}$ 和 $y^{*}$，为三个候选点分别数值计算 $\\operatorname{EI}$。\n\n选择具有最大期望改进的候选点作为下一个实验。仅报告所选候选点的索引 $i \\in \\{1,2,3\\}$（使用基于1的索引）作为您的最终答案。最终答案无单位，不需要四舍五入。", "solution": "用户提供了一个科学基础扎实、问题定义明确且客观的问题。这是贝叶斯优化原理在计算材料科学领域的一个标准应用。所有必要的数据和定义均已提供，不存在不一致或模糊之处。该问题是有效的。\n\n该问题要求推导期望改进（EI）采集函数的解析表达式，并随后应用它来选择下一个实验点。\n\n设候选成分处的未知材料属性为一个随机变量 $Y$，它遵循由高斯过程后验给出的高斯（正态）分布：$Y \\sim \\mathcal{N}(\\mu, \\sigma^{2})$。$Y$ 的概率密度函数（PDF）由下式给出：\n$$\nf(y; \\mu, \\sigma) = \\frac{1}{\\sigma\\sqrt{2\\pi}} \\exp\\left(-\\frac{1}{2}\\left(\\frac{y-\\mu}{\\sigma}\\right)^2\\right)\n$$\n当前观测到的最佳值表示为 $y^{*}$。对于最大化问题，改进 $I$ 定义为 $Y$ 超出 $y^{*}$ 的量，如果 $Y$ 不优于 $y^{*}$，则 $I$ 为零。这在数学上表示为：\n$$\nI = \\max(0, Y - y^{*})\n$$\n期望改进 $\\operatorname{EI}$ 是 $I$ 关于 $Y$ 的后验分布的期望值。\n$$\n\\operatorname{EI} = \\mathbb{E}[I] = \\mathbb{E}[\\max(0, Y - y^{*})]\n$$\n根据连续随机变量期望的定义，这通过对改进在其分布上进行积分来计算：\n$$\n\\operatorname{EI} = \\int_{-\\infty}^{\\infty} \\max(0, y - y^{*}) f(y; \\mu, \\sigma) \\, dy\n$$\n项 $\\max(0, y - y^{*})$ 仅在 $y  y^{*}$ 时非零。因此，积分的下限可以更改为 $y^{*}$，被积函数变为 $(y - y^{*})$：\n$$\n\\operatorname{EI} = \\int_{y^{*}}^{\\infty} (y - y^{*}) f(y; \\mu, \\sigma) \\, dy\n$$\n我们可以将这个积分分成两部分：\n$$\n\\operatorname{EI} = \\int_{y^{*}}^{\\infty} y f(y; \\mu, \\sigma) \\, dy - y^{*} \\int_{y^{*}}^{\\infty} f(y; \\mu, \\sigma) \\, dy\n$$\n为了计算这些积分，我们进行变量替换以标准化分布。令 $z = \\frac{y - \\mu}{\\sigma}$。这意味着 $y = \\sigma z + \\mu$ 和 $dy = \\sigma \\, dz$。标准正态分布 $\\mathcal{N}(0, 1)$ 的概率密度函数（PDF）是 $\\phi(z) = \\frac{1}{\\sqrt{2\\pi}}\\exp(-\\frac{z^2}{2})$，其累积分布函数（CDF）是 $\\Phi(z) = \\int_{-\\infty}^{z} \\phi(t) \\, dt$。原始的PDF可以用标准正态PDF表示为 $f(y; \\mu, \\sigma) = \\frac{1}{\\sigma}\\phi\\left(\\frac{y-\\mu}{\\sigma}\\right)$。因此，$f(y; \\mu, \\sigma) \\, dy = \\phi(z) \\, dz$。\n\n积分下限 $y = y^{*}$ 转换为 $z = \\frac{y^{*} - \\mu}{\\sigma}$。我们将此标准化值表示为 $z_{y^{*}} = \\frac{y^{*} - \\mu}{\\sigma}$。积分变为：\n$$\n\\operatorname{EI} = \\int_{z_{y^{*}}}^{\\infty} (\\sigma z + \\mu) \\phi(z) \\, dz - y^{*} \\int_{z_{y^{*}}}^{\\infty} \\phi(z) \\, dz\n$$\n让我们展开第一项：\n$$\n\\operatorname{EI} = \\sigma \\int_{z_{y^{*}}}^{\\infty} z \\phi(z) \\, dz + \\mu \\int_{z_{y^{*}}}^{\\infty} \\phi(z) \\, dz - y^{*} \\int_{z_{y^{*}}}^{\\infty} \\phi(z) \\, dz\n$$\n$$\n\\operatorname{EI} = (\\mu - y^{*}) \\int_{z_{y^{*}}}^{\\infty} \\phi(z) \\, dz + \\sigma \\int_{z_{y^{*}}}^{\\infty} z \\phi(z) \\, dz\n$$\n第一个积分是标准正态变量 $Z$ 的概率 $P(Z  z_{y^{*}})$，即 $1 - \\Phi(z_{y^{*}})$。\n第二个积分可以直接求解：\n$$\n\\int z \\phi(z) \\, dz = \\int z \\frac{1}{\\sqrt{2\\pi}}\\exp\\left(-\\frac{z^2}{2}\\right) \\, dz\n$$\n使用换元法 $u = -z^2/2$，我们有 $du = -z \\, dz$。\n$$\n\\int -\\frac{1}{\\sqrt{2\\pi}} \\exp(u) \\, du = -\\frac{1}{\\sqrt{2\\pi}} \\exp(u) = -\\phi(z)\n$$\n计算该定积分：\n$$\n\\int_{z_{y^{*}}}^{\\infty} z \\phi(z) \\, dz = [-\\phi(z)]_{z_{y^{*}}}^{\\infty} = -\\lim_{z \\to \\infty}\\phi(z) - (-\\phi(z_{y^{*}})) = 0 + \\phi(z_{y^{*}}) = \\phi(z_{y^{*}})\n$$\n将这些结果代回 $\\operatorname{EI}$ 的表达式中：\n$$\n\\operatorname{EI} = (\\mu - y^{*}) [1 - \\Phi(z_{y^{*}})] + \\sigma \\phi(z_{y^{*}})\n$$\n其中 $z_{y^{*}} = \\frac{y^{*} - \\mu}{\\sigma}$。\n为方便起见，我们定义一个新变量 $Z = \\frac{\\mu - y^{*}}{\\sigma} = -z_{y^{*}}$。利用标准正态分布的性质 $\\phi(-z) = \\phi(z)$ 和 $1 - \\Phi(-z) = \\Phi(z)$，表达式变为：\n$$\n\\operatorname{EI} = (\\mu - y^{*}) \\Phi(Z) + \\sigma \\phi(Z)\n$$\n这就是期望改进的最终解析表达式。\n\n现在，我们为给定的三个候选点计算 $\\operatorname{EI}$。\n数据如下：\n- 均值：$\\mu_1 = 0.5$, $\\mu_2 = 0.7$, $\\mu_3 = 0.6$。\n- 标准差：$\\sigma_1 = 0.1$, $\\sigma_2 = 0.2$, $\\sigma_3 = 0.15$。\n- 当前最佳值：$y^{*} = 0.65$。\n\n对于候选点 1 ($i=1$)：\n$\\mu_1 = 0.5$, $\\sigma_1 = 0.1$。\n$Z_1 = \\frac{\\mu_1 - y^{*}}{\\sigma_1} = \\frac{0.5 - 0.65}{0.1} = -1.5$。\n$\\operatorname{EI}_1 = (0.5 - 0.65) \\Phi(-1.5) + 0.1 \\phi(-1.5)$。\n使用标准表格或计算器，$\\Phi(-1.5) \\approx 0.066807$ 且 $\\phi(-1.5) = \\phi(1.5) = \\frac{1}{\\sqrt{2\\pi}}\\exp(-1.5^2/2) \\approx 0.129518$。\n$\\operatorname{EI}_1 \\approx (-0.15)(0.066807) + (0.1)(0.129518) \\approx -0.010021 + 0.0129518 \\approx 0.00293$。\n\n对于候选点 2 ($i=2$)：\n$\\mu_2 = 0.7$, $\\sigma_2 = 0.2$。\n$Z_2 = \\frac{\\mu_2 - y^{*}}{\\sigma_2} = \\frac{0.7 - 0.65}{0.2} = \\frac{0.05}{0.2} = 0.25$。\n$\\operatorname{EI}_2 = (0.7 - 0.65) \\Phi(0.25) + 0.2 \\phi(0.25)$。\n使用标准表格或计算器，$\\Phi(0.25) \\approx 0.598706$ 且 $\\phi(0.25) = \\frac{1}{\\sqrt{2\\pi}}\\exp(-0.25^2/2) \\approx 0.386668$。\n$\\operatorname{EI}_2 \\approx (0.05)(0.598706) + (0.2)(0.386668) \\approx 0.029935 + 0.077334 \\approx 0.10727$。\n\n对于候选点 3 ($i=3$)：\n$\\mu_3 = 0.6$, $\\sigma_3 = 0.15$。\n$Z_3 = \\frac{\\mu_3 - y^{*}}{\\sigma_3} = \\frac{0.6 - 0.65}{0.15} = \\frac{-0.05}{0.15} = -\\frac{1}{3}$。\n$\\operatorname{EI}_3 = (0.6 - 0.65) \\Phi(-1/3) + 0.15 \\phi(-1/3)$。\n使用计算器，$\\Phi(-1/3) \\approx 0.369441$ 且 $\\phi(-1/3) = \\phi(1/3) = \\frac{1}{\\sqrt{2\\pi}}\\exp(-(1/3)^2/2) \\approx 0.377383$。\n$\\operatorname{EI}_3 \\approx (-0.05)(0.369441) + (0.15)(0.377383) \\approx -0.018472 + 0.056607 \\approx 0.038135$。\n\n比较计算出的期望改进值：\n$\\operatorname{EI}_1 \\approx 0.00293$\n$\\operatorname{EI}_2 \\approx 0.10727$\n$\\operatorname{EI}_3 \\approx 0.03814$\n\n最大值为 $\\operatorname{EI}_2$。因此，下一个实验应在候选点 2 上进行。问题要求提供该候选点的基于1的索引。索引为 2。", "answer": "$$\\boxed{2}$$", "id": "3464220"}]}