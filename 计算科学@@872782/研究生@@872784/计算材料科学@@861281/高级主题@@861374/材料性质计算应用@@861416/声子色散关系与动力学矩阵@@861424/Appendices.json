{"hands_on_practices": [{"introduction": "理论的基石是理解最简单的模型。本练习将带您回到晶格动力学的“氢原子”模型——一维单原子链。通过从牛顿第二定律和和谐近似出发，您将亲手推导出声子色散关系，这是理解集体原子振动如何产生类波激发（即声子）的关键一步。这项实践旨在巩固动力学矩阵、波矢和频率之间物理联系的直观理解。[@problem_id:3477371]", "problem": "考虑一个一维 (1D) 单原子链，由质量为 $M$ 的相同原子组成，它们以晶格常数 $a$ 等距排列，并通过弹簧常数为 $K$ 的最近邻谐振子弹簧相互作用。设 $u_n(t)$ 表示位于平衡位置 $x_n = n a$ 的原子在时间 $t$ 时偏离其平衡位置的微小位移。假设原子间势能满足谐振子近似，系统具有平移不变性，并采用周期性玻恩-冯·卡门边界条件 (BvK)。从牛顿第二定律和晶格振动的倒易空间中动力学矩阵的定义出发，推导该系统的声子色散关系。将你的最终答案表示为关于 $q$、$a$、$K$ 和 $M$ 的单一闭式解析表达式 $\\omega(q)$。在你的最终表达式中不要包含任何单位。", "solution": "所述问题是固态物理学中一个有效、适定且基础的练习。它提供了所有必要信息，并依赖于既定的物理原理。我们将进行严格的推导。\n\n该系统是一个一维链，由质量为 $M$ 的相同原子组成，平衡晶格间距为 $a$。我们只考虑由常数为 $K$ 的谐振子弹簧建模的最近邻相互作用。设 $u_n(t)$ 是第 $n$ 个原子偏离其平衡位置 $x_n = na$ 的位移。\n\n在谐振子近似下，晶格的总势能 $V$ 可以写成各个弹簧势能之和：\n$$\nV = \\frac{1}{2} K \\sum_n (u_{n+1} - u_n)^2\n$$\n第 $n$ 个原子所受的力 $F_n$ 是由势能对其位移 $u_n$ 的负梯度给出：\n$$\nF_n = -\\frac{\\partial V}{\\partial u_n} = - \\frac{1}{2} K \\left[ \\frac{\\partial}{\\partial u_n} (u_n - u_{n-1})^2 + \\frac{\\partial}{\\partial u_n} (u_{n+1} - u_n)^2 \\right]\n$$\n$$\nF_n = - \\frac{1}{2} K \\left[ 2(u_n - u_{n-1})(1) + 2(u_{n+1} - u_n)(-1) \\right] = -K [(u_n - u_{n-1}) - (u_{n+1} - u_n)]\n$$\n$$\nF_n = K (u_{n+1} - 2u_n + u_{n-1})\n$$\n应用牛顿第二定律 $F_n = M \\ddot{u}_n$，我们得到第 $n$ 个原子的运动方程：\n$$\nM \\frac{d^2 u_n}{dt^2} = K (u_{n+1} - 2u_n + u_{n-1})\n$$\n这组耦合微分方程描述了晶格振动。问题指导我们通过动力学矩阵形式求解。运动方程通常可以用原子间力常数 $\\Phi(n, n')$ 表示为：\n$$\nM \\ddot{u}_n = -\\sum_{n'} \\Phi(n, n') u_{n'}\n$$\n其中 $\\Phi(n, n') = \\frac{\\partial^2 V}{\\partial u_n \\partial u_{n'}}$。通过将此形式与我们推导出的运动方程进行比较，我们可以确定力常数。让我们直接从势能计算它们：\n$$\n\\frac{\\partial V}{\\partial u_n} = K(2u_n - u_{n-1} - u_{n+1})\n$$\n二阶导数得出以下力常数：\n对于 $n' = n$：\n$$\n\\Phi(n, n) = \\frac{\\partial^2 V}{\\partial u_n^2} = 2K\n$$\n对于 $n' = n+1$：\n$$\n\\Phi(n, n+1) = \\frac{\\partial^2 V}{\\partial u_n \\partial u_{n+1}} = -K\n$$\n对于 $n' = n-1$：\n$$\n\\Phi(n, n-1) = \\frac{\\partial^2 V}{\\partial u_n \\partial u_{n-1}} = -K\n$$\n对于 $|n - n'| > 1|$，力常数为零，这与最近邻相互作用一致。\n\n实空间中的动力学矩阵定义为 $D(n, n') = \\frac{1}{M}\\Phi(n,n')$。由于无限链（或具有周期性边界条件的链）的平移不变性，这些矩阵元仅取决于原子间的相对距离，即 $D(n, n') = D(n-n')$。\n我们寻求形式为 $u_n(t) = A \\exp[i(q x_n - \\omega t)]$ 的平面波解，其中 $q$ 是波矢，$\\omega$ 是角频率。将此试探解代入运动方程，得到一个本征值问题。倒易空间中的动力学矩阵 $D(q)$ 是实空间动力学矩阵元的傅里叶变换：\n$$\nD(q) = \\sum_{l=-\\infty}^{\\infty} D(l) \\exp(-i q l a)\n$$\n其中 $l = n-n'$ 是邻居索引。在我们的情况下，求和是有限的，只包括 $l=0, +1, -1$：\n$$\nD(0) = \\frac{\\Phi(n,n)}{M} = \\frac{2K}{M}\n$$\n$$\nD(1) = \\frac{\\Phi(n,n+1)}{M} = -\\frac{K}{M}\n$$\n$$\nD(-1) = \\frac{\\Phi(n,n-1)}{M} = -\\frac{K}{M}\n$$\n将这些代入 $D(q)$ 的傅里叶和中：\n$$\nD(q) = D(0) + D(1)\\exp(-iqa) + D(-1)\\exp(iqa)\n$$\n$$\nD(q) = \\frac{2K}{M} - \\frac{K}{M}\\exp(-iqa) - \\frac{K}{M}\\exp(iqa)\n$$\n提出因子 $\\frac{K}{M}$：\n$$\nD(q) = \\frac{K}{M} \\left( 2 - [\\exp(iqa) + \\exp(-iqa)] \\right)\n$$\n使用欧拉公式 $\\cos(x) = \\frac{\\exp(ix) + \\exp(-ix)}{2}$，括号中的项变为 $2\\cos(qa)$。\n$$\nD(q) = \\frac{K}{M} (2 - 2\\cos(qa)) = \\frac{2K}{M} (1 - \\cos(qa))\n$$\n现在我们使用半角三角恒等式 $1 - \\cos(\\theta) = 2\\sin^2(\\frac{\\theta}{2})$。\n$$\nD(q) = \\frac{2K}{M} \\left( 2\\sin^2\\left(\\frac{qa}{2}\\right) \\right) = \\frac{4K}{M} \\sin^2\\left(\\frac{qa}{2}\\right)\n$$\n对于单原子晶格，动力学矩阵 $D(q)$ 是一个 $1 \\times 1$ 矩阵（一个标量）。其本征值等于 $\\omega^2(q)$。\n$$\n\\omega^2(q) = D(q) = \\frac{4K}{M} \\sin^2\\left(\\frac{qa}{2}\\right)\n$$\n为了找到色散关系 $\\omega(q)$，我们取平方根。由于频率是一个物理上非负的量，我们取正根，这涉及到对正弦函数取绝对值，因为波矢 $q$ 可以为负。\n$$\n\\omega(q) = \\sqrt{\\frac{4K}{M}} \\left| \\sin\\left(\\frac{qa}{2}\\right) \\right|\n$$\n这个表达式可以简化为：\n$$\n\\omega(q) = 2\\sqrt{\\frac{K}{M}} \\left| \\sin\\left(\\frac{qa}{2}\\right) \\right|\n$$\n这就是具有最近邻相互作用的一维单原子链的声子色散关系。", "answer": "$$\n\\boxed{2\\sqrt{\\frac{K}{M}} \\left| \\sin\\left(\\frac{qa}{2}\\right) \\right|}\n$$", "id": "3477371"}, {"introduction": "从理想化的理论模型转向真实的计算实践，我们会遇到各种数值挑战。在声子计算中，出现虚频是一个常见的现象，它可能预示着真正的晶格不稳定性，也可能仅仅是数值计算的产物。本练习旨在培养您的计算诊断能力，通过系统地测试超胞大小和位移幅度等关键参数，学会如何区分物理现实与数值误差。这项技能对于任何计算科学家来说都至关重要，是确保结果可靠性的核心。[@problem_id:3477409]", "problem": "考虑一个三维布拉维晶体，其原胞中含有一个质量为 $M$ 的原子。在谐振子近似下，围绕平衡位置的微小位移 $\\mathbf{u}$ 会产生力 $\\mathbf{F} = -\\Phi^{(2)} \\mathbf{u}$，其中 $\\Phi^{(2)}$ 是谐振力常数矩阵（即 Born–Oppenheimer 势能面相对于原子位移的亥姆霍兹矩阵）。波矢为 $\\mathbf{q}$ 处的动力学矩阵 $D_{\\alpha\\beta}(\\mathbf{q})$ 定义为\n$$\nD_{\\alpha\\beta}(\\mathbf{q}) = \\frac{1}{M} \\sum_{\\mathbf{R}} \\Phi^{(2)}_{\\alpha\\beta}(\\mathbf{R}) \\, e^{i \\mathbf{q}\\cdot \\mathbf{R}},\n$$\n其中 $\\Phi^{(2)}_{\\alpha\\beta}(\\mathbf{R})$ 耦合了由晶格矢量 $\\mathbf{R}$ 分隔的晶胞之间位移的笛卡尔分量 $\\alpha,\\beta \\in \\{x,y,z\\}$。声子频率 $\\omega(\\mathbf{q},s)$ 由本征值问题 $D(\\mathbf{q}) \\mathbf{e}_{\\mathbf{q}s} = \\omega^2(\\mathbf{q},s) \\mathbf{e}_{\\mathbf{q}s}$ 确定，其中 $s$ 标记声子支。虚频声子对应于 $\\omega^2(\\mathbf{q},s)  0$。\n\n在有限位移法中，通过对线性尺寸为 $L$ 的超胞（对于简单立方晶格，该超胞包含 $L^3$ 个原胞）中的原子施加振幅为 $\\Delta$ 的微小位移，计算力并构建有限差分来估算 $\\Phi^{(2)}$。这时会引入两种不同的数值误差来源：\n- 有限位移振幅效应，因为有限差分探测的是超出严格谐振子范围的势能，以及\n- 有限超胞截断，因为 $\\Phi^{(2)}(\\mathbf{R})$ 被有效地截断在 $|\\mathbf{R}| \\lesssim R_L$ 范围内（其中 $R_L$ 与 $L$ 成比例），这导致了一个误差项 $E_L(\\mathbf{q}) = \\sum_{\\mathbf{R}\\notin \\text{supercell}} \\Phi^{(2)}(\\mathbf{R}) e^{i \\mathbf{q}\\cdot \\mathbf{R}}$，当实空间相互作用衰减足够快时，该误差项在 $L \\to \\infty$ 时消失。\n\n此外，有限温度 $T$ 下的非谐重整化可以使模式稳定或失稳，因此重整化后的 $\\omega^2(\\mathbf{q},s;T)$ 可能随 $T$ 变化，其 $T\\to 0$ 的极限趋近于由 $\\Phi^{(2)}$ 决定的裸谐振子值。\n\n假设你在一次计算中在 $\\mathbf{q}^*$ 处观察到了一个虚频模式。你系统地扫描了位移振幅 $\\Delta$ 和超胞尺寸 $L$，并且你还考虑了通过自洽谐振子方案得到的重整化频率 $\\omega(\\mathbf{q}^*;T)$ 的温度依赖性。基于上述定义的第一性原理推断以及 $\\Delta \\to 0$、$L \\to \\infty$ 和 $T \\to 0$ 的极限行为，以下哪项诊断性陈述能正确区分数值赝象和真实的晶格不稳定性？\n\n选择所有适用项。\n\nA. 如果 $|\\omega^2(\\mathbf{q}^*)|$ 随 $L$ 的增加而单调减小，并在 $L \\to \\infty$ 时外推到 $0$，同时当 $\\Delta$ 足够小时基本不依赖于 $\\Delta$，那么该虚频最符合有限超胞截断误差，即一种在 $L \\to \\infty$ 时消失的数值赝象。\n\nB. 如果在固定的较大 $L$ 下， $|\\omega^2(\\mathbf{q}^*)|$ 显示出对 $\\Delta$ 的强依赖性，并且向 $\\Delta \\to 0$ 外推得到 $\\omega^2(\\mathbf{q}^*)  0$，那么在有限 $\\Delta$ 下的虚频最符合谐振力常数的有限位移污染，即一种在 $\\Delta \\to 0$ 时消失的数值赝象。\n\nC. 如果在 $\\Delta \\to 0$ 和 $L \\to \\infty$ 的双重极限下 $\\omega^2(\\mathbf{q}^*)$ 仍然为负，并且 $|\\omega^2(\\mathbf{q}^*;T)|$ 的大小随 $T \\to 0$ 而增加，那么该虚频最符合真实的晶格不稳定性，即谐振子势的一个负曲率，该曲率在 $T \\to 0$ 时持续存在并加深。\n\nD. 如果虚频仅出现在 $\\mathbf{q} \\approx \\mathbf{0}$ 附近，并且在对 $\\Phi^{(2)}$ 或 $D(\\mathbf{q})$ 强制执行声学求和规则（平移不变性）后消失，那么这种消失表明在小 $\\mathbf{q}$ 处存在真实的晶格不稳定性。", "solution": "该问题要求分析不同的计算观测结果，以区分声子计算中的真实晶格不稳定性与数值赝象。真实的晶格不稳定性对应于真实动力学矩阵 $D(\\mathbf{q})$ 的一个负本征值，即 $\\omega^2(\\mathbf{q},s)  0$。真实的动力学矩阵源于精确的谐振力常数 $\\Phi^{(2)}$，原则上，这需要在无限大超胞（$L \\to \\infty$）和无穷小位移（$\\Delta \\to 0$）的极限下进行计算。数值赝象是在接近这些极限时会消失的表面不稳定性。我们将基于这一基本原则来评估每个陈述。\n\n**A. 如果 $|\\omega^2(\\mathbf{q}^*)|$ 随 $L$ 的增加而单调减小，并在 $L \\to \\infty$ 时外推到 $0$，同时当 $\\Delta$ 足够小时基本不依赖于 $\\Delta$，那么该虚频最符合有限超胞截断误差，即一种在 $L \\to \\infty$ 时消失的数值赝象。**\n\n该陈述描述了关于超胞尺寸 $L$ 的收敛性测试。使用有限超胞计算的动力学矩阵 $D_L(\\mathbf{q})$ 是无限晶体精确动力学矩阵 $D_\\infty(\\mathbf{q})$ 的一个近似。其误差由 $E_L(\\mathbf{q}) = \\sum_{\\mathbf{R}\\notin \\text{supercell}} \\Phi^{(2)}(\\mathbf{R}) e^{i \\mathbf{q}\\cdot \\mathbf{R}}$ 给出，这是对所有未包含在超胞内的晶格矢量 $\\mathbf{R}$ 的求和。只要力常数 $\\Phi^{(2)}(\\mathbf{R})$ 随距离 $|\\mathbf{R}|$ 衰减得足够快，该误差项在 $L \\to \\infty$ 时就会消失。\n\n观察到的是，在有限 $L$ 下发现了一个虚频，意味着计算得到的本征值 $\\omega^2_L(\\mathbf{q}^*)  0$。该虚频模式的大小为 $|\\omega^2(\\mathbf{q}^*)| = -\\omega^2_L(\\mathbf{q}^*)$。该陈述指出，随着 $L$ 的增加，$-\\omega^2_L(\\mathbf{q}^*)$ 单调减小并外推至 $0$。这意味着在 $L \\to \\infty$ 的极限下，本征值 $\\omega^2_\\infty(\\mathbf{q}^*)$ 是非负的。因此，在有限 $L$下观察到的虚频是截断误差 $E_L(\\mathbf{q})$ 的直接后果，并不代表真实的无限晶体的性质。当 $\\Delta$ 足够小时，该行为与位移振幅 $\\Delta$ 无关这一条件，正确地将有限超胞尺寸分离出来，作为数值误差的主要来源。这是由超胞截断引起的数值赝象的典型特征。\n\n结论：**正确**。\n\n**B. 如果在固定的较大 $L$ 下， $|\\omega^2(\\mathbf{q}^*)|$ 显示出对 $\\Delta$ 的强依赖性，并且向 $\\Delta \\to 0$ 外推得到 $\\omega^2(\\mathbf{q}^*)  0$，那么在有限 $\\Delta$ 下的虚频最符合谐振力常数的有限位移污染，即一种在 $\\Delta \\to 0$ 时消失的数值赝象。**\n\n该陈述描述了关于位移振幅 $\\Delta$ 的收敛性测试。有限位移法使用有限差分近似来估计谐振力常数（势能的二阶导数）。对于任何有限的 $\\Delta$，这种近似都包含了来自势能的高阶非谐项的贡献。只有在 $\\Delta \\to 0$ 的极限下才能恢复真实的谐振力常数。\n\n该场景描述了在固定的、较大的超胞尺寸 $L$ 下进行的计算，这可以最小化 A 中讨论的截断误差。对于有限的 $\\Delta$，观察到了虚频 $\\omega^2(\\mathbf{q}^*)  0$。然而，通过系统地减小 $\\Delta$ 并外推到 $\\Delta \\to 0$，相应的本征值变为正值，$\\omega^2(\\mathbf{q}^*)  0$。这表明负曲率（不稳定性）并非真实谐振子势的特征，而是在有限 $\\Delta$下由非谐污染引入的赝象。该虚频模式在正确的谐振子极限下消失。\n\n结论：**正确**。\n\n**C. 如果在 $\\Delta \\to 0$ 和 $L \\to \\infty$ 的双重极限下 $\\omega^2(\\mathbf{q}^*)$ 仍然为负，并且 $|\\omega^2(\\mathbf{q}^*;T)|$ 的大小随 $T \\to 0$ 而增加，那么该虚频最符合真实的晶格不稳定性，即谐振子势的一个负曲率，该曲率在 $T \\to 0$ 时持续存在并加深。**\n\n该陈述描述了确认真实不稳定性的条件。首先，负本征值 $\\omega^2(\\mathbf{q}^*)  0$ 在 $\\Delta \\to 0$ 和 $L \\to \\infty$ 的双重极限下仍然存在。这个过程正是消除选项 A 和 B 中讨论的数值赝象并获得晶体真实谐振子性质所必需的。如果不稳定性在这个极限下依然存在，那么它就是谐振子势能面的一个真实特征。\n\n其次，考虑温度依赖性。问题指出，在有限温度 $T$ 下的重整化频率 $\\omega^2(\\mathbf{q},s;T)$ 在 $T \\to 0$ 时趋近于裸谐振子值。有限温度下的非谐效应通常会起到稳定晶格的作用（即使 $\\omega^2$ 更正）。观察到 $|\\omega^2(\\mathbf{q}^*;T)|$ 随 $T \\to 0$ 而增加，意味着本征值 $\\omega^2(\\mathbf{q}^*;T)$ 随着温度降低而变得更负。这种行为与系统在 $T=0$ 时接近一个真实的、潜在的谐振子不稳定性完全一致。有限温度下的非谐性部分地缓解了不稳定性，通过冷却消除这种热效应揭示了谐振子不稳定性的全部程度。\n\n结论：**正确**。\n\n**D. 如果虚频仅出现在 $\\mathbf{q} \\approx \\mathbf{0}$ 附近，并且在对 $\\Phi^{(2)}$ 或 $D(\\mathbf{q})$ 强制执行声学求和规则（平移不变性）后消失，那么这种消失表明在小 $\\mathbf{q}$ 处存在真实的晶格不稳定性。**\n\n声学求和规则（ASR）是一个源于晶体势平移不变性的物理约束。它规定了三个声学声子支在布里渊区中心 $\\mathbf{q}=\\mathbf{0}$ 处的频率必须为零。在数值计算中，特别是那些使用有限精度和有限超胞的计算，这个规则可能会被轻微违背。这种数值违背通常表现为声学模式在 $\\mathbf{q}=\\mathbf{0}$ 处的频率不为零，这可能在 $\\mathbf{q}$ 接近 $\\mathbf{0}$ 时被错误地表现为小的虚频。\n\n对计算出的力常数施加校正以强制满足 ASR 是一种标准做法。该程序旨在消除这些与声学模式相关的特定数值赝象。如果施加此校正导致 $\\mathbf{q} \\approx \\mathbf{0}$ 附近的虚频消失，则证明它们是数值违背 ASR 的直接结果。因此，这些虚频是数值赝象，而不是真实的物理不稳定性。一个真实的不稳定性（例如，铁电软模）不会被一个仅仅旨在恢复声学支平移不变性的程序所消除。该陈述得出了完全相反的结论。\n\n结论：**错误**。", "answer": "$$\\boxed{ABC}$$", "id": "3477409"}, {"introduction": "为了更深入地理解声子计算的“幕后工作”，我们将动手实践有限位移法的核心算法。此练习的核心任务是解决一个“逆问题”：如何从一组给定的原子位移及其产生的力中，反解出作为动力学矩阵基础的原子间力常数（IFCs）。您将构建并求解描述力与位移关系的线性方程组 $A \\mathbf{x} = \\mathbf{b}$，并学习使用伪逆和正则化等数值工具来处理现实中常见的病态或欠定问题。这项实践将揭示如何从第一性原理计算的原始力数据构建动力学矩阵，从而将抽象理论与具体算法联系起来。[@problem_id:3477423]", "problem": "您的任务是，在一个周期性简立方晶体中，使用 $3 \\times 3 \\times 3$ 的超胞，根据对给定原子位移的力响应，构建并求解提取原子间力常数 (IFC) 的逆问题。您需要在谐波近似的框架内进行操作。您必须使用的基本依据是晶体中力与位移之间的线性化关系：对于由 $i, j$ 索引的原子和由 $\\mu, \\nu$ 索引的笛卡尔分量，力由 $F_{i\\mu} = - \\sum_{j\\nu} \\Phi_{i\\mu,j\\nu} u_{j\\nu}$ 给出，其中 $\\Phi_{i\\mu,j\\nu}$ 是 IFC，而 $u_{j\\nu}$ 是位移。在一个每个原胞含一个原子且仅考虑最近邻中心相互作用的简立方晶格中，位于原点的中心原子与其位于 $\\pm \\hat{x}$、$\\pm \\hat{y}$ 和 $\\pm \\hat{z}$ 的邻居之间的 IFC 块简化为与键方向一致的对角形式。为解决此问题，请将每个轴视为解耦的，并将未知量建模为六个标量最近邻方向性 IFC：$k_{x}^{(+)}$, $k_{x}^{(-)}$, $k_{y}^{(+)}$, $k_{y}^{(-)}$, $k_{z}^{(+)}$, $k_{z}^{(-)}$，单位均为电子伏特每平方埃 ($\\mathrm{eV}/\\text{\\AA}^{2}$)。在一种位移模式下，中心原子沿轴 $\\alpha \\in \\{x,y,z\\}$ 受到的合力为 $F_{\\alpha} = - k_{\\alpha}^{(+)} u_{\\alpha}^{(+\\alpha)} - k_{\\alpha}^{(-)} u_{\\alpha}^{(-\\alpha)}$，其中 $u_{\\alpha}^{(+\\alpha)}$ 和 $u_{\\alpha}^{(-\\alpha)}$ 分别是位于 $+\\hat{\\alpha}$ 和 $-\\hat{\\alpha}$ 的邻居沿轴 $\\alpha$ 的位移分量，单位为埃 ($\\text{\\AA}$)。\n\n您的目标是：\n- 根据一组位移模式及其对应的力响应，构建线性系统 $A \\mathbf{x} = \\mathbf{b}$，其中 $\\mathbf{x} = [k_{x}^{(+)}, k_{x}^{(-)}, k_{y}^{(+)}, k_{y}^{(-)}, k_{z}^{(+)}, k_{z}^{(-)}]^T$。\n- 使用矩阵伪逆（通过奇异值分解 (SVD)）求解 $\\mathbf{x}$，并在需要时使用带有 Tikhonov (岭) 正则化的正则化最小二乘估计来稳定病态或欠定情况。正则化解是 $\\|\\!A \\mathbf{x} - \\mathbf{b}\\!\\|_2^2 + \\lambda \\|\\!\\mathbf{x}\\!\\|_2^2$ 的最小值，满足 $(A^T A + \\lambda I)\\mathbf{x} = A^T \\mathbf{b}$，其中 $\\lambda  0$。\n- 从概念上使用声学求和规则将每个轴上的自身 IFC 块解释为 $k_{\\alpha}^{(\\mathrm{self})} = k_{\\alpha}^{(+)} + k_{\\alpha}^{(-)}$，但您无需输出自身项。您必须在解决方案中讨论此约束如何产生以及在实践中如何使用。\n\n此问题不使用角度。所有物理量必须使用其明确的单位处理：位移单位为埃 ($\\text{\\AA}$)，力单位为电子伏特每埃 ($\\mathrm{eV}/\\text{\\AA}$)，IFC 单位为电子伏特每平方埃 ($\\mathrm{eV}/\\text{\\AA}^{2}$)。您的程序必须以 $\\mathrm{eV}/\\text{\\AA}^{2}$ 为单位输出所有恢复的 IFC，并将每个报告值四舍五入到六位小数。\n\n测试套件：\n您必须在程序中实现以下三个测试用例。在每个用例中，底层的真实 IFC 值为 $k_{x}^{(+)} = k_{x}^{(-)} = 10.0$，$k_{y}^{(+)} = k_{y}^{(-)} = 12.0$，$k_{z}^{(+)} = k_{z}^{(-)} = 8.0$，单位为 $\\mathrm{eV}/\\text{\\AA}^{2}$，并且必须根据公式 $F_{\\alpha} = - k_{\\alpha}^{(+)} u_{\\alpha}^{(+\\alpha)} - k_{\\alpha}^{(-)} u_{\\alpha}^{(-\\alpha)}$ 计算力。\n\n- 测试用例 1 (良态，信息丰富的模式)：使用以下六种位移模式，每种模式表示为 $\\left[u_{x}^{(+)}, u_{x}^{(-)}, u_{y}^{(+)}, u_{y}^{(-)}, u_{z}^{(+)}, u_{z}^{(-)}\\right]$，单位为埃 ($\\text{\\AA}$)。\n  1. $[0.02, 0, 0, 0, 0, 0]$\n  2. $[0, 0.03, 0, 0, 0, 0]$\n  3. $[0, 0, 0.01, 0, 0, 0]$\n  4. $[0, 0, 0, 0.04, 0, 0]$\n  5. $[0, 0, 0, 0, 0.05, 0]$\n  6. $[0, 0, 0, 0, 0, 0.02]$\n  使用真实 IFC 计算相应的力分量 $\\left[F_x, F_y, F_z\\right]$，并且仅将非平凡分量方程包含在线性系统中。\n\n- 测试用例 2 (病态，几乎共线的列加上确定性测量噪声)：使用以下五种位移模式，表示方法如上：\n  1. $[0.01, 0.0099, 0.02, 0.0202, 0.015, 0.0148]$\n  2. $[0.015, 0.0151, 0.025, 0.0249, 0.02, 0.0202]$\n  3. $[0.02, 0.02005, 0.03, 0.02995, 0.025, 0.02495]$\n  4. $[0.025, 0.02495, 0.035, 0.03505, 0.03, 0.0301]$\n  5. $[0.03, 0.0299, 0.04, 0.0402, 0.035, 0.0349]$\n  根据真实值计算力，然后逐个模式地添加以下确定性噪声偏移量 (单位为 $\\mathrm{eV}/\\text{\\AA}$):\n  - 对于 $F_x$：$[0.0001, -0.0002, 0.00015, -0.0001, 0.00025]$，\n  - 对于 $F_y$：$[-0.00013, 0.00022, -0.00017, 0.0001, -0.0002]$，\n  - 对于 $F_z$：$[0.00011, -0.00012, 0.00013, -0.00014, 0.00015]$。\n  使用伪逆和岭正则化 (使用 $\\lambda = 10^{-3}$) 两种方法求解。\n\n- 测试用例 3 (欠定，$\\pm$ 对的列完全共线)：使用以下四种位移模式：\n  1. $[0.02, 0.02, 0, 0, 0, 0]$\n  2. $[0, 0, 0.02, 0.02, 0, 0]$\n  3. $[0, 0, 0, 0, 0.05, 0.05]$\n  4. $[0.01, 0.01, 0.01, 0.01, 0, 0]$\n  根据真实值计算力，不加噪声。使用伪逆和岭正则化 (使用 $\\lambda = 10^{-3}$) 两种方法求解。\n\n算法要求：\n- 为每个非零力分量和模式构建矩阵 $A$ 的一行方程。对于对应于轴 $\\alpha$ 的方程，该行在 $k_{\\alpha}^{(+)}$ 和 $k_{\\alpha}^{(-)}$ 的列中分别具有条目 $-u_{\\alpha}^{(+\\alpha)}$ 和 $-u_{\\alpha}^{(-\\alpha)}$，其他位置为零。等式右侧是相应的力分量 $F_{\\alpha}$。\n- 计算伪逆解为 $\\mathbf{x}_{\\mathrm{pinv}} = A^{+} \\mathbf{b}$，其中 $A^{+}$ 是通过奇异值分解构造的 Moore–Penrose 伪逆。\n- 计算岭回归解为 $\\mathbf{x}_{\\mathrm{ridge}} = (A^T A + \\lambda I)^{-1} A^T \\mathbf{b}$，其中 $\\lambda = 10^{-3}$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。该列表必须按顺序包括：\n- 测试用例 1 的六个伪逆恢复的 IFC，\n- 测试用例 2 的六个伪逆恢复的 IFC，后跟测试用例 2 的六个岭回归恢复的 IFC，\n- 测试用例 3 的六个伪逆恢复的 IFC，后跟测试用例 3 的六个岭回归恢复的 IFC。\n所有值必须以 $\\mathrm{eV}/\\text{\\AA}^{2}$ 为单位报告，并四舍五入到六位小数。例如，格式必须类似于 $[\\dots]$，仅包含数值条目。", "solution": "该问题要求我们根据一组给定的原子位移模式及作用在中心原子上的合力，确定一组六个未知的最近邻原子间力常数 (IFC)，表示为向量 $\\mathbf{x} = [k_{x}^{(+)}, k_{x}^{(-)}, k_{y}^{(+)}, k_{y}^{(-)}, k_{z}^{(+)}, k_{z}^{(-)}]^T$。这构成了一个在简立方晶格动力学的谐波近似框架下的逆问题。\n\n提供的基本物理关系是关联力 $F$ 与位移 $u$ 的线性方程：\n$$F_{i\\mu} = - \\sum_{j\\nu} \\Phi_{i\\mu,j\\nu} u_{j\\nu}$$\n其中 $\\Phi_{i\\mu,j\\nu}$ 是力常数张量，表示由于原子 $j$ 在方向 $\\nu$ 上发生单位位移而对原子 $i$ 在方向 $\\mu$ 上产生的力的负值。对于指定的模型——一个只有最近邻中心相互作用且各轴解耦的简立方晶格——这个通用形式得到了显著简化。中心原子（位于原点）沿笛卡尔轴 $\\alpha \\in \\{x,y,z\\}$ 受到的力仅取决于其两个最近邻沿同一轴的位移。这些邻居相对于中心原子的位置在 $+\\hat{\\alpha}$ 和 $-\\hat{\\alpha}$。它们沿 $\\alpha$ 轴的位移分别表示为 $u_{\\alpha}^{(+\\alpha)}$ 和 $u_{\\alpha}^{(-\\alpha)}$。作用在中心原子上的力由下式给出：\n$$F_{\\alpha} = - k_{\\alpha}^{(+)} u_{\\alpha}^{(+\\alpha)} - k_{\\alpha}^{(-)} u_{\\alpha}^{(-\\alpha)}$$\n在这里，$k_{\\alpha}^{(+)}$ 和 $k_{\\alpha}^{(-)}$ 是我们旨在求出的标量 IFC。它们表示连接中心原子与其在正负 $\\alpha$ 方向上的邻居的弹簧常数。所有 IFC 的单位都是 $\\mathrm{eV}/\\text{\\AA}^{2}$，力的单位是 $\\mathrm{eV}/\\text{\\AA}$，位移的单位是 $\\text{\\AA}$。\n\n为了求解这六个未知的 IFC，我们构建一个形如 $A \\mathbf{x} = \\mathbf{b}$ 的线性方程组。每个位移模式最多提供三个方程，每个笛卡尔轴一个。对于给定位移模式下对应于轴 $\\alpha$ 的单个方程，可以写成：\n$$F_{\\alpha} = (-u_{\\alpha}^{(+\\alpha)}) k_{\\alpha}^{(+)} + (-u_{\\alpha}^{(-\\alpha)}) k_{\\alpha}^{(-)} + (0) k_{y}^{(+)} + \\dots$$\n这个结构定义了矩阵 $A$ 中的一行和向量 $\\mathbf{b}$ 中的相应元素。对于与轴 $\\alpha$ 相关的方程，$A$ 中的行向量将仅在对应于 $k_{\\alpha}^{(+)}$ 和 $k_{\\alpha}^{(-)}$ 的列中具有非零项；这些项分别为 $-u_{\\alpha}^{(+\\alpha)}$ 和 $-u_{\\alpha}^{(-\\alpha)}$。向量 $\\mathbf{b}$ 中的相应元素是测得的力分量 $F_{\\alpha}$。通过为所有信息丰富的位移模式组合这些行，我们构成了完整的线性系统 $A \\mathbf{x} = \\mathbf{b}$。如果相关位移 $u_{\\alpha}^{(+\\alpha)}$ 或 $u_{\\alpha}^{(-\\alpha)}$ 中至少有一个非零，则该方程被认为是信息丰富的并被包含在系统中。\n\n该问题要求讨论声学求和规则 (ASR)。ASR 是由晶体势的平移不变性产生的对 IFC 的一个基本约束。整个晶体任意矢量的刚性平移不能在任何原子上产生任何净力。在数学上，这意味着对于任何 $i, \\mu, \\nu$，都有 $\\sum_{j} \\Phi_{i\\mu,j\\nu} = 0$。我们可以将这个和分解为自身项 ($j=i$) 和邻居贡献项 ($j \\neq i$)：$\\Phi_{i\\mu,i\\nu} = - \\sum_{j \\neq i} \\Phi_{i\\mu,j\\nu}$。$\\Phi_{i\\mu,i\\nu}$ 项是原子 $i$ 的自身 IFC 或在位 IFC。在我们的简化模型中，力方程 $F_{\\alpha} = - k_{\\alpha}^{(+)} u_{\\alpha}^{(+\\alpha)} - k_{\\alpha}^{(-)} u_{\\alpha}^{(-\\alpha)}$ 允许我们将 $k_{\\alpha}^{(\\pm)}$ 与 $\\Phi$ 张量的特定非对角元素等同起来。ASR 随后规定对角自身项为 $\\Phi_{0\\alpha,0\\alpha} = - (k_{\\alpha}^{(+)} + k_{\\alpha}^{(-)})$。问题引入了一个量 $k_{\\alpha}^{(\\mathrm{self})} = k_{\\alpha}^{(+)} + k_{\\alpha}^{(-)}$，它是真实自身 IFC 分量的负值。在实践中，ASR 至关重要：它提供了一个物理约束，可用于对拟合模型强制施加物理真实性，或解决模糊性，如在欠定系统中只能确定某些 IFC 的和的情况。\n\n我们将使用两种方法求解该系统：\n\n$1$. Moore-Penrose 伪逆：$\\mathbf{x}_{\\mathrm{pinv}} = A^{+} \\mathbf{b}$。该方法很稳健，并提供了唯一的最小范数 ($L_2$) 解，该解也最小化了最小二乘误差 $\\|\\!A \\mathbf{x} - \\mathbf{b}\\!\\|_{2}^{2}$。对于欠定系统，它会从无限解集中选择一个特定的解。伪逆 $A^{+}$ 是通过对 $A = U \\Sigma V^T$ 进行奇异值分解 (SVD) 计算的，其中 $A^{+} = V \\Sigma^{+} U^T$。\n\n$2$. Tikhonov (岭) 正则化：该方法找到向量 $\\mathbf{x}$，它对于正则化参数 $\\lambda  0$ 最小化了正则化代价函数 $\\|\\!A \\mathbf{x} - \\mathbf{b}\\!\\|_{2}^{2} + \\lambda \\|\\!\\mathbf{x}\\!\\|_{2}^{2}$。解由正规方程给出：$\\mathbf{x}_{\\mathrm{ridge}} = (A^T A + \\lambda I)^{-1} A^T \\mathbf{b}$。$\\lambda I$ 项（其中 $I$ 是单位矩阵）使得矩阵 $(A^T A + \\lambda I)$ 可逆且良态，即使 $A^T A$ 是奇异或病态的。这通过惩罚大范数解来稳定解以抵抗噪声，并解决秩亏系统中的模糊性。\n\n三个测试用例探讨了不同的场景：\n- **测试用例 1** 是良态的。位移模式分离了六个 IFC 中的每一个，从而得到一个对角矩阵 $A$ 和一个唯一的精确解。\n- **测试用例 2** 是病态的。位移 $u_{\\alpha}^{(+)}$ 和 $u_{\\alpha}^{(-)}$ 几乎相等，使得 $A$ 中的相应列几乎共线。噪声的存在使得伪逆解不稳定且不准确。岭回归通过对问题进行正则化，预期会提供一个更稳定且具有物理意义的结果。\n- **测试用例 3** 是欠定且秩亏的。所选的位移使得 $u_{\\alpha}^{(+)} = u_{\\alpha}^{(-)}$，这使得 $A$ 中 $k_{\\alpha}^{(+)}$ 和 $k_{\\alpha}^{(-)}$ 的列完全相同。因此无法唯一地确定 $k_{\\alpha}^{(+)}$ 和 $k_{\\alpha}^{(-)}$ 各自的值；只能找到它们的和 $k_{\\alpha}^{(+)} + k_{\\alpha}^{(-)}$。伪逆法将产生最小范数解，在本例中这意味着 $k_{\\alpha}^{(+)} = k_{\\alpha}^{(-)}$。由于真实数据恰好满足此条件，伪逆解将是精确的。岭回归解将非常相似，同样会强制一个共线列的系数相近的解。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes Interatomic Force Constants (IFCs) from force-displacement data\n    for three distinct test cases, demonstrating solutions for well-conditioned,\n    ill-conditioned, and underdetermined linear systems.\n    \"\"\"\n\n    k_true = np.array([10.0, 10.0, 12.0, 12.0, 8.0, 8.0]) # [k_x+, k_x-, k_y+, k_y-, k_z+, k_z-] in eV/A^2\n\n    test_cases = [\n        {\n            \"id\": 1,\n            \"displacements\": np.array([\n                [0.02, 0, 0, 0, 0, 0],\n                [0, 0.03, 0, 0, 0, 0],\n                [0, 0, 0.01, 0, 0, 0],\n                [0, 0, 0, 0.04, 0, 0],\n                [0, 0, 0, 0, 0.05, 0],\n                [0, 0, 0, 0, 0, 0.02]\n            ]), # in Angstrom\n            \"noise\": None,\n            \"lambda_reg\": None,\n        },\n        {\n            \"id\": 2,\n            \"displacements\": np.array([\n                [0.01, 0.0099, 0.02, 0.0202, 0.015, 0.0148],\n                [0.015, 0.0151, 0.025, 0.0249, 0.02, 0.0202],\n                [0.02, 0.02005, 0.03, 0.02995, 0.025, 0.02495],\n                [0.025, 0.02495, 0.035, 0.03505, 0.03, 0.0301],\n                [0.03, 0.0299, 0.04, 0.0402, 0.035, 0.0349]\n            ]),\n            \"noise\": {\n                \"Fx\": np.array([0.0001, -0.0002, 0.00015, -0.0001, 0.00025]),\n                \"Fy\": np.array([-0.00013, 0.00022, -0.00017, 0.0001, -0.0002]),\n                \"Fz\": np.array([0.00011, -0.00012, 0.00013, -0.00014, 0.00015])\n            }, # in eV/A\n            \"lambda_reg\": 1e-3,\n        },\n        {\n            \"id\": 3,\n            \"displacements\": np.array([\n                [0.02, 0.02, 0, 0, 0, 0],\n                [0, 0, 0.02, 0.02, 0, 0],\n                [0, 0, 0, 0, 0.05, 0.05],\n                [0.01, 0.01, 0.01, 0.01, 0, 0]\n            ]),\n            \"noise\": None,\n            \"lambda_reg\": 1e-3,\n        }\n    ]\n\n    all_results = []\n\n    def generate_system(displacements, k_gt, noise_data):\n        \"\"\"\n        Constructs the linear system A*x = b from displacement patterns.\n        \"\"\"\n        A_rows = []\n        b_elements = []\n        \n        for i, u_pattern in enumerate(displacements):\n            u_x_p, u_x_n, u_y_p, u_y_n, u_z_p, u_z_n = u_pattern\n\n            k_x_p, k_x_n, k_y_p, k_y_n, k_z_p, k_z_n = k_gt\n\n            # Calculate forces from ground truth\n            Fx = - (k_x_p * u_x_p + k_x_n * u_x_n)\n            Fy = - (k_y_p * u_y_p + k_y_n * u_y_n)\n            Fz = - (k_z_p * u_z_p + k_z_n * u_z_n)\n\n            # Add noise if provided\n            if noise_data:\n                Fx += noise_data[\"Fx\"][i]\n                Fy += noise_data[\"Fy\"][i]\n                Fz += noise_data[\"Fz\"][i]\n\n            # Add equation for x-axis if displacements are non-zero\n            if not (u_x_p == 0 and u_x_n == 0):\n                A_rows.append([-u_x_p, -u_x_n, 0, 0, 0, 0])\n                b_elements.append(Fx)\n            \n            # Add equation for y-axis if displacements are non-zero\n            if not (u_y_p == 0 and u_y_n == 0):\n                A_rows.append([0, 0, -u_y_p, -u_y_n, 0, 0])\n                b_elements.append(Fy)\n\n            # Add equation for z-axis if displacements are non-zero\n            if not (u_z_p == 0 and u_z_n == 0):\n                A_rows.append([0, 0, 0, 0, -u_z_p, -u_z_n])\n                b_elements.append(Fz)\n\n        return np.array(A_rows), np.array(b_elements)\n\n    for case in test_cases:\n        A, b = generate_system(case[\"displacements\"], k_true, case[\"noise\"])\n        \n        # --- Pseudoinverse Solution ---\n        x_pinv = np.linalg.pinv(A) @ b\n        all_results.extend(x_pinv)\n\n        # --- Ridge Regression Solution (if applicable) ---\n        if case[\"lambda_reg\"] is not None:\n            lambda_val = case[\"lambda_reg\"]\n            num_vars = A.shape[1]\n            I = np.identity(num_vars)\n            \n            # x_ridge = (A.T @ A + lambda * I)^-1 @ A.T @ b\n            AtA = A.T @ A\n            Atb = A.T @ b\n            x_ridge = np.linalg.inv(AtA + lambda_val * I) @ Atb\n            all_results.extend(x_ridge)\n\n    # Format the final output string\n    formatted_results = [f\"{r:.6f}\" for r in all_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3477423"}]}