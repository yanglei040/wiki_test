{"hands_on_practices": [{"introduction": "吸附能不仅仅是固定几何构型下的相互作用能。当分子吸附到表面时，吸附物和表面原子都会发生重构以寻找新的能量最低点，这一过程被称为结构弛豫。本练习 [@problem_id:3432211] 使用一个简化的二次能量模型，帮助您量化这种结构弛豫带来的能量增益，并区分单点计算、仅吸附物弛豫、仅表面弛豫和完全弛豫这几种情况，从而直观地理解为何完整的结构优化是计算可靠吸附能的黄金标准。", "problem": "您需要构建并执行一个程序，该程序使用一个物理上合理的弛豫二次代理模型，对氨（$\\mathrm{NH_3}$）在氧化镁（MgO）上的吸附能进行单点计算和完全弛豫计算，并进行比较，同时量化因未弛豫吸附物和表面而引入的误差。吸附能定义为组合系统的总能量与各孤立组分能量之和的差值。在$ \\mathrm{密度泛函理论\\ (DFT)} $工作流程中，单点吸附能是在固定的参考几何构型下评估组合系统的能量，而完全弛豫吸附能则允许系统在相关自由度上进行能量最小化。在本问题中，您不会执行电子结构计算。取而代之的是，您将通过与谐波近似和线性响应一致的二次展开来模拟参考几何构型附近的能量学。\n\n基本和建模假设：\n- 吸附能 $ E_{\\mathrm{ads}} $ 定义为 $ E_{\\mathrm{ads}} = E_{\\mathrm{tot}}(\\text{surface} + \\text{adsorbate}) - E_{\\mathrm{surf}} - E_{\\mathrm{ads}}^{\\text{gas}} $，其中 $ E_{\\mathrm{tot}} $ 是组合系统的总能量，$ E_{\\mathrm{surf}} $ 是洁净表面的能量，$ E_{\\mathrm{ads}}^{\\text{gas}} $ 是孤立吸附物的能量。\n- 在参考几何构型（单点）附近，相对于单点基线的相互作用引起的能量变化被建模为\n$$\nE_{\\mathrm{rel}}(\\mathbf{x}) = \\frac{1}{2}\\,\\mathbf{x}^{\\top}\\mathbf{K}\\,\\mathbf{x} - \\mathbf{f}^{\\top}\\mathbf{x},\n$$\n其中 $ \\mathbf{x} $ 是所选自由度围绕参考几何构型的小位移（单位为埃 (Å)），$ \\mathbf{K} $ 是一个正定刚度矩阵（单位为 eV/Å$^2$），$ \\mathbf{f} $ 是一个有效力矢量（单位为 eV/Å），代表相互作用的线性驱动趋势。单点基线相互作用能为 $ E_{\\mathrm{int}}^{0} $（单位为电子伏特），使得当 $ \\mathbf{x} = \\mathbf{0} $ 时，吸附能等于 $ E_{\\mathrm{int}}^{0} $。\n- 在允许的坐标子集上进行弛豫的总吸附能，是通过最小化 $ E_{\\mathrm{rel}}(\\mathbf{x}) $（相对于这些坐标），同时将所有受约束的坐标固定在 $ \\mathbf{0} $ 来获得的。完全弛豫的吸附能对应于在所有坐标上进行最小化。仅吸附物弛豫是在吸附物坐标上进行最小化，同时保持表面坐标固定；而仅表面弛豫是在表面坐标上进行最小化，同时保持吸附物坐标固定。\n\n您的程序必须为每个测试用例计算以下三个量，并将它们作为正浮点数（单位为电子伏特 (eV)）返回，四舍五入到三位小数：\n- 单点吸附能相对于完全弛豫吸附能的误差，定义为 $ E_{\\mathrm{ads}}^{\\text{single}} - E_{\\mathrm{ads}}^{\\text{full}} $。\n- 仅吸附物弛豫的吸附能相对于完全弛豫吸附能的误差，定义为 $ E_{\\mathrm{ads}}^{\\text{ads-only}} - E_{\\mathrm{ads}}^{\\text{full}} $。\n- 仅表面弛豫的吸附能相对于完全弛豫吸附能的误差，定义为 $ E_{\\mathrm{ads}}^{\\text{surf-only}} - E_{\\mathrm{ads}}^{\\text{full}} $。\n\n所有能量必须以电子伏特 (eV) 表示。位移在概念上以埃 (Å) 为单位，刚度矩阵项以 eV/Å$^2$ 为单位，力矢量项以 eV/Å 为单位。您的程序必须实现精确的二次最小化；不允许使用数值优化。\n\n测试套件：\n对于每个测试用例，自由度的排序方式是：前 $p$ 个条目对应于吸附物自由度，后 $q$ 个条目对应于表面自由度。刚度矩阵是对角矩阵，$ \\mathbf{K} = \\mathrm{diag}(k_1, k_2, \\dots, k_{p+q}) $，力矢量为 $ \\mathbf{f} = (f_1, f_2, \\dots, f_{p+q}) $。请使用以下参数集：\n\n- 用例 $1$ (Mg顶位，中等强度的酸碱相互作用)：\n  - $p = 2$, $q = 1$。\n  - $ \\mathbf{K} = \\mathrm{diag}(18.0, 12.0, 45.0) $，单位 eV/Å$^2$。\n  - $ \\mathbf{f} = (2.5, 1.0, 1.5) $，单位 eV/Å。\n  - $ E_{\\mathrm{int}}^{0} = -0.90 $ eV。\n\n- 用例 $2$ (O顶位，较弱的相互作用)：\n  - $p = 2$, $q = 1$。\n  - $ \\mathbf{K} = \\mathrm{diag}(10.0, 8.0, 30.0) $，单位 eV/Å$^2$。\n  - $ \\mathbf{f} = (0.8, 0.3, 0.5) $，单位 eV/Å。\n  - $ E_{\\mathrm{int}}^{0} = -0.35 $ eV。\n\n- 用例 $3$ (Mg顶位，具有极刚的表面模式)：\n  - $p = 2$, $q = 1$。\n  - $ \\mathbf{K} = \\mathrm{diag}(16.0, 14.0, 1000000.0) $，单位 eV/Å$^2$。\n  - $ \\mathbf{f} = (2.0, 1.2, 1.0) $，单位 eV/Å。\n  - $ E_{\\mathrm{int}}^{0} = -0.80 $ eV。\n\n所需输出与格式：\n- 对于每个用例，计算三个浮点数：$ \\Delta_{\\mathrm{SP}} = E_{\\mathrm{ads}}^{\\text{single}} - E_{\\mathrm{ads}}^{\\text{full}} $，$ \\Delta_{\\mathrm{AO}} = E_{\\mathrm{ads}}^{\\text{ads-only}} - E_{\\mathrm{ads}}^{\\text{full}} $，以及 $ \\Delta_{\\mathrm{SO}} = E_{\\mathrm{ads}}^{\\text{surf-only}} - E_{\\mathrm{ads}}^{\\text{full}} $。这些数字必须以 eV 为单位，并四舍五入到三位小数。\n- 您的程序应生成单行输出，其中包含结果，格式为逗号分隔的列表的列表，严格遵循以下格式：\n$ [ [\\Delta_{\\mathrm{SP}}^{(1)}, \\Delta_{\\mathrm{AO}}^{(1)}, \\Delta_{\\mathrm{SO}}^{(1)}], [\\Delta_{\\mathrm{SP}}^{(2)}, \\Delta_{\\mathrm{AO}}^{(2)}, \\Delta_{\\mathrm{SO}}^{(2)}], [\\Delta_{\\mathrm{SP}}^{(3)}, \\Delta_{\\mathrm{AO}}^{(3)}, \\Delta_{\\mathrm{SO}}^{(3)}] ] $,\n其中上标 $ (1), (2), (3) $ 分别表示用例 $1$、 $2$、 $3$。输出必须是单行，无任何附加文本。所有值均以 eV 为单位。\n\n要求科学真实性：请勿更改所提供的参数，并确保您的程序精确、确定地解决所定义的二次最小化问题，并遵守指定的单位。", "solution": "用户在计算材料科学领域提供了一个科学上有效且定义明确的问题。该问题要求使用一个物理上合理的能量景观二次模型，来量化在忽略或仅部分包含结构弛豫时，吸附能计算中的误差。解决方案需要在不同约束条件下对二次能量泛函进行精确最小化。\n\n基本原理是，总吸附能 $E_{\\mathrm{ads}}$ 是基准单点相互作用能 $E_{\\mathrm{int}}^{0}$ 和弛豫能量项 $E_{\\mathrm{rel}}(\\mathbf{x})$ 的和，后者取决于原子相对于参考几何构型的位移 $\\mathbf{x}$。弛豫能的泛函形式为：\n$$\nE_{\\mathrm{rel}}(\\mathbf{x}) = \\frac{1}{2}\\,\\mathbf{x}^{\\top}\\mathbf{K}\\,\\mathbf{x} - \\mathbf{f}^{\\top}\\mathbf{x}\n$$\n其中 $\\mathbf{K}$ 是正定刚度（海森）矩阵，$\\mathbf{f}$ 是力矢量（负梯度）。因此，总吸附能为 $E_{\\mathrm{ads}}(\\mathbf{x}) = E_{\\mathrm{int}}^{0} + E_{\\mathrm{rel}}(\\mathbf{x})$。\n\n为了找到给定允许位移集合的最小能量，我们必须找到使 $E_{\\mathrm{rel}}(\\mathbf{x})$ 最小化的位移矢量 $\\mathbf{x}^*$。这发生在能量相对于允许位移的梯度为零的地方。设完整的坐标集被划分为一个允许的坐标集 $\\mathbf{x}_a$ 和一个固定的坐标集 $\\mathbf{x}_f = \\mathbf{0}$。通过将能量函数相对于 $\\mathbf{x}_a$ 的梯度设为零来最小化能量函数：\n$$\n\\nabla_{\\mathbf{x}_a} E_{\\mathrm{rel}}(\\mathbf{x}) = \\mathbf{K}_{aa}\\mathbf{x}_a - \\mathbf{f}_a = \\mathbf{0}\n$$\n其中 $\\mathbf{K}_{aa}$ 是 $\\mathbf{K}$ 中对应于允许坐标的子矩阵，$\\mathbf{f}_a$ 是 $\\mathbf{f}$ 对应的子矢量。允许坐标的最佳位移是 $\\mathbf{x}_a^* = \\mathbf{K}_{aa}^{-1}\\mathbf{f}_a$。\n\n将其代回能量泛函（其中 $\\mathbf{x}_f = \\mathbf{0}$），最小弛豫能为：\n$$\nE_{\\mathrm{rel}}^{\\text{min}} = \\frac{1}{2}(\\mathbf{x}_a^*)^{\\top}\\mathbf{K}_{aa}\\mathbf{x}_a^* - \\mathbf{f}_a^{\\top}\\mathbf{x}_a^* = \\frac{1}{2}\\mathbf{f}_a^{\\top}(\\mathbf{K}_{aa}^{-1})^{\\top}\\mathbf{K}_{aa}(\\mathbf{K}_{aa}^{-1}\\mathbf{f}_a) - \\mathbf{f}_a^{\\top}(\\mathbf{K}_{aa}^{-1}\\mathbf{f}_a) = -\\frac{1}{2}\\mathbf{f}_a^{\\top}\\mathbf{K}_{aa}^{-1}\\mathbf{f}_a\n$$\n问题指明刚度矩阵 $\\mathbf{K}$ 是对角矩阵，即 $\\mathbf{K} = \\mathrm{diag}(k_1, k_2, \\dots, k_{p+q})$。这极大地简化了计算，因为各个自由度是解耦的。其逆矩阵就是 $\\mathbf{K}^{-1} = \\mathrm{diag}(1/k_1, 1/k_2, \\dots, 1/k_{p+q})$。沿着坐标子集进行最小化所关联的弛豫能是每个允许坐标 $i$ 的单个弛豫能 $R_i = -\\frac{1}{2}f_i^2/k_i$ 的总和。\n\n现在我们可以定义四个相关的吸附能：\n1.  **单点吸附能 ($E_{\\mathrm{ads}}^{\\text{single}}$)**：不允许弛豫，因此 $\\mathbf{x} = \\mathbf{0}$ 且 $E_{\\mathrm{rel}} = 0$。\n    $$E_{\\mathrm{ads}}^{\\text{single}} = E_{\\mathrm{int}}^{0}$$\n2.  **完全弛豫吸附能 ($E_{\\mathrm{ads}}^{\\text{full}}$)**：所有 $p+q$ 个坐标都进行弛豫。弛豫能是所有坐标上贡献的总和。\n    $$E_{\\mathrm{ads}}^{\\text{full}} = E_{\\mathrm{int}}^{0} - \\frac{1}{2}\\sum_{i=1}^{p+q} \\frac{f_i^2}{k_i}$$\n3.  **仅吸附物弛豫的吸附能 ($E_{\\mathrm{ads}}^{\\text{ads-only}}$)**：仅前 $p$ 个吸附物坐标进行弛豫。\n    $$E_{\\mathrm{ads}}^{\\text{ads-only}} = E_{\\mathrm{int}}^{0} - \\frac{1}{2}\\sum_{i=1}^{p} \\frac{f_i^2}{k_i}$$\n4.  **仅表面弛豫的吸附能 ($E_{\\mathrm{ads}}^{\\text{surf-only}}$)**：仅后 $q$ 个表面坐标进行弛豫。\n    $$E_{\\mathrm{ads}}^{\\text{surf-only}} = E_{\\mathrm{int}}^{0} - \\frac{1}{2}\\sum_{i=p+1}^{p+q} \\frac{f_i^2}{k_i}$$\n\n问题要求计算三个误差量，它们代表了忽略某些弛豫所带来的能量代价。\n-   **单点与完全弛豫的误差，$\\Delta_{\\mathrm{SP}}$**：这是通过弛豫所有自由度所获得的总能量。\n    $$\\Delta_{\\mathrm{SP}} = E_{\\mathrm{ads}}^{\\text{single}} - E_{\\mathrm{ads}}^{\\text{full}} = E_{\\mathrm{int}}^{0} - \\left(E_{\\mathrm{int}}^{0} - \\frac{1}{2}\\sum_{i=1}^{p+q} \\frac{f_i^2}{k_i}\\right) = \\frac{1}{2}\\sum_{i=1}^{p+q} \\frac{f_i^2}{k_i}$$\n-   **仅吸附物弛豫与完全弛豫的误差，$\\Delta_{\\mathrm{AO}}$**：这是通过弛豫在仅吸附物计算中被忽略的表面坐标所获得的能量。\n    $$\\Delta_{\\mathrm{AO}} = E_{\\mathrm{ads}}^{\\text{ads-only}} - E_{\\mathrm{ads}}^{\\text{full}} = \\left(E_{\\mathrm{int}}^{0} - \\frac{1}{2}\\sum_{i=1}^{p} \\frac{f_i^2}{k_i}\\right) - \\left(E_{\\mathrm{int}}^{0} - \\frac{1}{2}\\sum_{i=1}^{p+q} \\frac{f_i^2}{k_i}\\right) = \\frac{1}{2}\\sum_{i=p+1}^{p+q} \\frac{f_i^2}{k_i}$$\n-   **仅表面弛豫与完全弛豫的误差，$\\Delta_{\\mathrm{SO}}$**：这是通过弛豫在仅表面计算中被忽略的吸附物坐标所获得的能量。\n    $$\\Delta_{\\mathrm{SO}} = E_{\\mathrm{ads}}^{\\text{surf-only}} - E_{\\mathrm{ads}}^{\\text{full}} = \\left(E_{\\mathrm{int}}^{0} - \\frac{1}{2}\\sum_{i=p+1}^{p+q} \\frac{f_i^2}{k_i}\\right) - \\left(E_{\\mathrm{int}}^{0} - \\frac{1}{2}\\sum_{i=1}^{p+q} \\frac{f_i^2}{k_i}\\right) = \\frac{1}{2}\\sum_{i=1}^{p} \\frac{f_i^2}{k_i}$$\n\n注意到简单的关系式 $\\Delta_{\\mathrm{SP}} = \\Delta_{\\mathrm{AO}} + \\Delta_{\\mathrm{SO}}$，该关系式成立的原因是自由度是解耦的（即 $\\mathbf{K}$ 是对角矩阵）。\n\n算法如下：\n对于每个测试用例，给定参数 $p$、$q$、$\\mathbf{K}=\\mathrm{diag}(k_i)$ 和 $\\mathbf{f}=(f_i)$：\n1.  计算每个自由度的单个弛豫能贡献：$E_{\\mathrm{rel},i} = \\frac{1}{2} \\frac{f_i^2}{k_i}$。\n2.  通过对前 $p$ 个坐标求和来计算总吸附物弛豫能：$E_{\\mathrm{relax, ads}} = \\sum_{i=1}^{p} E_{\\mathrm{rel},i}$。这等于 $\\Delta_{\\mathrm{SO}}$。\n3.  通过对后 $q$ 个坐标求和来计算总表面弛豫能：$E_{\\mathrm{relax, surf}} = \\sum_{i=p+1}^{p+q} E_{\\mathrm{rel},i}$。这等于 $\\Delta_{\\mathrm{AO}}$。\n4.  计算总弛豫能：$E_{\\mathrm{relax, total}} = E_{\\mathrm{relax, ads}} + E_{\\mathrm{relax, surf}}$。这等于 $\\Delta_{\\mathrm{SP}}$。\n5.  收集三个误差项 $[\\Delta_{\\mathrm{SP}}, \\Delta_{\\mathrm{AO}}, \\Delta_{\\mathrm{SO}}]$，将每一项四舍五入到三位小数，并按要求格式化。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates and compares single-point versus relaxed adsorption energies\n    for three test cases using a quadratic surrogate model.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (Mg-top site, moderately strong acid-base interaction)\n        {\n            \"p\": 2, \"q\": 1,\n            \"K_diag\": np.array([18.0, 12.0, 45.0]),\n            \"f\": np.array([2.5, 1.0, 1.5]),\n        },\n        # Case 2 (O-top site, weaker interaction)\n        {\n            \"p\": 2, \"q\": 1,\n            \"K_diag\": np.array([10.0, 8.0, 30.0]),\n            \"f\": np.array([0.8, 0.3, 0.5]),\n        },\n        # Case 3 (Mg-top site with an extremely stiff surface mode)\n        {\n            \"p\": 2, \"q\": 1,\n            \"K_diag\": np.array([16.0, 14.0, 1000000.0]),\n            \"f\": np.array([2.0, 1.2, 1.0]),\n        }\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        p = case[\"p\"]\n        k = case[\"K_diag\"]\n        f = case[\"f\"]\n        \n        # Calculate the relaxation energy contribution for each coordinate.\n        # This is E_rel,i = 0.5 * f_i^2 / k_i.\n        relaxation_energies = 0.5 * np.square(f) / k\n        \n        # The energy gain from relaxing adsorbate coordinates corresponds to Delta_SO.\n        # This is the sum over the first p coordinates.\n        delta_so = np.sum(relaxation_energies[:p])\n        \n        # The energy gain from relaxing surface coordinates corresponds to Delta_AO.\n        # This is the sum over the last q coordinates.\n        delta_ao = np.sum(relaxation_energies[p:])\n        \n        # The total relaxation energy corresponds to Delta_SP.\n        # Since K is diagonal, this is the sum of adsorbate and surface relaxations.\n        delta_sp = delta_so + delta_ao\n        \n        # Assemble the results for the current case.\n        # The problem asks for positive floats rounded to three decimal places.\n        case_results = [delta_sp, delta_ao, delta_so]\n        all_results.append(case_results)\n\n    # Format the final output string exactly as specified.\n    # The output is a comma-separated list of lists, with no spaces.\n    inner_lists_str = []\n    for res_list in all_results:\n        # Format each number to always show 3 decimal places.\n        formatted_nums = [f\"{x:.3f}\" for x in res_list]\n        # Join numbers with a comma.\n        inner_str = f\"[{','.join(formatted_nums)}]\"\n        inner_lists_str.append(inner_str)\n        \n    # Join the string representations of inner lists with a comma.\n    final_output_str = f\"[{','.join(inner_lists_str)}]\"\n\n    # Final print statement in the exact required format.\n    print(final_output_str)\n\nsolve()\n```", "id": "3432211"}, {"introduction": "在掌握了结构弛豫的重要性之后，下一步是学习如何在周期性平板模型（slab model）中正确地设置计算。人为引入的周期性可能会导致来自平板厚度、真空层大小和横向超胞尺寸的误差，这些统称为有限尺寸效应。本练习 [@problem_id:3432251] 提供了一组实际的（尽管是假设的）收敛性测试数据，挑战您像一位真正的计算科学家一样思考：诊断每个参数的收敛趋势，并为确保计算精度建立合理的收敛标准。", "problem": "一位研究人员正在使用三维周期性边界条件下的周期性密度泛函理论 (DFT) 计算一氧化碳在晚期过渡金属 $(111)$ 表面上的吸附能。板坯模型对洁净板坯使用一个对称的 $(m \\times m)$ 面内超胞，其中包含 $m$ 个金属层沿表面法线方向；当分子仅吸附在一侧时，则使用非对称板坯。所有计算均采用相同的交换相关泛函、赝势、平面波截断能和电子展宽。布里渊区采用 Monkhorst–Pack 网格进行采样。该研究人员在提取吸附能时，怀疑存在由板坯厚度、真空层间距、$k$ 点采样和面内胞尺寸引起的有限尺寸效应误差。\n\n研究人员系统地改变单个参数，同时保持其他参数固定，并观察到以下吸附能（负值表示放热吸附）。所有能量均以电子伏特报告。\n\n- 板坯厚度依赖性（真空层间距 $L_z = 15\\,\\text{\\AA}$，面内超胞 $3 \\times 3$，$k$ 点网格 $6 \\times 6 \\times 1$）：\n  - $N_{\\mathrm{layers}} = 3 \\Rightarrow E_{\\mathrm{ads}} = -1.063$\n  - $N_{\\mathrm{layers}} = 5 \\Rightarrow E_{\\mathrm{ads}} = -1.121$\n  - $N_{\\mathrm{layers}} = 7 \\Rightarrow E_{\\mathrm{ads}} = -1.129$\n\n- 无显式偶极校正的非对称板坯的真空层间距依赖性（面内超胞 $3 \\times 3$，$N_{\\mathrm{layers}} = 5$，$k$ 点网格 $6 \\times 6 \\times 1$）：\n  - $L_z = 12\\,\\text{\\AA} \\Rightarrow E_{\\mathrm{ads}} = -1.085$\n  - $L_z = 18\\,\\text{\\AA} \\Rightarrow E_{\\mathrm{ads}} = -1.123$\n  - $L_z = 24\\,\\text{\\AA} \\Rightarrow E_{\\mathrm{ads}} = -1.128$\n\n- 金属表面的 $k$ 点采样依赖性（面内超胞 $3 \\times 3$，$N_{\\mathrm{layers}} = 5$，$L_z = 18\\,\\text{\\AA}$）：\n  - $4 \\times 4 \\times 1 \\Rightarrow E_{\\mathrm{ads}} = -1.102$\n  - $6 \\times 6 \\times 1 \\Rightarrow E_{\\mathrm{ads}} = -1.128$\n  - $12 \\times 12 \\times 1 \\Rightarrow E_{\\mathrm{ads}} = -1.131$\n\n- 面内胞尺寸的依赖性，保持 $k$ 点密度近似恒定（通过将网格与 $m$ 成反比缩放来达到相似的面内采样密度），固定 $N_{\\mathrm{layers}} = 5$，$L_z = 18\\,\\text{\\AA}$：\n  - $2 \\times 2$ 胞，使用 $9 \\times 9 \\times 1 \\Rightarrow E_{\\mathrm{ads}} = -0.978$\n  - $3 \\times 3$ 胞，使用 $6 \\times 6 \\times 1 \\Rightarrow E_{\\mathrm{ads}} = -1.128$\n  - $4 \\times 4$ 胞，使用 $4 \\times 4 \\times 1 \\Rightarrow E_{\\mathrm{ads}} = -1.132$\n\n从周期性 DFT 中吸附能的标准定义以及周期性边界条件下周期性镜像的物理后果出发，哪个选项最佳地定义了吸附能，正确地诊断了上述观察到的有限尺寸效应误差的主要来源和标度关系，同时还为这四种误差来源推荐了科学上合理且定量的收敛标准？\n\nA. 吸附能是组合的吸附物-板坯系统的总能量相对于使用相同数值设置计算的洁净板坯和孤立吸附物能量之和。对于金属板坯，由于电子屏蔽效应，有限板坯厚度误差会随着 $N_{\\mathrm{layers}}$ 的增加而迅速衰减，当增加两层后的变化小于 $0.01\\,\\mathrm{eV}$ 时，可认为误差可以忽略不计。对于无偶极校正的非对称板坯，重复板坯之间的赝静电相互作用主要与 $L_z$ 成反比，因此应增加 $L_z$ 直到每增加 $6\\,\\text{\\AA}$ 吸附能的变化小于 $0.01\\,\\mathrm{eV}$；若使用偶极校正，每 $6\\,\\text{\\AA}$ 采用更严格的 $0.005\\,\\mathrm{eV}$ 标准是合理的。对于金属表面，通过在固定胞尺寸下将线性 $k$ 点密度加倍来诊断 $k$ 点积分误差，并要求变化小于 $0.005\\,\\mathrm{eV}$。面内有限尺寸效应反映了周期性镜像之间的横向相互作用和覆盖度效应；对于具有偶极相互作用的吸附物，这些效应通常随着面内长度的增加而减小，一个实际的目标是 $3 \\times 3$ 和 $4 \\times 4$ 胞之间的变化小于 $0.01\\,\\mathrm{eV}$。\n\nB. 吸附能是组合系统总能量相对于仅洁净板坯能量的值。有限板坯厚度误差按 $N_{\\mathrm{layers}}$ 的倒数衰减，而真空层误差无论板坯对称性如何，总是按 $L_z$ 的立方倒数标度；将 $N_{\\mathrm{layers}}$ 增加两层或将 $L_z$ 增加 $6\\,\\text{\\AA}$，变化小于 $0.10\\,\\mathrm{eV}$ 即已足够。对于金属，诊断 $k$ 点误差的最佳方法是减小展宽而不是改变网格。面内相互作用在 $2 \\times 2$ 胞之外可以忽略不计。\n\nC. 吸附能应取为组合系统的总能量减去板坯能量加上孤立吸附物能量，并且只要它们各自收敛，比较使用不同展宽和截断能的计算是可以接受的。真空层误差随 $L_z$ 指数衰减，因此 $12\\,\\text{\\AA}$ 的小真空层总是足够的。对于金属表面，为避免费米面误差，首选 $\\Gamma$ 点采样。通过增加 $k$ 点密度比扩大胞能更好地控制面内相互作用。\n\nD. 吸附能是组合系统与洁净板坯的总能量之差，孤立吸附物的能量被省略，因为它在覆盖度低时会抵消。如果从 $3$ 层增加到 $5$ 层的变化小于 $0.05\\,\\mathrm{eV}$，则板坯厚度误差可忽略不计。对于非对称板坯，由于金属屏蔽的短程性，真空层误差随 $L_z$ 指数衰减，因此将 $L_z$ 增加到 $18\\,\\text{\\AA}$ 以上是不必要的。对于大的超胞，可以通过仅使用 $\\Gamma$ 点来消除 $k$ 点误差。稳健的收敛应对所有参数要求变化小于 $0.0001\\,\\mathrm{eV}$，无论系统如何。", "solution": "## 问题验证\n\n### 第1步：提取已知信息\n\n问题提供了以下信息：\n\n**系统与方法：**\n- 计算：一氧化碳 (CO) 在晚期过渡金属 $(111)$ 表面上的吸附能。\n- 方法：三维周期性边界条件下的周期性密度泛函理论 (DFT)。\n- 板坯模型：洁净表面使用对称板坯，组合系统使用非对称板坯（分子在一侧）。板坯有 $N_{\\mathrm{layers}}$ 个层和一个 $(m \\times m)$ 的面内超胞。\n- 恒定参数：所有计算均使用相同的交换相关泛函、赝势、平面波截断能和电子展宽。\n- 布里渊区采样：Monkhorst-Pack 网格。\n\n**观测数据（吸附能，$E_{\\mathrm{ads}}$，单位为 eV）：**\n\n1.  **板坯厚度依赖性**（真空层 $L_z = 15\\,\\text{\\AA}$，超胞 $3 \\times 3$，$k$ 点网格 $6 \\times 6 \\times 1$）：\n    -   $N_{\\mathrm{layers}} = 3 \\Rightarrow E_{\\mathrm{ads}} = -1.063\\,\\mathrm{eV}$\n    -   $N_{\\mathrm{layers}} = 5 \\Rightarrow E_{\\mathrm{ads}} = -1.121\\,\\mathrm{eV}$\n    -   $N_{\\mathrm{layers}} = 7 \\Rightarrow E_{\\mathrm{ads}} = -1.129\\,\\mathrm{eV}$\n\n2.  **真空层间距依赖性**（非对称板坯，无偶极校正，超胞 $3 \\times 3$，$N_{\\mathrm{layers}} = 5$，$k$ 点网格 $6 \\times 6 \\times 1$）：\n    -   $L_z = 12\\,\\text{\\AA} \\Rightarrow E_{\\mathrm{ads}} = -1.085\\,\\mathrm{eV}$\n    -   $L_z = 18\\,\\text{\\AA} \\Rightarrow E_{\\mathrm{ads}} = -1.123\\,\\mathrm{eV}$\n    -   $L_z = 24\\,\\text{\\AA} \\Rightarrow E_{\\mathrm{ads}} = -1.128\\,\\mathrm{eV}$\n\n3.  **$k$ 点采样依赖性**（金属表面，超胞 $3 \\times 3$，$N_{\\mathrm{layers}} = 5$，$L_z = 18\\,\\text{\\AA}$）：\n    -   $4 \\times 4 \\times 1 \\Rightarrow E_{\\mathrm{ads}} = -1.102\\,\\mathrm{eV}$\n    -   $6 \\times 6 \\times 1 \\Rightarrow E_{\\mathrm{ads}} = -1.128\\,\\mathrm{eV}$\n    -   $12 \\times 12 \\times 1 \\Rightarrow E_{\\mathrm{ads}} = -1.131\\,\\mathrm{eV}$\n\n4.  **面内胞尺寸依赖性**（$k$ 点密度恒定，$N_{\\mathrm{layers}} = 5$，$L_z = 18\\,\\text{\\AA}$）：\n    -   $2 \\times 2$ 胞，使用 $9 \\times 9 \\times 1 \\Rightarrow E_{\\mathrm{ads}} = -0.978\\,\\mathrm{eV}$\n    -   $3 \\times 3$ 胞，使用 $6 \\times 6 \\times 1 \\Rightarrow E_{\\mathrm{ads}} = -1.128\\,\\mathrm{eV}$\n    -   $4 \\times 4$ 胞，使用 $4 \\times 4 \\times 1 \\Rightarrow E_{\\mathrm{ads}} = -1.132\\,\\mathrm{eV}$\n\n**问题：**\n哪个选项最佳地定义了吸附能，正确地诊断了上述观察到的有限尺寸效应误差的来源和标度关系，并为这四种误差来源推荐了科学上合理且定量的收敛标准？\n\n### 第2步：使用提取的已知信息进行验证\n\n-   **科学依据：** 该问题牢固地定位于计算材料科学领域，描述了使用DFT计算表面吸附能的一套标准收敛性测试。所改变的参数（$N_{\\mathrm{layers}}$、$L_z$、$k$ 点、胞尺寸）是此类计算中有限尺寸效应误差的主要来源。所提供的数值数据显示了与既定物理原理和计算观察完全一致的收敛趋势。例如，吸附能随板坯厚度、真空尺寸、$k$ 点密度和面内胞尺寸的增加而收敛。使用非对称板坯进行吸附计算是标准程序。没有违反科学原理的地方。\n-   **提问清晰：** 问题提供了清晰的背景、定量的数据和一个具体的问题，要求对现象进行正确解释并给出最佳实践。通过将各选项与第一性原理和数据进行比较，可以确定唯一的答案。\n-   **客观性：** 语言是技术性和客观的。所提供的数据是数值性的，没有主观解释的余地。\n-   **完整性：** 问题陈述是自洽的。它提供了评估物理现象（有限尺寸效应误差）和相应最佳实践所需的所有信息。关于“$m$ 层”的模糊性在数据部分通过明确使用“$N_{\\mathrm{layers}}$”得到了解决。\n\n### 第3步：结论与行动\n问题陈述是 **有效的**。这是一个在计算表面科学领域中提问清晰、科学合理的问题。我将继续进行解答。\n\n## 解答推导\n\n任务是根据吸附能的定义、周期性板坯计算中有限尺寸效应误差的物理性质以及标准的收敛实践来评估所提供的选项。\n\n**1. 吸附能的定义**\n吸附能 $E_{\\mathrm{ads}}$ 定义为气相中的分子吸附到表面上时的能量变化。在超胞计算中，其计算公式为组合的吸附物-板坯系统的总能量 $E_{\\mathrm{slab+ads}}$ 减去孤立的洁净板坯的总能量 $E_{\\mathrm{slab}}$ 和孤立的气相分子的总能量 $E_{\\mathrm{adsorbate,gas}}$。为确保系统误差的抵消，所有这三个计算都必须使用相同的超胞尺寸和计算参数（平面波截断能、$k$ 点等）进行。\n$$E_{\\mathrm{ads}} = E_{\\mathrm{slab+ads}} - (E_{\\mathrm{slab}} + E_{\\mathrm{adsorbate,gas}})$$\n\n**2. 有限尺寸效应误差与收敛性分析**\n\n-   **板坯厚度 ($N_{\\mathrm{layers}}$)：** 板坯必须足够厚，以使其两个表面解耦，并在其中心模拟出类体相的电子结构。在金属中，强电子屏蔽导致表面扰动向体相内部的快速（通常是指数形式的）衰减。数据显示，从 $N_{\\mathrm{layers}}=3 \\to 5$，$\\Delta E_{\\mathrm{ads}}$ 为 $-0.058\\,\\mathrm{eV}$；从 $N_{\\mathrm{layers}}=5 \\to 7$，仅为 $-0.008\\,\\mathrm{eV}$。这表明了快速收敛。对于许多应用，增加两层后 $|\\Delta E|  0.01\\,\\mathrm{eV}$ 的收敛标准是常见且合理的。\n\n-   **真空层间距 ($L_z$)：** 问题指定了一个非对称板坯（吸附物在一侧）且没有偶极校正。这种设置在超胞中产生了一个垂直于表面的净偶极矩。由于周期性边界条件下静电相互作用的长程性，这会在超胞中产生一个人为的电场，并导致偶极层的周期性镜像之间发生相互作用。由此产生的总能量误差已知会随着真空尺寸的增加而缓慢衰减，其主导项通常被引述为按 $1/L_z$ 标度。数据与这种缓慢收敛一致：当 $L_z = 12 \\to 18\\,\\text{\\AA}$ 时，$\\Delta E_{\\mathrm{ads}} = -0.038\\,\\mathrm{eV}$；当 $L_z = 18 \\to 24\\,\\text{\\AA}$ 时，$\\Delta E_{\\mathrm{ads}} = -0.005\\,\\mathrm{eV}$。指数衰减在此不适用。每增加 $6\\,\\text{\\AA}$，$|\\Delta E|  0.01\\,\\mathrm{eV}$ 的收敛目标是一个实际的选择。应用偶极校正会大大缓解这个问题，从而可以采用更严格的目标或更小的真空层。\n\n-   **$k$ 点采样：** 对于金属体系，需要一个密集的 $k$ 点网格来精确地对费米能级以下的电子态进行积分。布里渊区上的积分通过网格点上的加权和来近似。通过增加网格密度直到计算的性质（这里是 $E_{\\mathrm{ads}}$）不再显著变化，即可实现收敛。数据显示，从 $4 \\times 4 \\to 6 \\times 6$，$\\Delta E_{\\mathrm{ads}} = -0.026\\,\\mathrm{eV}$；从 $6 \\times 6 \\to 12 \\times 12$，$\\Delta E_{\\mathrm{ads}} = -0.003\\,\\mathrm{eV}$。这证实了需要密集的网格，并表明 $12 \\times 12 \\times 1$ 网格达到了高度的收敛。将线性网格密度加倍后，变化小于几个 meV（例如 $0.005\\,\\mathrm{eV}$）是保证精度的良好标准。\n\n-   **面内胞尺寸 ($m \\times m$)：** 增加面内超胞尺寸会降低覆盖度并减少吸附物与其周期性镜像之间的横向相互作用。对于像 CO 这样在吸附时可能具有显著偶极矩的分子，这些相互作用（例如，偶极-偶极排斥）可能很强，并且通常按距离的幂律（例如 $1/r^3$）衰减。目标通常是近似零覆盖度极限。数据显示，从 $2 \\times 2$ 胞（$\\theta=1/4\\,\\mathrm{ML}$）到 $3 \\times 3$ 胞（$\\theta=1/9\\,\\mathrm{ML}$）有非常大的变化，为 $-0.150\\,\\mathrm{eV}$，表明在较高覆盖度下存在强烈的排斥相互作用。从 $3 \\times 3$ 到 $4 \\times 4$（$\\theta=1/16\\,\\mathrm{ML}$）的变化要小得多，为 $-0.004\\,\\mathrm{eV}$，表明在 $3 \\times 3$ 尺寸下，结果已接近相对于横向相互作用的收敛。变化小于 $0.01\\,\\mathrm{eV}$ 的标准是一个合理的目标。\n\n## 逐项分析选项\n\n**A. 吸附能是组合的吸附物-板坯系统的总能量相对于使用相同数值设置计算的洁净板坯和孤立吸附物能量之和。对于金属板坯，由于电子屏蔽效应，有限板坯厚度误差会随着 $N_{\\mathrm{layers}}$ 的增加而迅速衰减，当增加两层后的变化小于 $0.01\\,\\mathrm{eV}$ 时，可认为误差可以忽略不计。对于无偶极校正的非对称板坯，重复板坯之间的赝静电相互作用主要与 $L_z$ 成反比，因此应增加 $L_z$ 直到每增加 $6\\,\\text{\\AA}$ 吸附能的变化小于 $0.01\\,\\mathrm{eV}$；若使用偶极校正，每 $6\\,\\text{\\AA}$ 采用更严格的 $0.005\\,\\mathrm{eV}$ 标准是合理的。对于金属表面，通过在固定胞尺寸下将线性 $k$ 点密度加倍来诊断 $k$ 点积分误差，并要求变化小于 $0.005\\,\\mathrm{eV}$。面内有限尺寸效应反映了周期性镜像之间的横向相互作用和覆盖度效应；对于具有偶极相互作用的吸附物，这些效应通常随着面内长度的增加而减小，一个实际的目标是 $3 \\times 3$ 和 $4 \\times 4$ 胞之间的变化小于 $0.01\\,\\mathrm{eV}$。**\n-   $E_{\\mathrm{ads}}$ 的定义是正确的。\n-   对金属板坯厚度误差、其来源以及收敛目标的描述都是正确的，并且与数据一致（对于 $5 \\to 7$ 层，$|\\Delta E| = 0.008\\,\\mathrm{eV}  0.01\\,\\mathrm{eV}$）。\n-   对非对称板坯真空误差的诊断（缓慢衰减，$1/L_z$ 标度）是正确的。收敛目标是合理的，并与数据一致（对于 $18 \\to 24\\,\\text{\\AA}$，$|\\Delta E| = 0.005\\,\\mathrm{eV}  0.01\\,\\mathrm{eV}$）。关于偶极校正的评论也是正确的。\n-   测试 $k$ 点收敛的方法和建议的目标是标准的和正确的。数据支持这一点（对于 $6 \\times 6 \\to 12 \\times 12$，$|\\Delta E| = 0.003\\,\\mathrm{eV}  0.005\\,\\mathrm{eV}$）。\n-   对面内胞尺寸效应的分析是正确的，目标是合理的，并且被数据满足（对于 $3 \\times 3 \\to 4 \\times 4$，$|\\Delta E| = 0.004\\,\\mathrm{eV}  0.01\\,\\mathrm{eV}$）。\n-   **结论：正确。**\n\n**B. 吸附能是组合系统总能量相对于仅洁净板坯能量的值。有限板坯厚度误差按 $N_{\\mathrm{layers}}$ 的倒数衰减，而真空层误差无论板坯对称性如何，总是按 $L_z$ 的立方倒数标度；将 $N_{\\mathrm{layers}}$ 增加两层或将 $L_z$ 增加 $6\\,\\text{\\AA}$，变化小于 $0.10\\,\\mathrm{eV}$ 即已足够。对于金属，诊断 $k$ 点误差的最佳方法是减小展宽而不是改变网格。面内相互作用在 $2 \\times 2$ 胞之外可以忽略不计。**\n-   $E_{\\mathrm{ads}}$ 的定义不正确；它忽略了参考气相吸附物的能量。\n-   误差标度关系不正确：金属中的板坯厚度误差呈指数衰减，而不是 $1/N_{\\mathrm{layers}}$；非对称板坯的真空误差衰减比 $1/L_z^3$ 慢得多。\n-   $0.10\\,\\mathrm{eV}$ 的收敛目标对于定量工作来说过于宽松。\n-   关于诊断 $k$ 点误差的说法不正确；展宽和 $k$ 点密度是相关但不同的参数，收敛布里渊区积分需要增加网格密度。\n-   声称面内相互作用在 $2 \\times 2$ 胞之外可忽略不计，与数据直接矛盾，数据显示 $2 \\times 2$ 和 $3 \\times 3$ 胞之间存在 $0.150\\,\\mathrm{eV}$ 的差异。\n-   **结论：错误。**\n\n**C. 吸附能应取为组合系统的总能量减去板坯能量加上孤立吸附物能量，并且只要它们各自收敛，比较使用不同展宽和截断能的计算是可以接受的。真空层误差随 $L_z$ 指数衰减，因此 $12\\,\\text{\\AA}$ 的小真空层总是足够的。对于金属表面，为避免费米面误差，首选 $\\Gamma$ 点采样。通过增加 $k$ 点密度比扩大胞能更好地控制面内相互作用。**\n-   定义的前半部分是正确的，但建议使用不同计算参数的程序是一个重大的方法论缺陷。它使得对于获得准确能量差至关重要的误差抵消失效。\n-   关于真空误差呈指数衰减的说法对于所述的非对称系统是不正确的。数据证实 $12\\,\\text{\\AA}$ 是不足够的。\n-   对金属推荐使用 $\\Gamma$ 点采样是根本错误的。它代表了对费米面最差的采样。\n-   声称 $k$ 点密度控制面内相互作用是错误的；它混淆了两个独立的有限尺寸效应。\n-   **结论：错误。**\n\n**D. 吸附能是组合系统与洁净板坯的总能量之差，孤立吸附物的能量被省略，因为它在覆盖度低时会抵消。如果从 $3$ 层增加到 $5$ 层的变化小于 $0.05\\,\\mathrm{eV}$，则板坯厚度误差可忽略不计。对于非对称板坯，由于金属屏蔽的短程性，真空层误差随 $L_z$ 指数衰减，因此将 $L_z$ 增加到 $18\\,\\text{\\AA}$ 以上是不必要的。对于大的超胞，可以通过仅使用 $\\Gamma$ 点来消除 $k$ 点误差。稳健的收敛应对所有参数要求变化小于 $0.0001\\,\\mathrm{eV}$，无论系统如何。**\n-   $E_{\\mathrm{ads}}$ 的定义不正确。孤立吸附物的能量是参考态，不会抵消。\n-   建议的厚度收敛标准（从 $3 \\to 5$ 层，$|\\Delta E|  0.05\\,\\mathrm{eV}$）过于宽松；数据显示变化为 $-0.058\\,\\mathrm{eV}$，意味着该标准会失败，但原因错误——它不是收敛的良好指标。\n-   关于真空误差呈指数衰减的说法对于非对称板坯是不正确的。\n-   声称 $\\Gamma$ 点采样对于大超胞的金属是足够的，这一说法是不正确的。\n-   建议的 $0.0001\\,\\mathrm{eV}$ 的通用收敛目标对于大多数系统来说过于严格且计算成本过高，使其成为不良的通用建议。\n-   **结论：错误。**", "answer": "$$\\boxed{A}$$", "id": "3432251"}, {"introduction": "虽然独立地收敛每个计算参数至关重要，但吸附能本质上是一个能量*差值*。这通常会带来一个幸运的结果，即在（吸附物+平板）和洁净平板的计算之间发生误差抵消。然而，这是一把双刃剑。本练习 [@problem_id:3432197] 将利用一个精细的误差模型，探讨一种被称为“误导性抵消”的情形，即尽管各个组分的总能量远未收敛，但计算出的吸附能却呈现出收敛的假象。理解并避免这种情况，是获得稳健可靠结果的关键一步。", "problem": "要求您实现一项程序化研究，探讨密度泛函理论（DFT）平板计算中的数值参数如何影响计算出的表面吸附能，并识别表面上的一致性是源于误差抵消而非真正收敛的情况。请从第一性原理出发：Born–Oppenheimer 总电子能量定义了一个构型的能量状态，而吸附能是系统从吸附物与平板分离的初始态，转变为吸附物与平板结合的最终态过程中的总能量变化。请推导吸附能作为物理上明确定义的状态的总能量之差的表达式，然后构建一个算法来评估其相对于数值参数的收敛情况。\n\n模型和单位。考虑三个体系：吸附物结合的平板、洁净平板以及气相中的孤立吸附物，分别用标签“sa”、“slab”和“gas”表示。在理想的无限精度极限下，相应的 Born–Oppenheimer 总能量是固定常数：$E_{\\mathrm{sa}}^{\\mathrm{true}}=-123.456\\,\\mathrm{eV}$，$E_{\\mathrm{slab}}^{\\mathrm{true}}=-120.000\\,\\mathrm{eV}$，以及 $E_{\\mathrm{gas}}^{\\mathrm{true}}=-1.900\\,\\mathrm{eV}$。由于四个可系统控制的数值参数，计算出的总能量会偏离这些真实值：布里渊区采样 $N_k$（无单位）、平面波截断能 $E_{\\mathrm{cut}}$（单位为电子伏特）、平板中的原子层数 $N_{\\mathrm{layers}}$（无单位）和真空层厚度 $d_{\\mathrm{vac}}$（单位为埃）。对于每个标签 $x\\in\\{\\mathrm{sa},\\mathrm{slab},\\mathrm{gas}\\}$，计算得到的能量 $E_x(N_k,E_{\\mathrm{cut}},N_{\\mathrm{layers}},d_{\\mathrm{vac}})$ 被建模为 $E_x^{\\mathrm{true}}$ 加上一系列具有物理动机的误差项之和：\n$$E_x(N_k,E_{\\mathrm{cut}},N_{\\mathrm{layers}},d_{\\mathrm{vac}})=E_x^{\\mathrm{true}}+\\varepsilon_{k}^{(x)}(N_k)+\\varepsilon_{\\mathrm{pw}}^{(x)}(E_{\\mathrm{cut}})+\\varepsilon_{\\mathrm{layers}}^{(x)}(N_{\\mathrm{layers}})+\\varepsilon_{\\mathrm{vac}}^{(x)}(d_{\\mathrm{vac}})+\\varepsilon_{\\times 1}^{(x)}(E_{\\mathrm{cut}},N_{\\mathrm{layers}})+\\varepsilon_{\\times 2}^{(x)}(N_k,N_{\\mathrm{layers}}).$$\n这些误差项体现了经过充分检验的渐进行为：\n- 布里渊区积分误差（光滑函数的积分）：$$\\varepsilon_{k}^{(\\mathrm{sa})}(N_k)=\\frac{A_{k}^{(\\mathrm{sa})}}{N_k^2},\\quad \\varepsilon_{k}^{(\\mathrm{slab})}(N_k)=\\frac{A_{k}^{(\\mathrm{slab})}}{N_k^2},\\quad \\varepsilon_{k}^{(\\mathrm{gas})}(N_k)=\\frac{A_{k}^{(\\mathrm{gas})}}{N_k^2},$$ 其中 $A_{k}^{(\\mathrm{sa})}=3.0\\,\\mathrm{eV}$，$A_{k}^{(\\mathrm{slab})}=2.5\\,\\mathrm{eV}$，以及 $A_{k}^{(\\mathrm{gas})}=0.2\\,\\mathrm{eV}$。\n- 平面波基组截断误差（傅里叶尾部衰减）：$$\\varepsilon_{\\mathrm{pw}}^{(x)}(E_{\\mathrm{cut}})=\\frac{A_{\\mathrm{pw}}^{(x)}}{E_{\\mathrm{cut}}^{3/2}},$$ 其中 $A_{\\mathrm{pw}}^{(\\mathrm{sa})}=200.0\\,\\mathrm{eV}$，$A_{\\mathrm{pw}}^{(\\mathrm{slab})}=180.0\\,\\mathrm{eV}$，以及 $A_{\\mathrm{pw}}^{(\\mathrm{gas})}=10.0\\,\\mathrm{eV}$。\n- 平板厚度有限尺寸效应误差（镜像相互作用和量子限制效应）：$$\\varepsilon_{\\mathrm{layers}}^{(\\mathrm{slab})}(N_{\\mathrm{layers}})=\\frac{A_{\\mathrm{layers}}^{(\\mathrm{slab})}}{N_{\\mathrm{layers}}^2}+B_{\\mathrm{layers}}^{(\\mathrm{slab})}\\exp\\!\\left(-\\frac{N_{\\mathrm{layers}}}{L_{\\mathrm{layers}}^{(\\mathrm{slab})}}\\right),$$ $$\\varepsilon_{\\mathrm{layers}}^{(\\mathrm{sa})}(N_{\\mathrm{layers}})=\\frac{A_{\\mathrm{layers}}^{(\\mathrm{sa})}}{N_{\\mathrm{layers}}^2}+B_{\\mathrm{layers}}^{(\\mathrm{sa})}\\exp\\!\\left(-\\frac{N_{\\mathrm{layers}}}{L_{\\mathrm{layers}}^{(\\mathrm{sa})}}\\right),$$ $$\\varepsilon_{\\mathrm{layers}}^{(\\mathrm{gas})}(N_{\\mathrm{layers}})=0,$$ 其中 $A_{\\mathrm{layers}}^{(\\mathrm{slab})}=0.8\\,\\mathrm{eV}$，$B_{\\mathrm{layers}}^{(\\mathrm{slab})}=0.5\\,\\mathrm{eV}$，$L_{\\mathrm{layers}}^{(\\mathrm{slab})}=2.5$，以及 $A_{\\mathrm{layers}}^{(\\mathrm{sa})}=0.9\\,\\mathrm{eV}$，$B_{\\mathrm{layers}}^{(\\mathrm{sa})}=0.4\\,\\mathrm{eV}$，$L_{\\mathrm{layers}}^{(\\mathrm{sa})}=2.2$。\n- 真空层有限尺寸效应误差（残余偶极相互作用和代数形式的镜像尾部）：$$\\varepsilon_{\\mathrm{vac}}^{(\\mathrm{slab})}(d_{\\mathrm{vac}})=A_{\\mathrm{vac}}^{(\\mathrm{slab})}\\exp\\!\\left(-\\frac{d_{\\mathrm{vac}}}{L_{\\mathrm{vac}}^{(\\mathrm{slab})}}\\right)+\\frac{\\phi^{(\\mathrm{slab})}}{d_{\\mathrm{vac}}^2},$$ $$\\varepsilon_{\\mathrm{vac}}^{(\\mathrm{sa})}(d_{\\mathrm{vac}})=A_{\\mathrm{vac}}^{(\\mathrm{sa})}\\exp\\!\\left(-\\frac{d_{\\mathrm{vac}}}{L_{\\mathrm{vac}}^{(\\mathrm{sa})}}\\right)+\\frac{\\phi^{(\\mathrm{sa})}}{d_{\\mathrm{vac}}^2},$$ $$\\varepsilon_{\\mathrm{vac}}^{(\\mathrm{gas})}(d_{\\mathrm{vac}})=0,$$ 其中 $A_{\\mathrm{vac}}^{(\\mathrm{slab})}=0.35\\,\\mathrm{eV}$，$L_{\\mathrm{vac}}^{(\\mathrm{slab})}=4.0\\,\\text{\\AA}$，$\\phi^{(\\mathrm{slab})}=1.2\\,\\mathrm{eV}\\cdot\\text{\\AA}^2$，以及 $A_{\\mathrm{vac}}^{(\\mathrm{sa})}=0.40\\,\\mathrm{eV}$，$L_{\\mathrm{vac}}^{(\\mathrm{sa})}=3.5\\,\\text{\\AA}$，$\\phi^{(\\mathrm{sa})}=1.0\\,\\mathrm{eV}\\cdot\\text{\\AA}^2$。\n- 捕捉离散化之间耦合的交叉项：$$\\varepsilon_{\\times 1}^{(x)}(E_{\\mathrm{cut}},N_{\\mathrm{layers}})=\\frac{\\kappa^{(x)}}{E_{\\mathrm{cut}}\\,N_{\\mathrm{layers}}},\\qquad \\varepsilon_{\\times 2}^{(x)}(N_k,N_{\\mathrm{layers}})=\\frac{\\mu^{(x)}}{N_k\\,N_{\\mathrm{layers}}},$$ 其中 $\\kappa^{(\\mathrm{sa})}=\\kappa^{(\\mathrm{slab})}=5.0\\,\\mathrm{eV}$，$\\kappa^{(\\mathrm{gas})}=0.5\\,\\mathrm{eV}$，以及 $\\mu^{(\\mathrm{sa})}=\\mu^{(\\mathrm{slab})}=0.6\\,\\mathrm{eV}$，$\\mu^{(\\mathrm{gas})}=0.05\\,\\mathrm{eV}$。\n\n任务。\n1. 从 Born–Oppenheimer 关于总能量是状态函数的概念以及吸附过程是“从分离态到结合态的转变”这一物理定义出发，推导吸附能作为三个总能量 $E_{\\mathrm{sa}}$、$E_{\\mathrm{slab}}$ 和 $E_{\\mathrm{gas}}$ 组合的数学表达式。不要使用简便公式；相反，应从能量守恒以及分离的参考态中非相互作用子系统能量的可加性出发进行论证。\n2. 实现一个算法，对于给定的 $(N_k,E_{\\mathrm{cut}},N_{\\mathrm{layers}},d_{\\mathrm{vac}})$，通过上述模型计算 $E_{\\mathrm{sa}}$、$E_{\\mathrm{slab}}$ 和 $E_{\\mathrm{gas}}$，然后计算吸附能及其与真实吸附能的偏差（真实吸附能使用真实常数定义）。能量必须以电子伏特（eV）表示。\n3. 误差抵消诊断。为表面上收敛的吸附能定义一个阈值 $\\tau_{\\mathrm{ads}}=0.04\\,\\mathrm{eV}$，为显著的组分误差定义一个阈值 $\\tau_{\\mathrm{comp}}=0.10\\,\\mathrm{eV}$。如果吸附能绝对偏差严格小于 $\\tau_{\\mathrm{ads}}$，而组分绝对误差 $\\{|\\varepsilon^{(\\mathrm{sa})}|,|\\varepsilon^{(\\mathrm{slab})}|,|\\varepsilon^{(\\mathrm{gas})}|\\}$ 中至少有两个大于或等于 $\\tau_{\\mathrm{comp}}$，则声明为“误导性抵消”。\n4. 测试套件。使用以下参数集评估您的程序，这些参数集旨在探测不同情况，并返回吸附能值和诊断结果：\n   - 情况 A（良好收敛）：$N_k=24$, $E_{\\mathrm{cut}}=800\\,\\mathrm{eV}$, $N_{\\mathrm{layers}}=10$, $d_{\\mathrm{vac}}=20\\,\\text{\\AA}$。\n   - 情况 B（因抵消而产生的表面一致性）：$N_k=8$, $E_{\\mathrm{cut}}=350\\,\\mathrm{eV}$, $N_{\\mathrm{layers}}=4$, $d_{\\mathrm{vac}}=12\\,\\text{\\AA}$。\n   - 情况 C（受真空层限制，存在抵消）：$N_k=16$, $E_{\\mathrm{cut}}=450\\,\\mathrm{eV}$, $N_{\\mathrm{layers}}=8$, $d_{\\mathrm{vac}}=6\\,\\text{\\AA}$。\n   - 情况 D（严重欠收敛）：$N_k=1$, $E_{\\mathrm{cut}}=250\\,\\mathrm{eV}$, $N_{\\mathrm{layers}}=3$, $d_{\\mathrm{vac}}=8\\,\\text{\\AA}$。\n\n最终输出格式。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个案例的结果本身是一个双元素列表 $[E_{\\mathrm{ads}},\\text{flag}]$。这里 $E_{\\mathrm{ads}}$ 是计算出的吸附能，单位为电子伏特（四舍五入到三位小数），$\\text{flag}$ 是一个布尔值，指示是否检测到误导性抵消。例如，整体形状必须类似于 $[[e_1,b_1],[e_2,b_2],[e_3,b_3],[e_4,b_4]]$。", "solution": "该问题要求推导并实现一个用于密度泛函理论（DFT）中吸附能计算的模型，重点在于识别误导性的误差抵消。解决方案分两个阶段进行：首先，基于原理推导吸附能的表达式；其次，根据提供的误差模型设计一个算法来计算该能量并诊断数值假象。\n\n定义吸附能的基本原理是总能量守恒。在 Born-Oppenheimer 近似的背景下，总能量是系统原子构型的状态函数。吸附过程是从一个初始的非相互作用状态转变为一个最终的相互作用状态。\n\n1.  **初始态**：初始态由一个洁净的固体表面（平板）和一个处于气相的吸附物分子组成。假定这两个组分无限分离，因此不发生相互作用。一个由非相互作用组分构成的系统的总能量是其各组分能量之和。设 $E_{\\mathrm{slab}}$ 为孤立平板的总能量，$E_{\\mathrm{gas}}$ 为孤立气相分子的总能量。那么初始态的总能量 $E_{\\mathrm{initial}}$ 为：\n    $$E_{\\mathrm{initial}} = E_{\\mathrm{slab}} + E_{\\mathrm{gas}}$$\n\n2.  **最终态**：最终态是吸附物与平板表面结合后的单一相互作用系统。设其总能量为 $E_{\\mathrm{sa}}$，它定义了最终态的能量 $E_{\\mathrm{final}}$：\n    $$E_{\\mathrm{final}} = E_{\\mathrm{sa}}$$\n\n3.  **吸附能 ($E_{\\mathrm{ads}}$)**：吸附能是吸附过程中的总能量变化，定义为 $E_{\\mathrm{final}} - E_{\\mathrm{initial}}$。根据表面科学的惯例，负值表示一个释放能量的放热过程。\n    $$E_{\\mathrm{ads}} = E_{\\mathrm{final}} - E_{\\mathrm{initial}} = E_{\\mathrm{sa}} - (E_{\\mathrm{slab}} + E_{\\mathrm{gas}})$$\n    只要对所有三个组分的计算（$E_{\\mathrm{sa}}$、$E_{\\mathrm{slab}}$ 和 $E_{\\mathrm{gas}}$）使用相同的理论水平和数值参数，这个表达式就同时适用于理想的精确能量和使用有限数值精度计算的能量。\n\n真实的吸附能 $E_{\\mathrm{ads}}^{\\mathrm{true}}$ 是根据给定的真实总能量计算得出的：\n$$E_{\\mathrm{ads}}^{\\mathrm{true}} = E_{\\mathrm{sa}}^{\\mathrm{true}} - (E_{\\mathrm{slab}}^{\\mathrm{true}} + E_{\\mathrm{gas}}^{\\mathrm{true}})$$\n$$E_{\\mathrm{ads}}^{\\mathrm{true}} = (-123.456\\,\\mathrm{eV}) - ((-120.000\\,\\mathrm{eV}) + (-1.900\\,\\mathrm{eV})) = -123.456\\,\\mathrm{eV} - (-121.900\\,\\mathrm{eV}) = -1.556\\,\\mathrm{eV}$$\n\n计算得到的吸附能 $E_{\\mathrm{ads}}^{\\mathrm{comp}}$ 是使用数值计算的能量 $E_x(N_k, E_{\\mathrm{cut}}, N_{\\mathrm{layers}}, d_{\\mathrm{vac}})$（其中 $x \\in \\{\\mathrm{sa}, \\mathrm{slab}, \\mathrm{gas}\\}$）计算得出的。计算吸附能的误差为 $\\Delta E_{\\mathrm{ads}} = E_{\\mathrm{ads}}^{\\mathrm{comp}} - E_{\\mathrm{ads}}^{\\mathrm{true}}$。这个误差可以用每个组分的总数值误差 $\\varepsilon^{(x)} = E_{x}^{\\mathrm{comp}} - E_{x}^{\\mathrm{true}}$ 来表示：\n$$\\Delta E_{\\mathrm{ads}} = (E_{\\mathrm{sa}}^{\\mathrm{comp}} - E_{\\mathrm{sa}}^{\\mathrm{true}}) - (E_{\\mathrm{slab}}^{\\mathrm{comp}} - E_{\\mathrm{slab}}^{\\mathrm{true}}) - (E_{\\mathrm{gas}}^{\\mathrm{comp}} - E_{\\mathrm{gas}}^{\\mathrm{true}})$$\n$$\\Delta E_{\\mathrm{ads}} = \\varepsilon^{(\\mathrm{sa})} - \\varepsilon^{(\\mathrm{slab})} - \\varepsilon^{(\\mathrm{gas})}$$\n这个关系表明，即使各组分的误差 $\\varepsilon^{(x)}$ 很大，$\\Delta E_{\\mathrm{ads}}$ 也可能很小，这种现象被称为误差抵消。例如，如果 $\\varepsilon^{(\\mathrm{sa})} \\approx \\varepsilon^{(\\mathrm{slab})}$ 且 $\\varepsilon^{(\\mathrm{gas})}$ 很小，$\\Delta E_{\\mathrm{ads}}$ 将接近于零。“误导性抵消”的诊断就是为了检测这类情况而设计的。\n\n解决该问题的算法如下：\n首先，我们将提供的常数和模型参数进行结构化，以便于访问。然后，对于由一组数值参数 $(N_k, E_{\\mathrm{cut}}, N_{\\mathrm{layers}}, d_{\\mathrm{vac}})$ 定义的每个测试用例：\n1.  对于每个系统 $x \\in \\{\\mathrm{sa}, \\mathrm{slab}, \\mathrm{gas}\\}$，通过将所有六个指定的误差项的贡献相加，计算总数值误差 $\\varepsilon^{(x)}$：\n    $$\\varepsilon^{(x)}(N_k, E_{\\mathrm{cut}}, N_{\\mathrm{layers}}, d_{\\mathrm{vac}}) = \\varepsilon_{k}^{(x)} + \\varepsilon_{\\mathrm{pw}}^{(x)} + \\varepsilon_{\\mathrm{layers}}^{(x)} + \\varepsilon_{\\mathrm{vac}}^{(x)} + \\varepsilon_{\\times 1}^{(x)} + \\varepsilon_{\\times 2}^{(x)}$$\n2.  计算每个系统的计算总能量：$E_x^{\\mathrm{comp}} = E_x^{\\mathrm{true}} + \\varepsilon^{(x)}$。\n3.  计算吸附能：$E_{\\mathrm{ads}}^{\\mathrm{comp}} = E_{\\mathrm{sa}}^{\\mathrm{comp}} - (E_{\\mathrm{slab}}^{\\mathrm{comp}} + E_{\\mathrm{gas}}^{\\mathrm{comp}})$。\n4.  计算吸附能的偏差：$\\Delta E_{\\mathrm{ads}} = E_{\\mathrm{ads}}^{\\mathrm{comp}} - E_{\\mathrm{ads}}^{\\mathrm{true}}$。\n5.  应用误导性抵消诊断：\n    a. 检查吸附能绝对偏差是否低于其阈值：$|\\Delta E_{\\mathrm{ads}}|  \\tau_{\\mathrm{ads}}$，其中 $\\tau_{\\mathrm{ads}} = 0.04\\,\\mathrm{eV}$。\n    b. 统计总绝对误差达到或超过其阈值的组分数量：检查 $|\\varepsilon^{(\\mathrm{sa})}|, |\\varepsilon^{(\\mathrm{slab})}|, |\\varepsilon^{(\\mathrm{gas})}|$ 中有多少个大于或等于 $\\tau_{\\mathrm{comp}}$，其中 $\\tau_{\\mathrm{comp}} = 0.10\\,\\mathrm{eV}$。\n    c. 如果 (a) 中的条件为真，并且 (b) 中的计数为 2 或更多，则将误导性抵消标志设置为 true，否则为 false。\n6.  该测试用例的结果是一个列表，包含四舍五入到三位小数的计算吸附能和布尔类型的抵消标志。汇总所有测试用例的结果，并格式化为最终的输出字符串。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes adsorption energy and diagnoses error cancellation based on a\n    model of DFT convergence behavior.\n    \"\"\"\n\n    # --- Step 1: Define Constants and Models ---\n    \n    # True energies in eV\n    E_true = {\n        'sa': -123.456,\n        'slab': -120.000,\n        'gas': -1.900\n    }\n    \n    # Coefficients for error models\n    # The units provided in the problem for some coefficients are notationally\n    # inconsistent, but the numerical values are interpreted as correct for use\n    # in the given formulas to yield energies in eV.\n    coeffs = {\n        'A_k': {'sa': 3.0, 'slab': 2.5, 'gas': 0.2}, # eV\n        'A_pw': {'sa': 200.0, 'slab': 180.0, 'gas': 10.0}, # eV^(5/2) implied\n        'A_layers': {'sa': 0.9, 'slab': 0.8}, # eV\n        'B_layers': {'sa': 0.4, 'slab': 0.5}, # eV\n        'L_layers': {'sa': 2.2, 'slab': 2.5}, # unitless\n        'A_vac': {'sa': 0.40, 'slab': 0.35}, # eV\n        'L_vac': {'sa': 3.5, 'slab': 4.0}, # Angstrom\n        'phi': {'sa': 1.0, 'slab': 1.2}, # eV * Angstrom^2\n        'kappa': {'sa': 5.0, 'slab': 5.0, 'gas': 0.5}, # eV^2 implied\n        'mu': {'sa': 0.6, 'slab': 0.6, 'gas': 0.05} # eV\n    }\n\n    # --- Step 2: Implement Error Functions ---\n    \n    def get_total_error(label, Nk, Ecut, Nlayers, dvac):\n        \"\"\"Calculates the total numerical error for a given system and parameters.\"\"\"\n        \n        # Brillouin zone integration error\n        err_k = coeffs['A_k'][label] / (Nk**2)\n        \n        # Plane-wave basis truncation error\n        err_pw = coeffs['A_pw'][label] / (Ecut**(3/2))\n        \n        # Slab thickness finite-size error\n        if label in ['sa', 'slab']:\n            err_layers = (coeffs['A_layers'][label] / (Nlayers**2) + \n                         coeffs['B_layers'][label] * np.exp(-Nlayers / coeffs['L_layers'][label]))\n        else: # gas\n            err_layers = 0.0\n        \n        # Vacuum finite-size error\n        if label in ['sa', 'slab']:\n            err_vac = (coeffs['A_vac'][label] * np.exp(-dvac / coeffs['L_vac'][label]) +\n                       coeffs['phi'][label] / (dvac**2))\n        else: # gas\n            err_vac = 0.0\n            \n        # Cross term 1\n        err_x1 = coeffs['kappa'][label] / (Ecut * Nlayers)\n        \n        # Cross term 2\n        err_x2 = coeffs['mu'][label] / (Nk * Nlayers)\n        \n        total_err = err_k + err_pw + err_layers + err_vac + err_x1 + err_x2\n        return total_err\n\n    # --- Step 3: Define Test Cases and Thresholds ---\n    \n    test_cases = [\n        # Case A (well-converged)\n        {'Nk': 24, 'Ecut': 800, 'Nlayers': 10, 'dvac': 20},\n        # Case B (apparent agreement by cancellation)\n        {'Nk': 8, 'Ecut': 350, 'Nlayers': 4, 'dvac': 12},\n        # Case C (vacuum-limited, cancellation present)\n        {'Nk': 16, 'Ecut': 450, 'Nlayers': 8, 'dvac': 6},\n        # Case D (severely under-converged)\n        {'Nk': 1, 'Ecut': 250, 'Nlayers': 3, 'dvac': 8},\n    ]\n\n    tau_ads = 0.04  # eV\n    tau_comp = 0.10 # eV\n\n    # --- Step 4: Main Calculation Loop ---\n    \n    results = []\n    \n    # Calculate true adsorption energy for reference\n    E_ads_true = E_true['sa'] - (E_true['slab'] + E_true['gas'])\n\n    for params in test_cases:\n        # Calculate numerical errors for each component\n        err_sa = get_total_error('sa', **params)\n        err_slab = get_total_error('slab', **params)\n        err_gas = get_total_error('gas', **params)\n        \n        # Calculate computed total energies\n        E_comp_sa = E_true['sa'] + err_sa\n        E_comp_slab = E_true['slab'] + err_slab\n        E_comp_gas = E_true['gas'] + err_gas\n        \n        # Calculate computed adsorption energy\n        E_ads_comp = E_comp_sa - (E_comp_slab + E_comp_gas)\n        \n        # Calculate adsorption energy deviation\n        delta_E_ads = E_ads_comp - E_ads_true\n        \n        # --- Step 5: Apply Error Cancellation Diagnostic ---\n        \n        # Check condition 1: |delta_E_ads|  tau_ads\n        cond1 = abs(delta_E_ads)  tau_ads\n        \n        # Check condition 2: number of large component errors\n        component_errors = [abs(err_sa), abs(err_slab), abs(err_gas)]\n        large_error_count = sum(1 for err in component_errors if err >= tau_comp)\n        cond2 = large_error_count >= 2\n        \n        misleading_cancellation = cond1 and cond2\n        \n        # Store results for this case\n        # Standard round() is sufficient and appropriate here\n        rounded_E_ads = round(E_ads_comp, 3)\n\n        # Format boolean as lowercase true/false as in typical JSON/list outputs\n        # This is a bit ambiguous in the prompt, so using standard Python bool representation.\n        # After re-reading the prompt, it does not specify string or native boolean.\n        # A list of lists containing floats and booleans is a valid python structure.\n        results.append([rounded_E_ads, misleading_cancellation])\n\n    # --- Step 6: Format and Print Final Output ---\n    # The formatting needs to be precise, converting Python list of lists to the specified string format\n    # with lowercase booleans.\n    def format_result(res):\n        e_ads, flag = res\n        # Ensure three decimal places even for round numbers\n        e_ads_str = f\"{e_ads:.3f}\"\n        flag_str = str(flag).lower()\n        return f\"[{e_ads_str},{flag_str}]\"\n\n    output_str = f\"[{','.join(map(format_result, results))}]\"\n    print(output_str)\n\nsolve()\n```", "id": "3432197"}]}