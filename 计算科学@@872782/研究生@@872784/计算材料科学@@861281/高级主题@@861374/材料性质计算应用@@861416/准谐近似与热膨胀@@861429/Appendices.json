{"hands_on_practices": [{"introduction": "第一个实践练习将带领我们探索一个基本的量子效应：零点能。即使在绝对零度，晶体中的原子也并非静止，而是存在着持续的振动。这种零点振动会产生一个“零点压力”，使得晶格的实际平衡体积比仅考虑静态电子能量时的预测值要大。通过这个练习，你将亲手计算这种效应对平衡体积的量化影响，并为理解材料在低温下的热膨胀行为奠定基础。[@problem_id:3483269]", "problem": "考虑一个在准谐近似 (QHA)（Quasi-Harmonic Approximation）框架下建模的晶体固体，其中亥姆霍兹自由能 $F(V,T)$ 写为静态晶格贡献和振动贡献之和。基本基础是亥姆霍兹自由能的热力学定义 $F(V,T)=U(V,T)-T S(V,T)$，在固定温度 $T$ 下，零外压下的平衡定义为使 $F$ 相对于体积 $V$ 最小化的条件，以及用于晶格振动的德拜模型。在德拜模型中，零点能 $E_{\\mathrm{ZP}}(V)$是振动能量在 $T=0$ 时的极限，而零点压定义为 $P_{\\mathrm{ZP}}(V)=-\\partial E_{\\mathrm{ZP}}(V)/\\partial V$。在格林爱森近似中，德拜温度随体积的变化关系为 $\\theta_{\\mathrm{D}}(V)=\\theta_{\\mathrm{D},0}\\left(V/V_{\\mathrm{el},0}\\right)^{-\\gamma}$，其中 $\\gamma$ 是（与体积无关的）格林爱森参数，$V_{\\mathrm{el},0}$ 是忽略振动时 $T=0$ 下的静态晶格平衡体积。\n\n您需要实现一个计算程序，该程序：\n- 从第一性原理出发，通过求解平衡条件 $\\partial F(V,0)/\\partial V=0$（其中 $F(V,0)=E_{\\mathrm{el}}(V)+E_{\\mathrm{ZP}}(V)$），推导零点压对 $T=0$ 时平衡体积 $V_0$ 的影响，其中静态晶格能量 $E_{\\mathrm{el}}(V)$ 在 $V_{\\mathrm{el},0}$ 附近用与体弹性模量一致的二次形式近似。\n- 基于 QHA 和德拜低温渐近行为，确定体热膨胀 $\\alpha(T)$ 在 $T\\to 0$ 时的低温主导系数。具体来说，定义一个系数 $A$，使得当 $T\\to 0$ 时，$\\alpha(T)\\sim A\\,T^3$；在零点重整化后的 $V_0$ 处计算 $A$。\n\n要使用的模型假设和数据：\n1. 静态晶格能量在其最小值附近近似为 $E_{\\mathrm{el}}(V)\\approx E_{\\mathrm{ref}}+\\dfrac{K_0}{2 V_{\\mathrm{el},0}}\\left(V-V_{\\mathrm{el},0}\\right)^2$，并以电子伏特每原子为单位进行评估，其中 $K_0$ 是 $T=0$ 时的等温体弹性模量（在所考虑的狭窄体积范围内假定为常数）。为确保单位一致性，请使用转换因子 $c_{\\mathrm{PV}\\to E}=$ $0.006241509074$ 电子伏特每原子每 $(\\mathrm{GPa}\\cdot\\text{\\AA}^3)$，这样，以 $(\\mathrm{GPa}\\cdot\\text{\\AA}^3)$ 为单位的压力-体积积乘以 $c_{\\mathrm{PV}\\to E}$ 即可转换为以电子伏特每原子为单位。\n2. 德拜模型中每原子的零点能为 $E_{\\mathrm{ZP}}(V)=\\dfrac{9}{8} k_{\\mathrm{B}}\\,\\theta_{\\mathrm{D}}(V)$，其中 $k_{\\mathrm{B}}=$ $8.617333262\\times 10^{-5}$ 电子伏特每开尔文。\n3. 格林爱森参数 $\\gamma$ 被视为与体积无关，德拜温度的变化关系为 $\\theta_{\\mathrm{D}}(V)=\\theta_{\\mathrm{D},0}\\left(V/V_{\\mathrm{el},0}\\right)^{-\\gamma}$。\n4. 在 $T\\to 0$ 时，德拜模型中定容比热的主导低温行为是 $C_V(T)\\sim \\dfrac{12\\pi^4}{5}\\,k_{\\mathrm{B}}\\left(\\dfrac{T}{\\theta_{\\mathrm{D}}(V)}\\right)^3$ 每原子。\n\n对于每组参数，您的程序必须执行以下步骤：\n- 使用上述指定的能量形式，通过求解 $\\partial E_{\\mathrm{el}}(V)/\\partial V+\\partial E_{\\mathrm{ZP}}(V)/\\partial V=0$ 来计算 $T=0$ 时的平衡体积 $V_0$，确保单位一致性。以每原子为单位进行计算，其中 $V$ 的单位是 $\\text{\\AA}^3$ 每原子，$E$ 的单位是电子伏特每原子，压力的单位是电子伏特每原子每 $\\text{\\AA}^3$。\n- 计算由 $T=0$ 时的零点压引起的分数体积变化 $\\Delta V/V_{\\mathrm{el},0}=\\left(V_0-V_{\\mathrm{el},0}\\right)/V_{\\mathrm{el},0}$。\n- 推导并计算低温系数 $A$，使得当 $T\\to 0$ 时，$\\alpha(T)\\sim A\\,T^3$，以 $\\mathrm{K}^{-4}$ 为单位表示。使用 QHA 中热膨胀与热力学导数之间的关系，以及德拜低温渐近行为，在零点重整化后的 $V_0$ 和相应的 $\\theta_{\\mathrm{D}}(V_0)$ 处进行评估，并将进入系数的等温体弹性模量取为 $K_0$（单位 GPa），通过 $K_0 V_0 c_{\\mathrm{PV}\\to E}$ 进行适当转换以保持单位为电子伏特每原子。\n\n物理单位和输出要求：\n- 体积必须以 $\\text{\\AA}^3$ 每原子为单位。\n- 系数 $A$ 必须以 $\\mathrm{K}^{-4}$ 为单位报告。\n- 分数变化 $\\Delta V/V_{\\mathrm{el},0}$ 是无量纲的，应以小数形式报告。\n- 将 $\\Delta V/V_{\\mathrm{el},0}$ 四舍五入到 $6$ 位小数，$V_0$ 四舍五入到 $6$ 位小数，以及 $A$ 四舍五入到 $12$ 位小数。\n- 您的程序应生成单行输出，其中包含结果，格式为方括号括起来的逗号分隔列表，其中每个测试用例对应一个形如 $[\\Delta V/V_{\\mathrm{el},0},V_0,A]$ 的子列表，不含空格（例如：$[[0.001234,5.123456,1.234567890123e-12],[...]]$）。\n\n测试套件：\n使用以下四组参数，涵盖与轻元素和边界情况相关的不同区间；所有值均为每原子值：\n- 情况 $1$（理想路径，类轻元素）：$\\theta_{\\mathrm{D},0}=$ $1000$ $\\mathrm{K}$，$\\gamma=$ $1.2$， $K_0=$ $70$ $\\mathrm{GPa}$，$V_{\\mathrm{el},0}=$ $5.0$ $\\text{\\AA}^3$。\n- 情况 $2$（类重元素）：$\\theta_{\\mathrm{D},0}=$ $200$ $\\mathrm{K}$，$\\gamma=$ $1.5$，$K_0=$ $150$ $\\mathrm{GPa}$，$V_{\\mathrm{el},0}=$ $15.0$ $\\text{\\AA}^3$。\n- 情况 $3$（边界条件 $\\gamma\\to 0$）：$\\theta_{\\mathrm{D},0}=$ $600$ $\\mathrm{K}$，$\\gamma=$ $0.05$，$K_0=$ $100$ $\\mathrm{GPa}$，$V_{\\mathrm{el},0}=$ $10.0$ $\\text{\\AA}^3$。\n- 情况 $4$（非常硬，非常高的德拜温度）：$\\theta_{\\mathrm{D},0}=$ $1200$ $\\mathrm{K}$，$\\gamma=$ $1.2$，$K_0=$ $300$ $\\mathrm{GPa}$，$V_{\\mathrm{el},0}=$ $5.0$ $\\text{\\AA}^3$。\n\n您的程序必须为每种情况数值求解平衡方程以得到 $V_0$，计算所要求的量，并以上述指定的确切格式打印结果。", "solution": "该问题要求推导并实现一个计算程序，用于在准谐近似 (QHA) 框架内分析零点能对晶体固体平衡体积和低温热膨胀的影响。推导过程根据问题陈述中的第一性原理进行。\n\n### 第一部分：T=0 时平衡体积的推导\n\n晶体在零温（$T=0$）和零外压下的平衡态由单位原子的总能量 $E(V)$ 相对于单位原子的体积 $V$ 的最小值确定。总能量是静态晶格电子能量 $E_{\\mathrm{el}}(V)$ 和振动零点能 $E_{\\mathrm{ZP}}(V)$ 之和：\n$$\nF(V, T=0) = E(V) = E_{\\mathrm{el}}(V) + E_{\\mathrm{ZP}}(V)\n$$\n平衡条件是总压力 $P_{\\mathrm{tot}} = - \\partial E(V) / \\partial V$ 为零。这意味着：\n$$\n\\frac{\\partial E(V)}{\\partial V} = \\frac{\\partial E_{\\mathrm{el}}(V)}{\\partial V} + \\frac{\\partial E_{\\mathrm{ZP}}(V)}{\\partial V} = 0\n$$\n该方程可以表示为静态晶格压力 $P_{\\mathrm{el}}(V) = -\\partial E_{\\mathrm{el}}/\\partial V$ 和零点压力 $P_{\\mathrm{ZP}}(V) = -\\partial E_{\\mathrm{ZP}}/\\partial V$ 之间的平衡：\n$$\nP_{\\mathrm{el}}(V) + P_{\\mathrm{ZP}}(V) = 0\n$$\n我们基于所提供的模型推导这两个压力分量的表达式。\n\n**1. 静态晶格压力，$P_{\\mathrm{el}}(V)$**\n静态晶格能量由其在 $V_{\\mathrm{el},0}$ 处的最小值附近的二次近似给出：\n$$\nE_{\\mathrm{el}}(V) \\approx E_{\\mathrm{ref}} + \\frac{K_0}{2 V_{\\mathrm{el},0}} (V-V_{\\mathrm{el},0})^2\n$$\n为保证单位一致性，当能量单位为电子伏特 (eV)，体积单位为立方埃 ($\\text{\\AA}^3$)，体弹性模量 $K_0$ 单位为吉帕斯卡 (GPa) 时，能量表达式必须包含转换因子 $c_{\\mathrm{PV}\\to E} = 0.006241509074 \\, \\text{eV}/(\\text{GPa}\\cdot\\text{\\AA}^3)$。$K_0 \\cdot \\text{volume}$ 项的单位是 GPa$\\cdot\\text{\\AA}^3$，这是一个压力-体积积。所提供的能量表达式的单位是 $\\text{GPa} \\cdot \\text{\\AA}^3$。要将其转换为 eV/原子，我们必须乘以 $c_{\\mathrm{PV}\\to E}$:\n$$\nE_{\\mathrm{el}}(V) = E_{\\mathrm{ref}} + \\frac{K_0 c_{\\mathrm{PV}\\to E}}{2 V_{\\mathrm{el},0}} (V-V_{\\mathrm{el},0})^2\n$$\n静态晶格压力是该能量对体积的负导数：\n$$\nP_{\\mathrm{el}}(V) = -\\frac{\\partial E_{\\mathrm{el}}}{\\partial V} = -\\frac{K_0 c_{\\mathrm{PV}\\to E}}{V_{\\mathrm{el},0}}(V-V_{\\mathrm{el},0})\n$$\n该压力的单位是 $\\text{eV}/\\text{\\AA}^3$。\n\n**2. 零点压力，$P_{\\mathrm{ZP}}(V)$**\n德拜模型中每原子的零点能由下式给出：\n$$\nE_{\\mathrm{ZP}}(V) = \\frac{9}{8} k_{\\mathrm{B}} \\theta_{\\mathrm{D}}(V)\n$$\n其中 $k_{\\mathrm{B}}$ 是玻尔兹曼常数，$\\theta_{\\mathrm{D}}(V)$ 是依赖于体积的德拜温度。使用格林爱森近似，$\\theta_{\\mathrm{D}}(V)$ 由下式给出：\n$$\n\\theta_{\\mathrm{D}}(V) = \\theta_{\\mathrm{D},0} \\left(\\frac{V}{V_{\\mathrm{el},0}}\\right)^{-\\gamma}\n$$\n其中 $\\gamma$ 是格林爱森参数。将此代入能量表达式中：\n$$\nE_{\\mathrm{ZP}}(V) = \\frac{9}{8} k_{\\mathrm{B}} \\theta_{\\mathrm{D},0} \\left(\\frac{V}{V_{\\mathrm{el},0}}\\right)^{-\\gamma} = \\frac{9}{8} k_{\\mathrm{B}} \\theta_{\\mathrm{D},0} V_{\\mathrm{el},0}^{\\gamma} V^{-\\gamma}\n$$\n零点压力则为：\n$$\nP_{\\mathrm{ZP}}(V) = -\\frac{\\partial E_{\\mathrm{ZP}}}{\\partial V} = -\\frac{9}{8} k_{\\mathrm{B}} \\theta_{\\mathrm{D},0} V_{\\mathrm{el},0}^{\\gamma} \\frac{d}{dV}(V^{-\\gamma}) = -\\frac{9}{8} k_{\\mathrm{B}} \\theta_{\\mathrm{D},0} V_{\\mathrm{el},0}^{\\gamma} (-\\gamma V^{-\\gamma-1})\n$$\n$$\nP_{\\mathrm{ZP}}(V) = \\frac{9 \\gamma k_{\\mathrm{B}} \\theta_{\\mathrm{D},0} V_{\\mathrm{el},0}^{\\gamma}}{8} V^{-\\gamma-1}\n$$\n该表达式也可以简洁地写为 $P_{\\mathrm{ZP}}(V) = \\gamma E_{\\mathrm{ZP}}(V) / V$。\n\n**3. $V_0$ 的平衡方程**\n$T=0$ 时的平衡体积，记作 $V_0$，是 $P_{\\mathrm{el}}(V_0) + P_{\\mathrm{ZP}}(V_0) = 0$ 的解：\n$$\n-\\frac{K_0 c_{\\mathrm{PV}\\to E}}{V_{\\mathrm{el},0}}(V_0-V_{\\mathrm{el},0}) + \\frac{9 \\gamma k_{\\mathrm{B}} \\theta_{\\mathrm{D},0} V_{\\mathrm{el},0}^{\\gamma}}{8} V_0^{-\\gamma-1} = 0\n$$\n这是一个关于 $V_0$ 的非线性方程，必须进行数值求解。对于 $\\gamma0$，零点压力项通常为正，这会抵消 $V  V_{\\mathrm{el},0}$ 时的负静态压力，从而导致平衡体积 $V_0  V_{\\mathrm{el},0}$。\n\n### 第二部分：低温热膨胀系数的推导\n\n体热膨胀系数 $\\alpha(T)$ 定义为 $\\alpha(T) = \\frac{1}{V} \\left( \\frac{\\partial V}{\\partial T} \\right)_P$。使用标准的麦克斯韦关系和热力学恒等式，它可以表示为：\n$$\n\\alpha(T) = \\frac{1}{K_T} \\left( \\frac{\\partial S}{\\partial V} \\right)_T\n$$\n其中 $K_T = -V(\\partial P/\\partial V)_T$ 是等温体弹性模量，$S$ 是熵。在 QHA 中，振动熵 $S(V,T)$ 仅通过声子频率的标度（由 $\\theta_{\\mathrm{D}}(V)$ 概括）依赖于体积。这种依赖关系导致了以下通用关系：\n$$\n\\left( \\frac{\\partial S}{\\partial V} \\right)_T = \\frac{\\gamma C_V}{V}\n$$\n其中 $C_V = T(\\partial S/\\partial T)_V$ 是定容热容。将此代入 $\\alpha(T)$ 的表达式，得到格林爱森状态方程：\n$$\n\\alpha(T) = \\frac{\\gamma C_V(V,T)}{V K_T(V,T)}\n$$\n我们关心的是低温极限（$T \\to 0$）。在此极限下，德拜模型给出了每原子热容的渐近行为：\n$$\nC_V(T) \\sim \\frac{12\\pi^4}{5} k_{\\mathrm{B}} \\left( \\frac{T}{\\theta_{\\mathrm{D}}(V)} \\right)^3\n$$\n将此代入 $\\alpha(T)$ 的表达式，并在零点重整化体积 $V_0$ 和相应的零温体弹性模量 $K_0$ 处进行计算：\n$$\n\\alpha(T) \\sim \\frac{\\gamma}{V_0 K_0} \\left[ \\frac{12\\pi^4}{5} k_{\\mathrm{B}} \\left( \\frac{T}{\\theta_{\\mathrm{D}}(V_0)} \\right)^3 \\right] = \\left[ \\frac{\\gamma}{V_0 K_0} \\frac{12\\pi^4 k_{\\mathrm{B}}}{5 \\, \\theta_{\\mathrm{D}}(V_0)^3} \\right] T^3\n$$\n问题指定 $\\alpha(T) \\sim A T^3$。通过比较，系数 $A$ 为：\n$$\nA = \\frac{\\gamma}{V_0 K_0} \\frac{12\\pi^4 k_{\\mathrm{B}}}{5 \\, \\theta_{\\mathrm{D}}(V_0)^3}\n$$\n为确保 $A$ 的单位为正确的 $\\text{K}^{-4}$，分母项 $V_0 K_0$（其单位为能量）必须以 eV 表示。按照指示，这通过将其计算为 $K_0 V_0 c_{\\mathrm{PV}\\to E}$ 来实现，其中 $K_0$ 的单位是 GPa，$V_0$ 的单位是 $\\text{\\AA}^3$。\n$$\nA = \\frac{\\gamma}{K_0 V_0 c_{\\mathrm{PV}\\to E}} \\frac{12\\pi^4 k_{\\mathrm{B}}}{5 \\, \\theta_{\\mathrm{D}}(V_0)^3}\n$$\n在此表达式中，$\\theta_{\\mathrm{D}}(V_0)$ 是在先前计算出的平衡体积 $V_0$ 处评估的德拜温度：\n$$\n\\theta_{\\mathrm{D}}(V_0) = \\theta_{\\mathrm{D},0} \\left(\\frac{V_0}{V_{\\mathrm{el},0}}\\right)^{-\\gamma}\n$$\n计算程序将首先数值求解 $V_0$，然后将其代入推导出的 $A$ 的公式中。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import optimize\n\ndef solve():\n    \"\"\"\n    Solves the quasiharmonic approximation problem for several test cases.\n    \"\"\"\n    # Define physical constants\n    k_B = 8.617333262e-5  # Boltzmann constant in eV/K\n    c_PV_to_E = 0.006241509074  # Conversion factor from GPa*A^3 to eV\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (theta_D_0 [K], gamma, K0 [GPa], V_el_0 [A^3/atom])\n        (1000.0, 1.2, 70.0, 5.0),   # Case 1\n        (200.0, 1.5, 150.0, 15.0),  # Case 2\n        (600.0, 0.05, 100.0, 10.0), # Case 3\n        (1200.0, 1.2, 300.0, 5.0),  # Case 4\n    ]\n\n    results = []\n    for params in test_cases:\n        theta_D_0, gamma, K0, V_el_0 = params\n\n        # Part 1: Compute the T=0 equilibrium volume V0\n        \n        # Define the function whose root we need to find.\n        # This function represents P_el(V) + P_zp(V) = 0\n        def total_pressure_equation(V):\n            # Static lattice pressure in eV/A^3\n            P_el = - (K0 * c_PV_to_E / V_el_0) * (V - V_el_0)\n\n            # Zero-point pressure in eV/A^3\n            if gamma == 0:\n                P_zp = 0.0\n            else:\n                # P_zp = gamma * E_zp / V\n                # E_zp = (9/8) * k_B * theta_D_0 * (V / V_el_0)^(-gamma)\n                P_zp_term1 = 9.0 / 8.0 * k_B * theta_D_0 * gamma\n                P_zp_term2 = (V / V_el_0)**(-gamma)\n                P_zp = P_zp_term1 * P_zp_term2 / V\n                \n                # Alternate formulation from derivation:\n                P_zp_alt = (9.0 * gamma * k_B * theta_D_0 * (V_el_0**gamma)) / (8.0 * V**(gamma + 1.0))\n                # Using the alternate formulation to avoid V/V issues numerically\n                # and to be explicit.\n                P_zp = P_zp_alt\n\n\n            return P_el + P_zp\n\n        # The root must be slightly larger than V_el_0 for gamma  0.\n        # For gamma=0, V0 = V_el_0.\n        # We need a safe bracket for the root finder.\n        # At V=V_el_0, the function is negative (or zero if gamma=0).\n        # We need an upper bound where the function is positive.\n        v_low = V_el_0\n        v_high = V_el_0 * 1.5  # A large, safe upper bound\n\n        # Handle the edge case of gamma = 0, where V0 = V_el_0.\n        if gamma == 0.0:\n            V0 = V_el_0\n        else:\n            # Solve for V0 numerically\n            sol = optimize.root_scalar(total_pressure_equation, bracket=[v_low, v_high], method='brentq')\n            V0 = sol.root\n\n        # Part 2: Compute fractional volume change\n        dV_V = (V0 - V_el_0) / V_el_0\n\n        # Part 3: Compute low-temperature thermal expansion coefficient A\n\n        # Debye temperature at the new equilibrium volume V0\n        theta_D_V0 = theta_D_0 * (V0 / V_el_0)**(-gamma)\n        \n        # Denominator term K*V in units of eV\n        K_V_energy = K0 * V0 * c_PV_to_E\n\n        if gamma == 0.0 or K_V_energy == 0.0:\n            # If gamma is zero, thermal expansion is zero.\n            A = 0.0\n        else:\n            # Numerator constant part\n            num_consts = 12.0 * (np.pi**4) * k_B / 5.0\n            \n            # Combine to calculate A\n            A = (gamma / K_V_energy) * (num_consts / (theta_D_V0**3))\n\n        # Store the formatted results for this case.\n        # Rounding/formatting is done here as per output requirements.\n        sublist = [\n            f\"{dV_V:.6f}\",\n            f\"{V0:.6f}\",\n            f\"{A:.12e}\"\n        ]\n        results.append(f\"[{','.join(sublist)}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3483269"}, {"introduction": "在上一个练习的基础上，我们现在将从一个简化的模型走向更接近真实的物理图像。虽然使用一个单一的、平均的格林爱森参数（$\\bar{\\gamma}$）在计算上很方便，但这往往是一个强近似。实际上，不同的振动模式与晶格体积的耦合方式各不相同，导致了模式格林爱森参数（$\\gamma_{i}$）存在一个分布。本练习将通过构建具有不同 $\\gamma_{i}$ 分布的人工材料，让你亲手量化这一常见简化所带来的误差，从而提升你对模型近似的批判性评估能力。[@problem_id:3483228]", "problem": "您的任务是设计并实现一个完整、可运行的程序，用以评估在计算材料科学中，准谐波近似（Quasi-Harmonic Approximation, QHA）理论下，单模Grüneisen参数近似法在计算热膨胀时的失效情形。目标是证明，当模式Grüneisen参数分布较宽时，使用单一平均Grüneisen参数预测体积热膨胀系数会导致显著误差。\n\n起点与基本原理：\n- 考虑一个晶体固体，其被建模为一组在固定体积下的非相互作用的量子谐振子。声子的亥姆霍兹自由能由下式给出：\n$$F_{\\mathrm{ph}}(V,T) = \\sum_{i} \\left( \\frac{1}{2}\\hbar \\omega_{i}(V) + k_{\\mathrm{B}} T \\ln\\left(1 - e^{-\\hbar \\omega_{i}(V)/(k_{\\mathrm{B}} T)}\\right) \\right),$$\n其中 $V$ 是体积，$T$ 是温度，$\\hbar$ 是约化普朗克常数，$k_{\\mathrm{B}}$ 是玻尔兹曼常数，$\\omega_{i}(V)$ 是振动模式频率，在准谐波近似（QHA）中，它依赖于体积 $V$。\n- 热压定义为 $$P_{\\mathrm{th}}(V,T) = -\\left(\\frac{\\partial F_{\\mathrm{ph}}}{\\partial V}\\right)_{T}.$$\n- 等温体模量 $B_{T}$ 在参考体积 $V_{0}$ 处定义为 $$B_{T} = -V \\left( \\frac{\\partial P}{\\partial V} \\right)_{T},$$ 并在本问题中被视为常数。\n- 模式Grüneisen参数定义为 $$\\gamma_{i}(V) = - \\frac{V}{\\omega_{i}(V)} \\left( \\frac{\\partial \\omega_{i}}{\\partial V} \\right)_{T}.$$\n- 体积热膨胀系数定义为 $$\\alpha(T) = \\frac{1}{V} \\left( \\frac{\\partial V}{\\partial T} \\right)_{P}.$$\n- 单一$\\bar{\\gamma}$近似法使用一个恒定的平均值 $\\bar{\\gamma}$ 来代替完整的分布 $\\{\\gamma_{i}\\}$，以估算 $\\alpha(T)$。\n\n要求：\n1. 从给定的基本定义和QHA框架出发，推导出一个在固定体积 $V_{0}$ 下，用声子谱和模式Grüneisen参数表示的体积热膨胀系数 $\\alpha(T)$ 的可计算表达式，并用代码实现。\n2. 构建单一$\\bar{\\gamma}$近似法，将 $\\bar{\\gamma}$ 定义为在参考温度 $T_{\\mathrm{ref}}$ 下，由热容加权的 $\\gamma_{i}$ 的平均值，并使其在所有温度下保持恒定，然后实现相应的近似 $\\alpha(T)$。\n3. 通过计算每个温度 $T$ 下的相对误差来量化单一$\\bar{\\gamma}$近似法的误差，公式为 $$\\mathrm{err}(T) = \\frac{|\\alpha_{\\mathrm{full}}(T) - \\alpha_{\\mathrm{single}}(T)|}{|\\alpha_{\\mathrm{full}}(T)|}.$$\n4. 使用在 $T_{\\mathrm{ref}}$ 下由热容加权的 $\\gamma_{i}$ 标准差来展示 $\\gamma_{i}$ 分布的宽度，其中权重 $w_{i}(T_{\\mathrm{ref}})$ 与模式热容 $c_{V,i}(T_{\\mathrm{ref}})$ 成正比，并报告此标准差。\n\n实现细节：\n- 使用爱因斯坦振子表达式计算定容模式热容（在固定体积下），\n$$c_{V,i}(T) = k_{\\mathrm{B}} \\frac{x_{i}(T)^{2} e^{x_{i}(T)}}{(e^{x_{i}(T)} - 1)^{2}}, \\quad x_{i}(T) = \\frac{\\hbar \\omega_{i}(V_{0})}{k_{\\mathrm{B}} T}.$$\n- 使用以下常数：$\\hbar = 1.054571817 \\times 10^{-34}$ $\\mathrm{J \\cdot s}$，$k_{\\mathrm{B}} = 1.380649 \\times 10^{-23}$ $\\mathrm{J/K}$，$B_{T} = 1.0 \\times 10^{11}$ $\\mathrm{Pa}$，以及 $V_{0} = 1.0 \\times 10^{-28}$ $\\mathrm{m^{3}}$。\n- 频率以太赫兹（terahertz）为单位给出，必须使用 $\\omega = 2\\pi f$（其中 $f$ 的单位是赫兹）将其转换为角频率（单位为弧度/秒）。\n- 温度单位为开尔文（kelvin）。\n\n测试套件：\n评估以下三种合成材料。这些材料在科学上是合理的，旨在测试 $\\gamma_{i}$ 的宽分布、窄分布以及模式权重的温度依赖性。\n\n- 材料1（双峰 $\\gamma_{i}$ 分布；低频为负 $\\gamma_{i}$，高频为正 $\\gamma_{i}$）：\n  - 频率（太赫兹）：$[2.0, 2.5, 3.0, 1.5, 1.2, 0.8, 10.0, 12.0, 15.0, 18.0, 11.0, 13.0, 16.0, 20.0]$。\n  - 模式Grüneisen参数：$[-1.2, -1.1, -1.0, -0.8, -0.6, -0.5, 2.5, 2.6, 2.4, 2.7, 2.3, 2.8, 2.5, 2.6]$。\n\n- 材料2（$\\gamma_{i}$ 集中在低频模式的重尾分布）：\n  - 频率（太赫兹）：$[0.7, 0.9, 1.0, 1.5, 2.0, 3.0, 5.0, 8.0, 12.0, 15.0, 18.0, 20.0]$。\n  - 模式Grüneisen参数：$[5.0, 4.5, 4.0, 3.0, 2.0, 1.5, 1.2, 1.1, 1.0, 0.9, 0.8, 0.7]$。\n\n- 材料3（窄 $\\gamma_{i}$ 分布）：\n  - 频率（太赫兹）：$[2.0, 3.0, 4.0, 6.0, 8.0, 10.0, 12.0, 14.0]$。\n  - 模式Grüneisen参数：$[1.5, 1.6, 1.4, 1.5, 1.5, 1.6, 1.4, 1.5]$。\n\n待评估的温度：\n- $T$ 值：$[50, 300, 800]$ $\\mathrm{K}$。\n- 参考温度：$T_{\\mathrm{ref}} = 300$ $\\mathrm{K}$。\n\n输出规格：\n- 对每种材料，计算：\n  - 在 $T_{\\mathrm{ref}}$ 下，由热容加权的 $\\gamma_{i}$ 标准差（无量纲）。\n  - 在 $T = 50$ $\\mathrm{K}$，$300$ $\\mathrm{K}$ 和 $800$ $\\mathrm{K}$ 下的相对误差 $\\mathrm{err}(T)$（无量纲）。\n- 您的程序应生成单行输出，包含一个由逗号分隔的列表，该列表被方括号包围。其中，每种材料由一个包含四个浮点数的列表表示，顺序为 $[\\mathrm{std}_{\\gamma}(T_{\\mathrm{ref}}), \\mathrm{err}(50\\,\\mathrm{K}), \\mathrm{err}(300\\,\\mathrm{K}), \\mathrm{err}(800\\,\\mathrm{K})]$。例如，输出格式为\n$$[[a_{1},b_{1},c_{1},d_{1}],[a_{2},b_{2},c_{2},d_{2}],[a_{3},b_{3},c_{3},d_{3}]],$$\n打印的字符串中任何地方都不能有空格。\n所有报告的量均为无量纲，且必须表示为十进制浮点数。", "solution": "所提供的问题经评估，是科学上合理、定义明确、客观且完整的。它提出了一个在计算材料科学领域内，基于准谐波近似（QHA）基本原理的标准而深刻的数值实验。所有提供的定义、常数和数据都是一致且物理上合理的。该任务要求推导并实现一个模型，以展示一种常用近似方法的关键局限性，这构成了一项有效的科学探究。因此，提供完整的解决方案是合理的。\n\n该解决方案分为四个主要部分：\n1. 在QHA框架内推导精确的体积热膨胀系数 $\\alpha_{\\mathrm{full}}(T)$。\n2. 构建单平均Grüneisen参数近似法 $\\alpha_{\\mathrm{single}}(T)$。\n3. 定义用于量化模式Grüneisen参数分布宽度和近似误差的度量指标。\n4. 描述实现计算的算法。\n\n在整个推导过程中，每个数学实体都按照指定的强制格式规则使用LaTeX排版。\n\n问题要求分析体积热膨胀系数 $\\alpha(T)$，其定义为：\n$$\n\\alpha(T) = \\frac{1}{V} \\left( \\frac{\\partial V}{\\partial T} \\right)_{P}\n$$\n其中 $V$ 是体积，$T$ 是温度，$P$ 是压力。\n\n**1. 精确体积热膨胀系数 $\\alpha_{\\mathrm{full}}(T)$ 的推导**\n\n为了推导 $\\alpha(T)$ 的可计算表达式，我们使用一个由三元乘积法则导出的热力学恒等式：\n$$\n\\left( \\frac{\\partial V}{\\partial T} \\right)_{P} \\left( \\frac{\\partial T}{\\partial P} \\right)_{V} \\left( \\frac{\\partial P}{\\partial V} \\right)_{T} = -1\n$$\n重新排列以求解 $\\alpha(T)$ 定义中的项：\n$$\n\\left( \\frac{\\partial V}{\\partial T} \\right)_{P} = - \\left( \\frac{\\partial V}{\\partial P} \\right)_{T} \\left( \\frac{\\partial P}{\\partial T} \\right)_{V}\n$$\n将此式代入 $\\alpha(T)$ 的定义，得到：\n$$\n\\alpha(T) = \\frac{1}{V} \\left[ - \\left( \\frac{\\partial V}{\\partial P} \\right)_{T} \\left( \\frac{\\partial P}{\\partial T} \\right)_{V} \\right]\n$$\n我们识别此表达式中的各项。等温体模量 $B_T$ 定义为 $B_T = -V (\\frac{\\partial P}{\\partial V})_T$。其倒数给我们 $-\\left(\\frac{\\partial V}{\\partial P}\\right)_T = \\frac{V}{B_T}$。总压力 $P$ 是 $0$ K时的静态压力与声子引起的热压之和，$P(V,T) = P_{0\\mathrm{K}}(V) + P_{\\mathrm{th}}(V,T)$。由于 $P_{0\\mathrm{K}}$ 不依赖于 $T$，我们有 $(\\frac{\\partial P}{\\partial T})_V = (\\frac{\\partial P_{\\mathrm{th}}}{\\partial T})_V$。\n将这些代入 $\\alpha(T)$ 的方程，得到著名的Grüneisen关系式：\n$$\n\\alpha(T) = \\frac{1}{V} \\left[ \\frac{V}{B_T} \\left( \\frac{\\partial P_{\\mathrm{th}}}{\\partial T} \\right)_{V} \\right] = \\frac{1}{B_T} \\left( \\frac{\\partial P_{\\mathrm{th}}}{\\partial T} \\right)_{V}\n$$\n接下来，我们从声子亥姆霍兹自由能 $F_{\\mathrm{ph}}$ 推导热压 $P_{\\mathrm{th}}(V,T)$ 的表达式：\n$$\nF_{\\mathrm{ph}}(V,T) = \\sum_{i} \\left( \\frac{1}{2}\\hbar \\omega_{i}(V) + k_{\\mathrm{B}} T \\ln\\left(1 - e^{-\\hbar \\omega_{i}(V)/(k_{\\mathrm{B}} T)}\\right) \\right)\n$$\n热压为 $P_{\\mathrm{th}}(V,T) = -(\\frac{\\partial F_{\\mathrm{ph}}}{\\partial V})_T$。应用该导数并使用模式Grüneisen参数的定义 $\\gamma_{i} = -\\frac{V}{\\omega_{i}} \\frac{\\partial \\omega_{i}}{\\partial V}$，我们得到：\n$$\nP_{\\mathrm{th}}(V,T) = \\frac{1}{V} \\sum_{i} \\gamma_{i} \\left( \\frac{1}{2}\\hbar \\omega_{i} + \\frac{\\hbar \\omega_{i}}{e^{\\hbar \\omega_{i}/(k_{\\mathrm{B}}T)} - 1} \\right) = \\frac{1}{V} \\sum_{i} \\gamma_{i} E_{i}(T)\n$$\n其中 $E_{i}(T)$ 是第 $i$ 个振子的平均总能量。热膨胀理论中的标准惯例是只考虑纯粹由热激发产生的压力。导数 $(\\frac{\\partial P_{\\mathrm{th}}}{\\partial T})_V$ 自动分离出这一贡献：\n$$\n\\left(\\frac{\\partial P_{\\mathrm{th}}}{\\partial T}\\right)_{V} = \\frac{\\partial}{\\partial T} \\left( \\frac{1}{V} \\sum_{i} \\gamma_{i} E_{i}(T) \\right) = \\frac{1}{V} \\sum_{i} \\gamma_{i} \\left(\\frac{\\partial E_{i}}{\\partial T}\\right)_{V}\n$$\n项 $(\\frac{\\partial E_i}{\\partial T})_V$ 是定容模式热容 $c_{V,i}(T)$ 的定义。问题提供了其显式形式：\n$$\nc_{V,i}(T) = k_{\\mathrm{B}} \\frac{x_{i}(T)^{2} e^{x_{i}(T)}}{(e^{x_{i}(T)} - 1)^{2}}, \\quad \\text{其中 } x_{i}(T) = \\frac{\\hbar \\omega_{i}(V_{0})}{k_{\\mathrm{B}} T}\n$$\n因此，我们有 $(\\frac{\\partial P_{\\mathrm{th}}}{\\partial T})_V = \\frac{1}{V} \\sum_{i} \\gamma_{i} c_{V,i}(T)$。按照要求，在参考体积 $V_0$ 处评估的完整热膨胀系数的最终表达式为：\n$$\n\\alpha_{\\mathrm{full}}(T) = \\frac{1}{B_T V_0} \\sum_{i} \\gamma_{i} c_{V,i}(T)\n$$\n\n**2. 单一$\\bar{\\gamma}$近似法**\n\n此近似法通过用一个单一、有效且与温度无关的值 $\\bar{\\gamma}_{\\mathrm{approx}}$ 代替与模式相关的 $\\gamma_i$ 来简化上述表达式。对于 $\\bar{\\gamma}_{\\mathrm{approx}}$，一个物理上合理的选择是在单个参考温度 $T_{\\mathrm{ref}}$ 下评估的、由热容加权的 $\\gamma_i$ 平均值：\n$$\n\\bar{\\gamma}_{\\mathrm{approx}} \\equiv \\bar{\\gamma}(T_{\\mathrm{ref}}) = \\frac{\\sum_{i} \\gamma_{i} c_{V,i}(T_{\\mathrm{ref}})}{\\sum_{i} c_{V,i}(T_{\\mathrm{ref}})}\n$$\n使用这个恒定的 $\\bar{\\gamma}_{\\mathrm{approx}}$，任意温度 $T$ 下的热膨胀系数近似为：\n$$\n\\alpha_{\\mathrm{single}}(T) = \\frac{1}{B_T V_0} \\sum_{i} \\bar{\\gamma}_{\\mathrm{approx}} c_{V,i}(T) = \\frac{\\bar{\\gamma}_{\\mathrm{approx}}}{B_T V_0} \\sum_{i} c_{V,i}(T) = \\frac{\\bar{\\gamma}_{\\mathrm{approx}} C_V(T)}{B_T V_0}\n$$\n其中 $C_V(T) = \\sum_i c_{V,i}(T)$ 是总的定容声子热容。仅当所有 $\\gamma_i$ 相等，或者 $c_{V,i}(T)$ 对总 $C_V(T)$ 的相对贡献与温度无关时，该近似才是精确的，而这通常不成立。\n\n**3. 分布宽度和近似误差的量化**\n\n为评估单一$\\bar{\\gamma}$近似法的有效性，我们必须量化两件事：底层 $\\gamma_i$ 分布的宽度以及由此导致的 $\\alpha(T)$ 的误差。\n\n$\\gamma_i$ 分布的宽度通过其在参考温度 $T_{\\mathrm{ref}}$ 下的热容加权标准差来衡量。权重定义为 $w_i(T_{\\mathrm{ref}}) = c_{V,i}(T_{\\mathrm{ref}}) / C_V(T_{\\mathrm{ref}})$。加权标准差为：\n$$\n\\mathrm{std}_{\\gamma}(T_{\\mathrm{ref}}) = \\sqrt{\\sum_{i=1}^{N} w_i(T_{\\mathrm{ref}}) \\left(\\gamma_i - \\bar{\\gamma}(T_{\\mathrm{ref}})\\right)^2}\n$$\n在给定温度 $T$ 下，近似的相对误差定义为：\n$$\n\\mathrm{err}(T) = \\frac{|\\alpha_{\\mathrm{full}}(T) - \\alpha_{\\mathrm{single}}(T)|}{|\\alpha_{\\mathrm{full}}(T)|}\n$$\n较大的 $\\mathrm{std}_{\\gamma}$ 值预计会与较大的误差相关，尤其是在远离 $T_{\\mathrm{ref}}$ 的温度下，因为近似法忽略了真实加权平均值 $\\bar{\\gamma}(T)$ 的温度依赖性。\n\n**4. 算法实现**\n\n对每种合成材料的计算流程如下：\n1. 定义物理常数：$\\hbar = 1.054571817 \\times 10^{-34}$ $\\mathrm{J \\cdot s}$，$k_{\\mathrm{B}} = 1.380649 \\times 10^{-23}$ $\\mathrm{J/K}$，$B_{T} = 1.0 \\times 10^{11}$ $\\mathrm{Pa}$，以及 $V_{0} = 1.0 \\times 10^{-28}$ $\\mathrm{m^{3}}$。\n2. 对于给定材料，获取频率数组 $f_i$（单位 THz）和模式Grüneisen参数 $\\gamma_i$。将频率转换为角频率：$\\omega_i = 2 \\pi f_i \\times 10^{12}$ rad/s。\n3. 实现一个函数，用于计算在温度 $T$ 下，频率数组为 $\\omega_i$ 的模式热容 $c_{V,i}(T)$。\n4. 在 $T = T_{\\mathrm{ref}} = 300$ K 时，计算模式热容数组 $c_{V,i}(T_{\\mathrm{ref}})$。\n5. 使用 $c_{V,i}(T_{\\mathrm{ref}})$ 计算权重 $w_i(T_{\\mathrm{ref}})$、平均值 $\\bar{\\gamma}_{\\mathrm{approx}} = \\bar{\\gamma}(T_{\\mathrm{ref}})$ 和标准差 $\\mathrm{std}_{\\gamma}(T_{\\mathrm{ref}})$。此标准差是该材料的第一个要求输出。\n6. 遍历评估温度 $T \\in [50, 300, 800]$ K。对于每个 $T$：\n    a. 计算模式热容 $c_{V,i}(T)$。\n    b. 计算 $\\alpha_{\\mathrm{full}}(T) = \\frac{1}{B_T V_0} \\sum_i \\gamma_i c_{V,i}(T)$。\n    c. 计算 $\\alpha_{\\mathrm{single}}(T) = \\frac{\\bar{\\gamma}_{\\mathrm{approx}}}{B_T V_0} \\sum_i c_{V,i}(T)$。\n    d. 计算相对误差 $\\mathrm{err}(T)$。如果 $\\alpha_{\\mathrm{full}}(T)$ 为零或数值上非常接近零，相对误差可视为无限大或未定义；然而，所选的测试案例在评估点避免了此特定问题。\n7. 收集该材料的四个输出值：$[\\mathrm{std}_{\\gamma}(T_{\\mathrm{ref}}), \\mathrm{err}(50 \\text{ K}), \\mathrm{err}(300 \\text{ K}), \\mathrm{err}(800 \\text{ K})]$。\n8. 对所有材料重复此过程，并按规定格式化最终结果。", "answer": "```python\nimport numpy as np\nfrom typing import List, Tuple\n\ndef solve():\n    \"\"\"\n    Computes the failure of the single-mode Grüneisen parameter approximation\n    in the Quasi-Harmonic Approximation (QHA) for thermal expansion.\n    \"\"\"\n    \n    # Define physical constants\n    HBAR = 1.054571817e-34  # J·s\n    KB = 1.380649e-23        # J/K\n    BT = 1.0e11               # Pa\n    V0 = 1.0e-28              # m^3\n    \n    # Pre-calculated constant factors\n    HBAR_OVER_KB = HBAR / KB  # K·s\n    PREFACTOR_ALPHA = 1.0 / (BT * V0) # 1/J\n\n    # Define the temperature points for evaluation\n    T_VALS = np.array([50.0, 300.0, 800.0])  # K\n    T_REF = 300.0  # K\n\n    # Test suite: Frequencies in THz, Grüneisen parameters are dimensionless\n    test_cases: List[Tuple[np.ndarray, np.ndarray]] = [\n        (  # Material 1: Bimodal distribution\n            np.array([2.0, 2.5, 3.0, 1.5, 1.2, 0.8, 10.0, 12.0, 15.0, 18.0, 11.0, 13.0, 16.0, 20.0]),\n            np.array([-1.2, -1.1, -1.0, -0.8, -0.6, -0.5, 2.5, 2.6, 2.4, 2.7, 2.3, 2.8, 2.5, 2.6])\n        ),\n        (  # Material 2: Heavy-tail distribution\n            np.array([0.7, 0.9, 1.0, 1.5, 2.0, 3.0, 5.0, 8.0, 12.0, 15.0, 18.0, 20.0]),\n            np.array([5.0, 4.5, 4.0, 3.0, 2.0, 1.5, 1.2, 1.1, 1.0, 0.9, 0.8, 0.7])\n        ),\n        (  # Material 3: Narrow distribution\n            np.array([2.0, 3.0, 4.0, 6.0, 8.0, 10.0, 12.0, 14.0]),\n            np.array([1.5, 1.6, 1.4, 1.5, 1.5, 1.6, 1.4, 1.5])\n        ),\n    ]\n\n    def calculate_c_V_i(T: float, omegas: np.ndarray) - np.ndarray:\n        \"\"\"\n        Calculates the Einstein model heat capacity for each mode.\n        T: Temperature in Kelvin\n        omegas: Array of angular frequencies in rad/s\n        \"\"\"\n        if T == 0.0:\n            return np.zeros_like(omegas)\n        \n        x = HBAR_OVER_KB * omegas / T\n        \n        # Handle large x to avoid overflow in exp(x)\n        # For large x, c_V_i - k_B * x**2 * exp(-x), which is numerically stable\n        # and tends to 0. A cutoff of x=100 is safe.\n        c_v = np.zeros_like(x)\n        \n        # Standard calculation for moderate x\n        mask_std = x  100\n        x_std = x[mask_std]\n        exp_x = np.exp(x_std)\n        # Using np.subtract(exp_x, 1, out=...) can be slightly more precise for small x_std,\n        # but here the formula is stable enough given standard float64 precision.\n        c_v[mask_std] = KB * x_std**2 * exp_x / (exp_x - 1)**2\n\n        # Approximation for large x\n        mask_large = ~mask_std\n        x_large = x[mask_large]\n        c_v[mask_large] = KB * x_large**2 * np.exp(-x_large)\n\n        return c_v\n\n    results = []\n    for freqs_thz, gammas in test_cases:\n        # 1. Convert frequencies to angular frequencies\n        omegas = 2 * np.pi * freqs_thz * 1e12  # rad/s\n\n        # 2. Calculate quantities at the reference temperature T_ref\n        c_v_i_ref = calculate_c_V_i(T_REF, omegas)\n        c_v_total_ref = np.sum(c_v_i_ref)\n\n        if c_v_total_ref == 0:\n            # Handle case where no modes are excited at T_ref\n            gamma_bar_approx = np.mean(gammas) # Fallback to simple average\n            std_gamma = np.std(gammas)\n        else:\n            weights_ref = c_v_i_ref / c_v_total_ref\n            # Heat-capacity-weighted average Grüneisen parameter at T_ref\n            gamma_bar_approx = np.sum(weights_ref * gammas)\n            # Heat-capacity-weighted standard deviation of Grüneisen parameters at T_ref\n            var_gamma = np.sum(weights_ref * (gammas - gamma_bar_approx)**2)\n            std_gamma = np.sqrt(var_gamma)\n        \n        errors = []\n        for T in T_VALS:\n            # 3. Calculate heat capacities at the evaluation temperature T\n            c_v_i_T = calculate_c_V_i(T, omegas)\n            c_v_total_T = np.sum(c_v_i_T)\n\n            # 4. Calculate alpha_full and alpha_single\n            alpha_full = PREFACTOR_ALPHA * np.sum(gammas * c_v_i_T)\n            alpha_single = PREFACTOR_ALPHA * gamma_bar_approx * c_v_total_T\n            \n            # 5. Calculate relative error\n            if np.isclose(alpha_full, 0.0):\n                # If the true alpha is zero, any non-zero approximation has infinite relative error.\n                # If the approximation is also zero, the error is zero.\n                if np.isclose(alpha_single, 0.0):\n                    err = 0.0\n                else:\n                    err = np.inf\n            else:\n                err = np.abs(alpha_full - alpha_single) / np.abs(alpha_full)\n            errors.append(err)\n            \n        material_results = [std_gamma] + errors\n        results.append(material_results)\n\n    # Format the final output string according to the specification\n    # e.g., [[val1,val2],[val3,val4]]\n    outer_parts = []\n    for res_list in results:\n        inner_str = ','.join(map(str, res_list))\n        outer_parts.append(f\"[{inner_str}]\")\n    \n    final_output = f\"[{','.join(outer_parts)}]\"\n    print(final_output)\n\nsolve()\n```", "id": "3483228"}, {"introduction": "最后一个实践练习将我们的视野拓宽到模型的静态部分。准谐波近似的核心思想是将静态晶格能量与声子振动贡献相结合。我们对静态能量——即物态方程（EOS）——的模型选择，同样会显著影响最终预测的热学性质。本练习将对比两种广泛使用的物态方程（Birch-Murnaghan和Vinet），揭示对静态晶格“硬度”的不同描述如何影响在有限温度下的平衡体积计算，并最终传导至热膨胀系数的预测结果。[@problem_id:3483279]", "problem": "考虑一个在准谐波近似下建模的晶体固体。其静态晶格由一个零压参考体积 $V_0$ 和一个静态状态方程描述，该状态方程有两种形式之一：三阶Birch–Murnaghan方程或Vinet方程。振动谱由一组具有固定体积标度指数的爱因斯坦模式表示，因此在两种状态方程选择下，每个模式角频率 $\\omega_m(V)$ 的体积依赖性是相同的。您的任务是，在固定外部压力 $P_{\\mathrm{ext}}=0$ 的条件下，计算每种状态方程模型下随温度变化的平均Grüneisen参数 $\\gamma(T)$ 和体热膨胀系数 $\\alpha(T)$，然后通过报告两种模型在指定温度下的差异来量化状态方程选择的影响。\n\n使用以下基本定义和经过充分检验的公式作为起点：\n\n- 总压力为 $P(V,T) = P_{\\mathrm{static}}(V) + P_{\\mathrm{vib}}(V,T)$，其中 $P_{\\mathrm{static}}(V)$ 由所选的静态状态方程提供，而 $P_{\\mathrm{vib}}(V,T)$ 是由 $\\omega_m(V)$ 的体积依赖性产生的振动压力。\n- 爱因斯坦模式的角频率随体积的变化关系为 $\\omega_m(V) = \\omega_{m0} \\left(\\dfrac{V}{V_0}\\right)^{-\\gamma_m}$，其中 $\\gamma_m$ 是模式Grüneisen指数，$\\omega_{m0}$ 是在 $V_0$ 时的角频率。\n- 对于每个具有简并度 $g_m$ 的模式 $m$，在温度 $T$ 下的谐振子能量为 $E_m(V,T) = g_m \\hbar \\omega_m(V) \\left(n_m(T,V) + \\dfrac{1}{2}\\right)$，其中玻色–爱因斯坦占据数为 $n_m(T,V) = \\left[\\exp\\!\\left(\\dfrac{\\hbar \\omega_m(V)}{k_{\\mathrm{B}} T}\\right) - 1\\right]^{-1}$，$k_{\\mathrm{B}}$ 是玻尔兹曼常数，$\\hbar$ 是约化普朗克常数。相应的等容热容为 $C_{V,m}(T,V) = g_m k_{\\mathrm{B}} \\left(\\dfrac{\\hbar \\omega_m(V)}{k_{\\mathrm{B}} T}\\right)^2 \\dfrac{\\exp\\!\\left(\\dfrac{\\hbar \\omega_m(V)}{k_{\\mathrm{B}} T}\\right)}{\\left[\\exp\\!\\left(\\dfrac{\\hbar \\omega_m(V)}{k_{\\mathrm{B}} T}\\right)-1\\right]^2}$。\n- 振动压力源于振动亥姆霍兹自由能的体积依赖性。对于上述 $\\omega_m(V)$ 的幂律形式，其表达式为 $P_{\\mathrm{vib}}(V,T) = \\dfrac{1}{V} \\sum_m \\gamma_m \\, E_m(V,T)$。\n- 随温度变化的平均Grüneisen参数由热容加权平均值定义：$\\gamma(T) = \\dfrac{\\sum_m \\gamma_m \\, C_{V,m}(T,V_{\\mathrm{eq}}(T))}{\\sum_m C_{V,m}(T,V_{\\mathrm{eq}}(T))}$，该值在从零压条件获得的平衡体积 $V_{\\mathrm{eq}}(T)$ 处计算。\n- 体热膨胀系数在热力学上定义为 $\\alpha(T) = \\dfrac{1}{V_{\\mathrm{eq}}(T)} \\left(\\dfrac{\\partial V_{\\mathrm{eq}}}{\\partial T}\\right)_{P_{\\mathrm{ext}}=0}$。\n\n待使用的静态状态方程：\n\n- 三阶Birch–Murnaghan：\n$$\nP_{\\mathrm{BM}}(V) = \\frac{3}{2} B_0 \\left[\\eta^{7/3} - \\eta^{5/3}\\right] \\left\\{ 1 + \\frac{3}{4} \\left(B_0' - 4\\right) \\left[\\eta^{2/3} - 1\\right] \\right\\}, \\quad \\eta = \\frac{V_0}{V}.\n$$\n\n- Vinet：\n$$\nP_{\\mathrm{Vinet}}(V) = 3 B_0 \\frac{1 - x}{x^2} \\exp\\!\\left[ \\frac{3}{2}(B_0' - 1)(1 - x) \\right], \\quad x = \\left(\\frac{V}{V_0}\\right)^{1/3}.\n$$\n\n您必须按以下步骤进行：\n- 对于每个状态方程，在每个测试温度下求解标量方程 $P_{\\mathrm{static}}(V) + P_{\\mathrm{vib}}(V,T) = 0$，以获得平衡体积 $V_{\\mathrm{eq}}(T)$。\n- 使用上面给出的热容加权定义，在 $V_{\\mathrm{eq}}(T)$ 处计算 $\\gamma(T)$。\n- 在 $P_{\\mathrm{ext}}=0$ 时，使用热力学定义 $\\alpha(T) = \\dfrac{1}{V_{\\mathrm{eq}}(T)} \\left(\\dfrac{\\partial V_{\\mathrm{eq}}}{\\partial T}\\right)_{P}$ 计算 $\\alpha(T)$，通过在每个测试温度附近施加一个小的对称温度微扰进行数值评估。将 $\\alpha(T)$ 以 $\\mathrm{K}^{-1}$ 为单位表示。\n\n通过使用相同的参数 $\\{\\omega_{m0}, \\gamma_m, g_m\\}$ 和 $V_0$，保持两种状态方程的 $\\omega_m(V)$ 相同。在测试套件中使用以下科学上合理的参数集：\n\n- 参考体积: $V_0 = 1.00 \\times 10^{-29}\\ \\mathrm{m}^3$。\n- $V_0$ 处的体模量: $B_0 = 1.60 \\times 10^{11}\\ \\mathrm{Pa}$。\n- 体模量的压力导数: $B_0' = 4.3$。\n- 爱因斯坦模式集（三个模式的列表）：\n  - 模式 1: $f_{10} = 4.0\\ \\mathrm{THz}$，$\\gamma_1 = 1.5$，$g_1 = 2$。\n  - 模式 2: $f_{20} = 8.0\\ \\mathrm{THz}$，$\\gamma_2 = 1.2$，$g_2 = 3$。\n  - 模式 3: $f_{30} = 12.0\\ \\mathrm{THz}$，$\\gamma_3 = 0.8$，$g_3 = 1$。\n  使用 $\\omega_{m0} = 2\\pi f_{m0}$ 将每个 $f_{m0}$ 转换为角频率。\n- 外部压力: $P_{\\mathrm{ext}} = 0$。\n- 待评估的温度: $T \\in \\{ 1,\\ 300,\\ 800,\\ 1500\\}\\ \\mathrm{K}$。\n\n常数：\n- 精确使用给定的 $k_{\\mathrm{B}} = 1.380649 \\times 10^{-23}\\ \\mathrm{J/K}$ 和 $\\hbar = 1.054571817 \\times 10^{-34}\\ \\mathrm{J\\,s}$。\n\n您的程序必须计算在测试套件中的每个温度下，两种状态方程模型之间的差异：\n- $\\Delta \\gamma(T) = \\gamma_{\\mathrm{BM}}(T) - \\gamma_{\\mathrm{Vinet}}(T)$（无量纲）。\n- $\\Delta \\alpha(T) = \\alpha_{\\mathrm{BM}}(T) - \\alpha_{\\mathrm{Vinet}}(T)$（单位为 $\\mathrm{K}^{-1}$）。\n\n数值细节：\n- 为评估 $\\alpha(T)$，在可能的情况下使用 $\\delta T = 1.0\\ \\mathrm{K}$ 的对称温度微扰，即 $\\alpha(T) \\approx \\dfrac{1}{V_{\\mathrm{eq}}(T)} \\dfrac{V_{\\mathrm{eq}}(T+\\delta T) - V_{\\mathrm{eq}}(T-\\delta T)}{2 \\delta T}$。在下边界 $T - \\delta T \\le 0$ 时，使用前向差分 $\\alpha(T) \\approx \\dfrac{1}{V_{\\mathrm{eq}}(T)} \\dfrac{V_{\\mathrm{eq}}(T+\\delta T) - V_{\\mathrm{eq}}(T)}{\\delta T}$。\n- 通过在 $V_0$ 附近一个物理上合理的区间内进行区间划分和稳健的求根方法来求解 $V_{\\mathrm{eq}}(T)$，该区间需保证所有列出的温度下根都存在。\n\n所需输出：\n- 您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表，顺序为 $[\\Delta \\gamma(1\\ \\mathrm{K}), \\Delta \\alpha(1\\ \\mathrm{K}), \\Delta \\gamma(300\\ \\mathrm{K}), \\Delta \\alpha(300\\ \\mathrm{K}), \\Delta \\gamma(800\\ \\mathrm{K}), \\Delta \\alpha(800\\ \\mathrm{K}), \\Delta \\gamma(1500\\ \\mathrm{K}), \\Delta \\alpha(1500\\ \\mathrm{K})]$。\n- 列表中的每个实数必须精确到小数点后 $8$ 位。", "solution": "该问题要求使用准谐波近似（QHA）计算并比较晶体固体的随温度变化的热力学性质。比较是在两种不同的静态状态方程（EOS）模型之间进行的：三阶Birch-Murnaghan（BM）方程和Vinet方程。需要计算的关键量是平均Grüneisen参数 $\\gamma(T)$ 和体热膨胀系数 $\\alpha(T)$。解决方案是通过遵循一系列基于统计力学和固态物理学原理的计算步骤得出的。\n\n**1. 基础理论与模型实现**\n\nQHA的核心是将总压力 $P(V,T)$ 分解为一个来自 $0\\ \\mathrm{K}$ 时晶格的静态分量 $P_{\\mathrm{static}}(V)$ 和一个来自原子的热运动和零点运动的振动分量 $P_{\\mathrm{vib}}(V,T)$。在给定温度 $T$ 和外部压力 $P_{\\mathrm{ext}}$ 下的平衡体积是满足条件 $P(V_{\\mathrm{eq}}(T), T) = P_{\\mathrm{ext}}$ 的体积 $V_{\\mathrm{eq}}(T)$。对于这个问题，$P_{\\mathrm{ext}} = 0$，因此我们求解 $P_{\\mathrm{static}}(V) + P_{\\mathrm{vib}}(V,T) = 0$。\n\n首先，我们实现指定的两个静态EOS压力函数：\n\n- **Birch-Murnaghan (BM) 压力, $P_{\\mathrm{BM}}(V)$**：\n$$\nP_{\\mathrm{BM}}(V) = \\frac{3}{2} B_0 \\left[\\eta^{7/3} - \\eta^{5/3}\\right] \\left\\{ 1 + \\frac{3}{4} \\left(B_0' - 4\\right) \\left[\\eta^{2/3} - 1\\right] \\right\\}\n$$\n其中 $\\eta = V_0/V$，$V_0$ 是参考体积，$B_0$ 是体模量，$B_0'$ 是其压力导数。\n\n- **Vinet 压力, $P_{\\mathrm{Vinet}}(V)$**：\n$$\nP_{\\mathrm{Vinet}}(V) = 3 B_0 \\frac{1 - x}{x^2} \\exp\\!\\left[ \\frac{3}{2}(B_0' - 1)(1 - x) \\right]\n$$\n其中 $x = (V/V_0)^{1/3}$。\n\n接下来，我们基于所提供的爱因斯坦模型实现振动贡献。该模型由一组 $M$ 个模式组成，每个模式都有一个参考角频率 $\\omega_{m0}$、一个简并度 $g_m$ 和一个模式Grüneisen参数 $\\gamma_m$。\n\n- **随体积变化的频率, $\\omega_m(V)$**：每个模式的频率根据幂律 $\\omega_m(V) = \\omega_{m0} \\left(V/V_0\\right)^{-\\gamma_m}$ 随体积变化。\n\n- **振动能, $E_m(V,T)$**：每个模式的能量是量子谐振子的能量，包括零点能：\n$$\nE_m(V,T) = g_m \\hbar \\omega_m(V) \\left(\\frac{1}{2} + n_m(T,V)\\right)\n$$\n其中 $n_m(T,V) = \\left[\\exp\\left(\\frac{\\hbar \\omega_m(V)}{k_{\\mathrm{B}} T}\\right) - 1\\right]^{-1}$ 是玻色-爱因斯坦占据数。\n\n- **振动压力, $P_{\\mathrm{vib}}(V,T)$**：该压力源于振动自由能的体积依赖性，由下式给出：\n$$\nP_{\\mathrm{vib}}(V,T) = -\\left(\\frac{\\partial F_{\\mathrm{vib}}}{\\partial V}\\right)_{T} = \\frac{1}{V} \\sum_{m=1}^{M} \\gamma_m E_m(V,T)\n$$\n对于 $\\gamma_m  0$，该项始终为正，并作为驱动热膨胀的内压。\n\n**2. 确定平衡体积 $V_{\\mathrm{eq}}(T)$**\n\n对于每个EOS模型（BM和Vinet）和每个目标温度 $T$，我们必须通过求解非线性标量方程 $P_{\\mathrm{static}}(V) + P_{\\mathrm{vib}}(V,T) = 0$ 来找到平衡体积 $V_{\\mathrm{eq}}(T)$。这是一个求根问题。由于 $P_{\\mathrm{static}}(V_0) = 0$ 且对于 $T0$ 时 $P_{\\mathrm{vib}}(V_0,T)  0$，因此在 $V_0$ 处的总压力为正。对于大体积 $V \\gg V_0$，$P_{\\mathrm{static}}(V)$ 变为强负值，而 $P_{\\mathrm{vib}}(V,T)$ 趋近于零，使得总压力为负。这保证了根 $V_{\\mathrm{eq}}(T)  V_0$ 的存在。像Brent方法这样的稳健求根算法非常适合此任务，前提是使用一个括号区间，例如 $[V_0, 1.2V_0]$。采用缓存机制来存储计算出的 $V_{\\mathrm{eq}}(T)$ 值，以避免重复计算，这在计算 $\\alpha(T)$ 时尤其有用。\n\n**3. 计算热力学性质**\n\n一旦确定了 $V_{\\mathrm{eq}}(T)$，热力学性质按如下方式计算：\n\n- **平均Grüneisen参数, $\\gamma(T)$**：此参数是各个模式Grüneisen参数的热容加权平均值，在平衡体积处进行评估：\n$$\n\\gamma(T) = \\frac{\\sum_m \\gamma_m C_{V,m}(T,V_{\\mathrm{eq}}(T))}{\\sum_m C_{V,m}(T,V_{\\mathrm{eq}}(T))}\n$$\n每个模式的等容热容 $C_{V,m}(T,V)$ 由下式给出：\n$$\nC_{V,m}(T,V) = g_m k_{\\mathrm{B}} \\left(\\frac{\\hbar \\omega_m(V)}{k_{\\mathrm{B}} T}\\right)^2 \\frac{\\exp\\left(\\frac{\\hbar \\omega_m(V)}{k_{\\mathrm{B}} T}\\right)}{\\left[\\exp\\left(\\frac{\\hbar \\omega_m(V)}{k_{\\mathrm{B}} T}\\right)-1\\right]^2}\n$$\n为了在低温或高频下（此时参数 $x = \\hbar\\omega/(k_{\\mathrm{B}}T)$ 变大）保持数值稳定性，$C_{V,m}$ 的表达式使用其渐近形式 $C_{V,m} \\approx g_m k_{\\mathrm{B}} x^2 e^{-x}$ 进行评估，以避免溢出。\n\n- **体热膨胀系数, $\\alpha(T)$**：其定义为 $\\alpha(T) = \\frac{1}{V_{\\mathrm{eq}}(T)} \\left(\\frac{\\partial V_{\\mathrm{eq}}}{\\partial T}\\right)_{P}$。导数按照问题中的规定，使用有限差分近似进行数值计算。对于大多数温度，使用二阶对称差分：\n$$\n\\alpha(T) \\approx \\frac{1}{V_{\\mathrm{eq}}(T)} \\frac{V_{\\mathrm{eq}}(T+\\delta T) - V_{\\mathrm{eq}}(T-\\delta T)}{2 \\delta T}\n$$\n温度步长为 $\\delta T = 1.0\\ \\mathrm{K}$。对于最低温度 $T=1\\ \\mathrm{K}$，其中 $T-\\delta T \\le 0$，使用一阶前向差分：\n$$\n\\alpha(T) \\approx \\frac{1}{V_{\\mathrm{eq}}(T)} \\frac{V_{\\mathrm{eq}}(T+\\delta T) - V_{\\mathrm{eq}}(T)}{\\delta T}\n$$\n\n**4. 最终计算与输出**\n\n对集合 $T \\in \\{1, 300, 800, 1500\\}\\ \\mathrm{K}$ 中的每个温度执行该过程。对于每个 $T$，我们计算 $\\gamma_{\\mathrm{BM}}(T)$、$\\alpha_{\\mathrm{BM}}(T)$、$\\gamma_{\\mathrm{Vinet}}(T)$ 和 $\\alpha_{\\mathrm{Vinet}}(T)$。然后计算差异 $\\Delta \\gamma(T) = \\gamma_{\\mathrm{BM}}(T) - \\gamma_{\\mathrm{Vinet}}(T)$ 和 $\\Delta \\alpha(T) = \\alpha_{\\mathrm{BM}}(T) - \\alpha_{\\mathrm{Vinet}}(T)$。这些差异量化了静态EOS的选择对预测热力学性质的影响。将最终结果收集并按要求格式化为单行字符串。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Computes differences in Grüneisen parameter and thermal expansion coefficient\n    between Birch-Murnaghan and Vinet EOS models within the quasiharmonic approximation.\n    \"\"\"\n    \n    # Fundamental Constants\n    K_B = 1.380649e-23  # Boltzmann constant in J/K\n    HBAR = 1.054571817e-34 # Reduced Planck constant in J s\n\n    # Material and Model Parameters\n    V0 = 1.00e-29  # Reference volume in m^3\n    B0 = 1.60e11   # Bulk modulus in Pa\n    B0_P = 4.3     # Pressure derivative of bulk modulus (dimensionless)\n\n    # Einstein modes: [frequency (Hz), mode Gruneisen, degeneracy]\n    MODES = [\n        (4.0e12, 1.5, 2),\n        (8.0e12, 1.2, 3),\n        (12.0e12, 0.8, 1),\n    ]\n\n    # Pre-calculate angular frequencies and store parameters in separate lists\n    OMEGA0S = [2 * np.pi * f0 for f0, _, _ in MODES]\n    GAMMAS = [gamma for _, gamma, _ in MODES]\n    DEGENERACIES = [g for _, _, g in MODES]\n\n    # --- Static Equation of State (EOS) Pressure Functions ---\n    \n    def p_bm(V, V0, B0, B0_p):\n        \"\"\"Third-order Birch-Murnaghan static pressure.\"\"\"\n        eta = V0 / V\n        term1 = eta**(7/3) - eta**(5/3)\n        term2 = 1 + 0.75 * (B0_p - 4) * (eta**(2/3) - 1)\n        return 1.5 * B0 * term1 * term2\n\n    def p_vinet(V, V0, B0, B0_p):\n        \"\"\"Vinet static pressure.\"\"\"\n        x = (V / V0)**(1/3)\n        term1 = (1 - x) / (x**2)\n        exponent = 1.5 * (B0_p - 1) * (1 - x)\n        return 3 * B0 * term1 * np.exp(exponent)\n\n    # --- Vibrational Property Functions ---\n    \n    def get_omega(V, omega0, gamma_m, V0):\n        \"\"\"Calculates volume-dependent frequency.\"\"\"\n        return omega0 * (V / V0)**(-gamma_m)\n\n    def get_vib_energy_mode(T, V, omega0, g_m, gamma_m, V0):\n        \"\"\"Calculates vibrational energy for a single mode.\"\"\"\n        omega_v = get_omega(V, omega0, gamma_m, V0)\n        if T  1e-9: # Effectively T=0\n            return g_m * 0.5 * HBAR * omega_v # Zero-point energy\n        \n        x = HBAR * omega_v / (K_B * T)\n        \n        if x > 700: # Avoid overflow in exp(x)\n            n_m = np.exp(-x)\n        else:\n            n_m = 1.0 / (np.exp(x) - 1.0)\n            \n        return g_m * HBAR * omega_v * (n_m + 0.5)\n\n    def get_p_vib(T, V, V0):\n        \"\"\"Calculates total vibrational pressure.\"\"\"\n        p_v = 0.0\n        for i in range(len(MODES)):\n            E_m = get_vib_energy_mode(T, V, OMEGA0S[i], DEGENERACIES[i], GAMMAS[i], V0)\n            p_v += GAMMAS[i] * E_m\n        return p_v / V\n\n    def get_cv_mode(T, V, omega0, g_m, gamma_m, V0):\n        \"\"\"Calculates heat capacity for a single mode.\"\"\"\n        if T  1e-9:\n            return 0.0\n        \n        omega_v = get_omega(V, omega0, gamma_m, V0)\n        x = HBAR * omega_v / (K_B * T)\n        \n        if x > 700:\n             return g_m * K_B * x**2 * np.exp(-x)\n\n        exp_x = np.exp(x)\n        numerator = exp_x\n        denominator = (exp_x - 1.0)**2\n        \n        # Handle cases where exp_x -> inf causing inf/inf\n        if np.isinf(denominator):\n            return g_m * K_B * x**2 * np.exp(-x)\n\n        return g_m * K_B * x**2 * numerator / denominator\n\n    # --- Solvers and Property Calculators ---\n    \n    _v_eq_cache = {}\n    def get_v_eq(T, p_static_func, V0, B0, B0_p):\n        \"\"\"Finds equilibrium volume by solving P_total(V,T)=0.\"\"\"\n        cache_key = (T, p_static_func.__name__)\n        if cache_key in _v_eq_cache:\n            return _v_eq_cache[cache_key]\n\n        if T  1e-9:\n            return V0\n\n        f_to_solve = lambda V: p_static_func(V, V0, B0, B0_p) + get_p_vib(T, V, V0)\n        v_min, v_max = V0, V0 * 1.2\n        \n        v_eq = brentq(f_to_solve, v_min, v_max, xtol=1e-15, rtol=1e-15)\n        _v_eq_cache[cache_key] = v_eq\n        return v_eq\n\n    def calculate_gamma(T, V_eq, V0):\n        \"\"\"Calculates the average Grüneisen parameter.\"\"\"\n        numerator = 0.0\n        denominator = 0.0\n        for i in range(len(MODES)):\n            cv_m = get_cv_mode(T, V_eq, OMEGA0S[i], DEGENERACIES[i], GAMMAS[i], V0)\n            numerator += GAMMAS[i] * cv_m\n            denominator += cv_m\n            \n        if denominator  1e-30: # If Cv is numerically zero (very low T)\n            min_omega_idx = np.argmin(OMEGA0S)\n            return GAMMAS[min_omega_idx] # Return gamma of lowest frequency mode\n        \n        return numerator / denominator\n\n    def calculate_alpha(T, V_eq, p_static_func, V0, B0, B0_p):\n        \"\"\"Calculates the volumetric thermal expansion coefficient via finite difference.\"\"\"\n        dT = 1.0\n        \n        if T - dT = 0: # Forward difference for T=1K\n            V_plus = get_v_eq(T + dT, p_static_func, V0, B0, B0_p)\n            dV_dT = (V_plus - V_eq) / dT\n        else: # Symmetric difference for other temperatures\n            V_plus = get_v_eq(T + dT, p_static_func, V0, B0, B0_p)\n            V_minus = get_v_eq(T - dT, p_static_func, V0, B0, B0_p)\n            dV_dT = (V_plus - V_minus) / (2 * dT)\n            \n        return (1 / V_eq) * dV_dT\n\n    # --- Main Calculation Loop ---\n    \n    test_cases = [1.0, 300.0, 800.0, 1500.0]\n    results = []\n    \n    for T in test_cases:\n        # Birch-Murnaghan calculations\n        v_eq_bm = get_v_eq(T, p_bm, V0, B0, B0_P)\n        gamma_bm = calculate_gamma(T, v_eq_bm, V0)\n        alpha_bm = calculate_alpha(T, v_eq_bm, p_bm, V0, B0, B0_P)\n\n        # Vinet calculations\n        v_eq_vinet = get_v_eq(T, p_vinet, V0, B0, B0_P)\n        gamma_vinet = calculate_gamma(T, v_eq_vinet, V0)\n        alpha_vinet = calculate_alpha(T, v_eq_vinet, p_vinet, V0, B0, B0_P)\n        \n        # Calculate differences and append\n        delta_gamma = gamma_bm - gamma_vinet\n        delta_alpha = alpha_bm - alpha_vinet\n        results.append(delta_gamma)\n        results.append(delta_alpha)\n        \n    # Format and print the final output\n    formatted_results = [f\"{r:.8f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3483279"}]}