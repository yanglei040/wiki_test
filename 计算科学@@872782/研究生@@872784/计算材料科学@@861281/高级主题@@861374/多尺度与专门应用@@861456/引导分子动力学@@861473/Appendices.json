{"hands_on_practices": [{"introduction": "我们将从基础开始。第一个练习将探讨在一个简化的模型系统中，系统对两种最常见的牵引方案——恒定力（constant force）和恒定速度（constant velocity）——的响应行为。通过求解其运动方程，你将直观地理解系统的“延迟”（lag）现象，即系统响应外部牵引时的滞后，这是系统偏离平衡态的一个基本表现。[@problem_id:3490235]", "problem": "单个吸附反应坐标 $x(t)$ 描述了在引导分子动力学 (SMD) 中，一个分子质心向平坦基底靠近的过程。假设在位于 $x=0$ 的吸附位点附近处于过阻尼状态和线性响应区，因此背景吸附自由能可以局部近似为一个刚度为 $k_{a}$ 的谐波势，即 $U(x) \\approx \\frac{1}{2} k_{a} x^{2}$。一维动力学由过阻尼朗之万方程建模\n$$\n\\gamma \\,\\frac{dx}{dt} \\;=\\; -\\frac{dU}{dx} \\;+\\; f_{\\mathrm{ext}}(t) \\;+\\; \\xi(t),\n$$\n其中 $\\gamma$ 是摩擦系数，$\\xi(t)$ 是零均值热噪声，满足 $\\langle \\xi(t) \\rangle = 0$。因此，系综平均值 $\\langle x(t) \\rangle$ 服从一个确定性的线性常微分方程。\n\n考虑两种常见的 SMD 引导方案，应用于 $t \\geq 0$ 且初始条件为 $\\langle x(0) \\rangle = 0$：\n\n1. 恒力引导：一个恒定的外力 $f_{\\mathrm{ext}}(t) = F_{0}$。\n2. 带谐波约束的恒速引导：一个移动的谐波参考点 $x_{0}(t) = v t$，引导刚度为 $k$，产生一个外力 $f_{\\mathrm{ext}}(t) = -\\frac{\\partial}{\\partial x}\\left[\\frac{1}{2}k\\left(x - x_{0}(t)\\right)^{2}\\right]$。\n\n从上述过阻尼朗之万方程和线性响应近似出发，完成以下任务：\n\n- 在恒力引导下，推导 $\\langle x(t) \\rangle$ 关于 $F_{0}$、$k_{a}$ 和 $\\gamma$ 的闭式表达式。\n- 在恒速引导下，推导 $\\langle x(t) \\rangle$ 关于 $k$、$k_{a}$、$v$ 和 $\\gamma$ 的闭式表达式。\n- 在恒速引导下，定义随时间变化的延迟 $\\Delta(t) \\equiv x_{0}(t) - \\langle x(t) \\rangle$，并用 $k$、$k_{a}$、$v$、$\\gamma$ 和 $t$ 表示 $\\Delta(t)$ 的闭式表达式。\n\n最后，对于恒速引导，使用以下参数值计算在指定时间 $t^{\\ast} = 0.5\\,\\mathrm{ns}$ 时的延迟 $\\Delta(t^{\\ast})$：\n- 摩擦系数 $\\gamma = 3.0 \\times 10^{-12}\\,\\mathrm{kg/s}$，\n- 吸附刚度 $k_{a} = 200\\,\\mathrm{pN/nm}$，\n- 引导刚度 $k = 100\\,\\mathrm{pN/nm}$，\n- 牵引速度 $v = 5\\,\\mathrm{nm/ns}$。\n\n以纳米 (nm) 为单位表示最终延迟，并将答案四舍五入到四位有效数字。最终答案必须是单个实数值。", "solution": "首先验证问题的科学性、适定性和客观性。所提供的模型，即过阻尼朗之万方程，是统计力学中描述势场中布朗运动的基石。在自由能形貌中使用谐波近似，以及应用标准的恒力引导和恒速引导方案，是计算材料科学和生物物理学领域，特别是在引导分子动力学 (SMD) 中，标准且成熟的技术。所有参数、初始条件和目标都已明确定义，构成了一个线性常微分方程的可解初值问题。参数值对于分子尺度模拟是物理上现实的。因此，该问题被认为是有效的，可以推导出完整的解。\n\n系统的动力学由一维过阻尼朗之万方程控制：\n$$\n\\gamma \\frac{dx}{dt} = -\\frac{dU}{dx} + f_{\\mathrm{ext}}(t) + \\xi(t)\n$$\n其中 $U(x) = \\frac{1}{2} k_{a} x^{2}$，$\\gamma$ 是摩擦系数，$f_{\\mathrm{ext}}(t)$ 是随时间变化的外引导力，$\\xi(t)$ 是均值为零的热噪声项，$\\langle \\xi(t) \\rangle = 0$。从背景势导出的力是 $-\\frac{dU}{dx} = -k_a x$。\n\n如问题所述，系综平均值 $\\langle x(t) \\rangle$ 服从一个确定性方程。我们通过对朗之万方程取系综平均来求得此方程。由于平均算符和力项的线性性质，并且已知 $\\langle \\xi(t) \\rangle = 0$，我们有：\n$$\n\\left\\langle \\gamma \\frac{dx}{dt} \\right\\rangle = \\left\\langle -k_a x + f_{\\mathrm{ext}}(t) + \\xi(t) \\right\\rangle\n$$\n$$\n\\gamma \\frac{d\\langle x(t) \\rangle}{dt} = -k_a \\langle x(t) \\rangle + \\langle f_{\\mathrm{ext}}(t) \\rangle\n$$\n这是关于系综平均位置 $\\langle x(t) \\rangle$ 的一般一阶线性常微分方程 (ODE)。现在我们针对两种指定的方案，在初始条件 $\\langle x(0) \\rangle = 0$ 下求解该方程。\n\n**1. 恒力引导**\n\n对于此方案，外力为常数 $f_{\\mathrm{ext}}(t) = F_{0}$。该力项与坐标 $x$ 无关，因此其系综平均值就是 $\\langle f_{\\mathrm{ext}}(t) \\rangle = F_{0}$。$\\langle x(t) \\rangle$ 的 ODE 变为：\n$$\n\\gamma \\frac{d\\langle x \\rangle}{dt} + k_a \\langle x \\rangle = F_0\n$$\n这是一个一阶线性非齐次 ODE。通解是齐次解 $\\langle x_h(t) \\rangle$ 和一个特解 $\\langle x_p(t) \\rangle$ 的和。齐次方程为 $\\gamma \\frac{d\\langle x_h \\rangle}{dt} + k_a \\langle x_h \\rangle = 0$，其解为 $\\langle x_h(t) \\rangle = C \\exp\\left(-\\frac{k_a}{\\gamma}t\\right)$，其中 $C$ 是一个常数。对于特解，由于右侧是常数，我们尝试一个常数解 $\\langle x_p(t) \\rangle = A$。将其代入 ODE 得到 $k_a A = F_0$，所以 $A = \\frac{F_0}{k_a}$。\n通解是：\n$$\n\\langle x(t) \\rangle = C \\exp\\left(-\\frac{k_a}{\\gamma}t\\right) + \\frac{F_0}{k_a}\n$$\n应用初始条件 $\\langle x(0) \\rangle = 0$：\n$$\n0 = C \\exp(0) + \\frac{F_0}{k_a} \\implies C = -\\frac{F_0}{k_a}\n$$\n因此，在恒力引导下 $\\langle x(t) \\rangle$ 的闭式表达式为：\n$$\n\\langle x(t) \\rangle = \\frac{F_0}{k_a} \\left(1 - \\exp\\left(-\\frac{k_a}{\\gamma}t\\right)\\right)\n$$\n\n**2. 恒速引导**\n\n对于此方案，外力由一个谐波势产生，其最小值以恒定速度 $v$ 移动，即 $x_0(t) = vt$。力为 $f_{\\mathrm{ext}}(t) = -\\frac{\\partial}{\\partial x}\\left[\\frac{1}{2}k(x - x_0(t))^2\\right] = -k(x - vt)$。该力是 $x$ 的线性函数，因此其系综平均值为 $\\langle f_{\\mathrm{ext}}(t) \\rangle = \\langle -k(x - vt) \\rangle = -k\\langle x(t) \\rangle + kvt$。\n将此代入 $\\langle x(t) \\rangle$ 的一般 ODE 中：\n$$\n\\gamma \\frac{d\\langle x \\rangle}{dt} = -k_a \\langle x \\rangle - k\\langle x \\rangle + kvt\n$$\n$$\n\\gamma \\frac{d\\langle x \\rangle}{dt} + (k_a + k) \\langle x \\rangle = kvt\n$$\n这是另一个一阶线性非齐次 ODE。令 $k_{tot} = k_a + k$。齐次解为 $\\langle x_h(t) \\rangle = C \\exp\\left(-\\frac{k_{tot}}{\\gamma}t\\right)$。对于特解，我们尝试一个时间线性函数 $\\langle x_p(t) \\rangle = At + B$。代入 ODE 中：\n$$\n\\gamma A + k_{tot}(At+B) = kvt \\implies (k_{tot}A)t + (\\gamma A + k_{tot}B) = kvt\n$$\n令 $t$ 的各次幂系数相等：\n- $t^1: \\quad k_{tot}A = kv \\implies A = \\frac{kv}{k_{tot}} = \\frac{kv}{k_a+k}$\n- $t^0: \\quad \\gamma A + k_{tot}B = 0 \\implies B = -\\frac{\\gamma A}{k_{tot}} = -\\frac{\\gamma}{k_a+k} \\left( \\frac{kv}{k_a+k} \\right) = -\\frac{\\gamma k v}{(k_a+k)^2}$\n通解是：\n$$\n\\langle x(t) \\rangle = C \\exp\\left(-\\frac{k_a+k}{\\gamma}t\\right) + \\frac{kv}{k_a+k}t - \\frac{\\gamma k v}{(k_a+k)^2}\n$$\n应用初始条件 $\\langle x(0) \\rangle = 0$：\n$$\n0 = C \\exp(0) + 0 - \\frac{\\gamma k v}{(k_a+k)^2} \\implies C = \\frac{\\gamma k v}{(k_a+k)^2}\n$$\n因此，在恒速引导下 $\\langle x(t) \\rangle$ 的闭式表达式为：\n$$\n\\langle x(t) \\rangle = \\frac{\\gamma k v}{(k_a+k)^2} \\exp\\left(-\\frac{k_a+k}{\\gamma}t\\right) + \\frac{kv}{k_a+k}t - \\frac{\\gamma k v}{(k_a+k)^2}\n$$\n这可以更紧凑地写为：\n$$\n\\langle x(t) \\rangle = \\frac{kv}{k_a+k}t - \\frac{\\gamma k v}{(k_a+k)^2}\\left[1 - \\exp\\left(-\\frac{k_a+k}{\\gamma}t\\right)\\right]\n$$\n\n**3. 随时间变化的延迟 $\\Delta(t)$**\n\n延迟定义为 $\\Delta(t) \\equiv x_0(t) - \\langle x(t) \\rangle$。当 $x_0(t) = vt$ 时，我们有：\n$$\n\\Delta(t) = vt - \\left( \\frac{kv}{k_a+k}t - \\frac{\\gamma k v}{(k_a+k)^2}\\left[1 - \\exp\\left(-\\frac{k_a+k}{\\gamma}t\\right)\\right] \\right)\n$$\n$$\n\\Delta(t) = \\left( v - \\frac{kv}{k_a+k} \\right)t + \\frac{\\gamma k v}{(k_a+k)^2}\\left[1 - \\exp\\left(-\\frac{k_a+k}{\\gamma}t\\right)\\right]\n$$\n$$\n\\Delta(t) = \\frac{v(k_a+k) - kv}{k_a+k}t + \\frac{\\gamma k v}{(k_a+k)^2}\\left[1 - \\exp\\left(-\\frac{k_a+k}{\\gamma}t\\right)\\right]\n$$\n延迟 $\\Delta(t)$ 的闭式表达式为：\n$$\n\\Delta(t) = \\frac{k_a v}{k_a+k}t + \\frac{\\gamma k v}{(k_a+k)^2}\\left[1 - \\exp\\left(-\\frac{k_a+k}{\\gamma}t\\right)\\right]\n$$\n\n**4. 延迟的数值计算**\n\n我们需要用给定的参数计算在 $t^{\\ast} = 0.5\\,\\mathrm{ns}$ 时的 $\\Delta(t^{\\ast})$。首先，我们必须确保单位一致。我们将使用基于皮牛顿 ($\\mathrm{pN}$)、纳米 ($\\mathrm{nm}$) 和纳秒 ($\\mathrm{ns}$) 的单位制。\n参数如下：\n- $k_{a} = 200\\,\\mathrm{pN/nm}$\n- $k = 100\\,\\mathrm{pN/nm}$\n- $v = 5\\,\\mathrm{nm/ns}$\n- $t^{\\ast} = 0.5\\,\\mathrm{ns}$\n- $\\gamma = 3.0 \\times 10^{-12}\\,\\mathrm{kg/s}$\n\n我们将 $\\gamma$ 转换为我们选择的单位：\n$1\\,\\mathrm{kg/s} = 1 \\frac{\\mathrm{N}\\cdot\\mathrm{s}}{\\mathrm{m}} = \\frac{(10^{12}\\,\\mathrm{pN})\\cdot(10^9\\,\\mathrm{ns})}{10^9\\,\\mathrm{nm}} = 10^{12}\\,\\mathrm{pN \\cdot ns/nm}$。\n所以，$\\gamma = 3.0 \\times 10^{-12} \\frac{\\mathrm{kg}}{\\mathrm{s}} = 3.0 \\times 10^{-12} \\times 10^{12}\\,\\mathrm{pN \\cdot ns/nm} = 3.0\\,\\mathrm{pN} \\cdot \\mathrm{ns}/\\mathrm{nm}$。\n\n现在，我们计算 $\\Delta(t^{\\ast})$ 表达式的各个组成部分：\n- $k_a+k = 200\\,\\mathrm{pN/nm} + 100\\,\\mathrm{pN/nm} = 300\\,\\mathrm{pN/nm}$。\n指数项的参数是：\n$$\n\\frac{k_a+k}{\\gamma}t^{\\ast} = \\frac{300\\,\\mathrm{pN/nm}}{3.0\\,\\mathrm{pN \\cdot ns/nm}} \\times 0.5\\,\\mathrm{ns} = 100\\,\\mathrm{ns}^{-1} \\times 0.5\\,\\mathrm{ns} = 50\n$$\n$\\Delta(t^{\\ast})$ 中的第一项是：\n$$\n\\frac{k_a v}{k_a+k}t^{\\ast} = \\frac{200\\,\\mathrm{pN/nm} \\times 5\\,\\mathrm{nm/ns}}{300\\,\\mathrm{pN/nm}} \\times 0.5\\,\\mathrm{ns} = \\frac{2}{3} \\times 5 \\times 0.5\\,\\mathrm{nm} = \\frac{5}{3}\\,\\mathrm{nm}\n$$\n第二项的系数是：\n$$\n\\frac{\\gamma k v}{(k_a+k)^2} = \\frac{(3.0\\,\\mathrm{pN \\cdot ns/nm}) (100\\,\\mathrm{pN/nm}) (5\\,\\mathrm{nm/ns})}{(300\\,\\mathrm{pN/nm})^2} = \\frac{1500}{90000}\\,\\mathrm{nm} = \\frac{1}{60}\\,\\mathrm{nm}\n$$\n组合这些部分来求 $\\Delta(t^{\\ast})$：\n$$\n\\Delta(t^{\\ast}) = \\frac{5}{3}\\,\\mathrm{nm} + \\frac{1}{60}\\,\\mathrm{nm} \\left[1 - \\exp(-50)\\right]\n$$\n$\\exp(-50)$ 的值约等于 $1.9 \\times 10^{-22}$，可以忽略不计。因此，方括号中的项实际上为 $1$。\n$$\n\\Delta(t^{\\ast}) \\approx \\frac{5}{3}\\,\\mathrm{nm} + \\frac{1}{60}\\,\\mathrm{nm} = \\left(\\frac{100}{60} + \\frac{1}{60}\\right)\\,\\mathrm{nm} = \\frac{101}{60}\\,\\mathrm{nm}\n$$\n计算数值：\n$$\n\\Delta(t^{\\ast}) \\approx 1.68333... \\,\\mathrm{nm}\n$$\n四舍五入到四位有效数字，延迟为 $1.683\\,\\mathrm{nm}$。", "answer": "$$\n\\boxed{1.683}\n$$", "id": "3490235"}, {"introduction": "引导分子动力学不仅是一种观测工具，更是一种强大的测量手段。本练习将演示如何通过分析一个“向前-向后”牵引循环中的“滞回”（hysteresis）现象，来提取一个关键的物理参数——摩擦系数（friction coefficient）。你将看到，作为过程不可逆性体现的耗散功（dissipated work），其中蕴含了关于系统动力学的定量信息。[@problem_id:3490224]", "problem": "考虑一个受导向分子动力学 (Steered Molecular Dynamics, SMD) 拉伸的一维过阻尼坐标。控制参数（势阱中心）按分段恒速方案驱动：首先以速度 $v$ 正向移动位移 $L$，然后立即以相同的速度 $v$ 反向回到原点。该系统是简谐的，有效刚度为 $k$，并服从摩擦系数为 $\\zeta$ 的过阻尼动力学。在时间 $t$ 的保守势为 $U(x,t)=\\tfrac{1}{2}k\\left(x-\\lambda(t)\\right)^{2}$，其中 $\\lambda(t)$ 是外部施加的势阱位置。假设在 $t=0$ 时处于初始平衡状态，且 $\\lambda(0)=0$，一个持续时间为 $T=L/v$ 的正向拉伸段紧接着一个相同持续时间的反向段。\n\n从过阻尼朗之万方程和通过改变控制参数所做的热力学功的标准定义出发，推导每个阶段的平均耗散功 $\\langle W_{\\text{diss}}\\rangle$（用 $k$、$ \\zeta$、$L$ 和 $v$ 表示），无需预先假设任何极限情况。然后，通过将正向和反向段组合成一个完整的循环，将磁滞回线面积（等于封闭协议过程中的总耗散功）$\\mathcal{A}(v)$ 表示为 $k$、$\\zeta$、$L$ 和 $v$ 的函数。使用小 $v$ 展开来确定 $\\mathcal{A}(v)$ 如何随 $v$ 缩放，并识别其领头阶系数。基于此，设计一个线性回归分析，以便在固定 $L$ 的情况下，从平均耗散功对小速度 $v$ 的斜率 $s$ 中提取 $\\zeta$。具体来说，定义一个在线性响应区域内有效的估计量 $\\hat{\\zeta}=s/(2L)$。\n\n你的任务是实现一个完整、可运行的程序，该程序：\n- 对于下面每个测试用例参数集，使用你推导的表达式计算每个指定 $v$ 的精确平均磁滞面积 $\\mathcal{A}(v)$。\n- 对 $\\mathcal{A}(v)$ 与 $v$ 的关系进行普通最小二乘拟合，以获得斜率 $s$，然后为该测试用例计算 $\\hat{\\zeta}=s/(2L)$。\n- 汇总所有测试用例的结果，并将其打印为单行，其中包含一个用方括号括起来的逗号分隔的浮点数列表。每个浮点数必须是估计的摩擦系数 $\\hat{\\zeta}$，以 pN·ps/nm 为单位，并四舍五入到六位小数。\n\n所有量全程使用以下单位：$k$ 的单位是 pN/nm，$\\zeta$ 的单位是 pN·ps/nm，$L$ 的单位是 nm，$v$ 的单位是 nm/ps，时间的单位是 ps，功的单位是 pN·nm。不涉及角度。本问题中没有百分比。\n\n参数集测试套件：\n- 用例 1：$k=50$，$\\zeta=5$，$L=5$，$v\\in\\{0.02,0.04,0.06,0.08\\}$。\n- 用例 2：$k=10$，$\\zeta=1$，$L=10$，$v\\in\\{0.005,0.01,0.02\\}$。\n- 用例 3：$k=200$，$\\zeta=20$，$L=1$，$v\\in\\{0.5,1.0,2.0\\}$。\n- 用例 4：$k=30$，$\\zeta=3$，$L=0.5$，$v\\in\\{0.01,0.02,0.05,0.1\\}$。\n\n你的程序应产生单行输出，其中包含按顺序排列的用例 1 到 4 的估计摩擦系数，格式为方括号内逗号分隔的列表，每个值四舍五入到六位小数，单位为 pN·ps/nm（例如，“[$\\hat{\\zeta}_1,\\hat{\\zeta}_2,\\hat{\\zeta}_3,\\hat{\\zeta}_4$]”，但打印为不带单位的纯数字）。不应产生其他任何输出。", "solution": "用户提供的问题已被评估并确定为**有效**。它在非平衡统计力学方面有坚实的科学基础，问题陈述清晰，参数完备且一致，并以客观、正式的语言表述。任务是推导在一个特定拉伸方案下，谐振子势阱中粒子在一个循环内的平均耗散功，然后基于推导出的表达式实现数值分析。\n\n推导过程如下。\n\n**1. 运动方程与平均位置**\n\n系统由一维坐标 $x$ 描述，其遵循过阻尼朗之万方程：\n$$ \\zeta \\frac{dx}{dt} = -\\frac{\\partial U(x,t)}{\\partial x} + \\eta(t) $$\n其中 $\\zeta$ 是摩擦系数，$\\eta(t)$ 是一个热噪声项，其满足 $\\langle \\eta(t) \\rangle = 0$，势为 $U(x,t) = \\frac{1}{2}k(x-\\lambda(t))^2$。保守力为 $-\\frac{\\partial U}{\\partial x} = -k(x-\\lambda(t))$。\n\n对朗之万方程在所有噪声实现上取平均，得到平均位置 $\\langle x(t) \\rangle$ 的方程：\n$$ \\zeta \\frac{d\\langle x \\rangle}{dt} = -k(\\langle x \\rangle - \\lambda(t)) $$\n这可以用弛豫时间 $\\tau_R = \\zeta/k$ 来表示：\n$$ \\frac{d\\langle x \\rangle}{dt} + \\frac{1}{\\tau_R} \\langle x \\rangle = \\frac{1}{\\tau_R} \\lambda(t) $$\n问题将平均位置与势阱中心之间的延迟定义为 $\\delta(t) = \\langle x(t) \\rangle - \\lambda(t)$。对 $\\delta(t)$ 对时间求导，可得到一个关于延迟的直接方程：\n$$ \\frac{d\\delta}{dt} = \\frac{d\\langle x \\rangle}{dt} - \\frac{d\\lambda}{dt} = \\frac{1}{\\tau_R}(\\lambda(t) - \\langle x(t) \\rangle) - \\dot{\\lambda}(t) = -\\frac{1}{\\tau_R}\\delta(t) - \\dot{\\lambda}(t) $$\n$$ \\frac{d\\delta}{dt} + \\frac{1}{\\tau_R}\\delta(t) = -\\dot{\\lambda}(t) $$\n\n**2. 平均功与耗散功**\n\n外部协议对系统所做的功由下式给出：\n$$ W = \\int \\frac{\\partial U}{\\partial\\lambda} \\dot{\\lambda}(t) dt = \\int -k(x(t)-\\lambda(t))\\dot{\\lambda}(t) dt $$\n平均功通过对噪声取平均得到：\n$$ \\langle W \\rangle = \\int -k(\\langle x(t) \\rangle - \\lambda(t))\\dot{\\lambda}(t) dt = \\int -k\\delta(t)\\dot{\\lambda}(t) dt $$\n平均耗散功为 $\\langle W_{\\text{diss}} \\rangle = \\langle W \\rangle - \\Delta F$，其中 $\\Delta F$ 是系统平衡自由能的变化。对于谐振子势，自由能与势阱位置 $\\lambda$ 无关。因此，对于任何过程，$\\Delta F = 0$，且 $\\langle W_{\\text{diss}} \\rangle = \\langle W \\rangle$。\n\n**3. 正向拉伸段 ($0 \\le t \\le T$)**\n\n在正向段，势阱以恒定速度 $v$ 从 $\\lambda=0$ 移动到 $\\lambda=L$。因此，$\\lambda(t) = vt$ 且 $\\dot{\\lambda}(t)=v$。持续时间为 $T=L/v$。系统从平衡态开始，因此 $\\langle x(0) \\rangle=0$ 且 $\\lambda(0)=0$，这意味着初始延迟 $\\delta(0)=0$。正向延迟 $\\delta_F(t)$ 的常微分方程为：\n$$ \\frac{d\\delta_F}{dt} + \\frac{1}{\\tau_R}\\delta_F = -v $$\n在初始条件 $\\delta_F(0)=0$ 下，解为：\n$$ \\delta_F(t) = -v\\tau_R(1 - e^{-t/\\tau_R}) $$\n正向段的平均功为：\n$$ \\langle W_F \\rangle = \\int_0^T -k\\delta_F(t)v dt = kv\\int_0^T v\\tau_R(1-e^{-t/\\tau_R})dt = kv^2\\tau_R \\left[t+\\tau_Re^{-t/\\tau_R}\\right]_0^T $$\n$$ \\langle W_F \\rangle = kv^2\\tau_R \\left(T - \\tau_R(1-e^{-T/\\tau_R})\\right) $$\n代入 $T=L/v$ 和 $\\tau_R=\\zeta/k$：\n$$ \\langle W_F \\rangle = \\zeta v L - \\frac{\\zeta^2v^2}{k}\\left(1-e^{-kL/(v\\zeta)}\\right) $$\n\n**4. 反向拉伸段 ($T \\le t \\le 2T$)**\n\n在反向段，势阱以速度 $v$ 从 $\\lambda=L$ 回到 $\\lambda=0$。令 $t' = t-T$，其中 $0 \\le t' \\le T$。则 $\\lambda(t') = L-vt'$ 且 $\\dot{\\lambda}(t')=-v$。反向延迟 $\\delta_R(t')$ 的常微分方程为：\n$$ \\frac{d\\delta_R}{dt'} + \\frac{1}{\\tau_R}\\delta_R = v $$\n此段的初始条件是正向段的最终状态：$\\delta_R(t'=0) = \\delta_F(t=T) = -v\\tau_R(1-e^{-T/\\tau_R})$。解为：\n$$ \\delta_R(t') = \\left(\\delta_R(0) - v\\tau_R\\right)e^{-t'/\\tau_R} + v\\tau_R = \\left(-2v\\tau_R + v\\tau_Re^{-T/\\tau_R}\\right)e^{-t'/\\tau_R} + v\\tau_R $$\n反向段的平均功为：\n$$ \\langle W_R \\rangle = \\int_0^T -k\\delta_R(t')(-v) dt' = kv\\int_0^T \\delta_R(t') dt' $$\n计算该积分可得：\n$$ \\int_0^T \\delta_R(t')dt' = v\\tau_R \\left[ T - 2\\tau_R + 3\\tau_Re^{-T/\\tau_R} - \\tau_R e^{-2T/\\tau_R} \\right] $$\n因此功为：\n$$ \\langle W_R \\rangle = kv^2\\tau_R \\left( T - \\tau_R(2 - 3e^{-T/\\tau_R} + e^{-2T/\\tau_R}) \\right) $$\n代入 $T=L/v$ 和 $\\tau_R=\\zeta/k$：\n$$ \\langle W_R \\rangle = \\zeta v L - \\frac{\\zeta^2v^2}{k}\\left(2 - 3e^{-kL/(v\\zeta)} + e^{-2kL/(v\\zeta)}\\right) $$\n\n**5. 磁滞回线面积与线性响应**\n\n在闭合循环内的总耗散功，即磁滞面积 $\\mathcal{A}(v)$，是正向段和反向段做功之和：\n$$ \\mathcal{A}(v) = \\langle W_F \\rangle + \\langle W_R \\rangle $$\n$$ \\mathcal{A}(v) = 2\\zeta v L - \\frac{\\zeta^2 v^2}{k} \\left( (1-e^{-kL/(v\\zeta)}) + (2 - 3e^{-kL/(v\\zeta)} + e^{-2kL/(v\\zeta)}) \\right) $$\n$$ \\mathcal{A}(v) = 2\\zeta v L - \\frac{\\zeta^2 v^2}{k} \\left( 3 - 4e^{-kL/(v\\zeta)} + e^{-2kL/(v\\zeta)} \\right) $$\n这就是平均磁滞面积的精确表达式。\n\n为了进行分析，我们考虑小速度极限 ($v \\to 0$)。在此极限下，指数项的自变量 $u = kL/(v\\zeta) \\to \\infty$，因此 $e^{-u} \\to 0$。$\\mathcal{A}(v)$ 的表达式可以对小 $v$ 进行展开：\n$$ \\mathcal{A}(v) = 2\\zeta v L - \\frac{3\\zeta^2}{k}v^2 + \\mathcal{O}(v^2e^{-u}) $$\n领头阶项是关于 $v$ 的线性项：\n$$ \\mathcal{A}(v) \\approx 2\\zeta L v $$\n这种线性关系在准静态或线性响应区域 ($v \\ll kL/\\zeta$) 成立。$\\mathcal{A}(v)$ 对 $v$ 在 $v=0$ 处的斜率为 $s = 2\\zeta L$。这启发我们基于 $\\mathcal{A}$ vs. $v$ 的实验或模拟数据的线性回归，可以给出一个摩擦系数 $\\zeta$ 的估计量：\n$$ \\hat{\\zeta} = \\frac{s}{2L} $$\n其中 $s$ 是通过经验确定的斜率。\n\n下面的程序实现了这一分析，它首先计算一系列速度 $v$ 对应的精确磁滞面积 $\\mathcal{A}(v)$，然后执行普通最小二乘拟合以确定斜率 $s$ 和估计值 $\\hat{\\zeta}$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Steered Molecular Dynamics problem by calculating the estimated\n    friction coefficient for several test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (k, zeta_true, L, list_of_v)\n    test_cases = [\n        (50.0, 5.0, 5.0, [0.02, 0.04, 0.06, 0.08]),\n        (10.0, 1.0, 10.0, [0.005, 0.01, 0.02]),\n        (200.0, 20.0, 1.0, [0.5, 1.0, 2.0]),\n        (30.0, 3.0, 0.5, [0.01, 0.02, 0.05, 0.1]),\n    ]\n\n    results = []\n    for k, zeta_true, L, v_values in test_cases:\n        # Array of pulling speeds for the current test case\n        v_points = np.array(v_values, dtype=np.float64)\n        A_points = []\n\n        # Calculate the exact mean hysteresis area A(v) for each speed v\n        for v in v_points:\n            # The argument of the exponential terms\n            u = k * L / (v * zeta_true)\n            \n            # The exact expression for the hysteresis area A(v)\n            term_in_paren = 3.0 - 4.0 * np.exp(-u) + np.exp(-2.0 * u)\n            A_v = 2.0 * zeta_true * v * L - (zeta_true**2 * v**2 / k) * term_in_paren\n            A_points.append(A_v)\n\n        A_points = np.array(A_points, dtype=np.float64)\n        \n        # Perform Ordinary Least Squares (OLS) regression to find the slope s of A(v) vs v.\n        # The slope s is given by cov(v, A) / var(v).\n        v_mean = np.mean(v_points)\n        A_mean = np.mean(A_points)\n        \n        # Using a numerically stable formula for the slope\n        numerator = np.sum((v_points - v_mean) * (A_points - A_mean))\n        denominator = np.sum((v_points - v_mean)**2)\n        \n        if denominator == 0:\n            # This case occurs if all v_points are the same.\n            # While not in the test suite, it's good practice for robustness.\n            slope_s = 0.0\n        else:\n            slope_s = numerator / denominator\n\n        # Calculate the estimated friction coefficient zeta_hat from the slope\n        zeta_hat = slope_s / (2.0 * L)\n        results.append(zeta_hat)\n\n    # Final print statement in the exact required format.\n    # The output is a single line with a comma-separated list of floats in square brackets,\n    # with each float rounded to six decimal places.\n    print(f\"[{','.join([f'{r:.6f}' for r in results])}]\")\n\nsolve()\n\n```", "id": "3490224"}, {"introduction": "在理解并测量了系统的响应之后，我们现在转向一个更高级的问题：如何设计一个能使能量耗散最小化的牵引方案？本练习将引入“热力学长度”（thermodynamic length）的概念，用以构建一个比简单的恒速牵引更高效的最优牵引路径。这项技术代表了提高自由能计算效率和准确性的前沿方法之一。[@problem_id:3490292]", "problem": "给定一个在一维集体变量 $\\lambda \\in [0,1]$ 空间中表述的导向分子动力学问题。一个谐波导向势在固定的持续时间 $\\tau$ 内施加一个预设的规程 $\\lambda(t)$，其耗散在线性响应范围内通过一个广义摩擦度规 $g(\\lambda)$ 来量化，该度规编码了沿集体变量的平衡力自相关。假设瞬时过剩功率为 $P_{\\mathrm{ex}}(t) = \\dot{\\lambda}(t)^2 g(\\lambda(t))$，因此总过剩功为 $W_{\\mathrm{ex}}[\\lambda(\\cdot)] = \\int_0^\\tau \\dot{\\lambda}(t)^2 g(\\lambda(t))\\, dt$。热力学长度定义为 $\\mathcal{L}[\\lambda(\\cdot)] = \\int_0^\\tau \\sqrt{\\dot{\\lambda}(t)^T g(\\lambda(t)) \\dot{\\lambda}(t)}\\, dt$，对于单调一维规程，其简化为 $\\mathcal{L} = \\int_0^1 \\sqrt{g(\\lambda)}\\, d\\lambda$。仅从牛顿定律、功的定义以及将摩擦度规 $g(\\lambda)$ 合理化为关联广义速度与过剩功率的线性响应系数的涨落-耗散关系出发，推导一种有原则的方法，来构建在 $\\lambda(0)=0$ 和 $\\lambda(\\tau)=1$ 之间固定路径的最小耗散时间参数化。使用变分法或从统计力学中经过充分检验的事实导出的不等式，来严格证明您的构建方法，并用路径泛函表示最小过剩功，这些泛函可以从 $g(\\lambda)$ 计算得出而无需模拟动力学过程。然后，作为比较，在相同的条件和持续时间 $\\tau$ 下，计算恒速拉伸规程 $\\lambda(t)=t/\\tau$ 的过剩功。所有能量必须以 $k_{\\mathrm{B}}T$ 为单位表示。\n\n您的程序必须实现所推导的公式，使用数值积分法对 $\\lambda$ 上的任何所需积分进行求值，以处理以下关于度规函数 $g(\\lambda)$ 和持续时间 $\\tau$ 的测试组：\n\n- 情况 1：$g(\\lambda) = 1$, $\\tau = 1$。\n- 情况 2：$g(\\lambda) = 1 + 4 \\lambda^2$, $\\tau = 1$。\n- 情况 3：$g(\\lambda) = \\exp(3\\lambda)$, $\\tau = 1$。\n- 情况 4：$g(\\lambda) = \\exp(3\\lambda)$, $\\tau = 2$。\n- 情况 5：$g(\\lambda) = (\\lambda + 10^{-3})^{-1/2}$, $\\tau = 1$。\n\n对于每种情况，计算两个量：最小耗散过剩功和恒速过剩功，均以 $k_{\\mathrm{B}}T$ 为单位，并四舍五入到六位小数。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果按以下顺序排列：\n$[$$W_{\\mathrm{min}}^{(1)}$, $W_{\\mathrm{cv}}^{(1)}$, $W_{\\mathrm{min}}^{(2)}$, $W_{\\mathrm{cv}}^{(2)}$, $W_{\\mathrm{min}}^{(3)}$, $W_{\\mathrm{cv}}^{(3)}$, $W_{\\mathrm{min}}^{(4)}$, $W_{\\mathrm{cv}}^{(4)}$, $W_{\\mathrm{min}}^{(5)}$, $W_{\\mathrm{cv}}^{(5)}$$]$。\n\n所有数值积分必须以足够的精度执行，以确保四舍五入到六位小数的结果是明确的。答案必须是一个完整的、可运行的程序，该程序能准确打印指定的单行输出，并且不需要用户输入或外部文件。", "solution": "## 问题验证\n\n### 步骤 1：提取已知条件\n- **集体变量**：单个一维变量 $\\lambda \\in [0,1]$。\n- **规程**：在固定持续时间 $\\tau$ 内的时间参数化 $\\lambda(t)$。\n- **边界条件**：$\\lambda(0)=0$ 和 $\\lambda(\\tau)=1$。\n- **摩擦度规**：一个广义摩擦度规 $g(\\lambda)$，关联广义速度与过剩功率。\n- **瞬时过剩功率**：$P_{\\mathrm{ex}}(t) = \\dot{\\lambda}(t)^2 g(\\lambda(t))$。\n- **总过剩功**：$W_{\\mathrm{ex}}[\\lambda(\\cdot)] = \\int_0^\\tau \\dot{\\lambda}(t)^2 g(\\lambda(t))\\, dt$。\n- **热力学长度**：对于单调一维规程，$\\mathcal{L} = \\int_0^1 \\sqrt{g(\\lambda)}\\, d\\lambda$。\n- **能量单位**：所有能量必须以 $k_{\\mathrm{B}}T$ 为单位表示。\n- **任务**：\n    1. 推导一种构建最小耗散时间参数化 $\\lambda(t)$ 的方法。\n    2. 使用变分法或推导出的不等式证明该构建方法。\n    3. 用 $g(\\lambda)$ 的路径泛函表示最小过剩功 $W_{\\mathrm{min}}$。\n    4. 计算恒速规程 $\\lambda(t)=t/\\tau$ 的过剩功 $W_{\\mathrm{cv}}$。\n- **测试用例**：\n    - 情况 1：$g(\\lambda) = 1$, $\\tau = 1$。\n    - 情况 2：$g(\\lambda) = 1 + 4 \\lambda^2$, $\\tau = 1$。\n    - 情况 3：$g(\\lambda) = \\exp(3\\lambda)$, $\\tau = 1$。\n    - 情况 4：$g(\\lambda) = \\exp(3\\lambda)$, $\\tau = 2$。\n    - 情况 5：$g(\\lambda) = (\\lambda + 10^{-3})^{-1/2}$, $\\tau = 1$。\n- **输出格式**：单行逗号分隔值：$[W_{\\mathrm{min}}^{(1)}, W_{\\mathrm{cv}}^{(1)}, \\dots, W_{\\mathrm{min}}^{(5)}, W_{\\mathrm{cv}}^{(5)}]$，数值四舍五入到六位小数。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，是适定且客观的。\n- **科学依据**：该表述是线性响应理论和热力学几何在非平衡统计力学中的一个标准且成熟的应用，特别是在导向分子动力学的背景下。过剩功和热力学长度的表达式是规范的。\n- **适定性**：该问题是一个经典的优化控制问题（具体来说，是一个重参数化问题），旨在找到一个函数 $\\lambda(t)$，使其在明确定义的边界条件下最小化给定的泛函 $W_{\\mathrm{ex}}$。存在唯一解，并且需要求出该解。\n- **客观性与清晰度**：问题使用精确的数学和物理术语陈述。定义和目标没有歧义。测试用例是具体的，能够进行明确的数值评估。\n\n### 步骤 3：结论与行动\n问题是**有效的**。将构建一个有原则的解决方案。\n\n## 推导与求解\n\n主要目标是找到时间参数化 $\\lambda:[0, \\tau] \\rightarrow [0, 1]$，以最小化总过剩功泛函，\n$$\nW_{\\mathrm{ex}}[\\lambda(\\cdot)] = \\int_0^\\tau g(\\lambda(t)) \\dot{\\lambda}(t)^2 \\, dt\n$$\n并满足边界条件 $\\lambda(0)=0$ 和 $\\lambda(\\tau)=1$。此处，$\\dot{\\lambda}(t)$ 表示时间导数 $d\\lambda/dt$。\n\n我们将使用从积分的柯西-施瓦茨不等式推导出的一个不等式来推导最小功。柯西-施瓦茨不等式指出，对于区间 $[a,b]$ 上的任意两个实值平方可积函数 $f(t)$ 和 $h(t)$，\n$$\n\\left( \\int_a^b f(t) h(t) \\, dt \\right)^2 \\le \\left( \\int_a^b f(t)^2 \\, dt \\right) \\left( \\int_a^b h(t)^2 \\, dt \\right)\n$$\n当且仅当一个函数是另一个函数的常数倍时，即对于某个常数 $c$，有 $f(t) = c \\cdot h(t)$，等号成立。\n\n让我们定义函数 $f(t) = \\sqrt{g(\\lambda(t))} \\dot{\\lambda}(t)$ 和 $h(t) = 1$，积分区间为 $[0, \\tau]$。应用该不等式：\n$$\n\\left( \\int_0^\\tau \\left(\\sqrt{g(\\lambda(t))} \\dot{\\lambda}(t)\\right) \\cdot 1 \\, dt \\right)^2 \\le \\left( \\int_0^\\tau \\left(\\sqrt{g(\\lambda(t))} \\dot{\\lambda}(t)\\right)^2 \\, dt \\right) \\left( \\int_0^\\tau 1^2 \\, dt \\right)\n$$\n我们来分析这个不等式中的每一项。\n\n右侧的项是总过剩功 $W_{\\mathrm{ex}}$ 和总持续时间 $\\tau$ 的乘积：\n$$\n\\left( \\int_0^\\tau g(\\lambda(t)) \\dot{\\lambda}(t)^2 \\, dt \\right) \\left( \\int_0^\\tau 1 \\, dt \\right) = W_{\\mathrm{ex}} \\cdot \\tau\n$$\n\n左侧的项可以通过变量替换（从 $t$ 换为 $\\lambda$）来简化。由于 $d\\lambda = \\dot{\\lambda}(t) dt$，积分变为：\n$$\n\\int_0^\\tau \\sqrt{g(\\lambda(t))} \\dot{\\lambda}(t) \\, dt = \\int_{\\lambda(0)}^{\\lambda(\\tau)} \\sqrt{g(\\lambda)} \\, d\\lambda = \\int_0^1 \\sqrt{g(\\lambda)} \\, d\\lambda\n$$\n这个积分正是 $\\lambda$ 空间中路径的热力学长度的定义，记为 $\\mathcal{L}$。\n$$\n\\mathcal{L} = \\int_0^1 \\sqrt{g(\\lambda)} \\, d\\lambda\n$$\n将这些表达式代回柯西-施瓦茨不等式，我们得到：\n$$\n\\mathcal{L}^2 \\le W_{\\mathrm{ex}} \\cdot \\tau\n$$\n这为任何持续时间为 $\\tau$ 的规程 $\\lambda(t)$ 的过剩功提供了一个下界：\n$$\nW_{\\mathrm{ex}} \\ge \\frac{\\mathcal{L}^2}{\\tau}\n$$\n最小可能过剩功 $W_{\\mathrm{min}}$ 就是这个下界，当柯西-施瓦茨不等式中的等号成立时达到。这发生在 $f(t) = c \\cdot h(t)$ 时，即：\n$$\n\\sqrt{g(\\lambda(t))} \\dot{\\lambda}(t) = c\n$$\n其中 $c$ 是一个常数。这个条件规定了沿路径的速度，以热力学长度的度规 $\\sqrt{g(\\lambda)} \\frac{d\\lambda}{dt}$ 来衡量，是恒定的。常数 $c$ 可以通过对这个微分方程在整个持续时间内积分来确定：\n$$\n\\int_0^1 \\sqrt{g(\\lambda)} \\, d\\lambda = \\int_0^\\tau c \\, dt \\implies \\mathcal{L} = c \\tau \\implies c = \\frac{\\mathcal{L}}{\\tau}\n$$\n存在满足此条件的规程证实了该最小值是可以达到的。因此，最小过剩功为：\n$$\nW_{\\mathrm{min}} = \\frac{\\mathcal{L}^2}{\\tau} = \\frac{1}{\\tau} \\left( \\int_0^1 \\sqrt{g(\\lambda)} \\, d\\lambda \\right)^2\n$$\n该表达式仅取决于摩擦度规 $g(\\lambda)$ 和总时间 $\\tau$，它们分别是可从平衡性质和实验设置中计算的量，而无需模拟非平衡过程。\n\n接下来，我们推导恒速规程 $\\lambda_{\\mathrm{cv}}(t) = t/\\tau$ 的过剩功。对于此规程，速度是恒定的：$\\dot{\\lambda}_{\\mathrm{cv}}(t) = 1/\\tau$。\n过剩功 $W_{\\mathrm{cv}}$ 通过将此规程代入 $W_{\\mathrm{ex}}$ 的定义来计算：\n$$\nW_{\\mathrm{cv}} = \\int_0^\\tau g(\\lambda_{\\mathrm{cv}}(t)) \\dot{\\lambda}_{\\mathrm{cv}}(t)^2 \\, dt = \\int_0^\\tau g(t/\\tau) \\left(\\frac{1}{\\tau}\\right)^2 \\, dt\n$$\n$$\nW_{\\mathrm{cv}} = \\frac{1}{\\tau^2} \\int_0^\\tau g(t/\\tau) \\, dt\n$$\n为了计算这个积分，我们再次进行变量替换，令 $\\lambda = t/\\tau$。这得到 $dt = \\tau \\, d\\lambda$，且 $\\lambda$ 的积分限为从 0 到 1。\n$$\nW_{\\mathrm{cv}} = \\frac{1}{\\tau^2} \\int_0^1 g(\\lambda) (\\tau \\, d\\lambda) = \\frac{1}{\\tau} \\int_0^1 g(\\lambda) \\, d\\lambda\n$$\n\n总而言之，每个测试用例需要计算的两个量是：\n1. 最小耗散过剩功：$W_{\\mathrm{min}} = \\frac{1}{\\tau} \\left( \\int_0^1 \\sqrt{g(\\lambda)} \\, d\\lambda \\right)^2$\n2. 恒速过剩功：$W_{\\mathrm{cv}} = \\frac{1}{\\tau} \\int_0^1 g(\\lambda) \\, d\\lambda$\n\n这些公式将通过使用数值积分法来计算关于 $\\lambda$ 的积分来实现。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Solves the steered molecular dynamics problem for five test cases.\n\n    For each case, it calculates two quantities:\n    1. W_min: The minimal-dissipation excess work, derived from thermodynamic\n       geometry principles.\n    2. W_cv: The excess work for a simple constant-velocity pulling protocol.\n\n    The results are formatted and printed as a single line, as specified.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple containing a lambda function for g(lambda) and the duration tau.\n    test_cases = [\n        (lambda lam: 1.0, 1.0),\n        (lambda lam: 1.0 + 4.0 * lam**2, 1.0),\n        (lambda lam: np.exp(3.0 * lam), 1.0),\n        (lambda lam: np.exp(3.0 * lam), 2.0),\n        (lambda lam: (lam + 1e-3)**(-0.5), 1.0),\n    ]\n\n    results = []\n    for g_func, tau in test_cases:\n        # --- Minimal Excess Work Calculation ---\n\n        # The integrand for the thermodynamic length L is sqrt(g(lambda)).\n        L_integrand = lambda lam: np.sqrt(g_func(lam))\n\n        # Numerically integrate to find the thermodynamic length L.\n        # quad returns the result and an error estimate; we only need the result.\n        # The integration limits are from lambda = 0 to lambda = 1.\n        L, _ = quad(L_integrand, 0, 1, epsabs=1e-12, epsrel=1e-12)\n\n        # The minimal excess work is W_min = L^2 / tau.\n        W_min = (L**2) / tau\n\n        # --- Constant-Velocity Excess Work Calculation ---\n\n        # The integrand for the constant-velocity work is g(lambda) itself.\n        g_integrand = g_func\n        \n        # Numerically integrate g(lambda) from 0 to 1.\n        integral_g, _ = quad(g_integrand, 0, 1, epsabs=1e-12, epsrel=1e-12)\n\n        # The constant-velocity work is W_cv = (integral of g) / tau.\n        W_cv = integral_g / tau\n\n        # Append the rounded results to the list for final output.\n        # We format to 6 decimal places as required.\n        results.append(f\"{W_min:.6f}\")\n        results.append(f\"{W_cv:.6f}\")\n\n    # Final print statement in the exact required format.\n    # Example: [1.000000,1.000000,2.187271,...]\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3490292"}]}