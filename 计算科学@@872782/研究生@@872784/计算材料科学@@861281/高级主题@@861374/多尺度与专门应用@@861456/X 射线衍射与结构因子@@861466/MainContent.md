## 引言
X射线衍射（XRD）是揭示物质原子尺度结构的基石技术，而理解其核心概念——**结构因子**——则是从[衍射图样](@entry_id:145356)解码晶体秘密的关键。对于任何希望深入研究材料的学者而言，一个根本性的问题是：我们如何将一幅由离[散光](@entry_id:174378)点或衍射环组成的图样，转化为一个精确的三维原子排布模型？这其中的数学与物理桥梁正是结构因子，然而，实验中固有的“相位信息丢失”问题（即“相位问题”）构成了[结构解析](@entry_id:174508)中最核心的挑战。

本文旨在为读者提供一个关于[结构因子](@entry_id:158623)的全面而深入的视角。我们将分三步展开：首先，在**“原理与机制”**一章中，我们将从第一性原理出发，系统构建结构因子的理论框架，阐明其与电子密度的关系，并探讨解决相位问题的经典方法。接着，在**“应用与跨学科[交叉](@entry_id:147634)”**一章中，我们将展示结构因子理论如何超越[理想晶体](@entry_id:138314)模型，应用于表征[化学有序](@entry_id:260645)、缺陷、纳米结构乃至电子有序等复杂现象，并与其他学科形成交叉。最后，通过**“动手实践”**部分，我们将理论知识与具体的计算问题联系起来。

通过本次学习，读者将不仅掌握[结构因子](@entry_id:158623)的计算和解读，更能体会到它作为一种强大分析工具，在现代[材料科学](@entry_id:152226)研究与工程设计中的深远影响。让我们首先深入其根本，探索结构因子的基本原理与机制。

## 原理与机制

在上一章引言的基础上，本章深入探讨[X射线衍射](@entry_id:147790)（XRD）分析的核心——[结构因子](@entry_id:158623)。我们将从第一性原理出发，系统阐述结构因子的定义、计算方法及其与晶体电子密度之间的深刻联系。本章旨在揭示如何通过分析衍射峰的位置与强度，来反演晶体内部的原子排布、对称性、无序及热[振动](@entry_id:267781)等关键信息。

### [结构因子](@entry_id:158623)：电子密度的[傅里叶变换](@entry_id:142120)

晶体最根本的特征是其内部电子密度 $\rho(\mathbf{r})$ 的周期性。这种周期性与[晶格](@entry_id:196752)的[平移对称性](@entry_id:171614)完全一致。任何一个具有[晶格](@entry_id:196752)平移周期性的函数，都可以被展开为一组具有相同周期性的平面[波的叠加](@entry_id:166456)，这在数学上被称为[傅里叶级数](@entry_id:139455)。这组[基函数](@entry_id:170178)由倒易点阵矢量 $\mathbf{G}$ 定义，傅里叶级数可以写作：

$$
\rho(\mathbf{r}) = \sum_{\mathbf{G}} \rho_{\mathbf{G}} e^{i\mathbf{G}\cdot\mathbf{r}}
$$

其中，$\rho_{\mathbf{G}}$ 是对应于倒易点阵矢量 $\mathbf{G}$ 的傅里叶系数。为了求解这些系数，我们利用平面波在单个[晶胞](@entry_id:143489)（体积为 $V_{\text{cell}}$）内的正交性。将上式两边乘以 $e^{-i\mathbf{G}'\cdot\mathbf{r}}$ 并在[晶胞体积](@entry_id:173348)[内积](@entry_id:158127)分，可以得到：

$$
\int_{V_{\text{cell}}} \rho(\mathbf{r}) e^{-i\mathbf{G}'\cdot\mathbf{r}} d^3\mathbf{r} = \sum_{\mathbf{G}} \rho_{\mathbf{G}} \int_{V_{\text{cell}}} e^{i(\mathbf{G}-\mathbf{G}')\cdot\mathbf{r}} d^3\mathbf{r}
$$

根据[正交关系](@entry_id:145540)，右侧的积分仅在 $\mathbf{G} = \mathbf{G}'$ 时为非零值 $V_{\text{cell}}$。因此，我们得到了[傅里叶系数](@entry_id:144886)的表达式。这个积分本身，正是[晶体学](@entry_id:140656)中至关重要的 **[结构因子](@entry_id:158623)** (structure factor) $F(\mathbf{G})$ 的定义：

$$
F(\mathbf{G}) \equiv \int_{V_{\text{cell}}} \rho(\mathbf{r}) e^{-i\mathbf{G}\cdot\mathbf{r}} d^3\mathbf{r}
$$

因此，傅里叶系数与结构因子之间的关系为 $\rho_{\mathbf{G}} = F(\mathbf{G}) / V_{\text{cell}}$。将此关系代回电子密度的[傅里叶级数](@entry_id:139455)，我们便建立了从[结构因子](@entry_id:158623)重构电子密度的[逆关系](@entry_id:274206) [@problem_id:3504301]：

$$
\rho(\mathbf{r}) = \frac{1}{V_{\text{cell}}} \sum_{\mathbf{G}} F(\mathbf{G}) e^{i\mathbf{G}\cdot\mathbf{r}}
$$

这个方程是[晶体结构分析](@entry_id:194021)的理论基石。它表明，如果我们能够获知所有倒易点阵矢量 $\mathbf{G}$ 对应的[结构因子](@entry_id:158623) $F(\mathbf{G})$，我们原则上就可以通过傅里叶合成，精确地绘制出[晶胞](@entry_id:143489)内的三维电子密度[分布](@entry_id:182848)图，从而确定原子位置。

### [晶体学](@entry_id:140656)中的“相位问题”

然而，理论上的完美通路在实验中遇到了一个根本性障碍。[X射线衍射](@entry_id:147790)实验测量的是衍射强度 $I(\mathbf{G})$，它与结构因子幅值的平方成正比，即 $I(\mathbf{G}) \propto |F(\mathbf{G})|^2$。结构因子 $F(\mathbf{G})$ 通常是一个复数，可以写作极坐标形式 $F(\mathbf{G}) = |F(\mathbf{G})| e^{i\phi_{\mathbf{G}}}$，其中 $|F(\mathbf{G})|$ 是幅值，$\phi_{\mathbf{G}}$ 是 **相位** (phase)。实验测量只能给出幅值信息，而相位信息则完全丢失了。

重构电子密度的傅里叶[合成方程](@entry_id:260669)需要完整的复数[结构因子](@entry_id:158623) $F(\mathbf{G})$：

$$
\rho(\mathbf{r}) = \frac{1}{V_{\text{cell}}} \sum_{\mathbf{G}} |F(\mathbf{G})| e^{i\phi_{\mathbf{G}}} e^{i\mathbf{G}\cdot\mathbf{r}} = \frac{1}{V_{\text{cell}}} \sum_{\mathbf{G}} |F(\mathbf{G})| e^{i(\mathbf{G}\cdot\mathbf{r} + \phi_{\mathbf{G}})}
$$

从上式可以看出，在空间中任一点 $\mathbf{r}$ 的电子密度值，是大量平面波叠加的结果。这种叠加是相干的，其结果（相长或[相消干涉](@entry_id:170966)）极度依赖于每个波的总相位 $(\mathbf{G}\cdot\mathbf{r} + \phi_{\mathbf{G}})$。没有正确的相位 $\phi_{\mathbf{G}}$，就不可能进行正确的傅里叶合成。对同一组衍射强度（即同一组 $|F(\mathbf{G})|$），任意猜测一组相位，都会得到一个不同的、几乎肯定是错误的[电子密度图](@entry_id:178324)。这个从衍射强度中无法直接获得相位信息的难题，被称为 **相位问题** (phase problem)。它是[晶体结构](@entry_id:140373)解析中最核心的挑战 [@problem_id:3504301]。

### 结构因子的解构：[晶格与基元](@entry_id:156406)

为了更深入地理解[结构因子](@entry_id:158623)的物理意义，我们可以将一个[完美晶体](@entry_id:138314)的结构看作两个部分的卷积：一个是在布拉维[晶格](@entry_id:196752)点上排布的无穷点阵，代表了晶体的平移对称性；另一个是位于[晶胞](@entry_id:143489)原点的单个 **基元** (motif or basis)，即晶胞内的原[子集](@entry_id:261956)团。根据[卷积定理](@entry_id:264711)，两个函数卷积的[傅里叶变换](@entry_id:142120)等于它们各自[傅里叶变换](@entry_id:142120)的乘积 [@problem_id:3504282]。

1.  **[晶格](@entry_id:196752)的贡献**：无穷布拉维[晶格](@entry_id:196752)的点阵函数，其[傅里叶变换](@entry_id:142120)是[倒易晶格](@entry_id:136718)。它是一系列在倒易点阵矢量 $\mathbf{G}$ 处的 $\delta$ 函数。这决定了衍射只会在满足[布拉格条件](@entry_id:271151)的特定方向上（即[散射矢量](@entry_id:262662) $\mathbf{q}$ 等于某个 $\mathbf{G}$ 时）产生尖锐的衍射峰。换言之，**布拉维[晶格](@entry_id:196752)的类型和尺寸决定了衍射峰的位置**。

2.  **基元的贡献**：基元的[傅里叶变换](@entry_id:142120)正是我们之前定义的结构因子 $F(\mathbf{G})$。它描述了当满足[布拉格条件](@entry_id:271151)时，从[晶胞](@entry_id:143489)内不同原子散射出的波如何相互干涉。因此，**基元的原子组成和构型决定了每个衍射峰的强度**。

这种分离是理解[衍射图样](@entry_id:145356)的关键：[晶格](@entry_id:196752)决定了“哪里有峰”，基元决定了“峰有多强”。

### [结构因子](@entry_id:158623)的计算：[原子形状因子](@entry_id:137357)与相干涉

基于上述分离，我们可以推导出一个更具物理直观的[结构因子](@entry_id:158623)计算公式。晶胞的电子密度可以看作是其中所有原子电子密度的总和。若晶胞内有 $N$ 个原子，第 $j$ 个原子位于分数坐标 $\mathbf{r}_j$ 处，其自身的电子密度为 $\rho_{at,j}(\mathbf{r})$，则总的结构因子可以写为 [@problem_id:3504290]：

$$
F(\mathbf{G}) = \sum_{j=1}^{N} f_j(\mathbf{G}) e^{-i2\pi(hx_j + ky_j + lz_j)}
$$

其中，$(h,k,l)$ 是对应于 $\mathbf{G}$ 的[密勒指数](@entry_id:138901)，$\mathbf{r}_j = (x_j, y_j, z_j)$ 是第 $j$ 个原子的分数坐标。这个公式包含两个核心部分：

-   **[原子形状因子](@entry_id:137357) (atomic form factor)** $f_j(\mathbf{G})$：它是单个原子电子云的[傅里叶变换](@entry_id:142120)，$f_j(\mathbf{G}) = \int \rho_{at,j}(\mathbf{r'}) e^{-i\mathbf{G}\cdot\mathbf{r'}} d^3\mathbf{r'}$。它描述了单个原子的散射能力。由于原子内部不同位置电子的散射波之间也会发生干涉，[原子形状因子](@entry_id:137357)通常随[散射矢量](@entry_id:262662)大小 $|\mathbf{G}|$ (或[散射角](@entry_id:171822)) 的增加而减小。在零角度散射时，$f_j(0)$ 等于原子的总电子数 $Z_j$。

-   **相位因子 (phase factor)** $e^{-i2\pi(hx_j + ky_j + lz_j)}$：这个[复指数](@entry_id:162635)项完全由原子在晶胞内的位置 $\mathbf{r}_j$ 和特定的衍射指标 $(h,k,l)$ 决定。它代表了从位于 $\mathbf{r}_j$ 的原子散射的波，相对于从[晶胞](@entry_id:143489)原点散射的波所产生的相位差。

总的[结构因子](@entry_id:158623)是晶胞内所有原子贡献的矢量和。每个原子的贡献是一个复数，其幅值是 $f_j$，相位由其位置决定。这些复数的相加结果（相长或相消干涉）决定了最终的衍射强度。

例如，考虑一个简[立方晶格](@entry_id:148452)，[晶胞](@entry_id:143489)内有三个原子，分别位于 $(0,0,0)$，$(\frac{1}{2},\frac{1}{2},0)$ 和 $(\frac{1}{2},0,\frac{1}{2})$，其[原子形状因子](@entry_id:137357)分别为 $f_1, f_2, f_3$。[结构因子](@entry_id:158623)表达式为 [@problem_id:3504290]：

$$
F_{hkl} = f_1 + f_2 e^{-i\pi(h+k)} + f_3 e^{-i\pi(h+l)} = f_1 + f_2 (-1)^{h+k} + f_3 (-1)^{h+l}
$$

对于 $(112)$ 衍射，$h+k=2$（偶数），$h+l=3$（奇数），因此 $F_{112} = f_1 + f_2 - f_3$。原子1和2的散射波发生相长干涉，而原子3的散射波与之发生相消干涉。
对于 $(211)$ 衍射，$h+k=3$（奇数），$h+l=3$（奇数），因此 $F_{211} = f_1 - f_2 - f_3$。原子2和3的散射波均与原子1发生相消干涉。
即使这两个衍射的 $|\mathbf{G}|$ 值相同（即[原子形状因子](@entry_id:137357)的值 $f_j$ 相同），由于原子间干涉方式的显著不同，它们的衍射强度 $|F_{hkl}|^2$ 也将截然不同。

### 系统消光与[空间群对称性](@entry_id:204211)

原子间的干涉效应在具有特定对称性的晶体中会产生一种重要现象：**系统消光** (systematic absences)。当晶胞内原子的排布受到空间群[对称操作](@entry_id:143398)（如滑移面、螺旋轴）的约束时，对于某些特定类别的 $(hkl)$ 衍射，[结构因子](@entry_id:158623) $F_{hkl}$ 的计算结果恒为零，导致这些衍射峰完全消失。

一个经典的例子是岩盐（NaCl）结构，其[空间群](@entry_id:143034)为 $Fm\overline{3}m$。它具有[面心立方](@entry_id:156319)（FCC）[晶格](@entry_id:196752)，基元为位于 $(0,0,0)$ 的Na$^+$和位于 $(\frac{1}{2},\frac{1}{2},\frac{1}{2})$ 的Cl$^-$。首先，FCC[晶格](@entry_id:196752)本身的[平移对称性](@entry_id:171614)（存在位于面心的格点）要求只有当 $h,k,l$ 的奇偶性相同时（全奇或全偶），衍射才可能发生，否则 $F_{hkl}=0$。这是 **[晶格类型](@entry_id:269667)** 导致的系统消光。

在此基础上，我们进一步考虑基元的影响。通过对晶胞内所有8个离子（4个Na$^+$和4个Cl$^-$）求和，可以推导出该结构的[结构因子](@entry_id:158623) [@problem_id:3504315]：
-   若 $h,k,l$ 全为偶数: $F_{hkl} = 4(f_{Na^+} + f_{Cl^-})$
-   若 $h,k,l$ 全为奇数: $F_{hkl} = 4(f_{Na^+} - f_{Cl^-})$
-   若 $h,k,l$ 奇偶混合: $F_{hkl} = 0$

这里没有因为基元而产生额外的消光规律，但基元影响了允许衍射的强度。全偶指标的衍射强度与 $(f_A+f_B)^2$ 成正比，而全奇指标的衍射强度与 $(f_A-f_B)^2$ 成正比。这种由[空间群对称性](@entry_id:204211)决定的系统性强度变化规律，是鉴定晶体空间群的关键依据。需要强调的是，由对称性导致的系统消光是严格的，任何描述晶体电子密度的物理模型，只要它遵守该[空间群对称性](@entry_id:204211)，就必须重现这些消光 [@problem_id:3504294]。

### 真实晶体中的散射修正

以上讨论基于一个理想的、静态的[晶格模型](@entry_id:184345)。在真实晶体中，多种因素会修正散射行为，我们需要对模型进行扩展。

#### [原子形状因子](@entry_id:137357)的依赖性

[原子形状因子](@entry_id:137357) $f(Q)$ 随[散射矢量](@entry_id:262662)大小 $Q$（其中 $Q = |\mathbf{G}| = 2\pi/d_{hkl}$）的衰减是衍射物理中的一个普遍特征。这种衰减源于原子内部电子云的空间分布。一个空间上弥散的电子云，其[傅里叶变换](@entry_id:142120)在倒易空间中是局域化的，即随着 $Q$ 的增加而迅速减小。这一基本原理导致了一个重要观察：**高阶衍射通常比低阶衍射弱得多** [@problem_id:3504331]。例如，对于[体心立方](@entry_id:151336)（BCC）晶体，$(220)$ 衍射可以看作是 $(110)$ 晶面族的二级衍射。由于 $Q_{220} = 2Q_{110}$，即使不考虑其他因素，$(220)$ 峰的强度也会因为 $|f(Q_{220})|^2$ 远小于 $|f(Q_{110})|^2$ 而显著减弱。

更精细地看，原子的电子云可以分为两部分：紧密束缚的 **核心电子** 和参与成键的 **价电子** [@problem_id:3504294]。
-   核心电子密度在[实空间](@entry_id:754128)高度局域化（函数“窄”），其[傅里叶变换](@entry_id:142120)在[倒易空间](@entry_id:754151)中[分布](@entry_id:182848)很宽（衰减“慢”）。因此，**核心电子的散射主导了高角度（大$Q$）的衍射**。
-   价电子密度因成键而变得弥散，甚至在原子间形成共享区域（函数“宽”），其[傅里叶变换](@entry_id:142120)在[倒易空间](@entry_id:754151)中高度局域化（衰减“快”）。因此，**价电子的散射主要贡献于低角度（小$Q$）的衍射**。

这意味着，高角度衍射数据对确定[原子核](@entry_id:167902)的精确位置（即[晶体结构](@entry_id:140373)）至关重要，而低角度数据则包含了关于[化学键](@entry_id:138216)和电荷分布的宝贵信息。传统的 **独立[原子模型](@entry_id:137207) (IAM)** 假设每个原子的电子云是球对称的，这对于[核心电子](@entry_id:141520)是很好的近似，但忽略了价电子因成键而产生的各向异性。**多极[子模](@entry_id:148922)型** 通过在球对称基础上增加方向依赖的项（如[球谐函数](@entry_id:178380)），来描述这种成键导致的[电荷密度](@entry_id:144672)变形，从而能够更精确地拟合低角度衍射数据，并绘制出实验的成键[电子密度图](@entry_id:178324)。

#### 热运动：[德拜-瓦勒因子](@entry_id:142464)与热漫散射

真实晶体中的原子并非静止不动，而是在其[平衡位置](@entry_id:272392)附近[振动](@entry_id:267781)。这种热运动对衍射图样有两个主要影响 [@problem_id:3504293]。

首先，它会减弱[布拉格衍射](@entry_id:148063)峰的强度。在计算[结构因子](@entry_id:158623)时，我们需要对原子在[振动](@entry_id:267781)过程中的瞬时位置进行[时间平均](@entry_id:267915)。这种平均效应导致结构因子公式中的每一项都乘以一个衰减项，称为 **[德拜-瓦勒因子](@entry_id:142464)** (Debye-Waller factor) 或[温度因子](@entry_id:190408)。对于各向同性的热运动，该因子为 $e^{-W(Q)} = \exp(-B \sin^2\theta / \lambda^2)$，其中 $B$ 因子与原子位移的[均方根](@entry_id:263605) $\langle u^2 \rangle$ 成正比。由于衰减项的指数与 $Q^2$ 成正比，热运动对高角度衍射峰的削弱作用远大于低角度。

对于各向异性的热运动，衰减因子变为 $e^{-2\pi^2 \mathbf{G}^T U \mathbf{G}}$，其中 $U$ 是一个对称的 $3 \times 3$ 张量，称为 **各向异性位移参数 (ADP) 张量** [@problem_id:3504319]。$U$ 描述了原子在不同方向上位移概率的椭球[分布](@entry_id:182848)。通过精确测量大量衍射峰的强度，可以反解出每个原子的ADP张量，从而获得原子[振动](@entry_id:267781)模式的详细信息。

其次，从布拉格峰中“丢失”的强度并没有消失，而是以 **热漫散射 (Thermal Diffuse Scattering, TDS)** 的形式重新[分布](@entry_id:182848)在整个[倒易空间](@entry_id:754151)中，形成衍射峰之间平滑的背景。TDS的强度与 $(1 - e^{-2W(Q)})$ 成正比，因此它在高$Q$区域更强，正好与[布拉格峰](@entry_id:140755)的衰减互补。

#### [静态无序](@entry_id:144184)与漫散射

除了动态的热运动，晶体中还可能存在 **[静态无序](@entry_id:144184)**，例如在合金中不同种类的原子随机占据格点（替代无序）。这种无序同样会产生 **漫散射 (diffuse scattering)** [@problem_id:3504293]。考虑一个随机[二元合金](@entry_id:160005)，其[布拉格峰](@entry_id:140755)的强度由 **平均原子** 的[形状因子](@entry_id:152312) $\bar{f} = c f_A + (1-c) f_B$ 决定。而原子散射能力与其平均值的偏差，则导致了一个在倒易空间中[均匀分布](@entry_id:194597)的漫散射背景，其强度正比于 $c(1-c)(f_A-f_B)^2$。这种由替代无序产生的漫散射（称为劳厄单调散射）通常不随 $Q$ 变化，这与随 $Q$ 增加而增强的热漫散射形成鲜明对比。

### 求解相位问题：从统计到结构

虽然相位信息在实验中丢失了，但晶体学家们发展了精妙的方法来恢复它们。

#### [威尔逊统计](@entry_id:204323)：[中心对称](@entry_id:144242)与[非中心对称](@entry_id:157488)结构的甄别

在求解未知结构之前，分析衍射强度的[统计分布](@entry_id:182030)可以提供关于[晶体对称性](@entry_id:198772)的重要线索。一个关键的区别在于空间群是否包含 **反演对称中心**。含有反演中心的[空间群](@entry_id:143034)称为 **[中心对称](@entry_id:144242)的 (centric)**，不含的则称为 **[非中心对称](@entry_id:157488)的 (acentric)**。

根据中心极限定理，可以推导出这两种情况下归一化衍射强度 $z=I/\langle I \rangle$ 的理论[概率分布](@entry_id:146404)，这被称为 **[威尔逊统计](@entry_id:204323)** (Wilson statistics) [@problem_id:3504342]。
-   对于 **[非中心对称](@entry_id:157488)** 结构，原子位置随机，[结构因子](@entry_id:158623) $F_{hkl}$ 的实部和虚部可视为独立的、均值为零的高斯[随机变量](@entry_id:195330)。这导致其相位 $\phi_{hkl}$ 在 $[0, 2\pi)$ 上[均匀分布](@entry_id:194597)，而归一化强度 $z$ 服从指数分布 $P(z) = e^{-z}$。
-   对于 **中心对称** 结构，反演对称性迫使结构因子 $F_{hkl}$ 成为实数，其相位只能是 $0$ 或 $\pi$。这导致 $z$ 服从一个不同的[分布](@entry_id:182848) $P(z) = (2\pi z)^{-1/2} e^{-z/2}$。

这两种[分布](@entry_id:182848)有显著差异，例如，弱衍射点的出现概率在[中心对称](@entry_id:144242)结构中更高。通过将实验测得的强度分布与这两种理论[分布](@entry_id:182848)进行比较，可以在[结构解析](@entry_id:174508)的早期阶段可靠地判断[空间群](@entry_id:143034)是否是[中心对称](@entry_id:144242)的。

#### 直接法：利用物理约束推导相位

对于小分子晶体（通常少于约100个非氢原子），**直接法** (direct methods) 是解决相位问题的标准方法。其核心思想是，虽然相位本身是未知的，但它们之间并非完全独立，而是受到电子密度物理性质的约束 [@problem_id:3504285]。

最重要的两个物理约束是：
1.  **[正定性](@entry_id:149643) (Positivity)**：电子密度在任何地方都不能为负，即 $\rho(\mathbf{r}) \ge 0$。
2.  **原子性 (Atomicity)**：电子密度由一系列孤立的、基本解析的峰组成，每个峰对应一个原子。

赫伯特·豪普特曼 (Herbert A. Hauptman) 和杰尔姆·卡尔 (Jerome Karle)（1985年诺贝尔化学奖得主）证明，这些约束在数学上等价于[结构因子](@entry_id:158623)相位之间存在特定的概率关系。其中最著名的是 **三[相子](@entry_id:145875)关系 (triplet relationship)**。该关系指出，对于三个其倒易矢量之和为零的衍射（$\mathbf{h} + \mathbf{k} + (-\mathbf{h}-\mathbf{k}) = 0$），它们的相位之和 $\Phi_3 = \phi_{\mathbf{h}} + \phi_{\mathbf{k}} + \phi_{-\mathbf{h}-\mathbf{k}}$ 可能接近于零。这种关系成立的概率随着三个对应衍射的强度乘积 $|E_{\mathbf{h}} E_{\mathbf{k}} E_{-\mathbf{h}-\mathbf{k}}|$ 的增大而增大，其中 $|E|$ 是归一化的[结构因子](@entry_id:158623)幅值。

基于这一原理，直接法的计算流程大致如下：
1.  **归一化**：将测量的 $|F_{hkl}|$ 转换为归一化的 $|E_{hkl}|$，以消除[原子形状因子](@entry_id:137357)和热运动的影响。
2.  **寻找三[相子](@entry_id:145875)**：找出所有满足相位关系概率最高的强衍射三[相子](@entry_id:145875)组合。
3.  **相位确定**：通过固定几个强衍射的相位来确定[晶胞](@entry_id:143489)原点和手性，然后利用三[相子](@entry_id:145875)关系，像解数独一样，以链式反应的方式迭代地推导出其他衍射的相位。
4.  **傅里叶合成与精修**：用推导出的相位和测量的幅值计算初始的[电子密度图](@entry_id:178324)。通常，这张图已经能揭示出部分原子位置。然后通过 **[密度修正](@entry_id:198312)**（例如，将负密度区域设为零，削尖原子峰）来改善相位，并进行迭代，直至得到清晰的分子结构。

通过这些强大的原理和算法，[晶体学](@entry_id:140656)家能够从一堆衍射光点出发，最终揭示物质在原子尺度下的精确三维构造。