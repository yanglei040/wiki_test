{"hands_on_practices": [{"introduction": "要真正掌握多体微扰理论，不仅需要理解其理论框架，更要能动手解决具体问题。这个练习将帮助你巩固格林函数和自能等基本概念。通过一个精确可解的紧束缚模型 [@problem_id:3463231]，你将亲手推导在静态平均场（哈特里势）近似下，相互作用如何作为自能来重整化非相互作用体系的能带结构，这是理解相互作用如何改变单粒子性质的第一步。", "problem": "考虑一个无限长的一维紧束缚链，其格点常数为 $a$，在位能为 $\\epsilon_{0}$，最近邻跃迁振幅为 $t$。设每个格点的电子密度是均匀的，等于 $n$，并包含一个静态 Hartree 势 $U n$，该势在平均场水平上被处理为一个在位对角能量移动。在零温下进行计算，并忽略所有动态关联效应，这与静态自能近似一致。假设系统具有平移不变性和周期性边界条件，因此波矢 $k$ 是一个好量子数。\n\n使用多体微扰理论的基本定义和因果响应的推迟边界条件，推导此相互作用紧束缚体系在静态 Hartree 近似下的推迟单粒子格林函数 $G^{R}(k,\\omega)$ 和相应的谱函数 $A(k,\\omega)$ 的显式闭合表达式。用 $k$、$\\omega$、 $a$、$\\epsilon_{0}$、 $t$、$U$ 和 $n$ 以及在推迟函数中保证因果性的正无穷小量 $0^{+}$ 来表示你的最终结果。以解析表达式的形式给出最终答案；不需要进行数值计算或四舍五入。", "solution": "该问题要求解在静态 Hartree 近似下，一维紧束缚链的推迟单粒子格林函数 $G^R(k,\\omega)$ 和谱函数 $A(k,\\omega)$。\n\n首先，我们建立系统的哈密顿量。对于在位能为 $\\epsilon_{0}$、最近邻跃迁振幅为 $t$ 的一维链，其紧束缚哈密顿量的无相互作用部分 $H_0$ 在格点基 $\\{|j\\rangle\\}$ 下表示为：\n$$\nH_0 = \\sum_{j} \\epsilon_{0} |j\\rangle\\langle j| - t \\sum_{j} \\left( |j\\rangle\\langle j+1| + |j+1\\rangle\\langle j| \\right)\n$$\n这里， $|j\\rangle$ 代表格点 $j$ 上的电子态。我们采用了标准约定，即相邻格点间的跃迁矩阵元为 $-t$。\n\n问题指定了一种相互作用，形式为静态 Hartree 势 $U n$，其中 $U$ 是在位相互作用强度，$n$ 是每个格点的均匀电子密度。在 Hartree 平均场近似中，这种相互作用被处理为一个静态的、在位对角的能量移动。这对应于一个静态的、与动量无关的自能 $\\Sigma = U n$。因此，完整的平均场哈密顿量 $H$ 为：\n$$\nH = H_0 + \\sum_{j} (U n) |j\\rangle\\langle j| = \\sum_{j} (\\epsilon_{0} + U n) |j\\rangle\\langle j| - t \\sum_{j} \\left( |j\\rangle\\langle j+1| + |j+1\\rangle\\langle j| \\right)\n$$\n我们可以定义一个有效的、重整化的在位能 $\\epsilon'_{0} = \\epsilon_{0} + U n$。现在，哈密顿量具有一个带有此重整化在位能的无相互作用紧束缚模型的形式：\n$$\nH = \\sum_{j} \\epsilon'_{0} |j\\rangle\\langle j| - t \\sum_{j} \\left( |j\\rangle\\langle j+1| + |j+1\\rangle\\langle j| \\right)\n$$\n由于平移不变性，波矢 $k$ 是一个好量子数。我们使用 Bloch 态将哈密顿量变换到动量基（k空间），Bloch 态定义为 $|k\\rangle = \\frac{1}{\\sqrt{N}} \\sum_{j} e^{ikR_j} |j\\rangle$，其中 $R_j = ja$ 是格点 $j$ 的位置，$N$ 是总格点数。在此基下，哈密顿量变为对角的，其本征值由色散关系 $\\epsilon(k)$ 给出：\n$$\n\\epsilon(k) = \\langle k | H | k \\rangle = \\sum_{j'} e^{ik(R_{j'} - R_0)} \\langle 0 | H | j' \\rangle\n$$\n我们只需要考虑从一个参考格点（比如格点 0）到其邻居的矩阵元：\n\\begin{itemize}\n    \\item $\\langle 0 | H | 0 \\rangle = \\epsilon'_{0} = \\epsilon_0 + U n$\n    \\item $\\langle 0 | H | 1 \\rangle = -t$\n    \\item $\\langle 0 | H | -1 \\rangle = -t$\n\\end{itemize}\n对于 $j' \\neq 0, \\pm 1$ 的所有其他矩阵元 $\\langle 0 | H | j' \\rangle$ 均为零。\n将这些代入 $\\epsilon(k)$ 的表达式中：\n$$\n\\epsilon(k) = (\\epsilon_0 + U n) \\cdot e^{ik(0)} + (-t) \\cdot e^{ika} + (-t) \\cdot e^{-ika}\n$$\n$$\n\\epsilon(k) = \\epsilon_0 + U n - t(e^{ika} + e^{-ika})\n$$\n使用 Euler 公式 $e^{i\\theta} + e^{-i\\theta} = 2\\cos(\\theta)$，我们得到准粒子能量色散：\n$$\n\\epsilon(k) = \\epsilon_0 + U n - 2t \\cos(ka)\n$$\n这代表了在静态 Hartree 近似下单粒子激发的能量。该体系在效果上表现为一个具有此重整化能量色散的无相互作用体系。\n\n对于一个无相互作用的费米子体系（或在本例中为准粒子），单粒子推迟格林函数 $G^R(k, \\omega)$ 定义为：\n$$\nG^R(k, \\omega) = \\frac{1}{\\omega - \\epsilon(k) + i\\eta}\n$$\n其中 $\\eta$ 是一个正无穷小量，在问题中记为 $0^+$，它保证了因果性。代入推导出的 $\\epsilon(k)$ 表达式：\n$$\nG^R(k, \\omega) = \\frac{1}{\\omega - (\\epsilon_0 + U n - 2t \\cos(ka)) + i0^+}\n$$\n这可以改写为：\n$$\nG^R(k, \\omega) = \\frac{1}{\\omega - \\epsilon_0 - U n + 2t \\cos(ka) + i0^+}\n$$\n这是第一个要求的表达式。\n\n接下来，我们推导谱函数 $A(k, \\omega)$。谱函数根据推迟格林函数的虚部定义：\n$$\nA(k, \\omega) = -\\frac{1}{\\pi} \\text{Im}[G^R(k, \\omega)]\n$$\n为了求虚部，我们使用恒等式 $\\frac{1}{x+iy} = \\frac{x-iy}{x^2+y^2}$。令 $x = \\omega - \\epsilon(k)$ 和 $y = \\eta = 0^+$。\n$$\nG^R(k, \\omega) = \\frac{(\\omega - \\epsilon(k)) - i\\eta}{(\\omega - \\epsilon(k))^2 + \\eta^2}\n$$\n虚部是：\n$$\n\\text{Im}[G^R(k, \\omega)] = -\\frac{\\eta}{(\\omega - \\epsilon(k))^2 + \\eta^2}\n$$\n将此代入 $A(k, \\omega)$ 的定义中：\n$$\nA(k, \\omega) = -\\frac{1}{\\pi} \\left( -\\frac{\\eta}{(\\omega - \\epsilon(k))^2 + \\eta^2} \\right) = \\frac{1}{\\pi} \\frac{\\eta}{(\\omega - \\epsilon(k))^2 + \\eta^2}\n$$\n在极限 $\\eta \\to 0^+$下，此表达式是 Dirac delta 函数 $\\delta(\\omega - \\epsilon(k))$ 的一个标准表示。因此，谱函数为：\n$$\nA(k, \\omega) = \\delta(\\omega - \\epsilon(k))\n$$\n代入准粒子能量 $\\epsilon(k)$ 的完整表达式：\n$$\nA(k, \\omega) = \\delta(\\omega - (\\epsilon_0 + U n - 2t \\cos(ka)))\n$$\n谱函数的 delta 函数形式表明，在这种静态平均场近似下的准粒子具有无限的寿命，因为没有包含引入散射或衰减的动态关联效应。", "answer": "$$\n\\boxed{\n\\begin{aligned}\nG^{R}(k,\\omega) = \\frac{1}{\\omega - \\epsilon_0 - U n + 2t \\cos(ka) + i0^+} \\\\\nA(k,\\omega) = \\delta(\\omega - (\\epsilon_0 + U n - 2t \\cos(ka)))\n\\end{aligned}\n}\n$$", "id": "3463231"}, {"introduction": "在掌握了简单的静态自能模型后，我们可以进一步探索更真实的含频率依赖自能的$GW$近似。这个练习 [@problem_id:3463347] 聚焦于$G_0W_0$计算中的核心步骤：通过对自能进行线性化来求解准粒子能量。通过使用预先计算好的自能矩阵元，你可以专注于准粒子修正的物理本质以及重整化因子$Z$的含义，而不必陷入计算自能本身的复杂细节中。", "problem": "考虑一个晶态硅体系，在多体微扰理论框架下，使用 $G W$ 近似进行分析，并采用单次 $G_{0} W_{0}$ 方案进行计算。使用 Perdew–Burke–Ernzerhof (PBE) 广义梯度近似得到的 Kohn–Sham 本征值作为零阶参考。准粒子能量由戴森方程定义，其中电子自能算符 $\\Sigma(\\omega)$ 替代了交换相关势 $V_{xc}$。为了获得准粒子修正，自能被围绕每个态的 PBE 本征值进行线性化，而重整化因子 $Z$ 则源于自能的频率导数。\n\n假设在 $\\Gamma$ 点的价带顶 (VBM) 和导带底 (CBM) 的 PBE 能量分别为 $E_{v}^{\\mathrm{PBE}} = 0.000~\\mathrm{eV}$ 和 $E_{c}^{\\mathrm{PBE}} = 0.640~\\mathrm{eV}$。对于这些态，在相应的 PBE 能量下计算的差值 $\\Sigma(\\omega) - V_{xc}$ 的对角矩阵元由下式给出\n$$\n\\Delta\\Sigma_{v} \\equiv \\langle \\psi_{v} | \\Sigma(E_{v}^{\\mathrm{PBE}}) - V_{xc} | \\psi_{v} \\rangle = -0.100~\\mathrm{eV}, \\quad\n\\Delta\\Sigma_{c} \\equiv \\langle \\psi_{c} | \\Sigma(E_{c}^{\\mathrm{PBE}}) - V_{xc} | \\psi_{c} \\rangle = +0.600~\\mathrm{eV}.\n$$\n相应的自能相对于频率的斜率（在 PBE 能量下计算的频率导数）为\n$$\ns_{v} \\equiv \\left. \\frac{\\partial \\Sigma}{\\partial \\omega} \\right|_{\\omega = E_{v}^{\\mathrm{PBE}}} = -0.18, \\quad\ns_{c} \\equiv \\left. \\frac{\\partial \\Sigma}{\\partial \\omega} \\right|_{\\omega = E_{c}^{\\mathrm{PBE}}} = -0.22,\n$$\n其中每个 $s$ 表示在所关注的态中 $\\partial \\Sigma / \\partial \\omega$ 的对角矩阵元。\n\n从这些数据和 $G W$ 准粒子形式理论的第一性原理出发，计算：\n1. 分别对应于 VBM 和 CBM 的重整化因子 $Z_{v}$ 和 $Z_{c}$。\n2. 单次 $G_{0} W_{0}$ 带隙修正 $\\Delta E_{g}^{G_{0} W_{0}} \\equiv \\Delta E_{c} - \\Delta E_{v}$，其中 $\\Delta E_{n}$ 是对态 $n$ 的 PBE 本征值的准粒子修正。\n\n所有能量以 $\\mathrm{eV}$ 表示。将您的数值结果四舍五入到四位有效数字。以有序三元组 $(Z_{v}, Z_{c}, \\Delta E_{g}^{G_{0} W_{0}})$ 的形式提供您的最终答案。", "solution": "态 $n$ 的准粒子 (QP) 能量 $E_{n}^{\\mathrm{QP}}$ 是戴森方程的解。在能量壳层上，并且在 Kohn-Sham (KS) 轨道 $\\psi_n$ 的基组中，对角元的方程为：\n$$E_{n}^{\\mathrm{QP}} = E_{n}^{\\mathrm{KS}} + \\langle \\psi_{n} | \\Sigma(E_{n}^{\\mathrm{QP}}) - V_{xc} | \\psi_{n} \\rangle$$\n这里，$E_{n}^{\\mathrm{KS}}$ 是 Kohn-Sham 本征值（在本例中，来自 PBE 计算，记为 $E_{n}^{\\mathrm{PBE}}$），$\\Sigma(\\omega)$ 是频率相关的电子自能算符，而 $V_{xc}$ 是来自底层密度泛函理论 (DFT) 计算的交换相关势。\n\n该方程对于 $E_{n}^{\\mathrm{QP}}$ 是非线性的。在单次 $G_0W_0$ 计算中，标准步骤是围绕已知的 KS 本征值 $E_{n}^{\\mathrm{PBE}}$ 对自能算符 $\\Sigma(\\omega)$ 进行线性化。一阶泰勒展开得到：\n$$\\Sigma(E_{n}^{\\mathrm{QP}}) \\approx \\Sigma(E_{n}^{\\mathrm{PBE}}) + (E_{n}^{\\mathrm{QP}} - E_{n}^{\\mathrm{PBE}}) \\left. \\frac{\\partial \\Sigma}{\\partial \\omega} \\right|_{\\omega = E_{n}^{\\mathrm{PBE}}}$$\n将此近似代入戴森方程得到：\n$$E_{n}^{\\mathrm{QP}} \\approx E_{n}^{\\mathrm{PBE}} + \\left\\langle \\psi_{n} \\left| \\Sigma(E_{n}^{\\mathrm{PBE}}) + (E_{n}^{\\mathrm{QP}} - E_{n}^{\\mathrm{PBE}}) \\left. \\frac{\\partial \\Sigma}{\\partial \\omega} \\right|_{\\omega = E_{n}^{\\mathrm{PBE}}} - V_{xc} \\right| \\psi_{n} \\right\\rangle$$\n我们可以分离各项：\n$$E_{n}^{\\mathrm{QP}} \\approx E_{n}^{\\mathrm{PBE}} + \\langle \\psi_{n} | \\Sigma(E_{n}^{\\mathrm{PBE}}) - V_{xc} | \\psi_{n} \\rangle + (E_{n}^{\\mathrm{QP}} - E_{n}^{\\mathrm{PBE}}) \\left\\langle \\psi_{n} \\left| \\left. \\frac{\\partial \\Sigma}{\\partial \\omega} \\right|_{\\omega = E_{n}^{\\mathrm{PBE}}} \\right| \\psi_{n} \\right\\rangle$$\n使用问题陈述中为态 $n$ 的对角矩阵元提供的符号：\n$\\Delta\\Sigma_{n} = \\langle \\psi_{n} | \\Sigma(E_{n}^{\\mathrm{PBE}}) - V_{xc} | \\psi_{n} \\rangle$\n$s_{n} = \\langle \\psi_{n} | \\left. \\frac{\\partial \\Sigma}{\\partial \\omega} \\right|_{\\omega = E_{n}^{\\mathrm{PBE}}} | \\psi_{n} \\rangle$\n方程变为：\n$$E_{n}^{\\mathrm{QP}} = E_{n}^{\\mathrm{PBE}} + \\Delta\\Sigma_{n} + (E_{n}^{\\mathrm{QP}} - E_{n}^{\\mathrm{PBE}}) s_{n}$$\n我们现在求解 $E_{n}^{\\mathrm{QP}}$：\n$$E_{n}^{\\mathrm{QP}} - (E_{n}^{\\mathrm{QP}} - E_{n}^{\\mathrm{PBE}}) s_{n} = E_{n}^{\\mathrm{PBE}} + \\Delta\\Sigma_{n}$$\n$$E_{n}^{\\mathrm{QP}}(1 - s_{n}) = E_{n}^{\\mathrm{PBE}}(1 - s_{n}) + \\Delta\\Sigma_{n}$$\n$$E_{n}^{\\mathrm{QP}} = E_{n}^{\\mathrm{PBE}} + \\frac{\\Delta\\Sigma_{n}}{1 - s_{n}}$$\n对 PBE 本征值的准粒子修正 $\\Delta E_{n}$ 定义为 $\\Delta E_{n} \\equiv E_{n}^{\\mathrm{QP}} - E_{n}^{\\mathrm{PBE}}$。从上面的方程，我们发现：\n$$\\Delta E_{n} = \\frac{\\Delta\\Sigma_{n}}{1 - s_{n}}$$\n重整化因子 $Z_{n}$ 由自能的频率导数定义。它量化了谱函数中准粒子峰的权重。根据线性化，其标准定义为：\n$$Z_{n} = \\frac{1}{1 - s_{n}}$$\n因此，QP 修正可以紧凑地写为 $\\Delta E_{n} = Z_{n} \\Delta\\Sigma_{n}$。\n\n我们得到了关于价带顶 (v) 和导带底 (c) 的以下数据：\n对于 VBM：$E_{v}^{\\mathrm{PBE}} = 0.000~\\mathrm{eV}$，$\\Delta\\Sigma_{v} = -0.100~\\mathrm{eV}$，$s_{v} = -0.18$。\n对于 CBM：$E_{c}^{\\mathrm{PBE}} = 0.640~\\mathrm{eV}$，$\\Delta\\Sigma_{c} = +0.600~\\mathrm{eV}$，$s_{c} = -0.22$。\n\n1. 计算重整化因子 $Z_{v}$ 和 $Z_{c}$。\n对于 VBM：\n$$Z_{v} = \\frac{1}{1 - s_{v}} = \\frac{1}{1 - (-0.18)} = \\frac{1}{1.18} \\approx 0.8474576$$\n四舍五入到四位有效数字，$Z_{v} = 0.8475$。\n\n对于 CBM：\n$$Z_{c} = \\frac{1}{1 - s_{c}} = \\frac{1}{1 - (-0.22)} = \\frac{1}{1.22} \\approx 0.8196721$$\n四舍五入到四位有效数字，$Z_{c} = 0.8197$。\n\n2. 计算单次 $G_{0} W_{0}$ 带隙修正 $\\Delta E_{g}^{G_{0} W_{0}} = \\Delta E_{c} - \\Delta E_{v}$。\n首先，我们计算各自的 QP 修正 $\\Delta E_{v}$ 和 $\\Delta E_{c}$。\n\n对于 VBM：\n$$\\Delta E_{v} = \\frac{\\Delta\\Sigma_{v}}{1 - s_{v}} = \\frac{-0.100~\\mathrm{eV}}{1.18} \\approx -0.08474576~\\mathrm{eV}$$\n\n对于 CBM：\n$$\\Delta E_{c} = \\frac{\\Delta\\Sigma_{c}}{1 - s_{c}} = \\frac{0.600~\\mathrm{eV}}{1.22} \\approx 0.49180327~\\mathrm{eV}$$\n\n带隙修正是从 PBE 到 $G_0W_0$ 过程中带隙能量的变化。PBE 带隙为 $E_{g}^{\\mathrm{PBE}} = E_{c}^{\\mathrm{PBE}} - E_{v}^{\\mathrm{PBE}}$。$G_0W_0$ 带隙为 $E_{g}^{G_0W_0} = E_{c}^{\\mathrm{QP}} - E_{v}^{\\mathrm{QP}}$。\n修正是：\n$\\Delta E_{g}^{G_{0} W_{0}} = E_{g}^{G_0W_0} - E_{g}^{\\mathrm{PBE}} = (E_{c}^{\\mathrm{QP}} - E_{v}^{\\mathrm{QP}}) - (E_{c}^{\\mathrm{PBE}} - E_{v}^{\\mathrm{PBE}})$\n$\\Delta E_{g}^{G_{0} W_{0}} = (E_{c}^{\\mathrm{QP}} - E_{c}^{\\mathrm{PBE}}) - (E_{v}^{\\mathrm{QP}} - E_{v}^{\\mathrm{PBE}}) = \\Delta E_{c} - \\Delta E_{v}$\n代入计算值（在中间计算中保留精度）：\n$$\\Delta E_{g}^{G_{0} W_{0}} \\approx (0.49180327 - (-0.08474576))~\\mathrm{eV}$$\n$$\\Delta E_{g}^{G_{0} W_{0}} \\approx 0.57654903~\\mathrm{eV}$$\n四舍五入到四位有效数字，$\\Delta E_{g}^{G_{0} W_{0}} = 0.5765~\\mathrm{eV}$。\n\n最终要求的答案是有序三元组 $(Z_{v}, Z_{c}, \\Delta E_{g}^{G_{0} W_{0}})$。\n$Z_{v} = 0.8475$\n$Z_{c} = 0.8197$\n$\\Delta E_{g}^{G_{0} W_{0}} = 0.5765$", "answer": "$$ \\boxed{ \\begin{pmatrix} 0.8475  0.8197  0.5765 \\end{pmatrix} } $$", "id": "3463347"}, {"introduction": "在实际的计算研究中，确保结果的可靠性是至关重要的一步。任何真实世界的计算都涉及数值截断，例如有限的基组和k点采样。[@problem_id:3463309]这个练习将教会你一项关键技能：分析$G_0W_0$带隙如何随主要计算参数（$N_b$, $E_{\\mathrm{cut}}$, $N_k$）收敛，并使用一个有物理依据的模型将结果外推至无限大的极限，从而获得真正具有物理意义的理论预测值。", "problem": "你的任务是设计并实现一个自洽的计算程序，用于在多体微扰理论（MBPT）框架内，分析通过单次格林函数乘以屏蔽库仑相互作用方法（称为零次迭代格林函数乘以屏蔽相互作用，$G_0W_0$）获得的带隙的收敛性。目标是通过修正三个系统性的数值截断误差来源：空带数量、介电矩阵的平面波截断以及布里渊区采样分辨率，来估计无限极限下的准粒子带隙。你的程序必须从第一性原理推断并实现一个有理论依据的外推策略，然后将其应用于提供的一套人工合成但物理上合理的测试数据集。\n\n背景和基本定义：\n- 在MBPT中，准粒子带隙是通过求解戴森方程得到的，该方程使用了由无相互作用格林函数和屏蔽库仑相互作用构建的自能算符。$G_0W_0$带隙依赖于屏蔽的准确性，而屏蔽的准确性由以下因素控制：在有限数量的空带$N_b$处截断的独立粒子极化率、由平面波截断$E_{\\mathrm{cut}}$（能量截断）截断的介电矩阵，以及由$k$点数量$N_k$控制的布里渊区采样。\n- 目标是将计算出的带隙外推至$N_b \\to \\infty$、$E_{\\mathrm{cut}} \\to \\infty$和$N_k \\to \\infty$的极限。\n\n任务：\n1.  从有效的MBPT基础（屏蔽、极化率截断和数值布里渊区积分的定义）出发，推导$G_0W_0$带隙作为数值参数$N_b$、$E_{\\mathrm{cut}}$和$N_k$的函数的渐近收敛行为。建立一个模型，捕捉截断误差对这些参数的主导阶依赖关系，并得出一个数学上适定的外推程序以达到无限极限。\n2.  使用多元回归或等效的线性参数估计技术，通过算法实现最终的外推模型，以从有限参数数据中确定无限极限带隙。\n3.  将你的程序应用于以下人工合成测量数据集的测试套件。每个数据集对应于一个不同的材料类别。对于每种情况，给你九个数据点，其中一个参数变化，而另外两个参数保持固定。每个数据点是一个四元组$(N_b, E_{\\mathrm{cut}}^{\\mathrm{Ry}}, N_k; E_g)$，其中$E_{\\mathrm{cut}}^{\\mathrm{Ry}}$是以里德堡为单位的介电截断，而$E_g$是以电子伏特（eV）为单位的$G_0W_0$带隙。使用这些数据来拟合你的模型，并提取每种情况下外推得到的无限极限带隙$E_g^{\\infty}$。\n\n情况1（三维半导体；中等屏蔽）：\n- 固定$E_{\\mathrm{cut}}^{\\mathrm{Ry}} = 20$和$N_k = 8$，变化$N_b$：$(40, 20, 8; 3.05)$、$(80, 20, 8; 2.975)$、$(160, 20, 8; 2.9375)$。\n- 固定$N_b = 120$和$N_k = 8$，变化$E_{\\mathrm{cut}}^{\\mathrm{Ry}}$：$(120, 10, 8; 3.15)$、$(120, 20, 8; 2.95)$、$(120, 40, 8; 2.85)$。\n- 固定$N_b = 120$和$E_{\\mathrm{cut}}^{\\mathrm{Ry}} = 20$，变化$N_k$：$(120, 20, 4; 3.15)$、$(120, 20, 8; 2.95)$、$(120, 20, 12; 2.8833333333)$。\n\n情况2（二维半导体；更强的有限尺寸效应）：\n- 固定$E_{\\mathrm{cut}}^{\\mathrm{Ry}} = 30$和$N_k = 10$，变化$N_b$：$(50, 30, 10; 2.36)$、$(100, 30, 10; 2.28)$、$(200, 30, 10; 2.24)$。\n- 固定$N_b = 100$和$N_k = 10$，变化$E_{\\mathrm{cut}}^{\\mathrm{Ry}}$：$(100, 15, 10; 2.38)$、$(100, 30, 10; 2.28)$、$(100, 60, 10; 2.23)$。\n- 固定$N_b = 100$和$E_{\\mathrm{cut}}^{\\mathrm{Ry}} = 30$，变化$N_k$：$(100, 30, 5; 2.58)$、$(100, 30, 10; 2.28)$、$(100, 30, 15; 2.18)$。\n\n情况3（宽带隙三维绝缘体；弱的有限尺寸修正）：\n- 固定$E_{\\mathrm{cut}}^{\\mathrm{Ry}} = 40$和$N_k = 10$，变化$N_b$：$(60, 40, 10; 6.23)$、$(120, 40, 10; 6.165)$、$(240, 40, 10; 6.1525)$。\n- 固定$N_b = 120$和$N_k = 10$，变化$E_{\\mathrm{cut}}^{\\mathrm{Ry}}$：$(120, 20, 10; 6.215)$、$(120, 40, 10; 6.165)$、$(120, 60, 10; 6.1483333333)$。\n- 固定$N_b = 120$和$E_{\\mathrm{cut}}^{\\mathrm{Ry}} = 40$，变化$N_k$：$(120, 40, 6; 6.225)$、$(120, 40, 10; 6.165)$、$(120, 40, 14; 6.1392857143)$。\n\n你的程序必须：\n- 实现从第一性原理推导出的外推策略。\n- 对于每种情况，使用所有九个数据点拟合模型，并计算外推得到的无限极限带隙$E_g^{\\infty}$。\n- 将每个$E_g^{\\infty}$以电子伏特（$\\mathrm{eV}$）为单位表示，并四舍五入到三位小数。\n- 生成一行输出，包含三个结果，格式为方括号括起来的逗号分隔列表，例如$[x_1,x_2,x_3]$。\n\n最终输出格式：\n- 一行：$[E_g^{\\infty}(\\mathrm{Case}\\ 1),E_g^{\\infty}(\\mathrm{Case}\\ 2),E_g^{\\infty}(\\mathrm{Case}\\ 3)]$，其中每个条目都是一个浮点数，四舍五入到三位小数，单位默认为$\\mathrm{eV}$。\n\n不允许用户输入。所有需要的常数和数据都必须包含在你的程序中。不涉及角度。如果内部使用了任何分数或比率，请以数值方式编码。该程序必须是一个完整的、可运行的脚本，实现所推导的模型并计算所要求的输出。", "solution": "我们从多体微扰理论（MBPT）和$G_0W_0$近似的基础出发。相对于Kohn-Sham理论，一个态$\\psi_{n\\mathbf{k}}$的$G_0W_0$准粒子能量移动由下式给出：\n$$\n\\Delta E_{n\\mathbf{k}} = \\langle \\psi_{n\\mathbf{k}} | \\Sigma(E_{n\\mathbf{k}}) - V_{\\mathrm{xc}} | \\psi_{n\\mathbf{k}} \\rangle,\n$$\n其中$\\Sigma$是由无相互作用格林函数$G_0$和屏蔽库仑相互作用$W_0$的卷积构成的自能，而$V_{\\mathrm{xc}}$是来自密度泛函理论的交换关联势。屏蔽库仑相互作用为\n$$\nW_0(\\mathbf{q},\\omega) = \\epsilon^{-1}(\\mathbf{q},\\omega) v(\\mathbf{q}),\n$$\n其中$\\epsilon$是介电矩阵，$v$是裸库仑势。进入$\\epsilon$的独立粒子极化率$P^0$是作为涉及占据态和空态的跃迁之和来计算的，介电矩阵则在由截断能限制的平面波基组中表示。对$\\mathbf{q}$的布里渊区积分通过在有限$k$点网格上的离散求和来近似。这些数值近似引入了系统性的截断误差，必须加以控制和外推。\n\n我们使用基于物理的论据来分析截断误差的渐近行为：\n\n1. 空带截断（$N_b$）：\n独立粒子极化率$P^0$包括向高能空态的跃迁。在大的跃迁能量$\\omega$和高能带指数下，矩阵元会衰减，而态密度仅随能量呈多项式增长（例如，在三维中对于类自由电子态，其增长与$\\propto \\sqrt{E}$成正比）。被忽略的高能尾部的贡献可以通过对能量的积分来近似，其被积函数对于与屏蔽相关的频率，衰减速度近似为$1/\\omega^2$或更快，导致余项与所包含跃迁的上限成反比。当用所包含的空带数量$N_b$来索引时，这产生一个主导阶误差，其行为如下：\n$$\n\\delta E_g(N_b) \\sim \\frac{a}{N_b},\n$$\n其中$a$是某个依赖于材料的系数，单位为能量。这反映了随着包含更多能带，高能空态对屏蔽和自能的影响逐渐减小。\n\n2. 介电矩阵截断（$E_{\\mathrm{cut}}$）：\n在平面波表示中，介电矩阵的截断由一个截断能$E_{\\mathrm{cut}}$控制，它限制了倒格矢大小$|\\mathbf{G}|$的最大值。被忽略的大的$|\\mathbf{G}|$分量对局域场效应和短程屏蔽有贡献。对于足够大的$E_{\\mathrm{cut}}$，截断余项随着包含更高的$|\\mathbf{G}|$而减小，并且渐近地，它的行为与截断值的倒数成正比，\n$$\n\\delta E_g(E_{\\mathrm{cut}}) \\sim \\frac{b}{E_{\\mathrm{cut}}},\n$$\n其中$b$是一个依赖于材料的常数，单位为能量乘以能量。这种标度关系捕捉了主导的缺失局域场修正。\n\n3. 布里渊区采样（$N_k$）：\n对涉及屏蔽相互作用和自能的函数在布里渊区上的积分，通过在$N_k$个点的网格上进行离散求和来近似。对于在$\\mathbf{q}=\\mathbf{0}$处具有可积奇点（由于库仑核）的光滑被积函数，简单求和（矩形法则或未经特殊修正的Monkhorst-Pack网格）的误差与样本数的倒数成正比，\n$$\n\\delta E_g(N_k) \\sim \\frac{c}{N_k},\n$$\n其中常数$c$由屏蔽相互作用的长程行为和能带边缘附近的色散关系决定。这与连续函数的黎曼和的收敛速度以及在半导体和绝缘体中观察到的准粒子能量收敛的经验结果一致。\n\n在假设这三个误差源在主导阶上是弱耦合的前提下，我们可以为使用有限参数$(N_b, E_{\\mathrm{cut}}, N_k)$计算的$G_0W_0$带隙$E_g$写下一个可分离的主导阶模型：\n$$\nE_g(N_b, E_{\\mathrm{cut}}, N_k) = E_g^{\\infty} + \\frac{a}{N_b} + \\frac{b}{E_{\\mathrm{cut}}} + \\frac{c}{N_k},\n$$\n其中$E_g^{\\infty}$是无限极限带隙，而$(a,b,c)$是编码相应截断误差幅度的拟合系数。这个模型在变换后的变量$(N_b^{-1}, E_{\\mathrm{cut}}^{-1}, N_k^{-1})$和截距$E_g^{\\infty}$上是线性的。\n\n算法外推策略：\n- 对于每种材料情况，收集测量数据$\\{(N_b^{(i)}, E_{\\mathrm{cut}}^{(i)}, N_k^{(i)}, E_g^{(i)})\\}_{i=1}^M$。\n- 构建设计矩阵$X \\in \\mathbb{R}^{M \\times 4}$，其行为\n$$\nX_i = \\left[ \\frac{1}{N_b^{(i)}}, \\frac{1}{E_{\\mathrm{cut}}^{(i)}}, \\frac{1}{N_k^{(i)}}, 1 \\right],\n$$\n和目标向量$y \\in \\mathbb{R}^M$，其分量为$y_i = E_g^{(i)}$。\n- 求解线性最小二乘问题\n$$\n\\min_{\\theta \\in \\mathbb{R}^4} \\| X \\theta - y \\|_2^2,\n$$\n其中$\\theta = [a, b, c, E_g^{\\infty}]^{\\top}$。通过伪逆或标准最小二乘求解器可以获得数值稳定的解。\n- 从$\\theta$中提取$E_g^{\\infty}$。\n- 将每个$E_g^{\\infty}$四舍五入到三位小数，并以电子伏特为单位报告。\n\n应用于测试套件：\n每种情况提供了九个数据点，这些数据点的生成与上述可分离主导阶行为一致。通过将模型拟合到这些数据，可以获得外推的无限极限带隙。数据集的构建使得恢复的$E_g^{\\infty}$值具有代表性且科学上合理。每种情况使用所有九个点确保了回归是良态的，并且系数$(a,b,c)$可以被分离。\n\n实现细节：\n- 不使用外部输入；数据嵌入在程序中。\n- 使用鲁棒的最小二乘求解器进行拟合，例如$\\texttt{numpy.linalg.lstsq}$，它计算最小化残差欧几里得范数的$\\theta$。\n- 求解后，从$\\theta$的截距分量中获取无限极限带隙$E_g^{\\infty}$。\n- 最终输出以单行列表的形式打印，其值以$\\mathrm{eV}$为单位，四舍五入到三位小数。\n\n预期结果：\n将该算法应用于所提供的数据集，会得到与每种情况嵌入的无限极限目标值接近的$E_g^{\\infty}$值。最终程序计算并以所需格式打印三个外推值：一个单行列表$[E_g^{\\infty}(\\mathrm{Case}\\ 1),E_g^{\\infty}(\\mathrm{Case}\\ 2),E_g^{\\infty}(\\mathrm{Case}\\ 3)]$，单位为$\\mathrm{eV}$，四舍五入到三位小数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef fit_infinite_gap(data_points):\n    \"\"\"\n    Fit the linear model:\n        E_g = a*(1/Nb) + b*(1/Ecut) + c*(1/Nk) + E_inf\n    using least squares and return E_inf.\n    data_points: list of tuples (Nb, Ecut_Ry, Nk, Eg_eV)\n    \"\"\"\n    # Build design matrix X and target vector y\n    X_rows = []\n    y = []\n    for Nb, Ecut, Nk, Eg in data_points:\n        X_rows.append([1.0 / Nb, 1.0 / Ecut, 1.0 / Nk, 1.0])\n        y.append(Eg)\n    X = np.array(X_rows, dtype=float)\n    y = np.array(y, dtype=float)\n    # Solve least squares\n    theta, residuals, rank, s = np.linalg.lstsq(X, y, rcond=None)\n    # theta = [a, b, c, E_inf]\n    E_inf = theta[3]\n    return E_inf\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case lists nine data points: (Nb, Ecut_Ry, Nk, Eg_eV)\n    case1 = [\n        # Vary Nb at fixed Ecut=20 Ry, Nk=8\n        (40, 20, 8, 3.05),\n        (80, 20, 8, 2.975),\n        (160, 20, 8, 2.9375),\n        # Vary Ecut at fixed Nb=120, Nk=8\n        (120, 10, 8, 3.15),\n        (120, 20, 8, 2.95),\n        (120, 40, 8, 2.85),\n        # Vary Nk at fixed Nb=120, Ecut=20 Ry\n        (120, 20, 4, 3.15),\n        (120, 20, 8, 2.95),\n        (120, 20, 12, 2.8833333333),\n    ]\n\n    case2 = [\n        # Vary Nb at fixed Ecut=30 Ry, Nk=10\n        (50, 30, 10, 2.36),\n        (100, 30, 10, 2.28),\n        (200, 30, 10, 2.24),\n        # Vary Ecut at fixed Nb=100, Nk=10\n        (100, 15, 10, 2.38),\n        (100, 30, 10, 2.28),\n        (100, 60, 10, 2.23),\n        # Vary Nk at fixed Nb=100, Ecut=30 Ry\n        (100, 30, 5, 2.58),\n        (100, 30, 10, 2.28),\n        (100, 30, 15, 2.18),\n    ]\n\n    case3 = [\n        # Vary Nb at fixed Ecut=40 Ry, Nk=10\n        (60, 40, 10, 6.23),\n        (120, 40, 10, 6.165),\n        (240, 40, 10, 6.1525),\n        # Vary Ecut at fixed Nb=120, Nk=10\n        (120, 20, 10, 6.215),\n        (120, 40, 10, 6.165),\n        (120, 60, 10, 6.1483333333),\n        # Vary Nk at fixed Nb=120, Ecut=40 Ry\n        (120, 40, 6, 6.225),\n        (120, 40, 10, 6.165),\n        (120, 40, 14, 6.1392857143),\n    ]\n\n    # Fit and collect infinite-limit gaps for each case\n    results = []\n    for case in [case1, case2, case3]:\n        E_inf = fit_infinite_gap(case)\n        # Round to three decimals\n        results.append(f\"{E_inf:.3f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3463309"}]}