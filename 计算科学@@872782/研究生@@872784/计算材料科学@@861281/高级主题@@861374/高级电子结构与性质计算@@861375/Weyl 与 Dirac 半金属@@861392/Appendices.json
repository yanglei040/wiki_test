{"hands_on_practices": [{"introduction": "本练习模拟了现代计算材料科学研究所需的战略性思维。为了预测和发现新的外尔半金属，必须设计一个稳健的第一性原理计算工作流程。这个问题 [@problem_id:3503611] 要求你批判性地评估并组合必要的计算步骤，从初始的密度泛函理论 (DFT) 计算，到最终使用瓦尼尔函数和贝里曲率概念确认外尔节点的“手性”。掌握这一思维过程对于在拓扑材料发现的复杂领域中进行探索至关重要。", "problem": "一种具有时间反演对称性的非中心对称四方晶系化合物被认为在费米能级附近存在外尔节点 (Weyl node)。使用全相对论赝势的密度泛函理论 (DFT) 计算，得到了一组在均匀 $\\mathbf{k}$ 点网格上采样的 Kohn–Sham 旋量布洛赫态 $\\{\\lvert \\psi_{n\\mathbf{k}} \\rangle\\}$ 和能量 $\\{E_{n\\mathbf{k}}\\}$。在计算材料科学实践中，一个 DFT 到 Wannier 的工作流程通过最大局域化 Wannier 函数构建紧束缚哈密顿量 $H_{\\mathrm{TB}}(\\mathbf{k})$，用以内插能带、搜索线性带交叉点，并计算贝里通量 (Berry flux) 以确定候选外尔点的手性电荷。在高等研究生水平上，你需要从第一性原理出发进行推理：周期性边界条件下的布洛赫定理 (Bloch's theorem)、极化的现代理论和贝里相位 (Berry phase)，以及外尔节点的拓扑电荷定义，即贝里曲率 (Berry curvature) 在 $\\mathbf{k}$ 空间中包围简并点的一个微小闭合曲面上的积分。\n\n考虑以下四个提议的工作流程。每个流程都指定了自旋轨道耦合 (SOC) 的选择、Wannier 投影集、通过外部能量窗和内部冻结窗的退纠缠策略、候选线性交叉点的搜索方案，以及用于分配手性的贝里通量计算方法。你的任务是选择那些科学上合理，并且其构造能够避免伪纠缠，同时能够明确识别外尔节点及其手性电荷的工作流程。评估每个选项与上述基本原理以及实际计算材料科学实践的一致性。\n\nA. 启用 SOC 进行 DFT 计算，以获得 $\\{\\lvert \\psi_{n\\mathbf{k}} \\rangle , E_{n\\mathbf{k}}\\}$。在阳离子 $d$ 轨道和阴离子 $p$ 轨道上选择旋量投影，这些轨道在费米能级 $E_F$ 附近的一个窄窗口内主导了轨道特性。设置一个外部退纠缠窗 $[E_F - 1.5\\,\\mathrm{eV},\\, E_F + 1.5\\,\\mathrm{eV}]$ 和一个内部冻结窗 $[E_F - 0.3\\,\\mathrm{eV},\\, E_F + 0.3\\,\\mathrm{eV}]$，使得 Wannier 函数的数量等于冻结窗内的目标能带数。最小化扩展泛函以获得最大局域化 Wannier 函数，并验证 Wannier 内插能带在 $E_F$ 附近能够复现 DFT 结果。使用粗略的 $\\mathbf{k}$ 空间扫描来定位能量差 $\\Delta E(\\mathbf{k})$ 低于一个小阈值且其局域色散在相互正交方向上呈线性的近简并对。通过对 $H_{\\mathrm{TB}}(\\mathbf{k})$ 进行局域内插来精修候选位置。对于每个候选点，通过离散化该点周围半径为 $r = 0.01\\,\\mathrm{\\AA}^{-1}$ 的微小闭合球面来计算贝里通量，沿球面上的方位角回路评估占据流形的非阿贝尔 Wilson 圈，并提取整数陈数 (Chern number)；相应地分配手性 $\\pm 1$。确认所分配的电荷在合理范围内与 $r$ 无关，并且在对称性相关的点之间保持一致。\n\nB. 不启用 SOC 进行 DFT 计算以降低计算成本。仅在两种原子的类 $s$ 轨道上选择投影以简化 Wannier 化过程。不使用内部冻结窗，并使用一个外部窗口 $[E_F - 5\\,\\mathrm{eV},\\, E_F + 5\\,\\mathrm{eV}]$ 以包含大部分能带；接受任何收敛的 Wannier 扩展。通过寻找内插能带结构中具有大费米速度 $\\mathbf{v}_F(\\mathbf{k})$ 的点和能带交叉点来识别外尔节点。通过计算穿过交叉点周围一个开放立方体表面的两个相对面的贝里曲率并取其差值来分配手性；将穿过该开放盒子的非零净通量视为非平庸手性的证据。\n\nC. 启用 SOC 进行 DFT 计算。仅在阴离子 $p$ 轨道上选择投影以减少基组，理由是阳离子 $d$ 态能量较高。使用一个外部窗口 $[E_F - 0.2\\,\\mathrm{eV},\\, E_F + 0.2\\,\\mathrm{eV}]$ 且不设内部冻结窗，以便退纠缠算法自动选择“最佳”子空间。通过扫描 $\\mathbf{k}$ 空间中的平面并拟合色散关系来定位交叉点；将线性色散的点分类为外尔节点。计算沿每个候选点周围平面内单个无穷小回路的贝里相位，并将接近 $\\pi$ 的贝里相位解释为大小为 $1$ 的手性电荷。\n\nD. 启用 SOC 进行 DFT 计算。在阳离子 $d$ 轨道和阴离子 $p$ 轨道上选择旋量投影，并设置一个非常宽的外部窗口 $[E_F - 8\\,\\mathrm{eV},\\, E_F + 8\\,\\mathrm{eV}]$ 以确保完备性，同时设置一个内部冻结窗 $[E_F - 0.05\\,\\mathrm{eV},\\, E_F + 0.05\\,\\mathrm{eV}]$ 以靶定交叉点。接受中等大的 Wannier 扩展为不可避免的结果。通过构建半无限格林函数并计算表面谱权重来定位费米弧，从而间接识别外尔节点；将费米弧的端点反向投影到体布里渊区，以估计外尔节点的位置。使用从表面计算中推断出的弧缠绕符号来分配手性，而不计算任何体贝里通量。\n\n哪个选项提供了一个健全的 DFT 到 Wannier 的工作流程，该流程可以通过定位线性交叉点和计算贝里通量来识别外尔节点，同时为其选择的投影和能量窗提供了避免伪纠缠的合理解释？\n\nA. 选项 A 中的工作流程\n\nB. 选项 B 中的工作流程\n\nC. 选项 C 中的工作流程\n\nD. 选项 D 中的工作流程", "solution": "该问题要求评估四种提议的计算工作流程，用于在具有时间反演对称性的非中心对称材料中识别外尔节点及其手性。评估必须基于凝聚态物理的第一性原理和计算材料科学的标准实践。核心任务是找到一个能够通过定位线性能带交叉并计算相关的拓扑电荷（贝里通量）来正确识别外尔节点的工作流程。\n\n一个有效的工作流程必须满足几个关键标准：\n1.  **包含自旋轨道耦合 (SOC)：** 外尔节点是受拓扑保护的简并点。在具有时间反演对称性 (TRS) 但缺乏反演对称性（非中心对称）的材料中，SOC 是解除自旋简并的机制。在布里渊区特定点上由晶体点群对称性保护的剩余简并点就是外尔节点。因此，DFT 计算必须包含 SOC。\n2.  **精确的电子结构模型：** 必须构建一个紧束缚哈密顿量 $H_{\\mathrm{TB}}(\\mathbf{k})$，以精确地复现在感兴趣的能量区域（特别是费米能级 $E_F$ 附近）的 DFT 能带结构 $\\{E_{n\\mathbf{k}}\\}$。这通过 Wannier 化来实现。\n3.  **合适的 Wannier 化过程：**\n    *   **投影：** 用于构建 Wannier 函数的初始试探轨道（投影）必须构成一个与感兴趣的布洛赫态有强重叠的基组。这些通常根据 $E_F$ 附近的能带的原子轨道特性来选择。\n    *   **退纠缠：** 如果感兴趣的能带与不希望包含在模型中的其他能带发生纠缠（即交叉），则必须进行退纠缠过程。这需要仔细选择一个外部能量窗（它定义了从中提取最优子空间的希尔伯特空间）和一个内部（冻结）能量窗（它定义了必须被完美复现的能带）。Wannier 函数的数量应与冻结窗中的能带数量相匹配，以确保为目标能带建立一个定义良好的模型。\n4.  **正确识别外尔节点：** 外尔节点必须被定位为二重简并点，在这些点上能带在 $\\mathbf{k}$ 空间的所有三个空间方向上呈线性色散。\n5.  **正确计算手性：** 外尔节点的拓扑电荷（手性, $\\chi$）是一个量子化的整数，定义为在 $\\mathbf{k}$ 空间中任何只包围该节点的封闭二维曲面 $S$ 上的陈数 (Chern number)：\n    $$ \\chi = \\frac{1}{2\\pi} \\oint_S \\mathbf{\\Omega}(\\mathbf{k}) \\cdot d\\mathbf{S} $$\n    这里，$\\mathbf{\\Omega}(\\mathbf{k})$ 是贝里曲率。在计算上，这需要在候选外尔点周围的离散化封闭曲面（如球面）上对贝里通量进行积分。结果必须是一个整数（对于一个简单且不可约的外尔节点，量子化为 $\\pm 1$）。\n\n基于这些原则，我现在评估每个提议的工作流程。\n\n### 选项 A\n\n- **DFT 计算：** “启用 SOC 进行 DFT 计算”。这是正确的并且是必不可少的，如上所述。\n- **投影：** “在阳离子 $d$ 轨道和阴离子 $p$ 轨道上选择旋量投影，这些轨道...主导了轨道特性...”。这是标准的、有物理动机且正确的方法。它确保了 Wannier 函数的基组适合该问题。\n- **退纠缠：** “设置一个外部退纠缠窗 $[E_F - 1.5\\,\\mathrm{eV},\\, E_F + 1.5\\,\\mathrm{eV}]$ 和一个内部冻结窗 $[E_F - 0.3\\,\\mathrm{eV},\\, E_F + 0.3\\,\\mathrm{eV}]$”。这描述了一个稳健且标准的退纠缠策略。内部窗口靶定 $E_F$ 附近的物理相关能带，而外部窗口为算法寻找平滑且最优的子空间提供了足够的灵活性。Wannier 函数数量等于冻结窗中能带数量的条件是正确设置问题的方式。\n- **验证：** “验证 Wannier 内插能带在 $E_F$ 附近能够复现 DFT 结果”。这是一个关键且必要的质量控制步骤。\n- **搜索方案：** “使用粗略的 $\\mathbf{k}$ 空间扫描来定位近简并对... 通过局域内插精修候选位置”。这是使用计算成本较低的 $H_{\\mathrm{TB}}(\\mathbf{k})$ 寻找节点的有效且数值上合理的方法。\n- **手性计算：** “通过离散化一个微小闭合球面来计算贝里通量...评估...非阿贝尔 Wilson 圈...并提取整数陈数”。这是计算外尔节点拓扑电荷的根本正确方法。它直接实现了陈数作为贝里通量在闭合流形上积分的定义。提及非阿贝尔 Wilson 圈对于多能带（占据流形）的上下文是合适的。确认电荷相对于球体半径 $r$ 的稳定性是检验量子化的重要步骤。\n\n**对 A 的结论：** 选项 A 中描述的工作流程完全合理。它遵守了所有理论要求，并遵循了计算材料科学中用于识别和表征外尔节点的既定最佳实践。**正确**。\n\n### 选项 B\n\n- **DFT 计算：** “不启用 SOC 进行 DFT 计算”。这是一个致命的缺陷。如前所述，在具有 TRS 的非中心对称系统中，SOC 是产生外尔节点的必要条件。没有它，人们可能会找到节线或其他特征，但不会找到其存在与自旋分裂相关的特定外尔节点。\n- **投影：** “仅在类 $s$ 轨道上选择投影”。这是一个武断的选择，不大可能代表 $E_F$ 附近的能带，在过渡金属化合物中，$E_F$ 附近的能带通常具有 $d$ 和 $p$ 特性。这将导致一个质量差、不准确的 $H_{\\mathrm{TB}}(\\mathbf{k})$。\n- **退纠缠：** “不使用内部冻结窗...接受任何收敛的 Wannier 扩展”。这是糟糕的做法。没有冻结窗，算法就无法获得关于优先处理哪些能带的指导，而接受一个大的扩展意味着接受一个差的局域化，从而导致一个不可靠的紧束缚模型。\n- **手性计算：** “计算穿过...一个开放立方体表面的两个相对面的贝里曲率”。这在物理上是无意义的。拓扑电荷被定义为穿过一个*封闭*曲面的通量。穿过一个开放曲面的通量不是一个量子化的拓扑不变量。这个方法在根本上是错误的。\n\n**对 B 的结论：** 这个工作流程几乎在每个方面都是错误的。它基于对外尔半金属物理及其性质计算方法的根本误解。**不正确**。\n\n### 选项 C\n\n- **投影：** “仅在阴离子 $p$ 轨道上选择投影”。这是一个有风险的简化。它假设在 $E_F$ 附近阳离子和阴离子轨道之间没有杂化。如果这个假设是错误的（通常情况下是这样），基组将是不完备的，得到的 Wannier 模型将是不准确的。\n- **退纠缠：** “使用一个外部窗口 $[E_F - 0.2\\,\\mathrm{eV},\\, E_F + 0.2\\,\\mathrm{eV}]$ 且不设内部冻结窗”。这个窗口极窄。它太小了，无法有效地作为一个退纠缠窗口，因为它没有给算法留下构建平滑子空间的空间。\n- **手性计算：** “计算沿单个无穷小回路的贝里相位...并将接近 $\\pi$ 的贝里相位解释为大小为 $1$ 的手性电荷”。这在根本上是错误的。在一个一维回路上计算得到的 $\\pi$ 贝里相位是二维狄拉克锥的特征，而不是三维外尔点的特征。三维外尔点的拓扑不变量是在一个二维曲面上计算的陈数，而不是在一个一维回路上计算的贝里相位。该方法无法确定节点的手性符号，并且不是正确的不变量。\n\n**对 C 的结论：** 这个工作流程包含多个方法上的错误。投影的选择值得怀疑，窗口策略很差，最关键的是，计算拓扑电荷的方法对于三维外尔点是不正确的。**不正确**。\n\n### 选项 D\n\n- **退纠缠：** “设置一个非常宽的外部窗口 $[E_F - 8\\,\\mathrm{eV},\\, E_F + 8\\,\\mathrm{eV}]$...同时设置一个内部冻结窗 $[E_F - 0.05\\,\\mathrm{eV},\\, E_F + 0.05\\,\\mathrm{eV}]$”。这种窗口选择是有问题的。一个非常宽的外部窗口通常会引入与远离的能带的伪纠缠，使得获得具有小扩展的良好局域化的 Wannier 函数变得极其困难。“接受中等大的 Wannier 扩展为不可避免的结果”的说法承认了这一策略的缺陷。\n- **识别方法：** 这个工作流程放弃了直接搜索体外尔节点和计算其体拓扑电荷。相反，它建议通过表面计算（“定位费米弧”）来推断它们的存在和性质。虽然体-边对应是一个有效的物理原理（体外尔节点导致表面费米弧），但这种方法没有完成问题中指定的任务：“...通过定位线性交叉点和计算贝里通量来识别外尔节点...”。这是一种间接的、通常精度较低的表征方法。\n- **手性分配：** 手性是根据“弧缠绕的符号”来分配的，而没有计算体贝里通量。这再次偏离了所要求的方法。\n\n**对 D 的结论：** 虽然基于一个有效的物理概念（体-边对应），但这个工作流程未能满足问题陈述的具体要求。问题明确要求一个基于定位体交叉点和计算体贝里通量的工作流程。选项 D 提出了一个完全不同的、通过表面态的间接方法。此外，其提议的 Wannier 化策略很可能在数值上不稳定，并产生一个质量差的模型。**不正确**。\n\n**总结**\n只有选项 A 描述了一个完整的、严谨的、标准的、符合问题陈述中指定的原则和方法来识别外尔节点及其手性的工作流程。", "answer": "$$\\boxed{A}$$", "id": "3503611"}, {"introduction": "在确定候选材料并构建简化模型后，下一个关键步骤是严格确认其拓扑性质。这需要通过计算拓扑不变量来实现。本编码练习 [@problem_id:3503638] 提供了通过威尔逊循环 (Wilson loop) 方法进行实践的经验，这是一种强大且标准的数值技术，用于计算布里渊区二维切片的陈数 (Chern number)。一个非零的陈数是该切片间包围的拓扑荷的明确证据，从而证实了外尔节点的存在。", "problem": "您需要实现一个独立的程序，该程序在简单立方晶格上模拟 Weyl 半金属的双带 Wannier 紧束缚哈密顿量，并通过 Wilson 环路计算来验证其非平凡的拓扑特性。您的程序必须基于紧束缚能带理论和 Berry 相位拓扑学的第一性原理，并且必须包含数值规范一致性检验。\n\n从一个经过充分检验的、源自最近邻 Wannier 基的双带模型在动量空间中的紧束缚表示出发。在动量空间中，将布里渊区 (BZ) 环面上的哈密顿量定义为：\n$$\nH(\\mathbf{k}) = d_x(\\mathbf{k})\\,\\sigma_x + d_y(\\mathbf{k})\\,\\sigma_y + d_z(\\mathbf{k})\\,\\sigma_z,\n$$\n其中 $\\sigma_x$、$\\sigma_y$ 和 $\\sigma_z$ 是泡利矩阵，$\\mathbf{k} = (k_x,k_y,k_z)$，并且：\n$$\nd_x(\\mathbf{k}) = \\sin(k_x),\\quad d_y(\\mathbf{k}) = \\sin(k_y),\\quad d_z(\\mathbf{k}) = m_0 - \\cos(k_x) - \\cos(k_y) - \\cos(k_z).\n$$\n此处 $m_0$ 是一个实数控制参数，用于在存在和不存在 Weyl 节点的相之间进行调节。疑似的 Weyl 节点出现在满足 $\\sin(k_x)=\\sin(k_y)=0$ 和 $m_0 - \\cos(k_x) - \\cos(k_y) - \\cos(k_z) = 0$ 的零能点上，当 $m_0 \\in (1,3)$ 时，这会产生位于 $k_x = 0$，$k_y = 0$ 和 $k_z = \\pm \\arccos(m_0 - 2)$ 的解。\n\n对于一个固定的 $k_z$ 切片（一个由 $(k_x,k_y)$ 参数化的二维布里渊区），您的任务是为每个 $k_y$ 值计算沿 $k_x$ 方向闭合环路的 Wilson 环路（Berry 完整群），然后从 Wilson 环路相位随 $k_y$ 的缠绕中提取占据带的陈数。请使用以下基本定义：\n\n- 占据带本征矢量 $|u(\\mathbf{k})\\rangle$ 是与较低能量 $E_-(\\mathbf{k}) = -\\sqrt{d_x^2 + d_y^2 + d_z^2}$ 相关联的 $H(\\mathbf{k})$ 的归一化本征矢量。\n- 对于在固定 $(k_y,k_z)$ 下具有周期性闭合 $k_x^{N_x} \\equiv k_x^0$ 的离散化环路 $\\{k_x^j\\}_{j=0}^{N_x-1}$，将每个线段上的连接变量定义为交叠 $\\mathcal{U}_j = \\langle u(k_x^{j+1},k_y,k_z)|u(k_x^{j},k_y,k_z)\\rangle$，归一化连接变量定义为 $\\tilde{\\mathcal{U}}_j = \\mathcal{U}_j/|\\mathcal{U}_j|$。\n- 在 $(k_y,k_z)$ 处的 Wilson 环路相位是：\n$$\n\\phi(k_y;k_z) = \\arg\\!\\left(\\prod_{j=0}^{N_x-1}\\tilde{\\mathcal{U}}_j\\right).\n$$\n- 切片陈数是通过当 $k_y$ 沿闭合路径循环时 $\\phi(k_y;k_z)$ 的缠绕获得的：\n$$\nC(k_z) = \\frac{1}{2\\pi}\\,\\Delta \\phi(k_y;k_z),\n$$\n其中 $\\Delta \\phi$ 是当 $k_y$ 从 $0$ 变到 $2\\pi$ 时，$\\phi$ 展开后的净变化量。\n\n您还必须实现数值规范一致性检验：\n- 对环路上的原始交叠乘积进行幺正性检验：量化 $\\left|\\prod_{j}\\mathcal{U}_j\\right|$ 与 1 的偏差。将所有 $k_y$ 上的最大偏差作为非负浮点数报告。\n- 规范不变性检验：在每个 $\\mathbf{k}$ 点独立地施加一个随机的 1 阶酉群 (U(1)) 相位 $e^{i\\theta(\\mathbf{k})}$ 以形成 $|u'(\\mathbf{k})\\rangle = e^{i\\theta(\\mathbf{k})}|u(\\mathbf{k})\\rangle$，使用归一化连接变量重新计算 $\\phi'(k_y;k_z)$，并将所有 $k_y$ 上的最大绝对相位差 $|\\arg(e^{i(\\phi'-\\phi)})|$ 作为非负浮点数报告。\n\n对于每个指定的测试用例，按顺序计算以下输出：\n- 切片的陈数 $C(k_z)$，作为从 Wilson 环路缠绕导出的整数。\n- $(k_x,k_y)$ 切片上的最小谱隙，作为浮点数，在指定的离散化中定义为 $2\\min_{\\mathbf{k}}|E_-(\\mathbf{k})|$。\n- 原始交叠乘积在所有 $k_y$ 上的最大幺正性偏差，作为浮点数。\n- 在所有 $k_y$ 上的最大规范不变性相位差，作为浮点数。\n\n所有角度必须以弧度为单位。使用提供的网格尺寸在 $[0,2\\pi)$ 上对 $k_x$ 和 $k_y$ 进行均匀离散化。您的程序不得读取任何输入，且必须仅使用内部数据。\n\n测试套件：\n为以下参数集 $(m_0,k_z,N_x,N_y)$ 计算输出：\n1. $(2.0,\\,0.3\\pi,\\,401,\\,101)$：一个有能隙的切片，预期在疑似节点之间区域的中心附近具有非平凡拓扑。\n2. $(2.0,\\,\\pi,\\,401,\\,101)$：一个有能隙的切片，远在疑似节点区域之外。\n3. $(1.5,\\,0.6\\pi,\\,401,\\,101)$：一个有能隙的切片，其位置刚好在 $m_0=1.5$ 时疑似节点 $k_z$ 值的下方。\n4. $(1.5,\\,0.75\\pi,\\,401,\\,101)$：一个有能隙的切片，其位置刚好在 $m_0=1.5$ 时疑似节点 $k_z$ 值的上方。\n5. $(2.0,\\,\\frac{\\pi}{2},\\,401,\\,101)$：一个边界切片，其 $k_z$ 值被精确调谐到一个疑似节点，这对数值稳定性提出了挑战。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含所有测试用例的结果，格式为方括号括起来的逗号分隔列表。每个测试用例的结果本身必须是一个列表，顺序为 [陈数, 最小能隙, 最大幺正性偏差, 最大规范相位差]。例如，打印：\n$$\n[\\![C_1,\\Delta_1,U_1,G_1],[C_2,\\Delta_2,U_2,G_2],\\dots,[C_5,\\Delta_5,U_5,G_5]\\!]\n$$\n数字为小数或整数，且不含空格。", "solution": "该问题要求实现一个数值算法，以表征 Weyl 半金属双带紧束缚模型的拓扑性质。此表征工作通过 Wilson 环路方法计算陈数，在三维布里渊区 (BZ) 的二维切片上进行。数值实现的有效性和稳健性将通过特定的相容性检验来确认。\n\n该物理系统由简单立方晶格上的动量空间哈密顿量描述，具体如下：\n$$\nH(\\mathbf{k}) = \\mathbf{d}(\\mathbf{k}) \\cdot \\boldsymbol{\\sigma} = d_x(\\mathbf{k})\\,\\sigma_x + d_y(\\mathbf{k})\\,\\sigma_y + d_z(\\mathbf{k})\\,\\sigma_z\n$$\n其中 $\\boldsymbol{\\sigma} = (\\sigma_x, \\sigma_y, \\sigma_z)$ 是泡利矩阵矢量，$\\mathbf{k}=(k_x, k_y, k_z)$ 是晶格动量，$\\mathbf{d}$ 矢量的分量为：\n$$\nd_x(\\mathbf{k}) = \\sin(k_x) \\\\\nd_y(\\mathbf{k}) = \\sin(k_y) \\\\\nd_z(\\mathbf{k}) = m_0 - \\cos(k_x) - \\cos(k_y) - \\cos(k_z)\n$$\n该哈密顿量有两个能带，其能量本征值为 $E_\\pm(\\mathbf{k}) = \\pm |\\mathbf{d}(\\mathbf{k})| = \\pm \\sqrt{d_x^2 + d_y^2 + d_z^2}$。在 $\\mathbf{d}(\\mathbf{k})=\\mathbf{0}$ 的点，能带是简并的，这些点被称为 Weyl 节点。这些节点受到拓扑保护，并作为 Berry 曲率的源或汇。布里渊区给定切片上的谱隙为 $2 \\min_{\\mathbf{k}} |\\mathbf{d}(\\mathbf{k})|$。\n\n对于一个有能隙的二维切片（在固定的 $k_z$），其拓扑不变量是第一陈数 $C(k_z)$。它量化了当 $\\mathbf{k}$ 遍历二维布里渊区环面时，$\\mathbf{d}$ 矢量在单位球面上的缠绕情况。非零陈数 $C(k_z) \\neq 0$ 表示该切片是拓扑非平凡的。问题指定了一种使用 Wilson 环路的稳健数值方法来计算 $C(k_z)$。\n\n算法流程如下：\n首先，对于由参数 $(m_0, k_z, N_x, N_y)$ 指定的给定测试用例，我们将二维布里渊区切片离散化为 $(k_x, k_y)$ 点的网格。对于该网格上的每个点，计算对应于较低能量本征值 $E_-(\\mathbf{k}) = -|\\mathbf{d}(\\mathbf{k})|$ 的占据带本征矢量 $|u(\\mathbf{k})\\rangle$。在数值上，这是通过构建 $2 \\times 2$ 厄米矩阵 $H(\\mathbf{k})$ 并使用标准本征求解器（如 `numpy.linalg.eigh`）来实现的，该求解器提供数值稳定且归一化的本征矢量。我们还通过追踪整个网格上 $2|\\mathbf{d}(\\mathbf{k})|$ 的最小值来计算切片上的最小谱隙。\n\n其次，我们为其网格中的每个离散 $k_y$ 值计算 Wilson 环路相位 $\\phi(k_y; k_z)$。Wilson 环路沿 $k_x$ 方向的闭合路径进行追踪。这涉及计算“连接变量”的乘积 $\\mathcal{U}_j = \\langle u(k_x^{j+1}, k_y, k_z) | u(k_x^j, k_y, k_z) \\rangle$。内积是在离散化的 $k_x$ 路径上相邻点的本征矢量之间进行的，包括从最后一个点回到第一个点的最终连接以确保闭合。为确保规范不变性，每个连接变量在相乘前都进行归一化，得到 $\\tilde{\\mathcal{U}}_j = \\mathcal{U}_j / |\\mathcal{U}_j|$。Wilson 环路相位就是完整乘积的辐角：\n$$\n\\phi(k_y; k_z) = \\arg\\left(\\prod_{j=0}^{N_x-1} \\tilde{\\mathcal{U}}_j\\right)\n$$\n\n第三，当 $k_y$ 遍历其从 $0$ 到 $2\\pi$ 的闭合路径时，从 Wilson 环路相位 $\\phi(k_y)$ 的缠绕中提取陈数 $C(k_z)$。这个缠绕数是通过首先展开相位 $\\phi(k_y)$ 以获得一个连续函数，然后确定其在周期路径上的总变化量来计算的。陈数是这个总变化量除以 $2\\pi$：\n$$\nC(k_z) = \\frac{1}{2\\pi} \\oint d\\phi = \\frac{1}{2\\pi} \\Delta\\phi_{\\text{total}}\n$$\n对于有能隙的系统，结果必须是一个整数，它是通过对计算值进行四舍五入得到的。\n\n第四，执行两个数值相容性检验。\n1.  **幺正性检验**：对于一个完全平滑的规范选择，原始（未归一化）连接变量的乘积 $\\prod_j \\mathcal{U}_j$ 的模将恰好为 1。数值离散化会引入偏差。我们通过计算所有已计算的 Wilson 环路（即，在所有 $k_y$ 上）的最大偏差 $|1 - |\\prod_j \\mathcal{U}_j||$ 来量化这一点。\n2.  **规范不变性检验**：计算出的 Wilson 环路相位 $\\phi(k_y)$ 在本征矢量的局域 U(1) 规范变换 $|u'(\\mathbf{k})\\rangle = e^{i\\theta(\\mathbf{k})} |u(\\mathbf{k})\\rangle$ 下必须保持不变，其中 $\\theta(\\mathbf{k})$ 是每个点的随机相位。这是因为在归一化连接变量的乘积中，随机相位会级数式地抵消。我们通过应用这样一个随机相位变换，重新计算 Wilson 环路相位 $\\phi'(k_y)$，并找出在所有 $k_y$ 上的最大相位差 $|\\arg(e^{i(\\phi'-\\phi)})|$ 来验证这一点。这个差异应该接近于零，仅受浮点精度的限制。\n\n该实现为每个提供的测试用例计算这四个量——陈数、最小谱隙、最大幺正性偏差和最大规范相位差。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print results.\n    \"\"\"\n    \n    # Test Suite:\n    # (m_0, k_z, N_x, N_y)\n    test_cases = [\n        (2.0, 0.3 * np.pi, 401, 101),\n        (2.0, np.pi, 401, 101),\n        (1.5, 0.6 * np.pi, 401, 101),\n        (1.5, 0.75 * np.pi, 401, 101),\n        (2.0, 0.5 * np.pi, 401, 101),\n    ]\n\n    results = []\n    for params in test_cases:\n        result = compute_slice_properties(*params)\n        results.append(result)\n\n    # Format the final output string as specified\n    result_str = \",\".join([f\"[{c},{g},{u},{gd}]\" for c, g, u, gd in results])\n    print(f\"[{result_str}]\")\n\n\ndef compute_slice_properties(m0, kz, Nx, Ny):\n    \"\"\"\n    Computes topological properties for a single (m0, kz) slice.\n\n    Args:\n        m0 (float): Model parameter.\n        kz (float): Momentum slice value.\n        Nx (int): Number of points in the kx grid.\n        Ny (int): Number of points in the ky grid.\n\n    Returns:\n        list: [Chern number, min_gap, max_unitarity_dev, max_gauge_phase_diff]\n    \"\"\"\n    # 1. Grid setup\n    kx_grid = np.linspace(0, 2 * np.pi, Nx, endpoint=False)\n    ky_grid = np.linspace(0, 2 * np.pi, Ny, endpoint=False)\n    \n    cos_kx_vals = np.cos(kx_grid)\n    sin_kx_vals = np.sin(kx_grid)\n    cos_ky_vals = np.cos(ky_grid)\n    sin_ky_vals = np.sin(ky_grid)\n    cos_kz = np.cos(kz)\n\n    # Storage for eigenvectors and gap calculation\n    all_evecs = np.zeros((Ny, Nx, 2), dtype=np.complex128)\n    min_gap_slice = np.inf\n\n    # 2. Compute eigenvectors and minimum gap over the full (kx, ky) slice\n    H = np.zeros((2, 2), dtype=np.complex128)\n    for i in range(Ny):\n        for j in range(Nx):\n            # d-vector components\n            dx = sin_kx_vals[j]\n            dy = sin_ky_vals[i]\n            dz = m0 - cos_kx_vals[j] - cos_ky_vals[i] - cos_kz\n            \n            d_norm = np.sqrt(dx**2 + dy**2 + dz**2)\n            if 2 * d_norm  min_gap_slice:\n                min_gap_slice = 2 * d_norm\n\n            # Form Hamiltonian matrix\n            H[0, 0] = dz\n            H[1, 1] = -dz\n            H[0, 1] = dx - 1j * dy\n            H[1, 0] = dx + 1j * dy\n            \n            # Diagonalize and store the occupied eigenvector.\n            # np.linalg.eigh returns sorted eigenvalues; the first eigenvector\n            # corresponds to the lowest energy (occupied band).\n            _, evecs = np.linalg.eigh(H)\n            all_evecs[i, j, :] = evecs[:, 0]\n\n    # Generate random U(1) phases for the gauge invariance check\n    np.random.seed(int(m0*100 + kz*100)) # Seed for reproducibility\n    random_phases = np.random.rand(Ny, Nx) * 2 * np.pi\n    random_phase_factors = np.exp(1j * random_phases)\n    all_evecs_gauge = all_evecs * random_phase_factors[:, :, np.newaxis]\n\n    # Storage for Wilson loop results\n    wilson_phases_norm = np.zeros(Ny, dtype=np.float64)\n    wilson_phases_norm_gauge = np.zeros(Ny, dtype=np.float64)\n    unitarity_devs_raw = np.zeros(Ny, dtype=np.float64)\n\n    # 3. Loop over ky to compute Wilson loops and perform checks\n    for i in range(Ny):\n        prod_raw = 1.0 + 0.0j\n        prod_norm = 1.0 + 0.0j\n        prod_norm_gauge = 1.0 + 0.0j\n\n        for j in range(Nx):\n            # Raw (un-normalized) links for unitarity check\n            u_curr = all_evecs[i, j, :]\n            u_next = all_evecs[i, (j + 1) % Nx, :]\n            link_raw = np.vdot(u_curr, u_next)\n            prod_raw *= link_raw\n            \n            # Normalized links for Wilson phase\n            prod_norm *= link_raw / abs(link_raw)\n\n            # Normalized links with random gauge for invariance check\n            u_curr_g = all_evecs_gauge[i, j, :]\n            u_next_g = all_evecs_gauge[i, (j + 1) % Nx, :]\n            link_g = np.vdot(u_curr_g, u_next_g)\n            prod_norm_gauge *= link_g / abs(link_g)\n        \n        unitarity_devs_raw[i] = abs(abs(prod_raw) - 1.0)\n        wilson_phases_norm[i] = np.angle(prod_norm)\n        wilson_phases_norm_gauge[i] = np.angle(prod_norm_gauge)\n\n    # Calculate Chern number from phase winding\n    unwrapped_phases = np.unwrap(wilson_phases_norm)\n    chern_number = int(round((unwrapped_phases[-1] - unwrapped_phases[0]) / (2 * np.pi)))\n\n    # Get max deviations for checks\n    max_unitarity_dev = np.max(unitarity_devs_raw)\n    \n    # Calculate phase difference correctly handling wrapping\n    phase_diffs = np.angle(np.exp(1j * (wilson_phases_norm_gauge - wilson_phases_norm)))\n    max_gauge_phase_diff = np.max(np.abs(phase_diffs))\n    \n    return [chern_number, min_gap_slice, max_unitarity_dev, max_gauge_phase_diff]\n\nif __name__ == '__main__':\n    solve()\n```", "id": "3503638"}, {"introduction": "外尔半金属独特的电子结构导致了奇异的输运现象，其中最著名的是“手性反常” (chiral anomaly)。理解这些性质需要对电子散射过程进行微观分析。这个解析问题 [@problem_id:3503586] 将引导你使用费米黄金定则推导外尔节点内部（节内）和节点之间（节间）的散射率。其结果直接影响手性电荷的弛豫时间，为实验上观测手性反常的条件提供了关键的见解。", "problem": "考虑一个时间反演对称性破缺的外尔半金属的各向同性最小模型，其具有两个手性相反的外尔节点，位于晶体动量 $\\pm \\mathbf{b}$ 处。在每个节点附近的低能描述中，哈密顿量为 $H_{s}=\\hbar v_{F} s\\, \\boldsymbol{\\sigma}\\cdot \\mathbf{q}$，其中 $s=\\pm 1$ 是手性指标，$\\mathbf{q}=\\mathbf{k}-s\\mathbf{b}$ 是从节点测量的晶体动量，$v_{F}$ 是费米速度，$\\boldsymbol{\\sigma}$ 是作用在赝自旋上的泡利矩阵。费米能 $E_{F}0$ 是从节点处测量的，因此费米面由两个半径为 $q_{F}=E_{F}/(\\hbar v_{F})$、中心位于 $\\pm \\mathbf{b}$ 的球面组成。\n\n假设存在一个标量、$\\delta$ 关联的短程杂质势 $V(\\mathbf{r})=\\sum_{i}u_{0}\\,\\delta(\\mathbf{r}-\\mathbf{R}_{i})$，杂质数密度为 $n_{i}$，并在第一玻恩近似和费米黄金定则 (FGR) 内处理无序。你可以假设谷间动量转移是允许的（即，短程势不抑制大动量转移），并且在能量 $E_{F}$ 处，两个节点的态密度是相同的。\n\n从外尔投影算符和 $H_{s}$ 所蕴含的旋量结构出发（不要在没有推导的情况下假设任何角交叠因子），计算在费米能级上由无序引起的准粒子总散射率，包括节点内散射 ($s\\to s$) 和节点间散射 ($s\\to -s$) 。请显式地进行角度积分。然后给出在 $E_{F}$ 处求值的比率\n$$r=\\frac{\\Gamma_{\\text{inter}}}{\\Gamma_{\\text{intra}}}$$\n的闭式解析表达式。最后，根据你得到的 $r$ 的结果，简要说明对于 $\\delta$ 关联无序，散射率的相对大小如何控制轴向（手性）电荷弛豫以及对由手性反常引起的纵向磁导率的抑制。你的最终答案必须是 $r$ 的单个表达式；不需要单位。", "solution": "我们从各向同性的外尔哈密顿量 $H_{s}=\\hbar v_{F} s\\, \\boldsymbol{\\sigma}\\cdot \\mathbf{q}$ 开始。其在能量 $E=\\hbar v_{F} q$ 处的正能本征态的螺旋性与 $s\\,\\hat{\\mathbf{q}}$ 对齐，其中 $\\hat{\\mathbf{q}}=\\mathbf{q}/q$。在节点 $s$ 和方向 $\\hat{\\mathbf{q}}$ 上，投影到导带旋量的投影算符是\n$$\nP_{s}(\\hat{\\mathbf{q}})=\\frac{1}{2}\\left( \\mathbb{I}+ s\\, \\hat{\\mathbf{q}}\\cdot \\boldsymbol{\\sigma}\\right).\n$$\n令 $\\lvert u_{s}(\\hat{\\mathbf{q}})\\rangle$ 表示相应的归一化旋量。对于标量无序，初始态（节点 $s$，方向 $\\hat{\\mathbf{q}}$）和末态（节点 $s'$，方向 $\\hat{\\mathbf{q}}'$）之间的旋量矩阵元的模平方进入费米黄金定则 (FGR) 的散射率中：\n$$\n\\left|\\langle u_{s'}(\\hat{\\mathbf{q}}') \\vert u_{s}(\\hat{\\mathbf{q}})\\rangle\\right|^{2}.\n$$\n计算这个量的一个便捷方法是使用投影算符。我们有\n$$\n\\left|\\langle u_{s'}(\\hat{\\mathbf{q}}') \\vert u_{s}(\\hat{\\mathbf{q}})\\rangle\\right|^{2}\n= \\operatorname{Tr}\\!\\left[P_{s}(\\hat{\\mathbf{q}})\\, P_{s'}(\\hat{\\mathbf{q}}')\\right],\n$$\n因为对于秩为一的投影算符 $P=\\lvert u\\rangle\\langle u\\rvert$ 和 $Q=\\lvert v\\rangle\\langle v\\rvert$，$\\operatorname{Tr}(PQ)=\\lvert\\langle v\\vert u\\rangle\\rvert^{2}$。使用泡利矩阵恒等式，特别是 $\\operatorname{Tr}(\\sigma_{i})=0$，$\\operatorname{Tr}(\\sigma_{i}\\sigma_{j})=2\\delta_{ij}$，并展开乘积，\n$$\n\\operatorname{Tr}\\!\\left[P_{s}(\\hat{\\mathbf{q}})\\, P_{s'}(\\hat{\\mathbf{q}}')\\right]\n=\\frac{1}{4}\\operatorname{Tr}\\!\\left[ \\left(\\mathbb{I}+ s\\, \\hat{\\mathbf{q}}\\cdot \\boldsymbol{\\sigma}\\right)\\left(\\mathbb{I}+ s'\\, \\hat{\\mathbf{q}}'\\cdot \\boldsymbol{\\sigma}\\right)\\right]\n=\\frac{1}{4}\\operatorname{Tr}\\!\\left[\\mathbb{I}+ s'\\, \\hat{\\mathbf{q}}'\\cdot \\boldsymbol{\\sigma}+ s\\, \\hat{\\mathbf{q}}\\cdot \\boldsymbol{\\sigma}+ ss'\\, (\\hat{\\mathbf{q}}\\cdot \\boldsymbol{\\sigma})(\\hat{\\mathbf{q}}'\\cdot \\boldsymbol{\\sigma})\\right].\n$$\n单个 $\\boldsymbol{\\sigma}$ 项的迹为零，而 $(\\hat{\\mathbf{q}}\\cdot \\boldsymbol{\\sigma})(\\hat{\\mathbf{q}}'\\cdot \\boldsymbol{\\sigma})=\\hat{\\mathbf{q}}\\cdot \\hat{\\mathbf{q}}' \\,\\mathbb{I}+ i(\\hat{\\mathbf{q}}\\times \\hat{\\mathbf{q}}')\\cdot \\boldsymbol{\\sigma}$ 的迹为 $2\\,\\hat{\\mathbf{q}}\\cdot \\hat{\\mathbf{q}}'$。因此，\n$$\n\\left|\\langle u_{s'}(\\hat{\\mathbf{q}}') \\vert u_{s}(\\hat{\\mathbf{q}})\\rangle\\right|^{2}\n=\\frac{1}{2}\\left(1+ ss'\\, \\hat{\\mathbf{q}}\\cdot \\hat{\\mathbf{q}}'\\right).\n$$\n\n现在我们使用费米黄金定则 (FGR) 计算费米能级的总散射率。无序势为 $V(\\mathbf{r})=\\sum_{i}u_{0}\\,\\delta(\\mathbf{r}-\\mathbf{R}_{i})$，杂质密度为 $n_{i}$。对其在杂质位置上平均后的矩阵元平方得到一个与动量转移无关的常数 $\\langle\\lvert V_{\\mathbf{q}'-\\mathbf{q}}\\rvert^{2}\\rangle = n_{i} \\lvert u_{0}\\rvert^{2}$。在能量 $E$ 处，从 $s\\to s'$ 跃迁的总速率为\n$$\n\\Gamma_{s\\to s'}(E)=\\frac{2\\pi}{\\hbar}\\, n_{i} \\lvert u_{0}\\rvert^{2}\\, \\int \\frac{d^{3}\\mathbf{q}'}{(2\\pi)^{3}}\\, \\left|\\langle u_{s'}(\\hat{\\mathbf{q}}') \\vert u_{s}(\\hat{\\mathbf{q}})\\rangle\\right|^{2}\\, \\delta\\!\\left(\\hbar v_{F} q' - E\\right).\n$$\n由于各向同性，初始方向 $\\hat{\\mathbf{q}}$ 可以无失一般性地固定下来，而 $q' = E/(\\hbar v_{F}) \\equiv q_{F}$ 由 $\\delta$ 函数固定。利用 $\\delta(\\hbar v_{F} q' - E) = \\frac{1}{\\hbar v_{F}}\\, \\delta(q' - q_{F})$ 进行积分的径向部分，\n$$\n\\Gamma_{s\\to s'}(E)=\\frac{2\\pi}{\\hbar}\\, n_{i} \\lvert u_{0}\\rvert^{2}\\, \\frac{q_{F}^{2}}{(2\\pi)^{3}}\\, \\frac{1}{\\hbar v_{F}} \\int d\\Omega_{\\hat{\\mathbf{q}}'}\\, \\left|\\langle u_{s'}(\\hat{\\mathbf{q}}') \\vert u_{s}(\\hat{\\mathbf{q}})\\rangle\\right|^{2}.\n$$\n定义每个节点的外尔态密度在能量 $E$ 处为 $D(E)=\\frac{E^{2}}{2\\pi^{2}(\\hbar v_{F})^{3}}=\\frac{q_{F}^{2}}{2\\pi^{2}\\hbar v_{F}}$。那么\n$$\n\\Gamma_{s\\to s'}(E)=\\frac{2\\pi}{\\hbar}\\, n_{i} \\lvert u_{0}\\rvert^{2}\\, D(E)\\, \\frac{1}{4\\pi}\\int d\\Omega_{\\hat{\\mathbf{q}}'}\\, \\left|\\langle u_{s'}(\\hat{\\mathbf{q}}') \\vert u_{s}(\\hat{\\mathbf{q}})\\rangle\\right|^{2}.\n$$\n引入 $\\theta$ 作为 $\\hat{\\mathbf{q}}$ 和 $\\hat{\\mathbf{q}}'$ 之间的夹角，因此 $\\hat{\\mathbf{q}}\\cdot \\hat{\\mathbf{q}}'=\\cos\\theta$。使用上面求出的交叠，\n$$\n\\left|\\langle u_{s'}(\\hat{\\mathbf{q}}') \\vert u_{s}(\\hat{\\mathbf{q}})\\rangle\\right|^{2}=\\frac{1}{2}\\left(1+ ss'\\cos\\theta\\right).\n$$\n在单位球面上的角度平均为\n$$\n\\frac{1}{4\\pi}\\int d\\Omega_{\\hat{\\mathbf{q}}'}\\, \\frac{1}{2}\\left(1+ ss'\\cos\\theta\\right)\n=\\frac{1}{2}\\left(1+ ss'\\, \\frac{1}{4\\pi}\\int d\\Omega_{\\hat{\\mathbf{q}}'}\\, \\cos\\theta\\right)\n=\\frac{1}{2}\\left(1+ ss'\\times 0\\right)\n=\\frac{1}{2},\n$$\n因为根据对称性 $\\int d\\Omega\\, \\cos\\theta=0$。因此，节点内 ($s'=s$) 和节点间 ($s'=-s$) 的总散射率都获得相同的角度因子 $\\frac{1}{2}$。具体地，\n$$\n\\Gamma_{\\text{intra}}(E)=\\Gamma_{s\\to s}(E)=\\frac{2\\pi}{\\hbar}\\, n_{i} \\lvert u_{0}\\rvert^{2}\\, D(E)\\, \\frac{1}{2},\\qquad\n\\Gamma_{\\text{inter}}(E)=\\Gamma_{s\\to -s}(E)=\\frac{2\\pi}{\\hbar}\\, n_{i} \\lvert u_{0}\\rvert^{2}\\, D(E)\\, \\frac{1}{2}.\n$$\n立即可以得出，在费米能 $E_{F}$ 处的比率为\n$$\nr=\\frac{\\Gamma_{\\text{inter}}(E_{F})}{\\Gamma_{\\text{intra}}(E_{F})}=1.\n$$\n\n关于对手性反常的影响，轴向（手性）电荷弛豫时间 $\\tau_{v}$ 由节点间散射率决定，$\\tau_{v}^{-1}=\\Gamma_{\\text{inter}}$，因为只有节点间过程才能弛豫节点布居数的不平衡。由于对于 $\\delta$ 关联的短程无序，$\\Gamma_{\\text{inter}}$ 与节点内动量弛豫率的大小相同，因此 $\\tau_{v}$ 和输运时间之间没有参数上的分离，这意味着相对于平滑无序（其中 $\\Gamma_{\\text{inter}}\\ll \\Gamma_{\\text{intra}}$）的情况，由手性反常引起的纵向磁导率受到强烈抑制。", "answer": "$$\\boxed{1}$$", "id": "3503586"}]}