## 引言
在量子尺度下，当电子流经[纳米结构](@entry_id:148157)时，其行为由量子力学主导，展现出经典的[欧姆定律](@entry_id:276027)无法描述的丰富现象。[非平衡格林函数](@entry_id:201883)（NEGF）方法是理论和计算[凝聚态物理学](@entry_id:140205)中最为强大和普适的工具之一，专门用于解决此类[量子输运](@entry_id:138932)问题。它提供了一个严谨的框架，用于模拟电子从宏观电极（源）注入一个纳米尺度的中心器件区，并最终流向另一个电极（漏）的全过程，尤其适用于系统处于非热力学平衡的状态（例如，外加偏压下）。然而，NEGF复杂的数学形式往往让初学者望而却步。本文旨在系统性地梳理NEGF的核心思想与应用，填补从抽象理论到实际应用的认知鸿沟。

本文将引导读者分三步深入掌握NEGF方法。首先，在“原理与机制”一章中，我们将从第一性原理出发，详细推导NEGF形式主义的数学结构，阐明自能、格林函数和[透射系数](@entry_id:756126)等核心概念的物理意义，并讨论其如何内在地满足电荷守恒等基本物理定律。接着，在“应用与[交叉](@entry_id:147634)学科联系”一章中，我们将展示NEGF在解决真实物理问题中的威力，通过一系列涵盖[纳米电子学](@entry_id:175213)、[自旋电子学](@entry_id:141468)、介观物理乃至超导现象的案例，彰显其强大的通用性和解释力。最后，为了将理论付诸实践，“动手实践”部分提供了一系列精心设计的计算练习，帮助读者亲手实现NEGF算法，从而巩固理论知识，并深刻理解模型参数如何影响最终的输运结果。

## 原理与机制

本章深入探讨[非平衡格林函数](@entry_id:201883)（NEGF）理论的核心原理与机制。在“引言”章节对该领域进行了初步介绍之后，我们将在这里系统地构建NEGF形式主义的数学框架。我们将从一个中心分子器件与宏观电极耦合的系统出发，逐步推导出描述[量子输运](@entry_id:138932)的关键物理量，如[自能](@entry_id:145608)、[格林函数](@entry_id:147802)和透射系数。此外，我们将阐明该理论如何内在地满足[电荷守恒](@entry_id:264158)、规范不变性和[微观可逆性](@entry_id:136535)等基本物理定律。最后，我们将讨论一些重要的近似方法及其适用范围，并介绍如何利用NEGF框架处理更复杂的物理情景，如[非抛物线性](@entry_id:147393)能带、[磁场](@entry_id:153296)效应以及非弹性散射。

### NEGF机制：分区、[自能](@entry_id:145608)与[格林函数](@entry_id:147802)

NEGF形式主义的出发点是将整个系统巧妙地划分为几个相互作用的部分。考虑一个典型的[量子输运](@entry_id:138932)裝置，它由一个核心的**器件区**（Device, $D$）和与之相连的多个**电极**（Leads, $\alpha$）组成。电极通常是宏观的导体，作为电子的源和漏，其内部处于热力学平衡状态，并由各自的化学势 $\mu_{\alpha}$ 表征。

在[单粒子近似](@entry_id:138558)下，整个系统的[哈密顿量](@entry_id:172864) $H$ 可以被划分为三个部分：描述孤立器件区的[哈密顿量](@entry_id:172864) $H_D$，描述各个孤立电极的[哈密顿量](@entry_id:172864)之和 $\sum_{\alpha} H_{\alpha}$，以及描述器件与电极之间耦合的[哈密顿量](@entry_id:172864) $\sum_{\alpha} V_{D\alpha}$ [@problem_id:2790660]。因此，总[哈密顿量](@entry_id:172864)写作：

$H = H_D + \sum_{\alpha} H_{\alpha} + \sum_{\alpha} V_{D\alpha}$

这里的 $H_D$ 仅作用于器件区的[希尔伯特空间](@entry_id:261193)，$H_{\alpha}$ 仅作用于电极 $\alpha$ 的空间，而 $V_{D\alpha}$ 则连接了这两个[子空间](@entry_id:150286)。为了确保总[哈密顿量](@entry_id:172864)是厄米的，耦合项必须满足 $V_{\alpha D} = V_{D\alpha}^{\dagger}$。

我们的目标是理解器件区的物理性质，但它已不再是一个孤立系统。电极的存在为器件中的电子提供了一系列连续的逃逸（或注入）通道，使得器件区的[本征态](@entry_id:149904)具有了有限的寿命。在NEGF的语言中，我们将电极的自由度“积分掉”，将其对器件的影响等效地封装到一个能量依赖的有效势中，这个势就是**[自能](@entry_id:145608)（Self-energy）**。

对于电极 $\alpha$，其对器件的贡献由**推迟[自能](@entry_id:145608)** $\Sigma_{\alpha}^r(E)$ 描述，其定义为：

$\Sigma_{\alpha}^r(E) = V_{D\alpha} g_{\alpha}^r(E) V_{\alpha D}$

其中，$g_{\alpha}^r(E) = [E + i0^+ - H_{\alpha}]^{-1}$ 是孤立电极 $\alpha$ 在其与器件接触边界处的**表面格林函数**。$0^+$ 是一个无穷小的正数，确保了[推迟格林函数](@entry_id:139183)的因果性。这个公式的物理意义是：一个电子从器件通过 $V_{\alpha D}$ 跃迁到电极边界，在电极内以 $g_{\alpha}^r(E)$ 的形式传播，然后再通过 $V_{D\alpha}$ 返回器件。

将所有电极的影响都归结为[自能](@entry_id:145608)后，器件区的[推迟格林函数](@entry_id:139183) $G_D^r(E)$ 可以通过求解如下的**[戴森方程](@entry_id:146246)（Dyson's equation）**得到：

$G_D^r(E) = \left[E + i0^+ - H_D - \sum_{\alpha} \Sigma_{\alpha}^r(E)\right]^{-1}$

这个方程是NEG[F理论](@entry_id:184208)的核心。它表明，器件的有效哈密顿量变成了 $H_{\text{eff}}(E) = H_D + \sum_{\alpha} \Sigma_{\alpha}^r(E)$，这是一个能量依赖的非[厄米算符](@entry_id:153410)。

[自能](@entry_id:145608) $\Sigma_{\alpha}^r(E)$ 的非[厄米性](@entry_id:141899)是[开放量子系统](@entry_id:138632)的本质特征。我们可以将其分解为厄米和反厄米两部分：
- 厄米部分，$\Lambda_{\alpha}(E) = \frac{1}{2}(\Sigma_{\alpha}^r + \Sigma_{\alpha}^{r\dagger})$，通常被称为**[能级移动](@entry_id:156631)（Level shift）**。它导致器件的能级相对于孤立情况发生能量上的重新归一化。
- 反厄米部分则与电子的有限寿命直接相关，并定义了**展宽函数（Broadening function）**或**[耦合矩阵](@entry_id:191757)** $\Gamma_{\alpha}(E)$：

$\Gamma_{\alpha}(E) = i\left[\Sigma_{\alpha}^r(E) - \Sigma_{\alpha}^{a}(E)\right] = i\left[\Sigma_{\alpha}^r(E) - \Sigma_{\alpha}^{r\dagger}(E)\right]$

其中 $\Sigma_{\alpha}^{a}(E) = (\Sigma_{\alpha}^r(E))^{\dagger}$ 是超前[自能](@entry_id:145608)。$\Gamma_{\alpha}(E)$ 是一个厄米且正半定的矩阵，其对角元量化了器件能级因与电极 $\alpha$ 耦合而产生的能量展宽，这正比于电子从器件隧穿到电极 $\alpha$ 的速率 [@problem_id:2790660]。如果器件与所有电极的耦合 $V_{D\alpha}$ 趋于零，那么[自能](@entry_id:145608)和展宽函数也都将趋于零。

### 从[格林函数](@entry_id:147802)到电流：Landauer-Büttiker 公式

一旦我们获得了器件的[格林函数](@entry_id:147802) $G_D^r(E)$ 和展宽函数 $\Gamma_{\alpha}(E)$，我们就可以计算通过器件的[稳态电流](@entry_id:276565)。对于一个多端器件，从电极 $\alpha$ 流入器件的净电流 $I_{\alpha}$ 由**[Landauer-Büttiker公式](@entry_id:141644)**给出 [@problem_id:3482877]：

$I_{\alpha} = \frac{e^2}{h} \sum_{\beta \neq \alpha} \int_{-\infty}^{\infty} T_{\beta\alpha}(E) \left[ f_{\alpha}(E) - f_{\beta}(E) \right] dE$

这里，$e$ 是元[电荷](@entry_id:275494)，$h$ 是普朗克常数，$f_{\alpha}(E) = [1 + \exp((E - \mu_{\alpha}) / k_B T)]^{-1}$ 是电极 $\alpha$ 的[费米-狄拉克分布](@entry_id:138909)函数。$T_{\beta\alpha}(E)$ 是电子在能量 $E$ 处从电极 $\alpha$ 注入并最终被电极 $\beta$ 收集的**[透射系数](@entry_id:756126)（Transmission coefficient）**。

在NEGF框架下，[透射系数](@entry_id:756126)由著名的**Caroli公式**给出：

$T_{\beta\alpha}(E) = \mathrm{Tr}\left[\Gamma_{\beta}(E) G_D^r(E) \Gamma_{\alpha}(E) G_D^a(E)\right]$

其中，$G_D^a(E) = [G_D^r(E)]^{\dagger}$ 是器件的超前[格林函数](@entry_id:147802)。这个公式有一个直观的物理解释：$\Gamma_{\alpha}$ 描述了电子以一定速率从电极 $\alpha$ 注入到器件中；$G_D^r$ 描述了电子从注入点到收集点的传播过程；$\Gamma_{\beta}$ 描述了电子以一定速率从器件逃逸到电极 $\beta$ 中；$G_D^a$ 描述了伴随的复共轭传播过程。迹（Trace）运算则对所有可能的注入和收集通道进行了求和。

在最简单的双端（左 $L$ 和右 $R$）器件情形下，从左向右的净电流为：

$I = I_L = -I_R = \frac{e^2}{h} \int_{-\infty}^{\infty} T_{RL}(E) \left[ f_L(E) - f_R(E) \right] dE$

其中透射函数 $T(E) \equiv T_{RL}(E) = \mathrm{Tr}[\Gamma_R(E) G_D^r(E) \Gamma_L(E) G_D^a(E)]$。当器件与电极的耦合消失时，$\Gamma_{\alpha} \to 0$，透射系数为零，电流也自然消失 [@problem_id:2790660]。

### 基本[对称性与守恒律](@entry_id:160300)

NEGF形式主义的强大之处在于它严格遵守物理学的基本[对称性与守恒律](@entry_id:160300)，这为其提供了坚实的理论基础。

#### 电荷守恒

在[稳态](@entry_id:182458)输运中，流入器件的总[电荷](@entry_id:275494)必须等于流出的总[电荷](@entry_id:275494)，即所有电极的净電流之和为零：$\sum_{\alpha} I_{\alpha} = 0$。这个全局的**电荷守恒定律**在NEGF框架中是自然满足的。其根源在于透射矩阵的对称性：在没有[磁场](@entry_id:153296)的情况下，$T_{\alpha\beta}(E) = T_{\beta\alpha}(E)$。将此关系代入[Landauer-Büttiker公式](@entry_id:141644)，可以立即证明 $\sum_{\alpha} I_{\alpha} = 0$ [@problem_id:3482877]。这种对称性是[微观可逆性原理](@entry_id:137392)的体现。

一个更强的守恒关系是**局域（能量分辨）[电荷守恒](@entry_id:264158)**。它要求在每个能量 $E$ 处，流入和流出器件的谱电流之和为零。即 $\sum_{\alpha} I_{\alpha}(E) = 0$，其中 $I_{\alpha}(E) = \frac{e^2}{h} \sum_{\beta \neq \alpha} T_{\beta\alpha}(E) [f_{\alpha}(E) - f_{\beta}(E)]$。这同样源于 $T_{\alpha\beta}(E)$ 的对称性 [@problem_id:3492901]。

#### 规范不变性

物理定律不应依赖于能量零点的选择。NEGF形式主义遵守**规范不变性（Gauge Invariance）**。如果我们将系统中所有的能量（包括[哈密顿量](@entry_id:172864)中的 onsite energy 和电极的化学势）都平移一个常数 $\Delta$：
$H \to H + \Delta I, \quad \mu_{\alpha} \to \mu_{\alpha} + \Delta$
那么，可以证明计算出的电流 $I_{\alpha}$ 保持不变。这是因为[自能](@entry_id:145608)、格林函数和费米分布函数都会以一种協變的方式平移，使得在电流的积分表达式中，能量的平移可以被积分变量的平移完全吸收，从而保持积分值不变 [@problem_id:3482877]。数值计算中验证[规范不变性](@entry_id:137857)是检验代码实现是否正确的重要手段。

#### [微观可逆性](@entry_id:136535)与[Onsager-Casimir关系](@entry_id:141345)

当系统存在[磁场](@entry_id:153296) $\mathbf{B}$ 时，[哈密顿量](@entry_id:172864)会变为复数（通过[Peierls相](@entry_id:158918)因子引入），[时间反演对称性](@entry_id:138094)被破坏。此时，透射矩阵不再是对称的，即 $T_{pq}(B) \neq T_{qp}(B)$。然而，一个更普适的对称性——**[Onsager-Casimir关系](@entry_id:141345)**——仍然成立：

$T_{pq}(\mathbf{B}) = T_{qp}(-\mathbf{B})$

这个关系是[微观可逆性原理](@entry_id:137392)在有[磁场](@entry_id:153296)情况下的推广，它指出，在反向[磁场](@entry_id:153296)下，交换源和漏的[透射概率](@entry_id:137943)与原始情况相同 [@problem_id:3482898]。

这一深刻的对称性要求输运模型是物理上自洽的。例如，它必须基于一个厄米的[哈密顿量](@entry_id:172864)（即使是复数）和满足因果性的自能。如果人为地引入一个非厄米的[哈密顿量](@entry_id:172864)（例如，在离散化中引入了非守恒项），或者使用一个不符合物理的[自能](@entry_id:145608)（例如，用超前[格林函数](@entry_id:147802)构建推迟自能），[Onsager-Casimir关系](@entry_id:141345)将被破坏，数值计算会得到 $| T_{pq}(\mathbf{B}) - T_{qp}(-\mathbf{B}) | > 0$ 的结果，这标志着模型或计算中存在根本性的错误 [@problem_id:3482888]。

### 实际实现：自能计算与近似

理论框架的建立依赖于[自能](@entry_id:145608) $\Sigma^r_\alpha(E)$ 的计算。对于实际的电极材料，这可能非常复杂。

#### 一维[紧束缚](@entry_id:142573)电极的精确自能

最简单的可解析模型是一维半无限紧束缚链。对于具有 onsite energy $\varepsilon_0$ 和最近邻 hopping $t$ 的链，其表面格林函数 $g^r_{surf}(E)$ 可以通过求解一个[二次方程](@entry_id:163234)得到 [@problem_id:3482922]：

$g^r_{surf}(E) = \frac{(E - \varepsilon_0) - \sqrt{(E - \varepsilon_0)^2 - 4t^2}}{2t^2}$

其中，平方根的支路选择需保证格林函数代表向外传播的波，即在能量上半复平面解析。代入[自能](@entry_id:145608)表达式，我们便得到一个精确的、能量依赖的自能和展宽函数 $\Gamma_\alpha(E)$。该展宽函数只在电极能带内部（$|E - \varepsilon_0|  2|t|$）非零，并在能带边缘呈现出与一维态密度（DOS）成比例的平方根发散，即所谓的**[范霍夫奇点](@entry_id:144019)（van Hove singularity）**。

#### 宽带极限近似 (WBL)

精确计算能量依赖的自能通常代价高昂。**宽带极限近似（Wide-Band Limit, WBL）**是一种广泛应用的简化方法。其核心假设是，在感兴趣的能量范围内（例如，偏压窗口内），电极的[态密度](@entry_id:147894)和[耦合矩阵](@entry_id:191757)元变化缓慢。这使得我们可以将展宽函数 $\Gamma_{\alpha}(E)$ 近似为一个与能量无关的常数矩阵 $\Gamma_{\alpha,0}$。同时，[能级移动](@entry_id:156631)项 $\Lambda_{\alpha}(E)$ 也被视为常数，或者常常被忽略（等效于将其吸收到 $H_D$ 的重新定义中） [@problem id:3482922]。

WBL的优点是极大地简化了计算，并且对于单个能级的器件，它能解析地给出一个洛伦兹形状的透射峰。然而，这个近似的局限性也十分显著 [@problem_id:2790670]：
1.  **物理带宽的忽略**：WBL预测在所有能量下都有非零的透射，而真实电极的能带是有限的。当偏压窗口或器件能级落在电极能带之外时，WBL会严重高估电流 [@problem_id:2790670]。
2.  **[态密度](@entry_id:147894)特征的丢失**：它无法描述由电极DOS的特定结构（如[范霍夫奇点](@entry_id:144019)）引起的输运特性。因此，在能带边缘附近，WBL的误差会急剧增大 [@problem_id:3482922]。
3.  **因果性的破坏**：同时将[自能](@entry_id:145608)的实部和虚部设为常数，违反了连接它们的**Kramers-Kronig关系**，这意味着WBL在根本上破坏了因果性。
4.  **瞬态动力学的失效**：在时域中，能量依赖的自能对应于一个有[记忆效应](@entry_id:266709)的积分核，而WBL则对应于一个瞬时（$\delta$-函数）响应。因此，WBL无法准确描述系统在偏压突变后的短时瞬态行为 [@problem_id:2790670]。

尽管有这些限制，WBL在描述远离能带边缘、且电极DOS平滑的金属电极时，仍然是一个非常有用且高效的近似。特别地，在零温零偏压的[线性响应区](@entry_id:751325)，如果WBL的常数值取在[费米能级](@entry_id:143215)处，它可以精确地给出系统的[电导](@entry_id:177131) [@problem_id:2790670]。

#### 超越简单模型

NEGF框架的普适性使其能够处理更复杂的[哈密顿量](@entry_id:172864)。例如，在[半导体异质结](@entry_id:144379)中，由于能带的[非抛物线性](@entry_id:147393)，载流子的**有效质量** $m^*$ 会依赖于能量。更复杂的是，在不同材料组成的界面处，[有效质量](@entry_id:142879)还会随位置变化。处理这种 $m^*(E, z)$ 的问题需要格外小心，以保证[哈密顿量](@entry_id:172864)的[厄米性](@entry_id:141899)和[电流守恒](@entry_id:151931)。一种自洽的方法是采用**BenDaniel-Duke[哈密顿量](@entry_id:172864)**形式，其[动能算符](@entry_id:265633)写作 $\hat{T}(E) = -\frac{\hbar^2}{2} \frac{d}{dz} ( \frac{1}{m^*(E,z)} \frac{d}{dz} )$，然后在每个能量E求解散射问题。一个更基本的方法是使用多带$\mathbf{k}\cdot\mathbf{p}$[哈密顿量](@entry_id:172864)，其中[非抛物线性](@entry_id:147393)作为带间耦合的自然结果出现，避免了$H$对$E$的[非线性依赖](@entry_id:265776)，并且可以无缝地整合到NEGF框架中 [@problem_id:2482479]。

### 模拟非弹性效应：Büttiker探针

到目前为止，我们讨论的都是相干弹性输运。NEGF也可以被扩展用于描述非弹性散射过程。一个简单而巧妙的方法是引入**Büttiker探针（Büttiker probes）** [@problem_id:3492901]。

Büttiker探针是连接到器件特定位置的虚拟电极。与作为源或漏的真实电极不同，探针的定义是其自身不产生净电流。在能量分辨的图像中，这意味着流入探针的谱电流在每个能量 $E$ 处都必须为零，$I_p(E) = 0$。

这个条件被用来确定探针的未知“占据函数” $f_p(E)$。对于一个包含多个探针和真实电极的系统，在每个能量 $E$ 处，通过求解一个由 $I_p(E) = 0$ 条件构成的[线性方程组](@entry_id:148943)，可以得到所有探针的 $f_p(E)$。

Büttiker探针的物理意义在于，它允许电子进入探针，失去其相位信息，然后再重新注入到器件中，但净[电荷交换](@entry_id:186361)为零。这有效地模拟了局域的** dephasing ([退相干](@entry_id:145157))** 或电压测量过程。引入探针后，系统的总电流仍然守恒，但透射系数会发生改变，反映了非弹性散射对相干输运的影响。