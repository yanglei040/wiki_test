{"hands_on_practices": [{"introduction": "量子蒙特卡洛（QMC）模拟产生的是一系列相关的样本点，而非相互独立的样本。本练习旨在引导您学习如何通过引入积分自相关时间的概念，来正确计算诸如能量等物理量的统计误差。掌握这项技能是任何蒙特卡洛模拟获得可靠科学结果的第一步 ([@problem_id:3482381])。", "problem": "在一个针对周期性固体的变分蒙特卡罗（VMC）计算中，局域能量 $E_{L}(\\mathbf{R})$ 是沿着一条由 Metropolis–Hastings 采样器生成的马尔可夫链 $\\{\\mathbf{R}_{i}\\}_{i=1}^{M}$ 进行评估的。该采样器使目标分布 $|\\Psi_{T}(\\mathbf{R})|^{2}$ 保持不变，其中 $\\Psi_{T}$ 是一个归一化的试探波函数。假设该链是平稳且遍历的，具有一个良定义的自协方差函数 $C(t) \\equiv \\operatorname{Cov}(E_{L,i},E_{L,i+t})$ 和归一化自相关函数 $\\rho(t) \\equiv C(t)/C(0)$，其中延迟 $t \\in \\mathbb{Z}_{\\ge 0}$。积分自相关时间定义为\n$$\n\\tau_{\\text{int}} \\equiv \\frac{1}{2} + \\sum_{t=1}^{\\infty} \\rho(t),\n$$\n前提是该级数绝对收敛。局域能量的样本均值为 $\\bar{E} \\equiv \\frac{1}{M}\\sum_{i=1}^{M} E_{L,i}$，并令 $\\operatorname{Var}(E_{L}) \\equiv C(0)$ 表示平稳方差。\n\n从以上定义和平稳随机过程的标准性质出发，推导样本均值 $\\bar{E}$ 的标准误差 $\\sigma_{\\bar{E}}$ 关于 $\\tau_{\\text{int}}$、$\\operatorname{Var}(E_{L})$ 和 $M$ 的渐近表达式。清晰地说明在此情景下，关于 $\\bar{E}$ 的中心极限定理成立所需的最小正则性条件，并解释在变分蒙特卡罗（VMC）、扩散蒙特卡罗（DMC）和全组态相互作用量子蒙特卡罗（FCIQMC）中，这些条件通常是如何被满足或违背的。\n\n然后，使用您推导的表达式，根据一次长时间 VMC 模擬中测得的以下参数，计算 $\\sigma_{\\bar{E}}$ 的数值：$\\tau_{\\text{int}}=15.0$，$\\operatorname{Var}(E_{L})=0.42$ Hartree$^{2}$，以及 $M=6.0\\times 10^{6}$。用 Hartree 单位表示最终的标准误差，并将答案四舍五入到三位有效数字。", "solution": "该问题是有效的。它在科学上基于蒙特卡罗模拟的统计分析，这是计算材料科学的基石之一。所提供的定义是标准的，问题是良定的、客观的且自洽的。我们将分三部分进行解答：首先，推导标准误差；其次，讨论中心极限定理的适用性；最后，进行数值计算。\n\n第一步是推导样本均值 $\\bar{E}$ 的标准误差 $\\sigma_{\\bar{E}}$ 的渐近表达式。标准误差定义为样本均值方差的平方根，即 $\\sigma_{\\bar{E}} \\equiv \\sqrt{\\operatorname{Var}(\\bar{E})}$。\n\n样本均值定义为 $\\bar{E} \\equiv \\frac{1}{M}\\sum_{i=1}^{M} E_{L,i}$，其中 $E_{L,i} \\equiv E_{L}(\\mathbf{R}_i)$ 是来自平稳随机过程的样本。$\\bar{E}$ 的方差为：\n$$\n\\operatorname{Var}(\\bar{E}) = \\operatorname{Var}\\left(\\frac{1}{M}\\sum_{i=1}^{M} E_{L,i}\\right) = \\frac{1}{M^{2}} \\operatorname{Var}\\left(\\sum_{i=1}^{M} E_{L,i}\\right)\n$$\n一组随机变量之和的方差是其协方差矩阵中所有元素的总和：\n$$\n\\operatorname{Var}\\left(\\sum_{i=1}^{M} E_{L,i}\\right) = \\sum_{i=1}^{M} \\sum_{j=1}^{M} \\operatorname{Cov}(E_{L,i}, E_{L,j})\n$$\n由于马尔可夫链被假定为平稳的，协方差仅取决于时间延迟 $t = |i-j|$，即 $\\operatorname{Cov}(E_{L,i}, E_{L,j}) = C(|i-j|)$。这个双重求和可以按延迟 $t$ 重新组合：\n$$\n\\sum_{i=1}^{M} \\sum_{j=1}^{M} C(|i-j|) = \\sum_{i=1}^{M} C(0) + \\sum_{i \\ne j} C(|i-j|) = M C(0) + 2 \\sum_{t=1}^{M-1} (M-t) C(t)\n$$\n在这里，项 $(M-t)$ 表示延迟为 $t$ 的配对 $(i,j)$ 的数量。将其代回 $\\operatorname{Var}(\\bar{E})$ 的表达式中，得到精确结果：\n$$\n\\operatorname{Var}(\\bar{E}) = \\frac{1}{M^{2}} \\left[ M C(0) + 2 \\sum_{t=1}^{M-1} (M-t) C(t) \\right] = \\frac{C(0)}{M} \\left[ 1 + 2 \\sum_{t=1}^{M-1} \\left(1 - \\frac{t}{M}\\right) \\frac{C(t)}{C(0)} \\right]\n$$\n我们需要一个对于大 $M$ 的渐近表达式。在此极限下，对于任何固定的延迟 $t$，项 $t/M \\to 0$。由于过程是遍历的，自协方差 $C(t)$ 必须在 $t \\to \\infty$ 时衰减至 $0$，并且求和由小的 $t$ 项主导。因此，对于大的 $M$，我们可以近似 $(1 - t/M) \\approx 1$ 并将求和的上限扩展到无穷大：\n$$\n\\operatorname{Var}(\\bar{E}) \\approx \\frac{C(0)}{M} \\left[ 1 + 2 \\sum_{t=1}^{\\infty} \\frac{C(t)}{C(0)} \\right]\n$$\n使用定义 $\\rho(t) \\equiv C(t)/C(0)$ 和 $\\operatorname{Var}(E_{L}) \\equiv C(0)$，我们得到：\n$$\n\\operatorname{Var}(\\bar{E}) \\approx \\frac{\\operatorname{Var}(E_{L})}{M} \\left[ 1 + 2 \\sum_{t=1}^{\\infty} \\rho(t) \\right]\n$$\n问题将积分自相关时间定义为 $\\tau_{\\text{int}} \\equiv \\frac{1}{2} + \\sum_{t=1}^{\\infty} \\rho(t)$。我们可以重新排列这个式子，将求和表示为 $\\sum_{t=1}^{\\infty} \\rho(t) = \\tau_{\\text{int}} - \\frac{1}{2}$。将此代入我们的方差表达式中：\n$$\n\\operatorname{Var}(\\bar{E}) \\approx \\frac{\\operatorname{Var}(E_{L})}{M} \\left[ 1 + 2 \\left(\\tau_{\\text{int}} - \\frac{1}{2}\\right) \\right] = \\frac{\\operatorname{Var}(E_{L})}{M} [1 + 2\\tau_{\\text{int}} - 1] = \\frac{2 \\tau_{\\text{int}} \\operatorname{Var}(E_{L})}{M}\n$$\n标准误差 $\\sigma_{\\bar{E}}$ 是方差的平方根：\n$$\n\\sigma_{\\bar{E}} \\approx \\sqrt{\\frac{2 \\tau_{\\text{int}} \\operatorname{Var}(E_{L})}{M}}\n$$\n这个表达式表明，与 $M$ 个独立样本的情况相比，均值的方差被放大了 $2\\tau_{\\text{int}}$ 倍。量 $M_{\\text{eff}} = M / (2\\tau_{\\text{int}})$ 通常被解释为有效独立样本数。\n\n接下来，我们讨论样本均值 $\\bar{E}$ 的中心极限定理（CLT）成立所需的最小正则性条件，以及这些条件在VMC、DMC和FCIQMC中的情况。对于平稳的相关过程，CLT指出当 $M \\to \\infty$ 时，$\\sqrt{M}(\\bar{E} - \\mathbb{E}[E_{L}])$ 依分布收敛到一个正态分布 $\\mathcal{N}(0, \\sigma^2_{\\text{CLT}})$。其最小条件是：\n1.  过程 $\\{E_{L,i}\\}$ 必须是平稳且遍历的。这在问题陈述中已给出，并且是 Metropolis-Hastings 算法的一个设计目标。\n2.  局域能量的方差 $\\operatorname{Var}(E_{L}) = C(0)$ 必须是有限的。更一般地，一些定理要求存在高于二阶的矩，例如，对于某个 $\\delta > 0$，有 $\\mathbb{E}[|E_{L}|^{2+\\delta}]  \\infty$。\n3.  相关性必须足够快地衰减。一个充分条件是自协方差函数的绝对可加性，即 $\\sum_{t=0}^{\\infty} |C(t)|  \\infty$。这确保了极限正态分布的方差 $\\sigma^2_{\\text{CLT}} = \\sum_{t=-\\infty}^{\\infty} C(t) = 2\\tau_{\\text{int}}\\operatorname{Var}(E_{L})$ 是有限的。\n\n对特定QMC方法的讨论：\n-   **变分蒙特卡罗 (VMC):** 局域能量为 $E_{L}(\\mathbf{R}) = (\\hat{H}\\Psi_T(\\mathbf{R}))/\\Psi_T(\\mathbf{R})$。如果试探波函数 $\\Psi_T$ 的节点与精确本征态的节点不匹配，那么在 $\\Psi_T(\\mathbf{R})=0$ 的节面上 $E_L$ 会发散。尽管采样概率 $|\\Psi_T|^2$ 在节点处也为零，但采样器可以任意接近节点，导致 $E_L$ 值极大。这可能导致 $E_L$ 的分布呈重尾状，甚至可能具有无限方差。因此，条件(2)不能保证成立，且可能被违背。在实践中，对于高质量的波函数，方差通常被视为有限的，但其存在的形式合理性值得怀疑。相关性衰减（条件3）通常是满足的。\n-   **扩散蒙特卡罗 (DMC):** DMC也存在同样的问题。在固定节点DMC中，局域能量 $E_L$被用作估计量。它在引导函数 $\\Psi_T$ 的预设节面上发散。对条件(2)的违背是DMC中一个众所周知且实际存在的问题，尤其对于具有深层核心势的系统，这会导致不稳定的能量涨落，使得标准CLT的形式适用性无效。统计分析通常在CLT成立的假设下进行，但这更多是一个实际的选择，而非经过严格证明的选择。\n-   **全组态相互作用QMC (FCIQMC):** 该方法在斯莱特行列式的离散基中进行。能量通常通过投影估计量计算，例如 $E = \\langle \\Psi_{\\text{ref}} | H | \\Psi \\rangle / \\langle \\Psi_{\\text{ref}} | \\Psi \\rangle$，其中 $|\\Psi\\rangle$ 是波函数的随机表示。被采样的量是行列式上的walker布居数，这些估计量不会遇到与实空间节面相关的发散问题。分子和分母的方差通常是有限的。因此，假设模拟已达到平稳状态，CLT的条件通常是满足的。FCIQMC中的主要统计挑战通常是较大的积分自相关时间 $\\tau_{\\text{int}}$，而非无限方差。\n\n最后，我们使用提供的参数计算 $\\sigma_{\\bar{E}}$ 的数值。\n推导出的表达式为 $\\sigma_{\\bar{E}} = \\sqrt{\\frac{2 \\tau_{\\text{int}} \\operatorname{Var}(E_{L})}{M}}$。\n给定的参数是：\n-   $\\tau_{\\text{int}} = 15.0$\n-   $\\operatorname{Var}(E_{L}) = 0.42 \\, \\text{Hartree}^2$\n-   $M = 6.0 \\times 10^{6}$\n\n将这些值代入公式：\n$$\n\\sigma_{\\bar{E}} = \\sqrt{\\frac{2 \\times 15.0 \\times 0.42}{6.0 \\times 10^{6}}} \\, \\text{Hartree}\n$$\n$$\n\\sigma_{\\bar{E}} = \\sqrt{\\frac{12.6}{6.0 \\times 10^{6}}} \\, \\text{Hartree}\n$$\n$$\n\\sigma_{\\bar{E}} = \\sqrt{2.1 \\times 10^{-6}} \\, \\text{Hartree}\n$$\n$$\n\\sigma_{\\bar{E}} = \\sqrt{2.1} \\times 10^{-3} \\, \\text{Hartree} \\approx 1.449137... \\times 10^{-3} \\, \\text{Hartree}\n$$\n将结果四舍五入到三位有效数字，我们得到：\n$$\n\\sigma_{\\bar{E}} \\approx 1.45 \\times 10^{-3} \\, \\text{Hartree}\n$$", "answer": "$$\\boxed{1.45 \\times 10^{-3}}$$", "id": "3482381"}, {"introduction": "在QMC计算中，试探波函数的质量对模拟的效率和准确性至关重要。本练习提供了一个动手编程的机会，旨在探索如何通过精确满足描述两粒子碰撞时波函数行为的“核-电”或“电-电”尖点条件，来显著降低局域能量的方差。这个练习将清晰地揭示波函数的解析形式与模拟统计质量之间的直接联系 ([@problem_id:3482382])。", "problem": "您将实现并分析一个简化的变分蒙特卡罗 (VMC) 模型，该模型用于分离并量化双体 Jastrow 因子 $u(r)$ 中对电子-电子和电子-离子尖点条件的违背如何控制粒子并合附近局域能量 $E_L(\\mathbf{R})$ 的方差。请使用 Hartree 原子单位。推导必须从稳态薛定谔方程和局域能量的定义出发，并结合尖点条件是并合点库仑奇异性相消的结果这一论述。您的分析必须从这些基础开始，不得依赖任何预先给出的简化公式。\n\n在程序中需要实现的模型假设：\n- 考虑三维空间中的单个粒子间距 $r = \\|\\mathbf{r}\\|$，以及一个在 $r=0$ 处平滑且具有有限单侧导数的双体 Jastrow 因子 $u(r)$。假设在 $r=0$ 附近，多电子波函数关于 $r$ 的对数导数主要由 Jastrow 贡献决定，并满足 $\\frac{d}{dr}\\ln\\Psi \\approx u'(r)$。\n- 设给定粒子对类型的精确尖点系数为 $c$，并通过 $u'(0) = c + \\varepsilon$ 定义尖点误差 $\\varepsilon$。将 $\\varepsilon$ 视为一个小的实标量参数。\n- 对于全电子硅，使用核电荷 $Z = 14$ 和库仑电子-离子势 $-Z/r$。对于赝势硅，使用没有 $1/r$ 奇异性的平滑电子-离子势。电子-电子相互作用总是库仑相互作用，其形式为 $+1/r$。\n- 对于给定的截断半径 $R$，将注意力限制在近并合区域 $0 \\le r \\le R$，并假设相对坐标在三维空间中半径为 $R$ 的球内均匀采样。等效地，径向概率密度为 $p(r) = 3 r^2 / R^3$，其中 $r \\in [0,R]$。\n\n您的代码必须实现的推导要求：\n- 从不含时薛定谔方程和定义 $E_L(\\mathbf{R}) = (H\\Psi)/\\Psi$ 出发，推导以下粒子对类型在并合点附近局域能量的领头阶奇异结构：\n  1. 电子-离子 (全电子)，\n  2. 电子-电子 (异自旋)，\n  3. 电子-离子 (赝势)。\n  将领头奇异项表示为 $u'(0)$ 和该粒子对的库仑奇异性的函数。\n- 由此，展示尖点条件如何确定每种粒子对类型的精确尖点系数 $c$ 的值，并获得 $E_L$ 对尖点误差 $\\varepsilon$ 的主要奇异依赖关系。\n- 使用密度为 $p(r)$ 的采样模型，计算 $E_L$ 的奇异贡献在 $r\\in[0,R]$ 上的方差，将其表示为 $\\varepsilon$ 和 $R$ 的函数，并确定由 $\\mathrm{Var}[E_L] \\propto \\varepsilon^{p}$ 定义的标度指数 $p$，以及在近并合模型中由 $\\mathrm{Var}[E_L] = K(R)\\,\\varepsilon^{2}$ 定义的前置因子 $K(R)$。\n\n实现和数值计算任务：\n- 对于下面的每个测试用例，将近并合方差视为仅来自奇异项，并计算：\n  1. 通过对给定的 $\\varepsilon$ 值列表使用最小二乘法拟合 $\\log \\mathrm{Var}[E_L]$ 与 $\\log \\varepsilon$ 的关系，得到的双对数斜率 $p$，\n  2. 前置因子 $K(R)$，通过计算比率 $\\mathrm{Var}[E_L]/\\varepsilon^{2}$ 在 $\\varepsilon$ 值列表上的算术平均值来估计。\n- 对于 $\\varepsilon = 0$ 的边界情况，计算奇异贡献的方差，并报告其在 $10^{-12}$ 的绝对容差内是否为数值零。\n\n使用原子单位，并报告所有浮点输出，四舍五入到三位小数。\n\n用于覆盖不同机制的测试套件：\n- 情况 A (全电子电子-离子，硅)：$Z = 14$, $R = 0.1$, $\\varepsilon \\in \\{0.05, 0.1, 0.2\\}$。\n- 情况 B (全电子电子-电子，异自旋)：$R = 0.1$, $\\varepsilon \\in \\{0.05, 0.1, 0.2\\}$。\n- 情况 C (赝势电子-离子，硅)：$R = 0.1$, $\\varepsilon \\in \\{0.05, 0.1, 0.2\\}$。\n- 情况 D (全电子电子-离子，硅；较小的并合半径)：$Z = 14$, $R = 0.05$, $\\varepsilon \\in \\{0.05, 0.1, 0.2\\}$。\n- 情况 E (边界检查，全电子电子-离子，硅)：$Z = 14$, $R = 0.1$, $\\varepsilon = 0$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果按以下顺序排列：\n  1. 情况 A：拟合的指数 $p$，\n  2. 情况 A：前置因子 $K(R)$，\n  3. 情况 B：拟合的指数 $p$，\n  4. 情况 B：前置因子 $K(R)$，\n  5. 情况 C：拟合的指数 $p$，\n  6. 情况 C：前置因子 $K(R)$，\n  7. 情况 D：前置因子 $K(R)$，\n  8. 情况 E：一个布尔值，指示边界方差在容差内是否为数值零。\n例如，输出必须类似 $[p_A,K_A,p_B,K_B,p_C,K_C,K_D,\\mathrm{boolE}]$，其中浮点数四舍五入到三位小数。", "solution": "该问题要求在变分蒙特卡罗 (VMC) 方法中，分析局域能量 $E_L(\\mathbf{R})$ 的方差作为电子-电子和电子-离子尖点条件违背程度的函数。推导必须从不含时薛定谔方程开始，进而推导出方差随尖点误差 $\\varepsilon$ 的标度关系。\n\n不含时薛定谔方程为 $H\\Psi = E\\Psi$。对于一个在构型 $\\mathbf{R}$ 的试探波函数 $\\Psi_T$，其局域能量定义为 $E_L(\\mathbf{R}) = (H\\Psi_T)/\\Psi_T$。如果 $\\Psi_T$ 是一个精确的本征函数，$E_L$ 是一个常数；否则，它会涨落。我们关心的是，当一对相互作用的粒子之间的距离 $r$ 趋近于零时，$E_L$ 的奇异行为。\n\n在原子单位 ($m_e=1, \\hbar=1, e=1, 4\\pi\\epsilon_0=1$) 下，多体哈密顿量包括动能项和势能项。对于一对具有相对坐标 $\\mathbf{r}$ 和折合质量 $\\mu$ 的粒子，哈密顿量中依赖于它们间距 $r = |\\mathbf{r}|$ 的项是相对动能算符 $T_{\\text{rel}} = -\\frac{1}{2\\mu}\\nabla_{\\mathbf{r}}^2$ 和它们的相互作用势 $V(r)$。当 $r \\to 0$ 时，局域能量主要由这些项决定：\n$$\nE_L(r) \\approx \\frac{1}{\\Psi_T} \\left( -\\frac{1}{2\\mu} \\nabla_{\\mathbf{r}}^2 \\Psi_T \\right) + V(r) + \\text{non-singular terms}\n$$\n动能项可以展开为 $\\frac{1}{\\Psi_T} \\nabla_{\\mathbf{r}}^2 \\Psi_T = \\nabla_{\\mathbf{r}} \\cdot (\\frac{\\nabla_{\\mathbf{r}}\\Psi_T}{\\Psi_T}) + |\\frac{\\nabla_{\\mathbf{r}}\\Psi_T}{\\Psi_T}|^2$。问题提供了一个关键的简化假设：在近并合点处，波函数的对数导数由 Jastrow 因子 $u(r)$ 决定，即 $\\frac{d}{dr}\\ln\\Psi_T \\approx u'(r)$。这意味着梯度矢量近似是径向的：$\\frac{\\nabla_{\\mathbf{r}}\\Psi_T}{\\Psi_T} \\approx u'(r)\\hat{\\mathbf{r}}$。\n使用球坐标下的散度公式，我们得到：\n$$\n\\nabla_{\\mathbf{r}} \\cdot (u'(r)\\hat{\\mathbf{r}}) = \\frac{1}{r^2}\\frac{d}{dr}(r^2 u'(r)) = u''(r) + \\frac{2}{r}u'(r)\n$$\n当 $r \\to 0$ 时，并且考虑到 $u(r)$ 是平滑的 (因此 $u'(r)$ 和 $u''(r)$ 在 $r=0$ 处是有限的)，动能项中最奇异的部分是 $-\\frac{1}{2\\mu}\\frac{2}{r}u'(0)$。因此，局域能量的奇异部分是：\n$$\nE_L^{\\text{sing}}(r) = -\\frac{u'(0)}{\\mu r} + V(r)\n$$\n相互作用势是库仑势，形式为 $V(r) = V_0/r$。\n$$\nE_L^{\\text{sing}}(r) = -\\frac{u'(0)}{\\mu r} + \\frac{V_0}{r} = \\frac{1}{r} \\left(V_0 - \\frac{u'(0)}{\\mu}\\right)\n$$\n对于精确的波函数，$E_L$ 必须处处有限。这就要求奇异性消失，从而导出 Kato 尖点条件：$V_0 - \\frac{u'(0)_{\\text{exact}}}{\\mu} = 0$。这定义了精确的尖点系数 $c \\equiv u'(0)_{\\text{exact}} = \\mu V_0$。\n\n我们现在可以为指定的情况确定 $c$：\n1.  **电子-离子 (全电子，电荷为 $Z$)**：势为 $V(r) = -Z/r$，所以 $V_0 = -Z$。折合质量为 $\\mu \\approx 1$ a.u.。因此，$c = (1)(-Z) = -Z$。\n2.  **电子-电子 (异自旋)**：势为 $V(r) = +1/r$，所以 $V_0 = 1$。折合质量为 $\\mu = 1/2$。因此，$c = (1/2)(1) = 1/2$。\n3.  **电子-离子 (赝势)**：势是平滑的，意味着它没有 $1/r$ 奇异性。因此，$V_0=0$，并且 $c=(1)(0)=0$。\n\n一个试探波函数可能会违背这个条件，其 $u'(0) = c + \\varepsilon$，其中 $\\varepsilon$ 是尖点误差。局域能量的奇异部分变为：\n$$\nE_L^{\\text{sing}}(r) = -\\frac{c + \\varepsilon}{\\mu r} + \\frac{V_0}{r} = -\\frac{\\mu V_0 + \\varepsilon}{\\mu r} + \\frac{V_0}{r} = -\\frac{V_0}{r} - \\frac{\\varepsilon}{\\mu r} + \\frac{V_0}{r} = -\\frac{\\varepsilon}{\\mu r}\n$$\n该项的方差是使用给定的径向概率密度 $p(r) = 3r^2/R^3$ (其中 $r \\in [0, R]$) 来计算的。方差为 $\\mathrm{Var}[E_L^{\\text{sing}}] = \\langle (E_L^{\\text{sing}})^2 \\rangle - \\langle E_L^{\\text{sing}} \\rangle^2$。\n\n一阶矩 (平均值)：\n$$\n\\langle E_L^{\\text{sing}} \\rangle = \\int_0^R \\left(-\\frac{\\varepsilon}{\\mu r}\\right) \\frac{3r^2}{R^3} dr = -\\frac{3\\varepsilon}{\\mu R^3} \\int_0^R r dr = -\\frac{3\\varepsilon}{\\mu R^3} \\frac{R^2}{2} = -\\frac{3\\varepsilon}{2\\mu R}\n$$\n二阶矩 (均方值)：\n$$\n\\langle(E_L^{\\text{sing}})^2\\rangle = \\int_0^R \\left(-\\frac{\\varepsilon}{\\mu r}\\right)^2 \\frac{3r^2}{R^3} dr = \\frac{3\\varepsilon^2}{\\mu^2 R^3} \\int_0^R 1 dr = \\frac{3\\varepsilon^2}{\\mu^2 R^2}\n$$\n那么方差为：\n$$\n\\mathrm{Var}[E_L^{\\text{sing}}] = \\frac{3\\varepsilon^2}{\\mu^2 R^2} - \\left(-\\frac{3\\varepsilon}{2\\mu R}\\right)^2 = \\frac{3\\varepsilon^2}{\\mu^2 R^2} - \\frac{9\\varepsilon^2}{4\\mu^2 R^2} = \\left(3 - \\frac{9}{4}\\right)\\frac{\\varepsilon^2}{\\mu^2 R^2} = \\frac{3\\varepsilon^2}{4\\mu^2 R^2}\n$$\n从这个公式我们可以看到 $\\mathrm{Var}[E_L^{\\text{sing}}] \\propto \\varepsilon^2$，所以标度指数为 $p=2$。由 $\\mathrm{Var}[E_L^{\\text{sing}}] = K(R)\\varepsilon^2$ 定义的前置因子 $K(R)$ 是：\n$$\nK(R) = \\frac{3}{4\\mu^2 R^2}\n$$\n这些公式为后续实现中的数值计算提供了基础。对于通过 $\\mathrm{Var}$ 与 $\\varepsilon$ 的双对数拟合来寻找 $p$ 的数值任务，关系式 $\\log(\\mathrm{Var}) = \\log(K) + 2\\log(\\varepsilon)$ 表明斜率将恰好为 $2$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import stats\n\ndef solve():\n    \"\"\"\n    Implements and analyzes a simplified VMC model to quantify the effect\n    of cusp condition violations on the local energy variance.\n    \"\"\"\n\n    test_cases = [\n        # Case A: all-electron e-ion, silicon\n        {'case_id': 'A', 'mu': 1.0, 'R': 0.1, 'epsilons': [0.05, 0.1, 0.2], 'Z': 14},\n        # Case B: all-electron e-e, unlike-spin\n        {'case_id': 'B', 'mu': 0.5, 'R': 0.1, 'epsilons': [0.05, 0.1, 0.2]},\n        # Case C: pseudopotential e-ion, silicon\n        {'case_id': 'C', 'mu': 1.0, 'R': 0.1, 'epsilons': [0.05, 0.1, 0.2]},\n        # Case D: all-electron e-ion, silicon; smaller coalescence radius\n        {'case_id': 'D', 'mu': 1.0, 'R': 0.05, 'epsilons': [0.05, 0.1, 0.2], 'Z': 14},\n        # Case E: boundary check, all-electron e-ion, silicon\n        {'case_id': 'E', 'mu': 1.0, 'R': 0.1, 'epsilons': [0.0], 'Z': 14},\n    ]\n\n    results = []\n\n    def calculate_metrics(mu, R, epsilons):\n        \"\"\"\n        Calculates variance, scaling exponent p, and prefactor K.\n\n        Args:\n            mu (float): Reduced mass of the particle pair.\n            R (float): Cutoff radius for the near-coalescence region.\n            epsilons (list of float): List of cusp error values.\n\n        Returns:\n            A dictionary containing the calculated metrics.\n        \"\"\"\n        # Ensure epsilons are numpy arrays for vectorized operations.\n        epsilons = np.array(epsilons, dtype=float)\n\n        # Derived formula for variance: Var = 3 * epsilon^2 / (4 * mu^2 * R^2)\n        variances = (3 * epsilons**2) / (4 * mu**2 * R**2)\n\n        p = None\n        K = None\n        \n        # Filter out zero epsilon for log-fitting and K calculation.\n        non_zero_mask = epsilons > 0\n        \n        if np.any(non_zero_mask):\n            valid_epsilons = epsilons[non_zero_mask]\n            valid_variances = variances[non_zero_mask]\n\n            # Fit log(Var) vs log(epsilon) to find the exponent p\n            # The theoretical model is Var = K * epsilon^p, so log(Var) = log(K) + p * log(epsilon)\n            # This is a linear relationship y = c + m*x, where p is the slope m.\n            if len(valid_epsilons) > 1:\n                log_eps = np.log(valid_epsilons)\n                log_var = np.log(valid_variances)\n                # Use scipy.stats.linregress for a robust linear fit\n                slope, _, _, _, _ = stats.linregress(log_eps, log_var)\n                p = slope\n\n            # Estimate prefactor K as the mean of Var / epsilon^2\n            ratios = valid_variances / valid_epsilons**2\n            K = np.mean(ratios)\n\n        return {\n            'variances': variances,\n            'p': p,\n            'K': K\n        }\n\n    # Process each test case\n    for case in test_cases:\n        metrics = calculate_metrics(case['mu'], case['R'], case['epsilons'])\n        \n        if case['case_id'] == 'A':\n            results.append(f\"{metrics['p']:.3f}\")\n            results.append(f\"{metrics['K']:.3f}\")\n        elif case['case_id'] == 'B':\n            results.append(f\"{metrics['p']:.3f}\")\n            results.append(f\"{metrics['K']:.3f}\")\n        elif case['case_id'] == 'C':\n            results.append(f\"{metrics['p']:.3f}\")\n            results.append(f\"{metrics['K']:.3f}\")\n        elif case['case_id'] == 'D':\n            # For Case D, only prefactor K is required in the output\n            results.append(f\"{metrics['K']:.3f}\")\n        elif case['case_id'] == 'E':\n            # For Case E, check if the variance is numerically zero\n            variance_at_zero_eps = metrics['variances'][0]\n            is_zero = np.isclose(variance_at_zero_eps, 0.0, atol=1e-12)\n            results.append(str(is_zero))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3482382"}]}