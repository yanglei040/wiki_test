## 引言
理解并预测电子在原子、分子和材料中如何响应外部[时变场](@entry_id:180620)（如激光脉冲）而运动，是现代科学与技术的核心挑战之一。从光合作用到[太阳能电池](@entry_id:138078)，从信息技术到先进[材料设计](@entry_id:160450)，电子动力学无处不在。虽然[含时薛定谔方程](@entry_id:137898)原则上提供了对这些过程的完整描述，但其巨大的计算复杂度使其对于绝大多数真实系统而言都无法求解。这一“多体问题”的困境，催生了对一种既精确又高效的理论方法的需求。

[含时密度泛函理论](@entry_id:200019)（Time-Dependent Density Functional Theory, TDDFT）正是为应对这一挑战而生。它将基态密度泛函理论的巨大成功延伸至时域，提供了一个原则上精确且在实践中可行的第一性原理框架，用以描述和模拟多电子系统在任意时变外势下的[量子动力学](@entry_id:138183)。通过将系统的基本变量从复杂的[多体波函数](@entry_id:203043)简化为更易处理的电子密度，TDDFT在[计算效率](@entry_id:270255)和物理洞察力之间取得了卓越的平衡。

本文将系统地引导您深入[含时密度泛函理论](@entry_id:200019)的世界。在接下来的章节中，我们将首先深入“原理与机制”，从奠定理论合法性的[龙格-格罗斯定理](@entry_id:272222)出发，详细阐述实用的含时[科恩-沈方法](@entry_id:263733)，并严谨剖析理论核心——[交换相关泛函](@entry_id:142042)的各种近似及其成败。随后，我们将在“应用与跨学科[交叉](@entry_id:147634)”一章中，通过丰富的实例展示TDDFT如何被用于解释和预测化学、物理及[材料科学](@entry_id:152226)中的各种现象，从分子的[电子光谱](@entry_id:154403)到固体的光学响应，再到[超快动力学](@entry_id:164209)和前沿的量子物态调控。最后，在“动手实践”部分，我们将通过精心设计的计算问题，将理论付诸实践，帮助读者巩固理解，并亲身体验解决前沿研究所面临的挑战。

## 原理与机制

本章旨在深入探讨[含时密度泛函理论](@entry_id:200019)（Time-Dependent Density Functional Theory, TDDFT）的核心原理与基本机制。在前一章介绍其背景与动机之后，我们将系统地建立该理论的形式基础，阐释其在实践中（尤其是在线性响应框架下）是如何运作的，并严谨地分析其常用近似的优势与局限性。

### TDDFT 的形式基础

TDDFT 的理论合法性建立在一系列严谨的定理之上，其中最核心的是龙格-格罗斯（Runge-Gross）定理。然而，在讨论此定理之前，我们必须首先明确一个先决条件：什么样的含时电子密度才有可能由一个外部势产生？

#### v-[可表示性](@entry_id:635277)问题与粒子数守恒

在TDDFT中，一个核心概念是**含时v-[可表示性](@entry_id:635277)（time-dependent v-representability）**。如果一个含时密度 $n(\mathbf{r},t)$ 能够由某个在时空上行为良好的外势 $v_{\text{ext}}(\mathbf{r},t)$，从某个初始多体[量子态](@entry_id:146142)出发，通过求解[含时薛定谔方程](@entry_id:137898)而精确地产生，那么我们就称该密度是v-可表示的。

一个物理上合理的密度必须满足某些基本条件。其中最基本的一条源于量子力学中的粒子数[守恒定律](@entry_id:269268)。对于一个由[多体波函数](@entry_id:203043) $\Psi(t)$ 描述的系统，其粒子密度 $n(\mathbf{r}, t)$ 和[粒子流](@entry_id:753205)密度 $\mathbf{j}(\mathbf{r}, t)$ 必须满足**[连续性方程](@entry_id:195013)**：
$$
\frac{\partial n(\mathbf{r}, t)}{\partial t} + \nabla \cdot \mathbf{j}(\mathbf{r}, t) = 0
$$
这个方程是任何v-可表示密度的必要条件，因为它直接源于薛定谔方程所蕴含的局域粒子数守恒。

对于一个空间上孤立的系统（例如一个分子），我们很自然地要求[粒子流](@entry_id:753205)在无穷远处消失，即当 $|\mathbf{r}| \to \infty$ 时，$\mathbf{j}(\mathbf{r}, t) \to 0$。在这种情况下，我们可以对整个空间的[连续性方程](@entry_id:195013)进行积分：
$$
\frac{dN(t)}{dt} = \int \frac{\partial n(\mathbf{r}, t)}{\partial t} d^3r = - \int \nabla \cdot \mathbf{j}(\mathbf{r}, t) d^3r
$$
根据[高斯散度定理](@entry_id:188065)，上式右边的[体积分](@entry_id:171119)可以转换成一个在无穷远边界面上的面积分，由于无穷远处流密度为零，该积分也为零。因此，我们得到一个至关重要的结论：
$$
\frac{dN(t)}{dt} = 0
$$
这意味着，对于一个[封闭系统](@entry_id:139565)，总粒子数 $N(t) = \int n(\mathbf{r}, t) d^3r$ 必须是一个不随时间改变的常数。

任何不满足这一条件的密度函数，都不可能是v-可表示的。例如，设想一个一维系统中的假设密度[分布](@entry_id:182848) [@problem_id:3497307]：
$$
n(x,t) = \exp(-t) \cdot \varphi(x)
$$
其中 $\varphi(x)$ 是一个归一化的高斯函数。该密度在任意时刻都是非负的且在空间上表现良好。然而，其总粒子数 $N(t) = \int n(x,t) dx = \exp(-t)$ 随时间指数衰减。这明显违反了[封闭系统](@entry_id:139565)中的粒子数守恒。因此，我们无需进行更复杂的分析，就可以断定这个密度在物理上是不可能由任何局域外势在[封闭系统](@entry_id:139565)中产生的。这个例子清晰地说明了，在构建或使用TDDFT理论时，我们必须始终关注那些满足基本物理守恒律的密度。

#### [龙格-格罗斯定理](@entry_id:272222)与一-一映射

在v-可表示的密度集合内，龙格-格罗斯（Runge-Gross）定理构成了TDDFT的基石 [@problem_id:3497298]。该定理指出：对于一个给定的多电子系统（具有固定的粒子间相互作用）和固定的初始[波函数](@entry_id:147440) $|\Psi_0\rangle$，如果外势 $v(\mathbf{r},t)$ 在初始时刻 $t_0$ 附近是时间可泰勒展开的（即时间解析的），那么，在相差一个仅与时间有关的函数 $c(t)$ 的意义上，含时密度 $n(\mathbf{r},t)$ 和含时外势 $v(\mathbf{r},t)$ 之间存在[一一对应](@entry_id:143935)的关系。

这个定理包含两个关键部分：

1.  **势的不唯一性**：如果两个外势 $v(\mathbf{r},t)$ 和 $v'(\mathbf{r},t)$ 仅相差一个纯时间函数，即 $v'(\mathbf{r},t) = v(\mathbf{r},t) + c(t)$，它们将从相同的初始态产生完全相同的密度演化。这是因为外势算符的差值为 $\hat{V}'(t) - \hat{V}(t) = c(t) \hat{N}$，其中 $\hat{N}$ 是总[粒子数算符](@entry_id:153568)。对于一个粒子数固定的系统，这只相当于给[哈密顿量](@entry_id:172864)增加了一个纯时间的项。在薛定谔方程中，这仅仅导致[波函数](@entry_id:147440)获得一个不依赖于空间坐标的附加相位因子 $\exp(-\frac{iN}{\hbar} \int_{t_0}^t c(\tau) d\tau)$。由于密度是[波函数](@entry_id:147440)的模平方的[期望值](@entry_id:153208)，这个[全局相位](@entry_id:147947)因子会被抵消，从而密度 $n(\mathbf{r},t)$ 保持不变。

2.  **映射的唯一性**：这是定理的核心证明。它通过[反证法](@entry_id:276604)证明，如果两个外势 $v(\mathbf{r},t)$ 和 $v'(\mathbf{r},t)$ 产生的密度相同，那么它们的差 $w(\mathbf{r},t) = v(\mathbf{r},t) - v'(\mathbf{r},t)$ 必然是一个纯时间函数。证明的关键步骤依赖于势在时间上的解析性假设，即 $w(\mathbf{r},t)$ 可以展开为关于 $(t-t_0)$ 的泰勒级数。如果 $w(\mathbf{r},t)$ 不仅仅是时间的函数，那么其[泰勒级数](@entry_id:147154)中必然存在某个最低阶的系数 $w_K(\mathbf{r})$ 在空间上不是常数，即 $\nabla w_K(\mathbf{r}) \neq \mathbf{0}$。通过结合[连续性方程](@entry_id:195013) $\partial_t n + \nabla \cdot \mathbf{j} = 0$ 和流密度的[海森堡运动方程](@entry_id:140445)，可以证明密度差的 $(K+2)$ 阶时间导数在 $t=t_0$ 时与 $\nabla \cdot (n_0 \nabla w_K(\mathbf{r}))$ 成正比。由于我们假设两个势产生的密度完全相同，密度差及其所有时间导数都必须为零。这就要求 $\nabla \cdot (n_0 \nabla w_K(\mathbf{r})) = 0$。在标准的物理边界条件下，这个方程唯一的解是 $\nabla w_K(\mathbf{r}) = \mathbf{0}$，这与我们关于 $K$ 的假设相矛盾。因此，最初的假设（即两个不只相差 $c(t)$ 的势可以产生相同密度）不成立。

[龙格-格罗斯定理](@entry_id:272222)是一个极其深刻且强大的非微扰结果。它保证了我们可以将含时密度 $n(\mathbf{r},t)$ 视为系统的基本变量，并原则上可以通过它来计算系统的任何其他可观测量，从而为建立一个类似于[基态](@entry_id:150928)DFT的含时理论铺平了道路。

### 含时[科恩-沈方法](@entry_id:263733)

[龙格-格罗斯定理](@entry_id:272222)虽然在形式上确立了理论，但没有直接提供一种计算真实多体[系统动力学](@entry_id:136288)的方法。含时科恩-沈（Time-Dependent Kohn-Sham, TDKS）方法提供了一个实用的计算框架。其核心思想是将复杂的相互作用多体问题，映射到一个行为等效的、易于处理的无相互作用的[辅助系统](@entry_id:142219)上。

#### 含时[科恩-沈方程](@entry_id:143968)

TDKS方法假设存在一个虚构的无相互作用电子系统，其密度 $n_s(\mathbf{r},t)$ 在任何时刻都与真实相互作用系统的密度 $n(\mathbf{r},t)$ 完全相同。这些无相互作用的科恩-沈电子在同一个外势 $v_{\text{ext}}(\mathbf{r},t)$ 以及一个附加的[有效势](@entry_id:142581) $v_s(\mathbf{r},t)$ 中运动。每一条[科恩-沈轨道](@entry_id:171979) $\phi_j(\mathbf{r},t)$ 都遵循一个[单体](@entry_id:136559)薛定谔方程，即**含时[科恩-沈方程](@entry_id:143968)**：
$$
i\hbar \frac{\partial}{\partial t} \phi_j(\mathbf{r},t) = \left[ -\frac{\hbar^2}{2m}\nabla^2 + v_s(\mathbf{r},t) \right] \phi_j(\mathbf{r},t)
$$
其中，[有效势](@entry_id:142581) $v_s$ 被定义为：
$$
v_s(\mathbf{r},t) = v_{\text{ext}}(\mathbf{r},t) + v_H(\mathbf{r},t) + v_{xc}(\mathbf{r},t)
$$
这里，$v_H(\mathbf{r},t)$ 是经典的哈特里（Hartree）势，它描述了电子密度[分布](@entry_id:182848)产生的平均[静电场](@entry_id:268546)。而 $v_{xc}(\mathbf{r},t)$ 则是**含时交换-相关（exchange-correlation, xc）势**，它囊括了所有非经典的、多体的动力学效应，是理论中所有复杂性的集中体现。原则上，$v_{xc}$ 是密度 $n$ 的一个复杂泛函，它不仅依赖于瞬时密度 $n(\mathbf{r},t)$，还可能依赖于密度的历史（记忆效应）和初始状态。

通过求解TDKS[方程组](@entry_id:193238)，我们可以获得[科恩-沈轨道](@entry_id:171979)的演化，并由此计算出含时密度 $n(\mathbf{r},t) = \sum_j |\phi_j(\mathbf{r},t)|^2$。只要我们知道（或近似）$v_{xc}$ 作为密度泛函的具体形式，这个方案就构成了一个封闭的、自洽的计算循环。

#### 强场下的实时动力学：[布洛赫振荡](@entry_id:138656)与[退相干](@entry_id:145157)

TDKS方程的[实时演化](@entry_id:199067)方法为研究物质在强[激光](@entry_id:194225)场等非微扰外场下的行为提供了强大的工具。一个典型的例子是在晶体中施加一个强的恒定[电场](@entry_id:194326) $F$ [@problem_id:3497319]。

根据固体物理的半经典图像，在没有散射的[完美晶体](@entry_id:138314)中，电子的晶体动量会线性演化 $\hbar \dot{k} = -eF$。由于[能带结构](@entry_id:139379)在倒空间的周期性，电子并不会无限加速，而是会在[布里渊区](@entry_id:142395)内来回运动，导致其实[空间速度](@entry_id:190294)和位置发生周期性[振荡](@entry_id:267781)，这种现象被称为**[布洛赫振荡](@entry_id:138656)（Bloch oscillations）**，其频率为 $\omega_B = eFa/\hbar$，其中 $a$ 是[晶格常数](@entry_id:158935)。

[实时TDDFT](@entry_id:754140)能够定性地重现这种[振荡](@entry_id:267781)。然而，如果我们采用最简单的**[绝热近似](@entry_id:143074)**（见后文），即假设 $v_{xc}$ 只依赖于瞬时密度，那么科恩-沈[哈密顿量](@entry_id:172864)在任何时刻都是厄米的。这意味着整个系统的演化是幺正的，没有内在的耗散机制。在这种理想化的模型（完美晶体、无[声子](@entry_id:140728)、[绝热近似](@entry_id:143074)）中，[布洛赫振荡](@entry_id:138656)会永不衰减地持续下去。然而，在真实材料中，由于[电子-声子相互作用](@entry_id:140708)、[电子-电子散射](@entry_id:152847)等复杂[多体效应](@entry_id:173569)，这种相干的[振荡](@entry_id:267781)会逐渐**退相干（dephasing）**并衰减。绝热TDDFT本身无法描述这种不可逆的能量耗散和[相干性](@entry_id:268953)损失。要在一个第一性原理的框架内引入[退相干](@entry_id:145157)，就需要超越[绝热近似](@entry_id:143074)，采用包含“记忆效应”的xc泛函。

此外，值得注意的是，某些强场现象，如**[齐纳隧穿](@entry_id:141878)（Zener tunneling）**，即电子在强场作用下从价带隧穿到导带，其发生概率对[电场](@entry_id:194326)强度 $F$ 的依赖关系是 $\exp(-\gamma/F)$ 的形式。这种函数在 $F=0$ 处不是解析的，因此无法通过任何阶数的[微扰理论](@entry_id:138766)来描述。这意味着，基于微扰的线性响应TDDFT（下文将讨论）无法捕捉到这种[非微扰效应](@entry_id:148492)，必须通过[实时演化](@entry_id:199067)来模拟。

### [线性响应理论](@entry_id:145737)与[电子激发](@entry_id:190531)

TDDFT最广泛和成功的应用领域之一是计算分子的[电子激发](@entry_id:190531)能和[光谱](@entry_id:185632)，这通常是通过[线性响应理论](@entry_id:145737)实现的。其基本思想是，一个微弱的、[振荡](@entry_id:267781)的外场 $\delta v_{\text{ext}}(\mathbf{r}, \omega)$ 会在体系中引起一个同频率的微小密度响应 $\delta n(\mathbf{r}, \omega)$。

#### [响应函数](@entry_id:142629)与戴森式方程

在外场微弱的极限下，密度响应与外场之间呈[线性关系](@entry_id:267880)，由系统的**密度-密度[响应函数](@entry_id:142629)（或称极化率）** $\chi$ 联系：
$$
\delta n(\mathbf{r}, \omega) = \int \chi(\mathbf{r}, \mathbf{r}', \omega) \delta v_{\text{ext}}(\mathbf{r}', \omega) d^3r'
$$
$\chi(\omega)$ 的极点（poles）对应于体系的真实电子激发能。TDDFT的目标就是计算这个相互作用系统的响应函数 $\chi$。

通过TDKS框架，我们可以将这个问题与无相互作用的科恩-沈系统的响应联系起来。科恩-沈系统的密度响应 $\delta n$ 是由其自身的[响应函数](@entry_id:142629) $\chi_s$ 和[有效势](@entry_id:142581)的变化 $\delta v_s$ 决定的：
$$
\delta n = \chi_s \delta v_s
$$
而有效势的变化 $\delta v_s$ 又包含三部分：外场的变化 $\delta v_{\text{ext}}$，以及由密度响应 $\delta n$ 自身诱导的哈特里势和交换-相关势的变化。后两者可以由一个**哈特里-交换-相关核（Hartree-exchange-correlation kernel）** $f_{Hxc}$ 描述：
$$
\delta v_s = \delta v_{\text{ext}} + (v_H + f_{xc}) \delta n = \delta v_{\text{ext}} + f_{Hxc} \delta n
$$
其中 $v_H(\mathbf{r},\mathbf{r}')=1/|\mathbf{r}-\mathbf{r}'|$ 是哈特里核。将这些关系式联立，经过简单的代数推导，我们得到一个连接相互作用[响应函数](@entry_id:142629) $\chi$ 和无相互作用[响应函数](@entry_id:142629) $\chi_s$ 的核心方程，即**戴森式方程（Dyson-like equation）** [@problem_id:3497302]：
$$
\chi(\omega) = \chi_s(\omega) + \chi_s(\omega) f_{Hxc}(\omega) \chi(\omega)
$$
这个方程的物理意义非常清晰。相互作用系统的响应 $\chi$ 不仅仅是无相互作用科恩-沈系统的响应 $\chi_s$，还包含了通过 $f_{Hxc}$ 描述的附加效应。当系统受到外场扰动时，科恩-沈电子首先响应（由 $\chi_s$ 描述），产生一个诱导密度 $\delta n$。这个诱导密度随即产生一个诱导的哈特里场和交换-相关场（由 $f_{Hxc}$ 描述），这个诱导场又反过来作用于系统，进一步修正响应。这个自洽的“响应-诱导-再响应”过程，正是戴森式方程所描述的**屏蔽（screening）**效应。一个直接的后果是，由于诱导场通常会削弱外场，相互作用系统的[极化率](@entry_id:143513)通常小于裸的科恩-沈系统的极化率，即 $\alpha_{TDDFT}  \alpha_{KS}$ [@problem_id:1417502]。

#### 交换-相关核

戴森式方程的核心是**交换-相关核（exchange-correlation kernel）** $f_{xc}$。它被严格定义为含时交换-相关势 $v_{xc}$ 对含时密度 $n$ 的泛函导数：
$$
f_{xc}(\mathbf{r},t; \mathbf{r}',t') = \frac{\delta v_{xc}(\mathbf{r},t)}{\delta n(\mathbf{r}',t')}
$$
在频率域中，它写作 $f_{xc}(\mathbf{r},\mathbf{r}',\omega)$。这个[核函数](@entry_id:145324)蕴含了超越平均场（哈特里）近似的所有多体动力学效应。精确的 $f_{xc}$ 具有以下重要性质 [@problem_id:3497304]：

*   **因果性（Causality）**：由于物理上的原因，在 $t$ 时刻的势不可能受到未来 $t' > t$ 时刻密度的影响，因此 $f_{xc}(\mathbf{r},t; \mathbf{r}',t')$ 在 $t  t'$ 时必须为零。
*   **频率依赖性与复数值**：因果性直接导致了在频率域中，[核函数](@entry_id:145324) $f_{xc}(\omega)$ 通常是一个复杂的、依赖于频率 $\omega$ 的函数。其实部和虚部通过克拉默-克罗尼格（Kramers-Kronig）关系相联系。频率依赖性反映了系统的“记忆效应”，即系统的响应不是瞬时的。而虚部则与能量耗散和激发的有限寿命有关。

#### 卡西达方法

在分子等有限体系中，戴森式方程通常是通过将其投影到一个由科恩-沈“占据-非占据”[轨道](@entry_id:137151)对（即粒子-空穴对）构成的[基组](@entry_id:160309)上求解的。这种方法被称为**卡西达（Casida）方法** [@problem_id:3497303]。它将寻找 $\chi(\omega)$ 极点的问题，转化为一个非厄米的广义[本征值问题](@entry_id:142153)：
$$
\begin{pmatrix} \mathbf{A}  \mathbf{B} \\ \mathbf{B}^*  \mathbf{A}^* \end{pmatrix} \begin{pmatrix} \mathbf{X} \\ \mathbf{Y} \end{pmatrix} = \omega \begin{pmatrix} \mathbf{1}  \mathbf{0} \\ \mathbf{0}  -\mathbf{1} \end{pmatrix} \begin{pmatrix} \mathbf{X} \\ \mathbf{Y} \end{pmatrix}
$$
其中，$\omega$ 是[激发能](@entry_id:190368)，$(\mathbf{X}, \mathbf{Y})$ 是对应的激发/退激发振幅。矩阵 $\mathbf{A}$ 和 $\mathbf{B}$ 的元素由[科恩-沈轨道](@entry_id:171979)能量差和 $f_{Hxc}$ 在粒子-空穴对基上的矩阵元构成。

*   **矩阵 A** 的对角元是科恩-沈单粒子跃迁能量 $\epsilon_a - \epsilon_i$（其中 $i$ 为占据[轨道](@entry_id:137151)，$a$ 为非占据[轨道](@entry_id:137151)），非对角元则描述了不同粒子-空穴对之间的相互作用。
*   **矩阵 B** 描述了激发通道（如 $i \to a$）和退激发通道（如 $a \to i$）之间的耦合。

这个完整的非厄米问题具有 $\pm \omega$ 的[本征值对称性](@entry_id:194432)，类似于[随机相位近似](@entry_id:754035)（Random Phase Approximation, RPA）。在许多计算中，为了简化，会忽略 $\mathbf{B}$ 矩阵，即令 $\mathbf{B}=0$。这被称为**塔姆-丹柯夫近似（Tamm-Dancoff Approximation, TDA）**。TDA忽略了退激发通道的耦合，将问题简化为一个标准的厄米本征值问题 $A\mathbf{X} = \omega\mathbf{X}$，计算成本更低，并且通常能给出合理的[激发能](@entry_id:190368)，尤其对于价电子激发。

### 近似、失效与修正

TDDFT的准确性完全取决于我们对未知的交换-相关势 $v_{xc}$ 和核 $f_{xc}$ 所做的近似。

#### [绝热近似](@entry_id:143074)

迄今为止，最普遍和基础的近似是**[绝热近似](@entry_id:143074)（adiabatic approximation）**。它假设含时xc势在 $t$ 时刻只依赖于同一时刻的密度 $n(\mathbf{r},t)$，并且其泛函形式与[基态](@entry_id:150928)DFT中的xc势相同。这意味着系统对扰动的响应是瞬时的，完全忽略了“记忆效应”。

在[绝热近似](@entry_id:143074)下，xc核变得与频率无关，且为实数 [@problem_id:3497304]。它等于[基态](@entry_id:150928)xc[能量泛函](@entry_id:170311) $E_{xc}[n]$ 对密度的二阶泛函导数：
$$
f_{xc}^{\text{adia}}(\mathbf{r}, \mathbf{r}') = \frac{\delta^2 E_{xc}^{\text{gs}}[n]}{\delta n(\mathbf{r}) \delta n(\mathbf{r}')}
$$
这种形式的核在时域中对应于一个包含 $\delta(t-t')$ 的项，明确表示了其瞬时（无记忆）的特性 [@problem_id:3497344]。

#### 绝热[局域密度近似](@entry_id:138982) (ALDA)

将[绝热近似](@entry_id:143074)与[基态](@entry_id:150928)DFT中最简单的局域密度近似（LDA）相结合，便得到**绝热局域密度近似（Adiabatic Local Density Approximation, A[LDA](@entry_id:138982)）**。在ALDA中，$E_{xc}^{\text{LDA}}[n] = \int e_{xc}(n(\mathbf{r})) d^3r$，其中 $e_{xc}(n)$ 是[均匀电子气](@entry_id:163911)的交换-[相关能](@entry_id:144432)量密度。对其求两次泛函导数，我们得到A[LDA](@entry_id:138982)核的具体形式 [@problem_id:3497344]：
$$
f_{xc}^{\text{ALDA}}(\mathbf{r}, \mathbf{r}') = \frac{d^2 e_{xc}(n)}{dn^2}\bigg|_{n=n(\mathbf{r})} \cdot \delta(\mathbf{r}-\mathbf{r}')
$$
A[LDA](@entry_id:138982)核具有两个显著特点：(1) **时间局域性**（绝热，无频率依赖）；(2) **空间局域性**（超局域，由 $\delta$ 函数体现）。它相当于取了精确的[均匀电子气](@entry_id:163911)核函数在长波极限（$q \to 0$）和[静态极限](@entry_id:262480)（$\omega \to 0$）下的值。尽管形式简单，A[LDA](@entry_id:138982)在描述许多体系的低能价电子激发方面取得了惊人的成功。

#### [绝热近似](@entry_id:143074)的内在缺陷 I：双电子激发

[绝热近似](@entry_id:143074)有一个根本性的结构缺陷：它无法描述具有显著**双电子激发（double excitation）**特征的[激发态](@entry_id:261453)。这类[激发态](@entry_id:261453)不能被简单地描述为单个电子从一个占据[轨道](@entry_id:137151)跃迁到非占据[轨道](@entry_id:137151)，而是涉及两个电子的同时跃迁。

我们可以通过一个极简的标量模型来理解这一点 [@problem_id:3497302]。假设一个科恩-沈系统只有一个激发通道，其响应函数 $\chi_s(\omega)$ 在 $\pm \omega_s$ 处有极点。采用[绝热近似](@entry_id:143074)，即核 $f_{xc}$ 是一个与频率无关的常数 $K$。根据戴森式方程，相互作用响应函数 $\chi(\omega)$ 的[极点位置](@entry_id:271565) $\Omega$ 由方程 $\Omega^2 = \omega_s^2 + 2\alpha\omega_s K$ 决定（$\alpha$ 是一个正常数）。

这个结果表明，绝热核 $K$ 的作用仅仅是移动了原有科恩-沈[响应函数](@entry_id:142629)极点的位置，从 $\omega_s$ 移动到 $\Omega$。它无法创造出新的、与 $\omega_s$ 无关的极点。双电子激发在[响应函数](@entry_id:142629)中应表现为全新的极点，而这只有当[核函数](@entry_id:145324) $f_{xc}(\omega)$ 本身具有频率依赖性，并且在特定频率处也出现极点时才可能发生。[绝热近似](@entry_id:143074)由于其定义就是频率无关的，从根本上排除了这种可能性。

#### [绝热近似](@entry_id:143074)的内在缺陷 II：里德堡与长程[电荷转移激发](@entry_id:174772)

除了双电子激发，A[LDA](@entry_id:138982)等半局域近似在描述另外两类重要激发时也存在严重问题：**里德堡（Rydberg）激发**和**长程电荷转移（long-range charge-transfer, CT）激发** [@problem_id:3497368]。

1.  **里德堡激发**：这类激发将一个电子提升到离[原子核](@entry_id:167902)非常远的、弥散的[轨道](@entry_id:137151)上。正确的物理图像是，这个被激发的电子感受到的是一个净[电荷](@entry_id:275494)为+1的离子实（[原子核](@entry_id:167902)+剩余电子），因此它所处的势在渐进行为上应为 $-1/r$ 的[库仑势](@entry_id:154276)。然而，由A[LDA](@entry_id:138982)/AGGA等半局域泛函产生的[基态](@entry_id:150928)xc势 $v_{xc}$ 由于[自相互作用误差](@entry_id:139981)，在 $r \to \infty$ 时会呈指数衰减，而不是正确的 $-1/r$。这导致整个[科恩-沈势](@entry_id:169598)阱过浅，无法束缚住高[激发态](@entry_id:261453)的里德堡[轨道](@entry_id:137151)，从而使得计算出的里德堡谱系坍缩或完全错误。

2.  **长程[电荷转移激发](@entry_id:174772)**：考虑一个由电子给体（D）和受体（A）组成、相距很远的复合物。从D到A的CT激发，其激发能 $\omega_{CT}$ 在大距离 $R$ 下的正确行为应为 $\omega_{CT} \approx I_D - A_A - 1/R$，其中 $I_D, A_A$ 分别为给体的电离能和受体的电子亲和能。关键在于这个吸引性的 $-1/R$ 项。在线性响应TDDFT中，这个项来源于粒子-空穴对之间的相互作用，由[核函数](@entry_id:145324) $f_{Hxc}$ 决定。然而，当给体[轨道](@entry_id:137151)和受体[轨道空间](@entry_id:148658)上没有交叠时，任何像A[LDA](@entry_id:138982)这样的局域核函数在它们之间的矩阵元都会指数衰减至零。结果是，电子-空穴吸引项完全丢失，CT激发能被灾难性地低估，错误地趋近于[科恩-沈轨道](@entry_id:171979)能级差 $\epsilon_A - \epsilon_D$。

#### 解决方案：非局域泛函

上述问题的根源在于半局域泛函的局域性。解决方案必须引入**非局域性（non-locality）**。

*   对于里德堡激发，问题出在[基态](@entry_id:150928)势的渐进行为。使用**渐进修正（asymptotic correction）**的泛函，或者更系统地，使用那些在长程包含100%精确（哈特里-佛克）交换的**[范围分离杂化](@entry_id:165056)（range-separated hybrid, RSH）泛函**，可以修正 $v_{xc}$ 的渐进行为至正确的 $-1/r$，从而正确地描述里德堡谱系 [@problem_id:3497368] [@problem_id:3497317]。

*   对于长程CT激发，问题出在xc核的局域性。解决方案是在[核函数](@entry_id:145324)中引入长程非局域项。这正是**[杂化泛函](@entry_id:164921)（hybrid functionals）**所做的。通过在xc泛函中混入一部分非局域的[精确交换](@entry_id:178558)，其对应的xc核也获得了一个非局域部分，通常形式为 $-\alpha/|\mathbf{r}-\mathbf{r}'|$，其中 $\alpha$ 是[精确交换](@entry_id:178558)的混合比例。这个非局域核在分离的给体和受体[轨道](@entry_id:137151)之间产生了一个不为零的相互作用，其大小恰好是 $-\alpha/R$。对于[RSH泛函](@entry_id:184447)，在长程时 $\alpha=1$，从而完美地恢复了正确的 $-1/R$ 行为 [@problem_id:3497317]。

重要的是要认识到，修正里德堡激发和修正长程CT激发需要对理论的不同部分进行修正：前者主要依赖于正确的[基态](@entry_id:150928)势，后者则必须依赖于正确的非局域核 [@problem_id:3497368]。幸运的是，[RSH泛函](@entry_id:184447)通常能同时在这两方面做出改进。

#### 超越[绝热近似](@entry_id:143074)：[记忆效应](@entry_id:266709)与耗散

在[强场物理](@entry_id:198469)或需要描述[激发态寿命](@entry_id:153246)等场景下，[绝热近似](@entry_id:143074)本身是不够的。我们需要包含记忆效应的、依赖频率的核函数。一个更先进的理论框架是**含时流密度泛函理论（Time-Dependent Current DFT, TDCDFT）** [@problem_id:3497319]。在该理论中，xc势不仅依赖于密度，还依赖于流密度。一个重要的应用是，可以通过一个具有因果性的记忆核 $\eta(t)$ 将xc[电场](@entry_id:194326)与[宏观电流](@entry_id:203974)的历史联系起来：
$$
\mathbf{E}_{xc}(t) = -\int_0^t \eta(t-t') \mathbf{J}(t') dt'
$$
这种形式的核函数可以从[均匀电子气](@entry_id:163911)的响应特性中构建，它在理论上是严谨的，并能自然地引入耗散和退相干效应，从而能够更真实地模拟强场下的电子动力学，如[布洛赫振荡](@entry_id:138656)的衰减等现象。