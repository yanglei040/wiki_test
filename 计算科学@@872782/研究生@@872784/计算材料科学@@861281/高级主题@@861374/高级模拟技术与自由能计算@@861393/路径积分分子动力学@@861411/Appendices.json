{"hands_on_practices": [{"introduction": "在路径积分分子动力学（PIMD）中，一个核心的实践问题是如何选择“珠子”（beads）的数量$P$。这个选择是计算精度与成本之间的关键权衡。本练习将引导您通过对谐振子模型进行严格的误差分析，量化离散化误差，并最终得出一个实用的准则，用于估计在模拟真实系统（如液态水）时需要多少珠子才能达到预期的精度。[@problem_id:3473906]", "problem": "考虑在温度 $T=300\\,\\mathrm{K}$ 下的液态水的路径积分分子动力学 (PIMD) 模拟，其中最高的相关分子内振动频率是氧氢 ($O$–$H$) 伸缩振动，其波数为 $\\tilde{\\nu}_{\\max}\\approx 3600\\,\\mathrm{cm}^{-1}$。通常使用 $P$ 个珠子，通过对称二阶 Suzuki–Trotter 分解，对量子配分函数的虚时路径积分进行离散化。从一个算符恒等式出发：在对称 Trotter 分解下，短时传播子允许进行 Baker–Campbell–Hausdorff (BCH) 展开，从而得到一个影子哈密顿量 $H_{\\mathrm{sh}}=H+\\Delta H$。其领头修正项 $\\Delta H$ 正比于二次对易子 $[V,[T,V]]$，其中 $T$ 是动能算符，$V$ 是势能算符。请分析代表最高频率伸缩振动的一个一维谐振模式下，量子动能的离散化误差。取谐振模式为 $V(x)=\\frac{1}{2}m\\omega^{2}x^{2}$ 和 $T=\\frac{p^{2}}{2m}$，并使用正则量子化关系 $[x,p]=i\\hbar$。\n\n你的任务是：\n- 推导谐振模式下二次对易子 $[V,[T,V]]$ 的显式形式。\n- 基于谐振子长度标度 $l=\\sqrt{\\hbar/(m\\omega)}$ 和基于 BCH 的影子哈密顿量修正，使用量纲分析证明，由有限珠子数离散化引起的量子动能的领头阶相对误差与 $(\\beta\\hbar\\omega/P)$ 成二次方关系，其中 $\\beta=1/(k_{B}T)$ 是逆热能，$P$ 是珠子数。\n- 设定最高频率模式的量子动能的相对误差的界限为 $10^{-2}$，并推导最小珠子数 $P_{\\min}$ 关于 $\\beta$、$\\hbar$ 和 $\\omega_{\\max}$ 的解析表达式。\n- 通过关系式 $\\hbar\\omega=h c\\,\\tilde{\\nu}$，从给定的波数 $\\tilde{\\nu}_{\\max}$ 转换得到 $\\omega_{\\max}$，并对 $\\tilde{\\nu}_{\\max}=3600\\,\\mathrm{cm}^{-1}$ 和 $T=300\\,\\mathrm{K}$ 的情况数值计算 $P_{\\min}$。使用常数 $h c/k_{B}=1.438776877\\,\\mathrm{cm\\cdot K}$，并报告满足该界限的最小整数珠子数 $P$。\n\n将最终答案表示为 $P$ 的整数值，不带单位。如果任何中间数值计算需要近似，你可以进行近似，但你最终报告的珠子数必须是满足 $1\\%$ 误差标准的最小整数。", "solution": "该问题被验证为科学上可靠、问题明确且客观。这是计算统计力学中一个关于路径积分分子动力学 (PIMD) 离散化误差的标准理论练习。所有必要的数据和定义均已提供。\n\n解答过程通过完成问题陈述中列出的四个任务来进行。\n\n首先，我们推导一维谐振模式下二次对易子 $[V,[T,V]]$ 的显式形式。动能和势能算符分别由 $T = \\frac{p^2}{2m}$ 和 $V(x) = \\frac{1}{2}m\\omega^2 x^2$ 给出。正则对易关系为 $[x,p]=i\\hbar$。\n\n我们首先计算内层对易子 $[T,V]$：\n$$\n[T,V] = \\left[\\frac{p^2}{2m}, \\frac{1}{2}m\\omega^2 x^2\\right] = \\frac{\\omega^2}{4}[p^2, x^2]\n$$\n使用对易子恒等式 $[A^2, B] = A[A,B] + [A,B]A$ 和 $[A, B^2] = B[A,B] + [A,B]B$，我们发现：\n$$\n[p, x^2] = x[p,x] + [p,x]x = x(-i\\hbar) + (-i\\hbar)x = -2i\\hbar x\n$$\n$$\n[p^2, x^2] = p[p,x^2] + [p,x^2]p = p(-2i\\hbar x) + (-2i\\hbar x)p = -2i\\hbar(px + xp)\n$$\n将此代入 $[T,V]$ 的表达式中，得到：\n$$\n[T,V] = \\frac{\\omega^2}{4}(-2i\\hbar(px+xp)) = -\\frac{i\\hbar\\omega^2}{2}(px+xp)\n$$\n接下来，我们计算外层对易子 $[V,[T,V]]$：\n$$\n[V,[T,V]] = \\left[\\frac{1}{2}m\\omega^2 x^2, -\\frac{i\\hbar\\omega^2}{2}(px+xp)\\right] = -\\frac{i\\hbar m\\omega^4}{4}[x^2, px+xp]\n$$\n我们使用恒等式 $[A,BC]=[A,B]C+B[A,C]$ 来计算对易子 $[x^2, px+xp]$：\n$$\n[x^2, px+xp] = [x^2, p]x + p[x^2, x] + [x^2, x]p + x[x^2, p] = [x^2,p]x + x[x^2,p]\n$$\n对易子 $[x^2,p]$ 是：\n$$\n[x^2,p] = x[x,p] + [x,p]x = x(i\\hbar) + (i\\hbar)x = 2i\\hbar x\n$$\n因此，\n$$\n[x^2, px+xp] = (2i\\hbar x)x + x(2i\\hbar x) = 2i\\hbar x^2 + 2i\\hbar x^2 = 4i\\hbar x^2\n$$\n将此结果代回二次对易子的表达式中，我们得到：\n$$\n[V,[T,V]] = -\\frac{i\\hbar m\\omega^4}{4}(4i\\hbar x^2) = (-i^2)\\frac{4\\hbar^2 m\\omega^4}{4}x^2 = \\hbar^2 m\\omega^4 x^2\n$$\n这也可以用势能算符 $V$ 表示为 $2\\hbar^2\\omega^2 V$。\n\n第二，我们证明量子动能的领头阶相对误差与 $(\\beta\\hbar\\omega/P)$ 成二次方关系。问题陈述指出，对称 Trotter 分解导出一个影子哈密顿量 $H_{\\mathrm{sh}} = H + \\Delta H$，其中领头修正项 $\\Delta H$ 与 $(\\beta/P)^2$ 成正比。使用给定的形式 $\\Delta H \\propto [V,[T,V]]$，我们可以写出 $\\Delta H = C(\\beta/P)^2[V,[T,V]]$，其中 $C$ 为某个常数。\n能量修正是 $\\Delta E \\approx \\langle \\Delta H \\rangle = C(\\beta/P)^2 \\langle \\hbar^2 m \\omega^4 x^2 \\rangle$。对于谐振子，期望值 $\\langle x^2 \\rangle$ 与势能期望值 $\\langle V \\rangle = \\frac{1}{2}m\\omega^2\\langle x^2 \\rangle$ 相关。谐振子的维里定理表明 $\\langle T \\rangle = \\langle V \\rangle$。总能量的量级在量子区域（$\\beta\\hbar\\omega > 1$）为特征能量标度 $\\hbar\\omega$，在经典区域（$\\beta\\hbar\\omega < 1$）为 $k_B T$。\n让我们考虑与问题相关的量子区域。在这里，$\\langle V \\rangle \\sim \\hbar\\omega$，所以 $\\langle x^2 \\rangle \\sim \\frac{\\hbar\\omega}{m\\omega^2}$。\n因此，能量误差为 $\\Delta E \\sim (\\beta/P)^2 \\hbar^2 m \\omega^4 (\\frac{\\hbar\\omega}{m\\omega^2}) = (\\beta/P)^2 \\hbar^3\\omega^3 = \\hbar\\omega (\\frac{\\beta\\hbar\\omega}{P})^2$。\n能量的相对误差为 $\\frac{\\Delta E}{\\langle E \\rangle} \\sim \\frac{\\hbar\\omega (\\beta\\hbar\\omega/P)^2}{\\hbar\\omega} = (\\frac{\\beta\\hbar\\omega}{P})^2$。假设动能误差 $\\Delta \\langle T \\rangle$ 与 $\\Delta E$ 同阶，则相对误差 $\\frac{\\Delta\\langle T \\rangle}{\\langle T \\rangle}$ 也与 $(\\frac{\\beta\\hbar\\omega}{P})^2$ 成比例。\n\n第三，为了得到最小珠子数 $P_{\\min}$ 的定量表达式，我们使用对称二阶 Suzuki-Trotter 分解的影子哈密顿量修正的显式形式。虚时路径积分中的时间步长为 $\\tau = \\beta/P$。修正项为：\n$$\n\\Delta H = \\tau^2 \\left( \\frac{1}{12}[V, [V,T]] + \\frac{1}{24}[T, [T,V]] \\right)\n$$\n我们有 $[T,[T,V]] = [\\frac{p^2}{2m}, -\\frac{i\\hbar\\omega^2}{2}(px+xp)] = -\\frac{i\\hbar\\omega^2}{4m}[p^2, px+xp] = -\\frac{i\\hbar\\omega^2}{4m}(-4i\\hbar p^2) = -2\\hbar^2\\omega^2 T$。\n同样，$[V,[V,T]] = -[V,[T,V]] = -\\hbar^2m\\omega^4x^2 = -2\\hbar^2\\omega^2V$。\n将这些代入 $\\Delta H$：\n$$\n\\Delta H = \\left(\\frac{\\beta}{P}\\right)^2 \\left( \\frac{1}{12}(-2\\hbar^2\\omega^2V) + \\frac{1}{24}(-2\\hbar^2\\omega^2T) \\right) = -\\left(\\frac{\\beta\\hbar\\omega}{P}\\right)^2 \\left(\\frac{1}{6}V + \\frac{1}{12}T\\right)\n$$\n影子哈密顿量为 $H_{\\mathrm{sh}} = H + \\Delta H = T(1 - \\frac{1}{12}(\\frac{\\beta\\hbar\\omega}{P})^2) + V(1 - \\frac{1}{6}(\\frac{\\beta\\hbar\\omega}{P})^2)$。令 $\\epsilon = (\\beta\\hbar\\omega/P)^2$，则 $H_{\\mathrm{sh}} = (1-\\epsilon/12)T + (1-\\epsilon/6)V$。这是一个具有重新标度的质量和频率的谐振子。有效频率为 $\\omega_{\\mathrm{sh}} = \\omega\\sqrt{\\frac{1-\\epsilon/6}{1-\\epsilon/12}} \\approx \\omega(1-\\epsilon/24)$。\n动能为 $\\langle T \\rangle = \\frac{\\hbar\\omega}{4}\\coth(\\frac{\\beta\\hbar\\omega}{2})$。由频率移动 $\\Delta\\omega = \\omega_{\\mathrm{sh}} - \\omega \\approx -\\omega\\epsilon/24$ 引起的 $\\langle T \\rangle$ 的相对误差为：\n$$\n\\frac{\\Delta \\langle T \\rangle}{\\langle T \\rangle} = \\frac{1}{\\langle T \\rangle} \\frac{d\\langle T \\rangle}{d\\omega} \\Delta\\omega = \\frac{1}{f(\\omega)}f'(\\omega)\\Delta\\omega\n$$\n其中 $f(\\omega)=\\langle T \\rangle$。此计算得出：\n$$\n\\frac{\\Delta \\langle T \\rangle}{\\langle T \\rangle} = \\left(1 - \\frac{\\beta\\hbar\\omega}{\\sinh(\\beta\\hbar\\omega)}\\right) \\frac{\\Delta\\omega}{\\omega} \\approx -\\frac{1}{24}\\left(\\frac{\\beta\\hbar\\omega}{P}\\right)^2 \\left(1 - \\frac{\\beta\\hbar\\omega}{\\sinh(\\beta\\hbar\\omega)}\\right)\n$$\n我们设定此相对误差的绝对值界限为 $10^{-2}$：\n$$\n\\left|-\\frac{1}{24}\\left(\\frac{\\beta\\hbar\\omega_{\\max}}{P}\\right)^2 \\left(1 - \\frac{\\beta\\hbar\\omega_{\\max}}{\\sinh(\\beta\\hbar\\omega_{\\max})}\\right)\\right| \\le 10^{-2}\n$$\n对 $P$ 求解，得到最小珠子数 $P_{\\min}$：\n$$\nP^2 \\ge \\frac{100}{24} (\\beta\\hbar\\omega_{\\max})^2 \\left|1 - \\frac{\\beta\\hbar\\omega_{\\max}}{\\sinh(\\beta\\hbar\\omega_{\\max})}\\right|\n$$\n$$\nP_{\\min} = \\sqrt{\\frac{25}{6}} (\\beta\\hbar\\omega_{\\max}) \\sqrt{\\left|1 - \\frac{\\beta\\hbar\\omega_{\\max}}{\\sinh(\\beta\\hbar\\omega_{\\max})}\\right|}\n$$\n\n第四，我们对 $P_{\\min}$ 进行数值计算。首先计算无量纲参数 $x = \\beta\\hbar\\omega_{\\max}$。\n$$\nx = \\beta\\hbar\\omega_{\\max} = \\frac{\\hbar\\omega_{\\max}}{k_B T} = \\frac{h c \\tilde{\\nu}_{\\max}}{k_B T} = \\left(\\frac{h c}{k_B}\\right) \\frac{\\tilde{\\nu}_{\\max}}{T}\n$$\n使用给定值 $T=300\\,\\mathrm{K}$，$\\tilde{\\nu}_{\\max}=3600\\,\\mathrm{cm}^{-1}$ 和 $hc/k_B = 1.438776877\\,\\mathrm{cm\\cdot K}$：\n$$\nx = (1.438776877\\,\\mathrm{cm\\cdot K}) \\frac{3600\\,\\mathrm{cm}^{-1}}{300\\,\\mathrm{K}} = 1.438776877 \\times 12 = 17.265322524\n$$\n由于 $x$很大，$x \\gg 1$，$\\sinh(x)$ 项非常大，而 $x/\\sinh(x)$ 与 $1$ 相比可以忽略不计。\n$$\n\\sinh(17.2653...) \\approx 1.57 \\times 10^7 \\implies \\frac{x}{\\sinh(x)} \\approx 1.1 \\times 10^{-6} \\ll 1\n$$\n因此，$P_{\\min}$ 的表达式简化为：\n$$\nP_{\\min} \\approx \\sqrt{\\frac{25}{6}} x = \\frac{5}{\\sqrt{6}} \\times 17.265322524 \\approx 2.04124145 \\times 17.265322524 \\approx 35.2428\n$$\n珠子数 $P$ 必须是整数。为了满足条件 $P \\ge P_{\\min}$，我们必须选择大于或等于 $35.2428$ 的最小整数。该值为 $36$。", "answer": "$$\\boxed{36}$$", "id": "3473906"}, {"introduction": "从路径积分的静态表示转向其动力学模拟后，我们必须面对数值稳定性的问题。环状聚合物本身具有一系列内部振动模式，其中最快的模式对积分算法的时间步长$\\Delta t$施加了严格的上限。本练习将深入探讨恒温环状聚合物分子动力学（TRPMD）中积分器的稳定性，通过分析传播矩阵的本征值，推导出保证算法稳定的最大时间步长。[@problem_id:3473863]", "problem": "考虑恒温环状聚合物分子动力学 (TRPMD)，这是一种路径积分分子动力学中的动力学方法，它传播一个由代表量子玻尔兹曼分布的 $P$ 个珠子组成的环状聚合物。在简正模表示中，第 $k$ 个内模的简谐弹簧频率 $\\omega_k$ 由下式给出：\n$$\n\\omega_k \\;=\\; 2\\,\\omega_P\\,\\sin\\!\\left(\\frac{k\\pi}{P}\\right),\n$$\n其中 $\\omega_P$ 是环状聚合物的弹簧频率，$k\\in\\{1,2,\\dots,P-1\\}$ 标记了内模（$k=0$ 的质心模被排除在外）。对于坐标为 $q_k$、动量为 $p_k$ 的单个内模，其郎之万方程（具有特定于模的摩擦系数 $\\gamma_k$）为：\n$$\nm\\,\\dot{q}_k \\;=\\; p_k,\\qquad\n\\dot{p}_k \\;=\\; -\\,m\\,\\omega_k^{2}\\,q_k \\;-\\; \\gamma_k\\,p_k \\;+\\; \\sqrt{2\\,m\\,\\gamma_k\\,k_B T}\\,\\xi_k(t),\n$$\n其中 $m$ 是珠子质量，$k_B$ 是玻尔兹曼常数，$T$ 是温度，$\\xi_k(t)$ 是高斯白噪声。TRPMD 通常在每个模上使用一个时间步长为 $\\Delta t$ 的 Strang 分裂 (BAOAB) 积分器，该积分器包括一个半步的确定性力更新 ($B$)、一个半步的位置漂移 ($A$)、一个整步的 Ornstein–Uhlenbeck (OU) 恒温器应用 ($O$)，然后又是一个半步的漂移 ($A$) 和一个半步的力更新 ($B$)。OU 步骤被视为在整个 $\\Delta t$ 上是精确的，动量缩放因子为 $c_k = \\exp(-\\gamma_k\\,\\Delta t)$。\n\n当内模的离散时间动力学与物理振动频率发生不利的相互作用时，尤其是在与简谐弹簧相关的离散旋转变得与高物理频率可公度的条件下，会观察到 TRPMD 中的共振不稳定性。在应用于内模的郎之万恒温器存在的情况下，这些共振会被阻尼，但时间离散化动力学的数值稳定性由 $(q_k,p_k)$ 的单步更新矩阵的特征值决定。\n\n从上述郎之万方程和 BAOAB 分裂出发，推导忽略随机噪声的确定性 $(q_k,p_k)$ 单步更新矩阵，并确定 $\\Delta t$ 需满足的条件，以保证该更新矩阵的所有特征值都位于复平面的单位圆盘内。将得到的最大稳定时间步长 $\\Delta t_{\\max}(k)$ 表示为关于 $P$、$\\omega_P$ 和 $k$ 的闭式解析表达式，并通过 $c_k = \\exp(-\\gamma_k\\,\\Delta t)$ 明确其对恒温器参数 $\\gamma_k$ 的依赖性或独立性。仅提供 $\\Delta t_{\\max}(k)$ 的最终闭式表达式作为答案。无需进行数值计算。", "solution": "该问题要求推导应用于单个内部简正模的恒温环状聚合物分子动力学 (TRPMD) 算法的最大稳定时间步长 $\\Delta t_{\\max}(k)$。其稳定性由 BAOAB 积分器的确定性单步更新矩阵的特征值决定。\n\n设第 $k$ 个简正模的状态由其坐标 $q_k$ 和速度 $v_k = p_k/m$ 的向量描述。确定性运动方程为：\n$$\n\\dot{q}_k = v_k\n$$\n$$\n\\dot{v}_k = -\\omega_k^2 q_k - \\gamma_k v_k\n$$\nBAOAB 积分器将这些动力学分为三个部分：\nA (漂移): $\\dot{q}_k = v_k, \\dot{v}_k = 0$\nB (力): $\\dot{q}_k = 0, \\dot{v}_k = -\\omega_k^2 q_k$\nO (恒温器): $\\dot{q}_k = 0, \\dot{v}_k = -\\gamma_k v_k$\n\n设状态向量为 $\\mathbf{z}_k(t) = \\begin{pmatrix} q_k(t) \\\\ v_k(t) \\end{pmatrix}$。每个部分在时间步长 $\\tau$ 内的传播可以用一个矩阵表示。\n\nA 部分（漂移）在时间步长 $\\tau$ 内的传播子为：\n$$\n\\mathbf{M}_A(\\tau) = \\begin{pmatrix} 1 & \\tau \\\\ 0 & 1 \\end{pmatrix}\n$$\nB 部分（力）在时间步长 $\\tau$ 内的传播子为：\n$$\n\\mathbf{M}_B(\\tau) = \\begin{pmatrix} 1 & 0 \\\\ -\\omega_k^2 \\tau & 1 \\end{pmatrix}\n$$\nO 部分（恒温器）的传播子是在整个时间步长 $\\Delta t$ 上的精确更新：\n$$\nv_k(\\Delta t) = v_k(0) \\exp(-\\gamma_k \\Delta t) = c_k v_k(0)\n$$\n其中 $c_k = \\exp(-\\gamma_k \\Delta t)$。位置 $q_k$ 不变。其矩阵表示为：\n$$\n\\mathbf{M}_O(\\Delta t) = \\begin{pmatrix} 1 & 0 \\\\ 0 & c_k \\end{pmatrix}\n$$\nBAOAB 方案通过按顺序应用以下操作来更新一个时间步长 $\\Delta t$ 内的状态：$B(\\Delta t/2)$、$A(\\Delta t/2)$、$O(\\Delta t)$、$A(\\Delta t/2)$、$B(\\Delta t/2)$。单步更新矩阵 $\\mathbf{M}_k$ 是各个矩阵的乘积。令 $\\tau_h = \\Delta t / 2$。\n$$\n\\mathbf{M}_k = \\mathbf{M}_B(\\tau_h) \\mathbf{M}_A(\\tau_h) \\mathbf{M}_O(\\Delta t) \\mathbf{M}_A(\\tau_h) \\mathbf{M}_B(\\tau_h)\n$$\n首先，我们计算中间部分 $\\mathbf{M}_{AOA} = \\mathbf{M}_A(\\tau_h) \\mathbf{M}_O(\\Delta t) \\mathbf{M}_A(\\tau_h)$：\n$$\n\\mathbf{M}_O(\\Delta t) \\mathbf{M}_A(\\tau_h) = \\begin{pmatrix} 1 & 0 \\\\ 0 & c_k \\end{pmatrix} \\begin{pmatrix} 1 & \\tau_h \\\\ 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 1 & \\tau_h \\\\ 0 & c_k \\end{pmatrix}\n$$\n$$\n\\mathbf{M}_{AOA} = \\begin{pmatrix} 1 & \\tau_h \\\\ 0 & 1 \\end{pmatrix} \\begin{pmatrix} 1 & \\tau_h \\\\ 0 & c_k \\end{pmatrix} = \\begin{pmatrix} 1 & \\tau_h + c_k \\tau_h \\\\ 0 & c_k \\end{pmatrix} = \\begin{pmatrix} 1 & (1+c_k)\\tau_h \\\\ 0 & c_k \\end{pmatrix}\n$$\n现在，我们构建完整的矩阵 $\\mathbf{M}_k = \\mathbf{M}_B(\\tau_h) \\mathbf{M}_{AOA} \\mathbf{M}_B(\\tau_h)$。\n$$\n\\mathbf{M}_{AOA} \\mathbf{M}_B(\\tau_h) = \\begin{pmatrix} 1 & (1+c_k)\\tau_h \\\\ 0 & c_k \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\\\ -\\omega_k^2 \\tau_h & 1 \\end{pmatrix} = \\begin{pmatrix} 1 - \\omega_k^2 \\tau_h^2(1+c_k) & (1+c_k)\\tau_h \\\\ -c_k \\omega_k^2 \\tau_h & c_k \\end{pmatrix}\n$$\n$$\n\\mathbf{M}_k = \\begin{pmatrix} 1 & 0 \\\\ -\\omega_k^2 \\tau_h & 1 \\end{pmatrix} \\begin{pmatrix} 1 - \\omega_k^2 \\tau_h^2(1+c_k) & (1+c_k)\\tau_h \\\\ -c_k \\omega_k^2 \\tau_h & c_k \\end{pmatrix}\n$$\n$$\n\\mathbf{M}_k = \\begin{pmatrix} 1 - \\omega_k^2 \\tau_h^2(1+c_k) & (1+c_k)\\tau_h \\\\ -\\omega_k^2 \\tau_h (1 - \\omega_k^2 \\tau_h^2(1+c_k)) - c_k \\omega_k^2 \\tau_h & -\\omega_k^2 \\tau_h^2(1+c_k) + c_k \\end{pmatrix}\n$$\n离散动力学的稳定性由 $\\mathbf{M}_k$ 的特征值 $\\lambda$ 决定。特征值是特征方程 $\\det(\\mathbf{M}_k - \\lambda \\mathbf{I}) = 0$ 的根，即 $\\lambda^2 - \\text{Tr}(\\mathbf{M}_k) \\lambda + \\det(\\mathbf{M}_k) = 0$。\n\n$\\mathbf{M}_k$ 的行列式是各组成矩阵行列式的乘积：$\\det(\\mathbf{M}_A(\\tau_h)) = 1$、$\\det(\\mathbf{M}_B(\\tau_h)) = 1$ 以及 $\\det(\\mathbf{M}_O(\\Delta t)) = c_k$。\n$$\n\\det(\\mathbf{M}_k) = 1 \\cdot 1 \\cdot c_k \\cdot 1 \\cdot 1 = c_k\n$$\n$\\mathbf{M}_k$ 的迹是其对角线元素之和：\n$$\n\\text{Tr}(\\mathbf{M}_k) = \\left( 1 - \\omega_k^2 \\tau_h^2(1+c_k) \\right) + \\left( -\\omega_k^2 \\tau_h^2(1+c_k) + c_k \\right) = 1+c_k - 2\\omega_k^2 \\tau_h^2(1+c_k)\n$$\n特征方程为：\n$$\n\\lambda^2 - (1+c_k)(1 - 2\\omega_k^2\\tau_h^2)\\lambda + c_k = 0\n$$\n为使动力学稳定，特征值的模必须小于或等于 1，即 $|\\lambda| \\le 1$。对于二次方程 $\\lambda^2 - b\\lambda + d = 0$，其根位于单位圆盘内的充要条件是 $|d| \\le 1$、$1-b+d \\ge 0$ 和 $1+b+d \\ge 0$。\n\n在这里，$d = c_k = \\exp(-\\gamma_k \\Delta t)$。由于 $\\gamma_k \\ge 0$ 且 $\\Delta t \\ge 0$，我们有 $0 < c_k \\le 1$。因此条件 $|d| \\le 1$ 总是满足的。\n\n我们来检查另外两个条件：\n1.) $1 - b + d \\ge 0$\n$1 - (1+c_k)(1 - 2\\omega_k^2\\tau_h^2) + c_k \\ge 0$\n$1 - (1 - 2\\omega_k^2\\tau_h^2 + c_k - 2c_k\\omega_k^2\\tau_h^2) + c_k \\ge 0$\n$2\\omega_k^2\\tau_h^2 + 2c_k\\omega_k^2\\tau_h^2 \\ge 0$\n$2\\omega_k^2\\tau_h^2(1+c_k) \\ge 0$。因为 $\\tau_h^2 \\ge 0$ 且 $1+c_k > 0$，所以这个不等式总是成立的。\n\n2.) $1 + b + d \\ge 0$\n$1 + (1+c_k)(1 - 2\\omega_k^2\\tau_h^2) + c_k \\ge 0$\n$1 + 1 + c_k - 2\\omega_k^2\\tau_h^2(1+c_k) + c_k \\ge 0$\n$2 + 2c_k - 2\\omega_k^2\\tau_h^2(1+c_k) \\ge 0$\n$2(1+c_k) - 2\\omega_k^2\\tau_h^2(1+c_k) \\ge 0$\n$2(1+c_k)(1 - \\omega_k^2\\tau_h^2) \\ge 0$\n\n由于 $1+c_k > 0$，该不等式简化为：\n$$\n1 - \\omega_k^2\\tau_h^2 \\ge 0 \\quad \\implies \\quad \\omega_k^2\\tau_h^2 \\le 1\n$$\n代入 $\\tau_h = \\Delta t/2$：\n$$\n\\omega_k^2 \\left(\\frac{\\Delta t}{2}\\right)^2 \\le 1 \\quad \\implies \\quad \\omega_k \\frac{\\Delta t}{2} \\le 1\n$$\n这给出了关于时间步长 $\\Delta t$ 的条件：\n$$\n\\Delta t \\le \\frac{2}{\\omega_k}\n$$\n对于任何 $\\gamma_k \\ge 0$，该稳定性条件都与恒温器参数 $\\gamma_k$（因此也与 $c_k$）无关。\n\n因此，模 $k$ 的最大稳定时间步长为：\n$$\n\\Delta t_{\\max}(k) = \\frac{2}{\\omega_k}\n$$\n代入给定的简正模频率表达式 $\\omega_k = 2\\,\\omega_P\\,\\sin\\left(\\frac{k\\pi}{P}\\right)$：\n$$\n\\Delta t_{\\max}(k) = \\frac{2}{2\\,\\omega_P\\,\\sin\\left(\\frac{k\\pi}{P}\\right)} = \\frac{1}{\\omega_P\\,\\sin\\left(\\frac{k\\pi}{P}\\right)}\n$$\n这就是最大稳定时间步长的最终闭式表达式。", "answer": "$$\\boxed{\\frac{1}{\\omega_P \\sin\\left(\\frac{k\\pi}{P}\\right)}}$$", "id": "3473863"}, {"introduction": "掌握了基本动力学模拟的要点之后，我们可以挑战更复杂的系综，例如恒压恒温（NPT）系综。在NPT-PIMD中引入调压器（barostat）会增加一个新的动力学自由度，其振动频率可能与环状聚合物的内部模式发生共振，从而导致数值不稳定。本练习旨在解决这一高级问题，通过推导环状聚合物弹簧对维里压力的贡献，最终确定如何设置调压器的质量以避免这种危险的共振。[@problem_id:3473910]", "problem": "考虑一个各向同性恒压路径积分分子动力学 (PIMD) 模拟，该模拟针对一个体积为 $V$、温度为 $T$ 的三维立方晶胞，其中包含 $N$ 个质量为 $m$ 的相同原子，每个原子由一个包含 $P$ 个珠子的环状聚合物表示。设珠子索引 $s \\in \\{1,\\dots,P\\}$ 是循环的，满足 $s+P \\equiv s$。环状聚合物的弹簧势能为\n$$\nU_{\\mathrm{spr}} = \\sum_{i=1}^{N}\\sum_{s=1}^{P} \\frac{1}{2} m \\,\\omega_{P}^{2}\\, \\left|\\mathbf{r}_{i,s} - \\mathbf{r}_{i,s+1}\\right|^{2}, \\quad \\text{其中} \\quad \\omega_{P} = \\frac{P}{\\beta \\hbar} = \\frac{P k_{B} T}{\\hbar},\n$$\n其中 $\\mathbf{r}_{i,s}$ 是原子 $i$ 的第 $s$ 个珠子的笛卡尔坐标，$\\beta = 1/(k_{B} T)$，$k_{B}$ 是玻尔兹曼常数，$\\hbar$ 是约化普朗克常数。各向同性控压器通过一个标量晶胞变量 $\\varepsilon$ 来实现，使得 $\\mathbf{r}_{i,s} = \\exp(\\varepsilon)\\,\\mathbf{x}_{i,s}$，其中 $\\mathbf{x}_{i,s}$ 是协同移动的标度坐标，其共轭质量参数为 $W$ (控压器质量)。假设采用周期性边界条件，并且 Martyna–Tobias–Klein (MTK) 的各向同性扩展拉格朗日动力学在围绕力学平衡点的小振荡 (线性化) 极限下成立。\n\n任务：\n1) 使用势能对维里贡献的基本定义，即对于力 $\\mathbf{F}_{a} = -\\nabla_{\\mathbf{r}_{a}}\\Phi$，标量维里为 $W_{\\Phi} = -\\sum_{a} \\mathbf{r}_{a}\\cdot \\mathbf{F}_{a}$，推导与 $U_{\\mathrm{spr}}$ 相关的弹簧维里 $W_{\\mathrm{spr}}$ 的精确闭式表达式，该表达式需用珠子位置 $\\{\\mathbf{r}_{i,s}\\}$ 显式写出。\n\n2) 在简正模坐标下对角化自由环状聚合物的弹簧耦合，以获得内模频率谱 $\\{\\omega_{k}\\}$，并确定最低的非零内模频率 $\\omega_{1}$，将其表示为 $\\omega_{P}$ 和 $P$ 的函数。\n\n3) 在各向同性 MTK 控压器中，当内压主要由动能和环状聚合物弹簧贡献决定的情况下，对 $\\varepsilon$ 围绕平衡点的运动方程进行线性化。证明 $\\varepsilon$ 的小振荡 (固有) 频率可以写成 $\\omega_{b} = \\sqrt{G k_{B} T / W}$，其中 $G$ 是对瞬时压力的动能部分有贡献的动量自由度数。对于具有 $N$ 个原子和 $P$ 个珠子的三维 PIMD，取 $G = 3 N P$。\n\n4) 为避免质心振铃效应，选择 $W$ 使得 $\\omega_{b}$ 与第 (2) 部分推导出的最低非零内模环状聚合物频率 $\\omega_{1}$ 相匹配。提供由此得到的最优控压器质量 $W$ 的单一闭式解析表达式，用 $N$、$P$、$T$、$k_{B}$ 和 $\\hbar$ 表示。你的最终答案必须是单一的闭式表达式。不要进行任何数值代入或舍入。", "solution": "在尝试解答之前，对问题进行验证。\n\n### 第 1 步：提取已知条件\n- **模拟**：各向同性恒压路径积分分子动力学 (PIMD)。\n- **体系**：体积为 $V$、温度为 $T$ 的三维立方晶胞。\n- **粒子**：$N$ 个质量为 $m$ 的相同原子。\n- **PIMD 模型**：$P$ 珠环状聚合物，珠子索引 $s \\in \\{1,\\dots,P\\}$ 是循环的 ($s+P \\equiv s$)。\n- **弹簧势**：$U_{\\mathrm{spr}} = \\sum_{i=1}^{N}\\sum_{s=1}^{P} \\frac{1}{2} m \\,\\omega_{P}^{2}\\, \\left|\\mathbf{r}_{i,s} - \\mathbf{r}_{i,s+1}\\right|^{2}$。\n- **弹簧频率参数**：$\\omega_{P} = \\frac{P}{\\beta \\hbar} = \\frac{P k_{B} T}{\\hbar}$。\n- **常数**：$\\beta = 1/(k_{B} T)$，玻尔兹曼常数 $k_{B}$，约化普朗克常数 $\\hbar$。\n- **坐标**：笛卡尔珠子坐标 $\\mathbf{r}_{i,s}$。\n- **控压器**：各向同性 Martyna–Tobias–Klein (MTK) 动力学，通过标量晶胞变量 $\\varepsilon$ 实现。\n- **控压器质量**：共轭质量参数 $W$。\n- **坐标标度**：$\\mathbf{r}_{i,s} = \\exp(\\varepsilon)\\,\\mathbf{x}_{i,s}$，其中 $\\mathbf{x}_{i,s}$ 是协同移动的标度坐标。\n- **边界条件**：周期性。\n- **假设**：围绕力学平衡点的小振荡 (线性化) 极限。\n- **任务 1**：使用定义 $W_{\\Phi} = -\\sum_{a} \\mathbf{r}_{a}\\cdot \\mathbf{F}_{a}$ (其中 $\\mathbf{F}_{a} = -\\nabla_{\\mathbf{r}_{a}}\\Phi$) 推导弹簧维里 $W_{\\mathrm{spr}}$。\n- **任务 2**：求自由环状聚合物的内模频率谱 $\\{\\omega_{k}\\}$ 并确定最低非零频率 $\\omega_{1}$。\n- **任务 3**：在内压主要由动能和弹簧贡献主导的假设下，证明控压器的固有频率为 $\\omega_{b} = \\sqrt{G k_{B} T / W}$，其中 $G = 3 N P$。\n- **任务 4**：通过令 $\\omega_{b} = \\omega_{1}$ 求最优控压器质量 $W$。\n\n### 第 2 步：使用提取的已知条件进行验证\n- **科学依据**：该问题在高等计算统计力学领域有充分的理论基础。所有概念——PIMD、环状聚合物势、MTK 控压器、简正模分析以及维里——都是该领域的标准概念，并得到了正确定义。\n- **适定性**：问题被分解为四个顺序相连、逻辑相关的任务。每个任务都有明确的定义，并要求得到一个特定的解析结果，最终汇总为控压器质量 $W$ 的单一表达式。这种结构导向一个唯一且有意义的解。\n- **客观性**：语言正式、精确、客观，使用了计算物理学的标准术语。\n- **完整性与一致性**：问题为解决任务提供了所有必要的定义、常数和关系（例如，关于 $U_{\\mathrm{spr}}$, $\\omega_P$ 和 $G$）。假设被明确说明。没有内部矛盾。\n- **现实性**：该场景描述了执行 PIMD 模拟时一个标准且重要的步骤：调节控压器质量以避免与系统的内禀频率发生共振，这是确保数值稳定性和准确性的关键步骤。\n\n### 第 3 步：结论与行动\n问题在科学上是合理的，适定的，并且内部一致。因此，判定其为**有效**。解答过程如下。\n\n### 第 1 部分：弹簧维里 $W_{\\mathrm{spr}}$ 的推导\n弹簧维里 $W_{\\mathrm{spr}}$ 由与势能 $U_{\\mathrm{spr}}$ 相关的标量维里的一般公式定义：\n$$\nW_{\\mathrm{spr}} = -\\sum_{i=1}^{N}\\sum_{s=1}^{P} \\mathbf{r}_{i,s} \\cdot \\mathbf{F}_{i,s}\n$$\n其中 $\\mathbf{F}_{i,s}$ 是作用在原子 $i$ 的第 $s$ 个珠子上的力，由 $\\mathbf{F}_{i,s} = -\\nabla_{\\mathbf{r}_{i,s}} U_{\\mathrm{spr}}$ 给出。\n\n首先，我们计算力 $\\mathbf{F}_{i,s}$。势能 $U_{\\mathrm{spr}}$ 是对所有原子和珠子的求和。对 $\\mathbf{r}_{i,s}$ 的梯度只作用于包含此特定坐标的项。对于给定的原子 $i$，势能中涉及 $\\mathbf{r}_{i,s}$ 的项为：\n$$\nU_{\\mathrm{spr},i,s\\text{-dep}} = \\frac{1}{2} m \\omega_P^2 |\\mathbf{r}_{i,s-1} - \\mathbf{r}_{i,s}|^2 + \\frac{1}{2} m \\omega_P^2 |\\mathbf{r}_{i,s} - \\mathbf{r}_{i,s+1}|^2\n$$\n对 $\\mathbf{r}_{i,s}$ 的梯度为：\n$$\n\\nabla_{\\mathbf{r}_{i,s}} U_{\\mathrm{spr}} = \\nabla_{\\mathbf{r}_{i,s}} \\left( \\frac{1}{2} m \\omega_P^2 |\\mathbf{r}_{i,s-1} - \\mathbf{r}_{i,s}|^2 + \\frac{1}{2} m \\omega_P^2 |\\mathbf{r}_{i,s} - \\mathbf{r}_{i,s+1}|^2 \\right)\n$$\n$$\n\\nabla_{\\mathbf{r}_{i,s}} U_{\\mathrm{spr}} = m \\omega_P^2 (\\mathbf{r}_{i,s} - \\mathbf{r}_{i,s-1}) - m \\omega_P^2 (\\mathbf{r}_{i,s+1} - \\mathbf{r}_{i,s}) = m \\omega_P^2 (2\\mathbf{r}_{i,s} - \\mathbf{r}_{i,s-1} - \\mathbf{r}_{i,s+1})\n$$\n因此，作用在珠子 $(i,s)$ 上的力为：\n$$\n\\mathbf{F}_{i,s} = -m \\omega_P^2 (2\\mathbf{r}_{i,s} - \\mathbf{r}_{i,s-1} - \\mathbf{r}_{i,s+1})\n$$\n然后通过对所有珠子求和点积 $\\mathbf{r}_{i,s} \\cdot \\mathbf{F}_{i,s}$ 来计算维里。一种更直接的替代方法是考虑每个弹簧相互作用对维里的贡献。对于连接珠子 $(i,s)$ 和 $(i,s+1)$ 的单个弹簧，其势能为 $U_{s,s+1} = \\frac{1}{2}m\\omega_P^2|\\mathbf{r}_{i,s} - \\mathbf{r}_{i,s+1}|^2$。该相互作用对珠子 $s$ 的力为 $\\mathbf{F}_{s \\leftarrow s+1} = -\\nabla_{\\mathbf{r}_{i,s}}U_{s,s+1} = -m\\omega_P^2(\\mathbf{r}_{i,s} - \\mathbf{r}_{i,s+1})$。对珠子 $s+1$ 的力为 $\\mathbf{F}_{s+1 \\leftarrow s} = -\\nabla_{\\mathbf{r}_{i,s+1}}U_{s,s+1} = m\\omega_P^2(\\mathbf{r}_{i,s} - \\mathbf{r}_{i,s+1}) = -\\mathbf{F}_{s \\leftarrow s+1}$。\n\n这个单一弹簧相互作用对总维里的贡献是：\n$$\nW_{s,s+1} = -(\\mathbf{r}_{i,s} \\cdot \\mathbf{F}_{s \\leftarrow s+1} + \\mathbf{r}_{i,s+1} \\cdot \\mathbf{F}_{s+1 \\leftarrow s}) = -(\\mathbf{r}_{i,s} - \\mathbf{r}_{i,s+1}) \\cdot \\mathbf{F}_{s \\leftarrow s+1}\n$$\n代入力表达式：\n$$\nW_{s,s+1} = -(\\mathbf{r}_{i,s} - \\mathbf{r}_{i,s+1}) \\cdot \\left(-m\\omega_P^2(\\mathbf{r}_{i,s} - \\mathbf{r}_{i,s+1})\\right) = m\\omega_P^2|\\mathbf{r}_{i,s} - \\mathbf{r}_{i,s+1}|^2\n$$\n这个贡献恰好是该弹簧势能的两倍，即 $2 U_{s,s+1}$。总弹簧维里 $W_{\\mathrm{spr}}$ 是体系中所有弹簧贡献的总和：\n$$\nW_{\\mathrm{spr}} = \\sum_{i=1}^{N}\\sum_{s=1}^{P} m \\,\\omega_{P}^{2}\\, \\left|\\mathbf{r}_{i,s} - \\mathbf{r}_{i,s+1}\\right|^{2}\n$$\n这等价于 $2 U_{\\mathrm{spr}}$。\n\n### 第 2 部分：环状聚合物简正模频率\n我们分析单个自由环状聚合物的动力学（省略原子索引 $i$）。一维拉格朗日量为 $L = \\sum_s \\frac{1}{2}m\\dot{r}_s^2 - U_{\\mathrm{spr}}$，其中 $U_{\\mathrm{spr}} = \\frac{1}{2} m \\omega_P^2 \\sum_{s=1}^P (r_s - r_{s+1})^2$。\n运动方程为：\n$$\nm\\ddot{r}_s = -\\frac{\\partial U_{\\mathrm{spr}}}{\\partial r_s} = -m\\omega_P^2(2r_s - r_{s-1} - r_{s+1})\n$$\n我们使用简正模（离散傅里叶）变换。简正模坐标 $q_k$ 与珠子坐标 $r_s$ 的关系如下：\n$$\nr_s = \\frac{1}{\\sqrt{P}} \\sum_{k=0}^{P-1} q_k \\exp\\left(\\frac{i 2\\pi k s}{P}\\right)\n$$\n将此代入运动方程并投影到第 $k$ 个模上，得到 $q_k$ 的解耦方程：\n$$\nm\\ddot{q}_k = -m\\omega_P^2 q_k \\left[2 - \\exp\\left(-\\frac{i2\\pi k}{P}\\right) - \\exp\\left(\\frac{i2\\pi k}{P}\\right)\\right]\n$$\n$$\nm\\ddot{q}_k = -m\\omega_P^2 q_k \\left[2 - 2\\cos\\left(\\frac{2\\pi k}{P}\\right)\\right]\n$$\n使用半角恒等式 $1 - \\cos(2\\theta) = 2\\sin^2(\\theta)$，上式变为：\n$$\nm\\ddot{q}_k = -m\\omega_P^2 q_k \\left[4\\sin^2\\left(\\frac{\\pi k}{P}\\right)\\right]\n$$\n这是一个谐振子方程 $m\\ddot{q}_k = -m\\omega_k^2 q_k$，其中 $\\omega_k$ 是简正模频率。因此，频率谱为：\n$$\n\\omega_k = \\sqrt{4\\omega_P^2 \\sin^2\\left(\\frac{\\pi k}{P}\\right)} = 2\\omega_P \\left|\\sin\\left(\\frac{\\pi k}{P}\\right)\\right|, \\quad \\text{对于 } k = 0, 1, \\dots, P-1\n$$\n$k=0$ 模对应于质心运动，$\\omega_0 = 0$，因为势能仅依赖于相对珠子位置。最低的*非零*内模频率对应于 $k=1$（以及与之简并的 $k=P-1$）。\n$$\n\\omega_{1} = 2\\omega_P \\sin\\left(\\frac{\\pi}{P}\\right)\n$$\n\n### 第 3 部分：控压器振荡频率 $\\omega_b$\n问题要求证明控压器变量 $\\varepsilon$ 的固有频率 $\\omega_b$ 可以写成 $\\omega_{b} = \\sqrt{G k_{B} T / W}$。控压器运动方程的推导及其线性化是微妙的，且依赖于扩展拉格朗日量的具体形式。然而，结果的形式指向一个基于控制控压器动力学的有效势的物理解释。\n$\\varepsilon$ 的运动方程形式为 $W\\ddot{\\varepsilon} = F(\\varepsilon)$，其中 $F(\\varepsilon)$ 是广义力。对于围绕平衡点 ($\\varepsilon=0$) 的小振荡，该方程线性化为 $W\\ddot{\\varepsilon} \\approx -K_{eff}\\varepsilon$，其中 $K_{eff} = -(\\partial F/\\partial\\varepsilon)|_{\\varepsilon=0}$ 是有效弹簧常数。振荡频率则为 $\\omega_b = \\sqrt{K_{eff}/W}$。\n问题陈述，在压力主要由动能项主导的假设下，控压器频率可以写成给定的表达式。在此极限下，作用于体积变量的广义力中的主导项来自于粒子的动能。根据能量均分定理，与 $G=3NP$ 个珠子自由度相关的总动能为 $\\langle K \\rangle = \\frac{1}{2} G k_B T$。该动能产生一个压力项 $P_{kin} \\approx G k_B T / (3V)$。控制体积涨落的有效势与总动能同量级，为 $Gk_BT$。对于像 $\\varepsilon$ 这样的无量纲变量，有效弹簧常数 $K_{eff}$ 必须具有能量的单位。在 MTK 控压器的背景下，一个已知的结果是，在这些假设下，晶胞变量的有效弹簧常数为 $K_{eff} = G k_B T$。\n因此，线性化的运动方程变为 $W\\ddot{\\varepsilon} = -G k_{B} T \\varepsilon$，这给出了所求的固有频率：\n$$\n\\omega_b = \\sqrt{\\frac{G k_{B} T}{W}}\n$$\n\n### 第 4 部分：最优控压器质量 $W$\n为避免控压器与聚合物内模之间的共振耦合（这可能导致数值不稳定，或称为“振铃”效应），将控压器频率 $\\omega_b$ 调节至与环状聚合物的最低非零内模频率 $\\omega_1$ 相匹配。\n$$\n\\omega_b = \\omega_1\n$$\n将两边平方，并代入第 2 部分和第 3 部分的表达式：\n$$\n\\omega_b^2 = \\omega_1^2\n$$\n$$\n\\frac{G k_B T}{W} = \\left(2\\omega_P \\sin\\left(\\frac{\\pi}{P}\\right)\\right)^2 = 4\\omega_P^2 \\sin^2\\left(\\frac{\\pi}{P}\\right)\n$$\n我们求解控压器质量 $W$：\n$$\nW = \\frac{G k_B T}{4\\omega_P^2 \\sin^2\\left(\\frac{\\pi}{P}\\right)}\n$$\n现在，我们代入给定的 $G$ 和 $\\omega_P$ 的表达式：\n- $G = 3NP$\n- $\\omega_P = \\frac{P k_B T}{\\hbar}$\n$$\nW = \\frac{(3NP) k_B T}{4\\left(\\frac{P k_B T}{\\hbar}\\right)^2 \\sin^2\\left(\\frac{\\pi}{P}\\right)}\n$$\n$$\nW = \\frac{3NP k_B T}{4 \\frac{P^2 (k_B T)^2}{\\hbar^2} \\sin^2\\left(\\frac{\\pi}{P}\\right)}\n$$\n最后，我们通过消去项来简化表达式：\n$$\nW = \\frac{3NP k_B T \\hbar^2}{4 P^2 (k_B T)^2 \\sin^2\\left(\\frac{\\pi}{P}\\right)}\n$$\n$$\nW = \\frac{3N \\hbar^2}{4 P k_B T \\sin^2\\left(\\frac{\\pi}{P}\\right)}\n$$\n这就是最优控压器质量 $W$ 的最终闭式解析表达式。", "answer": "$$\n\\boxed{\\frac{3 N \\hbar^2}{4 P k_B T \\sin^2\\left(\\frac{\\pi}{P}\\right)}}\n$$", "id": "3473910"}]}