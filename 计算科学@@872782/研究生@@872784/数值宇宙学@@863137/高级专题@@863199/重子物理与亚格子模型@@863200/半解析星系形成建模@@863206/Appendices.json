{"hands_on_practices": [{"introduction": "本练习将带你深入研究分析性的“漏盒”（leaky-box）模型，这是追踪星系化学增丰的基石。理解气体流出如何影响气体分数和金属丰度之间的关系，对于解释模型输出和真实的星系观测至关重要。通过这个练习，你将锻炼从第一性原理推导基本星系演化方程的能力，并深入理解有效产率（effective yield）$y_{\\rm eff}$ 等关键概念。", "problem": "在星系形成的半解析模型中，恒星形成库的化学演化通常在瞬时再循环近似（IRA）下进行描述。在该近似中，一部分比例为 $R$ 的新形成的恒星质量会立即以周围环境的金属丰度返回到星际介质（ISM）中，而新合成的金属则以一个恒定的真实核合成产率 $y$（每单位锁定在长寿命恒星和恒星遗迹中的质量）注入。考虑一个没有宇宙学流入的、充分混合的漏盒系统，其中恒星形成率为 $\\psi(t)$，气体质量为 $M_{\\rm g}(t)$，锁定在长寿命恒星中的恒星质量为 $M_\\star(t)$，ISM金属丰度为 $Z(t)$。设外流（风）率为 $W(t) = \\eta\\,\\psi(t)$，其中质量加载因子 $\\eta \\ge 0$，并假设外流气体携带ISM的金属丰度 $Z(t)$。定义气体分数 $\\mu \\equiv M_{\\rm g}/(M_{\\rm g}+M_\\star)$ 和有效产率 $y_{\\rm eff}(\\mu) \\equiv Z(\\mu)/\\ln(1/\\mu)$，该产率仅在理想闭盒情况下等于真实产率 $y$。\n\n从质量和金属守恒以及IRA出发（除了$\\psi$的存在之外，不要假设任何特定的恒星形成定律），根据第一性原理推断，在固定的气体分数 $\\mu \\in (0,1)$ 下，质量加载为 $\\eta$ 的外流如何影响保留的金属丰度 $Z(\\mu)$，并从而影响有效产率 $y_{\\rm eff}(\\mu)$。以下哪个陈述是正确的？选择所有适用的选项。\n\nA. 对于固定的 $\\mu$ 和 $R$，有效产率 $y_{\\rm eff}(\\mu)$ 是 $\\eta$ 的单调递减函数。它对所有 $\\eta \\ge 0$ 都满足 $y_{\\rm eff}(\\mu) \\le y$，并且当 $\\eta \\to \\infty$ 时 $y_{\\rm eff}(\\mu) \\to 0$。\n\nB. 如果外流气体的金属丰度与ISM相同，则在固定的 $\\mu$ 下，有效产率 $y_{\\rm eff}$ 与 $\\eta$ 无关，因为外流按比例移除了气体和金属。\n\nC. 在固定 $\\eta$ 且 $\\mu \\to 0$ 的极限情况下，有效产率趋向于一个恒定的“稀释”值 $y_{\\rm eff} \\to y\\big/\\big(1+\\eta/(1-R)\\big)$。\n\nD. 对于固定的 $\\eta0$，减小 $\\mu$（即将更多气体消耗成恒星）总是会增加 $y_{\\rm eff}$，并且当 $\\mu \\to 0$ 时 $y_{\\rm eff} \\to y$。\n\nE. 如果风相对于ISM是富金属的（喷出气体的金属丰度超过 $Z$），那么在固定的 $\\mu$ 下，对于相同的 $\\eta$，有效产率 $y_{\\rm eff}$ 将比充分混合的情况更低。\n\nF. 对于所有 $\\mu \\in (0,1)$，在充分混合的漏盒模型中，精确关系 $y_{\\rm eff} = y/(1+\\eta)$ 成立，且与 $R$ 无关。", "solution": "描述星系化学演化的漏盒模型的问题陈述在科学上是合理的、提法是恰当的、客观的且内部是一致的。所有的定义和参数都是该领域的标准。因此，该问题是有效的，我们可以进行推导。\n\n我们的第一步是根据第一性原理建立该系统的控制微分方程。\n\n**1. 质量守恒方程**\n星际介质（ISM）中气体质量 $M_{\\rm g}(t)$ 的变化由恒星形成所消耗、短寿命恒星的再循环以及通过外流（风）的损失所控制：\n$$ \\frac{dM_{\\rm g}}{dt} = -\\psi(t) + R\\,\\psi(t) - W(t) $$\n给定外流率 $W(t) = \\eta\\,\\psi(t)$，这变为：\n$$ \\frac{dM_{\\rm g}}{dt} = -(1 - R + \\eta)\\psi(t) \\quad (*)$$\n长寿命恒星和恒星遗迹的质量 $M_\\star(t)$ 以恒星形成率 $\\psi(t)$ 的一个分数 $(1-R)$ 增加：\n$$ \\frac{dM_\\star}{dt} = (1 - R)\\psi(t) \\quad (**) $$\n\n**2. 金属守恒方程**\nISM中的金属质量为 $M_Z(t) = Z(t) M_{\\rm g}(t)$。其变化率由新合成金属的增加以及因并入恒星和在外流中喷出而造成的损失来描述。\n新金属的注入率由真实产率 $y$ 乘以质量被锁定在长寿命恒星中的速率给出：$y \\times (1-R)\\psi(t)$。\n从ISM中移除金属的速率有三个组成部分：\n- 锁定到新恒星中：形成恒星的气体质量为 $\\psi(t)$，因此移除的金属质量为 $Z(t)\\psi(t)$。\n- 从短寿命恒星返回：返回的质量为 $R\\,\\psi(t)$，并且问题陈述其具有环境金属丰度 $Z(t)$。所以返回的金属质量为 $Z(t)R\\,\\psi(t)$。\n- 在外流中喷出：喷出的气体质量为 $W(t) = \\eta\\,\\psi(t)$，它携带ISM的金属丰度 $Z(t)$。所以损失的金属质量为 $Z(t)\\eta\\,\\psi(t)$。\n\n金属质量的净变化率为：\n$$ \\frac{dM_Z}{dt} = y(1-R)\\psi(t) - Z(t)\\psi(t) + Z(t)R\\,\\psi(t) - Z(t)\\eta\\,\\psi(t) $$\n$$ \\frac{dM_Z}{dt} = \\psi(t) [y(1-R) - Z(t)(1 - R + \\eta)] $$\n使用乘积法则，$\\frac{dM_Z}{dt} = M_{\\rm g}\\frac{dZ}{dt} + Z\\frac{dM_{\\rm g}}{dt}$。代入这个和方程 $(*)$：\n$$ M_{\\rm g}\\frac{dZ}{dt} + Z(t) [-(1-R+\\eta)\\psi(t)] = \\psi(t) [y(1-R) - Z(t)(1 - R + \\eta)] $$\n包含 $Z(t)$ 的项相互抵消，从而得出一个关于金属丰度浓度变化的非常简洁而有力的关系式：\n$$ M_{\\rm g}(t)\\frac{dZ}{dt} = y(1-R)\\psi(t) \\quad (***) $$\n\n**3. 推导金属丰度-气体分数关系 $Z(\\mu)$**\n我们希望找到金属丰度 $Z$ 和气体分数 $\\mu = M_{\\rm g}/(M_{\\rm g}+M_\\star)$ 之间的关系，消去时间 $t$ 和恒星形成率 $\\psi(t)$。\n首先，我们将方程$(***)$除以方程$(*)$，求出 $Z$ 相对于 $M_{\\rm g}$ 的变化：\n$$ \\frac{dZ}{dM_{\\rm g}} = \\frac{dZ/dt}{dM_{\\rm g}/dt} = \\frac{y(1-R)\\psi(t) / M_{\\rm g}(t)}{-(1-R+\\eta)\\psi(t)} = -\\frac{y(1-R)}{M_{\\rm g}(1-R+\\eta)} $$\n这将金属丰度与气体质量联系起来。为了将其与气体分数 $\\mu$ 联系起来，我们首先需要找出 $M_{\\rm g}$ 和 $M_\\star$ 是如何相关的。从$(*)$和$(**)$：\n$$ \\frac{dM_\\star}{dM_{\\rm g}} = \\frac{(1-R)\\psi(t)}{-(1-R+\\eta)\\psi(t)} = -\\frac{1-R}{1-R+\\eta} $$\n从纯气体的初始状态（$M_{\\rm g} = M_0$, $M_\\star = 0$）开始对此进行积分，得到：\n$$ M_\\star = \\frac{1-R}{1-R+\\eta}(M_0-M_{\\rm g}) $$\n现在，我们求 $Z$ 对 $\\mu$ 的导数。\n$$ d\\mu = d\\left(\\frac{M_{\\rm g}}{M_{\\rm g}+M_\\star}\\right) = \\frac{M_\\star dM_{\\rm g} - M_{\\rm g} dM_\\star}{(M_{\\rm g}+M_\\star)^2} $$\n将 $dM_{\\rm g}$ 和 $dM_\\star$ 用 $\\psi(t)dt$ 表示的表达式代入：\n$$ \\frac{d\\mu}{dt} = - \\frac{\\psi(t)}{M_{\\rm g}+M_\\star} [1-R+\\eta(1-\\mu)] $$\n现在我们可以计算 $dZ/d\\mu$：\n$$ \\frac{dZ}{d\\mu} = \\frac{dZ/dt}{d\\mu/dt} = \\frac{y(1-R)\\psi/M_{\\rm g}}{-\\psi/(M_{\\rm g}+M_\\star)[1-R+\\eta(1-\\mu)]} = - \\frac{y(1-R)}{\\mu [1-R+\\eta(1-\\mu)]} $$\n假设系统从原生气体（在 $\\mu=1$ 时 $Z=0$）开始，我们可以将此式从 $(\\mu=1, Z=0)$ 积分到状态 $(\\mu, Z)$：\n$$ Z(\\mu) = -y(1-R) \\int_1^\\mu \\frac{d\\mu'}{\\mu'[1-R+\\eta(1-\\mu')]} $$\n解这个积分得到：\n$$ Z(\\mu) = \\frac{y(1-R)}{1-R+\\eta} \\ln\\left( \\frac{1}{\\mu} \\frac{1-R+\\eta(1-\\mu)}{1-R} \\right) $$\n\n**4. 有效产率 $y_{\\rm eff}(\\mu)$**\n使用定义 $y_{\\rm eff}(\\mu) \\equiv Z(\\mu)/\\ln(1/\\mu)$，我们得到：\n$$ y_{\\rm eff}(\\mu) = \\frac{y(1-R)}{1-R+\\eta} \\frac{\\ln\\left( \\frac{1}{\\mu} \\frac{1-R+\\eta(1-\\mu)}{1-R} \\right)}{\\ln(1/\\mu)} $$\n$$ y_{\\rm eff}(\\mu) = \\frac{y(1-R)}{1-R+\\eta} \\left[ 1 + \\frac{\\ln\\left( \\frac{1-R+\\eta(1-\\mu)}{1-R} \\right)}{\\ln(1/\\mu)} \\right] $$\n这个完整的表达式让我们能够评估每个选项。评估单调行为的一个更简单的方法是检查 $Z(\\mu)$ 的被积函数。对于固定的 $\\mu$，$Z(\\mu)$ 是一个随 $\\eta$ 单调递减的函数的积分。因此，$Z(\\mu)$ 是 $\\eta$ 的一个单调递减函数。\n\n### 逐项分析\n\n**A. 对于固定的 $\\mu$ 和 $R$，有效产率 $y_{\\rm eff}(\\mu)$ 是 $\\eta$ 的单调递减函数。它对所有 $\\eta \\ge 0$ 都满足 $y_{\\rm eff}(\\mu) \\le y$，并且当 $\\eta \\to \\infty$ 时 $y_{\\rm eff}(\\mu) \\to 0$。**\n- **单调性**：从被积函数 $1/(\\mu'[1-R+\\eta(1-\\mu')])$ 是 $\\eta$ 的递减函数可以确定，对于任何固定的 $\\mu \\in (0,1)$，所得积分 $Z(\\mu)$ 是 $\\eta$ 的单调递减函数。由于 $y_{\\rm eff}(\\mu) = Z(\\mu)/\\ln(1/\\mu)$ 且 $\\ln(1/\\mu)  0$，$y_{\\rm eff}(\\mu)$ 也是 $\\eta$ 的单调递减函数。\n- **上界**：$y_{\\rm eff}(\\mu)$ 的最大值出现在 $\\eta$ 的最小允许值处，即 $\\eta=0$。当 $\\eta=0$ 时，$y_{\\rm eff}(\\mu)$ 的表达式简化为 $y_{\\rm eff}(\\mu) = \\frac{y(1-R)}{1-R} \\left[ 1 + \\frac{\\ln(1)}{\\ln(1/\\mu)}\\right] = y$。由于函数从这个最大值开始单调递减，我们有对所有 $\\eta \\ge 0$，$y_{\\rm eff}(\\mu) \\le y$。\n- **渐近极限**：当 $\\eta \\to \\infty$ 时，$y_{\\rm eff}(\\mu)$ 的表达式行为类似于 $\\frac{\\ln(\\eta)}{\\eta}$。使用 L'Hôpital 法则，$\\lim_{\\eta\\to\\infty} \\frac{\\ln(\\eta)}{\\eta} = \\lim_{\\eta\\to\\infty} \\frac{1/\\eta}{1} = 0$。因此，当 $\\eta \\to \\infty$ 时，$y_{\\rm eff}(\\mu) \\to 0$。\n陈述的所有三个部分都是正确的。\n**结论：正确。**\n\n**B. 如果外流气体的金属丰度与ISM相同，则在固定的 $\\mu$ 下，有效产率 $y_{\\rm eff}$ 与 $\\eta$ 无关，因为外流按比例移除了气体和金属。**\n我们推导出的 $y_{\\rm eff}(\\mu)$ 表达式明确地依赖于 $\\eta$。这个推理是错误的，因为虽然在任何瞬间外流是成比例的，但它们改变了达到给定气体分数 $\\mu$ 的演化路径。更高的 $\\eta$ 意味着更多的气体被损失，因此需要更多的恒星形成才能将气体分数降低到某个水平。这改变了产生的金属总量与保留的金属总量之间的关系。如A选项所示，$y_{\\rm eff}$ 是 $\\eta$ 的递减函数。\n**结论：不正确。**\n\n**C. 在固定 $\\eta$ 且 $\\mu \\to 0$ 的极限情况下，有效产率趋向于一个恒定的“稀释”值 $y_{\\rm eff} \\to y\\big/\\big(1+\\eta/(1-R)\\big)$。**\n我们评估当 $\\mu \\to 0$ 时 $y_{\\rm eff}(\\mu)$ 的极限：\n$$ \\lim_{\\mu\\to 0} y_{\\rm eff}(\\mu) = \\lim_{\\mu\\to 0} \\frac{y(1-R)}{1-R+\\eta} \\left[ 1 + \\frac{\\ln\\left(1 + \\frac{\\eta(1-\\mu)}{1-R}\\right)}{\\ln(1/\\mu)} \\right] $$\n当 $\\mu \\to 0$ 时，$\\ln(1/\\mu) \\to \\infty$。分数的分子趋向于一个常数值 $\\ln(1 + \\eta/(1-R))$。一个常数除以无穷大为零。因此，方括号中的项趋近于 $1$。\n$$ \\lim_{\\mu\\to 0} y_{\\rm eff}(\\mu) = \\frac{y(1-R)}{1-R+\\eta} [1] = \\frac{y}{\\frac{1-R+\\eta}{1-R}} = \\frac{y}{1 + \\frac{\\eta}{1-R}} $$\n该陈述是正确的。\n**结论：正确。**\n\n**D. 对于固定的 $\\eta0$，减小 $\\mu$（即将更多气体消耗成恒星）总是会增加 $y_{\\rm eff}$，并且当 $\\mu \\to 0$ 时 $y_{\\rm eff} \\to y$。**\n我们来考察 $y_{\\rm eff}(\\mu)$ 作为 $\\mu$ 的函数的行为。\n- 当 $\\mu \\to 1^{-}$ 时的极限（演化开始）：分数项是 $0/0$ 型。使用 L'Hôpital 法则对 $\\frac{\\ln(\\dots)}{\\ln(1/\\mu)}$，我们发现 $\\lim_{\\mu\\to 1^{-}}y_{\\rm eff}(\\mu) = y$。\n- 当 $\\mu \\to 0$ 时的极限（演化后期）：从C选项我们得到 $\\lim_{\\mu\\to 0}y_{\\rm eff}(\\mu) = y/(1+\\eta/(1-R))$。\n对于 $\\eta > 0$ 和 $R  1$，这个极限严格小于 $y$。\n由于 $y_{\\rm eff}(\\mu)$ 在 $\\mu=1$ 时从 $y$ 开始，并在 $\\mu=0$ 时结束于一个小于 $y$ 的值，该函数在从 $\\mu=1$ 到 $\\mu=0$ 的路径上必须是递减的。因此，减小 $\\mu$ 会*减小*而不是增加 $y_{\\rm eff}$。陈述的第一部分是错误的。第二部分，$y_{\\rm eff} \\to y$ 当 $\\mu \\to 0$ 时，对于 $\\eta0$ 也是错误的。\n**结论：不正确。**\n\n**E. 如果风相对于ISM是富金属的（喷出气体的金属丰度超过 $Z$），那么在固定的 $\\mu$ 下，对于相同的 $\\eta$，有效产率 $y_{\\rm eff}$ 将比充分混合的情况更低。**\n设风的金属丰度为 $Z_W = \\zeta Z$，其中 $\\zeta > 1$。金属守恒方程变为：\n$$ \\frac{dM_Z}{dt} = y(1-R)\\psi - Z\\psi + ZR\\psi - \\zeta Z \\eta \\psi = \\psi[y(1-R) - Z(1-R+\\zeta\\eta)] $$\n这导致了 $dZ/dt$ 的一个修正方程：\n$$ M_{\\rm g}\\frac{dZ}{dt} = \\psi [y(1-R) - Z(\\zeta-1)\\eta] $$\n与充分混合的情况（$\\zeta=1$）相比，在该情况下 $M_{\\rm g}\\frac{dZ}{dt} = \\psi y(1-R)$，金属丰度的增长率 $dZ/dt$ 现在被与 $Z(\\zeta-1)\\eta$ 成正比的项所减小。对于给定的恒星形成历史，金属丰度随时间的增长变慢将导致在任何给定的气体分数 $\\mu  1$ 时，最终的金属丰度 $Z(\\mu)$ 更低。由于 $y_{\\rm eff} \\propto Z$，有效产率也将更低。\n**结论：正确。**\n\n**F. 对于所有 $\\mu \\in (0,1)$，在充分混合的漏盒模型中，精确关系 $y_{\\rm eff} = y/(1+\\eta)$ 成立，且与 $R$ 无关。**\n我们推导出的 $y_{\\rm eff}(\\mu)$ 的一般表达式同时依赖于 $\\mu$ 和 $R$。所提出的关系与这两者都无关。这是一个明显的矛盾。举一个简单的反例，设 $\\eta0$ 并考虑 $\\mu \\to 1$ 的情况。我们发现 $y_{\\rm eff} \\to y$，这不等于 $y/(1+\\eta)$。所提出的关系与更简单的模型（例如，平衡模型）有关，但对于这个漏盒模型来说是不正确的。\n**结论：不正确。**", "answer": "$$\\boxed{ACE}$$", "id": "3486149"}, {"introduction": "在分析性基础上，本练习转向了计算实现。你将编写代码来模拟暗物质晕中星系盘的形成，将暗物质晕的质量和自旋等属性与星系盘的尺寸联系起来。然后，你将应用图姆雷（Toomre）$Q$ 判据来评估星系盘对引力坍缩的稳定性，这是星系内恒星和结构形成的关键过程。", "problem": "您的任务是在数值宇宙学领域内，实现一个简化但科学上一致的、关于暗物质晕内盘状星系形成的半解析模型。您必须从基本物理关系和核心定义出发，推导并计算一个嵌入在由质量和自旋参数表征的晕中的气体指数盘的盘尺度半径、Toomre 稳定性参数以及预期的不稳定盘质量分数。所有计算都必须遵守所提供的建模和单位规范。\n\n建模假设与物理设定：\n- 晕处于红移 $z = 0$，总质量为 M（以太阳质量为单位），并遵循球形顶帽维里化模型，其相对于临界密度的超密度为 $\\Delta = 200$。哈勃常数为 $H_0 = 70$，单位为 $\\mathrm{km\\,s^{-1}\\,Mpc^{-1}}$，在所有计算中必须将其转换为 $\\mathrm{km\\,s^{-1}\\,kpc^{-1}}$。\n- 引力常数为 $G = 4.3009 \\times 10^{-6}$，单位为 $\\mathrm{kpc\\,km^2\\,s^{-2}\\,M_\\odot^{-1}}$。\n- 晕的自旋参数为 $\\lambda$，并假定在形成旋转支撑的指数盘过程中比角动量守恒，其圆周速度剖面是平坦的，$V_c(R) \\approx V_{\\mathrm{vir}}$。\n- 盘质量分数为 $m_d$，因此重子盘质量为 $M_d = m_d M$。盘内气体分数为 $f_g$，得到气体质量 $M_{\\mathrm{gas}} = f_g M_d = f_g m_d M$。\n- 气体盘具有指数面密度剖面 $\\Sigma_g(R) = \\Sigma_0 \\exp(-R/R_d)$，其中 $R_d$ 是盘尺度半径，$\\Sigma_0$ 由质量守恒确定。\n- 气体速度弥散由声速 $c_s$（单位为 $\\mathrm{km\\,s^{-1}}$）近似。\n- 薄气体盘的 Toomre 稳定性参数（Toomre $Q$）定义为 $Q(R) = \\kappa(R) c_s / (\\pi G \\Sigma_g(R))$，其中对于平坦旋转曲线，周转频率为 $\\kappa(R) = \\sqrt{2} V_c(R)/R$。\n\n推导要求（在实现中不提供捷径或目标公式；您的代码必须应用推导出的关系）：\n1. 使用哈勃常数定义的临界密度 $\\rho_c = 3 H_0^2 / (8 \\pi G)$，通过 $M = (4/3) \\pi \\Delta \\rho_c R_{\\mathrm{vir}}^3$ 从晕质量 $M$ 计算维里半径 $R_{\\mathrm{vir}}$。然后计算维里圆周速度 $V_{\\mathrm{vir}} = \\sqrt{G M / R_{\\mathrm{vir}}}$。\n2. 从无量纲自旋参数的定义 $\\lambda = J |E|^{1/2} / (G M^{5/2})$ 出发，其中维里化的等温晕的总能量近似为 $E \\approx - \\tfrac{1}{2} G M^2 / R_{\\mathrm{vir}}$，推导出晕的比角动量 $j_h = J/M$。对于具有平坦旋转曲线的盘，使用比角动量守恒 $j_d \\approx j_h$，其中 $j_d = 2 R_d V_c$。在这些假设下，得出用 $\\lambda$ 和 $R_{\\mathrm{vir}}$ 表示的 $R_d$ 表达式，并用它来计算 $R_d$。\n3. 使用指数盘的质量守恒（$M_{\\mathrm{gas}} = 2 \\pi \\Sigma_0 R_d^2$），从 $M_{\\mathrm{gas}}$ 和 $R_d$ 计算 $\\Sigma_0$。\n4. 计算在 $R = R_d$ 处的 $Q(R)$ 值，以获得具有平坦旋转曲线的指数盘的特征最小稳定性值 $Q_d \\equiv Q(R_d)$。\n5. 确定 $Q(R)  1$ 的不稳定径向区域。证明在 $V_c(R) \\approx V_{\\mathrm{vir}}$ 的条件下，$Q(R)$ 可以写成 $Q(R) = A \\exp(R/R_d) / R$ 的形式（其中 A 为常数），$Q(R)$ 在 $R = R_d$ 处达到最小值，并且当 $Q_d  1$ 时，不等式 $Q(R)  1$ 会产生两个实根 $R_1$ 和 $R_2$。使用 Lambert W 函数求解边界以获得 $R_1$ 和 $R_2$，并通过积分 $R_1$ 和 $R_2$ 之间的指数盘质量再除以总气体质量来计算不稳定气体质量分数。最终的不稳定质量分数仅用无量纲半径 $u_i = R_i / R_d$ 表示。\n\n实现任务：\n- 在一个不接受任何输入并使用提供的测试套件的完整程序中实现上述推导。\n- 对于每个测试用例，计算并输出三元组 $[R_d, Q_d, f_{\\mathrm{unstable}}]$，其中 $R_d$ 必须以 $\\mathrm{kpc}$ 表示，$Q_d$ 是无量纲的，$f_{\\mathrm{unstable}}$ 是不稳定区域中气体质量的小数分数。\n\n测试套件：\n使用以下参数集，每个参数集以 $(M, \\lambda, m_d, f_g, c_s)$ 的形式给出，其中 $M$ 的单位为 $M_\\odot$，$c_s$ 的单位为 $\\mathrm{km\\,s^{-1}}$。\n- 案例1（普通类银河系，预期稳定）：$(1.0 \\times 10^{12}, 0.04, 0.05, 0.20, 10.0)$。\n- 案例2（低自旋、富气体，预期强不稳定）：$(1.0 \\times 10^{12}, 0.01, 0.08, 0.80, 6.0)$。\n- 案例3（中等质量、高自旋，预期稳定）：$(3.0 \\times 10^{11}, 0.08, 0.03, 0.15, 12.0)$。\n- 案例4（低质量、近阈值稳定性）：$(1.0 \\times 10^{10}, 0.03, 0.06, 0.50, 6.0)$。\n- 案例5（案例1的边界条件，接近 $Q_d \\approx 1$）：$(1.0 \\times 10^{12}, 0.04, 0.05, 0.20, 6.64)$。\n\n最终输出规范：\n- 您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表形式的结果，列表中的每个元素本身是代表 $[R_d, Q_d, f_{\\mathrm{unstable}}]$ 的三个浮点数列表，并按测试套件的顺序列出，例如 $\\left[ [r_{d,1}, q_{d,1}, f_{1}], [r_{d,2}, q_{d,2}, f_{2}], \\ldots \\right]$。", "solution": "问题陈述已经过验证，被认为具有科学依据、良定、客观且内部一致。它提出了一个简化但标准的盘状星系形成模型，适合基于第一性原理进行计算实现。所需的任务和推导是合乎逻辑的，并遵循既定的天体物理学形式体系。因此，我们可以继续提供完整的解决方案。\n\n该解决方案通过按照问题描述中指定的方式逐步推导必要的物理量来构建。所有数学符号、变量和数值均根据格式要求以 LaTeX 渲染。\n\n**单位转换与常数**\n\n问题使用一组特定的物理常数和单位进行定义。我们首先为计算确立这些值。\n引力常数为 $G = 4.3009 \\times 10^{-6} \\, \\mathrm{kpc\\,km^2\\,s^{-2}\\,M_\\odot^{-1}}$。\n哈勃常数给定为 $H_0 = 70 \\, \\mathrm{km\\,s^{-1}\\,Mpc^{-1}}$。为了与 $G$ 的单位保持一致，我们将其转换为每千秒差距单位。由于 $1 \\, \\mathrm{Mpc} = 10^3 \\, \\mathrm{kpc}$，我们有：\n$$H_0 = 70 \\, \\frac{\\mathrm{km}}{\\mathrm{s} \\cdot \\mathrm{Mpc}} \\times \\frac{1 \\, \\mathrm{Mpc}}{1000 \\, \\mathrm{kpc}} = 0.07 \\, \\mathrm{km\\,s^{-1}\\,kpc^{-1}}$$\n晕维里化超密度为 $\\Delta = 200$，是相对于红移 $z=0$ 时的临界密度 $\\rho_c$。\n\n**步骤 1. 维里性质的推导**\n\n第一步是通过其维里半径 $R_{\\mathrm{vir}}$ 和维里圆周速度 $V_{\\mathrm{vir}}$ 来表征暗物质晕。\n宇宙的临界密度定义为 $\\rho_c = \\frac{3 H_0^2}{8 \\pi G}$。\n晕质量 $M$ 定义在维里半径 $R_{\\mathrm{vir}}$ 内，此处的平均密度为 $\\Delta \\rho_c$。对于球形晕：\n$$M = \\frac{4}{3} \\pi R_{\\mathrm{vir}}^3 (\\Delta \\rho_c)$$\n代入 $\\rho_c$ 的表达式：\n$$M = \\frac{4}{3} \\pi R_{\\mathrm{vir}}^3 \\left( \\Delta \\frac{3 H_0^2}{8 \\pi G} \\right) = \\frac{\\Delta H_0^2}{2G} R_{\\mathrm{vir}}^3$$\n解出维里半径 $R_{\\mathrm{vir}}$ 得：\n$$R_{\\mathrm{vir}} = \\left( \\frac{2 G M}{\\Delta H_0^2} \\right)^{1/3}$$\n在维里半径处的圆周速度 $V_{\\mathrm{vir}}$ 由球形质量分布的标准公式给出：\n$$V_{\\mathrm{vir}} = \\sqrt{\\frac{G M}{R_{\\mathrm{vir}}}}$$\n这两个方程使我们能够从晕质量 $M$ 计算出晕的基本尺度和速度。\n\n**步骤 2. 盘尺度半径的推导**\n\n盘尺度半径 $R_d$ 是通过假设形成盘的物质的比角动量守恒来确定的。晕的比角动量与其无量纲自旋参数 $\\lambda$ 相关：\n$$\\lambda = \\frac{J |E|^{1/2}}{G M^{5/2}}$$\n其中 $J$ 是总角动量，$E$ 是晕的总能量。对于维里化的等温球体，能量近似为 $E \\approx - \\frac{1}{2} \\frac{G M^2}{R_{\\mathrm{vir}}}$。其绝对值为 $|E| = \\frac{G M^2}{2 R_{\\mathrm{vir}}}$。\n将 $|E|$ 代入 $\\lambda$ 的定义中：\n$$\\lambda = \\frac{J}{G M^{5/2}} \\left( \\frac{G M^2}{2 R_{\\mathrm{vir}}} \\right)^{1/2} = \\frac{J}{G M^{5/2}} \\frac{G^{1/2} M}{\\sqrt{2} R_{\\mathrm{vir}}^{1/2}} = \\frac{J}{\\sqrt{2} G^{1/2} M^{3/2} R_{\\mathrm{vir}}^{1/2}}$$\n晕的比角动量为 $j_h = J/M$。求解 $j_h$：\n$$j_h = \\sqrt{2} \\lambda G^{1/2} M^{1/2} R_{\\mathrm{vir}}^{1/2}$$\n使用关系式 $V_{\\mathrm{vir}}^2 = GM/R_{\\mathrm{vir}}$，我们可以写出 $G^{1/2}M^{1/2} = V_{\\mathrm{vir}} R_{\\mathrm{vir}}^{1/2}$。将此代入 $j_h$ 的表达式中：\n$$j_h = \\sqrt{2} \\lambda (V_{\\mathrm{vir}} R_{\\mathrm{vir}}^{1/2}) R_{\\mathrm{vir}}^{1/2} = \\sqrt{2} \\lambda V_{\\mathrm{vir}} R_{\\mathrm{vir}}$$\n具有面密度 $\\Sigma(R) \\propto \\exp(-R/R_d)$ 和平坦旋转曲线 $V_c$ 的指数盘的比角动量为 $j_d = 2 R_d V_c$。该模型假设比角动量守恒，$j_d \\approx j_h$，以及由晕势能决定的盘的平坦旋转曲线，$V_c \\approx V_{\\mathrm{vir}}$。\n$$2 R_d V_{\\mathrm{vir}} = \\sqrt{2} \\lambda V_{\\mathrm{vir}} R_{\\mathrm{vir}}$$\n解出盘尺度半径 $R_d$ 得到我们的工作公式：\n$$R_d = \\frac{\\lambda}{\\sqrt{2}} R_{\\mathrm{vir}}$$\n\n**步骤 3. 中心气体面密度的推导**\n\n气体盘具有指数面密度剖面 $\\Sigma_g(R) = \\Sigma_0 \\exp(-R/R_d)$，其中 $\\Sigma_0$ 是中心面密度。总气体质量 $M_{\\mathrm{gas}}$ 是通过在整个盘上对该剖面进行积分得到的：\n$$M_{\\mathrm{gas}} = \\int_0^\\infty \\Sigma_g(R) \\, 2 \\pi R \\, dR = 2 \\pi \\Sigma_0 \\int_0^\\infty R e^{-R/R_d} \\, dR$$\n该积分的计算结果为 $R_d^2$。因此，$M_{\\mathrm{gas}} = 2 \\pi \\Sigma_0 R_d^2$。\n气体质量是盘质量 $M_d$ 的一个分数 $f_g$，而盘质量本身又是总晕质量 $M$ 的一个分数 $m_d$，所以 $M_{\\mathrm{gas}} = f_g m_d M$。\n通过令 $M_{\\mathrm{gas}}$ 的两个表达式相等，我们可以解出 $\\Sigma_0$：\n$$\\Sigma_0 = \\frac{M_{\\mathrm{gas}}}{2 \\pi R_d^2} = \\frac{f_g m_d M}{2 \\pi R_d^2}$$\n\n**步骤 4. Toomre 稳定性参数的推导**\n\n薄气体盘的 Toomre 稳定性由参数 $Q(R)$ 量化：\n$$Q(R) = \\frac{\\kappa(R) c_s}{\\pi G \\Sigma_g(R)}$$\n其中 $c_s$ 是气体速度弥散（声速）。对于平坦旋转曲线 $V_c(R) \\approx V_{\\mathrm{vir}}$，周转频率为 $\\kappa(R) = \\sqrt{2} V_c / R \\approx \\sqrt{2} V_{\\mathrm{vir}}/R$。\n代入 $\\kappa(R)$ 和 $\\Sigma_g(R)$ 的表达式：\n$$Q(R) = \\frac{(\\sqrt{2} V_{\\mathrm{vir}}/R) c_s}{\\pi G (\\Sigma_0 e^{-R/R_d})} = \\frac{\\sqrt{2} V_{\\mathrm{vir}} c_s}{\\pi G \\Sigma_0} \\frac{e^{R/R_d}}{R}$$\n这表明 $Q(R)$ 具有 $A \\exp(R/R_d) / R$ 的形式，该形式有一个唯一的最小值。函数 $f(R) = e^{R/R_d}/R$ 的最小值出现在 $f'(R)=0$ 时，解得 $R=R_d$。\n因此，Toomre 参数的最小值 $Q_d$ 出现在 $R=R_d$ 处：\n$$Q_d \\equiv Q(R_d) = \\frac{\\sqrt{2} V_{\\mathrm{vir}} c_s}{\\pi G \\Sigma_0} \\frac{e}{R_d}$$\n代入 $\\Sigma_0$ 的表达式：\n$$Q_d = \\frac{\\sqrt{2} V_{\\mathrm{vir}} c_s e}{\\pi G R_d} \\left( \\frac{2 \\pi R_d^2}{M_{\\mathrm{gas}}} \\right) = \\frac{2 \\sqrt{2} e V_{\\mathrm{vir}} c_s R_d}{G M_{\\mathrm{gas}}}$$\n这提供了一种直接计算盘的特征稳定性的方法。\n\n**步骤 5. 不稳定区域和质量分数的推导**\n\n在 $Q(R)  1$ 的区域，盘对引力坍缩是局部不稳定的。我们可以用其最小值 $Q_d$ 和无量纲半径 $u=R/R_d$ 来表示 $Q(R)$：\n$$Q(R) = Q(u R_d) = \\frac{\\sqrt{2} V_{\\mathrm{vir}} c_s}{\\pi G \\Sigma_0} \\frac{e^{u}}{u R_d} = \\left(\\frac{\\sqrt{2} V_{\\mathrm{vir}} c_s e}{\\pi G \\Sigma_0 R_d}\\right) \\frac{e^{u-1}}{u} = Q_d \\frac{e^{u-1}}{u}$$\n不稳定条件是 $Q_d \\frac{e^{u-1}}{u}  1$。如果 $Q_d \\ge 1$，则该条件永远不会满足，盘在各处都是稳定的，使得不稳定质量分数 $f_{\\mathrm{unstable}} = 0$。\n如果 $Q_d  1$，我们求解 $Q(u)=1$ 处的边界半径：\n$$Q_d \\frac{e^{u-1}}{u} = 1 \\implies u e^{-u} = \\frac{Q_d}{e}$$\n这是一个超越方程，可以使用 Lambert W 函数求解，其定义为 $W(z) e^{W(z)} = z$。我们设 $x=-u$，于是 $u=-x$：\n$$(-x) e^x = \\frac{Q_d}{e} \\implies x e^x = -\\frac{Q_d}{e}$$\n对于 $0  Q_d  1$，自变量 $z = -Q_d/e$ 在 $(-1/e, 0)$ 范围内，此时 Lambert W 函数有两个实数分支，$W_0(z)$ 和 $W_{-1}(z)$。$x$ 的解是 $x_1 = W_{-1}(-Q_d/e)$ 和 $x_2 = W_0(-Q_d/e)$。\n相应的无量纲半径是 $u_1 = -x_2 = -W_0(-Q_d/e)$ 和 $u_2 = -x_1 = -W_{-1}(-Q_d/e)$，定义了不稳定区域 $[R_1, R_2] = [u_1 R_d, u_2 R_d]$。\n不稳定气体的质量是通过在这些半径之间对表面密度剖面进行积分得到的：\n$$M_{\\mathrm{unstable}} = \\int_{R_1}^{R_2} 2\\pi R \\Sigma_g(R) \\, dR = 2\\pi \\Sigma_0 \\int_{R_1}^{R_2} R e^{-R/R_d} \\, dR$$\n不定积分是 $\\int R e^{-R/R_d} dR = -R_d(R+R_d)e^{-R/R_d}$。计算定积分得到：\n$$M_{\\mathrm{unstable}} = 2\\pi \\Sigma_0 R_d^2 \\left[ (1+u_1)e^{-u_1} - (1+u_2)e^{-u_2} \\right]$$\n不稳定质量分数 $f_{\\mathrm{unstable}} = M_{\\mathrm{unstable}} / M_{\\mathrm{gas}}$，其中 $M_{\\mathrm{gas}} = 2\\pi\\Sigma_0 R_d^2$，简化为：\n$$f_{\\mathrm{unstable}} = (1+u_1)e^{-u_1} - (1+u_2)e^{-u_2}$$\n如果 $Q_d \\ge 1$，则 $f_{\\mathrm{unstable}}=0$。这就完成了所有所需量的推导。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import lambertw\n\ndef solve():\n    \"\"\"\n    Main function to run the semi-analytic galaxy formation model for the provided test suite.\n    \"\"\"\n    \n    # Global constants\n    G = 4.3009e-6  # kpc*km^2/s^2/M_sun\n    H0 = 0.07      # km/s/kpc\n    DELTA = 200.0  # Virial overdensity\n\n    test_cases = [\n        # (M [M_sun], lambda, m_d, f_g, c_s [km/s])\n        (1.0e12, 0.04, 0.05, 0.20, 10.0),  # Case 1\n        (1.0e12, 0.01, 0.08, 0.80, 6.0),   # Case 2\n        (3.0e11, 0.08, 0.03, 0.15, 12.0),  # Case 3\n        (1.0e10, 0.03, 0.06, 0.50, 6.0),   # Case 4\n        (1.0e12, 0.04, 0.05, 0.20, 6.64)   # Case 5\n    ]\n    \n    def calculate_disk_properties(M, lam, m_d, f_g, c_s):\n        \"\"\"\n        Calculates Rd, Qd, and f_unstable based on the derived model.\n        \n        Args:\n            M (float): Total halo mass in solar masses.\n            lam (float): Halo spin parameter (dimensionless).\n            m_d (float): Disk mass fraction (dimensionless).\n            f_g (float): Gas fraction of the disk (dimensionless).\n            c_s (float): Gas velocity dispersion in km/s.\n            \n        Returns:\n            list: A list containing [Rd, Qd, f_unstable].\n        \"\"\"\n        \n        # Step 1: Virial Properties\n        # R_vir = (2 * G * M / (DELTA * H0^2))^(1/3)\n        R_vir = (2.0 * G * M / (DELTA * H0**2))**(1.0/3.0)\n        \n        # V_vir = sqrt(G * M / R_vir)\n        V_vir = np.sqrt(G * M / R_vir)\n        \n        # Step 2: Disk Scale Radius\n        # R_d = lambda * R_vir / sqrt(2)\n        R_d = lam * R_vir / np.sqrt(2.0)\n        \n        # Gas mass\n        M_gas = f_g * m_d * M\n        \n        # Step 3 (Implicit in Step 4): Central Surface Density\n        # Sigma_0 = M_gas / (2 * pi * R_d^2)\n        \n        # Step 4: Toomre Q at R_d\n        # Qd = (2 * sqrt(2) * e * V_vir * c_s * R_d) / (G * M_gas)\n        if M_gas == 0 or R_d == 0:\n            return [R_d, float('inf'), 0.0]\n            \n        Q_d = (2.0 * np.sqrt(2.0) * np.e * V_vir * c_s * R_d) / (G * M_gas)\n        \n        # Step 5: Unstable Mass Fraction\n        f_unstable = 0.0\n        if 0  Q_d  1.0:\n            # Solve u * exp(-u) = Q_d / e using the Lambert W function.\n            # Let x = -u, then x * exp(x) = -Q_d / e.\n            arg = -Q_d / np.e\n            \n            # The two solutions u1, u2 are given by the two real branches of W.\n            # u1 = -W_0(arg), u2 = -W_-1(arg)\n            # lambertw returns complex numbers, so we take the real part.\n            u1 = -lambertw(arg, k=0).real\n            u2 = -lambertw(arg, k=-1).real\n            \n            # f_unstable = (1+u1)e^(-u1) - (1+u2)e^(-u2)\n            f_unstable = (1.0 + u1) * np.exp(-u1) - (1.0 + u2) * np.exp(-u2)\n\n        return [R_d, Q_d, f_unstable]\n\n    results = []\n    for case in test_cases:\n        M, lam, m_d, f_g, c_s = case\n        result = calculate_disk_properties(M, lam, m_d, f_g, c_s)\n        results.append(result)\n\n    # The final print statement must match the format [[r1,q1,f1], [r2,q2,f2], ...] exactly.\n    # The default str() representation of a list of lists matches this.\n    print(str(results).replace(\"'\", \"\"))\n\nsolve()\n```", "id": "3486109"}, {"introduction": "半解析模型依赖于“亚格子”（sub-grid）配方来追踪发生在母模拟分辨率以下的物理过程。本练习将处理“孤儿”（orphan）卫星星系这一重要情况，它们的暗物质子晕已被潮汐剥离。你将实现一个基于物理动机的方案，通过钱德拉塞卡（Chandrasekhar）动力学摩擦来追踪它们的轨道衰减，并确定它们的最终命运——并合或潮汐瓦解。", "problem": "在数值宇宙学中的一个半解析星系形成模型中，当一个卫星星系的已解析暗物质子晕在其宿主晕中被瓦解时，该卫星星系在时刻 $t_0$ 成为一个“孤儿”星系。为了继续追踪这个孤儿星系，你必须为其位置演化、与中心星系的并合时间以及是存活还是被潮汐瓦解指定有物理动机的规则。考虑一个可以很好地用单一等温球（SIS）近似的宿主晕，其环绕速度 $V_c$ 为常数，速度弥散 $\\sigma$ 与 $V_c$ 的关系为 $\\sigma = V_c / \\sqrt{2}$。假设背景相空间分布近似为麦克斯韦分布，并且拖曳力由钱德拉塞卡动力学摩擦机制主导。该卫星星系的恒星和气体质量为 $m_{\\mathrm{sat}}$，结构半质量半径为 $r_\\star$；如果近心点处的瞬时潮汐半径 $r_t$ 小于结构尺度的某个倍数，即对于某个 $\\kappa  1$ 有 $r_t  \\kappa r_\\star$，则会发生瓦解。对于轨道衰减，假设轨道在最后解析的半径 $r_0$ 处最初是圆形的，速度为 $v_0 \\simeq V_c$；将库仑对数 $\\ln \\Lambda$ 视为一个常数。\n\n在以下特定设置下进行计算：\n- 宿主晕环绕速度 $V_c = 200 \\, \\mathrm{km \\, s^{-1}}$，且为等温轮廓。\n- 卫星星系质量 $m_{\\mathrm{sat}} = 10^{10} \\, M_\\odot$，结构半质量半径 $r_\\star = 2 \\, \\mathrm{kpc}$，最后解析半径 $r_0 = 50 \\, \\mathrm{kpc}$，在 $t_0$ 时刻速度为 $v_0 = V_c$。\n- 库仑对数 $\\ln \\Lambda = 3$，并在存活判据中使用 $\\kappa = 2$。\n- 对于 $X \\equiv v/(\\sqrt{2}\\sigma) = 1$ 的情况，将钱德拉塞卡拖曳系数中的误差函数组合取为无量纲因子 $B \\equiv \\mathrm{erf}(1) - \\frac{2}{\\sqrt{\\pi}} e^{-1}$。\n- 使用由 SIS 和 $V_c$ 所决定的半径 $r$ 内的包围质量 $M_{\\mathrm{enc}}(r)$。\n\n基于这些物理基础，确定哪种孤儿星系追踪方案对于上述设置是自洽且定量正确的。你的选择必须指明：\n- 一条给出 $\\Delta t = 2 \\, \\mathrm{Gyr}$ 时间后半径 $r(t)$ 的位置演化规则。\n- 由相同的摩擦衰减所决定的并合时间 $t_{\\mathrm{merge}}$。\n- 在 $t_0$ 和 $t_0 + 2 \\, \\mathrm{Gyr}$ 时刻的存活与瓦解分类，该分类基于在瞬时圆形轨道半径处计算的潮汐半径 $r_t$ 和判据 $r_t  \\kappa r_\\star$。\n\n选择唯一最佳选项。\n\nA. 位置在所有时刻 $t$ 都冻结在 $r(t) = r_0$，并合被强制在一个固定的时间尺度 $t_{\\mathrm{merge}} \\simeq r_0 / V_c \\approx 0.25 \\, \\mathrm{Gyr}$ 上发生；存活与否通过比较使用宿主晕的维里质量（而非 $M_{\\mathrm{enc}}(r)$）计算出的 $r_t$ 来确定，得出 $r_t \\approx 2 \\, \\mathrm{kpc}$，并在 $t_0$ 和 $t_0 + 2 \\, \\mathrm{Gyr}$ 时刻立即瓦解。\n\nB. 位置因动力学摩擦而衰减，与 SIS 中的钱德拉塞卡处方一致，给出 $r(2 \\, \\mathrm{Gyr}) \\approx 37 \\, \\mathrm{kpc}$；相应的并合时间为 $t_{\\mathrm{merge}} \\approx 4.4 \\, \\mathrm{Gyr}$；存活与否通过 $r_t(r) = r \\left[ m_{\\mathrm{sat}} / \\left( 3 M_{\\mathrm{enc}}(r) \\right) \\right]^{1/3}$ 进行评估，得出 $r_t(t_0) \\approx 9.6 \\, \\mathrm{kpc}$ 和 $r_t(t_0 + 2 \\, \\mathrm{Gyr}) \\approx 8.0 \\, \\mathrm{kpc}$，两者均超过 $\\kappa r_\\star = 4 \\, \\mathrm{kpc}$，因此孤儿星系在这两个时期都存活。\n\nC. 位置呈指数衰减，$r(t) = r_0 \\exp\\!\\left( - t / t_0 \\right)$，其中常数时间尺度 $t_0$ 被选择为与宿主晕的动力学时标相匹配，得出 $r(2 \\, \\mathrm{Gyr}) \\approx 41 \\, \\mathrm{kpc}$ 和 $t_{\\mathrm{merge}} \\approx 11 \\, \\mathrm{Gyr}$；存活与否通过将 $r_t$ 与 $r_\\star$ 进行比较（不含因子 $\\kappa$）来确定，给出 $r_t(t_0) \\approx 5 \\, \\mathrm{kpc}$ 和 $r_t(t_0 + 2 \\, \\mathrm{Gyr}) \\approx 4 \\, \\mathrm{kpc}$，被解释为在这两个时期都发生瓦解。\n\nD. 位置呈线性衰减，$r(t) = r_0 - \\alpha t$，其中常数 $\\alpha$ 被选择为使得 $t_{\\mathrm{merge}} \\propto r_0$，并且数值上 $t_{\\mathrm{merge}} \\approx 1.1 \\, \\mathrm{Gyr}$；$2 \\, \\mathrm{Gyr}$ 后的半径为 $r(2 \\, \\mathrm{Gyr}) \\approx 31 \\, \\mathrm{kpc}$；存活与否通过使用 $r_t(r) = r \\left[ m_{\\mathrm{sat}} / M_{\\mathrm{enc}}(r) \\right]^{1/3}$（省略了因子 3）进行评估，得出在 $t_0$ 和 $t_0 + 2 \\, \\mathrm{Gyr}$ 时刻都存活。\n\n如果需要转换单位，假设 $G = 4.302 \\times 10^{-6} \\, \\mathrm{kpc} \\, (\\mathrm{km/s})^2 \\, M_\\odot^{-1}$ 且 $1 \\, \\mathrm{km/s} = 1.0227 \\, \\mathrm{kpc/Gyr}$。通过选择一个与指定基础和参数在物理上一致并能得出正确定量结果的选项来作答。", "solution": "在尝试求解之前，需要对问题的前提进行严格验证。\n\n### 第 1 步：提取已知条件\n- **宿主晕模型**：单一等温球 (SIS)，具有恒定的环绕速度 $V_c$ 和速度弥散 $\\sigma = V_c / \\sqrt{2}$。\n- **背景物理**：麦克斯韦相空间分布，拖曳力由钱德拉塞卡动力学摩擦主导。\n- **卫星初始状态 (在 $t_0$ 时)**：初始轨道为在半径 $r_0$ 处的圆形轨道，速度为 $v_0 \\simeq V_c$。\n- **瓦解判据**：如果潮汐半径 $r_t$ 小于 $\\kappa r_\\star$，则发生瓦解。\n- **宿主晕参数**：$V_c = 200 \\, \\mathrm{km \\, s^{-1}}$。\n- **卫星参数**：\n  - 质量：$m_{\\mathrm{sat}} = 10^{10} \\, M_\\odot$。\n  - 结构半质量半径：$r_\\star = 2 \\, \\mathrm{kpc}$。\n  - 最后解析（初始）半径：$r_0 = 50 \\, \\mathrm{kpc}$。\n  - 初始速度：$v_0 = V_c$。\n- **动力学摩擦参数**：\n  - 库仑对数：$\\ln \\Lambda = 3$。\n  - 对于 $X=1$ 的无量纲因子：$B \\equiv \\mathrm{erf}(1) - \\frac{2}{\\sqrt{\\pi}} e^{-1}$。\n- **瓦解参数**：$\\kappa = 2$。\n- **包围质量**：$M_{\\mathrm{enc}}(r)$ 是具有给定 $V_c$ 的 SIS 轮廓在半径 $r$ 内包围的质量。\n- **评估时间**：$t_0$ 之后的 $\\Delta t = 2 \\, \\mathrm{Gyr}$。\n- **常数**：\n  - $G = 4.302 \\times 10^{-6} \\, \\mathrm{kpc} \\, (\\mathrm{km/s})^2 \\, M_\\odot^{-1}$。\n  - $1 \\, \\mathrm{km/s} = 1.0227 \\, \\mathrm{kpc/Gyr}$。\n\n### 第 2 步：使用提取的已知条件进行验证\n1.  **科学依据**：该问题在标准的星系和河外星系动力学中有充分的依据。单一等温球、钱德拉塞卡动力学摩擦和潮汐瓦解等概念是天体物理学中的教科书级课题。该设置描述了半解析星系形成模型中的一个常见问题。\n2.  **适定性**：该问题提供了一整套初始条件、物理定律和参数值，足以确定卫星轨道及其结构完整性的演化。可以推导出指定量（$r(t)$, $t_{\\mathrm{merge}}$, $r_t$）的唯一解。\n3.  **客观性**：该问题以精确、定量的语言陈述，没有主观或模棱两可的术语。\n4.  **一致性和完备性**：参数彼此一致。对于 SIS，任何半径处的圆形轨道速度均为 $V_c$，因此 $v_0 = V_c$ 是一致的。关系式 $\\sigma = V_c / \\sqrt{2}$ 对于各向同性的 SIS 是正确的。该问题是自包含的。\n5.  **真实性**：宿主晕 ($V_c=200 \\, \\mathrm{km/s}$) 和卫星 ($m_{\\mathrm{sat}}=10^{10} M_\\odot$, $r_0=50 \\text{ kpc}$) 的数值代表了一个类银河系星系和一个大质量卫星。该情景在物理上是合理的。\n\n### 第 3 步：结论与行动\n问题陈述有效。其前提在科学上是合理的、一致的、完备的且适定的。我将继续推导解答。\n\n### 从第一性原理推导\n\n**1. 动力学摩擦引起的轨道衰减**\n钱德拉塞卡动力学摩擦力由下式给出\n$$ \\vec{F}_{\\mathrm{df}} = -4\\pi G^2 m_{\\mathrm{sat}}^2 \\rho(r) (\\ln \\Lambda) \\left[ \\mathrm{erf}(X) - \\frac{2X}{\\sqrt{\\pi}} e^{-X^2} \\right] \\frac{\\vec{v}}{v^3} $$\n其中 $X = v/(\\sqrt{2}\\sigma)$。对于给定的 SIS，有 $v = V_c$ 和 $\\sigma = V_c/\\sqrt{2}$，这给出 $X = V_c / (\\sqrt{2} \\cdot V_c/\\sqrt{2}) = 1$。方括号中的项是给定的常数 $B$。\nSIS 的密度轮廓为 $\\rho(r) = \\frac{V_c^2}{4\\pi G r^2}$。\n将这些代入力的量值方程，并设 $v=V_c$：\n$$ F_{\\mathrm{df}} = 4\\pi G^2 m_{\\mathrm{sat}}^2 \\left(\\frac{V_c^2}{4\\pi G r^2}\\right) (\\ln \\Lambda) B \\frac{1}{V_c^2} = \\frac{G m_{\\mathrm{sat}}^2 (\\ln \\Lambda) B}{r^2} $$\n对于圆形轨道，角动量 $L = m_{\\mathrm{sat}} r V_c$ 的变化率等于力矩 $\\tau = -r F_{\\mathrm{df}}$。\n$$ \\frac{dL}{dt} = \\frac{d}{dt}(m_{\\mathrm{sat}} r V_c) = m_{\\mathrm{sat}} V_c \\frac{dr}{dt} = -r F_{\\mathrm{df}} = -r \\left(\\frac{G m_{\\mathrm{sat}}^2 (\\ln \\Lambda) B}{r^2}\\right) $$\n$$ m_{\\mathrm{sat}} V_c \\frac{dr}{dt} = -\\frac{G m_{\\mathrm{sat}}^2 (\\ln \\Lambda) B}{r} \\implies r \\frac{dr}{dt} = -\\frac{G m_{\\mathrm{sat}} (\\ln \\Lambda) B}{V_c} $$\n这是一个可分离的微分方程。从 $r(0)=r_0$ 到 $r(t)$ 积分：\n$$ \\int_{r_0}^{r(t)} r' dr' = -\\int_0^t \\frac{G m_{\\mathrm{sat}} (\\ln \\Lambda) B}{V_c} dt' $$\n$$ \\frac{1}{2} (r(t)^2 - r_0^2) = -\\frac{G m_{\\mathrm{sat}} (\\ln \\Lambda) B}{V_c} t $$\n$$ r(t)^2 = r_0^2 - \\frac{2 G m_{\\mathrm{sat}} (\\ln \\Lambda) B}{V_c} t $$\n并合时间 $t_{\\mathrm{merge}}$ 是 $r(t)=0$ 时的时间：\n$$ t_{\\mathrm{merge}} = \\frac{r_0^2 V_c}{2 G m_{\\mathrm{sat}} (\\ln \\Lambda) B} $$\n\n**2. 并合时间和位置的数值计算**\n首先，我们计算无量纲因子 $B$：\n$B = \\mathrm{erf}(1) - \\frac{2}{\\sqrt{\\pi}} e^{-1} \\approx 0.84270 - \\frac{2}{1.77245} e^{-1} \\approx 0.84270 - 1.12838 \\times 0.36788 \\approx 0.84270 - 0.41511 = 0.42759$。\n\n现在我们使用给定的常数计算 $t_{\\mathrm{merge}}$：\n$r_0 = 50 \\, \\mathrm{kpc}$\n$V_c = 200 \\, \\mathrm{km \\, s^{-1}}$\n$m_{\\mathrm{sat}} = 10^{10} \\, M_\\odot$\n$G = 4.302 \\times 10^{-6} \\, \\mathrm{kpc} \\, (\\mathrm{km/s})^2 \\, M_\\odot^{-1}$\n$\\ln \\Lambda = 3$\n$B \\approx 0.4276$\n\n$$ t_{\\mathrm{merge}} = \\frac{(50 \\, \\mathrm{kpc})^2 (200 \\, \\mathrm{km/s})}{2 (4.302 \\times 10^{-6}) (10^{10}) (3) (0.4276)} \\, \\frac{M_\\odot}{\\mathrm{kpc} \\, (\\mathrm{km/s})^2} $$\n$$ t_{\\mathrm{merge}} = \\frac{2500 \\times 200}{2 \\times 4.302 \\times 10^4 \\times 3 \\times 0.4276} \\, \\frac{\\mathrm{kpc}}{\\mathrm{km/s}} = \\frac{5 \\times 10^5}{110214} \\, \\frac{\\mathrm{kpc}}{\\mathrm{km/s}} \\approx 4.5366 \\, \\frac{\\mathrm{kpc}}{\\mathrm{km/s}} $$\n使用转换关系 $1 \\, \\mathrm{km/s} = 1.0227 \\, \\mathrm{kpc/Gyr}$，我们有 $1 \\, \\mathrm{kpc/(km/s)} = 1/1.0227 \\, \\mathrm{Gyr} \\approx 0.9778 \\, \\mathrm{Gyr}$。\n$$ t_{\\mathrm{merge}} \\approx 4.5366 \\times 0.9778 \\, \\mathrm{Gyr} \\approx 4.436 \\, \\mathrm{Gyr} $$\n在 $t = \\Delta t = 2 \\, \\mathrm{Gyr}$ 时的轨道半径由下式给出：\n$$ r(t)^2 = r_0^2 \\left(1 - \\frac{t}{t_{\\mathrm{merge}}}\\right) $$\n$$ r(2 \\, \\mathrm{Gyr})^2 = (50 \\, \\mathrm{kpc})^2 \\left(1 - \\frac{2}{4.436}\\right) = 2500 \\left(1 - 0.4508\\right) = 2500 \\times 0.5492 = 1373 \\, \\mathrm{kpc}^2 $$\n$$ r(2 \\, \\mathrm{Gyr}) = \\sqrt{1373} \\approx 37.05 \\, \\mathrm{kpc} $$\n\n**3. 潮汐半径和存活**\n题目要求根据选项 B 中指定的公式评估存活情况：$r_t(r) = r \\left[ m_{\\mathrm{sat}} / \\left( 3 M_{\\mathrm{enc}}(r) \\right) \\right]^{1/3}$。\n首先，我们求出 SIS 的包围质量：$V_c^2 = G M_{\\mathrm{enc}}(r) / r \\implies M_{\\mathrm{enc}}(r) = V_c^2 r / G$。\n$$ M_{\\mathrm{enc}}(r) = \\frac{(200 \\, \\mathrm{km/s})^2 r}{4.302 \\times 10^{-6} \\, \\mathrm{kpc} \\, (\\mathrm{km/s})^2 \\, M_\\odot^{-1}} \\approx (9.298 \\times 10^9 \\, M_\\odot/\\mathrm{kpc}) \\cdot r $$\n现在我们计算潮汐半径：\n$$ r_t(r) = r \\left( \\frac{10^{10} \\, M_\\odot}{3 \\cdot (9.298 \\times 10^9 \\, M_\\odot/\\mathrm{kpc}) \\cdot r} \\right)^{1/3} = r \\left( \\frac{10}{27.894} \\frac{\\mathrm{kpc}}{r} \\right)^{1/3} = r \\left( \\frac{0.3585}{r/\\mathrm{kpc}} \\right)^{1/3} $$\n$$ r_t(r) \\approx 0.7104 \\cdot r^{2/3} \\, \\mathrm{kpc} $$\n瓦解条件是 $r_t  \\kappa r_\\star$。由于 $\\kappa=2$ 且 $r_\\star=2 \\, \\mathrm{kpc}$，阈值为 $4 \\, \\mathrm{kpc}$。\n\n- 在时刻 $t_0$，$r=r_0=50 \\, \\mathrm{kpc}$：\n$r_t(t_0) \\approx 0.7104 \\cdot (50)^{2/3} \\approx 0.7104 \\cdot (13.572) \\approx 9.64 \\, \\mathrm{kpc}$。\n因为 $9.64 \\, \\mathrm{kpc} > 4 \\, \\mathrm{kpc}$，卫星在 $t_0$ 时刻存活。\n\n- 在时刻 $t_0 + 2 \\, \\mathrm{Gyr}$，$r(2 \\, \\mathrm{Gyr}) \\approx 37.05 \\, \\mathrm{kpc}$：\n$r_t(2 \\, \\mathrm{Gyr}) \\approx 0.7104 \\cdot (37.05)^{2/3} \\approx 0.7104 \\cdot (11.096) \\approx 7.88 \\, \\mathrm{kpc}$。\n因为 $7.88 \\, \\mathrm{kpc} > 4 \\, \\mathrm{kpc}$，卫星在 $t_0 + 2 \\, \\mathrm{Gyr}$ 时刻存活。\n\n我们推导出的值为：$r(2\\,\\mathrm{Gyr}) \\approx 37.1 \\, \\mathrm{kpc}$，$t_{\\mathrm{merge}} \\approx 4.4 \\, \\mathrm{Gyr}$，$r_t(t_0) \\approx 9.6 \\, \\mathrm{kpc}$，以及 $r_t(t_0+2\\,\\mathrm{Gyr}) \\approx 7.9 \\, \\mathrm{kpc}$。卫星在这两个时期都存活。\n\n### 逐项分析\n\n**A. 位置在所有时刻 $t$ 都冻结在 $r(t) = r_0$，并合被强制在一个固定的时间尺度 $t_{\\mathrm{merge}} \\simeq r_0 / V_c \\approx 0.25 \\, \\mathrm{Gyr}$ 上发生；存活与否通过比较使用宿主晕的维里质量（而非 $M_{\\mathrm{enc}}(r)$）计算出的 $r_t$ 来确定，得出 $r_t \\approx 2 \\, \\mathrm{kpc}$，并在 $t_0$ 和 $t_0 + 2 \\, \\mathrm{Gyr}$ 时刻立即瓦解。**\n- 位置演化模型（冻结位置）与指定的动力学摩擦机制相矛盾。\n- 并合时间尺度 $r_0/V_c$ 是动力学时标，而不是摩擦时标，这对于轨道衰减是不正确的。我们计算出的摩擦时标约为 $4.4 \\, \\mathrm{Gyr}$。\n- $r_t$ 的计算方法不正确；潮汐力是局域的，依赖于 $M_{\\mathrm{enc}}(r)$。\n**结论：不正确。**\n\n**B. 位置因动力学摩擦而衰减，与 SIS 中的钱德拉塞卡处方一致，给出 $r(2 \\, \\mathrm{Gyr}) \\approx 37 \\, \\mathrm{kpc}$；相应的并合时间为 $t_{\\mathrm{merge}} \\approx 4.4 \\, \\mathrm{Gyr}$；存活与否通过 $r_t(r) = r \\left[ m_{\\mathrm{sat}} / \\left( 3 M_{\\mathrm{enc}}(r) \\right) \\right]^{1/3}$ 进行评估，得出 $r_t(t_0) \\approx 9.6 \\, \\mathrm{kpc}$ 和 $r_t(t_0 + 2 \\, \\mathrm{Gyr}) \\approx 8.0 \\, \\mathrm{kpc}$，两者均超过 $\\kappa r_\\star = 4 \\, \\mathrm{kpc}$，因此孤儿星系在这两个时期都存活。**\n- 位置衰减模型与 SIS 中的钱德拉塞卡处方一致。\n- 计算出的半径 $r(2\\,\\mathrm{Gyr}) \\approx 37 \\, \\mathrm{kpc}$ 与我们的推导（$37.1 \\, \\mathrm{kpc}$）相符。\n- 计算出的并合时间 $t_{\\mathrm{merge}} \\approx 4.4 \\, \\mathrm{Gyr}$ 与我们的推导（$4.44 \\, \\mathrm{Gyr}$）相符。\n- 潮汐半径的计算与选项中提供的公式是自洽的。数值 $r_t(t_0) \\approx 9.6 \\, \\mathrm{kpc}$ 和 $r_t(t_0+2\\,\\mathrm{Gyr}) \\approx 8.0 \\, \\mathrm{kpc}$ 与我们的计算（分别为 $9.64 \\, \\mathrm{kpc}$ 和 $7.88 \\, \\mathrm{kpc}$）相符。\n- 基于这些值和给定的判据（$\\kappa r_\\star = 4 \\, \\mathrm{kpc}$），存活的结论是正确的。\n**结论：正确。**\n\n**C. 位置呈指数衰减，$r(t) = r_0 \\exp\\!\\left( - t / t_0 \\right)$，其中常数时间尺度 $t_0$ 被选择为与宿主晕的动力学时标相匹配，得出 $r(2 \\, \\mathrm{Gyr}) \\approx 41 \\, \\mathrm{kpc}$ 和 $t_{\\mathrm{merge}} \\approx 11 \\, \\mathrm{Gyr}$；存活与否通过将 $r_t$ 与 $r_\\star$ 进行比较（不含因子 $\\kappa$）来确定，给出 $r_t(t_0) \\approx 5 \\, \\mathrm{kpc}$ 和 $r_t(t_0 + 2 \\, \\mathrm{Gyr}) \\approx 4 \\, \\mathrm{kpc}$，被解释为在这两个时期都发生瓦解。**\n- 对于 SIS 中的动力学摩擦，指数衰减模型在物理上是不正确的；正确的形式是 $r \\propto (t_{\\mathrm{merge}}-t)^{1/2}$。\n- 使用错误的瓦解判据（忽略 $\\kappa=2$）违反了问题陈述。\n- 这些数字在内部不一致。一个时间尺度与宿主晕动力学时标（$\\approx 0.25 \\, \\mathrm{Gyr}$）相匹配的指数衰减，将导致卫星几乎瞬间并合，而不是在 $2 \\, \\mathrm{Gyr}$ 后位于 $41 \\, \\mathrm{kpc}$ 处。\n**结论：不正确。**\n\n**D. 位置呈线性衰减，$r(t) = r_0 - \\alpha t$，其中常数 $\\alpha$ 被选择为使得 $t_{\\mathrm{merge}} \\propto r_0$，并且数值上 $t_{\\mathrm{merge}} \\approx 1.1 \\, \\mathrm{Gyr}$；$2 \\, \\mathrm{Gyr}$ 后的半径为 $r(2 \\, \\mathrm{Gyr}) \\approx 31 \\, \\mathrm{kpc}$；存活与否通过使用 $r_t(r) = r \\left[ m_{\\mathrm{sat}} / M_{\\mathrm{enc}}(r) \\right]^{1/3}$（省略了因子 3）进行评估，得出在 $t_0$ 和 $t_0 + 2 \\, \\mathrm{Gyr}$ 时刻都存活。**\n- 线性衰减模型在物理上是不正确的。\n- 对于 SIS，$t_{\\mathrm{merge}} \\propto r_0^2$，因此标度关系 $t_{\\mathrm{merge}} \\propto r_0$ 是不正确的。\n- 数值 $t_{\\mathrm{merge}} \\approx 1.1 \\, \\mathrm{Gyr}$ 是不正确的。\n- 一个 $t_{\\mathrm{merge}} = 1.1 \\, \\mathrm{Gyr}$ 的线性衰减将意味着 $r(2 \\, \\mathrm{Gyr})  0$，这与所述的 $31 \\, \\mathrm{kpc}$ 相矛盾。该选项在数值上不一致。\n- 潮汐半径的公式是一个非标准变体。\n**结论：不正确。**", "answer": "$$\\boxed{B}$$", "id": "3486152"}]}