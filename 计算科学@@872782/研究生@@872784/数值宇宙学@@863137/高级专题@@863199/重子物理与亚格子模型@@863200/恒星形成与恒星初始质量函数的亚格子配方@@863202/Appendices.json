{"hands_on_practices": [{"introduction": "为什么数值模拟需要次网格模型？根本原因在于有限的计算分辨率。当气体在引力作用下坍缩时，其密度会不断增加，导致引力不稳定的特征尺度——金斯长度（$\\lambda_J$）——持续减小。如果 $\\lambda_J$ 变得小于模拟的网格尺寸 $\\Delta x$，模拟将无法正确捕捉坍缩过程，并可能产生非物理的人工碎裂。本练习 [@problem_id:3491800] 将指导你运用著名的 Truelove 判据，计算出一个模拟在不依赖次网格模型的情况下所能解析的最大气体密度，从而深刻理解次网格物理模型在计算天体物理中的必要性。", "problem": "在一个宇宙学流体动力学模拟中，直到引力坍缩在数值上变得无法解析之前，不采用次网格恒星形成方案。这种无法解析的坍缩的开始通常使用 Truelove 解析判据来确定。考虑一个大小为 $\\Delta x = 100\\,\\mathrm{pc}$、声速为 $c_s = 1\\,\\mathrm{km\\,s^{-1}}$ 的均匀网格单元中的等温自引力气体。Truelove 判据要求金斯长度必须由至少 $N_J$ 个网格单元解析，以避免人为碎裂；我们采用典型选择 $N_J = 4$。从等温自引力介质的线性稳定性色散关系出发，推导临界金斯波长，并用它来求得金斯长度保持被解析时的最大质量密度 $\\rho_{\\max}$，此时不需要次网格恒星形成和恒星初始质量函数 (IMF) 方案。然后，数值计算 $\\rho_{\\max}$。\n\n使用以下常数和换算关系：引力常数 $G = 6.67430 \\times 10^{-8}\\,\\mathrm{cm^3\\,g^{-1}\\,s^{-2}}$，$1\\,\\mathrm{pc} = 3.085677581 \\times 10^{18}\\,\\mathrm{cm}$，以及 $1\\,\\mathrm{km\\,s^{-1}} = 10^{5}\\,\\mathrm{cm\\,s^{-1}}$。请将您对 $\\rho_{\\max}$ 的最终答案以 $\\mathrm{g\\,cm^{-3}}$ 为单位表示，并四舍五入到三位有效数字。", "solution": "这个问题是有效的，因为它在科学上基于引力不稳定性和计算天体物理学的原理，问题陈述清晰，目标明确，并为唯一解提供了所有必要信息。\n\n我们首先推导自引力等温流体的色散关系。控制方程包括连续性方程、带引力项的欧拉方程以及引力势 $\\Phi$ 的泊松方程。\n\n连续性方程为：\n$$\n\\frac{\\partial \\rho}{\\partial t} + \\nabla \\cdot (\\rho \\mathbf{v}) = 0\n$$\n\n欧拉方程为：\n$$\n\\frac{\\partial \\mathbf{v}}{\\partial t} + (\\mathbf{v} \\cdot \\nabla)\\mathbf{v} = -\\frac{\\nabla P}{\\rho} - \\nabla \\Phi\n$$\n\n泊松方程为：\n$$\n\\nabla^2 \\Phi = 4\\pi G \\rho\n$$\n\n对于等温气体，压力 $P$ 与密度 $\\rho$ 通过状态方程 $P = c_s^2 \\rho$ 相关联，其中 $c_s$ 是恒定的等温声速。\n\n我们考虑围绕静态、均匀背景态（$\\rho_0$, $\\mathbf{v}_0 = \\mathbf{0}$, $\\Phi_0$）的小扰动。变量扰动如下：\n$$\n\\rho(\\mathbf{r}, t) = \\rho_0 + \\rho_1(\\mathbf{r}, t)\n$$\n$$\n\\mathbf{v}(\\mathbf{r}, t) = \\mathbf{0} + \\mathbf{v}_1(\\mathbf{r}, t)\n$$\n$$\n\\Phi(\\mathbf{r}, t) = \\Phi_0 + \\Phi_1(\\mathbf{r}, t)\n$$\n$$\nP(\\mathbf{r}, t) = P_0 + P_1 = c_s^2 \\rho_0 + c_s^2 \\rho_1\n$$\n这里，$\\rho_1$、$\\mathbf{v}_1$ 和 $\\Phi_1$ 都是小量。将这些代入控制方程并只保留一阶项进行线性化，我们得到：\n\n线性化的连续性方程：\n$$\n\\frac{\\partial \\rho_1}{\\partial t} + \\rho_0 (\\nabla \\cdot \\mathbf{v}_1) = 0\n$$\n\n线性化的欧拉方程：\n$$\n\\frac{\\partial \\mathbf{v}_1}{\\partial t} = -\\frac{c_s^2}{\\rho_0} \\nabla \\rho_1 - \\nabla \\Phi_1\n$$\n\n线性化的泊松方程：\n$$\n\\nabla^2 \\Phi_1 = 4\\pi G \\rho_1\n$$\n\n我们寻找形式为 $X_1(\\mathbf{r}, t) = \\tilde{X}_1 \\exp[i(\\mathbf{k} \\cdot \\mathbf{r} - \\omega t)]$ 的扰动平面波解，其中 $\\tilde{X}_1$ 是常数振幅，$\\mathbf{k}$ 是波矢，$\\omega$ 是角频率。微分算子变为 $\\frac{\\partial}{\\partial t} \\rightarrow -i\\omega$ 和 $\\nabla \\rightarrow i\\mathbf{k}$。\n\n将此应用于线性化方程，得到一组关于振幅的代数方程：\n$$\n-i\\omega \\tilde{\\rho}_1 + \\rho_0 (i\\mathbf{k} \\cdot \\tilde{\\mathbf{v}}_1) = 0 \\implies \\omega \\tilde{\\rho}_1 = \\rho_0 (\\mathbf{k} \\cdot \\tilde{\\mathbf{v}}_1)\n$$\n$$\n-i\\omega \\tilde{\\mathbf{v}}_1 = -\\frac{c_s^2}{\\rho_0} (i\\mathbf{k} \\tilde{\\rho}_1) - (i\\mathbf{k} \\tilde{\\Phi}_1) \\implies \\omega \\tilde{\\mathbf{v}}_1 = \\frac{c_s^2}{\\rho_0} \\mathbf{k} \\tilde{\\rho}_1 + \\mathbf{k} \\tilde{\\Phi}_1\n$$\n$$\n(i\\mathbf{k})^2 \\tilde{\\Phi}_1 = 4\\pi G \\tilde{\\rho}_1 \\implies -k^2 \\tilde{\\Phi}_1 = 4\\pi G \\tilde{\\rho}_1 \\implies \\tilde{\\Phi}_1 = -\\frac{4\\pi G}{k^2} \\tilde{\\rho}_1\n$$\n其中 $k = |\\mathbf{k}|$。\n\n现在，我们组合这些方程。对第二个方程与 $\\mathbf{k}$ 做点积：\n$$\n\\omega (\\mathbf{k} \\cdot \\tilde{\\mathbf{v}}_1) = \\frac{c_s^2}{\\rho_0} k^2 \\tilde{\\rho}_1 + k^2 \\tilde{\\Phi}_1\n$$\n从第一个方程代入 $\\mathbf{k} \\cdot \\tilde{\\mathbf{v}}_1$：\n$$\n\\omega \\left(\\frac{\\omega}{\\rho_0} \\tilde{\\rho}_1\\right) = \\frac{c_s^2}{\\rho_0} k^2 \\tilde{\\rho}_1 + k^2 \\tilde{\\Phi}_1\n$$\n$$\n\\frac{\\omega^2}{\\rho_0} \\tilde{\\rho}_1 = \\frac{c_s^2}{\\rho_0} k^2 \\tilde{\\rho}_1 + k^2 \\tilde{\\Phi}_1\n$$\n乘以 $\\rho_0$ 并代入 $\\tilde{\\Phi}_1$ 的表达式：\n$$\n\\omega^2 \\tilde{\\rho}_1 = c_s^2 k^2 \\tilde{\\rho}_1 + k^2 \\rho_0 \\left(-\\frac{4\\pi G}{k^2} \\tilde{\\rho}_1\\right)\n$$\n假设存在非平庸解（$\\tilde{\\rho}_1 \\neq 0$），我们可以除以 $\\tilde{\\rho}_1$ 得到色散关系：\n$$\n\\omega^2 = c_s^2 k^2 - 4\\pi G \\rho_0\n$$\n当扰动呈指数增长时，会发生引力不稳定性，这对应于虚频率 $\\omega$。当 $\\omega^2  0$ 时发生这种情况。当 $c_s^2 k^2 > 4\\pi G \\rho_0$ 时系统是稳定的（压力占主导），而当 $c_s^2 k^2  4\\pi G \\rho_0$ 时系统是不稳定的（引力占主导）。\n\n分隔稳定与不稳定的临界波数是金斯波数 $k_J$，通过设 $\\omega^2 = 0$ 求得：\n$$\nc_s^2 k_J^2 - 4\\pi G \\rho_0 = 0 \\implies k_J = \\frac{\\sqrt{4\\pi G \\rho_0}}{c_s}\n$$\n相应的金斯波长 $\\lambda_J$ 是：\n$$\n\\lambda_J = \\frac{2\\pi}{k_J} = 2\\pi \\frac{c_s}{\\sqrt{4\\pi G \\rho_0}} = \\sqrt{\\frac{4\\pi^2 c_s^2}{4\\pi G \\rho_0}} = \\sqrt{\\frac{\\pi c_s^2}{G \\rho_0}}\n$$\n这就是推导出的临界金斯波长。\n\nTruelove 解析判据要求这个长度尺度至少由 $N_J$ 个大小为 $\\Delta x$ 的网格单元解析。定义坍缩在数值上变得无法解析之前的最大密度 $\\rho_{\\max}$ 的数值稳定性临界情况由以下等式给出：\n$$\n\\lambda_J = N_J \\Delta x\n$$\n将我们的 $\\lambda_J$ 表达式代入，并设 $\\rho_0 = \\rho_{\\max}$：\n$$\n\\sqrt{\\frac{\\pi c_s^2}{G \\rho_{\\max}}} = N_J \\Delta x\n$$\n求解 $\\rho_{\\max}$：\n$$\n\\frac{\\pi c_s^2}{G \\rho_{\\max}} = (N_J \\Delta x)^2\n$$\n$$\n\\rho_{\\max} = \\frac{\\pi c_s^2}{G (N_J \\Delta x)^2}\n$$\n现在我们数值计算这个表达式。首先，我们将给定值转换为 cgs 单位：\n- $c_s = 1\\,\\mathrm{km\\,s^{-1}} = 10^5\\,\\mathrm{cm\\,s^{-1}}$\n- $\\Delta x = 100\\,\\mathrm{pc} = 100 \\times (3.085677581 \\times 10^{18}\\,\\mathrm{cm}) = 3.085677581 \\times 10^{20}\\,\\mathrm{cm}$\n- $N_J = 4$\n- $G = 6.67430 \\times 10^{-8}\\,\\mathrm{cm^3\\,g^{-1}\\,s^{-2}}$\n\n将这些值代入 $\\rho_{\\max}$ 的方程：\n$$\n\\rho_{\\max} = \\frac{\\pi (10^5\\,\\mathrm{cm\\,s^{-1}})^2}{(6.67430 \\times 10^{-8}\\,\\mathrm{cm^3\\,g^{-1}\\,s^{-2}}) (4 \\times 3.085677581 \\times 10^{20}\\,\\mathrm{cm})^2}\n$$\n$$\n\\rho_{\\max} = \\frac{\\pi \\times 10^{10}}{(6.67430 \\times 10^{-8}) (1.2342710324 \\times 10^{21})^2}\\,\\mathrm{g\\,cm^{-3}}\n$$\n$$\n\\rho_{\\max} = \\frac{\\pi \\times 10^{10}}{(6.67430 \\times 10^{-8}) (1.523420 \\times 10^{42})}\\,\\mathrm{g\\,cm^{-3}}\n$$\n$$\n\\rho_{\\max} = \\frac{3.14159265 \\times 10^{10}}{1.017583 \\times 10^{35}}\\,\\mathrm{g\\,cm^{-3}}\n$$\n$$\n\\rho_{\\max} \\approx 3.08731 \\times 10^{-25}\\,\\mathrm{g\\,cm^{-3}}\n$$\n四舍五入到三位有效数字，最大质量密度为 $3.09 \\times 10^{-25}\\,\\mathrm{g\\,cm^{-3}}$。", "answer": "$$\n\\boxed{3.09 \\times 10^{-25}}\n$$", "id": "3491800"}, {"introduction": "一旦确定需要次网格模型，我们如何量化恒星的形成速率？在星系盘这样的旋转系统中，恒星形成并非简单地在所有稠密气体中开启。气体的热压力和旋转提供的离心支持共同抵抗引力坍缩。著名的图姆拉 $Q$ 参数（Toomre $Q$ parameter）优雅地将这些物理过程统一为一个无量綱数，用以衡量星盘的局部引力稳定性。本练习 [@problem_id:3491780] 将让你推导 $Q$ 参数，并将其应用于一个先进的次网格方案，即当 $Q > 1$ 时，恒星形成效率会受到抑制。这让你能亲身体验现代宇宙学模拟如何基于物理原则来精细调控恒星的诞生。", "problem": "在一个旋转的、薄的、等温气体盘中，波数为 $k$ 的轴对称扰动遵循局域 Wentzel–Kramers–Brillouin (WKB) 色散关系\n$$\\omega^{2}(k) \\;=\\; \\kappa^{2} \\;-\\; 2\\pi G \\Sigma |k| \\;+\\; c_{s}^{2} k^{2},$$\n其中 $\\kappa$ 是本轮频率，$\\Sigma$ 是气体表面密度，$c_{s}$ 是等温声速，$G$ 是引力常数。Toomre 稳定参数 $Q$ 由以下条件定义：在临界稳定时，$\\omega^{2}(k)$ 对 $k$ 的最小值非负。考虑一个银盘区域，其气体表面密度 $\\Sigma = 20\\,M_{\\odot}\\,\\mathrm{pc^{-2}}$，声速 $c_{s} = 10\\,\\mathrm{km\\,s^{-1}}$，本轮频率 $\\kappa = 50\\,\\mathrm{km\\,s^{-1}\\,kpc^{-1}}$。假设 $G = 4.302\\times 10^{-6}\\,\\mathrm{kpc}\\,(\\mathrm{km}\\,\\mathrm{s}^{-1})^{2}\\,M_{\\odot}^{-1}$。请从色散关系中推导出 $Q$ 的表达式，并根据给定参数计算其值。\n\n一个宇宙学模拟采用了一个次网格恒星形成方案，在该方案中，每个自由下落时间内的恒星形成效率乘以一个基于稳定性的抑制因子 $s(Q)$，同时假设一个普适的恒星初始质量函数 (IMF)。该抑制因子为\n$$s(Q) \\;=\\; \\begin{cases}\n1,  Q \\le 1,\\\\\n\\exp\\!\\big[-\\alpha\\,(Q-1)\\big],  Q > 1,\n\\end{cases}$$\n其中 $\\alpha = 2$。使用你计算出的 $Q$ 值，计算相应的抑制因子 $s(Q)$。将你的最终答案四舍五入到三位有效数字。将最终答案表示为一个无单位的纯数。", "solution": "用户提供了一个包含多个部分的问题，需要：\n1.  从给定的气体盘色散关系中推导 Toomre 稳定参数 $Q$ 的表达式。\n2.  对一组特定的物理参数计算 $Q$ 的值。\n3.  使用计算出的 $Q$ 值来计算恒星形成抑制因子 $s(Q)$。\n\n首先，需要对问题陈述进行验证。\n\n### 问题验证\n\n**步骤 1：提取给定信息**\n-   色散关系: $\\omega^{2}(k) = \\kappa^{2} - 2\\pi G \\Sigma |k| + c_{s}^{2} k^{2}$\n-   气体表面密度: $\\Sigma = 20\\,M_{\\odot}\\,\\mathrm{pc^{-2}}$\n-   等温声速: $c_{s} = 10\\,\\mathrm{km\\,s^{-1}}$\n-   本轮频率: $\\kappa = 50\\,\\mathrm{km\\,s^{-1}\\,kpc^{-1}}$\n-   引力常数: $G = 4.302\\times 10^{-6}\\,\\mathrm{kpc}\\,(\\mathrm{km}\\,\\mathrm{s}^{-1})^{2}\\,M_{\\odot}^{-1}$\n-   $Q$ 的定义: $\\omega^{2}(k)$ 对 $k$ 的最小值在临界稳定时为非负。\n-   抑制因子: $s(Q) = \\begin{cases} 1,  Q \\le 1, \\\\ \\exp[-\\alpha(Q-1)],  Q > 1, \\end{cases}$\n-   抑制因子参数: $\\alpha = 2$\n-   四舍五入要求: $s(Q)$ 的最终答案必须四舍五入到三位有效数字。\n\n**步骤 2：使用提取的信息进行验证**\n-   **科学依据**：该问题基于成熟的 Toomre 稳定性分析，该分析适用于薄的、等温的、旋转的气体盘，是星系动力学和恒星形成理论的基石。色散关系是标准的。用于恒星形成抑制的次网格方案是数值宇宙学中常用且有物理动机的处方。该问题在科学上是合理的。\n-   **适定性与一致性**：该问题是适定的。$Q$ 的推导是一个标准过程，其后在另一个公式中的使用也很直接。所提供的物理参数和常数在星系盘环境的实际范围内。但是，单位必须统一。我们采用一个一致的单位制：距离使用千秒差距 (kpc)，质量使用太阳质量 ($M_{\\odot}$)，速度使用千米每秒 (km s$^{-1}$)。\n    -   $c_{s} = 10\\,\\mathrm{km\\,s^{-1}}$ (一致)\n    -   $\\kappa = 50\\,\\mathrm{km\\,s^{-1}\\,kpc^{-1}}$ (一致)\n    -   $G = 4.302\\times 10^{-6}\\,\\mathrm{kpc}\\,(\\mathrm{km}\\,\\mathrm{s}^{-1})^{2}\\,M_{\\odot}^{-1}$ (一致)\n    -   表面密度 $\\Sigma$ 以 $M_{\\odot}\\,\\mathrm{pc^{-2}}$ 为单位给出，必须进行转换。由于 $1\\,\\mathrm{kpc} = 1000\\,\\mathrm{pc}$，因此 $1\\,\\mathrm{pc} = 10^{-3}\\,\\mathrm{kpc}$，且 $1\\,\\mathrm{pc}^{2} = (10^{-3})^{2}\\,\\mathrm{kpc}^{2} = 10^{-6}\\,\\mathrm{kpc}^{2}$。因此，$1\\,\\mathrm{pc}^{-2} = 10^{6}\\,\\mathrm{kpc}^{-2}$。\n    -   $\\Sigma = 20\\,M_{\\odot}\\,\\mathrm{pc^{-2}} = 20 \\times 10^{6}\\,M_{\\odot}\\,\\mathrm{kpc^{-2}}$。\n    -   单位转换后，问题是自洽的，并包含所有必要信息。\n\n**步骤 3：结论与行动**\n问题有效。我们开始求解。\n\n### Toomre Q 的推导与计算\n\n轴对称扰动的色散关系如下：\n$$\\omega^{2}(k) = \\kappa^{2} - 2\\pi G \\Sigma |k| + c_{s}^{2} k^{2}$$\n由于波数 $k$ 是一个非负量，我们有 $|k| = k$。该表达式是关于 $k$ 的二次方程：\n$$\\omega^{2}(k) = c_{s}^{2} k^{2} - (2\\pi G \\Sigma) k + \\kappa^{2}$$\n如果对所有 $k$ 都有 $\\omega^{2}(k) > 0$，则盘是稳定的。如果存在一个 $k$ 的范围使得 $\\omega^{2}(k)  0$，则盘是不稳定的。转变发生在临界稳定状态，此时 $\\omega^{2}(k)$ 的最小值为零。\n\n为了找到 $\\omega^{2}(k)$ 的最小值，我们对 $k$ 求导并令其等于零：\n$$\\frac{d\\omega^{2}}{dk} = 2c_{s}^{2}k - 2\\pi G \\Sigma = 0$$\n这得到了最不稳定的波数 $k_{\\mathrm{min}}$：\n$$k_{\\mathrm{min}} = \\frac{2\\pi G \\Sigma}{2c_{s}^{2}} = \\frac{\\pi G \\Sigma}{c_{s}^{2}}$$\n将 $k_{\\mathrm{min}}$ 代回色散关系，得到 $\\omega^{2}$ 的最小值：\n$$\\omega^{2}_{\\mathrm{min}} = c_{s}^{2}\\left(\\frac{\\pi G \\Sigma}{c_{s}^{2}}\\right)^{2} - 2\\pi G \\Sigma \\left(\\frac{\\pi G \\Sigma}{c_{s}^{2}}\\right) + \\kappa^{2}$$\n$$\\omega^{2}_{\\mathrm{min}} = \\frac{\\pi^{2} G^{2} \\Sigma^{2}}{c_{s}^{2}} - \\frac{2\\pi^{2} G^{2} \\Sigma^{2}}{c_{s}^{2}} + \\kappa^{2}$$\n$$\\omega^{2}_{\\mathrm{min}} = \\kappa^{2} - \\frac{\\pi^{2} G^{2} \\Sigma^{2}}{c_{s}^{2}}$$\n稳定条件是 $\\omega^{2}_{\\mathrm{min}} > 0$。Toomre 参数 $Q$ 通常定义为当 $Q > 1$ 时盘是稳定的。\n稳定条件 $\\kappa^{2} - \\frac{\\pi^{2} G^{2} \\Sigma^{2}}{c_{s}^{2}} > 0$ 可以改写为：\n$$\\kappa^{2} > \\frac{\\pi^{2} G^{2} \\Sigma^{2}}{c_{s}^{2}} \\implies \\kappa > \\frac{\\pi G \\Sigma}{c_{s}}$$\n$$\\frac{\\kappa c_{s}}{\\pi G \\Sigma} > 1$$\n这确定了无量纲的 Toomre 参数 $Q$ 为：\n$$Q = \\frac{\\kappa c_{s}}{\\pi G \\Sigma}$$\n现在，我们使用给定的参数和转换后的 $\\Sigma$ 值来计算 $Q$。\n-   $\\kappa = 50\\,\\mathrm{km\\,s^{-1}\\,kpc^{-1}}$\n-   $c_{s} = 10\\,\\mathrm{km\\,s^{-1}}$\n-   $G = 4.302\\times 10^{-6}\\,\\mathrm{kpc}\\,(\\mathrm{km}\\,\\mathrm{s}^{-1})^{2}\\,M_{\\odot}^{-1}$\n-   $\\Sigma = 20 \\times 10^{6}\\,M_{\\odot}\\,\\mathrm{kpc^{-2}}$\n\n将这些值代入 $Q$ 的表达式中：\n$$Q = \\frac{(50\\,\\mathrm{km\\,s^{-1}\\,kpc^{-1}}) (10\\,\\mathrm{km\\,s^{-1}})}{\\pi (4.302\\times 10^{-6}\\,\\mathrm{kpc}\\,(\\mathrm{km}\\,\\mathrm{s}^{-1})^{2}\\,M_{\\odot}^{-1}) (20 \\times 10^{6}\\,M_{\\odot}\\,\\mathrm{kpc^{-2}})}$$\n$$Q = \\frac{500}{\\pi (4.302\\times 10^{-6}) (20 \\times 10^{6})} = \\frac{500}{\\pi (4.302 \\times 20)} = \\frac{500}{86.04\\pi}$$\n$$Q \\approx \\frac{500}{270.299...} \\approx 1.849839...$$\n该盘块的 Toomre 参数约为 $1.85$。\n\n### 抑制因子 s(Q) 的计算\n\n恒星形成抑制因子 $s(Q)$ 由下式给出：\n$$s(Q) = \\begin{cases} 1,  Q \\le 1,\\\\ \\exp[-\\alpha(Q-1)],  Q > 1, \\end{cases}$$\n其中 $\\alpha = 2$。\n\n由于我们计算出的值是 $Q \\approx 1.849839...$，大于 1，我们使用第二种情况：\n$$s(Q) = \\exp[-\\alpha(Q-1)]$$\n代入 $\\alpha=2$ 和 $Q$ 的值：\n$$s(Q) = \\exp[-2(1.849839... - 1)]$$\n$$s(Q) = \\exp[-2(0.849839...)]$$\n$$s(Q) = \\exp[-1.699678...]$$\n$$s(Q) \\approx 0.182740...$$\n问题要求将最终答案四舍五入到三位有效数字。\n$$s(Q) \\approx 0.183$$\n这是抑制因子的最终数值。", "answer": "$$\\boxed{0.183}$$", "id": "3491780"}, {"introduction": "在模拟中，当一个气体单元满足恒星形成的条件后，它会转化为一个“恒星粒子”。这个粒子并非代表一颗单独的恒星，而是代表一个包含成千上万颗恒星的星族，其成员的质量分布遵循恒星初始质量函数（Initial Mass Function, IMF）。IMF 是连接次网格配方与可观测宇宙的关键桥梁，因为它决定了星族的总光度、颜色以及反馈（如超新星爆炸）的强度。本练习 [@problem_id:3491802] 聚焦于一个实际的分段幂率 IMF，要求你计算对星系演化至关重要的大质量恒星（例如，质量大于 $8 M_{\\odot}$）所占的质量比例，这是处理和诠释模拟结果的一项核心技能。", "problem": "在一个采用次网格恒星形成配方的宇宙学流体动力学模拟中，每个生成的恒星粒子都被假定为一个具有折断幂律初始质量函数（IMF）的单一星族。初始质量函数（IMF）定义为每单位质量的恒星数量，$dN/dm \\equiv \\xi(m)$，并且在此模型中，它被视为一种在折断质量处连续的Kroupa型折断幂律。具体来说，采用\n$$\\xi(m) = \\begin{cases}\nk_{1}\\, m^{-\\alpha_{1}},  0.1 \\leq m/M_{\\odot}  0.5, \\\\\nk_{2}\\, m^{-\\alpha_{2}},  0.5 \\leq m/M_{\\odot} \\leq 100,\n\\end{cases}$$\n其中斜率为 $\\alpha_{1}=1.3$ 和 $\\alpha_{2}=2.3$，$M_{\\odot}$ 表示一个太阳质量。在折断质量 $m_{b}=0.5\\,M_{\\odot}$ 处施加连续性条件，即要求 $\\xi(m)$ 在 $m_{b}$ 处是连续的。\n\n根据形成的总恒星质量是IMF的一阶矩（即 $M_{\\mathrm{tot}}=\\int m\\,\\xi(m)\\,dm$）以及质量大于阈值 $m_{\\mathrm{thr}}$ 的恒星质量为 $M_{m_{\\mathrm{thr}}}=\\int_{m_{\\mathrm{thr}}}^{m_{\\max}} m\\,\\xi(m)\\,dm$ 的基本定义，对于上述指定的IMF，从第一性原理推导出质量大于 $m_{\\mathrm{thr}}=8\\,M_{\\odot}$ 的恒星所占的质量分数，取 $m_{\\min}=0.1\\,M_{\\odot}$ 和 $m_{\\max}=100\\,M_{\\odot}$。\n\n将最终结果表示为小数，并四舍五入到四位有效数字。", "solution": "该问题要求推导质量大于阈值 $m_{\\mathrm{thr}}=8\\,M_{\\odot}$ 的恒星所占总恒星质量的分数。这个分数，我们记为 $F$，由大质量恒星的质量 $M_{m_{\\mathrm{thr}}}$ 与总恒星质量 $M_{\\mathrm{tot}}$ 的比值给出：\n$$F = \\frac{M_{m_{\\mathrm{thr}}}}{M_{\\mathrm{tot}}}$$\n这些质量分量的定义是作为初始质量函数（IMF）$\\xi(m)$ 的矩给出的。IMF，$\\xi(m) = dN/dm$，表示每单位质量区间内形成的恒星数量。\n\n给定的IMF是一个折断幂律：\n$$\\xi(m) = \\begin{cases}\nk_{1}\\, m^{-\\alpha_{1}},  m_{\\min} \\leq m  m_{b}, \\\\\nk_{2}\\, m^{-\\alpha_{2}},  m_{b} \\leq m \\leq m_{\\max},\n\\end{cases}$$\n参数如下：\n- 斜率：$\\alpha_{1}=1.3$ 和 $\\alpha_{2}=2.3$。\n- 质量范围：最小质量 $m_{\\min}=0.1\\,M_{\\odot}$ 和最大质量 $m_{\\max}=100\\,M_{\\odot}$。\n- 折断质量：$m_{b}=0.5\\,M_{\\odot}$。\n- 阈值质量：$m_{\\mathrm{thr}}=8\\,M_{\\odot}$。\n常数 $k_1$ 和 $k_2$ 是归一化因子。\n\n首先，我们在折断质量 $m_{b}$ 处施加IMF $\\xi(m)$ 连续的条件。\n$$k_{1}\\, m_{b}^{-\\alpha_{1}} = k_{2}\\, m_{b}^{-\\alpha_{2}}$$\n这使我们能够用一个归一化常数表示另一个：\n$$\\frac{k_1}{k_2} = \\frac{m_{b}^{-\\alpha_{2}}}{m_{b}^{-\\alpha_{1}}} = m_{b}^{\\alpha_{1} - \\alpha_{2}}$$\n代入给定值 $\\alpha_{1}=1.3$，$\\alpha_{2}=2.3$ 和 $m_{b}=0.5\\,M_{\\odot}$：\n$$\\frac{k_1}{k_2} = (0.5\\,M_{\\odot})^{1.3 - 2.3} = (0.5\\,M_{\\odot})^{-1.0}$$\n为了简化计算，我们可以使用无量纲质量变量 $m' = m/M_{\\odot}$。那么常数之比是一个纯数：\n$$\\frac{k_1}{k_2} = (0.5)^{-1} = 2 \\implies k_1 = 2k_2$$\n\n接下来，我们计算总恒星质量 $M_{\\mathrm{tot}}$，即IMF在整个质量范围内积分的一阶矩。积分必须在折断质量 $m_b$ 处分开。\n$$M_{\\mathrm{tot}} = \\int_{m_{\\min}}^{m_{\\max}} m\\,\\xi(m)\\,dm = \\int_{m_{\\min}}^{m_{b}} m(k_1 m^{-\\alpha_1})dm + \\int_{m_{b}}^{m_{\\max}} m(k_2 m^{-\\alpha_2})dm$$\n$$M_{\\mathrm{tot}} = k_1 \\int_{m_{\\min}}^{m_{b}} m^{1-\\alpha_1}dm + k_2 \\int_{m_{b}}^{m_{\\max}} m^{1-\\alpha_2}dm$$\n代入斜率值 $\\alpha_1=1.3$ 和 $\\alpha_2=2.3$：\n$$M_{\\mathrm{tot}} = k_1 \\int_{m_{\\min}}^{m_{b}} m^{-0.3}dm + k_2 \\int_{m_{b}}^{m_{\\max}} m^{-1.3}dm$$\n计算积分：\n$$M_{\\mathrm{tot}} = k_1 \\left[\\frac{m^{0.7}}{0.7}\\right]_{m_{\\min}}^{m_{b}} + k_2 \\left[\\frac{m^{-0.3}}{-0.3}\\right]_{m_{b}}^{m_{\\max}}$$\n代入 $k_1=2k_2$ 和质量上下限（$m_{\\min}=0.1\\,M_{\\odot}$，$m_b=0.5\\,M_{\\odot}$，$m_{\\max}=100\\,M_{\\odot}$）：\n$$M_{\\mathrm{tot}} = 2k_2 \\left(\\frac{(0.5\\,M_{\\odot})^{0.7} - (0.1\\,M_{\\odot})^{0.7}}{0.7}\\right) + k_2 \\left(\\frac{(100\\,M_{\\odot})^{-0.3} - (0.5\\,M_{\\odot})^{-0.3}}{-0.3}\\right)$$\n我们可以提出因子 $k_2$ 和单位 $M_{\\odot}$：\n$$M_{\\mathrm{tot}} = k_2 M_{\\odot} \\left[ \\frac{2}{0.7} (0.5^{0.7} - 0.1^{0.7}) + \\frac{1}{0.3} (0.5^{-0.3} - 100^{-0.3}) \\right]$$\n\n现在，我们计算质量大于阈值 $m_{\\mathrm{thr}}=8\\,M_{\\odot}$ 的恒星的质量。由于 $m_{\\mathrm{thr}} > m_b$，该积分只涉及IMF的第二部分。\n$$M_{m_{\\mathrm{thr}}} = \\int_{m_{\\mathrm{thr}}}^{m_{\\max}} m\\,\\xi(m)\\,dm = \\int_{m_{\\mathrm{thr}}}^{m_{\\max}} m(k_2 m^{-\\alpha_2})dm$$\n$$M_{m_{\\mathrm{thr}}} = k_2 \\int_{m_{\\mathrm{thr}}}^{m_{\\max}} m^{1-\\alpha_2}dm = k_2 \\int_{8 M_{\\odot}}^{100 M_{\\odot}} m^{-1.3}dm$$\n计算积分：\n$$M_{m_{\\mathrm{thr}}} = k_2 \\left[\\frac{m^{-0.3}}{-0.3}\\right]_{8 M_{\\odot}}^{100 M_{\\odot}} = k_2 \\left(\\frac{(100\\,M_{\\odot})^{-0.3} - (8\\,M_{\\odot})^{-0.3}}{-0.3}\\right)$$\n$$M_{m_{\\mathrm{thr}}} = k_2 M_{\\odot} \\left[ \\frac{1}{0.3} (8^{-0.3} - 100^{-0.3}) \\right]$$\n\n最后，我们计算分数 $F$。归一化常数 $k_2$ 和单位 $M_{\\odot}$ 会消去，这对于一个无量纲比率是符合预期的。\n$$F = \\frac{M_{m_{\\mathrm{thr}}}}{M_{\\mathrm{tot}}} = \\frac{k_2 M_{\\odot} \\left[ \\frac{1}{0.3} (8^{-0.3} - 100^{-0.3}) \\right]}{k_2 M_{\\odot} \\left[ \\frac{2}{0.7} (0.5^{0.7} - 0.1^{0.7}) + \\frac{1}{0.3} (0.5^{-0.3} - 100^{-0.3}) \\right]}$$\n$$F = \\frac{\\frac{1}{0.3} (8^{-0.3} - 100^{-0.3})}{ \\frac{2}{0.7} (0.5^{0.7} - 0.1^{0.7}) + \\frac{1}{0.3} (0.5^{-0.3} - 100^{-0.3}) }$$\n我们现在代入幂的数值：\n$8^{-0.3} \\approx 0.535887$\n$100^{-0.3} \\approx 0.251189$\n$0.5^{0.7} \\approx 0.615572$\n$0.1^{0.7} \\approx 0.199526$\n$0.5^{-0.3} \\approx 1.231144$\n\n分子：\n$$ \\text{Num} = \\frac{1}{0.3} (0.535887 - 0.251189) = \\frac{0.284698}{0.3} \\approx 0.948993 $$\n分母：\n$$ \\text{Term 1} = \\frac{2}{0.7} (0.615572 - 0.199526) = \\frac{2}{0.7} (0.416046) \\approx 1.188703 $$\n$$ \\text{Term 2} = \\frac{1}{0.3} (1.231144 - 0.251189) = \\frac{0.979955}{0.3} \\approx 3.266517 $$\n$$ \\text{Den} = 1.188703 + 3.266517 = 4.455220 $$\n分数为：\n$$ F = \\frac{0.948993}{4.455220} \\approx 0.212987$$\n将结果四舍五入到四位有效数字，得到 $0.2130$。", "answer": "$$\\boxed{0.2130}$$", "id": "3491802"}]}