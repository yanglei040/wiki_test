## 引言
在[现代宇宙学](@entry_id:752086)中，引力透镜已成为探索宇宙最强大、最精确的工具之一。来自遥远星系的光线在穿越宇宙时，其路径会被沿途的物质[分布](@entry_id:182848)（主要是暗物质）所弯曲，导致我们观测到的星系图像产生微小的扭曲（剪切）和放大。通过精确测量这些效应，我们可以绘制出不可见的[暗物质分布](@entry_id:161341)图，[检验引力理论](@entry_id:162018)，并对暗能量的性质和宇宙的演化历史施加严格的约束。然而，要充分挖掘即将到来的大规模巡天（如LSST、Euclid）所带来的海量数据，我们必须拥有能够精确预测这些透镜信号的理论工具。

这正是通过[N体模拟](@entry_id:157492)进行[引力透镜](@entry_id:159000)射线追踪发挥核心作用的地方。[N体模拟](@entry_id:157492)是当前我们理解宇宙[大尺度结构](@entry_id:158990)形成的最佳理论模型，它能以极高的保真度追踪暗物质在[引力](@entry_id:175476)作用下的演化。然而，模拟直接输出的是三维空间中的[粒子分布](@entry_id:158657)，这与天文学家在二维[天球](@entry_id:158268)上观测到的透镜效应之间存在一道鸿沟。本篇文章旨在系统性地架起这座桥梁，详细阐述如何将[N体模拟](@entry_id:157492)的输出转化为精确的、可与观测直接对比的[引力透镜](@entry_id:159000)预测。

为实现这一目标，本文将分为三个核心部分：

*   在**“原理与机制”**一章中，我们将深入探讨引力透镜的物理基础和数学形式，并详细介绍将这些原理付诸实践的多平面射线追踪算法。我们还将[系统分析](@entry_id:263805)在这一复杂数值过程中可能出现的各种近似和系统效应。
*   在**“应用与交叉学科联系”**一章中，我们将展示这一强大工具的广泛应用，从验证数值代码的可靠性，到探测暗物质晕的精细结构，再到其作为大尺度[宇宙学探针](@entry_id:160927)的核心作用，并探讨其与其他天体物理领域的协同效应。
*   最后，在**“动手实践”**部分，我们将通过一系列具体的编程练习，引导读者亲手实现射线追踪的关键步骤，将理论知识转化为实践技能。

通过本篇文章的学习，读者将能够全面理解从理论物理到数值实现，再到科学应用的完整引力透镜模拟流程，为投身于[数值宇宙学](@entry_id:752779)的前沿研究奠定坚实的基础。

## 原理与机制

在理解了通过[N体模拟](@entry_id:157492)进行引力透镜射线追踪的重要性之后，本章将深入探讨其核心的物理原理、数学形式和[数值算法](@entry_id:752770)。我们将从建立[引力透镜效应](@entry_id:159000)所依赖的宇宙学几何框架开始，然后详细描述将三维物质[分布](@entry_id:182848)转化为可观测透镜信号的关键物理量。随后，我们将阐述将这些原理付诸实践的多平面射线追踪算法，并对比其不同层次的近似。最后，我们将系统地分析在这一复杂数值过程中出现的各种近似、误差和系统效应，为精确的宇宙学分析奠定坚实的基础。

### 透镜效应的几何与物理基础

[引力透镜效应](@entry_id:159000)的精确描述始于对光线在膨胀宇宙中传播路径的几何理解，以及这些光线如何被沿途的物质[分布](@entry_id:182848)所扭曲。

#### 平直宇宙中的[宇宙学距离](@entry_id:160000)

在[现代宇宙学](@entry_id:752086)标准模型（$\Lambda$CDM）所青睐的空间平直的弗里德曼-勒梅特-罗伯逊-沃尔克（FLRW）宇宙中，距离的定义对于计算透镜效应至关重要。光线沿着径向[零测地线](@entry_id:158803)传播，其路径由几个关键的距离尺度来描述。

首先是**[共动距离](@entry_id:158059) (comoving distance)**，用 $\chi$ 表示。它是在宇宙膨胀的[坐标系](@entry_id:156346)中测量的距离，不受[宇宙膨胀](@entry_id:161474)的影响。对于从红移 $z=0$ （观测者处）到[红移](@entry_id:159945) $z$ 的一个天体，其[共动距离](@entry_id:158059)是通过对哈勃参数 $H(z')$ 的倒数积分得到的：

$$
\chi(z) = c \int_{0}^{z} \frac{\mathrm{d}z'}{H(z')}
$$

其中 $c$ 是光速。这个量代表了光线从[红移](@entry_id:159945) $z$ 发出到被我们接收所走过的总“共动长度”。

其次是**[角直径距离](@entry_id:157817) (angular diameter distance)**，用 $D_A(z)$ 表示。它将天体的物理尺寸与其在天空中张开的角度联系起来。在空间平直的宇宙中，[角直径距离](@entry_id:157817)与[共动距离](@entry_id:158059)之间有一个简单的关系：

$$
D_A(z) = \frac{\chi(z)}{1+z}
$$

因子 $(1+z)^{-1}$ 说明了当光从遥远天体发出时宇宙尺度较小，导致天体在天空中的张角比我们根据其当前[共动距离](@entry_id:158059)所预期的要大。

基于这些距离定义，我们可以构建一个纯粹的几何因子，它量化了位于特定距离的物质偏折光线的效率。对于一个位于[共动距离](@entry_id:158059) $\chi_s$ 的源，以及一个位于[共动距离](@entry_id:158059) $\chi$ 的透镜，**透镜效率 (lensing efficiency)** 由观测者到透镜、透镜到源以及观测者到源之间的[角直径距离](@entry_id:157817)组合决定。在多平面算法和弱透镜积分中，这个几何权重因子通常用共动[角直径距离](@entry_id:157817)来表达，在平直宇宙中，共动[角直径距离](@entry_id:157817)就等于[共动距离](@entry_id:158059) $\chi$。因此，这个几何因子 $g(\chi)$ 可以写为 [@problem_id:3483348]：

$$
g(\chi) = \frac{\chi (\chi_s - \chi)}{\chi_s}
$$

这个表达式直观地表明，当透镜位于观测者和源的中间位置时，其偏折效率最高；而当透镜靠近观测者 ($\chi \to 0$) 或靠近源 ($\chi \to \chi_s$) 时，效率趋于零。在完整的透镜核中，物质密度过剩 $\delta$ 通常被一个与 $a^{-1}(\chi) g(\chi)$ 成正比的因子加权，其中 $a(\chi)$ 是在[共动距离](@entry_id:158059) $\chi$ 处的宇宙标度因子。$a^{-1}$ 因子的出现源于协变坐标下的泊松方程。

#### 透镜势及其[可观测量](@entry_id:267133)

在弱[引力场](@entry_id:169425)和[薄透镜近似](@entry_id:174906)下，沿特定视线的累积[引力](@entry_id:175476)效应可以用一个二维的**透镜势 (lensing potential)** $\psi(\boldsymbol{\theta})$ 来完全描述，其中 $\boldsymbol{\theta}$ 是天空中的二维[角位置](@entry_id:174053)矢量。所有主要的弱透镜可观测量——汇聚、剪切——都可以从这个势的[二阶导数](@entry_id:144508)中导出 [@problem_id:3483286]。

**汇聚 (convergence)**，用 $\kappa$ 表示，描述了透镜效应引起的像的各向同性放大。它被定义为透镜平面的**表面质量密度 (surface mass density)** $\Sigma(\boldsymbol{\theta})$ 与一个称为**临界[表面密度](@entry_id:161889) (critical surface density)** $\Sigma_{\text{crit}}$ 的比值：

$$
\kappa(\boldsymbol{\theta}) = \frac{\Sigma(\boldsymbol{\theta})}{\Sigma_{\text{crit}}}
$$

临界[表面密度](@entry_id:161889)是一个纯粹的几何量，取决于观测者、透镜和源之间的[角直径距离](@entry_id:157817)（分别用 $D_l$、$D_s$ 和 $D_{ls}$ 表示）：

$$
\Sigma_{\text{crit}} = \frac{c^2}{4\pi G} \frac{D_s}{D_l D_{ls}}
$$

当一个透镜的[表面密度](@entry_id:161889)超过这个临界值时，它就有可能产生多重像，即进入强透镜区域。

**剪切 (shear)**，用复数 $\gamma = \gamma_1 + i\gamma_2$ 表示，描述了像的各向异性拉伸或扭曲，它使一个圆形的源看起来变成椭圆形。

透镜势、汇聚和剪切通过一组优雅的[微分](@entry_id:158718)关系联系在一起。透镜势 $\psi$ 是由汇聚场 $\kappa$ 通过一个二维[泊松方程](@entry_id:143763)决定的：

$$
\nabla_{\boldsymbol{\theta}}^2 \psi(\boldsymbol{\theta}) = 2 \kappa(\boldsymbol{\theta})
$$

其中 $\nabla_{\boldsymbol{\theta}}^2 = \partial_1^2 + \partial_2^2$ 是关于角坐标 $\boldsymbol{\theta}=(\theta_1, \theta_2)$ 的[拉普拉斯算子](@entry_id:146319)。这个方程的解可以通过格林函数（即对数函数）积分得到：
$$
\psi(\boldsymbol{\theta}) = \frac{1}{\pi} \int \mathrm{d}^2\theta' \, \kappa(\boldsymbol{\theta}') \ln|\boldsymbol{\theta}-\boldsymbol{\theta}'|
$$
这个泊松关系是在一系列关键假设下成立的，包括每个质量切片的[薄透镜近似](@entry_id:174906)、小角和局部平坦天空近似，以及广义相对论的[弱场极限](@entry_id:199592)（其中两个标量度规势相等）[@problem_id:3483342]。重要的是，这个关系在每个透镜平面上是局域的，它的成立不依赖于光线在平面之间如何传播的近似（如[玻恩近似](@entry_id:138141)）。

一旦知道了透镜势 $\psi$，汇聚和剪切分量就可以通过其[二阶导数](@entry_id:144508)得到：

$$
\kappa = \frac{1}{2} (\partial_1^2 + \partial_2^2)\psi
$$

$$
\gamma_1 = \frac{1}{2} (\partial_1^2 - \partial_2^2)\psi
$$

$$
\gamma_2 = \partial_1 \partial_2 \psi
$$

这些关系构成了弱透镜分析的数学核心，使得我们可以从理论上的物质[分布](@entry_id:182848)（通过 $\kappa$）预测可观测的图像扭曲（$\gamma_1, \gamma_2$），反之亦然。

### 射线追踪算法：从理论到实践

为了模拟光线穿过由[N体模拟](@entry_id:157492)产生的复杂宇宙网，我们需要将连续的物理过程离散化，并开发出能将理论与模拟数据联系起来的算法。

#### 从连续宇宙到离散平面：多平面算法

直接求解光线在连续密度场中的[测地线方程](@entry_id:264349)在计算上是不可行的。因此，我们采用**多平面算法 (multiple-lens-plane algorithm)**。其核心思想是将观测者和源之间的整个三维空间分割成一系列薄的“切片”，并将每个切片内的所有物质投影到一个二维平面上。光线在这些平面之间自由传播（即走直线），但在穿过每个平面时会受到一个瞬时的角偏折。

考虑一个光线（或光束）从观测者以初始[角位置](@entry_id:174053) $\boldsymbol{\theta}_1$ 发出，依次穿过位于[共动距离](@entry_id:158059) $\chi_i$ 的一系列透镜平面。在每个平面 $i$ 上，光线会受到一个由该[平面透镜](@entry_id:204711)势 $\psi_i$ 决定的偏折角 $\boldsymbol{\alpha}_i(\boldsymbol{\theta}) = \nabla_{\boldsymbol{\theta}}\psi_i(\boldsymbol{\theta})$。

在最精确的实现中，即考虑了**[透镜-透镜耦合](@entry_id:751241) (lens-lens coupling)** 的情况下，光线到达第 $j$ 个平面时的[角位置](@entry_id:174053) $\boldsymbol{\theta}_j$ 是之前所有偏折累积的结果 [@problem_id:3483300]。其递归关系为：

$$
\boldsymbol{\theta}_j = \boldsymbol{\theta}_1 - \sum_{i=1}^{j-1} \frac{D_{ij}}{D_j} \boldsymbol{\alpha}_i(\boldsymbol{\theta}_i)
$$

其中 $D_{ij}$ 是平面 $i$ 和平面 $j$ 之间的[角直径距离](@entry_id:157817)，$D_j$ 是观测者到平面 $j$ 的[角直径距离](@entry_id:157817)。关键在于，第 $i$ 个平面的偏折角 $\boldsymbol{\alpha}_i$ 是在光线实际到达该平面时的位置 $\boldsymbol{\theta}_i$ 处计算的。

同样，描述光束变形的[雅可比矩阵](@entry_id:264467)（或称[放大矩阵](@entry_id:746417)）$\mathbf{A}_j = \partial \boldsymbol{\theta}_j / \partial \boldsymbol{\theta}_1$ 也遵循一个耦合的递归关系：

$$
\mathbf{A}_j = \mathbf{I} - \sum_{i=1}^{j-1} \frac{D_{ij}}{D_j} \mathbf{U}_i(\boldsymbol{\theta}_i) \mathbf{A}_i
$$

其中 $\mathbf{I}$ 是[单位矩阵](@entry_id:156724)，$\mathbf{U}_i = \nabla_{\boldsymbol{\theta}}\nabla_{\boldsymbol{\theta}}\psi_i$ 是第 $i$ 个平面的潮汐矩阵（势的[二阶导数](@entry_id:144508)矩阵）。这里的耦合体现在两方面：[潮汐](@entry_id:194316)场 $\mathbf{U}_i$ 在偏折后的位置 $\boldsymbol{\theta}_i$ 处计算，并且它作用在已经被之前所有平面扭曲过的光束上（由矩阵 $\mathbf{A}_i$ 描述）。

#### [玻恩近似](@entry_id:138141)与完整射线追踪的对比

尽管完整的多平面算法最为精确，但在许多情况下，一个更简单的近似——**[玻恩近似](@entry_id:138141) (Born approximation)**——已经足够精确且计算上更高效。

[玻恩近似](@entry_id:138141)的核心思想是，由于[引力场](@entry_id:169425)很弱，光线的总偏折很小，因此可以忽略光线路径的弯曲，假设光线始终沿着从观测者到源的**未扰动直线路径**传播 [@problem_id:3483329]。在多平面算法的框架下，这意味着在计算所有平面的偏折角 $\boldsymbol{\alpha}_i$ 和潮汐场 $\mathbf{U}_i$ 时，我们都使用初始的、未偏折的[角位置](@entry_id:174053) $\boldsymbol{\theta}_1$ 来进行计算。

此外，在计算雅可比矩阵时，[玻恩近似](@entry_id:138141)还忽略了矩阵乘积中的耦合项（即用 $\mathbf{I}$ 代替 $\mathbf{A}_i$）。因此，递归关系简化为线性的求和：

$$
\boldsymbol{\theta}_j \approx \boldsymbol{\theta}_1 - \sum_{i=1}^{j-1} \frac{D_{ij}}{D_j} \boldsymbol{\alpha}_i(\boldsymbol{\theta}_1)
$$
$$
\mathbf{A}_j \approx \mathbf{I} - \sum_{i=1}^{j-1} \frac{D_{ij}}{D_j} \mathbf{U}_i(\boldsymbol{\theta}_1)
$$

这种方法将总的透镜效应分解为每个平面独立贡献的线性叠加，大大简化了计算。

完整射线追踪和[玻恩近似](@entry_id:138141)之间的差异被称为**后玻恩效应 (post-Born effects)**。这些效应来源于[透镜-透镜耦合](@entry_id:751241)，是势的高阶项。它们虽然微小，但有重要的物理后果。例如，在[玻恩近似](@entry_id:138141)下，由[标量密度](@entry_id:161438)扰动产生的剪切场是纯“E模式”的，偏折场是无旋的。而后玻恩效应可以产生图像的**旋转 (rotation)**，并在剪切场中引入“[B模](@entry_id:161767)式”分量 [@problem_id:3483329]。探测到这种B模式将是[透镜-透镜耦合](@entry_id:751241)的直接证据。

#### 从N体数据构建透镜平面

将多平面算法应用于[N体模拟](@entry_id:157492)的输出，需要一个明确的程序来从三维[粒子分布](@entry_id:158657)构建二维的透镜平面。这是一个连接理论与实践的关键步骤 [@problem_id:3483292]。

1.  **切[片选](@entry_id:173824)择**：首先，根据光锥的几何结构，我们将模拟盒子中的粒子分配到不同的[共动距离](@entry_id:158059)切片中。对于一个位于中心距离 $\chi_i$、厚度为 $\Delta\chi$ 的平面，我们会选取所有 $z$ 坐标（假设沿 $z$ 轴投影）在 $[\chi_i - \Delta\chi/2, \chi_i + \Delta\chi/2]$ 范围内的粒子。

2.  **坐标转换**：对于每个被选中的粒子，其在模拟盒子中的横向[共动坐标](@entry_id:271238) $(x, y)$ 需要被转换成天空中的角坐标 $(\theta_x, \theta_y)$。在小角近似下，这个转换很简单：$\boldsymbol{\theta} = \boldsymbol{x}_{\perp} / \chi_i$，其中 $\chi_i$ 是该透镜平面的[共动距离](@entry_id:158059)。

3.  **[质量分配](@entry_id:751704)**：接下来，我们需要将离散粒子的[质量分配](@entry_id:751704)到一个二维的像素化网格上，以形成连续的[表面密度](@entry_id:161889)场。有多种**[质量分配方案](@entry_id:751705) (mass assignment schemes)**，其中**云在格点 (Cloud-in-Cell, CIC)** 是一种常用的二阶方法。在[CIC方案](@entry_id:747354)中，每个粒子的质量会根据其相对于最近网格点的距离，通过[双线性插值](@entry_id:170280)分配给周围的四个像素点。

4.  **归一化**：当所有相关粒子的质量都被累加到网格上后，我们就得到了每个像素的总质量图 $M_{ij}$。最后一步，是将每个像素的质量除以该像素在透镜平面上的物理面积 $A_{\text{pix}}$，从而得到最终的表面质量密度图 $\Sigma_{ij} = M_{ij} / A_{\text{pix}}$。像素的物理面积由其[角大小](@entry_id:195896) $\Delta\theta$ 和该平面的[角直径距离](@entry_id:157817) $D_A(z_i)$ 共同决定：$A_{\text{pix}} = (D_A(z_i) \Delta\theta)^2$。

通过重复以上步骤，我们就可以从一系列[N体模拟](@entry_id:157492)快照中构建出沿视线[分布](@entry_id:182848)的一系列透镜平面，为完整的射线追踪计算做好准备。

### 数值射线追踪中的近似与系统效应

尽管射线追踪是一个强大的工具，但其结果的精度受到一系列几何近似、数值选择以及模拟本身局限性的影响。理解并量化这些**系统效应 (systematics)** 对于获得可靠的宇宙学结论至关重要。

#### 几何近似：平坦天空极限

在处理小块天区（例如，几度见方）的透镜图时，通常会采用**平坦天空近似 (flat-sky approximation)**。这种近似将弯曲的[天球](@entry_id:158268)面上的一个小块区域当作一个欧几里得平面来处理 [@problem_id:3483302]。

- **数学基础与误差**：该近似的本质是用 $\theta$ 来代替 $\sin\theta$。这在小角度时非常精确，但随着天区尺寸 $\theta_{\text{patch}}$ 的增大，误差会迅速累积。由曲率引起的几何畸变的主导误差与 $\theta_{\text{patch}}^2/6$ 成正比。例如，要将此[误差控制](@entry_id:169753)在1%以下，天区大小通常需要限制在10度以内。

- **尺度限制**：平坦天空近似在小尺度（高多极矩 $\ell$）上表现良好，但在大尺度（低 $\ell$）上则会失效。一个边长为 $\theta_{\text{patch}}$ 的周期性平坦天区无法表示波长超过 $\theta_{\text{patch}}$ 的模式。这对应于一个最小的傅里叶[波数](@entry_id:172452) $k_{\min} = 2\pi/\theta_{\text{patch}}$，或等效的最小[多极矩](@entry_id:191120) $\ell_{\min} \approx 2\pi/\theta_{\text{patch}}$。因此，平坦天空分析本质上无法准确描述非常大的角尺度。

- **与全天方法的对比**：与此相对的是**全天 (full-sky)** 方法，它直接在球面上进行计算。这避免了平坦天空的几何误差，原则上可以精确到最低的物理[多极矩](@entry_id:191120)（对于剪切场是 $\ell=2$）。然而，其代价是计算复杂度的显著增加。全天方法需要处理[球坐标](@entry_id:146054)，并且由于剪切场是一个[自旋-2场](@entry_id:158247)，在比较不同天区位置的剪切时，必须进行**[平行输运](@entry_id:160671) (parallel transport)** 以正确旋转[坐标基](@entry_id:270149)，并使用**自旋加权[球谐函数](@entry_id:178380) (spin-weighted spherical harmonics)**进行分解。

#### 来自模拟属性的数值系统效应

除了几何近似，[N体模拟](@entry_id:157492)本身的特性也会引入系统误差 [@problem_id:3483354]。

- **力软化 (Force Softening)**：[N体模拟](@entry_id:157492)为了避免粒子间距离过近导致[引力](@entry_id:175476)计算发散，会引入一个[软化长度](@entry_id:755011) $\epsilon$。这相当于用一个大小为 $\epsilon$ 的核来平滑[物质密度](@entry_id:263043)，从而抑制了在[波数](@entry_id:172452) $k \gtrsim 1/\epsilon$ （对应于角[多极矩](@entry_id:191120) $l \gtrsim \chi/\epsilon$）上的功率。这会系统性地低估小尺度上的透镜信号。减小 $\epsilon$ 可以缓解此问题，但会增加计算成本。

- **[质量分辨率](@entry_id:197946) (Mass Resolution)**：用离散粒子来表示连续的密度场会引入**散粒噪声 (shot noise)**。在3D[功率谱](@entry_id:159996)中，这表现为一个近似白噪声的附加项 $P_{\text{sn}} = 1/\bar{n}_p$，其中 $\bar{n}_p$ 是粒子的平均数密度。这个噪声项在高波数（小尺度）上会逐渐主导信号。当投影到二维时，它会对[角功率谱](@entry_id:161125)，尤其是在高 $\ell$ 端，造成一个附加的偏差。提高模拟的[质量分辨率](@entry_id:197946)（即在相同体积内使用更多粒子，减小粒子质量）是减小散粒噪声的唯一方法。

- **有限体积 (Finite Volume)**：模拟盒子的有限边长 $L$ 意味着所有波长大于 $L$ 的密度模式都缺失了。这导致在波数 $k  2\pi/L$ 处功率的系统性缺失，从而影响所有依赖于大尺度模式的统计量。简单地沿视线方向周期性地复制盒子并不能恢复这些缺失的模式，反而可能引入人为的周期性相关。

- **光锥离散化 (Discretization of the Light Cone)**：多平面算法用离散的平面间距 $\Delta\chi$ 来近似连续的视[线积分](@entry_id:141417)，这本质上是一个数值积分（求积）过程。这会引入一个**求积误差 (quadrature error)**。对于一个设计良好的二阶积分方案（如[中点法](@entry_id:145565)），这个误差与 $(\Delta\chi)^2$ 成正比。减小平面间距（更精细的切片）或使用更复杂的“连续光锥构建”技术可以有效地抑制这种误差。

#### 统计系统效应：超样本协[方差](@entry_id:200758)

最后，即使模拟本身是完美的，从有限天区或有限模拟体积中测量的统计量也会受到**超样本协[方差](@entry_id:200758) (Super-Sample Covariance, SSC)** 的影响 [@problem_id:3483290]。

- **物理起源**：SSC源于一个物理事实：我们观测的天区（或模拟的体积）本身是嵌入在一个更大的宇宙背景中的。波长远大于我们观测天区的密度模式，虽然在天区内部平均看来像一个均匀的背景密度涨落 $\delta_b$，但它会调制天区内部小尺度结构的生长速率。一个处于超密度区域（$\delta_b  0$）的天区，其内部的结构形成会更快，导致其小尺度[功率谱](@entry_id:159996)的振幅高于宇宙平均值。

- **对[协方差矩阵](@entry_id:139155)的影响**：由于 $\delta_b$ 本身是一个[随机变量](@entry_id:195330)，这种调制效应会在不同天区测量的[功率谱估计](@entry_id:753656)值 $\hat{C}_\ell^\kappa$ 之间引入额外的协[方差](@entry_id:200758)。这种协[方差](@entry_id:200758)将不同[多极矩](@entry_id:191120) $\ell_1$ 和 $\ell_2$ 联系起来，因为它俩都对同一个背景模式 $\delta_b$ 有响应。这导致协方差矩阵中出现一个强烈的、高度非对角的、近似**秩一 (rank-1)** 的贡献项，其形式为 $\mathrm{Cov}_{\mathrm{SSC}}(\hat{C}_{\ell_1}^\kappa,\hat{C}_{\ell_2}^\kappa) \approx \sigma_b^2 (\partial C_{\ell_1}^\kappa/\partial \delta_b) (\partial C_{\ell_2}^\kappa/\partial \delta_b)$，其中 $\sigma_b^2$ 是背景模式的[方差](@entry_id:200758)。

- **在模拟中的体现**：一个标准的周期性[N体模拟](@entry_id:157492)盒子，由于其固定的总质量（即全盒子平均密度过剩为零），从根本上**缺失**了这种超样本模式。因此，仅从模拟内部重复采样得到的协方差矩阵会系统性地低估真实的宇宙学协[方差](@entry_id:200758)，因为它遗漏了SSC这一重要的物理贡献。在进行精确的[宇宙学参数](@entry_id:161338)推断时，必须通过理论模型或其他方法将SSC的贡献加回到协方差矩阵中。

综上所述，从[N体模拟](@entry_id:157492)中进行精确的[引力透镜](@entry_id:159000)射线追踪是一项涉及多重物理和数值挑战的任务。只有对这些原理、机制和潜在的系统效应有透彻的理解，我们才能充分利用这一强大的工具来探索宇宙的奥秘。