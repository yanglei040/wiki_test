## 引言
宇宙[大尺度结构](@entry_id:158990)，即由星系和暗物质构成的被称为“宇宙网”的宏伟结构，包含了关于宇宙起源、演化和基本组成的丰富信息。理解这张网的几何形态与动力学特性是现代宇宙学的核心任务之一。然而，无论是来自数值模拟的粒子数据还是来自[星系巡天](@entry_id:749696)的观测数据，其原始形式都是离散的点集。如何从这些离散的“点”中，稳健、准确地识别出如空洞、墙、纤维和节点等物理结构，是连接理论与观测的关键挑战，也是一个巨大的知识鸿沟。

本文旨在系统性地介绍和剖析用于空洞识别和宇宙网分类的前沿数值算法。我们将带领读者穿越理论、应用与实践的三个层面，全面掌握这一领域的核心技术。在“原理与机制”一章中，我们将深入探讨从离散示踪粒子重构连续场的基本方法，并详细阐述基于动力学、运动学、拓扑学和拉格朗日历史等不同物理原理的分类方案，以及专门用于勾画空洞的算法。随后，在“应用与交叉学科联系”一章中，我们将展示这些算法如何应用于实际科学问题，从基础的算法验证到处理复杂的观测系统误差，再到利用宇宙网作为探针约束基本物理定律。最后，“动手实践”部分将提供一系列精心设计的编程练习，帮助读者将理论知识转化为实际的计算技能。通过这篇文章，读者将不仅学会“如何”使用这些工具，更将深刻理解其背后的“为何”，为在该领域开展前沿研究奠定坚实的基础。

## 原理与机制

宇宙[大尺度结构](@entry_id:158990)的分析，特别是宇宙网的分类和宇宙空洞的识别，依赖于一套复杂的数值方法和物理原理。本章旨在系统地阐述这些方法背后的核心原理与机制。我们将从最基本的步骤——如何从离散的示踪粒子（如星系或暗物[质粒](@entry_id:263777)子）重构连续的宇宙学场——开始，然后深入探讨分类宇宙网环境的各种主[流形](@entry_id:153038)式，最后介绍专门用于识别和描绘宇宙空洞的具体算法。

### 从离散示踪粒子到连续场

[宇宙学模拟](@entry_id:747928)和巡天观测的原始数据本质上是离散的：它们是代表暗物质或星系[分布](@entry_id:182848)的点集。然而，许多理论分析工具，例如那些用于识别宇宙网结构的工具，都需要作用于连续的场，如密度场 $\delta(\mathbf{x})$ 或[引力势](@entry_id:160378)场 $\Phi(\mathbf{x})$。因此，首要任务是从这些离散的示踪粒子重构出平滑、连续的场。选择合适的重构方法至关重要，因为它直接影响后续分析的准确性和可靠性。以下我们讨论几种关键的密度场估计方法 [@problem_id:3502046]。

#### 基于网格的插值方法：Cloud-in-Cell (CIC)

**Cloud-in-Cell (CIC)** 是一种广泛应用的基于网格的[质量分配方案](@entry_id:751705)。其基本思想是将模拟或观测体积划分为一个规则的笛卡尔网格。然后，每个粒子的质量不是简单地分配给它所在的单个网格单元，而是根据其在单元内的相对位置，以一种线性插值的方式分配给其最近的 $2^3=8$ 个邻近网格单元。

CIC方法的主要优点是其[计算效率](@entry_id:270255)高且能够**精确守恒总质量**。由于每个粒子的[质量分配](@entry_id:751704)权重之和精确为1，因此沉积到网格上的总质量等于所有粒子的总质量。然而，CIC也存在显著的缺点。首先，它**不是局部自适应的**；其空间分辨率由网格大小唯一确定，无法适应高密度区域需要更高分辨率、低密度区域需要更低分辨率的实际需求。其次，由于其插值核是沿着坐标轴可分离的，CIC会在场中引入与网格轴对齐的**人为各向异性**，这可能会扭曲不与网格对齐的结构的形状，例如宇宙纤维。

#### 基于核函数的[平滑方法](@entry_id:754982)：平滑粒子[流体动力学](@entry_id:136788) (SPH)

**平滑粒子[流体动力学](@entry_id:136788) (Smoothed Particle Hydrodynamics, SPH)** 提供了一种无网格的场重构方法。其核心思想是将每个粒子视为一个具有一定平滑尺度的扩展核，而空间中任意一点的密度则是所有粒子核函数贡献的总和。密度场 $\rho(\mathbf{x})$ 由下式给出：$\rho(\mathbf{x}) = \sum_j m_j W(\mathbf{x}-\mathbf{r}_j, h_j)$，其中 $m_j$ 和 $\mathbf{r}_j$ 是第 $j$ 个粒子的质量和位置，$W$ 是一个归一化的球对称[核函数](@entry_id:145324)，$h_j$ 是平滑长度。

[SPH方法](@entry_id:755216)同样**精确守恒总质量**，因为每个[核函数](@entry_id:145324)的积分都为1。其关键优势在于**局部自适应性**：通过调整每个粒子的平滑长度 $h_j$ 以包含固定数量的邻近粒子，该方法可以在高密度区域实现高分辨率（小 $h_j$），在稀疏区域实现低分辨率（大 $h_j$）。然而，标准[SPH方法](@entry_id:755216)的主要局限性在于其**各向同性核函数**。这种球对称的平滑倾向于将固有的各向异性结构（如细长的纤维和扁平的墙）[模糊化](@entry_id:260771)，人为地降低了它们的显著性。

#### 基于[泰森多边形](@entry_id:144746)剖分的方法：VTFE 和 DTFE

为了更好地处理宇宙网的复杂几何形状，发展出了基于**[泰森多边形](@entry_id:144746)剖分 (Voronoi Tessellation)** 的方法。

**[泰森多边形](@entry_id:144746)剖分场估计器 (Voronoi Tessellation Field Estimator, VTFE)** 将空间划分为一系列[泰森多边形](@entry_id:144746)单元，每个单元包含一个粒子，并且单元内的所有点都比到其他任何粒子更接近该粒子。VTFE在每个[泰森多边形](@entry_id:144746)单元 $C_i$ 内赋予一个恒定的密度 $\rho_i = m_i / \text{Vol}(C_i)$。这种方法是**[精确质量](@entry_id:746222)守恒的**，并且由于[泰森多边形](@entry_id:144746)单元的体积自然地反比于局部粒子数密度，因此它具有**内禀的局部自适应性**。然而，其场是分片常数，这意味着在单元内部梯度为零，在边界处不连续，这限制了其解析梯度和结构细节的能力。

**[德劳内三角剖分](@entry_id:266197)场估计器 (Delaunay Tessellation Field Estimator, DTFE)** 是VTFE的自然延伸。[德劳内三角剖分](@entry_id:266197)是[泰森多边形](@entry_id:144746)剖分的对偶。DTFE首先在每个粒子位置（即德劳内单纯形，在3D中为四面体，的顶点）上定义密度（通常使用其对偶的[泰森多边形](@entry_id:144746)单元体积），然后在每个单纯形内部进行线性插值。这产生了一个**连续的(C0)**、**[质量守恒](@entry_id:204015)的**密度场。DTFE的关键优势在于其**对各向异性的处理**。构成网格的德劳内单纯形本身就是各向异性的，它们的形状、大小和方向都适应了局部的[粒子分布](@entry_id:158657)。这赋予了该方法一种天然的“方向敏感性”，使其能够比使用各向同性核的方法（如SPH）更好地表示纤维和墙等各向异性特征 [@problem_id:3502046]。

### 宇宙网的分类：欧拉方法

一旦从离散示踪粒子重构出连续场，我们就可以对宇宙网进行分类。欧拉方法是在一个固定的时间快照上，根据空间中每个点的局部动力学或运动学性质来对其进行分类。

#### [潮汐张量](@entry_id:755970)形式 (T-web)

这是最流行的一种宇宙网分类方法，它基于[引力](@entry_id:175476)[潮汐](@entry_id:194316)场。在一个膨胀的宇宙背景中，[物质密度](@entry_id:263043)涨落 $\delta(\mathbf{x}, t)$ 通过[泊松方程](@entry_id:143763)与其产生的 peculiar [引力势](@entry_id:160378) $\Phi(\mathbf{x}, t)$ 相关联：
$$ \nabla^2 \Phi = 4\pi G a^2 \bar{\rho} \delta $$
其中 $G$ 是牛顿引力常数，$a(t)$ 是宇宙尺度因子，$\bar{\rho}$ 是宇宙平均密度 [@problem_id:3502002]。

我们定义**[潮汐张量](@entry_id:755970) (tidal tensor)** 为[引力势](@entry_id:160378)的黑塞矩阵（Hessian matrix）：
$$ T_{ij}(\mathbf{x}, t) \equiv \frac{\partial^2 \Phi(\mathbf{x}, t)}{\partial x_i \partial x_j} $$
$T_{ij}$ 是一个实[对称张量](@entry_id:148092)，描述了[引力场](@entry_id:169425)的局部曲率，即[潮汐力](@entry_id:159188)。两个相邻粒子间的相对加速度正比于[潮汐张量](@entry_id:755970)作用在它们分离向量上的结果。为了理解其物理意义，我们可以考察它的三个实[特征值](@entry_id:154894) $\lambda_1 \ge \lambda_2 \ge \lambda_3$ 和对应的[正交特征向量](@entry_id:155522) $\hat{\mathbf{e}}_1, \hat{\mathbf{e}}_2, \hat{\mathbf{e}}_3$。

沿着一个主轴 $\hat{\mathbf{e}}_\alpha$ 的运动由[特征值](@entry_id:154894) $\lambda_\alpha$ 的符号决定 [@problem_id:3502002]：
-   如果 $\lambda_\alpha > 0$，[潮汐力](@entry_id:159188)是恢复性的，会抑制膨胀并导致物质沿该方向**压缩**或坍缩。
-   如果 $\lambda_\alpha  0$，[潮汐力](@entry_id:159188)会增强分离，导致物质沿该方向**扩张**。

[潮汐张量](@entry_id:755970)的迹与局部密度直接相关：$\mathrm{Tr}(T) = \sum_\alpha \lambda_\alpha = \nabla^2 \Phi = 4\pi G a^2 \bar{\rho} \delta$。这意味着一个区域的净动力学（所有方向上的压缩/扩张之和）由其密度决定。然而，一个过密区域（$\delta>0$）仍然可以在一两个方向上扩张，反之亦然 [@problem_id:3502011]。

**T-web分类方案**正是基于这一原理。通过计算超过某个预设阈值 $\lambda_{\rm th} > 0$ 的[特征值](@entry_id:154894)数量，我们可以判断一个点周围的动力学环境 [@problem_id:3502071] [@problem_id:3502002]：
-   **节点 (Node)**：$3$ 个[特征值](@entry_id:154894) $> \lambda_{\rm th}$ (三轴压缩)。
-   **纤维 (Filament)**：$2$ 个[特征值](@entry_id:154894) $> \lambda_{\rm th}$ (两轴压缩，一轴扩张)。
-   **墙 (Sheet)**：$1$ 个[特征值](@entry_id:154894) $> \lambda_{\rm th}$ (一轴压缩，两轴扩张)。
-   **空洞 (Void)**：$0$ 个[特征值](@entry_id:154894) $> \lambda_{\rm th}$ (三轴扩张)。

这种分类方法具有深刻的动力学基础。在线性[引力不稳定性](@entry_id:160721)理论和[泽尔多维奇近似](@entry_id:139227) (Zel'dovich approximation) 的框架下，物质沿[潮汐](@entry_id:194316)场主轴的坍缩（[壳层穿越](@entry_id:754769)）发生在一个[特征值](@entry_id:154894)达到某个临界值时。因此，设定一个正的阈值 $\lambda_{\rm th}$ 相当于选择那些在动力学上已经演化得比较显著、更接近于坍缩的方向。这为阈值的存在提供了动力学依据 [@problem_id:3502011]。值得注意的是，[潮汐](@entry_id:194316)场的[特征值](@entry_id:154894)大小与平滑尺度有关，因此为了在不同尺度上得到一致的分类结果，阈值 $\lambda_{\rm th}$ 通常需要随尺度变化 [@problem_id:3502011]。

#### 速度剪切张量形式 (V-web)

V-web 分类法是 T-web 的一种替代方案，它不使用引力势，而是直接使用 peculiar 速度场 $\mathbf{v}(\mathbf{x})$ 的运动学信息 [@problem_id:3502083]。其核心是**速度剪切张量 (velocity shear tensor)**，通常定义为一个无量纲化的[对称张量](@entry_id:148092)：
$$ \Sigma_{ij} = -\frac{1}{2H_0} \left( \frac{\partial v_i}{\partial x_j} + \frac{\partial v_j}{\partial x_i} \right) $$
其中 $H_0$ 是哈勃常数，负号是一个约定，目的是使其[特征值](@entry_id:154894)的物理解释与 T-web 保持一致。

[速度梯度](@entry_id:261686)的对称部分（即应变率张量）描述了流体微元的变形速率。在 $\Sigma_{ij}$ 的定义下：
-   正[特征值](@entry_id:154894)对应于负的[应变率](@entry_id:154778)，表示沿该[主轴](@entry_id:172691)方向的**运动学压缩**（流入）。
-   负[特征值](@entry_id:154894)对应于正的[应变率](@entry_id:154778)，表示沿该[主轴](@entry_id:172691)方向的**运动学扩张**（流出）。

$\mathrm{Tr}(\Sigma_{ij}) = -(\nabla \cdot \mathbf{v}) / H_0$ 的迹与[速度散度](@entry_id:264117)直接相关。根据[连续性方程](@entry_id:195013)，[速度散度](@entry_id:264117)与密度演化率相关，因此 $\Sigma_{ij}$ 提供了关于物质是汇聚还是疏散的瞬时[运动学](@entry_id:173318)图像。分类规则与 T-web 相同，即计算超过阈值的正[特征值](@entry_id:154894)数量。在线性理论范畴中，速度场是引力[势的梯度](@entry_id:268447)，因此 V-web 和 T-web 给出的结果是等价的。然而，在[非线性](@entry_id:637147)范畴中，两者的关系变得复杂，它们可以提供互补的信息。

### 宇宙网的分类：拉格朗日和拓扑学方法

除了基于欧拉快照的方法，还有一些更先进的技术，它们或者利用物质的形成历史，或者利用密度场的拓扑结构。

#### 拉格朗日历史与ORIGAMI方法

物理学可以在两种[坐标系](@entry_id:156346)中描述：欧拉[坐标系](@entry_id:156346)（固定的空间点）和拉格朗日[坐标系](@entry_id:156346)（跟随流[体元](@entry_id:267802)运动）。T-web 和 V-web 是欧拉方法。而[拉格朗日方法](@entry_id:142825)则追踪物质元素的初始位置 $\mathbf{q}$ 到它们当前位置 $\mathbf{x}(\mathbf{q}, t)$ 的演化历史。

理解这两种观点的区别很重要。例如，**欧拉[潮汐张量](@entry_id:755970)** $T_{ij}(\mathbf{x}, t) = \partial_i\partial_j \Phi(\mathbf{x}, t)$ 在固定的欧拉点 $\mathbf{x}$ 上定义，其振幅在线性理论中随[时间演化](@entry_id:153943)，比例于 $D(t)/a(t)$ ($D(t)$是[线性增长因子](@entry_id:751309))。而**拉格朗日形变张量**，定义为[位移场](@entry_id:141476)的梯度，是在固定的[拉格朗日点](@entry_id:142288) $\mathbf{q}$ 上定义，其振幅直接正比于 $D(t)$ [@problem_id:3502007]。

**ORIGAMI** 方法就是一种基于拉格朗日历史的分类方案 [@problem_id:3502010]。它的核心思想是，结构的形成源于**[壳层穿越](@entry_id:754769) (shell crossing)**——即最初有序[排列](@entry_id:136432)的[粒子流](@entry_id:753205)发生翻转和交错，形成多流区域。ORIGAMI通过计算沿着初始拉格朗日网格的三个正交轴方向，发生[壳层穿越](@entry_id:754769)的轴的数量来对结构进行分类：
-   **空洞 (Void)**：$0$ 个轴发生[壳层穿越](@entry_id:754769)。
-   **墙 (Sheet)**：$1$ 个轴发生[壳层穿越](@entry_id:754769)。
-   **纤维 (Filament)**：$2$ 个轴发生[壳层穿越](@entry_id:754769)。
-   **晕 (Halo)**：$3$ 个轴发生[壳层穿越](@entry_id:754769)。

在数值模拟中，[壳层穿越](@entry_id:754769)的探测可以通过检查**粒子顺序反转**来实现。具体来说，考虑沿某个拉格朗日轴（如 $q_x$）的一列粒子，它们最初的 $q_x$ 坐标是单调递增的。如果在演化后的某个时刻，它们的欧拉坐标 $x_x$ 不再保持相同的单调顺序（例如，对于初始满足 $q_{x,i}  q_{x,j}$ 的两个粒子 $i$ 和 $j$，演化后却有 $x_{x,i} > x_{x,j}$），就说明发生了[壳层穿越](@entry_id:754769)。通过对每个粒子沿三个轴检查是否存在此类顺序反转，就可以确定其所属的宇宙网环境 [@problem_id:3502010]。

#### 拓扑结构与持久同调

**持久同调 (Persistent Homology)** 是一种来自[拓扑数据分析](@entry_id:154661)的强大数学工具，它通过研究数据场的拓扑结构随尺度变化的持久性来识别有意义的特征。在宇宙学中，它可以被用来分析[密度对比](@entry_id:157948)度场 $\delta(\mathbf{x})$ [@problem_id:3502048]。

其基本过程是构建一个**过滤 (filtration)**。例如，我们可以考虑 $\delta$ 场的**超水平集 (superlevel sets)** $S(\nu) = \{\mathbf{x} | \delta(\mathbf{x}) \ge \nu\}$。当我们将阈值 $\nu$ 从高到低扫描时，就得到了一系列嵌套的拓扑空间。持久同调追踪这个过程中拓扑特征（如连通分支、环、空腔）的“出生”与“死亡”。

-   对于0维同调（$H_0$，计算连通分支），当 $\nu$ 下降到一个[局部极大值](@entry_id:137813)点时，一个新的[连通分支](@entry_id:141881)就**出生**了。
-   当 $\nu$ 继续下降，经过一个[鞍点](@entry_id:142576)时，两个之前独立的连通分支可能会合并，导致较晚出生的那个分支**死亡**。

一个特征的**持久性 (persistence)** 被定义为其出生阈值与死亡阈值之差：$\pi = \delta_{\text{birth}} - \delta_{\text{death}}$。直观上，持久性衡量了特征的显著性：一个由高耸的山峰和深邃的垭口分隔的结构，其持久性会很高；而一个由微小起伏产生的特征，其持久性会很低。

持久同调最强大的功能之一是其**基于原理的噪声过滤能力**。持久性图的稳定性定理指出，如果一个场被幅度上限为 $\epsilon$ 的噪声所扰动，那么其持久性图中的任何点移动的距离不会超过 $\epsilon$。一个重要的推论是，纯噪声所能产生的虚假拓扑特征的持久性不会超过 $2\epsilon$。因此，通过只保留那些持久性 $\pi > 2\epsilon$ 的特征，我们就可以稳健地从数值噪声和采样效应中分离出真实的宇宙学结构 [@problem_id:3502048]。

### 专用空洞识别算法

虽然宇宙网分类可以将宇宙划分为不同类型的环境，但为了研究空洞本身的物理属性（如大小、形状、密度剖面），我们需要能够识别和描绘单个空洞的专用算法。

####球形欠密度空洞寻找器