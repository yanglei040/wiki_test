## 引言
在现代宇宙学中，理解宇宙如何从一个近乎均匀的早期状态演化到今天我们观测到的由星系、星系团和巨大空洞构成的复杂“宇宙网”，是一个核心的科学问题。[暗物质晕](@entry_id:147523)作为[引力坍缩](@entry_id:161275)的基本单元，是所有可见[结构形成](@entry_id:158241)的基石。然而，如何从早期的微小[密度扰动](@entry_id:159546)出发，精确预测这些不同质量的暗物质晕的数量和[分布](@entry_id:182848)，构成了理论宇宙学的一大挑战。[Press-Schechter理论](@entry_id:753703)及其更严谨、更强大的后续发展——漂移集理论（excursion-set theory），正是在此背景下应运而生，为解决这一难题提供了一个优雅而深刻的半解析框架。

本篇文章将系统性地引导读者深入这一理论的核心。我们将分为三个部分，层层递进地揭示其理论精髓与实践价值。
*   在“原理与机制”一章中，我们将追溯理论的源头，理解如何将密度场的演化巧妙地转化为一个[随机游走](@entry_id:142620)的“首次穿越问题”，并推导出描述暗物质晕丰度和偏袒的关键公式。
*   接着，在“应用与[交叉](@entry_id:147634)学科联系”一章中，我们将展示这一理论框架如何被广泛应用于解释真实的观测现象，从星系的聚集模式到[暗物质晕](@entry_id:147523)的内部子结构，乃至用于探索暗物质本性和模拟宇宙[再电离](@entry_id:158356)等前沿课题。
*   最后，在“动手实践”部分，我们提供了一系列精心设计的问题，鼓励读者亲自参与计算，从而将抽象的理论知识转化为解决实际宇宙学问题的能力。

通过本篇文章的学习，你将掌握连接[早期宇宙](@entry_id:160168)与晚期[非线性](@entry_id:637147)结构的关键理论工具，并领会一个简洁的物理思想如何能产生如此深远和丰富的影响。

## 原理与机制

在理解宇宙[大尺度结构](@entry_id:158990)的形成与演化时，一个核心任务是从早期的、近乎均匀的[物质密度](@entry_id:263043)场中，预测后期由引力坍缩形成的各种质量的天体（即[暗物质晕](@entry_id:147523)）的丰度。[Press-Schechter理论](@entry_id:753703)及其更严谨的后续发展——漂移集理论（excursion-set theory），为此提供了一个强大而直观的半解析框架。本章将深入探讨这一框架的基本原理和核心机制。

### 核心思想：作为[随机游走](@entry_id:142620)的密度演化

[宇宙学原理](@entry_id:158425)告诉我们，[早期宇宙](@entry_id:160168)的[物质密度](@entry_id:263043)场在统计上是均匀和各向同性的。结构的形成源于该密度场中微小的初始扰动，这些扰动在[引力](@entry_id:175476)作用下不断增长。我们可以用[密度对比](@entry_id:157948)场 $\delta(\mathbf{x}) \equiv (\rho(\mathbf{x}) - \bar{\rho})/\bar{\rho}$ 来描述这些扰动，其中 $\rho(\mathbf{x})$ 是空间点 $\mathbf{x}$ 的[物质密度](@entry_id:263043)，$\bar{\rho}$ 是宇宙的平均[物质密度](@entry_id:263043)。在标准模型中，这个初始密度场被认为是一个[高斯随机场](@entry_id:749757)。

一个特定质量 $M$ 的暗物质晕，被认为是由一个包含相同质量的初始物质区域[引力坍缩](@entry_id:161275)而形成的。这个区域的初始尺度 $R$ 与质量 $M$ 相关，通常表示为 $M = \frac{4}{3}\pi R^3 \bar{\rho}$。为了确定一个给定区域是否会坍缩，我们需要考察该尺度上的平均[密度对比](@entry_id:157948)。这是通过对密度场 $\delta(\mathbf{x})$ 进行平滑处理来实现的，即用一个具有特征尺度 $R$ 的窗函数 $W_R(\mathbf{x})$ 对其进行卷积，得到平滑后的密度场 $\delta_R(\mathbf{x})$。

漂移集理论的巧妙之处在于，它不考察特定空间位置的密度，而是追踪当平滑尺度 $R$ 从大到小（或等效地，质量尺度 $M$ 从大到小）变化时，一个任意质量元的平滑[密度对比](@entry_id:157948) $\delta_R$ 的演化轨迹。随着 $R$ 的减小，越来越多的短波（小尺度）涨落被包含进来，导致 $\delta_R$ 的值发生随机变化。这个过程可以被类比为一个**[随机游走](@entry_id:142620)**（random walk）。

在这个类比中，“时间”变量不是物理时间，而是与平滑尺度相关的某个量。一个方便的选择是平滑后密度场的[方差](@entry_id:200758) $S(R) \equiv \langle \delta_R^2 \rangle = \sigma^2(R)$。当 $R \to \infty$ 时，$S \to 0$；当 $R \to 0$ 时，$S$ 增大。因此，将平滑尺度从大到小演化，等价于让[随机游走](@entry_id:142620)的“时间”变量 $S$ 从 $0$ 开始增加。

[引力坍缩](@entry_id:161275)的发生被设定为一个简单的准则：当一个质量元的密度轨迹首次上穿一个临界的**坍缩阈值** $\delta_c$ 时，该质量元就被认为坍缩并成为一个暗物质晕的一部分。对于球状坍缩模型，线性理论预测的坍缩阈值是一个常数，约为 $\delta_c \approx 1.686$。因此，预测暗物质晕丰度的问题，就转化为一个[统计力](@entry_id:194984)学中的经典问题：计算[随机游走](@entry_id:142620)首次穿过一个吸收壁（absorbing barrier）的**首次穿越问题**（first-passage problem）。

### 首次穿越问题与晕[质量函数](@entry_id:158970)

为了解析地解决首次穿越问题，我们需要对[随机游走](@entry_id:142620)的性质做出一个关键的简化假设。如果选用一个在傅里叶空间中具有尖锐边界的滤波器，即**sharp-k滤波器**（其[窗函数](@entry_id:139733)为 $W(kR) = \Theta(1-kR)$，其中 $\Theta$ 是亥维赛德阶梯函数），那么[随机游走](@entry_id:142620) $\delta(S)$ 的每一步增量都是独立的。这使得轨迹成为一个**[马尔可夫过程](@entry_id:160396)**（Markovian process），更具体地说，是一个[维纳过程](@entry_id:137696)（Wiener process）。

我们将求解这个问题的过程形式化。令 $F(\delta, S)\mathrm{d}\delta$ 表示在[方差](@entry_id:200758)尺度 $S$ 上，尚未越过坍缩阈值且[密度对比](@entry_id:157948)值介于 $\delta$ 和 $\delta+\mathrm{d}\delta$ 之间的质量元所占的比例。对于一个无漂移的[马尔可夫过程](@entry_id:160396)， $F(\delta, S)$ 的演化由一个简单的[扩散方程](@entry_id:170713)（即**[福克-普朗克方程](@entry_id:140155)**）描述：
$$
\frac{\partial F(\delta, S)}{\partial S} = \frac{1}{2}\frac{\partial^2 F(\delta, S)}{\partial \delta^2}
$$

这个问题需要结合[初始条件](@entry_id:152863)和边界条件来求解。[初始条件](@entry_id:152863)是在 $S=0$（对应无限大平滑尺度 $R \to \infty$），此时所有轨迹都从宇宙平均[密度对比](@entry_id:157948) $\delta=0$ 开始。这可以用狄拉克函数表示：$F(\delta, S=0) = \delta_{\mathrm{D}}(\delta)$。边界条件是在坍缩阈值 $\delta_c$ 处设置一个**吸收壁**。任何到达 $\delta = \delta_c$ 的轨迹都被视为“已坍缩”并从样本中移除，因此在该处的[概率密度](@entry_id:175496)必须为零：$F(\delta_c, S) = 0$ 对所有 $S > 0$ 成立。

这个带有吸收壁的[扩散](@entry_id:141445)问题可以通过**[镜像法](@entry_id:163138)**（method of images）求解。其解是两个高斯分布的叠加：一个是以原点为中心的自由[扩散](@entry_id:141445)解，另一个是在 $\delta = 2\delta_c$ 处放置一个负的“镜像”源产生的解。最终，对于 $\delta  \delta_c$ 的区域，解的形式为：
$$
F(\delta, S) = \frac{1}{\sqrt{2\pi S}} \left[ \exp\left(-\frac{\delta^2}{2S}\right) - \exp\left(-\frac{(\delta - 2\delta_c)^2}{2S}\right) \right]
$$

我们最关心的是首次穿越阈值的速率，即单位[方差](@entry_id:200758) $S$ 内形成暗物质晕的质量元比例。这由进入吸收壁的[概率流](@entry_id:150949) $J$ 给出，根据[菲克定律](@entry_id:155177)，其大小为 $J = -\frac{1}{2} \frac{\partial F}{\partial \delta} \big|_{\delta=\delta_c}$。计算这个导数并代入 $\delta=\delta_c$，我们得到首次穿越速率为：
$$
\frac{\mathrm{d}\mathcal{F}}{\mathrm{d}S} = \frac{\delta_c}{\sqrt{2\pi S^3}}\exp\left(-\frac{\delta_c^2}{2S}\right)
$$
这个表达式给出了在[方差](@entry_id:200758)区间 $[S, S+\mathrm{d}S]$ 内首次穿越的质量元比例。

为了得到一个更具普适性的描述，我们引入无量纲的**峰高**（peak height）变量 $\nu \equiv \delta_c / \sqrt{S} = \delta_c / \sigma(M)$。$\nu$ 衡量了坍缩阈值是密度场在该质量尺度上典型涨落的多少倍，因此高 $\nu$ 值对应于稀有的、高密度的峰，它们会形成大质量的晕。我们定义**多重性函数**（multiplicity function）$f(\nu)$，使得 $f(\nu)|\mathrm{d}\ln\nu|$ 是首次穿越发生在对数峰高区间 $[\ln\nu, \ln\nu+\mathrm{d}\ln\nu]$ 内的质量元比例。通过[变量替换](@entry_id:141386) $|d\ln\nu| = \frac{1}{2S}dS$，我们可以将 $\mathrm{d}\mathcal{F}/\mathrm{d}S$ 与 $f(\nu)$ 联系起来，最终推导出著名的Press-Schechter多重性函数形式 [@problem_id:3482185]：
$$
f(\nu) = \sqrt{\frac{2}{\pi}} \nu \exp\left(-\frac{\nu^2}{2}\right)
$$
这个简洁而优美的结果，完全从[高斯随机场](@entry_id:749757)和球状坍缩的首次穿越模型中推导出来，构成了现代结构形成理论的基石。

### 从理论到观测：晕数密度

[多重性](@entry_id:136466)函数 $f(\nu)$ 是一个描述质量分数[分布](@entry_id:182848)的无量纲理论函数。为了将其与宇宙学观测或数值模拟的结果（例如，特定质量范围内的[暗物质晕](@entry_id:147523)数量）进行比较，我们需要将其转换成一个物理量——**晕[质量函数](@entry_id:158970)**（halo mass function）$n(M,z)$，它被定义为在红移 $z$ 时，单位共动体积内、单位质量间隔的暗物质晕数量。

这个转换基于简单的[质量守恒](@entry_id:204015)原理。在一个质量区间 $[M, M+\mathrm{d}M]$ 内，所有暗物质晕所包含的总质量，占宇宙总物质质量的比例，可以从两个角度计算。一方面，这个质量密度是 $M \cdot n(M,z)\mathrm{d}M$，所以质量分数为 $\frac{M n(M,z)\mathrm{d}M}{\bar{\rho}_{\mathrm{m}}}$，其中 $\bar{\rho}_{\mathrm{m}}$ 是宇宙的平均共动物质密度（不随红移变化）。另一方面，根据[多重性](@entry_id:136466)函数的定义，对应于同一个质量区间的 $\nu$ 区间内的质量分数是 $f(\nu)|\mathrm{d}\ln\nu|$。

将这两个表达式等同起来，我们便得到了 $n(M,z)$ 和 $f(\nu)$ 之间的关键关系 [@problem_id:3496515]：
$$
n(M,z)\mathrm{d}M = \frac{\bar{\rho}_{\mathrm{m}}}{M} f(\nu) |\mathrm{d}\ln\nu|
$$
整理后可得：
$$
n(M,z) = \frac{\bar{\rho}_{\mathrm{m}}}{M^2} f(\nu) \left|\frac{\mathrm{d}\ln\nu}{\mathrm{d}\ln M}\right| \quad \text{或等价地} \quad n(M,z) = \frac{\bar{\rho}_{\mathrm{m}}}{M} f(\nu) \left|\frac{\mathrm{d}\ln\nu}{\mathrm{d}M}\right|
$$
这个关系式是连接抽象理论和具体预测的桥梁。其中，所有量都具有明确的红移依赖性：$\nu(M,z) = \delta_c(z)/\sigma(M,z)$。坍缩阈值 $\delta_c(z)$ 在某些模型中可以依赖于[红移](@entry_id:159945)，而密度场[方差](@entry_id:200758) $\sigma(M,z)$ 则通过[线性增长因子](@entry_id:751309) $D(z)$ 明确地依赖于[红移](@entry_id:159945)，即 $\sigma(M,z) = \sigma(M,z=0)D(z)$。正是这种红移依赖性，驱动了暗物质晕丰度随宇宙时间的演化。

### 关键应用：晕偏袒与峰-背景分裂

观测表明，大质量的暗物质晕（以及它们内部的星系团）比普通物质更加聚集。这种现象被称为**晕偏袒**（halo bias）。漂移集理论结合**峰-背景分裂**（peak-background split, PBS）模型，为这种现象提供了深刻的物理解释。

PBS的核心思想是将密度场分解为两部分：一个是我们感兴趣的、将要坍缩成暗物质晕的小尺度涨落 $\delta_s$，另一个是一个尺度远大于晕的拉格朗日半径的**长波背景[密度涨落](@entry_id:143540)** $\delta_{\ell}$。我们假设在小尺度区域内，$\delta_{\ell}$ 是一个常数。

这个背景密度 $\delta_{\ell}$ 会如何影响小尺度区域的坍缩呢？一个正的背景密度（即该区域处于一个更大的物质超密区中）会“抬高”小尺度涨落的基准线。因此，小尺度涨落只需要达到 $\delta_c - \delta_{\ell}$ 就可以实现整体的坍缩。换句话说，背景密度场有效地改变了坍缩的阈值。

我们可以利用这个效应来计算晕偏袒。**拉格朗日偏袒** $b_L$ 被定义为晕的数密度对背景密度场的[线性响应](@entry_id:146180)：
$$
\frac{\Delta n(M)}{n(M)} \equiv b_L(M) \delta_{\ell}
$$
在漂移集框架下，晕丰度 $n(M)$ 与首次穿越函数 $f(S; \delta_c)$ 成正比。当存在背景场 $\delta_{\ell}$ 时，有效阈值变为 $\delta_c' = \delta_c - \delta_{\ell}$。因此，偏袒可以表示为对阈值的导数：
$$
b_L(M) = \frac{1}{n} \frac{\partial n}{\partial \delta_{\ell}}\bigg|_{\delta_{\ell}=0} = -\frac{1}{f} \frac{\partial f}{\partial \delta_c}\bigg|_{\delta_{\ell}=0} = -\frac{\partial \ln f}{\partial \delta_c}
$$
使用我们之前导出的首次穿越[分布](@entry_id:182848) $f(S; B) \propto B S^{-3/2} \exp(-B^2/2S)$，计算这个[对数导数](@entry_id:169238)，并用 $\nu = \delta_c/\sigma$ 替换 $S$，我们得到一个非常简洁的结果 [@problem_id:3482245]：
$$
b_L(M) = \frac{\nu^2 - 1}{\delta_c}
$$
这表明，对于稀有的大质量晕（$\nu \gg 1$），$b_L$ 是一个大的正数，意味着它们强烈地倾向于在背景密度更高的区域形成。

需要注意的是，$b_L$ 是在初始（拉格朗日）空间中定义的。观测是在演化后的（欧拉）空间中进行的。考虑到物质从欠密区流向超密区，导致超密区体积收缩，通过简单的[数密度](@entry_id:268986)守恒，可以推导出**欧拉偏袒** $b_E$ 和拉格朗日偏袒 $b_L$ 之间的关系：$b_E = b_L + 1$。因此，欧拉偏袒为：
$$
b_E(M) = 1 + \frac{\nu^2 - 1}{\delta_c}
$$
这个结果是漂移集理论的一个巨大成功，它不仅定性地解释了晕偏袒现象，还定量地预测了偏袒对晕质量的依赖关系，这与[数值模拟](@entry_id:137087)的结果非常吻合。

### 超越最简模型：复杂性与改进

虽然基于sharp-k滤波器的马尔可夫模型取得了巨大成功，但它也包含了一些理想化的假设。漂移集理论的强大之处在于其框架的灵活性，可以容纳更复杂的物理效应。

#### 滤[波函数](@entry_id:147440)选择与非马尔可夫游走

sharp-k滤波器在物理上并不现实，因为它在[实空间](@entry_id:754128)中具有[振荡](@entry_id:267781)的[长尾](@entry_id:274276)。在实际应用中，人们更常使用在[实空间](@entry_id:754128)中局域性更好的滤波器，例如**高斯滤波器** $W_G(kR) = \exp(-k^2R^2/2)$。

然而，使用这类滤波器会引入一个新的复杂性：[随机游走](@entry_id:142620)的步长不再是独立的，即过程变为**非马尔可夫的**。在任意“时刻” $S$ 的游走高度 $\delta(S)$，会与其“速度” $\mathrm{d}\delta/\mathrm{d}S$ 相关。这种相关性可以通过一个[无量纲参数](@entry_id:169335) $\gamma$ 来量化 [@problem_id:3482192]：
$$
\gamma \equiv \frac{\langle \delta(S) \frac{\mathrm{d}\delta}{\mathrm{d}S} \rangle}{\sqrt{\langle \delta^2 \rangle \langle (\frac{\mathrm{d}\delta}{\mathrm{d}S})^2 \rangle}}
$$
对于高斯滤波器和[幂律](@entry_id:143404)形式的功率谱 $P(k) \propto k^n$，可以证明这个相关性参数是一个不依赖于尺度 $R$ 的常数，仅由[谱指数](@entry_id:159172) $n$ 决定：
$$
\gamma = \sqrt{\frac{n+3}{n+5}}
$$
对于sharp-k滤波器，$n$ 的等效值是 $n=-3$，此时 $\gamma=0$，恢复了马尔可夫性。对于更现实的宇宙学[功率谱](@entry_id:159996)（$n \approx -1$ 到 $-2$），$\gamma$ 是一个不可忽略的正数。这种相关性使得首次穿越问题在解析上变得极为困难。它意味着，一条已经处于高密度的轨迹，倾向于继续向更高密度移动。这导致低质量晕的形成被抑制，而高质量晕的形成被增强。这一效应是理解数值模拟中测得的晕[质量函数](@entry_id:158970)（如[Sheth-Tormen质量函数](@entry_id:754774)）偏离标准Press-Schechter形式的关键。

#### 多重阈值：宇宙空洞与汇编偏袒

漂移集框架的另一个重要扩展是处理**多重阈值问题**。除了坍缩阈值 $\delta_c$，我们还可以引入其他物理过程对应的阈值。一个经典例子是对**宇宙空洞**（void）的建模。空洞可以被定义为那些密度轨迹首先下穿一个空洞形成阈值 $\delta_v  0$ 的区域。

一个更有趣的问题是“云中空洞”（void-in-cloud）效应：一个区域只有在它触及 $\delta_v$ 之前没有触及 $\delta_c$ 的情况下，才能最终形成一个幸存的空洞。这引出了一个双吸收壁的首次穿越问题。我们可以计算，一个在较大尺度 $S_0$ 上处于环境密度 $\delta_0$（其中 $\delta_v  \delta_0  \delta_c$）的区域，其轨迹最终先撞上 $\delta_v$ 而非 $\delta_c$ 的概率是多少。对于马尔可夫游走，这个问题等价于经典的“赌徒破产问题”，其解为 [@problem_id:3482234]：
$$
P_{\mathrm{surv}}(\delta_0) = \frac{\delta_c - \delta_0}{\delta_c - \delta_v}
$$
这个结果直观地表明，一个已经处于超密环境（$\delta_0  0$）中的区域，成为空洞的概率更低。这揭示了结构形成中的**环境依赖性**：一个区域的最终命运不仅取决于其内部密度，还取决于其所处的更大尺度环境。这个概念是更广义的**汇编偏袒**（assembly bias）现象的前奏，即晕的性质（如聚集性）不仅依赖于其质量，还依赖于其形成历史和环境。

#### 超越高斯性：[原初非高斯性](@entry_id:158248)的影响

标准[漂移集模型](@entry_id:749160)假设初始密度场是[高斯随机场](@entry_id:749757)。然而，许多早期宇宙模型（如[多场暴胀](@entry_id:158179)模型）会产生微弱的**[原初非高斯性](@entry_id:158248)**（Primordial Non-Gaussianity, PNG）。这种非高斯性会在密度场的更[高阶矩](@entry_id:266936)（如三点相关函数或偏斜度）中留下印记，从而影响暗物质晕的丰度，尤其是稀有的大质量晕。

我们可以在漂移集框架中考察这种效应。以局域型非高斯性为例，它主要引入了一个正的**偏斜度** $\mathcal{S}_3 \equiv \langle \delta_R^3 \rangle / \sigma^3$。我们可以用Edgeworth展开来近似非高斯场的概率密度函数（PDF）。在Press-Schechter的映射下（即晕丰度正比于PDF在阈值以上的尾部概率），可以推导出非高斯多重性函数 $f_{\mathrm{NG}}(\nu)$ 相对于高斯情况 $f_{\mathrm{G}}(\nu)$ 的修正因子 [@problem_id:3482238]：
$$
\frac{f_{\mathrm{NG}}(\nu)}{f_{\mathrm{G}}(\nu)} = 1 + \frac{\mathcal{S}_3}{6} (\nu^3 - 3\nu)
$$
这个修正项对高 $\nu$（大质量晕）非常敏感。一个正的偏斜度（$\mathcal{S}_30$）会显著增加大质量晕的数量。这是因为正偏斜度意味着密度场中存在比高斯场更多的极端正向涨落。因此，通过精确测量大质量[星系团](@entry_id:160919)的丰度并将其与此理论预测进行比较，我们可以对[早期宇宙](@entry_id:160168)的物理过程施加极其严格的限制，使结构形成成为探测基础物理的有力工具。

综上所述，Press-Schechter和漂移集理论提供了一个从基本物理原理出发，连接早期宇宙密度场与晚期[非线性](@entry_id:637147)结构丰度和偏袒的强大理论框架。尽管存在简化假设，但其核心思想和机制的灵活性使其能够不断被扩展和完善，以涵盖更复杂的物理效应，从而在[现代宇宙学](@entry_id:752086)研究中始终占据着核心地位。