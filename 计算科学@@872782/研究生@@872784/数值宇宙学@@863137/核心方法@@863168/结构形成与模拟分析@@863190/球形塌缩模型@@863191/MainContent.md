## 引言
在浩瀚的宇宙中，微小的原初[密度涨落](@entry_id:143540)是如何演化成我们今天所观测到的星系、[星系团](@entry_id:160919)等宏伟结构的？这是[现代宇宙学](@entry_id:752086)研究的核心问题之一。虽然完整的结构形成过程极其复杂，涉及[非线性引力](@entry_id:157663)动力学，但物理学家们发展出了一系列强大的理论工具来揭示其背后的物理规律。其中，球形塌缩模型以其简洁的物理图像和深刻的解析洞察力，成为了连接早期宇宙的[线性微扰理论](@entry_id:159071)与晚期[非线性](@entry_id:637147)天体形成的关键桥梁。它为我们理解[引力不稳定性](@entry_id:160721)如何驱动物质聚集提供了第一个、也是最重要的半解析框架。

本文旨在系统性地介绍球形塌缩模型。我们将分三个章节逐步深入：
- 在 **“原理与机制”** 一章中，我们将建立该模型的动力学方程，探讨一个理想化球形过密区域的完整演化历程，并推导其核心预测参数，如线性塌缩阈值和[维里化](@entry_id:161222)密度。
- 在 **“应用与跨学科联系”** 一章中，我们将展示该模型如何在更广阔的宇宙学领域发挥作用，从解释[暗物质晕](@entry_id:147523)的[统计分布](@entry_id:182030)，到作为检验新物理理论的强大工具。
- 最后，在 **“动手实践”** 部分，我们将通过具体的编程练习，引导读者亲手实现球形塌缩模型，将理论知识转化为计算技能。

通过学习本文，读者将对宇宙[大尺度结构](@entry_id:158990)的形成有一个扎实且深入的理解，并掌握一个在宇宙学研究中至今仍被广泛应用的经典理论工具。让我们首先从该模型的基本原理与机制开始。

## 原理与机制

球形塌缩模型是宇宙学中一个基础且强大的解析工具，它极大地促进了我们对[引力](@entry_id:175476)不稳定如何将[早期宇宙](@entry_id:160168)中微小的[密度涨落](@entry_id:143540)放大为今天观测到的巨大结构（如星系和[星系团](@entry_id:160919)）的理解。尽管其假设作了简化，但该模型精确地捕捉到了[非线性](@entry_id:637147)[结构形成](@entry_id:158241)过程中的核心物理机制。本章将深入探讨球形塌缩模型的原理，从其[动力学方程](@entry_id:751029)的建立，到其演化的关键阶段，再到它为更复杂的结构形成理论（如 Press-Schechter 形式论）提供的基本参数。

### 理想化设定：宇宙中的“子宇宙”

球形塌缩模型的核心思想是将一个密度均匀的球形过密区域视为一个独立的弗里德曼-勒梅特-罗伯逊-沃克（FLRW）宇宙，它嵌入在一个更大尺度的背景宇宙中。这个“子宇宙”的演化由其自身的平均密度决定，而背景宇宙则遵循由[宇宙学原理](@entry_id:158425)所描述的全局演化。

背景宇宙的演化由[弗里德曼方程](@entry_id:159305)描述，该方程源于爱因斯坦场方程，并描述了宇宙的膨胀速率，即哈勃参数 $H(a) = \dot{a}/a$，与宇宙中不同能量组分密度之间的关系。对于一个包含非相对论物质（[密度参数](@entry_id:265044) $\Omega_{m,0}$）、辐射（$\Omega_{r,0}$）、[宇宙学常数](@entry_id:159297)（$\Omega_{\Lambda,0}$）和[空间曲率](@entry_id:755140)（$\Omega_{k,0}$）的宇宙，该方程可以写作：

$$
H^{2}(a) = H_{0}^{2}\Big[\Omega_{m,0}\,a^{-3} + \Omega_{r,0}\,a^{-4} + \Omega_{\Lambda,0} + \Omega_{k,0}\,a^{-2}\Big]
$$

其中，$a$ 是宇宙标度因子（今天定义为 $a_0=1$），$H_0$ 是今天的哈勃常数，而下标 $0$ 表示今天的值。

对于星系晕尺度的结构形成，我们主要关心的是[红移](@entry_id:159945) $z \lesssim 100$ 的时期。在这个时期，我们可以对弗里德曼方程进行简化 [@problem_id:3498594]。首先，辐射项的能量密度与物质项的比值随标度因子按 $a^{-1}$ 的关系减小。鉴于观测到的比值 $\Omega_{r,0}/\Omega_{m,0} \sim 3 \times 10^{-4}$，辐射在 $a \gg 3 \times 10^{-4}$（即 $z \ll 3300$）时就可以忽略不计。其次，[现代宇宙学](@entry_id:752086)观测（如宇宙微波背景辐射的各向异性）表明，我们的宇宙在非常大的尺度上是近乎平坦的，即 $|\Omega_{k,0}| \ll 1$。曲率项与物质项的贡献之比随 $a$ [线性增长](@entry_id:157553)，但在 $a \le 1$ 的整个时期内都保持很小。因此，对于研究星系晕的形成，一个极好的近似是将背景宇宙视为一个平坦的、由物质和宇宙学常数主导的宇宙（即 **$\Lambda$CDM 模型**）：

$$
H^{2}(a) \approx H_{0}^{2}\Big[\Omega_{m,0}\,a^{-3} + \Omega_{\Lambda,0}\Big]
$$

在这个简化的背景下，我们将研究一个球形过密区的动力学。

### 运动方程：从物理坐标到[共动坐标](@entry_id:271238)

根据[牛顿壳层定理](@entry_id:171549)（它是广义相对论中[伯克霍夫定理](@entry_id:160605)的牛顿力学模拟），一个球对称质量分布中，位于半径 $R$ 处的球壳所受到的[引力](@entry_id:175476)仅取决于其内部包含的总质量 $M$。因此，一个质量为 $m_{\text{shell}}$ 的球壳的运动方程，考虑到内部质量的[引力](@entry_id:175476)和宇宙学常数 $\Lambda$ 产生的排斥力，可以写作：

$$
\ddot{R}(t) = -\frac{G M}{R(t)^2} + \frac{\Lambda c^2}{3} R(t)
$$

这里 $R(t)$ 是球壳的**物理半径**。值得注意的是，在这个物理[坐标系](@entry_id:156346)的描述中，背景宇宙的膨胀（即哈勃参数 $H(t)$）并未明确出现 [@problem_id:3498611]。

为了将扰动的演化与背景宇宙的膨胀分离开来，引入**[共动坐标](@entry_id:271238)**是至关重要的。我们将物理半径 $R(t)$ 分解为背景膨胀部分和相对于背景的运动部分。我们定义**共动欧拉半径** $x(t) \equiv R(t)/a(t)$。$x(t)$ 描述了球壳相对于背景膨胀的运动。对 $R(t) = a(t)x(t)$ 求两次时间导数，并代入物理[运动方程](@entry_id:170720)，经过一番代数运算并利用背景的弗里德曼方程，我们可以得到 $x(t)$ 的[运动方程](@entry_id:170720)：

$$
\ddot{x}(t) + 2 H(t) \dot{x}(t) = -\frac{4\pi G}{3} \bar{\rho}_m(t) \delta(t) x(t)
$$

其中，$\bar{\rho}_m(t)$ 是背景[物质密度](@entry_id:263043)，而 $\delta(t) \equiv (\rho_{\text{in}}(t) - \bar{\rho}_m(t))/\bar{\rho}_m(t)$ 是球形区域内部的**欧拉密度过密**。这个方程揭示了几个关键的物理效应 [@problem_id:3498611]：
1.  $2 H(t) \dot{x}(t)$ 项是一个阻尼项，被称为“**哈勃拖曳**”（Hubble drag），它描述了[宇宙膨胀](@entry_id:161474)如何抑制扰动的增长。
2.  右侧的[源项](@entry_id:269111)是**奇特[引力](@entry_id:175476)**（peculiar gravity），它由过密区自身的超额密度 $\delta(t)$ 产生，驱动着塌缩过程。

除了动态演化的物理半径 $R(t)$ 和共动半径 $x(t)$，我们还需引入**拉格朗日半径** $r$。这是一个固定不变的标签，用于标识每一个初始的物质球壳。它与该球壳所包围的质量 $M$ 通过今天的平均物质密度 $\bar{\rho}_{m,0}$ 相关联：

$$
M = \frac{4\pi}{3} \bar{\rho}_{m,0} r^3
$$

由于质量是守恒的，对于任何一个给定的物质球壳，$r$ 是一个不随时间改变的常数 [@problem_id:3498647]。质量守恒还提供了拉格朗日半径 $r$ 与演化中的欧拉量 $x(t)$ 和 $\delta(t)$ 之间的重要联系：

$$
r^3 = x(t)^3 [1+\delta(t)]
$$

这个关系表明，一个初始体积为 $\frac{4\pi}{3}r^3$ 的拉格朗日球体，在任意时刻 $t$ 的共动体积变为 $\frac{4\pi}{3}x(t)^3$，而其密度则相应地变为 $\bar{\rho}_m(t)(1+\delta(t))$ [@problem_id:3498611]。

### 球形区域的演化

要解出球形区域的演化，我们需要设定[初始条件](@entry_id:152863)。通常，我们在一个很早的时刻 $t_i$（对应的标度因子为 $a_i$），为一个拉格朗日区域指定一个小的初始线性过密 $\delta_i$。这个 $\delta_i$ 是**拉格朗日初始过密**，它是一个标签，而非任意时刻 $t$ 变化的欧拉过密 $\delta(t)$。利用线性理论中的[泽尔多维奇近似](@entry_id:139227)，我们可以将这个初始过密 $\delta_i$ 转化为球壳运动的初始条件。定义一个无量纲的半径偏差 $y(a) \equiv R(a)/(aR_i)$，其中 $R_i$ 是球壳在 $a_i$ 时的初始物理半径。对于一个处于[线性增长](@entry_id:157553)模式的微小扰动，在物质主导的早期宇宙中，$y(a)$ 的初始条件可以被推导为 [@problem_id:3498651]：

$$
y(a_i) \approx 1 - \frac{\delta_i}{3}, \quad \quad \left.\frac{d y}{d \ln a}\right|_{a_i} \approx -\frac{\delta_i}{3}
$$

这些条件表明，一个过密区（$\delta_i > 0$）的初始膨胀速度略小于背景的哈勃膨胀。

对于一个仅含物质的宇宙（爱因斯坦-德西特，EdS模型），球形区域的[运动方程](@entry_id:170720)有解析解。其解的形式取决于区域的初始能量，或者等效地，其初始密度。一个过密区域（$\Omega_i > 1$）的行为类似于一个闭合宇宙，其半径演化遵循一个[摆线](@entry_id:172297)（cycloid）方程 [@problem_id:813396] [@problem_id:3498668]：

$$
R(\theta) = A(1 - \cos\theta), \quad t(\theta) = B(\theta - \sin\theta)
$$

其中 $\theta$ 是一个[参数化](@entry_id:272587)的“演化角”，而 $A$ 和 $B$ 是由区域质量决定的常数。演化经历以下阶段：
- **初始膨胀**：$\theta$ 从 $0$ 开始增加，区域半径 $R$ 增大。
- **转折**：当 $\theta = \pi$ 时，区域膨胀到最大半径 $R_{\text{ta}} = 2A$，其膨胀速度降为零。
- **塌缩**：当 $\theta$ 从 $\pi$ 增加到 $2\pi$ 时，区域在自身[引力](@entry_id:175476)下开始收缩。
- **[奇点](@entry_id:137764)**：在理想模型中，当 $\theta = 2\pi$ 时，$R$ 变为零，密度发散。

类似地，一个欠密区域（$\Omega_i  1$）的行为类似于一个开放宇宙，其演化由[双曲函数](@entry_id:165175)描述，并会永远膨胀下去 [@problem_id:3498668]。

### 塌缩与[维里化](@entry_id:161222)：从[奇点](@entry_id:137764)到星系晕

现实中，塌缩过程不会形成一个数学上的[奇点](@entry_id:137764)。当物质向中心汇集时，微小的初始不规则性会被放大，导致系统经历一个称为**[剧烈弛豫](@entry_id:158546)**（violent relaxation）的混乱过程。最终，系统达到一种[动态平衡](@entry_id:136767)状态，形成一个稳定的、[引力](@entry_id:175476)束缚的天体，我们称之为**[维里化](@entry_id:161222)**（virialized）的星系晕。

这种平衡状态可以用**维里定理**来描述。对于一个[自引力系统](@entry_id:155831)，[维里定理](@entry_id:146441)表明其总动能 $K$ 和总势能 $U$ 满足关系 $2K + U = 0$。在转折时刻 $t_{\text{ta}}$，系统的动能为零，其总能量 $E = U_{\text{ta}}$。由于能量在塌缩过程中守恒，[维里化](@entry_id:161222)状态的总能量也为 $E$。结合[维里定理](@entry_id:146441)，我们有 $E = K + U = -\frac{1}{2}U_{\text{vir}}$。因此，[维里化](@entry_id:161222)天体的势能 $U_{\text{vir}} = 2E = 2U_{\text{ta}}$。对于一个均匀球体，势能 $U \propto -1/R$，这意味着维里半径 $R_{\text{vir}}$ 是转折半径的一半：$R_{\text{vir}} = R_{\text{ta}}/2$。

对于一个 EdS 宇宙，我们可以利用这一关系计算出[维里化](@entry_id:161222)天体的密度。塌缩（[维里化](@entry_id:161222)）发生在 $t_{\text{vir}} = t_{\text{coll}} = 2t_{\text{ta}}$。通过计算在 $t_{\text{vir}}$ 时刻，[维里化](@entry_id:161222)天体的密度 $\rho_{\text{vir}}$ 与背景[临界密度](@entry_id:162027) $\rho_c(t_{\text{vir}})$ 的比值，我们得到了一个著名的结果 [@problem_id:813396]：

$$
\Delta_{\text{vir}} = \frac{\rho_{\text{vir}}}{\rho_c(t_{\text{vir}})} = 18\pi^2 \approx 178
$$

这个结果表明，在一个 EdS 宇宙中，一个刚刚形成并达到[动力学平衡](@entry_id:187220)的星系晕，其平均密度约为宇宙临界密度的 178 倍。

在更真实的 $\Lambda$CDM 宇宙中，宇宙学常数 $\Lambda$ 的存在会给[维里定理](@entry_id:146441)增加一个额外的项，因为它像一个作用于整个系统的[表面压](@entry_id:152856)力。这使得 $\Delta_{\text{vir}}$ 不再是一个常数，而是依赖于塌缩时的红移 $z$。Bryan  Norman (1998) 提供了一个精确的拟合公式来描述这种依赖关系，它与[红移](@entry_id:159945)时刻的[物质密度](@entry_id:263043)参数 $\Omega_m(z)$ 相关 [@problem_id:3490323]：

$$
\Delta_{\text{vir}}(z) = 18\pi^2 + 82x - 39x^2, \quad \text{其中} \quad x = \Omega_m(z) - 1
$$

其中 $\Omega_m(z) = \frac{\Omega_{m,0}(1+z)^3}{\Omega_{m,0}(1+z)^3 + \Omega_{\Lambda,0}}$。这个随[红移](@entry_id:159945)变化的维里过密 $\Delta_{\text{vir}}(z)$ 是现代[数值模拟](@entry_id:137087)中定义星系晕边界和质量的一个关键物理量。

### 线性塌缩阈值：连接初始与终末的桥梁

球形塌缩模型最重要的应用之一是计算**线性塌缩阈值** $\delta_c$。这个量被定义为：当[非线性模型](@entry_id:276864)预测一个区域在[红移](@entry_id:159945) $z_c$ 时刻完全塌缩时，该区域的初始[密度扰动](@entry_id:159546)经过**线性理论**外插到同一时刻 $z_c$ 所应达到的值。$\delta_c$ 是一个连接初始线性宇宙和最终[非线性](@entry_id:637147)结构的“桥梁”，在 Press-Schechter 和扩展的 Press-Schechter 形式论中扮演着核心角色。

在这些理论中，我们通过平滑早期的线性密度场来识别潜在的结构。如果一个区域在某个尺度上的平均线性过密超过了阈值 $\delta_c$，我们就认为这个区域将会塌缩形成一个相应质量的星系晕。为了与球形塌缩模型的几何设定保持一致，最自然的平滑方式是使用一个**[实空间](@entry_id:754128)球形顶帽滤波器**（real-space top-hat filter）。这个滤波器计算的正是球形区域内的平均密度，从而使得将 $\delta_c$ 应用于这个平均密度值具有了物理上的一致性 [@problem_id:3498647]。

在一个 EdS 宇宙中，$\delta_c$ 的值是一个不依赖于塌缩[红移](@entry_id:159945)的常数：

$$
\delta_c^{\text{EdS}} = \frac{3}{20}(12\pi)^{2/3} \approx 1.686
$$

在 $\Lambda$CDM 宇宙中，情况变得更加微妙。[宇宙学常数](@entry_id:159297) $\Lambda$ 对 $\delta_c$ 有两个看似矛盾的效应 [@problem_id:3498634]：
1.  **对[非线性](@entry_id:637147)塌缩的影响**：$\Lambda$ 产生的排斥力会减缓[非线性](@entry_id:637147)塌缩。因此，为了在特定时间 $t_c$ 达到塌缩，需要一个比 EdS 宇宙中更大的初始扰动。
2.  **对线性增长的影响**：$\Lambda$ 导致宇宙在晚期加速膨胀，这会抑制线性扰动的增长。因此，对于一个给定的初始扰动，其通过线性理论外插到 $t_c$ 时的值会比在 EdS 宇宙中小。

令人惊讶的是，这两个效应——一个倾向于增加 $\delta_c$，另一个倾向于减小 $\delta_c$——几乎完美地相互抵消了。结果是，在 $\Lambda$CDM 宇宙中，$\delta_c(z)$ 对[红移](@entry_id:159945)的依赖性非常弱。精确的数值计算表明，$\delta_c$ 随着[红移](@entry_id:159945)的降低（即 $\Lambda$ 的影响变大）而略有减小。例如，对于一个 $\Omega_{m,0}=0.3$ 的[平坦宇宙](@entry_id:183782)，$\delta_c(z=2) \approx 1.685$，而 $\delta_c(z=0) \approx 1.674$。这种微弱的变化可以用一个关于 $\Omega_m(z)$ 的简单[幂律](@entry_id:143404)形式精确描述 [@problem_id:3498634]：

$$
\delta_c(z) \approx 1.686\,[\Omega_m(z)]^{0.0055}
$$

### 模型的有效性与局限

球形塌缩模型的简洁性源于其核心假设：**同源塌缩**（homologous collapse）。这意味着所有物质球壳都以相同的方式收缩，保持其相对位置，从而使得一个初始密度均匀的顶帽区域在塌缩过程中始终保持密度均匀（直到[奇点](@entry_id:137764)）。这一特性的根源在于，在一个均匀球体内，[引力](@entry_id:175476)和 $\Lambda$ 产生的[合力](@entry_id:163825)正比于到中心的距离 $r$。这种线性力定律保证了运动的同源性 [@problem_id:3498598]。

然而，这种理想化的图景有其局限性。模型的有效性会在以下几种情况下被打破：
- **[壳层穿越](@entry_id:754769)**（Shell Crossing）：这是模型最根本的失效方式。当内部快速移动的壳层追上并穿过外部较慢的壳层时，密度在壳层[交叉](@entry_id:147634)处发散，速度场变得多值。此时，单流体的流体描述不再有效，系统进入了**多流区**（multi-stream region）。这标志着[剧烈弛豫](@entry_id:158546)的开始 [@problem_id:3498598]。
- **外部潮汐场**（External Tidal Fields）：真实的[密度扰动](@entry_id:159546)并非孤立存在，它们会受到周围其他结构的[引力](@entry_id:175476)影响。这些外部结构产生的[潮汐](@entry_id:194316)场通常是各向异性的，会拉伸或压缩球形区域，使其变形为椭球或其他不规则形状，从而破坏了球对称性的基本假设 [@problem_id:3498598]。
- **内部压力或速度弥散**：模型假设物质是“冷的”和无压的。如果物质（如[温暗物质](@entry_id:160015)或重子气体）具有显著的压力或速度弥散，那么[压力梯度力](@entry_id:262279)就会出现。这个力通常不是线性的，它会抵抗[引力](@entry_id:175476)塌缩，并破坏同源性，导致在[壳层穿越](@entry_id:754769)之前就产生密度梯度 [@problem_id:3498598]。

### 高级主题：从[原初扰动](@entry_id:160053)到牛顿[初始条件](@entry_id:152863)

最后，一个至关重要的问题是如何将来自早期宇宙（如[暴胀](@entry_id:161204)）的[原初扰动](@entry_id:160053)，正确地转化为[牛顿力学](@entry_id:162125)框架下球形塌缩模型的[初始条件](@entry_id:152863)。这个过程涉及到从广义相对论到牛顿力学的过渡，并且必须小心处理**规范依赖性**（gauge dependence）的问题。

在广义相对论中，[密度扰动](@entry_id:159546)的值取决于我们如何定义“同时”的超曲面。一个不恰当的选择可能会引入虚假的、非物理的扰动模式。正确的、规范不变的程序如下 [@problem_id:3498658]：
1.  从规范不变的[原初曲率扰动](@entry_id:753735) $\zeta$ 开始，它在[超视界尺度](@entry_id:158063)上是守恒的，是暴胀理论的直接预言。
2.  在进入视界并进入[物质主导时期](@entry_id:272362)后，将 $\zeta$ 转化为牛顿（或纵向）规范下的[引力势](@entry_id:160378) $\Phi$。[牛顿规范](@entry_id:160348)在亚视界尺度下可以自然地过渡到[牛顿引力](@entry_id:159796)。
3.  使用相对论性的泊松方程，将引力势 $\Phi$ 与另一个规范不变的量——**共动密度过密** $\Delta$ 联系起来。
4.  将这个连续的、规范不变的密度场 $\Delta$ 在我们感兴趣的球形区域内进行平均（即通过顶帽滤波器），得到用于牛顿模型初始条件的平均过密 $\delta_i$。
5.  同时，为了确保只激发与[暴胀](@entry_id:161204)预言一致的增长模式，必须设定相应的初始奇特[速度场](@entry_id:271461)，其散度由关系 $\theta_i \propto -\delta_i$ 给出。

遵循这一严谨的步骤，可以确保牛顿模拟的[初始条件](@entry_id:152863)忠实地反映了由基本物理过程（如暴胀）所设定的原初条件，避免了因规范选择不当而产生的虚假效应。