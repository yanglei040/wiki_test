{"hands_on_practices": [{"introduction": "宇宙学的许多计算都始于一个基本参数：哈勃常数 $H_0$。然而，其实际应用常因单位混用和无量纲参数 $h$ 的引入而变得复杂。本练习旨在通过亲手计算，理清 $H_0$ 的物理维度，并掌握其与无量纲哈勃参数 $h$ 的换算关系，这是理解宇宙学文献和处理数值模拟中距离与尺度问题的必备技能。[@problem_id:3476726]", "problem": "考虑一个由 Friedmann–Lemaître–Robertson–Walker (FLRW) 度规描述的均匀且各向同性的宇宙，其中哈勃参数由 $H(t) \\equiv \\dot{a}(t)/a(t)$ 定义，$a(t)$ 是宇宙学尺度因子。天文学家通常以混合单位 $\\mathrm{km\\,s^{-1}\\,Mpc^{-1}}$ 来引述当今的哈勃参数 $H_0$，尽管通过对 $H(t)$ 的量纲分析可知，其自然量纲是时间的倒数。约化哈勃参数 $h$ 的常规定义使得在均方根 (RMS) 涨落振幅 $\\sigma_8$ 的定义中，共动平滑半径为 $R = 8\\,h^{-1}\\,\\mathrm{Mpc}$，并且线性物质功率谱中的波数通常以 $\\mathrm{h\\,Mpc^{-1}}$ 为单位报告。\n\n给定 $H_0 = 67.4\\,\\mathrm{km\\,s^{-1}\\,Mpc^{-1}}$，以及精确的几何转换关系 $1\\,\\mathrm{Mpc} = 3.085677581\\times 10^{22}\\,\\mathrm{m}$，完成以下任务：\n\n1. 使用定义 $H(t) = \\dot{a}/a$ 和量纲推理，证明 $H_0$ 的单位为何是时间的倒数，并将 $H_0$ 转换为国际单位制 (SI) 中的数值，单位为 $\\mathrm{s^{-1}}$。\n2. 用 $H_0$ 定义约化哈勃参数 $h$ 并计算其数值。\n3. 解释采用 $h$ 如何重新缩放共动距离和波数，具体阐明 $R = 8\\,h^{-1}\\,\\mathrm{Mpc}$ 和以 $\\mathrm{h\\,Mpc^{-1}}$ 为单位报告 $k$ 的含义。\n4. 报告 $h$ 的数值作为你的最终答案。将最终答案四舍五入到三位有效数字。最终答案应表示为一个没有单位的纯数。对于第一部分，请用国际单位制中的 $\\mathrm{s^{-1}}$ 单位表示转换后的 $H_0$。", "solution": "本问题要求对哈勃参数 $H_0$ 进行量纲分析，将其转换为国际单位制 (SI) 单位，定义并计算约化哈勃参数 $h$，并解释 $h$ 在宇宙学尺度变换中的应用。\n\n**第一部分：$H_0$ 的量纲分析与国际单位制转换**\n\n哈勃参数定义为 $H(t) \\equiv \\dot{a}(t)/a(t)$，其中 $a(t)$ 是无量纲的宇宙学尺度因子，$\\dot{a}(t)$ 是它对时间的导数 $da/dt$。这些量的量纲是 $[a] = 1$（无量綱）和 $[\\dot{a}] = [T^{-1}]$，其中 $[T]$ 代表时间的量纲。\n\n因此，哈勃参数的量纲是：\n$$ [H] = \\frac{[\\dot{a}]}{[a]} = \\frac{[T^{-1}]}{1} = [T^{-1}] $$\n这证实了哈勃参数 $H_0$ 的基本量綱是时间的倒数。其传统的天文学单位 $\\mathrm{km\\,s^{-1}\\,Mpc^{-1}}$ 掩盖了这一事实，但在量纲上是一致的。让我们通过将给定的 $H_0$ 值转换为其国际单位制基本单位 $\\mathrm{s^{-1}}$ 来证明这一点。\n\n我们已知：\n$H_0 = 67.4\\,\\mathrm{km\\,s^{-1}\\,Mpc^{-1}}$\n$1\\,\\mathrm{Mpc} = 3.085677581\\times 10^{22}\\,\\mathrm{m}$\n\n首先，我们将百万秒差距 ($\\mathrm{Mpc}$) 转换为千米 ($\\mathrm{km}$)，以创建一个无量纲的长度单位比率。\n$1\\,\\mathrm{km} = 10^3\\,\\mathrm{m}$。\n因此，$1\\,\\mathrm{Mpc}$ 等于：\n$$ 1\\,\\mathrm{Mpc} = \\frac{3.085677581\\times 10^{22}\\,\\mathrm{m}}{10^3\\,\\mathrm{m/km}} = 3.085677581\\times 10^{19}\\,\\mathrm{km} $$\n\n现在，我们可以将这个转换代入 $H_0$ 的表达式中：\n$$ H_0 = 67.4\\,\\frac{\\mathrm{km}}{\\mathrm{s} \\cdot \\mathrm{Mpc}} = 67.4\\,\\frac{\\mathrm{km}}{\\mathrm{s}} \\cdot \\frac{1}{1\\,\\mathrm{Mpc}} = 67.4\\,\\frac{\\mathrm{km}}{\\mathrm{s}} \\cdot \\frac{1}{3.085677581\\times 10^{19}\\,\\mathrm{km}} $$\n单位 $\\mathrm{km}$ 被消去，只剩下单位 $\\mathrm{s^{-1}}$：\n$$ H_0 = \\frac{67.4}{3.085677581\\times 10^{19}}\\,\\mathrm{s^{-1}} \\approx 2.1842 \\times 10^{-18}\\,\\mathrm{s^{-1}} $$\n根据量纲分析的要求，$H_0$ 在国际单位制中的值确实是一个时间的倒数，具体为 $H_0 \\approx 2.184 \\times 10^{-18}\\,\\mathrm{s^{-1}}$。\n\n**第二部分：约化哈勃参数 $h$ 的定义与计算**\n\n约化哈勃参数，由无量纲变量 $h$ 表示，是宇宙学中用于参数化哈勃常数 $H_0$ 的一个惯例。它由以下关系定义：\n$$ H_0 \\equiv 100\\,h\\,\\mathrm{km\\,s^{-1}\\,Mpc^{-1}} $$\n这个定义将 $H_0$ 的值分解为一个方便的基准值 $100\\,\\mathrm{km\\,s^{-1}\\,Mpc^{-1}}$ 和一个量化与该基准偏差的无量纲参数 $h$。\n\n给定 $H_0 = 67.4\\,\\mathrm{km\\,s^{-1}\\,Mpc^{-1}}$，我们可以解出 $h$：\n$$ h = \\frac{H_0}{100\\,\\mathrm{km\\,s^{-1}\\,Mpc^{-1}}} = \\frac{67.4\\,\\mathrm{km\\,s^{-1}\\,Mpc^{-1}}}{100\\,\\mathrm{km\\,s^{-1}\\,Mpc^{-1}}} = 0.674 $$\n$h$ 的数值为 $0.674$。\n\n**第三部分：用 $h$ 进行重新缩放的解释**\n\n使用约化哈勃参数 $h$ 是一个强大的工具，用于管理 $H_0$ 测量值中历史上的和持续存在的不确定性。许多宇宙学量，如距离、光度以及密度涨落的功率谱，都依赖于 $H_0$。通过用 $h$ 来表示这些量，理论预测和观测数据可以以一种易于根据任何偏好的 $H_0$ 值进行缩放的形式呈现。\n\n- **共动距离的重新缩放：** 宇宙学中的距离通常通过红移测量推断得出，并与 $H_0$ 成反比。为了明确这种依赖关系，距离经常以 $h^{-1}\\,\\mathrm{Mpc}$ 为单位引述。一个写成 $D = X\\,h^{-1}\\,\\mathrm{Mpc}$ 的距离，其实际值为 $D = X \\cdot (100\\,\\mathrm{km\\,s^{-1}\\,Mpc^{-1}} / H_0) \\, \\mathrm{Mpc}$。如果观察者使用不同的 $H_0$ 值，他们可以简单地代入相应的 $h$ 值来轻松地重新缩放结果。\n\n  对于在 $\\sigma_8$ 定义中使用的平滑半径 $R = 8\\,h^{-1}\\,\\mathrm{Mpc}$ 的具体情况，该记法表示实际的共动尺度不是一个固定的 $8\\,\\mathrm{Mpc}$，而是相对于哈勃常数定义的一个尺度。根据我们的 $h = 0.674$ 值，这个物理尺度是：\n  $$ R = \\frac{8}{0.674}\\,\\mathrm{Mpc} \\approx 11.87\\,\\mathrm{Mpc} $$\n  这个惯例使得定义 $\\sigma_8$ 的理论框架保持一致，同时其对应的精确物理尺度可以随着 $H_0$ 测量值的改进而更新。\n\n- **波数的重新缩放：** 波数 $k$ 在傅里叶空间中定义，其量纲是长度的倒数（例如 $\\mathrm{Mpc^{-1}}$）。因此，它随 $H_0$ 的缩放关系与距离的缩放关系相反。如果距离按 $h^{-1}$ 缩放，那么波数必须按 $h$ 缩放。\n\n  因此，波数通常以 $h\\,\\mathrm{Mpc^{-1}}$ 为单位报告。报告为 $k_{repor t} = q\\,h\\,\\mathrm{Mpc^{-1}}$ 的波数对应于物理波数 $k_{phys} = q \\cdot h\\,\\mathrm{Mpc^{-1}}$。例如，物质功率谱中在 $k = 0.1\\,h\\,\\mathrm{Mpc^{-1}}$ 处的一个特征对应的物理波数是：\n  $$ k_{phys} = 0.1 \\times 0.674\\,\\mathrm{Mpc^{-1}} = 0.0674\\,\\mathrm{Mpc^{-1}} $$\n  将物质功率谱 $P(k)$ 等量对以 $h\\,\\mathrm{Mpc^{-1}}$ 为单位的 $k$ 作图，可以直接在不同理论模型和观测数据汇编之间进行独立于 $H_0$ 的比较。只有在转换为绝对物理尺度时，才需要考虑 $H_0$ 的具体值。\n\n**第四部分：最终答案计算**\n\n问题要求 $h$ 的数值，四舍五入到三位有效数字。如第二部分所计算，使用给定的值 $H_0 = 67.4\\,\\mathrm{km\\,s^{-1}\\,Mpc^{-1}}$：\n$$ h = \\frac{67.4}{100} = 0.674 $$\n输入值 $67.4$ 有三位有效数字，结果 $0.674$ 也有三位有效数字。无需进一步四舍五入。", "answer": "$$\n\\boxed{0.674}\n$$", "id": "3476726"}, {"introduction": "宇宙膨胀的历史不仅关乎速度，更关乎其加速度的变化。减速参数 $q$ 和急动度参数 $j$ 是描述宇宙膨胀运动学的关键高阶量。本练习将引导你从弗里德曼方程出发，推导在平直 $\\Lambda$CDM 模型下这些参数与物质密度 $\\Omega_{m0}$ 及宇宙学常数 $\\Omega_{\\Lambda 0}$ 的直接联系，从而深刻理解宇宙加速膨胀（$q_0 \\lt 0$）的物理根源。[@problem_id:3476774]", "problem": "考虑一个空间平坦的 Friedmann–Lemaître–Robertson–Walker (FLRW) 宇宙，其中充满了非相对论性物质（尘埃）和宇宙学常数。从专用于 FLRW 度规的爱因斯坦场方程出发，并仅使用哈勃参数 $H(t)$、减速参数 $q(t)$ 和急动参数 $j(t)$ 关于尺度因子 $a(t)$ 及其时间导数的标准定义，推导出现今减速参数 $q_0$ 和现今急动参数 $j_0$ 关于物质和宇宙学常数的现今密度参数（分别表示为 $ \\Omega_{m0}$ 和 $ \\Omega_{\\Lambda 0}$）的表达式。假设在现今时期宇宙是空间平坦的，且辐射可以忽略不计。然后，对于 $ \\Omega_{m0} = 0.315$ 和 $ \\Omega_{\\Lambda 0} = 0.685$ 数值计算这些表达式。基于你的推导，简要说明在该模型中得到 $q_0 < 0$ 的物理意义。将你的最终数值结果以行矩阵 $(q_0, j_0)$ 的形式报告。将你的答案四舍五入到四位有效数字。将这些数视为无量纲的。", "solution": "我们从描述均匀、各向同性时空的 Friedmann–Lemaître–Robertson–Walker (FLRW) 度规中的爱因斯坦场方程开始。对于一个空间平坦的宇宙，Friedmann 方程为\n$$\nH^{2}(t) \\equiv \\left(\\frac{\\dot{a}}{a}\\right)^{2} = \\frac{8 \\pi G}{3} \\rho(t) + \\frac{\\Lambda}{3},\n$$\n而加速方程为\n$$\n\\frac{\\ddot{a}}{a} = - \\frac{4 \\pi G}{3} \\left(\\rho(t) + 3 p(t)\\right) + \\frac{\\Lambda}{3}.\n$$\n对于非相对论性物质（尘埃），我们有 $p(t) = 0$。在现今时期 $t_0$，我们记 $H_0 \\equiv H(t_0)$，并定义临界密度和密度参数\n$$\n\\rho_{c0} \\equiv \\frac{3 H_0^{2}}{8 \\pi G}, \\quad \\Omega_{m0} \\equiv \\frac{\\rho_{m0}}{\\rho_{c0}}, \\quad \\Omega_{\\Lambda 0} \\equiv \\frac{\\Lambda}{3 H_0^{2}}.\n$$\n现今时期的空间平坦性意味着\n$$\n\\Omega_{m0} + \\Omega_{\\Lambda 0} = 1,\n$$\n忽略辐射。\n\n减速参数定义为\n$$\nq(t) \\equiv - \\frac{\\ddot{a}}{a H^{2}}.\n$$\n在 $t_0$ 处求值并代入加速方程，得到\n$$\nq_0 = - \\frac{1}{H_0^{2}} \\left[- \\frac{4 \\pi G}{3} \\rho_{m0} + \\frac{\\Lambda}{3} \\right]\n= \\frac{4 \\pi G \\rho_{m0}}{3 H_0^{2}} - \\frac{\\Lambda}{3 H_0^{2}}\n= \\frac{1}{2} \\Omega_{m0} - \\Omega_{\\Lambda 0}.\n$$\n\n接下来，我们推导急动参数。急动参数定义为\n$$\nj(t) \\equiv \\frac{a^{(3)}}{a H^{3}},\n$$\n其中 $a^{(3)} \\equiv \\frac{d^{3} a}{d t^{3}}$。我们首先将 $j(t)$ 与 $q(t)$ 及其导数联系起来。根据 $q(t)$ 的定义，\n$$\n\\frac{\\ddot{a}}{a} = - q H^{2}.\n$$\n对两边关于 $t$ 求导，得到\n$$\n\\frac{a^{(3)}}{a} - \\frac{\\ddot{a} \\dot{a}}{a^{2}} = - \\dot{q} H^{2} - 2 q H \\dot{H}.\n$$\n使用 $\\dot{a}/a = H$ 和 $\\ddot{a}/a = - q H^{2}$，这变成\n$$\n\\frac{a^{(3)}}{a} + q H^{3} = - \\dot{q} H^{2} - 2 q H \\dot{H}.\n$$\n除以 $H^{3}$ 得到\n$$\nj = - \\frac{\\dot{q}}{H} - q - 2 q \\frac{\\dot{H}}{H^{2}}.\n$$\n现在，从 $q = - \\ddot{a}/(a H^{2})$ 可以发现\n$$\n\\dot{H} = \\frac{\\ddot{a}}{a} - H^{2} = - q H^{2} - H^{2} = - (1 + q) H^{2}.\n$$\n将此代入 $j$ 的表达式中，得到\n$$\nj = - \\frac{\\dot{q}}{H} - q - 2 q \\left[ - (1 + q) \\right] = - \\frac{\\dot{q}}{H} + q + 2 q^{2}.\n$$\n\n为了计算尘埃加宇宙学常数模型的 $j$，将 $q$ 和 $\\dot{q}/H$ 用随时间变化的密度参数 $\\Omega_{m}(a)$ 和 $\\Omega_{\\Lambda}(a)$ 来表示会很方便。对于空间平坦的尘埃加宇宙学常数模型，\n$$\nE^{2}(a) \\equiv \\frac{H^{2}(a)}{H_{0}^{2}} = \\Omega_{m0} a^{-3} + \\Omega_{\\Lambda 0},\n$$\n瞬时密度参数为\n$$\n\\Omega_{m}(a) = \\frac{\\Omega_{m0} a^{-3}}{E^{2}(a)}, \\quad \\Omega_{\\Lambda}(a) = \\frac{\\Omega_{\\Lambda 0}}{E^{2}(a)}.\n$$\n可以直接从加速方程验证，对于所有的 $a$，\n$$\nq(a) = \\frac{1}{2} \\Omega_{m}(a) - \\Omega_{\\Lambda}(a).\n$$\n我们现在计算 $d q / d \\ln a$：\n令 $f(a) \\equiv \\Omega_{m0} a^{-3}$ 和 $g \\equiv \\Omega_{\\Lambda 0}$，因此 $E^{2} = f + g$ 且 $q = \\left(\\frac{1}{2} f - g\\right)/(f + g)$。使用 $d f / d \\ln a = - 3 f$ 和商法则，\n$$\n\\frac{d q}{d \\ln a} = \\frac{\\left(- \\frac{3}{2} f\\right) (f + g) - \\left(\\frac{1}{2} f - g\\right)(- 3 f)}{(f + g)^{2}} = - \\frac{9}{2} \\frac{f g}{(f + g)^{2}} = - \\frac{9}{2} \\Omega_{m}(a) \\, \\Omega_{\\Lambda}(a).\n$$\n注意到 $\\dot{q}/H = d q / d \\ln a$，我们有\n$$\n\\frac{\\dot{q}}{H} = - \\frac{9}{2} \\Omega_{m}(a) \\, \\Omega_{\\Lambda}(a).\n$$\n因此，\n$$\nj(a) = q(a) + 2 q^{2}(a) + \\frac{9}{2} \\Omega_{m}(a) \\, \\Omega_{\\Lambda}(a).\n$$\n在现今时期 $a=1$，且空间平坦性条件为 $\\Omega_{m0} + \\Omega_{\\Lambda 0} = 1$，记 $r \\equiv \\Omega_{m0}$ 和 $\\lambda \\equiv \\Omega_{\\Lambda 0} = 1 - r$。那么\n$$\nq_0 = \\frac{1}{2} r - \\lambda = \\frac{1}{2} r - (1 - r) = \\frac{3}{2} r - 1,\n$$\n并且\n$$\nj_0 = q_0 + 2 q_0^{2} + \\frac{9}{2} r \\lambda.\n$$\n代入 $q_0 = \\frac{3}{2} r - 1$ 和 $\\lambda = 1 - r$，\n$$\nj_0 = \\left(\\frac{3}{2} r - 1\\right) + 2 \\left(\\frac{3}{2} r - 1\\right)^{2} + \\frac{9}{2} r (1 - r)\n= 1,\n$$\n所有对 $r$ 的依赖项都消掉了。因此，对于空间平坦宇宙中的尘埃加宇宙学常数模型，$j_0$ 精确等于 1。\n\n我们现在对给定的现今参数进行数值计算。当 $\\Omega_{m0} = 0.315$ 且 $\\Omega_{\\Lambda 0} = 0.685$ 时，\n$$\nq_0 = \\frac{1}{2} \\times 0.315 - 0.685 = 0.1575 - 0.685 = - 0.5275.\n$$\n急动参数为\n$$\nj_0 = 1.\n$$\n四舍五入到四位有效数字，我们报告 $(q_0, j_0) = (-0.5275, 1.000)$。\n\n最后，$q_0 < 0$ 的物理意义是 $\\ddot{a}(t_0) > 0$，即宇宙膨胀在现今时期是加速的。在这个模型中，与宇宙学常数相关的负压驱动了 $\\ddot{a} > 0$，而不等式 $q_0 < 0$ 量化地说明了在 $t_0$ 时期，$\\Lambda$ 的贡献超过了非相对论性物质的减速影响。", "answer": "$$\\boxed{\\begin{pmatrix}-0.5275  1.000\\end{pmatrix}}$$", "id": "3476774"}, {"introduction": "参数 $\\sigma_8$ 是描述宇宙大尺度结构物质涨落幅度的核心指标，但它的值并非基本输入，而是由一组更基本的宇宙学参数（如 $\\Omega_m, h, n_s, A_s$）共同决定的。本练习是一个综合性的数值计算任务，要求你从第一性原理出发，整合原初功率谱、转移函数和增长因子等概念，编写程序来计算 $\\sigma_8$。通过这个过程，你将亲身体验不同基本参数如何共同塑造我们今天观测到的宇宙结构。[@problem_id:3476764]", "problem": "要求您设计并实现一个数值计算，用于评估在共动半径为 $R = 8\\,h^{-1}\\,\\mathrm{Mpc}$ 的球体内的均方根物质涨落（记为 $\\sigma_8$）。该计算针对由参数集 $(\\Omega_m, \\Omega_b, h, n_s, A_s)$ 表征的冷暗物质（CDM）宇宙学模型。假设宇宙是空间平坦的，因此 $\\Omega_\\Lambda = 1 - \\Omega_m$。该计算必须从线性物质功率谱的基本定义出发，并应用一个有物理动机的、无重子摆动（no-baryon-wiggle）的传递函数。\n\n使用的定义：\n- 原初无量纲曲率功率谱由 $\\Delta_{\\mathcal{R}}^2(k) = A_s \\left(\\frac{k}{k_p}\\right)^{n_s - 1}$ 给出，其中 $A_s$ 是标量振幅，$n_s$ 是谱指数，$k_p = 0.05\\,\\mathrm{Mpc}^{-1}$ 是枢轴波数。\n- 从原初曲率扰动到物质密度衬度的线性映射为 $\\delta_m(\\mathbf{k}, z) = \\mathcal{M}(k, z)\\,\\mathcal{R}(\\mathbf{k})$，其中\n$$\n\\mathcal{M}(k, z) = \\frac{2}{5}\\,\\frac{k^2\\,T(k)\\,D(z)}{\\Omega_m\\,\\left(H_0/c\\right)^2},\n$$\n其中 $T(k)$ 是传递函数，$D(z)$ 是相对于 Einstein–de Sitter 情形归一化的线性增长因子（见下文），$H_0 = 100\\,h\\,\\mathrm{km\\,s^{-1}\\,Mpc^{-1}}$ 是当今的哈勃常数，$c = 299{,}792.458\\,\\mathrm{km\\,s^{-1}}$ 是光速。\n- 无量纲物质功率谱为 $\\Delta_m^2(k, z) = \\mathcal{M}(k, z)^2\\,\\Delta_{\\mathcal{R}}^2(k)$。\n- 傅里叶空间中的 top-hat（顶帽）窗函数为 $W(x) = 3\\left[\\sin(x) - x\\cos(x)\\right]/x^3$，其中 $x = kR$。\n- 在尺度 $R$ 上平滑的物质密度场的方差为\n$$\n\\sigma_R^2 = \\int_{0}^{\\infty} \\Delta_m^2(k, z=0)\\,W^2(kR)\\,d\\ln k,\n$$\n$\\sigma_8$ 是在 $R = 8\\,h^{-1}\\,\\mathrm{Mpc}$ 处计算的 $\\sigma_R$。\n\n使用的传递函数：\n- 使用 Bardeen–Bond–Kaiser–Szalay (BBKS) 无摆动形式的传递函数，并结合 Sugiyama 有效形状参数，以考虑没有振荡特征的重子抑制效应：\n$$\nT(k) = \\frac{\\ln\\left(1+2.34\\,q\\right)}{2.34\\,q}\\left[1 + 3.89\\,q + (16.1\\,q)^2 + (5.46\\,q)^3 + (6.71\\,q)^4\\right]^{-1/4},\n$$\n其中\n$$\nq = \\frac{k}{\\Gamma_{\\mathrm{eff}}},\\quad \\Gamma_{\\mathrm{eff}} = \\Omega_m\\,h\\,\\exp\\left[-\\Omega_b - \\sqrt{2h}\\,\\frac{\\Omega_b}{\\Omega_m}\\right],\n$$\n其中 $k$ 的单位是 $\\mathrm{Mpc}^{-1}$。\n\n使用的增长因子：\n- 在红移 $z=0$ 时，使用 Carroll–Press–Turner 近似来计算相对于物质主导时期归一化的增长抑制因子，\n$$\nD(0) = g(\\Omega_m, \\Omega_\\Lambda) = \\frac{5\\,\\Omega_m}{2}\\left[\\Omega_m^{4/7} - \\Omega_\\Lambda + \\left(1 + \\frac{\\Omega_m}{2}\\right)\\left(1 + \\frac{\\Omega_\\Lambda}{70}\\right)\\right]^{-1}.\n$$\n\n单位约定和数值要求：\n- 将 $k$ 的单位视为 $\\mathrm{Mpc}^{-1}$。\n- 使用单位为 $\\mathrm{Mpc}^{-1}$ 的 $H_0/c$；从 $H_0 = 100\\,h\\,\\mathrm{km\\,s^{-1}\\,Mpc^{-1}}$ 和 $c = 299{,}792.458\\,\\mathrm{km\\,s^{-1}}$ 计算它。\n- 最终量 $\\sigma_8$ 是无量纲的；报告每个 $\\sigma_8$ 值时，四舍五入到四位小数。\n- 通过变换到 $\\ln k$ 变量并使用数值稳定的求积方法，在 $k \\in [10^{-4}, 10^{2}]\\,\\mathrm{Mpc}^{-1}$ 范围内对 $\\sigma_R^2$ 进行积分。\n\n测试套件：\n为以下五个参数集 $(\\Omega_m, \\Omega_b, h, n_s, A_s)$ 中的每一个计算 $\\sigma_8$，在所有情况下均假设 $\\Omega_\\Lambda = 1 - \\Omega_m$：\n1. $(0.315, 0.049, 0.674, 0.965, 2.105\\times10^{-9})$ — 一个典型的当代基线。\n2. $(0.315, 0.020, 0.674, 0.965, 2.105\\times10^{-9})$ — 降低重子密度以测试形状敏感性。\n3. $(0.315, 0.049, 0.674, 1.000, 2.105\\times10^{-9})$ — 增加倾斜以测试小尺度增强。\n4. $(0.315, 0.049, 0.674, 0.965, 1.500\\times10^{-9})$ — 降低标量振幅以测试归一化敏感性。\n5. $(0.200, 0.049, 0.700, 0.965, 2.105\\times10^{-9})$ — 降低物质密度（并提高 $\\Omega_\\Lambda$）以测试增长抑制。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含五个 $\\sigma_8$ 结果，格式为方括号内的逗号分隔列表，每个值四舍五入到四位小数（例如，“[0.8021,0.7890, ...]”）。不应打印任何其他文本。", "solution": "该问题要求计算在 $R = 8\\,h^{-1}\\,\\mathrm{Mpc}$ 尺度上的均方根质量涨落振幅（记为 $\\sigma_8$），计算针对几组宇宙学参数集进行。计算必须根据问题陈述中定义的第一性原理进行，并假设一个空间平坦的 $\\Lambda$CDM 宇宙学模型。整个过程可以分解为一系列明确定义的步骤。\n\n首先，我们定义所提供的基本物理和数值常数。\n光速为 $c = 299{,}792.458\\,\\mathrm{km\\,s^{-1}}$。\n原初功率谱的枢轴波数为 $k_p = 0.05\\,\\mathrm{Mpc}^{-1}$。\n$\\sigma_8$ 的平滑尺度为 $R_8 = 8\\,h^{-1}\\,\\mathrm{Mpc}$。\n\n对于每个给定的参数集 $(\\Omega_m, \\Omega_b, h, n_s, A_s)$，我们按以下步骤进行：\n\n1.  **派生的宇宙学参数**\n    问题指定了一个空间平坦的宇宙，因此暗能量密度参数 $\\Omega_\\Lambda$ 由物质密度参数 $\\Omega_m$ 决定：\n    $$ \\Omega_\\Lambda = 1 - \\Omega_m $$\n    哈勃常数为 $H_0 = 100\\,h\\,\\mathrm{km\\,s^{-1}\\,Mpc^{-1}}$。为了在宇宙学方程中使用，方便的做法是将其除以光速，以 $\\mathrm{Mpc}^{-1}$ 为单位表示：\n    $$ \\frac{H_0}{c} = \\frac{100\\,h}{299{,}792.458} \\, \\mathrm{Mpc}^{-1} $$\n\n2.  **$z=0$ 时的线性增长因子**\n    在暗能量存在的情况下，结构的增长会受到抑制。问题提供了 Carroll–Press–Turner (CPT) 近似，用于计算红移 $z=0$ 时的线性增长因子，该因子已对 Einstein-de Sitter 宇宙进行了归一化。它是 $\\Omega_m$ 和 $\\Omega_\\Lambda$ 的函数：\n    $$ D(0) = g(\\Omega_m, \\Omega_\\Lambda) = \\frac{5\\,\\Omega_m}{2}\\left[\\Omega_m^{4/7} - \\Omega_\\Lambda + \\left(1 + \\frac{\\Omega_m}{2}\\right)\\left(1 + \\frac{\\Omega_Lambda}{70}\\right)\\right]^{-1} $$\n    这个因子量化了从早期宇宙到今天线性扰动的总增长。\n\n3.  **传递函数形状参数**\n    物质传递函数的形状主要由物质-辐射相等视界的尺度决定。有效形状参数 $\\Gamma_{\\mathrm{eff}}$ 包含了重子的抑制效应，由 Sugiyama 公式给出：\n    $$ \\Gamma_{\\mathrm{eff}} = \\Omega_m\\,h\\,\\exp\\left[-\\Omega_b - \\sqrt{2h}\\,\\frac{\\Omega_b}{\\Omega_m}\\right] $$\n    该参数的单位是波数 $\\mathrm{Mpc}^{-1}$，它设定了传递函数从大尺度（$k \\to 0$）的 $T(k) \\approx 1$ 过渡到小尺度（$k \\to \\infty$）的幂律衰减的特征尺度。\n\n4.  **方差计算的被积函数**\n    平滑物质密度场 $\\sigma_R^2$ 的方差是无量纲物质功率谱 $\\Delta_m^2(k)$ 乘以傅里葉空间中 top-hat 窗函数的平方 $W^2(kR)$ 后，对波数的对数 $d\\ln k$ 进行的积分。对于 $\\sigma_8$，我们在 $z=0$ 和 $R = R_8 = 8\\,h^{-1}\\,\\mathrm{Mpc}$ 处进行评估。\n    $$ \\sigma_8^2 = \\int_{0}^{\\infty} \\Delta_m^2(k, z=0)\\,W^2(kR_8)\\,d\\ln k $$\n    被积函数是 $\\mathcal{I}(k) = \\Delta_m^2(k, 0)\\,W^2(kR_8)$，我们现在分步构建它。\n\n    a.  **原初曲率功率谱, $\\Delta_{\\mathcal{R}}^2(k)$**：假设为一个简单的幂律：\n        $$ \\Delta_{\\mathcal{R}}^2(k) = A_s \\left(\\frac{k}{k_p}\\right)^{n_s - 1} $$\n        其中 $A_s$ 是原初振幅，$n_s$ 是标量谱指数。\n\n    b.  **物质传递函数, $T(k)$**：使用经 Sugiyama 形状参数修正的 BBKS 公式。它描述了原初密度涨落如何演化为晚期物质分布。\n        $$ T(k) = \\frac{\\ln\\left(1+2.34\\,q\\right)}{2.34\\,q}\\left[1 + 3.89\\,q + (16.1\\,q)^2 + (5.46\\,q)^3 + (6.71\\,q)^4\\right]^{-1/4} $$\n        其中 $q = k / \\Gamma_{\\mathrm{eff}}$。\n\n    c.  **物质-曲率关联, $\\mathcal{M}(k, 0)$**：此函数将原初曲率扰动 $\\mathcal{R}$ 与 $z=0$ 时的物质密度衬度 $\\delta_m$ 联系起来。\n        $$ \\mathcal{M}(k, z=0) = \\frac{2}{5}\\,\\frac{k^2\\,T(k)\\,D(0)}{\\Omega_m\\,\\left(H_0/c\\right)^2} $$\n\n    d.  **无量纲物质功率谱, $\\Delta_m^2(k, 0)$**：这是今天物质密度场的功率谱。\n        $$ \\Delta_m^2(k, 0) = \\mathcal{M}(k, 0)^2 \\, \\Delta_{\\mathcal{R}}^2(k) $$\n        代入 $\\mathcal{M}(k,0)$ 和 $\\Delta_{\\mathcal{R}}^2(k)$ 的表达式：\n        $$ \\Delta_m^2(k, 0) = \\left( \\frac{2}{5}\\,\\frac{D(0)}{\\Omega_m\\,\\left(H_0/c\\right)^2} \\right)^2 A_s \\left(\\frac{k}{k_p}\\right)^{n_s - 1} k^4\\,T^2(k) $$\n\n    e.  **Top-Hat 窗函数, $W(kR_8)$**：此函数滤掉了比 $R_8$ 更小尺度上的涨落。\n        $$ W(x) = \\frac{3}{x^3}[\\sin(x) - x\\cos(x)], \\quad \\text{with } x = kR_8 $$\n        对于小的 $x$ 值，为保持数值稳定性，可以使用泰勒展开：$W(x) \\approx 1 - x^2/10$。\n\n5.  **数值积分**\n    $\\sigma_8^2$ 的积分是数值计算的。问题指定了积分范围为 $k \\in [10^{-4}, 10^{2}]\\,\\mathrm{Mpc}^{-1}$。我们进行变量替换，令 $u = \\ln k$，因此 $dk/k = du$。积分变为：\n    $$ \\sigma_8^2 = \\int_{\\ln(10^{-4})}^{\\ln(10^2)} \\Delta_m^2(e^u, 0) \\, W^2(e^u R_8) \\, du $$\n    这个定积分可以使用标准的数值求积例程（例如 `scipy.integrate.quad`）来求解。\n\n6.  **最终结果**\n    计算出方差 $\\sigma_8^2$ 后，最终结果是它的平方根：\n    $$ \\sigma_8 = \\sqrt{\\sigma_8^2} $$\n    对测试套件中提供的五个参数集中的每一个重复此计算。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Computes sigma_8 for a suite of cosmological parameter sets.\n    \"\"\"\n    # Test suite: (Omega_m, Omega_b, h, n_s, A_s)\n    test_cases = [\n        # 1. Typical contemporary baseline\n        (0.315, 0.049, 0.674, 0.965, 2.105e-9),\n        # 2. Reduced baryon density\n        (0.315, 0.020, 0.674, 0.965, 2.105e-9),\n        # 3. Increased tilt (n_s = 1)\n        (0.315, 0.049, 0.674, 1.000, 2.105e-9),\n        # 4. Reduced scalar amplitude\n        (0.315, 0.049, 0.674, 0.965, 1.500e-9),\n        # 5. Lower matter density\n        (0.200, 0.049, 0.700, 0.965, 2.105e-9),\n    ]\n\n    results = []\n    for params in test_cases:\n        sigma8 = calculate_sigma8(params)\n        results.append(f\"{sigma8:.4f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\n\ndef calculate_sigma8(params):\n    \"\"\"\n    Calculates sigma_8 for a single set of cosmological parameters.\n    \"\"\"\n    Omega_m, Omega_b, h, n_s, A_s = params\n\n    # Constants\n    c_kms = 299792.458  # Speed of light in km/s\n    k_pivot = 0.05  # Pivot scale in Mpc^-1\n    R8 = 8.0  # Smoothing scale in h^-1 Mpc\n    \n    # Integration limits for k in Mpc^-1\n    k_min = 1.0e-4\n    k_max = 1.0e2\n\n    # Derived cosmological parameters\n    Omega_Lambda = 1.0 - Omega_m\n    H0_over_c_Mpc_inv = (100.0 * h) / c_kms\n\n    # Growth factor at z=0 (Carroll-Press-Turner approximation)\n    term1 = Omega_m**(4.0/7.0)\n    term2 = Omega_Lambda\n    term3 = (1.0 + Omega_m/2.0) * (1.0 + Omega_Lambda/70.0)\n    D0 = (2.5 * Omega_m) / (term1 - term2 + term3)\n\n    # Effective shape parameter (Sugiyama formula)\n    Gamma_eff = Omega_m * h * np.exp(-Omega_b - np.sqrt(2.0*h) * Omega_b / Omega_m)\n\n    # Pre-factor for the matter power spectrum\n    prefactor_M_sq = ( (2.0/5.0) * D0 / (Omega_m * H0_over_c_Mpc_inv**2) )**2\n\n    def T_bbks(k):\n        \"\"\"BBKS transfer function with Sugiyama shape parameter.\"\"\"\n        q = k / Gamma_eff\n        # Use log1p for numerical stability at small q\n        log_term = np.log1p(2.34 * q) / (2.34 * q)\n        \n        poly_term_inv = 1.0 + 3.89*q + (16.1*q)**2 + (5.46*q)**3 + (6.71*q)**4\n        return log_term * poly_term_inv**(-0.25)\n\n    def W_tophat(x):\n        \"\"\"Top-hat window function in Fourier space.\"\"\"\n        # Use Taylor expansion for small x to avoid numerical precision issues\n        if abs(x)  1e-6:\n            return 1.0 - x**2 / 10.0\n        return 3.0 * (np.sin(x) - x*np.cos(x)) / x**3\n\n    def integrand(log_k):\n        \"\"\"\n        Integrand for sigma_R^2 as a function of log(k).\n        The change of variables from dk to d(log k) means we don't need the extra k.\n        sigma_R^2 = integral(Delta_m^2(k) * W^2(kR) * d(log k))\n        \"\"\"\n        k = np.exp(log_k)\n        \n        # Primordial power spectrum\n        delta_R_sq = A_s * (k / k_pivot)**(n_s - 1.0)\n        \n        # Transfer function squared\n        T_k_sq = T_bbks(k)**2\n        \n        # Matter power spectrum\n        # Delta_m^2 = M^2 * Delta_R^2\n        # M ~ k^2 * T(k), so M^2 ~ k^4 * T(k)^2\n        delta_m_sq = prefactor_M_sq * A_s * (k / k_pivot)**(n_s - 1.0) * k**4 * T_k_sq\n        \n        # Window function squared\n        W_sq = W_tophat(k * R8 / h)**2\n        \n        return delta_m_sq * W_sq\n\n    # Numerical integration over log(k)\n    log_k_min = np.log(k_min)\n    log_k_max = np.log(k_max)\n    \n    sigma8_sq, _ = integrate.quad(integrand, log_k_min, log_k_max, epsabs=1e-7, epsrel=1e-7)\n\n    return np.sqrt(sigma8_sq)\n\nsolve()\n```", "id": "3476764"}]}