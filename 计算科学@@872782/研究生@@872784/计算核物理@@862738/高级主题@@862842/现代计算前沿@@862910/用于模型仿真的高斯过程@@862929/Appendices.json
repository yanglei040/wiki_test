{"hands_on_practices": [{"introduction": "高斯过程模拟器的一个强大功能是其能够整合来自物理模型的多种信息。除了函数值本身，许多计算代码（例如使用伴随方法的代码）还可以高效地提供输出对输入的梯度或敏感性。本练习将指导您推导在给定函数和梯度观测值时所需的协方差结构，从而将这一宝贵的额外信息融入到高斯过程模型中，以构建更精确的模拟器。[@problem_id:3561163]", "problem": "在计算核物理中，来自确定性中子输运的基于伴随的灵敏度提供了反应堆响应相对于输入参数的梯度信息。考虑使用高斯过程（GP）模拟一个标量核响应，具体来说，是作为单个标量输入函数的无限介质有效增殖因子。设该标量响应被建模为一个零均值高斯过程（GP），其协方差核为 $k(x,x')$，其中 $x$ 是一个单一标量输入参数，定义为 $x = \\ln \\Sigma_{a}$，而 $\\Sigma_{a}$ 是均匀混合物在名义状态附近的宏观吸收截面。假设 $k(x,x')$ 是二阶连续可微的。\n\n1) 从高斯过程的定义以及线性泛函应用于高斯过程会产生另一个高斯过程这一事实出发，推导函数值和梯度之间的联合协方差结构。具体来说，根据核 $k(x,x')$ 的偏导数，推导 $\\mathrm{Cov}(f(x), f(x'))$、$\\mathrm{Cov}(f(x), \\partial f/\\partial x'(x'))$ 和 $\\mathrm{Cov}(\\partial f/\\partial x(x), \\partial f/\\partial x'(x'))$ 的表达式。从第一性原理出发，清晰地论证每一步。\n\n2) 在反应堆物理的伴随灵敏度分析中，人们可以在选定的 $x$ 值处获得 $\\partial f/\\partial x$ 的观测值。请解释如何通过构建包含函数值和梯度的观测向量上的联合高斯先验，将这些梯度观测值纳入高斯过程中。函数和梯度通道的独立观测噪声方差分别为 $\\sigma_{n,f}^{2}$ 和 $\\sigma_{n,g}^{2}$。\n\n3) 考虑平方指数核\n$$\nk(x,x') \\;=\\; \\sigma_{f}^{2}\\,\\exp\\!\\left(-\\frac{(x-x')^{2}}{2\\ell^{2}}\\right),\n$$\n其超参数为 $\\sigma_{f} = 0.2$ 和 $\\ell = 0.6$。给定一个来自中子输运计算的函数观测值，\n$$\nf(x_{1}) \\text{ 在 } x_{1} = 0 \\text{ 处，观测值为 } y_{f} = 1.05,\n$$\n和一个来自伴随灵敏度计算的梯度观测值，\n$$\n\\left.\\frac{\\partial f}{\\partial x}\\right|_{x_{2}} \\text{ 在 } x_{2} = 0.5 \\text{ 处，观测值为 } y_{g} = -0.10.\n$$\n假设观测噪声为独立的高斯噪声，函数观测值的噪声标准差为 $\\sigma_{n,f} = 0.01$，梯度观测值的噪声标准差为 $\\sigma_{n,g} = 0.02$。使用第(1)–(2)部分的结果，构建观测值的 $2\\times 2$ 联合协方差矩阵，以及在测试输入 $x_{*} = 0.2$ 处的 $f(x_{*})$ 与观测向量之间的 $2\\times 1$ 互协方差向量，然后推导在给定混合观测值的情况下 $f(x_{*})$ 的后验均值表达式。\n\n4) 对于给定的超参数和观测值，数值计算在 $x_{*} = 0.2$ 处的后验预测均值。将最终预测的增殖因子表示为一个无量纲数，并将您的答案四舍五入到四位有效数字。", "solution": "该问题被评估为有效。它在科学上基于高斯过程的既定理论及其在代理建模（计算科学中的一种标准技术）中的应用。该问题是适定的、客观的、自洽的，并且所提供的所有数据和条件都是一致且足以推导出唯一解的。\n\n### 第1部分：联合协方差结构的推导\n\n如果对于任意点集 $\\{x_1, \\dots, x_n\\}$，随机向量 $(f(x_1), \\dots, f(x_n))$ 都服从多元高斯分布，那么标量函数 $f(x)$ 就是一个高斯过程（GP）。一个高斯过程完全由其均值函数 $m(x) = \\mathbb{E}[f(x)]$ 和其协方差函数（或核）$k(x,x') = \\mathrm{Cov}(f(x), f(x'))$ 确定。问题陈述响应被建模为一个零均值高斯过程，因此对所有 $x$ 都有 $m(x) = 0$。\n\n高斯过程的一个关键性质是它们对线性运算是封闭的。导数算子 $\\frac{\\partial}{\\partial x}$ 是一个线性算子。因此，如果 $f(x)$ 是一个高斯过程，那么它的导数 $\\frac{\\partial f}{\\partial x}(x)$ 也是一个高斯过程。$f(x)$ 及其导数的联合分布也是高斯的。我们可以利用协方差的性质以及微分和期望算子可以互换的假设来推导协方差结构。这是允许的，因为核 $k(x,x')$ 被假设为二阶连续可微，这意味着高斯过程的样本路径是均方可微的。\n\n在零均值假设下，$\\mathbb{E}[f(x)] = 0$，并且根据期望的线性性质，$\\mathbb{E}[\\frac{\\partial f}{\\partial x}(x)] = \\frac{\\partial}{\\partial x}\\mathbb{E}[f(x)] = 0$。\n\n1.  **函数值之间的协方差，$\\mathrm{Cov}(f(x), f(x'))$**：\n    根据高斯过程协方差函数的定义，这本身就是核函数。\n    $$ \\mathrm{Cov}(f(x), f(x')) = \\mathbb{E}[(f(x) - \\mathbb{E}[f(x)])(f(x') - \\mathbb{E}[f(x')])] = \\mathbb{E}[f(x)f(x')] = k(x,x') $$\n\n2.  **函数值和梯度之间的协方差，$\\mathrm{Cov}(f(x), \\frac{\\partial f}{\\partial x'}(x'))$**：\n    我们使用协方差的定义，并交换微分和期望运算。\n    $$ \\mathrm{Cov}\\left(f(x), \\frac{\\partial f}{\\partial x'}(x')\\right) = \\mathbb{E}\\left[f(x) \\frac{\\partial f}{\\partial x'}(x')\\right] = \\frac{\\partial}{\\partial x'} \\mathbb{E}[f(x)f(x')] $$\n    由于 $\\mathbb{E}[f(x)f(x')] = k(x,x')$，我们有：\n    $$ \\mathrm{Cov}\\left(f(x), \\frac{\\partial f}{\\partial x'}(x')\\right) = \\frac{\\partial k(x,x')}{\\partial x'} $$\n    根据协方差算子的对称性，$\\mathrm{Cov}(\\frac{\\partial f}{\\partial x}(x), f(x')) = \\mathrm{Cov}(f(x'), \\frac{\\partial f}{\\partial x}(x))$。基于前面的结果，这等于 $\\frac{\\partial k(x',x)}{\\partial x}$。由于对于大多数常见的核，$k(x,x')$ 是其参数的对称函数，其偏导数也将具有特定的对称性。对于一个依赖于 $(x-x')$ 的核函数，我们有 $\\frac{\\partial k(x',x)}{\\partial x} = \\frac{\\partial k(x,x')}{\\partial x}$。\n\n3.  **梯度之间的协方差，$\\mathrm{Cov}(\\frac{\\partial f}{\\partial x}(x), \\frac{\\partial f}{\\partial x'}(x'))$**：\n    我们应用相同的过程，对两个参数都进行微分。\n    $$ \\mathrm{Cov}\\left(\\frac{\\partial f}{\\partial x}(x), \\frac{\\partial f}{\\partial x'}(x')\\right) = \\mathbb{E}\\left[\\frac{\\partial f}{\\partial x}(x) \\frac{\\partial f}{\\partial x'}(x')\\right] = \\frac{\\partial}{\\partial x} \\mathbb{E}\\left[f(x) \\frac{\\partial f}{\\partial x'}(x')\\right] $$\n    使用上一步的结果：\n    $$ = \\frac{\\partial}{\\partial x} \\left( \\frac{\\partial k(x,x')}{\\partial x'} \\right) = \\frac{\\partial^2 k(x,x')}{\\partial x \\partial x'} $$\n\n### 第2部分：纳入梯度观测值和噪声\n\n我们被给予函数值和函数梯度的观测值。假设在输入 $\\{x_{f,i}\\}_{i=1}^{N_f}$ 处有 $N_f$ 个函数观测值 $\\{y_{f,i}\\}_{i=1}^{N_f}$，在输入 $\\{x_{g,j}\\}_{j=1}^{N_g}$ 处有 $N_g$ 个梯度观测值 $\\{y_{g,j}\\}_{j=1}^{N_g}$。这些观测值被建模为被独立高斯噪声污染的真实潜值。\n$$ y_{f,i} = f(x_{f,i}) + \\epsilon_{f,i}, \\quad \\epsilon_{f,i} \\sim \\mathcal{N}(0, \\sigma_{n,f}^2) $$\n$$ y_{g,j} = \\left.\\frac{\\partial f}{\\partial x}\\right|_{x=x_{g,j}} + \\epsilon_{g,j}, \\quad \\epsilon_{g,j} \\sim \\mathcal{N}(0, \\sigma_{n,g}^2) $$\n我们定义一个增广观测向量 $\\mathbf{y}$ 和一个对应的增广潜在函数向量 $\\mathbf{f}$。对于问题中在输入 $x_1$ 和 $x_2$ 分别有一个函数和一个梯度观测值的具体情况，我们有：\n$$ \\mathbf{y} = \\begin{pmatrix} y_f \\\\ y_g \\end{pmatrix}, \\quad \\mathbf{f} = \\begin{pmatrix} f(x_1) \\\\ \\left.\\frac{\\partial f}{\\partial x}\\right|_{x=x_2} \\end{pmatrix} $$\n潜值向量 $\\mathbf{f}$ 来自一个零均值多元高斯分布，其协方差矩阵 $K$ 是使用第1部分的结果构建的。\n$$ \\mathbf{f} \\sim \\mathcal{N}(\\mathbf{0}, K) $$\n其中\n$$ K = \\begin{pmatrix}\n\\mathrm{Cov}(f(x_1), f(x_1)) & \\mathrm{Cov}\\left(f(x_1), \\frac{\\partial f}{\\partial x}(x_2)\\right) \\\\\n\\mathrm{Cov}\\left(\\frac{\\partial f}{\\partial x}(x_2), f(x_1)\\right) & \\mathrm{Cov}\\left(\\frac{\\partial f}{\\partial x}(x_2), \\frac{\\partial f}{\\partial x}(x_2)\\right)\n\\end{pmatrix} = \\begin{pmatrix}\nk(x_1, x_1) & \\frac{\\partial k(x_1, x')}{\\partial x'}\\big|_{x'=x_2} \\\\\n\\frac{\\partial k(x, x_1)}{\\partial x}\\big|_{x=x_2} & \\frac{\\partial^2 k(x, x')}{\\partial x \\partial x'}\\big|_{x=x_2, x'=x_2}\n\\end{pmatrix} $$\n观测向量 $\\mathbf{y}$ 是潜在向量 $\\mathbf{f}$ 和噪声向量 $\\boldsymbol{\\epsilon} = (\\epsilon_f, \\epsilon_g)^T$ 的和。噪声被假设独立于过程 $f$，并且有一个协方差矩阵 $\\Sigma_{noise}$。由于噪声项的独立性，该矩阵是对角的：\n$$ \\Sigma_{noise} = \\begin{pmatrix} \\sigma_{n,f}^2 & 0 \\\\ 0 & \\sigma_{n,g}^2 \\end{pmatrix} $$\n两个独立高斯向量的和是高斯的。因此，观测向量 $\\mathbf{y}$ 上的联合高斯先验是：\n$$ \\mathbf{y} \\sim \\mathcal{N}(\\mathbf{0}, K_y), \\quad \\text{其中} \\quad K_y = K + \\Sigma_{noise} $$\n\n### 第3部分：针对具体问题的公式化\n\n给定平方指数核：\n$$ k(x,x') = \\sigma_{f}^{2}\\,\\exp\\left(-\\frac{(x-x')^{2}}{2\\ell^{2}}\\right) $$\n所需的偏导数为：\n$$ \\frac{\\partial k(x,x')}{\\partial x'} = \\sigma_{f}^{2}\\,\\exp\\left(-\\frac{(x-x')^{2}}{2\\ell^{2}}\\right) \\left(\\frac{x-x'}{\\ell^2}\\right) $$\n$$ \\frac{\\partial k(x,x')}{\\partial x} = \\sigma_{f}^{2}\\,\\exp\\left(-\\frac{(x-x')^{2}}{2\\ell^{2}}\\right) \\left(-\\frac{x-x'}{\\ell^2}\\right) $$\n$$ \\frac{\\partial^2 k(x,x')}{\\partial x \\partial x'} = \\frac{\\sigma_f^2}{\\ell^2} \\exp\\left(-\\frac{(x-x')^{2}}{2\\ell^{2}}\\right) \\left(1 - \\frac{(x-x')^2}{\\ell^2}\\right) $$\n观测点是 $x_1 = 0$ (函数) 和 $x_2=0.5$ (梯度)。测试点是 $x_*=0.2$。\n\n观测值的 $2\\times 2$ 联合协方差矩阵 $K_y = K + \\Sigma_{noise}$ 构建如下：\n$K_{11} = k(x_1, x_1) = k(0,0) = \\sigma_f^2$\n$K_{12} = \\frac{\\partial k(x_1, x')}{\\partial x'}\\big|_{x'=x_2} = \\frac{\\partial k(0, x')}{\\partial x'}\\big|_{x'=0.5} = \\frac{\\sigma_f^2}{\\ell^2}(0-0.5) \\exp\\left(-\\frac{(0-0.5)^2}{2\\ell^2}\\right)$\n$K_{21} = \\frac{\\partial k(x, x_1)}{\\partial x}\\big|_{x=x_2} = \\frac{\\partial k(x, 0)}{\\partial x}\\big|_{x=0.5} = \\frac{\\sigma_f^2}{\\ell^2}(-(0.5-0)) \\exp\\left(-\\frac{(0.5-0)^2}{2\\ell^2}\\right) = K_{12}$\n$K_{22} = \\frac{\\partial^2 k(x, x')}{\\partial x \\partial x'}\\big|_{x=x_2, x'=x_2} = \\frac{\\partial^2 k(x, x')}{\\partial x \\partial x'}\\big|_{x=0.5, x'=0.5} = \\frac{\\sigma_f^2}{\\ell^2} (1-0) = \\frac{\\sigma_f^2}{\\ell^2}$\n因此，完整的观测协方差矩阵是：\n$$ K_y = \\begin{pmatrix} \\sigma_f^2 + \\sigma_{n,f}^2 & \\frac{-\\sigma_f^2}{2\\ell^2}\\exp\\left(\\frac{-1}{8\\ell^2}\\right) \\\\ \\frac{-\\sigma_f^2}{2\\ell^2}\\exp\\left(\\frac{-1}{8\\ell^2}\\right) & \\frac{\\sigma_f^2}{\\ell^2} + \\sigma_{n,g}^2 \\end{pmatrix} $$\n\n$f(x_*)$ 与观测向量 $\\mathbf{f} = (f(x_1), \\partial f/\\partial x(x_2))^T$ 之间的 $2\\times 1$ 互协方差向量用 $k_*$ 表示。\n$$ k_* = \\begin{pmatrix} \\mathrm{Cov}(f(x_*), f(x_1)) \\\\ \\mathrm{Cov}(f(x_*), \\frac{\\partial f}{\\partial x}(x_2)) \\end{pmatrix} = \\begin{pmatrix} k(x_*, x_1) \\\\ \\frac{\\partial k(x_*, x')}{\\partial x'}\\big|_{x'=x_2} \\end{pmatrix} $$\n$$ k_* = \\begin{pmatrix} \\sigma_f^2 \\exp\\left(-\\frac{(x_*-x_1)^2}{2\\ell^2}\\right) \\\\ \\frac{\\sigma_f^2}{\\ell^2}(x_*-x_2)\\exp\\left(-\\frac{(x_*-x_2)^2}{2\\ell^2}\\right) \\end{pmatrix} = \\begin{pmatrix} \\sigma_f^2 \\exp\\left(-\\frac{(0.2-0)^2}{2\\ell^2}\\right) \\\\ \\frac{\\sigma_f^2}{\\ell^2}(0.2-0.5)\\exp\\left(-\\frac{(0.2-0.5)^2}{2\\ell^2}\\right) \\end{pmatrix} $$\n\n给定观测向量 $\\mathbf{y}_{obs} = (y_f, y_g)^T$ 时 $f(x_*)$ 的后验均值由条件高斯分布的标准公式给出。在零先验均值下，该值为：\n$$ \\bar{f}(x_*) = \\mathbb{E}[f(x_*)|\\mathbf{y}=\\mathbf{y}_{obs}] = k_*^T K_y^{-1} \\mathbf{y}_{obs} $$\n代入推导出的矩阵：\n$$ \\bar{f}(x_*) = k_*^T (K+\\Sigma_{noise})^{-1} \\mathbf{y}_{obs} $$\n\n### 第4部分：数值计算\n\n我们被给予以下值：$\\sigma_f=0.2$, $\\ell=0.6$, 在 $x_1=0$ 处 $y_f=1.05$, 在 $x_2=0.5$ 处 $y_g=-0.10$, $\\sigma_{n,f}=0.01$, $\\sigma_{n,g}=0.02$, 测试点为 $x_*=0.2$。\n超参数为 $\\sigma_f^2 = 0.04$ 和 $\\ell^2 = 0.36$。噪声方差为 $\\sigma_{n,f}^2 = 0.0001$ 和 $\\sigma_{n,g}^2 = 0.0004$。\n\n首先，我们计算矩阵 $K$：\n$K_{11} = 0.04$\n$K_{12} = K_{21} = \\frac{0.04}{0.36}(0-0.5)\\exp\\left(-\\frac{0.25}{2(0.36)}\\right) = -\\frac{1}{18} \\exp\\left(-\\frac{25}{72}\\right) \\approx -0.03925836$\n$K_{22} = \\frac{0.04}{0.36} = \\frac{1}{9} \\approx 0.11111111$\n所以，$K \\approx \\begin{pmatrix} 0.04 & -0.03925836 \\\\ -0.03925836 & 0.11111111 \\end{pmatrix}$。\n\n接下来，我们构建 $K_y = K + \\Sigma_{noise}$：\n$K_y = \\begin{pmatrix} 0.04+0.0001 & -0.03925836 \\\\ -0.03925836 & 0.11111111+0.0004 \\end{pmatrix} = \\begin{pmatrix} 0.0401 & -0.03925836 \\\\ -0.03925836 & 0.11151111 \\end{pmatrix}$。\n\n现在，我们计算向量 $k_*$：\n$(k_*)_1 = k(0.2, 0) = 0.04\\exp\\left(-\\frac{0.2^2}{2(0.36)}\\right) = 0.04\\exp\\left(-\\frac{0.04}{0.72}\\right) = 0.04\\exp\\left(-\\frac{1}{18}\\right) \\approx 0.03783835$\n$(k_*)_2 = \\frac{0.04}{0.36}(0.2-0.5)\\exp\\left(-\\frac{(0.2-0.5)^2}{2(0.36)}\\right) = -\\frac{0.3}{9}\\exp\\left(-\\frac{0.09}{0.72}\\right) = -\\frac{1}{30}\\exp\\left(-\\frac{1}{8}\\right) \\approx -0.02941656$\n所以，$k_* \\approx \\begin{pmatrix} 0.03783835 \\\\ -0.02941656 \\end{pmatrix}$。\n\n我们需要计算 $K_y^{-1}$。行列式为：\n$\\det(K_y) = (0.0401)(0.11151111) - (-0.03925836)^2 \\approx 0.00447160 - 0.00154122 \\approx 0.00293038$。\n逆矩阵为：\n$K_y^{-1} \\approx \\frac{1}{0.00293038} \\begin{pmatrix} 0.11151111 & 0.03925836 \\\\ 0.03925836 & 0.0401 \\end{pmatrix} \\approx \\begin{pmatrix} 38.0537 & 13.3970 \\\\ 13.3970 & 13.6842 \\end{pmatrix}$。\n\n现在我们计算后验均值 $\\bar{f}(x_*) = k_*^T K_y^{-1} \\mathbf{y}_{obs}$，其中 $\\mathbf{y}_{obs} = (1.05, -0.10)^T$。\n我们先求向量 $v^T = k_*^T K_y^{-1}$：\n$v_1 = (0.03783835)(38.0537) + (-0.02941656)(13.3970) \\approx 1.44009 - 0.39411 \\approx 1.04598$\n$v_2 = (0.03783835)(13.3970) + (-0.02941656)(13.6842) \\approx 0.50692 - 0.40248 \\approx 0.10444$\n$v^T \\approx \\begin{pmatrix} 1.04598 & 0.10444 \\end{pmatrix}$。\n\n最后，后验均值为：\n$\\bar{f}(0.2) = v^T \\mathbf{y}_{obs} = (1.04598)(1.05) + (0.10444)(-0.10) \\approx 1.09828 - 0.01044 = 1.08784$。\n\n四舍五入到四位有效数字，后验预测均值为 $1.088$。", "answer": "$$\n\\boxed{1.088}\n$$", "id": "3561163"}, {"introduction": "在为有噪声的计算机模拟（如蒙特卡洛代码）构建模拟器时，正确处理噪声是至关重要的。高斯过程中的“块金”(nugget)项不仅用于解释观测噪声，它还是一个关键的正则化参数，用于控制偏差-方差权衡。本练习探讨了块金项对模拟器行为的深远影响，从过拟合到欠拟合，从而帮助您深入理解如何调整模型以获得最佳预测性能。[@problem_id:3561171]", "problem": "一个研究团队正在模拟一个带噪声的中子输运蒙特卡洛代码，该代码为每个输入设置 $x \\in \\mathbb{R}^d$（例如，编码了材料密度和截面乘子）返回一个潜在目标量 $f(x)$ 的随机估计，例如有效增殖因子 $k_{\\mathrm{eff}}$。在设计输入 $\\{x_i\\}_{i=1}^n$ 处，由于粒子历史数有限，单次运行的代码输出被建模为 $y_i = f(x_i) + \\varepsilon_i$，其中 $\\varepsilon_i \\sim \\mathcal{N}(0,\\tau_i^2)$ 是独立的，$\\tau_i^2 \\propto 1/N_i$，$N_i$ 是在 $x_i$ 处模拟的粒子历史数。该模拟器为潜在函数 $f$ 设置了一个高斯过程先验 $f \\sim \\mathcal{GP}(m(\\cdot), k_\\theta(\\cdot,\\cdot))$，其均值函数为 $m$，协方差核为 $k_\\theta$，并使用具有同方差“块金”方差 $\\sigma_n^2$ 的高斯似然，因此观测模型为 $y \\mid f \\sim \\mathcal{N}(f, \\sigma_n^2 I_n)$，其中 $I_n$ 是 $n \\times n$ 的单位矩阵。在本次讨论中，超参数 $\\theta$ 和 $\\sigma_n^2$ 被视为固定的。\n\n通过对先验和似然所隐含的联合高斯分布进行条件化，定义潜在函数 $f(x)$ 的模拟器后验均值预测器 $\\mu_*(x)$ 及其后验方差 $\\sigma_*^2(x)$。将模拟器在测试输入 $x$ 处的偏差定义为 $b(x) = \\mathbb{E}_{\\varepsilon}[\\mu_*(x)] - f(x)$，其中期望是针对相同设计 $\\{x_i\\}$ 上的重复蒙特卡洛噪声实现 $\\{\\varepsilon_i\\}$ 计算的，并将估计器方差定义为在这些重复中的 $v(x) = \\operatorname{Var}_{\\varepsilon}[\\mu_*(x)]$。考虑当“块金” $\\sigma_n^2$ 从 0 变化到非常大的值（形式上为 $\\sigma_n^2 \\to \\infty$）时，这些量以及后验方差 $\\sigma_*^2(x)$ 的行为，同时保持设计 $\\{x_i\\}$ 和核 $k_\\theta$ 固定。\n\n在这种情况下，下列哪些陈述是正确的？\n\nA. 如果数据实际上是带噪声的，而 $\\sigma_n^2 = 0$，那么模拟器将在训练输入点上对观测值 $y_i$ 进行插值，导致对 $f$ 的偏差较低，但在蒙特卡洛重复实验中估计器方差 $v(x)$ 较高，并且在任何训练输入 $x_i$ 处，潜在函数 $f$ 的后验方差将坍缩到 0。\n\nB. 当 $\\sigma_n^2 \\to \\infty$ 时，后验均值 $\\mu_*(x)$ 回归到先验均值 $m(x)$，后验方差 $\\sigma_*^2(x)$ 趋近于先验方差 $k_\\theta(x,x)$，这反映了来自数据的信息损失。在此极限下，估计器方差 $v(x)$ 减小，而偏差的绝对值 $|b(x)|$ 增加，除非 $m(x) = f(x)$。\n\nC. 当每个设计点的蒙特卡洛噪声方差 $\\{\\tau_i^2\\}$ 可用时，模拟带噪声的蒙特卡洛代码的最优选择总是设置 $\\sigma_n^2 = 0$，因为高斯过程核 $k_\\theta$ 可以通过其长度尺度和振幅来学习随机噪声。\n\nD. 即使对于确定性代码（即真实观测噪声为 0），引入一个小的正“块金”（有时称为数值抖动）也可以改善协方差矩阵 $K_\\theta + \\sigma_n^2 I_n$ 的条件数，从而减少矩阵求逆中的数值误差。\n\nE. 增加 $\\sigma_n^2$ 总是会减小所有测试输入 $x$ 处的后验预测方差 $\\sigma_*^2(x)$，因为随着“块金”的增长，模型会轻视噪声波动。\n\n选择所有正确的选项。", "solution": "首先将验证问题陈述的科学合理性、一致性和清晰度。\n\n### 步骤1：提取已知条件\n- 输入空间为 $x \\in \\mathbb{R}^d$。\n- 目标量是一个潜在函数 $f(x)$。\n- 一个带噪声的蒙特卡洛代码在设计输入 $\\{x_i\\}_{i=1}^n$ 处提供观测值。\n- 单次运行的代码输出被建模为 $y_i = f(x_i) + \\varepsilon_i$。\n- 真实观测噪声为 $\\varepsilon_i \\sim \\mathcal{N}(0,\\tau_i^2)$，且 $\\varepsilon_i$ 相互独立。\n- 真实噪声方差与模拟投入 $N_i$ 的关系为 $\\tau_i^2 \\propto 1/N_i$。\n- 模拟器对潜在函数使用高斯过程（GP）先验：$f \\sim \\mathcal{GP}(m(\\cdot), k_\\theta(\\cdot,\\cdot))$。\n- 模拟器使用具有同方差“块金”方差 $\\sigma_n^2$ 的高斯似然：$y \\mid f \\sim \\mathcal{N}(f, \\sigma_n^2 I_n)$，其中 $I_n$ 是 $n \\times n$ 的单位矩阵。\n- 超参数 $\\theta$ 和 $\\sigma_n^2$ 被视为固定的。\n- 模拟器对 $f(x)$ 的后验均值为 $\\mu_*(x)$。\n- 模拟器对 $f(x)$ 的后验方差为 $\\sigma_*^2(x)$。\n- 模拟器的偏差定义为 $b(x) = \\mathbb{E}_{\\varepsilon}[\\mu_*(x)] - f(x)$，其中期望是针对真实噪声 $\\{\\varepsilon_i\\}$ 的实现计算的。\n- 估计器方差定义为 $v(x) = \\operatorname{Var}_{\\varepsilon}[\\mu_*(x)]$。\n- 核心任务是分析当 $\\sigma_n^2$ 从 0 变化到 $\\infty$ 时，$\\mu_*(x)$、$\\sigma_*^2(x)$、$b(x)$ 和 $v(x)$ 的行为。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据：**该问题牢固地植根于高斯过程回归理论，这是机器学习和统计学中一种标准而强大的技术。将其应用于模拟计算机实验，特别是物理学中带噪声的蒙特卡洛代码，是 GP 的一个主要用例。偏差和方差的定义是分析估计器的标准定义。该设置在科学上和数学上都是合理的。\n- **良态问题（Well-Posed）：**该问题是良态的。使用高斯先验和似然的标准 GP 回归框架会产生一个明确定义的后验分布。后验均值和方差的方程是唯一的，并且可以解析推导。待分析的量（$b(x)$ 和 $v(x)$）有清晰的定义，它们在指定极限下的行为可以确定。\n- **客观性：**该问题使用精确、客观和标准的数学术语进行陈述。问题设置中没有主观或基于意见的主张。\n- **完整性和一致性：**该问题是自洽的。它提供了先验、似然模型和所有必要的定义。问题有意区分了真实的异方差噪声模型（$\\tau_i^2$）和模拟器假设的同方差噪声模型（$\\sigma_n^2$），这代表了一种模型设定不当的情况。这不是一个矛盾，而是该问题的一个关键特征，在实践中很常见，也是问题所要探讨的。\n- **其他缺陷：**该问题并非不切实际、病态、微不足道或无法验证。它代表了高级统计建模中的一个标准场景。\n\n### 步骤3：结论和行动\n问题陈述是有效的。将推导完整的解答。\n\n### 核心方程的推导\n\n给定 GP 先验 $f \\sim \\mathcal{GP}(m, k_\\theta)$ 和似然 $y \\mid f \\sim \\mathcal{N}(f, \\sigma_n^2 I_n)$，在测试点 $x$ 处，潜在函数 $f(x)$ 的后验分布是一个高斯分布 $f(x) \\mid \\mathbf{y} \\sim \\mathcal{N}(\\mu_*(x), \\sigma_*^2(x))$，其中 $\\mathbf{y} = [y_1, \\dots, y_n]^T$。后验均值和方差由以下公式给出：\n$$\n\\mu_*(x) = m(x) + k_*(x)^T (K_\\theta + \\sigma_n^2 I_n)^{-1} (\\mathbf{y} - \\mathbf{m})\n$$\n$$\n\\sigma_*^2(x) = k_\\theta(x,x) - k_*(x)^T (K_\\theta + \\sigma_n^2 I_n)^{-1} k_*(x)\n$$\n此处，$K_\\theta$ 是 $n \\times n$ 的核矩阵，其元素为 $(K_\\theta)_{ij} = k_\\theta(x_i, x_j)$，$k_*(x)$ 是训练点与测试点 $x$ 之间协方差的 $n \\times 1$ 向量，其元素为 $(k_*(x))_i = k_\\theta(x_i, x)$，而 $\\mathbf{m}$ 是训练点处先验均值的向量，$(\\mathbf{m})_i = m(x_i)$。\n\n观测数据 $\\mathbf{y}$ 是一个随机过程的实现：$\\mathbf{y} = \\mathbf{f}_{true} + \\boldsymbol{\\varepsilon}$，其中 $\\mathbf{f}_{true} = [f(x_1), \\dots, f(x_n)]^T$ 且 $\\boldsymbol{\\varepsilon} \\sim \\mathcal{N}(0, \\Sigma_\\tau)$，$\\Sigma_\\tau = \\text{diag}(\\tau_1^2, \\dots, \\tau_n^2)$。\n\n将此代入后验均值表达式：\n$$\n\\mu_*(x) = m(x) + k_*(x)^T (K_\\theta + \\sigma_n^2 I_n)^{-1} (\\mathbf{f}_{true} + \\boldsymbol{\\varepsilon} - \\mathbf{m})\n$$\n偏差 $b(x)$ 和估计器方差 $v(x)$ 取决于 $\\mu_*(x)$ 在真实噪声 $\\boldsymbol{\\varepsilon}$ 的各种实现上的统计特性：\n\n**偏差：** $b(x) = \\mathbb{E}_{\\boldsymbol{\\varepsilon}}[\\mu_*(x)] - f(x)$\n$$\n\\mathbb{E}_{\\boldsymbol{\\varepsilon}}[\\mu_*(x)] = m(x) + k_*(x)^T (K_\\theta + \\sigma_n^2 I_n)^{-1} (\\mathbf{f}_{true} - \\mathbf{m}) + k_*(x)^T (K_\\theta + \\sigma_n^2 I_n)^{-1} \\mathbb{E}_{\\boldsymbol{\\varepsilon}}[\\boldsymbol{\\varepsilon}]\n$$\n由于 $\\mathbb{E}_{\\boldsymbol{\\varepsilon}}[\\boldsymbol{\\varepsilon}] = \\mathbf{0}$，偏差为：\n$$\nb(x) = \\left( m(x) + k_*(x)^T (K_\\theta + \\sigma_n^2 I_n)^{-1} (\\mathbf{f}_{true} - \\mathbf{m}) \\right) - f(x)\n$$\n\n**估计器方差：** $v(x) = \\operatorname{Var}_{\\boldsymbol{\\varepsilon}}[\\mu_*(x)]$\n$$\nv(x) = \\operatorname{Var}_{\\boldsymbol{\\varepsilon}}\\left[k_*(x)^T (K_\\theta + \\sigma_n^2 I_n)^{-1} \\boldsymbol{\\varepsilon}\\right]\n$$\n使用公式 $\\operatorname{Var}(A\\mathbf{z}) = A\\operatorname{Cov}(\\mathbf{z})A^T$：\n$$\nv(x) = k_*(x)^T (K_\\theta + \\sigma_n^2 I_n)^{-1} \\Sigma_\\tau (K_\\theta + \\sigma_n^2 I_n)^{-1} k_*(x)\n$$\n注意矩阵 $(K_\\theta + \\sigma_n^2 I_n)^{-1}$ 是对称的。\n\n### 逐项分析\n\n**A. 如果数据实际上是带噪声的，而 $\\sigma_n^2 = 0$，那么模拟器将在训练输入点上对观测值 $y_i$ 进行插值，导致对 $f$ 的偏差较低，但在蒙特卡洛重复实验中估计器方差 $v(x)$ 较高，并且在任何训练输入 $x_i$ 处，潜在函数 $f$ 的后验方差将坍缩到 0。**\n\n- **插值：** 当 $\\sigma_n^2 = 0$ 时，在训练点 $x_j$ 的后验均值为 $\\mu_*(x_j) = m(x_j) + k_*(x_j)^T K_\\theta^{-1} (\\mathbf{y} - \\mathbf{m})$。由于 $k_*(x_j)$ 是 $K_\\theta$ 的第 $j$ 列，$k_*(x_j)^T K_\\theta^{-1}$ 是第 $j$ 个标准基向量 $e_j^T$。因此，$\\mu_*(x_j) = m(x_j) + e_j^T(\\mathbf{y} - \\mathbf{m}) = m_j + (y_j - m_j) = y_j$。模拟器完美地插值了带噪声的数据 $\\mathbf{y}$，这是过拟合的一个标志。这部分是正确的。\n- **在 $x_i$ 处的后验方差：** 当 $\\sigma_n^2 = 0$ 时，在 $x_j$ 处的后验方差为 $\\sigma_*^2(x_j) = k_\\theta(x_j, x_j) - k_*(x_j)^T K_\\theta^{-1} k_*(x_j)$。使用 $k_*(x_j)^T K_\\theta^{-1} = e_j^T$，这变成 $\\sigma_*^2(x_j) = k_\\theta(x_j, x_j) - e_j^T k_*(x_j) = k_\\theta(x_j, x_j) - (K_\\theta)_{jj} = 0$。模型对其在训练点上的潜在函数值变得完全确定，将其赋值为带噪声的观测值。这部分是正确的。\n- **估计器方差 $v(x)$：** 当 $\\sigma_n^2 = 0$ 时，$v(x) = k_*(x)^T K_\\theta^{-1} \\Sigma_\\tau K_\\theta^{-1} k_*(x)$。由于数据是带噪声的，真实的噪声协方差 $\\Sigma_\\tau$ 具有正的对角线元素，所以 $\\Sigma_\\tau$ 不是零矩阵。核矩阵的逆 $K_\\theta^{-1}$ 通常会包含大的元素，特别是对于间距很近的点。由此产生的 $v(x)$ 会很大，因为预测器 $\\mu_*(x)$ 必须剧烈变化以穿过每一个带噪声的数据点，这使其对特定的噪声实现 $\\boldsymbol{\\varepsilon}$ 高度敏感。“高估计器方差”是正确的。\n- **偏差：** 平均的预测器是 $\\mathbb{E}_{\\boldsymbol{\\varepsilon}}[\\mu_*(x)] = m(x) + k_*(x)^T K_\\theta^{-1}(\\mathbf{f}_{true} - \\mathbf{m})$。这是真实、去噪后的函数值的 GP 插值。这个插值的偏差 $b(x) = \\mathbb{E}_{\\boldsymbol{\\varepsilon}}[\\mu_*(x)] - f(x)$，如果真实函数 $f(x)$ 能被 GP 模型很好地近似，则可以认为是“低的”。在偏差-方差权衡的背景下，这种情况代表了高方差、低偏差的范畴。虽然“低偏差”这个词可以商榷，但与高度正则化模型的大偏差相比，它在上下文中是合理的。\n鉴于其他三个论断都是对 GP 过拟合的明确和正确的描述，整个陈述是准确的。\n\n结论：**正确**。\n\n**B. 当 $\\sigma_n^2 \\to \\infty$ 时，后验均值 $\\mu_*(x)$ 回归到先验均值 $m(x)$，后验方差 $\\sigma_*^2(x)$ 趋近于先验方差 $k_\\theta(x,x)$，这反映了来自数据的信息损失。在此极限下，估计器方差 $v(x)$ 减小，而偏差的绝对值 $|b(x)|$ 增加，除非 $m(x) = f(x)$。**\n\n- **$\\mu_*(x)$ 的极限：** 当 $\\sigma_n^2 \\to \\infty$ 时，$(K_\\theta + \\sigma_n^2 I_n) \\approx \\sigma_n^2 I_n$。其逆为 $(K_\\theta + \\sigma_n^2 I_n)^{-1} \\approx \\frac{1}{\\sigma_n^2}I_n$。所以，更新项 $k_*(x)^T (K_\\theta + \\sigma_n^2 I_n)^{-1} (\\mathbf{y} - \\mathbf{m}) \\to \\mathbf{0}$。因此，$\\lim_{\\sigma_n^2 \\to \\infty} \\mu_*(x) = m(x)$。后验均值回归到先验均值。这是正确的。\n- **$\\sigma_*^2(x)$ 的极限：** 当 $\\sigma_n^2 \\to \\infty$ 时，项 $k_*(x)^T (K_\\theta + \\sigma_n^2 I_n)^{-1} k_*(x) \\to \\mathbf{0}$。因此，$\\lim_{\\sigma_n^2 \\to \\infty} \\sigma_*^2(x) = k_\\theta(x,x)$。后验方差回归到先验方差。这反映了来自数据的完全信息损失。这是正确的。\n- **估计器方差 $v(x)$：** 当 $\\sigma_n^2 \\to \\infty$ 时，$v(x) \\approx k_*(x)^T (\\frac{1}{\\sigma_n^2}I_n) \\Sigma_\\tau (\\frac{1}{\\sigma_n^2}I_n) k_*(x) = \\frac{1}{\\sigma_n^4} k_*(x)^T \\Sigma_\\tau k_*(x)$。这显然趋近于 0。估计器变得确定性（$\\mu_*(x) \\to m(x)$）并且对噪声 $\\boldsymbol{\\varepsilon}$ 不敏感。这是正确的。\n- **偏差 $|b(x)|$：** 当 $\\sigma_n^2 \\to \\infty$ 时，$\\mathbb{E}_{\\boldsymbol{\\varepsilon}}[\\mu_*(x)] \\to m(x)$。极限偏差为 $m(x) - f(x)$。除非先验均值恰好与真实函数完全匹配，否则此偏差将非零。随着数据被越来越多地忽略，模型欠拟合得更严重，偏差增加到 $|m(x) - f(x)|$。这是正确的。\n这个陈述的所有部分都准确地描述了极端欠拟合的情况。\n\n结论：**正确**。\n\n**C. 当每个设计点的蒙特卡洛噪声方差 $\\{\\tau_i^2\\}$ 可用时，模拟带噪声的蒙特卡洛代码的最优选择总是设置 $\\sigma_n^2 = 0$，因为高斯过程核 $k_\\theta$ 可以通过其长度尺度和振幅来学习随机噪声。**\n\n这个陈述在根本上是有缺陷的。\n- 核 $k_\\theta$ 的作用是模拟潜在函数 $f(x)$ 的协方差，即其平滑度、振幅和其他结构特性。块金项（在似然中）的作用是模拟观测噪声。将这两者混为一谈是一个概念性错误。虽然 $k_\\theta$ 中一个非常短的长度尺度可以允许 GP 拟合噪声，但这是通过将基础函数本身建模为高度不规则来实现的，这通常不是目标。\n- 如选项 A 的分析所示，对带噪声的数据设置 $\\sigma_n^2 = 0$ 会迫使模拟器对噪声进行插值，导致过拟合和预测器对特定噪声实现的高度敏感性（高估计器方差）。这几乎永远不是一个“最优选择”。\n- 当 $\\{\\tau_i^2\\}$ 已知时，正确的方法是使用异方差似然，其中噪声协方差矩阵为 $\\Sigma_\\tau = \\text{diag}(\\tau_1^2, \\dots, \\tau_n^2)$。那么需要求逆的矩阵将是 $K_\\theta + \\Sigma_\\tau$。在设定不当的同方差模型中设置 $\\sigma_n^2 = 0$ 是这个正确程序的糟糕替代品。\n\n结论：**错误**。\n\n**D. 即使对于确定性代码（即真实观测噪声为 0），引入一个小的正“块金”（有时称为数值抖动）也可以改善协方差矩阵 $K_\\theta + \\sigma_n^2 I_n$ 的条件数，从而减少矩阵求逆中的数值误差。**\n\n- 对于确定性代码，真实噪声为零（$\\tau_i^2 = 0$），正确的统计模型将使用 $\\sigma_n^2 = 0$。那么需要求逆的矩阵就是核矩阵 $K_\\theta$。\n- 核矩阵 $K_\\theta$ 是半正定的。如果任何两个训练点 $x_i$ 和 $x_j$ 非常接近，那么 $K_\\theta$ 的相应行/列将几乎相同，使得该矩阵病态（即具有非常大的条件数，某些特征值接近于 0）。\n- 对一个病态矩阵求逆在数值上是不稳定的，可能导致大的误差。\n- 在对角线元素上加上一个小的正项 $\\sigma_n^2 > 0$ 构成了矩阵 $K_\\theta + \\sigma_n^2 I_n$。这个操作将 $K_\\theta$ 的每个特征值都增加了 $\\sigma_n^2$。如果原始特征值是 $\\lambda_j \\ge 0$，那么新的特征值是 $\\lambda_j' = \\lambda_j + \\sigma_n^2 \\ge \\sigma_n^2 > 0$。这将小的特征值从零“抬起”，通常会减小条件数 $\\lambda'_{max}/\\lambda'_{min}$，并使矩阵变为严格正定，从而在求逆时数值上更稳定。这是许多 GP 软件包中的一个标准、必不可少的实践。\n\n结论：**正确**。\n\n**E. 增加 $\\sigma_n^2$ 总是会减小所有测试输入 $x$ 处的后验预测方差 $\\sigma_*^2(x)$，因为随着“块金”的增长，模型会轻视噪声波动。**\n\n让我们分析 $\\sigma_*^2(x)$ 对 $\\sigma_n^2$ 的依赖关系：\n$$\n\\sigma_*^2(x) = k_\\theta(x,x) - k_*(x)^T (K_\\theta + \\sigma_n^2 I_n)^{-1} k_*(x)\n$$\n让我们分析项 $Q(\\sigma_n^2) = k_*(x)^T (K_\\theta + \\sigma_n^2 I_n)^{-1} k_*(x)$。考虑两个值 $\\sigma_{n,1}^2  \\sigma_{n,2}^2$。令 $M_1 = K_\\theta + \\sigma_{n,1}^2 I_n$ 和 $M_2 = K_\\theta + \\sigma_{n,2}^2 I_n$。那么 $M_2 - M_1 = (\\sigma_{n,2}^2 - \\sigma_{n,1}^2)I_n$ 是一个正定矩阵。这意味着在勒夫纳序中 $M_2 > M_1$。对于正定矩阵，如果 $A > B$，则 $B^{-1} > A^{-1}$。因此，$(K_\\theta + \\sigma_{n,1}^2 I_n)^{-1} > (K_\\theta + \\sigma_{n,2}^2 I_n)^{-1}$。\n这意味着二次型 $Q(\\sigma_n^2)$ 是 $\\sigma_n^2$ 的一个递减函数。\n由于 $\\sigma_*^2(x) = k_\\theta(x,x) - Q(\\sigma_n^2)$，并且 $Q(\\sigma_n^2)$ 是一个递减函数，因此 $\\sigma_*^2(x)$ 必须是 $\\sigma_n^2$ 的一个*递增*函数。\n直观地看，增加假设的观测噪声 $\\sigma_n^2$ 意味着我们对数据点 $\\{y_i\\}$ 的信任度降低。对数据的信任度降低意味着数据为减少我们对潜在函数 $f$ 的不确定性所提供的信息更少。因此，我们对 $f(x)$ 的后验不确定性（方差）会增加，当 $\\sigma_n^2 \\to \\infty$ 时趋向于先验方差 $k_\\theta(x,x)$。该陈述声称的恰恰相反。\n\n结论：**错误**。", "answer": "$$\\boxed{ABD}$$", "id": "3561171"}, {"introduction": "任何模型的构建都必须伴随着严格的验证，高斯过程模拟器也不例外，尤其是在推断基础物理参数等高风险应用中。一个设定不当的模拟器可能会导致有偏见或过于自信的科学结论。本练习将您置于一个真实的核物理研究场景中，挑战您区分有效和无效的模型诊断技术，从而培养在模拟器辅助推断中确保结果可靠性的批判性技能。[@problem_id:3561193]", "problem": "在用于核可观测量的手征有效场论 (EFT) 中，对低能常数 (LEC) 进行模拟器辅助推断时，一个计算成本高昂的正向代码 $\\mathcal{C}$ 将参数向量 $\\boldsymbol{\\theta}\\in\\mathbb{R}^p$ 映射到对原子核的预测可观测量 $\\mathbf{y}(\\boldsymbol{\\theta};A,Z)\\in\\mathbb{R}^N$。这些原子核由 $n=1,\\dots,N$ 索引，其质量数为 $A_n$，质子数为 $Z_n$。观测模型假设 $\\mathbf{d}\\in\\mathbb{R}^N$ 是 $\\mathbf{y}$ 的带噪声版本，其似然基于一个经过充分检验的规则，例如加性高斯噪声：$\\mathbf{d}\\mid\\mathbf{y},\\sigma^2\\sim\\mathcal{N}(\\mathbf{y},\\sigma^2\\mathbf{I})$，其中 $\\sigma^2$ 是一个讨厌尺度参数。由于 $\\mathcal{C}$ 的计算成本高昂，一个高斯过程 (GP) 模拟器 $\\mathcal{E}$ 在 $M$ 个设计点 $\\{\\boldsymbol{\\theta}_m\\}_{m=1}^M$ 及其对应的代码输出上进行训练，以表示映射 $\\boldsymbol{\\theta}\\mapsto \\mathbf{y}(\\boldsymbol{\\theta})$。GP 先验指定了均值函数 $m(\\boldsymbol{\\theta})$ 和带有超参数 $\\boldsymbol{\\phi}$ 的协方差核 $k_{\\boldsymbol{\\phi}}(\\boldsymbol{\\theta},\\boldsymbol{\\theta}')$，从而为新输入下的 $\\mathbf{y}(\\boldsymbol{\\theta})$ 生成一个预测分布。在模拟器辅助的马尔可夫链蒙特卡洛 (MCMC) 中，LEC 的后验为 $p(\\boldsymbol{\\theta}\\mid\\mathbf{d})\\propto p(\\mathbf{d}\\mid\\boldsymbol{\\theta})p(\\boldsymbol{\\theta})$，其中 $p(\\mathbf{d}\\mid\\boldsymbol{\\theta})$ 是通过将模拟器对 $\\mathbf{y}(\\boldsymbol{\\theta})$ 的预测分布与观测模型以及任何代码-数据差异项相结合来计算的。\n\n模型检验的基本贝叶斯原理使用后验预测分布 $p(\\tilde{\\mathbf{d}}\\mid\\mathbf{d})=\\int p(\\tilde{\\mathbf{d}}\\mid\\boldsymbol{\\theta})\\,p(\\boldsymbol{\\theta}\\mid\\mathbf{d})\\,\\mathrm{d}\\boldsymbol{\\theta}$，而跨组（例如，质量数区域）的可交换性概念表明，如果模拟器设定良好，训练出的预测行为应该能在这些组之间迁移。一个误设的 GP 模拟器可能导致对 $\\boldsymbol{\\theta}$ 产生有偏或过度自信的后验，尤其是在外推到 $(A,Z)$ 中代表性不足的区域时，或者当核函数对急剧变化的特征拟合不足时。\n\n考虑以下用于在这种情况下诊断 GP 误设的提议。选择所有在科学上合理且能有效检测影响 $p(\\boldsymbol{\\theta}\\mid\\mathbf{d})$ 的模拟器误设的选项：\n\nA. 实施“留一区域法”验证，根据 $A$（或 $(A,Z)$）将原子核划分为不相交的质量数区间 $\\{\\mathcal{R}_1,\\dots,\\mathcal{R}_R\\}$。对于每个 $r$，在 $\\mathcal{D}\\setminus\\mathcal{R}_r$ 上重新训练 $\\mathcal{E}$，预测留出的 $\\mathcal{R}_r$，并评估所有 $n\\in\\mathcal{R}_r$ 的标准化预测误差 $e_n$ 和可信区间的覆盖率；某些 $\\mathcal{R}_r$ 相对于样本内行为表现出的持续偏差或覆盖不足表明存在误设。\n\nB. 通过从 $p(\\boldsymbol{\\theta}\\mid\\mathbf{d})$ 中抽取 $\\boldsymbol{\\theta}^{(s)}$，通过 $\\mathcal{E}$ 和观测模型生成重复数据 $\\tilde{\\mathbf{d}}^{(s)}\\sim p(\\tilde{\\mathbf{d}}\\mid\\boldsymbol{\\theta}^{(s)})$，计算摘要统计量 $T(\\tilde{\\mathbf{d}}^{(s)})$，并将 $T(\\tilde{\\mathbf{d}})$ 的分布与观测到的 $T(\\mathbf{d})$ 进行比较，来构建后验预测检验；大的差异（例如，极端的后验预测尾部概率）表明模拟器存在缺陷。\n\nC. 依赖 Metropolis–Hastings 接受率 $\\alpha$ 作为主要诊断工具：如果 $\\alpha>0.3$，则模拟器设定良好。\n\nD. 仅通过训练设计上 GP 核矩阵 $\\mathbf{K}$ 的条件数 $\\kappa$ 来判断设定是否良好；如果 $\\kappa$ 低于一个固定阈值，则模拟器足以用于对 $\\boldsymbol{\\theta}$ 的推断。\n\nE. 仅检查 GP 超参数后验 $p(\\boldsymbol{\\phi}\\mid\\mathcal{D})$ 的集中程度；如果 $p(\\boldsymbol{\\phi}\\mid\\mathcal{D})$ 呈尖锐峰值，则模拟器设定良好，无需进一步检查。\n\n选择正确的选项。", "solution": "诊断统计模型（尤其像GP模拟器这样的代理模型）的误设，对于确保后续推断的可靠性至关重要。其目标是检测模拟器的假设（例如，核函数的选择、平稳性）是否被违反，以至于会损害目标参数的后验分布 $p(\\boldsymbol{\\theta}\\mid\\mathbf{d})$。\n\nA. 该提议描述了一种形式的交叉验证，称为“留一组法”或在本例中的“留一区域法”。这种方法通过在数据的子集上训练模拟器，并在一个留出的子集上测试其预测性能，来直接评估模拟器的泛化能力。如果模拟器对于未见过的数据区域（例如，特定的质量数范围）持续表现出有偏的预测或糟糕的不确定性量化（例如，可信区间的覆盖率不足），这强烈表明模拟器存在误设（例如，核函数的选择不当或超参数无法适应新区域），并且不能被信任用于泛化。这是一种诊断模型误设的标准且强大的统计技术。因此，该选项是**正确的**。\n\nB. 该提议描述了后验预测检验，这是贝叶斯模型检验的基石。其基本原理是，如果一个模型是对数据生成过程的良好描述，那么从该模型生成的重复数据应该“看起来”像观测到的数据。通过将真实数据的摘要统计量 $T(\\mathbf{d})$ 与从重复数据计算出的同一统计量的分布 $T(\\tilde{\\mathbf{d}})$ 进行比较，我们可以评估模型是否捕捉到了数据的关键特征。如果 $T(\\mathbf{d})$ 位于 $T(\\tilde{\\mathbf{d}})$ 分布的尾部，这表明模型与数据之间存在不匹配，指示了潜在的误设（可能源于模拟器、似然或先验）。这是一种诊断模型（包括其模拟器组件）缺陷的稳健方法。因此，该选项是**正确的**。\n\nC. Metropolis–Hastings 接受率 $\\alpha$ 是 MCMC 采样器效率的诊断指标。一个“良好”的接受率（通常建议在 0.2 到 0.5 之间）表明采样器正在有效地探索后验分布，避免了过高或过低的拒绝率。然而，它完全没有提供关于被采样的后验分布 $p(\\boldsymbol{\\theta}\\mid\\mathbf{d})$ 本身是否准确地代表了给定数据下的参数知识的任何信息。一个高效的采样器可以完美地从一个因模拟器误设而严重有偏的后验分布中抽样。因此，接受率不能用于诊断模型设定是否良好。因此，该选项是**不正确的**。\n\nD. GP 核矩阵 $\\mathbf{K}$ 的条件数 $\\kappa$ 衡量的是涉及该矩阵的计算的数值稳定性。高条件数（病态矩阵）可能在计算 GP 后验或优化超参数时导致数值不稳定，例如矩阵求逆不准确。虽然一个极高的条件数可能表明训练点过于密集或核函数选择不当，但一个“良好”的低条件数仅仅保证了计算的数值可靠性。它并不验证 GP 模型本身（例如，其均值函数或核函数的形式）是否是底层物理过程的一个良好表示。一个数值稳定的 GP 仍然可能存在严重误设。因此，该选项是**不正确的**。\n\nE. GP 超参数的后验分布 $p(\\boldsymbol{\\phi}\\mid\\mathcal{D})$ 反映了在给定数据和模型结构（即所选的核函数）的情况下，哪些超参数值是可信的。一个尖锐的后验峰值表明数据对超参数（例如，长度尺度或信号方差）有很强的约束。然而，这一切都发生在所选模型族的框架内。它并不能验证该模型族（例如，具有特定核函数的 GP）是否从根本上适合描述数据。数据可能强烈偏好某个给定核函数的某个超参数值，但该核函数本身可能完全无法捕捉物理代码输出的真实行为（例如，非平稳性）。因此，超参数后验的集中程度不足以作为模型设定良好的证据。因此，该选项是**不正确的**。", "answer": "$$\n\\boxed{AB}\n$$", "id": "3561193"}]}