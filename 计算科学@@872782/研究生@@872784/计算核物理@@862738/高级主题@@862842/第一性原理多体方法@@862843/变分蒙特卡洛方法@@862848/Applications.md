## 应用与跨学科联系

### 引言

在前面的章节中，我们已经介绍了[变分蒙特卡罗](@entry_id:141537)（Variational [Monte Carlo](@entry_id:144354), VMC）方法的基本原理和机制。我们看到，通过结合变分原理和蒙特卡罗积分，VMC 为求解[多体量子系统](@entry_id:161678)的薛定谔方程提供了一个强大而灵活的框架。然而，该方法的真正威力体现在其解决复杂、现实世界问题的能力上。前面的讨论主要集中在可以用解析方法处理的理想化模型上，而本章的目标是展示 VMC 如何被应用于更广泛、更具挑战性的领域，从而弥合理论与实践之间的差距。

本章将不再重复 VMC 的核心概念，而是将重点放在展示其在不同学科背景下的实用性、扩展性和整合性。我们将从其在核结构物理中的核心应用开始，探索如何构建现实的[波函数](@entry_id:147440)来描述复杂的核力。接着，我们将讨论用于处理大规模 VMC 计算的先进优化和分析技术。然后，我们将拓宽视野，考察 VMC 在凝聚态物理和冷原子物理等其他量子系统研究中的跨学科联系。最后，我们将探讨该领域令人兴奋的前沿——VMC 与机器学习的融合，这为解决[量子多体问题](@entry_id:146763)开辟了全新的途径。通过这些实例，我们将看到 VMC 不仅仅是一个理论工具，更是一个活跃的研究领域，不断推动着我们对量子世界理解的边界。

### 核结构物理中的[变分蒙特卡罗方法](@entry_id:756549)

VMC 在[第一性原理计算](@entry_id:198754)[核子](@entry_id:158389)（质子和中子）构成的[原子核](@entry_id:167902)[基态](@entry_id:150928)和低[激发态](@entry_id:261453)性质方面，扮演着至关重要的角色。这些计算的目标是，从描述[核子](@entry_id:158389)间相互作用的基本[哈密顿量](@entry_id:172864)出发，预测[原子核](@entry_id:167902)的[结合能](@entry_id:143405)、半径、密度[分布](@entry_id:182848)等可观测量。

#### 从简单模型到现实[原子核](@entry_id:167902)

VMC 方法可以直观地应用于简化的[原子核模型](@entry_id:145182)。例如，我们可以将氘核（一个质子和一个中子组成的束缚态）模型化为一个在[中心势](@entry_id:148563)（如高斯[势阱](@entry_id:151413)）中运动的二体系统。通过选择一个简单的、含可调参数（例如高斯函数的宽度）的试探波函数，VMC 提供了一个完整的数值方案：首先，根据[试探波函数](@entry_id:142892)所对应的[概率分布](@entry_id:146404)进行构型抽样；其次，计算每个构型下的局域能量；最后，通过对所有样本的局域能量进行平均来估计变分能。通过最小化该能量，我们可以获得系统基态能量的近似值。这个简单的例子完整地展示了 VMC 的工作流程，并为更复杂的系统奠定了基础。[@problem_id:2466731]

当转向包含多个[核子](@entry_id:158389)的现实[原子核](@entry_id:167902)（如拥有8个质子和8个中子的 doubly magic nucleus $^{16}\mathrm{O}$）时，[试探波函数](@entry_id:142892)的构造变得更加复杂。一个典型的出发点是基于核壳层模型。首先，我们将总的试探波函数表示为一个反对称化的[参考态](@entry_id:151465)（通常是单个[斯莱特行列式](@entry_id:139034)或其乘积）与一个描述[核子](@entry_id:158389)间关联的关联算符（例如 [Jastrow 因子](@entry_id:158362)）的乘积。对于参考态，我们可以用一组单粒子[轨道](@entry_id:137151)来构建。由于质子和中子是可区分的[费米子](@entry_id:146235)，因此体系的[波函数](@entry_id:147440)必须在交换任意两个质子或任意两个中子时分别表现出反对称性。这可以通过构造一个质子[斯莱特行列式](@entry_id:139034)和一个中子斯莱特行列式的乘积来实现。

这些单粒子[轨道](@entry_id:137151)通常选择在谐振子势的基底下展开，这种选择既方便又具有物理合理性。[谐振子基](@entry_id:750178)底由一个关键的参数——[振子](@entry_id:271549)长度 $b$ ——来表征。这个参数在 VMC 计算中扮演着至关重要的变分参数角色。改变 $b$ 会同时缩放所有单粒子[轨道](@entry_id:137151)的空间尺度（例如，[均方根半径](@entry_id:146552) $\langle r^2 \rangle \propto b^2$）和动能尺度（$\langle T \rangle \propto 1/b^2$）。根据里兹变分原理，通过调节 $b$，我们可以使试探波函数在动能和[势能](@entry_id:748988)之间达到最佳平衡，从而最小化总能量的[期望值](@entry_id:153208)，以最接近真实[原子核](@entry_id:167902)的尺寸和[结合能](@entry_id:143405)。值得注意的是，对于像 $^{16}\mathrm{O}$ 这样的自旋饱和（spin-saturated）且同位旋不混合的体系，将质子和中子分别处理（质子-中子形式）与在一个包含同位旋自由度的统一框架下处理（同位旋形式）是等价的。[@problem_id:3610658]

#### 构建现实的[试探波函数](@entry_id:142892)

为了达到高精度，试探波函数必须精确地反映[核力](@entry_id:143248)的复杂性质。现代的[核哈密顿量](@entry_id:752710)不仅包含[中心力](@entry_id:267832)，还包含依赖于[核子](@entry_id:158389)自旋和[同位旋](@entry_id:199830)的复杂算符结构。

**张量关联 (Tensor Correlations)**

核力一个显著的特征是其强大的非中心（张量）部分，这对[原子核](@entry_id:167902)的结合至关重要。在长程范围，这种张量相互作用主要由[单π介子交换势](@entry_id:161092)（OPEP）驱动。一个高质量的 VMC [试探波函数](@entry_id:142892)必须能够捕捉到这种关联。这通常通过在[波函数](@entry_id:147440)中引入依赖于算符的关联因子来实现，其中最重要的就是张量关联项，其形式通常为 $f_T(r_{ij}) S_{12}(\hat{\boldsymbol{r}}_{ij}) (\boldsymbol{\tau}_i \cdot \boldsymbol{\tau}_j)$。这里的 $f_T(r)$ 是一个径向关联函数，而 $S_{12}$ 是[张量算符](@entry_id:203590)。

$f_T(r)$ 的函数形式并非任意，而是受到深刻的物理约束。首先，在长程极限下（$r \to \infty$），它必须能够匹配 OPEP 的行为，以正确描述长程物理。其次，在短程极限下（$r \to 0$），为了避免局域能量中的动能项（涉及对[波函数](@entry_id:147440)的拉普拉斯运算）出现发散，关联函数必须足够光滑。通常要求 $f_T(r)$ 及其[一阶导数](@entry_id:749425)在原点为零。一个满足这些条件的函数形式示例是，将 OPEP 的径向部分与一个在短程抑制其发散行为、在长程趋于1的调节因子相乘，例如 $\left[1-\exp(-(r/R_c)^n)\right]^m$ 形式的因子，其中 $n$ 和 $m$ 的选择需保证必要的平滑性。[@problem_id:3610704]

**[同位旋](@entry_id:199830)破缺与[库仑相互作用](@entry_id:747947) (Isospin Breaking and the Coulomb Interaction)**

尽管强相互作用在很大程度上是同位旋对称的（即它对质子和中子一视同仁），但现实[原子核](@entry_id:167902)的[哈密顿量](@entry_id:172864)中包含了破坏这种对称性的项，其中最主要的是质子之间的[库仑排斥](@entry_id:181876)作用。这个长程的 $1/r$ 势给 VMC 计算带来了新的挑战。

为了确保 VMC 计算的数值稳定性，局域能量的[方差](@entry_id:200758)必须是有限的。然而，当两个质子相互靠近时（$r_{pp'} \to 0$），[库仑势能](@entry_id:263842)项 $e^2/r_{pp'}$ 会发散。为了抵消这个发散，[试探波函数](@entry_id:142892)必须满足一个精确的“[尖点条件](@entry_id:190416)”（cusp condition）。这意味着在 $r_{pp'} \to 0$ 时，[波函数](@entry_id:147440)的对数梯度必须有一个特定的线性行为，从而使得局域动能项的发散能够精确地抵消掉[势能](@entry_id:748988)项的发散。为了在[波函数](@entry_id:147440)中实现这一点，必须引入区分粒子种类的关联因子，即质子-质子（pp）、质子-中子（pn）和中子-中子（nn）对的关联函数必须是不同的。特别是，pp 关联函数必须被精心设计以满足库仑[尖点条件](@entry_id:190416)。不满足这些条件的[试探波函数](@entry_id:142892)会导致局域[能量方差](@entry_id:156656)的爆炸，使得 VMC 计算无法进行。[@problem_id:3610713]

#### 处理复杂[哈密顿量](@entry_id:172864)

**[三体力](@entry_id:159489) (Three-Body Forces)**

为了精确地再现[轻核](@entry_id:751275)的性质（例如[结合能](@entry_id:143405)和谱）以及核物质的饱和性质，仅考虑两体相互作用是不够的。高精度的[核物理](@entry_id:136661)计算必须包含[三体](@entry_id:265960)[核力](@entry_id:143248)（Three-Nucleon Interactions, 3NI）。像 Urbana IX (UIX) 或 Illinois 系列这样的唯象和半[唯象模型](@entry_id:273816)是 VMC 计算中常用的[三体力](@entry_id:159489)模型。

在 VMC 框架下计算这些[三体力](@entry_id:159489)对能量的贡献是一个计算密集型的任务。以 UIX 力为例，它通常包含一个吸引性的、与双[π介子交换](@entry_id:162149)相关的部分和一个唯象的排斥部分。排斥部分通常是依赖于三个[核子](@entry_id:158389)间距离的标量函数，其对局域能量的贡献是乘性的，计算相对直接。然而，吸引部分具有复杂的算符结构，包含自旋、[同位旋](@entry_id:199830)和[张量算符](@entry_id:203590)的乘积，并且对三个[核子](@entry_id:158389)的指标 $(i,j,k)$ 进行循环求和。由于[试探波函数](@entry_id:142892)通常不是这些算符的[本征态](@entry_id:149904)，计算它们对局域能量的贡献 $\Psi_T^{-1} V_{ijk} \Psi_T$ 就不能简单地用其[期望值](@entry_id:153208)代替。正确的做法是，在每个蒙特卡罗步中，对每个[核子](@entry_id:158389)三元组 $(i,j,k)$，计算完整的算符 $V_{ijk}$ 作用在当前自旋-同位旋构型上的结果。这可能涉及到一个构型到另一个构型的跃迁，其贡献通过计算两个构型下[波函数](@entry_id:147440)振幅的比值来获得。将所有三元组的贡献求和，就得到了[三体力](@entry_id:159489)对总局域能量的贡献。[@problem_g_id:3610706]

### 先进的优化与分析技术

随着 VMC 应用于更复杂的系统，对优化算法和分析工具的要求也越来越高。简单的[最速下降法](@entry_id:140448)已经不足以有效地在巨大的参数空间中寻找最优变分参数。

#### 随机重构方法

随机重构（Stochastic Reconfiguration, SR）方法，在机器学习领域也被称为自然梯度法（Natural Gradient），是一种用于 VMC [参数优化](@entry_id:151785)的前沿技术。与在[欧几里得空间](@entry_id:138052)中沿[最速下降](@entry_id:141858)方向更新参数的传统梯度下降法不同，SR 方法考虑了[量子态空间](@entry_id:197873)的几何结构。

物理上不同的归一化[量子态](@entry_id:146142)构成一个[射影希尔伯特空间](@entry_id:188975)。这个空间具有非平庸的几何结构，其度规由所谓的[量子几何](@entry_id:147695)张量（Quantum Geometric Tensor）或 Fubini-Study 度规给出。SR 方法正是在这个几何空间中执行梯度下降。参数的更新方向由求解一个线性方程组 $S \delta\boldsymbol{\alpha} = -\mathbf{g}$ 得到。其中，$\mathbf{g}$ 是能量对变分参数的梯度，其分量 $g_j = \langle (E_L - \bar{E}) O_j \rangle$ 是局域能量与[波函数](@entry_id:147440)对数梯度算符 $O_j = \partial_{\alpha_j} \ln \Psi_T$ 之间的协[方差](@entry_id:200758)。而关键的矩阵 $S$ 则是这个度规张量在 VMC 中的估计，其[矩阵元](@entry_id:186505) $S_{ij} = \langle O_i O_j \rangle - \langle O_i \rangle \langle O_j \rangle$ 是不同对数梯度算符之间的[协方差矩阵](@entry_id:139155)。

SR 方法具有几个关键优势。首先，它是重参数化不变的，即参数的更新在物理上与参数的具体表示方式无关。其次，它能自动处理参数之间的相关性，从而比标准[梯度下降法](@entry_id:637322)具有更快的收敛速度和更好的稳定性。此外，该方法对于[波函数](@entry_id:147440)的总体归一化因子具有“[规范不变性](@entry_id:137857)”，能够自动识别并避免优化物理上无关的参数。在实践中，由于 $S$ 矩阵是通过有限的蒙特卡罗样本估计的，可能会出现病态或奇异的情况，因此通常需要引入一个小的正则化项来保证数值稳定性。[@problem_id:3610710]

#### [哈密顿量](@entry_id:172864)优化与灵敏度分析

VMC 的应用范畴可以从仅仅优化[波函数](@entry_id:147440)参数，扩展到优化[哈密顿量](@entry_id:172864)本身的参数。这在多个物理场景中都具有重要意义，例如，在[有效场论](@entry_id:145328)中确定[低能常数](@entry_id:751501)，或在[量子控制](@entry_id:136347)中设计最优的外部场来引导系统达到特定状态。

我们可以将[哈密顿量](@entry_id:172864)中的某些参数 $\boldsymbol{\lambda}$ 视为可调的控制参数。在这种情况下，变分能量 $E_{\mathrm{var}}$ 不仅是[波函数](@entry_id:147440)参数 $\boldsymbol{\alpha}$ 的函数，也是 $\boldsymbol{\lambda}$ 的函数。计算能量对这些控制参数的梯度 $\partial E_{\mathrm{var}} / \partial \lambda_a$ 是进行优化的关键。这个梯度通常可以分解为两部分。第一部分来自于[哈密顿量](@entry_id:172864)对 $\lambda_a$ 的显式依赖，可以通过计算算符 $\partial H / \partial \lambda_a$ 的[期望值](@entry_id:153208)得到，这与著名的 Hellmann-Feynman 定理紧密相关。第二部分则来自于试探波函数本身对 $\lambda_a$ 的隐式依赖（例如，[波函数](@entry_id:147440)为响应场的改变而进行调整），这一项的形式与 SR 方法中的能量梯度类似，涉及局域能量和[波函数](@entry_id:147440)对数梯度的协[方差](@entry_id:200758)。如果[试探波函数](@entry_id:142892)与 $\boldsymbol{\lambda}$ 无关，则第二项（有时称为 Pulay 力）为零。[@problem_id:3610689] [@problem_id:3610660]

一个重要的简化发生在所谓的包络定理（envelope theorem）适用的情况下：如果我们假定对于每一个给定的 $\boldsymbol{\lambda}$ 值，[波函数](@entry_id:147440)参数 $\boldsymbol{\alpha}$ 都已经被完全优化（即能量对 $\boldsymbol{\alpha}$ 的梯度为零），那么能量对 $\boldsymbol{\lambda}$ 的总梯度就只剩下 Hellmann-Feynman 项。这为设计嵌套优化循环提供了一个有效策略：在“内循环”中优化[波函数](@entry_id:147440)，在“外循环”中根据简化的梯度更新[哈密顿量](@entry_id:172864)参数。[@problem_id:3610660]

### 跨学科联系

VMC 方法的普适性使其能够被广泛应用于核物理之外的众多[量子多体问题](@entry_id:146763)中，包括凝聚态物理和冷原子物理。

#### 凝聚态物理：量子固体

在[凝聚态物理学](@entry_id:140205)中，VMC 是研究强[关联电子系统](@entry_id:144460)和量子固体（如[固态氦](@entry_id:190838)）性质的有力工具。对于量子固体，一个经典的试探波函数是 Nosanow-Jastrow 形式。该[波函数](@entry_id:147440)巧妙地结合了两种物理图像：一方面，它通过一个高斯型因子将每个原子局域化在其平衡[晶格](@entry_id:196752)位置 $\mathbf{R}_i^0$ 附近，描述了固体的[晶体结构](@entry_id:140373)；另一方面，它包含一个 Jastrow 关联因子，用于描述原子对之间的短程排斥和关联，这对于正确描述系统的液态或固态行为至关重要。

通过为这样一个包含[单体](@entry_id:136559)局域化和二体关联的[波函数](@entry_id:147440)推导局域能量表达式，VMC 算法可以被用来计算系统的[内聚能](@entry_id:139323)、压强、[弹性常数](@entry_id:146207)等宏观性质。变分参数（例如，高斯局域化的宽度和 [Jastrow 因子](@entry_id:158362)的参数）的优化反映了零点[振动](@entry_id:267781)与粒子间相互作用的竞争。[@problem_id:53173]

#### [冷原子](@entry_id:144092)物理：偶极[玻色气体](@entry_id:155364)

近年来，[超冷原子气体](@entry_id:143830)为在高度可控的环境中模拟和研究量子多体物理提供了理想的平台。VMC 方法同样适用于这些系统。例如，考虑一个被约束在二维平面内、在谐振子势阱中运动的[玻色子](@entry_id:138266)系统。如果这些[玻色子](@entry_id:138266)具有垂直于平面的[电偶极矩](@entry_id:178520)或磁偶极矩，它们之间会产生一种长程的、各向异性的 $1/r^3$ 偶极相互作用。

为了研究该系统的[基态](@entry_id:150928)性质，我们可以构造一个 Jastrow 型的乘积试探波函数。该[波函数](@entry_id:147440)包含一个[单体](@entry_id:136559)部分，用于描述粒子在谐振子势阱中的[分布](@entry_id:182848)（例如，一个高斯函数），以及一个二体 Jastrow 关联项，用于模拟粒子间的排斥相互作用。对于 $1/r^3$ 势，[Jastrow 因子](@entry_id:158362)通常选择为 $r$ 的[幂律](@entry_id:143404)形式，如 $(b/r)^\nu$，其参数可以通过变分优化确定。通过推导该系统的局域能量，VMC 可以用于研究这类奇异[量子气体](@entry_id:162017)中的相图、超流性以及各种空间序的形成。这个例子展示了 VMC 适应不同相互作用势和空间维度的灵活性。[@problem_id:1279459]

### 前沿：VMC与机器学习

近年来，VMC 领域最激动人心的进展之一是与机器学习的深度融合，特别是[神经网](@entry_id:276355)络在表示量子[多体波函数](@entry_id:203043)方面的应用。这种新的[范式](@entry_id:161181)被称为“[神经网](@entry_id:276355)路[量子态](@entry_id:146142)”（Neural-network Quantum States, NQS）。

#### 作为[试探波函数](@entry_id:142892)的[神经网](@entry_id:276355)络

传统的[试探波函数](@entry_id:142892)（如斯莱特-Jastrow 型）具有固定的函数形式，其[表达能力](@entry_id:149863)有限。NQS 的核心思想是用一个高度灵活的[神经网](@entry_id:276355)络来[参数化](@entry_id:272587)波[函数的振幅](@entry_id:160674)（或对数振幅）。由于[神经网](@entry_id:276355)络的[通用近似定理](@entry_id:146978)，一个足够大的网络原则上可以表示任何复杂的函数，因此 NQS 有潜力比传统方法更精确地逼近真实的[基态](@entry_id:150928)[波函数](@entry_id:147440)。

一个早期的 NQS 例子是基于[受限玻尔兹曼机](@entry_id:636627)（Restricted Boltzmann Machine, RBM）的[波函数](@entry_id:147440)。对于一个由 $N$ 个粒子组成的[连续系统](@entry_id:178397)，其[波函数](@entry_id:147440)可以写成 $\Psi_T(\mathbf{x}) = \exp(F(\mathbf{x}))$ 的形式，其中 $F(\mathbf{x})$ 是一个由网络参数（权重和偏置）决定的、关于所有粒子坐标 $\mathbf{x}$ 的二次型。给定这种解析形式，我们可以精确地推导出局域能量的表达式，它将直接与网络的参数相联系。然后，就可以使用 VMC 进行抽样，并利用[梯度下降](@entry_id:145942)算法（如 SR 方法）来优化网络参数。[@problem_id:1279428]

更先进的 NQS 架构，如[图神经网络](@entry_id:136853)（Graph Neural Networks, GNN），能够将系统的几何结构（例如，[晶格](@entry_id:196752)的连接性）显式地编码到[网络设计](@entry_id:267673)中。对于一个定义在图上的自spin系统，GNN 可以通过在图上传播和聚合信息来为每个自旋构型计算一个隐藏表示，并最终得到[波函数](@entry_id:147440)的对数振幅。VMC 优化的关键是计算能量对网络权重（如[卷积核](@entry_id:635097)的权重矩阵 $W$）的梯度。利用[链式法则](@entry_id:190743)（即机器学习中的反向传播），我们可以推导出这些梯度的解析表达式。例如，对数振幅对某个权重的导数，可以表示为网络中各层[激活函数](@entry_id:141784)和参数的特定组合。这使得我们可以将强大的、[基于梯度的优化](@entry_id:169228)算法应用于训练[量子波函数](@entry_id:261184)。[@problem_id:1212352]

#### 实践中的意义与挑战

将 NQS 应用于 VMC 和其他量子蒙特卡罗方法，既带来了巨大的机遇，也伴随着新的挑战。

一个关键的协同作用体现在 VMC 与[扩散](@entry_id:141445)蒙特卡罗（Diffusion Monte Carlo, DMC）方法的结合上。DMC 是一种投影方法，原则上比 VMC 更精确，但对于[费米子](@entry_id:146235)系统，它受到[固定节点近似](@entry_id:145482)（fixed-node approximation）的限制，其精度完全取决于所用[试探波函数](@entry_id:142892)的节点[曲面](@entry_id:267450)（即[波函数](@entry_id:147440)为零的位置）。NQS 的强大[表达能力](@entry_id:149863)使其能够学习到比传统[波函数](@entry_id:147440)更精确的[节点结构](@entry_id:151019)。因此，通过 VMC 预训练一个高质量的 NQS，然后将其用于指导一个固定节点 DMC 计算，有望显著减小固定节点误差，从而获得更精确的[基态能量](@entry_id:263704)。[@problem_id:2454186]

然而，NQS 的应用并非没有代价。首先，**计算成本**通常更高。与斯莱特-Jastrow [波函数](@entry_id:147440)（其计算复杂度通常为 $\mathcal{O}(N^3)$）相比，最先进的 NQS（如 FermiNet）的单次评估成本可能扩展为 $\mathcal{O}(N^4)$ 或更高。其次，**[波函数](@entry_id:147440)的平滑性**至关重要。局域能量的计算需要对[波函数](@entry_id:147440)求[二阶导数](@entry_id:144508)。如果网络（例如，使用了 ReLU [激活函数](@entry_id:141784)）不是二次连续可微的（$C^2$），其拉普拉斯项可能在某些点上是奇异的，导致局域[能量方差](@entry_id:156656)发散，从而破坏 VMC 或 DMC 模拟的稳定性。最后，为了获得好的性能，**物理约束**必须被内建到[网络架构](@entry_id:268981)中。一个通用的前馈网络很难自发地“学习”到像[费米子反对称性](@entry_id:749292)或库仑[尖点条件](@entry_id:190416)这样的基本物理原理。因此，成功的 NQS 架构，如 FermiNet，通过在网络输出端使用斯莱特行列式来强制实现[反对称性](@entry_id:261893)，并通过特殊设计的输入特征来精确满足[尖点条件](@entry_id:190416)。这些设计上的考量对于 NQS 在物理问题中的成功应用是不可或缺的。[@problem_id:2454186]