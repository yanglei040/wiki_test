{"hands_on_practices": [{"introduction": "本节的第一个实践练习旨在通过构建一个简化的玩具模型，来直观地展示介质内相似性重整化群（IM-SRG）的核心机制。我们将亲手实现IM-SRG流方程 $\\frac{dH}{ds} = [\\eta(s), H(s)]$，并使用标准的怀特（White）生成元，观察哈密顿量如何随着流参数 $s$ 的演化而趋向于块对角形式。这个练习将为我们理解该方法的基本工作原理打下坚实的基础。[@problem_id:3564791]", "problem": "你需要构建并分析一个有限维、块结构的玩具哈密顿量，该哈密顿量代表相对于一个固定的参考斯莱特行列式，在介质表述中的单粒子-单空穴 ($1p1h$) 和双粒子-双空穴 ($2p2h$) 激发扇区。此问题的基本依据如下：\n\n- 由作用于哈密顿量 $H(0)$ 的幺正算符 $U(s)$ 生成的相似性变换定义为 $H(s) = U(s)\\,H(0)\\,U^{\\dagger}(s)$，其中 $s$ 是一个实的无量纲流参数，$U^{\\dagger}(s)$ 是 $U(s)$ 的厄米共轭。\n- 一个可微的幺正算符 $U(s)$ 满足 $U^{\\dagger}(s)\\,U(s) = I$，其生成元 $\\eta(s)$ 可通过 $\\frac{dU}{ds}(s) = \\eta(s)\\,U(s)$ 来定义，且满足 $\\eta^{\\dagger}(s) = -\\eta(s)$ (反厄米)。\n- 哈密顿量 $H(s)$ 的流方程为 $\\frac{dH}{ds}(s) = [\\eta(s),\\,H(s)]$，其中 $[A,\\,B] = A\\,B - B\\,A$ 表示对易子。\n\n从这些原理出发，为一个玩具哈密顿量推导并实现一个计算演示，该演示关于截断至二体算符的在介质相似性重整化群 (IM-SRG(2))。哈密顿量 $H(s)$ 以对应于两个激发扇区的块矩阵形式表示：\n$$\nH(s) =\n\\begin{pmatrix}\nH_{11}(s)  H_{12}(s) \\\\\nH_{21}(s)  H_{22}(s)\n\\end{pmatrix},\n$$\n其中 $H_{11}(s)$ 作用于维度为 $n_1$ 的 $1p1h$ 扇区内，$H_{22}(s)$ 作用于维度为 $n_2$ 的 $2p2h$ 扇区内，而 $H_{12}(s)$ 及其厄米转置 $H_{21}(s) = H_{12}^{\\dagger}(s)$ 耦合了这两个扇区。这些扇区是相对于一个固定的、归一化的参考斯莱特行列式定义的，并且正规排序是相对于此参考态而言的。IM-SRG(2) 截断通过在此些扇区内工作，并通过构建有限矩阵模型来省略高于二体的导出算符来体现。\n\n你的任务是：\n1. 使用具有指定能量的对角块 $H_{11}(0)$ 和 $H_{22}(0)$，以及指定的实数值非对角耦合 $H_{12}(0)$ 来设计初始哈密顿量 $H(0)$。假设 $H(0)$ 是厄米的。对角块的元素代表限制在各自扇区内的正规排序的零体、一体和二体贡献。单位是任意能量单位，流参数 $s$ 是无量纲的。\n2. 从所述基本原理出发，推导适用于在 IM-SRG(2) 截断下将非对角块 $H_{12}(s)$ 在 $s \\to \\infty$ 时驱动为零的 White 生成元。推导过程需满足反厄米性要求，并使用从对角块推断出的瞬时能量分母。通过一个不破坏反厄米性的正则化子来解决潜在的简并问题。\n3. 对流方程 $\\frac{dH}{ds}(s) = [\\eta(s),\\,H(s)]$ 进行数值实现，并通过积分到一个足够大的最终流参数 $s_{\\text{end}}$ 并计算弗罗贝尼乌斯范数 $\\|H_{12}(s_{\\text{end}})\\|_{\\mathrm{F}}$，来演示非对角块在 $s \\to \\infty$ 时的退耦。\n4. 使用以下初始哈密顿量规格的测试套件（每个情况定义了 $n_1$、$n_2$、对角能量、非对角耦合、正则化参数和最终流参数）：\n   - 情况 1 (理想情况)：$n_1 = 2$，$n_2 = 2$。$H_{11}(0)$ 中的对角能量为 $[\\,0.5,\\,0.9\\,]$，$H_{22}(0)$ 中的对角能量为 $[\\,1.4,\\,2.1\\,]$。非对角块 $H_{12}(0)$ 是\n     $$\n     \\begin{pmatrix}\n     0.2  -0.1 \\\\\n     0.05  0.3\n     \\end{pmatrix}.\n     $$\n     使用正则化子 $\\delta = 10^{-3}$ 和最终流参数 $s_{\\text{end}} = 40$。\n   - 情况 2 (近简并)：$n_1 = 1$，$n_2 = 1$。对角能量 $H_{11}(0) = [\\,1.0\\,]$，$H_{22}(0) = [\\,1.0001\\,]$，以及 $H_{12}(0) = [\\,0.05\\,]$ (一个 $1\\times 1$ 的块)。使用正则化子 $\\delta = 10^{-4}$ 和最终流参数 $s_{\\text{end}} = 80$。\n   - 情况 3 (零耦合边界)：$n_1 = 3$，$n_2 = 2$。$H_{11}(0)$ 中的对角能量为 $[\\,0.3,\\,0.7,\\,1.1\\,]$，$H_{22}(0)$ 中的对角能量为 $[\\,1.6,\\,2.5\\,]$。非对角块 $H_{12}(0)$ 是一个 $3\\times 2$ 的零矩阵。使用正则化子 $\\delta = 10^{-3}$ 和最终流参数 $s_{\\text{end}} = 20$。\n\n你的程序必须：\n- 根据指定的块构建每个初始 $H(0)$。\n- 对每种情况，使用一种保持厄米性在数值容差范围内的刚性、稳定方法，将流方程 $\\frac{dH}{ds} = [\\eta(H),\\,H]$ 从 $s = 0$ 积分到 $s = s_{\\text{end}}$。\n- 在 $s = s_{\\text{end}}$ 时，计算每种情况的弗罗贝尼乌斯范数 $\\|H_{12}(s_{\\text{end}})\\|_{\\mathrm{F}}$。\n- 生成单行输出，包含三个结果，形式为逗号分隔并用方括号括起来的列表，例如 $[r_1,r_2,r_3]$，其中每个 $r_i$ 是表示为浮点数的弗罗贝尼乌斯范数。由于 $s$ 是无量纲的，且玩具能量单位是任意的，因此不需要单位。\n\n最终程序必须是完整且可运行的，无需任何用户输入，并且必须遵守指定的执行环境。输出应为浮点数，捕捉每种测试情况下非对角退耦的幅度。", "solution": "我们从幺正相似性变换的原理出发。设 $U(s)$ 是一个由实的无量纲流参数 $s$ 参数化的幺正算符，作用于初始哈密顿量 $H(0)$。定义 $H(s) = U(s)\\,H(0)\\,U^{\\dagger}(s)$，其中 $U^{\\dagger}(s)\\,U(s) = I$。我们通过 $\\frac{dU}{ds}(s) = \\eta(s)\\,U(s)$ 定义生成元 $\\eta(s)$，幺正性条件意味着 $\\eta(s)$ 是反厄米的，即 $\\eta^{\\dagger}(s) = -\\eta(s)$。通过对 $H(s)$ 求导，并使用乘积法则，我们得到 $\\frac{dH}{ds}(s) = \\frac{dU}{ds}(s)\\,H(0)\\,U^{\\dagger}(s) + U(s)\\,H(0)\\,\\frac{dU^{\\dagger}}{ds}(s)$。使用 $\\frac{dU}{ds}(s) = \\eta(s)\\,U(s)$ 和 $\\frac{dU^{\\dagger}}{ds}(s) = -U^{\\dagger}(s)\\,\\eta(s)$，上式变为 $\\eta(s)U(s)H(0)U^\\dagger(s) + U(s)H(0)(-U^\\dagger(s)\\eta(s))$。利用 $H(s) = U(s)H(0)U^\\dagger(s)$，我们最终得到流方程：$\\frac{dH}{ds}(s) = \\eta(s)H(s) - H(s)\\eta(s) = [\\eta(s), H(s)]$。这就是构成相似性重整化群基础的流方程。\n\n在介质背景下，正规排序是相对于一个固定的参考斯莱特行列式进行的。截断至二体水平的在介质相似性重整化群 (IM-SRG(2)) 保留了正规排序的零体、一体和二体贡献，同时丢弃了更高阶的导出项。一种演示退耦的常见算法是，将算符表示限制在一个跨越选定激发扇区的有限块矩阵上；在我们的玩具模型中，我们考虑两个扇区：维度为 $n_1$ 的单粒子-单空穴 ($1p1h$) 扇区和维度为 $n_2$ 的双粒子-双空穴 ($2p2h$) 扇区。哈密顿量于是表示为\n$$\nH(s) =\n\\begin{pmatrix}\nH_{11}(s)  H_{12}(s) \\\\\nH_{21}(s)  H_{22}(s)\n\\end{pmatrix},\n$$\n其中 $H_{21}(s) = H_{12}^{\\dagger}(s)$ 以确保厄米性。\n\n为推导出一个能驱动退耦的 White 生成元，我们从两个要求开始：\n- $\\eta(s)$ 必须是反厄米的，即 $\\eta^{\\dagger}(s) = -\\eta(s)$。\n- 生成元的构造必须能使非对角块 $H_{12}(s)$ 随着 $s$ 的增加而被抑制。\n\n考虑瞬时对角块 $H_{11}(s)$ 和 $H_{22}(s)$，并将其对角元素定义为能量向量 $\\mathbf{e}_1(s) = \\operatorname{diag}\\left(H_{11}(s)\\right)$ 和 $\\mathbf{e}_2(s) = \\operatorname{diag}\\left(H_{22}(s)\\right)$。对于每一对 $(i,\\alpha)$，其中 $i \\in \\{1,\\dots,n_1\\}$ 且 $\\alpha \\in \\{1,\\dots,n_2\\}$，定义能量分母\n$$\n\\Delta_{i\\alpha}(s) = e_{2,\\alpha}(s) - e_{1,i}(s).\n$$\n为处理近简并情况，我们引入一个正则化子 $\\delta > 0$ 并定义一个正则化分母\n$$\n\\Delta^{\\mathrm{reg}}_{i\\alpha}(s) = \\operatorname{sign}\\!\\left(\\Delta_{i\\alpha}(s)\\right)\\,\\max\\!\\left(\\left|\\Delta_{i\\alpha}(s)\\right|,\\,\\delta\\right),\n$$\n这在保持符号结构的同时避免了除以零，并且在一致使用时能保持反厄米性。非对角块 $H_{12}(s)$ 是一个 $n_1 \\times n_2$ 矩阵，其元素为 $H_{12}(s)_{i\\alpha}$。我们将 White 生成元构造为一个块反厄米矩阵\n$$\n\\eta(s) =\n\\begin{pmatrix}\n0  W(s) \\\\\n- W^{\\dagger}(s)  0\n\\end{pmatrix},\n\\quad\nW(s)_{i\\alpha} = -\\frac{H_{12}(s)_{i\\alpha}}{\\Delta^{\\mathrm{reg}}_{i\\alpha}(s)}.\n$$\n选择负号是为了在最简单的 $2\\times 2$ 情况中，即 $H(s) = \\begin{pmatrix} e_1(s)  v(s) \\\\ v(s)  e_2(s) \\end{pmatrix}$，非对角元素的流满足\n$$\n\\frac{dv}{ds}(s) = \\left[e_2(s) - e_1(s)\\right]\\,\\eta_{12}(s) = \\Delta(s)\\,\\left(-\\frac{v(s)}{\\Delta^{\\mathrm{reg}}(s)}\\right) \\approx -v(s)\n$$\n只要 $\\Delta^{\\mathrm{reg}}(s)$ 接近 $\\Delta(s)$（即远离简并）或在近简并时等于 $\\delta\\,\\operatorname{sign}(\\Delta)$，从而确保 $v(s)$ 随 $s$ 指数级抑制。这表明 $H_{12}(s)$ 在 $s \\to \\infty$ 时被驱动为零，因此各扇区在 IM-SRG 流下退耦。一般的块情形逐元素地继承了这种行为，但会受到所有矩阵元素间对易代数的修正。\n\n在数值上，我们积分常微分方程\n$$\n\\frac{dH}{ds}(s) = [\\,\\eta(H(s)),\\,H(s)\\,]\n$$\n其中 $\\eta(H)$ 如上所述。因为流方程可能是刚性的——尤其是在能量间隔大或耦合强的情况下——我们使用具有严格容差的刚性求解器，以在数值精度内保持厄米性。在每一步中，我们：\n- 将状态向量重塑为矩阵 $H(s)$。\n- 提取 $H_{11}(s)$、$H_{22}(s)$ 和 $H_{12}(s)$。\n- 计算瞬时对角元 $\\mathbf{e}_1(s)$ 和 $\\mathbf{e}_2(s)$。\n- 构建逐元素的正则化分母 $\\Delta^{\\mathrm{reg}}_{i\\alpha}(s)$。\n- 构造 $W(s)$，进而构造反厄米的 $\\eta(s)$。\n- 计算对易子 $[\\,\\eta(s),\\,H(s)\\,]$。\n\n然后我们积分到最终的 $s_{\\text{end}}$。在 $s = s_{\\text{end}}$ 时，我们计算弗罗贝尼乌斯范数\n$$\n\\|H_{12}(s_{\\text{end}})\\|_{\\mathrm{F}} = \\sqrt{\\sum_{i=1}^{n_1} \\sum_{\\alpha=1}^{n_2} \\left|H_{12}(s_{\\text{end}})_{i\\alpha}\\right|^2},\n$$\n它量化了扇区间的残余耦合。对于指定的测试套件：\n- 情况 1 使用 $n_1 = 2$，$n_2 = 2$，$H_{11}(0)$ 的对角项为 $[\\,0.5,\\,0.9\\,]$，$H_{22}(0)$ 的对角项为 $[\\,1.4,\\,2.1\\,]$，$H_{12}(0)$ 为\n  $$\n  \\begin{pmatrix}\n  0.2  -0.1 \\\\\n  0.05  0.3\n  \\end{pmatrix},\n  $$\n  正则化子 $\\delta = 10^{-3}$，以及 $s_{\\text{end}} = 40$。\n- 情况 2 使用 $n_1 = 1$，$n_2 = 1$，对角项为 $[\\,1.0\\,]$ 和 $[\\,1.0001\\,]$，$H_{12}(0) = [\\,0.05\\,]$，$\\delta = 10^{-4}$，以及 $s_{\\text{end}} = 80$。\n- 情况 3 使用 $n_1 = 3$，$n_2 = 2$，对角项为 $[\\,0.3,\\,0.7,\\,1.1\\,]$ 和 $[\\,1.6,\\,2.5\\,]$，$H_{12}(0) = 0$ 矩阵，$\\delta = 10^{-3}$，以及 $s_{\\text{end}} = 20$。\n\n我们期望在情况 1 和情况 2 中弗罗贝尼乌斯范数 $\\|H_{12}(s_{\\text{end}})\\|_{\\mathrm{F}}$ 会非常小，因为成功实现了退耦（其中情况2由于近简并可能退耦较慢，但由于 $\\delta$ 的存在仍会被抑制），而在情况3中，由于构造上没有耦合，且流方程会使零非对角元保持不变，所以结果精确为零。\n\n程序将实现此逻辑，对每种情况使用刚性求解器积分流方程，并打印一行 $[r_1,r_2,r_3]$，其中 $r_i$ 是情况 1、2 和 3 的弗罗贝尼乌斯范数，表示为浮点数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef white_generator_eta(H, n1, n2, delta):\n    \"\"\"\n    Construct the anti-Hermitian White generator eta for a block Hamiltonian H.\n    Blocks:\n      H11: top-left (n1 x n1)\n      H12: top-right (n1 x n2)\n      H21: bottom-left (n2 x n1)\n      H22: bottom-right (n2 x n2)\n    White generator (real case):\n      eta = [[0, W], [-W^T, 0]]\n    with W_ij = - H12_ij / Delta_reg_ij, Delta_reg_ij = sign(Delta_ij) * max(|Delta_ij|, delta),\n    and Delta_ij = e2_j - e1_i using instantaneous diagonals e1, e2.\n    \"\"\"\n    # Extract blocks\n    H11 = H[:n1, :n1]\n    H12 = H[:n1, n1:]\n    H22 = H[n1:, n1:]\n\n    # Instantaneous diagonals\n    e1 = np.diag(H11)\n    e2 = np.diag(H22)\n\n    # Build denominators for each element of H12: Delta_{i,alpha} = e2_alpha - e1_i\n    # Shape: (n1, n2)\n    Delta = e2[np.newaxis, :] - e1[:, np.newaxis]\n    # Regularize denominators to avoid division by zero\n    sign = np.sign(Delta)\n    # For exactly zero, set sign to +1 to preserve anti-Hermitian structure\n    sign[sign == 0.0] = 1.0\n    Delta_reg = sign * np.maximum(np.abs(Delta), delta)\n\n    # Construct W with element-wise division\n    W = - H12 / Delta_reg\n\n    # Assemble eta\n    eta = np.zeros_like(H)\n    eta[:n1, n1:] = W\n    eta[n1:, :n1] = -W.T  # real case; for complex, use -W.conj().T\n\n    return eta\n\ndef imsrg_flow_rhs(s, y, n1, n2, delta):\n    \"\"\"\n    Right-hand side of the IM-SRG flow: dH/ds = [eta(H), H].\n    y is the flattened H matrix.\n    \"\"\"\n    dim = n1 + n2\n    H = y.reshape((dim, dim))\n\n    # Construct White generator\n    eta = white_generator_eta(H, n1, n2, delta)\n\n    # Compute commutator\n    dHds = eta @ H - H @ eta\n\n    return dHds.reshape(-1)\n\ndef integrate_flow(n1, n2, H11_diag, H22_diag, H12_init, s_end, delta):\n    \"\"\"\n    Integrate the IM-SRG flow for the specified toy Hamiltonian.\n    Returns the Frobenius norm of the off-diagonal block H12 at s_end.\n    \"\"\"\n    # Build initial H(0)\n    H11 = np.diag(np.array(H11_diag, dtype=float))\n    H22 = np.diag(np.array(H22_diag, dtype=float))\n    H12 = np.array(H12_init, dtype=float)\n\n    # Validate dimensions\n    assert H11.shape == (n1, n1)\n    assert H22.shape == (n2, n2)\n    assert H12.shape == (n1, n2)\n\n    # Assemble full H\n    dim = n1 + n2\n    H0 = np.zeros((dim, dim), dtype=float)\n    H0[:n1, :n1] = H11\n    H0[n1:, n1:] = H22\n    H0[:n1, n1:] = H12\n    H0[n1:, :n1] = H12.T\n\n    # Flatten\n    y0 = H0.reshape(-1)\n\n    # Integrate using a stiff solver\n    sol = solve_ivp(\n        fun=lambda s, y: imsrg_flow_rhs(s, y, n1, n2, delta),\n        t_span=(0.0, s_end),\n        y0=y0,\n        method='BDF',\n        rtol=1e-9,\n        atol=1e-12,\n        max_step=np.inf,\n    )\n\n    # Retrieve final H and re-symmetrize to mitigate numerical drift\n    Hf = sol.y[:, -1].reshape((dim, dim))\n    Hf = 0.5 * (Hf + Hf.T)  # enforce Hermiticity in real case\n\n    # Extract final off-diagonal block H12\n    H12_f = Hf[:n1, n1:]\n\n    # Frobenius norm\n    frob = np.linalg.norm(H12_f, ord='fro')\n    return frob\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: n1=2, n2=2\n        {\n            \"n1\": 2,\n            \"n2\": 2,\n            \"H11_diag\": [0.5, 0.9],\n            \"H22_diag\": [1.4, 2.1],\n            \"H12_init\": [[0.2, -0.1],\n                         [0.05, 0.3]],\n            \"s_end\": 40.0,\n            \"delta\": 1e-3,\n        },\n        # Case 2: near degeneracy, n1=1, n2=1\n        {\n            \"n1\": 1,\n            \"n2\": 1,\n            \"H11_diag\": [1.0],\n            \"H22_diag\": [1.0001],\n            \"H12_init\": [[0.05]],\n            \"s_end\": 80.0,\n            \"delta\": 1e-4,\n        },\n        # Case 3: zero coupling boundary, n1=3, n2=2\n        {\n            \"n1\": 3,\n            \"n2\": 2,\n            \"H11_diag\": [0.3, 0.7, 1.1],\n            \"H22_diag\": [1.6, 2.5],\n            \"H12_init\": [[0.0, 0.0],\n                         [0.0, 0.0],\n                         [0.0, 0.0]],\n            \"s_end\": 20.0,\n            \"delta\": 1e-3,\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        frob = integrate_flow(\n            n1=case[\"n1\"],\n            n2=case[\"n2\"],\n            H11_diag=case[\"H11_diag\"],\n            H22_diag=case[\"H22_diag\"],\n            H12_init=case[\"H12_init\"],\n            s_end=case[\"s_end\"],\n            delta=case[\"delta\"],\n        )\n        # Append float result; format with full precision of Python's default str\n        results.append(frob)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3564791"}, {"introduction": "在现实世界的IM-SRG计算中，我们总是需要进行截断，例如，在正规序二体算符水平上进行截断（称为IM-SRG(2)）。这个实践练习将探讨这种关键近似所带来的后果。通过构建一个包含三体相互作用的简化模型，我们可以直接比较IM-SRG(2)和IM-SRG(3)计算得到的基态能量，从而定量地估计由截断引入的误差。[@problem_id:3564801]", "problem": "考虑一个由 $A$ 个无相互作用的费米子占据有限单粒子基中最低能量单粒子轨道的闭壳层参考斯莱特行列式 $|\\Phi\\rangle$。在介质内相似性重整化群 (In-Medium Similarity Renormalization Group, IM-SRG) 方法中，我们从相对于 $|\\Phi\\rangle$ 正规排序的二次量子化哈密顿量出发，\n$$\n\\hat{H} \\equiv E_0 + \\sum_{ij} f_{ij} \\{ a_i^\\dagger a_j \\} + \\frac{1}{4} \\sum_{ijkl} \\Gamma_{ijkl} \\{ a_i^\\dagger a_j^\\dagger a_l a_k \\} + \\frac{1}{36} \\sum_{ijklmn} W_{ijklmn} \\{ a_i^\\dagger a_j^\\dagger a_k^\\dagger a_n a_m a_l \\},\n$$\n其中花括号表示相对于 $|\\Phi\\rangle$ 的正规排序，$E_0$ 是零体（标量）贡献，$f_{ij}$ 是一体张量，$\\Gamma_{ijkl}$ 是正规排序的二体张量，而 $W_{ijklmn}$ 是剩余的正规排序三体张量。IM-SRG($2$) 截断保留 $E_0$、$f$ 和 $\\Gamma$，并忽略剩余的三体张量 $W$，而 IM-SRG($3$) 截断也保留 $W$。\n\n在一个能够捕捉闭壳层系统主要关联的简化模型空间中，考虑由三个多体基态张成的子空间：参考态 $|\\Phi\\rangle$，一个代表性的双粒子-双空穴激发态 $|2p2h\\rangle \\equiv a_{p_1}^\\dagger a_{p_2}^\\dagger a_{h_2} a_{h_1} |\\Phi\\rangle$，以及一个代表性的三粒子-三空穴激发态 $|3p3h\\rangle \\equiv a_{p_1}^\\dagger a_{p_2}^\\dagger a_{p_3}^\\dagger a_{h_3} a_{h_2} a_{h_1} |\\Phi\\rangle$，其中 $\\{h_1,h_2,h_3\\}$ 标记 $|\\Phi\\rangle$ 中的已占据空穴轨道，$\\{p_1,p_2,p_3\\}$ 标记未占据的粒子轨道。假设：\n- 对角能量由以下公式近似\n$$\nE_0 = \\sum_{i \\in \\text{holes}} \\varepsilon_i + E_{\\text{hh}} + E_{\\text{occ}}^{(3)},\n$$\n$$\nE_{2} = E_0 + \\left( \\varepsilon_{p_1} + \\varepsilon_{p_2} - \\varepsilon_{h_1} - \\varepsilon_{h_2} \\right) + \\Delta_{2},\n$$\n$$\nE_{3} = E_0 + \\left( \\varepsilon_{p_1} + \\varepsilon_{p_2} + \\varepsilon_{p_3} - \\varepsilon_{h_1} - \\varepsilon_{h_2} - \\varepsilon_{h_3} \\right) + \\Delta_{3},\n$$\n其中 $\\varepsilon_i$ 是单粒子能量，$E_{\\text{hh}}$ 汇总了空穴间的净二体贡献，$E_{\\text{occ}}^{(3)}$ 汇总了来自已占据空穴间三体相互作用的正规排序零体收缩项，而 $\\Delta_{2}$、$\\Delta_{3}$ 分别是相应激发分区内的对角相互作用位移。\n- 非对角耦合被限制为\n$$\n\\langle \\Phi | \\hat{H} | 2p2h \\rangle = g_{2}^{\\text{eff}} \\equiv g_{2}^{(0)} + c_{W},\n$$\n$$\n\\langle \\Phi | \\hat{H} | 3p3h \\rangle = g_{3},\n$$\n并且该子空间内的所有其他耦合均设为零。这里 $g_{2}^{(0)}$ 是直接的二体耦合振幅，$c_{W}$ 是由三体相互作用的正规排序（将 $W$ 的一部分映射到 $\\Gamma$）引起的有效二体贡献，而 $g_{3}$ 参数化了在 IM-SRG($2$) 中被忽略但在 IM-SRG($3$) 中保留的剩余正规排序三体耦合。\n\n在这个三态子空间内，将 IM-SRG($2$) 哈密顿矩阵定义为\n$$\nH^{(2)} =\n\\begin{pmatrix}\nE_0  g_{2}^{\\text{eff}} \\\\\ng_{2}^{\\text{eff}}  E_{2}\n\\end{pmatrix},\n$$\n并将 IM-SRG($3$) 哈密顿矩阵定义为\n$$\nH^{(3)} =\n\\begin{pmatrix}\nE_0  g_{2}^{\\text{eff}}  g_{3} \\\\\ng_{2}^{\\text{eff}}  E_{2}  0 \\\\\ng_{3}  0  E_{3}\n\\end{pmatrix}.\n$$\n对角化 $H^{(2)}$ 和 $H^{(3)}$ 分别得到基态能量 $E_{\\text{gs}}^{(2)}$ 和 $E_{\\text{gs}}^{(3)}$。由于相似性重整化群的解耦是幺正的，因此在完全解耦的基中，基态能量等于所选子空间中哈密顿量的最小本征值。因此，忽略剩余正规排序三体项所引入的误差的一个实用估计是\n$$\n\\delta E \\equiv E_{\\text{gs}}^{(2)} - E_{\\text{gs}}^{(3)}.\n$$\n\n你的任务是编写一个程序，对下面给出的每组参数，构建 $H^{(2)}$ 和 $H^{(3)}$，将它们对角化，并以兆电子伏特 (MeV) 为单位，输出一个四舍五入到六位小数的浮点数 $\\delta E$。\n\n使用以下测试套件（每个案例指定了 $\\{\\varepsilon_{h_1},\\varepsilon_{h_2},\\varepsilon_{h_3}\\}$、$\\{\\varepsilon_{p_1},\\varepsilon_{p_2},\\varepsilon_{p_3}\\}$、$E_{\\text{hh}}$、$E_{\\text{occ}}^{(3)}$、$g_{2}^{(0)}$、$c_{W}$、$g_{3}$、$\\Delta_{2}$、$\\Delta_{3}$），所有能量单位均为 MeV：\n- 案例 1：空穴 $\\{-15.5,-14.2,-13.7\\}$，粒子 $\\{-1.8,0.7,2.2\\}$，$E_{\\text{hh}}=-12.0$，$E_{\\text{occ}}^{(3)}=-1.5$，$g_{2}^{(0)}=-2.0$，$c_{W}=-0.3$，$g_{3}=-0.5$，$\\Delta_{2}=0.9$，$\\Delta_{3}=0.4$。\n- 案例 2：空穴 $\\{-12.0,-11.5,-10.8\\}$，粒子 $\\{-2.0,0.0,1.0\\}$，$E_{\\text{hh}}=-10.0$，$E_{\\text{occ}}^{(3)}=-0.8$，$g_{2}^{(0)}=-1.5$，$c_{W}=-0.2$，$g_{3}=0.0$，$\\Delta_{2}=0.5$，$\\Delta_{3}=0.3$。\n- 案例 3：空穴 $\\{-16.0,-15.2,-14.1\\}$，粒子 $\\{-3.0,-1.0,0.5\\}$，$E_{\\text{hh}}=-13.0$，$E_{\\text{occ}}^{(3)}=-2.2$，$g_{2}^{(0)}=-1.0$，$c_{W}=-0.4$，$g_{3}=-4.0$，$\\Delta_{2}=0.7$，$\\Delta_{3}=0.9$。\n- 案例 4：空穴 $\\{-10.0,-9.5,-9.0\\}$，粒子 $\\{-9.0,-8.8,-8.5\\}$，$E_{\\text{hh}}=-8.0$，$E_{\\text{occ}}^{(3)}=-0.5$，$g_{2}^{(0)}=-3.0$，$c_{W}=-0.5$，$g_{3}=-1.0$，$\\Delta_{2}=-0.2$，$\\Delta_{3}=0.1$。\n\n你的程序应该生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，例如 $[\\delta E_1,\\delta E_2,\\delta E_3,\\delta E_4]$，其中每个 $\\delta E$ 都四舍五入到六位小数，并以 MeV 为单位表示。", "solution": "该问题已经过审查并被确定是有效的。它在科学上基于量子多体理论的原理，特别是在计算核物理中使用的介质内相似性重整化群 (IM-SRG) 方法。该问题定义明确、自成体系，并提供了构建和对角化相关哈密顿矩阵所需的所有参数和定义。任务是计算一个特定量 $\\delta E$，它代表了将 IM-SRG 展开截断在二体水平 (IM-SRG($2$)) 相对于三体水平 (IM-SRG($3$)) 所引入的误差估计。这是物理学中评估理论模型截断误差的标准程序。\n\n对每个给定的参数集解决此问题的步骤如下：\n首先，我们构建哈密顿矩阵 $H^{(2)}$ 和 $H^{(3)}$ 的对角和非对角元。\n参考能量 $E_0$ 是已占据空穴态的单粒子能量之和，加上这些空穴间的二体 ($E_{\\text{hh}}$) 和三体 ($E_{\\text{occ}}^{(3)}$) 相互作用的贡献。\n$$\nE_0 = \\sum_{i \\in \\text{holes}} \\varepsilon_i + E_{\\text{hh}} + E_{\\text{occ}}^{(3)}\n$$\n双粒子-双空穴 ($2p2h$) 态的能量 $E_2$ 是参考能量加上产生两个粒子和两个空穴的未微扰激发能，再由对角相互作用位移 $\\Delta_2$ 校正。\n$$\nE_{2} = E_0 + \\left( \\varepsilon_{p_1} + \\varepsilon_{p_2} - \\varepsilon_{h_1} - \\varepsilon_{h_2} \\right) + \\Delta_{2}\n$$\n类似地，三粒子-三空穴 ($3p3h$) 态的能量 $E_3$ 由下式给出：\n$$\nE_{3} = E_0 + \\left( \\varepsilon_{p_1} + \\varepsilon_{p_2} + \\varepsilon_{p_3} - \\varepsilon_{h_1} - \\varepsilon_{h_2} - \\varepsilon_{h_3} \\right) + \\Delta_{3}\n$$\n参考态 $|\\Phi\\rangle$ 和 $|2p2h\\rangle$ 态之间的非对角耦合是有效二体矩阵元 $g_{2}^{\\text{eff}}$，它包括裸耦合 $g_{2}^{(0)}$ 和来自三体力正规排序的导出项 $c_W$。\n$$\ng_{2}^{\\text{eff}} = g_{2}^{(0)} + c_{W}\n$$\n$|\\Phi\\rangle$ 和 $|3p3h\\rangle$ 态之间的耦合由剩余的正规排序三体振幅 $g_3$ 给出。\n\n有了这些矩阵元，IM-SRG($2$) 哈密顿矩阵在 $\\{|\\Phi\\rangle, |2p2h\\rangle\\}$ 基中构建如下：\n$$\nH^{(2)} =\n\\begin{pmatrix}\nE_0  g_{2}^{\\text{eff}} \\\\\ng_{2}^{\\text{eff}}  E_{2}\n\\end{pmatrix}\n$$\nIM-SRG($3$) 哈密顿量在 $\\{|\\Phi\\rangle, |2p2h\\rangle, |3p3h\\rangle\\}$ 基中构建。问题陈述，除了指定的耦合外，其他耦合均为零，这意味着 $\\langle 2p2h|\\hat{H}|3p3h \\rangle = 0$。\n$$\nH^{(3)} =\n\\begin{pmatrix}\nE_0  g_{2}^{\\text{eff}}  g_{3} \\\\\ng_{2}^{\\text{eff}}  E_{2}  0 \\\\\ng_{3}  0  E_{3}\n\\end{pmatrix}\n$$\n在每个截断内的基态能量 $E_{\\text{gs}}^{(2)}$ 和 $E_{\\text{gs}}^{(3)}$ 分别是相应哈密顿矩阵的最低本征值。对于 $2 \\times 2$ 矩阵 $H^{(2)}$，本征值由特征方程的解给出：\n$$\n\\lambda_{\\pm}^{(2)} = \\frac{1}{2} \\left( (E_0 + E_2) \\pm \\sqrt{(E_0 - E_2)^2 + 4 (g_{2}^{\\text{eff}})^2} \\right)\n$$\n基态能量是较小的本征值，$E_{\\text{gs}}^{(2)} = \\lambda_{-}^{(2)}$。\n对于 $3 \\times 3$ 矩阵 $H^{(3)}$，本征值是三次特征多项式的根。最直接的方法是数值求解。由于 $H^{(2)}$ 和 $H^{(3)}$ 是实对称（厄米）的，它们的本征值是实数。我们寻求最小本征值 $E_{\\text{gs}}^{(3)}$。\n最后，由于忽略剩余三体项而产生的估计误差计算如下：\n$$\n\\delta E = E_{\\text{gs}}^{(2)} - E_{\\text{gs}}^{(3)}\n$$\n对提供的四组参数集中的每一组都执行此计算。然后将结果四舍五入到六位小数，并以要求的格式呈现。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the error estimate δE by constructing and diagonalizing\n    IM-SRG(2) and IM-SRG(3) Hamiltonian matrices for a simplified 3-state system.\n    \"\"\"\n    \n    # Each tuple contains:\n    # (holes_eps, particles_eps, E_hh, E_occ3, g2_0, c_W, g3, Delta2, Delta3)\n    test_cases = [\n        # Case 1\n        (\n            np.array([-15.5, -14.2, -13.7]),\n            np.array([-1.8, 0.7, 2.2]),\n            -12.0, -1.5, -2.0, -0.3, -0.5, 0.9, 0.4\n        ),\n        # Case 2\n        (\n            np.array([-12.0, -11.5, -10.8]),\n            np.array([-2.0, 0.0, 1.0]),\n            -10.0, -0.8, -1.5, -0.2, 0.0, 0.5, 0.3\n        ),\n        # Case 3\n        (\n            np.array([-16.0, -15.2, -14.1]),\n            np.array([-3.0, -1.0, 0.5]),\n            -13.0, -2.2, -1.0, -0.4, -4.0, 0.7, 0.9\n        ),\n        # Case 4\n        (\n            np.array([-10.0, -9.5, -9.0]),\n            np.array([-9.0, -8.8, -8.5]),\n            -8.0, -0.5, -3.0, -0.5, -1.0, -0.2, 0.1\n        )\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        holes_eps, particles_eps, E_hh, E_occ3, g2_0, c_W, g3, Delta2, Delta3 = case\n        \n        # Unpack single-particle energies for clarity in formulas\n        eps_h1, eps_h2, eps_h3 = holes_eps\n        eps_p1, eps_p2, eps_p3 = particles_eps\n        \n        # Calculate matrix elements\n        # E_0: Reference state energy\n        E0 = np.sum(holes_eps) + E_hh + E_occ3\n        \n        # E_2: 2p2h state energy\n        E2 = E0 + (eps_p1 + eps_p2 - eps_h1 - eps_h2) + Delta2\n        \n        # E_3: 3p3h state energy\n        E3 = E0 + (eps_p1 + eps_p2 + eps_p3 - eps_h1 - eps_h2 - eps_h3) + Delta3\n        \n        # g2_eff: Effective 2-body coupling\n        g2_eff = g2_0 + c_W\n        \n        # Construct H(2) matrix (2x2)\n        H2 = np.array([\n            [E0, g2_eff],\n            [g2_eff, E2]\n        ])\n        \n        # Construct H(3) matrix (3x3)\n        H3 = np.array([\n            [E0, g2_eff, g3],\n            [g2_eff, E2, 0.0],\n            [g3, 0.0, E3]\n        ])\n        \n        # Diagonalize matrices to find the lowest eigenvalue (ground state energy)\n        # eigvalsh is used for Hermitian (real-symmetric) matrices.\n        E_gs_2 = np.min(np.linalg.eigvalsh(H2))\n        E_gs_3 = np.min(np.linalg.eigvalsh(H3))\n        \n        # Calculate the error estimate delta_E\n        delta_E = E_gs_2 - E_gs_3\n        \n        # Round to 6 decimal places and append to results\n        results.append(round(delta_E, 6))\n\n    # Format the final output string as specified\n    output_str = f\"[{','.join(f'{r:.6f}' for r in results)}]\"\n    print(output_str)\n\nsolve()\n```", "id": "3564801"}]}