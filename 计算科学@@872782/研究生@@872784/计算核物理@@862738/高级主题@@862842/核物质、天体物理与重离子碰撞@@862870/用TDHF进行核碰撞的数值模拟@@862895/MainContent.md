## 引言
[原子核](@entry_id:167902)碰撞是探索核物质性质和[基本相互作用](@entry_id:749649)的独特实验室，但其过程涉及复杂的量子多体动力学，对理论描述提出了巨大挑战。含时哈特里-福克（Time-Dependent Hartree-Fock, TDHF）理论作为一种功能强大的微观动力学方法，提供了一个从基本[核力](@entry_id:143248)出发，自洽地模拟[原子核](@entry_id:167902)碰撞全过程的理论框架。本文旨在全面阐述如何利用TDHF进行核碰撞的数值模拟，弥合微观理论与宏观实验观测量之间的鸿沟。

在接下来的内容中，读者将系统地学习TDHF的完整图景。我们首先将在“原理与机制”一章中，深入探讨TDHF的理论基础、核心方程、数值实现细节以及其内在的物理机制与局限性。随后，在“应用与[交叉](@entry_id:147634)学科联系”一章中，我们将展示如何运用TDHF来计算聚变位垒、散射截面等实验观测量，并探讨其在检验[核力](@entry_id:143248)、研究超流动力学以及与[非平衡统计力学](@entry_id:155589)等领域的交叉应用。最后，“动手实践”部分将通过具体的计算问题，引导读者体验模拟过程中的关键技术环节。

## 原理与机制

在介绍章节之后，我们现在深入探讨含时[哈特里-福克](@entry_id:142303)（Time-Dependent Hartree-Fock, TDHF）理论的物理原理和数值实现机制。本章将从TDHF近似的理论基础出发，详细阐述其核心方程、[哈密顿量](@entry_id:172864)的构造，然后过渡到[数值模拟](@entry_id:137087)的具体算法步骤，包括初态制备、空间与[时间离散化](@entry_id:169380)以及关键物理过程（如耗散）的描述。最后，我们将讨论理论的验证方法及其固有的局限性。

### TDHF的理论基础

TDHF方法是[量子多体问题](@entry_id:146763)的一种[平均场近似](@entry_id:144121)。其核心思想是将复杂的含相互作用的[多体波函数](@entry_id:203043) $\Psi$ 的演化空间，限制在由单个[斯莱特行列式](@entry_id:139034)（Slater determinant）构成的较小子流形上。一个由 $A$ 个[核子](@entry_id:158389)组成的系统的斯莱特行列式[波函数](@entry_id:147440)由一组 $A$ 个正交归一的单粒子[轨道](@entry_id:137151) $\{\phi_k(\mathbf{r},t)\}$ 构成。

系统的动力学由狄拉克-弗伦科尔含时变分原理（Dirac-Frenkel time-dependent variational principle）导出。该原理要求作用量 $S$ 在选定的[变分流形](@entry_id:199701)上取驻值：
$$
\delta S = \delta \int \langle \Psi(t) | i\hbar \frac{\partial}{\partial t} - \hat{H} | \Psi(t) \rangle dt = 0
$$
当将[变分波函数](@entry_id:144043) $|\Psi(t)\rangle$ 限制为单个[斯莱特行列式](@entry_id:139034) $|\Phi(t)\rangle$ 时，该[变分原理](@entry_id:198028)导出了一组描述单粒子[轨道](@entry_id:137151)演化的耦合、[非线性](@entry_id:637147)的类薛定谔方程，即 **TDHF方程**：
$$
i\hbar \frac{\partial}{\partial t} |\phi_k(t)\rangle = h[\rho] |\phi_k(t)\rangle, \quad k=1, \dots, A
$$
这里的 $h[\rho]$ 是自洽的、含时的[单体](@entry_id:136559)[哈特里-福克哈密顿量](@entry_id:196141)。它是一个依赖于[单体密度矩阵](@entry_id:161726) $\rho(t)$ 的泛函。[单体密度矩阵](@entry_id:161726)定义为在占据[轨道](@entry_id:137151)[子空间](@entry_id:150286)上的[投影算符](@entry_id:154142)，其矩阵元为 $\rho_{ji}(t) = \langle \Phi(t) | a_i^\dagger a_j | \Phi(t) \rangle = \sum_{k=1}^A \langle \phi_j(t) | \phi_k(t) \rangle \langle \phi_k(t) | \phi_i(t) \rangle$。整个系统的演化可以用冯·诺依曼形式的[密度矩阵](@entry_id:139892)[运动方程](@entry_id:170720)来表述 [@problem_id:3577393]：
$$
i\hbar \frac{d\rho(t)}{dt} = [h[\rho(t)], \rho(t)]
$$

TDHF近似通过[哈密顿量](@entry_id:172864) $h[\rho]$ 中的福克项（Fock term）精确地包含了反对称性（交换效应），这是[泡利不相容原理](@entry_id:141850)的体现。然而，由于[波函数](@entry_id:147440)被严格限制为单个斯莱特行列式，TDHF忽略了超越平均场范畴的显式两体及更高阶的动力学关联。这些关联需要用多个[斯莱特行列式](@entry_id:139034)的叠加来描述，例如在多组态含时[哈特里-福克](@entry_id:142303)（[MCTDH](@entry_id:203924)F）等更精确的方法中。

TDHF的一个关键数学特征是[单体密度矩阵](@entry_id:161726)的 **[幂等性](@entry_id:190768)**（idempotency）。由于 $\rho$ 是一个投影算符，它在任何时刻都满足 $\rho^2(t) = \rho(t)$。这意味着其[本征值](@entry_id:154894)，即自然[轨道](@entry_id:137151)的占据数，严格地固定为 $0$ 或 $1$。因此，TDHF无法描述从占据态到非占据态的[粒子数转移](@entry_id:170564)，即无法产生分数占据数。分数占据数的出现是动力学关联发展的标志，而这正是TDHF所缺失的 [@problem_id:3577393]。

尽管存在这些近似，TDHF在描述[原子核](@entry_id:167902)的集体运动方面非常成功。例如，在静态哈特里-福克[基态](@entry_id:150928)解附近对TDHF方程进行线性化，可以严格地推导出随机相近似（Random Phase Approximation, RPA），后者是描述[原子核](@entry_id:167902)小振幅集体[振动](@entry_id:267781)的标准理论框架 [@problem_id:3577393]。

### 原子[核[平均](@entry_id:752719)场哈密顿量](@entry_id:751814)

在TDHF计算中，单粒子[哈密顿量](@entry_id:172864) $h[\rho]$ 的具体形式通常由一个[能量密度泛函](@entry_id:161351)（Energy Density Functional, EDF）给出，例如Skyrme或Gogny泛函。以广泛使用的Skyrme EDF为例，总能量是局域密度和流的积分，而单粒子[哈密顿量](@entry_id:172864) $h[\rho]$ 则通过对总能量泛函求变分导数得到。

一个标准的Skyrme EDF依赖于一系列局域的、由单粒子[轨道](@entry_id:137151)构建的密度和流 [@problem_id:3577398]。这些包括（对中子和质子分别定义）：
- **粒子数密度** $\rho_q(\mathbf{r})$：[时间反演](@entry_id:182076)下为偶性（time-even）。
- **动能密度** $\tau_q(\mathbf{r})$：[时间反演](@entry_id:182076)下为偶性。
- **自旋-[轨道](@entry_id:137151)流密度** $\mathbf{J}_q(\mathbf{r})$：[时间反演](@entry_id:182076)下为偶性。
- **流密度** $\mathbf{j}_q(\mathbf{r})$：[时间反演](@entry_id:182076)下为奇性（time-odd）。
- **自旋密度** $\mathbf{s}_q(\mathbf{r})$：时间反演下为奇性。

这些密度在单粒子[哈密顿量](@entry_id:172864) $h[\rho]$ 中扮演不同角色。时间偶性密度（$\rho_q, \tau_q, \mathbf{J}_q$）主要决定了[原子核](@entry_id:167902)的静态性质。它们分别产生[中心势](@entry_id:148563)场 $U_q(\mathbf{r})$、与位置相关的有效质量 $m_q^*(\mathbf{r})$ 以及对壳层结构至关重要的自旋-[轨道](@entry_id:137151)势 $\mathbf{W}_q(\mathbf{r}) \cdot (\mathbf{p} \times \mathbf{s})$。

对于具有[时间反演不变性](@entry_id:152159)的偶偶核的[基态](@entry_id:150928)，所有时间奇性密度（如流密度 $\mathbf{j}_q$ 和[自旋密度](@entry_id:267742) $\mathbf{s}_q$）的[期望值](@entry_id:153208)均为零。然而，在[原子核](@entry_id:167902)碰撞这样的[非平衡动力学](@entry_id:160262)过程中，[时间反演对称性](@entry_id:138094)被破坏，这些时间奇性密度将变为非零。它们会在[哈密顿量](@entry_id:172864)中产生新的项，例如与速度相关的[对流](@entry_id:141806)项和自旋平均场，这些对于正确描述系统的动力学演化至关重要。此外，伽利略不变性等基本对称性要求EDF中时间偶性和时间奇性部分的[耦合常数](@entry_id:747980)之间存在严格的约束关系，以确保物理定律在不同[参考系](@entry_id:169232)下的一致性 [@problem_id:3577398]。

除了核相互作用，质子之间的[库仑相互作用](@entry_id:747947)也必须包含在内。这通常通过求解[泊松方程](@entry_id:143763) $\nabla^2 \phi(\mathbf{r},t) = -4\pi e \rho_p(\mathbf{r},t)$ 来获得库仑势 $\phi(\mathbf{r},t)$，其中 $\rho_p$ 是质子密度。

### TDHF的数值实现

将TDH[F理论](@entry_id:184208)应用于[核碰撞模拟](@entry_id:752693)需要一个稳健的[数值算法](@entry_id:752770)。整个过程可以分解为初态制备、[空间离散化](@entry_id:172158)和[时间演化](@entry_id:153943)三个主要阶段。

#### 初态制备

TDHF碰撞模拟的起点是为入射核和靶核准备物理上合理的[基态](@entry_id:150928)。这需要求解静态的、不含时的[哈特里-福克方程](@entry_id:194386) $h[\rho]\phi_i = \epsilon_i \phi_i$，该过程旨在找到使总能量泛函 $E[\rho]$ 最小的单粒子[轨道](@entry_id:137151)集。一个标准的数值流程如下 [@problem_id:3577454]：
1.  **建立计算网格**：在同一个三维笛卡尔坐标网格上独立地为入射核和靶核进行计算，以避免[插值误差](@entry_id:139425)。
2.  **虚时演化**：通过虚时间步 $\Delta\tau$ 传播单粒子[轨道](@entry_id:137151)（$\phi_i \to \exp(-h \Delta\tau/\hbar) \phi_i$），这等效于[梯度下降法](@entry_id:637322)，可以保证总能量单调下降直至收敛到最小值。
3.  **约束与对称性**：在每一步演化后，必须通过正交归一化（如Gram-Schmidt或Löwdin方法）来保持[轨道](@entry_id:137151)的正交性。同时，通过调整化学势 $\lambda_{p,n}$ 来确保质子数和中子数守恒。对于偶偶核，还需施加时间反演对称性，这能确保流密度为零，从而消除虚假的[质心运动](@entry_id:178374)。
4.  **加速收敛**：为了加速迭代过程，通常采用密度混合技术，如Broyden混合法，来稳定和加速自洽场的收敛。
5.  **碰撞设置**：当两个[原子核](@entry_id:167902)都收敛到其[基态](@entry_id:150928)后，将它们放置在同一个大型计算网格的相距较远的位置。然后，通过对各自的单粒子[轨道](@entry_id:137151)施加一个伽利略助推（Galilean boost）——即乘以一个相位因子 $\exp(\pm i \mathbf{k}_0 \cdot \mathbf{r})$——来赋予它们初始的相对动量，从而设定碰撞的[质心能量](@entry_id:265852) $E_{\text{c.m.}}$ [@problem_id:3577409]。

#### [空间离散化](@entry_id:172158)与算符

在三维网格上表示[波函数](@entry_id:147440)和[哈密顿量](@entry_id:172864)算符需要选择合适的离散化方案。
- **[动能算符](@entry_id:265633)**：[动能算符](@entry_id:265633) $T = -\frac{\hbar^2}{2m}\nabla^2$ 的精度对模拟结果至关重要。一个简单的方法是使用二阶中心[有限差分近似](@entry_id:749375)[拉普拉斯算符](@entry_id:146319)。然而，这种方法会引入显著的 **[数值弥散](@entry_id:168584)**（numerical dispersion），即不同波矢 $\mathbf{k}$ 的[平面波](@entry_id:189798)在网格上传播的速度与其真实速度存在差异。一个更精确的方法是[傅里叶伪谱法](@entry_id:749543)（Fourier pseudospectral method），它通过快速傅里叶变换（FFT）在动量空间中精确地计算拉普拉斯算符的作用。例如，对于一个[波矢](@entry_id:178620)为 $k_x=k_y=k_z=\pi/(3a)$ 的[平面波](@entry_id:189798)，二阶有限差分法计算出的动能与精确值（由[伪谱法](@entry_id:753853)给出）的[相对误差](@entry_id:147538)为 $(9/\pi^2 - 1)$，约为 $-0.088$。这表明即使对于网格可以很好表示的中等波矢，有限差分法仍会系统性地低估动能，从而影响[核子](@entry_id:158389)在碰撞过程中的动力学 [@problem_id:3577427]。

- **[库仑势](@entry_id:154276)**：在周期性边界条件的网格上求解[泊松方程](@entry_id:143763) $\nabla^2 \phi = -4\pi e \rho_p$ 也需要特殊处理。基于FFT的方法效率很高，其计算成本为 $\mathcal{O}(N \log N)$（$N$为网格点数）。然而，这会遇到两个问题：
    1.  **零模问题**：在傅里叶空间，对于零波矢 $\mathbf{k}=\mathbf{0}$，泊松方程变为 $0 = -4\pi \tilde{\rho}(\mathbf{0})$。由于总[电荷](@entry_id:275494) $\tilde{\rho}(\mathbf{0})$ 非零，这导致了矛盾。解决方法是人为地引入一个均匀的[背景电荷](@entry_id:142591)来中和系统，使得修正后的电荷密度在 $\mathbf{k}=\mathbf{0}$ 处为零。
    2.  **周期镜像赝像**：[周期性边界条件](@entry_id:147809)意味着计算的是一个无限[电荷](@entry_id:275494)[晶格](@entry_id:196752)的势，而不是一个孤立[原子核](@entry_id:167902)的势。这种与周期镜像的相互作用是虚假的。为了减小这种赝像，可以采用 **截断库仑势** 的方法，即只考虑中心计算盒子内一定半径 $R_c$ 范围内的相互作用。这种截断可以通过在傅里叶空间乘以一个修正的核函数来实现，该方法在保持短程库仑力不变的同时，有效地抑制了长程的周期性赝像相互作用 [@problem_id:3577450]。

#### [时间演化](@entry_id:153943)

求解TDHF方程需要选择一个稳定且高效的时间[传播子](@entry_id:139558)（propagator）。形式上，一个时间步的演化为 $\phi_i(t+\Delta t) = \exp(-i h \Delta t / \hbar) \phi_i(t)$。不同的数值方法是对这个[幺正演化](@entry_id:145020)算符的不同近似 [@problem_id:3577399]。
- **显式方法**：如经典的四阶[龙格-库塔](@entry_id:140452)（Runge-Kutta）法。这类方法不是幺正的，不自动保证波[函数范数](@entry_id:165870)守恒。更严重的是，它们是 **有条件稳定** 的，时间步长 $\Delta t$ 必须满足一个严格的限制，通常为 $\Delta t \lesssim C \cdot \Delta x^2$，其中 $\Delta x$ 是空间网格间距。在精细网格上，这要求非常小的时间步，导致计算成本高昂。
- **隐式方法**：如[克兰克-尼科尔森](@entry_id:136351)（Crank-Nicolson）方法。该方法是 **无条件稳定** 且 **幺正** 的，能够很好地保持范数守恒。但它的代价是需要在每个时间步求解一个大型[线性方程组](@entry_id:148943)，这通常通过迭代求解器（如GMRES）完成。
- **算符[分裂法](@entry_id:755245)**：如[斯特朗分裂](@entry_id:755497)（Strang splitting）法。该方法将[哈密顿量](@entry_id:172864)分解为动能部分 $T$ 和[势能](@entry_id:748988)部分 $V$，然后交替演化。如果 $T$ 和 $V$ 都是厄米的，那么分裂算符是严格幺正且[无条件稳定](@entry_id:146281)的。结合FFT计算动能项，该方法非常高效。但对于包含复杂速度相关项（如有效质量和自旋-轨道耦合）的Skyrme EDF，简单的 $T+V$ 分裂并不适用。

在实际计算中，由于数值误差的累积，即使采用幺正[传播子](@entry_id:139558)，单粒子[轨道](@entry_id:137151)的正交性也会逐渐丧失。因此，在每个时间步之后，必须对[轨道](@entry_id:137151)集进行重新正交归一化，例如通过计算[重叠矩阵](@entry_id:268881) $S_{kl} = \langle \phi_k | \phi_l \rangle$ 并对所有[轨道](@entry_id:137151)应用变换 $S^{-1/2}$（Löwdin正交化）[@problem_id:3577409]。

综上，一个完整的TDHF时间步循环包括：(i) 从当前[轨道](@entry_id:137151) $\{\phi_k(t)\}$ 构建所有必需的密度和流；(ii) 根据EDF构建单粒子[哈密顿量](@entry_id:172864) $h[\rho(t)]$；(iii) 使用合适的[传播子](@entry_id:139558)将[轨道](@entry_id:137151)演化到 $t+\Delta t$；(iv) 对新的[轨道](@entry_id:137151)集 $\{\phi_k(t+\Delta t)\}$ 进行正交归一化。

### 物理机制与[可观测量](@entry_id:267133)

TDHF虽然是一个平均场理论，但它能够描述核反应中的一个重要物理机制：**[单体耗散](@entry_id:752910)**（one-body dissipation）。耗散意味着有序的[集体运动](@entry_id:747472)能量转化为无序的内禀激发能。在TDHF中，尽管总能量 $E[\rho]$ 是严格守恒的，但这种能量转化仍然可以发生 [@problem_id:3577446]。

其机制在于，随着[原子核](@entry_id:167902)在碰撞中发生形变和密度重组，自洽的[平均场哈密顿量](@entry_id:751814) $h[\rho(t)]$ 也随之剧烈地随时间变化。这个含时变化的[势场](@entry_id:143025)会对在其中运动的[核子](@entry_id:158389)做功，将它们从费米面以下的占据态激发到[费米面](@entry_id:137798)以上的未占据态，从而产生大量的[粒子-空穴激发](@entry_id:137289)。这些[粒子-空穴激发](@entry_id:137289)构成了[原子核](@entry_id:167902)的 **内禀激发能** $E^*$。能量从[原子核](@entry_id:167902)整体的[相对运动](@entry_id:169798)（集体能 $E_{\text{coll}}$）转移到了这些微观的、非相干的单粒子自由度上。由于这一过程是通过[单体](@entry_id:136559)平均场介导的，而非通过显式的两体碰撞，因此被称为“[单体耗散](@entry_id:752910)”。

我们可以通过[能量守恒](@entry_id:140514)来量化这种耗散。总能量 $E_{\text{total}} = E_{\text{coll}}(t) + E^*(t)$ 是守恒的。在碰撞前（$t \to -\infty$），[原子核](@entry_id:167902)处于[基态](@entry_id:150928)，$E^*(-\infty) = 0$，总能量等于初始的相对动能 $K_0$。碰撞后（$t \to +\infty$），系统[能量分配](@entry_id:748987)为末态的相对动能 $K_f$ 和产生的内禀[激发能](@entry_id:190368) $E^*_f$。因此，耗散的能量就是相对动能的损失量：
$$
E^*_f = K_0 - K_f
$$
例如，在一个TDHF模拟中，如果初始相对动能为 $K_0 = 80 \, \text{MeV}$，碰撞后出射碎片的相对动能为 $K_f = 32 \, \text{MeV}$，那么就有 $48 \, \text{MeV}$ 的能量转化为了内禀激发能，动能到内能的转化分数为 $(80-32)/80 = 0.60$ [@problem_id:3577446]。

### 验证与局限性

#### [代码验证](@entry_id:146541)

一个TDHF代码的可靠性必须通过严格的验证协议来保证。这涉及到在长时间模拟中监控那些在理论上应守恒的量，并设置合理的接受阈值 [@problem_id:3577439]。
- **范数和粒子数**：由于[幺正演化](@entry_id:145020)，[轨道](@entry_id:137151)范数和总粒子数的偏差主要来源于[浮点数](@entry_id:173316)[舍入误差](@entry_id:162651)。这种误差通常以[随机游走](@entry_id:142620)的方式累积，其总漂移应与 $\sqrt{N_{\text{steps}}}$ 成正比，其中 $N_{\text{steps}}$ 是时间步数。
- **能量和动量**：能量、[线动量](@entry_id:174467)和角动量的守恒性会同时受到时间离散、空间离散和舍入误差的影响。其总漂移应表现为这三者贡献之和。例如，对于一个二阶时间格式和 $q$ 阶空间格式，总能量误差的漂移应与 $(\Delta t)^2$ 和 $(\Delta x)^q$ 相关。
- **角动量**：[角动量守恒](@entry_id:156798)对笛卡尔网格尤其敏感，因为网格本身破坏了连续旋转对称性。因此，对角动量守恒的监控是检验代码实现对称性能力的重要指标。

一个科学合理的验证协议应设置与 $\Delta t$, $\Delta x$ 和模拟时长相关的动态阈值，用于检验代码是否具有预期的[收敛阶](@entry_id:146394)数，而不仅仅是设定一个固定的、任意的容差。

#### TDHF的物理局限性

TDH[F理论](@entry_id:184208)最重要的局限性在于它无法描述与 **对关联**（pairing correlations）相关的物理现象。这对于描述开壳层、具有[超流性](@entry_id:159036)质的[原子核](@entry_id:167902)尤为关键 [@problem_id:3577391]。
- **对密度的缺失**：如前所述，TDHF的[波函数](@entry_id:147440)是一个具有确定粒子数的斯莱特行列式。因此，描述[核子](@entry_id:158389)对的产生或湮灭的算符[期望值](@entry_id:153208)，即 **反常密度** $\kappa_{ij} = \langle c_j c_i \rangle$，恒等于零。这意味着TDHF无法描述对[振动](@entry_id:267781)、对转移（核反应中的“超流”电流）以及与对[能隙](@entry_id:191975)相关的[奇偶效应](@entry_id:752882)。

为了克服这一局限，需要扩展理论框架到 **含时[哈特里-福克](@entry_id:142303)-波戈留波夫（TDHFB）** 理论。TDHFB通过引入非零的反常密度 $\kappa$ 和与之对应的对力场 $\Delta$，在一个更广阔的变分空间（波戈留波夫[准粒子](@entry_id:136584)真空态）中进行演化。TDHFB的[波函数](@entry_id:147440)不再是[粒子数算符](@entry_id:153568)的本征态，即它破坏了粒子数守恒这一 $\mathrm{U}(1)$ [规范对称性](@entry_id:136438)。

这种对称性的破缺引入了一个新的集体自由度——规范角 $\phi$。这个角度与粒子数构成一对[共轭变量](@entry_id:147843)。两个超流[原子核](@entry_id:167902)碰撞时，它们之间的相对规范角 $\Delta\phi$ 会驱动[核子](@entry_id:158389)对的转移，这与[超导体](@entry_id:191025)之间的 **约瑟芬效应**（[Josephson effect](@entry_id:141683)）非常相似 [@problem_id:3577391]。

值得注意的是，从TDHF到TDHFB的过渡不是自发的。如果一个系统初始处于一个正常的、没有对关联的状态（$\kappa(t_0)=0$），那么在纯粹的、确定性的TDHFB平均场演化下，它将永远保持正常状态（$\kappa(t)=0$ for all $t$）。这是因为TDHF方程是TDHFB方程在 $\kappa=0$ [子空间](@entry_id:150286)中的一个[不动点](@entry_id:156394)。要从正常态转变为超流态，需要超越平均场的涨落或显式破坏对称性的微扰，而这些都不包含在标准的TDHF或TD[HFB理论](@entry_id:750250)中 [@problem_id:3577391]。