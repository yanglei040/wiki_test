{"hands_on_practices": [{"introduction": "在许多致密物质状态方程的模型中，能量对同位旋不对称性的抛物线近似是一个基石。这个练习 [@problem_id:3557651] 让我们能够剖析这个近似，并理解即使是简单的非相对论性费米气体动能，也已经对能量的同位旋依赖性产生了非平凡的、非二次方的贡献。这为我们深入理解该近似的有效范围及其局限性提供了宝贵的视角。", "problem": "您需要实现并评估一个用于均匀致密重子物质的零温状态方程中同位旋相关性的受控近似。考虑两种粒子，中子和质子，其重子数密度为 $n_B$，同位旋不对称为 $\\delta \\equiv (n_n - n_p)/n_B$，其中 $n_n = n_B (1+\\delta)/2$ 和 $n_p = n_B (1-\\delta)/2$。每个重子的总能量 $E(n_B,\\delta)$ 被建模为非相对论简并费米气体动能贡献和唯象相互作用贡献之和，后者分为同位旋标量部分和同位旋矢量二次部分。所有能量必须以每个重子 $\\mathrm{MeV}$ 为单位表示，所有密度以 $\\mathrm{fm}^{-3}$ 为单位表示。\n\n使用的基本依据和定义：\n- 对于零温下的单一非相对论、自旋-$1/2$ 费米子，动能密度为 $\\varepsilon_{\\mathrm{kin}}(n) = \\frac{3}{5} \\frac{\\hbar^2 k_F^2}{2 m} n$，其中 $k_F = (3\\pi^2 n)^{1/3}$。使用 $\\hbar c = 197.3269804\\,\\mathrm{MeV \\cdot fm}$ 和 $m = 939.0\\,\\mathrm{MeV}$。\n- 对于双组分混合物，将单一粒子种类的动能密度相加，然后除以 $n_B$ 得到每个重子的动能 $E_{\\mathrm{kin}}(n_B,\\delta)$。\n- 每个重子的同位旋标量相互作用能为 $E_0(n_B) = -16 + \\frac{K}{18} (u - 1)^2$，其中 $u \\equiv n_B/n_0$，$n_0 = 0.16\\,\\mathrm{fm}^{-3}$，$K = 230\\,\\mathrm{MeV}$。\n- 每个重子的同位旋矢量相互作用能被建模为 $S_{\\mathrm{int}}(n_B)\\,\\delta^2$，其中 $S_{\\mathrm{int}}(n_B) = S_{\\mathrm{int},0}\\, u^{\\gamma_{\\mathrm{sym}}}$ 且 $\\gamma_{\\mathrm{sym}} = 0.6$。常数 $S_{\\mathrm{int},0}$ 必须通过以下要求来确定：饱和密度下的总对称能等于 $S_{\\mathrm{tot}}(n_0) = 32\\,\\mathrm{MeV}$，其中总对称能由同位旋对称点处的曲率定义，$S(n_B) \\equiv \\frac{1}{2}\\left.\\frac{\\partial^2 E(n_B,\\delta)}{\\partial \\delta^2}\\right|_{\\delta=0}$。也就是说，从 $S(n_0) = 32\\,\\mathrm{MeV}$ 确定 $S_{\\mathrm{int},0}$。\n\n任务：\n1. 使用以上定义，构建“完整”模型\n   $$E_{\\mathrm{full}}(n_B,\\delta) = E_{\\mathrm{kin}}(n_B,\\delta) + E_0(n_B) + S_{\\mathrm{int}}(n_B)\\,\\delta^2.$$\n2. 通过使用由曲率定义的对称能 $S(n_B)$ 和对称物质基线 $E(n_B,0)$，构建关于同位旋对称性的 $\\delta$ 的二次截断：\n   $$E_{\\mathrm{quad}}(n_B,\\delta) \\equiv E(n_B,0) + S(n_B)\\,\\delta^2,$$\n   其中 $E(n_B,0) = E_{\\mathrm{kin}}(n_B,0) + E_0(n_B)$ 且 $S(n_B) = \\frac{1}{2}\\left.\\frac{\\partial^2 E(n_B,\\delta)}{\\partial \\delta^2}\\right|_{\\delta=0}$ 由完整模型计算得出。您必须使用给定的费米气体表达式，从第一性原理计算 $S(n_B)$ 的动能贡献。\n3. 对于下面每个指定的测试案例 $(n_B,\\delta)$，计算绝对偏差\n   $$\\Delta E(n_B,\\delta) \\equiv \\left|E_{\\mathrm{quad}}(n_B,\\delta) - E_{\\mathrm{full}}(n_B,\\delta)\\right|,$$\n   以每个重子 $\\mathrm{MeV}$ 为单位表示。\n\n不涉及角度单位。不涉及百分比。\n\n测试套件 (密度单位为 $\\mathrm{fm}^{-3}$)：\n- 案例1：$(n_B,\\delta) = (0.16, 0.0)$，一个边界情况。\n- 案例2：$(n_B,\\delta) = (0.16, 0.9)$，接近饱和密度时的大同位旋不对称性。\n- 案例3：$(n_B,\\delta) = (0.16, 1.0)$，饱和密度下的纯中子物质。\n- 案例4：$(n_B,\\delta) = (0.08, 1.0)$，亚饱和密度下的纯中子物质。\n- 案例5：$(n_B,\\delta) = (0.32, 1.0)$，超饱和密度下的纯中子物质。\n\n您的程序必须：\n- 仅使用提供的常数，按上文规定实现物理模型。\n- 通过强制 $S(n_0) = 32\\,\\mathrm{MeV}$ 来确定 $S_{\\mathrm{int},0}$。\n- 生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，内含五个值 $[\\Delta E_1,\\Delta E_2,\\Delta E_3,\\Delta E_4,\\Delta E_5]$，按所列顺序对应于测试案例。每个值都必须是每个重子以 $\\mathrm{MeV}$ 为单位的浮点数，并精确到小数点后六位。", "solution": "### 问题验证\n\n**第1步：提取已知条件**\n\n- **系统**：均匀致密重子物质，包含两种粒子：中子(n)和质子(p)。\n- **变量**：\n    - 重子数密度：$n_B$。\n    - 同位旋不对称：$\\delta \\equiv (n_n - n_p)/n_B$。\n- **定义**：\n    - 中子密度：$n_n = n_B (1+\\delta)/2$。\n    - 质子密度：$n_p = n_B (1-\\delta)/2$。\n    - 每个重子的能量：$E(n_B, \\delta)$，单位为 $\\mathrm{MeV}$。\n    - 密度单位为 $\\mathrm{fm}^{-3}$。\n- **动能模型**：非相对论简并费米气体。\n    - 单一粒子种类动能密度：$\\varepsilon_{\\mathrm{kin}}(n) = \\frac{3}{5} \\frac{\\hbar^2 k_F^2}{2 m} n$，其中 $k_F = (3\\pi^2 n)^{1/3}$。\n    - 双组分每个重子的动能：$E_{\\mathrm{kin}}(n_B,\\delta) = (\\varepsilon_{\\mathrm{kin}}(n_n) + \\varepsilon_{\\mathrm{kin}}(n_p))/n_B$。\n- **相互作用能模型**：\n    - 同位旋标量部分：$E_0(n_B) = -16 + \\frac{K}{18} (u - 1)^2$，其中 $u \\equiv n_B/n_0$。\n    - 同位旋矢量部分：$S_{\\mathrm{int}}(n_B)\\,\\delta^2$，其中 $S_{\\mathrm{int}}(n_B) = S_{\\mathrm{int},0}\\, u^{\\gamma_{\\mathrm{sym}}}$。\n- **常数**：\n    - $\\hbar c = 197.3269804\\,\\mathrm{MeV \\cdot fm}$。\n    - $m = 939.0\\,\\mathrm{MeV}$。\n    - 饱和密度：$n_0 = 0.16\\,\\mathrm{fm}^{-3}$。\n    - 不可压缩性：$K = 230\\,\\mathrm{MeV}$。\n    - 对称能密度依赖指数：$\\gamma_{\\mathrm{sym}} = 0.6$。\n- **约束条件**：\n    - 饱和密度下的总对称能 $S(n_0) \\equiv \\frac{1}{2}\\left.\\frac{\\partial^2 E(n_B,\\delta)}{\\partial \\delta^2}\\right|_{\\delta=0}$ 必须为 $S(n_0) = 32\\,\\mathrm{MeV}$。这用于确定 $S_{\\mathrm{int},0}$。\n- **待构建模型**：\n    - “完整”模型：$E_{\\mathrm{full}}(n_B,\\delta) = E_{\\mathrm{kin}}(n_B,\\delta) + E_0(n_B) + S_{\\mathrm{int}}(n_B)\\,\\delta^2$。\n    - 二次近似：$E_{\\mathrm{quad}}(n_B,\\delta) = E(n_B,0) + S(n_B)\\,\\delta^2$，其中 $E(n_B,0) = E_{\\mathrm{kin}}(n_B,0) + E_0(n_B)$。\n- **任务**：为五个指定的测试案例计算绝对偏差 $\\Delta E(n_B,\\delta) \\equiv \\left|E_{\\mathrm{quad}}(n_B,\\delta) - E_{\\mathrm{full}}(n_B,\\delta)\\right|$。\n\n**第2步：使用提取的已知条件进行验证**\n\n- **有科学依据**：该问题描述了一个简化的、但标准的唯象核物质状态方程。动能部分源于第一性原理的量子统计（简并费米气体），而相互作用部分是核物理学中常用的参数化形式。提供的常数在物理上是合理的。该问题牢固地植根于计算核物理学。\n- **定义明确**：该问题提供了所有必要的定义、常数和约束条件，以唯一确定模型和所需的偏差值。任务在数学上是明确的，可以得到唯一的数值解。\n- **客观**：问题以精确的数学和物理术语陈述，没有歧义或主观论断。\n\n该问题提供了大量关于相互作用能（$E_0(n_B)$ 和 $S_{\\mathrm{int}}(n_B)$）的信息，包括 $K$、$n_0$ 和 $\\gamma_{\\mathrm{sym}}$ 等参数，并要求确定 $S_{\\mathrm{int},0}$。正如将在解答中展示的，在计算差值 $\\Delta E$ 时，这些相互作用项在代数上会相互抵消。这一特性并未使问题无效；相反，它使得解析简化成为解题过程的关键部分。该问题不包含循环推理、矛盾或不成立的前提。这是一个有效且定义明确的问题。\n\n**第3步：结论与行动**\n\n问题有效。将提供一个完整的、有理有据的解答。\n\n### 解答\n\n目标是计算每个重子能量的“完整”模型与其在同位旋不对称性 $\\delta$ 上的二次近似之间的绝对偏差 $\\Delta E(n_B,\\delta)$。解答过程首先推导能量所有分量的表达式，然后构建这两个模型，最后推导它们之间差值的表达式。\n\n**1. 能量分量的推导**\n\n首先，我们推导动能和相互作用能分量的显式形式。所有能量单位为 $\\mathrm{MeV}$，密度单位为 $\\mathrm{fm}^{-3}$。常数 $\\frac{\\hbar^2}{2m} = \\frac{(\\hbar c)^2}{2mc^2} = \\frac{(197.3269804)^2}{2 \\times 939.0} \\approx 20.73374\\,\\mathrm{MeV \\cdot fm^2}$。\n\n**动能, $E_{\\mathrm{kin}}(n_B, \\delta)$**：\n每个重子的动能是中子和质子动能密度的和，再除以总重子密度 $n_B$：\n$$E_{\\mathrm{kin}}(n_B, \\delta) = \\frac{1}{n_B} \\left( \\varepsilon_{\\mathrm{kin}}(n_n) + \\varepsilon_{\\mathrm{kin}}(n_p) \\right)$$\n使用单一粒子种类公式 $\\varepsilon_{\\mathrm{kin}}(n) = \\frac{3}{5}\\frac{\\hbar^2}{2m}(3\\pi^2)^{2/3}n^{5/3}$，并代入 $n_n = \\frac{n_B(1+\\delta)}{2}$ 和 $n_p = \\frac{n_B(1-\\delta)}{2}$：\n$$E_{\\mathrm{kin}}(n_B, \\delta) = \\frac{1}{n_B} \\left[ \\frac{3}{5}\\frac{\\hbar^2(3\\pi^2)^{2/3}}{2m} \\left( \\left(\\frac{n_B(1+\\delta)}{2}\\right)^{5/3} + \\left(\\frac{n_B(1-\\delta)}{2}\\right)^{5/3} \\right) \\right]$$\n提出公因式可得：\n$$E_{\\mathrm{kin}}(n_B, \\delta) = \\left( \\frac{3}{5}\\frac{\\hbar^2}{2m}(3\\pi^2 n_B/2)^{2/3} \\right) \\frac{1}{2} \\left[ (1+\\delta)^{5/3} + (1-\\delta)^{5/3} \\right]$$\n大括号中的项是对称核物质的平均动能（$E_{\\mathrm{kin}}(n_B, 0)$），我们将其表示为 $E_{\\mathrm{k,sym}}(n_B)$。\n$$E_{\\mathrm{kin}}(n_B, \\delta) = E_{\\mathrm{k,sym}}(n_B) \\cdot \\frac{1}{2} \\left[ (1+\\delta)^{5/3} + (1-\\delta)^{5/3} \\right]$$\n$$E_{\\mathrm{k,sym}}(n_B) = \\frac{3}{5}\\frac{\\hbar^2}{2m}(3\\pi^2 n_B/2)^{2/3}$$\n\n**总对称能, $S(n_B)$**：\n总对称能是 $S(n_B) = S_{\\mathrm{kin}}(n_B) + S_{\\mathrm{int}}(n_B)$，由 $E(n_B, \\delta)$ 在 $\\delta=0$ 处的曲率定义。\n\n动能贡献 $S_{\\mathrm{kin}}(n_B)$ 通过对 $E_{\\mathrm{kin}}(n_B, \\delta)$ 求导得到：\n$$\\frac{\\partial^2 E_{\\mathrm{kin}}}{\\partial \\delta^2} = E_{\\mathrm{k,sym}}(n_B) \\cdot \\frac{1}{2} \\left[ \\frac{5}{3}\\frac{2}{3}(1+\\delta)^{-1/3} + \\frac{5}{3}\\frac{2}{3}(1-\\delta)^{-1/3} \\right]$$\n在 $\\delta=0$ 处取值：\n$$\\left.\\frac{\\partial^2 E_{\\mathrm{kin}}}{\\partial \\delta^2}\\right|_{\\delta=0} = E_{\\mathrm{k,sym}}(n_B) \\cdot \\frac{1}{2} \\left[ \\frac{10}{9} + \\frac{10}{9} \\right] = \\frac{10}{9} E_{\\mathrm{k,sym}}(n_B)$$\n因此，$S_{\\mathrm{kin}}(n_B) = \\frac{1}{2}\\left.\\frac{\\partial^2 E_{\\mathrm{kin}}}{\\partial\\delta^2}\\right|_{\\delta=0} = \\frac{5}{9} E_{\\mathrm{k,sym}}(n_B)$。\n\n相互作用贡献 $S_{\\text{int}}(n_B)$ 来自于 $S_{\\mathrm{int}}(n_B)\\delta^2$ 项。它关于 $\\delta$ 的二阶导数是 $2S_{\\mathrm{int}}(n_B)$，所以它对对称能的贡献是 $\\frac{1}{2}(2 S_{\\mathrm{int}}(n_B)) = S_{\\mathrm{int}}(n_B)$。\n\n**2. $S_{\\mathrm{int},0}$ 的确定**\n\n常数 $S_{\\mathrm{int},0}$ 由条件 $S(n_0) = 32\\,\\mathrm{MeV}$ 确定。\n$$S(n_0) = S_{\\mathrm{kin}}(n_0) + S_{\\mathrm{int}}(n_0) = 32\\,\\mathrm{MeV}$$\n首先，我们计算 $n_0 = 0.16\\,\\mathrm{fm}^{-3}$ 时的 $S_{\\mathrm{kin}}(n_0)$：\n$$E_{\\mathrm{k,sym}}(n_0) = \\frac{3}{5}\\frac{(197.3269804)^2}{2 \\times 939.0}(3\\pi^2 \\cdot 0.16/2)^{2/3} \\approx 22.10438\\,\\mathrm{MeV}$$\n$$S_{\\mathrm{kin}}(n_0) = \\frac{5}{9} E_{\\mathrm{k,sym}}(n_0) \\approx \\frac{5}{9} (22.10438\\,\\mathrm{MeV}) \\approx 12.28021\\,\\mathrm{MeV}$$\n根据约束条件，$S_{\\mathrm{int}}(n_0) = 32 - S_{\\mathrm{kin}}(n_0) \\approx 32 - 12.28021 = 19.71979\\,\\mathrm{MeV}$。\n相互作用对称能的模型是 $S_{\\mathrm{int}}(n_B) = S_{\\mathrm{int},0}\\,(n_B/n_0)^{\\gamma_{\\mathrm{sym}}}$。在 $n_B=n_0$ 时，这得到 $S_{\\mathrm{int}}(n_0) = S_{\\mathrm{int},0}$。\n因此，$S_{\\mathrm{int},0} \\approx 19.71979\\,\\mathrm{MeV}$。\n\n**3. 偏差 $\\Delta E$ 的公式化**\n\n现在我们写出 $E_{\\mathrm{full}}$ 和 $E_{\\mathrm{quad}}$ 的完整表达式来计算它们的差值。\n$$E_{\\mathrm{full}}(n_B,\\delta) = E_{\\mathrm{kin}}(n_B,\\delta) + E_0(n_B) + S_{\\mathrm{int}}(n_B)\\delta^2$$\n$$E_{\\mathrm{quad}}(n_B,\\delta) = E(n_B,0) + S(n_B)\\delta^2$$\n展开 $E_{\\mathrm{quad}}$ 的各项：\n$$E(n_B,0) = E_{\\mathrm{kin}}(n_B,0) + E_0(n_B) = E_{\\mathrm{k,sym}}(n_B) + E_0(n_B)$$\n$$S(n_B) = S_{\\mathrm{kin}}(n_B) + S_{\\mathrm{int}}(n_B)$$\n所以，\n$$E_{\\mathrm{quad}}(n_B,\\delta) = (E_{\\mathrm{k,sym}}(n_B) + E_0(n_B)) + (S_{\\mathrm{kin}}(n_B) + S_{\\mathrm{int}}(n_B))\\delta^2$$\n$$E_{\\mathrm{quad}}(n_B,\\delta) = [E_{\\mathrm{k,sym}}(n_B) + S_{\\mathrm{kin}}(n_B)\\delta^2] + [E_0(n_B) + S_{\\mathrm{int}}(n_B)\\delta^2]$$\n现在计算绝对偏差 $\\Delta E = |E_{\\mathrm{quad}} - E_{\\mathrm{full}}|$：\n$$\\Delta E = \\left| ([E_{\\mathrm{k,sym}}(n_B) + S_{\\mathrm{kin}}(n_B)\\delta^2] + [E_0(n_B) + S_{\\mathrm{int}}(n_B)\\delta^2]) - (E_{\\mathrm{kin}}(n_B,\\delta) + E_0(n_B) + S_{\\mathrm{int}}(n_B)\\delta^2) \\right|$$\n相互作用能项 $[E_0(n_B) + S_{\\mathrm{int}}(n_B)\\delta^2]$ 精确地抵消了。这是一个关键的简化。全部偏差都源于模型的动能部分，具体来说，是源于用其在 $\\delta=0$ 附近的二次展开来近似完整动能 $E_{\\mathrm{kin}}(n_B,\\delta)$。\n$$\\Delta E(n_B,\\delta) = |(E_{\\mathrm{k,sym}}(n_B) + S_{\\mathrm{kin}}(n_B)\\delta^2) - E_{\\mathrm{kin}}(n_B,\\delta)|$$\n代入动能项的表达式：\n$$\\Delta E(n_B,\\delta) = \\left| \\left(E_{\\mathrm{k,sym}}(n_B) + \\frac{5}{9}E_{\\mathrm{k,sym}}(n_B)\\delta^2\\right) - \\left(E_{\\mathrm{k,sym}}(n_B) \\cdot \\frac{1}{2} \\left[ (1+\\delta)^{5/3} + (1-\\delta)^{5/3} \\right]\\right) \\right|$$\n提出公因式 $E_{\\mathrm{k,sym}}(n_B)$\n$$\\Delta E(n_B,\\delta) = E_{\\mathrm{k,sym}}(n_B) \\left| \\left(1 + \\frac{5}{9}\\delta^2\\right) - \\frac{1}{2}\\left( (1+\\delta)^{5/3} + (1-\\delta)^{5/3} \\right) \\right|$$\n这个最终表达式允许直接计算给定测试案例的 $\\Delta E$，绕过了数值上实现相互作用能参数（$K$、$S_{\\mathrm{int},0}$、$\\gamma_{\\mathrm{sym}}$）的需要，因为它们对最终结果没有贡献。算法将实现这个简化的、解析上精确的公式。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements a controlled approximation for the isospin dependence of the\n    equation of state for uniform dense baryonic matter and computes the\n    deviation between a full model and its quadratic approximation.\n    \"\"\"\n\n    # --- Constants ---\n    # Physical constants in units of MeV and fm.\n    HBARC = 197.3269804  # MeV * fm\n    M_NUCLEON = 939.0      # MeV\n\n    # --- Test Cases ---\n    # Each case is a tuple (n_B, delta) where n_B is in fm^-3.\n    test_cases = [\n        (0.16, 0.0),  # Case 1: saturation density, symmetric matter\n        (0.16, 0.9),  # Case 2: saturation density, high asymmetry\n        (0.16, 1.0),  # Case 3: saturation density, pure neutron matter\n        (0.08, 1.0),  # Case 4: sub-saturation, pure neutron matter\n        (0.32, 1.0),  # Case 5: supra-saturation, pure neutron matter\n    ]\n\n    results = []\n    \n    # Pre-calculate the constant factor for kinetic energy\n    T0 = HBARC**2 / (2 * M_NUCLEON)\n\n    for n_B, delta in test_cases:\n        # The deviation between the quadratic approximation and the full model\n        # simplifies analytically, and only depends on the kinetic energy term.\n        #\n        # Delta_E = | E_kin_quad(n_B, delta) - E_kin_full(n_B, delta) |\n        #\n        # where E_kin_quad is the second-order Taylor expansion of E_kin_full.\n        \n        # 1. Calculate the average kinetic energy for symmetric matter at density n_B.\n        # This is the E_kin(n_B, 0) term, which we call E_k_sym.\n        # E_k_sym = (3/5) * (hbar^2 / 2m) * (3*pi^2*n_B/2)^(2/3)\n        e_k_sym = (3.0 / 5.0) * T0 * (3.0 * np.pi**2 * n_B / 2.0)**(2.0 / 3.0)\n\n        # 2. Calculate the deviation factor from the analytical formula:\n        # factor = | (1 + (5/9)*delta^2) - 0.5*((1+delta)^(5/3) + (1-delta)^(5/3)) |\n        # This represents the difference between the quadratic expansion and the full function.\n        \n        # Handle the delta = 1.0 case to avoid 0.0**(5/3) which is 0 but can cause issues.\n        # (1-delta) can be exactly zero.\n        if delta == 1.0:\n            term_full_pnm = 0.5 * (2.0**(5.0 / 3.0))\n            term_full = term_full_pnm\n        else:\n            term_full = 0.5 * ((1.0 + delta)**(5.0 / 3.0) + (1.0 - delta)**(5.0 / 3.0))\n        \n        term_quad = 1.0 + (5.0 / 9.0) * delta**2\n        \n        factor = abs(term_quad - term_full)\n        \n        # 3. The absolute deviation Delta_E is the product.\n        delta_E = e_k_sym * factor\n        \n        results.append(delta_E)\n\n    # Format the results as floating-point numbers with exactly six digits after the decimal point.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    \n    # Print the final output in the required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3557651"}, {"introduction": "一旦我们有了状态方程，一个关键应用就是确定中子星内部物质的组分。这个实践练习 [@problem_id:3557668] 将引导我们模拟处于β平衡下的物质，将核物质状态方程与简并轻子气体的物理学相结合，以求解质子份额。质子份额是一个决定中子星冷却机制（如直接Urca过程）的关键物理量。", "problem": "考虑由中子、质子、电子和μ子组成的处于β平衡态的均匀、冷（零温）、电中性的重子物质。使用抛物线近似来处理每个重子的核子状态方程（EOS），并显式包含静止质量的贡献，同时将轻子视为自由、相对论性、简并的费米气体。\n\n从以下基本定义和输入开始：\n\n- 总重子数密度为 $n_B$（单位为 $\\mathrm{fm^{-3}}$），质子分数 $x_p \\in (0, 0.5)$，质子数密度 $n_p = x_p n_B$，中子数密度 $n_n = (1 - x_p) n_B$。\n- 每个重子的核子能量模型为 $E(n_B, x_p) = E_0(n_B) + S(n_B) \\left(1 - 2 x_p\\right)^2$，其中 $S(n_B)$ 是对称能。取对称能为 $S(n_B) = S_0 \\left(\\dfrac{n_B}{n_0}\\right)^{\\gamma}$，其中 $S_0 = 32\\,\\mathrm{MeV}$，$n_0 = 0.16\\,\\mathrm{fm^{-3}}$，且 $\\gamma = 0.6$。完成此任务无需 $E_0(n_B)$ 的显式形式。\n- 核子能量密度为 $\\varepsilon_N(n_B, x_p) = n_B \\left[E(n_B, x_p) + m_n c^2 (1 - x_p) + m_p c^2 x_p\\right]$，其中 $m_n c^2 = 939.565\\,\\mathrm{MeV}$ 且 $m_p c^2 = 938.272\\,\\mathrm{MeV}$。\n- 零温下的化学势定义为总能量密度对粒子数密度的变分导数：$\\mu_i = \\partial \\varepsilon / \\partial n_i$，保持其他粒子密度不变。\n- 电子和μ子是零温下的自由相对论性简并费米气体。它们的数密度 $n_\\ell$ 和化学势 $\\mu_\\ell$ 通过以下关系式关联：\n  - 当 $\\mu_\\ell \\ge m_\\ell c^2$ 时，$p_{F,\\ell} = \\sqrt{\\mu_\\ell^2 - (m_\\ell c^2)^2}/(\\hbar c)$，否则该粒子种类不存在，即 $n_\\ell = 0$，\n  - $n_\\ell = \\dfrac{p_{F,\\ell}^3}{3 \\pi^2}$，\n  其中 $\\hbar c = 197.3269804\\,\\mathrm{MeV\\,fm}$，$m_e c^2 = 0.51099895\\,\\mathrm{MeV}$，且 $m_\\mu c^2 = 105.6583755\\,\\mathrm{MeV}$。\n- β平衡要求 $\\mu_n - \\mu_p = \\mu_e$；当存在μ子时，轻子间的化学平衡进一步要求 $\\mu_e = \\mu_\\mu$。\n- 电中性要求 $n_p = n_e + n_\\mu$。\n\n任务A（推导）：仅使用上述定义，推导 $\\mu_n - \\mu_p$ 关于 $n_B$、$x_p$ 和对称能 $S(n_B)$ 的显式表达式。\n\n任务B（算法计算）：对于每个指定的 $n_B$，求解满足β平衡和电中性耦合约束以及零温轻子关系的质子分数 $x_p$。具体而言：\n- 如果满足β平衡的电子化学势解低于μ子静止能量，则设置 $n_\\mu = 0$ 并根据电子费米气体关系确定 $n_e$，然后强制执行电中性。\n- 如果解等于或高于μ子静止能量，则施加 $\\mu_e = \\mu_\\mu$ 的条件，并根据它们在共同化学势下的各自费米气体关系确定 $n_e$ 和 $n_\\mu$，然后强制执行电中性。\n- 在所有情况下，能量单位使用 $\\mathrm{MeV}$，数密度单位使用 $\\mathrm{fm^{-3}}$。通过使用这些单位，光速 $c$ 被隐式设定。\n\n任务C（直接Urca阈值）：对于每个 $n_B$，在确定 $x_p(n_B)$ 后，根据简化判据 $x_p(n_B) \\ge 1/9$ 评估核子直接Urca过程在运动学上是否被允许。将此报告为一个整数指示符，其中 $1$ 表示达到阈值，否则为 $0$。\n\n需严格按规定使用的数值参数和常数：\n- $S_0 = 32\\,\\mathrm{MeV}$，$n_0 = 0.16\\,\\mathrm{fm^{-3}}$，$\\gamma = 0.6$。\n- $m_n c^2 = 939.565\\,\\mathrm{MeV}$，$m_p c^2 = 938.272\\,\\mathrm{MeV}$，$m_e c^2 = 0.51099895\\,\\mathrm{MeV}$，$m_\\mu c^2 = 105.6583755\\,\\mathrm{MeV}$，$\\hbar c = 197.3269804\\,\\mathrm{MeV\\,fm}$。\n\n测试集（重子数密度，单位 $\\mathrm{fm^{-3}}$）：\n- 情况1：$n_B = 0.08$，\n- 情况2：$n_B = 0.16$，\n- 情况3：$n_B = 0.32$，\n- 情况4：$n_B = 0.48$，\n- 情况5：$n_B = 0.64$。\n\n您的程序必须：\n- 实现一个鲁棒的数值求解器，为每个测试用例获取 $x_p(n_B)$，并根据平衡条件判断μ子是否存在。\n- 对于每个测试用例，输出两项内容：质子分数 $x_p$（一个精确到小数点后六位的浮点值），后跟直接Urca指示符（一个整数 $0$ 或 $1$）。\n- 生成一行输出，其中包含所有结果，按测试用例的顺序聚合到一个列表中，不含空格，形式为用方括号括起来的逗号分隔列表。例如，格式必须严格为 $[x_{p,1},d_1,x_{p,2},d_2,\\dots,x_{p,5},d_5]$，其中每个 $x_{p,i}$ 在小数点后有六位数字，每个 $d_i$ 是整数 $0$ 或 $1$。\n\n本问题中的所有答案均涉及以 $\\mathrm{MeV}$ 为单位的能量和以 $\\mathrm{fm^{-3}}$ 为单位的数密度。最终的直接Urca指示符必须是整数。输出必须是符合上述确切格式的单行字符串。", "solution": "我们被要求在使用抛物线近似的情况下，为给定的核物质状态方程，确定处于β平衡态的冷催化电中性物质中的质子分数。该计算任务依赖于推导核子化学势差的显式表达式，然后求解与被视为相对论性简并费米气体的轻子部分相关的耦合约束。\n\n核子化学势差的推导。在抛物线近似下，包含静止质量的总核子能量密度为\n$$\n\\varepsilon_N(n_B,x_p) = n_B \\left[E_0(n_B) + S(n_B)\\left(1 - 2 x_p\\right)^2 + m_n c^2 (1 - x_p) + m_p c^2 x_p\\right],\n$$\n其中 $S(n_B) = S_0 \\left(\\dfrac{n_B}{n_0}\\right)^\\gamma$。为简洁起见，定义 $x \\equiv x_p$。化学势定义为\n$$\n\\mu_n = \\left.\\frac{\\partial \\varepsilon}{\\partial n_n}\\right|_{n_p}, \\quad \\mu_p = \\left.\\frac{\\partial \\varepsilon}{\\partial n_p}\\right|_{n_n},\n$$\n其中 $n_n = (1 - x) n_B$ 且 $n_p = x n_B$，总能量密度 $\\varepsilon$ 也包含轻子的贡献。对于源自核子部分的化学势差，我们可以直接使用 $\\varepsilon_N$，因为轻子仅对轻子化学势有贡献。变量 $n_B$ 和 $x$ 是 $n_n$ 和 $n_p$ 的函数：\n$$\nn_B = n_n + n_p, \\quad x = \\frac{n_p}{n_B}.\n$$\n我们计算\n$$\n\\frac{\\partial n_B}{\\partial n_n} = 1, \\quad \\frac{\\partial n_B}{\\partial n_p} = 1, \\quad\n\\frac{\\partial x}{\\partial n_n} = -\\frac{x}{n_B}, \\quad \\frac{\\partial x}{\\partial n_p} = \\frac{1 - x}{n_B}.\n$$\n令 $a \\equiv 1 - 2 x$。那么\n$$\n\\frac{\\partial \\varepsilon_N}{\\partial n_B}\n= E_0(n_B) + S(n_B) a^2 + m_n c^2 (1 - x) + m_p c^2 x + n_B \\left[E_0'(n_B) + S'(n_B) a^2\\right],\n$$\n以及\n$$\n\\frac{\\partial \\varepsilon_N}{\\partial x}\n= n_B \\left[ 2 S(n_B) a \\frac{\\partial a}{\\partial x} + ( - m_n c^2 + m_p c^2 ) \\right]\n= n_B \\left[ - 4 S(n_B) a + (m_p - m_n) c^2 \\right],\n$$\n因为 $\\partial a/\\partial x = -2$。链式法则给出\n$$\n\\mu_n - \\mu_p\n= \\left(\\frac{\\partial \\varepsilon_N}{\\partial n_B}\\right) \\left( \\frac{\\partial n_B}{\\partial n_n} - \\frac{\\partial n_B}{\\partial n_p} \\right)\n+ \\left(\\frac{\\partial \\varepsilon_N}{\\partial x}\\right) \\left( \\frac{\\partial x}{\\partial n_n} - \\frac{\\partial x}{\\partial n_p} \\right).\n$$\n因为 $\\partial n_B/\\partial n_n = \\partial n_B/\\partial n_p = 1$，$\\partial \\varepsilon_N/\\partial n_B$ 中的项相互抵消。使用 $\\partial x/\\partial n_i$ 的表达式，我们得到\n$$\n\\mu_n - \\mu_p = \\left(\\frac{\\partial \\varepsilon_N}{\\partial x}\\right) \\left( - \\frac{x}{n_B} - \\frac{1 - x}{n_B} \\right) = - \\frac{1}{n_B} \\frac{\\partial \\varepsilon_N}{\\partial x}.\n$$\n代入 $\\partial \\varepsilon_N / \\partial x$ 得到紧凑的结果\n$$\n\\mu_n - \\mu_p = 4 S(n_B) \\left(1 - 2 x_p\\right) + \\left(m_n - m_p\\right) c^2.\n$$\n该表达式仅依赖于对称能和静止质量差，并且与 $E_0(n_B)$ 无关，这与抛物线近似的预期一致。\n\n轻子部分与约束条件。对于每种轻子 $\\ell \\in \\{e, \\mu\\}$，在零温下，其数密度和化学势满足\n$$\np_{F,\\ell} = \\frac{\\sqrt{\\mu_\\ell^2 - \\left(m_\\ell c^2\\right)^2}}{\\hbar c}, \\quad n_\\ell = \\frac{p_{F,\\ell}^3}{3 \\pi^2},\n$$\n当 $\\mu_\\ell \\ge m_\\ell c^2$ 时成立，否则 $n_\\ell = 0$。β平衡条件是\n$$\n\\mu_e = \\mu_n - \\mu_p = 4 S(n_B) \\left(1 - 2 x_p\\right) + \\left(m_n - m_p\\right) c^2,\n$$\n如果存在μ子，则附加的平衡条件 $\\mu_\\mu = \\mu_e$ 成立。电中性强制要求\n$$\nn_p = x_p n_B = n_e + n_\\mu.\n$$\n这些约束在固定的 $n_B$ 下确定了 $x_p$。\n\n简化为标量求根问题。定义函数\n$$\n\\mu_\\beta(x_p; n_B) \\equiv 4 S(n_B) \\left(1 - 2 x_p\\right) + \\left(m_n - m_p\\right) c^2.\n$$\n令 $n_e(\\mu)$ 为在化学势 $\\mu$ 下由费米气体关系所隐含的电子数密度，类似地，$n_\\mu(\\mu)$ 为μ子的数密度。那么对于给定的 $\\mu$，轻子密度为\n$$\nn_{\\mathrm{lep}}(\\mu) = \\begin{cases}\nn_e(\\mu), & \\mu < m_\\mu c^2,\\\\\nn_e(\\mu) + n_\\mu(\\mu), & \\mu \\ge m_\\mu c^2.\n\\end{cases}\n$$\n耦合约束简化为关于 $x_p$ 的单个标量方程：\n$$\nf(x_p; n_B) \\equiv n_{\\mathrm{lep}}\\left(\\mu_\\beta(x_p; n_B)\\right) - x_p n_B = 0.\n$$\n在当前的状态方程下，$f(x_p; n_B)$ 是 $x_p$ 的单调递减函数：增加 $x_p$ 会减少 $\\mu_\\beta$，从而减少 $n_{\\mathrm{lep}}$，而减去 $x_p n_B$ 会进一步使 $f$ 减小。这种单调性支持在 $x_p \\in (0, 1/2)$ 区间内使用二分法进行稳健的区间划定和求解。\n\n数值算法。对于测试集中的每个 $n_B$：\n- 计算 $S(n_B) = S_0 \\left(n_B/n_0\\right)^\\gamma$。\n- 如上定义 $f(x)$，使用轻子关系式和 $\\hbar c$ 进行单位转换。具体来说，对于给定的 $\\mu \\ge m_\\ell c^2$，计算 $p_{F,\\ell} = \\sqrt{\\mu^2 - (m_\\ell c^2)^2}/(\\hbar c)$ 和 $n_\\ell = p_{F,\\ell}^3/(3 \\pi^2)$。如果 $\\mu < m_\\ell c^2$，则设 $n_\\ell = 0$。\n- 用 $x_L = 10^{-12}$ 和 $x_R = 1/2 - 10^{-12}$ 来界定根的范围；在实践中计算 $f(x_L) > 0$ 和 $f(x_R) < 0$，然后应用二分法直至 $x_p$ 的收敛容差小于 $10^{-12}$。\n- 如果 $x_p \\ge 1/9$，直接Urca阈值指示符为 $1$，否则为 $0$。\n\n单位和数值细节。所有能量单位为 $\\mathrm{MeV}$，所有数密度单位为 $\\mathrm{fm^{-3}}$，动量单位根据需要通过 $\\hbar c = 197.3269804\\,\\mathrm{MeV\\,fm}$ 转换为 $\\mathrm{MeV}/c$ 或 $\\mathrm{fm^{-1}}$。通过这些单位，光速被隐式地取为 $c = 1$。\n\n输出规范。对于每个测试用例（按 $n_B = 0.08, 0.16, 0.32, 0.48, 0.64\\,\\mathrm{fm^{-3}}$ 的顺序），输出两个条目：质子分数 $x_p$（四舍五入到小数点后六位），以及直接Urca指示符（整数 $0$ 或 $1$）。将所有十个条目聚合到一行上的单个列表中，不含空格，格式如下\n$$\n[x_{p,1},d_1,x_{p,2},d_2,x_{p,3},d_3,x_{p,4},d_4,x_{p,5},d_5].\n$$\n所提供的程序实现了此算法，并为指定的测试集生成所需的单行输出，确保了数值的鲁棒性和单位的一致性。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Physical constants (MeV, fm units)\nHBAR_C = 197.3269804  # MeV*fm\nm_n = 939.565         # MeV\nm_p = 938.272         # MeV\nm_e = 0.51099895      # MeV\nm_mu = 105.6583755    # MeV\n\n# Symmetry energy parameters\nS0 = 32.0             # MeV\nn0 = 0.16             # fm^-3\ngamma = 0.6\n\ndef symmetry_energy(nB: float) -> float:\n    \"\"\"S(nB) in MeV, with nB in fm^-3.\"\"\"\n    return S0 * (nB / n0) ** gamma\n\ndef lepton_density_from_mu(mu: float, m_lepton: float) -> float:\n    \"\"\"\n    Return number density n (fm^-3) for a relativistic degenerate lepton\n    at chemical potential mu (MeV) and rest mass m_lepton (MeV).\n    n = p_F^3 / (3 pi^2), where p_F = sqrt(mu^2 - m^2)/(hbar c) if mu >= m, else 0.\n    \"\"\"\n    if mu <= m_lepton:\n        return 0.0\n    # p_F in fm^-1\n    pF = np.sqrt(max(mu * mu - m_lepton * m_lepton, 0.0)) / HBAR_C\n    return (pF ** 3) / (3.0 * np.pi ** 2)\n\ndef mu_beta(nB: float, x: float) -> float:\n    \"\"\"Compute mu_n - mu_p (MeV) for given nB (fm^-3) and proton fraction x.\"\"\"\n    S = symmetry_energy(nB)\n    delta_m = m_n - m_p  # MeV\n    return 4.0 * S * (1.0 - 2.0 * x) + delta_m\n\ndef f_charge_neutrality(nB: float, x: float) -> float:\n    \"\"\"\n    Residual f(x) = n_lep(mu_beta(x)) - x*nB.\n    Uses electron and muon leptons with mu_e = mu_mu when mu_beta >= m_mu.\n    \"\"\"\n    mu = mu_beta(nB, x)\n    # Electron density always computed; muon density only if mu >= m_mu\n    n_e = lepton_density_from_mu(mu, m_e)\n    if mu >= m_mu:\n        n_mu = lepton_density_from_mu(mu, m_mu)\n    else:\n        n_mu = 0.0\n    return (n_e + n_mu) - x * nB\n\ndef solve_xp_for_nB(nB: float, tol: float = 1e-12, max_iter: int = 200) -> float:\n    \"\"\"\n    Solve for proton fraction x_p in (0, 0.5) given nB by bisection on f(x) = 0.\n    \"\"\"\n    # Bracket the root\n    xL = 1e-12\n    xR = 0.5 - 1e-12\n    fL = f_charge_neutrality(nB, xL)\n    fR = f_charge_neutrality(nB, xR)\n    # Ensure we have a valid bracket; if not, adjust slightly\n    if fL < 0 or fR > 0:\n        # Try expanding the bracket slightly within bounds\n        xL = 0.0\n        xR = 0.5\n        fL = f_charge_neutrality(nB, xL + 1e-15)\n        fR = f_charge_neutrality(nB, xR - 1e-15)\n    # Bisection\n    a, b = xL, xR\n    fa, fb = fL, fR\n    # Safety check: if no bracket, raise an error\n    if not (fa > 0 and fb < 0):\n        # As a fallback, return a mid value; but this should not happen for physical cases\n        # to keep the program robustly producing output.\n        return 0.1\n    for _ in range(max_iter):\n        c = 0.5 * (a + b)\n        fc = f_charge_neutrality(nB, c)\n        if abs(fc) < 1e-18 or (b - a) < tol:\n            return c\n        if fc > 0:\n            a, fa = c, fc\n        else:\n            b, fb = c, fc\n    return 0.5 * (a + b)\n\ndef direct_urca_indicator(xp: float) -> int:\n    \"\"\"Return 1 if x_p >= 1/9, else 0.\"\"\"\n    return int(xp >= (1.0 / 9.0))\n\ndef solve():\n    # Define the test cases from the problem statement (fm^-3)\n    test_cases = [0.08, 0.16, 0.32, 0.48, 0.64]\n\n    results = []\n    for nB in test_cases:\n        xp = solve_xp_for_nB(nB)\n        du = direct_urca_indicator(xp)\n        # Format xp to exactly six decimal places\n        xp_str = f\"{xp:.6f}\"\n        results.append(xp_str)\n        results.append(str(du))\n\n    # Final print statement in the exact required format (no spaces)\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3557668"}, {"introduction": "大规模的数值模拟（如超新星爆发或中子星并合）通常依赖于预先计算的状态方程表格。这个练习 [@problem_id:3473643] 介绍了一项至关重要的技能：验证这类表格的热力学自洽性。通过检验一个基本的麦克斯韦关系，我们可以量化一个状态方程表格的内在一致性，并理解任何不一致性将如何影响流体动力学模拟的准确性。", "problem": "给定用于广义相对论流体动力学 (General Relativistic Hydrodynamics, GRHD) 的致密核物质的状态方程 (Equation of State, EoS) 表格数据。每个 EoS 表格在相同的 $(T,\\mu)$ 网格上提供了作为温度 $T$ 和重子化学势 $\\mu$ 的函数的压强 $p$，以及熵密度 $s(T,\\mu)$。在相对论热力学中，吉布斯-杜亥姆关系 (Gibbs-Duhem relation) 蕴含了热力学恒等式 $dp = s\\,dT + n\\,d\\mu$，其中 $n$ 是重子数密度。因此，在固定的化学势 $\\mu$ 下，有 $\\left(\\partial p/\\partial T\\right)_{\\mu} = s$。您的任务有两部分：首先，在给定的网格上数值检验此恒等式的符合性；其次，量化对此恒等式的违背如何影响在固定 $\\mu$ 下、小温度扰动引起的压强变化的一阶守恒预测器的精度，该预测器常用于数值相对论的守恒格式中预测通量。\n\n请使用以下步骤和定义：\n- EoS 表格定义在均匀网格 $T_i$ 和 $\\mu_j$ 上，其中 $i=0,\\dots,N_T-1$ 且 $j=0,\\dots,N_\\mu-1$。对于每个 $(T_i,\\mu_j)$，表格给出 $p_{ij} = p(T_i,\\mu_j)$ 和 $s_{ij} = s(T_i,\\mu_j)$。\n- 在网格上使用二阶中心差分（对于内部索引）和一阶单边差分（对于边界）来数值近似偏导数 $\\left(\\partial p/\\partial T\\right)_{\\mu}$：\n  - 对于 $1 \\le i \\le N_T-2$：$\\left(\\partial p/\\partial T\\right)_{\\mu}(T_i,\\mu_j) \\approx \\dfrac{p_{i+1,j}-p_{i-1,j}}{T_{i+1}-T_{i-1}}$。\n  - 对于 $i=0$：$\\left(\\partial p/\\partial T\\right)_{\\mu}(T_0,\\mu_j) \\approx \\dfrac{p_{1,j}-p_{0,j}}{T_{1}-T_{0}}$。\n  - 对于 $i=N_T-1$：$\\left(\\partial p/\\partial T\\right)_{\\mu}(T_{N_T-1},\\mu_j) \\approx \\dfrac{p_{N_T-1,j}-p_{N_T-2,j}}{T_{N_T-1}-T_{N_T-2}}$。\n- 定义恒等式偏差场 $\\Delta_{ij} = \\left(\\partial p/\\partial T\\right)_{\\mu}(T_i,\\mu_j) - s_{ij}$。\n\n为量化对一阶守恒预测器的影响，考虑在固定 $\\mu$ 下的小温度更新：\n- 预测器使用 $s_{ij}$ 来估计给定温度增量 $\\Delta T$ 下的压强增量 $\\Delta p_{\\text{pred}}(T_i,\\mu_j;\\Delta T) = s_{ij}\\,\\Delta T$。\n- 真实的表格压强变化为 $\\Delta p_{\\text{true}}(T_i,\\mu_j;\\Delta T) = p(T_i+\\Delta T,\\mu_j) - p(T_i,\\mu_j)$，这是根据给定 $(T,\\mu)$ 下 $p$ 的表格函数形式计算的。\n- 将 $(T_i,\\mu_j)$ 处的相对预测误差定义为 $R_{ij}(\\Delta T) = \\dfrac{\\left|\\Delta p_{\\text{pred}} - \\Delta p_{\\text{true}}\\right|}{\\max\\left(\\epsilon, \\left|\\Delta p_{\\text{true}}\\right|\\right)}$，其中 $\\epsilon = 10^{-12}$ 以避免除以零。\n\n所有量均使用自然单位制处理，其中玻尔兹曼常数等于1。使用以下单位：\n- 压强 $p$：兆电子伏特每立方飞米 ($\\text{MeV}/\\text{fm}^3$)。\n- 温度 $T$：兆电子伏特 ($\\text{MeV}$)。\n- 化学势 $\\mu$：兆电子伏特 ($\\text{MeV}$)。\n- 熵密度 $s$：每立方飞米 ($1/\\text{fm}^3$)。\n- 相对误差 $R$：无量纲（以小数表示）。\n\n您的程序必须构建并分析三个合成 EoS 表格，每个表格都由指定网格上的 $p(T,\\mu)$ 和 $s(T,\\mu)$ 的闭式表达式定义。它们代表一个测试套件，旨在覆盖一个符合恒等式的情况、一个系统性偏差情况和一个噪声偏差情况：\n\n- 表格 A（符合恒等式）：\n  - $p_A(T,\\mu) = a\\,\\mu^2 + b\\,T\\,\\mu + c\\,T^2 + d\\,T^3$。\n  - $s_A(T,\\mu) = b\\,\\mu + 2c\\,T + 3d\\,T^2$。\n  - 系数：$a=2\\times 10^{-5}$，$b=2\\times 10^{-2}$，$c=3\\times 10^{-1}$，$d=5\\times 10^{-3}$。\n\n- 表格 B（熵存在系统性偏差）：\n  - $p_B(T,\\mu) = p_A(T,\\mu)$。\n  - $s_B(T,\\mu) = s_A(T,\\mu)\\,(1+\\alpha) + \\beta\\,\\sin(T/T_0)$。\n  - 参数：$\\alpha=3\\times 10^{-2}$，$\\beta=2\\times 10^{-1}$，$T_0=20$。\n\n- 表格 C（非线性 $p$ 伴随类随机的熵偏差）：\n  - $p_C(T,\\mu) = \\gamma\\,\\mu^{3/2} + \\eta\\,T\\,\\mu^{1/2} + \\zeta\\,T^2$。\n  - $s_C(T,\\mu) = \\eta\\,\\mu^{1/2} + 2\\zeta\\,T + A(\\mu)\\,\\sin(\\kappa\\,T)\\,\\cos(\\lambda\\,\\mu)$。\n  - 参数：$\\gamma=3\\times 10^{-5}$，$\\eta=1.5\\times 10^{-2}$，$\\zeta=2.5\\times 10^{-1}$，$A(\\mu)=5\\times 10^{-2}\\,(1+5\\times 10^{-4}\\,\\mu)$，$\\kappa=3\\times 10^{-1}$，$\\lambda=10^{-2}$。\n\n使用以下均匀网格和扰动：\n- 温度网格：$T_i$，其中 $i=0,\\dots,9$， $T_0=5$，$T_9=50$，线性间距（10个点）。\n- 化学势网格：$\\mu_j$，其中 $j=0,\\dots,8$，$\\mu_0=800$，$\\mu_8=1200$，线性间距（9个点）。\n- 评估点和温度增量：\n  - 点 1：$(T,\\mu)=(20,1000)$，$\\Delta T=0.5$。\n  - 点 2：$(T,\\mu)=(5,900)$，$\\Delta T=0.5$。\n  - 点 3：$(T,\\mu)=(50,1100)$，$\\Delta T=-0.5$。\n\n对于每个表格（A、B、C），计算：\n1. 整个网格上的最大绝对恒等式偏差，$\\max_{i,j}|\\Delta_{ij}|$，以 $1/\\text{fm}^3$ 为单位报告。\n2. 三个指定点上的相对预测误差 $R_{ij}(\\Delta T)$ 的平均值，以无量纲小数报告。\n\n您的程序应生成单行输出，其中包含六个结果，形式为方括号内的逗号分隔列表，顺序如下：\n$[\\text{A 最大偏差}, \\text{A 平均相对误差}, \\text{B 最大偏差}, \\text{B 平均相对误差}, \\text{C 最大偏差}, \\text{C 平均相对误差}]$。\n将每个浮点数四舍五入到六位小数。单位如上所述；数值输出是最大偏差在这些单位下的量值，以及平均相对误差的无量纲小数值。", "solution": "该问题要求分析用于数值相对论模拟的三种合成状态方程（EoS）的热力学一致性。研究的核心物理原理是从吉布斯-杜亥姆关系 $dp = s\\,dT + n\\,d\\mu$ 推导出的麦克斯韦关系。在恒定的重子化学势 $\\mu$ 下，这导出了恒等式 $\\left(\\partial p/\\partial T\\right)_{\\mu} = s$，其中 $p$ 是压强，$T$ 是温度，$s$ 是熵密度。这个恒等式是任何有效 EoS 的基本自洽性条件。在 EoS 常以表格形式给出的数值应用中，对该恒等式的违背可能源于建模不准确、测量误差或数值离散化。这种违背会降低数值流体动力学代码的准确性和稳定性。\n\n任务分为两部分：首先，量化在离散网格上对该恒等式的违背程度；其次，评估这些违背对常用于守恒数值格式中的一阶压强预测器精度的影响。\n\n方法如下：\n\n1.  **EoS 表格生成**：对于三种指定的 EoS 模型（A、B、C）中的每一种，我们首先填充压强 $p_{ij} = p(T_i, \\mu_j)$ 和熵密度 $s_{ij} = s(T_i, \\mu_j)$ 的二维表格。这些表格构建在由温度 $T_i$（其中 $i=0, \\dots, N_T-1$）和化学势 $\\mu_j$（其中 $j=0, \\dots, N_\\mu-1$）定义的均匀网格上。\n\n2.  **数值恒等式检验**：在每个网格点 $(T_i, \\mu_j)$，通过对压强表 $p_{ij}$ 应用有限差分公式来数值近似偏导数 $\\left(\\partial p/\\partial T\\right)_{\\mu}$。按照规定，内部点使用二阶中心差分，而温度域的边界点使用一阶单边差分：\n    $$\n    \\left(\\frac{\\partial p}{\\partial T}\\right)_{\\mu}(T_i, \\mu_j) \\approx\n    \\begin{cases}\n        \\frac{p_{1,j} - p_{0,j}}{T_1 - T_0} & \\text{当 } i=0 \\\\\n        \\frac{p_{i+1,j} - p_{i-1,j}}{T_{i+1} - T_{i-1}} & \\text{当 } 1 \\le i \\le N_T-2 \\\\\n        \\frac{p_{N_T-1,j} - p_{N_T-2,j}}{T_{N_T-1} - T_{N_T-2}} & \\text{当 } i=N_T-1\n    \\end{cases}\n    $$\n    然后，恒等式偏差场 $\\Delta_{ij}$ 计算为该数值导数与表格中的熵密度之差：$\\Delta_{ij} = \\left(\\partial p/\\partial T\\right)_{\\mu}(T_i, \\mu_j) - s_{ij}$。该场的最大绝对值 $\\max_{i,j}|\\Delta_{ij}|$ 作为表格化 EoS 热力学不一致性的全局度量。对于符合恒等式的表格 A，其中 $s_A(T,\\mu) = (\\partial p_A/\\partial T)_\\mu$ 在解析上成立，计算出的 $\\Delta_{ij}$ 非零的原因仅在于有限差分近似的截断误差。对于表格 B 和 C，$\\Delta_{ij}$ 主要由 $s(T,\\mu)$ 和 $(\\partial p/\\partial T)_\\mu$ 之间设计的解析差异所决定。\n\n3.  **预测器精度评估**：为了量化 EoS 不一致性对数值预测的影响，我们分析了一个用于预测由小温度扰动 $\\Delta T$ 引起的压强变化 $\\Delta p$ 的一阶守恒预测器。该预测器使用点 $(T_i, \\mu_j)$ 处的表格熵值来估计此变化，即 $\\Delta p_{\\text{pred}} = s_{ij} \\Delta T$。通过将其与“真实”压强变化 $\\Delta p_{\\text{true}} = p(T_i+\\Delta T, \\mu_j) - p(T_i, \\mu_j)$进行比较来评估该预测的准确性，后者使用压强 $p(T, \\mu)$ 的精确解析函数形式计算。相对预测误差定义为：\n    $$\n    R_{ij}(\\Delta T) = \\frac{\\left|\\Delta p_{\\text{pred}} - \\Delta p_{\\text{true}}\\right|}{\\max\\left(\\epsilon, \\left|\\Delta p_{\\text{true}}\\right|\\right)}\n    $$\n    其中 $\\epsilon = 10^{-12}$ 是一个小的正则化参数，以防止除以零。该分析包括对三种 EoS 模型中的每一种，计算在三个指定评估点上此相对误差的平均值。\n\n计算实现包括定义压强和熵的解析函数，生成离散网格和表格，应用有限差分模板计算数值导数，并最终计算所需的两个度量：网格上的最大恒等式偏差和指定点上的平均相对预测误差。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Validates thermodynamic consistency for three synthetic equations of state (EoS)\n    by calculating identity deviation and predictor error.\n    \"\"\"\n    # --- Problem Constants and Parameters ---\n    # Table A coefficients\n    A_a = 2e-5\n    A_b = 2e-2\n    A_c = 0.3\n    A_d = 5e-3\n    \n    # Table B parameters\n    B_alpha = 3e-2\n    B_beta = 0.2\n    B_T0 = 20.0\n\n    # Table C parameters\n    C_gamma = 3e-5\n    C_eta = 1.5e-2\n    C_zeta = 2.5e-1\n    C_kappa = 0.3\n    C_lambda = 0.01\n    \n    def C_A_func(mu):\n        \"\"\"Helper function for Table C entropy.\"\"\"\n        return 5e-2 * (1 + 5e-4 * mu)\n\n    # Grid parameters\n    T_grid = np.linspace(5.0, 50.0, 10)\n    mu_grid = np.linspace(800.0, 1200.0, 9)\n    N_T = len(T_grid)\n    \n    # Evaluation points and perturbations\n    # T indices: 20 -> 3, 5 -> 0, 50 -> 9\n    # mu indices: 1000 -> 4, 900 -> 2, 1100 -> 6\n    eval_points = [\n        {'T': 20.0, 'mu': 1000.0, 'dT': 0.5, 'i': 3, 'j': 4},\n        {'T': 5.0,  'mu': 900.0,  'dT': 0.5, 'i': 0, 'j': 2},\n        {'T': 50.0, 'mu': 1100.0, 'dT': -0.5, 'i': 9, 'j': 6}\n    ]\n    epsilon = 1e-12\n\n    # --- EoS Functional Forms ---\n    # Table A (identity-compliant)\n    def p_A(T, mu):\n        return A_a * mu**2 + A_b * T * mu + A_c * T**2 + A_d * T**3\n    \n    def s_A(T, mu):\n        return A_b * mu + 2 * A_c * T + 3 * A_d * T**2\n\n    # Table B (systematic deviation)\n    def p_B(T, mu):\n        return p_A(T, mu)\n        \n    def s_B(T, mu):\n        return s_A(T, mu) * (1 + B_alpha) + B_beta * np.sin(T / B_T0)\n\n    # Table C (nonlinear p with complex deviation)\n    def p_C(T, mu):\n        return C_gamma * mu**1.5 + C_eta * T * mu**0.5 + C_zeta * T**2\n        \n    def s_C(T, mu):\n        # s_C is defined as the analytical derivative of p_C plus a deviation term\n        analytical_deriv = C_eta * mu**0.5 + 2 * C_zeta * T\n        deviation_term = C_A_func(mu) * np.sin(C_kappa * T) * np.cos(C_lambda * mu)\n        return analytical_deriv + deviation_term\n\n    # --- Main Analysis Function ---\n    def analyze_eos(p_func, s_func):\n        \"\"\"\n        Computes max identity deviation and mean relative error for a given EoS.\n        \"\"\"\n        T_mesh, mu_mesh = np.meshgrid(T_grid, mu_grid, indexing='ij')\n\n        # Generate discrete EoS tables from analytical functions\n        p_table = p_func(T_mesh, mu_mesh)\n        s_table = s_func(T_mesh, mu_mesh)\n        \n        # --- 1. Calculate Maximum Absolute Identity Deviation ---\n        dp_dT_table = np.zeros_like(p_table)\n        \n        # Uniform grid spacing in temperature\n        delta_T = T_grid[1] - T_grid[0]\n        \n        # Numerical derivatives using specified finite difference schemes\n        # i=0 (forward difference, O(h))\n        dp_dT_table[0, :] = (p_table[1, :] - p_table[0, :]) / delta_T\n        # i=N_T-1 (backward difference, O(h))\n        dp_dT_table[-1, :] = (p_table[-1, :] - p_table[-2, :]) / delta_T\n        # 1 = i = N_T-2 (central difference, O(h^2))\n        if N_T > 2:\n            dp_dT_table[1:-1, :] = (p_table[2:, :] - p_table[:-2, :]) / (2 * delta_T)\n\n        Delta_table = dp_dT_table - s_table\n        max_deviation = np.max(np.abs(Delta_table))\n        \n        # --- 2. Calculate Mean Relative Prediction Error ---\n        relative_errors = []\n        for point in eval_points:\n            T, mu, dT = point['T'], point['mu'], point['dT']\n            i, j = point['i'], point['j']\n            \n            # Predictor uses entropy value from the generated table\n            s_val = s_table[i, j]\n            dp_pred = s_val * dT\n            \n            # \"True\" change is computed from the analytical pressure function\n            dp_true = p_func(T + dT, mu) - p_func(T, mu)\n            \n            # Relative error calculation\n            error = np.abs(dp_pred - dp_true)\n            denominator = np.maximum(epsilon, np.abs(dp_true))\n            relative_error = error / denominator\n            relative_errors.append(relative_error)\n            \n        mean_relative_error = np.mean(relative_errors)\n        \n        return max_deviation, mean_relative_error\n\n    # --- Run Analysis for each Table ---\n    results = []\n    \n    # Table A\n    max_dev_A, mean_err_A = analyze_eos(p_A, s_A)\n    results.extend([max_dev_A, mean_err_A])\n\n    # Table B: p_func is p_B (same as p_A), s_func is s_B.\n    # The deviation is (numerical_deriv(p_A) - s_B).\n    # Since s_A is the analytical derivative, the deviation is approx. (s_A - s_B)\n    max_dev_B, mean_err_B = analyze_eos(p_B, s_B)\n    results.extend([max_dev_B, mean_err_B])\n    \n    # Table C: The definition of s_C is p_C's derivative + a deviation.\n    # So the deviation is approx. the deviation term itself.\n    max_dev_C, mean_err_C = analyze_eos(p_C, s_C)\n    results.extend([max_dev_C, mean_err_C])\n\n    # --- Format and Print Output ---\n    output_str = ','.join([f\"{x:.6f}\" for x in results])\n    print(f\"[{output_str}]\")\n\nsolve()\n```", "id": "3473643"}]}