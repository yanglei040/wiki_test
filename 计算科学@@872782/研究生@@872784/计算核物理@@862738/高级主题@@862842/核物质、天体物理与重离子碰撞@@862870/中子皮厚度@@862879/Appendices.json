{"hands_on_practices": [{"introduction": "“中子皮厚度”这一概念可以通过多种方式来定义。本练习 [@problem_id:3573370] 提供了一个关键的解析性训练，它利用Sommerfeld展开，将常见的均方根（$\\text{rms}$）半径定义与一个更简单的基于半密度半径的定义联系起来。掌握此练习有助于理解核表面性质（如弥散度）如何影响中子皮厚度，并突出了在比较理论计算与实验数据时所涉及的细微之处。", "problem": "一个球形核用中子和质子的双参数费米(2pF)密度来建模。对于每种粒子 $q \\in \\{n,p\\}$，其密度为\n$$\n\\rho_{q}(r) = \\frac{\\rho_{0q}}{1 + \\exp\\!\\left(\\frac{r - C_{q}}{a_{q}}\\right)},\n$$\n其中 $C_{q}$ 是半密度半径，$a_{q}$ 是弥散度，$\\rho_{0q}$ 是中心密度常数。由均方根(rms)半径定义的中子皮厚度为\n$$\n\\Delta r_{np} \\equiv \\sqrt{\\langle r^{2} \\rangle_{n}} - \\sqrt{\\langle r^{2} \\rangle_{p}}\n$$\n其中\n$$\n\\langle r^{2} \\rangle_{q} \\equiv \\frac{\\displaystyle \\int_{0}^{\\infty} r^{4} \\rho_{q}(r) \\, dr}{\\displaystyle \\int_{0}^{\\infty} r^{2} \\rho_{q}(r) \\, dr}\n$$\n另一种“半密度皮”是 $\\Delta C \\equiv C_{n} - C_{p}$。在薄皮极限 $a_{q}/C_{q} \\ll 1$ (对于 $q \\in \\{n,p\\}$)下，从上述定义出发，对定义积分进行受控的渐近展开，直到 $a_{q}/C_{q}$ 的领头非平凡阶。用此结果将 $\\Delta r_{np}$ 表示为 $(C_{n},a_{n})$ 和 $(C_{p},a_{p})$ 的函数，然后确定领头阶修正\n$$\nS \\equiv \\Delta r_{np} - \\sqrt{\\frac{3}{5}}\\,\\Delta C,\n$$\n保留至 $(a_{q}/C_{q})^{2}$ 阶的项，忽略更高阶。你的最终答案必须是 $S$ 关于 $C_{n}$, $C_{p}$, $a_{n}$ 和 $a_{p}$ 的单个闭式解析表达式。此外，简要用文字说明（不需公式）在哪种定性参数区间，基于均方根的定义和基于半密度的定义差异最大，但最终答案只需报告 $S$ 的解析表达式。无需进行数值计算。", "solution": "该问题要求推导量 $S \\equiv \\Delta r_{np} - \\sqrt{\\frac{3}{5}}\\,\\Delta C$ 的表达式，它代表了两种中子皮厚度定义之间的领头阶修正。推导将在薄皮极限 $a_q/C_q \\ll 1$ 下进行，用于一个由中子($q=n$)和质子($q=p$)的双参数费米(2pF)密度描述的原子核。\n\n问题的核心是计算每种粒子 $q$ 的均方半径 $\\langle r^2 \\rangle_q$：\n$$\n\\langle r^2 \\rangle_{q} = \\frac{\\displaystyle \\int_{0}^{\\infty} r^{4} \\rho_{q}(r) \\, dr}{\\displaystyle \\int_{0}^{\\infty} r^{2} \\rho_{q}(r) \\, dr}\n$$\n密度分布由下式给出\n$$\n\\rho_{q}(r) = \\frac{\\rho_{0q}}{1 + \\exp\\left(\\frac{r - C_{q}}{a_{q}}\\right)}\n$$\n分子和分母中的积分是费米-狄拉克分布的矩。在薄皮极限($a_q \\to 0$)下，该分布在 $r = C_q$ 处趋近于一个阶跃函数。对于小的但有限的 $a_q$，这些积分可以使用索末菲展开来计算。对于形式为 $I = \\int_{0}^{\\infty} H(r) f(r) dr$ 的积分，其中 $f(r)$ 是费米函数，其展开为：\n$$\n\\int_{0}^{\\infty} \\frac{H(r)}{1 + \\exp\\left(\\frac{r - C}{a}\\right)} dr \\approx \\int_{0}^{C} H(r) \\, dr + \\frac{\\pi^2 a^2}{6} H'(C) + \\mathcal{O}(a^4)\n$$\n其中 $H'(C)$ 是 $H(r)$ 在 $r=C$ 处的导数。\n\n让我们将此展开应用于 $\\langle r^2 \\rangle_q$ 的积分。归一化常数 $\\rho_{0q}$ 在比值中会消掉，因此我们可以忽略它。\n\n对于分子积分（我们记为 $I_4$），我们有 $H(r) = r^4$。其导数为 $H'(r) = 4r^3$。应用索末菲展开：\n$$\nI_4 = \\int_{0}^{\\infty} \\frac{r^4}{1 + \\exp\\left(\\frac{r - C_{q}}{a_{q}}\\right)} dr \\approx \\int_{0}^{C_q} r^4 \\, dr + \\frac{\\pi^2 a_q^2}{6} (4C_q^3) = \\frac{C_q^5}{5} + \\frac{2\\pi^2 a_q^2 C_q^3}{3}\n$$\n\n对于分母积分 $I_2$，我们有 $H(r) = r^2$。其导数为 $H'(r) = 2r$。应用索末菲展开：\n$$\nI_2 = \\int_{0}^{\\infty} \\frac{r^2}{1 + \\exp\\left(\\frac{r - C_{q}}{a_{q}}\\right)} dr \\approx \\int_{0}^{C_q} r^2 \\, dr + \\frac{\\pi^2 a_q^2}{6} (2C_q) = \\frac{C_q^3}{3} + \\frac{\\pi^2 a_q^2 C_q}{3}\n$$\n\n现在，我们计算比值 $\\langle r^2 \\rangle_q = I_4 / I_2$：\n$$\n\\langle r^2 \\rangle_q \\approx \\frac{\\frac{C_q^5}{5} + \\frac{2\\pi^2 a_q^2 C_q^3}{3}}{\\frac{C_q^3}{3} + \\frac{\\pi^2 a_q^2 C_q}{3}} = \\frac{\\frac{C_q^5}{5} \\left(1 + \\frac{10\\pi^2}{3} \\frac{a_q^2}{C_q^2}\\right)}{\\frac{C_q^3}{3} \\left(1 + \\pi^2 \\frac{a_q^2}{C_q^2}\\right)}\n$$\n这可以简化为：\n$$\n\\langle r^2 \\rangle_q \\approx \\frac{3}{5} C_q^2 \\frac{1 + \\frac{10\\pi^2}{3} \\frac{a_q^2}{C_q^2}}{1 + \\pi^2 \\frac{a_q^2}{C_q^2}}\n$$\n对小的 $x = \\pi^2 (a_q/C_q)^2$ 使用近似 $(1+x)^{-1} \\approx 1-x$：\n$$\n\\langle r^2 \\rangle_q \\approx \\frac{3}{5} C_q^2 \\left(1 + \\frac{10\\pi^2}{3} \\frac{a_q^2}{C_q^2}\\right) \\left(1 - \\pi^2 \\frac{a_q^2}{C_q^2}\\right) \\approx \\frac{3}{5} C_q^2 \\left(1 + \\left(\\frac{10\\pi^2}{3} - \\pi^2\\right) \\frac{a_q^2}{C_q^2}\\right)\n$$\n$$\n\\langle r^2 \\rangle_q \\approx \\frac{3}{5} C_q^2 \\left(1 + \\frac{7\\pi^2}{3} \\frac{a_q^2}{C_q^2}\\right) = \\frac{3}{5}C_q^2 + \\frac{7\\pi^2}{5}a_q^2\n$$\n该表达式相对于领头项，精确到 $(a_q/C_q)^2$ 阶。\n\n接下来，我们求均方根(rms)半径 $\\sqrt{\\langle r^2 \\rangle_q}$：\n$$\n\\sqrt{\\langle r^2 \\rangle_q} = \\sqrt{\\frac{3}{5}C_q^2 + \\frac{7\\pi^2}{5}a_q^2} = \\sqrt{\\frac{3}{5}} C_q \\sqrt{1 + \\frac{7\\pi^2}{3}\\frac{a_q^2}{C_q^2}}\n$$\n对小的 $x$ 使用泰勒展开 $\\sqrt{1+x} \\approx 1 + \\frac{x}{2}$：\n$$\n\\sqrt{\\langle r^2 \\rangle_q} \\approx \\sqrt{\\frac{3}{5}} C_q \\left(1 + \\frac{1}{2} \\frac{7\\pi^2}{3}\\frac{a_q^2}{C_q^2}\\right) = \\sqrt{\\frac{3}{5}} C_q + \\sqrt{\\frac{3}{5}} \\frac{7\\pi^2}{6} \\frac{a_q^2}{C_q}\n$$\n保留的项最高到 $C_q(a_q/C_q)^2 = a_q^2/C_q$ 阶，这符合问题对 $S$ 的隐含精度要求。\n\n现在我们可以写出基于均方根的中子皮厚度 $\\Delta r_{np}$：\n$$\n\\Delta r_{np} = \\sqrt{\\langle r^2 \\rangle_{n}} - \\sqrt{\\langle r^2 \\rangle_{p}}\n$$\n$$\n\\Delta r_{np} \\approx \\left(\\sqrt{\\frac{3}{5}} C_n + \\sqrt{\\frac{3}{5}} \\frac{7\\pi^2}{6} \\frac{a_n^2}{C_n}\\right) - \\left(\\sqrt{\\frac{3}{5}} C_p + \\sqrt{\\frac{3}{5}} \\frac{7\\pi^2}{6} \\frac{a_p^2}{C_p}\\right)\n$$\n$$\n\\Delta r_{np} \\approx \\sqrt{\\frac{3}{5}} (C_n - C_p) + \\sqrt{\\frac{3}{5}} \\frac{7\\pi^2}{6} \\left(\\frac{a_n^2}{C_n} - \\frac{a_p^2}{C_p}\\right)\n$$\n使用定义 $\\Delta C = C_n - C_p$，这变为：\n$$\n\\Delta r_{np} \\approx \\sqrt{\\frac{3}{5}} \\Delta C + \\sqrt{\\frac{3}{5}} \\frac{7\\pi^2}{6} \\left(\\frac{a_n^2}{C_n} - \\frac{a_p^2}{C_p}\\right)\n$$\n最后，我们计算修正项 $S$：\n$$\nS = \\Delta r_{np} - \\sqrt{\\frac{3}{5}} \\Delta C\n$$\n代入我们得到的 $\\Delta r_{np}$ 表达式：\n$$\nS \\approx \\left(\\sqrt{\\frac{3}{5}} \\Delta C + \\sqrt{\\frac{3}{5}} \\frac{7\\pi^2}{6} \\left(\\frac{a_n^2}{C_n} - \\frac{a_p^2}{C_p}\\right)\\right) - \\sqrt{\\frac{3}{5}} \\Delta C\n$$\n$$\nS \\approx \\sqrt{\\frac{3}{5}} \\frac{7\\pi^2}{6} \\left(\\frac{a_n^2}{C_n} - \\frac{a_p^2}{C_p}\\right)\n$$\n这就是所求的 $S$ 关于给定参数的闭式表达式。\n\n定性地看，量 $S$ 衡量了基于均方根的皮厚度与更简单的半密度皮定义之间的偏差。当核表面更弥散时，这种偏差变得最显著。根据推导出的 $S$ 的表达式，当弥散度参数（$a_n$ 和 $a_p$）很大且彼此差异显著时，这种差异最大。在较轻的原子核中，这种效应被进一步放大，因为其半密度半径（$C_n$ 和 $C_p$）较小，使得相对于整个原子核的大小，表面弥散度成为一个更突出的特征。", "answer": "$$\n\\boxed{\\sqrt{\\frac{3}{5}} \\frac{7\\pi^2}{6} \\left(\\frac{a_{n}^2}{C_{n}} - \\frac{a_{p}^2}{C_{p}}\\right)}\n$$", "id": "3573370"}, {"introduction": "现在，我们从纯理论转向应用建模。本练习 [@problem_id:3573314] 将指导您为锡同位素链构建一个计算模型，以探索中子皮厚度的演变。它展示了如何融合关键的物理要素，如对关联和连续谱耦合，这对于靠近中子滴线的丰中子核尤为重要。此练习对于学习如何将物理概念转化为可定量的预测框架至关重要。", "problem": "您的任务是构建一个计算模型，以量化中子配对强度和连续谱耦合如何影响以原子序数为 $Z = 50$ 的双幻核为中心的锡同位素链的中子皮厚度。中子皮厚度记作 $\\Delta r_{np}$，定义为中子和质子方均根半径之差：\n$$\n\\Delta r_{np} = r_{\\mathrm{rms},n} - r_{\\mathrm{rms},p},\n$$\n其中，对于球对称的单体密度 $\\rho_q(r)$（$q \\in \\{n,p\\}$），方均根半径为\n$$\nr_{\\mathrm{rms},q} = \\sqrt{\\frac{\\int_0^\\infty 4\\pi r^4 \\rho_q(r)\\,dr}{\\int_0^\\infty 4\\pi r^2 \\rho_q(r)\\,dr}}\n$$\n您的模型必须从密度和径向积分的基本定义出发，并包含有物理动机的配对和连续谱耦合要素。假设每种核子都具有球形平均场密度。质子密度被建模为双参数费米分布（也称为 Woods–Saxon 形状）：\n$$\n\\rho_p(r) = \\frac{\\rho_{0,p}}{1 + \\exp\\!\\left(\\frac{r - c_p}{a_p}\\right)},\n$$\n归一化条件为\n$$\n\\int_0^\\infty 4\\pi r^2 \\rho_p(r)\\,dr = Z。\n$$\n中子密度由一个核芯和一个晕状尾部组成，当有效分离能因连续谱耦合而减小时，尾部的作用变得显著。核芯的建模方式类似：\n$$\n\\rho_{n,\\mathrm{core}}(r) = \\frac{\\rho_{0,n}}{1 + \\exp\\!\\left(\\frac{r - c_n}{a_n}\\right)},\n$$\n归一化到核芯中子数：\n$$\n\\int_0^\\infty 4\\pi r^2 \\rho_{n,\\mathrm{core}}(r)\\,dr = N_{\\mathrm{core}} = N \\left(1 - f_{\\mathrm{tail}}\\right)。\n$$\n尾部被建模为中子半密度半径之外的指数形式，这源于具有有效分离能的束缚态的渐近单粒子行为。定义 $r \\ge 0$ 的尾部密度为\n$$\n\\rho_{n,\\mathrm{tail}}(r) = C_{\\mathrm{tail}} \\times \\Theta(r - c_n)\\,\\exp\\!\\big(-2\\kappa\\,(r - c_n)\\big),\n$$\n其中 $\\Theta$ 是亥维赛德阶跃函数，波数 $\\kappa$ 由有效分离能设定\n$$\nS_{\\mathrm{eff}} = \\max\\!\\big(S_n - \\gamma\\,\\Delta,\\,\\varepsilon_{\\min}\\big), \\quad\n\\kappa = \\frac{\\sqrt{2 m_n S_{\\mathrm{eff}}}}{\\hbar}。\n$$\n尾部强度 $C_{\\mathrm{tail}}$ 的选择必须保证中子通道中的粒子数守恒：\n$$\n\\int_0^\\infty 4\\pi r^2 \\rho_{n,\\mathrm{tail}}(r)\\,dr = N_{\\mathrm{tail}} = N\\,f_{\\mathrm{tail}}。\n$$\n尾部的积分将通过变量替换 $u = r - c_n$ 并使用\n$$\n\\int_0^\\infty u^n e^{-a u}\\,du = \\frac{n!}{a^{n+1}}, \\quad a = 2\\kappa,\n$$\n进行解析计算，以获得\n$$\nM_2(c_n,\\kappa) = \\int_0^\\infty 4\\pi r^2 \\Theta(r - c_n) e^{-2\\kappa(r - c_n)}\\,dr,\n$$\n和\n$$\nM_4(c_n,\\kappa) = \\int_0^\\infty 4\\pi r^4 \\Theta(r - c_n) e^{-2\\kappa(r - c_n)}\\,dr,\n$$\n的闭合形式表达式，从而得到 $C_{\\mathrm{tail}} = N_{\\mathrm{tail}} / M_2(c_n,\\kappa)$ 并且尾部对中子四阶矩的贡献为 $C_{\\mathrm{tail}}\\,M_4(c_n,\\kappa)$。\n\n所有引入的符号和常数必须按如下方式进行数值指定：\n- 使用球形半径参数\n$$\nR = r_0 A^{1/3}, \\quad r_0 = 1.2 \\ \\text{fm}.\n$$\n- 同位旋不对称性使半密度半径发生偏移：\n$$\n\\delta = \\frac{N - Z}{A}, \\quad\nc_n = R + s_n\\,\\delta, \\quad c_p = R - s_p\\,\\delta,\n$$\n其中\n$$\ns_n = 0.9 \\ \\text{fm}, \\quad s_p = 0.6 \\ \\text{fm}.\n$$\n- 质子弥散度是固定的：\n$$\na_p = 0.55 \\ \\text{fm}.\n$$\n- 中子弥散度依赖于配对（其动机源于费米液体表面响应）：\n$$\na_n = a_p \\left(1 + \\eta \\frac{\\Delta}{E_F}\\right),\n$$\n其中\n$$\n\\eta = 0.5, \\quad E_F = 37.0 \\ \\text{MeV}.\n$$\n- 中子尾部分数是配对强度 $\\Delta$ 和连续谱耦合参数 $\\gamma$ 的函数：\n$$\nf_{\\mathrm{tail}} = \\min\\!\\left(0.25,\\, \\alpha\\,\\gamma\\,\\frac{\\Delta}{S_n + \\Delta}\\right),\n$$\n其中\n$$\n\\alpha = 0.2.\n$$\n- 使用单位一致的中子质量和约化普朗克常数：\n$$\nm_n = 939.0 \\ \\text{MeV}, \\quad \\hbar = 197.3269804 \\ \\text{MeV}\\cdot\\text{fm}.\n$$\n- 对有效分离能施加一个下限，以避免出现奇异的尾部：\n$$\n\\varepsilon_{\\min} = 0.05 \\ \\text{MeV}.\n$$\n\n基于这些要素，通过强制执行指定的归一化条件来构建 $\\rho_p(r)$ 和 $\\rho_n(r) = \\rho_{n,\\mathrm{core}}(r) + \\rho_{n,\\mathrm{tail}}(r)$。计算\n$$\nr_{\\mathrm{rms},p} = \\sqrt{\\frac{\\int_0^\\infty 4\\pi r^4 \\rho_p(r)\\,dr}{Z}}, \\quad\nr_{\\mathrm{rms},n} = \\sqrt{\\frac{\\int_0^\\infty 4\\pi r^4 \\rho_n(r)\\,dr}{N}},\n$$\n并报告下面每个测试用例的 $\\Delta r_{np}$（单位为飞米）。\n\n您的程序必须生成单行输出，其中包含一个用方括号括起来的逗号分隔的结果列表，例如 $\\left[\\text{result}_1,\\text{result}_2,\\dots\\right]$。每个结果必须是四舍五入到四位小数并以飞米表示的浮点数。\n\n为以下测试套件实现计算，这些测试套件代表了 $^{132}\\mathrm{Sn}$ 同位素链上具有不同中子数、配对强度、连续谱耦合和中子分离能的点：\n- 案例 1：$(A,Z,N,\\Delta,\\gamma,S_n) = (132, 50, 82, 1.0, 0.0, 7.5)$。\n- 案例 2：$(A,Z,N,\\Delta,\\gamma,S_n) = (134, 50, 84, 1.1, 0.3, 6.2)$。\n- 案例 3：$(A,Z,N,\\Delta,\\gamma,S_n) = (140, 50, 90, 1.2, 0.5, 3.0)$。\n- 案例 4：$(A,Z,N,\\Delta,\\gamma,S_n) = (150, 50, 100, 1.4, 0.8, 1.2)$。\n- 案例 5：$(A,Z,N,\\Delta,\\gamma,S_n) = (160, 50, 110, 1.5, 1.0, 0.3)$。\n\n将每个案例的最终结果 $\\Delta r_{np}$（以飞米为单位，四舍五入到四位小数）以单行格式 $\\left[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4,\\text{result}_5\\right]$ 表示。", "solution": "目标是为一系列锡同位素 ($Z=50$) 计算中子皮厚度 $\\Delta r_{np} = r_{\\mathrm{rms},n} - r_{\\mathrm{rms},p}$。这需要计算中子 ($r_{\\mathrm{rms},n}$) 和质子 ($r_{\\mathrm{rms},p}$) 的方均根 (rms) 半径。该方法基于一个唯象模型，该模型包含了指定的质子和中子密度分布。每个测试案例 $(A, Z, N, \\Delta, \\gamma, S_n)$ 的计算按以下步骤进行。\n\n**第 1 步：模型参数的计算**\n\n首先，对于由质量数 $A$、质子数 $Z$ 和中子数 $N$ 定义的每个同位素，我们根据提供的公式计算几个关键参数。\n\n- 同位旋不对称性为 $\\delta = \\frac{N - Z}{A}$。\n- 球形核半径为 $R = r_0 A^{1/3}$，其中 $r_0 = 1.2 \\ \\text{fm}$。\n- 质子和中子的半密度半径因同位旋不对称性而偏移：$c_p = R - s_p\\delta$ 和 $c_n = R + s_n\\delta$，使用 $s_p = 0.6 \\ \\text{fm}$ 和 $s_n = 0.9 \\ \\text{fm}$。\n- 质子弥散度为常数，$a_p = 0.55 \\ \\text{fm}$。\n- 中子弥散度依赖于配对能隙 $\\Delta$，即 $a_n = a_p (1 + \\eta \\frac{\\Delta}{E_F})$，其中 $\\eta = 0.5$ 且费米能量 $E_F = 37.0 \\ \\text{MeV}$。\n- 尾部中子的比例 $f_{\\mathrm{tail}}$ 由配对 $\\Delta$、连续谱耦合 $\\gamma$ 和单中子分离能 $S_n$ 决定：$f_{\\mathrm{tail}} = \\min(0.25, \\alpha \\gamma \\frac{\\Delta}{S_n + \\Delta})$，其中 $\\alpha = 0.2$。\n- 尾部的有效分离能 $S_{\\mathrm{eff}}$ 由 $S_{\\mathrm{eff}} = \\max(S_n - \\gamma\\Delta, \\varepsilon_{\\min})$ 给出，其下限为 $\\varepsilon_{\\min} = 0.05 \\ \\text{MeV}$ 以防止奇点。\n- 从 $S_{\\mathrm{eff}}$ 计算衰变波数 $\\kappa$：$\\kappa = \\frac{\\sqrt{2 m_n S_{\\mathrm{eff}}}}{\\hbar}$，使用提供的常数 $m_n = 939.0 \\ \\text{MeV}$ 和 $\\hbar = 197.3269804 \\ \\text{MeV}\\cdot\\text{fm}$。\n\n**第 2 步：质子方均根半径的计算**\n\n质子 rms 半径 $r_{\\mathrm{rms},p}$ 从质子密度 $\\rho_p(r)$ 推导得出，该密度服从 Woods-Saxon 形状。rms 半径平方的定义是：\n$$\nr_{\\mathrm{rms},p}^2 = \\frac{\\int_0^\\infty 4\\pi r^4 \\rho_p(r)\\,dr}{\\int_0^\\infty 4\\pi r^2 \\rho_p(r)\\,dr} = \\frac{\\int_0^\\infty 4\\pi r^4 \\rho_p(r)\\,dr}{Z}.\n$$\n代入 $\\rho_p(r) = \\frac{\\rho_{0,p}}{1 + \\exp((r - c_p)/a_p)}$，归一化常数 $\\rho_{0,p}$ 在比率中被抵消：\n$$\nr_{\\mathrm{rms},p}^2 = \\frac{\\int_0^\\infty \\frac{4\\pi r^4}{1 + \\exp((r - c_p)/a_p)}\\,dr}{\\int_0^\\infty \\frac{4\\pi r^2}{1 + \\exp((r - c_p)/a_p)}\\,dr} = \\frac{I_{4,p}}{I_{2,p}}.\n$$\n积分 $I_{2,p}$（形状函数的二阶矩，与体积有关）和 $I_{4,p}$（四阶矩）没有简单的解析解，需要进行数值计算。最终的质子 rms 半径为 $r_{\\mathrm{rms},p} = \\sqrt{I_{4,p}/I_{2,p}}$。\n\n**第 3 步：中子方均根半径的计算**\n\n中子密度是核芯和尾部组分之和，$\\rho_n(r) = \\rho_{n,\\mathrm{core}}(r) + \\rho_{n,\\mathrm{tail}}(r)$。中子总数相应地被划分：$N = N_{\\mathrm{core}} + N_{\\mathrm{tail}}$，其中 $N_{\\mathrm{core}} = N(1-f_{\\mathrm{tail}})$ 和 $N_{\\mathrm{tail}} = N f_{\\mathrm{tail}}$。中子的 rms 半径平方是核芯和尾部组分均方半径的加权平均值：\n$$\nr_{\\mathrm{rms},n}^2 = \\frac{1}{N} \\int_0^\\infty 4\\pi r^4 \\rho_n(r)\\,dr = (1-f_{\\mathrm{tail}})r_{\\mathrm{rms,core}}^2 + f_{\\mathrm{tail}}r_{\\mathrm{rms,tail}}^2.\n$$\n\n**第 3a 步：中子核芯半径**\n核芯密度 $\\rho_{n,\\mathrm{core}}(r)$ 具有类似于质子密度的 Woods-Saxon 形状，但使用参数 $c_n$ 和 $a_n$。核芯的均方半径 $r_{\\mathrm{rms,core}}^2$ 的计算方法与质子情况类似：\n$$\nr_{\\mathrm{rms,core}}^2 = \\frac{\\int_0^\\infty \\frac{4\\pi r^4}{1 + \\exp((r - c_n)/a_n)}\\,dr}{\\int_0^\\infty \\frac{4\\pi r^2}{1 + \\exp((r - c_n)/a_n)}\\,dr} = \\frac{I_{4,n}}{I_{2,n}}.\n$$\n这些积分 $I_{2,n}$ 和 $I_{4,n}$ 也通过数值方法计算。\n\n**第 3b 步：中子尾部半径**\n尾部密度由 $\\rho_{n,\\mathrm{tail}}(r) = C_{\\mathrm{tail}} \\Theta(r - c_n)\\exp(-2\\kappa(r - c_n))$ 给出。尾部的均方半径由其矩的比值定义：\n$$\nr_{\\mathrm{rms,tail}}^2 = \\frac{\\int_0^\\infty 4\\pi r^4 \\Theta(r - c_n)e^{-2\\kappa(r-c_n)}\\,dr}{\\int_0^\\infty 4\\pi r^2 \\Theta(r - c_n)e^{-2\\kappa(r-c_n)}\\,dr} = \\frac{M_4(c_n, \\kappa)}{M_2(c_n, \\kappa)}.\n$$\n按照指示，这些积分被解析地计算。令 $u = r - c_n$。积分上下限变为 $0$ 到 $\\infty$。\n对于 $M_2$，我们有：\n$$\nM_2(c_n,\\kappa) = 4\\pi \\int_0^\\infty (u+c_n)^2 e^{-2\\kappa u}\\,du = 4\\pi \\int_0^\\infty (u^2 + 2c_n u + c_n^2) e^{-2\\kappa u}\\,du.\n$$\n使用恒等式 $\\int_0^\\infty u^n e^{-au}\\,du = n!/a^{n+1}$，其中 $a=2\\kappa$：\n$$\nM_2(c_n,\\kappa) = 4\\pi \\left( \\frac{2!}{(2\\kappa)^3} + 2c_n\\frac{1!}{(2\\kappa)^2} + c_n^2\\frac{0!}{(2\\kappa)^1} \\right) = \\frac{\\pi}{\\kappa^3} (1 + 2c_n\\kappa + 2c_n^2\\kappa^2).\n$$\n对于 $M_4$，同样的过程得到：\n$$\nM_4(c_n,\\kappa) = 4\\pi \\int_0^\\infty (u+c_n)^4 e^{-2\\kappa u}\\,du = 4\\pi \\int_0^\\infty (u^4 + 4c_n u^3 + 6c_n^2 u^2 + 4c_n^3 u + c_n^4) e^{-2\\kappa u}\\,du.\n$$\n$$\nM_4(c_n,\\kappa) = 4\\pi \\left( \\frac{4!}{(2\\kappa)^5} + 4c_n\\frac{3!}{(2\\kappa)^4} + 6c_n^2\\frac{2!}{(2\\kappa)^3} + 4c_n^3\\frac{1!}{(2\\kappa)^2} + c_n^4\\frac{0!}{(2\\kappa)^1} \\right),\n$$\n这可以简化为：\n$$\nM_4(c_n,\\kappa) = \\frac{\\pi}{\\kappa^5} (3 + 6c_n\\kappa + 6c_n^2\\kappa^2 + 4c_n^3\\kappa^3 + 2c_n^4\\kappa^4).\n$$\n$r_{\\mathrm{rms,tail}}^2$ 的值然后由这些闭合形式表达式的比值计算得出。如果 $f_{\\mathrm{tail}}=0$，则此项对 $r_{\\mathrm{rms},n}^2$ 没有贡献。\n\n**第 3c 步：总中子半径**\n最后，总中子 rms 半径由各组分组合而成：\n$$\nr_{\\mathrm{rms},n} = \\sqrt{(1-f_{\\mathrm{tail}})r_{\\mathrm{rms,core}}^2 + f_{\\mathrm{tail}}r_{\\mathrm{rms,tail}}^2}.\n$$\n\n**第 4 步：中子皮厚度**\n\n中子皮厚度是中子和质子 rms 半径之差：\n$$\n\\Delta r_{np} = r_{\\mathrm{rms},n} - r_{\\mathrm{rms},p}.\n$$\n\n**第 5 步：算法实现**\n上述过程被编码成一个程序。对于 5 个测试用例中的每一个，计算参数，使用数值积分 (`scipy.integrate.quad`) 计算 Woods-Saxon 分布所需的矩积分，计算尾部矩的解析公式，并组合结果以求得 $\\Delta r_{np}$。最终值四舍五入到 4 位小数，并以所需的列表格式呈现。", "answer": "[0.2238,0.2520,0.3013,0.3707,0.4496]", "id": "3573314"}, {"introduction": "我们的实践部分将以数值验证这一关键主题收尾。任何计算结果都可能受到数值误差的影响，而本练习 [@problem_id:3573312] 将演示如何进行系统的收敛性研究。通过分析网格间距、计算盒子大小和求解器容差的影响，您将学会如何确定计算的数值精度，这是任何计算物理学家的基本技能。", "problem": "您的任务是设计并实现一个完整的、可运行的数值程序，用于对球形核中的中子皮厚度（记为 $\\Delta r_{np}$）进行收敛性研究。需要计算的物理量应基于连续分布和有限计算域上的数值积分的第一性原理推导得出，而不是依赖于简化公式。您的程序必须分析计算出的 $\\Delta r_{np}$ 如何依赖于三个数值参数：径向网格间距 $dr$、球形盒子半径 $R_{\\mathrm{box}}$，以及用于确定形状参数的迭代容差 $\\mathrm{tol}$。\n\n从以下基础出发：\n- 在三维空间中，一个球对称粒子密度 $\\rho(r)$ 通过体积分贡献于总粒子数，中子数为 $N = \\int 4\\pi r^2 \\rho(r)\\,dr$，质子数为 $Z = \\int 4\\pi r^2 \\rho(r)\\,dr$，其中积分遍及整个物理空间。\n- 对于具有球对称密度 $\\rho(r)$ 的粒子种类，其均方根半径定义为 $$r_{\\mathrm{rms}} = \\sqrt{\\frac{\\int 4\\pi r^4 \\rho(r)\\,dr}{\\int 4\\pi r^2 \\rho(r)\\,dr}}$$。\n- 中子皮厚度定义为 $\\Delta r_{np} = r_{\\mathrm{rms}}^{(n)} - r_{\\mathrm{rms}}^{(p)}$，其中 $r_{\\mathrm{rms}}^{(n)}$ 和 $r_{\\mathrm{rms}}^{(p)}$ 分别是中子和质子的均方根半径。\n\n使用具有球对称性的双参数费米分布（也称为 Woods–Saxon 分布）来模拟中子和质子密度，\n$$\n\\rho_{q}(r;c_q,a_q,\\rho_{0,q}) = \\frac{\\rho_{0,q}}{1 + \\exp\\!\\left(\\frac{r - c_q}{a_q}\\right)} \\quad \\text{for } q \\in \\{n,p\\},\n$$\n其中 $c_q$ 是半密度半径，$a_q$ 是表面弥散度，$\\rho_{0,q}$ 是中心密度标度。对于质量数为 $A$ 的铅核，使用以下物理上合理的固定参数：\n- 原子核：$^{208}\\mathrm{Pb}$，其中 $A = 208$，中子数 $N = 126$，质子数 $Z = 82$。\n- 表面弥散度：$a_n = a_p = 0.55\\ \\mathrm{fm}$。\n- 饱和中心密度：$\\rho_{\\mathrm{sat}} = 0.16\\ \\mathrm{fm}^{-3}$。\n- 按同位旋分数分配的中心密度：$\\rho_{0,n} = \\rho_{\\mathrm{sat}}\\cdot \\dfrac{N}{A}$ 和 $\\rho_{0,p} = \\rho_{\\mathrm{sat}}\\cdot \\dfrac{Z}{A}$。\n\n关键在于，通过求解归一化条件\n$$\n\\int_0^{R_{\\mathrm{box}}} 4\\pi r^2 \\rho_{n}(r;c_n,a_n,\\rho_{0,n})\\,dr = N, \\qquad\n\\int_0^{R_{\\mathrm{box}}} 4\\pi r^2 \\rho_{p}(r;c_p,a_p,\\rho_{0,p})\\,dr = Z,\n$$\n来确定形状参数 $c_n$ 和 $c_p$。此求解过程在有限数值域 $r \\in [0, R_{\\mathrm{box}}]$ 上进行，并使用一个不假设存在解析解的、稳健的一维求根程序。当归一化的相对残差低于指定的 $\\mathrm{tol}$，或达到迭代次数上限时，迭代必须终止。您的算法必须为 $c_q$ 搜索一个有效区间（确保目标归一化值可在 $[c_{\\mathrm{min}}, c_{\\mathrm{max}}]$ 内达到），并且必须妥善处理 $R_{\\mathrm{box}}$ 过小而无法实现精确归一化的情况（在这种情况下，$c_q$ 应被限制在区间内可行的最大值）。\n\n在径向网格 $r_k = k\\cdot dr$（其中整数 $k$ 满足 $0 \\le r_k \\le R_{\\mathrm{box}}$）上，使用与网格间距 $dr$ 一致的复合数值积分格式来计算积分。中子皮厚度 $\\Delta r_{np}$ 必须以飞米（fm）为单位进行评估。为了评估收敛性，需要定义一个高精度参考值 $\\Delta r_{np}^{\\mathrm{ref}}$，该值在非常精细的网格、大的盒子和严格的容差下计算得出，并以飞米为单位测量绝对偏差\n$$\n\\varepsilon(dr, R_{\\mathrm{box}}, \\mathrm{tol}) = \\left|\\Delta r_{np}(dr, R_{\\mathrm{box}}, \\mathrm{tol}) - \\Delta r_{np}^{\\mathrm{ref}}\\right|\n$$\n目标精度标准是 $\\varepsilon \\le 0.005\\ \\mathrm{fm}$。\n\n实现程序以完成以下任务：\n1. 对于给定的 $dr$、$R_{\\mathrm{box}}$ 和 $\\mathrm{tol}$，通过在 $[0, R_{\\mathrm{box}}]$ 约束下进行迭代归一化来确定 $c_n$ 和 $c_p$，从而构建密度 $\\rho_n(r)$ 和 $\\rho_p(r)$。\n2. 计算每种情况下的 $r_{\\mathrm{rms}}^{(n)}$、$r_{\\mathrm{rms}}^{(p)}$，并由此得到 $\\Delta r_{np}$。\n3. 使用 $dr_{\\mathrm{ref}} = 0.005\\ \\mathrm{fm}$、$R_{\\mathrm{box}}^{\\mathrm{ref}} = 25\\ \\mathrm{fm}$ 和 $\\mathrm{tol}_{\\mathrm{ref}} = 10^{-12}$ 计算 $\\Delta r_{np}^{\\mathrm{ref}}$。\n4. 对于每个测试案例 $\\{dr, R_{\\mathrm{box}}, \\mathrm{tol}\\}$，以布尔值的形式输出是否满足目标精度阈值 $\\varepsilon \\le 0.005\\ \\mathrm{fm}$。\n\n测试套件：\n使用以下八组参数三元组来探究收敛性的不同方面，包括网格粗糙度、盒子截断和迭代紧密度：\n- 案例 1：$dr = 0.50\\ \\mathrm{fm}$, $R_{\\mathrm{box}} = 9.0\\ \\mathrm{fm}$, $\\mathrm{tol} = 10^{-2}$。\n- 案例 2：$dr = 0.10\\ \\mathrm{fm}$, $R_{\\mathrm{box}} = 9.0\\ \\mathrm{fm}$, $\\mathrm{tol} = 10^{-8}$。\n- 案例 3：$dr = 0.20\\ \\mathrm{fm}$, $R_{\\mathrm{box}} = 14.0\\ \\mathrm{fm}$, $\\mathrm{tol} = 10^{-6}$。\n- 案例 4：$dr = 0.10\\ \\mathrm{fm}$, $R_{\\mathrm{box}} = 20.0\\ \\mathrm{fm}$, $\\mathrm{tol} = 10^{-6}$。\n- 案例 5：$dr = 0.05\\ \\mathrm{fm}$, $R_{\\mathrm{box}} = 16.0\\ \\mathrm{fm}$, $\\mathrm{tol} = 10^{-4}$。\n- 案例 6：$dr = 0.05\\ \\mathrm{fm}$, $R_{\\mathrm{box}} = 25.0\\ \\mathrm{fm}$, $\\mathrm{tol} = 10^{-8}$。\n- 案例 7：$dr = 0.02\\ \\mathrm{fm}$, $R_{\\mathrm{box}} = 25.0\\ \\mathrm{fm}$, $\\mathrm{tol} = 10^{-10}$。\n- 案例 8：$dr = 0.01\\ \\mathrm{fm}$, $R_{\\mathrm{box}} = 12.0\\ \\mathrm{fm}$, $\\mathrm{tol} = 10^{-12}$。\n\n要求的最终输出格式：\n您的程序应生成单行输出，其中包含上述八个测试案例的结果。结果是一个用方括号括起来的逗号分隔列表，列表项为布尔值，按给定顺序指示每个案例是否满足 $\\varepsilon \\le 0.005\\ \\mathrm{fm}$（例如，$\\left[\\mathrm{True},\\mathrm{False},\\ldots\\right]$）。不应打印任何其他文本。", "solution": "该问题要求对 $^{208}\\mathrm{Pb}$ 核的中子皮厚度 $\\Delta r_{np}$ 进行数值收敛性研究。解决方案涉及实现一个基于第一性原理的计算框架，该框架采用数值积分和求根算法。此分析的基础在于使用双参数费米密度分布对中子和质子分布进行建模，然后通过数值方法求解确保粒子数正确归一化的参数。\n\n**1. 理论与数学框架**\n\n中子（$q=n$）和质子（$q=p$）的密度分布由球对称的双参数费米函数建模：\n$$\n\\rho_{q}(r; c_q, a_q, \\rho_{0,q}) = \\frac{\\rho_{0,q}}{1 + \\exp\\left(\\frac{r - c_q}{a_q}\\right)}\n$$\n其中 $r$ 是径向坐标，$c_q$ 是半密度半径，$a_q$ 是表面弥散度，$\\rho_{0,q}$ 是中心密度参数。对于 $^{208}\\mathrm{Pb}$ 核，给定 $A=208$，$N=126$ 和 $Z=82$。弥散度固定为 $a_n = a_p = 0.55\\ \\mathrm{fm}$。中心密度由饱和密度 $\\rho_{\\mathrm{sat}} = 0.16\\ \\mathrm{fm}^{-3}$ 导出，即 $\\rho_{0,n} = \\rho_{\\mathrm{sat}} \\cdot (N/A)$ 和 $\\rho_{0,p} = \\rho_{\\mathrm{sat}} \\cdot (Z/A)$。\n\n半密度半径 $c_n$ 和 $c_p$ 未给定，必须通过在半径为 $R_{\\mathrm{box}}$ 的有限球形体积内强制执行归一化条件来确定。该条件规定，数密度在体积上的积分必须等于该种类粒子的总数：\n$$\nN_q = \\int_0^{R_{\\mathrm{box}}} 4\\pi r^2 \\rho_q(r; c_q, a_q, \\rho_{0,q}) \\, dr\n$$\n其中 $N_n = N$ 且 $N_p = Z$。\n\n一旦获得正确归一化的密度，每种粒子种类的均方根（rms）半径计算如下：\n$$\nr_{\\mathrm{rms}}^{(q)} = \\sqrt{\\frac{\\int_0^{R_{\\mathrm{box}}} 4\\pi r^4 \\rho_q(r) \\, dr}{\\int_0^{R_{\\mathrm{box}}} 4\\pi r^2 \\rho_q(r) \\, dr}}\n$$\n此表达式中的分母正是粒子数 $N_q$。为保证数值上的一致性，使用数值网格上计算出的积分值至关重要，而不是使用目标值 $N$ 或 $Z$。\n\n最后，中子皮厚度是中子和质子均方根半径之差：\n$$\n\\Delta r_{np} = r_{\\mathrm{rms}}^{(n)} - r_{\\mathrm{rms}}^{(p)}\n$$\n\n**2. 数值策略与算法设计**\n\n问题的核心是求解 $c_q$ 的归一化方程，然后使用数值积分计算均方根半径。\n\n**2.1. 数值积分**\n所有积分都在离散的径向网格上进行数值计算。网格由区间 $[0, R_{\\mathrm{box}}]$ 上的间距 $dr$ 定义，得到点 $r_k = k \\cdot dr$，其中 $k=0, 1, \\dots, \\lfloor R_{\\mathrm{box}}/dr \\rfloor$。对于所涉及的光滑函数的积分，使用高阶复合求积法则是合适的。我们选择复合辛普森法则，它能提供出色的精度。`scipy.integrate.simpson` 函数提供了该方法的稳健实现，能够正确处理具有偶数和奇数个区间的网格。\n\n**2.2. 半密度半径 $c_q$ 的求根**\n对于每个粒子种类 $q$，我们必须找到满足归一化条件的 $c_q$ 值。这是一个一维求根问题。我们定义一个残差函数：\n$$\nf(c_q) = \\left( \\int_0^{R_{\\mathrm{box}}} 4\\pi r^2 \\rho_q(r; c_q) \\, dr \\right) - N_q = 0\n$$\n积分项，我们可以记为 $I(c_q)$，是 $c_q$ 的单调递减函数。较大的 $c_q$ 会将密度分布向外推，因此对于固定的盒子半径 $R_{\\mathrm{box}}$，盒子内的积分粒子数会减少。这种单调性保证了如果在给定的搜索区间内存在 $c_q$ 的解，那么该解是唯一的。\n\n采用稳健的二分法来寻找根 $c_q$。搜索在物理区间 $[c_{\\mathrm{min}}, c_{\\mathrm{max}}] = [0, R_{\\mathrm{box}}]$ 内进行。二分法算法过程如下：\n1.  建立搜索区间 $[c_{\\mathrm{min}}, c_{\\mathrm{max}}]$。\n2.  在开始搜索之前，检查目标 $N_q$ 是否被区间端点处的积分值 $I(c_{\\mathrm{min}})$ 和 $I(c_{\\mathrm{max}})$ 所包围。\n    -   如果 $N_q  I(c_{\\mathrm{min}})$，则积分盒子太小，即使对于最紧凑的密度分布（$c_q = 0$）也无法容纳 $N_q$ 个粒子。在这种情况下，将 $c_q$ 设置为 $c_{\\mathrm{min}} = 0$，这是使粒子数最大化的值。\n    -   如果 $N_q  I(c_{\\mathrm{max}})$，则粒子数总是大于 $N_q$，即使对于区间内最弥散的分布（$c_q = R_{\\mathrm{box}}$）。此时，将 $c_q$ 设置为 $c_{\\mathrm{max}} = R_{\\mathrm{box}}$ 以最小化粒子数。\n3.  如果根被包围在区间内，则通过重复二分区间进行迭代。在每一步 $i$ 中，测试一个中点 $c_{\\mathrm{mid}, i}$。根据 $I(c_{\\mathrm{mid}, i})$ 是大于还是小于 $N_q$ 来更新下一步的区间。\n4.  当粒子数的相对残差小于指定的容差 $\\mathrm{tol}$，即 $|I(c_q) - N_q| / N_q  \\mathrm{tol}$，或达到固定的最大迭代次数时，迭代终止。\n\n**3. 实现与收敛性研究**\n\n整个程序的结构是为了对一系列测试案例进行计算，并将它们与一个高精度参考案例进行比较。\n\n1.  **参考计算**：首先计算一个参考值 $\\Delta r_{np}^{\\mathrm{ref}}$，该值使用非常精细的网格（$dr_{\\mathrm{ref}} = 0.005\\ \\mathrm{fm}$）、一个大的盒子半径（$R_{\\mathrm{box}}^{\\mathrm{ref}} = 25\\ \\mathrm{fm}$）和一个严格的求根容差（$\\mathrm{tol}_{\\mathrm{ref}} = 10^{-12}$）计算得出。这提供了一个被认为非常接近真实收敛值的基准。\n\n2.  **测试案例评估**：程序随后遍历八个提供的测试案例，每个案例由一组参数三元组 $\\{dr, R_{\\mathrm{box}}, \\mathrm{tol}\\}$ 定义。对于每个案例：\n    a. 使用上述二分法确定半密度半径 $c_n$ 和 $c_p$。\n    b. 使用辛普森法则计算均方根半径 $r_{\\mathrm{rms}}^{(n)}$ 和 $r_{\\mathrm{rms}}^{(p)}$。\n    c. 计算中子皮厚度 $\\Delta r_{np}$。\n    d. 计算与参考值的绝对偏差 $\\varepsilon = |\\Delta r_{np} - \\Delta r_{np}^{\\mathrm{ref}}|$。\n\n3.  **输出**：对于每个案例，确定一个布尔值，指示偏差 $\\varepsilon$ 是否满足精度标准 $\\varepsilon \\le 0.005\\ \\mathrm{fm}$。最终输出是这些布尔值结果的列表。\n\n该实现封装在一个 Python 程序中，利用 `numpy` 进行高效的数组操作，利用 `scipy.integrate.simpson` 进行数值积分，并遵守所有指定的约束。", "answer": "[False,False,True,True,True,True,True,True]", "id": "3573312"}]}