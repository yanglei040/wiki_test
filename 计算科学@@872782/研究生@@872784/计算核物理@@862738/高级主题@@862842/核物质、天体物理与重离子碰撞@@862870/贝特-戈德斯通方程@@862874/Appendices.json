{"hands_on_practices": [{"introduction": "理论推导为我们理解Bethe-Goldstone方程提供了基础，但要获得定量的结果，我们必须在计算机上求解它。这个实践练习将引导你完成将Bethe-Goldstone积分方程转化为离散矩阵形式的核心过程，这是计算核物理中的一项基本技能。通过使用可分离的Yamaguchi势，我们不仅简化了问题，还能将数值解与已知的解析解进行比较，这对于验证我们的代码和算法的正确性至关重要。", "problem": "要求您实现一个完全自包含的程序，为总对动量为零的对称核物质构建介质内相互作用（介质内 $G$ 矩阵）的 Bethe-Goldstone 方程的离散化矩阵表示。您的任务是从适用于计算核物理的第一性原理出发，推导由求积近似产生的离散线性系统，然后进行数值实现和评估。您必须使用一个物理上合理的单粒子谱和一个简单但非平凡的可分离相互作用，以便进行内部一致性检验。所有动量必须以 $\\mathrm{fm}^{-1}$ 表示，所有能量以 $\\mathrm{MeV}$ 表示，角度以弧度表示。\n\n从 Brueckner-Hartree-Fock (BHF) 理论的标准物理出发点开始：介质内两体反应矩阵 $G$ 的 Bethe-Goldstone 方程，在 $S$ 波、零总动量近似下，可以写成关于相对动量 $k$ 的一维积分方程。采用分波的常规归一化，其中三维积分变为一个因子乘以在 $q \\in [0,\\Lambda]$ 上对 $q^{2}\\,\\mathrm{d}q$ 的积分，其中 $\\Lambda$ 是一个有限动量截断。中间态泡利算符必须采用角度平均，并且对于零总动量，它简化为一个阶跃函数 $Q(q,k_{F})=\\Theta(q-k_{F})$，其中 $k_{F}$ 是费米动量。单粒子能量必须取为自由动能谱 $\\epsilon(q)=\\frac{\\hbar^{2}}{2m_{N}}\\,q^{2}$，其中 $\\frac{\\hbar^{2}}{2m_{N}}=20.735\\,\\mathrm{MeV}\\cdot\\mathrm{fm}^{2}$。起始能量是一个形式为 $\\omega + i\\,\\eta$ 的复数量，其中 $\\omega$ 是实数，$\\eta$ 是一个小的正调节子（单位为 $\\mathrm{MeV}$），它实现因果性规定并正则化能量分母。\n\n在动量空间中使用秩-1 可分离 Yamaguchi 势，\n$$\nV(k,k')=-\\lambda\\,g(k)\\,g(k')\\,,\\qquad g(k)=\\frac{1}{k^{2}+\\beta^{2}}\\,,\n$$\n其中 $\\lambda>0$ 且力程参数 $\\beta>0$。在 $S$ 波和零质心动量下，介质内 Bethe-Goldstone 方程对于每一对 $(k,k')$ 变成一个关于 $q$ 的一维积分方程，涉及核 $V(k,q)$、泡利因子 $Q(q,k_{F})$ 和传播子分母 $\\left[\\omega-\\epsilon(q)-\\epsilon(q)\\right]^{-1}=\\left[\\omega-2\\,\\epsilon(q)\\right]^{-1}$。您的代码必须使用具有 $N$ 个节点和权重 $\\{(q_{i},w_{i})\\}_{i=1}^{N}$ 的高斯求积方法，在有限动量区间 $[0,\\Lambda]$ 上对 $q$ 积分进行离散化。为了在特定的在壳动量 $k_{0}$ 处评估 $G$ 矩阵，您必须通过将 $k_{0}$ 作为一个额外的、求积权重为零的配置点来扩充求积网格，这样它不会改变积分值，但能通过相同的线性系统产生 $G(k_{0},k')$。在所有表达式中，显式地携带常规的 $S$ 波因子，形式为\n$$\n\\frac{2}{\\pi}\\int_{0}^{\\Lambda} q^{2}\\,\\mathrm{d}q \\,\\cdots \\, .\n$$\n\n在数值上，您必须通过添加小的虚数调节子来处理能量分母\n$$\n\\omega-\\epsilon_{p_{1}}-\\epsilon_{p_{2}}=\\omega-2\\,\\epsilon(q)=\\omega - 2 \\times 20.735\\,q^{2}\\,,\n$$\n使得分母为 $\\omega-2\\,\\epsilon(q)+i\\,\\eta$，其中 $\\eta \\ge 0$。泡利算符 $Q(q,k_{F})$ 必须实现为一个尖锐的阶跃函数：如果 $q>k_{F}$，则 $Q(q,k_{F})=1$，否则 $Q(q,k_{F})=0$。您必须在组合网格 $\\{k_{0}\\}\\cup\\{q_{i}\\}_{i=1}^{N}$ 上将离散化方程表述为线性代数问题，并求解在这些网格点上的完整矩阵 $G(k_{a},k_{b};\\omega)$。然后提取在壳元 $G(k_{0},k_{0};\\omega)$。\n\n为了验证正确性并评估能量分母的数值处理，通过将 Bethe-Goldstone 方程简化为关于强度参数的标量方程，然后重构在壳 $G$ 矩阵元，来并行计算秩-1 可分离势存在的闭式解。在标量方程中使用相同的求积规则和泡利算符，以便差异仅反映您的离散化和线性代数方法的自洽性。\n\n测试套件和参数。对于以下每种情况，输入参数为 $(k_{F},k_{0},\\Lambda,N,\\beta,\\lambda,\\omega,\\eta)$，单位如前所述。请严格按此顺序使用这四种情况：\n- 情况 A（自由空间，在壳）：$k_{F}=0.0\\,\\mathrm{fm}^{-1}$，$k_{0}=1.0\\,\\mathrm{fm}^{-1}$，$\\Lambda=8.0\\,\\mathrm{fm}^{-1}$，$N=120$，$\\beta=1.4\\,\\mathrm{fm}^{-1}$，$\\lambda=200.0\\,\\mathrm{MeV}\\cdot\\mathrm{fm}^{3}$，$\\omega=2\\times 20.735\\times k_{0}^{2}\\,\\mathrm{MeV}$，$\\eta=1.0\\,\\mathrm{MeV}$。\n- 情况 B（正常密度，在壳且动量高于 $k_{F}$）：$k_{F}=1.3\\,\\mathrm{fm}^{-1}$，$k_{0}=1.6\\,\\mathrm{fm}^{-1}$，$\\Lambda=8.0\\,\\mathrm{fm}^{-1}$，$N=120$，$\\beta=1.4\\,\\mathrm{fm}^{-1}$，$\\lambda=200.0\\,\\mathrm{MeV}\\cdot\\mathrm{fm}^{3}$，$\\omega=2\\times 20.735\\times k_{0}^{2}\\,\\mathrm{MeV}$，$\\eta=1.0\\,\\mathrm{MeV}$。\n- 情况 C（接近费米面，在壳且动量略高于 $k_{F}$）：$k_{F}=1.3\\,\\mathrm{fm}^{-1}$，$k_{0}=1.31\\,\\mathrm{fm}^{-1}$，$\\Lambda=8.0\\,\\mathrm{fm}^{-1}$，$N=120$，$\\beta=1.4\\,\\mathrm{fm}^{-1}$，$\\lambda=200.0\\,\\mathrm{MeV}\\cdot\\mathrm{fm}^{3}$，$\\omega=2\\times 20.735\\times k_{0}^{2}\\,\\mathrm{MeV}$，$\\eta=0.5\\,\\mathrm{MeV}$。\n- 情况 D（离壳低于阈值，自由空间）：$k_{F}=0.0\\,\\mathrm{fm}^{-1}$，$k_{0}=0.5\\,\\mathrm{fm}^{-1}$，$\\Lambda=8.0\\,\\mathrm{fm}^{-1}$，$N=120$，$\\beta=1.4\\,\\mathrm{fm}^{-1}$，$\\lambda=200.0\\,\\mathrm{MeV}\\cdot\\mathrm{fm}^{3}$，$\\omega=-20.0\\,\\mathrm{MeV}$，$\\eta=0.0\\,\\mathrm{MeV}$。\n\n您的程序必须针对每种情况执行以下操作：\n- 在组合网格上组装离散化矩阵方程，其中 $k_{0}$ 是一个求积权重为零的附加配置点，并求解完整的 $G$ 矩阵。\n- 提取在壳元 $G(k_{0},k_{0};\\omega)$。\n- 使用相同的求积方法和泡利算符，通过闭式可分离简化方法独立计算相应的在壳元。\n- 返回两个复数的实部和虚部之间的绝对差异，即 $|\\Re G_{\\mathrm{matrix}}-\\Re G_{\\mathrm{sep}}|$ 和 $|\\Im G_{\\mathrm{matrix}}-\\Im G_{\\mathrm{sep}}|$，以 $\\mathrm{MeV}\\cdot\\mathrm{fm}^{3}$ 为单位表示。\n\n最终输出格式。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，顺序如下\n$\\big[$情况 A 实部差异，情况 A 虚部差异，情况 B 实部差异，情况 B 虚部差异，情况 C 实部差异，情况 C 虚部差异，情况 D 实部差异，情况 D 虚部差异$\\big]$。", "solution": "用户要求在 Brueckner-Hartree-Fock 核物质理论的背景下，对 Bethe-Goldstone 方程进行数值求解和验证。该问题被验证为具有科学依据、良定且内部一致。它代表了计算核物理中一个标准的、尽管是简化了的问题。\n\n### 1. 问题表述\n\n出发点是针对在总动量为零的对称核物质中相互作用的两个核子的介质内反应矩阵 $G$ 的 Bethe-Goldstone 方程。在 $S$ 波道中，这是一个一维积分方程：\n$$\nG(k, k'; \\omega) = V(k, k') + \\frac{2}{\\pi} \\int_{0}^{\\Lambda} q^2 dq \\, V(k, q) \\frac{Q(q, k_F)}{\\omega + i\\eta - 2\\epsilon(q)} G(q, k'; \\omega)\n$$\n其中：\n- $k$ 和 $k'$ 是初态和末态的相对动量。\n- $V(k, k')$ 是 $S$ 波道中的核子-核子相互作用。\n- 积分是对中间相对动量 $q$ 进行的，上限为截断值 $\\Lambda$。因子 $\\frac{2}{\\pi}$ 是一个指定的归一化约定。\n- $Q(q, k_F) = \\Theta(q - k_F)$ 是角度平均的泡利不相容算符，它将中间态限制在费米动量 $k_F$ 之上。当 $q > k_F$ 时为 $1$，否则为 $0$。\n- $\\epsilon(q) = \\frac{\\hbar^2 q^2}{2m_N}$ 是质量为 $m_N$ 的自由核子的单粒子能量。常数给定为 $\\frac{\\hbar^2}{2m_N} = 20.735\\,\\mathrm{MeV}\\cdot\\mathrm{fm}^2$。\n- $\\omega + i\\eta$ 是复起始能量，其中 $\\omega$ 是实能量，$\\eta > 0$ 是一个小的正调节子，确保正确的因果边界条件并防止能量分母出现奇异性。\n\n相互作用是秩-1 可分离 Yamaguchi 势：\n$$\nV(k, k') = -\\lambda g(k) g(k') \\quad \\text{with} \\quad g(k) = \\frac{1}{k^2 + \\beta^2}\n$$\n其中 $\\lambda$ 是强度，$\\beta$ 与相互作用的力程有关。\n\n### 2. 数值离散化与矩阵表述\n\n为了数值求解该积分方程，我们使用一个 $N$ 点高斯求积法则对 $q \\in [0, \\Lambda]$ 上的积分进行离散化。设求积节点为 $\\{q_i\\}_{i=1}^N$，对应的权重为 $\\{w_i\\}_{i=1}^N$。积分近似为：\n$$\n\\int_{0}^{\\Lambda} f(q) dq \\approx \\sum_{i=1}^{N} w_i f(q_i)\n$$\n问题要求我们在特定动量 $k_0$ 处计算 $G$ 矩阵。我们将求积节点集合与 $k_0$ 合并，形成一个组合的配置点网格 $P = \\{p_a\\}_{a=0}^N$，其中 $p_0 = k_0$，对于 $a=1, \\dots, N$ 有 $p_a = q_a$。点 $k_0$ 被赋予零求积权重。\n\n离散化的 Bethe-Goldstone 方程变成一个关于网格点上 $G$ 矩阵值 $G_{ab} = G(p_a, p_b)$ 的线性方程组：\n$$\nG(p_a, p_b) = V(p_a, p_b) + \\frac{2}{\\pi} \\sum_{i=1}^{N} w_i q_i^2 V(p_a, q_i) \\frac{Q(q_i, k_F)}{\\omega + i\\eta - 2\\epsilon(q_i)} G(q_i, p_b)\n$$\n认识到 $q_i=p_i$ 且 $G(q_i, p_b)=G_{ib}$，我们可以将其写成一个矩阵方程。我们定义一个大小为 $(N+1) \\times (N+1)$ 的矩阵 $\\mathbf{C}$：\n$$\nC_{ai} = \n\\begin{cases}\n    \\frac{2}{\\pi} w_i q_i^2 V(p_a, q_i) \\frac{Q(q_i, k_F)}{\\omega + i\\eta - 2\\epsilon(q_i)}  \\text{for } i \\in \\{1, \\dots, N\\} \\\\\n    0  \\text{for } i = 0\n\\end{cases}\n$$\n以矩阵 $\\mathbf{V}$（其元素为 $V_{ab}$）表示的矩阵 $\\mathbf{G}$（其元素为 $G_{ab}$）的方程是：\n$$\n\\mathbf{G} = \\mathbf{V} + \\mathbf{C} \\mathbf{G} \\implies (\\mathbf{I} - \\mathbf{C})\\mathbf{G} = \\mathbf{V}\n$$\n其中 $\\mathbf{I}$ 是单位矩阵。形式解为 $\\mathbf{G} = (\\mathbf{I} - \\mathbf{C})^{-1} \\mathbf{V}$。\n\n由于势是可分离的，$\\mathbf{V}$ 是一个秩-1 矩阵：$V_{ab} = -\\lambda g(p_a) g(p_b)$，可以写成 $\\mathbf{V} = -\\lambda \\vec{g} \\vec{g}^T$，其中 $\\vec{g}$ 是一个列向量，其元素为 $g_a = g(p_a)$。\n那么 $\\mathbf{G}$ 的解是 $\\mathbf{G} = -\\lambda (\\mathbf{I} - \\mathbf{C})^{-1} (\\vec{g} \\vec{g}^T)$。\n为了找到所需的元素 $G_{00} = G(k_0, k_0)$，我们可以求解线性系统 $(\\mathbf{I} - \\mathbf{C})\\vec{y} = \\vec{g}$ 以得到向量 $\\vec{y}$。解向量为 $\\vec{y} = (\\mathbf{I} - \\mathbf{C})^{-1}\\vec{g}$，然后完整的 $G$ 矩阵为 $\\mathbf{G} = -\\lambda \\vec{y} \\vec{g}^T$。\n我们需要的特定元素是 $G_{00} = -\\lambda y_0 g_0$，其中 $y_0$ 是 $\\vec{y}$ 的第一个分量，$g_0 = g(p_0) = g(k_0)$。这种方法避免了构造完整的逆矩阵，在计算上更有效率。\n\n### 3. 闭式可分离简化\n\n秩-1 可分离势的一个关键特征是积分方程可以解析求解，将其简化为一个标量代数方程。我们将 $V(k, k') = -\\lambda g(k) g(k')$ 代入 Bethe-Goldstone 方程。方程的结构意味着 $G(k, k')$ 也必须是可分离的，因此我们作出拟设 $G(k, k') = \\tau(\\omega) g(k) g(k')$。代入此式并消去 $g(k)$ 和 $g(k')$，得到函数 $\\tau(\\omega)$ 的一个标量方程：\n$$\n\\tau(\\omega) = -\\lambda + \\frac{2}{\\pi} \\int_0^\\Lambda q^2 dq \\, [-\\lambda g(q)] \\frac{Q(q, k_F)}{\\omega' - 2\\epsilon(q)} [\\tau(\\omega) g(q)]\n$$\n$$\n\\tau(\\omega) = -\\lambda - \\lambda \\tau(\\omega) \\left[ \\frac{2}{\\pi} \\int_0^\\Lambda q^2 dq \\frac{g(q)^2 Q(q, k_F)}{\\omega' - 2\\epsilon(q)} \\right]\n$$\n我们定义圈积分 $I(\\omega')$：\n$$\nI(\\omega') = \\frac{2}{\\pi} \\int_0^\\Lambda q^2 dq \\frac{g(q)^2 Q(q, k_F)}{\\omega' - 2\\epsilon(q)}\n$$\n于是 $\\tau(\\omega) = -\\lambda / (1 + \\lambda I(\\omega'))$。因此 G 矩阵为：\n$$\nG(k, k'; \\omega) = \\frac{-\\lambda g(k) g(k')}{1 + \\lambda I(\\omega')}\n$$\n为了验证，我们使用与矩阵方法中相同的高斯求积规则来计算积分 $I(\\omega')$：\n$$\nI(\\omega') \\approx \\frac{2}{\\pi} \\sum_{i=1}^{N} w_i q_i^2 \\frac{g(q_i)^2 Q(q_i, k_F)}{\\omega' - 2\\epsilon(q_i)}\n$$\n然后，在壳元 $G(k_0, k_0; \\omega)$ 便可直接由此公式计算得出。\n\n### 4. 一致性检验\n\n问题的设计使得矩阵方法和可分离简化方法是通往同一底层解析解的两条不同数值路径。正如在思考过程中解析推导的那样，两种方法都得出了相同的表达式：$G(k_0, k_0) = \\frac{-\\lambda g(k_0)^2}{1+\\lambda I(\\omega')}$。因此，当使用相同的求积方案进行数值实现时，两种方法的结果应该在浮点精度范围内完全相同。所要求的差异 $|\\Re G_{\\mathrm{matrix}}-\\Re G_{\\mathrm{sep}}|$ 和 $|\\Im G_{\\mathrm{matrix}}-\\Im G_{\\mathrm{sep}}|$，可作为对离散化线性代数问题实现的正确性和一致性的严格检验。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import roots_legendre\n\ndef solve():\n    \"\"\"\n    Main driver function to solve the problem for all specified test cases.\n    \"\"\"\n    # Test suite parameters:\n    # (k_F, k_0, Lambda, N, beta, lambda, omega, eta)\n    HBARC2_2M = 20.735  # MeV*fm^2\n\n    test_cases = [\n        # Case A (free-space, on-shell)\n        (0.0, 1.0, 8.0, 120, 1.4, 200.0, 2 * HBARC2_2M * 1.0**2, 1.0),\n        # Case B (normal density, on-shell above k_F)\n        (1.3, 1.6, 8.0, 120, 1.4, 200.0, 2 * HBARC2_2M * 1.6**2, 1.0),\n        # Case C (near Fermi surface, on-shell just above k_F)\n        (1.3, 1.31, 8.0, 120, 1.4, 200.0, 2 * HBARC2_2M * 1.31**2, 0.5),\n        # Case D (off-shell below threshold, free-space)\n        (0.0, 0.5, 8.0, 120, 1.4, 200.0, -20.0, 0.0),\n    ]\n\n    results = []\n    for case_params in test_cases:\n        d_real, d_imag = solve_case(*case_params)\n        results.append(f\"{d_real:.15e}\")\n        results.append(f\"{d_imag:.15e}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\ndef solve_case(kF, k0, Lambda, N, beta, lam, omega, eta):\n    \"\"\"\n    Solves the Bethe-Goldstone equation for a single set of parameters\n    using both the matrix inversion method and the separable reduction,\n    and returns the discrepancies between them.\n    \"\"\"\n    # Physical constant\n    HBARC2_2M = 20.735  # MeV*fm^2\n\n    # 1. Setup Grid and Quadrature\n    # Get N Gauss-Legendre quadrature points (x) and weights (w_prime) for [-1, 1]\n    x_nodes, w_prime = roots_legendre(N)\n    \n    # Map nodes and weights to the integration interval [0, Lambda]\n    q_nodes = Lambda * (x_nodes + 1.0) / 2.0\n    w_nodes = Lambda * w_prime / 2.0\n\n    # The full momentum grid consists of k0 and the quadrature nodes.\n    # p_grid[0] = k0, p_grid[1:] = q_nodes\n    p_grid = np.concatenate(([k0], q_nodes))\n    \n    # 2. Define Physical Quantities\n    def g_form_factor(k_val):\n        return 1.0 / (k_val**2 + beta**2)\n\n    def energy_spectrum(k_val):\n        return HBARC2_2M * k_val**2\n    \n    # Evaluate quantities on the grids\n    epsilon_q = energy_spectrum(q_nodes)\n    g_p = g_form_factor(p_grid)\n    g_q = g_form_factor(q_nodes)\n    \n    # Pauli operator Q(q, kF) = 1 if q > kF, else 0\n    Q_q = (q_nodes > kF).astype(np.float64)\n\n    # Complex starting energy\n    omega_c = complex(omega, eta)\n    \n    # Propagator denominator for all quadrature points\n    propagator_denom = omega_c - 2.0 * epsilon_q\n\n    # 3. Matrix Method for G(k0, k0)\n    # The discretized B-G equation is (I - C)G = V.\n    # For a separable potential, this leads to solving (I - C)y = g_vec,\n    # and then G_00 = -lam * y_0 * g_0.\n\n    # Construct the matrix C of size (N+1) x (N+1)\n    C = np.zeros((N + 1, N + 1), dtype=np.complex128)\n    \n    # Common part of the kernel for all quadrature points\n    kernel_integrand_base = (2.0 / np.pi) * w_nodes * q_nodes**2 * Q_q / propagator_denom\n    \n    # The matrix C's columns for i=1..N are constructed. C's first column (i=0) is zero.\n    for a in range(N + 1):  # Loop over rows of C (momentum p_a)\n        # V(p_a, q_i) = -lam * g(p_a) * g(q_i)\n        # C_{a,i} for i=1..N involves V(p_a, q_{i-1}) in 0-based indexing\n        V_pa_qi = -lam * g_p[a] * g_q\n        C[a, 1:] = kernel_integrand_base * V_pa_qi\n\n    # Form the matrix M = I - C for the linear system M*y = g_vec\n    M = np.identity(N + 1, dtype=np.complex128) - C\n    \n    # The vector g_vec has components g(p_a)\n    g_vec = g_p.astype(np.complex128)\n    \n    # Solve the linear system M*y = g_vec\n    y = np.linalg.solve(M, g_vec)\n    \n    # Calculate G_matrix(k0, k0) which corresponds to G_00\n    G_matrix = -lam * g_p[0] * y[0]\n\n    # 4. Separable Reduction Method for G(k0, k0)\n    # G(k,k') = V(k,k') / (1 + lam*I)\n    # where I = (2/pi) * integral_q [ q^2 * g(q)^2 * Q(q) / (omega' - 2*eps(q)) ]\n    \n    # Evaluate the loop integral I using the same quadrature rule\n    integrand_I = (2.0 / np.pi) * q_nodes**2 * g_q**2 * Q_q / propagator_denom\n    I_val = np.sum(w_nodes * integrand_I)\n    \n    # Calculate G_sep(k0, k0)\n    G_sep = (-lam * g_p[0]**2) / (1.0 + lam * I_val)\n\n    # 5. Compute and return the absolute discrepancies\n    d_real = np.abs(G_matrix.real - G_sep.real)\n    d_imag = np.abs(G_matrix.imag - G_sep.imag)\n\n    return d_real, d_imag\n\nif __name__ == '__main__':\n    solve()\n\n```", "id": "3545576"}, {"introduction": "在Brueckner理论中，核心思想是核子在原子核介质中的行为与在自由空间中不同。这种差异体现在单粒子谱 $ε(k)$ 上，它直接影响Bethe-Goldstone方程中的传播子。这个练习旨在通过计算和比较不同单粒子谱模型（包括自由谱、有效质量近似和动量依赖的平均场）下的 $G$ 矩阵，来量化介质效应的影响，从而让你直观地理解为何自洽计算在核多体问题中如此重要。", "problem": "考虑无限、各向同性的核物质，其中在充满的费米海存在的情况下，双核子散射由 Bethe–Goldstone 方程描述。在动量空间中进行计算，相对动量大小用 $k$ 表示，并使用角平均泡利阻塞近似，使得高于费米动量的中间态相对动量不被阻塞。设两体相互作用为动量空间中的1秩可分离势，形式为 $V(k,k')=-\\lambda\\,g(k)\\,g(k')$，其中 $g(k)=1/\\bigl(1+(k/\\beta)^2\\bigr)$ 且 $\\lambda$ 是一个正常数。采用的单位制中，动量单位为 $\\mathrm{fm}^{-1}$，能量单位为 $\\mathrm{MeV}$，动能系数为 $\\hbar^2/(2m)=20.735\\,\\mathrm{MeV\\,fm^2}$。单粒子能量 $\\epsilon(k)$ 出现在能量分母中，将通过改变其值来测试敏感性。对 $\\epsilon(k)$ 使用以下三种模型：(i) 自由谱 $\\epsilon_{\\mathrm{free}}(k)=\\bigl(\\hbar^2/(2m)\\bigr)\\,k^2$，(ii) 有效质量加常数平均场 $\\epsilon_{\\mathrm{eff}}(k)=\\bigl(\\hbar^2/(2m)\\bigr)\\,(m/m^*)\\,k^2+U_0$，其中有效质量比为 $m^*/m$，以及 (iii) 动量依赖的平均场 $\\epsilon_{\\mathrm{mom}}(k)=\\bigl(\\hbar^2/(2m)\\bigr)\\,k^2-U_0/\\bigl(1+(k/k_c)^2\\bigr)$。对每种模型，取起始能量为在壳能量，即 $\\omega=2\\,\\epsilon(k_0)$，其中 $k_0>k_F$ 是一个指定的在壳相对动量，$k_F$ 是费米动量。为确保数值稳定性，通过在分母中包含一个小的正虚数调节子 $i\\eta$ 来对能量分母进行正则化，并在紫外截断动量 $q_{\\max}$ 处截断动量积分。\n\n从 Bethe–Goldstone 方程和所述近似出发，为1秩可分离势推导在壳、S波、角平均的介质中相互作用 $G(k_0,k_0;\\omega)$ 实部的可数值计算表达式。然后实现一个程序，对测试套件中的每个参数集，计算：\n- $G_{\\mathrm{free}}(k_0,k_0;2\\,\\epsilon_{\\mathrm{free}}(k_0))$ 的实部，\n- $G_{\\mathrm{eff}}(k_0,k_0;2\\,\\epsilon_{\\mathrm{eff}}(k_0))$ 的实部，\n- $G_{\\mathrm{mom}}(k_0,k_0;2\\,\\epsilon_{\\mathrm{mom}}(k_0))$ 的实部，\n并输出两个无量纲的敏感性度量\n- $r_{\\mathrm{eff}}=\\operatorname{Re}\\,G_{\\mathrm{eff}}/\\operatorname{Re}\\,G_{\\mathrm{free}}$，\n- $r_{\\mathrm{mom}}=\\operatorname{Re}\\,G_{\\mathrm{mom}}/\\operatorname{Re}\\,G_{\\mathrm{free}}$，\n结果四舍五入到六位小数。\n\n所有积分必须在 $q$ 的单位为 $\\mathrm{fm}^{-1}$、能量单位为 $\\mathrm{MeV}$ 的情况下计算。角度已经通过角平均积分掉了，因此不需要角度单位。要求的输出是无单位的纯数。你的程序必须评估以下测试套件，其中指定 $(k_F,k_0,\\beta,\\lambda,m^*/m,U_0,U_0^{(\\mathrm{mom})},k_c,\\eta,q_{\\max})$ 为：\n- 测试 1：$(0.4,0.8,1.6,350.0,0.9,-20.0,40.0,1.7,1.0\\times 10^{-3},8.0)$，\n- 测试 2：$(1.33,1.5,1.8,400.0,0.7,-50.0,60.0,1.5,2.0\\times 10^{-3},8.0)$，\n- 测试 3：$(1.8,2.0,1.4,300.0,0.6,-70.0,80.0,1.2,5.0\\times 10^{-3},8.0)$，\n- 测试 4：$(0.0,0.2,1.6,350.0,1.0,0.0,0.0,1.5,1.0\\times 10^{-4},8.0)$。\n\n对于每个测试，计算如上定义的 $r_{\\mathrm{eff}}$ 和 $r_{\\mathrm{mom}}$。你的程序应生成单行输出，其中包含所有测试的结果，按给定顺序展平并以逗号分隔的列表形式放在方括号内，即 $[r_{\\mathrm{eff}}^{(1)},r_{\\mathrm{mom}}^{(1)},r_{\\mathrm{eff}}^{(2)},r_{\\mathrm{mom}}^{(2)},r_{\\mathrm{eff}}^{(3)},r_{\\mathrm{mom}}^{(3)},r_{\\mathrm{eff}}^{(4)},r_{\\mathrm{mom}}^{(4)}]$，每个条目四舍五入到六位小数。", "solution": "该问题要求在角平均泡利阻塞近似下，对1秩可分离势推导和计算在壳、S波的介质中双核子相互作用（或称 $G$ 矩阵）。我们将首先推导 $G$ 矩阵实部的解析表达式，然后概述其数值计算过程。\n\n$G$ 矩阵算符的 Bethe-Goldstone 方程由下式给出\n$$ G(\\omega) = V + V \\frac{Q}{\\omega - H_0 + i\\eta} G(\\omega) $$\n其中 $V$ 是双核子势，$H_0$ 是未微扰的双粒子哈密顿量，$\\omega$ 是起始能量，$Q$ 是泡利阻塞算符，$i\\eta$ 是一个小的正虚数调节子（$\\eta \\to 0^+$）。\n\n我们在相对动量表象中进行计算。对于 S 波（$l=0$）分波，Bethe-Goldstone 方程变为一个积分方程：\n$$ G_0(k, k'; \\omega) = V_0(k, k') + \\frac{2}{\\pi} \\int_0^\\infty q^2 dq \\, V_0(k, q) \\frac{Q(q)}{\\omega - 2\\epsilon(q) + i\\eta} G_0(q, k'; \\omega) $$\n因子 $2/\\pi$ 来自于分波 Lippmann-Schwinger 型方程的标准归一化。然而，与标准核物理文献中的积分 $\\int \\frac{d^3q}{(2\\pi)^3} \\rightarrow \\frac{1}{2\\pi^2} \\int q^2 dq$ 相比，我们将遵循后者的约定。对于可分离势，最终结果对此选择不敏感，因为因子会抵消掉，但为与现有教科书保持一致，我们使用 $\\frac{1}{2\\pi^2} \\int q^2 dq$。\n$$ G_0(k, k'; \\omega) = V_0(k, k') + \\frac{1}{2\\pi^2} \\int_0^\\infty q^2 dq \\, V_0(k, q) \\frac{Q(q)}{\\omega - 2\\epsilon(q) + i\\eta} G_0(q, k'; \\omega) $$\n问题提供了一个1秩可分离势，对于 S 波，其形式为\n$$ V_0(k, k') = -\\lambda g(k) g(k') $$\n其中 $g(k) = 1/\\bigl(1+(k/\\beta)^2\\bigr)$。势的可分离性质表明解具有以下形式\n$$ G_0(k, k'; \\omega) = \\mathcal{T}(\\omega) g(k) g(k') $$\n将 $G_0$ 的 ansatz 和 $V_0$ 的形式代入积分方程：\n$$ \\mathcal{T}(\\omega) g(k) g(k') = -\\lambda g(k) g(k') + \\frac{1}{2\\pi^2} \\int_0^\\infty q^2 dq \\, \\left( -\\lambda g(k) g(q) \\right) \\frac{Q(q)}{\\omega - 2\\epsilon(q) + i\\eta} \\left( \\mathcal{T}(\\omega) g(q) g(k') \\right) $$\n两边除以 $g(k)g(k')$（对于有限动量，其非零），我们可以解出反应矩阵 $\\mathcal{T}(\\omega)$：\n$$ \\mathcal{T}(\\omega) = -\\lambda - \\mathcal{T}(\\omega) \\frac{\\lambda}{2\\pi^2} \\int_0^\\infty q^2 dq \\, \\frac{[g(q)]^2 Q(q)}{\\omega - 2\\epsilon(q) + i\\eta} $$\n$$ \\mathcal{T}(\\omega) \\left[ 1 + \\frac{\\lambda}{2\\pi^2} \\int_0^\\infty q^2 dq \\, \\frac{[g(q)]^2 Q(q)}{\\omega - 2\\epsilon(q) + i\\eta} \\right] = -\\lambda $$\n$$ \\mathcal{T}(\\omega) = \\frac{-\\lambda}{1 + \\frac{\\lambda}{2\\pi^2} \\int_0^\\infty q^2 dq \\, \\frac{[g(q)]^2 Q(q)}{\\omega - 2\\epsilon(q) + i\\eta}} $$\n完整的 S 波 $G$ 矩阵元则为\n$$ G_0(k, k'; \\omega) = \\frac{-\\lambda g(k) g(k')}{1 + \\frac{\\lambda}{2\\pi^2} \\int_0^\\infty q^2 dq \\, \\frac{[g(q)]^2 Q(q)}{\\omega - 2\\epsilon(q) + i\\eta}} $$\n问题指定了角平均泡利算符，其中如果中间态的相对动量 $q$ 低于费米动量 $k_F$，则这些态被阻塞。因此，当 $q > k_F$ 时 $Q(q) = 1$，当 $q  k_F$ 时 $Q(q) = 0$。动量积分也在紫外截断 $q_{\\max}$ 处被截断。这将积分范围限制在 $[k_F, q_{\\max}]$。我们感兴趣的是在壳矩阵元 $G_0(k_0, k_0; \\omega)$，其中起始能量为 $\\omega = 2\\epsilon(k_0)$。\n$$ G_0(k_0, k_0; 2\\epsilon(k_0)) = \\frac{-\\lambda [g(k_0)]^2}{1 + \\frac{\\lambda}{2\\pi^2} \\int_{k_F}^{q_{\\max}} dq \\, \\frac{q^2 [g(q)]^2}{2\\epsilon(k_0) - 2\\epsilon(q) + i\\eta}} $$\n为了求这个复值表达式的实部，我们定义复积分 $I$ 为\n$$ I = \\int_{k_F}^{q_{\\max}} dq \\, \\frac{q^2 [g(q)]^2}{2\\epsilon(k_0) - 2\\epsilon(q) + i\\eta} $$\n我们可以将被积函数的分母分成实部和虚部：\n$$ \\frac{1}{A(q) + i\\eta} = \\frac{A(q) - i\\eta}{A(q)^2 + \\eta^2}, \\quad \\text{其中 } A(q) = 2\\epsilon(k_0) - 2\\epsilon(q) $$\n积分 $I$ 可以写成 $I = I_R + iI_I$，其中\n$$ I_R = \\int_{k_F}^{q_{\\max}} dq \\, q^2 [g(q)]^2 \\frac{2\\epsilon(k_0) - 2\\epsilon(q)}{(2\\epsilon(k_0) - 2\\epsilon(q))^2 + \\eta^2} $$\n$$ I_I = -\\int_{k_F}^{q_{\\max}} dq \\, q^2 [g(q)]^2 \\frac{\\eta}{(2\\epsilon(k_0) - 2\\epsilon(q))^2 + \\eta^2} $$\n在壳 $G$ 矩阵元则为\n$$ G_0(k_0, k_0; \\omega) = \\frac{-\\lambda [g(k_0)]^2}{1 + \\frac{\\lambda}{2\\pi^2}(I_R + iI_I)} = \\frac{-\\lambda [g(k_0)]^2}{\\left(1 + \\frac{\\lambda}{2\\pi^2}I_R\\right) + i\\left(\\frac{\\lambda}{2\\pi^2}I_I\\right)} $$\n$G_0(k_0, k_0; \\omega)$ 的实部，我们记作 $\\operatorname{Re} G$，是通过将分子和分母乘以分母的复共轭得到的：\n$$ \\operatorname{Re} G = \\frac{-\\lambda [g(k_0)]^2 \\left(1 + \\frac{\\lambda}{2\\pi^2}I_R\\right)}{\\left(1 + \\frac{\\lambda}{2\\pi^2}I_R\\right)^2 + \\left(\\frac{\\lambda}{2\\pi^2}I_I\\right)^2} $$\n该表达式可以进行数值计算。对于每个参数集，我们必须为三种不同的单粒子能量 $\\epsilon(k)$ 模型计算这个量：\n1.  自由谱：$\\epsilon_{\\mathrm{free}}(k) = (\\hbar^2/2m) k^2$。\n2.  有效质量：$\\epsilon_{\\mathrm{eff}}(k) = (\\hbar^2/2m)(m/m^*)k^2 + U_0$。\n3.  动量依赖的平均场：$\\epsilon_{\\mathrm{mom}}(k) = (\\hbar^2/2m)k^2 - U_0^{(\\mathrm{mom})}/\\bigl(1+(k/k_c)^2\\bigr)$。\n\n对于每种模型，我们将壳上能量 $\\omega$ 设为 $2\\epsilon(k_0)$，其中 $\\epsilon$ 是各自的单粒子能量模型。计算过程是通过使用标准求积方法数值计算定积分 $I_R$ 和 $I_I$，然后将结果代入 $\\operatorname{Re} G$ 的表达式中。最后，我们计算所需的敏感性比率 $r_{\\mathrm{eff}}=\\operatorname{Re}\\,G_{\\mathrm{eff}}/\\operatorname{Re}\\,G_{\\mathrm{free}}$ 和 $r_{\\mathrm{mom}}=\\operatorname{Re}\\,G_{\\mathrm{mom}}/\\operatorname{Re}\\,G_{\\mathrm{free}}$。\n\n给定的参数有：动能系数 $\\hbar^2/(2m) = 20.735\\,\\mathrm{MeV\\,fm^2}$，势形状因子 $g(k) = 1/\\bigl(1+(k/\\beta)^2\\bigr)$，以及指定了 $(k_F,k_0,\\beta,\\lambda,m^*/m,U_0,U_0^{(\\mathrm{mom})},k_c,\\eta,q_{\\max})$ 的测试套件。实现将定义一个函数，该函数以这些参数和能量模型类型作为输入，计算 $\\operatorname{Re} G$，然后主程序将为每个模型和测试用例调用此函数以计算最终的比率。\n对于测试用例4，请注意 $k_F=0.0$，$m^*/m=1.0$，$U_0=0.0$ 和 $U_0^{(\\mathrm{mom})}=0.0$。这意味着在这种特定情况下，$\\epsilon_{\\mathrm{free}}(k) = \\epsilon_{\\mathrm{eff}}(k) = \\epsilon_{\\mathrm{mom}}(k)$，并且积分范围是 $[0, q_{\\max}]$。因此，$\\operatorname{Re}G_{\\mathrm{free}} = \\operatorname{Re}G_{\\mathrm{eff}} = \\operatorname{Re}G_{\\mathrm{mom}}$，预期结果为 $r_{\\mathrm{eff}} = 1.0$ 和 $r_{\\mathrm{mom}} = 1.0$。这可作为对实现正确性的验证。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Computes sensitivity measures for the Bethe-Goldstone G-matrix with a separable potential.\n    \"\"\"\n    # Define the constant from the problem statement.\n    HBAR2_OVER_2M = 20.735  # MeV fm^2\n\n    # Define the test cases from the problem statement.\n    # (k_F, k_0, beta, lam, m_ratio, U0_eff, U0_mom, k_c, eta, q_max)\n    test_cases = [\n        (0.4, 0.8, 1.6, 350.0, 0.9, -20.0, 40.0, 1.7, 1.0e-3, 8.0),\n        (1.33, 1.5, 1.8, 400.0, 0.7, -50.0, 60.0, 1.5, 2.0e-3, 8.0),\n        (1.8, 2.0, 1.4, 300.0, 0.6, -70.0, 80.0, 1.2, 5.0e-3, 8.0),\n        (0.0, 0.2, 1.6, 350.0, 1.0, 0.0, 0.0, 1.5, 1.0e-4, 8.0),\n    ]\n\n    results = []\n\n    def g_potential_form_factor(k, beta):\n        \"\"\"Calculates the potential form factor g(k).\"\"\"\n        return 1.0 / (1.0 + (k / beta)**2)\n\n    def compute_re_g(params, model_type):\n        \"\"\"\n        Computes the real part of the on-shell G-matrix for a given energy model.\n        \"\"\"\n        k_F, k_0, beta, lam, m_ratio, U0_eff, U0_mom, k_c, eta, q_max = params\n\n        # Define the single-particle energy function epsilon(k) based on the model\n        if model_type == 'free':\n            epsilon = lambda k: HBAR2_OVER_2M * k**2\n        elif model_type == 'eff_mass':\n            epsilon = lambda k: HBAR2_OVER_2M * (1.0 / m_ratio) * k**2 + U0_eff\n        elif model_type == 'mom_dep':\n            epsilon = lambda k: HBAR2_OVER_2M * k**2 - U0_mom / (1.0 + (k / k_c)**2)\n        else:\n            raise ValueError(\"Invalid model type provided.\")\n\n        # On-shell starting energy\n        omega = 2.0 * epsilon(k_0)\n\n        # Common part of the integrand numerator, f(q) = q^2 * [g(q)]^2\n        f_q = lambda q: q**2 * g_potential_form_factor(q, beta)**2\n        \n        # Energy denominator term, A(q) = omega - 2*epsilon(q)\n        A_q = lambda q: omega - 2.0 * epsilon(q)\n\n        # Integrand for the real part of the complex integral I\n        integrand_R = lambda q: f_q(q) * A_q(q) / (A_q(q)**2 + eta**2)\n        \n        # Integrand for the imaginary part of the complex integral I\n        integrand_I = lambda q: -f_q(q) * eta / (A_q(q)**2 + eta**2)\n\n        # Perform numerical integration to get I_R and I_I\n        I_R, _ = quad(integrand_R, k_F, q_max)\n        I_I, _ = quad(integrand_I, k_F, q_max)\n\n        # Factor multiplying the integral in the G-matrix denominator\n        integral_term_factor = lam / (2.0 * np.pi**2)\n        \n        # Real and imaginary parts of the G-matrix denominator\n        denom_real = 1.0 + integral_term_factor * I_R\n        denom_imag = integral_term_factor * I_I\n        \n        # G-matrix numerator\n        g_k0_squared = g_potential_form_factor(k_0, beta)**2\n        numerator = -lam * g_k0_squared\n        \n        # Calculate the real part of the G-matrix\n        re_G = (numerator * denom_real) / (denom_real**2 + denom_imag**2)\n        \n        return re_G\n\n    for case in test_cases:\n        # Calculate Re(G) for each of the three models\n        re_g_free = compute_re_g(case, 'free')\n        re_g_eff = compute_re_g(case, 'eff_mass')\n        re_g_mom = compute_re_g(case, 'mom_dep')\n\n        # Calculate the dimensionless sensitivity measures\n        # A check for re_g_free being close to zero is prudent in general,\n        # but for the given parameters, it's not expected to be an issue.\n        r_eff = re_g_eff / re_g_free\n        r_mom = re_g_mom / re_g_free\n\n        results.append(r_eff)\n        results.append(r_mom)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{x:.6f}' for x in results)}]\")\n\nsolve()\n```", "id": "3594986"}, {"introduction": "真实的核力远比简单的中心力复杂，其中自旋-轨道相互作用是理解原子核壳层结构和散射现象的关键。本练习将带领你把Bethe-Goldstone方程的应用从简单的 $S$ 波扩展到具有角动量耦合的 $^3P_J$ 道。通过分离出一个可分离的自旋-轨道势，你将计算它对 $G$ 矩阵的贡献，并量化由此产生的不同总角动量 $J$ 态之间的能量分裂，从而深入探索核力的自旋依赖性。", "problem": "考虑在零温度下，总的双核子质心动量约束为零的对称无限核物质。从算符形式的介质中反应矩阵的 Bethe–Goldstone 方程出发，该方程将介质中相互作用与裸核子-核子相互作用、执行泡利不相容原理的泡利投影算符以及无相互作用的两粒子传播子联系起来。专门研究轨道角动量 $L=1$ 和自旋 $S=1$ 的三重态 P 波通道，即总角动量 $J\\in\\{0,1,2\\}$ 的 $\\,^{3}P_{J}\\,$ 通道。\n\n仅分离出相互作用的自旋-轨道部分，在 P 波中建模为秩-1 可分离形式，\n$$\nV_{LS}^{(J)}(k,k') \\equiv C_{LS}\\,\\langle \\mathbf{L}\\cdot\\mathbf{S}\\rangle_{(L=1,S=1;J)} \\, g(k)\\, g(k') \\,,\n$$\n其中 $g(k)\\equiv k\\,\\exp\\!\\left[-(k/\\beta)^2\\right]$，$k$ 和 $k'$ 是以 $\\mathrm{fm}^{-1}$ 为单位的相对动量，$C_{LS}$ 是一个实数耦合常数，而 $\\langle \\mathbf{L}\\cdot\\mathbf{S}\\rangle_{(L,S;J)}$ 是在耦合分波基下的标准期望值。假设在总动量 $K=0$ 时为自由单粒子谱和角度平均的泡利投影算符，因此在相对动量表示中，泡利阻塞是在费米动量 $k_F$ 处对径向动量积分的一个尖锐下限。\n\n您的任务是：\n\n1) 从上述算符 Bethe–Goldstone 方程和可分离拟设出发，将每个固定 $J$ 通道中的问题简化为一个标量代数方程，该方程用于求解一个依赖于起始能量 $\\omega$ 和单个泡利阻塞循环积分的约化介质中振幅。将循环积分表示为具有正确三维测度和泡利下限的一维动量积分，并用此约化振幅和形状因子 $g(k_0)$ 表示在外部相对动量 $k_0$ 处的在壳介质中反应矩阵元 $G^{(J)}(k_0,k_0;\\omega)$。\n\n2) 在确定的 $(L,S,J)$ 通道中，使用自旋-轨道算符的精确角动量恒等式，将 $J$ 的依赖性仅与数值 $\\langle \\mathbf{L}\\cdot\\mathbf{S}\\rangle_{(1,1;J)}$ 联系起来。不要假设超出此期望值的任何额外 $J$ 依赖性。\n\n3) 使用能量单位为兆电子伏特 (MeV) 和动量单位为反费米 ($\\mathrm{fm}^{-1}$) 的单位制，取两个等质量核子的自由相对动能为 $e(k)=\\alpha\\,k^2$，其中 $\\alpha\\equiv \\hbar^2/m_N = 41.471\\,\\mathrm{MeV\\,fm}^2$。使用起始能量为 $\\omega$ 的自由两粒子传播子和 $K=0$ 的角度平均泡利投影算符，即仅对 $k\\ge k_F$ 进行积分。在相对动量积分上引入一个尖锐的紫外截断 $\\Lambda$。将起始能量 $\\omega$ 视为实数且严格为负，以确保不出现任何在壳奇点；计算实值的介质中反应矩阵元。\n\n4) 实现一个程序，对于下面测试套件中的每一组参数，计算五个实数：\n- 在 $J=0,1,2$ 的 $\\,^{3}P_J\\,$ 通道中，对介质中反应矩阵 $G^{(J)}(k_0,k_0;\\omega)$ 的三个实在壳自旋-轨道贡献，以及\n- 两个分裂 $\\Delta_{21}\\equiv \\operatorname{Re}G^{(J=2)} - \\operatorname{Re}G^{(J=1)}$ 和 $\\Delta_{10}\\equiv \\operatorname{Re}G^{(J=1)} - \\operatorname{Re}G^{(J=0)}$。\n所有五个量都必须以 $\\mathrm{MeV\\cdot fm}^3$ 表示并报告为浮点数。\n\n使用以下约定和输入：\n- 循环积分必须使用带角度平均的三维动量测度，即一个因子 $1/(2\\pi^2)$ 乘以在 $k\\in[k_{\\min},\\Lambda]$ 上的一个一维积分，其中 $k_{\\min}\\equiv \\max(k_F,0)$。\n- 两粒子能量分母为 $\\omega - 2 e(k) = \\omega - 2\\alpha k^2$。\n- 形状因子为 $g(k)=k\\,\\exp\\!\\left[-(k/\\beta)^2\\right]$。\n- 期望值为 $\\langle \\mathbf{L}\\cdot\\mathbf{S}\\rangle_{(1,1;J)}=\\frac{1}{2}\\left[J(J+1)-L(L+1)-S(S+1)\\right]$，其中 $L=S=1$。\n- 在程序中将所有输入视为精确值；不要对中间量进行四舍五入。\n\n测试套件（每种情况都是一个元组 $(k_F,\\omega,\\Lambda,\\beta,C_{LS},k_0)$，具有指定单位）：\n- 情况 A: $(\\,1.3\\ \\mathrm{fm}^{-1},\\ -20.0\\ \\mathrm{MeV},\\ 6.0\\ \\mathrm{fm}^{-1},\\ 2.0\\ \\mathrm{fm}^{-1},\\ -200.0\\ \\mathrm{MeV\\cdot fm}^5,\\ 1.3\\ \\mathrm{fm}^{-1}\\,)$。\n- 情况 B: $(\\,0.0\\ \\mathrm{fm}^{-1},\\ -5.0\\ \\mathrm{MeV},\\ 6.0\\ \\mathrm{fm}^{-1},\\ 2.0\\ \\mathrm{fm}^{-1},\\ -200.0\\ \\mathrm{MeV\\cdot fm}^5,\\ 1.0\\ \\mathrm{fm}^{-1}\\,)$。\n- 情况 C: $(\\,2.0\\ \\mathrm{fm}^{-1},\\ -40.0\\ \\mathrm{MeV},\\ 6.0\\ \\mathrm{fm}^{-1},\\ 2.0\\ \\mathrm{fm}^{-1},\\ -200.0\\ \\mathrm{MeV\\cdot fm}^5,\\ 2.0\\ \\mathrm{fm}^{-1}\\,)$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个含三个内部列表的列表，按 A、B、C 的顺序每个测试用例一个。\n- 每个内部列表必须按 $[\\,\\operatorname{Re}G^{(J=0)},\\ \\operatorname{Re}G^{(J=1)},\\ \\operatorname{Re}G^{(J=2)},\\ \\Delta_{21},\\ \\Delta_{10}\\,]$ 的确切顺序包含五个条目，所有值均以 $\\mathrm{MeV\\cdot fm}^3$ 为单位。\n- 外部列表和所有内部列表都必须用方括号打印，数字之间必须用逗号分隔，不得有附加文本。例如：$[[x_{A,0},x_{A,1},x_{A,2},x_{A,3},x_{A,4}],[x_{B,0},\\dots],[x_{C,0},\\dots]]$。", "solution": "用户提供了一个计算核物理问题，要求推导并数值求解对称核物质中简化的、可分离的自旋-轨道相互作用的 Bethe-Goldstone 方程。\n\n首先，我将验证问题陈述。\n\n### 第 1 步：提取已知条件\n- **物理系统**：零温度下的对称无限核物质，总双核子质心动量 $K=0$。\n- **运动方程**：Bethe–Goldstone 方程。\n- **分波**：三重态 P 波通道，$L=1$, $S=1$，产生总角动量 $J \\in \\{0, 1, 2\\}$，记为 $\\,^{3}P_{J}$。\n- **相互作用模型**：秩-1 可分离自旋-轨道势，$V_{LS}^{(J)}(k,k') \\equiv C_{LS}\\,\\langle \\mathbf{L}\\cdot\\mathbf{S}\\rangle_{(L=1,S=1;J)} \\, g(k)\\, g(k')$。\n- **形状因子**：$g(k) \\equiv k\\,\\exp\\!\\left[-(k/\\beta)^2\\right]$，其中 $k$ 和 $k'$ 是以 $\\mathrm{fm}^{-1}$ 为单位的相对动量。\n- **物理模型**：自由单粒子谱和角度平均的泡利投影算符，它对中间相对动量积分施加了一个尖锐的下限 $k_F$。还施加了一个额外的尖锐紫外截断 $\\Lambda$。\n- **能量谱**：两个核子的自由相对动能为 $e(k)=\\alpha\\,k^2$，其中 $\\alpha \\equiv \\hbar^2/m_N = 41.471\\,\\mathrm{MeV\\,fm}^2$。两粒子能量分母为 $\\omega - 2e(k) = \\omega - 2\\alpha k^2$，其中 $\\omega$ 是一个实的、严格为负的起始能量。\n- **动量积分**：循环积分使用带角度平均的三维测度，$\\frac{1}{2\\pi^2}\\int_{k_{\\min}}^{\\Lambda} k^2 dk$，其中 $k_{\\min} \\equiv \\max(k_F,0)$。\n- **角动量耦合**：自旋-轨道算符的期望值由 $\\langle \\mathbf{L}\\cdot\\mathbf{S}\\rangle_{(1,1;J)}=\\frac{1}{2}\\left[J(J+1)-L(L+1)-S(S+1)\\right]$ 给出，对于 $L=S=1$。\n- **任务**：计算 $J=0,1,2$ 的实在壳介质中反应矩阵元 $G^{(J)}(k_0,k_0;\\omega)$，以及能量分裂 $\\Delta_{21}\\equiv \\operatorname{Re}G^{(J=2)} - \\operatorname{Re}G^{(J=1)}$ 和 $\\Delta_{10}\\equiv \\operatorname{Re}G^{(J=1)} - \\operatorname{Re}G^{(J=0)}$。所有值都必须以 $\\mathrm{MeV\\cdot fm}^3$ 为单位。\n- **测试用例**：\n    - A: $(k_F,\\omega,\\Lambda,\\beta,C_{LS},k_0) = (1.3, -20.0, 6.0, 2.0, -200.0, 1.3)$，单位为 $\\mathrm{fm}^{-1}, \\mathrm{MeV}, \\mathrm{fm}^{-1}, \\mathrm{fm}^{-1}, \\mathrm{MeV\\cdot fm}^5, \\mathrm{fm}^{-1}$。\n    - B: $(k_F,\\omega,\\Lambda,\\beta,C_{LS},k_0) = (0.0, -5.0, 6.0, 2.0, -200.0, 1.0)$。\n    - C: $(k_F,\\omega,\\Lambda,\\beta,C_{LS},k_0) = (2.0, -40.0, 6.0, 2.0, -200.0, 2.0)$。\n\n### 第 2 步：使用提取的已知条件进行验证\n该问题具有科学依据，采用了 Bethe-Goldstone 方程，这是核多体理论中的一个标准工具。使用可分离势是求解此类积分方程的一种公认且有效的近似方法。物理参数，包括常数 $\\alpha$、费米动量和相互作用强度，都在核物理计算的典型范围内。问题提法清晰，为获得唯一解提供了所有必要的定义、常数和数据。语言客观明确。单位在内部是一致的：相互作用 $V^{(J)}(k,k')$ 的单位是 $(\\mathrm{MeV\\cdot fm}^5) \\cdot (\\mathrm{fm}^{-1}) \\cdot (\\mathrm{fm}^{-1}) = \\mathrm{MeV\\cdot fm}^3$，这对应于能量×体积，是动量空间势矩阵元的正确单位。所要求的输出也使用这些单位。该问题通过了所有验证标准。\n\n### 第 3 步：结论和行动\n问题有效。我现在将进行求解。\n\n### 基于原理的解决方案\n\n起点是介质中反应矩阵 $G$ 的 Bethe-Goldstone 方程，它对核介质中所有的二粒子梯形图进行求和。在由总角动量 $J$ 标识的特定分波通道中，它在相对动量表示中采用积分方程的形式：\n$$\nG^{(J)}(k, k'; \\omega) = V^{(J)}(k, k') + \\int_0^\\infty \\frac{p^2 dp}{2\\pi^2} V^{(J)}(k, p) \\frac{Q(p)}{\\omega - H_0(p)} G^{(J)}(p, k'; \\omega)\n$$\n在这里，$V^{(J)}$ 是裸核子-核子相互作用，$Q(p)$ 是泡利不相容原理算符，分母包含起始能量 $\\omega$ 和无相互作用的二粒子哈密顿量 $H_0(p)$。\n\n问题规定如下：\n1. 裸相互作用是一个秩-1 可分离自旋-轨道势：$V_{LS}^{(J)}(k,k') = C_{LS_J} g(k) g(k')$，其中 $C_{LS_J} \\equiv C_{LS} \\langle \\mathbf{L}\\cdot\\mathbf{S} \\rangle_{(1,1;J)}$，形状因子为 $g(k) = k e^{-(k/\\beta)^2}$。\n2. 对于零总动量 ($K=0$) 的角度平均泡利投影算符将中间态动量限制在费米动量之上，即 $p \\ge k_F$。给定紫外截断 $\\Lambda$，积分区域为 $p \\in [k_F, \\Lambda]$。这实际上意味着 $Q(p) = \\theta(p - k_F)\\theta(\\Lambda - p)$。\n3. 中间态能量是两个自由粒子的能量，$H_0(p) = 2e(p) = 2\\alpha p^2$。\n\n将这些代入 Bethe-Goldstone 方程得到：\n$$\nG^{(J)}(k, k'; \\omega) = C_{LS_J} g(k) g(k') + \\int_{k_F}^{\\Lambda} \\frac{p^2 dp}{2\\pi^2} \\left[ C_{LS_J} g(k) g(p) \\right] \\frac{1}{\\omega - 2\\alpha p^2} G^{(J)}(p, k'; \\omega)\n$$\n由于势的可分离性， $G^{(J)}$ 的解也必须是可分离的。我们做出如下拟设：\n$$\nG^{(J)}(k, k'; \\omega) = \\tau_J(\\omega) g(k) g(k')\n$$\n其中 $\\tau_J(\\omega)$ 是在起始能量 $\\omega$ 下，通道 $J$ 的一个约化的、与动量无关的振幅。将此拟设代入积分方程：\n$$\n\\tau_J(\\omega) g(k) g(k') = C_{LS_J} g(k) g(k') + C_{LS_J} g(k) \\left[ \\int_{k_F}^{\\Lambda} \\frac{p^2 dp}{2\\pi^2} \\frac{g(p)^2}{\\omega - 2\\alpha p^2} \\right] \\tau_J(\\omega) g(k')\n$$\n假设 $g(k)g(k') \\neq 0$，我们可以将其约去，得到一个关于 $\\tau_J(\\omega)$ 的标量代数方程：\n$$\n\\tau_J(\\omega) = C_{LS_J} + C_{LS_J} \\tau_J(\\omega) I(\\omega, k_F, \\Lambda)\n$$\n其中泡利阻塞循环积分 $I(\\omega, k_F, \\Lambda)$ 定义为：\n$$\nI(\\omega, k_F, \\Lambda) \\equiv \\frac{1}{2\\pi^2} \\int_{k_F}^{\\Lambda} \\frac{p^2 [g(p)]^2}{\\omega - 2\\alpha p^2} dp = \\frac{1}{2\\pi^2} \\int_{k_F}^{\\Lambda} \\frac{p^4 e^{-2(p/\\beta)^2}}{\\omega - 2\\alpha p^2} dp\n$$\n注意，问题将积分下限定义为 $k_{\\min} = \\max(k_F,0)$，由于在所有情况下 $k_F \\ge 0$，这通过将下限设置为 $k_F$ 来处理。起始能量 $\\omega$ 是严格为负的，所以分母 $\\omega - 2\\alpha p^2$ 总是负数且永不为零，确保积分是实数且良定义的。\n\n求解约化振幅 $\\tau_J(\\omega)$ 的代数方程：\n$$\n\\tau_J(\\omega) \\left[ 1 - C_{LS_J} I(\\omega, k_F, \\Lambda) \\right] = C_{LS_J} \\implies \\tau_J(\\omega) = \\frac{C_{LS_J}}{1 - C_{LS_J} I(\\omega, k_F, \\Lambda)}\n$$\n那么，在外部相对动量 $k_0$ 处的在壳反应矩阵元由下式给出：\n$$\nG^{(J)}(k_0, k_0; \\omega) = \\tau_J(\\omega) [g(k_0)]^2 = \\frac{C_{LS_J} [g(k_0)]^2}{1 - C_{LS_J} I(\\omega, k_F, \\Lambda)}\n$$\n该表达式提供了所需的矩阵元。\n\n通道依赖性由 $C_{LS_J}$ 决定，其中包含自旋-轨道期望值。对于 $^3P_J$ 态 ($L=1, S=1$)：\n$$\n\\langle \\mathbf{L}\\cdot\\mathbf{S}\\rangle_{(1,1;J)} = \\frac{1}{2}[J(J+1) - L(L+1) - S(S+1)] = \\frac{1}{2}[J(J+1) - 2 - 2] = \\frac{1}{2}[J(J+1) - 4]\n$$\n这产生以下具体值：\n- $J=0$: $\\langle \\mathbf{L}\\cdot\\mathbf{S}\\rangle_0 = \\frac{1}{2}[0 - 4] = -2$\n- $J=1$: $\\langle \\mathbf{L}\\cdot\\mathbf{S}\\rangle_1 = \\frac{1}{2}[2 - 4] = -1$\n- $J=2$: $\\langle \\mathbf{L}\\cdot\\mathbf{S}\\rangle_2 = \\frac{1}{2}[6 - 4] = +1$\n\n因此，每个通道的耦合常数为：\n- $C_{LS, J=0} = -2 C_{LS}$\n- $C_{LS, J=1} = -1 C_{LS}$\n- $C_{LS, J=2} = +1 C_{LS}$\n\n计算步骤如下：\n1. 对于每个测试用例，检索参数 $(k_F, \\omega, \\Lambda, \\beta, C_{LS}, k_0)$。\n2. 使用标准的数值求积方法，数值计算公共循环积分 $I(\\omega, k_F, \\Lambda)$。\n3. 计算公共因子 $[g(k_0)]^2 = (k_0 e^{-(k_0/\\beta)^2})^2$。\n4. 对于每个通道 $J \\in \\{0, 1, 2\\}$：\n    a. 确定通道耦合 $C_{LS_J}$。\n    b. 使用推导出的公式计算 $G^{(J)}(k_0, k_0; \\omega)$。\n5. 计算分裂 $\\Delta_{21} = G^{(J=2)} - G^{(J=1)}$ 和 $\\Delta_{10} = G^{(J=1)} - G^{(J=0)}$。\n6. 为当前测试用例整理五个结果 $[G^{(J=0)}, G^{(J=1)}, G^{(J=2)}, \\Delta_{21}, \\Delta_{10}]$。\n7. 对所有测试用例重复此过程，并将最终输出格式化为列表的列表。", "answer": "```python\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Solves the Bethe-Goldstone equation for a separable spin-orbit potential\n    in nuclear matter for the specified test cases.\n    \"\"\"\n    \n    # Constant alpha = hbar^2/m_N in MeV*fm^2\n    ALPHA = 41.471\n\n    # Test suite from the problem statement.\n    # Each case is a tuple (k_F, omega, Lambda, beta, C_LS, k_0) with units:\n    # (fm^-1, MeV, fm^-1, fm^-1, MeV*fm^5, fm^-1)\n    test_cases = [\n        (1.3, -20.0, 6.0, 2.0, -200.0, 1.3),  # Case A\n        (0.0, -5.0, 6.0, 2.0, -200.0, 1.0),   # Case B\n        (2.0, -40.0, 6.0, 2.0, -200.0, 2.0),   # Case C\n    ]\n\n    def calculate_g_matrix_for_case(params):\n        \"\"\"\n        Calculates the G-matrix elements and splittings for a single parameter set.\n        \"\"\"\n        k_F, omega, Lambda, beta, C_LS, k_0 = params\n\n        # Define the integrand for the loop integral calculation\n        # The integrand is p^4 * exp(-2*(p/beta)^2) / (omega - 2*alpha*p^2)\n        def integrand_for_quad(p):\n            return p**4 * np.exp(-2.0 * (p / beta)**2) / (omega - 2.0 * ALPHA * p**2)\n\n        # Numerically compute the loop integral using scipy.integrate.quad\n        # The integration range is [k_min, Lambda] where k_min = max(k_F, 0)\n        # The full loop integral includes the 1/(2*pi^2) factor from the 3D measure\n        k_min = max(k_F, 0.0)\n        integral_val, _ = integrate.quad(integrand_for_quad, k_min, Lambda)\n        loop_integral_I = integral_val / (2.0 * np.pi**2)\n\n        # Calculate the form factor squared at the on-shell point k_0\n        g_k0_sq = (k_0 * np.exp(-(k_0 / beta)**2))**2\n\n        G_values = {}\n        # Iterate over the three J channels in the 3P partial wave (L=1, S=1)\n        # J_vals = (0, 1, 2)\n        L = 1.0\n        S = 1.0\n        for J_val in [0.0, 1.0, 2.0]:\n            # Calculate the expectation value of L.S\n            ls_exp_val = 0.5 * (J_val * (J_val + 1.0) - L * (L + 1.0) - S * (S + 1.0))\n            \n            # Determine the channel-specific coupling constant C_LS_J\n            C_LS_J = C_LS * ls_exp_val\n            \n            # Calculate the G-matrix element for the channel J\n            denominator = 1.0 - C_LS_J * loop_integral_I\n            if abs(denominator)  1e-15: # Avoid division by zero\n                # This case indicates a pole, which should not happen for the given parameters\n                # As omega is strictly negative. But it is good practice to check.\n                G_J = np.inf\n            else:\n                numerator = C_LS_J * g_k0_sq\n                G_J = numerator / denominator\n            \n            G_values[int(J_val)] = G_J\n\n        G0 = G_values[0]\n        G1 = G_values[1]\n        G2 = G_values[2]\n\n        # Calculate the splittings\n        delta_21 = G2 - G1\n        delta_10 = G1 - G0\n\n        return [G0, G1, G2, delta_21, delta_10]\n\n    # Process all test cases\n    results = [calculate_g_matrix_for_case(case) for case in test_cases]\n\n    # Format the output string as specified: [[r1_1, r1_2, ...],[r2_1, r2_2, ...]]\n    formatted_inner_lists = [f\"[{','.join(map(str, row))}]\" for row in results]\n    final_output_string = f\"[{','.join(formatted_inner_lists)}]\"\n    \n    print(final_output_string)\n\n```", "id": "3594974"}]}