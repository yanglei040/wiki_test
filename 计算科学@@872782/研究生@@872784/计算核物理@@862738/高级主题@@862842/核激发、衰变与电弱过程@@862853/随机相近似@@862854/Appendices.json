{"hands_on_practices": [{"introduction": "我们从随机相位近似（RPA）的一个基础计算开始。这个练习使用一个简化的可分离偶极相互作用，从第一性原理推导RPA色散关系和响应增强因子。它介绍了核心思想：残余相互作用如何混合粒子-空穴组态，从而产生一个新的集体模式，其能量与未受扰动的能量相比发生了移动，并增强了系统对外部探针的响应。掌握这个推导是理解所有RPA应用的关键一步 [@problem_id:3606341]。", "problem": "考虑一个偶偶核，它由一个独立粒子平均场描述。该平均场支持一个单一的、近简并的同位旋矢量偶极粒子-空穴分支，其能量间隔为 $\\Delta$，对于同位旋矢量电偶极算符 $D=\\sum_{i} r_{i} Y_{1\\mu}(\\hat{r}_{i}) \\tau^{3}_{i}$ 的总未扰动约化跃迁强度为 $S \\equiv \\sum_{ph} |\\langle p|D|h\\rangle|^{2}$，其中 $\\tau^{3}_{i}$ 是核子 $i$ 的同位旋第三分量。假设存在一个可分离形式的剩余相互作用 $V=\\kappa D^{\\dagger} D$，其中耦合常数 $\\kappa$ 为实数。在零温下的线性响应理论框架内，使用随机相位近似 (RPA)，RPA 定义为粒子-空穴环图的无限求和，或等效地定义为含时哈特里-福克 (TDHF) 的自洽小振幅极限。\n\n从 $D$ 的无相互作用推迟响应函数出发，仅使用线性响应的既定原理（因果感受率和可分离核的几何级数重求和），推导：\n\n1. 集体同位旋矢量偶极模的 RPA 色散关系，并用 $\\kappa$、$\\Delta$、$S$ 和 $\\hbar$ 明确求解集体频率 $\\omega_{\\mathrm{RPA}}$。\n\n2. 静态集体性增强因子 $F(\\kappa)$，定义为无量纲比值 $F(\\kappa) \\equiv \\chi_{\\mathrm{RPA}}(0)/\\chi_{0}(0)$，其中 $\\chi_{0}(\\omega)$ 是 $D$ 的无相互作用（独立粒子）推迟响应，而 $\\chi_{\\mathrm{RPA}}(\\omega)$ 是相应的 RPA 响应。\n\n将您的最终结果表示为一对无量纲的闭合形式量 $\\left(\\frac{\\hbar \\omega_{\\mathrm{RPA}}}{\\Delta}\\right)^{2}$ 和 $F(\\kappa)$。不要代入数值，也不要提供单位。无需四舍五入。", "solution": "该问题是有效的，因为它在科学上基于核多体理论的原理，问题设定良好且目标明确，并且没有任何指定的无效缺陷。我们继续进行推导。\n\n该问题要求在随机相位近似 (RPA) 内，为一个简化的偶偶核模型推导两个量。该模型包含一个能量为 $\\Delta$ 的单一简并粒子-空穴 ($ph$) 分支和一个可分离的剩余相互作用 $V=\\kappa D^{\\dagger} D$。\n\n**第一部分：RPA 集体频率 $\\omega_{\\mathrm{RPA}}$ 的推导**\n\n首先，我们建立零温下的无相互作用推迟响应函数 $\\chi_{0}(\\omega)$。在其谱 Lehmann 表示中，它由下式给出：\n$$\n\\chi_{0}(\\omega) = \\sum_{n \\neq 0} \\left( \\frac{|\\langle n | D | 0 \\rangle|^2}{\\hbar\\omega - (E_n - E_0) + i\\eta} - \\frac{|\\langle 0 | D | n \\rangle|^2}{\\hbar\\omega + (E_n - E_0) - i\\eta} \\right)\n$$\n其中 $|0\\rangle$ 是基态， $|n\\rangle$ 是激发态，且 $\\eta \\to 0^+$。在独立粒子描述中，元激发是粒子-空穴类型的，因此我们设 $|n\\rangle \\to |ph\\rangle$ 且 $E_n - E_0 \\to E_p - E_h$。矩阵元变为 $|\\langle ph | D | 0 \\rangle|^2 = |\\langle p | D | h \\rangle|^2$。假设算符 $D$ 的性质使得强度中的前向和后向贡献相等，则表达式简化为：\n$$\n\\chi_{0}(\\omega) = \\sum_{ph} |\\langle p | D | h \\rangle|^2 \\left( \\frac{1}{\\hbar\\omega - (E_p - E_h) + i\\eta} - \\frac{1}{\\hbar\\omega + (E_p - E_h) - i\\eta} \\right)\n$$\n问题指定了一个单一、简并的 $ph$ 分支，这允许我们用单一能量 $\\Delta$ 替换各个粒子-空穴能量 $E_p - E_h$。总的未扰动强度由 $S \\equiv \\sum_{ph} |\\langle p|D|h\\rangle|^{2}$ 给出。因此，无相互作用响应函数变为：\n$$\n\\chi_{0}(\\omega) = S \\left( \\frac{1}{\\hbar\\omega - \\Delta + i\\eta} - \\frac{1}{\\hbar\\omega + \\Delta - i\\eta} \\right)\n$$\n合并各项可得：\n$$\n\\chi_{0}(\\omega) = S \\frac{(\\hbar\\omega + \\Delta - i\\eta) - (\\hbar\\omega - \\Delta + i\\eta)}{(\\hbar\\omega - \\Delta + i\\eta)(\\hbar\\omega + \\Delta - i\\eta)} = S \\frac{2\\Delta}{(\\hbar\\omega)^2 - \\Delta^2 + i\\eta'}\n$$\n为了确定实数本征频率，我们考虑 $\\chi_{0}(\\omega)$ 的实部：\n$$\n\\chi_{0}(\\omega) = \\frac{2S\\Delta}{(\\hbar\\omega)^2 - \\Delta^2}\n$$\nRPA 响应函数 $\\chi_{\\mathrm{RPA}}(\\omega)$ 通过对环图的无穷级数求和来计入剩余相互作用，它与 $\\chi_{0}(\\omega)$ 通过 Dyson 型方程相关联：\n$$\n\\chi_{\\mathrm{RPA}}(\\omega) = \\frac{\\chi_{0}(\\omega)}{1 - \\kappa \\chi_{0}(\\omega)}\n$$\n集体模的能量 $\\hbar\\omega_{\\mathrm{RPA}}$ 对应于相互作用响应函数 $\\chi_{\\mathrm{RPA}}(\\omega)$ 的极点。当分母为零时，出现这些极点。此条件给出了 RPA 色散关系：\n$$\n1 - \\kappa \\chi_{0}(\\omega_{\\mathrm{RPA}}) = 0\n$$\n代入 $\\chi_{0}(\\omega)$ 的表达式：\n$$\n1 - \\kappa \\left( \\frac{2S\\Delta}{(\\hbar\\omega_{\\mathrm{RPA}})^2 - \\Delta^2} \\right) = 0\n$$\n求解 $(\\hbar\\omega_{\\mathrm{RPA}})^2$：\n$$\n1 = \\frac{2\\kappa S\\Delta}{(\\hbar\\omega_{\\mathrm{RPA}})^2 - \\Delta^2}\n$$\n$$\n(\\hbar\\omega_{\\mathrm{RPA}})^2 - \\Delta^2 = 2\\kappa S\\Delta\n$$\n$$\n(\\hbar\\omega_{\\mathrm{RPA}})^2 = \\Delta^2 + 2\\kappa S\\Delta = \\Delta^2 \\left( 1 + \\frac{2\\kappa S}{\\Delta} \\right)\n$$\n问题要求的是无量纲量 $\\left(\\frac{\\hbar \\omega_{\\mathrm{RPA}}}{\\Delta}\\right)^{2}$。将上述方程除以 $\\Delta^2$ 得到第一个结果：\n$$\n\\left(\\frac{\\hbar \\omega_{\\mathrm{RPA}}}{\\Delta}\\right)^{2} = 1 + \\frac{2\\kappa S}{\\Delta}\n$$\n\n**第二部分：静态集体性增强因子 $F(\\kappa)$ 的推导**\n\n静态集体性增强因子定义为静态 ($\\omega=0$) RPA 感受率与静态无相互作用感受率之比：\n$$\nF(\\kappa) \\equiv \\frac{\\chi_{\\mathrm{RPA}}(0)}{\\chi_{0}(0)}\n$$\n使用 $\\chi_{\\mathrm{RPA}}$ 和 $\\chi_{0}$ 之间的关系，我们可以写出：\n$$\nF(\\kappa) = \\frac{\\left( \\frac{\\chi_{0}(0)}{1 - \\kappa \\chi_{0}(0)} \\right)}{\\chi_{0}(0)} = \\frac{1}{1 - \\kappa \\chi_{0}(0)}\n$$\n为了计算这个值，我们首先通过在其表达式中设置 $\\omega=0$ 来计算静态无相互作用感受率 $\\chi_0(0)$：\n$$\n\\chi_{0}(0) = \\frac{2S\\Delta}{(0)^2 - \\Delta^2} = -\\frac{2S}{\\Delta}\n$$\n负号表示基态能量因静态微扰（极化率）而降低。\n将此结果代入 $F(\\kappa)$ 的表达式中：\n$$\nF(\\kappa) = \\frac{1}{1 - \\kappa \\left(-\\frac{2S}{\\Delta}\\right)} = \\frac{1}{1 + \\frac{2\\kappa S}{\\Delta}}\n$$\n这是第二个要求的结果。两个推导出的量都是无量纲的，并用给定的参数表示。", "answer": "$$\n\\boxed{\\begin{pmatrix} 1 + \\frac{2S\\kappa}{\\Delta}  \\frac{1}{1 + \\frac{2S\\kappa}{\\Delta}} \\end{pmatrix}}\n$$", "id": "3606341"}, {"introduction": "现在，我们将RPA框架应用于一个关键的物理现象：原子核形变。此练习将演示吸引人的四极-四极相互作用如何导致“软模式”的出现，即RPA激发能量降至零。这标志着球形基态的不稳定性，预示着系统会自发地转变为形变状态。这个练习 [@problem_id:3606357] 在微观相互作用与宏观核结构属性之间建立了具体的联系，展示了RPA作为预测量子相变的强大工具。", "problem": "考虑一个球形哈特里-福克（HF）平均场哈密顿量，它受到一个剩余等标量四极相互作用的微扰，该相互作用被模拟为单个可分离的通道，其剩余相互作用算符为 $V_{\\text{res}}=-\\kappa\\,\\hat{Q}\\,\\hat{Q}$，其中 $\\kappa>0$ 且 $\\hat{Q}$ 是质量四极算符。假设原子核有一个主要的粒子-空穴门态组态 $\\{|p\\rangle,|h\\rangle\\}$，它承载了四极集体性，其未受微扰的粒子-空穴能量为 $\\,\\varepsilon=\\varepsilon_{p}-\\varepsilon_{h}>0\\,$，跃迁矩阵元为 $\\,q=\\langle p|\\hat{Q}|h\\rangle\\,$（取 $q$ 为实数且非零）。在线性化含时哈特里-福克（随机相近似，RPA）的准玻色子近似框架下，并限制在这一单个门态组态中进行研究。\n\n从 RPA 正则模式的运动方程定义和 $V_{\\text{res}}$ 的可分离结构出发，构建这个单模式模型的 $2\\times 2$ RPA 矩阵及其本征频率方程。利用 RPA 基态稳定性所需的正定性条件 $A-B>0$ 来确定哪个因子控制着模式的软化。分析软模式条件 $\\,\\omega\\to 0\\,$，并确定 RPA 模式变软时的临界耦合强度 $\\,\\kappa_{c}\\,$，这标志着 HF 平均场的形状形变不稳定性。将你的最终结果表示为 $\\,\\kappa_{c}\\,$ 关于 $\\,\\varepsilon\\,$ 和 $\\,q\\,$ 的闭式解析表达式。不要引入任何额外的唯象参数。无需进行数值计算。", "solution": "该问题要求在一个简化的随机相近似（RPA）模型中，推导形状形变不稳定性对应的临界耦合强度 $\\kappa_c$。这种不稳定性由一个“软模式”标志，即集体激发频率 $\\omega$ 趋于零。\n\n出发点是 RPA 运动方程，在准玻色子近似下，对于粒子-空穴（ph）激发的前向（$X$）和后向（$Y$）振幅，可以写成矩阵形式：\n$$\n\\begin{pmatrix} A  B \\\\ -B^*  -A^* \\end{pmatrix} \\begin{pmatrix} X \\\\ Y \\end{pmatrix} = \\hbar\\omega \\begin{pmatrix} X \\\\ Y \\end{pmatrix}\n$$\n问题被限制在单个粒子-空穴组态，记为 $|ph\\rangle$。因此，矩阵 $A$ 和 $B$ 是 $1 \\times 1$ 的矩阵（即标量），向量 $X$ 和 $Y$ 也是标量。问题描述暗示矩阵元是实数，所以我们可以省略复共轭符号。RPA 本征值方程变为：\n$$\n\\det\\begin{pmatrix} A - \\omega  B \\\\ -B  -A - \\omega \\end{pmatrix} = 0\n$$\n这导出了特征方程：\n$$\n-(A - \\omega)(A + \\omega) + B^2 = 0 \\implies \\omega^2 - A^2 + B^2 = 0\n$$\n因此，本征频率 $\\omega$ 由著名的 RPA 色散关系给出：\n$$\n\\omega^2 = A^2 - B^2 = (A - B)(A + B)\n$$\n（我们在 $\\hbar=1$ 的单位制下进行计算）。\n\n下一步是确定 $A$ 和 $B$ 的表达式。对于一个具有 $V_{\\text{res}} = -\\kappa \\hat{Q}\\hat{Q}$ 形式的可分离两体相互作用的示意模型，矩阵元 $A_{p_1h_1, p_2h_2}$ 和 $B_{p_1h_1, p_2h_2}$ 由以下公式给出：\n$$\nA_{p_1h_1, p_2h_2} = (\\varepsilon_{p_1} - \\varepsilon_{h_1})\\delta_{p_1p_2}\\delta_{h_1h_2} + V_{p_1h_2, p_2h_1}\n$$\n$$\nB_{p_1h_1, p_2h_2} = V_{p_1p_2, h_1h_2}\n$$\n在可分离相互作用的标准示意模型处理中（为简化起见，忽略交换项，这是此类模型的常见做法），相互作用矩阵元与算符 $\\hat{Q}$ 的单粒子矩阵元相关。通过线性响应理论对相互作用 $V=-\\kappa \\hat{Q}\\hat{Q}$ 进行一致性推导，可以得到对 $A$ 和 $B$ 矩阵的有效贡献。\n\n对于具有未微扰能量 $\\varepsilon = \\varepsilon_p - \\varepsilon_h$ 和跃迁矩阵元 $q = \\langle p | \\hat{Q} | h \\rangle$ 的单个粒子-空穴态，矩阵 $A$ 和 $B$ 成为标量，定义为：\n$$\nA = \\varepsilon - \\kappa q^2\n$$\n$$\nB = -\\kappa q^2\n$$\n这个形式可以从含时哈特里-福克理论中的自洽条件严格推导出来，该条件导出色散关系 $1 = \\kappa \\alpha(\\omega)$，其中 $\\alpha(\\omega)$ 是系统的极化率。对于单个粒子-空穴模式，这给出 $1 = \\kappa \\frac{2\\varepsilon q^2}{\\varepsilon^2 - \\omega^2}$，整理后得到 $\\omega^2 = \\varepsilon(\\varepsilon - 2\\kappa q^2)$。正如我们现在将要验证的，这与上面为 $A$ 和 $B$ 选择的矩阵元是一致的。\n\n这个单模式模型的 $2 \\times 2$ RPA 矩阵是：\n$$\n\\mathbf{M}_{\\text{RPA}} = \\begin{pmatrix} A  B \\\\ -B  -A \\end{pmatrix} = \\begin{pmatrix} \\varepsilon - \\kappa q^2  -\\kappa q^2 \\\\ \\kappa q^2  -(\\varepsilon - \\kappa q^2) \\end{pmatrix}\n$$\n通过将 $A$ 和 $B$ 的这些表达式代入色散关系 $\\omega^2 = (A-B)(A+B)$，可以得到本征频率方程：\n$$\nA - B = (\\varepsilon - \\kappa q^2) - (-\\kappa q^2) = \\varepsilon\n$$\n$$\nA + B = (\\varepsilon - \\kappa q^2) + (-\\kappa q^2) = \\varepsilon - 2\\kappa q^2\n$$\n因此，本征频率方程是：\n$$\n\\omega^2 = \\varepsilon (\\varepsilon - 2\\kappa q^2)\n$$\nRPA 基态（即哈特里-福克基态）对于小振幅振荡的稳定性要求 RPA 本征值 $\\omega$ 是实数，这意味着 $\\omega^2 > 0$。更根本地，它要求系统的稳定性矩阵是正定的，这导致条件 $A - B > 0$ 和 $A + B > 0$。\n\n让我们来考察这些条件。\n第一个条件 $A - B > 0$ 对应于 $\\varepsilon > 0$。问题陈述已给出 $\\varepsilon = \\varepsilon_p - \\varepsilon_h > 0$，所以这个条件是内在地满足的。这个因子代表了未受微扰的哈特里-福克基态对粒子-空穴激发的稳定性。\n\n第二个条件 $A + B > 0$ 对应于 $\\varepsilon - 2\\kappa q^2 > 0$。这个因子涉及剩余相互作用的强度 $\\kappa$。随着 $\\kappa$ 的增加，$A+B$ 项减小。RPA 模式的软化，即其频率 $\\omega$ 降低到未受微扰能量 $\\varepsilon$ 以下，是由这个因子控制的。吸引相互作用（$\\kappa > 0$）导致 $\\omega  \\varepsilon$，表明这是一个集体态。\n\n软模式条件由极限 $\\omega \\to 0$ 定义。从本征频率方程 $\\omega^2 = \\varepsilon(\\varepsilon - 2\\kappa q^2)$ 出发，并考虑到 $\\varepsilon > 0$，条件 $\\omega=0$ 在以下情况满足：\n$$\n\\varepsilon - 2\\kappa q^2 = 0\n$$\n这恰好是稳定性条件 $A+B > 0$ 被破坏的点。发生这种情况时的耦合强度 $\\kappa$ 的值就是临界耦合强度 $\\kappa_c$。\n求解 $\\kappa_c$：\n$$\n\\varepsilon = 2\\kappa_c q^2\n$$\n由于问题指定 $q$ 是实数且非零，我们可以唯一地解出 $\\kappa_c$。\n$$\n\\kappa_c = \\frac{\\varepsilon}{2q^2}\n$$\n在这个临界强度下，对抗四极形变的恢复力消失，球形哈特里-福克平均场变得不稳定，标志着向形变基态的相变。", "answer": "$$\\boxed{\\frac{\\varepsilon}{2q^2}}$$", "id": "3606357"}, {"introduction": "前面的例子可以通过解析方法求解，现在我们转向将RPA应用于现实、复杂原子核所面临的实际挑战。真实的RPA计算涉及求解一个大型、非厄米的广义本征值问题。这个问题 [@problem_id:3606310] 要求理解为有效解决这种独特数学结构而调整的数值方法，特别是像Arnoldi方法这样的克雷洛夫子空间算法。这项练习弥合了教科书理论与计算实践之间的鸿沟，强调了在现代核结构研究中实现和求解RPA方程所需的算法思维。", "problem": "考虑核多体系统中时间相关平均场理论的小振幅线性响应极限，该极限产生了广义形式的随机相近似（RPA）本征问题\n$$\nH x = \\omega \\eta x,\n$$\n其中 $H \\in \\mathbb{C}^{N \\times N}$ 是一个大型稀疏非厄米矩阵，但关于度规 $\\eta$ 是伪厄米的（即 $H^\\dagger \\eta = \\eta H$），并且 $\\eta$ 是一个不定度规，其块对角符号与粒子-空穴结构一致（例如 $\\eta = \\mathrm{diag}(I,-I)$）。在计算核物理中，研究人员寻求一种鲁棒的 Krylov 子空间算法，用于在目标频率附近近似求解 $H$ 的一部分物理相关的本征对 $(\\omega,x)$，而无需构建完整的稠密因子分解。\n\n从上述基本事实（广义本征问题、伪厄米性以及由 $(u,v)_\\eta \\equiv u^\\dagger \\eta v$ 定义的导出 $\\eta$-内积）出发，选择正确概述了一种利用适应于度规 $\\eta$ 的 Arnoldi 或 Lanczos 方法的算法途径，并指明了在存在不定度规时科学上合理的收敛判据和正交性管理的选项。您的选择必须与以下几点一致：\n- 结构 $H^\\dagger \\eta = \\eta H$ 和广义 RPA 本征问题 $H x = \\omega \\eta x$。\n- $\\eta$-正交性的定义及其在 Krylov 基中的数值保持。\n- 在 Krylov 子空间上的 Rayleigh-Ritz 抽取以及与广义问题兼容的基于残差的收敛监测。\n- 处理与近零 $\\eta$-范数方向相关的潜在崩溃以及 RPA 本征值的配对结构的需求。\n\n哪个选项是正确的？\n\nA. 对 $H$ 使用标准的厄米 Lanczos 算法和欧几里得内积，构建满足 $V_k^\\dagger V_k = I$ 的三项递推关系，将 $H$ 投影为 $T_k = V_k^\\dagger H V_k$（三对角），求解 $T_k y = \\omega y$，并在 Rayleigh 商稳定时接受收敛。正交性通过欧几里得范数下的经典 Gram-Schmidt 过程来保持。\n\nB. 使用单边 Arnoldi 过程，通过相对于 $(\\cdot,\\cdot)_\\eta$ 的修正 Gram-Schmidt 过程来维持一个满足 $V_k^\\dagger \\eta V_k = I$ 的 Krylov 基 $V_k = [v_1,\\dots,v_k]$，从而强制执行 $\\eta$-正交性；在第 $j$ 次迭代时，计算 $w = H v_j$，令 $h_{ij} = (v_i,w)_\\eta$，并正交化 $w \\leftarrow w - \\sum_{i=1}^j v_i h_{ij}$。如果 $(w,w)_\\eta$ 足够小，则执行前瞻或紧缩以避免崩溃。构建投影算子\n$$\nH_k = V_k^\\dagger \\eta H V_k,\n$$\n并通过求解 $H_k y = \\omega y$ 来提取 Ritz 对；近似本征向量为 $x = V_k y$。使用广义残差\n$$\nr \\equiv H x - \\omega \\eta x,\n$$\n来监测收敛，要求 $\\|r\\|_2 / \\|H x\\|_2  \\varepsilon$ 且 $\\omega$ 在连续迭代中稳定。通过选择性再正交化强制执行数值上的 $\\eta$-正交性，并通过左 Ritz 向量 $\\tilde{x} = \\eta x$ 和配对对称性 $(+\\omega,-\\omega)$ 来验证伪厄米一致性；紧缩掉伪假的近零 $\\eta$-范数状态。\n\nC. 通过左乘以 $\\eta$ 将问题转换为标准厄米形式，得到 $\\eta H x = \\omega x$，注意到 $\\eta H$ 是厄米的，然后应用满足 $V_k^\\dagger V_k = I$ 的对称 Lanczos 算法。仅通过欧几里得残差 $\\| \\eta H x - \\omega x \\|_2$ 评估收敛性，且正交性在欧几里得意义下保持。\n\nD. 应用非厄米双边 Lanczos 算法，但用一个移位度规替换不定度规，强制执行 $V_k^\\dagger (\\eta + \\epsilon I) V_k = I$（其中 $\\epsilon > 0$ 是一个小量）以避免崩溃。用 $H_k = V_k^\\dagger H V_k$ 进行投影，并在 $\\|H V_k y - \\omega V_k y\\|_2$ 低于容差时接受收敛。忽略 RPA 配对对称性，并接受所有收敛的 Ritz 值。", "solution": "随机相近似（RPA）广义本征问题 $H x = \\omega \\eta x$ 源于对时间相关平均场方程的线性化。算子 $H$ 在欧几里得内积下是非厄米的，但满足伪厄米性 $H^\\dagger \\eta = \\eta H$。合适的内积是不定的 $\\eta$-内积 $(u,v)_\\eta = u^\\dagger \\eta v$，其导出的正交性为 $u^\\dagger \\eta v = 0$。一个鲁棒的 Krylov 子空间投影必须遵循这一结构，才能得到物理上有意义的本征对和稳定的数值计算。\n\n基于原理的投影推导：\n- 从广义问题 $H x = \\omega \\eta x$ 开始。\n- 在由 $V_k = [v_1,\\dots,v_k]$ 张成的 Krylov 子空间中寻求一个近似解 $x \\approx V_k y$，并带有度规正交归一约束 $V_k^\\dagger \\eta V_k = I$。\n- 施加与 $\\eta$-内积兼容的 Galerkin 条件：$V_k^\\dagger \\eta (H V_k y - \\omega \\eta V_k y) = 0$。\n- 利用 $V_k^\\dagger \\eta V_k = I$，得到约化的标准本征问题\n$$\nH_k y = \\omega y, \\quad H_k \\equiv V_k^\\dagger \\eta H V_k.\n$$\n- Ritz 向量为 $x = V_k y$，其对于广义问题的残差为 $r = H x - \\omega \\eta x$。\n\n构建 Krylov 基：\n- 使用适应于 $(\\cdot,\\cdot)_\\eta$ 的 Arnoldi 关系：给定 $v_j$，计算 $w = H v_j$。\n- 计算 $h_{ij} = (v_i,w)_\\eta = v_i^\\dagger \\eta w$，并进行正交化\n$$\nw \\leftarrow w - \\sum_{i=1}^j v_i h_{ij}.\n$$\n- 用 $v_{j+1} = w / \\beta$ 进行归一化，其中 $\\beta = \\sqrt{|(w,w)_\\eta|}$；如果 $(w,w)_\\eta$ 过小（接近崩溃），则使用前瞻来跳过该方向或将其紧缩。\n- 通过相对于 $(\\cdot,\\cdot)_\\eta$ 的修正 Gram-Schmidt 过程和选择性再正交化来维持 $V_k^\\dagger \\eta V_k = I$。\n\n收敛判据：\n- 广义本征对的后向误差由残差范数衡量\n$$\n\\frac{\\|r\\|_2}{\\|H x\\|_2} = \\frac{\\|H x - \\omega \\eta x\\|_2}{\\|H x\\|_2}  \\varepsilon,\n$$\n其中 $0  \\varepsilon \\ll 1$ 是一个预设的容差。\n- Ritz 值的稳定：要求 $|\\omega^{(k)} - \\omega^{(k-1)}|  \\delta$，其中 $0  \\delta \\ll 1$ 是一个小量。\n- 对于伪厄米性，通过左 Ritz 向量 $\\tilde{x} = \\eta x$ 和谱的 RPA 对称性来验证一致性：物理模式以 $(+\\omega,-\\omega)$ 对的形式出现；监测这种配对并紧缩伪假的近零 $\\eta$-范数模式。\n\n正交性与双正交性：\n- 对于非厄米矩阵 $H$，左和右 Krylov 基通常是不同的。伪厄米性为左 Ritz 向量提供了一个关系：$\\tilde{x} = \\eta x$。使用 $V_k^\\dagger \\eta V_k = I$ 确保了右基是伪正交归一的。\n- 数值稳定性要求在 $\\eta$-内积中进行选择性再正交化以控制 $\\eta$-正交性的损失，并检测具有小 $\\eta$-范数的方向以避免不稳定性。\n\n逐项分析：\n\nA. 使用标准的厄米 Lanczos 算法和欧几里得内积，并假设 $H$ 是厄米的。这与基本结构 $H^\\dagger \\eta = \\eta H$ 和广义本征问题 $H x = \\omega \\eta x$ 相矛盾。欧几里得内积中的三项 Lanczos 递推关系依赖于 $H$ 不具备的对称性。使用 $V_k^\\dagger H V_k$ 进行投影会误用广义问题的 Galerkin 条件，并且不会强制执行正确的 $\\eta$-正交性。仅基于欧几里得设定下的 Rayleigh 商的收敛判据是不合适的。结论：不正确。\n\nB. 构建一个 Krylov 基，通过在 $(\\cdot,\\cdot)_\\eta$ 下使用修正 Gram-Schmidt 过程强制执行 $V_k^\\dagger \\eta V_k = I$，使用 Arnoldi 正交化系数 $h_{ij} = (v_i,w)_\\eta$，在 $(w,w)_\\eta$ 过小时通过前瞻或紧缩来处理崩溃，并构建投影算子 $H_k = V_k^\\dagger \\eta H V_k$。广义问题的 Rayleigh-Ritz 条件产生 $H_k y = \\omega y$，近似本征向量为 $x = V_k y$。基于广义残差 $\\|H x - \\omega \\eta x\\|_2$ 和 $\\omega$ 的稳定性的收敛性是科学上合理的。它还通过选择性再正交化强制执行数值上的 $\\eta$-正交性，并通过 $\\tilde{x} = \\eta x$ 和预期的 $(+\\omega,-\\omega)$ 配对来检查伪厄米一致性，同时紧缩伪假的近零 $\\eta$-范数状态。这与基本结构一致，并恰当地处理了正交性和收敛性问题。结论：正确。\n\nC. 声称 $\\eta H$ 是厄米的，因此适用于对称 Lanczos 算法。然而，对于不定的度规 $\\eta$（例如 $\\eta = \\mathrm{diag}(I,-I)$），$\\eta H$ 通常不是厄米的；伪厄米性要求 $H^\\dagger \\eta = \\eta H$，但这并不意味着 $(\\eta H)^\\dagger = \\eta H$。完全在欧几里得内积中处理该问题忽略了广义结构和 $\\eta$-正交性，会导致不正确的投影和潜在的不稳定性。结论：不正确。\n\nD. 提议用 $\\eta + \\epsilon I$ 替换 $\\eta$ 以避免崩溃，这破坏了精确的伪厄米结构并改变了问题的物理性质。使用 $V_k^\\dagger H V_k$ 进行投影忽略了 $H x = \\omega \\eta x$ 的广义性质；残差 $\\|H V_k y - \\omega V_k y\\|_2$ 并非广义问题的正确度量。忽略 RPA 配对对称性则移除了一个对物理收敛性的重要验证。结论：不正确。\n\n因此，选项 B 提供了科学上一致的算法纲要，并包含适当的收敛判据和正交性管理。", "answer": "$$\\boxed{B}$$", "id": "3606310"}]}