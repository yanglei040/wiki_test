{"hands_on_practices": [{"introduction": "有效相互作用的核心思想是将复杂的多体问题简化到可解的模型空间中。本练习旨在通过微扰论从第一性原理出发，构建一个简化的有效哈密顿量。通过实践此问题，您将掌握如何运用幺正变换方法系统地“积掉”高能自由度，从而推导出在模型空间内包含了模型空间外耦合效应的、能量无关的有效哈密顿量。", "problem": "考虑一个哈密顿量，它被划分到一个维度为 $2$ 的模型空间 $P$ 和一个维度为 $1$ 的排除空间 $Q$ 中。设 $P$ 的标准正交基为 $\\{|p_{1}\\rangle, |p_{2}\\rangle\\}$，$Q$ 的基为 $\\{|q\\rangle\\}$。未微扰哈密顿量为 $H_{0}$，满足\n$$\nH_{0}|p_{i}\\rangle = \\varepsilon_{i}|p_{i}\\rangle \\quad (i=1,2), \\qquad H_{0}|q\\rangle = \\varepsilon_{q}|q\\rangle,\n$$\n并且存在一个微扰 $V$ 只耦合 $P$ 和 $Q$，使得\n$$\n\\langle q|V|p_{i}\\rangle = v_{i}, \\qquad \\langle p_{i}|V|q\\rangle = v_{i}, \\qquad \\langle p_{i}|V|p_{j}\\rangle = 0, \\qquad \\langle q|V|q\\rangle=0,\n$$\n其中 $v_{i}\\in\\mathbb{R}$。完整哈密顿量为 $H=H_{0}+g\\,V$，其中 $g$ 是一个小的无量纲耦合強度。定义投影算符 $P=|p_{1}\\rangle\\langle p_{1}|+|p_{2}\\rangle\\langle p_{2}|$ 和 $Q=|q\\rangle\\langle q|$，以及波算符 $\\omega$。对于 $H$ 的本征态，波算符通过 $|\\psi_{Q}\\rangle=\\omega\\,|\\psi_{P}\\rangle$ 将 $P$ 空间分量映射到 $Q$ 空间分量。\n\n从不含时薛定谔方程和投影算符形式体系出发，使用与 Okubo-Lee-Suzuki (OLS) 方法和 Schrieffer-Wolff (SW) 变换一致的幺正解耦方法，完成以下任务：\n\n1. 推导波算符 $\\omega$ 关于 $g$ 的一阶表达式（即，计算 $\\omega$ 到 $O(g)$ 阶）。\n2. 通过一个块非对角反厄米生成元消除 $P$-$Q$ 耦合，从而构建作用于模型空间 $P$ 内、不依赖于能量的厄米有效哈密顿量 $H_{\\mathrm{eff}}$，精确到 $O(g^{2})$ 阶。\n\n你最终报告的量应该是有效哈密頓量的迹 $\\mathrm{Tr}(H_{\\mathrm{eff}})$ 的闭合形式解析表达式，精确到 $O(g^{2})$ 阶。没有提供数值；你的答案必须用 $\\varepsilon_{1}$、$\\varepsilon_{2}$、$\\varepsilon_{q}$、$g$、$v_{1}$ 和 $v_{2}$ 以符号形式表示。答案必须是一个单一的表达式。不需要四舍五入。", "solution": "该问题是良定的，其科学基础是量子力学和多体有效场论的原理，并且为符号求解提供了所有必要的参数。该问题是有效的。\n\n总哈密顿量为 $H = H_0 + gV$，其中 $H_0$ 是未微扰部分，$gV$ 是相互作用。希尔伯特空间被划分为模型空间 $P$ 和排除空间 $Q$。在给定基 $\\{|p_1\\rangle, |p_2\\rangle, |q\\rangle\\}$ 中，算符可以表示为矩阵。\n未微扰哈密顿量 $H_0$ 是对角的：\n$$\nH_0 = \\begin{pmatrix} \\varepsilon_1  0  0 \\\\ 0  \\varepsilon_2  0 \\\\ 0  0  \\varepsilon_q \\end{pmatrix}\n$$\n微扰 $V$ 在 $P$ 和 $Q$ 空间之间是纯粹块非对角的：\n$$\nV = \\begin{pmatrix} 0  0  v_1 \\\\ 0  0  v_2 \\\\ v_1  v_2  0 \\end{pmatrix}\n$$\n问题要求使用幺正变换 $U = e^S$ 来块对角化完整哈密顿量 $H = H_0 + gV$。生成元 $S$ 必须是反厄米的（$S^\\dagger = -S$）和块非对角的，只耦合 $P$ 和 $Q$ 空间。这确保了变换后的哈密顿量 $H' = U H U^\\dagger$ 在 $P$ 和 $Q$ 空间之間没有耦合，即 $P H' Q = 0$ 和 $Q H' P = 0$。有效哈密顿量则定义为 $H_{\\mathrm{eff}} = P H' P$。\n\n生成元 $S$ 可以写成块形式：\n$$\nS = \\begin{pmatrix} 0  S_{PQ} \\\\ S_{QP}  0 \\end{pmatrix}\n$$\n其中 $S_{PQ}$ 是一个 $2 \\times 1$ 矩阵，$S_{QP}$ 是一个 $1 \\times 2$ 矩阵。反厄米性要求 $S_{PQ} = -S_{QP}^\\dagger$。\n\n我们将生成元 $S$ 和变换后的哈密顿量 $H'$ 按耦合强度 $g$ 的幂次展开：\n$S = g S_1 + g^2 S_2 + O(g^3)$\n$H' = e^S H e^{-S} = H + [S, H] + \\frac{1}{2!}[S, [S, H]] + \\dots$\n\n解耦条件 $Q H' P = 0$ 按 $g$ 的阶数逐阶满足。\n到 $O(g)$ 阶：\n$Q(gV + [gS_1, H_0])P = 0$\n$g(QVP + Q[S_1, H_0]P) = 0$\n$V_{QP} + (S_{1,QP}H_{0P} - H_{0Q}S_{1,QP}) = 0$\n$H_{0Q}S_{1,QP} - S_{1,QP}H_{0P} = V_{QP}$\n\n以矩阵元形式，令 $S_{1,QP} = \\begin{pmatrix} s_1  s_2 \\end{pmatrix}$。\n$\\varepsilon_q \\begin{pmatrix} s_1  s_2 \\end{pmatrix} - \\begin{pmatrix} s_1  s_2 \\end{pmatrix} \\begin{pmatrix} \\varepsilon_1  0 \\\\ 0  \\varepsilon_2 \\end{pmatrix} = \\begin{pmatrix} v_1  v_2 \\end{pmatrix}$\n这得到两个独立的方程：\n$\\varepsilon_q s_1 - s_1 \\varepsilon_1 = v_1 \\implies s_1 = \\frac{v_1}{\\varepsilon_q - \\varepsilon_1}$\n$\\varepsilon_q s_2 - s_2 \\varepsilon_2 = v_2 \\implies s_2 = \\frac{v_2}{\\varepsilon_q - \\varepsilon_2}$\n所以，一阶生成元分量为 $S_1$，其中 $S_{1,QP} = \\left(\\frac{v_1}{\\varepsilon_q - \\varepsilon_1}, \\frac{v_2}{\\varepsilon_q - \\varepsilon_2}\\right)$。\n\n**1. 波算符 $\\omega$ 的推导**\n\n波算符 $\\omega$ 通过 $|\\psi_Q\\rangle = \\omega|\\psi_P\\rangle$ 关联了 $H$ 的一个精确本征态 $|\\psi\\rangle$ 的 $P$ 空间分量和 $Q$ 空间分量。幺正变换将 $|\\psi\\rangle$ 映射到一个纯粹在 $P$ 空间中的态 $|\\phi_P\\rangle$：$|\\phi_P\\rangle = U|\\psi\\rangle$。因此，$|\\psi\\rangle = U^\\dagger |\\phi_P\\rangle = e^{-S}|\\phi_P\\rangle$。\n展开到 $g$ 的一阶：$|\\psi\\rangle \\approx (I - gS_1)|\\phi_P\\rangle$。\n各分量为：\n$|\\psi_P\\rangle = P|\\psi\\rangle \\approx P(I - gS_1)|\\phi_P\\rangle = |\\phi_P\\rangle$\n$|\\psi_Q\\rangle = Q|\\psi\\rangle \\approx Q(I - gS_1)|\\phi_P\\rangle = -gQS_1P|\\phi_P\\rangle = -gS_{1,QP}|\\phi_P\\rangle$\n代入 $|\\phi_P\\rangle \\approx |\\psi_P\\rangle$ 得到 $|\\psi_Q\\rangle \\approx -gS_{1,QP}|\\psi_P\\rangle$。\n根据定义，$\\omega = Q\\omega P$。到一阶，我们有 $\\omega^{(1)}=-gS_{1,QP}$。\n在给定基中，$\\omega^{(1)}$ 表示为 $1 \\times 2$ 矩阵：\n$$\n\\omega^{(1)} = -g \\begin{pmatrix} \\frac{v_1}{\\varepsilon_q - \\varepsilon_1}  \\frac{v_2}{\\varepsilon_q - \\varepsilon_2} \\end{pmatrix} = g \\begin{pmatrix} \\frac{v_1}{\\varepsilon_1 - \\varepsilon_q}  \\frac{v_2}{\\varepsilon_2 - \\varepsilon_q} \\end{pmatrix}\n$$\n\n**2. 有效哈密顿量 $H_{\\mathrm{eff}}$ 的构建**\n\n有效哈密顿量为 $H_{\\mathrm{eff}} = P H' P$。我们将其展开到 $O(g^2)$ 阶：\n$H_{\\mathrm{eff}} = P(H_0 + gV)P + P[gS_1, H_0+gV]P + \\frac{1}{2}P[gS_1, [gS_1, H_0+gV]]P + O(g^3)$\n\n让我们逐阶计算各项：\n- $O(g^0)$ 阶：$PH_0P = H_{0P} = \\begin{pmatrix} \\varepsilon_1  0 \\\\ 0  \\varepsilon_2 \\end{pmatrix}$。\n- $O(g^1)$ 阶：$PgVP = 0$ 因为 $V_{PP}=0$。$P[gS_1, H_0]P = 0$ 因为 $[S_1, H_0]$ 是块非对角的。\n- $O(g^2)$ 阶：各项为 $P[gS_1, gV]P$ 和 $\\frac{1}{2}P[gS_1, [gS_1, H_0]]P$。\n$H_{\\mathrm{eff}}^{(2)} = g^2 \\left( P[S_1, V]P + \\frac{1}{2}P[S_1, [S_1, H_0]]P \\right)$\n\n我们计算 $P$ 空间中的两个对易子：\n$P[S_1, V]P = S_{1,PQ}V_{QP} - V_{PQ}S_{1,QP}$\n根据解耦条件，$[S_1, H_0]_{QP} = -V_{QP}$ 且 $[S_1, H_0]_{PQ} = -V_{PQ}$。\n$P[S_1, [S_1, H_0]]P = S_{1,PQ}[S_1, H_0]_{QP} - [S_1, H_0]_{PQ}S_{1,QP}$\n$= S_{1,PQ}(-V_{QP}) - (-V_{PQ})S_{1,QP} = -S_{1,PQ}V_{QP} + V_{PQ}S_{1,QP} = -P[S_1, V]P$。\n\n将此代回到 $H_{\\mathrm{eff}}^{(2)}$ 的表达式中：\n$H_{\\mathrm{eff}}^{(2)} = g^2 \\left( P[S_1, V]P - \\frac{1}{2}P[S_1, V]P \\right) = \\frac{g^2}{2} P[S_1, V]P = \\frac{g^2}{2}(S_{1,PQ}V_{QP} - V_{PQ}S_{1,QP})$。\n\n让我们计算这些矩阵。\n$S_{1,QP} = \\begin{pmatrix} s_1  s_2 \\end{pmatrix}$，$V_{QP} = \\begin{pmatrix} v_1  v_2 \\end{pmatrix}$。\n根据 $S_{PQ} = -S_{QP}^\\dagger$ 和实数值，我们有 $S_{1,PQ} = \\begin{pmatrix} -s_1 \\\\ -s_2 \\end{pmatrix}$。$V_{PQ} = \\begin{pmatrix} v_1 \\\\ v_2 \\end{pmatrix}$。\n$S_{1,PQ}V_{QP} = \\begin{pmatrix} -s_1 v_1  -s_1 v_2 \\\\ -s_2 v_1  -s_2 v_2 \\end{pmatrix}$\n$V_{PQ}S_{1,QP} = \\begin{pmatrix} v_1 s_1  v_1 s_2 \\\\ v_2 s_1  v_2 s_2 \\end{pmatrix}$\n$P[S_1, V]P = \\begin{pmatrix} -2s_1 v_1  -s_1 v_2 - v_1 s_2 \\\\ -s_2 v_1 - v_2 s_1  -2s_2 v_2 \\end{pmatrix}$\n\n所以，$H_{\\mathrm{eff}}^{(2)} = \\frac{g^2}{2} \\begin{pmatrix} -2s_1 v_1  -s_1 v_2 - v_1 s_2 \\\\ -s_2 v_1 - v_2 s_1  -2s_2 v_2 \\end{pmatrix} = -g^2 \\begin{pmatrix} s_1 v_1  \\frac{1}{2}(s_1 v_2 + v_1 s_2) \\\\ \\frac{1}{2}(s_2 v_1 + v_1 s_2)  s_2 v_2 \\end{pmatrix}$。\n代入 $s_i = \\frac{v_i}{\\varepsilon_q - \\varepsilon_i}$：\n$H_{\\mathrm{eff}}^{(2)} = -g^2 \\begin{pmatrix} \\frac{v_1^2}{\\varepsilon_q - \\varepsilon_1}  \\frac{1}{2}(\\frac{v_1v_2}{\\varepsilon_q - \\varepsilon_1} + \\frac{v_1v_2}{\\varepsilon_q - \\varepsilon_2}) \\\\ \\frac{1}{2}(\\frac{v_2v_1}{\\varepsilon_q - \\varepsilon_2} + \\frac{v_2v_1}{\\varepsilon_q - \\varepsilon_1})  \\frac{v_2^2}{\\varepsilon_q - \\varepsilon_2} \\end{pmatrix}$\n$= g^2 \\begin{pmatrix} \\frac{v_1^2}{\\varepsilon_1 - \\varepsilon_q}  \\frac{v_1v_2}{2}\\left(\\frac{1}{\\varepsilon_1 - \\varepsilon_q} + \\frac{1}{\\varepsilon_2 - \\varepsilon_q}\\right) \\\\ \\frac{v_1v_2}{2}\\left(\\frac{1}{\\varepsilon_1 - \\varepsilon_q} + \\frac{1}{\\varepsilon_2 - \\varepsilon_q}\\right)  \\frac{v_2^2}{\\varepsilon_2 - \\varepsilon_q} \\end{pmatrix}$\n\n到 $O(g^2)$ 阶的完整有效哈密顿量为 $H_{\\mathrm{eff}} = H_{0P} + H_{\\mathrm{eff}}^{(2)}$：\n$$\nH_{\\mathrm{eff}} = \\begin{pmatrix} \\varepsilon_1 + \\frac{g^2v_1^2}{\\varepsilon_1 - \\varepsilon_q}  \\frac{g^2v_1v_2}{2}\\left(\\frac{1}{\\varepsilon_1 - \\varepsilon_q} + \\frac{1}{\\varepsilon_2 - \\varepsilon_q}\\right) \\\\ \\frac{g^2v_1v_2}{2}\\left(\\frac{1}{\\varepsilon_1 - \\varepsilon_q} + \\frac{1}{\\varepsilon_2 - \\varepsilon_q}\\right)  \\varepsilon_2 + \\frac{g^2v_2^2}{\\varepsilon_2 - \\varepsilon_q} \\end{pmatrix}\n$$\n所得到的有效哈密顿量是厄米且不依赖于能量的，这与 OLS/SW 形式体系的预期一致。\n\n最后，我们计算有效哈密頓量的迹，即其对角元之和：\n$\\mathrm{Tr}(H_{\\mathrm{eff}}) = \\left( \\varepsilon_1 + \\frac{g^2v_1^2}{\\varepsilon_1 - \\varepsilon_q} \\right) + \\left( \\varepsilon_2 + \\frac{g^2v_2^2}{\\varepsilon_2 - \\varepsilon_q} \\right)$\n$\\mathrm{Tr}(H_{\\mathrm{eff}}) = \\varepsilon_1 + \\varepsilon_2 + g^2\\left(\\frac{v_1^2}{\\varepsilon_1 - \\varepsilon_q} + \\frac{v_2^2}{\\varepsilon_2 - \\varepsilon_q}\\right)$", "answer": "$$\n\\boxed{\\varepsilon_{1} + \\varepsilon_{2} + g^{2}\\left(\\frac{v_{1}^{2}}{\\varepsilon_{1} - \\varepsilon_{q}} + \\frac{v_{2}^{2}}{\\varepsilon_{2} - \\varepsilon_{q}}\\right)}\n$$", "id": "3557309"}, {"introduction": "除了考虑粒子-空穴激发外，有效相互作用的另一个重要来源是对基本核力的简化，特别是三体力。本练习探讨了一个前沿概念：如何通过正规排序方法，将一个三体哈密顿量在某个参考态（如闭壳层原子核）下的效应，吸收并表示为一个诱导的有效两体力。这个过程不仅揭示了有效相互作用对参考态的依赖性，也为从头计算方法与壳模型之间的联系提供了关键的理论桥梁。", "problem": "考虑一个针对 $^{16}\\mathrm{O}$ 闭壳层参考态外的两个中子的价空间壳模型哈密顿量。相对于由谐振子单粒子态构建的单一斯莱特行列式参考态，三核子相互作用被包含在正规序双体 (NO2B) 贡献的层次上。从一个通用三体哈密顿量的二次量子化形式出发，\n$$\n\\hat{V}_{3\\mathrm{N}}=\\frac{1}{36}\\sum_{a b c d e f} W_{a b c d e f}\\, a_{a}^{\\dagger} a_{b}^{\\dagger} a_{c}^{\\dagger} a_{f} a_{e} a_{d},\n$$\n其中 $W_{a b c d e f}$ 是在包含所有磁亚态的单粒子基中的完全反对称化三体矩阵元，而 $a_{a}^{\\dagger}$ 和 $a_{a}$ 分别是产生和湮灭算符。正规排序是相对于一个 $^{16}\\mathrm{O}$ 闭壳层参考态进行的，该参考态的特征是每个单粒子态 $i$ 的占据数为 $n_{i}$。假设如下：\n1. $^{16}\\mathrm{O}$ 参考态的芯态具有关联但均匀的有效占据数：对于八个已占据的质子单粒子态中的每一个，质子的占据数 $n_{i}^{(p)} = 0.985$；对于八个已占据的中子单粒子态中的每一个，中子的占据数 $n_{i}^{(n)} = 0.990$。\n2. 三核子相互作用是一种简单的、自旋-同位旋无关的接触相互作用，并且在这个离散基中，对三重态具有不依赖于状态的反对称化对角矩阵元。具体来说，对于 $sd$ 壳层中的任意两个不同价中子轨道 $a \\neq b$ 和任意已占据的芯单粒子态 $i$（不论同位旋），NO2B 收缩所需的唯一非零约化三体矩阵元满足\n$$\nW_{a b i\\, a b i} = C_{3},\n$$\n所有其他非此对角三重态形式的 $W_{a b c d e f}$ 均为零。取 $C_{3} = 0.030\\,\\text{MeV}$。\n3. 两个不同价中子轨道 $a \\neq b$ 之间的价空间单极双体矩阵元定义为双体相互作用的角动量质心，并且对于如上所述的中心的、不依赖于状态的 NO2B 约化，它与 $m$-方案中的对角矩阵元一致。\n\n仅使用相对于斯莱特行列式的正规排序基本定义和威克定理，导出由 $\\hat{V}_{3\\mathrm{N}}$ 产生的诱导正规序双体贡献，并计算 $sd$ 壳层中两个不同价中子 $a \\neq b$ 之间所产生的诱导单极矩阵元 $\\overline{V}^{(\\mathrm{ind})}_{a b}$。最终答案以 $\\text{MeV}$ 为单位表示，并四舍五入到三位有效数字。", "solution": "该问题要求计算核壳模型中的一个诱导双体单极矩阵元。这种诱导相互作用源于一个基本的三核子 (3N) 力，当它相对于一个关联参考态（在本例中为 $^{16}\\mathrm{O}$ 核心的模型）进行正规排序时产生。\n\n首先，我们从给定的二次量子化形式的三体哈密顿量 $\\hat{V}_{3\\mathrm{N}}$ 开始：\n$$\n\\hat{V}_{3\\mathrm{N}}=\\frac{1}{36}\\sum_{a b c d e f} W_{a b c d e f}\\, a_{a}^{\\dagger} a_{b}^{\\dagger} a_{c}^{\\dagger} a_{f} a_{e} a_{d}\n$$\n这里，$W_{a b c d e f}$ 是完全反对称化的三体矩阵元 $\\langle abc | V_{3N} | def \\rangle_A$，$a_p^{\\dagger}$ ($a_p$) 是单粒子态 $p$ 的费米子产生（湮灭）算符。\n\n正规排序过程将一个算符相对于参考态 $|\\Phi\\rangle$ 分解为包含不同数量未收缩算符的项。$\\hat{V}_{3\\mathrm{N}}$ 的正规序双体 (NO2B) 部分是包含一个收缩的项。收缩由威克定理定义，对于具有部分占据数 $n_i$ 的指定参考态，基本收缩为 $\\langle\\Phi|a_p^\\dagger a_q|\\Phi\\rangle = \\delta_{pq} n_p$。\n\n诱导的双体相互作用 $\\hat{V}^{(\\mathrm{ind})}_{2\\mathrm{B}}$ 正是 $\\hat{V}_{3\\mathrm{N}}$ 的这个 NO2B 分量。多体理论中的一个标准结果给出了这种诱导相互作用的矩阵元。对于价空间中的双粒子态 $|pq\\rangle$ 和 $|rs\\rangle$，诱导矩阵元 $V^{(\\mathrm{ind})}_{pqrs}$ 是通过对与每个芯核子的相互作用贡献求和得到的。对于芯态 $i$ 的有效占据数 $n_i$，其表达式为：\n$$\nV^{(\\mathrm{ind})}_{pqrs} = \\sum_{i \\in \\text{core}} n_i W_{pqi,rsi}\n$$\n其中求和遍及所定义核心内的所有单粒子态 $i$。\n\n问题要求计算两个不同价中子轨道 $a \\neq b$ 之间的单极矩阵元 $\\overline{V}^{(\\mathrm{ind})}_{ab}$。题目指明，对于所考虑的简化相互作用，该单极子与 $m$-方案中的对角矩阵元一致。因此，我们需要计算 $V^{(\\mathrm{ind})}_{abab}$：\n$$\n\\overline{V}^{(\\mathrm{ind})}_{ab} = V^{(\\mathrm{ind})}_{abab} = \\sum_{i \\in \\text{core}} n_i W_{abi,abi}\n$$\n\n接下来，我们必须确定芯态及其性质。核心是 $^{16}\\mathrm{O}$，它由质子和中子填满的 $1s_{1/2}$、$1p_{3/2}$ 和 $1p_{1/2}$ 壳层组成。角动量为 $j$ 的壳层的磁亚态数量为 $2j+1$。\n- 对于质子：$1s_{1/2}$（2个态）+ $1p_{3/2}$（4个态）+ $1p_{1/2}$（2个态）= 8个质子芯态。\n- 对于中子：$1s_{1/2}$（2个态）+ $1p_{3/2}$（4个态）+ $1p_{1/2}$（2个态）= 8个中子芯态。\n\n问题给出了这些芯态的有效占据数：\n- 对于8个质子芯态中的每一个，$n_i^{(p)} = 0.985$。\n- 对于8个中子芯态中的每一个，$n_i^{(n)} = 0.990$。\n\n对芯态的求和可以分解为对质子芯态的求和与对中子芯态的求和：\n$$\n\\overline{V}^{(\\mathrm{ind})}_{ab} = \\sum_{i \\in \\{p_{\\text{core}}\\}} n_i^{(p)} W_{abi,abi} + \\sum_{i \\in \\{n_{\\text{core}}\\}} n_i^{(n)} W_{abi,abi}\n$$\n\n问题进一步简化了三体矩阵元。对于任意两个不同的价中子轨道 $a \\neq b$ 和任意芯态 $i$（质子或中子），矩阵元是一个常数：\n$$\nW_{abi,abi} = C_3 = 0.030 \\, \\text{MeV}\n$$\n\n将此代入我们的单极子表达式中：\n$$\n\\overline{V}^{(\\mathrm{ind})}_{ab} = \\sum_{i \\in \\{p_{\\text{core}}\\}} n_i^{(p)} C_3 + \\sum_{i \\in \\{n_{\\text{core}}\\}} n_i^{(n)} C_3\n$$\n由于 $C_3$、$n_i^{(p)}$ 和 $n_i^{(n)}$ 在各自的求和中是常数，我们可以将它们提出来：\n$$\n\\overline{V}^{(\\mathrm{ind})}_{ab} = C_3 \\left( \\sum_{i \\in \\{p_{\\text{core}}\\}} n_i^{(p)} + \\sum_{i \\in \\{n_{\\text{core}}\\}} n_i^{(n)} \\right)\n$$\n求和是对每个核心分区中的状态数进行的：\n$$\n\\sum_{i \\in \\{p_{\\text{core}}\\}} n_i^{(p)} = (\\text{质子芯态数}) \\times n^{(p)} = 8 \\times 0.985\n$$\n$$\n\\sum_{i \\in \\{n_{\\text{core}}\\}} n_i^{(n)} = (\\text{中子芯态数}) \\times n^{(n)} = 8 \\times 0.990\n$$\n\n现在，我们进行数值计算：\n$$\n\\sum_{i \\in \\{p_{\\text{core}}\\}} n_i^{(p)} = 8 \\times 0.985 = 7.88\n$$\n$$\n\\sum_{i \\in \\{n_{\\text{core}}\\}} n_i^{(n)} = 8 \\times 0.990 = 7.92\n$$\n整个核心的总占据数之和为 $7.88 + 7.92 = 15.80$。\n\n最后，我们计算诱导的单极矩阵元：\n$$\n\\overline{V}^{(\\mathrm{ind})}_{ab} = C_3 \\times (15.80) = (0.030 \\, \\text{MeV}) \\times 15.80\n$$\n$$\n\\overline{V}^{(\\mathrm{ind})}_{ab} = 0.474 \\, \\text{MeV}\n$$\n问题要求答案四舍五入到三位有效数字。我们的结果 $0.474$ 已经满足这个精度要求。", "answer": "$$\n\\boxed{0.474}\n$$", "id": "3557353"}, {"introduction": "理论推导为有效相互作用提供了坚实的基础，但在实际应用中，许多最成功的相互作用是通过将其参数（即两体矩阵元）拟合实验数据来确定的。本计算练习模拟了这一唯象方法，要求您实现一个基于梯度下降的优化算法，来校准一组两体矩阵元，以再现目标能级。通过完成这个任务，您将亲身体验到如何连接理论模型与经验数据，这是计算核物理中一项至关重要的实践技能。", "problem": "你的任务是使用选定能级的有限差分敏感度，实现对一小组有效壳模型双体矩阵元（TBME）的基于梯度的校准，并评估在不同数值设置下的收敛行为。该校准在一个最小但具有物理意义的双轨道价空间模型中进行，其中两个相同的核子占据总角动量分别为 $j_1=\\tfrac{1}{2}$ 和 $j_2=\\tfrac{3}{2}$ 的两个单粒子轨道。此设置产生两个角动量块，$J=0$ 和 $J=2$，每个块都由一个耦合基中的小型哈密顿矩阵描述。能量和相互作用以兆电子伏特（MeV）为单位表示，所有最终数值答案都必须以 MeV 报告。\n\n基本基础与模型定义：\n- 从包含单体单粒子能量和双体相互作用的非相对论多体哈密顿量开始。在固定的价空间中，哈密顿量简化为组态相互作用问题。对于限制在 $\\{j_1,j_2\\}$ 空间中的两个相同核子，$J$-耦合的哈密顿量会针对每个总角动量 $J$ 分解为不同的块。\n- 对轨道 $j_1$ 和 $j_2$ 分别采用恒定的单粒子能量 $e_1$ 和 $e_2$。TBME 被视为 $J$-耦合的矩阵元，它们贡献于块哈密顿量的对角和非对角元素。\n\n耦合基哈密顿量：\n- 对于 $J=0$，使用耦合基 $\\{\\lvert (j_1^2) J=0 \\rangle, \\lvert (j_2^2) J=0 \\rangle\\}$。其 $2\\times 2$ 哈密顿量为\n$$\nH^{(J=0)} =\n\\begin{pmatrix}\n2 e_1 + V_{11}^{(0)}  V_{12}^{(0)} \\\\\nV_{12}^{(0)}  2 e_2 + V_{22}^{(0)}\n\\end{pmatrix}.\n$$\n- 对于 $J=2$，使用耦合基 $\\{\\lvert (j_2^2) J=2 \\rangle, \\lvert (j_1 j_2) J=2 \\rangle\\}$。其 $2\\times 2$ 哈密顿量为\n$$\nH^{(J=2)} =\n\\begin{pmatrix}\n2 e_2 + V_{22}^{(2)}  V_{x}^{(2)} \\\\\nV_{x}^{(2)}  e_1 + e_2 + V_{12}^{(2)}\n\\end{pmatrix}.\n$$\n这里要校准的参数是六个 TBME\n$$\n\\mathbf{p} = \\big( V_{11}^{(0)}, V_{22}^{(0)}, V_{12}^{(0)}, V_{22}^{(2)}, V_{12}^{(2)}, V_{x}^{(2)} \\big).\n$$\n\n可观测量与目标函数：\n- 对每个块，计算其本征值（能量）并按升序排序。将 $J=0$ 的两个本征值记为 $E_{0,1}$ 和 $E_{0,2}$，将 $J=2$ 的两个本征值记为 $E_{2,1}$ 和 $E_{2,2}$。可观测量的集合是有序列表 $\\{E_{0,1}, E_{0,2}, E_{2,1}, E_{2,2}\\}$，每个值的单位都是 MeV。\n- 将目标函数定义为相对于目标能量的残差平方的无权和，\n$$\nS(\\mathbf{p}) = \\sum_{i=1}^{4} \\big( E_i(\\mathbf{p}) - E_i^{\\text{target}} \\big)^2,\n$$\n其中 $E_i^{\\text{target}}$ 是以 MeV 为单位的固定目标能量。\n\n目标值与常数：\n- 使用 $e_1 = 0.0$ MeV 和 $e_2 = 2.0$ MeV。\n- 定义一个物理上合理的“真实”TBME 参数矢量（单位为 MeV），用于生成目标值：\n$$\n\\mathbf{p}_{\\text{true}} = (-1.2,\\,-0.5,\\,-0.25,\\,0.3,\\,-0.4,\\,-0.15).\n$$\n- 通过使用 $\\mathbf{p}_{\\text{true}}$ 对上述 $J=0$ 和 $J=2$ 块进行对角化，并在每个块内按升序排序，来生成 $E_i^{\\text{target}}$。\n\n优化方法：\n- 使用中心有限差分法计算 $S(\\mathbf{p})$ 相对于 $\\mathbf{p}$ 中每个参数的梯度。对于步长 $h0$，\n$$\n\\left[\\nabla S(\\mathbf{p})\\right]_k \\approx \\frac{S(\\mathbf{p} + h\\,\\mathbf{e}_k) - S(\\mathbf{p} - h\\,\\mathbf{e}_k)}{2h},\n$$\n其中 $\\mathbf{e}_k$ 是第 $k$ 个单位矢量。\n- 应用梯度下降法更新，\n$$\n\\mathbf{p}^{(n+1)} = \\mathbf{p}^{(n)} - \\alpha \\,\\nabla S(\\mathbf{p}^{(n)}),\n$$\n从初始猜测值开始\n$$\n\\mathbf{p}^{(0)} = (-0.5,\\,0.2,\\,0.0,\\,0.8,\\,0.0,\\,0.0) \\text{ MeV}.\n$$\n- 如果梯度的欧几里得范数低于容差 $||\\nabla S||_2 \\le \\tau_g$ 或目标函数的相对变化满足 $\\frac{|S^{(n+1)} - S^{(n)}|}{\\max(1, S^{(n)})} \\le \\tau_S$，则使用早停法，其中 $\\tau_g = 10^{-6}$ MeV 且 $\\tau_S = 10^{-12}$。\n\n物理单位：\n- 所有能量、TBME、残差和目标函数均以 MeV 计算。报告优化结束时四个能量相对于目标值的均方根偏差（RMSD），\n$$\n\\text{RMSD} = \\sqrt{\\frac{1}{4} \\sum_{i=1}^{4} \\big( E_i(\\mathbf{p}^{\\text{final}}) - E_i^{\\text{target}} \\big)^2} \\quad \\text{单位为 MeV}.\n$$\n\n测试套件：\n针对以下三个测试用例运行优化器，每个用例由学习率 $\\alpha$、有限差分步长 $h$ 和最大迭代次数 $N_{\\max}$ 指定：\n- 用例 A (理想路径): $\\alpha = 0.5$, $h = 10^{-4}$, $N_{\\max} = 60$。\n- 用例 B (边界，最小迭代): $\\alpha = 0.3$, $h = 10^{-6}$, $N_{\\max} = 1$。\n- 用例 C (边缘，粗略敏感度): $\\alpha = 0.5$, $h = 5\\times 10^{-3}$, $N_{\\max} = 60$。\n\n要求的最终输出格式：\n你的程序应生成单行输出，其中包含三个用例的均方根偏差（单位为 MeV），格式为方括号内以逗号分隔的列表（例如，“[rmsA,rmsB,rmsC]”）。不要打印任何其他文本。每个报告值必须是一个浮点数，表示该用例的 RMSD（单位为 MeV）。程序必须是自包含的，并且不能要求任何用户输入或外部文件。此问题不涉及角度单位。不涉及百分比；任何分数量必须表示为小数或分数，而不是百分比。", "solution": "该问题被评估为有效。它构成了一个适定、自包含且具有科学依据的计算核物理练习，特别是在有效壳模型相互作用的参数校准领域。所有需要的数据、定义、物理常数和算法规范都已提供，并且没有内部矛盾、事实错误或歧义。任务是实现一个标准的梯度下降优化算法，以将一组双体矩阵元（TBME）拟合到综合生成的目标能级上。\n\n求解过程如下：首先，我们形式化模型，包括定义哈密顿量和可观测量集。其次，我们使用提供的“真实”参数计算目标数据。第三，我们详细说明梯度下降算法，包括梯度近似和停止准则。最后，我们描述此算法的实现，以运行指定的测试用例并为每个用例计算所需的均方根偏差（RMSD）。\n\n模型空间由两个相同的核子组成，它们位于总角动量为 $j_1=\\frac{1}{2}$ 和 $j_2=\\frac{3}{2}$ 的两个单粒子轨道中。相应的单粒子能量是固定常数：$e_1 = 0.0$ MeV 和 $e_2 = 2.0$ MeV。相互作用由一组六个 TBME 描述，这些是待校准的参数。这些参数被收集在一个矢量 $\\mathbf{p}$ 中：\n$$\n\\mathbf{p} = \\big( V_{11}^{(0)}, V_{22}^{(0)}, V_{12}^{(0)}, V_{22}^{(2)}, V_{12}^{(2)}, V_{x}^{(2)} \\big).\n$$\n该问题在两个不耦合的角动量块 $J=0$ 和 $J=2$ 内求解。\n\n对于总角动量块 $J=0$，在基 $\\{\\lvert (j_1^2) J=0 \\rangle, \\lvert (j_2^2) J=0 \\rangle\\}$ 中的哈密顿矩阵为：\n$$\nH^{(J=0)}(\\mathbf{p}) =\n\\begin{pmatrix}\n2 e_1 + V_{11}^{(0)}  V_{12}^{(0)} \\\\\nV_{12}^{(0)}  2 e_2 + V_{22}^{(0)}\n\\end{pmatrix}.\n$$\n\n对于总角动量块 $J=2$，在基 $\\{\\lvert (j_2^2) J=2 \\rangle, \\lvert (j_1 j_2) J=2 \\rangle\\}$ 中的哈密顿矩阵为：\n$$\nH^{(J=2)}(\\mathbf{p}) =\n\\begin{pmatrix}\n2 e_2 + V_{22}^{(2)}  V_{x}^{(2)} \\\\\nV_{x}^{(2)}  e_1 + e_2 + V_{12}^{(2)}\n\\end{pmatrix}.\n$$\n\n可观测量是这些矩阵的四个本征值，在每个块内按升序排序，形成有序列表 $\\mathbf{E}(\\mathbf{p}) = \\{E_{0,1}, E_{0,2}, E_{2,1}, E_{2,2}\\}$。这些是通过对给定参数矢量 $\\mathbf{p}$ 的 $2 \\times 2$ 对称矩阵进行对角化来计算的。\n\n目标能量 $\\mathbf{E}^{\\text{target}} = \\{E_{0,1}^{\\text{target}}, E_{0,2}^{\\text{target}}, E_{2,1}^{\\text{target}}, E_{2,2}^{\\text{target}}\\}$，是通过使用“真实”参数矢量 $\\mathbf{p}_{\\text{true}} = (-1.2,\\,-0.5,\\,-0.25,\\,0.3,\\,-0.4,\\,-0.15)$ MeV 计算本征值生成的。\n使用 $e_1=0.0$ MeV 和 $e_2=2.0$ MeV， “真实”的哈密顿量为：\n$$\nH^{(J=0)}_{\\text{true}} = \\begin{pmatrix} 2(0.0) - 1.2  -0.25 \\\\ -0.25  2(2.0) - 0.5 \\end{pmatrix} = \\begin{pmatrix} -1.2  -0.25 \\\\ -0.25  3.5 \\end{pmatrix} \\text{ MeV}.\n$$\n$H^{(J=0)}_{\\text{true}}$ 的本征值为 $E_{0,1}^{\\text{target}} \\approx -1.21326$ MeV 和 $E_{0,2}^{\\text{target}} \\approx 3.51326$ MeV。\n$$\nH^{(J=2)}_{\\text{true}} = \\begin{pmatrix} 2(2.0) + 0.3  -0.15 \\\\ -0.15  0.0 + 2.0 - 0.4 \\end{pmatrix} = \\begin{pmatrix} 4.3  -0.15 \\\\ -0.15  1.6 \\end{pmatrix} \\text{ MeV}.\n$$\n$H^{(J=2)}_{\\text{true}}$ 的本征值为 $E_{2,1}^{\\text{target}} \\approx 1.59169$ MeV 和 $E_{2,2}^{\\text{target}} \\approx 4.30831$ MeV。\n完整的目标能量矢量为 $\\mathbf{E}^{\\text{target}} \\approx (-1.21326, 3.51326, 1.59169, 4.30831)$ MeV。\n\n校准通过最小化目标函数 $S(\\mathbf{p})$ 来执行，该函数定义为残差平方和：\n$$\nS(\\mathbf{p}) = \\sum_{i=1}^{4} \\big( E_i(\\mathbf{p}) - E_i^{\\text{target}} \\big)^2.\n$$\n最小化采用梯度下降算法。从初始猜测值 $\\mathbf{p}^{(0)} = (-0.5,\\,0.2,\\,0.0,\\,0.8,\\,0.0,\\,0.0)$ MeV 开始，参数通过迭代方式更新：\n$$\n\\mathbf{p}^{(n+1)} = \\mathbf{p}^{(n)} - \\alpha \\,\\nabla S(\\mathbf{p}^{(n)}),\n$$\n其中 $\\alpha$ 是学习率， $n$ 是迭代索引。梯度矢量 $\\nabla S(\\mathbf{p})$ 使用中心有限差分公式对每个分量 $k$ 进行数值近似：\n$$\n\\left[\\nabla S(\\mathbf{p})\\right]_k = \\frac{\\partial S}{\\partial p_k} \\approx \\frac{S(\\mathbf{p} + h\\,\\mathbf{e}_k) - S(\\mathbf{p} - h\\,\\mathbf{e}_k)}{2h},\n$$\n其中 $h$ 是有限差分步长，$\\mathbf{e}_k$ 是第 $k$ 个标准基矢量。\n\n如果达到最大迭代次数 $N_{\\max}$，或者满足以下早停条件之一，则迭代过程终止：\n1. 梯度的欧几里得范数低于某个容差：$||\\nabla S(\\mathbf{p}^{(n)})||_2 \\le \\tau_g$，其中 $\\tau_g = 10^{-6}$ MeV。\n2. 目标函数的相对变化足够小：$\\frac{|S(\\mathbf{p}^{(n+1)}) - S(\\mathbf{p}^{(n)})|}{\\max(1, S(\\mathbf{p}^{(n)}))} \\le \\tau_S$，其中 $\\tau_S = 10^{-12}$。\n\n在最终参数矢量 $\\mathbf{p}^{\\text{final}}$ 处终止时，拟合的质量由均方根偏差（RMSD）量化：\n$$\n\\text{RMSD} = \\sqrt{\\frac{1}{4} S(\\mathbf{p}^{\\text{final}})} = \\sqrt{\\frac{1}{4} \\sum_{i=1}^{4} \\big( E_i(\\mathbf{p}^{\\text{final}}) - E_i^{\\text{target}} \\big)^2}.\n$$\n\n该算法使用 `numpy` 库在 Python 中实现，用于高效的数组操作和矩阵对角化 (`numpy.linalg.eigh`)。创建一个函数用于计算任何给定参数矢量 $\\mathbf{p}$ 的能量本征值。另一个函数计算目标函数 $S(\\mathbf{p})$。梯度由一个函数计算，该函数通过扰动参数重复调用目标函数。主优化循环迭代梯度下降更新，同时检查停止条件。对指定的三个测试用例中的每一个都执行此过程，并计算和报告每个用例的最终 RMSD。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements the gradient-based calibration of effective shell-model TBME.\n    \"\"\"\n    # Define physical constants and model parameters\n    e1 = 0.0  # MeV\n    e2 = 2.0  # MeV\n    p_true = np.array([-1.2, -0.5, -0.25, 0.3, -0.4, -0.15])  # MeV\n    p0 = np.array([-0.5, 0.2, 0.0, 0.8, 0.0, 0.0])  # MeV\n\n    # Define optimization convergence criteria\n    tau_g = 1e-6  # MeV\n    tau_S = 1e-12\n\n    # Define the test cases from the problem statement\n    test_cases = [\n        # Case A: (alpha, h, N_max)\n        (0.5, 1e-4, 60),\n        # Case B: (alpha, h, N_max)\n        (0.3, 1e-6, 1),\n        # Case C: (alpha, h, N_max)\n        (0.5, 5e-3, 60),\n    ]\n\n    def calculate_energies(p, e1_val, e2_val):\n        \"\"\"\n        Calculates the 4 energy eigenvalues for a given parameter vector p.\n        The eigenvalues are returned as a sorted, concatenated list [E0,1, E0,2, E2,1, E2,2].\n        \"\"\"\n        # Unpack parameter vector p\n        v11_0, v22_0, v12_0, v22_2, v12_2, vx_2 = p\n\n        # Construct H for J=0\n        H0 = np.array([\n            [2 * e1_val + v11_0, v12_0],\n            [v12_0, 2 * e2_val + v22_0]\n        ])\n\n        # Construct H for J=2\n        H2 = np.array([\n            [2 * e2_val + v22_2, vx_2],\n            [vx_2, e1_val + e2_val + v12_2]\n        ])\n\n        # Diagonalize and get sorted eigenvalues (eigh does this by default)\n        eigvals0 = np.linalg.eigh(H0)[0]\n        eigvals2 = np.linalg.eigh(H2)[0]\n\n        return np.concatenate((eigvals0, eigvals2))\n\n    # Generate target energies using p_true\n    E_target = calculate_energies(p_true, e1, e2)\n\n    def calculate_objective(p, E_target_vals, e1_val, e2_val):\n        \"\"\"\n        Calculates the objective function S(p).\n        \"\"\"\n        E_p = calculate_energies(p, e1_val, e2_val)\n        residuals = E_p - E_target_vals\n        return np.sum(residuals**2)\n\n    def calculate_gradient(p, h, E_target_vals, e1_val, e2_val):\n        \"\"\"\n        Calculates the gradient of S(p) using central finite differences.\n        \"\"\"\n        grad = np.zeros_like(p)\n        for k in range(len(p)):\n            p_plus_h = p.copy()\n            p_plus_h[k] += h\n            p_minus_h = p.copy()\n            p_minus_h[k] -= h\n\n            S_plus = calculate_objective(p_plus_h, E_target_vals, e1_val, e2_val)\n            S_minus = calculate_objective(p_minus_h, E_target_vals, e1_val, e2_val)\n            \n            grad[k] = (S_plus - S_minus) / (2 * h)\n        return grad\n    \n    def run_optimization(alpha, h, N_max, p_initial, E_target_vals, e1_val, e2_val, tg, tS):\n        \"\"\"\n        Runs the gradient descent optimization for one test case.\n        \"\"\"\n        p = p_initial.copy()\n        \n        S_current = calculate_objective(p, E_target_vals, e1_val, e2_val)\n\n        for _ in range(N_max):\n            # Calculate gradient\n            grad = calculate_gradient(p, h, E_target_vals, e1_val, e2_val)\n            grad_norm = np.linalg.norm(grad)\n            \n            # Check gradient norm convergence\n            if grad_norm = tg:\n                break\n                \n            # Update parameters\n            p_next = p - alpha * grad\n            \n            # Calculate new objective value\n            S_next = calculate_objective(p_next, E_target_vals, e1_val, e2_val)\n\n            # Check objective function convergence\n            S_rel_change = abs(S_next - S_current) / max(1.0, S_current)\n            if S_rel_change = tS:\n                p = p_next\n                break\n\n            # Prepare for next iteration\n            p = p_next\n            S_current = S_next\n            \n        # Calculate final objective value and RMSD\n        S_final = calculate_objective(p, E_target_vals, e1_val, e2_val)\n        rmsd = np.sqrt(S_final / 4.0)\n        return rmsd\n\n    results = []\n    for case in test_cases:\n        alpha, h, N_max = case\n        rmsd = run_optimization(alpha, h, N_max, p0, E_target, e1, e2, tau_g, tau_S)\n        results.append(rmsd)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.12f}' for r in results)}]\")\n\nsolve()\n```", "id": "3557305"}]}