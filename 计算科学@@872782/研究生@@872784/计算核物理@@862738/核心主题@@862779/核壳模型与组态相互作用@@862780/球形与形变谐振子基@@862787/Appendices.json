{"hands_on_practices": [{"introduction": "Elliott的SU(3)模型建立了谐振子基与原子核形变之间强有力的联系。该模型的核心原理是，振子量子在不同方向上的特定分布对应一个唯一的SU(3)不可约表示（irrep），其性质反映了集体四极运动。这项实践 [@problem_id:3592151] 提供了一个具体的计算，将抽象的SU(3)标签 $(\\lambda, \\mu)$ 和Casimir本征值与物理上直观的四极形变联系起来，后者通过 $Q \\cdot Q$ 不变量来量化。", "problem": "在核壳层模型中使用的三维谐振子基下，各向同性哈密顿量具有一个三阶酉群（U(3)）对称性，其三阶特殊酉群（SU(3)）子代数通过反映四极集体性的不可约表示来组织多体态。在形变谐振子基中，一个各向异性场使得振子量子沿笛卡尔轴的分布产生偏向，相关的 U(3) 最高权重在排序为 $f_{1} \\ge f_{2} \\ge f_{3}$ 后，通过这个有序配分的差值来决定 Elliott SU(3) 不可约表示的标记。考虑在单个主壳层中，有 $N=14$ 个振子量子，分布为 $n_{x}=8$、$n_{y}=4$ 和 $n_{z}=2$，这与形变谐振子平均场中的长椭球形变相一致。\n\n从三维谐振子的对称性结构以及通过将 U(3) 约化为 SU(3) 获得的 SU(3) 标记的定义出发，确定有序配分 $(f_{1},f_{2},f_{3})$ 对应的 SU(3) 不可约表示 $(\\lambda,\\mu)$。然后使用二次 SU(3) Casimir 算符计算其对于此不可约表示的本征值。最后，使用标准的 Elliott SU(3) 归一化（其中二次 Casimir 算符关联了标量四极不变式 $Q \\cdot Q$ 和角动量不变式 $L \\cdot L$），为此不可约表示中 $L=0$ 的成员计算 $Q \\cdot Q$ 的本征值。报告 $Q \\cdot Q$ 的最终数值，不带单位。如果进行任何中间数值运算，请保持精确；无需四舍五入。你的推理应明确证明 SU(3) 标记是如何从形变谐振子分布中获得的，以及四极不变式如何作为壳模型中四极形变的指标与 Casimir 本征值相关联。最终答案必须是单个数字。", "solution": "该问题是有效的。它在核壳模型和 Elliott SU(3) 模型的既定框架内提出了一个适定问题。它具有科学依据，是客观的，并且包含获得唯一解所需的所有必要信息。\n\n解答按要求分三步进行：\n1.  确定 SU(3) 不可约表示 (irrep) $(\\lambda, \\mu)$。\n2.  计算此不可约表示的二次 SU(3) Casimir 算符的本征值。\n3.  为此不可约表示中的 $L=0$ 态计算标量四极不变式 $Q \\cdot Q$ 的本征值。\n\n**第1步：确定 SU(3) 不可约表示 $(\\lambda, \\mu)$**\n\n问题指定了沿笛卡尔轴的振子量子分布：$n_x=8$, $n_y=4$, and $n_z=2$。总振子量子数为 $N = n_x + n_y + n_z = 8 + 4 + 2 = 14$。此态对应于一个 U(3) 表示的最高权重态。为了找到相应的 SU(3) 不可约表示，我们首先通过将量子数按降序排列来构造有序配分 $[f_1, f_2, f_3]$。\n量子数的集合是 $\\{8, 4, 2\\}$。由于它们已经是降序排列，我们有：\n$$[f_1, f_2, f_3] = [8, 4, 2]$$\n根据 U(3) 到 SU(3) 的标准约化，SU(3) 不可约表示标记 $(\\lambda, \\mu)$ 由此有序配分相邻元素之差定义：\n$$ \\lambda = f_1 - f_2 $$\n$$ \\mu = f_2 - f_3 $$\n代入我们配分中的值：\n$$ \\lambda = 8 - 4 = 4 $$\n$$ \\mu = 4 - 2 = 2 $$\n因此，SU(3) 不可约表示为 $(\\lambda, \\mu) = (4, 2)$。$\\lambda > \\mu$ 这一事实与问题中关于长椭球型形变结构的描述是一致的。\n\n**第2步：计算二次 SU(3) Casimir 算符的本征值**\n\n对于一个不可约表示 $(\\lambda, \\mu)$，SU(3) 的二阶（二次）Casimir 算符的本征值，记为 $\\langle C_2 \\rangle$，是该表示总“大小”的度量。它由以下公式给出：\n$$ \\langle C_2 \\rangle = \\lambda^2 + \\mu^2 + \\lambda\\mu + 3(\\lambda + \\mu) $$\n代入已确定的值 $\\lambda=4$ 和 $\\mu=2$：\n$$ \\langle C_2 \\rangle = (4)^2 + (2)^2 + (4)(2) + 3(4 + 2) $$\n$$ \\langle C_2 \\rangle = 16 + 4 + 8 + 3(6) $$\n$$ \\langle C_2 \\rangle = 28 + 18 $$\n$$ \\langle C_2 \\rangle = 46 $$\n对于 $(4, 2)$ 不可约表示，二次 Casimir 算符的本征值为 $46$。\n\n**第3步：计算标量四极不变式 $Q \\cdot Q$ 的本征值**\n\n在 Elliott SU(3) 模型中，SU(3) 代数的生成元是角动量算符 $L$ 和代数四极算符 $Q$。二次 Casimir 算符可以表示为这些物理算符的标量不变式。如问题所述，其关系为：\n$$ C_2 = \\frac{1}{4} (Q \\cdot Q + 3L \\cdot L) $$\n这里，$L \\cdot L$ 等价于角动量平方算符 $L^2$，而 $Q \\cdot Q$ 是标量四极不变式。对于 $(\\lambda, \\mu)$ 不可约表示中具有确定角动量 $L$ 的态取期望值，我们得到：\n$$ \\langle C_2 \\rangle = \\frac{1}{4} (\\langle Q \\cdot Q \\rangle + 3\\langle L^2 \\rangle) $$\n$L^2$ 的本征值为 $L(L+1)$ (在 $\\hbar=1$ 的单位制下)。问题要求计算此不可约表示中 $L=0$ 成员的 $Q \\cdot Q$ 本征值。对于这样一个态：\n$$ \\langle L^2 \\rangle = 0(0+1) = 0 $$\n我们现在可以将已知本征值代入该关系式：\n$$ 46 = \\frac{1}{4} (\\langle Q \\cdot Q \\rangle + 3 \\times 0) $$\n$$ 46 = \\frac{1}{4} \\langle Q \\cdot Q \\rangle $$\n求解 $\\langle Q \\cdot Q \\rangle$：\n$$ \\langle Q \\cdot Q \\rangle = 4 \\times 46 $$\n$$ \\langle Q \\cdot Q \\rangle = 184 $$\n$(4,2)$ SU(3) 不可约表示中 $L=0$ 态的标量四极不变式 $Q \\cdot Q$ 的本征值为 $184$。这个较大的值是与该表示相关的强四极集体性和形变的定量度量。", "answer": "$$\n\\boxed{184}\n$$", "id": "3592151"}, {"introduction": "在多体计算中使用截断的谐振子基，不可避免地会破坏平移对称性，从而引入伪质心（COM）运动。我们可以对这种污染进行建模和量化，并使用像Lawson方法这样的技术来抑制它。通过一个动手编程任务 [@problem_id:3592157]，你将实现一个简化的二能级模型，观察形变如何引起质心混合，以及Lawson项如何有效地惩罚这些非物理激发。", "problem": "考虑一个包含 $A$ 个质量为 $m$ 的相同核子的系统，它们在计算核物理中使用的形变三维谐振子基中运动。质心（COM）坐标定义为 $ \\mathbf{R} = \\frac{1}{A} \\sum_{i=1}^{A} \\mathbf{r}_i $，质心动量定义为 $ \\mathbf{P} = \\sum_{i=1}^{A} \\mathbf{p}_i $。质心哈密顿量为\n$$\nH_{\\mathrm{COM}} = \\frac{\\mathbf{P}^2}{2 A m} + \\frac{1}{2} A m \\omega_0^2 \\mathbf{R}^2,\n$$\n其中 $\\omega_0$ 是与球形基相关联的参考谐振子频率。在一个质心处于其基态的完全因子化的多体本征态中，期望值满足 $ \\langle H_{\\mathrm{COM}} \\rangle = \\tfrac{3}{2}\\hbar\\omega_0 $。$ \\langle H_{\\mathrm{COM}} \\rangle - \\tfrac{3}{2}\\hbar\\omega_0 $ 偏离零的程度量化了该态中的质心污染程度。\n\n为抑制截断基中的质心污染，Lawson 方法通过添加一项 $ \\lambda H_{\\mathrm{COM}} $ 来修改多体哈密顿量，其中 $ \\lambda \\ge 0 $ 是一个无量纲系数。较大的 $ \\lambda $ 会惩罚伪质心激发。\n\n你必须在一个用于质心部分的最小二能级混合模型中量化质心因子化，该模型反映了使用由原子核四极形变参数 $ \\beta_2 $ 表征的形变谐振子基的情况。假设内禀核态是固定的，且唯一的污染来自于质心基态 $|0_{\\mathrm{COM}}\\rangle$ 和单量子激发的质心激发态 $|1_{\\mathrm{COM}}\\rangle$ 之间的混合。在基 $\\{ |0_{\\mathrm{COM}}\\rangle, |1_{\\mathrm{COM}}\\rangle \\}$ 中，将有效哈密顿量的质心块建模为\n$$\n\\mathbf{H}(\\lambda) =\n\\begin{pmatrix}\nE_0(\\lambda)  \\varepsilon(\\beta_2) \\\\\n\\varepsilon(\\beta_2)  E_1(\\lambda)\n\\end{pmatrix},\n$$\n其中\n$$\nE_0(\\lambda) = E_{\\mathrm{int}} + (1+\\lambda)\\,\\tfrac{3}{2}\\hbar\\omega_0,\\quad\nE_1(\\lambda) = E_{\\mathrm{int}} + (1+\\lambda)\\,\\tfrac{5}{2}\\hbar\\omega_0,\n$$\n其中 $E_{\\mathrm{int}}$ 是一个不影响质心期望值的恒定内禀能量，并且非对角混合与形变成线性关系，\n$$\n\\varepsilon(\\beta_2) = \\kappa\\,\\hbar\\omega_0\\,|\\beta_2|,\n$$\n其中 $ \\kappa $ 是一个固定的无量纲常数，代表了截断空间中由基引起的质心混合的强度。对于小形变，对 $|\\beta_2|$ 的线性依赖关系是一个物理上合理的近似。在整个问题中，使用 $ \\kappa = 0.3 $。Lawson 项仅通过因子 $(1+\\lambda)$ 修改对角质心能量。\n\n令 $ \\Delta(\\lambda) = E_1(\\lambda) - E_0(\\lambda) = (1+\\lambda)\\,\\hbar\\omega_0 $。对于 $ \\mathbf{H}(\\lambda) $ 的基态，用 $ p_1(\\beta_2,\\lambda) $ 表示占据 $ |1_{\\mathrm{COM}}\\rangle $ 的概率。在这个二能级模型中，污染度量为\n$$\n\\langle H_{\\mathrm{COM}} - \\tfrac{3}{2}\\hbar\\omega_0 \\rangle = \\hbar\\omega_0\\,p_1(\\beta_2,\\lambda).\n$$\n\n你的任务是：\n- 从第一性原理推导 $ p_1(\\beta_2,\\lambda) $，即 $2\\times 2$ 哈密顿量 $ \\mathbf{H}(\\lambda) $ 的较低能量本征向量的激发态占据概率。\n- 实现一个程序，对于给定的 $A$、$ \\beta_2 $ 和 $ \\lambda $，使用广泛应用的核物理估算式\n$$\n\\hbar\\omega_0 \\approx 41\\,A^{-1/3}\\ \\text{MeV},\n$$\n计算 $ \\hbar\\omega_0 $，然后以兆电子伏特（MeV）为单位计算 $ \\langle H_{\\mathrm{COM}} - \\tfrac{3}{2}\\hbar\\omega_0 \\rangle $。\n- 所有最终数值答案均以 MeV 表示，并四舍五入到六位小数。\n\n使用以下参数集 $ (A, \\beta_2, \\lambda) $ 的测试套件：\n1. $(16, 0.0, 0.0)$：球形基准，无 Lawson 项（理想情况；预期无污染）。\n2. $(16, 0.2, 0.0)$：中等长椭球形变，无 Lawson 项（测试形变引起的混合）。\n3. $(16, 0.2, 10.0)$：相同形变，强 Lawson 项（测试抑制效果）。\n4. $(56, 0.3, 30.0)$：较重原子核，显著形变和强 Lawson 项（测试 $A$ 依赖性和抑制效果）。\n5. $(4, 0.5, 0.0)$：轻原子核，大形变，无 Lawson 项（强混合趋势的边缘情况）。\n6. $(40, -0.25, 5.0)$：扁椭球形变（负 $ \\beta_2 $），中等 Lawson 项（测试符号处理）。\n7. $(100, 0.0, 100.0)$：超重原子核，球形，极强 Lawson 项（边界情况；预期无污染）。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的、以逗号分隔的结果列表，结果的顺序与上述测试用例相对应。例如，包含三个结果的输出应类似于 $[r_1,r_2,r_3]$，其中每个 $r_i$ 是一个以 MeV 为单位、保留六位小数的浮点数。不应打印任何其他文本。\n\n所有角度（如有）必须以弧度为单位；然而，此问题不涉及角度。所有能量必须以兆电子伏特（MeV）表示。该算法必须对任何现代编程语言的实现环境都有效，但你的最终答案必须按照其他地方的规定，提供一个完整、可运行的 Python 程序。", "solution": "该问题要求在形变谐振子基的二能级模型中计算质心（COM）污染能。这涉及到推导一个 $2 \\times 2$ 哈密顿量基态中的激发态概率，然后用它来计算一个能量值。\n\n首先，我们推导 $p_1(\\beta_2, \\lambda)$ 的表达式，即当系统的基态是模型哈密顿量 $\\mathbf{H}(\\lambda)$ 的一个本征态时，发现质心处于其第一激发态 $|1_{\\mathrm{COM}}\\rangle$ 的概率。\n\n在基 $\\{|0_{\\mathrm{COM}}\\rangle, |1_{\\mathrm{COM}}\\rangle\\}$ 中，哈密顿量由下式给出：\n$$\n\\mathbf{H}(\\lambda) =\n\\begin{pmatrix}\nE_0(\\lambda)  \\varepsilon(\\beta_2) \\\\\n\\varepsilon(\\beta_2)  E_1(\\lambda)\n\\end{pmatrix}\n$$\n该矩阵的本征值 $E$ 通过求解特征方程 $\\det(\\mathbf{H} - E\\mathbf{I}) = 0$ 来找到：\n$$\n(E_0(\\lambda) - E)(E_1(\\lambda) - E) - \\varepsilon(\\beta_2)^2 = 0\n$$\n两个本征值为：\n$$\nE_{\\pm} = \\frac{E_0(\\lambda) + E_1(\\lambda)}{2} \\pm \\frac{1}{2}\\sqrt{(E_1(\\lambda) - E_0(\\lambda))^2 + 4\\varepsilon(\\beta_2)^2}\n$$\n基态能量是较低的本征值，即 $E_{GS} = E_{-}$。让我们将未受扰动能态之间的能量差记为 $\\Delta(\\lambda) = E_1(\\lambda) - E_0(\\lambda)$，耦合项记为 $\\varepsilon = \\varepsilon(\\beta_2)$。基态能量为：\n$$\nE_{GS} = \\frac{E_0(\\lambda) + E_1(\\lambda)}{2} - \\frac{1}{2}\\sqrt{\\Delta(\\lambda)^2 + 4\\varepsilon^2}\n$$\n基态本征向量 $|\\psi_{GS}\\rangle = c_0 |0_{\\mathrm{COM}}\\rangle + c_1 |1_{\\mathrm{COM}}\\rangle$ 通过求解本征值方程 $\\mathbf{H}(\\lambda)|\\psi_{GS}\\rangle = E_{GS}|\\psi_{GS}\\rangle$ 得到。\n\n在基态中占据态 $|1_{\\mathrm{COM}}\\rangle$ 的概率为 $p_1 = |c_1|^2$。对于一个形式为 $\\begin{pmatrix} E_a  V \\\\ V  E_b \\end{pmatrix}$ 的一般 $2\\times 2$ 实对称哈密顿量，其基态（较低能量的本征态）中原始上能态 $|b\\rangle$ 的混合概率由下式给出：\n$$\np_b = \\sin^2\\theta = \\frac{1}{2} \\left( 1 - \\frac{E_b - E_a}{\\sqrt{(E_b - E_a)^2 + 4V^2}} \\right)\n$$\n在这里，我们的基矢为 $|a\\rangle \\equiv |0_{\\mathrm{COM}}\\rangle$ 和 $|b\\rangle \\equiv |1_{\\mathrm{COM}}\\rangle$。对应的能量为 $E_a = E_0(\\lambda)$ 和 $E_b = E_1(\\lambda)$，耦合项为 $V=\\varepsilon$。注意，未受扰动的基态是 $|0_{\\mathrm{COM}}\\rangle$，激发态是 $|1_{\\mathrm{COM}}\\rangle$。我们需要小心使用这个公式。基态主要由 $|0_{\\mathrm{COM}}\\rangle$ 构成，因此 $E_0  E_1$。设混合角 $\\theta$ 的定义使得基态本征态为 $|\\psi_{GS}\\rangle = \\cos\\theta |0_{\\mathrm{COM}}\\rangle - \\sin\\theta |1_{\\mathrm{COM}}\\rangle$。这是标准约定，当耦合为零时 $\\theta=0$。那么混合概率为 $p_1 = (-\\sin\\theta)^2 = \\sin^2\\theta$。混合角由 $\\tan(2\\theta) = \\frac{2\\varepsilon}{E_1-E_0} = \\frac{2\\varepsilon}{\\Delta}$ 给出。\n由此，我们得到 $\\cos(2\\theta) = \\frac{\\Delta}{\\sqrt{\\Delta^2 + (2\\varepsilon)^2}}$。\n使用半角恒等式 $\\sin^2\\theta = \\frac{1 - \\cos(2\\theta)}{2}$，我们得到概率 $p_1$：\n$$\np_1(\\beta_2, \\lambda) = \\frac{1}{2} \\left( 1 - \\frac{\\Delta(\\lambda)}{\\sqrt{\\Delta(\\lambda)^2 + (2\\varepsilon(\\beta_2))^2}} \\right)\n$$\n该公式是良定义的，因为 $\\lambda \\ge 0$，所以 $\\Delta(\\lambda) = (1+\\lambda)\\hbar\\omega_0 \\ge 0$。\n\n接下来，我们建立计算算法。对于每个参数集 $(A, \\beta_2, \\lambda)$：\n1.  使用提供的公式计算振子能量子 $\\hbar\\omega_0$：\n    $$\n    \\hbar\\omega_0 = 41\\,A^{-1/3}\\ \\text{MeV}\n    $$\n2.  如果形变参数 $\\beta_2 = 0$，则耦合项 $\\varepsilon(\\beta_2) = \\kappa\\,\\hbar\\omega_0\\,|0| = 0$。在这种情况下，哈密顿量已经是对角的，没有混合发生，$p_1(0, \\lambda)=0$。因此，污染能为 $0$。\n3.  如果 $\\beta_2 \\neq 0$，我们继续进行计算：\n    a. 计算未受扰动能隙 $\\Delta(\\lambda)$：\n    $$\n    \\Delta(\\lambda) = (1+\\lambda)\\,\\hbar\\omega_0\n    $$\n    b. 计算耦合项 $\\varepsilon(\\beta_2)$，其中 $\\kappa=0.3$：\n    $$\n    \\varepsilon(\\beta_2) = 0.3\\,\\hbar\\omega_0\\,|\\beta_2|\n    $$\n    c. 将这些值代入推导出的 $p_1(\\beta_2, \\lambda)$ 公式中：\n    $$\n    p_1 = \\frac{1}{2} \\left( 1 - \\frac{\\Delta(\\lambda)}{\\sqrt{\\Delta(\\lambda)^2 + 4\\varepsilon(\\beta_2)^2}} \\right)\n    $$\n    d. 污染能由问题陈述给出：\n    $$\n    \\langle H_{\\mathrm{COM}} - \\tfrac{3}{2}\\hbar\\omega_0 \\rangle = \\hbar\\omega_0\\,p_1(\\beta_2,\\lambda)\n    $$\n4.  每个测试用例的最终结果就是这个能量值，以 MeV 表示并四舍五入到六位小数。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the nuclear COM contamination problem for a suite of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple (A, beta2, lambda).\n    test_cases = [\n        (16, 0.0, 0.0),\n        (16, 0.2, 0.0),\n        (16, 0.2, 10.0),\n        (56, 0.3, 30.0),\n        (4, 0.5, 0.0),\n        (40, -0.25, 5.0),\n        (100, 0.0, 100.0),\n    ]\n\n    results = []\n    \n    # Dimensionless constant for basis-induced COM mixing strength\n    kappa = 0.3\n\n    for A, beta2, lambda_val in test_cases:\n        # Step 1: Calculate the harmonic oscillator energy quantum\n        # hbar*omega0 approx 41 * A^(-1/3) MeV\n        hw_val = 41.0 * A**(-1.0/3.0)\n\n        # Step 2: Handle the non-deformed case\n        # If beta2 is 0, the coupling epsilon is 0, so there's no mixing.\n        if beta2 == 0.0:\n            contamination_energy = 0.0\n        else:\n            # Step 3: Calculate parameters for the mixing formula for deformed cases\n            \n            # The energy difference between unperturbed COM states\n            Delta = (1.0 + lambda_val) * hw_val\n            \n            # The off-diagonal coupling term, proportional to deformation\n            epsilon = kappa * hw_val * abs(beta2)\n\n            # Step 4: Calculate the probability p1 of the excited COM state admixture\n            # in the ground state of the 2x2 Hamiltonian.\n            # p1 = 0.5 * (1 - Delta / sqrt(Delta^2 + (2*epsilon)^2))\n            denominator = np.sqrt(Delta**2 + 4.0 * epsilon**2)\n            p1 = 0.5 * (1.0 - Delta / denominator)\n\n            # Step 5: Calculate the final contamination energy\n            contamination_energy = hw_val * p1\n        \n        results.append(contamination_energy)\n\n    # Format the final output as a comma-separated list of numbers\n    # rounded to six decimal places, inside brackets.\n    output_str = \"[\" + \",\".join([f\"{res:.6f}\" for res in results]) + \"]\"\n    print(output_str)\n\nsolve()\n```", "id": "3592157"}, {"introduction": "对于关联系统，标准的谐振子基通常不是高效计算的最佳选择。自然轨道由单体密度矩阵推导而来，它提供了一个更紧凑且物理上更适应的基，其优越性可以通过冯·诺依曼熵和耦合簇（Coupled-Cluster）残差等指标来量化。这项高级计算实践 [@problem_id:922] 将指导你完成一个完整的工作流程，从求解BCS方程到构建自然轨道并评估其质量，展示了现代核结构理论中的一项关键技术。", "problem": "您的任务是评估在一个简化的核结构模型中，谐振子基的选择如何影响多体最优性的计算指标。从三维谐振子出发，考虑两类单粒子基：球形基（各向同性频率）和轴向形变基（各向异性频率但体积守恒）。对于一个由$N$个相同核子组成的系统，它们通过一个简化的对偶相互作用进行相互作用，您需要使用Bardeen–Cooper–Schrieffer (BCS) 框架构建一个关联参考态，以获得单体密度矩阵。将自然轨道定义为单体密度矩阵的本征矢，并比较两个基最优性指标：单体密度的冯·诺依曼熵，以及在零簇幅度下计算的耦合簇单双激发（CCSD）单激发残差的大小。\n\n基本基础和定义：\n- 三维谐振子的单体哈密顿量，其能量由沿各轴的振子频率决定。对于横向频率为$\\omega_{\\perp}$、纵向频率为$\\omega_{z}$的轴向形变振子，施加体积守恒条件$\\omega_{\\perp}^{2}\\,\\omega_{z} = \\omega^{3}$，其中$\\omega$是参考球形频率。对于非负整数$(n_{x},n_{y},n_{z})$，单粒子能量为$E_{n_{x}n_{y}n_{z}} = \\hbar\\big[\\omega_{\\perp}(n_{x}+n_{y}+1)+\\omega_{z}(n_{z}+\\tfrac{1}{2})\\big]$。\n- 在Bardeen–Cooper–Schrieffer (BCS) 近似中，对于一个对偶强度为$g0$的对偶哈密顿量，准粒子能量为$E_{i} = \\sqrt{(\\epsilon_{i}-\\mu)^{2}+\\Delta^{2}}$，占据数为$v_{i}^{2} = \\tfrac{1}{2}\\big(1 - (\\epsilon_{i}-\\mu)/E_{i}\\big)$，且$u_{i}^{2} = 1 - v_{i}^{2}$。能隙$\\Delta$和化学势$\\mu$满足粒子数方程$N = 2\\sum_{i} v_{i}^{2}$和能隙方程$\\Delta = g \\sum_{i} u_{i}v_{i} = g\\sum_{i}\\Delta/(2E_{i})$。\n- 单体密度矩阵$\\gamma$的本征值等于自然占据数（在BCS中对于正则基是$v_{i}^{2}$）。自然轨道是$\\gamma$的本征矢。单体密度的冯·诺依曼熵为$S(\\gamma) = -\\sum_{k}\\big[n_{k}\\ln n_{k} + (1-n_{k})\\ln(1-n_{k})\\big]$，其中$n_{k}\\in[0,1]$是$\\gamma$的本征值。将熵表示为无量纲数。\n- 在耦合簇单双激发（CCSD）中，零簇幅度下的单激发残差由占据和空穴子空间之间的非对角Fock矩阵元决定。对于由$N/2$个最低能量轨道（假设每个空间轨道因时间反演对偶而具有双重简并）构建的Hartree–Fock (HF) 行列式，定义占据指标集$\\{i\\}$和空穴指标集$\\{a\\}$。单激发残差范数近似为$R_{1} = \\sqrt{\\sum_{i\\in\\mathrm{occ}}\\sum_{a\\in\\mathrm{vir}}|f_{ai}|^{2}}$，其中$f$是在工作单粒子基中的Fock矩阵表示。此量在HF正则基中为零，并随基的失准而增加。使用此量作为CCSD单激发残差指标。将$R_{1}$以兆电子伏（MeV）表示。\n\n您的程序必须：\n1. 为球形和形变情况构建$M$个单粒子谐振子能量。对于球形情况，设置$\\omega_{z}=\\omega_{\\perp}=\\omega$；对于形变情况，通过$\\omega_{z}=\\omega(1+\\delta)$和$\\omega_{\\perp}=\\omega\\sqrt{\\omega/\\omega_{z}}$强制执行$\\omega_{\\perp}^{2}\\,\\omega_{z}=\\omega^{3}$，其中$\\delta$是形变参数。使用$\\hbar=1$并将所有能量以兆电子伏（MeV）表示。\n2. 给定$(\\epsilon_{i})$、$N$（偶数）和$g$（以MeV为单位），求解BCS方程以得到$(\\Delta,\\mu)$，从而获得正则基中的单体密度矩阵$\\gamma$。如果非线性求解器失败或收敛到$\\Delta\\approx 0$，则通过将$\\mu$设置在第$N/2$个和第$(N/2+1)$个能级之间来强制执行粒子数守恒，并使用$v_{i}^{2}=\\Theta(\\mu-\\epsilon_{i})$（其中$\\Theta$是亥维赛德阶跃函数），此时$S(\\gamma)=0$。\n3. 通过应用一个实正交旋转$U$来形成一个工作基，该旋转以指定的角度（以弧度为单位）混合选定的轨道对。在该基中，计算旋转后的密度矩阵$\\gamma' = U^{\\top}\\gamma\\,U$和旋转后的Fock矩阵$F' = U^{\\top}F\\,U$，其中$F=\\mathrm{diag}(\\epsilon_{i})$。\n4. 通过对角化$\\gamma'$来构建自然轨道基，得到一个正交变换$W$，使得$\\gamma_{\\mathrm{nat}} = W^{\\top}\\gamma' W$为对角阵。计算自然轨道基中的Fock矩阵，$F_{\\mathrm{nat}} = W^{\\top}F'W$。\n5. 将Hartree–Fock占据子空间定义为原始正则能量排序中$N/2$个最低能量轨道的张成空间，将其余部分定义为空穴子空间。在旋转工作基和自然轨道基中，计算CCSD单激发残差范数$R_{1}^{\\mathrm{rot}}$和$R_{1}^{\\mathrm{nat}}$，公式为$R_{1} = \\sqrt{\\sum_{i\\in\\mathrm{occ}}\\sum_{a\\in\\mathrm{vir}}|F_{ai}|^{2}}$，并计算比率$r = R_{1}^{\\mathrm{nat}}/(R_{1}^{\\mathrm{rot}}+\\varepsilon)$，其中固定$\\varepsilon=10^{-12}\\,\\mathrm{MeV}$以避免除以零。将$R_{1}$以兆电子伏（MeV）表示，$r$为无量纲。\n6. 使用自然对数，根据$\\gamma'$的本征值（与$\\gamma$的本征值相等）计算冯·诺依曼熵$S(\\gamma)$，将$0\\ln 0$项视为$0$。\n\n设计一个测试套件，探测不同方面：\n- 情况A（理想情况，球形基，工作基中有形变）：$M=8$，$\\omega=10\\,\\mathrm{MeV}$，$\\delta=0$，$N=8$，$g=1.0\\,\\mathrm{MeV}$，以及一个以$\\theta=0.3$弧度角混合轨道$(k=3,l=4)$的单次旋转。\n- 情况B（形变基能量）：$M=8$，$\\omega=10\\,\\mathrm{MeV}$，$\\delta=0.25$，$N=8$，$g=1.0\\,\\mathrm{MeV}$，旋转以$\\theta=0.4$弧度角混合$(k=2,l=3)$。\n- 情况C（边界情况，无旋转）：$M=8$，$\\omega=10\\,\\mathrm{MeV}$，$\\delta=0$，$N=8$，$g=1.0\\,\\mathrm{MeV}$，无旋转（单位矩阵$U$），这应得到$R_{1}^{\\mathrm{rot}}\\approx 0$和$r\\approx 0$。\n- 情况D（边缘情况，弱对偶极限）：$M=8$，$\\omega=10\\,\\mathrm{MeV}$，$\\delta=0.2$，$N=8$，$g=0.01\\,\\mathrm{MeV}$，旋转以$\\theta=0.6$弧度角混合$(k=2,l=5)$；熵应趋近于$0$。\n\n您的程序应产生一行输出，包含用方括号括起来的逗号分隔列表形式的结果。每个测试用例必须产生一个双元素列表$[S,r]$，其中$S$是冯·诺依曼熵（无量纲），$r$是残差比（无量纲）。最终输出必须是这些按案例排列的列表的单个列表，例如，$[[S_{A},r_{A}],[S_{B},r_{B}],[S_{C},r_{C}],[S_{D},r_{D}]]$。角度必须以弧度为单位，能量和$g$以兆电子伏（MeV）为单位，熵必须使用自然对数计算。计算中不要进行任何四舍五入；输出原始浮点值。[@problem_id:922]", "solution": "用户提供了一个理论核物理领域的计算问题，该问题表述清晰、科学基础扎实且内部逻辑一致。问题要求在简化的核子对偶模型中，实现并比较两种用于评估单粒子基最优性的度量——冯·诺依曼熵和一个耦合簇单双激发（CCSD）残差的代理指标。此问题被认为是有效的，下面提供了完整的解决方案。\n\n### 基于原理的算法设计\n\n该解决方案遵循一系列步骤构建，每一步都基于量子多体理论的基本原理，特别是应用于核结构领域。\n\n#### 1. 单粒子模型空间的构建\n\n任何核结构计算的基础都是单粒子基的选择。该问题使用了三维谐振子（HO），这是核平均场的一个基石模型。单粒子能量$\\epsilon_k$是单体HO哈密顿量的本征值。问题指定了一个轴对称的形变振子，其频率为$\\omega_{\\perp}$（横向）和$\\omega_{z}$（纵向）。对于量子数为$(n_x, n_y, n_z)$的态，其单粒子能量由以下公式给出：\n$$E_{n_{x}n_{y}n_{z}} = \\hbar\\big[\\omega_{\\perp}(n_{x}+n_{y}+1)+\\omega_{z}(n_{z}+\\tfrac{1}{2})\\big]$$\n按照题目要求，我们设置$\\hbar=1$。为了模拟核物质的不可压缩性，施加了体积守恒约束$\\omega_{\\perp}^{2}\\,\\omega_{z} = \\omega^{3}$，其中$\\omega$是参考球形振子的频率。形变由参数$\\delta$通过关系式$\\omega_{z}=\\omega(1+\\delta)$和$\\omega_{\\perp}=\\omega\\sqrt{\\omega/\\omega_{z}}$控制。当$\\delta=0$时，恢复为球形情况。\n\n为了构建大小为$M$的基，我们通过迭代非负整数量子数$(n_x, n_y, n_z)$来数值生成量子态，计算它们的能量，并对结果进行排序。为确保基的排序是确定性的，首先按能量升序对态进行排序，任何简并都通过随后对$n_z$、然后是$n_x$，最后是$n_y$进行排序来解决。这个排序列表中的前$M$个态构成了单粒子基$\\{\\epsilon_k\\}_{k=1}^M$。\n\n#### 2. 通过BCS理论引入对偶关联\n\n真实的原子核表现出超越简单平均场图像的关联。该问题采用了一个具有恒定强度$g$的简化对偶相互作用，并在Bardeen–Cooper–Schrieffer (BCS) 框架内处理。该模型描述了一个关联基态的形成，其中核子对在费米面附近的单粒子能级上发生散射。这个过程在非相互作用参考态之上产生了粒子-空穴激发的叠加，导致每个轨道$k$都具有分数占据数$v_k^2$。\n\nBCS方法的核心是求解一个关于化学势$\\mu$和对偶能隙$\\Delta$的耦合非线性方程组：\n1.  **粒子数方程**: $N = 2\\sum_{k=1}^{M} v_{k}^{2} = \\sum_{k=1}^{M} \\left(1 - \\frac{\\epsilon_{k}-\\mu}{E_{k}}\\right)$\n2.  **能隙方程**: $1 = \\frac{g}{2} \\sum_{k=1}^{M} \\frac{1}{E_{k}}$\n\n这里，$E_{k} = \\sqrt{(\\epsilon_{k}-\\mu)^{2}+\\Delta^{2}}$是准粒子能量。这些方程使用求根算法进行数值求解。得到的占据数$v_k^2$是这个正则基中单体密度矩阵$\\gamma$的本征值，即$\\gamma = \\mathrm{diag}(v_1^2, v_2^2, \\dots, v_M^2)$。\n\n如果对偶作用非常弱（$g \\to 0$）或求解器失败，系统将退化为一个非相互作用的Hartree-Fock (HF) 态。在此极限下，$\\Delta=0$，占据数变得确定：对于占据轨道（$\\epsilon_k  \\mu$），$v_k^2=1$；对于空穴轨道（$\\epsilon_k > \\mu$），$v_k^2=0$。通过将$\\mu$置于第$(N/2)$个和第$(N/2+1)$个能级之间来保证粒子数$N$守恒。\n\n#### 3. 基最优性指标\n\n中心任务是评估两个基最优性指标。\n\n**a. 冯·诺依曼熵：** 单体密度矩阵$\\gamma$的冯·诺依曼熵由下式给出：\n$$S(\\gamma) = -\\mathrm{Tr}(\\gamma \\ln \\gamma) = -\\sum_{k} n_{k}\\ln n_{k}$$\n对于费米子系统，其本征值$n_k$是占据概率，表达式为$S(\\gamma) = -\\sum_{k}\\big[n_{k}\\ln n_{k} + (1-n_{k})\\ln(1-n_{k})\\big]$。其中$0\\ln 0$项取为$0$。$\\gamma$的本征值$n_k$是自然占据数。一个纯态（如HF态）具有整数占据数（$0$或$1$），其熵为零。一个关联态（如BCS态）具有分数占据数，导致$S > 0$。更高的熵表示更强的关联或与单行列式描述的偏离更大。熵本身与表示$\\gamma$的基无关，因为它仅依赖于其本征值。\n\n**b. CCSD单激发残差：** 在耦合簇理论中，参考行列式（这里假设由最低的$N/2$个HO轨道构建）的质量至关重要。一个最优Hartree-Fock基的关键条件是Brillouin定理，该定理指出Fock矩阵没有连接占据轨道（$i, j, \\dots$）和空穴轨道（$a, b, \\dots$）的非对角元，即$f_{ai}=0$。在给定工作基中这些矩阵元的大小衡量了对该定理的违背程度，并表明该基与最优HF基的偏离有多远。问题将CCSD单激发残差指标定义为：\n$$R_{1} = \\sqrt{\\sum_{i\\in\\mathrm{occ}}\\sum_{a\\in\\mathrm{vir}}|f_{ai}|^{2}}$$\n占据空间固定为原始能量排序列表中的前$N/2$个轨道。较小的$R_1$意味着一个“更好”的基，因为它更接近于真实的自洽平均场解。\n\n#### 4. 计算工作流\n\n程序为每个测试用例执行以下步骤：\n1.  **生成正则基**：生成并排序初始的HO能量$\\{\\epsilon_k\\}$，定义正则基。此基中的Fock矩阵为$F = \\mathrm{diag}(\\epsilon_k)$。\n2.  **求解BCS**：求解BCS方程以找到占据数$\\{v_k^2\\}$，定义正则密度矩阵$\\gamma = \\mathrm{diag}(v_k^2)$。\n3.  **旋转基**：通过对正则基应用指定的正交旋转$U$来创建一个“工作基”。在这个新基中，矩阵为$F' = U^{\\top}F U$和$\\gamma' = U^{\\top}\\gamma U$。\n4.  **寻找自然轨道基**：对旋转后的密度矩阵$\\gamma'$进行对角化：$\\gamma_{\\mathrm{nat}} = W^{\\top}\\gamma' W = \\mathrm{diag}(n_k)$。$W$的列定义了从工作基到自然轨道（NO）基的变换。然后将Fock矩阵变换到NO基：$F_{\\mathrm{nat}} = W^{\\top}F'W$。\n5.  **计算度量指标**：\n    *   从$\\gamma'$的本征值（自然占据数$n_k$）计算熵$S(\\gamma)$。\n    *   使用$F'$的占据-空穴非对角块计算残差$R_1^{\\mathrm{rot}}$。\n    *   使用$F_{\\mathrm{nat}}$的占据-空穴非对角块计算残差$R_1^{\\mathrm{nat}}$。\n    *   计算比率$r = R_{1}^{\\mathrm{nat}}/(R_{1}^{\\mathrm{rot}}+\\varepsilon)$，以比较自然轨道基相对于任意旋转的工作基的“质量”。$r  1$的值表明NO基是比旋转基更好的最优HF基近似。\n这个过程允许定量比较不同的基选择（简单旋转与物理上更合理的自然轨道）如何影响与高级多体计算相关的度量。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import root\n\ndef generate_ho_energies(M, omega, delta):\n    \"\"\"\n    Generates the first M single-particle energies for a 3D anisotropic HO.\n\n    Args:\n        M (int): Number of energy levels to generate.\n        omega (float): Reference spherical HO frequency in MeV.\n        delta (float): Axial deformation parameter.\n\n    Returns:\n        np.ndarray: Array of the M lowest single-particle energies in MeV.\n    \"\"\"\n    if 1 + delta = 0:\n        raise ValueError(\"Deformation delta must be > -1 to ensure positive w_z.\")\n    w_z = omega * (1 + delta)\n    w_perp = omega * np.sqrt(omega / w_z)\n\n    # Generate a pool of states to sort from. max_q should be large enough\n    # to guarantee at least M states are found.\n    max_q = int(M**(1./3.)) + 3\n    states = []\n    for nz in range(max_q):\n        for nx in range(max_q):\n            for ny in range(max_q):\n                energy = w_perp * (nx + ny + 1.0) + w_z * (nz + 0.5)\n                # Store quantum numbers for stable, deterministic sorting to break degeneracies\n                states.append({'E': energy, 'nx': nx, 'ny': ny, 'nz': nz})\n\n    # Sort by Energy, then nz, nx, ny to resolve degeneracies consistently.\n    states.sort(key=lambda s: (s['E'], s['nz'], s['nx'], s['ny']))\n    \n    energies = [s['E'] for s in states[:M]]\n    return np.array(energies)\n\ndef solve_bcs(energies, N, g):\n    \"\"\"\n    Solves the BCS equations for mu and delta to find occupation numbers.\n\n    Args:\n        energies (np.ndarray): Single-particle energy levels.\n        N (int): Number of nucleons.\n        g (float): Pairing strength in MeV.\n\n    Returns:\n        np.ndarray: Occupation numbers v_k^2.\n    \"\"\"\n    # The problem specifies this fallback for weak pairing, which we handle\n    # as a special case for robustness and to match the test case D logic.\n    if g  1e-4:\n        v_sq = np.zeros_like(energies)\n        v_sq[:N // 2] = 1.0\n        return v_sq\n\n    def bcs_equations(x, eps, N_part, g_strength):\n        mu, delta = x\n        # Ensure delta is positive for the square root\n        delta = max(1e-12, delta)\n        E_qp = np.sqrt((eps - mu)**2 + delta**2)\n        \n        # Avoid division by zero if E_qp is ever zero (should not happen with delta > 0)\n        E_qp[E_qp == 0] = 1e-12\n\n        # Residual for the number equation\n        v_sq_calc = 0.5 * (1.0 - (eps - mu) / E_qp)\n        num_eq_res = N_part - 2.0 * np.sum(v_sq_calc)\n\n        # Residual for the gap equation\n        gap_eq_res = 1.0 - (g_strength / 2.0) * np.sum(1.0 / E_qp)\n        \n        return [num_eq_res, gap_eq_res]\n\n    # Initial guess for the solver\n    mu0 = (energies[N // 2 - 1] + energies[N // 2]) / 2.0\n    delta0 = g\n    \n    sol = root(bcs_equations, [mu0, delta0], args=(energies, N, g), method='hybr')\n\n    if sol.success and sol.x[1] > 1e-6:\n        mu, delta = sol.x\n        E = np.sqrt((energies - mu)**2 + delta**2)\n        v_sq = 0.5 * (1.0 - (energies - mu) / E)\n    else:\n        # Fallback to HF-like sharp occupations if solver fails or finds trivial solution\n        v_sq = np.zeros_like(energies)\n        v_sq[:N // 2] = 1.0\n        \n    return v_sq\n\ndef calculate_entropy(n_k):\n    \"\"\"\n    Calculates the von Neumann entropy for a set of occupation numbers.\n    \"\"\"\n    # Clip to avoid numerical issues with log\n    n_k = np.clip(n_k, 0, 1)\n    \n    # Use masks to handle log(0) cases, as n*log(n) -> 0 for n->0\n    term1 = np.zeros_like(n_k)\n    mask1 = n_k > 0\n    term1[mask1] = n_k[mask1] * np.log(n_k[mask1])\n\n    term2 = np.zeros_like(n_k)\n    mask2 = (1.0 - n_k) > 0\n    term2[mask2] = (1.0 - n_k)[mask2] * np.log(1.0 - n_k)[mask2]\n\n    return -np.sum(term1 + term2)\n\ndef run_case(M, omega, delta, N, g, rotation_spec):\n    \"\"\"\n    Runs a single test case for the problem.\n    \"\"\"\n    # 1. Construct single-particle energies\n    energies = generate_ho_energies(M, omega, delta)\n\n    # 2. Solve BCS equations for occupations\n    v_sq = solve_bcs(energies, N, g)\n    \n    gamma_canonical = np.diag(v_sq)\n    F_canonical = np.diag(energies)\n\n    # 3. Form the rotation matrix U\n    U = np.identity(M)\n    if rotation_spec:\n        k, l, theta = rotation_spec\n        # The problem states k, l which are commonly 1-based in physics, convert to 0-based index\n        k_idx, l_idx = k - 1, l - 1\n        c, s = np.cos(theta), np.sin(theta)\n        U[k_idx, k_idx] = c\n        U[l_idx, l_idx] = c\n        U[k_idx, l_idx] = -s\n        U[l_idx, k_idx] = s\n\n    # 4. Compute matrices in the rotated working basis\n    gamma_rot = U.T @ gamma_canonical @ U\n    F_rot = U.T @ F_canonical @ U\n\n    # 5. Find natural orbital basis and transform the Fock matrix\n    nat_occ, W = np.linalg.eigh(gamma_rot)\n    F_nat = W.T @ F_rot @ W\n\n    # 6. Compute CCSD singles residual proxy for both bases\n    occ_indices = range(N // 2)\n    vir_indices = range(N // 2, M)\n    epsilon = 1e-12\n\n    # Residual in rotated basis\n    F_rot_sub = F_rot[np.ix_(vir_indices, occ_indices)]\n    R1_rot = np.sqrt(np.sum(F_rot_sub**2))\n    \n    # Residual in natural orbital basis\n    F_nat_sub = F_nat[np.ix_(vir_indices, occ_indices)]\n    R1_nat = np.sqrt(np.sum(F_nat_sub**2))\n\n    ratio_r = R1_nat / (R1_rot + epsilon)\n\n    # 7. Compute von Neumann entropy\n    # The eigenvalues of the density matrix are invariant under unitary transform\n    entropy_S = calculate_entropy(nat_occ)\n\n    return [entropy_S, ratio_r]\n\n\ndef solve():\n    # Define test cases as per the problem statement\n    # Format: (M, omega, delta, N, g, rotation_spec)\n    # rotation_spec: (k, l, theta) or None. k,l are 1-based.\n    test_cases = [\n        (8, 10.0, 0.0, 8, 1.0, (3, 4, 0.3)),     # Case A\n        (8, 10.0, 0.25, 8, 1.0, (2, 3, 0.4)),    # Case B\n        (8, 10.0, 0.0, 8, 1.0, None),            # Case C\n        (8, 10.0, 0.2, 8, 0.01, (2, 5, 0.6))     # Case D\n    ]\n\n    results = []\n    for case in test_cases:\n        result = run_case(*case)\n        results.append(result)\n\n    # Format the output as a string representing a list of lists.\n    output_str = f\"[{','.join(str(res) for res in results)}]\"\n    print(output_str)\n\nsolve()\n```", "id": "3592118"}]}