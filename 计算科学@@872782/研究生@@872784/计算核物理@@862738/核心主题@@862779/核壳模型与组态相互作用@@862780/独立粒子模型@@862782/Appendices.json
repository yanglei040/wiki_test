{"hands_on_practices": [{"introduction": "独立粒子模型的核心突破之一是引入了强自旋-轨道耦合项，这对于解释原子核的幻数至关重要。本练习将引导你通过第一性原理推导自旋-轨道算符 $\\mathbf{l}\\cdot\\mathbf{s}$ 的期望值，这是理解该相互作用如何导致能级分裂和壳层结构重排的解析基础。通过这个基础计算[@problem_id:3602406]，你将掌握将角动量耦合规则应用于微扰理论的关键技能。", "problem": "考虑一个在原子核的独立粒子模型中，在球对称平均场中运动的单个核子。非相对论哈密顿量可视为一个中心部分和一个自旋-轨道相互作用部分之和，\n$$\nH \\;=\\; T \\,+\\, U(r) \\,+\\, H_{ls},\n$$\n其中 $T$ 是动能算符，$U(r)$ 是中心势，以及\n$$\nH_{ls} \\;=\\; W_{ls}(r)\\,\\mathbf{l}\\cdot\\mathbf{s}\n$$\n是自旋-轨道相互作用，其中 $W_{ls}(r)$ 是 $r$ 的标量函数。假设核子的内禀自旋为 $s=\\tfrac{1}{2}$，并且对于一个由 $(n,l,j)$ 标记的束缚单粒子本征态，$H_{ls}$ 可以用一级微扰理论处理，其中 $n$ 是主量子数，$l$ 是轨道角动量，$j$ 是由耦合 $\\mathbf{j}=\\mathbf{l}+\\mathbf{s}$ 产生的总角动量。\n\n从角动量相加规则和 $\\mathbf{j}^2$ 的定义出发，推导在单粒子态 $(n,l,j)$ 中期望值 $\\langle \\mathbf{l}\\cdot\\mathbf{s}\\rangle$ 的通用表达式。然后，利用一级微扰理论，用 $\\langle W_{ls}(r)\\rangle_{nl}$ 和 $\\langle \\mathbf{l}\\cdot\\mathbf{s}\\rangle$ 表示自旋-轨道能量移动 $\\Delta E_{j}$，其中\n$$\n\\langle W_{ls}(r)\\rangle_{nl} \\;\\equiv\\; \\int_{0}^{\\infty} |R_{nl}(r)|^{2}\\,W_{ls}(r)\\,r^{2}\\,\\mathrm{d}r\n$$\n是具有径向波函数 $R_{nl}(r)$ 的 $(n,l)$ 态的径向期望值。\n\n现在考虑一个质量数为 $A=40$ 的原子核中处于 $(n=2,l=3)$ 态的中子，对其径向期望值的数值计算给出 $\\langle W_{ls}(r)\\rangle_{nl} = C_{nl} = 0.9$ $\\mathrm{MeV}$。使用你推导的 $\\langle \\mathbf{l}\\cdot\\mathbf{s}\\rangle$ 表达式来估算自旋-轨道能量分裂\n$$\n\\Delta E_{\\mathrm{so}} \\;\\equiv\\; E_{j=l+\\tfrac{1}{2}} \\;-\\; E_{j=l-\\tfrac{1}{2}}\n$$\n对于这个 $(n,l)$ 组态。以 $\\mathrm{MeV}$ 为单位给出 $\\Delta E_{\\mathrm{so}}$ 的最终数值。无需四舍五入；报告由给定数据所隐含的精确值。", "solution": "根据验证标准评估问题陈述。\n\n### 步骤1：提取已知条件\n- **哈密顿量：** $H = T + U(r) + H_{ls}$\n- **动能算符：** $T$\n- **中心势：** $U(r)$\n- **自旋-轨道相互作用：** $H_{ls} = W_{ls}(r)\\,\\mathbf{l}\\cdot\\mathbf{s}$，其中 $W_{ls}(r)$ 是 $r$ 的标量函数。\n- **核子内禀自旋：** $s=\\frac{1}{2}$\n- **微扰：** $H_{ls}$ 通过一级微扰理论处理。\n- **单粒子态：** 由 $(n,l,j)$ 标记，其中 $n$ 是主量子数，$l$ 是轨道角动量，$j$ 是总角动量。\n- **总角动量：** $\\mathbf{j}=\\mathbf{l}+\\mathbf{s}$\n- **径向期望值的定义：** $\\langle W_{ls}(r)\\rangle_{nl} \\equiv \\int_{0}^{\\infty} |R_{nl}(r)|^{2}\\,W_{ls}(r)\\,r^{2}\\,\\mathrm{d}r$，其中 $R_{nl}(r)$ 是径向波函数。\n- **特定情况：** 处于 $(n=2,l=3)$ 态的中子。\n- **原子核质量数：** $A=40$。\n- **给定数值：** 对于指定的状态，$\\langle W_{ls}(r)\\rangle_{nl} = C_{nl} = 0.9$ $\\mathrm{MeV}$。\n- **目标量：** 自旋-轨道能量分裂 $\\Delta E_{\\mathrm{so}} \\equiv E_{j=l+\\tfrac{1}{2}} - E_{j=l-\\tfrac{1}{2}}$。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题是核壳层模型理论中的一个标准练习，属于计算核物理学的一个子领域。\n- **科学依据：** 哈密顿量的形式，包括中心势和自旋-轨道耦合项，是核独立粒子模型（壳层模型）的基石。所提出的方法，即一级微扰理论，是计算能量移动的标准量子力学技术。所有概念都基于已建立的量子力学和核物理学原理。\n- **问题明确：** 问题提供了推导所需表达式和计算最终数值所需的所有必要信息。它要求基于所提供的数据和标准物理定律计算一个特定的、可计算的量。在模型的背景下，解是唯一的且有意义的。\n- **客观性：** 问题使用精确、标准的科学术语陈述。没有主观或含糊不清的陈述。\n- **无其他缺陷：** 问题是自洽的，其前提是合理的，不涉及任何逻辑矛盾或不切实际的物理情况。$\\langle W_{ls}(r)\\rangle_{nl}$ 的值在物理上是合理的。\n\n### 步骤3：结论与行动\n问题是**有效的**。将提供解答。\n\n解答分三步进行。首先，我们推导期望值 $\\langle \\mathbf{l}\\cdot\\mathbf{s}\\rangle$ 的通用表达式。其次，我们在 一级微扰理论中使用此结果来找到能量分裂 $\\Delta E_{\\mathrm{so}}$。第三，我们计算给定情况的数值。\n\n总角动量算符 $\\mathbf{j}$ 是轨道角动量算符 $\\mathbf{l}$ 和自旋角动量算符 $\\mathbf{s}$ 的和：\n$$\n\\mathbf{j} = \\mathbf{l} + \\mathbf{s}\n$$\n对该算符求平方可得：\n$$\n\\mathbf{j}^2 = (\\mathbf{l} + \\mathbf{s}) \\cdot (\\mathbf{l} + \\mathbf{s}) = \\mathbf{l}^2 + \\mathbf{s}^2 + 2\\,\\mathbf{l}\\cdot\\mathbf{s}\n$$\n我们可以重新排列这个方程，用角动量平方算符来表示自旋-轨道耦合算符 $\\mathbf{l}\\cdot\\mathbf{s}$：\n$$\n\\mathbf{l}\\cdot\\mathbf{s} = \\frac{1}{2} (\\mathbf{j}^2 - \\mathbf{l}^2 - \\mathbf{s}^2)\n$$\n单粒子态，记作 $|n, l, j, m_j\\rangle$，是算符 $\\mathbf{j}^2$、$\\mathbf{l}^2$ 和 $\\mathbf{s}^2$ 的共同本征态。这些算符的本征值由以下公式给出：\n- $\\mathbf{j}^2 |n, l, j, m_j\\rangle = j(j+1)\\hbar^2 |n, l, j, m_j\\rangle$\n- $\\mathbf{l}^2 |n, l, j, m_j\\rangle = l(l+1)\\hbar^2 |n, l, j, m_j\\rangle$\n- $\\mathbf{s}^2 |n, l, j, m_j\\rangle = s(s+1)\\hbar^2 |n, l, j, m_j\\rangle$\n\n在核物理学中，习惯上使用无量纲的角动量算符，其中 $\\mathbf{L} = \\mathbf{l}\\hbar$ 和 $\\mathbf{S} = \\mathbf{s}\\hbar$。哈密顿量中的算符是 $\\mathbf{l}\\cdot\\mathbf{s}$，它被视为一个无量纲的量。因此，该算符的期望值可以通过用其对应的本征值替换算符来求得，且不带 $\\hbar^2$ 因子。\n$$\n\\langle \\mathbf{l}\\cdot\\mathbf{s}\\rangle = \\langle n, l, j, m_j | \\frac{1}{2} (\\mathbf{j}^2 - \\mathbf{l}^2 - \\mathbf{s}^2) | n, l, j, m_j \\rangle = \\frac{1}{2} [j(j+1) - l(l+1) - s(s+1)]\n$$\n对于核子，自旋为 $s=\\frac{1}{2}$，所以 $s(s+1) = \\frac{1}{2}(\\frac{1}{2}+1) = \\frac{3}{4}$。表达式变为：\n$$\n\\langle \\mathbf{l}\\cdot\\mathbf{s}\\rangle = \\frac{1}{2} \\left[ j(j+1) - l(l+1) - \\frac{3}{4} \\right]\n$$\n对于给定的 $l > 0$，总角动量量子数 $j$ 可以取两个可能的值：$j=l+\\frac{1}{2}$ 和 $j=l-\\frac{1}{2}$。\n- 对于 $j = l+\\frac{1}{2}$：\n$$\n\\langle \\mathbf{l}\\cdot\\mathbf{s}\\rangle_{j=l+1/2} = \\frac{1}{2} \\left[ \\left(l+\\frac{1}{2}\\right)\\left(l+\\frac{3}{2}\\right) - l(l+1) - \\frac{3}{4} \\right] = \\frac{1}{2} \\left[ \\left(l^2 + 2l + \\frac{3}{4}\\right) - (l^2+l) - \\frac{3}{4} \\right] = \\frac{1}{2}l\n$$\n- 对于 $j = l-\\frac{1}{2}$：\n$$\n\\langle \\mathbf{l}\\cdot\\mathbf{s}\\rangle_{j=l-1/2} = \\frac{1}{2} \\left[ \\left(l-\\frac{1}{2}\\right)\\left(l+\\frac{1}{2}\\right) - l(l+1) - \\frac{3}{4} \\right] = \\frac{1}{2} \\left[ \\left(l^2 - \\frac{1}{4}\\right) - (l^2+l) - \\frac{3}{4} \\right] = \\frac{1}{2}(-l-1) = -\\frac{l+1}{2}\n$$\n\n接下来，我们应用一级微扰理论来求解由自旋-轨道相互作用 $H_{ls} = W_{ls}(r)\\mathbf{l}\\cdot\\mathbf{s}$ 引起的能量移动 $\\Delta E_j$。能量移动是微扰在未受扰动态 $|n,l,j,m_j\\rangle$ 中的期望值。\n$$\n\\Delta E_j = \\langle n,l,j,m_j | W_{ls}(r)\\mathbf{l}\\cdot\\mathbf{s} | n,l,j,m_j \\rangle\n$$\n由于算符 $W_{ls}(r)$ 只作用于波函数的径向部分，而 $\\mathbf{l}\\cdot\\mathbf{s}$ 只作用于自旋-角动量部分，因此期望值可以分离为径向期望值和自旋-角动量期望值的乘积。\n$$\n\\Delta E_j = \\left( \\int_{0}^{\\infty} |R_{nl}(r)|^{2}\\,W_{ls}(r)\\,r^{2}\\,\\mathrm{d}r \\right) \\cdot \\langle \\mathbf{l}\\cdot\\mathbf{s} \\rangle_{lj}\n$$\n使用问题陈述中的符号，这可以写成：\n$$\n\\Delta E_j = \\langle W_{ls}(r)\\rangle_{nl} \\langle \\mathbf{l}\\cdot\\mathbf{s}\\rangle_{lj}\n$$\n\n自旋-轨道能量分裂 $\\Delta E_{\\mathrm{so}}$ 是对于给定的 $l$，两个可能的 $j$ 态的能量之差。未受扰动能量 $E^{(0)}_{nl}$ 取决于 $n$ 和 $l$，但与 $j$ 无关。因此，分裂仅仅是一级能量移动的差值。\n$$\n\\Delta E_{\\mathrm{so}} = E_{j=l+\\tfrac{1}{2}} - E_{j=l-\\tfrac{1}{2}} = (E^{(0)}_{nl} + \\Delta E_{l+1/2}) - (E^{(0)}_{nl} + \\Delta E_{l-1/2}) = \\Delta E_{l+1/2} - \\Delta E_{l-1/2}\n$$\n代入能量移动的表达式：\n$$\n\\Delta E_{\\mathrm{so}} = \\langle W_{ls}(r)\\rangle_{nl} \\langle \\mathbf{l}\\cdot\\mathbf{s}\\rangle_{j=l+1/2} - \\langle W_{ls}(r)\\rangle_{nl} \\langle \\mathbf{l}\\cdot\\mathbf{s}\\rangle_{j=l-1/2}\n$$\n$$\n\\Delta E_{\\mathrm{so}} = \\langle W_{ls}(r)\\rangle_{nl} \\left( \\langle \\mathbf{l}\\cdot\\mathbf{s}\\rangle_{j=l+1/2} - \\langle \\mathbf{l}\\cdot\\mathbf{s}\\rangle_{j=l-1/2} \\right)\n$$\n使用推导出的 $\\langle \\mathbf{l}\\cdot\\mathbf{s}\\rangle$ 值：\n$$\n\\Delta E_{\\mathrm{so}} = \\langle W_{ls}(r)\\rangle_{nl} \\left( \\frac{l}{2} - \\left(-\\frac{l+1}{2}\\right) \\right) = \\langle W_{ls}(r)\\rangle_{nl} \\left( \\frac{l+l+1}{2} \\right)\n$$\n$$\n\\Delta E_{\\mathrm{so}} = \\langle W_{ls}(r)\\rangle_{nl} \\frac{2l+1}{2}\n$$\n\n最后，我们代入为 $(n=2,l=3)$ 态的中子提供的数值。给定 $l=3$ 和 $\\langle W_{ls}(r)\\rangle_{nl} = 0.9$ $\\mathrm{MeV}$。\n$$\n\\Delta E_{\\mathrm{so}} = (0.9 \\; \\mathrm{MeV}) \\cdot \\frac{2(3)+1}{2} = (0.9 \\; \\mathrm{MeV}) \\cdot \\frac{7}{2}\n$$\n$$\n\\Delta E_{\\mathrm{so}} = (0.9 \\; \\mathrm{MeV}) \\cdot 3.5 = 3.15 \\; \\mathrm{MeV}\n$$\n计算得出的 $l=3$ 能级的自旋-轨道分裂为 $3.15$ $\\mathrm{MeV}$。", "answer": "$$\n\\boxed{3.15}\n$$", "id": "3602406"}, {"introduction": "在解析地理解了自旋-轨道耦合的效应之后，下一个关键步骤是亲手构建一个模型并观察其现象学上的成功。本计算实践将指导你实现一个简化的核壳层模型，通过调节自旋-轨道相互作用的强度，你将能直观地看到简并的谐振子能级如何分裂并重组成新的壳层结构。这个过程[@problem_id:3602363]生动地再现了正确的原子核幻数序列，深刻揭示了独立粒子模型强大的解释能力。", "problem": "要求您对具有自旋轨道相互作用的球对称平均场中的核子进行独立粒子模型的计算研究。首先以球形三维谐振子为基准平均场，并加入一个单体自旋轨道项。其核心思想是模拟单粒子能谱，观察自旋轨道强度如何破坏主壳层内的简并模式，以及推断出的幻数如何随自旋轨道强度的变化而改变。\n\n使用以下物理上标准且被广泛接受的出发点：\n\n- 在独立粒子模型中，单个核子在平均场势中运动。对于球形谐振子，其未微扰能量由 $E_{\\mathrm{HO}} = \\hbar\\omega\\left(N + \\tfrac{3}{2}\\right)$ 给出，其中 $N = 2n + \\ell$ 是主振子量子数，$n \\in \\{0,1,2,\\dots\\}$ 是径向量子数，$\\ell \\in \\{0,1,2,\\dots\\}$ 是轨道角动量量子数。\n\n- 单体自旋轨道算符为 $\\hat{V}_{\\ell s} = V_{ls}\\,\\hat{\\ell}\\cdot\\hat{s}$，其中 $V_{ls}$ 是一个强度参数（单位为 $\\mathrm{MeV}$），$\\hat{\\ell}$ 是轨道角动量算符，$\\hat{s}$ 是自旋为 $s = \\tfrac{1}{2}$ 的核子的自旋算符。\n\n- 对于一个由 $(N,\\ell,j)$ 标记的球谐基矢态，其总角动量为 $j \\in \\{\\ell \\pm \\tfrac{1}{2}\\}$（当 $\\ell=0$ 时，只有 $j=\\tfrac{1}{2}$），其期望值为 $\\langle \\hat{\\ell}\\cdot\\hat{s} \\rangle = \\tfrac{1}{2}\\left[j(j+1)-\\ell(\\ell+1)-s(s+1)\\right]$，其中 $s(s+1) = \\tfrac{3}{4}$。\n\n- 对于单一核子种类（中子或质子），给定 $(\\ell,j)$ 能级的简并度（容量）为 $g = 2j+1$。\n\n将单粒子能量定义为\n$$\nE_{N\\ell j} = \\hbar\\omega\\left(N + \\tfrac{3}{2}\\right) + V_{ls}\\,\\tfrac{1}{2}\\left[j(j+1)-\\ell(\\ell+1)-\\tfrac{3}{4}\\right],\n$$\n其中 $\\hbar\\omega$ 为固定标度，$V_{ls}$ 可变。在本问题中，您必须取 $\\hbar\\omega = 10\\,\\mathrm{MeV}$，并在负值范围内扫描 $V_{ls}$，以观察简并性如何被破坏以及幻数如何变化。\n\n算法说明：\n\n1. 枚举所有 $N \\in \\{0,1,2,3,4,5,6\\}$（即 $N_{\\max}=6$）的球谐振子轨道 $(N,\\ell,j)$。对于每个 $N$，包括所有允许的 $\\ell \\in \\{N, N-2, \\dots, 0 \\text{ or } 1\\}$，对于每个 $\\ell>0$ 包括 $j=\\ell-\\tfrac{1}{2}$ 和 $j=\\ell+\\tfrac{1}{2}$，而对于 $\\ell=0$ 只包括 $j=\\tfrac{1}{2}$。\n\n2. 对于给定的 $V_{ls}$，计算每个 $E_{N\\ell j}$（单位为 $\\mathrm{MeV}$）和相应的简并度 $g=2j+1$。按能量 $E_{N\\ell j}$ 升序对所有能级进行排序。\n\n3. 将累积占据数 $C_{k}$ 定义为按能量递增顺序填充能级后简并度的累加和，即 $C_{k} = \\sum_{i=1}^{k} g_{i}$。为从能谱中确定幻数，引入一个固定的“显著能隙”阈值 $\\Delta_{\\mathrm{gap}}$（单位为 $\\mathrm{MeV}$）。当相邻能级间的能隙满足 $\\Delta E_{k} = E_{k+1} - E_{k} \\ge \\Delta_{\\mathrm{gap}}$ 时，就将 $C_{k}$ 记为一个幻数（解释为单一核子种类的满壳层闭合）。使用 $\\Delta_{\\mathrm{gap}} = 5\\,\\mathrm{MeV}$。\n\n4. 只报告小于等于 $126$ 的幻数（即，报告任何 $C_{k} \\le 126$ 并忽略更大的闭壳）。这对应于单一核子种类已确立的幻数的标准范围。\n\n物理单位：\n\n- 所有能量都必须以 $\\mathrm{MeV}$ 为单位处理。输出的幻数是无量纲整数。\n\n角度单位不适用于本问题。\n\n测试组：\n\n- 使用以下自旋轨道强度（单位为 $\\mathrm{MeV}$）：$V_{ls} \\in \\{0, -2.5, -5.0, -7.5, -10.0\\}$。对于其中每个值，计算由上述规则定义的幻数列表。\n\n最终输出格式：\n\n- 您的程序必须生成单行输出，其中包含结果，格式为用方括号括起来的逗号分隔的列表的列表，不含空格。例如，对于三个测试用例，其输出分别为 $[2,8]$、$[2,8,20]$ 和 $[2,8,20,28]$，则要求的输出应确切为 \"[[2,8],[2,8,20],[2,8,20,28]]\"。\n- 在本问题中，您的程序的单行输出必须是一个包含五个列表的列表，依次对应于 $V_{ls} = 0, -2.5, -5.0, -7.5, -10.0$。", "solution": "该问题是有效的。它在科学上基于原子核壳模型的原理，问题适定，有清晰的算法路径通往唯一解，并使用客观、正式的语言进行陈述。所有必要的参数和条件都已提供，且没有内部矛盾。\n\n解决此问题需要对平均场中核子的单粒子能谱进行计算建模，并识别出幻数，这些幻数对应于被显著能隙隔开的完全占据的壳层。该模型从球形三维量子谐振子出发，并加入一个自旋轨道相互作用项，这对于复现经验上观测到的超过 $20$ 的幻数至关重要。\n\n由主振子壳层量子数 ($N$)、轨道角动量 ($\\ell$) 和总角动量 ($j$) 表征的单粒子态（或轨道）的能量，由谐振子能量和自旋轨道能量修正之和给出：\n$$\nE_{N\\ell j} = E_{\\mathrm{HO}} + E_{\\ell s}\n$$\n未微扰的谐振子能量仅取决于主壳层数 $N=2n+\\ell$，其中 $n$ 是径向量子数。给定能量标度 $\\hbar\\omega = 10\\,\\mathrm{MeV}$，其能量为：\n$$\nE_{\\mathrm{HO}} = \\hbar\\omega\\left(N + \\frac{3}{2}\\right) = 10\\left(N + \\frac{3}{2}\\right)\\,\\mathrm{MeV}\n$$\n在没有其他相互作用的情况下，给定 $N$ 壳层内的所有轨道都是简并的，这导致幻数出现在 $2, 8, 20, 40, 70$ 和 $112$。\n\n自旋轨道相互作用 $\\hat{V}_{\\ell s} = V_{ls}\\,\\hat{\\ell}\\cdot\\hat{s}$ 破坏了这种简并性。能量修正 $E_{\\ell s}$ 是该算符的期望值。对于具有量子数 $\\ell$ 和 $j$（其中对于 $\\ell > 0$，$j$ 可以是 $\\ell \\pm \\frac{1}{2}$）且核子自旋为 $s=\\frac{1}{2}$ 的态，其期望值为：\n$$\nE_{\\ell s} = \\langle \\hat{V}_{\\ell s} \\rangle = V_{ls}\\,\\langle \\hat{\\ell}\\cdot\\hat{s} \\rangle = V_{ls}\\,\\frac{1}{2}\\left[j(j+1)-\\ell(\\ell+1)-s(s+1)\\right]\n$$\n代入 $s(s+1) = \\frac{3}{4}$，对于 $\\ell > 0$ 的情况可以简化为两种情形：\n1.  对于 $j=\\ell+\\frac{1}{2}$（自旋和轨道角动量平行）：$\\langle \\hat{\\ell}\\cdot\\hat{s} \\rangle = \\frac{\\ell}{2}$。能量移动为 $V_{ls}\\frac{\\ell}{2}$。\n2.  对于 $j=\\ell-\\frac{1}{2}$（自旋和轨道角动量反平行）：$\\langle \\hat{\\ell}\\cdot\\hat{s} \\rangle = -\\frac{\\ell+1}{2}$。能量移动为 $-V_{ls}\\frac{\\ell+1}{2}$。\n\n对于 $\\ell = 0$，我们必须有 $j=\\frac{1}{2}$，此时自旋轨道能量移动为零。由于物理上的自旋轨道强度 $V_{ls}$ 是负值，“平行” ($j=\\ell+\\frac{1}{2}$) 轨道的能量降低，而“反平行” ($j=\\ell-\\frac{1}{2}$) 轨道的能量升高。这种分裂的大小随 $\\ell$ 的增加而增大。这种效应对每个壳层中 $\\ell$ 值最高的轨道最为显著，其能量可以降低到足以成为下面一个壳层的一部分，从而重构壳层能隙并产生正确的幻数序列。\n\n寻找幻数的算法步骤如下：\n\n1.  **枚举态**：系统地生成主壳层数 $N$ 从 $0$ 到 $6$ 的所有允许的单粒子态 $(N, \\ell, j)$。对于每个 $N$，允许的轨道角动量为 $\\ell = N, N-2, \\dots, 0$ 或 $1$。对于每个 $\\ell$，确定相应的 $j$ 值。\n\n2.  **计算能级属性**：对于每个生成的态和给定的自旋轨道强度 $V_{ls}$，使用上述公式计算其能量 $E_{N\\ell j}$。同时，计算其简并度（即它可以容纳的一种核子的数量），由 $g = 2j+1$ 给出。\n\n3.  **按能量排序**：创建一个包含所有态及其相应能量和简并度的列表。按能量升序对此列表进行排序。这个排序后的顺序代表了核子填充轨道的序列。\n\n4.  **识别能隙**：遍历排序后的能级列表。维持一个简并度的累加和，称为累积占据数 ($C_k = \\sum_{i=1}^{k} g_i$)。处理完每个能级后，计算到下一个能级的能隙 $\\Delta E_k = E_{k+1} - E_k$。如果此能隙大于或等于指定的阈值 $\\Delta_{\\mathrm{gap}} = 5\\,\\mathrm{MeV}$，则将当前的累积占据数 $C_k$ 记为一个幻数，前提是它不超过指定的最大值 $126$。\n\n对测试组 $\\{0, -2.5, -5.0, -7.5, -10.0\\}\\,\\mathrm{MeV}$ 中的每个 $V_{ls}$ 值重复此过程，以观察壳层结构和幻数如何随自旋轨道相互作用强度的变化而演化。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes nuclear magic numbers based on the independent particle model\n    with a harmonic oscillator potential and a spin-orbit term.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a single value for the spin-orbit strength V_ls in MeV.\n    test_cases = [0.0, -2.5, -5.0, -7.5, -10.0]\n\n    # Global parameters from the problem\n    HW = 10.0  # MeV, Harmonic oscillator energy scale h-bar * omega\n    DELTA_GAP = 5.0  # MeV, Threshold for identifying a magic number gap\n    N_MAX = 6  # Maximum major oscillator quantum number\n    MAX_MAGIC_NUMBER = 126  # Report magic numbers up to this value\n\n    all_results = []\n\n    for v_ls in test_cases:\n        levels = []\n        \n        # Step 1: Enumerate all single-particle states (N, l, j) and\n        # calculate their energies and degeneracies.\n        for N in range(N_MAX + 1):\n            # The allowed orbital angular momenta l have the same parity as N\n            # and satisfy l = N.\n            for l in range(N, -1, -2):\n                e_ho = HW * (N + 1.5)\n                \n                if l == 0:\n                    # For l=0, only j=1/2 is possible. The spin-orbit term is zero.\n                    j = 0.5\n                    ls_expectation = 0.0\n                    energy = e_ho + v_ls * ls_expectation\n                    degeneracy = 2 * j + 1\n                    levels.append({'energy': energy, 'degeneracy': degeneracy, 'label': f'N={N},l={l},j={j}'})\n                else:\n                    # For l > 0, two j values are possible: j = l +/- 1/2.\n                    # Case 1: j = l + 1/2 (spin-aligned)\n                    j_plus = l + 0.5\n                    ls_expectation_plus = 0.5 * l\n                    energy_plus = e_ho + v_ls * ls_expectation_plus\n                    degeneracy_plus = 2 * j_plus + 1\n                    levels.append({'energy': energy_plus, 'degeneracy': degeneracy_plus, 'label': f'N={N},l={l},j={j_plus}'})\n\n                    # Case 2: j = l - 1/2 (spin-anti-aligned)\n                    j_minus = l - 0.5\n                    ls_expectation_minus = -0.5 * (l + 1)\n                    energy_minus = e_ho + v_ls * ls_expectation_minus\n                    degeneracy_minus = 2 * j_minus + 1\n                    levels.append({'energy': energy_minus, 'degeneracy': degeneracy_minus, 'label': f'N={N},l={l},j={j_minus}'})\n        \n        # Step 2: Sort the levels by ascending energy to determine the filling order.\n        levels.sort(key=lambda x: x['energy'])\n\n        # Step 3: Identify magic numbers by finding large energy gaps in the sorted spectrum.\n        magic_numbers = []\n        cumulative_occupancy = 0\n        for i in range(len(levels) - 1):\n            # Accumulate the number of particles filling shells up to the current level.\n            cumulative_occupancy += levels[i]['degeneracy']\n            \n            # Calculate the energy gap to the next level.\n            energy_gap = levels[i+1]['energy'] - levels[i]['energy']\n            \n            # If the gap is significant, the cumulative occupancy is a magic number.\n            if energy_gap >= DELTA_GAP:\n                if cumulative_occupancy = MAX_MAGIC_NUMBER:\n                    magic_numbers.append(int(cumulative_occupancy))\n\n        all_results.append(magic_numbers)\n\n    # Final print statement in the exact required format.\n    # e.g., \"[[2,8,20],[2,8,20,28],...]\"\n    outer_parts = [f'[{\",\".join(map(str, sublist))}]' for sublist in all_results]\n    print(f\"[{','.join(outer_parts)}]\")\n\nsolve()\n```", "id": "3602363"}, {"introduction": "现代计算核物理不仅关注于模型的解释能力，同样注重如何从实验数据中系统地构建和优化模型。本练习将你带入模型参数化的前沿，你将使用一个简化的单粒子能级线性模型，并通过贝叶斯推断的方法来拟合其参数。这个实践[@problem_id:3602413]不仅能让你掌握一种强大的统计拟合技术，还能让你深入理解模型参数之间的关联性以及先验知识在参数估计中的作用，这些都是高级建模中不可或缺的技能。", "problem": "考虑独立粒子模型 (IPM)，在该模型中，核子在静态平均场中运动，单粒子能级由量子数表征。设由主径向量子数 $n$、轨道角动量 $\\ell$ 和总角动量 $j$ 标记的轨道的理论单粒子能量由一个线性平均场拟设\n$$\nE_{\\text{th}}(n,\\ell,j \\mid \\boldsymbol{\\theta}) \\equiv \\theta_0 + \\theta_1 K(n,\\ell) + \\theta_2 \\ell(\\ell+1) + \\theta_3 \\Delta(\\ell,j),\n$$\n表示，其中 $K(n,\\ell) = 2n + \\ell$ 且 $\\Delta(\\ell,j) = j(j+1) - \\ell(\\ell+1) - s(s+1)$，自旋 $s = \\tfrac{1}{2}$。对于 $j = \\ell + \\tfrac{1}{2}$，有 $\\Delta(\\ell,j) = \\ell$；对于 $j = \\ell - \\tfrac{1}{2}$，有 $\\Delta(\\ell,j) = -(\\ell+1)$。\n\n你的任务是根据已知的单粒子能量确定参数矢量 $\\boldsymbol{\\theta} = (\\theta_0,\\theta_1,\\theta_2,\\theta_3)^{\\mathsf{T}}$ 的贝叶斯后验，然后分析参数之间的后验相关性。使用 Bayes 定理作为你的基本依据：后验正比于似然乘以先验。假设每个数据点都服从已知标准差的高斯似然，以及一个具有对角协方差的多元正态先验，该先验反映了自然性（量级为几个兆电子伏特）。独立粒子模型 (IPM) 假设和这些高斯假设是你的建模前提；你必须推导并实现由此产生的后验，不得使用任何预先指定的快捷公式。\n\n所有能量都必须以兆电子伏特 (MeV) 为单位进行处理和解释。最终需要打印的输出是根据后验协方差计算的、选定参数对之间的无量纲 Pearson 相关系数。\n\n数据和先验被组织成三个测试用例。对于每个测试用例，你将获得：\n- 一组轨道 $(n,\\ell,j)$ 及其测量能量 $E_{\\text{exp}}$ 和测量标准差 $\\sigma$ (单位均为 $\\text{MeV}$)。\n- 一个由其分量标准差（单位均为 $\\text{MeV}$）指定的对角先验协方差，以及一个先验均值矢量。\n\n令每个观测索引 $i$ 通过以下方式构建一个设计行\n$$\n\\mathbf{x}_i = \\begin{bmatrix} 1   K(n_i,\\ell_i)   \\ell_i(\\ell_i+1)   \\Delta(\\ell_i,j_i) \\end{bmatrix},\n$$\n且 $y_i = E_{\\text{exp},i}$。假设观测误差是相互独立的。\n\n你的程序必须：\n1. 从 Bayes 定理和高斯定义出发，通过第一性原理组装设计矩阵和权重，推导并实现线性高斯模型的闭式贝葉斯后验。\n2. 计算后验协方差矩阵 $\\boldsymbol{\\Sigma}_{\\text{post}}$，然后计算 Pearson 相关系数\n$$\n\\rho_{ab} \\equiv \\frac{\\Sigma_{\\text{post},ab}}{\\sqrt{\\Sigma_{\\text{post},aa}\\,\\Sigma_{\\text{post},bb}}},\n$$\n针对集合 $\\{(0,1),(1,2),(2,3),(0,3)\\}$ 中的参数索引对 $(a,b)$，其对应于 $\\{(\\theta_0,\\theta_1),(\\theta_1,\\theta_2),(\\theta_2,\\theta_3),(\\theta_0,\\theta_3)\\}$。\n\n测试套件：\n- 测试用例 $1$ (平衡数据集，中等先验)：\n  - 轨道与数据 (所有能量单位均为 $\\text{MeV}$)：\n    - $n=0$, $\\ell=0$, $j=\\tfrac{1}{2}$, $E_{\\text{exp}}=-40.0$, $\\sigma=0.6$。\n    - $n=0$, $\\ell=1$, $j=\\tfrac{3}{2}$, $E_{\\text{exp}}=-20.5$, $\\sigma=0.4$。\n    - $n=0$, $\\ell=1$, $j=\\tfrac{1}{2}$, $E_{\\text{exp}}=-18.3$, $\\sigma=0.4$。\n    - $n=0$, $\\ell=2$, $j=\\tfrac{5}{2}$, $E_{\\text{exp}}=-5.5$, $\\sigma=0.5$。\n    - $n=1$, $\\ell=0$, $j=\\tfrac{1}{2}$, $E_{\\text{exp}}=-3.2$, $\\sigma=0.5$。\n    - $n=0$, $\\ell=2$, $j=\\tfrac{3}{2}$, $E_{\\text{exp}}=-4.0$, $\\sigma=0.5$。\n  - 先验均值：$\\boldsymbol{\\mu}_0 = (0,0,0,0)^{\\mathsf{T}}$。\n  - 先验标准差：$(\\sigma_{\\theta_0},\\sigma_{\\theta_1},\\sigma_{\\theta_2},\\sigma_{\\theta_3}) = (20,5,2,2)$。\n\n- 测试用例 $2$ (相同数据，更强先验)：\n  - 轨道与数据：与测试用例 $1$ 相同。\n  - 先验均值：$\\boldsymbol{\\mu}_0 = (0,0,0,0)^{\\mathsf{T}}$。\n  - 先验标准差：$(\\sigma_{\\theta_0},\\sigma_{\\theta_1},\\sigma_{\\theta_2},\\sigma_{\\theta_3}) = (10,2,1,1)$。\n\n- 测试用例 $3$ (降低的自旋-轨道敏感度)：\n  - 轨道与数据 (所有能量单位均为 $\\text{MeV}$)：\n    - $n=0$, $\\ell=0$, $j=\\tfrac{1}{2}$, $E_{\\text{exp}}=-40.0$, $\\sigma=0.6$。\n    - $n=0$, $\\ell=1$, $j=\\tfrac{3}{2}$, $E_{\\text{exp}}=-20.5$, $\\sigma=0.4$。\n    - $n=0$, $\\ell=2$, $j=\\tfrac{5}{2}$, $E_{\\text{exp}}=-5.5$, $\\sigma=0.5$。\n  - 先验均值：$\\boldsymbol{\\mu}_0 = (0,0,0,0)^{\\mathsf{T}}$。\n  - 先验标准差：$(\\sigma_{\\theta_0},\\sigma_{\\theta_1},\\sigma_{\\theta_2},\\sigma_{\\theta_3}) = (20,5,2,2)$。\n\n实现与输出要求：\n- 使用指定的假设实现后验的推导与计算，无需外部输入。\n- 为每个测试用例计算四个相关系数 $\\rho_{01}$、$\\rho_{12}$、$\\rho_{23}$ 和 $\\rho_{03}$。\n- 你的程序应生成单行输出，其中包含 $12$ 个结果（每个测试用例四个，按指定的参数对排序，并按测试用例 $1$、$2$、$3$ 的顺序排列），形式为用方括号括起来的逗号分隔列表。例如，输出格式必须为\n$$\n[\\rho_{01}^{(1)},\\rho_{12}^{(1)},\\rho_{23}^{(1)},\\rho_{03}^{(1)},\\rho_{01}^{(2)},\\rho_{12}^{(2)},\\rho_{23}^{(2)},\\rho_{03}^{(2)},\\rho_{01}^{(3)},\\rho_{12}^{(3)},\\rho_{23}^{(3)},\\rho_{03}^{(3)}],\n$$\n每个数字四舍五入到 $6$ 位小数，并以普通小数形式表示（不带百分号）。", "solution": "该问题被验证为是合理的、适定的且有科学依据的。它展示了贝葉斯线性回归在一个简化的原子核物理模型——独立粒子模型 (IPM) 上的标准应用。任务是推导模型参数的后验分布并计算它们的相关性。所有数据和假设都是明确的，并且足以获得唯一解。\n\n理论单粒子能量 $E_{\\text{th}}$ 由一个线性拟设给出：\n$$\nE_{\\text{th}}(n,\\ell,j \\mid \\boldsymbol{\\theta}) = \\theta_0 \\cdot 1 + \\theta_1 K(n,\\ell) + \\theta_2 \\ell(\\ell+1) + \\theta_3 \\Delta(\\ell,j)\n$$\n其中 $\\boldsymbol{\\theta} = (\\theta_0, \\theta_1, \\theta_2, \\theta_3)^{\\mathsf{T}}$ 是参数矢量。对于一组 $N$ 个实验观测值，这可以表示为矩阵形式 $\\mathbf{E}_{\\text{th}} = \\mathbf{X}\\boldsymbol{\\theta}$，其中 $\\mathbf{E}_{\\text{th}}$ 是一个 $N \\times 1$ 的理论能量矢量，$\\mathbf{X}$ 是一个 $N \\times 4$ 的设计矩阵。$\\mathbf{X}$ 的每一行 $\\mathbf{x}_i$ 对应第 $i$ 次观测，并构造如下：\n$$\n\\mathbf{x}_i = \\begin{bmatrix} 1   K(n_i,\\ell_i)   \\ell_i(\\ell_i+1)   \\Delta(\\ell_i,j_i) \\end{bmatrix}\n$$\n问题是在给定实验能量矢量 $\\mathbf{Y} = (E_{\\text{exp},1}, \\dots, E_{\\text{exp},N})^{\\mathsf{T}}$ 的情况下推断 $\\boldsymbol{\\theta}$。\n\n解答源于 Bayes 定理，该定理指出后验概率分布正比于似然与先验概率分布的乘积：\n$$\np(\\boldsymbol{\\theta} | \\mathbf{Y}, \\mathbf{X}) \\propto p(\\mathbf{Y} | \\mathbf{X}, \\boldsymbol{\\theta}) p(\\boldsymbol{\\theta})\n$$\n\n指定的似然是高斯分布。对于每次观测 $y_i = E_{\\text{exp},i}$，假设误差服从均值为零、标准差已知的正态分布 $\\sigma_i$。模型对 $y_i$ 的预测是 $\\mathbf{x}_i \\boldsymbol{\\theta}$。因此，\n$$\np(y_i | \\mathbf{x}_i, \\boldsymbol{\\theta}) = \\mathcal{N}(y_i | \\mathbf{x}_i \\boldsymbol{\\theta}, \\sigma_i^2) = \\frac{1}{\\sqrt{2\\pi\\sigma_i^2}} \\exp\\left( -\\frac{(y_i - \\mathbf{x}_i \\boldsymbol{\\theta})^2}{2\\sigma_i^2} \\right)\n$$\n假设观测误差是独立的，整个数据集 $\\mathbf{Y}$ 的似然是各个似然的乘积：\n$$\np(\\mathbf{Y} | \\mathbf{X}, \\boldsymbol{\\theta}) = \\prod_{i=1}^N p(y_i | \\mathbf{x}_i, \\boldsymbol{\\theta}) \\propto \\exp\\left( -\\frac{1}{2} \\sum_{i=1}^N \\frac{(y_i - \\mathbf{x}_i \\boldsymbol{\\theta})^2}{\\sigma_i^2} \\right)\n$$\n这可以写成矩阵形式。设 $\\boldsymbol{\\Sigma}_{\\text{noise}}$ 为噪声的对角协方差矩阵，其对角线元素为 $\\sigma_i^2$。它的逆矩阵 $\\boldsymbol{\\Sigma}_{\\text{noise}}^{-1}$ 也是对角矩阵，对角线元素为 $1/\\sigma_i^2$。指数部分则为 $-\\frac{1}{2} (\\mathbf{Y} - \\mathbf{X}\\boldsymbol{\\theta})^{\\mathsf{T}} \\boldsymbol{\\Sigma}_{\\text{noise}}^{-1} (\\mathbf{Y} - \\mathbf{X}\\boldsymbol{\\theta})$。\n\n参数 $\\boldsymbol{\\theta}$ 的先验分布是一个均值为 $\\boldsymbol{\\mu}_0$、对角协方差矩阵为 $\\boldsymbol{\\Sigma}_0$ 的多元正态分布：\n$$\np(\\boldsymbol{\\theta}) = \\mathcal{N}(\\boldsymbol{\\theta} | \\boldsymbol{\\mu}_0, \\boldsymbol{\\Sigma}_0) \\propto \\exp\\left( -\\frac{1}{2} (\\boldsymbol{\\theta} - \\boldsymbol{\\mu}_0)^{\\mathsf{T}} \\boldsymbol{\\Sigma}_0^{-1} (\\boldsymbol{\\theta} - \\boldsymbol{\\mu}_0) \\right)\n$$\n\n结合似然和先验，后验分布为：\n$$\np(\\boldsymbol{\\theta} | \\mathbf{Y}, \\mathbf{X}) \\propto \\exp\\left( -\\frac{1}{2} \\left[ (\\mathbf{Y} - \\mathbf{X}\\boldsymbol{\\theta})^{\\mathsf{T}} \\boldsymbol{\\Sigma}_{\\text{noise}}^{-1} (\\mathbf{Y} - \\mathbf{X}\\boldsymbol{\\theta}) + (\\boldsymbol{\\theta} - \\boldsymbol{\\mu}_0)^{\\mathsf{T}} \\boldsymbol{\\Sigma}_0^{-1} (\\boldsymbol{\\theta} - \\boldsymbol{\\mu}_0) \\right] \\right)\n$$\n指数中的项是关于 $\\boldsymbol{\\theta}$ 的二次函数。这意味着后验分布也是一个多元正态分布，记为 $\\mathcal{N}(\\boldsymbol{\\mu}_{\\text{post}}, \\boldsymbol{\\Sigma}_{\\text{post}})$。为了找到其参数，我们对 $\\boldsymbol{\\theta}$ 进行配方。忽略不依赖于 $\\boldsymbol{\\theta}$ 的项，指数的参数为：\n$$\n\\begin{aligned}\n-\\frac{1}{2} \\left( \\mathbf{Y}^{\\mathsf{T}}\\boldsymbol{\\Sigma}_{\\text{noise}}^{-1}\\mathbf{Y} - 2\\mathbf{Y}^{\\mathsf{T}}\\boldsymbol{\\Sigma}_{\\text{noise}}^{-1}\\mathbf{X}\\boldsymbol{\\theta} + \\boldsymbol{\\theta}^{\\mathsf{T}}\\mathbf{X}^{\\mathsf{T}}\\boldsymbol{\\Sigma}_{\\text{noise}}^{-1}\\mathbf{X}\\boldsymbol{\\theta} + \\boldsymbol{\\theta}^{\\mathsf{T}}\\boldsymbol{\\Sigma}_0^{-1}\\boldsymbol{\\theta} - 2\\boldsymbol{\\mu}_0^{\\mathsf{T}}\\boldsymbol{\\Sigma}_0^{-1}\\boldsymbol{\\theta} + \\boldsymbol{\\mu}_0^{\\mathsf{T}}\\boldsymbol{\\Sigma}_0^{-1}\\boldsymbol{\\mu}_0 \\right) \\\\\n= -\\frac{1}{2} \\left( \\boldsymbol{\\theta}^{\\mathsf{T}} ( \\mathbf{X}^{\\mathsf{T}}\\boldsymbol{\\Sigma}_{\\text{noise}}^{-1}\\mathbf{X} + \\boldsymbol{\\Sigma}_0^{-1} ) \\boldsymbol{\\theta} - 2 ( \\mathbf{Y}^{\\mathsf{T}}\\boldsymbol{\\Sigma}_{\\text{noise}}^{-1}\\mathbf{X} + \\boldsymbol{\\mu}_0^{\\mathsf{T}}\\boldsymbol{\\Sigma}_0^{-1} ) \\boldsymbol{\\theta} \\right) + \\text{const.}\n\\end{aligned}\n$$\n多元正态后验 $p(\\boldsymbol{\\theta}) \\propto \\exp(-\\frac{1}{2}(\\boldsymbol{\\theta} - \\boldsymbol{\\mu}_{\\text{post}})^{\\mathsf{T}}\\boldsymbol{\\Sigma}_{\\text{post}}^{-1}(\\boldsymbol{\\theta} - \\boldsymbol{\\mu}_{\\text{post}}))$ 的一般形式的指数部分，展开后包含 $-\\frac{1}{2} (\\boldsymbol{\\theta}^{\\mathsf{T}}\\boldsymbol{\\Sigma}_{\\text{post}}^{-1}\\boldsymbol{\\theta} - 2\\boldsymbol{\\mu}_{\\text{post}}^{\\mathsf{T}}\\boldsymbol{\\Sigma}_{\\text{post}}^{-1}\\boldsymbol{\\theta})$ 等项。\n\n通过比较 $\\boldsymbol{\\theta}$ 的二次项和一次项，我们可以确定后验协方差的逆矩阵以及与后验均值相关的项。\n$\\boldsymbol{\\theta}$ 的二次项给出了后验协方差矩阵 $\\boldsymbol{\\Sigma}_{\\text{post}}$ 的逆：\n$$\n\\boldsymbol{\\Sigma}_{\\text{post}}^{-1} = \\mathbf{X}^{\\mathsf T}\\boldsymbol{\\Sigma}_{\\text{noise}}^{-1}\\mathbf{X} + \\boldsymbol{\\Sigma}_0^{-1}\n$$\n因此，后验协方差为：\n$$\n\\boldsymbol{\\Sigma}_{\\text{post}} = \\left( \\mathbf{X}^{\\mathsf T}\\boldsymbol{\\Sigma}_{\\text{noise}}^{-1}\\mathbf{X} + \\boldsymbol{\\Sigma}_0^{-1} \\right)^{-1}\n$$\n$\\boldsymbol{\\theta}$ 的一次项给出了后验均值 $\\boldsymbol{\\mu}_{\\text{post}}$：\n$$\n\\boldsymbol{\\mu}_{\\text{post}}^{\\mathsf{T}}\\boldsymbol{\\Sigma}_{\\text{post}}^{-1} = \\mathbf{Y}^{\\mathsf{T}}\\boldsymbol{\\Sigma}_{\\text{noise}}^{-1}\\mathbf{X} + \\boldsymbol{\\mu}_0^{\\mathsf{T}}\\boldsymbol{\\Sigma}_0^{-1} \\implies \\boldsymbol{\\mu}_{\\text{post}} = \\boldsymbol{\\Sigma}_{\\text{post}} ( \\mathbf{X}^{\\mathsf{T}}\\boldsymbol{\\Sigma}_{\\text{noise}}^{-1}\\mathbf{Y} + \\boldsymbol{\\Sigma}_0^{-1}\\boldsymbol{\\mu}_0 )\n$$\n虽然后验均值是完整解的一部分，但对于本问题而言并非必需，因为问题只要求从后验协方差矩阵中推导相关性。\n\n任务是计算参数 $\\theta_a$ 和 $\\theta_b$ 之间的 Pearson 相关系数 $\\rho_{ab}$，其定义为：\n$$\n\\rho_{ab} = \\frac{\\Sigma_{\\text{post},ab}}{\\sqrt{\\Sigma_{\\text{post},aa} \\cdot \\Sigma_{\\text{post},bb}}}\n$$\n其中 $\\Sigma_{\\text{post},ab}$ 是 $\\boldsymbol{\\Sigma}_{\\text{post}}$ 矩阵中第 $a$ 行第 $b$ 列的元素（使用从 0 开始的索引，$a,b \\in \\{0, 1, 2, 3\\}$）。\n\n算法如下：\n1. 对于每个测试用例，解析轨道集合 $(n_i, \\ell_i, j_i)$、测量能量 $E_{\\text{exp},i}$ 和标准差 $\\sigma_i$。\n2. 构建 $N \\times 4$ 的设计矩阵 $\\mathbf{X}$。对于每个轨道 $i$，行向量为 $[1, 2n_i+\\ell_i, \\ell_i(\\ell_i+1), \\Delta(\\ell_i,j_i)]$。其中 $\\Delta(\\ell, j)$ 项在 $j = \\ell + \\frac{1}{2}$ 时为 $\\ell$，在 $j = \\ell - \\frac{1}{2}$ 时为 $-(\\ell+1)$。\n3. 构建对角化的 $N \\times N$ 噪声协方差逆矩阵 $\\boldsymbol{\\Sigma}_{\\text{noise}}^{-1}$，其中第 $i$ 个对角元素为 $1/\\sigma_i^2$。\n4. 使用给定的先验标准差，构建对角化的 $4 \\times 4$ 先验协方差逆矩阵 $\\boldsymbol{\\Sigma}_0^{-1}$，其中第 $k$ 个对角元素为 $1/\\sigma_{\\theta_k}^2$。\n5. 使用推导出的公式计算后验协方差矩阵 $\\boldsymbol{\\Sigma}_{\\text{post}}$。\n6. 根据 $\\boldsymbol{\\Sigma}_{\\text{post}}$ 计算四个指定的相关系数：$\\rho_{01}$、$\\rho_{12}$、$\\rho_{23}$ 和 $\\rho_{03}$。\n7. 对所有三个测试用例重复此过程。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Bayesian linear regression problem for three test cases\n    to find posterior parameter correlations.\n    \"\"\"\n    test_cases = [\n        {\n            \"name\": \"Test Case 1 (balanced, moderate priors)\",\n            \"data\": [\n                (0, 0, 0.5, -40.0, 0.6),\n                (0, 1, 1.5, -20.5, 0.4),\n                (0, 1, 0.5, -18.3, 0.4),\n                (0, 2, 2.5, -5.5, 0.5),\n                (1, 0, 0.5, -3.2, 0.5),\n                (0, 2, 1.5, -4.0, 0.5),\n            ],\n            \"prior_mean\": np.array([0.0, 0.0, 0.0, 0.0]),\n            \"prior_std\": np.array([20.0, 5.0, 2.0, 2.0]),\n        },\n        {\n            \"name\": \"Test Case 2 (same data, stronger priors)\",\n            \"data\": [\n                (0, 0, 0.5, -40.0, 0.6),\n                (0, 1, 1.5, -20.5, 0.4),\n                (0, 1, 0.5, -18.3, 0.4),\n                (0, 2, 2.5, -5.5, 0.5),\n                (1, 0, 0.5, -3.2, 0.5),\n                (0, 2, 1.5, -4.0, 0.5),\n            ],\n            \"prior_mean\": np.array([0.0, 0.0, 0.0, 0.0]),\n            \"prior_std\": np.array([10.0, 2.0, 1.0, 1.0]),\n        },\n        {\n            \"name\": \"Test Case 3 (reduced spin-orbit sensitivity)\",\n            \"data\": [\n                (0, 0, 0.5, -40.0, 0.6),\n                (0, 1, 1.5, -20.5, 0.4),\n                (0, 2, 2.5, -5.5, 0.5),\n            ],\n            \"prior_mean\": np.array([0.0, 0.0, 0.0, 0.0]),\n            \"prior_std\": np.array([20.0, 5.0, 2.0, 2.0]),\n        },\n    ]\n\n    all_results = []\n    \n    # Pairs of parameter indices for which to compute correlations\n    # (theta_0, theta_1), (theta_1, theta_2), (theta_2, theta_3), (theta_0, theta_3)\n    corr_pairs = [(0, 1), (1, 2), (2, 3), (0, 3)]\n\n    for case in test_cases:\n        data = case[\"data\"]\n        prior_std = case[\"prior_std\"]\n        \n        num_observations = len(data)\n        num_params = 4\n\n        # 1. Construct design matrix X\n        X = np.zeros((num_observations, num_params))\n        for i, (n, l, j, _, _) in enumerate(data):\n            K = 2 * n + l\n            l_term = l * (l + 1)\n            \n            # Delta term for spin-orbit coupling\n            if np.isclose(j, l + 0.5):\n                delta = l\n            else: # j = l - 0.5\n                delta = -(l + 1)\n            \n            X[i, :] = [1, K, l_term, delta]\n\n        # 2. Extract experimental energies and their standard deviations\n        y = np.array([d[3] for d in data])\n        sigmas = np.array([d[4] for d in data])\n\n        # 3. Construct inverse noise covariance matrix (Sigma_noise^-1)\n        sigma_noise_inv = np.diag(1.0 / (sigmas**2))\n\n        # 4. Construct inverse prior covariance matrix (Sigma_0^-1)\n        sigma_0_inv = np.diag(1.0 / (prior_std**2))\n\n        # 5. Compute posterior covariance matrix\n        # Sigma_post_inv = X^T * Sigma_noise_inv * X + Sigma_0_inv\n        X_T = X.T\n        term1 = X_T @ sigma_noise_inv @ X\n        sigma_post_inv = term1 + sigma_0_inv\n        \n        # Sigma_post = (Sigma_post_inv)^-1\n        sigma_post = np.linalg.inv(sigma_post_inv)\n        \n        # 6. Compute Pearson correlation coefficients for specified pairs\n        case_results = []\n        for a, b in corr_pairs:\n            cov_ab = sigma_post[a, b]\n            var_a = sigma_post[a, a]\n            var_b = sigma_post[b, b]\n            rho_ab = cov_ab / np.sqrt(var_a * var_b)\n            case_results.append(rho_ab)\n        \n        all_results.extend(case_results)\n\n    # Format the results for the final output string\n    # Round to 6 decimal places and join with commas\n    output_str = \",\".join([f\"{val:.6f}\" for val in all_results])\n    print(f\"[{output_str}]\")\n\nsolve()\n```", "id": "3602413"}]}