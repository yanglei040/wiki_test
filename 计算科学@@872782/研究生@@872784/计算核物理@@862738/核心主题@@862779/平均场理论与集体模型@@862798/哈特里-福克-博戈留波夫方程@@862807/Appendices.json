{"hands_on_practices": [{"introduction": "Hartree-Fock-Bogoliubov (HFB) 理论的核心是求解一个大型的哈密顿矩阵以获得准粒子态。为了理解其基本结构，我们可以从最简单的非平凡单元入手：一个由时间反演配对的轨道所构成的 $2 \\times 2$ 子空间。通过亲手对角化这个子矩阵，您可以直接推导出著名的 Bardeen-Cooper-Schrieffer (BCS) 振幅 $(U, V)$，并理解其归一化条件 $U^2 + V^2 = 1$ 是作为保持费米子统计性质的一项基本要求。这项练习将帮助您牢固掌握抽象的HFB矩阵与实用的BCS公式之间的联系。[@problem_id:3601817]", "problem": "考虑一个在 Hartree–Fock–Bogoliubov (HFB) 框架的 Bardeen–Cooper–Schrieffer (BCS) 极限下建模的偶核。假设存在一个正则基，其中时间反演伙伴形成独立的二维配对子空间，且配对场是对角的，具有均匀的配对能隙。给定一组三个单粒子轨道，每个轨道都代表一个时间反演对，其相对于实验室零点的平均场能量为\n$$e_{1} = -9.2\\,\\text{MeV},\\quad e_{2} = -8.3\\,\\text{MeV},\\quad e_{3} = -7.4\\,\\text{MeV}.$$\n化学势为\n$$\\lambda = -8.0\\,\\text{MeV},$$\n且配对能隙是均匀的，\n$$\\Delta = 1.2\\,\\text{MeV}.$$\n\n从 Hartree–Fock–Bogoliubov 变分原理和正则基假设（即只有时间反演伙伴在反常道中耦合）出发，推导第三个轨道（表示为 $U_{3}$ 和 $V_{3}$）的准粒子振幅。推导过程必须通过显式地对角化由变分方程所蕴含的相应二维配对子空间，并对 Bogoliubov 变换施加费米子反对易关系保持约束来进行。使用推导出的表达式，根据给定的数值输入构造 $U_{3}$ 和 $V_{3}$，然后计算归一化量\n$$U_{3}^{2} + V_{3}^{2}.$$\n\n将最终答案表示为一个无量纲数。由于如果推导正确，归一化应为精确值，因此不需要进行舍入。", "solution": "该问题要求在 Hartree–Fock–Bogoliubov (HFB) 理论的 Bardeen–Cooper–Schrieffer (BCS) 极限内，为一个特定的单粒子轨道推导 Bogoliubov 准粒子振幅 $U_3$ 和 $V_3$，并随后计算归一化量 $U_3^2 + V_3^2$。\n\nHFB 理论将原子核基态描述为准粒子的真空，这些准粒子是粒子和空穴产生与湮灭算符的线性组合。从粒子基 $\\{c_k^\\dagger, c_k\\}$ 到准粒子基 $\\{b_k^\\dagger, b_k\\}$ 的变换是 Bogoliubov 变换。将变分原理应用于能量泛函，可得到 HFB 方程，这是一个关于准粒子能量和振幅的本征值问题。其矩阵形式为：\n$$\n\\begin{pmatrix} h-\\lambda I  & \\Delta \\\\ -\\Delta^\\dagger  & -(h-\\lambda I)^* \\end{pmatrix} \\begin{pmatrix} U_k \\\\ V_k \\end{pmatrix} = E_k \\begin{pmatrix} U_k \\\\ V_k \\end{pmatrix}\n$$\n此处，$h$ 是单粒子平均场哈密顿量，$\\Delta$ 是配对场，$\\lambda$ 是化学势，$I$ 是单位矩阵，$E_k$ 是第 $k$ 个准粒子的能量。列向量 $(U_k, V_k)^T$ 是本征态 $k$ 的准粒子振幅矢量。\n\n问题指定了一个正则基，在该基中平均场哈密顿量 $h$ 是对角的，其本征值为 $e_k$。在此基中，问题还指出时间反演伙伴（表示为 $k$ 和 $\\bar{k}$）形成独立的二维配对子空间。这就是 BCS 近似的本质。完整的 HFB 矩阵变为块对角形式，每个 $(k, \\bar{k})$ 对对应一个 $2 \\times 2$ 的块。我们关心的是第三个轨道，因此我们关注由态 $|3\\rangle$ 和 $|\\bar{3}\\rangle$ 张成的子空间。\n\n相关的单粒子哈密顿量矩阵元为 $(h-\\lambda I)_{3,3} = e_3 - \\lambda$ 和 $(h-\\lambda I)_{\\bar{3},\\bar{3}} = e_{\\bar{3}} - \\lambda$。由于时间反演对称性，$e_{\\bar{3}} = e_3$。假设配对场 $\\Delta$ 仅连接时间反演伙伴，因此该块中唯一的非零元是 $\\Delta_{3\\bar{3}}$，我们将其表示为 $\\Delta$。问题指定了均匀且为实数的配对能隙，因此我们设 $\\Delta_{3\\bar{3}} = \\Delta = 1.2\\,\\text{MeV}$。\n\n对于态对 $(3, \\bar{3})$，HFB 方程简化为对一个 $2 \\times 2$ 矩阵的对角化。算符按惯例排序为 $(c_3^\\dagger, c_{\\bar{3}})$。相应的 HFB 矩阵为：\n$$\n\\mathcal{H}_3 = \\begin{pmatrix} e_3 - \\lambda  & \\Delta \\\\ -\\Delta  & -(e_3 - \\lambda) \\end{pmatrix} = \\begin{pmatrix} \\epsilon_3  & \\Delta \\\\ -\\Delta  & -\\epsilon_3 \\end{pmatrix}\n$$\n其中我们定义了移动后的单粒子能量 $\\epsilon_3 = e_3 - \\lambda$。正能解的准粒子振幅 $(U_3, V_3)$ 构成本征值为 $E_3 > 0$ 的本征矢量：\n$$\n\\begin{pmatrix} \\epsilon_3  & \\Delta \\\\ -\\Delta  & -\\epsilon_3 \\end{pmatrix} \\begin{pmatrix} U_3 \\\\ V_3 \\end{pmatrix} = E_3 \\begin{pmatrix} U_3 \\\\ V_3 \\end{pmatrix}\n$$\n这就是问题陈述所要求的显式对角化。通过求解特征方程可以找到本征值 $E_3$：\n$$\n\\det(\\mathcal{H}_3 - E_3 I) = \\det \\begin{pmatrix} \\epsilon_3 - E_3  & \\Delta \\\\ -\\Delta  & -\\epsilon_3 - E_3 \\end{pmatrix} = 0\n$$\n$$\n(\\epsilon_3 - E_3)(-\\epsilon_3 - E_3) - (\\Delta)(-\\Delta) = 0\n$$\n$$\n-(E_3^2 - \\epsilon_3^2) + \\Delta^2 = 0 \\implies E_3^2 = \\epsilon_3^2 + \\Delta^2\n$$\n因此，正的准粒子能量为 $E_3 = \\sqrt{\\epsilon_3^2 + \\Delta^2}$。\n\n接下来，我们求解本征矢量 $(U_3, V_3)^T$。根据矩阵方程的第一行：\n$$\n(\\epsilon_3 - E_3)U_3 + \\Delta V_3 = 0 \\implies V_3 = -\\frac{\\epsilon_3 - E_3}{\\Delta} U_3 = \\frac{E_3 - \\epsilon_3}{\\Delta} U_3\n$$\nBogoliubov 变换必须保持算符的费米子特性，这意味着准粒子算符必须满足正则反对易关系。这对振幅施加了一个归一化条件：\n$$\nU_3^2 + V_3^2 = 1\n$$\n这就是问题中提到的约束条件。我们将 $V_3$ 的表达式代入此归一化条件：\n$$\nU_3^2 + \\left(\\frac{E_3 - \\epsilon_3}{\\Delta}\\right)^2 U_3^2 = 1\n$$\n$$\nU_3^2 \\left[ 1 + \\frac{(E_3 - \\epsilon_3)^2}{\\Delta^2} \\right] = 1\n$$\n$$\nU_3^2 \\left[ \\frac{\\Delta^2 + E_3^2 - 2E_3\\epsilon_3 + \\epsilon_3^2}{\\Delta^2} \\right] = 1\n$$\n使用关系式 $E_3^2 = \\epsilon_3^2 + \\Delta^2$，分子中的项变为：\n$$\n\\Delta^2 + E_3^2 - 2E_3\\epsilon_3 + \\epsilon_3^2 = (\\epsilon_3^2 + \\Delta^2) + E_3^2 - 2E_3\\epsilon_3 = E_3^2 + E_3^2 - 2E_3\\epsilon_3 = 2E_3^2 - 2E_3\\epsilon_3 = 2E_3(E_3 - \\epsilon_3)\n$$\n将其代回，我们得到：\n$$\nU_3^2 \\left[ \\frac{2E_3(E_3 - \\epsilon_3)}{\\Delta^2} \\right] = 1 \\implies U_3^2 = \\frac{\\Delta^2}{2E_3(E_3 - \\epsilon_3)}\n$$\n为了简化此表达式，我们将分子和分母同乘以 $(E_3 + \\epsilon_3)$：\n$$\nU_3^2 = \\frac{\\Delta^2(E_3 + \\epsilon_3)}{2E_3(E_3 - \\epsilon_3)(E_3 + \\epsilon_3)} = \\frac{\\Delta^2(E_3 + \\epsilon_3)}{2E_3(E_3^2 - \\epsilon_3^2)}\n$$\n由于 $E_3^2 - \\epsilon_3^2 = \\Delta^2$，这可简化为：\n$$\nU_3^2 = \\frac{\\Delta^2(E_3 + \\epsilon_3)}{2E_3\\Delta^2} = \\frac{E_3 + \\epsilon_3}{2E_3} = \\frac{1}{2} \\left( 1 + \\frac{\\epsilon_3}{E_3} \\right)\n$$\n根据归一化条件，我们可以求出 $V_3^2$：\n$$\nV_3^2 = 1 - U_3^2 = 1 - \\frac{1}{2} \\left( 1 + \\frac{\\epsilon_3}{E_3} \\right) = \\frac{1}{2} - \\frac{\\epsilon_3}{2E_3} = \\frac{1}{2} \\left( 1 - \\frac{\\epsilon_3}{E_3} \\right)\n$$\n这些是在 BCS 近似中准粒子振幅的一般表达式。\n\n现在，我们根据给定的数值输入构造 $U_3$ 和 $V_3$。注意，能量 $e_1$ 和 $e_2$ 与此计算无关。\n给定：\n$e_3 = -7.4\\,\\text{MeV}$\n$\\lambda = -8.0\\,\\text{MeV}$\n$\\Delta = 1.2\\,\\text{MeV}$\n\n首先，我们计算 $\\epsilon_3$：\n$$\n\\epsilon_3 = e_3 - \\lambda = (-7.4\\,\\text{MeV}) - (-8.0\\,\\text{MeV}) = 0.6\\,\\text{MeV}\n$$\n接下来，我们计算准粒子能量 $E_3$：\n$$\nE_3 = \\sqrt{\\epsilon_3^2 + \\Delta^2} = \\sqrt{(0.6\\,\\text{MeV})^2 + (1.2\\,\\text{MeV})^2} = \\sqrt{0.36 + 1.44}\\,\\text{MeV} = \\sqrt{1.8}\\,\\text{MeV}\n$$\n我们可以选择振幅 $U_3$ 和 $V_3$ 为实数且为正，这是一种常见的相位约定。这导出了以下表达式：\n$$\nU_3 = \\sqrt{\\frac{1}{2} \\left( 1 + \\frac{\\epsilon_3}{E_3} \\right)} = \\sqrt{\\frac{1}{2} \\left( 1 + \\frac{0.6}{\\sqrt{1.8}} \\right)}\n$$\n$$\nV_3 = \\sqrt{\\frac{1}{2} \\left( 1 - \\frac{\\epsilon_3}{E_3} \\right)} = \\sqrt{\\frac{1}{2} \\left( 1 - \\frac{0.6}{\\sqrt{1.8}} \\right)}\n$$\n该比值可以简化：$\\frac{0.6}{\\sqrt{1.8}} = \\frac{\\sqrt{0.36}}{\\sqrt{1.8}} = \\sqrt{\\frac{0.36}{1.8}} = \\sqrt{0.2} = \\frac{1}{\\sqrt{5}}$。\n因此，振幅为：\n$$\nU_3 = \\sqrt{\\frac{1}{2} \\left( 1 + \\frac{1}{\\sqrt{5}} \\right)}\n$$\n$$\nV_3 = \\sqrt{\\frac{1}{2} \\left( 1 - \\frac{1}{\\sqrt{5}} \\right)}\n$$\n问题要求计算归一化量 $U_3^2 + V_3^2$。使用推导出的振幅平方的表达式：\n$$\nU_3^2 + V_3^2 = \\frac{1}{2}\\left(1 + \\frac{\\epsilon_3}{E_3}\\right) + \\frac{1}{2}\\left(1 - \\frac{\\epsilon_3}{E_3}\\right)\n$$\n$$\nU_3^2 + V_3^2 = \\left(\\frac{1}{2} + \\frac{1}{2}\\right) + \\left(\\frac{\\epsilon_3}{2E_3} - \\frac{\\epsilon_3}{2E_3}\\right) = 1 + 0 = 1\n$$\n此结果是一个源于施加在 Bogoliubov 变换上的归一化条件的代数恒等式。只要 $\\Delta \\neq 0$，无论 $e_3$、$\\lambda$ 和 $\\Delta$ 的具体数值如何，该结果都成立。使用具体数值的计算证实了这一基本属性。Bogoliubov 变换矢量 $(U_k, V_k)$ 的归一化为 1 是保持费米子反对易关系的直接结果，这是该理论的基石。", "answer": "$$\n\\boxed{1}\n$$", "id": "3601817"}, {"introduction": "HFB 理论的一个关键特征是粒子数守恒对称性的破缺，这是一个可以通过数学工具进行量化的概念。这项练习将引导您推导粒子数方差 $\\langle (\\Delta \\hat{N})^2 \\rangle$，它是衡量这种对称性破缺程度的指标。理解这个方差至关重要，因为它不仅直接关联到配对关联的强度，也为通过粒子数投影等对称性恢复方法所获得的能量修正设定了尺度。[@problem_id:3601927]", "problem": "考虑一个时间反演不变的原子核系统，该系统在巨正则系综形式下通过 Hartree-Fock-Bogoliubov (HFB) 方法处理。单粒子空间由 $\\Omega$ 个双重简并的时间反演对组成，这些对由 $k$ 和 $\\bar{k}$ 标记，其单粒子能量为 $\\epsilon_k$。粒子数算符定义为 $ \\hat{N} = \\sum_{k=1}^{\\Omega} \\left( a_k^{\\dagger} a_k + a_{\\bar{k}}^{\\dagger} a_{\\bar{k}} \\right) $，其中 $a_k^{\\dagger}$ 和 $a_k$ 是费米子产生和湮灭算符，遵循正则反对易关系。模型哈密顿量是常数-$G$对哈密顿量，\n$$\n\\hat{H} = \\sum_{k=1}^{\\Omega} \\epsilon_k \\left( a_k^{\\dagger} a_k + a_{\\bar{k}}^{\\dagger} a_{\\bar{k}} \\right) - G \\sum_{k,l=1}^{\\Omega} a_k^{\\dagger} a_{\\bar{k}}^{\\dagger} a_{\\bar{l}} a_l ,\n$$\n其中对相互作用强度 $G>0$。\n\n假设 HFB 真空 $|\\Phi\\rangle$ 在正则基中给出，其 Bogoliubov 幅 $u_k$ 和 $v_k$ 为实数且满足 $u_k^2 + v_k^2 = 1$。并且解由实对能隙 $\\Delta$ 和化学势 $\\lambda$ 表征，准粒子能量为\n$$\nE_k = \\sqrt{(\\epsilon_k - \\lambda)^2 + \\Delta^2} .\n$$\n你可以将 $\\Delta$ 和 $\\lambda$ 视为给定常数（即，不需要求解 HFB 能隙或粒子数方程）。\n\n从粒子数算符、费米子反对易关系以及针对准粒子真空的 Wick 定理这些基本定义出发，推导粒子数方差\n$$\n\\langle (\\Delta \\hat{N})^2 \\rangle \\equiv \\langle \\Phi | \\hat{N}^2 | \\Phi \\rangle - \\langle \\Phi | \\hat{N} | \\Phi \\rangle^2\n$$\n对于 HFB 态 $|\\Phi\\rangle$，首先用正则占据幅表示，然后用 $\\Delta$、$\\lambda$ 和 $\\epsilon_k$ 显式地表示它。\n\n在你的推导中，请指明该方差如何依赖于对张量和正常密度，并解释它如何在不使用任何快捷公式的情况下，为通过粒子数投影（例如，通过 Kamlah 展开）获得的能量增益提供领头阶标度。最后，给出 $\\langle (\\Delta \\hat{N})^2 \\rangle$ 的一个单一闭合形式解析表达式，用 $\\Delta$、$\\lambda$ 和集合 $\\{\\epsilon_k\\}_{k=1}^{\\Omega}$ 表示。\n\n你的最终答案必须是一个单一的闭合形式表达式。不需要进行数值计算，也不应进行四舍五入。", "solution": "我们从粒子数算符 $\\hat{N} = \\sum_{k=1}^{\\Omega} \\left( \\hat{n}_k + \\hat{n}_{\\bar{k}} \\right)$ 开始，其中 $\\hat{n}_k = a_k^{\\dagger} a_k$。粒子数方差定义为 $\\langle (\\Delta \\hat{N})^2 \\rangle = \\langle \\hat{N}^2 \\rangle - \\langle \\hat{N} \\rangle^2$。\n\n在正则基中，不同时间反演对 $(k,\\bar{k})$ 和 $(l,\\bar{l})$ 之间的关联为零，因此粒子数算符对不同对的贡献是独立的。这意味着总方差是各对贡献的方差之和：\n$$\n\\langle (\\Delta \\hat{N})^2 \\rangle = \\sum_{k=1}^{\\Omega} \\text{Var}(\\hat{n}_k + \\hat{n}_{\\bar{k}}) = \\sum_{k=1}^{\\Omega} \\left[ \\langle (\\hat{n}_k + \\hat{n}_{\\bar{k}})^2 \\rangle - \\langle \\hat{n}_k + \\hat{n}_{\\bar{k}} \\rangle^2 \\right] .\n$$\n对于Hartree-Fock-Bogoliubov (HFB) 准粒子真空 $|\\Phi\\rangle$ 和正则基，我们有以下期望值：\n- 正常密度：$\\langle \\hat{n}_k \\rangle = \\langle a_k^{\\dagger} a_k \\rangle = v_k^2$。由于时间反演对称性，$\\langle \\hat{n}_{\\bar{k}} \\rangle = v_k^2$。\n- 反常密度（对张量）：$\\langle a_{\\bar{k}} a_k \\rangle = u_k v_k$ 和 $\\langle a_k^{\\dagger} a_{\\bar{k}}^{\\dagger} \\rangle = u_k v_k$（假设实振幅）。\n\n平均粒子数为 $\\langle \\hat{N} \\rangle = \\sum_k (v_k^2 + v_k^2) = 2 \\sum_k v_k^2$。对于每一对，$\\langle \\hat{n}_k + \\hat{n}_{\\bar{k}} \\rangle = 2v_k^2$。\n\n现在计算平方项的期望值。利用费米子性质 $\\hat{n}_k^2 = \\hat{n}_k$：\n$$\n\\langle (\\hat{n}_k + \\hat{n}_{\\bar{k}})^2 \\rangle = \\langle \\hat{n}_k^2 + \\hat{n}_{\\bar{k}}^2 + 2\\hat{n}_k \\hat{n}_{\\bar{k}} \\rangle = \\langle \\hat{n}_k \\rangle + \\langle \\hat{n}_{\\bar{k}} \\rangle + 2\\langle a_k^{\\dagger} a_k a_{\\bar{k}}^{\\dagger} a_{\\bar{k}} \\rangle .\n$$\n使用Wick定理计算四算符项：\n$$\n\\langle a_k^{\\dagger} a_k a_{\\bar{k}}^{\\dagger} a_{\\bar{k}} \\rangle = \\langle a_k^{\\dagger} a_k \\rangle \\langle a_{\\bar{k}}^{\\dagger} a_{\\bar{k}} \\rangle - \\langle a_k^{\\dagger} a_{\\bar{k}}^{\\dagger} \\rangle \\langle a_k a_{\\bar{k}} \\rangle + \\langle a_k^{\\dagger} a_{\\bar{k}} \\rangle \\langle a_k a_{\\bar{k}}^{\\dagger} \\rangle .\n$$\n在正则基中，$\\langle a_k^{\\dagger} a_{\\bar{k}} \\rangle=0$。因此，\n$$\n\\langle a_k^{\\dagger} a_k a_{\\bar{k}}^{\\dagger} a_{\\bar{k}} \\rangle = (v_k^2)(v_k^2) - (u_k v_k)(-u_k v_k) = v_k^4 + u_k^2 v_k^2.\n$$\n将其代入，得到单对的方差：\n$$\n\\text{Var}(\\hat{n}_k + \\hat{n}_{\\bar{k}}) = [ v_k^2 + v_k^2 + 2(v_k^4 + u_k^2 v_k^2) ] - (2v_k^2)^2 \\\\\n= 2v_k^2 + 2v_k^4 + 2u_k^2 v_k^2 - 4v_k^4 \\\\\n= 2v_k^2 - 2v_k^4 + 2u_k^2 v_k^2 \\\\\n= 2v_k^2(1 - v_k^2) + 2u_k^2 v_k^2\n$$\n使用归一化条件 $u_k^2 = 1-v_k^2$，上式变为：\n$$\n\\text{Var}(\\hat{n}_k + \\hat{n}_{\\bar{k}}) = 2v_k^2 u_k^2 + 2u_k^2 v_k^2 = 4 u_k^2 v_k^2 .\n$$\n因此，总的粒子数方差为：\n$$\n\\langle (\\Delta \\hat{N})^2 \\rangle = \\sum_{k=1}^{\\Omega} 4 u_k^2 v_k^2 .\n$$\n此表达式清楚地显示了方差与正常密度 $v_k^2$ 和空穴占据概率 $u_k^2$ 的乘积成正比。它也可以表示为对张量分量的平方和：$u_k v_k = \\kappa_{k\\bar{k}}$，所以 $\\langle (\\Delta \\hat{N})^2 \\rangle = 4 \\sum_k \\kappa_{k\\bar{k}}^2$。非零的粒子数方差直接源于非零的对关联。\n\n现在我们用 HFB 谱参数 $\\Delta$, $\\lambda$, 和 $\\epsilon_k$ 来表示。正则振幅由下式给出：\n$$\nv_k^2 = \\frac{1}{2} \\left( 1 - \\frac{\\epsilon_k - \\lambda}{E_k} \\right), \\quad u_k^2 = \\frac{1}{2} \\left( 1 + \\frac{\\epsilon_k - \\lambda}{E_k} \\right) ,\n$$\n其中 $E_k = \\sqrt{(\\epsilon_k - \\lambda)^2 + \\Delta^2}$。因此，\n$$\nu_k^2 v_k^2 = \\left[ \\frac{1}{2} \\left( 1 + \\frac{\\epsilon_k - \\lambda}{E_k} \\right) \\right] \\left[ \\frac{1}{2} \\left( 1 - \\frac{\\epsilon_k - \\lambda}{E_k} \\right) \\right] = \\frac{1}{4} \\left( 1 - \\frac{(\\epsilon_k - \\lambda)^2}{E_k^2} \\right) = \\frac{1}{4} \\frac{E_k^2 - (\\epsilon_k - \\lambda)^2}{E_k^2} = \\frac{1}{4} \\frac{\\Delta^2}{E_k^2} .\n$$\n代入方差表达式中，我们得到最终的闭合形式：\n$$\n\\langle (\\Delta \\hat{N})^2 \\rangle = \\sum_{k=1}^{\\Omega} 4 \\left( \\frac{1}{4} \\frac{\\Delta^2}{E_k^2} \\right) = \\sum_{k=1}^{\\Omega} \\frac{\\Delta^2}{E_k^2} = \\Delta^2 \\sum_{k=1}^{\\Omega} \\frac{1}{(\\epsilon_k - \\lambda)^2 + \\Delta^2} .\n$$\n这个表达式明确地将粒子数涨落与对能隙 $\\Delta$ 的大小以及能级 $\\epsilon_k$ 相对于化学势 $\\lambda$ 的分布联系起来。\n\n关于投影能量增益，对平均场能量的领头阶修正来自于对 HFB 能量曲面在规范角空间中的二次曲率的近似，即所谓的 Kamlah 展开。能量修正近似为 $E_{\\text{corr}} \\approx -\\frac{\\langle (\\Delta \\hat{N})^2 \\rangle}{2\\mathcal{J}}$，其中 $\\mathcal{J}$ 是与粒子数-角度共轭的转动惯量。因此，$\\langle (\\Delta \\hat{N})^2 \\rangle$ 直接设定了恢复粒子数对称性所获得的能量增益的标度。更大的对关联（更大的 $\\Delta$ 和在 $\\lambda$ 附近更多的能级）会导致更大的粒子数方差，从而导致更大的投影能量修正。", "answer": "$$\\boxed{\\Delta^{2}\\sum_{k=1}^{\\Omega}\\frac{1}{(\\epsilon_{k}-\\lambda)^{2}+\\Delta^{2}}}$$", "id": "3601927"}, {"introduction": "在从理论转向实践的过程中，我们会发现在有限基空间中进行的真实HFB计算需要对配对相互作用进行审慎处理，以避免发散问题。这项计算练习要求您构建一个自洽的HFB方程求解器，并研究不同的正规化方案——例如锐利的能量截断或平滑的高斯型调节函数——如何影响最终收敛的配对能隙 $\\Delta$。这项实践将为您在实际应用中理解HFB解的数值稳定性与物理诠释提供宝贵的经验。[@problem_id:3601819]", "problem": "您需要实现一个数值求解器，用于在一个简化的有限原子核的 Hartree-Fock-Bogoliubov (HFB) 对力问题中，比较不同正则化方案的收敛行为。该求解器必须通过在离散单粒子基中求解自洽的 HFB/BCS 方程来计算对能隙，并应用三种调节器类型之一：(i) 能量窗截断，(ii) 准粒子能量截断，以及 (iii) 平滑高斯调节器。最终输出必须是针对一组指定的调节器参数测试套件的对能隙，以兆电子伏（MeV）为单位报告，四舍五入到三位小数，并以方括号括起来的单个逗号分隔列表形式呈现。\n\n使用以下基本原理进行推导和计算：\n- 对于一个偶偶核系统，在离散基下的 Hartree-Fock-Bogoliubov (HFB) 框架，当对力相互作用为常数时，可以简化为正则基下的一个类 Bardeen-Cooper-Schrieffer (BCS) 问题。在平均场近似下，设对力相互作用强度为常数 $G$，且每个能级有一个时间反演对，准粒子能量为\n$$\nE_i = \\sqrt{(\\epsilon_i - \\mu)^2 + \\Delta^2},\n$$\n其中 $\\epsilon_i$ 是单粒子能量，$\\mu$ 是化学势，$\\Delta$ 是（与能级无关的）对能隙。\n- 占据数振幅满足\n$$\nv_i^2 = \\tfrac{1}{2}\\left(1 - \\frac{\\epsilon_i - \\mu}{E_i}\\right), \\quad u_i^2 = 1 - v_i^2, \\quad u_i v_i = \\frac{\\Delta}{2 E_i}.\n$$\n- 对于每个能级有一个时间反演对的偶偶核系统，粒子数条件为\n$$\nN = 2\\sum_i v_i^2,\n$$\n在作用于对力核的调节器 $w_i \\in [0,1]$ 下，能隙方程为\n$$\n1 = G \\sum_i \\frac{w_i}{2 E_i}.\n$$\n\n调节器必须按如下方式实现：\n- 能量窗截断（“energy cutoff”）：包含能级 $i$ 的权重为\n$$\nw_i = \\Theta\\!\\left( E_{\\mathrm{cut}} - |\\epsilon_i - \\mu| \\right),\n$$\n其中 $\\Theta$ 是 Heaviside 阶跃函数，$E_{\\mathrm{cut}} > 0$ 是以兆电子伏为单位的能量窗半宽度。\n- 准粒子能量截断（“quasiparticle cutoff”）：包含能级 $i$ 的权重为\n$$\nw_i = \\Theta\\!\\left( E_{\\mathrm{qp}}^{\\mathrm{cut}} - E_i \\right),\n$$\n其中 $E_{\\mathrm{qp}}^{\\mathrm{cut}} > 0$ 是以兆电子伏为单位的准粒子能量截断值。\n- 平滑高斯调节器（“smooth regulator”）：应用一个平滑权重\n$$\nw_i = \\exp\\!\\left(-\\left|\\frac{\\epsilon_i - \\mu}{\\Lambda}\\right|^2\\right),\n$$\n其中 $\\Lambda > 0$ 是以兆电子伏为单位的调节器宽度。\n\n有限原子核模型的设置：\n- 使用一个离散、等间距的单粒子能谱，包含 $M = 100$ 个能级，能级间距 $d = 0.5$ 兆电子伏，以 $0$ 为中心，因此\n$$\n\\epsilon_i = d \\left(i - \\frac{M+1}{2}\\right), \\quad i \\in \\{1,\\dots,M\\}.\n$$\n- 使用恒定的对力强度 $G = 0.17$ 兆电子伏。\n- 使用偶数粒子数 $N = 100$。\n- 在所有计算中，对能隙 $\\Delta$ 必须以兆电子伏为单位报告，并四舍五入到三位小数。\n\n数学和算法要求：\n- 对于每个 $\\Delta$ 的试探值，化学势 $\\mu$ 必须通过粒子数条件 $N = 2\\sum_i v_i^2$ 自洽地确定。\n- 对于给定的调节器和参数值，对能隙 $\\Delta$ 必须通过求解经过调节的能隙方程 $1 = G \\sum_i w_i/(2E_i)$ 来获得。如果对于给定的调节器参数，不存在 $\\Delta > 0$ 的非平凡解，则正确解为 $\\Delta = 0$。\n- 粒子数方程不能被调节；也就是说，调节器 $w_i$ 只作用于能隙方程，而不作用于粒子数方程。\n- 在 $\\Delta$ 上的数值解必须稳定，并收敛到最多 $10^{-6}$ 的绝对容差。\n\n测试套件：\n- 使用以下调节器情况和参数（均以兆电子伏为单位），并按下列顺序计算每种情况的对能隙 $\\Delta$：\n  - 能量窗截断，其中 $E_{\\mathrm{cut}} = 4.0$。\n  - 能量窗截断，其中 $E_{\\mathrm{cut}} = 8.0$。\n  - 能量窗截断，其中 $E_{\\mathrm{cut}} = 16.0$。\n  - 准粒子能量截断，其中 $E_{\\mathrm{qp}}^{\\mathrm{cut}} = 0.05$。\n  - 准粒子能量截断，其中 $E_{\\mathrm{qp}}^{\\mathrm{cut}} = 4.0$。\n  - 准粒子能量截断，其中 $E_{\\mathrm{qp}}^{\\mathrm{cut}} = 8.0$。\n  - 平滑调节器，其中 $\\Lambda = 2.0$。\n  - 平滑调节器，其中 $\\Lambda = 4.0$。\n  - 平滑调节器，其中 $\\Lambda = 8.0$。\n  - 用于比较的参考案例：能量窗截断，其中 $E_{\\mathrm{cut}} = 25.0$。\n\n输出规范：\n- 您的程序必须输出一行，其中包含一个与测试套件相对应的 10 个对能隙的逗号分隔列表（用方括号括起来），顺序与给定顺序一致，每个值都四舍五入到三位小数，并解释为兆电子伏。例如，一个有效的输出格式是\n$$\n[\\Delta_1,\\Delta_2,\\dots,\\Delta_{10}],\n$$\n其中每个 $\\Delta_k$ 是一个小数点后有三位数的小数。不涉及角度。不涉及百分比。所有数值都代表以兆电子伏（MeV）为单位的能量。", "solution": "已对用户提供的问题陈述进行了分析和验证。\n\n### 步骤1：提取已知条件\n- **框架**：偶偶核系统的 Hartree-Fock-Bogoliubov (HFB) 框架，简化为类 Bardeen-Cooper-Schrieffer (BCS) 问题。\n- **准粒子能量**：$E_i = \\sqrt{(\\epsilon_i - \\mu)^2 + \\Delta^2}$，其中 $\\epsilon_i$ 是单粒子能量，$\\mu$ 是化学势，$\\Delta$ 是对能隙。\n- **占据数振幅**：$v_i^2 = \\tfrac{1}{2}\\left(1 - \\frac{\\epsilon_i - \\mu}{E_i}\\right)$， $u_i^2 = 1 - v_i^2$， $u_i v_i = \\frac{\\Delta}{2 E_i}$。\n- **粒子数条件**：$N = 2\\sum_i v_i^2$。\n- **经过调节的能隙方程**：$1 = G \\sum_i \\frac{w_i}{2 E_i}$，调节器 $w_i \\in [0,1]$。\n- **调节器定义**：\n    1.  **能量截断**：$w_i = \\Theta( E_{\\mathrm{cut}} - |\\epsilon_i - \\mu| )$，其中 $E_{\\mathrm{cut}} > 0$。\n    2.  **准粒子截断**：$w_i = \\Theta( E_{\\mathrm{qp}}^{\\mathrm{cut}} - E_i )$，其中 $E_{\\mathrm{qp}}^{\\mathrm{cut}} > 0$。\n    3.  **平滑高斯调节器**：$w_i = \\exp(-\\left|\\frac{\\epsilon_i - \\mu}{\\Lambda}\\right|^2)$，其中 $\\Lambda > 0$。\n- **模型参数**：\n    - 能级数：$M = 100$。\n    - 能级间距：$d = 0.5$ MeV。\n    - 单粒子能谱：$\\epsilon_i = d \\left(i - \\frac{M+1}{2}\\right)$，对于 $i \\in \\{1,\\dots,M\\}$。\n    - 对力强度：$G = 0.17$ MeV。\n    - 粒子数：$N = 100$。\n- **算法要求**：\n    - 对于每个试探的 $\\Delta$，化学势 $\\mu$ 需通过粒子数条件自洽确定。\n    - 对能隙 $\\Delta$ 需通过求解经过调节的能隙方程自洽确定。\n    - 粒子数方程不进行调节。\n    - 如果不存在非平凡解 $\\Delta > 0$，则选择平凡解 $\\Delta = 0$。\n    - 对 $\\Delta$ 的数值容差最多为 $10^{-6}$。\n- **测试套件**：\n    - 能量截断：$E_{\\mathrm{cut}} = 4.0, 8.0, 16.0$ MeV。\n    - 准粒子截断：$E_{\\mathrm{qp}}^{\\mathrm{cut}} = 0.05, 4.0, 8.0$ MeV。\n    - 平滑调节器：$\\Lambda = 2.0, 4.0, 8.0$ MeV。\n    - 参考案例：能量截断，$E_{\\mathrm{cut}} = 25.0$ MeV。\n- **输出规范**：一个包含 10 个对能隙的单行逗号分隔列表，四舍五入到三位小数，单位为兆电子伏（MeV），用方括号括起。\n\n### 步骤2：使用提取的已知条件进行验证\n1.  **科学或事实不健全性**：无。该问题描述了一个简化的但标准的 BCS 对力模型，这是核多体理论的基石。所涉及的方程和概念在物理上和数学上都是合理的。\n2.  **不可形式化或不相关**：无。该问题是计算核物理领域一个定义明确的数值任务，直接涉及 Hartree-Fock-Bogoliubov 方法论。\n3.  **不完整或矛盾的设置**：无。所有必需的常数（$G$、$N$、$M$、$d$）、定义（调节器、能量）和过程要求都已明确说明。在 $M=100$ 个能级的能谱中，对力强度 $G=0.17$ MeV 和粒子数 $N=100$ 是一致的，并将导致一个行为良好的系统，预计会产生对力关联。\n4.  **不切实际或不可行**：无。物理参数的量级对于示例性的核模型计算是合理的。\n5.  **不适定或结构不良**：无。该问题涉及求解两个耦合的、非线性的、自洽的方程。此类问题在物理学中很常见，并在这些条件下允许稳定且唯一的解。存在平凡解（$\\Delta = 0$）和可能的非平凡解（$\\Delta > 0$）是能隙方程的典型特征。\n6.  **伪深刻、平凡或同义反复**：无。该问题需要一个涉及嵌套求根的非平凡迭代数值过程，这在计算物理学中构成了一个合理的挑战。\n7.  **超出科学可验证性范围**：无。计算基于可验证的物理模型，并且可以被独立复现。\n\n### 步骤3：结论与行动\n该问题具有科学依据，适定且完整。因此被判定为 **有效**。将提供一个解决方案。\n\n### 解法推导\n\n该问题要求为对能隙 $\\Delta$ 和化学势 $\\mu$ 求解一组两个耦合的自洽方程。该系统由离散的单粒子能谱 $\\{\\epsilon_i\\}$、恒定的对力强度 $G$ 和固定的粒子数 $N$ 定义。两个控制方程是粒子数方程和能隙方程。\n\n首先，我们建立单粒子能谱。对于 $M=100$ 个能级，间距 $d=0.5$ MeV，以 $0$ 为中心，能量由 $\\epsilon_i = d(i - \\frac{M+1}{2})$ 给出，其中 $i \\in \\{1, \\dots, M\\}$。这产生了一个从 $\\epsilon_1 = 0.5(1-50.5) = -24.75$ MeV 到 $\\epsilon_{100} = 0.5(100-50.5) = 24.75$ MeV 的能谱。由于粒子数 $N=100$ 等于可用的单粒子态数（考虑到自旋简并，这由因子 2 隐式处理），在无相互作用的情况下，费米海将被精确填充到 $\\epsilon=0$ 的能级。这意味着在零温无对力时，化学势将是 $\\mu=0$ MeV。存在对力时，由于能谱和填充的对称性，$\\mu$ 预计将保持在接近 $0$ MeV 的位置。\n\n问题的核心是 $\\Delta$ 和 $\\mu$ 方程的耦合性质：\n$$\nN = \\sum_{i=1}^{M} \\left(1 - \\frac{\\epsilon_i - \\mu}{\\sqrt{(\\epsilon_i - \\mu)^2 + \\Delta^2}}\\right) \\quad \\text{(1. 粒子数方程)}\n$$\n$$\n1 = G \\sum_{i=1}^{M} \\frac{w_i(\\mu, \\Delta)}{2 \\sqrt{(\\epsilon_i - \\mu)^2 + \\Delta^2}} \\quad \\text{(2. 能隙方程)}\n$$\n调节器权重 $w_i$ 本身可以依赖于 $\\mu$，并且在一种情况下，通过准粒子能量 $E_i$ 依赖于 $\\Delta$。这种结构表明需要一个嵌套的迭代解法。我们可以将问题构建为寻找关于 $\\Delta$ 的能隙方程的根，其中对于每个 $\\Delta$ 的试探值，我们必须首先找到满足粒子数方程的相应 $\\mu$。\n\n让我们为能隙方程定义一个残差函数：\n$$\nf(\\Delta) = G \\sum_{i=1}^{M} \\frac{w_i(\\mu(\\Delta), \\Delta)}{2 \\sqrt{(\\epsilon_i - \\mu(\\Delta))^2 + \\Delta^2}} - 1\n$$\n我们的目标是找到 $\\Delta \\ge 0$ 使得 $f(\\Delta) = 0$。对于任何给定的 $\\Delta$，计算 $f(\\Delta)$ 都需要 $\\mu(\\Delta)$ 的值，$\\mu(\\Delta)$ 是在该特定 $\\Delta$ 下满足粒子数方程的化学势。\n\n为了找到 $\\mu(\\Delta)$，我们在固定的 $\\Delta$ 下为粒子数方程定义一个残差函数：\n$$\ng(\\mu; \\Delta) = \\sum_{i=1}^{M} \\left(1 - \\frac{\\epsilon_i - \\mu}{\\sqrt{(\\epsilon_i - \\mu)^2 + \\Delta^2}}\\right) - N\n$$\n对于一个固定的 $\\Delta > 0$，$g(\\mu; \\Delta)$ 函数是 $\\mu$ 的单调递增函数。这个性质使其非常适合使用稳定的求根算法，例如二分法或 Brent 方法。我们可以在单粒子能谱的范围内搜索根 $\\mu$，例如 $[\\epsilon_1, \\epsilon_M] = [-24.75, 24.75]$。\n\n总体的数值算法流程如下：\n1.  初始化模型参数：$G=0.17$，$N=100$，以及单粒子能谱 $\\epsilon_i$。\n2.  对于测试套件中提供的每个调节器案例：\n    a. 定义能隙残差函数 $f(\\Delta)$。\n    b. 对于给定的 $\\Delta \\ge 0$，计算 $f(\\Delta)$ 涉及一个内循环子问题：\n        i. 定义粒子数方程残差 $g(\\mu; \\Delta)$。\n        ii. 使用数值求根器（例如 `scipy.optimize.brentq`）在有界区间内求解 $g(\\mu; \\Delta) = 0$ 以得到 $\\mu$。设此解为 $\\mu^*$。\n        iii. 使用 $\\mu^*$ 计算调节器权重 $w_i$。对于能量调节器和平滑调节器，$w_i$ 取决于 $\\epsilon_i - \\mu^*$。对于准粒子截断，$w_i$ 取决于 $E_i = \\sqrt{(\\epsilon_i - \\mu^*)^2 + \\Delta^2}$。\n        iv. 确定 $\\mu^*$ 和 $w_i$ 后，计算并返回 $f(\\Delta)$ 的值。\n    c. 在求解非平凡能隙之前，我们必须检查是否存在解。当且仅当能隙方程对于某个 $\\Delta>0$ 有解时，才存在非平凡解 $\\Delta > 0$，这通常对应于条件 $f(\\Delta \\to 0^+) > 0$。我们将在一个非常小的正值（例如 $\\Delta = 10^{-8}$ MeV）处评估 $f(\\Delta)$。如果 $f(10^{-8}) \\le 0$，则对力相互作用在给定的正则化下不足以打开能隙，解为平凡解 $\\Delta = 0$。\n    d. 如果 $f(10^{-8}) > 0$，则存在非平凡解。我们使用求根器在诸如 $[10^{-8}, 20.0]$ MeV（一个对能隙而言物理上足够大的范围）的区间内求解 $f(\\Delta) = 0$ 以得到 $\\Delta$，绝对容差小于 $10^{-6}$。\n    e. 存储得到的 $\\Delta$。\n\n调节器 $w_i$ 的实现很简单：\n- **能量截断**：如果 $|\\epsilon_i - \\mu| \\le E_{\\mathrm{cut}}$，则 $w_i = 1$，否则为 $0$。\n- **准粒子截断**：如果 $\\sqrt{(\\epsilon_i - \\mu)^2 + \\Delta^2} \\le E_{\\mathrm{qp}}^{\\mathrm{cut}}$，则 $w_i = 1$，否则为 $0$。\n- **平滑调节器**：直接计算高斯函数 $w_i = \\exp(-((\\epsilon_i - \\mu)/\\Lambda)^2)$。\n\n这种嵌套求根方法提供了一种鲁棒的方法来求解耦合的自洽方程。每个测试案例计算出的能隙的最终列表将按规定格式化。关于数值稳定性的说明：当 $\\Delta = 0$ 时，准粒子能量 $E_i$ 变为 $|\\epsilon_i - \\mu|$，表达式 $(\\epsilon_i - \\mu)/E_i$ 变为 $\\mathrm{sgn}(\\epsilon_i - \\mu)$，除了在 $\\epsilon_i = \\mu$ 处，它都是有定义的。由于我们使用的是离散能谱，$\\mu$ 的求根器不太可能碰到这种情况，但鲁棒的代码应该能优雅地处理它。在非平凡解的搜索中使用小的正 $\\Delta$ 值可以避免这个奇点。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Implements a self-consistent solver for the BCS pairing problem with different regulators.\n    \"\"\"\n    #\n    # --- Model Parameters ---\n    #\n    M = 100  # Number of levels\n    d = 0.5  # Level spacing in MeV\n    G = 0.17 # Pairing strength in MeV\n    N = 100  # Particle number\n\n    # Generate single-particle spectrum (centered at 0)\n    # The levels are indexed from 1 to M in the problem statement, which corresponds to 0 to M-1 in Python.\n    # The formula uses i, so we use an array from 1 to M.\n    indices = np.arange(1, M + 1)\n    epsilon = d * (indices - (M + 1) / 2.0)\n    \n    # Numerical precision\n    TOLERANCE = 1e-7 # Stricter than 1e-6 for robustness\n    DELTA_MIN = 1e-8 # Small value to check for non-trivial solution\n\n    def compute_gap(regulator_type, regulator_param):\n        \"\"\"\n        Computes the pairing gap for a given regulator.\n\n        Args:\n            regulator_type (str): 'energy', 'quasiparticle', or 'smooth'.\n            regulator_param (float): The parameter for the regulator (E_cut, E_qp_cut, or Lambda).\n\n        Returns:\n            float: The calculated pairing gap Delta in MeV.\n        \"\"\"\n\n        # Define the search interval for mu. It should be within the spectrum.\n        mu_search_interval = [epsilon[0] - 1.0, epsilon[-1] + 1.0]\n\n        def get_mu_for_delta(delta):\n            \"\"\"\n            Solves the number equation to find mu for a given delta.\n            This is the inner loop of the self-consistent procedure.\n            \"\"\"\n            \n            # Handle the delta=0 case to avoid division by zero.\n            if delta < DELTA_MIN:\n                # For delta=0, v_i^2 is 1 if epsilon_i < mu and 0 if epsilon_i > mu.\n                # The number equation becomes 2 * sum(1 for eps_i < mu) = N.\n                # This means the mu should lie between the N/2-th and (N/2+1)-th particle level.\n                # For N=100 in a spectrum of M=100 levels, mu is between epsilon_49 and epsilon_50 (using 0-indexing).\n                # These are symmetric around 0, so mu=0.\n                # In our symmetric problem, mu must be 0\n                return 0.0\n\n            def number_eq_residual(mu):\n                \"\"\"Residual of the number equation N = 2 * sum(v_i^2).\"\"\"\n                e_shifted = epsilon - mu\n                # Use np.sqrt on a non-negative array.\n                quasi_E = np.sqrt(e_shifted**2 + delta**2)\n                v_sq = 0.5 * (1.0 - e_shifted / quasi_E)\n                return 2.0 * np.sum(v_sq) - N\n\n            try:\n                mu_solution = brentq(number_eq_residual, mu_search_interval[0], mu_search_interval[1], xtol=TOLERANCE)\n                return mu_solution\n            except ValueError:\n                # Brentq fails if the function does not have opposite signs at the interval ends.\n                # This can happen in pathological cases but should not for this well-behaved problem.\n                return np.nan\n\n        def gap_eq_residual(delta):\n            \"\"\"\n            Residual of the gap equation. This is the function whose root we seek for Delta.\n            This is the outer loop.\n            \"\"\"\n            if delta < DELTA_MIN:\n                # Handle the Delta -> 0 limit carefully.\n                # The term 1/(2E_i) becomes 1/(2*|epsilon_i - mu|).\n                delta = 0.0\n\n            mu = get_mu_for_delta(delta)\n            if np.isnan(mu):\n                return np.nan\n            \n            e_shifted = epsilon - mu\n            quasi_E = np.sqrt(e_shifted**2 + delta**2)\n\n            # --- Calculate regulator weights w_i ---\n            if regulator_type == 'energy':\n                E_cut = regulator_param\n                weights = np.where(np.abs(e_shifted) <= E_cut, 1.0, 0.0)\n            elif regulator_type == 'quasiparticle':\n                E_qp_cut = regulator_param\n                weights = np.where(quasi_E <= E_qp_cut, 1.0, 0.0)\n            elif regulator_type == 'smooth':\n                Lambda = regulator_param\n                weights = np.exp(-(e_shifted / Lambda)**2)\n            else:\n                raise ValueError(\"Unknown regulator type\")\n            \n            # Avoid division by zero if any quasi_E is zero (can happen if delta=0 and e_shifted=0)\n            # which is unlikely in practice with floating point arithmetic.\n            # Add a small stabilizer.\n            sum_term = np.sum(weights / (2.0 * quasi_E + DELTA_MIN))\n            \n            return G * sum_term - 1.0\n\n        # --- Check for existence of a non-trivial solution ---\n        # If the gap equation residual at a very small Delta is <= 0, no gap opens.\n        if gap_eq_residual(DELTA_MIN) <= 0:\n            return 0.0\n        \n        # --- Solve for the non-trivial gap Delta > 0 ---\n        try:\n            # A reasonable search range for pairing gaps in nuclei.\n            delta_solution = brentq(gap_eq_residual, DELTA_MIN, 20.0, xtol=TOLERANCE)\n            return delta_solution\n        except ValueError:\n            # If brentq fails, it implies no root in the interval. Given the check above,\n            # this might suggest an issue or that the root is at 0.\n            return 0.0\n\n\n    # --- Test Suite ---\n    test_cases = [\n        ('energy',        4.0),\n        ('energy',        8.0),\n        ('energy',        16.0),\n        ('quasiparticle', 0.05),\n        ('quasiparticle', 4.0),\n        ('quasiparticle', 8.0),\n        ('smooth',        2.0),\n        ('smooth',        4.0),\n        ('smooth',        8.0),\n        ('energy',        25.0) # Reference case\n    ]\n\n    results = []\n    for reg_type, reg_param in test_cases:\n        delta_val = compute_gap(reg_type, reg_param)\n        results.append(delta_val)\n    \n    # Format the output as specified: rounded to three decimals\n    formatted_results = [f\"{val:.3f}\" for val in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3601819"}]}