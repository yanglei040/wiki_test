{"hands_on_practices": [{"introduction": "概念化形变原子核旋转的最简单方法是将其与经典刚体进行类比。这个基础练习旨在连接经典力学与核物理。您将首先推导转动动能的表达式，然后将其应用于一个假设的原子核，从而提供一个具体的计算起点。更重要的是，该练习要求您为该模型的假设提供合理解释，从而培养对一个复杂量子多体系统可在何种条件下近似为简单转子的深刻理解 [@problem_id:3606569]。", "problem": "一个刚体由 $N$ 个质点 $m_{k}$ 组成，它们相对于一个体固定坐标系处于固定位置 $\\mathbf{r}_{k}$，该坐标系的轴由质量分布的主方向定义。该刚体以角速度矢量 $\\boldsymbol{\\omega}$（单位为弧度/秒）进行纯旋转。从牛顿定律和质点系动能的定义出发，推导刚体转动动能的一般张量表达式，该表达式用 $\\boldsymbol{\\omega}$ 和由 $\\{m_{k}, \\mathbf{r}_{k}\\}$ 构建的惯性张量表示。\n\n然后，考虑一个具有稳定四极形变的偶偶核，其可近似为一个刚性转子，其绕体固定轴的主转动惯量为 $I_{1} = 3.6 \\times 10^{-54} \\text{ kg}\\cdot\\text{m}^{2}$，$I_{2} = 4.0 \\times 10^{-54} \\text{ kg}\\cdot\\text{m}^{2}$ 和 $I_{3} = 4.4 \\times 10^{-54} \\text{ kg}\\cdot\\text{m}^{2}$。假设该核沿主轴以角速度分量 $\\omega_{1} = 0.70 \\times 10^{20} \\text{ rad/s}$、$\\omega_{2} = 0.50 \\times 10^{20} \\text{ rad/s}$ 和 $\\omega_{3} = 0.60 \\times 10^{20} \\text{ rad/s}$ 旋转。计算转动动能，并以兆电子伏（MeV）表示最终能量。使用换算关系 $1 \\text{ MeV} = 1.602176634 \\times 10^{-13} \\text{ J}$。将您的答案四舍五入到四位有效数字。\n\n最后，通过诉諸第一性原理的考虑，例如刚性所隐含的约束、时间尺度的分离以及多体系统中的集体运动，来证明为何刚性转子近似适用于具有稳定四极形变的原子核。您的论证应基于物理推理，而不引用特定模型的公式。", "solution": "该问题包括三个部分：一个推导、一个计算和一个概念性论证。每个部分将按顺序进行阐述。\n\n**第一部分：转动动能张量表达式的推导**\n\n我们从一个由 $N$ 个质点 $m_k$ 组成、速度为 $\\mathbf{v}_k$ 的系统的总动能 $T$ 的定义开始。\n$$T = \\sum_{k=1}^{N} \\frac{1}{2} m_k \\mathbf{v}_k^2 = \\sum_{k=1}^{N} \\frac{1}{2} m_k (\\mathbf{v}_k \\cdot \\mathbf{v}_k)$$\n对于一个绕固定点（我们将其作为体固定坐标系的原点）以角速度 $\\boldsymbol{\\omega}$ 进行纯旋转的刚体，位于位置 $\\mathbf{r}_k$ 的第 $k$ 个质点的速度 $\\mathbf{v}_k$ 由叉积给出：\n$$\\mathbf{v}_k = \\boldsymbol{\\omega} \\times \\mathbf{r}_k$$\n将此代入动能表达式可得：\n$$T = \\sum_{k=1}^{N} \\frac{1}{2} m_k (\\boldsymbol{\\omega} \\times \\mathbf{r}_k) \\cdot (\\boldsymbol{\\omega} \\times \\mathbf{r}_k)$$\n我们使用矢量恒等式，也称为 Lagrange 恒等式：$(\\mathbf{A} \\times \\mathbf{B}) \\cdot (\\mathbf{C} \\times \\mathbf{D}) = (\\mathbf{A} \\cdot \\mathbf{C})(\\mathbf{B} \\cdot \\mathbf{D}) - (\\mathbf{A} \\cdot \\mathbf{D})(\\mathbf{B} \\cdot \\mathbf{C})$。对于我们的情况，$\\mathbf{A} = \\mathbf{C} = \\boldsymbol{\\omega}$ 且 $\\mathbf{B} = \\mathbf{D} = \\mathbf{r}_k$。\n$$(\\boldsymbol{\\omega} \\times \\mathbf{r}_k) \\cdot (\\boldsymbol{\\omega} \\times \\mathbf{r}_k) = (\\boldsymbol{\\omega} \\cdot \\boldsymbol{\\omega})(\\mathbf{r}_k \\cdot \\mathbf{r}_k) - (\\boldsymbol{\\omega} \\cdot \\mathbf{r}_k)(\\boldsymbol{\\omega} \\cdot \\mathbf{r}_k) = \\omega^2 r_k^2 - (\\boldsymbol{\\omega} \\cdot \\mathbf{r}_k)^2$$\n这里，$\\omega = |\\boldsymbol{\\omega}|$ 且 $r_k = |\\mathbf{r}_k|$。动能变为：\n$$T = \\frac{1}{2} \\sum_{k=1}^{N} m_k \\left[ \\omega^2 r_k^2 - (\\boldsymbol{\\omega} \\cdot \\mathbf{r}_k)^2 \\right]$$\n为了得到张量形式，我们用笛卡尔分量表示它。令 $\\boldsymbol{\\omega} = (\\omega_1, \\omega_2, \\omega_3)$ 且 $\\mathbf{r}_k = (x_{k,1}, x_{k,2}, x_{k,3})$。\n则 $\\omega^2 = \\sum_{i=1}^{3} \\omega_i^2$，$r_k^2 = \\sum_{j=1}^{3} x_{k,j}^2$，且 $\\boldsymbol{\\omega} \\cdot \\mathbf{r}_k = \\sum_{j=1}^{3} \\omega_j x_{k,j}$。\n求和内的表达式为：\n$$m_k \\left[ \\left(\\sum_{i=1}^{3} \\omega_i^2 \\right) \\left(\\sum_{j=1}^{3} x_{k,j}^2 \\right) - \\left(\\sum_{i=1}^{3} \\omega_i x_{k,i} \\right) \\left(\\sum_{j=1}^{3} \\omega_j x_{k,j} \\right) \\right]$$\n使用克罗内克 delta 符号 $\\delta_{ij}$，我们可以写出 $\\sum_{i} \\omega_i^2 = \\sum_{i,j} \\omega_i \\omega_j \\delta_{ij}$。\n$$T = \\frac{1}{2} \\sum_{k=1}^{N} m_k \\left[ \\left(\\sum_{i,j} \\omega_i \\omega_j \\delta_{ij} \\right) \\left(\\sum_{l} x_{k,l}^2 \\right) - \\sum_{i,j} \\omega_i \\omega_j x_{k,i} x_{k,j} \\right]$$\n我们可以交换求和顺序：\n$$T = \\frac{1}{2} \\sum_{i,j} \\left[ \\sum_{k=1}^{N} m_k \\left( \\delta_{ij} \\sum_{l=1}^{3} x_{k,l}^2 - x_{k,i} x_{k,j} \\right) \\right] \\omega_i \\omega_j$$\n方括号中的项是惯性张量 $\\mathbf{I}$ 的 $(i,j)$ 分量：\n$$I_{ij} = \\sum_{k=1}^{N} m_k (r_k^2 \\delta_{ij} - x_{k,i} x_{k,j})$$\n其中 $r_k^2 = x_{k,1}^2 + x_{k,2}^2 + x_{k,3}^2$。\n因此，转动动能的一般张量表达式为：\n$$T = \\frac{1}{2} \\sum_{i,j=1}^{3} I_{ij} \\omega_i \\omega_j$$\n用矩阵表示法，这写作 $T = \\frac{1}{2} \\boldsymbol{\\omega}^T \\mathbf{I} \\boldsymbol{\\omega}$，其中 $\\boldsymbol{\\omega}$ 是角速度分量的列向量，$\\mathbf{I}$ 是 $3 \\times 3$ 的惯性张量矩阵。\n\n**第二部分：原子核动能的计算**\n\n问题指明体固定轴是质量分布的主轴。在主轴系统中，惯性张量 $\\mathbf{I}$ 是对角矩阵。其分量为 $I_{ij} = I_i \\delta_{ij}$，其中 $I_1$、$I_2$ 和 $I_3$ 是主转动惯量。动能的一般表达式简化为：\n$$T = \\frac{1}{2} \\sum_{i,j=1}^{3} (I_i \\delta_{ij}) \\omega_i \\omega_j = \\frac{1}{2} \\sum_{i=1}^{3} I_i \\omega_i^2$$\n$$T = \\frac{1}{2} (I_1 \\omega_1^2 + I_2 \\omega_2^2 + I_3 \\omega_3^2)$$\n给定以下数值：\n$I_{1} = 3.6 \\times 10^{-54} \\text{ kg}\\cdot\\text{m}^{2}$\n$I_{2} = 4.0 \\times 10^{-54} \\text{ kg}\\cdot\\text{m}^{2}$\n$I_{3} = 4.4 \\times 10^{-54} \\text{ kg}\\cdot\\text{m}^{2}$\n$\\omega_{1} = 0.70 \\times 10^{20} \\text{ rad/s}$\n$\\omega_{2} = 0.50 \\times 10^{20} \\text{ rad/s}$\n$\\omega_{3} = 0.60 \\times 10^{20} \\text{ rad/s}$\n\n我们以国际单位制（焦耳）计算每一项：\n$I_1 \\omega_1^2 = (3.6 \\times 10^{-54}) (0.70 \\times 10^{20})^2 = (3.6 \\times 10^{-54}) (0.49 \\times 10^{40}) = 1.764 \\times 10^{-14} \\text{ J}$\n$I_2 \\omega_2^2 = (4.0 \\times 10^{-54}) (0.50 \\times 10^{20})^2 = (4.0 \\times 10^{-54}) (0.25 \\times 10^{40}) = 1.000 \\times 10^{-14} \\text{ J}$\n$I_3 \\omega_3^2 = (4.4 \\times 10^{-54}) (0.60 \\times 10^{20})^2 = (4.4 \\times 10^{-54}) (0.36 \\times 10^{40}) = 1.584 \\times 10^{-14} \\text{ J}$\n\n总和为：\n$\\sum_{i=1}^{3} I_i \\omega_i^2 = (1.764 + 1.000 + 1.584) \\times 10^{-14} = 4.348 \\times 10^{-14} \\text{ J}$\n\n动能为：\n$T = \\frac{1}{2} (4.348 \\times 10^{-14} \\text{ J}) = 2.174 \\times 10^{-14} \\text{ J}$\n\n最后，我们使用给定的换算因子 $1 \\text{ MeV} = 1.602176634 \\times 10^{-13} \\text{ J}$ 将能量转换为兆电子伏（MeV）。\n$$T_{\\text{MeV}} = \\frac{2.174 \\times 10^{-14} \\text{ J}}{1.602176634 \\times 10^{-13} \\text{ J/MeV}} \\approx 0.1356900 \\text{ MeV}$$\n按要求四舍五入到四位有效数字，我们得到：\n$T_{\\text{MeV}} = 0.1357 \\text{ MeV}$\n\n**第三部分：刚性转子近似的合理性论证**\n\n刚性转子模型对像原子核这样的量子多体系统（尤其是一个具有稳定四极形变的原子核）的适用性，取决于几个植根于第一性原理考虑的关键物理原则。\n\n首先，**集体运动**的概念是核心。在原子核中，并非所有的激发都涉及将单个核子提升到更高的能态（单粒子激发）。某些低能态来自于许多核子的相干、同相运动。对于非球对称的原子核，例如那些具有稳定长椭球形或扁椭球形四极形变的核，整个原子核可以作为一个整体旋转。这种形变核的集体转动产生了一系列的激发态，这正是刚性转子模型旨在描述的现象。\n\n其次，**刚性**的概念源于核子之间的强关联。经典刚体的组分之间距离是固定的。原子核并非严格刚性；其组成核子在平均场势中不断运动。然而，对于具有稳定形变的原子核，强核力创建了一个具有明确平均形状的自束缚系统。改变这种形状所需的能量（振动激发）或破坏核子间配对关联所需的能量，远高于形状本身缓慢转动所关联的能量。这种在转动过程中抵抗形变和内部重排的“刚度”，使得原子核可以被近似为一个刚体。\n\n第三，该模型的有效性关键取决于**时间尺度和能量尺度的分离**。对于不同类型的核运动，存在着一个清晰的特征时间层级。\n1.  **单粒子运动：** 核子在核内快速运动。其时间尺度 $\\tau_{sp}$ 与核子穿越原子核所需的时间处于同一数量级。这对应于最高的能量尺度 $E_{sp}$。\n2.  **振动运动：** 核表面围绕其平衡形状的振荡发生在较慢的时间尺度 $\\tau_{vib}$ 上，对应于较低的能量尺度 $E_{vib}$。\n3.  **转动运动：** 形变核作为一个整体的集体转动是最慢的运动，发生在时间尺度 $\\tau_{rot}$ 上，并对应于最低的能量尺度 $E_{rot}$。\n\n这种层级关系，$E_{rot} \\ll E_{vib} \\ll E_{sp}$ 因而 $\\tau_{rot} \\gg \\tau_{vib} > \\tau_{sp}$，至关重要。因为转动远慢于内部运动，原子核在单次转动期间可以经历多次内部重排和形状振动。从缓慢转动的角度来看，快速的内部动力学过程被平均掉了，呈现出一个具有明確转动惯量的、有效稳定的形变体。这种绝热分离使得人们可以将转动自由度與内禀及振动自由度解耦，从而证明了将原子核处理为简单刚性转子以描述最低集体态是合理的。", "answer": "$$\\boxed{0.1357}$$", "id": "3606569"}, {"introduction": "尽管刚性转子模型提供了一个有用的图像，但其核心参数——转动惯量——并非任意设定。一个更基本的理论应该从原子核的微观结构出发来解释其起源。本练习深入探讨了生成坐标方法（Generator Coordinate Method, GCM），展示了如何从底层多体波函数的性质中推导出转动惯量。通过编程实现Yoccoz转动惯量的计算，您将获得将宏观集体参数与微观量子现实联系起来的实践经验 [@problem_id:3548289]。", "problem": "考虑应用于转动运动的生成坐标方法 (GCM)，其中集体坐标是实验室坐标系中的转动角。在 GCM 中，Hill–Wheeler 方程是一个积分方程，涉及由一组非正交参考态构建的模核和哈密顿核。在高斯重叠近似 (GOA) 中，假设角度坐标中的模核在零相对角附近是局部高斯的。对于表示为 $\\Delta \\theta$ 的转动角差，模核近似为 $N(\\Delta \\theta) \\approx \\exp\\!\\left(-\\frac{1}{2}\\,\\gamma\\,\\Delta \\theta^2\\right)$，其中 $\\gamma$ 是一个曲率（度规）参数。哈密顿核在 $\\Delta \\theta$ 中展开到二阶，近似为 $H(\\Delta \\theta) \\approx E_0\\,N(\\Delta \\theta) + \\frac{1}{2}\\,h_2\\,\\Delta \\theta^2\\,N(\\Delta \\theta)$，其中 $E_0$ 是一个常数，$h_2$ 是哈密顿核相对于角度坐标的曲率（具有能量单位）。\n\n从 Hill–Wheeler 方程和这些 GOA 展开式出发，推导相应的转动集体方程的局域微分形式，并识别出与转动动能算符相匹配的动能项。根据 GOA 映射的第一性原理，得到以模核的曲率参数和哈密顿核的曲率系数表示的 Yoccoz 转动惯量 $\\mathcal{I}_Y$ 的表达式。你的推导必须从 Hill–Wheeler 方程和给定的 GOA 形式开始，通过系统地展开和匹配各项，进而识别出转动的有效微分算符。最终表达式必须通过明确包含约化普朗克常数 $\\hbar$ 来表示为国际单位制一致的能量-时间单位。\n\n然后，你将在一个程序中实现推导出的表达式，该程序从角度空间中模重叠的离散样本估计宽度参数，并计算 Yoccoz 转动惯量。对于高斯模核 $N(\\Delta \\theta) \\approx \\exp\\!\\left(-\\frac{\\Delta \\theta^2}{2 \\sigma^2}\\right)$，宽度 $\\sigma$ 通过 $\\gamma = \\sigma^{-2}$ 与曲率参数相关。给定以弧度为单位的离散角度样本 $\\{\\theta_i\\}$ 和相应的模重叠 $\\{N(\\theta_i)\\}$，通过对数据对 $\\left(\\theta_i^2, \\ln N(\\theta_i)\\right)$ 使用最小二乘法拟合线性关系 $\\ln N(\\theta_i) = -\\frac{1}{2 \\sigma^2}\\,\\theta_i^2$ 来估计 $\\sigma$。使用以 $\\sigma$ 和 $h_2$ 表示的 $\\mathcal{I}_Y$ 的推导表达式，计算每个测试用例的转动惯量。取 $\\hbar = 6.582119569 \\times 10^{-22}$，单位为 $\\mathrm{MeV}\\cdot \\mathrm{s}$。\n\n所有角度必须以弧度处理。Yoccoz 转动惯量 $\\mathcal{I}_Y$ 必须以 $\\mathrm{MeV}\\cdot \\mathrm{s}^2$ 为单位报告，作为浮点数，每个都四舍五入到十位有效数字并以科学记数法表示。你的程序必须生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，$\\left[\\texttt{value1,value2,value3}\\right]$）。\n\n使用以下测试用例集。在每种情况下，程序必须获取给定的角度样本 $\\{\\theta_i\\}$、相应的模重叠 $\\{N(\\theta_i)\\}$ 和指定的 $h_2$ 值，执行拟合以估计 $\\sigma$，然后计算 $\\mathcal{I}_Y$。\n\n情况 A (理想情况):\n- 角度 $\\{\\theta_i\\}$ (弧度): $\\{0.0,\\,0.1,\\,0.2,\\,0.3\\}$。\n- 模重叠 $\\{N(\\theta_i)\\}$: $\\{1.0,\\,0.9459594689067654,\\,0.8007374029168081,\\,0.6065306597126334\\}$。\n- 哈密顿曲率 $h_2$: $2.0$ $\\mathrm{MeV}$。\n\n情况 B (边界条件，非常窄的高斯分布):\n- 角度 $\\{\\theta_i\\}$ (弧度): $\\{0.0,\\,0.02,\\,0.04,\\,0.06,\\,0.08\\}$。\n- 模重叠 $\\{N(\\theta_i)\\}$: $\\{1.0,\\,0.9231163463866358,\\,0.7261490370736909,\\,0.4867522559599719,\\,0.277555756156289\\}$。\n- 哈密顿曲率 $h_2$: $2.0$ $\\mathrm{MeV}$。\n\n情况 C (边缘情况，宽阔的高斯分布和软的哈密顿曲率):\n- 角度 $\\{\\theta_i\\}$ (弧度): $\\{0.0,\\,0.2,\\,0.4,\\,0.6,\\,0.8\\}$。\n- 模重叠 $\\{N(\\theta_i)\\}$: $\\{1.0,\\,0.9692332344750563,\\,0.8824969025845955,\\,0.754852991156548,\\,0.6065306597126334\\}$。\n- 哈密顿曲率 $h_2$: $0.5$ $\\mathrm{MeV}$。\n\n情况 D (使用负角度进行对称性检查):\n- 角度 $\\{\\theta_i\\}$ (弧度): $\\{-0.1,\\,0.0,\\,0.1,\\,0.2\\}$。\n- 模重叠 $\\{N(\\theta_i)\\}$: $\\{0.8824969025845955,\\,1.0,\\,0.8824969025845955,\\,0.6065306597126334\\}$。\n- 哈密顿曲率 $h_2$: $1.5$ $\\mathrm{MeV}$。\n\n你的程序应为每种情况实现以下算法：计算 $\\theta_i^2$ 和 $\\ln N(\\theta_i)$，执行线性最小二乘拟合以估计斜率参数，从中提取 $\\sigma$，然后使用你推导的表达式计算 $\\mathcal{I}_Y$ (单位 $\\mathrm{MeV}\\cdot \\mathrm{s}^2$)。最后，打印一行，其中包含一个列表，按给定顺序包含情况 A–D 的四个计算出的转动惯量，每个值都四舍五入到十位有效数字并以科学记数法表示。", "solution": "主要任务是从高斯重叠近似 (GOA) 下的 Hill–Wheeler (HW) 方程出发，推导出 Yoccoz 转动惯量 $\\mathcal{I}_Y$。对于集体坐标 $\\theta$，HW 方程是一个积分特征值方程：\n$$\n\\int \\left[ H(\\theta, \\theta') - E N(\\theta, \\theta') \\right] f(\\theta') d\\theta' = 0\n$$\n其中 $f(\\theta')$ 是集体波函数，$H(\\theta, \\theta')$ 和 $N(\\theta, \\theta')$ 分别是哈密顿核和模核。对于转动运动，假设这些核仅依赖于角度差 $\\Delta\\theta = \\theta - \\theta'$。问题给出了这些核的 GOA 形式：\n$$\nN(\\Delta\\theta) \\approx \\exp\\left(-\\frac{1}{2}\\gamma (\\Delta\\theta)^2\\right)\n$$\n$$\nH(\\Delta\\theta) \\approx \\left(E_0 + \\frac{1}{2}h_2 (\\Delta\\theta)^2\\right) N(\\Delta\\theta)\n$$\n其中 $\\gamma$ 是模核的曲率，$E_0$ 是基态能量，$h_2$ 是哈密顿核的曲率系数。\n\n在 GCM 框架中，寻找集体惯量的一种标准方法是将核的矩与有效质量参数联系起来。Yoccoz 转动惯量 $\\mathcal{I}_Y$ 可以通过集体质量参数 $M(\\theta)$ 来表示，对于转动，它就是转动惯量本身 $\\mathcal{I}$。一个公认的 GCM-GOA 结果用哈密顿核和模核的矩来表示质量张量的逆（对于一维转动，这简化为 $1/\\mathcal{I}$）。转动惯量的公式是：\n$$\n\\mathcal{I}_Y = \\hbar^2 \\frac{M_2^N}{M_2^H - \\langle H \\rangle M_2^N}\n$$\n这里，$\\langle H \\rangle$ 是能量的期望值，对于基态来说是 $E_0$。矩 $M_k^K$ 定义为：\n$$\nM_k^K = \\int_{-\\infty}^{\\infty} (\\Delta\\theta)^k K(\\Delta\\theta) d(\\Delta\\theta)\n$$\n我们需要计算模核的二阶矩 $M_2^N$ 和哈密顿核的二阶矩 $M_2^H$。\n\n首先，我们计算高斯函数的必要矩。令 $I_k = \\int_{-\\infty}^{\\infty} (\\Delta\\theta)^k \\exp\\left(-\\frac{1}{2}\\gamma(\\Delta\\theta)^2\\right) d(\\Delta\\theta)$。\n使用标准高斯积分：\n$M_2^N = \\int_{-\\infty}^{\\infty} (\\Delta\\theta)^2 \\exp\\left(-\\frac{1}{2}\\gamma(\\Delta\\theta)^2\\right) d(\\Delta\\theta) = \\gamma^{-3/2}\\sqrt{2\\pi}$\n$M_4^N = \\int_{-\\infty}^{\\infty} (\\Delta\\theta)^4 \\exp\\left(-\\frac{1}{2}\\gamma(\\Delta\\theta)^2\\right) d(\\Delta\\theta) = 3\\gamma^{-5/2}\\sqrt{2\\pi}$\n\n接下来，我们使用给定的 $H(\\Delta\\theta)$ 表达式计算 $M_2^H$：\n$$\nM_2^H = \\int_{-\\infty}^{\\infty} (\\Delta\\theta)^2 H(\\Delta\\theta) d(\\Delta\\theta) = \\int_{-\\infty}^{\\infty} (\\Delta\\theta)^2 \\left(E_0 + \\frac{1}{2}h_2 (\\Delta\\theta)^2\\right) N(\\Delta\\theta) d(\\Delta\\theta)\n$$\n$$\nM_2^H = E_0 \\int_{-\\infty}^{\\infty} (\\Delta\\theta)^2 N(\\Delta\\theta) d(\\Delta\\theta) + \\frac{1}{2}h_2 \\int_{-\\infty}^{\\infty} (\\Delta\\theta)^4 N(\\Delta\\theta) d(\\Delta\\theta)\n$$\n$$\nM_2^H = E_0 M_2^N + \\frac{1}{2}h_2 M_4^N\n$$\n现在，我们将这个 $M_2^H$ 的表达式代入 $\\mathcal{I}_Y$ 的公式，并设 $\\langle H \\rangle = E_0$：\n$$\n\\mathcal{I}_Y = \\hbar^2 \\frac{M_2^N}{(E_0 M_2^N + \\frac{1}{2}h_2 M_4^N) - E_0 M_2^N} = \\hbar^2 \\frac{M_2^N}{\\frac{1}{2}h_2 M_4^N} = \\frac{2\\hbar^2}{h_2} \\frac{M_2^N}{M_4^N}\n$$\n矩的比值为：\n$$\n\\frac{M_2^N}{M_4^N} = \\frac{\\gamma^{-3/2}\\sqrt{2\\pi}}{3\\gamma^{-5/2}\\sqrt{2\\pi}} = \\frac{\\gamma}{3}\n$$\n将此比值代回 $\\mathcal{I}_Y$ 的表达式中，得到最终的推导公式：\n$$\n\\mathcal{I}_Y = \\frac{2\\hbar^2\\gamma}{3h_2}\n$$\n问题指定模核的函数形式为 $N(\\Delta\\theta) \\approx \\exp(-\\frac{\\Delta\\theta^2}{2\\sigma^2})$。将其与 $N(\\Delta\\theta) \\approx \\exp(-\\frac{1}{2}\\gamma\\Delta\\theta^2)$ 比较，我们识别出曲率参数 $\\gamma = 1/\\sigma^2$。将此代入我们的 $\\mathcal{I}_Y$ 表达式中：\n$$\n\\mathcal{I}_Y = \\frac{2\\hbar^2}{3h_2\\sigma^2}\n$$\n下一步是概述数值计算过程。我们给定离散样本 $(\\theta_i, N_i)$，需要估计 $\\sigma^2$。模型关系是：\n$$\n\\ln(N(\\theta_i)) = -\\frac{1}{2\\sigma^2} \\theta_i^2\n$$\n这是一个 $y_i = m x_i$ 形式的线性方程，其中 $y_i = \\ln(N_i)$，$x_i = \\theta_i^2$，斜率为 $m = -\\frac{1}{2\\sigma^2}$。由于所有测试用例都包含点 $(\\theta_i=0, N_i=1)$，相应的数据点 $(x_i=0, y_i=0)$ 证实了模型通过原点。通过最小化残差平方和，可以找到通过原点的直线的最佳拟合斜率 $m$：\n$$\nm = \\frac{\\sum_i x_i y_i}{\\sum_i x_i^2}\n$$\n从斜率中，我们可以将 $1/\\sigma^2$ 表示为 $1/\\sigma^2 = -2m$。将此代入 $\\mathcal{I}_Y$ 的公式中：\n$$\n\\mathcal{I}_Y = \\frac{2\\hbar^2}{3h_2} \\left(\\frac{1}{\\sigma^2}\\right) = \\frac{2\\hbar^2}{3h_2}(-2m) = -\\frac{4\\hbar^2m}{3h_2}\n$$\n这是要实现的最终表达式。物理上的转动惯量必须是正的。由于 $N_i \\le 1$，$\\ln(N_i) \\le 0$，使得斜率 $m$ 为负。当 $h_2 > 0$ 且 $m$ 为负时，$\\mathcal{I}_Y$ 将为正，确保了物理上有意义的结果。\n\n程序的算法如下：\n1. 对于每个测试用例，取角度数组 $\\{\\theta_i\\}$ 和模重叠数组 $\\{N_i\\}$，以及标量 $h_2$。\n2. 构建一个 $x_i = \\theta_i^2$ 的数组。\n3. 构建一个 $y_i = \\ln(N_i)$ 的数组。\n4. 计算斜率 $m = (\\sum x_i y_i) / (\\sum x_i^2)$。\n5. 使用推导出的公式 $\\mathcal{I}_Y = -4\\hbar^2m/(3h_2)$ 计算转动惯量，其中 $\\hbar = 6.582119569 \\times 10^{-22} \\, \\mathrm{MeV}\\cdot\\mathrm{s}$。\n6. 将结果格式化为十位有效数字的科学记数法。\n7. 收集所有情况的结果，并按指定格式打印。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the Yoccoz moment of inertia based on GCM-GOA.\n    \"\"\"\n    \n    # Define the reduced Planck constant in MeV*s\n    hbar = 6.582119569e-22  # MeV * s\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A (happy path)\n        {\n            'angles': np.array([0.0, 0.1, 0.2, 0.3]),\n            'norms': np.array([1.0, 0.9459594689067654, 0.8007374029168081, 0.6065306597126334]),\n            'h2': 2.0  # MeV\n        },\n        # Case B (boundary condition, very narrow Gaussian)\n        {\n            'angles': np.array([0.0, 0.02, 0.04, 0.06, 0.08]),\n            'norms': np.array([1.0, 0.9231163463866358, 0.7261490370736909, 0.4867522559599719, 0.277555756156289]),\n            'h2': 2.0  # MeV\n        },\n        # Case C (edge case, broad Gaussian and soft Hamiltonian curvature)\n        {\n            'angles': np.array([0.0, 0.2, 0.4, 0.6, 0.8]),\n            'norms': np.array([1.0, 0.9692332344750563, 0.8824969025845955, 0.754852991156548, 0.6065306597126334]),\n            'h2': 0.5  # MeV\n        },\n        # Case D (symmetry check with negative angles)\n        {\n            'angles': np.array([-0.1, 0.0, 0.1, 0.2]),\n            'norms': np.array([0.8824969025845955, 1.0, 0.8824969025845955, 0.6065306597126334]),\n            'h2': 1.5  # MeV\n        }\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        angles = case['angles']\n        norms = case['norms']\n        h2 = case['h2']\n\n        # Step 1: Prepare data for linear least-squares fit\n        # x_i = theta_i^2\n        # y_i = ln(N_i)\n        x = angles**2\n        \n        # Taking natural logarithm of norm overlaps.\n        # Use np.ma.log to handle log(0) if norms contain 0, although problem data avoids this.\n        # For N=1 at theta=0, ln(1)=0. For N1, ln(N) is negative.\n        y = np.log(norms)\n        \n        # Step 2: Perform linear least-squares fit for y = m*x\n        # The best-fit slope for a line through the origin is m = sum(x*y) / sum(x^2)\n        # The point (x=0, y=0) contributes nothing to the sums, so it can be included or excluded\n        # without changing the result, as long as other points exist.\n        m = np.dot(x, y) / np.dot(x, x)\n        \n        # Step 3: Calculate the Yoccoz moment of inertia\n        # Derived formula: I_Y = -4 * hbar^2 * m / (3 * h2)\n        # Units: (MeV*s)^2 / MeV = MeV*s^2\n        i_y = -4 * (hbar**2) * m / (3 * h2)\n        \n        # Step 4: Format the result to ten significant digits in scientific notation\n        results.append(f\"{i_y:.9e}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3548289"}, {"introduction": "真实的原子核远非简单的刚性转子；其有效转动惯量通常随着转速的增加而发生剧烈变化。这个高级计算练习使用强大的摇摆模型（cranking model）来模拟核转动的一个标志性现象——“回弯”（backbending）。您将模拟集体基态带与一个准粒子“排成”组态之间的相互作用，并观察这种相互作用如何导致转动惯量的急剧增加。该练习为了解旋转量子系统中集体运动与单粒子自由度之间迷人的相互作用，提供了一个直接的计算窗口 [@problem_id:3550162]。", "problem": "考虑一个简化的、双带阻塞的摇摆Hartree–Fock–Bogoliubov (HFB) 模型，用于描述形变原子核中的集体转动。其目的是模拟特定Nilsson轨道在转动下的排列，并计算在带交叉前后运动学转动惯量和动力学转动惯量的变化。\n\n你将基于摇摆方法和一个两能级混合哈密顿量，在转动坐标系中实现一个最小化的自洽模型。该模型由以下要素定义：\n\n1. 摇摆方法引入了转动坐标系哈密顿量 $H' = H - \\omega \\hat{J}$，其中 $\\omega$ 是以 $\\mathrm{MeV}/\\hbar$ 为单位的转动频率，$H$ 是实验室坐标系哈密顿量，$\\hat{J}$ 是角动量算符。\n\n2. 核心的转动能被建模为一个经典的刚性转子，其能量为 $E_{\\text{core}}(\\omega) = \\tfrac{1}{2} \\mathcal{J}\\,\\omega^2$，其中 $\\mathcal{J}$ 是以 $\\hbar^2/\\mathrm{MeV}$ 为单位的核心转动惯量。在转动坐标系中，相应的路西安（Routhian）贡献为 $E_{\\text{core}}'(\\omega) = E_{\\text{core}}(\\omega) - \\omega J_{\\text{core}}(\\omega)$。对于刚性转子，使用 $J_{\\text{core}}(\\omega) = \\mathcal{J}\\,\\omega$，可得 $E_{\\text{core}}'(\\omega) = -\\tfrac{1}{2}\\,\\mathcal{J}\\,\\omega^2$。\n\n3. 具有排列角动量 $i_a$（以 $\\hbar$ 为单位）的特定Nilsson轨道的排列被建模为对路西安的附加贡献 $E_{\\text{align}}'(\\omega) = E_{\\text{align}} - \\omega\\,i_a$，其中 $E_{\\text{align}}$（以 $\\mathrm{MeV}$ 为单位）是与创建此排列准粒子组态相关的内禀能量代价。\n\n4. Hartree–Fock–Bogoliubov (HFB) 中的阻塞意味着一个准粒子被占据，这会减弱对关联并增加有效转动惯量。我们通过一个分数增量 $\\alpha \\ge 0$ 来参数化此效应，表示排列带中核心转动惯量的增加。因此，未排列（A）带的核心转动惯量为 $\\mathcal{J}_A = \\mathcal{J}_0$，而排列（B）带的为 $\\mathcal{J}_B = \\mathcal{J}_0\\,(1+\\alpha)$，其中 $\\mathcal{J}_0$ 的单位为 $\\hbar^2/\\mathrm{MeV}$。\n\n5. 双带转动坐标系的路西安为\n$$\nE_A'(\\omega) = -\\tfrac{1}{2}\\,\\mathcal{J}_0\\,\\omega^2,\n\\qquad\nE_B'(\\omega) = E_{\\text{align}} - \\omega\\,i_a - \\tfrac{1}{2}\\,\\mathcal{J}_0(1+\\alpha)\\,\\omega^2.\n$$\n\n6. 两种组态之间的相互作用由一个恒定的混合矩阵元 $V$（以 $\\mathrm{MeV}$ 为单位）建模。得到的 $2\\times 2$ 转动坐标系哈密顿量为\n$$\nH'(\\omega) =\n\\begin{pmatrix}\nE_A'(\\omega)  V \\\\\nV  E_B'(\\omega)\n\\end{pmatrix}.\n$$\n基态路西安 $E'_-(\\omega)$ 是通过对角化 $H'(\\omega)$ 得到的较低本征值。\n\n7. 总角动量期望值作为转动频率的函数，可从摇摆定义得出：\n$$\nI(\\omega) = -\\frac{dE'_-(\\omega)}{d\\omega}.\n$$\n\n8. 运动学转动惯量和动力学转动惯量定义为\n$$\n\\mathcal{J}^{(1)}(\\omega) = \\frac{I(\\omega)}{\\omega},\n\\qquad\n\\mathcal{J}^{(2)}(\\omega) = \\frac{dI(\\omega)}{d\\omega}.\n$$\n$\\mathcal{J}^{(1)}$ 和 $\\mathcal{J}^{(2)}$ 的单位均为 $\\hbar^2/\\mathrm{MeV}$。\n\n9. 非绝热交叉频率（即两个未混合带将交叉的频率）通过求解 $E_A'(\\omega) = E_B'(\\omega)$ 对 $\\omega$ 求解来定义。这得到一个二次方程\n$$\n\\frac{1}{2}\\,\\mathcal{J}_0\\,\\alpha\\,\\omega^2 + i_a\\,\\omega - E_{\\text{align}} = 0,\n$$\n其物理上相关的解（对于 $\\alpha  0$）为\n$$\n\\omega_c = \\frac{-i_a + \\sqrt{i_a^2 + 2\\,\\mathcal{J}_0\\,\\alpha\\,E_{\\text{align}}}}{\\mathcal{J}_0\\,\\alpha}.\n$$\n对于 $\\alpha = 0$，使用 $\\omega_c = E_{\\text{align}}/i_a$。\n\n10. 对于给定物理量 $Q(\\omega)$（$\\mathcal{J}^{(1)}$ 或 $\\mathcal{J}^{(2)}$），其跨越交叉的变化定义为\n$$\n\\Delta Q = \\langle Q(\\omega)\\rangle_{\\text{post}} - \\langle Q(\\omega)\\rangle_{\\text{pre}},\n$$\n其中 $\\langle\\cdot\\rangle_{\\text{pre}}$ 是在交叉点之前一个频率窗口上的平均值，$\\langle\\cdot\\rangle_{\\text{post}}$ 是在交叉点之后一个窗口上的平均值。使用半宽为 $w$ 的对称窗口，并排除 $\\omega_c$ 周围一个大小为 $\\varepsilon$ 的小邻域，以避免直接的混合区域：\n$$\n\\text{pre-window}:\\ \\omega \\in [\\omega_c - w,\\ \\omega_c - \\varepsilon],\\quad\n\\text{post-window}:\\ \\omega \\in [\\omega_c + \\varepsilon,\\ \\omega_c + w].\n$$\n\n你的程序必须：\n\n- 使用上述模型，在均匀频率网格上构建 $H'(\\omega)$。\n- 在每个网格点上对角化 $H'(\\omega)$ 以获得 $E'_-(\\omega)$。\n- 使用有限差分法对 $E'_-(\\omega)$ 关于 $\\omega$ 进行数值微分，以计算 $I(\\omega)$。\n- 使用上述定义计算 $\\mathcal{J}^{(1)}(\\omega)$ 和 $\\mathcal{J}^{(2)}(\\omega)$。\n- 使用指定的窗口计算交叉前后的变化量 $\\Delta \\mathcal{J}^{(1)}$ 和 $\\Delta \\mathcal{J}^{(2)}$。\n\n单位与约定：\n\n- $\\omega$ 以 $\\mathrm{MeV}/\\hbar$ 表示，能量以 $\\mathrm{MeV}$ 表示，角动量以 $\\hbar$ 表示，$\\mathcal{J}^{(1)}$、$\\mathcal{J}^{(2)}$ 以 $\\hbar^2/\\mathrm{MeV}$ 表示。\n- 在对 $\\omega$ 微分时，弧度是隐式使用的；无需指定角度单位。\n\n频率网格与窗口：\n\n- 使用频率网格 $\\omega \\in [\\omega_{\\min}, \\omega_{\\max}]$，步长为 $\\Delta\\omega$，其中 $\\omega_{\\min}  0$ 以避免在 $\\mathcal{J}^{(1)}(\\omega)$ 中出现除以零的情况。\n- 使用由参数 $w$ 和 $\\varepsilon$ 定义的上述对称窗口。\n\n测试套件：\n\n实现程序以评估以下参数集，每个参数集以元组 $(\\mathcal{J}_0, \\alpha, i_a, E_{\\text{align}}, V, \\omega_{\\min}, \\omega_{\\max}, \\Delta\\omega, w, \\varepsilon)$ 的形式给出：\n\n- 情况1（一般混合，中等阻塞，典型排列）：\n  $(30.0,\\ 0.12,\\ 6.0,\\ 1.20,\\ 0.05,\\ 0.02,\\ 0.80,\\ 0.002,\\ 0.06,\\ 0.01)$。\n- 情况2（无混合，尖锐交叉极限）：\n  $(30.0,\\ 0.12,\\ 6.0,\\ 1.20,\\ 0.00,\\ 0.02,\\ 0.80,\\ 0.002,\\ 0.06,\\ 0.01)$。\n- 情况3（强混合，避免交叉更显著）：\n  $(30.0,\\ 0.12,\\ 6.0,\\ 1.20,\\ 0.20,\\ 0.02,\\ 0.80,\\ 0.002,\\ 0.06,\\ 0.01)$。\n- 情况4（更大排列，较弱阻塞）：\n  $(28.0,\\ 0.05,\\ 10.0,\\ 1.50,\\ 0.08,\\ 0.02,\\ 0.80,\\ 0.002,\\ 0.06,\\ 0.01)$。\n\n输出规范：\n\n- 对于每个测试用例，你的程序必须输出一个包含两个浮点数的列表：$[\\Delta \\mathcal{J}^{(1)},\\ \\Delta \\mathcal{J}^{(2)}]$，单位为 $\\hbar^2/\\mathrm{MeV}$。\n- 将所有测试用例的结果按上述顺序汇总到一个列表中，并打印仅包含此汇总列表的一行，格式为方括号内用逗号分隔的列表。例如：`[[dJ1_case1,dJ2_case1],[dJ1_case2,dJ2_case2],[dJ1_case3,dJ2_case3],[dJ1_case4,dJ2_case4]]`。", "solution": "此问题的核心是为一个旋转原子核中的双带混合情景建模，并量化在带交叉区域前后运动学和动力学转动惯量的变化。解法通过逐步实现指定的模型来进行。\n\n首先，我们为一个两能级系统定义转动坐标系（或路西安）。未受扰动的，或称非绝热的组态是基态带（A带）和一个排列的双准粒子带（B带）。它们的路西安 $E_A'(\\omega)$ 和 $E_B'(\\omega)$ 是转动频率 $\\omega$ 的函数。如指定，它们是：\n$$\nE_A'(\\omega) = -\\frac{1}{2}\\,\\mathcal{J}_0\\,\\omega^2\n$$\n$$\nE_B'(\\omega) = E_{\\text{align}} - \\omega\\,i_a - \\frac{1}{2}\\,\\mathcal{J}_0(1+\\alpha)\\,\\omega^2\n$$\n这里，$\\mathcal{J}_0$ 是核心的转动惯量，$E_{\\text{align}}$ 是在静止状态下创建排列组态所需的能量代价，$i_a$ 是由两个准粒子沿转动轴排列的角动量，而 $\\alpha$ 是一个考虑了对关联减弱（阻塞效应）的参数，这会增加排列带的转动惯量。\n\n这两个非绝热带以强度 $V$ 相互作用。在这两个态的基底下，完整的路西安算符是一个 $2 \\times 2$ 矩阵：\n$$\nH'(\\omega) =\n\\begin{pmatrix}\nE_A'(\\omega)  V \\\\\nV  E_B'(\\omega)\n\\end{pmatrix}\n$$\n可观测的态，即yrast带和yrare带，是这个矩阵的本征态。我们感兴趣的是yrast带，它对应于在每个频率 $\\omega$ 下 $H'(\\omega)$ 的较低本征值。一个通用的 $2\\times 2$ 矩阵 $\\begin{pmatrix} a  c \\\\ c  b \\end{pmatrix}$ 的本征值 $\\lambda$ 由 $\\lambda = \\frac{a+b \\pm \\sqrt{(a-b)^2 + 4c^2}}{2}$ 给出。因此，较低的本征值，我们记为yrast路西安 $E'_-(\\omega)$，为：\n$$\nE'_-(\\omega) = \\frac{1}{2} \\left[ (E_A'(\\omega) + E_B'(\\omega)) - \\sqrt{(E_A'(\\omega) - E_B'(\\omega))^2 + 4V^2} \\right]\n$$\n此表达式在一个离散的转动频率网格 $\\omega_k$ 上计算，该网格跨越范围 $[\\omega_{\\min}, \\omega_{\\max}]$，步长为 $\\Delta\\omega$。\n\n从yrast路西安 $E'_-(\\omega)$，我们导出总排列角动量 $I(\\omega)$。在摇摆模型中，这由类热力学关系给出：\n$$\nI(\\omega) = -\\frac{dE'_-(\\omega)}{d\\omega}\n$$\n由于 $E'_-(\\omega)$ 仅在离散网格上已知，这个导数使用中心有限差分格式进行数值计算。\n\n确定了角动量 $I(\\omega)$ 后，我们可以分别计算运动学和动力学转动惯量 $\\mathcal{J}^{(1)}(\\omega)$ 和 $\\mathcal{J}^{(2)}(\\omega)$。它们的定义是：\n$$\n\\mathcal{J}^{(1)}(\\omega) = \\frac{I(\\omega)}{\\omega}\n$$\n$$\n\\mathcal{J}^{(2)}(\\omega) = \\frac{dI(\\omega)}{d\\omega}\n$$\n运动学转动惯量 $\\mathcal{J}^{(1)}$ 是衡量在给定转动频率下产生多少角动量的指标。动力学转动惯量 $\\mathcal{J}^{(2)}$ 测量角动量随频率变化的速率，对结构变化（如带交叉）尤其敏感。$\\mathcal{J}^{(2)}$ 的导数也使用中心有限差分法计算。\n\n最后一步是分析 $\\mathcal{J}^{(1)}$ 和 $\\mathcal{J}^{(2)}$ 在带交叉前后的行为。交叉点由非绝热交叉频率 $\\omega_c$ 表征，在该频率下未受扰动的路西安相等，$E_A'(\\omega_c) = E_B'(\\omega_c)$。这导出了关于 $\\omega_c$ 的二次方程：\n$$\n\\frac{1}{2}\\,\\mathcal{J}_0\\,\\alpha\\,\\omega_c^2 + i_a\\,\\omega_c - E_{\\text{align}} = 0\n$$\n物理上相关的（正）解在问题陈述中给出。对于 $\\alpha=0$ 的特殊情况，得到 $\\omega_c = E_{\\text{align}}/i_a$。\n\n为了量化交叉前后的变化，我们在两个频率窗口上对 $\\mathcal{J}^{(1)}$ 和 $\\mathcal{J}^{(2)}$ 进行平均：一个交叉前窗口 $[\\omega_c - w, \\omega_c - \\varepsilon]$ 和一个交叉后窗口 $[\\omega_c + \\varepsilon, \\omega_c + w]$。参数 $w$ 和 $\\varepsilon$ 定义了窗口的宽度以及在 $\\omega_c$ 周围排除的区域，在该区域混合相互作用最强。物理量 $Q(\\omega)$ 的变化随后计算为平均值之差：\n$$\n\\Delta Q = \\langle Q(\\omega)\\rangle_{\\text{post}} - \\langle Q(\\omega)\\rangle_{\\text{pre}}\n$$\n算法流程如下：对于每个参数集，建立一个均匀的频率网格。然后，计算 $E_A'(\\omega)$ 和 $E_B'(\\omega)$ 的数组，接着计算 $E'_-(\\omega)$。通过 `numpy.gradient` 进行两次数值微分，以获得 $I(\\omega)$ 和 $\\mathcal{J}^{(2)}(\\omega)$。$\\mathcal{J}^{(1)}(\\omega)$ 通过除法得到。计算交叉频率 $\\omega_c$，并使用布尔掩码数组来识别交叉前和交叉后窗口内的网格点。最后，使用 `numpy.mean` 计算这些窗口上的平均值，它们的差值即为最终结果。对每个提供的测试用例重复整个过程。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the simulation for all test cases and print the results.\n    \"\"\"\n\n    test_cases = [\n        # (J0, alpha, i_a, E_align, V, w_min, w_max, dw, w, eps)\n        (30.0, 0.12, 6.0, 1.20, 0.05, 0.02, 0.80, 0.002, 0.06, 0.01), # Case 1\n        (30.0, 0.12, 6.0, 1.20, 0.00, 0.02, 0.80, 0.002, 0.06, 0.01), # Case 2\n        (30.0, 0.12, 6.0, 1.20, 0.20, 0.02, 0.80, 0.002, 0.06, 0.01), # Case 3\n        (28.0, 0.05, 10.0, 1.50, 0.08, 0.02, 0.80, 0.002, 0.06, 0.01), # Case 4\n    ]\n\n    results = []\n    for params in test_cases:\n        result = calculate_crossing_changes(params)\n        results.append(result)\n\n    # Format the output string to be exactly [[dJ1_1,dJ2_1],[dJ1_2,dJ2_2],...]\n    # without any extra spaces, as per the example format.\n    inner_parts = [f\"[{res[0]},{res[1]}]\" for res in results]\n    final_output = f\"[{','.join(inner_parts)}]\"\n    print(final_output)\n\ndef calculate_crossing_changes(params):\n    \"\"\"\n    Calculates the change in kinematic and dynamic moments of inertia\n    across a band crossing for a single set of parameters.\n    \n    Args:\n        params (tuple): A tuple containing all model and grid parameters.\n\n    Returns:\n        list: A list containing [delta_J1, delta_J2].\n    \"\"\"\n    J0, alpha, i_a, E_align, V, w_min, w_max, dw, w, eps = params\n\n    # 1. Construct the frequency grid.\n    omega = np.arange(w_min, w_max + dw, dw)\n\n    # 2. Calculate the diabatic Routhians for the two bands.\n    E_A_prime = -0.5 * J0 * omega**2\n    E_B_prime = E_align - omega * i_a - 0.5 * J0 * (1.0 + alpha) * omega**2\n\n    # 3. Calculate the yrast Routhian (lower eigenvalue of the 2x2 H' matrix).\n    sum_E = E_A_prime + E_B_prime\n    diff_E = E_A_prime - E_B_prime\n    E_minus_prime = 0.5 * (sum_E - np.sqrt(diff_E**2 + 4.0 * V**2))\n\n    # 4. Calculate the total aligned angular momentum I(omega) = -dE'/d(omega).\n    I = -np.gradient(E_minus_prime, dw)\n\n    # 5. Calculate the kinematic and dynamic moments of inertia.\n    # omega_min > 0 ensures no division by zero for J1.\n    J1 = I / omega      # Kinematic moment of inertia, J^(1)\n    J2 = np.gradient(I, dw)  # Dynamic moment of inertia, J^(2)\n\n    # 6. Calculate the diabatic crossing frequency omega_c.\n    if alpha == 0.0:\n        # If alpha is 0, the equation for omega_c is linear.\n        if i_a > 0.0:\n            omega_c = E_align / i_a\n        else:\n            # Physically, i_a must be positive for this simple model to make sense.\n            # Avoid division by zero, though test cases do not trigger this.\n            omega_c = np.nan\n    else:\n        # For alpha > 0, solve the quadratic equation for omega_c:\n        # 0.5*J0*alpha*w^2 + i_a*w - E_align = 0\n        a = 0.5 * J0 * alpha\n        b = i_a\n        c = -E_align\n        discriminant = b**2 - 4.0 * a * c\n        # The physically relevant solution corresponds to a positive frequency.\n        omega_c = (-b + np.sqrt(discriminant)) / (2.0 * a)\n\n    # 7. Define the pre- and post-crossing analysis windows.\n    pre_window_mask = (omega >= omega_c - w)  (omega = omega_c - eps)\n    post_window_mask = (omega >= omega_c + eps)  (omega = omega_c + w)\n    \n    # 8. Calculate the average values in the windows.\n    # Use np.mean, which correctly handles cases where a window might be empty\n    # (by returning NaN), although this is not expected with the given parameters.\n    avg_J1_pre = np.mean(J1[pre_window_mask])\n    avg_J1_post = np.mean(J1[post_window_mask])\n    \n    avg_J2_pre = np.mean(J2[pre_window_mask])\n    avg_J2_post = np.mean(J2[post_window_mask])\n\n    # 9. Compute the changes Delta J^(1) and Delta J^(2).\n    delta_J1 = avg_J1_post - avg_J1_pre\n    delta_J2 = avg_J2_post - avg_J2_pre\n\n    return [delta_J1, delta_J2]\n\nif __name__ == '__main__':\n    solve()\n```", "id": "3550162"}]}