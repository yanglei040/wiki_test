{"hands_on_practices": [{"introduction": "在真实的原子核中，质子和中子是不同的粒子，并且质子之间通过长程库仑力相互作用。这个练习 [@problem_id:3555821] 将指导你推导一个双组分系统的耦合哈特里-福克方程。你将看到库仑相互作用的直接（哈特里）项和交换（福克）项如何被纳入平均场势中，这为大多数核哈特里-福克计算提供了基础模型。", "problem": "考虑有限原子核中的一个由核子组成的双组分系统：质子和中子。设质子的单粒子轨道为 $\\{\\phi_{p,i}(\\mathbf{r},\\sigma)\\}$，中子的单粒子轨道为 $\\{\\phi_{n,i}(\\mathbf{r},\\sigma)\\}$，其中 $\\sigma$ 表示自旋坐标，$i$ 是已占据轨道的索引。总能量泛函建模为动能、核相互作用贡献以及质子-质子库仑相互作用之和，后者被分解为一个经典的 Hartree (直接) 部分和一个 Fock (交换) 部分的 Slater 局域密度近似。具体来说，取\n$$\nE[\\{\\phi_{p,i}\\},\\{\\phi_{n,i}\\}] \\;=\\; \\sum_{i\\in \\text{occ}} \\left\\langle \\phi_{p,i} \\left| -\\frac{\\hbar^2}{2m_p}\\nabla^2 \\right| \\phi_{p,i} \\right\\rangle \\;+\\; \\sum_{i\\in \\text{occ}} \\left\\langle \\phi_{n,i} \\left| -\\frac{\\hbar^2}{2m_n}\\nabla^2 \\right| \\phi_{n,i} \\right\\rangle \\;+\\; E_{\\text{N}}[\\rho_p,\\rho_n] \\;+\\; E_{\\text{C}}^{\\text{dir}}[\\rho_p] \\;+\\; E_{\\text{C}}^{\\text{x}}[\\rho_p],\n$$\n其中局域密度为\n$$\n\\rho_p(\\mathbf{r}) \\;=\\; \\sum_{i\\in \\text{occ}} \\sum_{\\sigma} |\\phi_{p,i}(\\mathbf{r},\\sigma)|^2, \n\\qquad\n\\rho_n(\\mathbf{r}) \\;=\\; \\sum_{i\\in \\text{occ}} \\sum_{\\sigma} |\\phi_{n,i}(\\mathbf{r},\\sigma)|^2,\n$$\n核相互作用能 $E_{\\text{N}}[\\rho_p,\\rho_n]$ 是 $(\\rho_p,\\rho_n)$ 的可微泛函，代表短程强相互作用（例如，Skyrme 型能量密度泛函），质子-质子库仑 Hartree 能量为\n$$\nE_{\\text{C}}^{\\text{dir}}[\\rho_p] \\;=\\; \\frac{e^2}{2} \\int d^3\\mathbf{r} \\int d^3\\mathbf{r}' \\; \\frac{\\rho_p(\\mathbf{r})\\,\\rho_p(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|},\n$$\n以及对库仑交换能的 Slater 局域密度近似为\n$$\nE_{\\text{C}}^{\\text{x}}[\\rho_p] \\;=\\; -\\frac{3}{4}\\,e^2 \\left(\\frac{3}{\\pi}\\right)^{1/3} \\int d^3\\mathbf{r} \\; [\\rho_p(\\mathbf{r})]^{4/3}.\n$$\n使用不同的拉格朗日乘子 $\\lambda_p$ 和 $\\lambda_n$ 对质子和中子施加独立的粒子数约束：\n$$\n\\int d^3\\mathbf{r}\\;\\rho_p(\\mathbf{r}) \\;=\\; N_p, \n\\qquad \n\\int d^3\\mathbf{r}\\;\\rho_n(\\mathbf{r}) \\;=\\; N_n.\n$$\n任务：\n1) 从能量泛函在上述约束下的作用量驻点原理出发，推导质子和中子的 Hartree-Fock (HF) 单粒子方程。将质子平均场势表示为通过对 $\\rho_p(\\mathbf{r})$ 进行泛函微分得到的核势、库仑直接势和 Slater 交换势的局域贡献之和。类似地，写出中子的 HF 方程，注意其中不含库仑项。\n2) 在局域密度近似下，考虑一个球形偶偶核的内部，在此区域质子费米能级轨道有显著分布，质子密度可被视为近似恒定，其值为 $\\rho_{p,0}$。将库仑交换作用视为一个加到质子单粒子哈密顿量中的局域势 $V_{\\text{C}}^{\\text{x}}(\\mathbf{r})$。推导质子费米能的交换诱导移动 $\\Delta \\epsilon_{F,p}$ 的解析表达式，该移动定义为在保持所有其他贡献固定的情况下，开启 $E_{\\text{C}}^{\\text{x}}[\\rho_p]$ 时 $\\epsilon_{F,p}$ 的变化。将你的最终答案表示为包含 $e$ 和 $\\rho_{p,0}$ 的闭合形式解析表达式。不需要进行数值计算。\n你的最终答案必须是单一的解析表达式。如果引入物理常数或密度，请保持其符号形式。不要在最终的方框答案中包含单位。", "solution": "该问题是有效的，因为它提法严谨，科学上基于量子力学和核物理原理（特别是平均场理论和密度泛函理论），并使用了精确、客观的定义。它没有违反任何指定的无效标准。我们继续进行求解。\n\n### 任务1：Hartree-Fock 方程的推导\n\nHartree-Fock (HF) 方程是通过对总能量泛函 $E$ 应用变分原理推导出来的，并受到单粒子轨道保持正交归一的约束。这是通过最小化泛函 $\\mathcal{L} = E - \\sum_{\\alpha \\in \\{p,n\\}} \\sum_{i,j \\in \\text{occ}} \\epsilon_{\\alpha,ij} (\\langle \\phi_{\\alpha,i} | \\phi_{\\alpha,j} \\rangle - \\delta_{ij})$ 实现的，其中 $\\epsilon_{\\alpha,ij}$ 是拉格朗日乘子。对给定类型（质子或中子）的已占据轨道进行幺正变换，可以使拉格朗日乘子矩阵对角化，而总能量不变，因为它只依赖于总密度。因此，我们可以将问题简化为在 $\\langle \\phi_{\\alpha,i} | \\phi_{\\alpha,i} \\rangle = 1$ 的约束下最小化 $E$，这导出了典则 HF 方程：\n$$\n\\frac{\\delta E}{\\delta \\phi_{\\alpha,i}^*(\\mathbf{r},\\sigma)} = \\epsilon_{\\alpha,i} \\phi_{\\alpha,i}(\\mathbf{r},\\sigma)\n$$\n其中 $\\epsilon_{\\alpha,i}$ 是单粒子能量。\n\n我们将分别推导质子和中子的方程。\n\n**质子 Hartree-Fock 方程：**\n\n我们计算总能量 $E$ 相对于质子轨道 $\\phi_{p,i}^*(\\mathbf{r},\\sigma)$ 的泛函导数。\n\n1. **动能项：**\n质子动能为 $E_{\\text{kin},p} = \\sum_{j\\in \\text{occ}} \\left\\langle \\phi_{p,j} \\left| -\\frac{\\hbar^2}{2m_p}\\nabla^2 \\right| \\phi_{p,j} \\right\\rangle$。其相对于 $\\phi_{p,i}^*$ 的泛函导数为：\n$$\n\\frac{\\delta E_{\\text{kin},p}}{\\delta \\phi_{p,i}^*(\\mathbf{r},\\sigma)} = -\\frac{\\hbar^2}{2m_p}\\nabla^2 \\phi_{p,i}(\\mathbf{r},\\sigma)\n$$\n中子动能项 $E_{\\text{kin},n}$ 与 $\\phi_{p,i}$ 无关，因此其导数为零。\n\n2. **密度依赖项：**\n其余项 $E_{\\text{N}}$、$E_{\\text{C}}^{\\text{dir}}$ 和 $E_{\\text{C}}^{\\text{x}}$ 是密度 $\\rho_p$ 和 $\\rho_n$ 的泛函。我们使用泛函微分的链式法则。首先，我们求质子密度 $\\rho_p(\\mathbf{r}')$ 相对于 $\\phi_{p,i}^*(\\mathbf{r},\\sigma)$ 的导数：\n$$\n\\rho_p(\\mathbf{r}') = \\sum_{j\\in \\text{occ}} \\sum_{\\sigma'} \\phi_{p,j}^*(\\mathbf{r}',\\sigma')\\phi_{p,j}(\\mathbf{r}',\\sigma')\n$$\n$$\n\\frac{\\delta \\rho_p(\\mathbf{r}')}{\\delta \\phi_{p,i}^*(\\mathbf{r},\\sigma)} = \\phi_{p,i}(\\mathbf{r}',\\sigma) \\delta(\\mathbf{r}-\\mathbf{r}')\n$$\n对于一个一般的能量泛函 $E_{int}[\\rho_p]$，其导数为：\n$$\n\\frac{\\delta E_{int}[\\rho_p]}{\\delta \\phi_{p,i}^*(\\mathbf{r},\\sigma)} = \\int d^3\\mathbf{r}' \\frac{\\delta E_{int}}{\\delta \\rho_p(\\mathbf{r}')} \\frac{\\delta \\rho_p(\\mathbf{r}')}{\\delta \\phi_{p,i}^*(\\mathbf{r},\\sigma)} = \\int d^3\\mathbf{r}' \\frac{\\delta E_{int}}{\\delta \\rho_p(\\mathbf{r}')} \\phi_{p,i}(\\mathbf{r}',\\sigma) \\delta(\\mathbf{r}-\\mathbf{r}') = \\frac{\\delta E_{int}}{\\delta \\rho_p(\\mathbf{r})} \\phi_{p,i}(\\mathbf{r},\\sigma)\n$$\n这就定义了与 $E_{int}$ 相对应的局域势。我们将此应用于三个相互作用项中的每一个。\n\na) **核势：** 来自核能量泛函的贡献为 $U_{N,p}(\\mathbf{r}) \\phi_{p,i}(\\mathbf{r},\\sigma)$，其中局域势为：\n$$\nU_{N,p}(\\mathbf{r}) = \\frac{\\delta E_{\\text{N}}[\\rho_p, \\rho_n]}{\\delta \\rho_p(\\mathbf{r})}\n$$\n\nb) **库仑直接 (Hartree) 势：** 对于 $E_{\\text{C}}^{\\text{dir}}[\\rho_p] = \\frac{e^2}{2} \\int d^3\\mathbf{r}' \\int d^3\\mathbf{r}'' \\frac{\\rho_p(\\mathbf{r}')\\,\\rho_p(\\mathbf{r}'')}{|\\mathbf{r}'-\\mathbf{r}''|}$，泛函导数为：\n$$\nV_{\\text{C}}^{\\text{dir}}(\\mathbf{r}) = \\frac{\\delta E_{\\text{C}}^{\\text{dir}}}{\\delta \\rho_p(\\mathbf{r})} = \\frac{e^2}{2} \\int d^3\\mathbf{r}' \\left( \\frac{\\rho_p(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|} + \\frac{\\rho_p(\\mathbf{r}')}{|\\mathbf{r}'-\\mathbf{r}|} \\right) = e^2 \\int d^3\\mathbf{r}' \\frac{\\rho_p(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}\n$$\n\nc) **库仑交换 (Slater) 勢：** 对于 $E_{\\text{C}}^{\\text{x}}[\\rho_p] = -\\frac{3}{4}e^2 \\left(\\frac{3}{\\pi}\\right)^{1/3} \\int d^3\\mathbf{r}' [\\rho_p(\\mathbf{r}')]^{4/3}$，泛函导数为：\n$$\nV_{\\text{C}}^{\\text{x}}(\\mathbf{r}) = \\frac{\\delta E_{\\text{C}}^{\\text{x}}}{\\delta \\rho_p(\\mathbf{r})} = -\\frac{3}{4}e^2 \\left(\\frac{3}{\\pi}\\right)^{1/3} \\cdot \\frac{4}{3} [\\rho_p(\\mathbf{r})]^{1/3} = -e^2 \\left(\\frac{3}{\\pi}\\right)^{1/3} [\\rho_p(\\mathbf{r})]^{1/3}\n$$\n\n**组合质子 HF 方程：**\n结合所有项，轨道 $\\phi_{p,i}$ 中质子的 HF 方程为：\n$$\n\\left[ -\\frac{\\hbar^2}{2m_p}\\nabla^2 + U_p(\\mathbf{r}) \\right] \\phi_{p,i}(\\mathbf{r},\\sigma) = \\epsilon_{p,i} \\phi_{p,i}(\\mathbf{r},\\sigma)\n$$\n其中总的质子平均场势 $U_p(\\mathbf{r})$ 是核势、库仑直接势和库仑交换势部分之和：\n$$\nU_p(\\mathbf{r}) = U_{N,p}(\\mathbf{r}) + V_{\\text{C}}^{\\text{dir}}(\\mathbf{r}) + V_{\\text{C}}^{\\text{x}}(\\mathbf{r})\n$$\n各个势如上所述推导。\n\n**中子 Hartree-Fock 方程：**\n\n中子 HF 方程的推导是类似的。我们取总能量 $E$ 相对于中子轨道 $\\phi_{n,i}^*(\\mathbf{r},\\sigma)$ 的泛函导数。\n\n1. **动能项：** $E_{\\text{kin},n}$ 的导数给出 $-\\frac{\\hbar^2}{2m_n}\\nabla^2 \\phi_{n,i}(\\mathbf{r},\\sigma)$。质子动能项与 $\\phi_{n,i}$ 无关。\n\n2. **相互作用项：** 库仑项 $E_{\\text{C}}^{\\text{dir}}$ 和 $E_{\\text{C}}^{\\text{x}}$ 仅依赖于质子密度 $\\rho_p$，因此它们相对于 $\\phi_{n,i}^*$ 的导数为零。只有核能量泛函 $E_{\\text{N}}[\\rho_p, \\rho_n]$ 依赖于中子密度 $\\rho_n$。相应的势为：\n$$\nU_n(\\mathbf{r}) = \\frac{\\delta E_{\\text{N}}[\\rho_p, \\rho_n]}{\\delta \\rho_n(\\mathbf{r})}\n$$\n\n**组合中子 HF 方程：**\n轨道 $\\phi_{n,i}$ 中中子的 HF 方程为：\n$$\n\\left[ -\\frac{\\hbar^2}{2m_n}\\nabla^2 + U_n(\\mathbf{r}) \\right] \\phi_{n,i}(\\mathbf{r},\\sigma) = \\epsilon_{n,i} \\phi_{n,i}(\\mathbf{r},\\sigma)\n$$\n其中中子平均场势 $U_n(\\mathbf{r})$ 只包含核的贡献，因为中子不参与库仑相互作用。通过填充最低的 $N_p/2$ 个质子轨道和 $N_n/2$ 个中子轨道（对于自旋饱和系统），可以满足对 $N_p$ 和 $N_n$ 的粒子数约束。问题陈述中提到的拉格朗日乘子 $\\lambda_p$ 和 $\\lambda_n$ 分别对应于质子和中子系统的费米能（化学势）。\n\n### 任务2：质子费米能的移动\n\n第二个任务是求出质子费米能的交换诱导移动 $\\Delta \\epsilon_{F,p}$。我们需要假设质子密度恒定，$\\rho_p(\\mathbf{r}) = \\rho_{p,0}$，这对于重核内部（均匀核物质）是一个很好的近似。\n\n来自任务1的质子单粒子哈密顿量为 $h_p = T_p + U_p$，其中 $T_p = -\\frac{\\hbar^2}{2m_p}\\nabla^2$。交换势由 $V_{\\text{C}}^{\\text{x}}(\\mathbf{r}) = -e^2 \\left(\\frac{3}{\\pi}\\right)^{1/3} [\\rho_p(\\mathbf{r})]^{1/3}$ 给出。\n\n在质子密度恒定 $\\rho_{p,0}$ 的近似下，交换势 $V_{\\text{C}}^{\\text{x}}(\\mathbf{r})$ 变成一个空间上的常数值：\n$$\nV_{\\text{C}}^{\\text{x}} = -e^2 \\left(\\frac{3}{\\pi}\\right)^{1/3} [\\rho_{p,0}]^{1/3}\n$$\n问题要求计算在“开启”交换能贡献 $E_{\\text{C}}^{\\text{x}}$，同时保持其他贡献不变时，质子费米能 $\\epsilon_{F,p}$ 的移动。这等价于将势 $V_{\\text{C}}^{\\text{x}}$ 添加到不包含它的单粒子哈密顿量中。\n\n将一个常数势 $V_0$ 添加到一个哈密顿量 $H_0$ 中，会使其所有的能量本征值移动一个相同的常数量：\n若 $H_0|\\psi\\rangle = E|\\psi\\rangle$，则 $(H_0 + V_0)|\\psi\\rangle = (E + V_0)|\\psi\\rangle$。\n\n因此，每个质子单粒子能级（包括费米能级，即最高占据能级）的能量都会移动一个等于该交换势常数值的量。因此，质子费米能的交换诱导移动 $\\Delta \\epsilon_{F,p}$ 等于这个常数势。\n$$\n\\Delta \\epsilon_{F,p} = V_{\\text{C}}^{\\text{x}}(\\rho_{p,0}) = -e^2 \\left(\\frac{3}{\\pi}\\right)^{1/3} \\rho_{p,0}^{1/3}\n$$\n这个表达式代表了在密度为 $\\rho_{p,0}$ 的均匀质子气体中，由库仑交换相互作用引起的质子化学势的变化。负号表示交换相互作用是吸引的，它降低了单粒子能量。", "answer": "$$\n\\boxed{-e^2 \\left(\\frac{3}{\\pi}\\right)^{1/3} \\rho_{p,0}^{1/3}}\n$$", "id": "3555821"}, {"introduction": "虽然哈特里势是局域的，但由泡利原理产生的关键交换（福克）势对于有限程相互作用来说是非局域的，这使得哈特里-福克微分方程转变为一个积分-微分方程。这个练习 [@problem_id:3555805] 深入探讨了这种非局域交换核在一种实际的戈尼（Gogny）型相互作用下的结构。它要求你设计一种高效的数值策略，包括高斯求积和低秩近似，以处理该积分算符的计算成本，从而将形式理论与高性能计算联系起来。", "problem": "考虑一个由单粒子轨道的 Slater 行列式描述的核子系统，该系统由一个具有有限程、中心二体相互作用的非相对论性多体 Hamiltonian 控制。目标是从第一性原理出发，推导 Hartree-Fock (HF) 方程中的非局域交换核，并设计一种高效的计算策略来评估由此产生的积分算符。\n\n从以下基础出发：\n- 第一量子化中的多体 Hamiltonian 由下式给出\n$$\n\\hat{H}=\\sum_{i=1}^{A}\\hat{t}(i)+\\frac{1}{2}\\sum_{i\\neq j}\\hat{v}(i,j),\n$$\n其中 $A$ 是粒子数，$\\hat{t}(i)$ 是单体动能算符，$\\hat{v}(i,j)$ 是一个仅依赖于相对坐标的、具有平移不变性的有限程二体相互作用。\n- 基态由单个 Slater 行列式近似，并在单粒子轨道的正交归一性约束下应用 Ritz 变分原理。\n- 单体密度矩阵定义为\n$$\n\\rho(\\mathbf{r},\\mathbf{r}')=\\sum_{\\alpha \\in \\text{occ}} \\varphi_{\\alpha}(\\mathbf{r})\\,\\varphi_{\\alpha}^{*}(\\mathbf{r}'),\n$$\n其中求和遍及所有占据轨道。\n\n假设二体相互作用是有限程的中心相互作用，类型为 Gogny 型（此处限制为与自旋-同位旋无关的中心形式），\n$$\nv(\\mathbf{r}_1,\\mathbf{r}_2)=\\sum_{k=1}^{K} A_k \\exp\\!\\left(-\\frac{|\\mathbf{r}_1-\\mathbf{r}_2|^2}{\\mu_k^2}\\right),\n$$\n具有 $K\\in\\mathbb{N}$ 个 Gaussian 分量，振幅 $A_k>0$，程长 $\\mu_k>0$。\n\n任务：\n1. 仅使用上述基础，推导用于闭壳层的 Hartree-Fock 方程的交换贡献，不考虑自旋-轨道或自旋-交换项。证明单粒子方程可以写成如下形式的积分-微分方程\n$$\n\\left[\\hat{t}+U_{\\mathrm{H}}(\\mathbf{r})\\right]\\varphi_i(\\mathbf{r})+\\int d^3\\mathbf{r}'\\,U(\\mathbf{r},\\mathbf{r}')\\,\\varphi_i(\\mathbf{r}')=\\varepsilon_i\\,\\varphi_i(\\mathbf{r}),\n$$\n为所述的有限程中心相互作用，识别出非局域交换核 $U(\\mathbf{r},\\mathbf{r}')$，并用单体密度矩阵和 $v(\\mathbf{r},\\mathbf{r}')$ 将其显式表达。不要假定任何已知的 HF 方程公式；从变分原理和 Slater 行列式的反对称性出发进行推导。\n2. 提出一种计算策略，以高效地评估非局域交换算符在给定测试函数上的作用：\n   - 为测试和验证，简化为坐标 $x\\in\\mathbb{R}$ 的一维模拟，保持相同的有限程中心结构 $g(x-x')=\\sum_{k=1}^{K} A_k \\exp\\!\\left(-\\frac{(x-x')^2}{\\mu_k^2}\\right)$。\n   - 在有限区间 $[-X_{\\max},X_{\\max}]$ 上使用具有 $N$ 个节点的 Gaussian 求积法 (Gauss-Legendre) 来近似积分。如果 $\\{\\xi_j,w_j^{\\text{GL}}\\}_{j=1}^{N}$ 是 $[-1,1]$ 上的 Gauss-Legendre 节点和权重，将它们映射到 $x_j=X_{\\max}\\xi_j$（权重为 $w_j=X_{\\max}w_j^{\\text{GL}}$）以近似\n     $$\n     \\int_{-X_{\\max}}^{X_{\\max}} f(x)\\,dx \\approx \\sum_{j=1}^{N} w_j f(x_j).\n     $$\n   - 将占据轨道定义为归一化的一维谐振子本征函数，振子长度为 $b>0$，\n     $$\n     \\phi_n(x)=\\frac{1}{\\sqrt{2^n n!}}\\frac{1}{\\pi^{1/4}\\,b^{1/2}}\\,H_n\\!\\left(\\frac{x}{b}\\right)\\exp\\!\\left(-\\frac{x^2}{2b^2}\\right),\\quad n\\in\\mathbb{N},\n     $$\n     其中 $H_n$ 是物理学家的 Hermite 多项式。\n   - 取占据集为 $n\\in\\{0,1\\}$，并定义单体密度矩阵\n     $$\n     \\rho(x,x')=\\sum_{n\\in\\{0,1\\}} \\phi_n(x)\\,\\phi_n(x').\n     $$\n   - 使用您推导的交换核表达式，构建一维的非局域交换核 $U(x,x')$，并通过 Gaussian 求积法近似交换作用于给定测试函数 $\\psi(x)$ 的结果。\n   - 提出并实现一种离散化交换算符的低秩近似方法，该方法基于对由核函数和求积权重构建的对称半正定矩阵进行特征分解并截断。解释截断秩 $r\\in\\mathbb{N}$ 如何控制精度和成本，并提供将该方法高效应用于向量的最终公式。\n\n3. 按照下文“最终输出格式”的规定，在单个程序中实现以上内容。所有数值输出均为无量纲。\n\n您的程序要使用的测试套件：\n- 情况 A (理想情况): $N=80$, $X_{\\max}=8.0$, $b=1.2$, $K=2$, 相互作用参数 $\\{(A_1,\\mu_1),(A_2,\\mu_2)\\}=\\{(500.0,0.7),(300.0,1.3)\\}$, 截断秩 $r=6$。测试函数 $\\psi(x)=\\phi_2(x)+0.5\\,\\phi_3(x)$。输出直接求积应用和低秩应用作用于 $\\psi$ 之间的相对 $L^2$ 误差。\n- 情况 B (边界情况: 窄程): $N=120$, $X_{\\max}=8.0$, $b=1.0$, $K=2$, 相互作用参数 $\\{(800.0,0.3),(200.0,0.6)\\}$, 截断秩 $r=10$。相同的 $\\psi(x)$。输出相对 $L^2$ 误差。\n- 情况 C (极端情况: 极低秩): 与情况 A 相同，但截断秩 $r=1$。输出相对 $L^2$ 误差。\n- 情况 D (一致性检查: 对称性): $N=60$, $X_{\\max}=6.0$, $b=1.0$, $K=2$, 相互作用参数 $\\{(500.0,0.7),(300.0,1.3)\\}$。计算比率\n  $$\n  \\frac{\\|U-U^{\\mathsf{T}}\\|_{\\mathrm{F}}}{\\|U\\|_{\\mathrm{F}}},\n  $$\n  其中 $U$ 是求积节点上的离散化核矩阵，其元素为 $U_{ij}=U(x_i,x_j)$，$\\|\\cdot\\|_{\\mathrm{F}}$ 表示 Frobenius 范数。输出此比率。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含按顺序排列的结果 $[\\text{情况 A 结果},\\text{情况 B 结果},\\text{情况 C 结果},\\text{情况 D 结果}]$，形式为方括号内以逗号分隔的列表。所有输出均为无量纲实数。不涉及角度。不需要物理单位。程序不得读取任何输入，也不得打印任何其他内容。", "solution": "当前的任务是从第一性原理推导 Hartree-Fock (HF) 方程的非局域交换项，并开发相应的计算方法。我们首先进行推导，然后阐述数值策略。\n\n**第 1 部分：Hartree-Fock 交换核的推导**\n\n起点是一个由 $A$ 个相同的非相对论性费米子（核子）组成的系统，其在第一量子化下的 Hamiltonian 为：\n$$\n\\hat{H}=\\sum_{i=1}^{A}\\hat{t}(i)+\\frac{1}{2}\\sum_{i\\neq j}^{A}\\hat{v}(i,j)\n$$\n其中 $\\hat{t}(i) = -\\frac{\\hbar^2}{2m}\\nabla_i^2$ 是粒子 $i$ 的动能算符，$\\hat{v}(i,j)$ 是一个二体相互作用势。问题指定了一个中心、平移不变的相互作用，因此 $\\hat{v}(i,j) = v(|\\mathbf{r}_i - \\mathbf{r}_j|)$。按照指示，为简单起见，我们忽略了自旋和同位旋自由度。\n\n系统的基态由单个 Slater 行列式 $|\\Psi\\rangle$ 近似，该行列式由一组 $A$ 个正交归一的单粒子轨道 $\\{\\varphi_\\alpha(\\mathbf{r})\\}_{\\alpha=1}^A$ 构成：\n$$\n|\\Psi\\rangle = \\frac{1}{\\sqrt{A!}} \\det[\\varphi_{\\alpha_i}(\\mathbf{r}_j)]\n$$\n正交归一性条件是 $\\langle\\varphi_\\alpha|\\varphi_\\beta\\rangle = \\int d^3\\mathbf{r}\\,\\varphi_\\alpha^*(\\mathbf{r})\\varphi_\\beta(\\mathbf{r}) = \\delta_{\\alpha\\beta}$。\n\n根据 Ritz 变分原理，通过最小化能量期望值 $E = \\langle\\Psi|\\hat{H}|\\Psi\\rangle$（关于轨道），并满足正交归一性约束，可以找到基态能量和轨道的最佳近似。\n\n使用 Slater-Condon 规则，Slater 行列式的 Hamiltonian 期望值为：\n$$\nE[\\{\\varphi_\\alpha\\}] = \\sum_{\\alpha=1}^{A} \\langle\\varphi_\\alpha|\\hat{t}|\\varphi_\\alpha\\rangle + \\frac{1}{2}\\sum_{\\alpha,\\beta=1}^{A} \\left( \\langle\\varphi_\\alpha\\varphi_\\beta|\\hat{v}|\\varphi_\\alpha\\varphi_\\beta\\rangle - \\langle\\varphi_\\alpha\\varphi_\\beta|\\hat{v}|\\varphi_\\beta\\varphi_\\alpha\\rangle \\right)\n$$\n第一项是总动能。第二项包含直接 (Hartree) 和交换 (Fock) 相互作用能。用积分表示，能量泛函为：\n$$\nE = \\sum_{\\alpha} \\int d^3\\mathbf{r}\\,\\varphi_\\alpha^*(\\mathbf{r})\\hat{t}\\varphi_\\alpha(\\mathbf{r}) + \\frac{1}{2}\\sum_{\\alpha,\\beta} \\iint d^3\\mathbf{r}_1 d^3\\mathbf{r}_2\\, \\varphi_\\alpha^*(\\mathbf{r}_1)\\varphi_\\beta^*(\\mathbf{r}_2)v(\\mathbf{r}_1,\\mathbf{r}_2)[\\varphi_\\alpha(\\mathbf{r}_1)\\varphi_\\beta(\\mathbf{r}_2) - \\varphi_\\beta(\\mathbf{r}_1)\\varphi_\\alpha(\\mathbf{r}_2)]\n$$\n此处，我们利用了 $\\hat{v}$ 在坐标空间中是一个简单的局域乘法算符 $v(\\mathbf{r}_1, \\mathbf{r}_2)$ 这一事实。\n\n为了在最小化过程中强制执行正交归一性约束，我们引入一个 Lagrange 乘子矩阵 $\\varepsilon_{\\beta\\alpha}$，并对以下泛函求极值：\n$$\nL[\\{\\varphi_\\alpha\\}] = E[\\{\\varphi_\\alpha\\}] - \\sum_{\\alpha,\\beta=1}^{A} \\varepsilon_{\\beta\\alpha} \\left( \\langle\\varphi_\\alpha|\\varphi_\\beta\\rangle - \\delta_{\\alpha\\beta} \\right)\n$$\n变分条件是 $L$ 对每个轨道（例如 $\\varphi_k^*$）的泛函导数为零：$\\frac{\\delta L}{\\delta \\varphi_k^*(\\mathbf{r})} = 0$，对于 $k \\in \\{1,\\dots,A\\}$。\n\n让我们计算各项关于 $\\varphi_k^*(\\mathbf{r})$ 的导数：\n1.  动能项：$\\frac{\\delta}{\\delta\\varphi_k^*(\\mathbf{r})} \\sum_{\\alpha} \\int d^3\\mathbf{r}'\\,\\varphi_\\alpha^*(\\mathbf{r}')\\hat{t}\\varphi_\\alpha(\\mathbf{r}') = \\hat{t}\\varphi_k(\\mathbf{r})$。\n2.  直接 (Hartree) 项：\n    $$\n    \\frac{\\delta}{\\delta\\varphi_k^*(\\mathbf{r})} \\frac{1}{2}\\sum_{\\alpha,\\beta} \\iint d^3\\mathbf{r}_1 d^3\\mathbf{r}_2\\, v(\\mathbf{r}_1,\\mathbf{r}_2)\\varphi_\\alpha^*(\\mathbf{r}_1)\\varphi_\\alpha(\\mathbf{r}_1)\\varphi_\\beta^*(\\mathbf{r}_2)\\varphi_\\beta(\\mathbf{r}_2)\n    $$\n    仅当 $\\alpha=k$ 时导数非零。由于求和在 $\\alpha, \\beta$ 上是对称的，因子 $1/2$ 被抵消。我们得到：\n    $$\n    \\sum_{\\beta} \\int d^3\\mathbf{r}_2\\, v(\\mathbf{r},\\mathbf{r}_2)\\varphi_\\beta^*(\\mathbf{r}_2)\\varphi_\\beta(\\mathbf{r}_2) \\varphi_k(\\mathbf{r}) = \\left[ \\int d^3\\mathbf{r}'\\, v(\\mathbf{r},\\mathbf{r}') \\sum_{\\beta} |\\varphi_\\beta(\\mathbf{r}')|^2 \\right] \\varphi_k(\\mathbf{r})\n    $$\n    识别出局域密度 $\\rho(\\mathbf{r}') = \\sum_\\beta |\\varphi_\\beta(\\mathbf{r}')|^2$，该项变为 $U_{\\mathrm{H}}(\\mathbf{r})\\varphi_k(\\mathbf{r})$，其中 $U_{\\mathrm{H}}(\\mathbf{r}) = \\int d^3\\mathbf{r}'\\, v(\\mathbf{r},\\mathbf{r}') \\rho(\\mathbf{r}')$ 是局域 Hartree 势。\n3.  交换 (Fock) 项：\n    $$\n    \\frac{\\delta}{\\delta\\varphi_k^*(\\mathbf{r})} \\left(-\\frac{1}{2}\\right)\\sum_{\\alpha,\\beta} \\iint d^3\\mathbf{r}_1 d^3\\mathbf{r}_2\\, v(\\mathbf{r}_1,\\mathbf{r}_2)\\varphi_\\alpha^*(\\mathbf{r}_1)\\varphi_\\beta(\\mathbf{r}_1)\\varphi_\\beta^*(\\mathbf{r}_2)\\varphi_\\alpha(\\mathbf{r}_2)\n    $$\n    关于 $\\varphi_k^*(\\mathbf{r})$ 的导数在 $\\alpha=k$ 或 $\\beta=k$ 时有贡献。我们设 $\\alpha=k$。\n    $$\n    -\\sum_{\\beta} \\int d^3\\mathbf{r}_2\\, v(\\mathbf{r},\\mathbf{r}_2)\\varphi_\\beta(\\mathbf{r})\\varphi_\\beta^*(\\mathbf{r}_2)\\varphi_k(\\mathbf{r}_2) = -\\int d^3\\mathbf{r}'\\, v(\\mathbf{r},\\mathbf{r}') \\left(\\sum_{\\beta} \\varphi_\\beta(\\mathbf{r})\\varphi_\\beta^*(\\mathbf{r}')\\right) \\varphi_k(\\mathbf{r}')\n    $$\n    我们识别出单体密度矩阵 $\\rho(\\mathbf{r},\\mathbf{r}') = \\sum_{\\beta \\in \\text{occ}} \\varphi_\\beta(\\mathbf{r})\\varphi_\\beta^*(\\mathbf{r}')$。因此，交换项为：\n    $$\n    -\\int d^3\\mathbf{r}'\\, v(\\mathbf{r},\\mathbf{r}') \\rho(\\mathbf{r},\\mathbf{r}') \\varphi_k(\\mathbf{r}')\n    $$\n4.  约束项：$\\frac{\\delta}{\\delta\\varphi_k^*(\\mathbf{r})} \\left( -\\sum_{\\alpha,\\beta} \\varepsilon_{\\beta\\alpha} \\langle\\varphi_\\alpha|\\varphi_\\beta\\rangle \\right) = -\\sum_{\\beta} \\varepsilon_{\\beta k} \\varphi_\\beta(\\mathbf{r})$。\n\n结合这些项，我们得到正则 Hartree-Fock 方程：\n$$\n\\hat{t}\\varphi_k(\\mathbf{r}) + U_{\\mathrm{H}}(\\mathbf{r})\\varphi_k(\\mathbf{r}) - \\int d^3\\mathbf{r}'\\, v(\\mathbf{r},\\mathbf{r}') \\rho(\\mathbf{r},\\mathbf{r}') \\varphi_k(\\mathbf{r}') = \\sum_{\\beta} \\varepsilon_{\\beta k} \\varphi_\\beta(\\mathbf{r})\n$$\nLagrange 乘子矩阵 $\\varepsilon_{\\beta k}$ 可以通过对轨道 $\\{\\varphi_\\alpha\\}$ 进行幺正变换来对角化，该变换使总能量 $E$ 和密度矩阵 $\\rho$ 保持不变。在这个对角基中，$\\varepsilon_{\\beta k} = \\varepsilon_k \\delta_{\\beta k}$，并且每个轨道 $i$ 的方程变得独立：\n$$\n\\hat{t}\\varphi_i(\\mathbf{r}) + U_{\\mathrm{H}}(\\mathbf{r})\\varphi_i(\\mathbf{r}) - \\int d^3\\mathbf{r}'\\, v(\\mathbf{r},\\mathbf{r}') \\rho(\\mathbf{r},\\mathbf{r}') \\varphi_i(\\mathbf{r}') = \\varepsilon_i \\varphi_i(\\mathbf{r})\n$$\n通过将非局域交换核 $U(\\mathbf{r},\\mathbf{r}')$ 识别为以下形式，此方程与所要求的形式 $[\\hat{t}+U_{\\mathrm{H}}(\\mathbf{r})]\\varphi_i(\\mathbf{r})+\\int d^3\\mathbf{r}'\\,U(\\mathbf{r},\\mathbf{r}')\\,\\varphi_i(\\mathbf{r}')=\\varepsilon_i\\,\\varphi_i(\\mathbf{r})$ 相匹配：\n$$\nU(\\mathbf{r},\\mathbf{r}') = -v(\\mathbf{r},\\mathbf{r}') \\rho(\\mathbf{r},\\mathbf{r}')\n$$\n对于指定的中心相互作用 $v(\\mathbf{r},\\mathbf{r}')=v(|\\mathbf{r}-\\mathbf{r}'|)$ 和实轨道 $\\varphi_\\alpha(\\mathbf{r})$（谐振子本征函数即为此情况），密度矩阵 $\\rho(\\mathbf{r},\\mathbf{r}') = \\sum_\\alpha \\varphi_\\alpha(\\mathbf{r})\\varphi_\\alpha(\\mathbf{r}')$ 是对称的，即 $\\rho(\\mathbf{r},\\mathbf{r}')=\\rho(\\mathbf{r}',\\mathbf{r})$。由于 $v$ 也是对称的，因此交换核 $U(\\mathbf{r},\\mathbf{r}')$ 是对称的。\n\n**第 2 部分：交换算符的计算策略**\n\n交换算符 $\\hat{U}_X$ 作用于函数 $\\psi(\\mathbf{r})$ 的结果由以下积分给出：\n$$\n(\\hat{U}_X \\psi)(\\mathbf{r}) = \\int d^3\\mathbf{r}'\\, U(\\mathbf{r},\\mathbf{r}') \\psi(\\mathbf{r}')\n$$\n我们现在为其在一维 ($1$D) 模拟中的数值评估制定一个策略。所有量都是其 $3$D 对应物的直接模拟。核函数为 $U(x,x') = -g(x-x')\\rho(x,x')$，其中 $g(x-x')$ 是一维相互作用，$\\rho(x,x')$ 是一维单体密度矩阵。\n\n**离散化：** 主要的数值挑战是积分的评估。我们使用 $N$ 点 Gauss-Legendre 求积规则对问题域 $[-X_{\\max}, X_{\\max}]$ 进行离散化。设 $\\{x_j, w_j\\}_{j=1}^N$ 是此区间上的求积节点和权重。$\\hat{U}_X$ 作用于测试函数 $\\psi(x)$ 在节点 $x_i$ 上的值，记为 $\\chi(x_i) = (\\hat{U}_X \\psi)(x_i)$，可近似为：\n$$\n\\chi(x_i) = \\int_{-X_{\\max}}^{X_{\\max}} U(x_i, x') \\psi(x') dx' \\approx \\sum_{j=1}^{N} w_j U(x_i, x_j) \\psi(x_j)\n$$\n这可以表示为矩阵-向量乘积。设 $\\mathbf{\\psi}$ 是元素为 $\\psi_j = \\psi(x_j)$ 的向量，$\\mathbf{\\chi}$ 是结果 $\\chi_i$ 的向量，$\\mathbf{U}$ 是元素为 $U_{ij} = U(x_i, x_j)$ 的矩阵。该操作为 $\\mathbf{\\chi} = \\mathbf{U} (\\mathbf{w} \\odot \\mathbf{\\psi})$，其中 $\\mathbf{w}$ 是权重向量，$\\odot$ 表示逐元素乘法。这种“直接”应用的计算成本为 $O(N^2)$。\n\n**低秩近似：** 对于大的 $N$，$O(N^2)$ 的成本可能过高。一种更有效的方法是构建算符的低秩近似。核 $U(x,x')$ 是对称的，但离散化的算符矩阵 $M_{ij} = w_j U(x_i, x_j)$ 不是。一个更好的出发点是具有以下元素的对称化矩阵 $\\mathbf{S}$：\n$$\nS_{ij} = \\sqrt{w_i} U(x_i, x_j) \\sqrt{w_j}\n$$\n该矩阵 $\\mathbf{S}$ 是实对称的。此外，它是负半定的。与核 $U(x,x')$ 相关的二次型是 $\\iint \\psi(x) U(x,x') \\psi(x') dx dx' = -\\iint \\psi(x) g(x-x') \\rho(x,x') \\psi(x') dx dx'$。由于 $g > 0$ 且 $\\rho$ 是一个半正定核，因此 $U$ 是一个负半定核，其离散化 $\\mathbf{S}$ 是一个负半定矩阵。\n\n作为一个对称矩阵，$\\mathbf{S}$ 允许进行谱分解 $\\mathbf{S} = \\mathbf{V} \\mathbf{\\Lambda} \\mathbf{V}^T$，其中 $\\mathbf{V}$ 是一个由特征向量组成的正交矩阵 $(\\mathbf{V}^T\\mathbf{V} = \\mathbf{I})$，$\\mathbf{\\Lambda}$ 是一个由实特征值 $\\lambda_k \\le 0$ 组成的对角矩阵。秩-$r$ 近似 $\\mathbf{S}^{(r)}$ 是通过仅保留与最大幅值特征值（即 $r$ 个最负的特征值）相对应的 $r$ 个特征对来构造的：\n$$\n\\mathbf{S}^{(r)} = \\sum_{k=1}^{r} \\lambda_k \\mathbf{v}_k \\mathbf{v}_k^T = \\mathbf{V}_r \\mathbf{\\Lambda}_r \\mathbf{V}_r^T\n$$\n其中 $\\mathbf{V}_r$ 是一个由主要特征向量组成的 $N \\times r$ 矩阵，$\\mathbf{\\Lambda}_r$ 是一个由主要特征值组成的 $r \\times r$ 对角矩阵。\n\n现在可以高效地计算算符的作用。直接作用可以用 $\\mathbf{S}$ 重写如下：\n$$\n\\chi_i = \\sum_j w_j \\frac{S_{ij}}{\\sqrt{w_i}\\sqrt{w_j}} \\psi_j = \\frac{1}{\\sqrt{w_i}} \\sum_j S_{ij} \\sqrt{w_j} \\psi_j\n$$\n令 $\\tilde{\\psi}_j = \\sqrt{w_j} \\psi_j$，则有 $\\chi_i = \\frac{1}{\\sqrt{w_i}} (\\mathbf{S}\\tilde{\\mathbf{\\psi}})_i$。低秩近似则为：\n$$\n\\chi_i^{(r)} = \\frac{1}{\\sqrt{w_i}} (\\mathbf{S}^{(r)}\\tilde{\\mathbf{\\psi}})_i = \\frac{1}{\\sqrt{w_i}} (\\mathbf{V}_r \\mathbf{\\Lambda}_r \\mathbf{V}_r^T \\tilde{\\mathbf{\\psi}})_i\n$$\n评估过程分步进行：\n1. 计算 $\\mathbf{c} = \\mathbf{V}_r^T \\tilde{\\mathbf{\\psi}}$ (成本 $O(rN)$)。\n2. 计算 $\\mathbf{d} = \\mathbf{\\Lambda}_r \\mathbf{c}$ (成本 $O(r)$)。\n3. 计算 $\\mathbf{f} = \\mathbf{V}_r \\mathbf{d}$ (成本 $O(rN)$)。\n4. 计算 $\\chi_i^{(r)} = f_i / \\sqrt{w_i}$ (成本 $O(N)$)。\n\n应用该算符的总成本主要由步骤 1 和 3 主导，总复杂度为 $O(rN)$。只要能用一个小的秩 $r \\ll N$ 实现良好的近似，这就是对直接法 $O(N^2)$ 的显著改进。截断秩 $r$ 作为一个控制参数，平衡计算成本和精度。更大的 $r$ 会以更高的计算代价产生更准确的结果。寻找 $\\mathbf{V}_r$ 和 $\\mathbf{\\Lambda}_r$ 的初始奇异值分解 (SVD) 或特征分解的成本为 $O(N^3)$，但这是一次性的预计算，在迭代求解 HF 方程之前执行。", "answer": "```python\nimport numpy as np\nfrom scipy import special\n\n# The problem statement requires numpy 1.23.5 and scipy 1.11.4.\n# np.polynomial.hermite.hermval is suitable for this numpy version.\n# math.factorial can be slow, so scipy.special.factorial is preferred.\n\ndef solve():\n    \"\"\"\n    Solves the four test cases for the Hartree-Fock exchange kernel problem.\n    \"\"\"\n\n    def hermite_poly(n, x):\n        \"\"\"\n        Computes the physicists' Hermite polynomial H_n(x).\n        Uses numpy's dedicated function for robust and efficient evaluation.\n        \"\"\"\n        coeffs = [0.0] * n + [1.0]\n        # np.polynomial.hermite.hermval is the modern way, but for older numpy\n        # it might on a different path. This is compatible with 1.23.5.\n        from numpy.polynomial.hermite import hermval\n        if isinstance(x, np.ndarray):\n            return hermval(x, coeffs)\n        return hermval(np.array([x]), coeffs)[0]\n\n    def ho_eigenfunction(n, x, b):\n        \"\"\"\n        Computes the normalized 1D harmonic oscillator eigenfunction phi_n(x).\n        \"\"\"\n        # Normalization constant N_n = 1 / sqrt(2^n * n! * b * sqrt(pi))\n        try:\n            norm_factor = 1.0 / np.sqrt(2**n * special.factorial(n) * b * np.sqrt(np.pi))\n        except (ValueError, OverflowError): # handles large n\n             # Log-gamma for stable factorial calculation\n            log_norm = -0.5 * (n * np.log(2) + special.gammaln(n + 1) + np.log(b) + 0.5 * np.log(np.pi))\n            norm_factor = np.exp(log_norm)\n            \n        x_scaled = x / b\n        return norm_factor * hermite_poly(n, x_scaled) * np.exp(-0.5 * x_scaled**2)\n\n    def calculate_case(N, Xmax, b, interaction_params, r, case_type):\n        \"\"\"\n        Main logic to compute the result for a single test case.\n        \"\"\"\n        # 1. Get Gauss-Legendre quadrature grid and weights\n        xi, w_gl = np.polynomial.legendre.leggauss(N)\n        x_grid = Xmax * xi\n        w_quad = Xmax * w_gl\n\n        # 2. Build the nonlocal kernel matrix U(x_i, x_j)\n        # 2a. Density matrix rho(x_i, x_j)\n        phi0_vec = ho_eigenfunction(0, x_grid, b)\n        phi1_vec = ho_eigenfunction(1, x_grid, b)\n        rho = np.outer(phi0_vec, phi0_vec) + np.outer(phi1_vec, phi1_vec)\n\n        # 2b. Interaction g(x_i - x_j)\n        x_diff_sq = np.subtract.outer(x_grid, x_grid)**2\n        g = np.zeros((N, N), dtype=float)\n        for Ak, muk in interaction_params:\n            g += Ak * np.exp(-x_diff_sq / (muk**2))\n\n        # 2c. Full kernel matrix U(x_i, x_j)\n        U_matrix = -g * rho\n\n        # 3. Handle specific case logic\n        if case_type == 'symmetry':\n            # Case D: Compute Frobenius norm ratio for symmetry check\n            norm_U = np.linalg.norm(U_matrix, 'fro')\n            norm_diff = np.linalg.norm(U_matrix - U_matrix.T, 'fro')\n            return norm_diff / norm_U if norm_U > 0 else 0.0\n\n        # For cases A, B, C (error calculation)\n        # 4. Construct the test function psi(x) on the grid\n        phi2_vec = ho_eigenfunction(2, x_grid, b)\n        phi3_vec = ho_eigenfunction(3, x_grid, b)\n        psi_vec = phi2_vec + 0.5 * phi3_vec\n    \n        # 5. Direct application of the exchange operator\n        # chi_i = sum_j w_j * U_ij * psi_j\n        chi_direct_vec = U_matrix @ (w_quad * psi_vec)\n\n        # 6. Low-rank approximation\n        # 6a. Symmetrize the kernel\n        sqrt_w = np.sqrt(w_quad)\n        S_matrix = np.outer(sqrt_w, sqrt_w) * U_matrix\n        \n        # 6b. Eigendecomposition. eigh returns eigenvalues in ascending order.\n        # Since kernel is negative-semidefinite, the most negative eigenvalues\n        # have the largest magnitude and are at the beginning of the sorted array.\n        eigvals, eigvecs = np.linalg.eigh(S_matrix)\n        \n        # 6c. Truncate to rank r\n        lambda_r = eigvals[:r]\n        V_r = eigvecs[:, :r]\n\n        # 6d. Apply low-rank operator\n        psi_tilde = sqrt_w * psi_vec\n        c_vec = V_r.T @ psi_tilde\n        d_vec = lambda_r * c_vec\n        f_vec = V_r @ d_vec\n        chi_low_rank_vec = f_vec / sqrt_w\n\n        # 7. Compute relative L2 error\n        delta_vec = chi_direct_vec - chi_low_rank_vec\n        norm_sq_delta = np.sum(w_quad * delta_vec**2)\n        norm_sq_chi = np.sum(w_quad * chi_direct_vec**2)\n        \n        if norm_sq_chi == 0:\n            return 0.0\n            \n        rel_error = np.sqrt(norm_sq_delta / norm_sq_chi)\n        return rel_error\n\n    # Define test cases from the problem statement\n    test_cases = [\n        {'N': 80, 'Xmax': 8.0, 'b': 1.2, 'params': [(500.0, 0.7), (300.0, 1.3)], 'r': 6, 'type': 'error'},\n        {'N': 120, 'Xmax': 8.0, 'b': 1.0, 'params': [(800.0, 0.3), (200.0, 0.6)], 'r': 10, 'type': 'error'},\n        {'N': 80, 'Xmax': 8.0, 'b': 1.2, 'params': [(500.0, 0.7), (300.0, 1.3)], 'r': 1, 'type': 'error'},\n        {'N': 60, 'Xmax': 6.0, 'b': 1.0, 'params': [(500.0, 0.7), (300.0, 1.3)], 'r': -1, 'type': 'symmetry'},\n    ]\n\n    results = []\n    for case in test_cases:\n        result = calculate_case(case['N'], case['Xmax'], case['b'], case['params'], case['r'], case['type'])\n        results.append(result)\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(f'{r:.8e}' for r in results)}]\")\n\nsolve()\n```", "id": "3555805"}, {"introduction": "标准的哈特里-福克方法旨在找到能量的最小值，但原子核可以展现出各种不一定处于该最低点的形状（形变）。为了研究诸如核形变之类的性质，我们需要探索远离基态的能量景观。这个练习 [@problem_id:3555808] 介绍了强大的约束哈特里-福克技术，其中使用拉格朗日乘子将系统“驱动”到期望的构型（例如，特定的四极矩）。通过自洽求解约束方程，你可以绘制出势能面，这是理解核形状、裂变和集体激发的基本工具。", "problem": "考虑一个由相同无自旋费米子组成的系统，该系统被限制在一个维度为 $M$ 的有限正交归一单粒子基中。该系统具有单体哈密顿量 $\\hat{h}_0$ 和一种示意性的、由强度参数 $\\kappa$ 表征的四极-四极型可分离二体相互作用。令 $\\hat{Q}_{20}$ 表示在单粒子基中表示的轴向质量四极矩算符。多体试探态被限制为由 $N$ 个正交归一轨道 $\\{\\phi_k\\}$ ($k = 1,\\dots,N$) 构建的斯莱特行列式。这些轨道是一个幺正矩阵的列，该幺正矩阵可将一个自洽平均场算符对角化。您将使用一个拉格朗日乘子 $\\lambda_Q$ 来引入四极矩约束，该乘子在带约束的变分原理层面上导出。您的任务如下。\n\n任务 A (从第一性原理推导)：从能量期望值的 Ritz 变分原理出发，并强制执行以下条件：\n- 单粒子轨道的正交归一性，\n- 固定的粒子数 $N$，\n- 通过拉格朗日乘子 $\\lambda_Q$ 对轴向四极矩施加线性约束，\n证明欧拉-拉格朗日方程如何导出一个单粒子方程组，其包含一个修正的、与态无关的单体算符，该算符自洽地依赖于已占据轨道和拉格朗日乘子。推导过程仅可使用以下内容作为基础：\n- 斯莱特行列式和单体密度矩阵 $\\rho$ 的定义，\n- 平均场近似中可分离相互作用能的二次型形式，\n- 使用拉格朗日乘子处理约束的 Rayleigh-Ritz 原理，\n- 轨道的正交归一性条件。\n\n明确指出：\n- 由可分离相互作用 $-\\frac{\\kappa}{2}\\hat{Q}_{20}\\hat{Q}_{20}$ 产生的平均场贡献的结构，用平均四极矩 $\\langle \\hat{Q}_{20} \\rangle$ 表示，\n- 四极矩约束如何修正有效单粒子算符，\n- 使方程组闭合的自洽条件。\n\n请勿使用任何预先引用的目标公式；需自行推导。\n\n任务 B (计算自洽性)：在固定的单粒子基中，使用以下数据（所有单位均为任意单位）实现一个约束平均场问题的自洽求解器：\n- 基维度 $M = 6$ 和粒子数 $N = 3$。\n- 单体哈密顿量 $\\hat{h}_0$ 由对角矩阵表示\n$$\nh_0 = \\mathrm{diag}\\left(0.0,\\;0.9,\\;1.7,\\;2.8,\\;4.2,\\;6.0\\right).\n$$\n- 轴向四极矩算符 $\\hat{Q}_{20}$ 由实对称矩阵表示\n$$\nQ = \\begin{pmatrix}\n-2.0  & 0.20 & 0.05 & 0 & 0 & 0 \\\\\n0.20  & -0.8 & 0.20 & 0.05 & 0 & 0 \\\\\n0.05  & 0.20 & 0.3  & 0.20 & 0.05 & 0 \\\\\n0 & 0.05 & 0.20 & 0.9  & 0.20 & 0.05 \\\\\n0 & 0 & 0.05 & 0.20 & 1.6  & 0.20 \\\\\n0 & 0 & 0 & 0.05 & 0.20 & 2.2\n\\end{pmatrix}.\n$$\n- 相互作用强度 $\\kappa = 0.25$。\n\n您的求解器应：\n- 通过占据 $\\hat{h}_0$ 的 $N$ 个最低本征态来初始化密度矩阵 $\\rho$，\n- 迭代以下步骤直至收敛：\n  - 构建任务 A 所推导的有效单体算符，\n  - 将其对角化以获得新的单粒子态和能量，\n  - 占据 $N$ 个能量最低的态来更新 $\\rho$ 和平均四极矩 $\\langle \\hat{Q}_{20} \\rangle = \\mathrm{Tr}(\\rho Q)$，\n  - 对标量 $\\langle \\hat{Q}_{20} \\rangle$ 使用简单线性混合以稳定收敛过程，\n- 当 $\\langle \\hat{Q}_{20} \\rangle$ 的变化量低于 $\\tau = 10^{-10}$ 或达到 $10^4$ 次迭代上限时，宣告收敛。\n\n对每个收敛解，计算：\n- Hartree-Fock (HF) 平均场能量\n$$\nE_{\\mathrm{HF}}[\\rho] = \\mathrm{Tr}(\\rho h_0) - \\frac{\\kappa}{2}\\,\\langle \\hat{Q}_{20} \\rangle^2,\n$$\n- Routhian (约束泛函)\n$$\n\\mathcal{R}(\\lambda_Q) = E_{\\mathrm{HF}}[\\rho(\\lambda_Q)] + \\lambda_Q \\,\\langle \\hat{Q}_{20} \\rangle.\n$$\n\n数值验证（谱的敏感性和变分导数）：对于以下每个 $\\lambda_Q$ 测试值，在收敛后报告：\n- 收敛后的四极矩 $\\langle \\hat{Q}_{20} \\rangle$，\n- $N$ 个最低的自洽单粒子本征值（升序排列），以量化对谱的影响，\n- 一个布尔标志，当给定 $\\lambda_Q$ 处的 $\\frac{d\\mathcal{R}}{d\\lambda_Q}$ 的中心差分近似值在容差 $\\delta = 5\\times 10^{-5}$ 内等于收敛的 $\\langle \\hat{Q}_{20} \\rangle$ 时，该标志为真。使用增量为 $\\Delta \\lambda = 10^{-5}$ 的中心差分，并通过在 $\\lambda_Q + \\Delta \\lambda$ 和 $\\lambda_Q - \\Delta \\lambda$ 处完全重新收敛自洽解来计算 $\\mathcal{R}(\\lambda_Q \\pm \\Delta \\lambda)$。\n\n物理和数值单位：将所有能量视为任意能量单位，四极矩视为无量纲。角度不出现。将数值输出表示为四舍五入到 $6$ 位小数的实数，并将布尔值表示为整数（$1$ 代表真，$0$ 代表假）。\n\n测试组：为以下拉格朗日乘子值运行您的求解器：\n- 情况 1：$\\lambda_Q = -0.8$，\n- 情况 2：$\\lambda_Q = -0.2$，\n- 情况 3：$\\lambda_Q = 0.0$,\n- 情况 4：$\\lambda_Q = 0.6$。\n\n最终输出格式：您的程序应生成单行输出，其中包含所有测试用例的结果，形式为方括号括起来的逗号分隔列表。每个用例本身应为一个子列表，形式如下\n$$\n\\left[\\langle \\hat{Q}_{20} \\rangle,\\; \\epsilon_1,\\; \\epsilon_2,\\; \\epsilon_3,\\; b\\right],\n$$\n其中 $\\epsilon_1,\\epsilon_2,\\epsilon_3$ 是 $N$ 个最低的自洽单粒子能量，$b \\in \\{0,1\\}$ 是上文定义的布尔标志。因此，总输出应如下所示\n$$\n\\big[\\,[\\cdots],\\,[\\cdots],\\,[\\cdots],\\,[\\cdots]\\,\\big],\n$$\n每个实数四舍五入到 $6$ 位小数，不打印单位。", "solution": "该问题要求推导一个示意性模型的约束 Hartree-Fock 方程并对其进行数值求解。该问题提法恰当，科学上合理，并包含了所有必要的信息。\n\n### 任务 A：从第一性原理推导\n\n目标是找到一组 $N$ 个正交归一的单粒子轨道 $|\\phi_k\\rangle$ ($k=1, \\dots, N$)，在满足平均四极矩约束的条件下，使系统总能量的期望值最小化。总的多体哈密顿量为 $\\hat{H} = \\hat{h}_0 + \\hat{V}$，其中 $\\hat{h}_0$ 是单体部分，$\\hat{V} = -\\frac{\\kappa}{2} \\hat{Q}_{20} \\hat{Q}_{20}$ 是可分离二体相互作用。多体态 $|\\Psi\\rangle$ 是一个由轨道 $|\\phi_k\\rangle$ 构建的斯莱特行列式。\n\n在 Hartree-Fock (对于此相互作用，可简化为 Hartree) 近似下，可分离相互作用的期望值由 $E_V = \\langle \\hat{V} \\rangle \\approx -\\frac{\\kappa}{2} \\langle \\hat{Q}_{20} \\rangle^2$ 给出。此处，$\\langle \\hat{Q}_{20} \\rangle$ 是四极矩算符在多体态 $|\\Psi\\rangle$ 中的期望值，对于斯莱特行列式，它是对已占据轨道求和的单粒子期望值：\n$$\n\\langle \\hat{Q}_{20} \\rangle = \\langle \\Psi | \\hat{Q}_{20} | \\Psi \\rangle = \\sum_{k=1}^N \\langle \\phi_k | \\hat{Q}_{20} | \\phi_k \\rangle = \\mathrm{Tr}(\\rho \\hat{Q}_{20})\n$$\n其中 $\\rho = \\sum_{k=1}^N |\\phi_k\\rangle\\langle\\phi_k|$ 是单体密度矩阵。\n\n因此，需要最小化的总能量泛函为：\n$$\nE_{\\mathrm{HF}}[\\{\\phi_k\\}] = \\langle \\hat{h}_0 \\rangle - \\frac{\\kappa}{2} \\langle \\hat{Q}_{20} \\rangle^2 = \\sum_{k=1}^N \\langle \\phi_k | \\hat{h}_0 | \\phi_k \\rangle - \\frac{\\kappa}{2} \\left( \\sum_{k=1}^N \\langle \\phi_k | \\hat{Q}_{20} | \\phi_k \\rangle \\right)^2\n$$\n\n我们使用带约束的 Ritz 变分原理。我们希望找到能量泛函 $E_{\\mathrm{HF}}$ 在满足四极矩约束条件下的一个驻点。这可以通过寻找一个修正泛函（一个 Routhian）的驻点来实现，其中约束通过拉格朗日乘子 $\\lambda_Q$ 被引入。需要求驻点的泛函是：\n$$\n\\mathcal{F}[\\{\\phi_k\\}] = E_{\\mathrm{HF}}[\\{\\phi_k\\}] + \\lambda_Q \\langle \\hat{Q}_{20} \\rangle\n$$\n这种形式对应于在平均场近似中找到一个使 Routhian 算符 $\\hat{R} = \\hat{H} + \\lambda_Q \\hat{Q}_{20}$ 最小化的态。$\\lambda_Q$ 的符号约定与问题中对数值 Routhian $\\mathcal{R}$ 的定义一致。\n\n为了强制执行轨道的正交归一性 $\\langle \\phi_i | \\phi_j \\rangle = \\delta_{ij}$，我们引入一个拉格朗日乘子矩阵 $\\epsilon_{ji}$ 并构造完整的拉格朗日函数：\n$$\n\\mathcal{L}[\\{\\phi_k\\}] = \\mathcal{F}[\\{\\phi_k\\}] - \\sum_{i,j=1}^N \\epsilon_{ji} (\\langle \\phi_i | \\phi_j \\rangle - \\delta_{ij})\n$$\n代入 $E_{\\mathrm{HF}}$ 和 $\\langle \\hat{Q}_{20} \\rangle$ 的表达式：\n$$\n\\mathcal{L} = \\sum_{k=1}^N \\langle \\phi_k | \\hat{h}_0 | \\phi_k \\rangle - \\frac{\\kappa}{2} \\left( \\sum_{i=1}^N \\langle \\phi_i | \\hat{Q}_{20} | \\phi_i \\rangle \\right)^2 + \\lambda_Q \\sum_{k=1}^N \\langle \\phi_k | \\hat{Q}_{20} | \\phi_k \\rangle - \\sum_{i,j=1}^N \\epsilon_{ji} (\\langle \\phi_i | \\phi_j \\rangle - \\delta_{ij})\n$$\n为了找到最优轨道，我们要求 $\\mathcal{L}$ 对每个 $\\langle\\phi_k|$ 的泛函导数为零。对于一个特定的轨道 $\\langle\\phi_j|$：\n$$\n\\frac{\\delta \\mathcal{L}}{\\delta \\langle \\phi_j|} = \\hat{h}_0 |\\phi_j\\rangle - \\frac{\\kappa}{2} \\cdot 2 \\left( \\sum_{i=1}^N \\langle \\phi_i | \\hat{Q}_{20} | \\phi_i \\rangle \\right) \\hat{Q}_{20}|\\phi_j\\rangle + \\lambda_Q \\hat{Q}_{20}|\\phi_j\\rangle - \\sum_{i=1}^N \\epsilon_{ij}|\\phi_i\\rangle = 0\n$$\n注意到 $\\langle \\hat{Q}_{20} \\rangle = \\sum_i \\langle \\phi_i | \\hat{Q}_{20} | \\phi_i \\rangle$，上式可简化为：\n$$\n\\left( \\hat{h}_0 - \\kappa \\langle \\hat{Q}_{20} \\rangle \\hat{Q}_{20} + \\lambda_Q \\hat{Q}_{20} \\right) |\\phi_j\\rangle = \\sum_{i=1}^N \\epsilon_{ij} |\\phi_i\\rangle\n$$\n该方程对每个已占据轨道 $j=1,\\dots,N$ 都成立。左侧的算符是有效单粒子哈密顿量，我们称之为 $\\hat{h}_{\\mathrm{eff}}$：\n$$\n\\hat{h}_{\\mathrm{eff}} = \\hat{h}_0 - \\kappa \\langle \\hat{Q}_{20} \\rangle \\hat{Q}_{20} + \\lambda_Q \\hat{Q}_{20}\n$$\n拉格朗日乘子矩阵 $\\epsilon_{ij}$ 是厄米的。我们总可以在已占据轨道 $|\\phi_k\\rangle$ 中找到一个幺正变换来对角化该矩阵，从而得到一组满足本征值方程的“正则”轨道 $|\\psi_k\\rangle$：\n$$\n\\hat{h}_{\\mathrm{eff}} |\\psi_k\\rangle = \\epsilon_k |\\psi_k\\rangle\n$$\n其中 $\\epsilon_k$ 是实数本征值，被识别为单粒子能量。系统的基态则通过占据与 $\\hat{h}_{\\mathrm{eff}}$ 的 $N$ 个最低本征值相对应的 $N$ 个单粒子轨道来形成。\n\n明确的识别如下：\n1.  **平均场贡献的结构：** 项 $-\\kappa \\langle \\hat{Q}_{20} \\rangle \\hat{Q}_{20}$ 是由可分离二体相互作用产生的单体势。它依赖于态本身的四极矩，这使得问题成为非线性的。\n2.  **四极矩约束带来的修正：** 项 $+\\lambda_Q \\hat{Q}_{20}$ 由于约束而被添加到哈密顿量中。该项的作用类似于一个外场，驱动系统朝向特定的形变。一个正的 $\\lambda_Q$ 会惩罚具有正 $\\langle \\hat{Q}_{20} \\rangle$ 的态，从而倾向于负值，反之亦然，以使泛函 $\\mathcal{F}$ 最小化。\n3.  **自洽条件：** 有效哈密顿量 $\\hat{h}_{\\mathrm{eff}}$ 依赖于 $\\langle \\hat{Q}_{20} \\rangle$。然而，$\\langle \\hat{Q}_{20} \\rangle$ 又是用涉及 $\\hat{h}_{\\mathrm{eff}}$ 自身的本征值问题的解（轨道）来计算的：$\\langle \\hat{Q}_{20} \\rangle = \\sum_{k=1}^N \\langle \\psi_k | \\hat{Q}_{20} | \\psi_k \\rangle$。这种相互依赖性形成了一个必须通过迭代求解的自洽循环。\n\n### 任务 B：计算自洽性\n\n任务 A 中的推导为数值求解器提供了基础。自洽过程涉及迭代地构造和对角化有效哈密顿量 $\\hat{h}_{\\mathrm{eff}}$，直到输入和输出的四极矩收敛为止。\n\n算法结构如下：\n1.  **初始化**：定义基维度 $M=6$、粒子数 $N=3$、常数 $\\kappa, \\tau$ 以及 $\\hat{h}_0$ 和 $\\hat{Q}_{20}$ 的矩阵表示。通过占据 $\\hat{h}_0$ 的 $N=3$ 个能量最低的本征态来构建初始密度矩阵 $\\rho$。由于 $\\hat{h}_0$ 是对角矩阵，这对应于一个前 $N$ 个对角元为 1 的对角矩阵 $\\rho$。由此，计算出四极矩的初始猜测值 $\\langle Q \\rangle_{\\text{in}} = \\mathrm{Tr}(\\rho Q)$。\n2.  **迭代**：运行一个循环，直到收敛或达到 $10^4$ 次迭代上限。在每一步中：\n    a. 构建有效哈密顿量矩阵 $h_{\\mathrm{eff}} = h_0 - \\kappa \\langle Q \\rangle_{\\text{in}} Q + \\lambda_Q Q$。\n    b. 对角化 $h_{\\mathrm{eff}}$ 以找到其本征值（单粒子能量）和本征矢量（单粒子轨道）。\n    c. 从与 $N$ 个最低本征值相对应的 $N$ 个本征矢量形成新的密度矩阵。\n    d. 计算新的输出四极矩 $\\langle Q \\rangle_{\\text{out}} = \\mathrm{Tr}(\\rho_{\\text{new}} Q)$。\n    e. 通过比较输入和输出的矩来检查收敛性：$|\\langle Q \\rangle_{\\text{out}} - \\langle Q \\rangle_{\\text{in}}| < \\tau$。\n    f. 如果未收敛，则使用简单线性混合更新下一次迭代的输入：$\\langle Q \\rangle_{\\text{in}} \\leftarrow (1-\\alpha)\\langle Q \\rangle_{\\text{in}} + \\alpha \\langle Q \\rangle_{\\text{out}}$，其中 $\\alpha$ 是一个混合参数（例如 0.5），用于稳定收敛过程。\n3.  **后处理**：收敛后，计算所需的量：\n    a. 收敛的四极矩 $\\langle \\hat{Q}_{20} \\rangle$。\n    b. 最低的 $N$ 个单粒子能量（最终 $h_{\\mathrm{eff}}$ 的本征值）。\n    c. HF 能量 $E_{\\mathrm{HF}} = \\mathrm{Tr}(\\rho_{\\text{conv}} h_0) - \\frac{\\kappa}{2} \\langle \\hat{Q}_{20} \\rangle^2$。\n    d. Routhian $\\mathcal{R}(\\lambda_Q) = E_{\\mathrm{HF}} + \\lambda_Q \\langle \\hat{Q}_{20} \\rangle$。\n4.  **数值验证**：为检验关系式 $\\frac{d\\mathcal{R}}{d\\lambda_Q} \\approx \\langle \\hat{Q}_{20} \\rangle$，对 $\\lambda_Q \\pm \\Delta\\lambda$ 重复整个自洽计算。利用这些点上的 Routhian 值 $\\mathcal{R}(\\lambda_Q \\pm \\Delta\\lambda)$ 来计算导数的中心差分近似。然后将此数值导数与中心点 $\\lambda_Q$ 处的收敛值 $\\langle \\hat{Q}_{20} \\rangle$ 进行比较。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the constrained Hartree-Fock problem for a schematic model.\n    \"\"\"\n    # --- Problem Data ---\n    M = 6\n    N = 3\n    kappa = 0.25\n\n    h0 = np.diag([0.0, 0.9, 1.7, 2.8, 4.2, 6.0])\n    Q = np.array([\n        [-2.0, 0.20, 0.05, 0.0, 0.0, 0.0],\n        [0.20, -0.8, 0.20, 0.05, 0.0, 0.0],\n        [0.05, 0.20, 0.3, 0.20, 0.05, 0.0],\n        [0.0, 0.05, 0.20, 0.9, 0.20, 0.05],\n        [0.0, 0.0, 0.05, 0.20, 1.6, 0.20],\n        [0.0, 0.0, 0.0, 0.05, 0.20, 2.2]\n    ])\n\n    test_cases = [-0.8, -0.2, 0.0, 0.6]\n\n    # --- Solver Parameters ---\n    max_iterations = 10000\n    convergence_tau = 1.0e-10\n    mixing_alpha = 0.5\n    \n    # --- Derivative Check Parameters ---\n    delta_lambda = 1.0e-5\n    delta_check = 5.0e-5\n\n    def run_scf(lambda_q):\n        \"\"\"\n        Performs the self-consistent field iteration for a given lambda_q.\n        \"\"\"\n        # Initialization\n        rho_initial = np.zeros((M, M))\n        for i in range(N):\n            rho_initial[i, i] = 1.0\n        \n        q_in = np.trace(rho_initial @ Q)\n\n        for i in range(max_iterations):\n            h_eff = h0 - kappa * q_in * Q + lambda_q * Q\n            \n            eigenvalues, eigenvectors = np.linalg.eigh(h_eff)\n            \n            # Form new density matrix from lowest N states\n            occupied_vectors = eigenvectors[:, :N]\n            rho_new = occupied_vectors @ occupied_vectors.T\n            \n            q_out = np.trace(rho_new @ Q)\n            \n            if abs(q_out - q_in)  convergence_tau:\n                # Converged, return final quantities\n                final_q = q_out\n                final_rho = rho_new\n                final_s_p_energies = eigenvalues[:N]\n                return final_q, final_rho, final_s_p_energies\n\n            # Mix for next iteration\n            q_in = (1 - mixing_alpha) * q_in + mixing_alpha * q_out\n\n        # If loop finishes without convergence\n        raise RuntimeError(f\"SCF failed to converge for lambda_q = {lambda_q}\")\n\n    def calculate_routhian(lambda_q):\n        \"\"\"\n        Runs SCF and calculates the Routhian for a given lambda_q.\n        \"\"\"\n        q_conv, rho_conv, _ = run_scf(lambda_q)\n        \n        # Calculate HF energy\n        e_hf = np.trace(rho_conv @ h0) - (kappa / 2.0) * q_conv**2\n        \n        # Calculate Routhian\n        routhian = e_hf + lambda_q * q_conv\n        return routhian\n\n    results = []\n    for lambda_q_val in test_cases:\n        # Main calculation for the central lambda_q\n        q_converged, _, sp_energies = run_scf(lambda_q_val)\n\n        # Numerical derivative check\n        r_plus = calculate_routhian(lambda_q_val + delta_lambda)\n        r_minus = calculate_routhian(lambda_q_val - delta_lambda)\n        \n        dR_dlambda = (r_plus - r_minus) / (2.0 * delta_lambda)\n        \n        is_derivative_ok = 1 if abs(dR_dlambda - q_converged)  delta_check else 0\n        \n        # Format results\n        case_result = [\n            round(q_converged, 6),\n            round(sp_energies[0], 6),\n            round(sp_energies[1], 6),\n            round(sp_energies[2], 6),\n            is_derivative_ok\n        ]\n        results.append(case_result)\n\n    # Final output formatting\n    output_str = \"[\" + \",\".join([str(r) for r in results]) + \"]\"\n    output_str = output_str.replace(\"'\", \"\") # Clean up string representation of lists\n    print(output_str)\n\nsolve()\n```", "id": "3555808"}]}