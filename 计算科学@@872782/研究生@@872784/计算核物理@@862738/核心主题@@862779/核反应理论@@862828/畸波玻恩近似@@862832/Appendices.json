{"hands_on_practices": [{"introduction": "DWBA跃迁振幅可以分解为一系列分波贡献之和，其中每个分波由一个径向积分定义。本练习 [@problem_id:3598601] 采用一个简化的模型，旨在探索跃迁算符的形状（特别是其在核表面的局域性）如何优先选择特定的轨道角动量 $l$。通过这个实践，你将建立起关于相互作用空间特征与反应角动量特征之间联系的基本物理直觉。", "problem": "考虑一个简化的畸波玻恩近似 (DWBA) 分析，用于描述具有表面峰化的中心、自旋无关跃迁算符的非弹性核散射。DWBA 振幅由入射和出射畸波与跃迁算符的交叠给出，并在整个三维空间上进行积分。从基本散射公式出发：初道与末道之间的 DWBA 跃迁振幅是出射畸波、跃迁算符和入射畸波三者乘积的体积分。使用球坐标和散射态的分波展开，论证角向依赖性如何通过球谐函数分离，以及单极角结构如何保持轨道角动量守恒。采用以下基于标准散射理论的玩具模型假设，以获得一个可以进行数值计算的径向积分：\n\n- 畸波由球贝塞尔函数和球谐函数近似，即入射和出射径向畸波取为 $u_{\\ell}(k,r) \\propto j_{\\ell}(k r)$，其中 $j_{\\ell}$ 是 $\\ell$ 阶球贝塞尔函数，$k$ 是波数。该近似对应于径向部分的平面波极限，适用于表面峰化算符的分析。\n- 跃迁算符是表面峰化的，其径向形式为 $V_{tr}(r) = V_0 \\exp\\!\\left(-\\dfrac{(r - R)^2}{a^2}\\right)$，其中 $V_0$ 设定标度（将 $V_0$ 视为任意正常数），$R$ 是特征半径，$a$ 是表面弥散度。\n- 由于单极算符的角动量选择定则，只有入射和出射轨道角动量相等的分量才有贡献；因此，可以研究定义了对 DWBA 振幅的分波贡献、并按 $\\ell$ 分解的径向积分。\n\n你的任务是实现一个程序，对每个指定的参数集，计算分波贡献的相对权重，并确定哪个轨道角动量 $\\ell$ 在 DWBA 振幅中占主导地位。具体来说：\n\n1. 从第一性原理推导，对于单极跃迁，分波振幅为何可以简化为 $j_{\\ell}(k r)$ 函数与 $V_{tr}(r)$ 之间的交叠形式的径向积分（使用径向体积元进行积分）。论证角动量守恒和球谐函数的正交性在消除 $\\ell \\neq \\ell'$ 交叉项中的关键作用。\n2. 对于 $\\ell = 0, 1, \\dots, \\ell_{\\max}$ 范围内的每个 $\\ell$，数值计算一个正比于以下形式的径向积分：\n$$\nT_{\\ell} \\propto \\int_{0}^{\\infty} r^2 \\, j_{\\ell}(k r) \\, j_{\\ell}(k r) \\, V_{tr}(r) \\, dr\n$$\n其中高斯函数 $V_{tr}(r)$ 如上定义。为了使积分在数值上易于处理，将积分上限 $\\infty$ 替换为一个由 $R$、$a$ 和 $k$ 决定的足够大的有限截断值，以确保高斯因子和振荡项被充分地捕捉。\n3. 构建归一化权重\n$$\nw_{\\ell} = \\dfrac{|T_{\\ell}|^2}{\\sum_{\\ell'=0}^{\\ell_{\\max}} |T_{\\ell'}|^2}\n$$\n并为每个参数集确定使 $w_{\\ell}$ 最大化的主导轨道角动量 $\\ell_{\\text{dom}}$。归一化确保了结果是无量纲的，并且与绝对标度 $V_0$ 无关。\n4. 使用以下科学上合理的参数集测试套件。所有半径 $R$ 的单位为费米（femtometer），所有弥散度 $a$ 的单位为费米，所有波数 $k$ 的单位为反费米（inverse femtometer）。程序应考虑每个用例中指定的从 $0$ 到 $\\ell_{\\max}$ 的 $\\ell$ 值。注意输出是无单位的。测试用例：\n   - 用例 1：$R = 5.0$, $a = 0.4$, $k = 1.0$, $\\ell_{\\max} = 12$。\n   - 用例 2：$R = 5.0$, $a = 2.0$, $k = 0.3$, $\\ell_{\\max} = 8$。\n   - 用例 3：$R = 2.0$, $a = 0.3$, $k = 1.2$, $\\ell_{\\max} = 10$。\n   - 用例 4：$R = 0.0$, $a = 0.2$, $k = 1.0$, $\\ell_{\\max} = 6$。\n5. 你的程序应生成单行输出，其中包含四个测试用例的主导 $\\ell$ 值，形式为方括号括起来的逗号分隔列表，例如 $[2,5,3,0]$。不应打印任何其他文本。\n\n你的推导必须从基础的 DWBA 振幅定义以及球谐函数和球贝塞尔函数的标准性质出发。避免引入任何非物理的假设。数值计算必须对 $j_{\\ell}(k r)$ 的振荡行为和表面峰化的高斯函数具有鲁棒性。最终的输出行必须是指定的无单位整数，并且角度单位在本问题中不适用，因为没有返回显式的角度量。", "solution": "### 1. 分波径向积分的推导\n\n从初道 $i$ 到末道 $f$ 的散射过程的畸波玻恩近似 (DWBA) 跃迁振幅 $T_{fi}$，由跃迁算符 $V_{tr}$ 在末态散射态 $\\Psi_f^{(-)}(\\mathbf{r})$ 和初态散射态 $\\Psi_i^{(+)}(\\mathbf{r})$ 之间的矩阵元给出：\n$$\nT_{fi} = \\langle \\Psi_f^{(-)} | V_{tr} | \\Psi_i^{(+)} \\rangle = \\int \\Psi_f^{(-)*}(\\mathbf{r}) V_{tr}(\\mathbf{r}) \\Psi_i^{(+)}(\\mathbf{r}) \\, d^3\\mathbf{r}\n$$\n此处，$\\Psi_i^{(+)}(\\mathbf{r})$ 表示具有入射波边界条件的初态，$\\Psi_f^{(-)}(\\mathbf{r})$ 是具有出射波边界条件的末态。问题指定了一个中心、自旋无关的跃迁算符，这意味着它仅依赖于径向坐标 $r = |\\mathbf{r}|$，因此 $V_{tr}(\\mathbf{r}) = V_{tr}(r)$。\n\n散射态使用球谐函数 $Y_{\\ell m}(\\hat{\\mathbf{r}})$ 作为角向基矢进行分波展开。问题指出，畸波的径向部分由球贝塞尔函数近似，这是一种对应于平面波玻恩近似的简化。散射态的一般分波展开形式为：\n$$\n\\Psi_{\\mathbf{k}}(\\mathbf{r}) = \\sum_{\\ell=0}^{\\infty} \\sum_{m=-\\ell}^{\\ell} A_{\\ell m} \\frac{\\chi_{\\ell}(k,r)}{r} Y_{\\ell m}(\\hat{\\mathbf{r}})\n$$\n其中 $A_{\\ell m}$ 是展开系数，$\\chi_{\\ell}(k,r)$ 是径向波函数。根据给定的近似，$\\chi_{\\ell}(k,r)/r$ 正比于 $\\ell$ 阶球贝塞尔函数 $j_{\\ell}(kr)$。我们假设初态和末态展开如下：\n$$\n\\Psi_i^{(+)}(\\mathbf{r}) \\propto \\sum_{\\ell m} C_{\\ell m}^{(i)} j_{\\ell}(k_i r) Y_{\\ell m}(\\hat{\\mathbf{r}})\n$$\n$$\n\\Psi_f^{(-)*}(\\mathbf{r}) \\propto \\sum_{\\ell' m'} C_{\\ell' m'}^{(f)*} j_{\\ell'}(k_f r) Y_{\\ell' m'}^*(\\hat{\\mathbf{r}})\n$$\n对于此分析，我们假设为近弹性散射，因此初末态的波数近似相等，$k_i \\approx k_f = k$。\n\n将这些展开式代入 $T_{fi}$ 的表达式，并使用球坐标系下的体积元 $d^3\\mathbf{r} = r^2 dr \\, d\\Omega$，我们得到：\n$$\nT_{fi} \\propto \\int \\left( \\sum_{\\ell' m'} C_{\\ell' m'}^{(f)*} j_{\\ell'}(kr) Y_{\\ell' m'}^*(\\hat{\\mathbf{r}}) \\right) V_{tr}(r) \\left( \\sum_{\\ell m} C_{\\ell m}^{(i)} j_{\\ell}(kr) Y_{\\ell m}(\\hat{\\mathbf{r}}) \\right) r^2 dr \\, d\\Omega\n$$\n由于 $V_{tr}(r)$ 与角度无关，我们可以将积分分离为径向和角向部分，并重排求和项：\n$$\nT_{fi} \\propto \\sum_{\\ell m} \\sum_{\\ell' m'} C_{\\ell' m'}^{(f)*} C_{\\ell m}^{(i)} \\left( \\int_0^\\infty r^2 j_{\\ell'}(kr) j_{\\ell}(kr) V_{tr}(r) \\, dr \\right) \\left( \\int Y_{\\ell' m'}^*(\\hat{\\mathbf{r}}) Y_{\\ell m}(\\hat{\\mathbf{r}}) \\, d\\Omega \\right)\n$$\n关键步骤是计算角向积分，这依赖于球谐函数的正交性：\n$$\n\\int Y_{\\ell' m'}^*(\\hat{\\mathbf{r}}) Y_{\\ell m}(\\hat{\\mathbf{r}}) \\, d\\Omega = \\delta_{\\ell \\ell'} \\delta_{m m'}\n$$\n克罗内克 δ 函数 $\\delta_{\\ell \\ell'}$ 和 $\\delta_{m m'}$ 强制轨道角动量及其投影守恒。它们仅在 $\\ell = \\ell'$ 和 $m = m'$ 时非零，这消除了双重求和中的所有交叉项。这个选择定则是算符 $V_{tr}(r)$ 为中心算符（标量算符）的直接结果。问题陈述中提到的“单极”跃迁意味着零角动量转移（$L=0$），这正确地导出了 $\\ell_{\\text{initial}} = \\ell_{\\text{final}}$。\n\n应用正交关系，跃迁振幅简化为对分波的单个求和：\n$$\nT_{fi} \\propto \\sum_{\\ell m} C_{\\ell m}^{(f)*} C_{\\ell m}^{(i)} \\int_0^\\infty r^2 j_{\\ell}(kr) j_{\\ell}(kr) V_{tr}(r) \\, dr\n$$\n总振幅是来自每个分波 $\\ell$ 的贡献的相干叠加。我们记为 $T_{\\ell}$ 的径向积分决定了给定 $\\ell$ 的贡献强度：\n$$\nT_{\\ell} = \\int_0^\\infty r^2 [j_{\\ell}(kr)]^2 V_{tr}(r) \\, dr\n$$\n这就是问题陈述中提供的积分形式，其从第一性原理的推导现已完成。问题要求分析这些分波的相对权重，其正比于 $|T_{\\ell}|^2$。由于 $T_{\\ell}$ 是实值函数的积分，所以 $|T_{\\ell}|^2 = T_{\\ell}^2$。\n\n### 2. 数值计算与算法设计\n\n目标是找到主导轨道角动量 $\\ell_{\\text{dom}}$，即最大化分波贡献的 $\\ell$ 值。这通过计算归一化权重 $w_{\\ell}$ 来实现：\n$$\nw_{\\ell} = \\frac{T_{\\ell}^2}{\\sum_{\\ell'=0}^{\\ell_{\\max}} T_{\\ell'}^2}\n$$\n数值算法流程如下：\n\n1.  **定义被积函数**：跃迁算符为 $V_{tr}(r) = V_0 \\exp\\left(-\\frac{(r-R)^2}{a^2}\\right)$。由于权重 $w_{\\ell}$ 是归一化的，常数 $V_0$ 会被消掉，可以设为 1。$T_{\\ell}$ 的被积函数是：\n $$ f(r; \\ell, k, R, a) = r^2 [j_{\\ell}(kr)]^2 \\exp\\left(-\\frac{(r - R)^2}{a^2}\\right) $$\n2.  **设置积分限**：积分为 $[0, \\infty)$。对于数值计算，积分上限被替换为一个足够大的有限截断值 $r_{\\max}$，使得被积函数变得可以忽略。高斯因子 $\\exp(-((r-R)/a)^2)$ 在 $r > R + Na$（对于某个 $N$）时快速衰减。贝塞尔函数 $j_{\\ell}(kr)$ 发生振荡，其第一个主峰大约位于 $kr \\approx \\ell$。一个鲁棒的截断值必须能适应这两种行为。一个合适的选择是 $r_{\\max} = \\max(R + 15a, (\\ell_{\\max} + 20)/k)$，这确保了高斯函数的尾部被捕捉到，并且积分范围足够宽，以包含直至 $\\ell_{\\max}$ 的所有相关贝塞尔函数的主要特征。\n\n3.  **计算分波积分**：对于每个参数集 $(R, a, k, \\ell_{\\max})$，算法从 $0$ 到 $\\ell_{\\max}$ 迭代 $\\ell$。在每次迭代中，使用标准的数值积分程序（例如 `scipy.integrate.quad`）计算积分 $T_{\\ell} = \\int_0^{r_{\\max}} f(r; \\ell, k, R, a) \\, dr$。\n\n4.  **确定主导 $\\ell$**：在计算出 $\\ell \\in [0, \\ell_{\\max}]$ 的 $T_{\\ell}$ 值数组后，计算其平方值 $T_{\\ell}^2$。主导角动量 $\\ell_{\\text{dom}}$ 是这个积分平方值数组中最大值的索引。这等价于找到使 $w_{\\ell}$ 最大化的 $\\ell$。\n\n对问题陈述中提供的四个测试用例中的每一个重复此过程，以找到相应的 $\\ell_{\\text{dom}}$。", "answer": "```python\nimport numpy as np\nfrom scipy.integrate import quad\nfrom scipy.special import spherical_jn\n\ndef solve():\n    \"\"\"\n    Computes the dominant orbital angular momentum for inelastic nuclear scattering\n    using a simplified Distorted Wave Born Approximation (DWBA) model.\n    \"\"\"\n\n    # Test cases: (R, a, k, l_max)\n    # R: characteristic radius (fm)\n    # a: surface diffuseness (fm)\n    # k: wave number (fm^-1)\n    # l_max: maximum orbital angular momentum to consider\n    test_cases = [\n        (5.0, 0.4, 1.0, 12),\n        (5.0, 2.0, 0.3, 8),\n        (2.0, 0.3, 1.2, 10),\n        (0.0, 0.2, 1.0, 6)\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        R, a, k, l_max = case\n\n        # V_0 is set to 1.0 as it cancels out in the normalized weights.\n        V0 = 1.0\n        \n        # The integrand for the radial integral T_ell\n        def integrand(r, l, k_val, R_val, a_val):\n            # Transition operator V_tr(r)\n            v_tr = V0 * np.exp(-((r - R_val) / a_val)**2)\n            \n            # Spherical Bessel function term [j_l(kr)]^2\n            # spherical_jn can return a list, we need the l-th element.\n            # For a scalar l and r, it returns an array of size l+1.\n            # We take the last element which corresponds to order l.\n            # A more robust way is to call it with a specific order `l`.\n            jn_val = spherical_jn(l, k_val * r)\n            \n            return r**2 * jn_val**2 * v_tr\n\n        # Determine a safe upper integration limit\n        # It must be large enough to contain the Gaussian and Bessel function peaks.\n        r_cutoff_gauss = R + 15.0 * a\n        # Handle k=0 case to avoid division by zero, although not in test cases\n        r_cutoff_bessel = (l_max + 20.0) / k if k > 1e-9 else float('inf')\n        r_max = max(r_cutoff_gauss, r_cutoff_bessel)\n\n        T_ell_values = []\n        l_range = range(l_max + 1)\n        \n        for l in l_range:\n            # Numerically compute the radial integral T_ell\n            integral_val, _ = quad(\n                integrand, \n                0, \n                r_max, \n                args=(l, k, R, a),\n                limit=200 # Increase limit for better accuracy with oscillatory functions\n            )\n            T_ell_values.append(integral_val)\n        \n        # The weights w_ell are proportional to |T_ell|^2.\n        # Since T_ell are real, this is T_ell^2.\n        # To find the dominant l, we find the index of the max value of T_ell^2.\n        # Note: np.argmax directly on T_ell_values gives the same index if all values are positive,\n        # which they are, as the integrand is non-negative.\n        # We use T_ell_values**2 to be formally correct.\n        T_ell_sq_arr = np.array(T_ell_values)**2\n        \n        # Find the dominant orbital angular momentum l_dom\n        l_dom = np.argmax(T_ell_sq_arr)\n        results.append(l_dom)\n\n    # Print the final result in the specified format\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3598601"}, {"introduction": "DWBA最强大的应用之一是从实验数据中提取核结构信息，例如束缚态的渐近归一化常数（Asymptotic Normalization Constant, ANC）。本练习 [@problem_id:3598529] 阐明了一个关键原理：直接核反应是周边反应，因此它们对束缚态波函数的尾部（由ANC量化）高度敏感，而对其内部的详细结构相对不敏感。理解这一点使得物理学家能够将转移反应作为一种可靠的工具来探测核波函数的渐近行为。", "problem": "您将实现一个计算模型，用以分析束缚态波函数的渐近归一化常数（ANC）如何改变畸波玻恩近似（DWBA）的跃迁振幅，并证明前向角的角分布对ANC最为敏感，而非对内部结构敏感。该分析必须通过从标准散射理论中推导出控制积分，然后对一个物理上合理的一维径向模型进行数值计算来完成。\n\n起点和定义：从散射理论中的第一玻恩近似和畸波玻恩近似（DWBA）表述开始。对于单核子转移反应，DWBA跃迁振幅可以写成一个关于径向坐标的积分，其中被积函数由跃迁形状因子、束缚态径向波函数以及初态和末态畸波的交叠三者之积构成。在用平面波替代畸波的模型中，角依赖性通过动量转移引入。使用以下模型和定义：\n\n- 设DWBA振幅模型为\n$$\nT_{fi}(\\theta) \\propto \\int_0^{\\infty} r^2\\, u_B(r)\\, f_{\\mathrm{WS}}(r;R_0,a_0)\\, j_0\\!\\big(q(\\theta)\\, r\\big)\\, \\mathrm{d}r\n$$\n其中 $u_B(r)$ 是束缚态径向波函数，$f_{\\mathrm{WS}}(r;R_0,a_0)$ 是一个Woods–Saxon表面局域形状因子，代表跃迁势和表面敏感性，$j_0(x)$ 是0阶球贝塞尔函数，$q(\\theta)$ 是作为散射角 $\\theta$ 函数的动量转移。\n\n- Woods–Saxon形状因子定义为\n$$\nf_{\\mathrm{WS}}(r;R_0,a_0) = \\frac{1}{1+\\exp\\!\\left(\\frac{r-R_0}{a_0}\\right)}\n$$\n参数 $R_0$ 和 $a_0$ 在下文指定。\n\n- 将束缚态径向波函数建模为一个内部组分和一个由渐近归一化常数（ANC）$C$ 加权的渐近尾部的平滑和，通过一个平滑匹配函数进行切换，\n$$\nu_B(r) = u_{\\mathrm{int}}(r)\\,\\big(1-S(r;R_m,a_m)\\big) + C\\,e^{-\\kappa r}\\,S(r;R_m,a_m)\n$$\n内部组分为\n$$\nu_{\\mathrm{int}}(r) = N_{\\mathrm{int}}\\, r\\, e^{-r/R_{\\mathrm{int}}}\n$$\n匹配函数为\n$$\nS(r;R_m,a_m) = \\frac{1}{1+\\exp\\!\\left(\\frac{R_m - r}{a_m}\\right)}\n$$\n此处，$N_{\\mathrm{int}}$ 独立于ANC $C$ 来缩放内部振幅，$R_{\\mathrm{int}}$ 设定内部尺度，而 $(R_m,a_m)$ 控制尾部在何处以及如何开启。\n\n- 束缚态的分离能 $S_B$ 决定了尾部的逆长度标度\n$$\n\\kappa = \\frac{\\sqrt{2\\,\\mu_B\\, S_B}}{\\hbar c}\n$$\n其中 $\\mu_B$ 是束缚构型的折合质量，$\\hbar c$ 是常用常数。\n\n- 动量转移 $q(\\theta)$ 由下式计算\n$$\nq(\\theta) = 2\\,k\\,\\sin\\!\\left(\\frac{\\theta}{2}\\right), \\quad\nk = \\frac{\\sqrt{2\\,\\mu\\,E}}{\\hbar c}\n$$\n其中 $\\mu$ 是入射道的折合质量，$E$ 是入射弹核的实验室动能。\n\n单位和常数：\n- 使用 $\\hbar c = 197.3269804$ 单位为 $\\mathrm{MeV\\cdot fm}$。\n- 入射道折合质量使用 $\\mu = 469.459$ 单位为 $\\mathrm{MeV}$。\n- 束缚态折合质量使用 $\\mu_B = 469.459$ 单位为 $\\mathrm{MeV}$。\n- 使用 $E = 50.0$ 单位为 $\\mathrm{MeV}$。\n- 使用 $R_0 = 6.0$ 单位为 $\\mathrm{fm}$，$a_0 = 0.6$ 单位为 $\\mathrm{fm}$，$R_{\\mathrm{int}} = 2.0$ 单位为 $\\mathrm{fm}$，$R_m = 6.0$ 单位为 $\\mathrm{fm}$，以及 $a_m = 0.5$ 单位为 $\\mathrm{fm}$。\n- 所有距离 $r$ 的单位必须是 $\\mathrm{fm}$，角度 $\\theta$ 的单位必须是弧度，能量的单位必须是 $\\mathrm{MeV}$。\n\n数值计算：\n- 在从 $r=0$ 到 $r=r_{\\max}$（其中 $r_{\\max} = 30.0\\,\\mathrm{fm}$）的均匀径向网格上进行数值积分，步长需选择以确保收敛。使用数值稳定的方法对 $r^2\\,u_B(r)\\, f_{\\mathrm{WS}}(r;R_0,a_0)\\, j_0(qr)$ 进行积分。\n\n灵敏度量化：\n- 对于给定的角度 $\\theta$ 和分离能 $S_B$，通过计算比率来定义对ANC的灵敏度\n$$\nR_C(\\theta;S_B) = \\frac{\\left|T_{fi}(\\theta;C_2)\\right|}{\\left|T_{fi}(\\theta;C_1)\\right|}\n$$\n对于两个ANC值 $C_2$ 和 $C_1$。前向角灵敏度意味着当 $\\theta$ 很小时，$R_C(\\theta)$ 接近 $C_2/C_1$，而当 $\\theta$ 较大时灵敏度减小。\n- 为将ANC与内部灵敏度进行对比，类似地定义\n$$\nR_{\\mathrm{int}}(\\theta;S_B) = \\frac{\\left|T_{fi}(\\theta;N_{\\mathrm{int},2})\\right|}{\\left|T_{fi}(\\theta;N_{\\mathrm{int},1})\\right|}\n$$\n其中 $C$ 固定，内部振幅 $N_{\\mathrm{int}}$ 变化。\n\n测试组：\n- 使用上述指定的参数计算以下五个比率，每个案例都给出了 $C_1$、$C_2$、$N_{\\mathrm{int},1}$、$N_{\\mathrm{int},2}$ 和 $S_B$ 的值。所有角度单位为弧度，结果为无量纲。\n    1. 计算 $R_C(\\theta;S_B)$，其中 $\\theta = 0.05$，$S_B = 1.0$，$C_1 = 1.0$ 且 $C_2 = 1.5$。\n    2. 计算 $R_C(\\theta;S_B)$，其中 $\\theta = 0.7$，$S_B = 1.0$，$C_1 = 1.0$ 且 $C_2 = 1.5$。\n    3. 计算 $R_C(\\theta;S_B)$，其中 $\\theta = 0.001$，$S_B = 1.0$，$C_1 = 1.0$ 且 $C_2 = 1.5$。\n    4. 计算 $R_{\\mathrm{int}}(\\theta;S_B)$，其中 $\\theta = 0.05$，$S_B = 1.0$，$C = 1.0$ 固定，且 $N_{\\mathrm{int},1} = 1.0$，$N_{\\mathrm{int},2} = 1.5$。\n    5. 计算 $R_C(\\theta;S_B)$，其中 $\\theta = 0.05$，$S_B = 0.2$，$C_1 = 1.0$ 且 $C_2 = 1.5$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含五个测试用例的结果，格式为逗号分隔的浮点数列表，保留$6$位小数，并用方括号括起来，例如 $\\big[0.000000,0.000000,0.000000,0.000000,0.000000\\big]$。", "solution": "本题的解题思路是为所提供的理论模型开发一个数值实现。问题的核心是计算DWBA跃迁振幅 $T_{fi}(\\theta)$，它由以下积分给出：\n$$\nT_{fi}(\\theta) \\propto \\int_0^{\\infty} r^2\\, u_B(r)\\, f_{\\mathrm{WS}}(r;R_0,a_0)\\, j_0\\!\\big(q(\\theta)\\, r\\big)\\, \\mathrm{d}r\n$$\n这个积分代表了由跃迁势介导的初态和末态之间的交叠。在此模型中，被积函数由四个关键部分组成：\n\n1.  相空间因子 $r^2$。\n2.  束缚态径向波函数 $u_B(r)$。该函数描述了转移的核子在其最终束缚态中的空间分布。它被建模为一个内部部分和一个由ANC $C$ 控制的渐近尾部。\n3.  一个表面峰化的跃迁形状因子 $f_{\\mathrm{WS}}(r;R_0,a_0)$，由一个Woods-Saxon函数表示。这将相互作用局限在核表面，这是直接反应的一个共同特征。\n4.  畸波交叠，此处由球贝塞尔函数 $j_0(q(\\theta)r)$ 近似。该项源于对散射态的平面波近似，并通过动量转移 $q(\\theta)$ 引入了对散射角 $\\theta$ 的依赖性。\n\n$T_{fi}(\\theta)$ 的数值计算结构如下：\n\n首先，我们定义所有指定的物理常数和模型参数。这包括折合质量 $\\mu$ 和 $\\mu_B$、动能 $E$、核半径和弥散参数（$R_0$、$a_0$、$R_{\\mathrm{int}}$、$R_m$、$a_m$）以及物理常数 $\\hbar c$。\n\n其次，我们计算依赖于特定反应条件（$\\theta$、$S_B$）的派生运动学量。\n- 入射道波数 $k$ 是根据入射弹核的动能 $E$ 和折合质量 $\\mu$ 计算的：\n  $$k = \\frac{\\sqrt{2\\,\\mu\\,E}}{\\hbar c}$$\n- 然后，动量转移 $q(\\theta)$ 作为散射角 $\\theta$ 的函数被计算出来：\n  $$q(\\theta) = 2\\,k\\,\\sin\\!\\left(\\frac{\\theta}{2}\\right)$$\n- 束缚态尾部的衰减常数 $\\kappa$ 依赖于核子的分离能 $S_B$ 和束缚态折合质量 $\\mu_B$：\n  $$\\kappa = \\frac{\\sqrt{2\\,\\mu_B\\, S_B}}{\\hbar c}$$\n\n第三，我们实现构成被积函数的各个函数。\n- Woods-Saxon形状因子 $f_{\\mathrm{WS}}(r;R_0,a_0) = \\left(1+\\exp\\left(\\frac{r-R_0}{a_0}\\right)\\right)^{-1}$。\n- 束缚态波函数 $u_B(r)$，由其内部组分 $u_{\\mathrm{int}}(r) = N_{\\mathrm{int}}\\, r\\, e^{-r/R_{\\mathrm{int}}}$、渐近尾部 $C\\,e^{-\\kappa r}$ 和平滑匹配函数 $S(r;R_m,a_m) = \\left(1+\\exp\\left(\\frac{R_m - r}{a_m}\\right)\\right)^{-1}$ 组合而成。\n- 零阶球贝塞尔函数 $j_0(x) = \\frac{\\sin(x)}{x}$。使用了一种数值稳定的实现，在 $x=0$ 处能正确计算出值为 $1$。\n\n第四，我们执行数值积分。积分的无限上界被一个足够大的半径 $r_{\\max} = 30.0\\,\\mathrm{fm}$ 所取代，超过该半径后，由于束缚态波函数和Woods-Saxon形状因子的指数衰减，被积函数可以忽略不计。径向坐标 $r$ 在从 $r=0$ 到 $r_{\\max}$ 的均匀网格上进行离散化，步长足够小以确保数值收敛。在该网格的每个点上计算被积函数，并使用梯形法则计算定积分，这是一种在 `NumPy` 中可用的标准数值求积方法。\n\n最后，为了解决灵敏度的核心问题，我们计算比率 $R_C$ 和 $R_{\\mathrm{int}}$。对于五个测试用例中的每一个，都为两组不同的参数集（例如，使用 $C_1$ 和 $C_2$，或 $N_{\\mathrm{int},1}$ 和 $N_{\\mathrm{int},2}$）计算跃迁振幅 $T_{fi}(\\theta)$。然后按照规定计算这些振幅绝对值的比率：\n$$\nR_C(\\theta;S_B) = \\frac{\\left|T_{fi}(\\theta;C_2)\\right|}{\\left|T_{fi}(\\theta;C_1)\\right|} \\quad \\text{和} \\quad R_{\\mathrm{int}}(\\theta;S_B) = \\frac{\\left|T_{fi}(\\theta;N_{\\mathrm{int},2})\\right|}{\\left|T_{fi}(\\theta;N_{\\mathrm{int},1})\\right|}\n$$\n在 $T_{fi}(\\theta)$ 的定义中，比例常数的值是无关紧要的，因为它在这些比率中被消掉了。对于参数未明确变化的情况（例如，在 $R_C$ 计算中的 $N_{\\mathrm{int}}$），使用默认值 $1.0$，这是由问题结构所隐含的。然后将得到的五个比率格式化并作为最终答案呈现。这个过程提供了一个直接的定量度量，说明波函数的渐近尾部相对于其内部的变化如何影响不同角度下的反应可观测量。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# This script implements a computational model for the distorted wave Born\n# approximation (DWBA) to analyze the sensitivity of the transition amplitude\n# to the asymptotic normalization constant (ANC) and interior part of a\n# bound-state wavefunction.\n\n# Define global constants and model parameters in a dictionary for clarity.\nPARAMS = {\n    'hbarc': 197.3269804,  # MeV*fm\n    'mu': 469.459,         # Entrance-channel reduced mass in MeV\n    'mu_B': 469.459,       # Bound-state reduced mass in MeV\n    'E': 50.0,             # Laboratory kinetic energy in MeV\n    'R0': 6.0,             # Woods-Saxon radius for form factor in fm\n    'a0': 0.6,             # Woods-Saxon diffuseness for form factor in fm\n    'R_int': 2.0,          # Scale of the interior wavefunction in fm\n    'R_m': 6.0,            # Matching radius in fm\n    'a_m': 0.5,            # Matching diffuseness in fm\n    'r_max': 30.0,         # Maximum integration radius in fm\n    'n_points': 4001,      # Number of points for the radial integration grid\n}\n\ndef woods_saxon(r, R, a):\n    \"\"\"\n    Calculates the Woods-Saxon function.\n    f(r; R, a) = 1 / (1 + exp((r - R) / a))\n    \"\"\"\n    return 1.0 / (1.0 + np.exp((r - R) / a))\n\ndef matching_function(r, R_m, a_m):\n    \"\"\"\n    Calculates the smooth matching (switch-on) function S.\n    S(r; R_m, a_m) = 1 / (1 + exp((R_m - r) / a_m))\n    \"\"\"\n    return 1.0 / (1.0 + np.exp((R_m - r) / a_m))\n\ndef u_interior(r, N_int, R_int):\n    \"\"\"\n    Calculates the interior component of the bound-state wavefunction.\n    u_int(r) = N_int * r * exp(-r / R_int)\n    \"\"\"\n    return N_int * r * np.exp(-r / R_int)\n\ndef u_bound(r, C, N_int, kappa):\n    \"\"\"\n    Calculates the full modeled bound-state radial wavefunction u_B(r).\n    u_B(r) = u_int(r)*(1-S(r)) + C*exp(-kappa*r)*S(r)\n    \"\"\"\n    u_int = u_interior(r, N_int, PARAMS['R_int'])\n    S = matching_function(r, PARAMS['R_m'], PARAMS['a_m'])\n    u_tail = C * np.exp(-kappa * r)\n    return u_int * (1.0 - S) + u_tail * S\n\ndef spherical_bessel_j0(x):\n    \"\"\"\n    Calculates the spherical Bessel function of order 0, j0(x) = sin(x)/x,\n    using a numerically stable method that handles x=0 correctly.\n    \"\"\"\n    # np.sinc(x/pi) is defined as sin(x)/x\n    return np.sinc(x / np.pi)\n\ndef calculate_T_fi(theta, S_B, C, N_int):\n    \"\"\"\n    Calculates the DWBA transition amplitude integral T_fi.\n\n    Args:\n        theta (float): Scattering angle in radians.\n        S_B (float): Separation energy in MeV.\n        C (float): Asymptotic normalization constant (ANC).\n        N_int (float): Amplitude of the interior wavefunction component.\n\n    Returns:\n        float: The value of the transition amplitude integral.\n    \"\"\"\n    # Calculate derived kinematic and bound-state parameters.\n    k = np.sqrt(2.0 * PARAMS['mu'] * PARAMS['E']) / PARAMS['hbarc']\n    kappa = np.sqrt(2.0 * PARAMS['mu_B'] * S_B) / PARAMS['hbarc']\n    q = 2.0 * k * np.sin(theta / 2.0)\n    \n    # Set up the radial grid for numerical integration.\n    r = np.linspace(0, PARAMS['r_max'], PARAMS['n_points'])\n    \n    # Calculate the components of the integrand on the grid.\n    u_b_r = u_bound(r, C, N_int, kappa)\n    f_ws_r = woods_saxon(r, PARAMS['R0'], PARAMS['a0'])\n    j0_qr = spherical_bessel_j0(q * r)\n    \n    # Form the full integrand: r^2 * u_B(r) * f_WS(r) * j0(q*r).\n    integrand = r**2 * u_b_r * f_ws_r * j0_qr\n    \n    # Perform numerical integration using the trapezoidal rule.\n    t_fi = np.trapz(integrand, r)\n    \n    return t_fi\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Define the five test cases from the problem statement.\n    # Each case is a dictionary specifying the parameters for the calculation.\n    test_cases = [\n        # 1. R_C at a small forward angle.\n        {'type': 'C', 'theta': 0.05, 'S_B': 1.0, 'val1': 1.0, 'val2': 1.5, 'fixed_param': 1.0},\n        # 2. R_C at a large angle.\n        {'type': 'C', 'theta': 0.7, 'S_B': 1.0, 'val1': 1.0, 'val2': 1.5, 'fixed_param': 1.0},\n        # 3. R_C at a very small (near-zero) forward angle.\n        {'type': 'C', 'theta': 0.001, 'S_B': 1.0, 'val1': 1.0, 'val2': 1.5, 'fixed_param': 1.0},\n        # 4. R_int at a small forward angle.\n        {'type': 'N_int', 'theta': 0.05, 'S_B': 1.0, 'val1': 1.0, 'val2': 1.5, 'fixed_param': 1.0},\n        # 5. R_C for a more weakly bound state (smaller S_B).\n        {'type': 'C', 'theta': 0.05, 'S_B': 0.2, 'val1': 1.0, 'val2': 1.5, 'fixed_param': 1.0},\n    ]\n\n    results = []\n    for case in test_cases:\n        if case['type'] == 'C':\n            # Vary ANC C, keep N_int fixed.\n            C1, C2 = case['val1'], case['val2']\n            N_int = case['fixed_param']\n            T_fi_1 = calculate_T_fi(case['theta'], case['S_B'], C1, N_int)\n            T_fi_2 = calculate_T_fi(case['theta'], case['S_B'], C2, N_int)\n        elif case['type'] == 'N_int':\n            # Vary interior amplitude N_int, keep C fixed.\n            N_int1, N_int2 = case['val1'], case['val2']\n            C = case['fixed_param']\n            T_fi_1 = calculate_T_fi(case['theta'], case['S_B'], C, N_int1)\n            T_fi_2 = calculate_T_fi(case['theta'], case['S_B'], C, N_int2)\n        \n        # Calculate the ratio of the absolute values of the amplitudes.\n        # Handle potential division by zero, although unlikely with these parameters.\n        if np.abs(T_fi_1)  1e-15:\n            ratio = float('inf') if np.abs(T_fi_2) > 1e-15 else 1.0\n        else:\n            ratio = np.abs(T_fi_2) / np.abs(T_fi_1)\n        results.append(ratio)\n        \n    # Format and print the final output as a single-line comma-separated list.\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\n# Execute the solver.\nsolve()\n\n```", "id": "3598529"}]}