{"hands_on_practices": [{"introduction": "在深入研究复杂的多参数搜索算法之前，掌握基本功至关重要。这个实践练习将引导你通过数值方法计算光学势的一个关键宏观量——体积分$J_V$。通过实现基本的梯形法则积分，你将建立起连接理论模型（伍兹-萨克森势）与可观测量之间的桥梁。此外，本练习还引入了一种简单的一维参数搜索技术（二分法），旨在通过调整势深$V_0$来匹配一个目标体积分，这为理解更高级的优化策略奠定了坚实的基础。[@problem_id:3578612]", "problem": "你的任务是开发一个完整的程序，用于实现球对称原子核中光学模型势中心实部的数值计算和一个简单的参数搜索算法。从球对称中心实光学势的物理标准定义（由Woods–Saxon形式给出）及其体积积分的定义开始。目标是计算体积积分，并在特定情况下，通过搜索过程匹配一个目标体积积分来推断深度参数。所有物理量都必须以科学上一致的方式处理，并带有明确的单位。\n\n基本原理：\n- 光学模型通过一个有效的复势来处理核子-原子核相互作用。对于其中心实部，一种常见的形式是Woods–Saxon势，其定义为径向坐标 $r$ 的函数：\n$$\nV(r) = -\\frac{V_0}{1 + \\exp\\left(\\frac{r - R}{a}\\right)} \\, ,\n$$\n其中 $V_0$ 是以 $\\mathrm{MeV}$ 为单位的正深度参数，$a$ 是以 $\\mathrm{fm}$ 为单位的弥散度参数，$R$ 是核半径参数，由 $R = r_0 A^{1/3}$ 给出，其中 $A$ 是质量数（无量纲），$r_0$ 的单位是 $\\mathrm{fm}$。\n- 中心实部的体积积分 $J_V$ 定义为\n$$\nJ_V = \\int_{\\mathbb{R}^3} V(\\mathbf{r}) \\, d^3\\mathbf{r} = 4\\pi \\int_{0}^{\\infty} V(r) \\, r^2 \\, dr \\, ,\n$$\n其单位为 $\\mathrm{MeV \\, fm^3}$。对于采用常规符号约定的吸引型Woods–Saxon势，$J_V$ 为负值。该量是衡量平均场相互作用积分强度的标准。\n\n任务：\n1. 使用梯形法则在均匀的径向网格上实现对 $J_V$ 的数值求积。以固定的步长 $\\Delta r$ 将 $r \\in [0, r_{\\max}]$ 离散化，计算被积函数 $V(r) r^2$，将积分近似为\n$$\n\\int_{0}^{r_{\\max}} V(r) \\, r^2 \\, dr \\approx \\Delta r \\left[\\tfrac{1}{2} f(0) + \\sum_{k=1}^{N-1} f(k \\Delta r) + \\tfrac{1}{2} f(r_{\\max}) \\right], \\quad f(r) \\equiv V(r) r^2 \\, ,\n$$\n然后计算 $J_V = 4\\pi \\times (\\text{梯形法则结果})$。选择足够大的 $r_{\\max}$，以使超出 $r_{\\max}$ 的尾部贡献与指定精度相比可以忽略不计。以 $\\mathrm{MeV \\, fm^3}$ 为单位表示 $J_V$。\n2. 实现一个一维参数搜索算法来估计 $V_0$，使得计算出的 $J_V$ 与指定的目标值 $J_T$ 相匹配。使用一个稳健的区间套定策略，并对函数\n$$\nF(V_0) = J_V(V_0) - J_T \\, ,\n$$\n使用二分法，其中 $J_V(V_0)$ 是给定 $V_0$ 时数值积分得到的体积积分。由于对于Woods–Saxon中心项，$J_V$ 与 $V_0$ 呈线性关系，因此在 $A, r_0, a, \\Delta r$ 和 $r_{\\max}$ 固定的情况下，$F(V_0)$ 是 $V_0$ 的单调函数。当绝对差 $\\lvert J_V(V_0) - J_T \\rvert$ 小于指定的容差时停止。以 $\\mathrm{MeV}$ 为单位表示 $V_0$。\n\n数值细节：\n- 梯形法则应严格按照上述定义使用。\n- 对每个测试用例使用指定的均匀网格间距。\n- 所有半径单位为 $\\mathrm{fm}$，所有能量单位为 $\\mathrm{MeV}$，最终的体积积分单位为 $\\mathrm{MeV \\, fm^3}$。\n- 不使用角度；因此不需要指定角度单位。\n- 对于所有测试，将报告的数值输出四舍五入到三位小数。\n\n测试套件：\n为以下四个测试用例计算结果，其设计旨在覆盖标准路径、重核系统缩放、粗网格边界条件和参数搜索：\n\n- 测试 $1$ (标准路径数值积分)：给定 $A = 40$, $r_0 = 1.25 \\, \\mathrm{fm}$, $a = 0.65 \\, \\mathrm{fm}$, 和 $V_0 = 50 \\, \\mathrm{MeV}$，使用梯形法则，步长 $\\Delta r = 0.05 \\, \\mathrm{fm}$，积分上限 $r_{\\max} = 12 \\, \\mathrm{fm}$，数值计算 $J_V$，并报告其值（单位 $\\mathrm{MeV \\, fm^3}$），精度要求在 $1 \\, \\mathrm{MeV \\, fm^3}$ 以内。\n- 测试 $2$ (重核系统)：给定 $A = 208$, $r_0 = 1.25 \\, \\mathrm{fm}$, $a = 0.63 \\, \\mathrm{fm}$, 和 $V_0 = 52 \\, \\mathrm{MeV}$，使用梯形法则，步长 $\\Delta r = 0.05 \\, \\mathrm{fm}$，积分上限 $r_{\\max} = 15 \\, \\mathrm{fm}$，数值计算 $J_V$，并报告其值（单位 $\\mathrm{MeV \\, fm^3}$），精度要求在 $1 \\, \\mathrm{MeV \\, fm^3}$ 以内。\n- 测试 $3$ (粗网格边界条件)：给定 $A = 40$, $r_0 = 1.25 \\, \\mathrm{fm}$, $a = 0.65 \\, \\mathrm{fm}$, 和 $V_0 = 50 \\, \\mathrm{MeV}$，使用梯形法则，步长 $\\Delta r = 0.5 \\, \\mathrm{fm}$，积分上限 $r_{\\max} = 12 \\, \\mathrm{fm}$，数值计算 $J_V$，并报告其值（单位 $\\mathrm{MeV \\, fm^3}$），精度要求在 $100 \\, \\mathrm{MeV \\, fm^3}$ 以内（较宽松的容差反映了离散化误差）。\n- 测试 $4$ (深度参数搜索)：给定 $A = 40$, $r_0 = 1.25 \\, \\mathrm{fm}$, $a = 0.65 \\, \\mathrm{fm}$，目标 $J_T = -20000 \\, \\mathrm{MeV \\, fm^3}$，在 $V_0 \\in [1 \\, \\mathrm{MeV}, 200 \\, \\mathrm{MeV}]$ 区间上使用二分法搜索，其中梯形法则使用 $\\Delta r = 0.05 \\, \\mathrm{fm}$ 和 $r_{\\max} = 12 \\, \\mathrm{fm}$，报告估计的 $V_0$ 值（单位 $\\mathrm{MeV}$），要求 $\\lvert J_V(V_0) - J_T \\rvert \\le 0.1 \\, \\mathrm{MeV \\, fm^3}$。\n\n最终输出格式：\n- 你的程序应生成单行输出，包含一个由方括号括起来的逗号分隔列表。该列表必须包含四个浮点数，按测试 $1$ 到 $4$ 的顺序排列，每个数都四舍五入到三位小数。例如，打印的输出应如下所示：\n$$\n[\\text{结果}_1,\\text{结果}_2,\\text{结果}_3,\\text{结果}_4] \\, .\n$$\n所有 $J_V$ 结果的单位必须是 $\\mathrm{MeV \\, fm^3}$，最后一个条目（参数搜索结果）的单位必须是 $\\mathrm{MeV}$。", "solution": "光学模型通过一个复势建立了核子-原子核相互作用的有效平均场描述；在本问题中，我们关注其中心实部，通常用Woods–Saxon形式表示。Woods–Saxon势对球对称原子核的定义为\n$$\nV(r) = -\\frac{V_0}{1 + \\exp\\left(\\frac{r - R}{a}\\right)} \\, ,\n$$\n其中 $R = r_0 A^{1/3}$。这里 $V_0$ 是以 $\\mathrm{MeV}$ 为单位的正阱深（势本身是负值），$a$ 是以 $\\mathrm{fm}$ 为单位的弥散度，$r_0$ 是以 $\\mathrm{fm}$ 为单位的半径参数。体积积分 $J_V$ 定义为势在三维空间上的积分，\n$$\nJ_V = \\int_{\\mathbb{R}^3} V(\\mathbf{r}) \\, d^3\\mathbf{r} \\, ,\n$$\n根据球对称性，这可以简化为\n$$\nJ_V = 4\\pi \\int_{0}^{\\infty} V(r) \\, r^2 \\, dr \\, .\n$$\n对于吸引势 $V(r)  0$，积分 $J_V$ 是负的。该值概括了光学势中心实部的积分强度，并广泛用于参数系统学研究和比较。\n\n为了数值计算 $J_V$，我们采用在均匀 $r$ 网格上的梯形法则。定义被积函数为 $f(r) = V(r) r^2$，对于网格点 $r_k = k \\Delta r$（其中 $k = 0, 1, \\dots, N$ 且 $N \\Delta r = r_{\\max}$），梯形法则给出\n$$\n\\int_{0}^{r_{\\max}} f(r) \\, dr \\approx \\Delta r \\left[\\tfrac{1}{2} f(0) + \\sum_{k=1}^{N-1} f(r_k) + \\tfrac{1}{2} f(r_{\\max}) \\right] \\, .\n$$\n然后将径向积分的结果乘以 $4\\pi$ 来计算完整的体积积分。选择截断半径 $r_{\\max}$，使得超出 $r_{\\max}$ 的贡献与指定容差相比可以忽略不计，这在物理上是合理的，因为当 $r$ 增加到超出核表面时，Woods–Saxon形式呈指数衰减。对于足够光滑的被积函数，梯形法则会产生一个与 $\\mathcal{O}((\\Delta r)^2)$ 成比例的标准离散化误差，我们在粗网格测试的容差中反映了这一点。\n\n对于 $V_0$ 的参数搜索，我们对函数\n$$\nF(V_0) = J_V(V_0) - J_T \\, ,\n$$\n使用二分法，其中 $J_T$ 是目标体积积分。对于Woods–Saxon形式，$J_V(V_0)$ 与 $V_0$ 成线性比例关系，因为\n$$\nV(r; V_0) = -V_0 \\, g(r), \\quad g(r) \\equiv \\frac{1}{1 + \\exp\\left(\\frac{r - R}{a}\\right)} \\, ,\n$$\n所以\n$$\nJ_V(V_0) = 4\\pi \\int_{0}^{\\infty} \\left[-V_0 \\, g(r)\\right] r^2 \\, dr = -V_0 \\, K \\, ,\n$$\n其中\n$$\nK = 4\\pi \\int_{0}^{\\infty} g(r) r^2 \\, dr > 0 \\, .\n$$\n因此，在几何参数固定的情况下，$F(V_0)$ 是 $V_0$ 的严格单调函数，这保证了只要选择的区间使得 $F(V_{\\min})$ 和 $F(V_{\\max})$ 异号，二分法就会收敛。尽管可以利用线性关系以闭合形式 $V_0 = -J_T / K$ 计算 $V_0$，但当势包含额外的非线性或能量依赖性时，实现二分法更具普适性，并且这也符合练习参数搜索算法的目标。\n\n算法步骤：\n1. 对于每个需要计算 $J_V$ 的测试用例，计算 $R = r_0 A^{1/3}$，构建网格 $r_k$ (其中 $k = 0, \\dots, N$ 且 $N = r_{\\max}/\\Delta r$)，计算 $V(r_k)$，形成 $f(r_k) = V(r_k) r_k^2$，应用梯形法则，然后乘以 $4\\pi$ 以获得单位为 $\\mathrm{MeV \\, fm^3}$ 的 $J_V$。\n2. 对于参数搜索用例，定义一个区间 $[V_{\\min}, V_{\\max}]$，其中 $V_{\\min} = 1 \\, \\mathrm{MeV}$ 和 $V_{\\max} = 200 \\, \\mathrm{MeV}$，计算 $F(V_{\\min})$ 和 $F(V_{\\max})$，并确保它们符号相反（如果不是，则扩大区间）。应用二分法：\n   - 计算 $V_{\\text{mid}} = (V_{\\min} + V_{\\max}) / 2$。\n   - 通过对 $J_V$ 进行梯形积分计算来评估 $F(V_{\\text{mid}})$。\n   - 如果 $\\lvert F(V_{\\text{mid}}) \\rvert$ 低于容差（此处为 $0.1 \\, \\mathrm{MeV \\, fm^3}$），则停止并返回 $V_{\\text{mid}}$。\n   - 否则，用 $V_{\\text{mid}}$ 替换与 $F(V_{\\text{mid}})$ 符号相同的区间端点，然后重复。\n3. 将每个报告的输出四舍五入到三位小数。\n\n科学真实性与一致性：\n- 选择 $r_{\\max} = 12 \\, \\mathrm{fm}$ 和 $r_{\\max} = 15 \\, \\mathrm{fm}$ 是合理的，因为对于典型的 $a$ 值（在 $0.6$–$0.7 \\, \\mathrm{fm}$ 范围内），Woods–Saxon形式的尾部呈指数衰减，确保在所述容差下尾部贡献可以忽略不计。\n- 使用 $\\Delta r = 0.05 \\, \\mathrm{fm}$ 对于指定的原子核来说足够精细，可以达到 $1 \\, \\mathrm{MeV \\, fm^3}$ 的精度，因为被积函数是光滑的。包含 $\\Delta r = 0.5 \\, \\mathrm{fm}$ 的粗糙情况是为了突出离散化效应，因此采用较宽松的容差是合适的。\n- 所有物理量都以正确的单位表示：半径为 $\\mathrm{fm}$，能量为 $\\mathrm{MeV}$，体积积分为 $\\mathrm{MeV \\, fm^3}$。\n\n最终程序将实现上述逻辑，并生成单行输出，其中包含四个用方括号括起来的逗号分隔的浮点数，按顺序对应于测试1到4。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef woods_saxon_potential(r, A, r0, a, V0):\n    \"\"\"\n    Woods-Saxon central real potential:\n    V(r) = -V0 / (1 + exp((r - R)/a)), with R = r0 * A^(1/3).\n    r: numpy array of radii [fm]\n    A: mass number (dimensionless)\n    r0: radius parameter [fm]\n    a: diffuseness [fm]\n    V0: depth parameter [MeV], positive (potential itself is negative)\n    Returns V(r) in MeV as numpy array.\n    \"\"\"\n    R = r0 * (A ** (1.0 / 3.0))\n    return -V0 / (1.0 + np.exp((r - R) / a))\n\ndef volume_integral_JV(A, r0, a, V0, dr, rmax):\n    \"\"\"\n    Compute J_V = 4*pi * integral_0^{rmax} V(r) * r^2 dr via trapezoidal rule.\n    Units: J_V in MeV fm^3.\n    \"\"\"\n    # Ensure inclusion of rmax endpoint\n    # Using arange may omit rmax if rmax/dr not integer; use linspace instead.\n    N = int(np.round(rmax / dr))\n    r = np.linspace(0.0, rmax, N + 1)\n    V = woods_saxon_potential(r, A, r0, a, V0)\n    integrand = V * (r ** 2)\n    radial_integral = np.trapz(integrand, r)\n    JV = 4.0 * np.pi * radial_integral\n    return JV\n\ndef find_V0_for_target_JV(A, r0, a, J_target, dr, rmax, vmin=1.0, vmax=200.0, tol=0.1, max_iter=100):\n    \"\"\"\n    Find V0 such that volume_integral_JV(A, r0, a, V0, dr, rmax) ~= J_target using bisection.\n    vmin, vmax: bracket in MeV\n    tol: tolerance on |J_V - J_target| in MeV fm^3\n    Returns estimated V0 in MeV.\n    \"\"\"\n    def F(V0):\n        return volume_integral_JV(A, r0, a, V0, dr, rmax) - J_target\n\n    # Ensure bracketing condition: F(vmin) and F(vmax) must have opposite signs\n    fmin = F(vmin)\n    fmax = F(vmax)\n    # Expand bracket if necessary (simple strategy)\n    expand_factor = 2.0\n    expansion_count = 0\n    while fmin * fmax  0 and expansion_count  10:\n        # Expand towards larger vmax to encompass target magnitude\n        vmax *= expand_factor\n        fmax = F(vmax)\n        expansion_count += 1\n\n    # If still not bracketed, try lowering vmin\n    if fmin * fmax  0:\n        vmin = max(1e-6, vmin / expand_factor)\n        fmin = F(vmin)\n        expansion_count = 0\n        while fmin * fmax  0 and expansion_count  10:\n            vmin = max(1e-6, vmin / expand_factor)\n            fmin = F(vmin)\n            expansion_count += 1\n\n    # If still not bracketed, fall back to direct linear estimate using K from V0=1 MeV\n    if fmin * fmax  0:\n        K = -volume_integral_JV(A, r0, a, 1.0, dr, rmax)  # J_V = -V0*K = K = -J_V(V0=1)\n        V0_est = -J_target / K\n        return V0_est\n\n    # Bisection iterations\n    low, high = vmin, vmax\n    for _ in range(max_iter):\n        mid = 0.5 * (low + high)\n        fmid = F(mid)\n        if abs(fmid) = tol:\n            return mid\n        # Decide which subinterval to keep\n        if fmin * fmid  0:\n            high = mid\n            fmax = fmid\n        else:\n            low = mid\n            fmin = fmid\n    # If not converged within max_iter, return midpoint\n    return 0.5 * (low + high)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each test case is a tuple:\n    # ('J', {A, r0, a, V0, dr, rmax}) - compute J_V\n    # ('search', {A, r0, a, J_target, dr, rmax}) - find V0 matching target J_V\n    test_cases = [\n        ('J', {'A': 40, 'r0': 1.25, 'a': 0.65, 'V0': 50.0, 'dr': 0.05, 'rmax': 12.0}),\n        ('J', {'A': 208, 'r0': 1.25, 'a': 0.63, 'V0': 52.0, 'dr': 0.05, 'rmax': 15.0}),\n        ('J', {'A': 40, 'r0': 1.25, 'a': 0.65, 'V0': 50.0, 'dr': 0.5, 'rmax': 12.0}),\n        ('search', {'A': 40, 'r0': 1.25, 'a': 0.65, 'J_target': -20000.0, 'dr': 0.05, 'rmax': 12.0}),\n    ]\n\n    results = []\n    for kind, params in test_cases:\n        if kind == 'J':\n            JV = volume_integral_JV(\n                A=params['A'], r0=params['r0'], a=params['a'],\n                V0=params['V0'], dr=params['dr'], rmax=params['rmax']\n            )\n            results.append(JV)\n        elif kind == 'search':\n            V0_est = find_V0_for_target_JV(\n                A=params['A'], r0=params['r0'], a=params['a'],\n                J_target=params['J_target'], dr=params['dr'], rmax=params['rmax'],\n                vmin=1.0, vmax=200.0, tol=0.1, max_iter=200\n            )\n            results.append(V0_est)\n        else:\n            # Unknown test case type; append NaN\n            results.append(float('nan'))\n\n    # Round each result to three decimal places and format as strings.\n    formatted = [f\"{x:.3f}\" for x in results]\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3578612"}, {"introduction": "实际的参数搜索任务的目标是使模型预测与实验数据达成最佳匹配，而不仅仅是拟合单个目标值。这需要一个统计上的“拟合优度”度量标准来量化模型与数据之间的一致性。这个练习将我们从具体的物理计算中抽离出来，专注于所有参数搜索算法旨在最小化的核心目标函数——约化卡方($\\chi^2_{\\text{red}}$)的统计意义。通过计算并解读$\\chi^2_{\\text{red}}$，你将能深刻理解评估模型性能和判断拟合是否成功的基本准则。[@problem_id:3578611]", "problem": "在计算核物理中，参数搜索算法通过最小化测量和模型的微分截面之间的加权失配，来确定核子-原子核弹性散射中复光学势的参数。考虑一个使用 Levenberg–Marquardt (LM) 算法在 $k$ 维参数空间中进行的搜索，该搜索针对一个光学模型，其理论角分布 $y_i^{\\text{th}}$ 与 $n$ 个散射角下的实验数据 $y_i^{\\text{exp}}$ 进行比较。假设一个相对误差模型，其中每个数据点的不确定度为 $\\sigma_i = \\alpha\\, y_i^{\\text{exp}}$，$\\alpha$ 在所有角度上为常数，并将标准化残差定义为 $r_i = (y_i^{\\text{exp}} - y_i^{\\text{th}})/\\sigma_i$。在此类参数搜索中采用的加权失配是基于标准化残差的平方和，而拟合优度通过约化卡方来评估，它将平均标准化失配的平方与拟合的自由度进行比较。\n\n假设对于 $n=50$ 个角数据点和 $k=6$ 个拟合的光学势参数，平均标准化残差量值（理解为标准化残差的均方根）满足 $\\sqrt{\\frac{1}{n}\\sum_{i=1}^{n} r_i^2} = 1.5$。仅使用标准化残差、卡方统计量和自由度概念的基本定义，计算约化卡方 $\\chi^2_{\\text{red}} = \\chi^2/(n-k)$。将最终值四舍五入到四位有效数字，并将约化卡方视为一个无量纲量。此外，从业内光学势参数搜索算法中的模型充分性和误差缩放方面简要解释该值。", "solution": "该问题要求计算光学势模型与实验数据拟合的约化卡方统计量 $\\chi^2_{\\text{red}}$，并对结果值进行解释。\n\n提供的信息如下：\n实验数据点的数量，$n = 50$。\n光学模型中拟合参数的数量，$k = 6$。\n平均标准化残差量值，定义为标准化残差的均方根（RMS），由一个特定值给出：\n$$\n\\sqrt{\\frac{1}{n}\\sum_{i=1}^{n} r_i^2} = 1.5\n$$\n其中 $r_i$ 是标准化残差。\n\n求解过程首先将给定的RMS值与卡方统计量 $\\chi^2$ 相关联，然后使用约化卡方统计量的定义。\n\n首先，我们将给定的标准化残差RMS方程平方：\n$$\n\\frac{1}{n}\\sum_{i=1}^{n} r_i^2 = (1.5)^2 = 2.25\n$$\n卡方统计量 $\\chi^2$ 定义为标准化残差的平方和：\n$$\n\\chi^2 = \\sum_{i=1}^{n} r_i^2\n$$\n通过重新整理上一个方程，我们可以用 $n$ 来表示 $\\chi^2$：\n$$\n\\chi^2 = \\sum_{i=1}^{n} r_i^2 = n \\times 2.25\n$$\n代入值 $n=50$：\n$$\n\\chi^2 = 50 \\times 2.25 = 112.5\n$$\n接下来，我们确定拟合的自由度 $\\nu$。自由度定义为数据点的数量减去拟合参数的数量：\n$$\n\\nu = n - k\n$$\n代入给定的 $n$ 和 $k$ 的值：\n$$\n\\nu = 50 - 6 = 44\n$$\n约化卡方 $\\chi^2_{\\text{red}}$ 定义为卡方统计量除以自由度：\n$$\n\\chi^2_{\\text{red}} = \\frac{\\chi^2}{\\nu} = \\frac{\\chi^2}{n-k}\n$$\n现在我们可以代入计算出的 $\\chi^2$ 和 $\\nu$ 的值：\n$$\n\\chi^2_{\\text{red}} = \\frac{112.5}{44}\n$$\n进行除法运算得到：\n$$\n\\chi^2_{\\text{red}} \\approx 2.55681818...\n$$\n问题要求将此值四舍五入到四位有效数字。\n$$\n\\chi^2_{\\text{red}} \\approx 2.557\n$$\n\n最后，我们对这个值进行简要解释。在统计数据拟合中，一个“好”的拟合，即模型的偏差与估计的实验不确定度相当，其特征通常是约化卡方值接近于1，即 $\\chi^2_{\\text{red}} \\approx 1$。\n计算出的值 $\\chi^2_{\\text{red}} \\approx 2.557$ 显著大于1。这表明拟合优度较差。对于这样的结果，有两种主要解释：\n1.  **模型不充分**：光学势模型的函数形式，即使使用了通过 Levenberg-Marquardt 算法找到的最佳拟合参数，也不足以准确描述实验散射数据。模型与数据之间存在系统性差异，这些差异大于仅由随机实验误差所能预期的。\n2.  **误差低估**：实验不确定度 $\\sigma_i$ 可能被系统性地低估了。如果真实的不确定度大于计算中使用的不确定度（即，$\\sigma_i = \\alpha y_i^{\\text{exp}}$ 中的相对误差因子 $\\alpha$ 选择得太小），那么标准化残差 $r_i = (y_i^{\\text{exp}} - y_i^{\\text{th}})/\\sigma_i$ 将被人为地夸大，从而导致一个大的 $\\chi^2$ 值，并因此得到一个大的 $\\chi^2_{\\text{red}}$。\n在参数搜索的背景下，这个结果表明最小化过程收敛到了一个在统计上仍然与数据不一致的解，这促使人们重新评估物理模型本身或假设的误差分布。", "answer": "$$\n\\boxed{2.557}\n$$", "id": "3578611"}, {"introduction": "在理解了最小化$\\chi^2$的目标之后，我们将深入探讨实现这一目标的强大工具——基于梯度的局部优化算法。本练习模拟了优化过程中的一个迭代引力点，为你提供了局部梯度和近似Hessian矩阵的关键信息。你的任务是计算并比较两种在核物理参数搜索中广泛应用的算法——高斯-牛顿（Gauss-Newton）法和列文伯格-马夸尔特（Levenberg-Marquardt）法的参数更新步长。这提供了一个宝贵的机会，让你能够“打开黑箱”，具体地看到这些高效算法是如何利用局部曲率信息来迭代地寻找最优参数的。[@problem_id:3578676]", "problem": "在将一个双参数的 Woods–Saxon 光学模型与弹性散射数据进行拟合时，考虑加权非线性最小二乘目标函数 $\\chi^{2}(\\boldsymbol{p}) = \\boldsymbol{r}(\\boldsymbol{p})^{T} W \\boldsymbol{r}(\\boldsymbol{p})$，其中 $\\boldsymbol{p} \\in \\mathbb{R}^{2}$ 表示一个经过缩放的无量纲参数矢量，$\\boldsymbol{r}(\\boldsymbol{p})$ 是残差矢量（数据减去在 $\\boldsymbol{p}$ 处评估的模型预测值），$W$ 是一个对称正定权重矩阵，而 $J$ 是 $\\boldsymbol{r}(\\boldsymbol{p})$ 关于 $\\boldsymbol{p}$ 的雅可比矩阵。在当前迭代点 $\\boldsymbol{p}_{k}$，可用的局部灵敏度信息汇总如下\n$$\nJ^{T} W J \\;=\\; \\begin{pmatrix} 400  -120 \\\\ -120  50 \\end{pmatrix}, \n\\qquad\nJ^{T} W \\boldsymbol{r} \\;=\\; \\begin{pmatrix} -80 \\\\ 30 \\end{pmatrix}.\n$$\n假设采用加权最小二乘的标准 Gauss–Newton 线性化方法，以及 Levenberg–Marquardt (LM) 阻尼法，其中阻尼参数 $\\lambda = 10$，缩放矩阵 $D = \\mathrm{diag}(1,1)$，请确定：\n- 在 $\\boldsymbol{p}_{k}$ 处的 Gauss–Newton 步长 $\\Delta \\boldsymbol{p}_{\\mathrm{GN}}$，以及\n- 在 $\\boldsymbol{p}_{k}$ 处的 Levenberg–Marquardt 步长 $\\Delta \\boldsymbol{p}_{\\mathrm{LM}}$。\n\n在本次计算中，将参数视为无量纲。提供精确值（不进行四舍五入）。将您的最终结果以单行矩阵的形式报告，顺序为 $(\\Delta p_{\\mathrm{GN},1}, \\Delta p_{\\mathrm{GN},2}, \\Delta p_{\\mathrm{LM},1}, \\Delta p_{\\mathrm{LM},2})$。", "solution": "我们从加权非线性最小二乘目标 $\\chi^{2}(\\boldsymbol{p}) = \\boldsymbol{r}(\\boldsymbol{p})^{T} W \\boldsymbol{r}(\\boldsymbol{p})$ 的定义开始，其梯度由 $\\nabla \\chi^{2}(\\boldsymbol{p}) = J^{T} W \\boldsymbol{r}(\\boldsymbol{p})$ 给出。一个二阶泰勒模型使用精确的海森矩阵 $\\nabla^{2} \\chi^{2}(\\boldsymbol{p})$，但对于最小二乘问题，一个标准且经过充分检验的近似是 Gauss–Newton 近似，\n$$\n\\nabla^{2} \\chi^{2}(\\boldsymbol{p}) \\;\\approx\\; J^{T} W J,\n$$\n它忽略了残差的二阶张量。Gauss–Newton 步长 $\\Delta \\boldsymbol{p}_{\\mathrm{GN}}$ 定义为通过最小化二次模型得到的线性系统的解，\n$$\n\\left(J^{T} W J\\right) \\, \\Delta \\boldsymbol{p}_{\\mathrm{GN}} \\;=\\; - \\, J^{T} W \\boldsymbol{r}.\n$$\n根据提供的汇总信息，\n$$\nJ^{T} W J \\;=\\; \\begin{pmatrix} 400  -120 \\\\ -120  50 \\end{pmatrix}, \n\\qquad\nJ^{T} W \\boldsymbol{r} \\;=\\; \\begin{pmatrix} -80 \\\\ 30 \\end{pmatrix},\n$$\nGauss–Newton 步长为\n$$\n\\Delta \\boldsymbol{p}_{\\mathrm{GN}} \\;=\\; - \\left(J^{T} W J\\right)^{-1} \\left(J^{T} W \\boldsymbol{r}\\right).\n$$\n我们计算 $\\left(J^{T} W J\\right)^{-1}$。对于\n$$\nM \\;=\\; \\begin{pmatrix} 400  -120 \\\\ -120  50 \\end{pmatrix},\n$$\n行列式为\n$$\n\\det(M) \\;=\\; 400 \\cdot 50 \\;-\\; (-120)\\cdot(-120) \\;=\\; 20000 \\;-\\; 14400 \\;=\\; 5600,\n$$\n逆矩阵为\n$$\nM^{-1} \\;=\\; \\frac{1}{5600}\\begin{pmatrix} 50  120 \\\\ 120  400 \\end{pmatrix}.\n$$\n因此\n$$\nM^{-1} \\left(J^{T} W \\boldsymbol{r}\\right) \\;=\\; \\frac{1}{5600} \n\\begin{pmatrix} 50  120 \\\\ 120  400 \\end{pmatrix}\n\\begin{pmatrix} -80 \\\\ 30 \\end{pmatrix}\n\\;=\\; \\frac{1}{5600} \n\\begin{pmatrix} 50(-80) + 120(30) \\\\ 120(-80) + 400(30) \\end{pmatrix}\n\\;=\\; \\frac{1}{5600} \\begin{pmatrix} -400 \\\\ 2400 \\end{pmatrix}\n\\;=\\; \\begin{pmatrix} -\\frac{1}{14} \\\\ \\frac{3}{7} \\end{pmatrix}.\n$$\n所以，\n$$\n\\Delta \\boldsymbol{p}_{\\mathrm{GN}} \\;=\\; - \\begin{pmatrix} -\\frac{1}{14} \\\\ \\frac{3}{7} \\end{pmatrix}\n\\;=\\; \\begin{pmatrix} \\frac{1}{14} \\\\ -\\frac{3}{7} \\end{pmatrix}.\n$$\n\n接下来，Levenberg–Marquardt (LM) 方法通过一个半正定阻尼项来增广 Gauss–Newton 系统，以提高其稳健性。使用阻尼参数 $\\lambda  0$ 和缩放矩阵 $D$，LM 步长 $\\Delta \\boldsymbol{p}_{\\mathrm{LM}}$ 通过求解以下方程得到\n$$\n\\left(J^{T} W J + \\lambda D^{T} D\\right)\\Delta \\boldsymbol{p}_{\\mathrm{LM}} \\;=\\; - \\, J^{T} W \\boldsymbol{r}.\n$$\n给定 $\\lambda = 10$ 和 $D = \\mathrm{diag}(1,1)$，我们有 $D^{T}D = I$ 以及\n$$\nJ^{T} W J + \\lambda I \\;=\\; \n\\begin{pmatrix} 400  -120 \\\\ -120  50 \\end{pmatrix}\n\\;+\\; 10 \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}\n\\;=\\; \\begin{pmatrix} 410  -120 \\\\ -120  60 \\end{pmatrix}.\n$$\n令\n$$\n\\widetilde{M} \\;=\\; \\begin{pmatrix} 410  -120 \\\\ -120  60 \\end{pmatrix}.\n$$\n其行列式为\n$$\n\\det(\\widetilde{M}) \\;=\\; 410 \\cdot 60 \\;-\\; (-120)\\cdot(-120) \\;=\\; 24600 \\;-\\; 14400 \\;=\\; 10200,\n$$\n其逆矩阵为\n$$\n\\widetilde{M}^{-1} \\;=\\; \\frac{1}{10200}\\begin{pmatrix} 60  120 \\\\ 120  410 \\end{pmatrix}.\n$$\n因此\n$$\n\\widetilde{M}^{-1}\\left(J^{T} W \\boldsymbol{r}\\right) \\;=\\; \\frac{1}{10200}\n\\begin{pmatrix} 60  120 \\\\ 120  410 \\end{pmatrix}\n\\begin{pmatrix} -80 \\\\ 30 \\end{pmatrix}\n\\;=\\; \\frac{1}{10200} \\begin{pmatrix} 60(-80) + 120(30) \\\\ 120(-80) + 410(30) \\end{pmatrix}\n\\;=\\; \\frac{1}{10200} \\begin{pmatrix} -1200 \\\\ 2700 \\end{pmatrix}\n\\;=\\; \\begin{pmatrix} -\\frac{2}{17} \\\\ \\frac{9}{34} \\end{pmatrix}.\n$$\n所以，\n$$\n\\Delta \\boldsymbol{p}_{\\mathrm{LM}} \\;=\\; - \\begin{pmatrix} -\\frac{2}{17} \\\\ \\frac{9}{34} \\end{pmatrix}\n\\;=\\; \\begin{pmatrix} \\frac{2}{17} \\\\ -\\frac{9}{34} \\end{pmatrix}.\n$$\n\n作为一致性检验，阻尼参数 $\\lambda = 10$ 产生的步长与 Gauss–Newton 步长相比，其分量的量值有所减小，这与 Levenberg–Marquardt 的正则化效应是一致的。\n\n最后，将各分量按要求的顺序 $(\\Delta p_{\\mathrm{GN},1}, \\Delta p_{\\mathrm{GN},2}, \\Delta p_{\\mathrm{LM},1}, \\Delta p_{\\mathrm{LM},2})$ 整理，得到\n$$\n\\left( \\frac{1}{14}, \\; -\\frac{3}{7}, \\; \\frac{2}{17}, \\; -\\frac{9}{34} \\right).\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{1}{14}  -\\frac{3}{7}  \\frac{2}{17}  -\\frac{9}{34}\\end{pmatrix}}$$", "id": "3578676"}]}