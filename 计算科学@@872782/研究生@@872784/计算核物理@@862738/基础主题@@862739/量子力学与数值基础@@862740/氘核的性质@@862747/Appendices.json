{"hands_on_practices": [{"introduction": "研究氘核的基石是求解不含时薛定谔方程。本练习将提供处理这一基本问题的动手实践。通过实现并比较两种强大的数值技术——有限差分法和谱方法——您将对它们各自在精度和计算效率方面的优缺点获得实践性的见解，这是任何计算物理学家都应具备的关键技能。", "problem": "考虑质子-中子系统（氘核）在非相对论极限下的束缚态，该束缚态由S波通道中约化径向波函数 $u(r)$ 的径向定态薛定谔方程建模：\n$$\n-\\frac{\\hbar^2}{2\\mu}\\frac{d^2 u(r)}{dr^2} + V(r)\\,u(r) = E\\,u(r),\n$$\n边界条件为 $u(0)=0$ 且当 $r\\to \\infty$ 时 $u(r)\\to 0$。此处，$\\mu$ 是质子-中子系统的约化质量，而 $E$ 是结合能（对于束缚态为负值）。单位制中，长度单位为费米，能量单位为兆电子伏特。使用 $\\hbar c$ 以便 $\\hbar^2/(2\\mu)$ 的单位能以兆电子伏特乘以费米平方再除以兆电子伏特的形式一致地表示，最终得到兆电子伏特。约化质量 $\\mu$ 由质子质量 $m_p$ 和中子质量 $m_n$ 计算得出：$\\mu = \\frac{m_p m_n}{m_p + m_n}$。\n\n假设核相互作用由单π介子交换（OPE）中心汤川势加上一个正则化的接触相互作用给出，这与低能手征有效场论一致，定义如下\n$$\nV(r) = V_{\\text{Y}}(r) + V_{\\text{C}}(r),\n$$\n其中中心汤川势为\n$$\nV_{\\text{Y}}(r) = -C_Y \\frac{e^{-m_\\pi r}}{r},\n$$\n正则化的接触相互作用为\n$$\nV_{\\text{C}}(r) = C_0 \\exp\\left(-\\left(\\frac{r}{R_0}\\right)^2\\right).\n$$\n使用以下常数：\n- $\\hbar c = 197.3269804$ 兆电子伏特·费米，\n- $m_p = 938.2720813$ 兆电子伏特，\n- $m_n = 939.5654133$ 兆电子伏特，\n- $m_\\pi = 138.0$ 兆电子伏特，\n- $C_Y = 40.0$ 兆电子伏特·费米，\n- $C_0 = -300.0$ 兆电子伏特，\n- $R_0 = 0.6$ 费米。\n\n使用 $m_\\pi^{(\\text{fm}^{-1})} = \\frac{m_\\pi}{\\hbar c}$ 将π介子质量 $m_\\pi$ 转换为逆费米单位，以便在汤川因子中使用。箱体尺寸为 $L$ 费米，问题在区间 $r\\in[0,L]$ 上提出，并采用Dirichlet边界条件 $u(0)=0$ 和 $u(L)=0$ 来近似 $u(r\\to\\infty)=0$。\n\n实现两种数值方法来近似基态结合能：\n1. 在具有 $N$ 个内部点和间距 $\\Delta r = \\frac{L}{N+1}$ 的均匀网格上，采用标准的二阶中心有限差分格式，得到一个三对角哈密顿矩阵，其元素为\n$$\nH_{jj} = \\frac{\\hbar^2}{\\mu \\Delta r^2} + V(r_j), \\quad H_{j,j\\pm 1} = -\\frac{\\hbar^2}{2\\mu \\Delta r^2},\n$$\n其中 $r_j = j \\Delta r$ 为内部网格点（$j = 1,2,\\dots,N$），且 $V(r_j)$ 在这些点上求值。\n2. 在 $[0,L]$ 上使用傅里叶正弦基（伪谱配置法）的谱Galerkin方法，基函数有 $N$ 个，即 $\\{\\phi_n(r)\\}_{n=1}^N$，其中\n$$\n\\phi_n(r) = \\sqrt{\\frac{2}{L}}\\sin\\left(\\frac{n\\pi r}{L}\\right).\n$$\n动能算符在此基下是对角的，其本征值为\n$$\nT_n = \\frac{\\hbar^2}{2\\mu}\\left(\\frac{n\\pi}{L}\\right)^2.\n$$\n使用均匀求积法，在相同的 $N$ 个内部点 $r_j = j \\Delta r$ 上近似势能矩阵元，即\n$$\nV_{nm} \\approx \\Delta r \\sum_{j=1}^N \\phi_n(r_j)\\,V(r_j)\\,\\phi_m(r_j),\n$$\n以构建一个稠密哈密顿矩阵 $H_{nm} = T_n \\delta_{nm} + V_{nm}$。\n\n对于这两种方法，计算各自哈密顿量的最小本征值，并将其解释为基态能量 $E$，单位为兆电子伏特。通过在相同箱体尺寸 $L$ 上使用大基组尺寸的谱Galerkin方法，定义一个高精度参考解 $E_{\\text{ref}}$。\n\n你的程序必须：\n- 使用以上常数，并根据 $m_p$ 和 $m_n$ 计算约化质量 $\\mu$。\n- 实现所述的两种数值方法。\n- 使用谱方法，以 $N_{\\text{ref}} = 512$ 和箱体尺寸 $L = 20.0$ 费米，计算一个参考基态能量 $E_{\\text{ref}}$。\n- 对以下测试套件评估绝对误差 $|E - E_{\\text{ref}}|$：\n    - 情况 1：$L = 20.0$ 费米, $N = 64$，\n    - 情况 2：$L = 20.0$ 费米, $N = 128$，\n    - 情况 3：$L = 20.0$ 费米, $N = 256$。\n对于每种情况，计算有限差分法和谱方法的绝对误差。\n\n所有能量和误差均以兆电子伏特表示，报告的误差四舍五入到六位小数。此问题不涉及角度。你的程序应生成单行输出，包含一个由方括号括起来的逗号分隔列表中的六个结果，顺序如下\n$$\n[\\;|E_{\\text{FD}}^{(64)} - E_{\\text{ref}}|,\\;|E_{\\text{SP}}^{(64)} - E_{\\text{ref}}|,\\;|E_{\\text{FD}}^{(128)} - E_{\\text{ref}}|,\\;|E_{\\text{SP}}^{(128)} - E_{\\text{ref}}|,\\;|E_{\\text{FD}}^{(256)} - E_{\\text{ref}}|,\\;|E_{\\text{SP}}^{(256)} - E_{\\text{ref}}|\\;],\n$$\n其中 $E_{\\text{FD}}^{(N)}$ 和 $E_{\\text{SP}}^{(N)}$ 分别表示使用 $N$ 个内部点或基函数，在箱体 $[0,L]$ 上通过有限差分法和谱方法获得的基态能量。最终输出必须严格遵循“[result1,result2,result3,result4,result5,result6]”的格式。", "solution": "出发点是S波氘核的非相对论径向薛定谔方程，其形式如下\n$$\n-\\frac{\\hbar^2}{2\\mu}\\frac{d^2 u(r)}{dr^2} + V(r)\\,u(r) = E\\,u(r),\n$$\n其边界条件为 $u(0)=0$ 和 $u(r\\to\\infty)=0$，且 $l=0$，因此没有离心势项。质子-中子系统的约化质量 $\\mu$ 由质子质量 $m_p$ 和中子质量 $m_n$ 计算得出\n$$\n\\mu = \\frac{m_p m_n}{m_p + m_n}.\n$$\n我们在有限区间 $[0,L]$ 上求解，并施加Dirichlet边界条件 $u(0)=0$ 和 $u(L)=0$ 来近似束缚态条件。\n\n核势被建模为单π介子交换（OPE）中心汤川项和正则化接触相互作用之和。OPE中心汤川项为\n$$\nV_{\\text{Y}}(r) = -C_Y \\frac{e^{-m_\\pi r}}{r},\n$$\n其中 $m_\\pi$ 是以逆费米为单位的π介子质量。为使用以兆电子伏特为单位的 $m_\\pi$，我们通过以下方式转换\n$$\nm_\\pi^{(\\text{fm}^{-1})} = \\frac{m_\\pi^{(\\text{MeV})}}{\\hbar c},\n$$\n其中 $\\hbar c$ 的单位是兆电子伏特·费米。正则化接触相互作用模拟了短程物理，并选择高斯正则化形式：\n$$\nV_{\\text{C}}(r) = C_0 \\exp\\left(-\\left(\\frac{r}{R_0}\\right)^2\\right).\n$$\n因此，总势能为\n$$\nV(r) = -C_Y \\frac{e^{-m_\\pi r}}{r} + C_0 \\exp\\left(-\\left(\\frac{r}{R_0}\\right)^2\\right).\n$$\n\n为了数值计算束缚态能量，我们将问题离散化并求解相应的矩阵本征值问题。我们采用两种方法：\n\n1. 有限差分法 (FDM):\n我们定义一个包含 $N$ 个内部点的均匀网格，间距为\n$$\n\\Delta r = \\frac{L}{N+1},\n$$\n网格点为 $r_j = j \\Delta r$，其中 $j=1,2,\\dots,N$。二阶导数使用标准中心有限差分近似：\n$$\n\\frac{d^2 u}{dr^2}\\bigg|_{r_j} \\approx \\frac{u_{j+1} - 2 u_j + u_{j-1}}{\\Delta r^2}.\n$$\n动能算符 $-\\frac{\\hbar^2}{2\\mu}\\frac{d^2}{dr^2}$ 由此导出一个三对角矩阵，其矩阵元为\n$$\nH_{jj} = \\frac{\\hbar^2}{\\mu \\Delta r^2} + V(r_j), \\quad H_{j,j\\pm 1} = -\\frac{\\hbar^2}{2\\mu \\Delta r^2}.\n$$\n这个 $N\\times N$ 的三对角哈密顿量通过不包含 $r=0$ 和 $r=L$ 处的点，隐式地包含了Dirichlet边界条件。该矩阵的最小本征值近似为基态能量 $E$。\n\n2. 使用傅里叶正弦基的谱Galerkin方法：\n我们使用区间 $[0,L]$ 上的规范正交基函数，\n$$\n\\phi_n(r) = \\sqrt{\\frac{2}{L}}\\sin\\left(\\frac{n\\pi r}{L}\\right), \\quad n=1,2,\\dots,N.\n$$\n这些基函数满足Dirichlet边界条件 $\\phi_n(0)=\\phi_n(L)=0$。动能算符在此基下是对角的，其本征值为\n$$\nT_n = \\frac{\\hbar^2}{2\\mu}\\left(\\frac{n\\pi}{L}\\right)^2.\n$$\n势能矩阵元由以下积分给出\n$$\nV_{nm} = \\int_0^L \\phi_n(r)\\,V(r)\\,\\phi_m(r)\\,dr.\n$$\n我们使用均匀求积法（黎曼和），在相同的 $N$ 个内部点 $r_j = j \\Delta r$ 上近似此积分：\n$$\nV_{nm} \\approx \\Delta r \\sum_{j=1}^N \\phi_n(r_j)\\,V(r_j)\\,\\phi_m(r_j).\n$$\n在此基下的哈密顿矩阵为\n$$\nH_{nm} = T_n \\delta_{nm} + V_{nm}.\n$$\n然后，我们计算这个稠密对称矩阵的最小本征值，以近似基态能量 $E$。\n\n参考解：\n为评估精度，我们使用谱Galerkin方法，在尺寸为 $L=20.0$ 费米的箱体上，采用 $N_{\\text{ref}}=512$ 个基函数来计算一个高精度的参考基态能量 $E_{\\text{ref}}$。这为我们计算其他离散化方案的绝对误差提供了一个基准：\n$$\n\\text{error} = |E - E_{\\text{ref}}|.\n$$\n\n算法步骤：\n- 计算常数：$\\hbar c$, $m_p$, $m_n$, 以及约化质量 $\\mu = \\frac{m_p m_n}{m_p + m_n}$。\n- 通过 $m_\\pi^{(\\text{fm}^{-1})} = \\frac{m_\\pi}{\\hbar c}$ 将 $m_\\pi$ 从兆电子伏特转换为逆费米。\n- 实现一个函数，使用给定的 $C_Y$、$C_0$ 和 $R_0$ 在任意 $r>0$ 处计算 $V(r)$。\n- 针对给定的 $N$ 和 $L$，实现FDM哈密顿矩阵的构建，并使用三对角本征值求解器计算其最小本征值。\n- 针对给定的 $N$ 和 $L$，使用正弦基实现谱Galerkin哈密顿矩阵，组装对角动能矩阵和基于求积的势能矩阵，并使用稠密对称本征值求解器计算其最小本征值。\n- 使用谱方法，以 $N_{\\text{ref}}=512$ 和 $L=20.0$ 计算 $E_{\\text{ref}}$。\n- 对于测试套件中的情况 $(N,L) = (64,20.0)$、$(128,20.0)$ 和 $(256,20.0)$，计算有限差分法和谱方法的基态能量，以及它们相对于 $E_{\\text{ref}}$ 的绝对误差。\n- 将每个误差四舍五入到六位小数，并以指定的单行列表格式打印它们。\n\n科学原理：\n薛定谔方程是在非相对论范畴内支配氘核束缚态波函数的基本定律。OPE中心汤川势是手征有效场论中核力的主要长程分量，而短程物理则由正则化的接触相互作用来描述。有限差分法在均匀网格上离散化拉普拉斯算符，提供了一种简单而系统性的近似方法。谱Galerkin方法利用了满足边界条件的动能算符的已知本征函数，为光滑势能提供了快速收敛。将这两种方法与高分辨率谱参考进行比较，可以量化当 $N$ 增加而箱体尺寸固定时，方法的精度和收敛行为。\n\n单位：\n所有能量（包括 $E$ 和 $E_{\\text{ref}}$）和误差必须以兆电子伏特表示，并以浮点小数形式报告。最终输出必须是单行\n$$\n[\\;|E_{\\text{FD}}^{(64)} - E_{\\text{ref}}|,\\;|E_{\\text{SP}}^{(64)} - E_{\\text{ref}}|,\\;|E_{\\text{FD}}^{(128)} - E_{\\text{ref}}|,\\;|E_{\\text{SP}}^{(128)} - E_{\\text{ref}}|,\\;|E_{\\text{FD}}^{(256)} - E_{\\text{ref}}|,\\;|E_{\\text{SP}}^{(256)} - E_{\\text{ref}}|\\;],\n$$\n每个浮点数四舍五入到六位小数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import eigh_tridiagonal\nfrom numpy.linalg import eigh\n\n# Constants (in MeV and fm units)\nHBAR_C = 197.3269804  # MeV*fm\nM_P = 938.2720813     # MeV\nM_N = 939.5654133     # MeV\n\n# Reduced mass (MeV) in natural units (c=1)\nMU = (M_P * M_N) / (M_P + M_N)\n\n# Potential parameters\nM_PI_MEV = 138.0                 # MeV\nM_PI_FM_INV = M_PI_MEV / HBAR_C  # 1/fm\nC_Y = 40.0                       # MeV*fm for Yukawa\nC0 = -300.0                      # MeV for contact\nR0 = 0.6                         # fm for contact regulator\n\ndef potential(r):\n    \"\"\"\n    Compute the nuclear potential V(r) = Yukawa + Gaussian contact at radial distance r (fm).\n    Returns energy in MeV.\n    \"\"\"\n    # Avoid division by zero; r is never zero on interior points.\n    vy = -C_Y * np.exp(-M_PI_FM_INV * r) / r\n    vc = C0 * np.exp(-(r / R0) ** 2)\n    return vy + vc\n\ndef fd_ground_energy(N, L):\n    \"\"\"\n    Finite-difference method ground-state energy for given N interior points and box size L (fm).\n    Returns the smallest eigenvalue (MeV).\n    \"\"\"\n    dr = L / (N + 1)\n    r = (np.arange(1, N + 1)) * dr\n    V = potential(r)\n\n    # Kinetic prefactor: - (hbar^2 / (2 mu)) d^2/dr^2\n    # For the discrete Hamiltonian, diag and off-diagonal entries as per central difference.\n    kinetic_diag = (HBAR_C ** 2) / (MU * dr * dr)   # MeV\n    kinetic_off = - (HBAR_C ** 2) / (2.0 * MU * dr * dr)  # MeV\n\n    d = kinetic_diag + V                # main diagonal\n    e = np.full(N - 1, kinetic_off)     # off-diagonal entries\n\n    # Compute eigenvalues of tridiagonal symmetric matrix\n    evals = eigh_tridiagonal(d, e, select='i', select_range=(0, 0))[0]\n    return float(evals[0])\n\ndef spectral_ground_energy(N, L):\n    \"\"\"\n    Spectral Galerkin method using Fourier sine basis with N modes on [0, L] (fm).\n    Constructs the Hamiltonian in the sine basis and returns the smallest eigenvalue (MeV).\n    \"\"\"\n    dr = L / (N + 1)\n    r = (np.arange(1, N + 1)) * dr  # interior points\n    V = potential(r)\n\n    # Build the basis function values Phi[j, n] = sqrt(2/L) * sin(n*pi*r_j/L)\n    n_idx = np.arange(1, N + 1)\n    k = (n_idx * np.pi) / L\n    Phi = np.sqrt(2.0 / L) * np.sin(np.outer(r, k))  # shape (N, N)\n\n    # Kinetic energy diagonal in the sine basis: T_n = (hbar^2 / (2 mu)) * k_n^2\n    T_diag = (HBAR_C ** 2) * (k ** 2) / (2.0 * MU)\n\n    # Potential matrix via quadrature: V_nm ≈ dr * sum_j Phi[j,n] * V(r_j) * Phi[j,m]\n    # Compute S = sqrt(dr) * Phi, then V_nm = (S^T * diag(V) * S) for numerical stability\n    # But since dr is scalar, we can do directly:\n    # temp = (V[:, None] * Phi) has shape (N, N)\n    temp = V[:, None] * Phi\n    V_mat = dr * (Phi.T @ temp)  # (N, N)\n\n    # Hamiltonian in the basis\n    H = V_mat + np.diag(T_diag)\n\n    # Dense symmetric eigenvalue problem\n    evals = eigh(H)[0]\n    return float(evals[0])\n\ndef solve():\n    # Box size for all test cases\n    L = 20.0\n\n    # Reference energy using spectral method with high resolution\n    N_ref = 512\n    E_ref = spectral_ground_energy(N_ref, L)\n\n    # Test suite: (N, L) values\n    test_cases = [\n        (64, L),\n        (128, L),\n        (256, L),\n    ]\n\n    results = []\n    for N, L_case in test_cases:\n        E_fd = fd_ground_energy(N, L_case)\n        E_sp = spectral_ground_energy(N, L_case)\n        err_fd = abs(E_fd - E_ref)\n        err_sp = abs(E_sp - E_ref)\n        # Round to six decimal places as required\n        results.append(round(err_fd, 6))\n        results.append(round(err_sp, 6))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3582617"}, {"introduction": "一旦知道了氘核的波函数，我们就可以计算表征其结构的物理可观测量。本实践从求解波函数转向计算关键属性，如电四极矩 $Q_d$ 和渐近 $D/S$ 比值 $\\eta$。通过使用一个具有物理动机的波函数模型，您将直接探索其 $S$ 波和 $D$ 波分量如何导致氘核的非球形形状，并将这些理论计算与实验值联系起来。", "problem": "您的任务是编写一个完整的、可运行的程序，来计算渐近氘核 $D/S$ 比，并交叉检验四极矩与零动量转移下的氘核四极形状因子的一致性。在非相对论量子力学的框架下研究氘核，并假设质子带电荷 $e$、中子不带电，从而使内禀四极算符简化为带有相应质心因子的相对坐标算符。仅在下文明确指定之处使用自然单位制。\n\n从以下经过充分检验的基础出发：\n\n- 氘核的结合能为 $B = 2.224566\\,\\mathrm{MeV}$，质子质量为 $m_p = 938.2720813\\,\\mathrm{MeV}$，中子质量为 $m_n = 939.5654133\\,\\mathrm{MeV}$，转换常数为 $\\hbar c = 197.3269804\\,\\mathrm{MeV\\cdot fm}$。氘核质量为 $M_d = m_p + m_n - B$，单位为 $\\mathrm{MeV}$。约化质量为 $\\mu = \\dfrac{m_p m_n}{m_p + m_n}$，单位为 $\\mathrm{MeV}$。束缚态波矢为 $\\gamma = \\dfrac{\\sqrt{2 \\mu B}}{\\hbar c}$，单位为 $\\mathrm{fm}^{-1}$。\n- 在非相对论脉冲近似（忽略介子交换流和相对论修正）中，氘核四极矩可通过 S 态和 D 态的约化径向波函数 $u(r)$ 和 $w(r)$ 计算得出，这两个函数归一化为 $\\int_0^\\infty \\left[u(r)^2 + w(r)^2\\right]\\,dr = 1$，其计算积分如下\n  $$Q_d = \\int_0^\\infty dr\\, r^2\\, \\frac{\\sqrt{8}\\,u(r)\\,w(r) - w(r)^2}{20},$$\n  当 $r$ 的单位为 $\\mathrm{fm}$ 且 $u,w$ 具有常规的氘核归一化时，该积分返回 $Q_d$ 的值，单位为 $\\mathrm{fm}^2$。请以 $\\mathrm{fm}^2$ 为单位表示 $Q_d$。\n- 零动量转移下的氘核四极形状因子与四极矩的关系如下\n  $$G_Q(0) = \\frac{M_d^2}{(\\hbar c)^2}\\, Q_d,$$\n  其中 $M_d$ 的单位为 $\\mathrm{MeV}$，$\\hbar c$ 的单位为 $\\mathrm{MeV\\cdot fm}$，$Q_d$ 的单位为 $\\mathrm{fm}^2$，从而得到无量纲的 $G_Q(0)$。同样的关系式通过测得的四极矩 $Q_d^{\\text{exp}}$ 定义了实验目标值 $G_Q^{\\text{exp}}(0)$。\n- 在 $r$ 较大时，氘核 S 波和 D 波分量的行为如同 $u(r) \\propto e^{-\\gamma r}$ 和 $w(r) \\propto \\left(1 + \\dfrac{3}{\\gamma r} + \\dfrac{3}{(\\gamma r)^2}\\right) e^{-\\gamma r}$。在将 $w(r)$ 除以已知的多项式前置因子 $\\left(1 + \\dfrac{3}{\\gamma r} + \\dfrac{3}{(\\gamma r)^2}\\right)$ 之后，渐近 $D/S$ 比为 $\\eta = \\lim_{r\\to\\infty} \\dfrac{w(r)}{u(r)}$。\n\n我们不求解耦合通道薛定谔方程，而是采用一个物理上正则化的拟设来近似氘核的约化径向波函数，该拟设能重现正确的渐近尾部和近原点行为：\n- 对于给定的短程调节标度 $\\beta$（单位为 $\\mathrm{fm}^{-1}$）和模型渐近比参数 $\\eta_{\\text{model}}$，对 $r > 0$ 定义，\n  $$u_{\\text{raw}}(r;\\beta,\\eta_{\\text{model}}) = \\left(1 - e^{-\\beta r}\\right) e^{-\\gamma r},$$\n  $$w_{\\text{raw}}(r;\\beta,\\eta_{\\text{model}}) = \\eta_{\\text{model}}\\,\\left(1 - e^{-\\beta r}\\right)^{5} \\left(1 + \\frac{3}{\\gamma r} + \\frac{3}{(\\gamma r)^2}\\right) e^{-\\gamma r}.$$\n- 归一化这些函数以得到 $u(r)$ 和 $w(r)$，使得 $\\int_0^\\infty \\left[u(r)^2 + w(r)^2\\right]\\,dr = 1$。这个整体归一化不改变渐近比。\n\n对于每个测试用例的参数集 $(\\beta, \\eta_{\\text{model}})$，您的任务是：\n\n1. 通过在 $r \\in [15\\,\\mathrm{fm}, 25\\,\\mathrm{fm}]$ 上均匀采样修正后的比率\n   $$\\frac{w(r)}{u(r)\\,\\left(1 + \\frac{3}{\\gamma r} + \\frac{3}{(\\gamma r)^2}\\right)}$$\n   来计算并报告渐近 $D/S$ 比的估计值 $\\eta_{\\text{num}}$，取样本的中位数以减轻残余的数值变动，并以浮点数形式报告结果。此值为无量纲。\n2. 使用上述积分计算并报告氘核四极矩 $Q_d$。使用以下数值规定以确保结果是良定义的：\n   - 使用下限截断值 $r_{\\min} = 10^{-5}\\,\\mathrm{fm}$ 以避免 $r=0$ 处的奇点。\n   - 积分上限为 $r_{\\max} = 50\\,\\mathrm{fm}$，采用均匀步长，步长不大于 $\\Delta r = 5\\times 10^{-3}\\,\\mathrm{fm}$，使用复合辛普森法则或等效精度的方法。\n   - 以浮点数形式报告 $Q_d$ 的值，单位为 $\\mathrm{fm}^2$。\n3. 根据您的 $Q_d$ 通过公式 $G_Q(0) = \\dfrac{M_d^2}{(\\hbar c)^2}\\,Q_d$ 计算并报告 $G_Q(0)$，以浮点数形式报告（无量纲）。\n4. 使用测得的四极矩 $Q_d^{\\text{exp}} = 0.2859\\,\\mathrm{fm}^2$，计算 $G_Q^{\\text{exp}}(0) = \\dfrac{M_d^2}{(\\hbar c)^2}\\,Q_d^{\\text{exp}}$ 并确定您计算出的 $G_Q(0)$ 是否在与 $G_Q^{\\text{exp}}(0)$ 相比 $0.15$ 的相对容差内一致；即，检查是否\n   $$\\frac{\\left|G_Q(0) - G_Q^{\\text{exp}}(0)\\right|}{G_Q^{\\text{exp}}(0)} \\le 0.15.$$\n   将此一致性报告为整数 $1$ (真) 或 $0$ (假)。\n\n使用的物理常数（请勿修改）：\n- $B = 2.224566\\,\\mathrm{MeV}$，\n- $m_p = 938.2720813\\,\\mathrm{MeV}$，\n- $m_n = 939.5654133\\,\\mathrm{MeV}$，\n- $\\hbar c = 197.3269804\\,\\mathrm{MeV\\cdot fm}$，\n- $Q_d^{\\text{exp}} = 0.2859\\,\\mathrm{fm}^2$。\n\n待评估的参数集 $(\\beta, \\eta_{\\text{model}})$ 测试套件：\n- 情况 A (理想路径): $(\\beta, \\eta_{\\text{model}}) = (1.20, 0.0256)$，其中 $\\beta$ 的单位为 $\\mathrm{fm}^{-1}$。\n- 情况 B (D 态边缘下限): $(\\beta, \\eta_{\\text{model}}) = (1.20, 0.0100)$。\n- 情况 C (D 态边缘上限): $(\\beta, \\eta_{\\text{model}}) = (1.50, 0.0500)$。\n\n最终输出格式要求：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，其中每个测试用例按 A、B、C 的顺序贡献一个子列表。每个子列表必须为以下形式\n  $$\\left[\\eta_{\\text{num}},\\, Q_d,\\, G_Q(0),\\, \\text{pass}\\right],$$\n  其中前三项是浮点数，最后一项是整数形式的通过标志。例如，一个可接受的输出行看起来像\n  $$\\big[\\,[0.025600,\\,0.286000,\\,25.500000,\\,1],\\,[\\dots],\\,[\\dots]\\,\\big].$$\n- 以 $\\mathrm{fm}^2$ 表示 $Q_d$，所有类角度量（若有）必须以弧度为单位。在打印输出中，将所有浮点数四舍五入到六位小数。", "solution": "该问题要求对氘核的非相对论模型进行计算分析。任务的核心是使用一个针对氘核 S 态和 D 态径向波函数 $u(r)$ 和 $w(r)$ 的特定解析拟设，为三组不同的模型参数计算若干物理可观测量。这些可观测量包括渐近 D/S 态比 ($\\eta$)、电四极矩 ($Q_d$) 以及零动量转移下的四极形状因子 ($G_Q(0)$)。然后将计算出的四极矩与实验值进行比较以检验其一致性。\n\n求解过程首先从确定必要的物理常数和派生参数开始。然后，对每组参数集执行一系列数值计算：波函数归一化、渐近比计算以及通过数值积分求四极矩。最后，评估与实验数据的一致性。\n\n首先，我们定义给定的物理常数：\n- 氘核结合能: $B = 2.224566\\,\\mathrm{MeV}$\n- 质子质量: $m_p = 938.2720813\\,\\mathrm{MeV}$\n- 中子质量: $m_n = 939.5654133\\,\\mathrm{MeV}$\n- 转换常数: $\\hbar c = 197.3269804\\,\\mathrm{MeV\\cdot fm}$\n- 实验测得的氘核四极矩: $Q_d^{\\text{exp}} = 0.2859\\,\\mathrm{fm}^2$\n\n根据这些常数，我们推导出在所有测试用例中保持不变的其他基本参数：\n- 氘核质量 $M_d = m_p + m_n - B \\approx 1875.612929\\,\\mathrm{MeV}$。\n- 质子-中子系统的约化质量 $\\mu = \\dfrac{m_p m_n}{m_p + m_n} \\approx 469.458995\\,\\mathrm{MeV}$。\n- 束缚态波数（或衰变长度的倒数）$\\gamma = \\dfrac{\\sqrt{2 \\mu B}}{\\hbar c} \\approx 0.231647\\,\\mathrm{fm}^{-1}$。该参数决定了波函数在长距离处的指数衰减，这是短程势中束缚态的一个普遍特征。\n\n对于每个测试用例，其方法由短程调节标度 $\\beta$ 和模型渐近比 $\\eta_{\\text{model}}$ 参数化，具体如下：\n\n1.  **波函数拟设与归一化**：\n    问题提供了一个物理上合理的、正则化的拟设，用于未归一化的径向波函数 $u_{\\text{raw}}(r)$ 和 $w_{\\text{raw}}(r)$：\n    $$u_{\\text{raw}}(r) = \\left(1 - e^{-\\beta r}\\right) e^{-\\gamma r}$$\n    $$w_{\\text{raw}}(r) = \\eta_{\\text{model}}\\,\\left(1 - e^{-\\beta r}\\right)^{5} \\left(1 + \\frac{3}{\\gamma r} + \\frac{3}{(\\gamma r)^2}\\right) e^{-\\gamma r}$$\n    这些函数被构造成在 $r$ 较大时具有正确的行为（薛定谔方程的渐近解），并在原点（$r=0$）处正则，即函数值为零。$(1 - e^{-\\beta r})$ 因子模拟了短程核势的影响。\n    为了使这些波函数能代表一个量子态，必须将其归一化，使得在任何构型中找到氘核的总概率为 1：\n    $$\\int_0^\\infty \\left[u(r)^2 + w(r)^2\\right]\\,dr = 1$$\n    这可以通过从未经处理的函数计算归一化常数 $N$ 来实现：\n    $$N = \\left( \\int_0^\\infty \\left[u_{\\text{raw}}(r)^2 + w_{\\text{raw}}(r)^2\\right]\\,dr \\right)^{-1/2}$$\n    归一化后的波函数则为 $u(r) = N \\cdot u_{\\text{raw}}(r)$ 和 $w(r) = N \\cdot w_{\\text{raw}}(r)$。计算 $N$ 的积分是使用复合辛普森法则在一个足够大的径向网格上进行的，范围从 $r_{\\min} = 10^{-5}\\,\\mathrm{fm}$ 到 $r_{\\max} = 50\\,\\mathrm{fm}$，步长为 $\\Delta r \\approx 5 \\times 10^{-3}\\,\\mathrm{fm}$。这个范围是足够的，因为波函数呈指数衰减，使得超出 $r_{\\max}$ 的贡献可以忽略不计。\n\n2.  **渐近 D/S 比 ($\\eta_{\\text{num}}$)**：\n    渐近 D/S 比 $\\eta$ 由波函数在 $r$ 较大时的行为定义。问题指定了一种数值估计方法 $\\eta_{\\text{num}}$，即对 $r \\in [15, 25]\\,\\mathrm{fm}$ 区间内的比率 $\\frac{w(r)}{u(r)\\,\\left(1 + \\frac{3}{\\gamma r} + \\frac{3}{(\\gamma r)^2}\\right)}$进行采样。由于归一化常数 $N$ 在此比率中被抵消，我们可以使用原始函数。代入拟设表达式，该比率可解析地简化为：\n    $$ \\frac{w_{\\text{raw}}(r)}{u_{\\text{raw}}(r)\\,\\left(1 + \\frac{3}{\\gamma r} + \\frac{3}{(\\gamma r)^2}\\right)} = \\frac{\\eta_{\\text{model}}\\,\\left(1 - e^{-\\beta r}\\right)^{5} \\left(1 + \\frac{3}{\\gamma r} + \\frac{3}{(\\gamma r)^2}\\right) e^{-\\gamma r}}{\\left(1 - e^{-\\beta r}\\right) e^{-\\gamma r}\\,\\left(1 + \\frac{3}{\\gamma r} + \\frac{3}{(\\gamma r)^2}\\right)} = \\eta_{\\text{model}}\\left(1 - e^{-\\beta r}\\right)^4 $$\n    这个简化后的表达式在一个位于区间 $[15, 25]\\,\\mathrm{fm}$ 的均匀点网格上进行求值，并取这些值的中位数作为 $\\eta_{\\text{num}}$ 的结果。对于指定的 $r$ 范围，$e^{-\\beta r}$ 项非常小，因此我们预期 $\\eta_{\\text{num}}$ 会非常接近 $\\eta_{\\text{model}}$。\n\n3.  **氘核四极矩 ($Q_d$)**：\n    电四极矩 $Q_d$ 是衡量氘核电荷分布偏离球对称性的一个度量。它通过以下积分计算：\n    $$Q_d = \\int_0^\\infty dr\\, r^2\\, \\frac{\\sqrt{8}\\,u(r)\\,w(r) - w(r)^2}{20}$$\n    该积分使用归一化后的波函数 $u(r)$ 和 $w(r)$，在与归一化时相同的网格上，并采用相同的辛普森法则积分方法进行数值计算。结果的单位是 $\\mathrm{fm}^2$。被积函数是良态的，当 $r\\to 0$ 时按多项式方式趋于零。\n\n4.  **四极形状因子 ($G_Q(0)$)**：\n    零动量转移下的四极形状因子 $G_Q(0)$ 是一个无量纲量，通过常规的标度变换与 $Q_d$ 相关：\n    $$G_Q(0) = \\frac{M_d^2}{(\\hbar c)^2}\\, Q_d$$\n    这是一个使用已计算出的 $Q_d$ 值和先前确定的常数进行的直接计算。\n\n5.  **一致性检验**：\n    为了评估模型的物理合理性，将计算出的 $G_Q(0)$ 与从实验四极矩推导出的值 $G_Q^{\\text{exp}}(0) = \\frac{M_d^2}{(\\hbar c)^2}\\, Q_d^{\\text{exp}}$ 进行比较。如果相对偏差在指定的 15% 容差范围内，则认为该模型是一致的：\n    $$\\frac{\\left|G_Q(0) - G_Q^{\\text{exp}}(0)\\right|}{G_Q^{\\text{exp}}(0)} \\le 0.15$$\n    此检验的结果报告为一个整数，1 表示真（一致），0 表示假（不一致）。\n\n实现将是一个 Python 脚本，利用 `numpy` 库进行数组操作，并使用 `scipy.integrate.simpson` 进行数值积分，同时遵循指定的数值参数。一个函数将封装单个测试用例的逻辑，主程序将遍历所提供的参数集，收集结果，并将其格式化为所需的输出字符串。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import simpson\n\ndef solve():\n    \"\"\"\n    Computes deuteron properties for given model parameters and checks\n    consistency with experimental data.\n    \"\"\"\n    # Physical constants\n    B = 2.224566  # MeV\n    m_p = 938.2720813  # MeV\n    m_n = 939.5654133  # MeV\n    hbar_c = 197.3269804  # MeV*fm\n    Qd_exp = 0.2859  # fm^2\n\n    # Derived constants\n    mu = (m_p * m_n) / (m_p + m_n)  # Reduced mass in MeV\n    M_d = m_p + m_n - B  # Deuteron mass in MeV\n    gamma = np.sqrt(2 * mu * B) / hbar_c  # Bound-state wave number in fm^-1\n\n    # Define test cases\n    test_cases = [\n        (1.20, 0.0256),  # Case A\n        (1.20, 0.0100),  # Case B\n        (1.50, 0.0500),  # Case C\n    ]\n\n    # Pre-calculate experimental G_Q(0)\n    GQ0_exp = (M_d**2 / hbar_c**2) * Qd_exp\n    \n    results = []\n    \n    # Numerical integration parameters\n    r_min = 1e-5\n    r_max = 50.0\n    num_points = 10001\n    r_grid = np.linspace(r_min, r_max, num_points)\n\n    for beta, eta_model in test_cases:\n        # --- TASK 1: Compute asymptotic D/S ratio eta_num ---\n        # The ratio simplifies to eta_model * (1 - exp(-beta*r))^4.\n        # Sample this expression and take the median.\n        r_sample = np.linspace(15.0, 25.0, 1001)\n        eta_samples = eta_model * (1 - np.exp(-beta * r_sample))**4\n        eta_num = np.median(eta_samples)\n\n        # --- Normalization and Wavefunction setup ---\n        # Define the polynomial prefactor for the D-wave\n        # Avoid division by zero at r=0, although r_grid starts at r_min > 0.\n        P_r = 1 + 3 / (gamma * r_grid) + 3 / (gamma**2 * r_grid**2)\n        \n        # Define unnormalized (raw) wavefunctions\n        exp_gamma_r = np.exp(-gamma * r_grid)\n        regulator_u = 1 - np.exp(-beta * r_grid)\n        regulator_w = regulator_u**5\n\n        u_raw = regulator_u * exp_gamma_r\n        w_raw = eta_model * regulator_w * P_r * exp_gamma_r\n\n        # Calculate normalization constant N\n        # N = (integral[u_raw^2 + w_raw^2] dr)^(-1/2)\n        norm_integrand = u_raw**2 + w_raw**2\n        norm_integral = simpson(norm_integrand, r_grid)\n        N = 1.0 / np.sqrt(norm_integral)\n\n        # Normalized wavefunctions\n        u = N * u_raw\n        w = N * w_raw\n\n        # --- TASK 2: Compute deuteron quadrupole moment Qd ---\n        # Qd = integral[ r^2 * (sqrt(8)*u*w - w^2) / 20 ] dr\n        Qd_integrand = r_grid**2 * (np.sqrt(8) * u * w - w**2) / 20.0\n        Qd = simpson(Qd_integrand, r_grid)\n\n        # --- TASK 3: Compute G_Q(0) ---\n        GQ0 = (M_d**2 / hbar_c**2) * Qd\n\n        # --- TASK 4: Consistency check ---\n        relative_error = np.abs(GQ0 - GQ0_exp) / GQ0_exp\n        pass_flag = 1 if relative_error = 0.15 else 0\n\n        # Append results for this case\n        results.append(f\"[{eta_num:.6f},{Qd:.6f},{GQ0:.6f},{pass_flag:d}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3582638"}, {"introduction": "现代核理论不仅预测可观测量，还量化其预测中的不确定性，这种不确定性源于其基本参数的校准。这项高级实践介绍了强大的贝叶斯推断框架，用于根据实验数据确定手征有效场论模型的低能常数 (LECs)。您将学习如何确定这些参数的后验概率，并将其不确定性传播到对氘核可观测量的预测中，这是评估理论预测能力以及与实验进行稳健比较的一项关键技能。", "problem": "您将为手性有效场论（EFT）的中子-质子系统低能常数实现一个线性化的贝叶斯校准和不确定性传播，其目标是氘核的性质。从贝叶斯定理和高斯线性模型假设出发，获得模型参数的后验分布，然后将该后验传播到氘核的可观测量上。您的程序必须是一个完整的、可运行的程序，无需任何用户输入即可产生所需的输出。\n\n未知参数矢量是无量纲低能常数对 $\\boldsymbol{\\theta} = [c_0, c_2]^{\\mathsf{T}}$。一个一阶线性化代理模型（局部模拟器）将 $\\boldsymbol{\\theta}$ 映射到从中子-质子相移分析中提取的低能数据以及氘核的可观测量。数据矢量包括以费米为单位的三重态中子-质子散射长度 $a_t$、以费米为单位的三重态有效力程 $r_t$ 以及以兆电子伏为单位的氘核结合能 $B_d$。测量模型为\n$$\n\\mathbf{y} = \\mathbf{H}\\,\\boldsymbol{\\theta} + \\mathbf{b} + \\boldsymbol{\\varepsilon},\n$$\n其中高斯噪声 $\\boldsymbol{\\varepsilon}$ 的均值为零，协方差矩阵为 $\\mathbf{R}$。使用以下与公认的经验测定结果一致的数值：\n- 数据矢量为\n$$\n\\mathbf{y}_{\\text{exp}} = \\begin{bmatrix} a_t \\\\ r_t \\\\ B_d \\end{bmatrix}\n= \\begin{bmatrix} 5.419 \\\\ 1.753 \\\\ 2.224575 \\end{bmatrix},\n$$\n其中 $a_t$ 和 $r_t$ 的单位是 $\\mathrm{fm}$，$B_d$ 的单位是 $\\mathrm{MeV}$。\n- 线性响应矩阵和基线矢量为\n$$\n\\mathbf{H} = \\begin{bmatrix}\n0.6   0.12 \\\\\n0.05   0.28 \\\\\n0.25   0.08\n\\end{bmatrix}, \\quad\n\\mathbf{b} = \\begin{bmatrix}\n5.419 \\\\ 1.753 \\\\ 2.224575\n\\end{bmatrix}.\n$$\n- 标称数据协方差是对角矩阵，\n$$\n\\mathbf{R} = \\mathrm{diag}\\left(\\sigma_a^2, \\sigma_r^2, \\sigma_B^2\\right),\n$$\n标准差为 $\\sigma_a = 0.01\\,\\mathrm{fm}$、$\\sigma_r = 0.005\\,\\mathrm{fm}$ 和 $\\sigma_B = 0.00001\\,\\mathrm{MeV}$。\n\n我们感兴趣的氘核可观测量是：以平方费米为单位的四极矩 $Q_d$、以核磁子为单位的磁偶极矩 $\\mu_d$以及以费米为单位的电荷半径 $r_d$。使用一个线性化的代理映射\n$$\n\\mathbf{z} = \\mathbf{L}\\,\\boldsymbol{\\theta} + \\mathbf{b}_z,\n$$\n其中\n$$\n\\mathbf{L} = \\begin{bmatrix}\n0.006   0.020 \\\\\n0.001   -0.010 \\\\\n-0.050   -0.020\n\\end{bmatrix}, \\quad\n\\mathbf{b}_z = \\begin{bmatrix}\n0.2859 \\\\\n0.857438 \\\\\n2.127\n\\end{bmatrix},\n$$\n其中 $Q_d$ 的单位是 $\\mathrm{fm}^2$、$\\mu_d$ 的单位是核磁子，$r_d$ 的单位是 $\\mathrm{fm}$。\n\n假设 $\\boldsymbol{\\theta}$ 服从均值为 $\\mathbf{m}_0$、协方差为 $\\mathbf{S}_0$ 的高斯先验。在线性高斯假设下，使用贝叶斯定理获得给定数据的 $\\boldsymbol{\\theta}$ 的后验分布，然后将该后验传播到 $\\mathbf{z}$ 的预测分布。\n\n数值单位和输出：\n- 所有输入均以上述单位提供，并且必须保持一致处理。\n- 对于每个指定的测试用例，您的程序必须报告 $Q_d$、$\\mu_d$ 和 $r_d$ 各自的后验预测均值和标准差。\n- 以 $\\mathrm{fm}^2$ 表示 $Q_d$ 的均值和标准差，以核磁子表示 $\\mu_d$ 的均值和标准差，以 $\\mathrm{fm}$ 表示 $r_d$ 的均值和标准差。\n- 将报告的每个数字四舍五入到恰好 $6$ 位小数。\n\n测试套件规范：\n实现三个测试用例，以探究不同的先验-数据机制。对于每个用例，使用上面给出的相同的 $\\mathbf{H}$、$\\mathbf{b}$、$\\mathbf{L}$、$\\mathbf{b}_z$ 和 $\\mathbf{y}_{\\text{exp}}$，但按如下方式改变先验和数据协方差缩放。\n- 用例 1（数据主导，中性先验）：\n  - 先验均值 $\\mathbf{m}_0 = [0, 0]^{\\mathsf{T}}$。\n  - 先验协方差 $\\mathbf{S}_0 = \\mathrm{diag}([0.5^2, 0.5^2])$。\n  - 数据协方差缩放因子 $s_R = 1$，意味着使用给定的 $\\mathbf{R}$。\n- 用例 2（偏离零的信息先验）：\n  - 先验均值 $\\mathbf{m}_0 = [0.5, -0.3]^{\\mathsf{T}}$。\n  - 先验协方差 $\\mathbf{S}_0 = \\mathrm{diag}([0.2^2, 0.2^2])$。\n  - 数据协方差缩放因子 $s_R = 1$。\n- 用例 3（通过膨胀的数据不确定性实现的先验主导）：\n  - 先验均值 $\\mathbf{m}_0 = [0, 0]^{\\mathsf{T}}$。\n  - 先验协方差 $\\mathbf{S}_0 = \\mathrm{diag}([1.0^2, 1.0^2])$。\n  - 数据协方差缩放因子 $s_R = 100$，意味着用 $s_R \\mathbf{R}$ 替换 $\\mathbf{R}$。\n\n对于每个用例：\n1. 根据指定的先验和数据模型，计算 $\\boldsymbol{\\theta}$ 的后验均值和协方差。\n2. 通过线性映射传播后验，计算 $\\mathbf{z}$ 的预测均值和协方差。\n3. 以规定的单位提取 $Q_d$、$\\mu_d$ 和 $r_d$ 的预测均值和标准差（预测协方差对角线元素的平方根）。\n4. 将每个值四舍五入到恰好 $6$ 位小数。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。按顺序连接三个用例的结果。对于每个用例，按以下顺序列出六个数字\n$$\n[ \\overline{Q}_d, \\sigma(Q_d), \\overline{\\mu}_d, \\sigma(\\mu_d), \\overline{r}_d, \\sigma(r_d) ].\n$$\n因此，完整输出是一个包含 $18$ 个数字的扁平列表：\n$$\n[\\text{用例 1 的六个数字}, \\text{用例 2 的六个数字}, \\text{用例 3 的六个数字}],\n$$\n每个数字都四舍五入到 $6$ 位小数，没有附加文本。", "solution": "该问题要求为一个源自手性有效场论（EFT）的线性化模型实现贝叶斯校准和不确定性传播程序。模型的参数是无量纲低能常数（LECs）$\\boldsymbol{\\theta} = [c_0, c_2]^{\\mathsf{T}}$。该过程涉及使用贝叶斯定理，根据实验数据更新关于 $\\boldsymbol{\\theta}$ 的知识，然后将得到的后验不确定性传播到对其他氘核可观测量的预测中。\n\n### 1. 贝叶斯框架构建\n\n该问题是在贝叶斯推断的框架内提出的。核心原则是贝叶斯定理，它将给定实验数据 $\\mathbf{y}_{\\text{exp}}$ 时参数 $\\boldsymbol{\\theta}$ 的后验概率与数据的似然和参数的先验概率联系起来：\n$$\np(\\boldsymbol{\\theta} | \\mathbf{y}_{\\text{exp}}) \\propto p(\\mathbf{y}_{\\text{exp}} | \\boldsymbol{\\theta}) \\, p(\\boldsymbol{\\theta})\n$$\n\n#### 1.1. 先验分布\n关于参数 $\\boldsymbol{\\theta}$ 的先验知识被指定为一个均值为 $\\mathbf{m}_0$、协方差矩阵为 $\\mathbf{S}_0$ 的多元高斯分布。其概率密度函数为：\n$$\np(\\boldsymbol{\\theta}) = \\mathcal{N}(\\boldsymbol{\\theta} | \\mathbf{m}_0, \\mathbf{S}_0)\n$$\n对于每个测试用例，都提供了 $\\mathbf{m}_0$ 和 $\\mathbf{S}_0$ 的具体值。\n\n#### 1.2. 似然函数\n似然函数 $p(\\mathbf{y}_{\\text{exp}} | \\boldsymbol{\\theta})$ 量化了在给定一组参数 $\\boldsymbol{\\theta}$ 的情况下观测到实验数据 $\\mathbf{y}_{\\text{exp}}$ 的概率。它源自测量模型：\n$$\n\\mathbf{y} = \\mathbf{H}\\,\\boldsymbol{\\theta} + \\mathbf{b} + \\boldsymbol{\\varepsilon}\n$$\n在此，$\\mathbf{y}$ 是校准数据的模型预测矢量，$\\mathbf{H}$ 是线性响应矩阵，$\\mathbf{b}$ 是基线矢量，而 $\\boldsymbol{\\varepsilon}$ 代表测量和模型不确定性，假设其为均值为零、协方差为 $\\mathbf{R}$ 的高斯随机变量，即 $\\boldsymbol{\\varepsilon} \\sim \\mathcal{N}(\\mathbf{0}, \\mathbf{R})$。这种结构意味着给定 $\\boldsymbol{\\theta}$ 时数据 $\\mathbf{y}$ 的条件分布也是高斯分布：\n$$\n\\mathbf{y} | \\boldsymbol{\\theta} \\sim \\mathcal{N}(\\mathbf{H}\\,\\boldsymbol{\\theta} + \\mathbf{b}, \\mathbf{R})\n$$\n因此，似然函数是通过在观测数据点 $\\mathbf{y}_{\\text{exp}}$ 处评估此密度得到的。\n\n### 2. 参数的后验分布\n\n鉴于先验和似然都是高斯分布，它们的乘积，即后验分布 $p(\\boldsymbol{\\theta} | \\mathbf{y}_{\\text{exp}})$，也是高斯分布。这是贝叶斯统计中共轭族的一个标准结果。我们将后验分布表示为：\n$$\np(\\boldsymbol{\\theta} | \\mathbf{y}_{\\text{exp}}) = \\mathcal{N}(\\boldsymbol{\\theta} | \\mathbf{m}_1, \\mathbf{S}_1)\n$$\n后验均值 $\\mathbf{m}_1$ 和协方差 $\\mathbf{S}_1$ 是通过结合先验和似然的信息来确定的。后验精度（协方差的逆）是先验精度和基于数据的精度的和：\n$$\n\\mathbf{S}_1^{-1} = \\mathbf{S}_0^{-1} + \\mathbf{H}^{\\mathsf{T}}\\mathbf{R}^{-1}\\mathbf{H}\n$$\n这给出了后验协方差矩阵：\n$$\n\\mathbf{S}_1 = (\\mathbf{S}_0^{-1} + \\mathbf{H}^{\\mathsf{T}}\\mathbf{R}^{-1}\\mathbf{H})^{-1}\n$$\n后验均值 $\\mathbf{m}_1$ 被发现是一个精度加权平均值：\n$$\n\\mathbf{m}_1 = \\mathbf{S}_1 \\left( \\mathbf{S}_0^{-1}\\mathbf{m}_0 + \\mathbf{H}^{\\mathsf{T}}\\mathbf{R}^{-1}(\\mathbf{y}_{\\text{exp}} - \\mathbf{b}) \\right)\n$$\n问题指明实验数据矢量 $\\mathbf{y}_{\\text{exp}}$ 在数值上与基线矢量 $\\mathbf{b}$ 相同。这导致了一个显著的简化，因为项 $(\\mathbf{y}_{\\text{exp}} - \\mathbf{b})$ 变成了零矢量。因此，后验均值的表达式简化为：\n$$\n\\mathbf{m}_1 = \\mathbf{S}_1 (\\mathbf{S}_0^{-1}\\mathbf{m}_0)\n$$\n这个简化形式表明，后验均值是先验均值的线性变换，其中变换矩阵取决于先验和似然的相对精度。\n\n### 3. 可观测量的预测分布\n\n最后一步是使用 $\\boldsymbol{\\theta}$ 的后验分布来对一组新的可观测量 $\\mathbf{z} = [Q_d, \\mu_d, r_d]^{\\mathsf{T}}$ 进行预测。这些可观测量也通过一个线性模型与参数相关：\n$$\n\\mathbf{z} = \\mathbf{L}\\,\\boldsymbol{\\theta} + \\mathbf{b}_z\n$$\n$\\mathbf{z}$ 的预测分布，以观测数据 $\\mathbf{y}_{\\text{exp}}$ 为条件，是通过将 $\\boldsymbol{\\theta}$ 的后验分布通过这个线性变换传播得到的。高斯随机变量（$\\boldsymbol{\\theta}$）通过线性函数的变换会得到另一个高斯随机变量（$\\mathbf{z}$）。因此，预测分布为 $p(\\mathbf{z} | \\mathbf{y}_{\\text{exp}}) = \\mathcal{N}(\\mathbf{z} | \\mathbf{m}_z, \\mathbf{S}_z)$。\n\n预测分布的均值 $\\mathbf{m}_z$ 是 $\\mathbf{z}$ 关于 $\\boldsymbol{\\theta}$ 后验的期望：\n$$\n\\mathbf{m}_z = E_{\\boldsymbol{\\theta} | \\mathbf{y}_{\\text{exp}}}[\\mathbf{z}] = E[\\mathbf{L}\\boldsymbol{\\theta} + \\mathbf{b}_z] = \\mathbf{L}E[\\boldsymbol{\\theta}] + \\mathbf{b}_z = \\mathbf{L}\\mathbf{m}_1 + \\mathbf{b}_z\n$$\n预测分布的协方差 $\\mathbf{S}_z$ 是通过将线性变换的误差传播定律应用于后验协方差 $\\mathbf{S}_1$ 得到的：\n$$\n\\mathbf{S}_z = \\text{Cov}_{\\boldsymbol{\\theta} | \\mathbf{y}_{\\text{exp}}}[\\mathbf{z}] = \\text{Cov}[\\mathbf{L}\\boldsymbol{\\theta} + \\mathbf{b}_z] = \\mathbf{L}\\,\\text{Cov}[\\boldsymbol{\\theta}]\\,\\mathbf{L}^{\\mathsf{T}} = \\mathbf{L}\\mathbf{S}_1\\mathbf{L}^{\\mathsf{T}}\n$$\n我们感兴趣的量是 $\\mathbf{z}$ 各个分量的预测均值和标准差。第 $i$ 个可观测量的预测均值为 $(\\mathbf{m}_z)_i$，其标准差为 $\\sigma(z_i) = \\sqrt{(\\mathbf{S}_z)_{ii}}$。\n\n### 4. 计算算法\n\n数值解是通过对三个指定的测试用例中的每一个执行以下算法来实现的：\n1.  定义常量矩阵和矢量：$\\mathbf{H}$、$\\mathbf{b}$、$\\mathbf{y}_{\\text{exp}}$、$\\mathbf{L}$、$\\mathbf{b}_z$。\n2.  对每个测试用例，设置先验均值 $\\mathbf{m}_0$，构造对角先验协方差矩阵 $\\mathbf{S}_0$，并确定数据协方差缩放因子 $s_R$。\n3.  计算数据协方差矩阵 $\\mathbf{R} = s_R \\cdot \\mathrm{diag}(\\sigma_a^2, \\sigma_r^2, \\sigma_B^2)$。\n4.  计算矩阵逆 $\\mathbf{S}_0^{-1}$ 和 $\\mathbf{R}^{-1}$。由于这些矩阵是对角矩阵，可以通过取每个对角元素的倒数来高效地求逆。\n5.  计算后验协方差矩阵 $\\mathbf{S}_1 = (\\mathbf{S}_0^{-1} + \\mathbf{H}^{\\mathsf{T}}\\mathbf{R}^{-1}\\mathbf{H})^{-1}$。\n6.  计算后验均值矢量 $\\mathbf{m}_1 = \\mathbf{S}_1 (\\mathbf{S}_0^{-1}\\mathbf{m}_0)$。\n7.  计算预测均值矢量 $\\mathbf{m}_z = \\mathbf{L}\\mathbf{m}_1 + \\mathbf{b}_z$。\n8.  计算预测协方差矩阵 $\\mathbf{S}_z = \\mathbf{L}\\mathbf{S}_1\\mathbf{L}^{\\mathsf{T}}$。\n9.  从 $\\mathbf{m}_z$ 的元素中提取预测均值，并从 $\\mathbf{S}_z$ 对角元素的平方根中提取预测标准差。\n10. 将得到的六个值（$Q_d$、$\\mu_d$ 和 $r_d$ 的均值和标准差）格式化，四舍五入到 $6$ 位小数，并将它们附加到列表中以供最终输出。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements a linearized Bayesian calibration for chiral EFT LECs.\n    \"\"\"\n    # --- Define constants from the problem statement ---\n    # Linear response matrix for calibration data\n    H = np.array([\n        [0.6, 0.12],\n        [0.05, 0.28],\n        [0.25, 0.08]\n    ])\n    \n    # Baseline vector for calibration data (equal to y_exp)\n    b = np.array([5.419, 1.753, 2.224575])\n    y_exp = b # Experimental data vector\n    \n    # Standard deviations for the calibration data\n    sigma_a = 0.01  # fm\n    sigma_r = 0.005  # fm\n    sigma_B = 0.00001  # MeV\n    \n    # Base data covariance matrix (diagonal)\n    R_base = np.diag([sigma_a**2, sigma_r**2, sigma_B**2])\n    \n    # Linear response matrix for predicted observables\n    L = np.array([\n        [0.006, 0.020],   # Q_d\n        [0.001, -0.010],  # mu_d\n        [-0.050, -0.020]  # r_d\n    ])\n    \n    # Baseline vector for predicted observables\n    b_z = np.array([0.2859, 0.857438, 2.127])\n\n    # --- Define the test cases ---\n    test_cases = [\n        # Case 1: data-dominated, neutral prior\n        {\n            \"m0\": np.array([0.0, 0.0]),\n            \"S0_diag\": np.array([0.5**2, 0.5**2]),\n            \"sR\": 1.0\n        },\n        # Case 2: informative prior shifted from zero\n        {\n            \"m0\": np.array([0.5, -0.3]),\n            \"S0_diag\": np.array([0.2**2, 0.2**2]),\n            \"sR\": 1.0\n        },\n        # Case 3: prior-dominated via inflated data uncertainty\n        {\n            \"m0\": np.array([0.0, 0.0]),\n            \"S0_diag\": np.array([1.0**2, 1.0**2]),\n            \"sR\": 100.0\n        }\n    ]\n\n    all_results = []\n    \n    # --- Process each test case ---\n    for case in test_cases:\n        m0 = case[\"m0\"]\n        S0 = np.diag(case[\"S0_diag\"])\n        sR = case[\"sR\"]\n        \n        # 1. Construct data covariance matrix for this case\n        R = sR * R_base\n        \n        # 2. Compute inverses (numerically stable for diagonal matrices)\n        S0_inv = np.diag(1.0 / case[\"S0_diag\"])\n        R_inv = np.diag(1.0 / np.diag(R))\n        \n        # 3. Calculate posterior distribution for theta\n        # Posterior covariance S1 = (S0^-1 + H^T * R^-1 * H)^-1\n        posterior_cov_inv = S0_inv + H.T @ R_inv @ H\n        posterior_cov = np.linalg.inv(posterior_cov_inv)\n        \n        # Posterior mean m1 = S1 * (S0^-1 * m0 + H^T * R^-1 * (y_exp - b))\n        # Since y_exp = b, the second term in the parenthesis is zero.\n        posterior_mean = posterior_cov @ (S0_inv @ m0)\n\n        # 4. Propagate to predictive distribution for z\n        # Predictive mean mz = L * m1 + bz\n        predictive_mean = L @ posterior_mean + b_z\n        \n        # Predictive covariance Sz = L * S1 * L^T\n        predictive_cov = L @ posterior_cov @ L.T\n        \n        # 5. Extract means and standard deviations\n        predictive_stds = np.sqrt(np.diag(predictive_cov))\n        \n        # 6. Store results for this case\n        # Order: mean_Qd, std_Qd, mean_mu_d, std_mu_d, mean_r_d, std_r_d\n        results_for_case = []\n        for i in range(3):\n            results_for_case.append(predictive_mean[i])\n            results_for_case.append(predictive_stds[i])\n        \n        all_results.extend(results_for_case)\n\n    # Final print statement in the exact required format.\n    formatted_results = [f\"{num:.6f}\" for num in all_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3582583"}]}