{"hands_on_practices": [{"introduction": "从基本原理出发计算克莱布施-戈登系数（Clebsch-Gordan coefficients）是角动量代数的核心技能。本练习将指导你通过系统地应用升降算符，为一个核子的轨道角动量 $l=1$ 和自旋角动量 $s=\\frac{1}{2}$ 耦合的简单而重要情形推导出这些系数。掌握这一方法不仅能让你理解角动量耦合的量子力学基础，还为处理更复杂的多体系统奠定了基础。[@problem_id:3541616]", "problem": "在一次针对 $p$ 壳层中单个核子的计算核物理计算中，轨道角动量为 $l=1$，内禀自旋为 $s=\\tfrac{1}{2}$。因此，耦合的总角动量态为 $j=\\tfrac{3}{2}$ 和 $j=\\tfrac{1}{2}$。请仅使用量子力学中角动量相加的公设、直积非耦合基 $\\{|l,m_{l}\\rangle \\otimes |s,m_{s}\\rangle\\}$ 的定义、由 $\\hat{\\mathbf{J}}=\\hat{\\mathbf{L}}+\\hat{\\mathbf{S}}$（其中 $\\hat{J}_{\\pm}=\\hat{L}_{\\pm}+\\hat{S}_{\\pm}$）定义的耦合基 $\\{|j,m\\rangle\\}$，以及耦合基和非耦合基的标准正交归一性和完备性关系，显式计算将 $j_{1}=l=1$ 和 $j_{2}=s=\\tfrac{1}{2}$ 耦合到总角动量 $J=\\tfrac{3}{2}$ 和 $J=\\tfrac{1}{2}$ 时的非零克莱布希-戈登系数 (CGCs)。\n\n采用 Condon–Shortley 相位约定，使得伸展态具有正系数，即 $|J=\\tfrac{3}{2},M=\\tfrac{3}{2}\\rangle=|1,1\\rangle\\otimes|\\tfrac{1}{2},\\tfrac{1}{2}\\rangle$。通过适当使用 $\\hat{J}_{-}$、归一化和正交性来推导其余的系数，而不借助任何闭合形式的 CGCs 制表表达式。\n\n显式验证为每个允许的 $M$ 构建的耦合态的归一化和正交性，然后按以下顺序报告下列非零 CGCs 的有序列表，以精确形式（无舍入）表示：\n- $\\langle 1,\\tfrac{1}{2};1,\\tfrac{1}{2}\\,|\\,\\tfrac{3}{2},\\tfrac{3}{2}\\rangle$,\n- $\\langle 1,\\tfrac{1}{2};1,-\\tfrac{1}{2}\\,|\\,\\tfrac{3}{2},\\tfrac{1}{2}\\rangle$,\n- $\\langle 1,\\tfrac{1}{2};0,\\tfrac{1}{2}\\,|\\,\\tfrac{3}{2},\\tfrac{1}{2}\\rangle$,\n- $\\langle 1,\\tfrac{1}{2};0,-\\tfrac{1}{2}\\,|\\,\\tfrac{3}{2},-\\tfrac{1}{2}\\rangle$,\n- $\\langle 1,\\tfrac{1}{2};-1,\\tfrac{1}{2}\\,|\\,\\tfrac{3}{2},-\\tfrac{1}{2}\\rangle$,\n- $\\langle 1,\\tfrac{1}{2};-1,-\\tfrac{1}{2}\\,|\\,\\tfrac{3}{2},-\\tfrac{3}{2}\\rangle$,\n- $\\langle 1,\\tfrac{1}{2};1,-\\tfrac{1}{2}\\,|\\,\\tfrac{1}{2},\\tfrac{1}{2}\\rangle$,\n- $\\langle 1,\\tfrac{1}{2};0,\\tfrac{1}{2}\\,|\\,\\tfrac{1}{2},\\tfrac{1}{2}\\rangle$,\n- $\\langle 1,\\tfrac{1}{2};0,-\\tfrac{1}{2}\\,|\\,\\tfrac{1}{2},-\\tfrac{1}{2}\\rangle$,\n- $\\langle 1,\\tfrac{1}{2};-1,\\tfrac{1}{2}\\,|\\,\\tfrac{1}{2},-\\tfrac{1}{2}\\rangle$.\n\n将您的最终答案表示为包含这 $10$ 个系数的单个行向量，按指定顺序，使用精确的根式。无需单位。", "solution": "该问题要求显式计算轨道角动量 $l=1$ 与自旋角动量 $s=\\frac{1}{2}$ 耦合的克莱布希-戈登系数 (CGCs)。总角动量由 $\\hat{\\mathbf{J}}=\\hat{\\mathbf{L}}+\\hat{\\mathbf{S}}$ 给出，总角动量量子数 $J$ 的可能值由三角不等式 $|l-s| \\leq J \\leq l+s$ 给出，对于 $l=1$ 和 $s=\\frac{1}{2}$，得出 $J=\\frac{1}{2}$ 和 $J=\\frac{3}{2}$。\n\nCGCs，记为 $\\langle l,s; m_l,m_s | J,M \\rangle$，是从非耦合基 $\\{|l,m_l\\rangle \\otimes |s,m_s\\rangle \\equiv |l,m_l; s,m_s\\rangle\\}$ 到耦合基 $\\{|J,M\\rangle\\}$ 的变换系数。其关系为：\n$$|J,M\\rangle = \\sum_{m_l, m_s} \\langle l,s; m_l,m_s | J,M \\rangle |l,m_l; s,m_s\\rangle$$\n求和受条件 $M = m_l + m_s$ 的约束。\n\n我们将使用梯形算符法推导这些系数，从具有最大可能值 $M$ 的“伸展态”开始，并相继应用总角动量下降算符 $\\hat{J}_{-} = \\hat{L}_{-} + \\hat{S}_{-}$。下降算符 $\\hat{J}_{-}$ 对一般角动量态 $|j,m\\rangle$ 的作用由下式给出（在 $\\hbar=1$ 的单位制中）：\n$$\\hat{J}_{-}|j,m\\rangle = \\sqrt{j(j+1) - m(m-1)}|j,m-1\\rangle = \\sqrt{(j-m+1)(j+m)}|j,m-1\\rangle$$\n对于轨道角动量 $l=1$ 和自旋 $s=\\frac{1}{2}$ 的具体情况，我们有：\n$$\\hat{L}_{-}|1,m_l\\rangle = \\sqrt{1(2)-m_l(m_l-1)}|1,m_l-1\\rangle$$\n$$\\hat{S}_{-}|\\tfrac{1}{2},m_s\\rangle = \\sqrt{\\tfrac{1}{2}(\\tfrac{3}{2})-m_s(m_s-1)}|\\tfrac{1}{2},m_s-1\\rangle$$\n具体来说，非零作用为：\n$\\hat{L}_{-}|1,1\\rangle = \\sqrt{2}|1,0\\rangle$，$\\hat{L}_{-}|1,0\\rangle = \\sqrt{2}|1,-1\\rangle$。\n$\\hat{S}_{-}|\\frac{1}{2},\\frac{1}{2}\\rangle = | \\frac{1}{2},-\\frac{1}{2}\\rangle$。\n\n我们从 $J=\\frac{3}{2}$ 多重态开始。\n\n具有最大总角动量投影 $M_{max} = l+s = 1+\\frac{1}{2} = \\frac{3}{2}$ 的态在耦合基和非耦合基中都是唯一的。\n$$|J=\\tfrac{3}{2}, M=\\tfrac{3}{2}\\rangle = |l=1, m_l=1; s=\\tfrac{1}{2}, m_s=\\tfrac{1}{2}\\rangle$$\nCondon-Shortley 相位约定将此态的系数设为 $+1$。因此，$\\langle 1,\\frac{1}{2}; 1,\\frac{1}{2} | \\frac{3}{2},\\frac{3}{2} \\rangle = 1$。\n\n接下来，我们将 $\\hat{J}_{-} = \\hat{L}_{-} + \\hat{S}_{-}$ 应用于此态。\n在左侧 (LHS)，作用于耦合态：\n$$\\hat{J}_{-}|\\tfrac{3}{2},\\tfrac{3}{2}\\rangle = \\sqrt{\\tfrac{3}{2}(\\tfrac{3}{2}+1) - \\tfrac{3}{2}(\\tfrac{3}{2}-1)}|\\tfrac{3}{2},\\tfrac{1}{2}\\rangle = \\sqrt{\\tfrac{15}{4}-\\tfrac{3}{4}}|\\tfrac{3}{2},\\tfrac{1}{2}\\rangle = \\sqrt{3}|\\tfrac{3}{2},\\tfrac{1}{2}\\rangle$$\n在右侧 (RHS)，作用于非耦合态：\n$$(\\hat{L}_{-} + \\hat{S}_{-})|1,1; \\tfrac{1}{2},\\tfrac{1}{2}\\rangle = (\\hat{L}_{-}|1,1\\rangle)|\\tfrac{1}{2},\\tfrac{1}{2}\\rangle + |1,1\\rangle(\\hat{S}_{-}|\\tfrac{1}{2},\\tfrac{1}{2}\\rangle) = \\sqrt{2}|1,0; \\tfrac{1}{2},\\tfrac{1}{2}\\rangle + |1,1; \\tfrac{1}{2},-\\tfrac{1}{2}\\rangle$$\n令 LHS 和 RHS 相等并求解 $|\\frac{3}{2},\\frac{1}{2}\\rangle$：\n$$|\\tfrac{3}{2},\\tfrac{1}{2}\\rangle = \\frac{1}{\\sqrt{3}} \\left( \\sqrt{2}|1,0; \\tfrac{1}{2},\\tfrac{1}{2}\\rangle + |1,1; \\tfrac{1}{2},-\\tfrac{1}{2}\\rangle \\right) = \\sqrt{\\frac{2}{3}}|1,0; \\tfrac{1}{2},\\tfrac{1}{2}\\rangle + \\sqrt{\\frac{1}{3}}|1,1; \\tfrac{1}{2},-\\tfrac{1}{2}\\rangle$$\n相应的 CGCs 为 $\\langle 1,\\frac{1}{2}; 0,\\frac{1}{2} | \\frac{3}{2},\\frac{1}{2} \\rangle = \\sqrt{\\frac{2}{3}}$ 和 $\\langle 1,\\frac{1}{2}; 1,-\\frac{1}{2} | \\frac{3}{2},\\frac{1}{2} \\rangle = \\sqrt{\\frac{1}{3}}$。\n\n我们再次应用 $\\hat{J}_{-}$ 来找到 $|\\frac{3}{2},-\\frac{1}{2}\\rangle$ 态。\nLHS: $\\hat{J}_{-}|\\frac{3}{2},\\frac{1}{2}\\rangle = \\sqrt{\\frac{3}{2}(\\frac{5}{2}) - \\frac{1}{2}(-\\frac{1}{2})}|\\frac{3}{2},-\\frac{1}{2}\\rangle = \\sqrt{\\frac{15}{4}+\\frac{1}{4}}|\\frac{3}{2},-\\frac{1}{2}\\rangle = 2|\\frac{3}{2},-\\frac{1}{2}\\rangle$。\nRHS: $(\\hat{L}_{-} + \\hat{S}_{-}) \\left( \\sqrt{\\frac{2}{3}}|1,0; \\tfrac{1}{2},\\tfrac{1}{2}\\rangle + \\sqrt{\\frac{1}{3}}|1,1; \\tfrac{1}{2},-\\tfrac{1}{2}\\rangle \\right)$\n$$= \\sqrt{\\frac{2}{3}} \\left( \\hat{L}_{-}|1,0\\rangle|\\tfrac{1}{2},\\tfrac{1}{2}\\rangle + |1,0\\rangle\\hat{S}_{-}|\\tfrac{1}{2},\\tfrac{1}{2}\\rangle \\right) + \\sqrt{\\frac{1}{3}} \\left( \\hat{L}_{-}|1,1\\rangle|\\tfrac{1}{2},-\\tfrac{1}{2}\\rangle + |1,1\\rangle\\hat{S}_{-}|\\tfrac{1}{2},-\\tfrac{1}{2}\\rangle \\right)$$\n$$= \\sqrt{\\frac{2}{3}} \\left( \\sqrt{2}|1,-1; \\tfrac{1}{2},\\tfrac{1}{2}\\rangle + |1,0; \\tfrac{1}{2},-\\tfrac{1}{2}\\rangle \\right) + \\sqrt{\\frac{1}{3}} \\left( \\sqrt{2}|1,0; \\tfrac{1}{2},-\\tfrac{1}{2}\\rangle + 0 \\right)$$\n$$= \\frac{2}{\\sqrt{3}}|1,-1; \\tfrac{1}{2},\\tfrac{1}{2}\\rangle + \\frac{\\sqrt{2}}{\\sqrt{3}}|1,0; \\tfrac{1}{2},-\\tfrac{1}{2}\\rangle + \\frac{\\sqrt{2}}{\\sqrt{3}}|1,0; \\tfrac{1}{2},-\\tfrac{1}{2}\\rangle$$\n$$= \\frac{2}{\\sqrt{3}}|1,-1; \\tfrac{1}{2},\\tfrac{1}{2}\\rangle + \\frac{2\\sqrt{2}}{\\sqrt{3}}|1,0; \\tfrac{1}{2},-\\tfrac{1}{2}\\rangle$$\n令 LHS 和 RHS 相等： $2|\\frac{3}{2},-\\frac{1}{2}\\rangle = \\frac{2}{\\sqrt{3}}|1,-1; \\frac{1}{2},\\frac{1}{2}\\rangle + \\frac{2\\sqrt{2}}{\\sqrt{3}}|1,0; \\frac{1}{2},-\\frac{1}{2}\\rangle$。\n$$|\\tfrac{3}{2},-\\tfrac{1}{2}\\rangle = \\sqrt{\\frac{1}{3}}|1,-1; \\tfrac{1}{2},\\tfrac{1}{2}\\rangle + \\sqrt{\\frac{2}{3}}|1,0; \\tfrac{1}{2},-\\tfrac{1}{2}\\rangle$$\nCGCs 为 $\\langle 1,\\frac{1}{2}; -1,\\frac{1}{2} | \\frac{3}{2},-\\frac{1}{2} \\rangle = \\sqrt{\\frac{1}{3}}$ 和 $\\langle 1,\\frac{1}{2}; 0,-\\frac{1}{2} | \\frac{3}{2},-\\frac{1}{2} \\rangle = \\sqrt{\\frac{2}{3}}$。\n\n最后对于 $J=\\frac{3}{2}$，我们应用 $\\hat{J}_{-}$ 来找到 $|\\frac{3}{2},-\\frac{3}{2}\\rangle$。\nLHS: $\\hat{J}_{-}|\\frac{3}{2},-\\frac{1}{2}\\rangle = \\sqrt{\\frac{15}{4}-\\frac{3}{4}}|\\frac{3}{2},-\\frac{3}{2}\\rangle = \\sqrt{3}|\\frac{3}{2},-\\frac{3}{2}\\rangle$。\nRHS: $(\\hat{L}_{-} + \\hat{S}_{-}) \\left( \\sqrt{\\frac{1}{3}}|1,-1; \\tfrac{1}{2},\\tfrac{1}{2}\\rangle + \\sqrt{\\frac{2}{3}}|1,0; \\tfrac{1}{2},-\\tfrac{1}{2}\\rangle \\right)$\n$$= \\sqrt{\\frac{1}{3}} \\left( 0 + |1,-1; \\tfrac{1}{2},-\\tfrac{1}{2}\\rangle \\right) + \\sqrt{\\frac{2}{3}} \\left( \\sqrt{2}|1,-1; \\tfrac{1}{2},-\\tfrac{1}{2}\\rangle + 0 \\right)$$\n$$= \\frac{1}{\\sqrt{3}}|1,-1; \\tfrac{1}{2},-\\tfrac{1}{2}\\rangle + \\frac{2}{\\sqrt{3}}|1,-1; \\tfrac{1}{2},-\\tfrac{1}{2}\\rangle = \\frac{3}{\\sqrt{3}}|1,-1; \\tfrac{1}{2},-\\tfrac{1}{2}\\rangle = \\sqrt{3}|1,-1; \\tfrac{1}{2},-\\tfrac{1}{2}\\rangle$$\n令两边相等得到 $|\\frac{3}{2},-\\frac{3}{2}\\rangle = |1,-1; \\frac{1}{2},-\\frac{1}{2}\\rangle$。\nCGC 为 $\\langle 1,\\frac{1}{2}; -1,-\\frac{1}{2} | \\frac{3}{2},-\\frac{3}{2} \\rangle = 1$。\n\n现在，我们推导 $J=\\frac{1}{2}$ 多重态的态。\n对于 $M=\\frac{1}{2}$，最一般的态是具有 $m_l+m_s=\\frac{1}{2}$ 的非耦合基态的线性组合：\n$$|\\tfrac{1}{2},\\tfrac{1}{2}\\rangle = a |1,1; \\tfrac{1}{2},-\\tfrac{1}{2}\\rangle + b |1,0; \\tfrac{1}{2},\\tfrac{1}{2}\\rangle$$\n该态必须与我们之前找到的 $|\\frac{3}{2},\\frac{1}{2}\\rangle$ 态正交。\n$\\langle \\frac{3}{2},\\frac{1}{2} | \\frac{1}{2},\\frac{1}{2} \\rangle = 0$。\n$$\\left( \\sqrt{\\frac{1}{3}}\\langle 1,1; \\tfrac{1}{2},-\\tfrac{1}{2}| + \\sqrt{\\frac{2}{3}}\\langle 1,0; \\tfrac{1}{2},\\tfrac{1}{2}| \\right) \\left( a |1,1; \\tfrac{1}{2},-\\tfrac{1}{2}\\rangle + b |1,0; \\tfrac{1}{2},\\tfrac{1}{2}\\rangle \\right) = 0$$\n$$a\\sqrt{\\frac{1}{3}} + b\\sqrt{\\frac{2}{3}} = 0 \\implies a = -b\\sqrt{2}$$\n该态为 $|\\frac{1}{2},\\frac{1}{2}\\rangle = b(-\\sqrt{2}|1,1; \\frac{1}{2},-\\frac{1}{2}\\rangle + |1,0; \\frac{1}{2},\\frac{1}{2}\\rangle)$。\n归一化要求 $\\langle \\frac{1}{2},\\frac{1}{2} | \\frac{1}{2},\\frac{1}{2} \\rangle = 1$，所以 $|b|^2((-\\sqrt{2})^2+1^2)=1 \\implies 3|b|^2=1 \\implies |b|=\\frac{1}{\\sqrt{3}}$。\n一个常见的相位约定（Condon-Shortley 约定的一部分）选择具有最大 $m_l$ 的非耦合态的系数为正。此处，具有最大 $m_l$ 的态是 $|1,1; \\frac{1}{2},-\\frac{1}{2}\\rangle$，其系数是 $a$。我们选择 $a>0$。\n由于 $a=-b\\sqrt{2}$，选择 $a>0$ 意味着 $b0$。我们取 $b = -\\frac{1}{\\sqrt{3}}$。\n那么 $a = -(-\\frac{1}{\\sqrt{3}})\\sqrt{2} = \\sqrt{\\frac{2}{3}}$。\n因此， $|\\frac{1}{2},\\frac{1}{2}\\rangle = \\sqrt{\\frac{2}{3}}|1,1; \\frac{1}{2},-\\frac{1}{2}\\rangle - \\sqrt{\\frac{1}{3}}|1,0; \\frac{1}{2},\\frac{1}{2}\\rangle$。\nCGCs 为 $\\langle 1,\\frac{1}{2}; 1,-\\frac{1}{2} | \\frac{1}{2},\\frac{1}{2} \\rangle = \\sqrt{\\frac{2}{3}}$ 和 $\\langle 1,\\frac{1}{2}; 0,\\frac{1}{2} | \\frac{1}{2},\\frac{1}{2} \\rangle = -\\sqrt{\\frac{1}{3}}$。\n\n最后，我们应用 $\\hat{J}_{-}$ 来找到 $|\\frac{1}{2},-\\frac{1}{2}\\rangle$。\nLHS: $\\hat{J}_{-}|\\frac{1}{2},\\frac{1}{2}\\rangle = \\sqrt{\\frac{1}{2}(\\frac{3}{2}) - \\frac{1}{2}(-\\frac{1}{2})}|\\frac{1}{2},-\\frac{1}{2}\\rangle = \\sqrt{1}|\\frac{1}{2},-\\frac{1}{2}\\rangle = |\\frac{1}{2},-\\frac{1}{2}\\rangle$。\nRHS: $(\\hat{L}_{-} + \\hat{S}_{-}) \\left( \\sqrt{\\frac{2}{3}}|1,1; \\tfrac{1}{2},-\\tfrac{1}{2}\\rangle - \\sqrt{\\frac{1}{3}}|1,0; \\tfrac{1}{2},\\tfrac{1}{2}\\rangle \\right)$\n$$= \\sqrt{\\frac{2}{3}} \\left( \\sqrt{2}|1,0; \\tfrac{1}{2},-\\tfrac{1}{2}\\rangle + 0 \\right) - \\sqrt{\\frac{1}{3}} \\left( \\sqrt{2}|1,-1; \\tfrac{1}{2},\\tfrac{1}{2}\\rangle + |1,0; \\tfrac{1}{2},-\\tfrac{1}{2}\\rangle \\right)$$\n$$= \\frac{2}{\\sqrt{3}}|1,0; \\tfrac{1}{2},-\\tfrac{1}{2}\\rangle - \\frac{\\sqrt{2}}{\\sqrt{3}}|1,-1; \\tfrac{1}{2},\\tfrac{1}{2}\\rangle - \\frac{1}{\\sqrt{3}}|1,0; \\tfrac{1}{2},-\\tfrac{1}{2}\\rangle$$\n$$= -\\sqrt{\\frac{2}{3}}|1,-1; \\tfrac{1}{2},\\tfrac{1}{2}\\rangle + \\sqrt{\\frac{1}{3}}|1,0; \\tfrac{1}{2},-\\tfrac{1}{2}\\rangle$$\n所以， $|\\frac{1}{2},-\\frac{1}{2}\\rangle = -\\sqrt{\\frac{2}{3}}|1,-1; \\frac{1}{2},\\frac{1}{2}\\rangle + \\sqrt{\\frac{1}{3}}|1,0; \\frac{1}{2},-\\frac{1}{2}\\rangle$。\nCGCs 为 $\\langle 1,\\frac{1}{2}; -1,\\frac{1}{2} | \\frac{1}{2},-\\frac{1}{2} \\rangle = -\\sqrt{\\frac{2}{3}}$ 和 $\\langle 1,\\frac{1}{2}; 0,-\\frac{1}{2} | \\frac{1}{2},-\\frac{1}{2} \\rangle = \\sqrt{\\frac{1}{3}}$。\n\n验证：对于每个 $M$，推导出的耦合态构成一个正交归一集。\n对于 $M=\\frac{1}{2}$：\n归一性： $\\langle \\frac{3}{2},\\frac{1}{2}|\\frac{3}{2},\\frac{1}{2} \\rangle = (\\sqrt{\\frac{1}{3}})^2 + (\\sqrt{\\frac{2}{3}})^2 = \\frac{1}{3}+\\frac{2}{3}=1$。\n$\\langle \\frac{1}{2},\\frac{1}{2}|\\frac{1}{2},\\frac{1}{2} \\rangle = (\\sqrt{\\frac{2}{3}})^2 + (-\\sqrt{\\frac{1}{3}})^2 = \\frac{2}{3}+\\frac{1}{3}=1$。\n正交性： $\\langle \\frac{3}{2},\\frac{1}{2}|\\frac{1}{2},\\frac{1}{2} \\rangle = (\\sqrt{\\frac{1}{3}})(\\sqrt{\\frac{2}{3}}) + (\\sqrt{\\frac{2}{3}})(-\\sqrt{\\frac{1}{3}}) = \\frac{\\sqrt{2}}{3}-\\frac{\\sqrt{2}}{3}=0$。\n对于 $M=-\\frac{1}{2}$：\n归一性： $\\langle \\frac{3}{2},-\\frac{1}{2}|\\frac{3}{2},-\\frac{1}{2} \\rangle = (\\sqrt{\\frac{2}{3}})^2 + (\\sqrt{\\frac{1}{3}})^2 = \\frac{2}{3}+\\frac{1}{3}=1$。\n$\\langle \\frac{1}{2},-\\frac{1}{2}|\\frac{1}{2},-\\frac{1}{2} \\rangle = (\\sqrt{\\frac{1}{3}})^2 + (-\\sqrt{\\frac{2}{3}})^2 = \\frac{1}{3}+\\frac{2}{3}=1$。\n正交性： $\\langle \\frac{3}{2},-\\frac{1}{2}|\\frac{1}{2},-\\frac{1}{2} \\rangle = (\\sqrt{\\frac{2}{3}})(\\sqrt{\\frac{1}{3}}) + (\\sqrt{\\frac{1}{3}})(-\\sqrt{\\frac{2}{3}}) = \\frac{\\sqrt{2}}{3}-\\frac{\\sqrt{2}}{3}=0$。\n结果是一致的。\n\n下面按指定顺序汇编了所要求的 CGCs 列表，$\\langle 1,\\tfrac{1}{2};m_{l},m_{s}\\,|\\,J,M\\rangle$：\n1. $\\langle 1,\\tfrac{1}{2};1,\\tfrac{1}{2}\\,|\\,\\tfrac{3}{2},\\tfrac{3}{2}\\rangle = 1$\n2. $\\langle 1,\\tfrac{1}{2};1,-\\tfrac{1}{2}\\,|\\,\\tfrac{3}{2},\\tfrac{1}{2}\\rangle = \\sqrt{\\frac{1}{3}}$\n3. $\\langle 1,\\tfrac{1}{2};0,\\tfrac{1}{2}\\,|\\,\\tfrac{3}{2},\\tfrac{1}{2}\\rangle = \\sqrt{\\frac{2}{3}}$\n4. $\\langle 1,\\tfrac{1}{2};0,-\\tfrac{1}{2}\\,|\\,\\tfrac{3}{2},-\\tfrac{1}{2}\\rangle = \\sqrt{\\frac{2}{3}}$\n5. $\\langle 1,\\tfrac{1}{2};-1,\\tfrac{1}{2}\\,|\\,\\tfrac{3}{2},-\\tfrac{1}{2}\\rangle = \\sqrt{\\frac{1}{3}}$\n6. $\\langle 1,\\tfrac{1}{2};-1,-\\tfrac{1}{2}\\,|\\,\\tfrac{3}{2},-\\tfrac{3}{2}\\rangle = 1$\n7. $\\langle 1,\\tfrac{1}{2};1,-\\tfrac{1}{2}\\,|\\,\\tfrac{1}{2},\\tfrac{1}{2}\\rangle = \\sqrt{\\frac{2}{3}}$\n8. $\\langle 1,\\tfrac{1}{2};0,\\tfrac{1}{2}\\,|\\,\\tfrac{1}{2},\\tfrac{1}{2}\\rangle = -\\sqrt{\\frac{1}{3}}$\n9. $\\langle 1,\\tfrac{1}{2};0,-\\tfrac{1}{2}\\,|\\,\\tfrac{1}{2},-\\tfrac{1}{2}\\rangle = \\sqrt{\\frac{1}{3}}$\n10. $\\langle 1,\\tfrac{1}{2};-1,\\tfrac{1}{2}\\,|\\,\\tfrac{1}{2},-\\tfrac{1}{2}\\rangle = -\\sqrt{\\frac{2}{3}}$", "answer": "$$ \\boxed{ \\begin{pmatrix} 1  \\sqrt{\\frac{1}{3}}  \\sqrt{\\frac{2}{3}}  \\sqrt{\\frac{2}{3}}  \\sqrt{\\frac{1}{3}}  1  \\sqrt{\\frac{2}{3}}  -\\sqrt{\\frac{1}{3}}  \\sqrt{\\frac{1}{3}}  -\\sqrt{\\frac{2}{3}} \\end{pmatrix} } $$", "id": "3541616"}, {"introduction": "在理解了如何耦合角动量之后，下一步是掌握这些角动量本征态在空间转动下的变换行为，这由维格纳D矩阵（Wigner D-matrices）描述。本练习要求你从角动量算符的对易关系出发，利用Rodrigues风格的公式推导 $j=1$ 情形下的维格纳小 $d$ 矩阵。这一过程不仅揭示了转动算符的矩阵表示是如何从基本代数中产生的，也为在计算物理中处理转动对称性问题提供了关键工具。[@problem_id:3541647]", "problem": "在计算核物理中角动量投影方法所使用的旋转对称操作的背景下，考虑二维特殊酉群（SU(2)）及其与三维特殊正交群（SO(3)）的关系。在自然单位制中进行计算，设 $\\hbar = 1$。角动量算符满足对易关系 $[J_i, J_j] = i \\epsilon_{ijk} J_k$，绕 $y$ 轴旋转角度 $\\beta$ 的操作由 $\\exp(- i \\beta J_y)$ 生成。Wigner $d$ 矩阵 $d^j_{m m'}(\\beta)$ 定义为矩阵元集合 $\\langle j m | \\exp(- i \\beta J_y) | j m' \\rangle$。仅使用这些基本事实，按以下步骤进行。\n\n在标准 $| j m \\rangle$ 基下（其中 $m \\in \\{1, 0, -1\\}$），推导 $j = 1$ 时的显式 $3 \\times 3$ 小 $d$ 矩阵 $d^1_{m m'}(\\beta)$。您的推导必须从对易关系和 SU(2) 有限维表示的指数的有效 Rodrigues 形式约化出发，不得引用任何预先制表的 Wigner $d$ 矩阵元。然后使用您的结果计算定积分\n$$\nI \\equiv \\int_{0}^{\\pi} d\\beta \\, \\sin\\beta \\, \\left[d^1_{1,0}(\\beta)\\right]^2,\n$$\n其中角度 $\\beta$ 以弧度为单位。将 $I$ 的最终值表示为一个精确分数。不需要进行数值舍入。", "solution": "问题分为两部分。首先，我们必须使用基于角动量算符基本性质的方法，推导 $j=1$ 时的 Wigner 小 $d$ 矩阵，记为 $d^1_{m m'}(\\beta)$。其次，我们必须使用这个推导出的矩阵来计算一个特定的定积分。\n\n### 第一部分：Wigner $d^1(\\beta)$ 矩阵的推导\n\nWigner 小 $d$ 矩阵由绕 $y$ 轴旋转算符的矩阵元定义：\n$$d^j_{m m'}(\\beta) = \\langle j m | \\exp(-i \\beta J_y) | j m' \\rangle$$\n这里我们在自然单位制中计算，$\\hbar=1$。对于本问题，我们关心 $j=1$ 的情况。基矢为 $|1, 1\\rangle$、 $|1, 0\\rangle$ 和 $|1, -1\\rangle$。我们将角动量算符表示为在此基下的 $3 \\times 3$ 矩阵，基矢顺序为 $(|1, 1\\rangle, |1, 0\\rangle, |1, -1\\rangle)^T$。\n\n角动量升降算符 $J_+$ 和 $J_-$ 作用于基矢 $|j, m\\rangle$ 的结果如下：\n$$J_{\\pm} |j, m\\rangle = \\sqrt{j(j+1) - m(m\\pm1)} |j, m\\pm1\\rangle$$\n对于 $j=1$，它们的作用是：\n$J_+|1,1\\rangle = 0$, $J_+|1,0\\rangle = \\sqrt{2}|1,1\\rangle$, $J_+|1,-1\\rangle = \\sqrt{2}|1,0\\rangle$.\n$J_-|1,1\\rangle = \\sqrt{2}|1,0\\rangle$, $J_-|1,0\\rangle = \\sqrt{2}|1,-1\\rangle$, $J_-|1,-1\\rangle = 0$.\n\n写成矩阵形式，可得：\n$$J_+ = \\begin{pmatrix} 0  \\sqrt{2}  0 \\\\ 0  0  \\sqrt{2} \\\\ 0  0  0 \\end{pmatrix}, \\quad J_- = \\begin{pmatrix} 0  0  0 \\\\ \\sqrt{2}  0  0 \\\\ 0  \\sqrt{2}  0 \\end{pmatrix}$$\n\n算符 $J_y$ 与 $J_+$ 和 $J_-$ 的关系为 $J_y = \\frac{1}{2i}(J_+ - J_-)$。代入矩阵：\n$$J_y = \\frac{1}{2i} \\left( \\begin{pmatrix} 0  \\sqrt{2}  0 \\\\ 0  0  \\sqrt{2} \\\\ 0  0  0 \\end{pmatrix} - \\begin{pmatrix} 0  0  0 \\\\ \\sqrt{2}  0  0 \\\\ 0  \\sqrt{2}  0 \\end{pmatrix} \\right) = \\frac{1}{2i} \\begin{pmatrix} 0  \\sqrt{2}  0 \\\\ -\\sqrt{2}  0  \\sqrt{2} \\\\ 0  -\\sqrt{2}  0 \\end{pmatrix} = \\begin{pmatrix} 0  -i/\\sqrt{2}  0 \\\\ i/\\sqrt{2}  0  -i/\\sqrt{2} \\\\ 0  i/\\sqrt{2}  0 \\end{pmatrix}$$\n\n为了计算矩阵指数 $\\exp(-i \\beta J_y)$，我们研究矩阵 $J_y$ 的幂。$J_y$ 的特征多项式为 $\\lambda^3 - \\lambda = 0$。根据 Cayley-Hamilton 定理，矩阵 $J_y$ 满足其自身的特征方程，因此 $J_y^3 = J_y$。\n\n这个性质使得我们可以使用 Rodrigues 风格的公式来简化指数的计算：\n$$\\exp(-i \\beta J_y) = I - i J_y \\sin\\beta + J_y^2 (\\cos\\beta - 1)$$\n我们计算 $J_y^2$：\n$$J_y^2 = \\begin{pmatrix} 0  -i/\\sqrt{2}  0 \\\\ i/\\sqrt{2}  0  -i/\\sqrt{2} \\\\ 0  i/\\sqrt{2}  0 \\end{pmatrix} \\begin{pmatrix} 0  -i/\\sqrt{2}  0 \\\\ i/\\sqrt{2}  0  -i/\\sqrt{2} \\\\ 0  i/\\sqrt{2}  0 \\end{pmatrix} = \\begin{pmatrix} 1/2  0  -1/2 \\\\ 0  1  0 \\\\ -1/2  0  1/2 \\end{pmatrix}$$\n\n现在，我们构建 $d^1(\\beta)$ 矩阵：\n$$d^1(\\beta) = \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} - i\\sin\\beta \\begin{pmatrix} 0  -i/\\sqrt{2}  0 \\\\ i/\\sqrt{2}  0  -i/\\sqrt{2} \\\\ 0  i/\\sqrt{2}  0 \\end{pmatrix} + (\\cos\\beta-1)\\begin{pmatrix} 1/2  0  -1/2 \\\\ 0  1  0 \\\\ -1/2  0  1/2 \\end{pmatrix}$$\n$$d^1(\\beta) = \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} + \\begin{pmatrix} 0  -\\sin\\beta/\\sqrt{2}  0 \\\\ \\sin\\beta/\\sqrt{2}  0  -\\sin\\beta/\\sqrt{2} \\\\ 0  \\sin\\beta/\\sqrt{2}  0 \\end{pmatrix} + \\begin{pmatrix} (\\cos\\beta-1)/2  0  -(\\cos\\beta-1)/2 \\\\ 0  \\cos\\beta-1  0 \\\\ -(\\cos\\beta-1)/2  0  (\\cos\\beta-1)/2 \\end{pmatrix}$$\n将各项按元素相加，得到最终矩阵：\n$$d^1(\\beta) = \\begin{pmatrix} 1+\\frac{\\cos\\beta-1}{2}  -\\frac{\\sin\\beta}{\\sqrt{2}}  -\\frac{\\cos\\beta-1}{2} \\\\ \\frac{\\sin\\beta}{\\sqrt{2}}  1+\\cos\\beta-1  -\\frac{\\sin\\beta}{\\sqrt{2}} \\\\ -\\frac{\\cos\\beta-1}{2}  \\frac{\\sin\\beta}{\\sqrt{2}}  1+\\frac{\\cos\\beta-1}{2} \\end{pmatrix}$$\n$$d^1(\\beta) = \\begin{pmatrix} \\frac{1+\\cos\\beta}{2}  -\\frac{\\sin\\beta}{\\sqrt{2}}  \\frac{1-\\cos\\beta}{2} \\\\ \\frac{\\sin\\beta}{\\sqrt{2}}  \\cos\\beta  -\\frac{\\sin\\beta}{\\sqrt{2}} \\\\ \\frac{1-\\cos\\beta}{2}  \\frac{\\sin\\beta}{\\sqrt{2}}  \\frac{1+\\cos\\beta}{2} \\end{pmatrix}$$\n矩阵元 $d^1_{m m'}(\\beta)$ 对应于由 $m \\in \\{1, 0, -1\\}$ 索引的行和由 $m' \\in \\{1, 0, -1\\}$ 索引的列。\n\n### 第二部分：定积分的计算\n\n我们需要计算的积分是：\n$$I = \\int_{0}^{\\pi} d\\beta \\, \\sin\\beta \\, \\left[d^1_{1,0}(\\beta)\\right]^2$$\n从推导出的矩阵中，矩阵元 $d^1_{1,0}(\\beta)$ 是第一行（$m=1$）和第二列（$m'=0$）的元素：\n$$d^1_{1,0}(\\beta) = -\\frac{\\sin\\beta}{\\sqrt{2}}$$\n将其平方得到：\n$$\\left[d^1_{1,0}(\\beta)\\right]^2 = \\left(-\\frac{\\sin\\beta}{\\sqrt{2}}\\right)^2 = \\frac{\\sin^2\\beta}{2}$$\n现在将其代入 $I$ 的积分表达式：\n$$I = \\int_{0}^{\\pi} \\sin\\beta \\left( \\frac{\\sin^2\\beta}{2} \\right) d\\beta = \\frac{1}{2} \\int_{0}^{\\pi} \\sin^3\\beta \\, d\\beta$$\n为了计算这个积分，我们可以将 $\\sin^3\\beta$ 改写为 $\\sin\\beta(1-\\cos^2\\beta)$，并使用换元法，令 $u = \\cos\\beta$，这意味着 $du = -\\sin\\beta \\,d\\beta$。积分上下限从 $\\beta=0$ 变为 $u=\\cos(0)=1$，从 $\\beta=\\pi$ 变为 $u=\\cos(\\pi)=-1$。\n$$I = \\frac{1}{2} \\int_{0}^{\\pi} (1-\\cos^2\\beta)\\sin\\beta \\, d\\beta = \\frac{1}{2} \\int_{1}^{-1} (1-u^2)(-du)$$\n$$I = \\frac{1}{2} \\int_{-1}^{1} (1-u^2) \\, du$$\n现在，我们进行初等积分：\n$$I = \\frac{1}{2} \\left[ u - \\frac{u^3}{3} \\right]_{-1}^{1}$$\n$$I = \\frac{1}{2} \\left[ \\left(1 - \\frac{1^3}{3}\\right) - \\left(-1 - \\frac{(-1)^3}{3}\\right) \\right]$$\n$$I = \\frac{1}{2} \\left[ \\left(1 - \\frac{1}{3}\\right) - \\left(-1 + \\frac{1}{3}\\right) \\right]$$\n$$I = \\frac{1}{2} \\left[ \\frac{2}{3} - \\left(-\\frac{2}{3}\\right) \\right] = \\frac{1}{2} \\left[ \\frac{2}{3} + \\frac{2}{3} \\right] = \\frac{1}{2} \\left( \\frac{4}{3} \\right)$$\n$$I = \\frac{2}{3}$$\n该定积分的值是一个精确分数。", "answer": "$$\\boxed{\\frac{2}{3}}$$", "id": "3541647"}, {"introduction": "角动量代数的威力在实际的大规模计算中体现得淋漓尽致，其中对称性选择定则是关键。本练习旨在将抽象的理论（如维格纳-埃卡特定理和泡利原理）转化为一个实用的计算工具，即一个自动筛选和剔除无效两体矩阵元的程序。通过实现这个“剪枝”算法，你将亲身体会到角动量和宇称守恒等基本对称性如何能够极大地削减计算量，这是现代计算核物理中不可或缺的一步。[@problem_id:3541618]", "problem": "编写一个完整、可运行的程序，该程序基于 Wigner–Eckart 定理和角动量代数，为 $j$-耦合中的两体矩阵元通道构建一个自动选择定则剪枝器，并量化通过消除因对称性而可证明为零的通道所获得的计算节省。对于每个两体通道，该剪枝器必须应用以下逻辑上派生的、源于 Wigner–Eckart 定理和自旋 $s=\\tfrac{1}{2}$ 的全同核子的费米子反对称性的非零条件：\n1. 三角约束：对于具有总角动量 $j_a$ 和 $j_b$ 的单粒子态耦合对 $(a,b)$，耦合的两体角动量 $J$ 必须满足 $|j_a - j_b| \\le J \\le j_a + j_b$。右矢对 $(c,d)$ 也必须满足同样的条件：$|j_c - j_d| \\le J \\le j_c + j_d$。这些是约化形式的 Clebsch–Gordan 系数（源于 Wigner–Eckart 定理）非零的充要条件。\n2. 转动不变性：对于标量两体算符，左矢和右矢中的总耦合角动量 $J$ 必须相同，即使用由 $((ab)J,(cd)J)$ 标记的通道。\n3. 宇称守恒：两体宇称等于单体宇称的乘积，单粒子宇称由 $\\pi_i = (-1)^{l_i}$ 给出。非零标量两体矩阵元要求 $(-1)^{l_a + l_b} = (-1)^{l_c + l_d}$。\n4. $j$-耦合中的费米子反对称性：反对称化的双粒子态仅在其交换对称性为奇时存在。在 $j$-耦合中，这一点通过以下方式强制执行。对于 $a=b$ 的全同轨道通道，仅当 $(-1)^{j_a + j_b - J} = -1$（等价于 $j_a + j_b - J$ 为奇整数）时，该态才存在。同样地，该条件也必须独立地对 $c=d$ 成立。对于 $a \\ne b$（或 $c \\ne d$），反对称化本身不会使任何允许的 $J$ 的通道无效。这是费米子交换约束的 $j$-耦合实现，与在原子核结构背景中通常由相位因子（如 $(-1)^{l+s+j}$）总结的常规交换相分类一致。\n\n为保持计算纯粹离散并避免代码中出现半整数，所有角动量必须以双倍单位表示。将每个单粒子总角动量表示为 $2j \\in \\mathbb{Z}$，每个耦合的两体角动量表示为 $2J \\in \\mathbbZ$。那么三角约束变为 $|2j_a - 2j_b| \\le 2J \\le 2j_a + 2j_b$。全同轨道通道的交换约束变为 $(2j_a + 2j_b - 2J)/2$ 为奇数，等价于 $2j_a + 2j_b - 2J \\equiv 2 \\pmod{4}$。\n\n对于每个测试用例，您的程序必须执行以下操作：\n- 输入一个由单粒子轨道组成的列表，每个轨道由对 $(l, 2j)$ 描述，其中 $l \\in \\mathbb{Z}_{\\ge 0}$ 且 $2j \\in \\mathbb{Z}_{0}$，并带有物理限制条件，即 $2j$ 为奇数且 $j \\in \\{l \\pm \\tfrac{1}{2}\\}$。\n- 形成唯一的无序对 $(a,b)$（其中 $a \\le b$）的集合作为左矢，以及 $(c,d)$（其中 $c \\le d$）的集合作为右矢。定义 $2J_{\\max}$ 为空间中所有对 $(a,b)$ 的 $2j_a + 2j_b$ 的最大值。朴素枚举考虑所有此类对的每个通道 $((ab)J,(cd)J)$，其中 $2J \\in \\{0,2,4,\\dots,2J_{\\max}\\}$，不进行任何选择定则剪枝。\n- 定义朴素计数 $N_{\\text{naive}}$ 为朴素枚举中通道 $((ab)J,(cd)J)$ 的总数。定义剪枝后计数 $N_{\\text{pruned}}$ 为同时满足以下条件的通道数：$(a,b)$ 和 $(c,d)$ 的三角约束、左矢和右矢由相同 $J$ 标记的转动标量要求、宇称守恒约束 $(-1)^{l_a + l_b} = (-1)^{l_c + l_d}$，以及上述为全同轨道对指定的交换反对称性。\n- 计算节省分数 $S = 1 - \\dfrac{N_{\\text{pruned}}}{N_{\\text{naive}}}$，结果为浮点数。\n\n您的程序必须从 Wigner–Eckart 定理和基本角动量代数的第一性原理出发实现此逻辑。除上述逻辑上必要的约束外，不要假设任何公式。所有决策必须源于这些原理，并且所有角动量选择检查必须直接在双倍单位中执行，以避免浮点半整数。\n\n测试套件。对于以下五个测试用例中的每一个，运行剪枝计算，并将节省分数 $S$ 报告为四舍五入到六位小数的浮点数：\n- 用例 1（单轨道 $s$-壳层）：轨道 $[(l,2j)] = [(0,1)]$。\n- 用例 2（$p$-壳层中的自旋轨道伴侣）：轨道 $[(1,1),(1,3)]$。\n- 用例 3（混合类 $pf$ 空间）：轨道 $[(3,7),(1,3),(3,5),(1,1)]$。\n- 用例 4（混合类 $sdg$ 空间）：轨道 $[(2,5),(0,1),(2,3),(4,7),(4,9)]$。\n- 用例 5（更大的混合空间）：轨道 $[(3,7),(1,3),(3,5),(1,1),(2,5),(2,3),(0,1),(4,9)]$。\n\n最终输出格式。您的程序应生成单行输出，其中包含上述用例的五个节省分数，以逗号分隔并用方括号括起来的列表形式，按所列用例的顺序排列，例如 $[x_1,x_2,x_3,x_4,x_5]$，其中每个 $x_i$ 都四舍五入到六位小数。不应打印任何附加文本。不涉及物理单位，并且通过标准角动量代数，所有角度均为隐式弧度；因此输出中无需单独指定单位。", "solution": "该问题要求开发一个程序，以实现并量化在使用 $j$-耦合方案的原子核结构计算中，通过选择定则剪枝两体矩阵元通道的有效性。任务的核心是比较一个朴素构建的空间中的通道数量与应用了源于 Wigner–Eckart 定理和全同费米子的泡利不相容原理的物理强制选择定则后，仍然存在的通道数量。\n\n解决方案首先定义所有可能通道的总空间，然后系统地对每个通道应用一系列验证检查。一个通道由元组 $((ab)J, (cd)J)$ 表示，其中 $a$、$b$、$c$ 和 $d$ 是单粒子轨道，而 $J$ 是守恒的总角动量。所有角动量都用其双倍值（$2j$, $2J$）表示，以确保所有计算都可以用整数进行。\n\n**1. 朴素通道空间的构建**\n\n首先，我们定义所有可能通道的“朴素”空间，剪枝后的空间将与之进行比较。\n给定一组 $n$ 个唯一的单粒子轨道 $\\{o_0, o_1, \\dots, o_{n-1}\\}$，两体态的基矢由这些轨道的所有唯一无序对形成。一个无序对可以用索引 $(i, k)$ 表示，使得 $0 \\le i \\le k  n$。此类对的总数为 $N_{\\text{pairs}} = n(n+1)/2$。\n\n一个标量算符的两体矩阵元连接一个由对 $(a, b)$ 表征的左矢态和一个由对 $(c, d)$ 表征的右矢态，它们具有相同的总角动量 $J$。朴素枚举考虑了左矢对、右矢对和可能的 $2J$ 值的每一种组合。\n\n可能的 $2J$ 值的范围由最大可能耦合角动量决定。这由 $2J_{\\max} = \\max_{i,k} (2j_i + 2j_k)$ 给出，其中最大值取自模型空间中所有轨道对。由于耦合两个具有半整数自旋的粒子（如自旋为 $s=1/2$ 的核子）会得到一个整数总角动量 $J$，因此双倍值 $2J$ 必须是偶数。因此，所考虑的值的集合是 $2J \\in \\{0, 2, 4, \\dots, 2J_{\\max}\\}$。此类值的数量为 $N_J = (2J_{\\max}/2) + 1$。\n\n朴素空间中通道的总数是可能的左矢对、右矢对和 $J$ 值数量的乘积：\n$$ N_{\\text{naive}} = N_{\\text{pairs}} \\times N_{\\text{pairs}} \\times N_J $$\n\n**2. 通过选择定则进行通道剪枝**\n\n一个通道 $((ab)J, (cd)J)$ 只有在满足几个源于基本对称性的选择定则时，才对应一个物理上非零的矩阵元。该算法通过对照这些规则检查每个通道来剪枝朴素空间。\n\n*   **三角条件**：Wigner–Eckart 定理意味着矩阵元与一个 Clebsch–Gordan 系数（或一个相关的 $3j$-符号）成正比。该系数仅在耦合角动量满足三角不等式时非零。这必须对左矢态和右矢态中耦合的角动量都成立。使用双倍角动量，这些条件是：\n    $$ |2j_a - 2j_b| \\le 2J \\le 2j_a + 2j_b $$\n    $$ |2j_c - 2j_d| \\le 2J \\le 2j_c + 2j_d $$\n\n*   **宇称守恒**：核相互作用主要是宇称守恒的。因此，初态的总宇称必须等于末态的总宇称。单粒子态的宇称是 $\\pi_i = (-1)^{l_i}$，其中 $l_i$ 是轨道角动量。两体态的宇称是单粒子宇称的乘积，$\\pi_{ab} = \\pi_a \\pi_b = (-1)^{l_a+l_b}$。因此，守恒规则是：\n    $$ (-1)^{l_a+l_b} = (-1)^{l_c+l_d} \\iff (l_a+l_b) \\equiv (l_c+l_d) \\pmod{2} $$\n\n*   **费米子反对称性**：泡利不相容原理要求两个全同费米子的总波函数在粒子交换下是反对称的。对于处于*相同*轨道 $a$（即具有相同的量子数 $l_a, j_a$）的两个核子，这一要求严重限制了它们耦合总角动量 $J$ 的可能值。已知允许的值为 $J \\in \\{0, 2, \\ldots, 2j_a - 1\\}$。这对应于在交换下反对称的态。问题为此条件提供了一个计算上方便的整数算术检查：\n    $$ \\frac{2j_a + 2j_a - 2J}{2} \\text{ 是奇数} \\iff (4j_a - 2J) \\equiv 2 \\pmod{4} $$\n    由于 $2j_a$ 是奇数，$4j_a$ 是 $2 \\pmod 4$，所以这是 $(2-2J)\\pmod 4=2$，这意味着 $-2J \\pmod 4 = 0$，所以 $2J \\pmod 4 = 0$。让我重新验证问题陈述中给出的条件。条件是对于 $a=b$，$((2j_a) + (2j_a) - 2J) \\pmod 4 = 2$。\n    此条件独立应用于左矢对（如果 $a=b$）和右矢对（如果 $c=d$）。对于非全同轨道对 ($a \\ne b$)，反对称化的处理方式不同，并且不会先验地排除任何由三角规则允许的 $J$ 值。\n\n**3. 算法实现和节省计算**\n\n程序通过迭代朴素构建空间中的所有通道来实现此逻辑。一个计数器 $N_{\\text{pruned}}$ 初始化为 0。该算法采用一组嵌套循环：\n1.  外层循环遍历所有唯一的左矢对 $(a, b)$。\n2.  内层循环遍历所有唯一的右矢对 $(c, d)$。\n3.  最内层循环遍历从 $0$ 到 $2J_{\\max}$ 的所有可能的 $2J$ 值，步长为 $2$。\n\n在最内层循环中，测试一个通道是否满足四个选择定则（左矢的三角约束、右矢的三角约束、宇称守恒，以及在适用时对左矢和右矢的反对称性）。一个通道必须通过所有测试才被认为是物理上允许的。如果通过，则 $N_{\\text{pruned}}$ 递增。\n\n检查完所有朴素通道后，计算节省分数 $S$。这表示了可以在不执行完整计算的情况下丢弃的通道的比例。\n$$ S = 1 - \\frac{N_{\\text{pruned}}}{N_{\\text{naive}}} $$\n这个分数直接衡量了在计算原子核物理背景下利用这些基本对称性所获得的效率提升。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef calculate_savings_fraction(orbitals):\n    \"\"\"\n    Calculates the computational savings fraction for a given set of\n    single-particle orbitals by pruning two-body channels.\n\n    Args:\n        orbitals (list): A list of tuples, where each tuple is (l, 2j)\n                         representing a single-particle orbital.\n\n    Returns:\n        float: The savings fraction S = 1 - N_pruned / N_naive.\n    \"\"\"\n    n = len(orbitals)\n    if n == 0:\n        return 0.0\n\n    # 1. Generate unique unordered pairs of orbital indices for the basis\n    # A pair is represented by (i, k) where i = k.\n    idx_pairs = []\n    for i in range(n):\n        for k in range(i, n):\n            idx_pairs.append((i, k))\n    num_pairs = len(idx_pairs)\n\n    # 2. Determine the range of total angular momentum J\n    # Find 2J_max = max(2j_i + 2j_k) over all pairs of orbitals.\n    max_2j_sum = 0\n    # The max sum can occur for any two orbitals, not necessarily from a unique pair.\n    for i in range(n):\n        for k in range(n):\n            max_2j_sum = max(max_2j_sum, orbitals[i][1] + orbitals[k][1])\n    \n    # 2J must be an even integer. It ranges from 0 to 2J_max.\n    two_J_values = range(0, max_2j_sum + 1, 2)\n    num_J_values = len(two_J_values)\n\n    # 3. Calculate the naive number of channels\n    # N_naive = (num_bra_pairs) * (num_ket_pairs) * (num_J_values)\n    if num_J_values == 0: # This case may happen if max_2j_sum is negative, but 2j > 0.\n        return 0.0\n    N_naive = num_pairs * num_pairs * num_J_values\n    if N_naive == 0:\n        # If there are no channels to begin with, saving is undefined or 0.\n        # This can happen if n=0.\n        return 0.0\n\n    # 4. Calculate the pruned number of channels by applying selection rules\n    N_pruned = 0\n    for i_a, i_b in idx_pairs:\n        l_a, two_j_a = orbitals[i_a]\n        l_b, two_j_b = orbitals[i_b]\n        is_bra_identical = (i_a == i_b)\n\n        for i_c, i_d in idx_pairs:\n            l_c, two_j_c = orbitals[i_c]\n            l_d, two_j_d = orbitals[i_d]\n            is_ket_identical = (i_c == i_d)\n\n            # Rule: Parity conservation.\n            # (-1)^(l_a+l_b) == (-1)^(l_c+l_d)\n            # This is independent of J, so we check it first to optimize.\n            if (l_a + l_b) % 2 != (l_c + l_d) % 2:\n                continue\n\n            for two_J in two_J_values:\n                # Rule: Triangle constraint for the bra side.\n                if not (abs(two_j_a - two_j_b) = two_J = two_j_a + two_j_b):\n                    continue\n                \n                # Rule: Triangle constraint for the ket side.\n                if not (abs(two_j_c - two_j_d) = two_J = two_j_c + two_j_d):\n                    continue\n\n                # Rule: Fermionic antisymmetry for identical orbits in bra.\n                if is_bra_identical:\n                    # Condition for two identical fermions in state j_a coupled to J.\n                    if (two_j_a + two_j_b - two_J) % 4 != 2:\n                        continue\n                \n                # Rule: Fermionic antisymmetry for identical orbits in ket.\n                if is_ket_identical:\n                    # Condition for two identical fermions in state j_c coupled to J.\n                    if (two_j_c + two_j_d - two_J) % 4 != 2:\n                        continue\n                \n                # If all rules are satisfied, this is a valid channel.\n                N_pruned += 1\n    \n    # 5. Compute the savings fraction\n    savings = 1.0 - float(N_pruned) / float(N_naive)\n    return savings\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: single-orbital s-shell\n        [(0, 1)],\n        # Case 2: spin-orbit partners in a p-shell\n        [(1, 1), (1, 3)],\n        # Case 3: mixed pf-like space\n        [(3, 7), (1, 3), (3, 5), (1, 1)],\n        # Case 4: mixed sdg-like space\n        [(2, 5), (0, 1), (2, 3), (4, 7), (4, 9)],\n        # Case 5: larger mixed space\n        [(3, 7), (1, 3), (3, 5), (1, 1), (2, 5), (2, 3), (0, 1), (4, 9)],\n    ]\n\n    results = []\n    for case in test_cases:\n        savings = calculate_savings_fraction(case)\n        # Format the result to six decimal places.\n        results.append(f\"{savings:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3541618"}]}