{"hands_on_practices": [{"introduction": "低动量相互作用的一个主要目标是改善多体计算的收敛性，这实质上是使相互作用更具“微扰性”。温伯格（Weinberg）本征值是一个量化这种微扰性的强大工具，它定义为算符 $\\hat{V} \\hat{G}_0(E)$ 的本征值。该算符的谱半径（即模最大的本征值）直接关系到玻恩级数的收敛性：如果谱半径小于1，级数就是收敛的。这个练习 [@problem_id:3567799] 将指导你为一个简单但现实的势，在不同截断方案下计算这些本征值，从而直观地理解正则化方法如何影响相互作用的微扰特性。", "problem": "要求您对低动量相互作用进行数值研究，重点关注称为 $V_{\\text{low-}k}$ 的相互作用的微扰特性。目标是计算不同调节子选择（锐截止与平滑截止）下的 Weinberg 本征值，并检验调节子形状如何影响多重散射级数的收敛性质。\n\n从双体散射的 Lippmann–Schwinger 方程的算符形式出发，\n$$\n\\hat{T}(E) = \\hat{V} + \\hat{V} \\hat{G}_0(E) \\hat{T}(E),\n$$\n其中 $\\hat{T}(E)$ 是能量 $E$ 处的散射跃迁算符，$\\hat{G}_0(E)$ 是自由预解算符（自由空间格林函数）。Weinberg 本征值定义为算符 $\\hat{V} \\hat{G}_0(E)$ 的本征值 $\\eta$，其大小表明 Born 级数的收敛性质；具体来说，如果 $\\max |\\eta| < 1$，则该级数在该能量下是微扰的。\n\n在 S 波分波动量表象中进行计算。使用一个在动量空间中由可分离高斯形式定义的球对称中心裸相互作用，\n$$\nV_{\\text{bare}}(k,k') = -g \\exp\\!\\left(-\\frac{k^2 + k'^2}{\\beta^2}\\right),\n$$\n其中 $g > 0$ 和 $\\beta > 0$ 是常数，$k$ 和 $k'$ 是相对动量。通过将一个调节函数 $f(k)$ 应用于势的两端来模拟低动量相互作用的构建，\n$$\nV_{\\text{reg}}(k,k') = f(k) \\, V_{\\text{bare}}(k,k') \\, f(k').\n$$\n考虑以下两种调节子族：\n- 锐截止调节子：$f_{\\text{sharp}}(k; \\Lambda) = \\Theta(\\Lambda - k)$，其中 $\\Theta$ 是 Heaviside 阶跃函数，$\\Lambda$ 是动量截止。\n- 平滑截止调节子：$f_{\\text{smooth}}(k; \\Lambda, n) = \\exp\\!\\left(-\\left(\\frac{k}{\\Lambda}\\right)^{2n}\\right)$，其中 $n$ 控制衰减的平滑度。\n\n假设选取的单位使得 $\\hbar^2/(2\\mu) = 1$，其中 $\\mu$ 是约化质量，因此能量的单位是长度的平方的倒数，动量的单位是长度的倒数。所有动量必须以 $\\text{fm}^{-1}$ 为单位，能量以 $\\text{fm}^{-2}$ 为单位。在负能量 $E  0$ 处计算 Weinberg 算符，以避免自由预解算符中的奇点。\n\n将对应于 $\\hat{V} \\hat{G}_0(E)$ 的 S 波积分算符构建为一个对相对动量 $q$ 的积分，并使用适当的三维动量测度。使用数值稳定的求积方法在有限动量区间上对积分进行离散化。对于锐截止，在 $q \\in [0, \\Lambda]$ 上积分。对于平滑截止，在 $q \\in [0, k_{\\max}]$ 上积分，其中 $k_{\\max}$ 需足够大于截止值以捕获调节子的尾部。形成 Weinberg 算符的最终有限维矩阵表示，并计算其本征值。对于每个测试用例，报告谱半径，其定义为本征值的最大模。\n\n对裸相互作用和能量使用以下参数值：\n- $g = 5.0$（在所选单位下为无量纲），\n- $\\beta = 2.0 \\, \\text{fm}^{-1}$，\n- $E = -0.5 \\, \\text{fm}^{-2}$。\n\n为保证数值稳定性，使用至少 $N = 200$ 个点的 Gauss–Legendre 求积法。对于平滑调节子，设置 $k_{\\max} = 6.0 \\, \\text{fm}^{-1}$。\n\n实现以下调节子设置的测试套件：\n1. 锐截止，$\\Lambda = 2.0 \\, \\text{fm}^{-1}$。\n2. 平滑截止，$\\Lambda = 2.0 \\, \\text{fm}^{-1}$ 且 $n = 2$。\n3. 平滑截止，$\\Lambda = 2.0 \\, \\text{fm}^{-1}$ 且 $n = 8$。\n4. 锐截止，$\\Lambda = 1.2 \\, \\text{fm}^{-1}$。\n5. 平滑截止，$\\Lambda = 3.0 \\, \\text{fm}^{-1}$ 且 $n = 2$。\n\n对于每个测试用例，计算一个浮点数：在指定能量和参数下 Weinberg 算符的谱半径。将所有输出表示为无量纲浮点数。您的程序应产生单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表（例如，\"[result1,result2,result3,result4,result5]\"）。", "solution": "该问题要求计算在给定负能量 $E$ 下，对于一个给定的可分离势，Weinberg 算符 $\\hat{K}(E) = \\hat{V} \\hat{G}_0(E)$ 的谱半径。谱半径定义为 $\\hat{K}(E)$ 的本征值 $\\eta$ 的最大绝对值，它决定了散射 T 矩阵的 Born 级数展开的收敛性。\n\n出发点是 Weinberg 态的算符本征值方程：\n$$\n\\hat{V} \\hat{G}_0(E) |\\psi\\rangle = \\eta |\\psi\\rangle\n$$\n我们在 S 波（$l=0$）分波动量表象中进行计算。在此基底下，态被归一化以使完备性关系为 $\\frac{2}{\\pi}\\int_0^\\infty dk\\, k^2 |k\\rangle\\langle k| = \\hat{1}$，本征值方程变为一个积分方程：\n$$\n\\frac{2}{\\pi} \\int_0^\\infty dq\\, q^2 \\frac{V_{\\text{reg}}(k, q)}{E - q^2} \\psi(q) = \\eta \\psi(k)\n$$\n此处，$V_{\\text{reg}}(k,q)$ 是 S 波调节势矩阵元，$k$ 和 $q$ 是相对动量，我们利用了自由预解算符 $\\hat{G}_0(E) = (E - \\hat{H}_0)^{-1}$ 在此基底下是对角的这一事实，其矩阵元为 $\\langle k | \\hat{G}_0(E) | q \\rangle \\propto \\delta(k-q)/(E-k^2)$。恒定能量 $E$ 被给定为 $E = -0.5 \\, \\text{fm}^{-2}$，并且由于积分是在正实数动量 $q$ 上进行的，分母 $E-q^2$ 永不为零，从而避免了任何奇点。\n\n调节势由下式给出：\n$$\nV_{\\text{reg}}(k,k') = f(k) V_{\\text{bare}}(k,k') f(k') = -g \\cdot f(k) \\exp\\left(-\\frac{k^2 + k'^2}{\\beta^2}\\right) f(k')\n$$\n该势具有可分离形式，可以表示为 $V_{\\text{reg}}(k,q) = -v(k)v(q)$，其中函数 $v(k)$ 定义为：\n$$\nv(k) = \\sqrt{g} \\exp\\left(-\\frac{k^2}{2\\beta^2}\\right) f(k)\n$$\n将此可分离形式代入积分方程得到：\n$$\n\\frac{2}{\\pi} \\int_0^\\infty dq\\, q^2 \\frac{-v(k)v(q)}{E - q^2} \\psi(q) = \\eta \\psi(k)\n$$\n我们可以将依赖于 $k$ 的项从积分中提出来：\n$$\n-v(k) \\left[ \\frac{2}{\\pi} \\int_0^\\infty dq\\, \\frac{q^2 v(q) \\psi(q)}{E - q^2} \\right] = \\eta \\psi(k)\n$$\n方括号中的表达式是一个标量常数，我们称之为 $C$。方程变为 $\\eta \\psi(k) = -C v(k)$。这表明本征函数 $\\psi(k)$ 必须与函数 $v(k)$ 成正比，即 $\\psi(k) = A v(k)$，其中 $A$ 是某个归一化常数。将此代回方程：\n$$\n-v(k) \\left[ \\frac{2}{\\pi} \\int_0^\\infty dq\\, \\frac{q^2 v(q) (A v(q))}{E - q^2} \\right] = \\eta (A v(k))\n$$\n假设 $v(k)$ 不恒为零，我们可以消去非零公因子 $A$ 和 $v(k)$，这将问题从寻找一个无穷维算符的本征值简化为求解单个标量值 $\\eta$：\n$$\n\\eta = - \\frac{2}{\\pi} \\int_0^\\infty dq\\, \\frac{q^2 v(q)^2}{E - q^2}\n$$\n对于这种可分离势，算符 $\\hat{V}\\hat{G}_0(E)$ 是一个秩为 1 的算符，因此只拥有一个非零本征值。所以，谱半径就是这个单一本征值的模 $|\\eta|$。\n\n代入 $v(q)^2$ 的定义：\n$$\n\\eta = - \\frac{2g}{\\pi} \\int_0^\\infty dq\\, \\frac{q^2 \\exp\\left(-\\frac{2q^2}{\\beta^2}\\right) f(q)^2}{E - q^2}\n$$\n积分的上限由调节函数 $f(q)$ 有效确定。对于锐截止 $f_{\\text{sharp}}(q; \\Lambda) = \\Theta(\\Lambda - q)$，积分范围是从 $0$ 到 $\\Lambda$。对于平滑截止 $f_{\\text{smooth}}(q; \\Lambda, n)$，调节子的指数尾部会迅速抑制 $q  \\Lambda$ 时的被积函数，因此我们积分到指定的足够大的动量 $k_{\\max}$。\n\n为了对每个测试用例进行计算，我们使用含 $N=200$ 个点的 Gauss-Legendre 求积法来数值计算这个定积分。积分 $\\int_a^b F(q) dq$ 由求和 $\\sum_{i=1}^N w_i' F(q_i)$ 近似，其中 $q_i$ 和 $w_i'$ 是映射到积分区间 $[a, b]$ 上的求积点和权重。\n\n每个测试用例的步骤如下：\n1.  设置参数 $g=5.0$，$\\beta=2.0 \\, \\text{fm}^{-1}$ 和 $E=-0.5 \\, \\text{fm}^{-2}$。\n2.  确定积分区间 $[0, k_{\\text{int\\_max}}]$。对于锐截止，$k_{\\text{int\\_max}}=\\Lambda$；对于平滑截止，$k_{\\text{int\\_max}}=k_{\\max}=6.0 \\, \\text{fm}^{-1}$。\n3.  为区间 $[-1, 1]$ 生成 $N=200$ 个 Gauss-Legendre 点 $z_i$ 和权重 $w_i$。\n4.  将这些点和权重映射到积分区间 $[0, k_{\\text{int\\_max}}]$：\n    $$\n    q_i = \\frac{k_{\\text{int\\_max}}}{2}(z_i + 1), \\quad w'_i = \\frac{k_{\\text{int\\_max}}}{2}w_i\n    $$\n5.  为具体情况（锐截止或平滑截止）定义调节函数 $f(q)$。\n6.  计算本征值 $\\eta$ 的求和：\n    $$\n    \\eta \\approx - \\frac{2g}{\\pi} \\sum_{i=1}^N w'_i \\frac{q_i^2 \\exp\\left(-\\frac{2q_i^2}{\\beta^2}\\right) f(q_i)^2}{E - q_i^2}\n    $$\n7.  谱半径为 $|\\eta|$，因为分母 $E-q_i^2$ 总是负的，而被积函数中的所有其他因子都是正的，这使得 $\\eta$ 是一个正实数。\n对五个指定的参数集中的每一个都实现了此算法。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import roots_legendre\n\ndef solve():\n    \"\"\"\n    Main solver function to compute the spectral radius for a series of test cases.\n    \"\"\"\n\n    test_cases = [\n        {'type': 'sharp', 'Lambda': 2.0},\n        {'type': 'smooth', 'Lambda': 2.0, 'n': 2},\n        {'type': 'smooth', 'Lambda': 2.0, 'n': 8},\n        {'type': 'sharp', 'Lambda': 1.2},\n        {'type': 'smooth', 'Lambda': 3.0, 'n': 2},\n    ]\n\n    results = []\n    for params in test_cases:\n        radius = compute_spectral_radius(**params)\n        results.append(f\"{radius:.10f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\ndef compute_spectral_radius(type, Lambda, n=None):\n    \"\"\"\n    Computes the spectral radius of the Weinberg operator for given parameters.\n\n    The problem simplifies to calculating a single non-zero eigenvalue for a\n    rank-one operator derived from a separable potential. The spectral radius\n    is the magnitude of this eigenvalue.\n\n    Args:\n        type (str): The regulator type, 'sharp' or 'smooth'.\n        Lambda (float): The momentum cutoff in fm^-1.\n        n (int, optional): The exponent for the smooth regulator. Defaults to None.\n\n    Returns:\n        float: The spectral radius (dimensionless).\n    \"\"\"\n    # --- Physical and Numerical Parameters ---\n    g_bare = 5.0  # Dimensionless strength parameter\n    beta = 2.0    # Momentum scale in fm^-1\n    energy = -0.5 # Scattering energy in fm^-2\n    \n    num_points = 200 # Number of quadrature points\n    k_max_smooth = 6.0 # Integration limit for smooth regulators in fm^-1\n\n    # --- Setup Integration Mesh using Gauss-Legendre Quadrature ---\n    if type == 'sharp':\n        k_int_max = Lambda\n    elif type == 'smooth':\n        k_int_max = k_max_smooth\n    else:\n        raise ValueError(\"Invalid regulator type specified.\")\n\n    # Get standard Gauss-Legendre roots and weights for the interval [-1, 1]\n    roots, weights = roots_legendre(num_points)\n\n    # Map points and weights to the integration interval [0, k_int_max]\n    q_points = 0.5 * k_int_max * (roots + 1.0)\n    q_weights = 0.5 * k_int_max * weights\n\n    # --- Define Regulator Function f(q)^2 ---\n    if type == 'sharp':\n        # For a sharp cutoff, integration is from 0 to Lambda, and f(q)=1\n        # within this range. So f(q)^2 is effectively 1.\n        f_squared = 1.0\n    else: # 'smooth'\n        # f(q) = exp(-(q/Lambda)^(2n))\n        # f(q)^2 = exp(-2 * (q/Lambda)^(2n))\n        f_squared = np.exp(-2.0 * (q_points / Lambda)**(2 * n))\n        \n    # --- Define Integrand ---\n    # The integrand for the eigenvalue eta, from the formula:\n    # eta = - (2g/pi) * integral{ dq q^2 * exp(-2q^2/beta^2) * f(q)^2 / (E-q^2) }\n    \n    numerator = q_points**2 * np.exp(-2.0 * q_points**2 / beta**2) * f_squared\n    denominator = energy - q_points**2\n    \n    integrand = numerator / denominator\n    \n    # --- Calculate the Integral ---\n    integral_val = np.sum(q_weights * integrand)\n    \n    # --- Calculate the Eigenvalue eta ---\n    eta = - (2.0 * g_bare / np.pi) * integral_val\n    \n    # The spectral radius is the magnitude of the single non-zero eigenvalue.\n    # Since E  0, the denominator (E - q^2) is always negative.\n    # All other terms in the integral are positive, so the integral is negative.\n    # This makes eta = - (const) * (negative value) always positive.\n    # Therefore, the spectral radius is simply eta.\n    spectral_radius = eta\n    \n    return spectral_radius\n\nsolve()\n```", "id": "3567799"}, {"introduction": "在学会了如何量化微扰性之后，我们现在来探究实现这一目标的具体机制。本练习 [@problem_id:3567822] 采用一个简化的二能级系统，这是物理学中为获得解析性洞察而常用的一种技巧。通过这个“玩具模型”，你将能明确地看到 $V_{\\text{low-}k}$ （通过Lee-Suzuki解耦）和相似性重整化群（SRG）这两种方法，是如何系统性地压低低动量与高动量态之间的耦合，从而增强低动量哈密顿量的微扰性质。", "problem": "考虑一个用于描述核子-核子分波中相对运动的双能级模型，该模型包含一个低动量态 $\\lvert \\ell \\rangle$ 和一个高动量态 $\\lvert h \\rangle$。相对动能算符 $T$ 在此基下是对角的，其本征值为 $e_{\\ell}$ 和 $e_{h}$。设 $e_{\\ell} = 0\\,\\text{MeV}$ 且 $e_{h} = \\Delta = 200\\,\\text{MeV}$。在此基下的初始（裸）相互作用 $V(s=0)$ 为\n$$\nV(0) = \\begin{pmatrix}\nV_{\\ell \\ell}  V_{\\ell h} \\\\\nV_{h \\ell}  V_{h h}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n-20\\,\\text{MeV}  -60\\,\\text{MeV} \\\\\n-60\\,\\text{MeV}  0\\,\\text{MeV}\n\\end{pmatrix},\n$$\n因此，完整的裸哈密顿量为 $H(0) = T + V(0)$。\n\n你将需要构建一个低动量有效相互作用 $V_{\\text{low-}k}$ 和一个通过相似性重整化群（SRG）演化得到的相互作用，然后量化非对角压制及其对低动量态微扰收敛性的影响。\n\n仅从以下基础要素出发：\n- 不含时薛定谔方程 $H \\lvert \\Psi \\rangle = E \\lvert \\Psi \\rangle$ 以及能够复现选定精确本征值的模型空间有效哈密顿量的定义。\n- 哈密顿量 $H(s)$ 在生成元 $G = T$ 下的 SRG 流动方程，\n$$\n\\frac{d H(s)}{d s} = \\big[ \\eta(s), H(s) \\big], \\quad \\eta(s) \\equiv [G, H(s)] = [T, H(s)],\n$$\n以及标准的对易子算符代数。\n- 以 $V$ 为微扰，对 $T$ 的基态进行求解的非简并瑞利-薛定谔微扰理论，直到二阶。\n\n按以下步骤进行，并展示基于这些基础的推导过程：\n\n(a) 定义投影算符 $P = \\lvert \\ell \\rangle \\langle \\ell \\rvert$ 和互补投影算符 $Q = \\lvert h \\rangle \\langle h \\rvert$。使用选取 $H(0)$ 的最低精确本征值的一维 $P$ 空间 Lee–Suzuki 去耦合构造，构建能量无关的 $P$ 空间有效哈密顿量 $H_{\\text{eff}} = e_{\\ell} + V_{\\text{low-}k}$，使其唯一的本征值等于 $H(0)$ 的精确基态本征值。给出标量 $V_{\\text{low-}k}$ 的具体表达式。\n\n(b) 使用生成元 $G = T$ 通过 SRG 演化 $H(s)$。通过计算 SRG 方程所蕴含的双对易子结构，推导 $V_{12}(s) \\equiv \\langle \\ell \\rvert V(s) \\lvert h \\rangle$ 和 $V_{11}(s) \\equiv \\langle \\ell \\rvert V(s) \\lvert \\ell \\rangle$ 关于 $e_{\\ell}$、$e_{h}$ 和 $V(s)$ 的矩阵元流动方程。在 $\\lvert V_{ii}(s) \\rvert \\ll \\Delta$ 的情况下，证明以下领头阶近似的合理性：\n$$\nV_{12}(s) \\approx V_{12}(0)\\,\\exp\\!\\big(-\\Delta^{2} s\\big), \\quad\nV_{11}(s) \\approx V_{11}(0) - \\frac{\\lvert V_{12}(0) \\rvert^{2}}{\\Delta}\\,\\Big(1 - \\exp\\!\\big(-2 \\Delta^{2} s\\big)\\Big).\n$$\n使用这些近似，找出将非对角元的大小减小10倍的 SRG 流动参数 $s^{\\star}$（单位为 $\\text{MeV}^{-2}$），即 $\\lvert V_{12}(s^{\\star}) \\rvert = \\lvert V_{12}(0) \\rvert / 10$。然后计算 $V_{11}(s^{\\star})$ 的值（单位为 $\\text{MeV}$）。\n\n(c) 将 $V(s)$ 视为对 $T$ 的微扰，写出在任意 $s$ 下低动量态的一阶和二阶能量修正，然后将其应用于 $s^{\\star}$ 的情况。计算比值\n$$\nr_{\\text{SRG}}(s^{\\star}) \\equiv \\left| \\frac{\\delta E^{(2)}(s^{\\star})}{\\delta E^{(1)}(s^{\\star})} \\right|\n$$\n作为一个纯数。将你得到的 $r_{\\text{SRG}}(s^{\\star})$ 最终答案四舍五入至四位有效数字，并以小数形式表示（无单位）。此比值即为最终所求答案。", "solution": "问题陈述是自洽的，其科学基础根植于量子力学和核有效场论的原理，且提法明确。所有提供的数据都是一致的，足以得到唯一解。我们开始进行推导。\n\n完整的裸哈密顿量 $H(0) = T + V(0)$ 在基 $\\{ \\lvert \\ell \\rangle, \\lvert h \\rangle \\}$ 下由以下矩阵给出：\n$$\nH(0) = \\begin{pmatrix} e_{\\ell}  0 \\\\ 0  e_{h} \\end{pmatrix} + \\begin{pmatrix} V_{\\ell \\ell}  V_{\\ell h} \\\\ V_{h \\ell}  V_{h h} \\end{pmatrix} = \\begin{pmatrix} 0\\,\\text{MeV}  0 \\\\ 0  200\\,\\text{MeV} \\end{pmatrix} + \\begin{pmatrix} -20\\,\\text{MeV}  -60\\,\\text{MeV} \\\\ -60\\,\\text{MeV}  0\\,\\text{MeV} \\end{pmatrix} = \\begin{pmatrix} -20  -60 \\\\ -60  200 \\end{pmatrix}\\,\\text{MeV}.\n$$\n\n(a) 为了构建低动量有效相互作用 $V_{\\text{low-}k}$，我们首先通过求解特征方程 $\\det(H(0) - E\\mathbf{I}) = 0$ 来求出 $H(0)$ 的精确本征值 $E$。\n$$\n\\det \\begin{pmatrix} -20 - E  -60 \\\\ -60  200 - E \\end{pmatrix} = 0\n$$\n$$\n(-20 - E)(200 - E) - (-60)^2 = 0\n$$\n$$\n-4000 + 20E - 200E + E^2 - 3600 = 0\n$$\n$$\nE^2 - 180E - 7600 = 0\n$$\n使用二次方程求根公式 $E = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$，本征值为：\n$$\nE = \\frac{180 \\pm \\sqrt{(-180)^2 - 4(1)(-7600)}}{2} = \\frac{180 \\pm \\sqrt{32400 + 30400}}{2} = \\frac{180 \\pm \\sqrt{62800}}{2} = 90 \\pm 10\\sqrt{157}.\n$$\n题目规定，有效哈密顿量必须能复现 $H(0)$ 的最低精确本征值，即基态能量 $E_0$：\n$$\nE_0 = 90 - 10\\sqrt{157}\\,\\text{MeV}.\n$$\n一维 $P$ 空间中的有效哈密顿量 $H_{\\text{eff}}$ 定义为 $H_{\\text{eff}} = e_{\\ell} + V_{\\text{low-}k}$。由于这是一个 $1 \\times 1$ 的矩阵（一个标量），其本征值就是它自身的值。根据定义，该本征值必须等于 $E_0$。\n$$\nH_{\\text{eff}} = E_0\n$$\n给定 $e_{\\ell} = 0$，我们有：\n$$\n0 + V_{\\text{low-}k} = E_0\n$$\n因此，标量形式的低动量相互作用等于精确的基态能量。\n$$\nV_{\\text{low-}k} = 90 - 10\\sqrt{157}\\,\\text{MeV}.\n$$\n\n(b) 我们推导势矩阵元的 SRG 流动方程。SRG 方程为 $\\frac{dH(s)}{ds} = [\\eta(s), H(s)]$，其中生成元为 $\\eta(s) = [T, H(s)]$。由于 $T$ 是常数，因此有 $\\frac{dH(s)}{ds} = \\frac{dV(s)}{ds}$。\n设 $H(s) = T + V(s)$，其中 $T = \\text{diag}(e_{\\ell}, e_{h})$ 且 $V(s) = \\begin{pmatrix} V_{11}(s)  V_{12}(s) \\\\ V_{21}(s)  V_{22}(s) \\end{pmatrix}$。令 $\\Delta = e_{h} - e_{\\ell}$。生成元为：\n$$\n\\eta(s) = [T, V(s)] = \\begin{pmatrix} 0  (e_{\\ell}-e_{h})V_{12}(s) \\\\ (e_{h}-e_{\\ell})V_{21}(s)  0 \\end{pmatrix} = \\begin{pmatrix} 0  -\\Delta V_{12}(s) \\\\ \\Delta V_{21}(s)  0 \\end{pmatrix}.\n$$\n流动方程变为 $\\frac{dH(s)}{ds} = [\\eta(s), H(s)] = [\\eta(s), T+V(s)]$。\n$$\n\\frac{dH(s)}{ds} = \\begin{pmatrix} -2\\Delta V_{12}(s)V_{21}(s)  -\\Delta V_{12}(s)(\\Delta + V_{22}(s)-V_{11}(s)) \\\\ -\\Delta V_{21}(s)(\\Delta + V_{22}(s)-V_{11}(s))  2\\Delta V_{12}(s)V_{21}(s) \\end{pmatrix}.\n$$\n这给出了势矩阵元的流动方程（其中 $V_{12}=V_{21}$）：\n$$\n\\frac{dV_{11}(s)}{ds} = -2\\Delta |V_{12}(s)|^2, \\quad \\frac{dV_{12}(s)}{ds} = -(\\Delta + V_{22}(s) - V_{11}(s))\\Delta V_{12}(s).\n$$\n在 $|V_{ii}(s)| \\ll \\Delta$ 的情况下，$V_{12}(s)$ 的方程简化为：\n$$\n\\frac{dV_{12}(s)}{ds} \\approx -\\Delta^2 V_{12}(s).\n$$\n这个一阶线性微分方程的解为 $V_{12}(s) = V_{12}(0)\\exp(-\\Delta^2 s)$，这证明了第一个近似的合理性。\n将此结果代入 $V_{11}(s)$ 的流动方程：\n$$\n\\frac{dV_{11}(s)}{ds} = -2\\Delta |V_{12}(0)\\exp(-\\Delta^2 s)|^2 = -2\\Delta|V_{12}(0)|^2 \\exp(-2\\Delta^2 s).\n$$\n从 $s=0$ 积分到 $s$：\n$$\n\\int_0^s \\frac{dV_{11}(s')}{ds'} ds' = V_{11}(s) - V_{11}(0) = -2\\Delta|V_{12}(0)|^2 \\int_0^s \\exp(-2\\Delta^2 s') ds'.\n$$\n$$\nV_{11}(s) - V_{11}(0) = -2\\Delta|V_{12}(0)|^2 \\left[ \\frac{\\exp(-2\\Delta^2 s')}{-2\\Delta^2} \\right]_0^s = \\frac{|V_{12}(0)|^2}{\\Delta} \\left( \\exp(-2\\Delta^2 s) - 1 \\right).\n$$\n$$\nV_{11}(s) \\approx V_{11}(0) - \\frac{|V_{12}(0)|^2}{\\Delta} \\left( 1 - \\exp(-2\\Delta^2 s) \\right).\n$$\n这证明了第二个近似的合理性。\n现在，我们求满足 $|V_{12}(s^{\\star})| = |V_{12}(0)|/10$ 的 $s^{\\star}$：\n$$\n|V_{12}(0)| \\exp(-\\Delta^2 s^{\\star}) = \\frac{|V_{12}(0)|}{10} \\implies \\exp(-\\Delta^2 s^{\\star}) = \\frac{1}{10}.\n$$\n$$\n-\\Delta^2 s^{\\star} = \\ln(1/10) = -\\ln(10) \\implies s^{\\star} = \\frac{\\ln(10)}{\\Delta^2}.\n$$\n当 $\\Delta = 200\\,\\text{MeV}$ 时，$s^{\\star} = \\frac{\\ln(10)}{200^2} = \\frac{\\ln(10)}{40000}\\,\\text{MeV}^{-2}$。\n接下来，我们计算 $V_{11}(s^{\\star})$：\n$$\n\\exp(-2\\Delta^2 s^{\\star}) = \\left(\\exp(-\\Delta^2 s^{\\star})\\right)^2 = \\left(\\frac{1}{10}\\right)^2 = \\frac{1}{100}.\n$$\n使用 $V_{11}(0) = -20\\,\\text{MeV}$， $|V_{12}(0)|^2 = (-60\\,\\text{MeV})^2 = 3600\\,\\text{MeV}^2$ 以及 $\\Delta = 200\\,\\text{MeV}$：\n$$\nV_{11}(s^{\\star}) = -20 - \\frac{3600}{200} \\left( 1 - \\frac{1}{100} \\right) = -20 - 18 \\left( \\frac{99}{100} \\right) = -20 - 17.82 = -37.82\\,\\text{MeV}.\n$$\n\n(c) 使用非简并瑞利-薛定谔微扰理论，其中 $H_0 = T$ 且微扰为 $V(s)$，低动量态 $|\\ell\\rangle$ 的能量修正为：\n一阶修正：\n$$\n\\delta E^{(1)}(s) = \\langle \\ell | V(s) | \\ell \\rangle = V_{11}(s).\n$$\n二阶修正：\n$$\n\\delta E^{(2)}(s) = \\frac{|\\langle \\ell | V(s) | h \\rangle|^2}{e_{\\ell} - e_{h}} = \\frac{|V_{12}(s)|^2}{-\\Delta}.\n$$\n比值 $r_{\\text{SRG}}(s^{\\star})$ 为：\n$$\nr_{\\text{SRG}}(s^{\\star}) = \\left| \\frac{\\delta E^{(2)}(s^{\\star})}{\\delta E^{(1)}(s^{\\star})} \\right| = \\left| \\frac{-|V_{12}(s^{\\star})|^2/\\Delta}{V_{11}(s^{\\star})} \\right| = \\frac{|V_{12}(s^{\\star})|^2}{\\Delta |V_{11}(s^{\\star})|}.\n$$\n我们在 $s=s^{\\star}$ 处有所需的值：\n$V_{11}(s^{\\star}) = -37.82\\,\\text{MeV}$。\n$|V_{12}(s^{\\star})| = |V_{12}(0)|/10 = 60/10 = 6\\,\\text{MeV}$。\n$\\Delta = 200\\,\\text{MeV}$。\n代入这些值：\n$$\nr_{\\text{SRG}}(s^{\\star}) = \\frac{(6)^2}{200 \\cdot |-37.82|} = \\frac{36}{200 \\cdot 37.82} = \\frac{36}{7564}.\n$$\n$$\nr_{\\text{SRG}}(s^{\\star}) \\approx 0.004759386...\n$$\n四舍五入到四位有效数字，结果为 $0.004759$。", "answer": "$$\\boxed{0.004759}$$", "id": "3567822"}, {"introduction": "将理论转化为精确的数值结果，需要对计算中的数学细节进行审慎处理。作为构建 $V_{\\text{low-}k}$ 核心的李普曼-施温格方程（Lippmann-Schwinger Equation）包含一个奇异且在数值上具有挑战性的柯西主值积分。本练习 [@problem_id:3567808] 聚焦于这一关键的实现细节，通过评估不同的求积策略，展示一种被称为“奇点减除”（singularity subtraction）的技术如何确保稳定、精确和高阶的收敛性。掌握这种技术对于该领域任何严肃的计算工作都是至关重要的。", "problem": "为了复现低能散射可观测量，我们通过在动量截断 $\\Lambda$ 以下保持半在壳反应矩阵 $K$ 不变来构造一个低动量相互作用 $V_{\\text{low-}k}$。在单个分波中，对于约化质量为 $\\mu$ 的体系，在壳能量为 $E = k^2/(2\\mu)$ 时，反应矩阵（通过实数的主值积分定义）的半在壳 Lippmann–Schwinger 方程 (LSE) 写为\n$$\nK(k,k';E) = V(k,k') + \\frac{2}{\\pi} \\int_{0}^{\\Lambda} q^2 \\, dq \\, V(k,q) \\, \\mathcal{P}\\!\\left[\\frac{1}{E - q^2/(2\\mu)}\\right] K(q,k';E).\n$$\n等价地，在代入 $E = k^2/(2\\mu)$ 并将常数吸收到积分核中后，其奇异结构表现为\n$$\n\\int_{0}^{\\Lambda} dq \\, \\frac{F(q)}{k^2 - q^2},\n$$\n其中 $F(q)$ 表示一个包含 $q^2$、相互作用矩阵元和反应矩阵的光滑函数。在有限网格计算中，$q = k$ 附近的 Cauchy 主值积分中不受控制的误差会破坏相移和低能散射可观测量的不变性，而这正是 $V_{\\text{low-}k}$ 的定义性要求。\n\n你的任务是选择一种动量离散化和求积策略，当在 $q \\in [0,\\Lambda]$ 的有限网格上实现时，能够通过以下方式控制构造 $V_{\\text{low-}k}$ 过程中的主值积分误差：\n- 在 $q = k$ 处存在内部奇点的情况下，确保数值的稳定性和准确性；\n- 对光滑函数 $F(q)$ 实现高阶收敛；\n- 避免引入依赖于截断或网格的人为效应的临时正则化方法。\n\n哪个选项最好地概述了这样一种方案？\n\nA. 通过仿射映射 $q = \\Lambda\\,(1+x)/2$（其中 $x \\in [-1,1]$ 是 Gauss–Legendre 节点），对 $q \\in [0,\\Lambda]$ 使用 Gauss–Legendre 网格。对于每个外部动量 $k$，构造 $F(q) = q^2 V(k,q) K(q,k';E)$ 并分解\n$$\n\\mathcal{P}\\!\\int_{0}^{\\Lambda} dq \\, \\frac{F(q)}{k^2 - q^2} = \\int_{0}^{\\Lambda} dq \\, \\frac{F(q) - F(k)}{k^2 - q^2} + F(k) \\, \\mathcal{P}\\!\\int_{0}^{\\Lambda} dq \\, \\frac{1}{k^2 - q^2}.\n$$\n使用标准 Gauss–Legendre 求积法计算第一项（由于 $F(q)-F(k)$ 在 $q=k$ 处为零，被积函数在该点是正则的），并解析地计算第二项以获得主值的正确有限贡献。如果 $k$ 不是网格节点，则通过与网格一致的高阶插值（例如，三次样条插值）来计算 $F(k)$。这种方法无需临时的正则化方法即可控制奇点，并能得到高阶精度。\n\nB. 在 $[0,\\Lambda]$ 上使用均匀网格和梯形法则。通过省略最接近 $q=k$ 的网格点来实现主值计算；通过对被省略节点两侧两点的贡献进行平均来近似对称极限。这种方法无需任何特殊处理即可避免发散，且易于实现。\n\nC. 用一个小的虚部规定 $k \\rightarrow k + i\\epsilon$ 来替换主值，计算\n$$\n\\int_{0}^{\\Lambda} dq \\, \\frac{F(q)}{(k + i\\epsilon)^2 - q^2},\n$$\n并在极限 $\\epsilon \\rightarrow 0$ 下取其实部。在有限网格上，选择与网格间距成正比的 $\\epsilon$ 来平衡稳定性和准确性。\n\nD. 进行映射 $p = q^2$，使积分核变为 $1/(k^2 - p)$。在 $p \\in [0,\\Lambda^2]$ 中放置 Chebyshev 节点，并对 Cauchy 核 $1/(p - k^2)$ 使用离散 Hilbert 变换权重，从而无需任何减法项或解析项即可直接近似主值积分。雅可比因子 $dq = dp/(2q)$ 在节点处被视为一个权重因子。\n\nE. 在 $[0,\\Lambda]$ 上应用 tanh–sinh 求积法，并在端点附近加密节点以处理可能的端点行为；对于 $q=k$ 处的内部奇点，在 $k$ 点分割积分，并在每个子区间上使用相同的 tanh–sinh 法则，依赖于误差的抵消来实现主值，而无需特殊修正。\n\n选择唯一的最佳选项。", "solution": "用户要求对一个计算核物理问题进行批判性评估，并提供随后的详细解决方案。该过程始于对问题陈述的严格验证。\n\n### 步骤1：提取已知条件\n- **任务**：为评估在构造低动量相互作用 $V_{\\text{low-}k}$ 中出现的主值积分，选择一种动量离散化和求积策略。\n- **控制方程**：反应矩阵 $K$ 的半在壳 Lippmann–Schwinger 方程 (LSE) 如下所示：\n$$\nK(k,k';E) = V(k,k') + \\frac{2}{\\pi} \\int_{0}^{\\Lambda} q^2 \\, dq \\, V(k,q) \\, \\mathcal{P}\\!\\left[\\frac{1}{E - q^2/(2\\mu)}\\right] K(q,k';E).\n$$\n- **能量条件**：在壳能量为 $E = k^2/(2\\mu)$。\n- **积分结构**：积分的奇异部分具有以下形式：\n$$\n\\int_{0}^{\\Lambda} dq \\, \\frac{F(q)}{k^2 - q^2},\n$$\n其中 $F(q)$ 是一个光滑函数，$\\mathcal{P}$ 表示 Cauchy 主值。奇点位于 $q=k$。\n- **方法所需标准**：\n    1.  在存在内部奇点的情况下具有数值稳定性和准确性。\n    2.  对于光滑函数 $F(q)$ 具有高阶收敛性。\n    3.  避免引入人为效应的临时正则化方法。\n\n### 步骤2：使用提取的已知条件进行验证\n1.  **有科学依据**：该问题在计算核物理领域有坚实的基础。Lippmann-Schwinger 方程、反应矩阵（K-矩阵）以及低动量有效相互作用 ($V_{\\text{low-}k}$) 的概念都是标准课题。评估主值积分的数值挑战是求解此类方程时一个真实且重要的方面。所呈现的物理和数学内容是正确的。\n2.  **适定的**：该问题是适定的。它要求根据一组明确的性能标准（准确性、收敛阶、稳定性、避免人为效应）从选项列表中确定最佳的数值方法。这是数值分析应用于物理学中的一个标准问题。\n3.  **客观的**：问题以精确、技术性的语言陈述，没有主观性。判断“最佳”选项的标准是衡量数值算法质量的客观度量。\n\n问题陈述内部一致、科学上合理且客观。它没有违反任何指定的无效标准。LSE 表示法中的潜在歧义（同时使用 $k$ 表示能量参数和离壳动量）并未使核心任务失效，该任务是关于良定义积分形式 $\\int dq \\, F(q)/(k^2 - q^2)$ 的数值处理。\n\n### 步骤3：结论与行动\n问题陈述是**有效的**。将通过分析用于计算 Cauchy 主值积分的所提议数值方法来推导解决方案。\n\n### 推导与选项分析\n\n问题的核心是 Cauchy 主值积分的数值评估：\n$$ I(k) = \\mathcal{P} \\int_{0}^{\\Lambda} dq \\, \\frac{F(q)}{k^2 - q^2} $$\n对于 $k \\in (0, \\Lambda)$，其中 $F(q)$ 是一个光滑函数。主值由奇点 $q=k$ 周围的对称极限定义：\n$$ I(k) = \\lim_{\\epsilon \\to 0^+} \\left( \\int_{0}^{k-\\epsilon} dq \\, \\frac{F(q)}{k^2 - q^2} + \\int_{k+\\epsilon}^{\\Lambda} dq \\, \\frac{F(q)}{k^2 - q^2} \\right) $$\n一种针对此积分的数值稳健且高精度的方法是“奇点减去”技术。我们通过加减一个具有相同奇异行为但可以解析积分的项来重写被积函数。一种标准做法是：\n$$ I(k) = \\mathcal{P} \\int_{0}^{\\Lambda} dq \\, \\frac{F(q)}{k^2 - q^2} = \\int_{0}^{\\Lambda} dq \\, \\frac{F(q) - F(k)}{k^2 - q^2} + F(k) \\, \\mathcal{P} \\int_{0}^{\\Lambda} dq \\, \\frac{1}{k^2 - q^2} $$\n这个恒等式是精确的。我们来分析右边的两项：\n1.  **第一个积分**：$\\int_{0}^{\\Lambda} dq \\, \\frac{F(q) - F(k)}{k^2 - q^2}$。由于 $F(q)$ 是光滑的，当 $q \\to k$ 时，分子 $F(q) - F(k)$ 趋近于 $0$。根据 L'Hôpital's Rule，当 $q \\to k$ 时，被积函数的极限是 $\\lim_{q\\to k} \\frac{F'(q)}{-2q} = \\frac{-F'(k)}{2k}$，这是一个有限值（对于 $k \\neq 0$）。因此，被积函数在整个区间 $[0, \\Lambda]$ 上是一个正则的光滑函数。这个积分可以使用适用于光滑函数的标准求积法则（例如 Gauss-Legendre 求积法）高精度地计算。\n2.  **第二个积分**：$F(k) \\, \\mathcal{P} \\int_{0}^{\\Lambda} dq \\, \\frac{1}{k^2 - q^2}$。这是极点的解析贡献。该积分可以解析求解：\n    $$ \\mathcal{P} \\int_{0}^{\\Lambda} \\frac{1}{k^2-q^2} dq = \\frac{1}{2k} \\ln\\left(\\frac{\\Lambda+k}{\\Lambda-k}\\right) $$\n完整的计算包括数值计算第一个积分，并加上第二个解析计算的项。这种方法将一个奇异问题转化为一个非奇异问题，是数值稳定的，避免了临时的参数，并且如果对正则化后的积分使用合适的求积法则，可以实现高阶收敛。\n\n现在，我们基于这一理解来评估每个选项。\n\n**A. 使用 Gauss–Legendre 网格...分解...使用标准 Gauss–Legendre 求积法计算第一项...并解析地计算第二项...**\n这个选项完美地描述了上面详述的奇点减去法。它正确地指出第一项变为正则项，适合于高阶 Gauss-Legendre 求积法。它正确地提议解析地计算第二项，该项捕捉了主值贡献。它还务实地解决了当 $k$ 不是网格点时需要通过高阶插值来计算 $F(k)$ 的问题，这对于保持精度至关重要。该方法满足所有要求：稳定、准确、高阶，并且避免了临时的正则化。\n**结论：正确。**\n\n**B. 使用均匀网格...和梯形法则。通过省略最接近 $q=k$ 的网格点来实现主值计算...**\n这种方法是一种低阶近似。梯形法则的误差为 $O(h^2)$，其中 $h$ 是网格间距，这不被认为是高阶的。更关键的是，简单地省略极点附近的一个点（或一个区间）是一个不对称的、临时的程序，它不能正确地近似 Cauchy 主值定义所要求的对称极限。这会引入一个大的、依赖于网格的误差，不满足准确性、高阶收敛和避免人为效应的要求。\n**结论：不正确。**\n\n**C. 用一个小的虚部规定 $k \\rightarrow k + i\\epsilon$ 替换主值...选择与网格间距成正比的 $\\epsilon$...**\n这种方法依赖于 Sokhotski–Plemelj 定理。虽然在 $\\epsilon \\to 0$ 时形式上是正确的，但任何数值实现都需要一个有限的 $\\epsilon$。结果对 $\\epsilon$ 的选择变得敏感。如果 $\\epsilon$ 太大，积分核会被人为地展宽。如果 $\\epsilon$ 相对于网格间距太小，急剧峰化的被积函数就无法被很好地分辨。将 $\\epsilon$ 设为与网格间距成正比，恰恰是问题陈述明确要求避免的那种“引入依赖于截断或网格的人为效应”的“临时正则化”。这种方法劣于选项 A 中的精确处理方法。\n**结论：不正确。**\n\n**D. 进行映射 $p = q^2$...放置 Chebyshev 节点并使用离散 Hilbert 变换权重...**\n这描述了一种有效且复杂的计算主值积分的方法。通过变量替换 $p=q^2$，积分核变成了标准的 Cauchy 核 $1/(p-k^2)$。存在针对此的专门求积法则，通常使用 Chebyshev 多项式和特殊权重。然而，变量替换引入了一个雅可比因子 $dq = dp/(2q) = dp/(2\\sqrt{p})$，这在端点 $p=0$ 处产生了一个 $p^{-1/2}$ 形式的可积奇点。标准的 Chebyshev 方法是为光滑函数设计的；这个端点奇点需要特殊处理（例如，Gauss-Jacobi 求积法）以保持高阶精度。选项 A 的方法更直接，因为它在不引入额外端点奇点的情况下对被积函数进行正则化，因此可以说它更稳健、更直接易于实现。\n**结论：不正确。**（被认为不如 A 合适）\n\n**E. 应用 tanh–sinh 求积法...在 $k$ 点分割积分，并在每个子区间上使用相同的 tanh–sinh 法则...**\n这代表了对主值积分的根本性误解。在奇点处分割积分，如 $\\int_0^k + \\int_k^\\Lambda$，会产生两个各自发散的积分。对一个发散的积分应用任何数值求积法，即使是像 tanh-sinh 这样强大的方法，也不会产生有意义的结果。认为误差会简单地“抵消”是错误的；数值结果将主要取决于最接近奇点的求积点是如何处理的，并且不会收敛到正确的主值。这种方法数值上不稳定且数学上不合理。\n**结论：不正确。**\n\n### 结论\n选项 A 提供了满足所有指定标准的最准确、最稳定和理论上最合理的方法。它是数值处理 Cauchy 主值积分的一种标准的、教科书式的方法。", "answer": "$$\\boxed{A}$$", "id": "3567808"}]}