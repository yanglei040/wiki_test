{"hands_on_practices": [{"introduction": "拟蒙特卡罗方法依赖于比随机数更均匀地填充积分域的低差异序列。第一个练习将通过最经典的构造之一——Halton序列，提供动手实践。通过手动生成二维Halton序列的初始点，并用它们来完成一个简单的积分任务，您将对这些确定性点如何形成以及为何其结构有利于数值积分建立具体理解[@problem_id:3313764]。", "problem": "在用于拟蒙特卡洛（QMC）方法的确定性低差异序列的背景下，考虑由根反函数构造的二维 Halton 序列。以 $b$ 为底的根反函数，记为 $\\phi_{b}(n)$，其定义为：将正整数 $n$ 写成 $b$ 进制形式 $n = \\sum_{k=0}^{m} a_{k} b^{k}$，其中数字 $a_{k} \\in \\{0,1,\\dots,b-1\\}$，然后反转数字得到 $\\phi_{b}(n) = \\sum_{k=0}^{m} a_{k} b^{-(k+1)}$。基为互质数 $b_{1}=2$ 和 $b_{2}=3$ 的二维 Halton 序列由点 $\\big(\\phi_{2}(n), \\phi_{3}(n)\\big)$ 给出，其中 $n \\in \\mathbb{N}$。\n\n任务：\n1. 仅使用上述定义，明确构造基为 $b_{1}=2$ 和 $b_{2}=3$ 的二维 Halton 序列的前 10 个点。\n2. 基于均匀分布和差异度的基本概念，识别并论证这 10 个点中至少两种与 $[0,1]^{2}$ 上数值积分相关的可见结构模式，例如均匀覆盖、避免聚集或一维投影的规律性。您的讨论必须基于所构造点的定义和可观察属性，而非启发式论断。\n3. 设函数 $f:[0,1]^{2} \\to \\mathbb{R}$ 定义为 $f(x,y) = x y$。使用构造出的 10 个 Halton 点，为积分 $I = \\int_{0}^{1} \\int_{0}^{1} x y \\, dx \\, dy$ 构建 QMC 估计量 $\\widehat{I}_{10} = \\frac{1}{10} \\sum_{n=1}^{10} f\\big(\\phi_{2}(n), \\phi_{3}(n)\\big)$。以精确有理数的形式给出绝对误差 $|\\widehat{I}_{10} - I|$。\n\n最终答案必须是单个以精确有理数形式给出的实数值。无需四舍五入。", "solution": "问题陈述经验证具有科学依据、适定且客观。它提供了 Halton 序列的正确和标准定义，并基于此定义提出了一系列清晰、可回答的任务。所有必要的数据和定义都是自洽且一致的。\n\n解答按照问题陈述的要求分为三个部分。\n\n### 第 1 部分：Halton 序列点的构造\n\n二维 Halton 序列由点 $\\big(\\phi_{b_{1}}(n), \\phi_{b_{2}}(n)\\big)$ 构成，其中 $n \\in \\mathbb{N}$，基 $b_{1}=2$ 和 $b_{2}=3$ 互质。根反函数 $\\phi_{b}(n)$ 的计算方法是：将 $n$ 写成 $b$ 进制形式 $n = \\sum_{k=0}^{m} a_{k} b^{k}$，然后围绕小数点反转数字，形成分数 $\\phi_{b}(n) = \\sum_{k=0}^{m} a_{k} b^{-(k+1)}$。我们计算该序列当 $n=1, 2, \\ldots, 10$ 时的前 10 个点。\n\n下表详细说明了每个 $n$ 值的构造过程：\n| $n$ | $n$ 的二进制表示 | $\\phi_{2}(n)$ | $n$ 的三进制表示 | $\\phi_{3}(n)$ |\n|:---:|:-------------------:|:-------------:|:-------------------:|:-------------:|\n| $1$ | $(1)_{2}$ | $\\frac{1}{2}$ | $(1)_{3}$ | $\\frac{1}{3}$ |\n| $2$ | $(10)_{2}$ | $\\frac{1}{4}$ | $(2)_{3}$ | $\\frac{2}{3}$ |\n| $3$ | $(11)_{2}$ | $\\frac{3}{4}$ | $(10)_{3}$ | $\\frac{1}{9}$ |\n| $4$ | $(100)_{2}$ | $\\frac{1}{8}$ | $(11)_{3}$ | $\\frac{4}{9}$ |\n| $5$ | $(101)_{2}$ | $\\frac{5}{8}$ | $(12)_{3}$ | $\\frac{7}{9}$ |\n| $6$ | $(110)_{2}$ | $\\frac{3}{8}$ | $(20)_{3}$ | $\\frac{2}{9}$ |\n| $7$ | $(111)_{2}$ | $\\frac{7}{8}$ | $(21)_{3}$ | $\\frac{5}{9}$ |\n| $8$ | $(1000)_{2}$ | $\\frac{1}{16}$ | $(22)_{3}$ | $\\frac{8}{9}$ |\n| $9$ | $(1001)_{2}$ | $\\frac{9}{16}$ | $(100)_{3}$ | $\\frac{1}{27}$ |\n| $10$| $(1010)_{2}$| $\\frac{5}{16}$ | $(101)_{3}$ | $\\frac{10}{27}$ |\n\n前 10 个点，记为 $P_{n} = \\big(\\phi_{2}(n), \\phi_{3}(n)\\big)$，是：\n$P_{1} = \\big(\\frac{1}{2}, \\frac{1}{3}\\big)$\n$P_{2} = \\big(\\frac{1}{4}, \\frac{2}{3}\\big)$\n$P_{3} = \\big(\\frac{3}{4}, \\frac{1}{9}\\big)$\n$P_{4} = \\big(\\frac{1}{8}, \\frac{4}{9}\\big)$\n$P_{5} = \\big(\\frac{5}{8}, \\frac{7}{9}\\big)$\n$P_{6} = \\big(\\frac{3}{8}, \\frac{2}{9}\\big)$\n$P_{7} = \\big(\\frac{7}{8}, \\frac{5}{9}\\big)$\n$P_{8} = \\big(\\frac{1}{16}, \\frac{8}{9}\\big)$\n$P_{9} = \\big(\\frac{9}{16}, \\frac{1}{27}\\big)$\n$P_{10} = \\big(\\frac{5}{16}, \\frac{10}{27}\\big)$\n\n### 第 2 部分：Halton 点的结构模式\n\n基于以上构造的 10 个点，我们可以识别并论证以下结构模式，这些模式对于 QMC 方法的有效性至关重要。\n\n1.  **一维投影的规律性：**\n    第一坐标的前 10 个值的集合 $\\{\\phi_{2}(n)\\}_{n=1}^{10}$ 是 $\\{\\frac{1}{2}, \\frac{1}{4}, \\frac{3}{4}, \\frac{1}{8}, \\frac{5}{8}, \\frac{3}{8}, \\frac{7}{8}, \\frac{1}{16}, \\frac{9}{16}, \\frac{5}{16}\\}$。以 $b$ 为底的一维根反置序列的一个关键性质是，前 $b^k-1$ 个点组成的集合 $\\{\\phi_b(n)\\}_{n=1}^{b^k-1}$ 是均匀分布点集 $\\{\\frac{1}{b^k}, \\frac{2}{b^k}, \\dots, \\frac{b^k-1}{b^k}\\}$ 的一个排列。例如，序列 $\\{\\phi_2(n)\\}$ 的前 $2^3-1=7$ 个点是 $\\{\\frac{1}{2}, \\frac{1}{4}, \\frac{3}{4}, \\frac{1}{8}, \\frac{5}{8}, \\frac{3}{8}, \\frac{7}{8}\\}$。这个集合恰好是 $\\{\\frac{1}{8}, \\frac{2}{8}, \\frac{3}{8}, \\frac{4}{8}, \\frac{5}{8}, \\frac{6}{8}, \\frac{7}{8}\\}$，只是顺序不同。区间 $[0,1]$ 的这种高度结构化的分层确保了一维投影非常均匀地分布。基于 3 的幂次的第二坐标也具有类似的性质。例如，$\\{\\phi_3(n)\\}$ 的前 $3^2-1=8$ 个点是集合 $\\{\\frac{1}{9}, \\frac{2}{9}, \\dots, \\frac{8}{9}\\}$ 的一个排列。这种规律性，即使在 10 个点的小样本中也可见，对于精确的数值积分至关重要，因为它确保了区间的所有部分都被系统地采样。\n\n2.  **二维空间中的均匀覆盖和避免聚集：**\n    Halton 序列的构造旨在以高度均匀的方式填充单位正方形 $[0,1]^2$，避免了在伪随机序列中看到的聚集现象。这可以通过将单位正方形分区并计算每个区域中的点数来观察。让我们将正方形 $[0,1]^2$ 在点 $(\\frac{1}{2}, \\frac{1}{2})$ 处划分为四个相等的象限：左下 (LL) $[0, \\frac{1}{2}) \\times [0, \\frac{1}{2})$，右下 (LR) $[\\frac{1}{2}, 1] \\times [0, \\frac{1}{2})$，左上 (UL) $[0, \\frac{1}{2}) \\times [\\frac{1}{2}, 1]$ 和右上 (UR) $[\\frac{1}{2}, 1] \\times [\\frac{1}{2}, 1]$。\n    前 10 个点的分布如下（将边界上的点，如 $x=\\frac{1}{2}$，视为位于右侧或上部区域）：\n    -   左下：$P_4(\\frac{1}{8}, \\frac{4}{9})$， $P_6(\\frac{3}{8}, \\frac{2}{9})$， $P_{10}(\\frac{5}{16}, \\frac{10}{27})$ --- 总计：3 个点。\n    -   右下：$P_1(\\frac{1}{2}, \\frac{1}{3})$， $P_3(\\frac{3}{4}, \\frac{1}{9})$， $P_9(\\frac{9}{16}, \\frac{1}{27})$ --- 总计：3 个点。\n    -   左上：$P_2(\\frac{1}{4}, \\frac{2}{3})$， $P_8(\\frac{1}{16}, \\frac{8}{9})$ --- 总计：2 个点。\n    -   右上：$P_5(\\frac{5}{8}, \\frac{7}{9})$， $P_7(\\frac{7}{8}, \\frac{5}{9})$ --- 总计：2 个点。\n    每个象限中的点数是 $(3, 3, 2, 2)$，这非常接近每个象限 2.5 个点的理想均匀分布。这展示了该序列的低差异度性质：点被散开以均匀覆盖定义域，没有大的间隙或密集的集群。这是使用互质基的直接结果，它确保了每个维度中的填充模式不会以产生规则但空旷区域的方式相关联（如果基不互质，这是一个已知问题）。\n\n### 第 3 部分：绝对误差的计算\n\n待估计的积分是 $I = \\int_{0}^{1} \\int_{0}^{1} f(x,y) \\, dx \\, dy$，其中 $f(x,y) = xy$。\n首先，我们计算积分的精确值：\n$$I = \\int_{0}^{1} \\int_{0}^{1} x y \\, dx \\, dy = \\left( \\int_{0}^{1} x \\, dx \\right) \\left( \\int_{0}^{1} y \\, dy \\right)$$\n$$I = \\left[ \\frac{x^2}{2} \\right]_{0}^{1} \\left[ \\frac{y^2}{2} \\right]_{0}^{1} = \\left(\\frac{1}{2} - 0\\right) \\left(\\frac{1}{2} - 0\\right) = \\frac{1}{4}$$\n\n接下来，我们使用构造的 $N=10$ 个 Halton 点 $P_n = (\\phi_2(n), \\phi_3(n))$ 来计算 QMC 估计量 $\\widehat{I}_{10}$：\n$$\\widehat{I}_{10} = \\frac{1}{10} \\sum_{n=1}^{10} f(P_n) = \\frac{1}{10} \\sum_{n=1}^{10} \\phi_{2}(n) \\phi_{3}(n)$$\n我们计算每个点的乘积：\n$f(P_1) = \\frac{1}{2} \\cdot \\frac{1}{3} = \\frac{1}{6}$\n$f(P_2) = \\frac{1}{4} \\cdot \\frac{2}{3} = \\frac{2}{12} = \\frac{1}{6}$\n$f(P_3) = \\frac{3}{4} \\cdot \\frac{1}{9} = \\frac{3}{36} = \\frac{1}{12}$\n$f(P_4) = \\frac{1}{8} \\cdot \\frac{4}{9} = \\frac{4}{72} = \\frac{1}{18}$\n$f(P_5) = \\frac{5}{8} \\cdot \\frac{7}{9} = \\frac{35}{72}$\n$f(P_6) = \\frac{3}{8} \\cdot \\frac{2}{9} = \\frac{6}{72} = \\frac{1}{12}$\n$f(P_7) = \\frac{7}{8} \\cdot \\frac{5}{9} = \\frac{35}{72}$\n$f(P_8) = \\frac{1}{16} \\cdot \\frac{8}{9} = \\frac{8}{144} = \\frac{1}{18}$\n$f(P_9) = \\frac{9}{16} \\cdot \\frac{1}{27} = \\frac{1}{16 \\cdot 3} = \\frac{1}{48}$\n$f(P_{10}) = \\frac{5}{16} \\cdot \\frac{10}{27} = \\frac{50}{432} = \\frac{25}{216}$\n\n现在我们对这些值求和：\n$$\\sum_{n=1}^{10} f(P_n) = \\frac{1}{6} + \\frac{1}{6} + \\frac{1}{12} + \\frac{1}{18} + \\frac{35}{72} + \\frac{1}{12} + \\frac{35}{72} + \\frac{1}{18} + \\frac{1}{48} + \\frac{25}{216}$$\n为了对这些分数求和，我们找到一个公分母。集合 $\\{6, 12, 18, 72, 48, 216\\}$ 的最小公倍数是 $432$。\n$$ \\sum_{n=1}^{10} f(P_n) = \\frac{72}{432} + \\frac{72}{432} + \\frac{36}{432} + \\frac{24}{432} + \\frac{210}{432} + \\frac{36}{432} + \\frac{210}{432} + \\frac{24}{432} + \\frac{9}{432} + \\frac{50}{432} $$\n$$ \\sum_{n=1}^{10} f(P_n) = \\frac{72+72+36+24+210+36+210+24+9+50}{432} = \\frac{743}{432} $$\nQMC 估计量是：\n$$\\widehat{I}_{10} = \\frac{1}{10} \\left(\\frac{743}{432}\\right) = \\frac{743}{4320}$$\n\n最后，我们计算绝对误差 $|\\widehat{I}_{10} - I|$：\n$$ |\\widehat{I}_{10} - I| = \\left| \\frac{743}{4320} - \\frac{1}{4} \\right| $$\n为了进行减法，我们使用公分母 $4320$：\n$$ \\frac{1}{4} = \\frac{1 \\cdot 1080}{4 \\cdot 1080} = \\frac{1080}{4320} $$\n$$ |\\widehat{I}_{10} - I| = \\left| \\frac{743}{4320} - \\frac{1080}{4320} \\right| = \\left| \\frac{743 - 1080}{4320} \\right| = \\left| \\frac{-337}{4320} \\right| = \\frac{337}{4320} $$\n整数 $337$ 是素数，而 $4320$ 的素因数分解是 $2^5 \\cdot 3^3 \\cdot 5$。因此，分数 $\\frac{337}{4320}$ 是不可约的。", "answer": "$$\\boxed{\\frac{337}{4320}}$$", "id": "3313764"}, {"introduction": "虽然前一个练习提供了对QMC点集均匀性的直观感受，但严谨的理解需要一个理论性的误差分析框架。这个问题通过在一个特定的测试函数上对比蒙特卡罗与拟蒙特卡罗方法的表现，从而深入探讨其理论基础[@problem_id:3313753]。您将首先推导出标准蒙特卡罗估计量的方差，然后通过分析该函数的Hardy-Krause变差，从理论上解释为什么QMC方法能够为特定类型的函数实现更快的收敛速度。", "problem": "设 $d \\in \\mathbb{N}$，并考虑在单位超立方体 $[0,1]^{d}$ 上定义的被积函数 $f(x)=\\prod_{j=1}^{d} x_{j}$。设 $\\{U_{i}\\}_{i=1}^{n}$ 是独立同分布的随机向量，其中 $U_{i} \\sim \\mathrm{Uniform}([0,1]^{d})$，并为积分 $I=\\int_{[0,1]^{d}} f(x) \\,\\mathrm{d}x$ 定义蒙特卡洛估计量 $\\hat{I}_{n}=\\frac{1}{n} \\sum_{i=1}^{n} f(U_{i})$。从期望和方差的核心定义以及 $\\{U_{i}\\}_{i=1}^{n}$ 的独立性出发，推导 $\\mathrm{Var}(\\hat{I}_{n})$ 的一个闭式表达式，该表达式是关于 $n$ 和 $d$ 的函数。然后，不借助方差，通过基本不等式将星差异度（star discrepancy）与 Hardy–Krause 变差联系起来，解释拟蒙特卡洛（QMC）方法（基于确定性的低差异点集）如何能减少该被积函数的积分误差。你的解释应从差异度（discrepancy）和变差（variation）的定义开始，并最终给出一个严格的陈述，说明对于合适的低差异度构造，QMC 误差界如何随 $n$ 变化。最终答案必须是 $\\mathrm{Var}(\\hat{I}_{n})$ 的闭式表达式。无需四舍五入。", "solution": "该问题是有效的，因为它具有科学依据、提法明确且客观。它是蒙特卡洛和拟蒙特卡洛理论中的一个标准练习题。\n\n该问题包含两部分。首先，我们必须为给定的被积函数推导蒙特卡洛估计量 $\\hat{I}_{n}$ 的方差。其次，我们必须解释拟蒙特卡洛（QMC）方法如何能对这个特定的被积函数实现更好的误差收敛率，这需要使用星差异度和 Hardy-Krause 变差的概念。\n\n第1部分：$\\mathrm{Var}(\\hat{I}_{n})$ 的推导\n\n积分 $I=\\int_{[0,1]^{d}} f(x) \\,\\mathrm{d}x$ 的蒙特卡洛估计量由 $\\hat{I}_{n}=\\frac{1}{n} \\sum_{i=1}^{n} f(U_{i})$ 给出，其中 $\\{U_{i}\\}_{i=1}^{n}$ 是独立同分布（i.i.d.）的随机向量，且 $U_{i} \\sim \\mathrm{Uniform}([0,1]^{d})$。\n\n估计量 $\\hat{I}_{n}$ 的方差由下式给出：\n$$\n\\mathrm{Var}(\\hat{I}_{n}) = \\mathrm{Var}\\left(\\frac{1}{n} \\sum_{i=1}^{n} f(U_{i})\\right)\n$$\n由于随机向量 $\\{U_{i}\\}_{i=1}^{n}$ 是独立同分布的，随机变量 $Y_{i} = f(U_{i})$ 也是独立同分布的。利用方差的性质，我们有：\n$$\n\\mathrm{Var}(\\hat{I}_{n}) = \\frac{1}{n^{2}} \\mathrm{Var}\\left(\\sum_{i=1}^{n} f(U_{i})\\right) = \\frac{1}{n^{2}} \\sum_{i=1}^{n} \\mathrm{Var}(f(U_{i}))\n$$\n由于 $f(U_{i})$ 是同分布的，对所有 $i$，$\\mathrm{Var}(f(U_{i}))$ 都相同。我们将这个公共方差记为 $\\mathrm{Var}(f(U))$。\n$$\n\\mathrm{Var}(\\hat{I}_{n}) = \\frac{1}{n^{2}} \\cdot n \\cdot \\mathrm{Var}(f(U)) = \\frac{1}{n} \\mathrm{Var}(f(U))\n$$\n随机变量 $f(U)$ 的方差定义为 $\\mathrm{Var}(f(U)) = \\mathbb{E}[f(U)^{2}] - (\\mathbb{E}[f(U)])^{2}$。我们需要计算这两个期望值。\n\n随机向量 $U$ 在 $[0,1]^{d}$ 上均匀分布，这意味着其分量 $U_j$（$j=1, \\dots, d$）是独立同分布的随机变量，且 $U_j \\sim \\mathrm{Uniform}([0,1])$。被积函数是 $f(x) = \\prod_{j=1}^{d} x_{j}$。\n\n首先，我们计算期望 $\\mathbb{E}[f(U)]$：\n$$\n\\mathbb{E}[f(U)] = \\mathbb{E}\\left[\\prod_{j=1}^{d} U_{j}\\right]\n$$\n由于分量 $U_j$ 的独立性，乘积的期望等于期望的乘积：\n$$\n\\mathbb{E}[f(U)] = \\prod_{j=1}^{d} \\mathbb{E}[U_{j}]\n$$\n对于一个标准均匀随机变量 $X \\sim \\mathrm{Uniform}([0,1])$，其期望为 $\\mathbb{E}[X] = \\int_{0}^{1} x \\,\\mathrm{d}x = \\left[\\frac{x^{2}}{2}\\right]_{0}^{1} = \\frac{1}{2}$。\n因此，\n$$\n\\mathbb{E}[f(U)] = \\prod_{j=1}^{d} \\frac{1}{2} = \\left(\\frac{1}{2}\\right)^{d} = 2^{-d}\n$$\n这个值也是积分 $I$ 的真实值，这证实了蒙特卡洛估计量是无偏的，即 $\\mathbb{E}[\\hat{I}_{n}] = I$。\n\n接下来，我们计算平方的期望 $\\mathbb{E}[f(U)^{2}]$：\n$$\n\\mathbb{E}[f(U)^{2}] = \\mathbb{E}\\left[\\left(\\prod_{j=1}^{d} U_{j}\\right)^{2}\\right] = \\mathbb{E}\\left[\\prod_{j=1}^{d} U_{j}^{2}\\right]\n$$\n再次，根据 $U_j$ 的独立性：\n$$\n\\mathbb{E}[f(U)^{2}] = \\prod_{j=1}^{d} \\mathbb{E}[U_{j}^{2}]\n$$\n对于 $X \\sim \\mathrm{Uniform}([0,1])$，其二阶矩为 $\\mathbb{E}[X^{2}] = \\int_{0}^{1} x^{2} \\,\\mathrm{d}x = \\left[\\frac{x^{3}}{3}\\right]_{0}^{1} = \\frac{1}{3}$。\n因此，\n$$\n\\mathbb{E}[f(U)^{2}] = \\prod_{j=1}^{d} \\frac{1}{3} = \\left(\\frac{1}{3}\\right)^{d} = 3^{-d}\n$$\n现在我们可以计算 $f(U)$ 的方差：\n$$\n\\mathrm{Var}(f(U)) = \\mathbb{E}[f(U)^{2}] - (\\mathbb{E}[f(U)])^{2} = 3^{-d} - (2^{-d})^{2} = 3^{-d} - 4^{-d}\n$$\n最后，我们将此结果代回到估计量方差的表达式中：\n$$\n\\mathrm{Var}(\\hat{I}_{n}) = \\frac{1}{n} \\mathrm{Var}(f(U)) = \\frac{1}{n} (3^{-d} - 4^{-d})\n$$\n\n第2部分：通过差异度和变差减少QMC误差\n\n蒙特卡洛方法使用随机点，其误差是概率性的，通常用估计量的标准差来刻画，即 $\\mathcal{O}(n^{-1/2})$。拟蒙特卡洛方法使用确定性的、高度均匀的点集，称为低差异度集，以实现更快的收敛速度。QMC中的误差是确定性的，并且可以用函数变差和点集差异度的概念来界定。\n\n使用点集 $P_{n} = \\{p_{1}, \\dots, p_{n}\\} \\subset [0,1]^{d}$ 的QMC近似误差由 $|I - Q_{n}(f)|$ 给出，其中 $Q_{n}(f) = \\frac{1}{n}\\sum_{i=1}^{n}f(p_{i})$。这个误差由 Koksma-Hlawka 不等式界定：\n$$\n\\left|\\int_{[0,1]^{d}} f(x) \\,\\mathrm{d}x - \\frac{1}{n} \\sum_{i=1}^{n} f(p_{i})\\right| \\leq V_{HK}(f) \\cdot D_{n}^{*}(P_{n})\n$$\n其中 $V_{HK}(f)$ 是函数 $f$ 的 Hardy-Krause 变差，而 $D_{n}^{*}(P_{n})$ 是点集 $P_{n}$ 的星差异度。\n\n星差异度 $D_{n}^{*}(P_{n})$ 衡量点集的均匀性。它被定义为，落入任何一个以原点为起点的轴对齐盒子中的点的比例与该盒子的体积之间的最大偏差：\n$$\nD_{n}^{*}(P_{n}) = \\sup_{y \\in [0,1]^{d}} \\left| \\frac{1}{n} \\sum_{i=1}^{n} \\mathbb{1}_{[0,y)}(p_{i}) - \\prod_{j=1}^{d} y_j \\right|\n$$\n其中 $[0,y) = [0, y_1) \\times \\dots \\times [0, y_d)$。构造低差异度点集的目的是最小化 $D_{n}^{*}$。\n\nHardy-Krause 变差 $V_{HK}(f)$ 衡量函数 $f$ 的“摆动性”。对于一个具有连续混合偏导数的函数，它定义为：\n$$\nV_{HK}(f) = \\sum_{\\emptyset \\neq u \\subseteq \\{1, \\dots, d\\}} \\int_{[0,1]^{|u|}} \\left| \\frac{\\partial^{|u|}f}{\\prod_{j \\in u} \\partial x_j} (x_u; 1) \\right| \\,\\mathrm{d}x_u\n$$\n其中 $(x_u; 1)$ 表示将 $j \\notin u$ 的变量 $x_j$ 设置为1。\n\n对于我们的被积函数 $f(x) = \\prod_{j=1}^{d} x_j$，我们首先计算其混合偏导数。对于任何非空索引子集 $u \\subseteq \\{1, \\dots, d\\}$，求导得到：\n$$\n\\frac{\\partial^{|u|}f}{\\prod_{j \\in u} \\partial x_j} = \\prod_{k \\notin u} x_k\n$$\n在 $(x_u; 1)$ 处求值，我们将所有 $k \\notin u$ 的 $x_k$ 设为1，结果为：\n$$\n\\frac{\\partial^{|u|}f}{\\prod_{j \\in u} \\partial x_j} (x_u; 1) = 1\n$$\n这个结果与 $x_u$ 无关且为正。变差公式中对应的积分项是：\n$$\n\\int_{[0,1]^{|u|}} |1| \\,\\mathrm{d}x_u = \\int_{[0,1]^{|u|}} 1 \\,\\mathrm{d}x_u = 1\n$$\n总 Hardy-Krause 变差是这些项对所有非空子集 $u$ 的和：\n$$\nV_{HK}(f) = \\sum_{\\emptyset \\neq u \\subseteq \\{1, \\dots, d\\}} 1\n$$\n一个包含 $d$ 个元素的集合的非空子集数量是 $2^{d} - 1$。因此，变差是有限的：\n$$\nV_{HK}(f) = 2^{d} - 1\n$$\n由于 $f$ 具有有限的 Hardy-Krause 变差，Koksma-Hlawka 不等式适用。QMC 误差的界为：\n$$\n|I - Q_{n}(f)| \\leq (2^{d} - 1) D_{n}^{*}(P_{n})\n$$\n对于著名的低差异度构造（例如，Halton 或 Sobol' 序列），星差异度具有以下形式的渐近界：\n$$\nD_{n}^{*}(P_{n}) = \\mathcal{O}\\left(\\frac{(\\ln n)^{d-1}}{n}\\right) \\quad \\text{或} \\quad D_{n}^{*}(P_{n}) = \\mathcal{O}\\left(\\frac{(\\ln n)^{d}}{n}\\right)\n$$\n（对数的具体幂次取决于序列和理论界）。无论哪种情况，对于固定的维度 $d$，忽略对数因子后，QMC误差界近似为 $\\mathcal{O}(n^{-1})$。这展示了一个确定性保证的收敛率，它在渐近意义上优于标准蒙特卡洛方法的概率性收敛率 $\\mathcal{O}(n^{-1/2})$。被积函数 $f(x)=\\prod x_j$ 是QMC的理想候选者，因为其低阶混合导数是常数，使其 Hardy-Krause 变差在 $d$ 适中的情况下为有限且相对较小。", "answer": "$$\n\\boxed{\\frac{1}{n}(3^{-d} - 4^{-d})}\n$$", "id": "3313753"}, {"introduction": "确定性QMC方法提供了出色的收敛性，但没有直接的方法来估计积分误差。随机化拟蒙特卡罗 (RQMC) 方法通过引入随机性同时保持均匀性，巧妙地解决了这个问题，从而实现了统计误差估计。这个高级练习将引导您理解RQMC的基本原理，要求您从一个加扰点集的多个独立复制中，推导出一个无偏方差估计量[@problem_id:3313803]。这项练习对于理解如何在实践中为基于QMC的结果构建可靠的置信区间至关重要。", "problem": "考虑一个可积函数 $f:[0,1]^s \\to \\mathbb{R}$ 关于 $[0,1]^s$ 上均匀分布的积分。令 $\\mu = \\int_{[0,1]^s} f(\\boldsymbol{u}) \\,\\mathrm{d}\\boldsymbol{u}$。在一个基于 Owen 加扰数字网的随机化拟蒙特卡罗（RQMC）方案中，假设对于一个固定的整数 $N \\ge 1$，您生成了 $R \\ge 2$ 个完全 Owen 加扰的 $(t,m,s)$-网的独立副本，每个副本提供 $N$ 个相关的点，这些点在边缘上是 $[0,1]^s$ 上的均匀分布，并且在不同副本之间是独立的。对于每个副本 $r \\in \\{1,\\dots,R\\}$，定义副本估计量\n$$\n\\hat{\\mu}_r = \\frac{1}{N}\\sum_{n=1}^{N} f(\\boldsymbol{U}_{r,n}),\n$$\n其中在每个副本 $r$ 内，点集 $\\{\\boldsymbol{U}_{r,n}\\}_{n=1}^N$ 构成一个加扰数字网，而在不同副本之间，点集是独立的。令总的 RQMC 估计量为\n$$\n\\bar{\\mu}_R = \\frac{1}{R}\\sum_{r=1}^{R} \\hat{\\mu}_r.\n$$\n假设 $f$ 是平方可积的，因此 $\\mathbb{E}[(\\hat{\\mu}_r - \\mu)^2]  \\infty$，并且在给定的 $N$ 和加扰下，四阶矩 $\\mathbb{E}[(\\hat{\\mu}_r - \\mu)^4]$ 是有限的。仅从无偏性、方差、副本间的独立性以及独立同分布随机变量的样本均值和样本方差的经典性质出发，完成以下任务：\n\n1. 在给定的 RQMC 构造和 $R$ 个加扰副本独立的条件下，证明 $\\bar{\\mu}_R$ 是 $\\mu$ 的一个无偏估计量。\n\n2. 从第一性原理出发，并且仅使用 $R$ 个副本值 $\\{\\hat{\\mu}_r\\}_{r=1}^R$，推导一个在所述假设下对 $\\bar{\\mu}_R$ 方差的无偏估计量。您的推导不得依赖任何预先引用的样本方差公式；它必须从定义和副本间的独立性开始。\n\n3. 在有限四阶矩的假设下，建立您的方差估计量在 $N$ 固定，$R \\to \\infty$ 时的相合性。讨论在 $R$ 固定，$N \\to \\infty$ 时，考虑到对于平方可积函数 $f$ 加扰网的已知方差收缩特性，其行为如何变化。\n\n您的最终答案必须是您在第 2 项中推导出的方差估计量的单一封闭形式表达式，并尽可能简化。不需要数值近似，也不涉及任何单位。", "solution": "问题陈述已经过验证，被认为是科学上合理的、适定的、客观的且自洽的。它提出了随机化拟蒙特卡罗（RQMC）方法理论中一个关于方差估计的标准而基础的问题。因此，我们可以进行形式化的解答。\n\n该问题要求关于 RQMC 积分方案的三个不同但相关的结果：证明总均值估计量的无偏性，为其方差推导一个无偏估计量，以及讨论该方差估计量的渐近性质。我们将按顺序处理每个部分，严格遵守第一性原理的要求。\n\n令 $\\mu = \\int_{[0,1]^s} f(\\boldsymbol{u}) \\,\\mathrm{d}\\boldsymbol{u}$ 为我们感兴趣的积分。副本估计量为 $\\hat{\\mu}_r = \\frac{1}{N}\\sum_{n=1}^{N} f(\\boldsymbol{U}_{r,n})$，其中 $r \\in \\{1, \\dots, R\\}$，总估计量为 $\\bar{\\mu}_R = \\frac{1}{R}\\sum_{r=1}^{R} \\hat{\\mu}_r$。点集 $\\{\\boldsymbol{U}_{r,n}\\}_{n=1}^N$ 在不同副本 $r$ 之间是独立的，并且对于固定的 $r$，这些点构成一个加扰数字网。这种网的一个关键性质是，每个点 $\\boldsymbol{U}_{r,n}$ 的边缘分布是在超立方体 $[0,1]^s$ 上的均匀分布。\n\n1. 总估计量 $\\bar{\\mu}_R$ 的无偏性\n\n为了证明 $\\bar{\\mu}_R$ 是 $\\mu$ 的一个无偏估计量，我们必须证明其期望值等于 $\\mu$。期望是针对 $R$ 个独立加扰网的随机化来计算的。\n\n首先，我们确定单个副本估计量 $\\hat{\\mu}_r$ 的期望值。根据期望算子的线性性质，我们有：\n$$\n\\mathbb{E}[\\hat{\\mu}_r] = \\mathbb{E}\\left[\\frac{1}{N}\\sum_{n=1}^{N} f(\\boldsymbol{U}_{r,n})\\right] = \\frac{1}{N}\\sum_{n=1}^{N} \\mathbb{E}[f(\\boldsymbol{U}_{r,n})]\n$$\n问题陈述指出，每个点 $\\boldsymbol{U}_{r,n}$ 在边缘上是 $[0,1]^s$ 上的均匀分布。这意味着任何单个点 $\\boldsymbol{U}_{r,n}$ 的概率密度函数是 $[0,1]^s$ 上的均匀密度。因此，根据定义，$f$ 应用于这样一个点的期望值是 $f$ 在该域上的积分：\n$$\n\\mathbb{E}[f(\\boldsymbol{U}_{r,n})] = \\int_{[0,1]^s} f(\\boldsymbol{u}) \\cdot 1 \\,\\mathrm{d}\\boldsymbol{u} = \\mu\n$$\n这对每个 $n \\in \\{1, \\dots, N\\}$ 和每个副本 $r \\in \\{1, \\dots, R\\}$ 都成立。将此结果代回 $\\mathbb{E}[\\hat{\\mu}_r]$ 的表达式中，得到：\n$$\n\\mathbb{E}[\\hat{\\mu}_r] = \\frac{1}{N}\\sum_{n=1}^{N} \\mu = \\frac{1}{N}(N\\mu) = \\mu\n$$\n这表明每个单独的副本估计量 $\\hat{\\mu}_r$ 都是 $\\mu$ 的一个无偏估计量。\n\n现在，我们可以求出总估计量 $\\bar{\\mu}_R$ 的期望值。再次使用期望的线性性质：\n$$\n\\mathbb{E}[\\bar{\\mu}_R] = \\mathbb{E}\\left[\\frac{1}{R}\\sum_{r=1}^{R} \\hat{\\mu}_r\\right] = \\frac{1}{R}\\sum_{r=1}^{R} \\mathbb{E}[\\hat{\\mu}_r]\n$$\n由于对所有的 $r$ 都有 $\\mathbb{E}[\\hat{\\mu}_r] = \\mu$，我们有：\n$$\n\\mathbb{E}[\\bar{\\mu}_R] = \\frac{1}{R}\\sum_{r=1}^{R} \\mu = \\frac{1}{R}(R\\mu) = \\mu\n$$\n这样就完成了证明。总 RQMC 估计量 $\\bar{\\mu}_R$ 是 $\\mu$ 的一个无偏估计量。这个性质依赖于期望的线性性质和点的边缘均匀性，但不依赖于单个副本内点之间的独立性。\n\n2. $\\bar{\\mu}_R$ 的无偏方差估计量的推导\n\n我们的任务是仅使用副本值 $\\{\\hat{\\mu}_r\\}_{r=1}^R$ 来推导 $\\mathrm{Var}(\\bar{\\mu}_R)$ 的一个无偏估计量。\n\n首先，让我们求出 $\\bar{\\mu}_R$ 的真实方差。副本估计量 $\\{\\hat{\\mu}_r\\}_{r=1}^R$ 是由独立的点集构造的。因此，随机变量 $\\hat{\\mu}_1, \\hat{\\mu}_2, \\dots, \\hat{\\mu}_R$ 是独立的。此外，由于每个副本的加扰过程在统计上是相同的，所以它们也是独立同分布的（i.i.d.）。令每个副本估计量的方差表示为 $\\sigma_N^2$：\n$$\n\\sigma_N^2 = \\mathrm{Var}(\\hat{\\mu}_r) = \\mathbb{E}[(\\hat{\\mu}_r - \\mu)^2]\n$$\n问题中关于 $f$ 平方可积的假设确保了这个方差是有限的。\n\n总估计量 $\\bar{\\mu}_R$ 的方差是：\n$$\n\\mathrm{Var}(\\bar{\\mu}_R) = \\mathrm{Var}\\left(\\frac{1}{R}\\sum_{r=1}^{R} \\hat{\\mu}_r\\right) = \\frac{1}{R^2} \\mathrm{Var}\\left(\\sum_{r=1}^{R} \\hat{\\mu}_r\\right)\n$$\n由于副本 $\\{\\hat{\\mu}_r\\}$ 的独立性，和的方差是方差的和：\n$$\n\\mathrm{Var}(\\bar{\\mu}_R) = \\frac{1}{R^2} \\sum_{r=1}^{R} \\mathrm{Var}(\\hat{\\mu}_r) = \\frac{1}{R^2} \\sum_{r=1}^{R} \\sigma_N^2 = \\frac{1}{R^2}(R\\sigma_N^2) = \\frac{\\sigma_N^2}{R}\n$$\n我们的目标是找到一个估计量 $\\widehat{\\mathrm{Var}}(\\bar{\\mu}_R)$，使得 $\\mathbb{E}[\\widehat{\\mathrm{Var}}(\\bar{\\mu}_R)] = \\sigma_N^2/R$。对于独立同分布样本，标准方法是使用样本方差。让我们按要求从第一性原理推导它。\n\n这个任务等价于基于 $R$ 个独立同分布的观测值 $\\hat{\\mu}_1, \\dots, \\hat{\\mu}_R$ 找到 $\\sigma_N^2/R$ 的一个无偏估计量。我们从构造这些观测值的样本方差开始：\n$$\nS_R^2 = \\frac{1}{R-1} \\sum_{r=1}^{R} (\\hat{\\mu}_r - \\bar{\\mu}_R)^2\n$$\n让我们证明 $S_R^2$ 是 $\\sigma_N^2$ 的一个无偏估计量。我们计算它的期望：\n$$\n\\mathbb{E}[S_R^2] = \\frac{1}{R-1} \\mathbb{E}\\left[\\sum_{r=1}^{R} (\\hat{\\mu}_r - \\bar{\\mu}_R)^2\\right]\n$$\n我们展开期望内的项：\n$$\n\\sum_{r=1}^{R} (\\hat{\\mu}_r - \\bar{\\mu}_R)^2 = \\sum_{r=1}^{R} \\hat{\\mu}_r^2 - 2\\bar{\\mu}_R \\sum_{r=1}^{R} \\hat{\\mu}_r + \\sum_{r=1}^{R} \\bar{\\mu}_R^2 = \\sum_{r=1}^{R} \\hat{\\mu}_r^2 - 2\\bar{\\mu}_R(R\\bar{\\mu}_R) + R\\bar{\\mu}_R^2 = \\sum_{r=1}^{R} \\hat{\\mu}_r^2 - R\\bar{\\mu}_R^2\n$$\n取期望得到：\n$$\n\\mathbb{E}\\left[\\sum_{r=1}^{R} (\\hat{\\mu}_r - \\bar{\\mu}_R)^2\\right] = \\sum_{r=1}^{R} \\mathbb{E}[\\hat{\\mu}_r^2] - R\\mathbb{E}[\\bar{\\mu}_R^2]\n$$\n我们使用关系式 $\\mathbb{E}[X^2] = \\mathrm{Var}(X) + (\\mathbb{E}[X])^2$。对于每个 $\\hat{\\mu}_r$，我们有 $\\mathbb{E}[\\hat{\\mu}_r] = \\mu$ 和 $\\mathrm{Var}(\\hat{\\mu}_r) = \\sigma_N^2$。因此，$\\mathbb{E}[\\hat{\\mu}_r^2] = \\sigma_N^2 + \\mu^2$。对于 $\\bar{\\mu}_R$，我们有 $\\mathbb{E}[\\bar{\\mu}_R] = \\mu$ 和 $\\mathrm{Var}(\\bar{\\mu}_R) = \\sigma_N^2/R$。因此，$\\mathbb{E}[\\bar{\\mu}_R^2] = \\sigma_N^2/R + \\mu^2$。\n将这些代入期望的方程中：\n$$\n\\mathbb{E}\\left[\\sum_{r=1}^{R} (\\hat{\\mu}_r - \\bar{\\mu}_R)^2\\right] = \\sum_{r=1}^{R} (\\sigma_N^2 + \\mu^2) - R\\left(\\frac{\\sigma_N^2}{R} + \\mu^2\\right)\n$$\n$$\n= R(\\sigma_N^2 + \\mu^2) - (\\sigma_N^2 + R\\mu^2) = R\\sigma_N^2 + R\\mu^2 - \\sigma_N^2 - R\\mu^2 = (R-1)\\sigma_N^2\n$$\n因此，样本方差的期望是：\n$$\n\\mathbb{E}[S_R^2] = \\frac{1}{R-1} (R-1)\\sigma_N^2 = \\sigma_N^2\n$$\n这表明 $S_R^2$ 是单个副本方差 $\\sigma_N^2$ 的无偏估计量。\n我们的目标是估计 $\\mathrm{Var}(\\bar{\\mu}_R) = \\sigma_N^2/R$。我们可以将估计量构造为 $\\widehat{\\mathrm{Var}}(\\bar{\\mu}_R) = S_R^2/R$。让我们验证其无偏性：\n$$\n\\mathbb{E}[\\widehat{\\mathrm{Var}}(\\bar{\\mu}_R)] = \\mathbb{E}\\left[\\frac{S_R^2}{R}\\right] = \\frac{1}{R}\\mathbb{E}[S_R^2] = \\frac{\\sigma_N^2}{R}\n$$\n这与真实方差 $\\mathrm{Var}(\\bar{\\mu}_R)$ 相匹配。因此，所求的无偏估计量是：\n$$\n\\widehat{\\mathrm{Var}}(\\bar{\\mu}_R) = \\frac{S_R^2}{R} = \\frac{1}{R(R-1)} \\sum_{r=1}^{R} (\\hat{\\mu}_r - \\bar{\\mu}_R)^2\n$$\n该表达式仅依赖于副本值，符合要求。\n\n3. 方差估计量的相合性\n\n我们在两种渐近情况下考察所推导估计量的行为。\n\n情况 1：$N$ 固定，$R \\to \\infty$。\n我们正在研究我们的估计量 $\\widehat{\\mathrm{Var}}(\\bar{\\mu}_R) = S_R^2/R$ 对 $\\mathrm{Var}(\\bar{\\mu}_R) = \\sigma_N^2/R$ 的相合性。估计量是 $\\widehat{\\mathrm{Var}}(\\bar{\\mu}_R) = S_R^2/R$。变量 $\\{\\hat{\\mu}_r\\}_{r=1}^R$ 是独立同分布的，具有有限均值 $\\mu$ 和有限方差 $\\sigma_N^2$。问题陈述指出四阶矩 $\\mathbb{E}[(\\hat{\\mu}_r - \\mu)^4]$ 也是有限的。\n根据大数定律，样本方差 $S_R^2$ 是总体方差 $\\sigma_N^2$ 的一个相合估计量。也就是说，当 $R \\to \\infty$ 时：\n$$\nS_R^2 = \\frac{1}{R-1} \\sum_{r=1}^{R} (\\hat{\\mu}_r - \\bar{\\mu}_R)^2 \\xrightarrow{p} \\sigma_N^2\n$$\n其中 $\\xrightarrow{p}$ 表示依概率收敛。有限四阶矩的假设确保了这种收敛。\n被估计的量是 $\\mathrm{Var}(\\bar{\\mu}_R) = \\sigma_N^2/R$。当 $R \\to \\infty$ 时，估计量 $\\widehat{\\mathrm{Var}}(\\bar{\\mu}_R) = S_R^2/R$ 和真实方差 $\\sigma_N^2/R$ 都收敛到 0。估计的质量通过它们差值的收敛到 0 来评估。让我们考虑缩放后的差值：\n$$\nR \\left( \\widehat{\\mathrm{Var}}(\\bar{\\mu}_R) - \\mathrm{Var}(\\bar{\\mu}_R) \\right) = R \\left( \\frac{S_R^2}{R} - \\frac{\\sigma_N^2}{R} \\right) = S_R^2 - \\sigma_N^2\n$$\n由于 $S_R^2 - \\sigma_N^2 \\xrightarrow{p} 0$，我们的方差估计量是相合的，因为它能追踪真实方差趋于零。具体来说，相对误差收敛到零：\n$$\n\\frac{\\widehat{\\mathrm{Var}}(\\bar{\\mu}_R) - \\mathrm{Var}(\\bar{\\mu}_R)}{\\mathrm{Var}(\\bar{\\mu}_R)} = \\frac{S_R^2/R - \\sigma_N^2/R}{\\sigma_N^2/R} = \\frac{S_R^2 - \\sigma_N^2}{\\sigma_N^2} \\xrightarrow{p} 0\n$$\n因此，副本的样本方差提供了对每个副本方差 $\\sigma_N^2$ 的相合估计，这反过来又给出了对总均值方差的相合估计。\n\n情况 2：$R$ 固定，$N \\to \\infty$。\n在这里，我们依赖于加扰数字网的已知性质。对于任何平方可积函数 $f$，RQMC 估计量的方差收敛到零的速度快于标准蒙特卡罗方法的速率 $O(N^{-1})$。也就是说：\n$$\n\\sigma_N^2 = \\mathrm{Var}(\\hat{\\mu}_r) = o(N^{-1}) \\quad \\text{as } N \\to \\infty\n$$\n（对于更平滑的函数，收敛率甚至更快，例如 $O(N^{-2+\\epsilon})$ 或更好）。\n当 $N \\to \\infty$ 时，$\\sigma_N^2 \\to 0$。总均值的真实方差 $\\mathrm{Var}(\\bar{\\mu}_R) = \\sigma_N^2/R$ 也收敛到 0。\n让我们分析我们的估计量 $\\widehat{\\mathrm{Var}}(\\bar{\\mu}_R) = S_R^2/R$ 的行为。该估计量的期望值为 $\\mathbb{E}[S_R^2/R] = \\sigma_N^2/R$。当 $N \\to \\infty$ 时，这个期望值趋于 0。\n因为 $S_R^2$ 是一个非负随机变量，其期望收敛到零意味着 $S_R^2$ 本身必须依概率收敛到 0。\n$$\n\\mathbb{E}[S_R^2] = \\sigma_N^2 \\to 0 \\implies S_R^2 \\xrightarrow{p} 0 \\quad \\text{as } N \\to \\infty\n$$\n因此，我们的估计量 $\\widehat{\\mathrm{Var}}(\\bar{\\mu}_R) = S_R^2/R$ 也依概率收敛到 0。这是正确且期望的行为。随着 $N$ 的增加，每个副本 $\\hat{\\mu}_r$ 都成为 $\\mu$ 的一个高度准确的估计。副本之间的变异减小，$R$ 个副本的集合紧密地聚集在 $\\mu$ 周围。我们的方差估计量通过产生一个趋于 0 的估计来正确捕捉这种变异的减少，反映了总均值 $\\bar{\\mu}_R$ 的确定性不断增加。", "answer": "$$\\boxed{\\frac{1}{R(R-1)} \\sum_{r=1}^{R} (\\hat{\\mu}_r - \\bar{\\mu}_R)^2}$$", "id": "3313803"}]}