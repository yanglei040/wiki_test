{"hands_on_practices": [{"introduction": "这项首个练习在一个简单且可解析处理的设定中，对单点Gibbs采样和分块Gibbs采样进行了直接的定量比较。通过推导这两种方法的滞后-1自相关性，我们将清晰地看到分块如何消除连续样本间的依赖性，从而提升采样器的效率。这个基础练习旨在揭示分块采样的核心优势。[@problem_id:3293043]", "problem": "考虑一个目标分布，它是一个均值为零、方差为单位、相关系数参数为 $\\rho \\in (-1,1)$ 的二元正态分布，即 $(X,Y) \\sim \\mathcal{N}\\!\\left(\\begin{pmatrix}0 \\\\ 0\\end{pmatrix}, \\begin{pmatrix}1  \\rho \\\\ \\rho  1\\end{pmatrix}\\right)$。一个马尔可夫链蒙特卡洛（MCMC, Markov chain Monte Carlo）采样器以两种不同的方式运行：\n\n- 单点 Gibbs 采样：在每次迭代 $t \\in \\mathbb{N}$ 中，首先在给定前一个 $Y$ 的条件下更新 $X$，然后在给定新更新的 $X$ 的条件下更新 $Y$。將第 $t$ 次迭代完成后的链记为 $(X^{(t)}, Y^{(t)})$。\n- 分块 Gibbs 采样：在每次迭代 $t \\in \\mathbb{N}$ 中，通过从目标分布 $\\mathcal{N}\\!\\left(\\begin{pmatrix}0 \\\\ 0\\end{pmatrix}, \\begin{pmatrix}1  \\rho \\\\ \\rho  1\\end{pmatrix}\\right)$ 中抽取一个独立于前一状态的新样本，将 $(X,Y)$ 作为一个区块联合更新。\n\n仅使用关于多元正态分布的基本事实和自相关的定义，推导在每种方案下标量时间序列 $\\{X^{(t)}\\}_{t\\geq 0}$ 的滞后-1 自相关，并将其表示为 $\\rho$ 的函数。您的推导必须从 $(X,Y)$ 的条件分布以及平稳时间序列的自相关定义出发。将您的最终答案表示为两个滞后-1 自相关的闭式解析表达式，顺序为：单点 Gibbs，分块 Gibbs。無需四捨五入。", "solution": "问题要求推导由两种不同的 MCMC 采样方案为目标二元正态分布生成的时间序列 $\\{X^{(t)}\\}_{t\\geq 0}$ 的滞后-1 自相关。\n\n向量 $(X,Y)^T$ 的目标分布为 $\\mathcal{N}(\\mu, \\Sigma)$，其中均值向量为 $\\mu = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$，协方差矩阵为 $\\Sigma = \\begin{pmatrix} 1  \\rho \\\\ \\rho  1 \\end{pmatrix}$，$\\rho \\in (-1, 1)$。\n\n对于任何平稳时间序列 $\\{Z_t\\}$，滞后-$k$ 自相关定义为 $\\text{Corr}(Z_{t+k}, Z_t) = \\frac{\\text{Cov}(Z_{t+k}, Z_t)}{\\text{Var}(Z_t)}$。\n两种采样方案的设计都使得目标分布是马尔可夫链的平稳分布。因此，序列 $\\{X^{(t)}\\}$ 是平稳的。根据目标分布的定义，我们有对任意 $t$（假设链处于其平稳状态），$\\mathbb{E}[X^{(t)}] = 0$ 且 $\\text{Var}(X^{(t)}) = 1$。因此，$\\{X^{(t)}\\}$ 的滞后-1 自相关为：\n$$ \\text{autocorr}_X(1) = \\text{Corr}(X^{(t+1)}, X^{(t)}) = \\frac{\\text{Cov}(X^{(t+1)}, X^{(t)})}{\\sqrt{\\text{Var}(X^{(t+1)})\\text{Var}(X^{(t)})}} = \\frac{\\mathbb{E}[X^{(t+1)}X^{(t)}] - \\mathbb{E}[X^{(t+1)}]\\mathbb{E}[X^{(t)}]}{\\sqrt{1 \\cdot 1}} = \\mathbb{E}[X^{(t+1)}X^{(t)}] $$\n指定的二元正态分布的一个关键性质是其条件分布的形式：\n\\begin{itemize}\n    \\item 在给定 $Y=y$ 的条件下，$X$ 的条件分布是正态分布 $\\mathcal{N}(\\rho y, 1-\\rho^2)$。条件期望为 $\\mathbb{E}[X|Y=y] = \\rho y$。\n    \\item 在给定 $X=x$ 的条件下，$Y$ 的条件分布是正态分布 $\\mathcal{N}(\\rho x, 1-\\rho^2)$。条件期望为 $\\mathbb{E}[Y|X=x] = \\rho x$。\n\\end{itemize}\n\n我们现在分析每一种采样方案。\n\n**方案 1：单点 Gibbs 采样**\n从 $(X^{(t)}, Y^{(t)})$ 到 $(X^{(t+1)}, Y^{(t+1)})$ 的转移在单次迭代中分两步进行：\n1. 从给定 $Y=Y^{(t)}$ 的 $X$ 的条件分布中抽取一个新值 $X^{(t+1)}$。所以，$X^{(t+1)} \\sim p(x|Y^{(t)})$。\n2. 从给定新抽取的 $X=X^{(t+1)}$ 的 $Y$ 的条件分布中抽取一个新值 $Y^{(t+1)}$。所以，$Y^{(t+1)} \\sim p(y|X^{(t+1)})$。\n\n为了计算自相关 $\\mathbb{E}[X^{(t+1)}X^{(t)}]$，我们应用全期望定律，以截至时间 $t$ 的过程历史为条件，该历史由 sigma-代数 $\\mathcal{F}_t = \\sigma(\\{ (X^{(s)}, Y^{(s)}) \\}_{s \\leq t})$ 表示。\n$$ \\mathbb{E}[X^{(t+1)}X^{(t)}] = \\mathbb{E} \\left[ \\mathbb{E}[X^{(t+1)}X^{(t)} | \\mathcal{F}_t] \\right] $$\n由于 $X^{(t)}$ 在时间 $t$ 是已知的（即，它是 $\\mathcal{F}_t$-可测的），我们可以将其从内层期望中提出：\n$$ \\mathbb{E}[X^{(t+1)}X^{(t)}] = \\mathbb{E} \\left[ X^{(t)} \\mathbb{E}[X^{(t+1)} | \\mathcal{F}_t] \\right] $$\n根据 Gibbs 采样器的定义，新状态 $X^{(t+1)}$ 仅通过 $Y^{(t)}$ 的值依赖于历史 $\\mathcal{F}_t$。因此，条件期望简化为：\n$$ \\mathbb{E}[X^{(t+1)} | \\mathcal{F}_t] = \\mathbb{E}[X^{(t+1)} | Y^{(t)}] $$\n根据二元正态分布的性质，这个条件期望是 $\\rho Y^{(t)}$。将其代回，我们得到：\n$$ \\mathbb{E}[X^{(t+1)}X^{(t)}] = \\mathbb{E} \\left[ X^{(t)} (\\rho Y^{(t)}) \\right] = \\rho \\mathbb{E}[X^{(t)}Y^{(t)}] $$\n由于链是平稳的，$(X^{(t)}, Y^{(t)})$ 的联合分布就是目标分布。期望 $\\mathbb{E}[X^{(t)}Y^{(t)}]$ 是目标分布中 $X$ 和 $Y$ 的协方差，因为它们的均值为零。从协方差矩阵 $\\Sigma$ 中可知，这是 $\\text{Cov}(X,Y) = \\rho$。\n$$ \\mathbb{E}[X^{(t)}Y^{(t)}] = \\rho $$\n因此，单点 Gibbs 采样器的滞后-1 自相关是：\n$$ \\text{autocorr}_X(1) = \\rho \\cdot \\rho = \\rho^2 $$\n\n**方案 2：分块 Gibbs 采样**\n在此方案中，新状态 $(X^{(t+1)}, Y^{(t+1)})$ 是从目标分布 $\\mathcal{N}(\\mu, \\Sigma)$ 中联合抽取的，且独立于前一个状态 $(X^{(t)}, Y^{(t)})$。这种方法更准确地称为“独立性采样器”，其中提议分布就是目标分布本身。\n\n这种采样过程的结果是向量序列 $\\{(X^{(t)}, Y^{(t)})\\}_{t\\geq 0}$ 是一个独立同分布 (i.i.d.) 序列。这意味着这些向量在不同时间步长的任何分量也是独立的。特别是，$X^{(t+1)}$ 独立于 $X^{(t)}$。\n\n我们要计算滞后-1 自相关 $\\mathbb{E}[X^{(t+1)}X^{(t)}]$。对于独立随机变量，它们乘积的期望是它们期望的乘积：\n$$ \\mathbb{E}[X^{(t+1)}X^{(t)}] = \\mathbb{E}[X^{(t+1)}] \\mathbb{E}[X^{(t)}] $$\n由于过程是平稳的，$X^{(t+1)}$ 和 $X^{(t)}$ 的边缘分布都是 $\\mathcal{N}(0,1)$，所以它们的期望为零：\n$$ \\mathbb{E}[X^{(t+1)}] = 0 \\quad \\text{and} \\quad \\mathbb{E}[X^{(t)}] = 0 $$\n因此，分块 Gibbs 采样器的滞后-1 自相关是：\n$$ \\text{autocorr}_X(1) = 0 \\cdot 0 = 0 $$\n这个结果从独立性的定义直接得出，因为两个独立随机变量之间的协方差（以及相关性）为零。\n\n时间序列 $\\{X^{(t)}\\}$ 的滞后-1 自相关对于单点 Gibbs 采样器是 $\\rho^2$，对于分块 Gibbs 采样器是 $0$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix} \\rho^2  0 \\end{pmatrix}\n}\n$$", "id": "3293043"}, {"introduction": "现实世界中的模型往往不像二元正态分布那样简单。这个问题探讨了一个更复杂的场景，其中参数通过乘法耦合，导致了非高斯后验分布。我们将分析为何单点Gibbs采样虽然简单却效率低下，以及分块如何成为在相关的后验分布中有效探索的必要策略，即使这意味着会失去计算上的共轭便利性。[@problem_id:3293022]", "problem": "考虑以下贝叶斯模型，该模型旨在说明分块吉布斯采样器何时会用简单的条件结构换取混合效率的潜在增益。令 $y_1,\\dots,y_n$ 在给定参数 $\\theta_1,\\theta_2$ 的条件下条件独立同分布，其似然函数为\n$$\ny_i \\mid \\theta_1,\\theta_2 \\;\\sim\\; \\mathcal{N}\\!\\big(\\theta_1 \\theta_2,\\;\\sigma^2\\big), \\quad i=1,\\dots,n,\n$$\n其中 $\\sigma^2$ 已知且为正。假设先验是独立高斯分布，\n$$\n\\theta_1 \\sim \\mathcal{N}(0,\\tau_1^2),\\qquad \\theta_2 \\sim \\mathcal{N}(0,\\tau_2^2),\n$$\n其中 $\\tau_1^2,\\tau_2^2$ 已知且为正。回顾吉布斯采样器的定义：它是一种马尔可夫链蒙特卡洛（MCMC）方法，通过从全条件分布中迭代采样。在分块吉布斯采样器中，一组变量会从它们的联合全条件分布中联合更新。吉布斯采样器的正确性源于贝യെ斯定理以及目标分布在马尔可夫转移核（由条件更新核复合而成）下的不变性。\n\n回答以下关于单点更新与双变量分块下的全条件结构以及分块所涉及的权衡取舍的多项选择题。你的推理应基于贝叶斯定理、多元高斯密度的性质以及条件化下似然函数的代数形式。\n\n在此模型中，以下哪个/哪些陈述是正确的？\n\nA. 在单点吉布斯采样下，$p(\\theta_1 \\mid \\theta_2, y_{1:n})$ 和 $p(\\theta_2 \\mid \\theta_1, y_{1:n})$ 都是高斯分布，但分块全条件分布 $p(\\theta_1,\\theta_2 \\mid y_{1:n})$ 也是一个具有闭式解均值向量和协方差矩阵的二元高斯分布。\n\nB. 对 $(\\theta_1,\\theta_2)$ 进行分块会破坏单点更新所利用的线性高斯条件结构；由于似然函数中的乘法耦合，联合全条件分布 $p(\\theta_1,\\theta_2 \\mid y_{1:n})$ 呈非高斯形式，通常需要在吉布斯采样中使用 Metropolis–Hastings (MH) 核或其他非共轭步骤。其权衡之处在于，尽管每次迭代的成本更高，但当后验分布中 $\\theta_1$ 和 $\\theta_2$ 表现出强相关性时，一个精心设计的分块更新可以降低自相关性。\n\nC. 由于先验可分解，并且数据是条件独立同分布的，因此 $\\theta_1$ 和 $\\theta_2$ 在给定 $y_{1:n}$ 的条件下保持条件独立，所以分块不会改变条件分布的代数形式，也无法提供任何潜在的混合效率增益。\n\nD. 如果在为 $\\theta_1$ 构建更新之前，先对 $\\theta_2$ 进行边缘化以获得 $p(\\theta_1 \\mid y_{1:n})$，那么得到的 $\\theta_1$ 的边缘全条件分布仍然是高斯分布，因此对 $(\\theta_1,\\theta_2)$进行分块相较于这种坍縮的替代方案没有任何优势。\n\n选择所有适用项。", "solution": "问题陈述已经过验证，被认为是合理的。它在贝叶斯计算统计学的背景下，特别是在吉布斯采样策略方面，提出了一个清晰且定义明确的问题。所有参数和分布都得到了恰当的定义，并且前提与已建立的统计理论一致。\n\n我们首先确定后验分布及其条件分布的数学形式。模型规定如下：\n似然函数：$y_i \\mid \\theta_1,\\theta_2 \\sim \\mathcal{N}(\\theta_1 \\theta_2, \\sigma^2)$，其中 $i=1, \\dots, n$。\n先验分布：$\\theta_1 \\sim \\mathcal{N}(0, \\tau_1^2)$ 且 $\\theta_2 \\sim \\mathcal{N}(0, \\tau_2^2)$，其中 $\\theta_1$ 和 $\\theta_2$ 先验独立。\n\n根据贝叶斯定理，给定数据 $y_{1:n} = (y_1, \\dots, y_n)$，$(\\theta_1, \\theta_2)$ 的联合后验分布为：\n$$\np(\\theta_1, \\theta_2 \\mid y_{1:n}) \\propto p(y_{1:n} \\mid \\theta_1, \\theta_2) \\, p(\\theta_1, \\theta_2)\n$$\n鉴于 $\\theta_1$ 和 $\\theta_2$ 的先验独立性以及 $y_i$ 的条件独立性，上式变为：\n$$\np(\\theta_1, \\theta_2 \\mid y_{1:n}) \\propto \\left( \\prod_{i=1}^n p(y_i \\mid \\theta_1, \\theta_2) \\right) p(\\theta_1) p(\\theta_2)\n$$\n代入高斯密度函数，我们得到：\n$$\np(\\theta_1, \\theta_2 \\mid y_{1:n}) \\propto \\exp\\left(-\\frac{1}{2\\sigma^2}\\sum_{i=1}^n (y_i - \\theta_1\\theta_2)^2\\right) \\exp\\left(-\\frac{\\theta_1^2}{2\\tau_1^2}\\right) \\exp\\left(-\\frac{\\theta_2^2}{2\\tau_2^2}\\right)\n$$\n对数后验分布与指数之和成正比：\n$$\n\\log p(\\theta_1, \\theta_2 \\mid y_{1:n}) = C - \\frac{1}{2\\sigma^2}\\sum_{i=1}^n (y_i - \\theta_1\\theta_2)^2 - \\frac{\\theta_1^2}{2\\tau_1^2} - \\frac{\\theta_2^2}{2\\tau_2^2}\n$$\n其中 $C$ 是一个与 $\\theta_1$ 和 $\\theta_2$无关的常数。展开平方项：\n$$\n\\log p(\\theta_1, \\theta_2 \\mid y_{1:n}) = C - \\frac{1}{2\\sigma^2}\\left(\\sum_{i=1}^n y_i^2 - 2\\theta_1\\theta_2\\sum_{i=1}^n y_i + n(\\theta_1\\theta_2)^2\\right) - \\frac{\\theta_1^2}{2\\tau_1^2} - \\frac{\\theta_2^2}{2\\tau_2^2}\n$$\n合并涉及 $\\theta_1$ 和 $\\theta_2$ 的项：\n$$\n\\log p(\\theta_1, \\theta_2 \\mid y_{1:n}) = C' + \\frac{\\sum y_i}{\\sigma^2}\\theta_1\\theta_2 - \\frac{n}{2\\sigma^2}\\theta_1^2\\theta_2^2 - \\frac{1}{2\\tau_1^2}\\theta_1^2 - \\frac{1}{2\\tau_2^2}\\theta_2^2\n$$\n四次项 $-\\frac{n}{2\\sigma^2}\\theta_1^2\\theta_2^2$ 的存在表明，对数后验分布不是 $\\theta_1$ 和 $\\theta_2$ 的二次型。因此，联合后验分布 $p(\\theta_1, \\theta_2 \\mid y_{1:n})$ **不是**一个二元高斯分布。\n\n现在我们分析单点吉布斯采样器所需的全条件分布。\n\n**1. $\\theta_1$ 的全条件分布：$p(\\theta_1 \\mid \\theta_2, y_{1:n})$**\n为求此分布，我们将对数后验看作仅关于 $\\theta_1$ 的函数，并将 $\\theta_2$ 和 $y_{1:n}$ 视为固定量。\n$$\n\\log p(\\theta_1 \\mid \\theta_2, y_{1:n}) = \\text{const} - \\frac{1}{2}\\left(\\frac{n\\theta_2^2}{\\sigma^2} + \\frac{1}{\\tau_1^2}\\right)\\theta_1^2 + \\left(\\frac{\\theta_2\\sum y_i}{\\sigma^2}\\right)\\theta_1\n$$\n这是关于 $\\theta_1$ 的二次函数，即高斯对数密度函数的形式。因此，全条件分布 $p(\\theta_1 \\mid \\theta_2, y_{1:n})$ 是一个高斯分布。\n\n**2. $\\theta_2$ 的全条件分布：$p(\\theta_2 \\mid \\theta_1, y_{1:n})$**\n根据对称性，我们将对数后验看作仅关于 $\\theta_2$ 的函数：\n$$\n\\log p(\\theta_2 \\mid \\theta_1, y_{1:n}) = \\text{const} - \\frac{1}{2}\\left(\\frac{n\\theta_1^2}{\\sigma^2} + \\frac{1}{\\tau_2^2}\\right)\\theta_2^2 + \\left(\\frac{\\theta_1\\sum y_i}{\\sigma^2}\\right)\\theta_2\n$$\n这是关于 $\\theta_2$ 的二次函数，所以全条件分布 $p(\\theta_2 \\mid \\theta_1, y_{1:n})$ 也是一个高斯分布。\n\n现在我们逐一评估每个选项。\n\n**A. 在单点吉布斯采样下，$p(\\theta_1 \\mid \\theta_2, y_{1:n})$ 和 $p(\\theta_2 \\mid \\theta_1, y_{1:n})$ 都是高斯分布，但分块全条件分布 $p(\\theta_1,\\theta_2 \\mid y_{1:n})$ 也是一个具有闭式解均值向量和协方差矩阵的二元高斯分布。**\n陈述的第一部分是正确的；如上所示，两个单点全条件分布都是高斯分布。然而，第二部分是错误的。分块全条件分布就是联合后验分布 $p(\\theta_1,\\theta_2 \\mid y_{1:n})$。从对数后验的推导可知，$\\theta_1^2\\theta_2^2$ 项的存在使得该分布为非高斯分布。\n**结论：错误。**\n\n**B. 对 $(\\theta_1,\\theta_2)$ 进行分块会破坏单点更新所利用的线性高斯条件结构；由于似然函数中的乘法耦合，联合全条件分布 $p(\\theta_1,\\theta_2 \\mid y_{1:n})$ 呈非高斯形式，通常需要在吉布斯采样中使用 Metropolis–Hastings (MH) 核或其他非共轭步骤。其权衡之处在于，尽管每次迭代的成本更高，但当后验分布中 $\\theta_1$ 和 $\\theta_2$ 表现出强相关性时，一个精心设计的分块更新可以降低自相关性。**\n该陈述准确地描述了情况。\n- “单点更新所利用的线性高斯条件结构”指的是 $p(\\theta_1 \\mid \\theta_2, y_{1:n})$ 和 $p(\\theta_2 \\mid \\theta_1, y_{1:n})$ 都是高斯分布这一事实，这使得简单高效的直接采样成为可能。\n- “对 $(\\theta_1,\\theta_2)$ 进行分块会破坏”这种简便性，因为正如我们所证明的，联合后验 $p(\\theta_1, \\theta_2 \\mid y_{1:n})$ 不是高斯分布。其原因确实是似然函数均值中的“乘法耦合” $\\theta_1\\theta_2$。\n- 从这个非标准的联合后验（“分块更新”）中采样需要一个更通用的算法，例如 Metropolis-Hastings，这使得更新步骤比从高斯分布中简单抽取在计算上更为密集。\n- 陈述的最后一部分正确地阐明了分块的标准动机：后验分布中的交叉乘积项，如 $\\theta_1\\theta_2$ 和 $\\theta_1^2\\theta_2^2$，会引起 $\\theta_1$ 和 $\\theta_2$ 之间的强相关性。在存在强后验相关性的情况下，单点吉布斯采样器的混合速度非常慢。而分块更新通过联合提出 $(\\theta_1, \\theta_2)$ 的移动，可以更有效地在相关的后验分布中移动，从而降低自相关性并加快收敛速度，这证明了其更高的单次迭代成本是合理的。\n**结论：正确。**\n\n**C. 由于先验可分解，并且数据是条件独立同分布的，因此 $\\theta_1$ 和 $\\theta_2$ 在给定 $y_{1:n}$ 的条件下保持条件独立，所以分块不会改变条件分布的代数形式，也无法提供任何潜在的混合效率增益。**\n这个陈述有根本性的缺陷。虽然 $(\\theta_1, \\theta_2)$ 的先验是独立的，但似然函数 $p(y_{1:n} \\mid \\theta_1, \\theta_2)$ 通过均值项 $\\theta_1\\theta_2$ 将参数耦合在一起。这种耦合导致了后验相关性。要使 $\\theta_1$ 和 $\\theta_2$ 在给定 $y_{1:n}$ 的条件下条件独立，它们的联合后验密度必须能分解为其边缘后验密度的乘积，即 $p(\\theta_1, \\theta_2 \\mid y_{1:n}) = p(\\theta_1 \\mid y_{1:n})p(\\theta_2 \\mid y_{1:n})$。这要求对数后验能够分离成关于 $\\theta_1$ 和 $\\theta_2$ 的函数的和。我们推导出的对数后验包含像 $\\theta_1\\theta_2$ 和 $\\theta_1^2\\theta_2^2$ 这样的交叉乘积项，证明了它不可分离。因此，$\\theta_1$ 和 $\\theta_2$ 是条件相关的。该选项的主要前提是错误的，因此其结论也是错误的。分塊之所以有益，正是因為這種引致的相關性。\n**结论：错误。**\n\n**D. 如果在为 $\\theta_1$ 构建更新之前，先对 $\\theta_2$ 进行边缘化以获得 $p(\\theta_1 \\mid y_{1:n})$，那么得到的 $\\theta_1$ 的边缘全条件分布仍然是高斯分布，因此对 $(\\theta_1,\\theta_2)$进行分块相较于这种坍縮的替代方案没有任何优势。**\n这描述了一种坍缩吉布斯采样策略。我们来检验一下边缘后验分布 $p(\\theta_1 \\mid y_{1:n})$。\n$$\np(\\theta_1 \\mid y_{1:n}) = \\int p(\\theta_1, \\theta_2 \\mid y_{1:n}) \\, d\\theta_2 \\propto p(\\theta_1) \\int p(y_{1:n} \\mid \\theta_1, \\theta_2) p(\\theta_2) \\, d\\theta_2\n$$\n积分 $\\int p(y_{1:n} \\mid \\theta_1, \\theta_2) p(\\theta_2) \\, d\\theta_2$ 是边缘似然函数 $p(y_{1:n} \\mid \\theta_1)$。\n根据我们对 $\\theta_2$ 全条件分布的分析，我们知道对于一个固定的 $\\theta_1$，$\\theta_2$ 的密度与一个高斯分布成正比。具体来说，$p(y_{1:n}, \\theta_2 \\mid \\theta_1) \\propto \\exp\\left(-\\frac{1}{2}A(\\theta_1)\\theta_2^2 + B(\\theta_1)\\theta_2\\right)$，其中 $A(\\theta_1) = \\frac{n\\theta_1^2}{\\sigma^2} + \\frac{1}{\\tau_2^2}$ 且 $B(\\theta_1) = \\frac{\\theta_1\\sum y_i}{\\sigma^2}$。\n对此式关于 $\\theta_2$ 积分，得到一个与 $(A(\\theta_1))^{-1/2} \\exp(B(\\theta_1)^2/(2A(\\theta_1)))$ 成正比的项。\n所以，$p(y_{1:n} \\mid \\theta_1) \\propto \\left(\\frac{n\\theta_1^2}{\\sigma^2} + \\frac{1}{\\tau_2^2}\\right)^{-1/2} \\exp\\left( \\frac{(\\frac{\\theta_1\\sum y_i}{\\sigma^2})^2}{2(\\frac{n\\theta_1^2}{\\sigma^2} + \\frac{1}{\\tau_2^2})} \\right)$。\n边缘后验分布为 $p(\\theta_1 \\mid y_{1:n}) \\propto p(y_{1:n} \\mid \\theta_1) p(\\theta_1)$。得到的 $p(\\theta_1 \\mid y_{1:n})$ 表达式是这个关于 $\\theta_1$ 的复杂函数与 $\\theta_1$ 的高斯先验的乘积。由于 $(\\dots)^{-1/2}$ 前置因子以及指数内部对 $\\theta_1$ 的非二次依赖关系，这显然不是一个高斯分布。边缘后验是高斯分布的前提是错误的。\n**结论：错误。**", "answer": "$$\\boxed{B}$$", "id": "3293022"}, {"introduction": "在明确了分块采样的益处之后，一个关键的实践问题随之而来：块应该设置多大？最后的这项练习通过将统计效率（通过积分自相关时间）和计算成本都建模为块大小的函数，来解决这一权衡问题。通过推导每个有效样本的期望时间，我们可以找到最小化这一关键指标的最优块大小。[@problem_id:3293038]", "problem": "考虑一个目标分布，它是一个$d$维零均值多元正态（MVN）分布，其协方差$\\Sigma$由$\\Sigma_{ij} = \\rho^{|i-j|}$给出，其中$|\\rho|  1$是一个固定的相关系数，$i,j \\in \\{1,\\dots,d\\}$。这定义了一个线性链上的平稳一阶高斯马尔可夫随机场。你实现了一个分块吉布斯采样器，它将索引集划分为大小相等（假设$k$能整除$d$）的连续不重叠的块。在每次完整扫描中，你采用一种系统性双色方案更新所有块：首先更新一种颜色的所有块，然后更新另一种颜色的所有块，更新时使用每个块在其相邻边界节点的当前值下的精确高斯条件分布。\n\n假设从其条件多元正态分布中抽取一个$k$维块的计算成本是$C k^{3}$个时间单位，其中$C  0$是一个与硬件和实现相关的常数，并且除了这个逐块更新成本外没有其他额外成本。因此，对所有块进行一次完整扫描的成本是$C \\, d \\, k^{2}$个时间单位。\n\n令$h(\\mathbf{x}) = x_{m}$为可觀測量，等于第$m$个坐标，其中$m \\in \\{1,\\dots,d\\}$是一个远离边界的固定值，以使其马尔可夫链动力学能代表内部情况。根据积分自相关时间 (IACT) $\\tau_{\\mathrm{int}}(k)$来定义分块吉布斯采样器下$h(\\mathbf{x})$的平稳马尔可夫链的有效样本量 (ESS)：对于$N$次连续的完整扫描，$\\mathrm{ESS}(k) = N / \\tau_{\\mathrm{int}}(k)$。那么，每个有效样本的期望时间是每次完整扫描的时间与IACT的乘积：$T_{\\mathrm{eff}}(k) = \\left(C \\, d \\, k^{2}\\right) \\, \\tau_{\\mathrm{int}}(k)$。\n\n从多元正态条件的基本定义和平稳一阶自回归过程的积分自相关时间的定义出发，推导在上述系统性双色分块吉布斯方案下，$T_{\\mathrm{eff}}(k)$作为$d$、$C$、$\\rho$和$k$的函数的闭式表达式。将你的最终答案表示为单个解析表达式。如果你需要引用任何无穷级数，请以闭式形式求和。不需要四舍五入，最终表达式中不应包含单位。", "solution": "用户希望我验证问题陈述，如果有效，为一个特定的分块吉布斯采样器提供关于每个有效样本的期望时间$T_{\\mathrm{eff}}(k)$的合理解答。\n\n### 问题验证\n\n**第1步：提取已知条件**\n- **目标分布**：$d$维零均值多元正态（MVN）分布，$\\mathbf{x} \\sim N(\\mathbf{0}, \\Sigma)$。\n- **协方差矩阵**：$\\Sigma_{ij} = \\rho^{|i-j|}$，其中$i,j \\in \\{1, \\dots, d\\}$，$|\\rho|  1$。这是一个线性链上的平稳一阶高斯马尔可夫随机场（GMRF）。\n- **采样器**：分块吉布斯采样器。\n- **划分**：索引集$\\{1, \\dots, d\\}$被划分为大小相等（为$k$）的连续不重叠的块。假设$k$能整除$d$。\n- **更新方案**：系统性双色方案。首先，所有“颜色1”的块被同时更新。然后，所有“颜色2”的块被同时更新，以颜色1块中的新值为条件。\n- **条件分布**：块的更新使用以其相邻边界节点为条件的精确高斯条件分布。\n- **计算成本**：抽取单个$k$维块的成本是$C k^3$。一次完整扫描的成本是$C d k^2$。\n- **可观测量**：$h(\\mathbf{x}) = x_m$，其中$m$是一个固定的内部节点。\n- **有效样本量 (ESS)**：$\\mathrm{ESS}(k) = N / \\tau_{\\mathrm{int}}(k)$，其中$N$是扫描次数，$\\tau_{\\mathrm{int}}(k)$是积分自相关时间 (IACT)。\n- **每个有效样本的期望时间**：$T_{\\mathrm{eff}}(k) = (C d k^2) \\tau_{\\mathrm{int}}(k)$。\n- **IACT 定义**：问题建议使用平稳一阶自回归过程（AR(1)）的IACT定义。\n\n**第2步：使用提取的已知条件进行验证**\n- **科学依据**：该问题在马尔可夫链蒙特卡洛（MCMC）方法理论中有坚实的基础。目标分布是一个标准模型（高斯AR(1)过程）。带有双色方案的分块吉布斯采样器是一种有效且被广泛研究的算法。对于从条件多元正态分布中采样所涉及的密集矩阵运算，其成本模型是现实的。\n- **适定性**：该问题要求基于一套清晰的定义和一个明确指定的算法，推导一个特定量$T_{\\mathrm{eff}}(k)$。预期存在一个唯一的、有意义的解。\n- **客观性**：问题以精确、客观的数学语言陈述。没有主观或基于意见的元素。\n- **完整性与一致性**：设定是自洽的。块的数量（$d/k$）、每块的成本（$Ck^3$）和每次扫描的成本（$Cdk^2$）之间的关系是一致的。假设$k$能整除$d$以及可观测量$x_m$位于内部，简化了分析，避免了整个链的边界效应。\n- **可行性**：该问题描述了一个理论计算，这在MCMC算法的分析中是标准的。它完全可行。\n- **其他缺陷**：问题不是病态的、琐碎的或同义反复的。它需要一个实质性的推导，将采样器的属性与其统计和计算效率联系起来。\n\n**第3步：结论与行动**\n问题有效。我将继续推导解答。\n\n### 解答的推导\n\n每个有效样本的期望时间由$T_{\\mathrm{eff}}(k) = (\\text{每次扫描的时间}) \\times \\tau_{\\mathrm{int}}(k)$给出。每次扫描的时间已知为$C d k^2$。问题的核心是推导积分自相关时间$\\tau_{\\mathrm{int}}(k)$。\n\n**1. 积分自相关时间 (IACT)**\n问题指出，可观测量$h(\\mathbf{x}) = x_m$的马尔可夫链动力学应被视为平稳一階自回归过程（AR(1)）。对于一个AR(1)过程$y_{t+1} = \\lambda y_t + \\epsilon_t$，滞后$\\tau$的自相关为$\\alpha(\\tau) = \\lambda^{|\\tau|}$。IACT定义为：\n$$ \\tau_{\\mathrm{int}} = 1 + 2 \\sum_{\\tau=1}^{\\infty} \\alpha(\\tau) $$\n对于AR(1)过程，这变成一个几何级数：\n$$ \\tau_{\\mathrm{int}} = 1 + 2 \\sum_{\\tau=1}^{\\infty} \\lambda^{\\tau} = 1 + 2 \\frac{\\lambda}{1-\\lambda} = \\frac{1-\\lambda+2\\lambda}{1-\\lambda} = \\frac{1+\\lambda}{1-\\lambda} $$\n参数$\\lambda$是过程的滞后-1自相关，$\\lambda = \\mathrm{Corr}(x_m^{(t+1)}, x_m^{(t)})$。对于复杂马尔可夫链中的一般可观测量，其自相关函数是对应于转移算子特征值的指数混合。问题中提示使用AR(1)公式，意味着我们应该使用系统的最慢衰减模式的自相关，它控制着长期收敛。这个“渐近”自相关由完整扫描转移算子的最大特征值（绝对值严格小于1）给出。这个特征值也称为算子（在与平稳分布正交的空间中）的谱半径。\n\n**2. 双色分块吉布斯采样器的自相关**\n我们需要确定指定采样器的谱半径$\\lambda$。该采样器每次扫描包含两个半步：\n1.  以偶数索引块中的当前值为条件，并行更新所有奇数索引的块$B_1, B_3, \\dots$。\n2.  以新更新的奇数索引块中的值为条件，并行更新所有偶数索引的块$B_2, B_4, \\dots$。\n\n目标分布是一维线性链上的一阶GMRF。这意味着任何变量$x_i$在给定其近邻$x_{i-1}$和$x_{i+1}$的条件下，与链的其余部分条件独立。因此，一个变量块$B_j = \\{x_{(j-1)k+1}, \\dots, x_{jk}\\}$在给定其边界上的两个变量：$x_{(j-1)k}$（在块$B_{j-1}$中）和$x_{jk+1}$（在块$B_{j+1}$中）的条件下，与所有其他变量条件独立。\n\n该采样器的谱半径是文献中的一个已知结果。我们可以通过考虑信息（或相关性）如何在链中传播来推断它。在平稳分布中，两个变量$x_i$和$x_j$之间的相关性是$\\rho^{|i-j|}$。\n考虑任意一个变量$x_m$。为了使其在第$t$次扫描的值$x_m^{(t)}$与在第$t+1$次扫描的值$x_m^{(t+1)}$相关，信息必须通过更新机制持续存在。\n\n假设$x_m$位于一个奇数索引的块$B_{j}$中（$j$为奇数）。\n- 在第一个半扫描中，所有奇数块都被更新。新值$x_m^{(t+1/2)}$是从以相邻偶数块$B_{j-1}^{(t)}$和$B_{j+1}^{(t)}$中的变量为条件的条件分布中抽取的。这一步有效地 xóa除了$x_m^{(t)}$的任何直接记忆；新值的期望仅是其邻居的函数。\n- 在第二个半扫描中，偶数块被更新。奇数块，包括$B_j$，保持不变。因此，$x_m^{(t+1)} = x_m^{(t+1/2)}$。\n\n因此，$x_m^{(t)}$和$x_m^{(t+1)}$之间的相关性是通过信息从$x_m^{(t)}$传递到其偶数块邻居（在时间$t$），然后在重采样步骤中返回到$x_m^{(t+1/2)}$的路径来调节的。信息必须从块$B_j$“传播”到其邻居（例如$B_{j-1}$）再返回。\n\n分析收敛速度的一个更直接的方法是考虑影响在块间的传播。\n在第一个半扫描中，奇数块之间的耦合被打破，并通过偶数块重新建立。\n在第二个半扫描中，偶数块之间的耦合被打破，并通过新更新的奇数块重新建立。\n对于一个奇数块处的扰动，要在一个完整扫描后影响其自身，它必须通过一个相邻的偶数块传播（穿越该块的最小距离是$k$个变量），然后该影响必须通过一个奇数块传播回来（另一次长度为$k$的穿越）。\n$x_i$和$x_{i+L}$之间的相关性是$\\rho^L$。穿越一个大小为$k$的块会引入一个近似为$\\rho^k$的相关衰减因子。在双色方案中，一个完整的循环涉及从一个块颜色到其自身的两次这样的穿越。这个启发式的论证表明，每次完整扫描的自相关会衰减一个因子$(\\rho^{k})^2 = \\rho^{2k}$。\n\n严格的分析证实了这一启发式观点。对于块大小为$k$的一维GMRF，双色分块吉布斯采样器的谱半径$\\lambda$由下式给出：\n$$ \\lambda = \\rho^{2k} $$\n\n**3. $T_{\\mathrm{eff}}(k)$的最终表达式**\n有了$\\lambda = \\rho^{2k}$，我们现在可以计算IACT：\n$$ \\tau_{\\mathrm{int}}(k) = \\frac{1+\\lambda}{1-\\lambda} = \\frac{1+\\rho^{2k}}{1-\\rho^{2k}} $$\n现在，我们将其代入每个有效样本期望时间的给定表达式中：\n$$ T_{\\mathrm{eff}}(k) = (C d k^2) \\tau_{\\mathrm{int}}(k) $$\n$$ T_{\\mathrm{eff}}(k) = C d k^2 \\left( \\frac{1+\\rho^{2k}}{1-\\rho^{2k}} \\right) $$\n这就是每个有效样本的期望时间作为$d$、$C$、$\\rho$和$k$的函数的最终闭式表达式。它正确地捕捉了每次扫描的计算成本（随$k$增加而增加）和每次扫描的統計效率（随$k$增加而提高，因为当$k \\to \\infty$时，$\\tau_{\\mathrm{int}}(k) \\to 1$）之间的权衡。", "answer": "$$\\boxed{C d k^{2} \\frac{1+\\rho^{2k}}{1-\\rho^{2k}}}$$", "id": "3293038"}]}