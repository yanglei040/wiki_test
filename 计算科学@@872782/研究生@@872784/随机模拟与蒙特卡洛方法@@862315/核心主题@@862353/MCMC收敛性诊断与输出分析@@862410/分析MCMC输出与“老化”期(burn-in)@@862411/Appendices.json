{"hands_on_practices": [{"introduction": "在运行马尔可夫链蒙特卡洛（MCMC）模拟并获得样本链后，首要任务是计算您的估计值及其不确定性。本练习 [@problem_id:3287635] 将指导您如何根据 MCMC 输出构建置信区间，这对于报告结果至关重要。您将看到马尔可夫链中心极限定理如何为量化估计精度提供理论基础，即使在样本存在自相关的情况下也是如此。", "problem": "一位实践者运行马尔可夫链蒙特卡罗 (MCMC) 算法，以估计在 $\\mathbb{R}$ 上的平稳目标分布 $\\pi$ 下，可测函数 $f$ 的期望 $\\mathbb{E}_{\\pi} f$。该链通过随机游走 Metropolis 转移构建，并且已知是几何遍历的。该实践者舍弃了 $B$ 次迭代的预烧期以减轻瞬态偏差，并保留了 $n$ 个预烧后样本 $\\{X_{B+1},\\dots,X_{B+n}\\}$，这些样本被假定为近似平稳的。令 $\\bar{f}_{n} = n^{-1}\\sum_{t=1}^{n} f(X_{B+t})$ 表示预烧后均值。\n\n从马尔可夫链中心极限定理以及蒙特卡罗标准误 (MCSE) 的定义（即当样本由遍历马尔可夫链生成时，在 $\\pi$ 下 $\\bar{f}_{n}$ 的抽样分布的标准差）出发，推导如何为 $\\mathbb{E}_{\\pi} f$ 构建一个考虑了自相关性的大样本置信区间。解释为什么舍弃预烧期不会改变 $\\bar{f}_{n}$ 的渐近分布，但被用于减少有限样本中的偏差。\n\n假设从 $n$ 个预烧后样本计算出的 $\\sqrt{n}(\\bar{f}_{n}-\\mathbb{E}_{\\pi} f)$ 的渐近方差的一致谱（或批次均值）估计量为 $\\hat{\\sigma}^{2}_{f} = 2.5$。再假设 $n = 10^{5}$，观测到的预烧后均值为 $\\bar{f}_{n} = 0.7321$。\n\n计算：\n- 蒙特卡罗标准误 (MCSE)。\n- 基于正态近似的 $\\mathbb{E}_{\\pi} f$ 的 $95\\%$ 置信区间。\n\n所有数值答案四舍五入至四位有效数字。不要使用百分号；通过标准正态分位数来解释 $95\\%$。", "solution": "令 $\\mu_{f} = \\mathbb{E}_{\\pi} f$ 为目标期望。我们已知基于 $n$ 个预烧后样本的 MCMC 样本均值为 $\\bar{f}_{n} = \\frac{1}{n} \\sum_{t=1}^{n} f(X_{B+t})$。\n\n首先，我们讨论置信区间的理论构建。其基础是马尔可夫链中心极限定理 (CLT)。对于一个几何遍历的马尔可夫链 $\\{X_t\\}$ 和一个满足 $\\mathbb{E}_\\pi [f(X_1)^2]  \\infty$ 的实值函数 $f$，CLT 表明：\n$$\n\\sqrt{n} (\\bar{f}_n - \\mu_f) \\xrightarrow{d} N(0, \\sigma^2_f)\n$$\n当 $n \\to \\infty$ 时，其中 $\\xrightarrow{d}$ 表示依分布收敛，$N(0, \\sigma^2_f)$ 是一个均值为 $0$、方差为 $\\sigma^2_f$ 的正态分布。渐近方差 $\\sigma^2_f$ 由下式给出：\n$$\n\\sigma^2_f = \\text{Var}_{\\pi}(f(X_1)) + 2 \\sum_{k=1}^{\\infty} \\text{Cov}_{\\pi}(f(X_1), f(X_{1+k}))\n$$\n这个表达式表明 $\\sigma^2_f$ 包含了在平稳分布 $\\pi$ 下 $f(X_1)$ 的方差，以及所有不同滞后 $k$ 的自协方差。这就是用于相依样本的 CLT 如何考虑自相关性的。如果样本是独立的，所有的协方差项都将为零，$\\sigma^2_f$ 将简化为 $\\text{Var}_{\\pi}(f(X_1))$。\n\n根据 CLT，对于大样本量 $n$，估计量 $\\bar{f}_n$ 的抽样分布可以近似为一个正态分布：\n$$\n\\bar{f}_n \\approx N\\left(\\mu_f, \\frac{\\sigma^2_f}{n}\\right)\n$$\n蒙特卡罗标准误 (MCSE) 定义为该抽样分布的标准差，即 $\\text{MCSE}(\\bar{f}_n) = \\sqrt{\\frac{\\sigma^2_f}{n}}$。为了使其可操作，我们必须从样本中估计未知的 $\\sigma^2_f$。题目中提到，一个一致的估计量 $\\hat{\\sigma}^2_f$ 是可用的（通过诸如零频率谱分析或批次均值等方法计算）。于是，估计的 MCSE 为：\n$$\n\\widehat{\\text{MCSE}}(\\bar{f}_n) = \\sqrt{\\frac{\\hat{\\sigma}^2_f}{n}} = \\frac{\\hat{\\sigma}_f}{\\sqrt{n}}\n$$\n通过对 $\\bar{f}_n$ 进行标准化，可以构建 $\\mu_f$ 的一个大样本 $(1-\\alpha) \\times 100\\%$ 置信区间：\n$$\n\\frac{\\bar{f}_n - \\mu_f}{\\widehat{\\text{MCSE}}(\\bar{f}_n)} \\approx N(0, 1)\n$$\n这导出了置信区间的公式：\n$$\n\\bar{f}_n \\pm z_{1-\\alpha/2} \\cdot \\widehat{\\text{MCSE}}(\\bar{f}_n)\n$$\n其中 $z_{1-\\alpha/2}$ 是标准正态分布的 $(1-\\alpha/2)$-分位数。\n\n其次，我们讨论预烧期的作用。舍弃最初的 $B$ 个样本不会改变 $\\bar{f}_n$ 的渐近分布。CLT 是一个当样本量 $n \\to \\infty$ 时的极限结果。任何有限数量的初始样本（如 $B$ 个预烧期样本）的影响在这个极限下变得可以忽略不计。通过 $\\sqrt{n}$ 的归一化确保了固定数量项的贡献会消失。因此，无论我们从 $t=1$ 还是 $t=B+1$ 开始求和，渐近方差 $\\sigma^2_f$ 和极限正态分布都是相同的。然而，对于有限的样本量 $n$，预烧期对于减少偏差至关重要。MCMC 链从某个初始状态 $X_0$ 开始，该状态通常不是从平稳分布 $\\pi$ 中抽取的。对于较小的 $t$，$X_t$ 的分布尚未收敛到 $\\pi$。因此，期望 $\\mathbb{E}[f(X_t) \\mid X_0]$ 不等于 $\\mu_f = \\mathbb{E}_{\\pi} f$。通过舍弃前 $B$ 次迭代（其中 $B$ 被选得足够大，以使链“忘记”其起始点，且 $X_B$ 的分布接近 $\\pi$），我们确保保留的样本 $\\{X_{B+1}, \\dots, X_{B+n}\\}$ 近似地服从分布 $\\pi$。这使得估计量 $\\bar{f}_n$ 对于 $\\mu_f$ 近似无偏，即 $\\mathbb{E}[\\bar{f}_n] \\approx \\mu_f$。如果没有预烧期，由于链初始非平稳部分的影响，估计量将遭受“瞬态偏差”。\n\n最后，我们计算所需的量。\n给定的数据是：\n- 样本量: $n = 10^5$\n- 预烧后均值: $\\bar{f}_n = 0.7321$\n- 估计的渐近方差: $\\hat{\\sigma}^2_f = 2.5$\n\n蒙特卡罗标准误 (MCSE) 估计如下：\n$$\n\\widehat{\\text{MCSE}} = \\sqrt{\\frac{\\hat{\\sigma}^2_f}{n}} = \\sqrt{\\frac{2.5}{10^5}} = \\sqrt{2.5 \\times 10^{-5}} = \\sqrt{25 \\times 10^{-6}} = 5 \\times 10^{-3} = 0.005\n$$\n四舍五入至四位有效数字，MCSE 为 $0.005000$。\n\n对于一个 $95\\%$ 的置信区间，显著性水平为 $\\alpha = 0.05$。相应的标准正态分位数为 $z_{1-\\alpha/2} = z_{0.975}$。我们使用标准值 $z_{0.975} \\approx 1.960$。\n误差范围 ($ME$) 是：\n$$\nME = z_{0.975} \\times \\widehat{\\text{MCSE}} \\approx 1.960 \\times 0.005000 = 0.009800\n$$\n$\\mathbb{E}_{\\pi} f$ 的 $95\\%$ 置信区间由 $\\bar{f}_n \\pm ME$ 给出：\n$$\n0.7321 \\pm 0.009800\n$$\n下界是：\n$$\nL = 0.7321 - 0.009800 = 0.7223\n$$\n上界是：\n$$\nU = 0.7321 + 0.009800 = 0.7419\n$$\n两个界限都已是四位有效数字。因此，$95\\%$ 置信区间为 $[0.7223, 0.7419]$。\n\n数值答案总结：\n- MCSE: $0.005000$\n- $95\\%$ CI: $[0.7223, 0.7419]$", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.005000  0.7223  0.7419 \\end{pmatrix}}\n$$", "id": "3287635"}, {"introduction": "在信任单条链得出的估计值和置信区间之前，您必须评估该链是否已真正收敛到目标平稳分布。潜在尺度缩减因子（PSRF），即 $\\hat{R}$ 统计量，是用于此目的的基石诊断工具，它通过比较多条平行链的链内变异和链间变异来进行判断。本练习 [@problem_id:3287654] 将这一强大概念扩展到多维参数情境，展示了如何同时诊断多个参数的收敛性。", "problem": "一位从业者为评估老化期后的收敛性，对一个 $p$ 维参数运行了 $m$ 条独立的马尔可夫链蒙特卡洛（MCMC）链。每条链的前 $b$ 次抽样作为老化期被丢弃，每条链剩余的 $n$ 次抽样用于估计链内和链间的变异性。\n\n设 $p=3$，$m=3$，每条链的总迭代次数为 $N_{\\text{total}}=1500$，老化期为 $b=500$，因此每条链保留 $n=1000$ 次老化期后的抽样。假设从这些老化期后的抽样中，合并的链内协方差估计量为\n$$\nW \\;=\\; \\begin{pmatrix}\n4  0  0 \\\\\n0  1  0 \\\\\n0  0  9\n\\end{pmatrix},\n$$\n且缩放的链间协方差估计量（定义为 $B = n$ 倍的 $m$ 个链均值的样本协方差）为\n$$\nB \\;=\\; \\begin{pmatrix}\n2.4  0  0 \\\\\n0  0.4  0 \\\\\n0  0  4.5\n\\end{pmatrix}.\n$$\n\n使用多链的链内协方差 $W$ 和链间协方差 $B$ 的基本定义，以及将多变量估计潜在尺度缩减因子（MPSRF）解释为在参数空间所有单位长度线性投影上的单变量潜在尺度缩减因子（PSRF）的上确界，计算老化期后抽样的 MPSRF。将最终数值答案四舍五入至四位有效数字。", "solution": "该问题要求计算多变量估计潜在尺度缩减因子（MPSRF）。问题陈述提供了一个关键的解释：MPSRF 是单变量潜在尺度缩减因子（PSRF）在 $p$ 维参数空间所有单位长度线性投影上的上确界。\n\n令 $\\theta$ 为 $p$ 维参数向量。一个线性投影定义为 $\\psi = u^T \\theta$，其中 $u$ 是一个单位长度的 $p$ 维列向量，即 $u^T u = 1$。标量投影 $\\psi$ 的单变量 PSRF，记为 $\\hat{R}_{\\psi}$，由其平方定义：\n$$ \\hat{R}_{\\psi}^2 = \\frac{\\hat{V}_{\\psi}}{W_{\\psi}} $$\n其中 $W_{\\psi}$ 是 $\\psi$ 的估计链内方差，而 $\\hat{V}_{\\psi}$ 是 $\\psi$ 的估计混合方差。\n\n给定向量 $\\theta$ 的链内协方差矩阵 $W$ 和缩放的链间协方差矩阵 $B$，投影 $\\psi$ 的相应标量方差由二次型给出：\n$$ W_{\\psi} = u^T W u $$\n$$ B_{\\psi} = u^T B u $$\n\n根据 Brooks and Gelman (1998) 建立并在贝叶斯分析中常用的现代修正混合方差估计量 $\\hat{V}_{\\psi}$，是链内和链间方差的加权和：\n$$ \\hat{V}_{\\psi} = \\frac{n-1}{n} W_{\\psi} + \\frac{m+1}{mn} B_{\\psi} $$\n此处，$n$ 是每条链的老化期后抽样数，$m$ 是链的数量。问题中提供的 $B$ 的定义，即 $n$ 乘以链均值的样本协方差，与此公式一致。\n\n将 $W_{\\psi}$、$B_{\\psi}$ 和 $\\hat{V}_{\\psi}$ 的表达式代入 $\\hat{R}_{\\psi}^2$ 的公式，得到：\n$$ \\hat{R}_{\\psi}^2 = \\frac{\\frac{n-1}{n} (u^T W u) + \\frac{m+1}{mn} (u^T B u)}{u^T W u} = \\frac{n-1}{n} + \\frac{m+1}{mn} \\frac{u^T B u}{u^T W u} $$\n\nMPSRF 是 $\\hat{R}_{\\psi}^2$ 在所有可能的单位向量 $u$ 上的上确界的平方根。\n$$ (\\text{MPSRF})^2 = \\sup_{u : u^T u = 1} \\left( \\hat{R}_{\\psi}^2 \\right) = \\sup_{u : u^T u = 1} \\left( \\frac{n-1}{n} + \\frac{m+1}{mn} \\frac{u^T B u}{u^T W u} \\right) $$\n由于项 $\\frac{n-1}{n}$ 和系数 $\\frac{m+1}{mn}$ 相对于 $u$ 是常数，求上确界需要最大化广义瑞利商 $\\frac{u^T B u}{u^T W u}$。\n$$ (\\text{MPSRF})^2 = \\frac{n-1}{n} + \\frac{m+1}{mn} \\sup_{u : u^T u = 1} \\left( \\frac{u^T B u}{u^T W u} \\right) $$\n\n广义瑞利商的上确界是广义特征值问题 $Bv = \\lambda Wv$ 的最大特征值 $\\lambda_{\\max}$。由于 $W$ 是一个协方差矩阵，并且其给定形式为对角线元素为正的对角矩阵，因此它是正定的，从而可逆。因此，这个问题等价于求矩阵 $W^{-1}B$ 的最大特征值。\n\n给定的数据是：\n- 链的数量，$m=3$。\n- 老化期后的抽样数，$n=1000$。\n- 链内协方差矩阵，$W = \\begin{pmatrix} 4  0  0 \\\\ 0  1  0 \\\\ 0  0  9 \\end{pmatrix}$。\n- 缩放的链间协方差矩阵，$B = \\begin{pmatrix} 2.4  0  0 \\\\ 0  0.4  0 \\\\ 0  0  4.5 \\end{pmatrix}$。\n\n首先，我们计算 $W$ 的逆矩阵。由于 $W$ 是一个对角矩阵，其逆矩阵是对角元素为其对角元素倒数的对角矩阵：\n$$ W^{-1} = \\begin{pmatrix} 4^{-1}  0  0 \\\\ 0  1^{-1}  0 \\\\ 0  0  9^{-1} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{4}  0  0 \\\\ 0  1  0 \\\\ 0  0  \\frac{1}{9} \\end{pmatrix} $$\n\n接下来，我们计算乘积 $W^{-1}B$：\n$$ W^{-1}B = \\begin{pmatrix} \\frac{1}{4}  0  0 \\\\ 0  1  0 \\\\ 0  0  \\frac{1}{9} \\end{pmatrix} \\begin{pmatrix} 2.4  0  0 \\\\ 0  0.4  0 \\\\ 0  0  4.5 \\end{pmatrix} $$\n$$ W^{-1}B = \\begin{pmatrix} \\frac{2.4}{4}  0  0 \\\\ 0  0.4  0 \\\\ 0  0  \\frac{4.5}{9} \\end{pmatrix} = \\begin{pmatrix} 0.6  0  0 \\\\ 0  0.4  0 \\\\ 0  0  0.5 \\end{pmatrix} $$\n对角矩阵的特征值是其对角线上的元素。特征值为 $\\lambda_1 = 0.6$，$\\lambda_2 = 0.4$，和 $\\lambda_3 = 0.5$。最大特征值是 $\\lambda_{\\max} = 0.6$。\n\n现在，我们将 $n$、$m$ 和 $\\lambda_{\\max}$ 的值代入 $(\\text{MPSRF})^2$ 的表达式中：\n$$ (\\text{MPSRF})^2 = \\frac{1000-1}{1000} + \\frac{3+1}{3 \\times 1000} \\lambda_{\\max} $$\n$$ (\\text{MPSRF})^2 = \\frac{999}{1000} + \\frac{4}{3000} (0.6) $$\n$$ (\\text{MPSRF})^2 = 0.999 + \\frac{2.4}{3000} = 0.999 + 0.0008 $$\n$$ (\\text{MPSRF})^2 = 0.9998 $$\n\n最后，MPSRF 是这个值的平方根：\n$$ \\text{MPSRF} = \\sqrt{0.9998} \\approx 0.999899995 $$\n四舍五入到四位有效数字，我们得到 $0.9999$。", "answer": "$$\n\\boxed{0.9999}\n$$", "id": "3287654"}, {"introduction": "MCMC 模拟会产生海量数据，常常超出存储容量，导致实践者通过仅保存每第 $k$ 个样本来“稀疏化”其马尔可夫链。但这种做法在统计上是有效的吗？本练习 [@problem_id:3287676] 提出了一个思想实验，在固定的存储预算下，直接比较稀疏化策略与另一种替代策略。通过推导和比较每种方法的蒙特卡洛标准误（MCSE），您将深刻理解为什么对于估计后验均值而言，丢弃样本通常是次优选择。", "problem": "考虑一次长度为 $n$ 的马尔可夫链蒙特卡洛 (MCMC) 运行，它产生一个平稳时间序列 $\\{f(X_t)\\}_{t=1}^{n}$，旨在估计 $\\mu_{\\pi}=\\mathbb{E}_{\\pi}[f(X)]$，其中 $\\pi$ 是目标分布。假设在经过 $b$ 次迭代的可选“预烧期”（burn-in）后，该链是 $\\pi$-平稳的，并且 $\\{f(X_t)\\}$ 的平稳自相关函数为 $\\rho_k=\\phi^{k}$（对于某个固定的 $\\phi\\in(0,1)$），平稳边际方差为 $\\sigma_f^{2}=\\mathrm{Var}_{\\pi}(f(X))$。你的存储预算只允许保存 $n/5$ 个 $f(X_t)$ 的原始样本，但一种无损的即时压缩方案将每个样本的存储量减少为原来的 $1/5$（因此压缩每个生成的样本符合预算）。你必须在此预算下，从以下两种估计 $\\mu_{\\pi}$ 的策略中选择一种：\n\n- 稀疏化（Thinning）：丢弃预烧期样本，然后每隔 $m$ 个值保存一个 $f(X_t)$（其中 $m\\in\\mathbb{N}$），并计算所保存值的经验平均值。\n- 压缩（Compression）：丢弃预烧期样本，并即时压缩每个预烧期后的样本 $f(X_t)$，然后计算所有预烧期后值的经验平均值。\n\n将估计量的蒙特卡洛标准误差 (MCSE) 定义为其渐近方差的平方根。利用自协方差、零频率处的谱密度和积分自相关时间的基本定义，推导两种策略的渐近 MCSE。然后，在给定的存储预算和自相关结构下，确定能使 MCSE 最小化的策略和预烧期选择，并将可实现的最小 MCSE 以 $\\sigma_f^{2}$、$\\phi$ 和 $n$ 的单个闭式解析表达式形式报告。你的最终答案必须是单个解析表达式。无需单位。不要对最终表达式进行四舍五入。", "solution": "该问题要求我们在有存储预算限制的情况下，确定在稀疏化和即时压缩两种策略中，哪种是从平稳 MCMC 时间序列估计均值 $\\mu_{\\pi} = \\mathbb{E}_{\\pi}[f(X)]$ 的最优策略。目标是最小化蒙特卡洛标准误差 (MCSE)。解决方案需要为每种策略推导 MCSE，优化各自的参数，然后比较可实现的最小 MCSE。\n\n首先，我们建立从平稳时间序列中样本均值估计量的渐近方差的通用公式。设 $\\{Y_t\\}_{t=1}^{N}$ 是一个平稳时间序列，其边际方差为 $\\mathrm{Var}(Y_t) = \\sigma^2$，自相关函数为 $\\rho_k = \\mathrm{Corr}(Y_t, Y_{t+k})$。均值的估计量为 $\\hat{\\mu} = \\frac{1}{N} \\sum_{t=1}^{N} Y_t$。根据相关数据的中心极限定理，该估计量的渐近方差由下式给出：\n$$\n\\mathrm{Var}(\\hat{\\mu}) \\approx \\frac{\\sigma^2}{N} \\tau_{eff}\n$$\n其中 $\\tau_{eff}$ 是积分自相关时间 (IACT)，定义为：\n$$\n\\tau_{eff} = 1 + 2 \\sum_{k=1}^{\\infty} \\rho_k\n$$\nMCSE 是该方差的平方根，即 $\\mathrm{MCSE}(\\hat{\\mu}) = \\sqrt{\\mathrm{Var}(\\hat{\\mu})}$。\n\n在我们的问题中，时间序列是 $\\{f(X_t)\\}$，因此我们认定 $Y_t = f(X_t)$。给定的平稳边际方差是 $\\sigma_f^2$。给定的平稳自相关函数是 $\\rho_k = \\phi^k$，其中 $\\phi \\in (0,1)$。我们可以为这种 AR(1) 相关结构计算 IACT：\n$$\n\\tau_{eff} = 1 + 2 \\sum_{k=1}^{\\infty} \\phi^k\n$$\n这是一个几何级数，其和为 $\\phi/(1-\\phi)$。\n$$\n\\tau_{eff} = 1 + 2 \\frac{\\phi}{1-\\phi} = \\frac{1-\\phi+2\\phi}{1-\\phi} = \\frac{1+\\phi}{1-\\phi}\n$$\n所以，对于一个长度为 $N$ 且具有这种自相关的平稳序列，MCSE 的平方约为：\n$$\n\\mathrm{MCSE}^2 \\approx \\frac{\\sigma_f^2}{N} \\left(\\frac{1+\\phi}{1-\\phi}\\right)\n$$\n\n现在我们分析这两种策略。两种策略都涉及从总长度为 $n$ 的运行中丢弃初始的 $b$ 个预烧期样本。预烧期后的样本数量为 $n-b$。问题指出链在此预烧期后是平稳的，并将 $b$ 作为一个待选参数。\n\n**策略 1：压缩**\n在这种策略中，我们使用所有 $N_{comp} = n-b$ 个预烧期后的样本。估计量是这 $n-b$ 个样本的经验平均值。压缩方案使我们能够在预算内存储所有这些样本。存储约束条件是，存储的样本数 ($n-b$) 乘以每个样本的成本（一个原始样本的 $1/5$）必须小于或等于预算（$n/5$ 个原始样本）。\n$$\n(n-b) \\times \\frac{1}{5} \\le \\frac{n}{5} \\implies n-b \\le n \\implies b \\ge 0\n$$\n对于任何有效的预烧长度 $b \\in [0, n)$，此约束都得到满足。\n此策略的 MCSE 平方，作为所选预烧期 $b$ 的函数，是：\n$$\n\\mathrm{MCSE}_{comp}^2(b) = \\frac{\\sigma_f^2}{N_{comp}} \\tau_{eff} = \\frac{\\sigma_f^2}{n-b} \\left(\\frac{1+\\phi}{1-\\phi}\\right)\n$$\n为了最小化 $\\mathrm{MCSE}_{comp}(b)$，我们必须最小化其平方。该表达式通过最大化分母 $n-b$ 来最小化，这意味着选择 $b$ 的最小可能值。由于问题允许我们选择任何 $b \\ge 0$（“可选预烧期”），最优选择是 $b=0$。此选择为压缩策略产生了最小的 MCSE 平方：\n$$\n\\mathrm{MCSE}_{comp,min}^2 = \\frac{\\sigma_f^2}{n} \\left(\\frac{1+\\phi}{1-\\phi}\\right)\n$$\n\n**策略 2：稀疏化**\n在这种策略中，经过 $b$ 个样本的预烧期后，我们保留每第 $m$ 个样本，其中 $m \\in \\mathbb{N}$。存储的样本数量为 $N_{thin} = \\lfloor (n-b)/m \\rfloor$，对于大的 $n$，我们近似为 $(n-b)/m$。存储预算要求 $N_{thin} \\le n/5$。\n$$\n\\frac{n-b}{m} \\le \\frac{n}{5} \\implies m \\ge \\frac{5(n-b)}{n} = 5\\left(1-\\frac{b}{n}\\right)\n$$\n稀疏化后的序列 $\\{f(X_{b+km})\\}_{k=1}^{N_{thin}}$ 也是平稳的，其边际方差为 $\\sigma_f^2$。它的自相关函数 $\\rho'_j$ 对应于原始链中 $jm$ 的延迟：\n$$\n\\rho'_j = \\rho_{jm} = \\phi^{jm} = (\\phi^m)^j\n$$\n这是另一种 AR(1) 型相关，参数为 $\\phi' = \\phi^m$。稀疏化序列的 IACT，$\\tau'_{eff}$，是：\n$$\n\\tau'_{eff} = \\frac{1+\\phi^m}{1-\\phi^m}\n$$\n稀疏化策略的 MCSE 平方，作为 $b$ 和 $m$ 的函数，是：\n$$\n\\mathrm{MCSE}_{thin}^2(b,m) = \\frac{\\sigma_f^2}{N_{thin}} \\tau'_{eff} = \\frac{\\sigma_f^2}{(n-b)/m} \\left(\\frac{1+\\phi^m}{1-\\phi^m}\\right) = \\frac{\\sigma_f^2 m}{n-b} \\left(\\frac{1+\\phi^m}{1-\\phi^m}\\right)\n$$\n为了最小化它，我们必须选择 $b \\in [0, n)$ 和一个整数 $m \\ge 5(1-b/n)$。我们来分析函数 $g(m) = m \\left(\\frac{1+\\phi^m}{1-\\phi^m}\\right)$。$g(m)$ 对 $m$ 的导数（将 $m$ 视为连续变量）是 $g'(m) = \\frac{1 - (\\phi^m)^2 + 2m \\phi^m \\ln(\\phi)}{(1-\\phi^m)^2}$。对于 $\\phi \\in (0,1)$ 和 $m \\ge 1$，分子为正，证明了 $g(m)$ 是一个对于 $m \\ge 1$ 的严格增函数。\n因此，对于任何固定的 $b$，为了最小化 $\\mathrm{MCSE}_{thin}^2$，我们应该选择满足约束的最小整数 $m$：\n$$\nm_{opt}(b) = \\left\\lceil 5\\left(1-\\frac{b}{n}\\right) \\right\\rceil\n$$\n现在我们必须找到 $b \\in [0, n)$ 的值，以最小化 $\\mathrm{MCSE}_{thin}^2(b, m_{opt}(b))$。我们来分析除了常数 $\\sigma_f^2$ 外需要最小化的项：$H(b) = \\frac{g(m_{opt}(b))}{n-b}$。\n我们在 $m_{opt}(b)$ 为常数的区间上分析 $H(b)$。对于整数 $k \\in \\{1, 2, 3, 4, 5\\}$，$m_{opt}(b) = k$ 当 $k-1  5(1-b/n) \\le k$ 时。这对应于区间 $b \\in [n(1-k/5), n(1-(k-1)/5))$。在这样的区间内，$H(b) = \\frac{g(k)}{n-b}$，它在区间的最小 $b$ 值处，即 $b = n(1-k/5)$ 处取到最小值。在这一点上，$n-b = nk/5$。$H(b)$ 在此区间内的最小值为 $\\frac{g(k)}{nk/5} = \\frac{5}{n} \\frac{g(k)}{k}$。\n因此，对 $b$ 的最小化问题简化为对 $k \\in \\{1, 2, 3, 4, 5\\}$ 最小化 $\\frac{g(k)}{k}$。\n$$\n\\frac{g(k)}{k} = \\frac{1}{k} \\cdot k \\left(\\frac{1+\\phi^k}{1-\\phi^k}\\right) = \\frac{1+\\phi^k}{1-\\phi^k}\n$$\n令 $h(k) = \\frac{1+\\phi^k}{1-\\phi^k}$。其导数为 $h'(k) = \\frac{2\\phi^k \\ln(\\phi)}{(1-\\phi^k)^2}  0$，因为 $\\phi \\in (0,1)$。因此，$h(k)$ 是 $k$ 的一个递减函数。要最小化 $\\frac{g(k)}{k}$，我们必须选择 $k$ 的最大可能值。$m_{opt}(b)=k$ 的最大值为 $k=5$，这在 $b \\in [0, n/5)$ 时发生。在 $b=0$ 时达到最小值。\n所以，最优稀疏化策略是设置 $b=0$ 和 $m=5$。稀疏化策略的最小 MCSE 平方是：\n$$\n\\mathrm{MCSE}_{thin,min}^2 = \\mathrm{MCSE}_{thin}^2(0,5) = \\frac{\\sigma_f^2 \\cdot 5}{n-0} \\left(\\frac{1+\\phi^5}{1-\\phi^5}\\right) = \\frac{5\\sigma_f^2}{n} \\left(\\frac{1+\\phi^5}{1-\\phi^5}\\right)\n$$\n\n**最优策略比较**\n我们现在比较两种策略的最小 MCSE 平方：\n$$\n\\mathrm{MCSE}_{comp,min}^2 = \\frac{\\sigma_f^2}{n} \\left(\\frac{1+\\phi}{1-\\phi}\\right) \\quad \\text{vs.} \\quad \\mathrm{MCSE}_{thin,min}^2 = \\frac{\\sigma_f^2}{n} \\cdot 5 \\left(\\frac{1+\\phi^5}{1-\\phi^5}\\right)\n$$\n比较简化为比较 $\\left(\\frac{1+\\phi}{1-\\phi}\\right)$ 和 $5 \\left(\\frac{1+\\phi^5}{1-\\phi^5}\\right)$。这等价于比较 $g(1)$ 和 $g(5)$。如前所述，$g(m)$ 对于 $m \\ge 1$ 是一个严格增函数。因此，对于 $\\phi \\in (0,1)$：\n$$\ng(5) > g(1) \\implies 5 \\left(\\frac{1+\\phi^5}{1-\\phi^5}\\right) > 1 \\left(\\frac{1+\\phi}{1-\\phi}\\right)\n$$\n这意味着 $\\mathrm{MCSE}_{thin,min}^2 > \\mathrm{MCSE}_{comp,min}^2$。\n\n采用零预烧期的压缩策略严格优于最优的稀疏化策略。因此，可实现的最小 MCSE 由 $b=0$ 的压缩策略确定。\n\n可实现的最小 MCSE 是：\n$$\n\\mathrm{MCSE}_{min} = \\sqrt{\\mathrm{MCSE}_{comp,min}^2} = \\sqrt{\\frac{\\sigma_f^2}{n}\\left(\\frac{1+\\phi}{1-\\phi}\\right)}\n$$\n这个结果证实了一个普遍原则：对于固定数量的 MCMC 迭代，稀疏化是次优的，因为它丢弃了信息。存储约束迫使稀疏化采取激进策略（大的 $m$），这会放大方差，而压缩则允许使用来自预烧期后链的所有信息，从而导致更小的方差。", "answer": "$$\n\\boxed{\\sqrt{\\frac{\\sigma_f^2}{n} \\left(\\frac{1+\\phi}{1-\\phi}\\right)}}\n$$", "id": "3287676"}]}