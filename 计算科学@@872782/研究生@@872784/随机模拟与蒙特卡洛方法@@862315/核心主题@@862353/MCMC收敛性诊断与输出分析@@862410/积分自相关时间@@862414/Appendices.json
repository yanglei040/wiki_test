{"hands_on_practices": [{"introduction": "一阶自回归 (AR(1)) 过程是模拟具有记忆效应的时间序列的基本模型，是理解马尔可夫链蒙特卡洛 (MCMC) 方法中自相关的理想起点。本练习旨在推导 AR(1) 过程的精确积分自相关时间 ($\\tau_{\\mathrm{int}}$)，并探索其中有趣的反相关情形。通过这个练习，我们将揭示负相关性如何能出人意料地提高采样效率，这是 MCMC 理论中的一个核心见解。[@problem_id:3313056]", "problem": "考虑一个由 $X_{t}=\\phi X_{t-1}+\\varepsilon_{t}$ 定义的一阶平稳自回归过程 (AR($1$))，其中 $t\\in\\mathbb{Z}$，$\\{ \\varepsilon_{t} \\}$ 是独立同分布的，且 $\\varepsilon_{t}\\sim \\mathcal{N}(0,\\sigma^{2})$，并且 $|\\phi|1$。设自协方差函数为 $\\gamma(k)=\\mathbb{E}\\!\\left[(X_{t}-\\mu)(X_{t+k}-\\mu)\\right]$，其中 $\\mu=\\mathbb{E}[X_{t}]$；归一化自相关函数为 $\\rho_{k}=\\gamma(k)/\\gamma(0)$；积分自相关时间（在马尔可夫链蒙特卡洛（MCMC）中使用）定义为\n$$\n\\tau_{\\mathrm{int}}=1+2\\sum_{k=1}^{\\infty}\\rho_{k}.\n$$\n仅从这些定义和 AR($1$) 递归式出发，推导 $\\tau_{\\mathrm{int}}$ 作为 $\\phi$ 的函数的闭式表达式，该表达式在 $|\\phi|1$ 时有效。然后，专门研究 $\\phi0$ 的情况，并证明交替符号的相关性意味着 $\\tau_{\\mathrm{int}}1$。最后，确定在极限 $\\phi\\to -1^{+}$ 的情况下 $\\tau_{\\mathrm{int}}$ 的可达到的最小值。\n\n以一个数对的形式提供你的最终答案，该数对由 $\\tau_{\\mathrm{int}}(\\phi)$ 的精确闭式表达式和当 $\\phi\\to -1^{+}$ 时的极限最小值组成。不需要四舍五入，也不涉及物理单位。", "solution": "本题要求推导平稳 AR(1) 过程的积分自相关时间 $\\tau_{\\mathrm{int}}$，并求其在极限 $\\phi\\to -1^{+}$ 下的最小值。\n\n首先，我们验证问题陈述的有效性。\n**步骤 1：提取已知条件**\n-   过程定义：一阶平稳自回归过程 (AR(1))，$X_{t}=\\phi X_{t-1}+\\varepsilon_{t}$，其中 $t\\in\\mathbb{Z}$。\n-   噪声属性：$\\{ \\varepsilon_{t} \\}$ 是独立同分布 (i.i.d.) 的，且 $\\varepsilon_{t}\\sim \\mathcal{N}(0,\\sigma^{2})$。\n-   平稳性条件：$|\\phi|1$。\n-   自协方差函数定义：$\\gamma(k)=\\mathbb{E}\\!\\left[(X_{t}-\\mu)(X_{t+k}-\\mu)\\right]$，其中 $\\mu=\\mathbb{E}[X_{t}]$。\n-   归一化自相关函数定义：$\\rho_{k}=\\gamma(k)/\\gamma(0)$。\n-   积分自相关时间定义：$\\tau_{\\mathrm{int}}=1+2\\sum_{k=1}^{\\infty}\\rho_{k}$。\n-   任务：\n    1.  推导 $\\tau_{\\mathrm{int}}$ 作为 $\\phi$ 的函数的闭式表达式。\n    2.  对于 $\\phi0$ 的情况，证明 $\\tau_{\\mathrm{int}}1$。\n    3.  确定在极限 $\\phi\\to -1^{+}$ 下 $\\tau_{\\mathrm{int}}$ 的可达到的最小值。\n    4.  最终答案应为一个数对：$\\tau_{\\mathrm{int}}(\\phi)$ 的表达式及其极限最小值。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题具有科学依据，提法恰当且客观。这是时间序列分析和蒙特卡洛方法领域的一个标准推导。所有术语都有正式定义，约束条件一致且充分，任务导向一个唯一、可验证的数学结果。该问题不违反任何无效性标准。\n\n**步骤 3：结论与行动**\n问题有效。我们继续进行求解。\n\n**推导**\n\n我们的推导分几个步骤进行：\n1.  确定过程的均值 $\\mu$。\n2.  确定自协方差函数 $\\gamma(k)$。\n3.  确定归一化自相关函数 $\\rho_{k}$。\n4.  计算总和以求得 $\\tau_{\\mathrm{int}}$。\n5.  分析在指定条件下的结果。\n\n**1. 过程的均值**\n我们对 AR(1) 方程取期望：\n$$\n\\mathbb{E}[X_{t}] = \\mathbb{E}[\\phi X_{t-1}+\\varepsilon_{t}] = \\phi\\mathbb{E}[X_{t-1}] + \\mathbb{E}[\\varepsilon_{t}]\n$$\n由于过程是平稳的，均值是常数，即 $\\mathbb{E}[X_{t}] = \\mathbb{E}[X_{t-1}] = \\mu$。根据问题陈述，我们知道 $\\mathbb{E}[\\varepsilon_{t}]=0$。将这些代入方程得到：\n$$\n\\mu = \\phi\\mu + 0\n$$\n$$\n\\mu(1-\\phi) = 0\n$$\n给定条件 $|\\phi|1$，我们有 $1-\\phi \\neq 0$。因此，过程的均值必须为 $\\mu=0$。\n\n**2. 自协方差函数 $\\gamma(k)$**\n当 $\\mu=0$ 时，自协方差函数简化为 $\\gamma(k) = \\mathbb{E}[X_{t}X_{t+k}]$。\n\n首先，我们求方差 $\\gamma(0)$：\n$$\n\\gamma(0) = \\mathbb{E}[X_t^2] = \\mathbb{E}[(\\phi X_{t-1}+\\varepsilon_{t})^2] = \\mathbb{E}[\\phi^2 X_{t-1}^2 + 2\\phi X_{t-1}\\varepsilon_t + \\varepsilon_t^2]\n$$\n$$\n\\gamma(0) = \\phi^2 \\mathbb{E}[X_{t-1}^2] + 2\\phi \\mathbb{E}[X_{t-1}\\varepsilon_t] + \\mathbb{E}[\\varepsilon_t^2]\n$$\n根据平稳性，$\\mathbb{E}[X_{t-1}^2] = \\gamma(0)$。我们已知 $\\mathbb{E}[\\varepsilon_t^2] = \\sigma^2$。过程 $X_{t-1}$ 是 $\\varepsilon_{t-1}, \\varepsilon_{t-2}, \\dots$ 的函数。由于噪声项 $\\{\\varepsilon_t\\}$ 是独立同分布的，$X_{t-1}$ 与 $\\varepsilon_t$ 无关。因此，$\\mathbb{E}[X_{t-1}\\varepsilon_t] = \\mathbb{E}[X_{t-1}]\\mathbb{E}[\\varepsilon_t] = \\mu \\cdot 0 = 0$。\n代入这些结果：\n$$\n\\gamma(0) = \\phi^2 \\gamma(0) + \\sigma^2\n$$\n$$\n\\gamma(0)(1-\\phi^2) = \\sigma^2\n$$\n$$\n\\gamma(0) = \\frac{\\sigma^2}{1-\\phi^2}\n$$\n这是良定义的，因为 $|\\phi|1$ 意味着 $1-\\phi^2 > 0$。\n\n接下来，我们求 $k \\ge 1$ 时的 $\\gamma(k)$。我们从定义 $\\gamma(k) = \\mathbb{E}[X_{t}X_{t+k}]$ 开始，并代入 $X_{t+k}$ 的 AR(1) 关系：\n$$\n\\gamma(k) = \\mathbb{E}[X_t(\\phi X_{t+k-1} + \\varepsilon_{t+k})] = \\phi\\mathbb{E}[X_t X_{t+k-1}] + \\mathbb{E}[X_t \\varepsilon_{t+k}]\n$$\n第一项是 $\\phi\\gamma(k-1)$。对于第二项，$X_t$ 是 $\\varepsilon_t, \\varepsilon_{t-1}, \\dots$ 的函数。由于 $k \\ge 1$，所以 $t+k > t$，且 $X_t$ 与 $\\varepsilon_{t+k}$ 无关。因此，$\\mathbb{E}[X_t \\varepsilon_{t+k}] = \\mathbb{E}[X_t]\\mathbb{E}[\\varepsilon_{t+k}] = \\mu \\cdot 0 = 0$。\n这导出了 AR(1) 过程的 Yule-Walker 方程：\n$$\n\\gamma(k) = \\phi\\gamma(k-1) \\quad \\text{for } k \\ge 1\n$$\n这是一个递归关系。从 $\\gamma(0)$ 开始，我们发现：\n$$\n\\gamma(1) = \\phi\\gamma(0)\n$$\n$$\n\\gamma(2) = \\phi\\gamma(1) = \\phi^2\\gamma(0)\n$$\n通过归纳法，对于任何整数 $k \\ge 0$：\n$$\n\\gamma(k) = \\phi^k \\gamma(0)\n$$\n\n**3. 归一化自相关函数 $\\rho_k$**\n归一化自相关函数定义为 $\\rho_k = \\gamma(k)/\\gamma(0)$。使用我们关于 $\\gamma(k)$ 的结果：\n$$\n\\rho_k = \\frac{\\phi^k \\gamma(0)}{\\gamma(0)} = \\phi^k\n$$\n\n**4. 积分自相关时间 $\\tau_{\\mathrm{int}}$**\n现在我们可以使用其定义来计算 $\\tau_{\\mathrm{int}}$：\n$$\n\\tau_{\\mathrm{int}} = 1 + 2\\sum_{k=1}^{\\infty}\\rho_{k} = 1 + 2\\sum_{k=1}^{\\infty}\\phi^k\n$$\n这个和是一个几何级数。由于 $|\\phi|1$，级数收敛于：\n$$\n\\sum_{k=1}^{\\infty}\\phi^k = \\frac{\\phi}{1-\\phi}\n$$\n将此代入 $\\tau_{\\mathrm{int}}$ 的表达式中：\n$$\n\\tau_{\\mathrm{int}} = 1 + 2\\left(\\frac{\\phi}{1-\\phi}\\right) = \\frac{1-\\phi}{1-\\phi} + \\frac{2\\phi}{1-\\phi} = \\frac{1-\\phi+2\\phi}{1-\\phi}\n$$\n积分自相关时间的闭式表达式为：\n$$\n\\tau_{\\mathrm{int}}(\\phi) = \\frac{1+\\phi}{1-\\phi}\n$$\n这完成了问题的第一部分。\n\n**5. 特殊情况分析**\n\n**情况 $\\phi  0$**\n当 $\\phi0$ 时，相关性 $\\rho_k=\\phi^k$ 的符号交替出现：$\\rho_10$, $\\rho_2>0$, $\\rho_30$，依此类推。我们需要证明 $\\tau_{\\mathrm{int}}1$。\n使用推导出的表达式，如果我们有 $-1  \\phi  0$：\n- 分子 $1+\\phi$ 是正的，因为 $\\phi > -1$。并且，$1+\\phi  1$。\n- 分母 $1-\\phi$ 是正的且大于 1，因为 $\\phi  0$。\n所以我们有 $0  1+\\phi  1$ 和 $1  1-\\phi  2$。\n因此，比率 $\\tau_{\\mathrm{int}} = \\frac{1+\\phi}{1-\\phi}$ 是一个小于 1 的正数。要更正式地看待这一点，$\\tau_{\\mathrm{int}}  1$ 等价于 $\\frac{1+\\phi}{1-\\phi}  1$。由于 $1-\\phi>0$，我们可以用它乘以两边而不改变不等式的方向：\n$$\n1+\\phi  1-\\phi\n$$\n$$\n2\\phi  0\n$$\n$$\n\\phi  0\n$$\n这个不等式在本情况的假设下成立，所以我们证明了对于 $\\phi  0$ 有 $\\tau_{\\mathrm{int}}  1$。这意味着反相关（对于奇数 $k$ 有 $\\rho_k0$）可以比独立抽样（$\\tau_{\\mathrm{int}}=1$）更有效，这是 MCMC 方法中的一个关键结果。\n\n**在极限 $\\phi \\to -1^{+}$ 下的最小值**\n最后，我们需要求当 $\\phi$ 从上方趋近于 $-1$ 时 $\\tau_{\\mathrm{int}}$ 的最小值。这对应于极限：\n$$\n\\lim_{\\phi\\to -1^{+}} \\tau_{\\mathrm{int}}(\\phi) = \\lim_{\\phi\\to -1^{+}} \\frac{1+\\phi}{1-\\phi}\n$$\n由于函数在 $\\phi=-1$ 处是连续的，我们可以通过直接代入来计算极限：\n$$\n\\lim_{\\phi\\to -1^{+}} \\frac{1+\\phi}{1-\\phi} = \\frac{1+(-1)}{1-(-1)} = \\frac{0}{2} = 0\n$$\n为了确认这是在区间 $(-1,1)$ 上的可达到的最小值，我们可以考察 $\\tau_{\\mathrm{int}}(\\phi)$ 关于 $\\phi$ 的导数：\n$$\n\\frac{d\\tau_{\\mathrm{int}}}{d\\phi} = \\frac{d}{d\\phi}\\left(\\frac{1+\\phi}{1-\\phi}\\right) = \\frac{(1)(1-\\phi) - (1+\\phi)(-1)}{(1-\\phi)^2} = \\frac{1-\\phi+1+\\phi}{(1-\\phi)^2} = \\frac{2}{(1-\\phi)^2}\n$$\n由于对于 $\\phi \\in (-1,1)$，导数总是正的，所以函数 $\\tau_{\\mathrm{int}}(\\phi)$ 在其整个定义域上是严格递增的。因此，其最小值在定义域的左边界处达到，即当 $\\phi \\to -1^{+}$ 时。最小值为 $0$。\n\n最终答案的两个部分是 $\\tau_{\\mathrm{int}}(\\phi)$ 的推导表达式及其在 $\\phi \\to -1^{+}$ 时的极限值。\n1.  $\\tau_{\\mathrm{int}}(\\phi) = \\frac{1+\\phi}{1-\\phi}$\n2.  $\\lim_{\\phi\\to -1^{+}} \\tau_{\\mathrm{int}}(\\phi) = 0$", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1+\\phi}{1-\\phi}  0 \\end{pmatrix}}\n$$", "id": "3313056"}, {"introduction": "与自回归模型不同，一阶移动平均 (MA(1)) 过程描述了随机扰动仅具有短暂影响的系统。通过分析这个模型，我们可以更好地理解不同的相关结构如何影响积分自相关时间，并加深对反持久性 (anti-persistence) 概念的认识。这个练习将展示如何为一个仅有单步记忆的系统计算 $\\tau_{\\mathrm{int}}$，并揭示其与 AR(1) 模型的异同。[@problem_id:3312989]", "problem": "考虑一个零均值一阶移动平均过程，定义为 $X_t=\\epsilon_t+\\theta\\,\\epsilon_{t-1}$，其中 $\\{\\epsilon_t\\}_{t\\in\\mathbb{Z}}$ 是一个白噪声序列，满足 $\\mathbb{E}[\\epsilon_t]=0$，$\\mathrm{Var}(\\epsilon_t)=\\sigma_{\\epsilon}^{2}\\in(0,\\infty)$，并且当 $t\\neq s$ 时，$\\epsilon_t$ 与 $\\epsilon_s$ 相互独立。令 $\\gamma_k=\\mathrm{Cov}(X_t,X_{t+k})$ 表示滞后 $k\\in\\mathbb{Z}$ 的自协方差函数，$\\rho_k=\\gamma_k/\\gamma_0$ 表示对应的自相关函数。该过程的积分自相关时间 (IAT)，在蒙特卡洛估计量的分析中使用，定义为 $\\tau_{\\mathrm{int}}=1+2\\sum_{k=1}^{\\infty}\\rho_k$，前提是该级数绝对收敛。\n\n任务：\n- 从白噪声给定的定义和性质出发，推导所有整数滞后 $k$ 的 $\\gamma_k$，进而得到所有整数滞后 $k$ 的 $\\rho_k$。\n- 使用你的结果计算积分自相关时间 $\\tau_{\\mathrm{int}}$，将其表示为参数 $\\theta$ 的函数。\n- 根据你得到的 $\\tau_{\\mathrm{int}}$ 表达式，确定使 $\\tau_{\\mathrm{int}}1$ 成立的 $\\theta\\in\\mathbb{R}$ 的范围，并从序列依赖性的角度对此条件给出一个简要的解释。\n\n你最终报告的答案必须是 $\\tau_{\\mathrm{int}}$ 作为 $\\theta$ 函数的单一闭式解析表达式。不需要进行数值取整。", "solution": "该问题提法恰当，并且在随机过程理论中有坚实的科学基础。我们开始进行推导。\n\n一阶移动平均过程定义为 $X_t = \\epsilon_t + \\theta \\epsilon_{t-1}$，其中 $\\{\\epsilon_t\\}$ 是一个白噪声序列，满足 $\\mathbb{E}[\\epsilon_t]=0$ 和 $\\mathrm{Var}(\\epsilon_t) = \\mathbb{E}[\\epsilon_t^2] = \\sigma_\\epsilon^2$。噪声项是相互独立的，这意味着当 $t \\neq s$ 时 $\\mathbb{E}[\\epsilon_t \\epsilon_s] = 0$。我们可以使用克罗内克 delta 符号 $\\delta_{ts}$ 将此性质概括为 $\\mathbb{E}[\\epsilon_t \\epsilon_s] = \\delta_{ts} \\sigma_\\epsilon^2$。\n\n首先，我们确认过程 $X_t$ 的均值为零：\n$$\n\\mathbb{E}[X_t] = \\mathbb{E}[\\epsilon_t + \\theta \\epsilon_{t-1}] = \\mathbb{E}[\\epsilon_t] + \\theta \\mathbb{E}[\\epsilon_{t-1}] = 0 + \\theta \\cdot 0 = 0\n$$\n\n**任务 1：自协方差函数与自相关函数的推导**\n\n滞后 $k$ 的自协方差函数是 $\\gamma_k = \\mathrm{Cov}(X_t, X_{t+k})$。由于该过程是零均值的，这可以简化为：\n$$\n\\gamma_k = \\mathbb{E}[X_t X_{t+k}] = \\mathbb{E}[(\\epsilon_t + \\theta \\epsilon_{t-1})(\\epsilon_{t+k} + \\theta \\epsilon_{t+k-1})]\n$$\n展开乘积并利用期望算子的线性性质，我们得到：\n$$\n\\gamma_k = \\mathbb{E}[\\epsilon_t \\epsilon_{t+k}] + \\theta \\mathbb{E}[\\epsilon_t \\epsilon_{t+k-1}] + \\theta \\mathbb{E}[\\epsilon_{t-1} \\epsilon_{t+k}] + \\theta^2 \\mathbb{E}[\\epsilon_{t-1} \\epsilon_{t+k-1}]\n$$\n我们对不同的整数 $k$ 值计算这个表达式。\n\n情况 1：$k=0$ (方差)\n当 $k=0$ 时，表达式变为：\n$$\n\\gamma_0 = \\mathbb{E}[\\epsilon_t \\epsilon_t] + \\theta \\mathbb{E}[\\epsilon_t \\epsilon_{t-1}] + \\theta \\mathbb{E}[\\epsilon_{t-1} \\epsilon_t] + \\theta^2 \\mathbb{E}[\\epsilon_{t-1} \\epsilon_{t-1}]\n$$\n使用性质 $\\mathbb{E}[\\epsilon_t \\epsilon_s] = \\delta_{ts} \\sigma_\\epsilon^2$：\n$$\n\\gamma_0 = \\sigma_\\epsilon^2 + \\theta \\cdot 0 + \\theta \\cdot 0 + \\theta^2 \\sigma_\\epsilon^2 = (1 + \\theta^2)\\sigma_\\epsilon^2\n$$\n\n情况 2：$k=1$ (滞后-1自协方差)\n当 $k=1$ 时，表达式变为：\n$$\n\\gamma_1 = \\mathbb{E}[\\epsilon_t \\epsilon_{t+1}] + \\theta \\mathbb{E}[\\epsilon_t \\epsilon_t] + \\theta \\mathbb{E}[\\epsilon_{t-1} \\epsilon_{t+1}] + \\theta^2 \\mathbb{E}[\\epsilon_{t-1} \\epsilon_t]\n$$\n唯一不为零的期望项是 $\\mathbb{E}[\\epsilon_t \\epsilon_t] = \\sigma_\\epsilon^2$：\n$$\n\\gamma_1 = 0 + \\theta \\sigma_\\epsilon^2 + \\theta \\cdot 0 + \\theta^2 \\cdot 0 = \\theta \\sigma_\\epsilon^2\n$$\n\n情况 3：$|k| \\ge 2$\n当 $k \\ge 2$ 时，期望项中的所有时间索引都不同：\n- $\\mathbb{E}[\\epsilon_t \\epsilon_{t+k}]$：索引相差 $k \\ge 2$。\n- $\\mathbb{E}[\\epsilon_t \\epsilon_{t+k-1}]$：索引相差 $k-1 \\ge 1$。\n- $\\mathbb{E}[\\epsilon_{t-1} \\epsilon_{t+k}]$：索引相差 $k+1 \\ge 3$。\n- $\\mathbb{E}[\\epsilon_{t-1} \\epsilon_{t+k-1}]$：索引相差 $k \\ge 2$。\n因此，所有期望项都为零。\n$$\n\\gamma_k = 0 \\quad \\text{for } k \\ge 2\n$$\n自协方差函数是对称的，即 $\\gamma_k = \\gamma_{-k}$。因此，对于所有 $|k| \\ge 2$，$\\gamma_k = 0$，并且 $\\gamma_{-1} = \\gamma_1 = \\theta \\sigma_\\epsilon^2$。\n\n总而言之，自协方差函数 $\\gamma_k$ 为：\n$$\n\\gamma_k =\n\\begin{cases}\n(1+\\theta^2)\\sigma_\\epsilon^2  \\text{if } k=0 \\\\\n\\theta\\sigma_\\epsilon^2  \\text{if } |k|=1 \\\\\n0  \\text{if } |k| \\ge 2\n\\end{cases}\n$$\n自相关函数定义为 $\\rho_k = \\gamma_k / \\gamma_0$。\n当 $k=0$ 时，$\\rho_0 = \\gamma_0 / \\gamma_0 = 1$。\n当 $|k|=1$ 时，$\\rho_1 = \\rho_{-1} = \\gamma_1 / \\gamma_0 = \\frac{\\theta \\sigma_\\epsilon^2}{(1+\\theta^2)\\sigma_\\epsilon^2} = \\frac{\\theta}{1+\\theta^2}$。\n当 $|k| \\ge 2$ 时，$\\rho_k = 0 / \\gamma_0 = 0$。\n\n总而言之，自相关函数 $\\rho_k$ 为：\n$$\n\\rho_k =\n\\begin{cases}\n1  \\text{if } k=0 \\\\\n\\frac{\\theta}{1+\\theta^2}  \\text{if } |k|=1 \\\\\n0  \\text{if } |k| \\ge 2\n\\end{cases}\n$$\n\n**任务 2：积分自相关时间的计算**\n\n积分自相关时间 $\\tau_{\\mathrm{int}}$ 由级数 $\\tau_{\\mathrm{int}} = 1 + 2 \\sum_{k=1}^{\\infty} \\rho_k$ 定义。由于对于所有 $k \\ge 2$ 都有 $\\rho_k = 0$，该无穷级数截断为一项：\n$$\n\\sum_{k=1}^{\\infty} \\rho_k = \\rho_1 + \\rho_2 + \\rho_3 + \\dots = \\rho_1 + 0 + 0 + \\dots = \\rho_1\n$$\n将此代入 $\\tau_{\\mathrm{int}}$ 的定义中：\n$$\n\\tau_{\\mathrm{int}} = 1 + 2 \\rho_1 = 1 + 2 \\left( \\frac{\\theta}{1+\\theta^2} \\right)\n$$\n我们可以将其写成一个分数：\n$$\n\\tau_{\\mathrm{int}} = \\frac{1+\\theta^2}{1+\\theta^2} + \\frac{2\\theta}{1+\\theta^2} = \\frac{1+\\theta^2+2\\theta}{1+\\theta^2} = \\frac{(1+\\theta)^2}{1+\\theta^2}\n$$\n\n**任务 3：对条件 $\\tau_{\\mathrm{int}}  1$ 的分析**\n\n我们寻求使 $\\tau_{\\mathrm{int}}  1$ 成立的 $\\theta \\in \\mathbb{R}$ 的范围。\n$$\n\\frac{(1+\\theta)^2}{1+\\theta^2}  1\n$$\n由于对于任何实数 $\\theta$，$1+\\theta^2 > 0$ 都成立，我们可以在不等式两边同时乘以 $1+\\theta^2$ 而不改变不等号的方向：\n$$\n(1+\\theta)^2  1+\\theta^2\n$$\n展开左边：\n$$\n1 + 2\\theta + \\theta^2  1 + \\theta^2\n$$\n从两边减去 $1+\\theta^2$ 得到：\n$$\n2\\theta  0\n$$\n$$\n\\theta  0\n$$\n条件 $\\tau_{\\mathrm{int}}  1$ 对所有 $\\theta \\in (-\\infty, 0)$ 都成立。\n\n解释：积分自相关时间 $\\tau_{\\mathrm{int}}$ 衡量了过程值保持相关性的有效时间步数。\n-   如果 $\\tau_{\\mathrm{int}} > 1$，则自相关之和为正 ($\\sum \\rho_k > 0$)，表明整体上存在正序列依赖性（持续性）。一个高于均值的值倾向于跟随着另一个高于均值的值。\n-   如果 $\\tau_{\\mathrm{int}} = 1$，则和为零，这是像白噪声这样的不相关过程的特征。\n-   如果 $\\tau_{\\mathrm{int}}  1$，则和为负 ($\\sum \\rho_k  0$)，表明整体上存在负序列依赖性（反持续性）。一个高于均值的值倾向于跟随着一个低于均值的值。\n\n对于 MA(1) 过程，条件 $\\tau_{\\mathrm{int}}  1$ 等价于 $2\\rho_1  0$，即 $\\rho_1  0$。由于 $\\rho_1 = \\frac{\\theta}{1+\\theta^2}$ 且 $1+\\theta^2 > 0$，$\\rho_1$ 的符号由 $\\theta$ 的符号决定。因此，$\\tau_{\\mathrm{int}}  1$ 当且仅当 $\\theta  0$。\n在 $X_t = \\epsilon_t + \\theta \\epsilon_{t-1}$ 中，$\\theta$ 的负值意味着 $t-1$ 时刻的正向冲击 $\\epsilon_{t-1}$ 对 $X_{t-1}$ 有正向贡献，但对 $X_t$ 有负向贡献。这会引发一种振荡行为，即时间序列的连续值是负相关的，这就是反持续性的含义。", "answer": "$$\\boxed{\\frac{(1+\\theta)^2}{1+\\theta^2}}$$", "id": "3312989"}, {"introduction": "虽然为简单模型推导精确的 $\\tau_{\\mathrm{int}}$ 公式具有启发性，但在实际的 MCMC 分析中，我们必须从有限的样本数据中估计 $\\tau_{\\mathrm{int}}$。这个实践将揭示一个常见但至关重要的陷阱：对负自相关项的不当处理，这会导致对统计误差的严重高估。此练习结合了分析推导和代码实现，旨在通过对比不同的估计策略，展示在处理振荡相关性时保留负相关项的重要性。[@problem_id:3313017]", "problem": "考虑一个离散时间、严平稳、各态历经、零均值的过程，其方差有限，表示为随机变量序列 $\\{X_t\\}_{t \\in \\mathbb{Z}}$，其方差为 $\\mathbb{V}[X_t] = \\gamma_0$，自协方差函数为 $\\gamma_t = \\mathbb{E}[X_0 X_t]$，归一化自相关函数为 $\\rho_t = \\gamma_t / \\gamma_0$。算术平均值 $\\,\\bar{X}_n = \\frac{1}{n}\\sum_{t=1}^n X_t\\,$ 的方差可以用适用于宽平稳过程的恒等式以 $\\gamma_t$ 表示。从这些核心定义出发，推导当 $n$ 很大时 $\\mathbb{V}[\\bar{X}_n]$ 的渐近形式，使其与 $\\gamma_0/n$ 乘以一个汇集了滞后相关性贡献的无量纲因子成正比。\n\n在马尔可夫链蒙特卡洛（MCMC）中，这个无量纲因子被称为积分自相关时间（IACT）。在实践中，人们通常通过在窗口 $m$ 处截断滞后自相关贡献的总和来估计 IACT，有时还会舍弃负滞后贡献（即在正滞后 $t \\ge 1$ 时 $\\rho_t$ 的负值）。对于振荡自相关（例如，符号交替的自相关），舍弃负贡献会在 IACT 估计中引入显著的正向偏差，因为它破坏了正项和负项之间本应发生的抵消作用。\n\n您将使用一个合成的、纯数学的自相关模型来分析这种偏差，并实现舍弃或包含负滞后贡献的估计量。\n\n定义与模型：\n- 设归一化自相关函数由 $\\rho_0 = 1$ 指定，并且对于正滞后 $t \\ge 1$，由下式指定\n$$\n\\rho_t = a^t (-1)^t,\n$$\n其中 $a \\in (0,1)$ 是一个几何衰减参数。这会产生一个符号交替的振荡自相关。\n- 设大 $n$ IACT 为在 $\\mathbb{V}[\\bar{X}_n]$ 的大 $n$ 极限下，从滞后自相关贡献的汇集中获得的、乘以 $\\gamma_0/n$ 的无量纲因子。\n- 考虑窗口大小为 $m \\in \\mathbb{N}$ 的两个有限窗口估计量：\n  1. “带符号”窗口估计量，它汇集 $t=1,\\dots,m$ 的 $\\rho_t$，并保持符号不变。\n  2. “舍弃负值”窗口估计量，它只汇集 $t=1,\\dots,m$ 范围内 $\\rho_t$ 的正值，并舍弃负值。\n\n任务：\n1. 从 $\\gamma_t$ 和 $\\rho_t$ 的定义以及用自协方差表示 $\\mathbb{V}[\\bar{X}_n]$ 的恒等式出发，将大 $n$ 无量纲因子（IACT）推导为关于 $\\rho_t$ 的无穷级数。不要假设任何快捷公式；从第一性原理出发，推导出产生大 $n$ 因子的汇集结构。\n2. 对于振荡模型 $\\rho_t = a^t (-1)^t$，通过对相关无穷级数求和，确定精确的大 $n$ IACT。将此 IACT 表示为关于 $a$ 的闭合形式。\n3. 对于有限窗口 $m$，为两种窗口估计量推导闭合形式：\n   - 汇集 $t=1,\\dots,m$ 的 $\\rho_t$ 并保持符号的“带符号”窗口估计量，\n   - 只汇集此范围内为正的 $\\rho_t$ 的“舍弃负值”窗口估计量。\n4. 解析地证明当 $\\rho_t$ 符号交替时，为何舍弃负滞后贡献会使估计量增大。您的解释必须基于交错级数中的抵消作用。\n5. 实现一个程序，对于每个测试用例 $(a,m)$，计算：\n   - 精确的大 $n$ IACT，\n   - 带符号窗口估计值，\n   - 舍弃负值窗口估计值，\n   - 绝对误差之比，定义为\n     $$\n     R(a,m) = \\frac{\\left|\\text{drop-negative}(a,m) - \\text{IACT}(a)\\right|}{\\left|\\text{signed}(a,m) - \\text{IACT}(a)\\right|},\n     $$\n     约定除零操作通过将零分母替换为一个小的正常数 $10^{-12}$ 来进行正则化。\n   比率 $R(a,m) > 1$ 表明，与舍弃负滞后贡献相比，包含它们可以减少估计量的偏差。\n\n此问题不涉及角度单位。没有出现物理单位；所有量都是无量纲的。\n\n测试套件：\n使用以下参数对 $(a,m)$：\n- $(0.9,50)$：具有强相关性和合理大窗口的正常路径，\n- $(0.7,20)$：中等强度相关性，中等窗口，\n- $(0.99,100)$：接近单位根且窗口较大的边界情况，\n- $(0.3,10)$：弱相关性，小窗口，\n- $(0.9,1)$：极端截断边界（极小窗口）。\n\n程序输出规范：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。\n- 每个测试用例的结果必须是包含四个浮点数的列表：\n  $[\\text{IACT}(a),\\ \\text{signed}(a,m),\\ \\text{drop-negative}(a,m),\\ R(a,m)]$。\n- 最终输出必须是包含这五个测试用例列表的单个列表，例如：\n  $[[v_{11},v_{12},v_{13},v_{14}],[v_{21},v_{22},v_{23},v_{24}],\\dots]$。", "solution": "用户提供的问题已经过评估，并被确定为有效。这是一个在随机模拟方法领域内定义明确、有科学依据且客观的问题。所有定义都是标准的，各项任务构成了一个基于第一性原理的严谨数学和计算练习。\n\n### 1. 大 $n$ 积分自相关时间（IACT）的推导\n\n我们从一个离散时间、严平稳、各态历经、零均值的过程 $\\{X_t\\}_{t \\in \\mathbb{Z}}$ 开始。其方差为 $\\mathbb{V}[X_t] = \\gamma_0$，自协方差为 $\\gamma_t = \\mathbb{E}[X_0 X_t]$。$n$ 个样本的算术平均值为 $\\bar{X}_n = \\frac{1}{n}\\sum_{t=1}^n X_t$。\n\n算术平均值的方差由下式给出：\n$$\n\\mathbb{V}[\\bar{X}_n] = \\mathbb{V}\\left[\\frac{1}{n}\\sum_{t=1}^n X_t\\right]\n$$\n利用方差对随机变量求和的线性性质，我们得到：\n$$\n\\mathbb{V}[\\bar{X}_n] = \\frac{1}{n^2} \\sum_{t=1}^n \\sum_{s=1}^n \\text{Cov}(X_t, X_s)\n$$\n对于平稳过程，协方差仅取决于时间滞后，$\\text{Cov}(X_t, X_s) = \\gamma_{|t-s|}$。将此代入求和式中：\n$$\n\\mathbb{V}[\\bar{X}_n] = \\frac{1}{n^2} \\sum_{t=1}^n \\sum_{s=1}^n \\gamma_{|t-s|}\n$$\n这个双重求和可以通过滞后 $k = t-s$ 重新索引。滞后 $k$ 的范围从 $-(n-1)$ 到 $n-1$。对于给定的滞后 $k$，求和中有 $n-|k|$ 对 $(t,s)$ 满足 $t-s=k$。这使我们可以将求和重写为：\n$$\n\\mathbb{V}[\\bar{X}_n] = \\frac{1}{n^2} \\sum_{k=-(n-1)}^{n-1} (n-|k|) \\gamma_k\n$$\n分配 $1/n^2$ 项：\n$$\n\\mathbb{V}[\\bar{X}_n] = \\frac{1}{n} \\sum_{k=-(n-1)}^{n-1} \\left(1 - \\frac{|k|}{n}\\right) \\gamma_k\n$$\n由于该过程是实值的，其自协方差函数是偶函数，即 $\\gamma_k = \\gamma_{-k}$。我们可以分离出 $k=0$ 的项，并合并正负滞后项：\n$$\n\\mathbb{V}[\\bar{X}_n] = \\frac{1}{n} \\left[ \\gamma_0 + 2 \\sum_{t=1}^{n-1} \\left(1 - \\frac{t}{n}\\right) \\gamma_t \\right]\n$$\n提出方差 $\\gamma_0$ 并使用归一化自相关函数 $\\rho_t = \\gamma_t / \\gamma_0$：\n$$\n\\mathbb{V}[\\bar{X}_n] = \\frac{\\gamma_0}{n} \\left[ 1 + 2 \\sum_{t=1}^{n-1} \\left(1 - \\frac{t}{n}\\right) \\rho_t \\right]\n$$\n对于一个具有可和相关性（即 $\\sum_{t=1}^\\infty |\\rho_t|  \\infty$）的过程，当 $n \\to \\infty$ 时，对于任何固定的 $t$，因子 $(1 - t/n) \\to 1$。该求和可以用其无穷对应项来近似：\n$$\n\\mathbb{V}[\\bar{X}_n] \\approx \\frac{\\gamma_0}{n} \\left( 1 + 2 \\sum_{t=1}^\\infty \\rho_t \\right) \\quad \\text{for large } n\n$$\n因此，定义为积分自相关时间（$\\tau$）的无量纲因子是：\n$$\n\\tau = 1 + 2 \\sum_{t=1}^{\\infty} \\rho_t\n$$\n\n### 2. 振荡模型的精确 IACT\n\n问题指定了模型 $\\rho_t = a^t (-1)^t = (-a)^t$ (对于 $t \\ge 1$, $a \\in (0,1)$)。我们将此代入 IACT 公式中：\n$$\n\\tau_{\\text{exact}} = 1 + 2 \\sum_{t=1}^{\\infty} (-a)^t\n$$\n该求和是一个首项为 $-a$、公比为 $-a$ 的无穷几何级数。由于 $a \\in (0,1)$，公比的绝对值 $|-a|$ 小于 1，因此级数收敛。其和由下式给出：\n$$\n\\sum_{t=1}^{\\infty} (-a)^t = \\frac{\\text{首项}}{1 - \\text{公比}} = \\frac{-a}{1 - (-a)} = \\frac{-a}{1+a}\n$$\n将此代回 $\\tau_{\\text{exact}}$ 的表达式中：\n$$\n\\tau_{\\text{exact}}(a) = 1 + 2 \\left( \\frac{-a}{1+a} \\right) = \\frac{1+a - 2a}{1+a} = \\frac{1-a}{1+a}\n$$\n\n### 3. 有限窗口估计量\n\n这两个估计量是通过在有限窗口 $m$ 处截断求和来定义的。\n\n**带符号窗口估计量**：该估计量包括直至滞后 $m$ 的所有项：\n$$\n\\tau_{\\text{signed}}(a,m) = 1 + 2 \\sum_{t=1}^{m} (-a)^t\n$$\n该求和是一个有限几何级数：$\\sum_{k=1}^m r^k = r \\frac{1-r^m}{1-r}$。令 $r=-a$：\n$$\n\\sum_{t=1}^{m} (-a)^t = (-a) \\frac{1 - (-a)^m}{1 - (-a)} = -a \\frac{1 - (-a)^m}{1+a}\n$$\n因此，该估计量为：\n$$\n\\tau_{\\text{signed}}(a,m) = 1 - \\frac{2a(1 - (-a)^m)}{1+a}\n$$\n\n**舍弃负值窗口估计量**：该估计量在直至滞后 $m$ 的求和中只包括 $\\rho_t$ 的正项。对于模型 $\\rho_t = (-a)^t$ 且 $a>0$，只有当滞后 $t$ 是偶数时，项才为正。该估计量为：\n$$\n\\tau_{\\text{drop-neg}}(a,m) = 1 + 2 \\sum_{\\substack{t=1,\\dots,m \\\\ t \\text{ is even}}} \\rho_t\n$$\n令 $t = 2k$。求和变为 $\\sum_{k=1}^{\\lfloor m/2 \\rfloor} \\rho_{2k} = \\sum_{k=1}^{\\lfloor m/2 \\rfloor} (-a)^{2k} = \\sum_{k=1}^{\\lfloor m/2 \\rfloor} (a^2)^k$。这是一个公比为 $a^2$ 的几何级数。令 $M = \\lfloor m/2 \\rfloor$。如果 $M=0$，则和为 $0$。如果 $M > 0$，则和为：\n$$\n\\sum_{k=1}^{M} (a^2)^k = a^2 \\frac{1 - (a^2)^M}{1 - a^2}\n$$\n因此，该估计量为：\n$$\n\\tau_{\\text{drop-neg}}(a,m) = 1 + 2 \\left( a^2 \\frac{1 - (a^2)^{\\lfloor m/2 \\rfloor}}{1 - a^2} \\right) \\quad \\text{for } \\lfloor m/2 \\rfloor > 0\n$$\n并且当 $\\lfloor m/2 \\rfloor = 0$（即 $m2$）时，$\\tau_{\\text{drop-neg}}(a,m) = 1$。\n\n### 4. 估计量偏差的解析解释\n\n估计量的偏差是其期望值与真实值之间的偏差。在这里，我们分析由舍弃负相关项引入的系统误差。\n\n精确的 IACT，$\\tau_{\\text{exact}} = \\frac{1-a}{1+a}$，是从求和 $S_{\\infty} = \\sum_{t=1}^\\infty \\rho_t = \\frac{-a}{1+a}$ 推导出来的。由于 $a \\in (0,1)$，该和为负。负值源于交错级数中固有的抵消作用，其中首项（$\\rho_1 = -a$）为负且绝对值最大。负滞后项（奇数 $t$）的和超过了正滞后项（偶数 $t$）的和。\n\n**带符号估计量**用一个有限部分和 $S_m = \\sum_{t=1}^m \\rho_t$ 来近似这个交错和。收敛交错级数的部分和在极限值附近振荡。误差 $|S_m - S_{\\infty}|$ 随着 $m$ 的增加而减小。这个估计量正确地捕捉了级数的基本特征：正项和负项之间的抵消。\n\n**舍弃负值估计量**是由求和 $S'_m = \\sum_{t=1}^m \\max(0, \\rho_t)$ 构造的。对于模型 $\\rho_t = (-a)^t$，这个和只包括 $t$ 为偶数时的正项 $\\rho_t$。\n$$\nS'_m = a^2 + a^4 + \\dots + a^{2\\lfloor m/2 \\rfloor}\n$$\n对于 $m \\ge 2$，这个和显然是正的。因此，估计量 $\\tau_{\\text{drop-neg}} = 1 + 2S'_m$ 总是大于 $1$。相比之下，真实值 $\\tau_{\\text{exact}} = (1-a)/(1+a)$ 总是小于 $1$。\n\n舍弃负值程序的根本缺陷在于，它试图使用一个严格为正的和（$S'_m$）来估计一个基于负和（$S_{\\infty}$）的量。通过舍弃所有负贡献，它完全破坏了定义该级数行为的关键抵消作用。这会系统地增大估计值，导致大的正偏差。带符号估计量通过保留抵消作用，为相关系统的真实底层物理学提供了远为准确的近似。误差比 $R(a,m)$ 预计会很大，这证实了带符号估计量的偏差要小得多。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes IACT estimates for a set of test cases based on an oscillatory\n    autocorrelation model.\n    \"\"\"\n    # Test cases defined in the problem statement.\n    test_cases = [\n        (0.9, 50),\n        (0.7, 20),\n        (0.99, 100),\n        (0.3, 10),\n        (0.9, 1),\n    ]\n\n    results = []\n    \n    # Small constant for regularizing division by zero.\n    epsilon = 1e-12\n\n    for a, m in test_cases:\n        # Task 2: Calculate the exact large-n IACT.\n        # tau_exact = (1 - a) / (1 + a)\n        iact_exact = (1.0 - a) / (1.0 + a)\n\n        # Task 3: Calculate the signed windowed estimator.\n        # tau_signed = 1 - (2*a*(1 - (-a)**m)) / (1 + a)\n        sum_part_signed = (2.0 * a * (1.0 - (-a)**m)) / (1.0 + a)\n        signed_estimate = 1.0 - sum_part_signed\n\n        # Task 3: Calculate the drop-negative windowed estimator.\n        # This sums only positive rho_t, which occur at even lags t.\n        # The sum is for t = 2, 4, ..., 2*M where M = m // 2.\n        # Sum = a^2 * (1 - (a^2)^M) / (1 - a^2)\n        M = m // 2\n        if M == 0:\n            sum_part_drop_neg = 0.0\n        else:\n            a_sq = a**2\n            # Geometric series sum: r * (1-r^n) / (1-r) with r=a^2, n=M\n            if (1.0 - a_sq) == 0: # Avoid division by zero if a=1\n                sum_drop_neg_terms = M * a_sq\n            else:\n                sum_drop_neg_terms = a_sq * (1.0 - a_sq**M) / (1.0 - a_sq)\n            sum_part_drop_neg = 2.0 * sum_drop_neg_terms\n        \n        drop_negative_estimate = 1.0 + sum_part_drop_neg\n\n        # Task 5: Calculate the ratio of absolute errors.\n        # R(a,m) = |drop-negative - IACT| / |signed - IACT|\n        abs_error_signed = abs(signed_estimate - iact_exact)\n        abs_error_drop_neg = abs(drop_negative_estimate - iact_exact)\n        \n        # Regularize the denominator to avoid division by zero.\n        denominator = abs_error_signed if abs_error_signed > epsilon else epsilon\n\n        error_ratio = abs_error_drop_neg / denominator\n\n        results.append([\n            iact_exact,\n            signed_estimate,\n            drop_negative_estimate,\n            error_ratio\n        ])\n\n    # Format the final output string according to the specification.\n    # [[v11,v12,v13,v14],[v21,v22,v23,v24],...]\n    case_results_str = [\n        f\"[{','.join(f'{val:.8f}' for val in res)}]\" for res in results\n    ]\n    final_output = f\"[{','.join(case_results_str)}]\"\n    \n    print(final_output)\n\nsolve()\n```", "id": "3313017"}]}