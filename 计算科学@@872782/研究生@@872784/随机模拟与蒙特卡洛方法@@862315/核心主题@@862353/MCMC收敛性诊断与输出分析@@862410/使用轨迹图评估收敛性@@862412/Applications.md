## 应用与[交叉](@entry_id:147634)学科联系

### 引言

在前面的章节中，我们已经探讨了使用[轨迹图](@entry_id:756083)（trace plots）评估[马尔可夫链蒙特卡洛](@entry_id:138779)（MCMC）收敛性的基本原理和机制。我们学习了如何通过视觉检查[轨迹图](@entry_id:756083)的平稳性、混合性以及是否存在趋势来初步判断链的收敛性能。然而，在真实世界的科学研究中，我们面临的挑战远比理想化的教学示例复杂。[后验分布](@entry_id:145605)可能呈现出崎岖的几何形态，模型可能涉及成千上万个维度，而采样算法本身也可能引入独特的行为模式。

本章的目标是超越基础的视觉检查，展示[轨迹图](@entry_id:756083)分析在多样化和跨学科应用中的强大功能和深刻内涵。我们将不再重复介绍核心概念，而是通过一系列源于实际问题的案例，探讨如何将基本原则应用于复杂的场景中。我们将看到，[轨迹图](@entry_id:756083)不仅是一种被动的观察工具，更是一种主动的诊断探针，它能引导我们进行更深入的定量分析，诊断特定的算法病症，并最终确保我们从 MCMC 模拟中得出的科学结论是可靠和可信的。本章将揭示，严谨的收敛性评估本身就是科学发现过程不可或缺的一环。

### 超越视觉检查：定量化与原则性诊断

视觉检查[轨迹图](@entry_id:756083)是收敛性评估的第一步，但它本质上是主观的。为了建立一个稳健和可复现的科学工作流，我们必须将视觉直觉转化为客观的、可量化的诊断标准。这一过程的核心思想是，如果一个 MCMC 采样器已经收敛，那么从不同（最好是过度分散的）起始点出发的多个独立链，在经过充分的预烧期（burn-in）后，其行为应该是统计上无法区分的。它们都应该在探索同一个[平稳分布](@entry_id:194199)。

这一原则催生了多种定量诊断方法。例如，当多条链的[轨迹图](@entry_id:756083)在视觉上未能重叠时，这暗示着链间的变异远大于链内的变异，表明采样器尚未收敛。著名的吉尔曼-鲁宾（Gelman-Rubin）诊断统计量（$\hat{R}$）及其变体（如分裂 $\hat{R}$）正是对这一思想的量化。它通过精确计算并比较链间和链内[方差](@entry_id:200758)，提供了一个单一的数值来判断收敛性。当 $\hat{R}$ 值接近 $1$ 时，我们就有信心认为所有链都已收敛到同一个[分布](@entry_id:182848)。因此，一个标准的诊断流程应当包括：运行多条并行链，从相对于目标后验分布呈过度分散的初始点开始；在预烧期后，检查多个标量函数的[轨迹图](@entry_id:756083)是否在视觉上平稳并相互重叠；最后，计算这些函数的 $\hat{R}$ 值，确保它们都低于一个严格的阈值（如 $1.01$）。只有当这些条件都满足时，我们才能认为预烧期是充分的 [@problem_id:3370142]。

除了评估链间的差异，我们还可以量化单条[轨迹图](@entry_id:756083)中的“趋势”。视觉上，我们可能感觉一条[轨迹图](@entry_id:756083)在缓慢漂移，但这种判断是主观的。一种更严谨的方法是将这种视觉判断操作化。例如，我们可以对[轨迹图](@entry_id:756083)的末端窗口内的样本进行分析。通过对窗口内的[标准化](@entry_id:637219)数据与归一化的时间索引进行[线性回归](@entry_id:142318)，我们可以得到一个无量纲的斜率。这个斜率的[绝对值](@entry_id:147688)就为我们提供了一个关于趋势幅度的定量度量。通过设定一个阈值，我们可以客观地判断参数[轨迹图](@entry_id:756083)是否在局部稳定，或者某个辅助诊断量（如对数[后验概率](@entry_id:153467)）是否仍在持续探索。这种方法将主观的“看起来平坦”转化为一个可检验的假设，从而增强了诊断的严谨性 [@problem_id:3289512]。

### 驾驭复杂的后验几何

MCMC 采样的许多挑战源于目标后验分布的复杂几何形态。[轨迹图](@entry_id:756083)是诊断这些几何挑战并验证解决方案有效性的关键工具。

#### 多峰性与[亚稳态](@entry_id:167515)

当[后验分布](@entry_id:145605)包含多个由低概率区域隔开的模态（峰）时，标准的 MCMC 采样器可能会被“困”在单个模态中，无法有效地探索整个[分布](@entry_id:182848)空间。这种现象被称为亚稳态或模式[粘滞](@entry_id:201265)（mode-sticking）。在这种情况下，[轨迹图](@entry_id:756083)可能会呈现出具有欺骗性的“[伪收敛](@entry_id:753836)”：链在一个模态内部[快速混合](@entry_id:274180)，使得参数的[轨迹图](@entry_id:756083)看起来非常平稳，仿佛已经收敛。然而，它实际上只探索了后验分布的一小部分，其样本均值和[方差](@entry_id:200758)会严重偏离真实值。

一个典型的例子是，当目标分布为一个[双峰分布](@entry_id:166376)，而[随机游走](@entry_id:142620) Metropolis-Hastings 算法的提议步长远小于两峰之间的距离时，链几乎不可能从一个峰跳到另一个峰。即使运行数万次迭代，[轨迹图](@entry_id:756083)看起来也可能完全平稳，但它从未访问过另一个同样重要的模态 [@problem_id:3289546]。

为了诊断这种[伪收敛](@entry_id:753836)，仅靠单链的[轨迹图](@entry_id:756083)是远远不够的。最有效的方法是运行多条从不同、过度分散的点（例如，每个模态附近）初始化的链。如果链被困在不同的模态中，它们的[轨迹图](@entry_id:756083)将收敛到不同的水平，通过视觉检查或 $\hat{R}$ 统计量可以轻易地检测到这种不一致性。此外，我们还可以定义一个“模式[指示函数](@entry_id:186820)”，例如，一个指示参数 $\theta$ 是否大于零的函数。通过绘制这个[指示函数](@entry_id:186820)的[轨迹图](@entry_id:756083)，我们可以直观地看到链是否在不同模态之间频繁切换。对于一个已收敛的链，这个[指示函数](@entry_id:186820)的[轨迹图](@entry_id:756083)应该显示出持续的跳变，其均值也应该收敛到[对应模](@entry_id:200367)态的真实概率质量 [@problem_id:3289546]。

为了克服[亚稳态](@entry_id:167515)，研究人员开发了诸如并行[回火](@entry_id:182408)（Parallel Tempering）等高级采样算法。这些算法通过在不同“温度”下运行多条链并允许它们交换状态，来促进跨越能量壁垒。在这种情况下，[轨迹图](@entry_id:756083)分析仍然至关重要。通过观察“冷链”（[目标分布](@entry_id:634522)对应的链）的模式指示函数[轨迹图](@entry_id:756083)，我们可以验证并行[回火](@entry_id:182408)是否成功地促进了模式间的遍历。理论上，我们可以基于模式切换的泊松过程模型，估算出需要多长的模拟时间才能以高概率观察到至少一次完整的“往返”旅行（例如，从模式A到B再回到A），从而为判断收敛提供了定量的指导 [@problem_id:3289516]。

#### 分层模型与“漏斗”几何

在统计学，尤其是在[生物统计学](@entry_id:266136)和心理计量学中，分层（或称多层）模型被广泛用于分析具有组别结构的数据。然而，这类模型常常导致一种被称为“漏斗”（funnel）的病态后验几何，给 MCMC 采样带来巨大挑战。

在一个典型的分层模型中，组别级别的参数 $\theta_j$ 来自一个由超参数（如[总体均值](@entry_id:175446) $\mu$ 和[总体标准差](@entry_id:188217) $\tau$）控制的总体[分布](@entry_id:182848)，例如 $\theta_j \sim \mathcal{N}(\mu, \tau^2)$。当使用这种“中心化参数化”（centered parameterization）时，$\mu$、$\tau$ 和所有的 $\theta_j$ 在后验中会产生强烈的耦合。特别是当 $\tau$ 的样本值接近零时，所有的 $\theta_j$ 都必须紧密地聚集在 $\mu$ 周围。这在 $(\mu, \tau)$ 的参数空间中形成了一个狭窄的“漏斗颈”，标准采样器很难在其中有效移动。

这种几何问题会在[轨迹图](@entry_id:756083)中留下独特的“指纹”：
*   **尺度超参数 $\tau$ 的[轨迹图](@entry_id:756083)**：显示出“[粘滞](@entry_id:201265)”行为，即链会在 $\tau \approx 0$ 的区域停留极长的时间，偶尔才爆发性地跳到较大的值。不同链的[轨迹图](@entry_id:756083)可能长时间停留在互不重叠的范围内。
*   **位置超参数 $\mu$ 的[轨迹图](@entry_id:756083)**：混合非常缓慢。当某条链的 $\tau$ 值很小时，其对应的 $\mu$ 几乎无法移动。
*   **组别参数 $\theta_j$ 的[轨迹图](@entry_id:756083)**：尽管在单条链内部可能看起来混合得很好（[轨迹图](@entry_id:756083)呈“毛茸茸”状），但不同链的[轨迹图](@entry_id:756083)会停留在不同的均值水平上，无法重叠。
*   **标准化的残差 $z_j = (\theta_j - \mu)/\tau$ 的[轨迹图](@entry_id:756083)**：与上述情况形成鲜明对比，这个派生量的[轨迹图](@entry_id:756083)通常会显示出极好的混合和跨链重叠。

观察到这些迹象，尤其是[标准化残差](@entry_id:634169) $z_j$ 的良好混合，强烈表明问题出在[参数化](@entry_id:272587)上，而非模型本身。标准的解决方案是采用“非中心化[参数化](@entry_id:272587)”（non-centered parameterization, NCP），即直接对 $z_j \sim \mathcal{N}(0,1)$ 进行采样，然后通过确定性变换 $\theta_j = \mu + \tau z_j$ 来恢复 $\theta_j$。这种重新[参数化](@entry_id:272587)的方法打破了参数间的强耦合，极大地改善了[采样效率](@entry_id:754496) [@problem_id:3289519]。

我们可以通过将视觉分析转化为量化指标来进一步证实这一点。例如，我们可以定义“慢探索”为：在预烧期后，[轨迹图](@entry_id:756083)穿越“漏斗颈”区域（如 $v = \log(\sigma)  -2.0$）的次数过少、在颈内最长停留时间过长，或[有效样本量](@entry_id:271661)（ESS）过低。通过比较中心化和非中心化[参数化](@entry_id:272587)下的这些指标，可以清楚地证明 NCP 在克服漏斗问题上的优越性 [@problem_id:3289547]。

### 算法特定的[轨迹图](@entry_id:756083)特征

不同的 MCMC 算法具有独特的运行机制和失效模式，这些都会在[轨迹图](@entry_id:756083)中留下独特的印记。因此，解读[轨迹图](@entry_id:756083)需要结合对所用算法的深刻理解。

#### Metropolis-Hastings 与 Gibbs 采样的对比

即使对于简单的模型，不同的[采样策略](@entry_id:188482)也会产生截然不同的[轨迹图](@entry_id:756083)行为。考虑一个高度相关的[二元正态分布](@entry_id:165129)目标。如果我们使用分量式 Gibbs 采样器，理论分析表明，每个分量的边际链近似为一个一阶自回归（AR(1)）过程，其自相关系数为 $\rho^2$（其中 $\rho$ 是[目标分布](@entry_id:634522)的相关系数）。因此，当 $\rho$ 接近 $1$ 时，[轨迹图](@entry_id:756083)将显示出非常高的[自相关](@entry_id:138991)性（即“长记忆性”），链穿越均值的速度非常缓慢。这种行为是可预测的，并且直接源于算法的结构。

相比之下，如果我们使用一个各项同性的[随机游走](@entry_id:142620) Metropolis-Hastings (RWMH) 算法，问题就变得不同。为了在相关性导致的最窄维度上保持合理的接受率，提议步长必须设置得非常小。这反过来又导致在最长维度上的移动极其缓慢和低效。其结果是，[轨迹图](@entry_id:756083)会呈现出“粘滞”行为和缓慢的漂移，而不是快速的探索。在这种情况下，仅仅观察到接近最优值的接受率（例如 $0.44$）并不能保证良好的混合。通过比较两种算法的[轨迹图](@entry_id:756083)叠加图，我们可以直观地评估哪种算法在该特定问题上具有更好的混合性能 [@problem_id:3289549]。

#### [哈密顿蒙特卡洛](@entry_id:144208) (HMC) 与 NUTS

[哈密顿蒙特卡洛](@entry_id:144208)（HMC）及其自适应变体 NUTS（No-U-Turn Sampler）因其在处理高维和复杂后验方面的卓越性能而广受欢迎。与 RWMH 不同，HMC 利用了[目标分布](@entry_id:634522)的梯度信息来指导其探索，这使得它能够进行远距离、高接受率的提议。这也意味着 HMC 拥有更丰富的诊断信息，这些信息同样可以通过[轨迹图](@entry_id:756083)进行监控。

除了参数本身的[轨迹图](@entry_id:756083)外，对于 HMC/NUTS，我们还必须检查一系列辅助诊断量的[轨迹图](@entry_id:756083)：
*   **能量误差 $\Delta H$**：在每次积分轨迹前后，系统[哈密顿量](@entry_id:172864)的变化。对于一个调整良好的采样器，$\Delta H$ 的[轨迹图](@entry_id:756083)应该稳定地围绕 $0$ 波动，没有系统性漂移。
*   **接受概率 $a_t$**：健康运行的采样器，其接受概率[轨迹图](@entry_id:756083)应稳定在一个较高的水平（如 $0.8$ 左右），但要避免恒等于 $1$（步长太小）或频繁跌至 $0$（步长太大）。
*   **NUTS 树深度 $D_t$**：在 NUTS 中，这反映了积分轨迹的长度。健康的[轨迹图](@entry_id:756083)应该显示 $D_t$ 在一定范围内变化，而不是持续饱和在设定的最大深度。
*   **发散性转移（Divergent Transitions）**：这是 HMC 特有的严重病症，表明[数值积分器](@entry_id:752799)在后验几何的高曲率区域变得不稳定。在[轨迹图](@entry_id:756083)中，它们通常表现为 $\Delta H$ 的巨大正向尖峰。任何发散性转移的出现都表明采样结果是不可靠的。

一个健康的 HMC 运行，其参数[轨迹图](@entry_id:756083)混合良好，同时 $\Delta H$ [轨迹图](@entry_id:756083)稳定在零附近，[接受概率](@entry_id:138494)高且稳定，无发散性转移，并且 NUTS 树深度[轨迹图](@entry_id:756083)表现出适应性变化。相反，如果总能量 $H_t$ 的[轨迹图](@entry_id:756083)出现单调漂移，或者频繁出现发散性转移，则表明采样过程存在严重问题，链远未收敛 [@problem_id:3289557]。在实践中，这些诊断对于处理像“漏斗”这样的病态几何至关重要，因为不当的参数设置（如步长或质量矩阵）很容易导致大量的发散性转移，从而使收敛性诊断（如 $\hat{R}$ 或 ESS）显示出极差的结果 [@problem_id:3289571]。

### 交叉学科应用与前沿背景

[轨迹图](@entry_id:756083)分析的原则和技术在众多科学与工程领域中都扮演着核心角色，它们是连接理论模型与实验数据的桥梁。

#### 计算材料科学

在计算材料科学中，模拟原子或分子系统的行为通常涉及探索一个维度极高且极其“崎岖”的[势能面](@entry_id:147441)。这个[势能面](@entry_id:147441)充满了由高能量壁垒隔开的多个亚稳态盆地，每个盆地对应于一种不同的材料构象或相。在这种情况下，MCMC 模拟的主要挑战是确保采样器不会被困在单个能量盆地中，而是能够充分探索所有重要的低能构象。

能量[轨迹图](@entry_id:756083)是诊断这一问题的首要工具。如果一条链被困在一个亚稳态盆地中，其能量[轨迹图](@entry_id:756083)将显示为在一个特定的能量值附近长时间的平稳波动（平台期），很少或根本没有向其他能量水平的跳跃。当使用多条从不同初始构象开始的链时，如果它们被困在不同的盆地中，它们的能量[轨迹图](@entry_id:756083)就会稳定在不同的平台水平上，这是一个混合不良的明确信号。

为了更定量地分析这种模式，我们可以使用“排序图”（rank plots）。通过汇集所有链中某个结构序参量（如键角或[配位数](@entry_id:143221)）的样本值，并计算每个样本在整个样本池中的排序，我们可以为每个链创建一个排序[直方图](@entry_id:178776)。如果所有链都已收敛并充分混合，那么每个链的排序[直方图](@entry_id:178776)都应该是近似均匀的。相反，如果不同的链被困在对应不同序参量值的盆地中，它们的排序[直方图](@entry_id:178776)将集中在不同的、不相交的区间内，从而清晰地揭示出模式捕获问题 [@problem_id:3463600]。

#### 机器学习与大规模数据

在[现代机器学习](@entry_id:637169)中，贝叶斯方法被用于量化复杂模型（如深度神经网络）的不确定性。然而，由于数据集通常非常庞大，传统的 MCMC 方法计算成本过高。随机梯度 MCMC 算法，如[随机梯度朗之万动力学](@entry_id:755466)（SGLD），应运而生。这类算法在每一步只使用一小批（minibatch）数据来估计梯度的，从而极大地提高了[计算效率](@entry_id:270255)。

这也引入了一个独特的诊断挑战：SGLD 产生的参数[轨迹图](@entry_id:756083)本身就充满了噪声，这种噪声源于梯度的随机估计。我们如何区分这种固有的、良性的随机[梯度噪声](@entry_id:165895)与真正的、有害的[非平稳性](@entry_id:180513)或收敛失败？简单地观察[轨迹图](@entry_id:756083)的“平坦性”是不可靠的。

一种严谨的方法是分析[轨迹图](@entry_id:756083)在不同时间尺度上的变异。我们可以将预烧期后的[轨迹图](@entry_id:756083)分成若干个连续的块（chunks）。如果链是平稳的，那么由采样噪声引起的块内[方差](@entry_id:200758)，与由[长期漂移](@entry_id:172399)引起的块间均值[方差](@entry_id:200758)之间应该存在一种特定的关系。我们可以构建一个类似于 $\hat{R}$ 的比率，来比较这两种[方差](@entry_id:200758)。如果块间[方差](@entry_id:200758)相对于块内[方差](@entry_id:200758)异常大，则表明存在一个时间尺度比单个块更长的漂移，这是[非平稳性](@entry_id:180513)的信号。此外，我们还可以通过对块均值序列进行 t 检验或对运行均值序列进行[回归分析](@entry_id:165476)来直接检测趋势。通过结合这些定量诊断，我们可以更可靠地判断一个充满噪声的 SGLD [轨迹图](@entry_id:756083)是否真正达到了平稳采样状态 [@problem_id:3289532]。

#### 高维问题

在许多现代科学应用中，例如[地球科学](@entry_id:749876)中的[数据同化](@entry_id:153547)或基因组学中的建模，[参数空间](@entry_id:178581)的维度可能达到数千甚至数百万。在这种高维背景下，逐一检查每个参数的[轨迹图](@entry_id:756083)是不现实的。一个常见的[启发式](@entry_id:261307)做法是，将参数投影到由[后验协方差矩阵](@entry_id:753631)的主成分（PCs）定义的低维[子空间](@entry_id:150286)上，然后只检查前几个（即[方差](@entry_id:200758)最大的）主成分的[轨迹图](@entry_id:756083)是否收敛。

然而，这种做法存在巨大的风险。一个 MCMC 链可能在主导变化方向（前几个主成分）上混合得很好，但在某个[方差](@entry_id:200758)很小（“隐藏”的）方向上混合得极差。考虑一个例子，其中一个主成分对应的[特征值](@entry_id:154894)非常小，这意味着后验在该方向上非常窄。如果采样器对这个方向的提议步长也设置不当（例如过小），链将几乎无法在该方向上移动。此时，前几个主成分的[轨迹图](@entry_id:756083)和 $\hat{R}$ 值可能都显示完美收敛，但整个链实际上并未收敛，因为它未能探索这个“困难”的维度。这个例子严酷地提醒我们，仅凭部分维度的收敛证据来断定整体收敛是不可靠的，可能会导致错误的科学结论 [@problem_id:3289510]。

#### [计算系统生物学](@entry_id:747636)

在[计算系统生物学](@entry_id:747636)中，研究人员使用[常微分方程](@entry_id:147024)（ODE）等机理模型来描述复杂的生物通路，如[信号转导级联](@entry_id:156085)。一个核心任务是利用实验数据来选择最佳模型并估计其参数。这个过程通常涉及比较多个候选模型。诸如 AIC、BIC、WAIC 和 DIC 等[信息准则](@entry_id:636495)被广泛用于此目的。

在这个宏大的科学工作流中，MCMC 收敛性评估扮演着一个至关重要的、不可或缺的“质量控制”角色。无论是基于最大似然估计的 AIC/BIC，还是基于贝叶斯后验样本的 WAIC/DIC，其计算都依赖于一个前提：我们已经准确地找到了后验分布的模态（对于 MLE）或充分地探索了整个后验分布（对于 MCMC）。如果 MCMC 链没有收敛，那么从中计算出的 WAIC 或 [DIC](@entry_id:171176) 将是毫无意义的，基于它们进行的[模型选择](@entry_id:155601)也将是不可靠的。

因此，一个完整的、可复现的[计算系统生物学](@entry_id:747636)工作流，在计算任何[信息准则](@entry_id:636495)之前，必须包括一个严格的[收敛诊断](@entry_id:137754)步骤。这包括运行多条 MCMC 链，检查 $\hat{R}$ 和[有效样本量](@entry_id:271661)，并仔细审查关键参数和派生量的[轨迹图](@entry_id:756083)。此外，还必须进行[参数可辨识性](@entry_id:197485)分析，因为一个含有不可辨识参数的模型本身就是有缺陷的。将收敛性评估置于模型选择和[科学推断](@entry_id:155119)的上下文中，凸显了其作为确保最终结论有效性的基础性地位 [@problem_id:3326819]。

### 解释中的细微差别

[轨迹图](@entry_id:756083)分析看似简单，但其正确解释需要对 MCMC 理论有细致的理解。以下是一些需要特别注意的关键点。

#### 变换的角色

为了便于视觉评估，我们常常对参数的[轨迹图](@entry_id:756083)进行变换。例如，对于一个严格为正的参数（如[方差](@entry_id:200758)），我们通常会绘制其[对数变换](@entry_id:267035)后的[轨迹图](@entry_id:756083)。[对数变换](@entry_id:267035)可以压缩尺度，使得原本看起来波动剧烈的[轨迹图](@entry_id:756083)变得更平稳，或使一个[偏态分布](@entry_id:175811)看起来更对称。

重要的是要理解，一个连续且可逆的（双射）变换，如[对数变换](@entry_id:267035)或[仿射变换](@entry_id:144885)（[线性缩放](@entry_id:197235)和平移），并不会改变链的根本收敛状态。如果原始参数的链 $\{\Theta_t\}$ 收敛到了其平稳分布，那么变换后的链 $\{g(\Theta_t)\}$ 也必然同时收敛到了其对应的平稳分布。一个链不可能已经收敛而另一个没有。因此，[轨迹图](@entry_id:756083)在视觉上的“平坦性”或“美观性”本身并不是收敛的直接证据。

不同的变换确实会影响[轨迹图](@entry_id:756083)的其他属性。例如，仿射变换保持了[自相关](@entry_id:138991)结构不变，而像对数这样的[非线性变换](@entry_id:636115)则会改变[自相关](@entry_id:138991)性。理解这一点有助于我们避免被视觉假象误导，并专注于评估链是否真正探索了整个[平稳分布](@entry_id:194199)，无论我们选择在哪个[坐标系](@entry_id:156346)下观察它 [@problem_id:3289526]。

#### 边际[轨迹图](@entry_id:756083)的不足

也许对[轨迹图](@entry_id:756083)最常见的误解是，认为只要所有单个参数（边际）的[轨迹图](@entry_id:756083)看起来都平稳了，整个 MCMC 链（[联合分布](@entry_id:263960)）就收敛了。这种想法是危险的，而且常常是错误的。

一个 MCMC 链可能在参数空间的某些“[慢流形](@entry_id:151421)”上缓慢漂移。在这种情况下，单个参数的边际[轨迹图](@entry_id:756083)可能看起来完全平稳，因为它们在[流形](@entry_id:153038)上的投影变化很小。然而，参数之间的特定组合（即[流形](@entry_id:153038)本身）却在系统性地演化。一个例子是，当 MCMC 在一个二维环形高概率区域上缓慢旋转时，两个[笛卡尔坐标](@entry_id:167698)的边际[轨迹图](@entry_id:756083)可能看起来像稳定的[振荡](@entry_id:267781)，但它们的极角却在单调增加。只有通过监控一个合适的辅助量，如对数[后验概率](@entry_id:153467)或本例中的极角，才能发现这种隐藏的[非平稳性](@entry_id:180513) [@problem_id:3289512]。正如在高维问题的讨论中看到的，这种隐藏的慢混合模式也可能发生在低[方差](@entry_id:200758)的主成分方向上 [@problem_id:3289510]。

因此，一个稳健的诊断策略绝不能仅仅依赖于检查单个参数的[轨迹图](@entry_id:756083)。必须同时监控能够反映链在[联合分布](@entry_id:263960)中整体位置的全局量，例如对数[后验概率](@entry_id:153467)密度，以及任何根据问题背景认为可能存在慢混合模式的派生量。

#### 稀疏化的正确使用

最后，关于稀疏化（thinning），即每隔 $k$ 次迭代才保留一个样本，存在一个普遍的误解。有人认为稀疏化可以“改善”收敛性或减少样本的偏差。这是完全错误的。

稀疏化是一个后处理步骤，它通过丢弃样本来减少存储需求和降低所保留样本的[自相关](@entry_id:138991)性。它不能创造信息，也不能修复一个未能充分探索后验分布的采样器。如果一条链被困在一个局部模态中，那么无论你如何稀疏化它，所有保留下来的样本仍将来自那个模态。稀疏化无法解决[伪收敛](@entry_id:753836)问题 [@problem_id:3289546]。

从[统计效率](@entry_id:164796)的角度看，对于计算[后验均值](@entry_id:173826)等积分量，使用所有未稀疏化的样本总是最优的。丢弃样本会减少[有效样本量](@entry_id:271661)，从而增加[估计量的方差](@entry_id:167223)。处理自相关的正确方法是在计算估计量的不确定性（如[置信区间](@entry_id:142297)）时，通过估算[积分自相关时间](@entry_id:637326)来对样本数量进行有效调整。因此，所有收敛性诊断都应该在稀疏化之前，对完整的链进行。稀疏化应该仅仅被看作是应对存储或计算瓶颈的实用工具，而非一种统计修正手段 [@problem_id:3370142]。