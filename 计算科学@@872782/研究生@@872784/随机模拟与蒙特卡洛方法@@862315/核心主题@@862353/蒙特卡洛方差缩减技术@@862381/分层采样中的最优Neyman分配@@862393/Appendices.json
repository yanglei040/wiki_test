{"hands_on_practices": [{"introduction": "为了在分层抽样中实现最高的估计精度，关键在于如何智慧地在不同层之间分配我们的抽样资源。奈曼分配 (Neyman allocation) 为此提供了一个理论上最优的解决方案，它将更多的样本分配给规模更大、内部差异也更大的层。本练习将引导你从基本原理出发，为一个具体的人群数据集计算最优样本分配方案，并量化其所能达到的最小方差。[@problem_id:3324923]", "problem": "一个研究团队计划在随机模拟和蒙特卡洛方法的背景下，使用分层抽样进行一次分层蒙特卡洛调查，以估计总体均值。总体被划分为 $H=4$ 个层，各层的大小为 $\\left(N_{h}\\right)=\\left(1000,2000,500,1500\\right)$，对应的层标准差为 $\\left(S_{h}\\right)=\\left(2,5,1,3\\right)$。总抽样预算为固定的抽样次数 $n=400$，且各层的单位抽样成本相等。令 $N=\\sum_{h=1}^{H}N_{h}$ 且 $W_{h}=N_{h}/N$ 表示层权重。\n\n从第一性原理出发，考虑在每层中进行独立简单随机抽样的情况下，总体均值的标准无偏分层估计量。在大总体情景下，当有限总体校正相对于层的大小可以忽略不计时，分层均值估计量的方差可以很好地用各层贡献的总和来近似，并且该方差依赖于样本在各层间的分配 $\\left(n_{h}\\right)$。推导在约束条件 $\\sum_{h=1}^{H}n_{h}=n$ 下使此方差最小化的分配 $\\left(n_{h}^{*}\\right)$，然后根据给定数据计算这个最优分配。使用最小化分配，以闭式解的形式计算得到的最小方差。\n\n在你的推导中，仅使用分层估计的定义、期望的线性性质以及独立层之间方差的可加性作为基本依据。假设各层中单位抽样成本相等，并忽略有限总体校正。将你的最终分配向量 $\\left(n_{1}^{*},n_{2}^{*},n_{3}^{*},n_{4}^{*}\\right)$ 和最小化方差精确地表示为有理数。不要四舍五入。最终答案必须以单个行向量的形式给出，该向量包含四个分配项，后跟方差值。", "solution": "所述问题在科学上是合理的、提法是适定的、客观的且内部一致。问题提供了所有必要的数据和约束，足以推导出唯一且有意义的解。该问题是分层抽样理论中优化的一个标准应用。因此，该问题是有效的，并将提供解答。\n\n目标是在总样本量 $n$ 固定的约束下，找到使分层均值估计量的方差最小化的样本分配 $(n_1, n_2, n_3, n_4)$。\n\n首先，我们定义关键量。总总体被划分为 $H$ 个层。令 $N_h$ 为第 $h$ 层的规模，$N = \\sum_{h=1}^{H} N_h$ 为总总体规模。层权重定义为 $W_h = N_h / N$。总体均值 $\\mu$ 可以表示为层均值 $\\mu_h$ 的加权平均：\n$$\n\\mu = \\sum_{h=1}^{H} \\frac{N_h}{N} \\mu_h = \\sum_{h=1}^{H} W_h \\mu_h\n$$\n总体均值的分层估计量 $\\hat{\\mu}_{st}$ 是通过从每层 $h$ 中抽取一个大小为 $n_h$ 的简单随机样本并计算样本均值 $\\bar{y}_h$ 来构造的。该估计量为：\n$$\n\\hat{\\mu}_{st} = \\sum_{h=1}^{H} W_h \\bar{y}_h\n$$\n该估计量是无偏的。利用期望的线性性质以及层内样本均值 $\\bar{y}_h$ 是层均值 $\\mu_h$ 的无偏估计量（即 $E[\\bar{y}_h] = \\mu_h$）这一事实：\n$$\nE[\\hat{\\mu}_{st}] = E\\left[\\sum_{h=1}^{H} W_h \\bar{y}_h\\right] = \\sum_{h=1}^{H} W_h E[\\bar{y}_h] = \\sum_{h=1}^{H} W_h \\mu_h = \\mu\n$$\n分层估计量的方差是基于各层间样本的独立性推导出来的。这使得和的方差等于方差的和：\n$$\nV(\\hat{\\mu}_{st}) = V\\left(\\sum_{h=1}^{H} W_h \\bar{y}_h\\right) = \\sum_{h=1}^{H} V(W_h \\bar{y}_h) = \\sum_{h=1}^{H} W_h^2 V(\\bar{y}_h)\n$$\n从一个大小为 $N_h$、标准差为 $S_h$ 的层中抽取的样本均值 $\\bar{y}_h$ 的方差由 $V(\\bar{y}_h) = \\frac{S_h^2}{n_h} \\left(1 - \\frac{n_h}{N_h}\\right)$ 给出，其中项 $\\left(1 - \\frac{n_h}{N_h}\\right)$ 是有限总体校正（FPC）。问题指明要忽略 FPC，这等同于假设抽样是有放回的，或者抽样比 $n_h/N_h$ 可以忽略不计。这得出了近似式：\n$$\nV(\\bar{y}_h) \\approx \\frac{S_h^2}{n_h}\n$$\n因此，待最小化的方差，我们记为 $V$，是：\n$$\nV(n_1, \\dots, n_H) = \\sum_{h=1}^{H} \\frac{W_h^2 S_h^2}{n_h}\n$$\n优化问题是在总样本量 $n$ 固定的约束下，最小化该方差：\n$$\n\\text{Minimize} \\quad V = \\sum_{h=1}^{H} \\frac{W_h^2 S_h^2}{n_h} \\quad \\text{subject to} \\quad \\sum_{h=1}^{H} n_h = n\n$$\n我们使用拉格朗日乘子法。拉格朗日函数 $\\mathcal{L}$ 是：\n$$\n\\mathcal{L}(n_1, \\dots, n_H, \\lambda) = \\sum_{h=1}^{H} \\frac{W_h^2 S_h^2}{n_h} + \\lambda \\left(\\sum_{h=1}^{H} n_h - n\\right)\n$$\n为求最小值，我们将关于每个 $n_h$ 的偏导数设为零：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial n_h} = -\\frac{W_h^2 S_h^2}{n_h^2} + \\lambda = 0 \\quad \\implies \\quad n_h^2 = \\frac{W_h^2 S_h^2}{\\lambda}\n$$\n假设 $W_h, S_h, n_h$ 均为正数，我们取正平方根：\n$$\nn_h = \\frac{W_h S_h}{\\sqrt{\\lambda}}\n$$\n这表明最优分配 $n_h^*$ 与 $W_h S_h$ 成正比。为求 $\\sqrt{\\lambda}$ 的值，我们使用约束条件 $\\sum n_h = n$：\n$$\n\\sum_{h=1}^{H} n_h = \\sum_{h=1}^{H} \\frac{W_h S_h}{\\sqrt{\\lambda}} = \\frac{1}{\\sqrt{\\lambda}} \\sum_{h=1}^{H} W_h S_h = n\n$$\n解出 $\\sqrt{\\lambda}$：\n$$\n\\sqrt{\\lambda} = \\frac{\\sum_{j=1}^{H} W_j S_j}{n}\n$$\n将此结果代回 $n_h$ 的表达式中，我们得到最优分配，即所谓的奈曼分配：\n$$\nn_h^* = \\frac{W_h S_h}{\\left( \\frac{\\sum_{j=1}^{H} W_j S_j}{n} \\right)} = n \\frac{W_h S_h}{\\sum_{j=1}^{H} W_j S_j}\n$$\n由于 $W_h = N_h/N$，这等价于 $n_h^* = n \\frac{N_h S_h}{\\sum_{j=1}^{H} N_j S_j}$。\n\n现在，我们将此应用于给定数据：\n$H=4$, $n=400$。\n层大小：$(N_h) = (1000, 2000, 500, 1500)$。\n层标准差：$(S_h) = (2, 5, 1, 3)$。\n\n首先，计算每层的乘积 $N_h S_h$：\n$N_1 S_1 = 1000 \\times 2 = 2000$。\n$N_2 S_2 = 2000 \\times 5 = 10000$。\n$N_3 S_3 = 500 \\times 1 = 500$。\n$N_4 S_4 = 1500 \\times 3 = 4500$。\n\n总和为 $\\sum_{h=1}^{4} N_h S_h = 2000 + 10000 + 500 + 4500 = 17000$。\n\n现在，我们计算最优分配 $n_h^*$：\n$n_1^* = n \\frac{N_1 S_1}{\\sum N_j S_j} = 400 \\times \\frac{2000}{17000} = 400 \\times \\frac{2}{17} = \\frac{800}{17}$。\n$n_2^* = n \\frac{N_2 S_2}{\\sum N_j S_j} = 400 \\times \\frac{10000}{17000} = 400 \\times \\frac{10}{17} = \\frac{4000}{17}$。\n$n_3^* = n \\frac{N_3 S_3}{\\sum N_j S_j} = 400 \\times \\frac{500}{17000} = 400 \\times \\frac{5}{170} = 400 \\times \\frac{1}{34} = \\frac{200}{17}$。\n$n_4^* = n \\frac{N_4 S_4}{\\sum N_j S_j} = 400 \\times \\frac{4500}{17000} = 400 \\times \\frac{45}{170} = 400 \\times \\frac{9}{34} = \\frac{1800}{17}$。\n\n最优分配向量 $(n_h^*)$ 为 $\\left(\\frac{800}{17}, \\frac{4000}{17}, \\frac{200}{17}, \\frac{1800}{17}\\right)$。\n\n接下来，我们通过将 $n_h^*$ 代入方差公式来计算最小化方差 $V_{min}$：\n$$\nV_{min} = \\sum_{h=1}^{H} \\frac{W_h^2 S_h^2}{n_h^*} = \\sum_{h=1}^{H} \\frac{W_h^2 S_h^2}{n \\frac{W_h S_h}{\\sum_{j} W_j S_j}} = \\sum_{h=1}^{H} \\frac{W_h S_h (\\sum_{j} W_j S_j)}{n} = \\frac{(\\sum_{h} W_h S_h)(\\sum_{j} W_j S_j)}{n} = \\frac{1}{n}\\left(\\sum_{h=1}^{H} W_h S_h\\right)^2\n$$\n为了计算这个值，我们首先需要层权重 $W_h$。\n总总体大小 $N = 1000 + 2000 + 500 + 1500 = 5000$。\n$W_1 = 1000/5000 = 1/5$。\n$W_2 = 2000/5000 = 2/5$。\n$W_3 = 500/5000 = 1/10$。\n$W_4 = 1500/5000 = 3/10$。\n\n现在计算总和 $\\sum_{h=1}^{4} W_h S_h$：\n$\\sum W_h S_h = \\left(\\frac{1}{5} \\times 2\\right) + \\left(\\frac{2}{5} \\times 5\\right) + \\left(\\frac{1}{10} \\times 1\\right) + \\left(\\frac{3}{10} \\times 3\\right)$\n$= \\frac{2}{5} + 2 + \\frac{1}{10} + \\frac{9}{10} = \\frac{4}{10} + \\frac{20}{10} + \\frac{1}{10} + \\frac{9}{10} = \\frac{34}{10} = \\frac{17}{5}$。\n\n最后，计算最小方差：\n$$\nV_{min} = \\frac{1}{n}\\left(\\sum_{h=1}^{4} W_h S_h\\right)^2 = \\frac{1}{400}\\left(\\frac{17}{5}\\right)^2 = \\frac{1}{400} \\times \\frac{289}{25} = \\frac{289}{10000}\n$$\n最优分配为 $(n_1^*, n_2^*, n_3^*, n_4^*) = \\left(\\frac{800}{17}, \\frac{4000}{17}, \\frac{200}{17}, \\frac{1800}{17}\\right)$，得到的最小方差为 $\\frac{289}{10000}$。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{800}{17}  \\frac{4000}{17}  \\frac{200}{17}  \\frac{1800}{17}  \\frac{289}{10000} \\end{pmatrix}}\n$$", "id": "3324923"}, {"introduction": "掌握了奈曼分配的计算方法后，一个自然的问题是：它究竟比其他分配方法好多少？本练习将奈曼最优分配与另一种常见且直观的方法——比例分配 (proportional allocation)——进行正面比较。通过计算并对比两种策略下的估计方差，你将亲手量化奈曼分配在提升蒙特卡洛积分效率方面的优势。[@problem_id:3324878]", "problem": "考虑通过分层抽样对量 $I=\\mathbb{E}[g(X)]$ 进行蒙特卡洛（MC）积分。假设样本空间被划分为 $H=4$ 个层，由 $h\\in\\{1,2,3,4\\}$ 索引，各层的已知概率为 $p_h$，给定该层时 $g(X)$ 的已知条件标准差为 $\\sigma_h$。在每个层 $h$ 内，您将从给定层 $h$ 的 $X$ 的条件分布中抽取 $n_h$ 个独立样本，计算条件样本均值 $\\bar{Y}_h$，并构建分层估计量 $\\hat{I}=\\sum_{h=1}^{H}p_h\\,\\bar{Y}_h$。假设层与层之间以及每层内部的样本都是独立的。\n\n从期望、方差和独立性下样本均值方差的基本定义出发，从第一性原理推导出在约束条件 $\\sum_{h=1}^{H} n_h=n$ 下使 $\\hat{I}$ 的方差最小化的样本分配 $\\{n_h\\}_{h=1}^{H}$。利用此结果计算当 $H=4$，$(p_h)=(0.1,0.2,0.3,0.4)$，$(\\sigma_h)=(10,2,1,4)$ 且总样本量 $n=1000$ 时的最优分配。\n\n然后计算在该最优分配下 $\\hat{I}$ 的方差，并将其与比例分配 $n_h=n\\,p_h$ 下的方差进行比较。通过单一比率 $R=\\mathrm{Var}_{\\text{proportional}}(\\hat{I})/\\mathrm{Var}_{\\text{optimal}}(\\hat{I})$ 来量化这一比较。\n\n将您最终报告的比率 $R$ 四舍五入到四位有效数字。答案以无单位的纯数表示。", "solution": "问题要求推导蒙特卡洛积分中分层抽样的最优样本分配，将其应用于一个具体案例，并将所得方差与比例分配下的方差进行比较。我们将首先从基本原理出发推导通用公式。\n\n令我们感兴趣的量为 $I=\\mathbb{E}[g(X)]$。$I$ 的分层估计量由 $\\hat{I}=\\sum_{h=1}^{H}p_h\\,\\bar{Y}_h$ 给出，其中 $p_h$ 是一个观测值落入层 $h$ 的概率，而 $\\bar{Y}_h$ 是从层 $h$ 内抽取的 $n_h$ 个独立同分布的 $Y=g(X)$ 样本的样本均值。\n\n第一步是求估计量 $\\hat{I}$ 的方差。鉴于从不同层抽取的样本是独立的，和的方差等于方差的和：\n$$\n\\mathrm{Var}(\\hat{I}) = \\mathrm{Var}\\left(\\sum_{h=1}^{H}p_h\\,\\bar{Y}_h\\right) = \\sum_{h=1}^{H}\\mathrm{Var}(p_h\\,\\bar{Y}_h)\n$$\n由于每个 $p_h$ 都是已知常数，它可以作为平方项从方差算子中提出：\n$$\n\\mathrm{Var}(\\hat{I}) = \\sum_{h=1}^{H}p_h^2\\,\\mathrm{Var}(\\bar{Y}_h)\n$$\n项 $\\bar{Y}_h$ 是从层 $h$ 中抽取的 $n_h$ 个独立样本的样本均值。令 $\\sigma_h^2$ 为层 $h$ 内 $g(X)$ 的方差，即 $\\sigma_h^2 = \\mathrm{Var}(g(X)|X \\in \\text{stratum } h)$。样本均值的方差是单个观测值的方差除以样本容量：\n$$\n\\mathrm{Var}(\\bar{Y}_h) = \\frac{\\sigma_h^2}{n_h}\n$$\n将此代入 $\\mathrm{Var}(\\hat{I})$ 的表达式，得到我们希望最小化的目标函数：\n$$\nV(n_1, n_2, \\dots, n_H) = \\mathrm{Var}(\\hat{I}) = \\sum_{h=1}^{H}\\frac{p_h^2\\,\\sigma_h^2}{n_h}\n$$\n最小化受制于总样本量固定为 $n$ 的约束条件：\n$$\n\\sum_{h=1}^{H}n_h = n\n$$\n我们使用拉格朗日乘数法来解决这个约束优化问题。拉格朗日函数 $\\mathcal{L}$ 为：\n$$\n\\mathcal{L}(n_1, \\dots, n_H, \\lambda) = \\sum_{h=1}^{H}\\frac{p_h^2\\,\\sigma_h^2}{n_h} + \\lambda\\left(\\left(\\sum_{h=1}^{H}n_h\\right) - n\\right)\n$$\n为了找到最小值，我们对 $\\mathcal{L}$ 关于每个 $n_h$ 求偏导数并令其为零：\n$$\n\\frac{\\partial\\mathcal{L}}{\\partial n_h} = -\\frac{p_h^2\\,\\sigma_h^2}{n_h^2} + \\lambda = 0\n$$\n对每个 $h \\in \\{1, 2, \\dots, H\\}$。这意味着：\n$$\n\\frac{p_h^2\\,\\sigma_h^2}{n_h^2} = \\lambda \\implies n_h^2 = \\frac{p_h^2\\,\\sigma_h^2}{\\lambda} \\implies n_h = \\frac{p_h\\,\\sigma_h}{\\sqrt{\\lambda}}\n$$\n我们通过将 $n_h$ 的这个表达式代入约束方程来求解拉格朗日乘数 $\\lambda$：\n$$\n\\sum_{h=1}^{H}n_h = \\sum_{h=1}^{H}\\frac{p_h\\,\\sigma_h}{\\sqrt{\\lambda}} = n\n$$\n$$\n\\frac{1}{\\sqrt{\\lambda}}\\sum_{h=1}^{H}p_h\\,\\sigma_h = n \\implies \\frac{1}{\\sqrt{\\lambda}} = \\frac{n}{\\sum_{k=1}^{H}p_k\\,\\sigma_k}\n$$\n将此结果代回 $n_h$ 的表达式，我们得到最优分配，即所谓的奈曼分配：\n$$\nn_h = p_h\\,\\sigma_h \\left( \\frac{n}{\\sum_{k=1}^{H}p_k\\,\\sigma_k} \\right) = n \\frac{p_h\\,\\sigma_h}{\\sum_{k=1}^{H}p_k\\,\\sigma_k}\n$$\n此公式表明，一个层中的最优样本数量与该层的概率及其标准差的乘积成正比。\n\n现在，我们将此结果应用于给定的具体案例：$H=4$，总样本量 $n=1000$，$(p_h)=(0.1,0.2,0.3,0.4)$，以及 $(\\sigma_h)=(10,2,1,4)$。\n首先，我们计算分母项 $\\sum_{k=1}^{4}p_k\\,\\sigma_k$：\n$$\n\\sum_{k=1}^{4}p_k\\,\\sigma_k = p_1\\sigma_1 + p_2\\sigma_2 + p_3\\sigma_3 + p_4\\sigma_4\n$$\n$$\n\\sum_{k=1}^{4}p_k\\,\\sigma_k = (0.1)(10) + (0.2)(2) + (0.3)(1) + (0.4)(4) = 1.0 + 0.4 + 0.3 + 1.6 = 3.3\n$$\n现在我们计算最优分配 $\\{n_h\\}$：\n$$\nn_1 = 1000 \\frac{(0.1)(10)}{3.3} = \\frac{1000}{3.3} \\approx 303.03\n$$\n$$\nn_2 = 1000 \\frac{(0.2)(2)}{3.3} = \\frac{400}{3.3} \\approx 121.21\n$$\n$$\nn_3 = 1000 \\frac{(0.3)(1)}{3.3} = \\frac{300}{3.3} \\approx 90.91\n$$\n$$\nn_4 = 1000 \\frac{(0.4)(4)}{3.3} = \\frac{1600}{3.3} \\approx 484.85\n$$\n这些是理论上的最优（非整数）样本量。对于后续的方差计算，我们将使用这些精确的分数形式的分配，这是理论比较中的标准做法。\n\n接下来，我们计算在该最优分配下 $\\hat{I}$ 的方差。将最优 $n_h$ 的公式代入方差表达式：\n$$\n\\mathrm{Var}_{\\text{optimal}}(\\hat{I}) = \\sum_{h=1}^{H}\\frac{p_h^2\\,\\sigma_h^2}{n_h} = \\sum_{h=1}^{H}\\frac{p_h^2\\,\\sigma_h^2}{n \\frac{p_h\\,\\sigma_h}{\\sum_{k=1}^{H}p_k\\,\\sigma_k}} = \\sum_{h=1}^{H}\\frac{p_h\\,\\sigma_h \\left(\\sum_{k=1}^{H}p_k\\,\\sigma_k\\right)}{n}\n$$\n$$\n\\mathrm{Var}_{\\text{optimal}}(\\hat{I}) = \\frac{\\left(\\sum_{k=1}^{H}p_k\\,\\sigma_k\\right)}{n} \\sum_{h=1}^{H}p_h\\,\\sigma_h = \\frac{\\left(\\sum_{h=1}^{H}p_h\\,\\sigma_h\\right)^2}{n}\n$$\n使用我们计算出的和 $\\sum p_h\\sigma_h = 3.3$ 和 $n=1000$：\n$$\n\\mathrm{Var}_{\\text{optimal}}(\\hat{I}) = \\frac{(3.3)^2}{1000} = \\frac{10.89}{1000} = 0.01089\n$$\n现在，我们计算比例分配下的方差，其中 $n_h = n\\,p_h$。\n方差公式仍然是 $\\mathrm{Var}(\\hat{I}) = \\sum_{h=1}^{H}\\frac{p_h^2\\,\\sigma_h^2}{n_h}$。代入 $n_h = n\\,p_h$：\n$$\n\\mathrm{Var}_{\\text{proportional}}(\\hat{I}) = \\sum_{h=1}^{H}\\frac{p_h^2\\,\\sigma_h^2}{n\\,p_h} = \\sum_{h=1}^{H}\\frac{p_h\\,\\sigma_h^2}{n} = \\frac{1}{n}\\sum_{h=1}^{H}p_h\\,\\sigma_h^2\n$$\n我们计算项 $\\sum_{h=1}^{4}p_h\\,\\sigma_h^2$：\n$$\n\\sum_{h=1}^{4}p_h\\,\\sigma_h^2 = p_1\\sigma_1^2 + p_2\\sigma_2^2 + p_3\\sigma_3^2 + p_4\\sigma_4^2\n$$\n$$\n\\sum_{h=1}^{4}p_h\\,\\sigma_h^2 = (0.1)(10^2) + (0.2)(2^2) + (0.3)(1^2) + (0.4)(4^2)\n$$\n$$\n\\sum_{h=1}^{4}p_h\\,\\sigma_h^2 = (0.1)(100) + (0.2)(4) + (0.3)(1) + (0.4)(16) = 10 + 0.8 + 0.3 + 6.4 = 17.5\n$$\n所以，比例分配下的方差是：\n$$\n\\mathrm{Var}_{\\text{proportional}}(\\hat{I}) = \\frac{17.5}{1000} = 0.0175\n$$\n最后，我们计算比率 $R = \\mathrm{Var}_{\\text{proportional}}(\\hat{I})/\\mathrm{Var}_{\\text{optimal}}(\\hat{I})$：\n$$\nR = \\frac{0.0175}{0.01089} \\approx 1.6069788797...\n$$\n将此结果四舍五入到四位有效数字，得到 $1.607$。", "answer": "$$\\boxed{1.607}$$", "id": "3324878"}, {"introduction": "在理论模型中，我们常常假设获取每个样本的成本是均等的，但这在现实世界的调查中很少成立。本练习引入了可变抽样成本这一重要约束，要求你在固定的总预算下推导成本约束的奈曼分配公式。此外，通过一个极限思想实验，你将探索当某个层的抽样成本变得极其高昂时，最优分配策略会如何调整，从而加深对成本在抽样设计中作用的直观理解。[@problem_id:3324873]", "problem": "一个有限总体被划分为 $L \\geq 2$ 个层，各层的大小为 $N_{1}, \\ldots, N_{L}$，总体大小为 $N = \\sum_{h=1}^{L} N_{h}$。在第 $h$ 层内，目标变量的标准差 $S_{h} \\in (0, \\infty)$ 是有限的正数，层权重 $W_{h} = N_{h}/N \\in (0,1)$。假设我们从每层 $h$ 中抽取一个大小为 $n_{h} \\in (0, \\infty)$ 的独立无放回简单随机样本（SRSWOR），每单位的抽样成本为 $c_{h} \\in (0, \\infty)$。总成本受固定预算 $C > 0$ 的限制，因此 $\\sum_{h=1}^{L} c_{h} n_{h} = C$。假设 $N_{h}$ 相对于 $n_{h}$ 足够大，因此在设计优化时可以忽略有限总体校正。\n\n回顾一下，在无放回简单随机抽样和可忽略的有限总体校正下，总体均值的分层估计量的方差由下式给出\n$$\n\\operatorname{Var}(\\hat{\\mu}) \\approx \\sum_{h=1}^{L} \\frac{W_{h}^{2} S_{h}^{2}}{n_{h}}.\n$$\n将 $\\{W_{h}, S_{h}, c_{h}\\}_{h=1}^{L}$ 和 $C$ 视为已知的、确定性的设计输入。考虑选择 $\\{n_{h}\\}_{h=1}^{L}$ 以最小化 $\\operatorname{Var}(\\hat{\\mu})$ 的约束优化问题，其约束条件为成本约束以及对所有 $h$ 都有 $n_{h} > 0$。\n\n从上述方差公式和成本约束出发，推导该问题的一阶最优性条件，并求解它们以获得最优分配 $\\{n_{h}^{*}\\}_{h=1}^{L}$ 关于 $\\{W_{h}, S_{h}, c_{h}\\}_{h=1}^{L}$ 和 $C$ 的封闭形式表达式。然后，对于某个选定的层索引 $k \\in \\{1,\\ldots,L\\}$，固定所有的 $\\{W_{h}, S_{h}\\}_{h=1}^{L}$，固定 $\\{c_{h}\\}_{h \\neq k}$，并固定预算 $C$。考虑第 $k$ 层的单位成本发散的渐近状态，即 $c_{k} \\to \\infty$，而所有其他问题输入保持不变。确定极限\n$$\n\\lim_{c_{k} \\to \\infty} n_{k}^{*}(c_{k}),\n$$\n并将其作为您的最终答案。您的最终答案必须是单个实数或单个封闭形式的解析表达式。无需四舍五入，也无需报告单位。", "solution": "问题是在分层抽样设计中找到样本量 $\\{n_h\\}_{h=1}^L$ 的最优分配，以在固定预算的约束下最小化样本均值估计量的方差。随后，我们必须分析特定层 $k$ 的最优样本量 $n_k^*$ 在其单位抽样成本 $c_k$ 趋于无穷大时的行为。\n\n### 第 1 步：提取已知条件\n给定的量和条件如下：\n- 层数：$L \\geq 2$。\n- 层的大小：$N_1, \\ldots, N_L$。\n- 总体大小：$N = \\sum_{h=1}^{L} N_h$。\n- 层的标准差：$S_h \\in (0, \\infty)$，对于 $h=1, \\ldots, L$。\n- 层的权重：$W_h = N_h/N \\in (0,1)$，对于 $h=1, \\ldots, L$。\n- 层的样本量：$n_h \\in (0, \\infty)$，对于 $h=1, \\ldots, L$。\n- 单位抽样成本：$c_h \\in (0, \\infty)$，对于 $h=1, \\ldots, L$。\n- 总预算：$C > 0$。\n- 成本约束：$\\sum_{h=1}^{L} c_h n_h = C$。\n- 分层估计量的方差（要最小化的目标函数）：$\\operatorname{Var}(\\hat{\\mu}) \\approx V(n_1, \\ldots, n_L) = \\sum_{h=1}^{L} \\frac{W_h^2 S_h^2}{n_h}$。\n- 假设有限总体校正是可忽略的。\n- 所有的 $W_h, S_h, c_h$ 和 $C$ 都被视为已知的、确定性的正常数。\n\n### 第 2 步：使用提取的已知条件进行验证\n这个问题在科学上和数学上都是合理的。它描述了分层抽样中的经典最优分配问题，通常称为针对可变成本修正的奈曼分配，是抽样调查理论和统计学中的一个标准课题。目标函数和线性成本约束是标准的。该问题是适定的：它是一个凸优化问题（目标函数是凸函数 $1/n_h$ 的和，约束域是线性的），这保证了存在唯一的最小值。符号是标准的，所有术语都定义清晰。问题是自洽和一致的。没有发现任何缺陷。该问题是有效的。\n\n### 第 3 步：最优分配的推导\n我们需要最小化方差 $V = \\sum_{h=1}^{L} \\frac{W_h^2 S_h^2}{n_h}$，约束条件为成本约束 $\\sum_{h=1}^{L} c_h n_h = C$。样本量 $n_h$ 必须为正。我们使用拉格朗日乘数法。拉格朗日函数 $\\mathcal{L}$ 为：\n$$\n\\mathcal{L}(n_1, \\ldots, n_L, \\lambda) = \\sum_{h=1}^{L} \\frac{W_h^2 S_h^2}{n_h} + \\lambda \\left( \\left( \\sum_{h=1}^{L} c_h n_h \\right) - C \\right)\n$$\n其中 $\\lambda$ 是拉格朗日乘数。\n\n为了找到最小值，我们计算 $\\mathcal{L}$ 关于每个 $n_h$ 的偏导数，并令它们为零。这些是一阶最优性条件。对于每个 $h \\in \\{1, \\ldots, L\\}$：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial n_h} = -\\frac{W_h^2 S_h^2}{n_h^2} + \\lambda c_h = 0\n$$\n由于 $W_h, S_h, c_h$ 均为正数，并且我们在寻找 $n_h > 0$ 的解，我们可以重新整理这个方程：\n$$\n\\frac{W_h^2 S_h^2}{n_h^2} = \\lambda c_h \\implies n_h^2 = \\frac{W_h^2 S_h^2}{\\lambda c_h}\n$$\n取平方根（我们需要 $n_h > 0$），我们得到：\n$$\nn_h = \\frac{W_h S_h}{\\sqrt{\\lambda} \\sqrt{c_h}}\n$$\n这个方程表明，最优样本量 $n_h^*$ 与 $W_h S_h / \\sqrt{c_h}$ 成正比。为了找到比例常数（它取决于 $\\lambda$），我们将这个 $n_h$ 的表达式代入成本约束方程：\n$$\n\\sum_{j=1}^{L} c_j n_j = C \\implies \\sum_{j=1}^{L} c_j \\left( \\frac{W_j S_j}{\\sqrt{\\lambda} \\sqrt{c_j}} \\right) = C\n$$\n$$\n\\frac{1}{\\sqrt{\\lambda}} \\sum_{j=1}^{L} W_j S_j \\sqrt{c_j} = C\n$$\n求解 $\\sqrt{\\lambda}$：\n$$\n\\sqrt{\\lambda} = \\frac{1}{C} \\sum_{j=1}^{L} W_j S_j \\sqrt{c_j}\n$$\n现在，我们将 $\\sqrt{\\lambda}$ 的这个表达式代回 $n_h$ 的方程中：\n$$\nn_h^* = \\frac{W_h S_h}{\\sqrt{c_h}} \\cdot \\frac{1}{\\sqrt{\\lambda}} = \\frac{W_h S_h}{\\sqrt{c_h}} \\cdot \\frac{C}{\\sum_{j=1}^{L} W_j S_j \\sqrt{c_j}}\n$$\n这给出了每层 $h$ 的最优分配的封闭形式表达式：\n$$\nn_h^* = C \\frac{W_h S_h / \\sqrt{c_h}}{\\sum_{j=1}^{L} W_j S_j \\sqrt{c_j}}\n$$\n\n### 第 4 步：确定 $n_k^*$ 的极限\n我们被要求找出当特定层 $k$ 的成本 $c_k$ 发散时（即 $c_k \\to \\infty$），$n_k^*$ 的极限，而所有其他成本 $c_j$ ($j \\neq k$) 以及所有的 $W_j, S_j$ 和 $C$ 保持不变。\n\n$n_k^*$ 的表达式为：\n$$\nn_k^*(c_k) = C \\frac{W_k S_k / \\sqrt{c_k}}{\\sum_{j=1}^{L} W_j S_j \\sqrt{c_j}}\n$$\n为了分析极限，我们可以拆分分母中的和式，以分離出包含 $c_k$ 的项：\n$$\n\\sum_{j=1}^{L} W_j S_j \\sqrt{c_j} = \\left( \\sum_{j \\neq k} W_j S_j \\sqrt{c_j} \\right) + W_k S_k \\sqrt{c_k}\n$$\n让我们定义一个常数 $A = \\sum_{j \\neq k} W_j S_j \\sqrt{c_j}$。因为对于 $j \\neq k$ 的所有 $W_j, S_j, c_j$ 都是固定的正值，所以 $A$ 是一个正常数。同时，令 $B = W_k S_k$，这是另一个正常数。$n_k^*$ 的表达式变为：\n$$\nn_k^*(c_k) = C \\frac{B / \\sqrt{c_k}}{A + B \\sqrt{c_k}}\n$$\n为了简化极限的计算，我们可以将其写为：\n$$\nn_k^*(c_k) = \\frac{C B}{ \\sqrt{c_k} (A + B \\sqrt{c_k}) } = \\frac{C B}{A \\sqrt{c_k} + B c_k}\n$$\n我们需要计算当 $c_k \\to \\infty$ 时这个表达式的极限：\n$$\n\\lim_{c_k \\to \\infty} n_k^*(c_k) = \\lim_{c_k \\to \\infty} \\frac{C B}{A \\sqrt{c_k} + B c_k}\n$$\n分子是正常数 $CB$。\n分母是两项之和，$A \\sqrt{c_k}$ 和 $B c_k$。当 $c_k \\to \\infty$时，这两项都趋于无穷大。因此，整个分母趋于无穷大：\n$$\n\\lim_{c_k \\to \\infty} (A \\sqrt{c_k} + B c_k) = \\infty\n$$\n因此，该表达式的极限是一个常数除以无穷大，结果为零。\n$$\n\\lim_{c_k \\to \\infty} n_k^*(c_k) = 0\n$$\n这个结果表明，当某个特定层的抽样成本变得极其昂贵时，最优分配要求从该层抽取的样本数量应趋近于零。", "answer": "$$\n\\boxed{0}\n$$", "id": "3324873"}]}