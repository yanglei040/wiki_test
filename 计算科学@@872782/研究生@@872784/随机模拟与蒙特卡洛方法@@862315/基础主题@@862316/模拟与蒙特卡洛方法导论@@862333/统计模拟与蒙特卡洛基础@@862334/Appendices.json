{"hands_on_practices": [{"introduction": "任何蒙特卡洛模拟的基础是可靠的伪随机数流，而这通常由诸如 $X_{n+1} \\equiv a X_{n} + c \\pmod{m}$ 的递推关系生成。生成器的质量通常由其周期来衡量，即序列在重复之前所能达到的长度。在此练习中 [@problem_id:3308890]，您将运用数论知识来选择参数 $a$ 和初始种子 $X_0$，以便在给定的模数 $m$ 下最大化周期，从而亲身体验如何构建高质量的生成器。", "problem": "考虑由以下递推关系定义的线性同余生成器 (LCG)：\n$$X_{n+1} \\equiv a X_{n} + c \\pmod{m},$$\n其中模数为 $m$，乘数为 $a$，增量为 $c$。状态序列 $\\{X_{n}\\}$ 的周期是满足对所有 $n$ 都有 $X_{n+T} \\equiv X_{n} \\pmod{m}$ 的最小正整数 $T$。假设存在硬件施加的约束，即 $c = 0$，且模数固定为\n$$m = 2^{11} \\cdot 3^{4} \\cdot 5^{2}.$$\n你可以选择乘数 $a$ 和初始种子 $X_{0}$，但需满足约束条件 $0  a  m$，$0  X_{0}  m$ 和 $\\gcd(X_{0}, m) = 1$。\n\n仅使用数论和模算术的基本定义和经过充分验证的事实，构造一个 $a$ 和 $X_{0}$ 的选择，以在这些约束下最大化 LCG 序列 $\\{X_{n}\\}$ 的周期。通过分析模 $m$ 的乘法结构和任何必要的分解，严格证明你的构造为何能达到该模数下的最大可能周期。然后计算可实现的最大周期长度，结果为一个整数。\n\n你的最终答案必须是最大周期长度。不要提供中间值。不要包含单位。无需四舍五入。", "solution": "所述问题是有效的。这是一个定义明确的数论问题，直接适用于伪随机数生成器（特别是乘法同余生成器）的分析。该问题具有科学依据，是客观的，并包含了进行严格求解所需的所有信息。我们着手求解。\n\n线性同余生成器 (LCG) 由递推关系式定义：\n$$X_{n+1} \\equiv a X_{n} + c \\pmod{m}.$$\n问题施加了约束 $c=0$，从而得到一个乘法同余生成器 (MCG)：\n$$X_{n+1} \\equiv a X_{n} \\pmod{m}.$$\n通过归纳法，该序列由 $X_{n} \\equiv a^{n} X_{0} \\pmod{m}$ 给出。序列的周期 $T$ 是满足对所有非负整数 $n$ 都有 $X_{n+T} \\equiv X_{n} \\pmod{m}$ 的最小正整数。当 $n=0$ 时，该条件变为 $X_{T} \\equiv X_{0} \\pmod{m}$，即\n$$a^{T} X_{0} \\equiv X_{0} \\pmod{m}.$$\n我们已知约束条件 $\\gcd(X_{0}, m) = 1$。这意味着 $X_{0}$ 存在一个模 $m$ 的乘法逆元。我们可以在同余式两边同乘以 $X_{0}^{-1}$，得到\n$$a^{T} \\equiv 1 \\pmod{m}.$$\n此方程表明，周期 $T$ 是乘数 $a$ 在模 $m$ 的单位群 $(\\mathbb{Z}/m\\mathbb{Z})^{\\times}$ 中的乘法阶。因此，最大化周期 $T$ 的问题等价于找到该群中元素可能的最大阶。这个最大阶被称为群的指数。\n\n群 $(\\mathbb{Z}/m\\mathbb{Z})^{\\times}$ 的指数由卡迈克尔函数 (Carmichael function) $\\lambda(m)$ 给出。为达到最大周期，我们必须选择一个乘数 $a$，使其模 $m$ 的阶为 $\\lambda(m)$。这样的元素 $a$ 通常被称为模 $m$ 的原根，尽管这个术语更正式地用于循环群的生成元。这样的元素的存在性是有保证的。初始种子 $X_{0}$ 的选择可以是任何满足 $0  X_{0}  m$ 和 $\\gcd(X_{0}, m) = 1$ 的整数；例如，$X_{0}=1$ 是一个有效的选择。$X_{0}$ 的具体值不影响周期长度，只影响状态序列本身。\n\n我们的任务简化为计算给定模数 $m = 2^{11} \\cdot 3^{4} \\cdot 5^{2}$ 下的 $\\lambda(m)$。卡迈克尔函数有一个与其参数的素数分解相关的关键性质。如果 $m = p_1^{k_1} p_2^{k_2} \\cdots p_r^{k_r}$ 是 $m$ 的素数分解，那么\n$$\\lambda(m) = \\text{lcm}(\\lambda(p_1^{k_1}), \\lambda(p_2^{k_2}), \\dots, \\lambda(p_r^{k_r})).$$\n函数 $\\lambda(p^k)$ 的定义如下：\n\\begin{itemize}\n    \\item $\\lambda(1) = 1$\n    \\item $\\lambda(2) = 1$\n    \\item $\\lambda(4) = 2$\n    \\item 对于 $k \\ge 3$，$\\lambda(2^k) = 2^{k-2}$\n    \\item 对于奇素数 $p$，$\\lambda(p^k) = \\phi(p^k) = p^{k-1}(p-1)$，其中 $\\phi$ 是欧拉总计函数。\n\\end{itemize}\n对于我们给定的模数 $m = 2^{11} \\cdot 3^{4} \\cdot 5^{2}$，我们将这些规则应用于每个素数幂因子：\n\\begin{enumerate}\n    \\item 对于因子 $2^{11}$：由于指数 $11 \\ge 3$，我们有\n    $$\\lambda(2^{11}) = 2^{11-2} = 2^{9} = 512.$$\n    \\item 对于因子 $3^{4}$：由于 $3$ 是一个奇素数，我们有\n    $$\\lambda(3^{4}) = \\phi(3^{4}) = 3^{4-1}(3-1) = 3^{3} \\cdot 2 = 27 \\cdot 2 = 54.$$\n    \\item 对于因子 $5^{2}$：由于 $5$ 是一个奇素数，我们有\n    $$\\lambda(5^{2}) = \\phi(5^{2}) = 5^{2-1}(5-1) = 5^{1} \\cdot 4 = 20.$$\n\\end{enumerate}\n最大周期是这些值的最小公倍数 (lcm)：\n$$T_{\\text{max}} = \\lambda(m) = \\text{lcm}(\\lambda(2^{11}), \\lambda(3^{4}), \\lambda(5^{2})) = \\text{lcm}(512, 54, 20).$$\n为了计算 lcm，我们找出每个数的素数分解：\n\\begin{itemize}\n    \\item $512 = 2^9$\n    \\item $54 = 2 \\cdot 27 = 2^{1} \\cdot 3^{3}$\n    \\item $20 = 4 \\cdot 5 = 2^{2} \\cdot 5^{1}$\n\\end{itemize}\n最小公倍数是所有出现素因子的最高次幂的乘积：\n$$T_{\\text{max}} = \\text{lcm}(2^9, 2^1 \\cdot 3^3, 2^2 \\cdot 5^1) = 2^{\\max(9,1,2)} \\cdot 3^{\\max(0,3,0)} \\cdot 5^{\\max(0,0,1)} = 2^9 \\cdot 3^3 \\cdot 5^1.$$\n现在我们计算这个值：\n$$T_{\\text{max}} = 512 \\cdot 27 \\cdot 5 = 13824 \\cdot 5 = 69120.$$\n因此，可实现的最大周期为 $69120$。\n\n为了证明该周期是可实现的，我们必须证明存在一个具有此阶的乘数 $a$。根据中国剩余定理，群 $(\\mathbb{Z}/m\\mathbb{Z})^{\\times}$ 同构于各分量群的直积：\n$$(\\mathbb{Z}/m\\mathbb{Z})^{\\times} \\cong (\\mathbb{Z}/2^{11}\\mathbb{Z})^{\\times} \\times (\\mathbb{Z}/3^{4}\\mathbb{Z})^{\\times} \\times (\\mathbb{Z}/5^{2}\\mathbb{Z})^{\\times}.$$\n$(\\mathbb{Z}/m\\mathbb{Z})^{\\times}$ 中的一个元素 $a$ 对应一个元组 $(a_1, a_2, a_3)$，其中 $a_1 \\in (\\mathbb{Z}/2^{11}\\mathbb{Z})^{\\times}$，$a_2 \\in (\\mathbb{Z}/3^{4}\\mathbb{Z})^{\\times}$，且 $a_3 \\in (\\mathbb{Z}/5^{2}\\mathbb{Z})^{\\times}$。$a$ 的阶是其各分量阶的最小公倍数。为了最大化此阶，我们必须选择分量 $a_1, a_2, a_3$，使它们各自在自己的群中具有最大可能阶。\n\\begin{itemize}\n    \\item 在 $(\\mathbb{Z}/2^{11}\\mathbb{Z})^{\\times}$ 中，存在最大阶为 $\\lambda(2^{11}) = 512$ 的元素（例如，$a_1=3$ 或 $a_1=5$）。\n    \\item 在 $(\\mathbb{Z}/3^{4}\\mathbb{Z})^{\\times}$（一个循环群）中，存在最大阶为 $\\lambda(3^4) = 54$ 的元素（一个模 $3^4$ 的原根，例如，$a_2=2$）。\n    \\item 在 $(\\mathbb{Z}/5^{2}\\mathbb{Z})^{\\times}$（也是一个循环群）中，存在最大阶为 $\\lambda(5^2) = 20$ 的元素（一个模 $5^2$ 的原根，例如，$a_3=2$）。\n\\end{itemize}\n使用中国剩余定理，我们可以解以下同余方程组：\n$$a \\equiv a_1 \\pmod{2^{11}}$$\n$$a \\equiv a_2 \\pmod{3^{4}}$$\n$$a \\equiv a_3 \\pmod{5^{2}}$$\n存在一个模 $m$ 的唯一解 $a$。这个构造出的 $a$ 的阶将是 $\\text{lcm}(\\text{ord}(a_1), \\text{ord}(a_2), \\text{ord}(a_3)) = \\text{lcm}(512, 54, 20) = 69120$。\n因此，可以构造一个乘数 $a$ 来达到最大周期。如前所述，任何满足 $\\gcd(X_0,m)=1$ 的种子 $X_0$ 都能完成该构造。因此，最大周期长度被确认为 $69120$。", "answer": "$$\\boxed{69120}$$", "id": "3308890"}, {"introduction": "重要性抽样是一种强大的技术，但当权重 $w(x) = p(x)/q(x)$ 的方差为无穷大时，该方法可能会失效。这种情况通常发生在提议分布 $q(x)$ 的尾部比目标分布 $p(x)$ 更轻时。本练习 [@problem_id:3308916] 探讨了一种实用的补救措施——权重截断，它将权重限制在一个最大值 $T$ 以内。您将推导这种方法对期望估计 $\\mu = \\mathbb{E}_{p}[h(X)]$ 引入的偏差，并为截断后的方差设定界限，从而具体地审视偏差-方差之间的基本权衡。", "problem": "考虑一个在 $\\;\\mathbb{R}^{d}\\;$ 上的目标概率密度 $\\;p\\;$ 和一个在 $\\;\\mathbb{R}^{d}\\;$ 上的建议概率密度 $\\;q\\;$，使得 $\\;p\\;$ 关于 $\\;q\\;$ 是绝对连续的，并且重要性权重 $\\;w(x) = \\frac{p(x)}{q(x)}\\;$ 是 $\\;q$-几乎必然有限的。令 $\\;h:\\mathbb{R}^{d}\\to\\mathbb{R}\\;$ 是一个可测函数，满足对所有 $\\;x\\in\\mathbb{R}^{d}\\;$ 都有 $\\;|h(x)| \\le B\\;$，其中 $\\;B\\in(0,\\infty)\\;$ 是一个已知常数，并定义目标期望为 $\\;\\mu = \\mathbb{E}_{p}[h(X)]\\;$，其中 $\\;X\\sim p\\;$。根据测度变换恒等式，$\\;\\mu = \\mathbb{E}_{q}[w(X)\\,h(X)]\\;$，其中 $\\;X\\sim q\\;$。考虑一个阈值 $\\;T \\ge 1\\;$ 的截断重要性权重 $\\;w_{T}(x) = \\min\\{w(x),\\,T\\}\\;$，以及相应的截断估计量均值 $\\;\\mu_{T} = \\mathbb{E}_{q}[w_{T}(X)\\,h(X)]\\;$。\n\n要求您从第一性原理和核心定义出发，分析蒙特卡洛（MC）重要性抽样中截断对偏差和方差的影响。具体来说：\n\n1. 仅使用期望、偏差和方差的基本定义，表达由截断引入的偏差，并将其简化为在 $\\;q\\;$ 分布下涉及 $\\;w\\;$ 尾部的一个期望。\n\n2. 假设权重满足以下多项式尾部条件：存在常数 $\\;C0\\;$ 和 $\\;\\beta1\\;$，使得对于所有 $\\;t \\ge T\\;$，\n$$\n\\mathbb{P}_{q}\\!\\big(w(X)  t\\big) \\le C\\,t^{-\\beta}.\n$$\n仅使用关于期望和尾部概率的公认事实，推导绝对偏差 $\\;|\\mu - \\mu_{T}|\\;$ 的一个闭式上界，该上界用 $\\;B,\\;C,\\;\\beta,\\;$ 和 $\\;T\\;$ 表示。\n\n3. 从第一性原理出发，简要地为截断估计量的单样本方差设定一个界限。也就是说，给出一个关于 $\\;\\mathrm{Var}_{q}\\!\\big(w_{T}(X)\\,h(X)\\big)\\;$ 的有限上界，用 $\\;B\\;$ 和 $\\;T\\;$ 表示。\n\n将您的最终答案表示为在第2部分中推导出的偏差界的单个解析表达式。不需要进行数值舍入。首次使用时定义所有缩写；例如，重要性抽样（IS）和蒙特卡洛（MC）。", "solution": "该问题是有效的，因为它在科学上基于蒙特卡洛（MC）方法的理论，问题陈述适定且信息充分，可得出唯一解，并且陈述客观。我们开始进行解答。\n\n问题要求分析一个截断重要性抽样（IS）估计量。给定一个目标概率密度 $p$ 和一个建议概率密度 $q$ 在 $\\mathbb{R}^{d}$ 上。重要性权重为 $w(x) = \\frac{p(x)}{q(x)}$。我们希望对一个有界测试函数 $h$（满足 $|h(x)| \\le B$）估计其期望 $\\mu = \\mathbb{E}_{p}[h(X)] = \\int_{\\mathbb{R}^d} h(x)p(x)dx$。通过测度变换，这等价于 $\\mu = \\mathbb{E}_{q}[w(X)h(X)]$。截断估计量引入了截断权重 $w_{T}(x) = \\min\\{w(x), T\\}$（对于某个阈值 $T \\ge 1$），从而得到有偏的估计量均值 $\\mu_{T} = \\mathbb{E}_{q}[w_{T}(X)h(X)]$。\n\n第1部分：偏差分析。\n截断估计量的偏差是真实期望 $\\mu$ 与截断估计量均值 $\\mu_T$ 之间的差。根据所给定义：\n$$\n\\text{Bias} = \\mu - \\mu_{T} = \\mathbb{E}_{q}[w(X)h(X)] - \\mathbb{E}_{q}[w_{T}(X)h(X)]\n$$\n根据期望的线性性质，我们可以合并这些项：\n$$\n\\text{Bias} = \\mathbb{E}_{q}\\big[ (w(X) - w_{T}(X)) h(X) \\big]\n$$\n项 $w(x) - w_{T}(x)$ 取决于 $w(x)$ 是否超过阈值 $T$。根据定义，$w_{T}(x) = \\min\\{w(x), T\\}$。\n如果 $w(x) \\le T$，则 $w_{T}(x) = w(x)$，且 $w(x) - w_{T}(x) = 0$。\n如果 $w(x)  T$，则 $w_{T}(x) = T$，且 $w(x) - w_{T}(x) = w(x) - T$。\n这使我们可以使用示性函数 $\\mathbb{I}(A)$ 来表示这个差，如果事件 $A$ 为真，则该函数为 $1$，否则为 $0$：\n$$\nw(x) - w_{T}(x) = (w(x) - T) \\mathbb{I}(w(x)  T)\n$$\n将此代入偏差的表达式中，我们得到：\n$$\n\\text{Bias} = \\mathbb{E}_{q}\\big[ (w(X) - T) h(X) \\mathbb{I}(w(X)  T) \\big]\n$$\n这个表达式将偏差表示为在建议分布 $q$ 下的期望，特别地，它与权重分布在 $w(X)  T$ 处的“尾部”有关。\n\n第2部分：绝对偏差的上界。\n我们希望使用多项式尾部条件 $\\mathbb{P}_{q}(w(X)  t) \\le C t^{-\\beta}$（对于 $t \\ge T$，其中 $C  0$ 和 $\\beta  1$）来找到绝对偏差 $|\\mu - \\mu_{T}|$ 的一个上界。\n从偏差的表达式开始：\n$$\n|\\mu - \\mu_{T}| = \\left| \\mathbb{E}_{q}\\big[ (w(X) - T) h(X) \\mathbb{I}(w(X)  T) \\big] \\right|\n$$\n使用性质 $|\\mathbb{E}[Y]| \\le \\mathbb{E}[|Y|]$ 以及 $|ab| = |a||b|$ 这一事实：\n$$\n|\\mu - \\mu_{T}| \\le \\mathbb{E}_{q}\\big[ |(w(X) - T) h(X) \\mathbb{I}(w(X)  T)| \\big] = \\mathbb{E}_{q}\\big[ |w(X) - T| \\cdot |h(X)| \\cdot |\\mathbb{I}(w(X)  T)| \\big]\n$$\n在期望的积分域中，$w(X)  T$，这意味着 $|w(X) - T| = w(X) - T$。示性函数是非负的，所以它的绝对值就是它本身。我们已知一致界 $|h(x)| \\le B$。代入这些界限：\n$$\n|\\mu - \\mu_{T}| \\le \\mathbb{E}_{q}\\big[ (w(X) - T) \\cdot B \\cdot \\mathbb{I}(w(X)  T) \\big]\n$$\n由于 $B$ 是一个正常数，它可以从期望中提出来：\n$$\n|\\mu - \\mu_{T}| \\le B \\cdot \\mathbb{E}_{q}\\big[ (w(X) - T) \\mathbb{I}(w(X)  T) \\big]\n$$\n为了计算剩余的期望，我们使用非负随机变量 $Y$ 的期望恒等式，即 $\\mathbb{E}[Y] = \\int_{0}^{\\infty} \\mathbb{P}(Y  y) dy$。令随机变量为 $Y = (w(X) - T) \\mathbb{I}(w(X)  T)$。对于 $y \\ge 0$，事件 $\\{Y  y\\}$ 等价于事件 $\\{w(X) - T  y\\}$ 和 $\\{w(X)  T\\}$，这可以简化为 $\\{w(X)  T + y\\}$。\n因此，期望为：\n$$\n\\mathbb{E}_{q}\\big[ (w(X) - T) \\mathbb{I}(w(X)  T) \\big] = \\int_{0}^{\\infty} \\mathbb{P}_{q}(w(X)  T + y) dy\n$$\n我们进行变量代换，令 $t = T + y$，因此 $y = t - T$ 且 $dy = dt$。积分限从 $y=0$ 变为 $t=T$，从 $y \\to \\infty$ 变为 $t \\to \\infty$。\n$$\n\\mathbb{E}_{q}\\big[ (w(X) - T) \\mathbb{I}(w(X)  T) \\big] = \\int_{T}^{\\infty} \\mathbb{P}_{q}(w(X)  t) dt\n$$\n现在我们应用给定的多项式尾部条件 $\\mathbb{P}_{q}(w(X)  t) \\le C t^{-\\beta}$，该条件对 $t \\ge T$ 成立：\n$$\n\\int_{T}^{\\infty} \\mathbb{P}_{q}(w(X)  t) dt \\le \\int_{T}^{\\infty} C t^{-\\beta} dt\n$$\n我们计算这个积分：\n$$\n\\int_{T}^{\\infty} C t^{-\\beta} dt = C \\left[ \\frac{t^{-\\beta+1}}{-\\beta+1} \\right]_{T}^{\\infty}\n$$\n由于 $\\beta  1$，指数 $1-\\beta$ 是负的。因此，当 $t \\to \\infty$ 时，$t^{1-\\beta} \\to 0$。该积分的计算结果为：\n$$\nC \\left( 0 - \\frac{T^{1-\\beta}}{1-\\beta} \\right) = C \\frac{T^{1-\\beta}}{\\beta-1}\n$$\n将此结果与绝对偏差的上界结合起来：\n$$\n|\\mu - \\mu_{T}| \\le B \\cdot \\frac{C T^{1-\\beta}}{\\beta-1}\n$$\n这就是所求的闭式上界。\n\n第3部分：单样本方差的上界。\n我们需要给出 $\\mathrm{Var}_{q}(w_{T}(X)h(X))$ 的一个有限上界。令 $Z(X) = w_{T}(X)h(X)$。方差定义为 $\\mathrm{Var}_{q}(Z(X)) = \\mathbb{E}_{q}[Z(X)^2] - (\\mathbb{E}_{q}[Z(X)])^2$。由于方差是非负的，一个简单的方差上界是二阶矩：\n$$\n\\mathrm{Var}_{q}(Z(X)) \\le \\mathbb{E}_{q}[Z(X)^2]\n$$\n我们来分析 $Z(x)^2$ 这一项：\n$$\nZ(x)^2 = (w_{T}(x)h(x))^2 = w_{T}(x)^2 h(x)^2\n$$\n根据定义，$w_{T}(x) = \\min\\{w(x), T\\}$。由于 $w(x) = p(x)/q(x) \\ge 0$，我们有 $0 \\le w_{T}(x) \\le T$。对其平方可得 $w_{T}(x)^2 \\le T^2$。\n我们还已知 $|h(x)| \\le B$，这意味着 $h(x)^2 \\le B^2$。\n结合这些界限，我们找到了 $Z(x)^2$ 的一个一致界：\n$$\nZ(x)^2 = w_{T}(x)^2 h(x)^2 \\le T^2 B^2\n$$\n这个不等式对所有 $x \\in \\mathbb{R}^d$ 都成立。因此，其期望也是有界的：\n$$\n\\mathbb{E}_{q}[Z(X)^2] = \\mathbb{E}_{q}[w_{T}(X)^2 h(X)^2] \\le \\mathbb{E}_{q}[T^2 B^2] = T^2 B^2\n$$\n因此，我们得到了方差的一个上界：\n$$\n\\mathrm{Var}_{q}(w_{T}(X)h(X)) \\le B^2 T^2\n$$\n这表明对重要性权重进行截断使得单样本估计量的方差变为有限且有界，这是使用该技术的一个关键动机。", "answer": "$$\\boxed{\\frac{B C T^{1-\\beta}}{\\beta - 1}}$$", "id": "3308916"}, {"introduction": "现在我们转向马尔可夫链蒙特卡洛（MCMC）方法，该方法通过生成相关的样本来近似目标分布 $\\pi(x)$。诸如样本均值这类估计量的有效性依赖于中心极限定理，而中心极限定理又取决于马尔可夫链的收敛速度。本练习 [@problem_id:3308869] 通过研究一个针对重尾分布的随机游走Metropolis（RWM）算法来深入探讨几何遍历性这一关键概念，在该场景中几何遍历性会失效。您需要分析这一失效对于估计 $\\mathbb{E}_\\pi[X]$ 所带来的后果。", "problem": "考虑一个在实线上进行的随机游走Metropolis (RWM) 马尔可夫链，其目标分布的密度与具有 $\\nu0$ 个自由度的标准学生t分布成正比，即目标密度为 $\\pi(x) \\propto \\left(1 + \\frac{x^{2}}{\\nu}\\right)^{-\\frac{\\nu+1}{2}}$，定义在 $\\mathbb{R}$ 上。提议分布为高斯分布：给定当前状态 $X_{n}=x$，从 $q(\\cdot \\mid x) = \\mathcal{N}(x,\\sigma^{2})$ 中抽取一个提议 $Y$，其中 $0  \\sigma  \\infty$ 是一个固定值，并使用标准的Metropolis接受概率。\n\n从马尔可夫链的几何遍历性定义、随机游走Metropolis核的形式以及中心极限定理 (CLT) 下遍历均值的渐近正态性出发，完成以下任务：\n\n(i) 利用 $\\pi$ 的尾部行为，从第一性原理出发，论证为什么对于任何 $\\nu0$，该RWM链的几何遍历性都会失效。\n\n(ii) 令 $f(x)=x$。考虑由马尔可夫链的样本均值给出的 $\\mathbb{E}_{\\pi}[f(X)]$ 的蒙特卡洛估计量。仅使用遍历均值的中心极限定理可能成立的必要矩条件，确定最小的自由度阈值 $\\nu_{\\star}$，使得当 $\\nu\\nu_{\\star}$ 时，关于 $f(X)$ 样本均值的中心极限定理可能成立。将 $\\nu_{\\star}$ 以单个实数的形式给出。\n\n(iii) 简要解释几何遍历性的失效对以下两方面的影响：(a) 在 $\\nu \\le \\nu_{\\star}$ 和 $\\nu\\nu_{\\star}$ 的情况下，关于 $f(X)$ 样本均值的中心极限定理的有效性；(b) 当依赖于几何遍历性时，诸如批处理均值法等用于估计渐近方差的方差估计方法的一致性。\n\n你的最终答案必须是 $\\nu_{\\star}$ 的精确值，写成一个单独的实数。不涉及单位，也不需要进行数值四舍五入。", "solution": "首先根据所需标准对问题陈述进行验证。\n\n### 第一步：提取已知信息\n- **马尔可夫链类型**：随机游走Metropolis (RWM) 马尔可夫链。\n- **状态空间**：实线，$\\mathbb{R}$。\n- **目标分布密度**：$\\pi(x) \\propto \\left(1 + \\frac{x^{2}}{\\nu}\\right)^{-\\frac{\\nu+1}{2}}$，对于 $\\nu0$。这是标准学生t分布的核。\n- **提议分布**：给定当前状态 $X_{n}=x$，从高斯分布 $q(\\cdot \\mid x) = \\mathcal{N}(x,\\sigma^{2})$ 中抽取提议 $Y$，其中 $0  \\sigma  \\infty$ 是一个固定值。\n- **接受概率**：标准的Metropolis接受概率，对于对称的高斯提议，其形式为 $\\alpha(x,y) = \\min\\left(1, \\frac{\\pi(y)}{\\pi(x)}\\right)$。\n- **目标函数**：$f(x)=x$。\n- **估计量**：马尔可夫链的样本均值，$\\frac{1}{ N} \\sum_{n=1}^N f(X_n)$。\n- **任务**：\n  (i) 从第一性原理出发，论证为什么对于任何 $\\nu0$，几何遍历性都会失效。\n  (ii) 找到最小阈值 $\\nu_{\\star}$，使得当 $\\nu\\nu_{\\star}$ 时，关于 $f(x)=x$ 样本均值的中心极限定理 (CLT) 可能成立。\n  (iii) 解释几何遍历性的失效对CLT和方差估计的影响。\n\n### 第二步：使用提取的已知信息进行验证\n- **科学依据**：该问题基于马尔可夫链蒙特卡洛（MCMC）方法理论中的标准、成熟概念，特别是随机游走Metropolis算法及其收敛性质。学生t分布是标准的概率分布。马尔可夫链的几何遍历性和中心极限定理是该领域的核心概念。该问题在科学和数学上是合理的。\n- **定义明确**：问题陈述清晰。目标分布和提议分布都已完全指定。任务精确，并能根据既定理论得出一个唯一的、有意义的答案。\n- **客观性**：语言正式且无歧义。没有提出主观性论断。\n- **完整性与一致性**：问题提供了所有必要信息。设置中没有矛盾之处。\n- **现实性与可行性**：该场景是计算统计学中的一个常见设置，并提出了一个“重尾”目标分布的典型例子，这在理论和实践上都具有重要意义。\n- **无其他缺陷**：问题并非无关紧要、隐喻性或伪深刻的。它探讨了MCMC理论中的一个核心概念性挑战。\n\n### 第三步：结论与行动\n问题是有效的。将提供一个完整的解答。\n\n### 解答\n\n此问题关注以学生t分布为目标的随机游走Metropolis (RWM) 算法的长期行为。该目标分布的关键特征是其“重尾”，即多项式衰减，这与高斯分布等具有“轻尾”（指数衰减）的分布形成对比。\n\n**(i) 几何遍历性的失效**\n\n如果一个马尔可夫链以指数速率收敛到其平稳分布 $\\pi$，则称其为几何遍历的。形式上，如果 $P^n(x, \\cdot)$ 是从 $X_0=x$ 开始的 $X_n$ 的分布，那么几何遍历性意味着存在一个函数 $M(x)$ 和一个速率 $\\rho \\in (0,1)$，使得对于所有 $n$，$\\| P^n(x, \\cdot) - \\pi(\\cdot) \\|_{\\text{TV}} \\le M(x) \\rho^n$ 成立，其中 $\\|\\cdot\\|_{\\text{TV}}$ 是全变分范数。对于RWM算法，决定收敛速率的一个关键因素是目标密度 $\\pi(x)$ 在尾部（即对于大的 $|x|$）的行为。\n\n直观上，一个从远离分布主体部分开始的链，必须被足够强地“拉回”到中心区域。这种“拉力”是由提议机制和接受概率引起的。在RWM中，提议是局部的。给定 $X_n=x$，提议 $Y=x+Z\\sigma$ 被提出，其中 $Z \\sim \\mathcal{N}(0,1)$。接受概率为 $\\alpha(x, Y) = \\min\\left(1, \\frac{\\pi(Y)}{\\pi(x)}\\right)$。\n\n我们来分析当 $x  0$ 很大时的情况。目标密度为 $\\pi(x) \\propto \\left(1 + \\frac{x^2}{\\nu}\\right)^{-(\\frac{\\nu+1}{2})}$。对于大的 $x$，其行为近似为 $\\pi(x) \\approx C x^{-(\\nu+1)}$，其中 $C$ 是某个常数。\n对于一个提议 $y=x+z$，密度比为：\n$$ \\frac{\\pi(y)}{\\pi(x)} = \\left(\\frac{1+x^2/\\nu}{1+y^2/\\nu}\\right)^{(\\frac{\\nu+1}{2})} \\approx \\left(\\frac{x^2}{y^2}\\right)^{(\\frac{\\nu+1}{2})} = \\left(\\frac{x}{x+z}\\right)^{\\nu+1} = \\left(1+\\frac{z}{x}\\right)^{-(\\nu+1)} $$\n对于小的 $z/x$，使用泰勒展开，这大约是 $1 - (\\nu+1)\\frac{z}{x}$。\n\n在一个大状态 $x$ 处，链的期望漂移大约是 $\\mathbb{E}[X_{n+1}-X_n | X_n=x]$。一个移动以概率 $\\alpha(x,Y)$ 被接受。期望变化是 $\\mathbb{E}[(Y-x)\\alpha(x,Y)|X_n=x]$。对于大的 $x$，目标密度在局部是平坦的，这意味着对于典型的提议 $Y$（其中 $|Y-x|$ 的量级为 $\\sigma$），$\\pi(y)/\\pi(x) \\approx 1$。因此，接受概率 $\\alpha(x,Y)$ 接近1。链的局部行为模仿了简单对称随机游走。$\\mathbb{R}$ 上的简单随机游走是零常返的，并且探索空间的速度很慢。\n\n为了实现几何遍历性，链必须有一个朝向原点的强漂移。此链的漂移阶为 $O(1/x)$。这可以通过更仔细地计算位置的期望单步变化来看到。这个漂移太弱，无法确保以指数速率返回中心。相比之下，如果目标分布有指数尾，例如 $\\pi(x) \\propto \\exp(-|x|)$，漂移将是一个常数，这是一个强得多的恢复力。\n\n这种弱恢复力意味着，当链游走到尾部时，它需要一个关于 $x$ 的多项式长时间才能返回中心，而不是几何遍历性所要求的对数时间。理论证实了这一点：对于带有高斯提议的RWM算法，几何遍历性成立当且仅当目标密度具有比指数更轻的尾部（例如 $\\pi(x) \\propto \\exp(-c|x|^\\beta)$，其中 $\\beta  1$）。学生t分布具有多项式尾，这比指数尾更重，因此对于任何 $\\nu0$ 和 $\\sigma0$，都排除了几何遍历性。\n\n**(ii) 中心极限定理 (CLT) 的阈值**\n\n对于一个马尔可夫链，关于函数 $f$ 的遍历均值的中心极限定理通常表述为 $\\sqrt{N}(\\bar{f}_N - \\mathbb{E}_{\\pi}[f]) \\xrightarrow{d} \\mathcal{N}(0, \\sigma_f^2)$，其中 $\\bar{f}_N = \\frac{1}{N}\\sum_{n=1}^N f(X_n)$，$\\sigma_f^2$ 是渐近方差。\n这样一个具有有限、非零渐近方差 $\\sigma_f^2$ 的CLT成立的一个基本必要条件是，$f(X)$ 在平稳分布 $\\pi$ 下的方差必须是有限的：\n$$ \\text{Var}_{\\pi}(f(X)) = \\mathbb{E}_{\\pi}[f(X)^2] - (\\mathbb{E}_{\\pi}[f(X)])^2  \\infty $$\n如果 $\\text{Var}_{\\pi}(f(X))$ 是无限的，样本均值可能仍然在不同的归一化下收敛（例如，收敛到稳定律），但具有 $\\sqrt{N}$ 尺度和高斯极限的标准CLT会失效。\n\n在这个问题中，函数是 $f(x)=x$，平稳分布 $\\pi$ 是具有 $\\nu$ 个自由度的学生t分布。我们必须找到使 $\\text{Var}_{\\pi}(X)  \\infty$ 的 $\\nu$ 的条件。\n\n学生t分布关于0对称。要使其均值存在，我们需要 $\\mathbb{E}_\\pi[|X|]  \\infty$。当 $\\nu1$ 时，这是成立的。如果成立，$\\mathbb{E}_\\pi[X]=0$。\n方差是 $\\text{Var}_{\\pi}(X) = \\mathbb{E}_{\\pi}[X^2] - (\\mathbb{E}_{\\pi}[X])^2 = \\mathbb{E}_{\\pi}[X^2]$。\n我们需要确定对于哪些 $\\nu$，二阶矩 $\\mathbb{E}_{\\pi}[X^2]$ 是有限的。\n$$ \\mathbb{E}_{\\pi}[X^2] = C_\\nu \\int_{-\\infty}^{\\infty} x^2 \\left(1 + \\frac{x^2}{\\nu}\\right)^{-\\frac{\\nu+1}{2}} dx $$\n其中 $C_\\nu$ 是归一化常数。为了使该积分收敛，被积函数必须在 $|x| \\to \\infty$ 时足够快地衰减。对于大的 $|x|$，被积函数的行为类似于：\n$$ x^2 \\left(\\frac{x^2}{\\nu}\\right)^{-\\frac{\\nu+1}{2}} \\propto x^2 |x|^{-(\\nu+1)} = |x|^{2 - (\\nu+1)} = |x|^{1-\\nu} $$\n积分 $\\int_a^\\infty x^{p} dx$ 收敛当且仅当 $p  -1$。在我们的例子中，指数是 $p = 1-\\nu$。所以我们要求：\n$$ 1 - \\nu  -1 \\implies 2  \\nu $$\n因此，学生t分布的方差是有限的，当且仅当 $\\nu  2$。这为关于 $f(x)=x$ 样本均值的CLT可能成立建立了最小矩条件。RWM链是可逆的，对于可逆链，条件 $\\text{Var}_\\pi(f(X))  \\infty$ 通常对于CLT的成立是充分的，即使链不是几何遍历的。\n\n因此，最小的自由度阈值是 $\\nu_{\\star} = 2$。\n\n**(iii) 几何遍历性失效的影响**\n\n(a) **对关于 $f(X)$ 样本均值的CLT有效性的影响**：\n- 在 $\\nu  \\nu_{\\star} = 2$ 的情况下，条件 $\\text{Var}_{\\pi}(X)  \\infty$ 得到满足。对于像此RWM这样的可逆马尔可夫链，这个条件足以保证CLT成立。因此，尽管几何遍历性失效，CLT仍然有效。缺乏几何遍历性意味着自协方差 $\\text{Cov}(X_n, X_0)$ 是多项式衰减而非指数衰减，但它们衰减得仍然足够快，以至于渐近方差公式中的和是收敛的。\n- 在 $\\nu \\le \\nu_{\\star} = 2$ 的情况下，方差 $\\text{Var}_{\\pi}(X)$ 是无限的。一个具有 $\\sqrt{N}$ 尺度和高斯极限的标准CLT无法成立。样本均值在适当缩放后，将在分布上收敛到一个非高斯稳定律。在这里，几何遍历性的失效是次要问题；主要障碍是目标分布的方差是无限的。\n\n(b) **对方差估计方法一致性的影响**：\n几何遍历性的失效对估计CLT中出现的渐近方差 $\\sigma_f^2$ 具有严重的实际后果。用于估计 $\\sigma_f^2$ 的标准方法，如批处理均值法或谱方差估计量，都依赖于相关性迅速衰减的假设。\n这些估计量一致性（即当样本量 $N \\to \\infty$ 时，估计值收敛到真实的 $\\sigma_f^2$）的理论证明几乎总是假设几何遍历性或类似的强混合条件。当一个链只是多项式遍历时，就像这里的情况，长程相关性更为持久。\n这种相关性的缓慢衰减意味着，为了获得批处理均值法所需的近似独立的批次，批大小必须比几何遍历情况下大得多。标准的批大小增长率选择（例如 $b_N \\propto N^{1/2}$）可能不足，导致方差估计量有偏或不一致。本质上，虽然当 $\\nu2$ 时CLT可能成立，但几何遍历性的失效使得使用标准的MCMC输出分析工具来可靠地估计极限正态分布的方差变得极其困难。", "answer": "$$\n\\boxed{2}\n$$", "id": "3308869"}]}