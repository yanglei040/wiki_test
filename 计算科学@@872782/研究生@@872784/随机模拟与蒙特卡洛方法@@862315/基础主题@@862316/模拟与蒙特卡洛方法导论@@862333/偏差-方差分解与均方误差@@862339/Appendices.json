{"hands_on_practices": [{"introduction": "我们从一个基础练习开始，这个练习将帮助我们巩固对均方误差 (MSE) 的基本计算。在这个场景中，我们将评估一个在统计学中最常用和最直观的估计量——样本均值。通过计算其 MSE，我们将具体地看到样本量是如何直接影响估计精度，并为我们理解无偏估计量的误差特性打下坚实的基础。 [@problem_id:1934129]", "problem": "在一个生产新型长寿命发光二极管（LED）灯泡的工厂里，灯泡的工作寿命是一项关键的质量指标。大量的先验数据显示，这些灯泡的寿命（以千小时为单位）可以被一个指数分布精确地建模，其未知的真实平均寿命用 $\\theta$ 表示。\n\n一位质量控制工程师的任务是估计这个平均寿命 $\\theta$。该工程师从生产线上随机抽取了 $n$ 个灯泡作为样本，并测量了它们的寿命，记为 $X_1, X_2, \\dots, X_n$。对于真实平均寿命 $\\theta$ 的建议估计量是样本均值，$\\hat{\\theta} = \\bar{X} = \\frac{1}{n} \\sum_{i=1}^{n} X_i$。\n\n为了评估这个估计量的性能，该工程师决定计算其均方误差（MSE）。参数 $\\theta$ 的估计量 $\\hat{\\theta}$ 的均方误差（MSE）定义为估计量与参数之差的平方的期望值：$\\text{MSE}(\\hat{\\theta}) = \\mathbb{E}\\left[(\\hat{\\theta} - \\theta)^2\\right]$。\n\n你的任务是推导在这种情况下样本均值估计量 $\\hat{\\theta}$ 的均方误差的一般表达式。请用真实平均寿命 $\\theta$ 和样本大小 $n$ 来表示你的答案。", "solution": "设 $X_{1},\\dots,X_{n}$ 是独立同分布的指数随机变量，其均值为 $\\theta$。对于以均值为参数的指数分布，对每个 $i$ 都有 $\\mathbb{E}[X_{i}]=\\theta$ 和 $\\operatorname{Var}(X_{i})=\\theta^{2}$。\n\n估计量是样本均值 $\\hat{\\theta}=\\bar{X}=\\frac{1}{n}\\sum_{i=1}^{n}X_{i}$。根据期望的线性性质，\n$$\n\\mathbb{E}[\\bar{X}]=\\frac{1}{n}\\sum_{i=1}^{n}\\mathbb{E}[X_{i}]=\\frac{1}{n}\\cdot n\\theta=\\theta,\n$$\n所以该估计量是无偏的，偏差为 $0$。\n\n利用独立性和方差的尺度变换性质，\n$$\n\\operatorname{Var}(\\bar{X})=\\operatorname{Var}\\!\\left(\\frac{1}{n}\\sum_{i=1}^{n}X_{i}\\right)=\\frac{1}{n^{2}}\\sum_{i=1}^{n}\\operatorname{Var}(X_{i})=\\frac{1}{n^{2}}\\cdot n\\theta^{2}=\\frac{\\theta^{2}}{n}.\n$$\n均方误差满足偏差-方差分解\n$$\n\\operatorname{MSE}(\\hat{\\theta})=\\mathbb{E}\\big[(\\hat{\\theta}-\\theta)^{2}\\big]=\\operatorname{Var}(\\hat{\\theta})+\\big(\\mathbb{E}[\\hat{\\theta}]-\\theta\\big)^{2}.\n$$\n由于偏差为 $0$，上式简化为\n$$\n\\operatorname{MSE}(\\bar{X})=\\operatorname{Var}(\\bar{X})=\\frac{\\theta^{2}}{n}.\n$$", "answer": "$$\\boxed{\\frac{\\theta^{2}}{n}}$$", "id": "1934129"}, {"introduction": "接下来，我们将挑战一个常见的直觉：“无偏”估计量总是更好的吗？这个问题提出了一个引人深思的比较，我们将一个依赖于观测数据的标准估计量与一个固定的、带有主观“偏见”的猜测进行对比。这个练习是对方差-偏差权衡的直接展示，它揭示了在特定情况下，引入少量偏差可以换取方差的大幅降低，从而获得更小的总误差。 [@problem_id:1934147]", "problem": "在统计估计理论中，我们通常基于不同估计量的性能来对它们进行比较。考虑一个服从参数为 $p$ 的伯努利分布的随机变量 $X$，记为 $X \\sim \\text{Bernoulli}(p)$，其中 $p$ 是成功（$X=1$）的概率，而 $1-p$ 是失败（$X=0$）的概率。\n\n假设我们只有一个对 $X$ 的观测值来估计未知参数 $p$。提出了两种不同的估计量：\n\n1.  第一个估计量 $\\hat{p}_1$ 就是观测结果：$\\hat{p}_1 = X$。\n2.  第二个估计量 $\\hat{p}_2$ 是一个固定的常数值：$\\hat{p}_2 = 0.8$。\n\n一个参数 $\\theta$ 的估计量 $\\hat{\\theta}$ 的优劣通常用其均方误差（Mean Squared Error, MSE）来衡量，其定义为 $\\text{MSE}(\\hat{\\theta}) = E[(\\hat{\\theta} - \\theta)^2]$，其中 $E[\\cdot]$ 表示期望。\n\n假设参数的真实值为 $p=0.9$，那么这两个估计量中哪一个的均方误差更低？\n\nA. $\\hat{p}_1$ 的均方误差更低。\n\nB. $\\hat{p}_2$ 的均方误差更低。\n\nC. 均方误差相等。\n\nD. 根据给定信息无法进行比较。", "solution": "我们给定一个观测值 $X \\sim \\text{Bernoulli}(p)$ 和两个估计量：$\\hat{p}_{1}=X$ 和 $\\hat{p}_{2}=0.8$。均方误差定义为 $\\text{MSE}(\\hat{\\theta})=E[(\\hat{\\theta}-\\theta)^{2}]$。我们先用 $p$ 的符号形式计算均方误差，然后在 $p=0.9$ 处求值。\n\n对于 $\\hat{p}_{1}=X$，使用偏差-方差分解，\n$$\n\\text{MSE}(\\hat{p}_{1})= \\operatorname{Var}(X) + \\left(E[X]-p\\right)^{2}.\n$$\n对于 $X \\sim \\text{Bernoulli}(p)$，$E[X]=p$ 且 $\\operatorname{Var}(X)=p(1-p)$。因此，\n$$\n\\text{MSE}(\\hat{p}_{1})=p(1-p).\n$$\n或者，直接计算：\n$$\n\\text{MSE}(\\hat{p}_{1})=E[(X-p)^{2}]=E[X^{2}] - 2pE[X] + p^{2} = E[X] - 2p^{2} + p^{2} = p - p^{2} = p(1-p).\n$$\n\n对于 $\\hat{p}_{2}=0.8$，由于它是一个常数，\n$$\n\\text{MSE}(\\hat{p}_{2})=E[(0.8-p)^{2}]=(0.8-p)^{2}.\n$$\n\n现在在真实值 $p=0.9$ 处进行计算：\n$$\n\\text{MSE}(\\hat{p}_{1})=0.9(1-0.9)=0.09,\\qquad \\text{MSE}(\\hat{p}_{2})=(0.8-0.9)^{2}=0.01.\n$$\n由于 $0.01 < 0.09$，第二个估计量的均方误差更低。因此，正确选项是 B。", "answer": "$$\\boxed{B}$$", "id": "1934147"}, {"introduction": "在掌握了偏差-方差权衡的基本概念后，这个高级练习将你置于计算科学家的角色。你需要在有限的计算预算下，管理模拟中两种主要的误差来源：由离散化产生的系统偏差和由有限样本引起的统计方差。这个练习将理论与实践相结合，展示了偏差-方差分解如何成为设计高效蒙特卡洛方法的强大优化工具。 [@problem_id:3292367]", "problem": "考虑一个单层蒙特卡洛估计量，用于估计期望 $\\mu = \\mathbb{E}[G(X)]$，其中 $X$ 是一个连续时间随机过程的终端状态，$G$ 是一个可测泛函。该估计量使用时间离散化参数 $h \\in (0,1]$ 和 $n \\in \\mathbb{N}$ 个独立样本，得到近似值 $\\widehat{\\mu}_{n,h} = \\frac{1}{n}\\sum_{i=1}^{n} G\\!\\left(X^{(i)}_{h}\\right)$，其中 $X^{(i)}_{h}$ 表示在分辨率 $h$ 下的第 $i$ 条离散化样本路径。在基础过程弱近似的标准正则性条件下，假设如下：\n- 偏差满足 $|\\mathbb{E}[\\widehat{\\mu}_{n,h}] - \\mu| = c_{b}\\, h^{p} + o(h^{p})$，当 $h \\to 0$ 时，其中常数 $c_{b} > 0$，阶数 $p > 0$。\n- 单样本方差对 $h$ 一致有界，即 $\\operatorname{Var}(G(X_{h})) \\leq c_{v}$，其中常数 $c_{v} > 0$。\n- 计算成本的缩放关系为 $C(n,h) = \\kappa\\, \\frac{n}{h}$，其中常数 $\\kappa > 0$，这反映了每条样本路径需要 $\\mathcal{O}(h^{-1})$ 的时间步。\n\n使用偏差、方差和均方误差（MSE）的基本定义，并为优化目的将 $n$ 视为连续正变量，建立并求解选择 $(n,h)$ 以在固定计算预算 $\\mathcal{B} > 0$（即 $C(n,h) \\leq \\mathcal{B}$，且最优解在预算边界上取得）的约束下最小化 MSE 的约束优化问题。推导最优 $h^{\\star}$、$n^{\\star}$ 和最小化均方误差 $\\mathrm{MSE}^{\\star}$ 关于 $p$、$c_{b}$、$c_{v}$、$\\kappa$ 和 $\\mathcal{B}$ 的精确符号表达式。最后，解释最优 $h^{\\star}$、$n^{\\star}$ 和 $\\mathrm{MSE}^{\\star}$ 相对于预算 $\\mathcal{B}$ 和阶数 $p$ 的缩放关系。将最优量表示为精确的解析表达式，无需数值舍入。", "solution": "经评估，此问题是有效的。它在科学上基于随机微分方程的蒙特卡洛方法理论，作为一个约束优化问题是适定的，并且陈述客观，没有歧义。唯一解所需的所有数据和假设均已提供。因此，我们可以进行推导。\n\n目标是在给定计算预算 $\\mathcal{B}$ 的情况下，最小化估计量 $\\widehat{\\mu}_{n,h}$ 的均方误差（MSE）。MSE 定义为 $\\mathrm{MSE}(\\widehat{\\mu}_{n,h}) = \\mathbb{E}[(\\widehat{\\mu}_{n,h} - \\mu)^2]$。它可以分解为偏差的平方和估计量的方差之和：\n$$\n\\mathrm{MSE}(\\widehat{\\mu}_{n,h}) = \\left(\\mathbb{E}[\\widehat{\\mu}_{n,h}] - \\mu\\right)^2 + \\operatorname{Var}(\\widehat{\\mu}_{n,h})\n$$\n\n对于 $h \\to 0$ 时的主阶项，我们有以下关系：\n$1$. 偏差平方为 $(\\mathbb{E}[\\widehat{\\mu}_{n,h}] - \\mu)^2$。由于估计量是 $n$ 个独立样本的均值，其期望为 $\\mathbb{E}[\\widehat{\\mu}_{n,h}] = \\mathbb{E}[G(X_h)]$。问题陈述 $|\\mathbb{E}[G(X_h)] - \\mu| = c_{b} h^{p} + o(h^p)$。我们用其主项的平方来近似偏差平方：\n$$\n\\left(\\mathbb{E}[\\widehat{\\mu}_{n,h}] - \\mu\\right)^2 \\approx (c_{b} h^{p})^2 = c_{b}^2 h^{2p}\n$$\n$2$. 估计量的方差为 $\\operatorname{Var}(\\widehat{\\mu}_{n,h}) = \\operatorname{Var}\\left(\\frac{1}{n}\\sum_{i=1}^{n} G(X^{(i)}_{h})\\right)$。由于样本是独立同分布的，均值的方差是单个样本的方差除以 $n$：\n$$\n\\operatorname{Var}(\\widehat{\\mu}_{n,h}) = \\frac{1}{n} \\operatorname{Var}(G(X_h))\n$$\n问题陈述 $\\operatorname{Var}(G(X_h)) \\leq c_{v}$。为了优化的目的，我们假设这个界代表了方差，因此 $\\operatorname{Var}(G(X_h)) \\approx c_{v}$。于是，\n$$\n\\operatorname{Var}(\\widehat{\\mu}_{n,h}) \\approx \\frac{c_{v}}{n}\n$$\n\n结合这些项，MSE 作为 $n$ 和 $h$ 的函数为：\n$$\n\\mathrm{MSE}(n,h) = c_{b}^2 h^{2p} + \\frac{c_{v}}{n}\n$$\n\n优化受固定计算预算 $\\mathcal{B}$ 的约束。成本函数为 $C(n,h) = \\kappa \\frac{n}{h}$。约束条件是成本等于预算：\n$$\n\\kappa \\frac{n}{h} = \\mathcal{B}\n$$\n\n我们可以利用约束条件将 $n$ 表示为 $h$ 的函数：\n$$\nn = \\frac{\\mathcal{B} h}{\\kappa}\n$$\n将此代入 MSE 表达式中，消去变量 $n$，得到一个仅依赖于 $h$ 的目标函数：\n$$\nf(h) \\equiv \\mathrm{MSE}(h) = c_{b}^2 h^{2p} + \\frac{c_{v}}{\\frac{\\mathcal{B} h}{\\kappa}} = c_{b}^2 h^{2p} + \\frac{c_{v} \\kappa}{\\mathcal{B}} h^{-1}\n$$\n\n为了找到最小化此函数的最优步长 $h^{\\star}$，我们计算 $f(h)$ 对 $h$ 的导数，并令其为零：\n$$\n\\frac{df}{dh} = \\frac{d}{dh} \\left( c_{b}^2 h^{2p} + \\frac{c_{v} \\kappa}{\\mathcal{B}} h^{-1} \\right) = 2p c_{b}^2 h^{2p-1} - \\frac{c_{v} \\kappa}{\\mathcal{B}} h^{-2}\n$$\n令导数为零得到：\n$$\n2p c_{b}^2 (h^{\\star})^{2p-1} = \\frac{c_{v} \\kappa}{\\mathcal{B}} (h^{\\star})^{-2}\n$$\n解出 $h^{\\star}$：\n$$\n(h^{\\star})^{2p+1} = \\frac{c_{v} \\kappa}{2p c_{b}^2 \\mathcal{B}}\n$$\n$$\nh^{\\star} = \\left(\\frac{c_{v} \\kappa}{2p c_{b}^2 \\mathcal{B}}\\right)^{\\frac{1}{2p+1}}\n$$\n为确认这是一个最小值，我们检查二阶导数：\n$$\n\\frac{d^2f}{dh^2} = 2p(2p-1) c_{b}^2 h^{2p-2} + 2 \\frac{c_{v} \\kappa}{\\mathcal{B}} h^{-3}\n$$\n由于 $p>0$, $c_b>0$, $c_v>0$, $\\kappa>0$, $\\mathcal{B}>0$ 且 $h>0$，第二项恒为正。如果 $p \\ge 1/2$，第一项为非负。如果 $0 < p < 1/2$，第一项为负，但平衡偏差和方差的问题通常是针对 $p \\ge 1/2$ 的方法提出的（例如，欧拉-丸山法，其中 $p=1$）。然而，即使对于 $0 < p < 1/2$，由一阶必要条件 $2p c_{b}^2 (h^{\\star})^{2p} = \\frac{c_{v} \\kappa}{\\mathcal{B} h^{\\star}}$ 得到的最小值条件也能保证二阶导数为正：$\\frac{d^2f}{dh^2} |_{h=h^*} = (2p-1)\\frac{c_v\\kappa}{\\mathcal{B}(h^*)^3} + 2\\frac{c_v\\kappa}{\\mathcal{B}(h^*)^3} = (2p+1)\\frac{c_v\\kappa}{\\mathcal{B}(h^*)^3} > 0$。因此，$h^{\\star}$ 对应于一个局部最小值。\n\n接下来，我们通过将 $h^{\\star}$ 代入约束方程来找到最优样本数 $n^{\\star}$：\n$$\nn^{\\star} = \\frac{\\mathcal{B}}{\\kappa} h^{\\star} = \\frac{\\mathcal{B}}{\\kappa} \\left(\\frac{c_{v} \\kappa}{2p c_{b}^2 \\mathcal{B}}\\right)^{\\frac{1}{2p+1}}\n$$\n\n最后，我们通过将 $h^{\\star}$ 和 $n^{\\star}$ 代入 MSE 表达式来找到最小化均方误差 $\\mathrm{MSE}^{\\star}$。一个关键的洞见来自一阶条件，该条件表明在最优点，方差项和偏差平方项是相关的。令 $B^2(h) = c_{b}^2 h^{2p}$ 和 $V(n) = c_{v}/n$。条件 $2p c_{b}^2 (h^{\\star})^{2p-1} = \\frac{c_{v} \\kappa}{\\mathcal{B}} (h^{\\star})^{-2}$ 两边乘以 $h^\\star$ 可得 $2p c_{b}^2 (h^{\\star})^{2p} = \\frac{c_{v} \\kappa}{\\mathcal{B} h^{\\star}}$。这等价于 $2p B^2(h^{\\star}) = V(n^{\\star})$。\n因此，最小 MSE 为：\n$$\n\\mathrm{MSE}^{\\star} = B^2(h^{\\star}) + V(n^{\\star}) = B^2(h^{\\star}) + 2p B^2(h^{\\star}) = (1+2p) B^2(h^{\\star})\n$$\n将 $h^{\\star}$ 的表达式代入此式：\n$$\n\\mathrm{MSE}^{\\star} = (1+2p) c_{b}^2 (h^{\\star})^{2p} = (1+2p) c_{b}^2 \\left[ \\left(\\frac{c_{v} \\kappa}{2p c_{b}^2 \\mathcal{B}}\\right)^{\\frac{1}{2p+1}} \\right]^{2p}\n$$\n$$\n\\mathrm{MSE}^{\\star} = (1+2p) c_{b}^2 \\left(\\frac{c_{v} \\kappa}{2p c_{b}^2 \\mathcal{B}}\\right)^{\\frac{2p}{2p+1}}\n$$\n为便于展示，可将其简化：\n$$\n\\mathrm{MSE}^{\\star} = (1+2p) (c_{b}^2)^{1 - \\frac{2p}{2p+1}} \\left(\\frac{c_{v} \\kappa}{2p \\mathcal{B}}\\right)^{\\frac{2p}{2p+1}} = (1+2p) (c_b^2)^{\\frac{1}{2p+1}} \\left(\\frac{c_v \\kappa}{2p \\mathcal{B}}\\right)^{\\frac{2p}{2p+1}}\n$$\n一个等价的简洁形式是：\n$$\n\\mathrm{MSE}^{\\star} = \\frac{1+2p}{2p} V(n^\\star) = \\frac{1+2p}{2p} \\left(\\frac{c_v \\kappa}{\\mathcal{B}}\\right)^{\\frac{2p}{2p+1}}(2p c_b^2)^{\\frac{1}{2p+1}}\n$$\n\n最优参数相对于预算 $\\mathcal{B}$ 的缩放关系如下：\n-   $h^{\\star} \\propto \\mathcal{B}^{-\\frac{1}{2p+1}}$。随着预算的增加，最优时间步长减小，从而可以减少偏差。\n-   $n^{\\star} \\propto \\mathcal{B} \\cdot h^{\\star} \\propto \\mathcal{B} \\cdot \\mathcal{B}^{-\\frac{1}{2p+1}} = \\mathcal{B}^{\\frac{2p}{2p+1}}$。随着预算的增加，最优样本数量增加，从而可以减少方差。\n-   $\\mathrm{MSE}^{\\star} \\propto \\mathcal{B}^{-\\frac{2p}{2p+1}}$。最小可达误差随着预算的增加而减小。这种减小的速率由指数 $\\frac{2p}{2p+1}$ 决定，并随着方法阶数 $p$ 的增加而提高。对于大的 $p$，误差的缩放关系近似为 $\\mathcal{B}^{-1}$。\n\n最优量的最终表达式为：\n$$\nh^{\\star} = \\left(\\frac{c_{v} \\kappa}{2p c_{b}^2 \\mathcal{B}}\\right)^{\\frac{1}{2p+1}}\n$$\n$$\nn^{\\star} = \\frac{\\mathcal{B}}{\\kappa} \\left(\\frac{c_{v} \\kappa}{2p c_{b}^2 \\mathcal{B}}\\right)^{\\frac{1}{2p+1}}\n$$\n$$\n\\mathrm{MSE}^{\\star} = (1+2p) c_{b}^2 \\left(\\frac{c_{v} \\kappa}{2p c_{b}^2 \\mathcal{B}}\\right)^{\\frac{2p}{2p+1}}\n$$", "answer": "$$\n\\boxed{\\begin{pmatrix} \\left(\\frac{c_{v} \\kappa}{2p c_{b}^2 \\mathcal{B}}\\right)^{\\frac{1}{2p+1}} & \\frac{\\mathcal{B}}{\\kappa} \\left(\\frac{c_{v} \\kappa}{2p c_{b}^2 \\mathcal{B}}\\right)^{\\frac{1}{2p+1}} & (1+2p) c_{b}^2 \\left(\\frac{c_{v} \\kappa}{2p c_{b}^2 \\mathcal{B}}\\right)^{\\frac{2p}{2p+1}} \\end{pmatrix}}\n$$", "id": "3292367"}]}