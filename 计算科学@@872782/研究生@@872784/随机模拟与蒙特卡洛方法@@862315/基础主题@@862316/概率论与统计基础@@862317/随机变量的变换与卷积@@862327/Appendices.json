{"hands_on_practices": [{"introduction": "在随机建模中，独立随机变量之和是一个基本概念，其分布由各个密度的卷积给出。虽然中心极限定理描述了具有有限方差的变量之和，但像柯西分布这样缺乏有限均值和方差的分布，则表现出独特的行为。本练习 [@problem_id:3357841] 将引导您使用特征函数从理论上证明柯西分布在加法下的稳定性，然后要求您通过蒙特卡洛模拟来验证这一性质，并为其尺度参数设计一个稳健的基于分位数的估计量。", "problem": "考虑独立随机变量 $X$ 和 $Y$，其中 $X \\sim \\mathrm{Cauchy}(0,\\gamma_1)$ 且 $Y \\sim \\mathrm{Cauchy}(0,\\gamma_2)$，记号 $\\mathrm{Cauchy}(\\mu,\\gamma)$ 表示位置参数为 $\\mu$、尺度参数为 $\\gamma$ 的柯西分布（Cauchy distribution）。在随机模拟和蒙特卡洛（Monte Carlo, MC）方法中，随机变量的变换和卷积是使用特征函数和基于分位数的估计量等基础工具来研究的。一个实值随机变量 $W$ 的特征函数定义为 $\\varphi_W(t) = \\mathbb{E}[e^{itW}]$，对于独立的 $X$ 和 $Y$，其和的特征函数满足 $\\varphi_{X+Y}(t) = \\varphi_X(t)\\,\\varphi_Y(t)$。\n\n您的任务是：\n- 当 $X$ 和 $Y$ 是位置参数为零、正尺度参数为 $\\gamma_1$ 和 $\\gamma_2$ 的独立柯西随机变量时，使用特征函数和独立性从第一性原理出发，推导 $Z = X+Y$ 的分布形式。明确指出 $Z$ 的分布是什么，并用 $\\gamma_1$ 和 $\\gamma_2$ 表示其尺度参数。\n- 设计一个基于顺序统计量的蒙特卡洛估计量，用于估计位置参数为零的柯西随机变量的尺度参数。仅从分位数的定义和柯西分布的性质出发来證明您的选择是合理的，不要假设任何用于尺度的封闭形式估计量。\n- 实现一个完整的、可运行的程序，对下方的每个测试用例执行以下步骤：\n  1. 使用可复现的伪随机数生成器，生成 $N$ 个独立的 $X$ 和 $Y$ 样本，其中 $X \\sim \\mathrm{Cauchy}(0,\\gamma_1)$ 且 $Y \\sim \\mathrm{Cauchy}(0,\\gamma_2)$，并构造 $Z = X + Y$。\n  2. 使用您上面推导的基于分位数的估计量来估计 $Z$ 的尺度。\n  3. 计算估计尺度与您为 $Z$ 推导出的理论尺度之间的绝对相对误差。绝对相对误差必须计算为 $|\\widehat{\\gamma} - \\gamma_{\\text{theory}}|/\\gamma_{\\text{theory}}$。\n- 输出必须是单行，包含一个由方括号括起来的逗号分隔列表，其中每个条目是相应测试用例的绝对相对误差，表示为浮点数。本问题不涉及任何单位。\n\n使用以下测试套件，每个测试用例由 $(\\gamma_1,\\gamma_2,N,\\text{seed})$ 指定，其中 $\\gamma_1$ 和 $\\gamma_2$ 是严格正实数，$N$ 是正整数样本量，$\\text{seed}$ 是用于为随机数生成器提供种子的非负整数：\n- 测试用例 1: $(\\gamma_1,\\gamma_2,N,\\text{seed}) = (0.5, 1.5, 400000, 12345)$\n- 测试用例 2: $(\\gamma_1,\\gamma_2,N,\\text{seed}) = (10^{-6}, 3\\cdot 10^{-6}, 400000, 54321)$\n- 测试用例 3: $(\\gamma_1,\\gamma_2,N,\\text{seed}) = (100, 250, 400000, 11111)$\n- 测试用例 4: $(\\gamma_1,\\gamma_2,N,\\text{seed}) = (0.1, 0.1, 400000, 22222)$\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果（例如 $[r_1,r_2,r_3,r_4]$），$r_k$ 是根据上述模拟计算出的测试用例 $k$ 的绝对相对误差。", "solution": "该问题被评估为有效，因为它在概率论中有科学依据，问题阐述清晰，目标明确，数据充分，并且没有任何事实错误、主观论断或含糊不清之处。它提出了一个随机模拟领域中标准的、可验证的问题。\n\n按要求，解答分为两部分：首先，对两个独立柯西变量之和的分布进行理论推导；其次，设计一个基于分位数的蒙特卡洛估计量来估计尺度参数。\n\n### 第1部分：独立柯西随机变量之和的分布\n\n设 $X$ 和 $Y$ 是独立随机变量，满足 $X \\sim \\mathrm{Cauchy}(0, \\gamma_1)$ 和 $Y \\sim \\mathrm{Cauchy}(0, \\gamma_2)$，其中 $\\gamma_1  0$ 和 $\\gamma_2  0$ 是尺度参数。我们希望求出它们的和 $Z = X+Y$ 的分布。\n\n一个服从位置参数为 $\\mu$、尺度参数为 $\\gamma$ 的柯西分布（记作 $W \\sim \\mathrm{Cauchy}(\\mu, \\gamma)$）的随机变量 $W$ 的特征函数由下式给出：\n$$ \\varphi_W(t) = \\mathbb{E}[e^{itW}] = e^{i\\mu t - \\gamma|t|} $$\n对于给定的随机变量 $X \\sim \\mathrm{Cauchy}(0, \\gamma_1)$，其位置参数为 $\\mu_X = 0$，尺度参数为 $\\gamma_1$。其特征函数是：\n$$ \\varphi_X(t) = e^{i(0)t - \\gamma_1|t|} = e^{-\\gamma_1|t|} $$\n类似地，对于随机变量 $Y \\sim \\mathrm{Cauchy}(0, \\gamma_2)$，其位置参数为 $\\mu_Y = 0$，尺度参数为 $\\gamma_2$。其特征函数是：\n$$ \\varphi_Y(t) = e^{i(0)t - \\gamma_2|t|} = e^{-\\gamma_2|t|} $$\n如问题所述，对于独立随机变量 $X$ 和 $Y$，它们的和 $Z = X+Y$ 的特征函数是个体特征函数的乘积：\n$$ \\varphi_Z(t) = \\varphi_{X+Y}(t) = \\varphi_X(t) \\varphi_Y(t) $$\n代入 $\\varphi_X(t)$ 和 $\\varphi_Y(t)$ 的表达式，我们得到：\n$$ \\varphi_Z(t) = (e^{-\\gamma_1|t|}) (e^{-\\gamma_2|t|}) = e^{-\\gamma_1|t| - \\gamma_2|t|} = e^{-(\\gamma_1 + \\gamma_2)|t|} $$\n这个结果特征函数 $\\varphi_Z(t) = e^{-(\\gamma_1 + \\gamma_2)|t|}$ 的形式为 $e^{i\\mu_Z t - \\gamma_Z|t|}$，其中位置参数 $\\mu_Z = 0$，尺度参数 $\\gamma_Z = \\gamma_1 + \\gamma_2$。\n\n根据特征函数的唯一性定理（该定理指出概率分布由其特征函数唯一确定），我们可以得出结论，随机变量 $Z$ 也服从柯西分布。具体来说，$Z$ 服从一个位置参数为0，尺度参数为个体尺度参数之和的柯西分布。\n\n因此，$Z$ 的分布是：\n$$ Z \\sim \\mathrm{Cauchy}(0, \\gamma_1 + \\gamma_2) $$\n$Z$ 的理论尺度参数，我们记作 $\\gamma_{\\text{theory}}$，是 $\\gamma_{\\text{theory}} = \\gamma_1 + \\gamma_2$。这个性质表明柯西分布是一个稳定分布。\n\n### 第2部分：基于分位数的尺度参数估计量的设计\n\n任务是为位置参数为零的柯西随机变量 $W \\sim \\mathrm{Cauchy}(0, \\gamma)$ 设计一个基于顺序统计量的蒙特卡洛估计量来估计尺度参数 $\\gamma$。我们从分位数的定义开始。\n\n随机变量 $W \\sim \\mathrm{Cauchy}(\\mu, \\gamma)$ 的累积分布函数（CDF）是：\n$$ F_W(w) = P(W \\le w) = \\frac{1}{2} + \\frac{1}{\\pi}\\arctan\\left(\\frac{w-\\mu}{\\gamma}\\right) $$\n分位数函数 $Q_W(p) = F_W^{-1}(p)$ 给出了一个值 $w$，使得对于概率 $p \\in (0, 1)$ 有 $F_W(w)=p$。我们可以通过反转CDF来推導这个函数：\n$$ p = \\frac{1}{2} + \\frac{1}{\\pi}\\arctan\\left(\\frac{Q_W(p)-\\mu}{\\gamma}\\right) $$\n$$ \\pi\\left(p - \\frac{1}{2}\\right) = \\arctan\\left(\\frac{Q_W(p)-\\mu}{\\gamma}\\right) $$\n$$ \\tan\\left(\\pi\\left(p - \\frac{1}{2}\\right)\\right) = \\frac{Q_W(p)-\\mu}{\\gamma} $$\n$$ Q_W(p) = \\mu + \\gamma \\tan\\left(\\pi\\left(p - \\frac{1}{2}\\right)\\right) $$\n对于指定的位置参数为零的柯西分布情况，我们设 $\\mu=0$：\n$$ Q_W(p) = \\gamma \\tan\\left(\\pi\\left(p - \\frac{1}{2}\\right)\\right) $$\n为了构造 $\\gamma$ 的估计量，我们可以利用两个不同分位数之间的关系。一个稳健且常见的选择是使用第一和第三四分位数，它们对应于 $p_1 = 0.25$ 和 $p_2 = 0.75$。\n令 $Q_1 = Q_W(0.25)$ 和 $Q_3 = Q_W(0.75)$。\n对于第三四分位数 ($p=0.75$)：\n$$ Q_3 = \\gamma \\tan\\left(\\pi\\left(0.75 - 0.5\\right)\\right) = \\gamma \\tan\\left(\\frac{\\pi}{4}\\right) = \\gamma \\cdot 1 = \\gamma $$\n对于第一四分位数 ($p=0.25$)：\n$$ Q_1 = \\gamma \\tan\\left(\\pi\\left(0.25 - 0.5\\right)\\right) = \\gamma \\tan\\left(-\\frac{\\pi}{4}\\right) = \\gamma \\cdot (-1) = -\\gamma $$\n这两个分位数之差是四分位距（IQR）：\n$$ \\mathrm{IQR} = Q_3 - Q_1 = \\gamma - (-\\gamma) = 2\\gamma $$\n根据这个关系，我们可以将尺度参数 $\\gamma$ 表示为四分位距的一半：\n$$ \\gamma = \\frac{Q_3 - Q_1}{2} = \\frac{\\mathrm{IQR}}{2} $$\n这提供了一种估计 $\\gamma$ 的直接方法。给定从 $Z$ 的分布中抽取的 $N$ 个样本集合 $\\{z_1, z_2, \\dots, z_N\\}$，我们可以计算样本四分位数。从顺序统计量（排序后的样本）导出的样本分位数是真实分位数的估计量。令 $\\widehat{Q}_Z(p)$ 为数据的样本 $p$-分位数。我们对 $\\gamma_Z$ 的估计量，记作 $\\widehat{\\gamma}$，是：\n$$ \\widehat{\\gamma} = \\frac{\\widehat{Q}_Z(0.75) - \\widehat{Q}_Z(0.25)}{2} $$\n该估计量是基于顺序统计量的，符合要求，并且已知是柯西分布尺度参数的一个稳健估计量。蒙特卡洛模拟将使用此公式来估计生成的 $Z$ 样本的尺度参数。\n程序将实现此估计量以求得 $\\widehat{\\gamma}$，计算理论尺度 $\\gamma_{\\text{theory}} = \\gamma_1 + \\gamma_2$，然后计算绝对相对误差 $|\\widehat{\\gamma} - \\gamma_{\\text{theory}}|/\\gamma_{\\text{theory}}$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Performs Monte Carlo simulations to estimate the scale parameter of the sum\n    of two independent Cauchy random variables and calculates the relative error.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (gamma1, gamma2, N, seed)\n    test_cases = [\n        (0.5, 1.5, 400000, 12345),\n        (1e-6, 3e-6, 400000, 54321),\n        (100.0, 250.0, 400000, 11111),\n        (0.1, 0.1, 400000, 22222),\n    ]\n\n    results = []\n    for case in test_cases:\n        gamma1, gamma2, N, seed = case\n\n        # Step 1: Generate N independent samples of X and Y and form Z = X + Y.\n        \n        # Initialize a reproducible pseudorandom number generator.\n        rng = np.random.default_rng(seed)\n\n        # Generate standard Cauchy(0, 1) samples.\n        # Note: If S ~ Cauchy(0, 1), then mu + gamma * S ~ Cauchy(mu, gamma).\n        # Since mu=0, we only need to scale the standard samples.\n        x_samples = gamma1 * rng.standard_cauchy(size=N)\n        y_samples = gamma2 * rng.standard_cauchy(size=N)\n\n        # The sum of independent samples is a sample of the sum Z = X + Y.\n        z_samples = x_samples + y_samples\n\n        # Step 2: Estimate the scale of Z using the quantile-based estimator.\n        # The estimator is based on the interquartile range (IQR).\n        # gamma_hat = (Q3 - Q1) / 2\n        q75 = np.quantile(z_samples, 0.75)\n        q25 = np.quantile(z_samples, 0.25)\n        \n        gamma_hat = (q75 - q25) / 2.0\n\n        # Step 3: Compute the absolute relative error.\n        \n        # The theoretical scale of Z = X + Y is gamma_theory = gamma1 + gamma2.\n        gamma_theory = gamma1 + gamma2\n        \n        # Calculate the absolute relative error.\n        # error = |estimated - theoretical| / theoretical\n        absolute_relative_error = np.abs(gamma_hat - gamma_theory) / gamma_theory\n        \n        results.append(absolute_relative_error)\n\n    # Final print statement in the exact required format.\n    # The output is a single line with a comma-separated list of errors.\n    print(f\"[{','.join(f'{r:.10f}' for r in results)}]\")\n\nsolve()\n```", "id": "3357841"}, {"introduction": "虽然卷积分定义了连续随机变量之和，但模拟中的实际应用依赖于离散的数值方法。一种常用且高效的方法是使用快速傅里叶变换（FFT），但它计算的是循环卷积，而非理论上所需要的线性卷积。本练习 [@problem_id:3357868] 深入探讨了这一关键的实践问题，要求您实现一种零填充策略来近似线性卷积，并量化当填充不足时产生的“环绕”误差。", "problem": "给定实线上的两个独立随机变量，记为 $X$（密度为 $f_X$）和 $Y$（密度为 $f_Y$）。其和 $Z = X + Y$ 的密度是 $f_X$ 和 $f_Y$ 在 $\\mathbb{R}$ 上的线性卷积，由积分 $f_Z(z) = \\int_{\\mathbb{R}} f_X(x) f_Y(z - x)\\,dx$ 定义。在计算中，通常通过在均匀离散网格上采样来近似 $f_X$ 和 $f_Y$，然后使用离散傅里叶变换计算卷积的近似值，该变换原生实现了离散网格上的循环卷积。在有限、周期性的离散网格上的循环卷积与在 $\\mathbb{R}$ 上的线性卷积之间存在概念上和实践上的差异。您的任务是从第一性原理出发，精确阐明这一差异，设计一种使用循环卷积来近似线性卷积的补零策略，并量化当补零不足时引入的环绕误差。\n\n仅从核心定义出发（不得假定任何专门的卷积定理），按以下步骤进行：\n\n1. 定义 $\\mathbb{R}$ 上两个可积函数的线性卷积，并解释在间距为 $h  0$ 的均匀网格上采样以及有限支撑如何导向两个有限序列的离散线性卷积。将两个长度同为 $N$ 的有限序列的离散循环卷积定义为模 $N$ 执行的卷积（即在离散环面上）。解释为什么循环卷积对应于序列的 $N$-周期扩展的卷积。\n\n2. 提出一种补零策略，该策略使用填充后序列的循环卷积来精确恢复原始有限序列的离散线性卷积。您的推导必须陈述一个关于补零长度的充分必要条件，以保证计算出的样本中不出现环绕失真。\n\n3. 对于代表离散化概率质量函数（即 $\\sum_k x_k = 1$ 和 $\\sum_k y_k = 1$）的一对普通有限支撑、非负、可和序列 $(x_k)_{k=0}^{n-1}$ 和 $(y_k)_{k=0}^{m-1}$，令 $c^{\\mathrm{lin}}$ 表示它们长度为 $L = n + m - 1$ 的离散线性卷积，并令 $c^{\\mathrm{circ}}_N$ 表示它们在长度 $N \\in \\mathbb{N}$ 下计算的离散循环卷积。通过周期性平铺 $c^{\\mathrm{circ}}_N$ 并截断至前 $L$ 个样本，来定义线性卷积的环绕近似。将环绕误差定义为此近似与 $c^{\\mathrm{lin}}$ 之间的 $\\ell_1$ 距离。根据 $c^{\\mathrm{lin}}$ 的 $N$-周期化推导此误差的表达式，并得出一个仅取决于 $c^{\\mathrm{lin}}$ 超出索引 $N - 1$ 的尾部质量的界限。\n\n4. 实现一个程序，该程序：\n   - 构建下面指定的测试序列。\n   - 直接计算离散线性卷积 $c^{\\mathrm{lin}}$。\n   - 使用快速傅里叶变换（FFT）计算离散循环卷积 $c^{\\mathrm{circ}}_N$（为保证循环卷积的效率和清晰度，必须使用快速傅里叶变换（FFT））。\n   - 通过对 $c^{\\mathrm{circ}}_N$ 进行周期性平铺和截断，形成长度为 $L$ 的环绕近似。\n   - 输出环绕近似与 $c^{\\mathrm{lin}}$ 之间的 $\\ell_1$ 距离作为环绕误差。\n\n仅使用纯数学量；不涉及物理单位。所有角度（如果有）在此均不适用。所有答案必须是数值浮点数。\n\n测试套件（构建这些确切的案例；每个案例需要计算一个等于环绕误差的浮点数）：\n- 案例 $1\\mathrm{a}$：$x$ 在 $\\{0,\\dots,9\\}$ 上均匀分布，即 $x_k = 1/10$ 对于 $k \\in \\{0,\\dots,9\\}$；$y$ 在 $\\{0,\\dots,4\\}$ 上均匀分布，即 $y_k = 1/5$ 对于 $k \\in \\{0,\\dots,4\\}$；循环长度 $N = 10$。\n- 案例 $1\\mathrm{b}$：$x$ 和 $y$ 与案例 $1\\mathrm{a}$ 相同；循环长度 $N = 14$。\n- 案例 $2\\mathrm{a}$：$x$ 是 $\\{0,\\dots,7\\}$ 上的 Kronecker delta 函数，其中 $x_7 = 1$ 且对于 $k \\neq 7$ 有 $x_k = 0$；$y$ 是 $\\{0,\\dots,7\\}$ 上的对称三角序列，与 $\\{1,2,3,4,4,3,2,1\\}$ 成比例并归一化使其总和为 $1$；循环长度 $N = 8$。\n- 案例 $2\\mathrm{b}$：$x$ 和 $y$ 与案例 $2\\mathrm{a}$ 相同；循环长度 $N = 15$。\n- 案例 $3\\mathrm{a}$：$x$ 在 $\\{0,\\dots,63\\}$ 上呈几何分布，参数为 $p_X = 0.2$，即 $x_k \\propto p_X (1 - p_X)^k$，然后在 $\\{0,\\dots,63\\}$ 上重新归一化以使 $\\sum_k x_k = 1$；$y$ 在 $\\{0,\\dots,63\\}$ 上呈几何分布，参数为 $p_Y = 0.35$ 并类似地重新归一化；循环长度 $N = 64$。\n- 案例 $3\\mathrm{b}$：$x$ 和 $y$ 与案例 $3\\mathrm{a}$ 相同；循环长度 $N = 127$。\n- 案例 $3\\mathrm{c}$：$x$ 和 $y$ 与案例 $3\\mathrm{a}$ 相同；循环长度 $N = 128$。\n\n最终输出格式：\n您的程序应生成一行输出，其中包含一个逗号分隔的列表，用方括号括起来（例如，“[r1,r2,...,r7]”），其中每个条目按顺序对应于案例 $1\\mathrm{a}$、$1\\mathrm{b}$、$2\\mathrm{a}$、$2\\mathrm{b}$、$3\\mathrm{a}$、$3\\mathrm{b}$ 和 $3\\mathrm{c}$ 的环绕误差。", "solution": "该问题陈述是计算数学和数字信号处理领域的一个有效练习，具体涉及线性和循环卷积之间的关系。它具有科学依据，问题设定良好、客观，并包含了继续进行所需的所有必要信息。\n\n解决方案将分三部分呈现，对应于问题中要求的理论阐述，随后是为最终程序提供信息的实现细节。\n\n**1. 定义：线性卷积与循环卷积**\n\n设 $f, g: \\mathbb{R} \\to \\mathbb{R}$ 是两个可积函数。它们的**线性卷积**，记为 $(f * g)$，是 $\\mathbb{R}$ 上的一个函数，由以下积分定义：\n$$ (f * g)(z) = \\int_{-\\infty}^{\\infty} f(x) g(z-x) \\,dx $$\n在概率论的背景下，如果 $X$ 和 $Y$ 是具有概率密度函数 (PDFs) $f_X$ 和 $f_Y$ 的独立随机变量，那么它们的和 $Z = X+Y$ 的 PDF 由线性卷积 $f_Z = f_X * f_Y$ 给出。\n\n为了在计算上近似这个过程，我们在间距为 $h  0$ 的均匀网格上对函数进行采样。设 $x_k = f(kh)$ 和 $y_k = g(kh)$。假设函数具有有限支撑，我们得到两个有限序列，$(x_k)_{k=0}^{n-1}$ 和 $(y_k)_{k=0}^{m-1}$。积分转化为求和，定义了序列的**离散线性卷积**，记为 $c^{\\mathrm{lin}} = x * y$：\n$$ c^{\\mathrm{lin}}_k = (x * y)_k = \\sum_{j=-\\infty}^{\\infty} x_j y_{k-j} $$\n鉴于 $j \\notin \\{0, \\dots, n-1\\}$ 时 $x_j=0$，$j \\notin \\{0, \\dots, m-1\\}$ 时 $y_j=0$，该和简化为 $c^{\\mathrm{lin}}_k = \\sum_{j=0}^{n-1} x_j y_{k-j}$。得到的序列 $c^{\\mathrm{lin}}$ 仅在索引 $k$ 从 $0 + 0 = 0$ 到 $(n-1) + (m-1) = n+m-2$ 的范围内非零。因此，离散线性卷积产生一个长度为 $L = n+m-1$ 的序列。\n\n**离散循环卷积**是为两个相同长度的序列定义的，例如 $(a_k)_{k=0}^{N-1}$ 和 $(b_k)_{k=0}^{N-1}$。它们的循环卷积，记为 $c^{\\mathrm{circ}}_N = a \\circledast_N b$，是一个长度为 $N$ 的序列，定义为：\n$$ c^{\\mathrm{circ}}_{N,k} = (a \\circledast_N b)_k = \\sum_{j=0}^{N-1} a_j b_{(k-j) \\pmod N} $$\n其中 $(k-j) \\pmod N$ 是 $k-j$ 除以 $N$ 的余数。这个运算在数学上是整数模 $N$ 的循环群 $\\mathbb{Z}_N$ 上的卷积。\n\n这等价于序列的 $N$-周期扩展的卷积。设 $\\tilde{a}$ 和 $\\tilde{b}$ 是 $N$-周期扩展，即对于所有 $k \\in \\mathbb{Z}$，有 $\\tilde{a}_k = a_{k \\pmod N}$ 和 $\\tilde{b}_k = b_{k \\pmod N}$。那么，这些周期序列的线性卷积的一个周期就产生了循环卷积：\n$$ c^{\\mathrm{circ}}_{N,k} = \\sum_{j=0}^{N-1} \\tilde{a}_j \\tilde{b}_{k-j} \\quad \\text{对于 } k \\in \\{0, \\dots, N-1\\} $$\n离散傅里叶变换 (DFT) 天然地计算循环卷积。DFT 的卷积定理指出 $\\text{DFT}(a \\circledast_N b) = \\text{DFT}(a) \\cdot \\text{DFT}(b)$，其中乘积是逐元素的。一种高效的实现使用快速傅里叶变换 (FFT) 算法：$a \\circledast_N b = \\text{IDFT}(\\text{FFT}(a) \\cdot \\text{FFT}(b))$。\n\n**2. 用于线性卷积的补零策略**\n\n要使用循环卷积计算两个序列 $(x_k)_{k=0}^{n-1}$ 和 $(y_k)_{k=0}^{m-1}$ 的离散线性卷积 $c^{\\mathrm{lin}}$，我们必须防止循环操作中固有的“环绕”或“混叠”效应。线性卷积的结果 $c^{\\mathrm{lin}}$ 的长度为 $L = n+m-1$。\n\n当线性卷积的结果长于循环卷积的周期 $N$ 时，就会发生混叠。具体来说，循环卷积结果 $c^{\\mathrm{circ}}_N$ 与线性卷积 $c^{\\mathrm{lin}}$ 通过混叠公式相关联：\n$$ c^{\\mathrm{circ}}_{N,k} = \\sum_{j=-\\infty}^{\\infty} c^{\\mathrm{lin}}_{k+jN} $$\n为了使循环卷积与线性卷积完全匹配，我们需要对于所有相关索引 $k$，有 $c^{\\mathrm{circ}}_{N,k} = c^{\\mathrm{lin}}_k$。由于 $c^{\\mathrm{lin}}_k$ 仅在 $k \\in \\{0, \\dots, L-1\\}$ 时非零，该和简化为 $c^{\\mathrm{circ}}_{N,k} = c^{\\mathrm{lin}}_k + c^{\\mathrm{lin}}_{k+N} + c^{\\mathrm{lin}}_{k+2N} + \\dots$。为了使等式成立，所有 $j \\ge 1$ 的项 $c^{\\mathrm{lin}}_{k+jN}$ 都必须为零。\n\n这要求 $c^{\\mathrm{lin}}$ 的支撑集 $[0, L-1]$ 不会“环绕”长度为 $N$ 的周期。当且仅当周期 $N$ 至少与线性卷积的支撑集长度 $L$ 一样长时，才能保证这一点。\n\n策略如下：\n1.  选择一个卷积长度 $N$。\n2.  将序列 $x$ 补零以创建一个长度为 $N$ 的新序列 $x'$。\n3.  将序列 $y$ 补零以创建一个长度为 $N$ 的新序列 $y'$。\n4.  计算循环卷积 $c' = x' \\circledast_N y'$。\n\n当且仅当没有发生混叠时，结果 $c'$ 将与线性卷积 $c^{\\mathrm{lin}}$（补零至长度 $N$）相同。当且仅当长度 $N$ 大于或等于线性卷积结果的长度时，才能避免混叠。\n\n要精确恢复长度为 $n$ 和 $m$ 的序列的离散线性卷积，对补零长度 $N$ 的充分必要条件是：\n$$ N \\ge n+m-1 $$\n\n如果满足此条件，则填充序列的循环卷积的前 $L=n+m-1$ 个样本将与原始序列的离散线性卷积的样本相同。如果 $N  n+m-1$，则会发生环绕失真。\n\n**3. 环绕误差量化**\n\n设 $(x_k)_{k=0}^{n-1}$ 和 $(y_k)_{k=0}^{m-1}$ 为非负序列。它们的离散线性卷积是 $c^{\\mathrm{lin}}$，一个长度为 $L=n+m-1$ 的序列。我们计算 $c^{\\mathrm{circ}}_N$ 作为 $x$ 和 $y$ 补零至长度 $N$ 后的循环卷积。通过周期性重复 $c^{\\mathrm{circ}}_N$ 来形成长度为 $L$ 的“环绕近似” $\\hat{c}$：\n$$ \\hat{c}_k = c^{\\mathrm{circ}}_{N, k \\pmod N} \\quad \\text{对于 } k \\in \\{0, \\dots, L-1\\} $$\n环绕误差是近似值与真实线性卷积之间的 $\\ell_1$ 距离：\n$$ E = ||\\hat{c} - c^{\\mathrm{lin}}||_1 = \\sum_{k=0}^{L-1} |\\hat{c}_k - c^{\\mathrm{lin}}_k| $$\n使用混叠公式，$c^{\\mathrm{circ}}_{N, i} = \\sum_{j=0}^{\\infty} c^{\\mathrm{lin}}_{i+jN}$ 对于 $i \\in \\{0, \\dots, N-1\\}$。将此代入 $\\hat{c}_k$ 的定义中，误差表达式变为：\n$$ E = \\sum_{k=0}^{L-1} \\left| \\left( \\sum_{j=0}^{\\infty} c^{\\mathrm{lin}}_{(k \\pmod N) + jN} \\right) - c^{\\mathrm{lin}}_k \\right| $$\n由于所有序列都是非负的，因此对于所有 $k$，$c^{\\mathrm{lin}}_k \\ge 0$。\n我们可以将 $E$ 的和分为两部分：索引小于 $N$ 的部分和索引从 $N$ 到 $L-1$ 的部分。\n\n对于 $k \\in \\{0, \\dots, N-1\\}$（假设 $LN$）：\n$ k \\pmod N = k$。误差项为 $|\\hat{c}_k - c^{\\mathrm{lin}}_k| = |(\\sum_{j=0}^{\\infty} c^{\\mathrm{lin}}_{k+jN}) - c^{\\mathrm{lin}}_k| = |\\sum_{j=1}^{\\infty} c^{\\mathrm{lin}}_{k+jN}| = \\sum_{j=1}^{\\infty} c^{\\mathrm{lin}}_{k+jN}$，因为 $c^{\\mathrm{lin}} \\ge 0$。\n这些贡献的总和是 $\\sum_{k=0}^{N-1} \\sum_{j=1}^{\\infty} c^{\\mathrm{lin}}_{k+jN}$。这个和覆盖了 $c^{\\mathrm{lin}}$ 中索引大于或等于 $N$ 的所有元素。设 $S_{\\mathrm{tail}} = \\sum_{m=N}^{L-1} c^{\\mathrm{lin}}_m$ 是线性卷积的“尾部质量”。前 $N$ 个元素的误差贡献恰好是 $S_{\\mathrm{tail}}$。\n\n对于 $k \\in \\{N, \\dots, L-1\\}$：\n误差贡献为 $\\sum_{k=N}^{L-1} |\\hat{c}_k - c^{\\mathrm{lin}}_k|$。这些项表示用周期性重复的混叠值 $\\hat{c}_k$ 替换真实的尾部值 $c^{\\mathrm{lin}}_k$ 所产生的误差。\n\n总误差是来自所有索引 $k \\in \\{0, \\dots, L-1\\}$ 贡献的总和。虽然完整表达式的封闭形式简化很复杂，但可以获得一个简单的界限。被错置的总质量为 $S_{\\mathrm{tail}}$。这部分质量从尾部（索引 $k \\ge N$）移除，并加到头部（索引 $k  N$）。$\\ell_1$ 误差是所有这些变化的绝对值之和。加到头部的质量总和为 $S_{\\mathrm{tail}}$。从尾部移除的质量总和也是 $S_{\\mathrm{tail}}$。这表明总变化量为 $2S_{\\mathrm{tail}}$。一个更严谨的论证表明 $E = 2S_{\\mathrm{tail}}$。这提供了一个有用的界限：环绕误差由线性卷积尾部中超出长度为 $N$ 的循环卷积窗口的质量所控制。在下面的实现中，我们计算由求和定义的精确误差 E，而不是其界限。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom numpy.fft import fft, ifft\n\ndef solve():\n    \"\"\"\n    Computes the wrap-around error for several test cases of discrete convolution.\n    \"\"\"\n\n    test_cases = []\n\n    # Case 1a: Uniform distributions, N  L\n    x1 = np.full(10, 1/10)\n    y1 = np.full(5, 1/5)\n    test_cases.append({'x': x1, 'y': y1, 'N': 10, 'name': '1a'})\n\n    # Case 1b: Uniform distributions, N = L\n    test_cases.append({'x': x1, 'y': y1, 'N': 14, 'name': '1b'})\n\n    # Case 2a: Delta and Triangular, N  L\n    x2 = np.zeros(8)\n    x2[7] = 1.0\n    y2_unnormalized = np.array([1, 2, 3, 4, 4, 3, 2, 1])\n    y2 = y2_unnormalized / np.sum(y2_unnormalized)\n    test_cases.append({'x': x2, 'y': y2, 'N': 8, 'name': '2a'})\n\n    # Case 2b: Delta and Triangular, N = L\n    test_cases.append({'x': x2, 'y': y2, 'N': 15, 'name': '2b'})\n\n    # Case 3: Geometric distributions\n    n_geom = 64\n    p_x = 0.2\n    k = np.arange(n_geom)\n    x3_unnormalized = p_x * (1 - p_x)**k\n    x3 = x3_unnormalized / np.sum(x3_unnormalized)\n    \n    p_y = 0.35\n    y3_unnormalized = p_y * (1 - p_y)**k\n    y3 = y3_unnormalized / np.sum(y3_unnormalized)\n\n    # Case 3a: Geometric, N  L\n    test_cases.append({'x': x3, 'y': y3, 'N': 64, 'name': '3a'})\n\n    # Case 3b: Geometric, N = L\n    test_cases.append({'x': x3, 'y': y3, 'N': 127, 'name': '3b'})\n    \n    # Case 3c: Geometric, N > L\n    test_cases.append({'x': x3, 'y': y3, 'N': 128, 'name': '3c'})\n\n    results = []\n    for case in test_cases:\n        x, y, N = case['x'], case['y'], case['N']\n        n = len(x)\n        m = len(y)\n        L = n + m - 1\n\n        # 1. Compute discrete linear convolution (ground truth)\n        c_lin = np.convolve(x, y)\n\n        # 2. Compute discrete circular convolution using FFT\n        # Pad original sequences to length N for circular convolution\n        x_pad = np.zeros(N)\n        y_pad = np.zeros(N)\n        x_pad[:n] = x\n        y_pad[:m] = y\n        \n        # Use FFT to compute circular convolution\n        c_circ_N = np.real(ifft(fft(x_pad) * fft(y_pad)))\n\n        # 3. Form the wrap-around approximation of length L\n        # This is done by tiling c_circ_N periodically\n        indices = np.arange(L) % N\n        c_approx = c_circ_N[indices]\n\n        # 4. Compute the wrap-around error (L1 distance)\n        error = np.sum(np.abs(c_approx - c_lin))\n        results.append(error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.8f}' for r in results)}]\")\n\nsolve()\n```", "id": "3357868"}, {"introduction": "变量替换定理是推导变换后随机变量分布的基石。然而，当原始变量的支撑域是具有尖角和边界的受限区域时，其应用会变得错综复杂。本练习 [@problem_id:3357917] 展示了一个定义在单纯形上的均匀分布的非平凡变换，要求您细致地追踪支撑域的几何形状如何被改变，并正确应用雅可比行列式。对于那些变量常受约束的复杂高维模型，掌握这一过程是进行精确分析的关键。", "problem": "设 $(X_{1}, X_{2})$ 在闭合的二维单纯形（一个带顶点的直角三角形）上均匀分布\n$$\n\\mathcal{T} \\equiv \\{(x_{1}, x_{2}) \\in \\mathbb{R}^{2} : x_{1} \\ge 0,\\ x_{2} \\ge 0,\\ x_{1} + x_{2} \\le 1\\}.\n$$\n定义一个变换，将 $X_{1}$ 和 $X_{2}$ 重新参数化为它们各自与 $1 - X_{1} - X_{2}$ 的比值：\n$$\nU \\equiv \\frac{X_{1}}{1 - X_{1} - X_{2}}, \\qquad V \\equiv \\frac{X_{2}}{1 - X_{1} - X_{2}}.\n$$\n该映射将单纯形 $\\mathcal{T}$ 的内部映射到非负象限 $\\{(u,v) \\in \\mathbb{R}^{2}: u \\ge 0, v \\ge 0\\}$，从而在雅可比行列式与强制施加支撑集约束的示性函数之间产生了非平凡的相互作用。令 $R \\equiv U + V$。\n\n从第一性原理出发，即利用 $\\mathcal{T}$ 上的均匀分布定义以及包含雅可比行列式和示性函数的变量替换公式，推导 $R$ 的概率密度函数，具体方法是明确追踪 $\\mathcal{T}$ 的边界（包括其顶点和斜边）如何映射到 $(U,V)$ 平面，以及支撑集如何通过示性函数表示。利用此结果计算期望\n$$\n\\mathbb{E}\\!\\left[\\frac{1}{1 + R}\\right].\n$$\n将最终答案表示为精确值，无需四舍五入。", "solution": "该问题在多元概率论领域中是适定的且具有科学依据。所有定义都精确无误，且存在唯一解。我们将按照指定要求进行推导。\n\n随机向量 $(X_{1}, X_{2})$ 在单纯形上均匀分布\n$$\n\\mathcal{T} \\equiv \\{(x_{1}, x_{2}) \\in \\mathbb{R}^{2} : x_{1} \\ge 0,\\ x_{2} \\ge 0,\\ x_{1} + x_{2} \\le 1\\}.\n$$\n这个单纯形是一个顶点为 $(0,0)$、$(1,0)$ 和 $(0,1)$ 的直角三角形，其面积为 $\\frac{1}{2}(1)(1) = \\frac{1}{2}$。因此，$(X_{1}, X_{2})$ 的联合概率密度函数 (PDF) 在 $\\mathcal{T}$ 上为常数：\n$$\nf_{X_{1}, X_{2}}(x_{1}, x_{2}) = \\frac{1}{\\text{Area}(\\mathcal{T})} = 2, \\quad \\text{for } (x_{1}, x_{2}) \\in \\mathcal{T}.\n$$\n我们可以用示性函数 $\\mathbb{I}_{\\mathcal{T}}(x_1, x_2)$ 来表示它，当 $(x_{1}, x_{2}) \\in \\mathcal{T}$ 时，该函数值为 $1$，否则为 $0$：\n$$\nf_{X_{1}, X_{2}}(x_{1}, x_{2}) = 2 \\, \\mathbb{I}_{\\mathcal{T}}(x_{1}, x_{2}).\n$$\n题目要求我们求出 $R \\equiv U + V$ 的概率密度函数，然后计算 $\\mathbb{E}[\\frac{1}{1+R}]$，其中 $U$ 和 $V$ 由以下变换定义：\n$$\nU = \\frac{X_{1}}{1 - X_{1} - X_{2}}, \\qquad V = \\frac{X_{2}}{1 - X_{1} - X_{2}}.\n$$\n根据题目要求，解题过程将分三个阶段进行：\n1.  运用变量替换公式推导 $(U,V)$ 的联合概率密度函数。\n2.  推导 $R = U+V$ 的概率密度函数。\n3.  利用 $R$ 的概率密度函数计算所需的期望。\n\n阶段 1：推导 $(U,V)$ 的联合概率密度函数。\n变量替换公式表明 $f_{U,V}(u,v) = f_{X_{1},X_{2}}(x_{1}(u,v), x_{2}(u,v)) |J|$，其中 $J$ 是逆变换的雅可比行列式。\n\n首先，我们求从 $(u,v)$ 回到 $(x_{1},x_{2})$ 的逆变换。我们有 $R = U+V = \\frac{X_{1}+X_{2}}{1-X_{1}-X_{2}}$。我们可以将其写为 $R(1 - (X_{1}+X_{2})) = X_{1}+X_{2}$，这得到 $R = (X_{1}+X_{2})(1+R)$，所以 $X_{1}+X_{2} = \\frac{R}{1+R}$。\n因此，$1-X_{1}-X_{2} = 1 - \\frac{R}{1+R} = \\frac{1}{1+R}$。\n将此结果代入 $U$ 和 $V$ 的定义中，并用 $u+v$ 替换 $R$：\n$$\nx_{1} = u (1-x_{1}-x_{2}) = u \\left(\\frac{1}{1+u+v}\\right) = \\frac{u}{1+u+v}\n$$\n$$\nx_{2} = v (1-x_{1}-x_{2}) = v \\left(\\frac{1}{1+u+v}\\right) = \\frac{v}{1+u+v}\n$$\n这就定义了逆变换 $(x_{1}(u,v), x_{2}(u,v))$。\n\n接下来，我们计算雅可比行列式 $J = \\det\\left(\\frac{\\partial(x_{1},x_{2})}{\\partial(u,v)}\\right)$：\n$$\n\\frac{\\partial x_{1}}{\\partial u} = \\frac{1(1+u+v) - u(1)}{(1+u+v)^{2}} = \\frac{1+v}{(1+u+v)^{2}}\n$$\n$$\n\\frac{\\partial x_{1}}{\\partial v} = \\frac{0 - u(1)}{(1+u+v)^{2}} = \\frac{-u}{(1+u+v)^{2}}\n$$\n$$\n\\frac{\\partial x_{2}}{\\partial u} = \\frac{0 - v(1)}{(1+u+v)^{2}} = \\frac{-v}{(1+u+v)^{2}}\n$$\n$$\n\\frac{\\partial x_{2}}{\\partial v} = \\frac{1(1+u+v) - v(1)}{(1+u+v)^{2}} = \\frac{1+u}{(1+u+v)^{2}}\n$$\n雅可比行列式为：\n$$\nJ = \\left(\\frac{1+v}{(1+u+v)^{2}}\\right)\\left(\\frac{1+u}{(1+u+v)^{2}}\\right) - \\left(\\frac{-u}{(1+u+v)^{2}}\\right)\\left(\\frac{-v}{(1+u+v)^{2}}\\right)\n$$\n$$\nJ = \\frac{(1+v)(1+u) - uv}{(1+u+v)^{4}} = \\frac{1+u+v+uv-uv}{(1+u+v)^{4}} = \\frac{1+u+v}{(1+u+v)^{4}} = \\frac{1}{(1+u+v)^{3}}\n$$\n$(U,V)$ 的支撑集由 $(X_{1},X_{2})$ 支撑集的映射决定。$\\mathcal{T}$ 的内部由 $x_{1}>0$, $x_{2}>0$ 和 $x_{1}+x_{2}1$ 定义。\n- $x_{1} > 0 \\implies \\frac{u}{1+u+v} > 0 \\implies u > 0$。\n- $x_{2} > 0 \\implies \\frac{v}{1+u+v} > 0 \\implies v > 0$。\n- $x_{1}+x_{2} \\le 1 \\implies \\frac{u+v}{1+u+v} \\le 1$，对于 $u,v \\ge 0$ 总是成立。\n边界 $x_1=0$ 映射到 $u=0$。边界 $x_2=0$ 映射到 $v=0$。斜边 $x_1+x_2=1$ 映射到 $(u,v)$ 平面中的无穷远处。因此，单纯形 $\\mathcal{T}$ 被映射到非负象限 $\\{(u,v) \\in \\mathbb{R}^2 : u \\ge 0, v \\ge 0\\}$。对于此象限中的任何 $(u,v)$，对应的 $(x_1, x_2)$ 值满足 $x_1 \\ge 0$, $x_2 \\ge 0$ 和 $x_1+x_2 = \\frac{u+v}{1+u+v} \\le 1$。因此，示性函数 $\\mathbb{I}_{\\mathcal{T}}(x_{1}(u,v), x_{2}(u,v))$ 变为 $\\mathbb{I}_{u \\ge 0, v \\ge 0}$。\n对于 $u,v \\ge 0$，雅可比行列式的绝对值为 $|J| = \\frac{1}{(1+u+v)^{3}}$。\n\n$(U,V)$ 的联合概率密度函数为：\n$$\nf_{U,V}(u,v) = f_{X_{1}, X_{2}}(x_{1}(u,v), x_{2}(u,v)) |J| = 2 \\cdot \\mathbb{I}_{u \\ge 0, v \\ge 0} \\cdot \\frac{1}{(1+u+v)^{3}}\n$$\n所以，当 $u \\ge 0, v \\ge 0$ 时，$f_{U,V}(u,v) = \\frac{2}{(1+u+v)^{3}}$，否则为 $0$。\n\n阶段 2：推导 $R = U+V$ 的概率密度函数。\n为了求 $R$ 的边际概率密度函数，我们引入一个辅助变量，例如 $S=U$。我们进行从 $(U,V)$ 到 $(R,S)$ 的变量替换。逆变换为 $U=S$ 和 $V=R-S$。这个线性变换的雅可比行列式为：\n$$\nJ' = \\det\\begin{pmatrix} \\frac{\\partial U}{\\partial R}  \\frac{\\partial U}{\\partial S} \\\\ \\frac{\\partial V}{\\partial R}  \\frac{\\partial V}{\\partial S} \\end{pmatrix} = \\det\\begin{pmatrix} 0  1 \\\\ 1  -1 \\end{pmatrix} = -1.\n$$\n其绝对值为 $|J'| = 1$。$(R,S)$ 的联合概率密度函数为 $f_{R,S}(r,s) = f_{U,V}(u(r,s), v(r,s)) |J'|$。\n$$\nf_{R,S}(r,s) = f_{U,V}(s, r-s) \\cdot 1 = \\frac{2}{(1+s+(r-s))^{3}} = \\frac{2}{(1+r)^{3}}.\n$$\n$(R,S)$ 的支撑集由 $(U,V)$ 的支撑集确定：\n- $u \\ge 0 \\implies s \\ge 0$。\n- $v \\ge 0 \\implies r-s \\ge 0 \\implies s \\le r$。\n- 由于 $u,v \\ge 0$，我们有 $r = u+v \\ge 0$。\n支撑集为 $\\{(r,s) \\in \\mathbb{R}^2 : r \\ge 0, 0 \\le s \\le r\\}$。\n$R$ 的边际概率密度函数，记为 $f_{R}(r)$，通过对 $f_{R,S}(r,s)$ 关于所有可能的 $s$ 值积分得到：\n$$\nf_{R}(r) = \\int_{0}^{r} f_{R,S}(r,s) \\, ds = \\int_{0}^{r} \\frac{2}{(1+r)^{3}} \\, ds.\n$$\n由于被积函数关于 $s$ 是常数：\n$$\nf_{R}(r) = \\frac{2}{(1+r)^{3}} [s]_{0}^{r} = \\frac{2r}{(1+r)^{3}}, \\quad \\text{for } r \\ge 0.\n$$\n这就是所求的随机变量 $R$ 的概率密度函数。\n\n阶段 3：计算期望。\n题目要求我们计算 $\\mathbb{E}\\!\\left[\\frac{1}{1 + R}\\right]$。使用上面推导出的概率密度函数 $f_{R}(r)$：\n$$\n\\mathbb{E}\\!\\left[\\frac{1}{1 + R}\\right] = \\int_{0}^{\\infty} \\frac{1}{1+r} f_{R}(r) \\, dr = \\int_{0}^{\\infty} \\frac{1}{1+r} \\frac{2r}{(1+r)^{3}} \\, dr = \\int_{0}^{\\infty} \\frac{2r}{(1+r)^{4}} \\, dr.\n$$\n为计算此积分，我们使用换元法，令 $z = 1+r$。这意味着 $r = z-1$ 且 $dr=dz$。积分上下限从 $r$ 的 $[0, \\infty)$ 变为 $z$ 的 $[1, \\infty)$。\n$$\n\\mathbb{E}\\!\\left[\\frac{1}{1 + R}\\right] = \\int_{1}^{\\infty} \\frac{2(z-1)}{z^{4}} \\, dz = 2 \\int_{1}^{\\infty} \\left(\\frac{z}{z^{4}} - \\frac{1}{z^{4}}\\right) \\, dz = 2 \\int_{1}^{\\infty} (z^{-3} - z^{-4}) \\, dz.\n$$\n进行积分：\n$$\n2 \\left[ \\frac{z^{-2}}{-2} - \\frac{z^{-3}}{-3} \\right]_{1}^{\\infty} = 2 \\left[ -\\frac{1}{2z^{2}} + \\frac{1}{3z^{3}} \\right]_{1}^{\\infty}.\n$$\n代入积分上下限求值：\n$$\n= 2 \\left( \\lim_{z\\to\\infty} \\left(-\\frac{1}{2z^{2}} + \\frac{1}{3z^{3}}\\right) - \\left(-\\frac{1}{2(1)^{2}} + \\frac{1}{3(1)^{3}}\\right) \\right)\n$$\n$$\n= 2 \\left( (0 + 0) - \\left(-\\frac{1}{2} + \\frac{1}{3}\\right) \\right) = 2 \\left( - \\left(-\\frac{1}{6}\\right) \\right) = 2 \\left(\\frac{1}{6}\\right) = \\frac{1}{3}.\n$$\n期望值是一个精确的有理数。\n作为验证（非题目要求步骤），我们注意到 $\\frac{1}{1+R} = \\frac{1}{1 + \\frac{X_1+X_2}{1-X_1-X_2}} = 1-X_1-X_2$。根据期望的线性性质，$\\mathbb{E}[1-X_1-X_2] = 1 - \\mathbb{E}[X_1] - \\mathbb{E}[X_2]$。对于此对称分布，边际期望为 $\\mathbb{E}[X_1]=\\mathbb{E}[X_2]=\\frac{1}{3}$。这得出 $1 - \\frac{1}{3} - \\frac{1}{3} = \\frac{1}{3}$，从而验证了我们通过正式要求的方法得到的结果。", "answer": "$$\n\\boxed{\\frac{1}{3}}\n$$", "id": "3357917"}]}