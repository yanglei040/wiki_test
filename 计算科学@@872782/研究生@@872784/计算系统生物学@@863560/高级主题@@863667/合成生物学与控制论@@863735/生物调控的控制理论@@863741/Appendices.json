{"hands_on_practices": [{"introduction": "在尝试控制一个系统之前，我们必须先回答两个基本问题：我们能否利用可用的输入影响其所有的内部状态？我们能否通过测量值推断出所有这些状态？本练习将可控性和可观性的形式化分析应用于一个经典的基因表达双状态模型，为设计任何反馈调控系统奠定必要的基础。通过这个实践，你将掌握评估一个生物系统是否适合进行控制设计的基本方法[@problem_id:3297625]。", "problem": "考虑一个在质量作用动力学下的基因表达的最小二状态模型。信使核糖核酸 (mRNA) 以受外部输入控制的转录速率产生，并以一级速率常数降解；而蛋白质则通过 mRNA 翻译产生，并以一级速率常数降解。测量蛋白质荧光，其与蛋白质浓度成正比。\n\n设状态 $x_{1}(t)$ 为 mRNA 浓度，$x_{2}(t)$ 为蛋白质浓度。输入为转录速率 $u(t)$，输出为与蛋白质浓度成正比的荧光 $y(t)$。假设 mRNA 和蛋白质分别以正常数 $\\gamma_{m} > 0$ 和 $\\gamma_{p} > 0$ 的一级速率常数降解，翻译速率 $k_{t} > 0$ 为正，荧光增益 $c > 0$ 为正。动力学和测量方程为\n$$\n\\frac{d}{dt}\\begin{pmatrix} x_{1}(t) \\\\ x_{2}(t) \\end{pmatrix}\n=\n\\begin{pmatrix}\n-\\gamma_{m} & 0 \\\\\nk_{t} & -\\gamma_{p}\n\\end{pmatrix}\n\\begin{pmatrix} x_{1}(t) \\\\ x_{2}(t) \\end{pmatrix}\n+\n\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} u(t),\n\\qquad\ny(t) = \\begin{pmatrix} 0 & c \\end{pmatrix} \\begin{pmatrix} x_{1}(t) \\\\ x_{2}(t) \\end{pmatrix}.\n$$\n\n根据线性时不变 (LTI) 系统的可控性和可观测性定义，计算该系统的可控性矩阵和可观测性矩阵的秩（用参数表示），并确定在所述条件下系统是否可控和可观测。对您的结果给出简要的生物学解释。\n\n将最终答案表示为一个包含两个条目的行矩阵，其中第一个条目是可控性矩阵的秩，第二个条目是可观测性矩阵的秩。无需四舍五入。", "solution": "该问题提出了一个用于基因表达的线性时不变 (LTI) 状态空间模型。状态向量为 $x(t) = \\begin{pmatrix} x_{1}(t) \\\\ x_{2}(t) \\end{pmatrix}$，其中 $x_{1}(t)$ 是 mRNA 浓度，$x_{2}(t)$ 是蛋白质浓度。该系统由以下方程描述：\n$$ \\frac{dx}{dt} = Ax + Bu, \\quad y = Cx $$\n其中矩阵 $A$、$B$ 和 $C$ 由下式给出：\n$$ A = \\begin{pmatrix} -\\gamma_{m} & 0 \\\\ k_{t} & -\\gamma_{p} \\end{pmatrix}, \\quad B = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, \\quad C = \\begin{pmatrix} 0 & c \\end{pmatrix} $$\n参数 $\\gamma_{m}$、$\\gamma_{p}$、$k_{t}$ 和 $c$ 均为严格正常数。状态空间的维数为 $n=2$。\n\n首先，我们分析系统的可控性。一个系统是可控的，当且仅当其可控性矩阵 $\\mathcal{C}$ 是满秩的。对于一个维数为 $n$ 的系统，秩必须等于 $n$。此处，$n=2$。可控性矩阵构造如下：\n$$ \\mathcal{C} = \\begin{pmatrix} B & AB & \\dots & A^{n-1}B \\end{pmatrix} $$\n对于这个二阶系统 ($n=2$)，可控性矩阵为 $\\mathcal{C} = \\begin{pmatrix} B & AB \\end{pmatrix}$。我们必须计算乘积 $AB$：\n$$ AB = \\begin{pmatrix} -\\gamma_{m} & 0 \\\\ k_{t} & -\\gamma_{p} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} (-\\gamma_{m})(1) + (0)(0) \\\\ (k_{t})(1) + (-\\gamma_{p})(0) \\end{pmatrix} = \\begin{pmatrix} -\\gamma_{m} \\\\ k_{t} \\end{pmatrix} $$\n现在，我们可以构造可控性矩阵 $\\mathcal{C}$：\n$$ \\mathcal{C} = \\begin{pmatrix} B & AB \\end{pmatrix} = \\begin{pmatrix} 1 & -\\gamma_{m} \\\\ 0 & k_{t} \\end{pmatrix} $$\n$\\mathcal{C}$ 的秩由其行列式确定。一个 $2 \\times 2$ 矩阵是满秩 ($2$) 的，当且仅当其行列式非零。\n$$ \\det(\\mathcal{C}) = (1)(k_{t}) - (-\\gamma_{m})(0) = k_{t} $$\n根据问题陈述，翻译速率 $k_{t}$ 是正的，即 $k_{t} > 0$。由于 $\\det(\\mathcal{C}) = k_{t} \\neq 0$，矩阵 $\\mathcal{C}$ 是满秩的。因此，可控性矩阵的秩为 $2$。这意味着系统是完全可控的。\n\n接下来，我们分析系统的可观测性。一个系统是可观测的，当且仅当其可观测性矩阵 $\\mathcal{O}$ 是满秩的，在此情况下秩为 $n=2$。可观测性矩阵构造如下：\n$$ \\mathcal{O} = \\begin{pmatrix} C \\\\ CA \\\\ \\vdots \\\\ CA^{n-1} \\end{pmatrix} $$\n对于这个二阶系统 ($n=2$)，可观测性矩阵为 $\\mathcal{O} = \\begin{pmatrix} C \\\\ CA \\end{pmatrix}$。我们必须计算乘积 $CA$：\n$$ CA = \\begin{pmatrix} 0 & c \\end{pmatrix} \\begin{pmatrix} -\\gamma_{m} & 0 \\\\ k_{t} & -\\gamma_{p} \\end{pmatrix} = \\begin{pmatrix} (0)(-\\gamma_{m}) + (c)(k_{t}) & (0)(0) + (c)(-\\gamma_{p}) \\end{pmatrix} = \\begin{pmatrix} c k_{t} & -c \\gamma_{p} \\end{pmatrix} $$\n现在，我们可以构造可观测性矩阵 $\\mathcal{O}$：\n$$ \\mathcal{O} = \\begin{pmatrix} C \\\\ CA \\end{pmatrix} = \\begin{pmatrix} 0 & c \\\\ c k_{t} & -c \\gamma_{p} \\end{pmatrix} $$\n$\\mathcal{O}$ 的秩由其行列式确定。\n$$ \\det(\\mathcal{O}) = (0)(-c \\gamma_{p}) - (c)(c k_{t}) = -c^{2}k_{t} $$\n问题陈述了荧光增益 $c > 0$ 和翻译速率 $k_{t} > 0$。因此，$c^{2} > 0$ 且它们的乘积 $c^{2}k_{t}$ 是严格为正的。因此，$\\det(\\mathcal{O}) = -c^{2}k_{t} \\neq 0$。这表明矩阵 $\\mathcal{O}$ 是满秩的。因此，可观测性矩阵的秩为 $2$。这意味着系统是完全可观测的。\n\n这些结果的生物学解释如下：\n可控性 (秩 = $2$)：系统完全可控意味着，通过操纵转录速率 $u(t)$，可以在有限时间内将 mRNA ($x_{1}$) 和蛋白质 ($x_{2}$) 的浓度从任何初始状态驱动到任何期望的最终状态。输入 $u(t)$ 直接影响 mRNA 的变化率。由于存在非零的翻译速率 ($k_{t} > 0$)，对 mRNA 状态的控制会传递到蛋白质状态。如果 $k_{t}$ 为零，蛋白质水平将独立于输入，系统将不可控，因为我们无法影响 $x_{2}$。\n\n可观测性 (秩 = $2$)：系统完全可观测意味着，通过随时间测量荧光输出 $y(t)$，可以唯一地确定系统的初始状态，即 mRNA ($x_{1}(0)$) 和蛋白质 ($x_{2}(0)$) 的初始浓度。我们直接测量蛋白质浓度（因为 $y(t) = cx_{2}(t)$ 且 $c > 0$）。蛋白质水平的动力学通过项 $k_{t}x_{1}$ 依赖于 mRNA 水平。由于 $k_{t} > 0$，所测量的蛋白质浓度随时间的演化本身就包含了关于未测量的 mRNA 浓度的信息，从而可以对其进行重构。如果 $k_{t}$ 或 $c$ 为零，关于 mRNA 状态的信息将会丢失，系统将不可观测。\n\n总之，可控性矩阵的秩为 $2$，可观测性矩阵的秩为 $2$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 2 & 2 \\end{pmatrix}}\n$$", "id": "3297625"}, {"introduction": "虽然确定性模型提供了一个简化的视角，但生物调控在根本上是一个由随机分子事件驱动的随机过程。本练习超越了平均行为的范畴，旨在量化一个简单基因表达模块中的内在噪声。通过推导方差和法诺因子，你将更深入地理解细胞波动的来源以及如何表征其大小，这是分析生物回路鲁棒性的关键一步[@problem_id:3297565]。", "problem": "考虑一个恒定体积、充分混合的单个细胞中的组成型转录-翻译模块，其中分子数量被建模为离散随机变量，反应动力学遵循质量作用定律。所涉及的物种是信使核糖核酸（$m$）和蛋白质（$p$）。反应如下：\n- 转录：$\\varnothing \\xrightarrow{k_m} m$，速率为 $k_m$，\n- 信使核糖核酸 (mRNA) 降解：$m \\xrightarrow{\\gamma_m} \\varnothing$，每个 mRNA 的速率为 $\\gamma_m$，\n- 翻译：$m \\xrightarrow{k_p} m + p$，每个 mRNA 的速率为 $k_p$，\n- 蛋白质降解/稀释：$p \\xrightarrow{\\gamma_p} \\varnothing$，每个蛋白质的速率为 $\\gamma_p$。\n\n假设使用化学主方程（CME）的连续时间马尔可夫链进行描述，并利用对于线性反应网络，其一阶矩和二阶矩是封闭的，并且与通过线性噪声近似（LNA）得到的结果一致。从这些第一性原理出发，推导 $(m,p)$ 的稳態均值和协方差，然后计算：\n- 蛋白质数量的稳态方差，$\\operatorname{Var}[p]$，\n- 蛋白质数量的稳态法诺因子，定义为 $F = \\operatorname{Var}[p]/\\mathbb{E}[p]$。\n\n通过讨论均值是否匹配以及确定性模型对方差的预测，将您的随机结果与确定性质量作用常微分方程模型（无涨落）进行比较。用 $k_m$、$\\gamma_m$、$k_p$ 和 $\\gamma_p$ 的符号形式表达您的最终答案。以行矩阵的形式提供最终答案，矩阵包含两个条目，顺序为 $\\operatorname{Var}[p]$ 和 $F$。不需要数值舍入。不需要单位，因为答案将以符号形式表示。", "solution": "该问题是有效的，因为它代表了计算系统生物学中一个典型的、适定的问题，其基础是随机化学动力学的既定原理。所有必需的定义和参数都已提供，问题没有科学上的不准确或含糊之处。\n\n我们首先将问题形式化。令分子数量的状态向量为 $X = (m, p)^T$。该系统包含 4 个化学反应。第 $j$ 个反应的状态向量变化由化学计量向量 $S_j$ 给出，第 $j$ 个反应的速率由其倾向函数 $a_j(X)$ 给出。\n\n反应如下：\n$1$。转录：$\\varnothing \\xrightarrow{k_m} m$。化学计量 $S_1 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$，倾向 $a_1(X) = k_m$。\n$2$。mRNA 降解：$m \\xrightarrow{\\gamma_m} \\varnothing$。化学计量 $S_2 = \\begin{pmatrix} -1 \\\\ 0 \\end{pmatrix}$，倾向 $a_2(X) = \\gamma_m m$。\n$3$。翻译：$m \\xrightarrow{k_p} m + p$。化学计量 $S_3 = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$，倾向 $a_3(X) = k_p m$。\n$4$。蛋白质降解：$p \\xrightarrow{\\gamma_p} \\varnothing$。化学计量 $S_4 = \\begin{pmatrix} 0 \\\\ -1 \\end{pmatrix}$，倾向 $a_4(X) = \\gamma_p p$。\n\n化学计量矩阵为 $S = \\begin{pmatrix} S_1 & S_2 & S_3 & S_4 \\end{pmatrix} = \\begin{pmatrix} 1 & -1 & 0 & 0 \\\\ 0 & 0 & 1 & -1 \\end{pmatrix}$。\n倾向向量为 $a(X) = (k_m, \\gamma_m m, k_p m, \\gamma_p p)^T$。\n\n首先，为了进行比较，我们考虑确定性质量作用常微分方程（ODE）模型，其中变量代表浓度。令 $\\langle m \\rangle$ 和 $\\langle p \\rangle$ 表示这些浓度。\n$$ \\frac{d\\langle m \\rangle}{dt} = k_m - \\gamma_m \\langle m \\rangle $$\n$$ \\frac{d\\langle p \\rangle}{dt} = k_p \\langle m \\rangle - \\gamma_p \\langle p \\rangle $$\n在稳态下，时间导数为零。求解稳态均值，记为 $\\langle m \\rangle_{ss}$ 和 $\\langle p \\rangle_{ss}$：\n从第一个方程：$k_m - \\gamma_m \\langle m \\rangle_{ss} = 0 \\implies \\langle m \\rangle_{ss} = \\frac{k_m}{\\gamma_m}$。\n从第二个方程：$k_p \\langle m \\rangle_{ss} - \\gamma_p \\langle p \\rangle_{ss} = 0 \\implies \\langle p \\rangle_{ss} = \\frac{k_p}{\\gamma_p} \\langle m \\rangle_{ss} = \\frac{k_p k_m}{\\gamma_p \\gamma_m}$。\n确定性模型预测了这些平均值，但没有提供关于涨落的信息，这意味着方差为零。\n\n接下来，我们分析随机模型。均值 $\\mathbb{E}[X] = \\langle X \\rangle$ 的时间演化由 $\\frac{d\\langle X \\rangle}{dt} = S \\langle a(X) \\rangle$ 给出。由于所有反应最多是一阶反应，倾向函数是状态变量的线性函数，因此 $\\langle a(X) \\rangle = a(\\langle X \\rangle)$。均值方程与确定性 ODE 相同，因此稳态均值也相同：$\\mathbb{E}[m] = \\langle m \\rangle_{ss} = \\frac{k_m}{\\gamma_m}$ 且 $\\mathbb{E}[p] = \\langle p \\rangle_{ss} = \\frac{k_p k_m}{\\gamma_p \\gamma_m}$。\n\n为了求方差，我们使用协方差矩阵 $\\Sigma = \\operatorname{Cov}(X, X) = \\langle (X-\\langle X \\rangle)(X-\\langle X \\rangle)^T \\rangle$ 的时间演化方程。对于线性反应网络，该方程是精确的，由李雅普诺夫方程给出：\n$$ \\frac{d\\Sigma}{dt} = J \\Sigma + \\Sigma J^T + D $$\n其中 $J$ 是雅可比矩阵，$D$ 是扩散矩阵。在稳态下，$\\frac{d\\Sigma}{dt}=0$，因此我们必须求解 $J \\Sigma_{ss} + \\Sigma_{ss} J^T + D = 0$。\n\n宏观速率向量为 $F(X) = S a(X) = \\begin{pmatrix} k_m - \\gamma_m m \\\\ k_p m - \\gamma_p p \\end{pmatrix}$。\n雅可比矩阵 $J$ 是 $F$ 对 $X$ 的导数，在均值处求值：\n$$ J = \\begin{pmatrix} -\\gamma_m & 0 \\\\ k_p & -\\gamma_p \\end{pmatrix} $$\n扩散矩阵 $D$ 由 $D = S \\operatorname{diag}(\\langle a(X) \\rangle_{ss}) S^T$ 给出。稳态倾向函数为：\n$\\langle a_1 \\rangle_{ss} = k_m$\n$\\langle a_2 \\rangle_{ss} = \\gamma_m \\langle m \\rangle_{ss} = \\gamma_m \\frac{k_m}{\\gamma_m} = k_m$\n$\\langle a_3 \\rangle_{ss} = k_p \\langle m \\rangle_{ss} = k_p \\frac{k_m}{\\gamma_m}$\n$\\langle a_4 \\rangle_{ss} = \\gamma_p \\langle p \\rangle_{ss} = \\gamma_p \\frac{k_p k_m}{\\gamma_p \\gamma_m} = \\frac{k_p k_m}{\\gamma_m}$\n扩散矩阵计算如下 $D = \\sum_{j=1}^{4} S_j S_j^T \\langle a_j \\rangle_{ss}$：\n$D = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}\\begin{pmatrix} 1 & 0 \\end{pmatrix}k_m + \\begin{pmatrix} -1 \\\\ 0 \\end{pmatrix}\\begin{pmatrix} -1 & 0 \\end{pmatrix}k_m + \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\\begin{pmatrix} 0 & 1 \\end{pmatrix}\\frac{k_p k_m}{\\gamma_m} + \\begin{pmatrix} 0 \\\\ -1 \\end{pmatrix}\\begin{pmatrix} 0 & -1 \\end{pmatrix}\\frac{k_p k_m}{\\gamma_m}$\n$D = \\begin{pmatrix} k_m & 0 \\\\ 0 & 0 \\end{pmatrix} + \\begin{pmatrix} k_m & 0 \\\\ 0 & 0 \\end{pmatrix} + \\begin{pmatrix} 0 & 0 \\\\ 0 & \\frac{k_p k_m}{\\gamma_m} \\end{pmatrix} + \\begin{pmatrix} 0 & 0 \\\\ 0 & \\frac{k_p k_m}{\\gamma_m} \\end{pmatrix} = \\begin{pmatrix} 2k_m & 0 \\\\ 0 & 2 \\frac{k_p k_m}{\\gamma_m} \\end{pmatrix}$\n\n令稳态协方差矩阵为 $\\Sigma_{ss} = \\begin{pmatrix} \\sigma_{mm} & \\sigma_{mp} \\\\ \\sigma_{mp} & \\sigma_{pp} \\end{pmatrix}$。稳态李雅普诺夫方程 $J \\Sigma_{ss} + \\Sigma_{ss} J^T + D = 0$ 产生了一个关于 $\\Sigma_{ss}$ 元素的线性方程组：\n$$ \\begin{pmatrix} -\\gamma_m & 0 \\\\ k_p & -\\gamma_p \\end{pmatrix} \\begin{pmatrix} \\sigma_{mm} & \\sigma_{mp} \\\\ \\sigma_{mp} & \\sigma_{pp} \\end{pmatrix} + \\begin{pmatrix} \\sigma_{mm} & \\sigma_{mp} \\\\ \\sigma_{mp} & \\sigma_{pp} \\end{pmatrix} \\begin{pmatrix} -\\gamma_m & k_p \\\\ 0 & -\\gamma_p \\end{pmatrix} + \\begin{pmatrix} 2k_m & 0 \\\\ 0 & 2 \\frac{k_p k_m}{\\gamma_m} \\end{pmatrix} = \\begin{pmatrix} 0 & 0 \\\\ 0 & 0 \\end{pmatrix} $$\n$$ \\begin{pmatrix} -2\\gamma_m \\sigma_{mm} & k_p \\sigma_{mm} - (\\gamma_m+\\gamma_p)\\sigma_{mp} \\\\ k_p \\sigma_{mm} - (\\gamma_m+\\gamma_p)\\sigma_{mp} & 2k_p \\sigma_{mp} - 2\\gamma_p \\sigma_{pp} \\end{pmatrix} + \\begin{pmatrix} 2k_m & 0 \\\\ 0 & 2 \\frac{k_p k_m}{\\gamma_m} \\end{pmatrix} = \\begin{pmatrix} 0 & 0 \\\\ 0 & 0 \\end{pmatrix} $$\n从 $(1,1)$ 项可得：\n$-2\\gamma_m \\sigma_{mm} + 2k_m = 0 \\implies \\sigma_{mm} = \\frac{k_m}{\\gamma_m}$。即 $\\operatorname{Var}[m] = \\mathbb{E}[m]$，这表明 mRNA 服从泊松分布。\n\n从 $(1,2)$ 项可得：\n$k_p \\sigma_{mm} - (\\gamma_m+\\gamma_p)\\sigma_{mp} = 0 \\implies \\sigma_{mp} = \\frac{k_p \\sigma_{mm}}{\\gamma_m+\\gamma_p} = \\frac{k_p k_m}{\\gamma_m(\\gamma_m+\\gamma_p)}$。\n\n从 $(2,2)$ 项可得：\n$2k_p \\sigma_{mp} - 2\\gamma_p \\sigma_{pp} + 2 \\frac{k_p k_m}{\\gamma_m} = 0 \\implies \\gamma_p \\sigma_{pp} = k_p \\sigma_{mp} + \\frac{k_p k_m}{\\gamma_m}$。\n$\\sigma_{pp} = \\frac{k_p}{\\gamma_p} \\sigma_{mp} + \\frac{k_p k_m}{\\gamma_p \\gamma_m}$。\n代入 $\\sigma_{mp}$ 的表达式：\n$\\sigma_{pp} = \\frac{k_p}{\\gamma_p} \\left( \\frac{k_p k_m}{\\gamma_m(\\gamma_m+\\gamma_p)} \\right) + \\frac{k_p k_m}{\\gamma_p \\gamma_m}$。\n我们可以提出因子 $\\frac{k_p k_m}{\\gamma_p \\gamma_m} = \\mathbb{E}[p]$：\n$\\sigma_{pp} = \\frac{k_p k_m}{\\gamma_p \\gamma_m} \\left( \\frac{k_p}{\\gamma_m+\\gamma_p} + 1 \\right) = \\mathbb{E}[p] \\left( 1 + \\frac{k_p}{\\gamma_m+\\gamma_p} \\right)$。\n这就是蛋白质数量的稳态方差，$\\operatorname{Var}[p]$。\n\n蛋白质的稳态法诺因子为 $F = \\frac{\\operatorname{Var}[p]}{\\mathbb{E}[p]}$：\n$$ F = \\frac{\\mathbb{E}[p] \\left( 1 + \\frac{k_p}{\\gamma_m+\\gamma_p} \\right)}{\\mathbb{E}[p]} = 1 + \\frac{k_p}{\\gamma_m+\\gamma_p} $$\n法诺因子大于 1，表明蛋白质分布是超泊松分布（比泊松过程噪声更大）。这种额外的噪声，在此背景下通常称为外在噪声，源于 mRNA 分子数量的涨落，而 mRNA 分子作为蛋白质生产的涨落模板。\n\n第一个要求的量是蛋白质方差：\n$\\operatorname{Var}[p] = \\sigma_{pp} = \\frac{k_p k_m}{\\gamma_p \\gamma_m} \\left( 1 + \\frac{k_p}{\\gamma_m+\\gamma_p} \\right)$。\n第二个要求的量是法诺因子：\n$F = 1 + \\frac{k_p}{\\gamma_m+\\gamma_p}$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{k_p k_m}{\\gamma_p \\gamma_m} \\left( 1 + \\frac{k_p}{\\gamma_m+\\gamma_p} \\right) & 1 + \\frac{k_p}{\\gamma_m+\\gamma_p}\n\\end{pmatrix}\n}\n$$", "id": "3297565"}, {"introduction": "本实践通过解决一个合成生物学中真实的控制器设计问题，将理论与应用联系起来。你将研究一个反向积分反馈回路——这是一种实现鲁棒完美适应的强大基序——但其实现方式因有限的结合亲和力而存在“泄漏”（非理想）。你的任务是分析稳态误差与噪声引起的方差之间的权衡，并设计一个比例补偿器来优化控制器的整体性能，从而模拟一个完整的工程设计周期[@problem_id:3297612]。", "problem": "考虑一个生物调控背景下的对抗式积分反馈的典范质量作用模型，其中控制器物种之间的隔离具有有限亲和力，从而导致泄漏积分。受控物种表示为 $x$，控制器物种表示为 $z_1$、$z_2$，可逆隔离复合物为 $c$。被控对象被建模为一阶生成-降解过程，控制器实现对抗式积分反馈和可选的比例补偿器。有限亲和力由解离常数 $K_d$ 参数化，定义为 $K_d = k_{-}/k_{+}$，其中 $k_{+}$ 是正向结合速率，$k_{-}$ 是解离速率。\n\n基本核心定义：\n- 质量作用动力学：反应速率与反应物浓度的乘积成正比。\n- 针对小扰动的稳态线性化，以及用于线性随机系统中稳态协方差的李雅普诺夫方程。\n- 具有指定谱密度的反应通量的高斯白噪声输入。\n- 稳态误差是恒定参考设定点与受控变量稳态输出之间的差值。\n\n动力学：\n- 被控对象的动力学由下式给出\n$$\\frac{dx}{dt} = k_x z_1 - \\gamma_x x.$$\n- 具有可逆隔离和复合物降解的控制器动力学由下式给出\n$$\\frac{dz_1}{dt} = \\mu - k_{+} z_1 z_2 + k_{-} c - \\gamma_z z_1 - k_p (x - r),$$\n$$\\frac{dz_2}{dt} = \\theta x - k_{+} z_1 z_2 + k_{-} c - \\gamma_z z_2,$$\n$$\\frac{dc}{dt} = k_{+} z_1 z_2 - k_{-} c - \\eta c.$$\n此处，$k_x$ 是生成增益，$\\gamma_x$ 是 $x$ 的降解速率，$\\gamma_z$ 是控制器物种的降解（例如稀释）速率，$\\mu$ 是 $z_1$ 的参考输入生成速率，$\\theta$ 是从 $x$ 生成 $z_2$ 的测量增益，$\\eta$ 是复合物 $c$ 的降解速率，而 $k_p \\ge 0$ 是一个可选的比例补偿器，它根据误差 $(x-r)$ 作用于 $z_1$ 的生成，其中目标设定点为 $r = \\mu/\\theta$。可逆结合参数满足 $K_d = k_{-}/k_{+}$。\n\n噪声模型：\n- 两个独立的零均值高斯白噪声输入 $w_1(t)$ 和 $w_2(t)$ 分别扰动 $z_1$ 和 $z_2$ 的生成项。它们以谱密度（强度）$s_1$ 和 $s_2$ 加性地进入 $\\frac{dz_1}{dt}$ 和 $\\frac{dz_2}{dt}$：\n$$\\frac{dz_1}{dt} \\gets \\frac{dz_1}{dt} + w_1(t), \\quad \\mathbb{E}[w_1(t) w_1(t')] = s_1 \\delta(t-t'),$$\n$$\\frac{dz_2}{dt} \\gets \\frac{dz_2}{dt} + w_2(t), \\quad \\mathbb{E}[w_2(t) w_2(t')] = s_2 \\delta(t-t').$$\n所有其他反应都是确定性的。\n\n程序要执行的任务：\n1. 对于每个指定的参数集，通过求解平衡条件 $\\frac{dx}{dt} = 0$, $\\frac{dz_1}{dt} = 0$, $\\frac{dz_2}{dt} = 0$, $\\frac{dc}{dt} = 0$，计算当 $k_p = 0$ 时的稳态 $(x^\\ast, z_1^\\ast, z_2^\\ast, c^\\ast)$。\n2. 计算当 $k_p = 0$ 时的稳态误差 $e_\\infty = r - x^\\ast$。\n3. 对 $k_p = 0$ 时的动力学在稳态点附近进行线性化，以获得确定性动力学对状态向量 $\\begin{bmatrix} x & z_1 & z_2 & c \\end{bmatrix}^\\top$ 的雅可比矩阵 $A$，以及噪声输入 $w_1$ 和 $w_2$ 的输入矩阵 $B$，$w_1$ 和 $w_2$ 分别加到 $\\frac{dz_1}{dt}$ 和 $\\frac{dz_2}{dt}$ 上。使用线性噪声近似 (LNA)，求解连续时间李雅普诺夫方程\n$$A \\Sigma + \\Sigma A^\\top + B Q B^\\top = 0,$$\n其中 $Q = \\mathrm{diag}(s_1, s_2)$，以获得稳态协方差 $\\Sigma$。由此，计算由 $\\mathrm{Var}(e) = \\Sigma_{xx}$ 量化的噪声放大，即稳态下受控物种 $x$ 的方差（对于 $k_p=0$），其中由于 $r$ 是常数， $e = r - x$ 的方差等于 $x$ 的方差。\n4. 通过选择 $k_p \\in [0, k_p^{\\max}]$ 来设计比例补偿器，以最小化稳态下的期望平方误差 $\\mathbb{E}[e^2] = e_\\infty^2 + \\mathrm{Var}(e)$，并满足稳定性约束，即线性化的雅可比矩阵 $A$ 的所有特征值都具有严格为负的实部。通过对 $k_p$ 进行网格搜索来执行此最小化，并报告最优的 $k_p^\\ast$ 以及对应的 $\\mathbb{E}[e^2]$ 的最小值。\n\n对于此问题，所有速率和变量都是无量纲的；输出中不需要物理单位。不涉及角度。输出必须表示为十进制浮点数。\n\n测试套件和参数集：\n- 测试用例 1（“紧密结合，低噪声”）：\n    - $k_x = 1.2$, $\\gamma_x = 0.6$, $\\gamma_z = 0.05$, $\\mu = 10.0$, $\\theta = 1.0$, $k_{+} = 5.0$, $\\eta = 1.0$, $K_d = 1.0 \\times 10^{-6}$, $s_1 = 1.0 \\times 10^{-4}$, $s_2 = 1.0 \\times 10^{-4}$, $k_p^{\\max} = 3.0$。\n- 测试用例 2（“较弱结合，中等噪声”）：\n    - $k_x = 1.2$, $\\gamma_x = 0.6$, $\\gamma_z = 0.05$, $\\mu = 10.0$, $\\theta = 1.0$, $k_{+} = 5.0$, $\\eta = 1.0$, $K_d = 1.0 \\times 10^{-3}$, $s_1 = 1.0 \\times 10^{-3}$, $s_2 = 2.0 \\times 10^{-3}$, $k_p^{\\max} = 3.0$。\n- 测试用例 3（“中等结合，高噪声”）：\n    - $k_x = 1.2$, $\\gamma_x = 0.6$, $\\gamma_z = 0.05$, $\\mu = 10.0$, $\\theta = 1.0$, $k_{+} = 5.0$, $\\eta = 1.0$, $K_d = 1.0 \\times 10^{-4}$, $s_1 = 5.0 \\times 10^{-3}$, $s_2 = 5.0 \\times 10^{-3}$, $k_p^{\\max} = 3.0$。\n\n算法约束和假设：\n- 应通过求解 $w_1 = w_2 = 0$ 时的平衡方程来找到稳态。\n- 为保证数值鲁棒性，稳态计算可以使用质量作用关系来简化代数系统，但不应依赖于本说明中提供的任何捷径公式。\n- 必须通过雅可比矩阵 $A$ 的特征值来验证稳定性。\n- 应使用标准的线性代数程序来求解李雅普诺夫方程以获得 $\\Sigma$。\n\n要求的最终输出格式：\n- 对于每个测试用例 $i$，按顺序生成四个值：$(k_p=0 \\text{ 时的 } e_{\\infty}^{(i)})$，$(k_p=0 \\text{ 时的 } \\mathrm{Var}(e)^{(i)})$，$(\\min_{k_p \\in [0,k_p^{\\max}]} \\mathbb{E}[e^2]^{(i)})$，$(k_p^{\\ast\\,(i)})$。\n- 将所有测试用例的结果聚合到单行中，作为一个由方括号括起来的逗号分隔列表，顺序为测试用例 1、2、3。具体来说，输出行必须是：\n$$[e_{\\infty}^{(1)}, \\mathrm{Var}(e)^{(1)}, \\min \\mathbb{E}[e^2]^{(1)}, k_p^{\\ast\\,(1)}, e_{\\infty}^{(2)}, \\mathrm{Var}(e)^{(2)}, \\min \\mathbb{E}[e^2]^{(2)}, k_p^{\\ast\\,(2)}, e_{\\infty}^{(3)}, \\mathrm{Var}(e)^{(3)}, \\min \\mathbb{E}[e^2]^{(3)}, k_p^{\\ast\\,(3)}].$$", "solution": "用户提供了一个计算系统生物学领域中关于具有对抗式积分反馈的基因回路的分析与控制的适定问题。该问题具有科学依据，经过形式化规定，并需要一系列该领域的标准计算任务。我将基于质量作用动力学、系统线性化和使用李雅普诺夫方程进行随机分析的原理，逐步进行求解。\n\n### 第一部分：$k_p = 0$ 时的系统分析（纯积分控制）\n\n首先，我们确定系统的稳态，并分析其在没有比例补偿器（即 $k_p = 0$）时的行为。通过在确定性模型中将所有时间导数设置为零，可以找到稳态浓度 $(x^\\ast, z_1^\\ast, z_2^\\ast, c^\\ast)$。\n\n常微分方程组为：\n$$ \\frac{dx}{dt} = k_x z_1 - \\gamma_x x $$\n$$ \\frac{dz_1}{dt} = \\mu - k_{+} z_1 z_2 + k_{-} c - \\gamma_z z_1 $$\n$$ \\frac{dz_2}{dt} = \\theta x - k_{+} z_1 z_2 + k_{-} c - \\gamma_z z_2 $$\n$$ \\frac{dc}{dt} = k_{+} z_1 z_2 - k_{-} c - \\eta c $$\n\n在稳态（$\\frac{d}{dt} = 0$）下，我们得到一个代数方程组。通过系统性代入，我们可以将此系统简化为关于某个状态变量的单一二次方程。\n从被控对象的动力学可知，$x^\\ast$ 和 $z_1^\\ast$ 之间存在直接关系：\n$$ x^\\ast = \\frac{k_x}{\\gamma_x} z_1^\\ast $$\n从复合物的动力学可知，我们将 $c^\\ast$ 表示为 $z_1^\\ast$ 和 $z_2^\\ast$ 的函数：\n$$ c^\\ast = \\frac{k_{+} z_1^\\ast z_2^\\ast}{k_{-} + \\eta} $$\n将 $\\frac{dz_1}{dt}$ 的稳态方程减去 $\\frac{dz_2}{dt}$ 的稳态方程，得到：\n$$ 0 = \\mu - \\theta x^\\ast - \\gamma_z(z_1^\\ast - z_2^\\ast) \\implies z_2^\\ast = z_1^\\ast - \\frac{\\mu - \\theta x^\\ast}{\\gamma_z} $$\n将 $x^\\ast = (k_x/\\gamma_x) z_1^\\ast$ 代入 $z_2^\\ast$ 的表达式中：\n$$ z_2^\\ast = z_1^\\ast \\left(1 + \\frac{\\theta k_x}{\\gamma_x \\gamma_z}\\right) - \\frac{\\mu}{\\gamma_z} $$\n最后，将 $c^\\ast$ 的表达式代入 $\\frac{dz_1}{dt}$ 的稳态方程中：\n$$ \\mu = k_{+} z_1^\\ast z_2^\\ast - k_{-} \\left(\\frac{k_{+} z_1^\\ast z_2^\\ast}{k_{-} + \\eta}\\right) + \\gamma_z z_1^\\ast = \\frac{k_{+} \\eta}{k_{-} + \\eta} z_1^\\ast z_2^\\ast + \\gamma_z z_1^\\ast $$\n将 $z_2^\\ast$ 的表达式代入最后一个方程，得到一个形式为 $A(z_1^\\ast)^2 + B z_1^\\ast + C = 0$ 的二次方程，其系数为：\n$$ A = \\frac{k_{+} \\eta}{k_{-} + \\eta} \\left(1 + \\frac{\\theta k_x}{\\gamma_x \\gamma_z}\\right) $$\n$$ B = \\gamma_z - \\frac{k_{+} \\eta}{k_{-} + \\eta} \\frac{\\mu}{\\gamma_z} $$\n$$ C = -\\mu $$\n由于所有参数均为正数，$A > 0$ 且 $C < 0$，这保证了存在一个正实根和一个负实根。我们取正根作为浓度 $z_1^\\ast$。确定 $z_1^\\ast$ 后，即可计算所有其他稳态变量。稳态误差为 $e_\\infty = r - x^\\ast$，其中设定点为 $r = \\mu/\\theta$。\n\n接下来，为了分析噪声传播，我们围绕此稳态对系统进行线性化。状态向量为 $X = [x, z_1, z_2, c]^\\top$。线性化后的动力学由 $\\frac{d(\\delta X)}{dt} = A (\\delta X) + Bw$ 描述，其中 $A$ 是在稳态点处求值的雅可比矩阵，$w = [w_1, w_2]^\\top$ 是白噪声输入向量。$k_p=0$ 时的雅可比矩阵为：\n$$ A = \\begin{bmatrix}\n-\\gamma_x & k_x & 0 & 0 \\\\\n0 & -k_{+} z_2^\\ast - \\gamma_z & -k_{+} z_1^\\ast & k_{-} \\\\\n\\theta & -k_{+} z_2^\\ast & -k_{+} z_1^\\ast - \\gamma_z & k_{-} \\\\\n0 & k_{+} z_2^\\ast & k_{+} z_1^\\ast & -k_{-} - \\eta\n\\end{bmatrix} $$\n噪声输入矩阵 $B$ 将噪声源映射到相应的状态方程：\n$$ B = \\begin{bmatrix} 0 & 0 \\\\ 1 & 0 \\\\ 0 & 1 \\\\ 0 & 0 \\end{bmatrix} $$\n稳态协方差矩阵 $\\Sigma$ 是连续时间李雅普诺夫方程的解：\n$$ A \\Sigma + \\Sigma A^\\top + B Q B^\\top = 0 $$\n其中 $Q = \\mathrm{diag}(s_1, s_2)$ 是噪声强度的对角矩阵。受控物种 $x$ 的方差由 $\\mathrm{Var}(x) = \\Sigma_{11}$ 给出，由于 $r$ 是常数，该方差等于误差的方差 $\\mathrm{Var}(e)$。\n\n### 第二部分：最优比例补偿器设计\n\n比例补偿器在 $z_1$ 的动力学中引入了项 $-k_p(x-r)$。目标是选择一个增益 $k_p \\ge 0$，以最小化均方误差 $\\mathbb{E}[e^2] = (e_\\infty(k_p))^2 + \\mathrm{Var}(e)(k_p)$，同时满足系统保持稳定的约束。\n\n对于所选搜索网格 $[0, k_p^{\\max}]$ 中的每个 $k_p$ 值，我们必须重新评估稳态以及系统的稳定性和噪声性能。现在的稳态 $(x^{\\ast\\ast}, z_1^{\\ast\\ast}, z_2^{\\ast\\ast}, c^{\\ast\\ast})$ 依赖于 $k_p$。其求解过程与 $k_p=0$ 的情况类似，最终会得到一个关于 $z_1^{\\ast\\ast}$ 的二次方程，其系数 $A'(k_p), B'(k_p), C'(k_p)$ 是 $k_p$ 的函数。\n\n雅可比矩阵 $A(k_p)$ 也被更新，其中元素 $A_{21}$ 从 $0$ 变为 $-k_p$：\n$$ A(k_p) = \\begin{bmatrix}\n-\\gamma_x & k_x & 0 & 0 \\\\\n-k_p & -k_{+} z_2^{\\ast\\ast} - \\gamma_z & -k_{+} z_1^{\\ast\\ast} & k_{-} \\\\\n\\theta & -k_{+} z_2^{\\ast\\ast} & -k_{+} z_1^{\\ast\\ast} - \\gamma_z & k_{-} \\\\\n0 & k_{+} z_2^{\\ast\\ast} & k_{+} z_1^{\\ast\\ast} & -k_{-} - \\eta\n\\end{bmatrix} $$\n其中稳态浓度是 $k_p$ 的函数。\n\n通过网格搜索执行优化：\n1.  将区间 $[0, k_p^{\\max}]$ 离散化。\n2.  对于网格中的每个 $k_p$：\n    a. 计算稳态 $(x^{\\ast\\ast}, z_1^{\\ast\\ast}, z_2^{\\ast\\ast}, c^{\\ast\\ast})$。\n    b. 构建雅可比矩阵 $A(k_p)$。\n    c. 通过确保 $A(k_p)$ 的所有特征值都具有严格为负的实部来检查稳定性。\n    d. 如果稳定，则计算稳态误差 $e_\\infty(k_p) = r-x^{\\ast\\ast}$，并求解李雅普诺夫方程得到协方差 $\\Sigma(k_p)$，从而找到 $\\mathrm{Var}(e)(k_p) = \\Sigma_{11}(k_p)$。\n    e. 计算总均方误差 $\\mathbb{E}[e^2](k_p) = (e_\\infty(k_p))^2 + \\mathrm{Var}(e)(k_p)$。不稳定的点被赋予无穷大误差。\n3.  最优增益 $k_p^\\ast$ 是在网格上产生最小 $\\mathbb{E}[e^2]$ 的值。\n\n这个综合过程使我们能够为每个参数集计算所需的四个度量：基本积分控制器（$k_p=0$）的稳态误差和方差，以及比例积分控制器的最小可实现均方误差和最优增益 $k_p^\\ast$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import solve_lyapunov\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases.\n    \"\"\"\n    test_cases = [\n        # Test case 1 (\"tight binding, low noise\")\n        {\n            \"k_x\": 1.2, \"gamma_x\": 0.6, \"gamma_z\": 0.05, \"mu\": 10.0, \"theta\": 1.0,\n            \"k_plus\": 5.0, \"eta\": 1.0, \"K_d\": 1.0e-6, \"s1\": 1.0e-4, \"s2\": 1.0e-4,\n            \"kp_max\": 3.0\n        },\n        # Test case 2 (\"weaker binding, moderate noise\")\n        {\n            \"k_x\": 1.2, \"gamma_x\": 0.6, \"gamma_z\": 0.05, \"mu\": 10.0, \"theta\": 1.0,\n            \"k_plus\": 5.0, \"eta\": 1.0, \"K_d\": 1.0e-3, \"s1\": 1.0e-3, \"s2\": 2.0e-3,\n            \"kp_max\": 3.0\n        },\n        # Test case 3 (\"moderate binding, high noise\")\n        {\n            \"k_x\": 1.2, \"gamma_x\": 0.6, \"gamma_z\": 0.05, \"mu\": 10.0, \"theta\": 1.0,\n            \"k_plus\": 5.0, \"eta\": 1.0, \"K_d\": 1.0e-4, \"s1\": 5.0e-3, \"s2\": 5.0e-3,\n            \"kp_max\": 3.0\n        }\n    ]\n\n    all_results = []\n    for params in test_cases:\n        results = run_case(params)\n        all_results.extend(results)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.8f}' for r in all_results)}]\")\n\ndef get_steady_state(k_p, params):\n    \"\"\"Calculates the steady state for a given k_p.\"\"\"\n    k_x, gamma_x, gamma_z, mu, theta = params[\"k_x\"], params[\"gamma_x\"], params[\"gamma_z\"], params[\"mu\"], params[\"theta\"]\n    k_plus, eta, K_d = params[\"k_plus\"], params[\"eta\"], params[\"K_d\"]\n    \n    k_minus = K_d * k_plus\n    r = mu / theta\n\n    # Coefficients for the quadratic equation in z1_ss\n    # A'(z1_ss)^2 + B'(z1_ss) + C' = 0\n    alpha = (k_plus * eta) / (k_minus + eta)\n    \n    P_kp = 1 + ((k_p + theta) * k_x) / (gamma_x * gamma_z)\n    Q_kp = (mu + k_p * r) / gamma_z\n    beta_kp = gamma_z + k_p * (k_x / gamma_x)\n\n    A_prime = alpha * P_kp\n    B_prime = beta_kp - alpha * Q_kp\n    C_prime = -(mu + k_p * r)\n    \n    # Solve quadratic for z1_ss, taking the positive root\n    discriminant = B_prime**2 - 4 * A_prime * C_prime\n    if discriminant < 0:\n        return None # Should not happen based on analysis\n    z1_ss = (-B_prime + np.sqrt(discriminant)) / (2 * A_prime)\n\n    # Back-calculate other steady-state variables\n    x_ss = (k_x / gamma_x) * z1_ss\n    z2_ss = z1_ss * (1 + ((k_p + theta) * k_x) / (gamma_x * gamma_z)) - (mu + k_p * r) / gamma_z\n    c_ss = (k_plus * z1_ss * z2_ss) / (k_minus + eta)\n    \n    ss = np.array([x_ss, z1_ss, z2_ss, c_ss])\n    if np.any(ss < 0):\n        return None  # Non-physical solution\n\n    return ss\n\ndef run_case(params):\n    \"\"\"\n    Executes all tasks for a single parameter set.\n    \"\"\"\n    k_x, gamma_x, gamma_z, mu, theta = params[\"k_x\"], params[\"gamma_x\"], params[\"gamma_z\"], params[\"mu\"], params[\"theta\"]\n    k_plus, eta, K_d, s1, s2, kp_max = params[\"k_plus\"], params[\"eta\"], params[\"K_d\"], params[\"s1\"], params[\"s2\"], params[\"kp_max\"]\n    \n    k_minus = K_d * k_plus\n    r = mu / theta\n    \n    # --- Task 1 & 2: Steady-state error for k_p = 0 ---\n    ss_0 = get_steady_state(0.0, params)\n    if ss_0 is None:\n        raise ValueError(\"Failed to find a valid steady state for k_p=0.\")\n    x_star_0 = ss_0[0]\n    e_inf_0 = r - x_star_0\n    \n    # --- Task 3: Variance for k_p = 0 ---\n    z1_star_0, z2_star_0 = ss_0[1], ss_0[2]\n    A_0 = np.array([\n        [-gamma_x, k_x, 0, 0],\n        [0, -k_plus * z2_star_0 - gamma_z, -k_plus * z1_star_0, k_minus],\n        [theta, -k_plus * z2_star_0, -k_plus * z1_star_0 - gamma_z, k_minus],\n        [0, k_plus * z2_star_0, k_plus * z1_star_0, -k_minus - eta]\n    ])\n    \n    BQB_T = np.diag([0, s1, s2, 0])\n    \n    # Check stability\n    eigs_0 = np.linalg.eigvals(A_0)\n    if np.any(np.real(eigs_0) >= 0):\n        raise RuntimeError(\"System is unstable at k_p=0.\")\n        \n    Sigma_0 = solve_lyapunov(A_0, -BQB_T)\n    var_e_0 = Sigma_0[0, 0]\n\n    # --- Task 4: Optimization over k_p ---\n    kp_grid = np.linspace(0, kp_max, 301)\n    mse_values = []\n    \n    for kp in kp_grid:\n        ss_kp = get_steady_state(kp, params)\n        if ss_kp is None:\n            mse_values.append(np.inf)\n            continue\n        \n        x_ss, z1_ss, z2_ss, c_ss = ss_kp\n        \n        A_kp = np.array([\n            [-gamma_x, k_x, 0, 0],\n            [-kp, -k_plus * z2_ss - gamma_z, -k_plus * z1_ss, k_minus],\n            [theta, -k_plus * z2_ss, -k_plus * z1_ss - gamma_z, k_minus],\n            [0, k_plus * z2_ss, k_plus * z1_ss, -k_minus - eta]\n        ])\n        \n        eigs_kp = np.linalg.eigvals(A_kp)\n        if np.any(np.real(eigs_kp) >= 0):\n            mse_values.append(np.inf)\n            continue\n            \n        Sigma_kp = solve_lyapunov(A_kp, -BQB_T)\n        var_e_kp = Sigma_kp[0, 0]\n        e_inf_kp = r - x_ss\n        mse = e_inf_kp**2 + var_e_kp\n        mse_values.append(mse)\n\n    min_mse_idx = np.argmin(mse_values)\n    min_mse = mse_values[min_mse_idx]\n    kp_star = kp_grid[min_mse_idx]\n    \n    return [e_inf_0, var_e_0, min_mse, kp_star]\n\nif __name__ == \"__main__\":\n    solve()\n\n```", "id": "3297612"}]}