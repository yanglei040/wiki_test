## 引言
精确设计和操控[基因调控回路](@entry_id:749823)是合成生物学与系统生物学领域的核心追求，它预示着我们能够像工程师编程计算机一样对细胞行为进行编程。然而，从定性的设计理念走向可预测、可重复的定量控制，需要一个严谨的数学框架来应对[生物系统](@entry_id:272986)内在的复杂性、[非线性](@entry_id:637147)和随机性。本文旨在填补这一知识鸿沟，为读者提供一套系统性的[最优控制理论](@entry_id:139992)工具，以理解、分析和工程化基因调控网络。

在本文中，读者将踏上一段从理论到实践的旅程。首先，在“**原理与机制**”章节中，我们将深入探讨构建[基因回路](@entry_id:201900)数学模型的基础，定义何为“最优”控制，阐明[可控性与可观测性](@entry_id:174003)的基本限制，并介绍求解这些问题的核心算法。接着，在“**应用与交叉学科关联**”章节中，我们将把这些理论应用于真实的[生物工程](@entry_id:270890)问题，例如调控细胞状态切换和生物节律，并探索其与博弈论、机器学习等前沿领域的[交叉](@entry_id:147634)融合。最后，通过“**动手实践**”部分，读者将有机会将所学知识付诸实践，为典型的[基因回路设计](@entry_id:264642)并实现控制器，从而巩固对核心概念的理解。

## 原理与机制

为了对[基因调控回路](@entry_id:749823)进行设计和操控，我们必须首先建立能够捕捉其内在动态并响应外部输入的数学模型。本章将深入探讨这些模型的构建原理，明确“最优”控制的目标，阐述[可控性与可观测性](@entry_id:174003)的基本限制，并介绍求解这些最优控制问题的核心机制。

### [基因调控回路](@entry_id:749823)的控制建模

选择合适的数学框架是任何[控制理论应用](@entry_id:264360)的基石。对于[基因调控回路](@entry_id:749823)，这一选择通常是在确定性[连续模](@entry_id:158807)型和随机性离散模型之间进行权衡。

#### 模型的选择：确定性 vs. 随机性

最直观的建模方法是基于[化学反应动力学](@entry_id:274455)的**常微分方程 (Ordinary Differential Equation, ODE)**。该方法将细胞内各种分子（如mRNA和蛋白质）的数量视为连续的浓度变量，并假设在一个充分混合的细胞体积内，[反应速率](@entry_id:139813)遵循质量作用定律。这种确定性模型的基本假设是，分子数量足够庞大，以至于[化学反应](@entry_id:146973)的内在随机波动可以忽略不计。例如，描述蛋白质对其自身[启动子](@entry_id:156503)进行调控的Hill型动力学函数，可以通过假设[转录因子](@entry_id:137860)与[启动子](@entry_id:156503)位点的结合与解离过程相对于转录和降解过程快得多，从而达到一种准[稳态平衡](@entry_id:137090)来合理化。这种近似处理产生了一个关于调控物浓度的平滑输入-输出关系。在单细胞背景下，仅当每个物种的分子数量足够大，且[启动子](@entry_id:156503)状态切换等离散事件相对于合成与降解过程快到可以被有效平均时，OD[E模](@entry_id:160271)型才是有效的。此时，外部控制输入 $u(t)$，例如一个诱导物浓度，可以被视为一个有界的、[分段连续](@entry_id:174613)的函数，直接进入[反应速率](@entry_id:139813)表达式中 [@problem_id:3335297]。

然而，在单细胞水平上，基因表达通常涉及数量极少的分子，例如mRNA的拷贝数可能低于10。在这种低拷贝数场景下，[化学反应](@entry_id:146973)的随机性变得不可忽略。此时，我们需要一个更为基础的随机性模型——**[化学主方程](@entry_id:161378) (Chemical Master Equation, CME)**。CME放弃了连续浓度的假设，转而将系统的状态描述为一个包含每种分子精确数量的离散整数向量，例如 $X(t) = (N_m(t), N_p(t))^T$ 代表t时刻mRNA和蛋白质的分子数。[化学反应](@entry_id:146973)被视为概率性的、离散的跳跃事件。系统的演化不再是一条确定的轨迹，而是状态空间上[概率分布](@entry_id:146404) $P(X, t)$ 的演化，其演化规律由CME本身这个无限维的线性ODE系统所描述。

这两种模型的根本区别在于它们描述的对象不同：ODE描述的是平均浓度的确定性演化，而CME描述的是整个[概率分布](@entry_id:146404)的随机演化。当mRNA拷贝数很低，或[启动子](@entry_id:156503)在“开”和“关”状态之间的切换相对于mRNA的寿命很慢时，CME变得至关重要。这种缓慢的切换会导致转录“脉冲”现象（transcriptional bursting），即在[启动子](@entry_id:156503)“开启”期间产生一阵mRNA分子，随后是“关闭”期间的静默。这种脉冲行为常常导致mRNA和蛋白质数量呈现出宽泛甚至双峰的[分布](@entry_id:182848)，这是任何单一的确定性ODE轨迹都无法捕捉的现象 [@problem_id:3335297]。

#### 控制信号的整合

无论在哪种模型框架下，外部控制输入 $u(t)$ 都通过调节一个或多个关键反应的速率或倾向性来影响系统。

在OD[E模](@entry_id:160271)型中，$u(t)$ 通常作为转录[速率函数](@entry_id:154177)的一个[乘性](@entry_id:187940)因子或调控函数的一部分。例如，一个简单的激活模型可能是 $k_{\text{prod}} \cdot u(t)$，或者一个更复杂的Hill型函数 $\frac{\alpha u(t)^n}{K^n + u(t)^n}$。最优控制的目标就是设计一个时间函数 $u(t)$，在满足物理约束（如 $u(t) \in [0, u_{\max}]$）的前提下，引导系统状态 $x(t)$ 朝着期望的目标演化。

在C[ME模型](@entry_id:261918)中，$u(t)$ 调节的是离散反应事件的**倾向性函数 (propensity function)** $a_j(X, u(t))$。例如，一个受控的转录事件的倾向性可能被建模为 $a_{\text{tx}}(u(t))$。这意味着[控制信号](@entry_id:747841)实时地改变了单个反应事件发生的瞬时概率。因此，对CME进行[最优控制](@entry_id:138479)，实际上是在设计一个策略，通过调节这些倾向性来塑造整个状态[概率分布](@entry_id:146404)的演化 [@problem_id:3335297]。

#### [线性噪声近似](@entry_id:190628)：连接[确定性与随机性](@entry_id:636235)的桥梁

直接求解CME在计算上非常昂贵。**[线性噪声近似](@entry_id:190628) (Linear Noise Approximation, [LNA](@entry_id:150014))** 提供了一个有效的折衷方案，它在保留随机性的同时，大大简化了分析。[LNA](@entry_id:150014)将分子数量 $n(t)$ 分解为两部分：一个宏观的、确定性的平均浓度 $\bar{n}(t)$（由ODE描述）和一个围绕该平均值的随机波动项 $\xi(t)$，即 $n(t) = \bar{n}(t) + \xi(t)$。[LNA](@entry_id:150014)的核心结论是，波动项 $\xi(t)$ 的动力学可以用一个线性的随机微分方程（即[Ornstein-Uhlenbeck过程](@entry_id:140047)）来近似：
$$
\frac{d\xi(t)}{dt} = J \xi(t) + \sqrt{D} \eta(t)
$$
这里，$J$ 是[确定性系统](@entry_id:174558)在[稳态](@entry_id:182458) $\bar{n}$ 处的雅可比矩阵，它描述了波动的确定性[回复力](@entry_id:269582)（即系统如何抵抗偏离均值的扰动）。$D$ 是[扩散矩阵](@entry_id:182965)，其大小与[稳态](@entry_id:182458)下的[反应倾向](@entry_id:262886)性之和成正比，代表了驱动波动的随机“推力”的强度。$\eta(t)$ 是一个标准[高斯白噪声](@entry_id:749762)过程。

以一个受控的[生灭过程](@entry_id:168595)为例，其合成速率为 $a_{+}(u) = k_{0} + k_{u} u$，降解速率为 $a_{-}(n) = \gamma n$。确定性[稳态](@entry_id:182458)为 $\bar{n} = (k_0 + k_u u)/\gamma$。通过[LNA](@entry_id:150014)，我们可以计算出系统的雅可比矩阵（在此为标量）$J = -\gamma$，[扩散](@entry_id:141445)项强度 $D = 2(k_0 + k_u u)$。利用这些参数，我们可以求解一个[Lyapunov方程](@entry_id:165178)来得到波动的[稳态](@entry_id:182458)[方差](@entry_id:200758) $\Sigma(u)$ [@problem_id:3335303]：
$$
\Sigma(u) = \frac{k_{0} + k_{u} u}{\gamma}
$$
有趣的是，这个结果恰好等于[稳态](@entry_id:182458)平均值 $\bar{n}$，这与该线性[生灭过程](@entry_id:168595)的精确解（[泊松分布](@entry_id:147769)）的性质（[方差](@entry_id:200758)等于均值）相符。此外，[LNA](@entry_id:150014)还允许我们分析波动的动态特性，例如**[功率谱密度](@entry_id:141002) (Power Spectral Density, PSD)** $S(\omega;u)$ 和**[自相关函数](@entry_id:138327) (Autocorrelation Function)** $C(\tau;u)$。对于这个例子，$C(\tau;u) = \Sigma(u) \exp(-\gamma |\tau|)$，$S(\omega;u) \propto \frac{\Sigma(u)}{\gamma^2+\omega^2}$。分析表明，控制输入 $u$ 能够调节波动的总功率（[方差](@entry_id:200758)），但波动的“颜色”（由PSD形状决定）和“记忆”（由[自相关时间](@entry_id:140108) $1/\gamma$ 决定）则由系统的内在参数（如降解率 $\gamma$）所决定 [@problem_id:3335303]。

### [最优控制](@entry_id:138479)问题的构建

一旦我们有了模型，下一步就是精确定义我们希望实现的目标。这通过设计一个**目标函数 (objective function)** 或**[成本泛函](@entry_id:268062) (cost functional)** 来完成。

#### 定义目标：何为“最优”？

在[最优控制](@entry_id:138479)中，“最优”的含义完全取决于我们选择的数学度量。一个在工程和生物学中都极为常用和强大的框架是**[线性二次调节器](@entry_id:267871) (Linear-Quadratic Regulator, LQR)** 的思想，它对应于一个二次型[成本泛函](@entry_id:268062)。对于一个希望将系统状态 $x(t)$ 驱动到参考轨迹 $x_{\text{ref}}(t)$ 的任务，一个典型的[成本泛函](@entry_id:268062)形式如下 [@problem_id:3335274]：
$$
J(u) = \int_0^T \Big[(x(t)-x_{\text{ref}}(t))^{\top} Q \, (x(t)-x_{\text{ref}}(t)) + u(t)^{\top} R \, u(t)\Big] \, dt
$$
这个泛函由两部分构成：

1.  **追踪误差成本**：第一项 $(x(t)-x_{\text{ref}}(t))^{\top} Q \, (x(t)-x_{\text{ref}}(t))$ 惩罚了系统状态 $x(t)$ 与目标 $x_{\text{ref}}(t)$ 之间的偏离。权重矩阵 $Q$（通常是半正定的，$Q \succeq 0$）编码了追踪性能的重要性。例如，通过设置 $Q$ 的对角元素，我们可以指定对某些基因产物的浓度控制要比其他基因更精确。
2.  **控制努力成本**：第二项 $u(t)^{\top} R \, u(t)$ 惩罚了控制输入 $u(t)$ 本身的大小。权重矩阵 $R$（通常是正定的，$R \succ 0$）具有深刻的生物学意义：它代表了实施控制的“代价”。这个代价可以是能量消耗、诱导剂的细胞毒性、[光遗传学](@entry_id:175696)中光照的[光毒性](@entry_id:184757)，或是其他不良副作用。一个较大的 $R$ 会促使控制器寻求更“经济”或“温和”的干预方式。

因此，最小化 $J(u)$ 的过程本质上是在**追踪性能**与**干预负担**之间寻找一个最优的[平衡点](@entry_id:272705)。改变 $Q$ 和 $R$ 矩阵中元素的大小，可以直接调整这种权衡：增加 $Q$ 的元素会使控制器更“激进”，以牺牲更大的控制努力为代价来换取更小的追踪误差；而增加 $R$ 的元素则会使控制器更“保守” [@problem_id:3335274]。

这种二次型目标与其他类型的目标（如最小化到达目标区域时间的**[最小时间控制](@entry_id:166082)**，或是在随机设定下最小化输出[方差](@entry_id:200758)的**最小[方差](@entry_id:200758)控制**）有着本质的区别 [@problem_id:3335274]。

#### 高级目标：调控整个[分布](@entry_id:182848)

在许多生物学应用中，我们关心的不仅仅是细胞群体的平均行为，还有群体内部的异质性。例如，在[干细胞分化](@entry_id:270116)或药物响应中，我们可能希望得到一个特定比例的两种不同表型的细胞，即一个双峰的基因表达[分布](@entry_id:182848)。这就引出了**[分布](@entry_id:182848)调控 (distributional regulation)** 的概念：控制的目标不再是状态的平均值，而是其[稳态概率](@entry_id:276958)[分布](@entry_id:182848) $p_u$ 的完整形态。

为了量化一个已达到的[分布](@entry_id:182848) $p_u$与一个[目标分布](@entry_id:634522) $p^*$之间的差异，我们可以使用信息论中的**Kullback-Leibler (KL) 散度**。KL散度 $D_{\mathrm{KL}}(p_u \Vert p^*)$ 是一个非负的量，当且仅当 $p_u = p^*$ 时才为零。这使得它成为一个理想的损失函数。因此，一个有良好理论基础的[分布](@entry_id:182848)调控目标是 [@problem_id:3335283]：
$$
\text{最小化} \quad J(u) = D_{\mathrm{KL}}(p_{u} \Vert p^{\ast})
$$
在实际应用中，我们通常还会加入对控制努力的惩罚，形成一个正则化的目标函数：
$$
\text{最小化} \quad J(u) = D_{\mathrm{KL}}(p_{u} \Vert p^{\ast}) + \lambda c(u)
$$
其中 $c(u)$ 是控制[成本函数](@entry_id:138681)（例如 $u^2$），$\lambda > 0$ 是权衡性能与成本的正则化参数。这种方法为精确塑造细胞群体[异质性](@entry_id:275678)提供了一个强大的理论框架 [@problem_id:3335283]。

### 基本限制：[可控性与可观测性](@entry_id:174003)

在尝试解决一个[最优控制](@entry_id:138479)问题之前，我们必须回答两个更基本的问题：这个系统，利用我们拥有的控制手段，是否真的能够被驱动到我们想要的状态？以及，我们是否能通过可用的测量方法，获知系统当前的状态？这两个问题分别对应于**[可控性](@entry_id:148402) (controllability)** 和**可观测性 (observability)**。

#### [可控性](@entry_id:148402)：我们能到达目标吗？

**可控性**是指利用容许的控制输入，在有限时间内将系统从任意初始状态驱动到任意最终状态的能力。对于像[基因回路](@entry_id:201900)这样的非线性系统，这是一个复杂的问题。一个强大的分析工具是先在系统的某个[平衡点](@entry_id:272705) $x^\star$ 附近进行线性化，得到一个线性时不变(LTI)系统 $\dot{\xi} = A\xi + Bu$，其中 $\xi = x - x^\star$ 是状态偏差。

对于这个线性化系统，其[可控性](@entry_id:148402)由**[卡尔曼秩条件](@entry_id:177700) (Kalman rank condition)** 判定：系统是可控的，当且仅当其[可控性矩阵](@entry_id:271824) $\mathcal{C}$ 具有满秩（即秩为 $n$，状态空间的维度）：
$$
\text{rank}(\mathcal{C}) = \text{rank}(\begin{pmatrix} B & AB & A^2B & \cdots & A^{n-1}B \end{pmatrix}) = n
$$
一个关键的结论是：如果一个非线性系统在某个[平衡点](@entry_id:272705)的线性化模型是可控的，那么原始的非线性系统在该[平衡点](@entry_id:272705)附近是**局部可控的 (locally controllable)**。这意味着我们至少可以在该[平衡点](@entry_id:272705)的一个小邻域内自由地驱动系统 [@problem_id:3335252]。

更深入的[非线性](@entry_id:637147)理论，如基于**[李代数秩条件](@entry_id:163698) (Lie Algebra Rank Condition, LARC)** 的分析，提供了更普遍的可控性判据，称为**可达性 (accessibility)**。有趣的是，在[平衡点](@entry_id:272705) $f(x^\star)=0$ 处，LARC条件与[卡尔曼秩条件](@entry_id:177700)是等价的 [@problem_id:3335252]。

#### [可达集](@entry_id:276191)：我们具体能到达哪些状态？

[可控性](@entry_id:148402)是一个“是/否”的问题，而**[可达集](@entry_id:276191) (reachable set)** $\mathcal{R}(T)$ 则是一个更精细的概念，它描述了在给定的控制约束下（例如，控制能量 $\int_0^T \|u(t)\|_2^2 dt \le u_{\max}^2$），从某个初始状态出发，在时间 $T$ 内所有能够到达的状态的集合。

对于非线性系统，精确计算[可达集](@entry_id:276191)极为困难。然而，对于线性化系统，[可达集](@entry_id:276191)具有优美的几何结构。在给定的 $L^2$ 范数约束下，从原点出发的[可达集](@entry_id:276191)是一个由**可控性格拉米安矩阵 (controllability Gramian)** $W_c(T)$ 定义的椭球：
$$
W_c(T) = \int_0^T e^{A\tau} B B^\top e^{A^\top \tau} d\tau
$$
这个椭球 $\mathcal{E} = \{ \tilde{x} \mid \tilde{x}^\top W_c(T)^{-1} \tilde{x} \le u_{\max}^2 \}$ 为我们提供了非线性系统[可达集](@entry_id:276191)的一个内部近似。$W_c(T)$ 的[特征向量](@entry_id:151813)指出了[状态空间](@entry_id:177074)中“最容易”和“最难”控制的方向（分别对应于最大和最小的[特征值](@entry_id:154894)）。这个椭球的体积和形状量化了系统在不同方向上的机动能力 [@problem_id:3335289]。

#### 可观测性：我们能看到发生了什么吗？

**[可观测性](@entry_id:152062)**是[可控性](@entry_id:148402)的对偶概念。它关注的是：我们是否能通过观察系统的输出 $y(t)$（例如，[荧光蛋白](@entry_id:202841)的亮度），在有限时间内唯一地确定系统的初始内部状态 $x(0)$？如果不能，那么即使系统是可控的，我们也无法实现有效的[反馈控制](@entry_id:272052)，因为我们不知道系统当前在哪里，也就不知道应该施加什么样的校正。

对于[线性系统](@entry_id:147850) $\dot{x}=Ax$, $y=Cx$，[可观测性](@entry_id:152062)同样可以用一个格拉米安矩阵来表征，即**[可观测性](@entry_id:152062)格拉米安矩阵 (observability Gramian)** $W_o(T)$：
$$
W_o(T) = \int_0^T e^{A^\top \tau} C^\top C e^{A\tau} d\tau
$$
这个矩阵将初始状态 $x(0)$ 与其在时间 $[0, T]$ 内产生的输出能量 $E = \int_0^T \|y(t)\|^2 dt = x(0)^\top W_o(T) x(0)$ 联系起来。$W_o(T)$ 的特征结构为我们提供了关于[传感器布局](@entry_id:754692)的深刻见解。其最小的[特征值](@entry_id:154894) $\lambda_{\min}$ 对应于“最难观测”的状态方向——即沿着该方向的初始状态扰动所产生的输出[信号能量](@entry_id:264743)最弱，最容易被噪声淹没。因此，在设计实验时（例如，[选择标记](@entry_id:204830)哪个蛋白质作为荧光[报告基因](@entry_id:187344)，即选择矩阵 $C$），一个关键目标就是最大化 $W_o(T)$ 的最小特征值，以确保系统的所有内部状态都能被有效地“看到” [@problem_id:3335306]。

### 最优控制问题的求解

在构建了模型和目标之后，我们便可以着手求解[最优控制](@entry_id:138479)问题。核心方法是**动态规划 (Dynamic Programming)**。

#### 动态规划与[贝尔曼原理](@entry_id:168030)

动态规划的基石是**贝尔曼最优性原理 (Bellman's principle of optimality)**：一个最优策略的子策略必然也是最优的。换句话说，无论过去的历史和决策如何，从当前状态到达目标的剩余决策必须构成一个相对于当前状态的[最优策略](@entry_id:138495)。

这个原理引出了一种强大的逆向求解算法。让我们以一个离散时间和离散状态的系统为例 [@problem_id:3335249]。我们定义**值函数 (value function)** $V_t(x)$ 为在时刻 $t$ 处于状态 $x$ 时，从该时刻到终点 $T$ 所能获得的最小累积成本。

最优性原理告诉我们，$V_t(x)$ 可以通过一个递归关系（即**[贝尔曼方程](@entry_id:138644)**）来计算：
$$
V_t(x) = \min_{u \in \mathcal{U}} \left\{ \ell_t(x, u) + V_{t+1}(f(x, u)) \right\}
$$
其中 $\ell_t(x,u)$ 是在状态 $x$ 采取控制 $u$ 的瞬时成本，$f(x,u)$ 是系统的状态[转移函数](@entry_id:273897)。这个方程的含义是：在时刻 $t$ 处于状态 $x$ 的最优成本，等于立即支付的成本，加上采取最优控制 $u$ 后转移到的下一状态 $f(x,u)$ 的最优未来成本之和。

求解算法如下：
1.  **初始化**：在终点时刻 $T$，值函数就是终点成本，$V_T(x) = \ell_T(x)$。
2.  **逆向递推**：从 $t = T-1$ 开始，逆向工作到 $t=0$。在每个时刻 $t$，对于网格上的每个状态点 $x$，我们通过遍历所有可能的控制 $u \in \mathcal{U}$ 来求解[贝尔曼方程](@entry_id:138644)，从而计算出 $V_t(x)$。
3.  **最优策略**：在这个过程中，我们不仅得到了值函数，也记录下了在每个 $(t,x)$ 对下最小化[贝尔曼方程](@entry_id:138644)的那个控制 $u^*$。这就构成了最优控制策略或“控制律”。

这个算法将一个复杂的多步决策[问题分解](@entry_id:272624)为一系列简单的单步[优化问题](@entry_id:266749)，为数值求解最优控制提供了一条通用路径 [@problem_id:3335249]。

#### 不确定性下的控制：分离原理

在现实世界中，我们通常无法精确测量系统的所有状态。相反，我们只有被[噪声污染](@entry_id:188797)的测量值。这构成了**部分可观测的[随机最优控制](@entry_id:190537)问题**。对于一个特定的但非常重要的类别——**[线性二次高斯](@entry_id:751291) (Linear-Quadratic-Gaussian, LQG)** 问题，存在一个优雅的解决方案，即**[分离原理](@entry_id:176134) (separation principle)** [@problem_id:3335260]。

LQG问题的设定如下：
- **[线性动力学](@entry_id:177848)**：[系统动力学](@entry_id:136288)由[线性随机微分方程](@entry_id:202697)描述，并受[高斯过程](@entry_id:182192)噪声驱动。
- **线性测量**：测量方程是线性的，并被高斯[测量噪声](@entry_id:275238)污染。
- **二次型成本**：[目标函数](@entry_id:267263)是[状态和](@entry_id:193625)控制的二次型。

分离原理指出，在这种严格的条件下，这个复杂的[随机控制](@entry_id:170804)问题可以“分离”成两个可以独立解决的子问题：
1.  **最优估计问题**：设计一个**卡尔曼滤波器 (Kalman filter)**。这是一个[递归滤波器](@entry_id:270154)，它利用被[噪声污染](@entry_id:188797)的测量值 $y(t)$，实时地给出系统内部状态 $x(t)$ 的最优估计（在均方误差意义下）$\hat{x}(t)$。
2.  **最优确定性控制问题**：设计一个标准的[LQR控制器](@entry_id:267871)，就好像状态能够被完美测量一样。

最终的[最优随机控制](@entry_id:637599)器简单地将这两部分组合起来：将确定性[LQR控制](@entry_id:176902)律应用于卡尔曼滤波器的状态估计值上，即 $u^*(t) = -K(t) \hat{x}(t)$（加上处理参考轨迹的任何前馈项）。这一原理的强大之处在于它极大地简化了控制器的设计，但我们必须牢记，它仅在满足线性、二次、高斯等严格假设时才成立。对于更普遍的[非线性](@entry_id:637147)、非高斯系统，估计和控制问题是耦合的，不存在这样的分离 [@problem_id:3335260]。

#### 随机动态规划

对于遵循CME的完整随机模型，我们也可以应用动态规划的思想，但这需要更高级的数学工具。这里的“状态”是整个[概率分布](@entry_id:146404)，但对于离散分子数的系统，我们可以定义一个作用于状态函数的值函数 $V(n,s)$，其中 $n$ 是分子数，$s$ 是[启动子](@entry_id:156503)状态。

此时，[贝尔曼方程](@entry_id:138644)的连续时间版本是**Hamilton-Jacobi-Bellman (HJB) 方程**。它涉及到[马尔可夫过程](@entry_id:160396)的**无穷小生成元 (infinitesimal generator)** $\mathcal{L}_u$。生成元 $\mathcal{L}_u$ 描述了从某个状态出发，任意函数 $V$ 的期望变化率。[HJB方程](@entry_id:140124)的形式为：
$$
\min_{u \in \mathcal{U}} \{ \ell(n,s,u) + \mathcal{L}_u V(n,s) \} = 0 \quad (\text{对于无穷视界问题})
$$
这里的表达式 $H(n,s,u;V) = \ell(n,s,u) + \mathcal{L}_u V(n,s)$ 被称为[哈密顿量](@entry_id:172864)。在每个状态 $(n,s)$，[最优控制](@entry_id:138479) $u^*$ 就是最小化这个[哈密顿量](@entry_id:172864)的那个 $u$。如果像 [@problem_id:3335248] 中的例子那样，速率对控制是仿射的，而成本对控制是二次的，那么这个最小化步骤可以通过简单的求导来解析地完成，从而得到一个关于值函数 $V$ 的[最优控制](@entry_id:138479)律表达式。这为从C[ME模型](@entry_id:261918)直接推导[最优控制](@entry_id:138479)策略提供了理论基础，尽管求解完整的值函数 $V$ 本身仍然是一个巨大的计算挑战。