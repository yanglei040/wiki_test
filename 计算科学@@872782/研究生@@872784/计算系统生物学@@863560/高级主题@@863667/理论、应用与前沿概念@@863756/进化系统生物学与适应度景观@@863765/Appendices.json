{"hands_on_practices": [{"introduction": "要真正理解适应性景观，最好的方法就是亲手构建一个。这个练习将引导你从最基本的组成部分——单个基因座的加性效应和基因座之间的上位性相互作用——开始，构建一个简单的三基因座适应性景观。通过为每个基因型计算适应度并识别局部最大值，你将具体地体会到上位性是如何塑造景观的拓扑结构，并创造出进化可能陷入的适应性“山峰”[@problem_id:3307467]。", "problem": "考虑演化系统生物学中的一个二元基因型适应度景观，该景观具有三个基因座，每个基因座可以处于参考状态 $0$ 或突变状态 $1$。设基因型由向量 $\\boldsymbol{x} = (x_{1}, x_{2}, x_{3}) \\in \\{0,1\\}^{3}$ 表示，适应度建模为马尔萨斯适应度（对数适应度），由一个加性加成对上位性模型定义\n$$\nF(\\boldsymbol{x}) = a_{1} x_{1} + a_{2} x_{2} + a_{3} x_{3} + e_{12} x_{1} x_{2} + e_{13} x_{1} x_{3} + e_{23} x_{2} x_{3}.\n$$\n该模型是适应度景观中对上位性的标准表示，其中 $a_{i}$ 是每个基因座的加性贡献，$e_{ij}$ 捕获了对上位性相互作用。两个基因型之间的汉明距离 $d_{H}(\\boldsymbol{x}, \\boldsymbol{y})$ 定义为 $\\boldsymbol{x}$ 和 $\\boldsymbol{y}$ 之间不同基因座的数量，而 $\\boldsymbol{x}$ 的一个汉明邻居是任何满足 $d_{H}(\\boldsymbol{x}, \\boldsymbol{y}) = 1$ 的基因型 $\\boldsymbol{y}$。局部最大值是一个基因型 $\\boldsymbol{x}$，满足对于其所有汉明邻居 $\\boldsymbol{y}$ 都有 $F(\\boldsymbol{x})  F(\\boldsymbol{y})$；适应度相等的情况不被视为局部最大值。\n\n使用以下参数值构建包含加性项和对上位性项的最小三基因座景观：\n$$\na_{1} = 0.4,\\quad a_{2} = -0.3,\\quad a_{3} = 0.9,\\quad e_{12} = 0.8,\\quad e_{13} = -0.7,\\quad e_{23} = -0.4.\n$$\n枚举所有基因型，计算它们的适应度值 $F(\\boldsymbol{x})$，并根据上述汉明邻域定义确定所有局部最大值。用其整数索引\n$$\nI(\\boldsymbol{x}) = 4 x_{1} + 2 x_{2} + x_{3},\n$$\n标记每个基因型，即，将其二进制值 $x_{1} x_{2} x_{3}$ 解释为 $x_{1}$ 是最高有效位。将局部最大值索引的集合以升序表示为一个行矩阵。无需四舍五入，也无物理单位。", "solution": "首先验证问题，以确保其有科学依据、适定且客观。\n\n### 步骤 1：提取已知条件\n-   基因型空间：$\\boldsymbol{x} = (x_{1}, x_{2}, x_{3}) \\in \\{0,1\\}^{3}$。\n-   适应度函数：$F(\\boldsymbol{x}) = a_{1} x_{1} + a_{2} x_{2} + a_{3} x_{3} + e_{12} x_{1} x_{2} + e_{13} x_{1} x_{3} + e_{23} x_{2} x_{3}$。\n-   参数值：$a_{1} = 0.4$, $a_{2} = -0.3$, $a_{3} = 0.9$, $e_{12} = 0.8$, $e_{13} = -0.7$, $e_{23} = -0.4$。\n-   邻域定义：$\\boldsymbol{x}$ 的一个汉明邻居是任何满足汉明距离 $d_{H}(\\boldsymbol{x}, \\boldsymbol{y}) = 1$ 的基因型 $\\boldsymbol{y}$。\n-   局部最大值定义：一个基因型 $\\boldsymbol{x}$ 是局部最大值，如果对其所有汉明邻居 $\\boldsymbol{y}$ 都有 $F(\\boldsymbol{x})  F(\\boldsymbol{y})$。适应度相等的情况不被视为局部最大值。\n-   基因型索引：$I(\\boldsymbol{x}) = 4 x_{1} + 2 x_{2} + x_{3}$。\n-   目标：找到所有局部最大值索引，并按升序以行矩阵形式呈现。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题是有科学依据的，因为它使用了适应度景观的标准加性加成对上位性模型，这是演化系统生物学中一个已成熟的概念。该问题是适定的：基因型空间是有限的，适应度函数及其参数是明确定义的，并且识别局部最大值的标准是明确无歧义的。这确保了存在一个唯一且可计算的解。问题陈述是客观的，使用了形式化数学语言。它是自洽的，为求解提供了所有必要信息。计算是可行的，并且设置是逻辑一致的。\n\n### 步骤 3：结论与行动\n问题是有效的。下面提供详细解法。\n\n指定参数的适应度函数为：\n$$\nF(x_1, x_2, x_3) = 0.4 x_{1} - 0.3 x_{2} + 0.9 x_{3} + 0.8 x_{1} x_{2} - 0.7 x_{1} x_{3} - 0.4 x_{2} x_{3}.\n$$\n我们必须枚举所有 $2^3 = 8$ 种基因型，计算它们的适应度值，然后对每种基因型检查其局部最大值条件。\n\n基因型索引从 $0$ 到 $7$。我们为每个基因型 $\\boldsymbol{x} = (x_1, x_2, x_3)$ 计算其适应度 $F(\\boldsymbol{x})$。\n\n-   **基因型 0：** $\\boldsymbol{x} = (0,0,0)$，索引 $I = 0$。\n    $F(0,0,0) = 0.4(0) - 0.3(0) + 0.9(0) + 0.8(0)(0) - 0.7(0)(0) - 0.4(0)(0) = 0$。\n-   **基因型 1：** $\\boldsymbol{x} = (0,0,1)$，索引 $I = 1$。\n    $F(0,0,1) = 0.4(0) - 0.3(0) + 0.9(1) + 0.8(0)(0) - 0.7(0)(1) - 0.4(0)(1) = 0.9$。\n-   **基因型 2：** $\\boldsymbol{x} = (0,1,0)$，索引 $I = 2$。\n    $F(0,1,0) = 0.4(0) - 0.3(1) + 0.9(0) + 0.8(0)(1) - 0.7(0)(0) - 0.4(1)(0) = -0.3$。\n-   **基因型 3：** $\\boldsymbol{x} = (0,1,1)$，索引 $I = 3$。\n    $F(0,1,1) = 0.4(0) - 0.3(1) + 0.9(1) + 0.8(0)(1) - 0.7(0)(1) - 0.4(1)(1) = -0.3 + 0.9 - 0.4 = 0.2$。\n-   **基因型 4：** $\\boldsymbol{x} = (1,0,0)$，索引 $I = 4$。\n    $F(1,0,0) = 0.4(1) - 0.3(0) + 0.9(0) + 0.8(1)(0) - 0.7(1)(0) - 0.4(0)(0) = 0.4$。\n-   **基因型 5：** $\\boldsymbol{x} = (1,0,1)$，索引 $I = 5$。\n    $F(1,0,1) = 0.4(1) - 0.3(0) + 0.9(1) + 0.8(1)(0) - 0.7(1)(1) - 0.4(0)(1) = 0.4 + 0.9 - 0.7 = 0.6$。\n-   **基因型 6：** $\\boldsymbol{x} = (1,1,0)$，索引 $I = 6$。\n    $F(1,1,0) = 0.4(1) - 0.3(1) + 0.9(0) + 0.8(1)(1) - 0.7(1)(0) - 0.4(1)(0) = 0.4 - 0.3 + 0.8 = 0.9$。\n-   **基因型 7：** $\\boldsymbol{x} = (1,1,1)$，索引 $I = 7$。\n    $F(1,1,1) = 0.4(1) - 0.3(1) + 0.9(1) + 0.8(1)(1) - 0.7(1)(1) - 0.4(1)(1) = 0.4 - 0.3 + 0.9 + 0.8 - 0.7 - 0.4 = 0.7$。\n\n适应度值总结（索引为 $I$ 的记为 $F_I$）：\n$F_0 = 0$；$F_1 = 0.9$；$F_2 = -0.3$；$F_3 = 0.2$；$F_4 = 0.4$；$F_5 = 0.6$；$F_6 = 0.9$；$F_7 = 0.7$。\n\n现在，我们检查每个基因型的局部最大值条件。\n\n-   **基因型 0 (0,0,0)：** $F_0=0$。邻居是 $(1,0,0)$, $(0,1,0)$, $(0,0,1)$（索引 $4, 2, 1$）。它们的适应度值为 $F_4=0.4$, $F_2=-0.3$, $F_1=0.9$。因为 $F_0 \\ngtr F_4$ 且 $F_0 \\ngtr F_1$，所以它不是局部最大值。\n\n-   **基因型 1 (0,0,1)：** $F_1=0.9$。邻居是 $(1,0,1)$, $(0,1,1)$, $(0,0,0)$（索引 $5, 3, 0$）。它们的适应度值为 $F_5=0.6$, $F_3=0.2$, $F_0=0$。我们检查 $F_1$ 是否严格大于所有邻居的适应度值：\n    -   $F_1  F_5 \\implies 0.9  0.6$ (真)\n    -   $F_1  F_3 \\implies 0.9  0.2$ (真)\n    -   $F_1  F_0 \\implies 0.9  0$ (真)\n    所有条件都成立。索引为 $1$ 的基因型是一个局部最大值。\n\n-   **基因型 2 (0,1,0)：** $F_2=-0.3$。邻居是 $(1,1,0)$, $(0,0,0)$, $(0,1,1)$（索引 $6, 0, 3$）。它们的适应度值为 $F_6=0.9$, $F_0=0$, $F_3=0.2$。因为 $F_2 \\ngtr F_6$，所以它不是局部最大值。\n\n-   **基因型 3 (0,1,1)：** $F_3=0.2$。邻居是 $(1,1,1)$, $(0,0,1)$, $(0,1,0)$（索引 $7, 1, 2$）。它们的适应度值为 $F_7=0.7$, $F_1=0.9$, $F_2=-0.3$。因为 $F_3 \\ngtr F_7$ 且 $F_3 \\ngtr F_1$，所以它不是局部最大值。\n\n-   **基因型 4 (1,0,0)：** $F_4=0.4$。邻居是 $(0,0,0)$, $(1,1,0)$, $(1,0,1)$（索引 $0, 6, 5$）。它们的适应度值为 $F_0=0$, $F_6=0.9$, $F_5=0.6$。因为 $F_4 \\ngtr F_6$ 且 $F_4 \\ngtr F_5$，所以它不是局部最大值。\n\n-   **基因型 5 (1,0,1)：** $F_5=0.6$。邻居是 $(0,0,1)$, $(1,1,1)$, $(1,0,0)$（索引 $1, 7, 4$）。它们的适应度值为 $F_1=0.9$, $F_7=0.7$, $F_4=0.4$。因为 $F_5 \\ngtr F_1$ 且 $F_5 \\ngtr F_7$，所以它不是局部最大值。\n\n-   **基因型 6 (1,1,0)：** $F_6=0.9$。邻居是 $(0,1,0)$, $(1,0,0)$, $(1,1,1)$（索引 $2, 4, 7$）。它们的适应度值为 $F_2=-0.3$, $F_4=0.4$, $F_7=0.7$。我们检查 $F_6$ 是否严格大于所有邻居的适应度值：\n    -   $F_6  F_2 \\implies 0.9  -0.3$ (真)\n    -   $F_6  F_4 \\implies 0.9  0.4$ (真)\n    -   $F_6  F_7 \\implies 0.9  0.7$ (真)\n    所有条件都成立。索引为 $6$ 的基因型是一个局部最大值。\n\n-   **基因型 7 (1,1,1)：** $F_7=0.7$。邻居是 $(0,1,1)$, $(1,0,1)$, $(1,1,0)$（索引 $3, 5, 6$）。它们的适应度值为 $F_3=0.2$, $F_5=0.6$, $F_6=0.9$。因为 $F_7 \\ngtr F_6$，所以它不是局部最大值。\n\n被确定为局部最大值的基因型索引为 $1$ 和 $6$。按升序排列，索引集合为 $\\{1, 6\\}$。这必须表示为一个行矩阵。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  6\n\\end{pmatrix}\n}\n$$", "id": "3307467"}, {"introduction": "在实践中，我们通常拥有的是实验测得的适应度数据，而不是预先知道的相互作用参数。因此，一个核心任务是从适应度数据中推断出景观的结构。本练习介绍了一种强大的数学工具——沃尔什-哈达玛变换（Walsh-Hadamard Transform），用于将适应度函数分解为其“频谱”分量：平均适应度、加性效应以及各阶上位性相互作用。掌握这项技术使你能够量化基因相互作用，并从根本上理解特定适应性景观的遗传结构[@problem_id:3307521]。", "problem": "考虑一个二元的、三基因座的基因型空间 $\\mathcal{G} = \\{0,1\\}^3$，其基因型表示为 $\\mathbf{b} = (b_1,b_2,b_3)$，以及一个无量纲的适应度函数 $f: \\mathcal{G} \\to \\mathbb{R}$。在演化系统生物学中，适应度景观可以表示为超立方体上的一个函数，并使用 $\\{-1,1\\}^3$ 上的一个正交基分解为加性和上位性贡献。通过 $s_i = 2 b_i - 1$ 为每个基因座定义自旋变量 $s_i \\in \\{-1,1\\}$。基于自旋乘积的正交分解被称为沃尔什-哈达玛变换（WHT）。从 $\\{0,1\\}^3$ 上适应度景观的基本定义、超立方体上特征函数的正交性以及映射 $\\mathbf{b} \\mapsto \\mathbf{s}$ 出发，执行分解为加性和上位性谱分量，并重构适应度函数 $f(s_1,s_2,s_3)$。\n\n观测到的适应度值为：\n- $f(0,0,0) = 4$\n- $f(1,0,0) = 5$\n- $f(0,1,0) = 6$\n- $f(0,0,1) = 3$\n- $f(1,1,0) = 9$\n- $f(1,0,1) = 6$\n- $f(0,1,1) = 7$\n- $f(1,1,1) = 13$\n\n仅使用上述基本基，通过在自旋表示上进行WHT，量化加性、成对上位性和三阶上位性系数，并将适应度函数重构为关于 $s_1$、$s_2$ 和 $s_3$ 的多项式。将您最终重构的适应度函数 $f(s_1,s_2,s_3)$ 表示为具有精确有理系数的单一闭式解析表达式。无需四舍五入。将您的最终答案报告为关于 $s_1$、$s_2$ 和 $s_3$ 的显式多项式。", "solution": "用户希望我解决这个问题。\n\n### 第一步：问题验证\n\n**1.1. 提取给定信息：**\n\n-   **基因型空间：** 一个二元的、三基因座的基因型空间 $\\mathcal{G} = \\{0,1\\}^3$。基因型表示为 $\\mathbf{b} = (b_1,b_2,b_3)$。\n-   **适应度函数：** 一个无量纲的适应度函数 $f: \\mathcal{G} \\to \\mathbb{R}$。\n-   **自旋变量映射：** 自旋变量 $s_i \\in \\{-1,1\\}$ 由二元等位基因 $b_i \\in \\{0,1\\}$ 通过映射 $s_i = 2 b_i - 1$ 定义。\n-   **分解方法：** 超立方体 $\\{-1,1\\}^3$ 上的适应度函数将使用自旋乘积的正交基分解为加性和上位性贡献，这对应于沃尔什-哈达玛变换（WHT）。\n-   **任务：** 量化加性、成对上位性和三阶上位性系数。将适应度函数 $f(s_1,s_2,s_3)$ 重构为自旋变量的多项式。\n-   **观测到的适应度数据：**\n    -   $f(0,0,0) = 4$\n    -   $f(1,0,0) = 5$\n    -   $f(0,1,0) = 6$\n    -   $f(0,0,1) = 3$\n    -   $f(1,1,0) = 9$\n    -   $f(1,0,1) = 6$\n    -   $f(0,1,1) = 7$\n    -   $f(1,1,1) = 13$\n-   **最终答案格式：** 一个具有精确有理系数的 $f(s_1,s_2,s_3)$ 的单一闭式解析表达式。\n\n**1.2. 使用提取的信息进行验证：**\n\n-   **科学依据：** 该问题是演化系统生物学领域的一个标准练习，具体涉及适应度景观的分析。使用沃尔什-哈达玛变换将超立方体上的函数分解为其谱分量（加性效应和上位性效应）是一种成熟且基础的技术。该问题在科学上是合理的，并且表述正确。\n-   **良置性：** 该问题提供了一套完整的数据（对于 $2^3 = 8$ 种可能的基因型，有8个适应度值）。有限群上的沃尔什-哈达玛变换是一个定义明确的线性变换，它产生一组唯一的系数。问题是明确的，并且有唯一的解。\n-   **客观性：** 问题陈述使用精确、客观和标准的科学语言编写。没有主观或基于意见的内容。\n-   **完整性与一致性：** 提供了所有必要的信息。给定信息中没有矛盾。\n-   **其他标准：** 该问题并非微不足道，属于科学领域，可验证，且结构良好。\n\n**1.3. 结论与行动：**\n\n问题是**有效的**。将提供完整解答。\n\n### 第二步：解答\n\n该问题要求将定义在二元超立方体 $\\{0,1\\}^3$ 上的适应度函数分解为其上位性分量。这通过首先将函数映射到自旋超立方体 $\\{-1,1\\}^3$，然后应用沃尔什-哈达玛变换来实现。\n\n首先，我们使用关系 $s_i = 2b_i - 1$ 将二元基因型 $\\mathbf{b} = (b_1,b_2,b_3)$ 映射到自旋基因型 $\\mathbf{s} = (s_1,s_2,s_3)$。$b_i=0$ 的值映射到 $s_i=-1$，而 $b_i=1$ 的值映射到 $s_i=1$。我们列出每个对应自旋基因型的适应度值：\n-   $f(-1,-1,-1) = f(0,0,0) = 4$\n-   $f(1,-1,-1) = f(1,0,0) = 5$\n-   $f(-1,1,-1) = f(0,1,0) = 6$\n-   $f(-1,-1,1) = f(0,0,1) = 3$\n-   $f(1,1,-1) = f(1,1,0) = 9$\n-   $f(1,-1,1) = f(1,0,1) = 6$\n-   $f(-1,1,1) = f(0,1,1) = 7$\n-   $f(1,1,1) = f(1,1,1) = 13$\n\n适应度函数 $f(\\mathbf{s})$ 可以表示为自旋超立方体上正交基函数的线性组合。这些基函数是沃尔什函数，对于自旋表示法，它们是自旋变量的乘积。对于一个三基因座系统，这 $2^3=8$ 个基函数为 $\\chi_I(\\mathbf{s}) = \\prod_{i \\in I} s_i$，其中 $I$ 是 $\\{1,2,3\\}$ 的一个子集。该函数可以写为：\n\n$$\nf(s_1,s_2,s_3) = \\sum_{I \\subseteq \\{1,2,3\\}} w_I \\chi_I(s_1,s_2,s_3)\n$$\n\n展开后为：\n$$\nf(s_1,s_2,s_3) = w_{\\emptyset} + w_{\\{1\\}}s_1 + w_{\\{2\\}}s_2 + w_{\\{3\\}}s_3 + w_{\\{1,2\\}}s_1s_2 + w_{\\{1,3\\}}s_1s_3 + w_{\\{2,3\\}}s_2s_3 + w_{\\{1,2,3\\}}s_1s_2s_3\n$$\n为简单起见，我们将 $w_{\\emptyset}$ 记为 $w_0$，$w_{\\{i\\}}$ 记为 $w_i$，$w_{\\{i,j\\}}$ 记为 $w_{ij}$，$w_{\\{1,2,3\\}}$ 记为 $w_{123}$。\n\n系数 $w_I$ 是函数 $f$ 在基函数 $\\chi_I$ 上的投影。它们通过超立方体上的函数空间的内积计算，定义为 $\\langle g_1, g_2 \\rangle = \\frac{1}{2^3} \\sum_{\\mathbf{s} \\in \\{-1,1\\}^3} g_1(\\mathbf{s})g_2(\\mathbf{s})$。由于沃尔什函数的正交性，系数由下式给出：\n\n$$\nw_I = \\langle f, \\chi_I \\rangle = \\frac{1}{8} \\sum_{\\mathbf{s} \\in \\{-1,1\\}^3} f(\\mathbf{s}) \\chi_I(\\mathbf{s})\n$$\n\n我们现在计算这8个系数中的每一个。我们按字典序对 $\\mathbf{s}$ 进行求和：$(-1,-1,-1), (-1,-1,1), \\dots, (1,1,1)$。对应的适应度值为 $(4, 3, 6, 7, 5, 6, 9, 13)$。\n\n-   **平均适应度 ($w_0$):**\n    $w_0 = \\frac{1}{8} \\sum f(\\mathbf{s}) = \\frac{1}{8}(4+3+6+7+5+6+9+13) = \\frac{53}{8}$。\n\n-   **加性效应 ($w_1, w_2, w_3$):**\n    $w_1 = \\frac{1}{8} \\sum f(\\mathbf{s})s_1 = \\frac{1}{8}(-4-3-6-7+5+6+9+13) = \\frac{13}{8}$。\n    $w_2 = \\frac{1}{8} \\sum f(\\mathbf{s})s_2 = \\frac{1}{8}(-4-3+6+7-5-6+9+13) = \\frac{17}{8}$。\n    $w_3 = \\frac{1}{8} \\sum f(\\mathbf{s})s_3 = \\frac{1}{8}(-4+3-6+7-5+6-9+13) = \\frac{5}{8}$。\n\n-   **成对上位性效应 ($w_{12}, w_{13}, w_{23}$):**\n    $w_{12} = \\frac{1}{8} \\sum f(\\mathbf{s})s_1s_2 = \\frac{1}{8}(+4+3-6-7-5-6+9+13) = \\frac{5}{8}$。\n    $w_{13} = \\frac{1}{8} \\sum f(\\mathbf{s})s_1s_3 = \\frac{1}{8}(+4-3+6-7-5+6-9+13) = \\frac{5}{8}$。\n    $w_{23} = \\frac{1}{8} \\sum f(\\mathbf{s})s_2s_3 = \\frac{1}{8}(+4-3-6+7+5-6-9+13) = \\frac{5}{8}$。\n\n-   **三阶上位性效应 ($w_{123}$):**\n    $w_{123} = \\frac{1}{8} \\sum f(\\mathbf{s})s_1s_2s_3 = \\frac{1}{8}(-4+3+6-7+5-6-9+13) = \\frac{1}{8}$。\n\n计算出所有系数后，我们可以将适应度函数重构为关于 $s_1, s_2, s_3$ 的多项式：\n$$\nf(s_1,s_2,s_3) = w_0 + w_1 s_1 + w_2 s_2 + w_3 s_3 + w_{12} s_1 s_2 + w_{13} s_1 s_3 + w_{23} s_2 s_3 + w_{123} s_1 s_2 s_3\n$$\n代入计算出的值：\n$$\nf(s_1,s_2,s_3) = \\frac{53}{8} + \\frac{13}{8} s_1 + \\frac{17}{8} s_2 + \\frac{5}{8} s_3 + \\frac{5}{8} s_1 s_2 + \\frac{5}{8} s_1 s_3 + \\frac{5}{8} s_2 s_3 + \\frac{1}{8} s_1 s_2 s_3\n$$\n这可以写成更紧凑的形式：\n$$\nf(s_1,s_2,s_3) = \\frac{1}{8} (53 + 13 s_1 + 17 s_2 + 5 s_3 + 5 s_1 s_2 + 5 s_1 s_3 + 5 s_2 s_3 + s_1 s_2 s_3)\n$$\n这就是所要求的、具有精确有理系数的重构适应度函数的闭式解析表达式。\n\n我们可以通过代入一个点来验证这个结果，例如 $\\mathbf{s}=(1,1,1)$：\n$$\nf(1,1,1) = \\frac{1}{8}(53+13+17+5+5+5+5+1) = \\frac{104}{8} = 13.\n$$\n这与给定的值 $f(1,1,1)=13$ 相匹配。\n\n对 $\\mathbf{s}=(-1,-1,-1)$ 进行另一次检验：\n$$\nf(-1,-1,-1) = \\frac{1}{8}(53-13-17-5+5+5+5-1) = \\frac{1}{8}(53-35+15-1) = \\frac{32}{8} = 4.\n$$\n这也与给定的值 $f(0,0,0)=4$ 相匹配，证实了系数的正确性。", "answer": "$$\n\\boxed{\\frac{53}{8} + \\frac{13}{8} s_1 + \\frac{17}{8} s_2 + \\frac{5}{8} s_3 + \\frac{5}{8} s_1 s_2 + \\frac{5}{8} s_1 s_3 + \\frac{5}{8} s_2 s_3 + \\frac{1}{8} s_1 s_2 s_3}\n$$", "id": "3307521"}, {"introduction": "适应性景观不仅是一个静态的拓扑结构，它还决定了演化的动态过程。这个练习将静态的景观概念与群体遗传学的动态模型联系起来。在强选择弱突变（SSWM）的假设下——这是演化理论中的一个经典模型——你将推导并计算演化的两个关键速率：新有利突变固定的预期等待时间，以及适应度增加的平均速率。这个过程清晰地展示了适应性效应的分布（DFE）如何直接转化为可预测的演化动力学结果[@problem_id:3307504]。", "problem": "考虑一个单倍体无性种群，其在恒定大小的赖特-费舍尔过程中，并处于强选择弱突变（SSWM）机制下演化。在此机制下，种群大小与有益突变率的乘积很小，且有益突变间的干扰可以忽略不计。设种群大小为 $N = 10^{7}$ 个个体，每个基因组每代的有益突变率为 $U_{b} = 1.0 \\times 10^{-8}$。假设有益突变的适应度效应分布（DFE）为指数分布，$\\rho(s) = \\lambda \\exp(-\\lambda s)$（对于 $s  0$），通过选择 $\\lambda = 100$，其平均效应 $\\mathbb{E}[s] = 1/\\lambda$ 被设定为 $0.01$。从强选择极限下固定的第一性原理出发，并假设有益突变是时间上的一个稀有泊松过程，推导下一个固定事件的期望等待时间和期望适应度增长率的通用表达式。然后，使用给定的参数 $(N, U_{b}, \\lambda)$ 对这些表达式进行求值。\n\n将您的最终数值结果以一个双元素行向量的形式报告，其中第一个元素是下一个固定事件的期望等待时间（以代为单位），第二个元素是期望适应度增长率（以每代为单位）。将您的两个结果四舍五入至 $4$ 位有效数字。", "solution": "该问题在理论群体遗传学的标准框架内定义明确且具有科学依据。我们着手进行推导和计算。\n\n首先，我们推导下一个固定事件的期望等待时间和期望适应度增长率的通用表达式。该模型是一个大小恒为 $N$ 的单倍体无性种群，处于强选择弱突变（SSWM）机制下。在此机制中，有益突变稀少地出现，并在下一个有益突变出现之前要么被固定，要么被丢失。\n\n种群中每代产生有益突变的总速率是個体数 $N$ 与每个个体的有益突变率 $U_b$ 的乘积。设此速率为 $\\Lambda_{mut}$。\n$$ \\Lambda_{mut} = N U_b $$\n\n一个选择系数为 $s  0$ 的新突变具有一个固定概率 $P_{fix}(s)$。对于由赖特-费舍尔过程描述的单倍体种群，单个新突变体的固定概率由木村公式给出：\n$$ P_{fix}(s) = \\frac{1 - \\exp(-2s)}{1 - \\exp(-2Ns)} $$\n该问题设定在强选择极限下，这意味着 $Ns \\gg 1$。此外，适应度效应分布（DFE）的均值很小（$\\mathbb{E}[s] = 0.01$），因此我们可以假设典型的有益突变具有 $s \\ll 1$。在这些条件下，分子可以使用泰勒展开进行近似，$1 - \\exp(-2s) \\approx 1 - (1 - 2s) = 2s$，而分母由于 $Ns \\gg 1$ 变为 $1 - \\exp(-2Ns) \\approx 1$。这就得出了在该机制下固定概率的标准近似值：\n$$ P_{fix}(s) \\approx 2s $$\n\n有益突变的*固定*速率，我们记为 $\\nu$，是通过对所有可能的适应度效应 $s$ 的突变供给速率进行积分得到的，并以其固定概率加权。DFE 由 $\\rho(s) = \\lambda \\exp(-\\lambda s)$（对于 $s  0$）给出。\n$$ \\nu = \\int_{0}^{\\infty} (N U_b) \\rho(s) P_{fix}(s) ds $$\n代入 $\\rho(s)$ 和 $P_{fix}(s)$ 的表达式：\n$$ \\nu = N U_b \\int_{0}^{\\infty} (\\lambda \\exp(-\\lambda s)) (2s) ds = 2 N U_b \\lambda \\int_{0}^{\\infty} s \\exp(-\\lambda s) ds $$\n积分 $\\int_{0}^{\\infty} s \\exp(-\\lambda s) ds$ 是指数分布的期望值，即 $\\mathbb{E}[s] = 1/\\lambda$。或者，我们可以使用分部积分法计算该积分，或将其识别为与伽马函数 $\\Gamma(z) = \\int_0^\\infty t^{z-1} e^{-t} dt$ 相关。该积分的计算结果为 $1/\\lambda^2$。\n$$ \\nu = 2 N U_b \\lambda \\left(\\frac{1}{\\lambda^2}\\right) = \\frac{2 N U_b}{\\lambda} $$\n由于 $\\mathbb{E}[s] = 1/\\lambda$，这可以写成 $\\nu = 2 N U_b \\mathbb{E}[s]$。\n\n问题陈述突变是作为一个稀有的泊松过程出现的。因此，固定事件也构成一个速率为 $\\nu$ 的泊松过程。泊松过程中事件之间的期望等待时间是其速率的倒数。因此，下一个固定事件的期望等待时间 $T_{fix}$ 是：\n$$ T_{fix} = \\frac{1}{\\nu} = \\frac{\\lambda}{2 N U_b} $$\n这是期望等待时间的通用表达式。\n\n接下来，我们推导适应度增长率 $v$ 的表达式。它是固定速率 $\\nu$ 与那些实际固定的突变的平均适应度效应 $\\mathbb{E}[s_{fix}]$ 的乘积。\n$$ v = \\nu \\cdot \\mathbb{E}[s_{fix}] $$\n*已固定*突变的选择系数的概率密度函数 $\\rho_{fix}(s)$ 与原始 DFE 和固定概率的乘积成正比：$\\rho_{fix}(s) \\propto \\rho(s) P_{fix}(s)$。因此，期望值 $\\mathbb{E}[s_{fix}]$ 为：\n$$ \\mathbb{E}[s_{fix}] = \\frac{\\int_{0}^{\\infty} s \\rho(s) P_{fix}(s) ds}{\\int_{0}^{\\infty} \\rho(s) P_{fix}(s) ds} $$\n分母与总固定速率 $\\nu$ 成正比：$\\int_{0}^{\\infty} \\rho(s) P_{fix}(s) ds = \\nu / (N U_b) = (2 N U_b / \\lambda) / (N U_b) = 2/\\lambda$。\n分子是：\n$$ \\int_{0}^{\\infty} s (\\lambda \\exp(-\\lambda s)) (2s) ds = 2\\lambda \\int_{0}^{\\infty} s^2 \\exp(-\\lambda s) ds $$\n这个积分与指数分布的二阶矩有关，其计算结果为 $2/\\lambda^3$。\n$$ \\int_{0}^{\\infty} s^2 \\exp(-\\lambda s) ds = \\frac{\\Gamma(3)}{\\lambda^3} = \\frac{2!}{\\lambda^3} = \\frac{2}{\\lambda^3} $$\n所以，分子是 $2\\lambda (2/\\lambda^3) = 4/\\lambda^2$。\n因此，每次固定的期望适应度增益是：\n$$ \\mathbb{E}[s_{fix}] = \\frac{4/\\lambda^2}{2/\\lambda} = \\frac{2}{\\lambda} = 2 \\mathbb{E}[s] $$\n这表明成功突变的平均效应是所有有益突变总体平均效应的两倍。\n\n现在我们可以计算适应度增长率 $v$：\n$$ v = \\nu \\cdot \\mathbb{E}[s_{fix}] = \\left(\\frac{2 N U_b}{\\lambda}\\right) \\left(\\frac{2}{\\lambda}\\right) = \\frac{4 N U_b}{\\lambda^2} $$\n这是期望适应度增长率的通用表达式。\n\n现在，我们使用给定的参数 $N = 10^7$、$U_b = 1.0 \\times 10^{-8}$ 和 $\\lambda = 100$ 来计算这两个通用表达式的值。\n\n下一个固定事件的期望等待时间是：\n$$ T_{fix} = \\frac{\\lambda}{2 N U_b} = \\frac{100}{2 \\times (10^7) \\times (1.0 \\times 10^{-8})} = \\frac{100}{2 \\times 10^{-1}} = \\frac{100}{0.2} = 500 $$\n单位是代。四舍五入到 $4$ 位有效数字，结果是 $500.0$。\n\n期望适应度增长率是：\n$$ v = \\frac{4 N U_b}{\\lambda^2} = \\frac{4 \\times (10^7) \\times (1.0 \\times 10^{-8})}{100^2} = \\frac{4 \\times 10^{-1}}{10000} = \\frac{0.4}{10^4} = 4.0 \\times 10^{-5} $$\n单位是每代。四舍五入到 $4$ 位有效数字，结果是 $4.000 \\times 10^{-5}$。\n\n最终答案是一个包含这些数值结果的双元素行向量。", "answer": "$$\n\\boxed{\\begin{pmatrix} 500.0  4.000 \\times 10^{-5} \\end{pmatrix}}\n$$", "id": "3307504"}]}