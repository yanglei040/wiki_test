{"hands_on_practices": [{"introduction": "第一个实践练习旨在搭建从化学主方程（CME）的离散概率描述到其连续近似——福克-普朗克方程之间的桥梁。通过对一个基本的生灭过程应用系统大小展开，你将推导出线性噪声近似（LNA），并观察它如何捕捉系统的涨落。这个练习对于理解福克-普朗克形式主义在生物化学系统中的起源，以及建立关于随机噪声性质的直觉至关重要。", "problem": "考虑一个均匀混合区域中的单物种生灭过程，其大小由系统大小参数 $\\,\\Omega\\,$ 表征。物种 $\\,X\\,$ 的分子以零级宏观速率 $\\,k_b \\Omega\\,$ 从无到有合成，并以每个分子的一级微观速率 $\\,k_d\\,$ 降解。令 $\\,n(t)\\,$ 表示在时间 $\\,t\\,$ 时物种 $\\,X\\,$ 的分子数，并定义浓度 $\\,x(t) = n(t)/\\Omega\\,$。假设 $\\,k_b  0\\,$，$\\,k_d  0\\,$，且系统存在一个唯一的、稳定的宏观不动点。\n\n从化学主方程 (CME) 和导出 Fokker-Planck 近似的 Kramers-Moyal 展开出发，进行 van Kampen 系统大小展开，直至线性噪声近似 (LNA)。推导围绕宏观不动点的浓度涨落的有效漂移和扩散，并推断 LNA 预测的分子数 $\\,n\\,$ 的稳态方差。然后，从 CME 计算精确的稳态分布，并用它来获得 $\\,n\\,$ 的精确稳态方差。证明 LNA 方差等于精确的 CME 方差。最后，通过推导中心化和重标度的涨落变量 $\\,\\xi = \\sqrt{\\Omega}\\,\\big(x - \\bar{x}\\big)\\,$ 在稳态下的三阶和四阶累积量来量化主要的非高斯修正，其中 $\\,\\bar{x}\\,$ 是宏观不动点，并确定它们随 $\\,\\Omega\\,$ 的标度关系。用 $\\,k_b\\,$、$\\,k_d\\,$ 和 $\\,\\Omega\\,$ 表示这些累积量。\n\n请提供分子数 $\\,n\\,$ 的稳态方差作为 $\\,k_b\\,$、$\\,k_d\\,$ 和 $\\,\\Omega\\,$ 的函数的封闭形式符号表达式作为最终答案。不需要数值。", "solution": "该问题要求使用精确的化学主方程 (CME) 和通过系统大小展开得到的 Fokker-Planck 近似，对一个随机生灭过程进行详细分析。我们将首先根据指定标准验证问题陈述的有效性，如果问题有效，则继续进行推导。\n\n### 问题验证\n**步骤1：提取给定条件**\n-   **系统：** 单物种 ($X$) 生灭过程。\n-   **系统大小参数：** $\\Omega$。\n-   **反应与速率：**\n    1.  生成：$\\emptyset \\xrightarrow{k_b \\Omega} X$ (零级宏观合成)。\n    2.  降解：$X \\xrightarrow{k_d} \\emptyset$ (一级微观降解)。\n-   **变量：** $n(t)$ 是 $X$ 的分子数；$x(t) = n(t)/\\Omega$ 是浓度。\n-   **常数：** $k_b  0$, $k_d  0$。\n-   **假设：** 系统拥有一个唯一的、稳定的宏观不动点。\n-   **任务：**\n    1.  从 CME 开始，使用 Kramers-Moyal 展开得到 Fokker-Planck 方程。\n    2.  应用 van Kampen 系统大小展开推导线性噪声近似 (LNA)。\n    3.  求出 LNA 中浓度涨落的有效漂移和扩散。\n    4.  根据 LNA 计算分子数 $\\text{Var}(n)$ 的稳态方差。\n    5.  求解 CME 得到精确的稳态分布 $P_s(n)$。\n    6.  根据 $P_s(n)$ 计算 $n$ 的精确稳态方差。\n    7.  证明 LNA 方差等于精确的 CME 方差。\n    8.  推导重标度涨落变量 $\\xi = \\sqrt{\\Omega}(x - \\bar{x})$ 的稳态三阶和四阶累积量，其中 $\\bar{x}$ 是宏观不动点。\n    9.  确定这些累积量随 $\\Omega$ 的标度关系。\n\n**步骤2：使用提取的给定条件进行验证**\n-   **科学依据：** 该问题描述了经典的线性生灭过程，这是随机化学生物动力学和系统生物学中的一个基石模型。所涉及的所有概念——CME、Fokker-Planck 方程、van Kampen 展开、LNA、累积量——都是该领域的标准且完善的理论工具。该设置在科学上和数学上都是合理的。 **(有效)**\n-   **良态问题：** 问题定义清晰，包含了所有必要的参数（$k_b, k_d, \\Omega$）和反应。唯一稳定不动点的假设与线性动力学一致。各项任务具体，并能导出一组唯一且有意义的结果。 **(有效)**\n-   **客观性：** 问题以精确、正式且无偏见的技术语言陈述，没有任何主观性或模糊性。 **(有效)**\n\n**步骤3：结论与行动**\n问题有效。我们继续进行求解。\n\n### I. 宏观动力学与不动点\n\n反应如下：\n$$\n\\emptyset \\xrightarrow{k_b \\Omega} X \\quad , \\quad X \\xrightarrow{k_d} \\emptyset\n$$\n对应于分子数 $n$ 的倾向函数为：\n-   生成速率：$w_+(n) = k_b \\Omega$\n-   降解速率：$w_-(n) = k_d n$\n\n通过忽略涨落，可以得到浓度 $x = n/\\Omega$ 的确定性速率方程：\n$$\n\\frac{dx}{dt} = \\frac{1}{\\Omega} \\left( w_+(\\Omega x) - w_-(\\Omega x) \\right) = \\frac{1}{\\Omega} (k_b \\Omega - k_d \\Omega x) = k_b - k_d x\n$$\n系统在 $\\frac{dx}{dt} = 0$ 处有一个宏观不动点 $\\bar{x}$：\n$$\nk_b - k_d \\bar{x} = 0 \\implies \\bar{x} = \\frac{k_b}{k_d}\n$$\n该不动点的稳定性由速率方程的雅可比矩阵 $J = \\frac{d}{dx}(k_b - k_d x) = -k_d$ 决定。由于 $k_d  0$，特征值为负，证实了不动点是唯一的且稳定的，与假设相符。在不动点处的相应平均分子数为 $\\bar{n} = \\Omega \\bar{x} = \\frac{k_b \\Omega}{k_d}$。\n\n### II. 线性噪声近似 (LNA) 与方差\n\n我们通过将浓度 $x(t)$ 分解为其宏观部分 $\\bar{x}$ 和一个按 $\\Omega^{-1/2}$ 标度的涨落项 $\\xi(t)$ 来进行 van Kampen 系统大小展开：\n$$\nx(t) = \\bar{x} + \\frac{1}{\\sqrt{\\Omega}} \\xi(t) \\quad \\implies \\quad n(t) = \\Omega\\bar{x} + \\sqrt{\\Omega}\\xi(t)\n$$\n与 CME 对应的 Fokker-Planck 方程由 $\\frac{\\partial P(x,t)}{\\partial t} = -\\frac{\\partial}{\\partial x}[A(x)P(x,t)] + \\frac{1}{2}\\frac{\\partial^2}{\\partial x^2}[B(x)P(x,t)]$ 给出，其中漂移系数 $A(x)$ 和扩散系数 $B(x)$ 分别为：\n$$\nA(x) = \\frac{w_+(\\Omega x) - w_-(\\Omega x)}{\\Omega} = k_b - k_d x\n$$\n$$\nB(x) = \\frac{w_+(\\Omega x) + w_-(\\Omega x)}{\\Omega^2} = \\frac{k_b \\Omega + k_d \\Omega x}{\\Omega^2} = \\frac{k_b + k_d x}{\\Omega}\n$$\n现在我们使用 $x = \\bar{x} + \\Omega^{-1/2}\\xi$ 在不动点 $\\bar{x}$ 附近展开 $A(x)$ 和 $B(x)$：\n$$\nA(x) = k_b - k_d(\\bar{x} + \\Omega^{-1/2}\\xi) = (k_b - k_d \\bar{x}) - k_d \\Omega^{-1/2}\\xi = -k_d \\Omega^{-1/2}\\xi\n$$\n对于 LNA，我们只需要 $B(x)$ 在不动点处取值的主导项：\n$$\nB(x) \\approx B(\\bar{x}) = \\frac{k_b + k_d \\bar{x}}{\\Omega} = \\frac{k_b + k_d(k_b/k_d)}{\\Omega} = \\frac{2k_b}{\\Omega}\n$$\n涨落变量 $\\xi$ 的动力学由从这些展开式中推导出的朗之万方程描述：\n$$\n\\frac{d(\\Omega^{-1/2}\\xi)}{dt} = A(\\bar{x} + \\Omega^{-1/2}\\xi) + \\sqrt{B(\\bar{x} + \\Omega^{-1/2}\\xi)} \\eta'(t)\n$$\n其中 $\\eta'(t)$ 是高斯白噪声，满足 $\\langle \\eta'(t)\\eta'(t') \\rangle = \\delta(t-t')$。取主导阶：\n$$\n\\Omega^{-1/2}\\frac{d\\xi}{dt} \\approx -k_d \\Omega^{-1/2}\\xi + \\sqrt{\\frac{2k_b}{\\Omega}} \\eta'(t)\n$$\n$$\n\\frac{d\\xi}{dt} = -k_d\\xi + \\sqrt{2k_b}\\eta'(t)\n$$\n这是一个奥恩斯坦-乌伦贝克过程，$d\\xi/dt = a\\xi + b\\eta'(t)$，其线性漂移系数为 $a = -k_d$，常数扩散（噪声强度）为 $b = \\sqrt{2k_b}$。$\\xi$ 的有效漂移为 $-k_d\\xi$，有效扩散系数（在 $\\xi$ 的 FPE 中）为 $b^2 = 2k_b$。\n这样一个过程的稳态方差由 $\\text{Var}(\\xi) = -\\frac{b^2}{2a}$ 给出：\n$$\n\\text{Var}(\\xi) = -\\frac{(\\sqrt{2k_b})^2}{2(-k_d)} = \\frac{2k_b}{2k_d} = \\frac{k_b}{k_d}\n$$\n分子数 $n$ 的方差与 $\\xi$ 的方差关系如下：\n$$\n\\text{Var}(n) = \\text{Var}(\\Omega\\bar{x} + \\sqrt{\\Omega}\\xi) = \\text{Var}(\\sqrt{\\Omega}\\xi) = \\Omega\\text{Var}(\\xi)\n$$\n因此，由 LNA 预测的方差是：\n$$\n\\text{Var}_{\\text{LNA}}(n) = \\Omega\\left(\\frac{k_b}{k_d}\\right) = \\frac{k_b\\Omega}{k_d}\n$$\n\n### III. 精确 CME 解与方差\n\n在时间 $t$ 有 $n$ 个分子的概率 $P(n,t)$ 的化学主方程为：\n$$\n\\frac{dP(n,t)}{dt} = w_+(n-1)P(n-1,t) - w_+(n)P(n,t) + w_-(n+1)P(n+1,t) - w_-(n)P(n,t)\n$$\n在稳态下，$\\frac{dP(n,t)}{dt} = 0$。这意味着概率流的细致平衡条件：\n$$\nw_+(n-1)P_s(n-1) = w_-(n)P_s(n)\n$$\n代入倾向函数：\n$$\n(k_b\\Omega) P_s(n-1) = (k_d n) P_s(n)\n$$\n这给出了稳态分布 $P_s(n)$ 的一个递推关系：\n$$\nP_s(n) = \\frac{k_b\\Omega}{k_d n} P_s(n-1)\n$$\n通过迭代这个关系，我们发现：\n$$\nP_s(n) = \\frac{k_b\\Omega}{k_d n} \\cdot \\frac{k_b\\Omega}{k_d(n-1)} \\cdots \\frac{k_b\\Omega}{k_d \\cdot 1} P_s(0) = \\frac{1}{n!} \\left(\\frac{k_b\\Omega}{k_d}\\right)^n P_s(0)\n$$\n归一化条件 $\\sum_{n=0}^\\infty P_s(n) = 1$ 允许我们确定 $P_s(0)$：\n$$\nP_s(0) \\sum_{n=0}^\\infty \\frac{1}{n!} \\left(\\frac{k_b\\Omega}{k_d}\\right)^n = 1\n$$\n将该求和识别为指数函数的泰勒级数，我们有：\n$$\nP_s(0) \\exp\\left(\\frac{k_b\\Omega}{k_d}\\right) = 1 \\implies P_s(0) = \\exp\\left(-\\frac{k_b\\Omega}{k_d}\\right)\n$$\n将其代回，我们得到精确的稳态分布：\n$$\nP_s(n) = \\frac{(\\frac{k_b\\Omega}{k_d})^n}{n!} \\exp\\left(-\\frac{k_b\\Omega}{k_d}\\right)\n$$\n这是一个参数为 $\\lambda = \\frac{k_b\\Omega}{k_d}$ 的泊松分布。对于泊松分布，其均值和方差都等于参数 $\\lambda$。\n因此，分子数 $n$ 的精确稳态方差为：\n$$\n\\text{Var}_{\\text{CME}}(n) = \\lambda = \\frac{k_b\\Omega}{k_d}\n$$\n\n### IV. LNA 方差与精确方差的比较\n\n比较第二节和第三节的结果：\n$$\n\\text{Var}_{\\text{LNA}}(n) = \\frac{k_b\\Omega}{k_d} \\quad \\text{and} \\quad \\text{Var}_{\\text{CME}}(n) = \\frac{k_b\\Omega}{k_d}\n$$\n我们看到 $\\text{Var}_{\\text{LNA}}(n) = \\text{Var}_{\\text{CME}}(n)$。对于具有线性倾向的系统，LNA 给出精确的方差。\n\n### V. 高阶累积量\n\n为了找到非高斯修正，我们分析超出 LNA 范围的 Fokker-Planck 方程。我们需要包含扩散系数对涨落的依赖性。$\\xi$ 的 FPE 是通过对 $x$ 的 FPE 进行变量替换得到的。这导出了一个关于 $\\xi$ 的矩的层次结构。稳态矩 $\\langle\\xi^m\\rangle_s$ 满足：\n$$\nm k_d \\langle \\xi^m \\rangle_s = \\frac{m(m-1)}{2} \\langle \\xi^{m-2} B_\\xi(\\xi) \\rangle_s\n$$\n其中 $B_\\xi(\\xi)$ 是 $\\xi$ 的 FPE 中的扩散系数。从 $B(x)$ 变换得到：\n$B_\\xi(\\xi) = \\Omega B(x(\\xi)) = \\Omega \\frac{k_b+k_d(\\bar{x}+\\xi/\\sqrt{\\Omega})}{\\Omega} = k_b+k_d\\bar{x} + \\frac{k_d\\xi}{\\sqrt{\\Omega}} = 2k_b + \\frac{k_d\\xi}{\\sqrt{\\Omega}}$。\n矩的层次结构是：\n$$\nm k_d \\langle \\xi^m \\rangle_s = \\frac{m(m-1)}{2} \\left\\langle \\xi^{m-2} \\left(2k_b + \\frac{k_d\\xi}{\\sqrt{\\Omega}}\\right) \\right\\rangle_s\n$$\n$$\nk_d \\langle \\xi^m \\rangle_s = (m-1)k_b \\langle \\xi^{m-2} \\rangle_s + \\frac{(m-1)k_d}{2\\sqrt{\\Omega}} \\langle \\xi^{m-1} \\rangle_s\n$$\n我们求解这个层次结构以得到稳态矩：\n-   对于 $m=1$：$k_d \\langle \\xi \\rangle_s = 0$。因为 $k_d0$，所以 $\\langle \\xi \\rangle_s = 0$。这意味着 $\\xi$ 是一个中心化变量，符合预期。\n-   对于 $m=2$：$k_d \\langle \\xi^2 \\rangle_s = (1)k_b \\langle \\xi^0 \\rangle_s + 0 = k_b$。所以 $\\langle \\xi^2 \\rangle_s = \\frac{k_b}{k_d}$。\n-   对于 $m=3$：$k_d \\langle \\xi^3 \\rangle_s = (2)k_b \\langle \\xi \\rangle_s + \\frac{(2)k_d}{2\\sqrt{\\Omega}} \\langle \\xi^2 \\rangle_s = 0 + \\frac{k_d}{\\sqrt{\\Omega}}\\left(\\frac{k_b}{k_d}\\right) = \\frac{k_b}{\\sqrt{\\Omega}}$。所以 $\\langle \\xi^3 \\rangle_s = \\frac{k_b}{k_d\\sqrt{\\Omega}}$。\n-   对于 $m=4$：$k_d \\langle \\xi^4 \\rangle_s = (3)k_b \\langle \\xi^2 \\rangle_s + \\frac{(3)k_d}{2\\sqrt{\\Omega}} \\langle \\xi^3 \\rangle_s = 3k_b\\left(\\frac{k_b}{k_d}\\right) + \\frac{3k_d}{2\\sqrt{\\Omega}}\\left(\\frac{k_b}{k_d\\sqrt{\\Omega}}\\right) = \\frac{3k_b^2}{k_d} + \\frac{3k_b}{2\\Omega}$。所以 $\\langle \\xi^4 \\rangle_s = \\frac{3k_b^2}{k_d^2} + \\frac{3k_b}{2k_d\\Omega}$。\n\n中心化变量的累积量 $\\kappa_m$ 与其矩相关。\n-   **三阶累积量 ($\\kappa_3$)：** $\\kappa_3(\\xi) = \\langle\\xi^3\\rangle_s$。\n    $$\n    \\kappa_3(\\xi) = \\frac{k_b}{k_d\\sqrt{\\Omega}}\n    $$\n    这是主导的非高斯修正，其标度关系为 $\\Omega^{-1/2}$。\n\n-   **四阶累积量 ($\\kappa_4$)：** $\\kappa_4(\\xi) = \\langle\\xi^4\\rangle_s - 3(\\langle\\xi^2\\rangle_s)^2$。\n    $$\n    \\kappa_4(\\xi) = \\left(\\frac{3k_b^2}{k_d^2} + \\frac{3k_b}{2k_d\\Omega}\\right) - 3\\left(\\frac{k_b}{k_d}\\right)^2 = \\frac{3k_b}{2k_d\\Omega}\n    $$\n    此修正的标度关系为 $\\Omega^{-1}$。在宏观极限 $\\Omega \\to \\infty$ 时，$\\kappa_3$ 和 $\\kappa_4$ 都趋于零，此时分布变为高斯分布。\n\n所要求的最终答案是分子数 $n$ 的稳态方差。\n$$\n\\text{Var}(n) = \\frac{k_b\\Omega}{k_d}\n$$", "answer": "$$\n\\boxed{\\frac{k_b \\Omega}{k_d}}\n$$", "id": "3310020"}, {"introduction": "基于先前推导出的连续近似 [@problem_id:3310020]，本练习将直面一个关键局限性：当分子数量较少时，在零分子边界附近出现非物理的负概率。你将量化这一误差，然后构建一个混合CME-FPE模型来修正它，这是为低拷贝数系统建立精确、稳健模型的重要实践。", "problem": "考虑在充分混合的隔室中，单一的生化物质经历零级合成和一级降解，该过程被建模为生灭过程。状态变量是分子拷贝数，记为 $x(t) \\in \\mathbb{N}$。合成以恒定速率 $k$（单位：分子/秒）发生，降解速率为每个分子 $\\gamma$（单位：1/秒）。该系统的化学主方程 (CME) 控制了在 $x \\in \\mathbb{N}$ 上的概率质量函数的时间演化。连续 Fokker-Planck 方程 (FPE) 近似源于系统尺寸展开，并对应于 CME 的扩散过程近似。\n\n您的任务是：\n\n1.  从生灭过程的基本 CME 和通过 Kramers–Moyal 展开的标准扩散近似出发，推导确定性不动点 $x^{\\ast}$ 附近的线性化稳态 FPE 近似。使用逻辑一致的展开来获得稳态连续概率密度 $p_{\\mathrm{FPE}}(x)$，并描述其在边界 $x = 0$ 附近的负概率质量。\n\n2.  将连续近似的负概率质量分数定义为 $p_{\\mathrm{FPE}}(x)$ 在 $x  0$ 上的积分。通过引入一个容差 $\\tau \\in (0,1)$，量化当此负质量变得显著时参数比 $k/\\gamma$ 的范围，并确定当负概率质量分数等于 $\\tau$ 时的临界比值 $(k/\\gamma)_{\\mathrm{crit}}$。\n\n3.  提出一种科学合理的混合策略，通过在边界附近结合 CME，在远离边界处结合连续 FPE 来减轻边界误差。该混合策略必须满足总概率守恒并消除负概率质量。明确如何选择一个离散截断值 $n_{c} \\in \\mathbb{N}$ 和一个混合程序，以便将连续近似预测的负质量重新分配给小 $x$ 处的离散 CME 支持的状态。\n\n您的程序必须为每个测试用例实现以下量化输出：\n- 计算比值 $\\mu = k/\\gamma$。\n- 计算由稳态线性化 FPE 近似预测的负概率质量分数 $\\varepsilon_{\\mathrm{FPE}}(\\mu)$。\n- 计算当负概率质量分数等于容差 $\\tau$ 时的临界比值 $(k/\\gamma)_{\\mathrm{crit}}(\\tau)$。\n- 通过检查是否 $\\varepsilon_{\\mathrm{FPE}}(\\mu)  \\tau$ 来决定是否需要混合；返回一个布尔值。\n- 计算最小截断值 $n_{c}$，使得在 $\\{0,1,\\dots,n_{c}\\}$ 上的累积 CME 概率至少为 $\\varepsilon_{\\mathrm{FPE}}(\\mu)$，从而重新分配的概率可以消除负质量。\n\n请使用具有物理意义的参数，并确保所有量纲一致：$k$ 必须以分子/秒为单位提供，$\\gamma$ 以 1/秒为单位；比值 $\\mu = k/\\gamma$ 是无量纲的。所有返回的值必须是无单位的浮点数或整数。不涉及角度。\n\n测试套件：\n为以下参数集 $(k,\\gamma,\\tau)$ 提供结果：\n- $(0.1, 1.0, 0.01)$\n- $(1.0, 1.0, 0.01)$\n- $(5.0, 1.0, 0.01)$\n- $(5.414213562, 1.0, 0.01)$\n- $(20.0, 1.0, 0.01)$\n- $(50.0, 10.0, 10^{-4})$\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个方括号内的逗号分隔列表形式的结果，每个测试用例对应一个 $[\\varepsilon_{\\mathrm{FPE}}, (k/\\gamma)_{\\mathrm{crit}}, \\mathrm{hybrid\\_needed}, n_{c}]$ 形式的嵌套列表。例如：$[[e_{1},c_{1},b_{1},n_{1}],[e_{2},c_{2},b_{2},n_{2}],\\dots]$。", "solution": "该问题被评估为科学合理、定义明确、客观且完整。它提出了一个计算系统生物学中关于 Fokker-Planck 方程 (FPE) 作为化学主方程 (CME) 近似的局限性和应用的标准但非平凡的练习。所有必要的参数都已提供以进行所要求的计算。因此，我们可以进行完整求解。\n\n解决方案分为三个部分，对应问题陈述中列出的任务。\n\n### 第一部分：线性化稳态 Fokker-Planck 方程的推导\n\n我们考虑一个生灭过程，其中分子数为 $x$ 的物质以恒定速率 $k$ 合成，并以一级速率 $\\gamma x$ 降解。状态转移及其相应的速率 $W$ 如下：\n- 生成：$x \\to x+1$，速率为 $W(x \\to x+1) = k$。\n- 降解：$x \\to x-1$，速率为 $W(x \\to x-1) = \\gamma x$。\n\n概率分布 $P(x,t)$ 在离散状态 $x \\in \\mathbb{N}_0$ 上的时间演化由化学主方程 (CME) 控制：\n$$\n\\frac{\\partial P(x,t)}{\\partial t} = k P(x-1,t) + \\gamma(x+1)P(x+1,t) - (k + \\gamma x)P(x,t)\n$$\n\n为了用连续过程近似此离散状态随机过程，我们使用 Kramers-Moyal 展开，通过在二阶截断得到 Fokker-Planck 方程 (FPE)。FPE 由下式给出：\n$$\n\\frac{\\partial p(x,t)}{\\partial t} = -\\frac{\\partial}{\\partial x} [\\alpha_1(x) p(x,t)] + \\frac{1}{2}\\frac{\\partial^2}{\\partial x^2} [\\alpha_2(x) p(x,t)]\n$$\n其中 $p(x,t)$ 是连续概率密度，$\\alpha_1(x)$ 和 $\\alpha_2(x)$ 分别是一阶和二阶跳跃矩。这些矩的计算如下：\n$$\n\\alpha_1(x) = \\sum_{\\Delta x} \\Delta x \\cdot W(x \\to x+\\Delta x) = (+1)k + (-1)\\gamma x = k - \\gamma x\n$$\n$$\n\\alpha_2(x) = \\sum_{\\Delta x} (\\Delta x)^2 \\cdot W(x \\to x+\\Delta x) = (+1)^2 k + (-1)^2 \\gamma x = k + \\gamma x\n$$\n项 $\\alpha_1(x)$ 是漂移系数，$\\alpha_2(x)$ 是扩散系数。将这些代入 FPE 得到：\n$$\n\\frac{\\partial p(x,t)}{\\partial t} = -\\frac{\\partial}{\\partial x} [(k - \\gamma x) p(x,t)] + \\frac{1}{2}\\frac{\\partial^2}{\\partial x^2} [(k + \\gamma x) p(x,t)]\n$$\n\n问题要求一个线性化的 FPE。这种近似，也称为线性噪声近似 (LNA)，涉及将漂移和扩散系数在确定性稳态 $x^*$ 附近线性化。确定性速率方程为 $\\frac{dx}{dt} = k - \\gamma x$，其在 $x^* = k/\\gamma$ 处有一个稳定不动点。我们将这个比值记为 $\\mu = k/\\gamma$。\n\n漂移系数 $\\alpha_1(x) = k - \\gamma x = \\gamma(x^* - x)$ 已经是 $x$ 的线性函数。扩散系数 $\\alpha_2(x) = k + \\gamma x$ 通过其在不动点处的值来近似：\n$$\n\\alpha_2(x) \\approx \\alpha_2(x^*) = k + \\gamma x^* = k + \\gamma (k/\\gamma) = 2k\n$$\n因此，线性化 FPE 为：\n$$\n\\frac{\\partial p(x,t)}{\\partial t} = -\\frac{\\partial}{\\partial x} [(k - \\gamma x) p(x,t)] + \\frac{1}{2}\\frac{\\partial^2}{\\partial x^2} [2k \\cdot p(x,t)] = \\frac{\\partial}{\\partial x} [\\gamma(x - \\mu) p(x,t)] + k \\frac{\\partial^2 p(x,t)}{\\partial x^2}\n$$\n在稳态下，$\\frac{\\partial p(x,t)}{\\partial t} = 0$。对稳态方程积分一次可得：\n$$\n\\gamma(x - \\mu) p(x) + k \\frac{dp(x)}{dx} = C\n$$\n根据边界条件，$p(x)$ 及其导数当 $x \\to \\pm\\infty$ 时趋于零，积分常数 $C$ 必须为 $0$。这留下一个可分离的一阶常微分方程：\n$$\nk \\frac{dp}{dx} = -\\gamma(x - \\mu) p(x) \\implies \\frac{dp}{p} = -\\frac{\\gamma}{k}(x - \\mu)dx = -\\frac{1}{\\mu}(x-\\mu)dx\n$$\n对两边积分可得 $\\ln p(x) = -\\frac{(x-\\mu)^2}{2\\mu} + \\text{const}$。解是一个高斯（正态）分布：\n$$\np_{\\mathrm{FPE}}(x) = \\mathcal{N}(\\mu, \\sigma^2) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(x - \\mu)^2}{2\\sigma^2}\\right)\n$$\n方差为 $\\sigma^2 = k/\\gamma = \\mu$。因此，线性化 FPE 的稳态解为：\n$$\np_{\\mathrm{FPE}}(x) = \\frac{1}{\\sqrt{2\\pi\\mu}} \\exp\\left(-\\frac{(x - \\mu)^2}{2\\mu}\\right)\n$$\n这个连续近似对所有 $x \\in (-\\infty, \\infty)$ 都有定义，而真实的分子数是非负整数。这种差异导致 FPE 为非物理区域 $x  0$ 分配了非零的概率密度。这种“负概率质量”是 FPE 近似失效的一个标志，尤其当均值 $\\mu$ 接近边界 $x=0$ 时。\n\n### 第二部分：负概率质量分数与临界比值\n\n负概率质量分数 $\\varepsilon_{\\mathrm{FPE}}(\\mu)$ 是 $p_{\\mathrm{FPE}}(x)$ 在非物理区域 $x  0$ 上的积分：\n$$\n\\varepsilon_{\\mathrm{FPE}}(\\mu) = \\int_{-\\infty}^{0} p_{\\mathrm{FPE}}(x) dx = \\int_{-\\infty}^{0} \\frac{1}{\\sqrt{2\\pi\\mu}} \\exp\\left(-\\frac{(x - \\mu)^2}{2\\mu}\\right) dx\n$$\n这个积分是正态分布 $\\mathcal{N}(\\mu, \\mu)$ 的累积分布函数 (CDF) 在 $x=0$ 处的值。通过用 $z = (x-\\mu)/\\sqrt{\\mu}$ 标准化变量，积分上限 $x=0$ 变为 $z = (0-\\mu)/\\sqrt{\\mu} = -\\sqrt{\\mu}$。该积分等价于标准正态分布 $\\mathcal{N}(0, 1)$ 的 CDF，记为 $\\Phi(z)$，在 $z=-\\sqrt{\\mu}$ 处的值：\n$$\n\\varepsilon_{\\mathrm{FPE}}(\\mu) = \\Phi(-\\sqrt{\\mu}) = \\frac{1}{2}\\left[1 + \\mathrm{erf}\\left(\\frac{-\\sqrt{\\mu}}{\\sqrt{2}}\\right)\\right] = \\frac{1}{2}\\mathrm{erfc}\\left(\\sqrt{\\frac{\\mu}{2}}\\right)\n$$\n\n接下来，我们求出当负质量分数等于给定容差 $\\tau$ 时的临界比值 $(k/\\gamma)_{\\mathrm{crit}} = \\mu_{\\mathrm{crit}}$：\n$$\n\\varepsilon_{\\mathrm{FPE}}(\\mu_{\\mathrm{crit}}) = \\tau \\implies \\Phi(-\\sqrt{\\mu_{\\mathrm{crit}}}) = \\tau\n$$\n为了求解 $\\mu_{\\mathrm{crit}}$，我们对两边应用逆标准正态 CDF，$\\Phi^{-1}$（也称为分位数函数或百分点函数）：\n$$\n-\\sqrt{\\mu_{\\mathrm{crit}}} = \\Phi^{-1}(\\tau)\n$$\n由于 $\\tau \\in (0,1)$ 且通常很小（例如 $\\tau  0.5$），$\\Phi^{-1}(\\tau)$ 是负数。两边平方得到临界比值：\n$$\n\\mu_{\\mathrm{crit}} = \\left(\\Phi^{-1}(\\tau)\\right)^2\n$$\n\n### 第三部分：混合策略与截断参数 $n_c$\n\n提出了一种混合建模策略来修正 FPE 的边界误差。其核心思想是对低分子数使用更精确的离散 CME 描述，而对高分子数使用计算效率更高的 FPE。问题指定了一种基于质量重新分配来确定截断值的方法。从 FPE 计算出的负概率质量 $\\varepsilon_{\\mathrm{FPE}}(\\mu)$ 将被“重新分配”给由 CME 描述的低计数离散状态。\n\n此生灭过程的 CME 的精确稳态解是均值为 $\\mu=k/\\gamma$ 的泊松分布：\n$$\nP_{\\mathrm{CME}}(x; \\mu) = \\frac{e^{-\\mu}\\mu^x}{x!} \\quad \\text{对于 } x \\in \\{0, 1, 2, \\dots\\}\n$$\n我们需要找到最小的整数截断值 $n_c \\in \\mathbb{N}_0$，使得从 $0$ 到 $n_c$ 的离散状态的累积概率足以解释来自 FPE 的虚假负质量。在数学上，我们寻求满足以下条件的最小 $n_c$：\n$$\n\\sum_{i=0}^{n_c} P_{\\mathrm{CME}}(i; \\mu) \\ge \\varepsilon_{\\mathrm{FPE}}(\\mu)\n$$\n这等价于找到最小的 $n_c$，使得泊松分布的 CDF，$F_{\\mathrm{Poisson}}(n_c; \\mu)$，大于或等于目标概率 $\\varepsilon_{\\mathrm{FPE}}(\\mu)$。该值可以使用泊松分布的逆 CDF（百分点函数）高效地找到。\n\n实现的量化步骤如下：\n1.  对于每个测试用例 $(k, \\gamma, \\tau)$，计算 $\\mu = k/\\gamma$。\n2.  计算负质量分数 $\\varepsilon_{\\mathrm{FPE}}(\\mu) = \\Phi(-\\sqrt{\\mu})$。\n3.  计算给定容差 $\\tau$ 的临界比值 $\\mu_{\\mathrm{crit}} = (\\Phi^{-1}(\\tau))^2$。\n4.  通过检查是否 $\\varepsilon_{\\mathrm{FPE}}(\\mu)  \\tau$ 来决定是否需要混合。\n5.  如果需要混合，计算最小整数截断值 $n_c$，使得 $F_{\\mathrm{Poisson}}(n_c; \\mu) \\ge \\varepsilon_{\\mathrm{FPE}}(\\mu)$。如果不需要，根据完整的输出格式要求，仍需为完整性计算此值。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import norm, poisson\n\ndef solve():\n    \"\"\"\n    Solves the biochemical noise problem for a set of test cases.\n\n    For each case, it computes:\n    - The negative probability mass fraction from the FPE approximation.\n    - The critical k/gamma ratio for a given tolerance.\n    - A boolean flag indicating if a hybrid model is needed.\n    - The discrete cutoff nc for the hybrid model.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple is (k, gamma, tau)\n    test_cases = [\n        (0.1, 1.0, 0.01),\n        (1.0, 1.0, 0.01),\n        (5.0, 1.0, 0.01),\n        (5.414213562, 1.0, 0.01),\n        (20.0, 1.0, 0.01),\n        (50.0, 10.0, 10**-4),\n    ]\n\n    results = []\n    for k, gamma, tau in test_cases:\n        # Task 1  2: Compute mu and negative probability mass epsilon_FPE\n        # mu is the mean of the distribution, which is also the variance in the LNA model.\n        mu = k / gamma\n        \n        # epsilon_FPE is the CDF of a Normal(mu, mu) distribution evaluated at 0.\n        # This is equivalent to the standard normal CDF evaluated at -sqrt(mu).\n        epsilon_fpe = norm.cdf(0, loc=mu, scale=np.sqrt(mu))\n\n        # Task 2: Compute the critical ratio (k/gamma)_crit\n        # This is found by inverting the relationship: tau = Phi(-sqrt(mu_crit))\n        # z = Phi^-1(tau), so mu_crit = z^2\n        z_crit = norm.ppf(tau)\n        k_gamma_crit = z_crit**2\n\n        # Task 3: Decide if hybridization is needed\n        # This is true if the negative mass fraction exceeds the tolerance.\n        # The result is cast to an integer (1 for True, 0 for False) for the output.\n        hybrid_needed = int(epsilon_fpe > tau)\n\n        # Task 3: Compute the cutoff n_c\n        # n_c is the smallest integer such that the cumulative Poisson probability\n        # is at least epsilon_fpe. This is given by the Poisson percent-point function (inverse CDF).\n        # The ppf function returns a float, so we cast it to an integer.\n        nc = int(poisson.ppf(epsilon_fpe, mu))\n        \n        # For the edge case where epsilon_fpe is 0, ppf might return -1.\n        # Since nc must be a non-negative integer, we ensure nc >= 0.\n        if nc  0:\n            nc = 0\n\n        results.append([epsilon_fpe, k_gamma_crit, hybrid_needed, nc])\n\n    # Final print statement in the exact required format.\n    # The format is [[e1,c1,b1,n1],[e2,c2,b2,n2],...] with no spaces.\n    inner_parts = [f\"[{r[0]},{r[1]},{r[2]},{r[3]}]\" for r in results]\n    final_output = f\"[{','.join(inner_parts)}]\"\n    print(final_output)\n\nsolve()\n```", "id": "3310056"}, {"introduction": "建模的最终目标通常是将理论与真实数据联系起来。最后一个实践练习通过展示如何利用福克-普朗克方程的稳态解进行参数推断，从而完成了理论到应用的闭环。通过推导和实现最大似然估计，你将学习如何从系统涨落的快照测量中提取其潜在的动力学参数，这是计算系统生物学中的一项基石技术。", "problem": "给定一个基因产物浓度的一维随机模型，该模型被表述为一个带有加性噪声的 Itô 随机微分方程 (SDE)。\n$$\n\\mathrm{d}x_t = a(x_t)\\,\\mathrm{d}t + \\sqrt{2\\,D}\\,\\mathrm{d}W_t,\n$$\n其中 $x_t$ 是时间 $t$ 时的无量纲浓度，$a(x)$ 是漂移项，$D  0$ 是恒定的噪声强度，$W_t$ 是一个标准维纳过程。在此模型中，漂移项由一个线性生灭形式给出\n$$\na(x) = k_s - \\gamma x,\n$$\n其中 $k_s  0$ 是无量纲生成速率，$\\gamma  0$ 是无量纲线性降解速率。\n\n从 Itô SDE 出发，关于概率密度 $p(x,t)$ 的相应 Fokker-Planck 方程 (FPE) 是一个经过充分检验的关系式\n$$\n\\frac{\\partial}{\\partial t}p(x,t)= -\\frac{\\partial}{\\partial x}\\big(a(x)\\,p(x,t)\\big) + D\\,\\frac{\\partial^2}{\\partial x^2}p(x,t),\n$$\n它被用作以下推导的基本出发点。\n\n任务 A (从 Fokker-Planck 方程推导稳态密度)：仅从给定的 SDE 和 Fokker-Planck 方程出发，在 $\\lvert x\\rvert\\to\\infty$ 时概率流为零的适当边界条件下，推导稳态概率密度 $p^\\star(x)$。不要假设或直接引用稳态解；通过设置 $\\partial_t p(x,t)=0$ 并要求物理可归一性，从第一性原理进行推导。以闭合形式表示最终的稳态密度，并用 $k_s$、$\\gamma$ 和 $D$ 来确定其位置和尺度（均值和方差）。\n\n任务 B (通过最大似然估计进行参数推断)：假设 $\\gamma$ 已知且固定，但 $k_s$ 和 $D$ 未知。观测到从任务 A 中推导出的稳态密度 $p^\\star(x)$ 中抽取的 $N$ 个独立同分布的快照测量值 $\\{x_i\\}_{i=1}^N$。使用最大似然估计 (MLE)，根据从 $\\{x_i\\}$ 计算出的样本均值和样本方差，推导出 $\\widehat{k_s}$ 和 $\\widehat{D}$ 的显式估计量。清晰地定义所有步骤，并基于稳态密度的对数似然进行推导。\n\n任务 C (在测试套件上实现和评估)：实现一个程序，该程序\n- 使用任务 A 中推导出的稳态密度 $p^\\star(x)$ 来生成数据，\n- 对于每个测试用例，使用固定的随机种子生成 $N$ 个合成快照，然后通过任务 B 中推导的 MLE 计算 $\\widehat{k_s}$ 和 $\\widehat{D}$，\n- 将每个测试用例的估计值以浮点数形式输出，并四舍五入到六位小数。\n\n根据构造，所有变量和参数都是无量纲的，因此输出中不需要物理单位。\n\n测试套件：\n- 用例 1：$\\gamma=1.0$, $k_s=10.0$, $D=2.0$, $N=500$, seed $=42$。\n- 用例 2：$\\gamma=1.5$, $k_s=3.0$, $D=0.1$, $N=1000$, seed $=123$。\n- 用例 3：$\\gamma=0.8$, $k_s=8.0$, $D=4.0$, $N=30$, seed $=7$。\n\n覆盖目标：\n- 用例 1 是一个一般情况，具有中等方差和充足的数据，\n- 用例 2 探查了一个具有小噪声强度的近确定性区域，\n- 用例 3 测试了具有相对较大方差的小样本行为。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每个测试用例的结果必须是一个双元素列表 $[\\widehat{k_s},\\widehat{D}]$，其中每个浮点数都四舍五入到六位小数。三个用例的结果必须按 1,2,3 的顺序出现。例如，您的最终输出行应如下所示\n$$\n[[\\widehat{k_s}^{(1)},\\widehat{D}^{(1)}],[\\widehat{k_s}^{(2)},\\widehat{D}^{(2)}],[\\widehat{k_s}^{(3)},\\widehat{D}^{(3)}]]\n$$\n以单行打印，不含任何额外文本。", "solution": "所述问题是有效的。它在科学上植根于已建立的随机过程理论，特别是 Ornstein-Uhlenbeck 过程，以及该理论通过 Fokker-Planck 形式体系在生物化学反应动力学中的应用。这个问题是适定的，提供了所有必要信息，且没有内部矛盾。它展示了一个在理论推导和计算实现方面的标准且非平凡的练习，与计算系统生物学领域相关。因此，我们可以进行完整的解答。\n\n问题分为三个任务：A) 推导稳态概率密度，B) 推导模型参数的最大似然估计量，以及 C) 在合成数据上实现和评估这些估计量。我们将依次处理每个任务。\n\n**任务 A: 推导稳态概率密度**\n\n出发点是关于浓度 $x$ 的概率密度 $p(x,t)$ 的 Fokker-Planck 方程 (FPE)：\n$$\n\\frac{\\partial}{\\partial t}p(x,t) = -\\frac{\\partial}{\\partial x}J(x,t)\n$$\n其中 $J(x,t)$ 是概率流，由下式给出：\n$$\nJ(x,t) = a(x)p(x,t) - D\\frac{\\partial}{\\partial x}p(x,t)\n$$\n漂移项指定为 $a(x) = k_s - \\gamma x$。\n\n为了找到记为 $p^\\star(x)$ 的稳态概率密度，我们寻求稳态下的解，此时概率密度不再随时间变化。这通过设置 $\\frac{\\partial p}{\\partial t} = 0$ 来实现。这个条件意味着稳态概率流 $J^\\star(x)$ 必须相对于 $x$ 是一个常数：\n$$\n\\frac{\\partial J^\\star(x)}{\\partial x} = 0 \\implies J^\\star(x) = \\text{constant}\n$$\n问题指定了一个具有物理意义的边界条件：概率流必须在无穷远处消失，即 $\\lim_{|x|\\to\\infty} J^\\star(x) = 0$。这要求该常数为零，从而得到对所有 $x$ 都有 $J^\\star(x) = 0$ 的条件。\n\n将稳态流设为零，得到一个关于 $p^\\star(x)$ 的一阶常微分方程：\n$$\na(x)p^\\star(x) - D\\frac{\\mathrm{d}}{\\mathrm{d}x}p^\\star(x) = 0\n$$\n代入给定的漂移项 $a(x) = k_s - \\gamma x$：\n$$\n(k_s - \\gamma x)p^\\star(x) = D\\frac{\\mathrm{d}p^\\star(x)}{\\mathrm{d}x}\n$$\n这是一个可分离微分方程。我们可以将其重新排列为：\n$$\n\\frac{\\mathrm{d}p^\\star}{p^\\star} = \\frac{k_s - \\gamma x}{D} \\mathrm{d}x\n$$\n对两边从某个参考点积分到 $x$：\n$$\n\\int \\frac{\\mathrm{d}p^\\star}{p^\\star} = \\int \\frac{k_s - \\gamma x}{D} \\mathrm{d}x\n$$\n$$\n\\ln p^\\star(x) = \\frac{1}{D} \\left( k_s x - \\frac{\\gamma x^2}{2} \\right) + C_0\n$$\n其中 $C_0$ 是积分常数。对两边取指数可得：\n$$\np^\\star(x) = C_1 \\exp\\left( \\frac{k_s x}{D} - \\frac{\\gamma x^2}{2D} \\right)\n$$\n其中 $C_1 = e^{C_0}$ 是一个归一化常数。为了识别该分布的形式，我们对指数部分进行配方：\n$$\n-\\frac{\\gamma}{2D}\\left(x^2 - \\frac{2k_s}{\\gamma}x\\right) = -\\frac{\\gamma}{2D}\\left( \\left(x - \\frac{k_s}{\\gamma}\\right)^2 - \\left(\\frac{k_s}{\\gamma}\\right)^2 \\right) = -\\frac{\\left(x - k_s/\\gamma\\right)^2}{2D/\\gamma} + \\frac{k_s^2}{2D\\gamma}\n$$\n将此代回，我们得到：\n$$\np^\\star(x) = C_1 \\exp\\left(\\frac{k_s^2}{2D\\gamma}\\right) \\exp\\left( -\\frac{\\left(x - k_s/\\gamma\\right)^2}{2(D/\\gamma)} \\right)\n$$\n让我们定义一个新的归一化常数 $C = C_1 \\exp\\left(\\frac{k_s^2}{2D\\gamma}\\right)$。则密度为：\n$$\np^\\star(x) = C \\exp\\left( -\\frac{(x - \\mu)^2}{2\\sigma^2} \\right)\n$$\n这可以立即被识别为高斯（正态）分布 $N(\\mu, \\sigma^2)$ 的概率密度函数，其位置（均值）$\\mu$ 和尺度（方差）$\\sigma^2$ 由下式给出：\n$$\n\\mu = \\frac{k_s}{\\gamma}\n$$\n$$\n\\sigma^2 = \\frac{D}{\\gamma}\n$$\n归一化常数 $C$ 由条件 $\\int_{-\\infty}^{\\infty} p^\\star(x) \\mathrm{d}x = 1$ 确定，对于高斯分布，这要求 $C = \\frac{1}{\\sqrt{2\\pi\\sigma^2}}$。因此，稳态密度为：\n$$\np^\\star(x) = \\frac{1}{\\sqrt{2\\pi D/\\gamma}} \\exp\\left( -\\frac{(x - k_s/\\gamma)^2}{2(D/\\gamma)} \\right)\n$$\n稳态分布的均值为 $\\mathbb{E}[x] = k_s/\\gamma$，方差为 $\\text{Var}(x) = D/\\gamma$。\n\n**任务 B: 通过最大似然估计 (MLE) 进行参数推断**\n\n给定从稳态分布 $p^\\star(x) \\sim N(k_s/\\gamma, D/\\gamma)$ 中抽取的 $N$ 个独立同分布 (i.i.d.) 的测量值 $\\{x_i\\}_{i=1}^N$。参数 $\\gamma$ 已知，而 $k_s$ 和 $D$ 待估计。\n\n观测数据的似然函数 $\\mathcal{L}(k_s, D)$ 是每个观测概率的乘积：\n$$\n\\mathcal{L}(k_s, D | \\{x_i\\}, \\gamma) = \\prod_{i=1}^N p^\\star(x_i | k_s, D, \\gamma) = \\prod_{i=1}^N \\frac{1}{\\sqrt{2\\pi D/\\gamma}} \\exp\\left( -\\frac{\\gamma(x_i - k_s/\\gamma)^2}{2D} \\right)\n$$\n最大化似然函数等价于最大化对数似然函数 $\\ell = \\ln \\mathcal{L}$。\n$$\n\\ell(k_s, D) = \\sum_{i=1}^N \\left( -\\frac{1}{2}\\ln(2\\pi) - \\frac{1}{2}\\ln(D/\\gamma) - \\frac{\\gamma(x_i - k_s/\\gamma)^2}{2D} \\right)\n$$\n$$\n\\ell(k_s, D) = -\\frac{N}{2}\\ln(2\\pi) - \\frac{N}{2}\\ln(D) + \\frac{N}{2}\\ln(\\gamma) - \\frac{\\gamma}{2D}\\sum_{i=1}^N(x_i - k_s/\\gamma)^2\n$$\n为了找到最大似然估计量 (MLEs) $\\widehat{k_s}$ 和 $\\widehat{D}$，我们计算 $\\ell$ 关于 $k_s$ 和 $D$ 的偏导数，并令它们为零。\n\n对于 $k_s$：\n$$\n\\frac{\\partial \\ell}{\\partial k_s} = -\\frac{\\gamma}{2D} \\sum_{i=1}^N 2(x_i - k_s/\\gamma)\\left(-\\frac{1}{\\gamma}\\right) = \\frac{1}{D}\\sum_{i=1}^N (x_i - k_s/\\gamma) = 0\n$$\n由于 $D0$，我们必须有 $\\sum_{i=1}^N (x_i - k_s/\\gamma)=0$。这导致：\n$$\n\\sum_{i=1}^N x_i = N\\frac{k_s}{\\gamma} \\implies \\frac{k_s}{\\gamma} = \\frac{1}{N}\\sum_{i=1}^N x_i = \\bar{x}\n$$\n此处，$\\bar{x}$ 是样本均值。因此，$k_s$ 的估计量为：\n$$\n\\widehat{k_s} = \\gamma \\bar{x}\n$$\n\n对于 $D$：\n$$\n\\frac{\\partial \\ell}{\\partial D} = -\\frac{N}{2D} + \\frac{\\gamma}{2D^2}\\sum_{i=1}^N(x_i - k_s/\\gamma)^2 = 0\n$$\n乘以 $2D^2$ 可得：\n$$\n-ND + \\gamma\\sum_{i=1}^N(x_i - k_s/\\gamma)^2 = 0 \\implies D = \\frac{\\gamma}{N}\\sum_{i=1}^N(x_i - k_s/\\gamma)^2\n$$\n为了找到 MLE $\\widehat{D}$，我们代入 $k_s/\\gamma$ 的 MLE，即 $\\bar{x}$：\n$$\n\\widehat{D} = \\frac{\\gamma}{N}\\sum_{i=1}^N(x_i - \\bar{x})^2\n$$\n这个表达式是 $\\gamma$ 乘以样本方差 $s^2 = \\frac{1}{N}\\sum_{i=1}^N(x_i - \\bar{x})^2$。因此，$D$ 的估计量为：\n$$\n\\widehat{D} = \\gamma s^2\n$$\n\n**任务 C: 实现与评估**\n\n任务 B 中推导出的估计量 $\\widehat{k_s} = \\gamma \\bar{x}$ 和 $\\widehat{D} = \\gamma s^2$ 构成了计算任务的基础。实现策略如下：\n1.  对于每个测试用例 $(\\gamma, k_s, D, N, \\text{seed})$，我们首先确定底层稳态正态分布的参数：均值 $\\mu = k_s/\\gamma$ 和标准差 $\\sigma = \\sqrt{D/\\gamma}$。\n2.  使用以指定种子初始化的伪随机数生成器以保证可复现性，我们从这个正态分布 $N(\\mu, \\sigma^2)$ 中抽取 $N$ 个样本。\n3.  从这个合成数据集中，我们计算样本均值 $\\bar{x}$ 和样本方差 $s^2$（根据 MLE 推导的规定，分母使用 $N$）。\n4.  然后我们应用推导出的估计量公式来计算 $\\widehat{k_s}$ 和 $\\widehat{D}$。\n5.  最后，将每个用例的结果四舍五入到六位小数，并格式化为所需的输出字符串。此过程直接将任务 A 和 B 的理论结果付诸实践。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem by generating synthetic data and applying MLE estimators.\n    \n    For each test case, the function performs the following steps:\n    1. Sets up a random number generator with a specific seed for reproducibility.\n    2. Calculates the theoretical mean (mu) and standard deviation (sigma) of the\n       stationary Normal distribution from the given parameters (k_s, gamma, D).\n    3. Generates N synthetic data points by sampling from this Normal distribution.\n    4. Computes the sample mean and sample variance of the generated data.\n    5. Calculates the Maximum Likelihood Estimates (MLEs) for k_s and D using\n       the derived formulas:\n          k_s_hat = gamma * sample_mean\n          D_hat = gamma * sample_variance\n    6. Formats the estimated parameters to six decimal places.\n    7. Collects the results and prints them in the specified single-line format.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each tuple contains: (gamma, k_s, D, N, seed)\n    test_cases = [\n        (1.0, 10.0, 2.0, 500, 42),\n        (1.5, 3.0, 0.1, 1000, 123),\n        (0.8, 8.0, 4.0, 30, 7),\n    ]\n\n    results_as_strings = []\n    \n    for case in test_cases:\n        gamma, k_s, D, N, seed = case\n        \n        # 1. Initialize the random number generator with the specified seed.\n        rng = np.random.default_rng(seed)\n        \n        # 2. Define the parameters of the stationary Normal distribution.\n        # Mean mu = k_s / gamma\n        # Variance sigma^2 = D / gamma\n        mu = k_s / gamma\n        sigma = np.sqrt(D / gamma)\n        \n        # 3. Generate N synthetic data points (snapshots) from the stationary distribution.\n        samples = rng.normal(loc=mu, scale=sigma, size=N)\n        \n        # 4. Compute sample statistics from the generated data.\n        sample_mean = np.mean(samples)\n        # np.var() uses the N denominator by default, which is correct for the MLE.\n        sample_variance = np.var(samples)\n        \n        # 5. Compute the MLE estimates for k_s and D using the derived formulas.\n        k_s_hat = gamma * sample_mean\n        D_hat = gamma * sample_variance\n        \n        # 6. Format the result for the current case as a string \"[k_s_hat, D_hat]\".\n        # The :.6f format specifier rounds the float to 6 decimal places.\n        results_as_strings.append(f\"[{k_s_hat:.6f},{D_hat:.6f}]\")\n\n    # 7. Join the results for all test cases and print in the final required format.\n    # Example format: [[k_s1,D1],[k_s2,D2],[k_s3,D3]]\n    final_output_string = f\"[{','.join(results_as_strings)}]\"\n    print(final_output_string)\n\nsolve()\n```", "id": "3310085"}]}