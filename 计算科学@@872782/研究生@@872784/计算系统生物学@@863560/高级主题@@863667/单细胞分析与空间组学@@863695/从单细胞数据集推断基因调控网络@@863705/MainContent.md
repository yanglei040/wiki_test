## 引言
基因调控网络（GRN）是细胞功能和命运决定的核心蓝图。随着[单细胞测序](@entry_id:198847)技术的普及，我们获得了前所未有的机会，在单细胞分辨率下解码这些复杂的调控网络。然而，这些数据本身充满了噪声、[稀疏性](@entry_id:136793)和各种技术偏差，使得从海量的细胞“快照”中准确推断出基因之间真实的因果调控关系，而非简单的[统计相关性](@entry_id:267552)，成为[计算系统生物学](@entry_id:747636)领域的一大核心挑战。

本文旨在为读者提供一个关于从单细胞数据推断GRN的全面指南。在接下来的章节中，我们将首先深入**原理与机制**，剖析GRN的双重性、单细胞数据的统计特性以及因果推断的基本难题。随后，在**应用与跨学科关联**中，我们将展示如何将推断出的网络转化为生物学见解，并探讨如何通过整合动力学、扰动实验和[多组学](@entry_id:148370)数据来构建更强大的模型。最后，通过一系列的**动手实践**，您将有机会亲手实现关键的算法，将理论知识转化为实践技能。通过这一结构化的学习路径，本文将引导您掌握从数据处理到高级因果建模的全过程。

## 原理与机制

### 基因调控网络的双重性：静态蓝图与动态相互作用

在系统生物学中，理解[基因调控网络](@entry_id:150976)（Gene Regulatory Network, GRN）是破译细胞功能与命运决定的核心。一个GRN的完整描述包含两个层面：静态的结构蓝图和动态的有效相互作用。

**静态拓扑**（static topology）可以被看作是一张详尽的电路图，描绘了细胞内所有潜在的调控连接。这些连接由[转录因子](@entry_id:137860)（Transcription Factors, TFs）结合到靶基因的[顺式调控元件](@entry_id:275840)（如[启动子](@entry_id:156503)和增强子）的物理可能性所决定。在形式上，我们将GRN定义为一个有向符号图 $G=(V, E, \sigma)$，其中节点 $V$ 代表基因和TFs，边 $E$ 代表调控关系。这些关系可以通过一个邻接矩阵 $B = (b_{ij})$ 来精确描述，其中 $b_{ij} \in \{-1, 0, 1\}$ 分别表示调控者 $j$ 对靶标 $i$ 的激活、抑制或无直接调控关系。这个静态拓扑结构被认为是跨越不同细胞[状态和](@entry_id:193625)条件的“硬连线”系统，编码了所有可能的调控潜力 [@problem_id:3314520]。

然而，一个潜在的调控关系是否在特定时刻发挥作用，以及其作用的强度，则取决于细胞的当前状态。这就引出了**有效相互作用**（effective interaction）的概念，它指的是在特定细胞状态下，一个调控者对靶基因表达速率的实际、可测量的影响。这种影响是高度情境依赖的，受到调控者和靶基因的表达水平、辅助因子的存在以及[染色质可及性](@entry_id:163510)等多种因素的动态调控。

为了更严谨地定义有效相互作用，我们可以将[转录调控](@entry_id:268008)[过程建模](@entry_id:183557)为一个动力学系统，其中基因表达水平的向量 $x$ 随时间 $t$ 演化，其变化率由函数 $F(x)$ 描述，即 $\frac{dx}{dt} = F(x)$。在此框架下，调控者 $j$ 对靶标 $i$ 在状态 $x$ 的有效相互作用，可以通过函数 $F_i$ 对 $x_j$ 的偏导数来量化。所有这些[偏导数](@entry_id:146280)构成了系统的**[雅可比矩阵](@entry_id:264467)**（Jacobian matrix）$J(x) = \frac{\partial F}{\partial x}$。因此，有效相互作用就是[雅可比矩阵](@entry_id:264467)的元素 $J_{ij}(x)$，它明确地依赖于细胞状态 $x$ [@problem_id:3314520]。例如，即使静态拓扑中存在一条激活边（即 $b_{ij}=1$），如果靶基因 $i$ 的染色质区域处于封闭状态，或者激活所需的辅助因子不存在，那么实际的有效相互作用 $J_{ij}(x)$ 可能接近于零。

从单细胞数据中推断GRN的核心挑战，正是在于如何从大量异质细胞的静态“快照”中，区分并重建这两个层面：既要推断出稳定、普适的静态拓扑 $B$，又要理解在不同细胞状态下变化的有效相互作用 $J(x)$。

### 观测基础：单细胞数据的挑战

我们用于GRN推断的原材料——[单细胞RNA测序](@entry_id:142269)（scRNA-seq）数据——本身充满了技术和生物学上的复杂性，这为推断任务带来了独特的挑战。

#### 随机性、噪声与技术伪影

scRNA-seq的测量过程本质上是随机的。首先，由于mRNA捕获效率有限（通常远低于100%），一个在细胞中真实表达的基因可能在测序文库中未能被捕获。当真实表达量较低时，这种随机捕获失败的概率会显著增加，导致观测到的计数值为零。这种现象被称为**“dropout”事件**，它不同于基因真正的“关闭”状态，而是由于技术限制导致的假阴性。dropout事件的概率随着真实表达丰度 $T_{ig}$ 和细胞捕获效率 $c_i$ 的降低而增加，表现为计数矩阵中存在大量的“过度零值”，尤其是在总测序读数较少（文库较小）的细胞中 [@problem_id:3314507] [@problem_id:3314531]。

其次，在文库构建过程中，需要通过[聚合酶链式反应](@entry_id:142924)（PCR）对捕获的cDNA分子进行扩增。如果没有适当的校正，PCR扩增的随机性会引入额外的变异，使得高表达或高效扩增的基因的读数被不成比例地放大。为了解决这个问题，现代scRNA-seq技术引入了**[唯一分子标识符](@entry_id:192673)**（Unique Molecular Identifiers, UMIs）。UMIs是在反转录之前就附加到每个原始mRNA分子上的短随机条形码。通过在数据分析时对具有相同基因来源和相同UMI的读数进行去重，可以更准确地计数原始被捕获的分子数量，从而显著减少PCR扩增引入的偏差和变异 [@problem_id:3314507]。

#### 混杂因素：系统性偏差的来源

除了随机噪声，[scRNA-seq](@entry_id:155798)数据还常受到系统性偏差的干扰，这些偏差被称为**混杂因素**（confounders），因为它们能导致基因之间产生与真实调控无关的虚假关联。

最常见的技术混杂因素是**[批次效应](@entry_id:265859)**（batch effects）。当细胞在不同的时间、由不同的操作人员、使用不同批次的试剂或在不同的测序仪上处理时，会导致系统性的、非生物学相关的表达差异。例如，一个批次的所有细胞可能整体上具有更高的捕获效率。如果两个无关联的基因恰好都在某个批次中被更高效地检测到，它们在整个数据集中就会呈现出虚假的正相关，从而可能被错误地推断为存在调控关系 [@problem_id:3314507] [@problem_id:3314527]。

生物学过程本身也可能成为混杂因素。**[细胞周期](@entry_id:140664)**（cell cycle）就是一个典型的例子。[细胞周期](@entry_id:140664)是一个驱动大量基因（如[组蛋白](@entry_id:164675)、[DNA聚合酶](@entry_id:147287)相关基因）协同、周期性表达的基础生物学过程。如果一个数据集中包含了处于不同[细胞周期阶段](@entry_id:170415)的细胞，那么许多与[细胞周期](@entry_id:140664)相关的基因之间会表现出强烈的相关性，而这种相关性并非源于它们之间的直接调控，而是源于它们共同受[细胞周期](@entry_id:140664)进程的调控。如果不加以校正，GRN推断算法可能会被这些强烈的共变信号淹没，产生大量与细胞周期相关的虚假调控边 [@problem_id:3314527]。

另一个需要考虑的因素是**环境RNA污染**（ambient RNA contamination）。在基于液滴的scRNA-seq实验中，细胞悬液中可能存在来自破裂细胞的游离mRNA。这些“环境RNA”会随机进入液滴，并与单个细胞的mRNA一起被测序，导致每个细胞的表达谱都混入了少量代表细胞群体平均表达的背景信号。这会使所有基因之间产生微弱的[虚假相关](@entry_id:755254)性，并可能掩盖真实的调控信号 [@problem_id:3314527]。

#### 计数数据的[统计建模](@entry_id:272466)

为了在GRN推断中妥善处理这些数据特性，我们需要选择合适的[统计模型](@entry_id:165873)。scRNA-seq产生的UMI计数是离散的非负整数，一个简单的**[泊松分布](@entry_id:147769)**（Poisson distribution）模型假设计数的均值等于[方差](@entry_id:200758)。然而，由于细胞间的生物学[异质性](@entry_id:275678)（例如，基因表达的爆发式转录），[scRNA-seq](@entry_id:155798)数据通常表现出**过分散**（overdispersion）现象，即[方差](@entry_id:200758)远大于均值。

**负二项分布**（Negative Binomial, NB）模型通过引入一个额外的散度参数，能够很好地对过分散现象进行建模。NB[分布](@entry_id:182848)可以被看作是泊松分布和伽马[分布](@entry_id:182848)的混合：假设每个细胞的基因表达率本身是一个遵循伽马[分布](@entry_id:182848)的[随机变量](@entry_id:195330)，那么在给定表达率下，我们观测到的计数值服从泊松分布，其最终的边缘[分布](@entry_id:182848)就是[负二项分布](@entry_id:262151)。对于一个基因 $g$ 和细胞 $i$，其计数 $Y_{ig}$ 可以建模为 $Y_{ig} \sim \mathrm{NB}(\mu_{ig}, \theta_g)$，其中均值为 $\mathbb{E}[Y_{ig}] = \mu_{ig}$，[方差](@entry_id:200758)为 $\mathrm{Var}(Y_{ig}) = \mu_{ig} + \mu_{ig}^2/\theta_g$。[方差](@entry_id:200758)中多出的一项 $\mu_{ig}^2/\theta_g$ 明确地捕捉了过分散 [@problem_id:3314531]。

早期，为了解释dropout事件导致的“过多零值”，研究人员提出了**零膨胀负二项**（Zero-Inflated Negative Binomial, ZINB）模型。[ZINB模型](@entry_id:756826)假设零值来自两个过程：一是NB[分布](@entry_id:182848)自身产生的“计数零”，二是一个额外的“结构性零”过程，以概率 $\pi_{ig}$ 产生。然而，越来越多的证据表明，对于经过良好处理的UMI数据，在模型中恰当地包含了细胞文库大小等协变量后，一个标准的负[二项模型](@entry_id:275034)通常已经足够。许多观测到的零值，实际上可以被具有较高散度的NB[分布](@entry_id:182848)自然地解释，而无需引入额外的零膨胀组件 [@problem_id:3314531]。

### 因果推断的挑战：关联不等于因果

GRN推断的最终目标是发现基因间的**因果**调控关系，而不仅仅是统计上的关联。这是一个巨大的挑战，因为我们处理的大多是**观测数据**（observational data），而非**干预数据**（interventional data）。

#### 结构因果模型框架

为了严谨地讨论因果关系，我们可以借助**结构因果模型**（Structural Causal Model, SCM）的语言。在一个SCM中，基因表达系统被一个有向无环图（DAG）所描述，每个节点的变量 $X_i$（基因 $i$ 的表达）由一个结构性方程 $X_i := f_i(X_{\mathrm{Pa}(i)}, U_i)$ 决定，其中 $\mathrm{Pa}(i)$ 是 $i$ 的直接原因（即父节点），$U_i$ 是独立的外源噪声。一条因果边 $j \to i$ 存在，当且仅当 $X_j$ 是函数 $f_i$ 的一个有效参数，即改变 $X_j$ 的值会引起 $X_i$ 的变化 [@problem_id:3314512]。

因果效应是通过**do-算子**（do-operator）定义的。一个对 $X_j$ 的干预，记为 $\mathrm{do}(X_j=x)$，意味着在SCM中强制将 $X_j$ 的值设为 $x$，并切断所有指向 $X_j$ 的原有因果边。推断 $j \to i$ 的因果效应，就是要回答这样一个问题：“如果我们主动干预 $j$ 的表达水平， $i$ 的表达水平会如何变化？”

#### 关联的来源与混杂

在观测数据中，两个基因 $X_i$ 和 $X_j$ 之间的相关性（或协[方差](@entry_id:200758)）可能源于多种途径：
1.  **直接因果路径**：$i \to j$ 或 $j \to i$。
2.  **间接因果路径**：例如 $j \to k \to i$。
3.  **[共同原因](@entry_id:266381)（混杂）**：存在一个或多个我们可能未观测到的**[潜变量](@entry_id:143771)**（latent variable）$L$，它同时影响 $X_i$ 和 $X_j$（即 $j \leftarrow L \to i$）。前文提到的细胞周期和批次效应就是典型的混杂因素。

例如，在一个简化的线性模型中，假设 $X_i = \beta_{ji} X_j + \gamma_i L + U_i$ 且 $X_j = \gamma_j L + U_j$，其中 $L, U_i, U_j$ [相互独立](@entry_id:273670)。那么 $X_i$ 和 $X_j$ 之间的协[方差](@entry_id:200758)为 $\mathrm{Cov}(X_i,X_j) = \beta_{ji}\mathrm{Var}(X_j) + \gamma_i\gamma_j\mathrm{Var}(L)$。这个式子清晰地表明，观测到的协[方差](@entry_id:200758)由两部分构成：一部分来自直接因果效应（与 $\beta_{ji}$ 成正比），另一部分来自潜变量混杂（与 $\gamma_i\gamma_j$ 成正比）。即使 $\beta_{ji}=0$（不存在直接因果边），只要 $\gamma_i\gamma_j \neq 0$，我们依然会观察到非零的相关性 [@problem_id:3314512]。

此外，[测量误差](@entry_id:270998) $\eta$ 也会影响观测到的关联。如果测量误差 $\eta_i$ 和 $\eta_j$ 是独立的，它们会增加每个基因的[方差](@entry_id:200758)，从而**衰减**（attenuate）它们之间的相关性。然而，如果测量误差是相关的（例如，由于全局文库大小归一化可能引入的系统性偏差），$\mathrm{Cov}(\eta_i, \eta_j) \neq 0$，这甚至可能在没有真实生物学关联的情况下**引入**虚假的协[方差](@entry_id:200758) [@problem_id:3314512]。

#### [马尔可夫等价](@entry_id:751683)类

即使我们能够完美地从数据中识别出所有的条件独立关系，因果推断仍然面临一个根本性的限制。多个不同的DAG结构可能蕴含完全相同的条件独立关系集合。这些在观测上无法区分的DAG构成了一个**[马尔可夫等价](@entry_id:751683)类**（Markov equivalence class）。例如，三个模型 $X \to Y \to Z$，$X \leftarrow Y \leftarrow Z$ 和 $X \leftarrow Y \to Z$ 都蕴含了条件独立关系 $X \perp Z \mid Y$，因此仅凭观测数据无法区分它们。这意味着，从观测数据出发，我们最多只能将GRN的结构鉴定到一个等价类，而无法确定其中每一条边的确切方向 [@problem_id:3314562]。

### 基于观测数据的推断策略

尽管存在上述挑战，研究人员已经发展出多种从观测[scRNA-seq](@entry_id:155798)数据中推断GRN的计算策略。这些方法在它们所做的假设和所能捕捉的相互作用类型上各不相同。

#### 基于关联的度量

最直接的方法是计算基因对之间的[统计关联](@entry_id:172897)强度。
*   **[皮尔逊相关系数](@entry_id:270276)**（Pearson correlation）衡量变量间的**线性**关联强度。它的优点是计算简单，但无法区分直接和间接关联，也无法捕捉非线性关系。
*   **偏相关系数**（partial correlation）衡量在控制了一个或多个其他变量后，两个变量之间的线性关联。在理想的多元高斯模型下，两个基因在给定所有其他基因后的[偏相关](@entry_id:144470)为零，等价于其在**[精度矩阵](@entry_id:264481)**（precision matrix，即[协方差矩阵](@entry_id:139155)的逆）中的对应项为零。这为从数据中识别直接关联提供了一条途径。然而，该方法依赖于高斯分布和线性关系的强假设，并且对未被控制的[潜变量](@entry_id:143771)非常敏感 [@problem_id:3314548]。
*   **互信息**（Mutual Information, MI）是一种基于信息论的度量，可以捕捉变量间任意类型（包括[非线性](@entry_id:637147)）的统计依赖关系。其定义为 $I(X;Y) = D_{\mathrm{KL}}(p_{XY} \,\|\, p_X p_Y)$，即联合分布与[边际分布](@entry_id:264862)乘积之间的KL散度。MI的一个重要特性是它在变量的可逆重[参数化](@entry_id:272587)下保持不变（例如，[对数变换](@entry_id:267035)）。但MI的缺点是其估计需要对概率密度函数进行估计，这在样本量有限时非常困难（[维度灾难](@entry_id:143920)），且结果对[分箱](@entry_id:264748)或k-近邻等参数的选择很敏感 [@problem_id:3314548]。

在实践中，为了减轻混杂因素的影响，一种常用策略是在计算这些关联度量之前，先对数据进行**残差化**（residualization）。具体而言，将每个基因的表达向量对已知的混杂[协变](@entry_id:634097)量（如批次、细胞周期得分）进行线性回归，然后取其残差。在这些“净化”后的残差上计算相关性，可以在一定程度上模拟出对这些协变量进行条件控制的效果 [@problem_id:3314527]。

#### 基于回归的方法

另一大类方法将GRN推断问题构建为一系列的回归任务。对于每一个潜在的靶基因，我们试图用所有候选TFs的表达水平来预测它的表达水平。
$$ \text{expression}(g_{\text{target}}) \approx \sum_{j \in \text{TFs}} \beta_j \cdot \text{expression}(\text{TF}_j) $$
非零的[回归系数](@entry_id:634860) $\beta_j$ 被解释为TF $j$ 对靶基因存在调控作用的证据。

在单细胞数据中，候选TFs的数量 $p$ 往往与细胞数 $n$ 相当甚至更多（即 $p \ge n$），这使得标准的[线性回归](@entry_id:142318)容易[过拟合](@entry_id:139093)。因此，必须引入正则化。**稀疏性**（sparsity）假设在这里至关重要，它基于两个理由：1）**生物学[简约性](@entry_id:141352)**：一个基因通常只被少数几个关键TFs直接调控；2）**统计学必要性**：在高维设定下，我们需要通过[变量选择](@entry_id:177971)来构建一个稳定且可解释的模型。

**[LASSO](@entry_id:751223)**（Least Absolute Shrinkage and Selection Operator）是一种广泛应用的正则化回归方法。它在最小化[残差平方和](@entry_id:174395)的同时，对[回归系数](@entry_id:634860)的 $L_1$ 范数进行惩罚。其优化目标为：
$$ \min_{\beta_0, \boldsymbol{\beta}} \frac{1}{2n}\|\boldsymbol{y}-\beta_{0}\boldsymbol{1}-\boldsymbol{X}\boldsymbol{\beta}\|_{2}^{2}+\lambda\|\boldsymbol{\beta}\|_{1} $$
$L_1$ 惩罚项的一个关键特性是它能将许多不重要的系数精确地压缩到零，从而同时实现[变量选择](@entry_id:177971)和参数收缩 [@problem_id:3314552]。

**[弹性网络](@entry_id:143357)**（Elastic Net）是[LASSO](@entry_id:751223)的扩展，它结合了 $L_1$ 和 $L_2$ 两种惩罚项：
$$ \min_{\beta_0, \boldsymbol{\beta}} \frac{1}{2n}\|\boldsymbol{y}-\beta_{0}\boldsymbol{1}-\boldsymbol{X}\boldsymbol{\beta}\|_{2}^{2}+\lambda\left(\alpha\|\boldsymbol{\beta}\|_{1}+\frac{1-\alpha}{2}\|\boldsymbol{\beta}\|_{2}^{2}\right) $$
当TFs之间存在高度相关性时（例如，来自同一家族的TFs），LASSO倾向于随机选择其中一个，而[弹性网络](@entry_id:143357)的 $L_2$ 部分则有助于将这些相关的TFs作为一个整体选入或移出模型，通常能得到更稳健的结果 [@problem_id:3314552]。

#### 基于树的[集成方法](@entry_id:635588)

除了[线性模型](@entry_id:178302)，非参数的机器学习方法也备受青睐。**GENIE3**（GEne Network Inference with Ensemble of trees）是其中的一个杰出代表。与回归方法类似，GENIE3也将[网络推断](@entry_id:262164)分解为多个独立的回归问题，即为每个[基因预测](@entry_id:164929)其表达。但它使用的模型是**[随机森林](@entry_id:146665)**（Random Forest）或类似的树集成模型。

对于每个靶基因 $g$，GENIE3训练一个[随机森林](@entry_id:146665)模型，以所有TFs的表达为输入特征，以 $g$ 的表达为输出。然后，通过计算每个TF在预测 $g$ 的表达时的**[特征重要性](@entry_id:171930)**（feature importance）来量化其调控强度。这个重要性通常通过一个特征在森林中所有[决策树](@entry_id:265930)上带来的总不纯度减少量（例如，[方差](@entry_id:200758)减少量）来衡量。这个重要性得分被用作从该TF指向 $g$ 的有向边的权重。通过为每个[基因重复](@entry_id:150636)此过程，GENIE3最终构建出一个完整的、加权的、有向的[调控网络](@entry_id:754215) [@problem_id:3314567]。这种方法的优势在于它能自然地捕捉[非线性](@entry_id:637147)和相互作用效应，且对输入特征的尺度不敏感。

#### 概率图模型

概率图模型（Probabilistic Graphical Models, PGM）为GRN的表示和推断提供了严谨的概率框架。
*   **[贝叶斯网络](@entry_id:261372)**（Bayesian Networks, BNs）使用一个[有向无环图](@entry_id:164045)（DAG）来表示变量间的依赖关系。其核心是**局部[马尔可夫性质](@entry_id:139474)**，即每个节点在给定其父节点的情况下，条件独立于其所有非后代节点。这使得[联合概率分布](@entry_id:171550)可以分解为一系列局部[条件概率](@entry_id:151013)的乘积：$P(\mathbf{X}) = \prod_i P(X_i|\mathrm{Pa}(i))$。BNs的DAG结构天然地契合了GRN中调控的**有[向性](@entry_id:144651)**概念 [@problem_id:3314562]。
*   **[马尔可夫随机场](@entry_id:751685)**（Markov Random Fields, MRFs）则使用一个[无向图](@entry_id:270905)来表示**对称**的依赖关系。其核心是基于**团**（cliques）的因子分解。MRFs无法像BNs那样直接表示因果方向，但它们在建模协同调控等对称关系时非常有用。[高斯图模型](@entry_id:269263)（Gaussian Graphical Models, GGM）是MRF的一个特例，其中边的缺失直接对应于[精度矩阵](@entry_id:264481)中的零元素 [@problem_id:3314562]。

### 利用动力学与干预数据

鉴于从静态观测数据中推断因果关系的根本局限性，研究人员转向更复杂的数据类型，以期获得更深入的洞见。

#### 利用伪时间推断动力学

单细胞数据的一个独特优势是它能捕捉到连续的生物学过程，如[细胞分化](@entry_id:273644)。通过**[轨迹推断](@entry_id:176370)**（trajectory inference），我们可以将细胞沿着一条假定的发育路径进行排序，这个排序被称为**伪时间**（pseudotime）。伪时间 $s$ 是一个基于数据几何结构（例如，在[流形](@entry_id:153038)上的[测地线](@entry_id:269969)距离）推断出的标量值，它反映了细胞的发育“进度”，而非真实的物理**时序时间**（chronological time）$t$ [@problem_id:3314571]。

[伪时间](@entry_id:262363)与真实时间的关系是复杂且未知的。细胞的分化速度可能不均，导致 $dt/ds$ 这一“速度”因子是变化的。如果我们尝试将一个基于真实时间的动力学模型（如ODE $dx/dt = f(x,\theta)$）应用于[伪时间](@entry_id:262363)排序的数据，根据链式法则，我们得到 $dx/ds = (dt/ds) f(x,\theta)$。由于 $dt/ds$ 未知，它会与模型中的动力学参数 $\theta$ （如[反应速率常数](@entry_id:187887)）相混淆，导致这些参数的[绝对值](@entry_id:147688)变得**不可辨识**（unidentifiable）。要解决这个问题，需要额外的外部校准信息，例如通过RNA速度（[RNA velocity](@entry_id:152699)）分析来估计 $dx/dt$ 的方向，或者通过系谱追踪实验来锚定真实时间点 [@problem_id:3314571]。

#### 利用扰动数据进行因果推断

获取GRN因果关系的“黄金标准”是进行**干[预实验](@entry_id:172791)**。近年来，基于CRISPR的扰动技术与[单细胞测序](@entry_id:198847)相结合，催生了**[Perturb-seq](@entry_id:172948)**等强大的方法。这类实验使用一个包含针对不同TFs的导向RNA（gRNAs）的混合文库，对大量细胞进行平行扰动（例如，通过CRISPRi抑制或[CRISPRa](@entry_id:272273)激活特定TF）。然后，通过scRNA-seq读出每个细胞的转录组及其所含的gRNA条形码 [@problem_id:3314578]。

[Perturb-seq](@entry_id:172948)的关键优势在于，通过**随机**分配gRNA，实验主动地对系统进行了干预，从而获得了关于因果效应 $P(\mathbf{X} | \mathrm{do}(G_j))$ 的信息，而不仅仅是观测相关性。[随机化](@entry_id:198186)设计确保了扰动本身与细胞的初始状态（包括所有潜在的混杂因素）在统计上是独立的，这使得通过[回归分析](@entry_id:165476)估计因果效应成为可能 [@problem_id:3314578]。

此外，通过控制测序的时间点，[Perturb-seq](@entry_id:172948)还能帮助区分直接和间接效应。生物信号的传播（转录、翻译、信号级联）需要有限的时间。因此，如果在施加扰动后很短的时间内（**早期快照**）进行测序，观测到的转录变化最可能反映被扰动TF的**直接**靶基因的响应。而如果在一个较晚的时间点进行测序，系统将有足够的时间产生**[反馈回路](@entry_id:273536)**（feedback loops）和级联效应，此时观测到的是直接和间接效应的总和 [@problem_id:3314578]。

### 评估[网络推断](@entry_id:262164)的性能

最后，如何客观地评估一个GRN推断算法的性能也至关重要。这通常通过将算法预测的调控边排序列表与一个“金标准”（gold standard）网络（通常来自文献整理的实验证据或[ChIP-seq](@entry_id:142198)等其他数据类型）进行比较来完成。

由于真实的GRN是高度**稀疏**的——即存在的调控边（正例）数量远少于不存在的边（负例）——这是一个典型的**[类别不平衡](@entry_id:636658)**（class imbalance）问题。在这种情况下，两种常用的评估指标表现出不同的性能：

*   **[受试者工作特征曲线下面积](@entry_id:636693)**（Area Under the Receiver Operating Characteristic, [AUROC](@entry_id:636693)）：[ROC曲线](@entry_id:182055)绘制的是[真阳性率](@entry_id:637442)（TPR, True Positive Rate）与[假阳性率](@entry_id:636147)（FPR, False Positive Rate）的关系。[AUROC](@entry_id:636693)对[类别不平衡](@entry_id:636658)不敏感，其随机基线始终为 $0.5$。然而，在GRN推断中，由于负例数量极其庞大，即使算法预测出大量的[假阳性](@entry_id:197064)边，FPR也可能保持在一个很低的水平，从而导致一个虚高的、过于乐观的[AUROC](@entry_id:636693)分数 [@problem_id:3314522]。

*   **[精确率-召回率曲线](@entry_id:637864)下面积**（Area Under the Precision-Recall, AUPR）：P[R曲线](@entry_id:183670)绘制的是[精确率](@entry_id:190064)（Precision）与召回率（Recall, 即TPR）的关系。[精确率](@entry_id:190064)的定义是 $TP/(TP+FP)$，它直接受到[假阳性](@entry_id:197064)数量的惩罚。在[类别不平衡](@entry_id:636658)的设定下，AUPR对假阳性的增加非常敏感。其随机基线约等于正例在总样本中的比例（即 $P/M$），对于稀疏网络而言，这是一个非常低的值。因此，一个算法必须显著优于这个低基线才能被认为是有价值的。综上所述，**AUPR**通常被认为是评估稀疏GRN推断性能的更具[信息量](@entry_id:272315)和更严格的指标 [@problem_id:3314522]。