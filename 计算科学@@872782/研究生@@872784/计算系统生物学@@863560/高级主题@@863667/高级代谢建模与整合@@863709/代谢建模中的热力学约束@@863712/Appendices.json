{"hands_on_practices": [{"introduction": "在分析整个代谢网络之前，掌握单个生化反应的热力学是至关重要的一步。本练习将引导你应用吉布斯自由能的核心方程，通过实际的细胞内代谢物浓度来计算一个关键糖酵解反应在非平衡条件下的反应吉布斯自由能（$\\Delta_r G$），并判断其反应方向。这个基础计算是热力学约束代谢建模的基石。[@problem_id:3355483]", "problem": "糖酵解的一个中心步骤通过反应 3-磷酸甘油醛 (G3P) $+$ 无机磷酸 (Pi) $+$ 氧化型烟酰胺腺嘌呤二核苷酸 (NAD$^{+}$) $\\rightarrow$ 1,3-二磷酸甘油酸 (1,3-BPG) $+$ 还原型烟酰胺腺嘌呤二核苷酸 (NADH)，将一个氧化反应与一个高能酰基磷酸的形成耦合起来。考虑在细胞质中，温度为 $T = 310 \\ \\mathrm{K}$，pH 缓冲在 $7$，水活度近似为单位值，因此适用变换标准态。假设活度可由归一化到 $1 \\ \\mathrm{M}$ 标准态的浓度很好地近似（活度系数接近 $1$），并取这些条件下的变换标准平衡常数为 $K^{\\circ \\prime} = 0.10$（无量纲）。\n\n代谢物浓度为：\n- $[ \\mathrm{G3P} ] = 5.0 \\times 10^{-4} \\ \\mathrm{M}$，\n- $[ \\mathrm{Pi} ] = 2.0 \\times 10^{-2} \\ \\mathrm{M}$，\n- $[ \\mathrm{NAD}^{+} ] = 1.0 \\times 10^{-3} \\ \\mathrm{M}$，\n- $[ \\mathrm{1,3\\text{-}BPG} ] = 1.0 \\times 10^{-6} \\ \\mathrm{M}$，\n- $[ \\mathrm{NADH} ] = 1.0 \\times 10^{-5} \\ \\mathrm{M}$。\n\n使用将反应的 Gibbs 能量与化学势、平衡常数和活度联系起来的基本热力学关系，计算在这些非平衡条件下的反应 Gibbs 能量 $\\Delta_{r} G$。使用理想气体常数 $R = 8.314462618 \\ \\mathrm{J \\ mol^{-1} \\ K^{-1}}$。然后，根据基于热力学的通量分析 (TFA) 约束条件——非零正向通量要求 $\\Delta_{r} G  0$——判断正向代谢通量在热力学上是否是允许的。\n\n将 $\\Delta_{r} G$ 以 $\\mathrm{kJ \\ mol^{-1}}$ 为单位表示，并将您的数值答案四舍五入到四位有效数字。", "solution": "该问题已根据所需标准进行验证。\n\n### 第 1 步：提取已知条件\n- **反应**：3-磷酸甘油醛 (G3P) $+$ 无机磷酸 (Pi) $+$ 氧化型烟酰胺腺嘌呤二核苷酸 (NAD$^{+}$) $\\rightarrow$ 1,3-二磷酸甘油酸 (1,3-BPG) $+$ 还原型烟酰胺腺嘌呤二核苷酸 (NADH)\n- **温度**：$T = 310 \\ \\mathrm{K}$\n- **pH**：$7$\n- **水活度**：近似为单位值\n- **状态**：适用变换标准态\n- **近似**：活度由归一化到 $1 \\ \\mathrm{M}$ 标准态的浓度近似。\n- **变换标准平衡常数**：$K^{\\circ \\prime} = 0.10$（无量纲）\n- **浓度**：\n  - $[\\mathrm{G3P}] = 5.0 \\times 10^{-4} \\ \\mathrm{M}$\n  - $[\\mathrm{Pi}] = 2.0 \\times 10^{-2} \\ \\mathrm{M}$\n  - $[\\mathrm{NAD}^{+}] = 1.0 \\times 10^{-3} \\ \\mathrm{M}$\n  - $[\\text{1,3-BPG}] = 1.0 \\times 10^{-6} \\ \\mathrm{M}$\n  - $[\\mathrm{NADH}] = 1.0 \\times 10^{-5} \\ \\mathrm{M}$\n- **理想气体常数**：$R = 8.314462618 \\ \\mathrm{J \\ mol^{-1} \\ K^{-1}}$\n- **约束条件**：非零正向通量要求 $\\Delta_{r} G  0$。\n- **要求输出**：以 $\\mathrm{kJ \\ mol^{-1}}$ 为单位的反应 Gibbs 能量 $\\Delta_{r} G$，四舍五入到四位有效数字，并判断正向通量在热力学上是否允许。\n\n### 第 2 步：使用提取的已知条件进行验证\n该问题具有科学依据，提法明确且客观。它提供了一套完整且一致的数据来解决生物化学热力学中的一个标准问题。该反应是糖酵解中一个众所周知的步骤，所提供的浓度在生理上是合理的，温度是人体的典型温度。问题要求计算非平衡条件下的反应 Gibbs 能量，这是一个基本概念。所有必需的常数和条件都已提供，没有矛盾、歧义或违反科学原理的地方。\n\n### 第 3 步：结论与行动\n该问题有效。将提供一个完整的、有理有据的解答。\n\n化学反应可以写成：\n$$\n\\mathrm{G3P} + \\mathrm{Pi} + \\mathrm{NAD}^{+} \\rightleftharpoons \\mathrm{1,3\\text{-}BPG} + \\mathrm{NADH}\n$$\n在非平衡条件下，反应的 Gibbs 能量 $\\Delta_{r} G$ 与变换标准反应 Gibbs 能量 $\\Delta_{r} G^{\\circ \\prime}$ 和反应商 $Q^{\\prime}$ 通过以下基本热力学关系相关联：\n$$\n\\Delta_{r} G = \\Delta_{r} G^{\\circ \\prime} + RT \\ln Q^{\\prime}\n$$\n变换标准 Gibbs 能量 $\\Delta_{r} G^{\\circ \\prime}$ 可以使用给定的变换标准平衡常数 $K^{\\circ \\prime}$ 通过以下方程计算：\n$$\n\\Delta_{r} G^{\\circ \\prime} = -RT \\ln K^{\\circ \\prime}\n$$\n将第二个方程代入第一个方程，得到 $\\Delta_r G$、$Q^{\\prime}$ 和 $K^{\\circ \\prime}$ 之间的直接关系：\n$$\n\\Delta_{r} G = -RT \\ln K^{\\circ \\prime} + RT \\ln Q^{\\prime} = RT \\ln \\left( \\frac{Q^{\\prime}}{K^{\\circ \\prime}} \\right)\n$$\n反应商 $Q^{\\prime}$ 是根据给定的反应物和产物的非平衡浓度计算的。问题指明活度可以用摩尔浓度来近似。对于给定的反应，$Q^{\\prime}$ 是：\n$$\nQ^{\\prime} = \\frac{[\\mathrm{1,3\\text{-}BPG}] [\\mathrm{NADH}]}{[\\mathrm{G3P}] [\\mathrm{Pi}] [\\mathrm{NAD}^{+}]}\n$$\n代入给定的浓度值：\n$$\nQ^{\\prime} = \\frac{(1.0 \\times 10^{-6}) (1.0 \\times 10^{-5})}{(5.0 \\times 10^{-4}) (2.0 \\times 10^{-2}) (1.0 \\times 10^{-3})}\n$$\n$$\nQ^{\\prime} = \\frac{1.0 \\times 10^{-11}}{1.0 \\times 10^{-8}} = 1.0 \\times 10^{-3}\n$$\n反应商 $Q^{\\prime}$ 是无量纲的，因为它形式上是活度的比率，而活度本身也是无量纲的（浓度被归一化到 $1 \\ \\mathrm{M}$ 标准态）。\n\n现在，我们可以使用推导出的表达式计算 $\\Delta_{r} G$。给定的值为 $R = 8.314462618 \\ \\mathrm{J \\ mol^{-1} \\ K^{-1}}$，$T = 310 \\ \\mathrm{K}$，$K^{\\circ \\prime} = 0.10$，并且我们计算出 $Q^{\\prime} = 1.0 \\times 10^{-3}$。\n$$\n\\Delta_{r} G = (8.314462618 \\ \\mathrm{J \\ mol^{-1} \\ K^{-1}}) (310 \\ \\mathrm{K}) \\ln \\left( \\frac{1.0 \\times 10^{-3}}{0.10} \\right)\n$$\n$$\n\\Delta_{r} G = (2577.48341... \\ \\mathrm{J \\ mol^{-1}}) \\ln(1.0 \\times 10^{-2})\n$$\n自然对数 $\\ln(1.0 \\times 10^{-2})$ 约等于 $-4.605170186...$。\n$$\n\\Delta_{r} G \\approx (2577.48341... \\ \\mathrm{J \\ mol^{-1}}) \\times (-4.605170186...)\n$$\n$$\n\\Delta_{r} G \\approx -11869.608 \\ \\mathrm{J \\ mol^{-1}}\n$$\n问题要求答案以 $\\mathrm{kJ \\ mol^{-1}}$ 为单位。为了转换，我们除以 $1000$：\n$$\n\\Delta_{r} G \\approx -11.869608 \\ \\mathrm{kJ \\ mol^{-1}}\n$$\n将此值四舍五入到四位有效数字，得到：\n$$\n\\Delta_{r} G \\approx -11.87 \\ \\mathrm{kJ \\ mol^{-1}}\n$$\n问题的第二部分要求判断正向代谢通量在热力学上是否是允许的。给出的标准是，非零正向通量要求 $\\Delta_{r} G  0$。\n由于我们计算出的值为 $\\Delta_{r} G = -11.87 \\ \\mathrm{kJ \\ mol^{-1}}$，该值小于 $0$，因此在这些细胞条件下，正向反应是热力学自发的，并且正向通量是允许的。", "answer": "$$\\boxed{-11.87}$$", "id": "3355483"}, {"introduction": "理论计算与实验观测之间的差异是科学发现的催化剂。本练习提出了一个情景：测得的离子跨膜通量方向似乎与基于浓度计算的吉布斯自由能变化相悖。你的任务是像一名研究者一样进行批判性思考，从多个物理和生物学角度提出可能的假设来解决这个表观悖论，这对于准确地为生物系统建模至关重要。[@problem_id:3355505]", "problem": "细菌内膜中的一个单组分生电转运蛋白将单价阳离子 $X^+$ 从细胞外空间转运到细胞质。一名研究人员测量到净向内通量 $v_r$（正向方向为 $X_{\\text{out}}^+ \\to X_{\\text{in}}^+$），且 $v_r  0$。在膜附近的采样口测得的整体浓度报告为 $c_{\\text{out}} = 1\\,\\mathrm{mM}$ 和 $c_{\\text{in}} = 10\\,\\mathrm{mM}$，温度为 $T = 298\\,\\mathrm{K}$。仅使用整体浓度和忽略任何电功的标准生物化学惯例，该研究人员计算出正向转运的反应吉布斯自由能变为正值，即 $\\Delta G_r  0$，这似乎与测得的正向通量 $v_r$ 相矛盾。\n\n根据第一性原理，热力学第二定律要求，在稳态下，当所有耦合的功项都被恰当考虑在内时，一个自发进行的净过程必须伴随着相应自由能的减少。对于带电物质的转运，电化学势包括一个化学项（与活度差异相关）和一个电学项（与跨膜电位相关）。在代謝建模中，通常通过符号约束（如 $v_r \\,\\Delta G_r \\le 0$）来强制实现热力学一致性，其中 $\\Delta G_r$ 被恰当地定义为汇总了所有耦合贡献的量。\n\n以下哪项假说可以在不违反热力学第二定律的情况下，将观测到的正向通量 $v_r  0$ 与热力学要求相调和？（选择所有适用项）\n\nA. 由于微区效应（例如，未搅拌层或大分子拥挤），整体浓度与转运蛋白处的局部活度不同，因此基于局部 $c_i$ 的反应商不同于测量的整体浓度比；在考虑微区 $c_i$ 的情况下，对 $\\Delta G_r$ 的化学贡献可能为负。\n\nB. 该转运蛋白是生电的，跨膜电位差贡献了一个在计算中被忽略的项 $zF\\Delta\\psi$；即使化学项本身为正，包含 $zF\\Delta\\psi$ 也可以使总的 $\\Delta G_r$ 为负。\n\nC. 该转运蛋白作为一种酶，可以通过纯粹降低活化自由能来驱动反应正向进行，因此 $\\Delta G_r  0$ 并不排除稳定的正向通量。\n\nD. 测量的通量方向 $v_r$ 或浓度测量值是错误的或被错误地指定（例如，符号约定错误），因此一旦数据被校正，就不存在真正的矛盾。\n\nE. 表观上的单向转运实际上是一个复合过程的一部分，该过程与三磷酸腺苷（ATP）水解或另一个放能反应相耦合，但建模忽略了这种耦合；包含该耦合会使复合过程的净 $\\Delta G_r$ 为负。\n\nF. 对绝对温度进行微小修正（例如，从 $298\\,\\mathrm{K}$ 改为 $301\\,\\mathrm{K}$）就足以在不引入电学项或耦合项的情况下逆转 $\\Delta G_r$ 的符号。\n\n注：$z$ 是离子电荷数，$F$ 是法拉第常数，$\\Delta\\psi = \\psi_{\\text{in}} - \\psi_{\\text{out}}$ 是跨膜电位差。除非另有说明，否则假设为标准生物化学参考态。", "solution": "这个问题提出了一个与热力学第二定律的表觀矛盾。观察到单价阳离子 $X^+$ 的净通量方向为 $X_{\\text{out}}^+ \\to X_{\\text{in}}^+$，这意味着这是一个自发过程。对于恒温恒压下的自发过程，相关吉布斯自由能的变化 $\\Delta G_r$ 必须为非正值。问题陈述，研究人員仅基于整体浓度计算出吉布斯自由能变为正值，即 $\\Delta G_r  0$。这导致了条件 $v_r \\Delta G_r  0$，其中 $v_r  0$ 是测得的正向通量，这似乎违反了热力学约束 $v_r \\Delta G_r \\le 0$。\n\n基本原理是，对于一个完整、耦合的过程，其总吉布斯自由能变化 $\\Delta \\tilde{G}_{r, \\text{total}}$ 必须为负，才能观察到净正向通量。研究人員的计算是不完整的。将一摩尔带电物质跨膜转运的自由能变化的完整表达式是电化学势的变化：\n$$ \\Delta \\tilde{G}_r = \\mu_{\\text{in}} - \\mu_{\\text{out}} $$\n其中 $\\mu$ 是电化学势。这可以分解为一个化学组分和一个电学组分：\n$$ \\Delta \\tilde{G}_r = \\left( \\mu_{\\text{in}}^\\circ + RT \\ln a_{\\text{in}} \\right) - \\left( \\mu_{\\text{out}}^\\circ + RT \\ln a_{\\text{out}} \\right) + zF\\Delta\\psi $$\n对于一个转运过程，标准化学势相等（$\\mu_{\\text{in}}^\\circ = \\mu_{\\text{out}}^\\circ$），因此上式简化为：\n$$ \\Delta \\tilde{G}_r = RT \\ln\\left(\\frac{a_{\\text{in}}}{a_{\\text{out}}}\\right) + zF\\Delta\\psi $$\n其中 $R$ 是气体常数，$T$ 是绝对温度，$a_i$ 是化学活度，$z$ 是离子的电荷数，$F$ 是法拉第常数，以及 $\\Delta\\psi = \\psi_{\\text{in}} - \\psi_{\\text{out}}$ 是跨膜电位。\n\n研究人員的计算只考虑了化学项，并做了一个常见的简化，即用整体浓度近似活度（$a_i \\approx c_i$）：\n$$ \\Delta G_r (\\text{investigator}) = RT \\ln\\left(\\frac{c_{\\text{in}}}{c_{\\text{out}}}\\right) $$\n使用给定值，$c_{\\text{in}} = 10\\,\\mathrm{mM}$，$c_{\\text{out}} = 1\\,\\mathrm{mM}$，以及 $T=298\\,\\mathrm{K}$：\n$$ \\Delta G_r (\\text{investigator}) = R(298\\,\\mathrm{K}) \\ln\\left(\\frac{10}{1}\\right) = R(298\\,\\mathrm{K}) \\ln(10)  0 $$\n计算得出了一个正值，因为离子正从低浓度区域移动到高浓度区域。如果真实的总自由能变化 $\\Delta \\tilde{G}_{r,\\text{total}}$ 实际上为负，那么这个悖论就可以得到解决。这可能在以下情况下发生：\n1. 化学项 $RT \\ln(a_{\\text{in}}/a_{\\text{out}})$ 实际上为负，与基于整体浓度的计算相反。\n2. 一个额外的负项，如电功项 $zF\\Delta\\psi$ 或来自耦合放能反应的自由能，被忽略了，并且其大小足以使总的 $\\Delta \\tilde{G}_r$ 为负。\n3. 初始数据（浓度、通量方向）是错误的。\n\n我们现在根据这些原则来评估每个假说。\n\n**A. 由于微区效应（例如，未搅拌层或大分子拥挤），整体浓度与转运蛋白处的局部活度不同，因此基于局部 $c_i$ 的反应商不同于测量的整体浓度比；在考虑微区 $c_i$ 的情况下，对 $\\Delta G_r$ 的化学贡献可能为负。**\n该假说对 $a_i \\approx c_{i, \\text{bulk}}$ 的近似提出了挑战。热力学上相关的量是转运蛋白活性位点处的局部活度。由于多种因素，这些活度可能与整体浓度不同。例如，细胞质中的大分子拥擠可以显著改变活度系数 $\\gamma_{\\text{in}}$，使得 $a_{\\text{in}} = \\gamma_{\\text{in}} c_{\\text{in}}$。类似地，外部的未搅拌层可能会改变局部浓度 $c'_{\\text{out}}$。真实的化学势变为 $\\Delta G_{chem} = RT \\ln(a_{\\text{in}}/a_{\\text{out}})$。要使此项为负，活度比 $a_{\\text{in}}/a_{\\text{out}}$ 必须小于 1。鉴于整体浓度比为 10，这将要求活度系数或局部浓度与整体值有很大差异，使得 $(\\gamma_{\\text{in}} c'_{\\text{in}}) / (\\gamma_{\\text{out}} c'_{\\text{out}})  1$。尽管这可能是很大的效应，但已知这种现象在细胞环境中会发生。因此，这是一个物理上合理的假说。\n结论：**正确**。\n\n**B. 该转运蛋白是生电的，跨膜电位差贡献了一个在计算中被忽略的项 $zF\\Delta\\psi$；即使化学项本身为正，包含 $zF\\Delta\\psi$ 也可以使总的 $\\Delta G_r$ 为负。**\n该假说指出了研究人員计算中遗漏了电功项。问题明确指出该转运蛋白是生电的，意味着存在净电荷移动。对于阳离子 $X^+$，电荷数 $z=+1$。总自由能变为 $\\Delta \\tilde{G}_r = RT \\ln(c_{\\text{in}}/c_{\\text{out}}) + F\\Delta\\psi$。我们知道第一项是正的。要使 $\\Delta \\tilde{G}_r$ 为负，电学项 $F\\Delta\\psi$ 必须为负，且其绝对值必须大于化学项。由于 $F  0$，这要求 $\\Delta\\psi = \\psi_{\\text{in}} - \\psi_{\\text{out}}  0$。负的膜电位（内负外正）是包括细菌在内的活细胞的一个普遍特征，其值通常在 $-100\\,\\mathrm{mV}$ 到 $-200\\,\\mathrm{mV}$ 的数量级。化学项大约为 $+5.7\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$。仅 $\\Delta\\psi = -60\\,\\mathrm{mV}$ 的电位就会贡献一个电能项 $zF\\Delta\\psi = (1)(96485\\,\\mathrm{C}\\,\\mathrm{mol}^{-1})(-0.060\\,\\mathrm{V}) \\approx -5.8\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$，这足以使总的 $\\Delta \\tilde{G}_r$ 为负。这是生物能量学中一个非常常见且在定量上显著的机制。\n结论：**正确**。\n\n**C. 该转运蛋白作为一种酶，可以通过纯粹降低活化自由能来驱动反应正向进行，因此 $\\Delta G_r  0$ 并不排除稳定的正向通量。**\n这种说法根本上是错误的。酶和其他催化剂（包括转运蛋白）的功能是降低反应的活化能（$\\Delta G^\\ddagger$），从而提高反应速率。然而，它们不会也不能改变反应的总吉布斯自由能变化（$\\Delta G_r$）。仅凭 $\\Delta G_r$ 的符号就决定了平衡时净反应的方向和自发变化的方向。一个 $\\Delta G_r  0$ 的过程在正方向上是非自发的。酶可以加速达到平衡的过程，但它不能改变平衡的位置，也不能强行产生一个逆着正自由能梯度的净通量。\n结论：**错误**。\n\n**D. 测量的通量方向 $v_r$ 或浓度测量值是错误的或被错误地指定（例如，符号约定错误），因此一旦数据被校正，就不存在真正的矛盾。**\n这条假说探讨了实验误差的可能性。理论预测与实验观察之间的任何差异都有可能通过测量误差来解释。如果通量实际上是从内到外（$v_r  0$），那么它将与计算出的 $\\Delta G_r  0$ 相符。或者，如果浓度测量不正确，实际上 $c_{\\text{in}}  c_{\\text{out}}$，那么 $\\Delta G_r$ 将为负，这将与观察到的正向通量 $v_r  0$ 相符。由于实验永远不会是完美的，因此在遇到悖论时，这始终是一个需要考虑的有效假说。\n结论：**正确**。\n\n**E. 表观上的单向转运实际上是一个复合过程的一部分，该过程与三磷酸腺苷（ATP）水解或另一个放能反应相耦合，但建模忽略了这种耦合；包含该耦合会使复合过程的净 $\\Delta G_r$ 为负。**\n该假说表明转运过程是一种主动转运。在主动转运中，一个吸能过程（如将离子逆着其电化学梯度移动）与一个高度放能的过程相耦合。总的自由能变化是耦合反应自由能变化的总和。例如，如果转运与 ATP 水解耦合：\n$X_{\\text{out}}^+ + \\text{ATP} \\to X_{\\text{in}}^+ + \\text{ADP} + \\text{P}_i$\n总自由能变化为 $\\Delta G_{r, \\text{total}} = \\Delta \\tilde{G}_r(\\text{transport}) + \\Delta G(\\text{ATP hydrolysis})$。在细胞条件下，ATP 的水解是高度放能的，其 $\\Delta G$ 通常在 $-50$ 到 $-60\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$ 左右。这个大的负值可以轻易克服转运的正自由能变化（即使电学项也不利），导致总的 $\\Delta G_{r, \\text{total}}$ 为负，从而驱动 $X^+$ 的自发转運。该机制描述了原发性主动转运（例如 P-型 ATP 酶）或继发性主动转运（与另一个离子顺其梯度流动的通量相耦合）。这是生物学中维持离子梯度的基本机制。\n结论：**正确**。\n\n**F. 对绝对温度进行微小修正（例如，从 $298\\,\\mathrm{K}$ 改为 $301\\,\\mathrm{K}$）就足以在不引入电学项或耦合项的情况下逆转 $\\Delta G_r$ 的符号。**\n化学自由能项由 $\\Delta G_{chem} = RT \\ln(c_{\\text{in}}/c_{\\text{out}})$ 给出。在这个问题中，$R$ 是一个正常数，绝对温度 $T$ 必须为正，浓度比为 $c_{\\text{in}}/c_{\\text{out}} = 10  1$，这意味着 $\\ln(10)  0$。三个正数的乘积总是正的。将温度 $T$ 从 $298\\,\\mathrm{K}$ 改为 $301\\,\\mathrm{K}$ 只会略微改变正值 $\\Delta G_{chem}$ 的大小。它不能改变其符号。在给定条件下，这个假说在数学上和物理上都是不可能的。\n结论：**错误**。", "answer": "$$\\boxed{ABDE}$$", "id": "3355505"}, {"introduction": "将热力学原理应用于全网络规模的模型，需要强大的计算工具。无效循环（Futile cycles）是代谢模型中可能出现的、消耗能量但无净物质生产的非生物学现象，而热力学约束是消除它们的关键。本练习要求你设计并实施一个基于线性规划的算法，来自动检测和消除这些无效循环，从而提高代谢模型预测的准确性和生物学相关性。[@problem_id:3355529]", "problem": "考虑一个处于稳态假设下的代谢网络，其中化学计量矩阵 $S \\in \\mathbb{R}^{m \\times n}$ 编码了 $m$ 种代谢物和 $n$ 个反应的质量守恒，通量向量 $v \\in \\mathbb{R}^n$ 满足 $S v = 0$。每个反应 $r$ 都有一个相关的吉布斯自由能变（Gibbs free energy change (GFE)，记作 $\\Delta G_r$），单位为 $\\mathrm{kJ/mol}$。本文将隐藏的无效循环定义为一个非零通量向量 $v \\ne 0$，满足 $S v = 0$，使得总能量耗散 $\\sum_{r=1}^n v_r \\Delta G_r  0$，同时遵守规定的反应可逆性约束。这种向量的存在意味着网络中存在内部耗能的通量环路，这些环路对代谢物的净转化没有贡献，可能会在通量平衡分析（Flux Balance Analysis (FBA)）中影响优化结果。\n\n从稳态质量守恒 $S v = 0$ 和热力学第二定律（克劳修斯不等式）出发，设计一个计算测试来检测隐藏的无效循环，然后在优化问题中添加一个热力学不等式约束来消除这些循环。热力学第二定律要求可行的自发方向会降低吉布斯自由能（即，如果不受耦合约束，正向通量 $v_r  0$ 要求 $\\Delta G_r  0$）。量化添加此约束后对最优目标值的影响。\n\n你的程序必须实现以下两个部分：\n\n1) 隐藏无效循环检测。构建并求解一个线性规划（Linear Programming (LP)）问题，该问题在归一化约束 $\\sum_{r=1}^n |v_r| = 1$ 和反应方向性边界条件下，搜索满足 $S v = 0$ 的非零 $v$，以最小化能量总和 $\\sum_{r=1}^n v_r \\Delta G_r$。在指定的情况下，强制执行仅正向的不可逆性。报告最小值是否严格小于 $0$（使用 $10^{-9}$ 的数值容差），这表示存在隐藏的无效循环。\n\n2) 热力学消除对能量耗散目标的影响。考虑一个目标 $J(v) = -\\sum_{r=1}^n v_r \\Delta G_r$，单位为 $\\mathrm{kJ/mol}$，在 $S v = 0$ 和通量边界条件下将其最大化。计算没有热力学消除时的最优值 $J_{\\mathrm{pre}}$。然后添加线性不等式约束 $\\sum_{r=1}^n v_r \\Delta G_r \\ge 0$ 以消除耗能循环，并计算新的最优值 $J_{\\mathrm{post}}$。报告 $J_{\\mathrm{pre}}$ 和 $J_{\\mathrm{post}}$（单位为 $\\mathrm{kJ/mol}$），以及定义为 $J_{\\mathrm{pre}} - J_{\\mathrm{post}}$（单位为 $\\mathrm{kJ/mol}$）的影响。如果添加约束后不存在可行解，则影响应报告为浮点数“非数值”(NaN)。\n\n所有优化问题都必须以纯数学术语提出和解决。具体而言：\n- 对稳态使用等式约束（$S v = 0$）。\n- 仅对检测LP使用归一化约束 $\\sum_{r=1}^n |v_r| = 1$。\n- 对 $J(v)$ 的优化使用反应通量的显式下界和上界。\n- 在指定情况下，通过限制 $v_r$ 的符号来强制执行不可逆性。\n\n通过变量分裂 $v = v^+ - v^-$（其中 $v^+, v^- \\ge 0$）来实现检测LP，这样 $\\sum_{r=1}^n |v_r| = \\sum_{r=1}^n (v_r^+ + v_r^-)$ 成为一个线性等式，$S v = 0$ 变为 $S v^+ - S v^- = 0$，不可逆性 $v_r \\ge 0$ 通过固定 $v_r^- = 0$ 来表示。\n\n测试套件。使用以下三个测试用例，每个用例具有相同的 $S$ 但不同的 $\\Delta G$ 向量。在所有情况下，目标优化的通量边界为 $0 \\le v_r \\le 3$（无量纲的缩放通量单位），且反应是仅正向不可逆的。\n\n- 情况1 (存在能量耗散循环):\n  $$\n  S = \\begin{bmatrix}\n  -1  0  1 \\\\\n  1  -1  0 \\\\\n  0  1  -1\n  \\end{bmatrix},\\quad\n  \\Delta G = \\begin{bmatrix}\n  -10 \\\\\n  -5 \\\\\n  -7\n  \\end{bmatrix}\\ \\mathrm{kJ/mol}.\n  $$\n- 情况2 (不存在能量耗散循环；环路净能量为正):\n  $$\n  S = \\begin{bmatrix}\n  -1  0  1 \\\\\n  1  -1  0 \\\\\n  0  1  -1\n  \\end{bmatrix},\\quad\n  \\Delta G = \\begin{bmatrix}\n  20 \\\\\n  -5 \\\\\n  -7\n  \\end{bmatrix}\\ \\mathrm{kJ/mol}.\n  $$\n- 情况3 (接近热力学中性；在数值容差范围内，环路净能量为零):\n  $$\n  S = \\begin{bmatrix}\n  -1  0  1 \\\\\n  1  -1  0 \\\\\n  0  1  -1\n  \\end{bmatrix},\\quad\n  \\Delta G = \\begin{bmatrix}\n  -0.001 \\\\\n  -0.001 \\\\\n  0.002\n  \\end{bmatrix}\\ \\mathrm{kJ/mol}.\n  $$\n\n输出要求：\n- 对于每个测试用例，生成一个列表 $[b, J_{\\mathrm{pre}}, J_{\\mathrm{post}}, \\Delta J]$，其中 $b$ 是一个表示是否检测到隐藏循环的布尔值，$J_{\\mathrm{pre}}$ 是添加热力学不等式前 $J(v)$ 的最优值，$J_{\\mathrm{post}}$ 是添加不等式后的最优值，$\\Delta J = J_{\\mathrm{pre}} - J_{\\mathrm{post}}$。\n- 所有与能量相关的量都必须以 $\\mathrm{kJ/mol}$ 为单位表示，并四舍五入到六位小数的实数。\n- 你的程序应生成单行输出，包含一个逗号分隔的列表，该列表用方括号括起来（例如，$[\\text{result1},\\text{result2},\\text{result3}]$），其中每个 $\\text{resulti}$ 本身都是上述格式的列表。\n\n不应读取任何用户输入；所有参数都作为常量嵌入在程序中。使用科学计算库Python (SciPy) 的线性规划工具 `scipy.optimize.linprog` 和数值计算库Python (NumPy) 进行线性代数运算。通过严格执行所述约束并使用指定的单位报告能量相关输出来确保科学真实性。", "solution": "该问题要求开发一种计算方法，以检测并减轻代谢网络模型中由热力学驱动的隐藏无效循环的影响。解决方案分两部分介绍：首先，构建用于循环检测的线性规划（LP）问题；其次，构建LP以量化热力学约束对给定优化目标的影响。\n\n### 基本原理\n\n处于稳态的代谢网络受质量守恒定律支配，表示为 $S v = 0$，其中 $S \\in \\mathbb{R}^{m \\times n}$ 是 $m$ 种代谢物和 $n$ 个反应的化学计量矩阵，$v \\in \\mathbb{R}^n$ 是反应通量向量。$S$ 的零空间，记作 $\\mathrm{ker}(S)$，包含所有满足稳态条件的通量向量。\n\n热力学第二定律对自发过程的方向施加了约束。对于一个化学反应 $r$，吉布斯自由能变 $\\Delta G_r$ 决定了其自发性。网络中吉布斯自由能的总耗散率由 $\\sum_{r=1}^n v_r \\Delta G_r$ 给出。对于任何自发过程，这个和必须为负（$\\sum v_r \\Delta G_r  0$）。\n\n无效循环是一个非零通量向量 $v \\in \\mathrm{ker}(S)$ ($v \\neq 0$)，它对应于网络中的一个内部环路。如果这样一个循环在热力学上也是有利的（即 $\\Delta G^T v  0$），它就代表了一条耗散能量但没有净生成生物质或其他目标分子的途径。这可能导致在像通量平衡分析（FBA）这样的优化框架中出现不切实际的解，因为目标函数可能会利用这种能量耗散来达到人为的高值。\n\n给定的化学计量矩阵是：\n$$\nS = \\begin{bmatrix}\n-1  0  1 \\\\\n1  -1  0 \\\\\n0  1  -1\n\\end{bmatrix}\n$$\n$S$ 的零空间由向量 $v$ 组成，其中 $v_1 = v_2 = v_3$。该零空间的一个基是向量 $[1, 1, 1]^T$。因此，该网络中代表循环的任何通量向量都具有形式 $v = k \\cdot [1, 1, 1]^T$，其中 $k$ 是某个标量。\n\n### 第1部分：隐藏无效循环的检测\n\n为了检测隐藏的无效循环，我们寻找一个非平凡通量向量 $v \\neq 0$，它满足稳态条件 $S v = 0$，遵守反应方向性，并最小化吉布斯自由能耗散率 $\\Delta G^T v$。一个严格为负的最小值表明存在一个热力学上可行的无效循环。\n\n该问题被构建为以下LP：\n$$\n\\begin{aligned}\n\\text{minimize} \\quad  Z_1 = \\sum_{r=1}^n v_r \\Delta G_r = \\Delta G^T v \\\\\n\\text{subject to} \\quad  S v = 0 \\\\\n \\sum_{r=1}^n |v_r| = 1 \\\\\n v_r \\ge 0, \\quad \\text{for all } r=1, \\dots, n\n\\end{aligned}\n$$\n归一化约束 $\\sum_{r=1}^n |v_r| = 1$ 确保了非平凡解（$v \\neq 0$）并使LP有界。由于测试用例指定所有反应都是仅正向不可逆的（$v_r \\ge 0$），绝对值得以简化，约束变为 $\\sum_{r=1}^n v_r = 1$。\n\n问题陈述要求使用变量分裂来实现LP，其中每个通量 $v_r$ 分裂为一个正向分量 $v_r^+$ 和一个逆向分量 $v_r^-$，使得 $v_r = v_r^+ - v_r^-$ 且 $v_r^+, v_r^- \\ge 0$。LP的一般形式为：\n$$\n\\begin{aligned}\n\\text{minimize} \\quad  \\sum_{r=1}^n (v_r^+ \\Delta G_r - v_r^- \\Delta G_r) = [\\Delta G^T, -\\Delta G^T] \\begin{bmatrix} v^+ \\\\ v^- \\end{bmatrix} \\\\\n\\text{subject to} \\quad  S v^+ - S v^- = 0 \\\\\n \\sum_{r=1}^n (v_r^+ + v_r^-) = 1 \\\\\n v_r^+, v_r^- \\ge 0, \\quad \\text{for all } r\n\\end{aligned}\n$$\n对于给定的测试用例，所有反应都是不可逆的，所以 $v_r \\ge 0$。这通过为所有 $r$ 设置 $v_r^- = 0$ 来强制执行。该公式简化回仅涉及 $v$（对应于 $v^+$）的形式。如果最优值 $Z_{1,opt}  -10^{-9}$，则检测到无效循环。\n\n对于特定的 $S$ 矩阵，其中 $v = k[1, 1, 1]^T$，约束 $\\sum v_r = 1$ 意味着 $3k=1$，所以 $k=1/3$。唯一的可行点是 $v = [1/3, 1/3, 1/3]^T$。目标值为 $Z_1 = (1/3)\\sum \\Delta G_r$。因此，当且仅当 $\\sum \\Delta G_r  0$ 时，检测到循环。\n\n### 第2部分：热力学约束的影响评估\n\n这部分评估添加热力学约束如何影响目标函数的最优值。目标是最大化总能量耗散，$J(v) = -\\sum_{r=1}^n v_r \\Delta G_r$。这等价于最小化 $\\Delta G^T v$。\n\n**A. 约束前优化 ($J_{\\mathrm{pre}}$)**\n\n首先，我们找到没有热力学约束时的最优值。LP为：\n$$\n\\begin{aligned}\n\\text{maximize} \\quad  J(v) = - \\Delta G^T v \\\\\n\\text{subject to} \\quad  S v = 0 \\\\\n 0 \\le v_r \\le 3, \\quad \\text{for all } r=1, \\dots, n\n\\end{aligned}\n$$\n这等价于最小化 $Z_2 = \\Delta G^T v$。约束前的最优值为 $J_{\\mathrm{pre}} = -\\min(Z_2)$。可行的通量向量为 $v=k[1,1,1]^T$，其中 $0 \\le k \\le 3$。目标变为 $Z_2 = k \\sum \\Delta G_r$。\n- 如果 $\\sum \\Delta G_r  0$，则 $Z_2$ 在最大可能的 $k$（即 $k=3$）处最小化。此时 $J_{\\mathrm{pre}} = -3 \\sum \\Delta G_r$。\n- 如果 $\\sum \\Delta G_r \\ge 0$，则 $Z_2$ 在最小的非负 $k$（即 $k=0$）处最小化。此时 $J_{\\mathrm{pre}} = 0$。\n\n**B. 约束后优化 ($J_{\\mathrm{post}}$)**\n\n接下来，我们添加消除能量耗散循环的热力学约束。这个约束是 $\\sum_{r=1}^n v_r \\Delta G_r \\ge 0$。新的LP是：\n$$\n\\begin{aligned}\n\\text{maximize} \\quad  J(v) = - \\Delta G^T v \\\\\n\\text{subject to} \\quad  S v = 0 \\\\\n 0 \\le v_r \\le 3, \\quad \\text{for all } r=1, \\dots, n \\\\\n \\Delta G^T v \\ge 0\n\\end{aligned}\n$$\n我们正在最大化 $J(v)$，同时对其施加约束：条件 $\\Delta G^T v \\ge 0$ 等价于 $-\\Delta G^T v \\le 0$，即 $J(v) \\le 0$。问题变成最大化一个被约束为非正数的函数。可能的最高值为 $0$。这个值在点 $v=0$ 处是可以达到的，因为它总是可行的，满足 $S \\cdot 0 = 0$，边界 $0 \\le 0 \\le 3$，以及新增的约束 $\\Delta G^T \\cdot 0 = 0 \\ge 0$。因此，约束后的最优值总是 $J_{\\mathrm{post}} = 0$。\n\n**C. 影响计算**\n\n影响 $\\Delta J$ 是施加约束前后最优值之间的差：\n$$\n\\Delta J = J_{\\mathrm{pre}} - J_{\\mathrm{post}}\n$$\n如果约束后的问题不可行，影响将为NaN。然而，对于给定的问题结构，它总是可行的。\n只有当 $J_{\\mathrm{pre}} > 0$ 时，影响才会非零，而这当且仅当存在一个热力学上有利的无效循环（$\\sum \\Delta G_r  0$），无约束优化可以利用它时才会发生。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef solve():\n    \"\"\"\n    Main function to run the analysis for all test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    S_matrix = np.array([\n        [-1, 0, 1],\n        [1, -1, 0],\n        [0, 1, -1]\n    ])\n\n    test_cases = [\n        # Case 1: Energy-dissipating cycle present\n        {\n            \"S\": S_matrix,\n            \"delta_G\": np.array([-10, -5, -7])\n        },\n        # Case 2: No energy-dissipating cycle\n        {\n            \"S\": S_matrix,\n            \"delta_G\": np.array([20, -5, -7])\n        },\n        # Case 3: Near thermodynamic neutrality\n        {\n            \"S\": S_matrix,\n            \"delta_G\": np.array([-0.001, -0.001, 0.002])\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = analyze_network(case[\"S\"], case[\"delta_G\"])\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # Standard str() representation of a list in Python may add spaces,\n    # which we remove to match the example format's compactness.\n    final_output_str = str(results).replace(\" \", \"\")\n\n    print(final_output_str)\n\n\ndef analyze_network(S, delta_G):\n    \"\"\"\n    Performs the two-part analysis for a given metabolic network setup.\n    1. Detects hidden futile cycles.\n    2. Quantifies the impact of thermodynamic constraints on an objective.\n\n    Args:\n        S (np.ndarray): The stoichiometric matrix (m x n).\n        delta_G (np.ndarray): The vector of Gibbs free energy changes (n,).\n\n    Returns:\n        list: [b, J_pre, J_post, delta_J]\n              b (bool): True if a futile cycle is detected.\n              J_pre (float): Optimal objective value before constraint.\n              J_post (float): Optimal objective value after constraint.\n              delta_J (float): Impact J_pre - J_post.\n    \"\"\"\n    n_reactions = S.shape[1]\n    n_metabolites = S.shape[0]\n    tolerance = 1e-9\n\n    # Part 1: Hidden Futile Cycle Detection\n    # Minimize: c_det^T * v = delta_G^T * v\n    # Subject to:\n    # S*v = 0\n    # sum(v) = 1 (since v_r >= 0 for irreversible reactions)\n    # v_r >= 0\n    c_det = delta_G\n    A_eq_det = np.vstack([S, np.ones((1, n_reactions))])\n    b_eq_det = np.zeros(n_metabolites + 1)\n    b_eq_det[-1] = 1\n    bounds_det = [(0, None) for _ in range(n_reactions)]\n\n    res_det = linprog(c=c_det, A_eq=A_eq_det, b_eq=b_eq_det, bounds=bounds_det, method='highs')\n    \n    is_cycle_detected = bool(res_det.success and res_det.fun  -tolerance)\n\n    # Part 2: Impact on Energy-Dissipation Objective\n    # Objective: Maximize J(v) = -delta_G^T * v, which is equivalent to\n    # minimizing Z(v) = delta_G^T * v.\n    c_opt = delta_G\n    A_eq_opt = S\n    b_eq_opt = np.zeros(n_metabolites)\n    bounds_opt = [(0, 3) for _ in range(n_reactions)]\n\n    # Compute J_pre (without thermodynamic constraint)\n    res_pre = linprog(c=c_opt, A_eq=A_eq_opt, b_eq=b_eq_opt, bounds=bounds_opt, method='highs')\n    \n    J_pre = -res_pre.fun if res_pre.success else np.nan\n\n    # Compute J_post (with thermodynamic constraint delta_G^T * v >= 0)\n    # This constraint is written as -delta_G^T * v = 0 for linprog's A_ub\n    A_ub_post = -delta_G.reshape(1, -1)\n    b_ub_post = np.array([0])\n    \n    res_post = linprog(c=c_opt, A_eq=A_eq_opt, b_eq=b_eq_opt, \n                       A_ub=A_ub_post, b_ub=b_ub_post, \n                       bounds=bounds_opt, method='highs')\n                       \n    if res_post.status == 2: # Infeasible\n        J_post = np.nan\n        delta_J = np.nan\n    elif res_post.success:\n        J_post = -res_post.fun\n        # Handle potential floating point imprecision for results known to be zero\n        if abs(J_post)  tolerance:\n            J_post = 0.0\n        delta_J = J_pre - J_post\n    else: # Other failure\n        J_post = np.nan\n        delta_J = np.nan\n\n    # Round results to 6 decimal places\n    J_pre_rounded = round(J_pre, 6)\n    J_post_rounded = round(J_post, 6) if not np.isnan(J_post) else np.nan\n    delta_J_rounded = round(delta_J, 6) if not np.isnan(delta_J) else np.nan\n\n    return [is_cycle_detected, J_pre_rounded, J_post_rounded, delta_J_rounded]\n\nsolve()\n```", "id": "3355529"}]}