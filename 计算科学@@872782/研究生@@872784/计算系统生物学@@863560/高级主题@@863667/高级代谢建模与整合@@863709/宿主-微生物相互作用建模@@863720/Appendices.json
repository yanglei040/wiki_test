{"hands_on_practices": [{"introduction": "宿主-微生物的相互作用通常受制于对宿主提供的有限资源的竞争。资源竞争理论，特别是 $R^*$ 法则，为预测这种竞争的结果提供了一个强有力的框架。该法则指出，能够以最低水平的限制性资源维持生存的物种将在竞争中胜出。本练习将通过一个简化的宿主-微生物系统，让您亲身实践推导和应用这一基本生态学原理，从而将理论与实际预测联系起来 [@problem_id:3319034]。", "problem": "考虑宿主体内一个充分混合的黏膜微环境，其中单一限制性资源（记为 $R$，单位为毫摩尔/升 $\\mathrm{mmol\\ L^{-1}}$）由宿主以流入浓度 $S$ 供给，并以体积转换率 $D$（单位为每小时 $\\mathrm{h^{-1}}$）被冲刷掉。三种微生物种群利用资源 $R$：一种病原体 $P$ 和两种共生菌 $C_{A}$ 和 $C_{B}$。假设存在以下恒化器式动力学，这与质量平衡和标准微生物生理学一致：\n- 资源动力学由下式给出\n$$\n\\frac{dR}{dt} \\;=\\; D\\,(S - R) \\;-\\; \\sum_{i\\in\\{P,C_{A},C_{B}\\}} \\frac{1}{Y_{i}}\\,\\mu_{i}(R)\\,X_{i},\n$$\n其中 $X_{i}$ 是物种 $i$ 的生物量浓度（单位为任何一致的生物量单位），$Y_{i}$ 是单位资源的生物量产率（单位为生物量/$\\mathrm{mmol}$），$\\mu_{i}(R)$ 是总比生长速率。\n- 种群动力学由下式给出\n$$\n\\frac{dX_{i}}{dt} \\;=\\; \\big(\\mu_{i}(R) - m_{i} - D\\big)\\,X_{i},\n$$\n其中 $m_{i}$ 是维持速率（单位为 $\\mathrm{h^{-1}}$），它从总生长中减去，得到可用于平衡稀释以实现持久生存的净生长。\n\n假设每个物种都遵循 Michaelis–Menten (Monod) 生长动力学，\n$$\n\\mu_{i}(R) \\;=\\; \\mu_{\\max,i}\\,\\frac{R}{K_{i} + R},\n$$\n其中 $\\mu_{\\max,i}$ 是最大比生长速率（单位为 $\\mathrm{h^{-1}}$），$K_{i}$ 是半饱和常数（单位为 $\\mathrm{mmol\\ L^{-1}}$）。物种 $i$ 的平衡资源需求 $R^{*}_{i}$ 定义为在该动力学下，物种 $i$ 刚好能在恒化器中单独存活时的稳态资源浓度（其净人均增长率与稀释率相平衡）。\n\n宿主环境和三个物种的参数如下：\n- 宿主供给浓度 $S = 0.25$ $\\mathrm{mmol\\ L^{-1}}$；转换率 $D = 0.20$ $\\mathrm{h^{-1}}$。\n- 病原体 $P$：$\\mu_{\\max,P} = 0.85$ $\\mathrm{h^{-1}}$，$K_{P} = 0.030$ $\\mathrm{mmol\\ L^{-1}}$，$m_{P} = 0.050$ $\\mathrm{h^{-1}}$，$Y_{P} = 0.45$（生物量/$\\mathrm{mmol}$）。\n- 共生菌 $C_{A}$：$\\mu_{\\max,C_{A}} = 0.65$ $\\mathrm{h^{-1}}$，$K_{C_{A}} = 0.015$ $\\mathrm{mmol\\ L^{-1}}$，$m_{C_{A}} = 0.020$ $\\mathrm{h^{-1}}$，$Y_{C_{A}} = 0.55$（生物量/$\\mathrm{mmol}$）。\n- 共生菌 $C_{B}$：$\\mu_{\\max,C_{B}} = 1.10$ $\\mathrm{h^{-1}}$，$K_{C_{B}} = 0.080$ $\\mathrm{mmol\\ L^{-1}}$，$m_{C_{B}} = 0.120$ $\\mathrm{h^{-1}}$，$Y_{C_{B}} = 0.40$（生物量/$\\mathrm{mmol}$）。\n\n任务：\n1. 从上述动力学定义和 Monod 定律出发，推导任何单个物种 $i$ 的 $R^{*}_{i}$ 关于 $(\\mu_{\\max,i}, K_{i}, m_{i}, D)$ 的通用闭式表达式。\n2. 使用推导出的表达式和给定的参数，计算 $R^{*}_{P}$、$R^{*}_{C_{A}}$ 和 $R^{*}_{C_{B}}$。\n3. 假设宿主微环境最初仅由 $C_{A}$ 在其单物种稳态下主导。使用动力学定义和您的 $R^{*}$ 结果，通过评估以下量来确定当 $P$ 或 $C_{B}$ 以无穷小密度引入时是否能够入侵：\n$$\n\\Delta_{i\\mid C_{A}} \\;=\\; R_{\\mathrm{res}} - R^{*}_{i},\n$$\n其中 $R_{\\mathrm{res}}$ 是只有 $C_{A}$ 存在的定居状态下的资源浓度。一个正的 $\\Delta_{i\\mid C_{A}}$ 意味着入侵是可能的；一个负值则意味着入侵失败。\n\n答案格式：\n- 以有序行矩阵 $\\big(R^{*}_{P}\\; R^{*}_{C_{A}}\\; R^{*}_{C_{B}}\\; \\Delta_{P\\mid C_{A}}\\; \\Delta_{C_{B}\\mid C_{A}}\\big)$ 的形式报告所要求的五个量。\n- 每个条目以 $\\mathrm{mmol\\ L^{-1}}$ 为单位表示。\n- 将报告的每个值四舍五入到四位有效数字。", "solution": "该问题提法清晰，科学上基于标准的生态竞争理论，并包含了获得唯一解所需的所有信息。因此，我们可以进行推导和计算。\n\n**1. 平衡资源需求 $R^{*}_{i}$ 的推导**\n\n平衡资源需求 $R^{*}_{i}$ 被定义为单个物种 $i$ 在恒化器中刚好能持久生存时的稳态资源浓度。这意味着其种群生物量 $X_{i}$ 非零且恒定，即处于一个非平凡稳态。任何稳态的条件是种群变化率为零：\n$$\n\\frac{dX_{i}}{dt} \\;=\\; \\big(\\mu_{i}(R) - m_{i} - D\\big)\\,X_{i} \\;=\\; 0\n$$\n对于一个非平凡稳态（$X_i  0$），括号中的项必须为零。满足此条件的资源浓度，根据定义，即为 $R^{*}_{i}$：\n$$\n\\mu_{i}(R^{*}_{i}) - m_{i} - D \\;=\\; 0\n$$\n该方程表明，在平衡资源水平 $R^{*}_{i}$ 时，总比生长速率必须精确平衡由维持（$m_i$）和冲刷（$D$）造成的总损失率。\n重新整理得到持久生存所需的生长速率：\n$$\n\\mu_{i}(R^{*}_{i}) \\;=\\; m_{i} + D\n$$\n现在我们代入给定的 Michaelis–Menten (Monod) 动力学公式来表示生长速率 $\\mu_{i}(R)$：\n$$\n\\mu_{\\max,i}\\,\\frac{R^{*}_{i}}{K_{i} + R^{*}_{i}} \\;=\\; m_{i} + D\n$$\n为了找到 $R^{*}_{i}$ 的闭式表达式，我们用代数方法解这个方程：\n$$\n\\mu_{\\max,i}\\,R^{*}_{i} \\;=\\; (m_{i} + D)(K_{i} + R^{*}_{i})\n$$\n$$\n\\mu_{\\max,i}\\,R^{*}_{i} \\;=\\; (m_{i} + D)K_{i} + (m_{i} + D)R^{*}_{i}\n$$\n$$\n\\mu_{\\max,i}\\,R^{*}_{i} - (m_{i} + D)R^{*}_{i} \\;=\\; (m_{i} + D)K_{i}\n$$\n$$\nR^{*}_{i}\\,\\big(\\mu_{\\max,i} - m_{i} - D\\big) \\;=\\; K_{i}\\,(m_{i} + D)\n$$\n最后，分离出 $R^{*}_{i}$ 得到通用表达式：\n$$\nR^{*}_{i} \\;=\\; K_{i}\\,\\frac{m_{i} + D}{\\mu_{\\max,i} - m_{i} - D}\n$$\n该表达式在 $\\mu_{\\max,i}  m_{i} + D$ 的条件下有效，这确保了该物种具有足够克服其损失的最大潜在生长速率，从而得到一个具有物理意义的正值 $R^{*}_{i}$。\n\n**2. 计算 $R^{*}_{P}$、$R^{*}_{C_{A}}$ 和 $R^{*}_{C_{B}}$**\n\n使用推导出的公式和提供的参数，稀释率 $D = 0.20$ $\\mathrm{h^{-1}}$，我们计算每个物种的平衡资源需求。\n\n对于病原体 $P$：\n$m_{P} + D = 0.050 + 0.20 = 0.25$ $\\mathrm{h^{-1}}$\n$\\mu_{\\max,P} - m_{P} - D = 0.85 - 0.25 = 0.60$ $\\mathrm{h^{-1}}$\n$$\nR^{*}_{P} \\;=\\; K_{P}\\,\\frac{m_{P} + D}{\\mu_{\\max,P} - m_{P} - D} \\;=\\; (0.030\\,\\mathrm{mmol\\ L^{-1}})\\,\\frac{0.25}{0.60} \\;=\\; 0.0125\\,\\mathrm{mmol\\ L^{-1}}\n$$\n\n对于共生菌 $C_{A}$：\n$m_{C_{A}} + D = 0.020 + 0.20 = 0.22$ $\\mathrm{h^{-1}}$\n$\\mu_{\\max,C_{A}} - m_{C_{A}} - D = 0.65 - 0.22 = 0.43$ $\\mathrm{h^{-1}}$\n$$\nR^{*}_{C_{A}} \\;=\\; K_{C_{A}}\\,\\frac{m_{C_{A}} + D}{\\mu_{\\max,C_{A}} - m_{C_{A}} - D} \\;=\\; (0.015\\,\\mathrm{mmol\\ L^{-1}})\\,\\frac{0.22}{0.43} \\;\\approx\\; 0.0076744\\,\\mathrm{mmol\\ L^{-1}}\n$$\n\n对于共生菌 $C_{B}$：\n$m_{C_{B}} + D = 0.120 + 0.20 = 0.32$ $\\mathrm{h^{-1}}$\n$\\mu_{\\max,C_{B}} - m_{C_{B}} - D = 1.10 - 0.32 = 0.78$ $\\mathrm{h^{-1}}$\n$$\nR^{*}_{C_{B}} \\;=\\; K_{C_{B}}\\,\\frac{m_{C_{B}} + D}{\\mu_{\\max,C_{B}} - m_{C_{B}} - D} \\;=\\; (0.080\\,\\mathrm{mmol\\ L^{-1}})\\,\\frac{0.32}{0.78} \\;\\approx\\; 0.032821\\,\\mathrm{mmol\\ L^{-1}}\n$$\n\n**3. 入侵分析**\n\n问题假设一个由共生菌 $C_A$ 在其单物种稳态下主导的微环境。在这种状态下，假设该物种没有被冲刷掉（$X_{C_A}  0$），该物种会将限制性资源浓度降低到其自身的平衡需求水平。因此，定居资源浓度为 $R_{\\mathrm{res}} = R^{*}_{C_{A}}$。这是可能的，因为 $R^{*}_{C_{A}} \\approx 0.007674\\,\\mathrm{mmol\\ L^{-1}}$ 小于供给浓度 $S=0.25\\,\\mathrm{mmol\\ L^{-1}}$。\n\n一个入侵物种 $i$（这里是 $P$ 或 $C_B$）如果其初始人均增长率为正，就可以成功地在这个环境中定居。在无穷小密度下的入侵者增长率由定居者设定的资源水平 $R_{\\mathrm{res}}$ 决定：\n$$\n\\frac{1}{X_i}\\frac{dX_{i}}{dt} \\;=\\; \\mu_{i}(R_{\\mathrm{res}}) - m_{i} - D\n$$\n此增长率为正，当且仅当 $\\mu_{i}(R_{\\mathrm{res}})  m_{i} + D$。由于 $\\mu_i(R)$ 是 $R$ 的单调递增函数，并且根据定义 $\\mu_{i}(R^{*}_{i}) = m_{i} + D$，正增长的条件变为 $R_{\\mathrm{res}}  R^{*}_{i}$。\n\n问题定义了量 $\\Delta_{i\\mid C_{A}} = R_{\\mathrm{res}} - R^{*}_{i}$。正值表示入侵成功。\n使用 $R_{\\mathrm{res}} = R^{*}_{C_{A}}$，我们为两个潜在的入侵者计算 $\\Delta$。\n\n对于病原体 $P$ 的入侵：\n$$\n\\Delta_{P\\mid C_{A}} \\;=\\; R^{*}_{C_{A}} - R^{*}_{P} \\;\\approx\\; 0.0076744 - 0.0125 \\;=\\; -0.0048256\\,\\mathrm{mmol\\ L^{-1}}\n$$\n由于 $\\Delta_{P\\mid C_{A}}  0$，病原体 $P$ 无法入侵被 $C_A$ 占据的微环境。\n\n对于共生菌 $C_{B}$ 的入侵：\n$$\n\\Delta_{C_{B}\\mid C_{A}} \\;=\\; R^{*}_{C_{A}} - R^{*}_{C_{B}} \\;\\approx\\; 0.0076744 - 0.032821 \\;=\\; -0.0251466\\,\\mathrm{mmol\\ L^{-1}}\n$$\n由于 $\\Delta_{C_{B}\\mid C_{A}}  0$，共生菌 $C_B$ 也无法入侵。\n\n这一结果与R星竞争法则一致，该法则指出，对于单一限制性资源，具有最低 $R^*$ 的物种将是优势竞争者，并排斥所有其他物种。在这里，$R^{*}_{C_{A}}$ 是三个值中最低的。\n\n将所要求的五个量四舍五入到四位有效数字，得到：\n$R^{*}_{P} \\to 0.01250$\n$R^{*}_{C_{A}} \\to 0.007674$\n$R^{*}_{C_{B}} \\to 0.03282$\n$\\Delta_{P\\mid C_{A}} \\to -0.004826$\n$\\Delta_{C_{B}\\mid C_{A}} \\to -0.02515$", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.01250  0.007674  0.03282  -0.004826  -0.02515 \\end{pmatrix}}\n$$", "id": "3319034"}, {"introduction": "除了简单的资源竞争，宿主与微生物之间的相互作用还涉及复杂的代谢交换网络。流平衡分析（Flux Balance Analysis, FBA）是一种关键的约束优化方法，用于模拟这些网络层面的相互作用。通过构建和求解一个简单的双物种FBA模型，本练习将为您提供一个实践性的入门，这是研究宿主与微生物之间代谢相互依赖关系的一项核心技能 [@problem_id:3319045]。", "problem": "本题要求您形式化并求解一个在稳态质量平衡下耦合宿主和微生物的群落流量平衡分析 (FBA) 模型。流量平衡分析 (FBA) 通过对胞内代谢物设定稳态质量平衡来为代谢网络建模，该平衡由化学计量矩阵和流量向量编码，并在线性物理化学流量边界的约束下优化一个具有生物学意义的线性目标。在宿主-微生物群落 FBA 中，宿主和微生物由独立的化学计量矩阵和流量向量表示，并通过代表区室间代谢物转运的交换流量耦合在一起。\n\n从基本原理开始：\n- 每个区室的稳态质量平衡意味着在恒定的流量模式下，胞内代谢物浓度不随时间变化。这被编码为一个关于流量的齐次线性系统。对于一个化学计量矩阵 $S \\in \\mathbb{R}^{m \\times n}$（其中 $m$ 是胞内代谢物的数量，$n$ 是反应的数量）和流量向量 $v \\in \\mathbb{R}^{n}$，质量平衡为 $S v = 0$。\n- 由于酶容量、热力学和转运限制，反应流量是受限的。每个流量 $v_i$ 都受到下界和上界 $l_i \\le v_i \\le u_i$ 的约束，物理单位为毫摩尔每克干重每小时 (mmol gDW$^{-1}$ h$^{-1}$)。\n- 群落目标是宿主和微生物目标的加权和。对于宿主目标流量 $v_{h,\\text{obj}}$ 和微生物目标流量 $v_{m,\\text{obj}}$，以及非负权重 $w_h, w_m$，群落目标为 $w_h v_{h,\\text{obj}} + w_m v_{m,\\text{obj}}$。\n\n建立优化问题\n$$\n\\max_{v_h, v_m, v_e}\\quad w_h\\, v_{h,\\text{obj}} + w_m\\, v_{m,\\text{obj}}\n$$\n约束条件为\n$$\nS_h v_h = 0,\\quad S_m v_m = 0,\n$$\n以及宿主和微生物之间通过交换流量 $v_e$ 实现的交换耦合约束，还有各自的流量边界。交换耦合必须强制要求宿主对交换代谢物的输出流量等于微生物的输入流量，并且也等于交换变量。具体来说，如果 $v_{h,\\text{exp}}$ 是宿主输出反应流量，$v_{m,\\text{imp}}$ 是微生物输入反应流量，则施加\n$$\nv_e - v_{h,\\text{exp}} = 0,\\quad v_e - v_{m,\\text{imp}} = 0,\n$$\n其中 $v_e$ 的边界为 $0 \\le v_e \\le E_{\\max}$，单位为 mmol gDW$^{-1}$ h$^{-1}$。\n\n请将此线性优化问题实现为一个单一程序，该程序在给定以下参数值测试套件的情况下，计算每种情况下的最优目标值 $w_h\\, v_{h,\\text{obj}} + w_m\\, v_{m,\\text{obj}}$。以 mmol gDW$^{-1}$ h$^{-1}$ 为单位，将每个最优值报告为一个四舍五入到六位小数的浮点数。\n\n宿主网络定义：\n- 宿主代谢物：两种胞内物质，由行隐式标记。\n- 宿主反应：4 个反应，其化学计量矩阵为\n$$\nS_h = \\begin{bmatrix}\n1  -1  0  0\\\\\n0  1  -1  -1\n\\end{bmatrix},\n$$\n其中列按顺序对应于以下反应：$R_{h,1}$ (从环境中摄取 $A$)，$R_{h,2}$ (转化 $A_h \\to B_h$)，$R_{h,3}$ (使用 $B_h$ 的宿主生物量)，$R_{h,4}$ (将 $B_h$ 输出到微生物)。宿主目标是最大化宿主生物量流量，因此宿主目标选择器为\n$$\nc_h = \\begin{bmatrix}0  0  1  0\\end{bmatrix}^\\top,\n$$\n它选择了 $R_{h,3}$。\n\n微生物网络定义：\n- 微生物代谢物：两种胞内物质，由行隐式标记。\n- 微生物反应：3 个反应，其化学计量矩阵为\n$$\nS_m = \\begin{bmatrix}\n1  -1  0\\\\\n0  1  -1\n\\end{bmatrix},\n$$\n其中列按顺序对应于以下反应：$R_{m,1}$ (从宿主输入 $B$)，$R_{m,2}$ (转化 $B_m \\to C_m$)，$R_{m,3}$ (使用 $C_m$ 的微生物生物量)。微生物目标选择器为\n$$\nc_m = \\begin{bmatrix}0  0  1\\end{bmatrix}^\\top,\n$$\n它选择了 $R_{m,3}$。\n\n交换耦合：\n- 单个交换变量 $v_e$ 代表从宿主到微生物的 $B$ 的净流量。它通过等式 $v_e = v_{h,4}$ 和 $v_e = v_{m,1}$ 与宿主输出和微生物输入耦合。\n- $v_e$ 的边界：$0 \\le v_e \\le E_{\\max}$，其中 $E_{\\max}$ 在每个测试用例中指定。\n\n流量边界，除非在各测试用例中另有规定：\n- 宿主反应边界 (按 $R_{h,1}$, $R_{h,2}$, $R_{h,3}$, $R_{h,4}$ 顺序)：下界 $l_h = [0, 0, 0, 0]$ 和上界 $u_h = [U_{\\text{in}}, 10, 10, 10]$，其中 $U_{\\text{in}}$ 是每个测试用例提供的宿主对 $R_{h,1}$ 的摄取能力，单位为 mmol gDW$^{-1}$ h$^{-1}$，其他上界为 10 mmol gDW$^{-1}$ h$^{-1}$。\n- 微生物反应边界 (按 $R_{m,1}$, $R_{m,2}$, $R_{m,3}$ 顺序)：下界 $l_m = [0, 0, 0]$ 和上界 $u_m = [10, 10, 10]$，单位为 mmol gDW$^{-1}$ h$^{-1}$。\n\n测试套件：\n- 情况 1：权重 $w_h = 0.5$, $w_m = 0.5$；宿主摄取能力 $U_{\\text{in}} = 10$；交换上限 $E_{\\max} = 5$。\n- 情况 2：权重 $w_h = 0.5$, $w_m = 0.5$；$U_{\\text{in}} = 10$；$E_{\\max} = 0$。\n- 情况 3：权重 $w_h = 0$, $w_m = 1$；$U_{\\text{in}} = 10$；$E_{\\max} = 5$。\n- 情况 4：权重 $w_h = 0.2$, $w_m = 0.8$；$U_{\\text{in}} = 3$；$E_{\\max} = 100$。\n\n您的程序应按如下方式为每种情况建立组合线性规划模型。设完整的决策向量为 $x = [v_h; v_m; v_e] \\in \\mathbb{R}^{8}$，其中 $v_h \\in \\mathbb{R}^{4}$, $v_m \\in \\mathbb{R}^{3}$，$v_e \\in \\mathbb{R}^{1}$。构建等式约束\n$$\nA_{\\text{eq}} x = b_{\\text{eq}},\n$$\n通过将 $S_h v_h = 0$ 和 $S_m v_m = 0$ 嵌入到 $A_{\\text{eq}}$ 中（使用适当的零填充），并为 $v_e - v_{h,4} = 0$ 和 $v_e - v_{m,1} = 0$ 添加两行来实现。$x$ 的边界由宿主边界、微生物边界和交换边界 $0 \\le v_e \\le E_{\\max}$ 拼接而成。用于最大化的目标向量为\n$$\nc^\\top x = w_h c_h^\\top v_h + w_m c_m^\\top v_m + 0 \\cdot v_e,\n$$\n您应该通过对 $c$ 取反来实现最小化。\n\n要求的输出格式：\n- 计算每种情况下以 mmol gDW$^{-1}$ h$^{-1}$ 为单位的最优目标值 $w_h\\, v_{h,\\text{obj}} + w_m\\, v_{m,\\text{obj}}$，并四舍五入到六位小数。\n- 生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，例如 $[\\alpha_1,\\alpha_2,\\alpha_3,\\alpha_4]$，其中每个 $\\alpha_i$ 是按上述顺序列出的相应情况的浮点数。", "solution": "问题陈述已经过严格审查，并被认为是有效的。它提出了一个在计算系统生物学中适定的、有科学依据且计算上可行的标准方法论问题——群落流量平衡分析 (FBA)。所有需要的数据、参数和约束都已提供，使得可以为每个测试用例确定唯一的最优目标值。\n\n任务是求解一个模拟宿主和微生物之间代谢耦合的线性规划 (LP) 问题。目标是在稳态条件下最大化它们各自生物量流量的加权和。问题被表述如下：\n$$\n\\max_{v_h, v_m, v_e}\\quad w_h\\, v_{h,\\text{obj}} + w_m\\, v_{m,\\text{obj}}\n$$\n并服从一组线性的等式和不等式约束。这个最大化问题可以使用标准的 LP 求解器来解决，而这些求解器通常执行最小化操作。我们可以通过最小化目标函数的负值来实现这一点：\n$$\n\\min_{v_h, v_m, v_e}\\quad -(w_h\\, v_{h,\\text{obj}} + w_m\\, v_{m,\\text{obj}})\n$$\n为了实现这一点，我们首先构建一个表示宿主-微生物联合群落的单一线性系统。完整的决策变量向量 $x$ 是通过拼接各个流量向量形成的：\n$$\nx = \\begin{bmatrix} v_h \\\\ v_m \\\\ v_e \\end{bmatrix} = [v_{h,1}, v_{h,2}, v_{h,3}, v_{h,4}, v_{m,1}, v_{m,2}, v_{m,3}, v_e]^\\top \\in \\mathbb{R}^8\n$$\n$x$ 的分量对应于 4 个宿主反应流量 ($v_h$)、3 个微生物反应流量 ($v_m$) 和 1 个交换流量 ($v_e$)。\n\n要最大化的目标函数是 $Z = w_h v_{h,3} + w_m v_{m,3}$。用向量 $x$ 表示，即为 $c_{orig}^\\top x$，其中 $c_{orig} = [0, 0, w_h, 0, 0, 0, w_m, 0]^\\top$。为了进行最小化，我们使用目标向量 $c = -c_{orig} = [0, 0, -w_h, 0, 0, 0, -w_m, 0]^\\top$。\n\n约束分为两类：等式约束和边界。等式约束 $A_{eq} x = b_{eq}$ 强制执行质量平衡和耦合。\n稳态质量平衡条件是宿主的 $S_h v_h = 0$ 和微生物的 $S_m v_m = 0$。这些方程被嵌入到更大的系统中。\n给定 $S_h = \\begin{bmatrix} 1  -1  0  0\\\\ 0  1  -1  -1 \\end{bmatrix}$ 和 $S_m = \\begin{bmatrix} 1  -1  0\\\\ 0  1  -1 \\end{bmatrix}$，这些对应于：\n$1 \\cdot v_{h,1} - 1 \\cdot v_{h,2} = 0$\n$1 \\cdot v_{h,2} - 1 \\cdot v_{h,3} - 1 \\cdot v_{h,4} = 0$\n$1 \\cdot v_{m,1} - 1 \\cdot v_{m,2} = 0$\n$1 \\cdot v_{m,2} - 1 \\cdot v_{m,3} = 0$\n\n交换耦合约束是 $v_e = v_{h,4}$ 和 $v_e = v_{m,1}$。对于线性求解器，这些约束以标准形式写为：\n$-v_{h,4} + v_e = 0$\n$-v_{m,1} + v_e = 0$\n\n将这 6 个方程组合起来，得到等式约束矩阵 $A_{eq} \\in \\mathbb{R}^{6 \\times 8}$ 和向量 $b_{eq} \\in \\mathbb{R}^{6}$。由于所有方程都是齐次的，因此 $b_{eq}$ 是一个零向量。\n$$\nA_{eq} = \\begin{bmatrix}\n1  -1  0  0  0  0  0  0 \\\\\n0  1  -1  -1  0  0  0  0 \\\\\n0  0  0  0  1  -1  0  0 \\\\\n0  0  0  0  0  1  -1  0 \\\\\n0  0  0  -1  0  0  0  1 \\\\\n0  0  0  0  -1  0  0  1\n\\end{bmatrix}, \\quad\nb_{eq} = \\begin{bmatrix}\n0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0\n\\end{bmatrix}\n$$\n每个流量变量 $x_i$ 的边界被指定为 $l_i \\le x_i \\le u_i$。这些边界是通过汇集 $v_h$、$v_m$ 和 $v_e$ 的各自边界来构成的。对于每个测试用例，边界为：\n$v_{h,1} \\in [0, U_{\\text{in}}]$\n$v_{h,2} \\in [0, 10]$\n$v_{h,3} \\in [0, 10]$\n$v_{h,4} \\in [0, 10]$\n$v_{m,1} \\in [0, 10]$\n$v_{m,2} \\in [0, 10]$\n$v_{m,3} \\in [0, 10]$\n$v_e \\in [0, E_{\\max}]$\n它们为求解器构成了一个 (下界, 上界) 元组列表。\n\n对于每个测试用例，我们代入给定的 $w_h$、$w_m$、$U_{\\text{in}}$ 和 $E_{\\max}$ 值来定义具体的 LP 实例。然后使用 `scipy.optimize` 库中的 `linprog` 函数来求解该问题。从最小化返回的最优值 `res.fun` 被取反，以获得原始目标函数的最大值。然后按要求将该值四舍五入到六位小数。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef solve():\n    \"\"\"\n    Solves a series of community Flux Balance Analysis problems.\n    Each problem is formulated as a linear program and solved using scipy.optimize.linprog.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each tuple contains: (w_h, w_m, U_in, E_max)\n    test_cases = [\n        (0.5, 0.5, 10, 5),\n        (0.5, 0.5, 10, 0),\n        (0.0, 1.0, 10, 5),\n        (0.2, 0.8, 3, 100),\n    ]\n\n    # The decision vector is x = [v_h1, v_h2, v_h3, v_h4, v_m1, v_m2, v_m3, v_e]\n    # It has 8 variables.\n    \n    # Construct the equality constraint matrix A_eq.\n    # This matrix is constant for all test cases.\n    # It has 6 constraints: 2 for S_h, 2 for S_m, 2 for coupling.\n    A_eq = np.zeros((6, 8))\n\n    # S_h * v_h = 0\n    # Equation 1: v_h1 - v_h2 = 0\n    A_eq[0, 0] = 1\n    A_eq[0, 1] = -1\n    # Equation 2: v_h2 - v_h3 - v_h4 = 0\n    A_eq[1, 1] = 1\n    A_eq[1, 2] = -1\n    A_eq[1, 3] = -1\n\n    # S_m * v_m = 0\n    # Equation 3: v_m1 - v_m2 = 0\n    A_eq[2, 4] = 1\n    A_eq[2, 5] = -1\n    # Equation 4: v_m2 - v_m3 = 0\n    A_eq[3, 5] = 1\n    A_eq[3, 6] = -1\n\n    # Coupling constraints\n    # Equation 5: v_e - v_h4 = 0 = -v_h4 + v_e = 0\n    A_eq[4, 3] = -1\n    A_eq[4, 7] = 1\n    # Equation 6: v_e - v_m1 = 0 = -v_m1 + v_e = 0\n    A_eq[5, 4] = -1\n    A_eq[5, 7] = 1\n    \n    # The right-hand side of the equality constraints is all zeros.\n    b_eq = np.zeros(6)\n\n    results = []\n    for case in test_cases:\n        w_h, w_m, U_in, E_max = case\n\n        # Objective function vector c for minimization.\n        # We want to maximize w_h*v_h3 + w_m*v_m3, which is equivalent to\n        # minimizing -w_h*v_h3 - w_m*v_m3.\n        # v_h3 is at index 2, v_m3 is at index 6.\n        c = np.zeros(8)\n        c[2] = -w_h\n        c[6] = -w_m\n\n        # Define bounds for each variable in the decision vector x.\n        bounds = [\n            (0, U_in),   # v_h1: bounds [0, U_in]\n            (0, 10),     # v_h2: bounds [0, 10]\n            (0, 10),     # v_h3: bounds [0, 10]\n            (0, 10),     # v_h4: bounds [0, 10]\n            (0, 10),     # v_m1: bounds [0, 10]\n            (0, 10),     # v_m2: bounds [0, 10]\n            (0, 10),     # v_m3: bounds [0, 10]\n            (0, E_max),  # v_e:  bounds [0, E_max]\n        ]\n\n        # Solve the linear program using the 'highs' method for robustness.\n        res = linprog(c, A_eq=A_eq, b_eq=b_eq, bounds=bounds, method='highs')\n        \n        # The result 'res.fun' is the minimum value of the objective.\n        # We negate it to get the maximum value of the original problem.\n        optimal_value = -res.fun\n\n        # Append the formatted result.\n        results.append(f\"{optimal_value:.6f}\")\n\n    # Print the final results in the specified format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3319045"}, {"introduction": "微生物，特别是病毒，在宿主体内会迅速进化，形成以高适应性“主”基因型为中心及其周围突变体组成的“准种”。“错误阈值”概念描述了突变率对病毒种群结构和存活的临界影响，过高的突变率会导致适应性最强的基因型丢失，甚至整个种群的崩溃。本练习将让您从第一性原理出发推导错误阈值，从而深入理解在宿主体内进化过程中，复制保真度与遗传多样性之间的基本权衡 [@problem_id:3319085]。", "problem": "病毒在宿主内复制时会形成一个“准种”，该准种以一个高适应度的“主基因型”为中心，并被一团突变基因型所环绕。考虑一个单峰适应度景观，其中主基因型的复制适应度为 $W_0$，所有突变体（突变云）的适应度较低，为 $W_1$，且 $W_0  W_1$。设病毒基因组长度为 $L$ 个核苷酸，并假设每次复制时各位点独立发生突变，每位点突变概率为 $u$。用 $q = 1 - u$ 表示每位点保真度，因此主基因型在整个基因组上产生一个无错误副本的概率为 $q^L$。假设在大基因组极限下，从突变云到精确主基因型的回复突变可以忽略不计。\n\n使用复制子-突变子框架作为常微分方程（ODEs）系统，从第一性原理推导主基因型在种群中持续存在的条件，并获得临界每位点突变概率 $u_c$（“错误阈”）作为 $W_0$、$W_1$ 和 $L$ 的函数的闭式表达式。然后，在参数值为 $L = 10^4$，$W_0 = 1.3$ 和 $W_1 = 1.0$ 的情况下，计算 $u_c$ 的值。\n\n将最终答案表示为每次复制的临界每位点突变概率（无量纲），并四舍五入到四位有效数字。", "solution": "此问题是有效的。它在科学上基于已确立的准种和错误阈理论，问题陈述清晰，提供了所有必要信息，并且表述客观。\n\n该问题要求基于复制子-突变子模型，推导病毒准种的临界每位点突变概率 $u_c$。我们给定一个两类系统：一个复制适应度为 $W_0$ 的主基因型和一团适应度统一较低（为 $W_1$）的突变基因型。\n\n设 $x_0(t)$ 为主基因型在时刻 $t$ 的频率，$x_1(t)$ 为突变云在种群中的频率。根据定义，$x_0(t) + x_1(t) = 1$。基因组长度为 $L$，每位点突变概率为 $u$，每位点保真度为 $q = 1 - u$。主基因型无突变复制的概率为 $Q = q^L = (1-u)^L$。任何有一次或多次突变的复制都假定会产生一个突变云的成员。从突变云到主基因型的回复突变被认为是可忽略的。\n\n主基因型个体数 $N_0$ 和突变云个体数 $N_1$ 的动态可以用以下常微分方程（ODEs）描述：\n$$ \\frac{dN_0}{dt} = N_0 W_0 Q $$\n$$ \\frac{dN_1}{dt} = N_0 W_0 (1 - Q) + N_1 W_1 $$\n第一个方程表明，主种群仅通过无错误复制增长。第二个方程表明，突变种群的增长有两个来源：主基因型的错误复制和现有突变体的复制。\n\n总种群大小为 $N = N_0 + N_1$。总种群的变化率为：\n$$ \\frac{dN}{dt} = \\frac{dN_0}{dt} + \\frac{dN_1}{dt} = N_0 W_0 Q + N_0 W_0 (1 - Q) + N_1 W_1 = N_0 W_0 + N_1 W_1 $$\n种群的平均适应度 $\\bar{W}$ 由下式给出：\n$$ \\bar{W} = \\frac{1}{N} \\frac{dN}{dt} = \\frac{N_0 W_0 + N_1 W_1}{N_0 + N_1} = x_0 W_0 + x_1 W_1 = x_0 W_0 + (1-x_0)W_1 $$\n接下来，我们推导主基因型频率 $x_0 = N_0 / N$ 的常微分方程：\n$$ \\frac{dx_0}{dt} = \\frac{d}{dt}\\left(\\frac{N_0}{N}\\right) = \\frac{1}{N}\\frac{dN_0}{dt} - \\frac{N_0}{N^2}\\frac{dN}{dt} $$\n代入 $\\frac{dN_0}{dt}$ 和 $\\frac{dN}{dt}$ 的表达式：\n$$ \\frac{dx_0}{dt} = \\frac{N_0 W_0 Q}{N} - \\frac{N_0}{N} \\left(\\frac{N_0 W_0 + N_1 W_1}{N}\\right) $$\n$$ \\frac{dx_0}{dt} = x_0 W_0 Q - x_0 \\bar{W} $$\n$$ \\frac{dx_0}{dt} = x_0 (W_0 Q - \\bar{W}) $$\n代入 $\\bar{W}$ 的表达式：\n$$ \\frac{dx_0}{dt} = x_0 (W_0 Q - (x_0 W_0 + (1-x_0)W_1)) $$\n如果存在一个稳定的稳态解，使得其频率 $x_0^*  0$，则主基因型在种群中持续存在。在稳态时，$\\frac{dx_0}{dt} = 0$。\n$$ x_0^* (W_0 Q - (x_0^* W_0 + (1-x_0^*)W_1)) = 0 $$\n该方程对于 $x_0^*$ 有两个可能的解：\n1. $x_0^* = 0$：这对应于主基因型的灭绝。\n2. $W_0 Q - (x_0^* W_0 + (1-x_0^*)W_1) = 0$：这对应于一个非平凡稳态。\n\n为了使主基因型能够持续存在，第二个解必须具有物理意义，即 $0  x_0^* \\le 1$。我们来求解 $x_0^*$：\n$$ W_0 Q - W_1 = x_0^* (W_0 - W_1) $$\n$$ x_0^* = \\frac{W_0 Q - W_1}{W_0 - W_1} $$\n因为给定 $W_0  W_1$，所以分母为正。因此，要使 $x_0^*$ 为正，分子也必须为正：\n$$ W_0 Q - W_1  0 \\implies W_0 Q  W_1 $$\n这是主基因型持续存在的条件。它意味着主基因型的有效适应度，即其内在适应度 $W_0$ 乘以忠实复制概率 $Q$，必须大于突变云的适应度 $W_1$。\n\n错误阈由临界突变概率 $u_c$ 定义，在该概率下，上述不等式变为等式。设 $q_c = 1 - u_c$ 为临界保真度。该条件为：\n$$ W_0 q_c^L = W_1 $$\n问题指明了大基因组极限，其中 $L \\gg 1$。在此极限下，且对于小的突变率 $u_c \\ll 1$，我们可以使用近似 $(1-u_c)^L \\approx \\exp(-u_c L)$。将此近似应用于临界条件：\n$$ W_0 \\exp(-u_c L) = W_1 $$\n我们现在求解临界每位点突变概率 $u_c$：\n$$ \\exp(-u_c L) = \\frac{W_1}{W_0} $$\n对两边取自然对数：\n$$ -u_c L = \\ln\\left(\\frac{W_1}{W_0}\\right) = -\\ln\\left(\\frac{W_0}{W_1}\\right) $$\n$$ u_c = \\frac{1}{L} \\ln\\left(\\frac{W_0}{W_1}\\right) $$\n这就是错误阈处的临界每位点突变概率的闭式表达式。\n\n现在，我们用给定的参数计算 $u_c$ 的值：$L = 10^4$，$W_0 = 1.3$ 和 $W_1 = 1.0$。\n$$ u_c = \\frac{1}{10^4} \\ln\\left(\\frac{1.3}{1.0}\\right) $$\n$$ u_c = \\frac{\\ln(1.3)}{10000} $$\n使用计算器，$\\ln(1.3) \\approx 0.262364264$。\n$$ u_c \\approx \\frac{0.262364264}{10000} = 0.0000262364264 $$\n这可以写成科学记数法 $2.62364264 \\times 10^{-5}$。\n问题要求答案四舍五入到四位有效数字。\n$$ u_c \\approx 2.624 \\times 10^{-5} $$", "answer": "$$\\boxed{2.624 \\times 10^{-5}}$$", "id": "3319085"}]}