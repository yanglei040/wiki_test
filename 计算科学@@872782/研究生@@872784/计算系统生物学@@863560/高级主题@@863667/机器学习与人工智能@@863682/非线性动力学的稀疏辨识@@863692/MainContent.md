## 引言
在理解和预测从细胞内分子相互作用到[行星运动](@entry_id:170895)等复杂系统的行为时，发现其背后的数学模型——即控制方程——是科学研究的核心任务。传统上，这些模型是通过基于第一性原理的、繁琐的理论推导建立的。然而，随着[数据采集](@entry_id:273490)技术的发展，我们现在拥有了海量的观测数据，这催生了数据驱动建模的浪潮。在众多方法中，[非线性动力学](@entry_id:190195)的稀疏辨识（[SINDy](@entry_id:266063)）脱颖而出，它旨在解决一个根本性挑战：我们能否自动从数据中发现简洁、可解释且具有泛化能力的动力学模型，而不是构建一个难以理解的“黑箱”？

[SINDy](@entry_id:266063)的核心前提是“简约性原则”或“[奥卡姆剃刀](@entry_id:147174)”：许多复杂系统的动力学虽然表现出[非线性](@entry_id:637147)行为，但其控制方程在结构上往往是稀疏的，即只由少数几个关键的[非线性](@entry_id:637147)项主导。本文旨在全面介绍[SINDy](@entry_id:266063)这一强大的数据驱动发现框架。我们将系统性地解答如何利用[稀疏回归](@entry_id:276495)的力量，从时间序列数据中“学习”出非[线性动力系统](@entry_id:150282)的控制方程。

在接下来的内容中，读者将踏上一段从理论到实践的旅程。我们将在**“原理与机制”**一章中，深入剖析[SINDy](@entry_id:266063)的数学基础，详细阐述如何将动力学问题转化为线性回归，并探讨核心算法、[模型可辨识性](@entry_id:186414)及理论保证等关键问题。随后，在**“应用与交叉学科联系”**一章，我们将展示[SINDy](@entry_id:266063)在解决[计算系统生物学](@entry_id:747636)、[流体力学](@entry_id:136788)等前沿科学问题时的巨大威力，并介绍其针对含噪、高维数据等真实世界挑战的先进扩展。最后，通过**“动手实践”**部分提供的一系列精心设计的编程练习，读者将有机会亲手实现[SINDy](@entry_id:266063)算法，巩固对核心概念的理解并体验数据驱动科学发现的魅力。

## 原理与机制

本章旨在深入探讨[非线性动力学](@entry_id:190195)稀疏辨识（Sparse Identification of Nonlinear Dynamics, [SINDy](@entry_id:266063)）方法的核心原理与关键机制。我们将从其基本数学框架出发，逐步解析模型构建、算法实现、理论保证以及在实际应用中遇到的高级问题。与引言章节的概述不同，本章将提供一个系统化且严谨的视角，使读者能够全面掌握[SINDy](@entry_id:266063)的理论基础和技术细节。

### 核心表述：从动力学到线性回归

所有动力系统的基础是描述状态随时间演化的[微分方程](@entry_id:264184)。考虑一个由 $n$ 个[状态变量](@entry_id:138790)组成的系统，其状态向量为 $x(t) \in \mathbb{R}^n$。该系统的动力学行为由一个通常未知的向量场 $f$ 决定，其数学形式为：

$$
\frac{d}{dt}x(t) = f(x(t))
$$

[SINDy](@entry_id:266063)方法的核心思想是，对于许多物理或生物系统，向量场 $f(x)$ 的每个分量 $f_j(x)$ 实际上可以由一组相对简单的候选函数（[基函数](@entry_id:170178)）的**稀疏 (sparse)** [线性组合](@entry_id:154743)来精确表示或高度近似。这意味着在所有可能的影响因素中，只有少数几个是决定动力学演化的主导因素。

为了从数据中学习这个[稀疏结构](@entry_id:755138)，我们首先构建一个**候选函数库 (candidate function library)**，这是一个包含 $p$ 个函数的集合 $\{\theta_1(x), \dots, \theta_p(x)\}$。这些函数可以是多项式、[三角函数](@entry_id:178918)或基于领域知识的[非线性](@entry_id:637147)函数。[SINDy](@entry_id:266063)模型假设：

$$
\frac{d}{dt}x_j(t) = f_j(x(t)) \approx \sum_{k=1}^{p} \theta_k(x(t)) \xi_{kj}
$$

其中 $\xi_{kj}$ 是待定的系数。对于整个状态向量，这个关系可以写成矩阵形式。

为了从时间序列数据中求解这些系数，我们首先需要构建几个关键矩阵 [@problem_id:3349430]。假设我们在 $T$ 个离散的时间点 $t_1, \dots, t_T$ 对系统状态进行采样，得到一系列状态向量。

1.  **状态矩阵 (State Matrix)** $X$：将这 $T$ 次测量的状态向量（作为行向量）堆叠起来，形成一个 $T \times n$ 的矩阵 $X \in \mathbb{R}^{T \times n}$。它的每一行代表一个时间点的系统状态。

    $$
    X = \begin{pmatrix} x(t_1)^\top \\ \vdots \\ x(t_T)^\top \end{pmatrix}
    $$

2.  **导数矩阵 (Derivative Matrix)** $\dot{X}$：相应地，我们需要[状态向量](@entry_id:154607)在这些时间点的导数值。由于通常无法直接测量导数，我们通过对状态矩阵 $X$ 进行[数值微分](@entry_id:144452)来近似得到 $\dot{X} \in \mathbb{R}^{T \times n}$。常用的方法包括有限差分或基于多项式平滑的滤波器（如[Savitzky-Golay滤波器](@entry_id:187453)）。

3.  **库矩阵 (Library Matrix)** $\Theta(X)$：将候选函数库中的每一个函数应用于状态矩阵 $X$ 的每一行（即每个采样时刻的状态），得到一个 $T \times p$ 的矩阵 $\Theta(X) \in \mathbb{R}^{T \times p}$。

    $$
    \Theta(X) = \begin{pmatrix} \theta_1(x(t_1))  \dots  \theta_p(x(t_1)) \\ \vdots  \ddots  \vdots \\ \theta_1(x(t_T))  \dots  \theta_p(x(t_T)) \end{pmatrix}
    $$

4.  **[系数矩阵](@entry_id:151473) (Coefficient Matrix)** $\Xi$：这是一个 $p \times n$ 的矩阵 $\Xi \in \mathbb{R}^{p \times n}$，它的第 $j$ 列 $\xi_j \in \mathbb{R}^p$ 包含了用于构建第 $j$ 个[状态变量](@entry_id:138790)导数 $\dot{x}_j$ 的系数。

将这些矩阵组合起来，整个动力学系统的辨识问题就转化为一个看似标准的线性回归问题：

$$
\dot{X} \approx \Theta(X) \Xi
$$

其维度关系为 $(T \times n) \approx (T \times p) \times (p \times n)$。至关重要的是，这个问题可以被[解耦](@entry_id:637294)。注意到[矩阵乘法](@entry_id:156035)的定义，上式等价于 $n$ 个独立的向量回归问题 [@problem_id:3349430]：

$$
\dot{X}_{:,j} \approx \Theta(X) \xi_j, \quad \text{for } j = 1, \dots, n
$$

其中 $\dot{X}_{:,j}$ 是 $\dot{X}$ 的第 $j$ 列，代表第 $j$ 个状态变量的时间导数序列。[SINDy](@entry_id:266063)的目标就是为每一个独立的回归问题找到一个稀疏的系数向量 $\xi_j$。

### 构建候选函数库：[SINDy](@entry_id:266063)的艺术

[SINDy](@entry_id:266063)方法的成功在很大程度上取决于候选函数库 $\Theta(X)$ 的构建。这个库编码了我们对系统可能存在的动力学机制的先验知识。一个设计良好的库应该足够丰富，以包含真实动力学的组成部分，但又不能过于庞大，以免导致计算困难和过拟合。

**库函数的选择**

库函数的选择是建模过程中的一个关键决策。常见的选择包括：
-   **多项式函数**：常数项、线性项 $x_i$、二次项 $x_i x_j$ 等。在生物化学网络中，多项式项可以代表[质量作用定律](@entry_id:144659)（mass-action kinetics）。例如，常数项可以表示零阶生成或降解速率 [@problem_id:3349430]。
-   **[三角函数](@entry_id:178918)**：$\sin(x_i)$, $\cos(x_i)$ 等，适用于具有周期性或[振荡](@entry_id:267781)行为的系统。
-   **领域特定的[非线性](@entry_id:637147)函数**：这是[SINDy](@entry_id:266063)强大灵活性的一种体现。在[计算系统生物学](@entry_id:747636)中，我们常常需要引入能够描述特定生物过程的函数 [@problem_id:3349307]。例如：
    -   **米氏方程 ([Michaelis-Menten](@entry_id:145978) kinetics)**：$M_{i,K}(x_i) = \frac{x_i}{K + x_i}$，用于描述酶促反应中的饱和现象。
    -   **[希尔函数](@entry_id:262041) (Hill functions)**：$H_{i,k,K}(x_i) = \frac{x_i^k}{K^k + x_i^k}$（激活）和 $I_{i,k,K}(x_i) = \frac{K^k}{K^k + x_i^k}$（抑制），用于描述[协同结合](@entry_id:141623)效应。

**库的维度与冗余**

构建一个综合性的库往往会使其维度 $p$ 变得非常大。例如，考虑一个有 $n=3$ 个物种的生化系统，如果我们包含直到二次的多项式、两种协同性指数的[希尔函数](@entry_id:262041)（激活和抑制，每种有5个候选解离常数）以及米氏函数（4个候选常数），库的原始维度可以轻易达到82个函数 [@problem_id:3349307]。

更严重的问题是**冗余 (redundancy)** 或 **[共线性](@entry_id:270224) (collinearity)**。当库中的一个函数可以由其他函数的[线性组合](@entry_id:154743)精确或近似地表示时，就会出现这个问题。一个典型的例子是[希尔函数](@entry_id:262041)的激活和抑制形式，它们与常数项存在严格的线性关系 [@problem_id:3349307]：

$$
H_{i,k,K}(x_i) + I_{i,k,K}(x_i) = \frac{x_i^k}{K^k + x_i^k} + \frac{K^k}{K^k + x_i^k} = 1
$$

这意味着，如果库中已经包含了常数项 $1$ 和[激活函数](@entry_id:141784) $H_{i,k,K}(x_i)$，那么对应的抑制函数 $I_{i,k,K}(x_i)$ 就是完全冗余的。这种精确的[共线性](@entry_id:270224)会导致库矩阵 $\Theta(X)$ [秩亏](@entry_id:754065)，使得回归问题变得病态（ill-posed），无法得到唯一的解。即使不存在精确的共线性，**近似[共线性](@entry_id:270224) (near-collinearity)**（例如，当两个具有[相似参数](@entry_id:754856)的[希尔函数](@entry_id:262041)被包含在库中时）也会导致数值不稳定，使[回归系数](@entry_id:634860)的估计对噪声非常敏感。这些问题引出了系统辨识中的一个核心概念：[可辨识性](@entry_id:194150)。

### [可辨识性](@entry_id:194150)：我们能否找到真实模型？

在尝试从数据中辨识模型之前，我们必须回答一个根本问题：即使拥有理想数据，我们能否唯一地确定模型的结构和参数？这个问题将我们引向**可辨识性 (identifiability)** 的概念，它分为两个层面 [@problem_id:3349422]。

**结构可辨识性 (Structural Identifiability)**

结构[可辨识性](@entry_id:194150)是一个理论概念，它探讨在拥有无限量、无噪声的“充分丰富”数据时，模型参数是否唯一。在[SINDy](@entry_id:266063)的背景下，这意味着对于给定的函数库 $\Theta(X)$，能否唯一地确定稀疏系数矩阵 $\Xi$。

一个充分条件是，沿着系统的任意（“充分丰富”的）轨迹 $X(t)$，库矩阵 $\Theta(X(t))$ 的列向量是**函数上[线性无关](@entry_id:148207)的 (functionally linearly independent)**。换句话说，不存在任何非零的系数向量 $\Delta\xi$，使得 $\Theta(X(t))\Delta\xi$ 对于所有时间 $t$ 恒等于零。这等价于要求轨迹诱导的**格拉姆矩阵 (Gram matrix)** $G = \int_0^T \Theta(X(t))^\top \Theta(X(t)) dt$ 是正定的 [@problem_id:3349422]。

结构不可辨识性的一个常见来源是系统存在**[守恒量](@entry_id:150267) (conserved quantities)** 或代数[不变量](@entry_id:148850)。例如，如果一个系统的总[质量守恒](@entry_id:204015)，$x_1(t) + x_2(t) = C$，那么库函数 $\{1, x_1, x_2\}$ 在所有可行的轨迹上都将是[线性相关](@entry_id:185830)的，从而无法唯一区分它们各自的系数 [@problem_id:3349422]。

**实践[可辨识性](@entry_id:194150) (Practical Identifiability)**

与理论上的结构[可辨识性](@entry_id:194150)不同，实践可辨识性关注的是在处理有限且带噪的真实数据时，我们能否可靠地恢复模型参数。即使一个模型在结构上是可辨识的，实践中也可能由于以下因素而变得不可辨识：

-   **数据噪声**：[测量噪声](@entry_id:275238)会干扰[状态和](@entry_id:193625)导数的估计，可能掩盖真实的动力学关系。
-   **数据量有限**：采样点数量不足可能无法充分探索状态空间。
-   **轨迹激励不足 (Lack of Persistent Excitation)**：如果观测到的轨迹非常单调，例如系统迅速收敛到一个[不动点](@entry_id:156394)，那么许多候选函数在这些数据上的表现可能非常相似，导致库矩阵的列向量之间出现高度的**经验共线性 (empirical collinearity)**。

评估实践可辨识性的常用诊断工具包括 [@problem_id:3349422]：
-   **[条件数](@entry_id:145150) (Condition Number)** $\kappa(\Theta(X))$：衡量库矩阵 $\Theta(X)$ 的病态程度。一个巨大的[条件数](@entry_id:145150)意味着微小的噪声都可能导致[系数估计](@entry_id:175952)的巨大变化。
-   **[互相关性](@entry_id:188177) (Mutual Coherence)** $\mu$：衡量库中任意两个（归一化的）列向量之间的最大相似度。
-   **自举法[重采样](@entry_id:142583) (Bootstrap Resampling)**：通过对数据进行[重采样](@entry_id:142583)并反复拟合模型，观察所辨识出的模型结构（即非零系数的集合）的稳定性。一个在实践中可辨识的模型应该在不同的数据[子集](@entry_id:261956)上稳定地恢复出相同的非零项。

### [稀疏恢复](@entry_id:199430)问题：理论与保证

[SINDy](@entry_id:266063)的核心挑战在于求解一个欠定的、但要求解是稀疏的[线性系统](@entry_id:147850)。幸运的是，[压缩感知](@entry_id:197903) (Compressed Sensing) 和[稀疏恢复](@entry_id:199430) (Sparse Recovery) 理论为此提供了坚实的数学基础。

一个关键的度量是库矩阵 $\Theta$ 的**[互相关性](@entry_id:188177) (mutual coherence)** $\mu$，定义为归一化后列向量之间[内积](@entry_id:158127)[绝对值](@entry_id:147688)的最大值：$\mu = \max_{i \neq j} |\boldsymbol{\theta}_{i}^{\top} \boldsymbol{\theta}_{j}|$，其中 $\boldsymbol{\theta}_i$ 是 $\Theta$ 的归一化列向量。[互相关性](@entry_id:188177)衡量了库中“原子”之间的相似性或重叠程度。

一个经典理论结果是，在无噪声的情况下，如果真实解 $\xi^*$ 的稀疏度 $s$（即非零元素的个数）满足以下条件 [@problem_id:3349326]：

$$
s  \frac{1}{2}\left(1 + \frac{1}{\mu}\right)
$$

那么这个最稀疏的解是唯一的，并且可以通过求解一个凸[优化问题](@entry_id:266749)（例如，$\ell_1$ 范数最小化）被精确地恢复出来。这个条件告诉我们，一个“更好”的库（具有更低的[互相关性](@entry_id:188177)，即其[基函数](@entry_id:170178)更接近正交）允许我们从数据中恢复出更复杂的模型（具有更高的稀疏度 $s$）。

在有噪声的情况下，库矩阵的**条件数** $\kappa(\Theta)$ 扮演了关键角色。[最小二乘估计](@entry_id:262764)的[方差](@entry_id:200758)与 $(\Theta^\top \Theta)^{-1}$ 成正比。该矩阵的最大[特征值](@entry_id:154894)与 $\Theta$ 的最小奇异值的平方的倒数 $1/s_p^2$ 有关。通过[条件数](@entry_id:145150) $\kappa(\Theta) = s_1/s_p$，我们可以看到，当条件数很大时，$s_p$ 相对很小，导致估计[方差](@entry_id:200758)的上限变得非常大。这意味着即使是很小的噪声也可能被放大，从而产生不可靠的[系数估计](@entry_id:175952)，这使得区分真实的非零系数和由噪声引起的伪影变得极为困难 [@problem_id:3349446]。

### [SINDy](@entry_id:266063)算法：序列阈值最小二乘法

为了在实践中解决这个带噪声的[稀疏回归](@entry_id:276495)问题，[SINDy](@entry_id:266063)框架通常采用一种称为**序列阈值[最小二乘法](@entry_id:137100) (Sequential Thresholded Least Squares, STLSQ)** 的[迭代算法](@entry_id:160288) [@problem_id:3349336]。该算法通过在估计和稀疏化之间交替进行，巧妙地平衡了[偏差-方差权衡](@entry_id:138822)。

STLSQ算法的步骤如下，针对每一个[状态变量](@entry_id:138790) $\dot{X}_{:,j}$ 独立进行：

1.  **初始拟合**：首先，对所有候选函数进行一次标准的[最小二乘回归](@entry_id:262382)，得到一个稠密（非稀疏）的[系数估计](@entry_id:175952) $\hat{\xi}_j^{(0)} = (\Theta^\top \Theta)^{-1} \Theta^\top \dot{X}_{:,j}$。这个初始估计通常[方差](@entry_id:200758)较大，尤其是当库矩阵存在[共线性](@entry_id:270224)时。

2.  **硬阈值化 (Hard Thresholding)**：设置一个阈值 $\lambda$。将上一步得到的系数向量 $\hat{\xi}_j^{(k)}$ 中所有[绝对值](@entry_id:147688)小于 $\lambda$ 的元素置为零。这一步直接强制施加了稀疏性，可以看作是一种[特征选择](@entry_id:177971)。它通过剔除可能由噪声或共线性引起的较小系数来降低模型的[方差](@entry_id:200758)，但代价是可能引入偏差（如果真实的系数本身就很小）。

3.  **再拟合 (Refitting)**：上一步的阈值化操作会使保留下来的非零系数产生收缩（shrinkage），从而偏离其真实值。为了修正这种偏差，我们进行一次“再拟合”。仅使用在上一步中被识别为非零的系数所对应的库函数（即所谓的**活动集 (active set)**），再次进行最小二-乘回归。这一步只在缩减后的、通常条件更好的子问题上求解，能够为选定的项提供一个无偏的、更精确的[系数估计](@entry_id:175952)。

4.  **迭代**：重复第2步和第3步，直到活动集（即非零系数的集合）在连续的迭代中不再发生变化。此时，算法收敛到一个稳定的稀疏解。

这个“阈值化-再拟合”的迭代过程是STLSQ的核心，它使得[SINDy](@entry_id:266063)能够在噪声和库函数相关性的挑战下，稳健地辨识出动力系统的[稀疏结构](@entry_id:755138)。

### 高级主题与实践考量

掌握了[SINDy](@entry_id:266063)的基本框架和核心算法后，我们还需探讨一些在真实世界研究中至关重要的高级主题和实践技巧。

#### 超参数选择与交叉验证

STLSQ算法的性能严重依赖于阈值超参数 $\lambda$ 的选择。一个太小的 $\lambda$ 会导致模型包含许多伪项，而一个太大的 $\lambda$ 则可能剔除掉关键的动力学项。因此，必须采用系统的方法来选择最优的 $\lambda$。

**交叉验证 (Cross-Validation)** 是进行超参数优选的标准方法。然而，对于[时间序列数据](@entry_id:262935)，经典的随机k折[交叉验证](@entry_id:164650)是**不适用**的，因为它破坏了数据的时间依赖结构，会导致**时间泄露 (temporal leakage)**，即[训练集](@entry_id:636396)“意外地”看到了[验证集](@entry_id:636445)的信息，从而得到过于乐观的性能评估。

一种科学合理的方法是**分块前向[交叉验证](@entry_id:164650) (blocked forward-chaining cross-validation)** [@problem_id:3349314]。其设计原则如下：
-   **尊重因果性**：[训练集](@entry_id:636396)必须严格位于[验证集](@entry_id:636445)的时间之前。
-   **分块**：将时间序列分割成连续的[数据块](@entry_id:748187)。块的大小 $B$ 应足够大，以捕获系统的主要时间尺度。例如，如果系统存在一个周期为 $180$ 分钟的[振荡](@entry_id:267781)，那么块的大小应至少为 $180$ 分钟对应的数据点数，以确保每个块内都包含完整的动力学信息。
-   **设置缓冲带 (Buffer Gap)**：在训练集的末尾和验证集的开头之间留出一个“缓冲带”，即一段不用于训练也不用于验证的数据。这个缓冲带的尺寸 $G$ 必须足够大，以避免两种形式的时间泄露：(1) 数据点之间的自相关性；(2) [数值微分](@entry_id:144452)操作的窗口重叠。例如，如果自相关性在 $20$ 分钟后衰减，而[数值微分](@entry_id:144452)（如[Savitzky-Golay滤波器](@entry_id:187453)）的单侧窗口为 $12$ 个数据点（对应 $24$ 分钟），则缓冲带应至少取两者中的较大者，即 $24$ 分钟对应的数据点数。

#### 高级阈值与[停止准则](@entry_id:136282)

固定的阈值 $\lambda$ 可能不是最优的。更先进的策略会动态调整阈值或使用更复杂的[停止准则](@entry_id:136282)。

一个重要的思想是将阈值与数据中的噪声水平联系起来。在理想情况下，一个系数的估计值如果显著大于由噪声引起的波动，那么它就应该是真实的。这引出了**噪声感知阈值 (noise-aware thresholding)**。例如，在某些假设下，一个理论上可靠的阈值可以设置为 $\tau \propto \hat{\sigma} \sqrt{\log p}$，其中 $\hat{\sigma}$ 是对数据中噪声[标准差](@entry_id:153618)的估计 [@problem_id:3349464]。

我们甚至可以从[统计假设检验](@entry_id:274987)的角度来推导阈值。假设我们想控制**族系误差率 (family-wise error rate, FWER)**，即在真实模型是零（所有系数都为零）的情况下，错误地将任何一个系数识别为非零的概率。通过分析[最小二乘估计量](@entry_id:204276)的[方差](@entry_id:200758)（它依赖于库矩阵的条件数 $\kappa(\Theta)$），并应用[Bonferroni校正](@entry_id:261239)，我们可以导出一个控制FWER的阈值 [@problem_id:3349446]：

$$
\tau = \frac{\sigma_{\varepsilon} \kappa(\Theta)}{s_1} \Phi^{-1}\left(1 - \frac{\alpha}{2p}\right)
$$

其中 $\sigma_\varepsilon$ 是噪声标准差，$s_1$ 是 $\Theta$ 的最大奇异值，$\alpha$ 是期望的FWER水平，$\Phi^{-1}$ 是[标准正态分布](@entry_id:184509)的[逆累积分布函数](@entry_id:266870)。这个公式为阈值的选择提供了严格的统计学依据。

此外，一个鲁棒的[SINDy](@entry_id:266063)实现应该包含精细的**[停止准则](@entry_id:136282) (stopping criteria)**，而不仅仅是检查活动集是否收敛。一个综合的准则可能包括 [@problem_id:3349464]：
1.  活动集稳定。
2.  模型残差的相对下降小于某个小公差 $\varepsilon$。
3.  满足一个筛选[最优性条件](@entry_id:634091)，例如，被排除的函数与当前残差的相关性都小于阈值。

#### 处理[相关噪声](@entry_id:137358)

标准的最小二乘法假设残差是独立同分布的（i.i.d.）。然而，在许多实际情况中，尤其当系统受到**过程噪声 (process noise)**（即动力学方程本身受到随机扰动）影响时，[SINDy](@entry_id:266063)回归模型中的残差会表现出**[自相关](@entry_id:138991) (autocorrelation)** [@problem_id:3349419]。例如，如果[过程噪声](@entry_id:270644)是一个[Ornstein-Uhlenbeck过程](@entry_id:140047)，那么采样后的残差序列可以建模为一个[一阶自回归过程](@entry_id:746502)（AR(1)）。

在这种情况下，使用[普通最小二乘法](@entry_id:137121)（OLS）会导致[系数估计](@entry_id:175952)的次优甚至有偏。正确的做法是使用**[广义最小二乘法](@entry_id:272590) (Generalized Least Squares, GLS)**。GLS通过引入残差的协方差矩阵 $\Sigma$ 的逆来对数据进行“白化”，从而得到最优线性[无偏估计](@entry_id:756289)。GLS估计量由下式给出：

$$
\hat{\beta}_{GLS} = (\Theta^\top \Sigma^{-1} \Theta)^{-1} \Theta^\top \Sigma^{-1} y
$$

如果我们可以对残差的协[方差](@entry_id:200758)结构进行建模（例如，估计出[AR(1)模型](@entry_id:265801)中的自相关系数 $\rho$），我们就能构造出 $\Sigma^{-1}$ 并计算出更准确的[系数估计](@entry_id:175952) [@problem_id:3349419]。这展示了[SINDy](@entry_id:266063)框架如何通过结合更复杂的统计模型来适应真实数据的复杂性。

#### 与[Koopman算子理论](@entry_id:266030)的联系

最后，[SINDy](@entry_id:266063)方法可以被置于一个更深远的理论框架中——**[Koopman算子理论](@entry_id:266030) (Koopman operator theory)**。这个理论提供了一个强大的视角，即将非线性动力学转化为一个作用于无穷维函数空间（即可观测量空间）上的线性演化。

[Koopman算子](@entry_id:183136) $\mathcal{U}^t$ 将一个[可观测量](@entry_id:267133)函数 $g(x)$ 沿着动力系统的流 $\Phi^t(x)$ 向前演化：$(\mathcal{U}^{t} g)(x) = g(\Phi^{t}(x))$。其无穷小生成元 $\mathcal{K}$ 描述了可观测量的[瞬时变化率](@entry_id:141382)：$\frac{d}{dt}g(x(t)) = (\mathcal{K}g)(x(t))$。

从这个角度看，[SINDy](@entry_id:266063)可以被解释为一种寻找Koopman生成元 $\mathcal{K}$ 在我们选择的有限函数库（字典）$\{\phi_1, \dots, \phi_p\}$ 所张成的[子空间](@entry_id:150286)上的一个稀疏的、有限维的近似 [@problem_id:3349459]。当我们应用[SINDy](@entry_id:266063)于“提升后”的变量 $z(t) = \Phi(x(t))$ 上来拟合一个[线性模型](@entry_id:178302) $\dot{z} \approx Kz$ 时，所得到的[稀疏矩阵](@entry_id:138197) $K$ 正是这个近似的Koopman生成元在该基下的矩阵表示。

这个视角也揭示了[SINDy](@entry_id:266063)与另一个重要的数据驱动方法——**动态[模态分解](@entry_id:637725) (Dynamic Mode Decomposition, DMD)** 及其扩展（EDMD）——之间的深刻联系。EDMD旨在找到一个线性算子 $A$ 来近似离散[时间演化](@entry_id:153943) $z(t+\Delta t) \approx A z(t)$。在小时间步长 $\Delta t$ 的极限下，这两个模型是等价的，其矩阵表示满足关系 [@problem_id:3349459]：

$$
A \approx I + \Delta t K
$$

这种联系将[SINDy](@entry_id:266063)从一个纯粹的回归技巧提升为一个旨在逼近非线性动力学底层线性结构的有力工具，为我们理解和分析复杂系统提供了统一而深刻的视角。