{"hands_on_practices": [{"introduction": "元胞自动机 (CA) 的宏观行为由其微观规则决定。精心设计的规则可以确保系统遵守特定的守恒定律，例如细胞数量的稳态。本练习要求您通过数学推导来证明，一组给定的细胞分裂和凋亡的随机规则，如何能在期望上导致总细胞数保持不变。这项练习是模型验证和理解涌现性质的一项基本技能。 [@problem_id:3293881]", "problem": "考虑一个具有周期性边界条件的二维方格细胞自动机（Cellular Automaton, CA），该自动机代表一个上皮组织单层。每个格点 $j$ 具有一个二元状态 $x_{j} \\in \\{0,1\\}$，其中 $x_{j} = 1$ 表示一个活细胞，$x_{j} = 0$ 表示一个空格点。令 $N = \\sum_{j} x_{j}$ 为细胞总数。每个格点有一个大小为 $k$ 的固定邻域（例如，半径为1的摩尔邻域有 $k = 8$），对于任何被占据的格点 $i$，定义 $e_{i} \\in \\{0,1,\\dots,k\\}$ 为格点 $i$ 的空邻居数量。\n\n在每次更新时，CA 通过从所有被占据的格点集合中均匀随机地选择一个被占据的格点 $i$ 来进行异步演化。给定选定的格点 $i$，定义一个局部事件概率\n$$\nr_{i} = r_{0} \\frac{e_{i}}{k},\n$$\n其中 $r_{0} \\in (0, \\tfrac{1}{2}]$ 是一个固定参数。然后，格点 $i$ 处的更新通过从以下互斥的可能性中抽取一个结果来进行：\n- 以概率 $r_{i}$，位于 $i$ 处的细胞分裂到其 $e_{i}$ 个空邻居格点中的一个（均匀随机选择），从而使 $N$ 增加 $1$。\n- 以概率 $r_{i}$，位于 $i$ 处的细胞经历凋亡（程序性细胞死亡），从而使 $N$ 减少 $1$。\n- 以概率 $1 - 2 r_{i}$，在 $i$ 处不发生任何变化，$N$ 保持不变。\n\n这些规则反映了两个经过充分验证的生物学事实：(i) 细胞分裂受限于可用空间的多少，以及 (ii) 在稀疏占据的邻域中，接触介导的存活信号的丧失（失巢凋亡）会增加凋亡的可能性。\n\n从期望值的定义出发，并以焦点格点的随机选择及其上更新的随机结果为条件，推导每次更新中细胞总数的期望变化，记为 $\\mathbb{E}[\\Delta N]$。将其表示为一个关于当前构型 $\\{x_{j}\\}$、邻域空位数 $\\{e_{i}\\}$ 和参数 $r_{0}$ 的闭式解析表达式。将最终答案表示为无单位的单一解析表达式。无需四舍五入。", "solution": "问题陈述经评估有效。它在科学上是成立的，作为计算生物学中的一个标准细胞自动机模型，其问题设定良好，所有必要的参数和规则都已定义，并且是客观且无矛盾的。约束条件 $r_0 \\in (0, \\tfrac{1}{2}]$ 确保了所有概率都是良好定义且非负的，因为 $r_i = r_0 \\frac{e_i}{k} \\le r_0 \\le \\frac{1}{2}$，这意味着 $1 - 2r_i \\ge 0$。我们进行推导。\n\n目标是推导每次更新中细胞总数的期望变化，记为 $\\mathbb{E}[\\Delta N]$。细胞总数为 $N = \\sum_j x_j$，其中对于被占据的格点 $x_j=1$，对于空格点 $x_j=0$。我们假设过程开始时细胞数量不为零，即 $N > 0$。\n\n更新过程包括两个随机选择阶段：\n1.  从所有 $N$ 个被占据的格点集合中均匀随机地选择一个被占据的格点 $i$。\n2.  根据给定的概率，在格点 $i$ 处发生一个随机事件（分裂、凋亡或无变化）。\n\n令 $\\mathcal{O} = \\{ j \\mid x_j = 1 \\}$ 为所有被占据格点的索引集合。该集合的大小为 $|\\mathcal{O}| = N$。令 $I$ 为表示被选择进行更新的格点索引的随机变量。根据问题陈述，对于任何格点 $i \\in \\mathcal{O}$，其被选中的概率为：\n$$\nP(I=i) = \\frac{1}{N}\n$$\n为了求得细胞数量的期望变化 $\\mathbb{E}[\\Delta N]$，我们可以使用全期望定律，以格点 $I$ 的选择为条件。公式为：\n$$\n\\mathbb{E}[\\Delta N] = \\sum_{i \\in \\mathcal{O}} \\mathbb{E}[\\Delta N \\mid I=i] P(I=i)\n$$\n其中 $\\mathbb{E}[\\Delta N \\mid I=i]$ 是在给定格点 $i$ 被选中进行更新的情况下，$N$ 的期望变化。\n\n我们现在为任意一个被占据的格点 $i \\in \\mathcal{O}$ 计算这个条件期望。细胞总数的变化 $\\Delta N$ 可以根据格点 $i$ 处的事件取三个不同的值：\n*   **分裂**：细胞数量增加一，因此 $\\Delta N = +1$。此事件以概率 $r_i$ 发生。\n*   **凋亡**：细胞数量减少一，因此 $\\Delta N = -1$。此事件以概率 $r_i$ 发生。\n*   **无变化**：细胞数量保持不变，因此 $\\Delta N = 0$。此事件以概率 $1 - 2r_i$ 发生。\n\n在选定格点 $i$ 的条件下，$\\Delta N$ 的期望值是每个可能的 $\\Delta N$ 值乘以其相应概率的总和：\n$$\n\\mathbb{E}[\\Delta N \\mid I=i] = (+1) \\cdot P(\\text{division at } i) + (-1) \\cdot P(\\text{apoptosis at } i) + (0) \\cdot P(\\text{no change at } i)\n$$\n代入问题中给出的概率：\n$$\n\\mathbb{E}[\\Delta N \\mid I=i] = (+1) \\cdot r_i + (-1) \\cdot r_i + (0) \\cdot (1 - 2r_i)\n$$\n这可以简化为：\n$$\n\\mathbb{E}[\\Delta N \\mid I=i] = r_i - r_i + 0 = 0\n$$\n这个结果表明，对于任何被选中的被占据格点 $i$，细胞总体的期望变化恰好为零。这是该模型设计的直接结果，其中使细胞数量增加的事件（分裂）的概率被设定为与使细胞数量减少的事件（凋亡）的概率完全相同。局部邻域相关的因子 $r_i = r_0 \\frac{e_i}{k}$ 对这两个速率的调节作用是相同的，因此在单个事件的层面上，它们对期望变化的贡献完全相互抵消。\n\n现在，我们将此条件期望代回到全期望定律中：\n$$\n\\mathbb{E}[\\Delta N] = \\sum_{i \\in \\mathcal{O}} (0) \\cdot P(I=i)\n$$\n由于 $P(I=i) = \\frac{1}{N}$，这变为：\n$$\n\\mathbb{E}[\\Delta N] = \\sum_{i \\in \\mathcal{O}} (0) \\cdot \\frac{1}{N}\n$$\n这个和由 $N$ 个项组成，每一项都为零。因此，总和为零：\n$$\n\\mathbb{E}[\\Delta N] = 0\n$$\n每次更新中细胞总数的期望变化是 $0$。这是一个闭式解析表达式，是一个与当前构型 $\\{x_j\\}$、邻域空位数 $\\{e_i\\}$ 以及参数 $r_0$ 无关的常数。", "answer": "$$\n\\boxed{0}\n$$", "id": "3293881"}, {"introduction": "许多生物过程，如趋化性，依赖于细胞感知其环境中的化学梯度。本练习探讨了在离散网格上，邻域（即数字“细胞”的“感官”）的选择如何影响梯度估计的准确性。通过对不同的邻域结构（冯·诺依曼和摩尔邻域）实施最小二乘法拟合，您将量化由离散化和场曲率引入的估计偏差，这对于精确模拟基于梯度的细胞行为至关重要。 [@problem_id:3293950]", "problem": "考虑一个用于空间生物学建模的细胞自动机 (CA) 的二维晶格，其网格间距为 $\\Delta$。一个位于 $(x_0,y_0)$ 的智能体感知一个标量化学引诱物浓度场 $c(x,y)$。该智能体仅使用指定邻域内的样本和线性平面拟合来估计局部梯度 $\\nabla c$。所考虑的邻域为 von Neumann 邻域（四个基本方向的邻居）和 Moore 邻域（包括对角线方向的八个邻居）。设该估计方法定义为对测量到的浓度进行局部平面普通最小二乘拟合：\n$$\nc(x_0 + \\delta x, y_0 + \\delta y) \\approx \\beta_0 + g_x \\cdot \\delta x + g_y \\cdot \\delta y,\n$$\n其中 $\\beta_0$ 是截距，$(g_x, g_y)$ 是估计的梯度向量。拟合在所选邻域中的所有可用偏移量 $(\\delta x, \\delta y)$ 上进行，包括中心点 $(\\delta x, \\delta y) = (0,0)$。\n\n假设标量场 $c(x,y)$ 是一个平滑函数，其模型为\n$$\nc(x,y) = c_0 + \\alpha x + \\beta y + \\frac{1}{2}\\kappa_x x^2 + \\frac{1}{2}\\kappa_y y^2 + \\gamma x y,\n$$\n并且测量值受到均值为零、方差有限的独立加性噪声 $\\eta$ 的干扰，具体来说 $\\eta \\sim \\mathcal{N}(0,\\sigma^2)$，因此观测值为 $\\tilde{c}(x,y) = c(x,y) + \\eta$。在 $(x_0,y_0)$ 处的真实梯度为\n$$\n\\nabla c(x_0,y_0) = \\left(\\alpha + \\kappa_x x_0 + \\gamma y_0,\\ \\beta + \\kappa_y y_0 + \\gamma x_0\\right).\n$$\n\n您必须通过计算两种邻域下 $\\nabla c$ 估计量的偏差，来量化由邻域几何形状引起的梯度感知的离散近似误差。将偏差向量定义为\n$$\nb = \\mathbb{E}[\\hat{g}] - \\nabla c(x_0,y_0),\n$$\n其中 $\\hat{g} = (g_x, g_y)$ 是在给定邻域上使用 $\\tilde{c}$ 进行最小二乘拟合得到的估计量。由于该估计量对于测量浓度是线性的，因此含噪声场的期望偏差等于无噪声场的偏差。尽管如此，您必须使用在指定邻域几何上的精确最小二乘公式来计算期望偏差。报告每个邻域和每个测试用例的偏差的欧几里得范数 $\\|b\\|_2$。\n\n所有情况下均使用间距为 $\\Delta = 1$ 的晶格。对于 von Neumann 邻域，偏移量为 $(0,0)$, $(\\Delta,0)$, $(-\\Delta,0)$, $(0,\\Delta)$, $(0,-\\Delta)$。对于 Moore 邻域，偏移量为 $(0,0)$ 加上所有八种组合 $(\\pm\\Delta,0)$、$(0,\\pm\\Delta)$ 和 $(\\pm\\Delta,\\pm\\Delta)$。在边界受限的情况下，只包括那些在以 $(x_0,y_0)$ 平移后仍在定义域内的偏移量。\n\n测试套件包含以下四个参数集，涵盖了一般情况、曲率引起的偏差、交叉项各向异性以及边界截断边缘情况：\n\n- 测试用例 1 (一般线性场):\n  - $\\alpha = 1.25$, $\\beta = -0.75$, $\\kappa_x = 0.0$, $\\kappa_y = 0.0$, $\\gamma = 0.0$, $c_0 = 0.0$, $\\sigma = 0.2$,\n  - $(x_0,y_0) = (0.3,-0.2)$,\n  - 定义域：无限平面（无截断）。\n\n- 测试用例 2 (各向异性曲率):\n  - $\\alpha = 0.8$, $\\beta = -0.3$, $\\kappa_x = 0.6$, $\\kappa_y = -0.4$, $\\gamma = 0.0$, $c_0 = 1.0$, $\\sigma = 0.2$,\n  - $(x_0,y_0) = (-0.1,0.25)$,\n  - 定义域：无限平面。\n\n- 测试用例 3 (带偏移中心的交叉项各向异性):\n  - $\\alpha = -0.4$, $\\beta = 0.9$, $\\kappa_x = 0.0$, $\\kappa_y = 0.0$, $\\gamma = 0.8$, $c_0 = 0.5$, $\\sigma = 0.3$,\n  - $(x_0,y_0) = (0.5,-0.5)$,\n  - 定义域：无限平面。\n\n- 测试用例 4 (四分之一平面中的边界截断):\n  - $\\alpha = 0.2$, $\\beta = 0.7$, $\\kappa_x = 1.2$, $\\kappa_y = -0.9$, $\\gamma = 0.3$, $c_0 = -0.1$, $\\sigma = 0.25$,\n  - $(x_0,y_0) = (0.0,0.0)$,\n  - 定义域：四分之一平面，约束条件为 $x \\ge 0$, $y \\ge 0$。\n\n实现要求：\n- 为所选邻域中包含的每个偏移量 $(\\delta x,\\delta y)$ 构建设计矩阵 $X$，其行向量为 $[1,\\ \\delta x,\\ \\delta y]$。使用无噪声的 $c(x_0+\\delta x, y_0+\\delta y)$ 构建响应向量 $y$。最小二乘解为\n$$\n\\begin{bmatrix}\n\\hat{\\beta}_0 \\\\\n\\hat{g}_x \\\\\n\\hat{g}_y\n\\end{bmatrix}\n=\n(X^\\top X)^{-1} X^\\top y.\n$$\n- 使用上面给出的 $\\nabla c(x_0,y_0)$ 的解析表达式计算在 $(x_0,y_0)$ 处的真实梯度。\n- 计算偏差向量 $b = \\hat{g} - \\nabla c(x_0,y_0)$ 并报告每个邻域的欧几里得范数 $\\|b\\|_2$。\n\n您的程序应生成单行输出，其中包含结果，格式为方括号括起来的逗号分隔列表，顺序如下：\n$$\n[\\|b\\|_2^{\\text{VN},1},\\ \\|b\\|_2^{\\text{MO},1},\\ \\|b\\|_2^{\\text{VN},2},\\ \\|b\\|_2^{\\text{MO},2},\\ \\|b\\|_2^{\\text{VN},3},\\ \\|b\\|_2^{\\text{MO},3},\\ \\|b\\|_2^{\\text{VN},4},\\ \\|b\\|_2^{\\text{MO},4}],\n$$\n其中 $\\text{VN}$ 表示 von Neumann 邻域，$\\text{MO}$ 表示 Moore 邻域，上标表示测试用例编号。将每个浮点值四舍五入到六位小数。不应打印任何其他输出。", "solution": "该问题要求量化二维标量场局部梯度估计量的偏差。该估计量是通过在两个不同的细胞自动机邻域（von Neumann 邻域和 Moore 邻域）上使用普通最小二乘法 (OLS) 进行线性平面拟合得出的。\n\n首先，我们将问题形式化。标量场由一个二阶多项式给出：\n$$\nc(x,y) = c_0 + \\alpha x + \\beta y + \\frac{1}{2}\\kappa_x x^2 + \\frac{1}{2}\\kappa_y y^2 + \\gamma x y\n$$\n在点 $(x_0, y_0)$ 处的真实梯度是在该点求值的一阶偏导数向量：\n$$\n\\nabla c(x_0,y_0) = \\left( \\frac{\\partial c}{\\partial x}, \\frac{\\partial c}{\\partial y} \\right)\\bigg|_{(x_0, y_0)} = \\begin{pmatrix} \\alpha + \\kappa_x x_0 + \\gamma y_0 \\\\ \\beta + \\kappa_y y_0 + \\gamma x_0 \\end{pmatrix}\n$$\n梯度是通过在 $(x_0, y_0)$ 周围邻域中的一组点上对场进行采样来估计的。这些采样点通过其相对于中心的偏移量 $(\\delta x_i, \\delta y_i)$ 进行索引，因此测量在 $(x_0 + \\delta x_i, y_0 + \\delta y_i)$ 处进行。对这些测量值拟合一个线性平面：\n$$\nc(x_0 + \\delta x_i, y_0 + \\delta y_i) \\approx \\hat{\\beta}_0 + \\hat{g}_x \\delta x_i + \\hat{g}_y \\delta y_i\n$$\n这构成了一个线性回归问题。设估计参数的向量为 $\\hat{\\theta} = [\\hat{\\beta}_0, \\hat{g}_x, \\hat{g}_y]^\\top$。设计矩阵 $X$ 的构造方式是，其第 $i$ 行为 $[1, \\delta x_i, \\delta y_i]$。响应向量 $y$ 包含在采样点处的场值 $y_i = c(x_0 + \\delta x_i, y_0 + \\delta y_i)$。参数的 OLS 解为：\n$$\n\\hat{\\theta} = (X^\\top X)^{-1} X^\\top y\n$$\n估计梯度为 $\\hat{g} = [\\hat{g}_x, \\hat{g}_y]^\\top$，它对应于 $\\hat{\\theta}$ 的第二和第三个分量。\n\n问题陈述，尽管测量值含噪声，即 $\\tilde{c} = c + \\eta$ 且 $\\mathbb{E}[\\eta]=0$，但偏差可以使用无噪声场 $c(x,y)$ 来计算。这是因为 OLS 估计量是线性的，所以将估计量应用于含噪声数据的期望值，等于将估计量应用于数据期望值的结果：$\\mathbb{E}[\\hat{\\theta}] = (X^\\top X)^{-1} X^\\top \\mathbb{E}[\\tilde{y}] = (X^\\top X)^{-1} X^\\top y$。因此，偏差向量为 $b = \\hat{g} - \\nabla c(x_0,y_0)$，其中 $\\hat{g}$ 是使用无噪声场值计算的。\n\n偏差源于模型设定错误：我们正在将一个线性模型拟合到由一个二次函数生成的数据上。让我们来分析响应值 $y_i$：\n$$\ny_i = c(x_0 + \\delta x_i, y_0 + \\delta y_i) = c_0 + \\alpha(x_0+\\delta x_i) + \\beta(y_0+\\delta y_i) + \\frac{1}{2}\\kappa_x(x_0+\\delta x_i)^2 + \\frac{1}{2}\\kappa_y(y_0+\\delta y_i)^2 + \\gamma(x_0+\\delta x_i)(y_0+\\delta y_i)\n$$\n将其展开并按 $\\delta x_i$ 和 $\\delta y_i$ 的幂次分组：\n$$\ny_i = c(x_0, y_0) + (\\alpha + \\kappa_x x_0 + \\gamma y_0)\\delta x_i + (\\beta + \\kappa_y y_0 + \\gamma x_0)\\delta y_i + \\left( \\frac{1}{2}\\kappa_x \\delta x_i^2 + \\frac{1}{2}\\kappa_y \\delta y_i^2 + \\gamma \\delta x_i \\delta y_i \\right)\n$$\n这可以写成 $y_i = \\theta_{\\text{true}}^\\top [1, \\delta x_i, \\delta y_i]^\\top + E_i$，其中 $\\theta_{\\text{true}} = [c(x_0,y_0), \\nabla c(x_0,y_0)_x, \\nabla c(x_0,y_0)_y]^\\top$，$E_i$ 是来自未建模的二次分量的误差项。估计量的偏差为 $b_\\theta = \\hat{\\theta} - \\theta_{\\text{true}} = (X^\\top X)^{-1} X^\\top E$，其中 $E$ 是误差项 $E_i$ 的向量。\n\n对于无限定义域的情况（测试用例 1、2 和 3），von Neumann 和 Moore 邻域都关于原点对称。偏移量集合 $\\{\\delta x_i\\}$ 和 $\\{\\delta y_i\\}$ 具有一些性质，例如如果 $p$ 或 $q$ 是奇数，则 $\\sum_i \\delta x_i^p \\delta y_i^q = 0$。这种对称性导致 $X^\\top X$ 的非对角线项为零，使其成为一个对角矩阵。更重要的是，在 $X^\\top E$ 中那些会在梯度分量中产生偏差的项会变为零。例如，$\\hat{g}_x$ 中的偏差取决于 $\\sum_i \\delta x_i E_i$：\n$$\n\\sum_i \\delta x_i E_i = \\sum_i \\delta x_i \\left( \\frac{1}{2}\\kappa_x \\delta x_i^2 + \\frac{1}{2}\\kappa_y \\delta y_i^2 + \\gamma \\delta x_i \\delta y_i \\right) = \\frac{\\kappa_x}{2} \\sum_i \\delta x_i^3 + \\frac{\\kappa_y}{2} \\sum_i \\delta x_i \\delta y_i^2 + \\gamma \\sum_i \\delta x_i^2 \\delta y_i\n$$\n由于邻域的点对称性，所有这些和都为零。因此，对于对称模板，二次场的梯度的 OLS 估计是精确的，偏差为零。这适用于测试用例 1、2 和 3 的两种邻域。\n\n对于测试用例 4，智能体位于 $(x_0,y_0) = (0,0)$，其定义域限制在第一象限 ($x \\ge 0, y \\ge 0$)。这会截断邻域，破坏它们的对称性。\n- Von Neumann (VN)：偏移量为 $\\{(0,0), (\\Delta,0), (-\\Delta,0), (0,\\Delta), (0,-\\Delta)\\}$，其中 $\\Delta=1$。这些点必须满足 $x_0+\\delta x \\ge 0$ 和 $y_0+\\delta y \\ge 0$。当 $(x_0,y_0)=(0,0)$ 时，这意味着 $\\delta x \\ge 0$ 和 $\\delta y \\ge 0$。有效的偏移量为 $\\{(0,0), (1,0), (0,1)\\}$。\n- Moore (MO)：所有八个邻居加上中心点。有效的偏移量为 $\\{(0,0), (1,0), (0,1), (1,1)\\}$。\n\n由于这些截断的邻域是非对称的，偏差计算中的那些和不再为零，从而导致一个依赖于二次系数 $\\kappa_x, \\kappa_y, \\gamma$ 的非零偏差。\n\n计算过程如下：\n1. 对于每个测试用例，定义参数 $(\\alpha, \\beta, \\kappa_x, \\kappa_y, \\gamma, c_0)$ 和中心点 $(x_0, y_0)$。定义定义域约束。\n2. 对于每种邻域类型 (VN, MO)：\n   a. 定义 $\\Delta=1$ 时的完整偏移量集合 $(\\delta x, \\delta y)$。\n   b. 筛选偏移量，只包括那些使得 $(x_0+\\delta x, y_0+\\delta y)$ 位于指定定义域内的偏移量。\n   c. 对于每个有效的偏移量，构建设计矩阵 $X$，其行向量为 $[1, \\delta x_i, \\delta y_i]$。\n   d. 通过为每个有效偏移量计算 $y_i = c(x_0+\\delta x_i, y_0+\\delta y_i)$ 来构建响应向量 $y$。\n   e. 求解线性最小二乘问题以得到系数 $\\hat{\\theta} = [\\hat{\\beta}_0, \\hat{g}_x, \\hat{g}_y]^\\top$。使用像 `numpy.linalg.lstsq` 这样数值稳健的方法是合适的。\n   f. 提取估计梯度 $\\hat{g} = [\\hat{g}_x, \\hat{g}_y]^\\top$。\n   g. 使用其解析公式计算真实梯度 $\\nabla c(x_0,y_0)$。\n   h. 计算偏差向量 $b = \\hat{g} - \\nabla c(x_0,y_0)$。\n   i. 计算偏差的欧几里得范数 $\\|b\\|_2$，并将其存储。\n3. 收集所有 8 个得到的偏差范数，并按指定格式进行格式化。", "answer": "[0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.860233,0.300000]", "id": "3293950"}, {"introduction": "对空间系统进行建模的一个主要挑战是捕捉局部相互作用和空间相关性的影响。本练习将一个简单的平均场模型（忽略空间结构）与一个更精确的对近似模型（考虑了最近邻相关性）以及一个完整的蒙特卡洛模拟进行对比。通过这个练习，您将清晰地看到简单解析模型的局限性，并理解为何需要通过模拟和更高阶的近似方法来捕捉真实的群体空间动态。 [@problem_id:3293915]", "problem": "考虑一个在具有冯·诺依曼邻域（每个位置有 $z=4$ 个最近邻）的周期性方形晶格上的单物种概率细胞自动机（PCA）。在离散时间 $t$，每个晶格位置要么被一个细胞占据（$1$），要么为空（$0$）。从时间 $t$ 到时间 $t+1$ 的同步更新包含以下按顺序应用于整个晶格的子步骤：(i) 死亡，(ii) 出生，(iii) 移动。在给定当前构型的情况下，所有事件在指定时都是条件独立的，并且所有随机选择都是均匀的。\n\n死亡子步骤：每个被占据的位置独立地以概率 $d \\in [0,1]$ 变为空。\n\n出生子步骤：对于每个空位置，令 $K$ 表示死亡子步骤后被占据的最近邻的数量。该位置以概率 $1 - (1 - \\beta)^{K}$ 被占据，其中 $\\beta \\in [0,1]$ 是每个邻居的定殖概率。\n\n移动子步骤：每个被占据的位置独立地以概率 $m \\in [0,1]$ 尝试移动到一个均匀随机选择的空最近邻。如果多个被占据的位置以同一个空邻居为目标，则从中均匀随机选择一个移动，其余的保持不动。移动子步骤保持被占据位置的总数不变。\n\n令 $u_t$ 表示占有率，即在时间 $t$ 一个均匀随机选择的位置被占据的概率。令 $C_{NN,t}$ 表示最近邻占据相关性，即在时间 $t$ 一条均匀随机选择的无向最近邻边的两端都被占据的概率。\n\n任务 A（平均场递推的推导）：从位置间的统计独立性假设（无空间相关性）和独立性下占据邻居数量的二项分布定律出发，根据上述更新顺序，推导出 $u_{t+1}$ 作为 $u_t$、$d$、$\\beta$ 和 $z$ 的函数的递推关系。您的推导必须明确地从死亡和出生机制开始，并且不得假定任何关于 $u_{t+1}$ 的预先存在的公式。\n\n任务 B（包含最近邻相关性的对近似）：通过引入最近邻相关性 $C_{NN,t}$ 来放宽独立性假设。令 $u_t^D = u_t (1 - d)$ 和 $C_{NN,t}^D = C_{NN,t} (1 - d)^2$ 分别表示死亡子步骤后的占有率和最近邻相关性。在对近似（该近似假定在给定中心位置状态的情况下，除一个指定邻居外的其他 $z-1$ 个邻居是条件独立的）下，将一个空位置的最近邻被占据的条件概率 $q_t^D$ 表示为 $q_t^D = (u_t^D - C_{NN,t}^D) / (1 - u_t^D)$，并推导：\n- 使用对近似下 $K$ 的二项分布定律，推导出 $u_{t+1}$ 关于 $u_t^D$、$q_t^D$ 和 $z$ 的递推关系，\n- 对于特殊情况 $m=0$，通过枚举死亡后所有最近邻对类型及其在出生后的转变，构建 $C_{NN,t+1}$ 的递推关系。使用以下 $z=4$ 的分解：令 $p_{11}^D=C_{NN,t}^D$，$p_{10}^D = u_t^D - C_{NN,t}^D$ 和 $p_{00}^D = 1 - 2 u_t^D + C_{NN,t}^D$，定义 $E_t = 1 - [1 - \\beta q_t^D]^{z-1}$ 和 $\\Phi_t = 1 - (1 - \\beta) [1 - \\beta q_t^D]^{z-1}$，然后近似 $C_{NN,t+1} \\approx C_{NN,t}^{B} = p_{11}^D + 2 p_{10}^D \\,\\Phi_t + p_{00}^D \\, E_t^2$，该近似假设在给定周围邻域的情况下，一个 $00$ 对的两个位置的定殖事件是独立的（对于冯·诺依曼邻域，这是精确的，因为相邻位置除了彼此之外没有共同的邻居）。对于一般的 $m \\in [0,1]$，论证一个形式为 $C_{NN,t+1} \\approx (1 - m)\\, C_{NN,t}^{B} + m \\, u_{t+1}^2$ 的简单混合去相关近似，用于移动子步骤，该近似保持边际占有率，并在纯出生-死亡动力学（$m=0$）和完全混合的边（$m=1$）之间进行插值。\n\n任务 C（改进的量化）：实现一个程序，该程序：\n- 通过从初始值 $u_0 \\in (0,1)$ 开始迭代平均场递推直至收敛，计算平均场不动点 $u^\\ast_{\\mathrm{MF}}$，\n- 通过从初始值 $(u_0, C_{NN,0})$（其中 $C_{NN,0}$ 初始化为 $u_0^2$）开始迭代耦合的 $(u_t, C_{NN,t})$ 递推直至收敛，计算对近似不动点 $u^\\ast_{\\mathrm{PA}}$，\n- 在边长为 $L$ 的周期性方形晶格上，从随机初始占有率 $u_0$ 开始，运行 PCA 的蒙特卡洛模拟 $T$ 步，对最后 $B$ 步的占有率进行平均以估计 $u^\\ast_{\\mathrm{sim}}$（在 $R$ 次独立运行中取平均值），以及\n- 对于每组参数，报告对近似相对于平均场近似在绝对误差上实现的改进，定义为 $\\Delta = |u^\\ast_{\\mathrm{MF}} - u^\\ast_{\\mathrm{sim}}| - |u^\\ast_{\\mathrm{PA}} - u^\\ast_{\\mathrm{sim}}|$。\n\n您的程序必须生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，顺序与下面的测试用例一致。每个结果都必须是一个实数。\n\n使用以下参数集测试套件，以 $(\\beta, d, m, L, T, B, R)$ 表示：\n- 情况 A（一般非平凡占有率）：$(0.25, 0.2, 0, 64, 600, 400, 3)$\n- 情况 B（接近灭绝）：$(0.05, 0.5, 0, 64, 600, 400, 3)$\n- 情况 C（高占有率）：$(0.6, 0.05, 0, 64, 600, 400, 3)$\n- 情况 D（接近平均场阈值 $\\beta z \\approx d$）：$(0.1, 0.4, 0, 64, 600, 400, 3)$\n\n角度单位不适用。不涉及物理单位。最终输出格式必须是 $[r_1,r_2,r_3,r_4]$ 形式的单行，其中每个 $r_i$ 是相应情况下的改进量 $\\Delta$。", "solution": "该问题是有效的，因为它在计算系统生物学领域提出了一个定义明确、有科学依据的任务，没有矛盾或含糊之处。\n\n该问题要求对晶格上单个生物物种的概率细胞自动机（PCA）模型进行三部分分析。这些任务涉及在平均场和对近似下的解析推导，以及与直接模拟的数值比较。\n\n### 任务 A：平均场递推推导\n\n目标是推导占有率 $u_{t+1}$ 作为 $u_t$、死亡概率 $d$、定殖概率 $\\beta$ 和邻居数 $z$ 的函数的递推关系。平均场近似假设所有晶格位置的状态是统计独立的。\n\n令 $u_t$ 为在时间 $t$ 一个随机位置被占据的概率。动力学按子步骤进行。\n\n1.  **死亡子步骤：** 每个被占据的位置以概率 $d$ 变为空。在时间 $t$ 被占据的位置在死亡子步骤后以概率 $1-d$ 保持被占据。由于独立性假设，紧随死亡之后被占据位置的密度，记为 $u_t^D$，是：\n    $$u_t^D = u_t (1 - d)$$\n    死亡后的空位置密度是 $1 - u_t^D$。\n\n2.  **出生子步骤：** 一个空位置可以被占据。移动子步骤发生在出生之后，并保持被占据位置的总数不变。因此，密度 $u_{t+1}$ 完全由出生子步骤后的系统状态决定。\n    \n    一个在死亡子步骤后为空的位置，如果它被其至少一个被占据的邻居成功定殖，则将在时间 $t+1$ 变为被占据。令 $K$ 为一个空位置的被占据邻居的数量。定殖的概率由 $1-(1-\\beta)^K$ 给出。\n\n    在平均场假设下，每个邻居的状态都与其他邻居以及中心位置的状态无关。任何给定邻居被占据（在死亡步骤后）的概率是 $u_t^D$。对于一个大小为 $z$ 的邻域，被占据邻居的数量 $K$ 服从二项分布，$K \\sim B(z, u_t^D)$，其概率质量函数为 $P(K=k) = \\binom{z}{k} (u_t^D)^k (1 - u_t^D)^{z-k}$。\n\n    一个空位置（死亡后）*保持*为空的概率是未被定殖的概率，对所有可能的 $K$ 值取平均：\n    $$P(\\text{空位置保持为空}) = \\sum_{k=0}^{z} P(K=k) (1-\\beta)^k$$\n    $$P(\\text{空位置保持为空}) = \\sum_{k=0}^{z} \\binom{z}{k} (u_t^D)^k (1 - u_t^D)^{z-k} (1-\\beta)^k$$\n    这个和可以被识别为一个二项式展开：\n    $$P(\\text{空位置保持为空}) = \\sum_{k=0}^{z} \\binom{z}{k} [u_t^D(1-\\beta)]^k (1 - u_t^D)^{z-k} = [u_t^D(1-\\beta) + (1-u_t^D)]^z = [1 - \\beta u_t^D]^z$$\n    因此，一个空位置变为被占据的概率是：\n    $$P(\\text{出生}) = 1 - [1 - \\beta u_t^D]^z$$\n\n3.  **完整递推：** 在时间 $t+1$ 的总占有率是被占据并存活下来的位置密度，加上死亡后为空然后经历出生事件的位置密度的总和。\n    $$u_{t+1} = (\\text{幸存者密度}) + (\\text{空位置密度}) \\times P(\\text{出生})$$\n    $$u_{t+1} = u_t^D + (1 - u_t^D) \\left( 1 - [1 - \\beta u_t^D]^z \\right)$$\n    代入 $u_t^D = u_t(1-d)$，我们得到最终的平均场递推关系：\n    $$u_{t+1} = u_t(1-d) + (1 - u_t(1-d)) \\left( 1 - \\left[1 - \\beta u_t(1-d)\\right]^z \\right)$$\n\n### 任务 B：对近似\n\n这个任务通过引入最近邻相关性 $C_{NN,t}$ 来放宽平均场假设。冯·诺依曼邻域有 $z=4$。\n\n1.  **$u_{t+1}$ 的递推关系：**\n    推导的结构与平均场情况类似，但邻居被占据的概率现在是条件性的。\n    死亡步骤后，占有率为 $u_t^D = u_t(1-d)$，最近邻相关性为 $C_{NN,t}^D = C_{NN,t}(1-d)^2$。\n\n    我们考虑一个空位置。对近似假设在给定中心位置状态的情况下，其 $z$ 个邻居是条件独立的。关键量是 $q_t^D$，即死亡步骤后，一个空位置的邻居被占据的条件概率。问题为此提供了标准表达式：\n    $$q_t^D = P(\\text{邻居为 } 1 | \\text{中心为 } 0) = \\frac{P(1, 0)}{P(0)} = \\frac{u_t^D - C_{NN,t}^D}{1 - u_t^D}$$\n    因此，一个空位置的被占据邻居数量 $K$ 服从二项分布 $K \\sim B(z, q_t^D)$。\n    \n    这个空位置变为被占据（出生事件）的概率是：\n    $$P(\\text{出生}) = 1 - \\sum_{k=0}^{z} \\binom{z}{k} (q_t^D)^k (1-q_t^D)^{z-k} (1-\\beta)^k = 1 - [1 - \\beta q_t^D]^z$$\n    在对近似下，占有率 $u_{t+1}$ 的递推关系为：\n    $$u_{t+1} = u_t^D + (1 - u_t^D) \\left( 1 - [1 - \\beta q_t^D]^z \\right)$$\n\n2.  **$C_{NN,t+1}$ 的递推关系（对于 $m=0$）：**\n    对于没有移动的情况（$m=0$），出生后的相关性 $C_{NN,t}^B$ 即为最终的相关性 $C_{NN,t+1}$。问题提供了 $C_{NN,t}^B$ 的公式，该公式由死亡后对构型的概率（$p_{11}^D, p_{10}^D, p_{00}^D$）和与定殖概率相关的项（$E_t, \\Phi_t$）构建。\n\n    对于 $m=0$ 的对近似的完整迭代系统如下：\n    给定 $(u_t, C_{NN,t})$ 和参数 $(d, \\beta, z=4)$：\n    a. 计算死亡后量：\n        $$u_t^D = u_t(1-d)$$\n        $$C_{NN,t}^D = C_{NN,t}(1-d)^2$$\n    b. 计算辅助量：\n        - 如果 $u_t^D  1$：$q_t^D = (u_t^D - C_{NN,t}^D) / (1 - u_t^D)$。否则，由于没有空位置，$q_t^D=0$。\n        - $p_{11}^D = C_{NN,t}^D$\n        - $p_{10}^D = u_t^D - C_{NN,t}^D$\n        - $p_{00}^D = 1 - 2u_t^D + C_{NN,t}^D$\n        - $E_t = 1 - [1 - \\beta q_t^D]^{z-1}$（定殖一个空位置旁边的空位置的概率）\n        - $\\Phi_t = 1 - (1 - \\beta) [1 - \\beta q_t^D]^{z-1}$（定殖一个被占据位置旁边的空位置的概率）\n    c. 更新时间 $t+1$ 的状态变量：\n        $$u_{t+1} = u_t^D + (1 - u_t^D) \\left( 1 - [1 - \\beta q_t^D]^z \\right)$$\n        $$C_{NN,t+1} = p_{11}^D + 2 p_{10}^D \\Phi_t + p_{00}^D E_t^2$$\n\n3.  **关于移动步骤的论证（$m > 0$）：**\n    对于一般的移动概率 $m$，问题建议使用以下近似：\n    $$C_{NN,t+1} \\approx (1 - m)\\, C_{NN,t}^{B} + m \\, u_{t+1}^2$$\n    这个方程可以被解释为一个简单的线性混合模型。\n    -   $C_{NN,t}^B$ 代表在任何移动发生之前，由出生-死亡动力学建立的相关性。\n    -   移动步骤涉及一部分比例为 $m$ 的被占据细胞尝试移动到一个随机的空邻居。这个过程破坏了现有的空间相关性并形成新的相关性。\n    -   项 $(1 - m) C_{NN,t}^B$ 表示被假定为“不受”移动影响的细胞对对最终相关性的贡献。它模拟了移动前相关性中有一部分 $(1-m)$ 被保留下来。\n    -   项 $m u_{t+1}^2$ 表示由移动“重新混合”的对所做的贡献。它假设当一对中的一个细胞移动时，局部相关性被破坏并重置为平均场值，即全局密度的平方 $u_{t+1}^2$。密度 $u_{t+1}$ 是正确的，因为移动保持了被占据位置的数量。\n    -   这个模型正确地在两个极端情况之间进行插值：\n        -   如果 $m=0$（无移动），$C_{NN,t+1} = C_{NN,t}^B$，恢复到出生-死亡动力学。\n        -   如果 $m=1$（最大混合），$C_{NN,t+1} = u_{t+1}^2$，这对应于密度为 $u_{t+1}$ 的细胞在空间上不相关（随机）的分布。\n    这种启发式方法提供了一种合理且计算简单的方式来解释细胞移动的去相关效应。\n\n### 任务 C：改进的量化\n平均场求解器、对近似求解器和蒙特卡洛模拟的实现在最终答案块中提供。代码从这三种方法中的每一种计算稳态占有率 $u^\\ast$，并报告绝对误差的改进量 $\\Delta = |u^\\ast_{\\mathrm{MF}} - u^\\ast_{\\mathrm{sim}}| - |u^\\ast_{\\mathrm{PA}} - u^\\ast_{\\mathrm{sim}}|$。", "answer": "[0.04639459,0.00000000,0.06377755,0.00000000]", "id": "3293915"}]}