{"hands_on_practices": [{"introduction": "任何全细胞模型的核心都是对细胞资源（如能量和物质）的精确核算。本练习将引导你完成一项基础而关键的计算：建立一个最小细胞在稳态生长下的能量收支平衡。通过应用质量平衡原理 [@problem_id:3358581]，你将计算出维持关键细胞过程（如转录、翻译和主动运输）所需的最小ATP通量，从而对细胞的能量经济学有一个定量的认识。", "problem": "考虑一个处于平衡指数生长状态下的最小全细胞模型，其中细胞内的三磷酸腺苷 (ATP) 池处于稳态。使用基于质量守恒和平衡生长定义的 ATP 质量平衡公式：在稳态下，细胞内 ATP 总量的时间导数为零，因此 ATP 的生成必须等于细胞过程消耗的 ATP 总和，加上因生长引起的细胞内 ATP 池的稀释。细胞以特定速率执行以下过程：核糖核酸 (RNA) 转录、蛋白质翻译以及两种溶质的主动转运。基本的能量假设是：转录每掺入一个核苷酸消耗一个核苷三磷酸；任何核苷三磷酸（ATP、三磷酸鸟苷 (GTP)、三磷酸尿苷、三磷酸胞苷）的能量成本都可以通过核苷二磷酸激酶 (NDPK) 及相关磷酸化反应以 1:1 的成本表示为 ATP 当量；氨酰-tRNA 装载每掺入一个氨基酸消耗两个 ATP 当量（ATP 转化为单磷酸腺苷计为两个高能磷酸键）；在翻译过程中，每个肽键的形成消耗两个 GTP，而每个起始事件消耗一个 GTP，所有这些都以 1:1 的成本计为 ATP 当量。每种溶质的主动转运会消耗固定数量的 ATP 分子。稀释项源于比生长速率为 $\\mu$ 的指数生长作用于细胞内 ATP 总量，而 ATP 总量是 ATP 浓度与细胞体积的乘积。\n\n参数：\n- 比生长速率 $\\mu = 1.00 \\times 10^{-4}\\ \\mathrm{s^{-1}}$。\n- 细胞内 ATP 浓度 $C_{\\mathrm{ATP}} = 3.00 \\times 10^{-3}\\ \\mathrm{mol\\ L^{-1}}$。\n- 细胞体积 $V_{\\mathrm{cell}} = 1.00 \\times 10^{-15}\\ \\mathrm{L}$。\n- 总转录延伸速率（整个基因组每秒掺入的核苷酸数）$R_{\\mathrm{nt}} = 1.20 \\times 10^{5}\\ \\mathrm{s^{-1}}$；假设每掺入一个核苷酸的成本为 1 个 ATP 当量。\n- 总翻译延伸速率（所有核糖体每秒掺入的氨基酸数）$R_{\\mathrm{aa}} = 5.00 \\times 10^{4}\\ \\mathrm{s^{-1}}$。\n- 每秒多肽起始事件数 $R_{\\mathrm{init}} = 2.00 \\times 10^{2}\\ \\mathrm{s^{-1}}$；假设每个肽键消耗 2 个 GTP，每次起始消耗 1 个 GTP，所有这些都通过 NDPK 以 1:1 的成本计为 ATP 当量。\n- 主动转运通量：溶质 A 以 $R_{A} = 8.00 \\times 10^{4}\\ \\mathrm{s^{-1}}$ 的速率输入，每个分子成本为 1 个 ATP；溶质 B 以 $R_{B} = 2.00 \\times 10^{4}\\ \\mathrm{s^{-1}}$ 的速率输入，每个分子成本为 1 个 ATP。\n- 阿伏伽德罗常数 $N_{\\mathrm{A}} = 6.022 \\times 10^{23}\\ \\mathrm{mol^{-1}}$。\n\n仅使用稳态质量平衡原理和上述化学计量 ATP 当量成本，计算维持这些过程在稳态下（包括稀释）所需的最小 ATP 生成通量 $J_{\\mathrm{ATP}}^{\\min}$。将 $J_{\\mathrm{ATP}}^{\\min}$ 以每个细胞的 $\\mathrm{mol\\ s^{-1}}$ 为单位表示，并将您的答案四舍五入到四位有效数字。", "solution": "本问题已经过验证。\n\n### 步骤 1：提取已知条件\n-   比生长速率：$\\mu = 1.00 \\times 10^{-4}\\ \\mathrm{s^{-1}}$\n-   细胞内 ATP 浓度：$C_{\\mathrm{ATP}} = 3.00 \\times 10^{-3}\\ \\mathrm{mol\\ L^{-1}}$\n-   细胞体积：$V_{\\mathrm{cell}} = 1.00 \\times 10^{-15}\\ \\mathrm{L}$\n-   总转录延伸速率：$R_{\\mathrm{nt}} = 1.20 \\times 10^{5}\\ \\mathrm{s^{-1}}$\n-   转录成本：每个核苷酸 1 个 ATP 当量\n-   总翻译延伸速率：$R_{\\mathrm{aa}} = 5.00 \\times 10^{4}\\ \\mathrm{s^{-1}}$\n-   氨酰-tRNA 装载成本：每个氨基酸 2 个 ATP 当量\n-   翻译肽键形成成本：每个肽键 2 个 GTP (ATP 当量)\n-   每秒多肽起始事件数：$R_{\\mathrm{init}} = 2.00 \\times 10^{2}\\ \\mathrm{s^{-1}}$\n-   翻译起始成本：每次起始 1 个 GTP (ATP 当量)\n-   主动转运通量，溶质 A：$R_{A} = 8.00 \\times 10^{4}\\ \\mathrm{s^{-1}}$\n-   转运 A 的成本：每个分子 1 个 ATP\n-   主动转运通量，溶质 B：$R_{B} = 2.00 \\times 10^{4}\\ \\mathrm{s^{-1}}$\n-   转运 B 的成本：每个分子 1 个 ATP\n-   阿伏伽德罗常数：$N_{\\mathrm{A}} = 6.022 \\times 10^{23}\\ \\mathrm{mol^{-1}}$\n-   原理：ATP 的稳态质量平衡，$\\frac{d(\\text{ATP})}{dt} = 0$，其中 ATP 的生成等于消耗加稀释。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，设定良好且客观。\n1.  **科学或事实不健全性**：该问题基于生物化学计量学和稳态动力学（质量平衡）的基本原理，这些是系统生物学的基石。转录和翻译的能量成本是该领域公认的标准值。为最小细胞模型提供的参数（例如，细胞体积、浓度、生长速率）对于微生物细胞来说在生物化学和物理上都是合理的。\n2.  **非形式化或不相关**：该问题与计算系统生物学中的全细胞和最小细胞建模主题直接相关。这是一个形式化的定量问题。\n3.  **不完整或矛盾的设置**：该问题是自洽的。它明确列出了所有需要考虑 ATP 消耗的细胞过程，允许根据所提供的数据进行完整计算。没有矛盾之处。\n4.  **不切实际或不可行**：所有参数在物理上和量纲上都是一致的。速率以每秒事件数为单位，成本以每个事件为单位，最终要求的通量以摩尔每秒为单位，这可以通过使用阿伏伽德罗常数来实现。\n5.  **不适定或结构不良**：该问题是适定的，具有明确的目标和足够的数据以得出唯一、有意义的解。\n6.  **伪深刻、琐碎或同义反复**：该问题需要一个仔细、多步骤的计算，涉及多个不同生物物理过程的总和。这是对第一性原理的非平凡应用。\n7.  **超出科学可验证性**：其声明和计算完全在标准科学验证的范围内。\n\n### 步骤 3：结论和行动\n问题有效。将提供完整解答。\n\n此问题的核心在于稳态下细胞内 ATP 池的质量平衡原理。在平衡指数生长条件下，细胞中 ATP 总量 $N_{\\mathrm{ATP}}$ 的时间导数为零。质量平衡方程为：\n$$\n\\frac{dN_{\\mathrm{ATP}}}{dt} = J_{\\mathrm{ATP}}^{\\mathrm{prod}} - J_{\\mathrm{ATP}}^{\\mathrm{cons}} - J_{\\mathrm{ATP}}^{\\mathrm{dilution}} = 0\n$$\n其中 $J_{\\mathrm{ATP}}^{\\mathrm{prod}}$ 是 ATP 的生成速率，$J_{\\mathrm{ATP}}^{\\mathrm{cons}}$ 是细胞过程消耗 ATP 的速率，而 $J_{\\mathrm{ATP}}^{\\mathrm{dilution}}$ 是由于生长过程中细胞体积增加而导致的 ATP 稀释速率。所有通量的单位均为 $\\mathrm{mol\\ s^{-1}}$。问题要求的是最小 ATP 生成通量 $J_{\\mathrm{ATP}}^{\\min}$，即平衡消耗所需的速率：\n$$\nJ_{\\mathrm{ATP}}^{\\min} = J_{\\mathrm{ATP}}^{\\mathrm{cons}} + J_{\\mathrm{ATP}}^{\\mathrm{dilution}}\n$$\n我们将分别计算右侧的每一项。\n\n首先，我们计算总消耗通量 $J_{\\mathrm{ATP}}^{\\mathrm{cons}}$。这是转录、翻译和主动转运所消耗的 ATP 总和。速率以每秒事件数（例如，每秒核苷酸数）给出。我们将首先计算以每秒 ATP 分子数为单位的总消耗速率，记为 $R_{\\mathrm{ATP}}^{\\mathrm{cons}}$，然后使用阿伏伽德罗常数 $N_{\\mathrm{A}}$ 将其转换为摩尔通量。\n$$\nJ_{\\mathrm{ATP}}^{\\mathrm{cons}} = \\frac{R_{\\mathrm{ATP}}^{\\mathrm{cons}}}{N_{\\mathrm{A}}}\n$$\n总速率 $R_{\\mathrm{ATP}}^{\\mathrm{cons}}$ 是每个过程速率的总和：\n$$\nR_{\\mathrm{ATP}}^{\\mathrm{cons}} = R_{\\mathrm{ATP}}^{\\mathrm{transcription}} + R_{\\mathrm{ATP}}^{\\mathrm{translation}} + R_{\\mathrm{ATP}}^{\\mathrm{transport}}\n$$\n1.  **转录消耗速率 ($R_{\\mathrm{ATP}}^{\\mathrm{transcription}}$)**：成本是每掺入一个核苷酸消耗 1 个 ATP 当量。\n    $$\n    R_{\\mathrm{ATP}}^{\\mathrm{transcription}} = R_{\\mathrm{nt}} \\times 1 = 1.20 \\times 10^{5}\\ \\mathrm{s^{-1}}\n    $$\n2.  **翻译消耗速率 ($R_{\\mathrm{ATP}}^{\\mathrm{translation}}$)**：此成本包括三部分：氨酰-tRNA 装载（每个氨基酸 2 个 ATP）、起始（每个事件 1 个 ATP 当量）以及肽键形成/延伸（每个氨基酸 2 个 ATP 当量）。\n    $$\n    R_{\\mathrm{ATP}}^{\\mathrm{translation}} = (R_{\\mathrm{aa}} \\times 2) + (R_{\\mathrm{init}} \\times 1) + (R_{\\mathrm{aa}} \\times 2) = 4 R_{\\mathrm{aa}} + R_{\\mathrm{init}}\n    $$\n    代入给定值：\n    $$\n    R_{\\mathrm{ATP}}^{\\mathrm{translation}} = 4 \\times (5.00 \\times 10^{4}\\ \\mathrm{s^{-1}}) + (2.00 \\times 10^{2}\\ \\mathrm{s^{-1}}) = 2.00 \\times 10^{5}\\ \\mathrm{s^{-1}} + 200\\ \\mathrm{s^{-1}} = 2.002 \\times 10^{5}\\ \\mathrm{s^{-1}}\n    $$\n3.  **转运消耗速率 ($R_{\\mathrm{ATP}}^{\\mathrm{transport}}$)**：这是转运溶质 A 和 B 的成本总和。两者的成本均为每个分子 1 个 ATP。\n    $$\n    R_{\\mathrm{ATP}}^{\\mathrm{transport}} = (R_{A} \\times 1) + (R_{B} \\times 1) = R_{A} + R_{B}\n    $$\n    代入给定值：\n    $$\n    R_{\\mathrm{ATP}}^{\\mathrm{transport}} = (8.00 \\times 10^{4}\\ \\mathrm{s^{-1}}) + (2.00 \\times 10^{4}\\ \\mathrm{s^{-1}}) = 1.00 \\times 10^{5}\\ \\mathrm{s^{-1}}\n    $$\n现在，我们将这些速率相加以获得以每秒分子数为单位的总消耗速率：\n$$\nR_{\\mathrm{ATP}}^{\\mathrm{cons}} = (1.20 \\times 10^{5}) + (2.002 \\times 10^{5}) + (1.00 \\times 10^{5}) = 4.202 \\times 10^{5}\\ \\mathrm{s^{-1}}\n$$\n以摩尔每秒为单位的消耗通量是：\n$$\nJ_{\\mathrm{ATP}}^{\\mathrm{cons}} = \\frac{4.202 \\times 10^{5}\\ \\mathrm{s^{-1}}}{N_{\\mathrm{A}}} = \\frac{4.202 \\times 10^{5}}{6.022 \\times 10^{23}}\\ \\mathrm{mol\\ s^{-1}}\n$$\n\n接下来，我们计算稀释通量 $J_{\\mathrm{ATP}}^{\\mathrm{dilution}}$。这个通量之所以产生，是因为随着细胞的生长，ATP 的总量 $N_{\\mathrm{ATP}}$ 被稀释到更大的体积中。稀释速率由比生长速率 $\\mu$ 和 ATP 总量的乘积给出。\n$$\nJ_{\\mathrm{ATP}}^{\\mathrm{dilution}} = \\mu \\cdot N_{\\mathrm{ATP}}\n$$\n细胞中的 ATP 总量 $N_{\\mathrm{ATP}}$ 是其浓度 $C_{\\mathrm{ATP}}$ 和细胞体积 $V_{\\mathrm{cell}}$ 的乘积。\n$$\nN_{\\mathrm{ATP}} = C_{\\mathrm{ATP}} \\cdot V_{\\mathrm{cell}} = (3.00 \\times 10^{-3}\\ \\mathrm{mol\\ L^{-1}}) \\times (1.00 \\times 10^{-15}\\ \\mathrm{L}) = 3.00 \\times 10^{-18}\\ \\mathrm{mol}\n$$\n现在，我们可以计算稀释通量：\n$$\nJ_{\\mathrm{ATP}}^{\\mathrm{dilution}} = \\mu \\cdot N_{\\mathrm{ATP}} = (1.00 \\times 10^{-4}\\ \\mathrm{s^{-1}}) \\times (3.00 \\times 10^{-18}\\ \\mathrm{mol}) = 3.00 \\times 10^{-22}\\ \\mathrm{mol\\ s^{-1}}\n$$\n\n最后，我们通过将消耗通量和稀释通量相加来计算最小总 ATP 生成通量 $J_{\\mathrm{ATP}}^{\\min}$：\n$$\nJ_{\\mathrm{ATP}}^{\\min} = J_{\\mathrm{ATP}}^{\\mathrm{cons}} + J_{\\mathrm{ATP}}^{\\mathrm{dilution}} = \\frac{4.202 \\times 10^{5}}{6.022 \\times 10^{23}}\\ \\mathrm{mol\\ s^{-1}} + 3.00 \\times 10^{-22}\\ \\mathrm{mol\\ s^{-1}}\n$$\n计算数值：\n$$\nJ_{\\mathrm{ATP}}^{\\mathrm{cons}} \\approx 6.977748 \\times 10^{-19}\\ \\mathrm{mol\\ s^{-1}}\n$$\n$$\nJ_{\\mathrm{ATP}}^{\\min} \\approx (6.977748 \\times 10^{-19}) + (3.00 \\times 10^{-22})\\ \\mathrm{mol\\ s^{-1}}\n$$\n为了将这些数字相加，我们调整较小项的指数：\n$$\nJ_{\\mathrm{ATP}}^{\\min} \\approx (6.977748 \\times 10^{-19}) + (0.00300 \\times 10^{-19})\\ \\mathrm{mol\\ s^{-1}} = 6.980748 \\times 10^{-19}\\ \\mathrm{mol\\ s^{-1}}\n$$\n问题要求答案四舍五入到四位有效数字。\n$$\nJ_{\\mathrm{ATP}}^{\\min} \\approx 6.981 \\times 10^{-19}\\ \\mathrm{mol\\ s^{-1}}\n$$\n所需通量的最终符号表达式为：\n$$\nJ_{\\mathrm{ATP}}^{\\min} = \\frac{R_{\\mathrm{nt}} + 4R_{\\mathrm{aa}} + R_{\\mathrm{init}} + R_{A} + R_{B}}{N_{\\mathrm{A}}} + \\mu C_{\\mathrm{ATP}} V_{\\mathrm{cell}}\n$$\n代入所有数值即可得出计算结果。", "answer": "$$\n\\boxed{6.981 \\times 10^{-19}}\n$$", "id": "3358581"}, {"introduction": "细胞不仅需要维持内部稳态，还必须动态地响应外部环境的变化。本练习将静态的预算分析推向动态模拟，你将构建一个模型来预测细胞在渗透压突变下的行为 [@problem_id:3358577]。通过从渗透压和物质运输的基本物理化学定律出发，推导并求解耦合的常微分方程，你将能够模拟细胞体积的动态变化，并探索决定细胞生死的生存能力边界。", "problem": "通过将膜输运动力学和水流与细胞体积动力学及膨压耦合，对一个最小球形细胞的渗透调节进行建模。使用以下基本关系和定义作为出发点：细胞内溶质的质量守恒、van’t Hoff 渗透压以及球体的运动学关系。除这些以外，不要假设任何捷径。设细胞在 $t=0^{-}$ 时初始为等渗状态，并在 $t=0^{+}$ 时受到外部渗透压的阶跃变化。目标是确定在有限的时间范围内细胞在此冲击下的存活性。\n\n使用的基本依据：\n- 单位面积的膜溶质通量：$J_{s} = P\\left(C_{\\text{out}} - C_{\\text{in}}\\right)$，其中 $P$ 是溶质渗透率（单位 $\\mathrm{m\\,s^{-1}}$），$C_{\\text{out}}$ 是外部溶质浓度（单位 $\\mathrm{mol\\,m^{-3}}$），$C_{\\text{in}}$ 是内部溶质浓度（单位 $\\mathrm{mol\\,m^{-3}}$）。\n- van’t Hoff 渗透压差定律：$\\Delta \\pi = R T \\left(C_{\\text{in}} - C_{\\text{out}}\\right)$，其中 $R$ 是普适气体常数（单位 $\\mathrm{J\\,mol^{-1}\\,K^{-1}}$），$T$ 是绝对温度（单位 $\\mathrm{K}$）。\n- 体积水通量定律：$\\dfrac{dV}{dt} = L_{p} A(V)\\, \\Delta \\pi$，其中 $L_{p}$ 是水力渗透率（单位 $\\mathrm{m\\,Pa^{-1}\\,s^{-1}}$），$A(V)$ 是膜面积（单位 $\\mathrm{m^{2}}$），$V$ 是细胞体积（单位 $\\mathrm{m^{3}}$）。\n- 关联面积和体积的球体几何关系：$A(V) = \\left(36\\pi\\right)^{1/3} V^{2/3}$。\n\n基于这些基本原理和细胞内溶质守恒，推导当外部浓度在 $t=0^{+}$ 时从 $C_{\\text{out},0}$ 阶跃到一个新的恒定值 $C_{\\text{out,shock}}$ 时，关于 $V(t)$ 和 $C_{\\text{in}}(t)$ 的耦合常微分方程组 (ODEs)。内部摩尔量为 $N(t) = C_{\\text{in}}(t)\\,V(t)$，守恒定律给出 $\\dfrac{dN}{dt} = J_{s}\\,A(V)$。此处膨压定义为 $P_{\\text{turgor}}(t) = R T \\left(C_{\\text{in}}(t) - C_{\\text{out}}(t)\\right)$。\n\n有限时间范围内的存活性判据：细胞存活的充分必要条件是，对于所有 $t \\in [0, t_{\\text{end}}]$，以下两条均成立：\n1. 膜面积不超过其裂解极限：$A\\left(V(t)\\right) \\le A_{\\max}$，其中 $A_{0} = A\\left(V_{0}\\right)$ 是初始面积，$A_{\\max} = A_{0}\\left(1 + \\varepsilon_{\\max}\\right)$。此处 $\\varepsilon_{\\max}$ 是最大允许面积膨胀分数（无量纲）。\n2. 体积不低于其功能最小值：$V(t) \\ge V_{\\min}$，其中 $V_{\\min} = V_{0}\\left(1 - \\phi_{\\min}\\right)$，$\\phi_{\\min}$ 是最大允许体积损失分数（无量纲）。\n\n$t=0$ 时的初始条件：$V(0) = V_{0}$ 和 $C_{\\text{in}}(0) = C_{\\text{out},0}$。\n\n针对 $t \\ge 0$ 时的阶跃变化 $C_{\\text{out}}(t) = C_{\\text{out,shock}}$，实现推导出的 ODEs。在 $[0, t_{\\text{end}}]$ 上使用一个数值稳定的积分器，并对两个存活性条件进行事件检测，以便在发生违规时立即停止积分。假设存在单一中性溶质，无主动运输，整个过程中 $P$、$L_{p}$、$T$ 恒定，并保持球形几何。为每个测试用例报告布尔存活性，其中 $true$ 表示细胞在整个 $[0, t_{\\text{end}}]$ 时间内保持在存活性边界内，$false$ 表示发生了违规。\n\n所有参数使用的物理单位：\n- 浓度单位为 $\\mathrm{mol\\,m^{-3}}$（注意：$1\\,\\mathrm{mol\\,m^{-3}}$ 等于 $1\\,\\mathrm{mM}$）。\n- 体积单位为 $\\mathrm{m^{3}}$。\n- 面积单位为 $\\mathrm{m^{2}}$。\n- 渗透率 $P$ 单位为 $\\mathrm{m\\,s^{-1}}$。\n- 水力渗透率 $L_{p}$ 单位为 $\\mathrm{m\\,Pa^{-1}\\,s^{-1}}$。\n- 温度 $T$ 单位为 $\\mathrm{K}$。\n- 气体常数 $R$ 单位为 $\\mathrm{J\\,mol^{-1}\\,K^{-1}}$。\n- 时间单位为 $\\mathrm{s}$。\n- 分数极限 $\\varepsilon_{\\max}$ 和 $\\phi_{\\min}$ 是无量纲的。\n\n测试套件规范。对于以下所有情况，使用 $R = 8.314\\,\\mathrm{J\\,mol^{-1}\\,K^{-1}}$，且初始外部浓度 $C_{\\text{out},0}$ 等于初始内部浓度。每个测试用例是一个有序元组 $(V_{0}, C_{\\text{out},0}, C_{\\text{out,shock}}, P, L_{p}, T, t_{\\text{end}}, \\varepsilon_{\\max}, \\phi_{\\min})$：\n- 情况 $1$（理想路径，轻度低渗冲击）：$\\left(1.0\\times 10^{-18}\\,\\mathrm{m^{3}},\\,300\\,\\mathrm{mol\\,m^{-3}},\\,200\\,\\mathrm{mol\\,m^{-3}},\\,1.0\\times 10^{-8}\\,\\mathrm{m\\,s^{-1}},\\,5.0\\times 10^{-15}\\,\\mathrm{m\\,Pa^{-1}\\,s^{-1}},\\,310\\,\\mathrm{K},\\,100\\,\\mathrm{s},\\,0.04,\\,0.40\\right)$。\n- 情况 $2$（高水渗透率下的严重低渗冲击；可能达到裂解边界）：$\\left(1.0\\times 10^{-18}\\,\\mathrm{m^{3}},\\,300\\,\\mathrm{mol\\,m^{-3}},\\,50\\,\\mathrm{mol\\,m^{-3}},\\,1.0\\times 10^{-8}\\,\\mathrm{m\\,s^{-1}},\\,2.0\\times 10^{-14}\\,\\mathrm{m\\,Pa^{-1}\\,s^{-1}},\\,310\\,\\mathrm{K},\\,50\\,\\mathrm{s},\\,0.04,\\,0.40\\right)$。\n- 情况 $3$（慢溶质渗透率下的强烈高渗冲击；可能达到收缩边界）：$\\left(1.0\\times 10^{-18}\\,\\mathrm{m^{3}},\\,300\\,\\mathrm{mol\\,m^{-3}},\\,900\\,\\mathrm{mol\\,m^{-3}},\\,1.0\\times 10^{-9}\\,\\mathrm{m\\,s^{-1}},\\,1.0\\times 10^{-14}\\,\\mathrm{m\\,Pa^{-1}\\,s^{-1}},\\,310\\,\\mathrm{K},\\,100\\,\\mathrm{s},\\,0.04,\\,0.40\\right)$。\n- 情况 $4$（高溶质渗透率下的强烈高渗冲击；可能恢复）：$\\left(1.0\\times 10^{-18}\\,\\mathrm{m^{3}},\\,300\\,\\mathrm{mol\\,m^{-3}},\\,900\\,\\mathrm{mol\\,m^{-3}},\\,5.0\\times 10^{-8}\\,\\mathrm{m\\,s^{-1}},\\,1.0\\times 10^{-14}\\,\\mathrm{m\\,Pa^{-1}\\,s^{-1}},\\,310\\,\\mathrm{K},\\,100\\,\\mathrm{s},\\,0.04,\\,0.40\\right)$。\n- 情况 $5$（低水渗透率下的边界低渗冲击；接近面积极限）：$\\left(1.0\\times 10^{-18}\\,\\mathrm{m^{3}},\\,300\\,\\mathrm{mol\\,m^{-3}},\\,150\\,\\mathrm{mol\\,m^{-3}},\\,5.0\\times 10^{-9}\\,\\mathrm{m\\,s^{-1}},\\,3.0\\times 10^{-15}\\,\\mathrm{m\\,Pa^{-1}\\,s^{-1}},\\,310\\,\\mathrm{K},\\,200\\,\\mathrm{s},\\,0.04,\\,0.40\\right)$。\n\n你的程序应实现推导出的 ODEs，在 $[0, t_{\\text{end}}]$ 上模拟每个测试用例，并对 $A\\left(V(t)\\right) = A_{\\max}$ 和 $V(t) = V_{\\min}$ 进行事件检测，为每个情况返回一个布尔值，如果细胞保持存活则为 $true$，否则为 $false$。你的程序应生成一行输出，其中包含用方括号括起来的、以逗号分隔的结果列表（例如，$\\left[\\text{True},\\text{False},\\text{True},\\text{False},\\text{True}\\right]$）。不允许有其他输出。", "solution": "该问题要求推导并数值求解一个耦合常微分方程组 (ODEs)，该方程组用于模拟一个最小球形细胞对外部溶质浓度突然变化的渗透响应。分析必须基于所提供的基本物理定律。\n\n### **问题验证**\n\n**步骤 1：提取给定条件**\n\n-   **膜溶质通量：** $J_{s} = P\\left(C_{\\text{out}} - C_{\\text{in}}\\right)$\n-   **Van’t Hoff 渗透压差：** $\\Delta \\pi = R T \\left(C_{\\text{in}} - C_{\\text{out}}\\right)$\n-   **体积水通量：** $\\dfrac{dV}{dt} = L_{p} A(V)\\, \\Delta \\pi$\n-   **球体几何：** $A(V) = \\left(36\\pi\\right)^{1/3} V^{2/3}$\n-   **细胞内溶质摩尔数：** $N(t) = C_{\\text{in}}(t)\\,V(t)$\n-   **溶质守恒：** $\\dfrac{dN}{dt} = J_{s}\\,A(V)$\n-   **初始条件 ($t=0$):** $V(0) = V_{0}$, $C_{\\text{in}}(0) = C_{\\text{out},0}$\n-   **外部浓度阶跃 ($t \\ge 0$):** $C_{\\text{out}}(t) = C_{\\text{out,shock}}$\n-   **存活性判据（裂解）：** $A\\left(V(t)\\right) \\le A_{\\max}$，其中 $A_{\\max} = A_{0}\\left(1 + \\varepsilon_{\\max}\\right)$ 且 $A_{0} = A\\left(V_{0}\\right)$。\n-   **存活性判据（收缩）：** $V(t) \\ge V_{\\min}$，其中 $V_{\\min} = V_{0}\\left(1 - \\phi_{\\min}\\right)$。\n-   **常量：** $P$, $L_{p}$, $T$, $R$ 为常量。\n-   **测试数据：** 提供了五个具体的测试用例及所有必需的参数值。\n\n**步骤 2：使用提取的给定条件进行验证**\n\n根据验证标准对问题陈述进行审查：\n\n-   **科学依据**：该问题基于物理化学和生物学的基本原理，即菲克扩散定律（近似为膜输运的 $J_s$）、van't Hoff 渗透压方程和质量守恒。这些构成了细胞体积调节标准生物物理模型（例如 Kedem-Katchalsky 方程）的基础。该模型虽是简化模型，但在科学上是合理的。\n-   **适定性**：该问题提供了一套完整的耦合微分方程组，具有明确定义的初始条件和在模拟期间保持不变的常数参数。对于给定的初值问题，预期存在唯一解。\n-   **客观性**：该问题使用精确的数学和物理术语进行陈述。目标是定量的，存活性判据定义明确。没有主观或基于意见的元素。\n-   **完整性和一致性**：为每个测试用例提供了所有必需的参数、常数和初始条件。单位已指定且一致。没有内部矛盾。\n\n**步骤 3：结论与行动**\n\n该问题被认为是有效的。这是一个计算系统生物学中适定的、有科学依据的问题。将推导并实现一个解决方案。\n\n### **耦合 ODE 系统的推导**\n\n系统状态由两个变量描述：细胞体积 $V(t)$ 和细胞内溶质浓度 $C_{\\text{in}}(t)$。我们必须推导它们的变化率 $\\frac{dV}{dt}$ 和 $\\frac{dC_{\\text{in}}}{dt}$ 的表达式。\n\n**1. $\\frac{dV}{dt}$ 的推导：**\n\n该方程通过直接代入所提供的定律得出。体积水通量由下式给出：\n$$ \\frac{dV}{dt} = L_{p} A(V) \\Delta \\pi $$\n代入 van't Hoff 定律 $\\Delta \\pi = R T (C_{\\text{in}} - C_{\\text{out}})$ 和球体几何关系 $A(V) = \\kappa V^{2/3}$（其中 $\\kappa = (36\\pi)^{1/3}$ 是一个几何常数）：\n$$ \\frac{dV}{dt} = L_{p} (\\kappa V^{2/3}) R T (C_{\\text{in}} - C_{\\text{out}}) $$\n为符合惯例重新整理：\n$$ \\frac{dV}{dt} = \\kappa L_{p} R T V(t)^{2/3} \\left(C_{\\text{in}}(t) - C_{\\text{out,shock}}\\right) $$\n这是我们系统的第一个 ODE。它描述了细胞体积如何响应膜两侧的渗透压差而变化。\n\n**2. $\\frac{dC_{\\text{in}}}{dt}$ 的推导：**\n\n此推导从细胞内溶质摩尔数 $N(t)$ 的守恒开始。给定 $N(t) = C_{\\text{in}}(t) V(t)$。使用乘法法则对时间求导，得到：\n$$ \\frac{dN}{dt} = \\frac{dC_{\\text{in}}}{dt} V(t) + C_{\\text{in}}(t) \\frac{dV}{dt} $$\n质量守恒定律指出，摩尔数的变化率等于穿过膜面积的净溶质通量：\n$$ \\frac{dN}{dt} = J_{s} A(V) $$\n代入溶质通量表达式 $J_{s} = P(C_{\\text{out}} - C_{\\text{in}})$：\n$$ \\frac{dN}{dt} = P (C_{\\text{out,shock}} - C_{\\text{in}}(t)) A(V) $$\n令 $\\frac{dN}{dt}$ 的两个表达式相等：\n$$ \\frac{dC_{\\text{in}}}{dt} V(t) + C_{\\text{in}}(t) \\frac{dV}{dt} = P (C_{\\text{out,shock}} - C_{\\text{in}}(t)) A(V) $$\n求解 $\\frac{dC_{\\text{in}}}{dt}$：\n$$ \\frac{dC_{\\text{in}}}{dt} = \\frac{1}{V(t)} \\left[ P (C_{\\text{out,shock}} - C_{\\text{in}}(t)) A(V) - C_{\\text{in}}(t) \\frac{dV}{dt} \\right] $$\n该方程表明，内部浓度的变化是由于两种效应：穿过膜的溶质通量（第一项）和体积变化引起的稀释或浓缩效应（第二项）。\n\n我们可以代入已知的表达式 $A(V) = \\kappa V^{2/3}$ 和先前推导的 $\\frac{dV}{dt}$：\n$$ \\frac{dC_{\\text{in}}}{dt} = \\frac{1}{V} \\left[ P (C_{\\text{out}} - C_{\\text{in}}) (\\kappa V^{2/3}) - C_{\\text{in}} \\left( \\kappa L_{p} R T V^{2/3} (C_{\\text{in}} - C_{\\text{out}}) \\right) \\right] $$\n注意 $C_{\\text{out}} = C_{\\text{out,shock}}$。提取公因式并简化：\n$$ \\frac{dC_{\\text{in}}}{dt} = \\frac{\\kappa V^{2/3}}{V} \\left[ P (C_{\\text{out}} - C_{\\text{in}}) - C_{\\text{in}} L_{p} R T (C_{\\text{in}} - C_{\\text{out}}) \\right] $$\n$$ \\frac{dC_{\\text{in}}}{dt} = \\kappa V^{-1/3} \\left[ P (C_{\\text{out}} - C_{\\text{in}}) + C_{\\text{in}} L_{p} R T (C_{\\text{out}} - C_{\\text{in}}) \\right] $$\n$$ \\frac{dC_{\\text{in}}}{dt} = \\kappa V(t)^{-1/3} (C_{\\text{out,shock}} - C_{\\text{in}}(t)) \\left[ P + C_{\\text{in}}(t) L_{p} R T \\right] $$\n这是我们系统的第二个 ODE。\n\n**ODE 系统总结：**\n需要数值求解的系统是：\n$$\n\\begin{cases}\n\\frac{dV}{dt} = \\kappa L_{p} R T V^{2/3} (C_{\\text{in}} - C_{\\text{out,shock}}) \\\\\n\\frac{dC_{\\text{in}}}{dt} = \\kappa V^{-1/3} (C_{\\text{out,shock}} - C_{\\text{in}}) (P + C_{\\text{in}} L_{p} R T)\n\\end{cases}\n$$\n初始条件为 $V(0) = V_0$ 和 $C_{\\text{in}}(0) = C_{\\text{out},0}$。\n\n### **数值解法与存活性评估**\n\n推导出的这个由两个耦合的一阶非线性 ODE 组成的系统将使用数值积分器求解。SciPy 库中的 `scipy.integrate.solve_ivp` 函数适用于此任务，因为它提供了鲁棒的算法并支持事件检测。\n\n**作为事件的存活性约束：**\n细胞的存活性受到最大面积（以防止裂解）和最小体积（以维持功能）的约束。这些约束将在 ODE 求解器中作为终止事件实现。如果触发了事件，积分将停止，细胞被认为不存活。\n\n1.  **裂解条件（最大面积）：**\n    面积不得超过 $A_{\\max} = A_0 (1 + \\varepsilon_{\\max})$。由于 $A(V) = \\kappa V^{2/3}$，这意味着存在一个最大体积 $V_{\\max}$：\n    $$ \\kappa V_{\\max}^{2/3} = \\kappa V_0^{2/3} (1 + \\varepsilon_{\\max}) \\implies V_{\\max} = V_0 (1 + \\varepsilon_{\\max})^{3/2} $$\n    事件函数将是 $f_{\\text{lysis}}(t, y) = V_{\\max} - V(t)$。求解器将检测此函数何时穿过零点。\n\n2.  **收缩条件（最小体积）：**\n    体积不得低于 $V_{\\min} = V_0 (1 - \\phi_{\\min})$。\n    事件函数将是 $f_{\\text{shrink}}(t, y) = V(t) - V_{\\min}$。求解器将检测此函数何时穿过零点。\n\n如果积分在整个时间区间 $[0, t_{\\text{end}}]$ 内完成，而没有触发任何这些事件，则认为细胞在该组条件下是存活的。否则，则不存活。最终程序将遍历每个测试用例，执行带有事件检测的模拟，并报告布尔存活性结果。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the cell viability problem for a set of test cases.\n    \"\"\"\n    # Test suite specification. Each case is a tuple:\n    # (V0, C_out0, C_out_shock, P, Lp, T, t_end, eps_max, phi_min)\n    test_cases = [\n        # Case 1: happy path, mild hypotonic shock\n        (1.0e-18, 300, 200, 1.0e-8, 5.0e-15, 310, 100, 0.04, 0.40),\n        # Case 2: severe hypotonic shock with high water permeability\n        (1.0e-18, 300, 50, 1.0e-8, 2.0e-14, 310, 50, 0.04, 0.40),\n        # Case 3: strong hypertonic shock with slow solute permeability\n        (1.0e-18, 300, 900, 1.0e-9, 1.0e-14, 310, 100, 0.04, 0.40),\n        # Case 4: strong hypertonic shock with high solute permeability\n        (1.0e-18, 300, 900, 5.0e-8, 1.0e-14, 310, 100, 0.04, 0.40),\n        # Case 5: boundary hypotonic shock with low water permeability\n        (1.0e-18, 300, 150, 5.0e-9, 3.0e-15, 310, 200, 0.04, 0.40),\n    ]\n\n    results = []\n    R = 8.314  # J mol^-1 K^-1\n    KAPPA = (36 * np.pi)**(1/3) # Geometric factor for sphere\n\n    def model(t, y, params):\n        \"\"\"\n        Defines the coupled ODE system.\n        y[0] = V(t) (cell volume)\n        y[1] = Cin(t) (internal concentration)\n        \"\"\"\n        V, C_in = y\n        P, Lp, T, C_out_shock = params['P'], params['Lp'], params['T'], params['C_out_shock']\n\n        # Avoid division by zero or negative volume underflow if integration is unstable\n        if V = 0:\n            return [0, 0]\n\n        # Rate of change of volume (dV/dt)\n        dVdt = KAPPA * Lp * R * T * V**(2/3) * (C_in - C_out_shock)\n        \n        # Rate of change of internal concentration (dCin/dt)\n        term1 = KAPPA * V**(-1/3)\n        term2 = C_out_shock - C_in\n        term3 = P + C_in * Lp * R * T\n        dCindt = term1 * term2 * term3\n        \n        return [dVdt, dCindt]\n\n    for case in test_cases:\n        V0, C_out0, C_out_shock, P, Lp, T, t_end, eps_max, phi_min = case\n\n        # Initial internal concentration is isotonic with initial external concentration\n        C_in0 = C_out0\n        \n        # Viability boundaries\n        V_min = V0 * (1 - phi_min)\n        V_max = V0 * (1 + eps_max)**(1.5)\n\n        # Event: Cell shrinks below minimum functional volume\n        def event_shrinkage(t, y, params):\n            return y[0] - V_min\n        event_shrinkage.terminal = True\n        event_shrinkage.direction = -1 # Event triggers when volume is decreasing\n\n        # Event: Cell swells beyond maximum lytic area/volume\n        def event_lysis(t, y, params):\n            return y[0] - V_max\n        event_lysis.terminal = True\n        event_lysis.direction = 1 # Event triggers when volume is increasing\n\n        # Parameters for the ODE function\n        params = {\n            'P': P, 'Lp': Lp, 'T': T, 'C_out_shock': C_out_shock\n        }\n        \n        # Initial state vector\n        y0 = [V0, C_in0]\n        \n        # Time span for integration\n        t_span = [0, t_end]\n\n        sol = solve_ivp(\n            fun=model,\n            t_span=t_span,\n            y0=y0,\n            method='Radau', # Good for potentially stiff problems\n            events=[event_shrinkage, event_lysis],\n            args=(params,),\n            dense_output=False\n        )\n\n        # A cell is viable if the integration completes without triggering a terminal event.\n        # This occurs when sol.status is 0 (integration reached t_end) or when\n        # no terminal events are recorded in `sol.t_events`.\n        is_viable = all(len(evt) == 0 for evt in sol.t_events)\n        \n        results.append(is_viable)\n\n    # Format the final output as a comma-separated list of booleans\n    # Python's str(True) -> 'True', str(False) -> 'False' as per example `[True,False,...]`\n    output_str = '[' + ','.join(map(str, results)) + ']'\n    print(output_str)\n\nsolve()\n```", "id": "3358577"}, {"introduction": "一个理论模型若要具有预测能力，其参数必须通过实验数据进行校准。这个练习解决了计算系统生物学中的一个核心问题：我们如何从测量数据中推断模型的未知参数？你将使用贝叶斯推断的方法 [@problem_id:3358634]，为一个简约的基因表达模块估计动力学参数。此过程不仅让你实践了参数估计，还将揭示参数可识别性（identifiability）这一重要概念，即在给定数据集下，我们能在多大程度上确定一个参数的值。", "problem": "考虑一个全细胞模型在稳态条件下的最小基因表达模块。信使核糖核酸 (mRNA) 以一定的转录速率合成并被降解，蛋白质则由 mRNA 以一定的翻译速率合成并被降解。假设在恒定输入下，从转录和翻译的常微分方程 (ODE) 模型推导出以下质量作用稳态关系：\n1. 在输入 $u$ 下，稳态 mRNA 拷贝数为 $m_{\\mathrm{ss}} = \\dfrac{k_{\\mathrm{tx}} \\, u}{\\delta_m}$。\n2. 在输入 $u$ 下，稳态蛋白质拷贝数为 $p_{\\mathrm{ss}} = \\dfrac{k_{\\mathrm{tx}} \\, k_{\\mathrm{tl}} \\, u}{\\delta_m \\, \\delta_p}$。\n3. 蛋白质半衰期为 $t_{1/2} = \\dfrac{\\ln 2}{\\delta_p}$。\n\n参数均为严格正值。令未知动力学参数为 $\\theta = (k_{\\mathrm{tx}}, k_{\\mathrm{tl}}, \\delta_p)$，其中 $k_{\\mathrm{tx}}$ 是转录速率，$k_{\\mathrm{tl}}$ 是翻译速率，$\\delta_p$ 是蛋白质降解速率。mRNA 降解速率 $\\delta_m$ 已知。\n\n假设对 $\\theta$ 的每个分量进行贝叶斯推断，使用独立的对数正态先验。等价地，在对数参数空间 $z = (\\ln k_{\\mathrm{tx}}, \\ln k_{\\mathrm{tl}}, \\ln \\delta_p)$ 中，每个分量都具有正态先验：$z_i \\sim \\mathcal{N}(\\mu_i, \\sigma_i^2)$，对于 $i \\in \\{1,2,3\\}$ 独立。测量噪声模型为高斯模型，且在各次测量和实验之间独立，具体如下：\n- 对于在输入 $u$ 下的稳态蛋白质测量值 $y_p$，有 $y_p \\sim \\mathcal{N}\\!\\left(p_{\\mathrm{ss}}(\\theta; u), \\sigma_p^2\\right)$。\n- 对于在输入 $u$ 下的稳态 mRNA 测量值 $y_m$，有 $y_m \\sim \\mathcal{N}\\!\\left(m_{\\mathrm{ss}}(\\theta; u), \\sigma_m^2\\right)$。\n- 对于半衰期测量值 $y_t$，有 $y_t \\sim \\mathcal{N}\\!\\left(t_{1/2}(\\theta), \\sigma_t^2\\right)$。\n\n令 $z$ 的后验分布与 $z$ 的先验密度和上述观测模型导出的似然函数之乘积成正比。将对数参数 $z_i$ 的后验方差定义为 $\\mathrm{Var}_{\\text{post}}(z_i)$，先验方差定义为 $\\mathrm{Var}_{\\text{prior}}(z_i) = \\sigma_i^2$。将参数 $i$ 的方差缩减定义为\n$$\nR_i = 1 - \\frac{\\mathrm{Var}_{\\text{post}}(z_i)}{\\mathrm{Var}_{\\text{prior}}(z_i)}.\n$$\n如果 $R_i  0.5$，则认为参数是弱约束的。\n\n您的任务是：\n- 使用贝叶斯定理结合指定的先验和似然，得到 $z$ 的后验分布。\n- 通过在均匀网格上离散化每个 $z_i$ 来数值近似 $z$ 的后验分布。该网格范围为 $[\\mu_i - 4 \\sigma_i, \\, \\mu_i + 4 \\sigma_i]$，每个维度有 $41$ 个等距点（在 $z$ 空间中形成一个 $41 \\times 41 \\times 41$ 的张量网格）。\n- 使用未归一化的对数密度计算网格上（相差一个公共比例常数）的归一化后验权重，然后通过在此网格上的加权和计算 $\\mathrm{Var}_{\\text{post}}(z_i)$。\n- 如果 $R_i  0.5$，则将每个参数分类为弱约束。\n\n使用已知的 mRNA 降解速率 $\\delta_m = 0.2$ min$^{-1}$。参数和测量的单位如下：$k_{\\mathrm{tx}}$ 单位为 min$^{-1}$，$k_{\\mathrm{tl}}$ 单位为 min$^{-1}$，$\\delta_p$ 单位为 min$^{-1}$，$\\delta_m$ 单位为 min$^{-1}$，稳态分子数单位为每个细胞的分子数，半衰期单位为分钟。所有测量和参数必须在这些单位下一致使用。输出纯粹是逻辑值（整数 $0$ 或 $1$），因此最终输出中不需要单位表达。\n\n测试套件。将您的程序应用于以下三种情况。在每种情况下，将观测值视为固定的给定数字（不要模拟额外的噪声）。\n\n- 情况 A（仅稳态蛋白质；可辨识性受限）：\n  - 蛋白质测量的输入：$u = [1.0, 2.0]$（无量纲）。\n  - 观测到的蛋白质：$y_p = [1015.0, 1990.0]$，$\\sigma_p = 50.0$ 分子/细胞。\n  - 无 mRNA 测量，无半衰期测量。\n  - 对数空间中的先验均值和标准差：\n    - $\\mu = [\\ln(2.0), \\ln(5.0), \\ln(0.05)]$，\n    - $\\sigma = [1.0, 1.0, 1.0]$。\n\n- 情况 B（蛋白质、mRNA 和半衰期；强信息性）：\n  - 蛋白质测量的输入：$u = [1.0, 2.0]$。\n  - 观测到的蛋白质：$y_p = [1015.0, 1990.0]$，$\\sigma_p = 50.0$ 分子/细胞。\n  - 在 $u = 1.0$ 下的 mRNA 测量：观测值 $y_m = 10.5$，$\\sigma_m = 0.5$ 分子/细胞。\n  - 半衰期测量：观测值 $y_t = 13.8$，$\\sigma_t = 0.5$ 分钟。\n  - 对数空间中的先验均值和标准差：\n    - $\\mu = [\\ln(2.0), \\ln(5.0), \\ln(0.05)]$，\n    - $\\sigma = [1.0, 1.0, 1.0]$。\n\n- 情况 C（转录的强信息性先验，仅蛋白质）：\n  - 蛋白质测量的输入：$u = [1.0, 2.0]$。\n  - 观测到的蛋白质：$y_p = [1015.0, 1990.0]$，$\\sigma_p = 50.0$ 分子/细胞。\n  - 无 mRNA 测量，无半衰期测量。\n  - 对数空间中的先验均值和标准差：\n    - $\\mu = [\\ln(2.0), \\ln(5.0), \\ln(0.05)]$，\n    - $\\sigma = [0.05, 1.0, 1.0]$。\n\n算法要求：\n- 在 $z$ 空间中进行计算。先验密度是每个 $z_i$ 的正态密度的乘积。似然项在可观测变量上是高斯的，其均值由以 $z$ 表示的质量作用稳态关系给出：\n  - $p_{\\mathrm{ss}} = \\exp(z_1 + z_2 - z_3) \\cdot \\dfrac{u}{\\delta_m}$，\n  - $m_{\\mathrm{ss}} = \\exp(z_1) \\cdot \\dfrac{u}{\\delta_m}$，\n  - $t_{1/2} = \\dfrac{\\ln 2}{\\exp(z_3)}$。\n- 通过将对数先验和对数似然相加，计算网格上的未归一化对数后验。为保证数值稳定性，在进行指数运算前减去最大的未归一化对数后验值。将权重归一化，使其在网格上的总和为 $1$，以近似期望值。\n- 计算 $z_1, z_2, z_3$ 的后验方差和缩减量 $R_1, R_2, R_3$。\n\n最终输出规范：\n- 对于每种情况，按 $[k_{\\mathrm{tx}}, k_{\\mathrm{tl}}, \\delta_p]$ 的顺序输出一个包含三个整数的列表，其中 $1$ 表示“弱约束”，$0$ 表示“非弱约束”，依据阈值 $R_i  0.5$ 判断。\n- 您的程序应生成单行输出，其中包含三种情况的结果，形式为这三个三元素列表的逗号分隔列表，不含空格。例如：[[1,0,1],[0,0,0],[1,1,1]]。", "solution": "该问题要求对一个最小基因表达模型进行贝叶斯参数推断，并随后根据从先验分布到后验分布的方差缩减，将每个参数分类为“弱约束”。该分析需要针对三种不同情况，在对数参数空间的离散网格上进行数值计算。\n\n### 第 1 步：理论框架\n\n问题的核心在于应用贝叶斯定理。给定数据 $y$，参数 $z$ 的后验概率分布 $P(z|y)$ 与给定参数的数据似然 $\\mathcal{L}(y|z)$ 和参数的先验概率 $P(z)$ 的乘积成正比。\n$$\nP(z|y) \\propto \\mathcal{L}(y|z) P(z)\n$$\n使用对数进行计算在数值上更稳定和方便，因为它将乘积转化为和：\n$$\n\\ln P(z|y) = \\ln \\mathcal{L}(y|z) + \\ln P(z) + \\text{常数}\n$$\n参数在对数空间中定义为 $z = (z_1, z_2, z_3) = (\\ln k_{\\mathrm{tx}}, \\ln k_{\\mathrm{tl}}, \\ln \\delta_p)$，其中 $k_{\\mathrm{tx}}$ 是转录速率，$k_{\\mathrm{tl}}$ 是翻译速率，$\\delta_p$ 是蛋白质降解速率。\n\n### 第 2 步：先验分布\n\n问题陈述，参数 $z_i$ 具有独立的标准先验：$z_i \\sim \\mathcal{N}(\\mu_i, \\sigma_i^2)$。联合对数先验密度（忽略常数项）是各个对数先验之和：\n$$\n\\ln P(z) \\propto \\sum_{i=1}^{3} \\ln \\mathcal{N}(z_i | \\mu_i, \\sigma_i^2) \\propto -\\frac{1}{2}\\sum_{i=1}^{3} \\left( \\frac{z_i - \\mu_i}{\\sigma_i} \\right)^2\n$$\n每个对数参数 $z_i$ 的先验方差为 $\\mathrm{Var}_{\\text{prior}}(z_i) = \\sigma_i^2$。\n\n### 第 3 步：似然函数\n\n假设测量是独立的，因此总对数似然是每个观测值的对数似然之和。每种测量类型的噪声都是高斯的。\n\n用 $z$ 表示的模型预测值为：\n-   稳态蛋白质：$p_{\\mathrm{ss}}(z; u) = \\frac{k_{\\mathrm{tx}} k_{\\mathrm{tl}} u}{\\delta_m \\delta_p} = \\frac{\\exp(z_1) \\exp(z_2) u}{\\delta_m \\exp(z_3)} = \\frac{u}{\\delta_m} \\exp(z_1 + z_2 - z_3)$\n-   稳态 mRNA：$m_{\\mathrm{ss}}(z; u) = \\frac{k_{\\mathrm{tx}} u}{\\delta_m} = \\frac{u}{\\delta_m} \\exp(z_1)$\n-   蛋白质半衰期：$t_{1/2}(z) = \\frac{\\ln 2}{\\delta_p} = (\\ln 2) \\exp(-z_3)$\n\n对数似然的贡献（忽略常数）为：\n-   对于一组在输入 $\\{u_j\\}$ 下，噪声为 $\\sigma_p$ 的蛋白质测量值 $\\{y_{p,j}\\}$：\n    $$\n    \\ln \\mathcal{L}_p(y_p|z) = \\sum_{j} -\\frac{(y_{p,j} - p_{\\mathrm{ss}}(z; u_j))^2}{2\\sigma_p^2}\n    $$\n-   对于在输入 $u_m$ 下，噪声为 $\\sigma_m$ 的 mRNA 测量值 $y_m$：\n    $$\n    \\ln \\mathcal{L}_m(y_m|z) = -\\frac{(y_m - m_{\\mathrm{ss}}(z; u_m))^2}{2\\sigma_m^2}\n    $$\n-   对于噪声为 $\\sigma_t$ 的半衰期测量值 $y_t$：\n    $$\n    \\ln \\mathcal{L}_t(y_t|z) = -\\frac{(y_t - t_{1/2}(z))^2}{2\\sigma_t^2}\n    $$\n总对数似然为 $\\ln \\mathcal{L}(y|z) = \\ln \\mathcal{L}_p + \\ln \\mathcal{L}_m + \\ln \\mathcal{L}_t$，如果某个特定情况下没有对应的数据，则省略相应项。\n\n### 第 4 步：后验的数值近似\n\n连续的后验分布在一个离散的网格上进行近似。每个参数轴 $z_i$ 在 $[\\mu_i - 4\\sigma_i, \\mu_i + 4\\sigma_i]$ 范围内被离散化为 $41$ 个点。这在 $3$ 维参数空间中创建了一个 $41 \\times 41 \\times 41$ 的网格。\n\n对于此网格上的每个点 $z_k$，我们计算未归一化的对数后验：\n$$\n\\ln P_{\\text{unnorm}}(z_k|y) = \\ln P(z_k) + \\ln \\mathcal{L}(y|z_k)\n$$\n为了数值稳定性，我们在进行指数运算之前减去最大值，以获得未归一化的权重 $w(z_k)$：\n$$\nw(z_k) = \\exp(\\ln P_{\\text{unnorm}}(z_k|y) - \\max_{j} \\{\\ln P_{\\text{unnorm}}(z_j|y)\\})\n$$\n然后将这些权重归一化，使其总和为 $1$，从而得到离散的后验概率质量函数 $W(z_k)$：\n$$\nW(z_k) = \\frac{w(z_k)}{\\sum_{j} w(z_j)}\n$$\n\n### 第 5 步：后验方差和参数约束\n\n利用归一化的后验权重 $W(z_k)$，每个参数 $z_i$ 的后验矩通过网格上的加权和来计算。\n-   后验均值：$E_{\\text{post}}[z_i] \\approx \\sum_k z_{i,k} W(z_k)$\n-   后验平方均值：$E_{\\text{post}}[z_i^2] \\approx \\sum_k z_{i,k}^2 W(z_k)$\n-   后验方差：$\\mathrm{Var}_{\\text{post}}(z_i) = E_{\\text{post}}[z_i^2] - (E_{\\text{post}}[z_i])^2$\n\n方差缩减 $R_i$ 量化了数据相对于先验不确定性对参数的约束程度：\n$$\nR_i = 1 - \\frac{\\mathrm{Var}_{\\text{post}}(z_i)}{\\mathrm{Var}_{\\text{prior}}(z_i)} = 1 - \\frac{\\mathrm{Var}_{\\text{post}}(z_i)}{\\sigma_i^2}\n$$\n如果 $R_i  0.5$，则将参数分类为“弱约束”，这意味着数据未能将参数方差减少至少 $50\\%$。\n\n### 第 6 步：情况分析逻辑\n-   **情况 A**：仅有蛋白质数据时，该模型存在结构不可辨识性。测量只能约束组合 $z_1 + z_2 - z_3$，而不能约束单个参数。在使用宽先验的情况下，每个 $z_i$ 的边际后验方差预计会接近其先验方差，从而导致较小的 $R_i$ 值。\n-   **情况 B**：mRNA 和半衰期数据的可用性解决了不可辨识性问题。mRNA 数据约束 $z_1$，半衰期数据约束 $z_3$，然后蛋白质数据约束剩余的参数 $z_2$。预计所有三个参数的方差都会有显著缩减。\n-   **情况 C**：这种情况在数据方面与情况 A 相同，但对 $z_1$ 使用了一个信息量非常大（窄）的先验。$z_1$ 的后验方差将由其本已很小的先验方差主导，因此数据提供的额外缩减很小，导致 $R_1 \\approx 0$。$z_2$ 和 $z_3$ 的结构不可辨识性问题依然存在，因此它们的方差也不会被显著缩减。", "answer": "```python\nimport numpy as np\n\ndef analyze_case(case_data):\n    \"\"\"\n    Analyzes a single parameter inference case using grid-based Bayesian inference.\n\n    Args:\n        case_data (dict): A dictionary containing all the data and prior\n                          information for a single experimental case.\n\n    Returns:\n        list: A list of three integers (0 or 1) indicating if each parameter\n              (k_tx, k_tl, delta_p) is weakly constrained (1) or not (0).\n    \"\"\"\n    mu = case_data['mu']\n    sigma = case_data['sigma']\n    num_points = 41\n    delta_m = 0.2\n\n    # 1. Generate the parameter grid in log-space (z-space)\n    z1_grid = np.linspace(mu[0] - 4 * sigma[0], mu[0] + 4 * sigma[0], num_points)\n    z2_grid = np.linspace(mu[1] - 4 * sigma[1], mu[1] + 4 * sigma[1], num_points)\n    z3_grid = np.linspace(mu[2] - 4 * sigma[2], mu[2] + 4 * sigma[2], num_points)\n    \n    # Use 'ij' indexing to match loop order intuition (i=z1, j=z2, k=z3)\n    Z1, Z2, Z3 = np.meshgrid(z1_grid, z2_grid, z3_grid, indexing='ij')\n\n    # 2. Calculate the log-prior probability on the grid\n    log_prior = -0.5 * (\n        ((Z1 - mu[0]) / sigma[0])**2 +\n        ((Z2 - mu[1]) / sigma[1])**2 +\n        ((Z3 - mu[2]) / sigma[2])**2\n    )\n\n    # 3. Calculate the log-likelihood on the grid\n    log_likelihood = np.zeros_like(Z1)\n\n    # Add contribution from protein measurements if present\n    if 'yp' in case_data:\n        for y, u in zip(case_data['yp'], case_data['up']):\n            p_ss_model = np.exp(Z1 + Z2 - Z3) * u / delta_m\n            log_likelihood += -0.5 * ((y - p_ss_model) / case_data['sigma_p'])**2\n\n    # Add contribution from mRNA measurement if present\n    if 'ym' in case_data:\n        m_ss_model = np.exp(Z1) * case_data['um'] / delta_m\n        log_likelihood += -0.5 * ((case_data['ym'] - m_ss_model) / case_data['sigma_m'])**2\n\n    # Add contribution from half-life measurement if present\n    if 'yt' in case_data:\n        t_half_model = np.log(2) * np.exp(-Z3)\n        log_likelihood += -0.5 * ((case_data['yt'] - t_half_model) / case_data['sigma_t'])**2\n\n    # 4. Calculate posterior weights\n    # Sum log-prior and log-likelihood for unnormalized log-posterior\n    log_posterior_unnorm = log_prior + log_likelihood\n    \n    # Stabilize by subtracting the max value before exponentiation\n    log_posterior_stable = log_posterior_unnorm - np.max(log_posterior_unnorm)\n    posterior_weights = np.exp(log_posterior_stable)\n    \n    # Normalize weights to sum to 1\n    posterior_weights /= np.sum(posterior_weights)\n\n    # 5. Calculate posterior variances, variance reduction, and classify\n    results = []\n    grids = [Z1, Z2, Z3]\n    prior_vars = [s**2 for s in sigma]\n\n    for i in range(3):\n        # Calculate posterior mean and variance using weighted sums\n        post_mean = np.sum(grids[i] * posterior_weights)\n        post_mean_sq = np.sum(grids[i]**2 * posterior_weights)\n        post_var = post_mean_sq - post_mean**2\n        \n        prior_var = prior_vars[i]\n        \n        # Calculate variance reduction R_i\n        R_i = 1 - post_var / prior_var\n        \n        # Classify as weakly constrained if R_i  0.5\n        is_weakly_constrained = 1 if R_i  0.5 else 0\n        results.append(is_weakly_constrained)\n        \n    return results\n\ndef solve():\n    \"\"\"\n    Main function to define test cases, run analysis, and print results.\n    \"\"\"\n    # Define the three test cases as dictionaries\n    case_A = {\n        'name': 'protein only',\n        'up': [1.0, 2.0],\n        'yp': [1015.0, 1990.0],\n        'sigma_p': 50.0,\n        'mu': [np.log(2.0), np.log(5.0), np.log(0.05)],\n        'sigma': [1.0, 1.0, 1.0]\n    }\n\n    case_B = {\n        'name': 'protein, mRNA, and half-life',\n        'up': [1.0, 2.0],\n        'yp': [1015.0, 1990.0],\n        'sigma_p': 50.0,\n        'um': 1.0,\n        'ym': 10.5,\n        'sigma_m': 0.5,\n        'yt': 13.8,\n        'sigma_t': 0.5,\n        'mu': [np.log(2.0), np.log(5.0), np.log(0.05)],\n        'sigma': [1.0, 1.0, 1.0]\n    }\n\n    case_C = {\n        'name': 'informative prior on transcription, protein only',\n        'up': [1.0, 2.0],\n        'yp': [1015.0, 1990.0],\n        'sigma_p': 50.0,\n        'mu': [np.log(2.0), np.log(5.0), np.log(0.05)],\n        'sigma': [0.05, 1.0, 1.0]\n    }\n    \n    test_cases = [case_A, case_B, case_C]\n    \n    all_results = []\n    for case in test_cases:\n        result = analyze_case(case)\n        all_results.append(result)\n        \n    # Format the final output string to match the problem specification\n    result_strings = [f\"[{','.join(map(str, res))}]\" for res in all_results]\n    final_output = f\"[{','.join(result_strings)}]\"\n    print(final_output)\n\n# Execute the solution\nsolve()\n\n```", "id": "3358634"}]}