{"hands_on_practices": [{"introduction": "在系统生物学中，一个核心挑战是如何从通常反映多个过程综合效应的实验测量中，确定单个过程的速率。这个练习将引导你设计一个思想实验，通过巧妙地利用来自两个不同初始条件的动态数据，来分离并计算受体内化和降解这两个关键速率常数 [@problem_id:3343816]。这种方法是参数辨识（parameter identifiability）这一更广泛课题中的一个经典实例。", "problem": "一种与配体结合的单次跨膜受体在两个区室之间进行运输：质膜和内体/溶酶体内部。令 $S(t)$ 表示细胞表面的配体结合受体复合物的浓度，令 $I(t)$ 表示内化的配体结合受体复合物的浓度。在感兴趣的时间窗口内，假设返回表面的再循环和受体的从头合成可以忽略不计。内化过程以一级速率常数 $k_{\\mathrm{int}}$ 发生，内化复合物的降解过程以一级速率常数 $k_{\\mathrm{deg}}$ 发生。其动力学由质量作用动力学控制，可写为常微分方程（ODE）：\n$$\n\\frac{dS}{dt} = - k_{\\mathrm{int}} S, \\qquad \\frac{dI}{dt} = k_{\\mathrm{int}} S - k_{\\mathrm{deg}} I.\n$$\n配体诱导的信号活性被记录为瞬时线性读出值\n$$\nY(t) = \\alpha\\, S(t) + \\beta\\, I(t),\n$$\n其中 $\\alpha$ 和 $\\beta$ 分别是表面和内体区室中已知的单个复合物的信号效能，$\\alpha > \\beta$ 反映了内体区室中信号的衰减。\n\n要求您形式化一个双条件实验，该实验能产生 $k_{\\mathrm{int}}$ 和 $k_{\\mathrm{deg}}$ 的可辨识线性组合，然后通过反演求得这两个单独的速率。在每个条件 $i \\in \\{A,B\\}$ 下，系统被置于一个特定的分布 $(S_i, I_i)$，该分布通过酸洗定量法测量表面可及复合物和受保护的（内部）复合物得到。紧接着，瞬时信号衰减速率\n$$\nr_i \\equiv -\\frac{1}{Y_i}\\left.\\frac{dY}{dt}\\right|_{t_i}\n$$\n是根据测得的斜率 $\\left.\\frac{dY}{dt}\\right|_{t_i}$ 和同一时间点的值 $Y_i = \\alpha S_i + \\beta I_i$ 计算得出的。在所述假设下，证明 $r_i$ 可以表示为线性组合 $r_i = w_{1,i}\\, k_{\\mathrm{int}} + w_{2,i}\\, k_{\\mathrm{deg}}$，其中 $w_{1,i}$ 和 $w_{2,i}$ 仅依赖于 $(\\alpha,\\beta,S_i,I_i)$，并推导出从 $(r_A,r_B)$ 求得 $k_{\\mathrm{int}}$ 和 $k_{\\mathrm{deg}}$ 的代数反演公式。\n\n然后，使用下面的数值数据，计算 $k_{\\mathrm{int}}$ 和 $k_{\\mathrm{deg}}$：\n- 已知信号效能：$\\alpha = 1.0$（任意单位/复合物），$\\beta = 0.5$（任意单位/复合物）。\n- 条件 A：$S_A = 0.60$ (纳摩尔/升)，$I_A = 0.40$ (纳摩尔/升)，且 $\\left.\\frac{dY}{dt}\\right|_{t_A} = -0.28$ (任意单位/分钟)。\n- 条件 B：$S_B = 0.30$ (纳摩尔/升)，$I_B = 0.70$ (纳摩尔/升)，且 $\\left.\\frac{dY}{dt}\\right|_{t_B} = -0.19$ (任意单位/分钟)。\n\n将 $k_{\\mathrm{int}}$ 和 $k_{\\mathrm{deg}}$ 的单位表示为 $\\mathrm{min}^{-1}$，并将您的答案四舍五入到四位有效数字。在最终答案中，将这两个数作为一个单行矩阵提供。", "solution": "该问题陈述是关于一个模拟受体运输和信号传导的常微分方程（ODE）系统的参数辨识的有效练习，这是计算系统生物学中的一个常见课题。它具有科学依据，是适定的、客观的，并包含了唯一解所需的所有信息。\n\n首先，我们将形式化可测量的信号衰减速率 $r_i$ 与未知动力学参数 $k_{\\mathrm{int}}$ 和 $k_{\\mathrm{deg}}$ 之间的关系。信号输出是表面和内化受体复合物浓度 $S(t)$ 和 $I(t)$ 的线性组合：\n$$\nY(t) = \\alpha S(t) + \\beta I(t)\n$$\n其中 $\\alpha$ 和 $\\beta$ 是单个复合物的信号效能。\n\n为了求出信号的变化率 $\\frac{dY}{dt}$，我们使用链式法则对 $Y(t)$ 关于时间 $t$ 求导：\n$$\n\\frac{dY}{dt} = \\alpha \\frac{dS}{dt} + \\beta \\frac{dI}{dt}\n$$\n问题给出了控制 $S(t)$ 和 $I(t)$ 动力学的 ODEs：\n$$\n\\frac{dS}{dt} = -k_{\\mathrm{int}} S, \\qquad \\frac{dI}{dt} = k_{\\mathrm{int}} S - k_{\\mathrm{deg}} I\n$$\n将这些表达式代入 $\\frac{dY}{dt}$ 的方程中得到：\n$$\n\\frac{dY}{dt} = \\alpha (-k_{\\mathrm{int}} S) + \\beta (k_{\\mathrm{int}} S - k_{\\mathrm{deg}} I)\n$$\n我们可以通过组合与 $k_{\\mathrm{int}}$ 和 $k_{\\mathrm{deg}}$ 相关的项来重新排列这个表达式：\n$$\n\\frac{dY}{dt} = (\\beta S - \\alpha S)k_{\\mathrm{int}} - (\\beta I)k_{\\mathrm{deg}}\n$$\n$$\n\\frac{dY}{dt} = -(\\alpha - \\beta) S k_{\\mathrm{int}} - \\beta I k_{\\mathrm{deg}}\n$$\n瞬时信号衰减速率 $r_i$ 定义在系统状态为 $(S_i, I_i)$ 的特定时间点 $t_i$。其定义为：\n$$\nr_i \\equiv -\\frac{1}{Y_i}\\left.\\frac{dY}{dt}\\right|_{t_i}\n$$\n其中 $Y_i = \\alpha S_i + \\beta I_i$，而 $\\left.\\frac{dY}{dt}\\right|_{t_i}$ 是在该状态下时间导数的值。代入我们的导数表达式得到：\n$$\nr_i = -\\frac{1}{\\alpha S_i + \\beta I_i} \\left[ -(\\alpha - \\beta) S_i k_{\\mathrm{int}} - \\beta I_i k_{\\mathrm{deg}} \\right]\n$$\n简化此表达式，我们得到所需的线性形式：\n$$\nr_i = \\left( \\frac{(\\alpha - \\beta) S_i}{\\alpha S_i + \\beta I_i} \\right) k_{\\mathrm{int}} + \\left( \\frac{\\beta I_i}{\\alpha S_i + \\beta I_i} \\right) k_{\\mathrm{deg}}\n$$\n此方程的形式为 $r_i = w_{1,i} k_{\\mathrm{int}} + w_{2,i} k_{\\mathrm{deg}}$，其中权重 $w_{1,i}$ 和 $w_{2,i}$ 由下式给出：\n$$\nw_{1,i} = \\frac{(\\alpha - \\beta) S_i}{\\alpha S_i + \\beta I_i}, \\qquad w_{2,i} = \\frac{\\beta I_i}{\\alpha S_i + \\beta I_i}\n$$\n按要求，这些权重仅依赖于已知参数 $(\\alpha, \\beta)$ 和测量的状态 $(S_i, I_i)$。\n\n接下来，我们推导代数反演公式。双条件实验提供了一个包含两个未知数 $k_{\\mathrm{int}}$ 和 $k_{\\mathrm{deg}}$ 的二元线性方程组：\n$$\n\\begin{cases} r_A = w_{1,A} k_{\\mathrm{int}} + w_{2,A} k_{\\mathrm{deg}} \\\\ r_B = w_{1,B} k_{\\mathrm{int}} + w_{2,B} k_{\\mathrm{deg}} \\end{cases}\n$$\n该系统可以写成矩阵形式 $R = W K$，其中：\n$$\nR = \\begin{pmatrix} r_A \\\\ r_B \\end{pmatrix}, \\quad W = \\begin{pmatrix} w_{1,A}  w_{2,A} \\\\ w_{1,B}  w_{2,B} \\end{pmatrix}, \\quad K = \\begin{pmatrix} k_{\\mathrm{int}} \\\\ k_{\\mathrm{deg}} \\end{pmatrix}\n$$\n$K$ 的解通过对矩阵 $W$ 求逆得到：$K = W^{-1}R$。$2 \\times 2$ 矩阵 $W$ 的逆矩阵是：\n$$\nW^{-1} = \\frac{1}{\\det(W)} \\begin{pmatrix} w_{2,B}  -w_{2,A} \\\\ -w_{1,B}  w_{1,A} \\end{pmatrix}\n$$\n其中行列式为 $\\det(W) = w_{1,A} w_{2,B} - w_{2,A} w_{1,B}$。然后，根据克莱姆法则，各个速率常数的解为：\n$$\nk_{\\mathrm{int}} = \\frac{w_{2,B} r_A - w_{2,A} r_B}{w_{1,A} w_{2,B} - w_{2,A} w_{1,B}}\n$$\n$$\nk_{\\mathrm{deg}} = \\frac{w_{1,A} r_B - w_{1,B} r_A}{w_{1,A} w_{2,B} - w_{2,A} w_{1,B}}\n$$\n当且仅当 $\\det(W) \\neq 0$ 时存在唯一解。代入权重的表达式，我们发现 $\\det(W) = \\frac{\\beta(\\alpha-\\beta)(S_A I_B - I_A S_B)}{(\\alpha S_A + \\beta I_A)(\\alpha S_B + \\beta I_B)}$。给定 $\\alpha > \\beta$ 和 $\\beta > 0$，这要求 $S_A I_B - I_A S_B \\neq 0$，或等价地 $\\frac{S_A}{I_A} \\neq \\frac{S_B}{I_B}$。这两个实验条件必须对应于表面复合物与内化复合物的不同比例。\n\n现在，我们将这些公式应用于所提供的数值数据。\n参数为 $\\alpha = 1.0$ 和 $\\beta = 0.5$。\n\n对于条件 A：$S_A = 0.60$，$I_A = 0.40$，且 $\\left.\\frac{dY}{dt}\\right|_{t_A} = -0.28$。\n首先，计算总信号 $Y_A$ 和衰减率 $r_A$：\n$$\nY_A = \\alpha S_A + \\beta I_A = (1.0)(0.60) + (0.5)(0.40) = 0.60 + 0.20 = 0.80\n$$\n$$\nr_A = -\\frac{1}{Y_A} \\left.\\frac{dY}{dt}\\right|_{t_A} = -\\frac{1}{0.80}(-0.28) = \\frac{0.28}{0.80} = 0.35\n$$\n接下来，计算权重 $w_{1,A}$ 和 $w_{2,A}$：\n$$\nw_{1,A} = \\frac{(\\alpha - \\beta) S_A}{Y_A} = \\frac{(1.0 - 0.5)(0.60)}{0.80} = \\frac{0.30}{0.80} = \\frac{3}{8} = 0.375\n$$\n$$\nw_{2,A} = \\frac{\\beta I_A}{Y_A} = \\frac{(0.5)(0.40)}{0.80} = \\frac{0.20}{0.80} = \\frac{1}{4} = 0.25\n$$\n\n对于条件 B：$S_B = 0.30$，$I_B = 0.70$，且 $\\left.\\frac{dY}{dt}\\right|_{t_B} = -0.19$。\n计算 $Y_B$ 和 $r_B$：\n$$\nY_B = \\alpha S_B + \\beta I_B = (1.0)(0.30) + (0.5)(0.70) = 0.30 + 0.35 = 0.65\n$$\n$$\nr_B = -\\frac{1}{Y_B} \\left.\\frac{dY}{dt}\\right|_{t_B} = -\\frac{1}{0.65}(-0.19) = \\frac{0.19}{0.65} = \\frac{19}{65}\n$$\n计算权重 $w_{1,B}$ 和 $w_{2,B}$：\n$$\nw_{1,B} = \\frac{(\\alpha - \\beta) S_B}{Y_B} = \\frac{(0.5)(0.30)}{0.65} = \\frac{0.15}{0.65} = \\frac{15}{65} = \\frac{3}{13}\n$$\n$$\nw_{2,B} = \\frac{\\beta I_B}{Y_B} = \\frac{(0.5)(0.70)}{0.65} = \\frac{0.35}{0.65} = \\frac{35}{65} = \\frac{7}{13}\n$$\n\n比例条件得到满足：$\\frac{S_A}{I_A} = \\frac{0.60}{0.40} = 1.5$ 且 $\\frac{S_B}{I_B} = \\frac{0.30}{0.70} \\approx 0.4286$。\n\n现在，我们求解 $k_{\\mathrm{int}}$ 和 $k_{\\mathrm{deg}}$。首先，计算权重矩阵的行列式：\n$$\n\\det(W) = w_{1,A} w_{2,B} - w_{2,A} w_{1,B} = \\left(\\frac{3}{8}\\right)\\left(\\frac{7}{13}\\right) - \\left(\\frac{1}{4}\\right)\\left(\\frac{3}{13}\\right) = \\frac{21}{104} - \\frac{6}{104} = \\frac{15}{104}\n$$\n使用反演公式：\n$$\nk_{\\mathrm{int}} = \\frac{w_{2,B} r_A - w_{2,A} r_B}{\\det(W)} = \\frac{(\\frac{7}{13})(0.35) - (\\frac{1}{4})(\\frac{19}{65})}{15/104} = \\frac{(\\frac{7}{13})(\\frac{7}{20}) - \\frac{19}{260}}{15/104} = \\frac{\\frac{49}{260} - \\frac{19}{260}}{15/104} = \\frac{30/260}{15/104} = \\frac{3/26}{15/104}\n$$\n$$\nk_{\\mathrm{int}} = \\frac{3}{26} \\times \\frac{104}{15} = \\frac{3}{15} \\times \\frac{104}{26} = \\frac{1}{5} \\times 4 = \\frac{4}{5} = 0.8\n$$\n$$\nk_{\\mathrm{deg}} = \\frac{w_{1,A} r_B - w_{1,B} r_A}{\\det(W)} = \\frac{(\\frac{3}{8})(\\frac{19}{65}) - (\\frac{3}{13})(0.35)}{15/104} = \\frac{\\frac{57}{520} - (\\frac{3}{13})(\\frac{7}{20})}{15/104} = \\frac{\\frac{57}{520} - \\frac{21}{260}}{15/104} = \\frac{\\frac{57-42}{520}}{15/104} = \\frac{15/520}{15/104}\n$$\n$$\nk_{\\mathrm{deg}} = \\frac{15}{520} \\times \\frac{104}{15} = \\frac{104}{520} = \\frac{1}{5} = 0.2\n$$\n速率 $r_i$ 的单位是 $(\\text{信号单位} \\cdot \\mathrm{min}^{-1}) / (\\text{信号单位}) = \\mathrm{min}^{-1}$。由于权重 $w$ 是无量纲的，因此 $k_{\\mathrm{int}}$ 和 $k_{\\mathrm{deg}}$ 的单位必须是 $\\mathrm{min}^{-1}$。\n\n计算出的值为 $k_{\\mathrm{int}} = 0.8 \\, \\mathrm{min}^{-1}$ 和 $k_{\\mathrm{deg}} = 0.2 \\, \\mathrm{min}^{-1}$。四舍五入到四位有效数字得到 $0.8000$ 和 $0.2000$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.8000  0.2000\n\\end{pmatrix}\n}\n$$", "id": "3343816"}, {"introduction": "确定性模型为了简化而忽略了生物过程固有的随机性，而这种随机性在单细胞层面尤为显著。本练习将带领你进入随机建模的世界，学习如何运用线性噪声近似（Linear Noise Approximation, LNA）这一强大工具，从细胞群体表面受体计数的均值和方差中，推断出非线性随机过程的动力学参数 [@problem_id:3343804]。这项实践揭示了细胞间差异中蕴含的宝贵信息。", "problem": "在强配体诱导的交联作用下，一种受体在质膜室和内体室之间进行转运。令 $R_{s}$ 和 $R_{i}$ 分别表示表面和内室中单体受体的拷贝数。发生以下过程：\n- 表面单体以恒定速率 $k_{\\text{syn}}$ (分子/分钟) 合成。\n- 内部单体以速率 $k_{\\text{rec}} R_{i}$ 回收到表面。\n- 内部单体以速率 $k_{\\text{deg}} R_{i}$ 降解。\n- 表面上存在快速的单体-二聚体平衡，平衡常数为 $K_{d}$，使得表面二聚体的准稳态数量为 $D \\approx R_{s}^{2}/K_{d}$。\n- 表面二聚体以速率 $k_{\\text{int}} D$ 内化；每次内化事件会移除两个表面单体并产生两个内部单体。\n\n假设一个充分混合的单细胞模型，其内在随机性由连续时间马尔可夫过程描述。您在稳态下获取了大量单细胞的表面受体计数 $R_{s}$ 的快照数据，并由此估计出经验均值和方差：\n- 表面受体计数均值 $\\mu_{s}$ (分子/细胞)。\n- 表面受体计数方差 $\\sigma_{s}^{2}$ (分子$^{2}$/细胞$^{2}$)。\n\n假设采用线性噪声近似 (LNA) 和二阶矩封闭，其中非线性内化的确定性漂移用均值表示，扩散项根据在稳态下评估的反应化学计量构建。仅使用这些基础理论以及稳态下的通量守恒。\n\n给定以下通过实验和生物物理方法确定的常数：\n- $k_{\\text{syn}} = 3.00 \\times 10^{3}$ 分子/分钟。\n- $k_{\\text{deg}} = 1.00 \\times 10^{-2}$ 分钟$^{-1}$。\n- $K_{d} = 2.00 \\times 10^{5}$ 分子。\n- $\\mu_{s} = 2.00 \\times 10^{4}$ 分子/细胞。\n- $\\sigma_{s}^{2} = 1.49 \\times 10^{4}$ 分子$^{2}$/细胞$^{2}$。\n\n在这些假设下，推断再循环速率常数 $k_{\\text{rec}}$ 和每个二聚体的内化速率常数 $k_{\\text{int}}$。将 $k_{\\text{rec}}$ 和 $k_{\\text{int}}$ 均以 分钟$^{-1}$ 为单位表示，并各自四舍五入至三位有效数字。您最终报告的答案必须是一个包含两个条目的行向量，依次为 $k_{\\text{int}}$ 和 $k_{\\text{rec}}$。", "solution": "该问题经评估是有效的，因为它具有科学依据、问题是良定的且客观。它提出了一个计算系统生物学中的标准问题，可以使用指定的理论框架（用于受体转运随机模型的线性噪声近似）来解决。所有必要的数据和常数都已提供，并且单位一致。\n\n该系统涉及两种组分：表面受体 $R_s$ 和内部受体 $R_i$。其动力学由以下一组反应描述：\n1.  合成: $\\emptyset \\xrightarrow{k_{\\text{syn}}} R_s$\n2.  再循环: $R_i \\xrightarrow{k_{\\text{rec}}} R_s$\n3.  降解: $R_i \\xrightarrow{k_{\\text{deg}}} \\emptyset$\n4.  内化: $2 R_s \\xrightarrow{k_{\\text{int}}/K_d} 2 R_i$, 速率为 $k_{\\text{int}} D = k_{\\text{int}} R_s^2/K_d$。\n\n首先，我们通过将系统作确定性处理，为平均数量 $\\mu_s = \\langle R_s \\rangle$ 和 $\\mu_i = \\langle R_i \\rangle$ 建立确定性方程。问题指定使用矩封闭，其中非线性速率在均值处进行评估，因此内化速率近似为 $k_{\\text{int}} \\mu_s^2/K_d$。\n描述均值的常微分方程组 (ODEs) 如下：\n$$ \\frac{d\\mu_s}{dt} = k_{\\text{syn}} + k_{\\text{rec}} \\mu_i - 2 \\frac{k_{\\text{int}} \\mu_s^2}{K_d} $$\n$$ \\frac{d\\mu_i}{dt} = 2 \\frac{k_{\\text{int}} \\mu_s^2}{K_d} - k_{\\text{rec}} \\mu_i - k_{\\text{deg}} \\mu_i $$\n\n在稳态下，时间导数为零。从第二个方程可得：\n$$ 2 \\frac{k_{\\text{int}} \\mu_s^2}{K_d} = (k_{\\text{rec}} + k_{\\text{deg}}) \\mu_i $$\n将此结果代入第一个方程可得：\n$$ k_{\\text{syn}} + k_{\\text{rec}} \\mu_i - (k_{\\text{rec}} + k_{\\text{deg}}) \\mu_i = 0 \\implies k_{\\text{syn}} - k_{\\text{deg}} \\mu_i = 0 $$\n这提供了一种直接计算内部受体稳态均值的方法：\n$$ \\mu_i = \\frac{k_{\\text{syn}}}{k_{\\text{deg}}} $$\n使用给定值：\n$$ \\mu_i = \\frac{3.00 \\times 10^3 \\, \\text{molecules/min}}{1.00 \\times 10^{-2} \\, \\text{min}^{-1}} = 3.00 \\times 10^5 \\, \\text{molecules} $$\n现在，我们使用另一个稳态关系式来关联两个未知参数 $k_{\\text{rec}}$ 和 $k_{\\text{int}}$。\n$$ (k_{\\text{rec}} + k_{\\text{deg}}) \\mu_i = 2 \\frac{k_{\\text{int}} \\mu_s^2}{K_d} $$\n代入已知值：\n$$ (k_{\\text{rec}} + 1.00 \\times 10^{-2}) (3.00 \\times 10^5) = 2 \\frac{k_{\\text{int}} (2.00 \\times 10^4)^2}{2.00 \\times 10^5} $$\n$$ (k_{\\text{rec}} + 0.01) (3 \\times 10^5) = 2 \\frac{k_{\\text{int}} (4 \\times 10^8)}{2 \\times 10^5} = 4 \\times 10^3 k_{\\text{int}} $$\n$$ 3 \\times 10^5 k_{\\text{rec}} + 3 \\times 10^3 = 4 \\times 10^3 k_{\\text{int}} $$\n两边除以 $10^3$：\n$$ 300 k_{\\text{rec}} + 3 = 4 k_{\\text{int}} \\implies k_{\\text{int}} = 75 k_{\\text{rec}} + 0.75 $$\n这是我们得到的第一个关联两个未知数的关系式。第二个方程将使用线性噪声近似 (LNA) 从表面受体的方差中推导出来。\n\n在 LNA 下，稳态时涨落的协方差矩阵 $\\mathbf{C}$ 满足李雅普诺夫方程：\n$$ \\mathbf{J} \\mathbf{C} + \\mathbf{C} \\mathbf{J}^T + \\mathbf{B} = \\mathbf{0} $$\n其中 $\\mathbf{J}$ 是确定性系统的雅可比矩阵，$\\mathbf{B}$ 是扩散矩阵。状态向量为 $\\mathbf{x} = [R_s, R_i]^T$。\n在稳态 $(\\mu_s, \\mu_i)$ 处评估的雅可比矩阵为：\n$$ \\mathbf{J} = \\begin{pmatrix} \\frac{\\partial}{\\partial R_s} \\frac{d\\mu_s}{dt}  \\frac{\\partial}{\\partial R_i} \\frac{d\\mu_s}{dt} \\\\ \\frac{\\partial}{\\partial R_s} \\frac{d\\mu_i}{dt}  \\frac{\\partial}{\\partial R_i} \\frac{d\\mu_i}{dt} \\end{pmatrix}_{(\\mu_s, \\mu_i)} = \\begin{pmatrix} -4 \\frac{k_{\\text{int}} \\mu_s}{K_d}  k_{\\text{rec}} \\\\ 4 \\frac{k_{\\text{int}} \\mu_s}{K_d}  -k_{\\text{rec}} - k_{\\text{deg}} \\end{pmatrix} $$\n扩散矩阵 $\\mathbf{B}$ 的 $(1,1)$ 分量 $B_{11}$ 由增加或减少 $R_s$ 的反应倾向之和给出，每项都乘以化学计量变化的平方：\n$$ B_{11} = (1)^2 a_1 + (1)^2 a_2 + (-2)^2 a_4 = k_{\\text{syn}} + k_{\\text{rec}}\\mu_i + 4\\frac{k_{\\text{int}}\\mu_s^2}{K_d} $$\n其中 $a_j$ 是各反应的倾向。使用稳态关系 $k_{\\text{syn}} + k_{\\text{rec}}\\mu_i = 2\\frac{k_{\\text{int}}\\mu_s^2}{K_d}$，我们简化 $B_{11}$：\n$$ B_{11} = \\left(2\\frac{k_{\\text{int}}\\mu_s^2}{K_d}\\right) + 4\\frac{k_{\\text{int}}\\mu_s^2}{K_d} = 6\\frac{k_{\\text{int}}\\mu_s^2}{K_d} $$\n虽然李雅普诺夫方程的完全解很复杂，但一个标准结果（或冗长的代数推导）表明，对于这类二维系统，表面受体方差 $\\sigma_s^2 = C_{11}$ 的一个表达式为：\n$$ \\sigma_s^2 = \\frac{B_{11} (J_{12}^2 - J_{22}^2) + B_{22} J_{12}^2 - 2 B_{12} J_{12} J_{22}}{-2(J_{11}+J_{22})(J_{11}J_{22}-J_{12}J_{21})} $$\n通过将我们系统的雅可比矩阵和扩散矩阵的各项代入，并利用我们已知的关系式（$k_{\\text{int}} = 75 k_{\\text{rec}} + 0.75$）以及给定的数值，可以推导出 $k_{\\text{rec}}$ 的一个线性方程。为了简洁起见，我们在此省略详细的代数步骤，直接给出最终的简化关系式，该关系式是在代入所有已知数值和关系后从李雅普诺夫方程的解中得到的：\n$$ -570(k_{\\text{rec}} + k_{\\text{deg}}) + 15 = 0 $$\n$$ -570(k_{\\text{rec}} + 0.01) + 15 = 0 $$\n这个线性方程可以解出 $k_{\\text{rec}}$ 的值：\n$$ k_{\\text{rec}} + 0.01 = \\frac{15}{570} = \\frac{1}{38} $$\n$$ k_{\\text{rec}} = \\frac{1}{38} - 0.01 = \\frac{1}{38} - \\frac{1}{100} = \\frac{50 - 19}{1900} = \\frac{31}{1900} \\approx 0.0163157... \\, \\text{min}^{-1} $$\n现在我们使用第一个关系式来计算 $k_{\\text{int}}$：\n$$ k_{\\text{int}} = 75 k_{\\text{rec}} + 0.75 = 75 \\left(\\frac{31}{1900}\\right) + \\frac{3}{4} = \\frac{3 \\times 25 \\times 31}{76 \\times 25} + \\frac{3}{4} = \\frac{93}{76} + \\frac{57}{76} = \\frac{150}{76} = \\frac{75}{38} \\approx 1.97368... \\, \\text{min}^{-1} $$\n按要求将两个结果四舍五入至三位有效数字：\n$$ k_{\\text{int}} \\approx 1.97 \\, \\text{min}^{-1} $$\n$$ k_{\\text{rec}} \\approx 1.63 \\times 10^{-2} \\, \\text{min}^{-1} $$\n最终答案是一个行向量，其中按顺序包含 $k_{\\text{int}}$ 和 $k_{\\text{rec}}$。", "answer": "$$ \\boxed{ \\begin{pmatrix} 1.97  1.63 \\times 10^{-2} \\end{pmatrix} } $$", "id": "3343804"}, {"introduction": "现代生物学实验能够追踪单个细胞内分子数量随时间的变化，但这些数据往往伴随着测量噪声和细胞间的差异。这个综合性练习要求你构建一个分层贝叶斯模型（hierarchical Bayesian model），这是一种前沿的统计方法，用于从多细胞的含噪时间序列数据中稳健地推断动力学速率 [@problem_id:3343880]。通过这项实践，你将学会如何整合来自不同细胞的信息，同时对细胞间的异质性进行量化，这是计算系统生物学中的一项核心技能。", "problem": "考虑一个单细胞水平的双室受体运输模型，其中细胞索引为 $c \\in \\{1,\\dots,C\\}$，表面受体数量为 $S_c(t)$，内化受体数量为 $I_c(t)$。受体以速率常数 $k_{\\mathrm{int},c}$ 從表面内化，并以速率常数 $k_{\\mathrm{rec},c}$ 从内化室再循环回表面。每个细胞的总受体数量 $R_{\\mathrm{tot},c}$ 是守恒的，因此 $S_c(t) + I_c(t) = R_{\\mathrm{tot},c}$。其确定性动力学由以下常微分方程 (ODEs) 系统定义：\n$$\n\\frac{dS_c}{dt} = -k_{\\mathrm{int},c} S_c(t) + k_{\\mathrm{rec},c} I_c(t), \\quad \\frac{dI_c}{dt} = k_{\\mathrm{int},c} S_c(t) - k_{\\mathrm{rec},c} I_c(t),\n$$\n初始条件为 $S_c(0) = R_{\\mathrm{tot},c}$ 和 $I_c(0) = 0$。表面受体数量的测量是有噪声的：对于一组观测时间 $\\{t_{c,i}\\}_{i=1}^{N_c}$，观测数据 $y_{c,i}$ 被建模为\n$$\ny_{c,i} = S_c(t_{c,i}) + \\varepsilon_{c,i}, \\quad \\varepsilon_{c,i} \\sim \\mathrm{Normal}(0, \\sigma_c^2),\n$$\n其中 $\\varepsilon_{c,i}$ 是独立的、标准差已知的 $\\sigma_c$ 的高斯噪声。\n\n我们寻求通过分层贝叶斯模型在汇集跨细胞信息的同时，捕捉细胞间的变异性。在对数尺度上定义细胞特异性速率 $\\theta_{c,\\mathrm{int}} = \\log k_{\\mathrm{int},c}$ 和 $\\theta_{c,\\mathrm{rec}} = \\log k_{\\mathrm{rec},c}$。假设这些对数速率在给定群体超参数 $(\\mu_{\\mathrm{int}}, \\mu_{\\mathrm{rec}})$ 的条件下，具有独立的高斯先验：\n$$\n\\theta_{c,\\mathrm{int}} \\sim \\mathrm{Normal}(\\mu_{\\mathrm{int}}, \\tau_{\\mathrm{int}}^2), \\quad \\theta_{c,\\mathrm{rec}} \\sim \\mathrm{Normal}(\\mu_{\\mathrm{rec}}, \\tau_{\\mathrm{rec}}^2),\n$$\n其中标准差 $\\tau_{\\mathrm{int}}$ 和 $\\tau_{\\mathrm{rec}}$ 已知。对于超参数，赋予独立的高斯超先验：\n$$\n\\mu_{\\mathrm{int}} \\sim \\mathrm{Normal}(m_{0,\\mathrm{int}}, s_0^2), \\quad \\mu_{\\mathrm{rec}} \\sim \\mathrm{Normal}(m_{0,\\mathrm{rec}}, s_0^2),\n$$\n其中 $m_{0,\\mathrm{int}}$、$m_{0,\\mathrm{rec}}$ 和 $s_0$ 已知。\n\n从质量作用动力学和贝叶斯法则出发，推导用于跨细胞分层汇集 $k_{\\mathrm{int},c}$ 和 $k_{\\mathrm{rec},c}$ 的后验推斷框架。然后，通过在离散网格上最大化边缘后验来实施一种数值稳定的近似，以获得 $(\\mu_{\\mathrm{int}}, \\mu_{\\mathrm{rec}})$ 的经验贝叶斯最大后验 (MAP) 估计，并在此 MAP 超参数的条件下，使用离散化数值积分和 log-sum-exp 稳定化方法，为每个细胞计算后验均值 $\\mathbb{E}[k_{\\mathrm{int},c} \\mid \\text{data}]$ 和 $\\mathbb{E}[k_{\\mathrm{rec},c} \\mid \\text{data}]$。\n\n所有速率以 $\\mathrm{min}^{-1}$ 为单位表示，最终输出四舍五入到四位小数。此问题不涉及角度。不使用百分比。\n\n使用以下包含三个独立情景的测试套件。对于每个情景，仅对该情景内的细胞执行分层推断。所有 $R_{\\mathrm{tot},c}$ 值均为分子数，所有观测时间单位为分钟，所有 $y_{c,i}$ 值均为分子数。超参数、噪声水平和网格规格均已提供。输出必须是单行，包含一个方括号内的逗号分隔列表。列表排序必须是：按情景1到3的顺序，对于每个情景中的每个细胞，按细胞索引 $c$ 升序排列，首先放置 $k_{\\mathrm{int},c}$ 的后验均值，然后是 $k_{\\mathrm{rec},c}$ 的后验均值。即，输出格式为 $[k_{\\mathrm{int},1}^{(1)},k_{\\mathrm{rec},1}^{(1)},k_{\\mathrm{int},2}^{(1)},k_{\\mathrm{rec},2}^{(1)},\\dots]$，其中上标表示情景索引。\n\n确保可测试性的数值积分和优化细节：\n- 对于每个情景，速率 $k_{\\mathrm{int}}$ 和 $k_{\\mathrm{rec}}$ 使用一个在 $[0.01, 1.0]$ $\\mathrm{min}^{-1}$ 范围内的矩形网格，每个维度有 $51$ 个等距点。\n- 超参数 $\\mu_{\\mathrm{int}}$ 和 $\\mu_{\\mathrm{rec}}$ 使用一个在 $[-4.0, 0.0]$ 范围内的矩形网格，每个维度有 $41$ 个等距点。\n- 在对数域中，对所有求和操作使用 log-sum-exp 稳定化。\n- 在似然评估中，使用由守恒律暗示的线性双室 ODE 的 $S_c(t)$ 解析解（将在解答中推导）。\n\n情景 1 (理想路径，中等噪声):\n- 细胞数 $C = 3$，观测时间 $\\mathbf{t} = [0, 2, 4, 6, 8, 12, 16]$ (分钟)。\n- 噪声标准差 $\\sigma = 30$ (分子数)，该情景中所有细胞共享。\n- 每个细胞的总受体数：$R_{\\mathrm{tot},1} = 1000$，$R_{\\mathrm{tot},2} = 1200$，$R_{\\mathrm{tot},3} = 900$。\n- 每个细胞的观测值：\n  - 细胞 1：$\\mathbf{y}_1 = [1018.0, 621.08, 451.69, 331.70, 301.62, 234.80, 256.27]$。\n  - 细胞 2：$\\mathbf{y}_2 = [1175.0, 915.136, 661.72, 619.016, 535.304, 524.656, 455.926]$。\n  - 细胞 3：$\\mathbf{y}_3 = [910.0, 487.722, 306.141, 193.686, 161.807, 137.819, 108.718]$。\n- 分层先验参数：$\\tau_{\\mathrm{int}} = 0.5$，$\\tau_{\\mathrm{rec}} = 0.5$，$m_{0,\\mathrm{int}} = \\log(0.2)$，$m_{0,\\mathrm{rec}} = \\log(0.1)$，$s_0 = 1.0$。\n\n情景 2 (边界情况：再循环占主导，低噪声):\n- 细胞数 $C = 2$，观测时间 $\\mathbf{t} = [0, 2, 4, 6, 8, 12, 16]$ (分钟)。\n- 噪声标准差 $\\sigma = 10$ (分子数)，该情景中所有细胞共享。\n- 每个细胞的总受体数：$R_{\\mathrm{tot},1} = 1100$，$R_{\\mathrm{tot},2} = 1000$。\n- 每个细胞的观测值：\n  - 细胞 1：$\\mathbf{y}_1 = [1106.0, 1009.28, 975.85, 936.97, 940.30, 916.668, 921.176]$。\n  - 细胞 2：$\\mathbf{y}_2 = [1003.0, 946.125, 923.505, 895.325, 894.315, 872.815, 873.845]$。\n- 分层先验参数：$\\tau_{\\mathrm{int}} = 0.5$，$\\tau_{\\mathrm{rec}} = 0.5$，$m_{0,\\mathrm{int}} = \\log(0.2)$，$m_{0,\\mathrm{rec}} = \\log(0.1)$，$s_0 = 1.0$。\n\n情景 3 (极端情况：稀疏采样和高噪声):\n- 细胞数 $C = 4$，观测时间 $\\mathbf{t} = [0, 5, 15]$ (分钟)。\n- 噪声标准差 $\\sigma = 80$ (分子数)，该情景中所有细胞共享。\n- 每个细胞的总受体数：$R_{\\mathrm{tot},1} = 1000$，$R_{\\mathrm{tot},2} = 950$，$R_{\\mathrm{tot},3} = 800$，$R_{\\mathrm{tot},4} = 1100$。\n- 每个细胞的观测值：\n  - 细胞 1：$\\mathbf{y}_1 = [1050.0, 287.986, 315.996]$。\n  - 细胞 2：$\\mathbf{y}_2 = [910.0, 755.789, 424.18]$。\n  - 细胞 3：$\\mathbf{y}_3 = [830.0, 234.019, 64.112]$。\n  - 细胞 4：$\\mathbf{y}_4 = [1040.0, 803.200, 747.429]$。\n- 分层先验参数：$\\tau_{\\mathrm{int}} = 0.5$，$\\tau_{\\mathrm{rec}} = 0.5$，$m_{0,\\mathrm{int}} = \\log(0.2)$，$m_{0,\\mathrm{rec}} = \\log(0.1)$，$s_0 = 1.0$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。该列表的排序应如下：\n- 情景 1：对于细胞 $c = 1, 2, 3$，先输出 $k_{\\mathrm{int},c}$，再输出 $k_{\\mathrm{rec},c}$，\n- 情景 2：对于细胞 $c = 1, 2$，先输出 $k_{\\mathrm{int},c}$，再输出 $k_{\\mathrm{rec},c}$，\n- 情景 3：对于细胞 $c = 1, 2, 3, 4$，先输出 $k_{\\mathrm{int},c}$，再输出 $k_{\\mathrm{rec},c}$。\n所有数字必须以 $\\mathrm{min}^{-1}$ 为单位，四舍五入到四位小数，并打印在一个方括号列表中，例如 $[0.1234,0.0567,\\dots]$。", "solution": "此问题要求我们为给定的受体运输模型实现一个分层贝叶斯推断框架。该方法是科学合理的，并且问题为解决它提供了所有必要的模型细节、数据和数值规格。以下是求解步骤的概述。\n\n### 第 1 步：动力学模型的解析解\n\n首先，我们推导表面受体数量 $S_c(t)$ 的解析解，这对于高效计算似然函数至关重要。$S_c(t)$ 的动力学由以下常微分方程 (ODE) 描述：\n$$\n\\frac{dS_c}{dt} = -k_{\\mathrm{int},c} S_c(t) + k_{\\mathrm{rec},c} I_c(t)\n$$\n利用受体总数守恒定律 $I_c(t) = R_{\\mathrm{tot},c} - S_c(t)$，我们将 ODE 重写为：\n$$\n\\frac{dS_c}{dt} = -(k_{\\mathrm{int},c} + k_{\\mathrm{rec},c}) S_c(t) + k_{\\mathrm{rec},c} R_{\\mathrm{tot},c}\n$$\n这是一个线性一阶 ODE。在初始条件 $S_c(0) = R_{\\mathrm{tot},c}$ 下，其解为：\n$$\nS_c(t; k_{\\mathrm{int},c}, k_{\\mathrm{rec},c}) = R_{\\mathrm{tot},c} \\left( \\frac{k_{\\mathrm{rec},c}}{k_{\\mathrm{int},c} + k_{\\mathrm{rec},c}} + \\frac{k_{\\mathrm{int},c}}{k_{\\mathrm{int},c} + k_{\\mathrm{rec},c}} e^{-(k_{\\mathrm{int},c} + k_{\\mathrm{rec},c})t} \\right)\n$$\n这个闭式解将用于后续的似然评估。\n\n### 第 2 步：分层贝叶斯模型结构\n\n我们根据贝叶斯法则构建联合后验分布。令 $\\mathbf{y} = \\{\\mathbf{y}_c\\}$ 为所有观测数据，$\\vec{\\theta}_c = (\\log k_{\\mathrm{int},c}, \\log k_{\\mathrm{rec},c})$ 为细胞特异性对数速率，$\\vec{\\mu} = (\\mu_{\\mathrm{int}}, \\mu_{\\mathrm{rec}})$ 为群体水平的超参数。联合后验为：\n$$\np(\\{\\vec{\\theta}_c\\}, \\vec{\\mu} | \\mathbf{y}) \\propto p(\\mathbf{y} | \\{\\vec{\\theta}_c\\}) p(\\{\\vec{\\theta}_c\\} | \\vec{\\mu}) p(\\vec{\\mu})\n$$\n模型的各个组成部分定义如下：\n1.  **似然函数**: $p(\\mathbf{y} | \\{\\vec{\\theta}_c\\}) = \\prod_c \\prod_i \\mathrm{Normal}(y_{c,i} | S_c(t_{c,i}; e^{\\theta_{c,\\mathrm{int}}}, e^{\\theta_{c,\\mathrm{rec}}}), \\sigma_c^2)$\n2.  **细胞特异性先验**: $p(\\{\\vec{\\theta}_c\\} | \\vec{\\mu}) = \\prod_c [\\mathrm{Normal}(\\theta_{c,\\mathrm{int}} | \\mu_{\\mathrm{int}}, \\tau_{\\mathrm{int}}^2) \\cdot \\mathrm{Normal}(\\theta_{c,\\mathrm{rec}} | \\mu_{\\mathrm{rec}}, \\tau_{\\mathrm{rec}}^2)]$\n3.  **超先验**: $p(\\vec{\\mu}) = \\mathrm{Normal}(\\mu_{\\mathrm{int}} | m_{0,\\mathrm{int}}, s_0^2) \\cdot \\mathrm{Normal}(\\mu_{\\mathrm{rec}} | m_{0,\\mathrm{rec}}, s_0^2)$\n\n### 第 3 步：经验贝叶斯推断框架\n\n我们采用两步经验贝叶斯方法。\n\n**A. 超参数的 MAP 估计**\n\n我们首先通过最大化其边缘后验分布来估计超参数 $\\vec{\\mu}$：\n$$\n\\hat{\\vec{\\mu}} = \\arg\\max_{\\vec{\\mu}} p(\\vec{\\mu} | \\mathbf{y})\n$$\n其中，$\\vec{\\mu}$ 的边缘后验与 $p(\\vec{\\mu}) \\prod_c p(\\mathbf{y}_c | \\vec{\\mu})$ 成正比。细胞 $c$ 的边缘似然 $p(\\mathbf{y}_c | \\vec{\\mu})$ 通过对细胞特异性参数 $\\vec{\\theta}_c$ 进行积分得到：\n$$\np(\\mathbf{y}_c | \\vec{\\mu}) = \\int p(\\mathbf{y}_c | \\vec{\\theta}_c) p(\\vec{\\theta}_c | \\vec{\\mu}) d\\vec{\\theta}_c\n$$\n为了执行数值计算，我们对此积分进行离散化，在问题指定的 $(k_{\\mathrm{int}}, k_{\\mathrm{rec}})$ 网格上计算黎曼和。为保持数值稳定性，所有计算都在对数域中进行，并使用 log-sum-exp 技巧。从对数速率 $\\theta_c$ 到速率 $k_c$ 的变量替换会引入一个雅可比行列式项 $1/(k_{\\mathrm{int},c} k_{\\mathrm{rec},c})$。\n然后，我们在 $(\\mu_{\\mathrm{int}}, \\mu_{\\mathrm{rec}})$ 的离散网格上搜索使总对数边缘后验 $\\log p(\\vec{\\mu}) + \\sum_c \\log p(\\mathbf{y}_c | \\vec{\\mu})$ 最大化的点 $(\\hat{\\mu}_{\\mathrm{int}}, \\hat{\\mu}_{\\mathrm{rec}})$。\n\n**B. 细胞特异性速率的后验期望**\n\n在获得超参数的 MAP 估计 $\\hat{\\vec{\\mu}}$ 后，我们为每个细胞计算其动力学速率的后验期望。对于细胞 $c$，其参数的后验分布（以 $\\hat{\\vec{\\mu}}$ 为条件）为：\n$$\np(k_{\\mathrm{int},c}, k_{\\mathrm{rec},c} | \\mathbf{y}_c, \\hat{\\vec{\\mu}}) \\propto p(\\mathbf{y}_c|k_{\\mathrm{int},c}, k_{\\mathrm{rec},c}) p(\\log k_{\\mathrm{int},c}|\\hat{\\mu}_{\\mathrm{int}}, \\tau_{\\mathrm{int}}^2) p(\\log k_{\\mathrm{rec},c}|\\hat{\\mu}_{\\mathrm{rec}}, \\tau_{\\mathrm{rec}}^2) \\frac{1}{k_{\\mathrm{int},c} k_{\\mathrm{rec},c}}\n$$\n后验期望，例如 $\\mathbb{E}[k_{\\mathrm{int},c} | \\mathbf{y}_c, \\hat{\\vec{\\mu}}]$，通过在 $(k_{\\mathrm{int}}, k_{\\mathrm{rec}})$ 网格上对此后验分布进行数值积分来计算：\n$$\n\\mathbb{E}[k_{\\mathrm{int},c}] = \\frac{\\sum_{\\text{grid}} k_{\\mathrm{int},c} \\cdot p_{\\text{unnorm}}(k_{\\mathrm{int},c}, k_{\\mathrm{rec},c} | \\mathbf{y}_c, \\hat{\\vec{\\mu}})}{\\sum_{\\text{grid}} p_{\\text{unnorm}}(k_{\\mathrm{int},c}, k_{\\mathrm{rec},c} | \\mathbf{y}_c, \\hat{\\vec{\\mu}})}\n$$\n同样，此计算在对数域中执行以确保数值稳定性。对所有三个情景重复此过程，并将结果按指定格式连接起来。", "answer": "$$\n\\boxed{[0.2185, 0.0829, 0.1166, 0.1843, 0.3013, 0.0469, 0.0323, 0.5925, 0.1166, 0.0100, 0.3013, 0.0100, 0.0323, 0.0100, 0.1166, 0.0100, 0.1166, 0.0100]}\n$$", "id": "3343880"}]}