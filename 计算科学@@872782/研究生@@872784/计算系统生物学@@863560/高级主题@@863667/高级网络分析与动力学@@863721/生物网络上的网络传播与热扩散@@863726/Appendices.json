{"hands_on_practices": [{"introduction": "为了深入理解网络扩散过程，我们首先需要掌握其核心的数学构建。这个练习将指导你为一个小的蛋白质相互作用网络手动构建邻接矩阵、度矩阵和组合拉普拉斯矩阵 [@problem_id:3332495]。通过从第一性原理出发进行推导，你将验证组合拉普拉斯算子如何内在地保证了总“热量”的守恒，这是封闭网络中扩散过程的一个基本属性。", "problem": "考虑一个带权无向的蛋白质-蛋白质相互作用（PPI）网络，其节点集为 $\\{p_{1}, p_{2}, p_{3}, p_{4}\\}$。节点 $p_{i}$ 和 $p_{j}$ 之间的边带有一个非负权重 $w_{ij}$，表示相互作用的强度。假设不存在自环。非零的相互作用权重为：\n- $w_{12} = 0.7$，\n- $w_{13} = 0.1$，\n- $w_{23} = 0.4$，\n- $w_{24} = 0.5$，\n- $w_{34} = 0.2$。\n\n使用节点排序 $(p_{1}, p_{2}, p_{3}, p_{4})$：\n1. 构建邻接矩阵 $A \\in \\mathbb{R}^{4 \\times 4}$，其中如果边存在，则当 $i \\neq j$ 时 $A_{ij} = w_{ij}$，且 $A_{ii} = 0$。\n2. 构建度矩阵 $D \\in \\mathbb{R}^{4 \\times 4}$，该矩阵为对角矩阵，其元素为 $D_{ii} = \\sum_{j=1}^{4} A_{ij}$；并构建度向量 $d \\in \\mathbb{R}^{4}$，其元素为 $d_{i} = D_{ii}$。\n3. 对每个 $i \\in \\{1,2,3,4\\}$，明确验证 $\\sum_{j=1}^{4} A_{ij} = D_{ii}$。\n\n定义组合图拉普拉斯算子 $L = D - A$。考虑该网络上的连续时间热扩散过程，该过程由常微分方程\n$\\frac{d}{dt} x(t) = - L \\, x(t)$\n和初始条件\n$x(0) = \\begin{pmatrix} 1 \\\\ 2 \\\\ 0.5 \\\\ 1.5 \\end{pmatrix}$\n控制。\n仅使用 $A$、$D$ 和 $L$ 的基本定义以及上述动力学方程（不使用任何预先声明的守恒定律），从第一性原理推导总热量 $S(t) = \\mathbf{1}^{\\top} x(t)$ 是否随时间守恒，其中 $\\mathbf{1} \\in \\mathbb{R}^{4}$ 是全为1的向量。然后，计算你的推导所蕴含的 $S(t)$ 的恒定值。\n\n最终答案以一个无单位的实数形式给出。不要四舍五入；提供由上述数据所蕴含的精确值。", "solution": "该问题是有效的，因为它具有科学依据、问题明确、内部一致，并且依赖于计算系统生物学和网络理论中的标准定义和原理。\n\n问题要求我们确定在一个给定的蛋白质-蛋白质相互作用（PPI）网络上的扩散过程中，总热量 $S(t)$ 是否守恒，并在其为恒定值的情况下计算该值。\n\n首先，我们根据提供的相互作用权重和节点排序 $(p_{1}, p_{2}, p_{3}, p_{4})$ 构建邻接矩阵 $A$ 和度矩阵 $D$。该网络是无向的，这意味着邻接矩阵 $A$ 是对称的，即 $A_{ij} = A_{ji}$。给定的非零权重为 $w_{12} = 0.7$、$w_{13} = 0.1$、$w_{23} = 0.4$、$w_{24} = 0.5$ 和 $w_{34} = 0.2$。所有对角元素 $A_{ii}$ 均为零。\n\n邻接矩阵 $A$ 为：\n$$\nA = \\begin{pmatrix}\n0  0.7  0.1  0 \\\\\n0.7  0  0.4  0.5 \\\\\n0.1  0.4  0  0.2 \\\\\n0  0.5  0.2  0\n\\end{pmatrix}\n$$\n接下来，我们构建度矩阵 $D$，它是一个对角矩阵，其中每个对角元素 $D_{ii}$ 是连接到节点 $i$ 的所有边的权重之和。这等价于 $A$ 的第 $i$ 行的元素之和。问题要求对此定义进行明确验证。\n\n对于节点 $p_1$：$D_{11} = \\sum_{j=1}^{4} A_{1j} = A_{11} + A_{12} + A_{13} + A_{14} = 0 + 0.7 + 0.1 + 0 = 0.8$。\n对于节点 $p_2$：$D_{22} = \\sum_{j=1}^{4} A_{2j} = A_{21} + A_{22} + A_{23} + A_{24} = 0.7 + 0 + 0.4 + 0.5 = 1.6$。\n对于节点 $p_3$：$D_{33} = \\sum_{j=1}^{4} A_{3j} = A_{31} + A_{32} + A_{33} + A_{34} = 0.1 + 0.4 + 0 + 0.2 = 0.7$。\n对于节点 $p_4$：$D_{44} = \\sum_{j=1}^{4} A_{4j} = A_{41} + A_{42} + A_{43} + A_{44} = 0 + 0.5 + 0.2 + 0 = 0.7$。\n\n这就为每个 $i \\in \\{1,2,3,4\\}$ 验证了条件 $\\sum_{j=1}^{4} A_{ij} = D_{ii}$。度向量为 $d = \\begin{pmatrix} 0.8  1.6  0.7  0.7 \\end{pmatrix}^{\\top}$。度矩阵 $D$ 为：\n$$\nD = \\begin{pmatrix}\n0.8  0  0  0 \\\\\n0  1.6  0  0 \\\\\n0  0  0.7  0 \\\\\n0  0  0  0.7\n\\end{pmatrix}\n$$\n组合图拉普拉斯算子定义为 $L = D - A$。\n\n系统在时间 $t$ 的总热量由 $S(t) = \\mathbf{1}^{\\top} x(t)$ 给出，其中 $\\mathbf{1} = \\begin{pmatrix} 1  1  1  1 \\end{pmatrix}^{\\top}$ 是全为1的向量，$x(t)$ 是每个节点上的热量向量。要确定 $S(t)$ 是否守恒，我们必须计算它的时间导数 $\\frac{d}{dt}S(t)$。如果导数为零，则该量是守恒的。\n\n我们首先对 $S(t)$ 关于时间 $t$ 求导：\n$$\n\\frac{d S(t)}{dt} = \\frac{d}{dt} \\left( \\mathbf{1}^{\\top} x(t) \\right)\n$$\n由于 $\\mathbf{1}$ 是一个常数向量，我们可以将微分算子移到内部：\n$$\n\\frac{d S(t)}{dt} = \\mathbf{1}^{\\top} \\frac{d x(t)}{dt}\n$$\n问题提供了控制热扩散的微分方程：$\\frac{d x(t)}{dt} = -L x(t)$。将此代入我们关于 $S(t)$ 导数的表达式中：\n$$\n\\frac{d S(t)}{dt} = \\mathbf{1}^{\\top} \\left( -L x(t) \\right) = - ( \\mathbf{1}^{\\top} L ) x(t)\n$$\n为继续进行，我们必须计算项 $\\mathbf{1}^{\\top} L$。这是一个行向量，其第 $j$ 个分量是拉普拉斯矩阵 $L$ 的第 $j$ 列元素之和。\n让我们分析 $L$ 的任意列 $j$ 的和：\n$$\n\\sum_{i=1}^{4} L_{ij} = \\sum_{i=1}^{4} (D_{ij} - A_{ij}) = \\sum_{i=1}^{4} D_{ij} - \\sum_{i=1}^{4} A_{ij}\n$$\n矩阵 $D$ 是对角矩阵，所以对其第 $j$ 列求和 $\\sum_{i=1}^{4} D_{ij}$ 只有一个非零项，即 $D_{jj}$。根据定义，$D_{jj} = \\sum_{k=1}^{4} A_{jk}$，即节点 $j$ 的度。\n第二项 $\\sum_{i=1}^{4} A_{ij}$ 是邻接矩阵 $A$ 的第 $j$ 列元素之和。由于网络是无向的，$A$ 是一个对称矩阵 ($A = A^{\\top}$)，意味着 $A_{ij} = A_{ji}$。因此，第 $j$ 列的元素之和等于第 $j$ 行的元素之和：\n$$\n\\sum_{i=1}^{4} A_{ij} = \\sum_{i=1}^{4} A_{ji}\n$$\n第 $j$ 行的元素之和 $\\sum_{i=1}^{4} A_{ji}$ 正是节点 $j$ 的度的定义，即 $D_{jj}$。\n将这些结果代回 $L$ 的列和表达式中：\n$$\n\\sum_{i=1}^{4} L_{ij} = D_{jj} - D_{jj} = 0\n$$\n这对每一列 $j \\in \\{1,2,3,4\\}$ 都成立。因此，行向量 $\\mathbf{1}^{\\top}L$ 中的每个条目都为零，这意味着 $\\mathbf{1}^{\\top}L = \\mathbf{0}^{\\top}$，即零行向量。\n\n现在我们可以完成对 $S(t)$ 时间导数的计算：\n$$\n\\frac{d S(t)}{dt} = - ( \\mathbf{1}^{\\top} L ) x(t) = - \\mathbf{0}^{\\top} x(t) = 0\n$$\n由于 $S(t)$ 的时间导数对所有 $t$ 都为零，总热量 $S(t)$ 是一个守恒量。它的值随时间恒定，等于其初始值 $S(0)$。\n\n我们使用给定的初始条件 $x(0)$ 来计算这个恒定值：\n$$\nx(0) = \\begin{pmatrix} 1 \\\\ 2 \\\\ 0.5 \\\\ 1.5 \\end{pmatrix}\n$$\n在 $t=0$ 时的总热量是：\n$$\nS(0) = \\mathbf{1}^{\\top} x(0) = \\begin{pmatrix} 1  1  1  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 2 \\\\ 0.5 \\\\ 1.5 \\end{pmatrix} = 1(1) + 1(2) + 1(0.5) + 1(1.5)\n$$\n$$\nS(0) = 1 + 2 + 0.5 + 1.5 = 5\n$$\n因此，总热量 $S(t)$ 是守恒的，其恒定值为 $5$。", "answer": "$$\\boxed{5}$$", "id": "3332495"}, {"introduction": "在构建了拉普拉斯矩阵之后，下一步是求解热扩散的动力学过程。本练习将引导你使用拉普拉斯矩阵的谱分解（特征分解）方法，为一个简单的网络模型找到热量分布随时间演化的精确解析解 [@problem_id:3332507]。这个过程将揭示网络结构（体现在其拉普拉斯算子的特征值和特征向量中）与其动态行为之间的深刻联系。", "problem": "考虑一个有 $3$ 个节点的无向路径图，节点标记为 $1 \\text{--} 2 \\text{--} 3$，边权重为单位权重。设 $L$ 为其组合图拉普拉斯矩阵，设 $f \\in \\mathbb{R}^{3}$ 表示初始热量分布。网络上的规范扩散动力学由离散热方程 $\\frac{d}{dt} u(t) = - L u(t)$ 给出，其中 $u(0) = f$。请使用精确算术进行计算。\n\n给定以下显式矩阵和向量：\n$$\nL = \\begin{pmatrix}\n1  -1  0 \\\\\n-1  2  -1 \\\\\n0  -1  1\n\\end{pmatrix}, \n\\quad\nf = \\begin{pmatrix}\n1 \\\\\n0 \\\\\n0\n\\end{pmatrix}.\n$$\n\n任务：\n1. 利用对称矩阵的谱性质和对角化，通过求解常微分方程(ODE) $\\frac{d}{dt} u(t) = - L u(t)$（满足 $u(0)=f$）来推导 $u(t)$ 的显式表达式。\n2. 计算在时间 $t = \\ln 2$ 时第二个分量 $u_{2}(t)$ 的值。\n3. 在 $t = \\ln 2$ 时，通过计算 $\\mathbf{1}^{\\top} u(t)$ 并将其与 $\\mathbf{1}^{\\top} f$ (其中 $\\mathbf{1} = (1,1,1)^{\\top}$) 进行比较，来数值上验证质量守恒。请将此验证过程包含在您的解题步骤中，但最终报告的答案应仅为 $u_{2}(\\ln 2)$ 的数值。\n\n最终答案请表示为精确分数，不要四舍五入。", "solution": "首先根据指定标准验证问题。\n\n步骤1：提取给定条件\n- 图：有 $3$ 个节点的无向路径图，节点标记为 $1 \\text{--} 2 \\text{--} 3$，边权重为单位权重。\n- 组合图拉普拉斯矩阵：$L = \\begin{pmatrix} 1  -1  0 \\\\ -1  2  -1 \\\\ 0  -1  1 \\end{pmatrix}$。\n- 初始热量分布：$f = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$。\n- 扩散动力学常微分方程：$\\frac{d}{dt} u(t) = -L u(t)$。\n- 初始条件：$u(0) = f$。\n- 任务1：使用谱对角化求 $u(t)$ 的显式表达式。\n- 任务2：计算在时间 $t = \\ln 2$ 时 $u_{2}(t)$ 的值。\n- 任务3：在 $t = \\ln 2$ 时验证质量守恒 $\\mathbf{1}^{\\top} u(t) = \\mathbf{1}^{\\top} f$，其中 $\\mathbf{1} = (1,1,1)^{\\top}$。\n\n步骤2：使用提取的给定条件进行验证\n- 该问题具有科学依据，描述了图上的规范热扩散，这是网络科学和计算生物学中的一个标准模型。图拉普拉斯矩阵和热方程的使用是该领域的基础。\n- 该问题是适定的。它是一个带有对称矩阵 $L$ 的线性初值问题，这保证了唯一且稳定的解。所有必要的数据（$L$，$f$）都已提供。\n- 问题是客观的，并以精确的数学语言表达。\n- 所提供的矩阵 $L$ 被确认为具有单位权重的3节点路径图的正确组合拉普拉斯矩阵：度矩阵为 $D = \\text{diag}(1, 2, 1)$，邻接矩阵为 $A = \\begin{pmatrix} 0  1  0 \\\\ 1  0  1 \\\\ 0  1  0 \\end{pmatrix}$，因此 $L = D-A = \\begin{pmatrix} 1  -1  0 \\\\ -1  2  -1 \\\\ 0  -1  1 \\end{pmatrix}$。该设置是自洽的。\n\n步骤3：结论与行动\n问题有效。将提供完整解答。\n\n常微分方程组由 $\\frac{d}{dt} u(t) = -L u(t)$ 给出，初始条件为 $u(0) = f$。形式解为 $u(t) = \\exp(-Lt) f$。为了计算矩阵指数，我们使用对称矩阵 $L$ 的谱分解。设 $L = V \\Lambda V^{\\top}$，其中 $\\Lambda$ 是特征值组成的对角矩阵，$V$ 是其列为相应标准正交特征向量的正交矩阵。解可以写为 $u(t) = V \\exp(-\\Lambda t) V^{\\top} f$。\n\n首先，我们求 $L$ 的特征值和特征向量。特征方程为 $\\det(L - \\lambda I) = 0$。\n$$\n\\det \\begin{pmatrix} 1-\\lambda  -1  0 \\\\ -1  2-\\lambda  -1 \\\\ 0  -1  1-\\lambda \\end{pmatrix} = (1-\\lambda)((2-\\lambda)(1-\\lambda) - 1) + 1(-(1-\\lambda)) = (1-\\lambda)(\\lambda^2 - 3\\lambda + 1) - (1-\\lambda) = (1-\\lambda)(\\lambda^2 - 3\\lambda) = \\lambda(1-\\lambda)(\\lambda-3) = 0\n$$\n特征值为 $\\lambda_1 = 0$, $\\lambda_2 = 1$, 和 $\\lambda_3 = 3$。\n\n接下来，我们求相应的标准正交特征向量。\n对于 $\\lambda_1 = 0$：$(L-0I)v_1 = 0 \\implies \\begin{pmatrix} 1  -1  0 \\\\ -1  2  -1 \\\\ 0  -1  1 \\end{pmatrix} v_1 = 0$。这给出 $x_1=x_2=x_3$。归一化的特征向量为 $v_1 = \\frac{1}{\\sqrt{3}} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}$。\n对于 $\\lambda_2 = 1$：$(L-1I)v_2 = 0 \\implies \\begin{pmatrix} 0  -1  0 \\\\ -1  1  -1 \\\\ 0  -1  0 \\end{pmatrix} v_2 = 0$。这给出 $x_2=0$ 和 $x_1=-x_3$。归一化的特征向量为 $v_2 = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\end{pmatrix}$。\n对于 $\\lambda_3 = 3$：$(L-3I)v_3 = 0 \\implies \\begin{pmatrix} -2  -1  0 \\\\ -1  -1  -1 \\\\ 0  -1  -2 \\end{pmatrix} v_3 = 0$。这给出 $y=-2x$ 和 $y=-2z$，意味着 $x=z$。归一化的特征向量为 $v_3 = \\frac{1}{\\sqrt{6}} \\begin{pmatrix} 1 \\\\ -2 \\\\ 1 \\end{pmatrix}$。\n\n解 $u(t)$ 可以表示为特征向量的线性组合，并根据其特征值演化：\n$u(t) = \\sum_{i=1}^{3} c_i \\exp(-\\lambda_i t) v_i$，其中系数 $c_i$ 是初始条件 $f$ 在特征向量上的投影：$c_i = v_i^{\\top}f$。\n\n我们来计算系数 $c_i$：\n$c_1 = v_1^{\\top}f = \\frac{1}{\\sqrt{3}} \\begin{pmatrix} 1  1  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\frac{1}{\\sqrt{3}}$。\n$c_2 = v_2^{\\top}f = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1  0  -1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\frac{1}{\\sqrt{2}}$。\n$c_3 = v_3^{\\top}f = \\frac{1}{\\sqrt{6}} \\begin{pmatrix} 1  -2  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\frac{1}{\\sqrt{6}}$。\n\n解由以下公式给出：\n$u(t) = (v_1^{\\top}f) \\exp(-\\lambda_1 t) v_1 + (v_2^{\\top}f) \\exp(-\\lambda_2 t) v_2 + (v_3^{\\top}f) \\exp(-\\lambda_3 t) v_3$\n$u(t) = \\frac{1}{\\sqrt{3}} \\exp(0) \\left( \\frac{1}{\\sqrt{3}} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} \\right) + \\frac{1}{\\sqrt{2}} \\exp(-t) \\left( \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\end{pmatrix} \\right) + \\frac{1}{\\sqrt{6}} \\exp(-3t) \\left( \\frac{1}{\\sqrt{6}} \\begin{pmatrix} 1 \\\\ -2 \\\\ 1 \\end{pmatrix} \\right)$\n$u(t) = \\frac{1}{3} \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix} + \\frac{1}{2} \\exp(-t) \\begin{pmatrix} 1 \\\\ 0 \\\\ -1 \\end{pmatrix} + \\frac{1}{6} \\exp(-3t) \\begin{pmatrix} 1 \\\\ -2 \\\\ 1 \\end{pmatrix}$\n\n这就给出了任务1中 $u(t)$ 的显式表达式。我们可以将其按分量写出：\n$$\nu(t) = \\begin{pmatrix} u_1(t) \\\\ u_2(t) \\\\ u_3(t) \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{3} + \\frac{1}{2}\\exp(-t) + \\frac{1}{6}\\exp(-3t) \\\\ \\frac{1}{3} - \\frac{2}{6}\\exp(-3t) \\\\ \\frac{1}{3} - \\frac{1}{2}\\exp(-t) + \\frac{1}{6}\\exp(-3t) \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{3} + \\frac{1}{2}\\exp(-t) + \\frac{1}{6}\\exp(-3t) \\\\ \\frac{1}{3} - \\frac{1}{3}\\exp(-3t) \\\\ \\frac{1}{3} - \\frac{1}{2}\\exp(-t) + \\frac{1}{6}\\exp(-3t) \\end{pmatrix}\n$$\n\n对于任务2，我们计算在 $t=\\ln 2$ 时的 $u_2(t)$：\n$u_2(t) = \\frac{1}{3} - \\frac{1}{3}\\exp(-3t)$。\n在 $t = \\ln 2$ 时：\n$u_2(\\ln 2) = \\frac{1}{3} - \\frac{1}{3}\\exp(-3\\ln 2) = \\frac{1}{3} - \\frac{1}{3}\\exp(\\ln(2^{-3})) = \\frac{1}{3} - \\frac{1}{3}(2^{-3}) = \\frac{1}{3} - \\frac{1}{3}\\left(\\frac{1}{8}\\right)$。\n$u_2(\\ln 2) = \\frac{1}{3} - \\frac{1}{24} = \\frac{8}{24} - \\frac{1}{24} = \\frac{7}{24}$。\n\n对于任务3，我们验证质量守恒。初始总质量为 $\\mathbf{1}^{\\top} f = (1,1,1)\\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = 1$。\n$t$ 时刻的总质量为 $\\mathbf{1}^{\\top} u(t)$。由于 $\\mathbf{1}$ 与特征值 $\\lambda_1 = 0$ 对应的特征向量 $v_1$ 成比例，总质量必须守恒。我们在 $t = \\ln 2$ 时数值验证这一点。\n我们需要计算 $\\mathbf{1}^{\\top} u(\\ln 2) = u_1(\\ln 2) + u_2(\\ln 2) + u_3(\\ln 2)$。\n我们有 $u_2(\\ln 2) = \\frac{7}{24} = \\frac{14}{48}$。\n我们来计算其他分量：\n$\\exp(-\\ln 2) = \\frac{1}{2}$ 和 $\\exp(-3\\ln 2) = \\frac{1}{8}$。\n$u_1(\\ln 2) = \\frac{1}{3} + \\frac{1}{2}\\exp(-\\ln 2) + \\frac{1}{6}\\exp(-3\\ln 2) = \\frac{1}{3} + \\frac{1}{2}\\left(\\frac{1}{2}\\right) + \\frac{1}{6}\\left(\\frac{1}{8}\\right) = \\frac{1}{3} + \\frac{1}{4} + \\frac{1}{48} = \\frac{16}{48} + \\frac{12}{48} + \\frac{1}{48} = \\frac{29}{48}$。\n$u_3(\\ln 2) = \\frac{1}{3} - \\frac{1}{2}\\exp(-\\ln 2) + \\frac{1}{6}\\exp(-3\\ln 2) = \\frac{1}{3} - \\frac{1}{2}\\left(\\frac{1}{2}\\right) + \\frac{1}{6}\\left(\\frac{1}{8}\\right) = \\frac{1}{3} - \\frac{1}{4} + \\frac{1}{48} = \\frac{16}{48} - \\frac{12}{48} + \\frac{1}{48} = \\frac{5}{48}$。\n$t = \\ln 2$ 时的总质量是：\n$\\mathbf{1}^{\\top} u(\\ln 2) = \\frac{29}{48} + \\frac{14}{48} + \\frac{5}{48} = \\frac{29+14+5}{48} = \\frac{48}{48} = 1$。\n这与初始质量 $\\mathbf{1}^{\\top} f = 1$ 相匹配，验证了质量守恒。\n\n所要求的最终答案是 $u_2(\\ln 2)$ 的数值。", "answer": "$$\n\\boxed{\\frac{7}{24}}\n$$", "id": "3332507"}, {"introduction": "这项高级练习旨在连接连续时间的热扩散模型与另一种流行的传播算法——带重启的随机游走（Random Walk with Restart, RWR）。你将需要通过匹配两种模型隐含的平滑水平来推导它们之间的理论关系，并编程实现数值比较 [@problem_id:3332580]。这项练习旨在培养对不同网络传播机制及其在生物网络分析中实际应用的更深层次直觉。", "problem": "考虑一个无向生物相互作用网络，它由一个非负对称邻接矩阵 $A \\in \\mathbb{R}^{n \\times n}$ 和一个非负种子向量 $f \\in \\mathbb{R}^{n}$（其中 $\\sum_{i=1}^{n} f_i = 1$）表示。设度矩阵为 $D = \\mathrm{diag}(d_1,\\dots,d_n)$，其中 $d_i = \\sum_{j=1}^{n} A_{ij}$。定义行随机转移矩阵 $P = D^{-1} A$，并遵循约定：如果 $d_i = 0$，则 $P$ 的第 $i$ 行为零行。随机游走归一化拉普拉斯算子为 $L_{\\mathrm{rw}} = I - P$。网络上的连续时间扩散由图热方程 $\\frac{d}{dt} u(t) = - L_{\\mathrm{rw}} u(t)$ 控制，其解为 $u(t) = \\exp(- t L_{\\mathrm{rw}}) f$。带重启的随机游走（RWR）过程由迭代更新式 $u_{k+1} = (1 - \\alpha) f + \\alpha P u_k$ 定义，其中重启参数 $\\alpha \\in [0,1)$，初始值为 $u_0 = f$，并收敛到稳态 $u_{\\mathrm{RWR}}$。\n\n仅从这些定义以及 $P$ 是行随机矩阵和 $L_{\\mathrm{rw}}$ 生成一个稳定半群的性质出发，推导并实现一个算法，该算法为给定的 $\\alpha$ 计算 $u_{\\mathrm{RWR}}$，并在匹配的平滑水平 $t$ 下将其与 $u(t)$ 进行比较。为了匹配带重启的随机游走中隐含的几何路径长度加权与热核中隐含的泊松路径长度加权之间的平滑水平，通过令两种加权方式下的期望传播步数相等来选择 $t$。\n\n使用以下具体实例进行测试：\n- 网络大小为 $n = 5$。\n- 邻接矩阵 $A$ 为\n$$\nA =\n\\begin{bmatrix}\n0  1  0  0  0 \\\\\n1  0  1  0  0 \\\\\n0  1  0  \\tfrac{1}{2}  0 \\\\\n0  0  \\tfrac{1}{2}  0  0 \\\\\n0  0  0  0  0\n\\end{bmatrix}.\n$$\n- 种子向量 $f$ 为\n$$\nf = \\begin{bmatrix} \\tfrac{1}{2} \\\\ 0 \\\\ 0 \\\\ 0 \\\\ \\tfrac{1}{2} \\end{bmatrix}.\n$$\n- 重启参数的测试集包括 $\\alpha \\in \\left\\{ 0, \\tfrac{1}{2}, \\tfrac{9}{10}, \\tfrac{99}{100} \\right\\}$。\n\n你的程序必须对测试集中的每个 $\\alpha$ 计算：\n1. 通过数值求解由更新式 $u_{k+1} = (1 - \\alpha) f + \\alpha P u_k$ 定义的不动点方程，得到的稳态带重启随机游走向量 $u_{\\mathrm{RWR}}$。\n2. 通过如上所述的令期望路径长度相等的方法，在匹配的平滑水平 $t$ 下得到的连续时间扩散向量 $u(t)$。\n3. 欧几里得范数差 $\\|u_{\\mathrm{RWR}} - u(t)\\|_2$，结果为一个实数。\n\n所有量均为无量纲，因此不需要物理单位。你的程序应生成单行输出，其中包含测试集的结果，格式为方括号括起来的逗号分隔的实数列表，例如 $[x_1,x_2,x_3,x_4]$，其中每个 $x_i$ 是按给定顺序为相应 $\\alpha$ 计算出的 $\\|u_{\\mathrm{RWR}} - u(t)\\|_2$ 值，并四舍五入到六位小数。", "solution": "该问题要求推导并实现一个算法，用于比较带重启的随机游走（RWR）的稳态解（$u_{\\mathrm{RWR}}$）与网络上的连续时间热扩散过程的解（$u(t)$），其中时间参数 $t$ 的选择是为了匹配 RWR 过程的平滑水平。\n\n### 步骤1：网络矩阵的形式化与计算\n\n首先，我们基于所提供的邻接矩阵 $A$ 将网络表示形式化。\n\n邻接矩阵 A 如下所示：\n$$\nA =\n\\begin{bmatrix}\n0  1  0  0  0 \\\\\n1  0  1  0  0 \\\\\n0  1  0  \\tfrac{1}{2}  0 \\\\\n0  0  \\tfrac{1}{2}  0  0 \\\\\n0  0  0  0  0\n\\end{bmatrix}\n$$\n种子向量为 $f = [\\tfrac{1}{2}, 0, 0, 0, \\tfrac{1}{2}]^T$。\n\n每个节点 $i$ 的度为 $d_i = \\sum_{j=1}^{n} A_{ij}$。\n$d_1 = 1$\n$d_2 = 1 + 1 = 2$\n$d_3 = 1 + \\tfrac{1}{2} = \\tfrac{3}{2}$\n$d_4 = \\tfrac{1}{2}$\n$d_5 = 0$\n\n度矩阵 $D$ 是由这些度构成的对角矩阵：\n$$ D = \\mathrm{diag}(1, 2, \\tfrac{3}{2}, \\tfrac{1}{2}, 0) $$\n其逆矩阵 $D^{-1}$ 的定义遵循一个约定，即如果 $d_i = 0$，则对应的条目为 $0$，以避免除以零。在计算转移矩阵 $P$ 时应用此约定。\n$$ D^{-1} = \\mathrm{diag}(1, \\tfrac{1}{2}, \\tfrac{2}{3}, 2, 0) $$\n\n行随机转移矩阵 $P = D^{-1} A$ 为：\n$$\nP =\n\\begin{bmatrix}\n1  0  0  0  0 \\\\\n0  \\tfrac{1}{2}  0  0  0 \\\\\n0  0  \\tfrac{2}{3}  0  0 \\\\\n0  0  0  2  0 \\\\\n0  0  0  0  0\n\\end{bmatrix}\n\\begin{bmatrix}\n0  1  0  0  0 \\\\\n1  0  1  0  0 \\\\\n0  1  0  \\tfrac{1}{2}  0 \\\\\n0  0  \\tfrac{1}{2}  0  0 \\\\\n0  0  0  0  0\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n0  1  0  0  0 \\\\\n\\tfrac{1}{2}  0  \\tfrac{1}{2}  0  0 \\\\\n0  \\tfrac{2}{3}  0  \\tfrac{1}{3}  0 \\\\\n0  0  1  0  0 \\\\\n0  0  0  0  0\n\\end{bmatrix}\n$$\n注意，对于度不为零的节点，$P$ 的行和为 $1$，而对于孤立节点（节点5），其对应的行为全零。\n\n随机游走归一化拉普拉斯算子 $L_{\\mathrm{rw}} = I - P$ 为：\n$$\nL_{\\mathrm{rw}} =\n\\begin{bmatrix}\n1  0  0  0  0 \\\\\n0  1  0  0  0 \\\\\n0  0  1  0  0 \\\\\n0  0  0  1  0 \\\\\n0  0  0  0  1\n\\end{bmatrix}\n-\n\\begin{bmatrix}\n0  1  0  0  0 \\\\\n\\tfrac{1}{2}  0  \\tfrac{1}{2}  0  0 \\\\\n0  \\tfrac{2}{3}  0  \\tfrac{1}{3}  0 \\\\\n0  0  1  0  0 \\\\\n0  0  0  0  0\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n1  -1  0  0  0 \\\\\n-\\tfrac{1}{2}  1  -\\tfrac{1}{2}  0  0 \\\\\n0  -\\tfrac{2}{3}  1  -\\tfrac{1}{3}  0 \\\\\n0  0  -1  1  0 \\\\\n0  0  0  0  1\n\\end{bmatrix}\n$$\n\n### 步骤2：推导带重启的随机游走（RWR）解\n\nRWR 过程由迭代更新式 $u_{k+1} = (1 - \\alpha) f + \\alpha P u_k$ 定义。其稳态解 $u_{\\mathrm{RWR}}$ 是该迭代的不动点，满足：\n$$ u_{\\mathrm{RWR}} = (1 - \\alpha) f + \\alpha P u_{\\mathrm{RWR}} $$\n这是一个关于 $u_{\\mathrm{RWR}}$ 的线性方程。整理各项，我们得到：\n$$ u_{\\mathrm{RWR}} - \\alpha P u_{\\mathrm{RWR}} = (1 - \\alpha) f $$\n$$ (I - \\alpha P) u_{\\mathrm{RWR}} = (1 - \\alpha) f $$\n对于 $\\alpha \\in [0, 1)$，矩阵 $(I - \\alpha P)$ 保证是可逆的。因此，我们可以直接解出 $u_{\\mathrm{RWR}}$：\n$$ u_{\\mathrm{RWR}} = (1 - \\alpha) (I - \\alpha P)^{-1} f $$\n此方程提供了一种通过求解线性系统来计算 $u_{\\mathrm{RWR}}$ 的直接方法，这在数值上比迭代直到收敛更可取。\n\n### 步骤3：推导平滑水平的匹配条件\n\n问题的核心是为热扩散找到一个时间 $t$，使其与 RWR 的重启参数 $\\alpha$ 相对应。这通过令两个模型中隐含的期望传播步数相等来实现。\n\n**RWR 中的路径加权：**\n对于 $\\|\\alpha P\\|  1$，项 $(I - \\alpha P)^{-1}$ 可以展开为 Neumann 级数。由于 $\\alpha  1$ 且 $P$ 是行随机的，这个条件成立。\n$$ (I - \\alpha P)^{-1} = \\sum_{k=0}^{\\infty} (\\alpha P)^k = I + \\alpha P + \\alpha^2 P^2 + \\dots $$\n将此代入 $u_{\\mathrm{RWR}}$ 的解中：\n$$ u_{\\mathrm{RWR}} = (1 - \\alpha) \\sum_{k=0}^{\\infty} \\alpha^k P^k f $$\n这个表达式表明，$u_{\\mathrm{RWR}}$ 是对所有可能长度为 $k$ 的随机游走的加权和。项 $P^k f$ 表示随机游走 $k$ 步后的分布。与长度为 $k$ 的路径相关的权重与 $\\alpha^k$ 成正比。归一化权重序列为 $w_k^{\\mathrm{RWR}} = (1 - \\alpha)\\alpha^k$，$k=0, 1, 2, \\dots$。这是一个几何分布。期望路径长度是该分布的均值：\n$$ \\mathbb{E}[k]_{\\mathrm{RWR}} = \\sum_{k=0}^{\\infty} k \\cdot w_k^{\\mathrm{RWR}} = \\sum_{k=0}^{\\infty} k (1 - \\alpha) \\alpha^k = (1 - \\alpha) \\sum_{k=0}^{\\infty} k \\alpha^k $$\n该求和是一个已知的级数结果：对于 $|x|1$，$\\sum_{k=0}^{\\infty} k x^k = \\frac{x}{(1-x)^2}$。\n$$ \\mathbb{E}[k]_{\\mathrm{RWR}} = (1 - \\alpha) \\frac{\\alpha}{(1 - \\alpha)^2} = \\frac{\\alpha}{1 - \\alpha} $$\n\n**热扩散中的路径加权：**\n热扩散方程的解为 $u(t) = \\exp(-t L_{\\mathrm{rw}}) f$。代入 $L_{\\mathrm{rw}} = I - P$：\n$$ u(t) = \\exp(-t(I - P))f = \\exp(-tI)\\exp(tP)f = e^{-t} \\exp(tP) f $$\n我们使用泰勒级数定义展开矩阵指数 $\\exp(tP)$：\n$$ \\exp(tP) = \\sum_{k=0}^{\\infty} \\frac{(tP)^k}{k!} = \\sum_{k=0}^{\\infty} \\frac{t^k}{k!} P^k $$\n将此代入 $u(t)$ 的解中：\n$$ u(t) = e^{-t} \\sum_{k=0}^{\\infty} \\frac{t^k}{k!} P^k f $$\n与 RWR 类似，这表明 $u(t)$ 是对长度为 $k$ 的随机游走的加权和。权重为 $w_k^{\\mathrm{Heat}} = e^{-t} \\frac{t^k}{k!}$，这定义了一个参数为 $\\lambda = t$ 的泊松分布。泊松分布的期望值（均值）就是其参数 $\\lambda$。\n$$ \\mathbb{E}[k]_{\\mathrm{Heat}} = t $$\n\n**匹配条件：**\n通过令两个过程的期望传播步数相等，我们建立了 $\\alpha$ 和 $t$ 之间的对应关系：\n$$ \\mathbb{E}[k]_{\\mathrm{RWR}} = \\mathbb{E}[k]_{\\mathrm{Heat}} $$\n$$ \\frac{\\alpha}{1 - \\alpha} = t $$\n这种关系使我们能够在等效的传播或平滑水平上比较这两个过程。\n\n### 步骤4：算法总结\n\n对于测试集 $\\{0, \\tfrac{1}{2}, \\tfrac{9}{10}, \\tfrac{99}{100}\\}$ 中给定的每个 $\\alpha$ 值：\n1.  **计算 $u_{\\mathrm{RWR}}$**：求解线性系统 $(I - \\alpha P) u_{\\mathrm{RWR}} = (1 - \\alpha) f$。\n2.  **确定匹配时间 $t$**：计算 $t = \\frac{\\alpha}{1 - \\alpha}$。对于 $\\alpha = 0$ 的特殊情况，$t = 0$。\n3.  **计算 $u(t)$**：计算向量 $u(t) = \\exp(-t L_{\\mathrm{rw}}) f$。这涉及到计算 $-t L_{\\mathrm{rw}}$ 的矩阵指数。\n4.  **计算差异**：计算差向量的欧几里得范数 $\\|u_{\\mathrm{RWR}} - u(t)\\|_2$。\n\n将为每个 $\\alpha$ 值实现此过程，以生成最终结果。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import expm\n\ndef solve():\n    \"\"\"\n    Computes the difference between Random Walk with Restart (RWR) and heat diffusion\n    at matched smoothing levels for a given biological network.\n    \"\"\"\n    # Define the problem instance based on the provided statement.\n    n = 5\n    A = np.array([\n        [0.0, 1.0, 0.0, 0.0, 0.0],\n        [1.0, 0.0, 1.0, 0.0, 0.0],\n        [0.0, 1.0, 0.0, 0.5, 0.0],\n        [0.0, 0.0, 0.5, 0.0, 0.0],\n        [0.0, 0.0, 0.0, 0.0, 0.0]\n    ])\n    \n    f = np.array([0.5, 0.0, 0.0, 0.0, 0.5])\n    \n    # The test suite for the restart parameter alpha.\n    test_suite_alpha = [0.0, 0.5, 0.9, 0.99]\n\n    # --- Step 1: Calculate network matrices ---\n    # Calculate degree vector d from the adjacency matrix A.\n    d = A.sum(axis=1)\n    \n    # Calculate the inverse of the degree matrix D, handling nodes with zero degree.\n    # The problem specifies that if d_i=0, the i-th row of P is zero, which is\n    # achieved by having d_inv_ii = 0 for d_i = 0.\n    d_inv_diag = np.zeros_like(d)\n    non_zero_mask = d != 0\n    d_inv_diag[non_zero_mask] = 1.0 / d[non_zero_mask]\n    \n    # Construct the transition matrix P = D^-1 * A.\n    # D_inv is a diagonal matrix, so we can multiply row-wise.\n    P = np.diag(d_inv_diag) @ A\n    \n    # Construct the random-walk normalized Laplacian L_rw = I - P.\n    L_rw = np.identity(n) - P\n\n    results = []\n    \n    for alpha in test_suite_alpha:\n        # --- Step 2: Compute u_RWR ---\n        # The steady-state RWR vector u_RWR is found by solving the linear system:\n        # (I - alpha * P) * u_RWR = (1 - alpha) * f\n        matrix_lhs = np.identity(n) - alpha * P\n        vector_rhs = (1 - alpha) * f\n        u_rwr = np.linalg.solve(matrix_lhs, vector_rhs)\n\n        # --- Step 3: Compute u(t) at matched smoothing level ---\n        # The smoothing level is matched by equating expected path lengths, giving:\n        # t = alpha / (1 - alpha)\n        # Handle the case alpha=1 to avoid division by zero, though problem states alpha  1.\n        if alpha  1.0:\n            t = alpha / (1.0 - alpha)\n        else: # Should not be reached based on problem description.\n            t = np.inf\n\n        # The heat diffusion solution is u(t) = exp(-t * L_rw) * f.\n        # We use scipy.linalg.expm for robust matrix exponential computation.\n        matrix_to_exponentiate = -t * L_rw\n        matrix_exponential = expm(matrix_to_exponentiate)\n        u_t = matrix_exponential @ f\n        \n        # --- Step 4: Compute the Euclidean norm of the difference ---\n        diff_norm = np.linalg.norm(u_rwr - u_t)\n        results.append(diff_norm)\n\n    # Final print statement in the exact required format.\n    # The results are rounded to six decimal places.\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\nsolve()\n```", "id": "3332580"}]}