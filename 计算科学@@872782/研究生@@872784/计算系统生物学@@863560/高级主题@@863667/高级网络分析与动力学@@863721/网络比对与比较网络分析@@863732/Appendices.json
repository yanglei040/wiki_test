{"hands_on_practices": [{"introduction": "网络比对通常被表述为一个计算上具有挑战性的二次分配问题（QAP）。然而，在某些假设情况下，这个问题可以被简化。本练习通过一个一个网络不含任何边的假想场景，展示了复杂的二次项如何消失，从而将问题简化为仅基于节点相似度的线性分配问题（LAP），为理解比对目标函数的核心组成部分打下基础。[@problem_id:3330917]", "problem": "在两个具有相同节点数的蛋白质-蛋白质相互作用（PPI）网络的比较网络对齐中，一种标准方法是将问题转化为一个关于编码节点对应关系的置换矩阵的二次分配优化问题。考虑两个节点集大小为$3$的网络，其邻接矩阵分别为 $A \\in \\mathbb{R}^{3 \\times 3}$ 和 $B \\in \\mathbb{R}^{3 \\times 3}$。给定\n$$\nA \\;=\\; \\begin{pmatrix}\n0  1  0 \\\\\n1  0  1 \\\\\n0  1  0\n\\end{pmatrix},\n\\qquad\nB \\;=\\; \\begin{pmatrix}\n0  0  0 \\\\\n0  0  0 \\\\\n0  0  0\n\\end{pmatrix}.\n$$\n此外，给定一个节点相似度矩阵 $S \\in \\mathbb{R}^{3 \\times 3}$，它量化了第一个网络中的节点$i$与第二个网络中的节点$j$之间的生物相似性：\n$$\nS \\;=\\; \\begin{pmatrix}\n0.9  0.2  0.4 \\\\\n0.3  0.8  0.5 \\\\\n0.6  0.4  0.7\n\\end{pmatrix}.\n$$\n令 $P \\in \\{0,1\\}^{3 \\times 3}$ 表示一个置换矩阵，它代表了两个网络节点之间的一一对应关系。\n\n任务：\n1. 从网络对齐的二次分配公式的定义出发（该公式结合了边一致性项和节点相似性项），形式化地证明当一个网络没有边时（即$B$是零矩阵），该优化问题简化为仅涉及$S$的线性形式的关于$P$的线性分配问题。\n2. 解释如何通过定义一个以$S$表示的适当代价矩阵$C$，将得到的线性分配问题转化为适合用匈牙利算法求解的代价最小化问题，并证明最大化和最小化公式的等价性。\n3. 求解得到的 $3 \\times 3$ 线性分配实例，以计算最优置换矩阵 $P^{\\star}$。将最终答案报告为 $3 \\times 3$ 的置换矩阵 $P^{\\star}$。无需四舍五入，不涉及单位。", "solution": "该问题需要一个三部分的解答：首先，在特定条件下证明二次分配问题（QAP）可以简化为线性分配问题（LAP）；其次，将此LAP表述为代价最小化问题；第三，根据给定数据求解该问题。\n\n### 第1部分：QAP到LAP的简化\n\n网络对齐的一般目标函数，形式化为二次分配问题，旨在寻找一个置换矩阵 $P$，以最大化保留边和节点相似性的组合。该目标函数 $J(P)$ 的一个标准形式为：\n$$\n\\text{maximize} \\quad J(P) = \\text{Tr}(A P B^T P^T) + \\gamma \\text{Tr}(S P^T)\n$$\n约束条件为 $P$ 是一个置换矩阵。此处，$A$ 和 $B$ 是两个网络的邻接矩阵，$S$ 是节点相似度矩阵，$\\gamma$ 是一个平衡两项的正常数，$\\text{Tr}$ 表示矩阵的迹。项 $\\text{Tr}(A P B^T P^T)$ 量化了保留边的得分，而项 $\\gamma \\text{Tr}(S P^T)$ 量化了节点相似性的得分。\n\n问题指出，一个网络没有边，这表示为其邻接矩阵 $B$ 是零矩阵，即 $B = 0_{3 \\times 3}$。\n$$\nB = \\begin{pmatrix}\n0  0  0 \\\\\n0  0  0 \\\\\n0  0  0\n\\end{pmatrix}\n$$\n零矩阵的转置也是零矩阵，$B^T = 0_{3 \\times 3}$。将此代入目标函数的边保留项，得到：\n$$\n\\text{Tr}(A P B^T P^T) = \\text{Tr}(A P 0_{3 \\times 3} P^T)\n$$\n由于任何矩阵与零矩阵的乘积都是零矩阵，该表达式简化为：\n$$\n\\text{Tr}(A P 0_{3 \\times 3}) = \\text{Tr}(0_{3 \\times 3}) = 0\n$$\n因此，边保留项消失。目标函数 $J(P)$ 简化为：\n$$\n\\text{maximize} \\quad J(P) = \\gamma \\text{Tr}(S P^T)\n$$\n由于 $\\gamma$ 是一个正常数，最大化 $\\gamma \\text{Tr}(S P^T)$ 等价于最大化 $\\text{Tr}(S P^T)$。让我们展开这一项：\n$$\n\\text{Tr}(S P^T) = \\sum_{i=1}^3 (S P^T)_{ii} = \\sum_{i=1}^3 \\sum_{j=1}^3 S_{ij} (P^T)_{ji}\n$$\n根据转置的定义，$(P^T)_{ji} = P_{ij}$。因此，目标函数变为：\n$$\n\\text{maximize} \\sum_{i=1}^3 \\sum_{j=1}^3 S_{ij} P_{ij}\n$$\n这个目标函数是置换矩阵 $P$ 的元素 $P_{ij}$ 的线性组合。在约束条件 $P$ 是一个置换矩阵（$P_{ij} \\in \\{0, 1\\}$，$\\sum_{i} P_{ij} = 1$，且 $\\sum_{j} P_{ij} = 1$）下，最大化此线性泛函的问题就是线性分配问题（LAP）的定义。\n\n### 第2部分：表述为代价最小化问题\n\n匈牙利算法是解决LAP的标准方法，但它通常被表述为一个最小化问题：\n$$\n\\text{minimize} \\sum_{i=1}^3 \\sum_{j=1}^3 C_{ij} P_{ij}\n$$\n其中 $C$ 是一个具有非负项（$C_{ij} \\ge 0$）的代价矩阵。我们需要将我们的最大化问题转换为一个等价的最小化问题。\n\n这可以通过将相似度矩阵 $S$ 转换为代价矩阵 $C$ 来实现。设 $M$ 为一个常数。考虑最小化量 $\\sum_{i,j} (M - S_{ij}) P_{ij}$：\n$$\n\\text{minimize} \\sum_{i,j} (M - S_{ij}) P_{ij} = \\text{minimize} \\left( \\sum_{i,j} M P_{ij} - \\sum_{i,j} S_{ij} P_{ij} \\right)\n$$\n由于 $P$ 是一个 $3 \\times 3$ 的置换矩阵，它恰好包含三个等于 $1$ 的元素，其余元素为 $0$。因此，和 $\\sum_{i,j} P_{ij} = 3$。该表达式变为：\n$$\n\\text{minimize} \\left( 3M - \\sum_{i,j} S_{ij} P_{ij} \\right)\n$$\n由于 $3M$ 是一个关于 $P$ 的选择的常数，最小化 $3M - (\\text{某个量})$ 等价于最大化该量。因此，最小化此目标函数等价于我们最初的最大化 $\\sum_{i,j} S_{ij} P_{ij}$ 的问题。\n\n为了使代价矩阵的项 $C_{ij} = M - S_{ij}$ 满足匈牙利算法要求的非负性，我们必须选择 $M$ 使得对于所有的 $i,j$ 都有 $M \\ge S_{ij}$。一个方便的选择是 $M = \\max_{i,j} S_{ij}$。\n给定相似度矩阵 $S$：\n$$\nS = \\begin{pmatrix}\n0.9  0.2  0.4 \\\\\n0.3  0.8  0.5 \\\\\n0.6  0.4  0.7\n\\end{pmatrix}\n$$\n最大元素是 $M = 0.9$。代价矩阵 $C$ 则是：\n$$\nC_{ij} = 0.9 - S_{ij}\n$$\n$$\nC = \\begin{pmatrix}\n0.9 - 0.9  0.9 - 0.2  0.9 - 0.4 \\\\\n0.9 - 0.3  0.9 - 0.8  0.9 - 0.5 \\\\\n0.9 - 0.6  0.9 - 0.4  0.9 - 0.7\n\\end{pmatrix} = \\begin{pmatrix}\n0.0  0.7  0.5 \\\\\n0.6  0.1  0.4 \\\\\n0.3  0.5  0.2\n\\end{pmatrix}\n$$\n这个代价矩阵 $C$ 的所有项都是非负的，可以用于匈牙利算法。\n\n### 第3部分：求解线性分配问题\n\n我们对代价矩阵 $C$ 应用匈牙利算法。\n\n**第1步：行归约**\n从每一行的所有元素中减去该行的最小元素。\n- 第1行：最小值为 $0.0$。该行保持为 $(0.0, 0.7, 0.5)$。\n- 第2行：最小值为 $0.1$。该行变为 $(0.6-0.1, 0.1-0.1, 0.4-0.1) = (0.5, 0.0, 0.3)$。\n- 第3行：最小值为 $0.2$。该行变为 $(0.3-0.2, 0.5-0.2, 0.2-0.2) = (0.1, 0.3, 0.0)$。\n行归约后的矩阵是：\n$$\nC' = \\begin{pmatrix}\n0.0  0.7  0.5 \\\\\n0.5  0.0  0.3 \\\\\n0.1  0.3  0.0\n\\end{pmatrix}\n$$\n**第2步：列归约**\n从 $C'$ 的每一列的所有元素中减去该列的最小元素。\n- 第1列：最小值为 $0.0$。该列不变。\n- 第2列：最小值为 $0.0$。该列不变。\n- 第3列：最小值为 $0.0$。该列不变。\n列归约后的矩阵 $C''$ 与 $C'$ 相同：\n$$\nC'' = \\begin{pmatrix}\n0.0  0.7  0.5 \\\\\n0.5  0.0  0.3 \\\\\n0.1  0.3  0.0\n\\end{pmatrix}\n$$\n**第3步：确定是否存在最优分配**\n我们找出覆盖 $C''$ 中所有零所需的最少水平和垂直线的数量。零位于位置 $(1,1)$、$(2,2)$ 和 $(3,3)$。这些零位于主对角线上。任何单条线（行或列）最多只能覆盖其中一个零。因此，要覆盖所有三个零，至少需要三条线。\n由于最少画线数（$3$）等于矩阵的维度（$n=3$），因此可以利用当前零的位置进行最优分配。\n\n**第4步：寻找最优分配**\n我们必须选择一组三个零元素，使得任意两个都不在同一行或同一列。在矩阵 $C''$ 中，唯一可用的零位于 $(1,1)$、$(2,2)$ 和 $(3,3)$。选择这三个位置提供了一个有效的分配：\n- 第1行分配给第1列。\n- 第2行分配给第2列。\n- 第3行分配给第3列。\n\n**第5步：构造最优置换矩阵 $P^{\\star}$**\n这个分配对应于一个置换矩阵 $P^{\\star}$，其中 $P_{11}=1$，$P_{22}=1$，$P_{33}=1$，所有其他项都为 $0$。\n这是单位矩阵：\n$$\nP^{\\star} = \\begin{pmatrix}\n1  0  0 \\\\\n0  1  0 \\\\\n0  0  1\n\\end{pmatrix}\n$$\n这个分配产生的总相似度得分为 $S_{11} + S_{22} + S_{33} = 0.9 + 0.8 + 0.7 = 2.4$，这是可能的最大和，从而证实了解的最优性。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  0  0 \\\\\n0  1  0 \\\\\n0  0  1\n\\end{pmatrix}\n}\n$$", "id": "3330917"}, {"introduction": "本练习建立在基于分数的比对概念之上，介绍了一种常见的技术，即线性组合不同来源的证据——在本例中是蛋白质序列相似度（$S_{\\mathrm{seq}}$）和网络拓扑相似度（$S_{\\mathrm{topo}}$）。通过计算综合相似度矩阵并解决由此产生的最大权重匹配问题，您将获得许多全局网络比对算法核心机制的实践经验。[@problem_id:3330944]", "problem": "给定两个蛋白质相互作用网络，每个网络有四个节点。网络 $\\mathcal{A}$ 的节点为 $\\{a_{1},a_{2},a_{3},a_{4}\\}$，网络 $\\mathcal{B}$ 的节点为 $\\{b_{1},b_{2},b_{3},b_{4}\\}$。对于每个有序对 $(a_{i},b_{j})$，提供了两种归一化相似性度量：一种是基于序列的相似性 $S_{\\mathrm{seq}}(i,j)$，另一种是基于图元的拓扑相似性 $S_{\\mathrm{topo}}(i,j)$。这些相似性度量以矩阵形式给出，行由 $\\mathcal{A}$ 索引，列由 $\\mathcal{B}$ 索引：\n$$\nS_{\\mathrm{seq}} \\;=\\;\n\\begin{bmatrix}\n0.9  0.2  0.3  0.4 \\\\\n0.1  0.8  0.4  0.3 \\\\\n0.2  0.3  0.85  0.5 \\\\\n0.4  0.3  0.2  0.88\n\\end{bmatrix},\n\\qquad\nS_{\\mathrm{topo}} \\;=\\;\n\\begin{bmatrix}\n0.8  0.2  0.6  0.1 \\\\\n0.1  0.9  0.3  0.4 \\\\\n0.2  0.3  0.95  0.2 \\\\\n0.3  0.3  0.2  0.9\n\\end{bmatrix}.\n$$\n在计算系统生物学中用于全局网络比对的标准线性聚合模型下，对于权重参数 $\\alpha \\in [0,1]$，综合相似性定义为\n$$\nS(i,j) \\;=\\; \\alpha\\, S_{\\mathrm{seq}}(i,j) \\;+\\; \\bigl(1-\\alpha\\bigr)\\, S_{\\mathrm{topo}}(i,j).\n$$\n设 $\\alpha \\,=\\, 0.7$。考虑一对一比对问题：找到一个双射 $\\pi:\\{1,2,3,4\\}\\to\\{1,2,3,4\\}$，以最大化总综合相似性\n$$\n\\sum_{i=1}^{4} S\\bigl(i,\\pi(i)\\bigr),\n$$\n这即是在边权重为 $S(i,j)$ 的情况下，在 $\\mathcal{A}$ 和 $\\mathcal{B}$ 之间寻找最大权重二分匹配。计算综合相似性矩阵 $S$，并确定在所有一对一映射下的最大总综合相似性。仅报告最大总综合相似性，以单个实数值表示。不要报告映射。无需四舍五入。", "solution": "该问题要求我们找到两个网络 $\\mathcal{A}$ 和 $\\mathcal{B}$ 节点之间一对一比对的最大可能总相似性。这等同于求解一个权重矩阵的分配问题，该权重矩阵由给定的序列和拓扑相似性分数导出。\n\n首先，我们必须使用所提供的线性聚合模型和参数 $\\alpha = 0.7$ 来计算综合相似性矩阵 $S$。互补权重为 $1-\\alpha = 1 - 0.7 = 0.3$。每对节点 $(a_i, b_j)$ 的综合相似性 $S(i,j)$ 由下式给出：\n$$S(i,j) \\;=\\; 0.7 \\cdot S_{\\mathrm{seq}}(i,j) \\;+\\; 0.3 \\cdot S_{\\mathrm{topo}}(i,j)$$\n我们计算 $4 \\times 4$ 矩阵 $S$ 的每个元素：\n$S(1,1) = 0.7(0.9) + 0.3(0.8) = 0.63 + 0.24 = 0.87$\n$S(1,2) = 0.7(0.2) + 0.3(0.2) = 0.14 + 0.06 = 0.20$\n$S(1,3) = 0.7(0.3) + 0.3(0.6) = 0.21 + 0.18 = 0.39$\n$S(1,4) = 0.7(0.4) + 0.3(0.1) = 0.28 + 0.03 = 0.31$\n\n$S(2,1) = 0.7(0.1) + 0.3(0.1) = 0.07 + 0.03 = 0.10$\n$S(2,2) = 0.7(0.8) + 0.3(0.9) = 0.56 + 0.27 = 0.83$\n$S(2,3) = 0.7(0.4) + 0.3(0.3) = 0.28 + 0.09 = 0.37$\n$S(2,4) = 0.7(0.3) + 0.3(0.4) = 0.21 + 0.12 = 0.33$\n\n$S(3,1) = 0.7(0.2) + 0.3(0.2) = 0.14 + 0.06 = 0.20$\n$S(3,2) = 0.7(0.3) + 0.3(0.3) = 0.21 + 0.09 = 0.30$\n$S(3,3) = 0.7(0.85) + 0.3(0.95) = 0.595 + 0.285 = 0.88$\n$S(3,4) = 0.7(0.5) + 0.3(0.2) = 0.35 + 0.06 = 0.41$\n\n$S(4,1) = 0.7(0.4) + 0.3(0.3) = 0.28 + 0.09 = 0.37$\n$S(4,2) = 0.7(0.3) + 0.3(0.3) = 0.21 + 0.09 = 0.30$\n$S(4,3) = 0.7(0.2) + 0.3(0.2) = 0.14 + 0.06 = 0.20$\n$S(4,4) = 0.7(0.88) + 0.3(0.9) = 0.616 + 0.270 = 0.886$\n\n得到的综合相似性矩阵 $S$ 为：\n$$\nS \\;=\\;\n\\begin{bmatrix}\n0.87  0.20  0.39  0.31 \\\\\n0.10  0.83  0.37  0.33 \\\\\n0.20  0.30  0.88  0.41 \\\\\n0.37  0.30  0.20  0.886\n\\end{bmatrix}\n$$\n现在的问题是找到一个 $\\{1, 2, 3, 4\\}$ 的双射（排列）$\\pi$，使得总和 $\\sum_{i=1}^{4} S(i, \\pi(i))$ 最大化。这就是分配问题。虽然一般情况需要使用匈牙利算法之类的算法，但我们可以先检查矩阵 $S$ 是否有特殊结构。\n\n观察矩阵 $S$。对于每一行 $i$，对角线元素 $S(i,i)$ 严格地是该行中的最大值。\n- 第 $1$ 行：$S(1,1) = 0.87$ 是最大值。\n- 第 $2$ 行：$S(2,2) = 0.83$ 是最大值。\n- 第 $3$ 行：$S(3,3) = 0.88$ 是最大值。\n- 第 $4$ 行：$S(4,4) = 0.886$ 是最大值。\n\n令恒等映射为 $\\pi_{\\mathrm{id}}(i) = i$。此映射的总相似性是矩阵 $S$ 的迹：\n$$ \\mathrm{Tr}(S) = \\sum_{i=1}^{4} S(i,i) = S(1,1) + S(2,2) + S(3,3) + S(4,4) $$\n设 $\\pi$ 是任何其他排列，因此 $\\pi \\neq \\pi_{\\mathrm{id}}$。这意味着至少存在一个 $i$，使得 $\\pi(i) \\neq i$。$\\pi$ 的总相似性为：\n$$ \\sum_{i=1}^{4} S(i, \\pi(i)) $$\n对于每个 $i$，因为 $S(i,i)$ 是第 $i$ 行的最大值，我们有不等式：\n$$ S(i,i) \\ge S(i, \\pi(i)) $$\n由于对于这个特定的矩阵 $S$，$S(i,i)$ 严格大于其所在行中的任何其他元素，所以当 $\\pi(i) \\neq i$ 时，不等式是严格的：\n$$ S(i,i) > S(i, \\pi(i)) \\quad \\text{当 } \\pi(i) \\neq i $$\n对所有 $i$ 从 $1$ 到 $4$ 求和：\n$$ \\sum_{i=1}^{4} S(i,i) \\ge \\sum_{i=1}^{4} S(i, \\pi(i)) $$\n由于 $\\pi$ 不是恒等排列，必须至少有两个索引 $i$ 使得 $\\pi(i) \\neq i$。对于每个这样的索引，严格不等式 $S(i,i) > S(i, \\pi(i))$ 成立。对于任何索引 $k$，如果 $\\pi(k)=k$，则该项为 $S(k,k) = S(k,\\pi(k))$。因此，恒等映射的总和严格大于任何其他排列的总和：\n$$ \\sum_{i=1}^{4} S(i,i) > \\sum_{i=1}^{4} S(i, \\pi(i)) \\quad \\text{对于所有 } \\pi \\neq \\pi_{\\mathrm{id}} $$\n这证明了最大总相似性由恒等映射 $\\pi(i)=i$ 实现。最大值是 $S$ 的对角线元素之和。\n\n我们现在计算这个和：\n$$ \\text{最大相似性} = 0.87 + 0.83 + 0.88 + 0.886 $$\n$$ \\text{最大相似性} = 1.70 + 1.766 $$\n$$ \\text{最大相似性} = 3.466 $$\n在所有可能的一对一映射中，最大总综合相似性为 $3.466$。", "answer": "$$\n\\boxed{3.466}\n$$", "id": "3330944"}, {"introduction": "比对算法会产生一个节点映射，但我们如何客观地衡量其质量呢？本练习将重点从寻找比对转移到评估比对。您将从基本原理出发，计算几个标准的质量指标，了解每个指标如何提供不同的视角——精确率（EC）、召回率（ICS）、整体相似性（S3）和结构完整性（LCCS）——来评估网络比对的生物学和拓扑学意义。[@problem_id:3330942]", "problem": "考虑两个无向简单图 $G_1 = (V_1,E_1)$ 和 $G_2 = (V_2,E_2)$，它们代表了两个物种的蛋白质-蛋白质相互作用网络。设 $V_1 = \\{v_1,v_2,v_3,v_4,v_5\\}$ 且 $E_1 = \\{(v_1,v_2), (v_2,v_3), (v_3,v_4), (v_4,v_5)\\}$。设 $V_2 = \\{u_1,u_2,u_3,u_4,u_5\\}$ 且\n$$E_2 = \\{(u_1,u_2), (u_2,u_3), (u_3,u_4), (u_1,u_5), (u_1,u_3), (u_2,u_4)\\}.$$\n假设给定一个建议的比对 $f: V_1 \\to V_2$，它是一个单射，定义为 $f(v_i) = u_i$，$i \\in \\{1,2,3,4,5\\}$。\n\n仅使用集合论和图论中关于诱导子图、连通性、集合交并集的核心定义，并且不借助指标本身的预先陈述的公式，推导并计算在映射 $f$ 下的以下比对质量指标：\n- 边正确性 ($\\mathrm{EC}$)，\n- 诱导保守结构 ($\\mathrm{ICS}$)，\n- 对称子结构得分 ($\\mathrm{S3}$)，\n- 最大公共连通子图 ($\\mathrm{LCCS}$) 的大小（以节点数计）。\n\n将 $\\mathrm{EC}$、$\\mathrm{ICS}$ 和 $\\mathrm{S3}$ 表示为精确的有理数，并将 $\\mathrm{LCCS}$ 表示为精确的整数。以单行矩阵的形式提供最终答案，其中包含按 $\\mathrm{EC}$、$\\mathrm{ICS}$、$\\mathrm{S3}$、$\\mathrm{LCCS}$ 顺序排列的四个值。然后，基于您从第一性原理出发的推导，解释这些指标在比对精确度、比对召回率和保守区域内的拓扑连续性方面的权衡。", "solution": "该问题在算法上和数学上都是良定义的，提供了计算所要求指标的所有必要信息。图 $G_1 = (V_1, E_1)$ 和 $G_2 = (V_2, E_2)$ 以及比对函数 $f: V_1 \\to V_2$ 都已明确说明。因此，该问题是有效的，并且可以推导出解。\n\n给定的条件如下：\n图 $G_1$：\n$V_1 = \\{v_1, v_2, v_3, v_4, v_5\\}$，因此 $|V_1| = 5$。\n$E_1 = \\{(v_1, v_2), (v_2, v_3), (v_3, v_4), (v_4, v_5)\\}$，因此 $|E_1| = 4$。$G_1$ 是一个有 $5$ 个顶点的路径图，记为 $P_5$。\n\n图 $G_2$：\n$V_2 = \\{u_1, u_2, u_3, u_4, u_5\\}$，因此 $|V_2| = 5$。\n$E_2 = \\{(u_1, u_2), (u_2, u_3), (u_3, u_4), (u_1, u_5), (u_1, u_3), (u_2, u_4)\\}$，因此 $|E_2| = 6$。\n\n比对 $f$：\n$f$ 是一个从 $V_1$ 到 $V_2$ 的单射，定义为 $f(v_i) = u_i$，$i \\in \\{1, 2, 3, 4, 5\\}$。由于 $|V_1| = |V_2|$，该映射是一个双射。$G_2$ 中比对的节点集合是 $f(V_1) = \\{f(v_1), \\dots, f(v_5)\\} = \\{u_1, \\dots, u_5\\} = V_2$。\n\n我们的第一个任务是确定 $G_1$ 中的哪些边在比对 $f$ 下是保守的。如果 $E_1$ 中的一条边 $(v_i, v_j)$ 对应的边 $(f(v_i), f(v_j))$ 存在于 $E_2$ 中，则该边是保守的。我们可以将从 $G_1$ 映射到 $G_2$ 节点空间中的边集定义为：\n$f(E_1) = \\{ (f(v_i), f(v_j)) \\mid (v_i, v_j) \\in E_1 \\}$。\n使用 $f$ 的定义，我们有：\n$f(E_1) = \\{ (u_1, u_2), (u_2, u_3), (u_3, u_4), (u_4, u_5) \\}$。\n\n保守边的集合，我们称之为 $E_c$，是映射的边集 $f(E_1)$ 与目标图的边集 $E_2$ 的交集。\n$E_c = f(E_1) \\cap E_2$。\n我们检查 $f(E_1)$ 中的每条边是否属于 $E_2$：\n1. $(u_1, u_2)$ 是否在 $E_2$ 中？是。\n2. $(u_2, u_3)$ 是否在 $E_2$ 中？是。\n3. $(u_3, u_4)$ 是否在 $E_2$ 中？是。\n4. $(u_4, u_5)$ 是否在 $E_2$ 中？否。\n\n因此，保守边的集合是 $E_c = \\{ (u_1, u_2), (u_2, u_3), (u_3, u_4) \\}$。\n保守边的数量是 $|E_c| = 3$。\n\n现在我们可以根据四个指标的基本定义来推导和计算它们。\n\n**边正确性 ($\\mathrm{EC}$)**\n$\\mathrm{EC}$ 指标定义为源图 $G_1$ 中在比对下保守的边的比例。这衡量了比对相对于 $G_1$ 结构的精确度。\n从第一性原理出发，这是保守边的数量与 $G_1$ 中总边数的比率。\n$$ \\mathrm{EC} = \\frac{|f(E_1) \\cap E_2|}{|E_1|} $$\n使用我们计算出的值：\n$$ \\mathrm{EC} = \\frac{|E_c|}{|E_1|} = \\frac{3}{4} $$\n\n**诱导保守结构 ($\\mathrm{ICS}$)**\n$\\mathrm{ICS}$ 指标从目标图 $G_2$ 的角度评估比对的质量。它衡量了在 $G_2$ 参与比对的部分中，有多少边可以由来自 $G_1$ 的边来解释。“$G_2$ 参与的部分” 是由比对节点集 $f(V_1)$ 在 $G_2$ 中诱导出的子图。\n设 $G'_2 = G_2[f(V_1)]$ 为此诱导子图。$G'_2$ 的顶点集是 $f(V_1) = V_2$。$G'_2$ 的边集，我们称之为 $E'_2$，由 $E_2$ 中其两个端点都在 $f(V_1)$ 内的所有边组成。由于 $f(V_1) = V_2$，诱导子图就是 $G_2$ 本身，因此 $G'_2 = G_2$ 且 $E'_2 = E_2$。\n$\\mathrm{ICS}$ 定义为保守边的数量与该诱导子图中总边数的比率。\n$$ \\mathrm{ICS} = \\frac{|f(E_1) \\cap E_2|}{|E'_2|} = \\frac{|f(E_1) \\cap E_2|}{|E(G_2[f(V_1)])|} $$\n在我们的例子中，这可以简化为：\n$$ \\mathrm{ICS} = \\frac{|E_c|}{|E_2|} = \\frac{3}{6} = \\frac{1}{2} $$\n\n**对称子结构得分 ($\\mathrm{S3}$)**\n$\\mathrm{S3}$ 得分是一个对称指标，它平衡了 $\\mathrm{EC}$ 和 $\\mathrm{ICS}$ 的观点。它被定义为从 $G_1$ 映射的边集与 $G_2$ 中诱导子图的边集之间的 Jaccard 指数。它是这些集合交集的大小除以它们并集的大小。\n$$ \\mathrm{S3} = \\frac{|f(E_1) \\cap E(G_2[f(V_1)])|}{|f(E_1) \\cup E(G_2[f(V_1)])|} $$\n如前所述，$E(G_2[f(V_1)]) = E_2$。公式变为：\n$$ \\mathrm{S3} = \\frac{|f(E_1) \\cap E_2|}{|f(E_1) \\cup E_2|} $$\n使用容斥原理计算并集的大小：\n$|f(E_1) \\cup E_2| = |f(E_1)| + |E_2| - |f(E_1) \\cap E_2|$。\n我们有 $|f(E_1)| = |E_1| = 4$，$|E_2| = 6$，以及 $|f(E_1) \\cap E_2| = |E_c| = 3$。\n因此，$|f(E_1) \\cup E_2| = 4 + 6 - 3 = 7$。\n将这些值代入 $\\mathrm{S3}$ 公式：\n$$ \\mathrm{S3} = \\frac{3}{7} $$\n\n**最大公共连通子图 ($\\mathrm{LCCS}$)**\n$\\mathrm{LCCS}$ 是通过首先构建公共子图 $G_c$ 来找到的，该子图由所有比对节点和仅保守的边定义。$\\mathrm{LCCS}$ 的大小是 $G_c$ 的最大连通分量中的节点数。\n公共子图可以看作是 $G_1$ 的一个子图，其中顶点集是 $V_1$，边集仅包含 $E_1$ 中那些保守的边。\n$E_1$ 中的边是 $(v_1, v_2), (v_2, v_3), (v_3, v_4), (v_4, v_5)$。对应的映射边是 $(u_1, u_2), (u_2, u_3), (u_3, u_4), (u_4, u_5)$。保守的边是 $(u_1, u_2), (u_2, u_3), (u_3, u_4)$。\n这意味着从 $E_1$ 中保守的原始边是 $E_{c,1} = \\{(v_1, v_2), (v_2, v_3), (v_3, v_4)\\}$。公共子图是 $G_c = (V_1, E_{c,1})$。\n我们现在找到 $G_c$ 的连通分量：\n边 $\\{(v_1, v_2), (v_2, v_3), (v_3, v_4)\\}$ 构成一条连接顶点 $\\{v_1, v_2, v_3, v_4\\}$ 的路径。这形成了一个大小为 $4$ 的连通分量。\n顶点 $v_5$ 在 $E_{c,1}$ 中没有关联的边（因为边 $(v_4, v_5)$ 未被保守），所以它是一个孤立顶点。这形成了第二个大小为 $1$ 的连通分量。\n连通分量的大小分别为 $4$ 和 $1$。其中最大的是 $4$。\n因此，$\\mathrm{LCCS}$ 的大小为 $4$。\n\n**指标解释**\n基于这些推导，我们可以解释其中的权衡：\n- $\\mathrm{EC} = \\frac{3}{4} = 0.75$。这是一个衡量**比对精确度**的指标。它回答了：“由比对预测的邻接关系（即 $G_1$ 的边）中，正确的比例是多少？” 在本例中，$G_1$ 中 $75\\%$ 的边被成功映射到 $G_2$ 中的边。该得分对 $G_2$ 中那些不在 $E_1$ 映射范围内的边不敏感。\n- $\\mathrm{ICS} = \\frac{1}{2} = 0.5$。这与**比对召回率**或拓扑纯度有关。它回答了：“在目标图 $G_2$ 的比对区域中存在的所有邻接关系中，有多大比例被比对所恢复？” 在这里，比对仅解释了 $G_2$ 中存在的 $6$ 条边中的 $3$ 条。这个低分表明目标子图与源图显著不同（更密集或重新布线），包含了像 $(u_1, u_3), (u_2, u_4), (u_1, u_5)$ 这样的边，它们在该比对下在 $G_1$ 中没有对应物。\n- $\\mathrm{S3} = \\frac{3}{7} \\approx 0.429$。这是一个**平衡得分**，它同时考虑了假阳性（在 $f(E_1)$ 中但不在 $E_2$ 中的边）和假阴性（在 $E_2$ 中但不在 $f(E_1)$ 中的边）。作为 Jaccard 相似度，它提供了一个单一、对称的衡量整体拓扑重叠度的指标。其值介于 $\\mathrm{EC}$ 和 $\\mathrm{ICS}$ 之间，反映了从两个角度来看，该比对都是不完美的。\n- $\\mathrm{LCCS} = 4$。该指标衡量保守结构的**拓扑连续性**。尽管基于边的指标提供了保守的全局百分比，但 $\\mathrm{LCCS}$ 确定了最大的单个保守功能模块或通路的大小。在这里，一个包含 $4$ 个节点的连续路径被保留下来。这与例如两条不相连的边被保守的情况不同，后者可能会产生较低的 $\\mathrm{EC}$ ($\\frac{2}{4}$)，但会导致一个更小的 $\\mathrm{LCCS}$，大小为 $2$。因此，$\\mathrm{LCCS}$ 捕捉了连通子结构的生物学上显著的保守性，而这仅通过边计数是无法完全描述的。比对未能保守边 $(v_4,v_5)$，破坏了原始的 $P_5$ 结构，使 $v_5$ 孤立，并将最大连通块从 $5$ 个节点减少到 $4$ 个。\n\n总而言之，$\\mathrm{EC}$ 优先考虑精确度，$\\mathrm{ICS}$ 优先考虑召回率/纯度，$\\mathrm{S3}$ 平衡两者，而 $\\mathrm{LCCS}$ 优先考虑最大未断裂保守块的大小。\n\n最终答案计算：\n$\\mathrm{EC} = \\frac{3}{4}$\n$\\mathrm{ICS} = \\frac{1}{2}$\n$\\mathrm{S3} = \\frac{3}{7}$\n$\\mathrm{LCCS} = 4$\n最终答案矩阵为 $\\begin{pmatrix} \\frac{3}{4}  \\frac{1}{2}  \\frac{3}{7}  4 \\end{pmatrix}$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{3}{4}  \\frac{1}{2}  \\frac{3}{7}  4\n\\end{pmatrix}\n}\n$$", "id": "3330942"}]}