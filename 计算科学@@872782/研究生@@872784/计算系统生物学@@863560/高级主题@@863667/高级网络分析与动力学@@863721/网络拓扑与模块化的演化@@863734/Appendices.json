{"hands_on_practices": [{"introduction": "生物网络是如何随着时间演化的？复制-分化（duplication-divergence）机制为我们提供了一个核心的、受生物学启发的模型，尤其适用于解释基因调控和蛋白质相互作用网络的增长。通过对这一随机过程进行数学分析，我们可以推导出网络的一些宏观统计特性，例如度分布。这项练习将引导你使用平均场理论和常微分方程，从底层的演化规则推导出网络最终形成的全局架构，这对于理解复杂系统是如何从简单的局部规则中涌现至关重要。[@problem_id:3306719]", "problem": "考虑一个通过以下复制-分化机制演化的无向简单网络，该机制的提出受基因调控和蛋白质相互作用网络演化的启发。设离散时间 $t= t_{0}$ 时的初始网络有 $N(t_{0}) = N_{0} \\ge 2$ 个节点和 $E(t_{0}) = E_{0}$ 条边。对于 $t = t_{0}, t_{0}+1, \\dots$，执行一个增长步骤，包括：\n1. 从当前大小为 $N(t)$ 的节点集中均匀随机地选择一个目标节点 $v_{t}$。\n2. 添加一个新节点 $u_{t+1}$。对于 $v_{t}$ 的每个邻居 $w$，以概率 $p \\in (0,1)$ 独立地添加边 $\\{u_{t+1}, w\\}$（分化下的边保留）。\n3. 与步骤2独立，以概率 $q \\in [0,1]$ 添加边 $\\{u_{t+1}, v_{t}\\}$（创新）。\n\n不添加其他边，也不删除任何边，除非在步骤2中因未保留而隐式删除。设 $k_{i}(t)$ 表示一个已存在节点 $i$ 在时间 $t$ 的度，并设 $\\langle k \\rangle(t) = 2 E(t)/N(t)$ 表示在时间 $t$ 的平均度。\n\n在 $N(t) \\approx t$（对于大的 $t$）的连续平均场极限下，回答以下问题：\n(a) 从期望的线性性和均匀目标选择出发，推导一个关于固定已有节点 $i$ 的度的期望演化的平均场常微分方程（ODE），\n$$\n\\frac{ \\mathrm{d} \\,\\mathbb{E}[k_{i}(t)] }{ \\mathrm{d} t } \\, ,\n$$\n该方程用 $p$、$q$、$t$ 和 $\\mathbb{E}[k_{i}(t)]$ 表示。\n(b) 求解(a)部分的ODE，以获得对于 $t \\gg t_{i}$ 的 $\\mathbb{E}[k_{i}(t)]$，其中 $t_{i}$ 是节点 $i$ 的出生时间，用其在 $t_{i}$ 的初始条件表示。\n(c) 使用(b)部分的解以及出生时间渐近均匀这一事实，推导稳态度分布 $P(k) \\sim k^{-\\gamma}$ 的渐近尾指数 $\\gamma$（如果存在），作为 $p$ 和 $q$ 的函数。\n(d) 推导 $E(t)$ 的平均场ODE，并获得平均度 $\\langle k \\rangle(t)$ 在大 $t$ 下的渐近行为。由此，确定网络保持稀疏（定义为 $\\sup_{t} \\langle k \\rangle(t)  \\infty$）的 $p$ 的范围，并讨论 $q$ 如何进入此条件。\n(e) 对于新节点 $u_{t+1}$ 出生时的聚类结构，设 $C(v_{t})$ 表示复制前 $v_{t}$ 的局部聚类系数。推导一个关于 $u_{t+1}$ 出生时与其关联的期望三角形数量的表达式，用 $p$、$q$、$k_{v_{t}}$ 和 $C(v_{t})$ 表示，并使用平均场近似来论证对于大的 $k_{v_{t}}$，$u_{t+1}$ 的期望局部聚类系数与 $C(v_{t})$ 相比如何。\n\n明确给出所有推导过程。将最终答案表示为关于 $p$ 和 $q$ 的渐近度分布指数 $\\gamma$ 的单一闭式解析表达式。不需要数值近似或四舍五入。", "solution": "该问题要求对一个通过复制-分化机制演化的网络进行分析。我将首先验证问题陈述，然后按要求依次解决五个部分。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n- **网络模型：** 无向简单网络。\n- **初始条件：** 在时间 $t= t_{0}$，网络有 $N(t_{0}) = N_{0} \\ge 2$ 个节点和 $E(t_{0}) = E_{0}$ 条边。\n- **增长过程（对于 $t = t_{0}, t_{0}+1, \\dots$）：**\n    1. 从当前 $N(t)$ 个节点中均匀随机选择一个目标节点 $v_{t}$。\n    2. 添加一个新节点 $u_{t+1}$。对于 $v_{t}$ 的每个邻居 $w$，以概率 $p \\in (0,1)$ 添加一条边 $\\{u_{t+1}, w\\}$。\n    3. 以概率 $q \\in [0,1]$ 添加一条边 $\\{u_{t+1}, v_{t}\\}$。\n- **记号：** $k_{i}(t)$ 是节点 $i$ 在时间 $t$ 的度。$\\langle k \\rangle(t) = 2 E(t)/N(t)$ 是平均度。\n- **近似：** 连续平均场极限，其中对于大的 $t$，$N(t) \\approx t$。\n- **任务：**\n    (a) 推导 $\\frac{ \\mathrm{d} \\,\\mathbb{E}[k_{i}(t)] }{ \\mathrm{d} t }$ 的ODE。\n    (b) 求解该ODE以得到 $\\mathbb{E}[k_{i}(t)]$。\n    (c) 推导渐近度分布尾指数 $\\gamma$。\n    (d) 推导 $E(t)$ 的ODE，找到 $\\langle k \\rangle(t)$ 的渐近行为，并确定稀疏性条件。\n    (e) 分析新节点 $u_{t+1}$ 的聚类。\n- **最终答案要求：** $\\gamma$ 的单一闭式解析表达式。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有坚实的科学基础，采用的是计算生物学和网络科学中常见的标准复制-分化模型。其数学框架，使用平均场连续近似和常微分方程，是分析此类模型的标准且合适的技术。问题提法恰当；所有参数和过程都有清晰的定义，问题具体且可形式化。假设被明确陈述。问题是客观的，不含任何非科学内容。它没有违反任何无效标准。\n\n**步骤3：结论与行动**\n问题是有效的。我现在将进行完整的推导。\n\n### 推导\n\n**(a) 已有节点的期望度的常微分方程推导**\n\n设 $i$ 是网络中一个在时间 $t$ 已存在的固定节点。我们考虑其度 $k_i$ 在从 $t$ 到 $t+1$ 的单个时间步内的变化。节点 $i$ 的度增加1，当且仅当新添加的节点 $u_{t+1}$ 与节点 $i$ 形成一条边。由于网络是简单的，且节点不能是自身的邻居，这可以通过两种互斥的方式发生。\n\n1.  目标节点 $v_t$ 是节点 $i$ 本身。由于目标是均匀随机选择的，此事件发生的概率为 $1/N(t)$。如果 $v_t=i$，则边 $\\{u_{t+1}, i\\}$ 以概率 $q$ 被添加。这个组合事件的概率是 $\\frac{1}{N(t)} \\cdot q$。\n2.  目标节点 $v_t$ 是节点 $i$ 的一个邻居。设 $\\mathcal{N}_i(t)$ 是节点 $i$ 在时间 $t$ 的邻居集合，因此 $|\\mathcal{N}_i(t)| = k_i(t)$。设 $w \\in \\mathcal{N}_i(t)$ 是一个邻居。选择 $w$ 作为目标的概率是 $1/N(t)$。如果 $v_t = w$，那么 $i$ 是目标节点的一个邻居。根据增长过程的步骤2，边 $\\{u_{t+1}, i\\}$ 以概率 $p$ 被添加。由于有 $k_i(t)$ 个这样的邻居，且选择每个邻居是互不相交的事件，这种情况的总概率是 $\\sum_{w \\in \\mathcal{N}_i(t)} \\frac{1}{N(t)} \\cdot p = \\frac{k_i(t) p}{N(t)}$。\n\n节点 $i$ 的度在此时间步内增加1的总概率是这两种情况的概率之和：\n$$\nP(\\Delta k_i(t) = 1) = \\frac{q}{N(t)} + \\frac{p k_i(t)}{N(t)}\n$$\n在时间 $t$，节点 $i$ 的度的期望变化，以其当前度 $k_i(t)$ 为条件，是：\n$$\n\\mathbb{E}[\\Delta k_i(t) | k_i(t)] = 1 \\cdot P(\\Delta k_i(t)=1) + 0 \\cdot P(\\Delta k_i(t)=0) = \\frac{q + p k_i(t)}{N(t)}\n$$\n为了找到无条件的期望变化，我们对 $k_i(t)$ 的分布取期望：\n$$\n\\mathbb{E}[\\Delta k_i(t)] = \\mathbb{E}[\\mathbb{E}[\\Delta k_i(t) | k_i(t)]] = \\mathbb{E}\\left[\\frac{q + p k_i(t)}{N(t)}\\right] = \\frac{q + p \\mathbb{E}[k_i(t)]}{N(t)}\n$$\n在连续平均场极限下，我们将离散时间步 $\\Delta t = 1$ 近似为微分 $\\mathrm{d}t$，$N(t) \\approx t$，并且 $\\mathbb{E}[\\Delta k_i(t)] \\approx \\frac{\\mathrm{d}\\mathbb{E}[k_i(t)]}{\\mathrm{d}t}$。这给出了常微分方程：\n$$\n\\frac{ \\mathrm{d} \\,\\mathbb{E}[k_{i}(t)] }{ \\mathrm{d} t } = \\frac{q + p\\, \\mathbb{E}[k_{i}(t)]}{t}\n$$\n\n**(b) 常微分方程的求解**\n\n(a)部分的ODE是一阶线性微分方程。令 $y(t) = \\mathbb{E}[k_i(t)]$. 该方程为：\n$$\n\\frac{\\mathrm{d}y}{\\mathrm{d}t} = \\frac{p}{t}y + \\frac{q}{t} \\quad \\implies \\quad \\frac{\\mathrm{d}y}{\\mathrm{d}t} - \\frac{p}{t}y = \\frac{q}{t}\n$$\n我们使用积分因子 $I(t)$ 来求解：\n$$\nI(t) = \\exp\\left( \\int -\\frac{p}{t} \\mathrm{d}t \\right) = \\exp(-p \\ln t) = t^{-p}\n$$\n将ODE两边乘以 $I(t)$:\n$$\nt^{-p} \\frac{\\mathrm{d}y}{\\mathrm{d}t} - p t^{-p-1} y = q t^{-p-1}\n$$\n左边是乘积 $y(t)I(t)$ 的导数：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} (t^{-p} y) = q t^{-p-1}\n$$\n两边对 $t$ 积分：\n$$\nt^{-p} y(t) = \\int q t^{-p-1} \\mathrm{d}t = q \\frac{t^{-p}}{-p} + C = -\\frac{q}{p} t^{-p} + C\n$$\n其中 $C$ 是积分常数。解出 $y(t)$:\n$$\ny(t) = -\\frac{q}{p} + C t^{p}\n$$\n常数 $C$ 由初始条件确定。设 $t_i$ 是节点 $i$ 创建的时间。设其初始期望度为 $\\mathbb{E}[k_i(t_i)] = k_{i,0}$。在 $t=t_i$ 时：\n$$\nk_{i,0} = -\\frac{q}{p} + C t_i^{p} \\implies C = \\left(k_{i,0} + \\frac{q}{p}\\right) t_i^{-p}\n$$\n将 $C$ 代回 $y(t) = \\mathbb{E}[k_i(t)]$ 的解中，我们得到：\n$$\n\\mathbb{E}[k_{i}(t)] = -\\frac{q}{p} + \\left(k_{i,0} + \\frac{q}{p}\\right) t_i^{-p} t^{p} = -\\frac{q}{p} + \\left(k_{i,0} + \\frac{q}{p}\\right) \\left(\\frac{t}{t_i}\\right)^{p}\n$$\n这是对于在时间 $t_i$ 出生、初始期望度为 $k_{i,0}$ 的节点 $i$，在 $t \\ge t_i$ 时的期望度的解。\n\n**(c) 度分布指数$\\gamma$的推导**\n\n为了找到稳态度分布 $P(k) \\sim k^{-\\gamma}$ 的指数，我们使用(b)部分的结果，并将节点的度与其年龄联系起来。平均场近似假设节点 $i$ 在时间 $t$ 的度 $k_i(t)$ 遵循其期望的演化：\n$$\nk(t_i, t) \\approx -\\frac{q}{p} + \\left(k_{i,0} + \\frac{q}{p}\\right) \\left(\\frac{t}{t_i}\\right)^{p}\n$$\n我们对分布的尾部感兴趣，即大的度 $k$。大的度是由早期出生（小的 $t_i$）并有很长时间来获得边的节点所达到的。\n问题陈述出生时间 $t_i$ 是渐近均匀的。在一个每时间步增长一个节点直到时间 $t$ 的网络中，随机选择的节点的出生时间 $t_{birth}$ 的概率密度近似为 $f(t_{birth}) \\approx 1/t$，对于 $t_0 \\ll t_{birth} \\le t$。累积分布函数是 $F(t_{birth} \\le \\tau) = P(\\text{节点在时间}\\tau\\text{前出生}) \\approx \\tau/t$。\n\n度大于 $k$ 的节点比例，记为 $P(K > k)$，对应于那些出生得足够早以使其度增长到超过 $k$ 的节点比例。我们可以通过对度演化方程求逆，来找到一个在时间 $t$ 度恰好为 $k$ 的节点的出生时间 $t_i(k)$：\n$$\nk = -\\frac{q}{p} + \\left(k_{i,0} + \\frac{q}{p}\\right) \\left(\\frac{t}{t_i(k)}\\right)^{p} \\implies \\left(\\frac{t}{t_i(k)}\\right)^{p} = \\frac{k + q/p}{k_{i,0} + q/p}\n$$\n解出 $t_i(k)$:\n$$\nt_i(k) = t \\left(\\frac{k + q/p}{k_{i,0} + q/p}\\right)^{-1/p}\n$$\n一个随机节点的度大于 $k$ 的概率是其出生时间小于 $t_i(k)$ 的概率：\n$$\nP(K > k) = P(t_{birth}  t_i(k)) \\approx \\frac{t_i(k)}{t} = \\left(\\frac{k + q/p}{k_{i,0} + q/p}\\right)^{-1/p}\n$$\n对于大的 $k$，我们可以近似 $k+q/p \\approx k$。项 $(k_{i,0} + q/p)$ 是一个常数。因此，互补累积分布函数的渐近行为是：\n$$\nP(K > k) \\propto k^{-1/p}\n$$\n概率密度函数 $P(k)$ 通过对 $P(K \\le k) = 1 - P(K > k)$ 关于 $k$ 求导得到，或者简单地 $P(k) = - \\frac{\\mathrm{d}}{\\mathrm{d}k} P(K > k)$。\n$$\nP(k) \\propto -\\frac{\\mathrm{d}}{\\mathrm{d}k} (k^{-1/p}) = -(-1/p) k^{-1/p - 1} \\propto k^{-(1+1/p)}\n$$\n将其与形式 $P(k) \\sim k^{-\\gamma}$ 比较，我们确定尾指数为：\n$$\n\\gamma = 1 + \\frac{1}{p}\n$$\n注意，创新概率 $q$ 影响前置因子和交叉行为，但不影响渐近幂律指数。\n\n**(d) 平均度$\\langle k \\rangle(t)$的渐近行为与稀疏性**\n\n我们首先推导总边数 $E(t)$ 的ODE。在每个时间步，添加一个新节点 $u_{t+1}$。边数的变化 $\\Delta E(t) = E(t+1) - E(t)$ 是这个新节点的度。这个度是一个随机变量。其期望值，以父节点 $v_t$ 的选择为条件，是：\n$$\n\\mathbb{E}[\\Delta E(t) | v_t] = \\mathbb{E}[\\text{来自分化的边}] + \\mathbb{E}[\\text{来自创新的边}] = p k_{v_t}(t) + q\n$$\n为了找到无条件期望，我们对从 $N(t)$ 个节点中均匀随机选择 $v_t$ 进行平均。$k_{v_t}(t)$ 的期望是网络的平均度，$\\langle k \\rangle(t) = 2E(t)/N(t)$。\n$$\n\\mathbb{E}[\\Delta E(t)] = p \\, \\mathbb{E}[k_{v_t}(t)] + q = p \\frac{2E(t)}{N(t)} + q\n$$\n在连续极限下，有 $N(t) \\approx t$ 和 $\\mathbb{E}[\\Delta E(t)] \\approx \\frac{\\mathrm{d}E}{\\mathrm{d}t}$：\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = \\frac{2p}{t} E(t) + q\n$$\n这是一个形式为 $\\frac{\\mathrm{d}E}{\\mathrm{d}t} - \\frac{2p}{t}E = q$ 的线性ODE。积分因子是 $I(t) = \\exp(\\int -2p/t \\, \\mathrm{d}t) = t^{-2p}$。\n与(b)部分类似地求解，对于 $p \\neq 1/2$，我们得到：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}t} (t^{-2p} E) = q t^{-2p} \\implies t^{-2p} E(t) = \\int q t^{-2p} \\mathrm{d}t = \\frac{q}{1-2p} t^{1-2p} + C\n$$\n$$\nE(t) = \\frac{q}{1-2p} t + C t^{2p}\n$$\n平均度是 $\\langle k \\rangle(t) = 2E(t)/N(t) \\approx 2E(t)/t$:\n$$\n\\langle k \\rangle(t) \\approx \\frac{2}{t} \\left(\\frac{q}{1-2p} t + C t^{2p}\\right) = \\frac{2q}{1-2p} + 2C t^{2p-1}\n$$\n如果网络的平均度在 $t \\to \\infty$ 时保持有界，即 $\\sup_t \\langle k \\rangle(t)  \\infty$，则网络保持稀疏。分析其渐近行为：\n- 如果 $2p-1 > 0$，即 $p > 1/2$，则 $\\langle k \\rangle(t) \\to \\infty$。网络变得稠密。\n- 如果 $2p-1  0$，即 $p  1/2$，则 $t^{2p-1} \\to 0$ 且 $\\langle k \\rangle(t) \\to \\frac{2q}{1-2p}$，一个有限常数。网络是稀疏的。\n- 如果 $2p-1=0$，即 $p = 1/2$，那么 $E(t)$ 的ODE是 $\\frac{\\mathrm{d}E}{\\mathrm{d}t} - \\frac{1}{t}E = q$。这给出 $E(t) = q t \\ln t + C t$，且 $\\langle k \\rangle(t) \\approx 2q \\ln t + 2C$，这是发散的。\n因此，对于 $p \\in (0, 1/2)$，网络保持稀疏。稀疏性条件不依赖于 $q$。然而，$q$ 决定了在稀疏区域中渐近平均度 $\\langle k \\rangle_\\infty = \\frac{2q}{1-2p}$ 的值。\n\n**(e) 新节点的聚类分析**\n\n设 $v_t$ 是父节点，其度为 $k_{v_t}$，局部聚类系数为 $C(v_t) = \\frac{2 T(v_t)}{k_{v_t}(k_{v_t}-1)}$，其中 $T(v_t)$ 是与 $v_t$ 关联的三角形数量。我们想要找到新节点 $u_{t+1}$ 在其出生时关联的期望三角形数量 $\\mathbb{E}[T(u_{t+1})]$，以父节点选择 $v_t$ 为条件。\n涉及 $u_{t+1}$ 的三角形必须具有 $\\{u_{t+1}, x, y\\}$ 的形式，其中 $x, y$ 是 $u_{t+1}$ 的邻居且它们之间有边相连。$u_{t+1}$ 的邻居是 $\\{v_t\\} \\cup \\mathcal{N}(v_t)$ 的一个随机子集。\n三角形可以通过两种方式形成：\n1.  在父节点及其一个邻居之间的边上：考虑一条边 $\\{v_t, w\\}$，其中 $w \\in \\mathcal{N}(v_t)$。如果 $u_{t+1}$ 同时连接到 $v_t$（概率为 $q$）和 $w$（概率为 $p$），则形成一个三角形 $\\{u_{t+1}, v_t, w\\}$。这些事件是独立的。概率是 $p q$。有 $k_{v_t}$ 条这样的边。此类三角形的期望数量是 $p q k_{v_t}$。\n2.  在父节点的两个邻居之间的边上：考虑一条边 $\\{w_1, w_2\\}$，其中 $w_1, w_2 \\in \\mathcal{N}(v_t)$。这是一条与 $v_t$ 构成三角形的边。这样的边的数量是 $T(v_t)$。如果 $u_{t+1}$ 同时连接到 $w_1$（概率为 $p$）和 $w_2$（概率也为 $p$），则形成一个三角形 $\\{u_{t+1}, w_1, w_2\\}$。由于这些事件是独立的，概率是 $p^2$。此类三角形的期望数量是 $p^2 T(v_t)$。\n\n将这些贡献相加，得到与 $u_{t+1}$ 关联的期望三角形数量：\n$$\n\\mathbb{E}[T(u_{t+1})|v_t] = p q k_{v_t} + p^2 T(v_t)\n$$\n使用 $C(v_t)$ 的定义，我们有 $T(v_t) = \\frac{C(v_t) k_{v_t}(k_{v_t}-1)}{2}$。代入此式：\n$$\n\\mathbb{E}[T(u_{t+1})|v_t] = p q k_{v_t} + p^2 \\frac{C(v_t) k_{v_t}(k_{v_t}-1)}{2}\n$$\n为了比较新节点的期望聚类系数 $\\mathbb{E}[C(u_{t+1})|v_t]$ 与 $C(v_t)$，我们使用平均场近似：$\\mathbb{E}[C(u_{t+1})] \\approx \\frac{2\\mathbb{E}[T(u_{t+1})]}{\\mathbb{E}[k_{u_{t+1}}](\\mathbb{E}[k_{u_{t+1}}]-1)}$。\n新节点的期望度是 $\\mathbb{E}[k_{u_{t+1}}|v_t] = p k_{v_t} + q$。\n所以，\n$$\n\\mathbb{E}[C(u_{t+1})|v_t] \\approx \\frac{2 \\left( p q k_{v_t} + p^2 \\frac{C(v_t) k_{v_t}(k_{v_t}-1)}{2} \\right)}{(p k_{v_t} + q)(p k_{v_t} + q - 1)} = \\frac{2 p q k_{v_t} + p^2 C(v_t) k_{v_t}(k_{v_t}-1)}{(p k_{v_t} + q)(p k_{v_t} + q - 1)}\n$$\n对于大的 $k_{v_t}$，我们考察主阶项：\n- 分子 $\\approx p^2 C(v_t) k_{v_t}^2$\n- 分母 $\\approx (p k_{v_t})(p k_{v_t}) = p^2 k_{v_t}^2$\n主阶项之比为：\n$$\n\\lim_{k_{v_t} \\to \\infty} \\mathbb{E}[C(u_{t+1})|v_t] \\approx \\frac{p^2 C(v_t) k_{v_t}^2}{p^2 k_{v_t}^2} = C(v_t)\n$$\n这表明，对于一个高度数的父节点，新创建的节点预期会具有与其父节点相似的局部聚类系数。这种机制使得网络即使对于高度数节点也能保持非平凡的聚类。\n\n问题的所有部分都已解决。要求的最终答案是在(c)部分推导出的$\\gamma$的表达式。", "answer": "$$\\boxed{1 + \\frac{1}{p}}$$", "id": "3306719"}, {"introduction": "在分析一个已有的生物网络时，我们如何判断其结构是否经过了自然选择的雕琢？一个关键方法是寻找“网络基序”（network motifs）——那些比在随机网络中出现得更频繁的、反复出现的微小回路。这项练习将指导你使用一个零模型（有向配置模型）来计算特定基序（前馈环）的期望出现次数和方差，并通过计算Z-score来量化观测值与期望值之间的统计显著性。这是一个在计算系统生物学中用于识别网络功能构建块的核心统计推断方法。[@problem_id:3306746]", "problem": "考虑一个有 $N=5$ 个标记节点 $\\{1,2,3,4,5\\}$ 的有向基因调控网络，其总边数为 $M=10$。其出度和入度序列分别为\n$$(k_{1}^{\\text{out}},k_{2}^{\\text{out}},k_{3}^{\\text{out}},k_{4}^{\\text{out}},k_{5}^{\\text{out}})=(3,2,2,1,2), \\quad (k_{1}^{\\text{in}},k_{2}^{\\text{in}},k_{3}^{\\text{in}},k_{4}^{\\text{in}},k_{5}^{\\text{in}})=(1,3,2,2,2),$$\n因此有 $\\sum_{i=1}^{5} k_{i}^{\\text{out}}=\\sum_{i=1}^{5} k_{i}^{\\text{in}}=M=10$。假设采用有向配置模型 (DCM)，其定义如下：给定固定的入度和出度序列，对于 $i \\neq j$，每条有向边 $i \\to j$ 的存在被建模为一个独立的伯努利随机变量，其成功概率为\n$$p_{ij}=\\frac{k_{i}^{\\text{out}}\\,k_{j}^{\\text{in}}}{M},$$\n在稀疏极限下，边的依赖性和多重边可以被忽略。此处，前馈环 (FFL) 定义为一个有序三元组 $(i,j,k)$，其中 $i,j,k$ 均不相同，且有向边 $i \\to j$、$i \\to k$ 和 $j \\to k$ 全部存在。\n\n观测到的网络实现（与指定的度序列一致）具有以下有向边：\n$$1 \\to 2,\\; 1 \\to 3,\\; 1 \\to 5,\\; 2 \\to 3,\\; 2 \\to 1,\\; 3 \\to 5,\\; 3 \\to 4,\\; 4 \\to 2,\\; 5 \\to 2,\\; 5 \\to 4.$$\n\n从 DCM 的定义以及指示随机变量之和的期望和方差的第一性原理出发，完成以下任务：\n\n1. 在 DCM 模型下，根据度序列推导有序前馈环期望数量的表达式，并对给定网络精确求值。\n2. 使用相同的独立性假设和稀疏网络近似（即不同基序指示变量之间的协方差可忽略不计），推导 FFL 数量的近似方差表达式，并对给定网络精确求值。\n3. 计算给定网络实现中观测到的有序 FFL 的数量。\n4. 计算 Z-score\n$$Z=\\frac{N_{\\text{obs}}-\\mathbb{E}[N_{\\text{FFL}}]}{\\sqrt{\\mathrm{Var}(N_{\\text{FFL}})}},$$\n其中 $N_{\\text{obs}}$ 是观测到的 FFL 数量，$\\mathbb{E}[N_{\\text{FFL}}]$ 是 DCM 模型下的期望数量，$\\mathrm{Var}(N_{\\text{FFL}})$ 是在第 2 部分中推导的近似方差。\n\n将最终的 Z-score 以纯数字（无单位）形式给出。将最终答案四舍五入到四位有效数字。在你的推导中解释，在计算系统生物学中，一个过度表现的基序（大的正 $Z$ 值）如何能被解释为选择压力塑造网络拓扑和模块性的证据。", "solution": "该问题要求计算给定有向网络中前馈环 (FFL) 频率的 Z-score。这包括将观测到的 FFL 数量与一个零模型（即有向配置模型，DCM）下的期望数量进行比较，并用该模型下数量的标准差进行归一化。\n\n首先，我们定义必要的变量和指示函数。一个前馈环 (FFL) 是一个由不同节点组成的有序三元组 $(i,j,k)$，其中边 $i \\to j$、$i \\to k$ 和 $j \\to k$ 全部存在。令 $A_{uv}$ 为从节点 $u$ 到节点 $v$ 的有向边存在的指示变量。问题指出，在 DCM 模型下，对于 $u \\neq v$，这些是独立的伯努利随机变量，其成功概率为 $p_{uv} = \\frac{k_{u}^{\\text{out}}\\,k_{v}^{\\text{in}}}{M}$。\n\n令 $I_{ijk}$ 为在有序、不同的节点三元组 $(i,j,k)$ 上存在一个 FFL 的指示变量。因此，$I_{ijk} = A_{ij}A_{ik}A_{jk}$。网络中 FFL 的总数为 $N_{\\text{FFL}} = \\sum_{i \\neq j \\neq k \\neq i} I_{ijk}$，其中求和遍及所有有序的不同节点三元组。\n\n### 第 1 部分：FFL 的期望数量\n\n根据期望的线性性质，FFL 的期望数量为：\n$$ \\mathbb{E}[N_{\\text{FFL}}] = \\mathbb{E}\\left[\\sum_{i \\neq j \\neq k} I_{ijk}\\right] = \\sum_{i \\neq j \\neq k} \\mathbb{E}[I_{ijk}] $$\n指示变量 $I_{ijk}$ 的期望是相应 FFL 存在的概率。由于 DCM 中假定边是独立的：\n$$ \\mathbb{E}[I_{ijk}] = P(A_{ij}=1 \\text{ and } A_{ik}=1 \\text{ and } A_{jk}=1) = P(A_{ij}=1)P(A_{ik}=1)P(A_{jk}=1) = p_{ij}p_{ik}p_{jk} $$\n代入 $p_{uv}$ 的表达式：\n$$ \\mathbb{E}[I_{ijk}] = \\left(\\frac{k_{i}^{\\text{out}}\\,k_{j}^{\\text{in}}}{M}\\right) \\left(\\frac{k_{i}^{\\text{out}}\\,k_{k}^{\\text{in}}}{M}\\right) \\left(\\frac{k_{j}^{\\text{out}}\\,k_{k}^{\\text{in}}}{M}\\right) = \\frac{(k_{i}^{\\text{out}})^2 \\, k_{j}^{\\text{out}}\\,k_{j}^{\\text{in}} \\, (k_{k}^{\\text{in}})^2}{M^3} $$\n总期望数量是对所有不同的三元组 $(i,j,k)$ 求和：\n$$ \\mathbb{E}[N_{\\text{FFL}}] = \\frac{1}{M^3} \\sum_{i \\neq j \\neq k} (k_{i}^{\\text{out}})^2 \\, (k_{j}^{\\text{out}}\\,k_{j}^{\\text{in}}) \\, (k_{k}^{\\text{in}})^2 $$\n为计算此和，令 $a_i = (k_i^{\\text{out}})^2$、$b_j = k_j^{\\text{out}}k_j^{\\text{in}}$ 和 $c_k = (k_k^{\\text{in}})^2$。该和变为 $\\sum_{i \\neq j \\neq k} a_i b_j c_k$。这可以使用容斥原理精确计算：\n$$ \\sum_{i \\neq j \\neq k} a_i b_j c_k = (\\sum_i a_i)(\\sum_j b_j)(\\sum_k c_k) - (\\sum_i a_i b_i)(\\sum_k c_k) - (\\sum_i a_i c_i)(\\sum_j b_j) - (\\sum_i b_i c_i)(\\sum_j a_j) + 2\\sum_i a_i b_i c_i $$\n已知条件为 $N=5$，$M=10$，$k^{\\text{out}}=(3,2,2,1,2)$ 和 $k^{\\text{in}}=(1,3,2,2,2)$。我们首先计算分量 $a_i, b_i, c_i$：\n- $a_i = (k_i^{\\text{out}})^2$: $(3^2, 2^2, 2^2, 1^2, 2^2) = (9, 4, 4, 1, 4)$。\n- $b_i = k_i^{\\text{out}}k_i^{\\text{in}}$: $(3 \\cdot 1, 2 \\cdot 3, 2 \\cdot 2, 1 \\cdot 2, 2 \\cdot 2) = (3, 6, 4, 2, 4)$。\n- $c_i = (k_i^{\\text{in}})^2$: $(1^2, 3^2, 2^2, 2^2, 2^2) = (1, 9, 4, 4, 4)$。\n\n接下来，我们计算公式所需的和：\n- $\\sum a_i = 9+4+4+1+4 = 22$。\n- $\\sum b_i = 3+6+4+2+4 = 19$。\n- $\\sum c_i = 1+9+4+4+4 = 22$。\n- $\\sum a_i b_i = \\sum (k_i^{\\text{out}})^3 k_i^{\\text{in}} = 9 \\cdot 3 + 4 \\cdot 6 + 4 \\cdot 4 + 1 \\cdot 2 + 4 \\cdot 4 = 27+24+16+2+16 = 85$。\n- $\\sum a_i c_i = \\sum (k_i^{\\text{out}}k_i^{\\text{in}})^2 = 9 \\cdot 1 + 4 \\cdot 9 + 4 \\cdot 4 + 1 \\cdot 4 + 4 \\cdot 4 = 9+36+16+4+16 = 81$。\n- $\\sum b_i c_i = \\sum k_i^{\\text{out}} (k_i^{\\text{in}})^3 = 3 \\cdot 1 + 6 \\cdot 9 + 4 \\cdot 4 + 2 \\cdot 4 + 4 \\cdot 4 = 3+54+16+8+16 = 97$。\n- $\\sum a_i b_i c_i = \\sum (k_i^{\\text{out}})^3 (k_i^{\\text{in}})^3 = (3\\cdot1)^3 + (2\\cdot3)^3 + (2\\cdot2)^3 + (1\\cdot2)^3 + (2\\cdot2)^3 = 3^3+6^3+4^3+2^3+4^3 = 27+216+64+8+64 = 379$。\n\n将这些值代入求和公式：\n$$ \\sum_{i \\neq j \\neq k} a_i b_j c_k = (22)(19)(22) - (85)(22) - (81)(19) - (97)(22) + 2(379) $$\n$$ = 9196 - 1870 - 1539 - 2134 + 758 = 4411 $$\n最后，我们求出 FFL 的期望数量：\n$$ \\mathbb{E}[N_{\\text{FFL}}] = \\frac{4411}{M^3} = \\frac{4411}{10^3} = 4.411 $$\n\n### 第 2 部分：FFL 数量的近似方差\n\n总数的方差为 $\\mathrm{Var}(N_{\\text{FFL}}) = \\mathrm{Var}(\\sum_{i \\neq j \\neq k} I_{ijk})$。问题要求使用近似，即不同基序指示变量之间的协方差可以忽略不计。这意味着我们假设当 $(i,j,k) \\neq (l,m,n)$ 时，$\\mathrm{Cov}(I_{ijk}, I_{lmn}) \\approx 0$。在此近似下，方差变为各个方差之和：\n$$ \\mathrm{Var}(N_{\\text{FFL}}) \\approx \\sum_{i \\neq j \\neq k} \\mathrm{Var}(I_{ijk}) $$\n由于 $I_{ijk}$ 是一个伯努利随机变量，其方差为 $\\mathrm{Var}(I_{ijk}) = \\mathbb{E}[I_{ijk}](1 - \\mathbb{E}[I_{ijk}])$。令 $\\pi_{ijk} = \\mathbb{E}[I_{ijk}]$。\n$$ \\mathrm{Var}(N_{\\text{FFL}}) \\approx \\sum_{i \\neq j \\neq k} \\pi_{ijk}(1 - \\pi_{ijk}) = \\sum_{i \\neq j \\neq k} \\pi_{ijk} - \\sum_{i \\neq j \\neq k} \\pi_{ijk}^2 = \\mathbb{E}[N_{\\text{FFL}}] - \\sum_{i \\neq j \\neq k} (\\pi_{ijk})^2 $$\n第二项是：\n$$ \\sum_{i \\neq j \\neq k} (\\pi_{ijk})^2 = \\frac{1}{M^6} \\sum_{i \\neq j \\neq k} (k_{i}^{\\text{out}})^4 \\, (k_{j}^{\\text{out}}\\,k_{j}^{\\text{in}})^2 \\, (k_{k}^{\\text{in}})^4 $$\n我们使用相同的求和公式，其中 $a'_i = (k_i^{\\text{out}})^4$，$b'_j = (k_j^{\\text{out}}k_j^{\\text{in}})^2$ 和 $c'_k = (k_k^{\\text{in}})^4$。\n- $a'_i$: $(3^4, 2^4, 2^4, 1^4, 2^4) = (81, 16, 16, 1, 16)$。$\\sum a' = 130$。\n- $b'_i$: $(3^2, 6^2, 4^2, 2^2, 4^2) = (9, 36, 16, 4, 16)$。$\\sum b' = 81$。\n- $c'_k$: $(1^4, 3^4, 2^4, 2^4, 2^4) = (1, 81, 16, 16, 16)$。$\\sum c' = 130$。\n以及更高阶的和：\n- $\\sum a'_i b'_i = \\sum (k_i^{\\text{out}})^6 (k_i^{\\text{in}})^2 = 729 \\cdot 1 + 64 \\cdot 9 + 64 \\cdot 4 + 1 \\cdot 4 + 64 \\cdot 4 = 729+576+256+4+256 = 1821$。\n- $\\sum a'_i c'_i = \\sum (k_i^{\\text{out}}k_i^{\\text{in}})^4 = 81 \\cdot 1 + 16 \\cdot 81 + 16 \\cdot 16 + 1 \\cdot 16 + 16 \\cdot 16 = 81+1296+256+16+256 = 1905$。\n- $\\sum b'_i c'_i = \\sum (k_i^{\\text{out}})^2 (k_i^{\\text{in}})^6 = 9 \\cdot 1 + 4 \\cdot 729 + 4 \\cdot 64 + 1 \\cdot 64 + 4 \\cdot 64 = 9+2916+256+64+256 = 3501$。\n- $\\sum a'_i b'_i c'_i = \\sum (k_i^{\\text{out}}k_i^{\\text{in}})^6 = 3^6+6^6+4^6+2^6+4^6 = 729+46656+4096+64+4096 = 55641$。\n将这些值代入求和公式：\n$$ \\sum_{i \\neq j \\neq k} a'_i b'_j c'_k = (130)(81)(130) - (1821)(130) - (1905)(81) - (3501)(130) + 2(55641) $$\n$$ = 1368900 - 236730 - 154305 - 455130 + 111282 = 634017 $$\n方差表达式中的第二项是 $\\frac{634017}{M^6} = \\frac{634017}{10^6} = 0.634017$。\n近似方差为：\n$$ \\mathrm{Var}(N_{\\text{FFL}}) \\approx 4.411 - 0.634017 = 3.776983 $$\n\n### 第 3 部分：观测到的 FFL 数量\n\n我们通过检查观测网络中每个节点 $i$ 的所有出边对 $(i \\to j, i \\to k)$，然后检查闭合边 $j \\to k$ 是否存在，来枚举 FFL $(i,j,k)$。\n观测到的边是：$\\{1 \\to 2, 1 \\to 3, 1 \\to 5, 2 \\to 1, 2 \\to 3, 3 \\to 4, 3 \\to 5, 4 \\to 2, 5 \\to 2, 5 \\to 4\\}$。\n- 从节点 1 开始的 FFL（出边指向 2,3,5）：\n  - $(i,j,k) = (1,2,3)$：$1 \\to 2, 1 \\to 3$。检查 $2 \\to 3$。存在。$\\implies (1,2,3)$ 是一个 FFL。\n  - $(i,j,k) = (1,3,5)$：$1 \\to 3, 1 \\to 5$。检查 $3 \\to 5$。存在。$\\implies (1,3,5)$ 是一个 FFL。\n  - $(i,j,k) = (1,5,2)$：$1 \\to 5, 1 \\to 2$。检查 $5 \\to 2$。存在。$\\implies (1,5,2)$ 是一个 FFL。\n- 从节点 2 开始的 FFL（出边指向 1,3）：\n  - $(i,j,k) = (2,1,3)$：$2 \\to 1, 2 \\to 3$。检查 $1 \\to 3$。存在。$\\implies (2,1,3)$ 是一个 FFL。\n- 从节点 3 开始的 FFL（出边指向 4,5）：\n  - $(i,j,k) = (3,5,4)$：$3 \\to 5, 3 \\to 4$。检查 $5 \\to 4$。存在。$\\implies (3,5,4)$ 是一个 FFL。\n- 从节点 4 开始的 FFL（出边指向 2）：无，因为至少需要两条出边。\n- 从节点 5 开始的 FFL（出边指向 2,4）：\n  - $(i,j,k) = (5,4,2)$：$5 \\to 4, 5 \\to 2$。检查 $4 \\to 2$。存在。$\\implies (5,4,2)$ 是一个 FFL。\n观测到的 FFL 是 $(1,2,3)$、$(1,3,5)$、$(1,5,2)$、$(2,1,3)$、$(3,5,4)$ 和 $(5,4,2)$。\n观测到的总数为 $N_{\\text{obs}} = 6$。\n\n### 第 4 部分：Z-score 及其解释\n\nZ-score 是一个标准化度量，用于衡量观测数量 $N_{\\text{obs}}$ 在零模型下偏离期望数量 $\\mathbb{E}[N_{\\text{FFL}}]$ 的程度，以标准差 $\\sigma = \\sqrt{\\mathrm{Var}(N_{\\text{FFL}})}$ 为单位。\n$$ Z = \\frac{N_{\\text{obs}} - \\mathbb{E}[N_{\\text{FFL}}]}{\\sqrt{\\mathrm{Var}(N_{\\text{FFL}})}} $$\n代入我们计算出的值：\n$$ Z = \\frac{6 - 4.411}{\\sqrt{3.776983}} \\approx \\frac{1.589}{1.943446} \\approx 0.817623 $$\n四舍五入到四位有效数字，我们得到 $Z \\approx 0.8176$。\n\n在计算系统生物学中，Z-score 是识别网络基序的关键工具，网络基序是指在真实生物网络中出现频率显著高于随机化网络中的子图模式。一个大的正 Z-score（例如，$Z > 2$ 或 $Z > 3$）表明该基序是“过度表现”的。这种过度表现不被解释为随机产物，而是进化选择的信号。其逻辑是，如果一个特定的电路设计（一个基序）赋予了功能优势——例如过滤噪声、产生振荡或加快响应时间——自然选择将偏爱那些网络中包含这种设计的生物体。因此，该基序成为网络拓扑中一个保守的、模块化的构建块。例如，FFL 是基因调控中最著名的基序之一，已知其能执行多种信号处理任务。通过高 Z-score 发现其过度表现，将是其特定功能对生物体很重要并塑造了网络进化的有力证据。在这个具体案例中，$Z \\approx 0.8176$ 的 Z-score 不够大，不足以断定 FFL 在这个特定网络中是一个显著的基序。", "answer": "$$\\boxed{0.8176}$$", "id": "3306746"}, {"introduction": "网络的拓扑结构如何决定其功能特性？本练习探讨了网络的一个关键全局拓扑属性——同配性（assortativity，即度相关性）——与其在面对扰动时的稳健性之间的联系。我们将运用逾渗理论的框架来形式化定义和分析网络在节点随机失效或被定点攻击下的韧性。通过这项练习，你将深入理解抽象的拓扑特征（如同配性）如何直接转化为具体的系统级功能优势或脆弱性，这是系统生物学的一个中心主题。[@problem_id:3306728]", "problem": "一项计算研究探讨了演化中的细胞相互作用网络的度相关性如何影响其对扰动的鲁棒性。考虑一个大型、稀疏、简单的网络，其具有给定的度分布 $P(k)$，并且在满足特定度-度相关结构（由条件概率 $P(k' \\mid k)$ 编码，该概率表示从一个度为 $k$ 的节点随机选择一条边会连接到一个度为 $k'$ 的节点）的约束下，网络在其他方面是最大程度随机的。同配性系数 $r$ 是随机选择一条边的两端节点的度的皮尔逊相关系数；$r \\in [-1,1]$，其中 $r  0$ 表示同配混合（高度节点倾向于连接到高度节点），而 $r  0$ 表示异配混合。\n\n将随机故障定义为以概率 $q \\in [0,1]$ 独立移除每个节点，将蓄意攻击定义为移除按度的降序选择的比例为 $q \\in [0,1]$ 的节点。令 $S(q)$ 表示在移除比例为 $q$ 的节点后，巨大连通分量中节点的比例。鲁棒性可以通过巨大连通分量消失时的临界比例 $q_c$ 或曲线下面积 $R = \\int_{0}^{1} S(q) \\, dq$ 来概括。\n\n哪个选项正确地阐述了：(i) 针对随机故障与蓄意攻击的鲁棒性的合适操作性定义，(ii) 在由 $P(k)$ 和 $P(k' \\mid k)$ 参数化的相关网络中，随机节点移除下 $S(q)$ 的有效自洽形式体系，以及 (iii) 随机故障阈值 $q_c$ 对一个合适的分支矩阵的主特征值的正确依赖关系，同时附有一个定性正确的陈述，说明在其他条件相同的情况下，增加同配性 $r$ 通常如何影响对随机故障与蓄意攻击的鲁棒性？\n\nA. 对随机故障的鲁棒性可以通过随机移除下 $S(q)$ 消失时的临界比例 $q_c$ 或曲线下面积 $R = \\int_{0}^{1} S(q) \\, dq$ 来衡量；对蓄意攻击的鲁棒性定义类似，但节点是按度的降序移除的。在占据概率为 $p = 1 - q$ 的随机移除下，令 $u_k$ 表示沿着一条随机选择的边进入一个度为 $k$ 的节点后，最终不会通过其剩余的 $k-1$ 个其他残边到达巨大连通分量的概率。自洽性方程为\n$u_k = 1 - p + p \\sum_{k'} P(k' \\mid k) \\, u_{k'}^{\\,k'-1}$，\n巨大连通分量的大小为\n$S(q) = p \\left[ 1 - \\sum_{k} P(k) \\, u_k^{\\,k} \\right]$。\n在 $u_k = 1$ 附近进行线性化，得到渗流阈值 $p_c = 1/\\lambda_{\\max}(B)$，因此 $q_c = 1 - 1/\\lambda_{\\max}(B)$，其中 $B_{k k'} = (k' - 1) \\, P(k' \\mid k)$ 是分支矩阵，$\\lambda_{\\max}(B)$ 是其最大特征值。对于固定的度序列，增加同配性 $r$ 通常会增加 $\\lambda_{\\max}(B)$，从而提高 $q_c$，进而增加对随机故障的鲁棒性，但它会将高度节点集中到一个核心中，这个核心在针对枢纽节点的蓄意攻击下更为脆弱。\n\nB. 对随机故障的鲁棒性最好通过网络直径保持有限来衡量；蓄意攻击等同于随机移除比例为 $q$ 的边。在占据概率为 $p = 1 - q$ 的随机移除下，有 $u_k = 1 - p + p \\sum_{k'} P(k' \\mid k) \\, u_{k'}^{\\,k}$ 且 $S(q) = 1 - \\sum_{k} P(k) \\, u_k$，阈值为 $q_c = 1 - \\lambda_{\\max}(B)$ 其中 $B_{k k'} = k' \\, P(k' \\mid k)$。因此，增加同配性 $r$ 会降低 $\\lambda_{\\max}(B)$，使网络对随机故障的鲁棒性降低，同时提高对蓄意攻击的鲁棒性。\n\nC. 对随机故障的鲁棒性是 $S(q)$ 在 $q \\in [0,1]$ 上的最大值，而对蓄意攻击的鲁棒性是 $S(q)$ 在 $q \\in [0,1]$ 上的最小值。对于任何度相关网络中的随机移除，总可以写出 $S(q) = p \\left[1 - G_0(u)\\right]$，其中 $u = 1 - p + p \\, G_1(u)$，$G_0(x) = \\sum_{k} P(k) x^k$ 且 $G_1(x) = \\sum_{k} \\frac{k P(k)}{\\langle k \\rangle} x^{k-1}$。对于固定的度序列，阈值 $q_c$ 仅依赖于 $P(k)$ 且与同配性 $r$ 无关，并且同配性通常会增加对蓄意攻击的鲁棒性。\n\nD. 对随机故障的鲁棒性可以通过面积 $R = \\int_{0}^{1} S(q) \\, dq$ 来量化，而对蓄意攻击的鲁棒性则通过确定性地移除最高度节点下的相同面积来量化。对于占据概率为 $p = 1 - q$ 的随机移除，正确的自洽性方程为 $u_k = 1 - p + p \\sum_{k'} P(k' \\mid k) \\, u_{k'}^{\\,k'-1}$ 且 $S(q) = p \\left[1 - \\sum_{k} P(k) u_k^{\\,k}\\right]$。阈值满足 $q_c = 1 - 1/\\lambda_{\\max}(B)$，其中 $B_{k k'} = k' \\, P(k' \\mid k)$，并且增加同配性 $r$ 通常会减小 $\\lambda_{\\max}(B)$，从而降低 $q_c$，使网络对随机故障的鲁棒性降低，但对蓄意攻击的鲁棒性增强。", "solution": "问题陈述是一个有效的科学问题，其根源在于复杂网络统计物理，这是计算系统生物学和统计力学的一个子领域。所有术语和概念——例如度分布 $P(k)$、度-度相关性 $P(k' \\mid k)$、同配性 $r$、随机故障、蓄意攻击、巨大连通分量大小 $S(q)$ 和渗流阈值 $q_c$——在相关文献中都有明确的定义并且是标准的。该问题是自洽的、有科学依据的、并且是良定的，要求识别出一组正确的理论陈述。\n\n我们将从第一性原理出发推导正确的理论框架，然后根据该框架评估每个选项。\n\n### 第 (i) 部分：鲁棒性的操作性定义\n\n问题提出了两种情景：随机故障和蓄意攻击。在这些扰动下，网络连通性的恢复力由巨大连通分量（GCC）的大小 $S(q)$ 作为被移除节点比例 $q$ 的函数来量化。从函数 $S(q)$ 推导出的两个标准聚合鲁棒性度量是：\n1.  **移除节点的临界比例, $q_c$**：这是在无限大网络极限下，GCC 消失时 $q$ 的值，即 $S(q > q_c) = 0$。更高的 $q_c$ 意味着网络在解体前可以承受更多损伤，表明其鲁棒性更强。\n2.  **整体恢复力, $R$**：这被定义为 $S(q)$ 曲线下的面积，$R = \\int_{0}^{1} S(q) \\, dq$。该度量提供了在整个扰动范围内网络完整性的全局度量。\n\n$q_c$ 和 $R$ 都是网络鲁棒性的合适且广泛使用的操作性定义。这些定义适用于随机故障和蓄意攻击，关键区别在于对于给定的 $q$ 选择移除哪些节点的方案。\n\n### 第 (ii) 部分：随机故障下 $S(q)$ 的自洽形式体系\n\n我们考虑随机节点移除的情况，其中每个节点以概率 $p = 1 - q$ 被保留。我们采用一种推广到相关网络的生成函数式方法。\n\n令 $u_k$ 为从一个度为 $k$ 的节点出发的边指向一个有限分量（即不连接到 GCC）的概率。当我们沿着这样一条边，我们到达一个度为 $k'$ 的相邻节点。发生这种情况的概率由条件概率 $P(k' \\mid k)$ 给出。这个度为 $k'$ 的相邻节点及其所属的分量（不包括我们刚遍历的路径）是有限的，如果：\na) 该节点本身已被移除（概率为 $1-p$）。\nb) 该节点存在（概率为 $p$），但其所有其他 $k'-1$ 条边都指向有限分量。从一个度为 $k'$ 的节点出发的单条边指向有限分量的概率是 $u_{k'}$。假设不同分支是独立的，所有 $k'-1$ 条边都指向有限分量的概率是 $u_{k'}^{k'-1}$。\n\n对邻居节点度 $k'$ 的所有可能性求和，我们可以为向量 $\\vec{u} = (u_1, u_2, \\ldots)$ 写出自洽方程：\n$$ u_k = \\sum_{k'} P(k' \\mid k) \\left[ (1-p) + p \\cdot u_{k'}^{k'-1} \\right] $$\n由于 $\\sum_{k'} P(k' \\mid k) = 1$，我们可以将其简化为：\n$$ u_k = (1-p) + p \\sum_{k'} P(k' \\mid k) \\, u_{k'}^{k'-1} $$\n这个方程组确定了 $u_k$ 的值。\n\n现在，我们来求 GCC 中的节点比例 $S(q)$。一个随机选择的节点在 GCC 中，如果它被占据（概率为 $p$）并且其至少有一条边连接到 GCC。一个随机选择的节点度为 $k$ 的概率是 $P(k)$。从此节点出发的一条边指向有限分量的概率是 $u_k$。因此，它的所有 $k$ 条边都指向有限分量的概率是 $u_k^k$。因此，它连接到 GCC 的概率是 $1 - u_k^k$。\n对所有可能的度 $k$ 求和，GCC 中节点的总比例为：\n$$ S(q) = S(1-p) = \\sum_k P(k) \\cdot p \\cdot (1 - u_k^k) = p \\left[ 1 - \\sum_k P(k) u_k^k \\right] $$\n\n### 第 (iii) 部分：渗流阈值与同配性的影响\n\n渗流阈值标志着非平凡 GCC 首次出现的点。这对应于对所有 $k$ 的平凡解 $u_k = 1$（这意味着 $S=0$）变得不稳定的点。我们通过线性化自洽方程来分析此解的稳定性。令 $u_k = 1 - \\epsilon_k$，其中 $\\epsilon_k$ 是一个微小的正扰动。\n代入自洽方程：\n$$ 1 - \\epsilon_k = 1 - p + p \\sum_{k'} P(k' \\mid k) (1 - \\epsilon_{k'})^{k'-1} $$\n对于小的 $x$，使用一阶泰勒展开 $(1-x)^n \\approx 1 - nx$：\n$$ 1 - \\epsilon_k \\approx 1 - p + p \\sum_{k'} P(k' \\mid k) [1 - (k'-1)\\epsilon_{k'}] $$\n$$ 1 - \\epsilon_k \\approx 1 - p + p \\left[ \\sum_{k'} P(k' \\mid k) - \\sum_{k'} P(k' \\mid k)(k'-1)\\epsilon_{k'} \\right] $$\n$$ 1 - \\epsilon_k \\approx 1 - p + p \\left[ 1 - \\sum_{k'} (k'-1)P(k' \\mid k)\\epsilon_{k'} \\right] $$\n$$ -\\epsilon_k \\approx -p \\sum_{k'} (k'-1)P(k' \\mid k)\\epsilon_{k'} $$\n$$ \\epsilon_k = p \\sum_{k'} \\left[ (k'-1)P(k' \\mid k) \\right] \\epsilon_{k'} $$\n这是一个线性特征值方程 $\\vec{\\epsilon} = p B \\vec{\\epsilon}$，其中 $B$ 是分支矩阵，其元素为 $B_{k k'} = (k'-1)P(k' \\mid k)$。当 $p$ 使得矩阵 $pB$ 的一个特征值为 $1$ 时，存在 $\\vec{\\epsilon}$ 的非平凡解。GCC 的出现发生在临界概率 $p_c$ 处，此时 $p_c B$ 的最大特征值为 $1$。这意味着 $\\lambda_{\\max}(p_c B) = p_c \\lambda_{\\max}(B) = 1$，或 $p_c = 1/\\lambda_{\\max}(B)$。\n因此，移除节点的临界比例为 $q_c = 1 - p_c = 1 - 1/\\lambda_{\\max}(B)$。\n\n**同配性 ($r$) 的影响：**\n- **随机故障：**增加同配性 ($r>0$) 意味着高度节点倾向于连接到其他高度节点。这会形成一个高度连接的核心。这样的核心结构增强了路径的传播，使网络在面对节点的随机移除时更具鲁棒性。在数学上，对于大的 $k,k'$，矩阵元素 $B_{kk'}$ 增加，这通常会增加主特征值 $\\lambda_{\\max}(B)$。一个更大的 $\\lambda_{\\max}(B)$ 会导致一个更小的 $p_c$，从而导致一个更大的 $q_c$。更大的 $q_c$ 意味着对随机故障有更强的鲁棒性。\n- **蓄意攻击：**在蓄意攻击中，首先移除度最高的节点。在一个同配网络中，这些枢纽节点都在一个中心核心中相互连接。精确地移除它们会拆解网络的核心，导致 GCC 的快速崩溃。因此，增加同配性通常会使网络对蓄意攻击的鲁棒性 *降低*（更脆弱）。\n\n### 选项评估\n\n**A.** (i) 使用 $q_c$ 或 $R$ 定义鲁棒性是正确的。(ii) 自洽方程 $u_k = 1 - p + p \\sum_{k'} P(k' \\mid k) \\, u_{k'}^{\\,k'-1}$ 和 GCC 大小 $S(q) = p \\left[ 1 - \\sum_{k} P(k) \\, u_k^{\\,k} \\right]$ 是正确的。(iii) 分支矩阵 $B_{k k'} = (k' - 1) \\, P(k' \\mid k)$ 和阈值 $q_c = 1 - 1/\\lambda_{\\max}(B)$ 是正确的。关于同配性影响的定性陈述也是正确的：增加 $r$ 通常会增加对随机故障的鲁棒性，但会降低对蓄意攻击的鲁棒性。\n**结论：正确。**\n\n**B.** (i) 用直径定义鲁棒性不那么直接，并且将蓄意攻击等同于随机移除边是错误的。(ii) 自洽形式体系包含一个错误的指数（$u_{k'}^k$ 而不是 $u_{k'}^{k'-1}$）和一个错误的 $S(q)$ 公式。(iii) 分支矩阵是错误的（$k'$ 而不是 $k'-1$），$q_c$ 的公式是错误的，并且关于同配性的结论与正确行为相反。\n**结论：错误。**\n\n**C.** (i) 将鲁棒性定义为 $\\max S(q)$ 或 $\\min S(q)$ 是无意义的。(ii) 使用 $G_0(x)$ 和 $G_1(x)$ 的形式体系是针对无相关网络的，不适用于此处指定的情况。(iii) 声称 $q_c$ 与同配性无关是错误的。同配性增加对蓄意攻击的鲁棒性的结论通常也是错误的。\n**结论：错误。**\n\n**D.** (i) 鲁棒性的定义是正确的。(ii) 自洽方程是正确的。(iii) 分支矩阵是错误的（$k'$ 而不是正确的 $k'-1$）。因此，所陈述的同配性对鲁棒性的影响是错误的（它们是相反的）。\n**结论：错误。**\n\n根据详细分析，只有选项 A 是完全正确的。", "answer": "$$\\boxed{A}$$", "id": "3306728"}]}