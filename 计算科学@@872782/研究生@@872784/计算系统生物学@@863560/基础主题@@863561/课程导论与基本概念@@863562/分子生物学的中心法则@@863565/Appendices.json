{"hands_on_practices": [{"introduction": "中心法则不仅描述了信息的流向，还蕴含了调控基因表达速率的机制。一个关键的调控层面发生在翻译伸长阶段，其中同义密码子的选择并非无关紧要，因为它们对应的tRNA分子丰度不同。这个练习旨在通过一个基于随机过程和tRNA丰度的动力学模型，量化密码子使用偏好对翻译速度的影响，从而让学生掌握评估和优化基因序列以实现特定表达水平的核心技能 [@problem_id:3355123]。", "problem": "考虑一个分子生物学中心法则内核糖体驱动翻译延伸的最小随机模型，其中核糖体利用同源转移核糖核酸（tRNA）一次解码一个信使核糖核酸（mRNA）上的密码子。假设每个特定密码子的延伸步骤都是无记忆的（等待时间呈指数分布），其速率依赖于密码子。令密码子 $c$ 的瞬时延伸速率为 $k_{e}(c)$，满足 $k_{e}(c) = k_{0}\\, a_{c}$，其中 $a_{c}$ 是密码子 $c$ 的同源 tRNA 的相对丰度，而 $k_{0}$ 是一个核糖体和条件特异性的比例常数。您可以假设连续的延伸步骤是相互独立的，并且在翻译的时间尺度上 $a_{c}$ 是平稳的。\n\n从这些模型假设以及关于指数等待时间过程和期望线性性质的基本事实出发，推导出一个 mRNA 密码子序列 $\\{c_{j}\\}_{j=1}^{n}$ 的预期总延伸时间的解析表达式。然后，在以下情景中对此表达式进行数值计算。\n\n设 $n = 12$，原始密码子序列为\n$\\{\\text{AAA}, \\text{GCT}, \\text{CTT}, \\text{GAA}, \\text{TTT}, \\text{ATA}, \\text{CGT}, \\text{TCT}, \\text{GGT}, \\text{CAA}, \\text{TTA}, \\text{GCA}\\}$。\n一组同义替换产生了优化后的序列\n$\\{\\text{AAG}, \\text{GCC}, \\text{CTG}, \\text{GAG}, \\text{TTC}, \\text{ATT}, \\text{CGC}, \\text{TCC}, \\text{GGC}, \\text{CAG}, \\text{CTG}, \\text{GCC}\\}$。\n使用 $k_{0} = 20$，单位为 $\\text{s}^{-1}$。\n\n特定密码子的 tRNA 相对丰度 $a_{c}$（无量纲）如下所示：\n- $\\text{AAA}: 0.65$, $\\text{AAG}: 0.95$\n- $\\text{GCT}: 0.50$, $\\text{GCC}: 0.90$, $\\text{GCA}: 0.70$\n- $\\text{CTT}: 0.40$, $\\text{CTG}: 1.10$\n- $\\text{GAA}: 0.60$, $\\text{GAG}: 0.85$\n- $\\text{TTT}: 0.45$, $\\text{TTC}: 0.80$\n- $\\text{ATA}: 0.30$, $\\text{ATT}: 0.75$\n- $\\text{CGT}: 0.35$, $\\text{CGC}: 0.88$\n- $\\text{TCT}: 0.55$, $\\text{TCC}: 0.92$\n- $\\text{GGT}: 0.50$, $\\text{GGC}: 1.00$\n- $\\text{CAA}: 0.48$, $\\text{CAG}: 0.89$\n- $\\text{TTA}: 0.42$\n\n计算替换前的预期总延伸时间 $T_{\\text{before}}$ 和替换后的预期总延伸时间 $T_{\\text{after}}$，并报告变化量 $\\Delta T = T_{\\text{after}} - T_{\\text{before}}$，单位为 $\\text{s}$。将您最终报告的 $\\Delta T$ 值四舍五入至四位有效数字。答案以 $\\text{s}$ 为单位表示。", "solution": "我们从中心法则的工作流程开始，其中核糖体通过使用同源 tRNA 解码密码子，将 mRNA 翻译成多肽。在所述假设下，每个特定密码子的延伸步骤都有一个无记忆的等待时间，建模为一个指数随机变量。对于密码子 $c$，等待时间 $X_{c}$ 的速率为 $k_{e}(c)$，因此 $X_{c} \\sim \\text{Exp}(k_{e}(c))$。一个经过充分检验的事实是，对于一个速率为 $k$ 的指数随机变量，其期望值为 $\\mathbb{E}[X] = \\frac{1}{k}$。另一个基本性质是期望的线性性质，它不要求独立性：对于随机变量 $X_{1},\\dots,X_{n}$，$\\mathbb{E}\\left[\\sum_{j=1}^{n} X_{j}\\right] = \\sum_{j=1}^{n} \\mathbb{E}[X_{j}]$。此处的独立性支持了模型假设，但对于期望求和而言并非必需。\n\n设 mRNA 密码子序列为 $\\{c_{j}\\}_{j=1}^{n}$。总延伸时间 $T$ 是各特定密码子解码时间之和，$T = \\sum_{j=1}^{n} X_{c_{j}}$。使用 $\\mathbb{E}[X_{c_{j}}] = \\frac{1}{k_{e}(c_{j})}$，我们得到\n$$\n\\mathbb{E}[T] \\;=\\; \\sum_{j=1}^{n} \\frac{1}{k_{e}(c_{j})}.\n$$\n根据模型，$k_{e}(c) = k_{0}\\, a_{c}$，其中 $a_{c}$ 是该密码子的同源 tRNA 相对丰度，$k_{0}$ 体现了核糖体和条件特异性的比例关系。代入可得解析表达式\n$$\n\\mathbb{E}[T] \\;=\\; \\sum_{j=1}^{n} \\frac{1}{k_{0}\\, a_{c_{j}}}\n\\;=\\; \\frac{1}{k_{0}} \\sum_{j=1}^{n} \\frac{1}{a_{c_{j}}}.\n$$\n\n现在我们对指定的序列使用 $n = 12$ 和 $k_{0} = 20$（单位 $\\text{s}^{-1}$）来计算该表达式。\n\n对于原始序列 $\\{\\text{AAA}, \\text{GCT}, \\text{CTT}, \\text{GAA}, \\text{TTT}, \\text{ATA}, \\text{CGT}, \\text{TCT}, \\text{GGT}, \\text{CAA}, \\text{TTA}, \\text{GCA}\\}$，我们计算\n$$\nT_{\\text{before}} \\;=\\; \\frac{1}{20} \\left(\n\\frac{1}{0.65} + \\frac{1}{0.50} + \\frac{1}{0.40} + \\frac{1}{0.60} + \\frac{1}{0.45} + \\frac{1}{0.30} + \\frac{1}{0.35} + \\frac{1}{0.55} + \\frac{1}{0.50} + \\frac{1}{0.48} + \\frac{1}{0.42} + \\frac{1}{0.70}\n\\right).\n$$\n计算倒数：\n- $\\frac{1}{0.65} = 1.53846153846$,\n- $\\frac{1}{0.50} = 2$,\n- $\\frac{1}{0.40} = 2.5$,\n- $\\frac{1}{0.60} = 1.66666666667$,\n- $\\frac{1}{0.45} = 2.22222222222$,\n- $\\frac{1}{0.30} = 3.33333333333$,\n- $\\frac{1}{0.35} = 2.85714285714$,\n- $\\frac{1}{0.55} = 1.81818181818$,\n- $\\frac{1}{0.50} = 2$,\n- $\\frac{1}{0.48} = 2.08333333333$,\n- $\\frac{1}{0.42} = 2.38095238095$,\n- $\\frac{1}{0.70} = 1.42857142857$.\n将这些值相加得到\n$$\n\\sum_{j=1}^{12} \\frac{1}{a_{c_{j}}} \\;=\\; 25.82886557885,\n$$\n所以\n$$\nT_{\\text{before}} \\;=\\; \\frac{25.82886557885}{20} \\;=\\; 1.2914432789425.\n$$\n\n对于优化序列 $\\{\\text{AAG}, \\text{GCC}, \\text{CTG}, \\text{GAG}, \\text{TTC}, \\text{ATT}, \\text{CGC}, \\text{TCC}, \\text{GGC}, \\text{CAG}, \\text{CTG}, \\text{GCC}\\}$，我们计算\n$$\nT_{\\text{after}} \\;=\\; \\frac{1}{20} \\left(\n\\frac{1}{0.95} + \\frac{1}{0.90} + \\frac{1}{1.10} + \\frac{1}{0.85} + \\frac{1}{0.80} + \\frac{1}{0.75} + \\frac{1}{0.88} + \\frac{1}{0.92} + \\frac{1}{1.00} + \\frac{1}{0.89} + \\frac{1}{1.10} + \\frac{1}{0.90}\n\\right).\n$$\n计算倒数：\n- $\\frac{1}{0.95} = 1.05263157895$,\n- $\\frac{1}{0.90} = 1.11111111111$,\n- $\\frac{1}{1.10} = 0.909090909091$,\n- $\\frac{1}{0.85} = 1.17647058824$,\n- $\\frac{1}{0.80} = 1.25$,\n- $\\frac{1}{0.75} = 1.33333333333$,\n- $\\frac{1}{0.88} = 1.13636363636$,\n- $\\frac{1}{0.92} = 1.08695652174$,\n- $\\frac{1}{1.00} = 1$,\n- $\\frac{1}{0.89} = 1.12359550562$,\n- $\\frac{1}{1.10} = 0.909090909091$,\n- $\\frac{1}{0.90} = 1.11111111111$.\n将这些值相加得到\n$$\n\\sum_{j=1}^{12} \\frac{1}{a_{c_{j}}} \\;=\\; 13.19975520464,\n$$\n所以\n$$\nT_{\\text{after}} \\;=\\; \\frac{13.19975520464}{20} \\;=\\; 0.6599877602320.\n$$\n\n预期总延伸时间的变化量为\n$$\n\\Delta T \\;=\\; T_{\\text{after}} - T_{\\text{before}} \\;=\\; 0.6599877602320 \\,-\\, 1.2914432789425 \\;=\\; -0.6314555187105.\n$$\n四舍五入至四位有效数字，$\\Delta T = -0.6315$，单位为 $\\text{s}$。", "answer": "$$\\boxed{-0.6315}$$", "id": "3355123"}, {"introduction": "将基因表达视为一个多步骤的生产线，其整体产出速率往往受到最慢环节——即“瓶颈”——的限制。本练习借鉴了排队论这一强大的系统工程工具，将中心法则的流程（从启动子激活到蛋白质合成）抽象为一个串联队列模型。通过计算每个阶段的“利用率”，学生可以学习如何定量地识别基因表达过程中的限速步骤，这对于理解细胞资源分配和合成生物学设计至关重要 [@problem_id:3355173]。", "problem": "考虑一个分子生物学中心法则的三阶段抽象模型，该模型在计算系统生物学中被构建为一个串联队列。这些阶段是：(i) 控制转录起始的 DNA 启动子转换，(ii) 由 RNA 聚合酶合成信使核糖核酸 (mRNA)，以及 (iii) 由核糖体进行蛋白质合成，该过程通过完全非对称简单排斥过程 (TASEP) 进行建模。目标是通过计算队列利用率来识别瓶颈，并评估串联系统在稳态条件下的稳定性。您的程序必须为每个提供的测试用例计算三个阶段的利用率，确定瓶颈站点和稳定性标志，然后按规定汇总结果。\n\n使用以下有科学依据的基本假设和定义：\n\n- 中心法则指出，脱氧核糖核酸 (DNA) 被转录成信使核糖核酸 (mRNA)，后者再被翻译成蛋白质。\n- 启动子以速率 $k_\\mathrm{on}$ 和 $k_\\mathrm{off}$ (单位 $\\mathrm{s}^{-1}$) 在 $ON$ 和 $OFF$ 状态之间切换。对于一个两状态连续时间 Markov 过程，在稳态下，处于 $ON$ 状态的时间分数为 $P_\\mathrm{ON} = \\dfrac{k_\\mathrm{on}}{k_\\mathrm{on} + k_\\mathrm{off}}$。\n- 当启动子处于 $ON$ 状态时，转录起始事件以最大速率 $r_\\mathrm{tx}$ (单位 $\\mathrm{s}^{-1}$) 的泊松过程发生，从而产生平均转录起始速率 $\\lambda_m = P_\\mathrm{ON}\\, r_\\mathrm{tx}$ (单位 $\\mathrm{s}^{-1}$)。\n- 转录延伸和终止被建模为一个单服务台队列，每个转录本完成的服务速率为 $\\mu_m$ (单位 $\\mathrm{s}^{-1}$)。阶段 2 的利用率为 $\\rho_2 = \\lambda_m / \\mu_m$。\n- 核糖体翻译在低起始密度下通过完全非对称简单排斥过程 (TASEP) 近似。其中，每个密码子的平均跳跃速率为 $p$ (单位 $\\mathrm{codons}\\,\\mathrm{s}^{-1}$)，多肽链长度为 $L$ (单位 $\\mathrm{codons}$)。在低密度区域下，在一个 mRNA 上完成一个蛋白质的有效服务速率近似为 $\\mu_p = p / L$ (单位 $\\mathrm{s}^{-1}$)，从而得到阶段 3 的利用率 $\\rho_3 = \\lambda_m / \\mu_p$。\n- 为确保诊断的完整性，将启动子门视为阶段 1 的资源，其利用率代理为 $\\rho_1 = P_\\mathrm{ON}$。\n- 将瓶颈定义为其利用率 $\\rho_i$ 最大的站点索引 $i \\in \\{1,2,3\\}$；如果出现平局，则选择最小的索引。\n- 定义串联系统是稳定的，当且仅当 $\\rho_2  1$ 且 $\\rho_3  1$。请注意，根据定义 $\\rho_1 \\le 1$，它不会导致不稳定性。\n\n你的任务是实现一个程序，为每个测试用例计算列表 $[\\rho_1, \\rho_2, \\rho_3, i_\\mathrm{bottleneck}, \\mathrm{stable}]$，其中 $\\rho_1$、$\\rho_2$ 和 $\\rho_3$是浮点数，$i_\\mathrm{bottleneck}$ 是 $\\{1,2,3\\}$ 中的一个整数，$\\mathrm{stable}$ 是一个布尔值。对于 $k_\\mathrm{on}$、$k_\\mathrm{off}$、$r_\\mathrm{tx}$ 和 $\\mu_m$，速率单位必须统一为 $\\mathrm{s}^{-1}$；对于 $p$，单位为 $\\mathrm{codons}\\,\\mathrm{s}^{-1}$；对于 $L$，单位为 $\\mathrm{codons}$。\n\n使用以下参数集测试套件，以确保覆盖典型和边缘情况下的行为：\n\n- 测试用例 1 (平衡利用率): $k_\\mathrm{on} = 0.05\\,\\mathrm{s}^{-1}$, $k_\\mathrm{off} = 0.10\\,\\mathrm{s}^{-1}$, $r_\\mathrm{tx} = 0.10\\,\\mathrm{s}^{-1}$, $\\mu_m = 0.05\\,\\mathrm{s}^{-1}$, $p = 15\\,\\mathrm{codons}\\,\\mathrm{s}^{-1}$, $L = 300\\,\\mathrm{codons}$。\n- 测试用例 2 (翻译受限): $k_\\mathrm{on} = 0.05\\,\\mathrm{s}^{-1}$, $k_\\mathrm{off} = 0.10\\,\\mathrm{s}^{-1}$, $r_\\mathrm{tx} = 0.10\\,\\mathrm{s}^{-1}$, $\\mu_m = 0.05\\,\\mathrm{s}^{-1}$, $p = 5\\,\\mathrm{codons}\\,\\mathrm{s}^{-1}$, $L = 300\\,\\mathrm{codons}$。\n- 测试用例 3 (转录受限): $k_\\mathrm{on} = 0.05\\,\\mathrm{s}^{-1}$, $k_\\mathrm{off} = 0.10\\,\\mathrm{s}^{-1}$, $r_\\mathrm{tx} = 0.10\\,\\mathrm{s}^{-1}$, $\\mu_m = 0.02\\,\\mathrm{s}^{-1}$, $p = 15\\,\\mathrm{codons}\\,\\mathrm{s}^{-1}$, $L = 300\\,\\mathrm{codons}$。\n- 测试用例 4 (几乎总是 ON，高通量需求): $k_\\mathrm{on} = 10\\,\\mathrm{s}^{-1}$, $k_\\mathrm{off} = 0.01\\,\\mathrm{s}^{-1}$, $r_\\mathrm{tx} = 1\\,\\mathrm{s}^{-1}$, $\\mu_m = 0.10\\,\\mathrm{s}^{-1}$, $p = 50\\,\\mathrm{codons}\\,\\mathrm{s}^{-1}$, $L = 100\\,\\mathrm{codons}$。\n- 测试用例 5 ($\\rho_3 = 1$ 的边界条件): $k_\\mathrm{on} = 0.20\\,\\mathrm{s}^{-1}$, $k_\\mathrm{off} = 0.20\\,\\mathrm{s}^{-1}$, $r_\\mathrm{tx} = 0.05\\,\\mathrm{s}^{-1}$, $\\mu_m = 0.10\\,\\mathrm{s}^{-1}$, $p = 10\\,\\mathrm{codons}\\,\\mathrm{s}^{-1}$, $L = 400\\,\\mathrm{codons}$。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。对于每个测试用例，输出列表 $[\\rho_1, \\rho_2, \\rho_3, i_\\mathrm{bottleneck}, \\mathrm{stable}]$，并将所有五个测试用例的结果汇总到一个列表中，例如，以单行、逗号分隔和方括号的形式表示为 $[[\\dots],[\\dots],[\\dots],[\\dots],[\\dots]]$。", "solution": "解决方案的流程是根据所提供的定义，为每个测试用例系统地计算所需的指标。该过程涉及对代表基因表达的三阶段串联队列进行逐步评估。\n\n**步骤 1：阶段 1 利用率（启动子门控）**\n\n第一阶段模拟了基因启动子在 $ON$ 和 $OFF$ 状态之间的随机切换。这被描述为一个两状态连续时间 Markov 过程，其转换速率分别为 $k_\\mathrm{on}$ (用于 $OFF \\rightarrow ON$) 和 $k_\\mathrm{off}$ (用于 $ON \\rightarrow OFF$)，单位均为 $\\mathrm{s}^{-1}$。\n\n在稳态下，启动子处于 $ON$ 状态的时间分数 $P_\\mathrm{ON}$ 由下式给出：\n$$P_\\mathrm{ON} = \\frac{k_\\mathrm{on}}{k_\\mathrm{on} + k_\\mathrm{off}}$$\n这个量是无量纲的。根据问题定义，这个概率作为启动子资源利用率的代理，记为 $\\rho_1$。\n$$\\rho_1 = P_\\mathrm{ON}$$\n\n**步骤 2：阶段 2 利用率（mRNA 合成）**\n\n第二阶段模拟了 DNA 转录为信使 RNA (mRNA) 的过程。转录起始是一个泊松过程，只有当启动子处于 $ON$ 状态时才能发生。最大起始速率为 $r_\\mathrm{tx}$ (单位 $\\mathrm{s}^{-1}$)。因此，平均转录起始速率 $\\lambda_m$ 是最大速率受启动子激活概率调制的结果：\n$$\\lambda_m = P_\\mathrm{ON} \\cdot r_\\mathrm{tx}$$\n$\\lambda_m$ 的单位是 $\\mathrm{s}^{-1}$。\n\n随后的 mRNA 延伸和终止过程被建模为一个单服务台队列，服务速率为 $\\mu_m$ (单位 $\\mathrm{s}^{-1}$)，代表完成一个 mRNA 转录本的速率。该转录机制的利用率 $\\rho_2$ 是起始事件的到达速率 ($\\lambda_m$) 与转录本完成的服务速率 ($\\mu_m$) 之比，这是排队论中的一个标准结果。\n$$\\rho_2 = \\frac{\\lambda_m}{\\mu_m}$$\n该利用率是一个无量纲的量。\n\n**步骤 3：阶段 3 利用率（蛋白质合成）**\n\n第三阶段模拟了核糖体将 mRNA 翻译成蛋白质的过程。该过程通过完全非对称简单排斥过程 (TASEP) 进行近似。在指定的低密度区域中，可以计算出完成一条多肽链的有效服务速率 $\\mu_p$。它取决于核糖体沿 mRNA 的平均跳跃速率 $p$ (单位 $\\mathrm{codons}\\,\\mathrm{s}^{-1}$) 和待合成多肽链的长度 $L$ (单位 $\\mathrm{codons}$)。遍历 mRNA 的时间大约是 $L/p$，因此完成速率是其倒数：\n$$\\mu_p = \\frac{p}{L}$$\n$\\mu_p$ 的单位是 $\\mathrm{s}^{-1}$。\n\n到达此阶段的任务（即新的翻译过程）的速率假定为转录阶段的稳态输出速率，该速率等于转录起始速率 $\\lambda_m$。因此，翻译机制的利用率 $\\rho_3$ 是到达速率 $\\lambda_m$ 与蛋白质合成服务速率 $\\mu_p$ 之比：\n$$\\rho_3 = \\frac{\\lambda_m}{\\mu_p}$$\n该利用率也是无量纲的。\n\n**步骤 4：瓶颈识别**\n\n三阶段系统的瓶颈被定义为具有最高利用率的站点。利用率集合为 $\\{\\rho_1, \\rho_2, \\rho_3\\}$。瓶颈站点索引 $i_\\mathrm{bottleneck}$ 是使 $\\rho_i$ 最大化的索引 $i \\in \\{1, 2, 3\\}$。\n$$i_\\mathrm{bottleneck} = \\underset{i \\in \\{1, 2, 3\\}}{\\mathrm{argmax}} \\{\\rho_i\\}$$\n在利用率值出现平局的情况下，问题规定应选择最小的站点索引。例如，如果 $\\rho_2 = \\rho_3$ 并且该值是最大值，则瓶颈是站点 2。\n\n**步骤 5：系统稳定性分析**\n\n串联排队系统的稳定性由处理阶段（阶段 2 和 3）的利用率决定。根据排队论，如果一个队列的利用率严格小于 1，则该队列是稳定的。如果利用率大于或等于 1，队列长度将无限增长，导致不稳定性。问题定义系统是稳定的，当且仅当阶段 2 和阶段 3 的利用率都低于此阈值。\n$$\\mathrm{stable} = (\\rho_2  1) \\land (\\rho_3  1)$$\n阶段 1 的利用率 $\\rho_1 = P_\\mathrm{ON}$ 是一个概率，因此界于 0 和 1 之间 ($0 \\le \\rho_1 \\le 1$)。它不代表一个可以无限增长的队列，并被正确地从稳定性条件中排除。\n\n**计算实现**\n\n实现一个程序来为所提供的五个测试用例中的每一个执行这些计算。对于每个用例，它计算五元素列表 $[\\rho_1, \\rho_2, \\rho_3, i_\\mathrm{bottleneck}, \\mathrm{stable}]$ 并将这些列表汇总成最终结果。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes utilizations, bottleneck, and stability for a three-stage model of gene expression.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (k_on, k_off, r_tx, mu_m, p, L)\n    test_cases = [\n        # Test case 1 (balanced utilization)\n        (0.05, 0.10, 0.10, 0.05, 15, 300),\n        # Test case 2 (translation-limited)\n        (0.05, 0.10, 0.10, 0.05, 5, 300),\n        # Test case 3 (transcription-limited)\n        (0.05, 0.10, 0.10, 0.02, 15, 300),\n        # Test case 4 (nearly always ON, high throughput demand)\n        (10.0, 0.01, 1.0, 0.10, 50, 100),\n        # Test case 5 (boundary condition at rho_3 = 1)\n        (0.20, 0.20, 0.05, 0.10, 10, 400),\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        k_on, k_off, r_tx, mu_m, p, L = case\n\n        # Step 1: Stage-1 Utilization (Promoter Gating)\n        # P_ON is the fraction of time the promoter is in the ON state.\n        # This is also the proxy for stage-1 utilization, rho_1.\n        p_on = k_on / (k_on + k_off)\n        rho_1 = p_on\n\n        # Step 2: Stage-2 Utilization (mRNA Synthesis)\n        # lambda_m is the average transcription initiation rate.\n        lambda_m = p_on * r_tx\n        # rho_2 is the utilization of the transcription machinery.\n        rho_2 = lambda_m / mu_m\n\n        # Step 3: Stage-3 Utilization (Protein Synthesis)\n        # mu_p is the effective service rate for protein completion.\n        mu_p = p / L\n        # rho_3 is the utilization of the translation machinery.\n        rho_3 = lambda_m / mu_p\n\n        utilizations = np.array([rho_1, rho_2, rho_3])\n\n        # Step 4: Bottleneck Identification\n        # Find the index of the maximum utilization.\n        # np.argmax returns the first occurrence in case of a tie, which matches the rule.\n        # Add 1 to convert from 0-based index to 1-based station index.\n        i_bottleneck = int(np.argmax(utilizations) + 1)\n\n        # Step 5: System Stability Analysis\n        # System is stable if and only if rho_2  1.0 and rho_3  1.0.\n        is_stable = (rho_2  1.0) and (rho_3  1.0)\n\n        # Assemble the results for the current test case.\n        case_result = [rho_1, rho_2, rho_3, i_bottleneck, is_stable]\n        all_results.append(case_result)\n\n    # Final print statement in the exact required format.\n    # The format is a string representation of a list of lists.\n    # The example f\"[{','.join(map(str, results))}]\" works perfectly for this.\n    print(f\"[{','.join(map(str, all_results))}]\".replace(\" \", \"\"))\n\nsolve()\n```", "id": "3355173"}, {"introduction": "中心法则的根本意义在于确保遗传信息在代际间的精确传递。然而，DNA复制过程中的突变是不可避免的，这引出了一个深刻的进化问题：一个物种能容忍的最大突变率是多少？本练习通过一个理论模型来探讨这个被称为“错误灾变”的临界点，在该临界点之上，突变的累积将导致功能性蛋白质的丧失，最终使种群无法维持。这个思想实验将分子层面的保真度与群体水平的生存能力联系起来，揭示了信息理论在进化生物学中的基本作用 [@problem_id:3355105]。", "problem": "考虑一个微生物种群中长度为 $L$ 个核苷酸的单个蛋白质编码基因。根据分子生物学中心法则，脱氧核糖核酸（DNA）被转录为信使核糖核酸（mRNA），然后被翻译成蛋白质，因此DNA序列中的可遗传改变会传播到蛋白质序列的改变。假设在DNA复制过程中，每个核苷酸每代以概率 $\\mu$ 独立发生突变。令 $k$ 表示在单个世代内编码序列中发生的点突变数量。\n\n定义 $\\nu \\in [0,1]$ 为单个氨基酸替换的中性程度，这意味着单个替换使蛋白质保持功能的概率为 $\\nu$，使其失去功能的概率为 $1-\\nu$。假设多个替换的功能性效应以乘法方式复合，因此含有 $k$ 个替换的蛋白质保持功能的概率为 $\\nu^{k}$。假设点突变是罕见的并且在基因上独立分布，并且在独立伯努利试验的标准概率建模所隐含的大 $L$、小 $\\mu$ 极限下，每基因每代的点突变数量可以近似为泊松分布。\n\n令 $f_{c} \\in (0,1)$ 为避免错误灾变（即避免种群中蛋白质功能性崩溃）所需的有功能蛋白质平均比例的临界下限。仅使用上述假设以及关于独立复制错误及其在中心法则下向蛋白质功能传播的经过充分检验的事实，推导出最大可容忍突变率 $\\mu^{\\ast}$，使得功能性蛋白质的平均比例保持在或高于 $f_{c}$。以 $L$、$\\nu$ 和 $f_{c}$ 的函数形式，给出 $\\mu^{\\ast}$ 的最终闭合形式表达式。最终答案必须是无单位的单个解析表达式。", "solution": "该问题要求的是最大突变率 $\\mu^{\\ast}$，该突变率允许种群将功能性蛋白质的平均比例维持在临界阈值 $f_c$ 或以上。\n\n在长度为 $L$ 的基因中，每个核苷酸以概率 $\\mu$ 独立突变，其突变数 $k$ 是一个二项随机变量，$k \\sim \\text{Binomial}(L, \\mu)$。问题陈述指出，在大 $L$、小 $\\mu$ 的极限下，这可以近似为泊松分布。二项分布的均值为 $L\\mu$。近似泊松分布的率参数 $\\lambda$ 被设置为此均值。\n$$ \\lambda = L\\mu $$\n在单个世代中，一个基因中观察到恰好 $k$ 次突变的概率由泊松概率质量函数给出：\n$$ P(k; \\lambda) = \\frac{\\lambda^k \\exp(-\\lambda)}{k!} $$\n问题定义了含有 $k$ 个氨基酸替换的蛋白质保持功能的概率为 $\\nu^k$。我们将DNA序列中的点突变数量等同于蛋白质中的氨基酸替换数量。这是一种简化，因为并非所有核苷酸突变都会导致氨基酸改变（同义突变），但我们遵循模型的明确假设进行推导。在给定 $k$ 次突变的情况下，蛋白质保持功能的条件概率是：\n$$ P(\\text{functional} | k \\text{ mutations}) = \\nu^k $$\n为了求出种群中功能性蛋白质的平均比例，记作 $\\langle F \\rangle$，我们使用全概率定律。我们对所有可能的突变数（$k=0, 1, 2, ...$）求和，用发生该突变数的概率对功能性的条件概率进行加权。\n$$ \\langle F \\rangle = \\sum_{k=0}^{\\infty} P(\\text{functional} | k \\text{ mutations}) \\cdot P(k; \\lambda) $$\n代入概率的表达式：\n$$ \\langle F \\rangle = \\sum_{k=0}^{\\infty} \\nu^k \\cdot \\frac{\\lambda^k \\exp(-\\lambda)}{k!} $$\n我们可以重新排列求和式中的项。$\\exp(-\\lambda)$ 项相对于求和指数 $k$ 是一个常数。\n$$ \\langle F \\rangle = \\exp(-\\lambda) \\sum_{k=0}^{\\infty} \\frac{(\\nu\\lambda)^k}{k!} $$\n该求和式是指数函数的泰勒级数展开式，$\\sum_{n=0}^{\\infty} \\frac{x^n}{n!} = \\exp(x)$。在我们的例子中，自变量是 $x = \\nu\\lambda$。\n$$ \\sum_{k=0}^{\\infty} \\frac{(\\nu\\lambda)^k}{k!} = \\exp(\\nu\\lambda) $$\n将此结果代回 $\\langle F \\rangle$ 的表达式中：\n$$ \\langle F \\rangle = \\exp(-\\lambda) \\cdot \\exp(\\nu\\lambda) = \\exp(\\nu\\lambda - \\lambda) = \\exp(-\\lambda(1-\\nu)) $$\n现在，我们将率参数的定义 $\\lambda = L\\mu$ 代回这个功能性蛋白质平均比例的表达式中。\n$$ \\langle F \\rangle = \\exp(-L\\mu(1-\\nu)) $$\n避免错误灾变的条件是，这个平均比例必须大于或等于临界阈值 $f_c$。\n$$ \\langle F \\rangle \\ge f_c $$\n$$ \\exp(-L\\mu(1-\\nu)) \\ge f_c $$\n最大可容忍突变率 $\\mu^{\\ast}$ 是使此不等式变为等式时的 $\\mu$ 值。这代表了可持续性的边界。\n$$ \\exp(-L\\mu^{\\ast}(1-\\nu)) = f_c $$\n为了解出 $\\mu^{\\ast}$，我们对等式两边取自然对数。\n$$ \\ln(\\exp(-L\\mu^{\\ast}(1-\\nu))) = \\ln(f_c) $$\n$$ -L\\mu^{\\ast}(1-\\nu) = \\ln(f_c) $$\n最后，我们分离出 $\\mu^{\\ast}$。由于 $f_c \\in (0,1)$，我们有 $\\ln(f_c)  0$。同时，$L > 0$ 且 $1-\\nu \\ge 0$。假设 $\\nu \\neq 1$（如果 $\\nu=1$，则所有蛋白质无论突变如何都具有功能，此时 $\\mu^{\\ast}$ 未定义或为无穷大），我们可以两边除以 $-L(1-\\nu)$。\n$$ \\mu^{\\ast} = \\frac{\\ln(f_c)}{-L(1-\\nu)} $$\n$$ \\mu^{\\ast} = -\\frac{\\ln(f_c)}{L(1-\\nu)} $$\n该表达式给出了每核苷酸每代的最大突变率，表示为基因长度 $L$、替换的中性程度 $\\nu$ 和临界功能阈值 $f_c$ 的函数。", "answer": "$$ \\boxed{-\\frac{\\ln(f_c)}{L(1-\\nu)}} $$", "id": "3355105"}]}