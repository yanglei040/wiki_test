{"hands_on_practices": [{"introduction": "系统生物学依赖于数学模型，但一个模型的价值在于其参数是否能从实验数据中被可靠地确定。此练习直击参数可识别性这一核心概念，要求你从一个基本的一阶衰减模型入手，通过第一性原理推导参数敏感性与费雪信息。这项实践将让你掌握连接理论模型和实验数据的关键技能，学会如何定量评估噪声数据中包含的关于模型参数的信息量。[@problem_id:3353994]", "problem": "一个单室生物系统表现出某分子种类浓度的一阶衰减，其模型为常微分方程 $\\dot{x}(t) = -k x(t)$，其中 $x(t)$ 表示时间 $t$ 时的浓度，$k > 0$ 是一个未知的速率常数。初始条件 $x(0) = x_0$ 已知且为正。在 $N$ 个时间点 $\\{t_i\\}_{i=1}^{N}$（其中 $t_i \\geq 0$）收集实验测量值，得到观测值 $y(t_i) = x(t_i) + \\epsilon_i$，其中测量噪声 $\\epsilon_i$ 独立同分布于均值为零、方差为 $\\sigma^2$ 的高斯分布。仅使用动力系统和统计估计的基本定义与原理，不借助任何快捷公式，完成以下任务：\n1. 从模型及其解出发，推导局部参数灵敏度 $s(t) = \\frac{\\partial x(t)}{\\partial k}$。\n2. 对于这组有限的含噪样本，在高斯采样模型下，推导参数 $k$ 的费雪信息 (FI)，并用 $x_0$、$\\sigma^2$、$k$ 和采样时间 $\\{t_i\\}_{i=1}^{N}$ 表示。使用独立高斯观测的似然定义，以及将对数似然的负海森矩阵期望与 FI 联系起来的标准信息恒等式。\n3. 使用你推导出的 FI 表达式，阐明在什么条件下可以从给定的有限含噪样本中实践上辨识出 $k$。根据 FI 的正定性解释你的结论。\n\n将你的最终答案以单行矩阵的形式给出，该矩阵包含灵敏度 $s(t)$ 和参数 $k$ 的费雪信息这两个解析表达式。最终答案中不要包含单位。无需进行数值四舍五入。所有数学实体均使用标准 LaTeX 符号表示。", "solution": "在尝试求解之前，对问题陈述进行严格验证。\n\n### 第 1 步：提取已知条件\n-   **模型方程**：某分子种类的浓度 $x(t)$ 由常微分方程 (ODE) $\\dot{x}(t) = -k x(t)$ 控制。\n-   **速率常数**：$k > 0$ 是一个未知常数。\n-   **初始条件**：初始浓度为 $x(0) = x_0$，其中 $x_0 > 0$。\n-   **测量数据**：在时间点 $\\{t_i\\}_{i=1}^{N}$（其中 $t_i \\geq 0$）收集到一组 $N$ 个观测值 $\\{y(t_i)\\}_{i=1}^{N}$。\n-   **观测模型**：每个观测值由 $y(t_i) = x(t_i) + \\epsilon_i$ 给出。\n-   **噪声模型**：测量误差 $\\epsilon_i$ 是独立同分布 (i.i.d.) 的随机变量，服从均值为零、方差为 $\\sigma^2$ 的高斯分布，记为 $\\epsilon_i \\sim \\mathcal{N}(0, \\sigma^2)$。\n-   **任务 1**：推导局部参数灵敏度 $s(t) = \\frac{\\partial x(t)}{\\partial k}$。\n-   **任务 2**：推导参数 $k$ 的费雪信息 (FI)。\n-   **任务 3**：阐明 $k$ 的实践可辨识性条件。\n\n### 第 2 步：使用提取的已知条件进行验证\n评估问题的有效性。\n-   **科学依据**：模型 $\\dot{x}(t) = -k x(t)$ 描述了一阶衰减，这是化学、物理和生物学等众多科学领域中的一个基本过程。用于参数估计的统计框架，涉及高斯噪声、似然函数和费雪信息，是标准的，并在数理统计学中得到了严格的建立。该问题具有科学合理性。\n-   **良态性**：问题定义清晰，所有必要的符号常量（$x_0$、$\\sigma^2$、$N$、$\\{t_i\\}$）均已提供。任务具体且可形式化，能够推导出唯一的解析表达式。该问题是良态的。\n-   **客观性**：问题使用精确的数学和统计语言陈述，没有歧义、主观性或观点。\n\n### 第 3 步：结论与行动\n问题被判定为**有效**，因为它具有科学依据、数学上是良态的、客观且自洽的。将提供一个完整的、有理有据的解答。\n\n### 解答推导\n解答过程首先求解定义的常微分方程，然后推导灵敏度，接着推导费雪信息，最后解释结果以确定实践可辨识性的条件。\n\n**0. 控制性常微分方程的求解**\n\n模型是线性一阶常微分方程：\n$$\n\\frac{dx}{dt} = -k x(t)\n$$\n这是一个可分离变量方程。我们可以将其重排为：\n$$\n\\frac{1}{x} dx = -k dt\n$$\n对两边从初始状态 $(x_0, 0)$ 到一般状态 $(x(t), t)$ 进行积分：\n$$\n\\int_{x_0}^{x(t)} \\frac{1}{x'} dx' = \\int_{0}^{t} -k dt'\n$$\n$$\n[\\ln|x'|]_{x_0}^{x(t)} = [-kt']_{0}^{t}\n$$\n由于 $x_0 > 0$ 且系统描述的是衰减过程，对于所有有限的 $t$，$x(t)$ 将保持为正。因此，我们可以去掉绝对值符号。\n$$\n\\ln(x(t)) - \\ln(x_0) = -kt\n$$\n$$\n\\ln\\left(\\frac{x(t)}{x_0}\\right) = -kt\n$$\n对两边取指数，得到浓度 $x(t)$ 的解：\n$$\nx(t) = x_0 \\exp(-kt)\n$$\n\n**1. 参数灵敏度 $s(t)$ 的推导**\n\n局部参数灵敏度 $s(t)$ 定义为状态变量 $x(t)$ 对参数 $k$ 的偏导数。\n$$\ns(t) = \\frac{\\partial x(t)}{\\partial k}\n$$\n使用上面推导出的解 $x(t) = x_0 \\exp(-kt)$，我们对 $k$ 求导，将 $x_0$ 和 $t$ 视为常数。应用链式法则求导：\n$$\ns(t) = \\frac{\\partial}{\\partial k} \\left( x_0 \\exp(-kt) \\right) = x_0 \\cdot \\frac{\\partial}{\\partial k} \\left( \\exp(-kt) \\right)\n$$\n$$\ns(t) = x_0 \\cdot \\exp(-kt) \\cdot \\frac{\\partial}{\\partial k}(-kt)\n$$\n$$\ns(t) = x_0 \\exp(-kt) (-t)\n$$\n$$\ns(t) = -t x_0 \\exp(-kt)\n$$\n这就是浓度 $x(t)$ 对速率常数 $k$ 变化的灵敏度表达式。\n\n**2. 参数 $k$ 的费雪信息 (FI) 的推导**\n\n一个参数的费雪信息量化了一组可观测随机变量所携带的关于该参数的信息量。我们将从对数似然函数推导它。\n\n在时间 $t_i$ 的观测值为 $y(t_i) = x(t_i) + \\epsilon_i$，其中 $\\epsilon_i \\sim \\mathcal{N}(0, \\sigma^2)$。这意味着每次观测 $y_i \\equiv y(t_i)$ 都是一个从均值为 $\\mu_i = x(t_i; k) = x_0 \\exp(-kt_i)$、方差为 $\\sigma^2$ 的高斯分布中抽取的随机变量。单个观测值 $y_i$ 的概率密度函数 (PDF) 为：\n$$\np(y_i | k) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left( -\\frac{(y_i - x_0 \\exp(-kt_i))^2}{2\\sigma^2} \\right)\n$$\n由于噪声项 $\\epsilon_i$ 是独立的，观测值 $y_i$ 也是独立的。整个 $N$ 个观测值集合的似然函数 $L(k)$ 是各个 PDF 的乘积：\n$$\nL(k) = \\prod_{i=1}^{N} p(y_i | k) = \\left(\\frac{1}{2\\pi\\sigma^2}\\right)^{N/2} \\exp\\left( -\\frac{1}{2\\sigma^2} \\sum_{i=1}^{N} (y_i - x_0 \\exp(-kt_i))^2 \\right)\n$$\n对数似然函数 $\\mathcal{L}(k) = \\ln(L(k))$ 是：\n$$\n\\mathcal{L}(k) = -\\frac{N}{2}\\ln(2\\pi\\sigma^2) - \\frac{1}{2\\sigma^2} \\sum_{i=1}^{N} (y_i - x_0 \\exp(-kt_i))^2\n$$\n费雪信息 $FI(k)$ 定义为对数似然函数关于参数 $k$ 的二阶导数的期望值的负数：\n$$\nFI(k) = -E\\left[ \\frac{\\partial^2 \\mathcal{L}(k)}{\\partial k^2} \\right]\n$$\n首先，我们计算一阶导数（得分函数）：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial k} = -\\frac{1}{2\\sigma^2} \\sum_{i=1}^{N} 2(y_i - x_0 \\exp(-kt_i)) \\cdot \\left(-\\frac{\\partial}{\\partial k}(x_0 \\exp(-kt_i))\\right)\n$$\n注意到 $\\frac{\\partial}{\\partial k}(x_0 \\exp(-kt_i)) = s(t_i)$，我们得到：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial k} = \\frac{1}{\\sigma^2} \\sum_{i=1}^{N} (y_i - x_0 \\exp(-kt_i)) \\cdot s(t_i)\n$$\n接下来，我们使用乘积法则对得分函数关于 $k$ 求导，计算二阶导数：\n$$\n\\frac{\\partial^2 \\mathcal{L}}{\\partial k^2} = \\frac{1}{\\sigma^2} \\sum_{i=1}^{N} \\frac{\\partial}{\\partial k} \\left[ (y_i - x_0 \\exp(-kt_i)) \\cdot s(t_i) \\right]\n$$\n$$\n\\frac{\\partial^2 \\mathcal{L}}{\\partial k^2} = \\frac{1}{\\sigma^2} \\sum_{i=1}^{N} \\left[ \\left(\\frac{\\partial}{\\partial k}(y_i - x_0 \\exp(-kt_i))\\right) s(t_i) + (y_i - x_0 \\exp(-kt_i)) \\frac{\\partial s(t_i)}{\\partial k} \\right]\n$$\n方括号中的第一项有 $\\frac{\\partial}{\\partial k}(y_i - x_0 \\exp(-kt_i)) = -s(t_i)$。所以求和的第一部分变为 $-s(t_i)^2$。\n$$\n\\frac{\\partial^2 \\mathcal{L}}{\\partial k^2} = \\frac{1}{\\sigma^2} \\sum_{i=1}^{N} \\left[ -s(t_i)^2 + (y_i - x_0 \\exp(-kt_i)) \\frac{\\partial s(t_i)}{\\partial k} \\right]\n$$\n现在我们计算期望。期望是关于数据 $y_i$ 的分布来计算的。\n$$\nFI(k) = -E\\left[ \\frac{\\partial^2 \\mathcal{L}}{\\partial k^2} \\right] = -E\\left[ \\frac{1}{\\sigma^2} \\sum_{i=1}^{N} \\left( -s(t_i)^2 + (y_i - x_0 \\exp(-kt_i)) \\frac{\\partial s(t_i)}{\\partial k} \\right) \\right]\n$$\n根据期望的线性性质：\n$$\nFI(k) = -\\frac{1}{\\sigma^2} \\sum_{i=1}^{N} E\\left[ -s(t_i)^2 + (y_i - x_0 \\exp(-kt_i)) \\frac{\\partial s(t_i)}{\\partial k} \\right]\n$$\n项 $s(t_i)^2$ 和 $\\frac{\\partial s(t_i)}{\\partial k}$ 是 $k$ 和 $t_i$ 的确定性函数；它们不是随机的。唯一的随机变量是 $y_i$。我们注意到 $E[y_i - x_0 \\exp(-kt_i)] = E[\\epsilon_i] = 0$。因此，求和中第二项的期望为零。\n$$\nE\\left[ (y_i - x_0 \\exp(-kt_i)) \\frac{\\partial s(t_i)}{\\partial k} \\right] = E[y_i - x_0 \\exp(-kt_i)] \\cdot \\frac{\\partial s(t_i)}{\\partial k} = 0\n$$\n这极大地简化了 $FI(k)$ 的表达式：\n$$\nFI(k) = -\\frac{1}{\\sigma^2} \\sum_{i=1}^{N} E[-s(t_i)^2] = \\frac{1}{\\sigma^2} \\sum_{i=1}^{N} s(t_i)^2\n$$\n对于加性独立同分布高斯噪声，这是一个通用结果：费雪信息是灵敏度平方和除以方差。\n代入我们的表达式 $s(t_i) = -t_i x_0 \\exp(-kt_i)$:\n$$\nFI(k) = \\frac{1}{\\sigma^2} \\sum_{i=1}^{N} (-t_i x_0 \\exp(-kt_i))^2\n$$\n$$\nFI(k) = \\frac{1}{\\sigma^2} \\sum_{i=1}^{N} t_i^2 x_0^2 \\exp(-2kt_i)\n$$\n将常数因子提出，得到费雪信息的最终表达式：\n$$\nFI(k) = \\frac{x_0^2}{\\sigma^2} \\sum_{i=1}^{N} t_i^2 \\exp(-2kt_i)\n$$\n\n**3. 实践可辨识性的条件**\n\n如果一个参数可以从有限的含噪数据集中以有限的不确定性进行估计，则该参数是实践上可辨识的。克拉默-拉奥下界 (CRLB) 指出，任何无偏估计量 $\\hat{k}$ 的方差都受限于费雪信息的倒数：$\\text{Var}(\\hat{k}) \\geq [FI(k)]^{-1}$。\n\n要使方差有限，CRLB 必须是有限且为正的。这要求费雪信息 $FI(k)$ 是严格为正且有限的。我们来分析我们的表达式：\n$$\nFI(k) = \\frac{x_0^2}{\\sigma^2} \\sum_{i=1}^{N} t_i^2 \\exp(-2kt_i)\n$$\n已知 $x_0 > 0$ 且方差 $\\sigma^2 > 0$，所以前置因子 $\\frac{x_0^2}{\\sigma^2}$ 是严格为正的。因此，信息内容由求和项决定。\n求和中的每一项形式为 $t_i^2 \\exp(-2kt_i)$。已知 $k > 0$ 和 $t_i \\geq 0$，指数项 $\\exp(-2kt_i)$ 总是正的。项 $t_i^2$ 是非负的。因此，求和中的每一项都是非负的。\n总和为零当且仅当每一项都为零。一项 $t_i^2 \\exp(-2kt_i)$ 为零当且仅当 $t_i = 0$。\n因此，$FI(k) = 0$ 当且仅当所有采样时间 $t_i$ 都等于 $0$。如果所有测量都在 $t=0$ 时进行，我们只能观测到初始状态 $x_0$，而无法获得关于由 $k$ 控制的动力学的任何信息。在这种情况下，CRLB 是无限的，参数 $k$ 在实践上是不可辨识的。\n\n**关于可辨识性的结论**：参数 $k$ 在实践上可辨识，当且仅当至少有一次测量是在时间 $t_i > 0$ 时进行的。", "answer": "$$\n\\boxed{\\begin{pmatrix} -t x_0 \\exp(-kt) & \\frac{x_0^2}{\\sigma^2} \\sum_{i=1}^{N} t_i^2 \\exp(-2kt_i) \\end{pmatrix}}\n$$", "id": "3353994"}, {"introduction": "一个参数化的模型建立后，我们便可以分析其动态行为，以理解系统层级的“涌现”特性（如生物开关）是如何产生的。本练习将引导你探索一个常见的调控模块——自激活基因回路与分子伴侣的化学计量隔离——如何共同作用产生双稳态。通过运用零斜线分析与分岔理论，你将推导出这一系统“翻转”所需的临界条件，从而深入理解细胞决策背后的非线性动力学原理。[@problem_id:3353977]", "problem": "考虑一个自激活转录因子 $X$，它被一个结合伴侣 $S$ 以化学计量的关系封存，通过解离常数为 $K_{d}$ 的快速可逆结合形成一个非活性复合物 $C$。设 $x$ 表示 $X$ 的总浓度，$S_{T}$ 表示 $S$ 的总浓度。在快速平衡条件下，游离浓度满足质量作用定律和守恒定律：$X_{f} + C = x$，$S_{f} + C = S_{T}$ 以及 $K_{d} = X_{f} S_{f} / C$。假设 $X$ 的合成速率是一个基础项和一个正反馈项之和，其中正反馈项通过一个Hill系数为 $n=2$、半饱和常数为 $K$ 的Hill函数依赖于游离的 $X$，并且总的 $X$ 被线性降解。因此，$x$ 的动力学由一个一维常微分方程 (ODE) 控制：$dx/dt = \\alpha + \\beta\\, \\big( X_{f}^{2} / (K^{2} + X_{f}^{2}) \\big) - \\delta x$，其中 $\\alpha$、$\\beta$、$\\delta$、$K$ 和 $K_{d}$ 均为正常数。\n\n利用零斜线的几何特性（曲线 $dx/dt = 0$ 的交点），推导与封存驱动的双稳态相关的鞍结分岔条件，要求鞍结分岔发生在Hill中点 $X_{f} = K$ 处，并且在该点零斜线与水平轴相切（即，在同一点 $x$ 上，$dx/dt = 0$ 和 $\\frac{d}{dx}(\\frac{dx}{dt}) = 0$ 同时成立）。然后，以 $\\beta$、$\\delta$、$K$ 和 $K_{d}$ 的闭合形式，显式求解发生此鞍结分岔时的临界总封存剂浓度 $S_{T}^{\\ast}$。将 $S_{T}^{\\ast}$ 的最终答案表示为单个解析表达式。不需要四舍五入，最终表达式中不应包含单位。\n\n除了计算之外，您的推导必须从基本的质量作用结合和守恒定律开始，并且必须解释为什么封存会改变零斜线的斜率，以及化学计量约束如何塑造开关的陡峭程度。您不得使用任何跳过这些步骤的简化公式。", "solution": "题目要求推导在基因开关经历鞍结分岔时封存剂的临界浓度 $S_{T}^{\\ast}$。推导必须基于基本原理，并包括对封存作用的解释。\n\n首先，我们建立转录因子总浓度 $x$ 与其游离的活性浓度 $X_f$ 之间的关系。该关系由与封存剂 $S$ 的快速平衡结合所决定。给定的守恒定律和质量作用定律是：\n1.  蛋白质 $X$ 的守恒：$x = X_{f} + C$\n2.  封存剂 $S$ 的守恒：$S_{T} = S_{f} + C$\n3.  质量作用平衡：$K_{d} = \\frac{X_{f} S_{f}}{C}$\n\n从(1)可知，复合物的浓度为 $C = x - X_{f}$。\n从(2)可知，游离封存剂的浓度为 $S_{f} = S_{T} - C$。\n将这些代入(3)：\n$$K_{d} = \\frac{X_{f} (S_{T} - C)}{C}$$\n$$K_{d}C = X_{f}S_{T} - X_{f}C$$\n$$C(K_{d} + X_{f}) = X_{f}S_{T}$$\n这就得出了以游离转录因子 $X_{f}$ 表示的复合物浓度：\n$$C = \\frac{X_{f} S_{T}}{K_{d} + X_{f}}$$\n将这个 $C$ 的表达式代回 $X$ 的守恒方程(1)，我们得到总浓度 $x$ 作为游离浓度 $X_{f}$ 的函数：\n$$x(X_{f}) = X_{f} + C = X_{f} + \\frac{S_{T} X_{f}}{K_{d} + X_{f}}$$\n这个方程定义了一个化学计量约束。对于给定的总封存剂量 $S_T$，它决定了总蛋白 $x$ 如何在其游离形式 $X_f$ 和其被封存形式 $C$ 之间分配。\n\n系统的动力学由关于总浓度 $x$ 的常微分方程 (ODE) 给出：\n$$\\frac{dx}{dt} = \\alpha + \\beta \\frac{X_{f}^{2}}{K^{2} + X_{f}^{2}} - \\delta x$$\n系统的稳态（或不动点）可通过设置 $\\frac{dx}{dt} = 0$ 找到，这定义了零斜线：\n$$\\delta x_{ss} = \\alpha + \\beta \\frac{X_{f}^{2}}{K^{2} + X_{f}^{2}}$$\n此处，$x_{ss}$ 表示 $x$ 的稳态值。系统的稳态由化学计量约束曲线 $x(X_f)$ 和零斜线曲线的交点确定。\n\n鞍结分岔标志着稳态的出现或消失。在几何上，它对应于约束曲线和零斜线之间的切点。在解析上，对于以 $x$ 表示的一维系统，这个相切条件等价于要求 $\\frac{dx}{dt} = 0$ 和 $\\frac{d}{dx}\\left(\\frac{dx}{dt}\\right) = 0$ 同时成立。\n\n让我们计算导数 $\\frac{d}{dx}\\left(\\frac{dx}{dt}\\right)$：\n$$\\frac{d}{dx}\\left(\\frac{dx}{dt}\\right) = \\frac{d}{dx}\\left( \\alpha + \\beta \\frac{X_{f}^{2}}{K^{2} + X_{f}^{2}} - \\delta x \\right) = \\beta \\frac{d}{dx}\\left(\\frac{X_{f}^{2}}{K^{2} + X_{f}^{2}}\\right) - \\delta$$\n为了计算这个导数，我们使用链式法则，因为 $X_f$ 是 $x$ 的函数：$\\frac{d}{dx} = \\frac{dX_{f}}{dx} \\frac{d}{dX_{f}}$。\n$$\\frac{d}{dx}\\left(\\frac{dx}{dt}\\right) = \\beta \\left( \\frac{d}{dX_{f}}\\left(\\frac{X_{f}^{2}}{K^{2} + X_{f}^{2}}\\right) \\right) \\frac{dX_{f}}{dx} - \\delta = 0$$\nHill函数项的导数是：\n$$\\frac{d}{dX_{f}}\\left(\\frac{X_{f}^{2}}{K^{2} + X_{f}^{2}}\\right) = \\frac{2X_{f}(K^{2} + X_{f}^{2}) - X_{f}^{2}(2X_{f})}{(K^{2} + X_{f}^{2})^{2}} = \\frac{2X_{f}K^{2}}{(K^{2} + X_{f}^{2})^{2}}$$\n项 $\\frac{dX_f}{dx}$ 概括了封存效应。我们通过先从化学计量约束 $x(X_f)$ 计算其倒数 $\\frac{dx}{dX_f}$ 来找到它：\n$$\\frac{dx}{dX_{f}} = \\frac{d}{dX_{f}}\\left(X_{f} + \\frac{S_{T} X_{f}}{K_{d} + X_{f}}\\right) = 1 + \\frac{S_{T}(K_{d} + X_{f}) - S_{T}X_{f}(1)}{(K_{d} + X_{f})^{2}} = 1 + \\frac{S_{T}K_{d}}{(K_{d} + X_{f})^{2}}$$\n这个量 $\\frac{dx}{dX_f}$ 代表了响应的“刚度”。当 $S_T > 0$ 时，我们有 $\\frac{dx}{dX_f} > 1$。这意味着总蛋白 $x$ 的变化被封存剂缓冲，导致游离蛋白 $X_f$ 的变化较小。这种缓冲效应（其中 $\\frac{dX_f}{dx}  1$）降低了正反馈回路的有效增益。对于较大的 $S_T$ 值，$x(X_f)$ 曲线的斜率增加，可以压缩响应，从而有助于提高开关的陡峭程度（sharpness）。\n\n因此，相切条件 $\\frac{d}{dx}(\\frac{dx}{dt}) = 0$ 为：\n$$\\beta \\left( \\frac{2X_{f}K^{2}}{(K^{2} + X_{f}^{2})^{2}} \\right) \\left( 1 + \\frac{S_{T}K_{d}}{(K_{d} + X_{f})^{2}} \\right)^{-1} - \\delta = 0$$\n重新整理得到鞍结分岔的一般条件：\n$$\\frac{\\beta}{\\delta} \\frac{2X_{f}K^{2}}{(K^{2} + X_{f}^{2})^{2}} = 1 + \\frac{S_{T}K_{d}}{(K_{d} + X_{f})^{2}}$$\n题目指明该分岔发生在Hill中点，即 $X_{f} = K$ 处。我们将 $X_{f}=K$ 和相应的临界封存剂浓度 $S_{T} = S_{T}^{\\ast}$ 代入此相切条件：\n$$\\frac{\\beta}{\\delta} \\frac{2K \\cdot K^{2}}{(K^{2} + K^{2})^{2}} = 1 + \\frac{S_{T}^{\\ast}K_{d}}{(K_{d} + K)^{2}}$$\n$$\\frac{\\beta}{\\delta} \\frac{2K^{3}}{(2K^{2})^{2}} = 1 + \\frac{S_{T}^{\\ast}K_{d}}{(K_{d} + K)^{2}}$$\n$$\\frac{\\beta}{\\delta} \\frac{2K^{3}}{4K^{4}} = 1 + \\frac{S_{T}^{\\ast}K_{d}}{(K_{d} + K)^{2}}$$\n$$\\frac{\\beta}{2\\delta K} = 1 + \\frac{S_{T}^{\\ast}K_{d}}{(K_{d} + K)^{2}}$$\n这个方程为求解 $S_{T}^{\\ast}$ 提供了一条直接的路径。请注意，题目还暗示了零斜线条件 $\\frac{dx}{dt}=0$ 在此点也得到满足，这将用于确定基础合成速率 $\\alpha$ 的必要值。然而，如此处所示，仅凭在指定点 $X_f=K$ 处评估的相切条件，就足以按照要求用其他参数来确定 $S_{T}^{\\ast}$。\n\n求解 $S_{T}^{\\ast}$：\n$$\\frac{S_{T}^{\\ast}K_{d}}{(K_{d} + K)^{2}} = \\frac{\\beta}{2\\delta K} - 1$$\n$$S_{T}^{\\ast} = \\frac{(K_{d} + K)^{2}}{K_{d}} \\left( \\frac{\\beta}{2\\delta K} - 1 \\right)$$\n为使 $S_T^*$ 是一个正的、物理上存在的浓度，要求 $\\frac{\\beta}{2\\delta K} > 1$，即 $\\beta > 2\\delta K$。这表明，要在Hill中点发生这种由封存调节的分岔，反馈强度必须超过某个阈值。\n临界总封存剂浓度的最终表达式为：\n$$S_{T}^{\\ast} = \\frac{(K_{d} + K)^{2}}{K_{d}} \\left( \\frac{\\beta}{2\\delta K} - 1 \\right)$$", "answer": "$$\\boxed{\\frac{(K_{d} + K)^{2}}{K_{d}} \\left( \\frac{\\beta}{2\\delta K} - 1 \\right)}$$", "id": "3353977"}, {"introduction": "现代系统生物学正从分析小型网络基序转向构建整合海量“组学”数据的全基因组规模模型。这项编程实践将让你体验这一前沿领域，任务是结合机器学习与经典的生物物理约束。你将构建一个图神经网络（GNN）来初步预测代谢通量，然后通过迭代投影算法，确保最终的通量解同时满足化学计量平衡和热力学可行性这两大基本物理化学定律。[@problem_id:3354052]", "problem": "您的任务是使用简化的图神经网络 (GNN) 并强制执行生物物理可行性，来实现一个有原则的、感知约束的代谢通量预测器。该系统必须在稳态化学计量平衡和热力学方向性约束下运行，这些约束与公认的系统生物学原理一致。\n\n基本原理：\n- 在代谢稳态下，化学计量质量平衡为 $$S \\, v = 0,$$ 其中 $S \\in \\mathbb{R}^{m \\times r}$ 是化学计量矩阵，包含 $m$ 种代谢物和 $r$ 个反应，而 $v \\in \\mathbb{R}^{r}$ 是反应通量向量，单位为 mmol/(gDW·h)。\n- 反应 $j$ 的吉布斯自由能变为 $$\\Delta G_j = \\Delta G^{\\circ}_j + R T \\sum_{i=1}^{m} S_{i j} \\ln c_i,$$ 其中 $\\Delta G^{\\circ}_j$ 是标准吉布斯自由能变，单位为 kJ/mol，$R$ 是普适气体常数，单位为 kJ/(mol·K)，$T$ 是温度，单位为 K，$c_i$ 是代谢物浓度，单位为 mol/L (M)。热力学上可行的正向通量要求 $\\Delta G_j  0$（而逆向通量要求 $\\Delta G_j > 0$）。\n\n您将构建一个在代谢物-反应二分图上的单层消息传递 GNN，以生成一个无约束的通量预测 $\\hat{v}$，然后通过在热力学符号约束和化学计量矩阵的零空间上交替投影来强制执行可行性：\n1. 计算代谢物级别的特征 $x_i = \\ln c_i$。\n2. 对于反应 $j$，定义底物系数 $s^{\\mathrm{sub}}_{i j} = \\max(0, -S_{i j})$ 和产物系数 $s^{\\mathrm{prod}}_{i j} = \\max(0, S_{i j})$。设 $W^{\\mathrm{in}} \\in \\mathbb{R}^{m \\times r}$ 和 $W^{\\mathrm{out}} \\in \\mathbb{R}^{m \\times r}$ 为可训练权重，$b \\in \\mathbb{R}^{r}$ 为偏置。计算\n   $$h^{\\mathrm{in}}_j = \\sum_{i=1}^{m} s^{\\mathrm{sub}}_{i j} \\, W^{\\mathrm{in}}_{i j} \\, x_i, \\quad h^{\\mathrm{out}}_j = \\sum_{i=1}^{m} s^{\\mathrm{prod}}_{i j} \\, W^{\\mathrm{out}}_{i j} \\, x_i,$$\n   以及原始反应激活值 $$u_j = h^{\\mathrm{in}}_j - h^{\\mathrm{out}}_j + b_j。$$\n   无约束的通量预测为 $$\\hat{v}_j = v_{\\max} \\, \\tanh(u_j),$$ 其中 $v_{\\max} > 0$ 设置了一个物理上合理的通量尺度，单位为 mmol/(gDW·h)。\n3. 使用上述公式计算 $\\Delta G_j$。\n4. 应用容差为 $\\delta_G$ (单位 kJ/mol) 的热力学门控：如果 $(v_j > 0 \\wedge \\Delta G_j \\ge -\\delta_G)$ 或 $(v_j  0 \\wedge \\Delta G_j \\le \\delta_G)$，则设置 $v_j=0$；否则保持 $v_j$ 不变。\n5. 投影到 $S$ 的零空间以确保 $S v = 0$：如果 $N \\in \\mathbb{R}^{r \\times k}$ 是一个矩阵，其列构成了 $S$ 的零空间的一个标准正交基，则设置 $$v \\leftarrow N (N^{\\top} v)。$$ 如果 $k=0$（满列秩），则设置 $v \\leftarrow 0$。\n6. 交替执行步骤 4 和 5，直到收敛或达到固定的迭代预算。\n\n您的程序必须实现此过程，并评估三个涵盖典型行为、热力学边界和化学计量边缘情况的测试用例：\n\n常量：\n- 使用 $R = 8.31446261815324 \\times 10^{-3}$ kJ/(mol·K)。\n- 热力学门控使用 $\\delta_G = 10^{-3}$ kJ/mol。\n- 使用 $10^{-12}$ 的数值容差通过奇异值分解来检测零空间。\n\n测试套件：\n- 用例 1（循环，非平凡零空间）：\n  - $m=3$, $r=3$, $$S = \\begin{bmatrix} -1  0  1 \\\\ 1  -1  0 \\\\ 0  1  -1 \\end{bmatrix}.$$\n  - 浓度（单位 M）：$c = [10^{-3}, 10^{-4}, 10^{-6}]$。\n  - 温度 $T = 310$ K。\n  - 标准吉布斯自由能：$\\Delta G^{\\circ} = [-7.0, -3.0, -20.0]$ kJ/mol。\n  - 权重 $W^{\\mathrm{in}}$：\n    $$\\begin{bmatrix} 1.0  0.5  0.2 \\\\ 0.7  1.2  0.3 \\\\ 0.3  0.8  1.1 \\end{bmatrix}, \\quad W^{\\mathrm{out}} = \\begin{bmatrix} 0.2  0.1  0.2 \\\\ 0.1  0.2  0.1 \\\\ 0.05  0.3  0.2 \\end{bmatrix}, \\quad b = [0.10, 0.05, 0.08], \\quad v_{\\max} = 10.0 \\text{ mmol/(gDW·h)}.$$\n- 用例 2（反应 $2$ 处于热力学边界）：\n  - $S$, $c$, $T$, $W^{\\mathrm{in}}$, $W^{\\mathrm{out}}$, $b$, $v_{\\max}$ 与用例 1 相同。\n  - 标准吉布斯自由能：$\\Delta G^{\\circ} = [-7.0, 11.869, -20.0]$ kJ/mol。这使得在给定的 $c$ 和 $T$ 下，反应 $2$ 的 $\\Delta G_2 \\approx 0$。\n- 用例 3（满列秩，平凡零空间）：\n  - $m=3$, $r=3$, $$S = \\begin{bmatrix} -1  -1  1 \\\\ 1  0  -1 \\\\ -1  1  0 \\end{bmatrix}.$$\n  - 浓度（单位 M）：$c = [10^{-3}, 2 \\times 10^{-4}, 5 \\times 10^{-4}]$。\n  - 温度 $T = 310$ K。\n  - 标准吉布斯自由能：$\\Delta G^{\\circ} = [-7.0, -2.5, -1.0]$ kJ/mol。\n  - 权重 $W^{\\mathrm{in}}$：\n    $$\\begin{bmatrix} 0.9  0.4  0.6 \\\\ 0.5  0.7  1.1 \\\\ 0.2  0.3  0.8 \\end{bmatrix}, \\quad W^{\\mathrm{out}} = \\begin{bmatrix} 0.1  0.2  0.3 \\\\ 0.2  0.1  0.2 \\\\ 0.1  0.3  0.1 \\end{bmatrix}, \\quad b = [0.06, 0.02, 0.04], \\quad v_{\\max} = 8.0 \\text{ mmol/(gDW·h)}.$$\n\n输出规范：\n- 对于每个用例，在交替投影收敛（或达到固定的迭代预算）后，计算：\n  1. 质量平衡残差 $$\\|S v\\|_2$$，单位为 mmol/(gDW·h)。\n  2. 满足热力学符号法则的反应比例，定义为满足 $v_j = 0$ 或 $v_j \\cdot \\Delta G_j \\le -\\delta_G$ 的反应数量除以 $r$（表示为 $[0,1]$ 范围内的小数）。\n- 您的程序应生成一行输出，其中包含六个结果，格式为逗号分隔的列表并用方括号括起来，顺序为 [residual_case1,fraction_case1,residual_case2,fraction_case2,residual_case3,fraction_case3]。所有与通量相关的量必须以 mmol/(gDW·h) 为单位，比例必须是小数。", "solution": "该问题要求实现一种计算方法，用于预测与基本生物物理定律一致的代谢通量。该方法是一个两阶段过程：首先，使用简化的图神经网络 (GNN) 生成初始通量预测；其次，通过迭代过程对此预测进行精炼，以强制执行化学计量和热力学约束。这种基于原则的方法确保最终的通量向量在物理上和生物学上都是合理的。整个过程将使用三个不同的测试用例进行验证。\n\n基本原理是稳态下的化学计量质量平衡（由线性系统 $S v = 0$ 给出）和源自吉布斯自由能变的热力学方向性约束（对于正向通量 $v_j > 0$ 要求 $\\Delta G_j  0$）。这里，$S \\in \\mathbb{R}^{m \\times r}$ 是一个包含 $m$ 种代谢物和 $r$ 个反应的系统的化学计量矩阵，$v \\in \\mathbb{R}^{r}$ 是反应通量向量。\n\n该过程如下：\n\n首先，预测一个初始的、无约束的通量向量 $\\hat{v}$。该预测基于一个在代谢物和反应的二分图上定义的单层消息传递 GNN 模型。模型的输入特征是代谢物浓度的对数，即 $x_i = \\ln c_i$。GNN 根据其底物和产物的特征为每个反应 $j$ 计算一个激活值 $u_j$。底物和产物的化学计量通过定义 $s^{\\mathrm{sub}}_{i j} = \\max(0, -S_{i j})$ 和 $s^{\\mathrm{prod}}_{i j} = \\max(0, S_{i j})$ 来分离。然后，GNN 层的变换为：\n$$h^{\\mathrm{in}}_j = \\sum_{i=1}^{m} s^{\\mathrm{sub}}_{i j} \\, W^{\\mathrm{in}}_{i j} \\, x_i$$\n$$h^{\\mathrm{out}}_j = \\sum_{i=1}^{m} s^{\\mathrm{prod}}_{i j} \\, W^{\\mathrm{out}}_{i j} \\, x_i$$\n其中 $W^{\\mathrm{in}}$ 和 $W^{\\mathrm{out}}$ 是可训练的权重矩阵。反应 $j$ 的净激活值为 $u_j = h^{\\mathrm{in}}_j - h^{\\mathrm{out}}_j + b_j$，其中 $b_j$ 是一个偏置项。此激活值通过双曲正切函数转换为初始通量预测 $\\hat{v}_j$，并由一个最大合理通量 $v_{\\max}$ 进行缩放：\n$$\\hat{v}_j = v_{\\max} \\, \\tanh(u_j)$$\n\n其次，使用一种称为交替投影的迭代方法对这个初始预测 $\\hat{v}$ 进行精炼，以满足生物物理约束。将通量向量初始化为 $v = \\hat{v}$，然后在固定次数的迭代中，反复对其进行两个类似投影的步骤。\n\n第一步强制执行热力学可行性。每个反应的吉布斯自由能变 $\\Delta G_j$ 根据标准吉布斯能量 $\\Delta G^{\\circ}_j$、温度 $T$、气体常数 $R$ 和代谢物浓度 $c_i$ 计算得出：\n$$\\Delta G_j = \\Delta G^{\\circ}_j + R T \\sum_{i=1}^{m} S_{i j} \\ln c_i$$\n如果一个通量 $v_j$ 的方向与热力学驱动力相反（即，与正的 $\\Delta G_j$ 方向相反，或逆向通量与负的 $\\Delta G_j$ 方向相反），则该通量在热力学上是不可行的。一个“门控”操作通过将任何此类不可行通量设置为零来强制执行此约束。使用一个小的容差 $\\delta_G$ 来处理接近平衡的反应：如果 $(v_j > 0 \\land \\Delta G_j \\ge -\\delta_G)$ 或 $(v_j  0 \\land \\Delta G_j \\le \\delta_G)$，则将 $v_j$ 设置为 $0$。\n\n第二步强制执行稳态质量平衡条件 $S v = 0$。这要求通量向量 $v$ 位于化学计量矩阵 $S$ 的零空间中。通过将当前的通量向量 $v$ 投影到该零空间上来强制执行此约束。首先计算零空间的一个标准正交基，通常通过对 $S$ 进行奇异值分解 (SVD) 来实现。如果矩阵 $N \\in \\mathbb{R}^{r \\times k}$ 的列构成了这样一个基（其中 $k = \\dim(\\text{null}(S))$），则投影算子为 $P = N N^{\\top}$。然后通量向量更新为 $v \\leftarrow P v$。在 $S$ 具有满列秩的特殊情况下，其零空间是平凡的（仅包含零向量），投影正确地将任何向量映射到 $v = 0$。\n\n这两个步骤——热力学门控和零空间投影——交替应用。经过固定次数的迭代后，得到的向量 $v$ 是一个同时满足代谢系统化学计量和热力学约束的通量分布。\n\n最后，使用两个指标评估所得通量向量 $v$ 的质量：质量平衡残差的欧几里得范数 $\\|S v\\|_2$（应接近于零），以及满足热力学符号法则的反应比例，该比例定义为满足 $v_j = 0$ 或条件 $v_j \\cdot \\Delta G_j \\le -\\delta_G$ 的反应所占的比例。此过程将系统地应用于所有指定的测试用例。", "answer": "```python\nimport numpy as np\nfrom scipy.linalg import null_space\n\ndef solve():\n    \"\"\"\n    Implements a GNN-based flux predictor with biophysical constraint enforcement\n    and evaluates it on three test cases.\n    \"\"\"\n\n    # Define universal constants\n    R_CONST = 8.31446261815324e-3  # Universal gas constant in kJ/(mol·K)\n    DELTA_G_TOLERANCE = 1e-3  # Thermodynamic gating tolerance in kJ/mol\n    SVD_TOLERANCE = 1e-12  # Tolerance for nullspace computation\n    ITERATION_BUDGET = 100  # Fixed iteration budget for alternating projections\n\n    test_cases = [\n        {\n            \"name\": \"Case 1 (cycle, nontrivial nullspace)\",\n            \"S\": np.array([[-1.0, 0.0, 1.0], [1.0, -1.0, 0.0], [0.0, 1.0, -1.0]]),\n            \"c\": np.array([1e-3, 1e-4, 1e-6]),\n            \"T\": 310.0,\n            \"dG_standard\": np.array([-7.0, -3.0, -20.0]),\n            \"W_in\": np.array([[1.0, 0.5, 0.2], [0.7, 1.2, 0.3], [0.3, 0.8, 1.1]]),\n            \"W_out\": np.array([[0.2, 0.1, 0.2], [0.1, 0.2, 0.1], [0.05, 0.3, 0.2]]),\n            \"b\": np.array([0.10, 0.05, 0.08]),\n            \"v_max\": 10.0,\n        },\n        {\n            \"name\": \"Case 2 (boundary thermodynamics)\",\n            \"S\": np.array([[-1.0, 0.0, 1.0], [1.0, -1.0, 0.0], [0.0, 1.0, -1.0]]),\n            \"c\": np.array([1e-3, 1e-4, 1e-6]),\n            \"T\": 310.0,\n            \"dG_standard\": np.array([-7.0, 11.869, -20.0]),\n            \"W_in\": np.array([[1.0, 0.5, 0.2], [0.7, 1.2, 0.3], [0.3, 0.8, 1.1]]),\n            \"W_out\": np.array([[0.2, 0.1, 0.2], [0.1, 0.2, 0.1], [0.05, 0.3, 0.2]]),\n            \"b\": np.array([0.10, 0.05, 0.08]),\n            \"v_max\": 10.0,\n        },\n        {\n            \"name\": \"Case 3 (full column rank, trivial nullspace)\",\n            \"S\": np.array([[-1.0, -1.0, 1.0], [1.0, 0.0, -1.0], [-1.0, 1.0, 0.0]]),\n            \"c\": np.array([1e-3, 2e-4, 5e-4]),\n            \"T\": 310.0,\n            \"dG_standard\": np.array([-7.0, -2.5, -1.0]),\n            \"W_in\": np.array([[0.9, 0.4, 0.6], [0.5, 0.7, 1.1], [0.2, 0.3, 0.8]]),\n            \"W_out\": np.array([[0.1, 0.2, 0.3], [0.2, 0.1, 0.2], [0.1, 0.3, 0.1]]),\n            \"b\": np.array([0.06, 0.02, 0.04]),\n            \"v_max\": 8.0,\n        },\n    ]\n\n    results = []\n\n    for case in test_cases:\n        S, c, T, dG_standard = case[\"S\"], case[\"c\"], case[\"T\"], case[\"dG_standard\"]\n        W_in, W_out, b, v_max = case[\"W_in\"], case[\"W_out\"], case[\"b\"], case[\"v_max\"]\n        \n        m, r = S.shape\n\n        # Step 1: Compute metabolite-level features\n        x = np.log(c)\n\n        # Step 2: Compute GNN unconstrained flux prediction\n        s_sub = np.maximum(0, -S)\n        s_prod = np.maximum(0, S)\n        \n        h_in = (s_sub * W_in).T @ x\n        h_out = (s_prod * W_out).T @ x\n        \n        u = h_in - h_out + b\n        v_hat = v_max * np.tanh(u)\n\n        # Step 3: Compute Gibbs free energy change for each reaction\n        delta_G = dG_standard + R_CONST * T * (S.T @ x)\n\n        # Pre-compute nullspace projection matrix for Step 5\n        N = null_space(S, rcond=SVD_TOLERANCE)\n        # If nullspace is trivial (k=0), N has shape (r, 0), and P becomes a zero matrix.\n        if N.shape[1] == 0:\n            P = np.zeros((r, r))\n        else:\n            P = N @ N.T\n\n        # Steps 4, 5, 6: Alternate projections\n        v = v_hat.copy()\n        for _ in range(ITERATION_BUDGET):\n            # Step 4: Thermodynamic gating\n            v_gated = v.copy()\n            \n            mask_pos_violation = (v > 0)  (delta_G >= -DELTA_G_TOLERANCE)\n            mask_neg_violation = (v  0)  (delta_G = DELTA_G_TOLERANCE)\n            \n            v_gated[mask_pos_violation | mask_neg_violation] = 0.0\n            \n            # Step 5: Project onto the nullspace of S\n            v = P @ v_gated\n\n        # --- Output Calculation ---\n        # 1. Mass-balance residual\n        residual = np.linalg.norm(S @ v)\n        results.append(residual)\n\n        # 2. Fraction of reactions satisfying the thermodynamic sign rule\n        # A reaction is satisfied if flux is zero or if v_j * dG_j = -delta_G_tol\n        # `atol` is used for robust floating point comparison to zero\n        zero_flux_mask = np.isclose(v, 0, atol=1e-9)\n        thermo_rule_mask = (v * delta_G) = -DELTA_G_TOLERANCE\n        \n        satisfied_reaction_count = np.sum(zero_flux_mask | thermo_rule_mask)\n        fraction_thermo_satisfied = satisfied_reaction_count / r\n        results.append(fraction_thermo_satisfied)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3354052"}]}