## 引言
在后基因组时代，从定性描述走向定量预测是现代生物学研究的核心转变。构建能够精确捕捉[生物过程](@entry_id:164026)动态演化的数学模型，已成为理解复杂生命系统、指导实验设计和推动[生物技术](@entry_id:141065)发展的关键。然而，将分散的生物学知识和组件转化为一个严谨、可验证的数学框架，面临着一个根本性挑战：我们如何系统地定义一个系统的内部状态，并将其与我们通过实验能够测量到的有限、含噪声的信号联系起来？这正是区分“[状态变量](@entry_id:138790)”与“[可观测量](@entry_id:267133)”这一核心概念的价值所在。

本文旨在为研究生和研究人员提供一个关于如何使用[状态变量](@entry_id:138790)和[可观测量](@entry_id:267133)来构建和分析动力学模型的综合指南。我们将填补从抽象理论到实际应用的知识鸿沟，系统性地阐述整个建模流程。在“**原理与机制**”一章中，我们将奠定理论基石，深入定义[状态空间表示](@entry_id:147149)法，介绍如何利用[化学计量矩阵](@entry_id:275342)从第一性原理构建模型，并探讨模型检验、[无量纲化](@entry_id:136704)、可观测性与可辨识性等关键概念。接下来，在“**应用与交叉学科联系**”一章中，我们将展示这一框架的强大威力，通过实例说明它如何应用于网络结构推断、[跨尺度](@entry_id:754544)建模以及前沿实验数据的解释。最后，“**动手实践**”部分将提供精选的计算练习，帮助您将理论知识转化为解决实际问题的能力，例如进行模型简化和稳定性分析。通过学习本章内容，您将掌握一套完整的思想和工具，从而能够更加自信地构建、分析和验证与实验数据紧密结合的动力学模型。

## 原理与机制

本章深入探讨了构建生物[系统动力学](@entry_id:136288)模型的基石：状态变量和[可观测量](@entry_id:267133)。我们将从基本定义出发，系统地阐述如何从第一性原理出发构建模型，如何检验和精炼这些模型，并最终如何将理论模型与充满噪声的实验数据联系起来。我们的目标是建立一个严谨的框架，用于表述、分析和验证描述动态[生物过程](@entry_id:164026)的数学模型。

### [状态空间表示](@entry_id:147149)法：动力学建[模的基](@entry_id:156416)础

描述一个动态系统的核心任务是捕捉其随[时间演化](@entry_id:153943)的行为。[状态空间表示](@entry_id:147149)法为此提供了一个强大而通用的语言。其核心思想是将系统分为两个部分：内部的**状态**（system state）和外部的**[可观测量](@entry_id:267133)**（observables）。

#### 定义系统状态

系统的**状态变量**（state variables）构成一个向量 $x(t)$，它包含了在任意时刻 $t$ 完整描述系统状况所必需的最小信息集合。这里的“完整描述”意味着，如果给定时刻 $t$ 的状态 $x(t)$ 以及从 $t$ 时刻起的所有外部输入，我们就能唯一确定系统未来的所有行为。这一特性被称为**马尔可夫属性**（Markov property），它表明系统的未来只依赖于其当前状态，而与它的过去无关。

选择一组恰当的状态变量是建模的第一步，也是至关重要的一步。这组变量必须是“最小”的，即不包含冗余信息，但又必须是“完备”的，足以预测未来。这个选择通常由系统内在的因果关系链决定。

例如，考虑一个由外部信号 $u(t)$ 驱动的荧光报告基因的表达过程。根据[分子生物学](@entry_id:140331)的[中心法则](@entry_id:136612)，信息流是：信号 $u(t)$ 激活转录，产生[信使核糖核酸](@entry_id:147846)（mRNA），mRNA被翻译成非荧光的[多肽链](@entry_id:144902)，最后多肽链经过折叠和化学修饰，成熟为具有荧光的蛋白质。我们可以将涉及的物质浓度定义为：$m(t)$（mRNA），$p_u(t)$（未成熟蛋白），和 $p_m(t)$（成熟荧光蛋白）。这些物质的动力学方程可以写成：
- $\frac{dm}{dt}$ 的变化率依赖于输入 $u(t)$ 和它自身的浓度 $m(t)$。
- $\frac{dp_u}{dt}$ 的变化率（翻译速率）依赖于 $m(t)$ 和它自身的浓度 $p_u(t)$。
- $\frac{dp_m}{dt}$ 的变化率（成熟速率）依赖于 $p_u(t)$ 和它自身的浓度 $p_m(t)$。

为了使每个变量的变化率仅取决于当前时刻的状态变量和输入，我们必须将所有出现在[动力学方程](@entry_id:751029)右侧的变量都包含在状态向量中。因此，一个能够保证马尔可夫属性的最小[状态向量](@entry_id:154607)是 $x(t) = [m(t), p_u(t), p_m(t)]^T$。省略其中任何一个变量都会破坏马尔可夫属性；例如，如果省略 $p_u(t)$，那么 $\frac{dp_m}{dt}$ 的值将依赖于一个未包含在状态中的变量，使得模型的预测能力依赖于系统的历史轨迹，而不仅仅是当前状态 [@problem_id:3310479]。

#### 定义[可观测量](@entry_id:267133)

与封装了系统完整内部信息的**状态**不同，**可观测量**（observables）$y(t)$ 是我们通过实验能够实际测量到的量。[状态变量](@entry_id:138790)可能是抽象的或难以直接测量的（如未成熟的蛋白质），而可观测量则是实验仪器（如[荧光显微镜](@entry_id:138406)、质谱仪）产生的具体读数。

可观测量是[状态变量](@entry_id:138790)的函数，其数学形式 $y(t) = h(x(t))$ 由测量技术的物理原理决定。这种关系可以是线性的、仿射的或[非线性](@entry_id:637147)的。

- **线性[可观测量](@entry_id:267133)（Linear Observable）**: 当测量信号是[状态变量](@entry_id:138790)的加权和时，观测模型是线性的。这可以表示为 $y(t) = C x(t)$，其中 $C$ 是一个常数矩阵，称为观测矩阵。例如，在一个生化网络中，如果某个[抗体](@entry_id:146805)能够以相同的亲和力结合两种蛋白 $X$ 和 $X_p$，那么通过免疫检测获得的总信号 $y_1(t)$ 将与它们的总浓度成正比：$y_1(t) = \kappa_1(x_X(t) + x_{X_p}(t))$。这对应一个线性观测关系，其观测矩阵的对应行为 $[\kappa_1, \kappa_1, 0, \dots, 0]$ [@problem_id:3310433]。同样，如果一种染料能同等地结合到游离的结合伴侣 $Y$ 和复合物 $C$ 上，那么总荧光信号将与 $x_Y(t) + x_C(t)$ 成正比，这也是一个线性[可观测量](@entry_id:267133) [@problem_id:3310433]。

- **仿射[可观测量](@entry_id:267133)（Affine Observable）**: 如果测量信号包含一个恒定的背景或基线偏移，那么关系就变成仿射的：$y(t) = C x(t) + b$。例如，质谱测量可能会因为[内标物](@entry_id:196019)的存在而产生一个恒定的背景信号 $\eta z_0$，使得测量值变为 $y_3(t) = \kappa_3 x_{X_p}(t) + \eta z_0$。尽管这种形式通常可以通过[数据预处理](@entry_id:197920)（如[背景扣除](@entry_id:190391)）来简化，但在严格的线性模型框架 $y=Cx$ 中，它并[非线性](@entry_id:637147)。

- **[非线性](@entry_id:637147)[可观测量](@entry_id:267133)（Nonlinear Observable）**: 许多现代生物学测量技术本质上是[非线性](@entry_id:637147)的。例如，基于[Förster共振能量转移](@entry_id:153152)（FRET）的[生物传感器](@entry_id:182252)通常会表现出饱和效应，其响应函数可能是米氏-门顿形式的，例如 $y_2(t) = r_{\min} + (r_{\max} - r_{\min}) \frac{x_Y(t)}{K + x_Y(t)}$。这种关系不能用一个常数矩阵 $C$ 来表示 [@problem_id:3310433]。

在建模时，一个关键的区别是：[状态向量](@entry_id:154607) $x(t)$ 必须包含所有[动态相关](@entry_id:171647)的物种，即使它们未被直接测量（这些被称为**[隐藏状态](@entry_id:634361)**，hidden states）。而观测矩阵 $C$ 或观测函数 $h(x)$ 则只反映了那些直接贡献于测量信号的物种。一个物种是[隐藏状态](@entry_id:634361)，仅仅意味着它在观测矩阵 $C$ 中对应的列向量为零，但这并不意味着应该将其从状态向量 $x(t)$ 中移除，因为它的动态演化可能对可观测状态产生影响。

综上所述，一个完整的确[定性动力学](@entry_id:263136)模型由两个方程定义：描述系统状态如何演化的**状态方程** $\dot{x} = f(x, u, \theta)$，以及描述如何从状态得到测量的**观测方程** $y = h(x, \theta)$。其中 $u$ 是外部输入，$\theta$ 是模型参数。

### 从第一性原理构建动力学：[化学反应网络](@entry_id:151643)

对于生物化学系统，[状态方程](@entry_id:274378)通常源于质量作用定律（law of mass action）。我们可以使用一种系统性的方法，即[化学计量矩阵](@entry_id:275342)表示法，来构建这些方程。

#### 化学计量和[反应速率](@entry_id:139813)

一个[化学反应网络](@entry_id:151643)由一组物种和一系列将它们相互转化的反应构成。每个反应 $j$ 都有一个相关的**[反应速率](@entry_id:139813)**或**[倾向函数](@entry_id:181123)**（propensity function）$v_j(x)$，它描述了该反应在单位时间内发生的频率。根据[质量作用定律](@entry_id:144659)，对于一个元反应，其速率与反应物的浓度（或分子数）的乘积成正比。

每个反应还伴随着一个**[化学计量](@entry_id:137450)向量**（stoichiometric vector），它描述了该反应发生一次时，每个物种数量的净变化。

#### [化学计量矩阵](@entry_id:275342)（$S$）

我们可以将整个[反应网络](@entry_id:203526)的[化学计量](@entry_id:137450)信息整合到一个**化学计量矩阵**（stoichiometric matrix）$S$ 中。该矩阵的每一行对应一个物种，每一列对应一个反应。[矩阵元](@entry_id:186505)素 $S_{ij}$ 表示在反应 $j$ 中物种 $i$ 的净变化量。因此，第 $j$ 列就是反应 $j$ 的[化学计量](@entry_id:137450)向量。

将所有反应的速率组合成一个向量 $v(x)$，整个系统的动力学就可以用一个非常紧凑的[矩阵方程](@entry_id:203695)来描述：
$$
\frac{dx}{dt} = S v(x)
$$
这个方程优雅地表明，系统状态的瞬时变化率 $(\dot{x})$ 是所有反应向量 $(S_j)$ 以其各自速率 $(v_j)$ 加权的线性组合。

例如，考虑一个简单的[酶催化](@entry_id:146161)反应模型，其中酶(E)和底物(S)可逆地结合形成复合物(ES)，复合物再催化生成产物(P)，同时产物可以再转化为底物 [@problem_id:3310427]。状态向量为 $x = (x_E, x_S, x_{ES}, x_P)^T$。反应及其化学计量变化如下：
1. $E + S \to ES$: $\Delta x_1 = (-1, -1, 1, 0)^T$
2. $ES \to E + S$: $\Delta x_2 = (1, 1, -1, 0)^T$
3. $ES \to E + P$: $\Delta x_3 = (1, 0, -1, 1)^T$
4. $P \to S$: $\Delta x_4 = (0, 1, 0, -1)^T$

将这些列向量组合起来，就得到了[化学计量矩阵](@entry_id:275342) $S$:
$$
S = \begin{pmatrix}
-1 &  1 &  1 &  0 \\
-1 &  1 &  0 &  1 \\
1 & -1 & -1 &  0 \\
0 &  0 &  1 & -1
\end{pmatrix}
$$
结合[反应速率](@entry_id:139813)向量 $v(x) = (k_1 x_E x_S, k_{-1} x_{ES}, k_2 x_{ES}, k_3 x_P)^T$，我们就可以通过 $\dot{x}=S v(x)$ 完整地写出系统的所有[微分方程](@entry_id:264184)。

#### 守恒律与 $S$ 的[左零空间](@entry_id:150506)

化学计量矩阵的结构蕴含着关于系统守恒律的深刻信息。一个**守恒律**是一个状态变量的[线性组合](@entry_id:154743)，其总量在系统[演化过程](@entry_id:175749)中保持不变，即 $c^T x(t) = \text{constant}$。对这个表达式求时间导数，我们得到：
$$
\frac{d}{dt}(c^T x) = c^T \dot{x} = c^T (S v(x)) = (c^T S) v(x)
$$
为了使这个导数对于任何可能的（非负）[反应速率](@entry_id:139813)向量 $v(x)$ 都恒等于零，必须满足 $c^T S = 0$。这意味着守恒向量 $c$ 必须位于矩阵 $S$ 的**[左零空间](@entry_id:150506)**（left nullspace）中。因此，[左零空间](@entry_id:150506)的维数等于系统中独立的线性守恒律的数量。

在上述酶催化反应的例子中 [@problem_id:3310427]，矩阵 $S$ 的秩为2。由于有4个物种，其[左零空间](@entry_id:150506)的维数为 $4 - 2 = 2$。这对应于两个独立的守恒律：
1.  **总酶守恒**: 酶可以是游离的 ($E$) 或结合的 ($ES$)，但其总数不变。$x_E + x_{ES} = E_{\text{tot}}$。这对应于守恒向量 $c^{(1)} = (1, 0, 1, 0)^T$。
2.  **总底物/产物基团守恒**: 底物基团可以在不同形式（$S$, $ES$, $P$）之间转换，但其总量不变。$x_S + x_{ES} + x_P = S_{\text{tot}}$。这对应于守恒向量 $c^{(2)} = (0, 1, 1, 1)^T$。

这两个守恒向量 $c^{(1)}$ 和 $c^{(2)}$ 构成了 $S$ [左零空间](@entry_id:150506)的一组基。识别这些守恒律对于模型简化和验证至关重要。

### 模型的检验与精炼

建立初始模型后，一系列检验和精炼步骤是确保其物理真实性和数学有效性的关键。

#### [量纲一致性](@entry_id:271193)：一项基本检查

物理上有意义的任何方程都必须满足**[量纲一致性](@entry_id:271193)**（dimensional homogeneity）原则：方程中通过加减法连接的每一项都必须具有相同的单位。这个看似简单的原则是[模型验证](@entry_id:141140)的强大工具。通过为模型中的每个变量和参数分配单位，我们可以检查所有方程是否在量纲上保持平衡。

考虑一个为[基因回路](@entry_id:201900)提出的模型，其中包含未知指数 $b, c, d$ [@problem_id:3310494]：
$$
\frac{dx_{p}}{dt} = k_{tl}\,x_{m}^{c} - \gamma_{p}\,x_{p}
$$
其中 $x_p$ 和 $x_m$ 是浓度（单位nM），$t$ 是时间（单位min），$\frac{dx_p}{dt}$ 的单位是 $\text{nM} \cdot \text{min}^{-1}$。参数 $k_{tl}$ 的单位是 $\text{min}^{-1}$，$\gamma_p$ 的单位也是 $\text{min}^{-1}$。
- 右侧第二项的单位是 $[\gamma_p x_p] = \text{min}^{-1} \cdot \text{nM}$，与左侧一致。
- 因此，右侧第一项的单位也必须是 $\text{nM} \cdot \text{min}^{-1}$。我们有 $[k_{tl} x_m^c] = [k_{tl}] \cdot [x_m]^c = \text{min}^{-1} \cdot \text{nM}^c$。
- 为了使单位匹配，我们必须有 $\text{min}^{-1} \cdot \text{nM}^c = \text{nM} \cdot \text{min}^{-1}$，这要求 $\text{nM}^c = \text{nM}^1$，从而唯一确定指数 $c=1$。

通过对模型中的所有方程进行类似的量纲审计，可以确定或验证模型结构中的未知指数，确保模型的基本物理合理性。

#### 无量纲化：揭示主导参数

**无量纲化**（nondimensionalization）是将模型用无量纲的变量和参数重新表达的过程。这一过程有两个主要好处：一是它通常能显著减少模型中的独立参数数量；二是它能揭示出控制系统行为的、具有物理意义的无量纲参数组合（如[雷诺数](@entry_id:136372)或马赫数）。

以一个简单的组成型[基因表达模型](@entry_id:178501)为例，其中mRNA ($M$) 和蛋白质 ($P$) 的动力学由以下方程描述 [@problem_id:3310489]：
$$
\frac{dM}{dt} = k_{m} - d_{m} M, \qquad \frac{dP}{dt} = k_{p} M - d_{p} P
$$
我们可以通过系统的[稳态](@entry_id:182458)值来定义特征尺度：$M^* = k_m/d_m$ 和 $P^* = k_p k_m / (d_p d_m)$。选择mRNA的寿命 $1/d_m$ 作为特征时间尺度 $t^*$。然后我们定义无量纲变量 $\tau = t/t^*$, $m(\tau) = M(t)/M^*$, $p(\tau) = P(t)/P^*$。代入原方程并化简，我们得到[无量纲化](@entry_id:136704)的系统：
$$
\frac{dm}{d\tau} = 1 - m, \qquad \frac{dp}{d\tau} = \gamma (m - p)
$$
其中，所有原始的四个参数 ($k_m, d_m, k_p, d_p$) 被组合成了一个单一的无量纲参数：
$$
\gamma = \frac{d_p}{d_m}
$$
这个参数 $\gamma$ 是[蛋白质降解](@entry_id:187883)速率与[mRNA降解](@entry_id:183086)速率的比值，它完全决定了系统的动态行为。
- 如果 $\gamma \ll 1$，意味着蛋白质比mRNA稳定得多。蛋白质的动态响应非常缓慢，它会对快速变化的mRNA水平进行时间上的“积分”或“平滑”。这被称为**积分器机制**（integrator regime）。
- 如果 $\gamma \gg 1$，意味着[蛋白质降解](@entry_id:187883)得非常快。蛋白质的浓度会迅速地“追踪”mRNA浓度的变化。这被称为**追踪器机制**（tracking regime）。

通过无量纲化，我们将一个四参数的问题简化为一个单参数的问题，并获得了关于系统功能（积分或追踪）的深刻洞见。

#### 处理时间延迟：从DDE到ODE

生物过程中普遍存在时间延迟，例如转录、翻译、[蛋白质转运](@entry_id:164888)等所需的时间。直接对这些[过程建模](@entry_id:183557)会产生**[延迟微分方程](@entry_id:264784)**（Delay Differential Equations, DDEs），其中一个变量的变化率依赖于过去某个时刻的状态，例如 $\frac{dP(t)}{dt} = k T(t-\tau) - \gamma P(t)$。

虽然DDEs能精确描述延迟，但它们的分析和数值求解比[常微分方程](@entry_id:147024)（ODEs）复杂得多。一种强大的近似方法是**线性链技巧**（linear chain trick），它用一串 $n$ 个连续的一阶ODE来近似一个固定的时间延迟 $\tau$。其思想是让信号通过一个由 $n$ 个“隔间”组成的链条，每个隔间的传出速率为 $\alpha = n/\tau$。这个链条的平均通过时间正好是 $n \times (1/\alpha) = \tau$。

这个ODE链的[传递函数](@entry_id:273897)为 $H_n(s) = (1 + s\tau/n)^{-n}$。当链的级数 $n \to \infty$ 时，这个[传递函数](@entry_id:273897)收敛于 $e^{-s\tau}$，这正是纯延迟 $\tau$ 在拉普拉斯域中的精确表达式 [@problem_id:3310468]。因此，通过使用足够多的中间状态，我们可以用一个高维的ODE系统任意精确地逼近一个DDE，从而可以使用标准的ODE分析工具。

### 连接理论与实验：可观测性、[可辨识性](@entry_id:194150)与噪声

一个数学上有效的模型最终必须能够解释实验数据。这需要我们考虑两个关键的理论属性——可观测性和[可辨识性](@entry_id:194150)——并建立一个实际的测量噪声模型。

#### [可观测性](@entry_id:152062)与[可辨识性](@entry_id:194150)

**状态可观测性**（State Observability）和**结构[可辨识性](@entry_id:194150)**（Structural Identifiability）是两个相关但截然不同的概念，它们共同决定了我们能从实验数据中学到什么 [@problem_id:3310488]。

- **结构[可辨识性](@entry_id:194150)**关注的是**参数**。一个模型的参数 $\theta$ 是结构可辨识的，如果理论上我们可以通过完美的、无噪声的输入-输出数据唯一地确定它的值。如果两组不同的参数值（$\theta_1 \neq \theta_2$）能够产生完全相同的输入-输出行为，那么这些参数就是结构不可辨识的。评估[可辨识性](@entry_id:194150)的一种方法是通过**输入-输出消去法**，将状态变量从方程中代数消去，得到一个只包含输入 $u(t)$、输出 $y(t)$ 及其导数的方程。这个输入-输出方程的系数通常是原始模型参数的组合，这些组合就是可辨识的。例如，在一个二阶系统中，如果输入-输出方程为 $\ddot{y} + (k_1+k_3)\dot{y} + (k_1 k_3 + k_2 k_f)y = (\dots)u$，那么组合参数 $(k_1+k_3)$ 和 $(k_1 k_3 + k_2 k_f)$ 就是结构可辨识的 [@problem_id:3310488]。

- **状态可观测性**关注的是**状态变量**。一个系统是可观测的，如果我们能够从有限时间段内的输入 $u(t)$ 和输出 $y(t)$ 数据中唯一地重构出整个状态轨迹 $x(t)$。对于[线性时不变](@entry_id:276287)（LTI）系统，这可以通过检验**[可观测性矩阵](@entry_id:165052)**（observability matrix）的秩来判断（即[卡尔曼秩条件](@entry_id:177700)）。对于非线性系统，则需要使用基于**李导数**（Lie derivatives）的更一般的[非线性可观测性](@entry_id:167271)秩条件 [@problem_id:3310422]。如果一个系统不是完全可观测的，意味着存在某些“隐藏”的动态模式，无论我们测量多久，都无法从输出中推断出来。这可能需要我们增加新的、不同类型的测量手段来使系统变得可观测。

#### [模型简化](@entry_id:171175)：[准稳态近似](@entry_id:273480)（QSSA）

当一个系统中包含在非常不同的时间尺度上发生的反应时，例如酶的结合/解离（快）和催化/产物释放（慢），我们可以通过**[准稳态近似](@entry_id:273480)**（Quasi-Steady-State Approximation, QSSA）来简化模型。QSSA假设快速变化的物种（如[酶-底物复合物](@entry_id:183472)）的浓度能够瞬时达到相对于慢变量的平衡。

这种近似的严格数学基础是**[奇异摄动理论](@entry_id:164182)**（singular perturbation theory）。通过将系统重写为快慢变量的形式（Tikhonov形式），并将快[反应速率](@entry_id:139813)前的系数表示为一个小的[无量纲参数](@entry_id:169335) $\epsilon \ll 1$，我们可以分析当 $\epsilon \to 0$ 时的极限行为 [@problem_id:3310429]。在这种极限下，系统的轨迹会迅速收敛到一个被称为**[慢流形](@entry_id:151421)**（slow manifold）的低维空间上。这个[慢流形](@entry_id:151421)由快变量的导数为零的代数方程（例如 $F_0(x,y)=0$）定义。只要这个[流形](@entry_id:153038)是稳定的（即正规双曲的），系统的慢动态就可以通过一个维度更低的简化模型来描述，该模型只在[慢流形](@entry_id:151421)上成立。这为QSSA提供了坚实的理论依据，并允许我们量化近似所带来的误差。

#### 随机性：超越确定性ODE

必须认识到，基于[质量作用定律](@entry_id:144659)的ODE模型描述的是大量分子系综的**平均**行为。在分子数量较少的系统中（例如在单个细胞内），反应的随机发生会引起不可忽略的**内在噪声**（intrinsic noise）。

描述这种[随机过程](@entry_id:159502)的更基本的框架是**[化学主方程](@entry_id:161378)**（Chemical Master Equation, CME）。CME是一个描述系统处于每个可能状态 $n$（即有 $n$ 个分子）的概率 $p_n(t)$ 如何随时间演化的无限维线性ODE系统 [@problem_id:3310445]。
$$
\frac{d}{dt} p_n(t) = \sum_{j} [ a_j(n-\nu_{ij}) p_{n-\nu_{ij}}(t) - a_j(n) p_n(t) ]
$$
其中 $a_j(n)$ 是反应 $j$ 在状态 $n$ 时的[倾向函数](@entry_id:181123)，$\nu_{ij}$ 是物种 $i$ 在反应 $j$ 中的[化学计量](@entry_id:137450)变化。

虽然CME是精确的，但通常难以求解。然而，我们可以从CME推导出系统矩（如均值和[方差](@entry_id:200758)）的[动力学方程](@entry_id:751029)。对于一个简单的生-灭过程，均值的[动力学方程](@entry_id:751029)与确定性ODE完全相同。而[方差](@entry_id:200758)的动力学则提供了一个衡量系统随机波动大小的指标。

确定性ODE模型何时是CME的一个良好近似？一个关键的衡量标准是**[变异系数](@entry_id:272423)**（Coefficient of Variation, CV），定义为[标准差](@entry_id:153618)与均值的比值：$\text{CV}(t) = \sqrt{\text{Var}[X(t)]} / \mathbb{E}[X(t)]$。当 $\text{CV}(t) \ll 1$ 时，[概率分布](@entry_id:146404)紧密地集中在均值周围，随机波动相对于平均水平很小，此时确定性OD[E模](@entry_id:160271)型能够很好地描述系统的典型行为 [@problem_id:3310445]。这种情况通常在分子数量很大时发生。

#### 建模测量过程

最后，一个完整的、可用于参数估计的模型必须包含对测量过程本身的现实描述，包括噪声。例如，在[荧光显微镜](@entry_id:138406)实验中，测得的信号 $y_k$ 受到多种噪声源的影响 [@problem_id:3310491]。
- **[散粒噪声](@entry_id:140025)**（Shot Noise）: 源于[光子](@entry_id:145192)到达检测器的泊松统计过程。其[方差](@entry_id:200758)等于其均值。
- **读出噪声**（Read Noise）: 源于相机电子器件，通常是与信号无关的加性[高斯噪声](@entry_id:260752)。

在[光子计数](@entry_id:186176)较高的情况下，根据[中心极限定理](@entry_id:143108)，泊松分布的散粒噪声可以很好地用[高斯分布](@entry_id:154414)来近似。因此，总噪声可以建模为一个[高斯分布](@entry_id:154414)，其[方差](@entry_id:200758)是信号依赖的（异[方差](@entry_id:200758)的）：
$$
\eta_k \sim \mathcal{N}(0, \underbrace{h(x(t_k);\theta)}_{\text{散粒噪声方差}} + \underbrace{\beta^2}_{\text{读出噪声方差}})
$$
其中 $h(x(t_k);\theta)$ 是期望的信号强度。基于这个[噪声模型](@entry_id:752540)，我们可以写出数据的**[似然函数](@entry_id:141927)**（likelihood function）。例如，对于上述高斯噪声模型，负[对数似然函数](@entry_id:168593)为：
$$
\mathcal{L}(\theta) \propto \sum_{k=1}^{K} \left[ \ln(h(x(t_k);\theta) + \beta^2) + \frac{(y_k - h(x(t_k);\theta))^2}{h(x(t_k);\theta) + \beta^2} \right]
$$
这个函数是连接模型预测与实验数据的桥梁。通过最小化这个负[对数似然函数](@entry_id:168593)，我们就可以找到最能解释观测数据的模型参数 $\theta$。这完成了从生物学第一性原理到定量数据分析的整个建模周期。