{"hands_on_practices": [{"introduction": "在确定了系统的稳态是稳定的之后，一个自然而然的问题是：当系统参数（如反应速率或外部信号强度）发生变化时，这个稳态会如何移动？本练习将指导您如何通过求解一个线性方程组来计算稳态灵敏度，这是衡量系统对参数扰动的响应程度的关键指标 [@problem_id:3321821]。通过这个实践，您将学会把雅可比矩阵的应用从单纯的稳定性判断扩展到对系统平衡点参数依赖性的量化分析。", "problem": "考虑一个双态生化反应模块，其在一个稳定稳态 $x^{\\ast}$ 附近，受标量参数 $p$ 影响被线性化。设其局部动力学由在 $(x^{\\ast}, p^{\\ast})$ 处求值的雅可比矩阵 $J$ 和直接参数输入向量 $\\partial f / \\partial p$ 表示，其中\n$$\nJ=\\begin{pmatrix}-2  1\\\\ 0  -1\\end{pmatrix},\\qquad \\frac{\\partial f}{\\partial p}=\\begin{pmatrix}1\\\\ 0\\end{pmatrix}.\n$$\n假设 $f(x^{\\ast},p^{\\ast})=0$ 且稳态灵敏度向量 $S_{x}:=\\frac{d x^{\\ast}}{d p}$ 存在且有限。仅使用稳态下的标准线性化和灵敏度定义，通过求解关联 $J$、$S_{x}$ 和 $\\partial f/\\partial p$ 的适当线性系统来计算稳态灵敏度 $S_{x}$。然后，根据 $J$ 所隐含的局部耦合结构及其特征值所指示的稳定性，简要解释每个状态灵敏度的符号和相对大小。\n\n将最终的灵敏度向量以精确有理数元素构成的行向量形式报告。无需四舍五入，也无需单位。", "solution": "系统在稳态 $x^{\\ast}$ 附近的动力学由常微分方程组 $\\frac{dx}{dt} = f(x, p)$ 描述。根据定义，在稳态下，时间导数为零，所以我们有条件 $f(x^{\\ast}(p), p) = 0$，这里我们写成 $x^{\\ast}(p)$ 是为了强调稳态的位置依赖于参数 $p$。\n\n稳态灵敏度向量 $S_{x}$ 定义为稳态解 $x^{\\ast}$ 对参数 $p$ 的导数，即 $S_{x} := \\frac{d x^{\\ast}}{d p}$。为了找到 $S_x$、雅可比矩阵 $J$ 和直接参数扰动 $\\frac{\\partial f}{\\partial p}$ 之间的关系，我们使用多元链式法则对稳态方程 $f(x^{\\ast}(p), p) = 0$ 关于 $p$ 求导：\n$$\n\\frac{d}{dp} [f(x^{\\ast}(p), p)] = \\frac{\\partial f}{\\partial x} \\frac{d x^{\\ast}}{d p} + \\frac{\\partial f}{\\partial p} \\frac{d p}{d p} = 0\n$$\n根据定义，雅可比矩阵是在稳态 $(x^{\\ast}, p^{\\ast})$ 处求值的 $J = \\frac{\\partial f}{\\partial x}$。项 $\\frac{d x^{\\ast}}{d p}$ 是灵敏度向量 $S_x$。由于 $\\frac{dp}{dp}=1$，方程变为：\n$$\nJ S_{x} + \\frac{\\partial f}{\\partial p} = 0\n$$\n这可以重排为我们必须求解 $S_x$ 的线性系统：\n$$\nJ S_{x} = - \\frac{\\partial f}{\\partial p}\n$$\n问题为在特定稳态 $(x^{\\ast}, p^{\\ast})$ 下的系统提供了具体的矩阵：\n$$\nJ=\\begin{pmatrix}-2  1\\\\ 0  -1\\end{pmatrix},\\qquad \\frac{\\partial f}{\\partial p}=\\begin{pmatrix}1\\\\ 0\\end{pmatrix}\n$$\n设灵敏度向量为 $S_{x} = \\begin{pmatrix} s_1 \\\\ s_2 \\end{pmatrix}$。我们将给定值代入线性系统：\n$$\n\\begin{pmatrix}-2  1\\\\ 0  -1\\end{pmatrix} \\begin{pmatrix} s_1 \\\\ s_2 \\end{pmatrix} = - \\begin{pmatrix}1\\\\ 0\\end{pmatrix} = \\begin{pmatrix}-1\\\\ 0\\end{pmatrix}\n$$\n这个矩阵方程对应于一个由两个线性方程组成的方程组：\n1.  $-2s_1 + s_2 = -1$\n2.  $0s_1 - s_2 = 0$\n\n从第二个方程，我们立即得到 $-s_2 = 0$，这意味着 $s_2 = 0$。\n将 $s_2 = 0$ 代入第一个方程得到：\n$$\n-2s_1 + 0 = -1\n$$\n$$\n-2s_1 = -1\n$$\n$$\ns_1 = \\frac{1}{2}\n$$\n因此，稳态灵敏度向量是 $S_{x} = \\begin{pmatrix} \\frac{1}{2} \\\\ 0 \\end{pmatrix}$。按照要求，以行向量形式表示为 $(\\frac{1}{2}, 0)$。\n\n为了进行解释，我们分析系统的结构和结果。\n首先，我们检查稳定性。雅可比矩阵 $J$ 是上三角矩阵，所以它的特征值是其对角线元素：$\\lambda_1 = -2$ 和 $\\lambda_2 = -1$。由于两个特征值都是实数且为负，该稳态是稳定的，正如问题中所述。\n\n雅可比矩阵 $J$ 的分量描述了局部相互作用：\n- $J_{11} = -2$ 和 $J_{22} = -1$ 表明两个状态变量 $x_1$ 和 $x_2$ 都是自抑制的，这是一个稳定化特征。\n- $J_{12} = 1$ 表明 $x_2$ 激活 $x_1$。\n- $J_{21} = 0$ 表明 $x_1$ 不直接影响 $x_2$。这建立了一种级联式或前馈式相互作用，其中影响从 $x_2$ 流向 $x_1$，但反向不成立。\n\n直接参数输入向量 $\\frac{\\partial f}{\\partial p} = \\begin{pmatrix}1\\\\ 0\\end{pmatrix}$ 表明参数 $p$ 仅直接扰动 $x_1$ 的动力学（具体来说，它增加了其变化率），并且对 $x_2$ 没有直接影响。\n\n灵敏度结果 $S_{x} = (\\frac{dx_1^{\\ast}}{dp}, \\frac{dx_2^{\\ast}}{dp}) = (\\frac{1}{2}, 0)$ 现在可以解释如下：\n- 第二个状态的灵敏度为零 ($s_2 = 0$)。这是因为参数 $p$ 不直接影响 $x_2$（因为 $\\frac{\\partial f_2}{\\partial p} = 0$），并且没有从 $x_1$ 到达 $x_2$ 的间接扰动路径（因为 $J_{21} = 0$）。因此，$x_2$ 的稳态值对 $p$ 的变化完全不敏感。\n- 第一个状态的灵敏度是正的且有限 ($s_1 = \\frac{1}{2}$)。正号表示 $p$ 的增加导致 $x_1$ 稳态值的增加。这是预料之中的，因为 $p$ 直接促进 $x_1$，而系统中唯一的反馈来自对 $x_1$ 有正向影响的 $x_2$。大小 $\\frac{1}{2}$ 反映了新稳态下的平衡。来自 $p$ 的直接正扰动（强度为+1）必须被系统的响应所平衡。因为 $s_2=0$，$x_1$ 的变化仅由其自身的强自抑制（$J_{11}=-2$）来平衡。得到的灵敏度可以从第一个方程中看出，$s_1 = \\frac{-1 - s_2}{-2} = \\frac{-1 - 0}{-2} = \\frac{1}{2}$。强自阻尼减弱了参数扰动的影响。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{2}  0 \\end{pmatrix}}\n$$", "id": "3321821"}, {"introduction": "雅可比矩阵的特征值决定了系统的长期（或渐近）稳定性，但它们并不总能完全揭示系统的短期瞬态行为。本练习探讨了一个重要而违反直觉的概念：非正常系统中的瞬态增长 [@problem_id:3321850]。即使系统是渐近稳定的（所有特征值的实部均为负），扰动也可能在最终衰减之前经历显著的放大，这种现象对于理解生物通路中的信号处理和兴奋性至关重要。", "problem": "一个双物种生化反应网络在稳定稳态附近进行线性化，以获得由线性常微分方程 $\\frac{d x}{d t} = J x$ 控制的偏差向量 $x(t) \\in \\mathbb{R}^{2}$ 的局域动力学。该 $2 \\times 2$ 的雅可比矩阵 $J$ 为\n$$\nJ \\;=\\; \\begin{pmatrix} -1  100 \\\\ 0  -1 \\end{pmatrix}.\n$$\n在计算系统生物学中，局域流映射 $x(t) = \\exp(J t) x(0)$ 由矩阵指数 $\\exp(J t)$ 决定，而扰动的瞬时放大由诱导矩阵 $2$-范数 $\\|\\exp(J t)\\|_{2}$（即 $\\exp(J t)$ 的最大奇异值）来量化。\n\n仅从以下事实出发：(i) 初始条件为 $x(0)$ 的线性系统 $\\frac{d x}{d t} = J x$ 的解是 $x(t) = \\exp(J t) x(0)$，以及 (ii) 谱范数 $\\|A\\|_{2}$ 等于 $A$ 的最大奇异值，执行以下操作：\n\n1. 显式计算所有实数 $t \\ge 0$ 的 $\\exp(J t)$。\n2. 使用关于奇异值的第一性原理，推导 $\\|\\exp(J t)\\|_{2}$ 作为 $t$ 的函数的精确解析表达式，并用它来证明存在瞬时增长，即存在一个适度的 $t  0$ 区间，在此区间内 $\\|\\exp(J t)\\|_{2}  1$，尽管 $J$ 的所有特征值都具有负实部。\n3. 从机理上解释为什么大的非对角线元素 $100$ 会导致这个双物种系统中的非正规瞬时放大。\n\n最后，确定此特定矩阵 $J$ 的 $\\|\\exp(J t)\\|_{2}$ 在 $t \\ge 0$ 上的上确界的精确闭式表达式（用初等函数表示），并报告该单一表达式作为您的最终答案。放大因子是无量纲的，因此不需要单位。不要四舍五入；提供精确的符号结果。", "solution": "解答过程将按顺序处理问题的四个组成部分。\n\n**1. 矩阵指数 $\\exp(J t)$ 的计算**\n\n雅可比矩阵为 $J = \\begin{pmatrix} -1  100 \\\\ 0  -1 \\end{pmatrix}$。我们可以将 $J$ 分解为一个对角矩阵 $D$ 和一个幂零矩阵 $N$ 的和。\n令 $D = -1 \\cdot I = \\begin{pmatrix} -1  0 \\\\ 0  -1 \\end{pmatrix}$ 及 $N = \\begin{pmatrix} 0  100 \\\\ 0  0 \\end{pmatrix}$。\n则 $J = D + N$。我们必须检查 $D$ 和 $N$ 是否交换：\n$$DN = \\begin{pmatrix} -1  0 \\\\ 0  -1 \\end{pmatrix} \\begin{pmatrix} 0  100 \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} 0  -100 \\\\ 0  0 \\end{pmatrix}$$\n$$ND = \\begin{pmatrix} 0  100 \\\\ 0  0 \\end{pmatrix} \\begin{pmatrix} -1  0 \\\\ 0  -1 \\end{pmatrix} = \\begin{pmatrix} 0  -100 \\\\ 0  0 \\end{pmatrix}$$\n由于 $DN = ND$，我们可以使用性质 $\\exp(J t) = \\exp((D+N)t) = \\exp(Dt)\\exp(Nt)$。\n\n对角部分的指数为：\n$$\\exp(Dt) = \\exp(-It) = \\exp(-t) I = \\begin{pmatrix} \\exp(-t)  0 \\\\ 0  \\exp(-t) \\end{pmatrix}$$\n\n对于幂零部分，我们计算其幂：\n$$N^2 = \\begin{pmatrix} 0  100 \\\\ 0  0 \\end{pmatrix} \\begin{pmatrix} 0  100 \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ 0  0 \\end{pmatrix}$$\n由于 $N^2$ 是零矩阵，所有 $k \\ge 2$ 的更高次幂 $N^k$ 也都为零。因此 $\\exp(Nt)$ 的泰勒级数截断为：\n$$\\exp(Nt) = I + Nt + \\frac{(Nt)^2}{2!} + \\dots = I + Nt = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} + t\\begin{pmatrix} 0  100 \\\\ 0  0 \\end{pmatrix} = \\begin{pmatrix} 1  100t \\\\ 0  1 \\end{pmatrix}$$\n\n结合这些结果，我们得到 $\\exp(Jt)$ 的显式形式：\n$$\\exp(Jt) = \\exp(Dt)\\exp(Nt) = \\begin{pmatrix} \\exp(-t)  0 \\\\ 0  \\exp(-t) \\end{pmatrix} \\begin{pmatrix} 1  100t \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} \\exp(-t)  100t \\exp(-t) \\\\ 0  \\exp(-t) \\end{pmatrix}$$\n\n**2. $\\|\\exp(J t)\\|_{2}$ 的推导与瞬时增长的证明**\n\n范数 $\\|\\exp(J t)\\|_{2}$ 是 $\\exp(J t)$ 的最大奇异值，由 $\\sigma_{\\max} = \\sqrt{\\lambda_{\\max}(A^T A)}$ 给出，其中 $A = \\exp(J t)$。\n首先，我们计算乘积 $A^T A$：\n$$A = \\exp(-t)\\begin{pmatrix} 1  100t \\\\ 0  1 \\end{pmatrix}$$\n$$A^T A = \\left( \\exp(-t)\\begin{pmatrix} 1  0 \\\\ 100t  1 \\end{pmatrix} \\right) \\left( \\exp(-t)\\begin{pmatrix} 1  100t \\\\ 0  1 \\end{pmatrix} \\right) = \\exp(-2t)\\begin{pmatrix} 1  100t \\\\ 100t  1+(100t)^2 \\end{pmatrix}$$\n为了找到 $A^T A$ 的特征值，我们找到矩阵 $M = \\begin{pmatrix} 1  100t \\\\ 100t  1+(100t)^2 \\end{pmatrix}$ 的特征值。特征方程为 $\\det(M-\\lambda I) = 0$：\n$$(1-\\lambda)(1+(100t)^2-\\lambda) - (100t)^2 = 0$$\n$$\\lambda^2 - (2+(100t)^2)\\lambda + (1+(100t)^2) - (100t)^2 = 0$$\n$$\\lambda^2 - (2+(100t)^2)\\lambda + 1 = 0$$\n$M$ 的最大特征值由二次公式给出：\n$$\\lambda_{\\max}(M) = \\frac{2+(100t)^2 + \\sqrt{(2+(100t)^2)^2 - 4}}{2} = \\frac{2+(100t)^2 + \\sqrt{(100t)^4 + 4(100t)^2}}{2}$$\n$$\\lambda_{\\max}(M) = \\frac{2+(100t)^2 + 100t\\sqrt{(100t)^2+4}}{2}$$\n$A^T A$ 的最大特征值是 $\\lambda_{\\max}(A^T A) = \\exp(-2t)\\lambda_{\\max}(M)$。范数是它的平方根：\n$$\\|\\exp(J t)\\|_{2} = \\sqrt{\\exp(-2t)\\lambda_{\\max}(M)} = \\exp(-t)\\sqrt{\\frac{2+(100t)^2 + 100t\\sqrt{(100t)^2+4}}{2}}$$\n为了证明瞬时增长，我们表明范数从其初始值 $1$ 开始增长。在 $t=0$ 时，$\\|\\exp(J \\cdot 0)\\|_{2} = \\|I\\|_{2} = 1$。我们可以考察范数在 $t=0$ 处的导数。$J$ 的对称部分是 $J_S = \\frac{1}{2}(J+J^T) = \\frac{1}{2}\\begin{pmatrix} -2  100 \\\\ 100  -2 \\end{pmatrix} = \\begin{pmatrix} -1  50 \\\\ 50  -1 \\end{pmatrix}$。$J_S$ 的特征值由 $(-1-\\lambda)^2 - 50^2 = 0$ 给出，所以 $\\lambda+1 = \\pm 50$，即 $\\lambda_1=49$ 和 $\\lambda_2=-51$。$J_S$ 的最大特征值，也称为 $J$ 的数值横坐标，是 $49$。因为它是正的，所以 $\\|\\exp(Jt)\\|_2$ 最初从 $1$ 开始增加，这证明了瞬时增长。\n$J$ 的特征值为 $\\lambda_1 = \\lambda_2 = -1$。由于所有特征值都具有负实部，系统是渐近稳定的，即 $\\lim_{t\\to\\infty} \\|\\exp(Jt)\\|_2 = 0$。初始增长后最终衰减是稳定的非正规系统的一个定义特征。$JJ^T \\neq J^TJ$ 证实了其非正规性。\n\n**3. 机理解释**\n\n微分方程组是：\n$$\\frac{dx_1}{dt} = -x_1 + 100x_2$$\n$$\\frac{dx_2}{dt} = -x_2$$\n物种 $1$ ($x_1$) 和物种 $2$ ($x_2$) 都以速率常数 $1$ 进行一阶降解。然而，物种 $2$ 作为物种 $1$ 的强激活剂，具有一个大的耦合常数 $100$。\n$x_2(t)$ 的解是一个简单的指数衰减：$x_2(t) = x_2(0)\\exp(-t)$。\n将此代入 $x_1$ 的方程得到：$\\frac{dx_1}{dt} + x_1 = 100 x_2(0) \\exp(-t)$。\n解为 $x_1(t) = (x_1(0) + 100 x_2(0) t)\\exp(-t)$。\n考虑一个仅在物种 $2$ 中的初始扰动：$x(0) = \\begin{pmatrix} 0 \\\\ \\epsilon \\end{pmatrix}$。在时间 $t$ 的状态是 $x(t) = \\begin{pmatrix} 100 \\epsilon t \\exp(-t) \\\\ \\epsilon \\exp(-t) \\end{pmatrix}$。\n这个状态向量的范数 $\\|x(t)\\|_2 = \\epsilon \\exp(-t) \\sqrt{(100t)^2+1}$，可以变得比初始范数 $\\|x(0)\\|_2 = \\epsilon$ 大得多。项 $100t\\exp(-t)$ 表明 $x_1$ 的浓度最初随时间线性放大，并带有一个大的因子 $100$。这种由 $x_2$ 对 $x_1$ 的“泵送”导致系统状态的大瞬时偏移，之后指数衰减项 $\\exp(-t)$ 在大的 $t$ 时占主导地位，将系统带回原点处的稳态。这种一个状态变量被另一个同时衰减的变量放大的机制，是非正规系统中具有“剪切流式”流动的放大的典型特征。\n\n**4. $\\|\\exp(J t)\\|_{2}$ 的上确界**\n\n为了找到 $\\|\\exp(J t)\\|_{2}$ 的最大值，我们简化其表达式。令 $u = 100t$。我们使用双曲替换 $u = 2\\sinh(\\theta)$，所以 $t = \\frac{1}{50}\\sinh(\\theta)$ 且 $\\theta = \\arcsinh(50t)$。\n在这种替换下，$\\lambda_{\\max}(M)$ 的表达式大大简化：\n$$100t\\sqrt{(100t)^2+4} = 2\\sinh(\\theta)\\sqrt{4\\sinh^2(\\theta)+4} = 2\\sinh(\\theta)(2\\cosh(\\theta)) = 2\\sinh(2\\theta)$$\n$$(100t)^2 = 4\\sinh^2(\\theta) = 2(\\cosh(2\\theta)-1)$$\n$$\\lambda_{\\max}(M) = \\frac{2 + 2(\\cosh(2\\theta)-1) + 2\\sinh(2\\theta)}{2} = \\cosh(2\\theta) + \\sinh(2\\theta) = \\exp(2\\theta)$$\n现在，将此代回范数表达式中：\n$$\\|\\exp(J t)\\|_{2} = \\exp(-t)\\sqrt{\\exp(2\\theta)} = \\exp(-t)\\exp(\\theta) = \\exp(\\theta-t)$$\n代入 $\\theta$ 和 $t$ 的定义：\n$$F(t) = \\|\\exp(Jt)\\|_2 = \\exp(\\arcsinh(50t) - t)$$\n为了找到最大值，我们可以最大化指数 $G(t) = \\arcsinh(50t) - t$。我们通过令导数为零来找到临界点：\n$$G'(t) = \\frac{d}{dt}(\\arcsinh(50t)) - 1 = \\frac{50}{\\sqrt{(50t)^2+1}} - 1$$\n令 $G'(t)=0$ 得：\n$$\\frac{50}{\\sqrt{(50t)^2+1}} = 1 \\implies 50 = \\sqrt{2500t^2+1}$$\n$$2500 = 2500t^2+1 \\implies 2500t^2 = 2499 \\implies t^2 = \\frac{2499}{2500}$$\n最大放大的时间是 $t_{\\max} = \\sqrt{\\frac{2499}{2500}} = \\frac{\\sqrt{2499}}{50}$。我们可以简化 $\\sqrt{2499} = \\sqrt{49 \\cdot 51} = 7\\sqrt{51}$。\n所以，$t_{\\max} = \\frac{7\\sqrt{51}}{50}$。\n最大值通过计算 $F(t_{\\max})$ 得到：\n$$\\sup_{t \\ge 0} \\|\\exp(J t)\\|_{2} = F(t_{\\max}) = \\exp(\\arcsinh(50 t_{\\max}) - t_{\\max})$$\n在 $t_{\\max}$ 处，我们有 $50t_{\\max} = 7\\sqrt{51}$。所以我们需要计算 $\\arcsinh(7\\sqrt{51})$。\n使用对数恒等式 $\\arcsinh(z) = \\ln(z+\\sqrt{z^2+1})$:\n$$\\arcsinh(7\\sqrt{51}) = \\ln(7\\sqrt{51} + \\sqrt{(7\\sqrt{51})^2+1}) = \\ln(7\\sqrt{51} + \\sqrt{2499+1}) = \\ln(7\\sqrt{51} + \\sqrt{2500}) = \\ln(50+7\\sqrt{51})$$\n因此指数为 $\\ln(50+7\\sqrt{51}) - \\frac{7\\sqrt{51}}{50}$。\n上确界是：\n$$\\exp\\left(\\ln(50+7\\sqrt{51}) - \\frac{7\\sqrt{51}}{50}\\right) = (50+7\\sqrt{51})\\exp\\left(-\\frac{7\\sqrt{51}}{50}\\right)$$\n这是最大放大因子的最终精确表达式。", "answer": "$$\n\\boxed{(50+7\\sqrt{51})\\exp\\left(-\\frac{7\\sqrt{51}}{50}\\right)}\n$$", "id": "3321850"}, {"introduction": "当雅可比矩阵分析的理论工具被应用于真实生物系统以预测其行为时，其威力才能得到最充分的体现。作为一个合成生物学中的里程碑式模型，“抑制子振荡器”（repressilator）提供了一个绝佳的案例。这项综合性练习将引导您完整地分析这个著名的基因线路，从推导其雅可比矩阵，到利用特征值分析来预测霍普夫分岔（Hopf bifurcation）的发生——这是一个标志着持续振荡产生的数学事件 [@problem_id:3321845]。", "problem": "考虑一个无量纲的三基因阻遏子振荡器模型，这是一个典型的合成基因回路，由三个呈环形排列的转录阻遏蛋白组成。令 $x(t)$、$y(t)$ 和 $z(t)$ 表示三种基因产物的浓度。其动力学由以下常微分方程组建模\n$$\n\\frac{dx}{dt} = -x + \\frac{\\alpha}{1 + \\left(\\frac{z}{K}\\right)^n}, \\quad\n\\frac{dy}{dt} = -y + \\frac{\\alpha}{1 + \\left(\\frac{x}{K}\\right)^n}, \\quad\n\\frac{dz}{dt} = -z + \\frac{\\alpha}{1 + \\left(\\frac{y}{K}\\right)^n},\n$$\n其中 $n \\ge 1$ 是希尔系数（无量纲），$\\alpha > 0$ 是最大生产速率（无量纲），$K > 0$ 是阻遏阈值（无量纲）。所有物种的降解速率均被缩放为 $1$。\n\n任务：\n1. 从通过雅可比矩阵进行局部线性化的定义出发，考虑对称稳态 $x^* = y^* = z^* = s$，该稳态由不动点条件 $s = \\frac{\\alpha}{1 + \\left(\\frac{s}{K}\\right)^n}$ 隐式定义。通过计算右侧函数对状态变量的偏导数，并在 $x=y=z=s$ 处求值，推导在该对称稳态下的雅可比矩阵 $J$（用 $s$、$n$、$\\alpha$ 和 $K$ 表示）。\n2. 使用第一性原理来解释雅可比矩阵的特征值，解释特征值实部的符号如何决定局部稳定性。确定一对共轭复特征值穿过虚轴的条件，这种情况预示着霍普夫分岔和持续振荡的开始。\n3. 编写一个完整的、可运行的程序，该程序对于给定的一组参数 $(n,\\alpha,K)$，执行以下步骤：\n   - 通过求解 $s$（或等价地求解 $r = \\left(\\frac{s}{K}\\right)^n$）来数值计算对称稳态，以满足不动点条件。\n   - 使用计算出的导数构建在 $x=y=z=s$ 处的雅可比矩阵 $J$。\n   - 计算 $J$ 的特征值，并判断是否存在具有正实部（严格大于零）的共轭复特征值对，这表明系统处于与霍普夫分岔相关的振荡状态。\n   - 对于每个测试用例，如果预测系统处于振荡状态（存在具有正实部的共轭复特征值对），则输出整数 $1$，否则输出 $0$（包括实部等于零的边界情况）。\n所有变量和参数都是无量纲的；不需要物理单位。不涉及角度。\n\n测试套件：\n使用以下参数集 $(n,\\alpha,K)$ 来评估您的程序。这些参数集涵盖了一般情况、边界条件和边缘情况：\n- $(2, 100.0, 1.0)$\n- $(3, 4.0, 1.0)$\n- $(4, 2.0, 1.0)$\n- $(4, 4.0, 1.0)$\n- $(5, 1.0, 0.1)$\n- $(3, 1.0, 1.0)$\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔的结果列表。例如，对于六个测试用例，输出必须是以下形式\n$$\n[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4,\\text{result}_5,\\text{result}_6]\n$$\n其中每个 $\\text{result}_i$ 是如上所述的整数 $0$ 或 $1$。", "solution": "对阻遏子振荡器模型在其对称稳态附近的局域动力学分析涉及系统的线性化，这通过雅可比矩阵实现。该矩阵的特征值决定了稳态的稳定性。\n\n#### 任务 1：雅可比矩阵的推导\n\n该常微分方程组可以写成向量形式 $\\frac{d\\mathbf{x}}{dt} = \\mathbf{F}(\\mathbf{x})$，其中 $\\mathbf{x} = [x, y, z]^T$，且 $\\mathbf{F}(\\mathbf{x}) = [f_x(x,y,z), f_y(x,y,z), f_z(x,y,z)]^T$，其中：\n$$\nf_x(x,y,z) = -x + \\frac{\\alpha}{1 + (z/K)^n} \\\\\nf_y(x,y,z) = -y + \\frac{\\alpha}{1 + (x/K)^n} \\\\\nf_z(x,y,z) = -z + \\frac{\\alpha}{1 + (y/K)^n}\n$$\n雅可比矩阵 $J$ 是向量函数 $\\mathbf{F}$ 的所有一阶偏导数构成的矩阵：\n$$\nJ = \\begin{pmatrix}\n\\frac{\\partial f_x}{\\partial x}  \\frac{\\partial f_x}{\\partial y}  \\frac{\\partial f_x}{\\partial z} \\\\\n\\frac{\\partial f_y}{\\partial x}  \\frac{\\partial f_y}{\\partial y}  \\frac{\\partial f_y}{\\partial z} \\\\\n\\frac{\\partial f_z}{\\partial x}  \\frac{\\partial f_z}{\\partial y}  \\frac{\\partial f_z}{\\partial z}\n\\end{pmatrix}\n$$\n我们计算各个偏导数：\n- 对角线元素很简单：$\\frac{\\partial f_x}{\\partial x} = -1$，$\\frac{\\partial f_y}{\\partial y} = -1$，$\\frac{\\partial f_z}{\\partial z} = -1$。\n- 非对角线元素捕捉了阻遏相互作用。例如，$\\frac{\\partial f_x}{\\partial z}$ 为：\n$$\n\\frac{\\partial f_x}{\\partial z} = \\frac{\\partial}{\\partial z} \\left( \\alpha \\left[ 1 + \\left(\\frac{z}{K}\\right)^n \\right]^{-1} \\right) = -\\alpha \\left( 1 + \\left(\\frac{z}{K}\\right)^n \\right)^{-2} \\cdot n \\left(\\frac{z}{K}\\right)^{n-1} \\cdot \\frac{1}{K} = -\\frac{\\alpha n z^{n-1}}{K^n \\left( 1 + (z/K)^n \\right)^2}\n$$\n其他导数要么为零（例如 $\\frac{\\partial f_x}{\\partial y} = 0$），要么可由系统的循环对称性得出：\n$$\n\\frac{\\partial f_y}{\\partial x} = -\\frac{\\alpha n x^{n-1}}{K^n \\left( 1 + (x/K)^n \\right)^2}, \\quad \\frac{\\partial f_z}{\\partial y} = -\\frac{\\alpha n y^{n-1}}{K^n \\left( 1 + (y/K)^n \\right)^2}\n$$\n现在，我们在对称稳态 $x = y = z = s$ 处计算该矩阵。矩阵元素变为：\n$$\nJ_{11} = J_{22} = J_{33} = -1 \\\\\nJ_{12} = J_{23} = J_{31} = 0\n$$\n由于对称性，其余元素都相等。我们用 $\\beta$ 表示这个共同的值：\n$$\n\\beta = J_{13} = J_{21} = J_{32} = -\\frac{\\alpha n s^{n-1}}{K^n \\left( 1 + (s/K)^n \\right)^2}\n$$\n在稳态下的雅可比矩阵 $J^*$ 为：\n$$\nJ^* = \\begin{pmatrix} -1  0  \\beta \\\\ \\beta  -1  0 \\\\ 0  \\beta  -1 \\end{pmatrix}\n$$\n我们可以利用稳态条件 $s = \\frac{\\alpha}{1 + (s/K)^n}$ 来简化 $\\beta$ 的表达式。这给出 $\\alpha = s(1+(s/K)^n)$。将此代入 $\\beta$ 的表达式中：\n$$\n\\beta = -\\frac{s(1+(s/K)^n) \\cdot n s^{n-1}}{K^n (1 + (s/K)^n)^2} = -\\frac{n s^n}{K^n (1 + (s/K)^n)} = -\\frac{n (s/K)^n}{1 + (s/K)^n}\n$$\n这是雅可比矩阵非对角线项关于 $s$、$n$ 和 $K$ 的最终表达式。\n\n#### 任务 2：特征值解释与霍普夫分岔\n\n根据 Hartman-Grobman 定理，非线性动力系统在双曲不动点附近的行为与其在该点的线性化行为在性质上是相同的。线性化由系统 $\\frac{d(\\delta\\mathbf{x})}{dt} = J^* \\delta\\mathbf{x}$ 给出，其中 $\\delta\\mathbf{x}$ 是对不动点的一个小扰动。这个线性系统的解由雅可比矩阵 $J^*$ 的特征值 $\\lambda_i$ 决定。\n\n- 如果所有特征值的实部都为负，即对所有 $i$ 都有 $\\text{Re}(\\lambda_i)  0$，那么任何小扰动都会指数衰减，该不动点是局部渐近稳定的。\n- 如果至少有一个特征值的实部为正，即对某个 $j$ 有 $\\text{Re}(\\lambda_j) > 0$，那么沿着相应特征向量方向的扰动将会增长，使得不动点不稳定。\n- 如果至少有一个特征值的实部为零，而所有其他特征值的实部都为负，则该不动点是非双曲的。这是一个临界点，系统的稳定性可能在此处发生改变，这种现象称为分岔。\n\n当一对共轭复特征值随着系统参数的变化而穿过虚轴时，就会发生霍普夫分岔。具体来说，如果一对特征值为 $\\lambda = \\mu \\pm i\\omega$ 且 $\\omega \\neq 0$，当实部 $\\mu$ 穿过零时，分岔发生。如果 $\\mu$ 从负值变为正值，稳定的不动点会失去其稳定性，并通常产生一个稳定的极限环，这对应于系统中的持续振荡。\n\n为了找到阻遏子振荡器模型中霍普夫分岔的条件，我们计算 $J^*$ 的特征值。特征方程为 $\\det(J^* - \\lambda I) = 0$：\n$$\n\\det \\begin{pmatrix} -1-\\lambda  0  \\beta \\\\ \\beta  -1-\\lambda  0 \\\\ 0  \\beta  -1-\\lambda \\end{pmatrix} = (-1-\\lambda)\\left((-1-\\lambda)^2-0\\right) - 0 + \\beta(\\beta^2-0) = 0\n$$\n$$\n(-1-\\lambda)^3 + \\beta^3 = 0 \\implies (\\lambda+1)^3 = \\beta^3\n$$\n$\\lambda+1$ 的三个解是 $\\beta^3$ 的立方根，即 $\\beta e^{i0}$、$\\beta e^{i2\\pi/3}$ 和 $\\beta e^{i4\\pi/3}$。回顾 $e^{i\\theta} = \\cos\\theta + i\\sin\\theta$，我们得到三个特征值：\n- $\\lambda_1+1 = \\beta \\implies \\lambda_1 = \\beta - 1$\n- $\\lambda_2+1 = \\beta(-\\frac{1}{2} + i\\frac{\\sqrt{3}}{2}) \\implies \\lambda_2 = -1 - \\frac{\\beta}{2} + i\\frac{\\beta\\sqrt{3}}{2}$\n- $\\lambda_3+1 = \\beta(-\\frac{1}{2} - i\\frac{\\sqrt{3}}{2}) \\implies \\lambda_3 = -1 - \\frac{\\beta}{2} - i\\frac{\\beta\\sqrt{3}}{2}$\n\n因为 $s, K > 0$ 且 $n \\ge 1$，所以 $(s/K)^n$ 是正的。因此，$\\beta = -n\\frac{(s/K)^n}{1+(s/K)^n}$ 总是负的。\n- 第一个特征值的实部 $\\text{Re}(\\lambda_1) = \\beta - 1$ 因此总是负的。这个特征值总是起稳定作用。\n- 另外两个特征值 $\\lambda_2$ 和 $\\lambda_3$ 构成一对共轭复数。它们的实部是 $\\text{Re}(\\lambda_{2,3}) = -1 - \\frac{\\beta}{2}$。\n\n当这个实部变为正时，系统变得不稳定并进入振荡状态：\n$$\n-1 - \\frac{\\beta}{2} > 0 \\implies -\\frac{\\beta}{2} > 1 \\implies \\beta  -2\n$$\n代入 $\\beta$ 的表达式：\n$$\n-\\frac{n (s/K)^n}{1 + (s/K)^n}  -2 \\implies \\frac{n (s/K)^n}{1 + (s/K)^n} > 2\n$$\n$$\nn(s/K)^n > 2(1 + (s/K)^n) \\implies (n-2)(s/K)^n > 2\n$$\n这是振荡不稳定性的条件。注意，这要求 $n-2 > 0$，因此只有当希尔系数 $n > 2$ 时才可能发生振荡。\n\n#### 任务 3：计算实现\n\n程序必须为每组参数 $(n, \\alpha, K)$ 实现以下逻辑：\n1.  数值求解对称稳态。为方便求解，我们可求解无量纲比率 $r = (s/K)^n$。将 $s = K r^{1/n}$ 代入稳态方程得到 $K r^{1/n} = \\frac{\\alpha}{1+r}$。这等价于找到函数 $g(r) = K r^{1/n} - \\frac{\\alpha}{1+r} = 0$ 对于 $r > 0$ 的根。该方程有唯一的正根。\n2.  找到 $r$ 的值后，评估在任务 2 中推导出的不稳定性条件：$(n-2)r > 2$。\n3.  如果满足该条件，系统处于振荡状态，输出为 $1$。否则，包括特征值实部为零的边界情况 $(n-2)r = 2$，输出为 $0$。\n该过程将使用 Python 中的 `scipy.optimize.root_scalar` 进行数值求根来实现。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import root_scalar\n\ndef solve():\n    \"\"\"\n    Solves for the stability of the repressilator symmetric steady state for a suite of test cases.\n    \"\"\"\n    # Test cases defined as tuples of (n, alpha, K)\n    test_cases = [\n        # (n, alpha, K)\n        (2.0, 100.0, 1.0),\n        (3.0, 4.0, 1.0),\n        (4.0, 2.0, 1.0),\n        (4.0, 4.0, 1.0),\n        (5.0, 1.0, 0.1),\n        (3.0, 1.0, 1.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        n, alpha, K = case\n\n        # The condition for oscillatory instability is (n-2)r  2, where r = (s/K)^n.\n        # This is only possible if n  2. If n = 2, the system cannot oscillate.\n        if n = 2:\n            results.append(0)\n            continue\n\n        # Define the function whose root we need to find to determine the steady state.\n        # The equation for the steady state can be rewritten in terms of r = (s/K)^n as:\n        # K * r^(1/n) - alpha / (1 + r) = 0\n        def fixed_point_equation(r):\n            # To avoid potential domain errors for r near or below 0\n            if r = 0:\n                return -alpha\n            return K * (r**(1/n)) - alpha / (1 + r)\n\n        # We need to find a bracketing interval [a, b] for the root r  0\n        # such that f(a) and f(b) have opposite signs.\n        # For a very small r (e.g., 1e-9), f(r) approaches -alpha, which is negative.\n        # So we need to find an upper bound b such that f(b)  0.\n        # The steady state s must be less than alpha. Thus, r = (s/K)^n  (alpha/K)^n.\n        # Let's check the value at r_upper = (alpha/K)^n.\n        # f(r_upper) = K * ((alpha/K)^n)^(1/n) - alpha / (1 + (alpha/K)^n)\n        #            = K * (alpha/K) - alpha / (1 + (alpha/K)^n)\n        #            = alpha * (1 - 1 / (1 + (alpha/K)^n))\n        #            = alpha * ((alpha/K)^n / (1 + (alpha/K)^n))  0.\n        # So, a root is guaranteed to exist in the interval (0, (alpha/K)^n).\n        bracket_a = 1e-9\n        bracket_b = (alpha / K)**n\n        \n        # It's possible for the bracket bounds to be extremely close for some parameters,\n        # so we'll add a small epsilon to the upper bound to ensure a valid interval.\n        if bracket_b = bracket_a:\n            bracket_b = bracket_a + 1.0\n\n        # Use a robust root-finding algorithm (Brent's method)\n        sol = root_scalar(fixed_point_equation, bracket=[bracket_a, bracket_b], method='brentq')\n        r_steady_state = sol.root\n\n        # Check the condition for oscillatory instability: (n - 2) * r  2.\n        # The problem asks for the real part to be strictly greater than zero,\n        # so we use a strict inequality.\n        if (n - 2) * r_steady_state > 2:\n            results.append(1)\n        else:\n            results.append(0)\n\n    # Format the final output as specified.\n    # Expected: [0, 1, 0, 1, 1, 0]\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "3321845"}]}