{"hands_on_practices": [{"introduction": "在生物系统中，守恒定律（如总底物或总酶的浓度）为简化复杂的动力学模型提供了有力工具。本练习将指导您完成一个核心工作流程：利用守恒定律降低系统维度，然后通过构建和分析降维后系统的雅可比矩阵（Jacobian matrix）来评估其稳态的局部稳定性 [@problem_id:3351259]。掌握这一技能对于分析任何大规模生化反应网络都至关重要。", "problem": "考虑以下通过质量作用动力学建模的充分混合的酶促相互转化网络。底物 $S$ 与酶 $E$ 结合形成复合物 $C$，该复合物催化 $S$ 转化为产物 $P$ 并释放 $E$。产物 $P$ 通过一个独立的过程逆转化为 $S$。反应方案如下：\n$$\nS + E \\xrightleftharpoons[k_{2}]{k_{1}} C, \\quad C \\xrightarrow{k_{3}} P + E, \\quad P \\xrightarrow{k_{4}} S,\n$$\n其中 $k_{1}$、$k_{2}$、$k_{3}$ 和 $k_{4}$ 是正常数速率常数。令状态变量为浓度 $S(t)$、$P(t)$、$E(t)$ 和 $C(t)$，它们根据源自质量作用动力学的常微分方程 (ODE) 演化。在此封闭系统中，存在两个独立的守恒定律：\n$$\nS_{T} = S + P + C, \\quad E_{T} = E + C,\n$$\n其中 $S_{T}$ 和 $E_{T}$ 是正常数，分别代表底物和酶的总量。从质量作用动力学 ODE 和这两个守恒定律出发，消去两个变量，得到一个在坐标 $(S, C)$ 下的降阶二维 ODE 系统。将稳态 $(S^{*}, C^{*})$ 定义为降阶坐标中的一个点，在该点处两个降阶 ODE 的右侧项均为零。在计算系统生物学中，评估稳态的局部稳定性是通过对降阶动力学进行线性化并检验其在 $(S^{*}, C^{*})$ 处的雅可比矩阵来完成的。\n\n任务：\n- 利用守恒定律消去 $P$ 和 $E$，推导以变量 $(S, C)$ 表示的降阶 ODE 系统。\n- 从第一性原理出发，构建降阶系统在一般稳态 $(S^{*}, C^{*})$ 处的雅可比矩阵。\n- 陈述在降阶坐标中应如何评估局部稳定性，使用适用于二维系统的基本判据。\n- 提供雅可比矩阵两个特征值的单一闭式解析表达式，该表达式用 $k_{1}$、$k_{2}$、$k_{3}$、$k_{4}$、$E_{T}$ 以及稳态坐标 $(S^{*}, C^{*})$ 表示。您的最终答案必须是以紧凑解析表达式形式写出的一对特征值。\n\n不需要进行数值近似或四舍五入，最终答案中不应报告任何单位。", "solution": "所述问题具有科学依据、是适定的、客观且自洽的，是计算系统生物学中的一个标准问题。该问题没有任何科学或数学上的缺陷。因此，我将开始进行解答。\n\n第一步是根据给定反应网络的质量作用定律，写出描述物种 $S$、$P$、$E$ 和 $C$ 浓度随时间演化的常微分方程 (ODE) 系统：\n$$\nS + E \\xrightleftharpoons[k_{2}]{k_{1}} C, \\quad C \\xrightarrow{k_{3}} P + E, \\quad P \\xrightarrow{k_{4}} S\n$$\n相应的 ODE 如下：\n$$\n\\frac{dS}{dt} = -k_{1} S E + k_{2} C + k_{4} P\n$$\n$$\n\\frac{dP}{dt} = k_{3} C - k_{4} P\n$$\n$$\n\\frac{dE}{dt} = -k_{1} S E + k_{2} C + k_{3} C = -k_{1} S E + (k_{2} + k_{3}) C\n$$\n$$\n\\frac{dC}{dt} = k_{1} S E - k_{2} C - k_{3} C = k_{1} S E - (k_{2} + k_{3}) C\n$$\n问题指明了两个守恒定律：底物总量 $S_{T} = S + P + C$ 和酶总量 $E_{T} = E + C$。这使得我们可以将四维系统降至二维。我们消去变量 $P$ 和 $E$，用 $S$ 和 $C$ 表示：\n$$\nE(t) = E_{T} - C(t)\n$$\n$$\nP(t) = S_{T} - S(t) - C(t)\n$$\n将这些表达式代入 $S$ 和 $C$ 的 ODE，即可得到降阶系统。\n\n对于 $\\frac{dS}{dt}$：\n$$\n\\frac{dS}{dt} = -k_{1} S (E_{T} - C) + k_{2} C + k_{4} (S_{T} - S - C)\n$$\n$$\n\\frac{dS}{dt} = -k_{1} E_{T} S + k_{1} S C + k_{2} C + k_{4} S_{T} - k_{4} S - k_{4} C\n$$\n让我们将右侧项定义为 $f(S, C)$：\n$$\nf(S, C) = -k_{1} E_{T} S + k_{1} S C + (k_{2} - k_{4}) C - k_{4} S + k_{4} S_{T}\n$$\n对于 $\\frac{dC}{dt}$：\n$$\n\\frac{dC}{dt} = k_{1} S (E_{T} - C) - (k_{2} + k_{3}) C\n$$\n$$\n\\frac{dC}{dt} = k_{1} E_{T} S - k_{1} S C - (k_{2} + k_{3}) C\n$$\n让我们将右侧项定义为 $g(S, C)$：\n$$\ng(S, C) = k_{1} E_{T} S - k_{1} S C - (k_{2} + k_{3}) C\n$$\n因此，降阶 ODE 系统为：\n$$\n\\frac{dS}{dt} = f(S, C)\n$$\n$$\n\\frac{dC}{dt} = g(S, C)\n$$\n稳态 $(S^{*}, C^{*})$ 是一个变化率为零的点，即 $f(S^{*}, C^{*}) = 0$ 且 $g(S^{*}, C^{*}) = 0$。\n\n为分析稳态的局部稳定性，我们在 $(S^{*}, C^{*})$ 附近对系统进行线性化。这包括计算向量场 $(f, g)$ 的雅可比矩阵 $J$ 并在稳态点处对其求值。雅可比矩阵定义为：\n$$\nJ = \\begin{pmatrix} \\frac{\\partial f}{\\partial S} & \\frac{\\partial f}{\\partial C} \\\\ \\frac{\\partial g}{\\partial S} & \\frac{\\partial g}{\\partial C} \\end{pmatrix}\n$$\n我们从 $f(S, C)$ 和 $g(S, C)$ 的表达式中计算出四个偏导数：\n$$\n\\frac{\\partial f}{\\partial S} = -k_{1} E_{T} + k_{1} C - k_{4}\n$$\n$$\n\\frac{\\partial f}{\\partial C} = k_{1} S + k_{2} - k_{4}\n$$\n$$\n\\frac{\\partial g}{\\partial S} = k_{1} E_{T} - k_{1} C\n$$\n$$\n\\frac{\\partial g}{\\partial C} = -k_{1} S - (k_{2} + k_{3})\n$$\n在稳态 $(S^{*}, C^{*})$ 处对这些导数求值，得到该不动点处的雅可比矩阵：\n$$\nJ(S^{*}, C^{*}) = \\begin{pmatrix} -k_{1} E_{T} + k_{1} C^{*} - k_{4} & k_{1} S^{*} + k_{2} - k_{4} \\\\ k_{1} E_{T} - k_{1} C^{*} & -k_{1} S^{*} - k_{2} - k_{3} \\end{pmatrix}\n$$\n稳态的局部稳定性由该矩阵的特征值决定。对于一个二维系统，稳态是局部渐近稳定的，当且仅当两个特征值都具有负实部。这等价于 $2 \\times 2$ 矩阵的劳斯-赫尔维茨判据 (Routh-Hurwitz criteria)：\n$$\n\\mathrm{Tr}(J) < 0 \\quad \\text{and} \\quad \\mathrm{Det}(J) > 0\n$$\n其中 $\\mathrm{Tr}(J)$ 是雅可比矩阵的迹，$\\mathrm{Det}(J)$ 是其行列式。\n\n特征值 $\\lambda$ 是特征方程 $\\mathrm{det}(J - \\lambda I) = 0$ 的根，该方程可写为 $\\lambda^2 - \\mathrm{Tr}(J)\\lambda + \\mathrm{Det}(J) = 0$。其解可通过二次方程求根公式得到：\n$$\n\\lambda_{1,2} = \\frac{\\mathrm{Tr}(J) \\pm \\sqrt{\\mathrm{Tr}(J)^2 - 4\\mathrm{Det}(J)}}{2}\n$$\n我们现在使用其元素的推导表达式来计算 $J(S^{*}, C^{*})$ 的迹和行列式。我们使用记号 $E^{*} = E_{T} - C^{*}$ 表示稳态酶浓度。雅可比矩阵的元素可以写成：$J_{11} = -k_{1}E^{*} - k_4$, $J_{12} = k_1 S^* + k_2 - k_4$, $J_{21} = k_1 E^*$, $J_{22} = -k_1 S^* - k_2 - k_3$。\n\n迹为：\n$$\n\\mathrm{Tr}(J) = J_{11} + J_{22} = (-k_{1} (E_{T} - C^{*}) - k_{4}) + (-k_{1} S^{*} - k_{2} - k_{3})\n$$\n$$\n\\mathrm{Tr}(J) = -k_{1} S^{*} - k_{1}(E_{T} - C^{*}) - k_{2} - k_{3} - k_{4}\n$$\n行列式为：\n$$\n\\mathrm{Det}(J) = J_{11} J_{22} - J_{12} J_{21}\n$$\n$$\n\\mathrm{Det}(J) = (-k_{1}(E_{T}-C^{*}) - k_{4})(-k_{1} S^{*} - k_{2} - k_{3}) - (k_{1} S^{*} + k_{2} - k_{4})(k_{1}(E_{T}-C^{*}))\n$$\n展开此表达式：\n$$\n\\mathrm{Det}(J) = (k_{1}(E_{T}-C^{*}) + k_{4})(k_{1} S^{*} + k_{2} + k_{3}) - (k_{1} S^{*} + k_{2} - k_{4})(k_{1}(E_{T}-C^{*}))\n$$\n$$\n\\mathrm{Det}(J) = [k_{1}^{2}S^{*}(E_{T}-C^{*}) + k_{1}(E_{T}-C^{*})(k_{2}+k_{3}) + k_{1}k_{4}S^{*} + k_{4}(k_{2}+k_{3})] - [k_{1}^{2}S^{*}(E_{T}-C^{*}) + k_{1}k_{2}(E_{T}-C^{*}) - k_{1}k_{4}(E_{T}-C^{*})]\n$$\n经过消项和重新整理后：\n$$\n\\mathrm{Det}(J) = k_{1}(E_{T}-C^{*})k_{3} + k_{1}k_{4}S^{*} + k_{4}(k_{2}+k_{3}) + k_{1}k_{4}(E_{T}-C^{*})\n$$\n$$\n\\mathrm{Det}(J) = k_{1}(E_{T}-C^{*})(k_{3}+k_{4}) + k_{1}k_{4}S^{*} + k_{4}(k_{2}+k_{3})\n$$\n我们定义 $T = \\mathrm{Tr}(J)$ 和 $D = \\mathrm{Det}(J)$。两个特征值为：\n$$\n\\lambda_{1} = \\frac{T + \\sqrt{T^2 - 4D}}{2} \\quad \\text{and} \\quad \\lambda_{2} = \\frac{T - \\sqrt{T^2 - 4D}}{2}\n$$\n代入 $T$ 和 $D$ 的完整表达式：\n$$\nT = -k_{1} S^{*} - k_{1}(E_{T} - C^{*}) - k_{2} - k_{3} - k_{4}\n$$\n$$\nD = k_{1}(E_{T}-C^{*})(k_{3}+k_{4}) + k_{1}k_{4}S^{*} + k_{4}(k_{2}+k_{3})\n$$\n这些表达式给出了雅可比矩阵在稳态 $(S^{*}, C^{*})$ 处的特征值的完整解析形式。", "answer": "$$\n\\boxed{\n\\pmatrix{\n\\frac{T + \\sqrt{T^2 - 4D}}{2} & \\frac{T - \\sqrt{T^2 - 4D}}{2}\n}\n\\text{ 其中 }\nT = -k_{1} S^{*} - k_{1}(E_{T} - C^{*}) - k_{2} - k_{3} - k_{4}\n\\text{ 且 }\nD = k_{1}(E_{T}-C^{*})(k_{3}+k_{4}) + k_{1}k_{4}S^{*} + k_{4}(k_{2}+k_{3})\n}\n$$", "id": "3351259"}, {"introduction": "虽然雅可比矩阵特征值的负实部确保了系统的渐近稳定性，但这并非故事的全貌。本练习将探讨在生物学中普遍存在的“非正规”（non-normal）系统，在这类系统中，即使系统是稳定的，扰动也可能在衰减前被短暂地急剧放大 [@problem_id:3351305]。您将通过编程计算一系列指标，以捕捉这种瞬时行为，从而更深入地理解基因表达爆发等现象。", "problem": "考虑一个在稳态附近线性化的基因调控网络，得到一个用于描述小偏差 $x(t) \\in \\mathbb{R}^{n}$ 的线性时不变动力学系统，其形式为 $dx/dt = J x(t)$，其中 $J \\in \\mathbb{R}^{n \\times n}$ 是在稳态处求得的雅可比矩阵。在存在外在或内在波动的情况下，一个标准的线性随机模型会在此基础上增加一个加性白噪声输入，即 $dx/dt = J x(t) + \\eta(t)$，其中 $\\eta(t)$ 是零均值高斯白噪声，其协方差矩阵为 $Q = \\sigma^{2} I$，其中 $\\sigma^{2} \\in \\mathbb{R}_{>0}$ 是给定的噪声强度，$I$ 是单位矩阵。如果 $J$ 的所有特征值都具有严格为负的实部，则称该稳态是线性渐近稳定的。尽管系统是渐近稳定的，但 $J$ 的非正规性（即 $J$ 与其转置不可交换）可能导致扰动在衰减前发生瞬态放大。我们定义以下基于核心定义的量：\n\n- 谱横坐标为 $\\alpha(J) = \\max \\{\\Re(\\lambda) : \\lambda \\text{ is an eigenvalue of } J\\}$。\n- 数值横坐标为 $\\omega(J) = \\sup_{\\|x\\|_{2} = 1} \\Re(x^{\\top} J x)$，它等于在 $t = 0$ 时沿方向 $x$ 的欧几里得范数的瞬时对数增长率（其中 $\\|\\cdot\\|_{2}$ 表示欧几里得范数）。\n- 时间 $t \\ge 0$ 时的瞬态放大因子是 $G(t) = \\|e^{J t}\\|_{2}$，即矩阵指数的诱导矩阵2-范数。\n- 对于随机系统，当 $Q = \\sigma^{2} I$ 时，如果稳态是渐近稳定的，则平稳协方差 $P$ 满足连续时间李雅普诺夫方程 $J P + P J^{\\top} + Q = 0$。为了量化由耦合和非正规性引起的第一个基因表达中的潜在爆发性，定义一个基准解耦系统，其雅可比矩阵为 $J_{0} = \\mathrm{diag}(J)$，并令 $P_{0}$ 解方程 $J_{0} P_{0} + P_{0} J_{0}^{\\top} + Q = 0$。将第一个基因的爆发性指数定义为 $B = P_{11} / (P_{0})_{11}$，该指数比较了有耦合和无耦合情况下的稳态方差。\n\n任务：编写一个程序，对下面给出的每个测试用例，计算：\n- 一个布尔值，指示系统是否线性渐近稳定，即 $\\alpha(J) < 0$ 是否成立。\n- 上面定义的数值横坐标 $\\omega(J)$。\n- 在 $[0, T_{\\max}]$ 上使用具有 $N$ 个点的均匀时间网格计算出的最大瞬态放大 $G_{\\max} = \\max_{t \\in [0, T_{\\max}]} G(t)$，其中 $T_{\\max} = 10$ 且 $N = 2001$，以及在该网格上达到此最大值的最早时间 $t_{\\mathrm{peak}} \\in [0, T_{\\max}]$。\n- 上面定义的爆发性指数 $B$，前提是稳态协方差存在（即系统是渐近稳定的）。\n\n必须使用的基本出发点：\n- 光滑非线性系统在不动点附近的线性化产生 $dx/dt = J x$。\n- $dx/dt = J x$ 的解是 $x(t) = e^{J t} x(0)$。\n- 对于具有加性白噪声协方差 $Q$ 的稳定线性随机系统，平稳协方差 $P$ 满足 $J P + P J^{\\top} + Q = 0$。\n\n避免跳过基本推理的捷径；将您的算法决策基于这些标准事实和定义。\n\n测试套件：\n- 案例1：$J = \\begin{bmatrix} -1 & 0 \\\\ 0 & -2 \\end{bmatrix}$，$\\sigma^{2} = 1$。\n- 案例2：$J = \\begin{bmatrix} -1 & 10 \\\\ 0 & -2 \\end{bmatrix}$，$\\sigma^{2} = 1$。\n- 案例3：$J = \\begin{bmatrix} -1 & 2 \\\\ -2 & -1 \\end{bmatrix}$，$\\sigma^{2} = 1$。\n- 案例4：$J = \\begin{bmatrix} -0.1 & 1.5 \\\\ 0 & -0.2 \\end{bmatrix}$，$\\sigma^{2} = 0.5$。\n- 案例5：$J = \\begin{bmatrix} -1 & 15 & 0 \\\\ 0 & -2 & 15 \\\\ 0 & 0 & -3 \\end{bmatrix}$，$\\sigma^{2} = 1$。\n\n输出规范：\n- 对每个案例，输出一个包含五个条目的列表：$[\\text{stable}, \\omega, G_{\\max}, t_{\\mathrm{peak}}, B]$，其中 $\\text{stable}$ 是一个布尔值，$\\omega$、$G_{\\max}$、$t_{\\mathrm{peak}}$ 和 $B$ 是四舍五入到六位小数的实数。如果系统不是渐近稳定的，仅当李雅普诺夫方程的解存在时才计算 $B$ 的特殊值；否则，将 $B$ 定义为 $0.0$。\n- 您的程序应生成单行输出，其中包含所有案例的结果，形式为一个用方括号括起来的逗号分隔列表，例如 $[[\\text{stable}_{1}, \\omega_{1}, G_{\\max,1}, t_{\\mathrm{peak},1}, B_{1}], \\ldots, [\\text{stable}_{5}, \\omega_{5}, G_{\\max,5}, t_{\\mathrm{peak},5}, B_{5}]]$.\n\n输出中的所有数值量必须是纯数字（布尔值或实数），无单位，并且布尔值必须是字面值 True 或 False。角度（如果出现）必须以弧度为单位。不允许使用百分号；在需要时使用小数。", "solution": "该问题要求对几个线性时不变系统进行综合分析，这些系统是基因调控网络的线性化模型。分析涉及评估稳定性、量化瞬态行为以及表征存在噪声时的稳态波动。解决方案将通过对每个所需指标系统地应用线性系统理论和矩阵分析的基本原理来制定。\n\n**1. 线性渐近稳定性**\n\n动力学系统中稳态的稳定性由其对小扰动的响应来定义。对于给定的线性系统 $\\frac{dx}{dt} = J x(t)$，从稳态 $x=0$ 的扰动 $x(t)$ 的时间演化由 $x(t) = e^{Jt} x(0)$ 给出。当 $t \\to \\infty$ 时的长期行为由雅可比矩阵 $J$ 的特征值决定。解可以表示为形如 $p(t)e^{\\lambda t}$ 的模式的线性组合，其中 $\\lambda$ 是 $J$ 的特征值，如果 $\\lambda$ 的几何重数小于其代数重数，则 $p(t)$ 是 $t$ 的多项式。\n\n对于任意初始条件 $x(0)$，要使状态 $x(t)$ 衰减到零，所有这些模式都必须衰减。当且仅当 $J$ 的所有特征值 $\\lambda$ 都具有严格为负的实部，即 $\\Re(\\lambda) < 0$ 时，这一点才能得到保证。谱横坐标定义为 $\\alpha(J) = \\max \\{\\Re(\\lambda) : \\lambda \\text{ is an eigenvalue of } J\\}$，它为稳定性提供了一个简洁的判据。当且仅当其谱横坐标为负，即 $\\alpha(J) < 0$ 时，系统是线性渐近稳定的。\n\n计算步骤如下：\n1.  计算矩阵 $J$ 的所有特征值。\n2.  计算每个特征值的实部。\n3.  这些实部中的最大值即为谱横坐标 $\\alpha(J)$。\n4.  如果 $\\alpha(J) < 0$，则稳定性布尔标志设为 `True`，否则设为 `False`。\n\n**2. 数值横坐标**\n\n虽然谱横坐标决定了渐近衰减率，但扰动幅值的初始、瞬时行为由一个不同的量决定。在 $t=0$ 时，对于范数 $\\|x(0)\\|_2 = 1$ 的给定初始方向 $x(0)$，欧几里得范数 $\\|x(t)\\|_2$ 的瞬时对数增长率由下式给出：\n$$\n\\frac{d}{dt}\\ln(\\|x(t)\\|_2)\\Big|_{t=0} = \\Re(x(0)^{\\top} J x(0))\n$$\n由于 $x(0)$ 是实向量，这可以简化。我们首先注意到 $x^{\\top} J x$ 是一个标量，所以它等于其转置 $x^{\\top} J^{\\top} x$。因此，我们可以写成 $x^{\\top} J x = \\frac{1}{2}(x^{\\top} J x + x^{\\top} J^{\\top} x) = x^{\\top} \\left( \\frac{J + J^{\\top}}{2} \\right) x$。数值横坐标 $\\omega(J)$ 是该增长率在所有单位范数方向 $x(0)$ 上的上确界：\n$$\n\\omega(J) = \\sup_{\\|x\\|_{2} = 1} x^{\\top} \\left( \\frac{J + J^{\\top}}{2} \\right) x\n$$\n根据瑞利-里兹定理，这个上确界等于对称矩阵 $H = \\frac{J + J^{\\top}}{2}$ 的最大特征值。正的数值横坐标 $\\omega(J) > 0$ 表示存在初始扰动，其幅值会瞬时增加，即使系统是渐近稳定的（$\\alpha(J) < 0$）。\n\n计算步骤如下：\n1.  构建 $J$ 的对称部分：$H = \\frac{1}{2}(J + J^{\\top})$。\n2.  计算 $H$ 的特征值。由于 $H$ 是对称的，其特征值是实数。\n3.  数值横坐标 $\\omega(J)$ 是 $H$ 的最大特征值。\n\n**3. 最大瞬态放大**\n\n稳定但非正规系统中的瞬态增长现象由瞬态放大因子 $G(t) = \\|e^{Jt}\\|_2$ 来量化，其中 $\\|\\cdot\\|_2$ 是诱导2-范数（或谱范数）。该因子表示单位范数的初始条件在时间 $t$ 所能经历的最大放大倍数。对于正规矩阵 $J$（即与其转置可交换的矩阵，$JJ^{\\top} = J^{\\top}J$），有 $\\|e^{Jt}\\|_2 = e^{\\alpha(J)t}$。在这种情况下，如果系统是稳定的（$\\alpha(J)<0$），$G(t)$ 是一个单调递减函数，其最大值为 $G(0)=1$。然而，对于非正规矩阵，$G(t)$ 可能在最终衰减到0之前上升到1以上。\n\n为了找到最大放大 $G_{\\max}$ 及其发生的最早时间 $t_{\\mathrm{peak}}$，我们必须在指定的区间 $[0, T_{\\max}]$ 上评估 $G(t)$。由于通常无法获得最大值的解析表达式，我们在离散网格上进行数值搜索。\n\n计算步骤如下：\n1.  在区间 $[0, T_{\\max}=10]$ 上定义一个包含 $N=2001$ 个点的均匀间隔时间网格 $t_i$。\n2.  对于每个时间点 $t_i$：\n    a.  计算矩阵指数 $E_i = e^{Jt_i}$。\n    b.  计算 $E_i$ 的诱导2-范数 $G(t_i) = \\|E_i\\|_2$，这等同于其最大奇异值。\n3.  在所有计算出的 $G(t_i)$ 中找到最大值，以获得 $G_{\\max}$。\n4.  识别该最大值首次出现的索引，并从网格中找到相应的时间 $t_{\\mathrm{peak}}$。\n\n**4. 爆发性指数**\n\n对于噪声协方差为 $Q = \\sigma^2 I$ 的随机系统 $\\frac{dx}{dt} = J x(t) + \\eta(t)$，稳态协方差矩阵 $P = \\mathbb{E}[x(t) x(t)^{\\top}]$ 存在当且仅当系统是渐近稳定的。在此条件下，$P$ 是连续时间李雅普诺夫方程的唯一半正定解：\n$$\nJ P + P J^{\\top} + Q = 0\n$$\n对角元素 $P_{11}$ 是状态向量第一个分量的平稳方差，代表第一个基因的表达水平。\n\n为了量化网络耦合对该方差的贡献，我们将其与系统解耦的基准情景进行比较。解耦动力学由矩阵 $J_0 = \\mathrm{diag}(J)$ 控制，该矩阵仅保留网络的自调控项。该解耦系统的平稳协方差 $P_0$ 是其相应李雅普诺夫方程的解：\n$$\nJ_0 P_0 + P_0 J_0^{\\top} + Q = 0\n$$\n爆发性指数 $B$ 定义为耦合系统中第一个基因的方差与解耦系统中该方差的比值：\n$$\nB = \\frac{P_{11}}{(P_0)_{11}}\n$$\n$B>1$ 的值表示网络耦合放大了第一个基因的波动。如果系统不是渐近稳定的，则物理上不存在平稳协方差，爆发性指数定义为 $0.0$。\n\n计算步骤如下：\n1.  使用步骤1中的判据验证系统是否稳定。如果不稳定，则设置 $B=0.0$。\n2.  如果稳定，则构建噪声协方差矩阵 $Q = \\sigma^2 I$，其中 $I$ 是 $n \\times n$ 的单位矩阵。\n3.  使用数值求解器求解李雅普诺夫方程 $J P + P J^{\\top} = -Q$ 以得到矩阵 $P$。\n4.  构建解耦的雅可比矩阵 $J_0 = \\mathrm{diag}(J)$。\n5.  求解第二个李雅普诺夫方程 $J_0 P_0 + P_0 J_0^{\\top} = -Q$ 以得到矩阵 $P_0$。\n6.  计算爆发性指数 $B = P_{11} / (P_0)_{11}$。\n\n这种综合方法对给定的线性系统进行了多方面的表征，并遵循了问题陈述中概述的基本原则。", "answer": "```python\nimport numpy as np\nfrom scipy import linalg\n\ndef solve():\n    \"\"\"\n    Solves the problem for all specified test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (np.array([[-1.0, 0.0], [0.0, -2.0]]), 1.0),\n        (np.array([[-1.0, 10.0], [0.0, -2.0]]), 1.0),\n        (np.array([[-1.0, 2.0], [-2.0, -1.0]]), 1.0),\n        (np.array([[-0.1, 1.5], [0.0, -0.2]]), 0.5),\n        (np.array([[-1.0, 15.0, 0.0], [0.0, -2.0, 15.0], [0.0, 0.0, -3.0]]), 1.0)\n    ]\n\n    all_results = []\n    \n    for J, sigma_sq in test_cases:\n        result = compute_metrics(J, sigma_sq)\n        all_results.append(result)\n\n    # Format the final output string as specified\n    formatted_strings = []\n    for res in all_results:\n        stable = \"True\" if res[0] else \"False\"\n        # round all numeric values to 6 decimal places\n        omega = f\"{res[1]:.6f}\"\n        g_max = f\"{res[2]:.6f}\"\n        t_peak = f\"{res[3]:.6f}\"\n        b = f\"{res[4]:.6f}\"\n        formatted_strings.append(f\"[{stable},{omega},{g_max},{t_peak},{b}]\")\n    \n    final_output = f\"[{','.join(formatted_strings)}]\"\n    print(final_output)\n\ndef compute_metrics(J, sigma_sq):\n    \"\"\"\n    Computes all required metrics for a single test case.\n\n    Args:\n        J (np.ndarray): The Jacobian matrix.\n        sigma_sq (float): The noise strength.\n\n    Returns:\n        list: A list containing [stable, omega, G_max, t_peak, B].\n    \"\"\"\n    n = J.shape[0]\n\n    # 1. Linear Asymptotic Stability (Spectral Abscissa)\n    eigenvalues = linalg.eigvals(J)\n    spectral_abscissa = np.max(np.real(eigenvalues))\n    is_stable = spectral_abscissa  0\n\n    # 2. Numerical Abscissa\n    H = (J + J.T) / 2.0\n    # For a symmetric/Hermitian matrix, eigvals are real\n    # eigvalsh is specialized and more efficient for this\n    omega = np.max(linalg.eigvalsh(H))\n\n    # 3. Maximum Transient Amplification\n    T_max = 10.0\n    N = 2001\n    t_grid = np.linspace(0, T_max, N)\n    \n    G_values = []\n    for t in t_grid:\n        if t == 0:\n            # ||e^0||_2 = ||I||_2 = 1.0\n            norm_val = 1.0\n        else:\n            exp_Jt = linalg.expm(J * t)\n            norm_val = linalg.norm(exp_Jt, ord=2)\n        G_values.append(norm_val)\n\n    G_max = np.max(G_values)\n    # Get the index of the first occurrence of the maximum value\n    t_peak_idx = np.argmax(G_values)\n    t_peak = t_grid[t_peak_idx]\n\n    # 4. Burstiness Index\n    B = 0.0\n    if is_stable:\n        Q = sigma_sq * np.eye(n)\n        \n        # Full system covariance\n        # solve JP + PJ^T = -Q\n        P = linalg.solve_lyapunov(J, -Q)\n        \n        # Decoupled system covariance\n        J0 = np.diag(np.diag(J))\n        # solve J0*P0 + P0*J0^T = -Q\n        P0 = linalg.solve_lyapunov(J0, -Q)\n\n        P11 = P[0, 0]\n        P0_11 = P0[0, 0]\n        \n        # Avoid division by zero, though not expected in this problem for stable systems\n        if P0_11 != 0:\n            B = P11 / P0_11\n\n    return [is_stable, omega, G_max, t_peak, B]\n\nsolve()\n```", "id": "3351305"}, {"introduction": "基于瞬时放大的概念，本练习将引入一个强大的工具——伪谱（pseudospectrum），来评估系统稳定性的鲁棒性。您将实现一个算法，用以确定需要多大的扰动才能使一个稳定系统变得不稳定，这为定量衡量系统稳定性对噪声或模型不确定性的敏感度提供了一种方法 [@problem_id:3351292]。通过这个练习，您可以探索特征值分析在面对非正规系统时的局限性及其补充工具。", "problem": "考虑一个由形式为 $\\dot{x} = f(x)$ 的常微分方程组 (ODE) 建模的信号网络，其不动点 $x^\\ast$ 满足 $f(x^\\ast) = 0$。在 $x^\\ast$ 附近的动力学线性化得到 $\\dot{\\xi} = J \\xi$，其中 $J$ 是雅可比矩阵 $J = \\left.\\frac{\\partial f}{\\partial x}\\right|_{x^\\ast}$。在线性稳定性分析中，$J$ 的谱（特征值集合）决定了局部渐近稳定性：如果 $J$ 的所有特征值都具有严格为负的实部，则 $x^\\ast$ 是线性渐近稳定的。然而，对于非正规矩阵（在实数情况下满足 $J J^\\top \\neq J^\\top J$ 或在复数情况下满足 $J J^\\ast \\neq J^\\ast J$ 的矩阵），瞬态放大和噪声敏感性可能导致表观上的不稳定性，即使所有特征值都位于左半平面。\n\n$J$ 的 $\\epsilon$-伪谱，记作 $\\Lambda_\\epsilon(J)$，刻画了范数 $\\|\\Delta\\| \\le \\epsilon$ 的小扰动 $\\Delta$ 如何改变 $J$ 的特征值，从而可以预测噪声放大的瞬态行为。一个经典的定义是：$\\lambda \\in \\Lambda_\\epsilon(J)$ 当且仅当 $(\\lambda I - J)$ 的最小奇异值满足 $\\sigma_{\\min}(\\lambda I - J) \\le \\epsilon$。等价地，$\\Lambda_\\epsilon(J)$ 是所有 $\\lambda$ 的集合，其中 $\\lambda$ 是某个扰动矩阵 $J + \\Delta$（$\\|\\Delta\\| \\le \\epsilon$）的特征值，从而将伪谱与特征值位置在扰动下的鲁棒性联系起来。\n\n您的任务是，对于给定的雅可比矩阵 $J$，计算最小扰动幅度 $\\epsilon_\\star$，使得 $\\epsilon$-伪谱与闭右半平面 $\\{\\lambda \\in \\mathbb{C} : \\Re(\\lambda) \\ge 0\\}$ 相交。数学上，定义为\n$$\n\\epsilon_\\star(J) = \\min_{\\lambda \\in \\mathbb{C},\\; \\Re(\\lambda) \\ge 0} \\; \\sigma_{\\min}(\\lambda I - J).\n$$\n如果一个给定的 $\\epsilon$ 满足 $\\epsilon \\ge \\epsilon_\\star(J)$，那么存在一个范数 $\\|\\Delta\\| \\le \\epsilon$ 的扰动 $\\Delta$，使得 $J + \\Delta$ 至少有一个特征值 $\\lambda$ 满足 $\\Re(\\lambda) \\ge 0$，这表明存在表观不稳定性。\n\n实现一个程序，对每个测试用例，通过在限制于右半平面的复平面上的一个矩形网格上进行搜索，来近似计算 $\\epsilon_\\star(J)$，并计算网格上 $\\sigma_{\\min}(\\lambda I - J)$ 的最小值。使用一个均匀网格，其实部 $x$ 在区间 $[0, x_{\\max}]$ 上采样，虚部 $y$ 在区间 $[-y_{\\max}, y_{\\max}]$ 上采样。对于每个网格点 $\\lambda = x + i y$，计算 $\\sigma_{\\min}(\\lambda I - J)$，并将整个网格上的最小值作为 $\\epsilon_\\star(J)$ 的近似值。\n\n要求：\n- 使用信号网络线性化的基础：从 $\\dot{x} = f(x)$ 开始，定义不动点 $x^\\ast$，线性化为 $\\dot{\\xi} = J \\xi$，并按照上述伪谱的定义进行计算。\n- 计算必须是纯数学的。本问题不涉及任何物理单位。\n- 角度单位不适用。不应使用任何角度。\n- 对于每个测试用例，输出两个量：一个布尔值 $b$，表示所提供的 $\\epsilon$ 是否足以将特征值移动到虚轴的另一侧（即，是否 $\\epsilon \\ge \\epsilon_\\star(J)$），以及一个浮点数 $\\epsilon_\\star(J)$，四舍五入到6位小数。\n\n测试套件规范：\n- 使用以下参数集。每个测试用例由 $(J, \\epsilon, x_{\\max}, y_{\\max}, n_x, n_y)$ 指定，其中 $n_x$ 和 $n_y$ 分别是实部和虚部方向上的网格点数。\n    1. 情况 A（非正规，稳定，预计中等大小的 $\\epsilon$ 会导致穿越）：\n       $J_1 = \\begin{pmatrix} -1  100 \\\\ 0  -2 \\end{pmatrix}$, $\\epsilon = 0.1$, $x_{\\max} = 5$, $y_{\\max} = 50$, $n_x = 101$, $n_y = 401$.\n    2. 情况 B（正规，稳定，边界行为可见）：\n       $J_2 = \\begin{pmatrix} -1  0 \\\\ 0  -2 \\end{pmatrix}$, $\\epsilon = 0.5$, $x_{\\max} = 5$, $y_{\\max} = 50$, $n_x = 101$, $n_y = 401$.\n    3. 情况 C（非正规，弱稳定，靠近边界）：\n       $J_3 = \\begin{pmatrix} -0.1  5 \\\\ 0  -0.1 \\end{pmatrix}$, $\\epsilon = 0.15$, $x_{\\max} = 5$, $y_{\\max} = 50$, $n_x = 101$, $n_y = 401$.\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含三个测试用例的结果，形式为一个由方括号括起来的、逗号分隔的对列表。每个对的格式必须为 $[b,\\epsilon_\\star]$，其中 $b$ 为 $True$ 或 $False$，$\\epsilon_\\star$ 是一个四舍五入到6位的小数。例如，输出应如下所示：$[[True,0.012345],[False,1.000000],[True,0.098765]]$。", "solution": "该问题要求为给定的雅可比矩阵 $J$ 计算一个与稳定性相关的度量 $\\epsilon_\\star(J)$。该矩阵 $J$ 源于动力学系统 $\\dot{x} = f(x)$ 在其不动点 $x^\\ast$ 周围的线性化。这个度量 $\\epsilon_\\star(J)$ 代表了能将雅可比矩阵 $J$ 的一个特征值移动到复平面闭右半平面的最小扰动幅度（以矩阵2-范数衡量），而进入闭右半平面与稳定性的丧失相关联。\n\n待计算的量的数学定义是\n$$\n\\epsilon_\\star(J) = \\min_{\\lambda \\in \\mathbb{C},\\; \\Re(\\lambda) \\ge 0} \\; \\sigma_{\\min}(\\lambda I - J)\n$$\n其中 $\\sigma_{\\min}(A)$ 表示矩阵 $A$ 的最小奇异值，$I$ 是单位矩阵，最小值是在所有具有非负实部的复数 $\\lambda$ 上取得的。该值是右半平面中 $\\epsilon$-伪谱 $\\Lambda_\\epsilon(J)$ 的边界。如果给定的扰动容限 $\\epsilon$ 满足 $\\epsilon \\ge \\epsilon_\\star(J)$，则它足以引发潜在的不稳定性。\n\n问题指定了一种近似计算 $\\epsilon_\\star(J)$ 的算法：在右半平面的一个有限矩形区域上进行网格搜索。\n\n该算法流程如下：\n1.  **定义搜索网格**：构建一个由复数 $\\lambda = x + iy$ 组成的离散网格。该网格覆盖一个由 $x \\in [0, x_{\\max}]$ 和 $y \\in [-y_{\\max}, y_{\\max}]$ 定义的矩形区域。此区域在实轴上均匀采样 $n_x$ 个点，在虚轴上均匀采样 $n_y$ 个点。网格点由以下公式给出：\n    $$\n    x_j = j \\frac{x_{\\max}}{n_x - 1}, \\quad \\text{for } j = 0, 1, \\dots, n_x-1\n    $$\n    $$\n    y_k = -y_{\\max} + k \\frac{2 y_{\\max}}{n_y - 1}, \\quad \\text{for } k = 0, 1, \\dots, n_y-1\n    $$\n    网格上的每个点都是一个复数 $\\lambda_{jk} = x_j + i y_k$。\n\n2.  **迭代并计算奇异值**：对于网格上的每个点 $\\lambda_{jk}$，我们构造矩阵 $M_{jk} = \\lambda_{jk} I - J$。计算的核心是找到该矩阵的最小奇异值 $\\sigma_{\\min}(M_{jk})$。矩阵 $M$ 的奇异值是埃尔米特矩阵 $M^\\ast M$（其中 $M^\\ast$ 是 $M$ 的共轭转置）的特征值的平方根。在计算上，这通过标准的奇异值分解 (SVD) 算法来处理。\n\n3.  **找到最小值**：$\\epsilon_\\star(J)$ 的近似值是整个网格上所有计算出的最小奇异值中的最小值：\n    $$\n    \\epsilon_\\star(J) \\approx \\min_{j,k} \\sigma_{\\min}(\\lambda_{jk} I - J)\n    $$\n\n4.  **评估条件**：对于每个测试用例，都给出了一个特定的 $\\epsilon$ 值。我们将此值与计算出的 $\\epsilon_\\star(J)$ 的近似值进行比较。布尔值 $b$ 由条件 $b = (\\epsilon \\ge \\epsilon_\\star(J))$ 决定。根据伪谱分析，该布尔值指示给定的扰动水平 $\\epsilon$ 是否足以将一个特征值穿过虚轴移动到右半平面。\n\n将此过程应用于所提供的三个测试用例中的每一个：\n-   **情况 A**：$J_1 = \\begin{pmatrix} -1  100 \\\\ 0  -2 \\end{pmatrix}$。这是一个非正规矩阵，因为 $J_1 J_1^\\top \\neq J_1^\\top J_1$。其特征值为 $\\lambda_1 = -1$ 和 $\\lambda_2 = -2$。尽管系统是稳定的，但大的非对角元素（$100$）在小扰动下可能导致显著的特征值位移，因此预计 $\\epsilon_\\star(J_1)$ 会很小。\n\n-   **情况 B**：$J_2 = \\begin{pmatrix} -1  0 \\\\ 0  -2 \\end{pmatrix}$。这是一个正规矩阵（$J_2 J_2^\\top = J_2^\\top J_2$）。对于正规矩阵，$\\epsilon$-伪谱由围绕每个特征值的半径为 $\\epsilon$ 的圆盘组成。从特征值（$-1$ 和 $-2$）到右半平面（其中 $\\Re(\\lambda) \\ge 0$）的最小距离是从 $-1$ 到 $0$ 的距离，恰好为 $1$。因此，我们预计 $\\epsilon_\\star(J_2) = 1$。\n\n-   **情况 C**：$J_3 = \\begin{pmatrix} -0.1  5 \\\\ 0  -0.1 \\end{pmatrix}$。这是一个非正规矩阵，其两个特征值都位于 $-0.1$。特征值与虚轴的邻近性，加上其非正规性，表明即使是一个小扰动也可能将一个特征值移动到右半平面。我们预计 $\\epsilon_\\star(J_3)$ 将小于特征值到虚轴的距离，即 $0.1$。\n\n在实现上，向量化方法非常高效。可以创建一个表示 $\\lambda$ 值网格的多维数组。然后，利用数组广播机制，可以构建一个 $\\lambda I - J$ 矩阵的堆栈。一个向量化的 SVD 函数可以同时为这整个矩阵堆栈计算奇异值，之后找到全局最小值就变得很简单了。\n每个情况的最终结果将是一个对：布尔值 $b$ 和计算出的 $\\epsilon_\\star(J)$ 值（四舍五入到6位小数）。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the minimum perturbation magnitude epsilon_star for a set of Jacobian\n    matrices by performing a grid search over the right half of the complex plane.\n    \"\"\"\n    \n    # Test suite specification:\n    # Each test case is a tuple: (J, epsilon, x_max, y_max, n_x, n_y)\n    test_cases = [\n        # Case A\n        (np.array([[-1, 100], [0, -2]]), 0.1, 5, 50, 101, 401),\n        # Case B\n        (np.array([[-1, 0], [0, -2]]), 0.5, 5, 50, 101, 401),\n        # Case C\n        (np.array([[-0.1, 5], [0, -0.1]]), 0.15, 5, 50, 101, 401),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        J, epsilon, x_max, y_max, n_x, n_y = case\n        \n        # 1. Define the search grid in the complex plane\n        # Real part: [0, x_max]\n        real_axis = np.linspace(0, x_max, n_x) \n        # Imaginary part: [-y_max, y_max]\n        imag_axis = np.linspace(-y_max, y_max, n_y)\n        \n        # Create a grid of complex numbers lambda = x + iy\n        # lambda_grid has shape (n_x, n_y)\n        lambda_grid = real_axis[:, np.newaxis] + 1j * imag_axis[np.newaxis, :]\n        \n        # 2. Vectorized computation of singular values\n        # Get the dimension of the Jacobian\n        dim = J.shape[0]\n        \n        # Create an identity matrix of the same dimension\n        identity = np.identity(dim)\n        \n        # Construct a stack of matrices M = lambda * I - J for all lambda in the grid.\n        # Reshape lambda_grid to (n_x, n_y, 1, 1) for broadcasting with (dim, dim) matrices.\n        # M_stack will have shape (n_x, n_y, dim, dim)\n        M_stack = lambda_grid[:, :, np.newaxis, np.newaxis] * identity - J\n        \n        # Compute the singular values for the entire stack of matrices.\n        # `np.linalg.svd` with `compute_uv=False` is efficient as it only returns singular values.\n        # The output 's' will have shape (n_x, n_y, dim).\n        singular_values = np.linalg.svd(M_stack, compute_uv=False)\n        \n        # 3. Find the minimum smallest singular value\n        # For each matrix in the stack, find its smallest singular value (min over the last axis).\n        # This gives a grid of sigma_min values with shape (n_x, n_y).\n        min_singular_values_grid = np.min(singular_values, axis=2)\n        \n        # The approximation of epsilon_star is the minimum value in this grid.\n        epsilon_star = np.min(min_singular_values_grid)\n        \n        # 4. Evaluate the condition and store the results\n        # Determine if the given epsilon is sufficient to cause instability\n        is_sufficient = epsilon >= epsilon_star\n        \n        # Append the pair [boolean, rounded epsilon_star] to results a list for later formatting\n        results.append((is_sufficient, epsilon_star))\n\n    # Final print statement in the exact required format.\n    # Format each result pair as a string '[b,eps_star]' and join them.\n    formatted_results = [f\"[{'True' if b else 'False'},{eps:.6f}]\" for b, eps in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3351292"}]}