{"hands_on_practices": [{"introduction": "我们将从酶动力学的基石——Michaelis-Menten 模型开始。这项练习将引导你建立动力学方程，检查量纲一致性，并利用无量纲化在准稳态假设下推导出经典的归一化速率定律，旨在培养模型构建和简化的基本技能。[@problem_id:3302218]", "problem": "考虑在充分混合的反应室中，根据质量作用定律进行的单底物催化反应：$E + S \\rightleftharpoons ES \\to E + P$，其中$E$是游离酶，$S$是底物，$ES$是酶-底物复合物，$P$是产物。令$E(t)$、$S(t)$、$ES(t)$和$P(t)$表示各物质浓度随时间$t$变化的函数。设$E+S\\to ES$的结合基元速率常数为$k_{1}$，$ES\\to E+S$的解离基元速率常数为$k_{-1}$，$ES\\to E+P$的催化转换基元速率常数为$k_{\\mathrm{cat}}$。假设酶守恒$E_{\\mathrm{tot}} = E(t) + ES(t)$，其中$E_{\\mathrm{tot}}$为常数。用基元速率常数定义米氏常数$K_{M}$。使用国际单位制（SI），浓度单位为$\\mathrm{mol}\\,\\mathrm{L}^{-1}$，时间单位为$\\mathrm{s}$。\n任务：\n1. 使用质量作用定律，写出$E(t)$、$S(t)$、$ES(t)$和$P(t)$的常微分方程（ODE）。\n2. 进行量纲分析，确定$k_{1}$、$k_{-1}$、$k_{\\mathrm{cat}}$和$K_{M}$的单位。验证每个速率定律中的每一项都具有一致的量纲。\n3. 引入以下无量纲化：选择底物尺度$K_{M}$、酶尺度$E_{\\mathrm{tot}}$和时间尺度$1/k_{\\mathrm{cat}}$，并定义无量纲变量$\\sigma = S/K_{M}$、$e = E/E_{\\mathrm{tot}}$、$c = ES/E_{\\mathrm{tot}}$和$\\tau = k_{\\mathrm{cat}} t$。\n4. 在米氏-门顿（MM）动力学的准稳态假设（QSSA）条件下（该假设由一个很小的参数，如$E_{\\mathrm{tot}}/(K_{M}+S_{0}) \\ll 1$来证明其合理性，其中$S_{0}$是初始底物浓度），推导无量纲的归一化产物生成速率$v^{*}(\\sigma) = v/(k_{\\mathrm{cat}} E_{\\mathrm{tot}})$作为$\\sigma$的闭合形式函数，其中$v = dP/dt$是产物生成速率。\n将$v^{*}(\\sigma)$作为你的最终答案。最终答案必须是一个没有单位的单一闭合形式解析表达式。", "solution": "该问题陈述经过严格验证，被认为是科学有据、问题明确且客观的。它为酶动力学中的一个标准问题提供了完整且一致的设置。未发现任何缺陷。解题过程如下。\n\n反应机理为$E + S \\rightleftharpoons ES \\to E + P$，正向速率常数为$k_1$，逆向速率常数为$k_{-1}$，催化速率常数为$k_{\\mathrm{cat}}$。\n\n**1. 常微分方程组 (ODEs)**\n\n将质量作用定律应用于反应网络，我们可以写出物质$E(t)$、$S(t)$、$ES(t)$和$P(t)$浓度的时间演化方程。各反应步骤的速率为：\n- 结合 $E+S\\to ES$: $v_1 = k_1 E(t) S(t)$\n- 解离 $ES\\to E+S$: $v_{-1} = k_{-1} ES(t)$\n- 催化 $ES\\to E+P$: $v_{\\mathrm{cat}} = k_{\\mathrm{cat}} ES(t)$\n\n每种物质浓度的净变化速率是生成它的反应速率之和减去消耗它的反应速率之和。\n\n$$ \\frac{dE}{dt} = -v_1 + v_{-1} + v_{\\mathrm{cat}} = -k_1 E(t)S(t) + (k_{-1} + k_{\\mathrm{cat}})ES(t) $$\n$$ \\frac{dS}{dt} = -v_1 + v_{-1} = -k_1 E(t)S(t) + k_{-1}ES(t) $$\n$$ \\frac{dES}{dt} = v_1 - v_{-1} - v_{\\mathrm{cat}} = k_1 E(t)S(t) - (k_{-1} + k_{\\mathrm{cat}})ES(t) $$\n$$ \\frac{dP}{dt} = v_{\\mathrm{cat}} = k_{\\mathrm{cat}}ES(t) $$\n\n问题陈述了总酶守恒，$E_{\\mathrm{tot}} = E(t) + ES(t)$。对此式对时间$t$求导，得到$\\frac{dE_{\\mathrm{tot}}}{dt} = \\frac{dE}{dt} + \\frac{dES}{dt}$。将推导出的$E$和$ES$的ODE相加，可以证实这一点：$\\frac{dE}{dt} + \\frac{dES}{dt} = [-k_1 E S + (k_{-1} + k_{\\mathrm{cat}})ES] + [k_1 E S - (k_{-1} + k_{\\mathrm{cat}})ES] = 0$。\n\n**2. 量纲分析**\n\n令$[X]$表示物理量$X$的量纲。浓度单位为摩尔/升，我们用量纲符号$C = \\mathrm{mol}\\,\\mathrm{L}^{-1}$表示。时间单位为秒，用$T = \\mathrm{s}$表示。浓度变化率的量纲为$C/T$。\n\n- 从$dP/dt$方程中的$k_{\\mathrm{cat}}ES(t)$项，我们有$[k_{\\mathrm{cat}}][ES] = C/T$。由于$[ES] = C$，因此$[k_{\\mathrm{cat}}] = T^{-1}$。\n- 类似地，从$dS/dt$方程中的$k_{-1}ES(t)$项，我们有$[k_{-1}][ES] = C/T$，得出$[k_{-1}] = T^{-1}$。\n- 从$dS/dt$方程中的$k_1 E(t)S(t)$项，我们有$[k_1][E][S] = C/T$。由于$[E] = [S] = C$，我们有$[k_1]C^2 = C/T$，得出$[k_1] = C^{-1}T^{-1}$。\n- 米氏常数定义为$K_M = \\frac{k_{-1} + k_{\\mathrm{cat}}}{k_1}$。其量纲为$[K_M] = \\frac{[k_{-1}] + [k_{\\mathrm{cat}}]}{[k_1]}$。由于$k_{-1}$和$k_{\\mathrm{cat}}$具有相同的量纲$T^{-1}$，它们的和的量纲也为$T^{-1}$。因此，$[K_M] = \\frac{T^{-1}}{C^{-1}T^{-1}} = C$。\n\n因此，单位为：\n- $k_1$: $\\mathrm{L}\\,\\mathrm{mol}^{-1}\\,\\mathrm{s}^{-1}$\n- $k_{-1}$: $\\mathrm{s}^{-1}$\n- $k_{\\mathrm{cat}}$: $\\mathrm{s}^{-1}$\n- $K_M$: $\\mathrm{mol}\\,\\mathrm{L}^{-1}$\n\n量纲一致性得到验证，因为每个ODE中的每一项的量纲都为$C/T$。\n\n**3. 无量纲化**\n\n我们引入问题中定义的无量纲变量和特征尺度：\n- 时间: $\\tau = k_{\\mathrm{cat}} t \\implies t = \\tau / k_{\\mathrm{cat}}$\n- 底物浓度: $\\sigma(\\tau) = S(t)/K_M \\implies S(t) = K_M \\sigma(\\tau)$\n- 酶-复合物浓度: $c(\\tau) = ES(t)/E_{\\mathrm{tot}} \\implies ES(t) = E_{\\mathrm{tot}}c(\\tau)$\n- 游离酶浓度: $e(\\tau) = E(t)/E_{\\mathrm{tot}} \\implies E(t) = E_{\\mathrm{tot}}e(\\tau)$\n\n酶守恒定律$E(t) + ES(t) = E_{\\mathrm{tot}}$变为$E_{\\mathrm{tot}}e(\\tau) + E_{\\mathrm{tot}}c(\\tau) = E_{\\mathrm{tot}}$，简化为无量纲形式$e(\\tau) + c(\\tau) = 1$。\n\n**4. 准稳态假设下无量纲速率的推导**\n\n为了推导归一化速率$v^*(\\sigma)$，我们首先对酶-底物复合物$ES$的ODE进行无量纲化。\n$$ \\frac{dES}{dt} = k_1 E(t)S(t) - (k_{-1} + k_{\\mathrm{cat}})ES(t) $$\n代入无量纲变量的定义：\n$$ \\frac{d(E_{\\mathrm{tot}}c)}{d(\\tau/k_{\\mathrm{cat}})} = k_1 (E_{\\mathrm{tot}}e)(K_M\\sigma) - (k_{-1} + k_{\\mathrm{cat}})(E_{\\mathrm{tot}}c) $$\n使用链式法则，$\\frac{d}{dt} = \\frac{d\\tau}{dt}\\frac{d}{d\\tau} = k_{\\mathrm{cat}}\\frac{d}{d\\tau}$：\n$$ E_{\\mathrm{tot}}k_{\\mathrm{cat}} \\frac{dc}{d\\tau} = k_1 E_{\\mathrm{tot}} K_M e \\sigma - (k_{-1} + k_{\\mathrm{cat}}) E_{\\mathrm{tot}} c $$\n两边除以$E_{\\mathrm{tot}}k_{\\mathrm{cat}}$：\n$$ \\frac{dc}{d\\tau} = \\frac{k_1 K_M}{k_{\\mathrm{cat}}} e \\sigma - \\frac{k_{-1} + k_{\\mathrm{cat}}}{k_{\\mathrm{cat}}} c $$\n代入$e = 1 - c$和$K_M = (k_{-1} + k_{\\mathrm{cat}})/k_1$的定义。项$\\frac{k_1 K_M}{k_{\\mathrm{cat}}} = \\frac{k_1}{k_{\\mathrm{cat}}} \\frac{k_{-1}+k_{\\mathrm{cat}}}{k_1} = \\frac{k_{-1} + k_{\\mathrm{cat}}}{k_{\\mathrm{cat}}}$。\n$$ \\frac{dc}{d\\tau} = \\frac{k_{-1} + k_{\\mathrm{cat}}}{k_{\\mathrm{cat}}} (1-c) \\sigma - \\frac{k_{-1} + k_{\\mathrm{cat}}}{k_{\\mathrm{cat}}} c $$\n$$ \\frac{dc}{d\\tau} = \\frac{k_{-1} + k_{\\mathrm{cat}}}{k_{\\mathrm{cat}}} \\left[ (1-c)\\sigma - c \\right] $$\n$$ \\frac{dc}{d\\tau} = \\frac{k_{-1} + k_{\\mathrm{cat}}}{k_{\\mathrm{cat}}} \\left[ \\sigma - c(\\sigma+1) \\right] $$\n当中间复合物$ES$的浓度变化时间尺度远快于底物$S$时，准稳态假设（QSSA）成立。这个条件，以$E_{\\mathrm{tot}}/(K_M+S_0) \\ll 1$的形式给出，允许我们将快变量的时间导数设为零。在有量纲的情况下，$\\frac{dES}{dt} \\approx 0$。在无量纲的情况下，这对应于$\\frac{dc}{d\\tau} \\approx 0$。\n将QSSA应用于$c$的无量纲方程：\n$$ 0 \\approx \\frac{k_{-1} + k_{\\mathrm{cat}}}{k_{\\mathrm{cat}}} \\left[ \\sigma - c_{qss}(\\sigma+1) \\right] $$\n其中$c_{qss}$是$c$的准稳态值。由于前置因子非零，括号中的项必须为零：\n$$ \\sigma - c_{qss}(\\sigma+1) = 0 $$\n$$ \\sigma = c_{qss}(\\sigma+1) $$\n解出$c_{qss}$，得到无量纲复合物浓度作为无量纲底物浓度的函数：\n$$ c_{qss}(\\sigma) = \\frac{\\sigma}{1+\\sigma} $$\n产物生成速率为$v = dP/dt = k_{\\mathrm{cat}}ES(t)$。问题要求无量纲归一化速率$v^{*}(\\sigma) = v/(k_{\\mathrm{cat}} E_{\\mathrm{tot}})$。\n$$ v^{*} = \\frac{k_{\\mathrm{cat}}ES(t)}{k_{\\mathrm{cat}}E_{\\mathrm{tot}}} = \\frac{ES(t)}{E_{\\mathrm{tot}}} $$\n根据定义，$c = ES(t)/E_{\\mathrm{tot}}$。因此，$v^{*} = c$。\n在QSSA下，速率由准稳态复合物浓度决定：\n$$ v^{*}(\\sigma) = c_{qss}(\\sigma) = \\frac{\\sigma}{1+\\sigma} $$\n这是无量纲形式的归一化米氏方程。", "answer": "$$ \\boxed{\\frac{\\sigma}{1+\\sigma}} $$", "id": "3302218"}, {"introduction": "在 Michaelis-Menten 框架的基础上，这项练习专注于动力学方程本身的求解。通过适当地缩放变量，你将看到一个看似复杂的微分方程如何转化为一个通用的、无参数的形式，从而揭示降解过程潜在的数学结构和普适原理。[@problem_id:3302254]", "problem": "一个单底物酶降解过程由米氏速率定律（Michaelis-Menten rate law）建模，该定律假定底物的瞬时消耗速率取决于底物浓度和酶参数。设底物浓度表示为 $S(t)$，最大反应速率为 $V_{\\max}$，米氏常数（Michaelis-Menten constant）为 $K_{M}$。$S(t)$ 的时间演化由以下常微分方程（ODE）决定：$$\\frac{dS}{dt}=-\\frac{V_{\\max} S}{K_{M}+S},$$ 初始条件为 $S(0)=S_{0}>0$。使用量纲分析，确定特征尺度并进行无量纲化，从而使模型呈现为一种不依赖于浓度和时间绝对单位的通用形式。具体而言，通过用 $K_{M}$ 缩放 $S$ 来引入无量纲浓度 $s$，并通过用 $K_{M}/V_{\\max}$ 缩放 $t$ 来引入无量纲时间 $\\tau$。从给定的ODE和初始条件出发，推导出最终的无量纲ODE并求解，以获得通用无量纲衰减轨迹 $s(\\tau)$ 的闭式解析表达式。您的最终答案必须是 $s(\\tau)$ 的单个解析表达式，用无量纲初始条件 $s_{0}=S_{0}/K_{M}$ 和无量纲时间 $\\tau$ 表示。不需要进行数值计算，也无需四舍五入。答案需用朗伯W函数（Lambert $W$ function）表示，其隐式定义为 $W(z)\\exp(W(z))=z$。", "solution": "首先对问题陈述进行验证，以确保其在科学上是合理的、适定的和客观的。\n\n**步骤1：提取已知条件**\n- 控制ODE：$\\frac{dS}{dt}=-\\frac{V_{\\max} S}{K_{M}+S}$\n- 初始条件：$S(0)=S_{0}>0$\n- 无量纲变量的定义：\n  - 无量纲浓度：$s = \\frac{S}{K_{M}}$\n  - 无量纲时间：$\\tau = \\frac{t}{K_{M}/V_{\\max}} = \\frac{t V_{\\max}}{K_{M}}$\n- 所需工具：解必须用朗伯W函数表示，其定义为 $W(z)\\exp(W(z))=z$。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据：** 该问题使用米氏速率定律描述底物降解，这是酶动力学和系统生物学中一个基本且被广泛接受的模型。给定的控制ODE是该过程的标准数学表示。这在科学上是合理的。\n- **适定性：** 该问题提供了一个带初始条件的一阶常微分方程，构成了一个适定的初值问题。关于无量纲化和求解的说明清晰明确。\n- **客观性：** 问题陈述使用了精确的数学和科学语言，没有主观性或含糊之处。\n- **完备性与一致性：** 所有必要信息均已提供，包括模型方程、初始状态、缩放定义以及解的所需形式（使用朗伯W函数）。已知条件是自洽的。\n\n**步骤3：结论与行动**\n该问题是有效的。这是一个数学生物学中的标准、适定的问题。可以开始求解过程。\n\n**求解推导**\n目标是对给定的ODE进行无量纲化，并求解得到的无量纲方程。\n\n首先，我们将原始变量 $S$ 和 $t$ 用无量纲变量 $s$ 和 $\\tau$ 表示：\n由 $s = S/K_{M}$，我们得到 $S = s K_{M}$。\n由 $\\tau = t V_{\\max}/K_{M}$，我们得到 $t = \\tau K_{M}/V_{\\max}$。\n\n接下来，我们使用链式法则变换导数 $\\frac{dS}{dt}$：\n$$\n\\frac{dS}{dt} = \\frac{dS}{ds} \\frac{ds}{d\\tau} \\frac{d\\tau}{dt}\n$$\n我们计算链式法则表达式中的每一项：\n- $\\frac{dS}{ds} = \\frac{d}{ds}(s K_{M}) = K_{M}$\n- $\\frac{d\\tau}{dt} = \\frac{d}{dt}\\left(\\frac{t V_{\\max}}{K_{M}}\\right) = \\frac{V_{\\max}}{K_{M}}$\n\n将这些代入链式法则表达式，得到：\n$$\n\\frac{dS}{dt} = K_{M} \\cdot \\frac{ds}{d\\tau} \\cdot \\frac{V_{\\max}}{K_{M}} = V_{\\max} \\frac{ds}{d\\tau}\n$$\n\n现在，我们将 $S$ 和 $\\frac{dS}{dt}$ 的表达式代入原始ODE：\n$$\nV_{\\max} \\frac{ds}{d\\tau} = -\\frac{V_{\\max} (s K_{M})}{K_{M} + (s K_{M})}\n$$\n我们可以从右侧分母中提取因子 $K_{M}$：\n$$\nV_{\\max} \\frac{ds}{d\\tau} = -\\frac{V_{\\max} s K_{M}}{K_{M}(1 + s)}\n$$\n$V_{\\max}$ 和 $K_{M}$ 项消去：\n$$\n\\frac{ds}{d\\tau} = -\\frac{s}{1+s}\n$$\n这就是无量纲ODE。\n\n我们还需要变换初始条件。在 $t=0$ 时，有 $\\tau=0$。初始条件 $S(0)=S_{0}$ 变为：\n$$\ns(0) = \\frac{S(0)}{K_{M}} = \\frac{S_{0}}{K_{M}}\n$$\n我们将此无量纲初始条件记为 $s_{0} = S_{0}/K_{M}$。完整的无量纲初值问题是：\n$$\n\\frac{ds}{d\\tau} = -\\frac{s}{1+s}, \\quad s(0) = s_{0}\n$$\n\n这是一个可分离的一阶ODE。我们重排方程以分离变量 $s$ 和 $\\tau$：\n$$\n\\frac{1+s}{s} ds = -d\\tau\n$$\n$$\n\\left(\\frac{1}{s} + 1\\right) ds = -d\\tau\n$$\n我们对两边进行积分。左边从初始浓度 $s_{0}$ 积分到时间 $\\tau$ 时的浓度 $s(\\tau)$，右边从时间 $0$ 积分到 $\\tau$：\n$$\n\\int_{s_{0}}^{s(\\tau)} \\left(\\frac{1}{u} + 1\\right) du = \\int_{0}^{\\tau} (-1) d\\tau'\n$$\n计算积分得出：\n$$\n[\\ln|u| + u]_{s_{0}}^{s(\\tau)} = [-\\tau']_{0}^{\\tau}\n$$\n因为底物浓度 $S$ 以及因此的无量纲浓度 $s$ 必须为非负值，所以我们可以去掉绝对值符号，即 $\\ln|u|=\\ln(u)$。\n$$\n(\\ln(s(\\tau)) + s(\\tau)) - (\\ln(s_{0}) + s_{0}) = -\\tau\n$$\n重排各项以分离出包含 $s(\\tau)$ 的表达式：\n$$\n\\ln(s(\\tau)) + s(\\tau) = \\ln(s_{0}) + s_{0} - \\tau\n$$\n为了求解 $s(\\tau)$，我们必须使用朗伯W函数，其属性定义为 $W(z) \\exp(W(z)) = z$。我们可以变换我们的方程以符合这种形式。设 $C = \\ln(s_{0}) + s_{0} - \\tau$。方程为 $\\ln(s) + s = C$。\n对两边取指数：\n$$\n\\exp(\\ln(s) + s) = \\exp(C)\n$$\n$$\n\\exp(\\ln(s)) \\cdot \\exp(s) = \\exp(C)\n$$\n$$\ns \\exp(s) = \\exp(C)\n$$\n该方程的形式为 $y \\exp(y) = x$，其中 $y=s$ 且 $x=\\exp(C)$。解为 $y = W(x)$，即 $s = W(\\exp(C))$。\n将 $C$ 的表达式代回：\n$$\ns(\\tau) = W\\left( \\exp(\\ln(s_{0}) + s_{0} - \\tau) \\right)\n$$\n我们可以简化 $W$ 函数的参数：\n$$\n\\exp(\\ln(s_{0}) + s_{0} - \\tau) = \\exp(\\ln(s_{0})) \\cdot \\exp(s_{0}) \\cdot \\exp(-\\tau) = s_{0} \\exp(s_{0}) \\exp(-\\tau) = s_{0} \\exp(s_{0} - \\tau)\n$$\n因此，最终的通用无量纲衰减轨迹是：\n$$\ns(\\tau) = W(s_{0} \\exp(s_{0} - \\tau))\n$$\n此表达式给出了任意无量纲时间 $\\tau$ 下的无量纲浓度 $s$，用无量纲初始条件 $s_{0}$ 表示。", "answer": "$$\\boxed{W(s_{0} \\exp(s_{0} - \\tau))}$$", "id": "3302254"}, {"introduction": "现在，我们将这些技术应用于一个更复杂且具有重要生物学意义的系统：基因触发开关。这项练习要求你对一个模拟基因相互抑制的耦合非线性系统进行无量纲化，并使用计算方法寻找其稳态并分析其稳定性，从而将分析理论与计算实践联系起来，深入理解双稳态行为的产生机制。[@problem_id:3302286]", "problem": "考虑一个具有相互抑制作用的双基因转换开关，其中基因 $X$ 产生蛋白质 $x(t)$，基因 $Y$ 产生蛋白质 $y(t)$。每种蛋白质的产生都通过希尔抑制函数被另一种蛋白质所抑制，且降解为一阶反应。设物理参数为：最大产生速率 $\\alpha_x$ 和 $\\alpha_y$（单位为 $\\mu\\mathrm{M}/\\mathrm{min}$），解离常数 $K_x$ 和 $K_y$（单位为 $\\mu\\mathrm{M}$），降解速率常数 $\\gamma_x$ 和 $\\gamma_y$（单位为 $\\mathrm{min}^{-1}$），以及希尔指数 $m$ 和 $n$（无量纲）。其动力学由以下耦合常微分方程组（ODEs）建模：\n$$\n\\frac{dx}{dt} = \\frac{\\alpha_x}{1 + \\left(\\frac{y}{K_y}\\right)^n} - \\gamma_x x, \\quad \n\\frac{dy}{dt} = \\frac{\\alpha_y}{1 + \\left(\\frac{x}{K_x}\\right)^m} - \\gamma_y y.\n$$\n您的任务是：\n- 从上述有量纲模型出发，仅使用希尔抑制函数和一阶降解的定义，通过定义标度化浓度 $\\bar{x} = x/K_x$ 和 $\\bar{y} = y/K_y$ 以及标度化时间 $\\tau = \\gamma_x t$ 来进行无量纲化。推导无量纲常微分方程组，并明确指出控制稳态及其稳定性的最小无量纲参数组。避免使用任何未从这些定义中推导出的快捷公式。\n- 实现一个算法，通过以下步骤确定给定物理参数集的线性稳定稳态数量：(i) 根据物理参数计算无量纲参数组，(ii) 找出无量纲系统的所有非负稳态，以及 (iii) 在每个稳态处通过雅可比矩阵的特征值评估线性稳定性。两个特征值均具有负实部表示线性稳定。将每个测试用例的线性稳定稳态数量表示为一个整数。\n- 单位：给定的物理参数必须按其所述单位处理。最终输出是无单位的整数，不需要单位转换。此任务中不出现角度或百分比。\n- 测试套件：使用以下五个测试用例，每个用例以 $(\\alpha_x,\\alpha_y,K_x,K_y,\\gamma_x,\\gamma_y,m,n)$ 的形式提供，其中 $\\alpha_x$ 和 $\\alpha_y$ 的单位是 $\\mu\\mathrm{M}/\\mathrm{min}$，$K_x$ 和 $K_y$ 的单位是 $\\mu\\mathrm{M}$，$\\gamma_x$ 和 $\\gamma_y$ 的单位是 $\\mathrm{min}^{-1}$，$m$ 和 $n$ 是无量纲的：\n  1. 用例 A（对称、协同、高产出）：$(\\alpha_x,\\alpha_y,K_x,K_y,\\gamma_x,\\gamma_y,m,n) = ($$10$$,$$10$$,$$1$$,$$1$$,$$1$$,$$1$$,$$2$$,$$2$$)$。\n  2. 用例 B（对称、协同、低产出）：$(\\alpha_x,\\alpha_y,K_x,K_y,\\gamma_x,\\gamma_y,m,n) = ($$0.5$$,$$0.5$$,$$1$$,$$1$$,$$1$$,$$1$$,$$2$$,$$2$$)$。\n  3. 用例 C（非对称产出、协同）：$(\\alpha_x,\\alpha_y,K_x,K_y,\\gamma_x,\\gamma_y,m,n) = ($$10$$,$$1$$,$$1$$,$$1$$,$$1$$,$$1$$,$$2$$,$$2$$)$。\n  4. 用例 D（对称、非协同、高产出）：$(\\alpha_x,\\alpha_y,K_x,K_y,\\gamma_x,\\gamma_y,m,n) = ($$10$$,$$10$$,$$1$$,$$1$$,$$1$$,$$1$$,$$1$$,$$1$$)$。\n  5. 用例 E（不等降解、协同、高产出）：$(\\alpha_x,\\alpha_y,K_x,K_y,\\gamma_x,\\gamma_y,m,n) = ($$8$$,$$8$$,$$1$$,$$1$$,$$1$$,$$0.5$$,$$2$$,$$2$$)$。\n- 最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[result_1,result_2,result_3,result_4,result_5]$），其中 $result_i$ 是上述第 $i$ 个测试用例的线性稳定稳态的整数数量。", "solution": "我们从由生产的希尔抑制和一阶降解控制的有量纲模型开始。有量纲的常微分方程组（ODEs）为\n$$\n\\frac{dx}{dt} = \\frac{\\alpha_x}{1 + \\left(\\frac{y}{K_y}\\right)^n} - \\gamma_x x, \\quad \n\\frac{dy}{dt} = \\frac{\\alpha_y}{1 + \\left(\\frac{x}{K_x}\\right)^m} - \\gamma_y y,\n$$\n其中 $\\alpha_x$ 和 $\\alpha_y$ 是最大产生速率（单位为 $\\mu\\mathrm{M}/\\mathrm{min}$），$K_x$ 和 $K_y$ 是解离常数（单位为 $\\mu\\mathrm{M}$），$\\gamma_x$ 和 $\\gamma_y$ 是降解速率常数（单位为 $\\mathrm{min}^{-1}$），$m$ 和 $n$ 是希尔指数。\n\n我们使用标度化浓度 $\\bar{x} = x/K_x$ 和 $\\bar{y} = y/K_y$ 以及标度化时间 $\\tau = \\gamma_x t$ 进行无量纲化。使用链式法则 $d\\bar{x}/d\\tau = (1/\\gamma_x)(1/K_x) dx/dt$，并对 $\\bar{y}$ 进行类似操作，我们将 $x = K_x \\bar{x}$ 和 $y = K_y \\bar{y}$ 代入，得到\n$$\n\\frac{d\\bar{x}}{d\\tau} = \\frac{1}{\\gamma_x K_x}\\frac{\\alpha_x}{1 + \\left(\\frac{K_y \\bar{y}}{K_y}\\right)^n} - \\frac{1}{\\gamma_x}\\gamma_x \\bar{x}\n= \\frac{\\alpha_x}{\\gamma_x K_x}\\frac{1}{1 + \\bar{y}^n} - \\bar{x},\n$$\n和\n$$\n\\frac{d\\bar{y}}{d\\tau} = \\frac{1}{\\gamma_x K_y}\\frac{\\alpha_y}{1 + \\left(\\frac{K_x \\bar{x}}{K_x}\\right)^m} - \\frac{\\gamma_y}{\\gamma_x}\\bar{y}\n= \\frac{\\alpha_y}{\\gamma_x K_y}\\frac{1}{1 + \\bar{x}^m} - \\Delta \\bar{y},\n$$\n其中我们引入了无量纲降解比 $\\Delta = \\gamma_y/\\gamma_x$。定义无量纲产生强度为\n$$\nA_1 = \\frac{\\alpha_x}{\\gamma_x K_x},\\quad A_2 = \\frac{\\alpha_y}{\\gamma_x K_y},\n$$\n因此，无量纲常微分方程组变为\n$$\n\\frac{d\\bar{x}}{d\\tau} = \\frac{A_1}{1 + \\bar{y}^n} - \\bar{x}, \\quad\n\\frac{d\\bar{y}}{d\\tau} = \\frac{A_2}{1 + \\bar{x}^m} - \\Delta \\bar{y}.\n$$\n控制动力学的最小无量纲参数组是 $(A_1, A_2, \\Delta, m, n)$。直观上，$A_1$ 和 $A_2$ 比较了最大产生速率与经降解标度化的解离常数，$m$ 和 $n$ 指定了抑制的协同性（非线性），而 $\\Delta$ 则量化了相对降解速度。\n\n稳态 $(\\bar{x}^*, \\bar{y}^*)$ 满足以下代数方程：\n$$\n\\bar{x}^* = \\frac{A_1}{1 + (\\bar{y}^*)^n}, \\quad\n\\bar{y}^* = \\frac{A_2}{\\Delta(1 + (\\bar{x}^*)^m)}.\n$$\n为确定线性稳定性，我们在稳态处对系统进行线性化，并考察方程右侧的雅可比矩阵。定义向量场：\n$$\nf_1(\\bar{x},\\bar{y}) = \\frac{A_1}{1 + \\bar{y}^n} - \\bar{x},\\quad\nf_2(\\bar{x},\\bar{y}) = \\frac{A_2}{1 + \\bar{x}^m} - \\Delta \\bar{y}.\n$$\n雅可比矩阵 $J$ 是\n$$\nJ(\\bar{x},\\bar{y}) =\n\\begin{bmatrix}\n\\frac{\\partial f_1}{\\partial \\bar{x}} & \\frac{\\partial f_1}{\\partial \\bar{y}}\\\\\n\\frac{\\partial f_2}{\\partial \\bar{x}} & \\frac{\\partial f_2}{\\partial \\bar{y}}\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n-1 & -\\frac{A_1 n \\bar{y}^{n-1}}{(1+\\bar{y}^n)^2}\\\\\n-\\frac{A_2 m \\bar{x}^{m-1}}{(1+\\bar{x}^m)^2} & -\\Delta\n\\end{bmatrix}.\n$$\n如果雅可比矩阵 $J$ 的两个特征值都具有负实部，则该稳态是线性稳定的。对于这个二维系统，这等价于矩阵的迹为负且行列式为正；但是，为了稳健性，我们将通过数值计算来求特征值。\n\n针对每个物理参数集的算法步骤如下：\n1. 根据 $(\\alpha_x,\\alpha_y,K_x,K_y,\\gamma_x,\\gamma_y,m,n)$ 通过 $A_1 = \\alpha_x/(\\gamma_x K_x)$、$A_2 = \\alpha_y/(\\gamma_x K_y)$ 和 $\\Delta = \\gamma_y/\\gamma_x$ 计算无量纲参数组 $A_1$、$A_2$、$\\Delta$、$m$、$n$。\n2. 通过在由零斜线边界 $\\bar{x} \\le A_1$、$\\bar{y} \\le A_2/\\Delta$（当分母项 $1+\\bar{y}^n$ 和 $1+\\bar{x}^m$ 被最小化时达到的最大值）确定的有界域内的网格上使用多个初始猜测值，求解 $f_1(\\bar{x},\\bar{y})=0$，$f_2(\\bar{x},\\bar{y})=0$ 来找出所有非负稳态。\n3. 使用小容差对数值解进行聚类以移除重复解，并舍弃带有负分量的非物理学解。\n4. 对于每个稳态，计算雅可bi矩阵 $J$ 并求其特征值。如果两个特征值的实部均为负（在小的数值容差范围内），则将该稳态计为线性稳定。\n5. 报告每个测试用例的线性稳定稳态的整数数量。\n\n无量纲参数组和双稳态的解释：\n- 较大的 $A_1$ 和 $A_2$ 增强了每个基因在抑制下维持表达的能力，使零斜线延伸到更大的值，并增加了出现多个交点（导致两个稳定不动点和一个不稳定不动点）的可能性。\n- 希尔指数 $m>1$ 和 $n>1$ 引入了S型抑制曲线，这对于产生多个交点至关重要；$m=n=1$ 通常产生单稳态。\n- 降解比 $\\Delta$ 使相对响应时间和稳态水平发生偏斜；与 $\\Delta=1$ 的偏差会使零斜线变形，并可能根据与 $A_1$ 和 $A_2$ 的平衡关系促进或抑制双稳态。\n\n该测试套件涵盖：一个对称、协同、高产出的用例（预期为双稳态）；一个对称、协同、低产出的用例（预期为单稳态）；一个非对称产出的用例；一个非协同的用例；以及一个降解速率不等的用例。程序将为每个用例计算线性稳定稳态的数量。最终输出必须是 $[r_1,r_2,r_3,r_4,r_5]$ 格式的单行文本，其中 $r_i$ 是整数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import root\n\ndef dimensionless_params(alpha_x, alpha_y, Kx, Ky, gamma_x, gamma_y, m, n):\n    \"\"\"\n    Compute dimensionless parameters:\n    A1 = alpha_x / (gamma_x * Kx)\n    A2 = alpha_y / (gamma_x * Ky)\n    Delta = gamma_y / gamma_x\n    m, n as given (dimensionless).\n    \"\"\"\n    A1 = alpha_x / (gamma_x * Kx)\n    A2 = alpha_y / (gamma_x * Ky)\n    Delta = gamma_y / gamma_x\n    return A1, A2, Delta, float(m), float(n)\n\ndef steady_states(A1, A2, Delta, m, n, grid_points=11, tol=1e-8, cluster_tol=1e-6, max_iter=200):\n    \"\"\"\n    Find steady states by solving:\n    f1(u, v) = A1/(1 + v^n) - u = 0\n    f2(u, v) = A2/(1 + u^m) - Delta*v = 0\n    Use multiple initial guesses over a grid within bounds:\n    0 = u = A1, 0 = v = A2/Delta (if Delta>0).\n    Cluster solutions to remove duplicates.\n    \"\"\"\n    # Bounds for u and v based on nullcline maxima\n    u_max = max(A1, 1.0)\n    v_max = max(A2 / Delta if Delta > 0 else A2, 1.0)\n    # Construct initial guess grid\n    u_guesses = np.linspace(0.0, u_max, grid_points)\n    v_guesses = np.linspace(0.0, v_max, grid_points)\n\n    def F(z):\n        u, v = z\n        # Guard against negative and large powers causing issues\n        # Allow evaluation for u,v >= 0\n        # Compute f1 and f2\n        denom_v = 1.0 + (v**n if v >= 0 else np.abs(v)**n)\n        denom_u = 1.0 + (u**m if u >= 0 else np.abs(u)**m)\n        f1 = A1 / denom_v - u\n        f2 = A2 / denom_u - Delta * v\n        return np.array([f1, f2])\n\n    solutions = []\n    for ug in u_guesses:\n        for vg in v_guesses:\n            sol = root(F, np.array([ug, vg]), method='hybr')\n            if sol.success:\n                u_sol, v_sol = sol.x\n                # Only accept nonnegative solutions within bounds (with tolerance)\n                if u_sol >= -1e-8 and v_sol >= -1e-8:\n                    # Clip tiny negatives to zero\n                    u_sol = max(u_sol, 0.0)\n                    v_sol = max(v_sol, 0.0)\n                    # Basic bound check (allow slight overshoot due to numerics)\n                    if u_sol = u_max + 1e-3 and v_sol = v_max + 1e-3:\n                        # Cluster: check if close to an existing solution\n                        is_new = True\n                        for (uu, vv) in solutions:\n                            if np.hypot(uu - u_sol, vv - v_sol)  cluster_tol:\n                                is_new = False\n                                break\n                        if is_new:\n                            solutions.append((u_sol, v_sol))\n    return solutions\n\ndef jacobian(A1, A2, Delta, m, n, u, v):\n    \"\"\"\n    Analytical Jacobian of the vector field at (u, v):\n    df1/du = -1\n    df1/dv = -A1 * n * v^(n-1) / (1 + v^n)^2\n    df2/du = -A2 * m * u^(m-1) / (1 + u^m)^2\n    df2/dv = -Delta\n    \"\"\"\n    # Handle v=0 with n>1: v^(n-1) is 0 if n>1; if n=1, v^(n-1)=v^0=1.\n    # Similarly for u.\n    denom_v = (1.0 + v**n)**2\n    denom_u = (1.0 + u**m)**2\n    # For zero values and fractional powers, guard using np.power\n    # Here m,n are integers in test suite, but treat generally.\n    v_pow = 0.0\n    u_pow = 0.0\n    # Compute v^(n-1) and u^(m-1) robustly\n    if v == 0.0 and n > 1:\n        v_pow = 0.0\n    else:\n        v_pow = v**(n - 1)\n    if u == 0.0 and m > 1:\n        u_pow = 0.0\n    else:\n        u_pow = u**(m - 1)\n    df1_du = -1.0\n    df1_dv = -A1 * n * v_pow / denom_v\n    df2_du = -A2 * m * u_pow / denom_u\n    df2_dv = -Delta\n    J = np.array([[df1_du, df1_dv],\n                  [df2_du, df2_dv]])\n    return J\n\ndef count_stable_states(alpha_x, alpha_y, Kx, Ky, gamma_x, gamma_y, m, n):\n    \"\"\"\n    Compute dimensionless parameters, find steady states, and count how many are linearly stable.\n    \"\"\"\n    A1, A2, Delta, m_dimless, n_dimless = dimensionless_params(alpha_x, alpha_y, Kx, Ky, gamma_x, gamma_y, m, n)\n    # Find steady states\n    ss = steady_states(A1, A2, Delta, m_dimless, n_dimless, grid_points=13)\n    stable_count = 0\n    for (u, v) in ss:\n        J = jacobian(A1, A2, Delta, m_dimless, n_dimless, u, v)\n        eigvals = np.linalg.eigvals(J)\n        # Consider stability if all eigenvalues have negative real parts\n        if np.max(np.real(eigvals))  -1e-8:\n            stable_count += 1\n    return stable_count\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (alpha_x, alpha_y, Kx, Ky, gamma_x, gamma_y, m, n)\n    test_cases = [\n        (10.0, 10.0, 1.0, 1.0, 1.0, 1.0, 2, 2),  # Case A\n        (0.5, 0.5, 1.0, 1.0, 1.0, 1.0, 2, 2),    # Case B\n        (10.0, 1.0, 1.0, 1.0, 1.0, 1.0, 2, 2),   # Case C\n        (10.0, 10.0, 1.0, 1.0, 1.0, 1.0, 1, 1),  # Case D\n        (8.0, 8.0, 1.0, 1.0, 1.0, 0.5, 2, 2),    # Case E\n    ]\n\n    results = []\n    for case in test_cases:\n        alpha_x, alpha_y, Kx, Ky, gamma_x, gamma_y, m, n = case\n        result = count_stable_states(alpha_x, alpha_y, Kx, Ky, gamma_x, gamma_y, m, n)\n        results.append(int(result))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3302286"}]}