{"hands_on_practices": [{"introduction": "在我们进行基因敲除的计算模拟之前，必须首先掌握连接基因与其所催化反应的“语言”。本练习聚焦于将使用“与”($\\land$)和“或”($\\lor$)等布尔逻辑的基因-蛋白质-反应（GPR）规则，转化为模型约束条件的具体变化。通过逐步推演一个假设的基因敲除场景[@problem_id:3313638]，您将为所有计算机模拟的基因操作实验奠定基础技能。", "problem": "给定一个玩具代谢网络，要求您在稳态通量平衡分析下，预测基因敲除对反应活性和可实现的最大生物质生成速率的影响。其基本依据是细胞内代谢物的准稳态假设，即线性稳态约束 $S v = 0$（其中 $S$ 是化学计量矩阵，$v$ 是反应通量向量），以及使用基因-蛋白质-反应 (GPR) 规则（解释为布尔逻辑）来将基因敲除映射到反应的可用性。“与”门表示催化需要所有基因，而“或”门表示任何一个基因都足够。没有功能性催化剂的反应必须通过将其上下界都设置为零来禁用。\n\n该网络包含内部代谢物 $A$、$B$ 和 $C$，以及一个生物质汇。反应如下：\n\n- 通量为 $v_1$ 的反应 $R_1$：$\\varnothing \\rightarrow A$（吸收/转运），边界 $0 \\le v_1 \\le 8$，GPR 为 $g_{11}$。\n- 通量为 $v_2$ 的反应 $R_2$：$A \\rightarrow 2 B$，边界 $0 \\le v_2 \\le 1000$，GPR 为 $\\big( g_1 \\land g_2 \\big) \\lor g_3$。\n- 通量为 $v_3$ 的反应 $R_3$：$B \\rightarrow C$，边界 $0 \\le v_3 \\le 1000$，GPR 为 $g_4 \\land \\big( g_5 \\lor g_6 \\big)$。\n- 通量为 $v_4$ 的反应 $R_4$：$C \\rightarrow \\mathrm{Biomass}$，边界 $0 \\le v_4 \\le 1000$，GPR 为 $g_7$。\n- 通量为 $v_5$ 的反应 $R_5$：$A \\rightarrow C$，边界 $0 \\le v_5 \\le 1000$，GPR 为 $g_2 \\land g_8$。\n- 通量为 $v_6$ 的反应 $R_6$：$2 B \\rightarrow \\mathrm{Biomass}$，边界 $0 \\le v_6 \\le 1000$，GPR 为 $g_9 \\lor g_{10}$。\n\n内部代谢物的稳态质量平衡由上述化学计量关系决定，具体如下\n- $A$: $v_1 - v_2 - v_5 = 0$，\n- $B$: $2 v_2 - v_3 - 2 v_6 = 0$，\n- $C$: $v_3 + v_5 - v_4 = 0$。\n\n目标是最大化生物质生成速率，定义为 $v_{\\mathrm{bio}} = v_4 + v_6$。\n\n进行了一次双基因敲除：基因 $g_2$ 和 $g_{10}$ 被敲除。所有其他基因均存在且功能正常。\n\n任务：\n1. 使用GPR规则，确定哪些反应因此次敲除而被禁用，并相应地为每个 $i \\in \\{1,2,3,4,5,6\\}$ 更新边界 $l_i \\le v_i \\le u_i$。禁用的反应必须设置 $l_i = u_i = 0$。\n2. 使用更新后的边界和稳态约束 $S v = 0$，通过通量平衡分析求解最大生物质生成速率 $v_{\\mathrm{bio}}^{\\star}$。请将您的最终答案以单个实数形式提供。不需要四舍五入，也不需要单位。", "solution": "该问题需要对特定基因敲除场景下的代谢网络进行两步分析。首先，我们必须评估基因-蛋白质-反应 (GPR) 规则以确定哪些反应被禁用。其次，我们必须使用更新后的反应约束进行通量平衡分析 (FBA)，以找到最大生物质生成速率。\n\n**步骤1：GPR评估与更新反应边界**\n\n问题指定了对基因 $g_2$ 和 $g_{10}$ 的双基因敲除。在GPR的布尔逻辑中，被敲除的基因对应于逻辑值 `FALSE`（表示为 $0$），而功能性基因对应于 `TRUE`（表示为 $1$）。除 $g_2$ 和 $g_{10}$ 外的所有其他基因都是功能性的。我们对每个反应的GPR进行评估：\n\n- **反应 $R_1$**：GPR为 $g_{11}$。由于 $g_{11}$ 是功能性的，其值为 $1$。该规则评估为`TRUE`。$R_1$ 处于激活状态。边界保持为 $0 \\le v_1 \\le 8$。\n- **反应 $R_2$**：GPR为 $(g_1 \\land g_2) \\lor g_3$。当 $g_1=1$，$g_2=0$，$g_3=1$ 时，表达式变为 $(1 \\land 0) \\lor 1 = 0 \\lor 1 = 1$。该规则评估为`TRUE`。$R_2$ 处于激活状态。边界保持为 $0 \\le v_2 \\le 1000$。这个GPR代表一个反应，其催化剂可以是由 $g_1$ 和 $g_2$ 共同组成的酶复合物，也可以是来自 $g_3$ 的同工酶。$g_2$ 的敲除禁用了该酶复合物，但来自 $g_3$ 的同工酶使反应得以进行。\n- **反应 $R_3$**：GPR为 $g_4 \\land (g_5 \\lor g_6)$。这些基因都没有被敲除，所以 $g_4=1$，$g_5=1$，$g_6=1$。表达式为 $1 \\land (1 \\lor 1) = 1$。该规则评估为`TRUE`。$R_3$ 处于激活状态。边界保持为 $0 \\le v_3 \\le 1000$。\n- **反应 $R_4$**：GPR为 $g_7$。基因 $g_7$ 是功能性的 ($1$)。该规则为`TRUE`。$R_4$ 处于激活状态。边界保持为 $0 \\le v_4 \\le 1000$。\n- **反应 $R_5$**：GPR为 $g_2 \\land g_8$。当 $g_2=0$，$g_8=1$ 时，表达式为 $0 \\land 1 = 0$。该规则评估为`FALSE`。$R_5$ 被禁用。其边界更新为 $l_5 = u_5 = 0$，这意味着 $v_5=0$。这是因为该酶需要来自 $g_2$ 和 $g_8$ 的基因产物。\n- **反应 $R_6$**：GPR为 $g_9 \\lor g_{10}$。当 $g_9=1$，$g_{10}=0$ 时，表达式为 $1 \\lor 0 = 1$。该规则评估为`TRUE`。$R_6$ 处于激活状态。边界保持为 $0 \\le v_6 \\le 1000$。该反应可以由来自 $g_9$ 的酶或来自 $g_{10}$ 的同工酶催化。由于 $g_9$ 是功能性的，反应得以进行。\n\n总而言之，此次敲除唯一禁用的反应是 $R_5$。约束 $v_5=0$ 必须被纳入模型中。\n\n**步骤2：通量平衡分析**\n\n目标是最大化生物质生成速率 $v_{\\mathrm{bio}} = v_4 + v_6$，同时满足稳态质量平衡约束和更新后的通量边界。\n\n线性规划问题为：\n最大化 $Z = v_4 + v_6$\n约束条件为：\n1. $v_1 - v_2 - v_5 = 0$ (代谢物 $A$ 的平衡)\n2. $2 v_2 - v_3 - 2 v_6 = 0$ (代谢物 $B$ 的平衡)\n3. $v_3 + v_5 - v_4 = 0$ (代谢物 $C$ 的平衡)\n以及边界条件：\n- $0 \\le v_1 \\le 8$\n- $0 \\le v_2 \\le 1000$\n- $0 \\le v_3 \\le 1000$\n- $0 \\le v_4 \\le 1000$\n- $v_5 = 0$\n- $0 \\le v_6 \\le 1000$\n\n我们首先将敲除约束 $v_5=0$ 代入质量平衡方程：\n1. $v_1 - v_2 = 0 \\implies v_1 = v_2$\n2. $2 v_2 - v_3 - 2 v_6 = 0$\n3. $v_3 - v_4 = 0 \\implies v_3 = v_4$\n\n该系统可以被简化。从(1)可知，对 $v_1$ 的约束 ($0 \\le v_1 \\le 8$) 直接转化为对 $v_2$ 的更严格约束，即 $0 \\le v_2 \\le 8$。原来的边界 $0 \\le v_2 \\le 1000$ 被取代。\n\n我们可以用一组独立通量来表示目标函数和其他变量。我们选择 $v_2$ 和 $v_6$。\n从(3)可知，$v_4 = v_3$。\n从(2)可知，$v_3 = 2 v_2 - 2 v_6$。\n因此，$v_4 = 2 v_2 - 2 v_6$。\n\n目标函数 $Z = v_4 + v_6$ 可以重写为：\n$Z = (2 v_2 - 2 v_6) + v_6 = 2 v_2 - v_6$。\n\n现在我们用 $v_2$ 和 $v_6$ 来重新表述问题：\n最大化 $Z(v_2, v_6) = 2 v_2 - v_6$\n约束条件为 $v_2$ 和 $v_6$ 的约束。这些约束来自通量边界。\n- $0 \\le v_2 \\le 8$ (来自 $v_1=v_2$ 和 $0 \\le v_1 \\le 8$)\n- $0 \\le v_6 \\le 1000$ (原始边界)\n- 所有通量必须为非负。由于所有下界都是 $0$，我们必须确保依赖通量的表达式为非负。\n    - $v_1 = v_2 \\ge 0$ (由 $v_2 \\ge 0$ 保证)\n    - $v_3 = 2 v_2 - 2 v_6 \\ge 0 \\implies 2 v_2 \\ge 2 v_6 \\implies v_2 \\ge v_6$\n    - $v_4 = v_3 \\ge 0$ (同样条件, $v_2 \\ge v_6$)\n\n所以，简化的约束条件是：\n1. $0 \\le v_2 \\le 8$\n2. $0 \\le v_6 \\le v_2$\n3. $0 \\le v_6 \\le 1000$\n\n条件 $0 \\le v_6 \\le v_2$ 与 $v_2 \\le 8$ 相结合，意味着 $v_6 \\le 8$。这对 $v_6$ 是一个比 $v_6 \\le 1000$ 更严格的约束。\n问题简化为：\n最大化 $Z(v_2, v_6) = 2 v_2 - v_6$\n约束条件为：\n- $0 \\le v_2 \\le 8$\n- $0 \\le v_6 \\le v_2$\n\n这是一个在 $(v_2, v_6)$ 平面上的多边形可行域上的线性规划问题。目标函数的最大值必定出现在该区域的某个顶点上。这些顶点由边界线的交点给出：\n- $v_2=0, v_6=0 \\implies (0, 0)$\n- $v_2=8, v_6=0 \\implies (8, 0)$\n- $v_2=8, v_6=v_2 \\implies (8, 8)$\n\n我们在每个顶点处计算目标函数 $Z = 2 v_2 - v_6$ 的值：\n- 在 $(v_2, v_6) = (0, 0)$：$Z = 2(0) - 0 = 0$。\n- 在 $(v_2, v_6) = (8, 0)$：$Z = 2(8) - 0 = 16$。\n- 在 $(v_2, v_6) = (8, 8)$：$Z = 2(8) - 8 = 16 - 8 = 8$。\n\n目标函数的最大值是 $16$。这就是最大生物质生成速率 $v_{\\mathrm{bio}}^{\\star}$。\n这个最大值在以下通量向量下达到：\n- $v_2 = 8$\n- $v_6 = 0$\n- $v_1 = v_2 = 8$\n- $v_3 = 2(8) - 2(0) = 16$\n- $v_4 = v_3 = 16$\n- $v_5 = 0$\n生物质生成速率为 $v_{\\mathrm{bio}} = v_4 + v_6 = 16 + 0 = 16$。\n所有通量值都在其各自的边界内，因此该解是可行的。例如，$0 \\le v_3 = 16 \\le 1000$ 且 $0 \\le v_4 = 16 \\le 1000$。\n\n最大生物质生成速率是 $16$。", "answer": "$$ \\boxed{16} $$", "id": "3313638"}, {"introduction": "基因的必需性并非其固有属性，而是高度依赖于其所在的代谢网络环境。本练习将探讨一种常见的生物学情景：一项代谢任务可由一个高效的多蛋白复合物或一个效率较低的备用酶来完成。通过模拟敲除相关基因[@problem_id:3313704]，您将直观地理解代谢冗余等概念，并洞察网络结构如何赋予系统抵抗基因扰动的稳健性。", "problem": "给定一个小型且科学上一致的代谢网络，要求您根据通量平衡分析（Flux Balance Analysis, FBA）的原理，构建并求解一个线性优化问题来预测生长。该网络包含一个由异源多聚体酶复合物催化的反应和一个由单基因酶催化的替代反应。您必须对异源多聚体复合物的亚基使用逻辑“与”规则，将基因敲除映射到反应活性，然后计算每种基因敲除情景下的最大生长速率。\n\n基本原理：在稳态下，细胞内代谢物浓度保持恒定。该条件通过化学计量质量平衡方程 $$S \\, v = 0,$$ 表示，其中 $S$ 是化学计量矩阵，$v$ 是反应通量向量。由于反应可逆性、酶容量和转运限制，可行通量 $v$ 受到下界和上界的约束。生长预测被设定为一个线性规划问题，其目标是在质量平衡约束和边界约束下最大化生物质排出通量。基因到反应的映射使用基因-蛋白质-反应规则：一个异源多聚体复合物需要其所有亚基基因都存在才能具有催化活性。因此，敲除任何一个亚基基因都会将所催化反应的上界设置为零。\n\n网络规格：\n- 代谢物：两种细胞内物质，$$\\text{Glc}$$ 和 $$\\text{Biomass}$$。\n- 反应（索引为 $$v_1,\\dots,v_4$$），及其边界和基因关联：\n  1. 摄取：$$\\varnothing \\to \\text{Glc}$$，通量 $$v_1 \\in [0, 10]$$（无基因关联）。\n  2. 通过异源多聚体复合物合成生物质：$$\\text{Glc} \\to \\text{Biomass}$$，通量 $$v_2 \\in [0, 100]$$，由需要基因 $$g_A$$ 和 $$g_B$$ 的酶复合物催化（“与”规则）。\n  3. 替代生物质合成：$$\\text{Glc} \\to \\text{Biomass}$$，通量 $$v_3 \\in [0, 2]$$，由基因 $$g_C$$ 催化。\n  4. 生物质排出（生长）：$$\\text{Biomass} \\to \\varnothing$$，通量 $$v_4 \\in [0, 100]$$（无基因关联）。生长速率定义为 $$v_4$$。\n\n化学计量矩阵：行是代谢物 $$[\\text{Glc}, \\text{Biomass}]$$，列是反应 $$[v_1, v_2, v_3, v_4]$$。矩阵 $$S$$ 为\n$$\nS = \\begin{bmatrix}\n+1  -1  -1  0 \\\\\n0  +1  +1  -1\n\\end{bmatrix}.\n$$\n稳态质量平衡 $$S v = 0$$ 产生以下约束 $$v_1 - v_2 - v_3 = 0$$ 和 $$v_2 + v_3 - v_4 = 0$$。目标是最大化生长速率 $$v_4$$。\n\n基因-蛋白质-反应规则：\n- 对于反应 $$v_2$$，异源多聚体复合物需要基因 $$g_A$$ 和 $$g_B$$。如果 $$g_A$$ 或 $$g_B$$ 被敲除，则将 $$v_2$$ 的上界设置为 $$0$$。\n- 对于反应 $$v_3$$，该反应需要基因 $$g_C$$。如果 $$g_C$$ 被敲除，则将 $$v_3$$ 的上界设置为 $$0$$。\n- 所有其他反应边界保持如上所述。\n\n任务：\n1. 对于每个指定的基因敲除集，应用基因-蛋白质-反应映射来更新反应边界。\n2. 求解以下线性规划问题以计算最大生长速率 $$v_4$$：\n   - 最大化 $$c^\\top v$$，其中 $$c = [0, 0, 0, 1]$$。\n   - 约束条件为 $$S v = 0$$。\n   - 约束条件为 $$\\ell \\le v \\le u$$，其中 $$\\ell$$ 和 $$u$$ 是根据敲除情况调整后的下界和上界。\n\n单位与输出：\n- 以十进制浮点数形式报告生长速率 $$v_4$$，单位为 $$\\text{h}^{-1}$$（每小时）。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，$$[r_1,r_2,\\dots]$$）。\n\n测试套件：\n使用以下基因敲除集来测试映射和优化：\n- 情况 $$1$$（理想情况）：无敲除 $$\\{\\}$$。\n- 情况 $$2$$：敲除 $$\\{g_A\\}$$。\n- 情况 $$3$$：敲除 $$\\{g_B\\}$$。\n- 情况 $$4$$：敲除 $$\\{g_C\\}$$。\n- 情况 $$5$$（冗余亚基均缺失）：敲除 $$\\{g_A, g_B\\}$$。\n- 情况 $$6$$（完全阻断）：敲除 $$\\{g_A, g_C\\}$$。\n\n答案规格：\n- 最终输出必须是单行，包含一个列表，其中有 $$6$$ 个浮点数，对应情况 $$1$$ 到 $$6$$ 的最大生长速率 $$v_4$$，单位为 $$\\text{h}^{-1}$$，格式需严格为 `$[x_1,x_2,x_3,x_4,x_5,x_6]$`。", "solution": "问题陈述经评估有效。它科学地基于通量平衡分析（FBA）的既定原则，这是计算系统生物学中的一种标准方法。该问题设定良好，定义了一个具有完整约束集和明确目标的线性规划问题，确保每种情况都存在唯一解。所提供的信息，包括化学计量矩阵、反应边界、基因-蛋白质-反应规则和测试用例，是自洽、明确且数学上一致的。不存在科学或事实上的不健全、矛盾或其他使其无效的缺陷。\n\n问题的核心是预测微生物在不同基因敲除条件下的最大生长速率。这通过为每种条件构建并求解一个线性规划（LP）问题来实现。生长速率由通过生物质排出反应的通量 $v_4$ 表示。\n\n该系统由稳态质量平衡方程 $S v = 0$ 控制，其中 $S$ 是化学计量矩阵，$v$ 是反应通量向量。通量还受到下界和上界 $\\ell \\le v \\le u$ 的约束，这些边界由热力学、酶动力学和营养物可用性决定。\n\nLP 的组成部分如下：\n\n- **通量向量**：待定变量是四个反应的通量，由向量 $v = [v_1, v_2, v_3, v_4]^\\top$ 表示。\n\n- **化学计量矩阵与等式约束**：问题提供了化学计量矩阵 $S$：\n$$\nS = \\begin{bmatrix}\n+1  -1  -1  0 \\\\\n0  +1  +1  -1\n\\end{bmatrix}\n$$\n稳态假设 $S v = 0$ 转化为一个线性等式约束系统：\n$$\nv_1 - v_2 - v_3 = 0\n$$\n$$\nv_2 + v_3 - v_4 = 0\n$$\n\n- **目标函数**：生物学目标是最大化生长速率，定义为通量 $v_4$。这被表述为最大化 $c^\\top v$，其中目标向量为 $c = [0, 0, 0, 1]^\\top$。\n\n- **通量边界与基因-蛋白质-反应(GPR)规则**：每个通量 $v_i$ 都受到下界 $\\ell_i$ 和上界 $u_i$ 的约束。默认边界如下：\n$v_1 \\in [0, 10]$\n$v_2 \\in [0, 100]$\n$v_3 \\in [0, 2]$\n$v_4 \\in [0, 100]$\n这些边界根据 GPR 规则基于指定的基因敲除进行修改：\n- 反应 $v_2$ 需要基因 $g_A$ 和 $g_B$。如果 $g_A$ 或 $g_B$ 被敲除，则上界 $u_2$ 被设置为 $0$。\n- 反应 $v_3$ 需要基因 $g_C$。如果 $g_C$ 被敲除，则上界 $u_3$ 被设置为 $0$。\n\n从等式约束中，我们可以推断出 $v_4 = v_2 + v_3$ 和 $v_1 = v_2 + v_3$。因此，$v_1 = v_4$。由于 $v_1$ 受其上界 $10$ 的限制，生长速率 $v_4$ 也相应地受到限制，即 $v_4 \\le 10$。目标是在单个通量边界和营养物摄取限制 $v_2 + v_3 \\le 10$ 的条件下最大化 $v_4 = v_2 + v_3$。因此，最大生长速率由 $\\max(v_4) = \\min(10, u_2 + u_3)$ 给出，其中 $u_2$ 和 $u_3$ 是依赖于敲除情况的上界。\n\n我们现在为六个指定的测试用例分别求解问题。\n\n**情况 1：无敲除 ($\\{\\}$)**\n- 基因 $g_A$、$g_B$ 和 $g_C$ 均处于活动状态。\n- $v_2$ 的上界为 $u_2=100$。\n- $v_3$ 的上界为 $u_3=2$。\n- 最大生长速率为 $\\max(v_4) = \\min(10, 100 + 2) = \\min(10, 102) = 10 \\, \\text{h}^{-1}$。\n\n**情况 2：敲除 ($\\{g_A\\}$)**\n- 基因 $g_A$ 被敲除。催化 $v_2$ 的异源多聚体酶失活。\n- $v_2$ 的上界为 $u_2=0$。\n- $v_3$ 的上界不受影响，为 $u_3=2$。\n- 最大生长速率为 $\\max(v_4) = \\min(10, 0 + 2) = \\min(10, 2) = 2 \\, \\text{h}^{-1}$。系统完全依赖于替代的生物质合成途径。\n\n**情况 3：敲除 ($\\{g_B\\}$)**\n- 基因 $g_B$ 被敲除。催化 $v_2$ 的异源多聚体酶失活。\n- $v_2$ 的上界为 $u_2=0$。\n- $v_3$ 的上界不受影响，为 $u_3=2$。\n- 最大生长速率为 $\\max(v_4) = \\min(10, 0 + 2) = \\min(10, 2) = 2 \\, \\text{h}^{-1}$。此结果与情况 2 相同，因为 $g_A$ 和 $g_B$ 对于主要生物质合成酶的功能都是必需的。\n\n**情况 4：敲除 ($\\{g_C\\}$)**\n- 基因 $g_C$ 被敲除。催化替代途径 $v_3$ 的酶失活。\n- $v_2$ 的上界不受影响，为 $u_2=100$。\n- $v_3$ 的上界为 $u_3=0$。\n- 最大生长速率为 $\\max(v_4) = \\min(10, 100 + 0) = \\min(10, 100) = 10 \\, \\text{h}^{-1}$。系统完全依赖于主要的、高容量的生物质合成途径，该途径足以利用全部的摄取能力。\n\n**情况 5：敲除 ($\\{g_A, g_B\\}$)**\n- 基因 $g_A$ 和 $g_B$ 都被敲除。催化 $v_2$ 的异源多聚体酶失活。\n- $v_2$ 的上界为 $u_2=0$。\n- $v_3$ 的上界不受影响，为 $u_3=2$。\n- 最大生长速率为 $\\max(v_4) = \\min(10, 0 + 2) = \\min(10, 2) = 2 \\, \\text{h}^{-1}$。\n\n**情况 6：敲除 ($\\{g_A, g_C\\}$)**\n- 基因 $g_A$ 和 $g_C$ 被敲除。主要（$v_2$）和替代（$v_3$）生物质合成途径均被阻断。\n- $v_2$ 的上界为 $u_2=0$。\n- $v_3$ 的上界为 $u_3=0$。\n- 最大生长速率为 $\\max(v_4) = \\min(10, 0 + 0) = \\min(10, 0) = 0 \\, \\text{h}^{-1}$。由于没有途径产生生物质，生长是不可能的。", "answer": "```\n[10.0,2.0,2.0,10.0,2.0,0.0]\n```", "id": "3313704"}, {"introduction": "本练习将介绍合成致死这一高级概念，即两个基因同时缺失是致命的，而单独缺失任何一个则不然，这一现象在癌症治疗等领域具有重要意义。这个实践操作将指导您完成一个计算流程，在一个模型网络中系统地识别合成致死基因对[@problem_id:3313719]。它展示了基于约束的模型如何揭示非显而易见的基因相互作用，并预测复杂的表型。", "problem": "给定一个玩具代谢网络，用于通过通量平衡分析（FBA）来探究基因必需性。通量平衡分析（FBA）由稳态质量平衡约束 $S \\, v = 0$ 定义，其中 $S$ 是化学计量矩阵，$v$ 是反应通量向量，同时还有边界约束 $l \\le v \\le u$ 和一个线性最大化目标，这里指生物质通量。基因必需性通过基因-蛋白质-反应（GPR）逻辑进行评估，该逻辑将基因敲除映射到反应失活。如果一对基因中的每个单基因敲除在指定生存阈值下都是非致命的，但双基因敲除在指定致死阈值下是致命的，那么这对基因就是合成致死的。\n\n考虑以下化学计量平衡、生物学上合理的玩具网络，该网络具有平行的同工酶和旁路途径。内部代謝物为 $A$、$B$、$C$ 和 $D$。反应（按顺序）如下：\n- 源摄取 $R_{\\text{src}}$: $\\varnothing \\rightarrow A$。\n- 同工酶分支步骤 $R_{2a}$: $A \\rightarrow B$。\n- 同工酶分支步骤 $R_{2b}$: $A \\rightarrow B$。\n- 主分支转化 $R_{3}$: $B \\rightarrow C$。\n- 旁路进入 $R_{4}$: $A \\rightarrow D$。\n- 旁路转化 $R_{5}$: $D \\rightarrow C$。\n- 生物质反应 $R_{\\text{bio}}$: $C \\rightarrow \\varnothing$。\n\n设化学计量矩阵 $S \\in \\mathbb{R}^{4 \\times 7}$ 的行定义为 $(A,B,C,D)$，列定义为 $(R_{\\text{src}}, R_{2a}, R_{2b}, R_{3}, R_{4}, R_{5}, R_{\\text{bio}})$，如下所示：\n$$\nS =\n\\begin{bmatrix}\n+1  -1  -1  0  -1  0  0 \\\\\n0  +1  +1  -1  0  0  0 \\\\\n0  0  0  +1  0  +1  -1 \\\\\n0  0  0  0  +1  -1  0 \\\\\n\\end{bmatrix}.\n$$\n\n除非另有说明，反应边界遵循标准的不可逆约定。对于所有情况，所有反应的下界均为 $l_j = 0$。上界 $u_j$ 如下：\n- $u_{\\text{src}} = 10$,\n- $u_{2a} = 1000$, $u_{2b} = 1000$,\n- $u_{3} = 1000$,\n- $u_{4} = U_{\\text{bypass}}$,\n- $u_{5} = U_{\\text{bypass}}$,\n- $u_{\\text{bio}} = 1000$.\n\n生物质目标是最大化 $v_{\\text{bio}}$。\n\n基因-蛋白质-反应（GPR）关联如下：\n- $R_{2a}$ 需要基因 $g_1$，\n- $R_{2b}$ 需要基因 $g_2$，\n- $R_{3}$ 需要基因 $g_3$，\n- $R_{4}$ 需要基因 $g_4$，\n- $R_{5}$ 需要基因 $g_5$，\n- $R_{\\text{src}}$ 和 $R_{\\text{bio}}$ 没有基因要求。\n\n基因敲除会将其 GPR 不满足的任何反应失活，方法是将其上界设置为 $0$。同工酶 $R_{2a}$ 和 $R_{2b}$ 在反应层面实现“或”逻辑：每个反应都有自己的基因，因此敲除一个基因会使另一个反应仍然可用。\n\n设野生型生物质通量 $v_{\\text{bio}}^{\\text{WT}}$ 为在给定边界且无基因敲除情况下的最优目标值。对于单基因敲除 $g$，设 $v_{\\text{bio}}^{\\{g\\}}$ 为最优生物质通量；对于双基因敲除 $\\{g_i,g_j\\}$，设 $v_{\\text{bio}}^{\\{g_i,g_j\\}}$ 为最优生物质通量。定义两个相对于野生型的阈值：非致命生存阈值 $\\alpha \\in [0,1]$ 和致死阈值 $\\beta \\in [0,1]$，其中 $\\beta \\ll 1$。当且仅当 $v_{\\text{bio}}^{\\{g_i\\}} \\ge \\alpha \\, v_{\\text{bio}}^{\\text{WT}}$ 和 $v_{\\text{bio}}^{\\{g_j\\}} \\ge \\alpha \\, v_{\\text{bio}}^{\\text{WT}}$ 同时成立，且 $v_{\\text{bio}}^{\\{g_i,g_j\\}}  \\beta \\, v_{\\text{bio}}^{\\text{WT}}$ 时，双基因敲除 $\\{g_i,g_j\\}$ 是合成致死的。\n\n您的任务是编写一个完整的程序，该程序：\n1. 对基因集 $\\{g_1,g_2,g_3,g_4,g_5\\}$，使用上述的 $S$ 矩阵和边界，以及最大化 $v_{\\text{bio}}$ 的目标，求解野生型、所有单基因敲除和所有双基因敲除的 FBA 线性规划问题。\n2. 在基因敲除条件下应用 GPR 逻辑，将被敲除基因所需的反应上界置零。\n3. 对于下方的每个测试用例，计算合成致死基因对的数量，其中测试用例指定了 $(U_{\\text{bypass}}, \\alpha, \\beta)$。\n4. 生成所需的输出格式。\n\n假设所有通量都使用任意一致的单位；不需要进行物理单位转换。不使用角度。所有与阈值的数值比较都应严格按照所述进行。\n\n测试套件：\n- 用例 1: $(U_{\\text{bypass}}, \\alpha, \\beta) = (1000, 0.9, 1 \\times 10^{-9})$。\n- 用例 2: $(U_{\\text{bypass}}, \\alpha, \\beta) = (4, 0.6, 1 \\times 10^{-9})$。\n- 用例 3: $(U_{\\text{bypass}}, \\alpha, \\beta) = (6, 0.5, 1 \\times 10^{-9})$。\n\n最终输出格式：\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，“[r1,r2,r3]”），其中每个条目是相应测试用例的合成致死对的整数计数，顺序与上面列出的相同。", "solution": "该问题要求我们使用通量平衡分析（FBA）在一个给定的玩具代谢网络中识别并计数合成致死基因对。如果基因 $g_i$ 和基因 $g_j$ 的单独敲除都是非致命的，但同时敲除这两个基因是致命的，那么基因对 $\\{g_i, g_j\\}$ 就被定义为合成致死。这是通过将预测的最大生物质生成速率与相对于野生型生物体的指定阈值进行比较来确定的。\n\n该方法的核心是 FBA，这是一种基于约束的建模技术，用于预测代谢通量分布。FBA 被构建为一个线性规划（LP）问题。其基本假设是代谢网络在伪稳态下运行，即内部代谢物的浓度不随时间变化。这就得到了质量平衡约束：\n$$S v = 0$$\n其中 $S \\in \\mathbb{R}^{m \\times n}$ 是 $m$ 个代谢物和 $n$ 个反应的化学计量矩阵，$v \\in \\mathbb{R}^n$ 是反应通量向量。\n\n解空间受到热力学和容量限制的进一步约束，这些限制表示为每个通量 $v_j$ 的下界和上界：\n$$l_j \\le v_j \\le u_j$$\n在这个通量分布的可行空间（一个凸多胞体）内，FBA 假设细胞的运作是为了优化一个特定的生物学目标，该目标由一个线性目标函数 $Z = c^T v$ 表示。对于这个问题，目标是最大化生物质生成速率 $v_{\\text{bio}}$。最大化函数 $Z$ 等同于最小化 $-Z$。因此，LP 问题是：\n$$\n\\begin{array}{ll}\n\\text{minimize}  -c^T v \\\\\n\\text{subject to}  S v = 0 \\\\\n l \\le v \\le u\n\\end{array}\n$$\n在这里，目标向量 $c$ 是一个零向量，在对应于生物质反应通量 $v_{\\text{bio}}$ 的位置上为 1。\n\n基因敲除的模拟是通过基因-蛋白质-反应（GPR）关联介导的。所提供的 GPR 规则说明了特定反应激活需要哪个基因。基因敲除的模拟方法是，将相应反应通量的上界设置为 0，从而有效地将其从网络中移除。例如，敲除反应 $R_{2a}$ 所需的基因 $g_1$，是通过将上界 $u_{2a}$ 设置为 0 来建模的。\n\n为解决每个给定测试用例 $(U_{\\text{bypass}}, \\alpha, \\beta)$ 的问题的整体算法，遵循一个结构化的、多步骤的模拟过程：\n\n1. **野生型模拟：** 首先，我们求解没有基因敲除的野生型生物体的 FBA 问题。下界 $l_j$ 均为 0，上界 $u_j$ 设置为其默认值，其中 $u_{4}$ 和 $u_{5}$（旁路反应）使用测试用例中指定的 $U_{\\text{bypass}}$。求解此 LP 问题可得到最大野生型生物质通量 $v_{\\text{bio}}^{\\text{WT}}$，它将作为所有后续比较的参考基准。\n\n2. **单基因敲除模拟：** 接下来，我们遍历基因集 $\\{g_1, g_2, g_3, g_4, g_5\\}$ 中的每个基因 $g_i$。对于每个基因，我们通过创建一组新的通量边界来模拟其敲除，其中与 $g_i$ 相关联的反应的上界被设置为 0。然后，我们用这些修改后的边界求解 FBA 问题，以获得最大生物质通量 $v_{\\text{bio}}^{\\{g_i\\}}$。对所有 5 个基因重复此过程。\n\n3. **合成致死对的识别：** 我们遍历 5 个基因集中的所有唯一基因对 $\\{g_i, g_j\\}$。对于每一对，我们应用合成致死的定义：\n    a. **生存能力检查：** 我们首先检查单个敲除是否为非致命。如果 $v_{\\text{bio}}^{\\{g_i\\}} \\ge \\alpha \\, v_{\\text{bio}}^{\\text{WT}}$ 和 $v_{\\text{bio}}^{\\{g_j\\}} \\ge \\alpha \\, v_{\\text{bio}}^{\\text{WT}}$ 同时满足，则此条件成立。如果任一条件不满足，则该基因对不是合成致死的，我们继续处理下一对。\n    b. **致死性检查：** 如果两个单基因敲除都具有生存能力，我们接着模拟双基因敲除。创建一个新的边界集，其中与 $g_i$ 和 $g_j$ 相关的所有反应的上界都设置为 0。用这些边界求解 FBA 问题，以找到双基因敲除的生物质通量 $v_{\\text{bio}}^{\\{g_i,g_j\\}}$。\n    c. **分类：** 如果双基因敲除的生物质低于致死阈值：$v_{\\text{bio}}^{\\{g_i,g_j\\}}  \\beta \\, v_{\\text{bio}}^{\\text{WT}}$，则基因对 $\\{g_i, g_j\\}$ 被分类为合成致死。如果满足此条件，合成致死对的计数器加一。\n\n对三个测试用例中的每一个都执行这整个过程，并记录每个用例的合成致死对的最终整数计数。该实现使用 `scipy.optimize.linprog` 来求解构成的 LP 问题。", "answer": "```\n[2,0,2]\n```", "id": "3313719"}]}