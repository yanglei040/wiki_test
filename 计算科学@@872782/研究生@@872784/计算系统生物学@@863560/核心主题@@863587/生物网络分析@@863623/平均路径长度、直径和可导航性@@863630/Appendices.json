{"hands_on_practices": [{"introduction": "在分析蛋白质相互作用网络等大规模图时，精确计算平均路径长度（$L$）等全局指标通常在计算上是不可行的。本练习介绍了一种基础而强大的解决方案：统计抽样。通过这个练习，你将证明样本均值是 $L$ 的一个无偏估计量，并推导出其方差，这对于理解我们估计的精确度至关重要，是定量生物学研究中一项必备的严谨技能 [@problem_id:3288948]。", "problem": "一位系统生物学家正在研究一个蛋白质-蛋白质相互作用 (PPI) 网络的可导航性，该网络被建模为一个具有 $N$ 个节点的连通、简单、无向图。令 $d(i,j)$ 表示不同节点 $i$ 和 $j$ 之间的最短路径距离。平均路径长度定义为\n$$\nL \\equiv \\frac{2}{N(N-1)} \\sum_{1 \\leq i  j \\leq N} d(i,j).\n$$\n对于较大的 $N$，精确计算 $L$ 的计算量过大，因此该生物学家采用有放回的均匀配对抽样方法：从 $\\frac{N(N-1)}{2}$ 个无序的不同节点对中独立且均匀地抽取 $m$ 个无序节点对，并记录每个抽样对的最短路径距离。设这些距离为 $D_{1}, D_{2}, \\dots, D_{m}$。定义估计量\n$$\n\\widehat{L} \\equiv \\frac{1}{m} \\sum_{s=1}^{m} D_{s}.\n$$\n设网络直径为 $D_{\\max}$，并用 $p_{k}$ 表示一个均匀抽样的无序节点对的最短路径距离恰好为 $k$ 的概率，其中 $k \\in \\{1,2,\\dots,D_{\\max}\\}$。也就是说，\n$$\np_{k} \\equiv \\mathbb{P}(D = k), \\quad \\text{其中 } D \\text{ 是一个均匀抽样的无序节点对的距离}，\n$$\n因此 $\\sum_{k=1}^{D_{\\max}} p_{k} = 1$。\n\n仅使用这些定义以及期望和方差的标准性质，完成以下任务：\n- 证明在有放回的均匀配对抽样下，$\\widehat{L}$ 是 $L$ 的一个无偏估计量。\n- 推导 $\\operatorname{Var}(\\widehat{L})$ 的表达式，用 $\\{p_{k}\\}_{k=1}^{D_{\\max}}$ 和 $m$ 表示。\n\n以 $\\operatorname{Var}(\\widehat{L})$ 关于 $\\{p_{k}\\}$ 和 $m$ 的单个闭式解析表达式的形式提供您的最终答案。不需要进行数值计算，也不需要四舍五入。最终表达式中不要包含任何单位。", "solution": "该问题已经过验证，被确定为一个应用于计算系统生物学的统计分析领域中，提法恰当且有科学依据的问题。我们可以开始解题。\n\n该问题要求完成两项任务：首先，证明估计量 $\\widehat{L}$ 是真实平均路径长度 $L$ 的无偏估计量；其次，推导该估计量方差 $\\operatorname{Var}(\\widehat{L})$ 的表达式。\n\n设 $D$ 为一个随机变量，表示单个、均匀抽样的、无序的不同节点对的最短路径距离。距离的总体由所有 $d(i,j)$ 的值组成，其中 $d(i,j)$ 对应 $N_{\\text{pairs}} = \\frac{N(N-1)}{2}$ 个唯一的不同节点对。抽样是均匀的，这意味着每个节点对被选中的概率相等。\n\n根据定义，这些距离的总体均值就是平均路径长度 $L$：\n$$\nL = \\frac{1}{N_{\\text{pairs}}} \\sum_{1 \\leq i  j \\leq N} d(i,j) = \\frac{2}{N(N-1)} \\sum_{1 \\leq i  j \\leq N} d(i,j).\n$$\n由于 $D$ 是从该总体中进行一次均匀抽取的结果，其期望值 $\\mathbb{E}[D]$ 等于总体均值 $L$。我们也可以用给定的概率分布 $\\{p_k\\}$ 来表示这一点。随机抽取的距离 $D$ 的值为 $k$ 的概率是 $p_k$。根据离散随机变量期望值的定义：\n$$\n\\mathbb{E}[D] = \\sum_{k=1}^{D_{\\max}} k \\cdot \\mathbb{P}(D=k) = \\sum_{k=1}^{D_{\\max}} k p_k.\n$$\n因此，我们有恒等式 $L = \\mathbb{E}[D] = \\sum_{k=1}^{D_{\\max}} k p_k$。\n\n**第一部分：估计量 $\\widehat{L}$ 的无偏性**\n\n如果一个估计量的期望值等于它所估计的真实参数，则该估计量是无偏的。在这里，我们必须证明 $\\mathbb{E}[\\widehat{L}] = L$。\n该估计量定义为 $m$ 次独立抽样的样本均值：\n$$\n\\widehat{L} \\equiv \\frac{1}{m} \\sum_{s=1}^{m} D_{s}.\n$$\n距离 $D_1, D_2, \\dots, D_m$ 是与 $m$ 个抽样对相对应的随机变量。由于抽样是有放回地进行的，所以 $D_s$ 是独立同分布 (i.i.d.) 的随机变量。每个 $D_s$ 都与 $D$ 具有相同的分布。\n\n利用期望算子的线性性质，我们可以写出：\n$$\n\\mathbb{E}[\\widehat{L}] = \\mathbb{E}\\left[\\frac{1}{m} \\sum_{s=1}^{m} D_{s}\\right] = \\frac{1}{m} \\sum_{s=1}^{m} \\mathbb{E}[D_s].\n$$\n因为 $D_s$ 是同分布的，所以对于所有 $s \\in \\{1, 2, \\dots, m\\}$，都有 $\\mathbb{E}[D_s] = \\mathbb{E}[D]$。我们已经确定了 $\\mathbb{E}[D] = L$。\n将此代入方程：\n$$\n\\mathbb{E}[\\widehat{L}] = \\frac{1}{m} \\sum_{s=1}^{m} L = \\frac{1}{m} (m L) = L.\n$$\n由于 $\\mathbb{E}[\\widehat{L}] = L$，估计量 $\\widehat{L}$ 是平均路径长度 $L$ 的无偏估计量。\n\n**第二部分：估计量 $\\widehat{L}$ 的方差**\n\n接下来，我们用概率 $\\{p_k\\}$ 和样本大小 $m$ 来推导 $\\operatorname{Var}(\\widehat{L})$ 的表达式。\n利用方差的性质，特别是 $\\operatorname{Var}(aX) = a^2 \\operatorname{Var}(X)$，我们有：\n$$\n\\operatorname{Var}(\\widehat{L}) = \\operatorname{Var}\\left(\\frac{1}{m} \\sum_{s=1}^{m} D_{s}\\right) = \\frac{1}{m^2} \\operatorname{Var}\\left(\\sum_{s=1}^{m} D_{s}\\right).\n$$\n由于抽样是有放回的，随机变量 $D_1, D_2, \\dots, D_m$ 是独立的。对于独立的随机变量，和的方差等于方差的和：\n$$\n\\operatorname{Var}\\left(\\sum_{s=1}^{m} D_{s}\\right) = \\sum_{s=1}^{m} \\operatorname{Var}(D_s).\n$$\n此外，由于抽样是同分布的，它们的方差也相等：对于所有 $s$，都有 $\\operatorname{Var}(D_s) = \\operatorname{Var}(D)$。因此：\n$$\n\\sum_{s=1}^{m} \\operatorname{Var}(D_s) = m \\cdot \\operatorname{Var}(D).\n$$\n将此代回到 $\\operatorname{Var}(\\widehat{L})$ 的表达式中，得到样本均值方差的标准公式：\n$$\n\\operatorname{Var}(\\widehat{L}) = \\frac{1}{m^2} (m \\cdot \\operatorname{Var}(D)) = \\frac{\\operatorname{Var}(D)}{m}.\n$$\n现在，我们必须用给定的概率分布 $\\{p_k\\}$ 来表示 $\\operatorname{Var}(D)$。离散随机变量 $D$ 的方差定义为 $\\operatorname{Var}(D) = \\mathbb{E}[D^2] - (\\mathbb{E}[D])^2$。\n\n我们已经确定 $\\mathbb{E}[D] = \\sum_{k=1}^{D_{\\max}} k p_k$。\n\n接下来，我们求 $D^2$ 的期望值，也就是分布的二阶矩：\n$$\n\\mathbb{E}[D^2] = \\sum_{k=1}^{D_{\\max}} k^2 \\cdot \\mathbb{P}(D=k) = \\sum_{k=1}^{D_{\\max}} k^2 p_k.\n$$\n现在我们可以写出 $D$ 的方差：\n$$\n\\operatorname{Var}(D) = \\mathbb{E}[D^2] - (\\mathbb{E}[D])^2 = \\left(\\sum_{k=1}^{D_{\\max}} k^2 p_k\\right) - \\left(\\sum_{k=1}^{D_{\\max}} k p_k\\right)^2.\n$$\n最后，我们将 $\\operatorname{Var}(D)$ 的这个表达式代入到我们关于 $\\operatorname{Var}(\\widehat{L})$ 的公式中：\n$$\n\\operatorname{Var}(\\widehat{L}) = \\frac{1}{m} \\operatorname{Var}(D) = \\frac{1}{m} \\left[ \\left(\\sum_{k=1}^{D_{\\max}} k^2 p_k\\right) - \\left(\\sum_{k=1}^{D_{\\max}} k p_k\\right)^2 \\right].\n$$\n这就是估计量 $\\widehat{L}$ 的方差关于给定数量 $\\{p_k\\}$ 和 $m$ 的最终表达式。", "answer": "$$\\boxed{\\frac{1}{m} \\left[ \\left(\\sum_{k=1}^{D_{\\max}} k^2 p_k\\right) - \\left(\\sum_{k=1}^{D_{\\max}} k p_k\\right)^2 \\right]}$$", "id": "3288948"}, {"introduction": "将网络科学理论应用于真实的生物数据，例如基因组尺度代谢模型（GSMMs），需要细致的方法论选择。本练习将你带入一个真实的分析场景，要求你设计一个有效的分析流程，从而必须面对诸如图表示、处理“货币代谢物”以及计算可扩展性等实际问题。这有助于培养从原始生物数据中提取有意义的拓扑见解所需的批判性思维 [@problem_id:3289017]。", "problem": "在一个由化学计量矩阵 $S \\in \\mathbb{R}^{n_m \\times n_r}$ 定义的基因组尺度代谢模型 (GSMM) 中（其中 $n_m$ 是代谢物数量，$n_r$ 是反应数量），一位研究人员旨在去除通货代谢物和不连通的通路后，估计代谢物水平相互作用网络的平均最短路径长度 $L$ 和有效直径（最短路径距离的 $p$-分位数，其中 $p = 0.9$）。该模型包括可逆和不可逆反应、交换和转运反应，以及众所周知的通货代谢物，如三磷酸腺苷 (ATP)、水 ($\\mathrm{H_2O}$)、质子 ($\\mathrm{H^+}$)、烟酰胺腺嘌呤二核苷酸 (NAD$^+$)、还原型烟酰胺腺嘌呤二核苷酸 (NADH)、辅酶 A (CoA)、无机磷酸 ($\\mathrm{Pi}$) 和焦磷酸 ($\\mathrm{PP_i}$)。研究人员必须确定一个原则性的流程，以便为网络的可导航性分析生成具有科学意义的 $L$ 和有效直径的估计值。\n\n基本依据和定义：\n- 一个代谢物水平图 $G = (V, E)$ 的顶点 $V$ 对应于代谢物，有向边 $E$ 的定义如下：对于每个反应 $r$，如果代谢物 $m_s$ 是底物，代谢物 $m_p$ 是产物，则图中包含一条边 $(m_s \\rightarrow m_p)$。\n- 通货代谢物是普遍存在的辅因子，它们会产生虚假的捷径；移除它们应保持质量和电荷平衡，并避免破坏非通货代谢物之间的真实连通性。\n- 有向图的弱连通分量 (WCC) 是在其对应的无向图意义下连通的顶点的最大集合；最大的 WCC 通常被称为巨型分量。\n- 对于图 $G$，最短路径距离 $d(u,v)$ 是在所选表示（有向或无向）中节点 $u$ 和 $v$ 之间的最小边数。\n- 平均最短路径长度 $L$ 定义在可达节点对集合 $P = \\{(u,v) \\in V \\times V : u \\neq v, d(u,v)  \\infty\\}$ 上，其公式为 $L = \\frac{1}{|P|} \\sum_{(u,v) \\in P} d(u,v)$。\n- 在分位数 $p$ 处的有效直径是满足成对最短路径距离的累积分布函数 $F(d)$ 满足 $F(D_{\\mathrm{eff}}) \\ge p$ 的最小整数 $D_{\\mathrm{eff}}$。\n\n选择最能为代谢物水平网络生成无偏且可复现的 $L$ 和有效直径估计值的流程，并简要说明关键步骤的理由。\n\nA. 通过将 $S$ 映射为每个反应中从底物到产物的代谢物-代谢物边来构建有向代谢物图；通过将一份经过筛选整理的通货代谢物列表从边的构建中排除并修剪产生的孤立节点来移除它们；如果交换反应和跨室转运反应仅连接通货代谢物，则移除这些反应；在有向图上计算弱连通分量，并仅限于最大的 WCC；为进行可导航性分析，将剩余的图视为无向图以避免因反应不可逆性导致的平凡不可达性，并通过多源广度优先搜索 (BFS) 抽样（从一个包含 $k = \\lceil c \\log n \\rceil$ 个源节点的均匀随机样本中进行广度优先搜索，其中 $n = |V|$ 且 $c > 0$）来估计 $L$ 和 $p = 0.9$ 的有效直径，聚合可达对的经验最短路径分布，并报告自助法置信区间。\n\nB. 构建一个反应-代谢物二分图，保留包括通货化合物在内的所有代谢物，将边权重设置为化学计量系数和反应自由能变化，通过在整个图上使用 Dijkstra 算法计算有向加权最短路径，并将 $L$ 定义为所有节点对之间距离（包括不可达对的无限值）的平均值；对于有效直径，取所有节点对加权距离的 $p = 0.9$ 分位数，不限制分量。\n\nC. 构建有向代谢物图，通过丢弃度高于由度排名中前 $q = 0.05$ 部分确定的阈值的节点来移除通货代谢物，然后将分析限制在最大的强连通分量 (SCC) 以确保尊重方向的可达性，并通过在 SCC 上执行精确的所有节点对最短路径 (APSP) 算法计算 $L$ 和有效直径。\n\nD. 构建一个忽略反应方向的无向代谢物图；使用 $k=3$ 的 $k$-核剪枝移除不连通的通路以消除低度节点；仅当通货代谢物在 $S$ 中不满足原子平衡时才移除它们；通过从剪枝后图中的所有节点运行 BFS 来计算 $L$ 和有效直径。\n\nE. 在仅排除 ATP 和水来移除通货代谢物后，使用随机图启发式方法 $L \\approx \\frac{\\ln n}{\\ln \\langle k \\rangle}$ 和 $D_{\\mathrm{eff}} \\approx \\alpha \\frac{\\ln n}{\\ln \\langle k \\rangle}$（其中 $\\alpha$ 是常数）从有向代谢物图的度统计数据中近似计算 $L$ 和有效直径；不需要显式的最短路径计算。\n\n选择最佳选项。", "solution": "在尝试任何解决方案之前，需对问题陈述进行验证。\n\n**问题验证**\n\n**步骤 1：提取已知信息**\n- 化学计量矩阵：$S \\in \\mathbb{R}^{n_m \\times n_r}$，其中 $n_m$ 是代谢物数量，$n_r$ 是反应数量。\n- 目标：估计平均最短路径长度 $L$ 和有效直径（最短路径距离的 $p$-分位数，其中 $p = 0.9$）。\n- 网络背景：一个从 GSMM 推导出的代谢物水平相互作用网络，其中通货代谢物和不连通的通路已被移除。\n- GSMM 特征：包括可逆/不可逆反应、交换/转运反应。\n- 通货代谢物（示例）：三磷酸腺苷 (ATP)、水 ($\\mathrm{H_2O}$)、质子 ($\\mathrm{H^+}$)、烟酰胺腺嘌呤二核苷酸 (NAD$^+$)、还原型烟酰胺腺嘌呤二核苷酸 (NADH)、辅酶 A (CoA)、无机磷酸 ($\\mathrm{Pi}$) 和焦磷酸 ($\\mathrm{PP_i}$)。\n- 代谢物水平图定义：$G = (V, E)$，其中 $V$ 是代谢物。对于每个反应 $r$，如果代谢物 $m_s$ 是底物，$m_p$ 是产物，则图中包含一条边 $(m_s \\rightarrow m_p)$。\n- 移除通货代谢物的原则：必须保持质量/电荷平衡，并避免破坏真实的连通性。\n- WCC 定义：弱连通分量；最大的 WCC 是巨型分量。\n- 最短路径距离定义：$d(u,v)$ 是节点 $u$ 和 $v$ 之间的最小边数。\n- 平均最短路径长度定义：$L = \\frac{1}{|P|} \\sum_{(u,v) \\in P} d(u,v)$，定义在可达节点对集合 $P = \\{(u,v) \\in V \\times V : u \\neq v, d(u,v)  \\infty\\}$ 上。\n- 有效直径定义：满足成对最短路径距离的累积分布函数 $F(d)$ 满足 $F(D_{\\mathrm{eff}}) \\ge p$ 的最小整数 $D_{\\mathrm{eff}}$。\n\n**步骤 2：使用提取的已知信息进行验证**\n- **科学依据充分：** 该问题牢固地植根于计算系统生物学和网络科学。GSMMs、化学计量矩阵、代谢物图、通货代谢物以及诸如平均路径长度和直径等网络理论度量是该领域中标准且成熟的概念。\n- **问题明确：** 该问题是明确的。它提供了清晰、正式的定义和具体的目标：从一组选项中确定最合适且科学上最合理的网络分析流程。可以根据既定原则确定方法论中的“最佳”选择。\n- **客观性：** 问题陈述使用了精确、客观和技术性的语言。它没有主观断言或含糊不清之处。\n\n**步骤 3：结论与行动**\n问题陈述是有效的。它科学合理、定义明确且客观。将通过对照代谢网络分析的既定原则来评估所提出的各个流程，从而推导出解决方案。\n\n**解决方案推导**\n\n目标是找到一个能够产生平均最短路径长度 $L$ 和有效直径 $D_{\\mathrm{eff}}$ 的无偏且可复现估计值的流程。一个科学严谨的流程必须解决以下几个关键挑战：\n\n1.  **图表示：** 网络必须以能够表示代谢物之间关系的方式构建。从化学计量矩阵 $S$ 投射到有向代谢物图 $G=(V, E)$ 的定义是一种标准方法。\n2.  **处理通货代谢物：** 这些无处不在的小分子（如 ATP、$\\mathrm{H_2O}$）参与大量反应。如果简单地将它们包含在内，它们会充当巨大的枢纽，产生虚假的捷径，并使路径长度指标人为地降低且失去意义。必须小心地移除它们，以避免断开合法的代谢途径。黄金标准是使用一个经过生物化学筛选整理的通货代谢物列表，并通过修改图的构建方式来绕过它们，例如，将一个反应中的非通货底物直接连接到非通货产物。\n3.  **处理网络连通性：** 代谢网络通常不是完全连通的。分析应集中于新陈代谢的主体部分。标准方法是识别所有弱连通分量 (WCCs)，并将分析限制在最大的一个，即巨型分量。使用强连通分量 (SCCs) 通常过于严格，因为它会排除新陈代谢中常见的线性通路。\n4.  **处理方向性：** 不可逆反应为图带来了方向性。在有向图中，许多节点对 $(u,v)$ 可能无法到达（即 $d(u,v) = \\infty$），这使得 $L$（仅在可达对上定义）的计算变得复杂，并可能对网络的可导航性提供不完整的图像。为了评估整体拓扑结构以及代谢物在代谢图谱中的“距离”，一个常见且有效的简化方法是分析其底层的无向图。这评估了节点间的邻近度，而不管特定路径的热力学可行性。\n5.  **计算可扩展性：** GSMMs 可能很大，含有数千种代谢物。计算所有节点对的最短路径 (APSP)（例如，通过从每个节点运行广度优先搜索 (BFS)）的计算成本很高（例如，对于无权图为 $O(|V|(|V|+|E|))$）。一个标准、高效且统计上合理的方法是通过从随机选择的节点子集执行多源 BFS 来估计最短路径分布。\n\n基于这些原则，我们现在可以评估每个选项。\n\n**逐项分析**\n\n**A. 通过将 $S$ 映射为每个反应中从底物到产物的代谢物-代谢物边来构建有向代谢物图；通过将一份经过筛选整理的通货代谢物列表从边的构建中排除并修剪产生的孤立节点来移除它们；如果交换反应和跨室转运反应仅连接通货代谢物，则移除这些反应；在有向图上计算弱连通分量，并仅限于最大的 WCC；为进行可导航性分析，将剩余的图视为无向图以避免因反应不可逆性导致的平凡不可达性，并通过多源广度优先搜索 (BFS) 抽样（从一个包含 $k = \\lceil c \\log n \\rceil$ 个源节点的均匀随机样本中进行广度优先搜索，其中 $n = |V|$ 且 $c > 0$）来估计 $L$ 和 $p = 0.9$ 的有效直径，聚合可达对的经验最短路径分布，并报告自助法置信区间。**\n\n这个流程在方法论上是合理的，并与最佳实践相符。\n- **通货代谢物：** 使用“经过筛选整理的列表”并通过“从边的构建中排除”来正确移除，这是正确的、基于知识的方法。\n- **连通性：** 正确地将分析限制在最大的 WCC 上。\n- **方向性：** 正确地指出了有向图中非可达性对全局可导航性度量的问题，并恰当地建议在最终计算中将图视为无向图。\n- **计算：** 采用了适合大型图的高效且统计上有效的估计技术（多源 BFS 抽样）。\n- **严谨性：** 建议使用自助法置信区间，增加了一层统计稳健性。\n这个选项代表了一种全面、有原则且先进的方法。\n\n**结论：正确**\n\n**B. 构建一个反应-代谢物二分图，保留包括通货化合物在内的所有代谢物，将边权重设置为化学计量系数和反应自由能变化，通过在整个图上使用 Dijkstra 算法计算有向加权最短路径，并将 $L$ 定义为所有节点对之间距离（包括不可达对的无限值）的平均值；对于有效直径，取所有节点对加权距离的 $p = 0.9$ 分位数，不限制分量。**\n\n这个流程有几个关键缺陷。\n- **通货代谢物：** 它“保留包括通货化合物在内的所有代谢物”。这是一个根本性错误，将导致一个拓扑上无意义的“毛球”网络，其中充满了虚假的捷径，从而产生人为的低路径长度。\n- **图表示与权重：** 它使用二分图并引入了权重（化学计量、自由能）。虽然这种图对于其他目的（如通量分析）是有效的，但在其上计算拓扑距离并非标准做法。计算出的“最短路径”将不对应于代谢物之间的反应步数。\n- **度量计算：** 它建议对包括无限值的距离求平均。包含一个无限值的平均值就是无限大。这在数学上是无效的。$L$ 的定义明确地将平均值限制在有限距离的节点对上。\n\n**结论：不正确**\n\n**C. 构建有向代谢物图，通过丢弃度高于由度排名中前 $q = 0.05$ 部分确定的阈值的节点来移除通货代谢物，然后将分析限制在最大的强连通分量 (SCC) 以确保尊重方向的可达性，并通过在 SCC 上执行精确的所有节点对最短路径 (APSP) 算法计算 $L$ 和有效直径。**\n\n这个流程采用了有缺陷的启发式方法和定义。\n- **通货代谢物：** 它使用基于度的阈值来移除。这是一种脆弱的启发式方法，可能会错误地移除重要的非通货枢纽代谢物，或者无法移除未进入度排名前列的通货代谢物。经过筛选整理的列表要可靠得多。\n- **连通性：** 它将分析限制在最大的 SCC 上。这对于代谢网络来说过于严格，因为代谢网络包含许多重要的线性通路。这一步将丢弃网络中很大一部分重要内容。WCC 才是正确的研究对象。\n- **计算：** 它建议使用精确的 APSP，这对于基因组尺度的网络来说计算上是不可行的。\n\n**结论：不正确**\n\n**D. 构建一个忽略反应方向的无向代谢物图；使用 $k=3$ 的 $k$-核剪枝移除不连通的通路以消除低度节点；仅当通货代谢物在 $S$ 中不满足原子平衡时才移除它们；通过从剪枝后图中的所有节点运行 BFS 来计算 $L$ 和有效直径。**\n\n这个流程的每一步在方法论上都有缺陷。\n- **图构建：** 立即丢弃方向性可能会掩盖构建逻辑，尽管最终分析可能是在无向图上进行。\n- **连通性：** 它使用 $k=3$ 的 $k$-核剪枝。这是一种用于寻找密集子图的算法，而不是用于识别主要连通分量的。它会任意移除所有度小于 3 的节点，这可能会摧毁有效的外围通路。WCC 分析是正确的方法。\n- **通货代谢物：** 移除的标准（“仅当它们在 $S$ 中不满足原子平衡时”）是荒谬的。在一个经过整理的 GSMM 中，反应根据定义是原子平衡的。移除通货代谢物是出于拓扑原因，而不是因为它们参与了不平衡的反应。这个规则将无法移除它们。\n- **计算：** 它建议从所有节点运行 BFS (APSP)，这在计算上是不可行的。\n\n**结论：不正确**\n\n**E. 在仅排除 ATP 和水来移除通货代谢物后，使用随机图启发式方法 $L \\approx \\frac{\\ln n}{\\ln \\langle k \\rangle}$ 和 $D_{\\mathrm{eff}} \\approx \\alpha \\frac{\\ln n}{\\ln \\langle k \\rangle}$（其中 $\\alpha$ 是常数）从有向代谢物图的度统计数据中近似计算 $L$ 和有效直径；不需要显式的最短路径计算。**\n\n这个流程是一种过度简化，并且很可能不准确。\n- **近似方法：** 所提供的公式适用于特定的随机图模型。代谢网络不是随机的；它们具有复杂、演化而来的拓扑结构。依赖这些基于度的启发式方法而不是直接的路径计算（或稳健的估计）是为了速度而牺牲准确性，不是一种有原则的方法。\n- **通货代谢物：** 它“仅...排除 ATP 和水”。这个列表是不完整的。如问题陈述中所述，其他关键的通货代谢物，如 NAD$^+$/NADH、CoA 和磷酸盐将仍然存在，继续造成显著的拓扑伪影。\n\n**结论：不正确**\n\n总之，选项 A 描述了唯一一个在方法论上合理、计算上可行，并且符合计算系统生物学领域分析代谢网络拓扑特性既定最佳实践的流程。", "answer": "$$\\boxed{A}$$", "id": "3289017"}, {"introduction": "理解网络的鲁棒性和模块化通常需要研究其在受到扰动（例如蛋白质相互作用的移除）后性质如何变化。本练习提供了一个此类扰动的理论模型——移除连接两个模块的桥接边——并挑战你精确推导直径（$D$）和平均路径长度（$L$）的变化。这能够让你深入理解局部结构变化如何影响全局网络拓扑和可导航性 [@problem_id:3289021]。", "problem": "考虑一个模块化的蛋白质-蛋白质相互作用网络，它由两个无向、简单、无权重的模块 $G_{1}$ 和 $G_{2}$ 组成，分别包含 $n_{1}$ 和 $n_{2}$ 个节点，且 $n_{1} \\geq n_{2}$。这两个模块由唯一一条模块间桥边 $(u,v)$ 连接，其中 $u \\in G_{1}$ 且 $v \\in G_{2}$。距离以沿最短路径的跳数来衡量。令 $D_{k}$ 和 $L_{k}$ 分别表示在 $G_{k}$ 内部（$k \\in \\{1,2\\}$）计算的直径和平均路径长度，计算范围是 $G_{k}$ 内部所有无序的不同节点对。令 $\\epsilon_{1}$ 为 $u$ 在 $G_{1}$ 内部的离心率（从 $u$ 到 $G_{1}$ 中所有节点的最短路径距离的最大值），令 $\\epsilon_{2}$ 为 $v$ 在 $G_{2}$ 内部的离心率。定义 $a_{1}$ 为从 $u$ 到 $G_{1}$ 中所有其他节点（不包括 $u$）的最短路径距离的平均值，定义 $a_{2}$ 为从 $v$ 到 $G_{2}$ 中所有其他节点（不包括 $v$）的最短路径距离的平均值。假设没有其他模块间的边，因此 $G_{1}$ 中的节点与 $G_{2}$ 中的节点之间的每条路径都必须经过 $(u,v)$。\n\n仅使用图论距离、平均路径长度、直径的核心定义以及无序节点对的标准计数方法，推导在桥边 $(u,v)$ 存在的情况下，完整网络的移除前直径 $D_{\\mathrm{pre}}$ 和平均路径长度 $L_{\\mathrm{pre}}$ 的表达式。然后，假设桥边 $(u,v)$ 被移除，这将网络断开成两个模块。在生物网络的计算分析中，可导航性度量通常是针对最大连通分量报告的。根据这一惯例，令 $D_{\\mathrm{post}}$ 和 $L_{\\mathrm{post}}$ 表示移除后在最大连通分量（由于 $n_{1} \\geq n_{2}$，即为 $G_{1}$）上计算的直径和平均路径长度。\n\n计算变化量\n$$\\Delta D = D_{\\mathrm{post}} - D_{\\mathrm{pre}} \\quad \\text{和} \\quad \\Delta L = L_{\\mathrm{post}} - L_{\\mathrm{pre}}$$\n并将您的最终答案表示为关于 $n_{1}$、$n_{2}$、$D_{1}$、$D_{2}$、$L_{1}$、$L_{2}$、$\\epsilon_{1}$、$\\epsilon_{2}$、$a_{1}$ 和 $a_{2}$ 的单个闭式解析表达式。不需要进行数值计算或四舍五入。以包含 $\\Delta D$ 和 $\\Delta L$ 的双元素行矩阵形式提供您的最终答案。", "solution": "所述问题具有科学依据、是良定的、客观的，并包含足够的信息以得出唯一解。所有术语在图论及其在计算系统生物学中的应用中都是标准的。因此，我们可以进行推导。\n\n问题要求计算在移除连接两个模块 $G_1$ 和 $G_2$ 的桥边 $(u,v)$ 后，网络直径的变化量 $\\Delta D = D_{\\mathrm{post}} - D_{\\mathrm{pre}}$ 和平均路径长度的变化量 $\\Delta L = L_{\\mathrm{post}} - L_{\\mathrm{pre}}$。\n\n首先，我们确定移除后的度量指标 $D_{\\mathrm{post}}$ 和 $L_{\\mathrm{post}}$。\n移除边 $(u,v)$ 后，网络断开成两个连通分量 $G_1$ 和 $G_2$。问题指定可导航性度量是在最大连通分量上计算的。由于给定 $n_1 \\geq n_2$，最大连通分量是 $G_1$。\n因此，该连通分量的直径 $D_{\\mathrm{post}}$ 就是 $G_1$ 的直径，即给定的 $D_1$。\n$$D_{\\mathrm{post}} = D_1$$\n该连通分量的平均路径长度 $L_{\\mathrm{post}}$ 就是 $G_1$ 的平均路径长度，即给定的 $L_1$。\n$$L_{\\mathrm{post}} = L_1$$\n\n接下来，我们确定完整网络 $G = G_1 \\cup G_2 \\cup \\{(u,v)\\}$ 在移除前的度量指标 $D_{\\mathrm{pre}}$ 和 $L_{\\mathrm{pre}}$。令 $d_k(x,y)$ 为模块 $G_k$ 内节点 $x, y$ 之间的最短路径距离，令 $d(x,y)$ 为完整网络 $G$ 中的最短路径距离。\n\n为了找到直径 $D_{\\mathrm{pre}}$，我们必须找出 $G$ 中所有不同节点对之间的最大最短路径距离。对于一对节点 $(x,y)$，有三种情况：\n1. $x, y$ 都在 $G_1$ 中。它们之间的最短路径完全位于 $G_1$ 内部，所以 $d(x,y) = d_1(x,y)$。这样的最大距离是 $G_1$ 的直径，即 $D_1$。\n2. $x, y$ 都在 $G_2$ 中。类似地，最短路径位于 $G_2$ 内部，所以 $d(x,y) = d_2(x,y)$。这样的最大距离是 $D_2$。\n3. 一个节点在 $G_1$ 中，另一个在 $G_2$ 中。令 $x \\in G_1$ 且 $y \\in G_2$。由于 $(u,v)$ 是唯一的模块间边，从 $x$ 到 $y$ 的任何路径都必须经过以下序列：在 $G_1$ 中从 $x$ 到 $u$ 的路径，边 $(u,v)$，在 $G_2$ 中从 $v$ 到 $y$ 的路径。因此，最短路径为 $d(x,y) = d_1(x,u) + 1 + d_2(v,y)$。这种情况下的最大距离可以通过对所有 $x \\in G_1$ 和 $y \\in G_2$ 最大化此表达式来找到：\n$$ \\max_{x \\in G_1, y \\in G_2} d(x,y) = \\max_{x \\in G_1} d_1(x,u) + 1 + \\max_{y \\in G_2} d_2(v,y) $$\n根据定义，$\\max_{x \\in G_1} d_1(x,u)$ 是 $u$ 在 $G_1$ 中的离心率，给定为 $\\epsilon_1$。类似地，$\\max_{y \\in G_2} d_2(v,y)$ 是 $v$ 在 $G_2$ 中的离心率，给定为 $\\epsilon_2$。所以模块间的最大距离是 $\\epsilon_1 + 1 + \\epsilon_2$。\n\n总直径 $D_{\\mathrm{pre}}$ 是这三种情况下的最大值：\n$$D_{\\mathrm{pre}} = \\max(D_1, D_2, \\epsilon_1 + 1 + \\epsilon_2)$$\n\n为了找到平均路径长度 $L_{\\mathrm{pre}}$，我们将所有无序的不同节点对的最短路径距离相加，然后除以这些节点对的总数。总节点数是 $N = n_1 + n_2$。节点对的数量是 $\\binom{N}{2} = \\binom{n_1+n_2}{2}$。\n距离总和 $S_{\\mathrm{total}}$ 可以划分为三个部分：\n- $S_1$：$G_1$ 内部节点对之间的距离之和。\n- $S_2$：$G_2$ 内部节点对之间的距离之和。\n- $S_{12}$：一个节点在 $G_1$ 中，另一个在 $G_2$ 中的节点对之间的距离之和。\n\n$S_{\\mathrm{total}} = S_1 + S_2 + S_{12}$。\n根据平均路径长度 $L_k$ 的定义，我们有 $L_k = S_k / \\binom{n_k}{2}$。因此，$S_1 = L_1 \\binom{n_1}{2} = L_1 \\frac{n_1(n_1-1)}{2}$ 且 $S_2 = L_2 \\binom{n_2}{2} = L_2 \\frac{n_2(n_2-1)}{2}$。\n\n对于模块间的和 $S_{12}$，我们对所有 $x \\in G_1, y \\in G_2$ 的 $d(x,y)$ 求和：\n$$S_{12} = \\sum_{x \\in G_1} \\sum_{y \\in G_2} d(x,y) = \\sum_{x \\in G_1} \\sum_{y \\in G_2} (d_1(x,u) + 1 + d_2(v,y))$$\n我们可以将和式拆分：\n$$S_{12} = \\sum_{x \\in G_1} \\sum_{y \\in G_2} d_1(x,u) + \\sum_{x \\in G_1} \\sum_{y \\in G_2} 1 + \\sum_{x \\in G_1} \\sum_{y \\in G_2} d_2(v,y)$$\n第一项是 $\\sum_{y \\in G_2} \\left( \\sum_{x \\in G_1} d_1(x,u) \\right) = n_2 \\left( \\sum_{x \\in G_1} d_1(x,u) \\right)$。\n$a_1$ 的定义是从 $u$ 到 $G_1$ 中所有其他节点的平均距离：$a_1 = \\frac{1}{n_1-1}\\sum_{x \\in G_1, x \\neq u} d_1(x,u)$。由于 $d_1(u,u)=0$，和式 $\\sum_{x \\in G_1} d_1(x,u) = (n_1-1)a_1$。因此，第一项是 $n_2 (n_1-1) a_1$。\n第二项就是 $n_1 n_2$。\n第三项是 $\\sum_{x \\in G_1} \\left( \\sum_{y \\in G_2} d_2(v,y) \\right) = n_1 \\left( \\sum_{y \\in G_2} d_2(v,y) \\right) = n_1 (n_2-1) a_2$。\n所以，$S_{12} = n_2(n_1-1)a_1 + n_1n_2 + n_1(n_2-1)a_2$。\n\n移除前的平均路径长度是 $L_{\\mathrm{pre}} = \\frac{S_{\\mathrm{total}}}{\\binom{n_1+n_2}{2}} = \\frac{S_1+S_2+S_{12}}{\\frac{(n_1+n_2)(n_1+n_2-1)}{2}}$。\n$$L_{\\mathrm{pre}} = \\frac{L_1 \\frac{n_1(n_1-1)}{2} + L_2 \\frac{n_2(n_2-1)}{2} + n_2(n_1-1)a_1 + n_1n_2 + n_1(n_2-1)a_2}{\\frac{(n_1+n_2)(n_1+n_2-1)}{2}}$$\n$$L_{\\mathrm{pre}} = \\frac{L_1 n_1(n_1-1) + L_2 n_2(n_2-1) + 2[n_2(n_1-1)a_1 + n_1n_2 + n_1(n_2-1)a_2]}{(n_1+n_2)(n_1+n_2-1)}$$\n\n现在我们可以计算所需的变化量。\n直径的变化量是：\n$$\\Delta D = D_{\\mathrm{post}} - D_{\\mathrm{pre}} = D_1 - \\max(D_1, D_2, \\epsilon_1 + 1 + \\epsilon_2)$$\n\n平均路径长度的变化量是 $\\Delta L = L_{\\mathrm{post}} - L_{\\mathrm{pre}} = L_1 - L_{\\mathrm{pre}}$。\n$$\\Delta L = L_1 - \\frac{L_1 n_1(n_1-1) + L_2 n_2(n_2-1) + 2n_2(n_1-1)a_1 + 2n_1n_2 + 2n_1(n_2-1)a_2}{(n_1+n_2)(n_1+n_2-1)}$$\n为了简化，我们将 $L_1$ 通分：\n$$L_1 = \\frac{L_1(n_1+n_2)(n_1+n_2-1)}{(n_1+n_2)(n_1+n_2-1)} = \\frac{L_1(n_1^2+2n_1n_2+n_2^2-n_1-n_2)}{(n_1+n_2)(n_1+n_2-1)}$$\n$$L_1 = \\frac{L_1 n_1(n_1-1) + L_1 n_2(n_2-1) + 2 L_1 n_1n_2}{(n_1+n_2)(n_1+n_2-1)}$$\n将此代入 $\\Delta L$ 的表达式中：\n$$\\Delta L = \\frac{[L_1 n_1(n_1-1) + L_1 n_2(n_2-1) + 2 L_1 n_1n_2] - [L_1 n_1(n_1-1) + L_2 n_2(n_2-1) + 2n_2(n_1-1)a_1 + 2n_1n_2 + 2n_1(n_2-1)a_2]}{(n_1+n_2)(n_1+n_2-1)}$$\n$L_1 n_1(n_1-1)$ 项被消去。我们将分子中剩余的项分组：\n$$ \\text{分子} = (L_1 n_2(n_2-1) - L_2 n_2(n_2-1)) + (2L_1 n_1n_2 - 2n_1n_2) - 2n_2(n_1-1)a_1 - 2n_1(n_2-1)a_2 $$\n$$ \\text{分子} = (L_1 - L_2)n_2(n_2-1) + 2n_1n_2(L_1-1) - 2n_2(n_1-1)a_1 - 2n_1(n_2-1)a_2 $$\n因此，$\\Delta L$ 的最终表达式是：\n$$\\Delta L = \\frac{(L_1 - L_2)n_2(n_2-1) + 2n_1n_2(L_1 - 1) - 2n_2(n_1-1)a_1 - 2n_1(n_2-1)a_2}{(n_1+n_2)(n_1+n_2-1)}$$\n\n最终答案由 $\\Delta D$ 和 $\\Delta L$ 的表达式组成。", "answer": "$$\\boxed{\\begin{pmatrix} D_1 - \\max(D_1, D_2, \\epsilon_1 + \\epsilon_2 + 1)  \\frac{(L_1 - L_2)n_2(n_2-1) + 2n_1n_2(L_1 - 1) - 2n_2(n_1-1)a_1 - 2n_1(n_2-1)a_2}{(n_1+n_2)(n_1+n_2-1)} \\end{pmatrix}}$$", "id": "3289021"}]}