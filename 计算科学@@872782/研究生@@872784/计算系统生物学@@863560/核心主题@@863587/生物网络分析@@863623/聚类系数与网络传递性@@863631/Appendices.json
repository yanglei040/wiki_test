{"hands_on_practices": [{"introduction": "生物网络中的相互作用通常具有不同的强度，这些强度可以用边的权重来表示。因此，仅仅计算连接的数量是不够的，我们需要引入加权聚类系数。本练习 [@problem_id:3295345] 将指导你为一个小型网络计算两种主流的加权局部聚类系数。通过这个过程，你将亲身体会到不同的数学定义（例如，算术平均与几何平均）如何影响我们对网络局部拓扑结构的解读，这对于在研究中选择和解释正确的网络度量至关重要。", "problem": "考虑一个小的无向加权相互作用网络，该网络模拟了蛋白质-蛋白质相互作用（PPI）网络中的一个局部邻域。设中心蛋白质为节点 $i$，其有四个邻居节点 $j$、$k$、$l$ 和 $m$。假设节点 $i$ 的邻居之间具有以下拓扑结构：仅存在邻居间的边 $(j,k)$、$(k,l)$ 和 $(l,m)$，因此三元组 $(i,j,k)$、$(i,k,l)$ 和 $(i,l,m)$ 构成了唯一包含节点 $i$ 的三角形。所有其他邻居对之间没有边相连。设与节点 $i$ 相邻的边以及其邻居之间的边的权重是异构的，具体如下：\n$$\nw_{ij} = 8,\\quad w_{ik} = 1,\\quad w_{il} = 8,\\quad w_{im} = 1,\n$$\n和\n$$\nw_{jk} = 1,\\quad w_{kl} = 8,\\quad w_{lm} = 1.\n$$\n在这个导出子图中不存在其他边。\n\n在计算系统生物学中，节点周围的加权聚类用于量化其局部邻域内三元交互作用的强度。两种广泛使用的加权局部聚类系数是由 Barrat 和 Onnela 提出的。对于 Barrat 系数，使用基于每个闭合三元组中与 $i$ 相邻的两条边的算术平均值的原始强度归一化定义。对于 Onnela 系数，使用基于几何平均值的强度，并进行归一化 $\\hat{w}_{uv} = w_{uv}/W_{\\max}$，其中 $W_{\\max}$ 是整个网络中的最大边权重。将节点 $i$ 的局部加权聚类定义为 $i$ 的所有无序邻居对上的平均强度（即，除以 $k_i(k_i-1)/2$）。\n\n从度、强度、连通三元组和加权三角形强度的核心定义出发，以精确形式计算节点 $i$ 的加权局部聚类系数 $C_i^{\\mathrm{Barrat}}$ 和 $C_i^{\\mathrm{Onnela}}$。然后，（在你的推导中定性地）解释边权重的异构性如何不同地影响这两个系数的大小。将你的最终数值答案表示为精确分数。无需四舍五入。这些系数是无量纲的。", "solution": "该问题陈述清晰，具有网络理论的科学基础，并提供了计算所需聚类系数的所有必要信息。所有数据都是一致的，并且定义虽然以通俗的方式描述，但与文献中的标准公式相对应。因此，该问题是有效的。\n\n我们首先正式定义中心节点 $i$ 周围局部网络的属性。\n\n节点 $i$ 的邻居集合是 $\\{ j, k, l, m \\}$。\n节点 $i$ 的度是其邻居的数量，因此 $k_i = 4$。\n与节点 $i$ 相邻的边权重为 $w_{ij} = 8$、$w_{ik} = 1$、$w_{il} = 8$ 和 $w_{im} = 1$。\n节点 $i$ 的强度 $s_i$ 是与其相连的边的权重之和：\n$$s_i = \\sum_{v \\in \\{j,k,l,m\\}} w_{iv} = w_{ij} + w_{ik} + w_{il} + w_{im} = 8 + 1 + 8 + 1 = 18.$$\n问题指出，节点 $i$ 的邻居之间仅有的边是 $(j,k)$、$(k,l)$ 和 $(l,m)$。这意味着恰好有三个包含节点 $i$ 的闭合三角形：$T_1 = (i,j,k)$、$T_2 = (i,k,l)$ 和 $T_3 = (i,l,m)$。闭合这些三角形的边的权重为 $w_{jk} = 1$、$w_{kl} = 8$ 和 $w_{lm} = 1$。\n\n现在我们将计算节点 $i$ 的两个指定的加权局部聚类系数。\n\n**1. Barrat 加权局部聚类系数 ($C_i^{\\mathrm{Barrat}}$)**\n\n节点 $i$ 的 Barrat 系数定义如下：\n$$C_i^{\\mathrm{Barrat}} = \\frac{1}{s_i (k_i - 1)} \\sum_{u, v} \\frac{w_{iu} + w_{iv}}{2} a_{iu} a_{iv} a_{uv},$$\n其中，求和遍历所有不同于 $i$ 的节点对 $(u,v)$，$a_{xy}$ 是邻接矩阵的一个元素（如果 $x$ 和 $y$ 之间存在边，则 $a_{xy}=1$，否则为 $0$）。乘积 $a_{iu} a_{iv} a_{uv}$ 仅当节点 $i, u, v$ 形成一个三角形时才为 $1$。问题指定每个三角形的贡献是“与 $i$ 相邻的两条边的算术平均值”，这对应于项 $(w_{iu} + w_{iv})/2$。\n\n分母是 $s_i(k_i - 1) = 18 \\times (4 - 1) = 18 \\times 3 = 54$。\n\n分子是来自三个三角形的贡献之和：\n- 对于三角形 $T_1 = (i,j,k)$：贡献为 $\\frac{w_{ij} + w_{ik}}{2} = \\frac{8 + 1}{2} = \\frac{9}{2}$。\n- 对于三角形 $T_2 = (i,k,l)$：贡献为 $\\frac{w_{ik} + w_{il}}{2} = \\frac{1 + 8}{2} = \\frac{9}{2}$。\n- 对于三角形 $T_3 = (i,l,m)$：贡献为 $\\frac{w_{il} + w_{im}}{2} = \\frac{8 + 1}{2} = \\frac{9}{2}$。\n\n分子的总和是 $\\frac{9}{2} + \\frac{9}{2} + \\frac{9}{2} = 3 \\times \\frac{9}{2} = \\frac{27}{2}$。\n\n因此，Barrat 系数为：\n$$C_i^{\\mathrm{Barrat}} = \\frac{27/2}{54} = \\frac{27}{2 \\times 54} = \\frac{27}{108} = \\frac{1}{4}.$$\n\n**2. Onnela 加权局部聚类系数 ($C_i^{\\mathrm{Onnela}}$)**\n\nOnnela 系数被定义为节点 $i$ 的所有无序邻居对上的平均强度。一个潜在三角形 $(i,u,v)$ 的强度是其归一化边权重的几何平均值。归一化公式为 $\\hat{w}_{uv} = w_{uv} / W_{\\max}$。\n公式为：\n$$C_i^{\\mathrm{Onnela}} = \\frac{1}{\\binom{k_i}{2}} \\sum_{u,v} (\\hat{w}_{iu} \\hat{w}_{uv} \\hat{w}_{vi})^{1/3},$$\n其中，求和遍历节点 $i$ 的所有无序邻居对 $\\{u,v\\}$。如果一条边不存在，其权重为 $0$，则该对的项为 $0$。\n\n首先，我们确定最大权重 $W_{\\max}$。所有边权重的集合是 $\\{8, 1, 8, 1, 1, 8, 1\\}$。因此，$W_{\\max} = 8$。\n接下来，我们用 $W_{\\max}$ 归一化所有权重：\n- $\\hat{w}_{ij} = w_{ij}/8 = 8/8 = 1$。\n- $\\hat{w}_{ik} = w_{ik}/8 = 1/8$。\n- $\\hat{w}_{il} = w_{il}/8 = 8/8 = 1$。\n- $\\hat{w}_{im} = w_{im}/8 = 1/8$。\n- $\\hat{w}_{jk} = w_{jk}/8 = 1/8$。\n- $\\hat{w}_{kl} = w_{kl}/8 = 8/8 = 1$。\n- $\\hat{w}_{lm} = w_{lm}/8 = 1/8$。\n\n分母中的归一化因子是邻居对的总数：$\\binom{k_i}{2} = \\binom{4}{2} = \\frac{4 \\times 3}{2} = 6$。\n\n分子是 6 个邻居对中每个对的强度之和。只有形成三角形的 3 对邻居才会有非零贡献。\n- 对于三角形 $T_1 = (i,j,k)$：强度为 $(\\hat{w}_{ij} \\hat{w}_{ik} \\hat{w}_{jk})^{1/3} = (1 \\times \\frac{1}{8} \\times \\frac{1}{8})^{1/3} = (\\frac{1}{64})^{1/3} = \\frac{1}{4}$。\n- 对于三角形 $T_2 = (i,k,l)$：强度为 $(\\hat{w}_{ik} \\hat{w}_{il} \\hat{w}_{kl})^{1/3} = (\\frac{1}{8} \\times 1 \\times 1)^{1/3} = (\\frac{1}{8})^{1/3} = \\frac{1}{2}$。\n- 对于三角形 $T_3 = (i,l,m)$：强度为 $(\\hat{w}_{il} \\hat{w}_{im} \\hat{w}_{lm})^{1/3} = (1 \\times \\frac{1}{8} \\times \\frac{1}{8})^{1/3} = (\\frac{1}{64})^{1/3} = \\frac{1}{4}$。\n另外三对邻居 $(j,l)$、$(j,m)$ 和 $(k,m)$ 没有连接边，因此它们的三角形强度为 $0$。\n\n分子的总和是 $\\frac{1}{4} + \\frac{1}{2} + \\frac{1}{4} = 1$。\n\n因此，Onnela 系数为：\n$$C_i^{\\mathrm{Onnela}} = \\frac{1}{6}.$$\n\n**3. 权重异构性影响的解释**\n\n我们得到 $C_i^{\\mathrm{Barrat}} = 1/4 = 0.25$ 和 $C_i^{\\mathrm{Onnela}} = 1/6 \\approx 0.167$。由于对边权重的处理方式不同，这两个系数对局部聚类的评估也不同。\n\nBarrat 系数 $C_i^{\\mathrm{Barrat}}$ 只考虑与中心节点 $i$ 相邻的边（三角形的“辐条”）的权重 $w_{iu}$ 和 $w_{iv}$。它使用它们的算术平均值 $(w_{iu}+w_{iv})/2$。在这个问题中，三个三角形的辐条权重对分别为 $(8,1)$、$(1,8)$ 和 $(8,1)$。因为算术平均值是可交换的，所以在归一化之前，每个三角形对分子总和的贡献量相同，均为 $(8+1)/2 = 4.5$。因此，该系数对三角形“闭合”边（例如 $w_{jk}$）的权重不敏感，并且只要和相同，它对权重如何在不同三角形的辐条之间分布也不敏感。\n\nOnnela 系数 $C_i^{\\mathrm{Onnela}}$ 通过几何平均值 $(\\hat{w}_{iu}\\hat{w}_{uv}\\hat{w}_{vi})^{1/3}$ 包含了三角形所有三条边的权重。几何平均值对小值非常敏感；一条权重非常小的边会急剧降低三角形的总强度。\n- 三角形 $T_2=(i,k,l)$ 的归一化边权重为 $(\\frac{1}{8}, 1, 1)$。其强度为 $(\\frac{1}{8})^{1/3} = \\frac{1}{2}$。两条强边补偿了单条弱边的影响。\n- 三角形 $T_1=(i,j,k)$ 和 $T_3=(i,l,m)$ 的归一化边权重为 $(1, \\frac{1}{8}, \\frac{1}{8})$。它们的强度为 $(\\frac{1}{64})^{1/3}=\\frac{1}{4}$。两条弱边的存在严重降低了强度。\n\n总而言之，边权重的异构性对 Onnela 系数的影响更为深远。它区分了“大部分强”的三角形 $T_2$ 和“大部分弱”的三角形 $T_1$ 和 $T_3$。Barrat 系数通过忽略闭合边的权重并对辐条使用算术平均值，将所有三个三角形视为等效，未能捕捉到这种拓扑和权重上的细微差别。这导致 $C_i^{\\mathrm{Onnela}}$ 的总体值较低，因为它被两个低强度三角形拉低了。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{1}{4}  \\frac{1}{6} \\end{pmatrix}}$$", "id": "3295345"}, {"introduction": "在网络分析中，一个常见的误区是想当然地认为不同的网络度量指标是相互关联的。例如，一个具有清晰模块化结构（高模块度）的网络，是否必然也具有密集的局部连接（高传递性）？本练习 [@problem_id:3295266] 是一个思想实验，旨在挑战这种直觉。通过构建具有相同模块度但不同传递性的网络图，你将深入理解这两种基本度量分别捕捉了网络组织的哪些不同方面，从而避免在分析中做出简单化的结论。", "problem": "一个由$8$个蛋白质组成的蛋白质-蛋白质相互作用网络被假设包含两个对应于蛋白质复合物的生物模块。设节点集为$\\{1,2,3,4,5,6,7,8\\}$，并固定模块分配（划分）为$\\mathcal{P}=\\{\\{1,2,3,4\\},\\{5,6,7,8\\}\\}$。你将比较模块度$Q$（相对于$\\mathcal{P}$，使用标准的Newman–Girvan无向简单图定义）和全局聚类系数（传递性）$T$（定义为三角形数量的三倍除以连通三元组的数量）。不使用问题陈述中任何预先推导的公式，仅依赖这些标准定义作为基本依据。\n\n选择一个选项，该选项在给定的顶点集上正确构造了一对无向简单图$G_{\\mathrm{A}}$和$G_{\\mathrm{B}}$，两者都相对于固定的划分$\\mathcal{P}$进行评估，使得$Q(G_{\\mathrm{A}};\\mathcal{P})=Q(G_{\\mathrm{B}};\\mathcal{P})$而$T(G_{\\mathrm{A}})\\neq T(G_{\\mathrm{B}})$，并且该选项提供了一个有效的、基于原理的论证，解释了为什么高模块度不意味着高聚类，高聚类也不意味着高模块度。\n\nA. 定义$G_{\\mathrm{A}}$：在每个模块内部放置一个$4$-环，并添加两条模块间边：\n- $\\{1,2,3,4\\}$内的模块内边：$\\{1,2\\},\\{2,3\\},\\{3,4\\},\\{4,1\\}$。\n- $\\{5,6,7,8\\}$内的模块内边：$\\{5,6\\},\\{6,7\\},\\{7,8\\},\\{8,5\\}$。\n- 模块间边：$\\{1,5\\},\\{3,7\\}$。\n定义$G_{\\mathrm{B}}$：保持每个模块的模块内边和模块间边总数与$G_{\\mathrm{A}}$相同，度序列也相同，但在每个模块内部进行重连，以在每个模块中创建一个三角形：\n- $\\{1,2,3,4\\}$内的模块内边：$\\{1,2\\},\\{2,3\\},\\{1,3\\},\\{3,4\\}$。\n- $\\{5,6,7,8\\}$内的模块内边：$\\{5,6\\},\\{6,7\\},\\{5,7\\},\\{7,8\\}$。\n- 模块间边：$\\{1,5\\},\\{4,8\\}$。\n论断：相对于$\\mathcal{P}$，两个图具有相同的模块度$Q$，因为它们每个模块内的边数相同，每个模块的度之和也相同，但它们具有不同的全局聚类系数$T$，因为$G_{\\mathrm{A}}$没有三角形，而$G_{\\mathrm{B}}$有两个三角形（每个模块一个）。这表明高模块度不意味着高聚类，反之亦然，因为模块度取决于相对于基于度的零模型，有多少边落在模块内部，而$T$取决于闭合三元组的普遍性，这可以通过在不改变模块内/间边数或每个模块的度之和的情况下重连内部边来改变。\n\nB. 定义$G_{\\mathrm{C}}$与选项A中的$G_{\\mathrm{A}}$完全相同。定义$G_{\\mathrm{D}}$：在$G_{\\mathrm{C}}$中删除模块内边$\\{4,1\\}$和$\\{8,5\\}$，并添加模块间边$\\{4,6\\}$和$\\{2,8\\}$。论断：$Q(G_{\\mathrm{C}};\\mathcal{P})=Q(G_{\\mathrm{D}};\\mathcal{P})$而$T$不同，这表明模块度和聚类之间没有蕴含关系。\n\nC. 定义$G_{\\mathrm{E}}$：取选项A中的$G_{\\mathrm{A}}$，并将节点$2$重新标记为$4$，节点$4$重新标记为$2$（模块内的一种对称性），其余所有边保持不变；令$G_{\\mathrm{F}}=G_{\\mathrm{A}}$。论断：$Q(G_{\\mathrm{E}};\\mathcal{P})=Q(G_{\\mathrm{F}};\\mathcal{P})$但$T(G_{\\mathrm{E}})\\neq T(G_{\\mathrm{F}})$，表明在相同模块度下聚类不同。\n\nD. 使用平凡划分$\\mathcal{P}_{\\mathrm{all}}=\\{\\{1,2,3,4,5,6,7,8\\}\\}$，它将所有节点放入一个模块中。设$G_{\\mathrm{G}}$是任何具有许多三角形的图（例如，两个共享一条边的$4$-团的并集），$G_{\\mathrm{H}}$是任何没有三角形的图（例如，一个$8$-环）。论断：$Q(G_{\\mathrm{G}};\\mathcal{P}_{\\mathrm{all}})=Q(G_{\\mathrm{H}};\\mathcal{P}_{\\mathrm{all}})$且$G_{\\mathrm{G}}$中的高$T$意味着高$Q$，因此高聚类意味着高模块度；类似地，低$T$意味着低$Q$。", "solution": "问题陈述已经过验证，是合理的。它要求找出一个选项，该选项在一个顶点集$V=\\{1,2,3,4,5,6,7,8\\}$上，使用固定的划分$\\mathcal{P}=\\{\\{1,2,3,4\\},\\{5,6,7,8\\}\\}$，构造了两个图$G_{\\mathrm{A}}$和$G_{\\mathrm{B}}$，使得它们的模块度相等，$Q(G_{\\mathrm{A}};\\mathcal{P})=Q(G_{\\mathrm{B}};\\mathcal{P})$，但它们的全局聚类系数（传递性）不相等，$T(G_{\\mathrm{A}})\\neq T(G_{\\mathrm{B}})$。该选项还必须为这一现象提供一个正确的、基于原理的解释。\n\n首先，我们为一个具有邻接矩阵$A$、$n=|V|$个顶点和$m=|E|$条边的无向简单图$G=(V, E)$建立基本定义。\n\n对于一个划分$\\mathcal{P}=\\{C_1, \\dots, C_r\\}$，模块度$Q$由以下公式给出：\n$$Q = \\sum_{s=1}^{r} \\left( \\frac{e_s}{m} - \\left(\\frac{d_s}{2m}\\right)^2 \\right)$$\n其中$e_s$是社群$C_s$内的边数，而$d_s = \\sum_{i \\in C_s} k_i$是社群$C_s$中顶点的度之和。在这个问题中，划分有两个模块，$C_1 = \\{1,2,3,4\\}$和$C_2 = \\{5,6,7,8\\}$。\n\n全局聚类系数，或称传递性$T$，定义为：\n$$T = \\frac{3 \\times (\\text{三角形的数量})}{(\\text{连通三元组的数量})}$$\n三角形的数量$\\tau_3$是满足$\\{i,j\\},\\{j,k\\},\\{k,i\\} \\in E$的三个顶点集合$\\{i,j,k\\}$的数量。连通三元组的数量是长度为2的路径的数量，可以计算为$\\sum_{i \\in V} \\binom{k_i}{2}$，其中$k_i$是顶点$i$的度。\n\n我们现在将根据这些定义评估每个选项。\n\n### 选项A\n\n**图$G_{\\mathrm{A}}$：**\n-   模块内边：$\\{1,2\\}, \\{2,3\\}, \\{3,4\\}, \\{4,1\\}$（$C_1$中的一个$4$-环）和$\\{5,6\\}, \\{6,7\\}, \\{7,8\\}, \\{8,5\\}$（$C_2$中的一个$4$-环）。\n-   模块间边：$\\{1,5\\}, \\{3,7\\}$。\n-   总边数：$m_{\\mathrm{A}} = 4 + 4 + 2 = 10$。\n-   每个模块的内部边数：$e_{1,\\mathrm{A}}=4$, $e_{2,\\mathrm{A}}=4$。\n-   度：\n    -   $k_1=3$, $k_2=2$, $k_3=3$, $k_4=2$。$C_1$的度之和：$d_{1,\\mathrm{A}} = 3+2+3+2=10$。\n    -   $k_5=3$, $k_6=2$, $k_7=3$, $k_8=2$。$C_2$的度之和：$d_{2,\\mathrm{A}} = 3+2+3+2=10$。\n-   模块度$Q(G_{\\mathrm{A}};\\mathcal{P})$：\n    $$Q(G_{\\mathrm{A}};\\mathcal{P}) = \\left(\\frac{4}{10} - \\left(\\frac{10}{2 \\cdot 10}\\right)^2\\right) + \\left(\\frac{4}{10} - \\left(\\frac{10}{2 \\cdot 10}\\right)^2\\right) = 2 \\left(\\frac{2}{5} - \\frac{1}{4}\\right) = 2 \\left(\\frac{8-5}{20}\\right) = \\frac{3}{10}.$$\n-   图$G_{\\mathrm{A}}$中的三角形：该图由两个通过两条边连接的$4$-环组成。没有$3$-环（三角形）。因此，三角形的数量$\\tau_{3,\\mathrm{A}}=0$。\n-   传递性$T(G_{\\mathrm{A}})$：由于$\\tau_{3,\\mathrm{A}}=0$，我们有$T(G_{\\mathrm{A}}) = 0$。\n\n**图$G_{\\mathrm{B}}$：**\n-   模块内边：$\\{1,2\\}, \\{2,3\\}, \\{1,3\\}, \\{3,4\\}$（$C_1$中的三角形$\\{1,2,3\\}$加上边$\\{3,4\\}$）和$\\{5,6\\}, \\{6,7\\}, \\{5,7\\}, \\{7,8\\}$（$C_2$中的三角形$\\{5,6,7\\}$加上边$\\{7,8\\}$）。\n-   模块间边：$\\{1,5\\}, \\{4,8\\}$。\n-   总边数：$m_{\\mathrm{B}} = 4 + 4 + 2 = 10$。\n-   每个模块的内部边数：$e_{1,\\mathrm{B}}=4$, $e_{2,\\mathrm{B}}=4$。\n-   度：\n    -   $k_1=3$, $k_2=2$, $k_3=3$, $k_4=2$。$C_1$的度之和：$d_{1,\\mathrm{B}} = 3+2+3+2=10$。\n    -   $k_5=3$, $k_6=2$, $k_7=3$, $k_8=2$。$C_2$的度之和：$d_{2,\\mathrm{B}} = 3+2+3+2=10$。\n-   模块度$Q(G_{\\mathrm{B}};\\mathcal{P})$：$m$、$e_1$、$e_2$、$d_1$和$d_2$的值与$G_{\\mathrm{A}}$的相同。\n    $$Q(G_{\\mathrm{B}};\\mathcal{P}) = \\left(\\frac{4}{10} - \\left(\\frac{10}{20}\\right)^2\\right) + \\left(\\frac{4}{10} - \\left(\\frac{10}{20}\\right)^2\\right) = \\frac{3}{10}.$$\n    因此，$Q(G_{\\mathrm{A}};\\mathcal{P}) = Q(G_{\\mathrm{B}};\\mathcal{P})$。\n-   图$G_{\\mathrm{B}}$中的三角形：根据构造，每个模块中有一个三角形：$\\{1,2,3\\}$和$\\{5,6,7\\}$。没有其他三角形。因此，$\\tau_{3,\\mathrm{B}}=2$。\n-   传递性$T(G_{\\mathrm{B}})$：度序列为$(3,2,3,2,3,2,3,2)$，与$G_{\\mathrm{A}}$相同。\n    连通三元组的数量 = $\\sum_i \\binom{k_i}{2} = 4 \\times \\binom{3}{2} + 4 \\times \\binom{2}{2} = 4 \\times 3 + 4 \\times 1 = 16$。\n    $$T(G_{\\mathrm{B}}) = \\frac{3 \\times \\tau_{3,\\mathrm{B}}}{16} = \\frac{3 \\times 2}{16} = \\frac{6}{16} = \\frac{3}{8}.$$\n    显然，$T(G_{\\mathrm{A}}) = 0 \\neq T(G_{\\mathrm{B}}) = 3/8$。\n\n这个构造是有效的。附带的解释也是正确的：模块度取决于边在模块之间和模块内部的分布（一个粗粒度属性），而传递性则取决于产生三角形的精确局部连接方式。这个例子表明，可以在保持与模块度相关的参数（$m$、$e_s$、$d_s$）不变的情况下，通过改变局部拓扑来改变三角形的数量，从而将$Q$和$T$解耦。\n\n结论：**正确**。\n\n### 选项B\n\n该选项定义$G_{\\mathrm{C}} = G_{\\mathrm{A}}$。所以，$Q(G_{\\mathrm{C}};\\mathcal{P}) = 3/10$。图$G_{\\mathrm{D}}$由$G_{\\mathrm{C}}$通过删除两条模块内边（$\\{4,1\\}$和$\\{8,5\\}$）并添加两条模块间边（$\\{4,6\\}$和$\\{2,8\\}$）创建。\n-   在$G_{\\mathrm{D}}$中，模块内边数变为$e_{1,\\mathrm{D}}=3$和$e_{2,\\mathrm{D}}=3$。\n-   总边数保持为$m_{\\mathrm{D}}=10$。\n-   节点度被重新配置，但每个模块的度之和保持不变：$d_{1,\\mathrm{D}}=10$和$d_{2,\\mathrm{D}}=10$。\n-   $G_{\\mathrm{D}}$的模块度为：\n    $$Q(G_{\\mathrm{D}};\\mathcal{P}) = \\left(\\frac{3}{10} - \\left(\\frac{10}{20}\\right)^2\\right) + \\left(\\frac{3}{10} - \\left(\\frac{10}{20}\\right)^2\\right) = 2 \\left(\\frac{3}{10} - \\frac{1}{4}\\right) = 2 \\left(\\frac{6-5}{20}\\right) = \\frac{1}{10}.$$\n声称$Q(G_{\\mathrm{C}};\\mathcal{P}) = Q(G_{\\mathrm{D}};\\mathcal{P})$是错误的，因为$3/10 \\neq 1/10$。模块内边数的改变直接影响了模块度分数。\n\n结论：**错误**。\n\n### 选项C\n\n该选项定义$G_{\\mathrm{F}}=G_{\\mathrm{A}}$。图$G_{\\mathrm{E}}$是通过在$G_{\\mathrm{A}}$中重新标记节点$2$和$4$而形成的。$G_{\\mathrm{A}}$在第一个模块内的边形成一个$4$-环$1-2-3-4-1$。交换节点$2$和$4$的标签会得到边$\\{1,4\\}, \\{4,3\\}, \\{3,2\\}, \\{2,1\\}$，这仍然是同一个环$1-4-3-2-1$。模块间边$\\{1,5\\}$和$\\{3,7\\}$连接到节点$1$和$3$，它们不受重新标记的影响。因此，$G_{\\mathrm{E}}$中的边集与$G_{\\mathrm{F}}=G_{\\mathrm{A}}$中的边集相同。图$G_{\\mathrm{E}}$和$G_{\\mathrm{F}}$是相同的。\n由于图是相同的，它们的所有属性也必须相同。这意味着$Q(G_{\\mathrm{E}};\\mathcal{P})=Q(G_{\\mathrm{F}};\\mathcal{P})$且$T(G_{\\mathrm{E}})=T(G_{\\mathrm{F}})$。该选项声称$T(G_{\\mathrm{E}})\\neq T(G_{\\mathrm{F}})$，这是错误的。\n\n结论：**错误**。\n\n### 选项D\n\n这个选项建议使用一个平凡划分$\\mathcal{P}_{\\mathrm{all}}=\\{\\{1,2,3,4,5,6,7,8\\}\\}$，它将所有节点放入一个社群中。这与问题的前提“使用固定的划分$\\mathcal{P}=\\{\\{1,2,3,4\\},\\{5,6,7,8\\}\\}$”相矛盾。\n对于任何具有$m$条边的图$G$，相对于平凡划分的模块度总是零：\n$$Q(G;\\mathcal{P}_{\\mathrm{all}}) = \\frac{m}{m} - \\left(\\frac{2m}{2m}\\right)^2 = 1-1=0.$$\n因此，尽管对于任意两个图$G_{\\mathrm{G}}$和$G_{\\mathrm{H}}$，$Q(G_{\\mathrm{G}};\\mathcal{P}_{\\mathrm{all}}) = Q(G_{\\mathrm{H}};\\mathcal{P}_{\\mathrm{all}})=0$确实成立，但所提供的论证是“$G_{\\mathrm{G}}$中的高$T$意味着高$Q$”。这与例子直接矛盾，在例子中$G_G$可以有很高的$T$但$Q=0$。这个推理是谬误的且内部不一致。\n\n结论：**错误**。\n\n根据详细分析，只有选项A正确地构造了所需的图，并提供了有效的、基于原理的解释。", "answer": "$$\\boxed{A}$$", "id": "3295266"}, {"introduction": "将理论计算应用于真实世界的大规模数据，需要高效的算法。对于大型生物网络而言，暴力枚举所有可能的三角形组合在计算上是不可行的。本编程练习 [@problem_id:3295327] 将引导你实现一种强大且广泛使用的三角形计数技术。你将通过实现一个基于简并度排序 (degeneracy ordering) 的算法，来显著加速三角形计数过程，这是计算局部和全局聚类系数的核心步骤。这项实践将帮助你跨越理论概念与大规模网络分析所需的实用计算技能之间的鸿沟。", "problem": "给定一个由稀疏邻接表表示的简单、无向、无自环图族。每个图 $G = (V,E)$ 的顶点被标记为整数 $0,1,\\dots,n-1$，并有一个邻接表，为每个顶点 $i$ 编码其邻居集合 $N(i) \\subseteq V \\setminus \\{i\\}$，使得对于任何 $i \\neq j$，$(i,j) \\in E$ 当且仅当 $j \\in N(i)$ 且 $i \\in N(j)$。令 $k_i = |N(i)|$ 表示顶点 $i$ 的度。三角形是一个 3-团 $\\{i,j,\\ell\\}$，其中 $(i,j),(j,\\ell),(\\ell,i) \\in E$。与顶点 $i$ 关联的三角形数量为 $t_i$。顶点 $i$ 的局部聚类系数定义为：如果 $k_i  2$，则 $C_i = 0$；如果 $k_i \\ge 2$，则 $C_i = \\dfrac{2 t_i}{k_i(k_i - 1)}$。全局传递性（也称为全局聚类系数）定义为 $G = \\dfrac{3 T}{\\sum_{i \\in V} \\binom{k_i}{2}}$，其中 $T$ 是 $G$ 中不同三角形的总数；如果分母为 $0$，则按惯例取 $G = 0$。\n\n设计并实现一个算法，该算法在给定 $G$ 的稀疏邻接表的情况下，使用节点排序和前向邻域的集合交集来计算三角形，并计算 $t_i$、$C_i$ 和 $G$。该算法必须：\n- 选择顶点的排序 $\\pi: V \\to \\{0,1,\\dots,n-1\\}$，并将每条无向边 $(i,j)$ 从排序较小的端点定向到排序较大的端点，从而产生前向邻域 $N^+(i) = \\{ j \\in N(i) : \\pi(i)  \\pi(j) \\}$。\n- 通过相交前向邻域来计算三角形，即通过枚举满足 $j \\in N^+(i)$ 的点对 $(i,j)$ 并累加 $|N^+(i) \\cap N^+(j)|$。\n- 从第一性原理出发，论证为什么集合交集的总工作量导致运行时间以 $O\\!\\left( \\sum_{i \\in V} |N^+(i)|^2 \\right)$ 为界，以及为什么简并度排序（按非递减核数排序）对所有 $i$ 都产生 $|N^+(i)| \\le \\kappa$（其中 $\\kappa$ 是图的简并度），这意味着一个 $O(m \\kappa)$ 的界限，其中 $m = |E|$。\n\n您必须通过从剩余顶点的导出子图中反复移除当前度最小的顶点来实现简并度排序，以获得一个按非递减核数排序的 $\\pi$。使用此排序来定义前向邻域并执行集合交集以计算三角形，然后根据上述定义计算 $t_i$，接着计算 $C_i$ 和 $G$。\n\n测试套件。将您的实现应用于以下图（每个图由其邻接表描述；对于每个节点 $i$，我们列出其邻居 $N(i)$）：\n\n- 图 $\\mathcal{G}_1$ ($n = 3$)：$N(0) = \\{1,2\\}$, $N(1) = \\{0,2\\}$, $N(2) = \\{0,1\\}$。\n- 图 $\\mathcal{G}_2$ ($n = 4$)：$N(0) = \\{1\\}$, $N(1) = \\{0,2\\}$, $N(2) = \\{1,3\\}$, $N(3) = \\{2\\}$。\n- 图 $\\mathcal{G}_3$ ($n = 4$)：$N(0) = \\{1,3\\}$, $N(1) = \\{0,2,3\\}$, $N(2) = \\{1,3\\}$, $N(3) = \\{0,1,2\\}$。\n- 图 $\\mathcal{G}_4$ ($n = 7$)：$N(0) = \\{1,2,3,4,5,6\\}$, $N(1) = \\{0\\}$, $N(2) = \\{0\\}$, $N(3) = \\{0\\}$, $N(4) = \\{0\\}$, $N(5) = \\{0\\}$, $N(6) = \\{0\\}$。\n- 图 $\\mathcal{G}_5$ ($n = 4$)：$N(0) = \\{1,2,3\\}$, $N(1) = \\{0,2,3\\}$, $N(2) = \\{0,1,3\\}$, $N(3) = \\{0,1,2\\}$。\n- 图 $\\mathcal{G}_6$ ($n = 7$)：$N(0) = \\{1,2\\}$, $N(1) = \\{0,2,3\\}$, $N(2) = \\{0,1,3,4\\}$, $N(3) = \\{1,2,4\\}$, $N(4) = \\{2,3\\}$, $N(5) = \\{6\\}$, $N(6) = \\{5\\}$。\n\n对于每个图，计算：\n- 三角形总数 $T$（整数）。\n- 局部聚类系数列表 $[C_0, C_1, \\dots, C_{n-1}]$（实数，保留6位小数）。\n- 全局传递性 $G$（实数，保留6位小数）。\n\n最终输出格式。您的程序应生成单行输出，其中包含所有测试图的结果列表，顺序为 $\\mathcal{G}_1$ 到 $\\mathcal{G}_6$。每个图的结果是一个形如 $[T, [C_0, \\dots, C_{n-1}], G]$ 的列表。所有实数必须呈现为保留6位小数的十进制数。例如，单行输出的结构应为\n$[[T_1,[C_{1,0},\\dots],G_1],[T_2,[C_{2,0},\\dots],G_2],\\dots,[T_6,[C_{6,0},\\dots],G_6]]$。", "solution": "该问题经评估有效。它在科学上基于标准图论，问题陈述清晰，定义精确，目标明确，并且没有任何问题验证清单中列出的导致问题无效的缺陷。局部聚类系数、全局传递性和简并度排序的所有定义在网络科学和算法学中都是标准的。所述任务是实现一个著名的三角形计数算法，并将其应用于给定的测试套件。\n\n### 基于原理的设计与论证\n\n问题的核心是高效地计算无向图 $G=(V, E)$ 中的三角形数量。检查每个顶点三元组的暴力方法复杂度为 $O(n^3)$，对于大图来说太慢。一种更好的方法是遍历每个顶点 $v$，并检查其任意一对邻居之间是否存在边，该方法的复杂度为 $O(\\sum_{v \\in V} k_v^2)$，其中 $k_v$ 是顶点 $v$ 的度。问题陈述中规定的基于顶点排序的算法是一种精密的方法，旨在进一步降低这种复杂性，特别是对于稀疏图。\n\n#### 1. 使用顶点排序进行三角形计数\n\n该算法首先建立顶点的全序 $\\pi: V \\to \\{0, 1, \\dots, n-1\\}$。此排序用于将每条无向边 $(i, j) \\in E$ 定向。边从排序较低的顶点指向排序较高的顶点，即如果 $\\pi(i)  \\pi(j)$，则为 $i \\to j$。这将无向图 $G$ 转换为一个有向无环图 (DAG)。在这个 DAG 中，我们将顶点 $i$ 的“前向邻域”定义为 $N^+(i) = \\{j \\in N(i) : \\pi(i)  \\pi(j)\\}$。\n\n考虑原始图中的任意三角形 $\\{i, j, \\ell\\}$。在排序 $\\pi$ 下，其顶点具有唯一的秩排序，例如 $\\pi(i)  \\pi(j)  \\pi(\\ell)$。在定向图中，这个三角形表现为一个独特的有向结构：$i \\to j$，$i \\to \\ell$ 和 $j \\to \\ell$。这意味着 $j \\in N^+(i)$，$\\ell \\in N^+(i)$ 且 $\\ell \\in N^+(j)$。\n\n这种结构使我们能够不重复地计算三角形。算法遍历每条有向边 $i \\to j$（即，对每个顶点 $i$，遍历所有 $j \\in N^+(i)$）。对于每条这样的边，它寻找第三个顶点 $\\ell$，使得 $i \\to \\ell$ 和 $j \\to \\ell$。这样的顶点 $\\ell$ 必须同时属于 $N^+(i)$ 和 $N^+(j)$。因此，涉及边 $i \\to j$ 的三角形集合由其前向邻域中的公共邻居给出，即 $N^+(i) \\cap N^+(j)$。\n\n通过遍历所有顶点 $i$ 和所有 $j \\in N^+(i)$，并对每对求交集 $|N^+(i) \\cap N^+(j)|$ 的大小并求和，我们可以将每个三角形恰好计数一次。具体来说，当算法处理边 $i \\to j$ 并在 $N^+(i)$ 和 $N^+(j)$ 的交集中找到 $\\ell$ 时，具有 $\\pi(i)  \\pi(j)  \\pi(\\ell)$ 的三角形 $\\{i, j, \\ell\\}$ 将被精确地计数。在处理 $i \\to \\ell$（因为 $j \\notin N^+(\\ell)$）或 $j \\to \\ell$（因为 $i \\notin N^+(j)$ 或 $N^+(\\ell)$）时，它不会被计数。\n\n因此，三角形总数 $T$ 由以下公式给出：\n$$ T = \\sum_{i \\in V} \\sum_{j \\in N^+(i)} |N^+(i) \\cap N^+(j)| $$\n在此过程中，对于找到的每个三角形 $\\{i, j, \\ell\\}$，我们增加局部三角形计数 $t_i, t_j,$ 和 $t_\\ell$。遍历所有边后，总三角形计数为 $T = (\\sum_{v \\in V} t_v) / 3$。\n\n#### 2. 复杂度分析\n\n该算法的运行时间主要由嵌套循环和集合交集操作决定。算法结构如下：\n1. 对于每个顶点 $i \\in V$：\n2.  对于每个前向邻居 $j \\in N^+(i)$：\n3.   计算交集 $N^+(i) \\cap N^+(j)$。\n\n我们来分析所做的工作。两个大小分别为 $s_1$ 和 $s_2$ 的集合的交集成本取决于数据结构。如果前向邻域存储为有序列表，交集需要 $O(s_1 + s_2)$ 的时间。如果将其中一个转换为哈希集合，则所需时间与另一个集合的大小成正比。假设一个简单的实现，即对于一个集合中的每个元素，我们在另一个集合中检查其是否存在（例如，通过哈希数据结构），则 $N^+(i)$ 和 $N^+(j)$ 的交集成本可以界定为 $O(|N^+(i)|)$ 或 $O(|N^+(j)|)$。一个简单但可能悲观的计算交集 $N^+(i) \\cap N^+(j)$ 成本的界限是 $O(|N^+(i)|)$。\n\n总工作量是所有边 $i \\to j$ 上这些成本的总和：\n$$ \\text{Work} \\approx \\sum_{i \\in V} \\sum_{j \\in N^+(i)} O(|N^+(i)|) = O\\left(\\sum_{i \\in V} |N^+(i)| \\cdot |N^+(i)|\\right) = O\\left(\\sum_{i \\in V} |N^+(i)|^2\\right) $$\n这论证了所要求的 $O\\!\\left( \\sum_{i \\in V} |N^+(i)|^2 \\right)$ 的运行时间界限。\n\n#### 3. 简并度排序与 $O(m \\kappa)$ 界限\n\n该算法的效率关键取决于所选择的顶点排序 $\\pi$。一个最小化前向邻域大小的排序将带来更好的性能。简并度排序是实现此目的的有效启发式方法。\n\n图的简并度 $\\kappa$ 是满足每个导出子图都至少有一个度最多为 $\\kappa$ 的顶点的最小整数。简并度排序是通过从当前剩余的图中反复移除度最小的顶点来构建的。在第 $k$ 步被移除的顶点被赋予秩 $k$。\n\n让我们证明，使用简并度排序，对所有 $i \\in V$ 都有 $|N^+(i)| \\le \\kappa$。根据排序的构造方法，当选择一个顶点 $i$ 进行移除时，它在由尚未移除的顶点集合所导出的图中具有最小度。设这个导出子图为 $G'$。$i$ 在 $G'$ 中的所有邻居恰好是其前向邻居 $N^+(i)$，因为这些邻居将在 $i$ 之后被移除（即具有更高的秩）。因此，$i$ 在 $G'$ 中的度 $d_{G'}(i)$ 等于 $|N^+(i)|$。根据简并度的定义，任何导出子图（包括 $G'$）的最小度最多为 $\\kappa$。因此，$d_{G'}(i) = |N^+(i)| \\le \\kappa$。\n\n使用这个性质，我们可以进一步细化复杂度界限：\n$$ O\\left(\\sum_{i \\in V} |N^+(i)|^2\\right) = O\\left(\\sum_{i \\in V} |N^+(i)| \\cdot |N^+(i)|\\right) \\le O\\left(\\sum_{i \\in V} |N^+(i)| \\cdot \\kappa\\right) $$\n项 $\\sum_{i \\in V} |N^+(i)|$ 是定向图中所有出度的总和。由于 $m$ 条无向边中的每一条都恰好变成一条有向边，这个总和等于边的总数 $m$。\n$$ \\text{Work} \\le O\\left(\\kappa \\sum_{i \\in V} |N^+(i)|\\right) = O(\\kappa m) $$\n这证明了使用简并度排序将三角形计数复杂度界定为 $O(m \\kappa)$。\n\n### 实现计划\n\n实现将对每个输入图遵循以下步骤：\n1.  **解析邻接表**：读取输入图并以合适的格式存储，如列表的列表或集合。\n2.  **计算简并度排序**：一个函数实现简化的 $O(n^2)$ 简并度排序算法。它反复地在未移除的顶点中找到当前度最小的顶点，在排序 $\\pi$ 中为其分配下一个秩，并更新其邻居的度。\n3.  **构建前向邻域**：基于计算出的排序 $\\pi$，为每个顶点 $i$ 创建前向邻域 $N^+(i)$ 的新邻接表。将这些存储为集合对于交集步骤是高效的。\n4.  **计算三角形**：算法遍历每个顶点 $i$ 和每个前向邻居 $j \\in N^+(i)$。它计算交集 $N^+(i) \\cap N^+(j)$。对于交集中的每个顶点 $\\ell$，就找到了一个三角形 $\\{i, j, \\ell\\}$，并且三角形计数 $t_i, t_j, t_\\ell$ 会增加。\n5.  **计算最终指标**：\n    *   三角形总数 $T$ 计算为 $(\\sum t_i) / 3$。\n    *   局部聚类系数 $\\{C_i\\}$ 使用公式 $C_i = 2t_i / (k_i(k_i-1))$（对于 $k_i \\ge 2$）计算，否则 $C_i=0$，其中 $k_i$ 是原始度。\n    *   全局传递性 $G$ 计算为 $3T / \\sum_i \\binom{k_i}{2}$。\n6.  **格式化输出**：收集计算出的值（$T$、$C_i$ 列表和 $G$），将浮点数四舍五入到6位小数，并格式化为所需的字符串输出。", "answer": "[[1,[1.000000,1.000000,1.000000],1.000000],[0,[0.000000,0.000000,0.000000,0.000000],0.000000],[2,[1.000000,0.666667,1.000000,0.666667],0.750000],[0,[0.000000,0.000000,0.000000,0.000000,0.000000,0.000000,0.000000],0.000000],[4,[1.000000,1.000000,1.000000,1.000000],1.000000],[2,[1.000000,0.666667,0.333333,0.333333,0.000000,0.000000,0.000000],0.428571]]", "id": "3295327"}]}