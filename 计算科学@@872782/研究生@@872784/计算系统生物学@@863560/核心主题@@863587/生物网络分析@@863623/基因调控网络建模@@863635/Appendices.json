{"hands_on_practices": [{"introduction": "基因调控网络是由被称为“网络基序”的可重复出现的子网络构成的。这些基序执行特定的信息处理功能，理解它们的动态特性是理解复杂网络的关键。本练习聚焦于一种核心基序——非相干前馈环（incoherent feedforward loop），它能够实现对输入信号的精确适应；通过对系统进行线性化分析，您将亲手推导出其适应性动力学的关键特征。[@problem_id:3314916]", "problem": "考虑基因调控网络中的一个非相干前馈环，其中上游转录因子 $x$ 通过两条路径调控目标基因产物 $y$：直接激活路径 $x \\to y$ 和间接抑制路径 $x \\to z \\to y$，其中 $z$ 抑制 $y$。假设 $x$、$y$ 和 $z$ 是无量纲浓度（通过参考浓度进行归一化），时间单位为小时。$y$ 和 $z$ 的动力学由具有产生和一级降解的常微分方程控制，\n$$\n\\frac{dy}{dt} \\;=\\; \\alpha_y\\, a(x)\\, r(z) \\;-\\; \\beta_y\\, y, \n\\qquad\n\\frac{dz}{dt} \\;=\\; \\alpha_z\\, b(x) \\;-\\; \\beta_z\\, z,\n$$\n其中 $\\alpha_y$ 和 $\\alpha_z$ 是正的产生速率尺度，$\\beta_y$ 和 $\\beta_z$ 是正的一级降解速率（单位为 $\\mathrm{h}^{-1}$），$a(x)$ 是 $x$ 的平滑递增激活函数，$r(z)$ 是 $z$ 的平滑递减抑制函数，$b(x)$ 是 $x$ 的平滑递增激活函数。设 $x(t)$ 是一个外源输入，在 $t=0$ 时发生一个小的阶跃，从基线值 $x_0$ 变为 $x_0 + \\Delta x$，其中 $|\\Delta x| \\ll 1$。设 $(y^\\ast, z^\\ast)$ 表示在 $x=x_0$ 时的唯一稳定稳态。\n\n在稳态附近对系统进行线性化，考虑小扰动 $\\delta y(t) = y(t) - y^\\ast$，$\\delta z(t) = z(t) - z^\\ast$ 和 $\\delta x(t) = x(t) - x_0$，并定义稳态灵敏度\n$$\np \\;=\\; \\left.\\frac{\\partial}{\\partial x}\\big(\\alpha_y\\, a(x)\\, r(z)\\big)\\right|_{(x_0,z^\\ast)}, \n\\quad\nc \\;=\\; \\left.\\frac{\\partial}{\\partial z}\\big(\\alpha_y\\, a(x)\\, r(z)\\big)\\right|_{(x_0,z^\\ast)}, \n\\quad\nq \\;=\\; \\left.\\frac{\\partial}{\\partial x}\\big(\\alpha_z\\, b(x)\\big)\\right|_{x_0},\n$$\n由于激活和抑制，有 $p>0$，$q>0$ 和 $c0$。假设降解速率不同，即 $\\beta_y \\neq \\beta_z$，并且 $y$ 比 $z$ 快，即 $\\beta_y > \\beta_z > 0$。\n\n仅使用小信号线性化和线性系统分析，施加 $y$ 对 $x$ 的阶跃实现完美适应的条件（意味着阶跃后 $y$ 的稳态变化为零），并推导以下量的闭式解析表达式：\n- 适应幅度 $A^\\star$，定义为响应阶跃 $\\delta x(t) = \\Delta x\\, u(t)$ 时 $\\delta y(t)$ 在 $t \\ge 0$ 上的最大值，其中 $u(t)$ 是单位阶跃函数，\n- 适应时间 $t^\\star$，定义为达到该最大值时的时间。\n\n用 $p$、$q$、$c$、$\\beta_y$、$\\beta_z$ 和 $\\Delta x$ 来表示你的最终答案，形式为一对表达式。说明你使用的任何附加条件。你必须将时间 $t^\\star$ 以小时为单位表示，并将幅度 $A^\\star$ 表示为无量纲量。以闭式形式提供最终表达式；不需要进行数值计算或四舍五入。", "solution": "问题要求解一个表现出完美适应的线性化非相干前馈环的适应幅度 $A^\\star$ 和适应时间 $t^\\star$。\n\n首先，我们在对应于输入 $x=x_0$ 的稳态 $(y^\\ast, z^\\ast)$ 附近对给定的常微分方程组进行线性化。扰动定义为 $\\delta y(t) = y(t) - y^\\ast$，$\\delta z(t) = z(t) - z^\\ast$ 和 $\\delta x(t) = x(t) - x_0$。\n\n$y$ 的产生速率为 $f(x, z) = \\alpha_y a(x) r(z)$，$z$ 的产生速率为 $g(x) = \\alpha_z b(x)$。线性化系统得到：\n$$\n\\frac{d(\\delta y)}{dt} \\approx \\left.\\frac{\\partial f}{\\partial x}\\right|_{(x_0, z^\\ast)} \\delta x(t) + \\left.\\frac{\\partial f}{\\partial z}\\right|_{(x_0, z^\\ast)} \\delta z(t) - \\beta_y \\delta y(t)\n$$\n$$\n\\frac{d(\\delta z)}{dt} \\approx \\left.\\frac{dg}{dx}\\right|_{x_0} \\delta x(t) - \\beta_z \\delta z(t)\n$$\n使用所给的灵敏度 $p$、$c$ 和 $q$ 的定义，线性化系统为：\n$$\n\\frac{d(\\delta y)}{dt} = p\\, \\delta x(t) + c\\, \\delta z(t) - \\beta_y \\delta y(t) \\quad (1)\n$$\n$$\n\\frac{d(\\delta z)}{dt} = q\\, \\delta x(t) - \\beta_z \\delta z(t) \\quad (2)\n$$\n\n接下来，我们施加完美适应的条件。完美适应意味着对于输入中的持续阶跃变化 $\\delta x(t) = \\Delta x$，输出的稳态扰动为零。设新的稳态扰动为 $\\delta y_{ss}$ 和 $\\delta z_{ss}$。在此稳态下，时间导数为零。\n根据方程(2)，当 $d(\\delta z)/dt = 0$ 且 $\\delta x = \\Delta x$ 时：\n$$\n0 = q\\, \\Delta x - \\beta_z \\delta z_{ss} \\implies \\delta z_{ss} = \\frac{q}{\\beta_z} \\Delta x\n$$\n根据方程(1)，当 $d(\\delta y)/dt = 0$ 且 $\\delta x = \\Delta x$ 时：\n$$\n0 = p\\, \\Delta x + c\\, \\delta z_{ss} - \\beta_y \\delta y_{ss}\n$$\n完美适应的条件是 $\\delta y_{ss} = 0$。将此代入上式得到：\n$$\n0 = p\\, \\Delta x + c\\, \\delta z_{ss} = p\\, \\Delta x + c \\left(\\frac{q}{\\beta_z} \\Delta x\\right)\n$$\n由于此式必须对任何非零的 $\\Delta x$ 成立，我们得到参数的约束条件：\n$$\np + \\frac{cq}{\\beta_z} = 0 \\implies p \\beta_z = -cq\n$$\n这就是完美适应的条件，我们将用它来简化后续的表达式。给定的符号（$p>0, q>0, c0, \\beta_z>0$）与此关系一致。\n\n现在，我们求解阶跃输入 $\\delta x(t) = \\Delta x\\, u(t)$ 下的线性化系统，其中 $u(t)$ 是单位阶跃函数。初始条件为 $\\delta y(0)=0$ 和 $\\delta z(0)=0$，因为在 $t0$ 时系统处于稳态。\n\n对于 $t \\ge 0$，方程(2)变为：\n$$\n\\frac{d(\\delta z)}{dt} + \\beta_z \\delta z(t) = q\\, \\Delta x\n$$\n这是一个带常数强迫项的一阶线性常微分方程。初始条件为 $\\delta z(0)=0$ 时的解是：\n$$\n\\delta z(t) = \\frac{q \\Delta x}{\\beta_z} (1 - \\exp(-\\beta_z t))\n$$\n\n接下来，我们将此解和 $\\delta x(t) = \\Delta x$ 代入 $t \\ge 0$ 时的方程(1)：\n$$\n\\frac{d(\\delta y)}{dt} + \\beta_y \\delta y(t) = p\\, \\Delta x + c \\left[ \\frac{q \\Delta x}{\\beta_z} (1 - \\exp(-\\beta_z t)) \\right]\n$$\n$$\n\\frac{d(\\delta y)}{dt} + \\beta_y \\delta y(t) = \\left(p + \\frac{cq}{\\beta_z}\\right) \\Delta x - \\frac{cq \\Delta x}{\\beta_z} \\exp(-\\beta_z t)\n$$\n使用完美适应条件 $p + cq/\\beta_z = 0$，方程简化为：\n$$\n\\frac{d(\\delta y)}{dt} + \\beta_y \\delta y(t) = -\\frac{cq \\Delta x}{\\beta_z} \\exp(-\\beta_z t)\n$$\n我们也可以代入 $-cq/\\beta_z = p$：\n$$\n\\frac{d(\\delta y)}{dt} + \\beta_y \\delta y(t) = p\\, \\Delta x \\exp(-\\beta_z t)\n$$\n这是一个一阶线性常微分方程。解可以通过使用积分因子 $\\exp(\\beta_y t)$ 求得。\n$$\n\\frac{d}{dt} (\\delta y(t) \\exp(\\beta_y t)) = p\\, \\Delta x \\exp(-\\beta_z t) \\exp(\\beta_y t) = p\\, \\Delta x \\exp((\\beta_y - \\beta_z)t)\n$$\n从 $0$ 到 $t$ 积分：\n$$\n\\delta y(t) \\exp(\\beta_y t) - \\delta y(0) \\exp(0) = \\int_0^t p\\, \\Delta x \\exp((\\beta_y - \\beta_z)\\tau) d\\tau\n$$\n使用 $\\delta y(0)=0$ 和给定的条件 $\\beta_y \\neq \\beta_z$：\n$$\n\\delta y(t) \\exp(\\beta_y t) = p\\, \\Delta x \\left[ \\frac{\\exp((\\beta_y - \\beta_z)\\tau)}{\\beta_y - \\beta_z} \\right]_0^t = \\frac{p\\, \\Delta x}{\\beta_y-\\beta_z} (\\exp((\\beta_y - \\beta_z)t) - 1)\n$$\n乘以 $\\exp(-\\beta_y t)$ 得到 $\\delta y(t)$ 的解：\n$$\n\\delta y(t) = \\frac{p\\, \\Delta x}{\\beta_y - \\beta_z} (\\exp(-\\beta_z t) - \\exp(-\\beta_y t))\n$$\n问题将适应幅度 $A^\\star$ 定义为 $\\delta y(t)$ 在 $t \\ge 0$ 上的最大值，将 $t^\\star$ 定义为达到该最大值的时间。对于 $t>0$ 存在一个非平凡的最大值要求函数 $\\delta y(t)$ 从 $0$ 开始初始增加。因为 $p>0$ 且 $\\beta_y > \\beta_z > 0$，初始斜率的符号由 $\\Delta x$ 决定。为了得到正响应，我们要求 $\\Delta x > 0$。我们将此作为一个附加条件说明。\n\n为了找到最大值出现的时间 $t^\\star$，我们将 $\\delta y(t)$ 的导数设为零：\n$$\n\\frac{d(\\delta y)}{dt} = \\frac{p\\, \\Delta x}{\\beta_y - \\beta_z} (-\\beta_z \\exp(-\\beta_z t) + \\beta_y \\exp(-\\beta_y t)) = 0\n$$\n由于前置因子不为零，这意味着：\n$$\n\\beta_y \\exp(-\\beta_y t^\\star) = \\beta_z \\exp(-\\beta_z t^\\star)\n$$\n$$\n\\frac{\\beta_y}{\\beta_z} = \\frac{\\exp(-\\beta_z t^\\star)}{\\exp(-\\beta_y t^\\star)} = \\exp((\\beta_y - \\beta_z)t^\\star)\n$$\n通过取自然对数求解 $t^\\star$：\n$$\n\\ln\\left(\\frac{\\beta_y}{\\beta_z}\\right) = (\\beta_y - \\beta_z) t^\\star\n$$\n$$\nt^\\star = \\frac{\\ln(\\beta_y / \\beta_z)}{\\beta_y - \\beta_z}\n$$\n这是适应时间的表达式。由于 $\\beta_y$ 和 $\\beta_z$ 是以 $\\mathrm{h}^{-1}$ 为单位的速率，因此 $t^\\star$ 的单位是小时。\n\n适应幅度 $A^\\star$ 是 $\\delta y(t)$ 在 $t=t^\\star$ 时的值：\n$$\nA^\\star = \\delta y(t^\\star) = \\frac{p\\, \\Delta x}{\\beta_y - \\beta_z} (\\exp(-\\beta_z t^\\star) - \\exp(-\\beta_y t^\\star))\n$$\n根据最大值处的条件，我们有 $\\exp(-\\beta_y t^\\star) = \\frac{\\beta_z}{\\beta_y} \\exp(-\\beta_z t^\\star)$。将此代入 $A^\\star$ 的表达式中：\n$$\nA^\\star = \\frac{p\\, \\Delta x}{\\beta_y - \\beta_z} \\left(\\exp(-\\beta_z t^\\star) - \\frac{\\beta_z}{\\beta_y} \\exp(-\\beta_z t^\\star)\\right) = \\frac{p\\, \\Delta x}{\\beta_y - \\beta_z} \\exp(-\\beta_z t^\\star) \\left(1 - \\frac{\\beta_z}{\\beta_y}\\right)\n$$\n$$\nA^\\star = \\frac{p\\, \\Delta x}{\\beta_y - \\beta_z} \\exp(-\\beta_z t^\\star) \\left(\\frac{\\beta_y - \\beta_z}{\\beta_y}\\right) = \\frac{p\\, \\Delta x}{\\beta_y} \\exp(-\\beta_z t^\\star)\n$$\n现在我们计算 $\\exp(-\\beta_z t^\\star)$：\n$$\n-\\beta_z t^\\star = -\\beta_z \\frac{\\ln(\\beta_y / \\beta_z)}{\\beta_y - \\beta_z} = \\frac{-\\beta_z}{\\beta_y - \\beta_z} \\ln\\left(\\frac{\\beta_y}{\\beta_z}\\right) = \\ln\\left[ \\left(\\frac{\\beta_y}{\\beta_z}\\right)^{-\\frac{\\beta_z}{\\beta_y - \\beta_z}} \\right]\n$$\n因此，$\\exp(-\\beta_z t^\\star) = \\left(\\frac{\\beta_y}{\\beta_z}\\right)^{-\\frac{\\beta_z}{\\beta_y - \\beta_z}}$。\n将此代入 $A^\\star$ 的表达式中：\n$$\nA^\\star = \\frac{p\\, \\Delta x}{\\beta_y} \\left(\\frac{\\beta_y}{\\beta_z}\\right)^{-\\frac{\\beta_z}{\\beta_y - \\beta_z}}\n$$\n这是适应幅度的表达式。该量是无量纲的，符合要求。\n\n适应幅度 $A^\\star$ 和适应时间 $t^\\star$ 的最终表达式如下所示。使用的一个附加条件是 $\\Delta x > 0$，以确保在 $t>0$ 时存在一个非平凡的最大值。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{p \\Delta x}{\\beta_y} \\left(\\frac{\\beta_y}{\\beta_z}\\right)^{-\\frac{\\beta_z}{\\beta_y - \\beta_z}}  \\frac{\\ln\\left(\\frac{\\beta_y}{\\beta_z}\\right)}{\\beta_y - \\beta_z}\n\\end{pmatrix}\n}\n$$", "id": "3314916"}, {"introduction": "在从实验数据构建模型时，一个首要的问题是：我们能否唯一地确定模型的参数？这个问题被称为结构可辨识性，是模型推断的理论基石。本练习将引导您从第一性原理出发，分析基因表达模型中常见的希尔函数（Hill function）参数的可辨识性条件，并探讨现实世界中输入校准不确定性等因素带来的挑战。[@problem_id:3314913]", "problem": "考虑由常微分方程定义的单输入、单状态基因表达模型\n$$\n\\frac{dx}{dt} \\;=\\; \\frac{\\alpha}{1+\\left(\\frac{u}{K}\\right)^{n}} \\;-\\; \\beta \\, x,\n$$\n其中 $x(t)$ 是表达水平，$u(t)$ 是一个外部控制的输入，而 $\\alpha,\\beta,K,n$ 是未知的正参数。假设 $u(t)$ 是一个具有有限个不同水平的分段常数阶跃序列，并且输出 $x(t)$ 在没有测量噪声的情况下被连续观测。可观测量是 $x(t)$ 本身。\n\n结构可辨识性研究的是，对于给定类别的输入，在理想、连续观测条件下，从参数 $(\\alpha,\\beta,K,n)$ 到系统输入输出行为的映射是否为一一对应关系。使用以下基本原理：\n- 在 $u(t)$ 为常数的任何区间上的线性时不变解，以及线性标量系统 $\\dot{x} = -\\beta x + \\gamma$ 的解为 $x(t)=x_{\\text{ss}} + \\left(x(t_0)-x_{\\text{ss}}\\right)e^{-\\beta (t-t_0)}$ 且稳态为 $x_{\\text{ss}}=\\gamma/\\beta$ 的性质。\n- 结构可辨识性的定义，即在给定理想输入输出数据的情况下参数的唯一性。\n\n重点关注希尔参数 $(n,K)$。分析两种情景下的结构可辨识性：\n- 情景 A (输入尺度已知)：$u(t)$ 的阶跃水平以绝对单位已知。\n- 情景 B (输入标定未知)：传递的真实输入是 $u_{\\text{true}}(t)$，但只知道一个经过缩放的代理输入 $u(t)=s\\,u_{\\text{true}}(t)$，其中 $s0$ 未知；时间点和相对阶跃比率是已知的。\n\n您的任务：\n- 从第一性原理出发，推导在情景 A 和情景 B 中，通过有限次数的阶跃实验使 $n$ 和 $K$ 结构可辨识的充分必要条件。推导必须从恒定输入段的线性解开始，并且不得假设任何先验的参数反演公式。\n- 将这些条件具体化到实际情况，即阶跃输入包含一个基线 $u=0$ 和一组非零恒定水平。清楚地说明不同非零水平的数量如何影响可辨识性。\n- 如果存在不可辨识的参数组合，请确定是哪些，并精确解释原因。\n\n然后实现一个程序，针对下面描述的每个测试用例，按顺序返回三个布尔值，分别表示：$n$ 是否结构可辨识，$K$ 是否结构可辨识，以及参数对 $(n,K)$ 是否联合结构可辨识（所有情况均在所述情景和输入设计下）。该逻辑必须纯粹从您推导的条件进行演绎，并且不得使用数值拟合。\n\n测试套件：\n- 案例 1 (情景 A)：$(\\alpha,\\beta,n,K)=(10.0,\\,1.0,\\,2.0,\\,3.0)$，阶跃水平 $u\\in\\{0.0,\\,1.0,\\,2.0,\\,5.0\\}$。\n- 案例 2 (情景 A)：$(\\alpha,\\beta,n,K)=(8.0,\\,0.5,\\,3.0,\\,4.0)$，阶跃水平 $u\\in\\{0.0,\\,3.0\\}$。\n- 案例 3 (情景 B)：$(\\alpha,\\beta,n,K)=(12.0,\\,1.2,\\,2.5,\\,6.0)$，观测到的阶跃水平 $u\\in\\{0.0,\\,1.0,\\,2.0,\\,5.0\\}$，且存在未知的正标定因子 $s$ 使得 $u=s\\,u_{\\text{true}}$，其中 $u_{\\text{true}}$ 是真实传递的输入。\n- 案例 4 (情景 B)：$(\\alpha,\\beta,n,K)=(5.0,\\,0.8,\\,4.0,\\,2.0)$，观测到的阶跃水平 $u\\in\\{0.0,\\,2.0\\}$，且存在如案例 3 中的未知正标定因子 $s$。\n\n科学真实性约束：\n- 所有参数均为正实数。\n- 分析必须依赖于对阶跃输入的连续时间响应以及由此产生的稳态映射 $u\\mapsto x_{\\text{ss}}(u)$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的、逗号分隔的布尔值扁平列表，其顺序为测试用例的顺序，并且在每个测试用例中，顺序为 $[n\\text{-可辨识},K\\text{-可辨识},(n,K)\\text{-可辨识}]$。例如，形式为 $[{\\rm True},{\\rm False},{\\rm False},\\ldots]$ 的输出是可以接受的。", "solution": "该问题要求分析单基因表达模型中希尔参数 $n$ 和 $K$ 的结构可辨识性。该分析必须基于系统对分段常数输入的响应，从第一性原理出发进行推导。\n\n该模型由以下常微分方程给出：\n$$\n\\frac{dx}{dt} = \\frac{\\alpha}{1+\\left(\\frac{u}{K}\\right)^{n}} - \\beta \\, x\n$$\n其中 $x(t)$ 是基因表达水平，$u(t)$ 是输入，$\\alpha, \\beta, K, n$ 是正实数参数。\n\n结构可辨识性关注的是，在给定理想（连续、无噪声）的输入输出数据时，参数值的唯一性。如果通过观测系统的输入输出行为可以唯一确定一组参数，则这组参数是结构可辨识的。\n\n我们的分析首先识别出可以从实验数据中直接确定的量，然后建立模型参数可以从这些可观测量中唯一计算出的条件。\n\n**第1步：系统可观测量辨识**\n\n输入 $u(t)$ 是一系列恒定阶跃。在输入 $u(t)$ 保持恒定值 $u_i$ 的任何时间区间 $[t_0, t_f]$ 上，系统表现为线性时不变 (LTI) 系统：\n$$\n\\frac{dx}{dt} = -\\beta x + \\gamma_i\n$$\n其中 $\\gamma_i = \\frac{\\alpha}{1+(u_i/K)^n}$ 是与输入 $u_i$ 对应的恒定生产率。这个线性常微分方程的解为：\n$$\nx(t) = x_{\\text{ss},i} + \\left(x(t_0)-x_{\\text{ss},i}\\right)e^{-\\beta (t-t_0)}\n$$\n其中 $x_{\\text{ss},i} = \\gamma_i / \\beta$ 是输入 $u_i$ 对应的稳态表达水平。\n\n通过在瞬态阶段（即 $u$ 发生阶跃变化后）连续观测 $x(t)$，可以通过拟合指数衰减来确定系统的时间常数 $\\tau = 1/\\beta$。这意味着参数 $\\beta$ 总是结构可辨识的，只要输入不恒为常数（问题陈述保证了这一点）。\n\n一旦 $\\beta$ 已知，如果让系统在每个输入水平 $u_i$ 下都达到稳态，则可以观测到稳态值 $x_{\\text{ss},i}$。根据关系式 $x_{\\text{ss},i} = \\gamma_i / \\beta$，可以为每个 $u_i$ 计算出相应的生产率 $\\gamma_i = \\beta x_{\\text{ss},i}$。\n\n因此，核心的可辨识性问题简化为从一组已知的配对 $(u_i, \\gamma_i)$ 中确定参数 $(\\alpha, n, K)$。\n\n**第2步：参数 $\\alpha$ 的辨识**\n\n问题指明输入设计可以包含一个 $u=0$ 的基线水平。如果我们施加输入 $u_0 = 0$ 并测量相应的生产率 $\\gamma_0$，我们发现：\n$$\n\\gamma_0 = \\frac{\\alpha}{1+(0/K)^n} = \\alpha\n$$\n因此，通过测量系统对零输入的响应，参数 $\\alpha$ 可以被唯一确定。$\\alpha$ 的可辨识性是辨识 $n$ 和 $K$ 的先决条件。所有测试用例的输入集中都包含 $u=0$。\n\n**第3步：为辨识 $(n, K)$ 进行线性化**\n\n在确定了各种非零输入 $u_i > 0$ 对应的 $\\alpha$ 和 $\\gamma_i$ 后，我们可以对生产率方程进行处理：\n$$\n\\gamma_i = \\frac{\\alpha}{1+(u_i/K)^n}\n$$\n为希尔项进行整理得到：\n$$\n1+\\left(\\frac{u_i}{K}\\right)^n = \\frac{\\alpha}{\\gamma_i} \\implies \\left(\\frac{u_i}{K}\\right)^n = \\frac{\\alpha}{\\gamma_i} - 1\n$$\n我们定义可观测量 $y_i = \\frac{\\alpha}{\\gamma_i} - 1$。由于 $\\alpha$ 和所有的 $\\gamma_i$ 都是从数据中确定的，因此每个 $y_i$ 都是一个已知值。方程变为：\n$$\n\\left(\\frac{u_i}{K}\\right)^n = y_i\n$$\n为了分析这个非线性关系，我们对两边取自然对数：\n$$\nn \\left( \\ln u_i - \\ln K \\right) = \\ln y_i\n$$\n$$\n\\ln y_i = n \\ln u_i - n \\ln K\n$$\n这个方程揭示了一个线性关系。令 $Y_i = \\ln y_i$ 和 $X_i = \\ln u_i$。该方程的形式为 $Y = mX + c$，其中斜率是 $m=n$，y轴截距是 $c = -n \\ln K$。辨识 $n$ 和 $K$ 的问题现在转化为从一组数据点 $(X_i, Y_i)$ 确定一条直线的斜率和截距的问题。\n\n**第4步：情景 A (输入尺度已知) 的分析**\n\n在这种情景下，输入水平 $u_i$ 是精确已知的。因此，值 $X_i = \\ln u_i$ 是已知的。由于 $Y_i = \\ln y_i$ 也是通过观测确定的，我们得到一组必须位于直线 $Y = nX - n\\ln K$ 上的点 $(X_i, Y_i)$。\n\n一条唯一的直线可以由两个或更多个不同的点确定。\n- 如果实验只包含**一个不同的非零输入水平** $u_1$，我们只得到一个点 $(X_1, Y_1)$。有无数条直线可以穿过这个点，这意味着有无数对 $(n, K)$ 满足方程 $Y_1 = nX_1 - n\\ln K$。在这种情况下，$n$ 和 $K$ 都不是结构可辨识的，因此，参数对 $(n,K)$ 也不是联合可辨识的。\n- 如果实验包含**两个或更多个不同的非零输入水平**（例如 $u_1$ 和 $u_2$），我们至少得到两个不同的点 $(X_1, Y_1)$ 和 $(X_2, Y_2)$。直线的斜率可以唯一确定为 $n = \\frac{Y_2 - Y_1}{X_2 - X_1}$。截距也可以唯一确定，$c = Y_1 - nX_1$。由于 $n>0$ 是一个给定的约束，我们可以唯一地求出 $\\ln K = -c/n$，进而得到 $K = e^{-c/n}$ 的唯一值。\n\n因此，在情景 A 中，$n$ 和 $K$（以及联合参数对 $(n,K)$）结构可辨识的充分必要条件是，除了用于辨识 $\\alpha$ 的 $u=0$ 水平外，实验必须包含至少两个不同的非零输入水平。\n\n**第5步：情景 B (输入标定未知) 的分析**\n\n在这种情景下，我们观测到的是一个经过缩放的输入 $u(t)$，但系统的真实输入是 $u_{\\text{true}}(t) = u(t)/s$，其中 $s>0$ 是一个未知的标定常数。\n物理关系是基于 $u_{\\text{true}}$ 的：\n$$\n\\gamma_i = \\frac{\\alpha}{1+\\left(u_{\\text{true},i}/K\\right)^n} = \\frac{\\alpha}{1+\\left((u_i/s)/K\\right)^n} = \\frac{\\alpha}{1+\\left(u_i/(sK)\\right)^n}\n$$\n我们定义一个表观解离常数 $K_{\\text{ap}} = sK$。描述我们观测数据 $(u_i, \\gamma_i)$ 的方程是：\n$$\n\\gamma_i = \\frac{\\alpha}{1+\\left(u_i/K_{\\text{ap}}\\right)^n}\n$$\n该方程与情景 A 中的形式相同，只是用 $K_{\\text{ap}}$ 替换了 $K$。应用相同的对数变换可得：\n$$\n\\ln y_i = n \\ln u_i - n \\ln K_{\\text{ap}}\n$$\n我们再次绘制 $Y_i = \\ln y_i$ 相对于 $X_i = \\ln u_i$ 的图。\n- 如果实验包含**两个或更多个不同的非零输入水平**，直线的斜率可以唯一确定，从而得到 $n$ 的值。因此，在这种条件下，$n$ 是结构可辨识的。\n- 直线的截距 $c = -n \\ln K_{\\text{ap}}$ 也可以唯一确定。这使得 $K_{\\text{ap}} = e^{-c/n}$ 可以被唯一确定。然而，$K_{\\text{ap}} = sK$。由于 $s$ 未知且可以是任何正实数，因此无法将 $s$ 和 $K$ 分解开。对于任何一个提出的解 $(K, s)$，对于任意常数 $c_0>0$ 的任何其他配对 $(K/c_0, s \\cdot c_0)$ 都会得到相同的 $K_{\\text{ap}}$ 值，从而产生相同的输入输出行为。这是一个根本性的不可辨识性。\n- 因此，在情景 B 中，无论输入水平的数量如何，$K$ **都不是**结构可辨识的。\n- 由于 $K$ 不可辨识，参数对 $(n,K)$ 也不是联合可辨识的。\n- 如果实验的非零输入水平少于两个，则斜率 $n$ 无法确定，因此 $n$ 和 $K$ 都不可辨识。\n\n**条件总结**\n假设输入集包含 $u=0$ 以确保 $\\alpha$ 可辨识：\n1.  **情景 A (输入已知)：**\n    - $n$ 是结构可辨识的 $\\iff$ 输入集包含至少两个不同的非零水平。\n    - $K$ 是结构可辨识的 $\\iff$ 输入集包含至少两个不同的非零水平。\n    - 参数对 $(n,K)$ 是联合可辨识的 $\\iff$ 输入集包含至少两个不同的非零水平。\n\n2.  **情景 B (输入尺度未知)：**\n    - $n$ 是结构可辨识的 $\\iff$ 输入集包含至少两个不同的非零水平。\n    - 由于与未知因子 $s$ 的缩放模糊性，$K$ **永远不是**结构可辨识的。\n    - 参数对 $(n,K)$ **永远不是**联合可辨识的。\n\n基于此推导，我们现在可以实现逻辑来评估给定的测试用例。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Determines the structural identifiability of Hill parameters n and K\n    for a gene expression model based on the experimental design.\n    \"\"\"\n\n    # The test cases define the scenario (A or B) and the input design.\n    # The specific parameter values are irrelevant for structural identifiability analysis.\n    test_cases = [\n        # Case 1: Scenario A, u in {0.0, 1.0, 2.0, 5.0}\n        {'scenario': 'A', 'u_levels': {0.0, 1.0, 2.0, 5.0}},\n        # Case 2: Scenario A, u in {0.0, 3.0}\n        {'scenario': 'A', 'u_levels': {0.0, 3.0}},\n        # Case 3: Scenario B, u in {0.0, 1.0, 2.0, 5.0}\n        {'scenario': 'B', 'u_levels': {0.0, 1.0, 2.0, 5.0}},\n        # Case 4: Scenario B, u in {0.0, 2.0}\n        {'scenario': 'B', 'u_levels': {0.0, 2.0}},\n    ]\n\n    results = []\n    for case in test_cases:\n        scenario = case['scenario']\n        u_levels = case['u_levels']\n\n        # The core condition for identifiability is the number of distinct\n        # non-zero input levels used in the experiment.\n        # The u=0 level is necessary to identify alpha, a prerequisite.\n        # We assume u=0 is always available as per the problem description.\n        nonzero_u_levels = {u for u in u_levels if u > 0.0}\n        num_nonzero_levels = len(nonzero_u_levels)\n\n        n_identifiable = False\n        K_identifiable = False\n        jointly_identifiable = False\n\n        if scenario == 'A':\n            # In Scenario A, with known inputs, both n and K are identifiable \n            # if and only if at least two distinct non-zero input levels are used.\n            # This allows unique determination of the slope (n) and intercept (-n*ln(K))\n            # of the linearized data plot.\n            if num_nonzero_levels >= 2:\n                n_identifiable = True\n                K_identifiable = True\n                jointly_identifiable = True\n            else:\n                n_identifiable = False\n                K_identifiable = False\n                jointly_identifiable = False\n        \n        elif scenario == 'B':\n            # In Scenario B, with an unknown input scaling factor s, we can only\n            # identify the apparent dissociation constant K_ap = s*K.\n\n            # The Hill coefficient n (the slope) is still identifiable if there are\n            # at least two distinct non-zero input levels.\n            if num_nonzero_levels >= 2:\n                n_identifiable = True\n            else:\n                n_identifiable = False\n            \n            # The true dissociation constant K is never identifiable because it cannot\n            # be separated from the unknown scaling factor s.\n            K_identifiable = False\n            \n            # Since K is not identifiable, the pair (n, K) is not jointly identifiable.\n            jointly_identifiable = False\n\n        results.extend([n_identifiable, K_identifiable, jointly_identifiable])\n\n    # The final output must be a single-line string of a flat list of booleans.\n    # Python's str() representation of a boolean is 'True' or 'False'.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3314913"}]}