{"hands_on_practices": [{"introduction": "受体酪氨酸激酶（RTK）信号转导的启动通常始于配体与受体结合，并诱导受体形成二聚体。这个练习将引导你运用质量作用定律和平衡原理，来量化这一关键的激活步骤。通过构建和求解一个描述受体结合与二聚化的代数方程组，你将能够计算在给定配体浓度下，处于激活（二聚体）状态的受体比例，从而加深对信号系统输入的理解 [@problem_id:3344214]。", "problem": "一种单物种的受体酪氨酸激酶（RTK）经历配体诱导的二聚化。考虑一个最小的平衡模型，其中未结合配体的受体单体 $R$ 与配体 $L$ 结合形成结合配体的单体 $RL$，然后二聚化形成 $(RL)_{2}$：\n$$R + L \\rightleftharpoons RL,\\qquad RL + RL \\rightleftharpoons (RL)_{2}.$$\n假设系统处于由质量作用定律支配的准平衡状态，解离常数定义为：配体结合的解离常数为 $K_{d1} = \\frac{[R][L]}{[RL]}$，二聚化的解离常数为 $K_{d2} = \\frac{[RL]^{2}}{[(RL)_{2}]}$。设受体总浓度为 $R_{\\text{tot}} = 100\\,\\text{nM}$，游离配体浓度固定为 $[L] = 10\\,\\text{nM}$（假设细胞外配体库的浓度是恒定的）。取 $K_{d1} = 1\\,\\text{nM}$ 和 $K_{d2} = 10\\,\\text{nM}$。忽略不依赖配体的二聚化以及任何更高阶的寡聚体。\n\n仅使用平衡定义和受体质量守恒，求解结合-二聚化平衡，以确定平衡时处于二聚体中的受体亚基的分数，\n$$f_{\\text{dim}} \\equiv \\frac{2\\,[(RL)_{2}]}{R_{\\text{tot}}}.$$\n将你的最终答案表示为四舍五入到四位有效数字的小数。在你的推导过程中，从 $K_{d1}$ 和 $K_{d2}$ 的定义以及 $R_{\\text{tot}}$ 的守恒关系开始，并清楚地说明所做的任何近似。作为你推理的一部分（而不是最终的数值答案），确定 $f_{\\text{dim}}$ 对 $[L]$ 表现出有效二次依赖性的参数区间，并给出该区间内 $f_{\\text{dim}}$ 相应的主导阶标度表达式。", "solution": "首先根据所需标准验证问题陈述。\n\n### 步骤 1：提取已知条件\n-   **反应：** $R + L \\rightleftharpoons RL$ 和 $RL + RL \\rightleftharpoons (RL)_{2}$。\n-   **定义：**\n    -   配体结合解离常数：$K_{d1} = \\frac{[R][L]}{[RL]}$。\n    -   二聚化解离常数：$K_{d2} = \\frac{[RL]^{2}}{[(RL)_{2}]}$。\n    -   二聚体中受体亚基的分数：$f_{\\text{dim}} \\equiv \\frac{2\\,[(RL)_{2}]}{R_{\\text{tot}}}$。\n-   **常数和条件：**\n    -   受体总浓度：$R_{\\text{tot}} = 100\\,\\text{nM}$。\n    -   游离配体浓度：$[L] = 10\\,\\text{nM}$。\n    -   $K_{d1} = 1\\,\\text{nM}$。\n    -   $K_{d2} = 10\\,\\text{nM}$。\n-   **约束条件：**\n    -   忽略不依赖配体的二聚化。\n    -   忽略更高阶的寡聚体。\n    -   仅使用平衡定义和受体质量守恒。\n    -   细胞外配体库的浓度是恒定的。\n\n### 步骤 2：使用提取的已知条件进行验证\n-   **科学依据：**该问题描述了一个配体诱导的受体二聚化的最小标准模型，这是细胞信号传导中的一个基本过程，尤其对于受体酪氨酸激酶（RTK）而言。使用质量作用动力学和解离常数来描述分子平衡是物理化学和系统生物学的基石。该模型在科学上是合理的，并被广泛使用。\n-   **适定性：**该问题提供了一套完整的代数方程（两个平衡关系和一个守恒定律）和三个未知浓度（$[R]$、$[RL]$、$[(RL)_2]$）。独立方程的数量与未知数的数量相匹配，确保可以找到解。给定的参数导致一个物理上有意义的解（浓度为正）。存在一个唯一、稳定且有意义的解。\n-   **客观性：**问题以精确、定量的术语陈述，使用了标准的科学记数法和术语。没有主观或基于意见的陈述。\n\n### 步骤 3：结论与行动\n该问题具有科学依据、适定性、客观性且自洽。这是一个有效的科学问题。我现在开始求解。\n\n该系统由受体的三种状态描述：未结合配体的单体 ($R$)、结合配体的单体 ($RL$) 和结合配体的二聚体 ($(RL)_2$)。这些物种在平衡时的浓度分别表示为 $[R]$、$[RL]$ 和 $[(RL)_{2}]$。平衡关系由解离常数给出：\n$$K_{d1} = \\frac{[R][L]}{[RL]} \\quad (1)$$\n$$K_{d2} = \\frac{[RL]^{2}}{[(RL)_{2}]} \\quad (2)$$\n受体亚基的总浓度是守恒的。每个单体物种（$R$ 和 $RL$）包含一个亚基，而二聚体 ($(RL)_2$) 包含两个亚基。因此，质量守恒定律为：\n$$R_{\\text{tot}} = [R] + [RL] + 2[(RL)_{2}] \\quad (3)$$\n目标是求解 $f_{\\text{dim}} = \\frac{2[(RL)_{2}]}{R_{\\text{tot}}}$。为此，我们必须首先求出各物种的平衡浓度。我们可以使用方程 $(1)$ 和 $(2)$ 将 $[R]$ 和 $[(RL)_2]$ 用 $[RL]$ 表示：\n由 $(1)$ 可得，$[R] = \\frac{K_{d1}[RL]}{[L]}$。\n由 $(2)$ 可得，$[(RL)_{2}] = \\frac{[RL]^2}{K_{d2}}$。\n将这些表达式代入守恒方程 $(3)$，得到一个仅含 $[RL]$ 的方程：\n$$R_{\\text{tot}} = \\left(\\frac{K_{d1}}{[L]}\\right)[RL] + [RL] + 2\\left(\\frac{[RL]^2}{K_{d2}}\\right)$$\n这可以重排成一个形式为 $ax^2 + bx + c = 0$ 的标准二次方程，其中 $x = [RL]$：\n$$\\left(\\frac{2}{K_{d2}}\\right)[RL]^2 + \\left(1 + \\frac{K_{d1}}{[L]}\\right)[RL] - R_{\\text{tot}} = 0$$\n此推导过程未使用任何近似；它是模型定义的精确代数结果。\n\n现在，我们代入给定的数值：$R_{\\text{tot}} = 100\\,\\text{nM}$，$[L] = 10\\,\\text{nM}$，$K_{d1} = 1\\,\\text{nM}$，以及 $K_{d2} = 10\\,\\text{nM}$。\n该二次方程的系数为：\n$$a = \\frac{2}{K_{d2}} = \\frac{2}{10} = 0.2\\,(\\text{nM})^{-1}$$\n$$b = 1 + \\frac{K_{d1}}{[L]} = 1 + \\frac{1}{10} = 1.1$$\n$$c = -R_{\\text{tot}} = -100\\,\\text{nM}$$\n关于 $[RL]$ 的二次方程为：\n$$0.2 [RL]^2 + 1.1 [RL] - 100 = 0$$\n我们使用二次公式 $[RL] = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$ 求解 $[RL]$。由于浓度必须是正值，我们取正根：\n$$[RL] = \\frac{-1.1 + \\sqrt{(1.1)^2 - 4(0.2)(-100)}}{2(0.2)}$$\n$$[RL] = \\frac{-1.1 + \\sqrt{1.21 + 80}}{0.4}$$\n$$[RL] = \\frac{-1.1 + \\sqrt{81.21}}{0.4}$$\n$$[RL] = \\frac{-1.1 + 9.011659...}{0.4}$$\n$$[RL] = \\frac{7.911659...}{0.4} = 19.779147...\\,\\text{nM}$$\n现在我们可以计算二聚体的浓度 $[(RL)_{2}]$：\n$$[(RL)_{2}] = \\frac{[RL]^2}{K_{d2}} = \\frac{(19.779147...)^2}{10} = \\frac{391.2149...}{10} = 39.12149...\\,\\text{nM}$$\n最后，我们计算二聚体中受体亚基的分数 $f_{\\text{dim}}$：\n$$f_{\\text{dim}} = \\frac{2[(RL)_{2}]}{R_{\\text{tot}}} = \\frac{2 \\times 39.12149...}{100} = \\frac{78.24298...}{100} = 0.7824298...$$\n四舍五入到四位有效数字，我们得到 $f_{\\text{dim}} \\approx 0.7824$。\n\n接下来，我们确定 $f_{\\text{dim}}$ 对 $[L]$ 表现出有效二次依赖性的参数区间。二次依赖性，$f_{\\text{dim}} \\propto [L]^2$，通常出现在初始步骤是限速步骤的多步过程中。在这里，这对应于低配体浓度的区间，此时初始结合事件是罕见的。\n让我们假设配体浓度非常低，特别是 $[L] \\ll K_{d1}$。在这种情况下，受体结合很弱，我们可以预期大多数受体处于未结合配体的单体状态 $R$。这导致近似 $[R] \\approx R_{\\text{tot}}$。只要结合配体的物种浓度可以忽略不计，即 $[RL] + 2[(RL)_2] \\ll R_{\\text{tot}}$，该近似就成立。\n在 $[R] \\approx R_{\\text{tot}}$ 的近似下，我们可以使用方程 $(1)$ 找到 $[RL]$ 的主导阶表达式：\n$$[RL] = \\frac{[R][L]}{K_{d1}} \\approx \\frac{R_{\\text{tot}}[L]}{K_{d1}}$$\n这表明在低配体浓度下，$[RL]$ 与 $[L]$ 呈线性关系。\n现在，我们将这个 $[RL]$ 的近似值代入 $f_{\\text{dim}}$ 的表达式中：\n$$f_{\\text{dim}} = \\frac{2[(RL)_2]}{R_{\\text{tot}}} = \\frac{2}{R_{\\text{tot}}} \\frac{[RL]^2}{K_{d2}}$$\n$$f_{\\text{dim}} \\approx \\frac{2}{R_{\\text{tot}}K_{d2}} \\left( \\frac{R_{\\text{tot}}[L]}{K_{d1}} \\right)^2$$\n$$f_{\\text{dim}} \\approx \\frac{2 R_{\\text{tot}}}{K_{d1}^2 K_{d2}} [L]^2$$\n这个表达式表明，在 $[L]$ 足够小以至于 $[R] \\approx R_{\\text{tot}}$ 的区间内，二聚化受体的分数 $f_{\\text{dim}}$ 与配体浓度 $[L]$ 呈二次关系。因此，该区间是受体饱和度最低的低配体、弱结合极限。", "answer": "$$\\boxed{0.7824}$$", "id": "3344214"}, {"introduction": "受体激活后，信号会向下游传递，激活一系列酶促反应。本练习模拟了一个典型的下游信号模块——磷脂酰肌醇（phosphoinositide）信号通路中 $PIP_2$ 和 $PIP_3$ 之间的可逆转换。你将运用质量作用动力学原理，推导描述系统动态变化的常微分方程，并求解其稳态响应和响应时间。这项实践将帮助你从静态的平衡分析过渡到对信号通路动态特性的分析 [@problem_id:3344245]。", "problem": "在一个简化的磷脂酰肌醇信号传导膜模型中，4,5-二磷酸磷脂酰肌醇 (PIP2) 被受体酪氨酸激酶 (RTK) 招募的磷脂酰肌醇3-激酶 (PI3K) 转化为 3,4,5-三磷酸磷脂酰肌醇 (PIP3)，而 PIP3 又被PTEN磷酸酶 (phosphatase and tensin homolog) 去磷酸化变回 PIP2。假设在一个混合均匀的膜片上，磷脂酰肌醇的总量是守恒的，即 $[ \\text{PIP2} ] + [ \\text{PIP3} ] = P_{\\text{tot}}$。假设在非饱和、一级（质量作用）反应体系中，有效正向转化率与被激活的 RTK–PI3K 复合物的比例成正比。在时间 $t=0$ 时，一个阶跃刺激瞬时将 RTK–PI3K 的占有率增加到一个恒定的比例 $\\alpha$。在 $t=0$ 之前，没有 PI3K 被激活，且 $[ \\text{PIP3} ](0)=0$。设（每个活性酶的）内在一级速率常数对于 PIP2 到 PIP3 的转换为 $k_{\\text{PI3K}}$，对于 PIP3 到 PIP2 的转换为 $k_{\\text{PTEN}}$。\n\n仅使用质量作用动力学原理和磷脂酰肌醇总量守恒原理，推导阶跃刺激后 $[ \\text{PIP3} ](t)$ 的控制动力学，并计算：\n- PIP2 转化为 PIP3 的稳态分数，定义为 $[ \\text{PIP3} ]_{\\text{ss}} / P_{\\text{tot}}$，以及\n- 阶跃后达到此稳态的半衰期，定义为 $[ \\text{PIP3} ](t)$ 等于其稳态值一半时的时间。\n\n取 $k_{\\text{PI3K}} = 0.05\\,\\text{s}^{-1}$，$k_{\\text{PTEN}} = 0.02\\,\\text{s}^{-1}$，$P_{\\text{tot}} = 10\\,\\mu\\text{M}$，以及 $\\alpha = 30\\%$。将稳态分数表示为无量纲小数，半衰期以秒为单位。将两个量都四舍五入到四位有效数字。", "solution": "问题要求对酶活性发生阶跃变化后3,4,5-三磷酸磷脂酰肌醇 ($[\\text{PIP3}]$) 浓度的动力学进行建模。我们有一个涉及4,5-二磷酸磷脂酰肌醇 ($[\\text{PIP2}]$) 和 $[\\text{PIP3}]$ 的两态系统，由以下可逆反应控制：\n$$\n\\text{PIP2} \\underset{k_{\\text{rev}}}{\\stackrel{k_{\\text{fwd}}}{\\rightleftharpoons}} \\text{PIP3}\n$$\n这两种磷脂酰肌醇的总浓度是守恒的，因此 $[\\text{PIP2}](t) + [\\text{PIP3}](t) = P_{\\text{tot}}$，其中 $P_{\\text{tot}}$ 是一个常数。\n\n根据问题描述，动力学由质量作用原理控制。\n对于 $t \\ge 0$，恒定比例 $\\alpha$ 的受体酪氨酸激酶-磷脂酰肌醇3-激酶 (RTK–PI3K) 复合物被激活。正向反应（PIP2 到 PIP3）由这些活性复合物催化。该反应速率对 $[\\text{PIP2}]$ 是一级的。有效正向速率常数为 $k_{\\text{fwd}} = \\alpha k_{\\text{PI3K}}$。\n逆向反应（PIP3 到 PIP2）由PTEN磷酸酶催化。该反应速率对 $[\\text{PIP3}]$ 是一级的，其内在速率常数为 $k_{\\text{rev}} = k_{\\text{PTEN}}$。\n\n$[\\text{PIP3}]$ 浓度的变化率是其生成速率与消耗速率之差：\n$$\n\\frac{d[\\text{PIP3}]}{dt} = (\\text{生成速率}) - (\\text{消耗速率})\n$$\n$$\n\\frac{d[\\text{PIP3}]}{dt} = k_{\\text{fwd}} [\\text{PIP2}] - k_{\\text{rev}} [\\text{PIP3}]\n$$\n代入给定的速率常数：\n$$\n\\frac{d[\\text{PIP3}]}{dt} = \\alpha k_{\\text{PI3K}} [\\text{PIP2}] - k_{\\text{PTEN}} [\\text{PIP3}]\n$$\n为了得到一个单变量的微分方程，我们使用守恒定律：$[\\text{PIP2}] = P_{\\text{tot}} - [\\text{PIP3}]$。将此代入速率方程，得到：\n$$\n\\frac{d[\\text{PIP3}]}{dt} = \\alpha k_{\\text{PI3K}} (P_{\\text{tot}} - [\\text{PIP3}]) - k_{\\text{PTEN}} [\\text{PIP3}]\n$$\n这是一个一阶线性常微分方程。我们将其整理成标准形式：\n$$\n\\frac{d[\\text{PIP3}]}{dt} = \\alpha k_{\\text{PI3K}} P_{\\text{tot}} - (\\alpha k_{\\text{PI3K}} + k_{\\text{PTEN}}) [\\text{PIP3}]\n$$\n$$\n\\frac{d[\\text{PIP3}]}{dt} + (\\alpha k_{\\text{PI3K}} + k_{\\text{PTEN}}) [\\text{PIP3}] = \\alpha k_{\\text{PI3K}} P_{\\text{tot}}\n$$\n令有效弛豫速率常数为 $k_{\\text{eff}} = \\alpha k_{\\text{PI3K}} + k_{\\text{PTEN}}$。方程变为：\n$$\n\\frac{d[\\text{PIP3}]}{dt} + k_{\\text{eff}} [\\text{PIP3}] = \\alpha k_{\\text{PI3K}} P_{\\text{tot}}\n$$\n该微分方程的通解是齐次解与特解之和。齐次方程的解为 $C \\exp(-k_{\\text{eff}} t)$，而一个特解是稳态值。完整解为：\n$$\n[\\text{PIP3}](t) = \\frac{\\alpha k_{\\text{PI3K}} P_{\\text{tot}}}{k_{\\text{eff}}} + C \\exp(-k_{\\text{eff}} t)\n$$\n我们使用初始条件 $[\\text{PIP3}](0) = 0$ 来确定积分常数 $C$：\n$$\n0 = \\frac{\\alpha k_{\\text{PI3K}} P_{\\text{tot}}}{k_{\\text{eff}}} + C \\exp(0) \\implies C = -\\frac{\\alpha k_{\\text{PI3K}} P_{\\text{tot}}}{k_{\\text{eff}}}\n$$\n将 $C$ 代回，$[\\text{PIP3}]$ 随时间的演化为：\n$$\n[\\text{PIP3}](t) = \\frac{\\alpha k_{\\text{PI3K}} P_{\\text{tot}}}{k_{\\text{eff}}} (1 - \\exp(-k_{\\text{eff}} t))\n$$\n\n稳态浓度 $[\\text{PIP3}]_{\\text{ss}}$ 是 $[\\text{PIP3}](t)$ 在 $t \\to \\infty$ 时的值：\n$$\n[\\text{PIP3}]_{\\text{ss}} = \\lim_{t \\to \\infty} [\\text{PIP3}](t) = \\frac{\\alpha k_{\\text{PI3K}} P_{\\text{tot}}}{k_{\\text{eff}}} = \\frac{\\alpha k_{\\text{PI3K}} P_{\\text{tot}}}{\\alpha k_{\\text{PI3K}} + k_{\\text{PTEN}}}\n$$\n问题要求计算 PIP2 转化为 PIP3 的稳态分数，其定义为 $[\\text{PIP3}]_{\\text{ss}} / P_{\\text{tot}}$。\n$$\n\\frac{[\\text{PIP3}]_{\\text{ss}}}{P_{\\text{tot}}} = \\frac{\\alpha k_{\\text{PI3K}}}{\\alpha k_{\\text{PI3K}} + k_{\\text{PTEN}}}\n$$\n\n接下来，我们计算半衰期 $t_{1/2}$，即 $[\\text{PIP3}](t)$ 达到其稳态值一半时的时间：$[\\text{PIP3}](t_{1/2}) = \\frac{1}{2} [\\text{PIP3}]_{\\text{ss}}$。\n$$\n\\frac{1}{2} [\\text{PIP3}]_{\\text{ss}} = [\\text{PIP3}]_{\\text{ss}} (1 - \\exp(-k_{\\text{eff}} t_{1/2}))\n$$\n两边同除以 $[\\text{PIP3}]_{\\text{ss}}$（对于 $\\alpha, k_{\\text{PI3K}}  0$，其为非零值）：\n$$\n\\frac{1}{2} = 1 - \\exp(-k_{\\text{eff}} t_{1/2})\n$$\n$$\n\\exp(-k_{\\text{eff}} t_{1/2}) = \\frac{1}{2}\n$$\n两边取自然对数：\n$$\n-k_{\\text{eff}} t_{1/2} = \\ln\\left(\\frac{1}{2}\\right) = -\\ln(2)\n$$\n$$\nt_{1/2} = \\frac{\\ln(2)}{k_{\\text{eff}}} = \\frac{\\ln(2)}{\\alpha k_{\\text{PI3K}} + k_{\\text{PTEN}}}\n$$\n\n现在我们代入给定的数值：$k_{\\text{PI3K}} = 0.05\\,\\text{s}^{-1}$，$k_{\\text{PTEN}} = 0.02\\,\\text{s}^{-1}$，以及 $\\alpha = 0.30$。\n首先，计算有效速率常数 $k_{\\text{eff}}$：\n$$\nk_{\\text{eff}} = (0.30)(0.05\\,\\text{s}^{-1}) + 0.02\\,\\text{s}^{-1} = 0.015\\,\\text{s}^{-1} + 0.02\\,\\text{s}^{-1} = 0.035\\,\\text{s}^{-1}\n$$\n稳态分数为：\n$$\n\\frac{[\\text{PIP3}]_{\\text{ss}}}{P_{\\text{tot}}} = \\frac{\\alpha k_{\\text{PI3K}}}{k_{\\text{eff}}} = \\frac{(0.30)(0.05)}{0.035} = \\frac{0.015}{0.035} = \\frac{15}{35} = \\frac{3}{7}\n$$\n转换为小数并四舍五入到四位有效数字：\n$$\n\\frac{3}{7} \\approx 0.428571... \\approx 0.4286\n$$\n半衰期为：\n$$\nt_{1/2} = \\frac{\\ln(2)}{k_{\\text{eff}}} = \\frac{\\ln(2)}{0.035\\,\\text{s}^{-1}} \\approx \\frac{0.693147...}{0.035\\,\\text{s}^{-1}} \\approx 19.8042... \\,\\text{s}\n$$\n四舍五入到四位有效数字得到：\n$$\nt_{1/2} \\approx 19.80\\,\\text{s}\n$$\n总磷脂酰肌醇浓度 $P_{\\text{tot}} = 10\\,\\mu\\text{M}$ 在这些计算中是不需要的。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0.4286  19.80\n\\end{pmatrix}\n}\n$$", "id": "3344245"}, {"introduction": "构建精确的生物系统模型不仅需要正确的数学描述，还需要能够从实验数据中可靠地估计模型参数。然而，并非所有参数都能被数据很好地确定。这个高级计算练习将介绍参数可辨识性分析，这在系统生物学建模中至关重要。你将通过构建费雪信息矩阵（Fisher Information Matrix, FIM），来评估一个 RTK 内吞与再循环模型的参数是否可以从模拟的脉冲追踪实验数据中被唯一确定，并找出最难辨识的参数组合 [@problem_id:3344235]。", "problem": "您将获得一个用于脉冲追踪实验中受体酪氨酸激酶（RTK）转运的双室线性质量作用模型，该模型描述了质膜（表面）和内化室中标记受体的数量。令 $R_s(t)$ 表示在时间 $t$ 表面标记的受体量，令 $R_i(t)$ 表示内化标记的受体量。该模型假设一阶内化、再循环和内部降解。参数向量为 $\\theta = [k_{\\mathrm{int}}, k_{\\mathrm{rec}}, k_{\\mathrm{deg}}]$，其中 $k_{\\mathrm{int}}$ 是内化速率常数，$k_{\\mathrm{rec}}$ 是再循环速率常数，$k_{\\mathrm{deg}}$ 是内部降解速率常数。所有速率常数的单位均为 $\\mathrm{s}^{-1}$。控制常微分方程为\n$$\n\\frac{dR_s}{dt} = -k_{\\mathrm{int}} R_s + k_{\\mathrm{rec}} R_i, \\quad\n\\frac{dR_i}{dt} = k_{\\mathrm{int}} R_s - (k_{\\mathrm{rec}} + k_{\\mathrm{deg}}) R_i,\n$$\n初始条件代表标记脉冲后的追踪开始：\n$$\nR_s(0) = R_0, \\quad R_i(0) = 0,\n$$\n其中 $R_0$ 是初始标记受体量（标记受体的无量纲分数或归一化为 $R_0=1$）。\n\n您在指定时间观测 $R_s(t)$ 和/或 $R_i(t)$，每个测量组分带有已知标准差为 $\\sigma_y$ 的独立加性高斯噪声。假设测量函数是恒等函数（观测值直接等于相应的状态组分），并且测量噪声是均值为零、方差为 $\\sigma_y^2$ 且在时间点和组分之间独立的高斯噪声。\n\n您的任务是通过基于连续时间灵敏度方程构建的费雪信息矩阵（FIM）来评估局部结构可辨识性和实际可辨识性。令 $x(t) = [R_s(t), R_i(t)]^\\top$ 表示状态向量，令 $S(t) = \\frac{\\partial x(t)}{\\partial \\theta}$ 表示 $2 \\times 3$ 的灵敏度矩阵，其中 $(j,\\ell)$ 项为 $\\frac{\\partial x_j(t)}{\\partial \\theta_\\ell}$。灵敏度动态特性由可微流的第一性原理得出：\n$$\n\\frac{d}{dt} S(t) = A(t) S(t) + B_\\theta(t), \\quad S(0) = 0_{2 \\times 3},\n$$\n其中 $A(t) = \\frac{\\partial f}{\\partial x}\\big|_{x(t),\\theta}$，$B_\\theta(t) = \\frac{\\partial f}{\\partial \\theta}\\big|_{x(t),\\theta}$，对于状态动态的右侧函数 $f(x,\\theta)$。对于上述线性模型，\n$$\nA(t) = \\begin{bmatrix}\n-k_{\\mathrm{int}}  k_{\\mathrm{rec}} \\\\\nk_{\\mathrm{int}}  -(k_{\\mathrm{rec}} + k_{\\mathrm{deg}})\n\\end{bmatrix},\n\\quad\nB_\\theta(t) = \\begin{bmatrix}\n-\\;R_s(t)  \\;\\;R_i(t)  \\;\\;0 \\\\\n\\;\\;R_s(t)  -R_i(t)  -R_i(t)\n\\end{bmatrix}.\n$$\n\n给定观测时间 $t_1, \\dots, t_N$，由索引集 $\\mathcal{O} \\subset \\{1,2\\}$（$1$ 代表 $R_s$，$2$ 代表 $R_i$）指示的观测组分的一个子集，以及所有观测组分共有的标准差 $\\sigma_y$，费雪信息矩阵为\n$$\nF(\\theta) = \\sum_{k=1}^N \\sum_{j \\in \\mathcal{O}} \\frac{1}{\\sigma_y^2} \\left( \\frac{\\partial x_j(t_k)}{\\partial \\theta} \\right)^\\top \\left( \\frac{\\partial x_j(t_k)}{\\partial \\theta} \\right),\n$$\n其中 $\\frac{\\partial x_j(t_k)}{\\partial \\theta}$ 是 $S(t_k)$ 中对应于组分 $j$ 的 $1 \\times 3$ 行向量。对对称矩阵 $F(\\theta)$ 进行特征分解以提取特征值和特征向量。将 $F(\\theta)$ 的数值条件数定义为\n$$\n\\kappa_{10} = \\log_{10} \\left( \\frac{\\lambda_{\\max}}{\\max(\\lambda_{\\min}, \\epsilon)} \\right),\n$$\n其中 $\\lambda_{\\max}$ 和 $\\lambda_{\\min}$ 分别是 $F(\\theta)$ 的最大和最小特征值，固定正则化项 $\\epsilon = 10^{-12}$ 以避免在奇异情况下的除零错误。将最松弛方向定义为与 $\\lambda_{\\min}$ 相关的单位特征向量 $v_{\\mathrm{sloppy}}$。为了解释哪个参数组合最松弛，计算 $v_{\\mathrm{sloppy}}$ 与 $k_{\\mathrm{rec}}$ 的单位轴向量 $e_{\\mathrm{rec}} = [0,1,0]^\\top$ 之间的主角（以度为单位）。该角度为\n$$\n\\phi = \\arccos\\!\\left( \\left| v_{\\mathrm{sloppy}} \\cdot e_{\\mathrm{rec}} \\right| \\right) \\cdot \\frac{180}{\\pi},\n$$\n其中绝对值强制角度为锐角。\n\n编写一个完整的程序，对于下面指定的每个测试用例，使用上述基于灵敏度的方法构建 $F(\\theta)$，并返回两个输出：条件数的以10为底的对数 $\\kappa_{10}$ 和最松弛方向角度 $\\phi$（以度为单位）。所有速率常数必须以 $\\mathrm{s}^{-1}$ 为单位处理，所有角度必须以度为单位报告。此任务中没有任何百分比输出。\n\n使用以下参数集、观测设置和时间网格的测试套件：\n\n- 测试用例1（平衡转运，观测两个组分）：\n  - $\\theta = [k_{\\mathrm{int}}, k_{\\mathrm{rec}}, k_{\\mathrm{deg}}] = [0.15, 0.08, 0.02]$，单位为 $\\mathrm{s}^{-1}$。\n  - $R_0 = 1.0$ (无量纲)。\n  - 观测索引集 $\\mathcal{O} = \\{1,2\\}$。\n  - 观测时间 $t_k$（秒）：$[0, 5, 10, 20, 40, 80, 160]$。\n  - $\\sigma_y = 0.01$ (无量纲)。\n- 测试用例2（仅观测表面以探究实际不可辨识性）：\n  - $\\theta = [0.15, 0.08, 0.02]$，单位为 $\\mathrm{s}^{-1}$。\n  - $R_0 = 1.0$ (无量綱)。\n  - 观测索引集 $\\mathcal{O} = \\{1\\}$。\n  - 观测时间 $t_k$（秒）：$[0, 5, 10, 20, 40, 80, 160]$。\n  - $\\sigma_y = 0.01$ (无量綱)。\n- 测试用例3（慢再循环情况，观测两个组分）：\n  - $\\theta = [0.20, 0.005, 0.20]$，单位为 $\\mathrm{s}^{-1}$。\n  - $R_0 = 1.0$ (无量綱)。\n  - 观测索引集 $\\mathcal{O} = \\{1,2\\}$。\n  - 观测时间 $t_k$（秒）：$[0, 2, 4, 8, 16, 32, 64, 128]$。\n  - $\\sigma_y = 0.01$ (无量綱)。\n\n您的程序必须：\n- 积分耦合的状态和灵敏度动态方程，以在每个测试用例的指定时间获得 $S(t_k)$。\n- 使用上述公式以及指定的 $\\sigma_y$ 和 $\\mathcal{O}$ 组装费雪信息矩阵 $F(\\theta)$。\n- 计算 $\\kappa_{10}$（其中 $\\epsilon = 10^{-12}$）和 $v_{\\mathrm{sloppy}}$ 与 $e_{\\mathrm{rec}}$ 之间的锐角 $\\phi$（以度为单位）。\n- 生成单行输出，其中包含所有测试用例的结果，格式为方括号内以逗号分隔的列表，每个测试用例贡献一个二元列表 $[\\kappa_{10}, \\phi]$。例如，输出格式必须与 $[[a,b],[c,d],[e,f]]$ 完全一样，其中浮点数代替 a, b, c, d, e, f。", "solution": "该问题要求使用基于灵敏度的费雪信息矩阵（FIM）方法，评估受体转运双室模型的参数可辨识性。解决方案涉及数值积分一个耦合的常微分方程（ODE）系统（包括系统状态及其对模型参数的灵敏度），然后构建和分析FIM。\n\n### 数学模型和状态动态\n该系统描述了细胞表面的标记受体数量 $R_s(t)$ 和内室中的标记受体数量 $R_i(t)$。其动态由一个线性一阶ODE系统控制：\n$$\n\\frac{d R_s}{dt} = -k_{\\mathrm{int}} R_s + k_{\\mathrm{rec}} R_i\n$$\n$$\n\\frac{d R_i}{dt} = k_{\\mathrm{int}} R_s - (k_{\\mathrm{rec}} + k_{\\mathrm{deg}}) R_i\n$$\n在这里，参数向量为 $\\theta = [k_{\\mathrm{int}}, k_{\\mathrm{rec}}, k_{\\mathrm{deg}}]^\\top$，分别代表内化、再循环和降解的速率常数。实验追踪阶段的初始条件给定为 $R_s(0) = R_0$ 和 $R_i(0) = 0$，其中 $R_0$ 归一化为 $1.0$。\n\n### 通过增广ODE系统进行灵敏度分析\n为了构建FIM，我们需要状态变量相对于参数的灵敏度，即灵敏度矩阵 $S(t) = \\frac{\\partial x(t)}{\\partial \\theta}$ 的分量，其中 $x(t) = [R_s(t), R_i(t)]^\\top$。$S(t)$ 的动态由以下公式给出：\n$$\n\\frac{d}{dt} S(t) = A S(t) + B_\\theta(t)\n$$\n初始条件为 $S(0) = 0_{2 \\times 3}$，一个 $2 \\times 3$ 的零矩阵。矩阵 $A$ 和 $B_\\theta(t)$ 分别是状态动态相对于状态和参数的雅可比矩阵：\n$$\nA = \\begin{bmatrix} -k_{\\mathrm{int}}  k_{\\mathrm{rec}} \\\\ k_{\\mathrm{int}}  -(k_{\\mathrm{rec}} + k_{\\mathrm{deg}}) \\end{bmatrix}, \\quad\nB_\\theta(t) = \\begin{bmatrix}\n-R_s(t)  R_i(t)  0 \\\\\nR_s(t)  -R_i(t)  -R_i(t)\n\\end{bmatrix}\n$$\n为了数值求解该系统，我们创建一个维度为8的增广状态向量 $y(t)$，它结合了2个状态变量和灵敏度矩阵的6个分量。为了高效实现，将 $2 \\times 3$ 的灵敏度矩阵 $S(t)$ 按列展平。增广向量为 $y(t) = [R_s, R_i, S_{11}, S_{21}, S_{12}, S_{22}, S_{13}, S_{23}]^\\top$。然后对这个包含8个耦合ODE的完整系统进行数值积分。该增广系统的初始条件为 $y(0) = [R_0, 0, 0, 0, 0, 0, 0, 0]^\\top$。\n\n### 数值积分\n使用 `scipy.integrate.solve_ivp` 函数对每个测试用例的增广ODE系统从 $t=0$ 积分到最终观测时间。在每个案例中提供的特定时间点 $t_k$ 对解进行评估，从而得到状态轨迹 $x(t_k)$ 和灵敏度矩阵 $S(t_k)$。\n\n### 费雪信息矩阵（FIM）构建\nFIM $F(\\theta)$ 量化了观测数据提供的关于参数 $\\theta$ 的信息。对于方差为 $\\sigma_y^2$ 的独立加性高斯噪声，它通过对每个时间点上每个观测的贡献求和来计算：\n$$\nF(\\theta) = \\sum_{k=1}^{N} \\sum_{j \\in \\mathcal{O}} \\frac{1}{\\sigma_y^2} \\left( \\frac{\\partial x_j(t_k)}{\\partial \\theta} \\right)^\\top \\left( \\frac{\\partial x_j(t_k)}{\\partial \\theta} \\right)\n$$\n其中 $\\mathcal{O}$ 是观测组分的索引集（例如，$\\{1\\}$ 代表 $R_s$，$\\{1,2\\}$ 代表 $R_s$ 和 $R_i$），而 $\\frac{\\partial x_j(t_k)}{\\partial \\theta}$ 是灵敏度矩阵 $S(t_k)$ 的第 $j$ 行。求和中的每一项都是一个由灵敏度行向量与其自身的外积构成的 $3 \\times 3$ 矩阵。算法遍历指定的观测时间 $t_k$ 和观测组分 $j \\in \\mathcal{O}$，将这些外积累加到FIM中，然后乘以 $1/\\sigma_y^2$ 进行缩放。\n\n### 可辨识性度量计算\nFIM的性质揭示了参数的可辨识性。我们对对称的 $3 \\times 3$ 矩阵 $F(\\theta)$ 进行特征分解，得到其特征值 $\\lambda_i$ 和对应的特征向量 $v_i$。\n\n1.  **条件数**：最大特征值 $\\lambda_{\\max}$ 与最小特征值 $\\lambda_{\\min}$ 之比表示参数估计问题的刚度。大的条件数意味着“松弛性”，即某些参数组合受到数据的约束很弱。我们计算一个正则化条件数的以10为底的对数：\n    $$\n    \\kappa_{10} = \\log_{10} \\left( \\frac{\\lambda_{\\max}}{\\max(\\lambda_{\\min}, \\epsilon)} \\right)\n    $$\n    其中正则化项 $\\epsilon = 10^{-12}$ 防止在FIM为奇异矩阵时出现除零错误。\n\n2.  **最松弛方向角**：与 $\\lambda_{\\min}$ 相关联的特征向量 $v_{\\mathrm{sloppy}}$ 定义了参数空间中的“最松弛”方向——最不可辨识的参数组合。为了解释这个方向，我们计算它与特定参数轴的对齐程度。这里，我们计算 $v_{\\mathrm{sloppy}}$ 与代表 $k_{\\mathrm{rec}}$ 轴的单位向量 $e_{\\mathrm{rec}} = [0,1,0]^\\top$ 之间的主角 $\\phi$：\n    $$\n    \\phi = \\arccos\\!\\left( \\left| v_{\\mathrm{sloppy}} \\cdot e_{\\mathrm{rec}} \\right| \\right) \\cdot \\frac{180}{\\pi}\n    $$\n点积的绝对值确保角度是锐角（在 $0^\\circ$ 和 $90^\\circ$ 之間）。小角度 $\\phi$ 表示最松弛方向与 $k_{\\mathrm{rec}}$ 轴紧密对齐，意味着 $k_{\\mathrm{rec}}$ 是最难估计的参数（或不可辨识组合中的主导成分）。\n\n这整个过程应用于问题中指定的三个测试用例中的每一个，为每个用例生成一对值 $[\\kappa_{10}, \\phi]$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Main function to run the analysis for all test cases and print the results.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test case 1: balanced trafficking, both components observed\n        {\n            \"theta\": np.array([0.15, 0.08, 0.02]),  # [k_int, k_rec, k_deg]\n            \"R0\": 1.0,\n            \"obs_indices\": {1, 2},  # 1 for R_s, 2 for R_i\n            \"t_obs\": np.array([0, 5, 10, 20, 40, 80, 160]),\n            \"sigma_y\": 0.01\n        },\n        # Test case 2: surface-only observation\n        {\n            \"theta\": np.array([0.15, 0.08, 0.02]),\n            \"R0\": 1.0,\n            \"obs_indices\": {1},\n            \"t_obs\": np.array([0, 5, 10, 20, 40, 80, 160]),\n            \"sigma_y\": 0.01\n        },\n        # Test case 3: slow recycling regime, both components observed\n        {\n            \"theta\": np.array([0.20, 0.005, 0.20]),\n            \"R0\": 1.0,\n            \"obs_indices\": {1, 2},\n            \"t_obs\": np.array([0, 2, 4, 8, 16, 32, 64, 128]),\n            \"sigma_y\": 0.01\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = analyze_identifiability(case)\n        results.append(result)\n\n    # Format the final output as a list of lists of floats\n    formatted_results = [f\"[{res[0]},{res[1]}]\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\ndef dydt_augmented(t, y, theta):\n    \"\"\"\n    Defines the augmented ODE system for states and sensitivities.\n    \n    Args:\n        t (float): Time.\n        y (np.ndarray): Augmented state vector [R_s, R_i, S_11, S_21, ...].\n        theta (np.ndarray): Parameter vector [k_int, k_rec, k_deg].\n\n    Returns:\n        np.ndarray: The derivative of the augmented state vector.\n    \"\"\"\n    k_int, k_rec, k_deg = theta\n    R_s, R_i = y[0], y[1]\n\n    # Initialize derivative vector\n    dydt = np.zeros_like(y)\n\n    # State equations\n    dydt[0] = -k_int * R_s + k_rec * R_i\n    dydt[1] = k_int * R_s - (k_rec + k_deg) * R_i\n\n    # Sensitivity equations\n    # Jacobian of the system w.r.t. states\n    A = np.array([\n        [-k_int, k_rec],\n        [k_int, -(k_rec + k_deg)]\n    ])\n\n    # Jacobian of the system w.r.t. parameters\n    B_theta = np.array([\n        [-R_s, R_i, 0],\n        [R_s, -R_i, -R_i]\n    ])\n\n    # Sensitivities are flattened column-wise in the state vector y\n    # dS/dt = A*S + B_theta\n    # For each parameter (column of S and B_theta):\n    # dS_j/dt = A * S_j + B_theta_j\n\n    # Sensitivity w.r.t. k_int (S_col1)\n    S_col1 = y[2:4]\n    dydt[2:4] = A @ S_col1 + B_theta[:, 0]\n\n    # Sensitivity w.r.t. k_rec (S_col2)\n    S_col2 = y[4:6]\n    dydt[4:6] = A @ S_col2 + B_theta[:, 1]\n\n    # Sensitivity w.r.t. k_deg (S_col3)\n    S_col3 = y[6:8]\n    dydt[6:8] = A @ S_col3 + B_theta[:, 2]\n\n    return dydt\n\ndef analyze_identifiability(case):\n    \"\"\"\n    Performs the full identifiability analysis for a single test case.\n    \n    Args:\n        case (dict): A dictionary containing all parameters for the test case.\n        \n    Returns:\n        list: A list containing [kappa_10, phi].\n    \"\"\"\n    theta = case[\"theta\"]\n    R0 = case[\"R0\"]\n    obs_indices = case[\"obs_indices\"]\n    t_obs = case[\"t_obs\"]\n    sigma_y = case[\"sigma_y\"]\n    epsilon = 1e-12\n\n    # 1. Integrate the augmented ODE system\n    y0 = np.zeros(8)\n    y0[0] = R0  # R_s(0) = R0\n    t_span = [0, t_obs[-1]]\n    \n    sol = solve_ivp(\n        dydt_augmented,\n        t_span,\n        y0,\n        t_eval=t_obs,\n        args=(theta,),\n        method='RK45', \n        rtol=1e-8, \n        atol=1e-10\n    )\n\n    # 2. Assemble the Fisher Information Matrix (FIM)\n    num_params = 3\n    FIM = np.zeros((num_params, num_params))\n    \n    for k in range(len(t_obs)):\n        # Sensitivity matrix S(t_k)\n        # S_ij = d(x_i)/d(theta_j)\n        # Row 1 of S corresponds to R_s sensitivities\n        s_Rs = np.array([sol.y[2, k], sol.y[4, k], sol.y[6, k]])\n        # Row 2 of S corresponds to R_i sensitivities\n        s_Ri = np.array([sol.y[3, k], sol.y[5, k], sol.y[7, k]])\n\n        if 1 in obs_indices:  # R_s is observed\n            FIM += np.outer(s_Rs, s_Rs)\n        if 2 in obs_indices:  # R_i is observed\n            FIM += np.outer(s_Ri, s_Ri)\n    \n    FIM /= (sigma_y**2)\n\n    # 3. Compute identifiability metrics\n    # Eigendecomposition of the symmetric FIM\n    evals, evecs = np.linalg.eigh(FIM)\n    \n    lambda_min = evals[0]\n    lambda_max = evals[-1]\n    v_sloppy = evecs[:, 0]\n\n    # a. Condition number\n    kappa_10 = np.log10(lambda_max / max(lambda_min, epsilon))\n\n    # b. Sloppiest direction angle\n    e_rec = np.array([0., 1., 0.])\n    # The dot product is just the second component of the eigenvector\n    cos_angle_abs = np.abs(np.dot(v_sloppy, e_rec))\n    # Ensure argument to arccos is = 1.0 due to potential float precision issues\n    cos_angle_abs = min(cos_angle_abs, 1.0)\n    angle_rad = np.arccos(cos_angle_abs)\n    phi = np.degrees(angle_rad)\n\n    return [kappa_10, phi]\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3344235"}]}