{"hands_on_practices": [{"introduction": "线性噪声近似 (LNA) 是一个用于分析生化网络中噪声的强大理论框架。本练习将引导您完成一个标准工作流程：通过求解李雅普诺夫方程来计算系统在稳态下的协方差矩阵，这是随机基因表达建模中的一项基本技能。这个例子将帮助您掌握如何从一个具体的反应网络模型出发，定量地预测其组分的波动大小。 [@problem_id:3334083]", "problem": "考虑一个具有物种 $X$ 和 $Y$ 以及四个反应的双物种线性反应网络，该网络遵循质量作用动力学：\n- $R_{1}: \\varnothing \\rightarrow X$，速率常数为 $k_{0}$，\n- $R_{2}: X \\rightarrow \\varnothing$，速率常数为 $\\gamma_{1}$，\n- $R_{3}: X \\rightarrow Y$，速率常数为 $k_{12}$，\n- $R_{4}: Y \\rightarrow \\varnothing$，速率常数为 $\\gamma_{2}$。\n\n令状态向量为 $x = \\begin{pmatrix} x_{X} \\\\ x_{Y} \\end{pmatrix}$，其中 $x_{X}$ 和 $x_{Y}$ 表示分子数。化学计量矩阵 $S \\in \\mathbb{R}^{2 \\times 4}$ 由下式给出\n$$\nS = \\begin{pmatrix}\n1  -1  -1  0 \\\\\n0  0  1  -1\n\\end{pmatrix}.\n$$\n在质量作用动力学下的倾向向量为\n$$\n\\nu(x) = \\begin{pmatrix}\nk_{0} \\\\ \\gamma_{1} x_{X} \\\\ k_{12} x_{X} \\\\ \\gamma_{2} x_{Y}\n\\end{pmatrix}.\n$$\n\n已知对于一个线性反应网络，化学主方程的线性噪声近似 (LNA) 在稳态时会导出一个关于协方差矩阵 $C \\in \\mathbb{R}^{2 \\times 2}$ 的连续时间李雅普诺夫方程。该协方差矩阵描述了围绕确定性不动点 $x^{\\ast}$ 的涨落 $\\eta$。\n$$\nA C + C A^{\\top} + D = 0,\n$$\n其中雅可比矩阵 $A$ 在 $x^{\\ast}$ 处求值，扩散矩阵 $D$ 是每个反应通道在 $x^{\\ast}$ 处求值的秩一贡献之和，即\n$$\nD = \\sum_{r=1}^{4} \\nu_{r}(x^{\\ast})\\, s_{r} s_{r}^{\\top},\n$$\n其中 $s_{r}$ 是 $S$ 的第 $r$ 列，$\\nu_{r}(x^{\\ast})$ 是在 $x^{\\ast}$ 处的第 $r$ 个倾向。\n\n设数值参数值为 $k_{0} = 60$, $\\gamma_{1} = 2$, $k_{12} = 1$, $\\gamma_{2} = 1$。从由 $S$ 和 $\\nu(x)$ 推导出的确定性速率方程出发，首先确定唯一的稳定稳态 $x^{\\ast}$。然后根据上述定义在 $x^{\\ast}$ 处构建 $A$ 和 $D$，求解李雅普诺夫方程得到稳态协方差 $C$，最后利用其定义提取物种 $X$ 的法诺因子 $\\mathrm{FF}_{X}$ 和变异系数 $\\mathrm{CV}_{X}$。\n$$\n\\mathrm{FF}_{X} \\equiv \\frac{\\mathrm{Var}(X)}{\\mathbb{E}[X]}, \\qquad \\mathrm{CV}_{X} \\equiv \\frac{\\sqrt{\\mathrm{Var}(X)}}{\\mathbb{E}[X]}.\n$$\n\n以精确值的形式报告数对 $\\big(\\mathrm{FF}_{X}, \\mathrm{CV}_{X}\\big)$。不要四舍五入。这些量是无量纲的。你的最终答案必须是单个并列呈现的数对。", "solution": "该问题要求计算给定线性反应网络中物种 $X$ 的法诺因子 $\\mathrm{FF}_{X}$ 和变异系数 $\\mathrm{CV}_{X}$。求解过程分五步：首先，确定确定性稳态；其次，计算雅可比矩阵 $A$；第三，计算扩散矩阵 $D$；第四，求解稳态李雅普诺夫方程得到协方差矩阵 $C$；最后，利用这些结果计算所需量。\n\n第 1 步：确定确定性稳态 $x^{\\ast}$。\n平均分子数的确定性速率方程由表达式 $\\frac{dx}{dt} = S \\nu(x)$ 给出，其中 $x = \\begin{pmatrix} x_{X} \\\\ x_{Y} \\end{pmatrix}$ 是分子数的状态向量，$S$ 是化学计量矩阵，$\\nu(x)$ 是倾向向量。\n\n将其展开写出：\n$$\n\\frac{d}{dt} \\begin{pmatrix} x_{X} \\\\ x_{Y} \\end{pmatrix} = \\begin{pmatrix} 1  -1  -1  0 \\\\ 0  0  1  -1 \\end{pmatrix} \\begin{pmatrix} k_{0} \\\\ \\gamma_{1} x_{X} \\\\ k_{12} x_{X} \\\\ \\gamma_{2} x_{Y} \\end{pmatrix} = \\begin{pmatrix} k_{0} - \\gamma_{1} x_{X} - k_{12} x_{X} \\\\ k_{12} x_{X} - \\gamma_{2} x_{Y} \\end{pmatrix}\n$$\n这给出了以下常微分方程组：\n$$\n\\frac{dx_{X}}{dt} = k_{0} - (\\gamma_{1} + k_{12})x_{X}\n$$\n$$\n\\frac{dx_{Y}}{dt} = k_{12}x_{X} - \\gamma_{2}x_{Y}\n$$\n稳态 $x^{\\ast} = \\begin{pmatrix} x_{X}^{\\ast} \\\\ x_{Y}^{\\ast} \\end{pmatrix}$ 可通过将时间导数设为零来求得。由第一个方程得：\n$$\nk_{0} - (\\gamma_{1} + k_{12})x_{X}^{\\ast} = 0 \\implies x_{X}^{\\ast} = \\frac{k_{0}}{\\gamma_{1} + k_{12}}\n$$\n由第二个方程得：\n$$\nk_{12}x_{X}^{\\ast} - \\gamma_{2}x_{Y}^{\\ast} = 0 \\implies x_{Y}^{\\ast} = \\frac{k_{12}}{\\gamma_{2}}x_{X}^{\\ast}\n$$\n代入给定的数值 $k_{0} = 60$, $\\gamma_{1} = 2$, $k_{12} = 1$, $\\gamma_{2} = 1$：\n$$\nx_{X}^{\\ast} = \\frac{60}{2 + 1} = \\frac{60}{3} = 20\n$$\n$$\nx_{Y}^{\\ast} = \\frac{1}{1}x_{X}^{\\ast} = 20\n$$\n因此，稳态为 $x^{\\ast} = \\begin{pmatrix} 20 \\\\ 20 \\end{pmatrix}$。在线性噪声近似 (LNA) 中，平均分子数由确定性稳态近似，所以 $\\mathbb{E}[X] \\approx x_{X}^{\\ast} = 20$。\n\n第 2 步：在 $x^{\\ast}$ 处构建雅可比矩阵 $A$。\n雅可比矩阵 $A$ 是速率方程的偏导数矩阵，在稳态 $x^{\\ast}$ 处求值。\n令 $f(x) = S \\nu(x) = \\begin{pmatrix} k_{0} - (\\gamma_{1} + k_{12})x_{X} \\\\ k_{12}x_{X} - \\gamma_{2}x_{Y} \\end{pmatrix}$。\n$$\nA = \\frac{\\partial f}{\\partial x}\\bigg|_{x=x^{\\ast}} = \\begin{pmatrix} \\frac{\\partial f_{X}}{\\partial x_{X}}  \\frac{\\partial f_{X}}{\\partial x_{Y}} \\\\ \\frac{\\partial f_{Y}}{\\partial x_{X}}  \\frac{\\partial f_{Y}}{\\partial x_{Y}} \\end{pmatrix}_{x=x^{\\ast}} = \\begin{pmatrix} -(\\gamma_{1} + k_{12})  0 \\\\ k_{12}  -\\gamma_{2} \\end{pmatrix}\n$$\n由于系统是线性的，雅可比矩阵是常数。代入数值：\n$$\nA = \\begin{pmatrix} -(2 + 1)  0 \\\\ 1  -1 \\end{pmatrix} = \\begin{pmatrix} -3  0 \\\\ 1  -1 \\end{pmatrix}\n$$\n这个下三角矩阵的特征值是其对角元素，即 $\\lambda_{1} = -3$ 和 $\\lambda_{2} = -1$。由于两者均为负数，该稳态是稳定的。\n\n第 3 步：在 $x^{\\ast}$ 处构建扩散矩阵 $D$。\n扩散矩阵定义为 $D = \\sum_{r=1}^{4} \\nu_{r}(x^{\\ast})\\, s_{r} s_{r}^{\\top}$，其中 $s_r$ 是 $S$ 的第 $r$ 列。首先，我们在稳态 $x^{\\ast} = \\begin{pmatrix} 20 \\\\ 20 \\end{pmatrix}$ 处计算倾向：\n$$\n\\nu_{1}(x^{\\ast}) = k_{0} = 60\n$$\n$$\n\\nu_{2}(x^{\\ast}) = \\gamma_{1}x_{X}^{\\ast} = 2 \\times 20 = 40\n$$\n$$\n\\nu_{3}(x^{\\ast}) = k_{12}x_{X}^{\\ast} = 1 \\times 20 = 20\n$$\n$$\n\\nu_{4}(x^{\\ast}) = \\gamma_{2}x_{Y}^{\\ast} = 1 \\times 20 = 20\n$$\n化学计量向量（$S$ 的列）为 $s_{1} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$，$s_{2} = \\begin{pmatrix} -1 \\\\ 0 \\end{pmatrix}$，$s_{3} = \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix}$，$s_{4} = \\begin{pmatrix} 0 \\\\ -1 \\end{pmatrix}$。\n现在我们构建 $D$：\n$$\nD = 60 \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} \\begin{pmatrix} 1  0 \\end{pmatrix} + 40 \\begin{pmatrix} -1 \\\\ 0 \\end{pmatrix} \\begin{pmatrix} -1  0 \\end{pmatrix} + 20 \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} -1  1 \\end{pmatrix} + 20 \\begin{pmatrix} 0 \\\\ -1 \\end{pmatrix} \\begin{pmatrix} 0  -1 \\end{pmatrix}\n$$\n$$\nD = 60 \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix} + 40 \\begin{pmatrix} 1  0 \\\\ 0  0 \\end{pmatrix} + 20 \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} + 20 \\begin{pmatrix} 0  0 \\\\ 0  1 \\end{pmatrix}\n$$\n$$\nD = \\begin{pmatrix} 60+40+20  -20 \\\\ -20  20+20 \\end{pmatrix} = \\begin{pmatrix} 120  -20 \\\\ -20  40 \\end{pmatrix}\n$$\n\n第 4 步：求解李雅普诺夫方程得到协方差矩阵 $C$。\n稳态协方差矩阵 $C$ 满足连续时间李雅普诺夫方程 $A C + C A^{\\top} + D = 0$。令 $C = \\begin{pmatrix} C_{11}  C_{12} \\\\ C_{21}  C_{22} \\end{pmatrix}$。由于 $C$ 是一个协方差矩阵，它是对称的，所以 $C_{12} = C_{21}$。\n$$\n\\begin{pmatrix} -3  0 \\\\ 1  -1 \\end{pmatrix} \\begin{pmatrix} C_{11}  C_{12} \\\\ C_{12}  C_{22} \\end{pmatrix} + \\begin{pmatrix} C_{11}  C_{12} \\\\ C_{12}  C_{22} \\end{pmatrix} \\begin{pmatrix} -3  1 \\\\ 0  -1 \\end{pmatrix} + \\begin{pmatrix} 120  -20 \\\\ -20  40 \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ 0  0 \\end{pmatrix}\n$$\n执行矩阵乘法：\n$$\n\\begin{pmatrix} -3C_{11}  -3C_{12} \\\\ C_{11}-C_{12}  C_{12}-C_{22} \\end{pmatrix} + \\begin{pmatrix} -3C_{11}  C_{11}-C_{12} \\\\ -3C_{12}  C_{12}-C_{22} \\end{pmatrix} + \\begin{pmatrix} 120  -20 \\\\ -20  40 \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ 0  0 \\end{pmatrix}\n$$\n将矩阵相加得到：\n$$\n\\begin{pmatrix} -6C_{11}+120  C_{11}-4C_{12}-20 \\\\ C_{11}-4C_{12}-20  2C_{12}-2C_{22}+40 \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ 0  0 \\end{pmatrix}\n$$\n这给出了一个关于 $C$ 元素的线性方程组：\n1. (1,1) 元素：$-6C_{11} + 120 = 0 \\implies C_{11} = \\frac{120}{6} = 20$。\n2. (1,2) 元素：$C_{11} - 4C_{12} - 20 = 0 \\implies 20 - 4C_{12} - 20 = 0 \\implies -4C_{12}=0 \\implies C_{12} = 0$。\n3. (2,2) 元素：$2C_{12} - 2C_{22} + 40 = 0 \\implies 2(0) - 2C_{22} + 40 = 0 \\implies C_{22} = \\frac{40}{2} = 20$。\n稳态协方差矩阵为 $C = \\begin{pmatrix} 20  0 \\\\ 0  20 \\end{pmatrix}$。物种 $X$ 的方差为 $\\mathrm{Var}(X) \\approx C_{11} = 20$。\n\n第 5 步：计算 $\\mathrm{FF}_{X}$ 和 $\\mathrm{CV}_{X}$。\n物种 $X$ 的法诺因子定义为 $\\mathrm{FF}_{X} \\equiv \\frac{\\mathrm{Var}(X)}{\\mathbb{E}[X]}$。使用从 LNA 获得的值：\n$$\n\\mathrm{FF}_{X} = \\frac{C_{11}}{x_{X}^{\\ast}} = \\frac{20}{20} = 1\n$$\n物种 $X$ 的变异系数定义为 $\\mathrm{CV}_{X} \\equiv \\frac{\\sqrt{\\mathrm{Var}(X)}}{\\mathbb{E}[X]}$：\n$$\n\\mathrm{CV}_{X} = \\frac{\\sqrt{C_{11}}}{x_{X}^{\\ast}} = \\frac{\\sqrt{20}}{20} = \\frac{\\sqrt{4 \\times 5}}{20} = \\frac{2\\sqrt{5}}{20} = \\frac{\\sqrt{5}}{10}\n$$\n得到的数对是 $\\big(\\mathrm{FF}_{X}, \\mathrm{CV}_{X}\\big) = \\big(1, \\frac{\\sqrt{5}}{10}\\big)$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 1  \\frac{\\sqrt{5}}{10} \\end{pmatrix}}\n$$", "id": "3334083"}, {"introduction": "虽然像法诺因子和平方变异系数 ($CV^2$) 这样的指标很有用，但它们并不能完全揭示基因表达噪声的全部故事。本练习通过一个思想实验，展示了两种在机理上截然不同的模型（内在的转录爆发与外在的速率异质性）如何能够产生相同的均值和方差。这挑战我们思考如何设计巧妙的实验来区分这些表面上相似的系统，从而更深入地理解噪声的生物学来源。 [@problem_id:3334118]", "problem": "一个等基因细胞群通过单分子荧光原位杂交（smFISH）进行分析，以量化单个基因在稳态下每个细胞的信使核糖核酸（mRNA）计数。您被要求从第一性原理出发，使用法诺因子和变异系数的平方来论证噪声量化。法诺因子定义为 $F \\equiv \\mathrm{Var}(X)/\\mathbb{E}[X]$，变异系数的平方定义为 $\\mathrm{CV}^2 \\equiv \\mathrm{Var}(X)/\\mathbb{E}[X]^2$，其中 $X$ 表示每个细胞的 mRNA 计数。考虑两种解释所测量的过度离散的机理假设：\n\n外在速率异质性模型：在每个细胞中，mRNA 由一个线性的生灭过程产生，具有恒定的产生速率 $k$ 和降解速率 $\\gamma$，但由于外在因素，$k$ 在不同细胞间有所不同。在给定细胞中，以一个固定的 $k$ 为条件，稳态 mRNA 计数服从参数为 $\\lambda = k/\\gamma$ 的泊松分布。在整个细胞群中，$\\lambda$ 是一个随机变量。\n\n内在脉冲模型：在每个细胞中，转录以瞬时脉冲的形式发生，这些脉冲以速率 $\\alpha$ 到达，构成一个泊松过程。每个脉冲产生平均值为 $b$ 的几何分布的 mRNA 数量，每个 mRNA 以速率 $\\gamma$ 降解。在稳态下，由于脉冲式产生，mRNA 计数服从非泊松分布。\n\n您的任务是选择一个选项，该选项为这两个模型正确地构建了显式参数化，使得它们具有相同的群体均值 $\\mu \\equiv \\mathbb{E}[X]$ 和相同的 $\\mathrm{CV}^2$，但在高阶矩（例如偏度）上有所不同，并提出一种能够在实践中区分这两种机理的实验策略。\n\n选择最佳选项。\n\nA. 外在速率异质性通过泊松-对数正态混合模型进行建模：在细胞间 $\\lambda \\sim \\mathrm{LogNormal}(\\mu_\\ell,\\sigma_\\ell^2)$，并且以 $\\lambda$ 为条件，$X \\mid \\lambda \\sim \\mathrm{Poisson}(\\lambda)$。选择 $\\mu_\\ell$ 和 $\\sigma_\\ell^2$ 以匹配内在脉冲模型的均值和 $\\mathrm{CV}^2$，方法是设置 $\\mathbb{E}[\\lambda] = \\mu$ 和 $\\mathrm{Var}(\\lambda) = \\mu^2/r$，其中 $r \\equiv \\alpha/\\gamma$；这通过 $\\sigma_\\ell^2 = \\log(1 + 1/r)$ 和 $\\mu_\\ell = \\log(\\mu) - \\sigma_\\ell^2/2$ 实现。内在脉冲模型通过 $r \\equiv \\alpha/\\gamma$ 和 $b \\equiv \\mu/r$ 进行参数化，因此稳态分布是均值为 $\\mu$、$\\mathrm{CV}^2 = 1/\\mu + 1/r$ 的负二项分布。为了区分这两种机理，进行双色双报告基因检测：在每个细胞中共表达两个独立的报告基因拷贝，并计算跨细胞相关性 $\\rho$。在外在异质性下，$\\rho = \\mathrm{Var}(\\lambda)/[\\mathrm{Var}(\\lambda)+\\mathbb{E}[\\lambda]] = (\\mu/r)/[1 + \\mu/r]$ 严格为正，而在具有独立启动子的内在脉冲模型下，$\\rho \\approx 0$；因此，尽管 $\\mu$ 和 $\\mathrm{CV}^2$ 相同，这两个模型仍是可区分的。\n\nB. 外在速率异质性通过泊松-伽马混合模型进行建模：在细胞间 $\\lambda \\sim \\mathrm{Gamma}(r,\\theta)$，并且以 $\\lambda$ 为条件，$X \\mid \\lambda \\sim \\mathrm{Poisson}(\\lambda)$。内在脉冲模型使用相同的 $r$ 和 $b$，其中 $b \\equiv \\mu/r$。由于两者都产生具有相同参数的负二项分布，它们不仅共享 $\\mu$ 和 $\\mathrm{CV}^2$，还共享所有高阶矩。为了区分机理，仅测量法诺因子；预计 $F$ 会有差异。\n\nC. 外在异质性通过使降解速率 $\\gamma$ 在细胞间呈对数正态分布引入，$\\gamma \\sim \\mathrm{LogNormal}(\\mu_g,\\sigma_g^2)$，而产生速率 $k$ 固定。内在脉冲模型使用参数 $r \\equiv \\alpha/\\gamma$ 和 $b \\equiv \\mu/r$。选择 $\\mu_g$ 和 $\\sigma_g^2$ 使得 $\\mathbb{E}[X] = k\\,\\mathbb{E}[\\gamma^{-1}] = \\mu$ 和 $\\mathrm{CV}^2 = 1/\\mu + 1/r$。为了区分机理，仅量化整个群体的均值 $\\mu$；预计均值会有差异。\n\nD. 外在速率异质性通过泊松-对数正态混合模型进行建模，其中 $\\sigma_\\ell^2 = \\log(1 + \\mu)$ 和 $\\mu_\\ell = \\log(\\mu)$，而内在脉冲模型用 $b \\equiv r/\\mu$ 进行参数化。为了区分机理，进行时间序列显微镜检查，仅估计零延迟下的自相关，这可以区分高阶矩。", "solution": "问题陈述已经过验证，被认为是合理的。它具有科学依据，问题阐述清晰，客观，并提出了一个在区分基因表达噪声的经典模型方面具有相当难度的挑战。所涉及的模型和概念是计算系统生物学中的标准内容。\n\n我们将首先从第一性原理推导这两种模型的统计特性，然后建立匹配它们前两个矩的条件，最后分析所提出的实验策略。这个框架将用于评估每个选项。\n\n设 $X$ 为每个细胞中 mRNA 计数的随机变量。群体均值为 $\\mu \\equiv \\mathbb{E}[X]$，方差为 $\\mathrm{Var}(X)$。法诺因子为 $F = \\mathrm{Var}(X)/\\mu$，变异系数的平方为 $\\mathrm{CV}^2 = \\mathrm{Var}(X)/\\mu^2$。\n\n### 模型 1：外在速率异质性\n\n在此模型中，单个细胞中 mRNA 计数以产生速率参数 $\\lambda$ 为条件，服从泊松分布：$X \\mid \\lambda \\sim \\mathrm{Poisson}(\\lambda)$。参数 $\\lambda$ 本身在细胞群体中是一个随机变量，反映了外在变异性。\n\n使用全期望定律计算均值：\n$$ \\mu = \\mathbb{E}[X] = \\mathbb{E}[\\mathbb{E}[X \\mid \\lambda]] = \\mathbb{E}[\\lambda] $$\n使用全方差定律：\n$$ \\mathrm{Var}(X) = \\mathbb{E}[\\mathrm{Var}(X \\mid \\lambda)] + \\mathrm{Var}(\\mathbb{E}[X \\mid \\lambda]) $$\n对于泊松分布，$\\mathbb{E}[X \\mid \\lambda] = \\mathrm{Var}(X \\mid \\lambda) = \\lambda$。将这些代入方差公式：\n$$ \\mathrm{Var}(X) = \\mathbb{E}[\\lambda] + \\mathrm{Var}(\\lambda) = \\mu + \\mathrm{Var}(\\lambda) $$\n该模型的变异系数平方为：\n$$ \\mathrm{CV}^2 = \\frac{\\mathrm{Var}(X)}{\\mu^2} = \\frac{\\mu + \\mathrm{Var}(\\lambda)}{\\mu^2} = \\frac{1}{\\mu} + \\frac{\\mathrm{Var}(\\lambda)}{\\mu^2} $$\n\n### 模型 2：内在脉冲\n\n该模型将基因表达描述为一个转录脉冲过程。已知此过程的稳态 mRNA 计数分布为负二项分布。关键参数是无量纲脉冲频率 $r = \\alpha/\\gamma$ 和平均脉冲大小 $b$。\nmRNA 计数的均值和方差为：\n$$ \\mu = \\mathbb{E}[X] = r b $$\n$$ \\mathrm{Var}(X) = r b (1+b) = \\mu(1+b) $$\n该模型的变异系数平方为：\n$$ \\mathrm{CV}^2 = \\frac{\\mathrm{Var}(X)}{\\mu^2} = \\frac{\\mu(1+b)}{\\mu^2} = \\frac{1+b}{\\mu} = \\frac{1}{\\mu} + \\frac{b}{\\mu} $$\n使用关系式 $\\mu = r b$，我们可以写出 $b = \\mu/r$。将其代入 $\\mathrm{CV}^2$ 表达式中得到：\n$$ \\mathrm{CV}^2 = \\frac{1}{\\mu} + \\frac{1}{r} $$\n\n### 矩匹配与可区分性\n\n问题要求对两个模型进行参数化，使其具有相同的均值 $\\mu$ 和相同的 $\\mathrm{CV}^2$。\n将两个模型的 $\\mathrm{CV}^2$ 表达式相等：\n$$ \\frac{1}{\\mu} + \\frac{\\mathrm{Var}(\\lambda)}{\\mu^2} = \\frac{1}{\\mu} + \\frac{1}{r} $$\n这得出了外在模型中 $\\lambda$ 的分布必须满足的条件：\n$$ \\mathrm{Var}(\\lambda) = \\frac{\\mu^2}{r} $$\n因此，为了匹配参数为 $r$ 和 $b=\\mu/r$ 的内在脉冲模型，外在异质性模型必须使用一个均值为 $\\mathbb{E}[\\lambda] = \\mu$ 且方差为 $\\mathrm{Var}(\\lambda) = \\mu^2/r$ 的 $\\lambda$ 分布来构建。\n\n为了区分这些模型，提出了双报告基因检测方法。设 $X_1$ 和 $X_2$ 是同一细胞中两个独立报告基因的表达水平。\n- 在外在模型中，两个基因都受到相同的外在变量 $\\lambda$ 的影响。因此，$X_1$ 和 $X_2$ 在给定 $\\lambda$ 的条件下是条件独立的，但它们在群体中是相关的。它们的协方差是：\n$$ \\mathrm{Cov}(X_1, X_2) = \\mathrm{Cov}(\\mathbb{E}[X_1|\\lambda], \\mathbb{E}[X_2|\\lambda]) = \\mathrm{Cov}(\\lambda, \\lambda) = \\mathrm{Var}(\\lambda) $$\n相关系数 $\\rho = \\mathrm{Cov}(X_1, X_2) / \\sqrt{\\mathrm{Var}(X_1)\\mathrm{Var}(X_2)}$ 是：\n$$ \\rho = \\frac{\\mathrm{Var}(\\lambda)}{\\mathrm{Var}(X)} = \\frac{\\mathrm{Var}(\\lambda)}{\\mu + \\mathrm{Var}(\\lambda)} $$\n由于为了存在外在噪声，必须有 $\\mathrm{Var}(\\lambda)  0$，所以相关性严格为正，$\\rho  0$。\n- 在内在模型中，两个独立报告基因的随机脉冲是不相关的。因此，$\\mathrm{Cov}(X_1, X_2) = 0$ 且 $\\rho = 0$。\n这种预测相关性的差异提供了一个清晰的实验特征。\n\n现在，我们评估每个选项。\n\n### 逐项分析\n\n**A. 外在速率异质性通过泊松-对数正态混合模型进行建模...**\n- **外在模型参数化：** 该选项提出 $\\lambda \\sim \\mathrm{LogNormal}(\\mu_\\ell, \\sigma_\\ell^2)$，其中 $\\sigma_\\ell^2 = \\log(1 + 1/r)$ 和 $\\mu_\\ell = \\log(\\mu) - \\sigma_\\ell^2/2$。对于对数正态分布，均值为 $e^{\\mu_\\ell + \\sigma_\\ell^2/2}$，方差为 $(e^{\\sigma_\\ell^2}-1)(e^{\\mu_\\ell + \\sigma_\\ell^2/2})^2$。\n  - 均值：$\\mathbb{E}[\\lambda] = e^{(\\log(\\mu) - \\sigma_\\ell^2/2) + \\sigma_\\ell^2/2} = e^{\\log(\\mu)} = \\mu$。这是正确的。\n  - 方差：$\\mathrm{Var}(\\lambda) = (e^{\\log(1+1/r)}-1)(\\mu)^2 = ((1+1/r)-1)\\mu^2 = \\mu^2/r$。这也是正确的。该参数化正确地匹配了所需的矩。\n- **内在模型参数化：** 该选项提出 $r \\equiv \\alpha/\\gamma$ 和 $b \\equiv \\mu/r$。这意味着 $\\mu = rb$ 和 $\\mathrm{CV}^2 = 1/\\mu + 1/r$，这是标准的、正确的公式。\n- **可区分性：** 外在模型是泊松-对数正态混合，而内在模型是负二项分布。这是两种不同的分布，因此它们在高阶矩上会有所不同，满足了问题的条件。\n- **实验策略：** 双色双报告基因检测是正确的方法。分析正确地预测，对于外在模型，相关性 $\\rho$ 严格为正，而对于内在模型，$\\rho \\approx 0$。我们来检查 $\\rho$ 的公式。该选项声称 $\\rho = \\mathrm{Var}(\\lambda)/[\\mathrm{Var}(\\lambda)+\\mathbb{E}[\\lambda]]$，这与我们的推导 $\\rho = \\frac{\\mathrm{Var}(\\lambda)}{\\mu + \\mathrm{Var}(\\lambda)}$ 一致。然后它代入匹配的参数得到 $\\rho = (\\mu/r)/[1 + \\mu/r]$。我们验证这一步：$\\rho = \\frac{\\mu^2/r}{\\mu + \\mu^2/r} = \\frac{\\mu/r}{1 + \\mu/r}$。最终的公式是正确的。\n- **结论：** 正确。该选项的所有部分都与第一性原理一致。\n\n**B. 外在速率异质性通过泊松-伽马混合模型进行建模...**\n- 一个已知的数学结果是，泊松-伽马混合分布就是负二项分布。内在脉冲模型也服从负二项分布。通过匹配均值和方差（或均值和 $\\mathrm{CV}^2$），这两个模型在数学上变得完全相同，产生完全相同的负二项分布。这违反了问题中“但在高阶矩上有所不同”的要求。此外，所提出的实验策略是“仅测量法诺因子；预计 $F$ 会有差异”。这是不正确的。法诺因子是 $F = \\mu \\cdot \\mathrm{CV}^2$。由于 $\\mu$ 和 $\\mathrm{CV}^2$ 都是通过构建来匹配的，所以法诺因子也必须相同。\n- **结论：** 不正确。\n\n**C. 外在异质性通过使降解速率 $\\gamma$ 在细胞间呈对数正态分布引入...**\n- 该选项提出的实验策略是“仅量化整个群体的均值 $\\mu$；预计均值会有差异”。这直接与问题的一个基本前提相矛盾，即构建两个共享相同群体均值 $\\mu$ 的模型。整个问题的要点是找到一种方法来区分在均值和方差层面上无法区分的模型。\n- **结论：** 不正确。\n\n**D. 外在速率异质性通过泊松-对数正态混合模型进行建模，其中 $\\sigma_\\ell^2 = \\log(1 + \\mu)$ 和 $\\mu_\\ell = \\log(\\mu)$...**\n- **外在模型参数化：** 所提出的参数给出的 $\\lambda$ 的均值为 $\\mathbb{E}[\\lambda] = e^{\\mu_\\ell + \\sigma_\\ell^2/2} = e^{\\log(\\mu) + \\log(1+\\mu)/2} = \\mu\\sqrt{1+\\mu} \\neq \\mu$。该参数化未能匹配均值。\n- **内在模型参数化：** 该选项提出 $b \\equiv r/\\mu$。这将得到一个均值 $\\mathbb{E}[X] = rb = r(r/\\mu) = r^2/\\mu$，这通常不等于 $\\mu$。正确的关系是 $b = \\mu/r$。\n- **实验策略：** 提议测量“仅零延迟下的自相关”。根据定义，一个过程在零延迟下的自相关就是其方差：$\\mathrm{Cov}(X, X) = \\mathrm{Var}(X)$。由于要求模型构建时具有相同的 $\\mu$ 和 $\\mathrm{CV}^2$，它们的方差 $\\mathrm{Var}(X) = \\mu^2 \\mathrm{CV}^2$ 也必须相同。因此，这种测量无法区分这两个模型。\n- **结论：** 不正确。\n\n基于详细分析，选项 A 是唯一一个正确地对模型进行参数化以满足规定条件，提出了有效的实验策略，并对结果做出了正确预测的选项。", "answer": "$$\\boxed{A}$$", "id": "3334118"}, {"introduction": "大多数生物系统并非处于静态的稳态。这个高级练习旨在解决这一复杂性，探讨了如何在经历同步分裂的细胞群体中量化噪声，其中基因剂量等参数随细胞周期动态变化。通过求解含时矩方程并考虑细胞分裂时的随机分配，您将学习如何将单个细胞内的动力学过程与非同步群体的快照测量统计量联系起来。 [@problem_id:3334066]", "problem": "考虑一个单个基因中的组成型信使核糖核酸 (mRNA) 转录-降解过程，该基因在每个细胞周期的脱氧核糖核酸 (DNA) 合成期（S期）内会经历一次精确的基因剂量加倍。将 mRNA 数量建模为一个连续时间生灭过程，其具有仅因基因拷贝数变化而产生的时间依赖性迁入（出生）率，以及线性一阶降解。假设以下科学标准基础：\n\n1. 该过程是一个迁入-消亡马尔可夫过程：如果 $m(t)$ 是时间 $t$ 时的 mRNA 拷贝数，则出生以速率 $\\alpha(t)$ 发生，死亡以速率 $\\gamma \\, m(t)$ 发生，其中 $\\gamma  0$ 是降解速率常数。化学主方程导出的矩动力学为\n   - $\\dfrac{d}{dt}\\,\\mathbb{E}[m(t)] = \\alpha(t) - \\gamma \\,\\mathbb{E}[m(t)]$,\n   - $\\dfrac{d}{dt}\\,\\mathrm{Var}[m(t)] = \\alpha(t) + \\gamma \\,\\mathbb{E}[m(t)] - 2 \\gamma \\,\\mathrm{Var}[m(t)]$,\n   其中 $\\mathbb{E}[\\cdot]$ 表示期望，$\\mathrm{Var}[\\cdot]$ 表示方差。\n2. 基因剂量加倍被建模为在每个持续时间为 $T$ 的细胞周期内的分段恒定出生率：对于周期内的 $t$，\n   - 对于 $0 \\le t  \\phi_S T$，有一个基因拷贝，$\\alpha(t) = k$，\n   - 对于 $\\phi_S T \\le t  T$，有两个基因拷贝，$\\alpha(t) = 2k$，\n   其中 $0 \\le \\phi_S \\le 1$ 是 S 期起始分数，$k  0$ 是每个拷贝的转录速率。因此，$\\alpha(t)$ 是一个周期为 $T$ 的已知周期函数。\n3. 在细胞分裂时（$t = T$），分子通过独立的二项分配被分配到目标子细胞中，每个分子的成功概率为 $p = 1/2$。因此，如果 $M_T$ 是分裂前的数量，那么分裂后的数量 $M_0$ 满足 $M_0 \\,|\\, M_T \\sim \\mathrm{Binomial}(M_T, p)$，这导出了前两个矩的边界条件：\n   - $\\mathbb{E}[M_0] = p \\,\\mathbb{E}[M_T]$,\n   - $\\mathrm{Var}[M_0] = p^2 \\,\\mathrm{Var}[M_T] + p(1-p)\\,\\mathbb{E}[M_T]$.\n4. 细胞群体是异步的，并且在细胞年龄 $[0,T)$ 上进行均匀采样以进行快照测量。因此，快照均值是一个细胞周期内年龄条件均值的时间平均值，快照二阶矩是一个细胞周期内年龄条件二阶矩的时间平均值。快照方差是年龄条件二阶矩的时间平均值减去快照均值的平方。\n\n您的任务是，对于给定的参数集 $(k,\\gamma,T,\\phi_S)$，计算异步快照中 mRNA 数量分布的快照 Fano 因子 $F$ 和变异系数的平方 (CV$^2$)。使用以下精确定义，所有时间采样在 $[0,T)$ 上是均匀的：\n- Fano 因子 $F$ 定义为 $F = \\dfrac{\\mathrm{Var}_{\\mathrm{snap}}[m]}{\\mathbb{E}_{\\mathrm{snap}}[m]}$。\n- 变异系数 (CV) 定义为 $\\mathrm{CV} = \\dfrac{\\sqrt{\\mathrm{Var}_{\\mathrm{snap}}[m]}}{\\mathbb{E}_{\\mathrm{snap}}[m]}$。报告 $\\mathrm{CV}^2$。\n\n基于上述基本原理进行工作。特别地，您必须：\n- 通过分裂时的二项边界映射和周期内的分段恒定动力学来强制执行循环平稳条件。\n- 推导在前两个矩在每个分段恒定 $\\alpha(t)$ 区间内的时间演化。\n- 通过对一个周期内的年龄条件矩进行积分，计算快照均值和快照二阶矩。\n- 根据这些值，计算快照方差、Fano 因子 $F$ 和 $\\mathrm{CV}^2$。\n\n物理和数值单位：\n- 使用 $k$ 的单位为分子/分钟，$\\gamma$ 的单位为/分钟，以及 $T$ 的单位为分钟。输出 $F$ 和 $\\mathrm{CV}^2$ 是无量纲的。\n- 将每个浮点数结果四舍五入到恰好六位小数。\n\n测试套件：\n为以下参数集 $(k,\\gamma,T,\\phi_S)$ 计算结果，每个参数集的二项分配概率均为 $p = 1/2$：\n- 情况 A（理想情况，快速降解）：$(k,\\gamma,T,\\phi_S) = (5.0, 1.0, 60.0, 0.5)$。\n- 情况 B（慢速降解，强细胞周期记忆）：$(k,\\gamma,T,\\phi_S) = (2.0, 0.05, 60.0, 0.5)$。\n- 情况 C（在起始时刻加倍的极限情况）：$(k,\\gamma,T,\\phi_S) = (2.0, 1.0, 60.0, 0.0)$。\n- 情况 D（极晚加倍）：$(k,\\gamma,T,\\phi_S) = (2.0, 1.0, 60.0, 0.99)$。\n- 情况 E（周期内不加倍，对照组）：$(k,\\gamma,T,\\phi_S) = (2.0, 1.0, 60.0, 1.0)$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔的浮点数列表。对于每种情况，按顺序输出两个数字：首先是 Fano 因子 $F$，然后是 $\\mathrm{CV}^2$。将所有情况 A, B, C, D, E 的结果按顺序聚合到一个扁平列表中。例如，格式为 $[F_A,\\mathrm{CV}^2_A,F_B,\\mathrm{CV}^2_B,F_C,\\mathrm{CV}^2_C,F_D,\\mathrm{CV}^2_D,F_E,\\mathrm{CV}^2_E]$，每个值四舍五入到恰好六位小数，且无额外文本。", "solution": "我们从具有时间依赖性迁入率 $\\alpha(t)$ 和一阶降解率 $\\gamma$ 的迁入-消亡模型开始。对于 $m(t)$，化学主方程产生标准的矩动力学\n$$\n\\frac{d}{dt}\\,\\mu(t) \\equiv \\frac{d}{dt}\\,\\mathbb{E}[m(t)] = \\alpha(t) - \\gamma \\,\\mu(t),\n$$\n$$\n\\frac{d}{dt}\\,v(t) \\equiv \\frac{d}{dt}\\,\\mathrm{Var}[m(t)] = \\alpha(t) + \\gamma \\,\\mu(t) - 2 \\gamma \\, v(t),\n$$\n这些方程由生灭过程的一般矩更新公式得出。在任何 $\\alpha(t) \\equiv \\alpha$ 为常数的区间内，这些线性常微分方程 (ODEs) 存在闭式解：\n- 均值指数松弛到稳态水平 $m_{\\infty} = \\alpha/\\gamma$：\n$$\n\\mu(t) = m_{\\infty} + \\left(\\mu_0 - m_{\\infty}\\right) e^{-\\gamma t},\n$$\n其中 $\\mu_0$ 是区间开始时的均值。\n- 方差的演化遵循\n$$\nv(t) = v_0 e^{-2\\gamma t} + \\frac{\\alpha}{\\gamma}\\left(1 - e^{-2\\gamma t}\\right) + \\frac{\\gamma \\mu_0 - \\alpha}{\\gamma}\\left(e^{-\\gamma t} - e^{-2\\gamma t}\\right),\n$$\n其中 $v_0$ 是区间开始时的方差。\n\n这些表达式是通过标准的线性常微分方程求解方法推导出来的。对于均值，我们使用积分因子 $e^{\\gamma t}$。对于方差，注意到方差的常微分方程是线性的，其非齐次项为 $\\alpha + \\gamma \\mu(t)$；代入已知的 $\\mu(t)$ 会得到指数函数的叠加，这可以显式积分。\n\n细胞分裂边界条件由二项分配引起。如果 $M_T$ 是紧接分裂前的随机计数，$M_0$ 是分裂后子细胞的计数，成功概率为 $p = 1/2$ 的二项稀疏给出了矩的映射关系：\n$$\n\\mu(0^+) = \\mathbb{E}[M_0] = p\\,\\mathbb{E}[M_T] = p\\,\\mu(T^-),\n$$\n$$\nv(0^+) = \\mathrm{Var}[M_0] = p^2 \\,\\mathrm{Var}[M_T] + p(1-p)\\,\\mathbb{E}[M_T] = p^2 v(T^-) + p(1-p)\\,\\mu(T^-).\n$$\n我们寻求循环平稳解，其中分布（及其矩）在不同周期之间是周期性的。我们对一个持续时间为 $T$ 的单一周期进行建模，其中 $\\alpha(t)$ 在时间 $t = \\phi_S T$ 有一次切换。定义 $t_1 = \\phi_S T$ 和 $t_2 = (1-\\phi_S) T$。这两个区间的恒定出生率分别为 $\\alpha_1 = k$ 和 $\\alpha_2 = 2k$。令 $\\mu_b$ 和 $v_b$ 表示 $t=0^+$ 时的初始矩，$\\mu_T$ 和 $v_T$ 表示 $t=T^-$ 时的分裂前矩。将矩在两个区间上传播，得到线性仿射关系：\n- 整个周期的均值可以写为\n$$\n\\mu_T = A\\,\\mu_b + c, \\quad A \\equiv e^{-\\gamma T}, \\quad c \\equiv \\frac{\\alpha_1}{\\gamma}\\left(1 - e^{-\\gamma t_1}\\right)e^{-\\gamma t_2} + \\frac{\\alpha_2}{\\gamma}\\left(1 - e^{-\\gamma t_2}\\right).\n$$\n这是通过将区间1（长度 $t_1$）和区间2（长度 $t_2$）上的均值解组合而成的。\n- 整个周期的方差可以表示为\n$$\nv_T = B\\,v_b + E\\,\\mu_b + F,\n$$\n其中 $B \\equiv e^{-2\\gamma T}$，$E \\equiv e^{-\\gamma T} - e^{-2\\gamma T}$，以及\n$$\nF \\equiv \\frac{\\alpha_1}{\\gamma} e^{-2\\gamma t_2}\\left(1 - e^{-\\gamma t_1}\\right) + \\frac{\\alpha_2}{\\gamma}\\left(1 - e^{-2\\gamma t_2}\\right) + \\left[\\frac{\\alpha_1}{\\gamma}\\left(1 - e^{-\\gamma t_1}\\right) - \\frac{\\alpha_2}{\\gamma}\\right]\\left(e^{-\\gamma t_2} - e^{-2\\gamma t_2}\\right).\n$$\n代数推导过程是首先写出区间1之后的方差\n$$\nv_1 = e^{-2\\gamma t_1} v_b + \\left(e^{-\\gamma t_1} - e^{-2\\gamma t_1}\\right)\\mu_b + \\frac{\\alpha_1}{\\gamma}\\left(1 - e^{-\\gamma t_1}\\right),\n$$\n然后通过区间2传播，收集依赖于 $v_b$、$\\mu_b$ 和常数的项。一个显著的简化是 $\\mu_b$ 的系数 $E$ 简化为 $E = e^{-\\gamma T} - e^{-2\\gamma T}$，与分割时间 $t_1$ 无关。\n\n在分裂时施加二项分配的循环平稳性，得到一个关于 $(\\mu_b, v_b)$ 的不动点系统：\n$$\n\\mu_b = p\\,\\mu_T = p(A\\,\\mu_b + c) \\;\\Rightarrow\\; \\mu_b = \\frac{p\\,c}{1 - pA},\n$$\n$$\nv_b = p^2 v_T + p(1-p)\\mu_T = p^2\\left(B v_b + E\\mu_b + F\\right) + p(1-p)\\left(A\\mu_b + c\\right),\n$$\n这得到\n$$\nv_b = \\frac{p^2(E\\mu_b + F) + p(1-p)(A\\mu_b + c)}{1 - p^2 B}.\n$$\n这些闭式表达式确定了任意 $(k,\\gamma,T,\\phi_S)$ 和 $p=1/2$ 的循环平稳初始矩 $(\\mu_b, v_b)$。\n\n为了计算在 $[0,T)$ 上均匀采样的异步群体中的快照统计数据，我们对年龄条件矩进行时间平均。对于每个持续时间为 $\\Delta t$、从 $(\\mu_0, v_0)$ 开始的恒定-$\\alpha$ 区间，我们使用显式的时间轨迹：\n- 均值轨迹为 $\\mu(t) = m_{\\infty} + (\\mu_0 - m_{\\infty})e^{-\\gamma t}$，其中 $m_{\\infty} = \\alpha/\\gamma$，其时间积分为\n$$\n\\int_0^{\\Delta t} \\mu(t)\\,dt = m_{\\infty}\\,\\Delta t + \\frac{\\mu_0 - m_{\\infty}}{\\gamma}\\left(1 - e^{-\\gamma \\Delta t}\\right).\n$$\n- 方差轨迹为\n$$\nv(t) = v_0 e^{-2\\gamma t} + \\frac{\\alpha}{\\gamma}\\left(1 - e^{-2\\gamma t}\\right) + \\frac{\\gamma \\mu_0 - \\alpha}{\\gamma}\\left(e^{-\\gamma t} - e^{-2\\gamma t}\\right),\n$$\n其积分为\n$$\n\\int_0^{\\Delta t} v(t)\\,dt = \\frac{v_0}{2\\gamma}\\left(1 - e^{-2\\gamma \\Delta t}\\right) + \\frac{\\alpha}{\\gamma}\\,\\Delta t - \\frac{\\alpha}{2\\gamma^2}\\left(1 - e^{-2\\gamma \\Delta t}\\right) + \\frac{\\gamma \\mu_0 - \\alpha}{\\gamma}\\left[\\frac{1 - e^{-\\gamma \\Delta t}}{\\gamma} - \\frac{1 - e^{-2\\gamma \\Delta t}}{2\\gamma}\\right].\n$$\n- 年龄条件的二阶矩是 $\\mathbb{E}[m(t)^2] = v(t) + \\mu(t)^2$。我们使用 $\\mu(t) = m_{\\infty} + D e^{-\\gamma t}$（其中 $D \\equiv \\mu_0 - m_{\\infty}$）来积分 $\\mu(t)^2$：\n$$\n\\int_0^{\\Delta t} \\mu(t)^2\\,dt = m_{\\infty}^2\\,\\Delta t + \\frac{2 m_{\\infty} D}{\\gamma}\\left(1 - e^{-\\gamma \\Delta t}\\right) + \\frac{D^2}{2\\gamma}\\left(1 - e^{-2\\gamma \\Delta t}\\right).\n$$\n\n对于给定的 $(k,\\gamma,T,\\phi_S)$ 的算法步骤：\n1. 设置 $\\alpha_1 = k$, $\\alpha_2 = 2k$, $t_1 = \\phi_S T$, $t_2 = (1-\\phi_S)T$, $p = 1/2$，并预计算 $A = e^{-\\gamma T}$, $B = e^{-2\\gamma T}$。\n2. 使用上述表达式计算 $c$，然后计算 $\\mu_b = \\dfrac{p\\,c}{1 - pA}$。\n3. 计算 $E = A - B$ 和 $F$，然后计算 $v_b = \\dfrac{p^2(E\\mu_b + F) + p(1-p)(A\\mu_b + c)}{1 - p^2 B}$。\n4. 对于区间1，在速率 $\\alpha_1$ 下，将 $(\\mu_b, v_b)$ 传播 $t_1$ 的时长，得到 $(\\mu_1, v_1)$ 和积分 $\\int_0^{t_1}\\mu\\,dt$, $\\int_0^{t_1}v\\,dt$ 及 $\\int_0^{t_1}\\mu^2\\,dt$。\n5. 对于区间2，在速率 $\\alpha_2$ 下，将 $(\\mu_1, v_1)$ 传播 $t_2$ 的时长，得到 $(\\mu_T, v_T)$ 和在 $[t_1,T)$ 上的相应积分。\n6. 计算快照均值 $\\bar{\\mu} = \\dfrac{1}{T}\\left(\\int_0^{t_1}\\mu\\,dt + \\int_{t_1}^{T}\\mu\\,dt\\right)$ 和快照二阶矩 $\\overline{m^2} = \\dfrac{1}{T}\\left(\\int_0^{t_1} (v+\\mu^2)\\,dt + \\int_{t_1}^{T} (v+\\mu^2)\\,dt\\right)$。\n7. 计算快照方差 $\\mathrm{Var}_{\\mathrm{snap}}[m] = \\overline{m^2} - \\bar{\\mu}^2$，然后计算 $F = \\mathrm{Var}_{\\mathrm{snap}}[m]/\\bar{\\mu}$ 和 $\\mathrm{CV}^2 = \\mathrm{Var}_{\\mathrm{snap}}[m]/\\bar{\\mu}^2$。\n8. 将 $F$ 和 $\\mathrm{CV}^2$ 四舍五入到六位小数。\n\n将此程序应用于指定的测试套件，会产生一个包含十个浮点值的列表，顺序为 $[F_A,\\mathrm{CV}^2_A,F_B,\\mathrm{CV}^2_B,F_C,\\mathrm{CV}^2_C,F_D,\\mathrm{CV}^2_D,F_E,\\mathrm{CV}^2_E]$，并按要求的格式单行打印。下面的实现执行了精确的闭式计算，确保了对于边界情况 $\\phi_S \\in \\{0,1\\}$ 的数值鲁棒性，并覆盖了相对于细胞周期持续时间 $T$ 的快速和慢速降解情况。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef propagate_segment(mu0, v0, alpha, gamma, dt):\n    \"\"\"\n    Propagate mean and variance over a segment of duration dt with constant alpha.\n    Also compute the integrals of mu(t), v(t), and mu(t)^2 over the segment.\n    \"\"\"\n    if dt == 0.0:\n        # No time passes; integrals are zero and end-states equal start-states.\n        return mu0, v0, 0.0, 0.0, 0.0\n\n    exp_g_dt = np.exp(-gamma * dt)\n    exp_2g_dt = np.exp(-2.0 * gamma * dt)\n\n    m_inf = alpha / gamma\n    # Mean trajectory\n    mu_end = m_inf + (mu0 - m_inf) * exp_g_dt\n    # Variance trajectory\n    v_end = (v0 * exp_2g_dt\n             + (alpha / gamma) * (1.0 - exp_2g_dt)\n             + ((gamma * mu0 - alpha) / gamma) * (exp_g_dt - exp_2g_dt))\n\n    # Integrals\n    # ∫ mu dt\n    int_mu = m_inf * dt + (mu0 - m_inf) * (1.0 - exp_g_dt) / gamma\n\n    # ∫ v dt\n    term1 = v0 * (1.0 - exp_2g_dt) / (2.0 * gamma)\n    term2 = (alpha / gamma) * dt - (alpha / gamma) * (1.0 - exp_2g_dt) / (2.0 * gamma)\n    term3 = ((gamma * mu0 - alpha) / gamma) * ((1.0 - exp_g_dt) / gamma - (1.0 - exp_2g_dt) / (2.0 * gamma))\n    int_v = term1 + term2 + term3\n\n    # ∫ mu^2 dt using mu(t) = m_inf + D e^{-gamma t}\n    D = mu0 - m_inf\n    int_mu2 = (m_inf ** 2) * dt + (2.0 * m_inf * D / gamma) * (1.0 - exp_g_dt) + (D ** 2) * (1.0 - exp_2g_dt) / (2.0 * gamma)\n\n    return mu_end, v_end, int_mu, int_v, int_mu2\n\ndef compute_snapshot_metrics(k, gamma, T, phi_S, p=0.5):\n    \"\"\"\n    Compute snapshot Fano factor and CV^2 for the specified parameters.\n    \"\"\"\n    # Segment durations and birth rates\n    t1 = phi_S * T\n    t2 = T - t1\n    alpha1 = k\n    alpha2 = 2.0 * k\n\n    # Precompute exponentials for full cycle\n    A = np.exp(-gamma * T)\n    B = np.exp(-2.0 * gamma * T)\n\n    # Compute c for mean mapping mu_T = A mu_b + c\n    if t1 == 0.0:\n        exp_g_t2 = np.exp(-gamma * t2)\n        c = (alpha2 / gamma) * (1.0 - exp_g_t2)\n    elif t2 == 0.0:\n        exp_g_t1 = np.exp(-gamma * t1)\n        c = (alpha1 / gamma) * (1.0 - exp_g_t1)\n    else:\n        exp_g_t1 = np.exp(-gamma * t1)\n        exp_g_t2 = np.exp(-gamma * t2)\n        c = (alpha1 / gamma) * (1.0 - exp_g_t1) * exp_g_t2 + (alpha2 / gamma) * (1.0 - exp_g_t2)\n\n    # Fixed-point mean at birth\n    denom_mu = (1.0 - p * A)\n    mu_b = (p * c) / denom_mu\n\n    # Variance mapping v_T = B v_b + E mu_b + F\n    E = A - B\n    # Compute F constant\n    if t2 == 0.0:\n        exp_g_t1 = np.exp(-gamma * t1)\n        F_const = (alpha1 / gamma) * (1.0 - exp_g_t1)\n    elif t1 == 0.0:\n        exp_g_t2 = np.exp(-gamma * t2)\n        exp_2g_t2 = np.exp(-2.0 * gamma * t2)\n        # When t1=0, the first term vanishes since (1 - e^{-gamma * 0})=0\n        F_const = (alpha2 / gamma) * (1.0 - exp_2g_t2) + ((0.0) - (alpha2 / gamma)) * (exp_g_t2 - exp_2g_t2)\n    else:\n        exp_g_t1 = np.exp(-gamma * t1)\n        exp_g_t2 = np.exp(-gamma * t2)\n        exp_2g_t2 = np.exp(-2.0 * gamma * t2)\n        F_const = ((alpha1 / gamma) * exp_2g_t2 * (1.0 - exp_g_t1)\n                   + (alpha2 / gamma) * (1.0 - exp_2g_t2)\n                   + ((alpha1 / gamma) * (1.0 - exp_g_t1) - (alpha2 / gamma)) * (exp_g_t2 - exp_2g_t2))\n\n    # Fixed-point variance at birth\n    denom_v = (1.0 - (p ** 2) * B)\n    v_b = ( (p ** 2) * (E * mu_b + F_const) + p * (1.0 - p) * (A * mu_b + c) ) / denom_v\n\n    # Now compute snapshot averages by integrating over both segments\n    # Segment 1\n    mu1, v1, int_mu_1, int_v_1, int_mu2_1 = propagate_segment(mu_b, v_b, alpha1, gamma, t1)\n    # Segment 2\n    muT, vT, int_mu_2, int_v_2, int_mu2_2 = propagate_segment(mu1, v1, alpha2, gamma, t2)\n\n    # Time-averaged mean and second moment\n    mu_bar = (int_mu_1 + int_mu_2) / T\n    E_m2_bar = (int_v_1 + int_v_2 + int_mu2_1 + int_mu2_2) / T\n    var_bar = E_m2_bar - mu_bar ** 2\n\n    # Compute Fano and CV^2\n    # Guard against extremely small mu_bar (should not occur with k>0), but ensure numerical stability.\n    if mu_bar == 0:\n        # Degenerate; return NaNs\n        return float('nan'), float('nan')\n    F = var_bar / mu_bar\n    CV2 = var_bar / (mu_bar ** 2)\n    return F, CV2\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (k, gamma, T, phi_S)\n    test_cases = [\n        (5.0, 1.0, 60.0, 0.5),   # Case A\n        (2.0, 0.05, 60.0, 0.5),  # Case B\n        (2.0, 1.0, 60.0, 0.0),   # Case C\n        (2.0, 1.0, 60.0, 0.99),  # Case D\n        (2.0, 1.0, 60.0, 1.0),   # Case E\n    ]\n\n    results = []\n    for k, gamma, T, phi in test_cases:\n        F, CV2 = compute_snapshot_metrics(k, gamma, T, phi, p=0.5)\n        # Round to exactly six decimals as required\n        results.append(f\"{F:.6f}\")\n        results.append(f\"{CV2:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3334066"}]}