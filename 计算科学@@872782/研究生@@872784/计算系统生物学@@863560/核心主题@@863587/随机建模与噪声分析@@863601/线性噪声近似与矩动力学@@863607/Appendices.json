{"hands_on_practices": [{"introduction": "基因表达的两阶段模型是定量生物学的基石，理解其内在噪声是一个经典问题。本练习将引导你完成整个稳态线性噪声近似（$LNA$）的分析流程：定义化学反应网络、求解确定性稳态，并通过求解Lyapunov方程来获得分子数波动的协方差矩阵。通过这个练习[@problem_id:3323872]，你将掌握将$LNA$应用于多物种线性（或线性化）反应网络所需的基本计算技能。", "problem": "考虑一个充分混合的单细胞基因表达系统，其中包含信使RNA（$\\mathrm{mRNA}$）和蛋白质（$\\mathrm{Protein}$）两种化学物质，并经历以下遵循质量作用动力学的基元反应：转录 $\\emptyset \\xrightarrow{k_m} \\mathrm{mRNA}$、翻译 $\\mathrm{mRNA} \\xrightarrow{k_p} \\mathrm{mRNA}+ \\mathrm{Protein}$，以及一级降解 $\\mathrm{mRNA}\\xrightarrow{\\gamma_m}\\emptyset$、$\\mathrm{Protein}\\xrightarrow{\\gamma_p}\\emptyset$。设状态向量为 $\\phi(t) = (m(t), p(t))^{\\top}$，其中 $m(t)$ 和 $p(t)$ 表示确定性浓度或按固定系统体积缩放的拷贝数均值。使用化学计量矩阵 $S$ 和宏观速率函数 $f(\\phi) = S\\,a(\\phi)$（其中 $a(\\phi)$ 为质量作用倾向）的标准定义，构建 $S$ 和在确定性稳态 $\\phi^{\\ast}$ 处求值的雅可比矩阵 $A(\\phi^{\\ast}) = \\left.\\frac{\\partial f}{\\partial \\phi}\\right|_{\\phi=\\phi^{\\ast}}$。然后，调用线性噪声近似（LNA），确定蛋白质拷贝数涨落的稳态方差，即围绕 $\\phi^{\\ast}$ 的涨落的稳态协方差矩阵的 $(2,2)$ 元。请将最终答案表示为关于 $k_m$、$k_p$、$\\gamma_m$ 和 $\\gamma_p$ 的单个闭式解析表达式。不包含任何单位。无需进行数值计算。", "solution": "该问题是计算系统生物学中一个标准的、适定的练习。所有必要信息都已提供，模型在物理和数学上是合理的，目标也明确定义。该问题是有效的。\n\n该系统包含两种物质，$\\mathrm{mRNA}$ 和 $\\mathrm{Protein}$，其浓度由状态向量 $\\phi(t) = (m(t), p(t))^{\\top}$ 表示。四个基元反应是：\n1. 转录: $\\emptyset \\xrightarrow{k_m} \\mathrm{mRNA}$\n2. 翻译: $\\mathrm{mRNA} \\xrightarrow{k_p} \\mathrm{mRNA}+ \\mathrm{Protein}$\n3. mRNA 降解: $\\mathrm{mRNA}\\xrightarrow{\\gamma_m}\\emptyset$\n4. 蛋白质降解: $\\mathrm{Protein}\\xrightarrow{\\gamma_p}\\emptyset$\n\n首先，我们构建化学计量矩阵 $S$，它描述了每个反应中物质拷贝数的净变化。物质按 $(m, p)$ 排序，反应按 $(1, 2, 3, 4)$ 排序，净变化为：\n$R_1: \\Delta m=1, \\Delta p=0$\n$R_2: \\Delta m=0, \\Delta p=1$\n$R_3: \\Delta m=-1, \\Delta p=0$\n$R_4: \\Delta m=0, \\Delta p=-1$\n化学计量矩阵 $S$ 是一个 $2 \\times 4$ 矩阵：\n$$S = \\begin{pmatrix} 1  0  -1  0 \\\\ 0  1  0  -1 \\end{pmatrix}$$\n倾向向量 $a(\\phi)$ 包含每个反应的速率，遵循质量作用动力学：\n$$a(\\phi) = \\begin{pmatrix} k_m \\\\ k_p m \\\\ \\gamma_m m \\\\ \\gamma_p p \\end{pmatrix}$$\n宏观速率方程由 $\\frac{d\\phi}{dt} = f(\\phi) = S a(\\phi)$ 给出：\n$$\\frac{d\\phi}{dt} = \\begin{pmatrix} \\frac{dm}{dt} \\\\ \\frac{dp}{dt} \\end{pmatrix} = \\begin{pmatrix} 1  0  -1  0 \\\\ 0  1  0  -1 \\end{pmatrix} \\begin{pmatrix} k_m \\\\ k_p m \\\\ \\gamma_m m \\\\ \\gamma_p p \\end{pmatrix} = \\begin{pmatrix} k_m - \\gamma_m m \\\\ k_p m - \\gamma_p p \\end{pmatrix}$$\n为找到确定性稳态 $\\phi^{\\ast} = (m^{\\ast}, p^{\\ast})^{\\top}$，我们设置 $\\frac{d\\phi}{dt} = 0$：\n$$k_m - \\gamma_m m^{\\ast} = 0 \\implies m^{\\ast} = \\frac{k_m}{\\gamma_m}$$\n$$k_p m^{\\ast} - \\gamma_p p^{\\ast} = 0 \\implies p^{\\ast} = \\frac{k_p m^{\\ast}}{\\gamma_p} = \\frac{k_p}{\\gamma_p} \\left(\\frac{k_m}{\\gamma_m}\\right) = \\frac{k_m k_p}{\\gamma_m \\gamma_p}$$\n接下来，我们计算在稳态 $\\phi^{\\ast}$ 处求值的雅可比矩阵 $A = \\frac{\\partial f}{\\partial \\phi}$：\n$$A = \\left.\\begin{pmatrix} \\frac{\\partial}{\\partial m}(k_m - \\gamma_m m)  \\frac{\\partial}{\\partial p}(k_m - \\gamma_m m) \\\\ \\frac{\\partial}{\\partial m}(k_p m - \\gamma_p p)  \\frac{\\partial}{\\partial p}(k_p m - \\gamma_p p) \\end{pmatrix}\\right|_{\\phi=\\phi^{\\ast}} = \\begin{pmatrix} -\\gamma_m  0 \\\\ k_p  -\\gamma_p \\end{pmatrix}$$\n雅可比矩阵与状态 $\\phi$ 无关，因此 $A(\\phi^{\\ast}) = A$。\n\n线性噪声近似 (LNA) 通过李雅普诺夫方程 $\\frac{dC}{dt} = A C + C A^{\\top} + E$ 来模拟涨落协方差矩阵 $C(t)$ 的动力学。在稳态时，$\\frac{dC}{dt}=0$，所以稳态协方差矩阵 $C_{ss}$ 满足：\n$$A C_{ss} + C_{ss} A^{\\top} = -E$$\n扩散矩阵 $E$ 定义为 $E = S \\text{diag}(a(\\phi^{\\ast})) S^{\\top}$。首先，我们在稳态处计算倾向值：\n$$a(\\phi^{\\ast}) = \\begin{pmatrix} k_m \\\\ k_p m^{\\ast} \\\\ \\gamma_m m^{\\ast} \\\\ \\gamma_p p^{\\ast} \\end{pmatrix} = \\begin{pmatrix} k_m \\\\ k_p \\frac{k_m}{\\gamma_m} \\\\ \\gamma_m \\frac{k_m}{\\gamma_m} \\\\ \\gamma_p \\frac{k_m k_p}{\\gamma_m \\gamma_p} \\end{pmatrix} = \\begin{pmatrix} k_m \\\\ \\frac{k_m k_p}{\\gamma_m} \\\\ k_m \\\\ \\frac{k_m k_p}{\\gamma_m} \\end{pmatrix}$$\n现在我们计算 $E$：\n$$E = \\begin{pmatrix} 1  0  -1  0 \\\\ 0  1  0  -1 \\end{pmatrix} \\begin{pmatrix} k_m  0  0  0 \\\\ 0  \\frac{k_m k_p}{\\gamma_m}  0  0 \\\\ 0  0  k_m  0 \\\\ 0  0  0  \\frac{k_m k_p}{\\gamma_m} \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 0  1 \\\\ -1  0 \\\\ 0  -1 \\end{pmatrix}$$\n$$E = \\begin{pmatrix} k_m  0  -k_m  0 \\\\ 0  \\frac{k_m k_p}{\\gamma_m}  0  -\\frac{k_m k_p}{\\gamma_m} \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 0  1 \\\\ -1  0 \\\\ 0  -1 \\end{pmatrix} = \\begin{pmatrix} 2k_m  0 \\\\ 0  \\frac{2k_m k_p}{\\gamma_m} \\end{pmatrix}$$\n设 $C_{ss} = \\begin{pmatrix} C_{11}  C_{12} \\\\ C_{21}  C_{22} \\end{pmatrix}$，其中 $C_{12} = C_{21}$。李雅普诺夫方程变为：\n$$\\begin{pmatrix} -\\gamma_m  0 \\\\ k_p  -\\gamma_p \\end{pmatrix} \\begin{pmatrix} C_{11}  C_{12} \\\\ C_{12}  C_{22} \\end{pmatrix} + \\begin{pmatrix} C_{11}  C_{12} \\\\ C_{12}  C_{22} \\end{pmatrix} \\begin{pmatrix} -\\gamma_m  k_p \\\\ 0  -\\gamma_p \\end{pmatrix} = \\begin{pmatrix} -2k_m  0 \\\\ 0  -\\frac{2k_m k_p}{\\gamma_m} \\end{pmatrix}$$\n执行矩阵乘法得到：\n$$\\begin{pmatrix} -2\\gamma_m C_{11}  k_p C_{11} - \\gamma_m C_{12} - \\gamma_p C_{12} \\\\ k_p C_{11} - \\gamma_m C_{12} - \\gamma_p C_{12}  2k_p C_{12} - 2\\gamma_p C_{22} \\end{pmatrix} = \\begin{pmatrix} -2k_m  0 \\\\ 0  -\\frac{2k_m k_p}{\\gamma_m} \\end{pmatrix}$$\n这得到一个由三个线性方程组成的方程组：\n1.  $-2\\gamma_m C_{11} = -2k_m \\implies C_{11} = \\frac{k_m}{\\gamma_m}$\n2.  $k_p C_{11} - (\\gamma_m + \\gamma_p)C_{12} = 0 \\implies C_{12} = \\frac{k_p C_{11}}{\\gamma_m + \\gamma_p} = \\frac{k_p (k_m/\\gamma_m)}{\\gamma_m + \\gamma_p} = \\frac{k_m k_p}{\\gamma_m(\\gamma_m + \\gamma_p)}$\n3.  $2k_p C_{12} - 2\\gamma_p C_{22} = -\\frac{2k_m k_p}{\\gamma_m} \\implies \\gamma_p C_{22} = k_p C_{12} + \\frac{k_m k_p}{\\gamma_m}$\n\n我们想找到 $C_{22}$，即协方差矩阵的 $(2,2)$ 元，它代表蛋白质拷贝数涨落的方差。根据方程 $(3)$：\n$$C_{22} = \\frac{k_p}{\\gamma_p} C_{12} + \\frac{k_m k_p}{\\gamma_m \\gamma_p}$$\n代入方程 $(2)$ 中 $C_{12}$ 的表达式：\n$$C_{22} = \\frac{k_p}{\\gamma_p} \\left( \\frac{k_m k_p}{\\gamma_m(\\gamma_m + \\gamma_p)} \\right) + \\frac{k_m k_p}{\\gamma_m \\gamma_p}$$\n$$C_{22} = \\frac{k_m k_p^2}{\\gamma_m \\gamma_p (\\gamma_m + \\gamma_p)} + \\frac{k_m k_p}{\\gamma_m \\gamma_p}$$\n为了合并各项，我们找到一个公分母：\n$$C_{22} = \\frac{k_m k_p^2}{\\gamma_m \\gamma_p (\\gamma_m + \\gamma_p)} + \\frac{k_m k_p (\\gamma_m + \\gamma_p)}{\\gamma_m \\gamma_p (\\gamma_m + \\gamma_p)}$$\n$$C_{22} = \\frac{k_m k_p^2 + k_m k_p \\gamma_m + k_m k_p \\gamma_p}{\\gamma_m \\gamma_p (\\gamma_m + \\gamma_p)}$$\n从分子中提出公因子 $k_m k_p$ 得到最终表达式：\n$$C_{22} = \\frac{k_m k_p (\\gamma_m + \\gamma_p + k_p)}{\\gamma_m \\gamma_p (\\gamma_m + \\gamma_p)}$$\n该表达式代表蛋白质拷贝数涨落的稳态方差。", "answer": "$$\\boxed{\\frac{k_m k_p (\\gamma_m + \\gamma_p + k_p)}{\\gamma_m \\gamma_p (\\gamma_m + \\gamma_p)}}$$", "id": "3323872"}, {"introduction": "在掌握了线性系统的分析方法后，我们转向由非线性反应（如双分子相互作用）引入的复杂性。本练习[@problem_id:3323813]揭示了随机动力学中的一个根本性问题：非线性反应会导致一个不闭合的矩方程层级，其中低阶矩的动力学依赖于高阶矩。通过推导一个包含双分子湮灭反应的简单网络的精确矩方程，本练习将$LNA$（对过程进行线性化）与矩闭合近似（$MCA$s，直接近似高阶矩）这两种处理该问题的方法进行了概念上的对比。", "problem": "考虑一个在充分混合体积 $\\,\\Omega\\,$ 中、遵循质量作用动力学的单物种生成-湮灭网络：\n- $\\varnothing \\xrightarrow{k_1\\,\\Omega} X$ (零级生成)，\n- $2X \\xrightarrow{k_2/\\Omega} \\varnothing$ (双分子湮灭)，\n其中 $k_1$ 和 $k_2$ 是正常数，双分子倾向性中的因子 $1/\\Omega$ 确保了热力学极限的一致性。令 $X(t)$ 表示 $X$ 在时间 $t$ 的分子数。\n\n任务 1. 从化学主方程（CME）出发，推导一阶矩 $\\mu(t) = \\mathbb{E}[X(t)]$ 和二阶矩 $m_2(t) = \\mathbb{E}[X(t)^2]$ 的精确时间演化方程。识别出使二阶矩动力学不封闭的项。\n\n任务 2. 使用 van Kampen 系统尺寸展开和线性噪声近似（LNA），推导：\n- 浓度 $\\phi(t) = \\mu(t)/\\Omega$ 的确定性宏观漂移，\n- 以及浓度涨落的线性协方差动力学（记为 $\\Sigma_c(t)$），并用宏观漂移的雅可比矩阵以及由化学计量和宏观反应速率构建的扩散矩阵明确表示。\n\n任务 3. 根据你的推导，选择最准确地描述矩闭合近似（例如，正态/高斯或对数正态封闭）在估计像上述这样的双分子系统的协方差时，相对于 LNA 在何处以及为何会引入偏差的陈述。\n\n选项:\n\nA. 对于生成-湮灭网络，精确的二阶矩动力学包含一个与 $\\mathbb{E}[X^3]$ 成正比的贡献。LNA 通过求解一个仅依赖于宏观漂移的雅可比矩阵和在宏观均值处求值的扩散矩阵的李雅普诺夫方程来得到协方差，从而避免了对 $\\mathbb{E}[X^3]$ 的任何封闭。正态（高斯）和对数正态封闭相对于 LNA 引入偏差，正是因为它们将 $\\mathbb{E}[X^3]$（以及在多变量系统中，混合三阶矩）替换为均值和协方差的函数；偏差的符号和大小取决于倾向性的偏度和曲率，并且仅对于线性（至多为单分子）网络才消失。\n\nB. 在双分子质量作用系统中，LNA 已经假设了高斯状态分布，因此强制要求 $\\mathbb{E}[X^3] = \\mu^3 + 3\\mu\\,\\mathrm{Var}(X)$；因此，根据构造，高斯封闭相对于 LNA 是无偏的。\n\nC. 矩封闭相对于 LNA 引入的任何偏差仅源于扩散项，因为对 $\\mathrm{d}\\Sigma/\\mathrm{d}t$ 的漂移贡献仅依赖于化学计量，因此在不同封闭下是相同的。\n\nD. 对于处于稳态且系统尺寸大的生成-湮灭网络，高斯和对数正态封闭都收敛于 LNA 协方差，而对于有限尺寸，无论参数值如何，它们都必然高估相对于 LNA 的协方差。", "solution": "问题陈述是有效的。它提出了一个随机化学动力学中的标准、定义明确的问题，该问题具有科学依据、客观，并包含进行严格数学分析所需的所有必要信息。\n\n### 任务 1：精确矩动力学\n\n首先，我们定义随机模型。该系统涉及一个物种 $X$ 和两个反应：\n1.  **生成**：$\\varnothing \\xrightarrow{k_1\\,\\Omega} X$。这是一个零级反应。$X$ 的分子数（记为 $n$）变化量为 $S_1 = +1$。倾向性函数为 $w_1(n) = k_1\\Omega$。\n2.  **湮灭**：$2X \\xrightarrow{k_2/\\Omega} \\varnothing$。这是一个双分子反应。分子数变化量为 $S_2 = -2$。该反应的标准质量作用倾向性，使用化学物理中能够推导出确定性速率方程 $\\frac{d\\phi}{dt} = k_1 - k_2\\phi^2$（其中 $\\phi$ 是浓度）的常规表示法，为 $w_2(n) = \\frac{k_2}{2\\Omega}n(n-1)$。这里，$n(n-1)/2$ 是 $X$ 分子对的不同组合数，$k_2/\\Omega$ 是每对的速率常数。\n\n状态的任意函数 $f(n)$ 的期望值的时间演化由主方程给出：\n$$ \\frac{d\\mathbb{E}[f(X)]}{dt} = \\sum_{j=1}^{2} \\mathbb{E}[w_j(X) (f(X+S_j) - f(X))] $$\n\n**一阶矩动力学 ($\\mu(t) = \\mathbb{E}[X(t)]$)**\n令 $f(X) = n$。\n$$ \\frac{d\\mu}{dt} = \\mathbb{E}[w_1(n)((n+1)-n) + w_2(n)((n-2)-n)] $$\n$$ \\frac{d\\mu}{dt} = \\mathbb{E}[w_1(n) \\cdot (+1) + w_2(n) \\cdot (-2)] $$\n代入倾向性函数：\n$$ \\frac{d\\mu}{dt} = \\mathbb{E}\\left[k_1\\Omega - 2 \\cdot \\frac{k_2}{2\\Omega} n(n-1)\\right] = k_1\\Omega - \\frac{k_2}{\\Omega}\\mathbb{E}[n^2 - n] $$\n使用定义 $\\mu = \\mathbb{E}[n]$ 和 $m_2 = \\mathbb{E}[n^2]$：\n$$ \\frac{d\\mu}{dt} = k_1\\Omega - \\frac{k_2}{\\Omega}(m_2 - \\mu) $$\n这个一阶矩方程是不封闭的，因为它依赖于二阶矩 $m_2$。\n\n**二阶矩动力学 ($m_2(t) = \\mathbb{E}[X(t)^2]$)**\n令 $f(X) = n^2$。\n$$ \\frac{dm_2}{dt} = \\mathbb{E}[w_1(n)((n+1)^2-n^2) + w_2(n)((n-2)^2-n^2)] $$\n$$ \\frac{dm_2}{dt} = \\mathbb{E}[w_1(n)(2n+1) + w_2(n)(-4n+4)] $$\n代入倾向性函数：\n$$ \\frac{dm_2}{dt} = \\mathbb{E}\\left[k_1\\Omega(2n+1) + \\frac{k_2}{2\\Omega}n(n-1)(-4(n-1))\\right] $$\n$$ \\frac{dm_2}{dt} = \\mathbb{E}\\left[2k_1\\Omega n + k_1\\Omega - \\frac{2k_2}{\\Omega}n(n-1)^2\\right] $$\n取期望值：\n$$ \\frac{dm_2}{dt} = 2k_1\\Omega\\mu + k_1\\Omega - \\frac{2k_2}{\\Omega}\\mathbb{E}[n(n^2-2n+1)] $$\n$$ \\frac{dm_2}{dt} = 2k_1\\Omega\\mu + k_1\\Omega - \\frac{2k_2}{\\Omega}(\\mathbb{E}[n^3] - 2\\mathbb{E}[n^2] + \\mathbb{E}[n]) $$\n使用矩的定义，包括 $m_3 = \\mathbb{E}[n^3]$：\n$$ \\frac{dm_2}{dt} = 2k_1\\Omega\\mu + k_1\\Omega - \\frac{2k_2}{\\Omega}(m_3 - 2m_2 + \\mu) $$\n这个二阶矩方程是不封闭的。使其不封闭的项源于双分子湮灭反应，该反应引入了对三阶矩 $m_3 = \\mathbb{E}[X^3]$ 的依赖。\n\n### 任务 2：线性噪声近似（LNA）\n\nLNA 是从 van Kampen 系统尺寸展开推导出来的，其中粒子数 $n(t)$ 被分解为宏观部分和涨落部分：\n$$ n(t) = \\Omega\\phi(t) + \\sqrt{\\Omega}\\xi(t) $$\n其中 $\\phi(t)$ 是宏观浓度，$\\xi(t)$ 代表涨落，且 $\\mathbb{E}[\\xi(t)]=0$。\n\n**浓度 $\\phi(t)$ 的宏观漂移**\n宏观速率方程是通过在宏观极限 $n \\approx \\Omega\\phi$ 下评估倾向性的主导项得到的：\n$$ \\frac{d\\phi}{dt} = \\sum_{j=1}^{2} S_j \\frac{w_j(\\Omega\\phi)}{\\Omega} $$\n宏观倾向性为：\n$w_1(\\Omega\\phi) = k_1\\Omega$\n对于大的 $\\Omega$，$w_2(\\Omega\\phi) = \\frac{k_2}{2\\Omega}(\\Omega\\phi)(\\Omega\\phi-1) \\approx \\frac{k_2\\Omega}{2}\\phi^2$。\n因此，$\\phi(t)$ 的宏观漂移为：\n$$ \\frac{d\\phi}{dt} = (+1)\\frac{k_1\\Omega}{\\Omega} + (-2)\\frac{k_2\\Omega\\phi^2/2}{\\Omega} = k_1 - k_2\\phi^2 $$\n\n**浓度涨落 $\\Sigma_c(t)$ 的线性协方差动力学**\n浓度涨落的协方差为 $\\Sigma_c(t) = \\text{Var}(n(t)/\\Omega) = \\frac{1}{\\Omega^2}\\text{Var}(n(t))$。在 LNA 中，其动力学由一个李雅普诺夫方程控制：\n$$ \\frac{d\\Sigma_c}{dt} = J_c \\Sigma_c + \\Sigma_c J_c^T + D_c $$\n对于单变量系统，这简化为 $\\frac{d\\Sigma_c}{dt} = 2J_c\\Sigma_c + D_c$。\n\n**雅可比矩阵** $J_c$ 是宏观漂移矢量场相对于浓度矢量的导数。在这里它是一个标量：\n$$ J_c = \\frac{d}{d\\phi}(k_1 - k_2\\phi^2) = -2k_2\\phi $$\n\n**扩散矩阵** $D_c$ 由下式给出：\n$$ D_c = \\frac{1}{\\Omega^2} \\sum_{j=1}^{2} S_j S_j^T w_j(\\Omega\\phi) $$\n对于这个标量系统：\n$$ D_c = \\frac{1}{\\Omega^2} \\left( S_1^2 w_1(\\Omega\\phi) + S_2^2 w_2(\\Omega\\phi) \\right) $$\n$$ D_c = \\frac{1}{\\Omega^2} \\left( (+1)^2 (k_1\\Omega) + (-2)^2 \\left(\\frac{k_2\\Omega}{2}\\phi^2\\right) \\right) $$\n$$ D_c = \\frac{1}{\\Omega^2} (k_1\\Omega + 2k_2\\Omega\\phi^2) = \\frac{k_1 + 2k_2\\phi^2}{\\Omega} $$\n\n结合这些，$\\Sigma_c(t)$ 的线性协方差动力学为：\n$$ \\frac{d\\Sigma_c}{dt} = 2(-2k_2\\phi)\\Sigma_c + \\frac{k_1 + 2k_2\\phi^2}{\\Omega} $$\n$$ \\frac{d\\Sigma_c}{dt} = -4k_2\\phi\\Sigma_c + \\frac{k_1 + 2k_2\\phi^2}{\\Omega} $$\n这里，$\\phi(t)$ 是确定性宏观漂移方程的解。请注意，LNA 为均值和方差提供了一组封闭的方程，其中均值动力学独立于方差。\n\n### 任务 3：矩封闭与 LNA 的比较\n\n此任务要求我们描述矩封闭近似（MCAs）相对于 LNA 产生偏差的来源。我们的推导为此提供了必要的基础。\n\n**A. 正确。** 这个陈述准确地描述了核心差异。\n1.  “...精确的二阶矩动力学包含一个与 $\\mathbb{E}[X^3]$ 成正比的贡献。” 我们在任务 1 中的推导恰好显示了这一点，在 $\\frac{dm_2}{dt}$ 的方程中存在 $-\\frac{2k_2}{\\Omega}m_3$ 这一项。\n2.  “LNA 通过求解一个仅依赖于宏观漂移的雅可比矩阵...和在宏观均值处求值的扩散矩阵...的李雅普诺夫方程来得到协方差，从而避免了对 $\\mathbb{E}[X^3]$ 的任何封闭。” 我们在任务 2 中的推导证实了这一点。LNA 通过在确定性均值附近线性化过程动力学，为前两个矩生成了一个封闭系统，这个过程不涉及也不需要关于精确分布的三阶或更高阶矩的任何信息。\n3.  “正态（高斯）和对数正态封闭相对于 LNA 引入偏差，正是因为它们将 $\\mathbb{E}[X^3]$...替换为均值和协方差的函数”。这就是矩封闭近似的定义。为了求解任务 1 中不封闭的矩阶层，MCAs 必须假设不封闭矩（例如，$m_3$）与低阶矩（例如，$\\mu, m_2$）之间的关系。例如，高斯封闭假设三阶中心矩为零，这意味着 $m_3 = 3\\mu m_2 - 2\\mu^3$。这种显式近似与 LNA 的方法有根本不同。\n4.  “...偏差的符号和大小取决于倾向性的偏度和曲率，并且仅对于线性（至多为单分子）网络才消失。” 这是一个正确而深刻的总结。MCA（如高斯封闭）的偏差与真实分布的偏度偏离假设值（零）的程度有关。LNA 的误差与展开中被截断的倾向性函数中的非线性项（曲率）的大小有关。对于仅具有线性倾向性（零级和一级反应）的系统，矩方程本身就是封闭的，LNA 是精确的，不需要任何近似。\n\n**B. 不正确。** 该选项错误地声称 LNA 假设了高斯状态分布。LNA 是一个关于 $\\Omega^{-1/2}$ 幂次的系统性展开。高斯过程是作为涨落的主导阶近似而出现的，但这是一个结果，而不是关于状态变量 $X$ 的初始假设。更重要的是，对于非线性系统，LNA 不等同于高斯封闭。从高斯封闭推导出的动力学与 LNA 的动力学不同。例如，对于平均浓度 $\\phi = \\mu/\\Omega$，高斯封闭的动力学将是 $\\frac{d\\phi}{dt} = k_1 - k_2(\\Sigma_c + \\phi^2 - \\phi/\\Omega)$，它依赖于方差 $\\Sigma_c$，并且不同于 LNA 的确定性均值动力学 $\\frac{d\\phi}{dt} = k_1-k_2\\phi^2$。\n\n**C. 不正确。** 该陈述声称偏差仅源于扩散项。这是错误的。协方差动力学的漂移贡献，由 $J_c\\Sigma_c + \\Sigma_c J_c^T$ 给出，也不同。在 LNA 中，雅可比矩阵 $J_c$ 是沿着确定性轨迹 $\\phi(t)$ 计算的。在 MCAs 中，所得协方差方程中的漂移项是一个更复杂的函数，它依赖于均值和协方差的耦合演化。例如，在高斯封闭的情况下，有效的“雅可比矩阵”将依赖于矩本身，而不仅仅是一个预先计算的确定性路径。因此，两种近似方案之间的漂移和扩散贡献都不同。\n\n**D. 不正确。** 虽然在系统尺寸趋于无穷大（$\\Omega \\to \\infty$）的极限下，有效的 MCAs 和 LNA 通常会收敛到相同的结果，但第二个论断是错误的。它声称对于有限尺寸，MCAs “无论参数值如何，都必然高估相对于 LNA 的协方差”。这是一个过于强烈且不正确的概括。矩封闭的性能高度依赖于系统和参数。对于某些系统和参数区域，高斯封闭已知是不稳定的，甚至可以预测出非物理的负方差。它也可能低估真实方差。没有普遍的规则表明 MCAs 总是比 LNA 高估方差。\n\n总之，选项 A 提供了关于 LNA 和矩封闭近似应用于该系统时基本差异的最准确和全面的解释。偏差的产生是因为它们是不同的近似方案，以根本不同的方式处理不封闭的矩阶层：LNA 通过线性化随机过程，而 MCA 通过在精确矩方程中直接近似高阶矩。", "answer": "$$\\boxed{A}$$", "id": "3323813"}, {"introduction": "基于前一个练习建立的理论区别，这最后一个练习将进行一次亲手的数值比较。我们将使用一个更真实的基因调控模型，该模型包含非线性的Hill动力学。这个编码练习[@problem_id:3323804]要求你实现$LNA$以及两种流行的矩闭合方案（正态和对数正态），以计算系统的稳态方差，从而让你对这些近似方法在非线性系统中的表现有一致性的具体感受。", "problem": "考虑一个具有 Hill 型自激活和基础合成的单物种生长-死亡反应系统，这在计算系统生物学中通常被用作一个最小基因调控网络基序。令 $x(t)$ 表示该物种的拷贝数（或浓度）。反应倾向为\n$$\na_1(x) = k_0 + k_s \\, h(x), \\quad a_2(x) = k_d \\, x,\n$$\n其中 $k_0 \\ge 0$ 是基础合成速率，$k_s > 0$ 是最大激活强度，$k_d > 0$ 是一阶降解速率，$h(x)$ 是 Hill 激活函数，\n$$\nh(x) = \\frac{x^n}{K^n + x^n},\n$$\n其中 Hill 系数 $n \\in \\{1,2,3,\\dots\\}$，半激活常数 $K>0$。相应的宏观确定性动力学由以下常微分方程给出\n$$\n\\frac{d m}{d t} = f(m) = k_0 + k_s \\, h(m) - k_d \\, m,\n$$\n其稳定稳态 $m^\\star$ 满足 $f(m^\\star)=0$。假设采用通过系统大小展开从化学主方程 (CME) 推导出的线性噪声近似 (LNA)，其中围绕 $m(t)$ 的涨落 $\\eta(t)=x(t)-m(t)$ 服从一个线性化的朗之万方程，其雅可比矩阵为 $J = f'(m^\\star)$，扩散标量为 $D = \\sum_r \\nu_r^2 \\, a_r(m^\\star)$，其中 $\\nu_r$ 是化学计量变化。对于这个一维生长-死亡系统，有 $\\nu_1 = +1$，$\\nu_2 = -1$，因此 $D = a_1(m^\\star)+a_2(m^\\star)$。稳态协方差（方差）$C_{\\text{LNA}}$ 解以下连续时间代数李雅普诺夫方程\n$$\nJ \\, C_{\\text{LNA}} + C_{\\text{LNA}} \\, J^\\top + D = 0,\n$$\n在一维情况下，该方程简化为\n$$\n2 J \\, C_{\\text{LNA}} + D = 0.\n$$\n\n矩闭合近似旨在通过将高阶矩近似为低阶矩的函数，来封闭 CME 矩方程的无限层级。在稳态下，精确方差 $V=\\mathrm{Var}[x]$ 满足\n$$\n0 = \\frac{d V}{d t} = 2 \\, \\mathrm{Cov}(x, f(x)) + \\mathbb{E}[a_1(x) + a_2(x)],\n$$\n其中 $f(x) = a_1(x) - a_2(x)$。两种经典的闭合方法是：\n\n- 正态闭合：将 $x$ 视为近似高斯分布，并在 $m^\\star$ 周围用二阶泰勒展开来近似平滑函数 $g(x)$。到主导阶，这得到\n$$\n\\mathbb{E}[g(x)] \\approx g(m^\\star) + \\tfrac{1}{2} g''(m^\\star) V, \\quad \\mathrm{Cov}(x, g(x)) \\approx V \\, g'(m^\\star).\n$$\n\n- 对数正态闭合：将 $x$ 视为近似对数正态分布。记 $x = \\exp(y)$，其中 $y \\sim \\mathcal{N}(\\mu, \\sigma^2)$，使得\n$$\nm^\\star = \\exp\\!\\big(\\mu + \\tfrac{1}{2}\\sigma^2\\big), \\quad V = \\big(\\exp(\\sigma^2)-1\\big)\\exp\\!\\big(2\\mu + \\sigma^2\\big).\n$$\n反解可得\n$$\n\\sigma^2 = \\ln\\!\\Big(1 + \\frac{V}{(m^\\star)^2}\\Big), \\quad \\mu = \\ln m^\\star - \\tfrac{1}{2}\\sigma^2.\n$$\n对于 Hill 激活函数，定义 $z = n y - n \\ln K$，因此 $h(x) = \\big(1 + \\exp(-z)\\big)^{-1}$。期望 $\\mathbb{E}[h(x)] = \\mathbb{E}[\\sigma(z)]$（其中 $\\sigma(z)=\\big(1+\\exp(-z)\\big)^{-1}$）在 $z \\sim \\mathcal{N}(\\mu_z,\\sigma_z^2)$（其中 $\\mu_z = n \\mu - n \\ln K$ 且 $\\sigma_z^2 = n^2 \\sigma^2$）的情况下没有闭合形式的解。一个经过充分检验的近似是\n$$\n\\mathbb{E}[\\sigma(z)] \\approx \\sigma\\!\\Big( \\frac{\\mu_z}{\\sqrt{1 + \\tfrac{\\pi}{8}\\sigma_z^2}} \\Big).\n$$\n对于小涨落，保留上述的 $\\mathrm{Cov}(x,f(x)) \\approx V f'(m^\\star)$。\n\n任务：\n\n- 从上述定义出发，并且不使用任何预先指定的简化公式，推导出计算以下各项所需的表达式：\n  - 求解 $k_0 + k_s h(m^\\star) - k_d m^\\star = 0$ 得到的确定性稳态 $m^\\star$。\n  - 雅可比矩阵 $J = f'(m^\\star) = k_s h'(m^\\star) - k_d$，其中\n    $$\n    h'(x) = \\frac{n K^n x^{n-1}}{(K^n + x^n)^2}, \\quad\n    h''(x) = n K^n \\Big( \\frac{(n-1) x^{n-2}}{(K^n + x^n)^2} - \\frac{2 n x^{2n-2}}{(K^n + x^n)^3} \\Big).\n    $$\n  - LNA 方差 $C_{\\text{LNA}}$，通过求解 $2 J C_{\\text{LNA}} + D = 0$ 得到，其中 $D = a_1(m^\\star)+a_2(m^\\star)$。\n  - 正态闭合稳态方差 $V_{\\text{N}}$，通过求解\n    $$\n    0 = 2 V_{\\text{N}} f'(m^\\star) + \\Big(k_0 + k_s \\big(h(m^\\star) + \\tfrac{1}{2} h''(m^\\star) V_{\\text{N}}\\big)\\Big) + k_d m^\\star.\n    $$\n  - 对数正态闭合稳态方差 $V_{\\text{LN}}$，通过求解\n    $$\n    0 = 2 V_{\\text{LN}} f'(m^\\star) + \\Big(k_0 + k_s \\, \\mathbb{E}[h(x)]_{\\text{LN}}(m^\\star,V_{\\text{LN}})\\Big) + k_d m^\\star,\n    $$\n    得到，其中 $\\mathbb{E}[h(x)]_{\\text{LN}}(m^\\star,V)$ 是通过上述 logistic-正态近似，使用与 $(m^\\star,V)$ 一致的 $(\\mu,\\sigma^2)$ 得到的。\n\n- 对于每种闭合方法，将与线性噪声近似的偏差定义为绝对相对误差\n$$\n\\delta_{\\text{N}} = \\frac{|V_{\\text{N}} - C_{\\text{LNA}}|}{C_{\\text{LNA}}}, \\quad\n\\delta_{\\text{LN}} = \\frac{|V_{\\text{LN}} - C_{\\text{LNA}}|}{C_{\\text{LNA}}}.\n$$\n\n实现一个程序，对于以下参数集 $(k_0, k_s, k_d, K, n)$ 的测试套件：\n\n- 案例 1：$(5.0, 50.0, 1.0, 200.0, 1)$\n- 案例 2：$(2.0, 20.0, 1.5, 10.0, 2)$\n- 案例 3：$(1.0, 60.0, 3.0, 20.0, 4)$\n- 案例 4：$(20.0, 100.0, 5.0, 15.0, 3)$\n\n必须为每个案例执行以下所有操作：\n- 计算 $m^\\star$（选择稳定的正稳态）。\n- 计算 $C_{\\text{LNA}}$。\n- 使用上述定义的闭合方法计算 $V_{\\text{N}}$ 和 $V_{\\text{LN}}$。\n- 计算 $\\delta_{\\text{N}}$ 和 $\\delta_{\\text{LN}}$。\n\n数值要求和约束：\n- 将所有量视为无量纲。\n- 在求解标量方程时，使用绝对容差 $\\le 10^{-10}$ 的确定性数值方法。\n- 确保 $J  0$ 以获得稳定的 LNA；如果某个案例恰好违反了稳定性，请使用计算出的值报告偏差，但请注意，这种情况在 LNA 意义上是非物理的。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个方括号内的逗号分隔列表，该列表按顺序汇总了所有案例的偏差，格式如下\n$$\n[\\delta_{\\text{N}}^{(1)}, \\delta_{\\text{LN}}^{(1)}, \\delta_{\\text{N}}^{(2)}, \\delta_{\\text{LN}}^{(2)}, \\delta_{\\text{N}}^{(3)}, \\delta_{\\text{LN}}^{(3)}, \\delta_{\\text{N}}^{(4)}, \\delta_{\\text{LN}}^{(4)}].\n$$\n不应打印任何额外文本。", "solution": "该问题被评估为有效。它在科学上基于随机化学动力学的标准理论，特别是关于基因调控网络基序的线性噪声近似 (LNA) 和矩闭合近似。该问题是适定的，提供了所有必要的参数、方程和定义。关于在潜在双稳态区域中选择稳态的一个轻微模糊之处，通过采纳一个常规且明确说明的假设得以解决。\n\n任务是计算在三种不同近似（LNA、正态闭合、对数正态闭合）下单物种浓度的稳态方差，并量化矩闭合结果与 LNA 基准之间的偏差。这需要对给定的一组参数进行多步数值计算。\n\n### 步骤 1：确定性稳态 ($m^\\star$)\n\n物种的宏观浓度 $m(t)$ 根据常微分方程 (ODE) 演化：\n$$\n\\frac{d m}{d t} = f(m) = k_0 + k_s \\, h(m) - k_d \\, m\n$$\n其中 $h(m) = \\frac{m^n}{K^n + m^n}$。稳态 $m^\\star$ 是非线性代数方程 $f(m^\\star)=0$ 的正实根。\n$$\nk_0 + k_s \\frac{(m^\\star)^n}{K^n + (m^\\star)^n} - k_d m^\\star = 0\n$$\n该方程可能有多个正解，对应于单稳态或多稳态（例如，双稳态）系统。如果雅可比矩阵 $J = f'(m^\\star)$ 为负，则稳态是稳定的。雅可比矩阵由下式给出：\n$$\nJ = f'(m) = k_s \\, h'(m) - k_d\n$$\n对于具有多个稳定稳态（双稳态）的情况，问题陈述“选择稳定的正稳态”是模糊的。我们将采用通常的惯例，即选择浓度最大的稳定稳态，通常称为“高”态或“激活”态。为找到此状态，我们将数值求解 $f(m)=0$ 的所有正根，在每个根处评估雅可比矩阵，并选择使 $J  0$ 的最大根。\n\n### 步骤 2：线性噪声近似 (LNA) 方差 ($C_{\\text{LNA}}$)\n\nLNA 为确定性轨迹周围的涨落提供了高斯近似。在稳态下，方差 $C_{\\text{LNA}}$ 由代数李雅普诺夫方程的解给出：\n$$\n2 J \\, C_{\\text{LNA}} + D = 0\n$$\n其中 $J = f'(m^\\star)$ 是雅可比矩阵，$D = a_1(m^\\star) + a_2(m^\\star)$ 是在稳态下评估的扩散项。\n可以使用稳态条件 $f(m^\\star) = a_1(m^\\star) - a_2(m^\\star) = 0$ 来简化扩散项，这意味着 $a_1(m^\\star) = a_2(m^\\star)$。\n因此，$D = a_2(m^\\star) + a_2(m^\\star) = 2 a_2(m^\\star) = 2 k_d m^\\star$。\n求解 $C_{\\text{LNA}}$ 可得：\n$$\nC_{\\text{LNA}} = -\\frac{D}{2J} = -\\frac{2 k_d m^\\star}{2 (k_s h'(m^\\star) - k_d)} = \\frac{k_d m^\\star}{k_d - k_s h'(m^\\star)}\n$$\n导数 $h'(m^\\star)$ 使用提供的公式计算：$h'(x) = \\frac{n K^n x^{n-1}}{(K^n + x^n)^2}$。\n\n### 步骤 3：正态闭合方差 ($V_{\\text{N}}$)\n\n正态闭合通过求解以下方程来近似稳态方差 $V_{\\text{N}}$：\n$$\n0 = 2 V_{\\text{N}} f'(m^\\star) + \\left(k_0 + k_s \\left(h(m^\\star) + \\frac{1}{2} h''(m^\\star) V_{\\text{N}}\\right)\\right) + k_d m^\\star\n$$\n我们可以重新整理此方程以求解 $V_{\\text{N}}$。首先，将包含 $V_{\\text{N}}$ 的项组合在一起：\n$$\nV_{\\text{N}} \\left( 2 f'(m^\\star) + \\frac{1}{2} k_s h''(m^\\star) \\right) = - \\left( (k_0 + k_s h(m^\\star)) + k_d m^\\star \\right)\n$$\n使用稳态条件 $k_0 + k_s h(m^\\star) = k_d m^\\star$，等式右边简化为 $-(k_d m^\\star + k_d m^\\star) = -2 k_d m^\\star$。\n这给出了 $V_{\\text{N}}$ 关于 $m^\\star$ 及其导数的直接解析表达式：\n$$\nV_{\\text{N}} = \\frac{-2 k_d m^\\star}{2 f'(m^\\star) + \\frac{1}{2} k_s h''(m^\\star)}\n$$\n二阶导数 $h''(m^\\star)$ 使用提供的公式计算：$h''(x) = n K^n \\left( \\frac{(n-1) x^{n-2}}{(K^n + x^n)^2} - \\frac{2 n x^{2n-2}}{(K^n + x^n)^3} \\right)$。\n\n### 步骤 4：对数正态闭合方差 ($V_{\\text{LN}}$)\n\n对数正态闭合通过求解以下方程来近似稳态方差 $V_{\\text{LN}}$：\n$$\n0 = 2 V_{\\text{LN}} f'(m^\\star) + \\left(k_0 + k_s \\, \\mathbb{E}[h(x)]_{\\text{LN}}(m^\\star,V_{\\text{LN}})\\right) + k_d m^\\star\n$$\n再次使用稳态条件 $k_0 = k_d m^\\star - k_s h(m^\\star)$，我们可以将其重写为关于 $V_{\\text{LN}}$ 的非线性求根问题：\n$$\nF(V_{\\text{LN}}) = 2 V_{\\text{LN}} f'(m^\\star) + 2 k_d m^\\star + k_s \\left( \\mathbb{E}[h(x)]_{\\text{LN}}(m^\\star,V_{\\text{LN}}) - h(m^\\star) \\right) = 0\n$$\n项 $\\mathbb{E}[h(x)]_{\\text{LN}}(m^\\star,V)$ 是均值 $m^\\star$ 和方差 $V$ 的函数。其计算涉及以下步骤：\n1.  根据均值 $m^\\star$ 和方差 $V$，找到 $y = \\ln x$ 的底层正态分布的参数 $(\\mu, \\sigma^2)$：\n    $$\n    \\sigma^2 = \\ln\\left(1 + \\frac{V}{(m^\\star)^2}\\right), \\quad \\mu = \\ln m^\\star - \\frac{1}{2}\\sigma^2\n    $$\n2.  定义变换后的变量 $z = n y - n \\ln K$。它服从均值为 $\\mu_z = n \\mu - n \\ln K$、方差为 $\\sigma_z^2 = n^2 \\sigma^2$ 的正态分布。\n3.  Hill 函数 $h(x) = \\sigma(z) = (1+e^{-z})^{-1}$ 的期望近似为：\n    $$\n    \\mathbb{E}[h(x)]_{\\text{LN}} \\approx \\sigma\\left( \\frac{\\mu_z}{\\sqrt{1 + \\frac{\\pi}{8}\\sigma_z^2}} \\right)\n    $$\n这个非线性方程 $F(V_{\\text{LN}})=0$ 必须通过数值方法求解 $V_{\\text{LN}} > 0$。我们将使用一个数值求根算法，并以 $C_{\\text{LNA}}$ 作为初始猜测值。\n\n### 步骤 5：偏差计算\n\n对于每个参数集，在计算完 $m^\\star$、$C_{\\text{LNA}}$、$V_{\\text{N}}$ 和 $V_{\\text{LN}}$ 后，与 LNA 的绝对相对偏差计算如下：\n$$\n\\delta_{\\text{N}} = \\frac{|V_{\\text{N}} - C_{\\text{LNA}}|}{C_{\\text{LNA}}}, \\quad \\delta_{\\text{LN}} = \\frac{|V_{\\text{LN}} - C_{\\text{LNA}}|}{C_{\\text{LNA}}}\n$$\n\n这些步骤在 Python 代码中实现，该代码循环遍历每个测试案例，以高精度执行计算，并按规定格式化最终结果。", "answer": "[2.730335028468307e-12,2.618335055005822e-12,0.005537576575971408,0.0033800661148800263,0.02257929457858607,0.010660424564560706,0.04300305146039572,0.012759902630598818]", "id": "3323804"}]}