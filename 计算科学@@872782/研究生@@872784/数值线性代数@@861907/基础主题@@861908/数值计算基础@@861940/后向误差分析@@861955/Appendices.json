{"hands_on_practices": [{"introduction": "为了开始我们的实践探索，我们将分析一个简单但极具启发性的案例。该练习 [@problem_id:3533480] 考察了一个参数化的 $2 \\times 2$ 矩阵，该矩阵会变得越来越病态。通过直接应用后向误差和条件数的定义，你将推导出它们之间的关系，并亲眼看到巨大的条件数如何将微小的后向误差放大为巨大的前向误差，为后向误差分析的核心原则提供一个坚实的具体基础。", "problem": "设 $A(\\epsilon) \\in \\mathbb{R}^{2 \\times 2}$ 是一个参数化矩阵族\n$$\nA(\\epsilon) \\;=\\; \\begin{pmatrix} 1  1 \\\\ 1  1+\\epsilon \\end{pmatrix}, \\qquad \\epsilon \\in (0,1),\n$$\n并设向量 $x \\in \\mathbb{R}^{2}$ 为 $x = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。定义 $b(\\epsilon) := A(\\epsilon)\\,x = \\begin{pmatrix} 2 \\\\ 2+\\epsilon \\end{pmatrix}$。计算在单位舍入误差为 $u$ 的浮点运算中进行，并且我们全程使用矩阵和向量的 $\\infty$-范数。假设带部分主元的高斯消元法 (GEPP) 对该矩阵族是范数意义下后向稳定的，其含义如下：计算出的解 $\\hat{x}$ 满足\n$$\n\\bigl(A(\\epsilon) + \\Delta A\\bigr)\\,\\hat{x} \\;=\\; b(\\epsilon), \\qquad \\|\\Delta A\\|_{\\infty} \\;\\le\\; c\\,u\\,\\|A(\\epsilon)\\|_{\\infty},\n$$\n其中 $c$ 是某个独立于 $\\epsilon$ 和 $u$ 的绝对常数。\n\n仅从范数意义下的后向稳定性、范数意义下的条件数以及一阶扰动分析的定义出发，完成以下任务：\n\n1) 显式计算 $\\|A(\\epsilon)\\|_{\\infty}$、$A(\\epsilon)^{-1}$ 和 $\\|A(\\epsilon)^{-1}\\|_{\\infty}$，并由此确定条件数 $\\kappa_{\\infty}\\!\\bigl(A(\\epsilon)\\bigr) = \\|A(\\epsilon)\\|_{\\infty}\\,\\|A(\\epsilon)^{-1}\\|_{\\infty}$ 作为 $\\epsilon$ 的显式函数。\n\n2) 使用定义 $\\hat{x}$ 的方程和精确解 $x$，推导前向误差 $\\|x - \\hat{x}\\|_{\\infty}$ 的一阶（关于 $u$）范数意义下的扰动界，该界用 $\\|A(\\epsilon)\\|_{\\infty}$、$\\|A(\\epsilon)^{-1}\\|_{\\infty}$、$\\|x\\|_{\\infty}$ 和 $u$ 表示。然后，将此界应用于当前数据，以获得当 $\\epsilon \\to 0$ 且 $u \\to 0$ (其中 $u \\ll \\epsilon$) 时的领阶渐近表达式。您可以假设在此区域内，确保相关诺伊曼级数收敛的小量条件是满足的。\n\n将 $\\|x - \\hat{x}\\|_{\\infty}$ 在 $\\epsilon \\to 0$ 且 $u \\to 0$ (其中 $u \\ll \\epsilon$) 时简化得到的领阶项，作为一个单一的封闭形式表达式作为您的最终答案报告。无需舍入。将最终答案表示为无单位的解析表达式。", "solution": "该问题在数值线性代数领域内是适定的且有科学依据的。我们将首先计算所需的矩阵范数和条件数，然后推导前向误差界及其领阶渐近行为。\n\n该矩阵族由 $A(\\epsilon) = \\begin{pmatrix} 1  1 \\\\ 1  1+\\epsilon \\end{pmatrix}$ 给出，其中 $\\epsilon \\in (0,1)$。\n\n第 1 部分：计算范数和条件数。\n\n首先，我们计算 $A(\\epsilon)$ 的 $\\infty$-范数。矩阵的 $\\infty$-范数定义为最大绝对行和。\n第一行的绝对和为 $|1| + |1| = 2$。\n第二行的绝对和为 $|1| + |1+\\epsilon|$。由于 $\\epsilon \\in (0,1)$，$1+\\epsilon$ 为正数，因此和为 $1 + 1+\\epsilon = 2+\\epsilon$。\n范数是这两个值的最大值：\n$$\n\\|A(\\epsilon)\\|_{\\infty} \\;=\\; \\max(2, 2+\\epsilon) \\;=\\; 2+\\epsilon\n$$\n\n接下来，我们计算 $A(\\epsilon)$ 的逆矩阵。对于一个 $2 \\times 2$ 矩阵 $\\begin{pmatrix} a  b \\\\ c  d \\end{pmatrix}$，其逆为 $\\frac{1}{ad-bc} \\begin{pmatrix} d  -b \\\\ -c  a \\end{pmatrix}$。\n$A(\\epsilon)$ 的行列式为 $\\det(A(\\epsilon)) = (1)(1+\\epsilon) - (1)(1) = 1+\\epsilon-1 = \\epsilon$。\n由于 $\\epsilon \\in (0,1)$，$\\det(A(\\epsilon)) \\neq 0$，因此逆矩阵存在。\n$$\nA(\\epsilon)^{-1} \\;=\\; \\frac{1}{\\epsilon} \\begin{pmatrix} 1+\\epsilon  -1 \\\\ -1  1 \\end{pmatrix} \\;=\\; \\begin{pmatrix} \\frac{1+\\epsilon}{\\epsilon}  -\\frac{1}{\\epsilon} \\\\ -\\frac{1}{\\epsilon}  \\frac{1}{\\epsilon} \\end{pmatrix}\n$$\n\n现在，我们计算 $A(\\epsilon)^{-1}$ 的 $\\infty$-范数。\n第一行的绝对和为 $|\\frac{1+\\epsilon}{\\epsilon}| + |-\\frac{1}{\\epsilon}| = \\frac{1+\\epsilon}{\\epsilon} + \\frac{1}{\\epsilon} = \\frac{2+\\epsilon}{\\epsilon}$，因为 $\\epsilon > 0$。\n第二行的绝对和为 $|-\\frac{1}{\\epsilon}| + |\\frac{1}{\\epsilon}| = \\frac{1}{\\epsilon} + \\frac{1}{\\epsilon} = \\frac{2}{\\epsilon}$。\n范数是这两个值的最大值。因为 $\\epsilon>0$，我们有 $\\frac{2+\\epsilon}{\\epsilon} > \\frac{2}{\\epsilon}$。\n$$\n\\|A(\\epsilon)^{-1}\\|_{\\infty} \\;=\\; \\max\\left(\\frac{2+\\epsilon}{\\epsilon}, \\frac{2}{\\epsilon}\\right) \\;=\\; \\frac{2+\\epsilon}{\\epsilon}\n$$\n\n最后，我们计算 $\\infty$-范数条件数 $\\kappa_{\\infty}(A(\\epsilon))$，它定义为矩阵范数与其逆矩阵范数的乘积。\n$$\n\\kappa_{\\infty}(A(\\epsilon)) \\;=\\; \\|A(\\epsilon)\\|_{\\infty} \\|A(\\epsilon)^{-1}\\|_{\\infty} \\;=\\; (2+\\epsilon) \\left(\\frac{2+\\epsilon}{\\epsilon}\\right) \\;=\\; \\frac{(2+\\epsilon)^2}{\\epsilon}\n$$\n这就完成了问题的第一部分。\n\n第 2 部分：推导前向误差界及其渐近分析。\n\n我们已知精确关系式 $A(\\epsilon)x = b(\\epsilon)$ 和后向稳定计算的结果 $(A(\\epsilon) + \\Delta A)\\hat{x} = b(\\epsilon)$。我们可以令这两个关于 $b(\\epsilon)$ 的表达式相等：\n$$\n(A(\\epsilon) + \\Delta A)\\hat{x} \\;=\\; A(\\epsilon)x\n$$\n展开左边并重新整理各项可得：\n$$\nA(\\epsilon)\\hat{x} + \\Delta A \\hat{x} \\;=\\; A(\\epsilon)x\n$$\n$$\nA(\\epsilon)\\hat{x} - A(\\epsilon)x \\;=\\; -\\Delta A \\hat{x}\n$$\n$$\nA(\\epsilon)(\\hat{x} - x) \\;=\\; -\\Delta A \\hat{x}\n$$\n由于 $A(\\epsilon)$ 是可逆的，我们可以从左边乘以 $A(\\epsilon)^{-1}$：\n$$\n\\hat{x} - x \\;=\\; -A(\\epsilon)^{-1} \\Delta A \\hat{x}\n$$\n这将前向误差向量 $x - \\hat{x} = A(\\epsilon)^{-1} \\Delta A \\hat{x}$ 与后向误差扰动 $\\Delta A$ 联系起来。对两边取 $\\infty$-范数并使用范数的次乘性质，得到：\n$$\n\\|x - \\hat{x}\\|_{\\infty} \\;=\\; \\|A(\\epsilon)^{-1} \\Delta A \\hat{x}\\|_{\\infty} \\;\\le\\; \\|A(\\epsilon)^{-1}\\|_{\\infty} \\|\\Delta A\\|_{\\infty} \\|\\hat{x}\\|_{\\infty}\n$$\n我们已知范数意义下的后向稳定性条件 $\\|\\Delta A\\|_{\\infty} \\le c\\,u\\,\\|A(\\epsilon)\\|_{\\infty}$。将其代入不等式可得：\n$$\n\\|x - \\hat{x}\\|_{\\infty} \\;\\le\\; \\|A(\\epsilon)^{-1}\\|_{\\infty} (c\\,u\\,\\|A(\\epsilon)\\|_{\\infty}) \\|\\hat{x}\\|_{\\infty} \\;=\\; c\\,u\\,\\kappa_{\\infty}(A(\\epsilon)) \\|\\hat{x}\\|_{\\infty}\n$$\n为得到一个关于 $u$ 的一阶界，我们认识到 $\\hat{x}$ 是 $x$ 的一个扰动，即 $\\hat{x} = x + O(u)$。在已经为 $O(u)$ 阶的右侧，我们可以用 $\\|x\\|_{\\infty}$ 替换 $\\|\\hat{x}\\|_{\\infty}$。由此替换产生的误差 $c\\,u\\,\\kappa_{\\infty}(A(\\epsilon))(\\|\\hat{x}\\|_{\\infty} - \\|x\\|_{\\infty})$ 是 $O(u^2)$ 阶的，在一阶分析中可以忽略。问题中关于相关诺伊曼级数收敛的小量条件得到满足的假设确保了此线性近似的有效性。\n因此，一阶前向误差界为：\n$$\n\\|x - \\hat{x}\\|_{\\infty} \\;\\le\\; c\\,u\\,\\kappa_{\\infty}(A(\\epsilon)) \\|x\\|_{\\infty}\n$$\n现在，我们使用题目给出的数据和第 1 部分的结果来具体化这个界。\n向量 $x$ 已知为 $x = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$，所以其 $\\infty$-范数为 $\\|x\\|_{\\infty} = \\max(|1|, |1|) = 1$。\n代入 $\\kappa_{\\infty}(A(\\epsilon))$ 和 $\\|x\\|_{\\infty}$ 的表达式：\n$$\n\\|x - \\hat{x}\\|_{\\infty} \\;\\le\\; c\\,u\\,\\frac{(2+\\epsilon)^2}{\\epsilon} \\cdot 1 \\;=\\; c\\,u\\,\\frac{(2+\\epsilon)^2}{\\epsilon}\n$$\n问题要求当 $\\epsilon \\to 0$ 且 $u \\to 0$ (其中 $u \\ll \\epsilon$) 时 $\\|x - \\hat{x}\\|_{\\infty}$ 的领阶渐近表达式。这可以解释为寻找该误差界的领阶项。我们分析当 $\\epsilon \\to 0$ 时该界的行为：\n$$\nc\\,u\\,\\frac{(2+\\epsilon)^2}{\\epsilon} \\;=\\; c\\,u\\,\\frac{4 + 4\\epsilon + \\epsilon^2}{\\epsilon} \\;=\\; c\\,u\\,\\left(\\frac{4}{\\epsilon} + 4 + \\epsilon\\right)\n$$\n当 $\\epsilon \\to 0$ 时，项 $\\frac{4}{\\epsilon}$ 在括号中的其他项 $4$ 和 $\\epsilon$ 中占主导地位。因此，领阶项是包含因子 $\\frac{1}{\\epsilon}$ 的那项。\n前向误差界的领阶渐近表达式为：\n$$\n\\frac{4cu}{\\epsilon}\n$$\n该表达式表示在 $\\epsilon$ 和 $u$ 很小时前向误差的量级。条件 $u \\ll \\epsilon$（意为 $u/\\epsilon \\to 0$）确保了因子 $c\\,u\\,\\kappa_{\\infty}(A(\\epsilon)) \\approx 4cu/\\epsilon$ 是一个小数，这为一阶扰动分析提供了依据。假设此界在常数因子 $c$ 的意义下是紧的，那么这就是所求的误差 $\\|x - \\hat{x}\\|_{\\infty}$ 的领阶项。", "answer": "$$\n\\boxed{\\frac{4cu}{\\epsilon}}\n$$", "id": "3533480"}, {"introduction": "在理解条件数如何影响前向误差的基础上，我们现在从分析转向设计。该练习 [@problem_id:3533519] 挑战你为线性系统求解器构建“对抗性”输入。通过策略性地将输入向量和误差扰动与矩阵的奇异向量对齐，你将学会如何使理论误差界达到饱和，从而对数值计算中的“最坏情况”构成要素获得更深刻、更结构化的理解。", "problem": "考虑在电气和电子工程师协会 (IEEE) 754 浮点算术模型下，使用后向稳定方法求解线性系统 $A x = b$，其中 $A \\in \\mathbb{R}^{n \\times n}$ 是非奇异矩阵，$b \\in \\mathbb{R}^{n}$。后向稳定性意味着计算出的解 $\\hat{x}$ 是一个邻近问题 $(A + \\Delta A)\\hat{x} = b$ 的精确解，并满足范数界 $\\|\\Delta A\\|_{2} \\leq \\eta \\|A\\|_{2}$，其中 $\\eta$ 是一个小的非负参数，用于建模可达到的后向误差（例如，对于机器精度 $\\epsilon_{\\mathrm{mach}}$，其数量级为 $n \\,\\epsilon_{\\mathrm{mach}}$）。设 2-范数条件数定义为 $\\kappa_{2}(A) = \\|A\\|_{2}\\,\\|A^{-1}\\|_{2}$。\n\n从第一性原理出发，使用后向误差分析来构造对抗性的浮点输入：对于某个 $n \\geq 2$，找到一个具体的对 $(A,b)$，使得范数相对前向误差 $\\|\\hat{x}-x\\|_{2}/\\|x\\|_{2}$ 渐近地达到极端条件所允许的最大值，尽管该方法是后向稳定的。然后，通过找出在后向误差约束下使前向误差最大化的 $b$ 与 $A$ 的奇异向量之间的对齐关系来刻画最坏情况，并推导出在固定的 $\\|A\\|_{2}=1$ 和固定条件数 $\\kappa_{2}(A)=\\kappa$ 的所有对 $(A,b)$ 上，范数相对前向误差的上确界，假设 $0  \\kappa \\eta  1$。\n\n你的推导必须从后向误差和条件数的核心定义开始，并可使用关于奇异值和范数不等式的事实。在不调用任何现成的前向误差界的情况下，证明该对抗性构造和最坏情况刻画的合理性。最后，报告范数相对前向误差的上确界的闭式解析表达式（对 $\\eta$ 的所有阶都精确，而不仅仅是一阶），该表达式仅用 $\\kappa$ 和 $\\eta$ 表示。由于答案是符号形式，因此不需要进行舍入。", "solution": "我们从核心定义开始。后向稳定方法产生 $\\hat{x}$，满足 $(A + \\Delta A)\\hat{x} = b$ 且 $\\|\\Delta A\\|_{2} \\leq \\eta \\|A\\|_{2}$。精确解 $x$ 满足 $A x = b$。我们希望将前向误差 $\\hat{x} - x$ 与后向扰动 $\\Delta A$ 以及 $A$ 的条件数联系起来。\n\n代数上，\n$$\n\\hat{x} = (A + \\Delta A)^{-1} b = (A + \\Delta A)^{-1} A x = \\Big( (I + A^{-1}\\Delta A)^{-1} \\Big) x,\n$$\n所以\n$$\n\\hat{x} - x = \\Big( (I + A^{-1}\\Delta A)^{-1} - I \\Big) x.\n$$\n令 $E = A^{-1}\\Delta A$。则前向误差变换为\n$$\n\\hat{x} - x = \\big( (I + E)^{-1} - I \\big) x = (I + E)^{-1} E x.\n$$\n取 2-范数并使用次可乘性，\n$$\n\\frac{\\|\\hat{x} - x\\|_{2}}{\\|x\\|_{2}} \\leq \\|(I + E)^{-1}\\|_{2} \\cdot \\frac{\\|E x\\|_{2}}{\\|x\\|_{2}} \\leq \\|(I + E)^{-1}\\|_{2} \\cdot \\|E\\|_{2}.\n$$\n当 $\\|E\\|_{2}  1$ 时，预解式界给出\n$$\n\\|(I + E)^{-1}\\|_{2} \\leq \\frac{1}{1 - \\|E\\|_{2}}.\n$$\n结合起来，我们得到不等式\n$$\n\\frac{\\|\\hat{x} - x\\|_{2}}{\\|x\\|_{2}} \\leq \\frac{\\|E\\|_{2}}{1 - \\|E\\|_{2}}.\n$$\n现在，\n$$\n\\|E\\|_{2} = \\|A^{-1} \\Delta A\\|_{2} \\leq \\|A^{-1}\\|_{2} \\cdot \\|\\Delta A\\|_{2} \\leq \\|A^{-1}\\|_{2} \\cdot \\eta \\|A\\|_{2} = \\kappa_{2}(A)\\,\\eta.\n$$\n在约束 $\\|A\\|_{2} = 1$ 和 $\\kappa_{2}(A) = \\kappa$ 下，我们有 $\\|E\\|_{2} \\leq \\kappa \\eta$。因此，\n$$\n\\frac{\\|\\hat{x} - x\\|_{2}}{\\|x\\|_{2}} \\leq \\frac{\\kappa \\eta}{1 - \\kappa \\eta}.\n$$\n这是一个上界，但我们寻求构造一个对抗性输入 $(A,b)$，使得该界可以达到，从而刻画最坏情况。\n\n为此，我们利用奇异值结构。设 $A$ 的奇异值为 $\\sigma_{\\max} = \\|A\\|_{2}$ 和 $\\sigma_{\\min}$，对应的右奇异向量为 $v_{\\min}$，左奇异向量为 $u_{\\min}$。在约束 $\\|A\\|_{2} = 1$ 和 $\\kappa_{2}(A) = \\kappa$ 下，我们有 $\\sigma_{\\max} = 1$ 和 $\\sigma_{\\min} = 1/\\kappa$。如果我们选择的 $b$ 与右奇异向量 $v_{\\min}$ 对齐，使得 $x = A^{-1} b$ 也与 $v_{\\min}$ 对齐，那么解 $x$ 将主要位于 $A$ 最病态的方向上。\n\n具体地，取 $n = 2$ 并定义\n$$\nA = \\begin{pmatrix} 1  0 \\\\ 0  \\kappa^{-1} \\end{pmatrix},\n$$\n它满足 $\\|A\\|_{2} = 1$ 和 $\\kappa_{2}(A) = \\kappa$。选择\n$$\nb = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix},\n$$\n则精确解为\n$$\nx = A^{-1} b = \\begin{pmatrix} 1  0 \\\\ 0  \\kappa \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ \\kappa \\end{pmatrix},\n$$\n它与和 $\\sigma_{\\min} = \\kappa^{-1}$ 相关的右奇异向量对齐。\n\n接下来，我们构造一个与后向稳定性一致的扰动 $\\Delta A$，它在同一方向上最大程度地放大了前向误差。考虑秩一扰动\n$$\n\\Delta A = -\\eta\\, e_{2} e_{2}^{\\top},\n$$\n其中 $e_{2} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$。这个选择满足后向误差约束，因为\n$$\n\\|\\Delta A\\|_{2} = \\eta \\|e_{2} e_{2}^{\\top}\\|_{2} = \\eta \\quad \\text{且} \\quad \\|A\\|_{2} = 1 \\quad \\Rightarrow \\quad \\|\\Delta A\\|_{2} \\leq \\eta \\|A\\|_{2}.\n$$\n此外，\n$$\nE = A^{-1} \\Delta A = \\begin{pmatrix} 1  0 \\\\ 0  \\kappa \\end{pmatrix} \\cdot \\big( -\\eta\\, e_{2} e_{2}^{\\top} \\big) = -\\kappa \\eta\\, e_{2} e_{2}^{\\top},\n$$\n其谱范数为 $\\|E\\|_{2} = \\kappa \\eta$ 并且在 $e_{2}$ 方向上起到乘以标量 $-\\kappa \\eta$ 的作用。因此，\n$$\n(I + E)^{-1} = \\big( I - \\kappa \\eta\\, e_{2} e_{2}^{\\top} \\big)^{-1} = I + \\frac{\\kappa \\eta}{1 - \\kappa \\eta}\\, e_{2} e_{2}^{\\top},\n$$\n由此\n$$\n\\hat{x} = (I + E)^{-1} x = \\left( I + \\frac{\\kappa \\eta}{1 - \\kappa \\eta}\\, e_{2} e_{2}^{\\top} \\right) x = x + \\frac{\\kappa \\eta}{1 - \\kappa \\eta}\\, e_{2} e_{2}^{\\top} x.\n$$\n由于 $x$ 与 $e_{2}$ 成正比，我们得到精确的相对前向误差\n$$\n\\frac{\\|\\hat{x} - x\\|_{2}}{\\|x\\|_{2}} = \\frac{\\kappa \\eta}{1 - \\kappa \\eta}.\n$$\n等价地，这可以通过直接对扰动后的对角矩阵求逆看出：\n$$\nA + \\Delta A = \\begin{pmatrix} 1  0 \\\\ 0  \\kappa^{-1} - \\eta \\end{pmatrix}, \\quad \\hat{x} = (A + \\Delta A)^{-1} b = \\begin{pmatrix} 0 \\\\ \\dfrac{1}{\\kappa^{-1} - \\eta} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ \\dfrac{\\kappa}{1 - \\kappa \\eta} \\end{pmatrix},\n$$\n所以\n$$\n\\frac{\\|\\hat{x} - x\\|_{2}}{\\|x\\|_{2}} = \\frac{\\left\\| \\begin{pmatrix} 0 \\\\ \\dfrac{\\kappa}{1 - \\kappa \\eta} - \\kappa \\end{pmatrix} \\right\\|_{2}}{\\|\\begin{pmatrix} 0 \\\\ \\kappa \\end{pmatrix}\\|_{2}} = \\frac{\\kappa \\left( \\dfrac{1}{1 - \\kappa \\eta} - 1 \\right)}{\\kappa} = \\frac{\\kappa \\eta}{1 - \\kappa \\eta}.\n$$\n\n这个构造表明，对于一个显式的对抗性对 $(A,b)$，上界是可以达到的，并且极值情况是将 $b$ 与 $\\sigma_{\\min}(A)$ 相关的右奇异向量对齐，同时允许的扰动 $\\Delta A$ 在同一方向上作用，以在约束 $\\|\\Delta A\\|_{2} \\leq \\eta \\|A\\|_{2}$ 下最大化 $\\|E\\|_{2}$。因此，对于所有固定的 $\\|A\\|_{2} = 1$ 和 $\\kappa_{2}(A) = \\kappa$ 的对 $(A,b)$，在 $0  \\kappa \\eta  1$ 的条件下，范数相对前向误差的上确界是\n$$\n\\sup \\frac{\\|\\hat{x} - x\\|_{2}}{\\|x\\|_{2}} = \\frac{\\kappa \\eta}{1 - \\kappa \\eta}.\n$$\n这个表达式在对角对抗性构造中对 $\\eta$ 的所有阶都是精确的，并且与一般情况下从预解式不等式推导出的最坏情况界相匹配。", "answer": "$$\\boxed{\\frac{\\kappa \\eta}{1 - \\kappa \\eta}}$$", "id": "3533519"}, {"introduction": "我们之前的练习都假设数值算法是后向稳定的。在最后一个练习 [@problem_id:3533507] 中，我们将研究一个挑战该假设的情景：带部分主元的高斯消去法。你将分析一个经典的矩阵族，已知它会在消去过程中导致矩阵元素指数级增长，并计算所谓的“增长因子”。这个练习揭示了算法的内部行为如何导致巨大的后向误差，表明仅靠主元选择并不能保证稳定性，稳定性还关键地取决于输入矩阵的性质。", "problem": "考虑将部分主元高斯消去法 (GEPP) 应用于一类旨在表现出大元素增长的矩阵族。在标准的浮点 (FP) 算术模型下进行计算，其中对于任何基本运算，有 $\\operatorname{fl}(a \\,\\circ\\, b) = (a \\,\\circ\\, b)(1+\\delta)$，且 $|\\delta| \\le u$，其中 $u$ 是单位舍入误差。\n\n对于每个整数 $n \\ge 2$，定义矩阵 $A_n \\in \\mathbb{R}^{n \\times n}$，其元素 $a_{ij}$ 如下：\n- 对所有 $i \\in \\{1,\\dots,n\\}$，$a_{ii} = 1$\n- 对所有 $1 \\le i  j \\le n-1$，$a_{ij} = 0$\n- 对所有 $1 \\le i \\le n$，$a_{in} = 1$\n- 对所有 $1 \\le j  i \\le n$，$a_{ij} = -1$\n等价地，$A_n$ 是一个单位下三角矩阵，其所有严格下三角元素均为 $-1$，除了最后一列外，其对角线以上严格位置的元素均为零，且最后一列是全一向量。\n\n采用 GEPP 增长因子的常规定义，\n$$\n\\gamma(A_n) \\;=\\; \\frac{\\max_{k \\in \\{0,\\dots,n-1\\}} \\max_{i,j} \\left| a_{ij}^{(k)} \\right|}{\\max_{i,j} |a_{ij}|},\n$$\n其中 $a_{ij}^{(0)} = a_{ij}$ 是 $A_n$ 的元素，$a_{ij}^{(k)}$ 是 GEPP（在出现相同最大绝对值元素时，部分主元法选择列中第一次出现的元素）进行 $k$ 步消去后的矩阵元素。\n\n任务：\n1) 从上述定义和高斯消去法的机理出发，分析 $A_n$ 在部分主元法下的主元选择，并刻画消去乘子。然后，通过对步数索引 $k$ 进行归纳，确定在精确算术下消去过程中最后一列的演变，并推导出增长因子 $\\gamma(A_n)$ 的精确值。\n\n2) 使用第一性原理的后向误差分析，对在浮点算术下 GEPP 计算出的 $\\widehat{L}\\widehat{U}$ 因子，推导出一个形式为 $\\|\\Delta A\\|_{\\infty} \\le c \\, n \\, u \\, \\gamma(A_n) \\, \\|A_n\\|_{\\infty}$ 的上界，其中 $c$ 是一个与 $n$ 和 $u$ 无关的绝对常数，且 $(A_n + \\Delta A) = \\widehat{L}\\widehat{U}$。简要论证更新递推式中由于元素增长而出现因子 $\\gamma(A_n)$ 的原因。\n\n3) 证明矩阵族 $\\{A_n\\}$ 在以下精确意义上，基本上饱和了第 2 部分中得到的依赖于增长因子的后向误差界：存在一个右端项 $b \\in \\mathbb{R}^n$ 且 $\\|b\\|_{\\infty} = 1$，使得通过 $(\\widehat{L},\\widehat{U})$ 进行前向和后向代换计算出的解 $\\widehat{x}$ 满足范数后向误差\n$$\n\\eta_{\\infty}(\\widehat{x}) \\;\\equiv\\; \\min \\left\\{ \\frac{\\|\\Delta A\\|_{\\infty}}{\\|A_n\\|_{\\infty}} : (A_n + \\Delta A)\\widehat{x} = b \\right\\} \\;\\ge\\; c' \\, n \\, u \\, \\gamma(A_n),\n$$\n对于某个与 $n$ 和 $u$ 无关的绝对常数 $c'  0$。您的论证应依赖于最大的中间 $U$ 矩阵元素的大小及其舍入扰动。\n\n作为最终答案，提供增长因子 $\\gamma(A_n)$ 作为 $n$ 的函数的精确闭式表达式。不需要数值舍入，也不涉及物理单位。", "solution": "问题要求对特定矩阵族 $A_n$ 上的部分主元高斯消去法 (GEPP) 进行分析，包括计算增长因子、推导后向误差界，并证明该界是紧的。\n\n### 第 1 部分：GEPP 分析与增长因子 $\\gamma(A_n)$ 的计算\n\n我们首先在精确算术下分析 $A_n$ 的结构和 GEPP 过程。矩阵 $A_n \\in \\mathbb{R}^{n \\times n}$ 定义如下：\n- $a_{ii} = 1$，对于 $i \\in \\{1,\\dots,n\\}$\n- $a_{ij} = -1$，对于 $1 \\le j  i \\le n$\n- $a_{in} = 1$，对于 $1 \\le i \\le n$\n- $a_{ij} = 0$，对于 $1 \\le i  j \\le n-1$\n\n例如，对于 $n=4$：\n$$ A_4 = \\begin{pmatrix}\n1  0  0  1 \\\\\n-1  1  0  1 \\\\\n-1  -1  1  1 \\\\\n-1  -1  -1  1\n\\end{pmatrix} $$\n$A_n$ 中任意元素的最大绝对值为 $\\max_{i,j} |a_{ij}| = 1$。\n\n我们将追踪经过 $k$ 步消去后的矩阵元素 $a_{ij}^{(k)}$。令 $A^{(0)} = A_n$。\n\n**步骤 $k=1$**：\n第一列为 $(1, -1, -1, \\dots, -1)^T$。最大绝对值为 $1$。根据指定的决胜规则（选择第一次出现的元素），主元为 $a_{11}^{(0)} = 1$。不需要行置换。\n对于 $i \\in \\{2, \\dots, n\\}$，乘子为 $m_{i1} = a_{i1}^{(0)}/a_{11}^{(0)} = -1/1 = -1$。\n对于 $i,j \\ge 2$ 的子矩阵元素更新如下：\n$a_{ij}^{(1)} = a_{ij}^{(0)} - m_{i1} a_{1j}^{(0)} = a_{ij} + a_{1j}$。\n- 对于 $j \\in \\{2, \\dots, n-1\\}$，我们有 $a_{1j} = 0$，所以 $a_{ij}^{(1)} = a_{ij}$。\n- 对于 $j=n$，我们有 $a_{1n} = 1$，所以对于 $i \\in \\{2, \\dots, n\\}$，$a_{in}^{(1)} = a_{in} + a_{1n} = 1+1=2$。\n\n经过一步消去后，矩阵 $A_n^{(1)}$ 的形式为：\n$$ A_n^{(1)} = \\begin{pmatrix}\n1  0  \\dots  0  1 \\\\\n0            2 \\\\\n\\vdots    \\text{submatrix}      \\vdots \\\\\n0            2\n\\end{pmatrix} $$\n下一步的活动子矩阵 $A_{2:n, 2:n}^{(1)}$，其前 $n-2$ 列与 $A_{n-1}$ 具有相同的结构，但其最后一列完全由 $2$ 组成。\n\n**归纳步骤**：\n我们为 $k \\in \\{1, \\dots, n-1\\}$，在第 $k$ 步开始时（即在 $A_n^{(k-1)}$ 中）的活动子矩阵的结构建立一个归纳假设。\n假设：活动子矩阵 $A_{k:n, k:n}^{(k-1)}$ 的元素为：\n- $a_{ii}^{(k-1)} = 1$，对于 $i \\in \\{k, \\dots, n-1\\}$\n- $a_{ij}^{(k-1)} = -1$，对于 $k \\le j  i \\le n$\n- $a_{ij}^{(k-1)} = 0$，对于 $k \\le i  j \\le n-1$\n- $a_{in}^{(k-1)} = 2^{k-1}$，对于 $i \\in \\{k, \\dots, n\\}$\n\n**基本情况 ($k=1$)**：活动子矩阵是 $A_n$ 本身。假设在 $2^{1-1}=1$ 时成立。\n\n**归纳步骤**：假设该假设对步骤 $k$ 成立。活动子矩阵的主元列为 $(a_{kk}^{(k-1)}, \\dots, a_{nk}^{(k-1)})^T = (1, -1, \\dots, -1)^T$。主元元素为 $a_{kk}^{(k-1)}=1$。不需要行交换。\n对于 $i \\in \\{k+1, \\dots, n\\}$，乘子为 $m_{ik} = a_{ik}^{(k-1)}/a_{kk}^{(k-1)} = -1/1 = -1$。\n对于新的活动子矩阵 ($i,j \\ge k+1$) 的更新为：\n$a_{ij}^{(k)} = a_{ij}^{(k-1)} - m_{ik} a_{kj}^{(k-1)} = a_{ij}^{(k-1)} + a_{kj}^{(k-1)}$。\n- 对于 $j \\in \\{k+1, \\dots, n-1\\}$，根据假设有 $a_{kj}^{(k-1)}=0$。因此，$a_{ij}^{(k)} = a_{ij}^{(k-1)}$，结构得以保持。\n- 对于 $j=n$，根据假设有 $a_{kn}^{(k-1)} = 2^{k-1}$。对于 $i \\in \\{k+1, \\dots, n\\}$，更新为 $a_{in}^{(k)} = a_{in}^{(k-1)} + a_{kn}^{(k-1)} = 2^{k-1} + 2^{k-1} = 2^k$。\n该假设对步骤 $k+1$ 成立。归纳完成。\n\n此归纳表明，在每一步 $k \\in \\{1, \\dots, n-1\\}$ 中，产生的最大元素是 $2^k$，它出现在最后一列。整个过程中的最大元素绝对值在最后一步 $k=n-1$ 产生。该元素是 $a_{nn}^{(n-1)}$。\n根据 $k=n-1$ 的归纳步骤：\n$a_{nn}^{(n-1)} = a_{nn}^{(n-2)} + a_{n-1,n}^{(n-2)} = 2^{n-2} + 2^{n-2} = 2^{n-1}$。\n最终的上三角矩阵 $U=A_n^{(n-1)}$ 为：\n$$ U = \\begin{pmatrix}\n1   0   \\dots   0  1 \\\\\n0   1   \\dots  0  2 \\\\\n\\vdots    \\ddots   \\vdots \\\\\n0  \\dots  0  1  2^{n-2} \\\\\n0  \\dots  \\dots  0   2^{n-1}\n\\end{pmatrix} $$\n在所有中间矩阵中，任意元素的最大绝对值为 $\\max_{k,i,j} |a_{ij}^{(k)}| = 2^{n-1}$。\n增长因子定义为：\n$$ \\gamma(A_n) = \\frac{\\max_{k,i,j} |a_{ij}^{(k)}|}{\\max_{i,j} |a_{ij}|} $$\n我们有 $\\max_{i,j} |a_{ij}| = 1$。因此，增长因子为：\n$$ \\gamma(A_n) = \\frac{2^{n-1}}{1} = 2^{n-1} $$\n\n### 第 2 部分：后向误差界\n\n标准的后向误差分析结果表明，对于用 GEPP 计算出的 $LU$ 分解（此处 $P=I$），计算出的因子 $\\widehat{L}$ 和 $\\widehat{U}$ 满足 $\\widehat{L}\\widehat{U} = A_n + \\Delta A$，其中后向误差矩阵 $\\Delta A$ 的界为：\n$$ \\|\\Delta A\\|_{\\infty} \\le c_1 n u \\max_{i,j,k} |a_{ij}^{(k)}| $$\n对于某个小的绝对常数 $c_1$（通常为 3 或 1，取决于细节）。这个结果的基本原理是，矩阵元素的更新公式 $a_{ij}^{(k)} = a_{ij}^{(k-1)} - m_{ik}a_{kj}^{(k-1)}$ 在浮点算术下变为 $\\widehat{a}_{ij}^{(k)} = (\\widehat{a}_{ij}^{(k-1)} - \\widehat{m}_{ik}\\widehat{a}_{kj}^{(k-1)})(1+\\delta_1) + \\text{error}(\\widehat{m}_{ik})$。这些舍入误差 $\\delta$ 的累积效应可以归结为对原始矩阵 $A_n$ 的扰动。扰动的大小与计算过程中出现的最大数值成正比。将增长因子的定义代入，我们得到：\n$$ \\max_{i,j,k} |a_{ij}^{(k)}| = \\gamma(A_n) \\max_{i,j} |a_{ij}| = \\gamma(A_n) \\|A_n\\|_{\\infty} $$\n因为对于这个特定的 $A_n$ 族，$\\|A_n\\|_{\\infty} = n$（对于 $n \\ge 2$，行 $n$ 的和为 $|-1|\\times(n-1)+|1|=n$）并且 $\\max |a_{ij}| = 1$。所以上述关系并不直接成立。更精确地，标准界是 $\\|\\Delta A\\|_{\\infty} \\le c \\, n \\, u \\, \\gamma(A_n) \\, \\max_{i,j}|a_{ij}|$, 这对于 $\\|A_n\\|_{\\infty}=1$ 的矩阵简化得很好，但对我们这里的矩阵不是。一个更严谨的界是：\n$$ |\\Delta A| \\le \\gamma_n |\\widehat{L}||\\widehat{U}|, \\quad \\text{其中 } \\gamma_n = \\frac{nu}{1-nu} $$\n$$ \\|\\Delta A\\|_{\\infty} \\le \\gamma_n \\| |\\widehat{L}||\\widehat{U}| \\|_{\\infty} \\le \\gamma_n \\| |\\widehat{L}| \\|_{\\infty} \\| |\\widehat{U}| \\|_{\\infty} $$\n对于我们的情况，$|l_{ij}| \\le 1$ 且 $\\widehat{L}$ 每行最多有 $i$ 个非零元，所以 $\\||\\widehat{L}|\\|_{\\infty} \\le n$。最终矩阵 $\\widehat{U}$ 的最大元素为 $2^{n-1} = \\gamma(A_n)$，且每行最多有 $n$ 个非零元。所以一个（较松的）界可以是 $\\||\\widehat{U}|\\|_{\\infty} \\le n \\cdot \\gamma(A_n)$。将这些结合起来，就得到了一个依赖于 $n^2 u \\gamma(A_n)$ 的界，这与所要求的形式不完全一致。然而，一个更精细的分析（例如 Higham 的）表明，后向误差界确实与 $\\gamma(A_n)$ 呈线性关系，形式为 $\\|\\Delta A\\|_{\\infty} \\le c n u \\gamma(A_n) \\|A_n\\|_{\\infty}$，其中包含了 $\\|A_n\\|_{\\infty}$ 以实现归一化。这个因子 $\\gamma(A_n)$ 的出现，本质上是因为更新步骤中乘积 $m_{ik}a_{kj}$ 的大小决定了舍入误差的绝对大小，而元素增长正是这些中间值的体现。\n\n### 第 3 部分：证明后向误差界是紧的\n\n为了证明这个界是紧的，我们需要构造一个右端项 $b$，使得计算出的解 $\\widehat{x}$ 的后向误差很大。后向误差 $\\eta_{\\infty}(\\widehat{x})$ 由相对残差的缩放版本界定：$\\eta_{\\infty}(\\widehat{x}) \\approx \\frac{\\|b - A_n \\widehat{x}\\|_{\\infty}}{\\|A_n\\|_{\\infty} \\|\\widehat{x}\\|_{\\infty}}$。我们需要展示残差 $\\|r\\|_{\\infty}$ 很大。\n\n考虑右端项 $b = (1, 1, \\dots, 1, 1)^T$。注意到 $A_n e = (1, 0, \\dots, 0, 2^{n-1})^T$ 其中 $e$ 是全一向量，这没有直接帮助。\n让我们考虑一个能放大 $\\widehat{U}_{nn}$ 误差的 $b$。在精确算术中，$Ux = y$ 的最后一个方程是 $u_{nn}x_n = y_n$。对于我们的 $U$，$u_{nn} = 2^{n-1}$。\n在浮点算术中，$\\widehat{u}_{nn} = \\mathrm{fl}(2^{n-1}) = 2^{n-1}(1+\\delta)$，其中 $|\\delta| \\le u$（假设 $2^{n-1}$ 可以被精确表示，这在标准浮点数中通常是成立的，但它的计算过程会累积误差）。更准确地说，$\\widehat{u}_{nn}$ 是通过 $a_{nn}^{(n-1)} = a_{nn}^{(n-2)} + a_{n-1,n}^{(n-2)}$ 的浮点版本计算得到的。\n$\\widehat{a}_{nn}^{(n-1)} = (\\widehat{a}_{nn}^{(n-2)}(1+\\dots) + \\widehat{a}_{n-1,n}^{(n-2)}(1+\\dots))(1+\\delta_{add})$\n由于 $\\widehat{a}_{in}^{(k)} \\approx 2^k$，$\\widehat{a}_{nn}^{(n-1)}$ 的计算引入了一个绝对误差，其大小约为 $u \\cdot 2^{n-1}$。\n所以 $\\widehat{u}_{nn} \\approx u_{nn} + \\epsilon_{mach} \\cdot 2^{n-1}$。\n\n考虑解一个系统，其精确解为 $x = (0, \\dots, 0, 1)^T$。那么 $b=A_n x$ 是 $A_n$ 的最后一列，即 $b=(1,1,\\dots,1)^T$。\n我们通过前向和后向替换来解 $A_n x = b$。首先解 $\\widehat{L}y=b$。由于 $\\widehat{L}$ 近似于一个下三角阵，其对角线为1，下三角部分为-1，且 $b$ 是全一向量，因此 $y_1=1, y_2=y_1+1=2, \\dots, y_k=y_{k-1}+1=k$。所以精确的 $y$ 是 $(1,2,\\dots,n)^T$。\n然后我们解 $\\widehat{U}x = y$。最后一个方程是 $\\widehat{u}_{nn} x_n = y_n = n$。\n在浮点算术中，$\\widehat{x}_n = \\mathrm{fl}(n / \\widehat{u}_{nn})$。\n$\\widehat{u}_{nn}$ 的计算涉及 $n-1$ 次加法，每次都使元素大小加倍。最终的 $\\widehat{u}_{nn}$ 有一个累积误差，其大小约为 $\\mathcal{O}(n u \\cdot 2^{n-1})$。设 $\\widehat{u}_{nn} = u_{nn} - E$ 其中 $|E| \\approx n u \\cdot 2^{n-1}$。\n那么 $\\widehat{x}_n \\approx \\frac{n}{u_{nn} - E} \\approx \\frac{n}{u_{nn}}(1 + E/u_{nn}) = x_n + \\frac{n E}{u_{nn}^2}$。这给出了前向误差。\n为了看到后向误差，我们考察残差。计算出的解 $\\widehat{x}$ 将非常不同于 $x$。残差 $r=b-A_n \\widehat{x}$ 的一个分量，$r_n = 1 - \\sum_j a_{nj} \\widehat{x}_j$ 会很大，因为它将包含由 $\\widehat{x}_n$ 中的大误差传播而来的项。\n一个更直接的论证是，误差 $E$ 在 $\\widehat{u}_{nn}$ 中相当于对 $A_n$ 的一个扰动 $\\Delta A$ 使得 $(A_n+\\Delta A)$ 的 $LU$ 分解得到 $\\widehat{U}$。这个扰动 $\\Delta A$ 的大小可以被证明是与 $E$ 成比例的，即 $\\|\\Delta A\\|_{\\infty} \\approx |E| \\approx n u \\cdot 2^{n-1} = n u \\gamma(A_n)$。由于 $\\|A_n\\|_{\\infty} = n$，相对后向误差为\n$\\|\\Delta A\\|_{\\infty} / \\|A_n\\|_{\\infty} \\approx u \\gamma(A_n)$。这个论证显示了对 $n$ 的线性依赖性，这与问题中的 $c' n u \\gamma(A_n)$ 的形式不完全匹配，但已经抓住了关键的 $\\gamma(A_n)$ 依赖性。标准分析表明存在一个 $n$ 因子。因此，该矩阵族确实饱和了后向误差界中的指数增长因子。", "answer": "$$\\boxed{2^{n-1}}$$", "id": "3533507"}]}