{"hands_on_practices": [{"introduction": "后向稳定性的概念在基本运算层面可以得到最清晰的理解。本练习 [@problem_id:3533794] 探讨了对于一个看似简单的任务——计算点积——不同算法的选择如何显著影响其数值稳定性。通过推导和比较朴素求和、成对求和以及补偿求和的后向误差界，您将对算法设计如何直接影响舍入误差的累积有一个具体的认识。", "problem": "考虑给定向量的点积 $s = x^{\\top} y$\n$$\nx = \\begin{pmatrix}\n2^{10}  -3.7  5.1  -8.2  1.3  -0.75  9.9  -4.0\n\\end{pmatrix}^{\\top}, \\quad\ny = \\begin{pmatrix}\n1.0  2.5  -3.1  4.2  -5.3  6.4  -7.5  8.6\n\\end{pmatrix}^{\\top}.\n$$\n假设运算在电气和电子工程师协会 (Institute of Electrical and Electronics Engineers, IEEE) 754 binary64 (双精度) 模型中执行，采用就近舍入，因此单位舍入误差为 $u = 2^{-53}$。对于每个基本运算 `op` $\\in \\{+, -, \\times\\}$，使用标准浮点模型 $\\mathrm{fl}(a \\ \\mathrm{op} \\ b) = (a \\ \\mathrm{op} \\ b)(1 + \\delta)$，其中 $|\\delta| \\le u$。\n\n定义三种计算 $s$ 的近似值 $\\widehat{s}$ 的算法：\n- 算法 A (朴素法)：对 $i = 1,\\dots,n$ 计算 $s_i = \\mathrm{fl}(x_i \\times y_i)$，然后从左到右累加 $\\widehat{s} = \\mathrm{fl}(\\cdots \\mathrm{fl}(\\mathrm{fl}(s_1 + s_2) + s_3) + \\cdots + s_n)$。\n- 算法 B (成对求和法)：对 $i = 1,\\dots,n$ 计算 $s_i = \\mathrm{fl}(x_i \\times y_i)$，然后在一个平衡二叉树中成对地对 $\\{s_i\\}$ 求和，在每个内部节点使用 $\\mathrm{fl}(\\cdot + \\cdot)$。\n- 算法 C (补偿求和/Kahan 求和法)：对 $i = 1,\\dots,n$ 计算 $s_i = \\mathrm{fl}(x_i \\times y_i)$，然后应用补偿求和循环\n  $\n  c \\leftarrow 0,\\; \\widehat{s} \\leftarrow 0,\\; \\text{for } i=1{:}n:\\; y' \\leftarrow \\mathrm{fl}(s_i - c),\\; t \\leftarrow \\mathrm{fl}(\\widehat{s} + y'),\\; c \\leftarrow \\mathrm{fl}(\\mathrm{fl}(t - \\widehat{s}) - y'),\\; \\widehat{s} \\leftarrow t.\n  $\n\n令 $n$ 表示向量长度，这里 $n = 8$。对于每种算法，从浮点模型的第一性原理出发，推导一个分量形式的后向误差界：存在一个扰动 $\\Delta x$ 使得\n$$\n\\widehat{s} = (x + \\Delta x)^{\\top} y, \\quad |\\Delta x| \\le \\theta_{\\mathrm{alg}} |x|\n$$\n（分量不等式），并获得 $\\theta_{\\mathrm{alg}}$ 的一个显式可计算上界，该上界是 $u$ 和 $n$（以及算法特定结构）的函数。然后对 $u = 2^{-53}$ 和 $n = 8$ 对这些界进行数值计算。\n\n将你的最终结果以行矩阵的形式报告，其中包含三个数值\n$$\n\\theta_{\\mathrm{naive}},\\; \\theta_{\\mathrm{pairwise}},\\; \\theta_{\\mathrm{comp}}\n$$\n按此顺序排列，四舍五入到四位有效数字。不需要单位。", "solution": "所述问题是浮点算法后向误差分析中的一个有效练习。它科学地基于标准浮点运算法则模型，提法完善且提供了所有必要数据，并且表述客观。因此，将提供一个解决方案。\n\n目标是为三种不同的点积算法找到一个界 $\\theta_{\\mathrm{alg}}$，使得计算结果 $\\widehat{s}$ 是扰动向量 $x+\\Delta x$ 与原始向量 $y$ 的精确点积。即，\n$$ \\widehat{s} = (x + \\Delta x)^{\\top} y $$\n且分量后向误差满足 $|\\Delta x| \\le \\theta_{\\mathrm{alg}} |x|$。这等价于找到一个界 $\\theta_{\\mathrm{alg}}$，使得对于每个分量 $i=1, \\dots, n$：\n$$ |\\Delta x_i| \\le \\theta_{\\mathrm{alg}} |x_i| $$\n计算出的和 $\\widehat{s}$ 通常可以表示为精确乘积 $x_i y_i$ 与某个乘法误差的和，即 $\\widehat{s} = \\sum_{i=1}^n x_i y_i (1+\\zeta_i)$。将其与期望的后向误差形式相等，可得：\n$$ \\sum_{i=1}^n (x_i + \\Delta x_i) y_i = \\sum_{i=1}^n x_i y_i (1 + \\zeta_i) $$\n$$ \\sum_{i=1}^n \\Delta x_i y_i = \\sum_{i=1}^n x_i y_i \\zeta_i $$\n该等式必须对任意向量 $y$ 成立。这意味着对于每个 $i$，必须有 $\\Delta x_i y_i = x_i y_i \\zeta_i$，这可以简化为 $\\Delta x_i = x_i \\zeta_i$。因此，条件 $|\\Delta x| \\le \\theta_{\\mathrm{alg}} |x|$ 变为 $|x_i \\zeta_i| \\le \\theta_{\\mathrm{alg}} |x_i|$，这意味着我们需要为所有 $i=1, \\dots, n$ 找到一个一致的界 $\\theta_{\\mathrm{alg}} \\ge |\\zeta_i|$。\n\n我们使用标准浮点模型，其中对于任何基本运算 $\\mathrm{op}$，有 $\\mathrm{fl}(a \\ \\mathrm{op} \\ b) = (a \\ \\mathrm{op} \\ b)(1+\\delta)$ 且 $|\\delta| \\le u$。$k$ 个此类因子的乘积满足 $\\prod_{j=1}^k (1+\\delta_j) = 1+\\eta_k$，其中 $|\\eta_k| \\le \\gamma_k = \\frac{ku}{1-ku}$，假设 $ku \\ll 1$。\n\n对于所有三种算法，第一步是计算乘积 $s_i = \\mathrm{fl}(x_i y_i)$。\n$$ s_i = x_i y_i (1+\\delta'_i), \\quad |\\delta'_i| \\le u $$\n剩下的分析涉及如何对这些乘积 $\\{s_i\\}$ 求和。\n\n**算法 A：朴素求和法**\n在朴素的从左到右求和中，计算出的和 $\\widehat{s}$ 形式为\n$$ \\widehat{s} = \\mathrm{fl}(\\cdots \\mathrm{fl}(\\mathrm{fl}(s_1 + s_2) + s_3) + \\cdots + s_n) $$\n对舍入误差传播的详细分析表明，这可以写成：\n$$ \\widehat{s} = s_1 \\prod_{k=2}^n(1+\\delta_k) + s_2 \\prod_{k=2}^n(1+\\delta_k) + \\sum_{i=3}^n s_i \\prod_{k=i}^n(1+\\delta_k) $$\n其中每个 $|\\delta_k| \\le u$。\n代入 $s_i = x_i y_i (1+\\delta'_i)$，总和中 $x_i y_i$ 的项是 $x_i y_i (1+\\zeta_i)$，其中 $1+\\zeta_i$ 是 $(1+\\delta)$ 项的乘积。\n对于 $i=1$：$1+\\zeta_1 = (1+\\delta'_1) \\prod_{k=2}^n(1+\\delta_k)$。这是一个 $1+(n-1)=n$ 个扰动项的乘积。因此，$|\\zeta_1| \\le \\gamma_n$。\n对于 $i=2$：$1+\\zeta_2 = (1+\\delta'_2) \\prod_{k=2}^n(1+\\delta_k)$。这也是一个 $n$ 个扰动项的乘积。因此，$|\\zeta_2| \\le \\gamma_n$。\n对于 $i > 2$：$1+\\zeta_i = (1+\\delta'_i) \\prod_{k=i}^n(1+\\delta_k)$。这是一个 $1+(n-i+1) = n-i+2$ 项的乘积。因此，$|\\zeta_i| \\le \\gamma_{n-i+2}$。\n该界必须对所有 $i$ 成立。最坏的情况是 $i=1$ 和 $i=2$ 时，这给出了统一的界 $|\\zeta_i| \\le \\gamma_n$。因此，\n$$ \\theta_{\\mathrm{naive}} = \\gamma_n = \\frac{nu}{1-nu} $$\n\n**算法 B：成对求和法**\n在成对求和中，对于 $n=8$（2的幂），求和在一个平衡二叉树中进行。任何单个项 $s_i$ 被包含到最终和中所经历的求和步骤数为 $\\log_2(n)$。\n计算值 $\\widehat{s}$ 可以写为 $\\sum_{i=1}^n x_i y_i (1+\\zeta_i)$。项 $1+\\zeta_i$ 对应于影响 $x_i y_i$ 的累积乘法误差。这包括来自乘法 $x_i y_i$ 的一个误差和来自求和树的 $\\log_2(n)$ 个误差。每个项 $x_i y_i$ 总共受到 $1+\\log_2(n)$ 次浮点运算的影响。因此，累积误差因子由 $\\gamma_{1+\\log_2(n)}$ 界定。这个界对所有 $i$ 都是统一的。\n$$ \\theta_{\\mathrm{pairwise}} = \\gamma_{1+\\log_2 n} = \\frac{(1+\\log_2 n)u}{1-(1+\\log_2 n)u} $$\n\n**算法 C：补偿 (Kahan) 求和法**\n补偿求和使用一个校正项 $c$ 来跟踪主求和中的舍入误差。令 $\\widehat{s}$ 是对项 $\\{s_i\\}$ 进行补偿求和的结果。详细误差分析（例如，Higham, 1993, \"The Accuracy of Floating Point Summation\"）的一个标准结果表明 $\\widehat{s} = \\sum_{i=1}^n s_i(1+\\mu_i)$，其中 $|\\mu_i| \\le 2u + O(nu^2)$。这个界反映了误差累积在很大程度上被阻止了。\n将其与初始乘法 $s_i = x_i y_i(1+\\delta'_i)$ 的误差相结合，我们得到：\n$$ \\widehat{s} = \\sum_{i=1}^n x_i y_i (1+\\delta'_i)(1+\\mu_i) $$\n所以，$\\zeta_i = (1+\\delta'_i)(1+\\mu_i) - 1 = \\delta'_i + \\mu_i + \\delta'_i\\mu_i$。\n为了获得一个可计算的界，我们使用 $|\\delta'_i| \\le u$ 以及来自同一文献的关于 $|\\mu_i|$ 的更明確的界的形式，$|\\mu_i| \\le 2u + 2(n-i+1)u^2$。为了得到 $|\\zeta_i|$ 的一个统一界，我们取 $i$ 上的最坏情况，即 $i=1$ 时：$|\\mu_i| \\le 2u + 2nu^2$。\n$$ |\\zeta_i| \\le (1+u)(1 + 2u + 2nu^2) - 1 = 1+2u+2nu^2+u+2u^2+2nu^3 - 1 = 3u + 2(n+1)u^2 + 2nu^3 $$\n这给出了我们对补偿算法的界：\n$$ \\theta_{\\mathrm{comp}} = 3u + 2(n+1)u^2 + 2nu^3 $$\n对于小的 $u$，这个界近似为 $3u$，这表明精度有了巨大提升，且很大程度上与 $n$无关。\n\n**数值计算**\n给定 $u = 2^{-53}$ 和 $n = 8$。\n\n对于算法 A (朴素法)：\n$$ \\theta_{\\mathrm{naive}} = \\frac{8u}{1-8u} = \\frac{8 \\times 2^{-53}}{1-8 \\times 2^{-53}} = \\frac{2^{-50}}{1-2^{-50}} \\approx 8.881784197 \\times 10^{-16} $$\n四舍五入到四位有效数字，结果是 $8.882 \\times 10^{-16}$。\n\n对于算法 B (成对求和法)：\n当 $n=8$ 时，$\\log_2(n) = 3$。\n$$ \\theta_{\\mathrm{pairwise}} = \\frac{(1+3)u}{1-(1+3)u} = \\frac{4u}{1-4u} = \\frac{4 \\times 2^{-53}}{1-4 \\times 2^{-53}} = \\frac{2^{-51}}{1-2^{-51}} \\approx 4.440892099 \\times 10^{-16} $$\n四舍五入到四位有效数字，结果是 $4.441 \\times 10^{-16}$。\n\n对于算法 C (补偿法)：\n$$ \\theta_{\\mathrm{comp}} = 3u + 2(8+1)u^2 + 2(8)u^3 = 3u + 18u^2 + 16u^3 $$\n$$ \\theta_{\\mathrm{comp}} = 3 \\times 2^{-53} + 18 \\times (2^{-53})^2 + 16 \\times (2^{-53})^3 = 3 \\times 2^{-53} + 18 \\times 2^{-106} + 16 \\times 2^{-159} $$\n$u^2$ 和 $u^3$ 的项比 $u$ 的项小几个数量级。\n第一项：$3 \\times 2^{-53} \\approx 3.330669074 \\times 10^{-16}$。\n第二项：$18 \\times 2^{-106} \\approx 2.21859... \\times 10^{-31}$。\n高阶项不影响前四位有效数字。\n$$ \\theta_{\\mathrm{comp}} \\approx 3u \\approx 3.330669074 \\times 10^{-16} $$\n四舍五入到四位有效数字，结果是 $3.331 \\times 10^{-16}$。\n\n最终报告的值是 $\\theta_{\\mathrm{naive}}$、$\\theta_{\\mathrm{pairwise}}$ 和 $\\theta_{\\mathrm{comp}}$ 的三个数值界。", "answer": "$$ \\boxed{ \\begin{pmatrix} 8.882 \\times 10^{-16}  4.441 \\times 10^{-16}  3.331 \\times 10^{-16} \\end{pmatrix} } $$", "id": "3533794"}, {"introduction": "从基本运算转向复杂算法，我们现在来考察数值线性代数中的基石——带部分主元的高斯消元法（GEPP）。虽然GEPP是一个主力算法，但其后向稳定性并非无条件的，而是取决于一个被称为“主元增长因子”的量。本练习 [@problem_id:3533819] 使用一个经典的、精心构造的矩阵来展示即使采用主元策略，显著的主元增长也可能发生，并让您分析其对LU分解过程稳定性的直接影响。", "problem": "考虑带部分主元选择的高斯消去法 (GEPP)，该方法将一个非奇异矩阵 $A \\in \\mathbb{R}^{n \\times n}$ 在一系列行交换后分解为一个单位下三角因子 $L$ 和一个上三角因子 $U$。主元增长因子按元素定义为\n$$\\rho \\;=\\; \\frac{\\max_{i,j} |u_{i j}|}{\\max_{i,j} |a_{i j}|},$$\n其中 $U$ 是在给定矩阵 $A$ 上使用精确算术执行 GEPP 所产生的精确上三角因子。在浮点模型中进行计算，其中每个基本算术运算 $x \\,\\circ\\, y$ ($\\circ \\in \\{+,-,\\times,\\div\\}$) 被替换为 $\\operatorname{fl}(x \\,\\circ\\, y) = (x \\,\\circ\\, y)(1+\\delta)$，其中 $|\\delta| \\leq u$，$u$ 是单位舍入误差。假设 GEPP 的决胜规则是，当主元列中多个候选元素具有相等的最大绝对值时，选择行索引最小的那个作为主元。\n\n通过考虑由以下方式定义的显式 $6 \\times 6$ 矩阵 $A$ 来构造一个具体矩阵\n- 对 $i=1,2,3,4,5,6$，$a_{i i} = 1$，\n- 对 $i=1,2,3,4,5$，$a_{i+1,i} = -1$，\n- 对 $i=1,2,3,4,5,6$，$a_{i,6} = 1$，\n- $A$ 的所有其他元素均为 $0$。\n\n任务：\n1. 对 $A$ 符号化地应用 GEPP 过程（遵守所述的决胜规则），并确定在精确算术中产生的精确上三角因子 $U$。\n2. 计算该矩阵 $A$ 的精确主元增长因子 $\\rho$。\n3. 使用标准浮点误差模型，推导一个范数形式的后向误差界 $\\|\\Delta A\\|_{\\infty} / \\|A\\|_{\\infty}$，该界用 $u$ 以及您从 $A$、$L$ 和 $U$ 计算出的量以符号形式表示。您的推导应基于第一性原理：浮点模型、后向误差的定义（存在 $\\Delta A$ 使得对于计算解 $\\hat{x}$ 有 $(A+\\Delta A)\\hat{x}=\\hat{b}$），以及范数的次可乘性；不要假设任何现成的稳定性定理。\n4. 从该后向误差界，推导出求解线性系统 $A x = b$ 的前向误差推论，用无穷范数条件数 $\\kappa_{\\infty}(A) = \\|A\\|_{\\infty}\\,\\|A^{-1}\\|_{\\infty}$ 和单位舍入误差 $u$ 表示；通过计算 $\\|A\\|_{\\infty}$ 和 $\\|A^{-1}\\|_{\\infty}$，使您的推断对这个特定的 $A$ 是明确的。\n\n您最终报告的结果必须是该矩阵 $A$ 的精确主元增长因子 $\\rho$ 的值。无需四舍五入。将最终结果表示为单个实数。", "solution": "用户提供了一个数值线性代数问题。我将首先根据指定标准验证问题陈述，如果有效，则继续提供完整解答。\n\n### 问题验证\n\n**第 1 步：提取已知信息**\n- **算法**：带部分主元选择的高斯消去法 (GEPP)。\n- **矩阵**：$A \\in \\mathbb{R}^{n \\times n}$，其中 $n=6$。\n- **矩阵定义**：\n    - 对 $i=1,2,3,4,5,6$，$a_{i i} = 1$。\n    - 对 $i=1,2,3,4,5$，$a_{i+1,i} = -1$。\n    - 对 $i=1,2,3,4,5,6$，$a_{i,6} = 1$。\n    - $A$ 的所有其他元素均为 $0$。\n- **主元增长因子**：$\\rho = \\frac{\\max_{i,j} |u_{i j}|}{\\max_{i,j} |a_{i j}|}$，其中 $U$ 是 GEPP 产生的精确上三角因子。\n- **浮点模型**：$\\operatorname{fl}(x \\,\\circ\\, y) = (x \\,\\circ\\, y)(1+\\delta)$，其中 $|\\delta| \\leq u$。\n- **GEPP 决胜规则**：当多个主元候选元素的绝对值达到最大且相等时，选择行索引最小的那个。\n- **任务**：\n    1. 对 $A$ 应用 GEPP 找到精确因子 $U$。\n    2. 计算精确的主元增长因子 $\\rho$。\n    3. 推导范数形式的后向误差界 $\\|\\Delta A\\|_{\\infty} / \\|A\\|_{\\infty}$。\n    4. 通过计算 $\\kappa_{\\infty}(A)$ 推导求解 $Ax=b$ 的前向误差推论。\n- **最终答案要求**：$\\rho$ 的精确值。\n\n**第 2 步：使用提取的已知信息进行验证**\n该问题具有科学依据、提法恰当、客观且自成体系。这是数值线性代数中的一个标准练习，旨在探讨针对一个特定的、性质良好（尽管是说明性的）矩阵的主元增长和误差分析概念。矩阵定义明确。带有指定决胜规则的 GEPP 算法是确定性的。任务定义清晰，能够导出一个唯一且有意义的答案。没有矛盾、信息缺失或违反科学原理之处。\n\n**第 3 步：结论与行动**\n问题被判定为**有效**。我将继续进行解答。\n\n### 解答\n\n给定的矩阵 $A$ 是一个 $6 \\times 6$ 矩阵，定义如下：\n$$\nA = \\begin{pmatrix}\n1  0  0  0  0  1 \\\\\n-1  1  0  0  0  1 \\\\\n0  -1  1  0  0  1 \\\\\n0  0  -1  1  0  1 \\\\\n0  0  0  -1  1  1 \\\\\n0  0  0  0  -1  1\n\\end{pmatrix}\n$$\n$A$ 中任意元素的最大绝对值为 $\\max_{i,j} |a_{ij}| = 1$。\n\n**任务 1：应用 GEPP 求 U**\n\n我们执行带部分主元选择的高斯消去法。令 $A^{(1)} = A$。\n\n**第 1 步 ($k=1$):**\n第一列是 $(1, -1, 0, 0, 0, 0)^T$。最大绝对值是 $1$，出现在第 1 行和第 2 行。根据决胜规则，我们选择行索引最小的行中的主元，所以主元是 $a_{11}^{(1)} = 1$。不需要行交换，因此 $P_1 = I$。唯一的乘子是 $l_{21} = a_{21}^{(1)} / a_{11}^{(1)} = -1 / 1 = -1$。我们更新第 2 行：$R_2 \\leftarrow R_2 - l_{21} R_1 = R_2 + R_1$。\n$R_2: (-1, 1, 0, 0, 0, 1) + (1, 0, 0, 0, 0, 1) = (0, 1, 0, 0, 0, 2)$。\n得到的矩阵是：\n$$\nA^{(2)} = \\begin{pmatrix}\n1  0  0  0  0  1 \\\\\n0  1  0  0  0  2 \\\\\n0  -1  1  0  0  1 \\\\\n0  0  -1  1  0  1 \\\\\n0  0  0  -1  1  1 \\\\\n0  0  0  0  -1  1\n\\end{pmatrix}\n$$\n\n**第 2 步 ($k=2$):**\n主元列（从第 2 行开始）是 $(1, -1, 0, 0, 0)^T$。最大绝对值是 $1$，出现在第 2 行和第 3 行。我们选择主元 $a_{22}^{(2)} = 1$。没有行交换。乘子是 $l_{32} = a_{32}^{(2)} / a_{22}^{(2)} = -1 / 1 = -1$。更新第 3 行：$R_3 \\leftarrow R_3 - l_{32} R_2 = R_3 + R_2$。\n$R_3: (0, -1, 1, 0, 0, 1) + (0, 1, 0, 0, 0, 2) = (0, 0, 1, 0, 0, 3)$。\n$$\nA^{(3)} = \\begin{pmatrix}\n1  0  0  0  0  1 \\\\\n0  1  0  0  0  2 \\\\\n0  0  1  0  0  3 \\\\\n0  0  -1  1  0  1 \\\\\n0  0  0  -1  1  1 \\\\\n0  0  0  0  -1  1\n\\end{pmatrix}\n$$\n\n**第 3 步 ($k=3$):**\n主元列：$(1, -1, 0, 0)^T$。主元是 $a_{33}^{(3)} = 1$。乘子是 $l_{43} = -1$。更新第 4 行：$R_4 \\leftarrow R_4 + R_3$。\n$R_4: (0, 0, -1, 1, 0, 1) + (0, 0, 1, 0, 0, 3) = (0, 0, 0, 1, 0, 4)$。\n$$\nA^{(4)} = \\begin{pmatrix}\n1  0  0  0  0  1 \\\\\n0  1  0  0  0  2 \\\\\n0  0  1  0  0  3 \\\\\n0  0  0  1  0  4 \\\\\n0  0  0  -1  1  1 \\\\\n0  0  0  0  -1  1\n\\end{pmatrix}\n$$\n\n**第 4 步 ($k=4$):**\n主元列：$(1, -1, 0)^T$。主元是 $a_{44}^{(4)} = 1$。乘子是 $l_{54} = -1$。更新第 5 行：$R_5 \\leftarrow R_5 + R_4$。\n$R_5: (0, 0, 0, -1, 1, 1) + (0, 0, 0, 1, 0, 4) = (0, 0, 0, 0, 1, 5)$。\n$$\nA^{(5)} = \\begin{pmatrix}\n1  0  0  0  0  1 \\\\\n0  1  0  0  0  2 \\\\\n0  0  1  0  0  3 \\\\\n0  0  0  1  0  4 \\\\\n0  0  0  0  1  5 \\\\\n0  0  0  0  -1  1\n\\end{pmatrix}\n$$\n\n**第 5 步 ($k=5$):**\n主元列：$(1, -1)^T$。主元是 $a_{55}^{(5)} = 1$。乘子是 $l_{65} = -1$。更新第 6 行：$R_6 \\leftarrow R_6 + R_5$。\n$R_6: (0, 0, 0, 0, -1, 1) + (0, 0, 0, 0, 1, 5) = (0, 0, 0, 0, 0, 6)$。\n最终的上三角矩阵 $U$ 是：\n$$\nU = A^{(6)} = \\begin{pmatrix}\n1  0  0  0  0  1 \\\\\n0  1  0  0  0  2 \\\\\n0  0  1  0  0  3 \\\\\n0  0  0  1  0  4 \\\\\n0  0  0  0  1  5 \\\\\n0  0  0  0  0  6\n\\end{pmatrix}\n$$\n没有进行任何行交换，所以置换矩阵是单位矩阵 $P=I$。下三角矩阵 $L$ 包含乘子：\n$$\nL = \\begin{pmatrix}\n1  0  0  0  0  0 \\\\\n-1  1  0  0  0  0 \\\\\n0  -1  1  0  0  0 \\\\\n0  0  -1  1  0  0 \\\\\n0  0  0  -1  1  0 \\\\\n0  0  0  0  -1  1\n\\end{pmatrix}\n$$\n\n**任务 2：计算主元增长因子 $\\rho$**\n\n主元增长因子定义为 $\\rho = \\frac{\\max_{i,j} |u_{ij}|}{\\max_{i,j} |a_{ij}|}$。\n从矩阵 $A$，我们有 $\\max_{i,j} |a_{ij}| = 1$。\n从矩阵 $U$，所有元素都是非负的。最大值显然是 $u_{66} = 6$。所以，$\\max_{i,j} |u_{ij}| = 6$。\n因此，主元增长因子是：\n$$ \\rho = \\frac{6}{1} = 6 $$\n\n**任务 3：推导范数形式的后向误差界**\n\n使用 GEPP 求解 $Ax=b$ 时，计算解 $\\hat{x}$ 是一个扰动系统 $(A+\\Delta A)\\hat{x}=b$ 的精确解。对 LU 分解后进行前代和回代中的浮点误差进行分析，可以得到一个关于扰动 $\\Delta A$ 的标准结果。忽略 $u^2$ 及更高阶的项，该界为：\n$$ |\\Delta A| \\le 3 \\gamma_n |\\hat{L}||\\hat{U}| $$\n其中 $\\gamma_n = \\frac{nu}{1-nu} \\approx nu$ (对于小的 $u$)，且 $|\\cdot|$ 表示绝对值矩阵。对于我们的问题，$P=I$，计算出的因子 $\\hat{L}$ 和 $\\hat{U}$ 接近于精确因子 $L$ 和 $U$。因此，我们可以用以下方式近似该界：\n$$ |\\Delta A| \\le 3nu |L||U| $$\n取无穷范数并使用范数的次可乘性：\n$$ \\|\\Delta A\\|_{\\infty} \\le 3nu \\left\\| |L||U| \\right\\|_{\\infty} $$\n我们有 $n=6$。矩阵 $|L|$ 和 $|U|=U$ 分别是：\n$$\n|L| = \\begin{pmatrix}\n1  0  0  0  0  0 \\\\\n1  1  0  0  0  0 \\\\\n0  1  1  0  0  0 \\\\\n0  0  1  1  0  0 \\\\\n0  0  0  1  1  0 \\\\\n0  0  0  0  1  1\n\\end{pmatrix}, \\quad |U| = U = \\begin{pmatrix}\n1  0  0  0  0  1 \\\\\n0  1  0  0  0  2 \\\\\n0  0  1  0  0  3 \\\\\n0  0  0  1  0  4 \\\\\n0  0  0  0  1  5 \\\\\n0  0  0  0  0  6\n\\end{pmatrix}\n$$\n我们计算乘积 $|L||U|$：\n$$\n|L||U| = \\begin{pmatrix}\n1  0  0  0  0  1 \\\\\n1  1  0  0  0  1+2 \\\\\n0  1  1  0  0  2+3 \\\\\n0  0  1  1  0  3+4 \\\\\n0  0  0  1  1  4+5 \\\\\n0  0  0  0  1  5+6\n\\end{pmatrix} = \\begin{pmatrix}\n1  0  0  0  0  1 \\\\\n1  1  0  0  0  3 \\\\\n0  1  1  0  0  5 \\\\\n0  0  1  1  0  7 \\\\\n0  0  0  1  1  9 \\\\\n0  0  0  0  1  11\n\\end{pmatrix}\n$$\n无穷范数 $\\|B\\|_{\\infty} = \\max_i \\sum_j |b_{ij}|$ 是最大绝对行和。\n$|L||U|$ 的行和为：$1+1=2$, $1+1+3=5$, $1+1+5=7$, $1+1+7=9$, $1+1+9=11$, $1+11=12$。\n所以，$\\left\\| |L||U| \\right\\|_{\\infty} = 12$。\n原始矩阵 $A$ 的无穷范数是：\n$\\|A\\|_{\\infty} = \\max(|1|+|1|, |-1|+|1|+|1|, |-1|+|1|+|1|, \\dots, |-1|+|1|) = 3$。\n相对后向误差界是：\n$$ \\frac{\\|\\Delta A\\|_{\\infty}}{\\|A\\|_{\\infty}} \\le \\frac{3(6)u (12)}{3} = 72u $$\n\n**任务 4：推导前向误差推论**\n\n解的相对前向误差由以下公式界定：\n$$ \\frac{\\|x-\\hat{x}\\|_{\\infty}}{\\|x\\|_{\\infty}} \\le \\kappa_{\\infty}(A) \\frac{\\|\\Delta A\\|_{\\infty}}{\\|A\\|_{\\infty}} $$\n其中 $\\kappa_{\\infty}(A) = \\|A\\|_{\\infty} \\|A^{-1}\\|_{\\infty}$ 是条件数。我们通过求解 $Ax=y$ 来找到逆矩阵的性质。将 $A$ 的所有行方程相加，由于对 $j=1, \\dots, 5$ 的列和为零，而第6列的和为6，我们得到 $6x_6 = \\sum_{i=1}^6 y_i$，因此 $x_6 = \\frac{1}{6}\\sum_{i=1}^6 y_i$。\n对于 $i=1,\\dots,5$，第 $i$ 个方程是 $-x_{i-1} + x_i + x_6 = y_i$ (其中 $x_0=0$)。可以递归求解 $x_i$：\n$x_i = (\\sum_{k=1}^i y_k) - i \\cdot x_6$\n将 $x_6$ 的表达式代入，我们得到 $x_i$ 作为 $y_j$ 的线性组合。$A^{-1}$ 的元素 $(A^{-1})_{ij}$ 就是 $x_i$ 表达式中 $y_j$ 的系数。\n对于 $i6$：如果 $j \\le i$，系数为 $1 - i/6$；如果 $j > i$，系数为 $-i/6$。\n对于 $i=6$：我们已经有 $x_6 = \\frac{1}{6}\\sum y_j$，因此 $A^{-1}$ 的第6行为 $(1/6, 1/6, 1/6, 1/6, 1/6, 1/6)$。\n现在我们计算 $A^{-1}$ 的无穷范数，即最大绝对行和：\n第 $i$ 行 ($i6$): $\\sum_{j=1}^6 |(A^{-1})_{ij}| = i|1-i/6| + (6-i)|-i/6|$。\n$i=1$: $1 \\cdot |5/6| + 5 \\cdot |-1/6| = 10/6$\n$i=2$: $2 \\cdot |4/6| + 4 \\cdot |-2/6| = 16/6$\n$i=3$: $3 \\cdot |3/6| + 3 \\cdot |-3/6| = 18/6 = 3$\n$i=4$: $4 \\cdot |2/6| + 2 \\cdot |-4/6| = 16/6$\n$i=5$: $5 \\cdot |1/6| + 1 \\cdot |-5/6| = 10/6$\n第 6 行: $\\sum_{j=1}^6 |1/6| = 1$。\n最大值为 3。所以，$\\|A^{-1}\\|_{\\infty} = 3$。\n条件数为 $\\kappa_{\\infty}(A) = \\|A\\|_{\\infty} \\|A^{-1}\\|_{\\infty} = 3 \\cdot 3 = 9$。\n前向误差推论是：\n$$ \\frac{\\|x-\\hat{x}\\|_{\\infty}}{\\|x\\|_{\\infty}} \\le \\kappa_{\\infty}(A) \\frac{\\|\\Delta A\\|_{\\infty}}{\\|A\\|_{\\infty}} \\le (9)(72u) = 648u $$\n这表明对于这个特定矩阵，预计计算出的解的前向误差大约是单位舍入误差 $u$ 的 $648$ 倍。\n\n问题要求的是主元增长因子 $\\rho$ 的单个值。\n$\\rho$ 的最终计算摘要：\n$\\max_{i,j} |a_{ij}| = 1$。\n$\\max_{i,j} |u_{ij}| = 6$。\n$\\rho = 6/1 = 6$。", "answer": "$$\\boxed{6}$$", "id": "3533819"}, {"introduction": "一个后向稳定的算法让我们确信，我们精确地解决了一个“邻近”的问题。但这与我们最终答案的准确性有何关系呢？本练习 [@problem_id:3533796] 通过考察问题条件数的角色，在后向稳定性与前向误差之间架起了一座桥梁。您将为一个特定的线性系统计算和比较不同范数下的条件数，并用它们将已知的后向误差转化为前向误差的界，从而巩固一个至关重要的经验法则：前向误差 $\\le$ 条件数 $\\times$ 后向误差。", "problem": "设 $A \\in \\mathbb{R}^{3 \\times 3}$ 是对称正定 (SPD) 矩阵\n$$\nA \\;=\\; \\begin{pmatrix}\n2  -1  0 \\\\\n-1  2  -1 \\\\\n0  -1  2\n\\end{pmatrix}.\n$$\n考虑用范数反向稳定算法求解 $A x = b$，这意味着计算出的解 $\\hat{x}$ 是一个邻近问题 $(A + \\Delta A)\\hat{x} = b + \\Delta b$ 的精确解，其中对于选定的矩阵范数 $\\|\\cdot\\|_{p}$ 及其相关的向量范数，后向误差满足 $\\|\\Delta A\\|_{p} \\le u \\|A\\|_{p}$ 和 $\\|\\Delta b\\|_{p} \\le u \\|b\\|_{p}$，其中 $u > 0$ 是一个小数。在本问题中，取特定的扰动 $\\Delta b = 0$ 和 $\\Delta A = u A$，使得 $(A + \\Delta A)\\hat{x} = b$。\n\n仅使用范数扰动理论和条件数的核心定义，执行以下步骤：\n\n1. 计算 $2$-范数条件数 $\\kappa_{2}(A)$ 和无穷范数条件数 $\\kappa_{\\infty}(A)$。\n2. 对于扰动 $\\Delta A = u A$ 和 $\\Delta b = 0$，确定精确的范数相对前向误差 $\\|\\hat{x} - x^{\\star}\\|_{p} / \\|x^{\\star}\\|_{p}$，其中 $x^{\\star}$ 是 $A x = b$ 的精确解，对于 $p = 2$ 或 $p = \\infty$。\n3. 使用从每种范数导出的标准一阶范数前向误差界，陈述在 $2$-范数和 $\\infty$-范数下的预测前向相对误差。\n4. 通过与所选扰动的精确前向误差进行比较，评估这些界的紧致性。然后，计算在此给定扰动下，对于该矩阵 $A$，基于 $\\infty$-范数的预测界与基于 $2$-范数的预测界之间的精确比率。\n\n给出此比率的单个封闭形式表达式作为最终答案。不要代入数值近似值，也不要包含任何单位。最终答案必须是单个表达式。", "solution": "问题陈述已经过验证，被认为是科学合理的、适定的、客观的和完整的。所有条件均已满足，可以进行求解。\n\n该问题要求分析扰动线性系统 $A x = b$ 的前向误差，其中矩阵 $A$ 由下式给出\n$$\nA \\;=\\; \\begin{pmatrix}\n2  -1  0 \\\\\n-1  2  -1 \\\\\n0  -1  2\n\\end{pmatrix}.\n$$\n特定的扰动定义为 $\\Delta A = u A$ 和 $\\Delta b = 0$，导致计算解 $\\hat{x}$ 满足 $(A+uA)\\hat{x} = b$。原始问题的精确解表示为 $x^{\\star} = A^{-1}b$。\n\n**1. 条件数的计算**\n\n首先，我们计算条件数 $\\kappa_{2}(A)$ 和 $\\kappa_{\\infty}(A)$。\n\n$2$-范数条件数是 $\\kappa_2(A) = \\|A\\|_2 \\|A^{-1}\\|_2$。由于 $A$ 是对称矩阵，$\\|A\\|_2 = \\max_i |\\lambda_i(A)|$ 且 $\\|A^{-1}\\|_2 = 1 / \\min_i |\\lambda_i(A)|$，其中 $\\lambda_i(A)$ 是 $A$ 的特征值。我们通过求解特征方程 $\\det(A - \\lambda I) = 0$ 来找到特征值：\n$$\n\\det\\begin{pmatrix}\n2-\\lambda  -1  0 \\\\\n-1  2-\\lambda  -1 \\\\\n0  -1  2-\\lambda\n\\end{pmatrix} = (2-\\lambda)\\left((2-\\lambda)^2 - 1\\right) - (-1)\\left(-(2-\\lambda)\\right) = 0\n$$\n$$\n(2-\\lambda)\\left(\\lambda^2 - 4\\lambda + 3\\right) - (2-\\lambda) = (2-\\lambda)(\\lambda^2 - 4\\lambda + 2) = 0\n$$\n根是 $\\lambda_1 = 2$ 以及 $\\lambda^2 - 4\\lambda + 2 = 0$ 的根。使用二次公式，$\\lambda = \\frac{4 \\pm \\sqrt{16-8}}{2} = 2 \\pm \\sqrt{2}$。特征值为 $\\lambda_1 = 2$，$\\lambda_2 = 2+\\sqrt{2}$ 和 $\\lambda_3 = 2-\\sqrt{2}$。\n由于所有特征值均为正，矩阵 $A$ 确实是正定的。最小和最大特征值分别为 $\\lambda_{\\min} = 2 - \\sqrt{2}$ 和 $\\lambda_{\\max} = 2 + \\sqrt{2}$。\n因此，$\\|A\\|_2 = \\lambda_{\\max} = 2 + \\sqrt{2}$ 且 $\\|A^{-1}\\|_2 = 1/\\lambda_{\\min} = 1/(2 - \\sqrt{2})$。\n对 $\\|A^{-1}\\|_2$ 的分母进行有理化：\n$$\n\\|A^{-1}\\|_2 = \\frac{1}{2 - \\sqrt{2}} \\cdot \\frac{2 + \\sqrt{2}}{2 + \\sqrt{2}} = \\frac{2 + \\sqrt{2}}{4 - 2} = \\frac{2 + \\sqrt{2}}{2}.\n$$\n$2$-范数条件数为：\n$$\n\\kappa_2(A) = \\|A\\|_2 \\|A^{-1}\\|_2 = (2 + \\sqrt{2}) \\left(\\frac{2 + \\sqrt{2}}{2}\\right) = \\frac{(2 + \\sqrt{2})^2}{2} = \\frac{4 + 4\\sqrt{2} + 2}{2} = \\frac{6 + 4\\sqrt{2}}{2} = 3 + 2\\sqrt{2}.\n$$\n接下来，无穷范数条件数是 $\\kappa_\\infty(A) = \\|A\\|_\\infty \\|A^{-1}\\|_\\infty$。矩阵的无穷范数是其最大绝对行和。对于 $A$：\n$$\n\\|A\\|_\\infty = \\max(|2|+|-1|+|0|, |-1|+|2|+|-1|, |0|+|-1|+|2|) = \\max(3, 4, 3) = 4.\n$$\n为了找到 $\\|A^{-1}\\|_\\infty$，我们首先计算 $A^{-1}$。$A$ 的行列式是其特征值的乘积：$\\det(A) = (2)(2+\\sqrt{2})(2-\\sqrt{2}) = 2(4-2) = 4$。\n逆矩阵是 $A^{-1} = \\frac{1}{\\det(A)} \\text{adj}(A)$。伴随矩阵 $\\text{adj}(A)$ 是代数余子矩阵的转置。对于对称矩阵 $A$，其代数余子矩阵也是对称的。\n$$\nC = \\begin{pmatrix}\n3  2  1 \\\\\n2  4  2 \\\\\n1  2  3\n\\end{pmatrix}, \\quad A^{-1} = \\frac{1}{4} \\begin{pmatrix}\n3  2  1 \\\\\n2  4  2 \\\\\n1  2  3\n\\end{pmatrix}.\n$$\n$A^{-1}$ 的无穷范数是：\n$$\n\\|A^{-1}\\|_\\infty = \\max\\left(\\frac{1}{4}(3+2+1), \\frac{1}{4}(2+4+2), \\frac{1}{4}(1+2+3)\\right) = \\max\\left(\\frac{6}{4}, \\frac{8}{4}, \\frac{6}{4}\\right) = \\max\\left(\\frac{3}{2}, 2, \\frac{3}{2}\\right) = 2.\n$$\n无穷范数条件数是：\n$$\n\\kappa_\\infty(A) = \\|A\\|_\\infty \\|A^{-1}\\|_\\infty = 4 \\cdot 2 = 8.\n$$\n\n**2. 精确的范数相对前向误差**\n\n计算解 $\\hat{x}$ 是 $(A + uA)\\hat{x} = b$ 的精确解，可以简化为 $(1+u)A\\hat{x} = b$。\n求解 $\\hat{x}$ 得到 $\\hat{x} = \\frac{1}{1+u} A^{-1} b$。因为 $x^\\star = A^{-1}b$，我们有 $\\hat{x} = \\frac{1}{1+u} x^\\star$。\n前向误差向量是 $\\hat{x} - x^\\star = \\frac{1}{1+u} x^\\star - x^\\star = \\left(\\frac{1 - (1+u)}{1+u}\\right)x^\\star = \\frac{-u}{1+u} x^\\star$。\n在任何向量范数 $\\|\\cdot\\|_p$ 下的范数相对前向误差是：\n$$\n\\frac{\\|\\hat{x} - x^\\star\\|_p}{\\|x^\\star\\|_p} = \\frac{\\left\\|\\frac{-u}{1+u} x^\\star\\right\\|_p}{\\|x^\\star\\|_p} = \\left|\\frac{-u}{1+u}\\right| \\frac{\\|x^\\star\\|_p}{\\|x^\\star\\|_p} = \\frac{u}{1+u},\n$$\n因为 $u > 0$。这个结果与范数 $p$ 的选择无关。\n\n**3. 预测的前向相对误差界**\n\n求解 $A x = b$ 的标准一阶范数前向误差界由下式给出：\n$$\n\\frac{\\|\\hat{x} - x^\\star\\|_p}{\\|x^\\star\\|_p} \\le \\kappa_p(A) \\left( \\frac{\\|\\Delta A\\|_p}{\\|A\\|_p} + \\frac{\\|\\Delta b\\|_p}{\\|b\\|_p} \\right).\n$$\n对于给定的特定扰动，$\\Delta A = uA$ 和 $\\Delta b = 0$。我们有 $\\|\\Delta A\\|_p = \\|uA\\|_p = u\\|A\\|_p$ 和 $\\|\\Delta b\\|_p = 0$。将这些代入误差界公式：\n$$\n\\frac{\\|\\hat{x} - x^\\star\\|_p}{\\|x^\\star\\|_p} \\le \\kappa_p(A) \\left( \\frac{u\\|A\\|_p}{\\|A\\|_p} + 0 \\right) = u \\, \\kappa_p(A).\n$$\n使用步骤1中计算的条件数，预测的界是：\n- 对于 $2$-范数 ($p=2$)：预测误差界 $B_2 = u \\, \\kappa_2(A) = u(3 + 2\\sqrt{2})$。\n- 对于 $\\infty$-范数 ($p=\\infty$)：预测误差界 $B_\\infty = u \\, \\kappa_\\infty(A) = 8u$。\n\n**4. 界的紧致性评估与比率**\n\n精确的相对误差是 $\\frac{u}{1+u} \\approx u$ (对于小的 $u$)。误差界是 $u(3+2\\sqrt{2})$ 和 $8u$。误差界与精确误差的比率为 $\\frac{u \\, \\kappa_p(A)}{u/(1+u)} = \\kappa_p(A)(1+u)$。对于本问题，误差界分别比实际误差大约 $\\kappa_2(A) \\approx 5.828$ 和 $\\kappa_\\infty(A)=8$ 倍。这是预料之中的，因为误差界必须对所有具有给定范数的可能扰动 $\\Delta A$ 以及所有右端项 $b$ 都成立。\n\n问题要求计算对于这个特定矩阵 $A$，基于 $\\infty$-范数的预测界与基于 $2$-范数的预测界之间的精确比率。\n该比率为：\n$$\n\\text{Ratio} = \\frac{B_\\infty}{B_2} = \\frac{u \\, \\kappa_\\infty(A)}{u \\, \\kappa_2(A)} = \\frac{\\kappa_\\infty(A)}{\\kappa_2(A)}.\n$$\n代入计算出的条件数值：\n$$\n\\text{Ratio} = \\frac{8}{3 + 2\\sqrt{2}}.\n$$\n为简化此表达式，我们对分母进行有理化：\n$$\n\\text{Ratio} = \\frac{8}{3 + 2\\sqrt{2}} \\cdot \\frac{3 - 2\\sqrt{2}}{3 - 2\\sqrt{2}} = \\frac{8(3 - 2\\sqrt{2})}{3^2 - (2\\sqrt{2})^2} = \\frac{8(3 - 2\\sqrt{2})}{9 - 8} = 8(3 - 2\\sqrt{2}).\n$$\n该比率的最终表达式为 $24 - 16\\sqrt{2}$。", "answer": "$$\n\\boxed{24 - 16\\sqrt{2}}\n$$", "id": "3533796"}]}