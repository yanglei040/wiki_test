{"hands_on_practices": [{"introduction": "我们从一个基础练习开始，旨在帮助你熟练掌握矩阵范数和条件数的基本定义。通过计算一个具体 $2 \\times 2$ 矩阵的 $1$-范数和 $\\infty$-范数条件数，你将能够从第一性原理出发，巩固对这些核心概念的理解。更进一步，这个练习将引导你发现并证明一个关于 $2 \\times 2$ 矩阵的有趣特性，即其 $1$-范数和 $\\infty$-范数条件数是相等的 ([@problem_id:3567330])，这有助于加深对不同范数之间关系的认识。", "problem": "设 $A \\in \\mathbb{R}^{2 \\times 2}$ 为矩阵\n$$\nA = \\begin{pmatrix} 7 & -3 \\\\ 2 & 5 \\end{pmatrix}.\n$$\n从诱导矩阵范数和条件数的定义出发，计算诱导 $1$-范数 $\\|A\\|_{1}$、诱导无穷范数 $\\|A\\|_{\\infty}$ 以及相应的条件数 $\\kappa_{1}(A)$ 和 $\\kappa_{\\infty}(A)$。请仅使用以下定义：对于向量范数 $\\|\\cdot\\|_{p}$，其诱导的矩阵范数为 $\\|A\\|_{p} \\,=\\, \\displaystyle \\sup_{x \\neq 0} \\frac{\\|Ax\\|_{p}}{\\|x\\|_{p}$，条件数的定义为 $\\kappa_{p}(A) \\,=\\, \\|A\\|_{p}\\,\\|A^{-1}\\|_{p}$。在对给定矩阵完成这些计算后，通过从第一性原理出发，推导一个适用于任意可逆 $2 \\times 2$ 矩阵的通用恒等式，来分析并解释你观察到的 $\\kappa_{1}(A)$ 和 $\\kappa_{\\infty}(A)$ 之间的任何差异。\n\n作为最终报告值，请以最简形式给出比值 $\\kappa_{1}(A) / \\kappa_{\\infty}(A)$ 的精确值。无需四舍五入。", "solution": "在尝试解答之前，将对问题进行验证。\n\n### 步骤 1：提取已知条件\n- 给定矩阵 $A \\in \\mathbb{R}^{2 \\times 2}$ 为 $A = \\begin{pmatrix} 7  & -3 \\\\ 2  & 5 \\end{pmatrix}$。\n- 诱导矩阵范数的定义为 $\\|A\\|_{p} = \\displaystyle \\sup_{x \\neq 0} \\frac{\\|Ax\\|_{p}}{\\|x\\|_{p}}$。\n- 条件数的定义为 $\\kappa_{p}(A) = \\|A\\|_{p}\\,\\|A^{-1}\\|_{p}$。\n- 任务是从这些定义出发，计算 $\\|A\\|_{1}$、$\\|A\\|_{\\infty}$、$\\kappa_{1}(A)$ 和 $\\kappa_{\\infty}(A)$。\n- 任务包括通过推导一个适用于任意可逆 $2 \\times 2$ 矩阵的通用恒等式，来分析观察到的 $\\kappa_{1}(A)$ 与 $\\kappa_{\\infty}(A)$ 之间的关系。\n- 最终报告值是比值 $\\kappa_{1}(A) / \\kappa_{\\infty}(A)$ 的精确值。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题基于数值线性代数中的基本和标准定义，特别是诱导矩阵范数和条件数。这些概念在数学上是严谨的。\n- **适定性**：该问题是适定的。矩阵 $A$ 已明确给出，待计算的量基于标准、无歧义的定义。矩阵 $A$ 的行列式不为零，因此是可逆的，所以 $A^{-1}$ 和条件数存在。预期有唯一解。\n- **客观性**：语言精确且数学化，没有任何主观性或观点。\n- **自洽性与一致性**：问题提供了进行求解所需的所有必要信息（矩阵和基本定义）。没有矛盾之处。\n- **相关性**：该问题与数值线性代数中的问题条件和条件数主题直接相关。\n\n### 步骤 3：结论与行动\n该问题被认定为有效。将提供完整解答。\n\n### 解答\n该问题要求计算给定矩阵 $A$ 的矩阵范数和条件数，并基于一个通用推导来解释观察到的结果。\n\n首先，我们必须按照规定，从上确界定义中建立诱导 $1$-范数和 $\\infty$-范数的计算公式。设 $M$ 是一个具有元素 $m_{ij}$ 的通用 $m \\times n$ 矩阵。\n\n对于 $1$-范数，$\\|M\\|_1$：\n向量 $v \\in \\mathbb{R}^k$ 的 $1$-范数是 $\\|v\\|_1 = \\sum_{i=1}^k |v_i|$。对于 $x \\in \\mathbb{R}^n$，我们有：\n$$ \\|Mx\\|_1 = \\sum_{i=1}^m \\left| \\sum_{j=1}^n m_{ij} x_j \\right| \\le \\sum_{i=1}^m \\sum_{j=1}^n |m_{ij}| |x_j| $$\n重新排列求和顺序：\n$$ \\|Mx\\|_1 \\le \\sum_{j=1}^n |x_j| \\left( \\sum_{i=1}^m |m_{ij}| \\right) \\le \\left( \\max_{1 \\le k \\le n} \\sum_{i=1}^m |m_{ik}| \\right) \\sum_{j=1}^n |x_j| = \\left( \\max_{k} \\sum_{i} |m_{ik}| \\right) \\|x\\|_1 $$\n这表明 $\\|M\\|_1 \\le \\max_{j} \\sum_{i} |m_{ij}|$。为了证明等式成立，我们必须找到一个向量 $x$ 使得该界可以达到。设 $k$ 是绝对值列和达到最大值的列索引。设 $x$ 为标准基向量 $e_k$，其中 $(e_k)_j = \\delta_{jk}$。那么 $\\|x\\|_1 = 1$。对于这个 $x$，$Mx$ 是 $M$ 的第 $k$ 列。\n$$ \\|Me_k\\|_1 = \\sum_{i=1}^m |m_{ik}| = \\max_{j} \\sum_{i} |m_{ij}| $$\n因此，上确界是最大绝对值列和：$\\|M\\|_1 = \\max_{j} \\sum_{i} |m_{ij}|$。\n\n对于 $\\infty$-范数，$\\|M\\|_\\infty$：\n向量 $v \\in \\mathbb{R}^k$ 的 $\\infty$-范数是 $\\|v\\|_\\infty = \\max_{1 \\le i \\le k} |v_i|$。对于 $\\|x\\|_\\infty \\le 1$ 的 $x \\in \\mathbb{R}^n$：\n$$ \\|Mx\\|_\\infty = \\max_{1 \\le i \\le m} \\left| \\sum_{j=1}^n m_{ij} x_j \\right| \\le \\max_{1 \\le i \\le m} \\sum_{j=1}^n |m_{ij}| |x_j| \\le \\max_{1 \\le i \\le m} \\sum_{j=1}^n |m_{ij}| \\|x\\|_\\infty $$\n这表明 $\\|M\\|_\\infty \\le \\left( \\max_{i} \\sum_{j} |m_{ij}| \\right) \\|x\\|_\\infty$。为了证明等式成立，设 $k$ 是绝对值行和达到最大值的行索引。定义一个向量 $x$，其分量为 $x_j = \\text{sgn}(m_{kj})$。那么 $\\|x\\|_\\infty=1$（如果第 $k$ 行不全为零，否则是平凡情况）。$Mx$ 的第 $k$ 个分量是：\n$$ (Mx)_k = \\sum_{j=1}^n m_{kj} x_j = \\sum_{j=1}^n m_{kj} \\text{sgn}(m_{kj}) = \\sum_{j=1}^n |m_{kj}| = \\max_{i} \\sum_{j} |m_{ij}| $$\n由于 $\\|Mx\\|_\\infty \\ge |(Mx)_k|$，我们证明了该界可以达到。因此，上确界是最大绝对值行和：$\\|M\\|_\\infty = \\max_{i} \\sum_{j} |m_{ij}|$。\n\n现在，我们将这些公式应用于给定矩阵 $A = \\begin{pmatrix} 7 & -3 \\\\ 2 & 5 \\end{pmatrix}$。\n\n**计算 $A$ 的范数**\n$A$ 的绝对值列和为：\n- 第 1 列：$|7| + |2| = 7 + 2 = 9$。\n- 第 2 列：$|-3| + |5| = 3 + 5 = 8$。\n所以，$\\|A\\|_1 = \\max(9, 8) = 9$。\n\n$A$ 的绝对值行和为：\n- 第 1 行：$|7| + |-3| = 7 + 3 = 10$。\n- 第 2 行：$|2| + |5| = 2 + 5 = 7$。\n所以，$\\|A\\|_\\infty = \\max(10, 7) = 10$。\n\n**计算逆矩阵及其范数**\n为了求条件数，我们需要 $A^{-1}$。对于一个 $2 \\times 2$ 矩阵 $\\begin{pmatrix} a & b \\\\ c & d \\end{pmatrix}$，其逆矩阵为 $\\frac{1}{ad-bc} \\begin{pmatrix} d & -b \\\\ -c & a \\end{pmatrix}$。\n$A$ 的行列式为 $\\det(A) = (7)(5) - (-3)(2) = 35 + 6 = 41$。由于 $\\det(A) \\neq 0$，所以 $A$ 是可逆的。\n$$ A^{-1} = \\frac{1}{41} \\begin{pmatrix} 5 & 3 \\\\ -2 & 7 \\end{pmatrix} = \\begin{pmatrix} 5/41 & 3/41 \\\\ -2/41 & 7/41 \\end{pmatrix} $$\n现在我们计算 $A^{-1}$ 的范数：\n- 第 1 列和：$|5/41| + |-2/41| = (5+2)/41 = 7/41$。\n- 第 2 列和：$|3/41| + |7/41| = (3+7)/41 = 10/41$。\n所以，$\\|A^{-1}\\|_1 = \\max(7/41, 10/41) = 10/41$。\n\n- 第 1 行和：$|5/41| + |3/41| = (5+3)/41 = 8/41$。\n- 第 2 行和：$|-2/41| + |7/41| = (2+7)/41 = 9/41$。\n所以，$\\|A^{-1}\\|_\\infty = \\max(8/41, 9/41) = 9/41$。\n\n**计算条件数**\n使用定义 $\\kappa_p(A) = \\|A\\|_p \\|A^{-1}\\|_p$：\n$$ \\kappa_{1}(A) = \\|A\\|_{1} \\|A^{-1}\\|_{1} = 9 \\cdot \\frac{10}{41} = \\frac{90}{41} $$\n$$ \\kappa_{\\infty}(A) = \\|A\\|_{\\infty} \\|A^{-1}\\|_{\\infty} = 10 \\cdot \\frac{9}{41} = \\frac{90}{41} $$\n我们观察到 $\\kappa_{1}(A) = \\kappa_{\\infty}(A)$。\n\n**对观察结果的分析**\n问题要求推导一个适用于 $2 \\times 2$ 矩阵的通用恒等式来解释这一观察结果。\n首先，我们建立一个联系任意方阵 $M$ 及其转置 $M^T$ 的 $1$-范数和 $\\infty$-范数的通用恒等式。\n$\\|M\\|_1 = \\max_j \\sum_i |m_{ij}|$。\n$\\|M^T\\|_\\infty = \\max_i \\sum_j |(M^T)_{ij}| = \\max_i \\sum_j |m_{ji}|$。通过重新标记索引，这显然与 $M$ 的最大绝对值列和相同。所以，$\\|M\\|_1 = \\|M^T\\|_\\infty$。\n类似地，$\\|M\\|_\\infty = \\max_i \\sum_j |m_{ij}| = \\|M^T\\|_1$。\n\n利用这一点，我们可以将 $\\kappa_1(A)$ 与 $\\kappa_\\infty(A^T)$ 联系起来：\n$\\kappa_1(A) = \\|A\\|_1 \\|A^{-1}\\|_1$。\n使用上述恒等式以及性质 $(A^{-1})^T=(A^T)^{-1}$：\n$\\kappa_1(A) = \\|A^T\\|_\\infty \\|(A^{-1})^T\\|_\\infty = \\|A^T\\|_\\infty \\|(A^T)^{-1}\\|_\\infty = \\kappa_\\infty(A^T)$。\n这个恒等式 $\\kappa_1(A) = \\kappa_\\infty(A^T)$ 对任何可逆方阵 $A$ 都成立。\n\n对于我们的特定矩阵 $A$，如果 $\\kappa_\\infty(A) = \\kappa_\\infty(A^T)$，那么观察到的 $\\kappa_1(A) = \\kappa_\\infty(A)$ 就可以得到解释。我们现在将证明这对*任何*可逆的 $2 \\times 2$ 矩阵都成立。\n设 $B = \\begin{pmatrix} a & b \\\\ c & d \\end{pmatrix}$ 是一个任意可逆的 $2 \\times 2$ 矩阵，因此 $\\det(B) = ad-bc \\neq 0$。\n$\\|B\\|_\\infty = \\max(|a|+|b|, |c|+|d|)$。\n$B^{-1} = \\frac{1}{\\det(B)} \\begin{pmatrix} d & -b \\\\ -c & a \\end{pmatrix}$。\n$\\|B^{-1}\\|_\\infty = \\frac{1}{|\\det(B)|} \\max(|d|+|-b|, |-c|+|a|) = \\frac{1}{|\\det(B)|} \\max(|b|+|d|, |a|+|c|)$。\n所以，$\\kappa_\\infty(B) = \\|B\\|_\\infty \\|B^{-1}\\|_\\infty = \\frac{\\max(|a|+|b|, |c|+|d|) \\cdot \\max(|a|+|c|, |b|+|d|)}{|\\det(B)|}$。\n\n现在考虑转置矩阵 $B^T = \\begin{pmatrix} a & c \\\\ b & d \\end{pmatrix}$。\n$\\|B^T\\|_\\infty = \\max(|a|+|c|, |b|+|d|)$。\n$(B^T)^{-1} = (B^{-1})^T = \\frac{1}{\\det(B^T)} \\begin{pmatrix} d & -c \\\\ -b & a \\end{pmatrix}$。注意 $\\det(B^T) = \\det(B)$。\n$\\|(B^T)^{-1}\\|_\\infty = \\frac{1}{|\\det(B)|} \\max(|d|+|-c|, |-b|+|a|) = \\frac{1}{|\\det(B)|} \\max(|c|+|d|, |a|+|b|)$。\n所以，$\\kappa_\\infty(B^T) = \\|B^T\\|_\\infty \\|(B^T)^{-1}\\|_\\infty = \\frac{\\max(|a|+|c|, |b|+|d|) \\cdot \\max(|a|+|b|, |c|+|d|)}{|\\det(B)|}$。\n根据乘法的交换律，显然有 $\\kappa_\\infty(B) = \\kappa_\\infty(B^T)$。\n\n由于恒等式 $\\kappa_\\infty(B) = \\kappa_\\infty(B^T)$ 对任何可逆的 $2 \\times 2$ 矩阵 $B$ 都成立，并且我们有通用恒等式 $\\kappa_1(A) = \\kappa_\\infty(A^T)$，因此对于任何可逆的 $2 \\times 2$ 矩阵 $A$，我们有：\n$$ \\kappa_1(A) = \\kappa_\\infty(A^T) = \\kappa_\\infty(A) $$\n这个对所有 $2 \\times 2$ 矩阵都成立的通用恒等式解释了为什么我们对给定的特定矩阵观察到 $\\kappa_1(A) = \\kappa_\\infty(A)$。\n\n**最终计算**\n问题要求计算比值 $\\kappa_{1}(A) / \\kappa_{\\infty}(A)$。根据我们的具体计算和刚刚证明的通用恒等式：\n$$ \\frac{\\kappa_{1}(A)}{\\kappa_{\\infty}(A)} = \\frac{90/41}{90/41} = 1 $$", "answer": "$$\n\\boxed{1}\n$$", "id": "3567330"}, {"introduction": "理解了条件数的计算之后，下一步是直观地感受它在实际问题中的影响。这个练习旨在将条件数的抽象定义与它在求解线性方程组时的实际作用联系起来 ([@problem_id:3567280])。你将通过分析一个接近奇异的矩阵，构造一个“最坏情况”的例子，其中输入数据的微小扰动会导致解出现巨大的相对误差，其放大倍数恰好是该矩阵的条件数。这个过程不仅能让你亲手验证条件数的威力，还能帮助你辨析一个重要概念：一个问题可以是“适定的”（well-posed），但同时是“病态的”（ill-conditioned）。", "problem": "考虑线性系统求解问题 $f_{\\varepsilon}:\\mathbb{R}^{2}\\to\\mathbb{R}^{2}$，其定义为 $f_{\\varepsilon}(b)=x$，其中 $A_{\\varepsilon}x=b$ 且\n$$\nA_{\\varepsilon}=\\begin{pmatrix}1  & 1 \\\\ 1  & 1+\\varepsilon\\end{pmatrix},\n$$\n参数 $0 < \\varepsilon \\leq 1$。将该问题视为对于一个固定的 $A_{\\varepsilon}$，从数据 $b$ 计算解 $x$ 的问题。您的任务是：\n- 从第一性原理出发，论证对于每个固定的 $0 < \\varepsilon \\leq 1$，该问题是适定的。\n- 仅使用线性代数的核心定义和算子 $2$-范数，计算与 $A_{\\varepsilon}$ 相关的线性系统求解映射 $b\\mapsto x$ 在 $2$-范数下的条件数，并给出其关于 $\\varepsilon$ 的闭式解析表达式。\n- 给出一个特定的 $b\\in\\mathbb{R}^{2}$ 和一个扰动 $\\delta b\\in\\mathbb{R}^{2}$（两者都可能依赖于 $\\varepsilon$），使得相对变化放大率\n$$\n\\frac{\\|f_{\\varepsilon}(b+\\delta b)-f_{\\varepsilon}(b)\\|_{2}/\\|f_{\\varepsilon}(b)\\|_{2}}{\\|\\delta b\\|_{2}/\\|b\\|_{2}}\n$$\n通过您的构造精确达到，并解释为什么这表明问题对于小的 $\\varepsilon$ 是病态的，但仍然是适定的。\n\n将您的最终答案表示为 $2$-范数条件数 $\\kappa_{2}(A_{\\varepsilon})$ 关于 $\\varepsilon$ 的函数的精确解析表达式。不要求也不允许进行数值四舍五入。最终答案必须是单一的闭式表达式。", "solution": "首先根据指定标准对问题进行验证。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n- 问题是一个线性系统求解映射 $f_{\\varepsilon}:\\mathbb{R}^{2}\\to\\mathbb{R}^{2}$，定义为 $f_{\\varepsilon}(b)=x$，其中 $A_{\\varepsilon}x=b$。\n- 矩阵为 $A_{\\varepsilon}=\\begin{pmatrix}1 & 1 \\\\ 1 & 1+\\varepsilon\\end{pmatrix}$。\n- 参数范围是 $0 < \\varepsilon \\leq 1$。\n- 任务是从数据 $b$ 计算解 $x$。\n- 要求的任务是：\n    1. 从第一性原理出发，论证对于每个固定的 $0 < \\varepsilon \\leq 1$，问题是适定的。\n    2. 以 $\\varepsilon$ 的闭式表达式，计算在算子 $2$-范数下的条件数 $\\kappa_{2}(A_{\\varepsilon})$。\n    3. 构造一个特定的 $b\\in\\mathbb{R}^{2}$ 和 $\\delta b\\in\\mathbb{R}^{2}$，以达到最大的相对变化放大率。\n    4. 解释这如何表明尽管问题是适定的，但对于小的 $\\varepsilon$ 却是病态的。\n- 最终答案必须是 $\\kappa_{2}(A_{\\varepsilon})$ 的解析表达式。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学基础：** 该问题是数值线性代数中的一个标准练习，基于线性系统、矩阵范数和条件数等完善建立的概念。它在科学上和数学上是合理的。\n- **适定性：** 问题陈述要求证明其适定性。初步检查证实这是可能的。矩阵 $A_{\\varepsilon}$ 的行列式是 $\\det(A_{\\varepsilon}) = 1(1+\\varepsilon) - 1(1) = \\varepsilon$。因为给定范围是 $0 < \\varepsilon \\leq 1$，所以行列式永不为零，这意味着矩阵在此范围内总是可逆的。这是问题适定的基础（解的存在性和唯一性）。问题结构是合理的。\n- **客观性：** 问题用精确、客观的数学语言陈述，不含任何主观性。\n- **不完整或矛盾的设置：** 问题是自洽的。所有必要信息（矩阵、参数范围、范数）都已提供。没有矛盾之处。\n- **所有其他清单项均已满足。** 该问题是一个有效、结构良好的数学问题。\n\n**步骤 3：结论和行动**\n该问题是**有效的**。将提供完整解答。\n\n### 解答\n\n该问题涉及映射 $f_{\\varepsilon}(b) = x$，其中 $A_{\\varepsilon}x=b$。对于一个固定的 $\\varepsilon \\in (0, 1]$，这可以写成 $x = A_{\\varepsilon}^{-1}b$。\n\n**1. 适定性**\n\n如果一个问题的解存在、唯一，并且连续依赖于输入数据，那么它在哈达玛（Hadamard）意义下被认为是适定的。我们分析对于任何固定的 $\\varepsilon$（满足 $0 < \\varepsilon \\leq 1$）的问题 $f_{\\varepsilon}(b)=x$。\n\n- **存在性和唯一性：** 对于任意给定的 $b \\in \\mathbb{R}^{2}$，存在唯一解 $x \\in \\mathbb{R}^{2}$ 的充分必要条件是矩阵 $A_{\\varepsilon}$ 可逆。一个方阵可逆的充分必要条件是其行列式非零。$A_{\\varepsilon}$ 的行列式为：\n$$\n\\det(A_{\\varepsilon}) = \\det\\begin{pmatrix}1 & 1 \\\\ 1 & 1+\\varepsilon\\end{pmatrix} = (1)(1+\\varepsilon) - (1)(1) = 1 + \\varepsilon - 1 = \\varepsilon\n$$\n问题指定 $0 < \\varepsilon \\leq 1$。在此范围内，$\\det(A_{\\varepsilon}) = \\varepsilon \\neq 0$。因此，$A_{\\varepsilon}$ 是可逆的，这保证了对于任何 $b \\in \\mathbb{R}^{2}$，解 $x = A_{\\varepsilon}^{-1}b$ 存在且唯一。\n\n- **连续依赖性：** 解由映射 $x = f_{\\varepsilon}(b) = A_{\\varepsilon}^{-1}b$ 给出。对于一个固定的 $\\varepsilon$，矩阵 $A_{\\varepsilon}^{-1}$ 是一个常数矩阵。映射 $b \\mapsto A_{\\varepsilon}^{-1}b$ 是有限维向量空间 $\\mathbb{R}^{2}$ 上的一个线性变换。有限维空间上的所有线性变换都是连续的。因此，解 $x$ 连续地依赖于数据 $b$。\n\n由于对于任何固定的 $\\varepsilon \\in (0, 1]$，存在性、唯一性和连续依赖性这三个条件都得到满足，因此该问题是适定的。\n\n**2. 条件数计算**\n\n一个可逆矩阵 $A$ 在算子 $2$-范数下的条件数定义为 $\\kappa_{2}(A) = \\|A\\|_{2}\\|A^{-1}\\|_{2}$。矩阵的算子 $2$-范数是其最大奇异值，即 $\\|A\\|_{2} = \\sigma_{\\max}(A)$。奇异值是矩阵 $A^T A$ 的特征值的平方根。\n\n给定矩阵 $A_{\\varepsilon}$ 是对称的：$A_{\\varepsilon}^T = A_{\\varepsilon}$。对于对称矩阵，奇异值是其特征值的绝对值。$A_{\\varepsilon}$ 的特征值是特征方程 $\\det(A_{\\varepsilon} - \\lambda I) = 0$ 的根 $\\lambda$。\n$$\n\\det\\begin{pmatrix}1-\\lambda & 1 \\\\ 1 & 1+\\varepsilon-\\lambda\\end{pmatrix} = (1-\\lambda)(1+\\varepsilon-\\lambda) - 1 = 0\n$$\n$$\n\\lambda^2 - (2+\\varepsilon)\\lambda + (1+\\varepsilon) - 1 = 0\n$$\n$$\n\\lambda^2 - (2+\\varepsilon)\\lambda + \\varepsilon = 0\n$$\n使用二次方程求根公式，特征值为：\n$$\n\\lambda = \\frac{(2+\\varepsilon) \\pm \\sqrt{(2+\\varepsilon)^2 - 4\\varepsilon}}{2} = \\frac{2+\\varepsilon \\pm \\sqrt{4+4\\varepsilon+\\varepsilon^2 - 4\\varepsilon}}{2} = \\frac{2+\\varepsilon \\pm \\sqrt{4+\\varepsilon^2}}{2}\n$$\n因为 $\\varepsilon > 0$，迹 $2+\\varepsilon > 0$ 且行列式 $\\varepsilon > 0$，所以两个特征值都是正的。特征值为：\n$$\n\\lambda_{\\max} = \\frac{2+\\varepsilon + \\sqrt{4+\\varepsilon^2}}{2} \\quad \\text{和} \\quad \\lambda_{\\min} = \\frac{2+\\varepsilon - \\sqrt{4+\\varepsilon^2}}{2}\n$$\n$A_{\\varepsilon}$ 的奇异值为 $\\sigma_{\\max} = \\lambda_{\\max}$ 和 $\\sigma_{\\min} = \\lambda_{\\min}$。因此，$\\|A_{\\varepsilon}\\|_{2} = \\lambda_{\\max}$。\n\n逆矩阵 $A_{\\varepsilon}^{-1}$ 的奇异值是 $A_{\\varepsilon}$ 奇异值的倒数。因此，$A_{\\varepsilon}^{-1}$ 的最大奇异值是 $1/\\sigma_{\\min}(A_{\\varepsilon}) = 1/\\lambda_{\\min}$。\n$$\n\\|A_{\\varepsilon}^{-1}\\|_{2} = \\frac{1}{\\lambda_{\\min}} = \\frac{2}{2+\\varepsilon - \\sqrt{4+\\varepsilon^2}}\n$$\n条件数是最大奇异值与最小奇异值之比：\n$$\n\\kappa_{2}(A_{\\varepsilon}) = \\frac{\\sigma_{\\max}}{\\sigma_{\\min}} = \\frac{\\lambda_{\\max}}{\\lambda_{\\min}} = \\frac{\\frac{2+\\varepsilon + \\sqrt{4+\\varepsilon^2}}{2}}{\\frac{2+\\varepsilon - \\sqrt{4+\\varepsilon^2}}{2}} = \\frac{2+\\varepsilon + \\sqrt{4+\\varepsilon^2}}{2+\\varepsilon - \\sqrt{4+\\varepsilon^2}}\n$$\n为了得到更详细的表达式，我们可以将分母有理化：\n$$\n\\kappa_{2}(A_{\\varepsilon}) = \\frac{(2+\\varepsilon + \\sqrt{4+\\varepsilon^2})^2}{(2+\\varepsilon - \\sqrt{4+\\varepsilon^2})(2+\\varepsilon + \\sqrt{4+\\varepsilon^2})} = \\frac{(2+\\varepsilon)^2 + 2(2+\\varepsilon)\\sqrt{4+\\varepsilon^2} + (4+\\varepsilon^2)}{(2+\\varepsilon)^2 - (4+\\varepsilon^2)}\n$$\n分母为 $(4+4\\varepsilon+\\varepsilon^2) - (4+\\varepsilon^2) = 4\\varepsilon$。分子为 $4+4\\varepsilon+\\varepsilon^2 + 4+\\varepsilon^2 + 2(2+\\varepsilon)\\sqrt{4+\\varepsilon^2} = 8+4\\varepsilon+2\\varepsilon^2 + 2(2+\\varepsilon)\\sqrt{4+\\varepsilon^2}$。\n$$\n\\kappa_{2}(A_{\\varepsilon}) = \\frac{8+4\\varepsilon+2\\varepsilon^2 + 2(2+\\varepsilon)\\sqrt{4+\\varepsilon^2}}{4\\varepsilon} = \\frac{4+2\\varepsilon+\\varepsilon^2 + (2+\\varepsilon)\\sqrt{4+\\varepsilon^2}}{2\\varepsilon}\n$$\n\n**3. 最坏情况扰动的构造**\n\n相对变化放大率由 $\\frac{\\|\\delta x\\|_{2}/\\|x\\|_{2}}{\\|\\delta b\\|_{2}/\\|b\\|_{2}}$ 给出，其中 $x=A_{\\varepsilon}^{-1}b$ 和 $\\delta x=A_{\\varepsilon}^{-1}\\delta b$。该比率的最大值为 $\\kappa_{2}(A_{\\varepsilon})$。当输入数据 $b$ 和扰动 $\\delta b$ 沿着特定的特征向量方向选取时，可以达到这个最大值。\n\n该比率可以写为 $\\frac{\\|A_{\\varepsilon}^{-1}\\delta b\\|_{2}}{\\|\\delta b\\|_{2}} \\cdot \\frac{\\|b\\|_{2}}{\\|A_{\\varepsilon}^{-1}b\\|_{2}}$。\n- 为了使第一项 $\\frac{\\|A_{\\varepsilon}^{-1}\\delta b\\|_{2}}{\\|\\delta b\\|_{2}}$ 最大化，我们必须选择 $\\delta b$ 为 $A_{\\varepsilon}$ 对应其最小特征值 $\\lambda_{\\min}$ 的特征向量（这对应于 $A_{\\varepsilon}^{-1}$ 的最大特征值 $1/\\lambda_{\\min}$）。设该特征向量为 $v_{\\min}$。那么这一项就变为 $\\|A_{\\varepsilon}^{-1}\\|_{2} = 1/\\lambda_{\\min}$。\n- 为了使第二项 $\\frac{\\|b\\|_{2}}{\\|A_{\\varepsilon}^{-1}b\\|_{2}}$ 最大化，我们必须选择 $b$ 为 $A_{\\varepsilon}$ 对应其最大特征值 $\\lambda_{\\max}$ 的特征向量（这对应于 $A_{\\varepsilon}^{-1}$ 的最小特征值 $1/\\lambda_{\\max}$）。设该特征向量为 $v_{\\max}$。那么这一项就变为 $\\frac{\\|v_{\\max}\\|_{2}}{\\|A_{\\varepsilon}^{-1}v_{\\max}\\|_{2}} = \\frac{\\|v_{\\max}\\|_{2}}{\\|(1/\\lambda_{\\max})v_{\\max}\\|_{2}} = \\lambda_{\\max} = \\|A_{\\varepsilon}\\|_{2}$。\n\n我们来找出这些特征向量。对于一个特征值 $\\lambda$，一个特征向量 $\\begin{pmatrix} z \\\\ y \\end{pmatrix}$ 满足 $(1-\\lambda)z + y = 0$，所以我们可以选择形如 $\\begin{pmatrix} 1 \\\\ \\lambda-1 \\end{pmatrix}$ 的特征向量。\n- 令 $b = v_{\\max} = \\begin{pmatrix} 1 \\\\ \\lambda_{\\max}-1 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ \\frac{\\varepsilon + \\sqrt{4+\\varepsilon^2}}{2} \\end{pmatrix}$。\n- 令 $\\delta b = v_{\\min} = \\begin{pmatrix} 1 \\\\ \\lambda_{\\min}-1 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ \\frac{\\varepsilon - \\sqrt{4+\\varepsilon^2}}{2} \\end{pmatrix}$。\n\n通过这样的选择：\n$x = A_{\\varepsilon}^{-1}b = A_{\\varepsilon}^{-1}v_{\\max} = \\frac{1}{\\lambda_{\\max}}v_{\\max}$。\n$\\delta x = A_{\\varepsilon}^{-1}\\delta b = A_{\\varepsilon}^{-1}v_{\\min} = \\frac{1}{\\lambda_{\\min}}v_{\\min}$。\n\n放大率为：\n$$\n\\frac{\\|\\delta x\\|_{2}/\\|x\\|_{2}}{\\|\\delta b\\|_{2}/\\|b\\|_{2}} = \\frac{\\|\\frac{1}{\\lambda_{\\min}}v_{\\min}\\|_{2} / \\|\\frac{1}{\\lambda_{\\max}}v_{\\max}\\|_{2}}{\\|v_{\\min}\\|_{2} / \\|v_{\\max}\\|_{2}} = \\frac{(1/\\lambda_{\\min}) \\|v_{\\min}\\|_{2}}{(1/\\lambda_{\\max}) \\|v_{\\max}\\|_{2}} \\cdot \\frac{\\|v_{\\max}\\|_{2}}{\\|v_{\\min}\\|_{2}} = \\frac{1/\\lambda_{\\min}}{1/\\lambda_{\\max}} = \\frac{\\lambda_{\\max}}{\\lambda_{\\min}} = \\kappa_{2}(A_{\\varepsilon})\n$$\n这个构造演示了如何选择输入以达到可能的最大误差放大，这个值恰好是条件数。\n\n**4. 病态性与适定性**\n\n正如在第1部分中所证，对于任何固定的 $\\varepsilon \\in (0, 1]$，该问题是适定的。然而，问题的条件好坏取决于 $\\kappa_{2}(A_{\\varepsilon})$ 的大小。我们来考察当 $\\varepsilon \\to 0^{+}$ 时的行为。\n$$\n\\lim_{\\varepsilon\\to 0^{+}} \\kappa_{2}(A_{\\varepsilon}) = \\lim_{\\varepsilon\\to 0^{+}} \\frac{4+2\\varepsilon+\\varepsilon^2 + (2+\\varepsilon)\\sqrt{4+\\varepsilon^2}}{2\\varepsilon}\n$$\n当 $\\varepsilon \\to 0^{+}$ 时，分子趋近于 $4+0+0+(2)\\sqrt{4} = 8$。分母趋近于 $0$。\n更精确地说，使用泰勒展开 $\\sqrt{4+\\varepsilon^2} = 2 + O(\\varepsilon^2)$，分子是 $8+4\\varepsilon+O(\\varepsilon^2)$。\n因此，$\\kappa_{2}(A_{\\varepsilon}) \\approx \\frac{8+4\\varepsilon}{2\\varepsilon} = \\frac{4}{\\varepsilon} + 2$。\n当 $\\varepsilon \\to 0^{+}$ 时，$\\kappa_{2}(A_{\\varepsilon}) \\to \\infty$。\n\n一个非常大的条件数表明问题是**病态的**。这意味着，尽管理论上存在一个唯一的、连续的解，但输入数据 $b$ 中的微小相对误差可能会被放大成计算解 $x$ 中极大的相对误差。当 $\\varepsilon$ 变得非常小时，矩阵 $A_{\\varepsilon}$ 趋近于奇异矩阵 $\\begin{pmatrix} 1 & 1 \\\\ 1 & 1 \\end{pmatrix}$。在极限 $\\varepsilon=0$ 时，问题变得不适定。对于 $\\varepsilon > 0$ 的病态性反映了其与一个奇异（不适定）问题的邻近性。\n\n这个区别至关重要：\n- **适定性**是一个定性的、理论上的性质。对于任何固定的 $\\varepsilon > 0$，无论多小，问题都有一个唯一的、稳定的解，因此它是适定的。\n- **条件性**（或称病态性）是一个定量的、实践上的性质。当 $\\varepsilon \\to 0^{+}$ 时，条件数无界增长，使得问题在数值上不稳定且成为病态问题。在有限精度算术中，$b$ 中的舍入误差将被放大 $\\kappa_{2}(A_{\\varepsilon})$ 倍，可能导致计算出的解毫无意义。\n\n这个例子清楚地表明，一个问题可以在数学意义上是严格适定的，但同时又是如此病态，以至于在实践中无法精确求解。", "answer": "$$\n\\boxed{\\frac{4+2\\varepsilon+\\varepsilon^2 + (2+\\varepsilon)\\sqrt{4+\\varepsilon^2}}{2\\varepsilon}}\n$$", "id": "3567280"}, {"introduction": "最后，我们将理论付诸实践，探讨一个在科学计算中广泛存在的应用：使用多项式进行函数拟合。这个动手实践旨在揭示数学表示（即基函数的选择）如何深刻影响问题的条件状况 ([@problem_id:3567261])。通过对比臭名昭著的病态“单项式基”和数值性质优越的“切比雪夫基”，你将量化地看到，一个糟糕的数学模型会如何导致灾难性的数值不稳定性，而一个精心设计的模型则能确保计算的鲁棒性，这是设计可靠数值算法的关键一课。", "problem": "要求您设计并实现一个程序，用于比较在使用单项式基与第一类切比雪夫基时，在区间 $[-1,1]$ 上进行多项式最小二乘拟合的数值条件。该比较必须通过设计矩阵的谱（二范数）条件数以及一个用于判断实际可解性丧失的有原则的准则来进行。\n\n使用的基本原理和定义：\n- 在有限维线性代数中，矩阵 $A$ 的谱范数（二范数）是其最大的奇异值，记作 $\\|A\\|_{2} = \\sigma_{\\max}(A)$。对于一个列满秩矩阵 $A$，其二范数条件数定义为 $\\kappa_{2}(A) = \\sigma_{\\max}(A) / \\sigma_{\\min}(A)$，其中 $\\sigma_{\\min}(A)$ 是最小的非零奇异值。\n- 对于一个使用后向稳定算法在浮点运算（机器ε为 $u$）中求解的线性最小二乘问题，一阶前向误差模型预测，其相对解误差会被条件数放大（在适度常数范围内）。这启发了一个不可行性准则：如果 $\\kappa_{2}(A) \\cdot u$ 超过了用户指定的容差 $\\tau$，则认为该设计在容差水平 $\\tau$ 下解析相对误差是数值上不可行的。\n- 采用 IEEE-$754$ 双精度浮点运算模型，并取机器ε为 $u = \\epsilon_{\\mathrm{mach}}$，在 Python 中，该值为 $u = \\mathrm{numpy.finfo}(\\mathrm{float}).\\mathrm{eps}$。\n\n设置：\n- 令 $m \\in \\mathbb{N}$ 为采样点数量，令 $n \\in \\mathbb{N}_{0}$ 为多项式阶数。考虑在 $[-1,1]$ 上的等距网格点 $x_{i} = -1 + 2 \\cdot \\frac{i}{m-1}$，其中 $i = 0,1,\\dots,m-1$。\n- 为阶数 $n$ 定义两个设计矩阵：\n  1. 单项式设计矩阵 $A_{\\mathrm{mono}} \\in \\mathbb{R}^{m \\times (n+1)}$，其元素为 $[A_{\\mathrm{mono}}]_{i,j} = x_{i}^{j}$，其中 $j = 0,1,\\dots,n$。\n  2. 切比雪夫设计矩阵 $A_{\\mathrm{cheb}} \\in \\mathbb{R}^{m \\times (n+1)}$，其元素为 $[A_{\\mathrm{cheb}}]_{i,j} = T_{j}(x_{i})$，其中 $j = 0,1,\\dots,n$，$T_{j}$ 是第一类切比雪夫多项式，定义为 $T_{0}(x) = 1$，$T_{1}(x) = x$，以及对于 $j \\ge 1$ 的三项递推关系 $T_{j+1}(x) = 2 x T_{j}(x) - T_{j-1}(x)$。\n- 对于给定的容差 $\\tau > 0$，将某个基的不可行阈值阶数定义为满足 $\\kappa_{2}(A_{n_{\\star}}) \\cdot u > \\tau$ 的最小阶数 $n_{\\star}$，其中 $A_{n}$ 表示对应的阶数为 $n$ 的设计矩阵。如果不存在这样的 $n \\le n_{\\max}$，则报告 $-1$。此处，设置 $n_{\\max} = \\min\\{m-1, 80\\}$ 以确保计算的可行性。\n\n任务：\n- 对于每个测试用例 $(m,\\tau)$，计算：\n  1. 满足 $\\kappa_{2}(A_{\\mathrm{mono}}^{(n_{\\star}^{\\mathrm{mono}})}) \\cdot u > \\tau$ 的最小阶数 $n_{\\star}^{\\mathrm{mono}}$，如果不存在满足不等式的 $n \\le n_{\\max}$，则为 $-1$。\n  2. 满足 $\\kappa_{2}(A_{\\mathrm{cheb}}^{(n_{\\star}^{\\mathrm{cheb}})}) \\cdot u > \\tau$ 的最小阶数 $n_{\\star}^{\\mathrm{cheb}}$，如果不存在满足不等式的 $n \\le n_{\\max}$，则为 $-1$。\n- 二范数条件数 $\\kappa_{2}(A)$ 必须通过奇异值分解计算，其值为比率 $\\sigma_{\\max}(A)/\\sigma_{\\min}(A)$。\n\n测试套件：\n- 使用以下三个测试用例，每个用例指定为 $(m,\\tau)$：\n  1. $(21, 10^{-12})$,\n  2. $(50, 10^{-2})$,\n  3. $(200, 10^{-8})$.\n对于每个测试用例，网格点如上文定义在 $[-1,1]$ 上等距分布，且 $n_{\\max} = \\min\\{m-1, 80\\}$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表。该行应包含一个由三个列表组成的列表。每个内部列表对应一个测试用例（按上述顺序），并包含两个整数 $[n_{\\star}^{\\mathrm{mono}}, n_{\\star}^{\\mathrm{cheb}}]$。例如，根据计算结果，输出行可能看起来像 $[[12, -1],[9, -1],[15, -1]]$。除了方括号和逗号之外，不允许有任何额外的文本或空格。", "solution": "用户提供的问题被评估为有效。它在科学上基于数值线性代数的原理，特别是关于线性最小二乘问题的条件数问题。该问题是适定的，所有必要的定义、常数和约束都已明确指定。其语言客观、明确。任务是实现一个定义明确的数值实验，以比较两种不同多项式基的条件数。\n\n解决方案通过实现一个数值搜索来寻找最小的多项式阶数，在该阶数下，最小二乘问题的数值条件根据给定的准则变得不可行。此操作针对两种不同的多项式基进行：单项式基和切比雪夫基。\n\n问题的核心在于设计矩阵 $A$ 的条件数、机器精度 $u$ 以及求解线性最小二乘问题 $\\min_{c} \\| Ac - y \\|_{2}$ 时误差的传播之间的关系。高条件数 $\\kappa_{2}(A)$ 会放大表示误差和舍入误差。问题提供了一个具体的准则来判断这种放大何时变得不可接受：如果 $\\kappa_{2}(A) \\cdot u > \\tau$（其中 $\\tau$ 是指定的相对误差容差），则该问题被视为数值上不可行。\n\n总体算法如下：\n1.  初始化用于 IEEE-$754$ 双精度浮点运算的机器ε $u$。\n2.  对于每个由一对 $(m, \\tau)$（分别表示采样点数和不可行性容差）指定的测试用例，执行以下步骤。\n3.  确定要测试的最大多项式阶数 $n_{\\max} = \\min\\{m-1, 80\\}$。约束 $n \\le m-1$ 确保设计矩阵 $A \\in \\mathbb{R}^{m \\times (n+1)}$ 是列满秩的，这对于获得唯一的最小二乘解和非奇异的 Gram 矩阵 $A^T A$ 是必需的。\n4.  使用公式 $x_i = -1 + 2 \\frac{i}{m-1}$（其中 $i=0, 1, \\dots, m-1$）在区间 $[-1, 1]$ 上生成 $m$ 个等距采样点 $x_i$。\n5.  分别对单项式基和切比雪夫基，找到满足不可行性准则的最小阶数 $n_{\\star} \\in \\{0, 1, \\dots, n_{\\max}\\}$。这通过从 $n=0$ 迭代到 $n_{\\max}$ 来实现。\n    a. 对于每个阶数 $n$，构造相应的 $m \\times (n+1)$ 设计矩阵，即 $A_{\\mathrm{mono}}$ 或 $A_{\\mathrm{cheb}}$。\n    b. 计算谱（二范数）条件数 $\\kappa_{2}(A) = \\sigma_{\\max}(A) / \\sigma_{\\min}(A)$。这通过奇异值分解（SVD）首先计算 $A$ 的奇异值来完成。奇异值按降序返回，因此 $\\sigma_{\\max}$ 是第一个，$\\sigma_{\\min}$ 是最后一个。\n    c. 检查条件 $\\kappa_{2}(A) \\cdot u > \\tau$ 是否满足。\n    d. 使该不等式成立的第一个 $n$ 值即为所求的最小阶数 $n_{\\star}$。如果循环完成而条件未被满足，则结果报告为 $-1$。\n\n设计矩阵的构造如下：\n\n对于单项式基，矩阵 $A_{\\mathrm{mono}}$ 的元素为 $[A_{\\mathrm{mono}}]_{i,j} = x_i^j$，其中 $j=0, 1, \\dots, n$。该矩阵的列是在网格点上求值的 $\\{1, x, x^2, \\dots, x^n\\}$。众所周知，该基是病态的（条件很差），因为对于较大的 $j$，函数 $x^j$ 在区间 $[-1, 1]$ 上变得近似线性相关。\n\n对于切比雪夫基，矩阵 $A_{\\mathrm{cheb}}$ 的元素为 $[A_{\\mathrm{cheb}}]_{i,j} = T_j(x_i)$，其中 $j=0, 1, \\dots, n$。函数 $T_j(x)$ 是第一类切比雪夫多项式。它们由三项递推关系定义：\n$$\nT_0(x) = 1 \\\\\nT_1(x) = x \\\\\nT_{j+1}(x) = 2x T_j(x) - T_{j-1}(x) \\quad \\text{for } j \\ge 1\n$$\n该递推关系用于迭代生成 $A_{\\mathrm{cheb}}$ 的列。这些多项式在 $[-1, 1]$ 上关于一个连续权重函数构成一个正交系，并在离散网格上表现出优异的数值特性，从而得到比单项式基条件好得多的设计矩阵。\n\n最终输出是每个测试用例 $(m, \\tau)$ 的一对 $[n_{\\star}^{\\mathrm{mono}}, n_{\\star}^{\\mathrm{cheb}}]$ 组成的列表。这种结构便于在指定条件下直接比较两种基的数值稳定性。", "answer": "```python\nimport numpy as np\n\ndef find_n_star(m, tau, basis_type):\n    \"\"\"\n    Finds the minimal polynomial degree n_star for which the design matrix\n    becomes numerically impractical.\n\n    Args:\n        m (int): The number of sample points.\n        tau (float): The user-specified tolerance.\n        basis_type (str): The type of basis, either 'mono' or 'cheb'.\n\n    Returns:\n        int: The minimal degree n_star, or -1 if not found.\n    \"\"\"\n    u = np.finfo(float).eps\n    n_max = min(m - 1, 80)\n    x = np.linspace(-1, 1, m)\n    \n    n_star = -1\n\n    for n in range(n_max + 1):\n        # We need n+1 columns for degree n\n        num_cols = n + 1\n        \n        if basis_type == 'mono':\n            # A_ij = x_i^(j-1) is the definition but Python is 0-indexed j=0 to n\n            # A_ij = x_i^j\n            # The np.vander function with increasing=True creates columns x^0, x^1, ..., x^n\n            A = np.vander(x, N=num_cols, increasing=True)\n        elif basis_type == 'cheb':\n            # A_ij = T_j(x_i)\n            # The chebvander function creates columns T_0(x), T_1(x), ..., T_n(x)\n            A = np.polynomial.chebyshev.chebvander(x, n)\n        else:\n            raise ValueError(\"Unknown basis type\")\n\n        # The rank of the m x (n+1) matrix must be n+1.\n        # For n = m-1, this is guaranteed for distinct points.\n        if A.shape[0]  A.shape[1]:\n            # This case should not be reached due to n = m-1\n            continue\n\n        # Compute singular values\n        s = np.linalg.svd(A, compute_uv=False)\n        \n        # Condition number is sigma_max / sigma_min\n        # svd returns sorted singular values\n        if s[-1]  1e-16: # Avoid division by a near-zero singular value\n            kappa = np.inf\n        else:\n            kappa = s[0] / s[-1]\n        \n        if kappa * u > tau:\n            n_star = n\n            break\n            \n    return n_star\n\ndef solve():\n    \"\"\"\n    Main solver function to run the test suite and print results.\n    \"\"\"\n    test_cases = [\n        (21, 10**-12),\n        (50, 10**-2),\n        (200, 10**-8),\n    ]\n\n    all_results = []\n    \n    for m, tau in test_cases:\n        n_star_mono = find_n_star(m, tau, 'mono')\n        n_star_cheb = find_n_star(m, tau, 'cheb')\n        all_results.append([n_star_mono, n_star_cheb])\n    \n    # Format the final output string\n    # e.g., [[12, -1],[9, -1],[15, -1]]\n    output_str = \"[\" + \",\".join(f\"[{r[0]},{r[1]}]\" for r in all_results) + \"]\"\n    print(output_str)\n\nsolve()\n\n```", "id": "3567261"}]}