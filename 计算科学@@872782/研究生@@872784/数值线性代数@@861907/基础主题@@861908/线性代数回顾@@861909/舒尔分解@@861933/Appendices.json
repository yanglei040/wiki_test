{"hands_on_practices": [{"introduction": "舒尔分解为我们分析矩阵的内在属性提供了一个强有力的视角。一个重要的理论是，一个矩阵$A$是正规的，当且仅当其舒尔型$T$是对角矩阵。因此，$T$的非对角部分的大小直接衡量了$A$偏离正规性的程度。这个练习 [@problem_id:3596183] 将引导你通过计算来探索这一抽象度量与具体动态行为之间的深刻联系，例如矩阵幂的瞬态增长和伪谱的大小。通过这个实践，你将建立起关于非正规性为何在实际应用中如此重要的直观理解。", "problem": "你需要编写一个完整、可运行的程序，通过方阵的舒尔范式的严格上三角部分来量化其与正规性的偏离程度，并将该量与瞬时增长和伪谱特征联系起来。请在数值线性代数和舒尔分解的背景下完成此项工作。\n\n从以下基本原理出发：\n- 对于任意复方阵 $A \\in \\mathbb{C}^{n \\times n}$，存在一个酉矩阵 $Q \\in \\mathbb{C}^{n \\times n}$ 和一个上三角矩阵 $T \\in \\mathbb{C}^{n \\times n}$，使得 $A = Q T Q^*$，其中 $Q^*$ 表示 $Q$ 的共轭转置。这就是舒尔分解。\n- 弗罗贝尼乌斯范数具有酉不变性，即 $\\|A\\|_F = \\|T\\|_F$。\n- 矩阵 $A$ 是正规的当且仅当 $A^* A = A A^*$。等价地，$A$ 是正规的当且仅当其舒尔范式 $T$ 是对角矩阵。\n- $T$ 的对角元素是 $A$ 的特征值。\n\n你的程序必须：\n1. 对于每个测试矩阵 $A$，计算其舒尔分解 $A = Q T Q^*$ 以及量 $D_F = \\|T - \\operatorname{diag}(T)\\|_F$，其中 $\\operatorname{diag}(T)$ 表示由 $T$ 的对角线元素构成的对角矩阵。这个 $D_F$ 通过 $T$ 的严格上三角部分的弗罗贝尼乌斯范数量化了矩阵与正规性的偏离程度。\n2. 验证将 $D_F$ 与 $A$ 的特征值关联起来的恒等式：报告残差\n   $$\\delta = \\left| \\|T - \\operatorname{diag}(T)\\|_F - \\sqrt{\\|A\\|_F^2 - \\sum_{i=1}^n |\\lambda_i|^2} \\right|,$$\n   其中 $\\{\\lambda_i\\}_{i=1}^n$ 是 $A$ 的特征值。使用 $T$ 的对角元素作为 $\\{\\lambda_i\\}$。\n3. 通过计算以下公式来量化离散时间瞬时增长：\n   $$M_K = \\max_{1 \\le k \\le K} \\|A^k\\|_2,$$\n   其中 $\\|\\cdot\\|_2$ 表示诱导2-范数（最大奇异值），$K$ 是一个下面指定的固定正整数。\n4. 通过在指定的复数点网格上计算预解范数的峰值来量化伪谱特征。对于网格中的每个复数 $z$，计算\n   $$R(z) = \\|(z I - A)^{-1}\\|_2 = \\frac{1}{\\sigma_{\\min}(z I - A)},$$\n   其中 $\\sigma_{\\min}(\\cdot)$ 表示最小奇异值，并报告\n   $$R_{\\max} = \\max_{z \\in \\mathcal{G}} R(z).$$\n\n使用以下测试套件以确保覆盖率：\n- 测试用例1（边界正规情况）：$A_1 = 0.9 I_6$，其中 $I_6$ 是 $6 \\times 6$ 的单位矩阵。\n- 测试用例2（中度非正规）：$A_2 = 0.9 I_6 + 0.2 N$，其中 $N \\in \\mathbb{R}^{6 \\times 6}$ 的第一超对角线上元素为1，其余元素为0，即对于 $i = 1,\\dots,5$，$N_{i,i+1} = 1$，否则 $N_{ij} = 0$。\n- 测试用例3（高度非正规）：$A_3 = 0.9 I_6 + 1.0 N$，其中 $N$ 如上所述。\n\n对于瞬时增长的计算，设置 $K = 50$。对于伪谱网格，使用\n$$\\mathcal{G} = \\{ z = x + i y \\mid x \\in \\{1.00, 1.02, 1.04, \\dots, 1.20\\},\\ y \\in \\{-0.10, 0.00, 0.10\\} \\},$$\n在适用的情况下，角度以弧度为单位（请注意，此问题涉及复数算术，但不需要明确的角度）。\n\n对于每个测试用例，你的程序必须输出一个包含四个浮点数 $[D_F, M_K, R_{\\max}, \\delta]$ 的列表。你的程序应生成单行输出，其中包含所有测试用例的结果，格式为一个由方括号括起来的逗号分隔列表，其中每个元素本身是对应测试用例的四元素列表。例如：\n\"[[D_F1,M_K1,Rmax1,delta1],[D_F2,M_K2,Rmax2,delta2],[D_F3,M_K3,Rmax3,delta3]]\"。\n除了这单行输出外，不应打印任何其他文本。", "solution": "用户的问题需要经过验证。\n\n### 步骤1：提取给定信息\n- **任务**：对于给定的方阵 $A$，计算与其非正规性相关的四个量：\n    1. $D_F$：与正规性的偏离度，定义为 $\\|T - \\operatorname{diag}(T)\\|_F$，其中 $A=QTQ^*$ 是舒尔分解。\n    2. $\\delta$：一个用于验证恒等式 $D_F^2 = \\|A\\|_F^2 - \\sum_{i=1}^n |\\lambda_i|^2$ 的残差，定义为 $\\delta = \\left| D_F - \\sqrt{\\|A\\|_F^2 - \\sum_{i=1}^n |\\lambda_i|^2} \\right|$。\n    3. $M_K$：离散时间瞬时增长的度量，定义为 $M_K = \\max_{1 \\le k \\le K} \\|A^k\\|_2$。\n    4. $R_{\\max}$：伪谱幅度的度量，定义为 $R_{\\max} = \\max_{z \\in \\mathcal{G}} \\|(z I - A)^{-1}\\|_2$。\n- **常数与定义**：\n    - $A \\in \\mathbb{C}^{n \\times n}$。\n    - $A = Q T Q^*$ 是舒尔分解，其中 $Q$ 是酉矩阵，$T$ 是上三角矩阵。\n    - $Q^*$ 是 $Q$ 的共轭转置。\n    - $\\operatorname{diag}(T)$ 是与 $T$ 具有相同对角线的对角矩阵。\n    - $\\|\\cdot\\|_F$ 是弗罗贝尼乌斯范数。\n    - $\\|\\cdot\\|_2$ 是诱导2-范数（谱范数）。\n    - $\\lambda_i$ 是 $A$ 的特征值，取自 $T$ 的对角线。\n    - $\\sigma_{\\min}(\\cdot)$ 是最小奇异值。\n    - $K = 50$。\n- **测试矩阵 ($n=6$)**：\n    - $A_1 = 0.9 I_6$。\n    - $A_2 = 0.9 I_6 + 0.2 N$，其中 $N$ 是一个 $6 \\times 6$ 矩阵，其 $N_{i,i+1} = 1$，所有其他元素为零。\n    - $A_3 = 0.9 I_6 + 1.0 N$。\n- **伪谱网格**：\n    - $\\mathcal{G} = \\{ z = x + i y \\mid x \\in \\{1.00, 1.02, \\dots, 1.20\\},\\ y \\in \\{-0.10, 0.00, 0.10\\} \\}$。\n- **输出格式**：对于每个测试用例，生成一个列表 $[D_F, M_K, R_{\\max}, \\delta]$。最终输出必须是表示这些列表的列表的单个字符串，例如 `[[...],[...],[...]]`。\n\n### 步骤2：使用提取的给定信息进行验证\n1.  **科学依据**：该问题是数值线性代数中的一个标准练习，基于舒尔分解及其与正规性、瞬态动力学和伪谱的关系。所有概念和定义（$A=QTQ^*$、矩阵范数、特征值、预解式）都是基础且陈述正确的。关于 $D_F$ 的恒等式是弗罗贝尼乌斯范数酉不变性的一个已知推论。\n2.  **适定性**：该问题是适定的。对于任意给定的方阵 $A$，其舒尔分解存在，并且所有四个量（$D_F, \\delta, M_K, R_{\\max}$）都可以通过标准数值算法唯一计算。参数 $K$ 和网格 $\\mathcal{G}$ 都有明确定义。\n3.  **客观性**：问题以精确、客观的数学语言陈述，没有任何主观性或歧义。\n4.  **完整与一致性**：解决问题所需的所有信息都已提供。定义或约束中没有矛盾。\n5.  **非平凡性**：虽然第一个测试用例是一个简单的正规矩阵作为基线，但后续用例涉及非平凡的非正规矩阵，这些矩阵将展示我们感兴趣的现象（瞬时增长和大的伪谱）。该问题需要实现几种不同的数值计算，这是一项实质性的任务。\n\n### 步骤3：结论与行动\n该问题是 **有效的**，因为它在科学上是合理的、适定的、客观的和完整的。它代表了非正规矩阵研究中的一个典型数值实验。将继续进行求解。\n\n---\n\n目标是量化矩阵 $A \\in \\mathbb{C}^{n \\times n}$ 的非正规程度，并展示其与两个主要后果的关联：动力系统中的瞬时增长及其伪谱的范围。我们将为三个测试矩阵中的每一个计算四个度量。\n\n**理论框架**\n\n此分析的基础是 **舒尔分解**，它指出任何方阵 $A$ 都可以分解为 $A = Q T Q^*$，其中 $Q$ 是一个酉矩阵（$Q^*Q = I$），$T$ 是一个上三角矩阵。$T$ 的对角元素是 $A$ 的特征值，记为 $\\{\\lambda_i\\}_{i=1}^n$。如果一个矩阵 $A$ 与其共轭转置可交换，即 $A A^* = A^* A$，则该矩阵被定义为 **正规** 矩阵。一个关键定理指出，一个矩阵是正规的当且仅当其舒尔范式 $T$ 是一个对角矩阵。\n\n**1. 与正规性的偏离度 ($D_F$) 及恒等式验证 ($\\delta$)**\n\n$T$ 非对角化的程度提供了 $A$ 与正规性偏离的定量度量。我们使用 $T$ 的严格上三角部分的弗罗贝尼乌斯范数来度量这一点。设 $T_{off} = T - \\operatorname{diag}(T)$。那么该量为：\n$$D_F = \\|T_{off}\\|_F = \\|T - \\operatorname{diag}(T)\\|_F$$\n$D_F=0$ 的值意味着 $T$ 是对角矩阵，且 $A$ 是正规矩阵。较大的 $D_F$ 表示与正规性的偏离更大。\n\n一个有用的恒等式将 $D_F$ 与原始矩阵 $A$ 的弗罗贝尼乌斯范数及其特征值联系起来。弗罗贝尼乌斯范数是酉不变的，意味着 $\\|A\\|_F = \\|Q T Q^*\\|_F = \\|T\\|_F$。三角矩阵 $T$ 的弗罗贝尼乌斯范数的平方可以分解为其对角元素和非对角元素的平方和：\n$$\\|T\\|_F^2 = \\sum_{i,j=1}^n |T_{ij}|^2 = \\sum_{i=1}^n |T_{ii}|^2 + \\sum_{i  j} |T_{ij}|^2$$\n认识到 $T_{ii} = \\lambda_i$，并且 $\\sum_{i  j} |T_{ij}|^2$ 正是 $T$ 的严格上三角部分的弗罗贝尼乌斯范数的平方，也就是 $D_F^2$，我们有：\n$$\\|A\\|_F^2 = \\|T\\|_F^2 = \\sum_{i=1}^n |\\lambda_i|^2 + D_F^2$$\n重新整理这个式子，我们得到一个用 $A$ 及其特征值表示 $D_F$ 的显式公式：\n$$D_F = \\sqrt{\\|A\\|_F^2 - \\sum_{i=1}^n |\\lambda_i|^2}$$\n问题要求我们计算这个恒等式的残差 $\\delta$ 来验证其数值有效性：\n$$\\delta = \\left| D_F - \\sqrt{\\|A\\|_F^2 - \\sum_{i=1}^n |\\lambda_i|^2} \\right|$$\n在精确算术中，$\\delta$ 将为 $0$。在浮点算术中，一个小的非零 $\\delta$ 反映了数值误差的累积。\n\n**2. 瞬时增长 ($M_K$)**\n\n对于形如 $x_{k+1} = A x_k$ 的离散动力系统，状态向量的范数演变为 $\\|x_k\\| = \\|A^k x_0\\|$。当 $k \\to \\infty$ 时，$\\|A^k\\|$ 的行为由谱半径 $\\rho(A) = \\max_i |\\lambda_i|$ 决定。如果 $\\rho(A)  1$，则 $\\|A^k\\| \\to 0$。然而，对于非正规矩阵，范数 $\\|A^k\\|$ 在最终衰减之前，可能会在较小的 $k$ 值时经历显著增长。这被称为 **瞬时增长**。对于谱半径 $\\rho(A)  1$ 的正规矩阵，我们有 $\\|A^k\\|_2 = (\\rho(A))^k$，这是一个严格递减的序列。瞬时增长的存在是非正规性的直接后果。我们通过计算在有限范围 $K$ 内达到的最大范数来量化这一点：\n$$M_K = \\max_{1 \\le k \\le K} \\|A^k\\|_2$$\n其中 $\\|\\cdot\\|_2$ 是谱范数（最大奇异值）。\n\n**3. 伪谱特征 ($R_{\\max}$)**\n\n矩阵 $A$ 的 **伪谱**，记为 $\\Lambda_{\\epsilon}(A)$，是复数 $z$ 的集合，其中 $z$ 是某个满足 $\\|E\\|_2 \\le \\epsilon$ 的邻近矩阵 $A+E$ 的特征值。一个等价的定义是 $\\Lambda_{\\epsilon}(A) = \\{z \\in \\mathbb{C} \\mid \\|(zI-A)^{-1}\\|_2 \\ge \\epsilon^{-1}\\}$。矩阵 $(zI-A)^{-1}$ 是 $A$ 在 $z$ 处的 **预解式**。\n\n对于正规矩阵，预解范数就是到谱的距离的倒数：$\\|(zI-A)^{-1}\\|_2 = 1/\\text{dist}(z, \\Lambda(A))$。只有当 $z$ 非常接近某个特征值时，范数才会很大。对于非正规矩阵，即使 $z$ 远离任何特征值，预解范数也可能极大，这表明该矩阵对扰动敏感。大片的高预解范数区域是高度非正规矩阵的特征。\n\n我们将通过在指定的复数网格 $\\mathcal{G}$ 上计算预解范数的峰值来探究此行为：\n$$R_{\\max} = \\max_{z \\in \\mathcal{G}} \\|(z I - A)^{-1}\\|_2$$\n计算使用了恒等式 $\\|(zI-A)^{-1}\\|_2 = 1/\\sigma_{\\min}(zI-A)$，其中 $\\sigma_{\\min}$ 是最小奇异值。在远离谱的网格上出现大的 $R_{\\max}$ 值表明存在显著的非正规性。\n\n这三个测试用例将说明这三个度量之间的紧密耦合关系：随着非正规性的增加（从 $A_1$ 到 $A_3$），我们预期会看到 $D_F$、 $M_K$ 和 $R_{\\max}$ 的相应增加。", "answer": "```python\nimport numpy as np\nimport scipy.linalg\n\ndef solve():\n    \"\"\"\n    Computes measures of non-normality for a set of test matrices.\n    \"\"\"\n    # Define problem constants\n    n = 6\n    K = 50\n    identity_n = np.identity(n)\n    \n    # Define matrix N (nilpotent, ones on first superdiagonal)\n    N = np.diag(np.ones(n - 1), k=1)\n    \n    # Define the test cases\n    test_cases = [\n        0.9 * identity_n,                     # Case 1: A1 (normal)\n        0.9 * identity_n + 0.2 * N,           # Case 2: A2 (moderately nonnormal)\n        0.9 * identity_n + 1.0 * N,           # Case 3: A3 (highly nonnormal)\n    ]\n\n    # Define the pseudospectral grid G\n    x_grid = np.linspace(1.0, 1.2, 11)\n    y_grid = np.array([-0.10, 0.00, 0.10])\n    G_grid = [x + 1j*y for x in x_grid for y in y_grid]\n\n    all_results = []\n    \n    for A in test_cases:\n        # 1. Compute D_F: Departure from normality\n        T, _ = scipy.linalg.schur(A, output='complex')\n        diag_T = np.diag(np.diag(T))\n        T_off = T - diag_T\n        D_F = np.linalg.norm(T_off, 'fro')\n\n        # 2. Verify identity and compute residual delta\n        norm_A_F_sq = np.linalg.norm(A, 'fro')**2\n        lambdas = np.diag(T)\n        sum_lambda_sq = np.sum(np.abs(lambdas)**2)\n        \n        # Handle potential floating point inaccuracies where norm_A_F_sq  sum_lambda_sq\n        val_under_sqrt = norm_A_F_sq - sum_lambda_sq\n        if val_under_sqrt  0:\n             val_under_sqrt = 0\n\n        identity_rhs = np.sqrt(val_under_sqrt)\n        delta = np.abs(D_F - identity_rhs)\n\n        # 3. Quantify transient growth M_K\n        M_K = 0.0\n        A_power_k = np.identity(n)\n        for _ in range(K):\n            A_power_k = A_power_k @ A\n            norm_k = np.linalg.norm(A_power_k, 2)\n            if norm_k > M_K:\n                M_K = norm_k\n\n        # 4. Quantify pseudospectral peak R_max\n        R_max = 0.0\n        for z in G_grid:\n            # Compute resolvent norm as 1 / sigma_min(zI - A)\n            zI_minus_A = z * identity_n - A\n            s_min = np.linalg.svd(zI_minus_A, compute_uv=False)[-1]\n            resolvent_norm = 1.0 / s_min if s_min > 0 else np.inf\n            if resolvent_norm > R_max:\n                R_max = resolvent_norm\n        \n        # Store results for this case\n        all_results.append([D_F, M_K, R_max, delta])\n\n    # Format the final output string to remove spaces for exact match\n    final_output_str = str(all_results).replace(\" \", \"\")\n    print(final_output_str)\n\nsolve()\n```", "id": "3596183"}, {"introduction": "除了理论分析，舒尔分解也是许多数值算法的基石，其威力在于能够简化复杂的矩阵函数计算。这个实践 [@problem_id:3596233] 聚焦于一个典型的例子：计算矩阵指数$\\exp(A)$。通过将问题转换到舒尔基下，原问题被简化为处理更小的（分块）三角矩阵，这是一个更易于处理的任务。这个练习完美地展示了由三角化实现的“分而治之”策略，并揭示了矩阵函数$f(A)$的计算可以通过$f(T)$来实现的核心思想。", "problem": "设矩阵 $A \\in \\mathbb{R}^{3 \\times 3}$ 为\n$$\nA \\;=\\; \\begin{pmatrix}\n0  1  1 \\\\\n-1  0  0 \\\\\n0  0  2\n\\end{pmatrix}.\n$$\n使用实舒尔分解，通过计算实舒尔因子 $T$ 的 $1 \\times 1$ 和 $2 \\times 2$ 块的指数，并组合成 $\\,\\exp(A) = Q \\exp(T) Q^{*}\\,$ 来计算矩阵指数 $\\,\\exp(A)\\,$。在推导过程中，从矩阵指数的定义、相似变换的基本性质和块上三角矩阵的性质出发，并证明对于实拟上三角矩阵 $T$，$\\,\\exp(T)\\,$ 的结构。作为一个进阶的数值考虑，讨论缩放平方（scaling and squaring）方法如何能在有限精度算术中提高此计算的准确性和稳定性，包括如何选择缩放参数以及平方的作用。\n\n以闭合形式的解析表达式报告 $\\,\\exp(A)\\,$ 的 $(1,3)$ 元。不要近似或四舍五入。所有三角函数的参数均以弧度为单位。", "solution": "首先验证问题的科学性、适定性和客观性。\n\n### 步骤 1：提取已知条件\n- 给定矩阵 $A \\in \\mathbb{R}^{3 \\times 3}$ 为 $A = \\begin{pmatrix} 0  1  1 \\\\ -1  0  0 \\\\ 0  0  2 \\end{pmatrix}$。\n- 任务是计算矩阵指数 $\\exp(A)$。\n- 指定的方法是使用实舒尔分解 $A = Q T Q^*$，通过其分块计算 $\\exp(T)$，然后求得 $\\exp(A) = Q \\exp(T) Q^*$。\n- 推导必须从矩阵指数的定义开始，并证明分块矩阵计算的合理性。\n- 需要进行一个进阶的数值考虑：讨论缩放平方方法。\n- 需要报告的最终结果是 $\\exp(A)$ 的 $(1,3)$ 元的闭合形式解析表达式。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据：** 该问题基于数值线性代数的基本概念：矩阵指数和实舒尔分解。这些都是标准的、完善的课题。所概述的程序是计算矩阵指数的公认算法。\n- **适定性：** 矩阵 $A$ 已明确给出。任何实矩阵的实舒尔分解都存在。矩阵指数是唯一定义的。该问题要求一个具体、可计算的量。问题是自洽且无歧义的。\n- **客观性：** 该问题以精确的数学语言陈述，不含任何主观性或意见。\n\n### 步骤 3：结论与行动\n该问题有效，因为其在数学上是合理的、适定的和客观的。将提供完整的解答。\n\n### 解题推导\n\n方阵 $M$ 的矩阵指数由幂级数定义\n$$\n\\exp(M) = \\sum_{k=0}^{\\infty} \\frac{1}{k!} M^k.\n$$\n矩阵指数的一个基本性质与相似变换有关。如果一个矩阵 $A$ 可以写成 $A = S B S^{-1}$，其中 $S$ 是某个可逆矩阵，那么它的幂次为 $A^k = (S B S^{-1})^k = S B^k S^{-1}$。将此代入幂级数定义可得\n$$\n\\exp(A) = \\sum_{k=0}^{\\infty} \\frac{1}{k!} (S B^k S^{-1}) = S \\left( \\sum_{k=0}^{\\infty} \\frac{1}{k!} B^k \\right) S^{-1} = S \\exp(B) S^{-1}.\n$$\n实舒尔分解定理指出，对于任何实矩阵 $A \\in \\mathbb{R}^{n \\times n}$，存在一个实正交矩阵 $Q$（即 $Q^T Q = I$，所以 $Q^{-1} = Q^T = Q^*$）和一个实拟上三角矩阵 $T$，使得 $A = Q T Q^T$。矩阵 $T$ 是块上三角矩阵，其对角线上的 $1 \\times 1$ 块对应实特征值，$2 \\times 2$ 块的特征值为共轭复数对。\n利用上述性质，我们有 $\\exp(A) = Q \\exp(T) Q^T$。因此，我们必须计算 $\\exp(T)$。\n\n设 $T$ 为一个块上三角矩阵，例如，一个 $2 \\times 2$ 的分块形式：\n$$\nT = \\begin{pmatrix} T_{11}  T_{12} \\\\ 0  T_{22} \\end{pmatrix}.\n$$\n$T$ 的幂次保持此块上三角结构：\n$$\nT^k = \\begin{pmatrix} T_{11}^k  U_k \\\\ 0  T_{22}^k \\end{pmatrix},\n$$\n其中 $U_k$ 是一个更复杂的项。那么 $T$ 的指数为\n$$\n\\exp(T) = \\sum_{k=0}^{\\infty} \\frac{1}{k!} T^k = \\begin{pmatrix} \\sum_{k=0}^{\\infty} \\frac{1}{k!} T_{11}^k  \\sum_{k=0}^{\\infty} \\frac{1}{k!} U_k \\\\ 0  \\sum_{k=0}^{\\infty} \\frac{1}{k!} T_{22}^k \\end{pmatrix} = \\begin{pmatrix} \\exp(T_{11})  U \\\\ 0  \\exp(T_{22}) \\end{pmatrix}.\n$$\n$\\exp(T)$ 的对角块是 $T$ 的对角块的指数。非对角块 $U$ 可以通过求解 $Y(t) = \\exp(tT)$ 的微分方程 $Y'(t) = T Y(t)$（满足 $Y(0)=I$）来找到。对于所示的分块结构，这会导出一个关于 $Y(t)$ 各分块的方程组。非对角块 $Y_{12}(t)$ 满足 $Y'_{12}(t) = T_{11}Y_{12}(t) + T_{12}Y_{22}(t)$，且 $Y_{12}(0)=0$。通过常数变易法，解为 $Y_{12}(t) = \\int_0^t \\exp((t-s)T_{11}) T_{12} \\exp(sT_{22}) ds$。那么块 $U$ 就是 $Y_{12}(1)$。\n\n现在，我们将此过程应用于给定的矩阵 $A = \\begin{pmatrix} 0  1  1 \\\\ -1  0  0 \\\\ 0  0  2 \\end{pmatrix}$。我们首先求其实舒尔分解 $A=QTQ^T$。特征方程为 $\\det(A-\\lambda I) = (2-\\lambda)(\\lambda^2+1)=0$，得到特征值 $\\lambda_1 = 2$ 和 $\\lambda_{2,3} = \\pm i$。\n矩阵 $A$ 可以分块为\n$$\nA = \\begin{pmatrix} B  C \\\\ 0  D \\end{pmatrix}, \\quad \\text{其中} \\quad B = \\begin{pmatrix} 0  1 \\\\ -1  0 \\end{pmatrix}, \\quad C = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, \\quad D = (2).\n$$\n$2 \\times 2$ 分块 $B$ 的特征值为 $\\pm i$，而 $1 \\times 1$ 分块 $D$ 的特征值为 $2$。这种分块结构恰好符合实舒尔分解的形式。因此，矩阵 $A$ 本身已经是一个实舒尔形式。我们可以选择 $T=A$ 和正交矩阵 $Q=I$。\n因此，我们需要通过计算其分块的指数来计算 $\\exp(A)$。我们有\n$$\nT_{11} = B = \\begin{pmatrix} 0  1 \\\\ -1  0 \\end{pmatrix}, \\quad T_{12} = C = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, \\quad T_{22} = D = (2).\n$$\n对角块的指数为：\n1.  对于 $T_{22}=(2)$，$\\exp(T_{22}) = \\exp(2) = e^2$。\n2.  对于 $T_{11} = \\begin{pmatrix} 0  1 \\\\ -1  0 \\end{pmatrix}$，我们识别出它是旋转的生成元。其指数由公式 $\\exp(t T_{11}) = (\\cos t)I + (\\sin t)T_{11}$ 给出。对于 $t=1$：\n    $$\n    \\exp(T_{11}) = \\begin{pmatrix} \\cos 1  \\sin 1 \\\\ -\\sin 1  \\cos 1 \\end{pmatrix}.\n    $$\n$\\exp(A)$ 的非对角块 $U$ 由 $t=1$ 时的积分公式给出：\n$$\nU = \\int_0^1 \\exp((1-s)T_{11}) T_{12} \\exp(sT_{22}) ds.\n$$\n代入已知量：\n$$\nU = \\int_0^1 \\begin{pmatrix} \\cos(1-s)  \\sin(1-s) \\\\ -\\sin(1-s)  \\cos(1-s) \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} e^{2s} ds = \\int_0^1 \\begin{pmatrix} \\cos(1-s) e^{2s} \\\\ -\\sin(1-s) e^{2s} \\end{pmatrix} ds.\n$$\n我们对每个分量进行积分。令 $u=1-s$，则 $s=1-u$ 且 $ds=-du$。积分上下限从 $s \\in [0,1]$ 变为 $u \\in [1,0]$。\n第一个分量是：\n$$\n\\int_0^1 \\cos(1-s) e^{2s} ds = \\int_1^0 \\cos(u) e^{2(1-u)} (-du) = e^2 \\int_0^1 e^{-2u} \\cos(u) du.\n$$\n使用标准积分 $\\int e^{ax}\\cos(bx)dx = \\frac{e^{ax}}{a^2+b^2}(a\\cos(bx)+b\\sin(bx))$，其中 $a=-2, b=1$：\n$$\ne^2 \\left[ \\frac{e^{-2u}}{(-2)^2+1^2}(-2\\cos u + \\sin u) \\right]_0^1 = \\frac{e^2}{5} \\left[ e^{-2}(-2\\cos 1 + \\sin 1) - e^0(-2\\cos 0 + \\sin 0) \\right] = \\frac{1}{5}(\\sin 1 - 2\\cos 1 + 2e^2).\n$$\n第二个分量是：\n$$\n\\int_0^1 -\\sin(1-s) e^{2s} ds = \\int_1^0 -\\sin(u) e^{2(1-u)} (-du) = -e^2 \\int_0^1 e^{-2u} \\sin(u) du.\n$$\n使用标准积分 $\\int e^{ax}\\sin(bx)dx = \\frac{e^{ax}}{a^2+b^2}(a\\sin(bx)-b\\cos(bx))$：\n$$\n-e^2 \\left[ \\frac{e^{-2u}}{5}(-2\\sin u - \\cos u) \\right]_0^1 = -\\frac{e^2}{5} \\left[ e^{-2}(-2\\sin 1 - \\cos 1) - e^0(-2\\sin 0 - \\cos 0) \\right] = \\frac{1}{5}(2\\sin 1 + \\cos 1 - e^2).\n$$\n组合成完整的矩阵 $\\exp(A)$：\n$$\n\\exp(A) = \\begin{pmatrix} \\exp(T_{11})  U \\\\ 0  \\exp(T_{22}) \\end{pmatrix} = \\begin{pmatrix} \\cos 1  \\sin 1  \\frac{1}{5}(\\sin 1 - 2\\cos 1 + 2e^2) \\\\ -\\sin 1  \\cos 1  \\frac{1}{5}(2\\sin 1 + \\cos 1 - e^2) \\\\ 0  0  e^2 \\end{pmatrix}.\n$$\n问题要求该矩阵的 $(1,3)$ 元。\n$$\n[\\exp(A)]_{1,3} = \\frac{1}{5} (\\sin 1 - 2\\cos 1 + 2e^2).\n$$\n\n### 关于缩放平方的讨论\n通过幂级数 $\\exp(A) = \\sum_{k=0}^{\\infty} A^k/k!$ 计算矩阵指数时，如果矩阵 $A$ 的范数很大，在有限精度算术中可能会数值不稳定。大的中间项 $A^k/k!$ 在求和时可能导致灾难性抵消。“缩放平方”方法可以缓解这个问题。它基于恒等式 $\\exp(A) = (\\exp(A/s))^s$。\n\n该方法按以下步骤进行：\n1.  **缩放：** 选择一个缩放因子 $s$，通常是 2 的幂，即 $s=2^m$，使得缩放后矩阵的范数 $\\|A/s\\|$ 足够小（例如，小于 1）。整数 $m$ 被选为满足此条件的最小非负整数，针对某个选定的范数（例如，$\\|A\\|_{\\infty}/2^m \\le \\theta$，其中 $\\theta$ 是预定义的阈值）。较小的范数确保了 $\\exp(A/s)$ 的近似值能快速收敛。\n2.  **近似：** 计算 $X_0 = \\exp(A/s)$ 的一个近似值。因为参数 $A/s$ 的范数很小，截断的泰勒级数，或者更稳健地，一个中等阶数的帕德近似（Padé approximant）可以在截断误差很小的情况下提供高精度。\n3.  **平方：** 通过重复平方结果来逆转缩放。如果 $s = 2^m$，那么 $\\exp(A) = (\\exp(A/2^m))^{2^m}$。这通过 $m$ 次矩阵平方来计算：$X_1 = X_0^2$，$X_2 = X_1^2, \\dots, X_m = X_{m-1}^2 = \\exp(A)$。\n\n主要的权衡在于截断误差和舍入误差之间。更大的缩放因子 $s$（即更大的 $m$）会减少初始近似的截断误差，但需要更多的平方步骤。每个平方步骤都可能累积舍入误差，这些误差可能会增长，特别是当中期矩阵 $X_j$ 的范数变大时。选择一个最优的缩放参数 $m$ 和帕德近似的阶数对于一个稳健的算法至关重要，这涉及到平衡这些误差源。缩放平方方法是大多数现代高质量计算矩阵指数的库例程的基础。在舒尔方法的背景下，如果对角块 $\\exp(T_{ii})$ 的范数很大，该技术可用于计算它们的指数。对于给定的问题，$\\|T_{11}\\|_{\\infty} = 1$，因此对于该分块，缩放并非绝对必要，且解析解更优。", "answer": "$$\\boxed{\\frac{1}{5}(\\sin(1) - 2\\cos(1) + 2e^2)}$$", "id": "3596233"}, {"introduction": "在前一个练习的基础上，我们现在从特定的指数函数推广到任意的矩阵函数$f(A)$。舒尔-帕莱特 (Schur–Parlett) 算法是计算这类函数的前沿方法，但其应用并非总是直接了当的。这个问题 [@problem_id:3596160] 深入探讨了该算法的精妙之处，迫使你思考函数$f$的光滑度以及矩阵$A$的特征值结构（例如，重特征值、若尔当块）如何影响算法的有效性和稳定性。这个练习强调了问题的分析性质与数值解的稳健性之间的关键联系，是通向设计可靠数值算法的重要一步。", "problem": "设 $A \\in \\mathbb{C}^{n \\times n}$ 有一个复Schur分解 $U^{*} A U = T$，其中 $U \\in \\mathbb{C}^{n \\times n}$ 是酉矩阵，$T \\in \\mathbb{C}^{n \\times n}$ 是上三角矩阵，其对角线元素等于 $A$ 的特征值。考虑通过解析函数演算构造主矩阵函数 $f(A)$，这要求 $f$ 在包含谱 $\\sigma(A)$ 的一个开集上是全纯的，以及其通过Schur–Parlett方法的数值实现。在Schur–Parlett方法中，通过将 $T$ 处理为分块上三角形式来计算 $f(T)$，以避免在重特征值处出现除以0的情况，并通过求解非对角块的结构化线性系统。假设目标标量函数 $f$ 在 $\\sigma(A)$ 附近或之上存在非解析点（例如分支点或不可微点），并假设 $A$ 可能有重特征值以及可能的非平凡Jordan结构。\n\n关于Schur–Parlett方法如何处理非解析点和重特征值，以及当 $f$ 在谱上不够光滑时的失效模式，以下哪些陈述是正确的？\n\nA. 如果 $f$ 在包含 $\\sigma(A)$ 的一个开集上是解析的，那么将相等或紧密聚集的特征值分组成对角块并应用分块递推可以稳定地得到 $f(A)$；块内的重特征值通过在每个对角块上使用Hermite型构造来评估 $f$ 进行处理，这需要 $f$ 在相应特征值处直到 $m-1$ 阶的导数，其中 $m$ 是该簇中最大Jordan块的大小。\n\nB. 如果 $A$ 有一个与特征值 $\\lambda \\in \\mathbb{C}$ 相关联的大小为 $m$ 的Jordan块，并且 $f$在 $\\lambda$ 处仅连续但不可微，那么分块Parlett递推在计算 $f(A)$ 时仍然会成功，因为它们不需要 $f$ 的导数。\n\nC. 如果 $f$ 有一个分支切割穿过 $\\sigma(A)$（例如，主对数的特征值在负实轴上），Schur方法必然失败，唯一的补救方法是对角化 $A$。\n\nD. 即使当 $f$ 在包含 $\\sigma(A)$ 的一个开集上是解析的，当对角块之间的谱分离很小时，Schur–Parlett递推中的非对角块求解也可能变得高度病态；这种病态性可以通过一个分离度量（如 $\\operatorname{sep}(T_{ii}, T_{jj})$）来量化，并且随着 $\\operatorname{sep}(T_{ii}, T_{jj}) \\to 0$，递推变得不稳定。\n\nE. 对于一个有重特征值但没有非平凡Jordan块的可对角化矩阵 $A$ 而言，仅仅 $f$ 在那些重特征值处缺乏可微性并不会导致Schur–Parlett方法失败，因为通过适当的重排，相应的对角块是 $\\lambda I$，只需要 $f(\\lambda)$ 的值（不需要导数），而非对角递推涉及不同的特征值，因此只需要 $f$ 在不同点上的差商。\n\n选择所有适用的选项。", "solution": "问题陈述已经过验证，被认为是具有科学依据、适定且客观的。它准确地描述了使用Schur-Parlett算法计算主矩阵函数的背景，并就函数 $f$ 的光滑性以及矩阵 $A$ 的结构等不同条件下该算法的行为提出了一个有效的问题。\n\nSchur-Parlett算法的核心是，对于来自Schur分解 $A = U T U^*$ 的给定上三角矩阵 $T$，计算 $F = f(T)$，之后 $f(A) = U F U^*$。矩阵 $F$ 也是上三角矩阵。其对角元素为 $F_{ii} = f(T_{ii})$。非对角元素 $F_{ij}$ 通过求解Sylvester方程得到：\n$$ T_{ii} F_{ij} - F_{ij} T_{jj} = F_{ii} T_{ij} - T_{ij} F_{jj} + \\sum_{k=i+1}^{j-1} (F_{ik} T_{kj} - T_{ik} F_{kj}) $$\n这通常是分块进行的，其中 $T$ 被划分为一个分块上三角矩阵。我们将基于这个框架和矩阵函数的基础理论来评估每个陈述。\n\n**选项A的评估**\n\n该陈述断言，对于一个解析函数 $f$，分块递推是稳定的，并且在对应于重特征值的对角块上计算 $f$ 需要 $f$ 的导数，其阶数由Jordan结构决定。\n\n主矩阵函数 $f(A)$ 的定义依赖于 $f$ 及其导数在 $A$ 的谱 $\\sigma(A)$ 上的值。具体来说，如果一个特征值 $\\lambda_i \\in \\sigma(A)$ 与一个大小为 $m_i$ 的最大Jordan块相关联，那么 $f(A)$ 的定义要求存在导数 $f^{(k)}(\\lambda_i)$，其中 $k = 0, 1, \\dots, m_i-1$。这是因为 $f(A)$ 被定义为 $p(A)$，其中 $p(z)$ 是在 $A$ 的谱上与 $f$ 及其导数相匹配的唯一的最低次Hermite插值多项式。\n\nSchur-Parlett算法是这一定义的数值实现。当特征值病态地接近或相同时，它们被分组成一个单一的对角块，比如说 $T_{kk}$。为了计算 $F_{kk} = f(T_{kk})$，该算法必须使用一种能正确评估该块上函数的方法。如果子矩阵 $T_{kk}$ 是不可对角化的（如果原始矩阵 $A$ 具有与该簇中特征值相关联的非平凡Jordan块，就会发生这种情况），任何计算 $f(T_{kk})$ 的算法都必须隐式或显式地使用 $f$ 的导数。例如，对于 $f(T_{kk})$，其中 $T_{kk} = \\lambda I + N$（$N$ 是严格上三角矩阵），一种基于泰勒的方法会在 $\\lambda$ 周围展开 $f$，这需要导数 $f'(\\lambda), f''(\\lambda), \\dots$。所需的最高阶数对应于 $N$ 的幂零指数，这与 $\\lambda$ 的最大Jordan块的大小有关。因此，需要直到 $m-1$ 阶的导数（其中 $m$ 是最大Jordan块的大小）这一陈述是对该理论的正确表述。\n\n因此，该陈述正确地描述了Schur-Parlett方法如何通过隐式地符合基于Hermite的矩阵函数定义来处理不可对角化的矩阵。\n\n结论：**正确**。\n\n**选项B的评估**\n\n该陈述声称，如果 $f$ 在与大小为 $m > 1$ 的Jordan块相关联的特征值 $\\lambda$ 处仅连续但不可微，分块Parlett递推仍然会成功。\n\n这在根本上是错误的。正如对选项A的解释，如果矩阵 $A$ 对于一个特征值 $\\lambda$ 有一个大小为 $m > 1$ 的Jordan块，主矩阵函数 $f(A)$ 的定义本身就要求 $f$ 在 $\\lambda$ 处至少是 $(m-1)$ 阶可微的。如果 $f$ 在 $\\lambda$ 处不可微，则 $f(A)$ 在标准意义上没有定义。因此，没有算法可以计算它。Schur-Parlett算法将在计算包含特征值 $\\lambda$ 的块 $T_{ii}$ 的 $F_{ii} = f(T_{ii})$ 这一步失败。例如，如果 $T_{ii} = \\begin{pmatrix} \\lambda  1 \\\\ 0  \\lambda \\end{pmatrix}$，那么 $f(T_{ii}) = \\begin{pmatrix} f(\\lambda)  f'(\\lambda) \\\\ 0  f(\\lambda) \\end{pmatrix}$。如果 $f'(\\lambda)$ 不存在，$f(T_{ii})$ 就无法构成。声称递推会成功因为“它们不需要导数”是一种误导性陈述；整个算法需要导数来进行对角块的计算，这是非对角递推的先决条件。\n\n结论：**不正确**。\n\n**选项C的评估**\n\n该陈述声称，如果 $f$ 在 $A$ 的谱上有一个分支切割，Schur方法必然失败，唯一的补救方法是对角化。\n\n这个陈述在多个方面都是不正确的。\n1.  如果一个特征值位于 $f$ 的分支切割上，那么无论使用何种计算方法，函数 $f(A)$ 都是不明确或不适定的。这是一个函数定义的根本性问题，而不是Schur方法的特定失败。人们或许可以通过选择函数的一个特定分支来继续，但这个问题影响所有方法，包括基于对角化或任何其他分解的方法。\n2.  “唯一的补救方法是对角化 $A$”的说法是错误的。首先，并非所有矩阵都是可对角化的。如果 $A$ 有非平凡的Jordan块，它就不能被对角化，所以这种“补救方法”是不可用的。其次，对于可对角化但非正规的矩阵，其特征向量基可能高度病态，使得计算 $f(A) = P f(D) P^{-1}$ 在数值上不稳定。基于酉变换 $U$ 的Schur方法通常在数值上更稳定。\n\n因此，问题在于函数在谱上的定义，而对角化既不是一个普遍适用的解决方案，也不是一个更优的解决方案。\n\n结论：**不正确**。\n\n**选项D的评估**\n\n该陈述讨论了非对角块递推的数值稳定性。递推的核心是求解形如 $T_{ii}X - XT_{jj} = Y$ 的Sylvester方程。\n\n该方程的唯一可解性当且仅当 $T_{ii}$ 和 $T_{jj}$ 的谱不相交时才能得到保证。解 $X$ 对右端项 $Y$ 中扰动的敏感性由Sylvester算子逆的范数决定，该范数与谱的分离度 $\\operatorname{sep}(T_{ii}, T_{jj})$ 成反比。分离度定义为 $\\operatorname{sep}(B,C) = \\min_{\\|X\\|_F=1} \\|BX-XC\\|_F$，其一个下界由来自 $\\sigma(T_{ii})$ 和 $\\sigma(T_{jj})$ 的特征值之间的最小距离给出。\n\n随着 $\\operatorname{sep}(T_{ii}, T_{jj}) \\to 0$，Sylvester方程变得越来越病态，数值误差可能被极大地放大，导致不稳定的计算。这是一个众所周知的性质。Schur-Parlett算法中“分块”策略的全部目的就是重排Schur形式 $T$，以便将彼此接近的特征值分在同一个对角块内。这确保了任意两个不同的对角块 $T_{ii}$ 和 $T_{jj}$ 在谱上是良好分离的，从而使后续的Sylvester求解变得稳定。该陈述准确地描述了算法稳定性的这个基本方面。\n\n结论：**正确**。\n\n**选项E的评估**\n\n该陈述考虑了 $A$ 可对角化但有重特征值的特殊情况。它声称 $f$ 在这些特征值处缺乏可微性对于Schur-Parlett方法来说不是一个问题。\n\n如果一个矩阵 $A$ 是可对角化的，它的最小多项式只有单根。设 $T=U^*AU$ 是 $A$ 的一个Schur形式。那么 $T$ 与 $A$ 相似，也必须是可对角化的。让我们考虑 $T$ 的一个对角块 $T_{ii}$，该块是通过重排将所有等于同一个值 $\\lambda$ 的特征值组合在一起得到的。$T_{ii}$ 是一个上三角矩阵，其对角元素全为 $\\lambda$。$T_{ii}$ 的最小多项式必须是 $(t-\\lambda)^s$ 的形式，其中 $s \\ge 1$ 是某个整数。由于 $T_{ii}$ 是一个与 $A$ 相似的分块三角矩阵的子矩阵，它也必须是可对角化的。一个上三角矩阵是可对角化的当且仅当它已经是-对角矩阵。等等，这只适用于正规矩阵。正确的论证是，$T_{ii}$ 的最小多项式必须整除 $A$ 的最小多项式。由于后者只有单根，所以 $T_{ii}$ 的最小多项式必须是 $(t-\\lambda)^1$。一个最小多项式为 $t-\\lambda$ 的矩阵 $M$ 必须满足 $M-\\lambda I = 0$，这意味着 $M=\\lambda I$。\n因此，相应的对角块可以被构造成 $T_{ii} = \\lambda I_k$，其中 $k$ 是 $\\lambda$ 的重数。\n\n为了计算 $F_{ii} = f(T_{ii})$，我们简单地得到 $F_{ii} = f(\\lambda I_k) = f(\\lambda) I_k$。这个计算只需要 $f$ 在 $\\lambda$ 处的值，而不需要任何导数。\n非对角递推将涉及连接具有不同特征值（例如，一个用于 $\\lambda$ 的块和一个用于 $\\mu$ 的块，其中 $\\lambda \\neq \\mu$）的块的Sylvester方程。这些方程的解涉及 $f$ 的差商，例如 $f[\\lambda, \\mu] = (f(\\lambda) - f(\\mu))/(\\lambda - \\mu)$，只要 $f$ 在 $\\lambda$ 和 $\\mu$ 处有定义，这些差商就是良定义的。\n\n因此，对于一个可对角化的矩阵，Schur-Parlett算法避免了对导数的需要，即使对于重特征值也是如此，因为矩阵的结构保证了相应的Schur块是对角的。该陈述是完全正确的。\n\n结论：**正确**。", "answer": "$$\\boxed{ADE}$$", "id": "3596160"}]}