{"hands_on_practices": [{"introduction": "Cholesky 分解是处理对称正定 (SPD) 矩阵的基石，但在实际应用中，矩阵时常会发生变化。本练习探讨了当一个 SPD 矩阵经历秩一扰动 $A \\to A + u u^{T}$ 时，如何从第一性原理出发推导其 Cholesky 因子的更新算法。这不仅是学习一个高效的计算技巧，更是深入理解矩阵结构如何在代数运算中得以保持和转化的绝佳机会。", "problem": "设 $A \\in \\mathbb{R}^{n \\times n}$ 是一个对称正定矩阵，且设 $L \\in \\mathbb{R}^{n \\times n}$ 是满足 $L L^{T} = A$ 的唯一的对角线元素为正的下三角 Cholesky 因子。对于一个给定的非零向量 $u \\in \\mathbb{R}^{n}$，考虑秩一扰动 $A + u u^{T}$。\n\n- 首先，仅从对称性、正定性和 Cholesky 分解的定义出发，证明 $A + u u^{T}$ 是对称正定的。\n\n- 其次，从第一性原理推导一个数值稳定的秩一 Cholesky 更新算法，该算法通过一系列初等运算将 $L$ 变换为 $\\tilde{L}$，生成一个对角线元素为正的下三角矩阵 $\\tilde{L}$，使得 $\\tilde{L} \\tilde{L}^{T} = A + u u^{T}$。你的推导必须从恒等式 $A + u u^{T} = L \\left(I + y y^{T}\\right) L^{T}$（其中 $y \\in \\mathbb{R}^{n}$ 是一个适当定义的向量）开始，并且必须证明在每个更新步骤中保持的代数不变量。不要引用或假设任何黑盒更新程序；请显式地推导这些变换。\n\n- 最后，利用你的推导，得到行列式比值 $\\det(A + u u^{T}) / \\det(A)$ 的闭式表达式，该表达式仅用 $A$ 和 $u$ 表示。将你的最终答案表示为单个解析表达式。不需要进行数值取整，也不涉及任何单位。", "solution": "该问题被评估为有效，因为它在数值线性代数方面有科学依据，是适定且客观的。它为一个关于矩阵分解的标准、非平凡问题提供了一个完整且一致的设定。\n\n解答按照题目要求分为三个部分。\n\n### 第1部分：证明 $A + u u^{T}$ 是对称正定的\n\n设给定矩阵为 $A' = A + u u^{T}$。\n\n**对称性：**\n如果一个矩阵 $M$ 满足 $M^T = M$，则该矩阵是对称的。我们对 $A'$ 进行检验。\n$$ (A')^T = (A + u u^{T})^T $$\n利用和的转置等于转置的和这一性质：\n$$ (A')^T = A^T + (u u^{T})^T $$\n已知 $A$ 是对称的，所以 $A^T = A$。对于秩一项，矩阵（或向量）乘积的转置等于其转置的逆序乘积：\n$$ (u u^{T})^T = (u^T)^T u^T = u u^T $$\n将这些代回，我们得到：\n$$ (A')^T = A + u u^{T} = A' $$\n因此，$A + u u^{T}$ 是一个对称矩阵。\n\n**正定性：**\n如果对于任意非零向量 $x \\in \\mathbb{R}^n$，二次型 $x^T M x$ 严格为正，那么对称矩阵 $M$ 是正定的。我们对 $A'$ 进行检验。\n设 $x \\in \\mathbb{R}^n$ 是一个任意非零向量，$x \\neq 0$。\n$$ x^T A' x = x^T (A + u u^{T}) x $$\n利用矩阵乘法的分配律：\n$$ x^T A' x = x^T A x + x^T (u u^{T}) x $$\n我们分析右侧的两项。\n1.  因为已知 $A$ 是正定的且 $x \\neq 0$，我们知道 $x^T A x  0$。\n2.  第二项可以重新组合。由于 $x^T u$ 是一个标量（$x$ 和 $u$ 的点积），我们可以写成：\n    $$ x^T u u^T x = (x^T u) (u^T x) $$\n    标量的转置是其本身，所以 $(x^T u)^T = u^T x$。设 $\\alpha = u^T x$。那么该表达式为 $\\alpha^T \\alpha = \\alpha^2$。\n    $$ x^T u u^T x = (u^T x)^2 $$\n    任何实数的平方都是非负的，所以 $(u^T x)^2 \\ge 0$。\n\n结合这些结果，我们有：\n$$ x^T A' x = x^T A x + (u^T x)^2 $$\n因为 $x^T A x  0$ 且 $(u^T x)^2 \\ge 0$，它们的和必定严格为正：\n$$ x^T A' x  0 $$\n这对任何非零 $x \\in \\mathbb{R}^n$ 都成立。因此，$A + u u^{T}$ 是正定的。\n\n### 第2部分：秩一 Cholesky 更新算法的推导\n\n我们的任务是推导一个算法，从 $A$ 的 Cholesky 因子 $L$（其中 $LL^T=A$）出发，找到 $A' = A + u u^T$ 的 Cholesky 因子 $\\tilde{L}$（其中 $\\tilde{L}\\tilde{L}^T = A'$）。推导从恒等式 $A' = L(I+yy^T)L^T$ 开始。\n\n首先，我们确定向量 $y$。\n$$ A + u u^T = L L^T + u u^T = L(I + y y^T) L^T = L L^T + L y y^T L^T $$\n这意味着 $u u^T = L y y^T L^T = (L y) (L y)^T$。由于 $u \\neq 0$，我们可以得出结论：$L y$ 是 $u$ 的标量倍数。取 $L y = u$（另一种选择是 $L y = -u$），并且因为 $A$ 是正定的，$L$ 是可逆的。因此，通过求解下三角系统 $L y = u$ 来解出 $y$ 是唯一确定的，这等价于 $y = L^{-1} u$。\n\n问题在于找到一个对角线元素为正的下三角矩阵 $\\tilde{L}$，使得 $\\tilde{L}\\tilde{L}^T = A+uu^T$。我们将推导一个算法，通过递归更新 $L$ 和一个初始化为 $u$ 的向量 $p$ 来逐列构造 $\\tilde{L}$。\n\n控制方程为 $\\tilde{L}\\tilde{L}^T = LL^T + pp^T$，初始时 $p=u$。\n让我们按第一行和第一列对矩阵进行分块。设 $j=1$。\n$$ L = \\begin{pmatrix} l_{11}  0 \\\\ l_{2:n,1}  L_{22} \\end{pmatrix}, \\quad p = \\begin{pmatrix} p_1 \\\\ p_{2:n} \\end{pmatrix}, \\quad \\tilde{L} = \\begin{pmatrix} \\tilde{l}_{11}  0 \\\\ \\tilde{l}_{2:n,1}  \\tilde{L}_{22} \\end{pmatrix} $$\n其中 $L_{22}$ 和 $\\tilde{L}_{22}$ 是 $(n-1) \\times (n-1)$ 的下三角矩阵。\n将这些代入方程 $\\tilde{L}\\tilde{L}^T = LL^T + pp^T$ 中：\n$$ \\begin{pmatrix} \\tilde{l}_{11}^2  \\tilde{l}_{11} \\tilde{l}_{2:n,1}^T \\\\ \\tilde{l}_{11} \\tilde{l}_{2:n,1}  \\tilde{l}_{2:n,1}\\tilde{l}_{2:n,1}^T + \\tilde{L}_{22}\\tilde{L}_{22}^T \\end{pmatrix} = \\begin{pmatrix} l_{11}^2 + p_1^2  l_{11} l_{2:n,1}^T + p_1 p_{2:n}^T \\\\ l_{11} l_{2:n,1} + p_1 p_{2:n}  l_{2:n,1}l_{2:n,1}^T + L_{22}L_{22}^T + p_{2:n}p_{2:n}^T \\end{pmatrix} $$\n通过令各个分块相等，我们可以确定 $\\tilde{L}$ 的第一列以及关于 $\\tilde{L}_{22}$ 的新问题。\n\n1.  从 $(1,1)$ 块：\n    $\\tilde{l}_{11}^2 = l_{11}^2 + p_1^2$。由于对角线元素必须为正，$\\tilde{l}_{11} = \\sqrt{l_{11}^2 + p_1^2}$。\n\n2.  从 $(2,1)$ 块：\n    $\\tilde{l}_{11} \\tilde{l}_{2:n,1} = l_{11} l_{2:n,1} + p_1 p_{2:n}$。\n    这给出了 $\\tilde{L}$ 第一列的其余部分：$\\tilde{l}_{2:n,1} = \\frac{1}{\\tilde{l}_{11}}(l_{11} l_{2:n,1} + p_1 p_{2:n})$。\n    我们可以将其写成一个平面旋转。设 $r = \\tilde{l}_{11}$，并定义 $c = l_{11}/r$ 和 $s=p_1/r$。那么 $c^2+s^2=1$。更新公式为 $\\tilde{l}_{2:n,1} = c l_{2:n,1} + s p_{2:n}$。\n\n3.  从 $(2,2)$ 块：\n    $\\tilde{l}_{2:n,1}\\tilde{l}_{2:n,1}^T + \\tilde{L}_{22}\\tilde{L}_{22}^T = l_{2:n,1}l_{2:n,1}^T + L_{22}L_{22}^T + p_{2:n}p_{2:n}^T$。\n    我们需要找到关于 $\\tilde{L}_{22}$ 的方程。\n    $\\tilde{L}_{22}\\tilde{L}_{22}^T = L_{22}L_{22}^T + (l_{2:n,1}l_{2:n,1}^T - \\tilde{l}_{2:n,1}\\tilde{l}_{2:n,1}^T + p_{2:n}p_{2:n}^T)$。\n    让我们分析秩一更新：\n    $l_{2:n,1}l_{2:n,1}^T - (c l_{2:n,1} + s p_{2:n})(c l_{2:n,1} + s p_{2:n})^T + p_{2:n}p_{2:n}^T$\n    $= l_2l_2^T - (c^2 l_2l_2^T + s^2 p_2p_2^T + cs(l_2p_2^T+p_2l_2^T)) + p_2p_2^T$  (其中 $l_2=l_{2:n,1}, p_2=p_{2:n}$)\n    $= (1-c^2) l_2l_2^T + (1-s^2) p_2p_2^T - cs(l_2p_2^T+p_2l_2^T)$\n    利用 $1-c^2=s^2$ 和 $1-s^2=c^2$：\n    $= s^2 l_2l_2^T + c^2 p_2p_2^T - cs(l_2p_2^T+p_2l_2^T)$\n    $= (c p_2 - s l_2)(c p_2 - s l_2)^T$。\n    设 $p' = c p_{2:n} - s l_{2:n,1}$。这是用于递归步骤的更新后的向量。\n\n现在递归步骤就很清楚了。我们有 $\\tilde{L}_{22}\\tilde{L}_{22}^T = L_{22}L_{22}^T + p'(p')^T$。这是一个大小为 $(n-1) \\times (n-1)$ 的 Cholesky 更新问题。这种递归结构定义了该算法。\n\n**算法：**\n初始化 $p \\leftarrow u$。矩阵 $\\tilde{L}$ 将覆盖 $L$。\n对于 $j = 1, \\dots, n$：\n1.  设 $l_{jj}$ 是演化中的 $L$ 矩阵的当前第 $j$ 个对角线元素， $p_j$ 是演化中的向量 $p$ 的第 $j$ 个分量。\n2.  计算旋转参数：\n    $r = \\sqrt{l_{jj}^2 + p_j^2}$\n    $c = l_{jj} / r$\n    $s = p_j / r$\n3.  更新新因子的对角线元素：$\\tilde{l}_{jj} = r$。\n4.  对于从 $j+1$ 到 $n$ 的元素 $i$，更新第 $j$ 列的其余部分和向量 $p$：\n    设 $l_{ij\\_old} = l_{ij}$ 和 $p_{i\\_old} = p_i$。\n    $\\tilde{l}_{ij} = c \\cdot l_{ij\\_old} + s \\cdot p_{i\\_old}$\n    $p_i = c \\cdot p_{i\\_old} - s \\cdot l_{ij\\_old}$\n循环结束后，得到的下三角矩阵即为 $\\tilde{L}$。此推导证明了 $\\tilde{L}\\tilde{L}^T = A+uu^T$，并通过将问题简化为更小规模的问题来在每一步保持不变量。这构成了一系列应用于 $L$ 的列和向量 $p$ 的初等旋转运算。\n\n### 第3部分：行列式比值的表达式\n\n我们需要求出比值 $\\det(A + u u^{T}) / \\det(A)$。该推导将源于第2部分中使用的相同基本原理。\n从第2部分可知，我们从恒等式 $A + u u^T = L(I + y y^T)L^T$ 开始，其中 $y = L^{-1} u$。\n我们可以计算两边的行列式：\n$$ \\det(A + u u^T) = \\det(L(I + y y^T)L^T) $$\n利用性质 $\\det(XYZ) = \\det(X)\\det(Y)\\det(Z)$：\n$$ \\det(A + u u^T) = \\det(L) \\det(I + y y^T) \\det(L^T) $$\n由于 $\\det(L^T) = \\det(L)$，上式变为：\n$$ \\det(A + u u^T) = (\\det(L))^2 \\det(I + y y^T) $$\n我们知道原始矩阵 $A$ 的行列式为 $\\det(A) = \\det(LL^T) = (\\det(L))^2$。\n将此代入方程中：\n$$ \\det(A + u u^T) = \\det(A) \\det(I + y y^T) $$\n因此，所求的比值为：\n$$ \\frac{\\det(A + u u^T)}{\\det(A)} = \\det(I + y y^T) $$\n为了计算 $\\det(I + y y^T)$，我们使用 Sylvester 行列式恒等式，该恒等式表明，对于任意 $B \\in \\mathbb{R}^{n \\times m}$ 和 $C \\in \\mathbb{R}^{m \\times n}$，有 $\\det(I_n + BC) = \\det(I_m + CB)$。\n在我们的例子中，我们可以设 $B=y$（一个 $n \\times 1$ 矩阵）和 $C=y^T$（一个 $1 \\times n$ 矩阵）。\n$$ \\det(I_n + y y^T) = \\det(I_1 + y^T y) $$\n$y^T y$ 是一个 $1 \\times 1$ 矩阵，即一个标量。所以 $\\det(I_1 + y^T y) = 1 + y^T y$。\n因此，该比值为：\n$$ \\frac{\\det(A + u u^T)}{\\det(A)} = 1 + y^T y $$\n最后，我们将 $y$ 的定义代回。我们定义了 $y = L^{-1}u$。\n$$ y^T y = (L^{-1}u)^T (L^{-1}u) = u^T (L^{-1})^T L^{-1} = u^T (L^T)^{-1} L^{-1} $$\n利用性质 $(XY)^{-1} = Y^{-1}X^{-1}$，我们有 $(LL^T)^{-1} = (L^T)^{-1}L^{-1}$。由于 $A=LL^T$，这便是 $A^{-1}$。\n$$ y^T y = u^T A^{-1} u $$\n所以，行列式比值的最终闭式表达式为：\n$$ \\frac{\\det(A + u u^T)}{\\det(A)} = 1 + u^T A^{-1} u $$", "answer": "$$ \\boxed{1 + u^T A^{-1} u} $$", "id": "3581983"}, {"introduction": "拥有一个有效的分解算法只是第一步，理解其数值稳定性同样至关重要。本练习通过一个精心设计的案例，展示了一个看似“良性”的 SPD 矩阵，在未经妥善排序的情况下进行 Cholesky 分解，竟会导致灾难性的精度损失。通过分析和比较不同消元顺序下的主元增长情况，你将深刻体会到算法选择与矩阵排序在保证计算结果可靠性方面的核心作用。", "problem": "设 $m \\in \\mathbb{N}$ 且 $m \\geq 2$，并设 $w  0$, $\\varepsilon  0$ 以及 $\\delta  0$。考虑 $(m+1) \\times (m+1)$ 的实对称矩阵\n$$\nA \\;=\\; \\begin{pmatrix}\na I_{m}  -w \\mathbf{1} \\\\\n-w \\mathbf{1}^{\\mathsf{T}}  b\n\\end{pmatrix},\n$$\n其中 $\\mathbf{1} \\in \\mathbb{R}^{m}$ 表示全1向量，$I_{m}$ 是 $m \\times m$ 的单位矩阵，参数 $a$ 和 $b$ 定义为\n$$\na \\;=\\; w + \\varepsilon, \\qquad b \\;=\\; m w + \\delta.\n$$\n您可以将以下定义和事实作为基础：如果一个矩阵是对称的，并且对于所有非零向量 $x$ 都有 $x^{\\mathsf{T}} A x  0$，则该矩阵是对称正定（SPD）的；如果对于每一行 $i$ 都有 $|a_{ii}|  \\sum_{j \\neq i} |a_{ij}|$，则该矩阵是严格行对角占优的；一个 SPD 矩阵 $A$ 的不选主元的 Cholesky 分解产生 $A = L L^{\\mathsf{T}}$，其中 $L$ 是下三角矩阵，其对角线“主元”是按指定顺序消去索引时遇到的 Schur 补的连续对角元素（等价地，在对称置换 $P$ 之后，将相同的算法应用于 $P^{\\mathsf{T}} A P$）。\n\n任务：\n- 从上述基础出发，证明 $A$ 是严格行对角占优且 SPD 的。\n- 分析应用于 $A$ 的不选主元的 Cholesky 分解的两种排序：\n  1. “叶节点优先”排序，它在中心节点索引（标量块 $b$）之前消去 $m$ 个叶节点索引（与 $a I_{m}$ 相关的块）。\n  2. “中心节点优先”排序，它在 $m$ 个叶节点之前消去中心节点索引。\n- 从第一性原理出发，推导在叶节点优先排序下的精确主元序列，并说明它如何依赖于 $(m,w,\\varepsilon,\\delta)$。用此将一个排序的主元增长因子 $\\gamma$ 定义为\n$$\n\\gamma \\;=\\; \\frac{\\max\\{\\text{pivots over all steps}\\}}{\\min\\{\\text{pivots over all steps}\\}}.\n$$\n- 利用 Schur 补的结构和适当的不等式，解释为什么中心节点优先排序解决了叶节点优先排序下存在的不稳定性，即对于相同的 $(m,w,\\varepsilon,\\delta)$，其主元增长因子要小得多。\n\n对于具体参数 $m = 50$, $w = 1000$, $\\varepsilon = 10^{-3}$, and $\\delta = 10^{-6}$，计算叶节点优先排序的主元增长因子 $\\gamma$。将您的答案四舍五入到四位有效数字。", "solution": "用户需要对给定的对称矩阵 $A$ 进行详细分析，包括其性质的证明、Cholesky 分解的两种不同排序的分析以及数值计算。\n\n### 问题验证\n\n问题陈述已经过验证，并被认为是有效的。它在数值线性代数方面有科学依据，信息充分、问题明确，并以客观、正式的语言表达。其前提是一致的，并导出一个可解的问题。\n\n### 第1部分：严格对角占优（SDD）和对称正定性（SPD）\n\n矩阵 $A$ 是一个 $(m+1) \\times (m+1)$ 的分块矩阵：\n$$\nA \\;=\\; \\begin{pmatrix}\na I_{m}  -w \\mathbf{1} \\\\\n-w \\mathbf{1}^{\\mathsf{T}}  b\n\\end{pmatrix}\n$$\n其中 $a = w + \\varepsilon$ 且 $b = m w + \\delta$，并且 $m \\geq 2$, $w  0$, $\\varepsilon  0$, $\\delta  0$。\n\n**严格对角占优（SDD）**\n如果对于每一行 $i$，对角元素 $|A_{ii}|$ 的绝对值大于该行非对角元素绝对值之和 $\\sum_{j \\neq i} |A_{ij}|$，则该矩阵是严格行对角占优的。\n\n1.  对于前 $m$ 行（$i \\in \\{1, \\dots, m\\}$）：\n    对角元素为 $A_{ii} = a = w + \\varepsilon$。\n    第 $i$ 行的非对角元素为，当 $j \\in \\{1, \\dots, m\\}$ 且 $j \\neq i$ 时，$A_{ij} = 0$；以及 $A_{i, m+1} = -w$。\n    SDD 的条件是 $|A_{ii}|  \\sum_{j \\neq i} |A_{ij}|$。\n    $$|w + \\varepsilon|  |-w| + \\sum_{j=1, j\\neq i}^{m} |0|$$\n    由于 $w  0$ 且 $\\varepsilon  0$，这简化为：\n    $$w + \\varepsilon  w$$\n    这是成立的，因为 $\\varepsilon  0$。\n\n2.  对于最后一行（$i = m+1$）：\n    对角元素为 $A_{m+1, m+1} = b = m w + \\delta$。\n    非对角元素为 $A_{m+1, j} = -w$，其中 $j \\in \\{1, \\dots, m\\}$。\n    SDD 的条件是 $|A_{m+1, m+1}|  \\sum_{j=1}^{m} |A_{m+1, j}|$。\n    $$|m w + \\delta|  \\sum_{j=1}^{m} |-w| = \\sum_{j=1}^{m} w = m w$$\n    由于 $m, w, \\delta  0$，这简化为：\n    $$m w + \\delta  m w$$\n    这是成立的，因为 $\\delta  0$。\n\n由于该条件对所有行都成立，矩阵 $A$ 是严格对角占优的。\n\n**对称正定性（SPD）**\n如果一个矩阵是对称的，并且其关联的二次型 $x^{\\mathsf{T}} A x$ 对所有非零向量 $x$ 均为正，则该矩阵是 SPD 的。\n矩阵 $A$ 已知为实对称矩阵。我们也可以使用这样一个性质：一个具有正对角元素且严格对角占优的对称矩阵也是正定的。\n对角元素为 $a = w + \\varepsilon  0$ 和 $b = m w + \\delta  0$。\n由于 $A$ 是对称的，具有正对角元素，并且是严格对角占优的，所以 $A$ 是 SPD 的。\n\n或者，我们可以直接分析二次型。设 $x = \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix}$，其中 $x_1 \\in \\mathbb{R}^m$ 且 $x_2 \\in \\mathbb{R}$。\n\\begin{align*} x^{\\mathsf{T}} A x = \\begin{pmatrix} x_1^{\\mathsf{T}}  x_2 \\end{pmatrix} \\begin{pmatrix} (w+\\varepsilon) I_m  -w \\mathbf{1} \\\\ -w \\mathbf{1}^{\\mathsf{T}}  mw+\\delta \\end{pmatrix} \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix} \\\\ = (w+\\varepsilon) x_1^{\\mathsf{T}} x_1 - 2w x_2 (x_1^{\\mathsf{T}} \\mathbf{1}) + (mw+\\delta) x_2^2 \\\\ = (w+\\varepsilon) \\sum_{i=1}^m x_{1,i}^2 - 2w x_2 \\sum_{i=1}^m x_{1,i} + (mw+\\delta) x_2^2 \\\\ = w \\sum_{i=1}^m x_{1,i}^2 - 2w x_2 \\sum_{i=1}^m x_{1,i} + m w x_2^2 + \\varepsilon \\sum_{i=1}^m x_{1,i}^2 + \\delta x_2^2\\end{align*}\n前三项可以通过配方法重新组合：\n$$w \\left( \\sum_{i=1}^m x_{1,i}^2 - 2x_2 \\sum_{i=1}^m x_{1,i} + m x_2^2 \\right) = w \\sum_{i=1}^m (x_{1,i}^2 - 2x_{1,i}x_2 + x_2^2) = w \\sum_{i=1}^m (x_{1,i} - x_2)^2$$\n所以，二次型为：\n$$x^{\\mathsf{T}} A x = w \\sum_{i=1}^m (x_{1,i} - x_2)^2 + \\varepsilon \\sum_{i=1}^m x_{1,i}^2 + \\delta x_2^2$$\n由于 $w  0$, $\\varepsilon  0$ 且 $\\delta  0$，所有三项都是非负的。其和为零当且仅当每一项都为零。\n1. $\\delta x_2^2 = 0 \\implies x_2 = 0$。\n2. $\\varepsilon \\sum x_{1,i}^2 = 0 \\implies x_1 = \\mathbf{0}$。\n3. 如果 $x_1 = \\mathbf{0}$ 且 $x_2=0$，那么 $w \\sum (x_{1,i} - x_2)^2 = 0$ 也成立。\n因此，对于所有非零向量 $x$，$x^{\\mathsf{T}} A x  0$，这证明了 $A$ 是 SPD 的。\n\n### 第2部分：叶节点优先排序分析\n\n在这种排序中，我们在第 $(m+1)$ 个索引（“中心节点”）之前消去前 $m$ 个索引（“叶节点”）。不选主元的 Cholesky 分解的主元 $p_k$ 是每一步形成的 Schur 补的对角元素。这等价于在 $LDL^{\\mathsf{T}}$ 分解中找到矩阵 $D$ 的对角元素。\n\n$A$ 的前 $m$ 行和前 $m$ 列形成一个对角块 $aI_m$。\n我们来追踪消元过程：\n- **第1步**：第一个主元是 $p_1 = A_{11} = a$。消去第一个变量会更新与索引 $\\{2, \\dots, m+1\\}$ 对应的 $(m) \\times (m)$ 子矩阵。唯一涉及索引 $1$ 的非对角元素是 $A_{m+1,1}=-w$。矩阵更新只影响元素 $A_{m+1,m+1}$。\n新的元素变为 $A'_{m+1,m+1} = A_{m+1,m+1} - \\frac{A_{m+1,1} A_{1,m+1}}{A_{11}} = b - \\frac{(-w)(-w)}{a} = b - \\frac{w^2}{a}$。矩阵的其余部分保持不变。\n- **第2步**：索引 $\\{2, \\dots, m+1\\}$ 的子矩阵具有与 $A$ 相同的结构，但有 $m-1$ 个叶节点和一个修改后的中心节点值。主元是 $p_2 = A_{22} = a$。中心节点元素再次被更新：$b - \\frac{w^2}{a} - \\frac{w^2}{a} = b - 2\\frac{w^2}{a}$。\n- **第k步** ($k \\leq m$)：这个模式继续下去。前 $m$ 个主元是相同的。\n$$p_k = a = w+\\varepsilon, \\quad \\text{for } k=1, \\dots, m.$$\n消去前 $m$ 个变量后，最后的 Schur 补是一个 $1 \\times 1$ 矩阵，其元素是最后一个主元 $p_{m+1}$。在每一步 $k \\in \\{1, \\dots, m\\}$，中心节点元素减少 $w^2/a$。经过 $m$ 步后，它变为：\n$$p_{m+1} = b - \\sum_{k=1}^m \\frac{w^2}{a} = b - \\frac{m w^2}{a}$$\n代入 $a$ 和 $b$ 的表达式：\n$$p_{m+1} = (mw+\\delta) - \\frac{mw^2}{w+\\varepsilon} = \\frac{(mw+\\delta)(w+\\varepsilon) - mw^2}{w+\\varepsilon}$$\n$$p_{m+1} = \\frac{mw^2 + mw\\varepsilon + \\delta w + \\delta \\varepsilon - mw^2}{w+\\varepsilon} = \\frac{mw\\varepsilon + \\delta w + \\delta\\varepsilon}{w+\\varepsilon}$$\n主元序列为 $\\{p_1, \\dots, p_m, p_{m+1}\\} = \\{a, \\dots, a, p_{m+1}\\}$。\n\n**主元增长因子 $\\gamma$**\n主元增长因子是 $\\gamma = \\frac{\\max\\{\\text{pivots}\\}}{\\min\\{\\text{pivots}\\}}$。我们来比较 $a$ 和 $p_{m+1}$。\n给定参数通常涉及相对于 $w$ 较小的 $\\varepsilon$ 和 $\\delta$。在这种情况下：\n$a = w + \\varepsilon \\approx w$。\n$p_{m+1} \\approx \\frac{mw\\varepsilon + \\delta w}{w} = m\\varepsilon + \\delta$。\n对于典型值（$m=50, w=1000, \\varepsilon=10^{-3}, \\delta=10^{-6}$），$a \\approx 1000$ 而 $p_{m+1} \\approx 50 \\times 10^{-3} = 0.05$。因此，$a$ 远大于 $p_{m+1}$。\n$$\\gamma_{\\text{leaves-first}} = \\frac{a}{p_{m+1}} = \\frac{(w+\\varepsilon)}{\\frac{mw\\varepsilon + \\delta w + \\delta\\varepsilon}{w+\\varepsilon}} = \\frac{(w+\\varepsilon)^2}{mw\\varepsilon + \\delta w + \\delta\\varepsilon}$$\n这种排序的不稳定性在于 $p_{m+1}$ 的计算。它是通过两个大而几乎相等的数之差计算出来的：$b \\approx mw$ 和 $\\frac{mw^2}{a} \\approx \\frac{mw^2}{w} = mw$。这会导致浮点运算中的灾难性抵消，从而产生具有高相对误差的结果。\n\n### 第3部分：中心节点优先排序分析\n\n在这里，我们置换矩阵以首先消去中心节点索引（最初是 $m+1$）。重新排序的矩阵 $A'$ 是：\n$$A' = \\begin{pmatrix} b  -w \\mathbf{1}^{\\mathsf{T}} \\\\ -w \\mathbf{1}  a I_m \\end{pmatrix}$$\n第一个主元是 $p'_1 = b = mw+\\delta$。\n消去第一个变量后的 Schur 补 $S'$ 是：\n$$S' = (a I_m) - (-w \\mathbf{1}) (b^{-1}) (-w \\mathbf{1}^{\\mathsf{T}}) = a I_m - \\frac{w^2}{b} \\mathbf{1}\\mathbf{1}^{\\mathsf{T}}$$\n$S'$ 是一个 $m \\times m$ 矩阵，其对角元素为 $a - \\frac{w^2}{b}$，非对角元素为 $-\\frac{w^2}{b}$。\n\n中心节点优先排序解决了叶节点优先排序中存在的不稳定性。关键原因不在于其主元增长因子 $\\gamma$ 必定更小（它可能更大），而在于主元的*计算*是数值稳定的。\n\n在叶节点优先方案中，小主元 $p_{m+1}$ 是通过一次不稳定的减法（$b - mw^2/a$）计算的。\n在中心节点优先方案中，在第一个主元 $p'_1=b$ 之后，剩余的主元通过分解 Schur 补 $S'$ 获得。矩阵 $S'$ 的对角元素为 $S'_{ii} = a - w^2/b$，非对角元素为 $S'_{ij} = -w^2/b$。\n我们来检查 $S'$ 的对角占优性：\n$$|S'_{ii}|  \\sum_{j\\neq i} |S'_{ij}| \\quad \\iff \\quad \\left|a - \\frac{w^2}{b}\\right|  (m-1) \\left|-\\frac{w^2}{b}\\right|$$\n由于 $A$ 是 SPD 的，其主子矩阵也是 SPD 的，所以 $p'_2=a-w^2/b  0$。不等式变为：\n$$a - \\frac{w^2}{b}  (m-1)\\frac{w^2}{b} \\quad \\iff \\quad a  \\frac{mw^2}{b}$$\n代入 $a=w+\\varepsilon$ 和 $b=mw+\\delta$：\n$$(w+\\varepsilon)  \\frac{mw^2}{mw+\\delta} \\quad \\iff \\quad (w+\\varepsilon)(mw+\\delta)  mw^2$$\n$$mw^2 + w\\delta + mw\\varepsilon + \\varepsilon\\delta  mw^2 \\quad \\iff \\quad w\\delta + mw\\varepsilon + \\varepsilon\\delta  0$$\n最后一个不等式是成立的，因为 $m, w, \\varepsilon, \\delta$ 都是正数。\n因此，Schur 补 $S'$ 是严格对角占优的。对一个严格对角占优矩阵进行不选主元的 Cholesky 分解是一个数值稳定的过程。乘子都很小（绝对值都小于1），这可以防止误差传播和后续 Schur 补中元素的增长。所有主元都是通过稳定的运算计算的，避免了在叶节点优先方法中看到的灾难性抵消。\n\n总之，中心节点优先排序是“稳定的”，因为它将问题转化为对一个新的、表现良好（严格对角占优）的矩阵 $S'$ 进行分解，其中所有后续的主元都是稳定计算的。\n\n### 第4部分：数值计算\n\n对于参数 $m = 50$, $w = 1000$, $\\varepsilon = 10^{-3}$, and $\\delta = 10^{-6}$，我们计算叶节点优先排序的主元增长因子 $\\gamma$。\n\n$$ \\gamma = \\frac{(w+\\varepsilon)^2}{mw\\varepsilon + \\delta w + \\delta\\varepsilon} $$\n首先，我们计算表达式中的各项：\n- $w+\\varepsilon = 1000 + 10^{-3} = 1000.001$\n- $(w+\\varepsilon)^2 = (1000.001)^2 = 1000002.000001$\n- $mw\\varepsilon = 50 \\times 1000 \\times 10^{-3} = 50$\n- $\\delta w = 10^{-6} \\times 1000 = 10^{-3} = 0.001$\n- $\\delta\\varepsilon = 10^{-6} \\times 10^{-3} = 10^{-9} = 0.000000001$\n分母是：\n$$50 + 0.001 + 0.000000001 = 50.001000001$$\n现在，我们计算 $\\gamma$：\n$$\\gamma = \\frac{1000002.000001}{50.001000001} \\approx 19999.600008$$\n将结果四舍五入到四位有效数字：\n$$\\gamma \\approx 2.000 \\times 10^4$$", "answer": "$$\\boxed{2.000 \\times 10^{4}}$$", "id": "3582017"}, {"introduction": "对于无法使用直接法求解的大规模稀疏线性系统，迭代法是关键所在。本练习将引导你手动执行共轭梯度法 (CG) 的前几步，这是求解 SPD 系统的首选迭代方法。通过亲手计算残差、步长以及 $A$-共轭搜索方向，你将对该算法的内在机制建立起一个具体而直观的认识，为解决更复杂的科学与工程问题打下基础。", "problem": "设 $A \\in \\mathbb{R}^{3 \\times 3}$ 是对称正定 (SPD) 矩阵，其中\n$$\nA \\;=\\; \\begin{pmatrix}\n4  1  0 \\\\\n1  3  1 \\\\\n0  1  2\n\\end{pmatrix},\n\\qquad\nb \\;=\\; \\begin{pmatrix} 4 \\\\ 2 \\\\ 2 \\end{pmatrix}.\n$$\n考虑从初始猜测 $x_{0} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$ 开始，使用共轭梯度 (CG) 方法求解线性系统 $A x = b$。在基于 SPD 系统第一原理的标准框架内进行计算：二次泛函 $\\phi(x) = \\tfrac{1}{2} x^{\\mathsf{T}} A x - b^{\\mathsf{T}} x$，残差 $r_{k} = b - A x_{k}$，$A$-共轭搜索方向 $\\{p_{k}\\}$，以及沿 $x_{k} + \\alpha p_{k}$ 的精确线搜索以确定步长。手动执行共轭梯度法的两次迭代（即 $k = 0$ 和 $k = 1$），在每次迭代中计算搜索方向 $p_{k}$、步长 $\\alpha_{k}$（通过对 $\\phi$ 进行精确线搜索得到）、更新后的迭代解 $x_{k+1}$ 和残差 $r_{k+1}$。验证搜索方向是 $A$-共轭的。设精确解记为 $x^{\\ast} = A^{-1} b$，并将误差的 $A$-范数定义为 $\\|e_{k}\\|_{A} = \\sqrt{(x^{\\ast} - x_{k})^{\\mathsf{T}} A (x^{\\ast} - x_{k})}$。计算 $k \\in \\{0,1,2\\}$ 时的 $\\|e_{k}\\|_{A}$。报告第二次迭代后误差的 $A$-范数 $\\|e_{2}\\|_{A}$ 作为你的最终答案。最终答案需为精确值（不要四舍五入）。", "solution": "首先验证问题，以确保其科学上合理、适定、客观和完整。\n\n### 第1步：提取已知条件\n问题提供了以下信息：\n- 一个线性系统 $A x = b$，其中 $A \\in \\mathbb{R}^{3 \\times 3}$ 且 $b \\in \\mathbb{R}^{3}$。\n- 矩阵 $A$ 给出为 $A = \\begin{pmatrix} 4  1  0 \\\\ 1  3  1 \\\\ 0  1  2 \\end{pmatrix}$。\n- 向量 $b$ 给出为 $b = \\begin{pmatrix} 4 \\\\ 2 \\\\ 2 \\end{pmatrix}$。\n- $A$ 被说明是对称正定 (SPD) 的。\n- 将使用共轭梯度 (CG) 方法。\n- 初始猜测为 $x_{0} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$。\n- 残差定义为 $r_{k} = b - A x_{k}$。\n- 任务是执行两次迭代（$k=0$ 和 $k=1$）。\n- 每次迭代需要计算的量是搜索方向 $p_k$、步长 $\\alpha_k$、下一个迭代解 $x_{k+1}$ 和下一个残差 $r_{k+1}$。\n- 必须验证搜索方向的 $A$-共轭性。\n- 精确解为 $x^{\\ast} = A^{-1} b$。\n- 误差的 $A$-范数定义为 $\\|e_{k}\\|_{A} = \\sqrt{(x^{\\ast} - x_{k})^{\\mathsf{T}} A (x^{\\ast} - x_{k})}$。\n- 必须计算 $k \\in \\{0, 1, 2\\}$ 时的 $\\|e_{k}\\|_{A}$ 值。\n- 需要报告的最终答案是 $\\|e_{2}\\|_{A}$。\n\n### 第2步：使用提取的已知条件进行验证\n该问题是数值线性代数中的一个标准练习。必须确认 $A$ 是 SPD 这一前提的有效性。\n1.  **对称性**：矩阵 $A$ 是对称的，因为对于所有的 $i,j$，$A_{ij} = A_{ji}$。\n    $A^{\\mathsf{T}} = \\begin{pmatrix} 4  1  0 \\\\ 1  3  1 \\\\ 0  1  2 \\end{pmatrix}^{\\mathsf{T}} = \\begin{pmatrix} 4  1  0 \\\\ 1  3  1 \\\\ 0  1  2 \\end{pmatrix} = A$。\n2.  **正定性**：我们通过检查顺序主子式的行列式来应用西尔维斯特准则 (Sylvester's criterion)。\n    - 第一个主子式是 $\\det(4) = 4  0$。\n    - 第二个主子式是 $\\det\\begin{pmatrix} 4  1 \\\\ 1  3 \\end{pmatrix} = (4)(3) - (1)(1) = 11  0$。\n    - 第三个主子式是 $\\det(A) = 4 \\det\\begin{pmatrix} 3  1 \\\\ 1  2 \\end{pmatrix} - 1 \\det\\begin{pmatrix} 1  1 \\\\ 0  2 \\end{pmatrix} = 4(6-1) - 1(2-0) = 4(5) - 2 = 18  0$。\n由于所有顺序主子式都为正，矩阵 $A$ 是正定的。\n\n问题陈述在科学上是合理的、适定的和客观的。它包含了所有必要的信息，并且没有矛盾或含糊之处。\n\n### 第3步：结论与行动\n问题是有效的。我们着手解决它。\n\n求解 $Ax=b$ 的共轭梯度算法从一个初始猜测 $x_0$ 开始，按以下步骤进行：\n- $r_0 = b - A x_0$\n- $p_0 = r_0$\n- 对于 $k = 0, 1, 2, ...$：\n  - $\\alpha_k = \\frac{r_k^{\\mathsf{T}} r_k}{p_k^{\\mathsf{T}} A p_k}$\n  - $x_{k+1} = x_k + \\alpha_k p_k$\n  - $r_{k+1} = r_k - \\alpha_k A p_k$\n  - $\\beta_k = \\frac{r_{k+1}^{\\mathsf{T}} r_{k+1}}{r_k^{\\mathsf{T}} r_k}$\n  - $p_{k+1} = r_{k+1} + \\beta_k p_k$\n\n**初始化 (k=0)**\n给定 $x_0 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$。\n初始残差是 $r_0 = b - A x_0 = b = \\begin{pmatrix} 4 \\\\ 2 \\\\ 2 \\end{pmatrix}$。\n初始搜索方向是 $p_0 = r_0 = \\begin{pmatrix} 4 \\\\ 2 \\\\ 2 \\end{pmatrix}$。\n\n**第一次迭代 (k=0)**\n1.  计算 $A p_0$：\n    $A p_0 = \\begin{pmatrix} 4  1  0 \\\\ 1  3  1 \\\\ 0  1  2 \\end{pmatrix} \\begin{pmatrix} 4 \\\\ 2 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} 16+2+0 \\\\ 4+6+2 \\\\ 0+2+4 \\end{pmatrix} = \\begin{pmatrix} 18 \\\\ 12 \\\\ 6 \\end{pmatrix}$。\n2.  计算步长 $\\alpha_0$：\n    $r_0^{\\mathsf{T}} r_0 = 4^2 + 2^2 + 2^2 = 16 + 4 + 4 = 24$。\n    $p_0^{\\mathsf{T}} A p_0 = r_0^{\\mathsf{T}} A p_0 = \\begin{pmatrix} 4  2  2 \\end{pmatrix} \\begin{pmatrix} 18 \\\\ 12 \\\\ 6 \\end{pmatrix} = 72 + 24 + 12 = 108$。\n    $\\alpha_0 = \\frac{r_0^{\\mathsf{T}} r_0}{p_0^{\\mathsf{T}} A p_0} = \\frac{24}{108} = \\frac{2}{9}$。\n3.  更新迭代解 $x_1$：\n    $x_1 = x_0 + \\alpha_0 p_0 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} + \\frac{2}{9} \\begin{pmatrix} 4 \\\\ 2 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} 8/9 \\\\ 4/9 \\\\ 4/9 \\end{pmatrix}$。\n4.  更新残差 $r_1$：\n    $r_1 = r_0 - \\alpha_0 A p_0 = \\begin{pmatrix} 4 \\\\ 2 \\\\ 2 \\end{pmatrix} - \\frac{2}{9} \\begin{pmatrix} 18 \\\\ 12 \\\\ 6 \\end{pmatrix} = \\begin{pmatrix} 4 \\\\ 2 \\\\ 2 \\end{pmatrix} - \\begin{pmatrix} 4 \\\\ 8/3 \\\\ 4/3 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 6/3 - 8/3 \\\\ 6/3 - 4/3 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -2/3 \\\\ 2/3 \\end{pmatrix}$。\n\n**第二次迭代 (k=1)**\n1.  计算 $\\beta_0$ 以找到新的搜索方向 $p_1$：\n    $r_1^{\\mathsf{T}} r_1 = 0^2 + (-\\frac{2}{3})^2 + (\\frac{2}{3})^2 = \\frac{4}{9} + \\frac{4}{9} = \\frac{8}{9}$。\n    $\\beta_0 = \\frac{r_1^{\\mathsf{T}} r_1}{r_0^{\\mathsf{T}} r_0} = \\frac{8/9}{24} = \\frac{8}{9 \\times 24} = \\frac{1}{27}$。\n2.  更新搜索方向 $p_1$：\n    $p_1 = r_1 + \\beta_0 p_0 = \\begin{pmatrix} 0 \\\\ -2/3 \\\\ 2/3 \\end{pmatrix} + \\frac{1}{27} \\begin{pmatrix} 4 \\\\ 2 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} 4/27 \\\\ -18/27 + 2/27 \\\\ 18/27 + 2/27 \\end{pmatrix} = \\begin{pmatrix} 4/27 \\\\ -16/27 \\\\ 20/27 \\end{pmatrix} = \\frac{4}{27} \\begin{pmatrix} 1 \\\\ -4 \\\\ 5 \\end{pmatrix}$。\n3.  计算 $A p_1$：\n    $A p_1 = \\frac{4}{27} \\begin{pmatrix} 4  1  0 \\\\ 1  3  1 \\\\ 0  1  2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ -4 \\\\ 5 \\end{pmatrix} = \\frac{4}{27} \\begin{pmatrix} 4-4+0 \\\\ 1-12+5 \\\\ 0-4+10 \\end{pmatrix} = \\frac{4}{27} \\begin{pmatrix} 0 \\\\ -6 \\\\ 6 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -8/9 \\\\ 8/9 \\end{pmatrix}$。\n4.  计算步长 $\\alpha_1$：\n    $p_1^{\\mathsf{T}} A p_1 = \\left( \\frac{4}{27} \\begin{pmatrix} 1  -4  5 \\end{pmatrix} \\right) \\left( \\frac{4}{27} \\begin{pmatrix} 0 \\\\ -6 \\\\ 6 \\end{pmatrix} \\right) = \\frac{16}{729} \\left( 0 + 24 + 30 \\right) = \\frac{16 \\times 54}{729} = \\frac{16 \\times (2 \\times 27)}{27 \\times 27} = \\frac{32}{27}$。\n    $\\alpha_1 = \\frac{r_1^{\\mathsf{T}} r_1}{p_1^{\\mathsf{T}} A p_1} = \\frac{8/9}{32/27} = \\frac{8}{9} \\cdot \\frac{27}{32} = \\frac{1}{1} \\cdot \\frac{3}{4} = \\frac{3}{4}$。\n5.  更新迭代解 $x_2$：\n    $x_2 = x_1 + \\alpha_1 p_1 = \\begin{pmatrix} 8/9 \\\\ 4/9 \\\\ 4/9 \\end{pmatrix} + \\frac{3}{4} \\begin{pmatrix} 4/27 \\\\ -16/27 \\\\ 20/27 \\end{pmatrix} = \\begin{pmatrix} 8/9 \\\\ 4/9 \\\\ 4/9 \\end{pmatrix} + \\begin{pmatrix} 1/9 \\\\ -4/9 \\\\ 5/9 \\end{pmatrix} = \\begin{pmatrix} 9/9 \\\\ 0/9 \\\\ 9/9 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 1 \\end{pmatrix}$。\n6.  更新残差 $r_2$：\n    $r_2 = r_1 - \\alpha_1 A p_1 = \\begin{pmatrix} 0 \\\\ -2/3 \\\\ 2/3 \\end{pmatrix} - \\frac{3}{4} \\begin{pmatrix} 0 \\\\ -8/9 \\\\ 8/9 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -2/3 \\\\ 2/3 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ -2/3 \\\\ 2/3 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$。\n\n残差 $r_2$ 是零向量，这意味着 $x_2$ 是系统 $Ax=b$ 的精确解。\n\n**A-共轭性验证**\n我们必须验证 $p_0^{\\mathsf{T}} A p_1 = 0$。\n$p_0^{\\mathsf{T}} A p_1 = \\begin{pmatrix} 4  2  2 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ -8/9 \\\\ 8/9 \\end{pmatrix} = 4(0) + 2(-\\frac{8}{9}) + 2(\\frac{8}{9}) = 0 - \\frac{16}{9} + \\frac{16}{9} = 0$。\n搜索方向 $p_0$ 和 $p_1$ 确实是 $A$-共轭的。\n\n**误差的A-范数计算**\n精确解是 $x^* = x_2 = \\begin{pmatrix} 1 \\\\ 0 \\\\ 1 \\end{pmatrix}$。我们可以验证这一点：\n$A x^* = \\begin{pmatrix} 4  1  0 \\\\ 1  3  1 \\\\ 0  1  2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 4 \\\\ 1+1 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} 4 \\\\ 2 \\\\ 2 \\end{pmatrix} = b$。\n在第 $k$ 步的误差是 $e_k = x^* - x_k$。$A$-范数的平方是 $\\|e_k\\|_A^2 = e_k^{\\mathsf{T}} A e_k$。\n\n- 对于 $k=0$：\n  $e_0 = x^* - x_0 = \\begin{pmatrix} 1 \\\\ 0 \\\\ 1 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 1 \\end{pmatrix}$。\n  $A e_0 = A x^* - A x_0 = b - (b - r_0) = r_0 = \\begin{pmatrix} 4 \\\\ 2 \\\\ 2 \\end{pmatrix}$。\n  $\\|e_0\\|_A^2 = e_0^{\\mathsf{T}} (A e_0) = \\begin{pmatrix} 1  0  1 \\end{pmatrix} \\begin{pmatrix} 4 \\\\ 2 \\\\ 2 \\end{pmatrix} = 4+2 = 6$。\n  $\\|e_0\\|_A = \\sqrt{6}$。\n\n- 对于 $k=1$：\n  $e_1 = x^* - x_1 = \\begin{pmatrix} 1 \\\\ 0 \\\\ 1 \\end{pmatrix} - \\begin{pmatrix} 8/9 \\\\ 4/9 \\\\ 4/9 \\end{pmatrix} = \\begin{pmatrix} 1/9 \\\\ -4/9 \\\\ 5/9 \\end{pmatrix}$。\n  $A e_1 = A x^* - A x_1 = b - (b - r_1) = r_1 = \\begin{pmatrix} 0 \\\\ -2/3 \\\\ 2/3 \\end{pmatrix}$。\n  $\\|e_1\\|_A^2 = e_1^{\\mathsf{T}} (A e_1) = \\begin{pmatrix} 1/9  -4/9  5/9 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ -2/3 \\\\ 2/3 \\end{pmatrix} = \\frac{1}{27} (1(0) - 4(-2) + 5(2)) = \\frac{18}{27} = \\frac{2}{3}$。\n  $\\|e_1\\|_A = \\sqrt{\\frac{2}{3}}$。\n\n- 对于 $k=2$：\n  $e_2 = x^* - x_2 = \\begin{pmatrix} 1 \\\\ 0 \\\\ 1 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$。\n  $\\|e_2\\|_A^2 = e_2^{\\mathsf{T}} A e_2 = 0$。\n  $\\|e_2\\|_A = 0$。\n\n问题要求 $\\|e_2\\|_A$ 的值。这个值是 $0$。", "answer": "$$\\boxed{0}$$", "id": "3582008"}]}