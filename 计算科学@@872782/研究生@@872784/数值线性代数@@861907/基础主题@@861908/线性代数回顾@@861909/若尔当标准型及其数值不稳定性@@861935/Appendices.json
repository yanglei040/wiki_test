{"hands_on_practices": [{"introduction": "将一个矩阵与其若尔当标准型联系起来是理解其谱性质的关键。此练习旨在通过构造一个具有特定若尔当结构的矩阵，来加深对亏损矩阵基本性质的理解。通过直接计算 $(A-\\lambda I)$ 幂的秩，我们可以揭示矩阵的内在结构，例如若尔当块的大小和数量，从而巩固你对亏损性、几何重数和代数重数之间关系的认识。", "problem": "设 $A \\in \\mathbb{R}^{4 \\times 4}$ 为一个实矩阵。$A$ 的特征多项式定义为 $p_{A}(x) = \\det(x I - A)$，其中 $I$ 是单位矩阵。与特征值 $\\lambda \\in \\mathbb{C}$ 相关联的 $m$ 阶若尔当块是一个 $m \\times m$ 矩阵 $J_{m}(\\lambda)$，其对角线上为 $\\lambda$，超对角线上为 1，其他位置均为零。如果一个矩阵的某个特征值的几何重数（特征空间的维数）严格小于其代数重数（该特征值在特征多项式中的重数），则该矩阵称为亏损矩阵。秩-零度定理指出，对于有限维向量空间上的任何线性映射，$\\operatorname{rank}(M) + \\operatorname{nullity}(M) = n$，其中 $n$ 是空间的维数。\n\n请显式构造一个矩阵 $A \\in \\mathbb{R}^{4 \\times 4}$，其特征多项式为 $p_{A}(x) = (x-1)^{4}$ 且恰好有两个若尔当块。仅使用上述基本定义和直接计算，确定秩 $r_{j} = \\operatorname{rank}\\big((A - I)^{j}\\big)$（其中 $j \\in \\{1,2,3\\}$），并通过将 $(A-I)^{j}$ 的零度解释为特征空间和广义特征空间，利用这些秩来证明 $A$ 是亏损的。从第一性原理出发，简要解释为什么具有非平凡若尔当块的矩阵在小扰动下是数值不稳定的，即其特征结构是高度敏感的。\n\n请提供行矩阵 $\\big(r_{1}, r_{2}, r_{3}\\big)$ 作为你的最终答案。无需四舍五入。", "solution": "用户希望我解决一个关于若尔当标准型及其数值性质的问题。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n-   $A \\in \\mathbb{R}^{4 \\times 4}$ 是一个实矩阵。\n-   $A$ 的特征多项式是 $p_{A}(x) = (x-1)^{4}$。\n-   $A$ 必须恰好有两个若尔当块。\n-   提供了以下定义：特征多项式、若尔当块、亏损矩阵和秩-零度定理。\n-   任务 1：构造一个满足这些性质的矩阵 $A$。\n-   任务 2：确定秩 $r_{j} = \\operatorname{rank}\\big((A - I)^{j}\\big)$，其中 $j \\in \\{1,2,3\\}$，$I$ 是单位矩阵。\n-   任务 3：使用这些秩来证明 $A$ 是亏损的。\n-   任务 4：解释为什么具有非平凡若尔当块的矩阵是数值不稳定的。\n-   最终答案必须是行矩阵 $(r_1, r_2, r_3)$。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题在代数和数值分析领域内提法恰当、科学严谨。\n-   **科学性**：所有概念（若尔当标准型、特征多项式、秩、零度、数值稳定性）都是标准且正确的。\n-   **适定性**：特征多项式 $p_{A}(x) = (x-1)^{4}$ 意味着唯一的特征值是 $\\lambda = 1$，其代数重数为 $4$。对于一个 $4 \\times 4$ 矩阵，有两个若尔当块意味着它们的阶数之和必须为 $4$。将整数 $4$ 划分为两部分的可能组合是 $3+1$ 和 $2+2$。问题要求构造*一个*矩阵，因此选择任一划分都是有效的。要求计算 $j \\in \\{1,2,3\\}$ 的秩，这表明最大若尔当块的阶数至少为 $3$，使得 $3+1$ 划分成为一个更具说明性的选择。任务是具体的，一旦构造出矩阵，秩的解就是唯一的。\n-   **客观性**：问题使用了精确、无歧义的数学术语来陈述。\n-   **完整性**：问题提供了继续进行所需的所有必要信息和定义。它是自洽的。\n\n**步骤 3：结论与行动**\n问题有效。我将继续解答。\n\n### 解答\n\n**第一部分：构造矩阵 A**\n\n特征多项式为 $p_{A}(x) = (x-1)^{4}$。这意味着矩阵 $A$ 只有一个特征值 $\\lambda = 1$，其代数重数 $m_a = 4$。\n题目指定矩阵 $A$ 恰好有两个若尔当块。若尔当块的阶数之和必须等于矩阵的维数，即 $4$。将整数 $4$ 划分为两部分的可能组合是 $3+1$ 和 $2+2$。\n我们选择 $3+1$ 这种划分。该结构意味着 $A$ 的若尔当标准型 $J$ 由一个 $3$ 阶若尔当块和一个 $1$ 阶若尔当块组成，两者都与特征值 $\\lambda=1$ 相关联。\n若尔当标准型为：\n$$ J = \\begin{pmatrix} J_{3}(1)  0 \\\\ 0  J_{1}(1) \\end{pmatrix} = \\begin{pmatrix} 1  1  0  0 \\\\ 0  1  1  0 \\\\ 0  0  1  0 \\\\ 0  0  0  1 \\end{pmatrix} $$\n为了构造矩阵 $A$，我们可以选择 $A$ 就是其自身的若尔当标准型，因为这是具有此若尔当结构的相似矩阵类中最简单的代表。令 $A = J$。该矩阵属于 $\\mathbb{R}^{4 \\times 4}$，其特征多项式确实是 $(x-1)^4$（因为它是一个上三角矩阵，对角线元素全为 $1$），并且根据构造，它有两个若尔当块。\n\n**第二部分：确定秩**\n\n我们需要计算 $j \\in \\{1, 2, 3\\}$ 时，秩 $r_j = \\operatorname{rank}((A-I)^j)$ 的值。令 $N = A - I$。\n$$ N = A - I = \\begin{pmatrix} 1  1  0  0 \\\\ 0  1  1  0 \\\\ 0  0  1  0 \\\\ 0  0  0  1 \\end{pmatrix} - \\begin{pmatrix} 1  0  0  0 \\\\ 0  1  0  0 \\\\ 0  0  1  0 \\\\ 0  0  0  1 \\end{pmatrix} = \\begin{pmatrix} 0  1  0  0 \\\\ 0  0  1  0 \\\\ 0  0  0  0 \\\\ 0  0  0  0 \\end{pmatrix} $$\n-   对于 $j=1$：我们计算 $r_1 = \\operatorname{rank}(N)$。矩阵 $N$ 有两个线性无关的列向量（第二列和第三列分别为 $(1,0,0,0)^T$ 和 $(0,1,0,0)^T$）。因此，其秩为 $2$。\n    $r_1 = 2$。\n-   对于 $j=2$：我们计算 $r_2 = \\operatorname{rank}(N^2)$。\n    $$ N^2 = \\begin{pmatrix} 0  1  0  0 \\\\ 0  0  1  0 \\\\ 0  0  0  0 \\\\ 0  0  0  0 \\end{pmatrix} \\begin{pmatrix} 0  1  0  0 \\\\ 0  0  1  0 \\\\ 0  0  0  0 \\\\ 0  0  0  0 \\end{pmatrix} = \\begin{pmatrix} 0  0  1  0 \\\\ 0  0  0  0 \\\\ 0  0  0  0 \\\\ 0  0  0  0 \\end{pmatrix} $$\n    矩阵 $N^2$ 只有一个非零列。其秩为 $1$。\n    $r_2 = 1$。\n-   对于 $j=3$：我们计算 $r_3 = \\operatorname{rank}(N^3)$。\n    $$ N^3 = N^2 \\cdot N = \\begin{pmatrix} 0  0  1  0 \\\\ 0  0  0  0 \\\\ 0  0  0  0 \\\\ 0  0  0  0 \\end{pmatrix} \\begin{pmatrix} 0  1  0  0 \\\\ 0  0  1  0 \\\\ 0  0  0  0 \\\\ 0  0  0  0 \\end{pmatrix} = \\begin{pmatrix} 0  0  0  0 \\\\ 0  0  0  0 \\\\ 0  0  0  0 \\\\ 0  0  0  0 \\end{pmatrix} $$\n    矩阵 $N^3$ 是零矩阵。其秩为 $0$。\n    $r_3 = 0$。\n\n秩的序列为 $(r_1, r_2, r_3) = (2, 1, 0)$。\n\n**第三部分：亏损性证明**\n\n如果一个矩阵至少有一个特征值的几何重数严格小于其代数重数，则该矩阵是亏损的。\n特征值 $\\lambda=1$ 的代数重数 $m_a = 4$，由特征多项式 $p_A(x)=(x-1)^4$ 给出。\n$\\lambda=1$ 的几何重数 $m_g$ 是特征空间 $E_1 = \\ker(A - 1 \\cdot I)$ 的维数。根据应用于 $\\mathbb{R}^4$ 上的矩阵 $A-I$ 的秩-零度定理：\n$$ \\operatorname{rank}(A-I) + \\operatorname{nullity}(A-I) = 4 $$\n零度即为几何重数：$m_g = \\operatorname{nullity}(A-I)$。\n$$ m_g = 4 - \\operatorname{rank}(A-I) = 4 - r_1 $$\n使用我们计算出的值 $r_1=2$，我们得到几何重数：\n$$ m_g = 4 - 2 = 2 $$\n比较重数，我们有 $m_g = 2  m_a = 4$。由于几何重数严格小于代数重数，矩阵 $A$ 是亏损的。\n\n$(A-I)$ 幂的零度与广义特征空间的结构有关。令 $k_j = \\operatorname{nullity}((A-I)^j) = 4-r_j$。\n-   $k_1 = 4-r_1 = 4-2=2$。这是特征空间的维数，等于若尔当块的数量。\n-   $k_2 = 4-r_2 = 4-1=3$。这是 $(A-I)^2$ 的核的维数。\n-   $k_3 = 4-r_3 = 4-0=4$。这是 $(A-I)^3$ 的核的维数。\n阶数至少为 $j$ 的若尔当块的数量由差值 $k_j - k_{j-1}$ 给出（其中 $k_0 = 0$）。\n-   阶数 $\\ge 1$ 的块数：$k_1 - k_0 = 2-0=2$。\n-   阶数 $\\ge 2$ 的块数：$k_2 - k_1 = 3-2=1$。\n-   阶数 $\\ge 3$ 的块数：$k_3 - k_2 = 4-3=1$。\n这证实了存在一个 $3$ 阶块和一个 $1$ 阶块，与我们的构造一致。\n\n**第四部分：数值不稳定性解释**\n\n具有非平凡若尔当块（即阶数 $m>1$ 的块）的矩阵是亏损的，这意味着它们有重根特征值，且其几何重数小于代数重数。对此类矩阵的特征值计算是一个病态问题。这意味着矩阵元素中的小扰动可能导致计算出的特征值发生大的变化。\n\n从第一性原理出发，考虑一个与特征值 $\\lambda$ 相关联的简单 $2 \\times 2$ 若尔当块：\n$$ J = \\begin{pmatrix} \\lambda  1 \\\\ 0  \\lambda \\end{pmatrix} $$\n其特征多项式为 $(x-\\lambda)^2=0$，得到一个特征值 $x=\\lambda$，代数重数为 $2$，几何重数为 $1$。\n\n现在，在 $(2,1)$ 位置引入一个小的扰动 $\\epsilon$，创建矩阵 $J'$：\n$$ J' = \\begin{pmatrix} \\lambda  1 \\\\ \\epsilon  \\lambda \\end{pmatrix} $$\n$J'$ 的特征多项式是 $\\det(xI - J') = (x-\\lambda)^2 - \\epsilon = 0$。其根由 $x - \\lambda = \\pm\\sqrt{\\epsilon}$ 给出，这意味着新的特征值为：\n$$ x_{1,2} = \\lambda \\pm \\sqrt{\\epsilon} $$\n矩阵元素中大小为 $|\\epsilon|$ 的扰动导致了特征值中大小为 $|\\sqrt{\\epsilon}|$ 的扰动。对于很小的 $\\epsilon$（例如 $\\epsilon = 10^{-16}$），对特征值的扰动（$\\sqrt{\\epsilon} = 10^{-8}$）要大好几个数量级。这种不成比例的响应标志着数值不稳定性。\n\n此外，对于任何非零的 $\\epsilon$，两个特征值 $\\lambda + \\sqrt{\\epsilon}$ 和 $\\lambda - \\sqrt{\\epsilon}$ 是不同的。这意味着受扰动的矩阵 $J'$ 不再是亏损的；它是可对角化的，并有一整套两个线性无关的特征向量。由于一个任意小的扰动，矩阵的基本特征结构从亏损急剧变为可对角化。在浮点运算中，区分一个真正亏损的矩阵和一个仅仅是接近亏损的可对角化矩阵是不可能的，这使得若尔当标准型成为一种数值不稳定的表示。", "answer": "$$\n\\boxed{\\begin{pmatrix} 2  1  0 \\end{pmatrix}}\n$$", "id": "3553184"}, {"introduction": "理论上，若尔当标准型揭示了矩阵的精确结构，但在数值计算中，其不稳定性成为一个核心问题。此练习将引导你量化这种不稳定性，通过计算一个简单但极具启发性的 $2 \\times 2$ 摄动若尔当块的特征值条件数。通过推导右特征向量和左特征向量并运用条件数的定义，你将亲眼见证当矩阵趋近于亏损状态时，其特征值对微小摄动的敏感度如何急剧放大。", "problem": "设 $A(\\epsilon) \\in \\mathbb{R}^{2 \\times 2}$ 由下式给出\n$$\nA(\\epsilon) \\;=\\; \\begin{bmatrix} \\lambda  1 \\\\ \\epsilon  \\lambda \\end{bmatrix},\n$$\n其中 $\\lambda \\in \\mathbb{R}$ 是固定的，且 $\\epsilon>0$。考虑关于 $A(\\epsilon)$ 的单特征值 $\\mu$ 的右特征值问题 $A(\\epsilon)\\,x=\\mu\\,x$ 和左特征值问题 $y^{\\top}A(\\epsilon)=\\mu\\,y^{\\top}$。在向量二范数下进行计算。你的任务是：\n\n1. 从特征多项式定义和特征向量方程出发，确定 $A(\\epsilon)$ 的两个特征值，并构造相应的非零右特征向量和左特征向量。\n\n2. 使用单特征值的特征值条件数的定义，\n$$\n\\kappa_{2}(\\mu) \\;=\\; \\frac{\\|x\\|_{2}\\,\\|y\\|_{2}}{|y^{\\top}x|},\n$$\n其中 $x$ 和 $y$ 是相应的右特征向量和左特征向量（具有任意非零缩放），对于具有较大实部的特征值 $\\mu_{+}$，显式地计算 $\\kappa_{2}(\\mu)$ 作为 $\\epsilon$ 的函数。\n\n3. 从第一性原理出发，解释当 $\\epsilon \\to 0^{+}$ 时 $\\kappa_{2}(\\mu_{+})$ 的行为如何反映 $A(\\epsilon)$ 趋近于一个具有单个若尔当块的亏损矩阵，并推导出其在 $\\epsilon$ 中的精确缩放关系。\n\n作为你的最终答案，报告 $\\kappa_{2}(\\mu_{+})$ 作为 $\\epsilon$ 函数的精确闭式表达式（最简形式）。不需要数值舍入，也不涉及单位。", "solution": "问题陈述在科学上是合理的、适定的、客观的和完整的。它代表了数值线性代数中关于亏损矩阵附近特征值敏感性的标准分析。因此，我们可以继续进行求解。\n\n问题分为三个部分。我们将按顺序解决它们。\n\n**第一部分：$A(\\epsilon)$ 的特征值和特征向量**\n\n矩阵由下式给出\n$$\nA(\\epsilon) = \\begin{bmatrix} \\lambda  1 \\\\ \\epsilon  \\lambda \\end{bmatrix}\n$$\n其中 $\\lambda \\in \\mathbb{R}$ 且 $\\epsilon > 0$。\n\n特征值 $\\mu$ 是特征多项式 $\\det(A(\\epsilon) - \\mu I) = 0$ 的根，其中 $I$ 是 $2 \\times 2$ 单位矩阵。\n$$\n\\det\\left(\\begin{bmatrix} \\lambda - \\mu  1 \\\\ \\epsilon  \\lambda - \\mu \\end{bmatrix}\\right) = (\\lambda - \\mu)^2 - \\epsilon = 0\n$$\n求解 $\\mu$，我们得到 $\\lambda - \\mu = \\pm\\sqrt{\\epsilon}$，这给出了两个特征值：\n$$\n\\mu_{\\pm} = \\lambda \\pm \\sqrt{\\epsilon}\n$$\n由于 $\\epsilon > 0$，两个特征值 $\\mu_+$ 和 $\\mu_-$ 是实数且不相等。因此，如问题所述，它们是单特征值。\n\n接下来，我们寻找相应的右特征向量和左特征向量。\n\n**右特征向量：**\n对应于特征值 $\\mu$ 的右特征向量 $x$ 满足方程 $(A(\\epsilon) - \\mu I)x = 0$。\n\n对于 $\\mu_{+} = \\lambda + \\sqrt{\\epsilon}$：\n需要求解的系统是 $(A(\\epsilon) - \\mu_{+} I)x_{+} = 0$：\n$$\n\\begin{bmatrix} \\lambda - (\\lambda + \\sqrt{\\epsilon})  1 \\\\ \\epsilon  \\lambda - (\\lambda + \\sqrt{\\epsilon}) \\end{bmatrix} \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix} = \\begin{bmatrix} -\\sqrt{\\epsilon}  1 \\\\ \\epsilon  -\\sqrt{\\epsilon} \\end{bmatrix} \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n这给出方程 $-\\sqrt{\\epsilon} x_1 + x_2 = 0$，即 $x_2 = \\sqrt{\\epsilon} x_1$。我们可以通过设 $x_1 = 1$ 来选择一个非零特征向量，这得到 $x_2 = \\sqrt{\\epsilon}$。\n因此，$\\mu_{+}$ 的一个右特征向量是 $x_{+} = \\begin{pmatrix} 1 \\\\ \\sqrt{\\epsilon} \\end{pmatrix}$。\n\n**左特征向量：**\n对应于特征值 $\\mu$ 的左特征向量 $y$ 满足 $y^{\\top}(A(\\epsilon) - \\mu I) = 0^{\\top}$，这等价于 $(A(\\epsilon)^{\\top} - \\mu I)y = 0$。$A(\\epsilon)$ 的转置是 $A(\\epsilon)^{\\top} = \\begin{bmatrix} \\lambda  \\epsilon \\\\ 1  \\lambda \\end{bmatrix}$。\n\n对于 $\\mu_{+} = \\lambda + \\sqrt{\\epsilon}$：\n需要求解的系统是 $(A(\\epsilon)^{\\top} - \\mu_{+} I)y_{+} = 0$：\n$$\n\\begin{bmatrix} \\lambda - (\\lambda + \\sqrt{\\epsilon})  \\epsilon \\\\ 1  \\lambda - (\\lambda + \\sqrt{\\epsilon}) \\end{bmatrix} \\begin{pmatrix} y_1 \\\\ y_2 \\end{pmatrix} = \\begin{bmatrix} -\\sqrt{\\epsilon}  \\epsilon \\\\ 1  -\\sqrt{\\epsilon} \\end{bmatrix} \\begin{pmatrix} y_1 \\\\ y_2 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n这给出方程 $y_1 - \\sqrt{\\epsilon} y_2 = 0$，即 $y_1 = \\sqrt{\\epsilon} y_2$。我们可以通过设 $y_2 = 1$ 来选择一个非零特征向量，这得到 $y_1 = \\sqrt{\\epsilon}$。\n因此，$\\mu_{+}$ 的一个左特征向量是 $y_{+} = \\begin{pmatrix} \\sqrt{\\epsilon} \\\\ 1 \\end{pmatrix}$。\n\n**第二部分：特征值条件数 $\\kappa_{2}(\\mu_{+})$**\n\n具有较大实部的特征值是 $\\mu_{+} = \\lambda + \\sqrt{\\epsilon}$。条件数 $\\kappa_{2}(\\mu_{+})$ 定义为：\n$$\n\\kappa_{2}(\\mu) = \\frac{\\|x\\|_{2}\\,\\|y\\|_{2}}{|y^{\\top}x|}\n$$\n我们使用对应于 $\\mu_{+}$ 的右特征向量 $x_{+} = \\begin{pmatrix} 1 \\\\ \\sqrt{\\epsilon} \\end{pmatrix}$ 和左特征向量 $y_{+} = \\begin{pmatrix} \\sqrt{\\epsilon} \\\\ 1 \\end{pmatrix}$。\n\n首先，我们计算所需的范数和内积。使用的范数是向量$2$-范数。\n$$\n\\|x_{+}\\|_{2} = \\sqrt{1^2 + (\\sqrt{\\epsilon})^2} = \\sqrt{1 + \\epsilon}\n$$\n$$\n\\|y_{+}\\|_{2} = \\sqrt{(\\sqrt{\\epsilon})^2 + 1^2} = \\sqrt{\\epsilon + 1}\n$$\n接下来，我们计算内积 $y_{+}^{\\top}x_{+}$：\n$$\ny_{+}^{\\top}x_{+} = \\begin{pmatrix} \\sqrt{\\epsilon}  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ \\sqrt{\\epsilon} \\end{pmatrix} = (\\sqrt{\\epsilon})(1) + (1)(\\sqrt{\\epsilon}) = 2\\sqrt{\\epsilon}\n$$\n由于 $\\epsilon > 0$，我们有 $|y_{+}^{\\top}x_{+}| = |2\\sqrt{\\epsilon}| = 2\\sqrt{\\epsilon}$。\n\n将这些代入条件数的公式中：\n$$\n\\kappa_{2}(\\mu_{+}) = \\frac{(\\sqrt{1 + \\epsilon})(\\sqrt{1 + \\epsilon})}{2\\sqrt{\\epsilon}} = \\frac{1 + \\epsilon}{2\\sqrt{\\epsilon}}\n$$\n\n**第三部分：当 $\\epsilon \\to 0^{+}$ 时的解释**\n\n当 $\\epsilon \\to 0^{+}$ 时，矩阵 $A(\\epsilon)$ 趋近于矩阵 $A(0)$：\n$$\nA(0) = \\lim_{\\epsilon\\to 0^{+}} A(\\epsilon) = \\begin{bmatrix} \\lambda  1 \\\\ 0  \\lambda \\end{bmatrix}\n$$\n矩阵 $A(0)$ 是若尔当标准型。它是一个上三角矩阵，所以其特征值是其对角线元素。存在一个代数重数为 $2$ 的单特征值 $\\mu = \\lambda$。\n\n为了找到几何重数，我们求 $A(0) - \\lambda I$ 的零空间的维数：\n$$\nA(0) - \\lambda I = \\begin{bmatrix} 0  1 \\\\ 0  0 \\end{bmatrix}\n$$\n该矩阵的秩为 $1$。根据秩-零度定理，其零空间的维数为 $2 - 1 = 1$。几何重数为 $1$。由于几何重数（$1$）小于代数重数（$2$），矩阵 $A(0)$ 是亏损的。它由一个与特征值 $\\lambda$ 相关联的单个 $2 \\times 2$ 若尔当块组成。\n\n现在，我们来研究当 $\\epsilon \\to 0^{+}$ 时条件数 $\\kappa_{2}(\\mu_{+})$ 的行为：\n$$\n\\lim_{\\epsilon\\to 0^{+}} \\kappa_{2}(\\mu_{+}) = \\lim_{\\epsilon\\to 0^{+}} \\frac{1 + \\epsilon}{2\\sqrt{\\epsilon}}\n$$\n当 $\\epsilon \\to 0^{+}$ 时，分子 $1 + \\epsilon \\to 1$，而分母 $2\\sqrt{\\epsilon} \\to 0^{+}$。因此，极限是：\n$$\n\\lim_{\\epsilon\\to 0^{+}} \\kappa_{2}(\\mu_{+}) = \\infty\n$$\n条件数的发散表明，对于接近亏损矩阵的矩阵，其特征值问题是病态的。对于任何小的 $\\epsilon > 0$，矩阵 $A(\\epsilon)$ 有两个不同的特征值 $\\lambda \\pm \\sqrt{\\epsilon}$，但当 $\\epsilon$ 变得无穷小时，这些特征值对扰动 $\\epsilon$ 极其敏感。\n\n当 $\\epsilon \\to 0^{+}$ 时的精确缩放行为由 $\\kappa_{2}(\\mu_{+})$ 表达式中的主导项决定：\n$$\n\\kappa_{2}(\\mu_{+}) = \\frac{1}{2\\sqrt{\\epsilon}} + \\frac{\\epsilon}{2\\sqrt{\\epsilon}} = \\frac{1}{2}\\epsilon^{-1/2} + \\frac{1}{2}\\epsilon^{1/2}\n$$\n对于小的 $\\epsilon$，$\\epsilon^{-1/2}$ 项占主导地位。因此，条件数以 $O(\\epsilon^{-1/2})$ 的阶数缩放。\n\n这种病态性具有几何解释。条件数与 $|y_{+}^{\\top}x_{+}|$ 成反比。该项与右特征向量和左特征向量之间的夹角 $\\theta$ 的余弦有关：\n$$\n\\cos(\\theta) = \\frac{y_{+}^{\\top}x_{+}}{\\|x_{+}\\|_{2} \\|y_{+}\\|_{2}} = \\frac{2\\sqrt{\\epsilon}}{1+\\epsilon} = \\frac{1}{\\kappa_2(\\mu_{+})}\n$$\n当 $\\epsilon \\to 0^{+}$ 时，我们有 $\\cos(\\theta) \\to 0$，这意味着 $\\theta \\to \\frac{\\pi}{2}$。这意味着右特征向量和左特征向量变得相互正交。\n我们来检查特征向量本身的极限：\n$$\n\\lim_{\\epsilon\\to 0^{+}} x_{+} = \\lim_{\\epsilon\\to 0^{+}} \\begin{pmatrix} 1 \\\\ \\sqrt{\\epsilon} \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}\n$$\n$$\n\\lim_{\\epsilon\\to 0^{+}} y_{+} = \\lim_{\\epsilon\\to 0^{+}} \\begin{pmatrix} \\sqrt{\\epsilon} \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\n$$\n这些极限向量确实分别是亏损矩阵 $A(0)$ 的右特征向量和左特征向量，并且它们是正交的：$\\begin{pmatrix} 0  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = 0$。当矩阵趋近于亏损矩阵时，内积 $y^{\\top}x$ 的消失是特征值条件数急剧增大的根本原因。", "answer": "$$\n\\boxed{\\frac{1 + \\epsilon}{2\\sqrt{\\epsilon}}}\n$$", "id": "3553213"}, {"introduction": "前面的练习从解析的角度揭示了若尔当块的内在不稳定性，现在我们将在一个更实际的计算环境中探索这一现象。此动手实践要求你设计一个数值实验，以验证在有限精度算术下，一个理论上的若尔当块在受到微小随机扰动时其特征值会如何“分裂”。通过编程实现，你将观察到亏损特征值分裂的标度律，并从数据中反向估计出有效扰动的大小，从而深刻理解为何数值算法通常避免直接计算若尔当标准型。", "problem": "考虑若尔当标准型 (JCF)，它将一个矩阵表示为由若尔当块组成的块对角矩阵。一个与特征值 $\\lambda \\in \\mathbb{C}$ 相关的大小为 $m$ 的若尔当块定义为一个 $m \\times m$ 的矩阵 $J_m(\\lambda)$，其对角线上为 $\\lambda$，超对角线上为 1，其他位置为 0。在有限精度算术中，任何输入矩阵都会受到不可避免的舍入误差的影响，这种误差被建模为加性扰动。对于具有非平凡若尔当结构的矩阵，已知此类扰动会导致特征值分裂，并且在连续随机扰动下，会以概率 1 产生一个可对角化的矩阵。\n\n从以下基础出发：\n- $J_m(\\lambda)$ 的特征多项式是 $(x - \\lambda)^m$，因此当 $m \\geq 2$ 时，它只有一个代数重数为 $m$、几何重数为 1 的特征值 $\\lambda$。\n- 在浮点运算中，矩阵 $A$ 实际上是 $A + \\Delta A$，其中 $\\lVert \\Delta A \\rVert$ 的量级是机器精度乘以 $A$ 中元素的大小。\n- 受扰动多项式的特征值通常会发生根分裂，其分裂情况由新引入的低次项系数的大小决定。\n\n您的任务是设计并实现一个完整的程序，通过数值实验来演示和量化若尔当标准型在特征值计算方面的数值不稳定性。对于每个测试用例，构造扰动矩阵\n$$\nA_\\delta = J_m(\\lambda) + \\delta E,\n$$\n其中 $E$ 是一个实值随机矩阵，其独立条目从标准正态分布中抽样，$\\delta \\ge 0$ 是一个控制扰动大小的标量。为确保每个测试用例的可复现性，请使用固定的伪随机种子。\n\n对于每个构造的矩阵 $A_\\delta$，执行以下步骤：\n1. 计算 $A_\\delta$ 的所有特征值 $\\mu_1,\\dots,\\mu_m \\in \\mathbb{C}$。\n2. 使用绝对容差 $\\tau = 10^{-12}$，计算等于不同特征值数量的整数 $k$，其中如果两个特征值的绝对差小于或等于 $\\tau$，则它们被认为是相同的。\n3. 计算观测到的特征值散布\n$$\nr = \\max_{1 \\le i \\le m} \\left| \\mu_i - \\lambda \\right|.\n$$\n4. 通过缺陷敏感的标度律估计有效扰动大小\n$$\n\\widehat{\\varepsilon} = r^m.\n$$\n报告 $k$ 以从数值上支持这一论点：在一般扰动下，计算出的谱几乎必然是单谱（因此是可对角化的），并报告 $\\widehat{\\varepsilon}$ 作为从特征值散布推断出的底层扰动大小的估计值。\n\n测试套件：\n- 案例 1：$(m,\\lambda,\\delta,\\text{seed}) = (1, 2, 10^{-12}, 0)$。\n- 案例 2：$(m,\\lambda,\\delta,\\text{seed}) = (2, 0, 2^{-52}, 1)$，其中 $2^{-52}$ 是双精度机器精度。\n- 案例 3：$(m,\\lambda,\\delta,\\text{seed}) = (3, 1, 10^{-8}, 2)$。\n- 案例 4：$(m,\\lambda,\\delta,\\text{seed}) = (4, 0.5, 0, 3)$。\n- 案例 5：$(m,\\lambda,\\delta,\\text{seed}) = (5, -3.2, 10^{-30}, 4)$。\n\n您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔的结果列表。对于每个测试用例，按顺序输出两个值：首先是整数 $k$，然后是浮点数 $\\widehat{\\varepsilon}$。所有测试用例的输出应按测试套件的相同顺序合并成一个列表。例如，最终输出应具有以下形式\n$$\n[k_1,\\widehat{\\varepsilon}_1,k_2,\\widehat{\\varepsilon}_2,k_3,\\widehat{\\varepsilon}_3,k_4,\\widehat{\\varepsilon}_4,k_5,\\widehat{\\varepsilon}_5].\n$$\n不涉及物理单位或角度。所有数值量都应报告为原始数字。使用任何现代语言实现该程序，并遵守最终答案中指定的运行时环境。", "solution": "在尝试任何解决方案之前，需对问题进行验证。\n\n### 步骤 1：提取已知条件\n问题陈述中逐字给出的已知条件如下：\n- **任务**：设计并实现一个程序，以演示和量化若尔当标准型（JCF）在特征值计算方面的数值不稳定性。\n- **矩阵构造**：$A_\\delta = J_m(\\lambda) + \\delta E$。\n- **$J_m(\\lambda)$**：一个大小为 $m \\times m$ 的若尔当块，特征值为 $\\lambda$。其对角线上为 $\\lambda$，超对角线上为 1，其他位置为 0。\n- **$E$**：一个实值随机矩阵，其独立条目从标准正态分布中抽样。\n- **$\\delta$**：一个标量扰动大小，$\\delta \\ge 0$。\n- **可复现性**：每个测试用例使用固定的伪随机种子。\n- **计算步骤**：\n    1. 计算 $A_\\delta$ 的所有特征值 $\\mu_1, \\dots, \\mu_m \\in \\mathbb{C}$。\n    2. 使用绝对容差 $\\tau = 10^{-12}$ 计算不同特征值的数量 $k$。如果两个特征值的绝对差小于或等于 $\\tau$，则它们被认为是相同的。\n    3. 计算观测到的特征值散布 $r = \\max_{1 \\le i \\le m} |\\mu_i - \\lambda|$。\n    4. 估计有效扰动大小 $\\widehat{\\varepsilon} = r^m$。\n- **测试套件**：\n    - 案例 1：$(m, \\lambda, \\delta, \\text{seed}) = (1, 2, 10^{-12}, 0)$。\n    - 案例 2：$(m, \\lambda, \\delta, \\text{seed}) = (2, 0, 2^{-52}, 1)$。\n    - 案例 3：$(m, \\lambda, \\delta, \\text{seed}) = (3, 1, 10^{-8}, 2)$。\n    - 案例 4：$(m, \\lambda, \\delta, \\text{seed}) = (4, 0.5, 0, 3)$。\n    - 案例 5：$(m, \\lambda, \\delta, \\text{seed}) = (5, -3.2, 10^{-30}, 4)$。\n- **输出格式**：单行文本：$[k_1,\\widehat{\\varepsilon}_1,k_2,\\widehat{\\varepsilon}_2,k_3,\\widehat{\\varepsilon}_3,k_4,\\widehat{\\varepsilon}_4,k_5,\\widehat{\\varepsilon}_5]$。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据既定的验证标准对问题陈述进行评估。\n\n- **科学依据**：该问题在根本上是合理的。它涉及数值线性代数中的一个经典主题：亏损矩阵特征值的敏感性。若尔当块 $J_m(\\lambda)$ 的特征多项式确实是 $(x - \\lambda)^m$。对此类矩阵的一般性扰动通常会产生一个具有 $m$ 个不同特征值的可对角化矩阵。对于一个亏损特征值，扰动大小 $\\varepsilon$ 与由此产生的特征值散布 $r$ 之间的关系由著名结果 $r = O(\\varepsilon^{1/m})$ 给出。提议的估计量 $\\widehat{\\varepsilon} = r^m$ 是该标度律的直接推论，旨在从观测到的散布中恢复对扰动大小的估计。整个前提在科学上是正确的。\n- **适定性**：该问题是适定的。对于每个测试用例，都提供了所有必要的参数（$m, \\lambda, \\delta, \\text{seed}$）。计算输出（$k$ 和 $\\widehat{\\varepsilon}$）的程序有明确定义，包括用于区分特征值的数值容差 $\\tau$。为随机数生成器使用固定种子确保了实验是确定性和可复现的。\n- **客观性**：该问题以精确、客观的数学语言陈述，没有歧义或主观看法。\n\n该问题没有表现出任何列出的无效性缺陷。它是科学合理的、适定的、客观的、可形式化的、完整的和非平凡的。\n\n### 步骤 3：结论与行动\n问题是**有效的**。将提供解决方案。\n\n### 解决方案\n目标是进行一项数值实验，以研究若尔当块的特征值在小扰动下的不稳定性。对于由 $(m, \\lambda, \\delta, \\text{seed})$ 指定的每个测试用例，我们将构造一个扰动矩阵 $A_\\delta$ 并分析其计算出的谱。\n\n**理论背景**\n当 $m \\ge 2$ 时，若尔当块 $J_m(\\lambda)$ 是一个亏损矩阵，这意味着它具有比其维数更少的线性无关特征向量。它拥有一个代数重数为 $m$ 但几何重数仅为 1 的单一特征值 $\\lambda$。这种矩阵的特征值对扰动高度敏感。可以从扰动理论中证明，一个大小为 $\\delta$ 的一般性扰动会将该单一特征值分裂为 $m$ 个不同的特征值 $\\mu_i$，这些特征值位于复平面上以 $\\lambda$ 为中心、半径为 $O(\\delta^{1/m})$ 的圆盘内。\n受扰动的特征多项式可以近似为：\n$$ \\det(xI - A_\\delta) = \\det(xI - J_m(\\lambda) - \\delta E) \\approx (x-\\lambda)^m - c \\delta = 0 $$\n其中常数 $c$ 取决于扰动矩阵 $E$ 的条目，对于 $J_m(0)$，具体来说 $c \\approx (-1)^{m+1} E_{m,1}$。该多项式的根近似为 $\\mu_j \\approx \\lambda + (c\\delta)^{1/m}$。与 $\\lambda$ 的最大距离即为散布 $r = \\max_j |\\mu_j - \\lambda|$，其标度关系为 $r \\propto \\delta^{1/m}$。因此，我们可以通过反转此关系来估计扰动的有效大小：$\\widehat{\\varepsilon} = r^m$，其量级应与 $\\delta$ 相当。\n\n**算法流程**\n对于每个测试用例 $(m, \\lambda, \\delta, \\text{seed})$，执行以下步骤：\n\n1.  **设置种子以确保可复现性**：将伪随机数生成器的种子固定为测试用例中指定的值。这确保了在每次实验执行时，随机矩阵 $E$ 都是相同的。\n\n2.  **构造矩阵**：\n    - 创建一个大小为 $m \\times m$ 的若尔当块 $J_m(\\lambda)$。该矩阵的主对角线上的值为 $\\lambda$，第一超对角线上的值为 1。\n    - 生成一个 $m \\times m$ 的扰动矩阵 $E$，其中每个条目都是从标准正态分布 $\\mathcal{N}(0, 1)$ 中独立抽样的样本。\n    - 最终的扰动矩阵计算为 $A_\\delta = J_m(\\lambda) + \\delta E$。\n\n3.  **计算特征值**：使用标准的数值库函数计算矩阵 $A_\\delta$ 的特征值 $\\mu_1, \\dots, \\mu_m$。即使 $A_\\delta$ 是实矩阵，这些特征值也可能是复数。\n\n4.  **计算不同特征值的数量 ($k$)**：根据给定的容差 $\\tau = 10^{-12}$ 确定不同特征值的数量。采用一种迭代算法：\n    - 初始化一个空的不同特征值列表。\n    - 对于每个计算出的特征值 $\\mu_i$：\n        - 检查它是否“接近”已在不同列表中的任何特征值，即对于列表中已有的任何 $\\mu_j$，是否有 $|\\mu_i - \\mu_j| \\le \\tau$。\n        - 如果它不接近任何现有的不同特征值，则将其添加到列表中。\n    - 计数 $k$ 是此不同特征值列表的最终大小。\n    对于 $\\delta > 0$ 和 $m > 1$，我们期望 $k=m$ 的概率非常高。对于 $\\delta=0$ 或 $m=1$，我们期望 $k=1$。\n\n5.  **计算特征值散布 ($r$)**：计算出的特征值与原始特征值 $\\lambda$ 的最大绝对偏差：\n    $$ r = \\max_{1 \\le i \\le m} |\\mu_i - \\lambda| $$\n    其中 $|\\cdot|$ 表示复数的模。\n\n6.  **估计有效扰动 ($\\widehat{\\varepsilon}$)**：使用从扰动理论推导出的标度律来估计有效扰动大小：\n    $$ \\widehat{\\varepsilon} = r^m $$\n    这个值提供了从其对谱的影响中推断出的扰动大小的估计。对于 $\\delta > 0$，我们期望 $\\widehat{\\varepsilon}$ 与 $\\delta$ 的量级相当。\n\n收集每个测试用例的结果（$k$ 和 $\\widehat{\\varepsilon}$），并将其格式化为所需的输出字符串。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Conducts numerical experiments to demonstrate the instability of the\n    Jordan canonical form's eigenvalues under perturbation.\n    \"\"\"\n    # Test suite: (m, lambda, delta, seed)\n    test_cases = [\n        (1, 2.0, 1e-12, 0),\n        (2, 0.0, 2**-52, 1),\n        (3, 1.0, 1e-8, 2),\n        (4, 0.5, 0.0, 3),\n        (5, -3.2, 1e-30, 4),\n    ]\n\n    # Tolerance for distinguishing eigenvalues\n    tau = 1e-12\n    \n    results = []\n    \n    for m, lam, delta, seed in test_cases:\n        # 1. Set seed for reproducibility\n        np.random.seed(seed)\n        \n        # 2. Construct matrices\n        # Construct the Jordan block J_m(lambda)\n        J = np.diag(np.full(m, lam)) + np.diag(np.ones(m - 1), k=1)\n        \n        # Construct the random perturbation matrix E\n        E = np.random.standard_normal(size=(m, m))\n        \n        # Construct the perturbed matrix A_delta\n        A_delta = J + delta * E\n        \n        # 3. Compute eigenvalues\n        eigenvalues = np.linalg.eigvals(A_delta)\n        \n        # 4. Count distinct eigenvalues (k)\n        distinct_eigenvalues = []\n        for eig_val in eigenvalues:\n            is_new = True\n            for distinct_eig in distinct_eigenvalues:\n                if np.abs(eig_val - distinct_eig) = tau:\n                    is_new = False\n                    break\n            if is_new:\n                distinct_eigenvalues.append(eig_val)\n        k = len(distinct_eigenvalues)\n        \n        # 5. Calculate eigenvalue spread (r)\n        # Handle the edge case of m=0 for an empty eigenvalues array\n        if m > 0:\n            r = np.max(np.abs(eigenvalues - lam))\n        else:\n            r = 0.0\n            \n        # 6. Estimate effective perturbation (widehat_epsilon)\n        widehat_epsilon = r**m\n        \n        results.append(k)\n        results.append(widehat_epsilon)\n        \n    # Format the final output as a single comma-separated string in brackets.\n    # Use a custom formatter to ensure sufficient precision for small numbers.\n    def format_number(n):\n        if isinstance(n, int):\n            return str(n)\n        # Use scientific notation for small floats to preserve precision.\n        return f\"{n:.16e}\"\n\n    print(f\"[{','.join(map(format_number, results))}]\")\n\nsolve()\n\n```", "id": "3553193"}]}