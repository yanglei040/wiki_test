{"hands_on_practices": [{"introduction": "本次练习回归基础，要求你从内积的定义出发，推导柯西-施瓦茨不等式并确定其等号成立的条件。通过处理一个具体的复向量案例，你将加深对等号成立的几何意义（即向量线性相关）的理解，并练习如何在复空间中进行相关计算。[@problem_id:3536444]", "problem": "设 $\\mathbb{C}^{n}$ 配备标准的埃尔米特内积 $\\langle x,y\\rangle = \\sum_{k=1}^{n} x_{k}\\,\\overline{y_{k}}$，其在第一个参数上是线性的，在第二个参数上是共轭线性的，以及其诱导范数 $\\|x\\| = \\sqrt{\\langle x,x\\rangle}$。考虑向量 $x,y\\in\\mathbb{C}^{n}$，其内积满足 $\\langle x,y\\rangle = 3 - 4 i$，并假设其范数固定为 $\\|x\\| = \\sqrt{14}$ 和 $\\|y\\| = \\dfrac{5}{\\sqrt{14}}$。仅使用内积的定义性质（正定性、线性、共轭对称性）和诱导范数，推导 $|\\langle x,y\\rangle|$ 关于 $\\|x\\|$ 和 $\\|y\\|$ 的一个上界。然后，确定该上界取等号时的充分必要条件。最后，在给定的 $\\langle x,y\\rangle$ 和范数同时满足等式成立的条件下，通过设置 $x = \\lambda\\,y$ 来构造一个满足等式条件的显式向量对，其中复标量 $\\lambda\\in\\mathbb{C}$ 的模和辐角与给定的内积一致。计算 $\\lambda$ 的闭式表达式。你的最终答案必须是 $\\lambda$ 的单一表达式。", "solution": "该问题是有效的，因为它在科学上基于标准线性代数，是自洽、一致且适定的。所提供的数值与柯西-施瓦茨不等式的等号成立情况一致，这是本问题的核心。\n\n该问题要求三个主要部分：推导 $|\\langle x,y\\rangle|$ 的一个上界，等号成立的条件，以及在等号成立条件下计算一个特定的标量 $\\lambda$。\n\n首先，我们推导上界，即柯西-施瓦茨不等式。设 $x$ 和 $y$ 是 $\\mathbb{C}^{n}$ 中的向量。如果 $y$ 是零向量，那么 $\\langle x,y \\rangle = \\langle x, 0 \\cdot y \\rangle = 0 \\langle x, y \\rangle = 0$ 且 $\\|y\\|=0$，所以不等式 $|\\langle x,y\\rangle| \\le \\|x\\|\\|y\\|$ 变为 $0 \\le 0$，这是平凡成立的。我们假设 $y \\ne 0$。\n\n考虑向量 $z = x - \\text{proj}_{y}x$，其中 $\\text{proj}_{y}x$ 是 $x$ 在 $y$ 上的投影。对于给定的埃尔米特内积，该投影由 $\\frac{\\langle x,y \\rangle}{\\|y\\|^2} y$ 给出。所以，令 $z = x - \\frac{\\langle x,y \\rangle}{\\|y\\|^2} y$。\n\n根据内积的正定性，$\\langle z,z \\rangle \\ge 0$。我们现在使用内积的性质来展开这个表达式：在第一个参数上的线性，在第二个参数上的共轭线性，以及共轭对称性（$\\langle u,v \\rangle = \\overline{\\langle v,u \\rangle}$）。\n$$ \\langle z,z \\rangle = \\left\\langle x - \\frac{\\langle x,y \\rangle}{\\|y\\|^2} y, \\quad x - \\frac{\\langle x,y \\rangle}{\\|y\\|^2} y \\right\\rangle $$\n在第一个位置上使用线性：\n$$ = \\left\\langle x, x - \\frac{\\langle x,y \\rangle}{\\|y\\|^2} y \\right\\rangle - \\frac{\\langle x,y \\rangle}{\\|y\\|^2} \\left\\langle y, x - \\frac{\\langle x,y \\rangle}{\\|y\\|^2} y \\right\\rangle $$\n在第二个位置上使用共轭线性：\n$$ = \\langle x,x \\rangle - \\overline{\\left(\\frac{\\langle x,y \\rangle}{\\|y\\|^2}\\right)} \\langle x,y \\rangle - \\frac{\\langle x,y \\rangle}{\\|y\\|^2} \\langle y,x \\rangle + \\frac{\\langle x,y \\rangle}{\\|y\\|^2} \\overline{\\left(\\frac{\\langle x,y \\rangle}{\\|y\\|^2}\\right)} \\langle y,y \\rangle $$\n我们使用以下事实：$\\langle u,u \\rangle = \\|u\\|^2$，$\\langle y,x \\rangle = \\overline{\\langle x,y \\rangle}$，以及对于任意复数 $c$，$c\\overline{c} = |c|^2$。由于 $\\|y\\|^2$ 是一个实数，其共轭是它本身。\n$$ \\langle z,z \\rangle = \\|x\\|^2 - \\frac{\\overline{\\langle x,y \\rangle}}{\\|y\\|^2} \\langle x,y \\rangle - \\frac{\\langle x,y \\rangle}{\\|y\\|^2} \\overline{\\langle x,y \\rangle} + \\frac{\\langle x,y \\rangle \\overline{\\langle x,y \\rangle}}{\\|y\\|^4} \\|y\\|^2 $$\n$$ = \\|x\\|^2 - \\frac{|\\langle x,y \\rangle|^2}{\\|y\\|^2} - \\frac{|\\langle x,y \\rangle|^2}{\\|y\\|^2} + \\frac{|\\langle x,y \\rangle|^2}{\\|y\\|^2} $$\n$$ = \\|x\\|^2 - \\frac{|\\langle x,y \\rangle|^2}{\\|y\\|^2} $$\n由于我们已确定 $\\langle z,z \\rangle \\ge 0$，因此可得：\n$$ \\|x\\|^2 - \\frac{|\\langle x,y \\rangle|^2}{\\|y\\|^2} \\ge 0 $$\n$$ \\|x\\|^2 \\|y\\|^2 \\ge |\\langle x,y \\rangle|^2 $$\n对两边取平方根，我们得到柯西-施瓦茨不等式，它提供了所要求的上界：\n$$ |\\langle x,y \\rangle| \\le \\|x\\| \\|y\\| $$\n\n其次，我们确定等号成立的充分必要条件。等号 $|\\langle x,y \\rangle| = \\|x\\| \\|y\\|$ 成立，当且仅当 $\\langle z,z \\rangle = 0$。根据内积的正定性，$\\langle z,z \\rangle = 0$ 当且仅当 $z=0$。\n代入 $z$ 的定义：\n$$ x - \\frac{\\langle x,y \\rangle}{\\|y\\|^2} y = 0 $$\n这可以重新排列为：\n$$ x = \\left(\\frac{\\langle x,y \\rangle}{\\|y\\|^2}\\right) y $$\n这表明 $x$ 是 $y$ 的一个标量倍。令 $\\lambda = \\frac{\\langle x,y \\rangle}{\\|y\\|^2}$，我们得到 $x = \\lambda y$，其中 $\\lambda \\in \\mathbb{C}$。因此，等号成立的充分必要条件是向量 $x$ 和 $y$ 线性相关。\n\n第三，我们为给定的向量 $x$ 和 $y$ 计算 $\\lambda$ 的具体值，题目说明它们满足等号成立的条件。\n给定的值为：\n$\\langle x,y \\rangle = 3 - 4i$\n$\\|x\\| = \\sqrt{14}$\n$\\|y\\| = \\frac{5}{\\sqrt{14}}$\n\n首先，我们验证这些值确实满足等号成立条件：\n$|\\langle x,y \\rangle| = |3 - 4i| = \\sqrt{3^2 + (-4)^2} = \\sqrt{9+16} = \\sqrt{25} = 5$。\n$\\|x\\| \\|y\\| = \\sqrt{14} \\cdot \\frac{5}{\\sqrt{14}} = 5$。\n由于 $|\\langle x,y \\rangle| = \\|x\\| \\|y\\|$，等号成立的条件得到满足。\n\n我们现在可以使用推导出的公式来计算关联这两个线性相关向量的标量 $\\lambda$：\n$$ \\lambda = \\frac{\\langle x,y \\rangle}{\\|y\\|^2} $$\n我们需要计算 $\\|y\\|^2$：\n$$ \\|y\\|^2 = \\left(\\frac{5}{\\sqrt{14}}\\right)^2 = \\frac{5^2}{(\\sqrt{14})^2} = \\frac{25}{14} $$\n现在，我们将给定的 $\\langle x,y \\rangle$ 值和计算出的 $\\|y\\|^2$ 值代入 $\\lambda$ 的表达式中：\n$$ \\lambda = \\frac{3 - 4i}{\\frac{25}{14}} $$\n$$ \\lambda = (3-4i) \\cdot \\frac{14}{25} = \\frac{14(3-4i)}{25} = \\frac{42 - 56i}{25} $$\n因此，该复标量为 $\\lambda = \\frac{42}{25} - \\frac{56}{25}i$。\n作为验证，如果 $x = \\lambda y$，那么我们必须有 $\\langle x,y \\rangle = \\langle \\lambda y, y \\rangle = \\lambda \\langle y,y \\rangle = \\lambda \\|y\\|^2$。\n$$ \\left( \\frac{42 - 56i}{25} \\right) \\left( \\frac{25}{14} \\right) = \\frac{14(3-4i)}{25} \\frac{25}{14} = 3-4i $$\n这与给定的内积值相匹配。\n同样，我们必须有 $\\|x\\| = \\|\\lambda y\\| = |\\lambda| \\|y\\|$。\n$$ |\\lambda| = \\left|\\frac{14(3-4i)}{25}\\right| = \\frac{14}{25} |3-4i| = \\frac{14}{25} \\sqrt{25} = \\frac{14}{5} $$\n$$ \\|x\\| = \\frac{14}{5} \\cdot \\|y\\| = \\frac{14}{5} \\cdot \\frac{5}{\\sqrt{14}} = \\frac{14}{\\sqrt{14}} = \\sqrt{14} $$\n这与给定的 $x$ 的范数相匹配。两个条件都满足了。", "answer": "$$ \\boxed{\\frac{42}{25} - \\frac{56}{25}i} $$", "id": "3536444"}, {"introduction": "柯西-施瓦茨不等式的思想可以推广到矩阵空间，并根据所选范数的不同，导出不同形式的界。本计算练习旨在探索由算子 $2$-范数和弗罗贝尼乌斯范数导出的两个不同上界的紧致性。你将利用奇异值分解（SVD）来构建特定场景，揭示不同界在何时紧致或松弛，从而深化对这些基本矩阵范数行为的理解。[@problem_id:3536455]", "problem": "设 $A \\in \\mathbb{R}^{n \\times n}$，$x \\in \\mathbb{R}^{n}$，$y \\in \\mathbb{R}^{n}$。考虑向量上的标准欧几里得内积和矩阵上的 Frobenius 内积，其定义为 $\\langle X, Y \\rangle_{F} = \\sum_{i=1}^{n} \\sum_{j=1}^{n} X_{ij} Y_{ij}$，以及相关的范数 $\\|x\\|_{2} = \\sqrt{\\langle x, x \\rangle}$、$\\|A\\|_{F} = \\sqrt{\\langle A, A \\rangle_{F}}$ 和由向量 $2$-范数诱导的算子 $2$-范数 $\\|A\\|_{2}$。仅使用这些定义和内积的 Cauchy–Schwarz 不等式，可以通过两种方式界定双线性形式 $x^{\\top} A y$：通过 Frobenius 范数和通过算子 $2$-范数。目标是量化当 $A$ 具有聚集的奇异值以及当 $x$ 和 $y$ 与 $A$ 的奇异向量对齐或错位时，这两个界的紧致性，并确定基于 Frobenius 范数的界何时渐近地达到尖锐。\n\n按如下方式构造一个具有聚集奇异值的矩阵族。对于固定的整数 $n \\ge 1$ 和 $k$（其中 $1 \\le k \\le n$）以及标量 $\\sigma  0$，定义 $A_{n,k,\\sigma} \\in \\mathbb{R}^{n \\times n}$，其奇异值分解 (singular value decomposition, SVD) 为 $A_{n,k,\\sigma} = U \\Sigma V^{\\top}$，其中 $U \\in \\mathbb{R}^{n \\times n}$ 和 $V \\in \\mathbb{R}^{n \\times n}$ 是正交的，对角矩阵 $\\Sigma \\in \\mathbb{R}^{n \\times n}$ 的前 $k$ 个对角线元素等于 $\\sigma$，其余所有对角线元素等于 $0$。为使此构造在算法上可复现，设 $U$ 为一个具有固定伪随机种子的标准正态矩阵的瘦 QR 分解 (thin QR decomposition) 中的 $Q$ 因子，并调整列的符号以使 $R$ 的对角线元素为非负；以类似方式但使用不同的种子构造 $V$。您可以假设种子是固定的整数，并且构造完全由 $n$、$k$、$\\sigma$ 和种子确定。\n\n对于每个 $A_{n,k,\\sigma}$，考虑用 $U$ 和 $V$ 的列表示的单位向量 $x$ 和 $y$ 的三种选择：\n- 对齐 (Aligned)：$x = u_{1}$ 和 $y = v_{1}$，其中 $u_{i}$ 和 $v_{i}$ 分别表示 $U$ 和 $V$ 的第 $i$ 列。\n- 分散 (Spread)：$x = \\frac{1}{\\sqrt{k}} \\sum_{i=1}^{k} u_{i}$ 和 $y = \\frac{1}{\\sqrt{k}} \\sum_{i=1}^{k} v_{i}$。\n- 错位 (Misaligned)：$x = u_{k+1}$ 和 $y = v_{k+1}$ (此情况仅在 $k  n$ 时定义)。\n\n对于任何给定的三元组 $(A, x, y)$，定义以下两个比率来衡量这两个界的紧致性：\n- $r_{F}(A, x, y) = \\dfrac{|x^{\\top} A y|}{\\|A\\|_{F} \\, \\|x\\|_{2} \\, \\|y\\|_{2}}$，\n- $r_{2}(A, x, y) = \\dfrac{|x^{\\top} A y|}{\\|A\\|_{2} \\, \\|x\\|_{2} \\, \\|y\\|_{2}}$。\n\n同时定义 Frobenius 尖锐度度量 $s_{F}(A) = \\dfrac{\\|A\\|_{2}}{\\|A\\|_{F}}$，它表示在所有单位向量 $x$ 和 $y$ 上 $r_{F}(A, x, y)$ 的最佳可能值。\n\n您的任务是编写一个程序，为指定的 $(n, k, \\sigma)$ 确定性地构造 $A_{n,k,\\sigma}$，形成所需的向量 $(x, y)$，并计算指定的比率。您的实现必须使用上述定义和构造，并且不得依赖任何外部数据或用户输入。\n\n测试套件 (每个项目必须完全按照规定计算):\n- 情况 1：$n = 50$, $k = 1$, $\\sigma = 1$，对齐的 $x, y$。按此顺序输出该情况下的 $r_{F}$、$r_{2}$ 和 $s_{F}$。\n- 情况 2：$n = 60$, $k = 10$, $\\sigma = 1$，对齐的 $x, y$。输出该情况下的 $r_{F}$ 和 $r_{2}$。\n- 情况 3：$n = 60$, $k = 10$, $\\sigma = 1$，分散的 $x, y$。输出该情况下的 $r_{F}$ 和 $r_{2}$。\n- 情况 4：$n = 60$, $k = 10$, $\\sigma = 1$，错位的 $x, y$。输出该情况下的 $r_{F}$ 和 $r_{2}$。\n- 情况 5 (渐近探针)：$n = 64$, $k = 8$, $\\sigma = 1$。输出 $s_{F}$。\n- 情况 6 (渐近探针)：$n = 256$, $k = 256$, $\\sigma = 1$。输出 $s_{F}$。\n- 情况 7 (渐近探针)：$n = 256$, $k = 1$, $\\sigma = 1$。输出 $s_{F}$。\n\n不涉及角度单位。不涉及物理单位。所有输出均为实数。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，该列表包含从情况 1 到情况 7 的结果，按上述顺序依次连接，总共 12 个实数：\n$[$r_{F}^{(1)}, r_{2}^{(1)}, s_{F}^{(1)}, r_{F}^{(2)}, r_{2}^{(2)}, r_{F}^{(3)}, r_{2}^{(3)}, r_{F}^{(4)}, r_{2}^{(4)}, s_{F}^{(5)}, s_{F}^{(6)}, s_{F}^{(7)}$$]$。", "solution": "用户提供了有效的问题陈述。\n\n该问题要求分析由 Cauchy-Schwarz 不等式导出的双线性形式 $x^{\\top} A y$ 的两个界的紧致性。该分析是针对具有聚集奇异值的特定矩阵族 $A_{n,k,\\sigma}$ 以及特定选择的向量 $x$ 和 $y$ 进行的。\n\n### 理论框架\n\n对于一般的内积 $\\langle u, v \\rangle$，Cauchy-Schwarz 不等式指出 $|\\langle u, v \\rangle| \\le \\|u\\| \\|v\\|$，其中 $\\|u\\| = \\sqrt{\\langle u, u \\rangle}$。我们应用此原理来推导 $|x^{\\top} A y|$ 的两个上界。\n\n**1. 算子 2-范数界**\n我们可以将双线性形式表示为欧几里得内积：$x^{\\top} A y = \\langle x, Ay \\rangle$。对向量 $2$-范数应用 Cauchy-Schwarz 不等式可得：\n$|x^{\\top} A y| = |\\langle x, Ay \\rangle| \\le \\|x\\|_{2} \\|Ay\\|_{2}$。\n根据诱导算子 $2$-范数的定义，$\\|A\\|_{2} = \\sup_{\\|v\\|_2=1} \\|Av\\|_2$，我们有 $\\|Ay\\|_{2} \\le \\|A\\|_{2} \\|y\\|_{2}$。结合这些不等式，得到界：\n$$|x^{\\top} A y| \\le \\|A\\|_{2} \\|x\\|_{2} \\|y\\|_{2}$$\n衡量该界紧致性的比率为 $r_{2}(A, x, y) = \\frac{|x^{\\top} A y|}{\\|A\\|_{2} \\|x\\|_{2} \\|y\\|_{2}}$。根据定义，$r_{2} \\le 1$。如果 $r_{2}=1$，则该界是尖锐的。\n\n**2. Frobenius 范数界**\n另外，双线性形式可以写成 Frobenius 内积。两个矩阵 $X, Y \\in \\mathbb{R}^{n \\times n}$ 的 Frobenius 内积是 $\\langle X, Y \\rangle_{F} = \\text{tr}(X^{\\top}Y) = \\sum_{i,j} X_{ij} Y_{ij}$。我们可以写成：\n$x^{\\top} A y = \\sum_{i,j} A_{ij} (x_i y_j) = \\text{tr}(A^{\\top} (xy^{\\top})) = \\langle A, xy^{\\top} \\rangle_{F}$。\n对 Frobenius 内积应用 Cauchy-Schwarz 不等式可得：\n$|x^{\\top} A y| = |\\langle A, xy^{\\top} \\rangle_{F}| \\le \\|A\\|_{F} \\|xy^{\\top}\\|_{F}$。\n秩为 1 的矩阵 $xy^{\\top}$ 的 Frobenius 范数是 $\\|xy^{\\top}\\|_{F} = \\sqrt{\\sum_{i,j} (x_i y_j)^2} = \\sqrt{(\\sum_i x_i^2)(\\sum_j y_j^2)} = \\|x\\|_{2} \\|y\\|_{2}$。这导出了界：\n$$|x^{\\top} A y| \\le \\|A\\|_{F} \\|x\\|_{2} \\|y\\|_{2}$$\n紧致性比率为 $r_{F}(A, x, y) = \\frac{|x^{\\top} A y|}{\\|A\\|_{F} \\|x\\|_{2} \\|y\\|_{2}}$。\n\n### 矩阵族 $A_{n,k,\\sigma}$ 的分析\n矩阵 $A_{n,k,\\sigma}$ 由其奇异值分解 (SVD) $A = U \\Sigma V^{\\top}$ 定义，其中其奇异值为 $\\sigma_1 = \\dots = \\sigma_k = \\sigma  0$ 和 $\\sigma_{k+1} = \\dots = \\sigma_n = 0$。\n\n算子 $2$-范数是最大的奇异值：\n$\\|A\\|_{2} = \\sigma_1 = \\sigma$。\n\nFrobenius 范数是奇异值平方和的平方根：\n$\\|A\\|_{F} = \\sqrt{\\sum_{i=1}^{n} \\sigma_i^2} = \\sqrt{\\sum_{i=1}^{k} \\sigma^2 + \\sum_{i=k+1}^{n} 0^2} = \\sqrt{k\\sigma^2} = \\sigma\\sqrt{k}$。\n\nFrobenius 尖锐度度量 $s_{F}(A)$ 是这些范数的比率：\n$s_{F}(A) = \\dfrac{\\|A\\|_{2}}{\\|A\\|_{F}} = \\dfrac{\\sigma}{\\sigma\\sqrt{k}} = \\dfrac{1}{\\sqrt{k}}$。\n这个度量代表了基于 Frobenius 范数的界的最佳可能紧致性，因为 $\\max_{x,y} |x^{\\top} A y| = \\|A\\|_{2} \\|x\\|_{2} \\|y\\|_{2}$。因此，$\\max_{x,y} r_F(A,x,y) = \\frac{\\|A\\|_2}{\\|A\\|_F} = s_F(A)$。Frobenius 界只有在 $s_F=1$ 时才能是尖锐的 ($r_F=1$)，这要求 $k=1$ (即 $A$ 是一个秩为 1 的矩阵)。\n\n### 向量选择的分析\n我们分析指定单位向量 $x, y$ 的 $x^{\\top} A y$ 的值。使用 SVD，$A = \\sum_{i=1}^n \\sigma_i u_i v_i^{\\top}$，所以 $x^{\\top} A y = \\sum_{i=1}^n \\sigma_i (x^{\\top} u_i) (v_i^{\\top} y)$。对于 $A_{n,k,\\sigma}$，这可以简化为：\n$$x^{\\top} A y = \\sigma \\sum_{i=1}^{k} (x^{\\top} u_i) (v_i^{\\top} y)$$\n设 $\\alpha_i = x^{\\top} u_i$ 和 $\\beta_i = v_i^{\\top} y$。由于 $U$ 和 $V$ 的列是标准正交的，我们可以很容易地计算这些系数。\n\n**情况：对齐向量**\n$x = u_1$ 和 $y = v_1$。\n系数为 $\\alpha_i = u_1^{\\top} u_i = \\delta_{1i}$ 和 $\\beta_i = v_1^{\\top} v_i = \\delta_{1i}$。\n$x^{\\top} A y = \\sigma \\sum_{i=1}^{k} \\delta_{1i} \\delta_{1i} = \\sigma \\cdot 1 = \\sigma$。\n比率 (对于单位向量) 是：\n- $r_{F} = \\dfrac{|\\sigma|}{\\|A\\|_{F}} = \\dfrac{\\sigma}{\\sigma\\sqrt{k}} = \\dfrac{1}{\\sqrt{k}}$。\n- $r_{2} = \\dfrac{|\\sigma|}{\\|A\\|_{2}} = \\dfrac{\\sigma}{\\sigma} = 1$。\n算子 $2$-范数界是尖锐的，而 Frobenius 范数界的紧致性等于尖锐度度量 $s_F$。\n\n**情况：分散向量**\n$x = \\frac{1}{\\sqrt{k}} \\sum_{j=1}^{k} u_{j}$ 和 $y = \\frac{1}{\\sqrt{k}} \\sum_{j=1}^{k} v_{j}$。这些是单位向量。\n系数为 $\\alpha_i = x^{\\top} u_i = \\frac{1}{\\sqrt{k}}$ (对于 $1 \\le i \\le k$)，否则为 $0$。$\\beta_i$ 也类似。\n$x^{\\top} A y = \\sigma \\sum_{i=1}^{k} (\\frac{1}{\\sqrt{k}})(\\frac{1}{\\sqrt{k}}) = \\sigma \\sum_{i=1}^{k} \\frac{1}{k} = \\sigma \\cdot k \\cdot \\frac{1}{k} = \\sigma$。\n该值与对齐情况相同，因此比率也相同：\n- $r_{F} = \\dfrac{1}{\\sqrt{k}}$。\n- $r_{2} = 1$。\n\n**情况：错位向量**\n$x = u_{k+1}$ 和 $y = v_{k+1}$ (对于 $k  n$)。\n系数为 $\\alpha_i = u_{k+1}^{\\top} u_i = \\delta_{k+1,i}$ 和 $\\beta_i = v_{k+1}^{\\top} v_i = \\delta_{k+1,i}$。\n$x^{\\top} A y = \\sigma \\sum_{i=1}^{k} \\delta_{k+1,i} \\delta_{k+1,i} = \\sigma \\cdot 0 = 0$。\n$|x^{\\top} A y| = 0$。因此，两个比率都为零：\n- $r_{F} = 0$。\n- $r_{2} = 0$。\n\n### 计算\n现在我们可以为每个测试用例计算所需的数值。所有情况均设 $\\sigma=1$。\n- **情况 1：** $n=50, k=1, \\sigma=1$，对齐。\n  - $r_{F} = 1/\\sqrt{1} = 1$。\n  - $r_{2} = 1$。\n  - $s_{F} = 1/\\sqrt{1} = 1$。\n  - 结果：$[1.0, 1.0, 1.0]$\n\n- **情况 2：** $n=60, k=10, \\sigma=1$，对齐。\n  - $r_{F} = 1/\\sqrt{10} \\approx 0.316227766$。\n  - $r_{2} = 1$。\n  - 结果：$[0.316227766, 1.0]$\n\n- **情况 3：** $n=60, k=10, \\sigma=1$，分散。\n  - $r_{F} = 1/\\sqrt{10} \\approx 0.316227766$。\n  - $r_{2} = 1$。\n  - 结果：$[0.316227766, 1.0]$\n\n- **情况 4：** $n=60, k=10, \\sigma=1$，错位。\n  - $r_{F} = 0$。\n  - $r_{2} = 0$。\n  - 结果：$[0.0, 0.0]$\n\n- **情况 5：** $n=64, k=8, \\sigma=1$。\n  - $s_{F} = 1/\\sqrt{8} \\approx 0.35355339$。\n  - 结果：$[0.35355339]$\n\n- **情况 6：** $n=256, k=256, \\sigma=1$。\n  - $s_{F} = 1/\\sqrt{256} = 1/16 = 0.0625$。\n  - 结果：$[0.0625]$\n\n- **情况 7：** $n=256, k=1, \\sigma=1$。\n  - $s_{F} = 1/\\sqrt{1} = 1$。\n  - 结果：$[1.0]$\n\n将所有结果连接起来，得到一个包含 12 个实数的列表。给出的代码应该可以正确计算这些值，尽管由于伪随机矩阵生成，实际的 $A$ 矩阵会因种子而异，但理论上的 $r_F, r_2, s_F$ 值对于这些特定选择的 $x,y$ 应该与理论推导相符，因为它们不依赖于 $U$ 和 $V$ 的具体形式。代码会通过数值计算来验证这一点。给出的 Python 代码是确定性的，因为它使用固定的种子，并正确实现了理论分析。因此，该代码应生成一个一致的、可复现的结果，与理论分析一致。\n该代码是有效的，并作为问题的解决方案。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef create_orthogonal_matrix(n, seed):\n    \"\"\"\n    Deterministically creates an n x n orthogonal matrix from a seeded\n    standard normal distribution using QR decomposition.\n    The signs of the columns of Q are adjusted to make the diagonal\n    of R non-negative, ensuring a unique Q for a full-rank matrix.\n    \"\"\"\n    rng = np.random.default_rng(seed)\n    M = rng.standard_normal((n, n))\n    Q, R = np.linalg.qr(M)\n\n    # Adjust signs for uniqueness. diag(R) is almost surely non-zero.\n    # To be fully robust, handle the (highly unlikely) zero case.\n    signs = np.sign(np.diag(R))\n    signs[signs == 0] = 1.0\n    S = np.diag(signs)\n    \n    # Q_new = Q @ S so that R_new = S @ R has a non-negative diagonal.\n    return Q @ S\n\ndef solve():\n    \"\"\"\n    Computes the specified metrics for all test cases.\n    \"\"\"\n    # Fixed seeds for reproducibility as per problem statement's allowance\n    seed_U = 2024\n    seed_V = 2025\n\n    all_results = []\n    \n    # --- Case 1: n=50, k=1, sigma=1, aligned ---\n    n, k, sigma = 50, 1, 1.0\n    U = create_orthogonal_matrix(n, seed_U)\n    V = create_orthogonal_matrix(n, seed_V)\n    Sigma_diag = np.zeros(n); Sigma_diag[:k] = sigma\n    A = U @ np.diag(Sigma_diag) @ V.T\n    \n    norm_A_2 = np.linalg.norm(A, 2)\n    norm_A_F = np.linalg.norm(A, 'fro')\n    s_F = norm_A_2 / norm_A_F if norm_A_F != 0 else 0.0\n\n    x = U[:, 0]\n    y = V[:, 0]\n    \n    abs_xty = np.abs(x.T @ A @ y)\n    norm_x = np.linalg.norm(x, 2)\n    norm_y = np.linalg.norm(y, 2)\n    \n    r_F_denom = norm_A_F * norm_x * norm_y\n    r_2_denom = norm_A_2 * norm_x * norm_y\n    r_F = abs_xty / r_F_denom if r_F_denom != 0 else 0.0\n    r_2 = abs_xty / r_2_denom if r_2_denom != 0 else 0.0\n\n    all_results.extend([r_F, r_2, s_F])\n    \n    # --- Cases 2, 3, 4: n=60, k=10, sigma=1 ---\n    n, k, sigma = 60, 10, 1.0\n    U = create_orthogonal_matrix(n, seed_U)\n    V = create_orthogonal_matrix(n, seed_V)\n    Sigma_diag = np.zeros(n); Sigma_diag[:k] = sigma\n    A = U @ np.diag(Sigma_diag) @ V.T\n    norm_A_2 = np.linalg.norm(A, 2)\n    norm_A_F = np.linalg.norm(A, 'fro')\n    \n    # Case 2: Aligned\n    x = U[:, 0]\n    y = V[:, 0]\n    abs_xty = np.abs(x.T @ A @ y)\n    norm_x = np.linalg.norm(x, 2)\n    norm_y = np.linalg.norm(y, 2)\n    r_F_denom = norm_A_F * norm_x * norm_y\n    r_2_denom = norm_A_2 * norm_x * norm_y\n    r_F = abs_xty / r_F_denom if r_F_denom != 0 else 0.0\n    r_2 = abs_xty / r_2_denom if r_2_denom != 0 else 0.0\n    all_results.extend([r_F, r_2])\n\n    # Case 3: Spread\n    x = np.sum(U[:, :k], axis=1) / np.sqrt(k)\n    y = np.sum(V[:, :k], axis=1) / np.sqrt(k)\n    abs_xty = np.abs(x.T @ A @ y)\n    norm_x = np.linalg.norm(x, 2)\n    norm_y = np.linalg.norm(y, 2)\n    r_F_denom = norm_A_F * norm_x * norm_y\n    r_2_denom = norm_A_2 * norm_x * norm_y\n    r_F = abs_xty / r_F_denom if r_F_denom != 0 else 0.0\n    r_2 = abs_xty / r_2_denom if r_2_denom != 0 else 0.0\n    all_results.extend([r_F, r_2])\n\n    # Case 4: Misaligned\n    x = U[:, k]\n    y = V[:, k]\n    abs_xty = np.abs(x.T @ A @ y)\n    norm_x = np.linalg.norm(x, 2)\n    norm_y = np.linalg.norm(y, 2)\n    r_F_denom = norm_A_F * norm_x * norm_y\n    r_2_denom = norm_A_2 * norm_x * norm_y\n    r_F = abs_xty / r_F_denom if r_F_denom != 0 else 0.0\n    r_2 = abs_xty / r_2_denom if r_2_denom != 0 else 0.0\n    all_results.extend([r_F, r_2])\n    \n    # --- Case 5: s_F for n=64, k=8, sigma=1 ---\n    n, k, sigma = 64, 8, 1.0\n    s_F = 1.0 / np.sqrt(k)\n    all_results.append(s_F)\n    \n    # --- Case 6: s_F for n=256, k=256, sigma=1 ---\n    n, k, sigma = 256, 256, 1.0\n    s_F = 1.0 / np.sqrt(k)\n    all_results.append(s_F)\n\n    # --- Case 7: s_F for n=256, k=1, sigma=1 ---\n    n, k, sigma = 256, 1, 1.0\n    s_F = 1.0 / np.sqrt(k)\n    all_results.append(s_F)\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n\n```", "id": "3536455"}, {"introduction": "在数值分析中，柯西-施瓦茨不等式是推导误差和扰动界的核心工具。本练习将引导你完成一个经典应用：分析瑞利商（Rayleigh quotient）对其输入向量扰动的敏感性。通过从头推导这个上界，你将亲身体验在扰动理论中至关重要的“不等式技巧”，并理解如何量化数值算法的稳定性。[@problem_id:3536475]", "problem": "考虑一个实内积空间 $\\mathbb{R}^n$，其配备了欧几里得内积和范数，其中对于向量 $u,v \\in \\mathbb{R}^n$，有 $\\langle u,v \\rangle = u^\\top v$ 和 $\\|u\\|_2 = \\sqrt{u^\\top u}$。对于一个实对称矩阵 $A \\in \\mathbb{R}^{n \\times n}$，将瑞利商 $q:\\mathbb{R}^n \\setminus \\{0\\} \\to \\mathbb{R}$ 定义为 $q(x) = \\dfrac{x^\\top A x}{x^\\top x}$。令 $\\|\\cdot\\|_2$ 也表示诱导矩阵 2-范数（谱范数），即，对于一个矩阵 $A$，$\\|A\\|_2 = \\max_{\\|x\\|_2=1} \\|A x\\|_2$，它等于最大的奇异值。\n\n您的任务是推导并以计算方式验证在向量扰动下瑞利商的一个非平凡扰动界。令 $x \\in \\mathbb{R}^n \\setminus \\{0\\}$ 和 $\\delta x \\in \\mathbb{R}^n$ 满足 $\\|\\delta x\\|_2  \\|x\\|_2$。记 $y = x + \\delta x$。仅从下面列出的核心定义和经过验证的不等式出发，推导一个显式的、闭合形式的上界 $B(\\|A\\|_2,\\|x\\|_2,\\|\\delta x\\|_2)$，使得\n$$\n\\left| q(y) - q(x) \\right| \\le B\\big(\\|A\\|_2,\\|x\\|_2,\\|\\delta x\\|_2\\big).\n$$\n\n您必须遵守以下推导约束：\n- 仅使用以下基础工具：瑞利商的定义、诱导矩阵 2-范数的定义、柯西-施瓦茨不等式和三角不等式。您可以使用对于任意向量 $u,v$ 和矩阵 $A$，有 $\\left|u^\\top A v\\right| \\le \\|A\\|_2 \\|u\\|_2 \\|v\\|_2$，以及 $\\|x+\\delta x\\|_2 \\ge \\|x\\|_2 - \\|\\delta x\\|_2$。\n- 最终的界 $B(\\cdot,\\cdot,\\cdot)$ 必须仅用标量 $\\|A\\|_2$、$\\|x\\|_2$ 和 $\\|\\delta x\\|_2$ 来表示。$B$ 中不允许出现其他依赖于向量或矩阵的量。\n- 不要引用或假设任何已有的瑞利商扰动结果；从上述定义和不等式推导您的界。\n\n然后，实现一个程序，在一小组结构化测试用例上以数值方式验证您推导出的界的正确性。您的程序必须：\n- 假设所有矩阵 $A$ 都是实对称的。\n- 对于每个测试用例，计算在 $x$ 和 $x+\\delta x$ 处的瑞利商，计算您的界 $B(\\|A\\|_2,\\|x\\|_2,\\|\\delta x\\|_2)$，并返回一个布尔值，指示不等式是否在一个小的绝对容差 $\\tau = 10^{-12}$ 内成立，即是否\n$$\n\\left| q(x+\\delta x) - q(x) \\right| \\le B\\big(\\|A\\|_2,\\|x\\|_2,\\|\\delta x\\|_2\\big) + \\tau.\n$$\n\n测试套件和覆盖率要求：\n- 使用以下六个确定性测试用例，它们覆盖了典型、病态、近边界和退化的扰动。在每种情况下，验证 $\\|\\delta x\\|_2  \\|x\\|_2$ 成立。\n    1. $A_1 = \\mathrm{diag}([\\,1,\\,2,\\,4\\,])$, $x_1 = [\\,1,\\,-1,\\,2\\,]^\\top$, $\\delta x_1 = [\\,10^{-3},\\,-2\\cdot 10^{-3},\\,10^{-3}\\,]^\\top$。\n    2. $A_2 \\in \\mathbb{R}^{5 \\times 5}$ 是一个三对角托普利茨矩阵，主对角线元素为 $2$，次对角线和上对角线元素为 $-1$；$x_2 = [\\,1,\\,2,\\,3,\\,4,\\,5\\,]^\\top$, $\\delta x_2 = [\\,0,\\,10^{-1},\\,0,\\,0,\\,0\\,]^\\top$。\n    3. $A_3 \\in \\mathbb{R}^{5 \\times 5}$ 是希尔伯特矩阵，其元素为 $(A_3)_{ij} = \\dfrac{1}{i+j-1}$，其中索引 $i,j$ 从 $1$ 开始；$x_3 = [\\,1,\\,1,\\,1,\\,1,\\,1\\,]^\\top$, $\\delta x_3 = [\\,0,\\,4\\cdot 10^{-1},\\,0,\\,0,\\,0\\,]^\\top$。\n    4. $A_4 \\in \\mathbb{R}^{8 \\times 8}$ 是一个三对角托普利茨矩阵，主对角线元素为 $2$，次对角线和上对角线元素为 $-1$；$x_4 \\in \\mathbb{R}^8$ 的元素为 $(x_4)_k = \\sin(k)$，其中 $k \\in \\{1,2,\\dots,8\\}$，角度以弧度为单位，且 $\\delta x_4 = -9\\cdot 10^{-1}\\, x_4$。\n    5. $A_5 = \\mathrm{diag}([\\,1,\\,10^{3},\\,10^{6},\\,3,\\,7\\,])$, $x_5 = [\\,1,\\,5\\cdot 10^{-1},\\,-25\\cdot 10^{-2},\\,75\\cdot 10^{-2},\\,-3\\cdot 10^{-1}\\cdot 5\\,]^\\top$, $\\delta x_5 = 10^{-4}\\,[\\,-1,\\,2,\\,-3,\\,4,\\,-5\\,]^\\top$。\n    6. $A_6 = A_2$, $x_6 = [\\,1,\\,-2,\\,1,\\,5\\cdot 10^{-1},\\,-5\\cdot 10^{-1}\\,]^\\top$, $\\delta x_6 = [\\,0,\\,0,\\,0,\\,0,\\,0\\,]^\\top$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，按测试用例 1 到 6 的顺序排列，每个条目是字符串 True 或 False（例如，\"[True,True,False,True,True,True]\"）。", "solution": "用户提供的问题已经过验证，被认为是数值线性代数中的一个有效且适定的问题。现在将介绍扰动界的推导及其数值验证。\n\n### 扰动界的推导\n\n设 $A \\in \\mathbb{R}^{n \\times n}$ 是一个实对称矩阵。对于任意非零向量 $x \\in \\mathbb{R}^n$，瑞利商定义为 $q(x) = \\dfrac{x^\\top A x}{x^\\top x}$。我们需要找到绝对差 $|q(y) - q(x)|$ 的一个界 $B$，其中 $y = x + \\delta x$ 是一个扰动向量，并带有约束 $\\|\\delta x\\|_2  \\|x\\|_2$。界 $B$ 只能依赖于 $\\|A\\|_2$、$\\|x\\|_2$ 和 $\\|\\delta x\\|_2$。\n\n我们首先来表示差值 $q(y) - q(x)$。一种有效的方法是通过从 $q(y)$ 中减去 $q(x)$ 来重写这个差值：\n$$\nq(y) - q(x) = \\frac{y^\\top A y}{y^\\top y} - q(x)\n$$\n为了通分并简化计算，我们可以将第二项乘以 $\\frac{y^\\top y}{y^\\top y} = 1$：\n$$\nq(y) - q(x) = \\frac{y^\\top A y - q(x) (y^\\top y)}{y^\\top y}\n$$\n分子可以表示为 $y^\\top (A - q(x)I) y$，其中 $I$ 是单位矩阵。因此，\n$$\nq(y) - q(x) = \\frac{y^\\top (A - q(x)I) y}{y^\\top y}\n$$\n现在，我们将 $y = x + \\delta x$ 代入分子：\n$$\ny^\\top (A - q(x)I) y = (x + \\delta x)^\\top (A - q(x)I) (x + \\delta x)\n$$\n展开这个二次型会得到三项：\n$$\n(x + \\delta x)^\\top (A - q(x)I) (x + \\delta x) = x^\\top(A - q(x)I)x + 2x^\\top(A - q(x)I)\\delta x + (\\delta x)^\\top(A - q(x)I)\\delta x\n$$\n我们来分析第一项，$x^\\top(A - q(x)I)x$：\n$$\nx^\\top(A - q(x)I)x = x^\\top A x - q(x) (x^\\top x)\n$$\n根据定义，$q(x) = \\frac{x^\\top A x}{x^\\top x}$，所以 $q(x)(x^\\top x) = x^\\top A x$。因此，\n$$\nx^\\top(A - q(x)I)x = x^\\top A x - x^\\top A x = 0\n$$\n这个关键的简化使我们得到：\n$$\nq(y) - q(x) = \\frac{2x^\\top(A - q(x)I)\\delta x + (\\delta x)^\\top(A - q(x)I)\\delta x}{\\|y\\|_2^2}\n$$\n现在我们可以取绝对值并对分子应用三角不等式：\n$$\n|q(y) - q(x)| \\le \\frac{2|x^\\top(A - q(x)I)\\delta x| + |(\\delta x)^\\top(A - q(x)I)\\delta x|}{\\|y\\|_2^2}\n$$\n下一步是使用给定的不等式和定义来界定每一项。令 $M = A - q(x)I$。由于 $A$ 是对称的，$M$ 也是对称的。\n\n首先，我们界定 $|x^\\top M \\delta x|$。这可以写成 $|(Mx)^\\top \\delta x|$。根据柯西-施瓦茨不等式，$|\\langle u, v \\rangle| \\le \\|u\\|_2 \\|v\\|_2$：\n$$\n|(Mx)^\\top \\delta x| \\le \\|Mx\\|_2 \\|\\delta x\\|_2\n$$\n项 $\\|Mx\\|_2$ 可以使用诱导 2-范数的定义来界定：\n$$\n\\|Mx\\|_2 = \\|(A - q(x)I)x\\|_2 \\le \\|A - q(x)I\\|_2 \\|x\\|_2\n$$\n对矩阵范数使用三角不等式，$\\|A - q(x)I\\|_2 \\le \\|A\\|_2 + \\|-q(x)I\\|_2 = \\|A\\|_2 + |q(x)|\\|I\\|_2$。由于 $\\|I\\|_2 = 1$，我们有 $\\|A - q(x)I\\|_2 \\le \\|A\\|_2 + |q(x)|$。\n瑞利商本身受 $A$ 的谱范数所界定。从给定的不等式 $|u^\\top A v| \\le \\|A\\|_2 \\|u\\|_2 \\|v\\|_2$，令 $u=v=x$ 可得 $|x^\\top A x| \\le \\|A\\|_2 \\|x\\|_2^2$。两边除以 $\\|x\\|_2^2 = x^\\top x$ 可得 $|q(x)| \\le \\|A\\|_2$。\n将此代入 $\\|A - q(x)I\\|_2$ 的界中，可得：\n$$\n\\|A - q(x)I\\|_2 \\le \\|A\\|_2 + \\|A\\|_2 = 2\\|A\\|_2\n$$\n结合这些结果，我们得到第一个分子项的一个界：\n$$\n2|x^\\top(A - q(x)I)\\delta x| \\le 2 (\\|A - q(x)I\\|_2 \\|x\\|_2) \\|\\delta x\\|_2 \\le 2(2\\|A\\|_2 \\|x\\|_2)\\|\\delta x\\|_2 = 4\\|A\\|_2 \\|x\\|_2 \\|\\delta x\\|_2\n$$\n其次，我们界定 $|(\\delta x)^\\top M \\delta x|$。使用给定的不等式 $|u^\\top M v| \\le \\|M\\|_2 \\|u\\|_2 \\|v\\|_2$，并令 $u=v=\\delta x$：\n$$\n|(\\delta x)^\\top M \\delta x| \\le \\|M\\|_2 \\|\\delta x\\|_2^2 = \\|A - q(x)I\\|_2 \\|\\delta x\\|_2^2 \\le 2\\|A\\|_2 \\|\\delta x\\|_2^2\n$$\n整个分子的界是这两个界的和：\n$$\n\\text{分子界} \\le 4\\|A\\|_2 \\|x\\|_2 \\|\\delta x\\|_2 + 2\\|A\\|_2 \\|\\delta x\\|_2^2\n$$\n最后，我们需要一个分母 $\\|y\\|_2^2 = \\|x+\\delta x\\|_2^2$ 的下界。使用给定的反三角不等式，$\\|x+\\delta x\\|_2 \\ge \\|x\\|_2 - \\|\\delta x\\|_2$。问题陈述中指出 $\\|\\delta x\\|_2  \\|x\\|_2$，这确保了该下界为正。两边平方可得 $\\|x+\\delta x\\|_2^2 \\ge (\\|x\\|_2 - \\|\\delta x\\|_2)^2$。因此：\n$$\n\\frac{1}{\\|y\\|_2^2} \\le \\frac{1}{(\\|x\\|_2 - \\|\\delta x\\|_2)^2}\n$$\n结合分子和分母的界，我们得到最终的扰动界 $B$：\n$$\n|q(y) - q(x)| \\le \\frac{4\\|A\\|_2 \\|x\\|_2 \\|\\delta x\\|_2 + 2\\|A\\|_2 \\|\\delta x\\|_2^2}{(\\|x\\|_2 - \\|\\delta x\\|_2)^2}\n$$\n提取公因式后，该界表示为：\n$$\nB(\\|A\\|_2, \\|x\\|_2, \\|\\delta x\\|_2) = \\frac{2\\|A\\|_2 \\|\\delta x\\|_2 (2 \\|x\\|_2 + \\|\\delta x\\|_2)}{(\\|x\\|_2 - \\|\\delta x\\|_2)^2}\n$$\n该界完全由 $\\|A\\|_2$、$\\|x\\|_2$ 和 $\\|\\delta x\\|_2$ 表示，符合要求。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import linalg\n\ndef solve():\n    \"\"\"\n    Derives and numerically verifies a perturbation bound for the Rayleigh quotient.\n    \"\"\"\n\n    def make_tridi_toeplitz(n):\n        \"\"\"\n        Creates a symmetric tridiagonal Toeplitz matrix with 2 on the main\n        diagonal and -1 on the first off-diagonals.\n        \"\"\"\n        return np.diag(2 * np.ones(n)) - np.diag(np.ones(n - 1), k=1) - np.diag(np.ones(n - 1), k=-1)\n\n    # Define the tolerance for numerical verification.\n    tau = 1e-12\n\n    # Define the six deterministic test cases.\n    A1 = np.diag([1.0, 2.0, 4.0])\n    x1 = np.array([1.0, -1.0, 2.0])\n    dx1 = np.array([1e-3, -2e-3, 1e-3])\n\n    A2 = make_tridi_toeplitz(5)\n    x2 = np.arange(1.0, 6.0)\n    dx2 = np.array([0.0, 1e-1, 0.0, 0.0, 0.0])\n    \n    A3 = linalg.hilbert(5)\n    x3 = np.ones(5)\n    dx3 = np.array([0.0, 4e-1, 0.0, 0.0, 0.0])\n\n    A4 = make_tridi_toeplitz(8)\n    x4 = np.sin(np.arange(1, 9, dtype=float))\n    dx4 = -9e-1 * x4\n\n    A5 = np.diag([1.0, 1e3, 1e6, 3.0, 7.0])\n    x5 = np.array([1.0, 0.5, -0.25, 0.75, -1.5]) \n    dx5 = 1e-4 * np.array([-1.0, 2.0, -3.0, 4.0, -5.0])\n\n    A6 = A2\n    x6 = np.array([1.0, -2.0, 1.0, 0.5, -0.5])\n    dx6 = np.zeros(5)\n    \n    test_cases = [\n        (A1, x1, dx1),\n        (A2, x2, dx2),\n        (A3, x3, dx3),\n        (A4, x4, dx4),\n        (A5, x5, dx5),\n        (A6, x6, dx6),\n    ]\n\n    results = []\n    for A, x, dx in test_cases:\n        # Check problem condition ||dx||_2  ||x||_2.\n        norm_x = np.linalg.norm(x, 2)\n        norm_dx = np.linalg.norm(dx, 2)\n        if not (norm_dx  norm_x):\n            # This case violates problem assumptions.\n            # While not expected, we handle it by marking as invalid (False).\n            # This can happen if norm_dx is extremely close to norm_x due to float precision.\n            results.append(False)\n            continue\n\n        # Compute Rayleigh quotients.\n        y = x + dx\n        \n        # Guard against zero-division for the case x=0, which is disallowed by problem.\n        # The condition norm_dx  norm_x also prevents y=0.\n        q_x = (x.T @ A @ x) / (x.T @ x)\n        q_y = (y.T @ A @ y) / (y.T @ y)\n\n        # Compute the absolute difference (LHS of the inequality).\n        diff = abs(q_y - q_x)\n\n        # Compute the derived bound B (RHS of the inequality).\n        norm_A = np.linalg.norm(A, 2)\n        \n        # Handle the dx=0 case. The bound numerator becomes 0, so B=0.\n        if norm_dx == 0:\n            B = 0.0\n        else:\n            bound_numerator = 2 * norm_A * norm_dx * (2 * norm_x + norm_dx)\n            bound_denominator = (norm_x - norm_dx)**2\n            B = bound_numerator / bound_denominator\n\n        # Verify the inequality with the given tolerance.\n        inequality_holds = (diff = B + tau)\n        results.append(inequality_holds)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3536475"}]}