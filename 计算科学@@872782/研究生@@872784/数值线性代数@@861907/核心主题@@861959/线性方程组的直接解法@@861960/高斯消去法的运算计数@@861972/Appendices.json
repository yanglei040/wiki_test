{"hands_on_practices": [{"introduction": "理论知识需要通过实践来巩固。让我们从最基本的高斯消元法开始，精确计算其运算成本。这个练习将引导你逐层剖析算法，推导出其在前向消元阶段所需浮点运算（flops）的精确数量，而不是仅仅满足于渐近复杂度的大$\\mathcal{O}$表示法。通过这个基础练习，你将为分析更复杂的算法变体打下坚实的基础。[@problem_id:3562232]", "problem": "考虑对一个稠密的 $n \\times n$ 实数矩阵应用经典的不带主元选择的 Gaussian 消元算法来计算其下-上 (LU) 分解。采用如下的运算计数约定：一次浮点乘法计为 1 次浮点运算（flop），一次浮点加法或减法计为 1 次浮点运算，而浮点除法单独计数（不计入总 flop 数）。从消元算法的结构出发，推导出完成消元阶段所需的总浮点运算次数（仅计算加法和乘法）的精确封闭形式表达式，然后计算当 $n=1000$ 时该表达式的值。最终答案请表示为一个无舍入的精确整数。你可以在推导过程中单独说明除法的次数，但最终要求的答案是不包括除法的总浮点运算次数。", "solution": "本题要求推导对一个稠密的 $n \\times n$ 矩阵进行 Gaussian 消元的消元阶段所需的精确浮点运算（flops）次数，并计算当 $n=1000$ 时该计数值。一次 flop 定义为一次乘法或一次加法/减法。除法单独计数，并从最终的 flop 总数中排除。\n\nGaussian 消元算法通过在主对角线下方引入零，将矩阵 $A$ 转换为一个上三角矩阵 $U$。这个过程分 $n-1$ 个阶段进行。设 $A^{(k)}$ 表示第 $k-1$ 阶段结束时的矩阵，其中 $A^{(1)} = A$。\n\n在第 $k$ 阶段（$k=1, 2, \\dots, n-1$），目标是消除第 $k$ 列中主元 $a_{kk}^{(k)}$ 下方的非零元素。这是通过对从 $k+1$ 到 $n$ 的每一行 $i$ 执行行变换来实现的。\n\n对于每一行 $i$（其中 $i \\in \\{k+1, \\dots, n\\}$）：\n1.  计算一个乘数 $m_{ik}$。该乘数将存储在下三角矩阵 $L$ 的 $(i, k)$ 位置。\n    $$ m_{ik} = \\frac{a_{ik}^{(k)}}{a_{kk}^{(k)}} $$\n    这个操作构成 1 次除法。由于这是对从 $k+1$ 到 $n$ 的每一行 $i$ 进行的，所以在第 $k$ 阶段有 $n-k$ 次除法。\n\n2.  通过从第 $i$ 行减去 $m_{ik}$ 乘以第 $k$ 行来更新第 $i$ 行。第 $i$ 行元素的更新规则是：\n    $$ a_{ij}^{(k+1)} = a_{ij}^{(k)} - m_{ik} \\cdot a_{kj}^{(k)} $$\n    根据构造，元素 $a_{ik}^{(k+1)}$ 变为 $0$，不需要计算。实际的计算是针对列 $j=k+1, \\dots, n$ 中的元素。这些列的数量是 $n - (k+1) + 1 = n-k$。\n    对于每个被更新的元素 $a_{ij}^{(k+1)}$，操作 $a_{ij}^{(k)} - m_{ik} \\cdot a_{kj}^{(k)}$ 涉及 1 次乘法和 1 次减法，总共 2 次 flops。\n    因此，更新单行 $i$ 需要 $2(n-k)$ 次 flops。\n\n由于在第 $k$ 阶段有 $n-k$ 行需要更新（从 $i=k+1$ 到 $n$），所以第 $k$ 阶段的 flop 总数是：\n$$ \\text{Flops}_k = (n-k) \\times 2(n-k) = 2(n-k)^2 $$\n\n为了求出整个消元过程的 flop 总数 $F_n$，我们将从第 $k=1$ 阶段到第 $k=n-1$ 阶段的 flop 数相加：\n$$ F_n = \\sum_{k=1}^{n-1} \\text{Flops}_k = \\sum_{k=1}^{n-1} 2(n-k)^2 $$\n我们可以通过换元来简化这个求和。令 $j = n-k$。当 $k$ 从 $1$ 变到 $n-1$ 时，$j$ 从 $n-1$ 递减到 $1$。\n$$ F_n = 2 \\sum_{j=1}^{n-1} j^2 $$\n使用著名公式，前 $m$ 个平方数的和为 $\\sum_{j=1}^{m} j^2 = \\frac{m(m+1)(2m+1)}{6}$，其中 $m=n-1$：\n$$ F_n = 2 \\left( \\frac{(n-1)((n-1)+1)(2(n-1)+1)}{6} \\right) $$\n$$ F_n = 2 \\left( \\frac{(n-1)n(2n-1)}{6} \\right) $$\n$$ F_n = \\frac{n(n-1)(2n-1)}{3} $$\n展开此表达式得到多项式形式：\n$$ F_n = \\frac{n(2n^2 - 3n + 1)}{3} = \\frac{2}{3}n^3 - n^2 + \\frac{1}{3}n $$\n这就是总 flop 数（乘法和加法/减法）的精确封闭形式表达式。\n\n为了完整起见，总除法次数 $D_n$ 是每个阶段除法次数的总和：\n$$ D_n = \\sum_{k=1}^{n-1} (n-k) = \\sum_{j=1}^{n-1} j = \\frac{(n-1)n}{2} = \\frac{1}{2}n^2 - \\frac{1}{2}n $$\n\n题目要求计算 $n=1000$ 时的 $F_n$ 值。将 $n=1000$ 代入推导出的公式中：\n$$ F_{1000} = \\frac{1000(1000-1)(2 \\cdot 1000 - 1)}{3} $$\n$$ F_{1000} = \\frac{1000 \\cdot 999 \\cdot 1999}{3} $$\n由于 $999 = 3 \\cdot 333$，我们可以简化表达式：\n$$ F_{1000} = 1000 \\cdot \\frac{999}{3} \\cdot 1999 = 1000 \\cdot 333 \\cdot 1999 $$\n为了计算最终的整数值：\n$$ F_{1000} = 333000 \\cdot 1999 $$\n$$ F_{1000} = 333000 \\cdot (2000 - 1) $$\n$$ F_{1000} = 333000 \\cdot 2000 - 333000 \\cdot 1 $$\n$$ F_{1000} = 666000000 - 333000 $$\n$$ F_{1000} = 665667000 $$\n这就是 $n=1000$ 时总 flop 数的精确整数值。", "answer": "$$\n\\boxed{665667000}\n$$", "id": "3562232"}, {"introduction": "在科学与工程计算中，我们常常需要用同一个系数矩阵$A$求解多个右端项$b$。在这种情况下，一个关键的策略问题是：一次性计算$A$的LU分解，然后多次使用它来快速求解，这样做是否划算？这个练习将引导你分析一次性分解成本和多次求解成本之间的平衡点。通过推导这个“交叉点”，你将学会如何根据问题的规模来选择最高效的计算策略。[@problem_id:3562285]", "problem": "设 $A \\in \\mathbb{R}^{n \\times n}$ 是一个稠密非奇异矩阵，并且假设您必须求解 $A x^{(j)} = b^{(j)}$，其中 $j = 1, \\dots, k$，$k = k(n)$ 随 $n$ 变化。您将进行一次带部分主元的高斯消元，以获得单位下三角和上三角分解 $A = P L U$（其中 $P$ 是一个置换矩阵），然后对每个右端项进行前向和后向代换。从高斯消元和三角求解的算法定义出发，并使用浮点运算（flop）计数，其中乘法和加法分开计数，完成以下任务：\n\n- 推导一次性分解的主阶浮点运算次数，用 $n$ 表示。\n- 推导对 $k$ 个右端项执行所有前向和后向代换的主阶浮点运算次数，用 $n$ 和 $k$ 表示。\n\n假设数据是稠密存取的并忽略低阶项。使用您推导的表达式，分析 $n \\to \\infty$ 且 $k = k(n)$ 随 $n$ 变化的渐近情况，并确定交叉点 $k^{\\star}(n)$，在该点上，累积求解成本首次等于一次性分解成本。将您的最终答案表示为关于 $n$ 的 $k^{\\star}(n)$ 的封闭形式解析表达式。不需要四舍五入，也不涉及单位。您的最终答案必须是单个表达式。", "solution": "问题要求推导交叉点，记为 $k^{\\star}(n)$，在该点上，通过一次性 LU 分解和随后的代换求解 $k$ 个线性系统的计算成本等于分解本身的成本。我们在矩阵大小 $n \\to \\infty$ 的渐近情况下分析这个问题。分析依赖于计算浮点运算（flops）次数，按规定，乘法和加法分开计数。\n\n首先，我们推导使用高斯消元法对一个稠密的 $n \\times n$ 矩阵 $A$ 进行 LU 分解的主阶浮点运算次数。该过程包含 $n-1$ 步。在第 $i$ 步（$i=1, 2, \\dots, n-1$），我们消去第 $i$ 列对角线下方的非零元素。这是通过对行 $j=i+1, \\dots, n$ 执行行变换来实现的。\n\n对于主元行 $i$ 下方的每一行 $j$，过程如下：\n1.  计算乘数 $L_{ji} = A_{ji}^{(i-1)} / A_{ii}^{(i-1)}$。这需要 1 次除法。我们将除法和乘法一起计数。\n2.  对所有列 $k = i+1, \\dots, n$ 更新行 $j$。更新规则为 $A_{jk}^{(i)} \\leftarrow A_{jk}^{(i-1)} - L_{ji} A_{ik}^{(i-1)}$。对于每一列 $k$，这需要 1 次乘法和 1 次加法（或减法）。\n\n在第 $i$ 步，我们处理一个 $(n-i+1) \\times (n-i+1)$ 的子矩阵。\n-   需要计算的乘数数量：主元行下方有 $n-i$ 行，因此我们计算 $n-i$ 个乘数。这贡献了 $n-i$ 次除法。\n-   行更新数量：对于 $n-i$ 行中的每一行，我们更新第 $i+1$ 列到第 $n$ 列的元素。共有 $n-i$ 列。每个元素的更新需要 1 次乘法和 1 次加法。因此，对于 $n-i$ 行中的每一行，更新成本为 $(n-i)$ 次乘法和 $(n-i)$ 次加法。\n-   第 $i$ 步的总运算次数：\n    -   乘法/除法：$(n-i) + (n-i)(n-i) = (n-i) + (n-i)^2$。\n    -   加法/减法：$(n-i)(n-i) = (n-i)^2$。\n\n为求得分解的总成本，我们对所有步骤 $i = 1, \\dots, n-1$ 求和：\n-   总乘法/除法次数：$C_{\\text{mult}} = \\sum_{i=1}^{n-1} ((n-i) + (n-i)^2)$。\n-   总加法/减法次数：$C_{\\text{add}} = \\sum_{i=1}^{n-1} (n-i)^2$。\n\n我们关心的是当 $n \\to \\infty$ 时的主阶项。两个和式中的主导项都是包含 $(n-i)^2$ 的项。令 $j = n-i$。当 $i$ 从 $1$ 取到 $n-1$ 时，$j$ 从 $n-1$ 取到 $1$。乘法和加法的主阶成本都由和式 $\\sum_{j=1}^{n-1} j^2$ 决定。\n使用平方和公式 $\\sum_{j=1}^{m} j^2 = \\frac{m(m+1)(2m+1)}{6}$：\n$$ \\sum_{j=1}^{n-1} j^2 = \\frac{(n-1)(n)(2(n-1)+1)}{6} = \\frac{(n-1)n(2n-1)}{6} = \\frac{2n^3 - 3n^2 + n}{6} $$\n当 $n \\to \\infty$ 时，此和式的主阶项是 $\\frac{2n^3}{6} = \\frac{n^3}{3}$。\n因此，主阶成本为：\n-   $C_{\\text{mult, fact}} \\approx \\frac{n^3}{3}$\n-   $C_{\\text{add, fact}} \\approx \\frac{n^3}{3}$\n分解的总主阶浮点运算次数为 $C_{\\text{fact}} \\approx \\frac{n^3}{3} + \\frac{n^3}{3} = \\frac{2}{3}n^3$。\n\n接下来，我们推导求解单个右端向量 $b$ 的系统所需的成本。得到分解 $A=PLU$ 后，求解 $Ax = b$ 变为求解 $LUx = P^T b$。这是一个两步过程。首先，定义 $y = Ux$，并通过前向代换求解下三角系统 $Ly=P^T b$。其次，通过后向代换求解上三角系统 $Ux=y$。置换 $P^T b$ 只是元素的重排，成本为 0 次浮点运算。\n\n1.  **前向代换：** 我们求解 $Ly=P^T b$。由于 $L$ 是单位下三角矩阵（$L_{ii}=1$），$y$ 的每个分量的公式为：\n    $$ y_i = (P^T b)_i - \\sum_{j=1}^{i-1} L_{ij} y_j, \\quad \\text{for } i = 1, \\dots, n $$\n    对于每个 $i$，计算 $y_i$ 需要 $i-1$ 次乘法和 $i-1$ 次加法。\n    总成本为：\n    -   $C_{\\text{mult, fwd}} = \\sum_{i=1}^{n} (i-1) = \\frac{(n-1)n}{2} = \\frac{n^2}{2} - \\frac{n}{2}$。\n    -   $C_{\\text{add, fwd}} = \\sum_{i=1}^{n} (i-1) = \\frac{(n-1)n}{2} = \\frac{n^2}{2} - \\frac{n}{2}$。\n    前向代换的主阶成本是 $\\frac{n^2}{2}$ 次乘法和 $\\frac{n^2}{2}$ 次加法。\n\n2.  **后向代换：** 我们求解 $Ux=y$。$x$ 的每个分量的公式为：\n    $$ x_i = \\frac{1}{U_{ii}} \\left( y_i - \\sum_{j=i+1}^{n} U_{ij} x_j \\right), \\quad \\text{for } i = n, \\dots, 1 $$\n    对于每个 $i$，计算 $x_i$ 需要 $(n-i)$ 次乘法、$(n-i)$ 次加法和 1 次除法。\n    总成本为：\n    -   $C_{\\text{mult/div, bwd}} = \\sum_{i=1}^{n} ((n-i) + 1) = \\left(\\sum_{j=0}^{n-1} j\\right) + n = \\frac{(n-1)n}{2} + n = \\frac{n^2-n+2n}{2} = \\frac{n^2}{2} + \\frac{n}{2}$。\n    -   $C_{\\text{add, bwd}} = \\sum_{i=1}^{n} (n-i) = \\sum_{j=0}^{n-1} j = \\frac{(n-1)n}{2} = \\frac{n^2}{2} - \\frac{n}{2}$。\n    后向代换的主阶成本是 $\\frac{n^2}{2}$ 次乘法/除法和 $\\frac{n^2}{2}$ 次加法。\n\n单次求解的总成本（$C_{\\text{solve}}$）是前向和后向代换成本之和。\n-   每次求解的总乘法/除法次数：$C_{\\text{mult, solve}} \\approx \\frac{n^2}{2} + \\frac{n^2}{2} = n^2$。\n-   每次求解的总加法/减法次数：$C_{\\text{add, solve}} \\approx \\frac{n^2}{2} + \\frac{n^2}{2} = n^2$。\n单次求解的总主阶浮点运算次数为 $C_{\\text{solve}} \\approx n^2 + n^2 = 2n^2$。\n\n求解 $k$ 个右端项的总成本是 $C_{\\text{solves}} = k \\cdot C_{\\text{solve}}$。在渐近极限下，这是 $C_{\\text{solves}} \\approx k(2n^2)$。\n\n交叉点 $k^{\\star}(n)$ 是累积求解成本等于一次性分解成本时的 $k$ 值。我们将这些成本的主阶表达式设为相等：\n$$ C_{\\text{fact}} = C_{\\text{solves}} $$\n$$ \\frac{2}{3}n^3 = k^{\\star}(n) \\cdot (2n^2) $$\n求解 $k^{\\star}(n)$：\n$$ k^{\\star}(n) = \\frac{\\frac{2}{3}n^3}{2n^2} = \\frac{2n^3}{6n^2} = \\frac{n}{3} $$\n因此，求解次数必须约为矩阵维度的三分之一，才能使求解成本与初始分解成本相匹配。", "answer": "$$\\boxed{\\frac{n}{3}}$$", "id": "3562285"}, {"introduction": "为了在现代计算机体系结构上获得极致性能，数值库（如LAPACK）采用的是分块算法，而非简单的“教科书式”高斯消元。这个练习要求你分析分块高斯消元法的运算量，并特别注意当矩阵尺寸$n$不是分块大小$b$的整数倍时的边界情况。令人惊讶的是，你将发现分块算法的浮点运算总数与非分块算法相同，这个练习揭示了分块优化的本质——它通过优化数据局部性来提升性能，而非减少算术运算。[@problem_id:3562237]", "problem": "考虑对一个稠密的 $n \\times n$ 矩阵 $A$ 应用右视分块部分主元高斯消去法，其中块（条带）的宽度是一个正整数 $b$，满足 $1 \\leq b \\leq n$。令 $s = \\lfloor n / b \\rfloor$ 表示宽度为 $b$ 的完整条带的数量，令 $r = n - s b$ 表示最终条带的大小，满足 $0 \\leq r  b$。在此算法中，每次迭代包括对当前的 $(n - j) \\times p$ 条带进行条带分解（对于完整条带 $p = b$，如果 $r \\neq 0$，则对于最终条带 $p = r$），然后通过三角求解形成后续子矩阵上方的块行，最后通过分块矩阵-矩阵乘法更新后续子矩阵。假设以下条件，均与数值线性代数中的标准实践一致：\n- 将浮点加法、浮点乘法和浮点除法均计为一次浮点运算（flop）。将减法视为加法。忽略主元搜索的比较成本和行交换（数据移动）的成本。\n- 条带分解对条带内的列进行非分块部分主元高斯消去法，对每个消去的列在条带内使用秩-1更新。\n- 三角求解使用单位下三角前向替换来形成后续子矩阵上方的块行 $U_{12}$。\n- 后续子矩阵更新通过分块矩阵-矩阵乘法形成 $A_{22} \\leftarrow A_{22} - L_{21} U_{12}$。\n\n从这些规则出发，且不引用任何关于高斯消去法成本的预先给出的公式，推导出整个分块算法执行的浮点运算的确切总数，并明确考虑当 $n$ 不是 $b$ 的倍数时的情况（此时最终条带的宽度为 $r$，该阶段的三角求解和后续子矩阵更新可能会退化）。将你的最终答案表示为关于 $n$ 和 $b$ 的单个闭式解析表达式。不需要四舍五入，且表达式中不得包含任何物理单位。", "solution": "浮点运算（flops）的总数是所有迭代中浮点运算之和。该算法对宽度为 $b$ 的完整条带执行 $s = \\lfloor n/b \\rfloor$ 次迭代，如果 $r = n-sb  0$，则在宽度为 $r$ 的条带上执行最后一步。\n\n### 单个完整条带迭代的成本\n我们来分析一次对大小为 $m \\times m$ 的子矩阵使用宽度为 $b$ 的条带进行的迭代。矩阵被划分为 $A = \\begin{pmatrix} A_{11}  A_{12} \\\\ A_{21}  A_{22} \\end{pmatrix}$，其中条带是 $\\begin{pmatrix} A_{11} \\\\ A_{21} \\end{pmatrix}$，一个 $m \\times b$ 的矩阵。因此，$A_{11}$ 是 $b \\times b$，$A_{21}$ 是 $(m-b) \\times b$，$A_{12}$ 是 $b \\times (m-b)$，$A_{22}$ 是 $(m-b) \\times (m-b)$。\n\n**1. 条带分解成本, $C_{\\text{panel}}(m, b)$**\n此步骤对 $m \\times b$ 的条带执行非分块高斯消去法。对第 $k$ 列（0-索引，$k=0, \\dots, b-1$）的成本包括：\n-   计算 $m-k-1$ 个乘数（每个一次除法）。\n-   对后续的 $(m-k-1) \\times (b-k-1)$ 子矩阵执行秩-1更新，成本为 $2(m-k-1)(b-k-1)$ 次浮点运算（每个元素一次乘法和一次加法）。\n条带的总成本是其所有列的成本之和：\n$$C_{\\text{panel}}(m,b) = \\sum_{k=0}^{b-1} \\left[ (m-k-1) + 2(m-k-1)(b-k-1) \\right] = \\sum_{k=0}^{b-1} (m-k-1)(2b-2k-1)$$\n该和式计算得出对一个 $m \\times b$ 矩阵进行 LU 分解的确切浮点运算次数：\n$$C_{\\text{panel}}(m, b) = mb^2 - \\frac{1}{3}b^3 - \\frac{1}{2}b^2 - \\frac{1}{6}b$$\n\n**2. 三角求解成本, $C_{\\text{trsm}}(m, b)$**\n此步骤求解 $L_{11} U_{12} = A_{12}$，其中 $L_{11}$ 是一个 $b \\times b$ 的单位下三角矩阵，$A_{12}$（以及 $U_{12}$）是一个 $b \\times (m-b)$ 的矩阵。这是通过对 $m-b$ 个列中的每一个进行前向替换来完成的。\n求解一个 $b \\times b$ 单位下三角系统 $L\\mathbf{x}=\\mathbf{y}$ 的成本是：\n$\\sum_{i=1}^{b} (i-1) \\text{ 次乘法} + \\sum_{i=1}^{b} (i-1) \\text{ 次加法} = 2 \\sum_{j=0}^{b-1} j = 2 \\frac{(b-1)b}{2} = b(b-1)$ 次浮点运算。\n因为有 $m-b$ 列，总成本是：\n$$C_{\\text{trsm}}(m, b) = (m-b)b(b-1) = m(b^2-b) - (b^3-b^2)$$\n\n**3. 后续子矩阵更新成本, $C_{\\text{update}}(m, b)$**\n此步骤计算 $A_{22} \\leftarrow A_{22} - L_{21} U_{12}$。\n-   $L_{21}$ 是一个 $(m-b) \\times b$ 的矩阵。\n-   $U_{12}$ 是一个 $b \\times (m-b)$ 的矩阵。\n乘积 $L_{21} U_{12}$ 是一个 $(m-b) \\times (m-b)$ 的矩阵。每个元素需要 $b$ 次乘法和 $b-1$ 次加法，成本为 $2b-1$ 次浮点运算。乘法的总成本是 $(m-b)^2(2b-1)$。\n矩阵减法额外增加 $(m-b)^2$ 次浮点运算。\n总更新成本：\n$$C_{\\text{update}}(m, b) = (m-b)^2(2b-1) + (m-b)^2 = 2b(m-b)^2 = 2bm^2 - 4b^2m + 2b^3$$\n\n**一次迭代的总成本, $C_{\\text{step}}(m, b)$**\n将三个部分相加：\n$C_{\\text{step}}(m, b) = C_{\\text{panel}} + C_{\\text{trsm}} + C_{\\text{update}}$\n$$C_{\\text{step}}(m, b) = (mb^2 - \\frac{b^3}{3} - \\frac{b^2}{2} - \\frac{b}{6}) + (m(b^2-b) - b^3+b^2) + (2bm^2 - 4b^2m + 2b^3)$$\n按 $m$ 的幂次收集项：\n$$C_{\\text{step}}(m, b) = (2b)m^2 + (b^2 + b^2-b - 4b^2)m + (-\\frac{b^3}{3}-b^3+2b^3 - \\frac{b^2}{2}+b^2 - \\frac{b}{6})$$\n$$C_{\\text{step}}(m, b) = 2bm^2 - (2b^2+b)m + \\frac{2}{3}b^3 + \\frac{1}{2}b^2 - \\frac{b}{6}$$\n\n### 对所有迭代求和\n\n**完整条带迭代**\n有 $s = \\lfloor n/b \\rfloor$ 次完整条带步骤。第 $k$ 次迭代（$k=0, \\dots, s-1$）作用于大小为 $m_k = n-kb$ 的矩阵。\n我们改变求和索引。令 $j=s-k$，所以我们从 $j=1$ 到 $s$ 求和。矩阵大小为 $m_j = n-(s-j)b = (n-sb)+jb = r+jb$。\n$$C_{\\text{full}} = \\sum_{j=1}^{s} C_{\\text{step}}(jb+r, b)$$\n$$C_{\\text{full}} = \\sum_{j=1}^{s} \\left[ 2b(jb+r)^2 - (2b^2+b)(jb+r) + \\frac{2}{3}b^3 + \\frac{1}{2}b^2 - \\frac{b}{6} \\right]$$\n这是一个关于 $j$ 的二次多项式的和。展开并收集 $j^2, j^1, j^0$ 的系数：\n-   $j^2$ 的系数：$2b(b^2) = 2b^3$\n-   $j^1$ 的系数：$2b(2br) - (2b^2+b)b = 4b^2r - 2b^3 - b^2$\n-   $j^0$ 的系数：$2b(r^2) - (2b^2+b)r + (\\frac{2}{3}b^3 + \\frac{1}{2}b^2 - \\frac{b}{6})$\n\n使用求和公式 $\\sum_{j=1}^s j^2 = \\frac{s(s+1)(2s+1)}{6}$，$\\sum_{j=1}^s j = \\frac{s(s+1)}{2}$，以及 $\\sum_{j=1}^s 1 = s$：\n$$C_{\\text{full}} = (2b^3)\\frac{s(s+1)(2s+1)}{6} + (4b^2r-2b^3-b^2)\\frac{s(s+1)}{2} + (2br^2 - 2b^2r -br + \\frac{2}{3}b^3 + \\frac{1}{2}b^2 - \\frac{b}{6})s$$\n展开并按 $s$ 的幂次收集项：\n$$C_{\\text{full}} = \\frac{2}{3}b^3s^3 + (2b^2r - \\frac{1}{2}b^2)s^2 + (2br^2 - br - \\frac{1}{6}b)s$$\n\n**最后一步的成本（余项）**\n如果 $r = n-sb  0$，最后一步处理剩余的 $r \\times r$ 矩阵。这对应于对该矩阵进行完整的 LU 分解。成本为 $C_{\\text{final}} = C_{\\text{panel}}(r,r)$。\n$$C_{\\text{final}} = r \\cdot r^2 - \\frac{1}{3}r^3 - \\frac{1}{2}r^2 - \\frac{1}{6}r = \\frac{2}{3}r^3 - \\frac{1}{2}r^2 - \\frac{1}{6}r$$\n如果 $r=0$，此成本为 $0$。\n\n### 总成本\n总成本是 $C_{\\text{total}} = C_{\\text{full}} + C_{\\text{final}}$。\n$$C_{\\text{total}} = \\left(\\frac{2}{3}b^3s^3 + 2b^2rs^2 - \\frac{1}{2}b^2s^2 + 2br^2s - brs - \\frac{1}{6}bs\\right) + \\left(\\frac{2}{3}r^3 - \\frac{1}{2}r^2 - \\frac{1}{6}r\\right)$$\n为了用 $n$ 和 $b$ 表示，我们代入 $s = (n-r)/b$。\n-   $b^3s^3 = (n-r)^3 = n^3 - 3n^2r + 3nr^2 - r^3$\n-   $b^2s^2 = (n-r)^2 = n^2 - 2nr + r^2$\n-   $bs = n-r$\n\n$$C_{\\text{total}} = \\frac{2}{3}(n-r)^3 + 2r(n-r)^2 - \\frac{1}{2}(n-r)^2 + 2r^2(n-r) - r(n-r) - \\frac{1}{6}(n-r) + \\frac{2}{3}r^3 - \\frac{1}{2}r^2 - \\frac{1}{6}r$$\n展开此表达式并按 $n$ 的幂次收集项：\n-   $n^3$ 项：$\\frac{2}{3}n^3$\n-   $n^2$ 项：$(\\frac{2}{3}(-3r) + 2r(1) - \\frac{1}{2}(1))n^2 = (-2r+2r-\\frac{1}{2})n^2 = -\\frac{1}{2}n^2$\n-   $n^1$ 项：$(\\frac{2}{3}(3r^2) + 2r(-2r) - \\frac{1}{2}(-2r) + 2r^2(1) - r(1) - \\frac{1}{6}(1))n = (2r^2 - 4r^2 + r + 2r^2 - r - \\frac{1}{6})n = -\\frac{1}{6}n$\n-   常数项（不含 $n$）：\n    $(\\frac{2}{3}(-r^3) + 2r(r^2) - \\frac{1}{2}(r^2) + 2r^2(-r) - r(-r) - \\frac{1}{6}(-r)) + (\\frac{2}{3}r^3 - \\frac{1}{2}r^2 - \\frac{1}{6}r)$\n    $= (-\\frac{2}{3}r^3 + 2r^3 - \\frac{1}{2}r^2 - 2r^3 + r^2 + \\frac{1}{6}r) + (\\frac{2}{3}r^3 - \\frac{1}{2}r^2 - \\frac{1}{6}r)$\n    $r^3$ 项：$(-\\frac{2}{3}+2-2+\\frac{2}{3})r^3 = 0$\n    $r^2$ 项：$(-\\frac{1}{2}+1-\\frac{1}{2})r^2 = 0$\n    $r$ 项：$(\\frac{1}{6}-\\frac{1}{6})r = 0$\n常数项之和为零。\n\n合并所有项，总浮点运算次数为：\n$$ C_{\\text{total}} = \\frac{2}{3}n^3 - \\frac{1}{2}n^2 - \\frac{1}{6}n $$\n此结果与块大小 $b$ 无关。这是预料之中的，因为分块算法与非分块算法执行的是同一组浮点算术运算，只是顺序不同。分块的优势在于改善了数据局部性（缓存性能），而这一点在问题指定的浮点运算计数模型中被忽略了。", "answer": "$$ \\boxed{\\frac{2}{3}n^{3} - \\frac{1}{2}n^{2} - \\frac{1}{6}n} $$", "id": "3562237"}]}