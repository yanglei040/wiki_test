{"hands_on_practices": [{"introduction": "理论的价值最终体现在实践中。本节的第一个练习旨在通过一个经典的例子，具体展示高斯消去法中的数值不稳定性问题。通过对一个特殊构造的矩阵分别执行带部分主元选择和不带主元选择的高斯消去法，我们将直接观察并量化主元选择在抑制元素增长、保证算法稳定性方面的关键作用。这个练习是理解为何主元策略是高斯消去法中不可或缺组成部分的基石。[@problem_id:3587432]", "problem": "考虑一个 $5 \\times 5$ 矩阵 $A \\in \\mathbb{R}^{5 \\times 5}$，其元素定义如下\n$$\na_{ij} \\;=\\; \\begin{cases}\n\\varepsilon, & i=j,\\\\\n1, & i \\neq j,\n\\end{cases}\n$$\n其中 $0 < \\varepsilon < 1$ 是一个固定参数。从高斯消去（GE）算法的基本定义和行变换规则出发，完成以下任务：\n\n1. 对矩阵 $A$ 执行不含主元选择的高斯消去法。在每个消去步骤 $k=1,2,3,4$ 中，明确指出位置 $(k,k)$ 处的主元，并写出该步骤后的上三角矩阵 $U^{(k)}$。对于步骤 $k=1$，你的 $U^{(k)}$ 必须显示完整的 $5 \\times 5$ 结构；对于步骤 $k=2,3,4$，必须显示嵌入的 $(5-k) \\times (5-k)$ 尾随子矩阵结构，并以 $\\varepsilon$ 的闭合形式函数表示。给出主元序列 $\\{p_{1}^{\\mathrm{np}},p_{2}^{\\mathrm{np}},p_{3}^{\\mathrm{np}},p_{4}^{\\mathrm{np}},p_{5}^{\\mathrm{np}}\\}$，其中上标 $\\mathrm{np}$ 表示“无主元选择”。\n\n2. 对矩阵 $A$ 执行部分主元选择的高斯消去法。在每个消去步骤 $k=1,2,3,4$ 中，根据部分主元选择规则（将当前主元行与第 $k$ 列中从第 $k$ 行到第 $5$ 行中绝对值最大的元素所在行进行交换），选择第 $k$ 列的主元，然后执行消去。明确指出位置 $(k,k)$ 处的主元，并写出该步骤后的上三角矩阵 $U_{\\mathrm{pp}}^{(k)}$，以 $\\varepsilon$ 的闭合形式函数表示，遵循与第1部分相同的结构要求。给出主元序列 $\\{p_{1}^{\\mathrm{pp}},p_{2}^{\\mathrm{pp}},p_{3}^{\\mathrm{pp}},p_{4}^{\\mathrm{pp}},p_{5}^{\\mathrm{pp}}\\}$，其中上标 $\\mathrm{pp}$ 表示“部分主元选择”。\n\n3. 设算法的元素增长因子定义为\n$$\n\\rho \\;=\\; \\frac{\\max_{i,j} |u_{ij}|}{\\max_{i,j} |a_{ij}|},\n$$\n其中 $U$ 是算法产生的最终上三角矩阵，$A$ 是原始输入矩阵。计算当 $\\varepsilon=10^{-6}$ 这个特定值时，比值\n$$\nR \\;=\\; \\frac{\\rho_{\\mathrm{np}}}{\\rho_{\\mathrm{pp}}}\n$$\n将 $R$ 的最终数值答案四舍五入到四位有效数字。最终答案不带单位。", "solution": "用户要求我解决一个数值线性代数问题，通过对一个特定矩阵执行带和不带主元选择的高斯消去法（GE）来完成。最后，我需要为一个给定的参数值计算元素增长因子的比率。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n- 矩阵为 $A \\in \\mathbb{R}^{5 \\times 5}$，其元素 $a_{ij} = \\varepsilon$（当 $i=j$ 时）和 $a_{ij} = 1$（当 $i \\neq j$ 时）。\n- 参数 $\\varepsilon$ 是固定的，且 $0 < \\varepsilon < 1$。\n- **第1部分**：对矩阵 $A$ 执行不含主元选择的GE。\n    - 对于 $k=1,2,3,4$：识别主元 $p_k^{\\mathrm{np}}$ 并写出步骤 $k$ 后的矩阵 $U^{(k)}$。\n    - 指定了 $U^{(k)}$ 的结构：$k=1$ 时为完整的 $5 \\times 5$ 矩阵，对于 $k=2,3,4$，则突出显示 $(5-k) \\times (5-k)$ 的尾随子矩阵。\n    - 给出主元序列 $\\{p_{1}^{\\mathrm{np}}, p_{2}^{\\mathrm{np}}, p_{3}^{\\mathrm{np}}, p_{4}^{\\mathrm{np}}, p_{5}^{\\mathrm{np}}\\}$。\n- **第2部分**：对矩阵 $A$ 执行含部分主元选择的GE。\n    - 对于 $k=1,2,3,4$：选择主元，执行交换，执行消去，识别主元 $p_k^{\\mathrm{pp}}$，并写出步骤 $k$ 后的矩阵 $U_{\\mathrm{pp}}^{(k)}$。\n    - $U_{\\mathrm{pp}}^{(k)}$ 的结构要求与第1部分相同。\n    - 给出主元序列 $\\{p_{1}^{\\mathrm{pp}}, p_{2}^{\\mathrm{pp}}, p_{3}^{\\mathrm{pp}}, p_{4}^{\\mathrm{pp}}, p_{5}^{\\mathrm{pp}}\\}$。\n- **第3部分**：\n    - 元素增长因子定义为 $\\rho = \\frac{\\max_{i,j} |u_{ij}|}{\\max_{i,j} |a_{ij}|}$，其中 $U$ 是最终的上三角矩阵。\n    - 当 $\\varepsilon = 10^{-6}$ 时，计算比率 $R = \\frac{\\rho_{\\mathrm{np}}}{\\rho_{\\mathrm{pp}}}$。\n    - 将 $R$ 的最终数值答案四舍五入到四位有效数字。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据**：该问题是数值线性代数中的一个标准练习，旨在探究高斯消去法的稳定性。所有概念（高斯消去法、主元选择、增长因子）都是公认的。\n- **适定性**：矩阵 A 定义明确。算法是标准的。可以证明，当 $0 < \\varepsilon < 1$ 时，矩阵 A 是非奇异的。该矩阵可以写作 $A = J + (\\varepsilon-1)I$，其中 $J$ 是全一矩阵。对于一个 $5 \\times 5$ 矩阵，$J$ 的特征值为 $5$ (重数为1) 和 $0$ (重数为 $4$)。因此，$A$ 的特征值为 $5-1+\\varepsilon = 4+\\varepsilon$ 和 $0-1+\\varepsilon = \\varepsilon-1$ (重数为4)。因为 $0 < \\varepsilon < 1$，这两个特征值都非零，所以矩阵是非奇异的（可逆的），GE 是良定义的。\n- **客观性**：问题使用精确的数学语言陈述，没有歧义或主观论断。\n\n**步骤3：结论与行动**\n问题有效。我将继续解答。\n\n### 解\n\n初始矩阵 $A$ 为：\n$$\nA = A^{(0)} =\n\\begin{pmatrix}\n\\varepsilon & 1 & 1 & 1 & 1 \\\\\n1 & \\varepsilon & 1 & 1 & 1 \\\\\n1 & 1 & \\varepsilon & 1 & 1 \\\\\n1 & 1 & 1 & \\varepsilon & 1 \\\\\n1 & 1 & 1 & 1 & \\varepsilon\n\\end{pmatrix}\n$$\n\n#### 第1部分：不含主元选择的高斯消去法\n\n我们将步骤 $k$ 后的矩阵记为 $A^{(k)}$。最终的上三角矩阵是 $U = A^{(4)}$。\n\n**步骤 $k=1$**：\n主元是 $p_1^{\\mathrm{np}} = a_{11}^{(0)} = \\varepsilon$。\n对于 $i \\in \\{2, 3, 4, 5\\}$，乘数是 $m_{i1} = a_{i1}^{(0)}/a_{11}^{(0)} = 1/\\varepsilon$。\n对于 $i,j > 1$ 的新元素是 $a_{ij}^{(1)} = a_{ij}^{(0)} - m_{i1} a_{1j}^{(0)}$。\n- 对于对角元素（$i=j>1$）：$a_{ii}^{(1)} = \\varepsilon - (1/\\varepsilon) \\cdot 1 = \\frac{\\varepsilon^2-1}{\\varepsilon}$。\n- 对于非对角元素（$i \\neq j$, $i,j > 1$）：$a_{ij}^{(1)} = 1 - (1/\\varepsilon) \\cdot 1 = \\frac{\\varepsilon-1}{\\varepsilon}$。\n步骤1后的矩阵是：\n$$\nU^{(1)} = A^{(1)} =\n\\begin{pmatrix}\n\\varepsilon & 1 & 1 & 1 & 1 \\\\\n0 & \\frac{\\varepsilon^2-1}{\\varepsilon} & \\frac{\\varepsilon-1}{\\varepsilon} & \\frac{\\varepsilon-1}{\\varepsilon} & \\frac{\\varepsilon-1}{\\varepsilon} \\\\\n0 & \\frac{\\varepsilon-1}{\\varepsilon} & \\frac{\\varepsilon^2-1}{\\varepsilon} & \\frac{\\varepsilon-1}{\\varepsilon} & \\frac{\\varepsilon-1}{\\varepsilon} \\\\\n0 & \\frac{\\varepsilon-1}{\\varepsilon} & \\frac{\\varepsilon-1}{\\varepsilon} & \\frac{\\varepsilon^2-1}{\\varepsilon} & \\frac{\\varepsilon-1}{\\varepsilon} \\\\\n0 & \\frac{\\varepsilon-1}{\\varepsilon} & \\frac{\\varepsilon-1}{\\varepsilon} & \\frac{\\varepsilon-1}{\\varepsilon} & \\frac{\\varepsilon^2-1}{\\varepsilon}\n\\end{pmatrix}\n$$\n\n让我们为尾随子矩阵的元素定义一个递归关系。在步骤 $k$，令尾随的 $(5-k) \\times (5-k)$ 子矩阵的对角元素为 $\\varepsilon_{k-1}$，非对角元素为 $d_{k-1}$。\n对于 $k=1$：$\\varepsilon_0 = \\varepsilon$，$d_0=1$。更新规则是 $a_{ij}' = a_{ij} - \\frac{a_{i1}a_{1j}}{a_{11}}$。对于 $i,j > 1$，$a_{ij}' = a_{ij} - \\frac{1 \\cdot 1}{\\varepsilon}$。这给出了 $a_{ii}' = \\varepsilon-1/\\varepsilon$ 和 $a_{ij}'=1-1/\\varepsilon$，与上面的矩阵相符。\n\n设步骤 $k-1$ 后的尾随子矩阵具有对角项 $\\varepsilon_{k-1}$ 和非对角项 $d_{k-1}$。\n主元是 $p_k^{\\mathrm{np}} = \\varepsilon_{k-1}$。乘数是 $m = d_{k-1}/\\varepsilon_{k-1}$。\n下一个尾随子矩阵的新元素是：\n$\\varepsilon_k = \\varepsilon_{k-1} - m \\cdot d_{k-1} = \\varepsilon_{k-1} - d_{k-1}^2/\\varepsilon_{k-1}$\n$d_k = d_{k-1} - m \\cdot d_{k-1} = d_{k-1}(1 - d_{k-1}/\\varepsilon_{k-1})$\n从 $k=1$ 开始：$\\varepsilon_1 = \\frac{\\varepsilon^2-1}{\\varepsilon}$，$d_1 = \\frac{\\varepsilon-1}{\\varepsilon}$。\n步骤2的乘数是 $m_2 = d_1/\\varepsilon_1 = \\frac{(\\varepsilon-1)/\\varepsilon}{(\\varepsilon^2-1)/\\varepsilon} = \\frac{1}{\\varepsilon+1}$。\n\n**步骤 $k=2$**：\n主元是 $p_2^{\\mathrm{np}} = a_{22}^{(1)} = \\varepsilon_1 = \\frac{\\varepsilon^2-1}{\\varepsilon}$。\n使用递推关系：\n$\\varepsilon_2 = \\varepsilon_1 - d_1^2/\\varepsilon_1 = \\frac{(\\varepsilon-1)(\\varepsilon+2)}{\\varepsilon+1}$。\n$d_2 = d_1(1-m_2) = \\frac{\\varepsilon-1}{\\varepsilon}(1-\\frac{1}{\\varepsilon+1}) = \\frac{\\varepsilon-1}{\\varepsilon+1}$。\n步骤2后的矩阵是：\n$$\nU^{(2)} = A^{(2)} =\n\\begin{pmatrix}\n\\varepsilon & 1 & 1 & 1 & 1 \\\\\n0 & \\varepsilon_1 & d_1 & d_1 & d_1 \\\\\n0 & 0 & \\varepsilon_2 & d_2 & d_2 \\\\\n0 & 0 & d_2 & \\varepsilon_2 & d_2 \\\\\n0 & 0 & d_2 & d_2 & \\varepsilon_2\n\\end{pmatrix}\n$$\n嵌入的 $3 \\times 3$ 尾随子矩阵具有对角项 $\\varepsilon_2 = \\frac{(\\varepsilon-1)(\\varepsilon+2)}{\\varepsilon+1}$ 和非对角项 $d_2 = \\frac{\\varepsilon-1}{\\varepsilon+1}$。\n\n**步骤 $k=3$**：\n主元是 $p_3^{\\mathrm{np}} = a_{33}^{(2)} = \\varepsilon_2 = \\frac{(\\varepsilon-1)(\\varepsilon+2)}{\\varepsilon+1}$。\n乘数是 $m_3 = d_2/\\varepsilon_2 = \\frac{1}{\\varepsilon+2}$。\n$\\varepsilon_3 = \\varepsilon_2 - d_2^2/\\varepsilon_2 = \\frac{(\\varepsilon-1)(\\varepsilon+3)}{\\varepsilon+2}$。\n$d_3 = d_2(1-m_3) = \\frac{\\varepsilon-1}{\\varepsilon+1}(1-\\frac{1}{\\varepsilon+2}) = \\frac{\\varepsilon-1}{\\varepsilon+2}$。\n步骤3后的矩阵是：\n$$\nU^{(3)} = A^{(3)} =\n\\begin{pmatrix}\n\\varepsilon & 1 & 1 & 1 & 1 \\\\\n0 & \\varepsilon_1 & d_1 & d_1 & d_1 \\\\\n0 & 0 & \\varepsilon_2 & d_2 & d_2 \\\\\n0 & 0 & 0 & \\varepsilon_3 & d_3 \\\\\n0 & 0 & 0 & d_3 & \\varepsilon_3\n\\end{pmatrix}\n$$\n嵌入的 $2 \\times 2$ 尾随子矩阵具有对角项 $\\varepsilon_3 = \\frac{(\\varepsilon-1)(\\varepsilon+3)}{\\varepsilon+2}$ 和非对角项 $d_3 = \\frac{\\varepsilon-1}{\\varepsilon+2}$。\n\n**步骤 $k=4$**：\n主元是 $p_4^{\\mathrm{np}} = a_{44}^{(3)} = \\varepsilon_3 = \\frac{(\\varepsilon-1)(\\varepsilon+3)}{\\varepsilon+2}$。\n乘数是 $m_4 = d_3/\\varepsilon_3 = \\frac{1}{\\varepsilon+3}$。\n$\\varepsilon_4 = \\varepsilon_3 - d_3^2/\\varepsilon_3 = \\frac{(\\varepsilon-1)(\\varepsilon+4)}{\\varepsilon+3}$。没有 $d_4$。\n步骤4后的矩阵（最终的上三角矩阵 $U_{\\mathrm{np}}$）是：\n$$\nU^{(4)} = U_{\\mathrm{np}} =\n\\begin{pmatrix}\n\\varepsilon & 1 & 1 & 1 & 1 \\\\\n0 & \\varepsilon_1 & d_1 & d_1 & d_1 \\\\\n0 & 0 & \\varepsilon_2 & d_2 & d_2 \\\\\n0 & 0 & 0 & \\varepsilon_3 & d_3 \\\\\n0 & 0 & 0 & 0 & \\varepsilon_4\n\\end{pmatrix}\n  \\quad\n  \\begin{smallmatrix}\n    \\varepsilon_1 = \\frac{\\varepsilon^2-1}{\\varepsilon} & d_1 = \\frac{\\varepsilon-1}{\\varepsilon} \\\\\n    \\varepsilon_2 = \\frac{(\\varepsilon-1)(\\varepsilon+2)}{\\varepsilon+1} & d_2 = \\frac{\\varepsilon-1}{\\varepsilon+1} \\\\\n    \\varepsilon_3 = \\frac{(\\varepsilon-1)(\\varepsilon+3)}{\\varepsilon+2} & d_3 = \\frac{\\varepsilon-1}{\\varepsilon+2} \\\\\n    \\varepsilon_4 = \\frac{(\\varepsilon-1)(\\varepsilon+4)}{\\varepsilon+3} \n  \\end{smallmatrix}\n$$\n嵌入的 $1 \\times 1$ 尾随子矩阵就是元素 $a_{55}^{(4)} = \\varepsilon_4 = \\frac{(\\varepsilon-1)(\\varepsilon+4)}{\\varepsilon+3}$。\n\n**主元序列（无主元选择）**：\n主元是 $p_k^{\\mathrm{np}} = \\varepsilon_{k-1}$，对于 $k=1, \\dots, 5$。\n$p_1^{\\mathrm{np}} = \\varepsilon_0 = \\varepsilon$\n$p_2^{\\mathrm{np}} = \\varepsilon_1 = \\frac{\\varepsilon^2-1}{\\varepsilon}$\n$p_3^{\\mathrm{np}} = \\varepsilon_2 = \\frac{(\\varepsilon-1)(\\varepsilon+2)}{\\varepsilon+1}$\n$p_4^{\\mathrm{np}} = \\varepsilon_3 = \\frac{(\\varepsilon-1)(\\varepsilon+3)}{\\varepsilon+2}$\n$p_5^{\\mathrm{np}} = \\varepsilon_4 = \\frac{(\\varepsilon-1)(\\varepsilon+4)}{\\varepsilon+3}$\n\n#### 第2部分：含部分主元选择的高斯消去法\n\n**步骤 $k=1$**：\n在 $A$ 的第1列中，元素是 $(\\varepsilon, 1, 1, 1, 1)^T$。由于 $0 < \\varepsilon < 1$，最大的绝对值是 $1$。我们将第1行与第2、3、4或5行中的任意一行交换。让我们交换 $R_1 \\leftrightarrow R_2$。\n$$\nA^{(0)'} =\n\\begin{pmatrix}\n1 & \\varepsilon & 1 & 1 & 1 \\\\\n\\varepsilon & 1 & 1 & 1 & 1 \\\\\n1 & 1 & \\varepsilon & 1 & 1 \\\\\n1 & 1 & 1 & \\varepsilon & 1 \\\\\n1 & 1 & 1 & 1 & \\varepsilon\n\\end{pmatrix}\n$$\n主元是 $p_1^{\\mathrm{pp}} = 1$。乘数是 $m_{21}=\\varepsilon$ 和 $m_{i1}=1$（对于 $i \\in \\{3,4,5\\}$）。\n消去后：\n$$\nU_{\\mathrm{pp}}^{(1)} = A_{\\mathrm{pp}}^{(1)} =\n\\begin{pmatrix}\n1 & \\varepsilon & 1 & 1 & 1 \\\\\n0 & 1-\\varepsilon^2 & 1-\\varepsilon & 1-\\varepsilon & 1-\\varepsilon \\\\\n0 & 1-\\varepsilon & \\varepsilon-1 & 0 & 0 \\\\\n0 & 1-\\varepsilon & 0 & \\varepsilon-1 & 0 \\\\\n0 & 1-\\varepsilon & 0 & 0 & \\varepsilon-1\n\\end{pmatrix}\n$$\n\n**步骤 $k=2$**：\n在第2列中，从第2行往下，元素是 $(1-\\varepsilon^2, 1-\\varepsilon, 1-\\varepsilon, 1-\\varepsilon)^T$。\n$|1-\\varepsilon^2| = (1-\\varepsilon)(1+\\varepsilon)$ 和 $|1-\\varepsilon|=1-\\varepsilon$。\n由于 $1+\\varepsilon>1$，所以 $|1-\\varepsilon^2| > |1-\\varepsilon|$。主元是 $p_2^{\\mathrm{pp}} = 1-\\varepsilon^2$。不需要行交换。\n对于 $i \\in \\{3,4,5\\}$，乘数是 $m_{i2} = \\frac{1-\\varepsilon}{1-\\varepsilon^2} = \\frac{1}{1+\\varepsilon}$。在尾随的 $4\\times 4$ 块上进行消去（$R'_i \\leftarrow R'_i - m_{i2} R'_2$）：\n新的尾随 $3 \\times 3$ 子矩阵的对角元素是 $\\varepsilon_2' = (\\varepsilon-1) - \\frac{1}{1+\\varepsilon}(1-\\varepsilon) = -(1-\\varepsilon)(1+\\frac{1}{1+\\varepsilon}) = -(1-\\varepsilon)\\frac{2+\\varepsilon}{1+\\varepsilon}$。\n新的非对角元素是 $d_2' = 0 - \\frac{1}{1+\\varepsilon}(1-\\varepsilon) = -\\frac{1-\\varepsilon}{1+\\varepsilon}$。\n$$\nU_{\\mathrm{pp}}^{(2)} = A_{\\mathrm{pp}}^{(2)} =\n\\begin{pmatrix}\n1 & \\varepsilon & 1 & 1 & 1 \\\\\n0 & 1-\\varepsilon^2 & 1-\\varepsilon & 1-\\varepsilon & 1-\\varepsilon \\\\\n0 & 0 & \\varepsilon_2' & d_2' & d_2' \\\\\n0 & 0 & d_2' & \\varepsilon_2' & d_2' \\\\\n0 & 0 & d_2' & d_2' & \\varepsilon_2'\n\\end{pmatrix}\n$$\n嵌入的 $3 \\times 3$ 子矩阵具有对角项 $\\varepsilon_2' = -(1-\\varepsilon)\\frac{2+\\varepsilon}{1+\\varepsilon}$ 和非对角项 $d_2' = -\\frac{1-\\varepsilon}{1+\\varepsilon}$。\n\n**步骤 $k=3$**：\n在第3列中，从第3行往下，元素是 $(\\varepsilon_2', d_2', d_2')^T$。\n$|\\varepsilon_2'| = (1-\\varepsilon)\\frac{2+\\varepsilon}{1+\\varepsilon}$ 和 $|d_2'|=\\frac{1-\\varepsilon}{1+\\varepsilon}$。由于 $2+\\varepsilon > 1$，所以 $|\\varepsilon_2'| > |d_2'|$。\n主元是 $p_3^{\\mathrm{pp}} = \\varepsilon_2'$。无需行交换。\n乘数 $m = d_2'/\\varepsilon_2' = \\frac{1}{2+\\varepsilon}$。\n新的尾随 $2 \\times 2$ 子矩阵元素是：\n$\\varepsilon_3' = \\varepsilon_2' - m d_2' = \\dots = -(1-\\varepsilon)\\frac{3+\\varepsilon}{2+\\varepsilon}$。\n$d_3' = d_2' - m d_2' = d_2'(1-m) = \\dots = -\\frac{1-\\varepsilon}{2+\\varepsilon}$。\n$$\nU_{\\mathrm{pp}}^{(3)} = A_{\\mathrm{pp}}^{(3)} =\n\\begin{pmatrix}\n1 & \\varepsilon & 1 & 1 & 1 \\\\\n0 & 1-\\varepsilon^2 & 1-\\varepsilon & 1-\\varepsilon & 1-\\varepsilon \\\\\n0 & 0 & \\varepsilon_2' & d_2' & d_2' \\\\\n0 & 0 & 0 & \\varepsilon_3' & d_3' \\\\\n0 & 0 & 0 & d_3' & \\varepsilon_3'\n\\end{pmatrix}\n$$\n嵌入的 $2 \\times 2$ 子矩阵具有对角项 $\\varepsilon_3' = -(1-\\varepsilon)\\frac{3+\\varepsilon}{2+\\varepsilon}$ 和非对角项 $d_3' = -\\frac{1-\\varepsilon}{2+\\varepsilon}$。\n\n**步骤 $k=4$**：\n主元是 $p_4^{\\mathrm{pp}}=\\varepsilon_3'$。无需交换。乘数 $m=d_3'/\\varepsilon_3'=\\frac{1}{3+\\varepsilon}$。\n新元素 $\\varepsilon_4' = \\varepsilon_3' - m d_3' = \\dots = -(1-\\varepsilon)\\frac{4+\\varepsilon}{3+\\varepsilon}$。\n最终矩阵是：\n$$\nU_{\\mathrm{pp}}^{(4)} = U_{\\mathrm{pp}} =\n\\begin{pmatrix}\n1 & \\varepsilon & 1 & 1 & 1 \\\\\n0 & 1-\\varepsilon^2 & 1-\\varepsilon & 1-\\varepsilon & 1-\\varepsilon \\\\\n0 & 0 & \\varepsilon_2' & d_2' & d_2' \\\\\n0 & 0 & 0 & \\varepsilon_3' & d_3' \\\\\n0 & 0 & 0 & 0 & \\varepsilon_4'\n\\end{pmatrix}\n  \\quad\n  \\begin{smallmatrix}\n    \\varepsilon_2' = - (1-\\varepsilon)\\frac{2+\\varepsilon}{1+\\varepsilon} & d_2' = - \\frac{1-\\varepsilon}{1+\\varepsilon} \\\\\n    \\varepsilon_3' = - (1-\\varepsilon)\\frac{3+\\varepsilon}{2+\\varepsilon} & d_3' = - \\frac{1-\\varepsilon}{2+\\varepsilon} \\\\\n    \\varepsilon_4' = - (1-\\varepsilon)\\frac{4+\\varepsilon}{3+\\varepsilon} \n  \\end{smallmatrix}\n$$\n$1\\times 1$ 的尾随子矩阵是 $\\varepsilon_4'$。\n\n**主元序列（部分主元选择）**：\n$p_1^{\\mathrm{pp}} = 1$\n$p_2^{\\mathrm{pp}} = 1-\\varepsilon^2$\n$p_3^{\\mathrm{pp}} = \\varepsilon_2' = -(1-\\varepsilon)\\frac{2+\\varepsilon}{1+\\varepsilon}$\n$p_4^{\\mathrm{pp}} = \\varepsilon_3' = -(1-\\varepsilon)\\frac{3+\\varepsilon}{2+\\varepsilon}$\n$p_5^{\\mathrm{pp}} = \\varepsilon_4' = -(1-\\varepsilon)\\frac{4+\\varepsilon}{3+\\varepsilon}$\n\n#### 第3部分：增长因子比率\n\n增长因子是 $\\rho = \\frac{\\max_{i,j} |u_{ij}|}{\\max_{i,j} |a_{ij}|}$。\n对于矩阵 $A$，元素是 $\\varepsilon$ 和 $1$。由于 $0 < \\varepsilon < 1$，$\\max_{i,j} |a_{ij}| = 1$。\n所以，$\\rho = \\max_{i,j} |u_{ij}|$。\n\n**不含主元选择的增长因子 ($\\rho_{\\mathrm{np}}$)**：\n我们需要在 $U_{\\mathrm{np}}$ 中找到量级最大的元素。对于小的 $\\varepsilon$，我们检查各项：\n$|\\varepsilon| \\ll 1$。 $|1|=1$。\n$|\\varepsilon_1| = |\\frac{\\varepsilon^2-1}{\\varepsilon}| = \\frac{1-\\varepsilon^2}{\\varepsilon} \\approx 1/\\varepsilon$。\n$|d_1| = |\\frac{\\varepsilon-1}{\\varepsilon}| = \\frac{1-\\varepsilon}{\\varepsilon} \\approx 1/\\varepsilon$。\n$|\\varepsilon_2| = | \\frac{(\\varepsilon-1)(\\varepsilon+2)}{\\varepsilon+1} | = \\frac{(1-\\varepsilon)(2+\\varepsilon)}{1+\\varepsilon} \\approx 2$。\n最大量级显然来自第二行，具体是 $|\\varepsilon_1| = \\frac{1-\\varepsilon^2}{\\varepsilon}$，因为 $1-\\varepsilon^2 > 1-\\varepsilon$。\n$\\rho_{\\mathrm{np}} = \\max_{i,j} |(U_{\\mathrm{np}})_{ij}| = |\\varepsilon_1| = \\frac{1-\\varepsilon^2}{\\varepsilon}$。\n\n**含部分主元选择的增长因子 ($\\rho_{\\mathrm{pp}}$)**：\n我们需要在 $U_{\\mathrm{pp}}$ 中找到量级最大的元素。\n第1行元素的最大量级是 $1$。\n第2行元素的最大量级是 $1-\\varepsilon^2 < 1$。\n其他元素是 $\\varepsilon_k'$ 和 $d_k'$ 的函数。对于小的 $\\varepsilon$：\n$|\\varepsilon_2'| = (1-\\varepsilon)\\frac{2+\\varepsilon}{1+\\varepsilon} \\approx 2$。\n$|d_2'| = \\frac{1-\\varepsilon}{1+\\varepsilon} \\approx 1$。\n$|\\varepsilon_3'| = (1-\\varepsilon)\\frac{3+\\varepsilon}{2+\\varepsilon} \\approx 3/2 = 1.5$。\n$|d_3'| = \\frac{1-\\varepsilon}{2+\\varepsilon} \\approx 1/2$。\n$|\\varepsilon_4'| = (1-\\varepsilon)\\frac{4+\\varepsilon}{3+\\varepsilon} \\approx 4/3 \\approx 1.33$。\n最大量级是 $|\\varepsilon_2'|$。\n$\\rho_{\\mathrm{pp}} = \\max_{i,j} |(U_{\\mathrm{pp}})_{ij}| = |\\varepsilon_2'| = (1-\\varepsilon)\\frac{2+\\varepsilon}{1+\\varepsilon}$。\n\n**比率 $R$**：\n$$\nR = \\frac{\\rho_{\\mathrm{np}}}{\\rho_{\\mathrm{pp}}} = \\frac{\\frac{1-\\varepsilon^2}{\\varepsilon}}{(1-\\varepsilon)\\frac{2+\\varepsilon}{1+\\varepsilon}} = \\frac{\\frac{(1-\\varepsilon)(1+\\varepsilon)}{\\varepsilon}}{(1-\\varepsilon)\\frac{2+\\varepsilon}{1+\\varepsilon}} = \\frac{\\frac{1+\\varepsilon}{\\varepsilon}}{\\frac{2+\\varepsilon}{1+\\varepsilon}} = \\frac{(1+\\varepsilon)^2}{\\varepsilon(2+\\varepsilon)}\n$$\n现在，代入 $\\varepsilon=10^{-6}$：\n$$\nR = \\frac{(1+10^{-6})^2}{10^{-6}(2+10^{-6})} = \\frac{1.000001^2}{10^{-6} \\times 2.000001} = \\frac{1.000002000001}{2.000001 \\times 10^{-6}}\n$$\n$R \\approx 500000.750000125$。\n四舍五入到四位有效数字得到 $5.000 \\times 10^5$。", "answer": "$$\\boxed{5.000 \\times 10^{5}}$$", "id": "3587432"}, {"introduction": "在认识到主元选择的必要性之后，一个自然的问题是：部分主元策略是否总是足够有效？这个练习通过一个精心设计的“病态”案例来回答这个问题。您会发现，在这种情况下，在列内搜寻最大元素的“贪心”策略（即部分主元法）会遭遇算法失败，而更为彻底的完全主元策略则能成功继续进行。这个对比鲜明的例子揭示了不同主元策略的内在局限性和各自的适用范围，深化了我们对算法鲁棒性的理解。[@problem_id:3587391]", "problem": "考虑对一个带主元选择的方阵进行高斯消元。在部分主元法中，在第 $k$ 步，仅在第 $k$ 列的第 $k$ 行到第 $n$ 行中寻找绝对值最大的元素作为主元，并（在必要时）交换行以将其移动到 $(k,k)$ 位置。在完全主元法中，在第 $k$ 步，在由第 $k$ 行到第 $n$ 行和第 $k$ 列到第 $n$ 列组成的整个尾部子矩阵中寻找绝对值最大的元素，并通过交换行和列将其移动到 $(k,k)$ 位置。然后，两种策略都通过左乘一个单位下三角消元矩阵来将主元下方的元素消为零，并对尾部子矩阵递归地继续此过程。所有的行和列交换都可以用与置换矩阵相乘来表示。\n\n令\n$$\nA \\;=\\;\n\\begin{pmatrix}\n1 & 2 & 3 \\\\\n1 & 2 & 4 \\\\\n-1 & -2 & 0\n\\end{pmatrix}.\n$$\n\n在实数上进行精确算术运算。\n\n(a) 在 $k=1$ 时，应用一步带部分主元法的高斯消元，使用决胜规则：在搜索集合中绝对值相等的最大值元素中，选择行索引最小的作为主元（因此在 $k=1$ 时，主元从第 $1$ 列中选择，不交换行）。推导出第一步后的尾部子矩阵，并仅使用上述核心定义，解释为什么在 $k=2$ 时，部分主元法未能在第 $2$ 列中找到一个非零主元（也就是说，在第 $2$ 列内进行任何行交换都无法产生一个非零主元）。\n\n(b) 现在从原始矩阵 $A$ 开始，使用完全主元法重复操作。在 $k=1$ 时，选择整个矩阵中绝对值最大的元素作为主元，执行所需的行和列交换以将其移到 $(1,1)$ 位置，并执行第一步消元以形成尾部子矩阵。然后，在 $k=2$ 时，确定由完全主元法选出的主元（尾部子矩阵中绝对值最大的元素）并说明其数值。\n\n你必须提供在 $k=2$ 步，完全主元法下选出的主元的标量值作为你的最终答案。请精确表示结果，无需四舍五入。", "solution": "该问题要求对给定矩阵 $A$ 应用两种不同的主元选择策略（部分主元法和完全主元法）进行高斯消元分析。运算是精确的。\n\n(a) 部分主元法高斯消元\n\n给定矩阵\n$$\nA = A^{(0)} =\n\\begin{pmatrix}\n1 & 2 & 3 \\\\\n1 & 2 & 4 \\\\\n-1 & -2 & 0\n\\end{pmatrix}.\n$$\n算法的第一步对应于 $k=1$。对于部分主元法，我们必须通过在第一列（限定于第1行到第3行）中搜索绝对值最大的元素来确定主元。此搜索集合中的元素是 $A_{11}^{(0)} = 1$、$A_{21}^{(0)} = 1$ 和 $A_{31}^{(0)} = -1$。它们的绝对值是 $|1| = 1$、 $|1| = 1$ 和 $|-1| = 1$。因此，最大绝对值为 $1$。\n\n问题陈述了一个决胜规则：“在搜索集合中绝对值相等的最大值元素中，选择行索引最小的作为主元”。第1行中的元素 $A_{11}^{(0)} = 1$ 满足此条件。因此，主元是 $1$，不执行行交换。\n\n现在我们进行消元步骤，以在主元 $A_{11}^{(0)}$ 下方引入零。用于行化简的乘子是：\n$$\nm_{21} = \\frac{A_{21}^{(0)}}{A_{11}^{(0)}} = \\frac{1}{1} = 1\n$$\n$$\nm_{31} = \\frac{A_{31}^{(0)}}{A_{11}^{(0)}} = \\frac{-1}{1} = -1\n$$\n行运算是 $R_2 \\to R_2 - m_{21} R_1$ 和 $R_3 \\to R_3 - m_{31} R_1$。将这些运算应用于 $A^{(0)}$ 得到下一阶段的矩阵 $A^{(1)}$：\n$$\nA^{(1)} =\n\\begin{pmatrix}\n1 & 2 & 3 \\\\\n1 - 1(1) & 2 - 1(2) & 4 - 1(3) \\\\\n-1 - (-1)(1) & -2 - (-1)(2) & 0 - (-1)(3)\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1 & 2 & 3 \\\\\n0 & 0 & 1 \\\\\n0 & 0 & 3\n\\end{pmatrix}.\n$$\n作为下一步消元（$k=2$）对象的尾部子矩阵是 $A^{(1)}$ 的右下角 $2 \\times 2$ 块：\n$$\n\\begin{pmatrix}\n0 & 1 \\\\\n0 & 3\n\\end{pmatrix}.\n$$\n在第 $k=2$ 步，如问题中所定义，部分主元策略要求我们“仅在第 $k$ 列的第 $k$ 行到第 $n$ 行中……寻找……绝对值最大的元素作为主元”。对于 $k=2$ 和 $n=3$，这意味着在 $A^{(1)}$ 的第 $2$ 列中从第 $2$ 行搜索到第 $3$ 行。候选元素是 $A_{22}^{(1)} = 0$ 和 $A_{32}^{(1)} = 0$。\n\n候选主元的集合是 $\\{0, 0\\}$。其中的最大绝对值是 $0$。高斯消元从根本上要求一个非零主元来计算消元步骤的乘子。由于搜索列中所有可用的候选元素都为零，任何行交换都不能将非零元素置于主元位置 $(2,2)$。因此，算法无法继续，被称为失败。\n\n(b) 完全主元法高斯消元\n\n我们再次从原始矩阵开始：\n$$\nA = A^{(0)} =\n\\begin{pmatrix}\n1 & 2 & 3 \\\\\n1 & 2 & 4 \\\\\n-1 & -2 & 0\n\\end{pmatrix}.\n$$\n在第 $k=1$ 步，完全主元法要求在整个 $3 \\times 3$ 矩阵中搜索具有最大绝对值的元素。$A$ 中各元素绝对值的矩阵是：\n$$\n\\begin{pmatrix}\n|1| & |2| & |3| \\\\\n|1| & |2| & |4| \\\\\n|-1| & |-2| & |0|\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1 & 2 & 3 \\\\\n1 & 2 & 4 \\\\\n1 & 2 & 0\n\\end{pmatrix}.\n$$\n最大值是 $4$，对应于元素 $A_{23} = 4$。为了使其成为主元，我们必须通过行和列交换将其移动到 $(1,1)$ 位置。我们交换第1行和第2行（$R_1 \\leftrightarrow R_2$），然后交换第1列和第3列（$C_1 \\leftrightarrow C_3$）。\n$$\nA \\xrightarrow{R_1 \\leftrightarrow R_2}\n\\begin{pmatrix}\n1 & 2 & 4 \\\\\n1 & 2 & 3 \\\\\n-1 & -2 & 0\n\\end{pmatrix}\n\\xrightarrow{C_1 \\leftrightarrow C_3}\n\\begin{pmatrix}\n4 & 2 & 1 \\\\\n3 & 2 & 1 \\\\\n0 & -2 & -1\n\\end{pmatrix}.\n$$\n设这个变换后的矩阵为 $A'$。主元是 $A'_{11} = 4$。我们进行消元。乘子是：\n$$\nm_{21} = \\frac{A'_{21}}{A'_{11}} = \\frac{3}{4}\n$$\n$$\nm_{31} = \\frac{A'_{31}}{A'_{11}} = \\frac{0}{4} = 0\n$$\n对 $A'$ 应用行运算 $R_2 \\to R_2 - \\frac{3}{4}R_1$ 和 $R_3 \\to R_3 - 0 R_1$ 得到：\n$$\nA^{(1)} =\n\\begin{pmatrix}\n4 & 2 & 1 \\\\\n3-\\frac{3}{4}(4) & 2-\\frac{3}{4}(2) & 1-\\frac{3}{4}(1) \\\\\n0 & -2 & -1\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n4 & 2 & 1 \\\\\n0 & \\frac{1}{2} & \\frac{1}{4} \\\\\n0 & -2 & -1\n\\end{pmatrix}.\n$$\n对于第 $k=2$ 步，完全主元策略要求我们在尾部的 $2 \\times 2$ 子矩阵中找到具有最大绝对值的元素：\n$$\n\\begin{pmatrix}\n\\frac{1}{2} & \\frac{1}{4} \\\\\n-2 & -1\n\\end{pmatrix}.\n$$\n这些元素的绝对值是 $|\\frac{1}{2}| = \\frac{1}{2}$、 $|\\frac{1}{4}| = \\frac{1}{4}$、 $|-2| = 2$ 和 $|-1| = 1$。最大绝对值是 $2$，对应于元素 $-2$。\n\n因此，在第 $k=2$ 步，完全主元法下选出的主元是 $-2$。", "answer": "$$\\boxed{-2}$$", "id": "3587391"}, {"introduction": "最后一个练习将我们的视野从经典的稳定性分析提升到更现代的数值线性代数核心议题：数值秩的可靠估计。一个优秀的矩阵分解算法不仅应是稳定的，还应当能够“揭示”矩阵的真实有效维度，即数值秩。本题通过一个例子说明，即使是稳定的部分主元LU分解也可能无法识别出矩阵的近奇异性，而引入列交换的策略却能成功做到这一点。这个练习将高斯消去法中的主元选择与矩阵的奇异值结构联系起来，展示了高级主元策略在现代科学计算中的深刻意义。[@problem_id:3587374]", "problem": "考虑由下式定义的方阵 $A \\in \\mathbb{R}^{2 \\times 2}$\n$$\nA = \\begin{pmatrix}\n1 & M \\\\\n0 & 1\n\\end{pmatrix},\n$$\n其中 $M$ 是一个正实数参数。设数值容差为 $\\tau = 5 \\times 10^{-9}$。对于本问题，使用在所述容差范围内的以下三种秩的定义：\n- 金标准数值秩 $r_{\\mathrm{true}}$ 是 $A$ 的奇异值中绝对值超过 $\\tau$ 的数量。\n- 通过带部分主元（仅行主元）的标准下-上 (LU) 分解估计的秩，记为 $r_{\\mathrm{PP}}$，是上三角因子 $U$ 的对角线元素中绝对值超过 $\\tau$ 的数量。\n- 通过带列主元的秩揭示 LU 分解（即，通过选择行和列置换来揭示近似线性相关的 LU 分解）估计的秩，记为 $r_{\\mathrm{RR}}$，是在执行了最大程度揭示末尾小主元的列置换后，相应上三角因子 $U$ 的对角线元素中绝对值超过 $\\tau$ 的数量。\n\n从数值线性代数的基本定义和公认事实（奇异值是 $A^{\\top}A$ 特征值的平方根的模型、高斯消元的定义和机制，以及主元法的作用）出发，完成以下任务：\n1. 对于 $M = 10^{10}$ 的特定选择，通过分析 $A$ 的奇异值来确定 $r_{\\mathrm{true}}$。\n2. 通过分析对 $A$ 应用带部分主元的标准 LU 分解得到的上三角因子 $U$ 的对角结构来确定 $r_{\\mathrm{PP}}$。\n3. 通过展示单次列置换如何使 $A$ 在 LU 分解下具有秩揭示性，然后分析得到的 $U$ 来确定 $r_{\\mathrm{RR}}$。\n4. 计算标量 $\\Delta = r_{\\mathrm{PP}} - r_{\\mathrm{RR}}$。\n\n你的最终答案必须是单个实数 $\\Delta$。最终答案无需四舍五入。请解释步骤 2 中的失败之处以及步骤 3 中的补救措施为何成功，严格地从基本依据（定义和算法机制）推导出每个结论，不使用快捷公式。矩阵 $A$ 和容差 $\\tau$ 在科学上是现实的，适用于研究高斯消元中主元策略的秩揭示特性。", "solution": "用户提供了数值线性代数领域一个有效的问题陈述。该问题科学基础扎实，提法恰当，且客观。它要求针对一个特定的、精心选择的示例矩阵，分析基于矩阵分解的不同秩估计方法。我现在开始解答。\n\n问题要求分析在 $M=10^{10}$ 且容差为 $\\tau = 5 \\times 10^{-9}$ 时矩阵 $A = \\begin{pmatrix} 1 & M \\\\ 0 & 1 \\end{pmatrix}$ 的数值秩。我们必须使用三种不同的定义来确定数值秩，并解释其间的差异。\n\n**1. 确定真实数值秩 $r_{\\mathrm{true}}$**\n\n金标准数值秩 $r_{\\mathrm{true}}$ 定义为 $A$ 的奇异值中绝对值超过容差 $\\tau$ 的数量。$A$ 的奇异值是矩阵 $A^{\\top}A$ 特征值的平方根。\n\n首先，我们计算 $A^{\\top}A$：\n$$\nA^{\\top} = \\begin{pmatrix} 1 & 0 \\\\ M & 1 \\end{pmatrix}\n$$\n$$\nA^{\\top}A = \\begin{pmatrix} 1 & 0 \\\\ M & 1 \\end{pmatrix} \\begin{pmatrix} 1 & M \\\\ 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 1 \\cdot 1 + 0 \\cdot 0 & 1 \\cdot M + 0 \\cdot 1 \\\\ M \\cdot 1 + 1 \\cdot 0 & M \\cdot M + 1 \\cdot 1 \\end{pmatrix} = \\begin{pmatrix} 1 & M \\\\ M & M^2+1 \\end{pmatrix}\n$$\n接下来，我们通过求解特征方程 $\\det(A^{\\top}A - \\lambda I) = 0$ 来找到 $A^{\\top}A$ 的特征值 $\\lambda$：\n$$\n\\det \\begin{pmatrix} 1-\\lambda & M \\\\ M & M^2+1-\\lambda \\end{pmatrix} = 0\n$$\n$$\n(1-\\lambda)(M^2+1-\\lambda) - M^2 = 0\n$$\n$$\nM^2+1 - \\lambda - (M^2+1)\\lambda + \\lambda^2 - M^2 = 0\n$$\n$$\n\\lambda^2 - (M^2+2)\\lambda + 1 = 0\n$$\n使用二次公式，特征值为：\n$$\n\\lambda = \\frac{(M^2+2) \\pm \\sqrt{(M^2+2)^2 - 4(1)(1)}}{2} = \\frac{M^2+2 \\pm \\sqrt{M^4+4M^2+4-4}}{2} = \\frac{M^2+2 \\pm \\sqrt{M^2(M^2+4)}}{2}\n$$\n$$\n\\lambda = \\frac{M^2+2 \\pm M\\sqrt{M^2+4}}{2}\n$$\n两个特征值是 $\\lambda_1 = \\frac{M^2+2 + M\\sqrt{M^2+4}}{2}$ 和 $\\lambda_2 = \\frac{M^2+2 - M\\sqrt{M^2+4}}{2}$。\n奇异值是 $\\sigma_1 = \\sqrt{\\lambda_1}$ 和 $\\sigma_2 = \\sqrt{\\lambda_2}$。\n\n对于给定的较大值 $M = 10^{10}$，我们可以近似计算奇异值。对于 $\\lambda_1$，$M^2$ 项占主导地位：\n$$\n\\lambda_1 \\approx \\frac{M^2 + M\\sqrt{M^2}}{2} = \\frac{M^2 + M^2}{2} = M^2\n$$\n因此，$\\sigma_1 \\approx \\sqrt{M^2} = M = 10^{10}$。\n\n对于 $\\lambda_2$，各项几乎相消，所以我们必须更加小心。我们可以对 $\\lambda_2$ 的表达式进行有理化：\n$$\n\\lambda_2 = \\frac{(M^2+2 - M\\sqrt{M^2+4})}{2} \\times \\frac{(M^2+2 + M\\sqrt{M^2+4})}{(M^2+2 + M\\sqrt{M^2+4})} = \\frac{(M^2+2)^2 - M^2(M^2+4)}{2(M^2+2 + M\\sqrt{M^2+4})}\n$$\n$$\n\\lambda_2 = \\frac{M^4+4M^2+4 - (M^4+4M^2)}{2(M^2+2 + M\\sqrt{M^2+4})} = \\frac{4}{2(M^2+2 + M\\sqrt{M^2+4})} = \\frac{2}{M^2+2+M\\sqrt{M^2+4}}\n$$\n对于大的 $M$，分母近似为 $M^2 + M(M) = 2M^2$。\n$$\n\\lambda_2 \\approx \\frac{2}{2M^2} = \\frac{1}{M^2}\n$$\n因此，$\\sigma_2 \\approx \\sqrt{1/M^2} = 1/M = 10^{-10}$。\n\n现在我们将奇异值的绝对值与容差 $\\tau = 5 \\times 10^{-9}$ 进行比较：\n- $\\sigma_1 \\approx 10^{10}$。显然，$10^{10} > 5 \\times 10^{-9}$。\n- $\\sigma_2 \\approx 10^{-10}$。由于 $1 \\times 10^{-10} < 5 \\times 10^{-9}$，这个奇异值低于容差。\n\n只有一个奇异值超过了容差。因此，真实的数值秩是 $r_{\\mathrm{true}} = 1$。\n\n**2. 通过带部分主元的 LU 分解确定秩 $r_{\\mathrm{PP}}$**\n\n我们对 $A = \\begin{pmatrix} 1 & M \\\\ 0 & 1 \\end{pmatrix}$ 应用带部分主元（行交换）的高斯消元法。\n在第一列中，我们通过找到绝对值最大的元素来选择主元。这些元素是 $a_{11}=1$ 和 $a_{21}=0$。最大绝对值为 $|1|=1$。因此，不需要进行行交换。主元是 $a_{11}=1$。\n消元步骤旨在将 $a_{21}$ 位置的元素变为零。然而，该元素已经是 $0$。因此，不需要进行消元操作。\n算法立即终止，得到的上三角矩阵 $U$ 与原始矩阵 $A$ 相同：\n$$\nU = \\begin{pmatrix} 1 & M \\\\ 0 & 1 \\end{pmatrix}\n$$\n相应的下三角矩阵 $L$ 是单位矩阵 $I$。\n秩 $r_{\\mathrm{PP}}$ 是 $U$ 的对角线元素中绝对值超过 $\\tau = 5 \\times 10^{-9}$ 的数量。对角线元素是 $u_{11}=1$ 和 $u_{22}=1$。\n- $|u_{11}| = 1 > 5 \\times 10^{-9}$。\n- $|u_{22}| = 1 > 5 \\times 10^{-9}$。\n两个对角线元素都大于容差。因此，通过这种方法估计的秩是 $r_{\\mathrm{PP}} = 2$。\n\n这种方法的失败之处在于，部分主元法仅考虑当前列内的元素来选择主元。对于矩阵 $A$，选择的主元是 $a_{11}=1$，从避免在这一步中除以小数以保证数值稳定性的角度来看，这是完全可以接受的。然而，这个选择没有考虑到同一行中非常大的元素 $M=10^{10}$。由于矩阵 $A$ 的结构向部分主元策略隐藏了列之间的近似线性相关性，该算法无法“看到”它。$U$ 中得到的主元没有反映出由奇异值给出的问题的真实尺度。\n\n**3. 通过秩揭示 LU 分解确定秩 $r_{\\mathrm{RR}}$**\n\n秩揭示 LU 分解涉及列置换，以将可能最大的元素移到主元位置。我们寻求一个列置换矩阵 $\\Pi$，使得 $A\\Pi$ 能够导出一个更具洞察力的 LU 分解。让我们交换 $A$ 的两列：\n$$\n\\Pi = \\begin{pmatrix} 0 & 1 \\\\ 1 & 0 \\end{pmatrix}\n$$\n置换后的矩阵是 $A_c = A\\Pi$：\n$$\nA_c = \\begin{pmatrix} 1 & M \\\\ 0 & 1 \\end{pmatrix} \\begin{pmatrix} 0 & 1 \\\\ 1 & 0 \\end{pmatrix} = \\begin{pmatrix} M & 1 \\\\ 1 & 0 \\end{pmatrix}\n$$\n现在我们对 $A_c$ 执行 LU 分解（带部分主元）。\n在第一列中，元素是 $M=10^{10}$ 和 $1$。主元是 $M$，因为它是较大的元素。不需要进行行交换。\n用于消去 $(2,1)$ 位置元素的乘数是 $l_{21} = \\frac{1}{M}$。\n我们执行行操作 $R_2 \\leftarrow R_2 - l_{21} R_1$：\n新的第二行是 $(1 - \\frac{1}{M}M, 0 - \\frac{1}{M}1) = (0, -\\frac{1}{M})$。\n得到的上三角矩阵 $U$ 是：\n$$\nU = \\begin{pmatrix} M & 1 \\\\ 0 & -1/M \\end{pmatrix}\n$$\n秩 $r_{\\mathrm{RR}}$ 是这个 $U$ 的对角线元素中绝对值超过 $\\tau = 5 \\times 10^{-9}$ 的数量。对角线元素是 $u_{11}=M=10^{10}$ 和 $u_{22}=-1/M = -10^{-10}$。\n- $|u_{11}| = 10^{10} > 5 \\times 10^{-9}$。\n- $|u_{22}| = |-10^{-10}| = 10^{-10}$。这小于 $\\tau = 5 \\times 10^{-9}$。\n只有一个对角线元素超过了容差。因此，通过这种方法估计的秩是 $r_{\\mathrm{RR}} = 1$。\n\n这种方法之所以成功，是因为列置换将矩阵中最大的元素 $M$ 带到了初始主元位置。这是更稳健的主元策略（如完全主元法）的一个关键原则。随后的消元步骤产生第二个主元 $-1/M$，其绝对值正确地反映了小奇异值 $\\sigma_2$ 的量级。因此，这种分解“揭示”了矩阵的数值秩，正确地将其识别为近似秩亏的。\n\n**4. 计算 $\\Delta$**\n\n最后一步是计算标量 $\\Delta = r_{\\mathrm{PP}} - r_{\\mathrm{RR}}$。\n使用上面推导出的值：\n- $r_{\\mathrm{PP}} = 2$\n- $r_{\\mathrm{RR}} = 1$\n$$\n\\Delta = 2 - 1 = 1\n$$\n差异 $\\Delta=1$ 凸显了标准部分主元法在可靠确定数值秩方面的失败，以及秩揭示策略在完成相同任务时的成功。", "answer": "$$\n\\boxed{1}\n$$", "id": "3587374"}]}