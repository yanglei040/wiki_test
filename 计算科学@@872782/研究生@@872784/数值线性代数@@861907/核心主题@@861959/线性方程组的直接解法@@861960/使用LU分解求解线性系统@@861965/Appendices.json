{"hands_on_practices": [{"introduction": "掌握任何数值方法的第一步都是通过一个简单的例子进行手动计算。本练习提供了一个具体的 $3 \\times 3$ 矩阵，旨在让你熟练运用杜利特尔（Doolittle）方法执行 LU 分解 [@problem_id:2186375]。通过亲手完成这个过程，你将巩固对高斯消元法步骤的理解，并清楚地看到下三角矩阵 $L$ 和上三角矩阵 $U$ 是如何被构建出来的。", "problem": "在数值线性代数中，将一个矩阵分解为一个下三角矩阵和一个上三角矩阵的乘积是一项基本运算。这种分解被称为LU分解，并用于各种算法中，例如求解线性方程组。\n\n考虑矩阵 $A$ 如下：\n$$\nA = \\begin{pmatrix} 3 & -1 & 2 \\\\ 6 & 1 & 9 \\\\ -9 & 5 & -5 \\end{pmatrix}\n$$\n该矩阵可以唯一地分解为乘积 $A = LU$，其中 $L$ 是一个单位下三角矩阵（即对角线上的元素为1），而 $U$ 是一个上三角矩阵。这两个 $3 \\times 3$ 矩阵的一般形式为：\n$$\nL = \\begin{pmatrix} 1 & 0 & 0 \\\\ l_{21} & 1 & 0 \\\\ l_{31} & l_{32} & 1 \\end{pmatrix}, \\quad U = \\begin{pmatrix} u_{11} & u_{12} & u_{13} \\\\ 0 & u_{22} & u_{23} \\\\ 0 & 0 & u_{33} \\end{pmatrix}\n$$\n对于给定的矩阵 $A$，确定矩阵 $L$ 的非对角线元素以及矩阵 $U$ 的所有元素的数值。将您的最终答案表示为一个单行矩阵，其中包含按特定顺序 $(l_{21}, l_{31}, l_{32}, u_{11}, u_{12}, u_{13}, u_{22}, u_{23}, u_{33})$ 排列的这九个值。将所有分数值表示为其最简形式。", "solution": "我们使用 Doolittle LU 分解法，其中 $L$ 是单位下三角矩阵，$U$ 是上三角矩阵，满足 $A=LU$。其中\n$$\nL=\\begin{pmatrix} 1 & 0 & 0 \\\\ l_{21} & 1 & 0 \\\\ l_{31} & l_{32} & 1 \\end{pmatrix},\\quad\nU=\\begin{pmatrix} u_{11} & u_{12} & u_{13} \\\\ 0 & u_{22} & u_{23} \\\\ 0 & 0 & u_{33} \\end{pmatrix},\n$$\n乘积 $LU$ 按行计算如下：\n- 第1行：$[u_{11}, u_{12}, u_{13}]=[3,-1,2]$，因此 $u_{11}=3$，$u_{12}=-1$，$u_{13}=2$。\n- 第2行第1列：$l_{21}u_{11}=a_{21}=6$，所以 $l_{21}=\\frac{a_{21}}{u_{11}}=\\frac{6}{3}=2$。\n- 第3行第1列：$l_{31}u_{11}=a_{31}=-9$，所以 $l_{31}=\\frac{a_{31}}{u_{11}}=\\frac{-9}{3}=-3$。\n- 第2行第2列：$l_{21}u_{12}+u_{22}=a_{22}=1$，所以 $u_{22}=a_{22}-l_{21}u_{12}=1-2(-1)=3$。\n- 第2行第3列：$l_{21}u_{13}+u_{23}=a_{23}=9$，所以 $u_{23}=a_{23}-l_{21}u_{13}=9-2\\cdot 2=5$。\n- 第3行第2列：$l_{31}u_{12}+l_{32}u_{22}=a_{32}=5$，所以 $l_{32}=\\frac{a_{32}-l_{31}u_{12}}{u_{22}}=\\frac{5-(-3)(-1)}{3}=\\frac{5-3}{3}=\\frac{2}{3}$。\n- 第3行第3列：$l_{31}u_{13}+l_{32}u_{23}+u_{33}=a_{33}=-5$，所以\n$$\nu_{33}=a_{33}-l_{31}u_{13}-l_{32}u_{23}=-5-(-3\\cdot 2)-\\left(\\frac{2}{3}\\cdot 5\\right)=-5+6-\\frac{10}{3}=1-\\frac{10}{3}=-\\frac{7}{3}.\n$$\n\n因此，按照要求的顺序 $(l_{21}, l_{31}, l_{32}, u_{11}, u_{12}, u_{13}, u_{22}, u_{23}, u_{33})$，这些值为\n$$\n\\begin{pmatrix}\n2 & -3 & \\frac{2}{3} & 3 & -1 & 2 & 3 & 5 & -\\frac{7}{3}\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}2  -3  \\frac{2}{3}  3  -1  2  3  5  -\\frac{7}{3}\\end{pmatrix}}$$", "id": "2186375"}, {"introduction": "在掌握了基本计算方法后，理解算法的局限性就变得至关重要。本练习将引导你探究一个不带主元选择的 LU 分解会失败的场景，并分析其背后的理论条件 [@problem_id:3578142]。通过将分解失败与零主元及消失的主子行列式联系起来，你将深刻理解为何主元选择策略对于一个稳健的 LU 分解算法而言是必不可少的。", "problem": "设 $A \\in \\mathbb{R}^{3 \\times 3}$ 是一个实矩阵。考虑在不进行行置换的情况下计算一个下三角-上三角 (LU) 分解的尝试，即寻找一个单位下三角矩阵 $L$ 和一个上三角矩阵 $U$，使得 $A = L U$，使用不带主元选择的高斯消元法 (GE) 的行操作。用 $\\Delta_{k}$ 表示 $A$ 的 $k \\times k$ 阶顺序主子矩阵的行列式。\n\n1. 显式地构造一个实 $3 \\times 3$ 矩阵 $A$，满足 $\\Delta_{1} \\neq 0$ 和 $\\Delta_{2} = 0$，并且对于该矩阵，不带主元选择的高斯消元法的第二步消元需要除以第二个主元。你的构造必须是显式的，并从第一性原理（即GE的定义和每一步诱导的舒尔补）出发进行论证。\n\n2. 仅从高斯消元法和分块矩阵乘法的定义出发，推导出一个关于顺序主子式 $\\Delta_{k}$ 和消元主元 $p_{k}$ 的、不带主元选择的 $A=LU$ 分解存在的必要条件。你的推导必须从对一个 $2 \\times 2$ 阶顺序主子块的第一步消元开始，并通过舒尔补进行，完整地论证每一步。\n\n3. 将你的推导应用于你显式构造的矩阵 $A$，以严格解释为何具有单位对角线 $L$ 且无行置换的 $A = L U$ 分解不存在。此外，确定不带主元选择的GE在你构造的 $A$ 上会尝试使用的第二个主元 $p_{2}$ 的数值。\n\n将 $p_{2}$ 的数值作为你的最终答案。无需四舍五入。", "solution": "此问题包含三个部分，涉及一个 $3 \\times 3$ 实矩阵 $A$ 在不进行行置换的情况下进行下三角-上三角 (LU) 分解的存在性。我们依次解决每个部分。\n\n1. 矩阵 $A$ 的构造。\n\n我们的任务是构造一个 $3 \\times 3$ 的实矩阵 $A$，使其顺序主子矩阵的行列式满足 $\\Delta_{1} \\neq 0$ 和 $\\Delta_{2} = 0$，并且不带主元选择的高斯消元法 (GE) 在第二步失败。\n\n设矩阵 $A$ 表示为\n$$A = \\begin{pmatrix} a_{11} & a_{12} & a_{13} \\\\ a_{21} & a_{22} & a_{23} \\\\ a_{31} & a_{32} & a_{33} \\end{pmatrix}$$\n$1 \\times 1$ 阶顺序主子矩阵是 $[a_{11}]$，其行列式为 $\\Delta_{1} = a_{11}$。条件 $\\Delta_{1} \\neq 0$ 意味着 $a_{11} \\neq 0$。$a_{11}$ 的值作为第一个主元 $p_1$。为简单起见，我们选择 $a_{11} = 1$。\n\n$2 \\times 2$ 阶顺序主子矩阵是 $\\begin{pmatrix} a_{11} & a_{12} \\\\ a_{21} & a_{22} \\end{pmatrix}$，其行列式为 $\\Delta_{2} = a_{11}a_{22} - a_{12}a_{21}$。条件是 $\\Delta_{2} = 0$。当 $a_{11} = 1$ 时，这变为 $a_{22} - a_{12}a_{21} = 0$。我们可以通过选择，例如，$a_{12} = 1$，$a_{21} = 1$ 和 $a_{22} = 1$ 来满足这个条件。\n\n至此，$A$ 的左上角 $2 \\times 2$ 子块是 $\\begin{pmatrix} 1 & 1 \\\\ 1 & 1 \\end{pmatrix}$。我们选择其余的元素来创建一个简单的、非平凡的矩阵。设 $a_{13}=1$，$a_{23}=2$，$a_{31}=1$，$a_{32}=2$，$a_{33}=3$。这给出了矩阵\n$$A = \\begin{pmatrix} 1 & 1 & 1 \\\\ 1 & 1 & 2 \\\\ 1 & 2 & 3 \\end{pmatrix}$$\n我们来验证这些条件。$\\Delta_{1} = \\det([1]) = 1 \\neq 0$。\n$\\Delta_{2} = \\det \\begin{pmatrix} 1 & 1 \\\\ 1 & 1 \\end{pmatrix} = (1)(1) - (1)(1) = 0$。条件满足。\n\n现在，我们必须从第一性原理出发，论证GE在第二步失败。GE的第一步使用主元 $p_1 = a_{11} = 1$ 来消去其下方的元素。\n第二行的乘数是 $l_{21} = \\frac{a_{21}}{p_1} = \\frac{1}{1} = 1$。\n第三行的乘数是 $l_{31} = \\frac{a_{31}}{p_1} = \\frac{1}{1} = 1$。\n第一次消元步骤后的矩阵 $A^{(1)}$ 是：\n$$A^{(1)} = \\begin{pmatrix} 1 & 1 & 1 \\\\ 1 - (1)(1) & 1 - (1)(1) & 2 - (1)(1) \\\\ 1 - (1)(1) & 2 - (1)(1) & 3 - (1)(1) \\end{pmatrix} = \\begin{pmatrix} 1 & 1 & 1 \\\\ 0 & 0 & 1 \\\\ 0 & 1 & 2 \\end{pmatrix}$$\n第二个主元是 $A^{(1)}$ 的 $(2,2)$ 元素，即 $p_2 = a_{22}^{(1)} = 0$。要进行GE的第二步，我们需要使用主元 $p_2$ 来消去元素 $a_{32}^{(1)}=1$。这将需要计算一个乘数 $l_{32} = \\frac{a_{32}^{(1)}}{p_2} = \\frac{1}{0}$，其中涉及到除以零。因此，不带主元选择的GE在第二步失败。\n\n为了通过舒尔补来论证这一点，我们将 $A$ 分块：\n$$A = \\begin{pmatrix} a_{11} & \\mathbf{a}_{12}^T \\\\ \\mathbf{a}_{21} & A_{22} \\end{pmatrix} = \\begin{pmatrix} 1 & \\begin{pmatrix} 1 & 1 \\end{pmatrix} \\\\ \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} & \\begin{pmatrix} 1 & 2 \\\\ 2 & 3 \\end{pmatrix} \\end{pmatrix}$$\n分块LU分解的第一步产生：\n$$A = \\begin{pmatrix} 1 & \\mathbf{0}^T \\\\ \\mathbf{l}_{21} & I \\end{pmatrix} \\begin{pmatrix} a_{11} & \\mathbf{a}_{12}^T \\\\ \\mathbf{0} & A_{22} - \\mathbf{l}_{21} \\mathbf{a}_{12}^T \\end{pmatrix}$$\n其中 $\\mathbf{l}_{21} = \\frac{\\mathbf{a}_{21}}{a_{11}} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。右下角的子块是 $a_{11}$ 在 $A$ 中的舒尔补 $S$：\n$$S = A_{22} - \\frac{\\mathbf{a}_{21} \\mathbf{a}_{12}^T}{a_{11}} = \\begin{pmatrix} 1 & 2 \\\\ 2 & 3 \\end{pmatrix} - \\frac{1}{1}\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} 1 & 1 \\end{pmatrix} = \\begin{pmatrix} 1 & 2 \\\\ 2 & 3 \\end{pmatrix} - \\begin{pmatrix} 1 & 1 \\\\ 1 & 1 \\end{pmatrix} = \\begin{pmatrix} 0 & 1 \\\\ 1 & 2 \\end{pmatrix}$$\n经过一步GE后的矩阵，其右下部分是舒尔补：$A^{(1)} = \\begin{pmatrix} a_{11} & \\mathbf{a}_{12}^T \\\\ \\mathbf{0} & S \\end{pmatrix}$。GE的第二个主元是这个舒尔补的 $(1,1)$ 元素，$p_2 = S_{11} = 0$。这证实了失败。\n\n2. 必要条件的推导。\n\n我们被要求根据顺序主子式 $\\Delta_k$ 和主元 $p_k$ 推导出一个 $A=LU$ 分解（不带主元选择）存在的必要条件。推导必须从GE的定义开始。\n\n设 $A$ 是一个 $n \\times n$ 矩阵。不带主元选择的高斯消元法产生一系列矩阵 $A=A^{(0)}, A^{(1)}, \\dots, A^{(n-1)}=U$，其中 $U$ 是上三角矩阵。主元是 $p_k = a_{kk}^{(k-1)}$。\n\n为了使第一步可行，第一个主元 $p_1 = a_{11}^{(0)} = a_{11}$ 必须非零。第一个顺序主子式是 $\\Delta_1 = \\det([a_{11}]) = a_{11}$。因此，一个必要条件是 $p_1 = \\Delta_1 \\neq 0$。\n\n现在，我们考虑第二个主元 $p_2$。这是第一步消元后得到的矩阵 $A^{(1)}$ 的 $(2,2)$ 元素。$A^{(1)}$ 的元素由 $a_{ij}^{(1)} = a_{ij}^{(0)} - \\frac{a_{i1}^{(0)}}{a_{11}^{(0)}} a_{1j}^{(0)}$ 给出，其中 $i,j > 1$。具体对于第二个主元：\n$$p_2 = a_{22}^{(1)} = a_{22}^{(0)} - \\frac{a_{21}^{(0)}}{a_{11}^{(0)}} a_{12}^{(0)}$$\n使用原始矩阵元素 $a_{ij}^{(0)}=a_{ij}$，我们有：\n$$p_2 = a_{22} - \\frac{a_{21}a_{12}}{a_{11}} = \\frac{a_{11}a_{22} - a_{12}a_{21}}{a_{11}}$$\n分子是 $A$ 的 $2 \\times 2$ 阶顺序主子矩阵的行列式，即 $\\Delta_2$。分母是第一个顺序主子式，即 $\\Delta_1$。因此，我们有关系：\n$$p_2 = \\frac{\\Delta_2}{\\Delta_1}$$\n为了让GE的第二步能够进行，主元 $p_2$ 必须非零。由于我们已经确立了 $\\Delta_1 \\neq 0$ 的必要性，条件 $p_2 \\neq 0$ 等价于 $\\Delta_2 \\neq 0$。\n\n这个论证可以推广。如果LU分解存在，$A=LU$，那么对于任何 $k \\in \\{1, \\dots, n\\}$，$k \\times k$ 阶顺序主子矩阵 $A_k$ 满足 $A_k = L_k U_k$。取行列式，$\\det(A_k) = \\det(L_k) \\det(U_k)$。因为 $L$ 是单位下三角矩阵，$L_k$ 也是，所以 $\\det(L_k) = 1$。上三角矩阵 $U_k$ 的行列式是其对角元素的乘积，这些元素是前 $k$ 个主元：$\\det(U_k) = p_1 p_2 \\cdots p_k$。\n因此，$\\Delta_k = p_1 p_2 \\cdots p_k$。\n这对于 $k \\ge 2$ 给出了 $\\Delta_k = \\Delta_{k-1} p_k$，意味着 $p_k = \\frac{\\Delta_k}{\\Delta_{k-1}}$。为了使不带主元选择的GE成功进行到第 $n-1$ 步，所有主元 $p_1, \\dots, p_{n-1}$ 都必须非零。这要求对于所有 $k = 1, \\dots, n-1$，都有 $\\Delta_k \\neq 0$。这是不带主元选择的LU分解存在的必要条件。（注意 $p_n$ 可以为零，这对应于 $\\Delta_n = \\det(A) = 0$；这是允许的，因为不需要用 $p_n$ 作除数）。\n\n3. 应用于所构造的矩阵 $A$。\n\n我们将推导出的条件应用于构造的矩阵 $A = \\begin{pmatrix} 1 & 1 & 1 \\\\ 1 & 1 & 2 \\\\ 1 & 2 & 3 \\end{pmatrix}$。\n一个 $3 \\times 3$ 矩阵具有不带主元选择的LU分解的必要条件是 $\\Delta_1 \\neq 0$ 和 $\\Delta_2 \\neq 0$。\n我们计算矩阵 $A$ 的这些主子式：\n$\\Delta_1 = \\det([1]) = 1$。这满足 $\\Delta_1 \\neq 0$。\n$\\Delta_2 = \\det\\begin{pmatrix} 1 & 1 \\\\ 1 & 1 \\end{pmatrix} = (1)(1) - (1)(1) = 0$。\n因为 $\\Delta_2 = 0$，必要条件被违反。因此，对于这个矩阵 $A$，具有单位对角线 $L$ 且无行置换的LU分解不存在。\n\n最后，我们必须确定第二个主元 $p_2$ 的数值。使用第2部分推导出的公式：\n$$p_2 = \\frac{\\Delta_2}{\\Delta_1}$$\n代入我们矩阵 $A$ 的计算值：\n$$p_2 = \\frac{0}{1} = 0$$\n这与我们在第1部分中的直接计算一致，在那里我们发现矩阵 $A^{(1)}$ 的 $(2,2)$ 元素为 $0$。不带主元选择的GE尝试使用的第二个主元的值恰好是 $0$。", "answer": "$$\\boxed{0}$$", "id": "3578142"}, {"introduction": "在科学计算中，使用 LU 分解的主要动机在于其高效性，尤其是在求解具有多个右端项的线性方程组时。本练习将视角从算法本身转移到其计算成本分析上 [@problem_id:3578124]。通过推导和比较不同求解策略的算术强度，你将能够量化地评估通过重用 LU 因子所带来的显著性能优势，从而理解其在实际应用中的核心价值。", "problem": "考虑一个稠密的、$n \\times n$ 非奇异实数矩阵 $A$ 和一个包含 $m$ 个右端项 (RHS) 的 $n \\times m$ 矩阵 $B$。我们希望使用带部分主元法的 LU (Lower-Upper) 分解，然后对每个 RHS 进行两次三角求解来解方程 $A X = B$。请使用以下代价模型和假设：\n\n- 浮点运算 (flop) 计数模型：每次浮点加法、减法、乘法或除法计为一次 flop。在此 flop 计数中忽略比较和数据移动的开销。\n- LU 分解是原位执行的，$L$ 矩阵的对角线元素为单位一；后续矩阵的更新以乘减对的形式计算。\n- 三角求解包括对单位下三角矩阵 $L$ 的前向代入和对上三角矩阵 $U$ 的回代；在回代中每行包含一次除法。\n- 内存流量模型：处理器与随机存取存储器 (RAM) 之间每次读取或写入一个矩阵或向量元素计为一个字 (word) 的流量。对于 LU 分解，假设整个矩阵 $A$ 一次性流入，并被 $L$ 和 $U$ 原位覆盖，然后一次性流出。对于求解过程，在“分解复用”策略中，假设分解后 $L$ 和 $U$ 驻留在高速内存中，因此只有 $B$ (读取) 和 $X$ (写入) 需要流传输。在“重复求解”策略中，假设对每个 RHS 都重新计算分解，每次都将 $A$ 流入并将 $LU$ 流出，并且对每个 RHS 都流传输 $B$ 和 $X$。忽略主元索引向量和任何元数据的流量。\n\n将计算强度 (AI) 定义为 $\\mathrm{AI} = \\text{flops}/\\text{words moved}$。令 $\\mathrm{AI}_{\\mathrm{reuse}}$ 表示通过计算一次 LU 分解并在 $m$ 个 RHS 中复用该分解来求解 $A X = B$ 的计算强度，令 $\\mathrm{AI}_{\\mathrm{repeat}}$ 表示通过为每个 RHS 独立重新计算 LU 分解来求解的计算强度。根据上述模型，从第一性原理出发，推导改进因子\n$$\\Phi(n,m) = \\frac{\\mathrm{AI}_{\\mathrm{reuse}}}{\\mathrm{AI}_{\\mathrm{repeat}}}$$\n的精确闭式表达式。\n请以单个简化的、用 $n$ 和 $m$ 表示的符号表达式形式给出最终答案。无需四舍五入，最终表达式中不应包含单位。", "solution": "我们从 LU (Lower-Upper) 分解和三角求解的定义，以及给定的 flop 和内存流量模型开始。\n\nLU 分解的 Flop 计数 (原位，部分主元法，$L$ 的对角线元素为单位一)：\n在消元步骤 $k$（$1 \\leq k \\leq n-1$），我们通过除法计算 $(n-k)$ 个乘子 $l_{ik}$，这需要 $(n-k)$ 次 flop，并更新大小为 $(n-k) \\times (n-k)$ 的后续子矩阵。每个后续矩阵元素的更新形式为 $a_{ij} \\leftarrow a_{ij} - l_{ik} u_{kj}$，需要 $2$ 次 flop (一次乘法和一次减法)。因此，在步骤 $k$ 的更新成本为 $2 (n-k)^{2}$ 次 flop。对 $k$ 求和，\n\n$$\nF_{\\mathrm{LU}}(n)\n= \\sum_{k=1}^{n-1} \\bigl[(n-k) + 2 (n-k)^{2}\\bigr]\n= \\sum_{r=1}^{n-1} \\bigl[r + 2 r^{2}\\bigr],\n$$\n\n其中 $r = n-k$。使用 $\\sum_{r=1}^{n-1} r = \\frac{n(n-1)}{2}$ 和 $\\sum_{r=1}^{n-1} r^{2} = \\frac{(n-1)n(2n-1)}{6}$，\n\n$$\nF_{\\mathrm{LU}}(n)\n= \\frac{n(n-1)}{2} + 2 \\cdot \\frac{(n-1)n(2n-1)}{6}\n= \\frac{(n-1)n(4n+1)}{6}.\n$$\n\n\n单个 RHS 三角求解的 Flop 计数：\n对单位下三角矩阵 $L$ 进行前向代入计算 $y_{i} = b_{i} - \\sum_{j=1}^{i-1} L_{ij} y_{j}$，对于第 $i$ 行，需要 $(i-1)$ 次乘法和 $(i-1)$ 次加法。对 $i$ 求和得到\n\n$$\nF_{\\mathrm{fwd}}(n) = \\sum_{i=1}^{n} 2(i-1) = n(n-1).\n$$\n\n对上三角矩阵 $U$ 进行回代计算 $x_{i} = \\bigl(y_{i} - \\sum_{j=i+1}^{n} U_{ij} x_{j}\\bigr) / U_{ii}$，对于第 $i$ 行，需要 $(n-i)$ 次乘法、$(n-i)$ 次加法和 1 次除法。对 $i$ 求和，\n\n$$\nF_{\\mathrm{bwd}}(n) = \\sum_{i=1}^{n} \\bigl[2(n-i) + 1\\bigr] = n(n-1) + n = n^{2}.\n$$\n\n因此，每个 RHS 的总 flop 计数为\n\n$$\nF_{\\mathrm{solve,\\,per\\,RHS}}(n) = F_{\\mathrm{fwd}}(n) + F_{\\mathrm{bwd}}(n) = \\bigl[n(n-1)\\bigr] + \\bigl[n^{2}\\bigr] = 2n^{2} - n.\n$$\n\n\n两种策略的总 flop 计数：\n- 在 $m$ 个 RHS 之间复用分解：\n\n$$\nF_{\\mathrm{reuse}}(n,m) = F_{\\mathrm{LU}}(n) + m \\, F_{\\mathrm{solve,\\,per\\,RHS}}(n)\n= \\frac{(n-1)n(4n+1)}{6} + m(2n^{2} - n).\n$$\n\n- 对每个 RHS 重复分解：\n\n$$\nF_{\\mathrm{repeat}}(n,m) = m \\bigl[F_{\\mathrm{LU}}(n) + F_{\\mathrm{solve,\\,per\\,RHS}}(n)\\bigr]\n= m \\left(\\frac{(n-1)n(4n+1)}{6} + 2n^{2} - n\\right).\n$$\n\n\n在所述模型下的内存流量：\n- 对于 LU 分解，将 $A$ 一次性流入，并被 $L$ 和 $U$ 原位覆盖，然后一次性流出。这需要 $n^{2}$ 字的读取和 $n^{2}$ 字的写入，即移动了 $2n^{2}$ 个字。\n- 对于采用分解复用策略的求解，假设 $L$ 和 $U$ 驻留在高速内存中；只有 $B$ 和 $X$ 需要流传输。在 $m$ 个 RHS 中读取 $B$ 和写入 $X$ 需要 $n m$ 字的读取和 $n m$ 字的写入，即移动了 $2 n m$ 个字。\n因此，\n\n$$\nW_{\\mathrm{reuse}}(n,m) = 2 n^{2} + 2 n m = 2n(n+m).\n$$\n\n- 对于重复分解策略，对每个 RHS 都重新计算 LU 分解，每次都将 $A$ 流入并将被覆盖的 $LU$ 流出，每个 RHS 总共需要 $2 n^{2}$ 个字；每个 RHS 的 $B$ 和 $X$ 流传输会额外增加 $2 n$ 个字。对于 $m$ 个 RHS，\n\n$$\nW_{\\mathrm{repeat}}(n,m) = m \\cdot 2 n^{2} + m \\cdot 2 n = 2 m n^{2} + 2 m n = 2 m n (n+1).\n$$\n\n\n每种策略的计算强度 (AI)：\n\n$$\n\\mathrm{AI}_{\\mathrm{reuse}}(n,m) = \\frac{F_{\\mathrm{reuse}}(n,m)}{W_{\\mathrm{reuse}}(n,m)}\n= \\frac{\\frac{(n-1)n(4n+1)}{6} + m(2n^{2} - n)}{2n(n+m)}.\n$$\n\n\n$$\n\\mathrm{AI}_{\\mathrm{repeat}}(n,m) = \\frac{F_{\\mathrm{repeat}}(n,m)}{W_{\\mathrm{repeat}}(n,m)}\n= \\frac{m \\left(\\frac{(n-1)n(4n+1)}{6} + 2n^{2} - n\\right)}{2 m n (n+1)}\n= \\frac{\\frac{(n-1)n(4n+1)}{6} + 2n^{2} - n}{2 n (n+1)}.\n$$\n\n\n改进因子 $\\Phi(n,m)$：\n\n$$\n\\Phi(n,m) = \\frac{\\mathrm{AI}_{\\mathrm{reuse}}(n,m)}{\\mathrm{AI}_{\\mathrm{repeat}}(n,m)}\n= \\frac{\\frac{(n-1)n(4n+1)}{6} + m(2n^{2} - n)}{2n(n+m)}\n\\cdot\n\\frac{2 n (n+1)}{\\frac{(n-1)n(4n+1)}{6} + 2n^{2} - n}.\n$$\n\n消去 $2n$ 并化简得到\n\n$$\n\\Phi(n,m) = \\frac{n+1}{n+m} \\cdot\n\\frac{\\frac{(n-1)n(4n+1)}{6} + m(2n^{2} - n)}{\\frac{(n-1)n(4n+1)}{6} + 2n^{2} - n}.\n$$\n\n\n这就是所述模型下的精确闭式表达式。作为合理性检查，考虑当 $n$ 固定时 $m \\to \\infty$。那么\n$$\n\\Phi(n,m) \\sim \\frac{n+1}{n+m} \\cdot \\frac{m(2n^{2} - n)}{\\frac{(n-1)n(4n+1)}{6} + 2n^{2} - n}\n\\sim \\frac{n}{m} \\cdot \\frac{m(2n^{2} - n)}{\\frac{(n-1)n(4n+1)}{6} + 2n^{2} - n}\n\\sim \\frac{2n^{3}}{\\frac{(n-1)n(4n+1)}{6}}\n\\to \\frac{2n^{3}}{\\frac{4n^{3} - 3n^{2} - n}{6}} \\approx 3\n$$\n对于大的 $n$，这恢复了一个直观的改进结论，即在这种简化的流模型中，复用策略相对于重复分解策略，其计算强度渐近地提高了三倍。\n\n因此，所需的最终表达式为\n\n$$\n\\Phi(n,m) = \\frac{n+1}{n+m} \\cdot\n\\frac{\\frac{(n-1)n(4n+1)}{6} + m(2n^{2} - n)}{\\frac{(n-1)n(4n+1)}{6} + 2n^{2} - n}.\n$$", "answer": "$$\\boxed{\\frac{n+1}{n+m}\\cdot\\frac{\\frac{(n-1)n(4n+1)}{6}+m\\left(2n^{2}-n\\right)}{\\frac{(n-1)n(4n+1)}{6}+2n^{2}-n}}$$", "id": "3578124"}]}