{"hands_on_practices": [{"introduction": "在实现或使用任何复杂算法之前，理解其计算需求是至关重要的。本练习将准最小残差法 (QMR) 的核心——双Lanczos过程的单次迭代——分解为其基本运算。通过分析浮点运算（flops）和内存存储，您将具体理解算法的复杂度及其如何随问题规模扩展，这是开发高效科学计算软件的关键技能。[@problem_id:3594292]", "problem": "考虑使用准最小残差 (QMR) 方法求解一个线性系统，该系统具有一个实非对称稀疏矩阵 $A \\in \\mathbb{R}^{n \\times n}$。bi-Lanczos 过程同时构建右 Krylov 基 $V_{k}$ 和左 Krylov 基 $W_{k}$，使得第 $(k+1)$ 步使用短三项递推将 $V_{k}$ 扩展到 $V_{k+1}$，并将 $W_{k}$ 扩展到 $W_{k+1}$。对于这单次 bi-Lanczos 扩展步骤，假设采用以下每次迭代的工作模型：\n- 每次迭代恰好发生一次与 $A$ 的稀疏矩阵-向量乘法和一次与 $A^{\\mathsf{T}}$ 的乘法。\n- 每次迭代执行固定数量的内积，即 $s=4$ 次 $\\mathbb{R}^{n}$ 中向量的内积。\n- 每次迭代执行固定数量的 axpy 型向量更新，即 $t=6$ 次形式为 $x \\leftarrow x + \\alpha y$ 的更新，每次都使用 $\\mathbb{R}^{n}$ 中的向量。\n- 每次迭代执行固定数量的向量缩放，即 $u=2$ 次形式为 $x \\leftarrow \\alpha x$ 的运算。\n\n采用标准运算成本模型：\n- 与具有 $m$ 个非零元的矩阵进行一次稀疏矩阵-向量乘法耗费 $2m$ 次浮点运算 (flops)。\n- 一次长度为 $n$ 的内积耗费 $2n$ flops。\n- 一次长度为 $n$ 的 axpy 耗费 $2n$ flops。\n- 一次长度为 $n$ 的缩放耗费 $n$ flops。\n\n对于存储，假设每个新生成的基向量都被显式存储，并且除了向量 $v_{k+1}$ 和 $w_{k+1}$ 之外，每次迭代还存储恰好三个标量递推系数。\n\n在这些假设下，计算：\n1. 将 $V_{k}$ 扩展到 $V_{k+1}$ 并将 $W_{k}$ 扩展到 $W_{k+1}$ 所需的每次迭代的精确浮点运算次数 $F(n,m)$。\n2. 添加这些新的基向量和标量系数时所需的增量存储 $S(n)$（以标量数量计）。\n\n将您的最终答案表示为行矩阵 $\\begin{pmatrix} F(n,m)  S(n) \\end{pmatrix}$，其中两个条目都以 $n$ 和 $m$ 的闭式表达式给出。", "solution": "本问题要求计算在准最小残差 (QMR) 方法中，bi-Lanczos 过程单次迭代的两个量：总浮点运算 (flop) 次数，记为 $F(n,m)$，以及增量存储需求，记为 $S(n)$。问题为每次迭代的运算次数及其各自的成本，以及需要存储的组件提供了精确的模型。\n\n首先，我们将计算每次迭代的 flop 次数 $F(n,m)$。这是一次迭代中所有指定操作所需 flop 的总和。问题详细说明了以下操作及其对于一个具有 $m$ 个非零元的稀疏矩阵 $A \\in \\mathbb{R}^{n \\times n}$ 的成本：\n\n1.  **矩阵-向量乘法**：问题指出，每次迭代有一次与 $A$ 的稀疏矩阵-向量乘法和一次与其转置 $A^{\\mathsf{T}}$ 的乘法。矩阵 $A^{\\mathsf{T}}$ 与 $A$ 具有相同数量的非零元，即 $m$。单个此类操作的成本为 $2m$ flops。\n    每次迭代中矩阵-向量乘法的总成本为：\n    $$ \\text{成本}_{\\text{matvec}} = (\\text{对 } A \\text{ 的成本}) + (\\text{对 } A^{\\mathsf{T}} \\text{ 的成本}) = 2m + 2m = 4m \\text{ flops.} $$\n\n2.  **内积**：问题指明每次迭代执行 $s=4$ 次内积。每次内积涉及长度为 $n$ 的向量。一个长度为 $n$ 的内积的成本为 $2n$ flops。\n    每次迭代中内积的总成本为：\n    $$ \\text{成本}_{\\text{inner}} = s \\times (2n) = 4 \\times 2n = 8n \\text{ flops.} $$\n\n3.  **AXPY 型向量更新**：问题指出执行 $t=6$ 次形式为 $x \\leftarrow x + \\alpha y$ 的更新 (axpy)。这些更新涉及 $\\mathbb{R}^{n}$ 中的向量。一个长度为 $n$ 的 axpy 操作的成本为 $2n$ flops。\n    每次迭代中 axpy 更新的总成本为：\n    $$ \\text{成本}_{\\text{axpy}} = t \\times (2n) = 6 \\times 2n = 12n \\text{ flops.} $$\n\n4.  **向量缩放**：问题指明执行 $u=2$ 次形式为 $x \\leftarrow \\alpha x$ 的向量缩放。这些操作涉及长度为 $n$ 的向量。一个长度为 $n$ 的缩放操作的成本为 $n$ flops。\n    每次迭代中向量缩放的总成本为：\n    $$ \\text{成本}_{\\text{scale}} = u \\times n = 2 \\times n = 2n \\text{ flops.} $$\n\n每次迭代的总 flop 次数 $F(n,m)$ 是这些单独成本的总和：\n$$ F(n,m) = \\text{成本}_{\\text{matvec}} + \\text{成本}_{\\text{inner}} + \\text{成本}_{\\text{axpy}} + \\text{成本}_{\\text{scale}} $$\n$$ F(n,m) = 4m + 8n + 12n + 2n $$\n$$ F(n,m) = 4m + 22n $$\n\n接下来，我们将计算每次迭代的增量存储 $S(n)$。这是必须存储的新标量值的总数。问题指明了以下存储需求：\n\n1.  **新的基向量**：在每一步，该过程生成并存储两个新的基向量 $v_{k+1}$ 和 $w_{k+1}$。两个向量都在 $\\mathbb{R}^{n}$ 中。存储一个长度为 $n$ 的向量需要存储 $n$ 个标量值。\n    两个新基向量的存储量为：\n    $$ \\text{存储}_{\\text{vectors}} = (\\text{对 } v_{k+1} \\text{ 的存储}) + (\\text{对 } w_{k+1} \\text{ 的存储}) = n + n = 2n \\text{ 个标量。} $$\n\n2.  **标量递推系数**：问题指出每次迭代恰好存储三个标量递推系数。\n    这些系数的存储量为：\n    $$ \\text{存储}_{\\text{coeffs}} = 3 \\text{ 个标量。} $$\n\n总增量存储 $S(n)$ 是这些分量的总和：\n$$ S(n) = \\text{存储}_{\\text{vectors}} + \\text{存储}_{\\text{coeffs}} $$\n$$ S(n) = 2n + 3 $$\n\n问题要求将最终答案以行矩阵 $\\begin{pmatrix} F(n,m)  S(n) \\end{pmatrix}$ 的形式呈现。代入我们推导出的 $F(n,m)$ 和 $S(n)$ 的表达式，我们得到最终结果。", "answer": "$$ \\boxed{ \\begin{pmatrix} 4m + 22n  2n + 3 \\end{pmatrix} } $$", "id": "3594292"}, {"introduction": "QMR方法是在双共轭梯度法 (BiCG) 等早期方法的基础上发展而来的，其关键改进之一是对于可能导致BiCG算法中断的“分解”（breakdown）现象具有更好的稳健性。本练习让您亲手探究导致底层双正交Lanczos过程发生此类分解的数学条件。通过构造一个发生分解的简单场景，您将领会到QMR更稳健设计（例如，look-ahead策略）背后的理论动机。[@problem_id:3594335]", "problem": "考虑在数值线性代数中，作为求解非对称线性系统的双共轭梯度法 (Biconjugate Gradient, BiCG) 和拟最小残差法 (Quasi-Minimal Residual, QMR) 基础的双正交 Lanczos 过程。设 $A \\in \\mathbb{R}^{3 \\times 3}$ 是一个非对称三对角托普利茨 (Toeplitz) 矩阵，其恒定的次对角线、对角线和超对角线元素分别由 $s$、$m$ 和 $t$ 给出：\n$$\nA \\;=\\;\n\\begin{pmatrix}\nm  t  0 \\\\\ns  m  t \\\\\n0  s  m\n\\end{pmatrix}.\n$$\n设初始猜测为 $x_0 = \\mathbf{0}$，右端项为 $b = \\mathbf{e}_1$，因此初始残差为 $r_0 = b - A x_0 = \\mathbf{e}_1$。选择影子残差 $r_0^\\sharp = \\mathbf{e}_1$。定义第一个右和左 Lanczos 向量为 $v_1 = r_0$ 和 $w_1 = r_0^\\sharp$。对于第一步 Lanczos 迭代，定义标量\n$$\n\\alpha_1 \\;=\\; \\frac{w_1^{T} A v_1}{w_1^{T} v_1}.\n$$\n然后通过以下方式构成第二个右和左 Lanczos 向量：\n$$\nv_2 \\;=\\; A v_1 \\;-\\; \\alpha_1 v_1, \n\\qquad\nw_2 \\;=\\; A^{T} w_1 \\;-\\; \\alpha_1 w_1.\n$$\n如果 $w_2^{T} v_2 = 0$，BiCG 算法在迭代 $j=2$ 时会发生精确崩溃，而带有前瞻策略的 QMR 算法可以通过跳过该问题步骤继续进行。仅使用这些定义和给定数据，推导出 $w_2^{T} v_2$ 关于次对角线和超对角线参数 $s$ 和 $t$ 的闭式表达式。基于此表达式，可以立即得出触发 ($w_2^{T} v_2 = 0$) 和避免 ($w_2^{T} v_2 \\neq 0$) BiCG 在 $j=2$ 时崩溃的 $s$ 和 $t$ 的参数范围，并且在前一种情况下，带有前瞻策略的 QMR 是适用的。\n\n以 $w_2^{T} v_2$ 关于 $s$ 和 $t$ 的精确代数表达式的形式提供你的最终答案。", "solution": "该问题陈述已被验证为具有科学依据、适定且客观。它为数值线性代数中的一个标准问题提供了自洽且一致的设置。所有定义和过程都是分析双正交 Lanczos 过程的标准方法，该过程是双共轭梯度法 (BiCG) 和拟最小残差法 (QMR) 的基础。因此，该问题被认为是有效的，并按如下方式推导求解。\n\n目标是计算标量值 $w_2^{T} v_2$，该值决定了 BiCG 算法是否在第二步发生崩溃。推导过程基于给定的条件，系统地计算所有中间量。\n\n矩阵 $A \\in \\mathbb{R}^{3 \\times 3}$ 由下式给出：\n$$\nA \\;=\\;\n\\begin{pmatrix}\nm  t  0 \\\\\ns  m  t \\\\\n0  s  m\n\\end{pmatrix}\n$$\n右端向量为 $b = \\mathbf{e}_1$，初始猜测为 $x_0 = \\mathbf{0}$。初始残差为 $r_0 = b - Ax_0 = \\mathbf{e}_1 - A\\mathbf{0} = \\mathbf{e}_1$。\n初始影子残差选择为 $r_0^\\sharp = \\mathbf{e}_1$。\n\n第一个右和左 Lanczos 向量由这些残差定义：\n$$\nv_1 = r_0 = \\mathbf{e}_1 = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n$$\nw_1 = r_0^\\sharp = \\mathbf{e}_1 = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n第一步是计算标量 $\\alpha_1$：\n$$\n\\alpha_1 \\;=\\; \\frac{w_1^{T} A v_1}{w_1^{T} v_1}\n$$\n我们首先计算分母 $w_1^{T} v_1$：\n$$\nw_1^{T} v_1 = \\begin{pmatrix} 1  0  0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = 1\n$$\n由于 $w_1^{T} v_1 \\neq 0$，过程可以继续。\n\n接下来，我们计算分子 $w_1^{T} A v_1$。我们首先计算矩阵-向量乘积 $A v_1$：\n$$\nA v_1 = \\begin{pmatrix} m  t  0 \\\\ s  m  t \\\\ 0  s  m \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} m \\\\ s \\\\ 0 \\end{pmatrix}\n$$\n现在，我们可以计算分子：\n$$\nw_1^{T} (A v_1) = \\begin{pmatrix} 1  0  0 \\end{pmatrix} \\begin{pmatrix} m \\\\ s \\\\ 0 \\end{pmatrix} = m\n$$\n使用这些结果，我们得到 $\\alpha_1$：\n$$\n\\alpha_1 = \\frac{m}{1} = m\n$$\n下一步是构成第二个右 Lanczos 向量 $v_2$：\n$$\nv_2 = A v_1 - \\alpha_1 v_1\n$$\n代入我们已经计算出的量：\n$$\nv_2 = \\begin{pmatrix} m \\\\ s \\\\ 0 \\end{pmatrix} - m \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} m \\\\ s \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} m \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ s \\\\ 0 \\end{pmatrix}\n$$\n类似地，我们构成第二个左 Lanczos 向量 $w_2$：\n$$\nw_2 = A^{T} w_1 - \\alpha_1 w_1\n$$\n首先，我们求 $A$ 的转置，记为 $A^T$：\n$$\nA^{T} = \\begin{pmatrix} m  s  0 \\\\ t  m  s \\\\ 0  t  m \\end{pmatrix}\n$$\n接下来，我们计算矩阵-向量乘积 $A^T w_1$：\n$$\nA^{T} w_1 = \\begin{pmatrix} m  s  0 \\\\ t  m  s \\\\ 0  t  m \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} m \\\\ t \\\\ 0 \\end{pmatrix}\n$$\n现在，我们可以计算 $w_2$：\n$$\nw_2 = \\begin{pmatrix} m \\\\ t \\\\ 0 \\end{pmatrix} - m \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} m \\\\ t \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} m \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ t \\\\ 0 \\end{pmatrix}\n$$\n最后，我们计算量 $w_2^{T} v_2$，它是第二个左和右 Lanczos 向量的内积。如果这个量为零，BiCG 就会发生精确崩溃。\n$$\nw_2^{T} v_2 = \\begin{pmatrix} 0  t  0 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ s \\\\ 0 \\end{pmatrix} = (0)(0) + (t)(s) + (0)(0) = st\n$$\n$w_2^{T} v_2$ 的表达式是 $st$。这个结果表明，在第二步发生崩溃的充要条件是 $st = 0$，这意味着次对角线元素 $s$ 或超对角线元素 $t$ 为零。在这种情况下，三对角矩阵 $A$ 将变为三角矩阵。对角线元素 $m$ 不影响这个特定的崩溃条件。", "answer": "$$\\boxed{st}$$", "id": "3594335"}, {"introduction": "对于大型病态系统，“裸”迭代法的收敛速度可能慢到不切实际。预处理是加速收敛最关键的技术。本练习通过检视三种标准方法——左预处理、右预处理和分裂预处理——来探索如何将预处理器与QMR方法相结合。通过推导变换后的系统并将其应用于具体示例，您将学会预处理如何重塑Krylov求解器实际面对的问题，这是现代迭代方法中的一个基本概念。[@problem_id:3594301]", "problem": "考虑使用准最小残差(QMR)方法求解非对称线性系统 $A x = b$，其中QMR代表准最小残差。设 $M$ 是一个非奇异预条件子。QMR方法建立在应用于系统算子及其关于欧几里得内积的伴随算子的双兰索斯过程之上。\n\n任务1 (推导)：从左预处理、右预处理和分裂预处理的定义出发，推导进入双兰索斯过程的相应算子及其伴随算子：\n- 左预处理：变换后的系统是 $M^{-1} A x = M^{-1} b$。\n- 右预处理：变换后的系统是 $A M^{-1} y = b$，其中 $x = M^{-1} y$。\n- 分裂预处理：变换后的系统是 $M^{-1} A M^{-1} y = M^{-1} b$，其中 $x = M^{-1} y$。\n\n对于每种情况，将变换后的算子记为 $T$，并推导其关于标准欧几里得内积的伴随算子 $T^{\\ast}$，仅用 $A$、$A^{\\ast}$、$M$ 和 $M^{\\ast}$ 表示。清楚地说明双兰索斯向量对 $\\{v_k\\}$ 和 $\\{w_k\\}$ 是如何推进的，即前向序列由 $T$ 驱动，后向（影子）序列由 $T^{\\ast}$ 驱动，并指明起始向量的双正交性条件 $\\left(w_1, v_1\\right) = 1$。\n\n任务2 (初始化与计算)：对于每种预处理，按如下方式从相应的残差初始化双兰索斯过程：\n- 左预处理和分裂预处理：使用变换空间中的初始残差 $r_0^{(L)} = M^{-1} b$ 和 $r_0^{(S)} = M^{-1} b$。令 $v_1^{(L)} = r_0^{(L)} / \\|r_0^{(L)}\\|_2$ 和 $v_1^{(S)} = r_0^{(S)} / \\|r_0^{(S)}\\|_2$，并选择 $w_1^{(L)} = v_1^{(L)}$ 和 $w_1^{(S)} = v_1^{(S)}$ 以使得 $\\left(w_1^{(\\cdot)}, v_1^{(\\cdot)}\\right) = 1$。\n- 右预处理：使用变换空间中的初始残差 $r_0^{(R)} = b$。令 $v_1^{(R)} = r_0^{(R)} / \\|r_0^{(R)}\\|_2$ 并选择 $w_1^{(R)} = v_1^{(R)}$ 以使得 $\\left(w_1^{(R)}, v_1^{(R)}\\right) = 1$。\n\n在每种情况下，将第一个双兰索斯对角系数 $\\alpha_1$ 定义为 $\\alpha_1 = \\left(w_1, T v_1\\right)$，其中 $T$ 是该预处理的变换算子。\n\n任务3 (数值计算)：对于具体数据\n$$\nA = \\begin{pmatrix} 4  1 \\\\ 0  2 \\end{pmatrix}, \\quad\nM = \\begin{pmatrix} 2  0 \\\\ 0  3 \\end{pmatrix}, \\quad\nb = \\begin{pmatrix} 2 \\\\ 3 \\end{pmatrix},\n$$\n具体执行任务2，以计算分别对应于左预处理、右预处理和分裂预处理的三个值 $\\alpha_1^{(L)}$、$\\alpha_1^{(R)}$ 和 $\\alpha_1^{(S)}$。然后构成标量\n$$\nS \\;=\\; \\alpha_1^{(L)} \\;+\\; \\alpha_1^{(R)} \\;+\\; \\alpha_1^{(S)}.\n$$\n\n答案要求：\n- 您的最终答案必须是 $S$ 的精确值，表示为单个最简有理数。\n- 不涉及单位。", "solution": "首先验证问题，以确保其自洽、科学上合理且适定。\n\n### 步骤1：提取已知条件\n- **任务**：使用准最小残差(QMR)方法求解 $A x = b$。\n- **系统**：$A$ 是一个非对称矩阵，$M$ 是一个非奇异预条件子。\n- **内积**：伴随是关于标准欧几里得内积定义的，对于实向量 $u, v$，其内积为 $(u,v) = v^T u$。\n- **预处理方案**：\n    - 左预处理：$M^{-1} A x = M^{-1} b$。\n    - 右预处理：$A M^{-1} y = b$，其中 $x = M^{-1} y$。\n    - 分裂预处理：$M^{-1} A M^{-1} y = M^{-1} b$，其中 $x = M^{-1} y$。\n- **算子定义**：\n    - $T$：每种方案的变换算子。\n    - $T^{\\ast}$：$T$ 的伴随算子。\n- **双兰索斯过程**：序列 $\\{v_k\\}$ 由 $T$ 驱动，$\\{w_k\\}$ 由 $T^{\\ast}$ 驱动。\n- **初始条件**：\n    - 起始向量必须满足 $(w_1, v_1) = 1$。\n    - 对于左预处理和分裂预处理：$r_0 = M^{-1} b$，$v_1 = r_0 / \\|r_0\\|_2$，$w_1 = v_1$。\n    - 对于右预处理：$r_0 = b$，$v_1 = r_0 / \\|r_0\\|_2$，$w_1 = v_1$。\n- **系数 $\\alpha_1$**：$\\alpha_1 = (w_1, T v_1)$。\n- **数值数据**：\n    - $A = \\begin{pmatrix} 4  1 \\\\ 0  2 \\end{pmatrix}$\n    - $M = \\begin{pmatrix} 2  0 \\\\ 0  3 \\end{pmatrix}$\n    - $b = \\begin{pmatrix} 2 \\\\ 3 \\end{pmatrix}$\n- **最终量**：$S = \\alpha_1^{(L)} + \\alpha_1^{(R)} + \\alpha_1^{(S)}$。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题定义明确，数学上合理，并为得到唯一解提供了所有必要信息。这是数值线性代数领域的标准问题。预处理、QMR和双兰索斯过程的概念都是标准的。所提供的数据是一致的，可以直接进行计算。问题是有效的。\n\n### 步骤3：结论与行动\n问题有效。下面提供完整解答。\n\n---\n\n解答按问题任务中指定的三部分进行。\n\n### 任务1：算子的推导\n\n对于一个矩阵算子 $T$ 而言，其关于欧几里得内积的伴随是其共轭转置，记为 $T^{\\ast}$。对于实矩阵，这就是转置 $T^T$。问题使用了通用记号 $A^{\\ast}$、$M^{\\ast}$，对于给定的实矩阵，它们对应于 $A^T$、$M^T$。矩阵乘积的伴随是其伴随的逆序乘积，即 $(XY)^{\\ast} = Y^{\\ast}X^{\\ast}$。逆矩阵的伴随是伴随的逆，即 $(X^{-1})^{\\ast} = (X^{\\ast})^{-1}$。\n\n1.  **左预处理**：系统是 $M^{-1} A x = M^{-1} b$。\n    变换算子是 $T^{(L)} = M^{-1} A$。\n    其伴随算子是 $T^{(L)\\ast} = (M^{-1} A)^{\\ast} = A^{\\ast} (M^{-1})^{\\ast} = A^{\\ast} (M^{\\ast})^{-1}$。\n\n2.  **右预处理**：系统是 $A M^{-1} y = b$，其中 $x = M^{-1} y$。\n    变换算子是 $T^{(R)} = A M^{-1}$。\n    其伴随算子是 $T^{(R)\\ast} = (A M^{-1})^{\\ast} = (M^{-1})^{\\ast} A^{\\ast} = (M^{\\ast})^{-1} A^{\\ast}$。\n\n3.  **分裂预处理**：系统是 $M^{-1} A M^{-1} y = M^{-1} b$，其中 $x = M^{-1} y$。\n    变换算子是 $T^{(S)} = M^{-1} A M^{-1}$。\n    其伴随算子是 $T^{(S)\\ast} = (M^{-1} A M^{-1})^{\\ast} = (M^{-1})^{\\ast} A^{\\ast} (M^{-1})^{\\ast} = (M^{\\ast})^{-1} A^{\\ast} (M^{\\ast})^{-1}$。\n\n在双兰索斯过程中，向量序列 $\\{v_k\\}$ 是通过应用算子 $T$ 生成的，而向量序列 $\\{w_k\\}$ 是通过应用伴随算子 $T^{\\ast}$ 生成的。具体来说，这些向量是通过三项递推关系生成的，其中 $v_{k+1}$ 位于由 $T$ 作用于 $v_k$ 生成的克雷洛夫子空间中，而 $w_{k+1}$ 位于由 $T^{\\ast}$ 作用于 $w_k$ 生成的克雷洛夫子空间中。初始向量 $v_1$ 和 $w_1$ 必须满足双正交性条件 $(w_1, v_1) = w_1^{\\ast}v_1 = 1$。\n\n### 任务2：$\\alpha_1$ 的初始化与计算\n\n双兰索斯过程中的第一个对角系数是 $\\alpha_1 = (w_1, T v_1)$。问题指定设置 $w_1 = v_1$。由于 $v_1$ 是一个单位向量，$\\|v_1\\|_2 = 1$，条件 $(w_1, v_1) = (v_1, v_1) = v_1^T v_1 = \\|v_1\\|_2^2 = 1$ 得到满足。通过此选择，$\\alpha_1$ 的公式变为 $\\alpha_1 = (v_1, T v_1) = v_1^T T v_1$。\n\n1.  **左预处理**：\n    $r_0^{(L)} = M^{-1} b$。\n    $v_1^{(L)} = \\frac{r_0^{(L)}}{\\|r_0^{(L)}\\|_2}$。\n    $\\alpha_1^{(L)} = (v_1^{(L)})^T T^{(L)} v_1^{(L)} = \\left(\\frac{r_0^{(L)}}{\\|r_0^{(L)}\\|_2}\\right)^T (M^{-1}A) \\left(\\frac{r_0^{(L)}}{\\|r_0^{(L)}\\|_2}\\right) = \\frac{(r_0^{(L)})^T M^{-1} A r_0^{(L)}}{(r_0^{(L)})^T r_0^{(L)}}$。\n\n2.  **右预处理**：\n    $r_0^{(R)} = b$。\n    $v_1^{(R)} = \\frac{r_0^{(R)}}{\\|r_0^{(R)}\\|_2} = \\frac{b}{\\|b\\|_2}$。\n    $\\alpha_1^{(R)} = (v_1^{(R)})^T T^{(R)} v_1^{(R)} = \\left(\\frac{b}{\\|b\\|_2}\\right)^T (AM^{-1}) \\left(\\frac{b}{\\|b\\|_2}\\right) = \\frac{b^T A M^{-1} b}{b^T b}$。\n\n3.  **分裂预处理**：\n    $r_0^{(S)} = M^{-1} b$。\n    $v_1^{(S)} = \\frac{r_0^{(S)}}{\\|r_0^{(S)}\\|_2}$。\n    $\\alpha_1^{(S)} = (v_1^{(S)})^T T^{(S)} v_1^{(S)} = \\left(\\frac{r_0^{(S)}}{\\|r_0^{(S)}\\|_2}\\right)^T (M^{-1}AM^{-1}) \\left(\\frac{r_0^{(S)}}{\\|r_0^{(S)}\\|_2}\\right) = \\frac{(r_0^{(S)})^T M^{-1} A M^{-1} r_0^{(S)}}{(r_0^{(S)})^T r_0^{(S)}}$。\n\n### 任务3：数值计算\n\n我们有如下数据：\n$A = \\begin{pmatrix} 4  1 \\\\ 0  2 \\end{pmatrix}$，$M = \\begin{pmatrix} 2  0 \\\\ 0  3 \\end{pmatrix}$，$b = \\begin{pmatrix} 2 \\\\ 3 \\end{pmatrix}$。\n首先，我们计算 $M^{-1}$：\n$M^{-1} = \\begin{pmatrix} 1/2  0 \\\\ 0  1/3 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2}  0 \\\\ 0  \\frac{1}{3} \\end{pmatrix}$。\n\n**计算 $\\alpha_1^{(L)}$**：\n左预处理的初始向量是 $r_0^{(L)} = M^{-1} b = \\begin{pmatrix} \\frac{1}{2}  0 \\\\ 0  \\frac{1}{3} \\end{pmatrix} \\begin{pmatrix} 2 \\\\ 3 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。\n范数的平方是 $(r_0^{(L)})^T r_0^{(L)} = 1^2 + 1^2 = 2$。\n算子是 $T^{(L)} = M^{-1}A = \\begin{pmatrix} \\frac{1}{2}  0 \\\\ 0  \\frac{1}{3} \\end{pmatrix} \\begin{pmatrix} 4  1 \\\\ 0  2 \\end{pmatrix} = \\begin{pmatrix} 2  \\frac{1}{2} \\\\ 0  \\frac{2}{3} \\end{pmatrix}$。\n分子是 $(r_0^{(L)})^T T^{(L)} r_0^{(L)} = \\begin{pmatrix} 1  1 \\end{pmatrix} \\begin{pmatrix} 2  \\frac{1}{2} \\\\ 0  \\frac{2}{3} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1  1 \\end{pmatrix} \\begin{pmatrix} 2 + \\frac{1}{2} \\\\ 0 + \\frac{2}{3} \\end{pmatrix} = \\begin{pmatrix} 1  1 \\end{pmatrix} \\begin{pmatrix} \\frac{5}{2} \\\\ \\frac{2}{3} \\end{pmatrix} = \\frac{5}{2} + \\frac{2}{3} = \\frac{15+4}{6} = \\frac{19}{6}$。\n所以，$\\alpha_1^{(L)} = \\frac{19/6}{2} = \\frac{19}{12}$。\n\n**计算 $\\alpha_1^{(R)}$**：\n初始向量是 $r_0^{(R)} = b = \\begin{pmatrix} 2 \\\\ 3 \\end{pmatrix}$。\n范数的平方是 $b^T b = 2^2 + 3^2 = 4 + 9 = 13$。\n算子是 $T^{(R)} = AM^{-1} = \\begin{pmatrix} 4  1 \\\\ 0  2 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{2}  0 \\\\ 0  \\frac{1}{3} \\end{pmatrix} = \\begin{pmatrix} 2  \\frac{1}{3} \\\\ 0  \\frac{2}{3} \\end{pmatrix}$。\n分子是 $b^T T^{(R)} b = \\begin{pmatrix} 2  3 \\end{pmatrix} \\begin{pmatrix} 2  \\frac{1}{3} \\\\ 0  \\frac{2}{3} \\end{pmatrix} \\begin{pmatrix} 2 \\\\ 3 \\end{pmatrix} = \\begin{pmatrix} 2  3 \\end{pmatrix} \\begin{pmatrix} 4 + 1 \\\\ 0 + 2 \\end{pmatrix} = \\begin{pmatrix} 2  3 \\end{pmatrix} \\begin{pmatrix} 5 \\\\ 2 \\end{pmatrix} = 10 + 6 = 16$。\n所以，$\\alpha_1^{(R)} = \\frac{16}{13}$。\n\n**计算 $\\alpha_1^{(S)}$**：\n初始向量是 $r_0^{(S)} = M^{-1} b = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$，与左预处理相同。范数的平方是 $(r_0^{(S)})^T r_0^{(S)} = 2$。\n算子是 $T^{(S)} = M^{-1}AM^{-1} = \\begin{pmatrix} 2  \\frac{1}{2} \\\\ 0  \\frac{2}{3} \\end{pmatrix} \\begin{pmatrix} \\frac{1}{2}  0 \\\\ 0  \\frac{1}{3} \\end{pmatrix} = \\begin{pmatrix} 1  \\frac{1}{6} \\\\ 0  \\frac{2}{9} \\end{pmatrix}$。\n分子是 $(r_0^{(S)})^T T^{(S)} r_0^{(S)} = \\begin{pmatrix} 1  1 \\end{pmatrix} \\begin{pmatrix} 1  \\frac{1}{6} \\\\ 0  \\frac{2}{9} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1  1 \\end{pmatrix} \\begin{pmatrix} 1 + \\frac{1}{6} \\\\ 0 + \\frac{2}{9} \\end{pmatrix} = \\begin{pmatrix} 1  1 \\end{pmatrix} \\begin{pmatrix} \\frac{7}{6} \\\\ \\frac{2}{9} \\end{pmatrix} = \\frac{7}{6} + \\frac{2}{9} = \\frac{21+4}{18} = \\frac{25}{18}$。\n所以，$\\alpha_1^{(S)} = \\frac{25/18}{2} = \\frac{25}{36}$。\n\n**计算 S**：\n最后，我们计算总和 $S = \\alpha_1^{(L)} + \\alpha_1^{(R)} + \\alpha_1^{(S)}$。\n$S = \\frac{19}{12} + \\frac{16}{13} + \\frac{25}{36}$。\n首先，合并分母为 $12$ 和 $36$ 的项。最小公倍数是 $36$。\n$\\frac{19}{12} = \\frac{19 \\times 3}{12 \\times 3} = \\frac{57}{36}$。\n$\\frac{19}{12} + \\frac{25}{36} = \\frac{57}{36} + \\frac{25}{36} = \\frac{82}{36} = \\frac{41}{18}$。\n现在，加上剩余的项：\n$S = \\frac{41}{18} + \\frac{16}{13}$。\n$18$ 和 $13$ 的最小公倍数是 $18 \\times 13 = 234$。\n$S = \\frac{41 \\times 13}{18 \\times 13} + \\frac{16 \\times 18}{13 \\times 18} = \\frac{533}{234} + \\frac{288}{234} = \\frac{533 + 288}{234} = \\frac{821}{234}$。\n为确认这是最简分数，我们检查公质因数。分母 $234 = 2 \\times 117 = 2 \\times 9 \\times 13 = 2 \\times 3^2 \\times 13$ 的质因数是 $2$、$3$ 和 $13$。\n- 分子 $821$ 是奇数，不能被 $2$ 整除。\n- $821$ 的各位数字之和是 $8+2+1=11$，不能被 $3$ 整除，所以 $821$ 不能被 $3$ 整除。\n- 除以 $13$：$821 = 13 \\times 63 + 2$。所以 $821$ 不能被 $13$ 整除。\n该分数为最简分数。", "answer": "$$\\boxed{\\frac{821}{234}}$$", "id": "3594301"}]}