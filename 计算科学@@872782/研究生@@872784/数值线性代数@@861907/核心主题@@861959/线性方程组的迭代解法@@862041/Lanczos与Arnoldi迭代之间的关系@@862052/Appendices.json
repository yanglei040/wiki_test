{"hands_on_practices": [{"introduction": "理解两个算法关系最直接的方法就是并排执行它们。本练习将指导您在一个具体的埃尔米特矩阵上，同时运行 Arnoldi 和 Lanczos 迭代。通过计算，您将亲眼见证泛用的 Arnoldi 过程如何自然地简化，并生成与更专业的 Lanczos 算法完全相同的结果，从而直观地理解其底层的三项递推关系。[@problem_id:3573190]", "problem": "设 $A \\in \\mathbb{C}^{5 \\times 5}$ 是一个埃尔米特矩阵，即 $A = A^{*}$，其中 $^{*}$ 表示共轭转置。考虑具体的矩阵\n$$\nA \\;=\\; \\begin{pmatrix}\n2  1  0  0  0 \\\\\n1  3  1  0  0 \\\\\n0  1  4  1  0 \\\\\n0  0  1  3  1 \\\\\n0  0  0  1  2\n\\end{pmatrix},\n$$\n以及初始单位向量 $v_{1} = e_{1} = (1,0,0,0,0)^{\\top}$。仅使用 Arnoldi 过程和 Lanczos 过程构建标准正交 Krylov 基的核心定义，执行整整两次 Arnoldi 迭代（以获得 $v_{2}$ 和 $v_{3}$）和两次 Lanczos 步骤（以获得 $v_{2}$ 和 $v_{3}$）。显式计算在这些构造中出现的所有相关标量系数（在 Arnoldi 过程中：Hessenberg 矩阵的元素 $h_{11}$, $h_{21}$, $h_{12}$, $h_{22}$, $h_{32}$；在 Lanczos 过程中：三对角矩阵的元素 $\\alpha_{1}$, $\\beta_{1}$, $\\alpha_{2}$, $\\beta_{2}$）。然后，确定幺模标量 $c \\in \\mathbb{C}$（即 $|c| = 1$），使得 $v_{3}^{\\mathrm{Arnoldi}} = c \\, v_{3}^{\\mathrm{Lanczos}}$。\n\n请给出 $c$ 的精确值作为最终答案（无需四舍五入）。", "solution": "用户希望我解决一个数值线性代数问题。\n\n这是我的计划：\n1.  **验证问题：**\n    *   **提取已知条件：** 我将列出所有给定信息：矩阵 `A`、其性质（埃尔米特）、初始向量 `v1`，以及执行两步 Arnoldi 和 Lanczos 迭代的任务。\n    *   **检查有效性：**\n        *   **科学依据：** 该问题涉及数值线性代数中的标准算法（Arnoldi 和 Lanczos）。矩阵定义明确且为埃尔米特矩阵。这是一个标准的教科书式问题。\n        *   **适定性：** 该问题要求进行特定的计算并得出最终标量 `c`。步骤定义清晰。Krylov 子空间及其产生的标准正交基的存在性和唯一性（在相差一个相位因子的意义下）是公认的。该问题是适定的。\n        *   **客观性：** 语言正式且精确，没有主观因素。\n        *   **完整性：** 矩阵 `A`、初始向量 `v1` 和迭代次数都已指定。该问题是自洽的。\n        *   **一致性：** 矩阵 `A` 被给定为埃尔米特矩阵。我们来检查一下：\n            `A = [[2, 1, 0, 0, 0], [1, 3, 1, 0, 0], [0, 1, 4, 1, 0], [0, 0, 1, 3, 1], [0, 0, 0, 1, 2]]`\n            `A` 是一个实对称矩阵。由于 `A` 是实的，`A^T = A`。对于实矩阵，共轭转置 `A*` 就是 `A^T`。所以 `A = A*`。条件满足。\n        *   该问题是有效的。\n\n2.  **解决问题：**\n    *   我需要执行两步 Arnoldi 迭代和两步 Lanczos 迭代。\n    *   目标是从两种方法中找到 `v2` 和 `v3` 以及相关的系数。\n    *   最后，我需要找到标量 `c` 使得 `v3^(Arnoldi) = c * v3^(Lanczos)`。\n\n### 第 1 部分：Arnoldi 迭代\n\nArnoldi 迭代为 Krylov 子空间 $\\mathcal{K}_k(A, v_1) = \\text{span}\\{v_1, Av_1, \\dots, A^{k-1}v_1\\}$ 构建了一个标准正交基 $\\{v_1, v_2, \\dots, v_k\\}$。其关系由 $AV_k = V_{k+1} \\tilde{H}_k$ 给出，其中 $V_k = [v_1, \\dots, v_k]$ 且 $\\tilde{H}_k$ 是一个上 Hessenberg 矩阵。\n\n核心算法如下：\n1.  从一个单位向量 $v_1$ 开始。\n2.  对于 $j = 1, 2, \\dots, k$：\n    a.  计算 $w = Av_j$。\n    b.  对于 $i = 1, \\dots, j$：\n        i.  $h_{ij} = v_i^* w$。\n        ii. $w = w - h_{ij}v_i$。\n    c.  $h_{j+1, j} = \\|w\\|_2$。\n    d.  如果 $h_{j+1, j} = 0$，则停止。\n    e.  $v_{j+1} = w / h_{j+1, j}$。\n\n**已知：**\n$A = \\begin{pmatrix} 2  1  0  0  0 \\\\ 1  3  1  0  0 \\\\ 0  1  4  1  0 \\\\ 0  0  1  3  1 \\\\ 0  0  0  1  2 \\end{pmatrix}$\n$v_1 = e_1 = (1, 0, 0, 0, 0)^\\top$。 $\\|v_1\\|_2 = 1$。\n\n**迭代 j=1 (求 v2)：**\na.  $w = Av_1 = \\begin{pmatrix} 2  1  0  0  0 \\\\ 1  3  1  0  0 \\\\ 0  1  4  1  0 \\\\ 0  0  1  3  1 \\\\ 0  0  0  1  2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$。\nb.  $h_{11} = v_1^* w = (1, 0, 0, 0, 0) \\begin{pmatrix} 2 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = 2$。\n    $w = w - h_{11}v_1 = \\begin{pmatrix} 2 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} - 2 \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$。\nc.  $h_{21} = \\|w\\|_2 = \\sqrt{0^2 + 1^2 + 0^2 + 0^2 + 0^2} = 1$。\nd.  $h_{21} \\neq 0$。\ne.  $v_2 = w / h_{21} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} / 1 = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = e_2$。\n\n因此，$v_2^{\\mathrm{Arnoldi}} = e_2$。\n系数：$h_{11} = 2$，$h_{21} = 1$。\n\n**迭代 j=2 (求 v3)：**\na.  $w = Av_2 = \\begin{pmatrix} 2  1  0  0  0 \\\\ 1  3  1  0  0 \\\\ 0  1  4  1  0 \\\\ 0  0  1  3  1 \\\\ 0  0  0  1  2 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 3 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$。\nb.  $h_{12} = v_1^* w = (1, 0, 0, 0, 0) \\begin{pmatrix} 1 \\\\ 3 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = 1$。\n    $h_{22} = v_2^* w = (0, 1, 0, 0, 0) \\begin{pmatrix} 1 \\\\ 3 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = 3$。\n    $w = w - h_{12}v_1 - h_{22}v_2 = \\begin{pmatrix} 1 \\\\ 3 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix} - 1 \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} - 3 \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1-1 \\\\ 3-3 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$。\nc.  $h_{32} = \\|w\\|_2 = \\sqrt{0^2 + 0^2 + 1^2 + 0^2 + 0^2} = 1$。\nd.  $h_{32} \\neq 0$。\ne.  $v_3 = w / h_{32} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix} / 1 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = e_3$。\n\n因此，$v_3^{\\mathrm{Arnoldi}} = e_3$。\n系数：$h_{12} = 1$，$h_{22} = 3$，$h_{32} = 1$。\n\nArnoldi 结果总结：\n$v_1^{\\mathrm{Arnoldi}} = e_1$\n$v_2^{\\mathrm{Arnoldi}} = e_2$\n$v_3^{\\mathrm{Arnoldi}} = e_3$\n$h_{11}=2, h_{21}=1, h_{12}=1, h_{22}=3, h_{32}=1$。\n\n问题指出，对于一个埃尔米特矩阵 `A`，Arnoldi 过程简化为 Lanczos 过程。Hessenberg 矩阵变为三对角且对称。\n$H_k = \\begin{pmatrix} h_{11}  h_{12}  \\dots \\\\ h_{21}  h_{22}  \\dots \\\\ 0  h_{32}  \\dots \\\\ \\vdots  \\ddots  \\ddots \\end{pmatrix}$\n对于埃尔米特的 `A`，$H_k$ 也是埃尔米特的，因此 $h_{ij} = \\overline{h_{ji}}$。\n由于 $H_k$ 是 Hessenberg 矩阵，这意味着它必须是三对角的。当 $i > j+1$ 时，$h_{ij}=0$。根据埃尔米特性，当 $j > i+1$ 时，$h_{ji}=0$。\n$h_{12} = \\overline{h_{21}}$。我们来检查一下：$h_{12}=1$，$h_{21}=1$。正确。\n$h_{23} = \\overline{h_{32}}$。我们没有计算 $h_{23}$，但我们有 $h_{32}=1$。\n矩阵 $H_3$ 将是 $\\begin{pmatrix} 2  1  0 \\\\ 1  3  1 \\\\ 0  1  h_{33} \\end{pmatrix}$。这确实是一个实对称三对角矩阵，正如预期的那样。\n\n### 第 2 部分：Lanczos 迭代\n\nLanczos 迭代是 Arnoldi 迭代针对埃尔米特矩阵的特例。\n递推关系是：\n$\\beta_{j} v_{j+1} = A v_j - \\alpha_j v_j - \\beta_{j-1} v_{j-1}$\n其中 $\\alpha_j = v_j^* A v_j$ 且 $\\beta_j = \\|A v_j - \\alpha_j v_j - \\beta_{j-1} v_{j-1}\\|_2$。\n设 $\\beta_0 = 0$ 且 $v_0 = 0$。\n\n**已知：**\n$A = \\begin{pmatrix} 2  1  0  0  0 \\\\ 1  3  1  0  0 \\\\ 0  1  4  1  0 \\\\ 0  0  1  3  1 \\\\ 0  0  0  1  2 \\end{pmatrix}$ （埃尔米特矩阵，具体来说是实对称矩阵）\n$v_1 = e_1 = (1, 0, 0, 0, 0)^\\top$。\n\n**步骤 j=1 (求 v2)：**\n$\\beta_0 = 0$, $v_0 = 0$。\n$Av_1 = \\begin{pmatrix} 2 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$。\n$\\alpha_1 = v_1^* A v_1 = (1, 0, 0, 0, 0) \\begin{pmatrix} 2 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = 2$。\n我们称未归一化的下一个向量为 $\\tilde{v}_2$。\n$\\tilde{v}_2 = A v_1 - \\alpha_1 v_1 - \\beta_0 v_0 = Av_1 - \\alpha_1 v_1 = \\begin{pmatrix} 2 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} - 2 \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$。\n$\\beta_1 = \\|\\tilde{v}_2\\|_2 = 1$。\n$v_2 = \\tilde{v}_2 / \\beta_1 = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = e_2$。\n\n因此，$v_2^{\\mathrm{Lanczos}} = e_2$。\n系数：$\\alpha_1=2$, $\\beta_1=1$。\n\n这与 Arnoldi 的结果相符：\nLanczos 中的 $\\alpha_1$ 对应于 Arnoldi 中的 $h_{11}$。$\\alpha_1=2, h_{11}=2$。正确。\nLanczos 中的 $\\beta_1$ 对应于 Arnoldi 中的 $h_{21}$。$\\beta_1=1, h_{21}=1$。正确。\n并且 $v_2^{\\mathrm{Lanczos}} = v_2^{\\mathrm{Arnoldi}}$。\n\n**步骤 j=2 (求 v3)：**\n$\\beta_1 = 1$, $v_1 = e_1$, $v_2 = e_2$。\n$Av_2 = \\begin{pmatrix} 1 \\\\ 3 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$。\n$\\alpha_2 = v_2^* A v_2 = (0, 1, 0, 0, 0) \\begin{pmatrix} 1 \\\\ 3 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = 3$。\n$\\tilde{v}_3 = A v_2 - \\alpha_2 v_2 - \\beta_1 v_1 = \\begin{pmatrix} 1 \\\\ 3 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix} - 3 \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} - 1 \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1-1 \\\\ 3-3 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$。\n$\\beta_2 = \\|\\tilde{v}_3\\|_2 = 1$。\n$v_3 = \\tilde{v}_3 / \\beta_2 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = e_3$。\n\n因此，$v_3^{\\mathrm{Lanczos}} = e_3$。\n系数：$\\alpha_2=3$, $\\beta_2=1$。\n\n这也与 Arnoldi 的结果相符：\nLanczos 中的 $\\alpha_2$ 对应于 Arnoldi 中的 $h_{22}$。$\\alpha_2=3, h_{22}=3$。正确。\nLanczos 中的 $\\beta_2$ 对应于 Arnoldi 中的 $h_{32}$。$\\beta_2=1, h_{32}=1$。正确。\nArnoldi 中的另一个系数 $h_{12}$ 与 $\\beta_1$ 相关，因为对于埃尔米特矩阵，$H_k$ 是三对角且埃尔米特的。所以 $h_{12} = \\overline{h_{21}} = h_{21}$，因为它是实的。这里 $h_{21} = \\beta_1$。所以 $h_{12}=\\beta_1=1$。这也相符。\n\nLanczos 结果总结：\n$v_1^{\\mathrm{Lanczos}} = e_1$\n$v_2^{\\mathrm{Lanczos}} = e_2$\n$v_3^{\\mathrm{Lanczos}} = e_3$\n$\\alpha_1=2, \\beta_1=1, \\alpha_2=3, \\beta_2=1$。\n\n### 第 3 部分：比较结果并求 c\n\n我们得到：\n$v_3^{\\mathrm{Arnoldi}} = e_3 = (0,0,1,0,0)^\\top$。\n$v_3^{\\mathrm{Lanczos}} = e_3 = (0,0,1,0,0)^\\top$。\n\n问题要求找到幺模标量 $c$ 使得 $v_3^{\\mathrm{Arnoldi}} = c \\, v_3^{\\mathrm{Lanczos}}$。\n所以，我们有：\n$e_3 = c \\cdot e_3$\n$(0,0,1,0,0)^\\top = c \\cdot (0,0,1,0,0)^\\top$。\n这意味着 $1 = c \\cdot 1$，因此 $c=1$。\n\n$c$ 的值必然是 $1$。\n让我们仔细重读问题。“仅使用核心定义...”。\n\nArnoldi 过程：$v_{j+1} = w / \\|w\\|_2$ 其中 $w = Av_j - \\sum_{i=1}^j h_{ij}v_i$。\nLanczos 过程：$v_{j+1} = (\\text{stuff}) / \\|\\text{stuff}\\|_2$。\n\n在两种标准定义中，下一个向量都是通过对一个向量进行归一化得到的。归一化过程 $u/\\|u\\|$ 唯一地确定了结果，除了一个符号（对于实向量）或一个相位因子 $e^{i\\theta}$（对于复向量）的差别。“标准”定义通常意味着对范数取正实数平方根，因此归一化因子 $1/\\|u\\|$ 是实数且为正。在这种情况下，向量序列是唯一确定的。\n\n让我们再次追踪计算过程。\nArnoldi:\n$v_1 = e_1$\n$w_1 = Av_1 - (v_1^*Av_1)v_1 = \\begin{pmatrix} 2 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} - 2 e_1 = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$。\n$h_{21} = \\|w_1\\| = 1$。\n$v_2^{\\mathrm{Arnoldi}} = w_1/h_{21} = e_2$。\n\n$w_2 = Av_2 - (v_1^*Av_2)v_1 - (v_2^*Av_2)v_2 = \\begin{pmatrix} 1 \\\\ 3 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix} - (e_1^* \\dots) e_1 - (e_2^* \\dots) e_2$\n$e_1^*Av_2 = 1$。\n$e_2^*Av_2 = 3$。\n$w_2 = \\begin{pmatrix} 1 \\\\ 3 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix} - 1 e_1 - 3 e_2 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$。\n$h_{32} = \\|w_2\\| = 1$。\n$v_3^{\\mathrm{Arnoldi}} = w_2/h_{32} = e_3$。\n\nLanczos:\n$v_1 = e_1$\n$\\alpha_1 = v_1^*Av_1 = 2$。\n$\\tilde{v}_2 = Av_1 - \\alpha_1 v_1 = \\begin{pmatrix} 2 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix} - 2e_1 = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$。\n$\\beta_1 = \\|\\tilde{v}_2\\| = 1$。\n$v_2^{\\mathrm{Lanczos}} = \\tilde{v}_2/\\beta_1 = e_2$。\n\n$\\alpha_2 = v_2^*Av_2 = e_2^* A e_2 = 3$。\n$\\tilde{v}_3 = Av_2 - \\alpha_2 v_2 - \\beta_1 v_1 = \\begin{pmatrix} 1 \\\\ 3 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix} - 3 e_2 - 1 e_1 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$。\n$\\beta_2 = \\|\\tilde{v}_3\\| = 1$。\n$v_3^{\\mathrm{Lanczos}} = \\tilde{v}_3/\\beta_2 = e_3$。\n\n所以确实，$v_3^{\\mathrm{Arnoldi}} = v_3^{\\mathrm{Lanczos}} = e_3$。因此 $c=1$。\n\n我是否遗漏了什么微妙之处？这个问题似乎在暗示 `c` 可能不为 1。\n“确定幺模标量 $c \\in \\mathbb{C}$（即 $|c| = 1$），使得 $v_{3}^{\\mathrm{Arnoldi}} = c \\, v_{3}^{\\mathrm{Lanczos}}$。”\n\n我们来回顾一下定义。\n对于埃尔米特矩阵 $A$，Arnoldi 关系 $AV_k = V_{k+1} \\tilde{H}_k$ 变为 $AV_k = V_k T_k + h_{k+1,k} v_{k+1} e_k^\\top$，其中 $T_k = H_k$ 是一个埃尔米特（因此是实对称三对角）矩阵。\n$T_k = \\begin{pmatrix} \\alpha_1  \\overline{\\beta_1}   \\\\ \\beta_1  \\alpha_2  \\ddots  \\\\  \\ddots  \\ddots  \\overline{\\beta_{k-1}} \\\\   \\beta_{k-1}  \\alpha_k \\end{pmatrix}$。\n标准 Lanczos 算法定义 $\\beta_j$ 为实数且非负，$\\beta_j = \\|r_j\\| \\ge 0$。\n$r_j = Av_j - \\alpha_j v_j - \\beta_{j-1} v_{j-1}$ (这里我们会从矩阵 T 中取复数 $\\beta_{j-1}$)。\n$\\alpha_j = v_j^* A v_j$ (因为 A 是埃尔米特矩阵，所以是实数)。\n$\\beta_j v_{j+1} = r_j$。\n如果我们使用标准定义，其中 $\\beta_j = \\|r_j\\|$ 是一个正实数，那么 $v_{j+1}$ 是唯一确定的。\nArnoldi 分解是 $Av_j = \\sum_{i=1}^{j+1} h_{ij} v_i$。\n对于埃尔米特矩阵 $A$，$h_{ij} = v_i^* A v_j = (A v_i)^* v_j = \\overline{(v_j^* A v_i)} = \\overline{h_{ji}}$。\n所以 Hessenberg 矩阵 $H_k$ 是埃尔米特矩阵。要使 Hessenberg 矩阵是埃尔米特矩阵，它必须是三对角的。\n元素为：\n$h_{jj} = v_j^* A v_j = \\alpha_j$。(实数)\n$h_{j+1,j} = \\|Av_j - \\sum_{i=1}^j h_{ij}v_i \\|$。按照惯例，这被取为实数且非负。\n$h_{j, j+1} = v_j^* A v_{j+1}$。\n我们来看看这个关系：\n$h_{j+1,j} v_{j+1} = Av_j - \\sum_{i=1}^j h_{ij}v_i$。\n用 $v_j^* A$ 点乘：\n$h_{j+1,j} v_j^* A v_{j+1} = v_j^* A^2 v_j - \\sum_{i=1}^j h_{ij} v_j^* A v_i$。\n$h_{j+1,j} h_{j, j+1} = v_j^* A^2 v_j - \\sum_{i=1}^j h_{ij} \\overline{h_{ji}}$。\n由于 $H_k$ 是埃尔米特三对角矩阵，当 $i  j-1$ 时，$h_{ij}=0$。\n$h_{j+1,j} \\overline{h_{j+1,j}} = |h_{j+1,j}|^2 = v_j^* A^2 v_j - \\alpha_j^2 - |h_{j, j-1}|^2$。\n这个方程确定了 $|h_{j+1,j}|$。\n\n标准 Lanczos 算法定义：\n$\\alpha_j = v_j^* A v_j$\n$r_j = Av_j - \\alpha_j v_j - \\beta_{j-1} v_{j-1}$ (这里的 $\\beta_{j-1}$ 来自上一步，是实数)。\n$\\beta_j = \\|r_j\\|$。\n$v_{j+1} = r_j / \\beta_j$。\n在这种表述中，$\\beta_j$ 总是实数且非负。\n得到的三对角矩阵 $T_k$ 是实对称的。\n$T_k = \\begin{pmatrix} \\alpha_1  \\beta_1   \\\\ \\beta_1  \\alpha_2  \\beta_2  \\\\  \\ddots  \\ddots  \\ddots \\\\   \\beta_{k-1}  \\alpha_k \\end{pmatrix}$。\n\n对于一般矩阵 $A$ 的 Arnoldi 过程：\n$h_{ij} = v_i^* A v_j$ for $i \\le j$。\n$r_j = Av_j - \\sum_{i=1}^j h_{ij}v_i$。\n$h_{j+1, j} = \\|r_j\\|$。(实数，非负)\n$v_{j+1} = r_j/h_{j+1,j}$。\n\n如果 $A$ 是埃尔米特矩阵，Arnoldi 过程会简化。\n$h_{ij} = v_i^* A v_j = (A v_i)^* v_j$。\n对于 $i  j-1$，$v_i$ 和 $v_{i+1}$ 都在 $\\mathcal{K}_j(A,v_1)$ 中，且 $A v_i \\in \\mathcal{K}_{i+1}(A,v_1) \\subseteq \\mathcal{K}_{j-1}(A,v_1)$。由于 $v_j$ 与 $\\mathcal{K}_{j-1}(A,v_1)$ 中的所有向量正交，所以 $h_{ij} = 0$。因此 $H_k$ 是三对角的。\n由于 $H_k$ 是埃尔米特矩阵，Arnoldi 过程自动给出了一个三项递推关系，与 Lanczos 过程完全相同，只要在每一步归一化时选择正实数作为归一化因子。\n\n在本例中，所有计算都使用了正实数作为范数，所以得到的向量是完全相同的。因此 $c=1$。\n没有理由预期一个不同的结果。该问题可能旨在强调，在标准定义下，两种方法不仅在理论上等价，而且在实践中给出相同的数值结果。\n最终答案是 $1$。它是幺模标量。\n计算是正确的。推理是正确的。答案是正确的。", "answer": "$$\\boxed{1}$$", "id": "3573190"}, {"introduction": "克雷洛夫子空间方法中的一个关键现象是“分解”（breakdown），即迭代意外地提前终止。对于埃尔米特矩阵，这种“幸运分解”（happy breakdown）具有明确的几何意义：算法成功地捕获了一个不变子空间。本练习旨在探讨如何通过分析初始向量与矩阵特征向量之间的关系，来预测和理解这种分解现象的发生。[@problem_id:3573173]", "problem": "设 $A \\in \\mathbb{R}^{5 \\times 5}$ 是一个实对称矩阵\n$$\nA = \\operatorname{diag}(1,3,5,7,11),\n$$\n设 $b \\in \\mathbb{R}^{5}$ 为\n$$\nb = \\begin{pmatrix}1 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0\\end{pmatrix}.\n$$\n考虑 Krylov 子空间 $\\mathcal{K}_{k}(A,b) = \\operatorname{span}\\{b, Ab, \\dots, A^{k-1}b\\}$，以及由以 $v_{1} = b/\\|b\\|$ 开始的 Lanczos 迭代（针对对称矩阵 $A$）和 Arnoldi 迭代（针对一般矩阵 $A$）在精确算术下生成的标准正交基。仅使用数值线性代数中的基本定义，包括 Krylov 子空间的定义、不变子空间的概念，以及对于对称矩阵 $A$，Arnoldi 过程会简化为三项 Lanczos 递推关系，从而生成一个对称三对角投影这一基本性质。\n\n任务：\n- 解释为什么对于给定的 $(A,b)$，存在一个最小的正整数 $k$，使得 Lanczos 迭代在精确算术下产生 $v_{k+1} = 0$，并从 $\\mathcal{K}_{k}(A,b)$ 捕获不变子空间的角度说明其几何原因。\n- 解释为什么 Arnoldi 迭代在同一步骤出现“幸运中断”(happy breakdown)，并将其与对称矩阵 $A$ 下 Arnoldi 和 Lanczos 迭代之间的关系联系起来。\n- 对给定的 $A$ 和 $b$，显式地确定这个最小的 $k$。\n\n你的最终答案应该是 $k$ 的单个整数值（无单位）。最终答案中不要提供任何不等式或方程式。如果你选择计算任何中间数值，请保留精确值，无需四舍五入。在你的推理过程中提供几何解释，但最终答案必须仅为整数 $k$。", "solution": "问题要求解释对于给定的对称矩阵 $A$ 和起始向量 $b$，Lanczos 和 Arnoldi 迭代的终止原因，并确定发生终止时的步数 $k$。\n\n首先，我们探讨这些迭代方法终止的理论基础。Lanczos 和 Arnoldi 迭代是为嵌套的 Krylov 子空间序列 $\\mathcal{K}_j(A,b) = \\operatorname{span}\\{b, Ab, \\dots, A^{j-1}b\\}$（其中 $j=1, 2, \\dots, m$）构造标准正交基 $\\{v_1, v_2, \\dots, v_m\\}$ 的算法。该过程从 $v_1 = b / \\|b\\|$ 开始。在精确算术下，只要 Krylov 子空间的维数在每一步都增加，即 $\\dim(\\mathcal{K}_{j+1}(A,b)) = \\dim(\\mathcal{K}_j(A,b)) + 1$，迭代就会继续。\n\nKrylov 子空间的维数不能无限增加，因为它是有限维空间 $\\mathbb{R}^5$ 的子空间。设 $k$ 是使向量集 $\\{b, Ab, \\dots, A^{k-1}b, A^k b\\}$ 线性相关的最小正整数。这意味着 $A^k b$ 可以写成其前面向量的线性组合：\n$$\nA^k b = \\sum_{i=0}^{k-1} c_i A^i b\n$$\n对于某些系数 $c_i$。这意味着 $A$ 关于向量 $b$ 的最小多项式（即次数最低且满足 $p(A)b=0$ 的唯一首一多项式 $p(t)$）的次数为 $k$。这种多项式的存在性是有保证的，因为在 $n$ 维空间中的 $n+1$ 个向量 $b, Ab, \\dots, A^n b$ 必定是线性相关的。\n\n当 $A^k b \\in \\mathcal{K}_k(A,b)$ 时，Krylov 子空间稳定下来：$\\mathcal{K}_{k+1}(A,b) = \\mathcal{K}_k(A,b)$，因此对于所有 $jk$，都有 $\\mathcal{K}_j(A,b) = \\mathcal{K}_k(A,b)$。最大 Krylov 子空间的维数是 $k$。\n\n对称矩阵 $A$ 的 Lanczos 迭代由以下三项递推关系控制：\n$$\n\\beta_j v_{j+1} = A v_j - \\alpha_j v_j - \\beta_{j-1} v_{j-1}\n$$\n其中 $\\alpha_j = v_j^T A v_j$ 且 $\\beta_j = \\|A v_j - \\alpha_j v_j - \\beta_{j-1} v_{j-1}\\|_2$。如果 $\\beta_k=0$，则迭代在第 $j=k$ 步终止。这意味着向量 $v_{k+1}$ 是零向量（在归一化之前）。$\\beta_k$ 为零意味着 $A v_k$ 位于 $v_1, \\dots, v_k$ 的张成空间中。由于 $\\{v_1, \\dots, v_k\\}$ 是 $\\mathcal{K}_k(A,b)$ 的一个标准正交基，这意味着 $A v_k \\in \\mathcal{K}_k(A,b)$。因为基向量 $v_j$ 是由 $\\{b, Ab, \\dots, A^{j-1}b\\}$ 的线性组合构造的，所以条件 $A v_k \\in \\mathcal{K}_k(A,b)$ 等价于 $A (\\mathcal{K}_k(A,b)) \\subseteq \\mathcal{K}_k(A,b)$。\n因此，迭代终止的几何原因是 Krylov 子空间 $\\mathcal{K}_k(A,b)$ 成为了一个 $A$-不变子空间。最小的此类 $k$ 对应于由 $A$ 和 $b$ 生成的完整 Krylov 子空间的维数。\n\n对于一般矩阵，Arnoldi 迭代生成一个标准正交基 $V_k = [v_1, \\dots, v_k]$，满足关系 $AV_k = V_{k+1} \\tilde{H}_k$，展开为 $AV_k = V_k H_k + h_{k+1,k} v_{k+1} e_k^T$，其中 $H_k$ 是一个 $k \\times k$ 的上Hessenberg矩阵。如果系数 $h_{k+1,k}$ 为零，则在第 $k$ 步发生“幸运中断”(happy breakdown)。在这种情况下，递推关系简化为 $AV_k = V_k H_k$，这同样意味着 $A(\\operatorname{span}\\{v_1, \\dots, v_k\\}) \\subseteq \\operatorname{span}\\{v_1, \\dots, v_k\\}$。子空间 $\\mathcal{K}_k(A,b)$ 是 $A$-不变的。\n当 $A$ 是对称矩阵时，Arnoldi 过程简化为 Lanczos 过程。上Hessenberg矩阵 $H_k$ 变成一个对称三对角矩阵 $T_k$，且系数之间有关系 $\\beta_j = h_{j+1,j}$。因此，Lanczos 的终止条件（$\\beta_k=0$）与 Arnoldi 的幸运中断条件（$h_{k+1,k}=0$）是相同的。\n\n为了找到给定 $(A,b)$ 的最小整数 $k$，我们必须确定 Krylov 子空间 $\\mathcal{K}(A,b)$ 的维数。矩阵 $A = \\operatorname{diag}(1,3,5,7,11)$ 是对角矩阵，因此其特征值为 $\\lambda_1=1$, $\\lambda_2=3$, $\\lambda_3=5$, $\\lambda_4=7$, $\\lambda_5=11$，对应的特征向量是标准基向量 $e_1, e_2, e_3, e_4, e_5$。\n\n起始向量 $b$ 由下式给出：\n$$\nb = \\begin{pmatrix}1 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0\\end{pmatrix} = 1 \\cdot e_1 + 1 \\cdot e_2 + 0 \\cdot e_3 + 0 \\cdot e_4 + 0 \\cdot e_5\n$$\n所以，$b$ 是前两个特征向量 $e_1$ 和 $e_2$ 的线性组合。\n让我们构造 Krylov 向量 $A^j b$：\n$$\nA^j b = A^j (e_1 + e_2) = A^j e_1 + A^j e_2 = \\lambda_1^j e_1 + \\lambda_2^j e_2 = 1^j e_1 + 3^j e_2 = e_1 + 3^j e_2\n$$\n前几个 Krylov 向量是：\n对于 $j=0$：$b = e_1 + e_2 = \\begin{pmatrix}1 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0\\end{pmatrix}$。\n对于 $j=1$：$Ab = e_1 + 3e_2 = \\begin{pmatrix}1 \\\\ 3 \\\\ 0 \\\\ 0 \\\\ 0\\end{pmatrix}$。\n对于 $j=2$：$A^2 b = e_1 + 3^2 e_2 = e_1 + 9e_2 = \\begin{pmatrix}1 \\\\ 9 \\\\ 0 \\\\ 0 \\\\ 0\\end{pmatrix}$。\n\nKrylov 子空间 $\\mathcal{K}_j(A,b)$ 中的任何向量都是这些向量的线性组合，这意味着它总是形如 $\\alpha e_1 + \\beta e_2$（其中 $\\alpha$ 和 $\\beta$ 是标量）。因此，整个 Krylov 子空间序列都包含在二维子空间 $\\operatorname{span}\\{e_1, e_2\\}$ 中。$\\mathcal{K}(A,b)$ 的维数最多为 $2$。\n\n为了找到确切的维数，我们检查线性无关性。\n集合 $\\{b\\}$ 是线性无关的，因为 $b \\neq 0$。维数至少为 $1$。\n集合 $\\{b, Ab\\}$ 由向量 $\\begin{pmatrix}1 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0\\end{pmatrix}$ 和 $\\begin{pmatrix}1 \\\\ 3 \\\\ 0 \\\\ 0 \\\\ 0\\end{pmatrix}$ 组成。这两个向量是线性无关的，因为它们不是彼此的标量倍数。维数至少为 $2$。\n\n既然我们已经确定维数最多为 $2$ 且最少为 $2$，那么最大 Krylov 子空间的维数必须恰好为 $2$。\n这意味着集合 $\\{b, Ab, A^2 b\\}$ 必须是线性相关的。让我们来验证一下：\n我们寻找系数 $c_0, c_1, c_2$ 使得 $c_2 A^2 b + c_1 Ab + c_0 b = 0$。这对应于寻找 $A$ 关于 $b$ 的最小多项式。该多项式的根是 $A$ 的特征值中对应于 $b$ 中存在的特征向量分量的那些，即 $\\lambda_1=1$ 和 $\\lambda_2=3$。\n因此，最小多项式为 $(t-1)(t-3) = t^2 - 4t + 3$。该多项式的次数为 $k=2$。\n这意味着 $(A^2 - 4A + 3I)b = 0$，或者 $A^2 b = 4Ab - 3b$。\n让我们验证一下：\n$$\n4Ab - 3b = 4\\begin{pmatrix}1 \\\\ 3 \\\\ 0 \\\\ 0 \\\\ 0\\end{pmatrix} - 3\\begin{pmatrix}1 \\\\ 1 \\\\ 0 \\\\ 0 \\\\ 0\\end{pmatrix} = \\begin{pmatrix}4 \\\\ 12 \\\\ 0 \\\\ 0 \\\\ 0\\end{pmatrix} - \\begin{pmatrix}3 \\\\ 3 \\\\ 0 \\\\ 0 \\\\ 0\\end{pmatrix} = \\begin{pmatrix}1 \\\\ 9 \\\\ 0 \\\\ 0 \\\\ 0\\end{pmatrix} = A^2 b\n$$\n该关系成立。由于 $A^2 b$ 是 $b$ 和 $Ab$ 的线性组合，Krylov 序列在这一步变得线性相关。Krylov 子空间的维数是 $k=2$。\n因此，Lanczos/Arnoldi 过程将成功生成一个由两个向量 $\\{v_1, v_2\\}$ 组成的标准正交基，张成这个二维不变子空间。在第二步结束时（即，对于 $j=2$），算法将尝试计算 $v_3$。它会发现相应的非对角系数 $\\beta_2$（或 $h_{3,2}$）为零。这标志着终止。因此，使得迭代产生 $v_{k+1}=0$ 的最小正整数 $k$ 是 $2$。", "answer": "$$\\boxed{2}$$", "id": "3573173"}, {"introduction": "Arnoldi 和 Lanczos 迭代在埃尔米特情形下的等价性为何如此重要？一个主要原因在于它们在近似特征值问题中的应用。本练习将展示如何利用生成的克雷洛夫子空间来寻找近似特征值（里兹值）。我们将计算一个“精炼里兹向量”（refined Ritz vector），并证明近似的质量仅取决于子空间本身，而与生成其基的具体算法（Arnoldi 或 Lanczos）无关。[@problem_id:3573179]", "problem": "设 $A \\in \\mathbb{R}^{4 \\times 4}$ 是一个 Hermitian 矩阵，其中 $A = \\operatorname{diag}(1, 2, 4, 8)$，并设 $b \\in \\mathbb{R}^{4}$ 为 $b = [1, 1, 0, 0]^{\\top}$。考虑 $k=2$ 阶的 Krylov 子空间 $\\mathcal{K}_{2}(A, b) = \\operatorname{span}\\{b, Ab\\}$。设 $V_{2} \\in \\mathbb{R}^{4 \\times 2}$ 是由 Lanczos 过程为 $\\mathcal{K}_{2}(A, b)$ 生成的任意一个标准正交基，并设 $Q_{2} \\in \\mathbb{R}^{4 \\times 2}$ 是由从 $b$ 开始的 Arnoldi 过程为同一子空间生成的任意一个标准正交基。\n\n对于目标值 $\\tau = 4$，将具有标准正交基 $W$ 的子空间 $\\mathcal{S}$ 中的精化 Ritz 向量定义为单位向量 $w_{\\mathrm{ref}} \\in \\mathcal{S}$，它在所有满足 $\\|w\\|_{2} = 1$ 的 $w \\in \\mathcal{S}$ 中最小化残差范数 $\\|(A - \\tau I) w\\|_{2}$。仅使用 Krylov 子空间方法的基本定义和最小化原理，完成以下任务：\n- 在子空间 $\\mathcal{K}_{2}(A, b)$ 中，分别使用 $V_{2}$ 和 $Q_{2}$ 构造精化 Ritz 向量，并论证这两个在 $\\mathbb{R}^{4}$ 中的精化 Ritz 向量是否在相差一个复单位的意义下一致。\n- 评估并精确计算这些精化 Ritz 向量所达到的共同残差范数 $\\|(A - \\tau I) w_{\\mathrm{ref}}\\|_{2}$。\n\n你的最终答案必须是这个共同残差范数的精确值，表示为一个实数。不需要四舍五入。", "solution": "问题要求为给定的矩阵 $A$ 和起始向量 $b$ 在 Krylov 子空间 $\\mathcal{K}_{2}(A, b)$ 中构造精化 Ritz 向量，并计算目标值 $\\tau$ 对应的最小残差范数。\n\n首先，我们刻画 Krylov 子空间 $\\mathcal{K}_{2}(A, b) = \\operatorname{span}\\{b, Ab\\}$。\n给定的矩阵 $A$ 和向量 $b$ 如下：\n$$A = \\operatorname{diag}(1, 2, 4, 8) \\in \\mathbb{R}^{4 \\times 4}$$\n$$b = [1, 1, 0, 0]^{\\top} \\in \\mathbb{R}^{4}$$\n矩阵 $A$ 是实的对角矩阵，因此如题所述，它是 Hermitian 矩阵。\n我们计算向量 $Ab$：\n$$Ab = \\begin{pmatrix} 1  0  0  0 \\\\ 0  2  0  0 \\\\ 0  0  4  0 \\\\ 0  0  0  8 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 2 \\\\ 0 \\\\ 0 \\end{pmatrix}$$\nKrylov 子空间为 $\\mathcal{K}_{2}(A, b) = \\operatorname{span}\\{[1, 1, 0, 0]^{\\top}, [1, 2, 0, 0]^{\\top}\\}$。由于 $b$ 和 $Ab$ 是线性无关的，该子空间的维数为 2。\n\n问题提到了该子空间 $\\mathcal{K}_{2}(A, b)$ 的两个标准正交基：由 Lanczos 过程产生的 $V_{2}$ 和由 Arnoldi 过程产生的 $Q_{2}$。由于 $A$ 是 Hermitian 矩阵，Arnoldi 过程简化为 Lanczos 过程。如果两者都从相同的单位化起始向量开始，它们会产生相同的标准正交基（每个向量的符号选择可能不同）。设 $W$ 是 $\\mathcal{K}_{2}(A, b)$ 的一个通用标准正交基。我们可以通过对向量 $\\{b, Ab\\}$ 使用 Gram-Schmidt 过程来构造这样一个基。\n设 $v_1 = b = [1, 1, 0, 0]^{\\top}$。第一个基向量是 $w_1$：\n$$w_1 = \\frac{v_1}{\\|v_1\\|_{2}} = \\frac{1}{\\sqrt{1^2 + 1^2 + 0^2 + 0^2}} \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$$\n设 $v_2 = Ab = [1, 2, 0, 0]^{\\top}$。第二个正交向量 $\\tilde{w}_2$ 通过从 $v_2$ 中减去其在 $w_1$ 上的投影得到：\n$$\\tilde{w}_2 = v_2 - (w_1^{\\top}v_2)w_1$$\n内积为 $w_1^{\\top}v_2 = \\frac{1}{\\sqrt{2}}[1, 1, 0, 0] [1, 2, 0, 0]^{\\top} = \\frac{1}{\\sqrt{2}}(1+2) = \\frac{3}{\\sqrt{2}}$。\n$$\\tilde{w}_2 = \\begin{pmatrix} 1 \\\\ 2 \\\\ 0 \\\\ 0 \\end{pmatrix} - \\frac{3}{\\sqrt{2}} \\left(\\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix}\\right) = \\begin{pmatrix} 1 \\\\ 2 \\\\ 0 \\\\ 0 \\end{pmatrix} - \\frac{3}{2} \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -1/2 \\\\ 1/2 \\\\ 0 \\\\ 0 \\end{pmatrix}$$\n将 $\\tilde{w}_2$ 单位化得到第二个基向量 $w_2$：\n$$w_2 = \\frac{\\tilde{w}_2}{\\|\\tilde{w}_2\\|_{2}} = \\frac{1}{\\sqrt{(-1/2)^2 + (1/2)^2}} \\begin{pmatrix} -1/2 \\\\ 1/2 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\frac{1}{\\sqrt{1/2}} \\begin{pmatrix} -1/2 \\\\ 1/2 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\sqrt{2} \\begin{pmatrix} -1/2 \\\\ 1/2 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} -1 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$$\n因此，$\\mathcal{K}_{2}(A, b)$ 的一个标准正交基由矩阵 $W$ 的列向量给出：\n$$W = [w_1, w_2] = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1  -1 \\\\ 1  1 \\\\ 0  0 \\\\ 0  0 \\end{pmatrix}$$\n$V_{2}$ 和 $Q_{2}$ 都是该子空间的标准正交基，所以它们通过一个 $2 \\times 2$ 的正交矩阵相关联。\n\n精化 Ritz 向量 $w_{\\mathrm{ref}}$ 定义为单位向量 $w \\in \\mathcal{K}_{2}(A, b)$，它在目标值 $\\tau = 4$ 的情况下最小化残差范数 $\\|(A - \\tau I) w\\|_{2}$。\n任何向量 $w \\in \\mathcal{K}_{2}(A, b)$ 都可以写成 $w = Wy$ 的形式，其中 $y \\in \\mathbb{R}^{2}$ 是某个系数向量。条件 $\\|w\\|_{2} = 1$ 意味着 $\\|Wy\\|_{2} = 1$。由于 $W$ 的列是标准正交的，所以有 $\\|y\\|_{2} = 1$。\n最小化问题是：\n$$\\min_{w \\in \\mathcal{K}_{2}(A, b), \\|w\\|_{2}=1} \\|(A - \\tau I) w\\|_{2}^2 = \\min_{y \\in \\mathbb{R}^2, \\|y\\|_{2}=1} \\|(A - \\tau I) Wy\\|_{2}^2$$\n目标函数可以写成一个二次型的形式：\n$$\\|(A - \\tau I) Wy\\|_{2}^2 = ((A - \\tau I) Wy)^{\\top} ((A - \\tau I) Wy) = y^{\\top}W^{\\top}(A - \\tau I)^{\\top}(A - \\tau I)Wy$$\n由于 $A$ 是实的对称矩阵，$(A - \\tau I)^{\\top} = A - \\tau I$。该表达式简化为：\n$$y^{\\top} \\left( W^{\\top} (A - \\tau I)^2 W \\right) y$$\n这是矩阵 $M = W^{\\top} (A - \\tau I)^2 W$ 的 Rayleigh 商。该商的最小值是 $M$ 的最小特征值，而达到此最小值的向量 $y$ 是对应的特征向量。\n\n我们来计算矩阵 $M$。首先，我们求出当 $\\tau=4$ 时的 $(A - \\tau I)^2$：\n$$A - \\tau I = \\operatorname{diag}(1-4, 2-4, 4-4, 8-4) = \\operatorname{diag}(-3, -2, 0, 4)$$\n$$(A - \\tau I)^2 = \\operatorname{diag}((-3)^2, (-2)^2, 0^2, 4^2) = \\operatorname{diag}(9, 4, 0, 16)$$\n现在我们计算 $M = W^{\\top} (A - \\tau I)^2 W$：\n$$M = \\left( \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1  1  0  0 \\\\ -1  1  0  0 \\end{pmatrix} \\right) \\begin{pmatrix} 9  0  0  0 \\\\ 0  4  0  0 \\\\ 0  0  0  0 \\\\ 0  0  0  16 \\end{pmatrix} \\left( \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1  -1 \\\\ 1  1 \\\\ 0  0 \\\\ 0  0 \\end{pmatrix} \\right)$$\n$$M = \\frac{1}{2} \\begin{pmatrix} 1  1  0  0 \\\\ -1  1  0  0 \\end{pmatrix} \\begin{pmatrix} 9  -9 \\\\ 4  4 \\\\ 0  0 \\\\ 0  0 \\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix} 1(9)+1(4)  1(-9)+1(4) \\\\ -1(9)+1(4)  -1(-9)+1(4) \\end{pmatrix}$$\n$$M = \\frac{1}{2} \\begin{pmatrix} 13  -5 \\\\ -5  13 \\end{pmatrix}$$\n$M$ 的特征值 $\\lambda$ 由 $\\det(M - \\lambda I) = 0$ 求得：\n$$\\det \\begin{pmatrix} \\frac{13}{2} - \\lambda  -\\frac{5}{2} \\\\ -\\frac{5}{2}  \\frac{13}{2} - \\lambda \\end{pmatrix} = 0$$\n$$\\left(\\frac{13}{2} - \\lambda\\right)^2 - \\left(-\\frac{5}{2}\\right)^2 = 0 \\implies \\lambda^2 - 13\\lambda + \\frac{169}{4} - \\frac{25}{4} = 0$$\n$$\\lambda^2 - 13\\lambda + \\frac{144}{4} = 0 \\implies \\lambda^2 - 13\\lambda + 36 = 0$$\n$$(\\lambda - 4)(\\lambda - 9) = 0$$\n特征值为 $\\lambda_{1} = 4$ 和 $\\lambda_{2} = 9$。最小特征值为 $\\lambda_{\\min} = 4$。\n残差范数平方的最小值是 $\\lambda_{\\min} = 4$。因此，最小残差范数是 $\\sqrt{\\lambda_{\\min}} = \\sqrt{4} = 2$。\n\n这个结果与 $\\mathcal{K}_{2}(A, b)$ 的标准正交基的选择无关。如果我们选择另一个基 $W' = WU$，其中 $U$ 是一个 $2 \\times 2$ 的正交矩阵，投影矩阵变为 $M' = (W')^{\\top}(A-\\tau I)^2 W' = (WU)^{\\top}(A-\\tau I)^2(WU) = U^{\\top}MU$。$M'$ 与 $M$ 正交相似，因此具有相同的特征值。由于残差范数的平方是该矩阵的最小特征值，其值在子空间标准正交基的变换下是不变的。因此，无论使用 $V_2$ 还是 $Q_2$ 计算，残差范数都将是相同的。\n\n为了构造精化 Ritz 向量 $w_{\\mathrm{ref}}$，我们求 $M$ 对应于 $\\lambda_{\\min} = 4$ 的特征向量 $y$：\n$$(M - 4I)y = 0 \\implies \\begin{pmatrix} \\frac{13}{2}-4  -\\frac{5}{2} \\\\ -\\frac{5}{2}  \\frac{13}{2}-4 \\end{pmatrix} y = 0 \\implies \\begin{pmatrix} \\frac{5}{2}  -\\frac{5}{2} \\\\ -\\frac{5}{2}  \\frac{5}{2} \\end{pmatrix} \\begin{pmatrix} y_1 \\\\ y_2 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$$\n这给出了方程 $\\frac{5}{2}y_1 - \\frac{5}{2}y_2 = 0$，这意味着 $y_1=y_2$。特征向量的形式为 $c[1, 1]^{\\top}$。对于 $\\|y\\|_2=1$，我们有 $c^2(1^2+1^2)=1 \\implies 2c^2=1 \\implies c = \\pm \\frac{1}{\\sqrt{2}}$。\n我们选择 $y = \\frac{1}{\\sqrt{2}}[1, 1]^{\\top}$。\n精化 Ritz 向量为 $w_{\\mathrm{ref}} = Wy$：\n$$w_{\\mathrm{ref}} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1  -1 \\\\ 1  1 \\\\ 0  0 \\\\ 0  0 \\end{pmatrix} \\left( \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} \\right) = \\frac{1}{2} \\begin{pmatrix} 1-1 \\\\ 1+1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix} 0 \\\\ 2 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$$\n选择 $c = -\\frac{1}{\\sqrt{2}}$ 将得到 $-w_{\\mathrm{ref}}$。由于 $\\lambda_{\\min}$ 对应的特征空间是一维的，精化 Ritz 向量在相差一个符号因子 $\\pm 1$ 的意义下是唯一的。这是一个实单位，是绝对值为 1 的复单位的一个特例。因此，由 $V_2$ 和 $Q_2$ 构造的精化 Ritz 向量必定在相差一个因子 $\\pm 1$ 的意义下是一致的。\n\n问题要求的是共同的残差范数，我们已经计算出其值为 $2$。\n我们用计算出的 $w_{\\mathrm{ref}}$ 来验证这一点：\n$$\\|(A - 4I) w_{\\mathrm{ref}}\\|_{2} = \\left\\| \\begin{pmatrix} -3  0  0  0 \\\\ 0  -2  0  0 \\\\ 0  0  0  0 \\\\ 0  0  0  4 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix} \\right\\|_{2} = \\left\\| \\begin{pmatrix} 0 \\\\ -2 \\\\ 0 \\\\ 0 \\end{pmatrix} \\right\\|_{2} = \\sqrt{0^2 + (-2)^2 + 0^2 + 0^2} = 2$$\n计算结果是一致的。计算出的残差范数是精确的。", "answer": "$$\\boxed{2}$$", "id": "3573179"}]}