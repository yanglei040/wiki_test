{"hands_on_practices": [{"introduction": "要真正掌握双共轭梯度稳定（BiCGSTAB）方法，最有效的方式莫过于亲手完成一次完整的迭代计算。这个练习将引导你为一个简单的 $2 \\times 2$ 线性系统具体计算第一步迭代中涉及的所有关键量。通过这个过程，你将清晰地看到算法中双共轭梯度部分的投影步骤和稳定化部分的最小化步骤是如何协同工作的。[@problem_id:3585874]", "problem": "考虑线性系统 $A x = b$，其中 $A \\in \\mathbb{R}^{n \\times n}$ 是非奇异矩阵。克雷洛夫子空间方法通过根据彼得罗夫-伽辽金条件和在低维子空间中进行残差最小化等原则对残差 $r_{k} = b - A x_{k}$ 进行投影来构造近似解 $x_{k}$。稳定双共轭梯度方法 (BiCGSTAB) 是通过将双共轭梯度 (BiCG) 方法的双正交投影特性与一个局部最小残差稳定化步骤相结合而得到的。\n\n从以下经过充分检验的原则出发：\n- 欧几里得内积为 $\\langle u, v \\rangle = u^{\\top} v$，欧几里得范数 (2-范数)为 $\\|u\\|_{2} = \\sqrt{\\langle u, u \\rangle}$。\n- 对于通过搜索方向更新得到的中间残差，一个带有固定非零“影子残差” $\\tilde r$ 的彼得罗夫-伽辽金投影强制要求 $\\langle \\tilde r, r_{k+1} \\rangle = 0$。\n- 给定一个非零的中间残差 $s_{k}$，在 $\\omega \\in \\mathbb{R}$ 上最小化 $\\|s_{k} - \\omega A s_{k}\\|_{2}$ 的标量 $\\omega_{k}$ 由最小二乘问题产生的正规方程确定。\n\n使用这些原则，对以下具体数据执行一次完整的稳定双共轭梯度 (BiCGSTAB) 方法迭代：\n$$\nA = \\begin{bmatrix}2  -1 \\\\ 1  3\\end{bmatrix}, \\quad\nb = \\begin{bmatrix}1 \\\\ 0\\end{bmatrix}, \\quad\nx_{0} = \\begin{bmatrix}0 \\\\ 0\\end{bmatrix}, \\quad\n\\tilde r = r_{0},\n$$\n并采用标准初始化 $r_{0} = b - A x_{0}$ 和 $p_{0} = r_{0}$。数值计算出标量和向量\n$$\n\\rho_{0}, \\ \\alpha_{0}, \\ s_{0}, \\ \\omega_{0}, \\ x_{1}, \\ r_{1}, \\ p_{1}.\n$$\n\n答案规格：\n- 使用标准欧几里得内积 $\\langle u, v \\rangle = u^{\\top} v$。\n- 作为您最终报告的量，提供单个标量值 $\\|r_{1}\\|_{2}^{2}$，结果应为最简形式的精确有理数。\n- 不要四舍五入；由于要求的是精确有理数答案，因此不需要有效数字的说明。", "solution": "任务是为给定的线性系统 $A x = b$ 执行一次完整的 BiCGSTAB 方法迭代。该算法由一系列定义明确的步骤组成。我们从索引 $k=0$ 开始。\n\n**第0步：初始化**\n\n解的初始猜测值给出为 $x_{0} = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}$。\n初始残差 $r_{0}$ 计算为 $r_{0} = b - A x_{0}$。\n给定 $A = \\begin{bmatrix} 2  -1 \\\\ 1  3 \\end{bmatrix}$ 和 $b = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}$：\n$A x_{0} = \\begin{bmatrix} 2  -1 \\\\ 1  3 \\end{bmatrix} \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}$。\n因此，$r_{0} = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} - \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}$。\n\n问题指定初始“影子残差”为 $\\tilde{r}_{0} = r_{0}$，所以 $\\tilde{r}_{0} = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}$。\n初始搜索方向为 $p_{0} = r_{0}$，所以 $p_{0} = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}$。\n\n**迭代 $k=0$**\n\n1.  **计算 $\\rho_{0}$:**\n    标量 $\\rho_{0}$ 由内积 $\\rho_{0} = \\langle \\tilde{r}_{0}, r_{0} \\rangle$ 定义。\n    使用欧几里得内积 $\\langle u, v \\rangle = u^{\\top} v$：\n    $\\rho_{0} = r_{0}^{\\top} r_{0} = \\begin{bmatrix} 1  0 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} = (1)(1) + (0)(0) = 1$。\n\n2.  **计算 $v_{0} = A p_{0}$:**\n    $v_{0} = \\begin{bmatrix} 2  -1 \\\\ 1  3 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} (2)(1) + (-1)(0) \\\\ (1)(1) + (3)(0) \\end{bmatrix} = \\begin{bmatrix} 2 \\\\ 1 \\end{bmatrix}$。\n\n3.  **计算 $\\alpha_{0}$:**\n    标量 $\\alpha_{0}$ 源自于对中间更新的彼得罗夫-伽辽金条件，该条件给出 $\\alpha_{0} = \\frac{\\rho_{0}}{\\langle \\tilde{r}_{0}, v_{0} \\rangle}$。\n    分母中的内积是：\n    $\\langle \\tilde{r}_{0}, v_{0} \\rangle = \\tilde{r}_{0}^{\\top} v_{0} = \\begin{bmatrix} 1  0 \\end{bmatrix} \\begin{bmatrix} 2 \\\\ 1 \\end{bmatrix} = (1)(2) + (0)(1) = 2$。\n    因此，$\\alpha_{0} = \\frac{1}{2}$。\n\n4.  **计算中间残差 $s_{0}$:**\n    $s_{0} = r_{0} - \\alpha_{0} v_{0}$。\n    $s_{0} = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} - \\frac{1}{2} \\begin{bmatrix} 2 \\\\ 1 \\end{bmatrix} = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} - \\begin{bmatrix} 1 \\\\ 1/2 \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ -1/2 \\end{bmatrix}$。\n\n5.  **计算 $t_{0} = A s_{0}$:**\n    $t_{0} = \\begin{bmatrix} 2  -1 \\\\ 1  3 \\end{bmatrix} \\begin{bmatrix} 0 \\\\ -1/2 \\end{bmatrix} = \\begin{bmatrix} (2)(0) + (-1)(-1/2) \\\\ (1)(0) + (3)(-1/2) \\end{bmatrix} = \\begin{bmatrix} 1/2 \\\\ -3/2 \\end{bmatrix}$。\n\n6.  **计算 $\\omega_{0}$:**\n    选择标量 $\\omega_{0}$ 以最小化 $\\|s_{0} - \\omega A s_{0}\\|_{2}$，这等价于最小化 $\\|s_{0} - \\omega t_{0}\\|_{2}$。该最小二乘问题的解由正规方程给出，从而得到 $\\omega_{0} = \\frac{\\langle s_{0}, t_{0} \\rangle}{\\langle t_{0}, t_{0} \\rangle}$。\n    首先，我们计算所需的内积：\n    $\\langle s_{0}, t_{0} \\rangle = s_{0}^{\\top} t_{0} = \\begin{bmatrix} 0  -1/2 \\end{bmatrix} \\begin{bmatrix} 1/2 \\\\ -3/2 \\end{bmatrix} = (0)(1/2) + (-1/2)(-3/2) = \\frac{3}{4}$。\n    $\\langle t_{0}, t_{0} \\rangle = t_{0}^{\\top} t_{0} = \\begin{bmatrix} 1/2  -3/2 \\end{bmatrix} \\begin{bmatrix} 1/2 \\\\ -3/2 \\end{bmatrix} = (\\frac{1}{2})^{2} + (-\\frac{3}{2})^{2} = \\frac{1}{4} + \\frac{9}{4} = \\frac{10}{4} = \\frac{5}{2}$。\n    因此，$\\omega_{0} = \\frac{3/4}{5/2} = \\frac{3}{4} \\cdot \\frac{2}{5} = \\frac{6}{20} = \\frac{3}{10}$。\n\n7.  **更新解以得到 $x_{1}$:**\n    $x_{1} = x_{0} + \\alpha_{0} p_{0} + \\omega_{0} s_{0}$。\n    $x_{1} = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix} + \\frac{1}{2} \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} + \\frac{3}{10} \\begin{bmatrix} 0 \\\\ -1/2 \\end{bmatrix} = \\begin{bmatrix} 1/2 \\\\ 0 \\end{bmatrix} + \\begin{bmatrix} 0 \\\\ -3/20 \\end{bmatrix} = \\begin{bmatrix} 1/2 \\\\ -3/20 \\end{bmatrix}$。\n\n8.  **更新残差以得到 $r_{1}$:**\n    $r_{1} = s_{0} - \\omega_{0} t_{0}$。\n    $r_{1} = \\begin{bmatrix} 0 \\\\ -1/2 \\end{bmatrix} - \\frac{3}{10} \\begin{bmatrix} 1/2 \\\\ -3/2 \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ -5/10 \\end{bmatrix} - \\begin{bmatrix} 3/20 \\\\ -9/20 \\end{bmatrix} = \\begin{bmatrix} 0 - 3/20 \\\\ -10/20 - (-9/20) \\end{bmatrix} = \\begin{bmatrix} -3/20 \\\\ -1/20 \\end{bmatrix}$。\n\n9.  **更新搜索方向以得到 $p_{1}$:**\n    这需要计算 $\\rho_{1}$ 和 $\\beta_{0}$。\n    $\\rho_{1} = \\langle \\tilde{r}_{0}, r_{1} \\rangle = \\begin{bmatrix} 1  0 \\end{bmatrix} \\begin{bmatrix} -3/20 \\\\ -1/20 \\end{bmatrix} = -\\frac{3}{20}$。\n    $\\beta_{0} = \\frac{\\rho_{1}}{\\rho_{0}} \\frac{\\alpha_{0}}{\\omega_{0}} = \\frac{-3/20}{1} \\frac{1/2}{3/10} = -\\frac{3}{20} \\cdot \\frac{1}{2} \\cdot \\frac{10}{3} = -\\frac{30}{120} = -\\frac{1}{4}$。\n    搜索方向更新为 $p_{1} = r_{1} + \\beta_{0} (p_{0} - \\omega_{0} v_{0})$。\n    首先，计算括号中的项：\n    $p_{0} - \\omega_{0} v_{0} = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} - \\frac{3}{10} \\begin{bmatrix} 2 \\\\ 1 \\end{bmatrix} = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} - \\begin{bmatrix} 6/10 \\\\ 3/10 \\end{bmatrix} = \\begin{bmatrix} 4/10 \\\\ -3/10 \\end{bmatrix} = \\begin{bmatrix} 2/5 \\\\ -3/10 \\end{bmatrix}$。\n    现在，计算 $p_{1}$：\n    $p_{1} = \\begin{bmatrix} -3/20 \\\\ -1/20 \\end{bmatrix} + (-\\frac{1}{4}) \\begin{bmatrix} 2/5 \\\\ -3/10 \\end{bmatrix} = \\begin{bmatrix} -3/20 \\\\ -1/20 \\end{bmatrix} - \\begin{bmatrix} 2/20 \\\\ -3/40 \\end{bmatrix} = \\begin{bmatrix} -5/20 \\\\ -2/40 + 3/40 \\end{bmatrix} = \\begin{bmatrix} -1/4 \\\\ 1/40 \\end{bmatrix}$。\n\n第一次完整迭代计算出的量是：\n$\\rho_{0} = 1$, $\\alpha_{0} = \\frac{1}{2}$, $s_{0} = \\begin{bmatrix} 0 \\\\ -1/2 \\end{bmatrix}$, $\\omega_{0} = \\frac{3}{10}$, $x_{1} = \\begin{bmatrix} 1/2 \\\\ -3/20 \\end{bmatrix}$, $r_{1} = \\begin{bmatrix} -3/20 \\\\ -1/20 \\end{bmatrix}$, $p_{1} = \\begin{bmatrix} -1/4 \\\\ 1/40 \\end{bmatrix}$。\n\n**最终计算**\n\n问题要求计算 $\\|r_{1}\\|_{2}^{2}$。\n$\\|r_{1}\\|_{2}^{2} = \\langle r_{1}, r_{1} \\rangle = r_{1}^{\\top} r_{1} = \\begin{bmatrix} -3/20  -1/20 \\end{bmatrix} \\begin{bmatrix} -3/20 \\\\ -1/20 \\end{bmatrix}$。\n$\\|r_{1}\\|_{2}^{2} = (-\\frac{3}{20})^{2} + (-\\frac{1}{20})^{2} = \\frac{9}{400} + \\frac{1}{400} = \\frac{10}{400} = \\frac{1}{40}$。\n结果是所要求的精确有理数。", "answer": "$$\\boxed{\\frac{1}{40}}$$", "id": "3585874"}, {"introduction": "双共轭梯度稳定（BiCGSTAB）方法的核心创新在于其“稳定化”步骤，该步骤旨在平滑双共轭梯度（BiCG）方法可能出现的剧烈收敛行为。本练习通过一个思想实验，探讨一种特殊情况：当稳定化步骤的校正方向与中间残差正交时会发生什么。通过分析这种情形，你将更深刻地理解稳定化参数 $\\omega_k$ 的作用，以及算法在这一步失效时的行为。[@problem_id:3616023]", "problem": "考虑一个线性系统 $A x = b$，该系统源于粘声介质的频域地震波场模拟，其中 $A \\in \\mathbb{C}^{n \\times n}$ 是一个大型、稀疏的非厄米矩阵，其非厄米性由吸收边界条件和衰减引起。我们应用基于双共轭梯度稳定 (BiCGStab) 方法的迭代求解器来近似求解该系统。设初始猜测解为 $x_{0}$，初始残差为 $r_{0} = b - A x_{0}$，影子残差为 $r^{\\sharp}$ 且满足 $\\langle r^{\\sharp}, r_{0}\\rangle \\neq 0$，其中 $\\langle \\cdot, \\cdot \\rangle$ 表示 $\\mathbb{C}^{n}$ 上的标准欧几里得内积，其约定为 $\\langle u, v \\rangle = v^{*} u$。通过常规的非对称克雷洛夫投影定义初始搜索方向 $p_{0} = r_{0}$ 和标量 $\\alpha_{1}$，然后构造中间残差\n$$\ns_{1} = r_{0} - \\alpha_{1} A p_{0}.\n$$\n该方法接下来通过最小化残差 $r_{1}(\\omega) = s_{1} - \\omega t_{1}$ 的2-范数平方来寻找一个稳定标量 $\\omega_{1}$，其中 $t_{1} = A s_{1}$。极小值点 $\\omega_{1}$ 由以下条件确定：$r_{1}(\\omega)$ 在一维仿射子空间 $\\{s_{1} - \\omega t_{1} : \\omega \\in \\mathbb{C}\\}$ 中具有最小的2-范数。\n\n假设一个与强非均质衰减相关的情景，其中 $A$ 作用于 $s_{1}$ 产生的向量 $t_{1}$ 与 $s_{1}$ 在欧几里得内积下正交，即\n$$\n\\langle t_{1}, s_{1} \\rangle = 0 \\quad \\text{并且} \\quad \\langle t_{1}, t_{1} \\rangle \\neq 0.\n$$\n在这些假设下，确定使范数最小化的 $\\omega_{1}$，并推导出迭代解和残差的更新结果：\n$$\nx_{1} = x_{0} + \\alpha_{1} p_{0} + \\omega_{1} s_{1}, \\qquad r_{1} = s_{1} - \\omega_{1} t_{1}.\n$$\n将最终答案以单行矩阵的形式给出，包含 $\\omega_{1}$、$x_{1}$ 和 $r_{1}$ 这三个条目，并用 $x_{0}$、$p_{0}$、$\\alpha_{1}$ 和 $s_{1}$ 进行符号表示。不需要进行数值计算，也无需四舍五入。", "solution": "### 求解推导\n目标是确定标量 $\\omega_{1} \\in \\mathbb{C}$，以最小化残差 $r_{1}(\\omega) = s_{1} - \\omega t_{1}$ 的2-范数平方。2-范数平方定义为 $\\|v\\|_{2}^{2} = \\langle v, v \\rangle$，对于任意向量 $v \\in \\mathbb{C}^{n}$。\n\n设 $f(\\omega)$ 为待最小化的函数：\n$$\nf(\\omega) = \\|s_{1} - \\omega t_{1}\\|_{2}^{2} = \\langle s_{1} - \\omega t_{1}, s_{1} - \\omega t_{1} \\rangle\n$$\n使用给定的内积定义 $\\langle u, v \\rangle = v^{*} u$，我们可以展开此表达式。标量-向量乘积的共轭转置是 $(\\omega t_1)^* = \\bar{\\omega} t_1^*$。\n$$\nf(\\omega) = (s_{1} - \\omega t_{1})^{*} (s_{1} - \\omega t_{1}) = (s_{1}^{*} - \\bar{\\omega} t_{1}^{*}) (s_{1} - \\omega t_{1})\n$$\n展开乘积可得：\n$$\nf(\\omega) = s_{1}^{*}s_{1} - \\omega s_{1}^{*}t_{1} - \\bar{\\omega} t_{1}^{*}s_{1} + \\bar{\\omega}\\omega t_{1}^{*}t_{1}\n$$\n我们可以使用内积符号来表示这些项：\n-   $s_{1}^{*}s_{1} = \\langle s_{1}, s_{1} \\rangle = \\|s_{1}\\|_{2}^{2}$\n-   $t_{1}^{*}s_{1} = \\langle s_{1}, t_{1} \\rangle$\n-   $s_{1}^{*}t_{1} = (t_{1}^{*}s_{1})^{*} = \\langle s_{1}, t_{1} \\rangle^{*}$\n-   $t_{1}^{*}t_{1} = \\langle t_{1}, t_{1} \\rangle = \\|t_{1}\\|_{2}^{2}$\n\n将这些代入 $f(\\omega)$ 的表达式中：\n$$\nf(\\omega) = \\|s_{1}\\|_{2}^{2} - \\omega \\langle s_{1}, t_{1} \\rangle^{*} - \\bar{\\omega} \\langle s_{1}, t_{1} \\rangle + |\\omega|^{2} \\|t_{1}\\|_{2}^{2}\n$$\n为了找到最小值，我们可以将关于 $\\bar{\\omega}$ 的复导数设为零：\n$$\n\\frac{\\partial f}{\\partial \\bar{\\omega}} = - \\langle s_{1}, t_{1} \\rangle + \\omega \\|t_{1}\\|_{2}^{2} = 0\n$$\n求解 $\\omega$ 得到极小值点的一般表达式，我们将其记为 $\\omega_1$：\n$$\n\\omega_{1} = \\frac{\\langle s_{1}, t_{1} \\rangle}{\\|t_{1}\\|_{2}^{2}} = \\frac{\\langle s_{1}, t_{1} \\rangle}{\\langle t_{1}, t_{1} \\rangle}\n$$\n这是 BiCGStab 算法中 $\\omega_1$ 的标准公式。\n\n现在，我们应用问题陈述中给出的特定条件：$\\langle t_{1}, s_{1} \\rangle = 0$。\n复内积具有性质 $\\langle u, v \\rangle = \\langle v, u \\rangle^{*}$。因此：\n$$\n\\langle s_{1}, t_{1} \\rangle = \\langle t_{1}, s_{1} \\rangle^{*}\n$$\n已知 $\\langle t_{1}, s_{1} \\rangle = 0$，我们有：\n$$\n\\langle s_{1}, t_{1} \\rangle = (0)^{*} = 0\n$$\n$\\omega_{1}$ 表达式的分子为零。分母为 $\\langle t_{1}, t_{1} \\rangle$，题目明确指出其不为零。\n因此，$\\omega_{1}$ 的值为：\n$$\n\\omega_{1} = \\frac{0}{\\langle t_{1}, t_{1} \\rangle} = 0\n$$\n或者，将条件 $\\langle t_1, s_1 \\rangle = 0$（这意味着 $\\langle s_1, t_1 \\rangle = 0$）直接代入展开的函数 $f(\\omega)$ 中：\n$$\nf(\\omega) = \\|s_{1}\\|_{2}^{2} - \\omega(0) - \\bar{\\omega}(0) + |\\omega|^{2} \\|t_{1}\\|_{2}^{2} = \\|s_{1}\\|_{2}^{2} + |\\omega|^{2} \\|t_{1}\\|_{2}^{2}\n$$\n由于 $\\|s_{1}\\|_{2}^{2}$ 是一个非负常数，而 $\\|t_{1}\\|_{2}^{2}$ 是一个正常数（因为 $\\langle t_{1}, t_{1} \\rangle \\neq 0$），当 $|\\omega|^{2} \\|t_{1}\\|_{2}^{2}$ 项最小时，函数 $f(\\omega)$ 取得最小值。这发生在 $|\\omega|^{2}=0$ 时，即 $\\omega = 0$。因此，最小化标量为 $\\omega_1 = 0$。\n\n确定了 $\\omega_{1} = 0$ 后，我们可以求出更新后的迭代解 $x_{1}$ 和残差 $r_{1}$。\n迭代解的更新公式为：\n$$\nx_{1} = x_{0} + \\alpha_{1} p_{0} + \\omega_{1} s_{1}\n$$\n代入 $\\omega_{1}=0$：\n$$\nx_{1} = x_{0} + \\alpha_{1} p_{0} + (0) s_{1} = x_{0} + \\alpha_{1} p_{0}\n$$\n残差的更新公式为：\n$$\nr_{1} = s_{1} - \\omega_{1} t_{1}\n$$\n代入 $\\omega_{1}=0$：\n$$\nr_{1} = s_{1} - (0) t_{1} = s_{1}\n$$\n条件 $\\langle t_1, s_1 \\rangle = \\langle As_1, s_1 \\rangle = 0$ 表明，由于最优稳定参数 $\\omega_1$ 为零，BiCGStab的稳定化步骤没有对残差产生任何改进。该方法在本次迭代中实际上退化为双共轭梯度法的一步，新的残差 $r_1$ 就是中间残差 $s_1$。\n\n所要求的三个量用指定变量表示为 $\\omega_1=0$，$x_1=x_0 + \\alpha_1 p_0$ 和 $r_1=s_1$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  x_{0} + \\alpha_{1} p_{0}  s_{1}\n\\end{pmatrix}\n}\n$$", "id": "3616023"}, {"introduction": "在将迭代算法从理论转化为可靠的计算代码时，一个核心的实际问题是如何设计稳健的停止准则。对于像BiCGSTAB这样的方法，尤其是在处理非正规矩阵时，简单的收敛判断可能会导致错误的结果，例如伪收敛或由于舍入误差累积而产生的残差漂移。这个练习要求你评估多种停止策略，并选择一个综合了相对残差、后向误差分析和停滞检测的复合策略，以确保算法的可靠性和鲁棒性。[@problem_id:3585850]", "problem": "考虑使用双共轭梯度稳定方法 (BiCGSTAB) 求解一个非奇异线性系统 $A x = b$，其中矩阵 $A \\in \\mathbb{R}^{n \\times n}$ 是一般的非对称且可能高度非正规的矩阵。设 $x_k$ 是该算法产生的第 $k$ 次迭代解，真实残差为 $r_k = b - A x_k$。实践者必须确定在非正规性条件下稳健的实用停止准则。以下多项选择选项提出了不同的停止策略及其理由。选择一个选项，该选项提供了一个健全、可实施的策略，该策略整合了 $2$-范数下的相对残差测试、范数反向误差估计和停滞检测，并且在存在非正规性的情况下是合理的。\n\nA. 一旦递推更新的残差满足 $\\| r_k \\|_2 / \\| b \\|_2 \\le \\tau$（其中 $\\tau$ 为用户容差），就宣布成功，而不显式重新计算 $r_k$ 或使用任何反向误差估计。不包括停滞检查，因为即使对于非正规矩阵 $A$，残差减小也足以保证进展。\n\nB. 当一个先验前向误差界表明 $\\| x - x_k \\|_2 / \\| x \\|_2 \\le \\tau$ 时宣布成功，该界通过验证 $\\kappa_2(A)\\, \\| r_k \\|_2 / \\| b \\|_2 \\le \\tau$ 来估计，其中 $\\kappa_2(A)$ 是通过奇异值分解一次性计算出的 $A$ 的 $2$-范数条件数。不需要停滞检查，因为条件数加权的残差完全捕捉了非正规性的影响。\n\nC. 如果范数反向误差估计 $\\widehat{\\eta}_k = \\| r_k \\|_2 / \\big(\\| A \\|_2 \\| x_k \\|_2\\big) \\le \\tau$ 成立，则宣布成功，其中为降低成本用弗罗贝尼乌斯范数 $\\| A \\|_F$ 近似 $\\| A \\|_2$，并为简化起见从分母中省略 $\\| b \\|_2$。如果在若干步内 $\\| x_{k+1} - x_k \\|_2 / \\| x_k \\|_2 \\le \\tau_\\text{step}$，则将停滞视为可接受的，因为在非正规问题中，小步长表示收敛。\n\nD. 使用如下复合策略。成功：当显式重新计算的相对残差满足 $\\| r_k \\|_2 / \\| b \\|_2 \\le \\tau_\\text{rel}$ 或一个保守的范数反向误差界 $\\eta_k$ 满足 $\\eta_k \\le \\tau_\\text{be}$ 时接受，其中\n$$\n\\eta_k \\;\\equiv\\; \\frac{\\| r_k \\|_2}{\\| A \\|_2 \\| x_k \\|_2 + \\| b \\|_2}, \n$$\n且一个可计算的 $\\lVert A \\rVert_2$ 估计被使用。至少每 $m$ 次迭代（对于某个小的 $m$）显式重新计算 $r_k = b - A x_k$ 来验证残差，以控制递推残差和真实残差之间的漂移。停滞：如果连续 $s$ 次迭代中残差范数未能以预设的相对因子减小，即对 $j = 1,\\dots,s$ 有 $\\| r_{k+j} \\|_2 \\ge (1 - \\gamma)\\, \\| r_{k+j-1} \\|_2$，或者如果步长在数值上极小而没有伴随的残差减小，即 $\\| x_{k+1} - x_k \\|_2 / (\\| x_k \\|_2 + 1) \\le \\tau_\\text{step}$ 而 $\\| r_{k+1} \\|_2 \\ge (1 - c)\\, \\| r_k \\|_2$，则以停滞标志终止。理由：相对残差是一个廉价的进展指标；范数反向误差 $\\eta_k$ 量化了数据扰动 $(\\delta A,\\delta b)$ 的大小，对于这些扰动，$x_k$ 是 $(A + \\delta A) x_k = b + \\delta b$ 的精确解，并且即使当 $A$ 高度非正规时也仍然有意义；显式的残差重新计算和停滞检查可以防止 BiCGSTAB 中的伪收敛和残差漂移。", "solution": "问题要求为使用双共轭梯度稳定 (BiCGSTAB) 方法求解非奇异线性系统 $A x = b$ 选择一个健全、可实施且稳健的停止策略，其中矩阵 $A$ 可能是非对称且高度非正规的。一个稳健的策略应能正确处理潜在问题，例如残差的非单调收敛、舍入误差的灾难性累积（残差漂移）以及误导性的收敛行为（伪收敛），这些问题在非正规矩阵中尤为突出。该策略应整合相对残差测试、范数反向误差估计和停滞检测。\n\n我们将根据数值线性代数中关于迭代求解器的既定原则来分析每个提议的选项。\n\n**A. 一旦递推更新的残差满足 $\\| r_k \\|_2 / \\| b \\|_2 \\le \\tau$（其中 $\\tau$ 为用户容差），就宣布成功，而不显式重新计算 $r_k$ 或使用任何反向误差估计。不包括停滞检查，因为即使对于非正规矩阵 $A$，残差减小也足以保证进展。**\n\n该选项基于几个原因存在根本性缺陷。\n1.  **递推残差与真实残差**：在 BiCGSTAB 中，与许多克雷洛夫子空间方法一样，为了计算效率，残差 $r_k$ 通常通过短期递推关系进行更新。由于多步迭代中浮点舍入误差的累积，递推更新的残差可能会“漂移”，并与真实残差 $r_k^\\text{true} = b - A x_k$ 产生显著差异。仅仅依赖递推残差可能导致过早终止，即算法因计算出的残差很小而停止，但真实残差仍然很大。这是一种被称为残差漂移的著名现象。一个稳健的算法必须周期性地重新计算真实残差以校正这种漂移。\n2.  **停滞与非正规性**：理由“残差减小足以保证进展”是不正确的。首先，BiCGSTAB 算法不保证残差范数单调递减，特别是对于非正规矩阵，其残差范数可能表现出不规则行为，出现平台期甚至瞬时增加。其次，即使残差在减小，其减小速率也可能非常缓慢，以至于算法实际上已经停滞，为微不足道的改进而浪费计算资源。停滞检查对于检测此类情况至关重要。\n3.  **缺乏反向误差分析**：该策略完全忽略了任何形式的反向误差分析。对于病态或非正规问题，仅凭残差范数可能是衡量解质量的一个很差的指标。小残差不保证小的前向误差 $\\| x - x_k \\|_2$。范数反向误差衡量了使得 $x_k$ 成为精确解的问题数据（$A$ 和 $b$）扰动的大小，它提供了更可靠的质量保证。\n\n结论：**不正确**。此策略过于简单，忽略了迭代求解器中那些有充分记录的关键失效模式。\n\n**B. 当一个先验前向误差界表明 $\\| x - x_k \\|_2 / \\| x \\|_2 \\le \\tau$ 时宣布成功，该界通过验证 $\\kappa_2(A)\\, \\| r_k \\|_2 / \\| b \\|_2 \\le \\tau$ 来估计，其中 $\\kappa_2(A)$ 是通过奇异值分解一次性计算出的 $A$ 的 $2$-范数条件数。不需要停滞检查，因为条件数加权的残差完全捕捉了非正规性的影响。**\n\n该选项既不切实际，在理论上也是错误的。\n1.  **计算成本**：该策略需要计算 $2$-范数条件数 $\\kappa_2(A) = \\| A \\|_2 \\| A^{-1} \\|_2$。这通常需要对 $A$ 进行奇异值分解 (SVD)。对于大型稀疏矩阵（这是像 BiCGSTAB 这样的迭代方法的主要目标），计算完整的 SVD 的成本高得令人望而却步，通常比求解线性系统本身的成本还要高得多。\n2.  **悲观的界**：对于高度非正规矩阵，前向误差界 $\\frac{\\| x - x_k \\|_2}{\\| x \\|_2} \\le \\kappa_2(A) \\frac{\\| r_k \\|_2}{\\| b \\|_2}$ 是众所周知的极其宽松（悲观）的。依赖它可能导致算法运行时间过长，或者即使已经找到了一个完全可接受的解（在反向误差的意义上）也无法终止。\n3.  **对非正规性的误解**：声称“条件数加权的残差完全捕捉了非正规性的影响”是错误的。条件数关系到解对扰动的敏感性，但并未描述与非正规矩阵迭代相关的瞬态、非单调收敛行为。伪谱分析提供了更完整的非正规性图像，但这对于一个标准的停止准则来说过于复杂。\n4.  **无停滞检查**：此策略也忽略了停滞检查，正如对选项 A 的解释，这对于稳健性至关重要。\n\n结论：**不正确**。此策略对于大规模问题在计算上是不可行的，并且它所依赖的理论界对于正在考虑的这类矩阵在实践中通常是无用的。\n\n**C. 如果范数反向误差估计 $\\widehat{\\eta}_k = \\| r_k \\|_2 / \\big(\\| A \\|_2 \\| x_k \\|_2\\big) \\le \\tau$ 成立，则宣布成功，其中为降低成本用弗罗贝尼乌斯范数 $\\| A \\|_F$ 近似 $\\| A \\|_2$，并为简化起见从分母中省略 $\\| b \\|_2$。如果在若干步内 $\\| x_{k+1} - x_k \\|_2 / \\| x_k \\|_2 \\le \\tau_\\text{step}$，则将停滞视为可接受的，因为在非正规问题中，小步长表示收敛。**\n\n该选项的表述和理由中包含几个严重错误。\n1.  **错误的反向误差公式**：对于系统 $(A+\\Delta A)x_k = b+\\Delta b$，标准、稳健的范数反向误差上界是 $\\eta_k = \\frac{\\| r_k \\|_2}{\\| A \\| \\| x_k \\| + \\| b \\|}$。提议的公式 $\\widehat{\\eta}_k$ 忽略了 $\\| b \\|_2$ 项。这使得估计不可靠，特别是当 $\\| b \\|_2$ 相对于 $\\| A \\|_2 \\| x_k \\|_2$ 很大时。例如，如果解 $x$ 很小，$x_k$ 可能也很小，这会使分母人为地变小，从而导致误差估计不稳定。\n2.  **错误的范数近似**：建议用 $\\| A \\|_F$ 近似 $\\| A \\|_2$ 是一种启发式方法。我们知道 $\\| A \\|_2 \\le \\| A \\|_F$。在反向误差表达式的分母中使用 $\\| A \\|_F$ 会导致对真实反向误差界的低估（因为分母变大了），这是不安全的。一个保守的界需要 $\\| A \\|_2$ 的*下界*，而不是上界。\n3.  **对停滞的致命误解**：将停滞视为可接受的建议是极其错误和危险的。当步长 $\\| x_{k+1} - x_k \\|_2$ 变得非常小而残差仍然很大时，这是算法失效或“伪收敛”的典型标志。这意味着该方法不再取得进展。这应该触发一个带有失败标志的终止，而不是被接受为收敛。\n\n结论：**不正确**。该选项显示了对反向误差分析和迭代方法实际行为的理解不足。\n\n**D. 使用如下复合策略。成功：当显式重新计算的相对残差满足 $\\| r_k \\|_2 / \\| b \\|_2 \\le \\tau_\\text{rel}$ 或一个保守的范数反向误差界 $\\eta_k$ 满足 $\\eta_k \\le \\tau_\\text{be}$ 时接受，其中\n$$\n\\eta_k \\;\\equiv\\; \\frac{\\| r_k \\|_2}{\\| A \\|_2 \\| x_k \\|_2 + \\| b \\|_2}, \n$$\n且一个可计算的 $\\lVert A \\rVert_2$ 估计被使用。至少每 $m$ 次迭代（对于某个小的 $m$）显式重新计算 $r_k = b - A x_k$ 来验证残差，以控制递推残差和真实残差之间的漂移。停滞：如果连续 $s$ 次迭代中残差范数未能以预设的相对因子减小，即对 $j = 1,\\dots,s$ 有 $\\| r_{k+j} \\|_2 \\ge (1 - \\gamma)\\, \\| r_{k+j-1} \\|_2$，或者如果步长在数值上极小而没有伴随的残差减小，即 $\\| x_{k+1} - x_k \\|_2 / (\\| x_k \\|_2 + 1) \\le \\tau_\\text{step}$ 而 $\\| r_{k+1} \\|_2 \\ge (1 - c)\\, \\| r_k \\|_2$，则以停滞标志终止。理由：相对残差是一个廉价的进展指标；范数反向误差 $\\eta_k$ 量化了数据扰动 $(\\delta A,\\delta b)$ 的大小，对于这些扰动，$x_k$ 是 $(A + \\delta A) x_k = b + \\delta b$ 的精确解，并且即使当 $A$ 高度非正规时也仍然有意义；显式的残差重新计算和停滞检查可以防止 BiCGSTAB 中的伪收敛和残差漂移。**\n\n该选项描述了一种先进、稳健的停止策略。\n1.  **复合准则**：将相对残差测试与反向误差测试相结合提供了灵活性。前者廉价且直观，而后者提供了一种严格的解质量度量，无论 $A$ 的条件数或非正规性如何，都具有意义。\n2.  **正确的反向误差公式**：$\\eta_k$ 的公式使用了正确的分母结构，即 $\\text{某项}\\cdot\\| x_k \\|_2 + \\| b \\|_2$。使用一个可计算的 $\\| A \\|_2$ 估计（例如，通过几步幂迭代或使用可用的探测向量）是正确的实践方法，可以在不产生精确计算 $\\| A \\|_2$ 的高昂成本下获得一个可靠的反向误差界。\n3.  **残差重新计算**：该策略明确包括周期性地重新计算真实残差 $r_k = b - A x_k$。这是防止基于一个具有欺骗性的小但不准确的递推更新残差而终止的标准且必要的技术。\n4.  **精密的停滞检测**：提议的停滞检查是全面的。它们正确地识别了两种关键的失效模式：(i) 残差范数停止取得有意义的进展，以及 (ii) 在残差仍然很大的情况下，迭代解 $x_k$ 不再有显著变化（伪收敛）。用 $(\\| x_k \\|_2+1)$ 对步长进行归一化是处理接近原点的迭代解的一种稳健方法。\n5.  **合理的理由**：所提供的理由完全正确，并简明地解释了策略中每个组成部分背后的原理，显示了对数值线性代数中实际挑战的深刻理解。\n\n结论：**正确**。该选项提出了一种在理论上健全、实践中可实施，并且对于与非正规系统的迭代方法相关的已知困难具有稳健性的策略。", "answer": "$$\\boxed{D}$$", "id": "3585850"}]}