{"hands_on_practices": [{"introduction": "这项练习提供了一个具体的、分步的指南，用以通过给定的奇异值分解（SVD）寻找最小范数最小二乘解。通过将问题转换到由奇异向量定义的坐标系中，我们可以清晰地看到如何通过将解在零空间中的分量设为零来处理秩亏的情况。这一实践加强了基于SVD的解法背后的几何直觉。[@problem_id:3583009]", "problem": "考虑一个实矩阵 $A \\in \\mathbb{R}^{3 \\times 3}$，其奇异值分解 (SVD) 为 $A = U \\Sigma V^{\\top}$，其中 $U \\in \\mathbb{R}^{3 \\times 3}$ 和 $V \\in \\mathbb{R}^{3 \\times 3}$ 是正交矩阵，$\\Sigma \\in \\mathbb{R}^{3 \\times 3}$ 是对角矩阵且其对角线元素为非负。令\n$$\nU = \\begin{pmatrix}\n\\frac{1}{\\sqrt{2}}  \\frac{1}{\\sqrt{2}}  0 \\\\\n-\\frac{1}{\\sqrt{2}}  \\frac{1}{\\sqrt{2}}  0 \\\\\n0  0  1\n\\end{pmatrix}, \\quad\n\\Sigma = \\begin{pmatrix}\n4  0  0 \\\\\n0  1  0 \\\\\n0  0  0\n\\end{pmatrix}, \\quad\nV = \\begin{pmatrix}\n0  1  0 \\\\\n1  0  0 \\\\\n0  0  -1\n\\end{pmatrix}.\n$$\n令 $b \\in \\mathbb{R}^{3}$ 由 $b = \\begin{pmatrix} 1 \\\\ -2 \\\\ 3 \\end{pmatrix}$ 给出，且令 $w \\in \\mathbb{R}^{3}$ 由 $w = \\begin{pmatrix} 2 \\\\ -1 \\\\ 0 \\end{pmatrix}$ 给出。仅使用最小二乘问题 $\\min_{x \\in \\mathbb{R}^{3}} \\|A x - b\\|_{2}$ 和奇异值分解的核心定义，通过将问题转换到奇异向量坐标系中，将与零奇异值对应的零空间中的坐标设为零，并通过非零奇异值求解剩余坐标，显式地构造最小范数最小二乘解 $x^\\star$。\n\n计算标量 $w^\\top x^\\star$，并将您的最终答案表示为单一的闭式解析表达式。无需四舍五入。", "solution": "问题是求解问题 $\\min_{x \\in \\mathbb{R}^{3}} \\|Ax - b\\|_{2}$ 的最小范数最小二乘解 $x^\\star \\in \\mathbb{R}^{3}$，然后计算标量 $w^\\top x^\\star$。矩阵 $A$ 由其奇异值分解 (SVD) 给出，$A = U \\Sigma V^\\top$，其中\n$$\nU = \\begin{pmatrix}\n\\frac{1}{\\sqrt{2}}  \\frac{1}{\\sqrt{2}}  0 \\\\\n-\\frac{1}{\\sqrt{2}}  \\frac{1}{\\sqrt{2}}  0 \\\\\n0  0  1\n\\end{pmatrix}, \\quad\n\\Sigma = \\begin{pmatrix}\n4  0  0 \\\\\n0  1  0 \\\\\n0  0  0\n\\end{pmatrix}, \\quad\nV = \\begin{pmatrix}\n0  1  0 \\\\\n1  0  0 \\\\\n0  0  -1\n\\end{pmatrix}.\n$$\n向量 $b$ 和 $w$ 如下给出\n$$\nb = \\begin{pmatrix} 1 \\\\ -2 \\\\ 3 \\end{pmatrix}, \\quad\nw = \\begin{pmatrix} 2 \\\\ -1 \\\\ 0 \\end{pmatrix}.\n$$\n目标是最小化残差的欧几里得范数 $\\|Ax - b\\|_{2}$。我们将 $A$ 的 SVD 代入此表达式：\n$$\n\\|Ax - b\\|_{2} = \\|U \\Sigma V^\\top x - b\\|_{2}.\n$$\n因为 $U$ 是一个正交矩阵，所以它的转置 $U^\\top$ 也是正交的。乘以一个正交矩阵不改变欧几里得范数，所以我们可以将范数内的项乘以 $U^\\top$ 而不改变范数的值：\n$$\n\\|U \\Sigma V^\\top x - b\\|_{2} = \\|U^\\top(U \\Sigma V^\\top x - b)\\|_{2} = \\|(U^\\top U) \\Sigma V^\\top x - U^\\top b\\|_{2}.\n$$\n由于 $U^\\top U = I$ (单位矩阵)，上式简化为：\n$$\n\\|\\Sigma V^\\top x - U^\\top b\\|_{2}.\n$$\n为了进一步简化这个表达式，我们进行变量替换。令 $y = V^\\top x$。由于 $V$ 是一个正交矩阵，我们可以将 $x$ 表示为 $x = Vy$。这个变换是一个等距变换，意味着 $\\|x\\|_{2} = \\|Vy\\|_{2} = \\|y\\|_{2}$。因此，寻找最小范数解 $x^\\star$ 等价于为变换后的问题寻找最小范数解 $y^\\star$。问题现在变为寻找 $y \\in \\mathbb{R}^{3}$ 以最小化 $\\|\\Sigma y - U^\\top b\\|_{2}$。\n\n首先，我们计算向量 $c = U^\\top b$：\n$$\nc = U^\\top b = \\begin{pmatrix} \\frac{1}{\\sqrt{2}}  -\\frac{1}{\\sqrt{2}}  0 \\\\ \\frac{1}{\\sqrt{2}}  \\frac{1}{\\sqrt{2}}  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ -2 \\\\ 3 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{\\sqrt{2}}(1) - \\frac{1}{\\sqrt{2}}(-2) \\\\ \\frac{1}{\\sqrt{2}}(1) + \\frac{1}{\\sqrt{2}}(-2) \\\\ 1(3) \\end{pmatrix} = \\begin{pmatrix} \\frac{3}{\\sqrt{2}} \\\\ -\\frac{1}{\\sqrt{2}} \\\\ 3 \\end{pmatrix}.\n$$\n现在我们用 $y = \\begin{pmatrix} y_1 \\\\ y_2 \\\\ y_3 \\end{pmatrix}$ 的分量来表示最小化问题。我们想要最小化范数的平方 $\\|\\Sigma y - c\\|_{2}^{2}$：\n$$\n\\|\\Sigma y - c\\|_{2}^{2} = \\left\\| \\begin{pmatrix} 4  0  0 \\\\ 0  1  0 \\\\ 0  0  0 \\end{pmatrix} \\begin{pmatrix} y_1 \\\\ y_2 \\\\ y_3 \\end{pmatrix} - \\begin{pmatrix} \\frac{3}{\\sqrt{2}} \\\\ -\\frac{1}{\\sqrt{2}} \\\\ 3 \\end{pmatrix} \\right\\|_{2}^{2} = \\left\\| \\begin{pmatrix} 4y_1 - \\frac{3}{\\sqrt{2}} \\\\ y_2 - (-\\frac{1}{\\sqrt{2}}) \\\\ 0 \\cdot y_3 - 3 \\end{pmatrix} \\right\\|_{2}^{2}.\n$$\n这个范数的平方是各分量平方的和：\n$$\n(4y_1 - \\frac{3}{\\sqrt{2}})^2 + (y_2 + \\frac{1}{\\sqrt{2}})^2 + (-3)^2.\n$$\n为了最小化这个表达式，我们必须选择 $y_1$ 和 $y_2$ 使前两项为零，因为它们是非负的。\n对于第一项：$4y_1 - \\frac{3}{\\sqrt{2}} = 0 \\implies y_1 = \\frac{3}{4\\sqrt{2}}$。\n对于第二项：$y_2 + \\frac{1}{\\sqrt{2}} = 0 \\implies y_2 = -\\frac{1}{\\sqrt{2}}$。\n第三项 $(-3)^2=9$ 是一个常数，代表了可能的最小平方误差。$y_3$ 的选择不影响平方误差的值，所以任何 $y_3 \\in \\mathbb{R}$ 都能给出一个有效的最小二乘解。所有最小二乘解 $y$ 的集合由形如 $\\begin{pmatrix} \\frac{3}{4\\sqrt{2}} \\\\ -\\frac{1}{\\sqrt{2}} \\\\ k \\end{pmatrix}$ 的向量给出，其中 $k \\in \\mathbb{R}$ 为任意实数。\n\n为了找到唯一的最小范数解 $x^\\star$，我们必须首先找到最小范数解 $y^\\star$。$y$ 的范数平方为 $\\|y\\|_{2}^{2} = y_1^2 + y_2^2 + y_3^2$：\n$$\n\\|y\\|_{2}^{2} = \\left(\\frac{3}{4\\sqrt{2}}\\right)^2 + \\left(-\\frac{1}{\\sqrt{2}}\\right)^2 + y_3^2.\n$$\n为了最小化这个范数，我们必须选择分量 $y_3$ 为零，即 $y_3=0$。这对应于将与零奇异值相关联的奇异向量方向上的坐标设置为 0。因此，最小范数解 $y^\\star$ 是：\n$$\ny^\\star = \\begin{pmatrix} \\frac{3}{4\\sqrt{2}} \\\\ -\\frac{1}{\\sqrt{2}} \\\\ 0 \\end{pmatrix}.\n$$\n现在我们变换回原始坐标以求得 $x^\\star = Vy^\\star$：\n$$\nx^\\star = \\begin{pmatrix} 0  1  0 \\\\ 1  0  0 \\\\ 0  0  -1 \\end{pmatrix} \\begin{pmatrix} \\frac{3}{4\\sqrt{2}} \\\\ -\\frac{1}{\\sqrt{2}} \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} (0)(\\frac{3}{4\\sqrt{2}}) + (1)(-\\frac{1}{\\sqrt{2}}) + (0)(0) \\\\ (1)(\\frac{3}{4\\sqrt{2}}) + (0)(-\\frac{1}{\\sqrt{2}}) + (0)(0) \\\\ (0)(\\frac{3}{4\\sqrt{2}}) + (0)(-\\frac{1}{\\sqrt{2}}) + (-1)(0) \\end{pmatrix} = \\begin{pmatrix} -\\frac{1}{\\sqrt{2}} \\\\ \\frac{3}{4\\sqrt{2}} \\\\ 0 \\end{pmatrix}.\n$$\n最后，我们计算所需的标量 $w^\\top x^\\star$：\n$$\nw^\\top x^\\star = \\begin{pmatrix} 2  -1  0 \\end{pmatrix} \\begin{pmatrix} -\\frac{1}{\\sqrt{2}} \\\\ \\frac{3}{4\\sqrt{2}} \\\\ 0 \\end{pmatrix} = (2)\\left(-\\frac{1}{\\sqrt{2}}\\right) + (-1)\\left(\\frac{3}{4\\sqrt{2}}\\right) + (0)(0).\n$$\n$$\nw^\\top x^\\star = -\\frac{2}{\\sqrt{2}} - \\frac{3}{4\\sqrt{2}} = -\\frac{8}{4\\sqrt{2}} - \\frac{3}{4\\sqrt{2}} = -\\frac{11}{4\\sqrt{2}}.\n$$\n为了以标准的闭式形式写出答案，我们将分母有理化：\n$$\nw^\\top x^\\star = -\\frac{11}{4\\sqrt{2}} \\cdot \\frac{\\sqrt{2}}{\\sqrt{2}} = -\\frac{11\\sqrt{2}}{4 \\cdot 2} = -\\frac{11\\sqrt{2}}{8}.\n$$", "answer": "$$ \\boxed{-\\frac{11\\sqrt{2}}{8}} $$", "id": "3583009"}, {"introduction": "在数据不可避免地含有噪声的实际应用中，最小二乘解的稳定性至关重要。本练习将演示一个矩阵的奇异值如何决定其解对输入向量 $b$ 中扰动的敏感度。你将为一个具有大跨度奇异值的矩阵推导并计算误差放大因子，从而在病态问题和最小奇异值之间建立直接联系。[@problem_id:3583026]", "problem": "考虑一个超定最小二乘问题，即对于一个矩阵 $A \\in \\mathbb{R}^{3 \\times 2}$ 和一个向量 $b \\in \\mathbb{R}^{3}$，最小化欧几里得范数 $\\|A x - b\\|_{2}$。设矩阵 $A$ 被构造成具有差异悬殊的奇异值，定义如下\n$$\nA \\;=\\; \\begin{pmatrix}\n10^{3}  0 \\\\\n0  10^{-9} \\\\\n0  0\n\\end{pmatrix}.\n$$\n您可以假设 $A$ 的奇异值分解 (SVD) 为 $A = U \\Sigma V^{\\top}$，其中 $U \\in \\mathbb{R}^{3 \\times 3}$ 是正交矩阵，$V \\in \\mathbb{R}^{2 \\times 2}$ 是正交矩阵，$\\Sigma \\in \\mathbb{R}^{3 \\times 2}$ 在其前两行是对角形式且元素非负。使用 SVD 框架，从欧几里得范数的正交不变性和 $\\Sigma$ 的对角结构这些第一性原理出发，推导出最小二乘解 $x^{\\star}$。\n\n现在假设数据向量 $b$ 受到一个加性误差 $\\delta b \\in \\mathbb{R}^{3}$ 的扰动。令 $\\delta x$ 表示在该扰动下最小二乘解 $x^{\\star}$ 的相应变化。定义误差放大因子为\n$$\nM \\;=\\; \\sup_{\\delta b \\neq 0} \\frac{\\|\\delta x\\|_{2}}{\\|\\delta b\\|_{2}}.\n$$\n对上面给定的矩阵 $A$ 明确计算 $M$。您的答案应为一个实数，无需四舍五入。", "solution": "该问题包括两部分。第一，使用奇异值分解 (SVD) 推导最小二乘解。第二，为给定矩阵 $A$ 计算误差放大因子 $M$。\n\n### 第一部分：通过 SVD 推导最小二乘解\n\n最小二乘问题是寻找一个向量 $x^{\\star} \\in \\mathbb{R}^{n}$，它能最小化残差的欧几里得范数 $\\|A x - b\\|_{2}$，其中给定矩阵 $A \\in \\mathbb{R}^{m \\times n}$ 和向量 $b \\in \\mathbb{R}^{m}$。在这里，$m=3$，$n=2$。\n\n设 $A$ 的奇异值分解 (SVD) 为 $A = U \\Sigma V^\\top$，其中：\n- $U \\in \\mathbb{R}^{m \\times m}$ 是一个正交矩阵 ($U^\\top U = UU^\\top = I_m$)。\n- $V \\in \\mathbb{R}^{n \\times n}$ 是一个正交矩阵 ($V^\\top V = VV^\\top = I_n$)。\n- $\\Sigma \\in \\mathbb{R}^{m \\times n}$ 是一个矩形对角矩阵，其主对角线上的非负实数 $\\sigma_i$ 被称为奇异值。奇异值按 $\\sigma_1 \\geq \\sigma_2 \\geq \\dots \\geq \\sigma_r > 0$ 的顺序排列，其中 $r = \\text{rank}(A)$。\n\n目标函数是最小化 $\\|A x - b\\|_{2}$。我们将 $A$ 的 SVD 代入此表达式：\n$$\n\\|A x - b\\|_{2} = \\|U \\Sigma V^\\top x - b\\|_{2}\n$$\n欧几里得范数的一个关键性质是其在正交变换下的不变性。即，对于任何正交矩阵 $Q$，都有 $\\|Qz\\|_{2} = \\|z\\|_{2}$。由于 $U$ 是正交的，其转置 $U^\\top$ 也是正交的。我们可以在不改变范数值的情况下，将范数内的向量乘以 $U^\\top$：\n$$\n\\|A x - b\\|_{2} = \\|U^\\top(U \\Sigma V^\\top x - b)\\|_{2} = \\|(U^\\top U) \\Sigma V^\\top x - U^\\top b\\|_{2} = \\|\\Sigma V^\\top x - U^\\top b\\|_{2}\n$$\n为了简化此表达式，我们引入新变量。令 $y = V^\\top x$ 和 $c = U^\\top b$。由于 $V$ 是正交的，所以 $x = V y$。问题现在转化为寻找一个向量 $y^{\\star}$ 来最小化 $\\|\\Sigma y - c\\|_{2}$。\n\n对于我们的特定问题，$A \\in \\mathbb{R}^{3 \\times 2}$，所以 $x \\in \\mathbb{R}^{2}$ 和 $b \\in \\mathbb{R}^{3}$。SVD 中的矩阵维度为 $U \\in \\mathbb{R}^{3 \\times 3}$，$\\Sigma \\in \\mathbb{R}^{3 \\times 2}$ 和 $V \\in \\mathbb{R}^{2 \\times 2}$。向量 $y$ 和 $x$ 属于 $\\mathbb{R}^{2}$，而向量 $c$ 和 $b$ 属于 $\\mathbb{R}^{3}$。\n矩阵 $\\Sigma$ 的形式为：\n$$\n\\Sigma = \\begin{pmatrix} \\sigma_1  0 \\\\ 0  \\sigma_2 \\\\ 0  0 \\end{pmatrix}\n$$\n其中 $\\sigma_1$ 和 $\\sigma_2$ 是 $A$ 的奇异值。令 $y = \\begin{pmatrix} y_1 \\\\ y_2 \\end{pmatrix}$ 和 $c = \\begin{pmatrix} c_1 \\\\ c_2 \\\\ c_3 \\end{pmatrix}$。范数的平方为：\n$$\n\\|\\Sigma y - c\\|_{2}^{2} = \\left\\| \\begin{pmatrix} \\sigma_1 y_1 - c_1 \\\\ \\sigma_2 y_2 - c_2 \\\\ -c_3 \\end{pmatrix} \\right\\|_{2}^{2} = (\\sigma_1 y_1 - c_1)^2 + (\\sigma_2 y_2 - c_2)^2 + c_3^2\n$$\n为了最小化这个关于 $y_1$ 和 $y_2$ 的表达式，我们观察到项 $c_3^2$ 是一个常数。当且仅当头两项为零时，表达式达到最小值。由于给定的矩阵 $A$ 是满列秩 ($r=2$)，其奇异值 $\\sigma_1$ 和 $\\sigma_2$ 均非零。因此，我们可以设定：\n$$\n\\sigma_1 y_1 - c_1 = 0 \\implies y_1^{\\star} = \\frac{c_1}{\\sigma_1}\n$$\n$$\n\\sigma_2 y_2 - c_2 = 0 \\implies y_2^{\\star} = \\frac{c_2}{\\sigma_2}\n$$\n最优向量 $y^{\\star}$ 为 $\\begin{pmatrix} c_1/\\sigma_1 \\\\ c_2/\\sigma_2 \\end{pmatrix}$。这可以用 $\\Sigma$ 的 Moore-Penrose 伪逆来表示，记作 $\\Sigma^{+}$：\n$$\n\\Sigma^{+} = \\begin{pmatrix} 1/\\sigma_1  0  0 \\\\ 0  1/\\sigma_2  0 \\end{pmatrix}\n$$\n这样，$y^{\\star} = \\Sigma^{+} c$。最后，我们使用 $x = V y$ 转换回原始变量 $x$：\n$$\nx^{\\star} = V y^{\\star} = V \\Sigma^{+} c = V \\Sigma^{+} (U^\\top b) = (V \\Sigma^{+} U^\\top) b\n$$\n矩阵 $A^{+} = V \\Sigma^{+} U^\\top$ 是 $A$ 的 Moore-Penrose 伪逆。因此，最小二乘解是 $x^{\\star} = A^{+} b$。\n\n### 第二部分：误差放大因子的计算\n\n误差放大因子 $M$ 定义为解的相对误差与数据向量的相对误差之比的最大可能值，或者更具体地定义为 $M = \\sup_{\\delta b \\neq 0} \\frac{\\|\\delta x\\|_{2}}{\\|\\delta b\\|_{2}}$。\n最小二乘解 $x^{\\star}$ 是 $b$ 的一个线性函数，由 $x^{\\star}(b) = A^{+}b$ 给出。当 $b$ 受到一个量为 $\\delta b$ 的扰动时，新的解是 $x^{\\star}(b + \\delta b) = A^{+}(b + \\delta b)$。\n解的变化量 $\\delta x$ 为：\n$$\n\\delta x = x^{\\star}(b + \\delta b) - x^{\\star}(b) = A^{+}(b + \\delta b) - A^{+}b = A^{+}\\delta b\n$$\n将此代入 $M$ 的定义中：\n$$\nM = \\sup_{\\delta b \\neq 0} \\frac{\\|A^{+} \\delta b\\|_{2}}{\\|\\delta b\\|_{2}}\n$$\n这个表达式是矩阵 $A^{+}$ 的诱导 2-范数的定义，记作 $\\|A^{+}\\|_{2}$。任何矩阵的诱导 2-范数等于其最大奇异值。\n\n$A^{+}$ 的 SVD 由 $A^{+} = V \\Sigma^{+} U^\\top$ 给出。$A^{+}$ 的奇异值是 $\\Sigma^{+}$ 的非零对角元素。\n如果 $A$ 的非零奇异值是 $\\sigma_1 \\geq \\sigma_2 > 0$，那么 $A^{+}$ 的非零奇异值是 $1/\\sigma_1$ 和 $1/\\sigma_2$。由于 $\\sigma_1 \\geq \\sigma_2$，$A^{+}$ 的最大奇异值是 $\\max(1/\\sigma_1, 1/\\sigma_2) = 1/\\sigma_2$。一般来说，对于一个秩为 $r$ 的矩阵 $A$，其最小的非零奇异值为 $\\sigma_r$。$A^{+}$ 的最大奇异值为 $1/\\sigma_r$。\n因此，$M = \\|A^{+}\\|_{2} = 1/\\sigma_{\\min}(A)$，其中 $\\sigma_{\\min}(A)$ 是 $A$ 的最小非零奇异值。\n\n### 第三部分：应用于特定矩阵\n\n我们给定的矩阵是：\n$$\nA = \\begin{pmatrix}\n10^{3}  0 \\\\\n0  10^{-9} \\\\\n0  0\n\\end{pmatrix}\n$$\n$A$ 的奇异值是 $A^\\top A$ 的特征值的平方根。\n$$\nA^\\top A = \\begin{pmatrix}\n10^{3}  0  0 \\\\\n0  10^{-9}  0\n\\end{pmatrix}\n\\begin{pmatrix}\n10^{3}  0 \\\\\n0  10^{-9} \\\\\n0  0\n\\end{pmatrix}\n= \\begin{pmatrix}\n(10^{3})^2  0 \\\\\n0  (10^{-9})^2\n\\end{pmatrix}\n= \\begin{pmatrix}\n10^{6}  0 \\\\\n0  10^{-18}\n\\end{pmatrix}\n$$\n这个对角矩阵的特征值是 $\\lambda_1 = 10^{6}$ 和 $\\lambda_2 = 10^{-18}$。\n$A$ 的奇异值是 $\\sigma_1 = \\sqrt{\\lambda_1} = 10^{3}$ 和 $\\sigma_2 = \\sqrt{\\lambda_2} = 10^{-9}$。我们注意到，如果我们选择 $U=I_3$ 和 $V=I_2$，给定的矩阵 $A$ 已经是 SVD 矩阵 $\\Sigma$ 的形式。\n\n奇异值为 $\\sigma_1 = 10^{3}$ 和 $\\sigma_2 = 10^{-9}$。最小的非零奇异值是 $\\sigma_{\\min}(A) = 10^{-9}$。\n使用第二部分推导出的公式，误差放大因子 $M$ 为：\n$$\nM = \\frac{1}{\\sigma_{\\min}(A)} = \\frac{1}{10^{-9}} = 10^{9}\n$$", "answer": "$$\n\\boxed{10^{9}}\n$$", "id": "3583026"}, {"introduction": "正规方程为求解最小二乘问题提供了一条直接的代数路径，但对于病态问题，它在数值上可能十分危险。本练习对SVD方法和正规方程方法进行了鲜明的比较。通过分析两种方法的条件数并推导前向误差界，你将量化地理解为何构建矩阵 $A^\\top A$ 会急剧降低精度，从而巩固SVD方法具有卓越稳定性的论点。[@problem_id:3583055]", "problem": "考虑由矩阵 $A \\in \\mathbb{R}^{2 \\times 2}$ 和右侧向量 $b \\in \\mathbb{R}^{2}$ 构成的超定最小二乘问题，其中：\n$$\nA \\;=\\; \\begin{pmatrix}\n1  1 \\\\\n0  \\varepsilon\n\\end{pmatrix},\n\\qquad\nb \\;=\\; \\begin{pmatrix}\n1 \\\\ \\varepsilon/2\n\\end{pmatrix},\n\\qquad\n\\varepsilon \\;=\\; 10^{-8}.\n$$\n您将分析求解最小二乘问题 $\\min_{x \\in \\mathbb{R}^{2}} \\|Ax-b\\|_{2}$ 的两种算法，并量化由于条件作用和舍入误差导致的精度差异。\n\n请基于以下基本原理进行分析：\n- 奇异值分解（SVD）作为一种实矩阵的分解，可以揭示其奇异值。\n- 对于可逆矩阵 $A$，谱（二范数）条件数 $\\kappa_{2}(A) \\equiv \\|A\\|_{2}\\|A^{-1}\\|_{2}$ 的定义，以及 $\\|A\\|_{2}$ 是最大奇异值。\n- 标准浮点模型，其单位舍入误差 $u$ 定义为 $fl(a \\,\\mathrm{op}\\, b) = (a \\,\\mathrm{op}\\, b)(1+\\delta)$，其中 $|\\delta| \\le u$，$u = 2^{-53}$ 对应于 IEEE 754 双精度。\n\n任务：\n1. 论证对于给定的数据，为什么最小二乘解与 $Ax=b$ 的精确解重合，并求出精确解 $x_{\\star}$。\n2. 通过分析 $A^{\\top}A$ 的特征值来计算 $A$ 的奇异值，并由此计算谱条件数 $\\kappa_{2}(A)$ 的精确符号表达式（作为 $\\varepsilon$ 的函数）。然后，当 $\\varepsilon = 10^{-8}$ 时，计算其数值。\n3. 以 $\\kappa_{2}(A)$ 的形式确定法方程矩阵 $A^{\\top}A$ 的谱条件数，并根据 $A^{\\top}A$ 的谱特性证明您的结论。\n4. 使用标准浮点模型下的一阶微扰分析以及适用于以下方法的范数反向稳定性假设：\n   - 基于奇异值分解（SVD）的求解器，\n   - 一个先构建法方程然后使用反向稳定的 Cholesky 分解的求解器，\n推导计算解的前导阶相对前向误差界，用 $\\kappa_{2}(A)$、$\\kappa_{2}(A^{\\top}A)$ 和 $u$ 表示。\n5. 对于给定的 $A$、$\\varepsilon = 10^{-8}$ 和 $u = 2^{-53}$，对这些界进行数值评估。作为最终答案，报告基于法方程方法预测的前导阶相对前向误差界的数值。将最终数值答案四舍五入到三位有效数字。", "solution": "问题要求分析用给定的矩阵 $A$ 和向量 $b$ 求解最小二乘问题 $\\min_{x \\in \\mathbb{R}^{2}} \\|Ax-b\\|_{2}$ 的两种方法。\n\n任务1：论证为何最小二乘解与 $Ax=b$ 的精确解重合，并求出此解。\n给定的矩阵是 $A = \\begin{pmatrix} 1  1 \\\\ 0  \\varepsilon \\end{pmatrix}$，这是一个 $2 \\times 2$ 的方阵。其行列式为 $\\det(A) = (1)(\\varepsilon) - (1)(0) = \\varepsilon$。由于 $\\varepsilon = 10^{-8} \\neq 0$，矩阵 $A$ 是可逆的。\n对于一个可逆矩阵 $A$，线性系统 $Ax=b$ 有唯一解 $x_{\\star} = A^{-1}b$。如果我们将这个解代入最小二乘问题的目标函数，我们得到 $\\|Ax_{\\star}-b\\|_{2} = \\|A(A^{-1}b)-b\\|_{2} = \\|b-b\\|_{2} = \\|0\\|_{2} = 0$。\n范数 $\\|Ax-b\\|_{2}$ 总是非负的。既然我们找到了一个向量 $x_{\\star}$ 使得范数为 $0$，这就是可能的最小值。因此，最小二乘问题的唯一解与线性系统 $Ax=b$ 的唯一解相同。\n我们通过求解以下系统来找到这个解 $x_{\\star} = \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix}$：\n$$\n\\begin{pmatrix}\n1  1 \\\\\n0  \\varepsilon\n\\end{pmatrix}\n\\begin{pmatrix}\nx_1 \\\\\nx_2\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1 \\\\\n\\varepsilon/2\n\\end{pmatrix}\n$$\n这是一个上三角系统，可以通过回代求解。从第二行，我们有 $\\varepsilon x_2 = \\varepsilon/2$，这意味着 $x_2 = 1/2$。\n将此代入第一行方程 $x_1 + x_2 = 1$，我们得到 $x_1 + 1/2 = 1$，这给出 $x_1 = 1/2$。\n因此，精确解为 $x_{\\star} = \\begin{pmatrix} 1/2 \\\\ 1/2 \\end{pmatrix}$。\n\n任务2：计算奇异值和谱条件数 $\\kappa_{2}(A)$。\n$A$ 的奇异值，记为 $\\sigma_i$，是矩阵 $A^{\\top}A$ 特征值的平方根。\n$$\nA^\\top = \\begin{pmatrix} 1  0 \\\\ 1  \\varepsilon \\end{pmatrix}\n$$\n$$\nA^\\top A = \\begin{pmatrix} 1  0 \\\\ 1  \\varepsilon \\end{pmatrix} \\begin{pmatrix} 1  1 \\\\ 0  \\varepsilon \\end{pmatrix} = \\begin{pmatrix} 1  1 \\\\ 1  1+\\varepsilon^2 \\end{pmatrix}\n$$\n$A^\\top A$ 的特征值 $\\lambda$ 是特征方程 $\\det(A^\\top A - \\lambda I) = 0$ 的根。\n$$\n\\det \\begin{pmatrix} 1-\\lambda  1 \\\\ 1  1+\\varepsilon^2-\\lambda \\end{pmatrix} = (1-\\lambda)(1+\\varepsilon^2-\\lambda) - 1 = 0\n$$\n$$\n\\lambda^2 - (2+\\varepsilon^2)\\lambda + (1+\\varepsilon^2) - 1 = 0\n$$\n$$\n\\lambda^2 - (2+\\varepsilon^2)\\lambda + \\varepsilon^2 = 0\n$$\n使用二次方程求根公式解 $\\lambda$：\n$$\n\\lambda = \\frac{(2+\\varepsilon^2) \\pm \\sqrt{(2+\\varepsilon^2)^2 - 4\\varepsilon^2}}{2} = \\frac{2+\\varepsilon^2 \\pm \\sqrt{4+4\\varepsilon^2+\\varepsilon^4 - 4\\varepsilon^2}}{2} = \\frac{2+\\varepsilon^2 \\pm \\sqrt{4+\\varepsilon^4}}{2}\n$$\n$A^\\top A$ 的特征值是 $\\lambda_1 = \\sigma_1^2$ 和 $\\lambda_2 = \\sigma_2^2$，其中 $\\sigma_1 \\ge \\sigma_2$。\n$$\n\\sigma_1^2 = \\frac{2+\\varepsilon^2 + \\sqrt{4+\\varepsilon^4}}{2}, \\qquad \\sigma_2^2 = \\frac{2+\\varepsilon^2 - \\sqrt{4+\\varepsilon^4}}{2}\n$$\n奇异值为 $\\sigma_1 = \\sqrt{\\frac{2+\\varepsilon^2 + \\sqrt{4+\\varepsilon^4}}{2}}$ 和 $\\sigma_2 = \\sqrt{\\frac{2+\\varepsilon^2 - \\sqrt{4+\\varepsilon^4}}{2}}$。\n谱条件数为 $\\kappa_2(A) = \\frac{\\sigma_1}{\\sigma_2} = \\sqrt{\\frac{\\sigma_1^2}{\\sigma_2^2}} = \\sqrt{\\frac{2+\\varepsilon^2 + \\sqrt{4+\\varepsilon^4}}{2+\\varepsilon^2 - \\sqrt{4+\\varepsilon^4}}}$。\n为简化，将平方根内的分子和分母同乘以分母的共轭项：\n$$\n\\kappa_2(A)^2 = \\frac{(2+\\varepsilon^2 + \\sqrt{4+\\varepsilon^4})^2}{(2+\\varepsilon^2)^2 - (4+\\varepsilon^4)} = \\frac{(2+\\varepsilon^2 + \\sqrt{4+\\varepsilon^4})^2}{4+4\\varepsilon^2+\\varepsilon^4 - 4 - \\varepsilon^4} = \\frac{(2+\\varepsilon^2 + \\sqrt{4+\\varepsilon^4})^2}{4\\varepsilon^2}\n$$\n取平方根得到精确的符号形式：\n$$\n\\kappa_2(A) = \\frac{2+\\varepsilon^2 + \\sqrt{4+\\varepsilon^4}}{2\\varepsilon}\n$$\n对于 $\\varepsilon = 10^{-8}$，$\\varepsilon^2=10^{-16}$ 和 $\\varepsilon^4=10^{-32}$ 非常小。我们可以近似 $\\sqrt{4+\\varepsilon^4} = 2\\sqrt{1+\\varepsilon^4/4} \\approx 2$。因此，$\\kappa_2(A) \\approx \\frac{2+0+2}{2\\varepsilon} = \\frac{2}{\\varepsilon}$。\n对于 $\\varepsilon=10^{-8}$，数值上：\n$$\n\\kappa_2(A) = \\frac{2+10^{-16} + \\sqrt{4+10^{-32}}}{2 \\times 10^{-8}} \\approx \\frac{4}{2 \\times 10^{-8}} = 2 \\times 10^8\n$$\n\n任务3：确定 $A^\\top A$ 的谱条件数。\n设 $A$ 的奇异值分解为 $A=U\\Sigma V^\\top$，其中 $U$ 和 $V$ 是正交矩阵，$\\Sigma = \\mathrm{diag}(\\sigma_1, \\sigma_2)$。\n则 $A^\\top A = (U\\Sigma V^\\top)^\\top (U\\Sigma V^\\top) = V\\Sigma^\\top U^\\top U \\Sigma V^\\top = V(\\Sigma^\\top \\Sigma)V^\\top$。\n由于 $V$ 是正交的，这是一个相似变换，$A^\\top A$ 的特征值是 $\\Sigma^\\top \\Sigma = \\mathrm{diag}(\\sigma_1^2, \\sigma_2^2)$ 的对角元素。\n矩阵 $A^\\top A$ 是对称正定的。它的谱范数是其最大特征值，即 $\\|A^\\top A\\|_2 = \\sigma_1^2 = \\|A\\|_2^2$。\n其逆矩阵为 $(A^\\top A)^{-1} = V(\\Sigma^\\top\\Sigma)^{-1}V^\\top = V \\mathrm{diag}(1/\\sigma_1^2, 1/\\sigma_2^2) V^\\top$。\n逆矩阵的谱范数是其最大特征值，即 $1/\\sigma_2^2$。所以，$\\|(A^\\top A)^{-1}\\|_2 = 1/\\sigma_2^2 = \\|A^{-1}\\|_2^2$。\n因此，$A^\\top A$ 的条件数为：\n$$\n\\kappa_2(A^\\top A) = \\|A^\\top A\\|_2 \\|(A^\\top A)^{-1}\\|_2 = (\\sigma_1^2) \\left(\\frac{1}{\\sigma_2^2}\\right) = \\left(\\frac{\\sigma_1}{\\sigma_2}\\right)^2 = (\\kappa_2(A))^2\n$$\n这个关系式 $\\kappa_2(A^\\top A) = \\kappa_2(A)^2$ 是一个普遍性质。\n\n任务4：推导前导阶相对前向误差界。\n我们分析计算解 $\\hat{x}$ 的前向误差 $\\frac{\\|\\hat{x}-x_{\\star}\\|_2}{\\|x_{\\star}\\|_2}$。\nA) 基于SVD的求解器：使用SVD求解最小二乘问题（或在本例中，方阵线性系统 $Ax=b$）是一种范数意义上的反向稳定方法。这意味着计算解 $\\hat{x}_{SVD}$ 是一个微扰问题 $(A+\\Delta A)\\hat{x}_{SVD} = b+\\Delta b$ 的精确解，其中 $\\|\\Delta A\\|_2 \\le c_1 u \\|A\\|_2$ 和 $\\|\\Delta b\\|_2 \\le c_2 u \\|b\\|_2$，$c_1, c_2$ 是小常数，$u$ 是单位舍入误差。\n线性系统的标准微扰理论给出了一阶前向误差界：\n$$\n\\frac{\\|\\hat{x}_{SVD}-x_{\\star}\\|_2}{\\|x_{\\star}\\|_2} \\le u \\kappa_2(A) \\left(c_1 + c_2\\frac{\\|b\\|_2}{\\|A\\|_2\\|x_\\star\\|_2}\\right) + O(u^2)\n$$\n对于前导阶分析，我们考虑主导项。通常表示为：\n$$\n\\frac{\\|\\hat{x}_{SVD}-x_{\\star}\\|_2}{\\|x_{\\star}\\|_2} \\approx C_{SVD} u \\kappa_2(A)\n$$\n其中 $C_{SVD}$ 是一个与问题维度和算法细节相关的 $O(1)$ 数量级的适度常数。\n\nB) 法方程求解器：此方法包括两个步骤：\n1. 构建矩阵 $C = A^\\top A$ 和向量 $d = A^\\top b$。\n2. 使用 Cholesky 分解求解系统 $Cx=d$。\n关键的误差来源是 $A^\\top A$ 的构建过程。该计算会受到舍入误差的影响，因此我们计算的是 $\\hat{C} = fl(A^\\top A) = A^\\top A + E_C$。误差 $E_C$ 的界为 $\\|E_C\\|_2 \\le \\gamma_{n} \\|A^\\top\\|_2 \\|A\\|_2 = \\gamma_{n} \\|A\\|_2^2$，其中 $\\gamma_{n} = \\frac{nu}{1-nu}$。\n然后使用反向稳定的方法（Cholesky）求解计算得到的系统，这会引入进一步的小微扰。然而，主导误差来自于 $\\hat{C}$ 的初始计算。待解系统矩阵的相对误差约为 $\\frac{\\|E_C\\|_2}{\\|A^\\top A\\|_2} \\approx \\frac{c u \\|A\\|_2^2}{\\|A\\|_2^2} = c u$。\n求解 $Cx=d$ 的前向误差由其条件数乘以反向误差为界。起决定作用的条件数是法方程矩阵 $C = A^\\top A$ 的条件数。\n$$\n\\frac{\\|\\hat{x}_{NE}-x_{\\star}\\|_2}{\\|x_{\\star}\\|_2} \\approx C_{NE} u \\kappa_2(A^\\top A)\n$$\n使用任务3的结果，我们得到前导阶界：\n$$\n\\frac{\\|\\hat{x}_{NE}-x_{\\star}\\|_2}{\\|x_{\\star}\\|_2} \\approx C_{NE} u \\kappa_2(A)^2\n$$\n其中 $C_{NE}$ 是一个一阶常数。条件数的平方是使该方法对于病态矩阵在数值上不稳定的关键特征。\n\n任务5：对误差界进行数值评估。\n给定 $\\varepsilon = 10^{-8}$ 和 $u = 2^{-53}$。\n根据任务2，$\\kappa_2(A) \\approx 2/\\varepsilon = 2 \\times 10^8$。\n根据任务3，$\\kappa_2(A^\\top A) = \\kappa_2(A)^2 \\approx (2 \\times 10^8)^2 = 4 \\times 10^{16}$。\n对于前导阶分析，通常将常数 $C_{SVD}$ 和 $C_{NE}$ 设为 $1$，以便关注与条件数相关的缩放效应。\nSVD方法预测的前导阶相对前向误差界为：\n$$\n\\text{Error}_{SVD} \\approx u \\kappa_2(A) \\approx (2^{-53})(2 \\times 10^8) \\approx (1.1102 \\times 10^{-16})(2 \\times 10^8) \\approx 2.22 \\times 10^{-8}\n$$\n这表明大约损失了8位十进制数字的精度。\n法方程方法预测的前导阶相对前向误差界为：\n$$\n\\text{Error}_{NE} \\approx u \\kappa_2(A^\\top A) = u \\kappa_2(A)^2 \\approx (2^{-53})(4 \\times 10^{16})\n$$\n使用 $u \\approx 1.110223 \\times 10^{-16}$：\n$$\n\\text{Error}_{NE} \\approx (1.110223 \\times 10^{-16})(4 \\times 10^{16}) = 4.440892\n$$\n如此量级（大于1）的误差界表明，计算出的解预计没有任何正确的有效数字。\n问题要求给出法方程方法的此误差界的数值，并四舍五入到三位有效数字。\n$4.440892 \\approx 4.44$。", "answer": "$$\n\\boxed{4.44}\n$$", "id": "3583055"}]}