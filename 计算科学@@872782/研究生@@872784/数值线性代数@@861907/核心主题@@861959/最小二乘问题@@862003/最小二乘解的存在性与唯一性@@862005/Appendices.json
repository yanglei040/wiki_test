{"hands_on_practices": [{"introduction": "要真正掌握最小二乘问题，必须从其最基本的定义出发。这个练习将引导你通过多变量微积分，从最小化残差范数的平方这一目标函数，亲手推导出正规方程。通过分析一个具体的秩亏缺矩阵 [@problem_id:3544780]，你将直接看到其如何导致正规方程的系数矩阵 $A^{\\mathsf{T}}A$ 奇异，从而揭示解集非唯一性的根源。", "problem": "考虑欧几里得空间 $ \\mathbb{R}^3 $ 中的以下显式构造。设\n$$\nA \\in \\mathbb{R}^{3 \\times 2}, \\quad A \\;=\\; \\begin{pmatrix}\n1  2 \\\\\n2  4 \\\\\n3  6\n\\end{pmatrix}, \\qquad b \\in \\mathbb{R}^3, \\quad b \\;=\\; \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}.\n$$\n目标是通过从第一性原理出发进行推理，分析线性系统 $ A x \\approx b $ 的最小二乘解的存在性和唯一性。\n\n任务：\n1. 从最小二乘解是函数 $ f(x) = \\| b - A x \\|_{2}^{2} $ 的极小化子的定义出发，推导将 $ f $ 的平稳性与一个关于 $ x $ 的代数方程组联系起来的必要且充分的最优性条件。不要假设任何预先给定的公式；仅使用多元微积分和转置的基本性质来推导该条件。\n2. 计算 $ A^{\\mathsf{T}} A $ 并从第一性原理证明它是奇异的。解释这种奇异性对任务1中推导出的代数方程组的解集（包括存在性和唯一性）的影响。给出这个显式实例中完整解集的一般形式。\n3. 解释为什么即使 $ A^{\\mathsf{T}} A $ 是奇异的，该实例中最小二乘极小化子仍然存在。在所有最小二乘极小化子中，找出具有最小欧几里得范数的唯一极小化子，并通过从第一性原理出发的显式计算来证明你的选择。\n4. 计算在所有 $ x \\in \\mathbb{R}^{2} $ 上 $ \\| b - A x \\|_{2}^{2} $ 的最小可能值。将你的最终答案表示为一个精确的有理数。无需四舍五入。\n\n你的最终回答应为任务4所要求的单个数值。不要包含单位。", "solution": "这个问题是适定的，并为分析秩亏最小二乘问题提供了一个有效的框架。所有必要的数据都已给出，且任务结构逻辑清晰。我们开始进行解答。\n\n核心任务是找到一个向量 $x \\in \\mathbb{R}^2$，使得残差 $r = b - Ax$ 的欧几里得范数的平方最小，其中\n$$\nA \\;=\\; \\begin{pmatrix}\n1  2 \\\\\n2  4 \\\\\n3  6\n\\end{pmatrix}, \\qquad b \\;=\\; \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}.\n$$\n需要最小化的函数是 $f(x) = \\| b - Ax \\|_{2}^{2}$。\n\n**1. 最优性条件（正规方程）的推导**\n\n最小二乘解 $x$ 是函数 $f(x)$ 的极小化子。我们首先使用欧几里得范数的点积定义来表示 $f(x)$：\n$$\nf(x) = \\| b - Ax \\|_{2}^{2} = (b - Ax)^{\\mathsf{T}} (b - Ax)\n$$\n展开乘积，我们得到：\n$$\nf(x) = (b^{\\mathsf{T}} - x^{\\mathsf{T}}A^{\\mathsf{T}})(b - Ax) = b^{\\mathsf{T}}b - b^{\\mathsf{T}}Ax - x^{\\mathsf{T}}A^{\\mathsf{T}}b + x^{\\mathsf{T}}A^{\\mathsf{T}}Ax\n$$\n由于 $b^{\\mathsf{T}}Ax$ 是一个标量（$1 \\times 1$ 矩阵），它等于其自身的转置：$(b^{\\mathsf{T}}Ax)^{\\mathsf{T}} = x^{\\mathsf{T}}A^{\\mathsf{T}}b$。因此，这两个交叉项是相同的。函数变为：\n$$\nf(x) = x^{\\mathsf{T}}(A^{\\mathsf{T}}A)x - 2b^{\\mathsf{T}}Ax + b^{\\mathsf{T}}b\n$$\n这是一个关于向量变量 $x$ 的二次函数。取得最小值的必要条件是 $f(x)$ 关于 $x$ 的梯度为零向量。我们计算梯度 $\\nabla_x f(x)$：\n$$\n\\nabla_x f(x) = \\nabla_x (x^{\\mathsf{T}}A^{\\mathsf{T}}Ax) - \\nabla_x (2b^{\\mathsf{T}}Ax) + \\nabla_x (b^{\\mathsf{T}}b)\n$$\n使用标准的矩阵微积分恒等式 $\\nabla_x(x^{\\mathsf{T}}Mx) = (M+M^{\\mathsf{T}})x$ 和 $\\nabla_x(c^{\\mathsf{T}}x) = c$，我们有：\n- 对于二次项，矩阵 $M = A^{\\mathsf{T}}A$ 是对称的，所以 $M^{\\mathsf{T}}=M$。因此，$\\nabla_x(x^{\\mathsf{T}}A^{\\mathsf{T}}Ax) = 2A^{\\mathsf{T}}Ax$。\n- 对于线性项，$2b^{\\mathsf{T}}Ax = 2(A^{\\mathsf{T}}b)^{\\mathsf{T}}x$。因此，$\\nabla_x(2b^{\\mathsf{T}}Ax) = 2A^{\\mathsf{T}}b$。\n- 项 $b^{\\mathsf{T}}b$ 相对于 $x$ 是常数，所以其梯度为零。\n\n结合这些结果，梯度为：\n$$\n\\nabla_x f(x) = 2A^{\\mathsf{T}}Ax - 2A^{\\mathsf{T}}b\n$$\n将梯度设为零，得到平稳条件：\n$$\n2A^{\\mathsf{T}}Ax - 2A^{\\mathsf{T}}b = 0 \\quad \\implies \\quad A^{\\mathsf{T}}Ax = A^{\\mathsf{T}}b\n$$\n这个线性方程组被称为**正规方程**。为了确认该方程组的解对应于一个最小值，我们考察 $f(x)$ 的海森矩阵，即 $\\nabla_x^2 f(x) = 2A^{\\mathsf{T}}A$。对于任意向量 $v \\in \\mathbb{R}^2$，与海森矩阵相关的二次型为 $v^{\\mathsf{T}}(2A^{\\mathsf{T}}A)v = 2(Av)^{\\mathsf{T}}(Av) = 2\\|Av\\|_2^2 \\ge 0$。这表明海森矩阵是半正定的。由于 $f(x)$ 是一个二次函数，这保证了正规方程的任何解都是 $f(x)$ 的全局极小化子。\n\n**2. 矩阵 $A^{\\mathsf{T}}A$ 与解集的分析**\n\n首先，我们计算矩阵 $A^{\\mathsf{T}}A$：\n$$\nA^{\\mathsf{T}} = \\begin{pmatrix} 1  2  3 \\\\ 2  4  6 \\end{pmatrix}\n$$\n$$\nA^{\\mathsf{T}}A = \\begin{pmatrix} 1  2  3 \\\\ 2  4  6 \\end{pmatrix} \\begin{pmatrix} 1  2 \\\\ 2  4 \\\\ 3  6 \\end{pmatrix} = \\begin{pmatrix} 1 \\cdot 1 + 2 \\cdot 2 + 3 \\cdot 3  1 \\cdot 2 + 2 \\cdot 4 + 3 \\cdot 6 \\\\ 2 \\cdot 1 + 4 \\cdot 2 + 6 \\cdot 3  2 \\cdot 2 + 4 \\cdot 4 + 6 \\cdot 6 \\end{pmatrix} = \\begin{pmatrix} 14  28 \\\\ 28  56 \\end{pmatrix}\n$$\n为了证明 $A^{\\mathsf{T}}A$ 是奇异的，我们计算它的行列式：\n$$\n\\det(A^{\\mathsf{T}}A) = (14)(56) - (28)(28) = 784 - 784 = 0\n$$\n由于行列式为零，所以 $A^{\\mathsf{T}}A$ 是奇异的。这种奇异性是因为 $A$ 的列是线性相关的：第二列是第一列的两倍。这意味着 $\\text{rank}(A) = 1$，小于列数（2）。由于 $\\text{rank}(A^{\\mathsf{T}}A) = \\text{rank}(A)$，矩阵 $A^{\\mathsf{T}}A$ 也是秩亏的，因此是奇异的。\n\n$A^{\\mathsf{T}}A$ 的奇异性意味着它的零空间是非平凡的。如果正规方程有解，那么它们必定有无穷多个解。$A^{\\mathsf{T}}Ax = A^{\\mathsf{T}}b$ 的解存在的充分必要条件是 $A^{\\mathsf{T}}b$ 位于 $A^{\\mathsf{T}}A$ 的列空间中。根据线性代数基本定理，$\\mathcal{R}(A^{\\mathsf{T}}A) = \\mathcal{R}(A^{\\mathsf{T}})$。由于根据定义 $A^{\\mathsf{T}}b$ 就在 $A^{\\mathsf{T}}$ 的值域中，所以解总是存在的。\n\n我们来解这个方程组。首先，计算右侧项 $A^{\\mathsf{T}}b$：\n$$\nA^{\\mathsf{T}}b = \\begin{pmatrix} 1  2  3 \\\\ 2  4  6 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}\n$$\n正规方程为：\n$$\n\\begin{pmatrix} 14  28 \\\\ 28  56 \\end{pmatrix} \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}\n$$\n该方程组的第二行（$28x_1 + 56x_2 = 2$）恰好是第一行（$14x_1 + 28x_2 = 1$）的两倍，因此该系统是冗余的，只包含一个独立的方程：\n$$\n14x_1 + 28x_2 = 1 \\quad \\text{或} \\quad x_1 + 2x_2 = \\frac{1}{14}\n$$\n这个方程在 $\\mathbb{R}^2$ 中定义了一条直线。为了找到通解，我们刻画 $A$ 的零空间。一个向量 $x_h = (x_1, x_2)^{\\mathsf{T}}$ 在 $\\mathcal{N}(A)$ 中，如果 $Ax_h = 0$，这得到 $x_1 + 2x_2 = 0$。零空间由向量 $v_h = \\begin{pmatrix} 2 \\\\ -1 \\end{pmatrix}$ 生成。\n我们来找一个特解 $x_p$。如果我们设 $x_2=0$，那么 $x_1 = 1/14$。所以，$x_p = (1/14, 0)^{\\mathsf{T}}$。\n通解集是仿射直线 $x = x_p + k v_h$，其中 $k \\in \\mathbb{R}$ 是任意标量：\n$$\nx(k) = \\begin{pmatrix} 1/14 \\\\ 0 \\end{pmatrix} + k \\begin{pmatrix} 2 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} 1/14 + 2k \\\\ -k \\end{pmatrix}\n$$\n\n**3. 存在性与最小范数唯一极小化子**\n\n如上所示，正规方程的解总是存在的，因为 $A^{\\mathsf{T}}b \\in \\mathcal{R}(A^{\\mathsf{T}}A)$。任何这样的解都是一个最小二乘极小化子。解的非唯一性源于 $A$ 的秩亏。\n\n在无穷多个极小化子中，存在一个具有最小欧几里得范数的唯一解。这个解，记为 $x_{LS}$，是完全位于 $A$ 的行空间中的那一个，而行空间是 $A$ 的零空间的正交补。任何最小二乘解 $x$ 都可以唯一地分解为 $x = x_{row} + x_{null}$，其中 $x_{row} \\in \\mathcal{R}(A^T)$ 且 $x_{null} \\in \\mathcal{N}(A)$。那么 $\\|x\\|_2^2 = \\|x_{row}\\|_2^2 + \\|x_{null}\\|_2^2$。当 $x_{null}=0$ 时，即 $x=x_{row}$ 时，该范数最小化。\n\n$A$ 的行空间由向量 $\\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}$ 生成。因此，最小范数解 $x_{LS}$ 必须具有以下形式：\n$$\nx_{LS} = c \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} c \\\\ 2c \\end{pmatrix}\n$$\n其中 $c$ 是某个标量。由于 $x_{LS}$ 必须是一个最小二乘解，它必须满足正规方程 $x_1 + 2x_2 = 1/14$。代入 $x_{LS}$ 的分量：\n$$\n(c) + 2(2c) = \\frac{1}{14} \\implies 5c = \\frac{1}{14} \\implies c = \\frac{1}{70}\n$$\n因此，具有最小欧几里得范数的唯一极小化子是：\n$$\nx_{LS} = \\frac{1}{70} \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} 1/70 \\\\ 2/70 \\end{pmatrix}\n$$\n\n**4. 最小残差范数的计算**\n\n$\\|b - Ax\\|_2^2$ 的最小值对于任何最小二乘极小化子 $x$ 都是可以达到的。我们可以使用最小范数解 $x_{LS}$ 来进行此计算。首先，我们计算 $b$ 在 $A$ 的列空间上的投影，即 $p = Ax_{LS}$：\n$$\np = A x_{LS} = \\begin{pmatrix} 1  2 \\\\ 2  4 \\\\ 3  6 \\end{pmatrix} \\begin{pmatrix} 1/70 \\\\ 2/70 \\end{pmatrix} = \\frac{1}{70} \\begin{pmatrix} 1(1) + 2(2) \\\\ 2(1) + 4(2) \\\\ 3(1) + 6(2) \\end{pmatrix} = \\frac{1}{70} \\begin{pmatrix} 5 \\\\ 10 \\\\ 15 \\end{pmatrix} = \\frac{5}{70} \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix} = \\frac{1}{14} \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix}\n$$\n残差向量为 $r = b - p = b - Ax_{LS}$：\n$$\nr = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} - \\frac{1}{14} \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix} = \\begin{pmatrix} 1 - 1/14 \\\\ 0 - 2/14 \\\\ 0 - 3/14 \\end{pmatrix} = \\begin{pmatrix} 13/14 \\\\ -2/14 \\\\ -3/14 \\end{pmatrix} = \\frac{1}{14} \\begin{pmatrix} 13 \\\\ -2 \\\\ -3 \\end{pmatrix}\n$$\n范数平方的最小值为 $\\|r\\|_2^2$：\n$$\n\\|b - Ax\\|_2^2 = \\left\\| \\frac{1}{14} \\begin{pmatrix} 13 \\\\ -2 \\\\ -3 \\end{pmatrix} \\right\\|_2^2 = \\left(\\frac{1}{14}\\right)^2 \\left( 13^2 + (-2)^2 + (-3)^2 \\right)\n$$\n$$\n\\|b - Ax\\|_2^2 = \\frac{1}{196} (169 + 4 + 9) = \\frac{182}{196}\n$$\n化简该分数：\n$$\n\\frac{182}{196} = \\frac{91 \\times 2}{98 \\times 2} = \\frac{91}{98} = \\frac{13 \\times 7}{14 \\times 7} = \\frac{13}{14}\n$$\n因此，$\\|b - Ax\\|_2^2$ 的最小可能值是 $13/14$。", "answer": "$$\n\\boxed{\\frac{13}{14}}\n$$", "id": "3544780"}, {"introduction": "最小二乘法的核心思想具有深刻的几何意义，即在矩阵 $A$ 的列空间中寻找与向量 $b$ 最接近的点。本练习旨在深化你对这一几何本质的理解 [@problem_id:3544806]。你将首先探讨当 $b$ 本身就在 $A$ 的列空间中时的理想情况（残差为零），然后通过一个微小的扰动将 $b$ 移出该空间，观察解集的结构如何保持不变，而最小残差又如何产生。", "problem": "设 $A \\in \\mathbb{R}^{3 \\times 4}$，$b \\in \\mathbb{R}^{3}$，以及 $x \\in \\mathbb{R}^{4}$，在 $\\mathbb{R}^{3}$ 上使用标准的欧几里得内积。考虑最小二乘 (LS) 问题，即最小化映射 $x \\mapsto \\|b - A x\\|_{2}^{2}$。令\n$$\nA \\;=\\; \\begin{pmatrix}\n1  0  1  0 \\\\\n0  1  0  1 \\\\\n0  0  0  0\n\\end{pmatrix}, \\qquad b_{0} \\;=\\; \\begin{pmatrix} 3 \\\\ -1 \\\\ 0 \\end{pmatrix}, \\qquad x_{0} \\;=\\; \\begin{pmatrix} 3 \\\\ -1 \\\\ 0 \\\\ 0 \\end{pmatrix}.\n$$\n你可以假设零空间 $\\mathcal{N}(A)$ 是非平凡的，并且值域 $\\operatorname{Range}(A)$ 是 $\\mathbb{R}^{3}$ 的一个真子空间。请从第一性原理出发：从欧几里得内积空间中最小二乘问题的定义和基本的正交概念开始；不要套用任何现成的投影公式。\n\n1. 严格证明 $b_{0} \\in \\operatorname{Range}(A)$，最小二乘残差达到零，并且对于 $b_{0}$，最小二乘最小化子的完整解集具有形式 $x_{0} + \\mathcal{N}(A)$。\n\n2. 设 $\\delta  0$ 并考虑对右侧项的扰动 $b_{\\delta} = b_{0} + \\delta u$，其中\n$$\nu \\;=\\; \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}.\n$$\n从第一性原理出发，推导对于 $b_{\\delta}$，最小二乘最小化子集是非唯一的，而最小二乘残差向量是唯一的。确定这个唯一残差向量的欧几里得范数，作为 $\\delta$ 的显式函数。\n\n你的最终答案必须是针对扰动系统 $b_{\\delta}$ 的唯一残差向量的欧几里得范数的单个闭式解析表达式。无需四舍五入，也无单位适用。", "solution": "问题陈述已经过验证，是自洽的、科学上基于线性代数的，且是适定的。所有提供的数据和假设都是一致的。\n\n最小二乘 (LS) 问题是找到一个向量 $x \\in \\mathbb{R}^{4}$，对于给定的矩阵 $A \\in \\mathbb{R}^{3 \\times 4}$ 和向量 $b \\in \\mathbb{R}^{3}$，该向量能够最小化残差向量的欧几里得范数的平方，即 $f(x) = \\|b - A x\\|_{2}^{2}$。\n\n首先我们来刻画与矩阵 $A$ 相关的基本子空间。\n矩阵 $A$ 由下式给出\n$$\nA = \\begin{pmatrix}\n1  0  1  0 \\\\\n0  1  0  1 \\\\\n0  0  0  0\n\\end{pmatrix}\n$$\n$A$ 的值域，记作 $\\operatorname{Range}(A)$，是由 $A$ 的列向量张成的 $\\mathbb{R}^{3}$ 的子空间。设列向量为 $c_1, c_2, c_3, c_4$。\n$$\nc_1 = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}, \\ c_2 = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}, \\ c_3 = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}, \\ c_4 = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}\n$$\n我们观察到 $c_3 = c_1$ 且 $c_4 = c_2$。因此，$\\operatorname{Range}(A)$ 由线性无关的向量 $c_1$ 和 $c_2$ 张成。\n$$\n\\operatorname{Range}(A) = \\operatorname{span}\\left\\{ \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}, \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} \\right\\}\n$$\n该子空间是 $\\mathbb{R}^{3}$ 中的 $xy$-平面，是 $\\mathbb{R}^{3}$ 的一个二维真子空间，这证实了问题的假设。\n\n$A$ 的零空间，记作 $\\mathcal{N}(A)$，由所有满足 $Av = 0$ 的向量 $v \\in \\mathbb{R}^{4}$ 组成。设 $v = (v_1, v_2, v_3, v_4)^T$。条件 $Av=0$ 可转化为以下线性方程组：\n$$\nv_1 + v_3 = 0 \\\\\nv_2 + v_4 = 0\n$$\n这意味着 $v_1 = -v_3$ 和 $v_2 = -v_4$。我们可以通过将自由变量 $v_3$ 和 $v_4$ 设置为一组基，来将 $\\mathcal{N}(A)$ 中的任意向量 $v$ 表示为两个基向量的线性组合。设 $v_3=s$ 和 $v_4=t$。\n$$\nv = \\begin{pmatrix} -s \\\\ -t \\\\ s \\\\ t \\end{pmatrix} = s \\begin{pmatrix} -1 \\\\ 0 \\\\ 1 \\\\ 0 \\end{pmatrix} + t \\begin{pmatrix} 0 \\\\ -1 \\\\ 0 \\\\ 1 \\end{pmatrix}\n$$\n所以，$\\mathcal{N}(A) = \\operatorname{span}\\left\\{ (-1, 0, 1, 0)^T, (0, -1, 0, 1)^T \\right\\}$。零空间的维数为 $2$，因此是非平凡的，这证实了问题的另一个假设。\n\n**第一部分：对未扰动系统 $b_0$ 的分析**\n\n我们给定 $b_0 = (3, -1, 0)^T$。要证明 $b_0 \\in \\operatorname{Range}(A)$，我们必须证明 $b_0$ 可以写成 $\\operatorname{Range}(A)$ 的基向量的线性组合。\n$$\nb_0 = \\begin{pmatrix} 3 \\\\ -1 \\\\ 0 \\end{pmatrix} = 3 \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} + (-1) \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}\n$$\n这是 $\\operatorname{Range}(A)$ 的基向量的一个线性组合，所以 $b_0 \\in \\operatorname{Range}(A)$。这意味着方程组 $Ax = b_0$ 是相容的，并且至少有一个解。\n\n对于一个相容系统，存在一个 $x$ 使得 $Ax = b_0$。对于任何这样的 $x$，最小二乘残差为 $\\|b_0 - Ax\\|_2^2 = \\|b_0 - b_0\\|_2^2 = 0$。由于范数的平方总是非负的，其可能的最小值为 $0$。因此，该系统的最小二乘残差达到零。\n\n非齐次线性方程组 $Ax=b$ 的完整解集由 $x_p + \\mathcal{N}(A)$ 给出，其中 $x_p$ 是任意一个特解。我们给定向量 $x_0 = (3, -1, 0, 0)^T$。我们来验证它是否是 $Ax=b_0$ 的一个特解：\n$$\nA x_0 = \\begin{pmatrix} 1  0  1  0 \\\\ 0  1  0  1 \\\\ 0  0  0  0 \\end{pmatrix} \\begin{pmatrix} 3 \\\\ -1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1(3) + 0(-1) + 1(0) + 0(0) \\\\ 0(3) + 1(-1) + 0(0) + 1(0) \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 3 \\\\ -1 \\\\ 0 \\end{pmatrix} = b_0\n$$\n由于 $Ax_0 = b_0$，$x_0$ 是一个特解。因此，$Ax=b_0$ 的所有解的集合是 $x_0 + \\mathcal{N}(A)$。由于最小二乘残差为零，这恰好是所有最小二乘最小化子的集合。\n\n**第二部分：对扰动系统 $b_{\\delta}$ 的分析**\n\n我们给定一个扰动向量 $b_{\\delta} = b_0 + \\delta u$，其中 $\\delta  0$ 且 $u = (0, 0, 1)^T$。\n$$\nb_{\\delta} = \\begin{pmatrix} 3 \\\\ -1 \\\\ 0 \\end{pmatrix} + \\delta \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 3 \\\\ -1 \\\\ \\delta \\end{pmatrix}\n$$\n对于 $b_\\delta$ 的最小二乘问题是找到一个 $x^* \\in \\mathbb{R}^4$ 来最小化 $\\|b_\\delta - Ax\\|_2^2$。根据最小二乘法的基本原理，一个向量 $x^*$ 是一个最小化子当且仅当残差向量 $r = b_\\delta - Ax^*$ 与子空间 $\\operatorname{Range}(A)$ 正交。这等价于说 $Ax^*$ 是 $b_\\delta$ 在 $\\operatorname{Range}(A)$ 上的正交投影。\n\n令 $w^* = Ax^*$。条件是 $w^*$ 是 $W = \\operatorname{Range}(A)$ 中最小化 $\\|b_\\delta - w\\|_2$ 的向量。当向量 $b_\\delta - w^*$ 与 $W$ 正交时，达到这个最小值。这意味着 $b_\\delta - w^* \\in W^{\\perp}$。\n\n子空间 $W = \\operatorname{Range}(A)$ 是 $xy$-平面。在标准内积下，它在 $\\mathbb{R}^3$ 中的正交补是 $z$-轴：\n$$\nW^{\\perp} = \\left(\\operatorname{span}\\left\\{ \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}, \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} \\right\\}\\right)^{\\perp} = \\operatorname{span}\\left\\{ \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} \\right\\}\n$$\n条件 $b_\\delta - w^* \\in W^{\\perp}$ 意味着存在一个标量 $k$ 使得\n$$\nb_\\delta - w^* = k \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}\n$$\n整理得到 $w^*$，我们有\n$$\nw^* = b_\\delta - k \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 3 \\\\ -1 \\\\ \\delta \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ 0 \\\\ k \\end{pmatrix} = \\begin{pmatrix} 3 \\\\ -1 \\\\ \\delta - k \\end{pmatrix}\n$$\n要使 $w^*$ 属于 $W = \\operatorname{Range}(A)$，它的第三个分量必须为零。\n$$\n\\delta - k = 0 \\implies k = \\delta\n$$\n这确定了 $\\operatorname{Range}(A)$ 中最接近 $b_\\delta$ 的唯一向量 $w^*$：\n$$\nw^* = \\begin{pmatrix} 3 \\\\ -1 \\\\ 0 \\end{pmatrix} = b_0\n$$\n最小二乘最小化子集是所有满足 $Ax^* = w^* = b_0$ 的 $x^* \\in \\mathbb{R}^4$ 的集合。从第一部分我们知道这个集合是 $x_0 + \\mathcal{N}(A)$。由于 $\\dim(\\mathcal{N}(A)) = 2$，存在无穷多个这样的最小化子。因此，对于 $b_\\delta$ 的最小二乘最小化子集是非唯一的。\n\n然而，对于任何最小二乘最小化子 $x^*$，向量 $Ax^*$ 是唯一的，并且等于 $w^*=b_0$。因此，最小二乘残差向量也是唯一的：\n$$\nr = b_\\delta - Ax^* = b_\\delta - w^* = (b_0 + \\delta u) - b_0 = \\delta u\n$$\n代入向量 $u$：\n$$\nr = \\delta \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ \\delta \\end{pmatrix}\n$$\n这个唯一残差向量的欧几里得范数计算如下：\n$$\n\\|r\\|_2 = \\left\\| \\begin{pmatrix} 0 \\\\ 0 \\\\ \\delta \\end{pmatrix} \\right\\|_2 = \\sqrt{0^2 + 0^2 + \\delta^2} = \\sqrt{\\delta^2}\n$$\n因为问题陈述 $\\delta  0$，我们有 $\\sqrt{\\delta^2} = |\\delta| = \\delta$。\n\n因此，唯一残差向量的欧几里得范数为 $\\delta$。", "answer": "$$\\boxed{\\delta}$$", "id": "3544806"}, {"introduction": "在秩亏缺的情况下，最小二乘问题存在无穷多个解，这就引出了一个关键问题：我们应该选择哪一个？本练习将引导你找到这个问题的答案——唯一的最小范数解 [@problem_id:3544790]。你将运用几何正交性的原理来确定这个解，并最终将其与现代数值线性代数中的核心工具——Moore-Penrose伪逆联系起来，通过直接计算 $A^{+}b$ 来验证你的结果。", "problem": "考虑矩阵 $A \\in \\mathbb{R}^{2 \\times 3}$ 和向量 $b \\in \\mathbb{R}^{2}$，其定义如下\n$$\nA \\;=\\; \\begin{pmatrix}\n1  0  1 \\\\\n2  0  2\n\\end{pmatrix}, \n\\qquad \nb \\;=\\; \\begin{pmatrix}\n3 \\\\\n1\n\\end{pmatrix}.\n$$\n矩阵 $A$ 是秩亏的。\n\n从最小二乘问题的基本定义（即在 $x \\in \\mathbb{R}^{3}$ 上最小化平方欧几里得范数 $f(x) = \\|b - A x\\|_{2}^{2}$）出发，并仅使用诸如“临界点的特征是梯度为零”以及正交投影的性质等基本事实，完成以下任务：\n\n- 推导最小二乘极小化子的一阶最优性条件，并为给定的 $A$ 和 $b$ 显式计算出整个极小化子集合。\n- 使用关于欧几里得空间中正交投影的几何推理，在该集合中找出具有最小欧几里得范数的唯一极小化子。\n- 最后，通过对此特定秩-1矩阵从第一性原理直接计算 $A^{+}$，验证这个唯一的最小范数极小化子与 $A^{+} b$ 一致，其中 $A^{+}$ 表示 $A$ 的 Moore–Penrose 伪逆。\n\n你最终报告的答案必须是唯一的最小范数极小化子 $A^{+} b$，以 $\\mathbb{R}^{3}$ 中一个显式的列向量形式给出。无需四舍五入。", "solution": "目标是对于给定的矩阵 $A \\in \\mathbb{R}^{2 \\times 3}$ 和向量 $b \\in \\mathbb{R}^{2}$，找到所有向量 $x \\in \\mathbb{R}^{3}$ 的集合，以最小化残差的平方欧几里得范数 $f(x) = \\|b - A x\\|_{2}^{2}$。给定\n$$\nA \\;=\\; \\begin{pmatrix} 1  0  1 \\\\ 2  0  2 \\end{pmatrix}, \\qquad b \\;=\\; \\begin{pmatrix} 3 \\\\ 1 \\end{pmatrix}.\n$$\n函数 $f(x)$ 是关于 $x$ 的一个二次函数。我们可以将其表示为点积：\n$$\nf(x) = (b - A x)^{T} (b - A x) = b^{T}b - b^{T}Ax - x^{T}A^{T}b + x^{T}A^{T}Ax\n$$\n由于 $b^{T} A x$ 是一个标量，它等于其转置，即 $(b^{T} A x)^{T} = x^{T} A^{T} b$。因此，目标函数简化为：\n$$\nf(x) = x^{T} A^{T} A x - 2 b^{T} A x + b^{T} b.\n$$\n该函数是一个凸二次函数，因此其极小化子是梯度关于 $x$ 为零的临界点。梯度由下式给出：\n$$\n\\nabla_{x} f(x) = 2 A^{T} A x - 2 A^{T} b.\n$$\n将梯度设为零向量 $\\nabla_{x} f(x) = 0$，得到一阶最优性条件，即所谓的正规方程组：\n$$\nA^{T} A x = A^{T} b.\n$$\n任何满足正规方程组的向量 $x$ 都是一个最小二乘极小化子。\n\n首先，我们计算矩阵 $A^{T} A$ 和 $A^{T} b$：\n$$\nA^{T} = \\begin{pmatrix} 1  2 \\\\ 0  0 \\\\ 1  2 \\end{pmatrix}\n$$\n$$\nA^{T} A = \\begin{pmatrix} 1  2 \\\\ 0  0 \\\\ 1  2 \\end{pmatrix} \\begin{pmatrix} 1  0  1 \\\\ 2  0  2 \\end{pmatrix} = \\begin{pmatrix} 1 \\cdot 1 + 2 \\cdot 2  1 \\cdot 0 + 2 \\cdot 0  1 \\cdot 1 + 2 \\cdot 2 \\\\ 0  0  0 \\\\ 1 \\cdot 1 + 2 \\cdot 2  1 \\cdot 0 + 2 \\cdot 0  1 \\cdot 1 + 2 \\cdot 2 \\end{pmatrix} = \\begin{pmatrix} 5  0  5 \\\\ 0  0  0 \\\\ 5  0  5 \\end{pmatrix}.\n$$\n$$\nA^{T} b = \\begin{pmatrix} 1  2 \\\\ 0  0 \\\\ 1  2 \\end{pmatrix} \\begin{pmatrix} 3 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1 \\cdot 3 + 2 \\cdot 1 \\\\ 0 \\cdot 3 + 0 \\cdot 1 \\\\ 1 \\cdot 3 + 2 \\cdot 1 \\end{pmatrix} = \\begin{pmatrix} 5 \\\\ 0 \\\\ 5 \\end{pmatrix}.\n$$\n对于 $x = (x_1, x_2, x_3)^T$ 的正规方程组 $A^{T} A x = A^{T} b$ 为：\n$$\n\\begin{pmatrix} 5  0  5 \\\\ 0  0  0 \\\\ 5  0  5 \\end{pmatrix} \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\end{pmatrix} = \\begin{pmatrix} 5 \\\\ 0 \\\\ 5 \\end{pmatrix}.\n$$\n该矩阵方程对应于以下线性系统：\n$5x_1 + 5x_3 = 5$\n$0 = 0$\n$5x_1 + 5x_3 = 5$\n该系统简化为单个方程：$x_1 + x_3 = 1$。变量 $x_2$ 是无约束的。我们可以将解集参数化。设 $x_2 = s$ 和 $x_3 = t$，对于任意 $s, t \\in \\mathbb{R}$。则 $x_1 = 1 - t$。所有最小二乘极小化子的集合是一个仿射子空间，由下式给出：\n$$\nx(s, t) = \\begin{pmatrix} 1 - t \\\\ s \\\\ t \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} + s \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} + t \\begin{pmatrix} -1 \\\\ 0 \\\\ 1 \\end{pmatrix}.\n$$\n这个集合可以描述为 $x_p + \\mathcal{N}(A)$，其中 $x_p = (1, 0, 0)^T$ 是一个特解，$\\mathcal{N}(A)$ 是 $A$ 的零空间，由向量 $(0, 1, 0)^T$ 和 $(-1, 0, 1)^T$ 张成。\n\n接下来，我们找出具有最小欧几里得范数的唯一极小化子。所有解的集合是仿射子空间 $S = \\{x_p + z \\mid z \\in \\mathcal{N}(A)\\}$。$S$ 中范数最小的向量是与定义仿射平移的子空间（即 $\\mathcal{N}(A)$）正交的向量。换句话说，最小范数解 $x_{LS}$ 必须在零空间的正交补中，即 $x_{LS} \\in \\mathcal{N}(A)^{\\perp}$。根据线性代数基本定理，$\\mathcal{N}(A)^{\\perp} = \\mathcal{R}(A^T)$，即 $A^T$ 的值域。\n我们找到特定参数 $s$ 和 $t$，使得解 $x(s,t)$ 与 $\\mathcal{N}(A)$ 的基向量正交。\n设 $v_1 = (0, 1, 0)^T$ 和 $v_2 = (-1, 0, 1)^T$。正交性条件为 $x(s,t)^T v_1 = 0$ 和 $x(s,t)^T v_2 = 0$。\n1. $x(s,t)^T v_1 = \\begin{pmatrix} 1-t  s  t \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} = s = 0$。\n2. $x(s,t)^T v_2 = \\begin{pmatrix} 1-t  s  t \\end{pmatrix} \\begin{pmatrix} -1 \\\\ 0 \\\\ 1 \\end{pmatrix} = -(1-t) + t = -1 + 2t = 0$。\n第二个条件得出 $2t = 1$，所以 $t = 1/2$。\n将 $s=0$ 和 $t=1/2$ 代入通解，得到唯一的最小范数极小化子：\n$$\nx_{LS} = \\begin{pmatrix} 1 - 1/2 \\\\ 0 \\\\ 1/2 \\end{pmatrix} = \\begin{pmatrix} 1/2 \\\\ 0 \\\\ 1/2 \\end{pmatrix}.\n$$\n\n最后，我们通过计算 Moore-Penrose 伪逆 $A^{+}$ 和乘积 $A^{+}b$ 来验证此结果。矩阵 $A$ 是一个秩-1 矩阵。它可以写成两个向量 $u \\in \\mathbb{R}^2$ 和 $v \\in \\mathbb{R}^3$ 的外积。\n$$\nA = \\begin{pmatrix} 1  0  1 \\\\ 2  0  2 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix} \\begin{pmatrix} 1  0  1 \\end{pmatrix}.\n$$\n这里，$u = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}$ 且 $v^T = \\begin{pmatrix} 1  0  1 \\end{pmatrix}$，所以 $v = \\begin{pmatrix} 1 \\\\ 0 \\\\ 1 \\end{pmatrix}$。\n对于秩-1 矩阵 $A = uv^T$，其 Moore-Penrose 伪逆由以下公式给出：\n$$\nA^{+} = \\frac{1}{\\|u\\|_{2}^2 \\|v\\|_{2}^2} v u^T.\n$$\n我们计算范数的平方：\n$\\|u\\|_{2}^2 = 1^2 + 2^2 = 1 + 4 = 5$。\n$\\|v\\|_{2}^2 = 1^2 + 0^2 + 1^2 = 1 + 1 = 2$。\n现在，我们可以计算 $A^{+}$：\n$$\nA^{+} = \\frac{1}{5 \\cdot 2} \\begin{pmatrix} 1 \\\\ 0 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} 1  2 \\end{pmatrix} = \\frac{1}{10} \\begin{pmatrix} 1 \\cdot 1  1 \\cdot 2 \\\\ 0 \\cdot 1  0 \\cdot 2 \\\\ 1 \\cdot 1  1 \\cdot 2 \\end{pmatrix} = \\frac{1}{10} \\begin{pmatrix} 1  2 \\\\ 0  0 \\\\ 1  2 \\end{pmatrix}.\n$$\n唯一的最小范数最小二乘解由 $x_{LS} = A^{+}b$ 给出。\n$$\nx_{LS} = A^{+}b = \\frac{1}{10} \\begin{pmatrix} 1  2 \\\\ 0  0 \\\\ 1  2 \\end{pmatrix} \\begin{pmatrix} 3 \\\\ 1 \\end{pmatrix} = \\frac{1}{10} \\begin{pmatrix} 1 \\cdot 3 + 2 \\cdot 1 \\\\ 0 \\\\ 1 \\cdot 3 + 2 \\cdot 1 \\end{pmatrix} = \\frac{1}{10} \\begin{pmatrix} 5 \\\\ 0 \\\\ 5 \\end{pmatrix} = \\begin{pmatrix} 5/10 \\\\ 0 \\\\ 5/10 \\end{pmatrix} = \\begin{pmatrix} 1/2 \\\\ 0 \\\\ 1/2 \\end{pmatrix}.\n$$\n此结果与通过几何推理得到的结果相符，从而证实了我们的计算。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{2} \\\\\n0 \\\\\n\\frac{1}{2}\n\\end{pmatrix}\n}\n$$", "id": "3544790"}]}