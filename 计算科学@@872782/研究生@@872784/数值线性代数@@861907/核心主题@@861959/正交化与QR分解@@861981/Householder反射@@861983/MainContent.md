## 引言
豪斯霍尔德[反射器](@entry_id:754193)（Householder reflector）是现代数值线性代数武库中威力最强、应用最广的工具之一。它不仅仅是一个简单的[线性变换](@entry_id:149133)，更是理解和构造稳健、高效数值算法的基石。然而，许多学习者仅仅停留在其代数公式的表面，未能深刻领会其优美的几何直觉、精巧的数值构造以及在不同计算领域中的深远影响。本文旨在填补这一认知鸿沟，为读者提供一个从理论到实践的完整视角。

本文将引导你穿越三个层次的探索。在“原理与机制”一章中，我们将深入其数学核心，从[几何反射](@entry_id:635628)出发，推导其代数性质，并剖析其在实现QR分解等经典算法时所面临的[数值稳定性](@entry_id:146550)挑战与高性能实现策略。接着，在“应用与[交叉](@entry_id:147634)学科联系”一章中，我们将视野拓宽，考察[豪斯霍尔德变换](@entry_id:168808)如何驱动更高级的数值方法（如[特征值](@entry_id:154894)和SVD算法），并探寻其在数据科学、[量子计算](@entry_id:142712)和[数学物理](@entry_id:265403)等前沿领域中出人意料的联系。最后，“动手实践”部分将提供一系列精心设计的问题，帮助你将理论知识转化为解决实际问题的计算能力。通过本次学习，你将不仅掌握[豪斯霍尔德变换](@entry_id:168808)“是什么”和“怎么用”，更能理解它“为什么”如此重要和强大。

## 原理与机制

本章旨在深入探讨[豪斯霍尔德变换](@entry_id:168808)（Householder transformation）的数学原理及其在数值计算中的核心机制。作为一种基本的线性变换，[豪斯霍尔德变换](@entry_id:168808)（或称豪斯霍尔德反射）在现代[数值线性代数](@entry_id:144418)中扮演着至关重要的角色，尤其是在[矩阵分解](@entry_id:139760)、求解最小二乘问题以及[特征值计算](@entry_id:145559)等领域。我们将从其几何直觉出发，建立严谨的[代数表示](@entry_id:143783)，分析其关键性质，并进一步阐述其在构建稳定、高效算法（如QR分解）时所涉及的[数值稳定性](@entry_id:146550)问题和[高性能计算](@entry_id:169980)策略。

### 单个豪斯霍尔德[反射器](@entry_id:754193)的基本性质

从根本上说，一个**豪斯霍尔德[反射器](@entry_id:754193)（Householder reflector）** 是一种关于某个超平面的镜像反射。理解其几何本质是掌握其应用的关键。

#### 几何定义与[代数表示](@entry_id:143783)

在 $n$ 维[欧几里得空间](@entry_id:138052) $\mathbb{R}^n$ 中，任何一个向量 $x$ 都可以被分解为两个正交分量：一个平行于某个给定的非零向量 $v$ 的分量，另一个则正交于 $v$。正交于 $v$ 的所有向量构成一个维度为 $n-1$ 的**超平面（hyperplane）**。[豪斯霍尔德变换](@entry_id:168808) $H$ 的作用正是将向量 $x$ 关于这个由 $v$ 定义的[超平面](@entry_id:268044) $v^{\perp} = \{y \in \mathbb{R}^n : v^T y = 0\}$ 进行反射。

具体来说，向量 $x$ 的[正交分解](@entry_id:148020)为：
$$
x = x_{\parallel} + x_{\perp}
$$
其中 $x_{\parallel}$ 是 $x$ 在由 $v$ 张成的[子空间](@entry_id:150286) $\operatorname{span}\{v\}$ 上的[正交投影](@entry_id:144168)，而 $x_{\perp}$ 是 $x$ 在[超平面](@entry_id:268044) $v^{\perp}$ 上的[正交投影](@entry_id:144168)。反射操作会保持 $x_{\perp}$ 不变，同时将 $x_{\parallel}$ 的方向反转。因此，变换后的向量 $Hx$ 为：
$$
Hx = -x_{\parallel} + x_{\perp}
$$
我们知道 $x_{\parallel} = \frac{v^T x}{v^T v}v$ 且 $x_{\perp} = x - x_{\parallel}$。代入上式可得：
$$
Hx = -( \frac{v^T x}{v^T v}v ) + ( x - \frac{v^T x}{v^T v}v ) = x - 2 \frac{v^T x}{v^T v} v
$$
由于[矩阵向量乘法](@entry_id:140544)满足 $Av = (Av)$，而标量 $(v^T x)$ 可以自由移动，我们可以将上式写成矩阵形式：
$$
Hx = \left(I - 2 \frac{v v^T}{v^T v}\right) x
$$
因此，豪斯霍尔德[反射器](@entry_id:754193)的矩阵表示为：
$$
H = I - 2 \frac{v v^T}{v^T v}
$$
其中 $I$ 是[单位矩阵](@entry_id:156724)，而 $v v^T$ 是一个秩为1的矩阵（外积）。值得注意的是，矩阵 $P_v = \frac{v v^T}{v^T v}$ 正是到向量 $v$ 所张成的一维[子空间](@entry_id:150286)上的**[正交投影](@entry_id:144168)算子（orthogonal projector）**。因此，豪斯霍尔德[反射器](@entry_id:754193)可以简洁地表示为 $H = I - 2P_v$。[@problem_id:3549944] [@problem_id:3549917]

#### 核心代数性质

从其代数表达式 $H = I - 2 \frac{v v^T}{v^T v}$ 出发，我们可以推导出它的一系列重要性质。为了简化，我们常[选择单位](@entry_id:184200)向量 $u$ 来定义[反射器](@entry_id:754193)，即 $\|u\|_2=1$，此时表达式为 $H = I - 2uu^T$。

1.  **对称性 (Symmetry)**：[反射器](@entry_id:754193)矩阵是对称的。
    $$
    H^T = (I - 2uu^T)^T = I^T - 2(uu^T)^T = I - 2(u^T)^T u^T = I - 2uu^T = H
    $$

2.  **正交性 (Orthogonality)**：[反射器](@entry_id:754193)是[正交矩阵](@entry_id:169220)。我们可以通过验证 $H^T H = I$ 来证明。由于 $H$ 是对称的，这等价于验证 $H^2 = I$。
    $$
    H^2 = (I - 2uu^T)(I - 2uu^T) = I - 4uu^T + 4(uu^T)(uu^T) = I - 4uu^T + 4u(u^T u)u^T
    $$
    因为 $u$ 是[单位向量](@entry_id:165907)，所以 $u^T u = \|u\|_2^2 = 1$。因此：
    $$
    H^2 = I - 4uu^T + 4uu^T = I
    $$

3.  **对合性 (Involution)**：从 $H^2=I$ 可知，$H$ 是一个对合矩阵，即它本身就是自己的逆矩阵，$H^{-1}=H$。这与反射的几何直觉完全一致：对一个物体反射两次，会使其回到原位。[@problem_id:3572894]

正交性保证了[豪斯霍尔德变换](@entry_id:168808)是**保距变换（isometry）**，即它保持向量的[欧几里得范数](@entry_id:172687)不变：$\|Hx\|_2 = \|x\|_2$ 对所有 $x \in \mathbb{R}^n$ 成立。

#### 特征结构

豪斯霍尔德[反射器](@entry_id:754193)的[特征值](@entry_id:154894)和[特征向量](@entry_id:151813)深刻地揭示了其几何行为。

*   对于定义反射超平面的法向量 $v$（或[单位向量](@entry_id:165907) $u$），我们有：
    $$
    Hu = (I - 2uu^T)u = u - 2u(u^T u) = u - 2u = -u
    $$
    这表明 $u$ 是 $H$ 的一个[特征向量](@entry_id:151813)，其对应的**[特征值](@entry_id:154894)（eigenvalue）**为 $-1$。几何上，这意味着沿[法向量](@entry_id:264185)方向的任何向量在反射后都会被反向。

*   对于任何一个位于反射超平面内的向量 $w$（即满足 $u^T w = 0$ 的向量），我们有：
    $$
    Hw = (I - 2uu^T)w = w - 2u(u^T w) = w - 2u(0) = w
    $$
    这表明超平面 $u^{\perp}$ 内的任何向量都是 $H$ 的[特征向量](@entry_id:151813)，其对应的[特征值](@entry_id:154894)为 $+1$。几何上，这意味着[超平面](@entry_id:268044)本身是变换的**[不动点](@entry_id:156394)集（fixed-point set）**。

由于 $\operatorname{span}\{u\}$ 是一维的，而[超平面](@entry_id:268044) $u^{\perp}$ 是 $(n-1)$ 维的，我们找到了 $H$ 的一个完备的特征结构：
*   [特征值](@entry_id:154894) $\lambda = -1$，[代数重数](@entry_id:154240)为1，对应的**[特征空间](@entry_id:638014)（eigenspace）**为 $\operatorname{span}\{u\}$。
*   [特征值](@entry_id:154894) $\lambda = +1$，[代数重数](@entry_id:154240)为 $n-1$，对应的[特征空间](@entry_id:638014)为[超平面](@entry_id:268044) $u^{\perp}$。

[矩阵的行列式](@entry_id:148198)是其所有[特征值](@entry_id:154894)的乘积。因此，任何豪斯霍尔德[反射器](@entry_id:754193)的[行列式](@entry_id:142978)都是：
$$
\det(H) = (-1)^1 \cdot (+1)^{n-1} = -1
$$
[行列式](@entry_id:142978)为-1的变换属于**[瑕旋转](@entry_id:151532)（improper rotation）**，它会改变空间的定向（或“手性”）。此外，由上述[特征值分析](@entry_id:273168)可知，对于一个给定的[单位向量](@entry_id:165907) $v$，豪斯霍尔德[反射器](@entry_id:754193)是唯一一个能够点态固定[超平面](@entry_id:268044) $v^{\perp}$ 并将 $v$ 映射到 $-v$ 的正交变换。[@problem_id:3549944] [@problem_id:3549917] [@problem_id:3572894]

### 反射作为[正交变换](@entry_id:155650)的基本构造单元

豪斯霍尔德[反射器](@entry_id:754193)不仅仅是数值计算中的一个工具，它在几何学中具有基础性的地位。著名的 **Cartan-Dieudonné 定理** 指出，在 $n$ 维欧几里得空间中，任何一个[正交变换](@entry_id:155650)（即 $O(n)$ 群中的元素）都可以表示为至多 $n$ 个超平面反射的乘积。

这意味着，无论是旋转、[瑕旋转](@entry_id:151532)还是其他任何保距变换，都可以通过一系列的“镜像反射”来构造。这一深刻的结果将反射提升为所有正交变换的基本“原子”操作。

*   如果一个[正交矩阵](@entry_id:169220) $Q$ 的[行列式](@entry_id:142978)为 $+1$（即 $Q \in SO(n)$，[特殊正交群](@entry_id:146418)，代表纯粹的**旋转**），那么它可以表示为偶数个反射的乘积。
*   如果 $\det(Q) = -1$（**[瑕旋转](@entry_id:151532)**），它则可以表示为奇数个反射的乘积。

一个更精细的结果是，表示一个[正交变换](@entry_id:155650) $Q$ 所需的最少反射次数恰好是矩阵 $I-Q$ 的秩，即 $\operatorname{rank}(I-Q)$。这个数字也对应于 $Q$ 的[不动点](@entry_id:156394)[子空间](@entry_id:150286)维数的补数。 [@problem_id:3572894]

尽管[反射器](@entry_id:754193)是如此基本，但所有豪斯霍尔德[反射器](@entry_id:754193)的集合自身并不构成 $O(n)$ 的一个[子群](@entry_id:146164)，因为它不包含单位元 $I$（没有任何反射能等同于“什么都不做”的变换）。[@problem_id:3572894]

### 数值构造及其稳定性

在数值应用中，豪斯霍尔德[反射器](@entry_id:754193)的主要任务通常是将一个给定的非[零向量](@entry_id:156189) $x$ 变换为某个坐标轴的倍数，最常见的是 $e_1 = \begin{pmatrix} 1  0  \dots  0 \end{pmatrix}^T$。即，寻找一个[反射器](@entry_id:754193) $H$ 使得 $Hx = \alpha e_1$。

#### 构造豪斯霍尔德向量

由于反射是保距变换，我们必须有 $\|Hx\|_2 = \|\alpha e_1\|_2 = |\alpha|$，同时 $\|Hx\|_2 = \|x\|_2$。因此，$|\alpha| = \|x\|_2$。变换后的向量必然是 $\pm \|x\|_2 e_1$。

定义 $H$ 的向量 $v$ 应垂直于 $x$ 和 $Hx$ 之间的角平分线，即 $v$ 与向量 $x - Hx$ 平行。因此，我们可以取：
$$
v = x - (\pm \|x\|_2 e_1)
$$
此时问题转化为如何选择正负号。一个看似自然的选择是 $v = x - \|x\|_2 e_1$。然而，在有限精度浮点运算中，这个选择可能是灾难性的。

#### [灾难性抵消](@entry_id:146919)问题

考虑当向量 $x$ 已经非常接近 $e_1$ 轴时的情况，即 $x_1 \approx \|x\|_2 > 0$。此时，计算 $v$ 的第一个分量 $v_1 = x_1 - \|x\|_2$ 会涉及两个几乎相等的正数相减。这种运算被称为**灾难性抵消（catastrophic cancellation）**，它会导致结果的[相对误差](@entry_id:147538)急剧放大。

具体来说，在精确算术中，$v = x - \|x\|_2 e_1$ 的范数平方为：
$$
\|v\|_2^2 = \|x - \|x\|_2 e_1\|_2^2 = \|x\|_2^2 - 2\|x\|_2 x_1 + \|x\|_2^2 = 2\|x\|_2 (\|x\|_2 - x_1)
$$
当 $x_1 \to \|x\|_2$ 时，$\|x\|_2 - x_1$ 是一个很小的数。在[浮点](@entry_id:749453)计算中，计算 $\|x\|_2$ 会引入微小的舍入误差。这个误差在减法中会被放大，导致计算出的 $\|v\|_2$ 的相对误差可能非常大。如果 $\|v\|_2$ 不准确，那么据此构造的[反射器](@entry_id:754193) $\hat{H}$ 将不再精确正交，从而破坏算法的稳定性。[@problem_id:3549956]

#### 稳定的构造方法

为了避免灾难性抵消，标准的做法是选择符号使得减法变为加法。稳定的豪斯霍尔德向量 $v$ 定义为：
$$
v = x + \operatorname{sign}(x_1) \|x\|_2 e_1
$$
其中 $\operatorname{sign}(x_1)$ 取 $x_1$ 的符号（如果 $x_1=0$，则取 $+1$）。这样， $v$ 的第一个分量变为 $v_1 = x_1 + \operatorname{sign}(x_1) \|x\|_2 = \operatorname{sign}(x_1)(|x_1| + \|x\|_2)$，这是一个加法运算（或两个负数相加），在数值上是稳定的。

使用这个稳定的 $v$ 定义，其范数平方变为：
$$
\|v\|_2^2 = \|x + \operatorname{sign}(x_1) \|x\|_2 e_1\|_2^2 = 2\|x\|_2 (\|x\|_2 + |x_1|)
$$
这个表达式中只包含加法，因此计算结果稳定。在最极端的情况下，如果 $x$ 已经平行于 $e_1$（例如 $x = \|x\|_2 e_1$），不稳定的选择会得到 $v=0$，无法定义[反射器](@entry_id:754193)；而稳定的选择会得到 $v = 2\|x\|_2 e_1$，可以构造一个有效的[反射器](@entry_id:754193)。这个符号选择是保证[豪斯霍尔德变换](@entry_id:168808)[数值鲁棒性](@entry_id:188030)的关键。[@problem_id:3549956]

#### 有限精度下的性质退化

即使构造过程是稳定的，[有限精度算术](@entry_id:142321)仍然会引入微小的误差。一个直接的后果是，计算出的[反射器](@entry_id:754193) $\hat{H}$ 不再严格满足对合性，即 $\hat{H}^2 \neq I$。

假设我们通过[标准化](@entry_id:637219)一个向量 $x$ 得到[单位向量](@entry_id:165907) $\hat{v}$，由于舍入误差，其范数平方为 $\|\hat{v}\|_2^2 = 1+\eta$，其中 $\eta$ 是一个与[机器精度](@entry_id:756332) $u$ 同阶的小量。计算出的[反射器](@entry_id:754193)为 $\hat{H} = I - 2\hat{v}\hat{v}^T$。其平方为：
$$
\hat{H}^2 = I + 4\eta \hat{v}\hat{v}^T
$$
可以看到，$\hat{H}^2$ 与单位矩阵 $I$ 的偏离是一个秩为1的矩阵。如果反复应用这个有误差的[反射器](@entry_id:754193)，误差会累积。经过 $m$ 次双重应用，偏离量为：
$$
\Delta_m = \|\left(\hat{H}^2\right)^m - I\|_2 \approx |(1+2\eta)^{2m} - 1|
$$
在最坏情况下，这个偏离量会随着应用次数 $m$ [指数增长](@entry_id:141869)，这说明了即使是数值稳定的操作，在迭代应用中也可能导致性质的显著退化。[@problem_id:3549930]

尽管如此，[豪斯霍尔德变换](@entry_id:168808)在单次应用中表现出极佳的稳定性。例如，用于构造[反射器](@entry_id:754193)的[方向向量](@entry_id:169562) $\hat{u}$ 的计算非常精确，其与真实方向 $u$ 的夹角 $\theta$ 的正弦值 $\sin(\theta)$ 通常以机器精度 $\varepsilon$ 为界。[@problem_id:3549917]

### [豪斯霍尔德QR分解](@entry_id:750388)的机制

豪斯霍尔德[反射器](@entry_id:754193)最经典的应用之一是计算矩阵的**QR分解**。对于任意一个 $m \times n$ 的矩阵 $A$（通常 $m \ge n$），QR分解将其表示为一个正交矩阵 $Q$ 与一个[上三角矩阵](@entry_id:150931) $R$ 的乘积：$A=QR$。

#### 算法流程

[豪斯霍尔德QR分解](@entry_id:750388)通过一系列[反射变换](@entry_id:175518)，逐步将矩阵 $A$ 化为上三角形式。算法按列进行：

1.  **第一步 ($j=1$)**：考虑 $A$ 的第一列 $a_1$。构造一个豪斯霍尔德[反射器](@entry_id:754193) $H_1$，将 $a_1$ 变换为 $\|a_1\|_2 e_1$ 的形式，即在第一列的对角线以下引入零。然后将此变换应用于整个矩阵 $A$：$A^{(1)} = H_1 A$。

2.  **第二步 ($j=2$)**：此时 $A^{(1)}$ 的第一列已经处理完毕。我们关注其右下角的子矩阵，并对该子矩阵的第一列（即 $A^{(1)}$ 的第二列的 $2$ 到 $m$ 行部分）构造一个更小的豪斯霍尔德[反射器](@entry_id:754193) $\hat{H}_2$。将其嵌入到一个 $m \times m$ 的矩阵 $H_2 = \begin{pmatrix} 1  0 \\ 0  \hat{H}_2 \end{pmatrix}$ 中，以确保第一行和第一列不变。应用变换：$A^{(2)} = H_2 A^{(1)}$。

3.  **后续步骤**：重复此过程 $n$ 次（如果 $m>n$）或 $n-1$ 次（如果 $m=n$）。在第 $j$ 步，我们构造一个[反射器](@entry_id:754193) $H_j$ 来处理第 $j$ 列的 $j+1$ 到 $m$ 行的元素，将它们清零。

经过 $n$ 步后，我们得到：
$$
H_n H_{n-1} \cdots H_1 A = R
$$
其中 $R$ 是一个上三角矩阵。令 $Q = H_1 H_2 \cdots H_n$。由于每个 $H_j$ 都是正交且对称的 ($H_j^{-1} = H_j$)，它们的乘积 $Q$ 也是一个正交矩阵。因此，我们得到了分解 $A = QR$。[@problem_id:3549721]

#### 隐式存储机制

在实际执行中，我们几乎从不显式地构造和存储 $m \times m$ 的[稠密矩阵](@entry_id:174457) $H_j$。这样做会极其浪费计算资源和内存。相反，我们利用了[反射器](@entry_id:754193)可以由其生成向量 $v_j$ 和一个标量 $\beta_j = 2/\|v_j\|_2^2$ 完全确定的事实。

标准的实现采用了一种高效的**隐式存储（in-place storage）**方案：

*   在算法的第 $j$ 步，当 $H_j$ 将第 $j$ 列对角线以下的元素清零后，这些位置（即 $A(j+1:m, j)$）就变得多余了。我们可以利用这片空间来存储定义 $H_j$ 的向量 $v_j$ 的“有效”部分。通常，我们会对 $v_j$ 进行[标准化](@entry_id:637219)，使其第 $j$ 个分量为1，然后只需存储其 $j+1$ 到 $m$ 的分量。

*   经过 $n$ 步，矩阵 $A$ 的存储空间被重新利用：其上三角部分（包括对角线）存储着最终的 $R$ 矩阵，而其严格下三角部分则存储了所有豪斯霍尔德向量 $v_1, \dots, v_n$ 的信息。

*   标量 $\beta_1, \dots, \beta_n$ 通常无法在原矩阵 $A$ 中找到空间，因此需要一个大小为 $n$ 的辅助数组来存储它们。

这种策略使得[豪斯霍尔德QR分解](@entry_id:750388)的额外内存开销极小，仅为一个长度为 $n$ 的小数组，这使得它在内存受限的环境中非常实用。[@problem_id:3549926]

#### [后向稳定性](@entry_id:140758)：算法成功的保障

[豪斯霍尔德QR分解](@entry_id:750388)之所以被广泛使用，不仅因为其普适性，更在于其卓越的**[后向稳定性](@entry_id:140758)（backward stability）**。一个后向稳定的算法，其计算结果可以被解释为对一个略微扰动的原始问题的精确解。

对于[QR分解](@entry_id:139154)，[后向稳定性](@entry_id:140758)意味着在浮点运算中计算出的因子 $\hat{Q}$ 和 $\hat{R}$ 满足：
$$
\hat{Q}\hat{R} = A + \Delta A
$$
其中 $\Delta A$ 是一个“小”的扰动矩阵。更重要的是，这个扰动的大小 $\frac{\|\Delta A\|}{\|A\|}$ 仅与[机器精度](@entry_id:756332) $u$ 和矩阵维度 $m, n$ 有关，而**与矩阵 $A$ 的条件数 $\kappa(A)$ 无关**。这是一个极强的性质，表明算法的可靠性不依赖于问题本身的“病态”程度。更强的**分量级[后向误差](@entry_id:746645)界（componentwise backward error bound）**也成立，例如 $|\Delta A| \le \gamma_{cn} |\hat{Q}||\hat{R}|$。[@problem_id:3549924]

这种稳定性与另一种求解最小二乘问题的经典方法——**[正规方程](@entry_id:142238)法（normal equations method）**——形成了鲜明对比。[正规方程](@entry_id:142238)法需要先计算格拉姆矩阵 $G = A^T A$，然后通过[乔列斯基分解](@entry_id:166031)（Cholesky factorization）[求解方程组](@entry_id:152624) $Gx = A^T b$。在精确算术中，$A=QR$ 分解得到的上三角阵 $R$ （的[主块](@entry_id:137899)）与 $A^T A$ 的乔列斯基因子 $U$（满足 $A^T A = U^T U$）本质上是相同的（在对角[线元](@entry_id:196833)素符号调整后）。[@problem_id:3549923]

然而，在浮点运算中，计算 $A^T A$ 的过程会“平方”[条件数](@entry_id:145150)，即 $\kappa(A^T A) = \kappa(A)^2$。如果 $A$ 是病态的（$\kappa(A)$ 很大），$\kappa(A^T A)$ 将会变得极大，导致数值解极不稳定。当 $\kappa(A) \gtrsim u^{-1/2}$ 时，计算出的 $\hat{G}$ 甚至可能因[舍入误差](@entry_id:162651)而失去正定性，导致[乔列斯基分解](@entry_id:166031)失败。相比之下，[豪斯霍尔德QR分解](@entry_id:750388)直接作用于 $A$，避免了条件数的平方，因此即使对于非常病态的矩阵，它仍然能保持后向稳定。这就是在面对病态最小二乘问题时，[QR分解](@entry_id:139154)方法远优于正规方程法的主要原因。[@problem_id:3549923] [@problem_id:3549924]

### 高性能实现：[分块算法](@entry_id:746879)

在现代计算机体系结构中，数据从主存移动到[CPU缓存](@entry_id:748001)的成本远高于浮点运算本身。为了提高性能，算法必须最大化**[算术强度](@entry_id:746514)（arithmetic intensity）**，即[浮点运算次数](@entry_id:749457)与内存访问量的比率。逐个应用豪斯霍尔德[反射器](@entry_id:754193)的标准算法，其核心是矩阵-向量乘法（Level-2 BLAS），[算术强度](@entry_id:746514)较低。

为了利用矩阵-矩阵乘法（[Level-3 BLAS](@entry_id:751246)）的高[算术强度](@entry_id:746514)，需要采用**[分块算法](@entry_id:746879)（blocked algorithm）**。其关键在于将一组（例如 $r$ 个）豪斯霍尔德[反射器](@entry_id:754193)的累积效应 $Q = H_1 H_2 \cdots H_r$ 表示成一种紧凑的形式。

这种表示被称为**紧凑WY表示（Compact WY representation）**，它将 $Q$ 写为：
$$
Q = I - Y T Y^T
$$
其中 $Y$ 是一个 $m \times r$ 的矩阵，其列由豪斯霍尔德向量构成；$T$ 是一个 $r \times r$ 的[上三角矩阵](@entry_id:150931)。这种表示的存储开销为 $\mathcal{O}(mr + r^2)$，远小于显式存储 $Q$ 所需的 $\mathcal{O}(m^2)$。[@problem_id:3549921]

利用这种形式，将 $Q$ 应用于一个矩阵 $C$ 的操作 $QC$ 可以分三步完成：
1.  $S \leftarrow Y^T C$ （一个 $r \times m$ 矩阵乘以 $m \times n$ 矩阵）
2.  $W \leftarrow T S$ （一个 $r \times r$ 矩阵乘以 $r \times n$ 矩阵）
3.  $C \leftarrow C - Y W$ （一个 $m \times r$ 矩阵乘以 $r \times n$ 矩阵的减法）

这些步骤的核心是矩阵-矩阵乘法，它们可以被高效地实现，充分利用缓存，从而显著提升性能。虽然[分块算法](@entry_id:746879)的总浮点运算量与非[分块算法](@entry_id:746879)大致相同（均为约 $4mnr$），但由于其更高的[算术强度](@entry_id:746514)，实际运行速度要快得多。这是现代数值软件库（如[LAPACK](@entry_id:751137)）中实现[豪斯霍尔德变换](@entry_id:168808)的标准方式。[@problem_id:3549921]