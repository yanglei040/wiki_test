{"hands_on_practices": [{"introduction": "Householder QR 分解的核心在于一系列的反射变换。第一个实践练习将带领我们完成这一过程的基础步骤：为一个给定的向量构造第一个 Householder 反射器。通过亲手计算将矩阵第一列在对角线以下的元素清零所需的反射向量 $v$ 和标量 $\\tau$，你将对 Householder 变换的几何意义和代数构造建立起坚实的直觉。[@problem_id:3549693]", "problem": "考虑矩阵 $A \\in \\mathbb{R}^{3 \\times 3}$，其定义如下\n$$\nA=\\begin{bmatrix}\n12  -51  4\\\\\n6  167  -68\\\\\n-4  24  -41\n\\end{bmatrix}.\n$$\n令 $a_{1} \\in \\mathbb{R}^{3}$ 表示 $A$ 的第一列。Householder 反射是一种正交变换，它将向量关于一个超平面进行反射。在正交三角 (QR) 分解中，它被用来将一个给定的非零向量映射到一个坐标基向量的标量倍。仅从正交反射的定义出发——即一种线性等距变换，它在一个超平面上表现为恒等变换，并翻转其正交方向——构造第一个 Householder 反射 $H \\in \\mathbb{R}^{3 \\times 3}$，该反射将 $a_{1}$ 映射到一个与 $e_{1} \\in \\mathbb{R}^{3}$ 共线的向量，并在对 $A$ 进行左乘时，在 $(1,1)$ 位置下方的元素处产生零。选择沿 $e_{1}$ 的反射长度以避免构造过程中的灾难性抵消。\n\n将你的反射器表示为紧凑形式 $H = I - \\tau v v^{\\top}$，并遵循约定 $v_{1}=1$ 且 $v \\in \\mathbb{R}^{3}$。确定：\n- 更新后的第一列 $H a_{1}$，以及\n- 反射器参数 $\\tau$、$v_{2}$ 和 $v_{3}$\n\n以精确形式表示。将你的最终答案表示为单个行向量\n$$\n\\begin{pmatrix}\n\\alpha  \\tau  v_{2}  v_{3}\n\\end{pmatrix},\n$$\n其中 $H a_{1} = \\begin{bmatrix}\\alpha  0  0\\end{bmatrix}^{\\top}$。无需四舍五入；在适用情况下报告精确的有理数值。", "solution": "这个问题是有效的，因为它是数值线性代数领域中一个适定且有科学依据的问题。它为构造一个特定的 Householder 反射器提供了所有必要的数据和定义，而 Householder 反射器是数值分析中一个标准且基本的工具。\n\n问题要求构造一个 Householder 反射器 $H$，它将给定矩阵 $A$ 的第一列变换为一个与第一标准基向量 $e_1$ 对齐的向量。令 $a_1$ 为 $A$ 的第一列。\n给定的矩阵是\n$$\nA=\\begin{bmatrix}\n12  -51  4\\\\\n6  167  -68\\\\\n-4  24  -41\n\\end{bmatrix}.\n$$\n第一列是向量 $a_1 = \\begin{bmatrix} 12 \\\\ 6 \\\\ -4 \\end{bmatrix}$。\n\nHouseholder 反射是一种正交变换，这意味着它是一种等距变换，保持向量的欧几里得范数不变。该变换将 $a_1$ 映射到一个形式为 $\\alpha e_1$ 的向量 $H a_1$，其中 $e_1 = \\begin{bmatrix} 1 \\\\ 0 \\\\ 0 \\end{bmatrix}$。\n由于等距变换的性质，我们必须有 $\\|H a_1\\|_2 = \\|a_1\\|_2$。\n计算 $H a_1$ 的范数：\n$$\n\\|H a_1\\|_2 = \\|\\alpha e_1\\|_2 = |\\alpha| \\|e_1\\|_2 = |\\alpha| \\sqrt{1^2 + 0^2 + 0^2} = |\\alpha|.\n$$\n计算 $a_1$ 的范数：\n$$\n\\|a_1\\|_2 = \\sqrt{12^2 + 6^2 + (-4)^2} = \\sqrt{144 + 36 + 16} = \\sqrt{196} = 14.\n$$\n因此，我们必须有 $|\\alpha| = 14$，这意味着 $\\alpha = 14$ 或 $\\alpha = -14$。\n\n问题指出，反射长度的选择应避免灾难性抵消。这是 Householder 变换数值实现中的一个标准考虑因素。我们记反射向量为 $u$，它由原始向量 $a_1$ 与其像 $\\alpha e_1$ 之間的差构造而成。令 $a_1$ 的第一个分量为 $a_{11} = 12$。$u$ 的第一个分量将是 $a_{11} - \\alpha$。为避免两个几乎相等的数相减导致精度损失，我们选择 $\\alpha$ 的符号與 $a_{11}$ 的符号相反。\n由于 $a_{11} = 12 > 0$，我们选择 $\\alpha < 0$。因此，我们选择 $\\alpha = -14$。\n更新后的第一列是 $H a_1 = -14 e_1 = \\begin{bmatrix} -14 \\\\ 0 \\\\ 0 \\end{bmatrix}$。\n\n将向量 $x$ 映射到 $y$（其中 $\\|x\\|_2=\\|y\\|_2$）的 Householder 反射器 $H$ 由 $H = I - 2 \\frac{u u^{\\top}}{u^{\\top} u}$ 给出，其中 $u = x - y$。在我们的例子中，$x=a_1$ 且 $y=\\alpha e_1$。\n所以，反射向量 $u$ 是\n$$\nu = a_1 - \\alpha e_1 = \\begin{bmatrix} 12 \\\\ 6 \\\\ -4 \\end{bmatrix} - \\left(-14 \\begin{bmatrix} 1 \\\\ 0 \\\\ 0 \\end{bmatrix}\\right) = \\begin{bmatrix} 12 \\\\ 6 \\\\ -4 \\end{bmatrix} + \\begin{bmatrix} 14 \\\\ 0 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} 26 \\\\ 6 \\\\ -4 \\end{bmatrix}.\n$$\n问题指定反射器的形式为 $H = I - \\tau v v^{\\top}$，并采用 $v_1=1$ 的归一化约定。这种形式下的向量 $v$ 必须与标准反射向量 $u$成比例。令 $v = c u$，其中 $c$ 为某个标量。\n$u$ 的第一个分量是 $u_1 = 26$。为了满足条件 $v_1=1$，我们必须有 $c u_1 = 1$，这得出 $c = \\frac{1}{u_1} = \\frac{1}{26}$。\n因此，向量 $v$ 是\n$$\nv = \\frac{1}{26} u = \\frac{1}{26} \\begin{bmatrix} 26 \\\\ 6 \\\\ -4 \\end{bmatrix} = \\begin{bmatrix} 1 \\\\ \\frac{6}{26} \\\\ -\\frac{4}{26} \\end{bmatrix} = \\begin{bmatrix} 1 \\\\ \\frac{3}{13} \\\\ -\\frac{2}{13} \\end{bmatrix}.\n$$\n由此，我们确定分量 $v_2 = \\frac{3}{13}$ 和 $v_3 = -\\frac{2}{13}$。\n\n现在，我们确定参数 $\\tau$。比较反射器的两种形式，$I - \\tau v v^{\\top} = I - 2 \\frac{u u^{\\top}}{u^{\\top}u}$，我们发现 $\\tau v v^{\\top} = 2 \\frac{u u^{\\top}}{u^{\\top}u}$。\n代入 $u = \\frac{1}{c}v = 26v$，我们得到\n$$\n\\tau v v^{\\top} = 2 \\frac{(26v)(26v)^{\\top}}{(26v)^{\\top}(26v)} = 2 \\frac{26^2 v v^{\\top}}{26^2 v^{\\top}v} = \\frac{2 v v^{\\top}}{v^{\\top}v}.\n$$\n这意味着 $\\tau = \\frac{2}{v^{\\top}v} = \\frac{2}{\\|v\\|_2^2}$。\n我们来计算 $\\|v\\|_2^2$：\n$$\n\\|v\\|_2^2 = v^{\\top}v = 1^2 + \\left(\\frac{3}{13}\\right)^2 + \\left(-\\frac{2}{13}\\right)^2 = 1 + \\frac{9}{169} + \\frac{4}{169} = 1 + \\frac{13}{169} = 1 + \\frac{1}{13} = \\frac{13}{13} + \\frac{1}{13} = \\frac{14}{13}.\n$$\n现在我们可以计算 $\\tau$：\n$$\n\\tau = \\frac{2}{\\frac{14}{13}} = \\frac{2 \\cdot 13}{14} = \\frac{26}{14} = \\frac{13}{7}.\n$$\n所求的值是：\n$\\alpha = -14$\n$\\tau = \\frac{13}{7}$\n$v_2 = \\frac{3}{13}$\n$v_3 = -\\frac{2}{13}$\n这些值以所要求的行向量格式呈現。", "answer": "$$\n\\boxed{\\begin{pmatrix} -14 & \\frac{13}{7} & \\frac{3}{13} & -\\frac{2}{13} \\end{pmatrix}}\n$$", "id": "3549693"}, {"introduction": "构造出反射器后，下一步是高效地将其应用于矩阵。这个练习将揭示 Householder QR 算法的计算精髓：我们几乎从不显式地构建完整的 Householder 矩阵 $H$。你将通过一个具体的例子，推导并运用 $HA = A - \\tau v (v^{\\top}A)$ 这一高效的秩-1 更新公式，并与显式矩阵乘法的结果进行对比，从而深刻理解该算法在实际应用中的性能优势。[@problem_id:3549690]", "problem": "设矩阵 $A \\in \\mathbb{R}^{3 \\times 2}$ 用于通过Householder反射构建正交三角（QR）分解。Householder反射的定义为 $H = I - \\tau v v^{\\top}$，其中 $v \\in \\mathbb{R}^{3}$ 是一个向量，$\\tau \\in \\mathbb{R}$ 是一个标量，其选择使得 $H$ 是正交且对称的。从这个定义和矩阵乘法的基本性质出发，推导出一个用 $v$、$\\tau$ 和 $A$ 表示 $HA$ 的表达式，该表达式避免了显式构造 $H$。然后用它来计算以下给定值的 $HA$：\n$$\nv = \\begin{bmatrix}1 \\\\ 2 \\\\ 0\\end{bmatrix}, \\quad \\tau = \\frac{2}{5}, \\quad A = \\begin{bmatrix}1 & 0 \\\\ 2 & 1 \\\\ 0 & 1\\end{bmatrix}.\n$$\n接着，独立地由 $v$ 和 $\\tau$ 构造出 $H$，并确认显式乘积 $HA$ 与先前获得的结果一致。最后，以精确形式报告弗罗贝尼乌斯范数 $\\|HA\\|_{F}$ 作为你唯一的最终答案。不需要四舍五入，也不涉及单位。", "solution": "用户希望我解决一个关于Householder反射应用的问题。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n- 待变换的矩阵是 $A \\in \\mathbb{R}^{3 \\times 2}$。\n- Householder反射定义为 $H = I - \\tau v v^{\\top}$，其中 $I$ 是单位矩阵，$v \\in \\mathbb{R}^{3}$ 是一个向量，$\\tau \\in \\mathbb{R}$ 是一个标量。\n- 已知 $H$ 是正交且对称的。\n- 参数的具体值为：\n$$\nv = \\begin{bmatrix}1 \\\\ 2 \\\\ 0\\end{bmatrix}, \\quad \\tau = \\frac{2}{5}, \\quad A = \\begin{bmatrix}1 & 0 \\\\ 2 & 1 \\\\ 0 & 1\\end{bmatrix}\n$$\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学基础：** 问题陈述基于数值线性代数中的标准、成熟概念，特别是QR分解中使用的Householder变换。Householder反射的定义是正确的。其正交性条件为 $\\tau = \\frac{2}{v^{\\top}v}$。对于给定的向量 $v$，我们有 $v^{\\top}v = (1)^2 + (2)^2 + (0)^2 = 1+4=5$。因此，$\\tau$ 所需的值为 $\\frac{2}{5}$，这与给定值相符。该问题内部一致且科学上是合理的。\n- **适定性：** 任务很明确：推导一个表达式，用两种方法计算矩阵乘积以确认一致性，然后计算一个范数。所有量都有明确定义，并且存在唯一、稳定的解。\n- **客观性：** 问题以精确的数学语言陈述，没有主观或含糊不清的术语。\n\n**步骤3：结论与行动**\n问题是有效的。我将继续进行详细解答。\n\n### 解题过程\n\n这个问题分为几个部分。首先，我们必须推导乘积 $HA$ 的表达式，该表达式避免了显式构造矩阵 $H$。其次，我们应用此表达式来计算给定数据的 $HA$。第三，我们显式构造 $H$ 并计算 $HA$ 来验证结果。最后，我们计算所得矩阵的弗罗贝尼乌斯范数。\n\n**第1部分：推导Householder反射的有效应用方法**\n\n给定Householder反射的定义 $H = I - \\tau v v^{\\top}$，其中 $I$ 是适当大小的单位矩阵（在本例中为 $3 \\times 3$），$v \\in \\mathbb{R}^3$，$\\tau \\in \\mathbb{R}$。我们想要在不先构造矩阵 $H$ 的情况下计算乘积 $HA$。\n\n利用矩阵乘法的分配律，我们有：\n$$\nHA = (I - \\tau v v^{\\top})A = IA - (\\tau v v^{\\top})A\n$$\n由于 $IA = A$ 且 $\\tau$ 是一个标量，我们可以改变标量乘法的顺序：\n$$\nHA = A - \\tau (v v^{\\top})A\n$$\n利用矩阵乘法的结合律，我们可以将各项组合如下：\n$$\nHA = A - \\tau v (v^{\\top}A)\n$$\n这就是所求的表达式。这种形式在计算上比先构造稠密矩阵 $H$ 然后执行完整的矩阵-矩阵乘法更有效。项 $v^{\\top}A$ 是一个 $1 \\times 3$ 矩阵和一个 $3 \\times 2$ 矩阵的乘积，结果是一个 $1 \\times 2$ 的行向量，我们称之为 $w^{\\top}$。表达式于是变为 $HA = A - \\tau v w^{\\top}$，即原始矩阵 $A$ 被一个秩-1矩阵更新。\n\n**第2部分：使用推导的表达式计算 $HA$**\n\n给定：\n$$\nv = \\begin{bmatrix}1 \\\\ 2 \\\\ 0\\end{bmatrix}, \\quad \\tau = \\frac{2}{5}, \\quad A = \\begin{bmatrix}1 & 0 \\\\ 2 & 1 \\\\ 0 & 1\\end{bmatrix}\n$$\n首先，我们计算行向量 $w^{\\top} = v^{\\top}A$：\n$$\nw^{\\top} = \\begin{bmatrix}1 & 2 & 0\\end{bmatrix} \\begin{bmatrix}1 & 0 \\\\ 2 & 1 \\\\ 0 & 1\\end{bmatrix} = \\begin{bmatrix}(1)(1) + (2)(2) + (0)(0) & (1)(0) + (2)(1) + (0)(1)\\end{bmatrix}\n$$\n$$\nw^{\\top} = \\begin{bmatrix}1+4 & 0+2\\end{bmatrix} = \\begin{bmatrix}5 & 2\\end{bmatrix}\n$$\n现在我们计算外积 $v w^{\\top}$：\n$$\nv w^{\\top} = \\begin{bmatrix}1 \\\\ 2 \\\\ 0\\end{bmatrix} \\begin{bmatrix}5 & 2\\end{bmatrix} = \\begin{bmatrix}(1)(5) & (1)(2) \\\\ (2)(5) & (2)(2) \\\\ (0)(5) & (0)(2)\\end{bmatrix} = \\begin{bmatrix}5 & 2 \\\\ 10 & 4 \\\\ 0 & 0\\end{bmatrix}\n$$\n最后，我们计算 $HA = A - \\tau v w^{\\top}$：\n$$\nHA = \\begin{bmatrix}1 & 0 \\\\ 2 & 1 \\\\ 0 & 1\\end{bmatrix} - \\frac{2}{5} \\begin{bmatrix}5 & 2 \\\\ 10 & 4 \\\\ 0 & 0\\end{bmatrix} = \\begin{bmatrix}1 & 0 \\\\ 2 & 1 \\\\ 0 & 1\\end{bmatrix} - \\begin{bmatrix}\\frac{10}{5} & \\frac{4}{5} \\\\ \\frac{20}{5} & \\frac{8}{5} \\\\ 0 & 0\\end{bmatrix}\n$$\n$$\nHA = \\begin{bmatrix}1 & 0 \\\\ 2 & 1 \\\\ 0 & 1\\end{bmatrix} - \\begin{bmatrix}2 & \\frac{4}{5} \\\\ 4 & \\frac{8}{5} \\\\ 0 & 0\\end{bmatrix} = \\begin{bmatrix}1 - 2 & 0 - \\frac{4}{5} \\\\ 2 - 4 & 1 - \\frac{8}{5} \\\\ 0 - 0 & 1 - 0\\end{bmatrix} = \\begin{bmatrix}-1 & -\\frac{4}{5} \\\\ -2 & -\\frac{3}{5} \\\\ 0 & 1\\end{bmatrix}\n$$\n\n**第3部分：为验证而显式计算 $HA$**\n\n首先，我们显式构造Householder矩阵 $H = I - \\tau v v^{\\top}$。我们需要外积 $v v^{\\top}$：\n$$\nv v^{\\top} = \\begin{bmatrix}1 \\\\ 2 \\\\ 0\\end{bmatrix} \\begin{bmatrix}1 & 2 & 0\\end{bmatrix} = \\begin{bmatrix}1 & 2 & 0 \\\\ 2 & 4 & 0 \\\\ 0 & 0 & 0\\end{bmatrix}\n$$\n现在我们构造 $H$：\n$$\nH = I_3 - \\frac{2}{5} v v^{\\top} = \\begin{bmatrix}1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1\\end{bmatrix} - \\frac{2}{5} \\begin{bmatrix}1 & 2 & 0 \\\\ 2 & 4 & 0 \\\\ 0 & 0 & 0\\end{bmatrix}\n$$\n$$\nH = \\begin{bmatrix}1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1\\end{bmatrix} - \\begin{bmatrix}\\frac{2}{5} & \\frac{4}{5} & 0 \\\\ \\frac{4}{5} & \\frac{8}{5} & 0 \\\\ 0 & 0 & 0\\end{bmatrix} = \\begin{bmatrix}1 - \\frac{2}{5} & -\\frac{4}{5} & 0 \\\\ -\\frac{4}{5} & 1 - \\frac{8}{5} & 0 \\\\ 0 & 0 & 1\\end{bmatrix} = \\begin{bmatrix}\\frac{3}{5} & -\\frac{4}{5} & 0 \\\\ -\\frac{4}{5} & -\\frac{3}{5} & 0 \\\\ 0 & 0 & 1\\end{bmatrix}\n$$\n现在我们直接计算乘积 $HA$：\n$$\nHA = \\begin{bmatrix}\\frac{3}{5} & -\\frac{4}{5} & 0 \\\\ -\\frac{4}{5} & -\\frac{3}{5} & 0 \\\\ 0 & 0 & 1\\end{bmatrix} \\begin{bmatrix}1 & 0 \\\\ 2 & 1 \\\\ 0 & 1\\end{bmatrix}\n$$\n$$\nHA = \\begin{bmatrix} (\\frac{3}{5})(1) + (-\\frac{4}{5})(2) & (\\frac{3}{5})(0) + (-\\frac{4}{5})(1) \\\\ (-\\frac{4}{5})(1) + (-\\frac{3}{5})(2) & (-\\frac{4}{5})(0) + (-\\frac{3}{5})(1) \\\\ (0)(1) + (0)(2) + (1)(0) & (0)(0) + (0)(1) + (1)(1) \\end{bmatrix}\n$$\n$$\nHA = \\begin{bmatrix} \\frac{3 - 8}{5} & -\\frac{4}{5} \\\\ \\frac{-4 - 6}{5} & -\\frac{3}{5} \\\\ 0 & 1 \\end{bmatrix} = \\begin{bmatrix} \\frac{-5}{5} & -\\frac{4}{5} \\\\ \\frac{-10}{5} & -\\frac{3}{5} \\\\ 0 & 1 \\end{bmatrix} = \\begin{bmatrix} -1 & -\\frac{4}{5} \\\\ -2 & -\\frac{3}{5} \\\\ 0 & 1\\end{bmatrix}\n$$\n这个结果与使用有效方法得到的结果相匹配，证实了我们的计算是正确的。\n\n**第4部分：计算弗罗贝尼乌斯范数 $\\|HA\\|_{F}$**\n\n一个元素为 $b_{ij}$ 的矩阵 $B$ 的弗罗贝尼乌斯范数定义为 $\\|B\\|_{F} = \\sqrt{\\sum_{i} \\sum_{j} |b_{ij}|^2}$。对于我们得到的矩阵 $HA$，我们有：\n$$\nHA = \\begin{bmatrix} -1 & -\\frac{4}{5} \\\\ -2 & -\\frac{3}{5} \\\\ 0 & 1\\end{bmatrix}\n$$\n弗罗贝尼乌斯范数的平方是其所有元素平方的总和：\n$$\n\\|HA\\|_{F}^2 = (-1)^2 + \\left(-\\frac{4}{5}\\right)^2 + (-2)^2 + \\left(-\\frac{3}{5}\\right)^2 + (0)^2 + (1)^2\n$$\n$$\n\\|HA\\|_{F}^2 = 1 + \\frac{16}{25} + 4 + \\frac{9}{25} + 0 + 1\n$$\n$$\n\\|HA\\|_{F}^2 = (1 + 4 + 1) + \\left(\\frac{16}{25} + \\frac{9}{25}\\right) = 6 + \\frac{25}{25} = 6 + 1 = 7\n$$\n因此，弗罗贝尼乌斯范数是：\n$$\n\\|HA\\|_{F} = \\sqrt{7}\n$$\n作为检验，由于 $H$ 是一个正交矩阵，弗罗贝尼乌斯范数在乘以 $H$ 后保持不变。我们来计算 $A$ 的弗罗贝尼乌斯范数：\n$$\n\\|A\\|_{F}^2 = (1)^2 + (0)^2 + (2)^2 + (1)^2 + (0)^2 + (1)^2 = 1 + 0 + 4 + 1 + 0 + 1 = 7\n$$\n因此，$\\|A\\|_{F} = \\sqrt{7}$。$\\|HA\\|_{F} = \\|A\\|_{F}$ 这个事实为我们的结果提供了一个独立的验证。题目要求直接从得到的矩阵计算 $\\|HA\\|_F$，我们已经完成了这一步。", "answer": "$$\\boxed{\\sqrt{7}}$$", "id": "3549690"}, {"introduction": "理论上的数学公式在有限精度的计算机上执行时，可能会遇到意想不到的数值陷阱。这个高级实践旨在揭示 Householder 变换中的一个关键细节：符号选择的重要性。你将分析一个经过特殊设计的矩阵族，它会在特定情况下导致灾难性抵消（catastrophic cancellation），并推导误差放大因子，从而理解为什么标准算法中包含一个看似微不足道的符号函数 $\\operatorname{sign}(x_1)$，而这一选择对于保证算法在浮点运算中的稳定性和准确性至关重要。[@problem_id:3549703]", "problem": "考虑在浮点运算中对一个矩阵进行 Householder 正交三角分解 (QR)，其中 Householder 变换由向量 $x \\in \\mathbb{R}^{m}$ 通过构造 $v = x \\pm \\|x\\|_{2} e_{1}$ 生成，反射矩阵为 $H = I - 2 \\frac{v v^{\\top}}{v^{\\top} v}$。设机器运算遵循标准的加法和乘法浮点模型：对于任意两个实数 $a$ 和 $b$，计算得到的和 $\\operatorname{fl}(a \\pm b)$ 满足 $\\operatorname{fl}(a \\pm b) = (a \\pm b) (1 + \\delta)$ 且 $|\\delta| \\leq u$，计算得到的积 $\\operatorname{fl}(ab) = ab(1 + \\delta)$ 且 $|\\delta| \\leq u$，其中 $u$ 是单位舍入。\n\n设计一个矩阵族 $A(\\epsilon) \\in \\mathbb{R}^{m \\times 2}$，其中 $m \\geq 2$ 且参数 $\\epsilon > 0$，其第一列为\n$$\nx(\\epsilon) = \\begin{pmatrix} -1 \\\\ \\epsilon \\\\ 0 \\\\ \\vdots \\\\ 0 \\end{pmatrix},\n$$\n其第二列是与 $e_{1}$ 正交的任意固定向量 $y \\in \\mathbb{R}^{m}$（为确定起见，取 $y = e_{2}$）。在精确运算中，第一步 Householder 变换将 $x(\\epsilon)$ 转换为一个与 $e_{1}$ 成比例的向量，从而得到上三角因子 $R$ 的首个元素等于 $\\pm \\|x(\\epsilon)\\|_{2}$。\n\n使用以上定义，并从 Householder 构造和浮点误差模型的基本原理出发：\n-证明当 $\\epsilon \\to 0$ 时，符号选择 $v = x(\\epsilon) + \\|x(\\epsilon)\\|_{2} e_{1}$ 会在第一个分量 $v_{1}$ 中引起灾难性抵消，而符号选择 $v = x(\\epsilon) + \\operatorname{sign}(x_{1}(\\epsilon)) \\|x(\\epsilon)\\|_{2} e_{1}$ 则可以避免这种情况。\n- 将构造 $v_{1}$ 时的抵消放大因子定义为\n$$\n\\kappa(\\epsilon) := \\frac{|x_{1}(\\epsilon)| + \\|x(\\epsilon)\\|_{2}}{|x_{1}(\\epsilon) + \\|x(\\epsilon)\\|_{2}|} ,\n$$\n该因子衡量了因大小相近的数相减而导致的相对误差的放大。对于灾难性的符号选择 $v = x(\\epsilon) + \\|x(\\epsilon)\\|_{2} e_{1}$，推导当 $\\epsilon \\to 0$ 时 $\\kappa(\\epsilon)$ 的领阶渐近表达式。\n- 简要论证推荐的符号选择 $v = x(\\epsilon) + \\operatorname{sign}(x_{1}(\\epsilon)) \\|x(\\epsilon)\\|_{2} e_{1}$ 如何在浮点运算中后续构造 $R$ 的过程中减轻相对精度的损失。\n\n你的最终答案必须是当 $\\epsilon \\to 0$ 时 $\\kappa(\\epsilon)$ 的单一闭式渐近表达式。无需四舍五入。", "solution": "问题陈述已经过严格验证。\n\n### 步骤 1：提取已知条件\n- Householder 反射矩阵为 $H = I - 2 \\frac{v v^{\\top}}{v^{\\top} v}$。\n- Householder 向量由 $x \\in \\mathbb{R}^{m}$ 通过 $v = x \\pm \\|x\\|_{2} e_{1}$ 构造。\n- 浮点运算法则模型对于操作 $\\oplus, \\ominus, \\otimes$ 满足 $\\operatorname{fl}(a \\operatorname{op} b) = (a \\operatorname{op} b)(1 + \\delta)$，其中 $|\\delta| \\leq u$，$u$ 为单位舍入。\n- 矩阵为 $A(\\epsilon) \\in \\mathbb{R}^{m \\times 2}$，其中 $m \\geq 2$。\n- $A(\\epsilon)$ 的第一列是 $x(\\epsilon) = \\begin{pmatrix} -1 \\\\ \\epsilon \\\\ 0 \\\\ \\vdots \\\\ 0 \\end{pmatrix}$。\n- $A(\\epsilon)$ 的第二列是 $y = e_{2}$。\n- 抵消放大因子定义为 $\\kappa(\\epsilon) := \\frac{|x_{1}(\\epsilon)| + \\|x(\\epsilon)\\|_{2}}{|x_{1}(\\epsilon) + \\|x(\\epsilon)\\|_{2}|}$。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题基于数值线性代数的既定原理，特别是 Householder QR 分解和标准浮点误差分析模型。灾难性抵消问题是数值分析中的一个典型主题。前提条件在事实上是合理的。\n- **适定性**：该问题是适定的。它要求基于明确指定的设置进行演示、推导一个明确定义的量以及进行论证。存在一个唯一的、有意义的解。\n- **客观性**：该问题以精确、客观和形式化的数学语言陈述。它不含主观或基于观点的断言。\n- **完整性与一致性**：该问题是自洽的，并提供了所有必要的定义和数据。设置中没有矛盾。\n- **不存在其他缺陷**（如不切实际、不适定、过于简单等）。这是一个标准的、重要的例子，用以说明实现 Householder 变换时的数值精妙之处。\n\n### 步骤 3：结论与行动\n该问题是**有效的**。将提供完整解答。\n\n### 解题推导\n该问题关注 QR 分解第一步中构造 Householder 向量的数值稳定性。我们已知矩阵 $A(\\epsilon)$ 的第一列为\n$$\nx(\\epsilon) = \\begin{pmatrix} -1 \\\\ \\epsilon \\\\ 0 \\\\ \\vdots \\\\ 0 \\end{pmatrix} \\in \\mathbb{R}^{m}\n$$\n第一个分量是 $x_1(\\epsilon) = -1$。该向量的欧几里得范数为\n$$\n\\|x(\\epsilon)\\|_{2} = \\sqrt{(-1)^2 + \\epsilon^2 + 0^2 + \\dots} = \\sqrt{1 + \\epsilon^2}\n$$\n构造 Householder 向量 $v$ 是为了将 $x(\\epsilon)$ 变换为一个与 $e_1$ 平行的向量。一般构造方法是 $v = x - \\alpha e_1$，其中 $\\alpha = \\pm \\|x\\|_2$。数值上稳健的 $\\alpha$ 选择是 $-\\operatorname{sign}(x_1)\\|x\\|_2$，这样 $v$ 的第一个分量 $v_1 = x_1 - \\alpha = x_1 + \\operatorname{sign}(x_1)\\|x\\|_2$ 就是两个同号数字的和，从而避免灾难性抵消。问题要求我们分析两种特定的符号选择。\n\n**符号选择与灾难性抵消的分析**\n\n首要任务是分析当 $\\epsilon \\to 0$ 时，对于两种不同的符号选择，向量 $v$ 的第一个分量 $v_1$ 的形成过程。\n\n1.  **数值不稳定的选择：$v = x(\\epsilon) + \\|x(\\epsilon)\\|_{2} e_{1}$**\n    该向量的第一个分量是\n    $$\n    v_1 = x_1(\\epsilon) + \\|x(\\epsilon)\\|_{2} = -1 + \\sqrt{1 + \\epsilon^2}\n    $$\n    当 $\\epsilon \\to 0$ 时，项 $\\sqrt{1 + \\epsilon^2}$ 趋近于 $1$。此表达式涉及两个几乎相等的数相减。为了更清楚地看到这一点，我们使用 $\\sqrt{1+z}$ 在 $z=0$ 附近的泰勒展开式，即 $\\sqrt{1+z} = 1 + \\frac{1}{2}z - \\frac{1}{8}z^2 + O(z^3)$。令 $z = \\epsilon^2$，我们得到\n    $$\n    v_1 = -1 + \\left(1 + \\frac{1}{2}\\epsilon^2 - \\frac{1}{8}\\epsilon^4 + O(\\epsilon^6)\\right) = \\frac{1}{2}\\epsilon^2 - \\frac{1}{8}\\epsilon^4 + O(\\epsilon^6)\n    $$\n    对于小的 $\\epsilon$，我们通过减去两个接近 $1$ 的数来计算一个非常小的数 $O(\\epsilon^2)$。在浮点运算中，$\\operatorname{fl}(\\sqrt{1+\\epsilon^2})$ 会有一定的舍入误差。当计算 $\\operatorname{fl}(-1 + \\operatorname{fl}(\\sqrt{1+\\epsilon^2}))$ 时，有效数字的前几位会相互抵消，导致结果带有很大的相对误差。这种现象被称为灾难性抵消。\n\n2.  **数值稳定的选择：$v = x(\\epsilon) + \\operatorname{sign}(x_1(\\epsilon)) \\|x(\\epsilon)\\|_{2} e_{1}$**\n    因为 $x_1(\\epsilon) = -1$，我们有 $\\operatorname{sign}(x_1(\\epsilon)) = -1$。该符号选择变成一个减法：\n    $$\n    v = x(\\epsilon) - \\|x(\\epsilon)\\|_{2} e_{1}\n    $$\n    该向量的第一个分量是\n    $$\n    v_1 = x_1(\\epsilon) - \\|x(\\epsilon)\\|_{2} = -1 - \\sqrt{1 + \\epsilon^2}\n    $$\n    当 $\\epsilon \\to 0$ 时，$v_1$ 趋近于 $-1 - 1 = -2$。这个计算涉及两个同号数相加（或异号数相减）。此操作在数值上是良性的。浮点计算结果 $\\operatorname{fl}(-1 - \\sqrt{1+\\epsilon^2})$ 的相对误差很小，量级与单位舍入 $u$ 相当。灾难性抵消得以避免。\n\n**抵消放大因子 $\\kappa(\\epsilon)$ 的推导**\n\n问题将不稳定符号选择的抵消放大因子定义为\n$$\n\\kappa(\\epsilon) := \\frac{|x_{1}(\\epsilon)| + \\|x(\\epsilon)\\|_{2}}{|x_{1}(\\epsilon) + \\|x(\\epsilon)\\|_{2}|}\n$$\n我们代入已知量：$x_1(\\epsilon) = -1$ 和 $\\|x(\\epsilon)\\|_2 = \\sqrt{1 + \\epsilon^2}$。\n分子是 $|-1| + \\sqrt{1 + \\epsilon^2} = 1 + \\sqrt{1 + \\epsilon^2}$。\n分母是 $|-1 + \\sqrt{1 + \\epsilon^2}|$。因为 $\\epsilon > 0$，所以 $\\sqrt{1+\\epsilon^2} > 1$，绝对值内的项为正。因此，分母是 $\\sqrt{1 + \\epsilon^2} - 1$。\n$\\kappa(\\epsilon)$ 的表达式变为\n$$\n\\kappa(\\epsilon) = \\frac{1 + \\sqrt{1 + \\epsilon^2}}{\\sqrt{1 + \\epsilon^2} - 1}\n$$\n为了找到当 $\\epsilon \\to 0$ 时的领阶渐近表达式，我们再次使用泰勒展开式 $\\sqrt{1 + \\epsilon^2} = 1 + \\frac{1}{2}\\epsilon^2 + O(\\epsilon^4)$。\n将此代入 $\\kappa(\\epsilon)$ 的表达式中：\n分子：$1 + \\left(1 + \\frac{1}{2}\\epsilon^2 + O(\\epsilon^4)\\right) = 2 + \\frac{1}{2}\\epsilon^2 + O(\\epsilon^4)$。当 $\\epsilon \\to 0$ 时，分子趋近于 $2$。\n分母：$\\left(1 + \\frac{1}{2}\\epsilon^2 + O(\\epsilon^4)\\right) - 1 = \\frac{1}{2}\\epsilon^2 + O(\\epsilon^4)$。当 $\\epsilon \\to 0$ 时，分母趋近于 $0$。\n因此，渐近行为由领项之比确定：\n$$\n\\kappa(\\epsilon) \\approx \\frac{2}{\\frac{1}{2}\\epsilon^2} = \\frac{4}{\\epsilon^2}\n$$\n这表明相对误差放大因子以 $\\epsilon^{-2}$ 的二次方增长，这证实了当 $\\epsilon$ 变小时，抵消确实是灾难性的。\n\n**推荐符号选择的论证**\n\n最后的任务是简要论证推荐的符号选择 $v = x(\\epsilon) + \\operatorname{sign}(x_{1}(\\epsilon)) \\|x(\\epsilon)\\|_{2} e_{1}$ 如何在构造上三角因子 $R$ 的过程中减轻相对精度的损失。\n\n整个 Householder 变换步骤的数值稳定性在很大程度上取决于 Householder 向量 $v$ 的精确计算。反射矩阵由 $H = I - 2 \\frac{v v^\\top}{v^\\top v}$ 给出。如果由于灾难性抵消（如使用不稳定的符号选择时）导致 $v$ 计算不准确，那么计算出的反射矩阵 $\\hat{H}$ 将存在显著误差。具体来说，$\\hat{H}$ 可能不再是正交的，并且将其应用于矩阵 $A$ 时，将无法正确地在第一列对角线下方引入零。这意味着结果矩阵 $\\hat{Q}_1 A$ 将不是严格的上三角形式，并且 $R$ 的第一个对角元素 $R_{11}$ 的计算值将不准确。\n\n通过使用推荐的符号选择，可以避免在构造 $v$ 时的灾难性抵消。这确保了 $v$ 及其平方范数 $v^\\top v = 2\\|x\\|_2 (\\|x\\|_2 - x_1)$（对于稳定情况）能够以高相对精度计算。这会导出一个计算出的反射矩阵 $\\hat{H}$，它非常接近一个真正的正交矩阵。将其应用于 $A$ 可以稳健地产生所需的结构（对角线下方的零），并得到一个精确的因子 $R$。因此，QR 分解整个第一步的稳定性取决于这个初始的符号选择。", "answer": "$$\\boxed{\\frac{4}{\\epsilon^2}}$$", "id": "3549703"}]}