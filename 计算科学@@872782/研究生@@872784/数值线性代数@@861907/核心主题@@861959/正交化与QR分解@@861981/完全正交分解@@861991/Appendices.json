{"hands_on_practices": [{"introduction": "理论是抽象的，而实践则使其具体化。本练习将引导你亲手为一个具体的矩阵构建其完整正交分解（COF）。通过运用格拉姆-施密特正交化和吉文斯旋转等基本工具，你不仅将计算出因子 $U$、$R$ 和 $V$，还将验证它们如何揭示矩阵的四个基本子空间。这个过程将加深你对完整正交分解的几何意义和构造方法的理解。[@problem_id:3538260]", "problem": "考虑矩阵 $A \\in \\mathbb{R}^{3 \\times 4}$，其形式如下\n$$\nA \\;=\\;\n\\begin{pmatrix}\n2  & 0 & 2 & 2 \\\\\n0  & 3 & 3 & 3 \\\\\n0  & 0 & 0 & 0\n\\end{pmatrix}.\n$$\n已知 $A$ 的秩为 $2$。仅使用以下基本事实和定义，构造 $A$ 的完全正交分解 (COF)：\n- 正交矩阵 $Q$ 满足 $Q^{T} Q = I$。\n- Givens旋转作用于一对坐标，将向量的一个分量置零，同时保持其欧几里得长度。\n- Gram–Schmidt正交化过程为给定向量集的生成空间产生一组标准正交基。\n- 矩阵的秩等于其列空间的维度；$A$ 的零空间是 $A$ 的行空间在 $\\mathbb{R}^{4}$ 中的正交补；$A^{T}$ 的零空间是 $A$ 的列空间在 $\\mathbb{R}^{3}$ 中的正交补。\n\n你的任务是：\n1. 明确构造一个正交矩阵 $U \\in \\mathbb{R}^{3 \\times 3}$、一个正交矩阵 $V \\in \\mathbb{R}^{4 \\times 4}$ 和一个上块矩阵 $R$，使得 $U^{T} A V$ 的前 $r$ 行（其中 $r = \\mathrm{rank}(A)$）在前导 $r \\times r$ 子块中呈上三角形式，且其余 $(3-r)$ 行为零。特别地，前导 $2 \\times 2$ 子块 $R_{11}$ 必须是上三角矩阵。\n2. 验证子空间关系：列空间 $\\mathcal{R}(A)$ 等于 $U$ 的前 $r$ 列的生成空间，零空间 $\\mathcal{N}(A)$ 等于 $V$ 的后 $4-r$ 列的生成空间，行空间 $\\mathcal{R}(A^{T})$ 等于 $V$ 的前 $r$ 列的生成空间，以及 $A^{T}$ 的零空间 $\\mathcal{N}(A^{T})$ 等于 $U$ 的后 $3-r$ 列的生成空间。\n3. 作为你最终报告的量，计算前导子块 $R_{11}$ 的行列式，即 $\\det(R_{11})$。你的最终答案需要是精确值，无需四舍五入。\n\n你的构造和验证过程必须是自洽的，从上面列出的事实出发，并且不得调用任何关于完全正交分解的现成目标公式。最终答案必须是单个实数值 $\\det(R_{11})$。", "solution": "我们首先确定 $A$ 的结构及其秩。$A$ 的列向量为\n$$\nc_{1} = \\begin{pmatrix} 2 \\\\ 0 \\\\ 0 \\end{pmatrix},\\quad\nc_{2} = \\begin{pmatrix} 0 \\\\ 3 \\\\ 0 \\end{pmatrix},\\quad\nc_{3} = \\begin{pmatrix} 2 \\\\ 3 \\\\ 0 \\end{pmatrix},\\quad\nc_{4} = \\begin{pmatrix} 2 \\\\ 3 \\\\ 0 \\end{pmatrix}.\n$$\n我们观察到 $c_{3} = c_{1} + c_{2}$ 且 $c_{4} = c_{1} + c_{2}$。由于 $c_{1}$ 和 $c_{2}$ 线性无关，且所有列向量都位于它们的生成空间中，我们有 $\\mathrm{rank}(A) = 2$。列空间 $\\mathcal{R}(A)$ 是 $\\mathbb{R}^{3}$ 中的 $\\mathrm{span}\\{e_{1}, e_{2}\\}$（其中 $e_{i}$ 表示第 $i$ 个标准基向量），而 $\\mathcal{N}(A^{T})$ 是其正交补 $\\mathrm{span}\\{e_{3}\\}$。\n\n我们将构造 $V$，使其前两列构成行空间 $\\mathcal{R}(A^{T})$ 的一组标准正交基，后两列构成零空间 $\\mathcal{N}(A)$ 的一组标准正交基。然后我们将构造 $U$，使得用 $U^{T}$ 左乘 $A V$ 会产生一个上三角形式的前导 $2 \\times 2$ 子块。\n\n第1步：为 $\\mathbb{R}^{4}$ 中的行空间和零空间构造标准正交基。\n$A$ 的行向量为\n$$\nr_{1} = (2, 0, 2, 2)^T,\\quad r_{2} = (0, 3, 3, 3)^T,\\quad r_{3} = (0, 0, 0, 0)^T.\n$$\n我们对 $\\{r_{1}, r_{2}\\}$ 应用 Gram–Schmidt 正交化，以获得 $\\mathbb{R}^{4}$ 中 $\\mathcal{R}(A^{T})$ 的一组标准正交基 $\\{v_{1}, v_{2}\\}$。\n\n第一个向量：\n$$\n\\|r_{1}\\| = \\sqrt{2^{2} + 0^{2} + 2^{2} + 2^{2}} = \\sqrt{12} = 2\\sqrt{3},\\quad\nv_{1} = \\frac{r_{1}}{\\|r_{1}\\|} = \\frac{1}{\\sqrt{3}}(1,\\, 0,\\, 1,\\, 1)^T.\n$$\n第二个向量：\n$$\nr_{2} \\cdot v_{1} = 0 \\cdot \\frac{1}{\\sqrt{3}} + 3 \\cdot 0 + 3 \\cdot \\frac{1}{\\sqrt{3}} + 3 \\cdot \\frac{1}{\\sqrt{3}} = \\frac{6}{\\sqrt{3}} = 2\\sqrt{3},\n$$\n$$\nu_{2} = r_{2} - (r_{2} \\cdot v_{1})\\, v_{1} = (0, 3, 3, 3)^T - 2\\sqrt{3}\\left(\\frac{1}{\\sqrt{3}}(1, 0, 1, 1)^T\\right) = (-2, 3, 1, 1)^T,\n$$\n$$\n\\|u_{2}\\| = \\sqrt{(-2)^{2} + 3^{2} + 1^{2} + 1^{2}} = \\sqrt{15},\\quad\nv_{2} = \\frac{u_{2}}{\\|u_{2}\\|} = \\frac{1}{\\sqrt{15}}(-2,\\, 3,\\, 1,\\, 1)^T.\n$$\n因此 $\\{v_{1}, v_{2}\\}$ 是 $\\mathcal{R}(A^{T})$ 的一组标准正交基。\n\n接下来，为 $\\mathcal{N}(A)$ 构造一组标准正交基。由于 $\\mathcal{N}(A)$ 是行空间在 $\\mathbb{R}^{4}$ 中的正交补，我们可以从 $\\mathcal{N}(A)$ 的任意一组基开始，并对其进行正交化。\n\n求解 $A x = 0$。设 $x = (x_{1}, x_{2}, x_{3}, x_{4})^T$，方程组为\n$$\n2 x_{1} + 2 x_{3} + 2 x_{4} = 0,\\quad 3 x_{2} + 3 x_{3} + 3 x_{4} = 0.\n$$\n一组方便的生成集是\n$$\nw_{3} = (-1, -1, 1, 0)^T,\\quad w_{4} = (-1, -1, 0, 1)^T.\n$$\n应用 Gram–Schmidt 正交化：\n$$\nu_{3} = w_{3},\\quad \\|u_{3}\\| = \\sqrt{3},\\quad v_{3} = \\frac{u_{3}}{\\|u_{3}\\|} = \\frac{1}{\\sqrt{3}}(-1,\\, -1,\\, 1,\\, 0)^T.\n$$\n将 $w_{4}$ 投影到 $v_{3}$ 上：\n$$\nw_{4} \\cdot v_{3} = \\frac{2}{\\sqrt{3}},\\quad\nu_{4} = w_{4} - (w_{4} \\cdot v_{3})\\, v_{3}\n= (-1, -1, 0, 1)^T - \\frac{2}{\\sqrt{3}}\\left(\\frac{1}{\\sqrt{3}}(-1, -1, 1, 0)^T\\right)\n= \\left(-\\frac{1}{3},\\, -\\frac{1}{3},\\, -\\frac{2}{3},\\, 1\\right)^T,\n$$\n$$\n\\|u_{4}\\|^{2} = \\frac{1}{9} + \\frac{1}{9} + \\frac{4}{9} + 1 = \\frac{15}{9} = \\frac{5}{3},\\quad \\|u_{4}\\| = \\frac{\\sqrt{5}}{\\sqrt{3}},\\quad\nv_{4} = \\frac{u_{4}}{\\|u_{4}\\|} = \\frac{\\sqrt{3}}{\\sqrt{5}}\\left(-\\frac{1}{3},\\, -\\frac{1}{3},\\, -\\frac{2}{3},\\, 1\\right)^T\n= \\frac{1}{\\sqrt{15}}(-1,\\, -1,\\, -2,\\, 3)^T.\n$$\n根据构造，$\\{v_{3}, v_{4}\\}$ 是 $\\mathcal{N}(A)$ 的一组标准正交基，而 $\\{v_{1}, v_{2}, v_{3}, v_{4}\\}$ 是 $\\mathbb{R}^{4}$ 的一组标准正交基，因此将它们作为列向量组合起来，得到一个正交矩阵\n$$\nV = \\begin{pmatrix} v_{1} & v_{2} & v_{3} & v_{4} \\end{pmatrix} \\in \\mathbb{R}^{4 \\times 4}.\n$$\n\n第2步：构造 $A V$ 并通过对行进行 Givens 旋转，将前导 $2 \\times 2$ 子块三角化。\n我们首先用 $\\{c_{1}, c_{2}\\}$ 来表示 $A$ 对任意 $x \\in \\mathbb{R}^{4}$ 的作用。注意到 $c_{3} = c_{1} + c_{2}$ 且 $c_{4} = c_{1} + c_{2}$，我们有\n$$\nA x = x_{1} c_{1} + x_{2} c_{2} + x_{3}(c_{1} + c_{2}) + x_{4}(c_{1} + c_{2})\n= (x_{1} + x_{3} + x_{4}) c_{1} + (x_{2} + x_{3} + x_{4}) c_{2}.\n$$\n因此，对于 $V$ 的任意列向量 $v$，$A v = \\alpha c_{1} + \\beta c_{2}$，其中 $\\alpha = v_{1} + v_{3} + v_{4}$ 且 $\\beta = v_{2} + v_{3} + v_{4}$（下标表示 $v$ 的分量）。将此应用于 $v_{1}$ 和 $v_{2}$：\n- 对于 $v_{1} = \\frac{1}{\\sqrt{3}}(1,\\, 0,\\, 1,\\, 1)^T$，\n$$\n\\alpha_{1} = \\frac{1}{\\sqrt{3}} + \\frac{1}{\\sqrt{3}} + \\frac{1}{\\sqrt{3}} = \\sqrt{3},\\quad\n\\beta_{1} = 0 + \\frac{1}{\\sqrt{3}} + \\frac{1}{\\sqrt{3}} = \\frac{2}{\\sqrt{3}},\n$$\n$$\nA v_{1} = \\sqrt{3}\\, c_{1} + \\frac{2}{\\sqrt{3}}\\, c_{2} = \\begin{pmatrix} 2\\sqrt{3} \\\\ 2\\sqrt{3} \\\\ 0 \\end{pmatrix}.\n$$\n- 对于 $v_{2} = \\frac{1}{\\sqrt{15}}(-2,\\, 3,\\, 1,\\, 1)^T$，\n$$\n\\alpha_{2} = \\frac{-2}{\\sqrt{15}} + \\frac{1}{\\sqrt{15}} + \\frac{1}{\\sqrt{15}} = 0,\\quad\n\\beta_{2} = \\frac{3}{\\sqrt{15}} + \\frac{1}{\\sqrt{15}} + \\frac{1}{\\sqrt{15}} = \\frac{5}{\\sqrt{15}} = \\sqrt{\\frac{5}{3}},\n$$\n$$\nA v_{2} = 0 \\cdot c_{1} + \\sqrt{\\frac{5}{3}}\\, c_{2} = \\begin{pmatrix} 0 \\\\ \\sqrt{15} \\\\ 0 \\end{pmatrix}.\n$$\n对于 $v_{3}$ 和 $v_{4}$（它们位于 $\\mathcal{N}(A)$ 中），我们有 $A v_{3} = 0$ 和 $A v_{4} = 0$。\n\n因此，$A V$ 的前两列是\n$$\nA v_{1} = \\begin{pmatrix} 2\\sqrt{3} \\\\ 2\\sqrt{3} \\\\ 0 \\end{pmatrix},\\quad\nA v_{2} = \\begin{pmatrix} 0 \\\\ \\sqrt{15} \\\\ 0 \\end{pmatrix},\n$$\n而后两列为零。为了得到一个上三角的前导 $2 \\times 2$ 子块，我们对前两行应用一个 Givens 旋转 $G \\in \\mathbb{R}^{2 \\times 2}$，当它左乘前导 $2 \\times 2$ 子块时，将 $(2,1)$ 位置的元素置零。\n令 $a = \\begin{pmatrix} 2\\sqrt{3} \\\\ 2\\sqrt{3} \\end{pmatrix}$。我们寻找 $G = \\begin{pmatrix} c & s \\\\ -s & c \\end{pmatrix}$ 使得 $G a = \\begin{pmatrix} \\rho \\\\ 0 \\end{pmatrix}$。我们有 $\\rho = \\|a\\| = \\sqrt{(2\\sqrt{3})^{2} + (2\\sqrt{3})^{2}} = 2\\sqrt{6}$，$c = \\frac{2\\sqrt{3}}{\\rho} = \\frac{1}{\\sqrt{2}}$，$s = \\frac{2\\sqrt{3}}{\\rho} = \\frac{1}{\\sqrt{2}}$。\n将此 Givens 变换嵌入到 $U^T \\in \\mathbb{R}^{3 \\times 3}$ 中，并定义 $U = (U^T)^T$。\n$$\nU^T = \\begin{pmatrix}\n\\frac{1}{\\sqrt{2}}  & \\frac{1}{\\sqrt{2}}  & 0 \\\\\n-\\frac{1}{\\sqrt{2}} & \\frac{1}{\\sqrt{2}} & 0 \\\\\n0  & 0  & 1\n\\end{pmatrix},\\quad \\text{so} \\quad U = \\begin{pmatrix}\n\\frac{1}{\\sqrt{2}}  & -\\frac{1}{\\sqrt{2}} & 0 \\\\\n\\frac{1}{\\sqrt{2}}  & \\frac{1}{\\sqrt{2}} & 0 \\\\\n0  & 0  & 1\n\\end{pmatrix}.\n$$\n这个 $U$ 是正交的。我们计算 $U^{T} A V$：\n$$\nU^{T} (AV) = U^T \\begin{pmatrix} 2\\sqrt{3} & 0 & 0 & 0 \\\\ 2\\sqrt{3} & \\sqrt{15} & 0 & 0 \\\\ 0 & 0 & 0 & 0 \\end{pmatrix} = \\begin{pmatrix}\n2\\sqrt{6} & \\frac{\\sqrt{15}}{\\sqrt{2}} & 0 & 0 \\\\\n0 & \\frac{\\sqrt{15}}{\\sqrt{2}} & 0 & 0 \\\\\n0 & 0 & 0 & 0\n\\end{pmatrix}.\n$$\n这定义了矩阵 $R = U^T A V$。前导 $2 \\times 2$ 子块是\n$$\nR_{11} = \\begin{pmatrix} 2\\sqrt{6} & \\frac{\\sqrt{15}}{\\sqrt{2}} \\\\ 0 & \\frac{\\sqrt{15}}{\\sqrt{2}} \\end{pmatrix},\n$$\n它是上三角矩阵，且剩余行为零，这符合完全正交分解的要求。\n\n第3步：验证子空间关系。\n- $\\mathcal{R}(A)$ 等于 $U$ 的前2列的生成空间。$U$ 的前两列是 $\\begin{pmatrix} \\frac{1}{\\sqrt{2}} \\\\ \\frac{1}{\\sqrt{2}} \\\\ 0 \\end{pmatrix}$ 和 $\\begin{pmatrix} -\\frac{1}{\\sqrt{2}} \\\\ \\frac{1}{\\sqrt{2}} \\\\ 0 \\end{pmatrix}$，它们显然与 $\\{e_{1}, e_{2}\\}$ 在 $\\mathbb{R}^{3}$ 中生成同一个平面，即 $\\mathcal{R}(A)$。\n- $\\mathcal{N}(A^{T})$ 等于 $U$ 的最后1列的生成空间。$U$ 的最后一列是 $e_{3}$，并且确实 $\\mathcal{N}(A^{T}) = \\mathrm{span}\\{e_{3}\\}$，因为 $A$ 的第三行为零，且前两行生成一个与 $e_{3}$ 正交的二维子空间。\n- $\\mathcal{R}(A^{T})$ 等于 $V$ 的前2列的生成空间。根据构造，$v_{1}$ 和 $v_{2}$ 是通过对 $\\{r_{1}, r_{2}\\}$ 进行 Gram–Schmidt 正交化得到的，因此它们构成了 $A$ 的行空间的一组标准正交基。\n- $\\mathcal{N}(A)$ 等于 $V$ 的后2列的生成空间。根据构造，$v_{3}$ 和 $v_{4}$ 是 $A$ 的零空间中的标准正交向量（因为它们是 $w_{3}$ 和 $w_{4}$ 的标准正交组合，而 $w_{3}$ 和 $w_{4}$ 都满足 $A w_{3} = 0$ 和 $A w_{4} = 0$），因此它们生成 $\\mathcal{N}(A)$。\n\n第4步：计算 $R_{11}$ 的行列式。\n由于 $R_{11}$ 是上三角矩阵，其行列式等于其对角线元素的乘积：\n$$\n\\det(R_{11}) = \\left(2\\sqrt{6}\\right)\\left(\\frac{\\sqrt{15}}{\\sqrt{2}}\\right) = 2 \\cdot \\frac{\\sqrt{6}\\sqrt{15}}{\\sqrt{2}} = 2 \\cdot \\sqrt{\\frac{90}{2}} = 2 \\cdot \\sqrt{45} = 2 \\cdot 3\\sqrt{5} = 6\\sqrt{5}.\n$$\n这就是所要求的最终量。", "answer": "$$\\boxed{6\\sqrt{5}}$$", "id": "3538260"}, {"introduction": "在了解了如何构建完整正交分解之后，一个自然的问题是：我们为什么需要这样一个看似复杂的分解？本练习通过一个精心设计的反例，揭示了更为简单的数值方法（如不带主元的QR分解）在确定矩阵数值秩时的缺陷。通过对比该朴素方法与基于奇异值得出的真实数值秩，你将深刻体会到秩揭示分解的重要性以及数值计算中存在的微妙陷阱。[@problem_id:3538253]", "problem": "设 $A \\in \\mathbb{R}^{2 \\times 3}$ 由下式给出\n$$\nA \\;=\\; \\begin{pmatrix}\n10^{-12}  & 1 & 1 \\\\\n0 & 10^{-10} & -10^{-10}\n\\end{pmatrix}.\n$$\n考虑以下旨在近似完全正交分解 (COF) 的流程：首先计算无主元 QR 分解（正交三角分解）$A = Q R$，其中 $Q \\in \\mathbb{R}^{2 \\times 2}$ 是正交矩阵，$R \\in \\mathbb{R}^{2 \\times 3}$ 是上梯形矩阵；然后从右侧应用一个仅作用于最后两列的正交变换，以化简右上角的块。具体来说，令\n$$\nZ_{\\mathrm{rot}} \\;=\\; \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 & 1 \\\\ 1 & -1 \\end{pmatrix}, \n\\qquad\n\\Pi \\;=\\; \\begin{pmatrix} 0 & 1 \\\\ 1 & 0 \\end{pmatrix},\n\\qquad\nZ \\;=\\; \\operatorname{diag}(1,\\, Z_{\\mathrm{rot}} \\Pi) \\in \\mathbb{R}^{3 \\times 3},\n$$\n并构造 $\\widehat{R} = R Z$。假设以下定义为基本依据：\n- $A$ 的奇异值分解 (SVD) 的奇异值为 $\\sigma_{1}(A) \\ge \\sigma_{2}(A) \\ge \\cdots \\ge 0$，且算子 $2$-范数为 $\\|A\\|_{2} = \\sigma_{1}(A)$。\n- $A$ 在相对容差 $\\tau > 0$ 下的数值秩是严格大于 $\\tau \\|A\\|_{2}$ 的奇异值的数量。\n- 朴素的基于无主元 QR 的秩估计器计算上三角/梯形因子的对角线元素：给定 $\\widehat{R}$，定义\n$$\n\\widehat{k} \\;=\\; \\# \\left\\{ i : \\left| \\widehat{r}_{ii} \\right| \\ge \\tau \\left| \\widehat{r}_{11} \\right| \\right\\}.\n$$\n仅使用这些定义以及正交三角分解和正交相似性的第一性原理，完成以下操作：\n1. 根据 $A$ 的奇异值，确定在相对容差 $\\tau = 10^{-8}$ 下 $A$ 的数值秩。\n2. 计算 $A$ 的无主元 QR 分解得到 $R$，然后如上所述构造 $\\widehat{R} = R Z$。使用朴素估计器，在相同的容差 $\\tau = 10^{-8}$ 下计算 $\\widehat{k}$。\n\n你的最终答案必须是 $\\widehat{k}$ 的单一值。无需四舍五入，不涉及单位。将最终答案表示为单个整数。", "solution": "该问题已经过验证，被确定为是良构的、有科学依据且内部一致的。它提出了一个数值线性代数中的标准练习，旨在说明某些秩估计方法的不可靠性。我们继续进行完整的解答。\n\n该问题需要两个不同的计算：首先，基于矩阵 $A$ 的奇异值确定其数值秩；其次，使用朴素的基于无主元 QR 的方法计算秩估计值 $\\widehat{k}$。\n\n设给定矩阵为 $A \\in \\mathbb{R}^{2 \\times 3}$：\n$$ A = \\begin{pmatrix} 10^{-12} & 1 & 1 \\\\ 0 & 10^{-10} & -10^{-10} \\end{pmatrix} $$\n给定的相对容差为 $\\tau = 10^{-8}$。\n\n**1. 基于奇异值分解 (SVD) 的数值秩**\n\n$A$ 的奇异值 $\\sigma_i(A)$ 是矩阵 $A A^T$ 特征值的平方根。我们计算 $A A^T$：\n$$ A A^T = \\begin{pmatrix} 10^{-12} & 1 & 1 \\\\ 0 & 10^{-10} & -10^{-10} \\end{pmatrix} \\begin{pmatrix} 10^{-12} & 0 \\\\ 1 & 10^{-10} \\\\ 1 & -10^{-10} \\end{pmatrix} $$\n$$ A A^T = \\begin{pmatrix} (10^{-12})^2 + 1^2 + 1^2 & 1 \\cdot 10^{-10} + 1 \\cdot (-10^{-10}) \\\\ 0 & (10^{-10})^2 + (-10^{-10})^2 \\end{pmatrix} $$\n$$ A A^T = \\begin{pmatrix} 2 + 10^{-24} & 0 \\\\ 0 & 2 \\cdot 10^{-20} \\end{pmatrix} $$\n由于 $A A^T$ 是一个对角矩阵，其特征值即为其对角线元素：\n$$ \\lambda_1 = 2 + 10^{-24} \\quad \\text{和} \\quad \\lambda_2 = 2 \\times 10^{-20} $$\n$A$ 的奇异值是这些特征值的平方根，按非递增顺序排列。\n$$ \\sigma_1(A) = \\sqrt{2 + 10^{-24}} \\quad \\text{和} \\quad \\sigma_2(A) = \\sqrt{2 \\times 10^{-20}} = \\sqrt{2} \\times 10^{-10} $$\n算子 $2$-范数为 $\\|A\\|_2 = \\sigma_1(A) = \\sqrt{2 + 10^{-24}}$。\n\n根据问题的定义，数值秩是严格大于 $\\tau \\|A\\|_2$ 的奇异值 $\\sigma_i(A)$ 的数量。阈值为：\n$$ \\tau \\|A\\|_2 = 10^{-8} \\sqrt{2 + 10^{-24}} $$\n我们将每个奇异值与此阈值进行比较。\n对于 $\\sigma_1(A)$：\n$$ \\sqrt{2 + 10^{-24}} > 10^{-8} \\sqrt{2 + 10^{-24}} $$\n这个不等式成立，因为 $1 > 10^{-8}$。因此，第一个奇异值被计数。\n\n对于 $\\sigma_2(A)$：\n$$ \\sqrt{2} \\times 10^{-10} > 10^{-8} \\sqrt{2 + 10^{-24}} $$\n由于 $10^{-24}$ 与 $2$ 相比可以忽略不计，我们有 $\\sqrt{2 + 10^{-24}} \\approx \\sqrt{2}$。该不等式近似为：\n$$ \\sqrt{2} \\times 10^{-10} > 10^{-8} \\sqrt{2} $$\n两边除以 $\\sqrt{2}$ 得到 $10^{-10} > 10^{-8}$，这是错误的。\n因此，只有一个奇异值大于阈值。在给定容差下，$A$ 的数值秩为 $1$。\n\n**2. 朴素的基于 QR 的秩估计器**\n\n接下来，我们按照规定的流程计算 $\\widehat{k}$。\n\n首先，我们求无主元 QR 分解 $A = QR$。矩阵 $A$ 已经是上梯形形式。任何应用于上梯形矩阵的无主元 QR 分解的标准算法（例如基于 Householder 反射或 Givens 旋转的算法）都将导致正交因子 $Q$ 为单位矩阵。因此，我们有：\n$$ Q = I = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} \\quad \\text{和} \\quad R = A = \\begin{pmatrix} 10^{-12} & 1 & 1 \\\\ 0 & 10^{-10} & -10^{-10} \\end{pmatrix} $$\n\n其次，我们构造正交矩阵 $Z \\in \\mathbb{R}^{3 \\times 3}$。给定：\n$$ Z_{\\mathrm{rot}} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 & 1 \\\\ 1 & -1 \\end{pmatrix}, \\quad \\Pi = \\begin{pmatrix} 0 & 1 \\\\ 1 & 0 \\end{pmatrix} $$\n我们计算乘积 $Z_{\\mathrm{rot}} \\Pi$：\n$$ Z_{\\mathrm{rot}} \\Pi = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 & 1 \\\\ 1 & -1 \\end{pmatrix} \\begin{pmatrix} 0 & 1 \\\\ 1 & 0 \\end{pmatrix} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 & 1 \\\\ -1 & 1 \\end{pmatrix} $$\n然后，$Z$ 被构造成一个块对角矩阵：\n$$ Z = \\operatorname{diag}(1, Z_{\\mathrm{rot}} \\Pi) = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & \\frac{1}{\\sqrt{2}} & \\frac{1}{\\sqrt{2}} \\\\ 0 & -\\frac{1}{\\sqrt{2}} & \\frac{1}{\\sqrt{2}} \\end{pmatrix} $$\n\n第三，我们构造矩阵 $\\widehat{R} = RZ$：\n$$ \\widehat{R} = \\begin{pmatrix} 10^{-12} & 1 & 1 \\\\ 0 & 10^{-10} & -10^{-10} \\end{pmatrix} \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & \\frac{1}{\\sqrt{2}} & \\frac{1}{\\sqrt{2}} \\\\ 0 & -\\frac{1}{\\sqrt{2}} & \\frac{1}{\\sqrt{2}} \\end{pmatrix} $$\n进行矩阵乘法：\n$$ \\widehat{R} = \\begin{pmatrix} 10^{-12} & 1 \\cdot \\frac{1}{\\sqrt{2}} + 1 \\cdot (-\\frac{1}{\\sqrt{2}}) & 1 \\cdot \\frac{1}{\\sqrt{2}} + 1 \\cdot \\frac{1}{\\sqrt{2}} \\\\ 0 & 10^{-10} \\cdot \\frac{1}{\\sqrt{2}} + (-10^{-10}) \\cdot (-\\frac{1}{\\sqrt{2}}) & 10^{-10} \\cdot \\frac{1}{\\sqrt{2}} + (-10^{-10}) \\cdot \\frac{1}{\\sqrt{2}} \\end{pmatrix} $$\n$$ \\widehat{R} = \\begin{pmatrix} 10^{-12} & 0 & \\frac{2}{\\sqrt{2}} \\\\ 0 & \\frac{2 \\times 10^{-10}}{\\sqrt{2}} & 0 \\end{pmatrix} = \\begin{pmatrix} 10^{-12} & 0 & \\sqrt{2} \\\\ 0 & \\sqrt{2} \\times 10^{-10} & 0 \\end{pmatrix} $$\n$\\widehat{R}$ 的对角线元素是 $\\widehat{r}_{11} = 10^{-12}$ 和 $\\widehat{r}_{22} = \\sqrt{2} \\times 10^{-10}$。\n\n最后，我们使用提供的公式计算秩估计值 $\\widehat{k}$：\n$$ \\widehat{k} = \\# \\left\\{ i : \\left| \\widehat{r}_{ii} \\right| \\ge \\tau \\left| \\widehat{r}_{11} \\right| \\right\\} $$\n缩放因子为 $|\\widehat{r}_{11}| = |10^{-12}| = 10^{-12}$。比较的阈值为：\n$$ \\tau |\\widehat{r}_{11}| = 10^{-8} \\cdot 10^{-12} = 10^{-20} $$\n我们检验 $\\widehat{R}$ 的对角线元素：\n对于 $i=1$：\n$$ |\\widehat{r}_{11}| = 10^{-12} $$\n$10^{-12} \\ge 10^{-20}$ 是否成立？是的，这是成立的。\n\n对于 $i=2$：\n$$ |\\widehat{r}_{22}| = |\\sqrt{2} \\times 10^{-10}| = \\sqrt{2} \\times 10^{-10} $$\n$\\sqrt{2} \\times 10^{-10} \\ge 10^{-20}$ 是否成立？是的，这也成立，因为 $\\sqrt{2} \\times 10^{-10} \\approx 1.414 \\times 10^{-10}$，远大于 $10^{-20}$。\n\n两个对角线元素都满足条件。因此，计数为：\n$$ \\widehat{k} = 2 $$\n这个结果突显了朴素秩估计器的致命弱点，它高估了真实的数值秩（$1$），得出了秩为 $2$ 的结论。这种失败是由于分解的无主元特性造成的，这导致了一个异常小的前导对角元素 $|\\widehat{r}_{11}|$，从而严重压低了比较阈值。", "answer": "$$\\boxed{2}$$", "id": "3538253"}, {"introduction": "我们已经看到，不带主元的QR分解可能会失效。一个自然的改进是采用列主元QR分解（CPQR）。然而，这是否总是足够？这个进阶练习展示了一个更为精妙的情形：即使是列主元QR分解这种更稳健的方法，也可能对矩阵的秩结构给出误导性的信息。通过分析这一特例，并对比CPQR与理想COF的结果，你将理解为何从左右两边同时施加正交变换对于构造一个真正可靠的秩揭示分解是至关重要的。[@problem_id:3538195]", "problem": "设 $m=2$ 且 $n=k+1$，其中 $k \\in \\mathbb{N}$，$k \\geq 2$。考虑两个标准正交向量 $u \\in \\mathbb{R}^{2}$ 和 $v \\in \\mathbb{R}^{2}$，其中 $u=\\begin{pmatrix}1 \\\\ 0\\end{pmatrix}$ 且 $v=\\begin{pmatrix}0 \\\\ 1\\end{pmatrix}$。通过拼接列向量定义矩阵 $A(\\alpha,\\beta,k) \\in \\mathbb{R}^{2 \\times (k+1)}$\n$$\nA(\\alpha,\\beta,k) = \\big[\\, \\alpha v \\,,\\, \\underbrace{\\beta u \\,,\\, \\beta u \\,,\\, \\ldots \\,,\\, \\beta u}_{k \\text{ 个副本}} \\,\\big],\n$$\n其中参数 $\\alpha>0$ 和 $\\beta>0$ 满足 $ \\beta \\alpha \\ll \\sqrt{k}\\,\\beta$。设 $r=1$。\n\n从奇异值分解和矩阵谱范数的基本定义，以及贪心带列主元的QR分解过程（该过程通过最大剩余$2$-范数选择主元列）的定义出发，完成以下任务：\n\n1. 通过分析 $A(\\alpha,\\beta,k)A(\\alpha,\\beta,k)^{\\top}$，推导奇异值 $\\sigma_{1}(A)$ 和 $\\sigma_{2}(A)$。\n\n2. 在条件 $\\alpha>\\beta$ 下，对 $A(\\alpha,\\beta,k)$ 应用带列主元的QR分解的第一步（秩 $r=1$）。仅使用标准正交变换的定义和得到的上梯形结构，构建 $R$ 因子，并识别在 $r=1$ 处分块时的尾部子块 $R_{22}$。计算 $\\|R_{22}\\|_{2}$。\n\n3. 使用完全正交分解（COF）的定义，解释如何选择额外的行和列的正交变换（包括行主元选择），从而获得一个正交矩阵 $U \\in \\mathbb{R}^{2 \\times 2}$ 和一个正交矩阵 $Z \\in \\mathbb{R}^{(k+1) \\times (k+1)}$，满足\n$$\nU^{\\top}A(\\alpha,\\beta,k)\\Pi Z = \\begin{pmatrix} R_{11} & R_{12} \\\\ 0 & R_{22} \\end{pmatrix},\n$$\n其中 $\\Pi$ 是由初始带列主元的QR分解所产生的列置换，且 $R_{11} \\in \\mathbb{R}^{1 \\times 1}$，$R_{22} \\in \\mathbb{R}^{1 \\times k}$。确定在此COF中的 $\\|R_{22}\\|_{2}$。\n\n4. 基于第2项和第3项的结果，计算改进因子\n$$\nF \\;=\\; \\frac{\\|R_{22}\\|_{2}^{\\mathrm{(CPQR)}}}{\\|R_{22}\\|_{2}^{\\mathrm{(COF)}}}\n$$\n作为关于 $k$、$\\alpha$ 和 $\\beta$ 的闭式解析表达式。\n\n将您的最终答案表示为单一的简化符号表达式，不带单位。无需四舍五入。", "solution": "我们首先明确地构造矩阵 $A(\\alpha,\\beta,k)$。给定 $u=\\begin{pmatrix}1 \\\\ 0\\end{pmatrix}$ 和 $v=\\begin{pmatrix}0 \\\\ 1\\end{pmatrix}$，我们有 $\\alpha v = \\begin{pmatrix}0 \\\\ \\alpha\\end{pmatrix}$ 和 $\\beta u = \\begin{pmatrix}\\beta \\\\ 0\\end{pmatrix}$。\n矩阵 $A \\in \\mathbb{R}^{2 \\times (k+1)}$ 是这些列向量的拼接：\n$$\nA = \\begin{pmatrix}\n0 & \\beta & \\beta & \\cdots & \\beta \\\\\n\\alpha & 0 & 0 & \\cdots & 0\n\\end{pmatrix}\n$$\n其中有 $k$ 列 $\\begin{pmatrix}\\beta \\\\ 0\\end{pmatrix}$。\n\n**1. 奇异值的推导**\n\n矩阵 $A$ 的奇异值 $\\sigma_i(A)$ 定义为矩阵 $A A^{\\top}$ 的特征值的平方根。我们计算这个 $2 \\times 2$ 矩阵：\n$$\nA A^{\\top} = \\begin{pmatrix}\n0 & \\beta & \\cdots & \\beta \\\\\n\\alpha & 0 & \\cdots & 0\n\\end{pmatrix}\n\\begin{pmatrix}\n0 & \\alpha \\\\\n\\beta & 0 \\\\\n\\vdots & \\vdots \\\\\n\\beta & 0\n\\end{pmatrix}\n$$\n$A A^{\\top}$ 的元素是：\n- $(1,1)$: $(0)(0) + k \\cdot (\\beta)(\\beta) = k\\beta^2$\n- $(1,2)$: $(0)(\\alpha) + k \\cdot (\\beta)(0) = 0$\n- $(2,1)$: $(\\alpha)(0) + k \\cdot (0)(\\beta) = 0$\n- $(2,2)$: $(\\alpha)(\\alpha) + k \\cdot (0)(0) = \\alpha^2$\n因此，得到的矩阵是对角矩阵：\n$$\nA A^{\\top} = \\begin{pmatrix}\nk\\beta^2 & 0 \\\\\n0 & \\alpha^2\n\\end{pmatrix}\n$$\n对角矩阵的特征值是其对角线上的元素。设它们为 $\\lambda_1$ 和 $\\lambda_2$。它们是 $\\alpha^2$ 和 $k\\beta^2$。对应的奇异值平方是 $\\sigma_1^2$ 和 $\\sigma_2^2$。按照惯例，$\\sigma_1 \\geq \\sigma_2$。我们必须比较 $\\alpha^2$ 和 $k\\beta^2$。问题给出的条件 $\\beta \\alpha \\ll \\sqrt{k}\\,\\beta$ 暗示 $\\alpha \\ll \\sqrt{k}\\beta$。因为 $\\alpha, \\beta, k$ 都是正数，对这个不等式两边平方得到 $\\alpha^2 \\ll k\\beta^2$。\n因此，较大的特征值是 $k\\beta^2$。\n$$\n\\sigma_1^2 = k\\beta^2 \\implies \\sigma_1(A) = \\sqrt{k\\beta^2} = \\beta\\sqrt{k}\n$$\n较小的特征值是 $\\alpha^2$。\n$$\n\\sigma_2^2 = \\alpha^2 \\implies \\sigma_2(A) = \\sqrt{\\alpha^2} = \\alpha\n$$\n\n**2. 带列主元的QR分解（CPQR）**\n\n贪心带列主元的QR分解过程选择剩余矩阵中欧几里得$2$-范数最大的列。对于第一步，我们计算 $A$ 的所有列的范数。设 $a_j$ 是 $A$ 的第 $j$ 列。\n- $\\|a_1\\|_2 = \\left\\| \\begin{pmatrix} 0 \\\\ \\alpha \\end{pmatrix} \\right\\|_2 = \\sqrt{0^2 + \\alpha^2} = \\alpha$。\n- 对于 $j=2, \\ldots, k+1$, $\\|a_j\\|_2 = \\left\\| \\begin{pmatrix} \\beta \\\\ 0 \\end{pmatrix} \\right\\|_2 = \\sqrt{\\beta^2 + 0^2} = \\beta$。\n条件 $\\alpha > \\beta$ 是已知的。因此，第一列 $a_1$ 具有最大的范数。它被选为主元列。列置换矩阵 $\\Pi$ 是单位矩阵，$\\Pi=I$。\n\n接下来，我们找到一个正交矩阵 $Q_1 \\in \\mathbb{R}^{2 \\times 2}$ 将 $A$ 变换为上梯形形式 $R$。我们需要 $Q_1^{\\top}A = R$，其中 $R$ 的第一列形式为 $\\begin{pmatrix} \\gamma \\\\ 0 \\end{pmatrix}$，且 $|\\gamma| = \\|a_1\\|_2 = \\alpha$。一个能实现这一点的简单正交矩阵是置换矩阵。我们选择 $Q_1 = \\begin{pmatrix} 0 & 1 \\\\ 1 & 0 \\end{pmatrix}$。这个矩阵是正交的，因为 $Q_1 Q_1^{\\top} = I$。\n$$\nR = Q_1^{\\top} A = \\begin{pmatrix} 0 & 1 \\\\ 1 & 0 \\end{pmatrix} \\begin{pmatrix}\n0 & \\beta & \\cdots & \\beta \\\\\n\\alpha & 0 & \\cdots & 0\n\\end{pmatrix} = \\begin{pmatrix}\n\\alpha & 0 & \\cdots & 0 \\\\\n0 & \\beta & \\cdots & \\beta\n\\end{pmatrix}\n$$\n这个矩阵 $R$ 是上梯形的。我们在秩 $r=1$ 处对其进行分块：\n$$\nR = \\begin{pmatrix} R_{11} & R_{12} \\\\ 0 & R_{22} \\end{pmatrix}\n$$\n其中 $R_{11} \\in \\mathbb{R}^{1 \\times 1}$，$R_{12} \\in \\mathbb{R}^{1 \\times k}$，以及 $R_{22} \\in \\mathbb{R}^{1 \\times k}$。\n从 $R$ 的结构来看：\n- $R_{11} = [\\alpha]$\n- $R_{12} = \\begin{pmatrix} 0 & 0 & \\cdots & 0 \\end{pmatrix}$\n- 次对角线块是 $0 \\in \\mathbb{R}^{1 \\times 1}$。\n- $R_{22} = \\begin{pmatrix} \\beta & \\beta & \\cdots & \\beta \\end{pmatrix}$\n我们现在计算行向量 $R_{22}$ 的 $2$-范数：\n$$\n\\|R_{22}\\|_{2}^{\\mathrm{(CPQR)}} = \\sqrt{\\sum_{i=1}^{k} \\beta^2} = \\sqrt{k\\beta^2} = \\beta\\sqrt{k}\n$$\n\n**3. 完全正交分解（COF）**\n\n完全正交分解是一种秩揭示分解。其目标是找到正交矩阵 $U$ 和 $Z$ 以及一个置换 $\\Pi$，使得 $U^{\\top}A\\Pi Z$ 具有能够揭示有效秩的结构。理想的秩揭示分解是SVD，它能分离出奇异值。问题要求一个分解 $U^{\\top}A\\Pi Z = R = \\begin{pmatrix} R_{11} & R_{12} \\\\ 0 & R_{22} \\end{pmatrix}$，其中 $\\|R_{22}\\|_2$ 尽可能小。Eckart-Young-Mirsky定理表明，矩阵经过秩-$r$ 近似后，“误差”或“剩余”部分的最小范数由第 $(r+1)$ 个奇异值给出。\n这里，$r=1$。因此，尾部子块 $R_{22}$ 的最小可能 $2$-范数是 $\\sigma_{r+1}(A) = \\sigma_2(A)$。\n\n这种理想的分解是通过SVD实现的。设 $A = U_{svd}\\Sigma V_{svd}^{\\top}$ 是 $A$ 的SVD分解。那么我们可以选择 $U=U_{svd}$ 和 $\\Pi Z = V_{svd}$。\n通过这些选择，矩阵 $R$ 变为 $\\Sigma$：\n$$\nU^{\\top}A(\\Pi Z) = U_{svd}^{\\top}(U_{svd}\\Sigma V_{svd}^{\\top})V_{svd} = \\Sigma\n$$\n使用第1部分推导出的奇异值，我们有：\n$$\n\\Sigma = \\begin{pmatrix}\n\\sigma_1 & 0 & \\cdots & 0 \\\\\n0 & \\sigma_2 & \\cdots & 0\n\\end{pmatrix} = \\begin{pmatrix}\n\\beta\\sqrt{k} & 0 & 0 & \\cdots & 0 \\\\\n0 & \\alpha & 0 & \\cdots & 0\n\\end{pmatrix}\n$$\n这个矩阵 $\\Sigma$ 具有所期望的上梯形结构。我们在 $r=1$ 处对其进行分块：\n- $R_{11} = [\\beta\\sqrt{k}]$\n- $R_{12} = \\begin{pmatrix} 0 & 0 & \\cdots & 0 \\end{pmatrix}$\n- $R_{22} = \\begin{pmatrix} \\alpha & 0 & \\cdots & 0 \\end{pmatrix}$\n这个 $R_{22}$ 的 $2$-范数是：\n$$\n\\|R_{22}\\|_{2}^{\\mathrm{(COF)}} = \\sqrt{\\alpha^2 + 0^2 + \\cdots + 0^2} = \\alpha\n$$\n这等于 $\\sigma_2(A)$，与理论预测相符。选择正交变换以实现 $R_{22}$ 的这个最小范数的过程，正是理想COF的定义。\n\n**4. 改进因子**\n\n改进因子 $F$ 是CPQR得到的尾部子块的范数与理想COF得到的尾部子块的范数之比。\n$$\nF = \\frac{\\|R_{22}\\|_{2}^{\\mathrm{(CPQR)}}}{\\|R_{22}\\|_{2}^{\\mathrm{(COF)}}}\n$$\n代入第2部分和第3部分的结果：\n$$\nF = \\frac{\\beta\\sqrt{k}}{\\alpha}\n$$\n该问题的设计使得 $\\alpha \\ll \\beta\\sqrt{k}$，这意味着 $F \\gg 1$，凸显了对于这种特定的矩阵结构，一个合适的秩揭示分解相比于朴素的贪心CPQR所提供的显著改进。", "answer": "$$\n\\boxed{\\frac{\\beta\\sqrt{k}}{\\alpha}}\n$$", "id": "3538195"}]}