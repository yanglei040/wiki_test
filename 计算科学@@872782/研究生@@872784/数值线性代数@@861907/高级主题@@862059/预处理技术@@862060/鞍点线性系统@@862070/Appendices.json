{"hands_on_practices": [{"introduction": "鞍点系统的核心特征之一是其矩阵的对称不定性，这与许多入门课程中遇到的对称正定系统有本质区别。这个基本练习将引导你亲手构建一个简单的鞍点矩阵，并利用二次型 $z^T K z$ 的定义，直接验证其不定性。通过这个过程，你将对鞍点问题的代数结构建立起直观的理解。[@problem_id:3575826]", "problem": "考虑形如\n$$\nK = \\begin{bmatrix} A  B^T \\\\ B  -C \\end{bmatrix}\n$$\n的鞍点分块矩阵 $K \\in \\mathbb{R}^{3 \\times 3}$，其中 $A \\in \\mathbb{R}^{2 \\times 2}$ 是对称的，$B \\in \\mathbb{R}^{1 \\times 2}$，且 $C \\in \\mathbb{R}^{1 \\times 1}$。在离散集合\n$$\n\\mathcal{A} \\;=\\; \\left\\{ \\begin{bmatrix} a  b \\\\ b  d \\end{bmatrix} \\,\\middle|\\, a,b,d \\in \\{0,1\\} \\right\\}, \n\\quad\n\\mathcal{B} \\;=\\; \\left\\{ \\begin{bmatrix} b_{1}  b_{2} \\end{bmatrix} \\,\\middle|\\, b_{1}, b_{2} \\in \\{0,1\\} \\right\\},\n\\quad\n\\mathcal{C} \\;=\\; \\{1\\}\n$$\n内进行运算，并施加约束条件：$A$ 是对称正定 (SPD) 且 $B \\neq \\mathbf{0}$。为消除歧义，对参数元组使用字典序：对 $A$ 比较 $(a,b,d)$；对 $B$ 比较 $(b_{1},b_{2})$；对 $C$ 只有 $1$。选择满足这些约束条件的字典序最小的三元组 $(A,B,C) \\in \\mathcal{A} \\times \\mathcal{B} \\times \\mathcal{C}$。\n\n从二次型的定性定义出发，仅使用基础线性代数知识（如二次型的性质、配方法以及严格凸二次函数最小化子的刻画），构造一个非零向量 $z \\in \\mathbb{R}^{3}$ 使得 $z^{T} K z  0$，并通过找出一个能产生正二次型的向量来论证 $K$ 是对称不定的。\n\n最后，对于您构造的负定性验证向量 $z$，计算标量 $z^{T} K z$ 的精确值。将您的最终答案表示为一个精确整数。无需四舍五入。", "solution": "此问题被判定为有效，因其在数学上是良定的、自洽的且一致的。\n\n首先，我们必须通过从给定集合 $\\mathcal{A} \\times \\mathcal{B} \\times \\mathcal{C}$ 中选择满足指定约束条件的字典序最小的三元组 $(A, B, C)$ 来确定具体的矩阵 $K$。\n\n矩阵 $A \\in \\mathcal{A}$ 的形式为 $A = \\begin{bmatrix} a  b \\\\ b  d \\end{bmatrix}$，其中 $a, b, d \\in \\{0, 1\\}$。约束条件是 $A$ 必须为对称正定 (SPD)。一个对称矩阵是正定的，当且仅当其所有顺序主子式都为正。\n第一顺序主子式为 $\\det(A_1) = a$。为了使 $A$ 是对称正定的，我们必须有 $a > 0$。由于 $a \\in \\{0, 1\\}$，这意味着 $a=1$。\n第二顺序主子式为 $\\det(A_2) = \\det(A) = ad - b^2$。为了使 $A$ 是对称正定的，我们必须有 $ad - b^2 > 0$。代入 $a=1$，这变成 $d - b^2 > 0$。\n我们需要找到满足这些条件的字典序最小的元组 $(a,b,d)$。我们已经知道 $a=1$。\n我们测试 $b \\in \\{0, 1\\}$ 的值。\n- 如果 $b=0$，条件变为 $d - 0^2 > 0$，所以 $d > 0$。由于 $d \\in \\{0, 1\\}$，我们必须有 $d=1$。这给出了元组 $(1,0,1)$。\n- 如果 $b=1$，条件变为 $d - 1^2 > 0$，所以 $d > 1$。对于 $d \\in \\{0, 1\\}$ 没有解。\n因此，唯一可能的元组是 $(1,0,1)$，它必然是字典序最小的那个。\n得到的矩阵是 $A = \\begin{bmatrix} 1  0 \\\\ 0  1 \\end{bmatrix}$，即 $2 \\times 2$ 的单位矩阵 $I_2$。\n\n矩阵 $B \\in \\mathcal{B}$ 的形式为 $B = \\begin{bmatrix} b_1  b_2 \\end{bmatrix}$，其中 $b_1, b_2 \\in \\{0, 1\\}$。约束条件是 $B \\neq \\mathbf{0}$ 且元组 $(b_1, b_2)$ 必须是字典序最小的。集合 $\\mathcal{B}$ 由元组 $(0,0), (0,1), (1,0), (1,1)$ 组成。排除零向量后，可能的元组集合为 $\\{(0,1), (1,0), (1,1)\\}$。其中字典序最小的是 $(0,1)$。\n因此，$B = \\begin{bmatrix} 0  1 \\end{bmatrix}$。\n\n矩阵 $C \\in \\mathcal{C}$ 从单元素集合 $\\mathcal{C} = \\{1\\}$ 中抽取。因此，$C = [1]$。\n\n现在我们组装鞍点矩阵 $K$：\n$A = \\begin{bmatrix} 1  0 \\\\ 0  1 \\end{bmatrix}$，$B = \\begin{bmatrix} 0  1 \\end{bmatrix}$，$C = [1]$。\n我们有 $B^T = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}$ 且 $-C = [-1]$。\n$$\nK = \\begin{bmatrix} A  B^T \\\\ B  -C \\end{bmatrix} = \\begin{bmatrix} 1  0  0 \\\\ 0  1  1 \\\\ 0  1  -1 \\end{bmatrix}.\n$$\n问题要求我们证明 $K$ 是对称不定的。$K$ 根据构造是对称的。要证明其不定性，我们必须找到向量 $z_1, z_2 \\in \\mathbb{R}^3$ 使得 $z_1^T K z_1 > 0$ 且 $z_2^T K z_2  0$。\n\n将一个通用向量 $z \\in \\mathbb{R}^3$ 分块为 $z = \\begin{bmatrix} x \\\\ y \\end{bmatrix}$，其中 $x = \\begin{bmatrix} x_1 \\\\ x_2 \\end{bmatrix} \\in \\mathbb{R}^2$ 且 $y \\in \\mathbb{R}$。与 $K$ 相关联的二次型是：\n$$\nz^T K z = \\begin{bmatrix} x^T  y \\end{bmatrix} \\begin{bmatrix} A  B^T \\\\ B  -C \\end{bmatrix} \\begin{bmatrix} x \\\\ y \\end{bmatrix} = x^T A x + x^T B^T y + y B x - y C y = x^T A x + 2 y B x - y^2 C.\n$$\n代入具体的矩阵 $A$、$B$ 和 $C$：\n$$\nz^T K z = x^T I_2 x + 2y \\begin{bmatrix} 0  1 \\end{bmatrix} \\begin{bmatrix} x_1 \\\\ x_2 \\end{bmatrix} - y^2(1) = (x_1^2 + x_2^2) + 2yx_2 - y^2.\n$$\n为了找到一个能产生正二次型的向量，考虑形如 $z = \\begin{bmatrix} x \\\\ 0 \\end{bmatrix}$ 且 $x \\neq \\mathbf{0}$ 的向量。对于这类向量，$y=0$，二次型简化为 $z^T K z = x^T A x$。由于 $A=I_2$ 是对称正定的，对所有 $x \\neq \\mathbf{0}$ 都有 $x^T A x > 0$。例如，我们选择 $x = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}$。这给出了向量 $z_p = \\begin{bmatrix} 1 \\\\ 0 \\\\ 0 \\end{bmatrix}$。\n二次型的值为 $z_p^T K z_p = 1^2 + 0^2 + 2(0)(0) - 0^2 = 1 > 0$。\n\n接下来，我们必须构造一个非零向量 $z$ 使得 $z^T K z  0$。我们通过对变量 $x_2$ 进行配方来分析二次型 $x_1^2 + x_2^2 + 2yx_2 - y^2$：\n$$\nz^T K z = x_1^2 + (x_2^2 + 2yx_2 + y^2) - y^2 - y^2 = x_1^2 + (x_2 + y)^2 - 2y^2.\n$$\n为了使该表达式为负，我们可以选择 $x_1, x_2, y$ 来使正项消失。我们设：\n$x_1 = 0$\n$x_2 + y = 0 \\implies x_2 = -y$\n这个选择得到 $z^T K z = 0^2 + 0^2 - 2y^2 = -2y^2$。为确保 $z$ 是一个非零向量，我们可以为 $y$ 选择任意非零值。我们选择 $y=1$。这意味着 $x_1=0$ 且 $x_2=-1$。得到的向量是：\n$$\nz = \\begin{bmatrix} x_1 \\\\ x_2 \\\\ y \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ -1 \\\\ 1 \\end{bmatrix}.\n$$\n这个向量是非零的。通过 $z$ 的这个选择，我们已经确定 $z^T K z  0$。存在能产生正值和负值的向量，这证实了对称矩阵 $K$ 是不定的。\n\n最后，我们为这个构造的向量 $z = \\begin{bmatrix} 0 \\\\ -1 \\\\ 1 \\end{bmatrix}$ 计算标量 $z^T K z$ 的精确值。\n使用配方后的表达式：\n$$\nz^T K z = x_1^2 + (x_2 + y)^2 - 2y^2 = 0^2 + (-1 + 1)^2 - 2(1)^2 = 0 + 0 - 2 = -2.\n$$\n或者，通过直接矩阵乘法：\n$$\nz^T K z = \\begin{bmatrix} 0  -1  1 \\end{bmatrix} \\begin{bmatrix} 1  0  0 \\\\ 0  1  1 \\\\ 0  1  -1 \\end{bmatrix} \\begin{bmatrix} 0 \\\\ -1 \\\\ 1 \\end{bmatrix}\n$$\n$$\n= \\begin{bmatrix} (0)(1) + (-1)(0) + (1)(0)  (0)(0) + (-1)(1) + (1)(1)  (0)(0) + (-1)(1) + (1)(-1) \\end{bmatrix} \\begin{bmatrix} 0 \\\\ -1 \\\\ 1 \\end{bmatrix}\n$$\n$$\n= \\begin{bmatrix} 0  0  -2 \\end{bmatrix} \\begin{bmatrix} 0 \\\\ -1 \\\\ 1 \\end{bmatrix} = (0)(0) + (0)(-1) + (-2)(1) = -2.\n$$\n两种方法得到相同的结果。该值为所要求的精确整数。", "answer": "$$\\boxed{-2}$$", "id": "3575826"}, {"introduction": "理解了鞍点系统的结构后，下一步是求解它。对于大规模问题，迭代法通常比直接法更高效，而Uzawa算法是其中一种经典方法。本练习聚焦于迭代法的关键环节——收敛性分析，让你通过计算Schur补和迭代矩阵的谱半径，来确定算法关键参数（步长 $\\tau$）的有效取值范围，从而加深对迭代求解器行为的理解。[@problem_id:3575856]", "problem": "考虑一个鞍点线性系统，其分块矩阵为 $K=\\begin{bmatrix}A  B^{T}\\\\ B  0\\end{bmatrix}$，其中 $A\\in\\mathbb{R}^{n\\times n}$ 是对称正定矩阵，$B\\in\\mathbb{R}^{m\\times n}$。将具有常数步长 $\\tau>0$ 的 Uzawa 方法应用于此系统，会导出针对拉格朗日乘子误差的线性定常迭代，其迭代矩阵为 $I-\\tau S$，其中 $S:=B A^{-1} B^{T}$ 是 Schur 补。对于线性定常迭代，一个经过充分检验的事实是：其收敛的充要条件是迭代矩阵的谱半径严格小于 $1$。\n\n仅使用这些定义和事实，通过以下明确且科学上一致的选择来验证 Uzawa 方法的发散性：\n- 取 $A=\\mathrm{diag}(2,1)\\in\\mathbb{R}^{2\\times 2}$ 和 $B=\\begin{bmatrix}1  1\\end{bmatrix}\\in\\mathbb{R}^{1\\times 2}$。\n- 计算 Schur 补 $S=B A^{-1} B^{T}$ 及其最大特征值 $\\lambda_{\\max}(S)$。\n- 确定能保证 Uzawa 迭代收敛的 $\\tau$ 的开区间。\n- 然后选择步长 $\\tau=\\dfrac{3}{2}$，并通过计算谱半径 $\\rho(I-\\tau S)$ 并验证其超过 1 来证明其发散性。\n\n报告 $\\rho(I-\\tau S)$ 的精确值作为您的最终答案。无需四舍五入，也不涉及单位。", "solution": "该问题被验证为是自洽的、有科学依据且适定的。所有提供的数据和定义都是数值线性代数中的标准内容，并且内部一致。我现在开始进行解答。\n\n该问题要求我们分析 Uzawa 方法对于一个特定的鞍点线性系统的收敛性。系统矩阵由 $K=\\begin{bmatrix}A  B^{T}\\\\ B  0\\end{bmatrix}$ 给出，其中 $A=\\mathrm{diag}(2,1)\\in\\mathbb{R}^{2\\times 2}$ 且 $B=\\begin{bmatrix}1  1\\end{bmatrix}\\in\\mathbb{R}^{1\\times 2}$。针对拉格朗日乘子误差的 Uzawa 迭代的迭代矩阵为 $I-\\tau S$，其中 $S = B A^{-1} B^{T}$ 是 Schur 补，$\\tau > 0$ 是步长。收敛的充要条件是谱半径 $\\rho(I-\\tau S)  1$。\n\n首先，我们必须计算 Schur 补 $S$。矩阵 $A$ 是一个对角矩阵，因此其逆矩阵 $A^{-1}$ 可以通过对其对角元素取倒数得到。\n$$A = \\begin{bmatrix} 2  0 \\\\ 0  1 \\end{bmatrix} \\implies A^{-1} = \\begin{bmatrix} \\frac{1}{2}  0 \\\\ 0  1 \\end{bmatrix}$$\n矩阵 $B$ 由 $B = \\begin{bmatrix} 1  1 \\end{bmatrix}$ 给出，其转置为 $B^{T} = \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}$。\n\n现在，我们计算 $S = B A^{-1} B^{T}$：\n$$S = \\begin{bmatrix} 1  1 \\end{bmatrix} \\begin{bmatrix} \\frac{1}{2}  0 \\\\ 0  1 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}$$\n从左到右进行矩阵乘法：\n$$B A^{-1} = \\begin{bmatrix} 1  1 \\end{bmatrix} \\begin{bmatrix} \\frac{1}{2}  0 \\\\ 0  1 \\end{bmatrix} = \\begin{bmatrix} (1)(\\frac{1}{2}) + (1)(0)  (1)(0) + (1)(1) \\end{bmatrix} = \\begin{bmatrix} \\frac{1}{2}  1 \\end{bmatrix}$$\n然后，我们完成 $S$ 的计算：\n$$S = (B A^{-1}) B^{T} = \\begin{bmatrix} \\frac{1}{2}  1 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix} = \\left[ (\\frac{1}{2})(1) + (1)(1) \\right] = \\left[ \\frac{1}{2} + 1 \\right] = \\left[ \\frac{3}{2} \\right]$$\n因此，Schur 补 $S$ 是一个 $1 \\times 1$ 的矩阵，可以看作是标量 $\\frac{3}{2}$。\n\n标量矩阵的特征值就是该标量本身。因此，$S$ 的唯一特征值是 $\\lambda(S) = \\frac{3}{2}$。最大特征值是 $\\lambda_{\\max}(S) = \\frac{3}{2}$。\n\n接下来，我们确定能保证收敛的 $\\tau$ 的开区间。迭代矩阵为 $M = I - \\tau S$。由于 $S$ 是标量 $\\frac{3}{2}$，单位矩阵 $I$ 是标量 $1$，因此迭代矩阵是标量 $M = 1 - \\tau(\\frac{3}{2})$。\n标量矩阵的谱半径是其绝对值。收敛要求 $\\rho(M)  1$：\n$$ \\rho(I-\\tau S) = \\left| 1 - \\frac{3\\tau}{2} \\right|  1 $$\n这个不等式等价于：\n$$ -1  1 - \\frac{3\\tau}{2}  1 $$\n我们解这个关于 $\\tau$ 的复合不等式。首先，对于左边的不等式：\n$$ -1  1 - \\frac{3\\tau}{2} \\implies \\frac{3\\tau}{2}  1 + 1 \\implies \\frac{3\\tau}{2}  2 \\implies \\tau  \\frac{4}{3} $$\n接下来，对于右边的不等式：\n$$ 1 - \\frac{3\\tau}{2}  1 \\implies -\\frac{3\\tau}{2}  0 \\implies \\frac{3\\tau}{2} > 0 \\implies \\tau > 0 $$\n综合这些结果，Uzawa 迭代在 $\\tau \\in (0, \\frac{4}{3})$ 时收敛。\n\n问题要求我们选择步长 $\\tau = \\frac{3}{2}$。由于 $\\frac{3}{2} = \\frac{9}{6}$ 且 $\\frac{4}{3} = \\frac{8}{6}$，我们有 $\\tau > \\frac{4}{3}$，所以所选的 $\\tau$ 在收敛区间之外。因此我们预料迭代会发散。\n\n为了证明这一点，我们计算当 $\\tau = \\frac{3}{2}$ 时谱半径 $\\rho(I - \\tau S)$ 的值。\n迭代矩阵为 $M = I - \\tau S$。当 $S = \\frac{3}{2}$ 且 $\\tau = \\frac{3}{2}$ 时，我们有：\n$$ M = 1 - \\left(\\frac{3}{2}\\right) \\left(\\frac{3}{2}\\right) = 1 - \\frac{9}{4} = \\frac{4}{4} - \\frac{9}{4} = -\\frac{5}{4} $$\n谱半径是这个标量的绝对值：\n$$ \\rho(I - \\tau S) = \\left| -\\frac{5}{4} \\right| = \\frac{5}{4} $$\n由于 $\\rho(I - \\tau S) = \\frac{5}{4} > 1$，收敛条件不满足，迭代如预期的那样发散。需要报告的值就是这个谱半径。", "answer": "$$\\boxed{\\frac{5}{4}}$$", "id": "3575856"}, {"introduction": "理论上完美的算法在有限精度计算中可能遭遇滑铁卢，尤其是在处理病态问题时。本练习将带你探究一个在实践中至关重要的议题：数值稳定性。你将看到，当鞍点矩阵的 $(1,1)$ 块病态时，直接构造并求解Schur补会如何导致灾难性的精度损失，并学习如何通过增广拉格朗日方法推导出一个数值稳定的替代方案。[@problem_id:3575855]", "problem": "考虑一个由带等式约束的二次规划产生的 $2\\times 2$ 分块鞍点线性系统。设 $n=2$ 且 $m=1$，并定义\n$$\nA=\\begin{pmatrix} 1  0 \\\\ 0  \\epsilon \\end{pmatrix},\\qquad B=\\begin{pmatrix} 1  1 \\end{pmatrix},\\qquad C=-\\frac{1}{\\epsilon}+\\delta,\n$$\n其中 $\\epsilon\\in(0,1)$ 是一个小参数，$\\delta\\in\\mathbb{R}$ 是 $\\mathcal{O}(1)$ 阶的。鞍点矩阵是\n$$\n\\mathcal{K}=\\begin{pmatrix}\nA  B^{T} \\\\\nB  -C\n\\end{pmatrix}.\n$$\n通过消去原始变量得到的相关舒尔补定义为\n$$\nS = B A^{-1} B^{T} + C.\n$$\n要求您分析当 $A$ 是病态时，显式构造 $S$ 的数值不稳定性，并通过增广拉格朗日修正提出一种稳定的替代方案。\n\n任务：\n1. 从舒尔补和矩阵逆的定义出发，推导 $S$ 关于 $\\epsilon$ 和 $\\delta$ 的精确表达式，并解释为什么当 $\\epsilon\\to 0^{+}$ 时，显式构造 $A^{-1}$ 然后计算 $S$ 会出现灾难性抵消。\n\n2. 考虑使用如下的增广拉格朗日稳定化方法\n$$\nA_{\\gamma}=A+\\gamma B^{T}B,\\qquad \\gamma>0.\n$$\n仅使用秩一更新的基本恒等式，推导\n$$\nS_{\\gamma}=B A_{\\gamma}^{-1} B^{T} + C\n$$\n的闭式表达式，使其成为关于 $\\epsilon$、$\\gamma$ 和 $\\delta$ 的有理函数，除了秩一更新所隐含的逆之外，不构造任何显式的矩阵逆。\n\n3. 为了在 $S_{\\gamma}$ 改进的数值行为与使用 $A_{\\gamma}$ 进行内部求解的成本和稳定性之间取得平衡，选择 $\\gamma$ 以最小化 $A_{\\gamma}$ 的谱条件数 $\\kappa_{2}(A_{\\gamma})$（其在欧几里得范数下的最大特征值与最小特征值之比）。从一个 $2\\times 2$ 对称矩阵的特征多项式出发，推导在 $\\gamma>0$ 上的最小化子 $\\gamma^{\\star}(\\epsilon)$ 的精确表达式。\n\n您最终报告的答案应该是 $\\gamma^{\\star}(\\epsilon)$ 作为 $\\epsilon$ 的解析函数的闭式表达式。不要包含任何单位。不要对您的答案进行四舍五入。", "solution": "在尝试求解之前，对问题进行验证。\n\n### 步骤 1：提取已知条件\n- **问题类型**：$2 \\times 2$ 分块鞍点线性系统的分析。\n- **维度**：$n=2$, $m=1$。\n- **矩阵和向量定义**：\n  - $A = \\begin{pmatrix} 1  0 \\\\ 0  \\epsilon \\end{pmatrix}$\n  - $B = \\begin{pmatrix} 1  1 \\end{pmatrix}$\n  - $C = -\\frac{1}{\\epsilon} + \\delta$\n- **鞍点矩阵**：$\\mathcal{K} = \\begin{pmatrix} A  B^{T} \\\\ B  -C \\end{pmatrix}$\n- **参数**：$\\epsilon \\in (0,1)$ 是一个小参数，$\\delta \\in \\mathbb{R}$ 是单位阶的 ($\\mathcal{O}(1)$)，$\\gamma > 0$ 是一个正则化参数。\n- **舒尔补**：$S = B A^{-1} B^{T} + C$\n- **增广矩阵和舒尔补**：$A_{\\gamma} = A + \\gamma B^{T}B$ 和 $S_{\\gamma} = B A_{\\gamma}^{-1} B^{T} + C$。\n- **任务**：\n  1. 推导 $S$ 的精确表达式，并解释在数值上构造它时出现的灾难性抵消。\n  2. 使用秩一更新恒等式，推导 $S_{\\gamma}$ 作为有理函数的闭式表达式。\n  3. 找到最小化谱条件数 $\\kappa_{2}(A_{\\gamma})$ 的参数 $\\gamma^{\\star}(\\epsilon)$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题在数值线性代数领域具有科学依据，涉及鞍点系统、舒尔补、增广拉格朗日方法和矩阵条件数等标准概念。该问题是适定的；矩阵定义清晰，所需之处的逆存在（因为 $\\epsilon \\neq 0$，所以 $A$ 是可逆的；因为 $A$ 是对称正定 (SPD)，且对于 $\\gamma>0$ 有 $\\gamma B^T B$ 是半正定 (SPSD)，所以 $A_{\\gamma}$ 是对称正定且因此可逆）。该问题是客观的，使用了精确的数学语言。问题的设定是自洽的，没有矛盾。该模型虽然简单，但代表了在实际应用中遇到的病态问题的典型情况，使得分析具有非平凡性和意义。\n\n### 步骤 3：结论和行动\n该问题被判定为**有效**。将提供完整解答。\n\n### 第 1 部分：舒尔补 $S$ 的分析\n\n首先，我们推导舒尔补 $S$ 的精确表达式。\n矩阵 $A$ 由 $A = \\begin{pmatrix} 1  0 \\\\ 0  \\epsilon \\end{pmatrix}$ 给出。其逆矩阵为 $A^{-1} = \\begin{pmatrix} 1  0 \\\\ 0  1/\\epsilon \\end{pmatrix}$。\n矩阵 $B$ 是 $B = \\begin{pmatrix} 1  1 \\end{pmatrix}$，所以其转置是 $B^T = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。\n\n项 $B A^{-1} B^T$ 计算如下：\n$$\nB A^{-1} B^T = \\begin{pmatrix} 1  1 \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 0  \\frac{1}{\\epsilon} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1  \\frac{1}{\\epsilon} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = 1 \\cdot 1 + \\frac{1}{\\epsilon} \\cdot 1 = 1 + \\frac{1}{\\epsilon}.\n$$\n现在，我们加上项 $C = -\\frac{1}{\\epsilon} + \\delta$ 来求 $S$：\n$$\nS = (B A^{-1} B^T) + C = \\left(1 + \\frac{1}{\\epsilon}\\right) + \\left(-\\frac{1}{\\epsilon} + \\delta\\right) = 1 + \\delta.\n$$\n$S$ 的精确值是 $1+\\delta$，这是一个 $\\mathcal{O}(1)$ 阶的量。\n\n数值不稳定性源于“显式构造 $A^{-1}$ 然后计算 $S$”的过程。在浮点运算中，当 $\\epsilon$ 非常小（例如，相对于 $1$ 小于机器精度）时，数 $1/\\epsilon$ 会变得非常大。\n计算过程如下：\n1. 构造 $B A^{-1} B^T = 1 + 1/\\epsilon$。在浮点运算中，如果 $1/\\epsilon$ 足够大，加法 $1 + 1/\\epsilon$ 会得到一个在计算上与 $1/\\epsilon$ 无法区分的值。关于项 '$1$' 的信息丢失了。\n2. 构造 $C = -1/\\epsilon + \\delta$。\n3. 计算 $S = (B A^{-1} B^T) + C$。在数值上，这变成了 $(1/\\epsilon) + (-1/\\epsilon + \\delta)$。这个两个大而几乎相等的数的减法导致计算结果为 $\\delta$。\n真实结果是 $1+\\delta$，但计算结果是 $\\delta$。这种大数相减消去主要有效数字，并暴露出先前不显著的噪声或误差的现象，被称为灾难性抵消。相对误差为 $(\\text{真值}-\\text{计算值})/\\text{真值} = ((1+\\delta)-\\delta)/(1+\\delta) = 1/(1+\\delta)$，这是一个 $\\mathcal{O}(1)$ 阶的相对误差，表明精度完全丧失。\n\n### 第 2 部分：增广舒尔补 $S_{\\gamma}$ 的推导\n\n我们需要推导 $S_{\\gamma} = B A_{\\gamma}^{-1} B^{T} + C$ 的表达式，其中 $A_{\\gamma} = A + \\gamma B^{T}B$。矩阵 $A_{\\gamma}$ 是 $A$ 的一个秩一更新。我们可以使用 Sherman-Morrison 公式来求秩一更新矩阵的逆：\n$$\n(M + uv^T)^{-1} = M^{-1} - \\frac{M^{-1}uv^T M^{-1}}{1+v^T M^{-1} u}.\n$$\n在我们的例子中， $M=A$，$u=\\gamma B^T$，$v^T=B$。\n$$\nA_{\\gamma}^{-1} = (A + \\gamma B^T B)^{-1} = A^{-1} - \\frac{A^{-1}(\\gamma B^T)B A^{-1}}{1+B(\\gamma A^{-1}) B^T} = A^{-1} - \\frac{\\gamma A^{-1} B^T B A^{-1}}{1+\\gamma B A^{-1} B^T}.\n$$\n现在，我们左乘 $B$ 并右乘 $B^T$：\n$$\nB A_{\\gamma}^{-1} B^T = B A^{-1} B^T - \\frac{\\gamma B A^{-1} B^T B A^{-1} B^T}{1+\\gamma B A^{-1} B^T}.\n$$\n令 $X = B A^{-1} B^T$。表达式简化为：\n$$\nB A_{\\gamma}^{-1} B^T = X - \\frac{\\gamma X^2}{1+\\gamma X} = \\frac{X(1+\\gamma X) - \\gamma X^2}{1+\\gamma X} = \\frac{X + \\gamma X^2 - \\gamma X^2}{1+\\gamma X} = \\frac{X}{1+\\gamma X}.\n$$\n代入 $X = 1 + 1/\\epsilon$：\n$$\nB A_{\\gamma}^{-1} B^T = \\frac{1+1/\\epsilon}{1+\\gamma(1+1/\\epsilon)}.\n$$\n现在我们通过加上 $C$ 来计算 $S_{\\gamma}$：\n$$\nS_{\\gamma} = \\frac{1+1/\\epsilon}{1+\\gamma(1+1/\\epsilon)} + C = \\frac{1+1/\\epsilon}{1+\\gamma(1+1/\\epsilon)} - \\frac{1}{\\epsilon} + \\delta.\n$$\n为了得到关于 $\\epsilon, \\gamma, \\delta$ 的有理函数，我们首先通过将分子和分母同乘以 $\\epsilon$ 来重写分数：\n$$\nB A_{\\gamma}^{-1} B^T = \\frac{\\epsilon(1+1/\\epsilon)}{\\epsilon(1+\\gamma(1+1/\\epsilon))} = \\frac{\\epsilon+1}{\\epsilon+\\gamma(\\epsilon+1)} = \\frac{1+\\epsilon}{\\epsilon + \\gamma(1+\\epsilon)}.\n$$\n然后，我们合并 $S_{\\gamma}$ 的所有项：\n$$\nS_{\\gamma} = \\frac{1+\\epsilon}{\\epsilon + \\gamma(1+\\epsilon)} - \\frac{1}{\\epsilon} + \\delta = \\frac{\\epsilon(1+\\epsilon) - (\\epsilon + \\gamma(1+\\epsilon))}{\\epsilon(\\epsilon + \\gamma(1+\\epsilon))} + \\delta.\n$$\n分数的分子是 $\\epsilon + \\epsilon^2 - \\epsilon - \\gamma - \\gamma\\epsilon = \\epsilon^2 - \\gamma(1+\\epsilon)$。\n分母是 $\\epsilon^2 + \\gamma\\epsilon(1+\\epsilon)$。\n所以我们有：\n$$\nS_{\\gamma} = \\frac{\\epsilon^2 - \\gamma(1+\\epsilon)}{\\epsilon^2 + \\gamma\\epsilon(1+\\epsilon)} + \\delta.\n$$\n最后，将 $\\delta$ 合并到分数中，得到所需的有理函数：\n$$\nS_{\\gamma} = \\frac{\\epsilon^2 - \\gamma(1+\\epsilon) + \\delta(\\epsilon^2 + \\gamma\\epsilon(1+\\epsilon))}{\\epsilon^2 + \\gamma\\epsilon(1+\\epsilon)}.\n$$\n这个表达式避免了对 $A$ 的显式求逆或像 $1/\\epsilon$ 这样的大项的中间计算。\n\n### 第 3 部分： $A_{\\gamma}$ 条件数的最小化\n\n首先，我们构造矩阵 $A_{\\gamma}$：\n$$\nA_{\\gamma} = A + \\gamma B^T B = \\begin{pmatrix} 1  0 \\\\ 0  \\epsilon \\end{pmatrix} + \\gamma \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} 1  1 \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  \\epsilon \\end{pmatrix} + \\gamma \\begin{pmatrix} 1  1 \\\\ 1  1 \\end{pmatrix} = \\begin{pmatrix} 1+\\gamma  \\gamma \\\\ \\gamma  \\epsilon+\\gamma \\end{pmatrix}.\n$$\n$A_{\\gamma}$ 的特征值 $\\lambda$ 是其特征多项式 $\\det(A_{\\gamma} - \\lambda I) = 0$ 的根。\n$$\n\\det\\begin{pmatrix} 1+\\gamma-\\lambda  \\gamma \\\\ \\gamma  \\epsilon+\\gamma-\\lambda \\end{pmatrix} = (1+\\gamma-\\lambda)(\\epsilon+\\gamma-\\lambda) - \\gamma^2 = 0.\n$$\n展开得到：\n$$\n\\lambda^2 - (\\epsilon+\\gamma+1+\\gamma)\\lambda + (1+\\gamma)(\\epsilon+\\gamma) - \\gamma^2 = 0\n$$\n$$\n\\lambda^2 - (1+\\epsilon+2\\gamma)\\lambda + (\\epsilon+\\gamma+\\gamma\\epsilon) = 0.\n$$\n特征值 $\\lambda_{1,2}$ 由二次公式给出：\n$$\n\\lambda_{1,2} = \\frac{(1+\\epsilon+2\\gamma) \\pm \\sqrt{(1+\\epsilon+2\\gamma)^2 - 4(\\epsilon+\\gamma+\\gamma\\epsilon)}}{2}.\n$$\n让我们简化判别式 $\\Delta$：\n$$\n\\Delta = (1+\\epsilon)^2 + 4\\gamma(1+\\epsilon) + 4\\gamma^2 - 4\\epsilon - 4\\gamma - 4\\gamma\\epsilon\n$$\n$$\n\\Delta = 1+2\\epsilon+\\epsilon^2 + 4\\gamma+4\\gamma\\epsilon + 4\\gamma^2 - 4\\epsilon - 4\\gamma - 4\\gamma\\epsilon = 1-2\\epsilon+\\epsilon^2+4\\gamma^2 = (1-\\epsilon)^2+4\\gamma^2.\n$$\n所以特征值为 $\\lambda_1 = \\frac{1+\\epsilon+2\\gamma + \\sqrt{(1-\\epsilon)^2+4\\gamma^2}}{2}$ 和 $\\lambda_2 = \\frac{1+\\epsilon+2\\gamma - \\sqrt{(1-\\epsilon)^2+4\\gamma^2}}{2}$。\n谱条件数是 $\\kappa_2(A_{\\gamma}) = \\lambda_1/\\lambda_2$。\n$$\n\\kappa_2(\\gamma) = \\frac{1+\\epsilon+2\\gamma + \\sqrt{(1-\\epsilon)^2+4\\gamma^2}}{1+\\epsilon+2\\gamma - \\sqrt{(1-\\epsilon)^2+4\\gamma^2}}.\n$$\n为了最小化关于 $\\gamma > 0$ 的 $\\kappa_2(\\gamma)$，我们可以将其导数设为零。一个等价且更简单的方法是最小化 $\\ln(\\kappa_2(\\gamma))$。令 $u(\\gamma) = 1+\\epsilon+2\\gamma$ 和 $v(\\gamma) = \\sqrt{(1-\\epsilon)^2+4\\gamma^2}$。\n那么 $\\ln(\\kappa_2(\\gamma)) = \\ln(u+v) - \\ln(u-v)$。\n$$\n\\frac{d}{d\\gamma} \\ln(\\kappa_2(\\gamma)) = \\frac{u'+v'}{u+v} - \\frac{u'-v'}{u-v} = \\frac{(u'+v')(u-v) - (u'-v')(u+v)}{u^2-v^2} = \\frac{2(v'u - u'v)}{u^2-v^2}.\n$$\n当 $v'u - u'v = 0$ 时导数为零。\n我们有 $u'(\\gamma) = 2$ 和 $v'(\\gamma) = \\frac{8\\gamma}{2\\sqrt{(1-\\epsilon)^2+4\\gamma^2}} = \\frac{4\\gamma}{v}$。\n条件变为：\n$$\n\\frac{4\\gamma}{v}u - 2v = 0 \\implies 4\\gamma u - 2v^2 = 0 \\implies 2\\gamma u = v^2.\n$$\n代入 $u$ 和 $v^2$ 的表达式：\n$$\n2\\gamma(1+\\epsilon+2\\gamma) = (1-\\epsilon)^2+4\\gamma^2.\n$$\n$$\n2\\gamma(1+\\epsilon) + 4\\gamma^2 = (1-\\epsilon)^2 + 4\\gamma^2.\n$$\n$$\n2\\gamma(1+\\epsilon) = (1-\\epsilon)^2.\n$$\n求解 $\\gamma$ 得到最优值 $\\gamma^{\\star}(\\epsilon)$：\n$$\n\\gamma^{\\star}(\\epsilon) = \\frac{(1-\\epsilon)^2}{2(1+\\epsilon)}.\n$$\n由于 $\\epsilon \\in (0,1)$，我们有 $1-\\epsilon > 0$ 和 $1+\\epsilon > 0$，所以 $\\gamma^{\\star}(\\epsilon) > 0$ 符合要求。这个值最小化了正则化块 $A_{\\gamma}$ 的条件数。", "answer": "$$\\boxed{\\frac{(1-\\epsilon)^2}{2(1+\\epsilon)}}$$", "id": "3575855"}]}