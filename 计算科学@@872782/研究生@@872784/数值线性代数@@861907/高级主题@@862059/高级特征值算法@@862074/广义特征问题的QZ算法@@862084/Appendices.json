{"hands_on_practices": [{"introduction": "QZ算法将一个普通的矩阵对 $(A, B)$ 变换为一个结构化的矩阵对 $(S, T)$。第一个练习将聚焦于这个过程的最后一步：一旦获得了这种便捷的形式，我们如何从中提取广义特征值。通过处理一个块对角示例，我们可以看到问题是如何解耦成更小、更易于解决的部分的。[@problem_id:3594724]", "problem": "考虑矩阵 $\\mathbf{A} \\in \\mathbb{R}^{n \\times n}$ 和 $\\mathbf{B} \\in \\mathbb{R}^{n \\times n}$ 的广义特征值问题，其定义为方程 $\\det(\\mathbf{A} - \\lambda \\mathbf{B}) = 0$ 的根 $\\lambda \\in \\mathbb{C}$。广义舒尔 (QZ) 算法生成正交矩阵 $\\mathbf{Q}$ 和 $\\mathbf{Z}$，使得 $\\mathbf{Q}^{\\top} \\mathbf{A} \\mathbf{Z} = \\mathbf{S}$ 且 $\\mathbf{Q}^{\\top} \\mathbf{B} \\mathbf{Z} = \\mathbf{T}$，其中 $\\mathbf{S}$ 是上拟三角矩阵，$\\mathbf{T}$ 是上三角矩阵。仅使用这些基本事实，通过求解对角块 $\\mathbf{S}_{ii}, \\mathbf{T}_{ii}$ 上的方程 $\\det(\\mathbf{S}_{ii} - \\lambda \\mathbf{T}_{ii}) = 0$ 来从给定的 $(\\mathbf{S}, \\mathbf{T})$ 对中提取广义特征值。然后，通过直接计算验证 $\\det(\\mathbf{A} - \\lambda \\mathbf{B})$ 在这些值处（在舍入误差范围内）为零。\n\n对于此任务，给定广义舒尔形式\n$$\n\\mathbf{S} = \\begin{pmatrix}\n2  3  0 \\\\\n1  4  0 \\\\\n0  0  5\n\\end{pmatrix}, \n\\quad\n\\mathbf{T} = \\begin{pmatrix}\n1  0  0 \\\\\n0  1  0 \\\\\n0  0  2\n\\end{pmatrix}.\n$$\n为了验证步骤，取 $\\mathbf{Q} = \\mathbf{I}$ 和 $\\mathbf{Z} = \\mathbf{I}$，从而 $\\mathbf{A} = \\mathbf{S}$ 和 $\\mathbf{B} = \\mathbf{T}$。\n\n计算 $(\\mathbf{S}, \\mathbf{T})$ 的广义特征值，通过直接计算验证 $\\det(\\mathbf{A} - \\lambda \\mathbf{B})$ 在每个这些值处的结果为零，并报告广义特征值的总和。将您的最终答案表示为一个精确数（无需舍入）。", "solution": "该问题是有效的，因为它在数值线性代数方面有科学依据，是适定的、客观的且完全指定的。所有前提在事实上都是正确的，并且内部一致。\n\n该问题要求计算处于广义舒尔形式的一对给定矩阵 $(\\mathbf{S}, \\mathbf{T})$ 的广义特征值，验证这些特征值，并求它们的和。广义特征值问题由方程 $\\det(\\mathbf{A} - \\lambda \\mathbf{B}) = 0$ 定义。QZ 算法提供了一个分解，使得 $\\mathbf{Q}^{\\top} \\mathbf{A} \\mathbf{Z} = \\mathbf{S}$ 且 $\\mathbf{Q}^{\\top} \\mathbf{B} \\mathbf{Z} = \\mathbf{T}$，其中 $\\mathbf{Q}$ 和 $\\mathbf{Z}$ 是正交矩阵。此分解的一个关键性质是，矩阵对 $(\\mathbf{A}, \\mathbf{B})$ 的广义特征值与矩阵对 $(\\mathbf{S}, \\mathbf{T})$ 的广义特征值相同。这是因为 $\\det(\\mathbf{Q})$ 和 $\\det(\\mathbf{Z})$ 是非零的（具体来说是 $\\pm 1$）。\n$$\n\\det(\\mathbf{A} - \\lambda \\mathbf{B}) = 0 \\iff \\det(\\mathbf{Q}^{\\top}(\\mathbf{A} - \\lambda \\mathbf{B})\\mathbf{Z}) = 0\n$$\n$$\n\\iff \\det(\\mathbf{Q}^{\\top}\\mathbf{A}\\mathbf{Z} - \\lambda \\mathbf{Q}^{\\top}\\mathbf{B}\\mathbf{Z}) = 0 \\iff \\det(\\mathbf{S} - \\lambda \\mathbf{T}) = 0\n$$\n问题以广义舒尔形式提供了矩阵 $\\mathbf{S}$ 和 $\\mathbf{T}$：\n$$\n\\mathbf{S} = \\begin{pmatrix}\n2  3  0 \\\\\n1  4  0 \\\\\n0  0  5\n\\end{pmatrix}, \n\\quad\n\\mathbf{T} = \\begin{pmatrix}\n1  0  0 \\\\\n0  1  0 \\\\\n0  0  2\n\\end{pmatrix}\n$$\n矩阵 $\\mathbf{S}$ 是上拟三角矩阵，这意味着它是一个分块上三角矩阵，其对角块为 $1 \\times 1$ 或 $2 \\times 2$。矩阵 $\\mathbf{T}$ 是上三角矩阵。在这种情况下，$\\mathbf{S}$ 是分块上三角矩阵，而 $\\mathbf{T}$ 是分块对角矩阵（这是具有相同分块结构的分块上三角矩阵的一种特殊情况）。分块三角矩阵的行列式是其对角块行列式的乘积。因此，可以通过求解每个对角块对 $(\\mathbf{S}_{ii}, \\mathbf{T}_{ii})$ 的方程 $\\det(\\mathbf{S}_{ii} - \\lambda \\mathbf{T}_{ii}) = 0$ 来提取广义特征值。\n\n$\\mathbf{S}$ 和 $\\mathbf{T}$ 的对角块是：\n一个 $2 \\times 2$ 的块：\n$$\n\\mathbf{S}_{11} = \\begin{pmatrix} 2  3 \\\\ 1  4 \\end{pmatrix}, \\quad \\mathbf{T}_{11} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}\n$$\n以及一个 $1 \\times 1$ 的块：\n$$\n\\mathbf{S}_{22} = (5), \\quad \\mathbf{T}_{22} = (2)\n$$\n\n首先，我们通过求解 $\\det(\\mathbf{S}_{11} - \\lambda \\mathbf{T}_{11}) = 0$ 来从 $2 \\times 2$ 的块中找到特征值。\n$$\n\\mathbf{S}_{11} - \\lambda \\mathbf{T}_{11} = \\begin{pmatrix} 2  3 \\\\ 1  4 \\end{pmatrix} - \\lambda \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 2-\\lambda  3 \\\\ 1  4-\\lambda \\end{pmatrix}\n$$\n行列式为：\n$$\n\\det(\\mathbf{S}_{11} - \\lambda \\mathbf{T}_{11}) = (2-\\lambda)(4-\\lambda) - (3)(1) = 8 - 4\\lambda - 2\\lambda + \\lambda^2 - 3 = \\lambda^2 - 6\\lambda + 5\n$$\n将行列式设为零：\n$$\n\\lambda^2 - 6\\lambda + 5 = 0\n$$\n对二次方程进行因式分解得到 $(\\lambda - 1)(\\lambda - 5) = 0$。其根为 $\\lambda_1 = 1$ 和 $\\lambda_2 = 5$。\n\n接下来，我们通过求解 $\\det(\\mathbf{S}_{22} - \\lambda \\mathbf{T}_{22}) = 0$ 来从 $1 \\times 1$ 的块中找到特征值。\n$$\n\\mathbf{S}_{22} - \\lambda \\mathbf{T}_{22} = (5) - \\lambda(2) = (5 - 2\\lambda)\n$$\n行列式就是 $5 - 2\\lambda$。将其设为零得到：\n$$\n5 - 2\\lambda = 0 \\implies \\lambda_3 = \\frac{5}{2}\n$$\n广义特征值的集合是 $\\{\\lambda_1, \\lambda_2, \\lambda_3\\} = \\{1, 5, \\frac{5}{2}\\}$。\n\n为了验证，我们被指示设 $\\mathbf{A} = \\mathbf{S}$ 和 $\\mathbf{B} = \\mathbf{T}$，并证明 $\\det(\\mathbf{A} - \\lambda \\mathbf{B})$ 对每个特征值都为零。我们直接计算 $\\det(\\mathbf{S} - \\lambda \\mathbf{T})$。\n$$\n\\mathbf{S} - \\lambda \\mathbf{T} = \\begin{pmatrix}\n2-\\lambda  3  0 \\\\\n1  4-\\lambda  0 \\\\\n0  0  5-2\\lambda\n\\end{pmatrix}\n$$\n这个分块结构矩阵的行列式是：\n$$\n\\det(\\mathbf{S} - \\lambda \\mathbf{T}) = \\left( \\det \\begin{pmatrix} 2-\\lambda  3 \\\\ 1  4-\\lambda \\end{pmatrix} \\right) \\cdot (5-2\\lambda)\n$$\n$$\n\\det(\\mathbf{S} - \\lambda \\mathbf{T}) = ( (2-\\lambda)(4-\\lambda) - 3 ) \\cdot (5-2\\lambda) = (\\lambda^2 - 6\\lambda + 5)(5-2\\lambda) = (\\lambda-1)(\\lambda-5)(5-2\\lambda)\n$$\n我们将这个特征多项式命名为 $p(\\lambda) = \\det(\\mathbf{S} - \\lambda \\mathbf{T})$。我们通过直接代入来验证对于每个计算出的特征值 $p(\\lambda) = 0$：\n对于 $\\lambda_1 = 1$：\n$$\np(1) = (1-1)(1-5)(5 - 2 \\cdot 1) = (0)(-4)(3) = 0\n$$\n对于 $\\lambda_2 = 5$：\n$$\np(5) = (5-1)(5-5)(5 - 2 \\cdot 5) = (4)(0)(-5) = 0\n$$\n对于 $\\lambda_3 = \\frac{5}{2}$：\n$$\np\\left(\\frac{5}{2}\\right) = \\left(\\frac{5}{2}-1\\right)\\left(\\frac{5}{2}-5\\right)\\left(5 - 2 \\cdot \\frac{5}{2}\\right) = \\left(\\frac{3}{2}\\right)\\left(-\\frac{5}{2}\\right)(5-5) = \\left(\\frac{3}{2}\\right)\\left(-\\frac{5}{2}\\right)(0) = 0\n$$\n验证成功。所有计算出的特征值都是正确的。\n\n最后，我们计算广义特征值的和：\n$$\n\\sum_{i=1}^{3} \\lambda_i = \\lambda_1 + \\lambda_2 + \\lambda_3 = 1 + 5 + \\frac{5}{2} = 6 + \\frac{5}{2} = \\frac{12}{2} + \\frac{5}{2} = \\frac{17}{2}\n$$\n广义特征值的和是 $\\frac{17}{2}$。", "answer": "$$\n\\boxed{\\frac{17}{2}}\n$$", "id": "3594724"}, {"introduction": "现实世界中的计算是在有限精度算术中进行的，这会带来诸如上溢和下溢等潜在的陷阱。本练习探讨了QZ算法的输出——广义舒尔型——如何通过将特征值表示为数对 $(\\alpha_i, \\beta_i)$ 而非单一比率，提供一种稳健的方式来处理极端情况，例如无穷大特征值。这是保证数值稳定性的一个关键特性。[@problem_id:3594698]", "problem": "考虑广义特征值问题 $A x = \\lambda B x$ 及其通过 $QZ$ 算法（广义舒尔分解）约简为一个上三角矩阵对 $(S,T)$，满足 $Q^{\\top} A Z = S$ 和 $Q^{\\top} B Z = T$，其中 $Q$ 和 $Z$ 是正交矩阵，$S$ 和 $T$ 是上三角矩阵。\n\n矩阵束 $S - \\lambda T$ 的广义特征值由 $\\det(S - \\lambda T) = 0$ 的根定义，并约定：如果 $T$ 的某个对角元 $t_{ii}$ 为零，而对应的 $s_{ii} \\neq 0$，则相关的特征值为无穷大。\n\n令\n$$\nS = \\begin{pmatrix}\n5  9 \\times 10^{150} \\\\\n0  3 \\times 10^{-200}\n\\end{pmatrix},\\quad\nT = \\begin{pmatrix}\n0  7 \\times 10^{150} \\\\\n0  2 \\times 10^{-200}\n\\end{pmatrix}.\n$$\n$S$ 和 $T$ 均为上三角矩阵，且 $t_{11} = 0$。\n\n仅使用广义舒尔形式的核心定义和性质，(i) 确定矩阵束 $S - \\lambda T$ 的广义特征值，并指明哪个是无穷大，哪个是有限的；(ii) 从第一性原理出发，解释 $QZ$ 算法在将特征值报告为 $\\lambda_i = \\alpha_i / \\beta_i$ 的数对 $(\\alpha_i, \\beta_i)$ 时，为避免数值下溢或上溢而在概念上采用的缩放策略。然后，根据给定的 $S$ 和 $T$ 数值计算有限特征值，并将其作为最终报告值。将最终报告值四舍五入至六位有效数字。", "solution": "本题要求对于给定的上三角矩阵 $S$ 和 $T$，求出矩阵束 $S - \\lambda T$ 的广义特征值，解释 $QZ$ 算法中使用的数值缩放策略，并计算有限特征值。\n\n### 第 (i) 部分：确定广义特征值\n\n矩阵束 $S - \\lambda T$ 的广义特征值 $\\lambda$ 是满足特征方程 $\\det(S - \\lambda T) = 0$ 的值。给定矩阵如下：\n$$\nS = \\begin{pmatrix}\n5  9 \\times 10^{150} \\\\\n0  3 \\times 10^{-200}\n\\end{pmatrix},\\quad\nT = \\begin{pmatrix}\n0  7 \\times 10^{150} \\\\\n0  2 \\times 10^{-200}\n\\end{pmatrix}\n$$\n矩阵束 $S - \\lambda T$ 为：\n$$\nS - \\lambda T = \\begin{pmatrix}\n5 - \\lambda(0)  (9 \\times 10^{150}) - \\lambda(7 \\times 10^{150}) \\\\\n0 - \\lambda(0)  (3 \\times 10^{-200}) - \\lambda(2 \\times 10^{-200})\n\\end{pmatrix}\n$$\n由于 $S - \\lambda T$ 是一个上三角矩阵，其行列式是对角元素的乘积：\n$$\n\\det(S - \\lambda T) = (s_{11} - \\lambda t_{11})(s_{22} - \\lambda t_{22}) = 0\n$$\n该方程意味着广义特征值由 $s_{ii} - \\lambda t_{ii} = 0$（对于 $i=1, 2$）的解给出。\n\n对于第一对对角元，即 $i=1$：\n我们有 $s_{11} = 5$ 和 $t_{11} = 0$。方程为 $5 - \\lambda \\cdot 0 = 0$，简化为 $5 = 0$。这是一个矛盾，表明这是一个特殊情况。根据题目定义，“如果一个对角元 $t_{ii}$ 为零，而对应的 $s_{ii} \\neq 0$，则相关的特征值为无穷大”。由于 $t_{11}=0$ 且 $s_{11}=5 \\neq 0$，第一个广义特征值 $\\lambda_1$ 是无穷大。\n\n对于第二对对角元，即 $i=2$：\n我们有 $s_{22} = 3 \\times 10^{-200}$ 和 $t_{22} = 2 \\times 10^{-200}$。方程为：\n$$\ns_{22} - \\lambda_2 t_{22} = 0\n$$\n已知 $t_{22} = 2 \\times 10^{-200} \\neq 0$，我们可以解出有限特征值 $\\lambda_2$：\n$$\n\\lambda_2 = \\frac{s_{22}}{t_{22}} = \\frac{3 \\times 10^{-200}}{2 \\times 10^{-200}} = \\frac{3}{2} = 1.5\n$$\n因此，有限特征值为 $\\lambda_2 = 1.5$。\n\n### 第 (ii) 部分：解释缩放策略\n\n在浮点运算中，直接将广义特征值计算为比值 $\\lambda_i = s_{ii} / t_{ii}$ 在数值上是不稳定的。给定的矩阵完美地说明了这一点。\n\n1.  **上溢和下溢风险：** 除法 $s_{ii} / t_{ii}$ 可能产生超出浮点数可表示范围的值。例如，如果 $s_{ii}$ 非常大而 $t_{ii}$ 非常小，它们的比值可能导致上溢。相反，一个非常小的 $s_{ii}$ 和一个非常大的 $t_{ii}$ 可能导致下溢，结果被舍入为零，从而造成信息丢失。在给定的问题中，$s_{22} = 3 \\times 10^{-200}$ 和 $t_{22} = 2 \\times 10^{-200}$ 这两个值非常小，在标准双精度算术中可能会下溢为 $0$（双精度的最小正规格化值约为 $2.2 \\times 10^{-308}$，而单精度的范围要小得多）。如果两者都被视为 $0$，它们的比值就变成了不定式 $0/0$，尽管真实的比值是良态数 $1.5$。\n\n2.  **第一性原理策略：** 为避免这些数值风险，$QZ$ 算法的稳健实现（例如 LAPACK 中的实现）不会显式计算比值 $\\lambda_i = s_{ii} / t_{ii}$。相反，它们将每个广义特征值表示为一个数对 $(\\alpha_i, \\beta_i)$，使得 $\\lambda_i = \\alpha_i / \\beta_i$。从广义舒尔形式 $(S, T)$ 推导出的这些数对的自然选择是 $(\\alpha_i, \\beta_i) = (s_{ii}, t_{ii})$。\n\n这种 $(\\alpha_i, \\beta_i)$ 表示法是一个核心特性，它从第一性原理上确保了数值稳定性：\n- 它**避免了可能导致上溢或下溢异常的除法运算**，将该运算推迟给用户，用户可以在需要时谨慎执行。\n- 它提供了一种**自然且统一的方式来处理无穷和零特征值**。\n    - 无穷特征值对应于数对 $(\\alpha_i, \\beta_i)$，其中 $\\beta_i = t_{ii} = 0$ 且 $\\alpha_i = s_{ii} \\neq 0$。对于我们的问题，这个数对是 $(5, 0)$。\n    - 零特征值对应于数对，其中 $\\alpha_i = s_{ii} = 0$ 且 $\\beta_i = t_{ii} \\neq 0$。\n- 它**保留了信息**。通过存储数对 $(s_{ii}, t_{ii})$，算法保持了原始对角元的大小量级，防止了在除法之前因数值下溢为零而发生的信息丢失。例如，数对 $(3 \\times 10^{-200}, 2 \\times 10^{-200})$ 正确地编码了特征值 $1.5$，而使用下溢后的值 $(0, 0)$ 进行计算则会失败。\n\n总之，通过将特征值报告为数对 $(\\alpha_i, \\beta_i) = (s_{ii}, t_{ii})$，$QZ$ 算法避免了直接除法的数值陷阱，并为所有类型的广义特征值（有限、无穷和零）提供了一种稳健的表示方法。\n\n### 最终计算\n\n问题要求计算有限特征值的数值，并四舍五入至六位有效数字。如上所算，有限特征值为：\n$$\n\\lambda_2 = \\frac{s_{22}}{t_{22}} = 1.5\n$$\n将 $1.5$ 表示为六位有效数字得到 $1.50000$。", "answer": "$$\\boxed{1.50000}$$", "id": "3594698"}, {"introduction": "并非所有的特征问题都是生而平等的；有些问题对数据的微小变化天生敏感。最后一个练习将通过一个动手推导，来计算一个特征值的敏感度，并将其与广义特征问题的条件数概念联系起来。理解这一点有助于我们区分由不稳定算法引起的误差和问题本身固有的敏感性。[@problem_id:3594704]", "problem": "考虑由矩阵 $A \\in \\mathbb{C}^{4\\times 4}$ 和 $B \\in \\mathbb{C}^{4\\times 4}$ 定义的广义特征值问题，其中\n$$\nA = \\operatorname{diag}(1,\\,2,\\,3,\\,4),\\qquad B = \\operatorname{diag}\\!\\left(1,\\,1,\\,1,\\,10^{-4}\\right).\n$$\n该矩阵对已经是广义舒尔形式（也称为广义舒尔分解或QZ算法形式），因此广义特征值是对角线元素之比。\n\n定义对 $B$ 沿秩一方向 $E = e_{4} e_{4}^{\\top}$ 的扰动为\n$$\nB(\\varepsilon) = B + \\varepsilon E,\\quad \\varepsilon \\in \\mathbb{R},\n$$\n因此只有 $B$ 的 $(4,4)$ 元素受到扰动。\n\n从满足 $A x = \\lambda B x$ 的广义特征对 $(\\lambda, x)$ 及其满足 $y^{*} A = \\lambda y^{*} B$ 的相关左特征向量 $y$ 的定义出发，并且不借助任何预先给定的扰动公式，推导在扰动 $B(\\varepsilon)$ 下，对应于第4个对角线比率的特征值 $\\lambda_{4}(\\varepsilon)$ 的一阶灵敏度。使用定义方程的微分和适当的归一化，得到 $\\left.\\frac{d\\lambda_{4}}{d\\varepsilon}\\right|_{\\varepsilon=0}$ 的显式解析表达式。\n\n然后，通过用左右特征向量和双线性形式 $y^{*} B x$ 来解释方向导数，将您的表达式与基于条件数的解释联系起来，并简要说明为什么该特征值对 $B$ 中的扰动敏感。\n\n您最终报告的量必须是 $\\left.\\frac{d\\lambda_{4}}{d\\varepsilon}\\right|_{\\varepsilon=0}$ 的精确值。无需四舍五入。不提供单位。", "solution": "问题要求计算矩阵对 $(A, B)$ 的广义特征值 $\\lambda_4$ 相对于 $B$ 中特定扰动的一阶灵敏度。我们需要从第一性原理出发进行推导。\n\n设广义特征对为 $(\\lambda(\\varepsilon), x(\\varepsilon))$，它依赖于扰动参数 $\\varepsilon$。定义方程为：\n$$ A x(\\varepsilon) = \\lambda(\\varepsilon) B(\\varepsilon) x(\\varepsilon) $$\n其中 $A = \\operatorname{diag}(1, 2, 3, 4)$，$B(\\varepsilon) = B + \\varepsilon E$，而 $B = \\operatorname{diag}(1, 1, 1, 10^{-4})$ 且 $E = e_4 e_4^T$。向量 $e_4$ 是 $\\mathbb{C}^4$ 中的第四个标准基向量。\n\n首先，我们确定在 $\\varepsilon=0$ 时未受扰动的特征值和特征向量。问题是 $A x = \\lambda B x$。由于 $A$ 和 $B$ 是对角矩阵，广义特征值是对角元素之比，即 $\\lambda_i = A_{ii} / B_{ii}$。我们关心的是第四个特征值：\n$$ \\lambda_4(0) \\equiv \\lambda_4 = \\frac{A_{44}}{B_{44}} = \\frac{4}{10^{-4}} = 4 \\times 10^4 $$\n对应的右特征向量是 $x_4(0) \\equiv x_4 = e_4$。左特征向量 $y_4$ 由 $y_4^* A = \\lambda_4 y_4^* B$ 定义。由于 $A$ 和 $B$ 是实对称（对角）矩阵，左特征向量与右特征向量相同，因此 $y_4(0) \\equiv y_4 = e_4$。我们可以验证这一点：\n$e_4^T A = 4 e_4^T$ 且 $\\lambda_4 e_4^T B = (4 \\times 10^4) (10^{-4} e_4^T) = 4 e_4^T$。\n\n为了求出灵敏度，我们将定义方程 $A x(\\varepsilon) = \\lambda(\\varepsilon) B(\\varepsilon) x(\\varepsilon)$ 对 $\\varepsilon$ 求导：\n$$ \\frac{d}{d\\varepsilon} [A x(\\varepsilon)] = \\frac{d}{d\\varepsilon} [\\lambda(\\varepsilon) (B + \\varepsilon E) x(\\varepsilon)] $$\n对两边使用乘法法则（尽管 $A$ 是常数），我们得到：\n$$ A \\frac{dx}{d\\varepsilon} = \\frac{d\\lambda}{d\\varepsilon} (B + \\varepsilon E) x(\\varepsilon) + \\lambda(\\varepsilon) \\left[ \\frac{d}{d\\varepsilon}(B + \\varepsilon E) x(\\varepsilon) + (B + \\varepsilon E) \\frac{dx}{d\\varepsilon} \\right] $$\n$$ A \\dot{x}(\\varepsilon) = \\dot{\\lambda}(\\varepsilon) (B + \\varepsilon E) x(\\varepsilon) + \\lambda(\\varepsilon) \\left[ E x(\\varepsilon) + (B + \\varepsilon E) \\dot{x}(\\varepsilon) \\right] $$\n其中点符号表示对 $\\varepsilon$ 的微分。\n\n现在，我们在 $\\varepsilon=0$ 处计算此表达式。此时，$\\lambda(0) = \\lambda_4$，$x(0) = x_4$，且 $B(0)=B$：\n$$ A \\dot{x}(0) = \\dot{\\lambda_4}(0) B x_4 + \\lambda_4 [E x_4 + B \\dot{x}(0)] $$\n为了求解 $\\dot{\\lambda_4}(0)$ 而无需计算 $\\dot{x}(0)$，我们将整个方程左乘左特征向量的共轭转置 $y_4^* = e_4^T$：\n$$ y_4^* A \\dot{x}(0) = \\dot{\\lambda_4}(0) y_4^* B x_4 + \\lambda_4 y_4^* E x_4 + \\lambda_4 y_4^* B \\dot{x}(0) $$\n我们使用左特征向量的定义属性 $y_4^* A = \\lambda_4 y_4^* B$。将其代入左侧得到：\n$$ (\\lambda_4 y_4^* B) \\dot{x}(0) = \\dot{\\lambda_4}(0) y_4^* B x_4 + \\lambda_4 y_4^* E x_4 + \\lambda_4 y_4^* B \\dot{x}(0) $$\n项 $\\lambda_4 y_4^* B \\dot{x}(0)$ 在等式两边都出现，可以消去，剩下：\n$$ 0 = \\dot{\\lambda_4}(0) y_4^* B x_4 + \\lambda_4 y_4^* E x_4 $$\n这个消去过程表明，对于单特征值，特征值的一阶扰动不依赖于特征向量的一阶扰动。\n\n求解所需的导数 $\\dot{\\lambda_4}(0) = \\left.\\frac{d\\lambda_4}{d\\varepsilon}\\right|_{\\varepsilon=0}$：\n$$ \\dot{\\lambda_4}(0) = - \\lambda_4 \\frac{y_4^* E x_4}{y_4^* B x_4} $$\n这个表达式给出了一阶灵敏度。\n\n现在，我们计算此表达式中的标量值：\n- $y_4^* E x_4 = e_4^T (e_4 e_4^T) e_4 = (e_4^T e_4) (e_4^T e_4) = (1)(1) = 1$。此项表示在特征对“方向”上扰动的大小。\n- $y_4^* B x_4 = e_4^T B e_4 = B_{44} = 10^{-4}$。此项是特征值条件数的关键部分。\n\n将这些值与 $\\lambda_4 = 4 \\times 10^4$ 一起代入：\n$$ \\left.\\frac{d\\lambda_4}{d\\varepsilon}\\right|_{\\varepsilon=0} = - (4 \\times 10^4) \\frac{1}{10^{-4}} = -4 \\times 10^4 \\times 10^4 = -4 \\times 10^8 $$\n\n推导出的灵敏度表达式 $\\dot{\\lambda_4}(0) = -\\lambda_4 (y_4^* E x_4) / (y_4^* B x_4)$ 直接关系到广义特征值问题的条件数。灵敏度与双线性形式 $y_4^* B x_4$ 的大小成反比。在本例中，$y_4^* B x_4 = 10^{-4}$，这是一个非常小的数。小的分母导致大的导数，表明特征值 $\\lambda_4$ 对扰动高度敏感。这个特征值是病态的。其原因是矩阵 $B$ 接近奇异（其对角元素之一接近于零）。广义特征值 $\\lambda_4 = A_{44}/B_{44}$ 涉及到除以这个小数。对 $B_{44}$ 的一个小的绝对扰动 $\\varepsilon$ 会导致 $B_{44}$ 的一个大的相对变化，这反过来又导致 $\\lambda_4$ 的一个非常大的绝对变化。导数的巨大数值 $-4 \\times 10^8$ 量化了这种极端的灵敏度。", "answer": "$$\\boxed{-4 \\times 10^{8}}$$", "id": "3594704"}]}