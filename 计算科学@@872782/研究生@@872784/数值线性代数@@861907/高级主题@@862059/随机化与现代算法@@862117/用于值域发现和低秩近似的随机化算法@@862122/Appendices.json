{"hands_on_practices": [{"introduction": "要真正掌握随机算法，我们不仅要理解其步骤，更要能够量化其性能。随机奇异值分解（SVD）的一个核心优势在于其处理大型矩阵时的卓越速度。本练习将引导你通过仔细计算算法每一步的浮点运算（flops），来从第一性原理验证这一优势，并将其与确定性SVD的成本进行比较，让你亲身体验算法效率的量化分析。[@problem_id:3569802]", "problem": "考虑一个稠密实矩阵 $A \\in \\mathbb{R}^{m \\times n}$，其中 $m \\geq n$；一个目标秩 $k$，其中 $1 \\leq k  n$；过采样参数 $p \\geq 0$；以及幂迭代参数 $q \\geq 0$。定义 $\\ell = k + p$。一个标准的随机奇异值分解 (SVD) 流程如下：抽取一个高斯测试矩阵 $\\Omega \\in \\mathbb{R}^{n \\times \\ell}$，构建样本矩阵 $Y = (A A^{\\top})^{q} A \\Omega$，通过瘦 QR 分解计算 $Y$ 的列空间的一个标准正交基 $Q \\in \\mathbb{R}^{m \\times \\ell}$，构建压缩矩阵 $B = Q^{\\top} A \\in \\mathbb{R}^{\\ell \\times n}$，计算一个确定性的 SVD $B = \\widetilde{U} \\Sigma V^{\\top}$，并令 $U = Q \\widetilde{U}$。假设浮点运算次数的运算成本模型如下：\n- 尺寸为 $(m \\times n)$ 和 $(n \\times r)$ 的稠密矩阵-矩阵乘法成本为 $2 m n r$ 次浮点运算 (flops)。\n- 对一个 $m \\geq r$ 的 $(m \\times r)$ 矩阵进行 Householder 瘦 QR 分解的成本为 $2 m r^{2} - \\tfrac{2}{3} r^{3}$ 次浮点运算。\n- 对一个 $n \\geq r$ 的 $(n \\times r)$ 矩阵进行确定性 SVD（通过双对角化和对角矩阵 SVD）的成本为 $4 n r^{2} + \\tfrac{8}{3} r^{3}$ 次浮点运算。\n- 尺寸为 $(m \\times n)$ 和 $(n \\times 1)$ 的稠密矩阵-向量乘法成本为 $2 m n$ 次浮点运算。\n\n对于一个通过 $k$ 步带完全再正交化的 Golub–Kahan 双对角化来计算前 $k$ 个奇异值三元组的确定性截断 SVD，使用标准模型\n$$\nF_{\\mathrm{det}}(m,n,k) \\;=\\; 4 m n k \\;+\\; 2 (m + n) k^{2} \\;+\\; \\tfrac{8}{3} k^{3}.\n$$\n\n(a) 仅使用上述成本模型和算法步骤，推导上述随机 SVD 流程的总运算次数 $F_{\\mathrm{rand}}(m,n,k,p,q)$，用 $m$、$n$、$k$、$p$ 和 $q$ 表示，并包括形成 $A \\Omega$、进行 $q$ 次幂迭代、对 $Y$ 进行 QR 分解、形成 $B = Q^{\\top} A$、对 $B$ 进行小规模 SVD 以及形成 $U = Q \\widetilde{U}$ 的成本。\n\n(b) 考虑当 $m \\to \\infty$ 且 $n \\to \\infty$ 同时 $m / n \\to \\gamma \\in (1, \\infty)$ 时的渐近区域，而 $k$、$p$ 和 $q$ 是固定的，且与 $m$ 和 $n$ 无关。在此区域内，计算比率的极限\n$$\nR \\;=\\; \\lim_{\\substack{m,n \\to \\infty \\\\ m/n \\to \\gamma}} \\frac{F_{\\mathrm{rand}}(m,n,k,p,q)}{F_{\\mathrm{det}}(m,n,k)}.\n$$\n将 $R$ 的最终答案以一个关于 $k$、$p$ 和 $q$ 的单一简化解析表达式的形式给出。不需要数值近似，也不涉及单位。最终答案必须是单一的闭式表达式。", "solution": "用户提供了一个来自数值线性代数领域的有效问题陈述。该问题具有科学依据、问题明确、客观，并包含推导唯一解所需的所有必要信息。其成本模型和算法描述是分析随机低秩近似方法的标准方法。\n\n### (a) 部分：总运算次数 $F_{\\mathrm{rand}}$ 的推导\n\n总运算次数（或浮点运算次数）$F_{\\mathrm{rand}}(m,n,k,p,q)$ 是所述随机 SVD 流程中每个步骤成本的总和。我们将使用给定的成本模型和参数 $\\ell = k+p$ 来分析每个步骤。\n\n1.  **构建样本矩阵 $Y = (A A^{\\top})^{q} A \\Omega$**：\n    此计算是迭代执行的。测试矩阵是 $\\Omega \\in \\mathbb{R}^{n \\times \\ell}$。矩阵 $A$ 属于 $\\mathbb{R}^{m \\times n}$。\n    -   首先，我们构建初始样本矩阵 $Y_0 = A \\Omega$。这是一个 $(m \\times n)$ 矩阵与一个 $(n \\times \\ell)$ 矩阵的乘法。成本为 $2mn\\ell$ 次浮点运算。得到的矩阵 $Y_0$ 的尺寸为 $(m \\times \\ell)$。\n    -   接下来，我们将幂迭代算子 $(A A^{\\top})$ 应用总共 $q$ 次。每次将算子应用于矩阵 $Y_{i-1} \\in \\mathbb{R}^{m \\times \\ell}$ 以生成 $Y_i = A A^{\\top} Y_{i-1}$ 的过程分两步完成：\n        a. 计算中间矩阵 $Z_{i-1} = A^{\\top} Y_{i-1}$。这是 $A^{\\top} \\in \\mathbb{R}^{n \\times m}$ 与 $Y_{i-1} \\in \\mathbb{R}^{m \\times \\ell}$ 的乘法。成本为 $2nm\\ell = 2mn\\ell$ 次浮点运算。\n        b. 计算 $Y_i = A Z_{i-1}$。这是 $A \\in \\mathbb{R}^{m \\times n}$ 与 $Z_{i-1} \\in \\mathbb{R}^{n \\times \\ell}$ 的乘法。成本为 $2mn\\ell$ 次浮点运算。\n    -   因此，一个幂迭代步骤的成本是 $2mn\\ell + 2mn\\ell = 4mn\\ell$ 次浮点运算。对于 $q$ 次迭代，成本为 $q \\times (4mn\\ell) = 4qmn\\ell$ 次浮点运算。\n    -   形成最终样本矩阵 $Y$ 的总成本是初始步骤和 $q$ 次幂迭代的成本之和：\n        $$\n        \\text{Cost}_Y = 2mn\\ell + 4qmn\\ell = (2+4q)mn\\ell\n        $$\n\n2.  **计算 $Y$ 的一个标准正交基 $Q$**：\n    矩阵 $Y$ 的尺寸为 $(m \\times \\ell)$。我们对 $Y$ 进行瘦 QR 分解以获得 $Q \\in \\mathbb{R}^{m \\times \\ell}$。对于一个 $(m \\times r)$ 矩阵（其中 $m \\geq r$）进行 Householder 瘦 QR 分解的成本模型是 $2mr^2 - \\frac{2}{3}r^3$。在这里，$r=\\ell$。\n    $$\n    \\text{Cost}_{QR} = 2m\\ell^2 - \\frac{2}{3}\\ell^3\n    $$\n\n3.  **构建压缩矩阵 $B = Q^{\\top} A$**：\n    此步骤涉及将矩阵 $Q^{\\top} \\in \\mathbb{R}^{\\ell \\times m}$ 与矩阵 $A \\in \\mathbb{R}^{m \\times n}$ 相乘。\n    $$\n    \\text{Cost}_B = 2\\ell mn = 2mn\\ell\n    $$\n\n4.  **计算 $B = \\widetilde{U} \\Sigma V^{\\top}$ 的 SVD**：\n    矩阵 $B$ 的尺寸为 $(\\ell \\times n)$。所提供的成本模型是针对 $N \\geq R$ 的 $(N \\times R)$ 矩阵。在 (b) 部分指定的渐近区域中，$m, n \\to \\infty$，而 $k, p$（以及因此的 $\\ell=k+p$）是固定的。在此极限下，我们将有 $n  \\ell$，所以 $B$ 是一个“矮胖”矩阵。$B$ 的 SVD 通常通过计算 $B^{\\top} \\in \\mathbb{R}^{n \\times \\ell}$ 的 SVD 来实现，而 $B^{\\top}$ 是一个“高瘦”矩阵。对于 $B^{\\top}$，其维度与成本模型相匹配，其中 $N=n$ 且 $R=\\ell$。\n    $$\n    \\text{Cost}_{SVD} = 4n\\ell^2 + \\frac{8}{3}\\ell^3\n    $$\n\n5.  **形成最终的左奇异向量 $U = Q \\widetilde{U}$**：\n    矩阵 $Q$ 的尺寸为 $(m \\times \\ell)$。$B$ 的左奇异向量矩阵 $\\widetilde{U}$ 的尺寸为 $(\\ell \\times \\ell)$。乘积 $U=Q\\widetilde{U}$ 是一个 $(m \\times \\ell)$ 矩阵。这个矩阵-矩阵乘法的成本是：\n    $$\n    \\text{Cost}_U = 2m\\ell\\ell = 2m\\ell^2\n    $$\n\n总运算次数 $F_{\\mathrm{rand}}$ 是这些成本的总和：\n$$\nF_{\\mathrm{rand}} = \\text{Cost}_Y + \\text{Cost}_{QR} + \\text{Cost}_B + \\text{Cost}_{SVD} + \\text{Cost}_U\n$$\n$$\nF_{\\mathrm{rand}} = (2+4q)mn\\ell + \\left(2m\\ell^2 - \\frac{2}{3}\\ell^3\\right) + 2mn\\ell + \\left(4n\\ell^2 + \\frac{8}{3}\\ell^3\\right) + 2m\\ell^2\n$$\n我们根据各项对 $m$ 和 $n$ 的依赖关系对它们进行分组：\n$$\nF_{\\mathrm{rand}} = ((2+4q)mn\\ell + 2mn\\ell) + (2m\\ell^2 + 2m\\ell^2) + (4n\\ell^2) + \\left(-\\frac{2}{3}\\ell^3 + \\frac{8}{3}\\ell^3\\right)\n$$\n$$\nF_{\\mathrm{rand}} = (4+4q)mn\\ell + 4m\\ell^2 + 4n\\ell^2 + \\frac{6}{3}\\ell^3\n$$\n$$\nF_{\\mathrm{rand}} = (4+4q)mn\\ell + 4m\\ell^2 + 4n\\ell^2 + 2\\ell^3\n$$\n这可以更紧凑地写为：\n$$\nF_{\\mathrm{rand}}(m,n,k,p,q) = (4+4q)mn(k+p) + 4(m+n)(k+p)^2 + 2(k+p)^3\n$$\n\n### (b) 部分：运算次数的渐近比率\n\n我们被要求在 $m, n \\to \\infty$ 且 $m/n \\to \\gamma \\in (1, \\infty)$ 的渐近区域内计算比率 $R = F_{\\mathrm{rand}} / F_{\\mathrm{det}}$ 的极限，而 $k$、$p$ 和 $q$ 是固定的常数。\n\n两种成本的表达式为：\n$$\nF_{\\mathrm{rand}}(m,n,k,p,q) = (4+4q)mn(k+p) + 4(m+n)(k+p)^2 + 2(k+p)^3\n$$\n$$\nF_{\\mathrm{det}}(m,n,k) = 4mnk + 2(m+n)k^2 + \\frac{8}{3}k^3\n$$\n为了评估该比率的极限，我们识别出当 $m, n \\to \\infty$ 时分子和分母中的主导项。由于 $k, p, q$ 是固定的，参数 $\\ell=k+p$以及涉及它们的因子相对于 $m$ 和 $n$ 是常数。\n\n在两个表达式中增长最快的项是与 $mn$ 成正比的项。其他项的增长速度为 $m$ 或 $n$，这在渐近上小于 $mn$。\n- $F_{\\mathrm{rand}}$ 的首项是 $(4+4q)mn(k+p)$。\n- $F_{\\mathrm{det}}$ 的首项是 $4mnk$。\n\n比率的极限是首项系数的比率。\n一个更正式的方法是将分子和分母同时除以 $mn$：\n$$\nR = \\lim_{\\substack{m,n \\to \\infty \\\\ m/n \\to \\gamma}} \\frac{(4+4q)mn(k+p) + 4(m+n)(k+p)^2 + 2(k+p)^3}{4mnk + 2(m+n)k^2 + \\frac{8}{3}k^3}\n$$\n$$\nR = \\lim_{m,n \\to \\infty} \\frac{(4+4q)(k+p) + 4\\left(\\frac{1}{n}+\\frac{1}{m}\\right)(k+p)^2 + \\frac{2(k+p)^3}{mn}}{4k + 2\\left(\\frac{1}{n}+\\frac{1}{m}\\right)k^2 + \\frac{8k^3}{3mn}}\n$$\n当 $m \\to \\infty$ 且 $n \\to \\infty$ 时，所有包含 $1/m$、$1/n$ 或 $1/mn$ 的项都趋近于零：\n$$\n\\lim_{m,n \\to \\infty} \\left(\\frac{1}{n}+\\frac{1}{m}\\right) = 0 \\quad \\text{和} \\quad \\lim_{m,n \\to \\infty} \\frac{1}{mn} = 0\n$$\n因此，极限简化为：\n$$\nR = \\frac{(4+4q)(k+p) + 0 + 0}{4k + 0 + 0} = \\frac{(4+4q)(k+p)}{4k}\n$$\n简化表达式，我们得到：\n$$\nR = \\frac{4(1+q)(k+p)}{4k} = \\frac{(1+q)(k+p)}{k}\n$$\n这也可以写成 $R=(1+q)(1+p/k)$。正如问题框架所预期的那样，结果与纵横比极限 $\\gamma$ 无关。", "answer": "$$\\boxed{\\frac{(1+q)(k+p)}{k}}$$", "id": "3569802"}, {"introduction": "速度优势固然重要，但近似的质量是衡量算法成败的另一关键。一个自然的问题是：随机性会带来多大的精度损失？本练习将深入探讨随机范围估计算法的理论保证，通过推导特定奇异值衰减模型下的期望误差上界，你将清晰地看到目标秩$k$、过采样参数$p$等因素如何共同决定算法的最终精度。[@problem_id:3569805]", "problem": "考虑一个实矩阵 $A \\in \\mathbb{R}^{m \\times n}$，其奇异值分解 (SVD) 为 $A = U \\Sigma V^{\\top}$，其中 $U \\in \\mathbb{R}^{m \\times m}$ 和 $V \\in \\mathbb{R}^{n \\times n}$ 是正交矩阵，$\\Sigma \\in \\mathbb{R}^{m \\times n}$ 是对角矩阵，其非负对角元满足 $\\sigma_{1} \\geq \\sigma_{2} \\geq \\cdots \\geq 0$。假设 $A$ 的奇异值呈几何衰减，即存在常数 $s  0$ 和 $\\rho \\in (0,1)$，使得对所有 $j \\geq 1$ 都有 $\\sigma_{j} = s \\rho^{j-1}$。令 $k \\geq 1$ 为目标秩，$p \\geq 2$ 为过采样参数。定义 $\\ell = k + p$，并抽取一个测试矩阵 $\\Omega \\in \\mathbb{R}^{n \\times \\ell}$，其元素是独立的标准正态随机变量（均值为 $0$，方差为 $1$）。构造样本矩阵 $Y = A \\Omega$，通过薄QR分解计算 $Y$ 的值域的一个标准正交基 $Q \\in \\mathbb{R}^{m \\times \\ell}$，并考虑投影到 $Q$ 的列空间上的正交投影算子 $QQ^{\\top}$。\n\n从奇异值分解、标准正态分布的旋转不变性以及正交投影算子和弗罗贝尼乌斯范数的基本性质出发，推导一个解析表达式，用以量化在过采样参数为 $p$ 的情况下选择 $\\ell = k + p$ 对期望近似误差 $\\mathbb{E}\\|A - QQ^{\\top}A\\|_{F}$ 的影响，其中 $\\|\\cdot\\|_{F}$ 表示弗罗贝尼乌斯范数。仅假设奇异值的几何衰减模型以及关于高斯矩阵和正交投影算子的标准事实；不要先验地假设任何关于期望误差的具体公式。你的最终结果必须是一个关于 $s$、$ \\rho$、$ k$ 和 $p$ 的单一闭式表达式，该表达式是所述模型下 $\\mathbb{E}\\|A - QQ^{\\top}A\\|_{F}$ 的一个上界。不需要进行数值舍入。", "solution": "问题要求在矩阵 $A$ 奇异值的特定模型下，为一个随机化值域寻找算法的期望近似误差 $\\mathbb{E}\\|A - QQ^{\\top}A\\|_{F}$ 找出一个解析上界。推导必须基于第一性原理。\n\n令 $P_Y = QQ^{\\top}$ 为到样本矩阵 $Y = A\\Omega$ 值域上的正交投影算子。近似误差由矩阵 $E = A - P_Y A = (I - P_Y)A$ 给出。我们感兴趣的是该误差的期望弗罗贝尼乌斯范数 $\\mathbb{E}\\|E\\|_{F}$ 的一个上界。\n\n根据琴生不等式，我们有 $\\mathbb{E}\\|E\\|_{F} \\leq \\left(\\mathbb{E}\\|E\\|_{F}^2\\right)^{1/2}$。因此，我们将通过推导期望弗罗贝尼乌斯范数平方 $\\mathbb{E}\\|A - P_Y A\\|_{F}^2$ 的一个界来继续。\n\n令 $A \\in \\mathbb{R}^{m \\times n}$ 的奇异值分解 (SVD) 为 $A = U\\Sigma V^{\\top}$。我们将 $A$ 分解为其最佳秩 $k$ 近似和残差部分：$A = A_k + A_{k\\perp}$，其中 $A_k = U_k \\Sigma_k V_k^{\\top}$ 且 $A_{k\\perp} = U_{k\\perp} \\Sigma_{k\\perp} V_{k\\perp}^{\\top}$。这里，$U_k$ 和 $V_k$ 分别包含 $U$ 和 $V$ 的前 $k$ 列，$\\Sigma_k$ 是前 $k$ 个奇异值 $\\sigma_1, \\dots, \\sigma_k$ 构成的对角矩阵。矩阵 $U_{k\\perp}, V_{k\\perp}, \\Sigma_{k\\perp}$ 则是针对从 $k+1$ 开始的奇异值类似地定义的。$A_k$ 和 $A_{k\\perp}$ 的列空间是正交的，这意味着 $A_k^{\\top}A_{k\\perp} = 0$ 和 $A_{k\\perp}^{\\top}A_k = 0$。\n\n误差的平方为 $\\|(I - P_Y)A\\|_{F}^2 = \\|(I - P_Y)(A_k + A_{k\\perp})\\|_{F}^2$。在随机化算法的分析中，一个基于子空间的正交性和高斯分布的对称性的标准结果表明，交叉项的期望为零：\n$$ \\mathbb{E}\\|(I - P_Y)A\\|_{F}^2 = \\mathbb{E}\\|(I - P_Y)A_k\\|_{F}^2 + \\mathbb{E}\\|(I - P_Y)A_{k\\perp}\\|_{F}^2 $$\n我们将分别对这两项进行界定。\n\n对于第二项，由于 $I - P_Y$ 是一个正交投影算子，其算子范数最多为 $1$。因此，$\\|(I - P_Y)A_{k\\perp}\\|_{F} \\leq \\|I - P_Y\\|_{2} \\|A_{k\\perp}\\|_{F} \\leq \\|A_{k\\perp}\\|_{F}$。所以，\n$$ \\mathbb{E}\\|(I - P_Y)A_{k\\perp}\\|_{F}^2 \\leq \\mathbb{E}[\\|A_{k\\perp}\\|_{F}^2] = \\|A_{k\\perp}\\|_{F}^2 = \\sum_{j=k+1}^{\\min(m,n)} \\sigma_j^2 $$\n在这里，我们利用了 $A_{k\\perp}$ 是一个固定矩阵的事实。\n\n第一项 $\\mathbb{E}\\|(I - P_Y)A_k\\|_{F}^2$ 量化了由于投影导致 $A$ 的主导部分损失了多少。为了界定这一项，我们在 $Y$ 的值域中构造一个辅助矩阵 $Z$ 来近似 $A_k$。令 $\\Omega_k = V_k^{\\top}\\Omega \\in \\mathbb{R}^{k \\times \\ell}$ 和 $\\Omega_{k\\perp} = V_{k\\perp}^{\\top}\\Omega \\in \\mathbb{R}^{(n-k) \\times \\ell}$。由于 $\\Omega$ 是一个标准高斯矩阵且 $V$ 是正交的，所以 $\\Omega_k$ 和 $\\Omega_{k\\perp}$ 是独立的标准高斯矩阵。样本矩阵 $Y$ 可以写为：\n$$ Y = A\\Omega = (A_k + A_{k\\perp})\\Omega = A_k V V^{\\top} \\Omega + A_{k\\perp}V V^{\\top} \\Omega = U_k\\Sigma_k\\Omega_k + U_{k\\perp}\\Sigma_{k\\perp}\\Omega_{k\\perp} $$\n由于 $\\ell = k+p  k$，矩阵 $\\Omega_k$ ($k \\times \\ell$ 维) 的秩为 $k$ 的概率为 $1$。因此，其摩尔-彭若斯伪逆为 $\\Omega_k^{\\dagger} = \\Omega_k^{\\top}(\\Omega_k \\Omega_k^{\\top})^{-1}$，并且 $\\Omega_k \\Omega_k^{\\dagger} = I_k$。\n考虑矩阵 $Z = Y\\Omega_k^{\\dagger}V_k^{\\top}$。$Z$ 的列是 $Y$ 的列的线性组合，因此 $\\text{range}(Z) \\subseteq \\text{range}(Y)$。投影 $P_Y A_k$ 是从 $\\text{range}(Y)$ 中对 $A_k$ 的最佳近似，所以 $\\|A_k - P_Y A_k\\|_{F} \\leq \\|A_k - Z\\|_{F}$。\n我们来分析 $A_k - Z$:\n\\begin{align*}\nA_k - Z = A_k - (U_k\\Sigma_k\\Omega_k + U_{k\\perp}\\Sigma_{k\\perp}\\Omega_{k\\perp})\\Omega_k^{\\dagger}V_k^{\\top} \\\\\n= A_k - U_k\\Sigma_k(\\Omega_k\\Omega_k^{\\dagger})V_k^{\\top} - U_{k\\perp}\\Sigma_{k\\perp}\\Omega_{k\\perp}\\Omega_k^{\\dagger}V_k^{\\top} \\\\\n= A_k - U_k\\Sigma_k I_k V_k^{\\top} - U_{k\\perp}\\Sigma_{k\\perp}\\Omega_{k\\perp}\\Omega_k^{\\dagger}V_k^{\\top} \\\\\n= A_k - A_k - U_{k\\perp}\\Sigma_{k\\perp}\\Omega_{k\\perp}\\Omega_k^{\\dagger}V_k^{\\top} \\\\\n= -U_{k\\perp}\\Sigma_{k\\perp}\\Omega_{k\\perp}\\Omega_k^{\\dagger}V_k^{\\top}\n\\end{align*}\n利用弗罗贝尼乌斯范数的酉不变性（$U_{k\\perp}$ 具有标准正交列），我们得到：\n$$ \\|(I - P_Y)A_k\\|_{F}^2 \\leq \\|A_k - Z\\|_{F}^2 = \\|-U_{k\\perp}\\Sigma_{k\\perp}\\Omega_{k\\perp}\\Omega_k^{\\dagger}V_k^{\\top}\\|_{F}^2 = \\|\\Sigma_{k\\perp}\\Omega_{k\\perp}\\Omega_k^{\\dagger}V_k^{\\top}\\|_{F}^2 $$\n现在我们取期望。由于 $\\Omega_k$ 和 $\\Omega_{k\\perp}$ 是独立的，我们可以对 $\\Omega_k$ 取条件：\n$$ \\mathbb{E}_{\\Omega_{k\\perp}}[\\|\\Sigma_{k\\perp}\\Omega_{k\\perp}(\\Omega_k^{\\dagger}V_k^{\\top})\\|_{F}^2 | \\Omega_k] $$\n对于一个固定矩阵 $B$ 和一个标准高斯矩阵 $G$，$\\mathbb{E}\\|G B\\|_F^2 = \\|G\\|_F^2 \\|B\\|_F^2$ 是不正确的。相反，令 $B = \\Omega_k^{\\dagger}V_k^{\\top}$。$\\mathbb{E}_{\\Omega_{k\\perp}}[\\|\\Sigma_{k\\perp}\\Omega_{k\\perp}B\\|_{F}^2] = \\text{Tr}(\\mathbb{E}[B^{\\top}\\Omega_{k\\perp}^{\\top}\\Sigma_{k\\perp}^2\\Omega_{k\\perp}B])$。高斯矩阵的一个标准性质表明 $\\mathbb{E}[\\Omega_{k\\perp}^{\\top}\\Sigma_{k\\perp}^2\\Omega_{k\\perp}] = \\text{Tr}(\\Sigma_{k\\perp}^2) I_{\\ell} = (\\sum_{j=k+1}^n \\sigma_j^2) I_{\\ell}$。\n因此，条件期望为 $(\\sum_{j=k+1}^n \\sigma_j^2) \\text{Tr}(B^{\\top}B) = (\\sum_{j=k+1}^n \\sigma_j^2) \\|B\\|_{F}^2$。\n这里，$\\|B\\|_{F}^2 = \\|\\Omega_k^{\\dagger}V_k^{\\top}\\|_{F}^2 = \\|\\Omega_k^{\\dagger}\\|_{F}^2$，因为 $V_k^{\\top}$ 具有标准正交行。\n对 $\\Omega_k$ 取外层期望：\n$$ \\mathbb{E}\\|(I - P_Y)A_k\\|_{F}^2 \\leq \\left(\\sum_{j=k+1}^n \\sigma_j^2\\right) \\mathbb{E}[\\|\\Omega_k^{\\dagger}\\|_{F}^2] $$\n项 $\\mathbb{E}[\\|\\Omega_k^{\\dagger}\\|_{F}^2]$ 是一个逆威沙特矩阵的期望迹。对于一个 $k \\times \\ell$ 维的标准高斯矩阵 $\\Omega_k$，其中 $\\ell = k+p$ 且 $p  1$，这个期望是已知的：\n$$ \\mathbb{E}[\\|\\Omega_k^{\\dagger}\\|_{F}^2] = \\mathbb{E}[\\text{Tr}((\\Omega_k \\Omega_k^{\\top})^{-1})] = \\frac{k}{p-1} $$\n这要求 $p \\ge 2$，正如问题陈述中所给出的。\n所以，我们得到界：\n$$ \\mathbb{E}\\|(I - P_Y)A_k\\|_{F}^2 \\leq \\frac{k}{p-1} \\sum_{j=k+1}^n \\sigma_j^2 $$\n合并两项的界：\n$$ \\mathbb{E}\\|A - P_Y A\\|_{F}^2 \\leq \\frac{k}{p-1} \\sum_{j=k+1}^n \\sigma_j^2 + \\sum_{j=k+1}^n \\sigma_j^2 = \\left(1 + \\frac{k}{p-1}\\right) \\sum_{j=k+1}^n \\sigma_j^2 $$\n最后，我们代入给定的奇异值模型 $\\sigma_j = s \\rho^{j-1}$。尾部奇异值的平方和变成一个几何级数。我们考虑求和到无穷大，这为任何有限的 $n$ 提供了一个上界：\n$$ \\sum_{j=k+1}^{\\infty} \\sigma_j^2 = \\sum_{j=k+1}^{\\infty} (s \\rho^{j-1})^2 = s^2 \\sum_{j=k+1}^{\\infty} (\\rho^2)^{j-1} $$\n令 $i=j-1$。该和为 $s^2 \\sum_{i=k}^{\\infty} (\\rho^2)^i$。这是一个首项为 $a = s^2(\\rho^2)^k = s^2\\rho^{2k}$、公比为 $r=\\rho^2$ 的几何级数。由于 $\\rho \\in (0,1)$，级数和为：\n$$ \\sum_{j=k+1}^{\\infty} \\sigma_j^2 = \\frac{s^2\\rho^{2k}}{1-\\rho^2} $$\n将此代入我们的期望平方误差的界中：\n$$ \\mathbb{E}\\|A - P_Y A\\|_{F}^2 \\leq \\left(1 + \\frac{k}{p-1}\\right) \\frac{s^2\\rho^{2k}}{1-\\rho^2} $$\n通过对原始误差应用琴生不等式，我们取这个上界的平方根：\n$$ \\mathbb{E}\\|A - P_Y A\\|_{F} \\leq \\left(\\mathbb{E}\\|A - P_Y A\\|_{F}^2\\right)^{1/2} \\leq \\left( \\left(1 + \\frac{k}{p-1}\\right) \\frac{s^2\\rho^{2k}}{1-\\rho^2} \\right)^{1/2} $$\n$$ \\mathbb{E}\\|A - P_Y A\\|_{F} \\leq \\left(1 + \\frac{k}{p-1}\\right)^{1/2} \\frac{s\\rho^k}{\\sqrt{1-\\rho^2}} $$\n这就是所求的闭式表达式。", "answer": "$$\\boxed{s \\left(1 + \\frac{k}{p-1}\\right)^{\\frac{1}{2}} \\frac{\\rho^k}{\\sqrt{1-\\rho^2}}}$$", "id": "3569805"}, {"introduction": "在理解了算法的效率与精度后，我们需关注一个至关重要的实现细节：构图（sketching）的方向。一个基于投影的方法能否成功，关键取决于投影的应用方式。本练习通过一个精心构造的矩阵，直观地揭示了从右侧构图以寻找其值域（列空间）与从左侧构图以寻找其余值域（行空间）之间的根本差异，这将巩固你对算法如何“洞察”矩阵底层结构的理解。[@problem_id:3569859]", "problem": "考虑一个宽矩阵 $A \\in \\mathbb{R}^{m \\times n}$，其中 $m=3$，$n=5$，且精确秩为 $k=2$。设 $A$ 具有奇异值分解 $A = U_k \\Sigma_k V_k^{\\top}$，其中 $U_k \\in \\mathbb{R}^{3 \\times 2}$ 的列是标准正交的，$\\Sigma_k = \\operatorname{diag}(\\sigma_1,\\sigma_2)$ 且 $\\sigma_1  \\sigma_2  0$，而 $V_k \\in \\mathbb{R}^{5 \\times 2}$ 的列等于 $\\mathbb{R}^5$ 中的标准基向量 $e_4$ 和 $e_5$；即 $V_k = [e_4 \\;\\; e_5]$。因此，$A$ 的非零列仅在位置 $4$ 和 $5$ 处。\n\n使用描绘（sketching）构建了两种基于投影的低秩近似：\n\n- 用于寻找值域的右描绘：设 $\\Omega_R \\in \\mathbb{R}^{5 \\times 2}$ 是前两个标准基向量构成的矩阵，即 $\\Omega_R = [e_1 \\;\\; e_2]$。构建 $Y_R = A \\Omega_R$，计算 $\\operatorname{range}(Y_R)$ 的一个标准正交基 $Q_R$，并定义近似 $A_R = Q_R Q_R^{\\top} A$。\n\n- 用于寻找余值域（行空间）的左描绘：设 $\\Phi_L \\in \\mathbb{R}^{3 \\times 2}$ 为 $\\Phi_L = U_k$。构建 $W_L = A^{\\top} \\Phi_L$，计算 $\\operatorname{range}(W_L)$ 的一个标准正交基 $P_L$，并定义近似 $A_L = A P_L P_L^{\\top}$。\n\n仅使用数值线性代数中的基本定义（奇异值分解、标准正交基和正交投影），计算：\n\n1. 谱范数误差 $E_{\\text{right}} = \\|A - A_R\\|_2$。\n2. 谱范数误差 $E_{\\text{left}} = \\|A - A_L\\|_2$。\n\n然后，依据这些计算以及值域和余值域的定义，论证为了寻找值域和余值域的基，应分别从 $A$ 的哪一侧进行描绘。\n\n请以 $E_{\\text{right}} - E_{\\text{left}}$ 的单一简化表达式形式提供你的最终答案。不需要进行数值舍入，也不涉及物理单位。请以封闭形式表示最终答案。", "solution": "用户提供了一个问题陈述，在尝试解答之前需要对其进行验证。\n\n### 步骤 1：提取已知条件\n- 矩阵 $A \\in \\mathbb{R}^{m \\times n}$，其中 $m=3$ 且 $n=5$。\n- $A$ 的精确秩为 $k=2$。\n- $A$ 的奇异值分解 (SVD) 由 $A = U_k \\Sigma_k V_k^{\\top}$ 给出。\n- $U_k \\in \\mathbb{R}^{3 \\times 2}$ 具有标准正交列。\n- $\\Sigma_k = \\operatorname{diag}(\\sigma_1, \\sigma_2)$，其中奇异值 $\\sigma_1  \\sigma_2  0$。\n- $V_k \\in \\mathbb{R}^{5 \\times 2}$ 的列等于 $\\mathbb{R}^5$ 中的标准基向量 $e_4$ 和 $e_5$；因此，$V_k = [e_4 \\;\\; e_5]$。\n- 这意味着 $A$ 的前三列是零向量。\n\n- 第一种近似方法是**用于寻找值域的右描绘**：\n  - 描绘矩阵为 $\\Omega_R = [e_1 \\;\\; e_2] \\in \\mathbb{R}^{5 \\times 2}$。\n  - 描绘后的矩阵为 $Y_R = A \\Omega_R$。\n  - $Q_R$ 是 $Y_R$ 值域 $\\operatorname{range}(Y_R)$ 的一个标准正交基。\n  - 近似矩阵为 $A_R = Q_R Q_R^{\\top} A$。\n  - 相关误差为 $E_{\\text{right}} = \\|A - A_R\\|_2$。\n\n- 第二种近似方法是**用于寻找余值域（行空间）的左描绘**：\n  - 描绘矩阵为 $\\Phi_L = U_k \\in \\mathbb{R}^{3 \\times 2}$。\n  - 描绘后的矩阵为 $W_L = A^{\\top} \\Phi_L$。\n  - $P_L$ 是 $W_L$ 值域 $\\operatorname{range}(W_L)$ 的一个标准正交基。\n  - 近似矩阵为 $A_L = A P_L P_L^{\\top}$。\n  - 相关误差为 $E_{\\text{left}} = \\|A - A_L\\|_2$。\n\n任务是计算 $E_{\\text{right}}$ 和 $E_{\\text{left}}$，论证左描绘和右描绘的合理使用，并提供 $E_{\\text{right}} - E_{\\text{left}}$ 的最终值。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题设置在数值线性代数的背景下，具体涉及用于低秩近似的随机算法。所有定义和概念，如奇异值分解、标准正交基、正交投影和谱范数，都是标准的并且在数学上是严谨的。\n\n- **科学依据**：该问题在科学和数学上是合理的。它探讨了随机数值线性代数中的一个基本概念：描绘、值域寻找和余值域寻找之间的关系。\n- **适定性**：该问题是适定的。给定的信息是充分且自洽的。$V_k$ 的结构意味着 $A$ 的行空间由 $\\{e_4, e_5\\}$ 张成，即 $A$ 的第 1、2、3 列为零。这与问题陈述一致。$\\Omega_R$ 和 $\\Phi_L$ 的选择是特定的，允许对误差进行确定性和唯一的计算。\n- **客观性**：该问题以精确、客观的数学语言陈述，没有歧义或主观论断。\n\n该问题没有违反任何无效标准。这是一个定义明确的练习，旨在测试对基于投影的近似方法的理解。\n\n### 步骤 3：结论与行动\n问题是**有效的**。将构建一个解决方案。\n\n### 解题推导\n\n**1. 右描绘误差 $E_{\\text{right}}$ 的计算**\n\n第一步是计算描绘后的矩阵 $Y_R = A \\Omega_R$。我们代入 $A$ 的 SVD 和 $\\Omega_R$ 的定义：\n$$Y_R = (U_k \\Sigma_k V_k^{\\top}) \\Omega_R = U_k \\Sigma_k V_k^{\\top} [e_1 \\;\\; e_2]$$\n给定 $V_k = [e_4 \\;\\; e_5]$，所以其转置为 $V_k^{\\top} = \\begin{pmatrix} e_4^{\\top} \\\\ e_5^{\\top} \\end{pmatrix}$。我们计算乘积 $V_k^{\\top} \\Omega_R$：\n$$V_k^{\\top} \\Omega_R = \\begin{pmatrix} e_4^{\\top} \\\\ e_5^{\\top} \\end{pmatrix} [e_1 \\;\\; e_2] = \\begin{pmatrix} e_4^{\\top} e_1  e_4^{\\top} e_2 \\\\ e_5^{\\top} e_1  e_5^{\\top} e_2 \\end{pmatrix}$$\n由于标准基向量是正交的，当 $i \\neq j$ 时，$e_i^{\\top} e_j = 0$。所得矩阵中的所有元素都为零：\n$$V_k^{\\top} \\Omega_R = \\begin{pmatrix} 0  0 \\\\ 0  0 \\end{pmatrix} = \\mathbf{0}_{2 \\times 2}$$\n因此，描绘后的矩阵 $Y_R$ 是零矩阵：\n$$Y_R = U_k \\Sigma_k \\mathbf{0}_{2 \\times 2} = \\mathbf{0}_{3 \\times 2}$$\n零矩阵的值域是平凡向量空间 $\\{\\mathbf{0}\\}$。到这个空间上的正交投影是零矩阵，所以 $Q_R Q_R^{\\top} = \\mathbf{0}_{3 \\times 3}$。得到的近似矩阵 $A_R$ 也是零矩阵：\n$$A_R = (\\mathbf{0}_{3 \\times 3}) A = \\mathbf{0}_{3 \\times 5}$$\n近似误差是 $A$ 和 $A_R$ 之间差的谱范数：\n$$E_{\\text{right}} = \\|A - A_R\\|_2 = \\|A - \\mathbf{0}\\|_2 = \\|A\\|_2$$\n一个矩阵的谱范数是其最大的奇异值。对于矩阵 $A$，这个值是 $\\sigma_1$。\n$$E_{\\text{right}} = \\sigma_1$$\n\n**2. 左描绘误差 $E_{\\text{left}}$ 的计算**\n\n第二步是计算描绘后的矩阵 $W_L = A^{\\top} \\Phi_L$。我们代入 $A$ 的 SVD 的转置和 $\\Phi_L$ 的定义：\n$$A^{\\top} = (U_k \\Sigma_k V_k^{\\top})^{\\top} = V_k \\Sigma_k^{\\top} U_k^{\\top} = V_k \\Sigma_k U_k^{\\top}$$\n描绘矩阵是 $\\Phi_L = U_k$。因此，$W_L$ 是：\n$$W_L = (V_k \\Sigma_k U_k^{\\top}) U_k = V_k \\Sigma_k (U_k^{\\top} U_k)$$\n由于 $U_k$ 的列是标准正交的，所以 $U_k^{\\top} U_k = I_2$，即 $2 \\times 2$ 的单位矩阵。\n$$W_L = V_k \\Sigma_k I_2 = V_k \\Sigma_k$$\n给定 $V_k = [e_4 \\;\\; e_5]$ 和 $\\Sigma_k = \\operatorname{diag}(\\sigma_1, \\sigma_2)$：\n$$W_L = [e_4 \\;\\; e_5] \\begin{pmatrix} \\sigma_1  0 \\\\ 0  \\sigma_2 \\end{pmatrix} = [\\sigma_1 e_4 \\;\\; \\sigma_2 e_5]$$\n$W_L$ 的值域是 $\\operatorname{span}\\{\\sigma_1 e_4, \\sigma_2 e_5\\}$。因为 $\\sigma_1, \\sigma_2  0$，这等价于 $\\operatorname{span}\\{e_4, e_5\\}$。向量 $e_4$ 和 $e_5$ 构成一个标准正交集。因此，$\\operatorname{range}(W_L)$ 的一个标准正交基就是 $P_L = [e_4 \\;\\; e_5] = V_k$。\n\n到 $W_L$ 值域上的正交投影是 $P_L P_L^{\\top} = V_k V_k^{\\top}$。近似矩阵 $A_L$ 是：\n$$A_L = A P_L P_L^{\\top} = A V_k V_k^{\\top}$$\n近似误差是 $A - A_L$ 的谱范数：\n$$E_{\\text{left}} = \\|A - A_L\\|_2 = \\|A - A V_k V_k^{\\top}\\|_2 = \\|A(I_5 - V_k V_k^{\\top})\\|_2$$\n代入 $A = U_k \\Sigma_k V_k^{\\top}$：\n$$A(I_5 - V_k V_k^{\\top}) = U_k \\Sigma_k V_k^{\\top} (I_5 - V_k V_k^{\\top}) = U_k \\Sigma_k (V_k^{\\top} - V_k^{\\top} V_k V_k^{\\top})$$\n由于 $V_k$ 的列是标准正交的，所以 $V_k^{\\top} V_k = I_2$。该表达式简化为：\n$$U_k \\Sigma_k (V_k^{\\top} - I_2 V_k^{\\top}) = U_k \\Sigma_k (V_k^{\\top} - V_k^{\\top}) = U_k \\Sigma_k (\\mathbf{0}_{2 \\times 5}) = \\mathbf{0}_{3 \\times 5}$$\n因此，误差矩阵是零矩阵，其范数为零。\n$$E_{\\text{left}} = \\|\\mathbf{0}_{3 \\times 5}\\|_2 = 0$$\n\n**3. 描绘方向的论证**\n\n矩阵 $A$ 的**值域**是其列空间，由其 SVD 中的 $U_k$ 的列张成。为了找到这个空间，必须有效地“激发”或采样 $A$ 的列。这通过后乘（从**右侧**描绘）一组测试向量 $\\Omega$ 来完成，形成 $Y = A\\Omega$。$Y$ 的列是 $A$ 的列的线性组合，所以 $\\operatorname{range}(Y) \\subseteq \\operatorname{range}(A)$。如果 $\\Omega$ 选择得好（例如，随机选择），$\\operatorname{range}(Y)$ 将是对 $\\operatorname{range}(A)$ 的一个很好的近似。在这个问题中，“用于寻找值域的右描绘”失败了，因为所选的测试矩阵 $\\Omega_R = [e_1 \\;\\; e_2]$ 与 $A$ 的行空间（即 $\\operatorname{span}\\{e_4, e_5\\}$）正交，导致 $A\\Omega_R = \\mathbf{0}$。\n\n$A$ 的**余值域**（或行空间）是 $A^{\\top}$ 的值域，由 $V_k$ 的列张成。为了找到这个空间，必须采样 $A$ 的行，这等价于采样 $A^{\\top}$ 的列。这通过从右侧描绘 $A^{\\top}$ 来完成，创建 $W = A^{\\top}\\Phi$。这相当于从**左侧**描绘 $A$（因为 $W^{\\top} = \\Phi^{\\top} A$）。如果 $\\Phi$ 选择得好，$\\operatorname{range}(W)$ 将是对 $\\operatorname{range}(A^{\\top})$ 的一个很好的近似。在这个问题中，“用于寻找余值域的左描绘”使用了 $\\Phi_L=U_k$，它是 $A$ 的值域的一个完美基。这使得它能够完美地恢复 $A$ 的余值域，因为 $\\operatorname{range}(A^\\top \\Phi_L) = \\operatorname{range}(A^\\top U_k) = \\operatorname{range}(V_k)$，从而产生零误差。\n\n总而言之，从**右侧描绘以寻找值域**，从**左侧描绘以寻找余值域**。\n\n**4. 最终计算**\n\n问题要求计算 $E_{\\text{right}} - E_{\\text{left}}$ 的值。\n$$E_{\\text{right}} - E_{\\text{left}} = \\sigma_1 - 0 = \\sigma_1$$\n这是最终的简化表达式。", "answer": "$$\\boxed{\\sigma_1}$$", "id": "3569859"}]}