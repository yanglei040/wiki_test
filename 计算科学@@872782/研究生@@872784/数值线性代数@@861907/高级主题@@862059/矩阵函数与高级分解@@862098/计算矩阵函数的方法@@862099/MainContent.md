## 引言
将标量函数如 $e^x$ 或 $\sqrt{x}$ 的概念推广到矩阵，是数值线性代数中一个深刻而基本的问题。[矩阵函数](@entry_id:180392) $f(A)$ 不仅是理论上的抽象构造，更是求解科学与工程领域众多核心问题的关键工具，从[线性微分方程](@entry_id:150365)的解 $e^{At}b$ 到复杂网络分析中的矩阵[中心性度量](@entry_id:144795)，其应用无处不在。

然而，从标量到矩阵的这一步远非平凡。如何精确定义 $f(A)$？其计算的敏感性如何？一个看似稳定的算法为何会在特定矩阵上产生巨大误差？这些问题，特别是当矩阵不具备正规性等良好性质时，构成了该领域的核心挑战。本文旨在系统性地回答这些问题，弥合理论定义与高效数值实现之间的鸿沟。

为了构建一个完整的知识体系，我们将分三步展开：首先，在“原理与机制”一章中，我们将深入探讨[矩阵函数](@entry_id:180392)的多种等价定义、主函数与非主函数的区别，以及[条件数](@entry_id:145150)与[非正规性](@entry_id:752585)对计算稳定性的深刻影响。接着，在“应用与[交叉](@entry_id:147634)学科联系”一章中，我们将考察一系列主流计算方法，从经典的 Schur-Parlett 算法到适用于大规模问题的[克雷洛夫子空间](@entry_id:751067)法，并展示它们在控制理论、计算物理等领域的实际应用。最后，通过“动手实践”环节，读者将有机会将理论知识应用于具体问题，加深理解。让我们首先从构建[矩阵函数](@entry_id:180392)理论的基石——其基本原理与机制——开始。

## 原理与机制

在介绍性章节之后，我们现在深入探讨[计算矩阵函数](@entry_id:747651)所依赖的核心数学原理和机制。本章将从[矩阵函数](@entry_id:180392)的基本定义出发，逐步揭示其性质、计算中的敏感性问题，以及[非正规性](@entry_id:752585)在其中扮演的关键角色。

### [矩阵函数](@entry_id:180392)的定义：三个视角

将一个标量函数 $f$ 应用于一个方阵 $A$，这个看似简单的想法可以通过几种等价但视角各异的方式来精确化。

#### Jordan 分解定义

最直接的代数定义依赖于矩阵的 **Jordan 标准型 (Jordan Canonical Form)**。我们知道，任何复方阵 $A \in \mathbb{C}^{n \times n}$ 都可以通过[相似变换](@entry_id:152935)分解为 $A = Z J Z^{-1}$，其中 $Z$ 是[可逆矩阵](@entry_id:171829)，$J$ 是一个分[块对角矩阵](@entry_id:145530)，其对角块是形如 $J_k(\lambda)$ 的 Jordan 块。

对于最简单的情况，即 $A$ 是**可[对角化](@entry_id:147016)**的，那么 $J$ 就是一个[对角矩阵](@entry_id:637782) $D = \operatorname{diag}(\lambda_1, \dots, \lambda_n)$，其中 $\lambda_i$ 是 $A$ 的[特征值](@entry_id:154894)。此时，$f(A)$ 的定义非常直观：
$f(A) = Z f(D) Z^{-1} = Z \operatorname{diag}(f(\lambda_1), \dots, f(\lambda_n)) Z^{-1}$。

当 $A$ **不可对角化**时，定义必须扩展到 Jordan 块上。对于一个大小为 $k \times k$ 的 Jordan 块 $J_k(\lambda) = \lambda I + N_k$，其中 $N_k$ 是一个主次对角线为 $1$ 其余元素为 $0$ 的[幂零矩阵](@entry_id:152732)（$N_k^k=0$），$f(J_k(\lambda))$ 的定义则需要 $f$ 在 $\lambda$ 处的导数信息。具体而言，若函数 $f$ 在包含 $A$ 的谱 $\sigma(A)$ 的开集上解析，则 $f(J_k(\lambda))$ 定义为：

$f(J_k(\lambda)) = \sum_{m=0}^{k-1} \frac{f^{(m)}(\lambda)}{m!} N_k^m = \begin{pmatrix} f(\lambda)  f'(\lambda)  \frac{f''(\lambda)}{2!}  \cdots  \frac{f^{(k-1)}(\lambda)}{(k-1)!} \\ 0  f(\lambda)  f'(\lambda)  \cdots  \frac{f^{(k-2)}(\lambda)}{(k-2)!} \\ \vdots  \vdots  \ddots  \ddots  \vdots \\ 0  0  \cdots  f(\lambda)  f'(\lambda) \\ 0  0  \cdots  0  f(\lambda) \end{pmatrix}$

这个定义揭示了一个深刻的联系：计算非[对角化](@entry_id:147016)矩阵的函数值，等价于在每个[特征值](@entry_id:154894)上进行 **Hermite 插值**。为了确定 $f(J_k(\lambda))$，我们需要知道 $f$ 在 $\lambda$ 点的函数值及其直到 $k-1$ 阶的导数值 [@problem_id:3559871]。这与可[对角化](@entry_id:147016)情况形成鲜明对比，后者（所有 Jordan 块大小均为 $1 \times 1$）仅需要函数在各个[特征值](@entry_id:154894)上的值，相当于 **Lagrange 插值** [@problem_id:3559871]。

#### Cauchy 积分定义

一个更强大且在理论上极为重要的定义是 **Cauchy 积分公式**的推广，也称为 Riesz-Dunford [泛函演算](@entry_id:138358)。若函数 $f$ 在一个包含 $A$ 的谱 $\sigma(A)$ 的开集 $\Omega$ 上解析，我们可以选取一条或多条在 $\Omega$ 内的简单闭合[正向围线](@entry_id:166941) $\Gamma$，使得 $\Gamma$ 包围住 $\sigma(A)$。那么 $f(A)$ 可以定义为：

$f(A) = \frac{1}{2\pi i} \int_{\Gamma} f(z)(zI - A)^{-1} dz$

这里的 $(zI - A)^{-1}$ 是矩阵 $A$ 的**[预解式](@entry_id:199555) (resolvent)**。这个积分是逐元素进行的。这个定义的优雅之处在于，只要满足上述条件，积分的结果不依赖于围线 $\Gamma$ 的具体选择 [@problem_id:3559855]。这是因为被积函数 $f(z)(zI - A)^{-1}$ 在 $\Gamma$ 之间且不包含 $\sigma(A)$ 的区域内是解析的，根据 Cauchy 定理，沿不同围线的积分值是相同的。

可以证明，这个定义与基于 Jordan 标准型的定义是等价的。当我们将[预解式](@entry_id:199555)对 Jordan 块展开时，会自然地产生 $(z-\lambda)^{-(m+1)}$ 这样的项，通过 Cauchy 导数公式 $\frac{f^{(m)}(\lambda)}{m!} = \frac{1}{2\pi i} \int_{\Gamma} \frac{f(z)}{(z-\lambda)^{m+1}} dz$ 正好可以得到与 Hermite 插值定义相同的导数项 [@problem_id:3559855]。

### 主[矩阵函数](@entry_id:180392)与非主[矩阵函数](@entry_id:180392)

上述两种定义方式有一个至关重要的共同点：对于一个给定的函数 $f$ 和矩阵 $A$，它们都导出一个**唯一**的结果。通过这些定义得到的 $f(A)$ 被称为**主[矩阵函数](@entry_id:180392) (primary matrix function)**。

主函数的一个核心性质是它可以用一个关于 $A$ 的多项式来表示，即 $f(A)=p(A)$。这个多项式 $p$ 就是在 $A$ 的谱上对 $f$ 进行 Hermite 插值的多项式。因为 $p(A)$ 的值是唯一确定的，所以 $f(A)$ 的值也是唯一的，并且不依赖于 Jordan 分解中[相似变换](@entry_id:152935)矩阵 $Z$ 的具体选择 [@problem_id:3559835]。

然而，是否存在不满足这种唯一性的“[矩阵函数](@entry_id:180392)”呢？答案是肯定的。这些函数被称为**非主[矩阵函数](@entry_id:180392) (nonprimary matrix functions)**。它们的值可能依赖于 Jordan 基的具体选择。

例如，考虑一个 $3 \times 3$ 的 Jordan 块 $A_0 = J_3(1)$。主函数 $f(A_0)$ 是唯一确定的。但如果我们定义一个映射 $g(A_0; Z) = Z(f(J) + \alpha E_{21})Z^{-1}$，其中 $A_0 = ZJZ^{-1}$，$J=J_3(1)$，$\alpha \neq 0$ 是一个标量，$E_{21}$ 是 $(2,1)$ 位置为 $1$ 的矩阵。这个映射 $g$ 的值会随着 $Z$ 的选择而改变，因为矩阵 $E_{21}$ 并不与所有和 $J$ 可交换的可逆矩阵 $Z$ 可交换。因此，$g$ 是一个非主函数 [@problem_id:3559835]。

**[矩阵对数](@entry_id:169041)**是理解主函数与非主函数的另一个绝佳例子。一个矩阵 $X$ 若满足 $\exp(X) = A$，则称 $X$ 是 $A$ 的一个对数。一个可逆矩阵 $A$ 通常有无穷多个对数。然而，如果我们指定一个标量对数函数的特定分支（例如，[主分支](@entry_id:164844) $\log(z)$），那么通过[泛函演算](@entry_id:138358)得到的[矩阵函数](@entry_id:180392) $\log(A)$ 是唯一的，这是一个主[矩阵函数](@entry_id:180392)。

但是，我们可以构造非主的[矩阵对数](@entry_id:169041)。假设矩阵 $A$ 有两个相同的 Jordan 块，例如 $A = \operatorname{diag}(J(\lambda), J(\lambda))$。我们可以为第一个块选择对数的[主分支](@entry_id:164844)（例如 $k=0$），而为第二个块选择另一个分支（例如 $k=1$）。这样构造出的矩阵 $L^{(0,1)}(A)$ 仍然满足 $\exp(L^{(0,1)}(A)) = A$，因此它也是 $A$ 的一个对数。但因为它在同一个[特征值](@entry_id:154894) $\lambda$ 上使用了不同的函数值，它无法由任何单个解析函数 $f$ 生成，故为一个非主[矩阵函数](@entry_id:180392) [@problem_id:3559877]。标准的数值算法，如 Schur-Parlett 算法，被设计用来计算主[矩阵函数](@entry_id:180392)，而无法直接计算这类非主函数 [@problem_id:3559877]。

### 重要函数示例及其性质

让我们通过几个核心的例子来具体理解[矩阵函数](@entry_id:180392)的性质。

#### [矩阵指数](@entry_id:139347)

矩阵指数 $\exp(A)$ 是最基本也是性质最好的[矩阵函数](@entry_id:180392)。由于标量[指数函数](@entry_id:161417) $\exp(z)$ 是在整个复平面上都解析的**[整函数](@entry_id:176232) (entire function)**，因此任何方阵 $A$ 的[指数函数](@entry_id:161417) $\exp(A)$ 总是有定义的。

#### 具有[分支切割](@entry_id:174657)的函数

当标量函数本身不是[整函数](@entry_id:176232)时，情况就变得复杂起来。最典型的例子是带有**[分支切割](@entry_id:174657) (branch cut)** 的函数，如对数和平方根。

**[主对数](@entry_id:195969) ($\log(A)$):** 对应于标量对数的[主分支](@entry_id:164844) $\log(z)$，其[分支切割](@entry_id:174657)通常定义在非正实轴 $(-\infty, 0]$ 上。为了使主[矩阵对数](@entry_id:169041) $\log(A)$ 有定义，函数 $\log(z)$ 必须在 $A$ 的谱 $\sigma(A)$ 的一个邻域内解析。这意味着 $\sigma(A)$ 不能与[分支切割](@entry_id:174657) $(-\infty, 0]$ 相交。换言之，**$\log(A)$ 存在的充分必要条件是 $A$ 可逆（即没有零[特征值](@entry_id:154894)）且没有任何负实数[特征值](@entry_id:154894)** [@problem_id:3559907]。

当 $\log(A)$ 存在时，它是在所有满足 $\exp(X)=A$ 的矩阵 $X$ 中唯一一个其谱的虚部落在 $(-\pi, \pi)$ 区间内的矩阵 [@problem_id:3559907]。

**[主平方根](@entry_id:180892) ($A^{1/2}$):** 类似地，[主平方根](@entry_id:180892) $A^{1/2}$ 对应于标量函数 $z^{1/2}$ 的[主分支](@entry_id:164844)，其[分支切割](@entry_id:174657)也是 $(-\infty, 0]$。因此，**$A^{1/2}$ 存在的充分必要条件是 $A$ 没有非正实数[特征值](@entry_id:154894)**。当它存在时，它是方程 $X^2=A$ 的唯一解，其所有[特征值](@entry_id:154894)的实部都为正 [@problem_id:3559900]。

一个重要的性质是，像[主平方根](@entry_id:180892)这样的主函数，是与相似变换相容的：$(S^{-1}AS)^{1/2} = S^{-1}A^{1/2}S$ [@problem_id:3559900]。

#### [矩阵符号函数](@entry_id:751764)及其与极分解的联系

[矩阵符号函数](@entry_id:751764) $\mathrm{sign}(A)$ 是一个在控制理论和数值计算中非常有用的工具。它对应于标量[符号函数](@entry_id:167507) $\mathrm{sign}(z)$，当 $\Re(z)>0$ 时为 $1$，当 $\Re(z)<0$ 时为 $-1$。因此，**$\mathrm{sign}(A)$ 存在的条件是 $A$ 没有纯虚数[特征值](@entry_id:154894)**。其作用是将 $A$ 的[特征值](@entry_id:154894)映射到 $\{+1, -1\}$，从而将[向量空间分解](@entry_id:194743)为与 $A$ 的“稳定”和“不稳定”部分对应的[子空间](@entry_id:150286)。$\mathrm{sign}(A)$ 可以通过一个优雅的公式定义：$\mathrm{sign}(A) = A(A^2)^{-1/2}$ [@problem_id:3559900]。

[符号函数](@entry_id:167507)与矩阵的**极分解 (polar decomposition)** $A=UH$ 有着深刻的联系，其中 $U$ 是[酉矩阵](@entry_id:138978)，$H$ 是唯一的 Hermitian 正定矩阵。这个 $H$ 正是 $A^*A$ 的[主平方根](@entry_id:180892)，即 $H=(A^*A)^{1/2}$ [@problem_id:3559900]。虽然一般情况下 $\mathrm{sign}(A)$ 并不等于 $U$，但它们之间存在一个奇妙的恒等式。考虑一个增广的[分块矩阵](@entry_id:148435) $B = \begin{pmatrix} 0  A \\ A^*  0 \end{pmatrix}$，它的[符号函数](@entry_id:167507)恰好揭示了 $A$ 的酉因子 $U$：
$\mathrm{sign}(B) = \begin{pmatrix} 0  U \\ U^*  0 \end{pmatrix}$ [@problem_id:3559900]。

### 敏感性与[条件数](@entry_id:145150)

在数值计算中，我们不仅关心如何定义 $f(A)$，更关心当 $A$ 有微小扰动时 $f(A)$ 会发生多大变化。这就是函数的敏感性或**条件 (conditioning)** 问题。

#### Fréchet 导数：一阶摄动分析

对 $f(A)$ 的敏感性分析始于 **Fréchet 导数**。对于一个微小的扰动矩阵 $E$，函数值的变化可以做一阶展开：
$f(A+E) = f(A) + L_f(A, E) + o(\|E\|)$

其中 $L_f(A, E)$ 是 $f$ 在 $A$ 点关于扰动 $E$ 的 Fréchet 导数，它是一个将 $E$ [线性映射](@entry_id:185132)到 $f(A)$ 一阶变化量的算子 [@problem_id:3559897]。只要 $f$ 在 $A$ 处 Fréchet 可微，这个[线性算子](@entry_id:149003)就是唯一的。

例如，对于[矩阵求逆](@entry_id:636005)函数 $f(A) = A^{-1}$，我们可以通过 Neumann 级数展开 $(A+E)^{-1}$ 得到：
$(A+E)^{-1} = A^{-1} - A^{-1}EA^{-1} + O(\|E\|^2)$
因此，其 Fréchet 导数为 $L_{A^{-1}}(A, E) = -A^{-1}EA^{-1}$ [@problem_id:3559862]。

#### [条件数](@entry_id:145150)：[误差放大](@entry_id:749086)因子

**相对条件数 $\kappa_f(A)$** 量化了输入 $A$ 的相对误差在最坏情况下被放大为输出 $f(A)$ 相对误差的倍数。其定义为：
$\kappa_f(A) = \frac{\|L_f(A)\| \|A\|}{\|f(A)\|}$

其中 $\|L_f(A)\|$ 是 Fréchet 导数算子的范数。这个定义意味着，对于足够小的扰动 $E$：
$\frac{\|f(A+E) - f(A)\|}{\|f(A)\|} \lesssim \kappa_f(A) \frac{\|E\|}{\|A\|}$ [@problem_id:3559897]。

一个大的条件数 $\kappa_f(A)$ 意味着问题是**病态的 (ill-conditioned)**，即使是很小的输入误差也可能导致巨大的输出误差。

让我们来看几个例子：
-   **[矩阵求逆](@entry_id:636005)**: 对于 $f(A)=A^{-1}$，可以证明 $\kappa_f(A) = \|A\|\|A^{-1}\| = \kappa(A)$，即矩阵 $A$ 自身的谱[条件数](@entry_id:145150)。这与我们的直觉相符：对一个接近奇异的[矩阵求逆](@entry_id:636005)是一个[病态问题](@entry_id:137067) [@problem_id:3559862]。
-   **[矩阵指数](@entry_id:139347)**: 对于标量函数 $e^x$，其相对[条件数](@entry_id:145150)为 $|x|$。类似地，计算 $\exp(A)$ 的[条件数](@entry_id:145150)通常会随着 $A$ 的谱半径增大而变差。
-   **[矩阵对数](@entry_id:169041)**: 对于标量函数 $\ln(x)$，其相对条件数为 $1/|\ln(x)|$。这个值在 $x=1$ 附近会趋于无穷。因此，计算 $\log(A)$ 对于那些有靠近 $1$ 的[特征值](@entry_id:154894)的矩阵来说是病态的 [@problem_id:3559897]。

### [非正规性](@entry_id:752585)的影响

对于**[正规矩阵](@entry_id:185943)** ($A^*A = AA^*$)，许多关于[矩阵函数](@entry_id:180392)的分析可以简化，因为它们的行为很大程度上由其谱决定。例如，对于 $2$-范数，我们有 $\|f(A)\|_2 = \max_{\lambda \in \sigma(A)} |f(\lambda)|$。然而，对于**[非正规矩阵](@entry_id:752668)**，情况则复杂得多。

#### 范数与谱：[非正规矩阵](@entry_id:752668)的“意外”行为

[非正规矩阵](@entry_id:752668)的一个显著特征是 $\|f(A)\|$ 可能远大于 $\max_{\lambda \in \sigma(A)} |f(\lambda)|$。换句话说，即使一个矩阵的所有[特征值](@entry_id:154894)都在函数表现“温和”的区域，函数作用于该矩阵后的范数也可能非常大。

理解这种范数增长现象的两个有力工具是**[数值范围](@entry_id:752817) (numerical range)** 和**[伪谱](@entry_id:138878) (pseudospectrum)**。

- **[数值范围](@entry_id:752817)与 Crouzeix 定理**: 矩阵 $A$ 的[数值范围](@entry_id:752817) $W(A) = \{x^*Ax : \|x\|_2=1\}$ 是复平面上的一个包含其谱的[凸集](@entry_id:155617)。对于[非正规矩阵](@entry_id:752668)，$W(A)$ 可能比其谱的凸包大得多。**Crouzeix 定理**提供了一个强大的界：
    $\|f(A)\|_2 \le C \max_{z \in W(A)}|f(z)|$
    其中 $C$ 是一个通用常数（目前已证明 $C \le 1+\sqrt{2}$）。这个定理告诉我们， $f(A)$ 的范数更多地受函数在其[数值范围](@entry_id:752817)上的行为控制，而非仅仅是谱。例如，对于矩阵 $A = \begin{pmatrix} 1  10 \\ 0  1 \end{pmatrix}$，其谱仅为 $\{1\}$，但其[数值范围](@entry_id:752817)是一个很大的椭圆盘，其实部延伸至 $6$。因此，$\max_{z \in W(A)}|\exp(z)| = \exp(6)$，这部分解释了为何 $\|\exp(A)\|_2$ 远大于 $\exp(1)$ [@problem_id:3559853]。

- **伪谱**: $A$ 的 $\varepsilon$-伪谱 $\sigma_\varepsilon(A)$ 是所有满足 $\|(zI-A)^{-1}\| \ge \varepsilon^{-1}$ 的复数 $z$ 的集合。它可以被看作是“数值上”的谱。一个高度非正规的矩阵，其谱可能只是几个点，但其[伪谱](@entry_id:138878)可以扩展到非常广阔的区域。如果函数 $f$ 在[伪谱](@entry_id:138878)的某些区域取值很大，那么 $\|f(A)\|$ 也很可能会很大。例如，我们可以构造一个 $2 \times 2$ 的[非正规矩阵](@entry_id:752668) $A$，其谱 $\sigma(A) = \{1/2\}$ 深陷于单位圆盘内。然而，通过调整其[非正规性](@entry_id:752585)（即非对角元的大小），可以使其 $\varepsilon$-伪谱扩展到[单位圆](@entry_id:267290)的边界。由于 $\exp(z)$ 在[单位圆](@entry_id:267290)边界上的值（例如在 $z=1$ 处为 $e$）远大于在 $z=1/2$ 处的值（$e^{1/2}$），这会导致 $\|\exp(A)\|$ 的范数远大于根据其谱预期的值，从而产生巨大的**[放大因子](@entry_id:144315)** $\mathcal{R} = \|f(A)\| / \max_{z \in S} |f(z)|$ [@problem_id:3559837]。

#### [非正规性](@entry_id:752585)与条件数

[非正规性](@entry_id:752585)同样会严重恶化问题的条件数。对于[非正规矩阵](@entry_id:752668)，$\|L_f(A)\|$ 可能会比基于其谱的简单估计大得多。Fréchet 导数的积分或[级数表示](@entry_id:175860)式中，扰动矩阵 $E$ 通常被“夹在”与 $A$ 相关的项之间，例如 $L_{e^A}(A,E) = \int_0^1 e^{A(1-s)} E e^{As} ds$。如果 $A$ 是高度非正规的，$e^{At}$ 可能会在衰减到零之前经历巨大的[瞬时增长](@entry_id:263654)，这种增长会放大 $E$ 的影响，导致 Fréchet 导数范数巨大，从而使条件数变得非常大 [@problem_id:3559897]。

### 数值算法的稳定性

最后，我们将上述理论与实际的数值计算联系起来。

#### [后向误差](@entry_id:746645)、[前向误差](@entry_id:168661)与[条件数](@entry_id:145150)

假设一个算法计算 $f(A)$ 得到的结果是 $\widehat{F}$。
- **[前向误差](@entry_id:168661) (Forward Error)** 是计算结果与真实结果的差距，例如 $\|\widehat{F} - f(A)\|$。
- **[后向误差](@entry_id:746645) (Backward Error)** 是将计算结果 $\widehat{F}$ 解释为某个“附近”问题 $f(A+\Delta A)$ 的精确解时，输入扰动 $\Delta A$ 的大小。**范数[后向误差](@entry_id:746645)** $\eta(A, \widehat{F})$ 定义为使得 $\widehat{F} = f(A+\Delta A)$ 的最小的 $\|\Delta A\|$ [@problem_id:3559899]。

一个算法如果总能保证其产生的[后向误差](@entry_id:746645)与[机器精度](@entry_id:756332) $u$ 是同一个[数量级](@entry_id:264888)，即 $\eta(A, \widehat{F})/\|A\| \approx O(u)$，我们就称该算法是**后向稳定 (backward stable)** 的。

这三个量之间存在一个基本关系，它是一阶分析的核心：
**相对[前向误差](@entry_id:168661) $\lesssim$ 条件数 $\times$ 相对[后向误差](@entry_id:746645)** [@problem_id:3559899] [@problem_id:3559862]。

#### 稳定性与准确性的关系

这个关系式告诉我们，一个算法的最终表现由两方面决定：
1.  **算法的稳定性**：一个后向稳定的算法“尽了它的本分”，它给出的答案是某个附近问题的精确解。
2.  **问题的条件数**：问题本身的敏感性决定了即使是输入的微小扰动（由[后向误差](@entry_id:746645)引入）会在输出中造成多大的误差。

因此，**稳定性 $\neq$ 准确性**。即使我们使用一个完美的[后向稳定算法](@entry_id:633945)，如果问题本身是病态的（即 $\kappa_f(A)$ 很大），最终的计算结果（[前向误差](@entry_id:168661)）也可能非常不准确。

让我们考虑一个具体的例子：计算 $f(A_\varepsilon) = A_\varepsilon^{-1}$，其中 $A_\varepsilon = \begin{pmatrix} 1  1 \\ 1  1+\varepsilon \end{pmatrix}$。当 $\varepsilon \to 0$ 时，这个矩阵接近奇异。我们可以计算出该问题的条件数 $\kappa_f(A_\varepsilon) = \kappa(A_\varepsilon)$，并且发现 $\kappa_f(A_\varepsilon) \approx 4/\varepsilon$。这意味着当 $\varepsilon$ 非常小时，条件数会变得极大。如果我们用一个后向稳定的算法（例如，基于 Schur 分解的算法）来计算 $A_\varepsilon^{-1}$，其相对[后向误差](@entry_id:746645)可能很小，比如 $10^{-16}$。但是，由此产生的相对[前向误差](@entry_id:168661)的界大约是 $\kappa_f(A_\varepsilon) \times 10^{-16} \approx \frac{4}{\varepsilon} \times 10^{-16}$。如果 $\varepsilon = 10^{-10}$，这个界就会达到 $4 \times 10^{-6}$，这意味着我们可能会损失大约 6 位有效数字的精度，尽管我们使用的是一个“好”的算法 [@problem_id:3559862]。这个例子清晰地展示了即使算法稳定，[病态问题](@entry_id:137067)也会导致精度损失。