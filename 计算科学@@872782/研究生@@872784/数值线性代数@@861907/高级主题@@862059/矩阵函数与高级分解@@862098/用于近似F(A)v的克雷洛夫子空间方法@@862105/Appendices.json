{"hands_on_practices": [{"introduction": "为了将克里洛夫子空间投影的抽象定义付诸实践，我们从一个具体的计算练习开始。通过在一个小规模的幂零矩阵上逐步应用阿诺尔迪过程，我们可以精确地手工计算出完整的近似过程。这个练习 [@problem_id:3553874] 将揭示该方法的核心机制，而不会被数值计算的复杂性所干扰，从而为理解更复杂的情景奠定坚实的基础。", "problem": "设 $A \\in \\mathbb{R}^{3 \\times 3}$ 和 $v \\in \\mathbb{R}^{3}$ 由下式给出\n$$\nA \\;=\\; \\begin{pmatrix}\n0  2  0 \\\\\n0  0  3 \\\\\n0  0  0\n\\end{pmatrix},\n\\qquad\nv \\;=\\; \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}.\n$$\n考虑通过幂级数定义的解析矩阵函数。特别地，定义指数函数和第一个 $\\varphi$-函数为\n$$\n\\exp(A) \\;=\\; \\sum_{k=0}^{\\infty} \\frac{A^{k}}{k!},\n\\qquad\n\\varphi_{1}(A) \\;=\\; \\sum_{k=0}^{\\infty} \\frac{A^{k}}{(k+1)!},\n$$\n这与标量恒等式 $\\varphi_{1}(z) = \\frac{\\exp(z) - 1}{z}$（对于 $z \\in \\mathbb{C}$）和 $\\varphi_{1}(0) = 1$ 相符。\n\n从 Krylov 子空间 $\\mathcal{K}_{m}(A,v) = \\operatorname{span}\\{v, Av, \\dots, A^{m-1}v\\}$ 的定义和由 Arnoldi 过程构造的标准正交基所导出的正交投影原理出发，对 $m=2$ 执行以下操作：\n\n1. 构造 $\\mathcal{K}_{2}(A,v)$ 的一个标准正交基 $V_{2}$ 以及相关的投影矩阵 $H_{2} \\in \\mathbb{R}^{2 \\times 2}$，使得 Arnoldi 关系成立。\n\n2. 仅使用基本定义（解析矩阵函数的幂级数、线性和到 Krylov 子空间的正交投影），推导并计算 $\\exp(A)v$ 和 $\\varphi_{1}(A)v$ 的 $\\mathcal{K}_{2}(A,v)$ 正交投影近似值。\n\n3. 计算每个函数的近似误差的欧几里得范数，即 $\\|\\,\\exp(A)v - y_{\\exp}\\,\\|_{2}$ 和 $\\|\\,\\varphi_{1}(A)v - y_{\\varphi}\\,\\|_{2}$，其中 $y_{\\exp}$ 和 $y_{\\varphi}$ 表示在步骤2中找到的各自的 $\\mathcal{K}_{2}(A,v)$ 近似值。\n\n比值\n$$\n\\frac{\\|\\,\\exp(A)v - y_{\\exp}\\,\\|_{2}}{\\|\\,\\varphi_{1}(A)v - y_{\\varphi}\\,\\|_{2}} \\, ?\n$$\n是多少？\n你的最终答案必须是一个实数。不要四舍五入；给出精确值。", "solution": "用户要求我解决一个数值线性代数问题。\n\n**第1步：提取已知条件**\n- 矩阵 $A \\in \\mathbb{R}^{3 \\times 3}$：\n$$ A = \\begin{pmatrix} 0  2  0 \\\\ 0  0  3 \\\\ 0  0  0 \\end{pmatrix} $$\n- 向量 $v \\in \\mathbb{R}^{3}$：\n$$ v = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} $$\n- 矩阵函数定义：\n$$ \\exp(A) = \\sum_{k=0}^{\\infty} \\frac{A^{k}}{k!} $$\n$$ \\varphi_{1}(A) = \\sum_{k=0}^{\\infty} \\frac{A^{k}}{(k+1)!} $$\n- Krylov 子空间定义：$\\mathcal{K}_{m}(A,v) = \\operatorname{span}\\{v, Av, \\dots, A^{m-1}v\\}$。\n- 任务需针对 $m=2$ 执行。\n- 任务1：使用 Arnoldi 过程构造 $\\mathcal{K}_{2}(A,v)$ 的标准正交基 $V_{2}$ 和投影矩阵 $H_{2}$。\n- 任务2：计算 $\\exp(A)v$ 和 $\\varphi_{1}(A)v$ 在 $\\mathcal{K}_{2}(A,v)$ 上的正交投影近似值。\n- 任务3：计算近似误差的欧几里得范数。\n- 最终问题：计算误差范数的比值。\n\n**第2步：使用提取的已知条件进行验证**\n- **科学依据**：该问题是数值线性代数领域的一个标准练习，具体涉及使用 Krylov 子空间方法来近似矩阵函数在向量上的作用。所有定义和概念（Arnoldi 过程、矩阵函数、Krylov 子空间）都是公认的。\n- **适定性**：该问题提供了所有必要的数据（$A$、$v$）、定义和清晰的任务序列。矩阵 $A$ 是幂零的，这简化了计算但并未使问题无效。对于指定的计算，存在唯一解。\n- **客观性**：该问题使用精确的数学语言陈述，没有任何主观或模糊的术语。\n\n该问题不违反任何无效标准。这是一个有效的、适定的数值线性代数问题。\n\n**第3步：结论与行动**\n问题有效。我将继续进行求解。\n\n解法按照问题陈述的要求分为三个部分呈现。\n\n**第1部分：通过 Arnoldi 过程构造 $V_2$ 和 $H_2$**\n\nArnoldi 过程为 Krylov 子空间 $\\mathcal{K}_{m}(A,v)$ 构造一个标准正交基 $\\{v_1, v_2, \\dots, v_m\\}$。给定 $m=2$。\n\n1.  通过对起始向量 $v$进行归一化来初始化过程。\n    $v$ 的欧几里得范数是 $\\|\\,v\\,\\|_{2} = \\sqrt{0^2 + 0^2 + 1^2} = 1$。\n    第一个基向量是 $v_1 = \\frac{v}{\\|\\,v\\,\\|_{2}} = v = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}$。\n\n2.  执行 Arnoldi 迭代的第一步以找到 $v_2$。\n    计算 $w_1 = Av_1$：\n    $$ w_1 = \\begin{pmatrix} 0  2  0 \\\\ 0  0  3 \\\\ 0  0  0 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 3 \\\\ 0 \\end{pmatrix} $$\n    将 $w_1$ 与现有基向量（仅 $v_1$）正交化。Hessenberg 矩阵 $H_2$ 中的相应条目是 $h_{1,1} = v_1^T w_1$：\n    $$ h_{1,1} = \\begin{pmatrix} 0  0  1 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 3 \\\\ 0 \\end{pmatrix} = 0 $$\n    待归一化的向量是 $w_1' = w_1 - h_{1,1}v_1 = w_1 - 0 \\cdot v_1 = \\begin{pmatrix} 0 \\\\ 3 \\\\ 0 \\end{pmatrix}$。\n    非对角线元素 $h_{2,1}$ 是该向量的范数：\n    $$ h_{2,1} = \\|\\,w_1'\\,\\|_{2} = \\sqrt{0^2 + 3^2 + 0^2} = 3 $$\n    如果 $h_{2,1} \\neq 0$，下一个基向量是 $v_2 = \\frac{w_1'}{h_{2,1}}$：\n    $$ v_2 = \\frac{1}{3} \\begin{pmatrix} 0 \\\\ 3 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} $$\n\n3.  执行 Arnoldi 迭代的第二步以找到 $H_2$ 的第二列。\n    计算 $w_2 = Av_2$：\n    $$ w_2 = \\begin{pmatrix} 0  2  0 \\\\ 0  0  3 \\\\ 0  0  0 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n    将 $w_2$ 与 $v_1$ 和 $v_2$ 正交化以找到 $h_{1,2}$ 和 $h_{2,2}$：\n    $$ h_{1,2} = v_1^T w_2 = \\begin{pmatrix} 0  0  1 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ 0 \\\\ 0 \\end{pmatrix} = 0 $$\n    $$ h_{2,2} = v_2^T w_2 = \\begin{pmatrix} 0  1  0 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ 0 \\\\ 0 \\end{pmatrix} = 0 $$\n    \n$\\mathcal{K}_{2}(A,v)$ 的标准正交基由矩阵 $V_2$ 的列给出：\n$$ V_{2} = [v_1, v_2] = \\begin{pmatrix} 0  0 \\\\ 0  1 \\\\ 1  0 \\end{pmatrix} $$\n相关的投影矩阵 $H_2$ 是：\n$$ H_{2} = \\begin{pmatrix} h_{1,1}  h_{1,2} \\\\ h_{2,1}  h_{2,2} \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ 3  0 \\end{pmatrix} $$\n\n**第2部分：正交投影近似**\n\n$f(A)v$ 的近似值定义为其在子空间 $\\mathcal{K}_{2}(A,v)$ 上的正交投影。设 $x_{true} = f(A)v$。近似值 $y_f$ 由 $y_f = P_2 x_{true}$ 给出，其中 $P_2 = V_2 V_2^T$ 是到 $V_2$ 的值域上的正交投影算子。\n\n首先，我们计算 $\\exp(A)v$ 和 $\\varphi_{1}(A)v$ 的精确值。矩阵 $A$ 是幂零的。我们来计算它的幂：\n$$ A^2 = \\begin{pmatrix} 0  2  0 \\\\ 0  0  3 \\\\ 0  0  0 \\end{pmatrix} \\begin{pmatrix} 0  2  0 \\\\ 0  0  3 \\\\ 0  0  0 \\end{pmatrix} = \\begin{pmatrix} 0  0  6 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix} $$\n$$ A^3 = A^2 A = \\begin{pmatrix} 0  0  6 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix} \\begin{pmatrix} 0  2  0 \\\\ 0  0  3 \\\\ 0  0  0 \\end{pmatrix} = \\begin{pmatrix} 0  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix} $$\n由于对于所有 $k \\ge 3$都有 $A^k = 0$ ，矩阵函数的无穷级数是有限的。\n\n-   **精确的 $\\exp(A)v$**：\n    $$ \\exp(A)v = \\left( \\sum_{k=0}^{\\infty} \\frac{A^{k}}{k!} \\right) v = \\left(I + A + \\frac{1}{2}A^2 \\right) v = v + Av + \\frac{1}{2}A^2v $$\n    我们需要 $Av$ 和 $A^2v$：\n    $$ Av = \\begin{pmatrix} 0 \\\\ 3 \\\\ 0 \\end{pmatrix}, \\qquad A^2v = A(Av) = \\begin{pmatrix} 0  2  0 \\\\ 0  0  3 \\\\ 0  0  0 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 3 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 6 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n    所以，精确值为：\n    $$ \\exp(A)v = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ 3 \\\\ 0 \\end{pmatrix} + \\frac{1}{2} \\begin{pmatrix} 6 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 3 \\\\ 3 \\\\ 1 \\end{pmatrix} $$\n\n-   **精确的 $\\varphi_{1}(A)v$**：\n    $$ \\varphi_{1}(A)v = \\left( \\sum_{k=0}^{\\infty} \\frac{A^{k}}{(k+1)!} \\right) v = \\left(I + \\frac{1}{2}A + \\frac{1}{6}A^2 \\right) v = v + \\frac{1}{2}Av + \\frac{1}{6}A^2v $$\n    精确值为：\n    $$ \\varphi_{1}(A)v = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} + \\frac{1}{2} \\begin{pmatrix} 0 \\\\ 3 \\\\ 0 \\end{pmatrix} + \\frac{1}{6} \\begin{pmatrix} 6 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ \\frac{3}{2} \\\\ 1 \\end{pmatrix} $$\n\n现在，我们通过投影计算近似值。投影算子 $P_2 = V_2 V_2^T$ 是：\n$$ P_2 = \\begin{pmatrix} 0  0 \\\\ 0  1 \\\\ 1  0 \\end{pmatrix} \\begin{pmatrix} 0  0  1 \\\\ 0  1  0 \\end{pmatrix} = \\begin{pmatrix} 0  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} $$\n-   **$\\exp(A)v$ 的近似值**：\n    $$ y_{\\exp} = P_2 (\\exp(A)v) = \\begin{pmatrix} 0  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} 3 \\\\ 3 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 3 \\\\ 1 \\end{pmatrix} $$\n\n-   **$\\varphi_{1}(A)v$ 的近似值**：\n    $$ y_{\\varphi} = P_2 (\\varphi_{1}(A)v) = \\begin{pmatrix} 0  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ \\frac{3}{2} \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ \\frac{3}{2} \\\\ 1 \\end{pmatrix} $$\n\n**第3部分：误差计算和比值**\n\n我们将误差计算为精确解与近似解之差，然后求其欧几里得范数。\n\n-   **$\\exp(A)v$ 的误差**：\n    误差向量为 $E_{\\exp} = \\exp(A)v - y_{\\exp}$：\n    $$ E_{\\exp} = \\begin{pmatrix} 3 \\\\ 3 \\\\ 1 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ 3 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 3 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n    误差的欧几里得范数是：\n    $$ \\|\\,\\exp(A)v - y_{\\exp}\\,\\|_{2} = \\|\\,E_{\\exp}\\,\\|_{2} = \\sqrt{3^2 + 0^2 + 0^2} = 3 $$\n\n-   **$\\varphi_{1}(A)v$ 的误差**：\n    误差向量为 $E_{\\varphi} = \\varphi_{1}(A)v - y_{\\varphi}$：\n    $$ E_{\\varphi} = \\begin{pmatrix} 1 \\\\ \\frac{3}{2} \\\\ 1 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ \\frac{3}{2} \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n    误差的欧几里得范数是：\n    $$ \\|\\,\\varphi_{1}(A)v - y_{\\varphi}\\,\\|_{2} = \\|\\,E_{\\varphi}\\,\\|_{2} = \\sqrt{1^2 + 0^2 + 0^2} = 1 $$\n\n最后，我们计算所需的误差范数之比：\n$$ \\frac{\\|\\,\\exp(A)v - y_{\\exp}\\,\\|_{2}}{\\|\\,\\varphi_{1}(A)v - y_{\\varphi}\\,\\|_{2}} = \\frac{3}{1} = 3 $$", "answer": "$$\\boxed{3}$$", "id": "3553874"}, {"introduction": "在掌握了基本计算方法后，我们来探讨一个更深层次的细微差别。人们很容易将 $f(A)v$ 的近似误差与求解相关线性系统的残差联系起来，但这种直觉可能具有误导性。这个练习 [@problem_id:3553843] 构建了一个关键的反例，它表明即使相关线性系统的残差为零，函数近似本身的误差也可能非常大，从而强调了理解近似误差真实来源的重要性。", "problem": "考虑通过克雷洛夫子空间方法近似计算矩阵函数在向量上的作用的问题。设 $A \\in \\mathbb{C}^{2 \\times 2}$ 为对角矩阵 $A = \\mathrm{diag}(0, 10)$，$v \\in \\mathbb{C}^{2}$ 为 $v = \\begin{pmatrix}1 \\\\ 1\\end{pmatrix}$，标量位移为 $\\sigma = -1$。定义目标矩阵函数 $f$ 为 $f(z) = \\exp(z)$，并考虑基于单个移位逆的有理代理，即映射 $r_{\\sigma}(z) = \\frac{1}{z - \\sigma}$。在有理克雷洛夫子空间方法中，一种常见的启发式方法是：通过使用广义最小残差（GMRES）方法近似求解移位线性系统 $(A - \\sigma I) y = v$ 来计算 $y \\in \\mathcal{K}_{k}(A, v)$（其中 $\\mathcal{K}_{k}(A, v) = \\mathrm{span}\\{v, Av, \\dots, A^{k-1} v\\}$ 是第 $k$ 个克雷洛夫子空间），然后在用一个在 $\\sigma$ 处有极点的有理函数来近似 $f$ 时，使用 $y$ 作为 $f(A) v$ 的代理。在此设定下，固定 $k = 2$，初始猜测 $y_{0} = 0$，并定义 $y_{\\star}$ 为在仿射空间 $y_{0} + \\mathcal{K}_{k}(A, v)$ 上的唯一 GMRES($k$) 最小化子，满足\n$$\ny_{\\star} \\in \\mathcal{K}_{2}(A, v) \\quad \\text{且} \\quad y_{\\star} = \\arg\\min_{y \\in \\mathcal{K}_{2}(A, v)} \\|v - (A - \\sigma I) y\\|_{2}.\n$$\n仅使用克雷洛夫子空间的基本定义、可对角化矩阵的谱演算以及广义最小残差（GMRES）的残差最小化性质，完成以下任务：\n1. 证明存在一个1次多项式 $p(z)$，使得 $y_{\\star} = p(A) v$ 对该移位系统达到零残差，即 $\\|v - (A - \\sigma I) y_{\\star}\\|_{2} = 0$。\n2. 计算精确的误差向量 $f(A) v - y_{\\star}$。\n3. 以闭式解析表达式计算欧几里得范数 $\\|f(A) v - y_{\\star}\\|_{2}$。\n\n你的最终答案必须是 $\\|f(A) v - y_{\\star}\\|_{2}$ 的精确值，无舍入，无单位。", "solution": "用户希望我解决一个关于使用克雷洛夫子空间方法近似计算矩阵函数在向量上的作用的问题。\n\n我的计划如下：\n1.  **验证问题陈述。**\n    *   逐字提取所有给定信息。\n    *   检查其科学合理性、自洽性和适定性。\n2.  **如果有效，则解决问题。**\n    *   **第1部分：证明存在`p(z)`使得残差为零。**\n        *   问题要求证明对于系统 $(A - \\sigma I)y = v$，GMRES(2) 解 $y_\\star$ 的残差为零。\n        *   对于 $My = b$，GMRES(k) 在 $y_0 + \\mathcal{K}_k(M, r_0)$ 中找到解 $y$ 的最佳近似 $y_k$，其中 $r_0 = b - M y_0$。在这里，$M = A-\\sigma I$，$b = v$，$y_0 = 0$，所以 $r_0 = v$。\n        *   GMRES 的克雷洛夫子空间通常是 $\\mathcal{K}_k(A-\\sigma I, v)$。问题陈述的搜索空间是 $\\mathcal{K}_2(A, v)$。这两个子空间是相同的，因为任何 $(A-\\sigma I)^j$ 的幂都可以展开为 $A$ 的幂，反之亦然，这意味着 $\\mathcal{K}_k(A, v) = \\text{span}\\{v, (A-\\sigma I)v, \\dots, (A-\\sigma I)^{k-1}v\\} = \\mathcal{K}_k(A-\\sigma I, v)$。因此，该问题是适定的。\n        *   为了判断 GMRES(2) 是否能找到精确解，我们分析克雷洛夫子空间的维度。\n        *   我们来计算张成 $\\mathcal{K}_2(A, v)$ 的向量。\n            *   $A = \\begin{pmatrix} 0  0 \\\\ 0  10 \\end{pmatrix}$\n            *   $v = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$\n            *   $Av = \\begin{pmatrix} 0  0 \\\\ 0  10 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 10 \\end{pmatrix}$\n        *   向量 $v$ 和 $Av$ 是线性无关的，因为 $\\det \\begin{pmatrix} 1  0 \\\\ 1  10 \\end{pmatrix} = 10 \\neq 0$。\n        *   因此，$\\mathcal{K}_2(A, v) = \\mathrm{span}\\{v, Av\\}$ 的维度是 $2$。\n        *   由于 $A$ 是一个 $2 \\times 2$ 矩阵，空间 $\\mathbb{C}^2$ 的维度是 $2$。\n        *   因此，$\\mathcal{K}_2(A, v) = \\mathbb{C}^2$。\n        *   GMRES(2) 方法在空间 $y \\in \\mathcal{K}_2(A, v) = \\mathbb{C}^2$ 上为 $\\|v - (A - \\sigma I) y\\|_{2}$ 寻找一个最小化子 $y_\\star$。\n        *   由于 $y$ 的搜索空间是整个空间 $\\mathbb{C}^2$，只要矩阵 $(A - \\sigma I)$ 是可逆的，GMRES 就能找到线性系统 $(A - \\sigma I) y = v$ 的精确解。\n        *   我们来检查可逆性。位移是 $\\sigma = -1$。\n        *   $A - \\sigma I = A + I = \\begin{pmatrix} 1  0 \\\\ 0  11 \\end{pmatrix}$。\n        *   由于 $\\det(A+I) = 1 \\times 11 = 11 \\neq 0$，该矩阵是可逆的。\n        *   因此，存在一个唯一解 $y_\\star = (A - \\sigma I)^{-1}v$，并且由于 GMRES(2) 搜索整个空间，它将找到这个精确解。\n        *   对于这个解，残差范数为 $\\|v - (A - \\sigma I) y_{\\star}\\|_{2} = \\|v - (A - \\sigma I) (A - \\sigma I)^{-1} v\\|_{2} = \\|v - v\\|_{2} = 0$。这证明了陈述的第一部分。\n        *   此外，由于 $y_{\\star} \\in \\mathcal{K}_{2}(A, v)$，它可以被写成基向量的线性组合：$y_{\\star} = c_0 v + c_1 Av$（对于某些标量 $c_0, c_1 \\in \\mathbb{C}$）。这可以表示为 $y_{\\star} = (c_0 I + c_1 A) v$。\n        *   定义多项式 $p(z) = c_0 + c_1 z$，其次数最多为1，我们得到 $y_{\\star} = p(A)v$。这证明了这样一个多项式的存在。如果 $c_1 \\neq 0$，则次数恰好为1。我们将计算 $y_\\star$ 并看到情况确实如此。\n\n    *   **第2部分：计算精确的误差向量 `f(A)v - y_star`。**\n        *   首先，我们计算 $f(A)v$。函数是 $f(z) = \\exp(z)$。\n        *   对于一个对角矩阵 $A = \\mathrm{diag}(\\lambda_1, \\lambda_2)$，矩阵函数为 $f(A) = \\mathrm{diag}(f(\\lambda_1), f(\\lambda_2))$。\n        *   $A = \\mathrm{diag}(0, 10)$，所以 $f(A) = \\exp(A) = \\mathrm{diag}(\\exp(0), \\exp(10)) = \\begin{pmatrix} 1  0 \\\\ 0  \\exp(10) \\end{pmatrix}$。\n        *   在向量 $v$ 上的作用是：\n            $$f(A)v = \\begin{pmatrix} 1  0 \\\\ 0  \\exp(10) \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ \\exp(10) \\end{pmatrix}。$$\n        *   接下来，我们计算 $y_\\star$。如第1部分所示，$y_\\star$ 是 $(A - \\sigma I)y = v$ 的精确解。\n            $$y_{\\star} = (A - \\sigma I)^{-1}v = (A + I)^{-1}v。$$\n        *   我们已经计算出 $A + I = \\begin{pmatrix} 1  0 \\\\ 0  11 \\end{pmatrix}$。\n        *   它的逆是 $(A + I)^{-1} = \\begin{pmatrix} 1  0 \\\\ 0  \\frac{1}{11} \\end{pmatrix}$。\n        *   所以，$y_\\star$ 是：\n            $$y_{\\star} = \\begin{pmatrix} 1  0 \\\\ 0  \\frac{1}{11} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ \\frac{1}{11} \\end{pmatrix}。$$\n        *   $f(A)v$ 和 $y_\\star$ 之间的差值即为误差向量：\n            $$f(A)v - y_{\\star} = \\begin{pmatrix} 1 \\\\ \\exp(10) \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ \\frac{1}{11} \\end{pmatrix} = \\begin{pmatrix} 1 - 1 \\\\ \\exp(10) - \\frac{1}{11} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ \\exp(10) - \\frac{1}{11} \\end{pmatrix}。$$\n\n    *   **第3部分：计算欧几里得范数 `||f(A)v - y_star||_2`。**\n        *   误差向量 $e = f(A)v - y_{\\star}$ 的欧几里得范数由 $\\|e\\|_2 = \\sqrt{e_1^2 + e_2^2}$ 给出。\n        *   使用第2部分的误差向量：\n            $$\\|f(A)v - y_{\\star}\\|_{2} = \\left\\| \\begin{pmatrix} 0 \\\\ \\exp(10) - \\frac{1}{11} \\end{pmatrix} \\right\\|_{2} = \\sqrt{0^2 + \\left(\\exp(10) - \\frac{1}{11}\\right)^2}。$$\n        *   这可以简化为：\n            $$\\|f(A)v - y_{\\star}\\|_{2} = \\sqrt{\\left(\\exp(10) - \\frac{1}{11}\\right)^2} = \\left|\\exp(10) - \\frac{1}{11}\\right|。$$\n        *   由于 $e \\approx 2.718$，$\\exp(10)$ 是一个非常大的正数，远大于 $\\frac{1}{11}$。因此，绝对值内的项是正的。\n        *   因此，可以去掉绝对值，精确范数为：\n            $$\\|f(A)v - y_{\\star}\\|_{2} = \\exp(10) - \\frac{1}{11}。$$\n这样就完成了所需的计算。最终结果要求是闭式解析表达式。\n最终答案格式检查：使用了 `\\exp(10)`，使用了 `\\frac{1}{11}`，无单位，保持符号形式。", "answer": "$$\\boxed{\\exp(10) - \\frac{1}{11}}$$", "id": "3553843"}, {"introduction": "在实际应用中，我们常常利用已知的矩阵谱信息来提高计算效率。本练习 [@problem_id:3553903] 介绍了一种称为“收缩与增广”（deflation and augmentation）的实用高级技术。我们将学习如何将问题分解，对已知的（通常是简单的）不变子空间部分进行精确计算，同时仅在剩余的正交补空间上应用克里洛夫子空间方法，这种“分而治之”的策略是解决大规模问题的关键。", "problem": "考虑一个任务：以利用已知不变子空间的方式，近似计算一个矩阵函数在向量上的作用。设 $A \\in \\mathbb{R}^{4 \\times 4}$ 是对称矩阵 $A = \\operatorname{diag}(3,1,-2,4)$，其标准基特征向量为 $e_1, e_2, e_3, e_4 \\in \\mathbb{R}^4$。设矩阵函数为 $f(t) = \\exp(t)$，并考虑目标向量 $v \\in \\mathbb{R}^4$ 定义为\n$$\nv = 2\\,e_1 - e_3 + \\frac{1}{\\sqrt{2}}\\,(e_2 + e_4).\n$$\n假设您采用如下的降维与增广策略：您对不变子空间 $\\mathcal{U} = \\operatorname{span}\\{e_1, e_3\\}$ 进行降维，然后通过对 $\\mathcal{U}$ 的正交补执行一步多项式克雷洛夫子空间方法（由 Lanczos 过程生成，这是针对对称矩阵的专门化 Arnoldi 方法）来增广搜索空间，起始于残差 $r = (I - QQ^{\\top})\\,v$，其中 $Q = [e_1\\ \\ e_3] \\in \\mathbb{R}^{4 \\times 2}$，$I$ 是单位矩阵。假设在精确计算下进行。\n\n您的任务是，基于对称矩阵的谱定理，从第一性原理出发，推导出多项式克雷洛夫子空间 $\\mathcal{K}_m(A,r)$ 的定义，以及降维从 $\\mathcal{U}$ 中产生精确贡献，而用一步克雷洛夫子空间进行的增广则在正交补上提供投影近似这一思想。使用此方法构建在正交补上采用单步克雷洛夫方法的 $f(A)v$ 的增广克雷洛夫子空间近似 $y_{\\text{aug}}$。设 $u = e_2 + e_4$。\n\n计算标量 $s = u^{\\top} y_{\\text{aug}}$，并以精确形式的单个闭式解析表达式表示您的最终答案。无需四舍五入，不涉及单位。", "solution": "目标是计算标量 $s = u^{\\top} y_{\\text{aug}}$，其中 $y_{\\text{aug}}$ 是通过降维与增广策略获得的对 $f(A)v$ 的近似。函数为 $f(t) = \\exp(t)$，矩阵 $A = \\operatorname{diag}(3,1,-2,4)$ 是对称的，其特征值为 $\\lambda_1=3$, $\\lambda_2=1$, $\\lambda_3=-2$, $\\lambda_4=4$，对应的特征向量为标准基向量 $e_1, e_2, e_3, e_4$。目标向量为 $v = 2\\,e_1 - e_3 + \\frac{1}{\\sqrt{2}}\\,(e_2 + e_4)$。\n\n对于可对角化矩阵，计算矩阵函数在向量上的作用的核心原理基于谱定理。如果 $A$ 有一完备的特征向量集 $v_i$ 及相应的特征值 $\\lambda_i$，则任意向量 $v$ 可写为线性组合 $v = \\sum_i c_i v_i$。那么，$f(A)$ 在 $v$ 上的作用由 $f(A)v = \\sum_i c_i f(\\lambda_i) v_i$ 给出。\n\n问题指定了一种降维-增广策略。向量 $v$ 被分解为两个分量，一个位于不变子空间 $\\mathcal{U} = \\operatorname{span}\\{e_1, e_3\\}$ 中，另一个位于其正交补 $\\mathcal{U}^{\\perp}$ 中。设 $P_{\\mathcal{U}}$ 是到 $\\mathcal{U}$ 上的正交投影算子。由于 $\\mathcal{U}$ 的基由标准正交向量 $Q = [e_1 \\ e_3]$ 给出，该投影算子为 $P_{\\mathcal{U}} = QQ^{\\top}$。\n$v$ 在 $\\mathcal{U}$ 中的分量是 $v_{\\mathcal{U}} = P_{\\mathcal{U}}v = QQ^{\\top}v$。\n在 $\\mathcal{U}^{\\perp}$ 中的分量是 $v_{\\mathcal{U}^{\\perp}} = (I-P_{\\mathcal{U}})v = (I - QQ^{\\top})v$，这被定义为残差向量 $r$。\n因此，$v = v_{\\mathcal{U}} + r$。\n\n首先，我们计算这些分量。向量 $v$ 给出为 $v = 2e_1 + \\frac{1}{\\sqrt{2}}e_2 - e_3 + \\frac{1}{\\sqrt{2}}e_4$。\n在 $\\mathcal{U}$ 中的分量是：\n$$v_{\\mathcal{U}} = (e_1 e_1^{\\top} + e_3 e_3^{\\top})v = e_1(e_1^{\\top}v) + e_3(e_3^{\\top}v)$$\n使用 $v$ 的分量，我们有 $e_1^{\\top}v = 2$ 和 $e_3^{\\top}v = -1$。\n$$v_{\\mathcal{U}} = 2e_1 - e_3$$\n在 $\\mathcal{U}^{\\perp}$ 中的残差分量是：\n$$r = v - v_{\\mathcal{U}} = \\left(2e_1 - e_3 + \\frac{1}{\\sqrt{2}}(e_2 + e_4)\\right) - (2e_1 - e_3) = \\frac{1}{\\sqrt{2}}(e_2 + e_4)$$\n由于 $\\mathcal{U}$ 是 $A$ 下的不变子空间（因为它由特征向量张成），所以它在 $f(A)$ 下也是不变的。因此，$f(A)v = f(A)(v_{\\mathcal{U}} + r) = f(A)v_{\\mathcal{U}} + f(A)r$。\n\n该策略是精确计算来自 $\\mathcal{U}$ 的贡献，并近似计算来自 $\\mathcal{U}^{\\perp}$ 的贡献。\n精确部分是 $y_{\\mathcal{U}} = f(A)v_{\\mathcal{U}} = f(A)(2e_1 - e_3)$。利用谱性质 $f(A)e_i=f(\\lambda_i)e_i$：\n$$y_{\\mathcal{U}} = 2f(A)e_1 - f(A)e_3 = 2f(\\lambda_1)e_1 - f(\\lambda_3)e_3 = 2f(3)e_1 - f(-2)e_3 = 2\\exp(3)e_1 - \\exp(-2)e_3$$\n第二部分 $f(A)r$ 使用多项式克雷洛夫子空间方法（由于 $A$ 是对称的，使用 Lanczos 方法）的单步（$m=1$）进行近似。\n由 $A$ 和起始向量 $r$ 生成的 $m$ 阶多项式克雷洛夫子空间定义为 $\\mathcal{K}_m(A,r) = \\operatorname{span}\\{r, Ar, \\dots, A^{m-1}r\\}$。在此子空间中寻求对 $f(A)r$ 的近似。\nLanczos 方法为 $\\mathcal{K}_m(A,r)$ 构建一个标准正交基 $V_m = [v_1, \\dots, v_m]$ 和一个小的对称三对角矩阵 $H_m = V_m^{\\top}AV_m$。然后近似由 $y_r = \\beta V_m f(H_m) e_1^{(m)}$ 给出，其中 $\\beta = \\|r\\|_2$ 且 $v_1 = r/\\beta$，$e_1^{(m)}$ 是 $\\mathbb{R}^m$ 中的第一个标准基向量。\n\n对于单步（$m=1$），克雷洛夫子空间为 $\\mathcal{K}_1(A,r) = \\operatorname{span}\\{r\\}$。\n首先，我们对起始向量 $r$ 进行归一化：\n$$\\beta = \\|r\\|_2 = \\left\\|\\frac{1}{\\sqrt{2}}(e_2 + e_4)\\right\\|_2 = \\frac{1}{\\sqrt{2}} \\|e_2 + e_4\\|_2 = \\frac{1}{\\sqrt{2}}\\sqrt{1^2 + 1^2} = \\frac{\\sqrt{2}}{\\sqrt{2}} = 1$$\n由于 $\\|r\\|_2=1$，第一个基向量是 $v_1 = r = \\frac{1}{\\sqrt{2}}(e_2 + e_4)$。\n基矩阵为 $V_1 = [v_1]$。\n投影矩阵 $H_1$ 是一个 $1 \\times 1$ 矩阵（一个标量）：\n$$H_1 = V_1^{\\top} A V_1 = v_1^{\\top} A v_1$$\n我们计算 $Av_1$：\n$$Av_1 = A\\left(\\frac{1}{\\sqrt{2}}(e_2 + e_4)\\right) = \\frac{1}{\\sqrt{2}}(Ae_2 + Ae_4) = \\frac{1}{\\sqrt{2}}(\\lambda_2 e_2 + \\lambda_4 e_4) = \\frac{1}{\\sqrt{2}}(1 \\cdot e_2 + 4 \\cdot e_4)$$\n现在，我们计算 $H_1$：\n$$H_1 = v_1^{\\top}(Av_1) = \\left(\\frac{1}{\\sqrt{2}}(e_2 + e_4)\\right)^{\\top} \\left(\\frac{1}{\\sqrt{2}}(e_2 + 4e_4)\\right) = \\frac{1}{2}(e_2^{\\top}e_2 + 4e_2^{\\top}e_4 + e_4^{\\top}e_2 + 4e_4^{\\top}e_4)$$\n利用 $e_2$ 和 $e_4$ 的标准正交性 ($e_i^{\\top}e_j = \\delta_{ij}$)：\n$$H_1 = \\frac{1}{2}(1 + 0 + 0 + 4) = \\frac{5}{2}$$\n对于 $m=1$ 的近似 $y_r$ 是：\n$$y_r = \\beta V_1 f(H_1) e_1^{(1)}$$\n这里 $\\beta=1$，$V_1=[v_1]$，$f(H_1) = f(5/2) = \\exp(5/2)$，$e_1^{(1)}$ 是标量 $1$。\n$$y_r = 1 \\cdot v_1 \\cdot \\exp\\left(\\frac{5}{2}\\right) \\cdot 1 = \\exp\\left(\\frac{5}{2}\\right)v_1 = \\exp\\left(\\frac{5}{2}\\right)r$$\n代入 $r$ 的表达式：\n$$y_r = \\exp\\left(\\frac{5}{2}\\right) \\frac{1}{\\sqrt{2}}(e_2 + e_4)$$\n完整的增广近似 $y_{\\text{aug}}$ 是精确部分和近似部分之和：\n$$y_{\\text{aug}} = y_{\\mathcal{U}} + y_r = 2\\exp(3)e_1 - \\exp(-2)e_3 + \\frac{\\exp(5/2)}{\\sqrt{2}}(e_2 + e_4)$$\n最后，我们用 $u = e_2 + e_4$ 计算标量 $s = u^{\\top} y_{\\text{aug}}$。\n$$s = (e_2 + e_4)^{\\top} \\left( 2\\exp(3)e_1 - \\exp(-2)e_3 + \\frac{\\exp(5/2)}{\\sqrt{2}}(e_2 + e_4) \\right)$$\n由于标准基向量的正交性，涉及 $e_1$ 和 $e_3$ 的项消失：\n$$(e_2 + e_4)^{\\top}e_1 = 0 \\quad \\text{和} \\quad (e_2 + e_4)^{\\top}e_3 = 0$$\n表达式简化为：\n$$s = (e_2 + e_4)^{\\top} \\left(\\frac{\\exp(5/2)}{\\sqrt{2}}(e_2 + e_4)\\right) = \\frac{\\exp(5/2)}{\\sqrt{2}} (e_2 + e_4)^{\\top}(e_2 + e_4)$$\n剩下的内积是：\n$$(e_2 + e_4)^{\\top}(e_2 + e_4) = e_2^{\\top}e_2 + e_2^{\\top}e_4 + e_4^{\\top}e_2 + e_4^{\\top}e_4 = 1 + 0 + 0 + 1 = 2$$\n将此结果代回 $s$ 的表达式：\n$$s = \\frac{\\exp(5/2)}{\\sqrt{2}} \\cdot 2 = \\sqrt{2}\\exp\\left(\\frac{5}{2}\\right)$$\n这就是最终的闭式解析表达式。", "answer": "$$\\boxed{\\sqrt{2}\\exp\\left(\\frac{5}{2}\\right)}$$", "id": "3553903"}]}