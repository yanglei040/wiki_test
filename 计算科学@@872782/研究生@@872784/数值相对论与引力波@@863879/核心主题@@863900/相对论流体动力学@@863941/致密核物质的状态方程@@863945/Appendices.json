{"hands_on_practices": [{"introduction": "唯象物态方程是研究致密物质的有力工具。本练习将演示如何从一个简单的、有物理动机的声速假设出发，通过对基本热力学定律进行积分，推导出一个完整的正压物态方程 $P(n_B)$。这项实践揭示了物质的宏观性质（如压力和能量密度）与其内在热力学之间的直接联系。[@problem_id:3473683]", "problem": "在数值相对论中，为了模拟双中子星并合产生的引力波，通常需要一个用于描述致密核物质的冷、正压物态方程（EOS）。考虑在零温下的冷物质，其被建模为一种单组分重子流体，由重子数密度 $n_{B}$、压强 $P$、能量密度 $\\varepsilon$ 和重子化学势 $\\mu$ 来表征。相对论声速的平方定义为在固定组分下 $c_{s}^{2} = \\left(\\partial P / \\partial \\varepsilon\\right)$。对于冷物质，基本热力学恒等式意味着 $d\\varepsilon = \\mu \\, dn_{B}$ 和 $P = n_{B} \\mu - \\varepsilon$。假设微观因果性和稳定性成立，即 $0  c_{s}^{2}(n_{B})  1$。\n\n给定一个在 $n_{0}$ 处的低密度边界条件，其中 $P(n_{0}) = P_{0}$ 和 $\\varepsilon(n_{0}) = \\varepsilon_{0}$ 是已知的。边界处的重子化学势满足 $\\mu(n_{0}) = (\\varepsilon_{0} + P_{0}) / n_{0}$。\n\n选择声速剖面为常数，即 $c_{s}^{2}(n_{B}) = \\alpha$，其中 $0  \\alpha  1$。从上述基本定律和定义出发，通过从边界 $n_{0}$ 积分来构建与热力学一致的物态方程，以获得 $P(n_{B})$ 和 $\\varepsilon(n_{B})$。请将您的最终结果表示为压强 $P(n_{B})$ 关于 $n_{B}$、$n_{0}$、$\\alpha$、$P_{0}$ 和 $\\varepsilon_{0}$ 的单个闭合形式解析表达式。", "solution": "在尝试求解之前，需对问题陈述进行验证。\n\n**第一步：提取已知条件**\n-   **模型**：零温（$T=0$）下的冷、正压、单组分重子流体。\n-   **变量**：重子数密度 $n_{B}$、压强 $P$、能量密度 $\\varepsilon$、重子化学势 $\\mu$。\n-   **定义与恒等式**：\n    -   声速的平方：$c_{s}^{2} = \\left(\\frac{\\partial P}{\\partial \\varepsilon}\\right)$（在固定组分下）。\n    -   零温下的热力学第一定律：$d\\varepsilon = \\mu \\, dn_{B}$。\n    -   零温下的欧拉关系：$P = n_{B} \\mu - \\varepsilon$。\n-   **假设与约束**：\n    -   声速的平方是常数：$c_{s}^{2}(n_{B}) = \\alpha$，其中 $\\alpha$ 是一个常数。\n    -   因果性和稳定性约束：$0  \\alpha  1$。\n-   **边界条件**：\n    -   在参考密度 $n_{0}$ 处，压强为 $P(n_{0}) = P_{0}$，能量密度为 $\\varepsilon(n_{0}) = \\varepsilon_{0}$。\n    -   边界处的化学势由 $\\mu(n_{0}) = (\\varepsilon_{0} + P_{0}) / n_{0}$ 给出。这与在 $n_{0}$ 处求值的欧拉关系一致。\n-   **目标**：推导压强 $P(n_{B})$ 关于 $n_{B}$、$n_{0}$、$\\alpha$、$P_{0}$ 和 $\\varepsilon_{0}$ 的闭合形式解析表达式。\n\n**第二步：使用提取的已知条件进行验证**\n-   **科学依据**：该问题根植于应用于核天体物理学的热力学和流体动力学原理。这些热力学恒等式是零温相对论流体的标准形式。使用恒定声速虽然是一种简化，但是是唯象物态方程（EOS）的一种常见且有效的参数化方法。\n-   **适定性**：该问题提供了一个具有明确边界条件的微分关系系统。这种设定允许通过积分唯一确定函数 $P(n_{B})$ 和 $\\varepsilon(n_{B})$。\n-   **客观性**：问题以精确、形式化且无偏见的数学语言陈述。\n\n**第三步：结论与行动**\n经判定，该问题具有科学合理性、适定性和客观性。它不包含任何矛盾、歧义或无效的前提。因此，该问题是**有效的**，并将构建解答。\n\n**物态方程的推导**\n\n将首先建立重子化学势 $\\mu$ 作为重子数密度 $n_{B}$ 的函数的微分方程，从而推导出解。\n\n给定的基本热力学关系是：\n1.  $d\\varepsilon = \\mu \\, dn_{B}$\n2.  $P = n_{B}\\mu - \\varepsilon$\n3.  具体的假设是 $\\frac{dP}{d\\varepsilon} = \\alpha$，其中 $\\alpha$ 是一个常数。\n\n根据关系式 (1)，我们可以写出关于 $n_{B}$ 的导数：\n$$\n\\frac{d\\varepsilon}{dn_{B}} = \\mu\n$$\n使用链式法则，压强对重子数密度的导数为：\n$$\n\\frac{dP}{dn_{B}} = \\frac{dP}{d\\varepsilon} \\frac{d\\varepsilon}{dn_{B}}\n$$\n代入给定的关系式，我们得到：\n$$\n\\frac{dP}{dn_{B}} = \\alpha \\mu\n$$\n现在，对欧拉关系 (2)，$P = n_{B}\\mu - \\varepsilon$，关于 $n_{B}$ 求导：\n$$\n\\frac{dP}{dn_{B}} = \\frac{d}{dn_{B}}(n_{B}\\mu) - \\frac{d\\varepsilon}{dn_{B}}\n$$\n对右边的第一项使用乘积法则：\n$$\n\\frac{dP}{dn_{B}} = \\mu + n_{B}\\frac{d\\mu}{dn_{B}} - \\frac{d\\varepsilon}{dn_{B}}\n$$\n现在我们可以将先前建立的 $\\frac{dP}{dn_{B}}$ 和 $\\frac{d\\varepsilon}{dn_{B}}$ 的表达式代入此方程：\n$$\n\\alpha \\mu = \\mu + n_{B}\\frac{d\\mu}{dn_{B}} - \\mu\n$$\n简化后得到：\n$$\n\\alpha \\mu = n_{B}\\frac{d\\mu}{dn_{B}}\n$$\n这是一个关于 $\\mu(n_{B})$ 的一阶可分离常微分方程。我们可以将其整理为：\n$$\n\\frac{d\\mu}{\\mu} = \\alpha \\frac{dn_{B}}{n_{B}}\n$$\n对两边积分得到：\n$$\n\\int \\frac{d\\mu}{\\mu} = \\int \\alpha \\frac{dn_{B}}{n_{B}}\n$$\n$$\n\\ln(\\mu) = \\alpha \\ln(n_{B}) + C_{1}\n$$\n其中 $C_{1}$ 是积分常数。我们可以令 $C_{1} = \\ln(K)$，其中 $K$ 是一个新的常数。\n$$\n\\ln(\\mu) = \\ln(n_{B}^{\\alpha}) + \\ln(K) = \\ln(K n_{B}^{\\alpha})\n$$\n对两边取指数，得到化学势的通解：\n$$\n\\mu(n_{B}) = K n_{B}^{\\alpha}\n$$\n为了确定常数 $K$，我们应用在 $n_{B}=n_{0}$ 处的边界条件。问题陈述了 $\\mu(n_{0}) = (\\varepsilon_{0} + P_{0})/n_{0}$。\n$$\n\\mu(n_{0}) = K n_{0}^{\\alpha} \\implies K = \\frac{\\mu(n_{0})}{n_{0}^{\\alpha}} = \\frac{\\varepsilon_{0} + P_{0}}{n_{0} \\cdot n_{0}^{\\alpha}} = \\frac{\\varepsilon_{0} + P_{0}}{n_{0}^{1+\\alpha}}\n$$\n将 $K$ 代回 $\\mu(n_{B})$ 的表达式得到：\n$$\n\\mu(n_{B}) = \\left(\\frac{\\varepsilon_{0} + P_{0}}{n_{0}^{1+\\alpha}}\\right) n_{B}^{\\alpha}\n$$\n现在我们可以通过积分关系式 $\\frac{dP}{dn_{B}} = \\alpha \\mu(n_{B})$ 来求出压强 $P(n_{B})$。\n$$\ndP = \\alpha \\mu(n_{B}) \\, dn_{B}\n$$\n我们从边界 $n_{0}$ 积分到一个任意密度 $n_{B}$：\n$$\n\\int_{P_{0}}^{P(n_{B})} dP' = \\int_{n_{0}}^{n_{B}} \\alpha \\mu(n_{B}') \\, dn_{B}'\n$$\n$$\nP(n_{B}) - P_{0} = \\int_{n_{0}}^{n_{B}} \\alpha \\left(\\frac{\\varepsilon_{0} + P_{0}}{n_{0}^{1+\\alpha}}\\right) (n_{B}')^{\\alpha} \\, dn_{B}'\n$$\n常数项可以移到积分号外面：\n$$\nP(n_{B}) - P_{0} = \\alpha \\left(\\frac{\\varepsilon_{0} + P_{0}}{n_{0}^{1+\\alpha}}\\right) \\int_{n_{0}}^{n_{B}} (n_{B}')^{\\alpha} \\, dn_{B}'\n$$\n进行积分：\n$$\nP(n_{B}) - P_{0} = \\alpha \\left(\\frac{\\varepsilon_{0} + P_{0}}{n_{0}^{1+\\alpha}}\\right) \\left[ \\frac{(n_{B}')^{\\alpha+1}}{\\alpha+1} \\right]_{n_{0}}^{n_{B}}\n$$\n$$\nP(n_{B}) - P_{0} = \\frac{\\alpha(\\varepsilon_{0} + P_{0})}{(1+\\alpha)n_{0}^{1+\\alpha}} \\left( n_{B}^{1+\\alpha} - n_{0}^{1+\\alpha} \\right)\n$$\n重新整理各项以分离出 $P(n_{B})$ 并提出因子 $n_{0}^{1+\\alpha}$：\n$$\nP(n_{B}) = P_{0} + \\frac{\\alpha(\\varepsilon_{0} + P_{0})}{1+\\alpha} \\left( \\frac{n_{B}^{1+\\alpha}}{n_{0}^{1+\\alpha}} - \\frac{n_{0}^{1+\\alpha}}{n_{0}^{1+\\alpha}} \\right)\n$$\n这就得到了压强作为重子数密度函数的最终闭合形式表达式：\n$$\nP(n_{B}) = P_{0} + \\frac{\\alpha(\\varepsilon_{0} + P_{0})}{1+\\alpha} \\left[ \\left(\\frac{n_{B}}{n_{0}}\\right)^{1+\\alpha} - 1 \\right]\n$$\n该表达式仅依赖于问题陈述中指定的变量，因此满足了目标。", "answer": "$$\n\\boxed{P(n_B) = P_{0} + \\frac{\\alpha(\\varepsilon_{0} + P_{0})}{1+\\alpha} \\left[ \\left(\\frac{n_{B}}{n_{0}}\\right)^{1+\\alpha} - 1 \\right]}\n$$", "id": "3473683"}, {"introduction": "真实的中子星物质并非单一组分的流体，而是在化学平衡状态下的电中性粒子混合物。本练习涉及核天体物理学中的一项核心任务：通过平衡核力与轻子压力，计算求解质子份额 $Y_p$，其中还包括了μ子生成的重要阈值效应。这项实践将让你亲手体验构建真实物态方程背后的微观物理过程。[@problem_id:3473660]", "problem": "考虑由一个将重子与处于β平衡的轻子耦合的最小微观物理模型所描述的冷、催化中子星物质。重子数密度表示为 $n_B$，质子分数表示为 $Y_p = n_p/n_B$，其中 $n_p$ 是质子数密度，$n_n$ 是中子数密度。假设以下基本定律和定义成立：\n\n- 无被俘获中微子的β平衡要求 $ \\mu_n = \\mu_p + \\mu_e $，并且当μ子存在时，$ \\mu_e = \\mu_\\mu $。\n- 电荷中性要求 $ n_p = n_e + n_\\mu $。\n- 重子数守恒意味着 $ n_B = n_n + n_p $。\n- 对于核子，采用广泛使用的抛物线近似来处理中子和质子化学势之差中的核对称能，\n$$\n\\mu_n - \\mu_p \\approx 4\\, S(n_B)\\, \\left(1 - 2 Y_p \\right),\n$$\n其对称能具有幂律形式的密度依赖关系\n$$\nS(n_B) = S_0 \\left( \\frac{n_B}{n_0} \\right)^\\gamma,\n$$\n其中 $S_0 = 32\\,\\mathrm{MeV}$，$n_0 = 0.16\\,\\mathrm{fm}^{-3}$，且 $\\gamma = 0.6$。\n- 电子和μ子被建模为零温相对论性费米气体。它们的化学势作为数密度 $n_\\ell$ 的函数是\n$$\n\\mu_\\ell(n_\\ell) = \\sqrt{ \\left(m_\\ell c^2\\right)^2 + \\left(\\hbar c\\, (3\\pi^2 n_\\ell)^{1/3}\\right)^2 },\n$$\n对于 $\\ell \\in \\{e,\\mu\\}$，其中 $m_e c^2 = 0.51099895\\,\\mathrm{MeV}$ 且 $m_\\mu c^2 = 105.6583755\\,\\mathrm{MeV}$。使用 $\\hbar c = 197.3269804\\,\\mathrm{MeV\\,fm}$。需要时通过以下方式反转此关系\n$$\nn_\\ell(\\mu) =\n\\begin{cases}\n0,  \\mu  m_\\ell c^2 \\\\\n\\dfrac{1}{3\\pi^2}\\left(\\dfrac{\\sqrt{\\mu^2 - (m_\\ell c^2)^2}}{\\hbar c}\\right)^3,  \\mu \\ge m_\\ell c^2\n\\end{cases}\n$$\n\n物质的组分是通过同时满足β平衡和电荷中性条件以及定义 $n_p = Y_p n_B$ 来确定的。当电子化学势达到μ子静止能量阈值时，即 $\\mu_e \\ge m_\\mu c^2$ 时，μ子会出现。在阈值以下，$n_\\mu = 0$ 且 $n_e = n_p$；在阈值以上，$\\mu_e = \\mu_\\mu \\equiv \\mu_\\ell$ 且 $n_e(\\mu_\\ell) + n_\\mu(\\mu_\\ell) = n_p$。\n\n你的任务是构建一个程序，对于每个指定的 $n_B$，求解满足以下条件的唯一质子分数 $Y_p(n_B)$\n$$\n4\\, S(n_B)\\, \\left(1 - 2 Y_p \\right) = \n\\begin{cases}\n\\mu_e\\big(n_e = n_p\\big),  \\text{if } \\mu_e\\big(n_e = n_p\\big)  m_\\mu c^2 \\\\[6pt]\n\\mu_\\ell \\text{ such that } n_e(\\mu_\\ell) + n_\\mu(\\mu_\\ell) = n_p,  \\text{if } \\mu_e\\big(n_e = n_p\\big) \\ge m_\\mu c^2\n\\end{cases}\n$$\n其中 $n_p = Y_p n_B$，并且所有量都用上述单位表示。解的存在性和唯一性应通过算法设计中的单调性论证来证明，并且数值方法应在阈值区域内保持鲁棒性。\n\n全程使用的数值和物理单位：\n- 数密度 $n_B$、$n_p$、$n_e$、$n_\\mu$ 必须以 $\\mathrm{fm}^{-3}$ 为单位。\n- 能量 $\\mu_e$、$\\mu_\\mu$、$S(n_B)$、$m_\\ell c^2$ 和 $\\hbar c$ 必须以 $\\mathrm{MeV}$ 为单位。\n- 质子分数 $Y_p$ 是无量纲的，并且必须以十进制数输出。\n\n测试组：\n计算以下五个重子密度（单位为 $\\mathrm{fm}^{-3}$）的 $Y_p(n_B)$：\n- $n_B = 1.0\\times 10^{-4}$，\n- $n_B = 2.0\\times 10^{-2}$，\n- $n_B = 1.6\\times 10^{-1}$，\n- $n_B = 4.8\\times 10^{-1}$，\n- $n_B = 1.0$。\n\n这些案例旨在探测低密度纯电子物质、接近μ子阈值的情况、近饱和密度以及远超阈值的行为。\n\n最终输出格式：\n你的程序应该生成单行输出，其中包含五个结果，以逗号分隔并用方括号括起来，每个 $Y_p$ 四舍五入到六位小数，例如 $[0.001234,0.012345,0.034567,0.056789,0.078901]$。", "solution": "### 步骤 1：提取已知条件\n该问题为模拟冷、催化中子星物质提供了以下数据、定义和关系：\n\n**基本原理和定义：**\n- β平衡（无被俘获的中微子）：$ \\mu_n = \\mu_p + \\mu_e $\n- μ子平衡（存在时）：$ \\mu_e = \\mu_\\mu $\n- 电荷中性：$ n_p = n_e + n_\\mu $\n- 重子数守恒：$ n_B = n_n + n_p $\n- 质子分数定义：$ Y_p = n_p/n_B $\n\n**组分模型（状态方程）：**\n- 核子化学势之差（抛物线近似）：\n$$\n\\mu_n - \\mu_p \\approx 4\\, S(n_B)\\, \\left(1 - 2 Y_p \\right)\n$$\n- 对称能密度依赖关系：\n$$\nS(n_B) = S_0 \\left( \\frac{n_B}{n_0} \\right)^\\gamma\n$$\n- 轻子化学势（相对论性费米气体）：\n$$\n\\mu_\\ell(n_\\ell) = \\sqrt{ \\left(m_\\ell c^2\\right)^2 + \\left(\\hbar c\\, (3\\pi^2 n_\\ell)^{1/3}\\right)^2 }, \\quad \\ell \\in \\{e,\\mu\\}\n$$\n- 轻子数密度的逆关系：\n$$\nn_\\ell(\\mu) =\n\\begin{cases}\n0,  \\mu  m_\\ell c^2 \\\\\n\\dfrac{1}{3\\pi^2}\\left(\\dfrac{\\sqrt{\\mu^2 - (m_\\ell c^2)^2}}{\\hbar c}\\right)^3,  \\mu \\ge m_\\ell c^2\n\\end{cases}\n$$\n\n**物理和数值常数：**\n- 饱和密度下的对称能：$S_0 = 32\\,\\mathrm{MeV}$\n- 核饱和密度：$n_0 = 0.16\\,\\mathrm{fm}^{-3}$\n- 对称能幂律指数：$\\gamma = 0.6$\n- 电子静止能量：$m_e c^2 = 0.51099895\\,\\mathrm{MeV}$\n- μ子静止能量：$m_\\mu c^2 = 105.6583755\\,\\mathrm{MeV}$\n- 约化普朗克常数乘以光速：$\\hbar c = 197.3269804\\,\\mathrm{MeV\\,fm}$\n\n**任务：**\n对于给定的重子数密度 $n_B$，求解满足平衡条件的质子分数 $Y_p$：\n$$\n4\\, S(n_B)\\, \\left(1 - 2 Y_p \\right) = \n\\begin{cases}\n\\mu_e\\big(n_e = n_p\\big),  \\text{if } \\mu_e\\big(n_e = n_p\\big)  m_\\mu c^2 \\\\[6pt]\n\\mu_\\ell \\text{ such that } n_e(\\mu_\\ell) + n_\\mu(\\mu_\\ell) = n_p,  \\text{if } \\mu_e\\big(n_e = n_p\\big) \\ge m_\\mu c^2\n\\end{cases}\n$$\n其中 $n_p = Y_p n_B$。\n\n**测试组：**\n- $n_B = 1.0\\times 10^{-4}\\,\\mathrm{fm}^{-3}$\n- $n_B = 2.0\\times 10^{-2}\\,\\mathrm{fm}^{-3}$\n- $n_B = 1.6\\times 10^{-1}\\,\\mathrm{fm}^{-3}$\n- $n_B = 4.8\\times 10^{-1}\\,\\mathrm{fm}^{-3}$\n- $n_B = 1.0\\,\\mathrm{fm}^{-3}$\n\n### 步骤 2：使用提取的已知条件进行验证\n对问题进行严格的验证程序。\n\n- **科学基础（关键）：** 该问题描述了一种最简单但标准的模型，用于描述处于β平衡状态的冷、稠密核物质（通常称为npeμ物质）。β平衡、电荷中性、对称能的抛物线近似以及轻子的相对论性费米气体模型等方程，都是核天体物理学和中子星理论的基石。物理常数（$m_e c^2$、$m_\\mu c^2$、$\\hbar c$）和核物理参数（$S_0$、$n_0$、$\\gamma$）的数值都是文献中广泛使用的标准值。该模型在其适用领域内是科学合理且事实正确的。\n- **良态的：** 该问题要求在给定参数 $n_B$ 的情况下，求解变量 $Y_p$ 的一个超越方程的根。为评估其是否为良态问题，我们分析所涉及函数的单调性。设方程为 $L(Y_p) = R(Y_p)$。\n    - 对于任意固定的 $n_B > 0$，左侧 $L(Y_p) = 4 S(n_B)(1 - 2Y_p)$ 是一个关于 $Y_p$ 的线性和严格递减函数。\n    - 右侧 $R(Y_p)$ 代表平衡状态下的轻子化学势。\n        - 在无μ子的情况下，$R(Y_p) = \\mu_e(n_p) = \\mu_e(Y_p n_B)$。由于 $\\mu_e(n_e)$ 是 $n_e$ 的严格递增函数，而 $n_p$ 是 $Y_p$ 的线性递增函数，因此 $R(Y_p)$ 是严格递增的。\n        - 在有μ子的情况下，$R(Y_p)$ 是满足 $n_e(\\mu_\\ell) + n_\\mu(\\mu_\\ell) = Y_p n_B$ 的值 $\\mu_\\ell$。函数 $N(\\mu_\\ell) = n_e(\\mu_\\ell) + n_\\mu(\\mu_\\ell)$ 是 $\\mu_\\ell$ 的严格递增函数。因此，其反函数 $\\mu_\\ell = N^{-1}(Y_p n_B)$ 是其自变量 $Y_p n_B$ 的严格递增函数。因此，在这种情况下 $R(Y_p)$ 也是严格递增的。\n    - 因此，我们是在寻找一个严格递减函数和一个严格递增函数的交点。这样的交点如果存在，则是唯一的。根据介值定理，在物理域 $Y_p \\in [0, 1]$ 内解的存在性是有保证的，因为 $L(0) > R(0)$ （对于相关密度）且 $L(0.5) = 0$ 而 $R(0.5) > 0$，这意味着 $L(0.5)  R(0.5)$。因此，在 $Y_p \\in (0, 0.5)$ 内存在唯一解。该问题是良态的。\n- **客观性（关键）：** 问题以精确、定量、客观的科学语言陈述。所有术语都有正式定义。没有主观或基于意见的成分。\n- **无其他缺陷：** 问题是自洽的，提供了所有必要的方程和常数。它不是隐喻性的、琐碎的或矛盾的。单位是一致且明确的。\n\n### 步骤 3：结论与行动\n该问题是**有效的**。它是一个计算核天体物理学中良态的、有科学依据的问题。将提供完整的解决方案。\n\n### 求解方法论\n\n问题的核心是找到在给定的重子数密度 $n_B$ 下建立β平衡的质子分数 $Y_p$。这通过求解一个超越方程来实现，该方程将由核力驱动的中子和质子之间的化学势差，与由电磁和量子统计决定的轻子化学势相等同。\n\n**1. 控制方程及求根的重构**\n结合β平衡的条件（$\\mu_n - \\mu_p = \\mu_e$）和所提供的模型，我们得到需要为 $Y_p$ 求解的核心方程：\n$$\n4 S(n_B)(1 - 2 Y_p) = \\mu_{\\text{lepton}}\n$$\n其中 $\\mu_{\\text{lepton}}$ 是带电轻子（电子，可能还有μ子）的平衡化学势。为了数值求解，我们将其重构为一个求根问题。我们定义一个残差函数 $f(Y_p; n_B)$，使其根对应于解：\n$$\nf(Y_p; n_B) = 4 S(n_B)(1 - 2Y_p) - \\mu_{\\text{lepton}}(Y_p, n_B) = 0\n$$\n正如在验证中所确立的，对于任意固定的 $n_B > 0$，此函数关于 $Y_p$ 是严格单调的，这保证了存在唯一的根，并且可以用标准的数值算法高效地找到。\n\n**2. 算法设计**\n算法通过遍历每个指定的重子密度 $n_B$ 并求解相应的 $Y_p$ 来进行。对于每个 $n_B$，算法的核心是一个数值求根器。我们采用以鲁棒性和效率著称的Brent方法，因为它结合了二分法保证收敛的特性和插值法的速度。\n\n关键在于残差函数 $f(Y_p; n_B)$ 的实现，该函数必须正确评估轻子化学势 $\\mu_{\\text{lepton}}$。此评估取决于条件是否适合μ子的产生。\n\n**3. 轻子化学势 $\\mu_{\\text{lepton}}$ 的评估**\n对于给定的 $Y_p$ 试验值和指定的 $n_B$，质子密度为 $n_p = Y_p n_B$。电荷中性条件为 $n_p = n_e + n_\\mu$。\n\n- **步骤 3a：阈值检查。** 我们首先确定μ子是否存在。只有当电子化学势 $\\mu_e$ 达到μ子静止质量能量 $m_\\mu c^2 \\approx 105.7\\,\\mathrm{MeV}$ 时，μ子才会出现。我们通过计算一个假设的电子化学势 $\\mu_e^{\\text{hyp}}$ 来测试这一点，假设所有负电荷都由电子携带（即 $n_e = n_p$ 和 $n_\\mu=0$）：\n$$\n\\mu_e^{\\text{hyp}} = \\mu_e(n_e=n_p) = \\sqrt{(m_e c^2)^2 + (\\hbar c (3\\pi^2 n_p)^{1/3})^2}\n$$\n\n- **步骤 3b：情况 1 - 无μ子区域 ($\\mu_e^{\\text{hyp}}  m_\\mu c^2$)。** 如果假设的化学势低于μ子阈值，则我们的假设是正确的。μ子不存在（$n_\\mu=0$），系统由中子、质子和电子组成（npe物质）。平衡轻子化学势就是这个假设值：\n$$\n\\mu_{\\text{lepton}} = \\mu_e^{\\text{hyp}}\n$$\n\n- **步骤 3c：情况 2 - 有μ子区域 ($\\mu_e^{\\text{hyp}} \\ge m_\\mu c^2$)。** 如果假设的化学势达到或超过阈值，则必须存在μ子才能建立平衡（npeμ物质）。电子和μ子共享一个共同的化学势，$\\mu_e = \\mu_\\mu \\equiv \\mu_\\ell$。这个共同的化学势 $\\mu_\\ell$ 是满足电荷中性条件的值，该条件包含了两种轻子的贡献：\n$$\nn_p = n_e(\\mu_\\ell) + n_\\mu(\\mu_\\ell)\n$$\n这个关于 $\\mu_\\ell$ 的方程本身就是一个必须求解的超越方程。我们为此子问题定义第二个残差函数 $g(\\mu_\\ell)$：\n$$\ng(\\mu_\\ell) = n_e(\\mu_\\ell) + n_\\mu(\\mu_\\ell) - n_p = 0\n$$\n函数 $g(\\mu_\\ell)$ 对于 $\\mu_\\ell \\ge m_\\mu c^2$ 是严格递增的。根保证存在于区间 $[m_\\mu c^2, \\mu_e^{\\text{hyp}}]$ 内。我们再次使用Brent方法来找到此区间内的唯一根 $\\mu_\\ell$。这个解出的值成为主问题的平衡轻子势：\n$$\n\\mu_{\\text{lepton}} = \\mu_\\ell\n$$\n\n**4. $Y_p$ 的数值解**\n有了一个可以为任何有效的 $Y_p$ 评估残差函数 $f(Y_p; n_B)$ 的完整方法，我们应用Brent方法来找到它的根。对 $Y_p$ 的搜索被限制在区间 $[10^{-9}, 0.5]$ 内。下界是一个小的正数，以避免在 $Y_p=0$ 处的数值问题。上界是 $0.5$，因为对于 $Y_p > 0.5$，左侧的 $4 S(n_B)(1 - 2Y_p)$ 变为负数，而右侧（一个化学势）总是正数，使得解不可能存在。\n\n这种嵌套求根方法提供了一种鲁棒且精确的方法，可以在无μ子和有μ子两种区域内，为任何给定的重子密度 $n_B$ 确定平衡组分 $Y_p$。最终的Python实现封装了这一逻辑，使用 `scipy.optimize.brentq` 来完成外部（$Y_p$）和内部（$\\mu_\\ell$）的求根任务。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves for the proton fraction Yp in beta-equilibrated neutron star matter\n    for a given set of baryon number densities.\n    \"\"\"\n\n    #\n    # Step 1: Define physical constants and model parameters\n    # All units are in MeV and fm.\n    #\n\n    # Nuclear physics parameters for the symmetry energy\n    S0 = 32.0          # MeV, symmetry energy at saturation\n    N0 = 0.16          # fm^-3, nuclear saturation density\n    GAMMA = 0.6        # unitless, power-law index for S(n_B)\n\n    # Fundamental constants\n    M_E_C2 = 0.51099895   # MeV, electron rest energy\n    M_MU_C2 = 105.6583755 # MeV, muon rest energy\n    HBAR_C = 197.3269804   # MeV fm\n\n    #\n    # Step 2: Implement the physical model equations as functions\n    #\n\n    def S_func(n_b: float) - float:\n        \"\"\"Calculates the nuclear symmetry energy S as a function of baryon density n_B.\"\"\"\n        return S0 * (n_b / N0)**GAMMA\n\n    def mu_lepton_from_density(n_l: float, m_l_c2: float) - float:\n        \"\"\"\n        Calculates lepton chemical potential from its number density for a relativistic Fermi gas.\n        \"\"\"\n        if n_l = 0:\n            return m_l_c2\n        # Expression: sqrt( (m*c^2)^2 + (hbar*c * k_F)^2 ), where k_F = (3*pi^2*n)^(1/3)\n        kf_term = HBAR_C * (3 * np.pi**2 * n_l)**(1/3)\n        return np.sqrt(m_l_c2**2 + kf_term**2)\n\n    def n_lepton_from_mu(mu: float, m_l_c2: float) - float:\n        \"\"\"\n        Calculates lepton number density from its chemical potential (inverse of the above).\n        \"\"\"\n        if mu  m_l_c2:\n            return 0.0\n        # Expression: (k_F^3) / (3*pi^2), where k_F = sqrt(mu^2 - (m*c^2)^2) / (hbar*c)\n        kf3 = (np.sqrt(mu**2 - m_l_c2**2) / HBAR_C)**3\n        return kf3 / (3 * np.pi**2)\n\n    def equilibrium_residual(y_p: float, n_b: float) - float:\n        \"\"\"\n        The residual function f(Y_p) = LHS - RHS = 0 that we need to solve.\n        LHS = 4 * S(n_B) * (1 - 2*Y_p)\n        RHS = mu_lepton (which depends on Y_p and n_B)\n        \"\"\"\n        # Ensure y_p is strictly positive to avoid division by zero or log of zero issues downstream\n        # if other models were used. For this model, it's just good practice.\n        if y_p = 0:\n            y_p = 1e-15\n\n        # Left-hand side (from nuclear forces)\n        lhs = 4 * S_func(n_b) * (1 - 2 * y_p)\n\n        # Right-hand side (from lepton equilibrium)\n        n_p = y_p * n_b\n\n        # First, calculate hypothetical mu_e assuming no muons (n_e = n_p)\n        # to check if we are above the muon creation threshold.\n        mu_e_hypothetical = mu_lepton_from_density(n_p, M_E_C2)\n\n        if mu_e_hypothetical  M_MU_C2:\n            # Case 1: Muon-free regime.\n            # The lepton chemical potential is simply mu_e_hypothetical.\n            rhs = mu_e_hypothetical\n        else:\n            # Case 2: Muons are present.\n            # We must find the common chemical potential mu_l such that\n            # charge neutrality n_p = n_e(mu_l) + n_mu(mu_l) is satisfied.\n            # This requires solving another root-finding problem for mu_l.\n            \n            def charge_neutrality_residual(mu_l: float, n_p_target: float) - float:\n                \"\"\"Residual for the inner root-finder to find mu_l.\"\"\"\n                return n_lepton_from_mu(mu_l, M_E_C2) + n_lepton_from_mu(mu_l, M_MU_C2) - n_p_target\n\n            # The root mu_l is bracketed by [M_MU_C2, mu_e_hypothetical].\n            # At mu_l=M_MU_C2, n_mu=0 and n_e  n_p, so residual  0.\n            # At mu_l=mu_e_hypothetical, n_e=n_p and n_mu>0, so residual > 0.\n            try:\n                mu_l_equilibrium = brentq(\n                    charge_neutrality_residual,\n                    a=M_MU_C2,\n                    b=mu_e_hypothetical,\n                    args=(n_p,),\n                    xtol=1e-12, rtol=1e-12\n                )\n            except ValueError:\n                 # This can happen if the bracket endpoints do not have opposite signs,\n                 # which indicates an issue with the model or a very narrow range.\n                 # Let's ensure the upper bound is strictly larger.\n                 mu_l_equilibrium = brentq(\n                    charge_neutrality_residual,\n                    a=M_MU_C2,\n                    b=mu_e_hypothetical * (1 + 1e-9), # Widen bracket slightly\n                    args=(n_p,),\n                    xtol=1e-12, rtol=1e-12\n                )\n\n            rhs = mu_l_equilibrium\n\n        return lhs - rhs\n\n    #\n    # Step 3: Define the test cases and solve for each\n    #\n    test_cases = [1.0e-4, 2.0e-2, 1.6e-1, 4.8e-1, 1.0]\n\n    results = []\n    # Set up bracketing for Y_p. The solution must be in (0, 0.5).\n    # At Y_p -> 0, f > 0. At Y_p = 0.5, LHS = 0 and RHS > 0, so f  0.\n    y_p_bracket_min = 1e-9\n    y_p_bracket_max = 0.5 - 1e-9\n\n    for n_b_val in test_cases:\n        y_p_solution = brentq(\n            equilibrium_residual,\n            a=y_p_bracket_min,\n            b=y_p_bracket_max,\n            args=(n_b_val,),\n            xtol=1e-12, rtol=1e-12\n        )\n        results.append(f\"{y_p_solution:.6f}\")\n\n    #\n    # Step 4: Print the final output in the required format\n    #\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3473660"}, {"introduction": "对于复杂的现实模型，物态方程通常以大型数据表的形式提供给数值模拟使用。本练习旨在解决一个关键的实际问题：确保这些数据表在热力学上是自洽的。通过数值方法检验一个基本的麦克斯韦关系，你将学会如何诊断物态方程表中可能存在的缺陷，这些缺陷可能会影响大规模流体动力学模拟的准确性和稳定性。[@problem_id:3473643]", "problem": "给定与广义相对论流体动力学 (GRHD) 相关的稠密核物质的状态方程 (EoS) 表格数据。每个 EoS 表格在相同的 $(T,\\mu)$ 网格上提供了作为温度 $T$ 和重子化学势 $\\mu$ 函数的压强 $p$，以及熵密度 $s(T,\\mu)$。在相对论热力学中，吉布斯-杜亥姆关系意味着热力学恒等式 $dp = s\\,dT + n\\,d\\mu$，其中 $n$ 是重子数密度。因此，在固定的化学势 $\\mu$ 下，有 $\\left(\\partial p/\\partial T\\right)_{\\mu} = s$。您的任务有两部分：首先，在给定的网格上数值检验此恒等式的符合性；其次，量化对此恒等式的违反如何影响在固定 $\\mu$ 下，用于微小温度微扰的压强变化的一阶守恒预测子的精度，该预测子常用于数值相对论的守恒格式中预测通量。\n\n请使用以下步骤和定义：\n- EoS 表格定义在均匀网格 $T_i$ 和 $\\mu_j$ 上，其中 $i=0,\\dots,N_T-1$ 且 $j=0,\\dots,N_\\mu-1$。对于每个 $(T_i,\\mu_j)$，表格给出 $p_{ij} = p(T_i,\\mu_j)$ 和 $s_{ij} = s(T_i,\\mu_j)$。\n- 在网格上使用二阶中心差分（对于内部索引）和一阶单边差分（在边界处）来数值近似偏导数 $\\left(\\partial p/\\partial T\\right)_{\\mu}$：\n  - 对于 $1 \\le i \\le N_T-2$：$\\left(\\partial p/\\partial T\\right)_{\\mu}(T_i,\\mu_j) \\approx \\dfrac{p_{i+1,j}-p_{i-1,j}}{T_{i+1}-T_{i-1}}$。\n  - 对于 $i=0$：$\\left(\\partial p/\\partial T\\right)_{\\mu}(T_0,\\mu_j) \\approx \\dfrac{p_{1,j}-p_{0,j}}{T_{1}-T_{0}}$。\n  - 对于 $i=N_T-1$：$\\left(\\partial p/\\partial T\\right)_{\\mu}(T_{N_T-1},\\mu_j) \\approx \\dfrac{p_{N_T-1,j}-p_{N_T-2,j}}{T_{N_T-1}-T_{N_T-2}}$。\n- 定义恒等式偏差场 $\\Delta_{ij} = \\left(\\partial p/\\partial T\\right)_{\\mu}(T_i,\\mu_j) - s_{ij}$。\n\n为量化其对一阶守恒预测子的影响，考虑在固定 $\\mu$ 下的微小温度更新：\n- 预测子使用 $s_{ij}$ 估算给定温度增量 $\\Delta T$ 的压强增量 $\\Delta p_{\\text{pred}}(T_i,\\mu_j;\\Delta T) = s_{ij}\\,\\Delta T$。\n- 真实的表格压强变化是 $\\Delta p_{\\text{true}}(T_i,\\mu_j;\\Delta T) = p(T_i+\\Delta T,\\mu_j) - p(T_i,\\mu_j)$，这是根据给定 $(T,\\mu)$ 处 $p$ 的表格函数形式计算的。\n- 定义在 $(T_i,\\mu_j)$ 处的相对预测误差为 $R_{ij}(\\Delta T) = \\dfrac{\\left|\\Delta p_{\\text{pred}} - \\Delta p_{\\text{true}}\\right|}{\\max\\left(\\epsilon, \\left|\\Delta p_{\\text{true}}\\right|\\right)}$，其中 $\\epsilon = 10^{-12}$ 以避免除以零。\n\n所有量均使用自然单位制处理，玻尔兹曼常数等于一。请使用以下单位：\n- 压强 $p$：兆电子伏特每立方费米 ($\\text{MeV}/\\text{fm}^3$)。\n- 温度 $T$：兆电子伏特 ($\\text{MeV}$)。\n- 化学势 $\\mu$：兆电子伏特 ($\\text{MeV}$)。\n- 熵密度 $s$：每立方费米 ($1/\\text{fm}^3$)。\n- 相对误差 $R$：无量纲（以小数表示）。\n\n您的程序必须构建并分析三个合成的 EoS 表格，每个表格都由在指定网格上的 $p(T,\\mu)$ 和 $s(T,\\mu)$ 的闭式表达式定义。它们代表一个测试套件，旨在覆盖一个符合恒等式的情况、一个系统性偏差情况和一个噪声偏差情况：\n\n- 表 A（恒等式符合）：\n  - $p_A(T,\\mu) = a\\,\\mu^2 + b\\,T\\,\\mu + c\\,T^2 + d\\,T^3$。\n  - $s_A(T,\\mu) = b\\,\\mu + 2c\\,T + 3d\\,T^2$。\n  - 系数：$a=2\\times 10^{-5}$，$b=2\\times 10^{-2}$，$c=3\\times 10^{-1}$，$d=5\\times 10^{-3}$。\n\n- 表 B（熵的系统性偏差）：\n  - $p_B(T,\\mu) = p_A(T,\\mu)$。\n  - $s_B(T,\\mu) = s_A(T,\\mu)\\,(1+\\alpha) + \\beta\\,\\sin(T/T_0)$。\n  - 参数：$\\alpha=3\\times 10^{-2}$，$\\beta=2\\times 10^{-1}$，$T_0=20$。\n\n- 表 C（具有类随机熵偏差的非线性 $p$）：\n  - $p_C(T,\\mu) = \\gamma\\,\\mu^{3/2} + \\eta\\,T\\,\\mu^{1/2} + \\zeta\\,T^2$。\n  - $s_C(T,\\mu) = \\eta\\,\\mu^{1/2} + 2\\zeta\\,T + A(\\mu)\\,\\sin(\\kappa\\,T)\\,\\cos(\\lambda\\,\\mu)$。\n  - 参数：$\\gamma=3\\times 10^{-5}$，$\\eta=1.5\\times 10^{-2}$，$\\zeta=2.5\\times 10^{-1}$，$A(\\mu)=5\\times 10^{-2}\\,(1+5\\times 10^{-4}\\,\\mu)$，$\\kappa=3\\times 10^{-1}$，$\\lambda=10^{-2}$。\n\n使用以下均匀网格和微扰：\n- 温度网格：$T_i$，$i=0,\\dots,9$，其中 $T_0=5$，$T_9=50$，线性间隔（10个点）。\n- 化学势网格：$\\mu_j$，$j=0,\\dots,8$，其中 $\\mu_0=800$，$\\mu_8=1200$，线性间隔（9个点）。\n- 评估点和温度增量：\n  - 点 1：$(T,\\mu)=(20,1000)$，$\\Delta T=0.5$。\n  - 点 2：$(T,\\mu)=(5,900)$，$\\Delta T=0.5$。\n  - 点 3：$(T,\\mu)=(50,1100)$，$\\Delta T=-0.5$。\n\n对于每个表格（A、B、C），计算：\n1.  整个网格上的最大绝对恒等式偏差，$\\max_{i,j}|\\Delta_{ij}|$，以 $1/\\text{fm}^3$ 为单位报告。\n2.  在三个指定点上相对预测误差 $R_{ij}(\\Delta T)$ 的平均值，以无量纲小数报告。\n\n您的程序应生成单行输出，其中包含六个结果，形式为用方括号括起来的逗号分隔列表，顺序如下：\n$[\\text{A max deviation}, \\text{A mean relative error}, \\text{B max deviation}, \\text{B mean relative error}, \\text{C max deviation}, \\text{C mean relative error}]$。\n将每个浮点数四舍五入到六位小数。单位如上所述；数值输出是最大偏差在这些单位下的量值，以及相对误差平均值的无量纲小数。", "solution": "该问题要求分析用于数值相对论模拟的三种合成的稠密核物质状态方程 (EoS) 的热力学一致性。所研究的核心物理原理是一个从吉布斯-杜亥姆关系 $dp = s\\,dT + n\\,d\\mu$ 推导出的麦克斯韦关系。在恒定的重子化学势 $\\mu$ 下，这导出了恒等式 $\\left(\\partial p/\\partial T\\right)_{\\mu} = s$，其中 $p$ 是压强，$T$ 是温度，$s$ 是熵密度。此恒等式是任何有效 EoS 的基本自洽性条件。在 EoS 通常以表格形式给出的数值应用中，对此恒等式的违反可能源于建模不准确、测量误差或数值离散化。此类违反会降低数值流体动力学代码的准确性和稳定性。\n\n任务分为两部分：首先，量化此恒等式在离散网格上的违反程度；其次，评估这些违反在多大程度上影响一阶压强预测子（常用于守恒数值格式）的精度。\n\n方法如下：\n\n1.  **EoS 表格生成**：对于三种指定的 EoS 模型（A、B、C）中的每一种，我们首先填充压强 $p_{ij} = p(T_i, \\mu_j)$ 和熵密度 $s_{ij} = s(T_i, \\mu_j)$ 的二维表格。这些表格构建在由温度 $T_i$（其中 $i=0, \\dots, N_T-1$）和化学势 $\\mu_j$（其中 $j=0, \\dots, N_\\mu-1$）定义的均匀网格上。\n\n2.  **数值恒等式检验**：偏导数 $\\left(\\partial p/\\partial T\\right)_{\\mu}$ 在每个网格点 $(T_i, \\mu_j)$ 处使用应用于压强表 $p_{ij}$ 的有限差分公式进行数值近似。按照规定，内部点使用二阶中心差分，而温度域的边界点使用一阶单边差分：\n    $$\n    \\left(\\frac{\\partial p}{\\partial T}\\right)_{\\mu}(T_i, \\mu_j) \\approx\n    \\begin{cases}\n        \\frac{p_{1,j} - p_{0,j}}{T_1 - T_0}  \\text{若 } i=0 \\\\\n        \\frac{p_{i+1,j} - p_{i-1,j}}{T_{i+1} - T_{i-1}}  \\text{若 } 1 \\le i \\le N_T-2 \\\\\n        \\frac{p_{N_T-1,j} - p_{N_T-2,j}}{T_{N_T-1} - T_{N_T-2}}  \\text{若 } i=N_T-1\n    \\end{cases}\n    $$\n    然后，恒等式偏差场 $\\Delta_{ij}$ 计算为该数值导数与表格熵密度之间的差值：$\\Delta_{ij} = \\left(\\partial p/\\partial T\\right)_{\\mu}(T_i, \\mu_j) - s_{ij}$。该场的最大绝对值 $\\max_{i,j}|\\Delta_{ij}|$ 作为表格化 EoS 热力学不一致性的全局度量。对于恒等式符合的表 A，其中 $s_A(T,\\mu) = (\\partial p_A/\\partial T)_\\mu$ 在解析上成立，计算出的 $\\Delta_{ij}$ 仅因有限差分近似的截断误差而为非零。对于表 B 和 C，$\\Delta_{ij}$ 主要由 $s(T,\\mu)$ 和 $(\\partial p/\\partial T)_\\mu$ 之间设计的解析差异决定。\n\n3.  **预测子精度评估**：为量化 EoS 不一致性对数值预测的影响，我们分析了一个用于微小温度微扰 $\\Delta T$ 产生的压强变化 $\\Delta p$ 的一阶守恒预测子。该预测子使用点 $(T_i, \\mu_j)$ 处的表格熵，将此变化估计为 $\\Delta p_{\\text{pred}} = s_{ij} \\Delta T$。通过将其与“真实”压强变化 $\\Delta p_{\\text{true}} = p(T_i+\\Delta T, \\mu_j) - p(T_i, \\mu_j)$ 进行比较来评估此预测的准确性，后者是使用压强 $p(T, \\mu)$ 的精确解析函数形式计算的。相对预测误差定义为：\n    $$\n    R_{ij}(\\Delta T) = \\frac{\\left|\\Delta p_{\\text{pred}} - \\Delta p_{\\text{true}}\\right|}{\\max\\left(\\epsilon, \\left|\\Delta p_{\\text{true}}\\right|\\right)}\n    $$\n    其中 $\\epsilon = 10^{-12}$ 是一个小的正则化参数，以防止除以零。分析包括计算三种 EoS 模型中每一种在三个指定评估点上此相对误差的平均值。\n\n计算实现涉及定义压强和熵的解析函数，生成离散网格和表格，应用有限差分模板计算数值导数，并最终计算两个所需度量：网格上的最大恒等式偏差和指定点上的平均相对预测误差。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Validates thermodynamic consistency for three synthetic equations of state (EoS)\n    by calculating identity deviation and predictor error.\n    \"\"\"\n    # --- Problem Constants and Parameters ---\n    # Table A coefficients\n    A_a = 2e-5\n    A_b = 2e-2\n    A_c = 0.3\n    A_d = 5e-3\n    \n    # Table B parameters\n    B_alpha = 3e-2\n    B_beta = 0.2\n    B_T0 = 20.0\n\n    # Table C parameters\n    C_gamma = 3e-5\n    C_eta = 1.5e-2\n    C_zeta = 2.5e-1\n    C_kappa = 0.3\n    C_lambda = 0.01\n    \n    def C_A_func(mu):\n        \"\"\"Helper function for Table C entropy.\"\"\"\n        return 5e-2 * (1 + 5e-4 * mu)\n\n    # Grid parameters\n    T_grid = np.linspace(5.0, 50.0, 10)\n    mu_grid = np.linspace(800.0, 1200.0, 9)\n    N_T = len(T_grid)\n    \n    # Evaluation points and perturbations\n    # T indices: 20 -> 3, 5 -> 0, 50 -> 9\n    # mu indices: 1000 -> 4, 900 -> 2, 1100 -> 6\n    eval_points = [\n        {'T': 20.0, 'mu': 1000.0, 'dT': 0.5, 'i': 3, 'j': 4},\n        {'T': 5.0,  'mu': 900.0,  'dT': 0.5, 'i': 0, 'j': 2},\n        {'T': 50.0, 'mu': 1100.0, 'dT': -0.5, 'i': 9, 'j': 6}\n    ]\n    epsilon = 1e-12\n\n    # --- EoS Functional Forms ---\n    # Table A (identity-compliant)\n    def p_A(T, mu):\n        return A_a * mu**2 + A_b * T * mu + A_c * T**2 + A_d * T**3\n    \n    def s_A(T, mu):\n        return A_b * mu + 2 * A_c * T + 3 * A_d * T**2\n\n    # Table B (systematic deviation)\n    def p_B(T, mu):\n        return p_A(T, mu)\n        \n    def s_B(T, mu):\n        # The analytical derivative of p_B is s_A. We add a deviation to s_B.\n        return s_A(T, mu) * (1 + B_alpha) + B_beta * np.sin(T / B_T0)\n\n    # Table C (nonlinear p with complex deviation)\n    def p_C(T, mu):\n        return C_gamma * mu**1.5 + C_eta * T * mu**0.5 + C_zeta * T**2\n        \n    def s_C(T, mu):\n        # The analytical derivative of p_C is C_eta*mu^0.5 + 2*zeta*T.\n        # We add a complex deviation term to s_C.\n        analytical_deriv = C_eta * mu**0.5 + 2 * C_zeta * T\n        deviation_term = C_A_func(mu) * np.sin(C_kappa * T) * np.cos(C_lambda * mu)\n        return analytical_deriv + deviation_term\n\n    # --- Main Analysis Function ---\n    def analyze_eos(p_func, s_func):\n        \"\"\"\n        Computes max identity deviation and mean relative error for a given EoS.\n        \"\"\"\n        T_mesh, mu_mesh = np.meshgrid(T_grid, mu_grid, indexing='ij')\n\n        # Generate discrete EoS tables from analytical functions\n        p_table = p_func(T_mesh, mu_mesh)\n        s_table = s_func(T_mesh, mu_mesh)\n        \n        # --- 1. Calculate Maximum Absolute Identity Deviation ---\n        dp_dT_table = np.zeros_like(p_table)\n        \n        # Uniform grid spacing in temperature\n        delta_T = T_grid[1] - T_grid[0]\n        \n        # Numerical derivatives using specified finite difference schemes\n        # i=0 (forward difference, O(h))\n        dp_dT_table[0, :] = (p_table[1, :] - p_table[0, :]) / delta_T\n        # i=N_T-1 (backward difference, O(h))\n        dp_dT_table[-1, :] = (p_table[-1, :] - p_table[-2, :]) / delta_T\n        # 1 = i = N_T-2 (central difference, O(h^2))\n        if N_T > 2:\n            dp_dT_table[1:-1, :] = (p_table[2:, :] - p_table[:-2, :]) / (2 * delta_T)\n\n        Delta_table = dp_dT_table - s_table\n        max_deviation = np.max(np.abs(Delta_table))\n        \n        # --- 2. Calculate Mean Relative Prediction Error ---\n        relative_errors = []\n        for point in eval_points:\n            T, mu, dT = point['T'], point['mu'], point['dT']\n            i, j = point['i'], point['j']\n            \n            # Predictor uses entropy value from the generated table\n            s_val = s_table[i, j]\n            dp_pred = s_val * dT\n            \n            # \"True\" change is computed from the analytical pressure function\n            dp_true = p_func(T + dT, mu) - p_func(T, mu)\n            \n            # Relative error calculation\n            error = np.abs(dp_pred - dp_true)\n            denominator = np.maximum(epsilon, np.abs(dp_true))\n            relative_error = error / denominator\n            relative_errors.append(relative_error)\n            \n        mean_relative_error = np.mean(relative_errors)\n        \n        return max_deviation, mean_relative_error\n\n    # --- Run Analysis for each Table ---\n    results = []\n    \n    # Table A\n    max_dev_A, mean_err_A = analyze_eos(p_A, s_A)\n    results.extend([max_dev_A, mean_err_A])\n\n    # Table B\n    # For table B, p_B has a different entropy s_B. The true derivative of p_B is s_A.\n    # The deviation is s_A - s_B.\n    # However, the problem asks to check (dp_B/dT) - s_B.\n    max_dev_B, mean_err_B = analyze_eos(p_B, s_B)\n    results.extend([max_dev_B, mean_err_B])\n    \n    # Table C\n    # For table C, the analytical derivative is part of s_C, but s_C has an extra term.\n    # The check is (dp_C/dT) - s_C.\n    max_dev_C, mean_err_C = analyze_eos(p_C, s_C)\n    results.extend([max_dev_C, mean_err_C])\n\n    # --- Format and Print Output ---\n    output_str = ','.join([f\"{x:.6f}\" for x in results])\n    print(f\"[{output_str}]\")\n\nsolve()\n```", "id": "3473643"}]}