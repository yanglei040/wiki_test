{"hands_on_practices": [{"introduction": "在任何有限差分模拟中，第一步都是用离散网格点上的函数值来近似导数。这种近似的精度——即“阶数”——直接决定了整个模拟的准确性。本练习将通过泰勒级数展开，系统地推导一个六阶精度的中心差分格式的系数 ([@problem_id:3474408])。掌握这项基本功，不仅能让你理解“精度阶数”的本质，也为你将来针对特定问题设计自定义差分格式打下坚实基础。", "problem": "在线方法（MOL）中，用于求解数值相对论和引力波建模中的双曲型偏微分方程时，空间导数（如 $u_{x}$）在均匀网格上通过有限差分进行近似。考虑一个间距为 $\\Delta x$ 的均匀一维网格，其网格点为 $x_{i} = x_{0} + i \\,\\Delta x$。设有一个光滑函数 $u(x)$，例如，它代表了一个线性化引力波传播模型的特征场。您需要使用对称七点模板 $\\{x_{i+k}\\}_{k=-3}^{3}$ 来构建一阶导数 $u_{x}(x_{i})$ 的中心有限差分近似。假设其形式为\n$$\nu_{x}(x_{i}) \\approx \\frac{1}{\\Delta x} \\sum_{k=-3}^{3} c_{k} \\, u(x_{i+k}),\n$$\n其中系数 $c_{k}$ 的选择需要达到六阶精度。\n\n从 $u(x_{i+k})$ 在 $x_{i}$ 点的泰勒级数展开出发，通过施加必要的阶数条件，使得对 $u_{x}(x_{i})$ 的近似截断误差为 $\\mathcal{O}(\\Delta x^{6})$，推导出对称七点模板的系数 $\\{c_{k}\\}_{k=-3}^{3}$。利用模板是中心的且导数是奇的事实，来证明 $c_{0} = 0$ 以及对于 $k=1,2,3$ 有 $c_{-k} = -c_{k}$。将最终结果表示为有序系数行向量\n$$\n\\big(c_{-3},\\, c_{-2},\\, c_{-1},\\, c_{0},\\, c_{1},\\, c_{2},\\, c_{3}\\big)\n$$\n其中离散求和项已默认乘以了总因子 $1/\\Delta x$。无需进行四舍五入。", "solution": "该问题要求推导用于一阶导数 $u_x(x_i)$ 的六阶精度中心有限差分近似的系数 $\\{c_k\\}$。该近似定义在间距为 $\\Delta x$ 的均匀网格上，并使用一个对称七点模板 $\\{x_{i+k}\\}_{k=-3}^{3}$。其公式如下：\n$$\nu_x(x_i) \\approx \\frac{1}{\\Delta x} \\sum_{k=-3}^{3} c_k \\, u(x_{i+k})\n$$\n为确定这些系数，我们将每一项 $u(x_{i+k}) = u(x_i + k\\Delta x)$ 在点 $x_i$ 附近进行泰勒级数展开。设 $u^{(n)}(x_i)$ 表示 $u$ 在 $x_i$ 处的 $n$ 阶导数。泰勒级数为：\n$$\nu(x_i + k\\Delta x) = \\sum_{n=0}^{\\infty} \\frac{(k\\Delta x)^n}{n!} u^{(n)}(x_i)\n$$\n将此展开式代入有限差分公式，我们得到：\n$$\n\\frac{1}{\\Delta x} \\sum_{k=-3}^{3} c_k \\left( \\sum_{n=0}^{\\infty} \\frac{(k\\Delta x)^n}{n!} u^{(n)}(x_i) \\right)\n$$\n通过交换求和顺序，我们可以按 $u$ 的导数对各项进行分组：\n$$\n\\sum_{n=0}^{\\infty} \\left( \\frac{1}{\\Delta x} \\sum_{k=-3}^{3} c_k \\frac{(k\\Delta x)^n}{n!} \\right) u^{(n)}(x_i) = \\sum_{n=0}^{\\infty} \\left( \\sum_{k=-3}^{3} c_k k^n \\right) \\frac{(\\Delta x)^{n-1}}{n!} u^{(n)}(x_i)\n$$\n我们希望这个表达式是 $u_x(x_i) = u^{(1)}(x_i)$ 的一个近似。这意味着 $u^{(1)}(x_i)$ 的系数必须为 $1$，而其他导数 $u^{(n)}(x_i)$（对于 $n \\neq 1$）的系数在达到所需精度阶数之前应为零。对于六阶精度，截断误差必须为 $\\mathcal{O}(\\Delta x^6)$。这意味着对于 $n=0, 2, 3, 4, 5, 6$，$ (\\Delta x)^{n-1} u^{(n)}(x_i)$ 的系数必须为零。\n\n这导出了关于系数 $c_k$ 的以下方程组：\n\\begin{enumerate}\n    \\item $u^{(0)}(x_i)$ 的系数： $\\sum_{k=-3}^{3} c_k k^0 = 0$\n    \\item $u^{(1)}(x_i)$ 的系数： $\\frac{(\\Delta x)^{1-1}}{1!} \\sum_{k=-3}^{3} c_k k^1 = 1 \\implies \\sum_{k=-3}^{3} c_k k = 1$\n    \\item $u^{(2)}(x_i)$ 的系数： $\\sum_{k=-3}^{3} c_k k^2 = 0$\n    \\item $u^{(3)}(x_i)$ 的系数： $\\sum_{k=-3}^{3} c_k k^3 = 0$\n    \\item $u^{(4)}(x_i)$ 的系数： $\\sum_{k=-3}^{3} c_k k^4 = 0$\n    \\item $u^{(5)}(x_i)$ 的系数： $\\sum_{k=-3}^{3} c_k k^5 = 0$\n    \\item $u^{(6)}(x_i)$ 的系数： $\\sum_{k=-3}^{3} c_k k^6 = 0$\n\\end{enumerate}\n第一个非零高阶项将是 $u^{(7)}(x_i)$ 的系数，这导致截断误差与 $(\\Delta x)^6 u^{(7)}(x_i)$ 成正比。\n\n问题陈述，由于模板是中心的且一阶导数是奇的，系数必须满足反对称条件 $c_{-k} = -c_k$。这意味着 $c_0 = -c_0$，从而得到 $c_0 = 0$。这个性质显著简化了方程组。\n\n让我们来考察 $k$ 的偶次幂和奇次幂的和：\n对于任意偶次幂 $n=2m$（其中 $m=0, 1, 2, 3, \\dots$）：\n$$\n\\sum_{k=-3}^{3} c_k k^{2m} = c_0 \\cdot 0^{2m} + \\sum_{k=1}^{3} (c_k k^{2m} + c_{-k}(-k)^{2m}) = 0 + \\sum_{k=1}^{3} (c_k k^{2m} - c_k k^{2m}) = 0\n$$\n这表明方程 $1, 3, 5, 7$（对应 $n=0, 2, 4, 6$）由于系数的反对称性而自动满足。\n\n对于任意奇次幂 $n=2m+1$（其中 $m=0, 1, 2, \\dots$）：\n$$\n\\sum_{k=-3}^{3} c_k k^{2m+1} = c_0 \\cdot 0^{2m+1} + \\sum_{k=1}^{3} (c_k k^{2m+1} + c_{-k}(-k)^{2m+1}) = 0 + \\sum_{k=1}^{3} (c_k k^{2m+1} - c_k(-k^{2m+1})) = 2 \\sum_{k=1}^{3} c_k k^{2m+1}\n$$\n将此应用于余下的奇数 $n$ 的方程：\n\\begin{itemize}\n    \\item $n=1$： $2 \\sum_{k=1}^{3} c_k k = 1 \\implies c_1 + 2c_2 + 3c_3 = \\frac{1}{2}$\n    \\item $n=3$： $2 \\sum_{k=1}^{3} c_k k^3 = 0 \\implies c_1 + 8c_2 + 27c_3 = 0$\n    \\item $n=5$： $2 \\sum_{k=1}^{3} c_k k^5 = 0 \\implies c_1 + 32c_2 + 243c_3 = 0$\n\\end{itemize}\n我们现在得到了一个关于三个未知系数 $c_1, c_2, c_3$ 的三元线性方程组：\n$$\n\\begin{array}{rcrcrcr}\nc_1  +  2c_2  +  3c_3  =  1/2 \\\\\nc_1  +  8c_2  +  27c_3  =  0 \\\\\nc_1  +  32c_2  +  243c_3  =  0\n\\end{array}\n$$\n为了求解这个方程组，我们使用消元法。将第三个方程减去第二个方程得到：\n$$\n(32-8)c_2 + (243-27)c_3 = 0 \\implies 24c_2 + 216c_3 = 0\n$$\n两边除以 $24$，我们得到 $c_2$ 和 $c_3$ 之间的一个关系：\n$$\nc_2 + 9c_3 = 0 \\implies c_2 = -9c_3\n$$\n接下来，将第二个方程减去第一个方程：\n$$\n(8-2)c_2 + (27-3)c_3 = 0 - \\frac{1}{2} \\implies 6c_2 + 24c_3 = -\\frac{1}{2}\n$$\n将 $c_2 = -9c_3$ 代入此方程：\n$$\n6(-9c_3) + 24c_3 = -\\frac{1}{2} \\implies -54c_3 + 24c_3 = -\\frac{1}{2}\n$$\n$$\n-30c_3 = -\\frac{1}{2} \\implies c_3 = \\frac{1}{60}\n$$\n现在我们可以求出 $c_2$：\n$$\nc_2 = -9c_3 = -9 \\left( \\frac{1}{60} \\right) = -\\frac{9}{60} = -\\frac{3}{20}\n$$\n最后，我们使用第一个方程求出 $c_1$：\n$$\nc_1 = \\frac{1}{2} - 2c_2 - 3c_3 = \\frac{1}{2} - 2\\left(-\\frac{3}{20}\\right) - 3\\left(\\frac{1}{60}\\right)\n$$\n$$\nc_1 = \\frac{1}{2} + \\frac{6}{20} - \\frac{3}{60} = \\frac{1}{2} + \\frac{3}{10} - \\frac{1}{20}\n$$\n使用公分母 $20$：\n$$\nc_1 = \\frac{10}{20} + \\frac{6}{20} - \\frac{1}{20} = \\frac{15}{20} = \\frac{3}{4}\n$$\n因此，系数为 $c_1 = \\frac{3}{4}$，$c_2 = -\\frac{3}{20}$，以及 $c_3 = \\frac{1}{60}$。\n对称七点模板的完整系数集是：\n$$\nc_3 = \\frac{1}{60}\n$$\n$$\nc_2 = -\\frac{3}{20}\n$$\n$$\nc_1 = \\frac{3}{4}\n$$\n$$\nc_0 = 0\n$$\n$$\nc_{-1} = -c_1 = -\\frac{3}{4}\n$$\n$$\nc_{-2} = -c_2 = \\frac{3}{20}\n$$\n$$\nc_{-3} = -c_3 = -\\frac{1}{60}\n$$\n问题要求的是有序系数行向量 $(c_{-3}, c_{-2}, c_{-1}, c_0, c_1, c_2, c_3)$。该向量是：\n$$\n\\left(-\\frac{1}{60}, \\frac{3}{20}, -\\frac{3}{4}, 0, \\frac{3}{4}, -\\frac{3}{20}, \\frac{1}{60}\\right)\n$$", "answer": "$$\n\\boxed{\\begin{pmatrix} -\\frac{1}{60}  \\frac{3}{20}  -\\frac{3}{4}  0  \\frac{3}{4}  -\\frac{3}{20}  \\frac{1}{60} \\end{pmatrix}}\n$$", "id": "3474408"}, {"introduction": "将连续的偏微分方程离散化，不可避免地会引入误差，这些误差有时会表现为非物理效应。修正方程分析是一种强大的技术，它能揭示我们的差分格式实际上求解的是哪个“修正”后的方程。本练习将对一阶迎风格式进行分析，推导其等效的数值粘性项 ([@problem_id:3474375])，让你清晰地看到离散化是如何为一个纯粹的对流问题引入人工耗散的。理解这一点对于避免物理波（如引力波）在模拟中被过度衰减至关重要。", "problem": "考虑一个数值相对论代码中由线性化爱因斯坦方程产生的特征标量场的线性平流，其模型为双曲型偏微分方程 $u_{t} + a\\,u_{x} = 0$，其中平流速度 $a0$ 为常数。假设一个均匀空间网格，其点为 $x_{i} = i\\,\\Delta x$，以及一个均匀时间步长 $t_{n} = n\\,\\Delta t$，并令 $u_{i}^{n}$ 表示对 $u(x_{i}, t_{n})$ 的有限差分近似。你需要构建一个对于 $a0$ 与因果性一致的显式一阶迎风有限差分格式，方法是使用前向欧拉时间更新和对空间导数 $u_{x}$ 的单边后向差分近似。定义库朗-弗里德里希斯-列维（CFL）数 $\\lambda = a\\,\\Delta t / \\Delta x$。\n\n仅使用关于 $(x_{i}, t_{n})$ 的标准泰勒展开和连续方程 $u_{t} + a\\,u_{x} = 0$ 来消去时间导数以空间导数代替，推导该迎风格式所求解的主阶修正方程。从你的推导中，在形式为\n$$\nu_{t} + a\\,u_{x} = \\nu\\,u_{xx} + \\text{高阶项}\n$$\n的修正方程中，识别出乘以 $u_{xx}$ 的有效数值粘性系数 $\\nu$。\n提供一个以 $a$、$\\Delta x$ 和 $\\lambda$ 表示的 $\\nu$ 的闭式解析表达式。你的最终答案必须是单一的解析表达式。不要四舍五入；不需要单位。", "solution": "本问题要求推导应用于线性平流方程的一阶迎风有限差分格式的数值粘性系数。\n\n控制偏微分方程（PDE）是线性平流方程：\n$$\nu_{t} + a\\,u_{x} = 0\n$$\n其中 $u$ 是一个标量场，$t$ 是时间，$x$ 是空间坐标，$a0$ 是恒定的平流速度。下标表示偏微分，即 $u_{t} = \\frac{\\partial u}{\\partial t}$ 和 $u_{x} = \\frac{\\partial u}{\\partial x}$。\n\n我们在一个均匀网格上离散化该方程，空间步长为 $\\Delta x$，时间步长为 $\\Delta t$，使得 $x_{i} = i\\,\\Delta x$ 且 $t_{n} = n\\,\\Delta t$。网格点上的数值解记为 $u_{i}^{n} \\approx u(x_{i}, t_{n})$。\n\n问题指定了构建一个显式一阶迎风格式。这包括：\n1.  对时间导数使用前向欧拉差分，在 $(x_{i}, t_{n})$ 处求值：\n    $$\n    u_{t} \\approx \\frac{u_{i}^{n+1} - u_{i}^{n}}{\\Delta t}\n    $$\n2.  对空间导数使用单边后向差分，这是正确的“迎风”方向，因为平流速度 $a$ 为正（信息从较小的 $x$ 传播到较大的 $x$）：\n    $$\n    u_{x} \\approx \\frac{u_{i}^{n} - u_{i-1}^{n}}{\\Delta x}\n    $$\n\n将这些近似代入原始的偏微分方程，得到有限差分方程：\n$$\n\\frac{u_{i}^{n+1} - u_{i}^{n}}{\\Delta t} + a\\left(\\frac{u_{i}^{n} - u_{i-1}^{n}}{\\Delta x}\\right) = 0\n$$\n\n为了确定该格式求解的修正方程，我们对每一项在点 $(x_{i}, t_{n})$ 周围进行泰勒级数展开。我们令 $u$ 及其偏导数（例如 $u_{t}$, $u_{x}$, $u_{xx}$）表示在 $(x_{i}, t_{n})$ 处求值的连续函数及其导数。\n\n$u_{i}^{n+1} = u(x_{i}, t_{n}+\\Delta t)$ 在时间上的泰勒展开为：\n$$\nu_{i}^{n+1} = u + \\Delta t\\,u_{t} + \\frac{(\\Delta t)^{2}}{2}u_{tt} + \\mathcal{O}((\\Delta t)^{3})\n$$\n$u_{i-1}^{n} = u(x_{i}-\\Delta x, t_{n})$ 在空间上的泰勒展开为：\n$$\nu_{i-1}^{n} = u - \\Delta x\\,u_{x} + \\frac{(\\Delta x)^{2}}{2}u_{xx} - \\frac{(\\Delta x)^{3}}{6}u_{xxx} + \\mathcal{O}((\\Delta x)^{4})\n$$\n\n现在，我们将这些展开代回有限差分方程。对于时间导数项：\n$$\n\\frac{u_{i}^{n+1} - u_{i}^{n}}{\\Delta t} = \\frac{(u + \\Delta t\\,u_{t} + \\frac{(\\Delta t)^{2}}{2}u_{tt} + \\dots) - u}{\\Delta t} = u_{t} + \\frac{\\Delta t}{2}u_{tt} + \\mathcal{O}((\\Delta t)^{2})\n$$\n对于空间导数项：\n$$\n\\frac{u_{i}^{n} - u_{i-1}^{n}}{\\Delta x} = \\frac{u - (u - \\Delta x\\,u_{x} + \\frac{(\\Delta x)^{2}}{2}u_{xx} + \\dots)}{\\Delta x} = \\frac{\\Delta x\\,u_{x} - \\frac{(\\Delta x)^{2}}{2}u_{xx} + \\dots}{\\Delta x} = u_{x} - \\frac{\\Delta x}{2}u_{xx} + \\mathcal{O}((\\Delta x)^{2})\n$$\n将这些代回完整的格式中，得到：\n$$\n\\left(u_{t} + \\frac{\\Delta t}{2}u_{tt} + \\dots\\right) + a\\left(u_{x} - \\frac{\\Delta x}{2}u_{xx} + \\dots\\right) = 0\n$$\n重新排列各项以分离出原始的偏微分方程：\n$$\n(u_{t} + a\\,u_{x}) + \\frac{\\Delta t}{2}u_{tt} - a\\frac{\\Delta x}{2}u_{xx} + \\text{H.O.T.} = 0\n$$\n这就是数值格式实际求解的“修正方程”，精确到主阶截断误差项。我们可以将其写为：\n$$\nu_{t} + a\\,u_{x} = -\\frac{\\Delta t}{2}u_{tt} + a\\frac{\\Delta x}{2}u_{xx} - \\text{H.O.T.}\n$$\n问题要求使用原始的连续偏微分方程 $u_{t} = -a\\,u_{x}$ 来消去时间导数，以空间导数代替。为了找到 $u_{tt}$ 项的表达式，我们对偏微分方程进行微分。将 $u_{t} = -a\\,u_{x}$ 对时间求导得到 $u_{tt} = -a\\,u_{xt}$。假设解 $u$ 足够光滑，则混合偏导数相等，即 $u_{xt} = u_{tx}$。将 $u_{t} = -a\\,u_{x}$ 对空间求导得到 $u_{tx} = -a\\,u_{xx}$。因此，我们有：\n$$\nu_{tt} = -a\\,u_{xt} = -a\\,u_{tx} = -a(-a\\,u_{xx}) = a^{2}u_{xx}\n$$\n将这个关于 $u_{tt}$ 的结果代回修正方程：\n$$\nu_{t} + a\\,u_{x} = -\\frac{\\Delta t}{2}(a^{2}u_{xx}) + a\\frac{\\Delta x}{2}u_{xx} - \\text{H.O.T.}\n$$\n我们现在可以合并 $u_{xx}$ 项的系数：\n$$\nu_{t} + a\\,u_{x} = \\left(a\\frac{\\Delta x}{2} - a^{2}\\frac{\\Delta t}{2}\\right)u_{xx} - \\text{H.O.T.}\n$$\n该方程的形式为 $u_{t} + a\\,u_{x} = \\nu\\,u_{xx} + \\text{高阶项}$。通过比较两者，我们确定数值粘性系数 $\\nu$ 为：\n$$\n\\nu = a\\frac{\\Delta x}{2} - a^{2}\\frac{\\Delta t}{2}\n$$\n问题要求将此系数用 $a$、$\\Delta x$ 和库朗-弗里德里希斯-列维（CFL）数（定义为 $\\lambda = \\frac{a\\,\\Delta t}{\\Delta x}$）来表示。为此，我们从 $\\nu$ 的表达式中提出因子 $\\frac{a\\,\\Delta x}{2}$：\n$$\n\\nu = \\frac{a\\,\\Delta x}{2}\\left(1 - \\frac{a^{2}\\,\\Delta t}{a\\,\\Delta x}\\right) = \\frac{a\\,\\Delta x}{2}\\left(1 - \\frac{a\\,\\Delta t}{\\Delta x}\\right)\n$$\n代入 $\\lambda$ 的定义：\n$$\n\\nu = \\frac{a\\,\\Delta x}{2}(1 - \\lambda)\n$$\n这就是数值粘性系数的最终表达式。这个主阶误差项具有扩散项或粘性项的形式，这就是为什么该格式被称为是耗散的。", "answer": "$$\n\\boxed{\\frac{a\\,\\Delta x}{2}(1 - \\lambda)}\n$$", "id": "3474375"}, {"introduction": "构建并分析了数值格式后，我们如何确信编写的代码是正确的？收敛性测试是验证代码可靠性的黄金标准，它确保了我们模拟中的误差会随着分辨率的提高而按预期减小。本练习将你置于一个计算科学家的角色，利用一组模拟产生的误差数据来执行收敛性分析 ([@problem_id:3474345])。你将运用理查森外推法的核心思想，从数据中提取出“观测到的”收敛阶数 $p$，并将其与理论阶数进行比较，从而掌握验证数值代码正确性的关键方法论。", "problem": "考虑在周期区间 $[0,1]$ 上的线性平流方程 $u_t + c\\,u_x = 0$，其初始数据光滑且波速 $c0$。采用方法线法，空间上进行有限差分离散，时间上使用显式 Runge–Kutta 积分器进行推进。在网格加密过程中，Courant–Friedrichs–Lewy (CFL) 数保持不变，且时间积分器的阶数至少与空间阶数一样高，因此全局误差由空间截断误差主导。设网格点 $x_i$ 处的离散解为 $u_i$，并用 $u_i^{\\text{exact}}$ 表示在相同网格点上采样的精确解。定义离散误差范数\n$$\nL_2 = \\left(\\sum_{i} \\left|u_i - u_i^{\\text{exact}}\\right|^2\\,\\Delta x\\right)^{1/2},\\qquad\nL_\\infty = \\max_i \\left|u_i - u_i^{\\text{exact}}\\right|.\n$$\n假设格式是相容且稳定的，因此在渐近区域，当以固定 CFL 数进行因子为 $r1$ 的加密时，全局误差遵循 $\\|e_h\\| = C h^p + \\mathcal{O}(h^{p+1})$，其中 $h$ 是网格间距，$p$ 是空间精度阶，$C$ 是一个依赖于解和范数的常数。你在时间 $T$ 时，在网格间距分别为 $h$、$h/2$ 和 $h/4$ 的网格上进行了三次模拟（因此加密比 $r=2$）。测得的误差如下：\n- 对于 $L_2$ 范数：$L_2(h) = 1.31\\times 10^{-3}$，$L_2(h/2) = 3.27\\times 10^{-4}$，$L_2(h/4) = 8.18\\times 10^{-5}$。\n- 对于 $L_\\infty$ 范数：$L_\\infty(h) = 1.07\\times 10^{-2}$，$L_\\infty(h/2) = 2.69\\times 10^{-3}$，$L_\\infty(h/4) = 6.80\\times 10^{-4}$。\n\n仅使用上述基本定义和假设（即在固定 CFL 数下，主导的全局误差在渐近区域内与 $C h^p$ 成比例），评估以下关于 Richardson 外推和观测精度阶的陈述。选择所有正确的陈述。\n\nA. 对于任何相容范数 $L(\\cdot)$，观测阶数的两层网格 Richardson 估计为 $p \\approx \\dfrac{\\ln\\!\\left(L(h)/L(h/r)\\right)}{\\ln r}$。使用给定的 $L_2$ 数据和 $r=2$，计算结果保留两位小数为 $p \\approx 2.00$。\n\nB. 如果精确解不可用，只要解是光滑的且主截断误差占主导地位，就可以用网格间差异替换精确误差范数，并通过 $p \\approx \\dfrac{\\ln\\!\\left(\\|u_h - u_{h/r}\\|/\\|u_{h/r} - u_{h/r^2}\\|\\right)}{\\ln r}$ 来估计 $p$（在相容范数下）。在渐近区域，该估计值趋向于从精确误差范数中提取的相同 $p$ 值。\n\nC. $L_\\infty$ 范数不适用于双曲问题，并且对于光滑解，在网格加密下不收敛，因此任何基于 $L_\\infty$ 的 Richardson 估计即使对于高阶格式也会趋向于 $p\\to 0$。\n\nD. 为确保观测到的阶数能反映空间精度，方法线法的标准做法是在网格加密时保持 Courant–Friedrichs–Lewy 数不变，并使用阶数至少为 $p$ 的时间积分器，以使时间离散误差按 $\\mathcal{O}(\\Delta t^{p_t})$（其中 $p_t \\ge p$）缩放，从而不污染空间阶数的估计。\n\nE. 一个三层范数外推公式 $L_{\\text{extrap}}(h/4) = \\dfrac{2^p L(h/4) - L(h/2)}{2^p - 1}$ 可用于消除主误差项，并且无论 $p$ 是否已知都有效；然后可以从 $L_{\\text{extrap}}$ 和 $L(h/4)$ 事后计算 $p$，而无需额外数据。", "solution": "在进行求解之前，对问题陈述进行严格验证。\n\n### 步骤 1：提取已知条件\n- **控制方程**：线性平流方程 $u_t + c\\,u_x = 0$，定义在周期区间 $[0,1]$ 上，具有光滑初始数据和正波速 $c0$。\n- **数值方法**：采用方法线法，空间上进行有限差分离散，时间上使用显式 Runge–Kutta 积分器。\n- **实验设置**：\n    - 在网格加密期间，Courant–Friedrichs–Lewy (CFL) 数保持固定。\n    - 时间积分器的阶数至少与空间精度阶一样高。\n    - 全局误差由空间截断误差主导。\n    - 在网格间距为 $h$、$h/2$ 和 $h/4$ 的网格上运行三次模拟直到最终时间 $T$，对应的加密比 $r=2$。\n- **误差定义**：设 $u_i$ 为离散解，$u_i^{\\text{exact}}$ 为在网格点 $x_i$ 处的精确解。\n    - 离散 $L_2$ 误差范数为 $L_2 = \\left(\\sum_{i} \\left|u_i - u_i^{\\text{exact}}\\right|^2\\,\\Delta x\\right)^{1/2}$。\n    - 离散 $L_\\infty$ 误差范数为 $L_\\infty = \\max_i \\left|u_i - u_i^{\\text{exact}}\\right|$。\n- **渐近误差模型**：对于相容且稳定的格式，假定全局误差范数 $\\|e_h\\|$ 遵循 $\\|e_h\\| = C h^p + \\mathcal{O}(h^{p+1})$，其中 $h$ 为网格间距，$p$ 为空间精度阶。\n- **测量数据**：\n    - $L_2(h) = 1.31\\times 10^{-3}$，$L_2(h/2) = 3.27\\times 10^{-4}$，$L_2(h/4) = 8.18\\times 10^{-5}$。\n    - $L_\\infty(h) = 1.07\\times 10^{-2}$，$L_\\infty(h/2) = 2.69\\times 10^{-3}$，$L_\\infty(h/4) = 6.80\\times 10^{-4}$。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学基础**：该问题在偏微分方程数值分析这一成熟领域中有坚实的理论基础。线性平流方程、方法线法、CFL 条件、误差范数和收敛性分析都是标准概念。\n- **适定性**：问题是适定的。它要求根据给定的定义和数据评估一组陈述，这是一个可以基于计算和既定理论得出确定答案的任务。\n- **客观性**：问题陈述是客观的，使用了精确的数学和计算术语。\n- **结论**：问题陈述没有科学上的不健全、模糊不清和矛盾之处。它描述了一个标准的数值实验，并要求基于结果进行分析。因此，该问题是**有效的**。\n\n### 步骤 3：推导与选项分析\n问题要求评估五个陈述。我们将逐一进行分析。\n\n**A. 对于任何相容范数 $L(\\cdot)$，观测阶数的两层网格 Richardson 估计为 $p \\approx \\dfrac{\\ln\\!\\left(L(h)/L(h/r)\\right)}{\\ln r}$。使用给定的 $L_2$ 数据和 $r=2$，计算结果保留两位小数为 $p \\approx 2.00$。**\n\n观测收敛阶 $p$ 的公式推导始于渐近误差模型：\n对于网格间距为 $h$ 的网格上的误差范数 $L$，$L(h) \\approx C h^p$。\n对于加密后间距为 $h/r$ 的网格，误差为：\n$L(h/r) \\approx C (h/r)^p = C h^p / r^p$。\n取两个误差之比可以消去未知常数 $C$：\n$$\n\\frac{L(h)}{L(h/r)} \\approx \\frac{C h^p}{C h^p / r^p} = r^p\n$$\n两边取自然对数求解 $p$ 得：\n$$\n\\ln\\left(\\frac{L(h)}{L(h/r)}\\right) \\approx \\ln(r^p) = p \\ln r\n$$\n$$\np \\approx \\frac{\\ln(L(h)/L(h/r))}{\\ln r}\n$$\n陈述中提供的公式是正确的。现在我们将其应用于给定的 $L_2$ 数据，其中 $r=2$。标准做法是使用最密的两层网格来最准确地估计渐近阶。因此，我们使用 $L_2(h/2)$ 和 $L_2(h/4)$：\n$L(h') = L_2(h/2) = 3.27\\times 10^{-4}$\n$L(h'/r) = L_2(h/4) = 8.18\\times 10^{-5}$\n加密比为 $r=2$。\n$$\np \\approx \\frac{\\ln\\left(\\frac{3.27\\times 10^{-4}}{8.18\\times 10^{-5}}\\right)}{\\ln 2} \\approx \\frac{\\ln(3.997555...)}{\\ln 2} \\approx \\frac{1.38565}{0.69315} \\approx 1.9991\n$$\n保留两位小数，结果为 $p \\approx 2.00$。该陈述是正确的。\n\n**A 的结论：正确。**\n\n**B. 如果精确解不可用，只要解是光滑的且主截断误差占主导地位，就可以用网格间差异替换精确误差范数，并通过 $p \\approx \\dfrac{\\ln\\!\\left(\\|u_h - u_{h/r}\\|/\\|u_{h/r} - u_{h/r^2}\\|\\right)}{\\ln r}$ 来估计 $p$（在相容范数下）。在渐近区域，该估计值趋向于从精确误差范数中提取的相同 $p$ 值。**\n\n该陈述描述了一种在精确解未知时进行收敛性分析的标准技术。设 $u_{\\text{exact}}$ 为在网格上采样的精确解。设 $u_h$ 为网格间距为 $h$ 时的数值解。误差为 $e_h = u_h - u_{\\text{exact}}$。我们假设 $e_h(x) \\approx C(x) h^p$。\n两层网格上解的差异为：\n$u_h - u_{h/r} = (u_{\\text{exact}} + e_h) - (u_{\\text{exact}} + e_{h/r}) = e_h - e_{h/r}$。\n假设 $e_h \\approx C h^p$，我们有：\n$u_h - u_{h/r} \\approx C h^p - C (h/r)^p = C h^p (1 - r^{-p})$。\n因此，这个差异的范数按以下方式缩放：\n$\\|u_h - u_{h/r}\\| \\approx \\|C h^p (1-r^{-p})\\| \\approx K_1 h^p$，其中 $K_1$ 是一个常数。\n类似地，对于下一层加密：\n$\\|u_{h/r} - u_{h/r^2}\\| \\approx K_1 (h/r)^p$。\n取这些范数的比值：\n$$\n\\frac{\\|u_h - u_{h/r}\\|}{\\|u_{h/r} - u_{h/r^2}\\|} \\approx \\frac{K_1 h^p}{K_1 (h/r)^p} = r^p\n$$\n求解 $p$ 即可得到陈述中给出的公式。该过程在所述条件（光滑解，渐近区域）下是有效的，并且是实用代码验证的基石。\n\n**B 的结论：正确。**\n\n**C. $L_\\infty$ 范数不适用于双曲问题，并且对于光滑解，在网格加密下不收敛，因此任何基于 $L_\\infty$ 的 Richardson 估计即使对于高阶格式也会趋向于 $p\\to 0$。**\n\n这个陈述是根本错误的。对于应用于具有光滑解的线性双曲方程的稳定、相容的数值格式（如问题中所述），在网格加密下，误差在所有标准范数（包括 $L_\\infty$（最大值）范数）下都应收敛到零。对于光滑问题，收敛阶 $p$ 在 $L_2$ 和 $L_\\infty$ 范数下应该是相同的。像 Gibbs 振荡这类会降低 $L_\\infty$ 收敛性的问题，出现在*不连续*解的情况下，而问题的前提“光滑初始数据”明确排除了这种情况。\n我们可以用所提供的数据直接证伪该陈述。让我们使用 $L_\\infty$ 数据和陈述 A 中的公式来计算观测到的收敛阶。我们使用最密的两层网格：\n$L_\\infty(h/2) = 2.69\\times 10^{-3}$\n$L_\\infty(h/4) = 6.80\\times 10^{-4}$\n$r=2$。\n$$\np \\approx \\frac{\\ln\\left(\\frac{2.69\\times 10^{-3}}{6.80\\times 10^{-4}}\\right)}{\\ln 2} \\approx \\frac{\\ln(3.95588...)}{\\ln 2} \\approx \\frac{1.3752}{0.69315} \\approx 1.984\n$$\n在 $L_\\infty$ 范数下观测到的收敛阶约为 $p \\approx 1.98$，这与用 $L_2$ 范数得到的阶数 $2$ 非常接近。这与二阶格式的预期一致，并直接反驳了收敛阶将趋于 $0$ 的说法。\n\n**C 的结论：不正确。**\n\n**D. 为确保观测到的阶数能反映空间精度，方法线法的标准做法是在网格加密时保持 Courant–Friedrichs–Lewy 数不变，并使用阶数至少为 $p$ 的时间积分器，以使时间离散误差按 $\\mathcal{O}(\\Delta t^{p_t})$（其中 $p_t \\ge p$）缩放，从而不污染空间阶数的估计。**\n\n该陈述准确地描述了对方法线法离散进行收敛性分析的标准方法。全局误差是空间离散误差 $E_{\\text{space}}$ 和时间离散误差 $E_{\\text{time}}$ 的组合。\n$E_{\\text{total}} \\approx E_{\\text{space}} + E_{\\text{time}}$\n这些误差假定按以下方式缩放：\n$\\|E_{\\text{space}}\\| \\approx C_s h^p$\n$\\|E_{\\text{time}}\\| \\approx C_t \\Delta t^{p_t}$\n其中 $p$ 是空间阶，$p_t$ 是时间阶。\n为了测试空间阶 $p$，我们加密空间网格，$h \\to h/r$。CFL 数定义为 $\\lambda = c \\Delta t / h$。保持 $\\lambda$ 不变意味着当 $h$ 改变时，$\\Delta t$ 必须成比例地改变：$\\Delta t = (\\lambda/c) h$。\n将此代入总误差表达式中得到：\n$\\|E_{\\text{total}}\\| \\approx C_s h^p + C_t \\left(\\frac{\\lambda}{c} h\\right)^{p_t} = C_s h^p + C'_t h^{p_t}$。\n为了使总误差呈现出 $p$ 阶的收敛率，当 $h \\to 0$ 时，$C_s h^p$ 项必须是主导项。这要求另一项 $C'_t h^{p_t}$ 至少与 $h^p$ 一样快地消失。这个条件是 $p_t \\ge p$。如果 $p_t  p$，则时间误差将占主导，观测到的收敛率将是 $p_t$，而不是空间阶 $p$。因此，所述过程对于正确测量空间精度阶是必要的。\n\n**D 的结论：正确。**\n\n**E. 一个三层范数外推公式 $L_{\\text{extrap}}(h/4) = \\dfrac{2^p L(h/4) - L(h/2)}{2^p - 1}$ 可用于消除主误差项，并且无论 $p$ 是否已知都有效；然后可以从 $L_{\\text{extrap}}$ 和 $L(h/4)$ 事后计算 $p$，而无需额外数据。**\n\n该陈述涉及 Richardson 外推。为从两个近似值 $A_h$ 和 $A_{h/r}$ 获得对某个量 $A$ 的更准确估计，Richardson 外推的一般公式是 $A_{\\text{extrap}} = \\frac{r^p A_{h/r} - A_h}{r^p - 1}$。此公式消除了 $h^p$ 阶的主误差项。\n该陈述将此应用于误差范数本身。让我们分析其中的主张：\n1.  “…无论 $p$ 是否已知都有效…”：这是错误的。公式明确包含 $2^p$ 项（因为 $r=2$）。要计算外推值 $L_{\\text{extrap}}$，必须事先知道或估计收敛阶 $p$。该公式从根本上依赖于 $p$。\n2.  “…然后可以从 $L_{\\text{extrap}}$ 和 $L(h/4)$ 事后计算 $p$，而无需额外数据。”：这也是错误的。要计算收敛率（阶数 $p$），需要观察误差量如何随网格间距*缩放*。这至少需要两个不同网格间距下的两个误差测量值。$L(h/4)$ 是在间距 $h/4$ 处测得的误差。$L_{\\text{extrap}}(h/4)$ 是在同一有效间距 $h/4$ 处误差的*修正估计*，但其主导的 $\\mathcal{O}(h^p)$ 误差项已被移除。它是一个单一的数据点。无法从单个网格分辨率下的原始值和校正值确定变化率。需要另一个外推值，例如 $L_{\\text{extrap}}(h/8)$，才能估计*外推*解的收敛率。该陈述提出了一个逻辑上不可能的过程。\n\n**E 的结论：不正确。**\n\n**正确陈述总结**\n根据数值分析原理和对所提供数据的验证，陈述 A、B 和 D 是正确的。陈述 C 和 E 包含根本性错误。", "answer": "$$\\boxed{ABD}$$", "id": "3474345"}]}