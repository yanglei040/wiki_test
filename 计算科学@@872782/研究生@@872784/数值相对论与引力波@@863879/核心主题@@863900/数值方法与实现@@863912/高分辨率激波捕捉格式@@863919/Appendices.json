{"hands_on_practices": [{"introduction": "在我们尝试用数值方法捕捉激波之前，必须首先理解它们的解析性质。第一个练习 [@problem_id:3476830] 将使用一个简单的伯格斯方程 (Burgers' equation) 作为模型系统。通过推导一个黎曼问题 (Riemann problem) 的精确解，我们将具体地看到不连续性是如何形成的，以及兰金-雨贡纽 (Rankine-Hugoniot) 和拉克斯熵 (Lax entropy) 等条件如何被用来选择唯一的、符合物理的解。", "problem": "考虑一个一维标量守恒律，在光速为$1$的单位制下，\n$$u_{t} + f(u)_{x} = 0,$$\n它被用作数值相对论和引力波源建模中高分辨率激波捕捉（HRSC）格式（例如加权基本无振荡（WENO）重构）的代理基准。取凸通量\n$$f(u) = \\frac{u^{2}}{2},$$\n以及黎曼初值数据\n$$u(x,0) = \\begin{cases}\nu_{L},  x  0,\\\\\nu_{R},  x > 0,\n\\end{cases}\n\\quad \\text{其中} \\quad u_{L} = 0.85, \\quad u_{R} = -0.15.$$\n从守恒律的积分形式出发，并应用兰金-雨贡纽跳跃条件以及Lax熵条件，确定$t>0$时满足熵条件的唯一弱解结构，并计算相应的激波速度$s$。以无量纲单位报告激波速度。将最终数值答案四舍五入至四位有效数字。", "solution": "所述问题具有科学依据、适定且客观。它提出了无粘伯格斯方程的一个标准黎曼问题，这是研究双曲守恒律和诸如高分辨率激波捕捉（HRSC）格式等数值方法时的基本测试案例。所有必要的数据和条件均已提供，不存在内部矛盾或违反物理或数学原理的情况。因此，该问题是有效的，我们可以继续进行求解。\n\n一维标量守恒律由下式给出\n$$u_{t} + f(u)_{x} = 0,$$\n其中$u=u(x,t)$是守恒量，$f(u)$是通量函数。该定律在空间区间$[x_{1}, x_{2}]$上的积分形式为\n$$\\frac{d}{dt} \\int_{x_{1}}^{x_{2}} u(x,t) \\, dx = f(u(x_{1},t)) - f(u(x_{2},t)).$$\n对于一个包含以速度$s$传播的间断（激波）的弱解，我们考虑一个随激波移动的任意小区间$[x_{1}, x_{2}]$。状态$u(x,t)$假定在激波两侧是分段常数，左侧为状态$u_{L}$，右侧为状态$u_{R}$。将积分守恒律应用于这个移动的间断，得到兰金-雨贡纽跳跃条件，该条件将激波速度$s$与两侧的状态联系起来：\n$$s = \\frac{f(u_{R}) - f(u_{L})}{u_{R} - u_{L}} = \\frac{[f(u)]}{[u]},$$\n其中$[\\cdot]$表示量跨越激波的跳跃。\n\n给定的通量函数是凸的：\n$$f(u) = \\frac{u^{2}}{2}.$$\n双曲方程的特征速度$a(u)$由通量函数的导数给出：\n$$a(u) = f'(u) = \\frac{d}{du}\\left(\\frac{u^{2}}{2}\\right) = u.$$\n黎曼初值数据为\n$$u(x,0) = \\begin{cases}\nu_{L} = 0.85,  x  0,\\\\\nu_{R} = -0.15,  x > 0.\n\\end{cases}$$\n解的类型（激波或稀疏波）取决于左右两边状态的特征速度$a(u_{L})$和$a(u_{R})$之间的关系。\n对于我们的具体情况，特征速度为：\n$$a(u_{L}) = u_{L} = 0.85,$$\n$$a(u_{R}) = u_{R} = -0.15.$$\n由于$a(u_{L}) > a(u_{R})$，特征线正在汇合，这导致激波的形成。如果$a(u_{L})  a(u_{R})$，则会形成稀疏波。因此，解是分隔两个常数状态$u_{L}$和$u_{R}$的单个间断。\n\n为确保解在物理上有意义且唯一，它必须满足熵条件。激波的Lax熵条件指出，激波左侧的特征速度必须大于激波速度，而激波速度又必须大于激波右侧的特征速度。用数学语言表达为：\n$$a(u_{L}) > s > a(u_{R}).$$\n现在我们使用兰金-雨贡纽条件计算给定通量和状态下的激波速度$s$：\n$$s = \\frac{f(u_{R}) - f(u_{L})}{u_{R} - u_{L}} = \\frac{\\frac{1}{2}u_{R}^{2} - \\frac{1}{2}u_{L}^{2}}{u_{R} - u_{L}}.$$\n该表达式在代数上可以简化为：\n$$s = \\frac{\\frac{1}{2}(u_{R} - u_{L})(u_{R} + u_{L})}{u_{R} - u_{L}} = \\frac{u_{R} + u_{L}}{2}.$$\n代入给定的$u_{L}$和$u_{R}$的数值：\n$$s = \\frac{-0.15 + 0.85}{2} = \\frac{0.70}{2} = 0.35.$$\n我们必须验证这个激波速度是否满足Lax熵条件：\n$$a(u_{L}) > s > a(u_{R})$$\n$$0.85 > 0.35 > -0.15.$$\n该不等式成立，证实了我们的激波解是唯一的、满足熵条件的弱解。对于$t>0$，该解的结构是一个以恒定速度$s$移动的单一激波波前：\n$$u(x,t) = \\begin{cases}\n0.85,  x  st,\\\\\n-0.15,  x > st,\n\\end{cases}$$\n其中$s = 0.35$。\n\n问题要求将激波速度$s$四舍五入到四位有效数字。计算值恰好为$0.35$。为了用四位有效数字表示，我们将其写为$0.3500$。", "answer": "$$\\boxed{0.3500}$$", "id": "3476830"}, {"introduction": "从简化的玩具模型转向相对论流体力学带来了显著的新挑战。在任何相对论流体力学程序中，最关键的一步或许是从守恒量中恢复原始变量（如密度和压力）。这个练习 [@problem_id:3476915] 将指导你推导并实现一个稳健的求解器，用于完成这个“守恒量到原始量”的转化，这是任何涉及物质的数值相对论模拟的基石。", "problem": "考虑在一维狭义相对论流体力学（SRHD）中，采用自然单位制，其中光速设为 $c = 1$。在高分辨率激波捕捉（HRSC）方法中，例如使用加权基本无振荡（WENO）重构的方法，有限体积更新会演化一组守恒变量。每次时间更新后，必须恢复原始变量，以计算下一步的通量和特征速度。本问题要求您实现一个从守恒变量恢复伽马律理想流体原始变量的稳健算法，该算法需适用于数值相对论和引力波程序。\n\n基本原理：\n- 流动遵循平直时空中的狭义相对论流体力学。\n- 一维空间中的守恒变量定义为 $D$、$S$ 和 $\\tau$。原始变量是静止质量密度 $\\rho$、流体速度 $v$（满足 $|v|  1$）和压力 $p$（满足 $p \\ge 0$）。\n- 洛伦兹因子为 $W = 1/\\sqrt{1 - v^2}$。\n- 对于伽马律理想流体，比焓为 $h = 1 + \\epsilon + p/\\rho$。对于绝热指数为 $\\Gamma$ 的伽马律状态方程，单位质量的内能为 $\\epsilon = p/((\\Gamma - 1)\\rho)$，因此 $h = 1 + \\Gamma p / ((\\Gamma - 1)\\rho)$。\n- 守恒变量与原始变量的关系如下\n$$\nD = \\rho W,\n$$\n$$\nS = \\rho h W^2 v,\n$$\n$$\n\\tau = \\rho h W^2 - p - D.\n$$\n为简洁起见，定义 $E = \\tau + D$。\n\n问题目标：\n- 给定 $(D, S, \\tau)$ 和 $\\Gamma$，恢复满足上述关系且服从物理约束 $\\rho \\ge 0$、$|v|  1$ 和 $p \\ge 0$ 的 $(\\rho, v, p)$。\n\n推导约束：\n- 您必须从上面列出的基本定义出发，推导出一个仅关于 $p$ 的非线性方程。利用 $E = \\rho h W^2 - p$ 和 $S = \\rho h W^2 v$ 这两个关系，通过以下方式将 $v$ 表示为 $p$ 的函数：\n$$\nv(p) = \\frac{S}{E + p}.\n$$\n- 使用此关系式表达 $W(p)$，然后构建一个标量残差 $R(p)$，使得物理可行解满足 $R(p) = 0$。该残差必须从基本定义和伽马律状态方程推导得出，不得使用任何简化公式。\n- 设计一个在迭代过程中强制执行 $p \\ge 0$ 和 $|v|  1$ 的求解器。您的求解器必须对弱相对论性和强相对论性状态都具有稳健性。\n\n算法要求：\n- 实现一种混合求根方案：在安全高效时使用牛顿-拉弗森法（Newton-Raphson），当牛顿-拉弗森法不收敛或试图离开物理允许域时，则回退到区间法（如二分法）。\n- 您必须从用于推导 $R(p)$ 的相同基本关系式中解析地推导并实现导数 $\\mathrm{d}R/\\mathrm{d}p$。\n- 在恢复 $p$ 之后，计算 $v$ 和 $W$，最后通过 $\\rho = D/W$ 计算 $\\rho$。\n\n数值条件和单位：\n- 使用自然单位制，其中 $c = 1$。\n- 所有计算都是无量纲的。不需要物理单位。\n\n测试套件：\n您的程序必须对以下五个测试用例运行恢复算法，每个用例都是一个元组 $(D, S, \\tau, \\Gamma)$：\n- 用例 1：$(D, S, \\tau, \\Gamma) = (1.04828484, 0.46153846, 0.39017670, 1.33333333)$。\n- 用例 2：$(D, S, \\tau, \\Gamma) = (1.14707867, 3.31578948, 2.48713186, 1.33333333)$。\n- 用例 3：$(D, S, \\tau, \\Gamma) = (1.20000000, 0.00000000, 0.30000000, 1.66666667)$。\n- 用例 4：$(D, S, \\tau, \\Gamma) = (1.15470054, 0.66666668, 0.17863281, 1.66666667)$。\n- 用例 5：$(D, S, \\tau, \\Gamma) = (0.70888121, 6.96482412, 6.31629468, 1.33333333)$。\n\n覆盖范围说明：\n- 用例 1 是一个中等速度、中等压力的状态。\n- 用例 2 是一个具有大洛伦兹因子的高度相对论性状态。\n- 用例 3 是一个零动量（$S = 0$）下的纯能量恢复。\n- 用例 4 探测压力非常小的近冷区。\n- 用例 5 是一个接近超相对论性的动量主导状态。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每个元素对应一个测试用例，并且本身必须是一个包含三个浮点数 $[\\rho, v, p]$ 的列表，每个浮点数四舍五入到 8 位小数，例如\n$$\n[[\\rho_1, v_1, p_1],[\\rho_2, v_2, p_2],\\dots]\n$$\n每个浮点数四舍五入到 8 位小数。", "solution": "用户提供了一个在狭义相对论流体力学领域中定义明确的问题。该问题具有科学依据，内容自洽，并要求推导和实现一个数值算法。验证标准已满足。\n\n该问题要求从守恒变量 $(D, S, \\tau)$ 恢复一维伽马律理想流体流动的原始变量 $(\\rho, v, p)$。这些量分别是静止质量密度 $\\rho$、流体速度 $v$、压力 $p$、守恒静止质量密度 $D$、守恒动量 $S$ 和守恒能量 $\\tau$。绝热指数为 $\\Gamma$。问题设定在光速 $c=1$ 的自然单位制中。\n\n基本关系如下：\n洛伦兹因子：\n$$\nW = \\frac{1}{\\sqrt{1 - v^2}}\n$$\n伽马律流体的比焓：\n$$\nh = 1 + \\frac{\\Gamma p}{(\\Gamma - 1)\\rho}\n$$\n守恒变量通过原始变量定义如下：\n1.  $D = \\rho W$\n2.  $S = \\rho h W^2 v$\n3.  $\\tau = \\rho h W^2 - p - D$\n\n物理约束为 $\\rho \\ge 0$，$p \\ge 0$ 和 $|v|  1$。\n\n任务是推导并求解一个关于压力 $p$ 的非线性方程，然后恢复其他原始变量。\n\n**步骤 1：推导压力的残差方程**\n\n根据引导，我们使用辅助变量 $E = \\tau + D$。从 $\\tau$ 的定义出发，这可以简化为：\n$$\nE = (\\rho h W^2 - p - D) + D = \\rho h W^2 - p\n$$\n整理后得到一个关键的能量-动量项恒等式：\n$$\n\\rho h W^2 = E + p\n$$\n对于任何物理状态，该量必须为正，因为 $\\rho > 0$、$h \\ge 1$ 且 $W \\ge 1$。\n\n接下来，我们使用守恒动量 $S$ 的定义：\n$$\nS = (\\rho h W^2) v = (E+p) v\n$$\n这使我们能够将速度 $v$ 表示为压力 $p$ 的函数：\n$$\nv(p) = \\frac{S}{E+p}\n$$\n物理约束 $|v|  1$ 转化为 $|S|  |E+p|$。由于 $E+p = \\rho h W^2$ 为正，该条件变为 $|S|  E+p$。这个条件设定了压力的下界：\n$$\np > |S| - E\n$$\n结合约束 $p \\ge 0$，物理上允许的压力必须满足 $p \\ge \\max(0, |S|-E)$。\n\n从 $v(p)$，我们可以将洛伦兹因子的平方 $W^2$ 表示为 $p$ 的函数：\n$$\nW^2(p) = \\frac{1}{1 - v(p)^2} = \\frac{1}{1 - \\left(\\frac{S}{E+p}\\right)^2} = \\frac{(E+p)^2}{(E+p)^2 - S^2}\n$$\n\n现在，我们需要找到一个仅依赖于 $p$ 的自洽关系。我们还没有结合状态方程使用 $D$ 的定义。\n从 $D=\\rho W$，我们得到 $\\rho = D/W$。将此代入比焓方程：\n$$\nh = 1 + \\frac{\\Gamma p}{(\\Gamma-1)\\rho} = 1 + \\frac{\\Gamma p W}{(\\Gamma-1)D}\n$$\n现在，将 $\\rho$ 和 $h$ 的表达式代入恒等式 $E+p=\\rho h W^2$：\n$$\nE+p = \\left(\\frac{D}{W}\\right) \\left(1 + \\frac{\\Gamma p W}{(\\Gamma-1)D}\\right) W^2\n$$\n$$\nE+p = \\frac{D}{W}W^2 + \\frac{D}{W}\\frac{\\Gamma p W}{(\\Gamma-1)D}W^2\n$$\n$$\nE+p = D W + \\frac{\\Gamma p}{\\Gamma-1}W^2\n$$\n该方程只涉及 $p$ 和已知量 $(D,S,E,\\Gamma)$，因为 $W$ 是 $p$ 的函数。我们可以定义一个残差函数 $R(p)$，其根即为所求的压力：\n$$\nR(p) = (E+p) - D W(p) - \\frac{\\Gamma p}{\\Gamma-1} W^2(p) = 0\n$$\n其中 $W(p) = \\sqrt{\\frac{(E+p)^2}{(E+p)^2 - S^2}}$。这就是需要求解的非线性方程。\n\n**步骤 2：推导导数 $\\mathrm{d}R/\\mathrm{d}p$**\n\n对于基于牛顿-拉弗森法的求解器，我们需要 $R(p)$ 的解析导数。\n$$\nR'(p) = \\frac{\\mathrm{d}R}{\\mathrm{d}p} = 1 - D \\frac{\\mathrm{d}W}{\\mathrm{d}p} - \\frac{\\Gamma}{\\Gamma-1} \\frac{\\mathrm{d}}{\\mathrm{d}p}(p W^2)\n$$\n对最后一项使用乘法法则：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}p}(p W^2) = 1 \\cdot W^2 + p \\frac{\\mathrm{d}(W^2)}{\\mathrm{d}p}\n$$\n我们需要 $W$ 和 $W^2$ 对 $p$ 的导数。首先求出 $\\mathrm{d}v/\\mathrm{d}p$ 会很方便：\n$$\nv(p) = \\frac{S}{E+p} \\quad \\implies \\quad \\frac{\\mathrm{d}v}{\\mathrm{d}p} = - \\frac{S}{(E+p)^2} = - \\frac{v}{E+p}\n$$\n现在我们对 $W^2 = (1-v^2)^{-1}$ 求导：\n$$\n\\frac{\\mathrm{d}(W^2)}{\\mathrm{d}p} = -(1-v^2)^{-2}(-2v)\\frac{\\mathrm{d}v}{\\mathrm{d}p} = 2vW^4 \\left(-\\frac{v}{E+p}\\right) = -\\frac{2v^2W^4}{E+p}\n$$\n对于 $W = (W^2)^{1/2}$：\n$$\n\\frac{\\mathrm{d}W}{\\mathrm{d}p} = \\frac{1}{2W}\\frac{\\mathrm{d}(W^2)}{\\mathrm{d}p} = \\frac{1}{2W}\\left(-\\frac{2v^2W^4}{E+p}\\right) = -\\frac{v^2W^3}{E+p}\n$$\n将这些代入 $R'(p)$ 的表达式中：\n$$\nR'(p) = 1 - D\\left(-\\frac{v^2W^3}{E+p}\\right) - \\frac{\\Gamma}{\\Gamma-1}\\left(W^2 + p\\left(-\\frac{2v^2W^4}{E+p}\\right)\\right)\n$$\n$$\nR'(p) = 1 + \\frac{D v^2 W^3}{E+p} - \\frac{\\Gamma W^2}{\\Gamma-1} + \\frac{2 \\Gamma p v^2 W^4}{(\\Gamma-1)(E+p)}\n$$\n此表达式可用于牛顿-拉弗森迭代。\n\n**步骤 3：算法实现**\n\n一个稳健的求根算法构建为牛顿-拉弗森法和二分法的混合体。这既能确保在可能时快速收敛，也能在牛顿步不安全时保证（较慢的）收敛。\n\n1.  **特殊情况**：如果 $S=0$，则 $v=0$ 且 $W=1$。方程显著简化。残差变为线性：\n    $R(p) = (E+p) - D - \\frac{\\Gamma p}{\\Gamma-1} = (\\tau+D+p)-D - \\frac{\\Gamma p}{\\Gamma-1} = \\tau + p - \\frac{\\Gamma p}{\\Gamma-1} = 0$。\n    解出 $p$：$\\tau = p(\\frac{\\Gamma}{\\Gamma-1} - 1) = p(\\frac{1}{\\Gamma-1})$，这得到 $p = \\tau(\\Gamma-1)$。从 $D=\\rho W$ 可得 $\\rho=D$。\n\n2.  **区间限定**：对于一般情况 $S \\neq 0$，我们必须找到一个包含根的区间 $[p_{low}, p_{high}]$。\n    分析表明，对于大的 $p$，$v \\to 0$，$W \\to 1$，且 $R(p) \\approx \\tau - p/(\\Gamma-1)$，趋于 $-\\infty$。对于所提供的测试用例，可以验证条件 $\\tau^2+2\\tau D > S^2$ 成立（或非常接近），这保证了 $R(0) \\ge 0$。\n    因此，根保证在 $[0, \\infty)$ 中。我们可以将 $p_{low} = 0$ 设为区间的下端。上端 $p_{high}$ 可以通过一个初始猜测（例如 $p_{high} = E(\\Gamma-1)$）开始，并迭代增加它直到 $R(p_{high})  0$。\n\n3.  **混合求解器**：\n    a. 初始化区间 $[p_{neg}, p_{pos}]$，使得 $R(p_{neg})  0$ 和 $R(p_{pos}) \\ge 0$。\n    b. 从一个初始压力猜测开始，例如 $p_{sol} = p_{pos}$。\n    c. 迭代直至收敛：\n        i.   计算牛顿-拉弗森步：$\\Delta p = -R(p_{sol})/R'(p_{sol})$。\n        ii.  计算建议的更新：$p_{new} = p_{sol} + \\Delta p$。\n        iii. 计算二分点：$p_{bisect} = (p_{pos} + p_{neg})/2$。\n        iv.  如果牛顿步是安全的（即 $p_{new}$ 在当前区间 $[p_{neg}, p_{pos}]$ 内），则更新 $p_{sol} = p_{new}$。否则，回退到二分法：$p_{sol} = p_{bisect}$。\n        v.  根据 $R(p_{sol})$ 的符号更新区间 $[p_{neg}, p_{pos}]$。\n        vi. 检查是否收敛，例如 $|p_{pos} - p_{neg}|$ 是否低于容差。\n\n4.  **最终恢复**：一旦求得足够精度的根 $p$，计算剩余的原始变量：\n    $$\n    v = \\frac{S}{E+p}\n    $$\n    $$\n    W = \\frac{1}{\\sqrt{1-v^2}}\n    $$\n    $$\n    \\rho = \\frac{D}{W}\n    $$\n解决方案遵循了这些推导和算法设计。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the primitive variable recovery for the given test cases.\n    \"\"\"\n    \n    TOL = 1e-12\n    MAX_ITER = 50\n\n    def recover_primitives(D, S, tau, Gamma):\n        \"\"\"\n        Recovers primitive variables (rho, v, p) from conserved variables (D, S, tau).\n        \"\"\"\n        if D = 0:\n            # Unphysical state, though test cases should be valid.\n            return [np.nan, np.nan, np.nan]\n\n        E = tau + D\n        Gamma_m1 = Gamma - 1\n\n        # Case 1: Special case for S=0 (zero velocity)\n        if abs(S)  1e-14:\n            p = tau * Gamma_m1\n            if p  0:\n                # Unphysical pressure\n                return [np.nan, np.nan, np.nan]\n            rho = D\n            v = 0.0\n            return [rho, v, p]\n\n        # Case 2: Generic case with S != 0. Solve for p.\n        \n        # Define residual R(p) and its derivative R'(p)\n        def R_and_R_prime(p):\n            # Check physical bound on p. p must satisfy E+p > |S|\n            if E + p = abs(S):\n                # Pressure is too low, v >= 1.\n                # R -> -inf as p approaches this limit from above.\n                # Return a large negative value for R and a large positive R' \n                # to push the solver towards higher p.\n                return -1e30, 1e30\n\n            v_val = S / (E + p)\n            v_sq = v_val**2\n            \n            if v_sq >= 1.0:\n                 return -1e30, 1e30\n\n            W_sq = 1.0 / (1.0 - v_sq)\n            W = np.sqrt(W_sq)\n\n            # R(p) = (E+p) - D*W - (Gamma*p/Gamma_m1) * W_sq\n            R_val = (E + p) - D * W - (Gamma * p / Gamma_m1) * W_sq\n\n            # R'(p) = 1 + (D*v^2*W^3)/(E+p) - (Gamma*W^2)/Gamma_m1 + (2*Gamma*p*v^2*W^4)/(Gamma_m1*(E+p))\n            term1_pr = 1.0\n            term2_pr = (D * v_sq * W**3) / (E + p)\n            term3_pr = (Gamma * W_sq) / Gamma_m1\n            term4_pr = (2 * Gamma * p * v_sq * W**4) / (Gamma_m1 * (E + p))\n            R_prime_val = term1_pr + term2_pr - term3_pr + term4_pr\n            \n            return R_val, R_prime_val\n\n        # Bracketing the root\n        # For the given test cases, R(0) >= 0.\n        p_pos = 0.0\n        r_pos, _ = R_and_R_prime(p_pos)\n        \n        if r_pos  0:\n            # This indicates a more complex scenario, not expected for these test cases.\n            # A more robust bracketing by finding the function's maximum would be needed.\n            # However, for this problem set, this branch should not be taken.\n             return [np.nan, np.nan, np.nan]\n        \n        # Find upper bound for bracket where R  0\n        p_neg_guess = max(TOL, E * Gamma_m1) \n        p_neg = p_neg_guess\n        for _ in range(10): # Limit doublings to avoid infinite loops\n            r_neg, _ = R_and_R_prime(p_neg)\n            if r_neg  0:\n                break\n            p_neg *= 2.0\n        else:\n             return [np.nan, np.nan, np.nan] # Failed to find a bracket.\n\n        # Hybrid Newton-Raphson / Bisection solver\n        p_sol = p_pos # Start guess from a known side of the bracket\n        \n        for _ in range(MAX_ITER):\n            # Check for convergence\n            if abs(p_pos - p_neg)  TOL * (p_pos + p_neg + TOL):\n                break\n\n            r_sol, r_prime_sol = R_and_R_prime(p_sol)\n\n            # Safeguarded Newton-Raphson step\n            if abs(r_prime_sol) > TOL:\n                dp = -r_sol / r_prime_sol\n                p_new = p_sol + dp\n                \n                # If Newton step is within bracket, accept it. Otherwise, fall back to bisection.\n                if p_neg  p_new  p_pos:\n                    p_sol = p_new\n                else:\n                    p_sol = 0.5 * (p_pos + p_neg)\n            else:\n                 p_sol = 0.5 * (p_pos + p_neg) # Derivative is zero, use bisection\n            \n            # Update bracket\n            r_new, _ = R_and_R_prime(p_sol)\n            if r_new > 0:\n                p_pos = p_sol\n            else:\n                p_neg = p_sol\n        \n        # Once p is found, recover other primitive variables\n        p = p_sol\n        v = S / (E + p)\n        W = 1.0 / np.sqrt(1.0 - v**2)\n        rho = D / W\n        \n        if rho  0 or p  0:\n            return [np.nan, np.nan, np.nan]\n\n        return [rho, v, p]\n\n    test_cases = [\n        # (D, S, tau, Gamma)\n        (1.04828484, 0.46153846, 0.39017670, 1.33333333),\n        (1.14707867, 3.31578948, 2.48713186, 1.33333333),\n        (1.20000000, 0.00000000, 0.30000000, 1.66666667),\n        (1.15470054, 0.66666668, 0.17863281, 1.66666667),\n        (0.70888121, 6.96482412, 6.31629468, 1.33333333),\n    ]\n\n    results = []\n    for case in test_cases:\n        D_val, S_val, tau_val, Gamma_val = case\n        rho, v, p = recover_primitives(D_val, S_val, tau_val, Gamma_val)\n        \n        # Format the result with 8 decimal places\n        formatted_result = [f\"{x:.8f}\" for x in [rho, v, p]]\n        results.append(f\"[{','.join(formatted_result)}]\")\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3476915"}, {"introduction": "没有数值格式是完美的；高阶格式通常会引入一种“有效粘性” (effective viscosity)，它可能会抑制物理现象的增长。最后一个练习 [@problem_id:3476839] 提供了一种实用的、数据驱动的方法来量化这种效应。通过分析开尔文-亥姆霍兹 (Kelvin-Helmholtz) 不稳定性的模拟数据，你将标定两种流行格式——WENO-Z 和 MP5——的数值粘性，并理解格式的选择和网格分辨率如何影响模拟的精度。", "problem": "考虑在闵可夫斯基空间中的相对论开尔文-亥姆霍兹不稳定性，该不稳定性在相对论流体动力学框架内建模，并使用高分辨率激波捕捉 (HRSC) 格式求解。假设背景为均匀剪切，且扰动为小振幅，以便线性理论适用。令 $A(t)$ 表示波数为 $k$（单位为弧度/米）的傅里叶模式的振幅，其物理增长率为 $\\gamma_{0}(k)$（单位为秒的倒数），因此在没有数值耗散的情况下，有 $A(t) = A_{0} \\exp\\big(\\gamma_{0}(k)\\, t\\big)$。根据经验，HRSC 重构会引入一种有效的数值耗散，对于足够小的 $k$，这种耗散可以建模为一个等效黏性 $\\nu_{\\mathrm{eff}}$（单位为平方米/秒），通过一个扩散算子作用于模式的振幅。在这个低 $k$ 范围内，修正后的振幅遵循\n$$\n\\frac{\\mathrm{d}A}{\\mathrm{d}t} = \\big(\\gamma_{0}(k) - \\sigma(k)\\big)\\, A, \\quad \\text{其中} \\quad \\sigma(k) = \\nu_{\\mathrm{eff}}\\, k^{2},\n$$\n因此观测到的数值增长率为 $\\gamma_{\\mathrm{num}}(k) = \\gamma_{0}(k) - \\nu_{\\mathrm{eff}}\\, k^{2}$。对于在光滑区域引入类二阶导数阻尼的格式，该表达式是修正方程分析的标准结果。\n\n加权基本无振荡 (WENO) 格式（特别是其 WENO-Z 变体）和保持单调性的五阶 (MP5) 重构是数值相对论和引力波源建模中常用的两种 HRSC 格式。在光滑、小振幅的极限下，这两种格式都可以用一个有效的黏性 $\\nu_{\\mathrm{eff}}$ 来表征，该黏性可能取决于网格间距 $\\Delta x$ 和格式的具体细节。我们假设物理增长率从高分辨率参考解中已知，并由以下线性标度关系给出\n$$\n\\gamma_{0}(k) = \\alpha\\, k,\n$$\n其中 $\\alpha$ 是一个常数，单位为米/秒，由剪切配置和流体状态决定。在本问题中，取 $\\alpha = 0.2$ 米/秒。\n\n现提供使用 WENO-Z 和 MP5 格式，在两种网格间距 $\\Delta x = 0.005$ 米和 $\\Delta x = 0.01$ 米下，针对三个模式 $k \\in \\{50, 100, 200\\}$（单位为弧度/米）测得的数值增长率。数据集如下：\n\n- 在 $\\Delta x = 0.005$ 米时：\n  - WENO-Z: $\\gamma_{\\mathrm{num}}(50) = 9.98$ 秒的倒数, $\\gamma_{\\mathrm{num}}(100) = 19.92$ 秒的倒数, $\\gamma_{\\mathrm{num}}(200) = 39.68$ 秒的倒数。\n  - MP5: $\\gamma_{\\mathrm{num}}(50) = 9.9725$ 秒的倒数, $\\gamma_{\\mathrm{num}}(100) = 19.89$ 秒的倒数, $\\gamma_{\\mathrm{num}}(200) = 39.56$ 秒的倒数。\n\n- 在 $\\Delta x = 0.01$ 米时：\n  - WENO-Z: $\\gamma_{\\mathrm{num}}(50) = 9.92$ 秒的倒数, $\\gamma_{\\mathrm{num}}(100) = 19.68$ 秒的倒数, $\\gamma_{\\mathrm{num}}(200) = 38.72$ 秒的倒数。\n  - MP5: $\\gamma_{\\mathrm{num}}(50) = 9.89$ 秒的倒数, $\\gamma_{\\mathrm{num}}(100) = 19.56$ 秒的倒数, $\\gamma_{\\mathrm{num}}(200) = 38.24$ 秒的倒数。\n\n使用这些测量值和模型 $\\gamma_{\\mathrm{num}}(k) = \\gamma_{0}(k) - \\nu_{\\mathrm{eff}}\\, k^{2}$，完成以下任务：\n\n1. 对于每种格式（WENO-Z 和 MP5），在 $\\Delta x = 0.005$ 米的条件下，通过对三个模式进行最小二乘拟合来校准 $\\nu_{\\mathrm{eff}}$。具体来说，将 $\\Delta\\gamma(k) \\equiv \\gamma_{0}(k) - \\gamma_{\\mathrm{num}}(k)$ 拟合到 $\\nu_{\\mathrm{eff}}\\, k^{2}$ 并计算最佳拟合的 $\\nu_{\\mathrm{eff}}$。\n\n2. 对于每种格式，在 $\\Delta x = 0.01$ 米的条件下，重复校准过程并求得 $\\nu_{\\mathrm{eff}}$。\n\n3. 对于每种格式，通过以下公式比较在两种网格间距下校准的黏性，以估算标度指数 $r$：\n$$\nr = \\frac{\\ln\\big(\\nu_{\\mathrm{eff}}(\\Delta x_{2}) / \\nu_{\\mathrm{eff}}(\\Delta x_{1})\\big)}{\\ln\\big(\\Delta x_{2}/\\Delta x_{1}\\big)}.\n$$\n\n4. 使用校准的 $\\nu_{\\mathrm{eff}}$ 以及（在适用情况下）标度律 $\\nu_{\\mathrm{eff}}(\\Delta x) \\propto (\\Delta x)^{r}$，预测以下三个测试案例中的数值增长率：\n   - 测试案例 1 (标准情况): $\\Delta x = 0.005$ 米, $k = 150$ 弧度/米。计算 $\\gamma_{\\mathrm{num}}^{\\mathrm{WENO-Z}}(150)$ 和 $\\gamma_{\\mathrm{num}}^{\\mathrm{MP5}}(150)$，单位为秒的倒数。\n   - 测试案例 2 (边界情况): $\\Delta x = 0.005$ 米, $k = 0$ 弧度/米。计算 $\\gamma_{\\mathrm{num}}^{\\mathrm{WENO-Z}}(0)$ 和 $\\gamma_{\\mathrm{num}}^{\\mathrm{MP5}}(0)$，单位为秒的倒数。\n   - 测试案例 3 (接近奈奎斯特频率的边缘情况): $\\Delta x = 0.0075$ 米, $k = 600$ 弧度/米。首先使用标度指数 $r$ 和校准的 $\\nu_{\\mathrm{eff}}(0.005)$ 估算每种格式的 $\\nu_{\\mathrm{eff}}(0.0075)$，然后计算 $\\gamma_{\\mathrm{num}}^{\\mathrm{WENO-Z}}(600)$ 和 $\\gamma_{\\mathrm{num}}^{\\mathrm{MP5}}(600)$，单位为秒的倒数。同时计算比率 $\\nu_{\\mathrm{eff}}^{\\mathrm{WENO-Z}}(0.0075) / \\nu_{\\mathrm{eff}}^{\\mathrm{MP5}}(0.0075)$（无量纲）。\n\n所有数值答案中，增长率必须以秒的倒数表示，黏性比率必须以无量纲形式表示，输出中不带单位符号。角度以弧度为单位。程序所需的最终输出格式为单行文本，其中包含一个由方括号括起来的逗号分隔列表，每个测试案例对应一个包含三个浮点数的子列表：\n$$\n[[\\gamma_{\\mathrm{num}}^{\\mathrm{WENO-Z}}(k), \\gamma_{\\mathrm{num}}^{\\mathrm{MP5}}(k), \\rho]_{\\text{案例 1}}, [\\dots]_{\\text{案例 2}}, [\\dots]_{\\text{案例 3}}],\n$$\n其中 $\\rho$ 等于相关网格间距下的黏性比率（前两个案例使用 $\\Delta x = 0.005$ 米下的比率；第三个案例使用 $\\Delta x = 0.0075$ 米下的比率）。请确保程序是自包含的，并产生这单行输出。", "solution": "在尝试求解之前，对问题进行验证。\n\n### 第 1 步：提取已知条件\n\n问题陈述中提供了以下数据和模型：\n- **数值增长率模型**：对于波数为 $k$ 的傅里叶模式，观测到的数值增长率 $\\gamma_{\\mathrm{num}}(k)$ 由下式给出\n$$ \\gamma_{\\mathrm{num}}(k) = \\gamma_{0}(k) - \\sigma(k) $$\n其中 $\\gamma_{0}(k)$ 是物理增长率，$\\sigma(k)$ 代表数值耗散。\n- **数值耗散模型**：耗散项建模为\n$$ \\sigma(k) = \\nu_{\\mathrm{eff}} k^{2} $$\n其中 $\\nu_{\\mathrm{eff}}$ 是等效数值黏性。\n- **物理增长率模型**：物理增长率与波数呈线性标度关系：\n$$ \\gamma_{0}(k) = \\alpha k $$\n- **比例常数**：$\\alpha = 0.2$ 米/秒。\n- **用于校准的波数**：$k \\in \\{50, 100, 200\\}$ 弧度/米。\n- **网格间距**：$\\Delta x_1 = 0.005$ 米 和 $\\Delta x_2 = 0.01$ 米。\n- **在 $\\Delta x_1 = 0.005$ 米处测得的数据**：\n  - WENO-Z: $\\gamma_{\\mathrm{num}}(50) = 9.98 \\text{ s}^{-1}$, $\\gamma_{\\mathrm{num}}(100) = 19.92 \\text{ s}^{-1}$, $\\gamma_{\\mathrm{num}}(200) = 39.68 \\text{ s}^{-1}$。\n  - MP5: $\\gamma_{\\mathrm{num}}(50) = 9.9725 \\text{ s}^{-1}$, $\\gamma_{\\mathrm{num}}(100) = 19.89 \\text{ s}^{-1}$, $\\gamma_{\\mathrm{num}}(200) = 39.56 \\text{ s}^{-1}$。\n- **在 $\\Delta x_2 = 0.01$ 米处测得的数据**：\n  - WENO-Z: $\\gamma_{\\mathrm{num}}(50) = 9.92 \\text{ s}^{-1}$, $\\gamma_{\\mathrm{num}}(100) = 19.68 \\text{ s}^{-1}$, $\\gamma_{\\mathrm{num}}(200) = 38.72 \\text{ s}^{-1}$。\n  - MP5: $\\gamma_{\\mathrm{num}}(50) = 9.89 \\text{ s}^{-1}$, $\\gamma_{\\mathrm{num}}(100) = 19.56 \\text{ s}^{-1}$, $\\gamma_{\\mathrm{num}}(200) = 38.24 \\text{ s}^{-1}$。\n- **标度指数公式**：$r = \\frac{\\ln(\\nu_{\\mathrm{eff}}(\\Delta x_{2}) / \\nu_{\\mathrm{eff}}(\\Delta x_{1}))}{\\ln(\\Delta x_{2}/\\Delta x_{1})}$。\n- **预测测试案例**：\n  1. $\\Delta x = 0.005$ 米, $k = 150$ 弧度/米。\n  2. $\\Delta x = 0.005$ 米, $k = 0$ 弧度/米。\n  3. $\\Delta x = 0.0075$ 米, $k = 600$ 弧度/米。\n- **要求输出**：一个列表的列表，其中包含每个测试案例的 `[`$\\gamma_{\\mathrm{num}}^{\\mathrm{WENO-Z}}(k)$, $\\gamma_{\\mathrm{num}}^{\\mathrm{MP5}}(k)$, $\\rho$ `]`，这里 $\\rho$ 是有效黏性之比。\n\n### 第 2 步：使用提取的已知条件进行验证\n\n- **科学依据**：该问题在计算物理和数值分析领域有坚实的科学基础。使用修正方程分析将数值耗散建模为等效黏性是分析像 WENO 和 MP5 这类数值格式的标准技术。开尔文-亥姆霍兹不稳定性及其线性增长阶段是流体动力学中的经典课题。\n- **适定性与一致性**：该问题提供了执行所要求任务的所有必要数据和方程。任务从校准到预测，逻辑顺序清晰。所提供的数值数据与提出的模型 $\\gamma_{\\mathrm{num}}(k) = \\alpha k - \\nu_{\\mathrm{eff}} k^2$ 内部一致。例如，对于每个数据集，量 $(\\gamma_0(k) - \\gamma_{\\mathrm{num}}(k))/k^2$ 都是恒定的，这表明数据是为完美匹配该模型而构建的。\n- **客观性**：问题以客观、定量的术语陈述，没有主观或推测性内容。\n- **对真实性的评判**：一个次要的评判点涉及测试案例 3，它涉及在网格间距为 $\\Delta x = 0.0075 \\text{ m}$ 时的波数 $k=600 \\text{ rad/m}$。无量纲量 $k \\Delta x = 600 \\times 0.0075 = 4.5$。此网格的奈奎斯特波数为 $k_{\\text{Ny}} = \\pi / \\Delta x \\approx 418.9 \\text{ rad/m}$。因此，所选波数超出了奈奎斯特极限，在这个区域，基于连续介质的修正方程分析不再严格有效，且混叠效应占主导地位。然而，该问题可以被解释为应用所推导模型的一个形式化练习，即使在其已确立的有效域之外。这并不会使问题无效，但它是一个值得注意的物理上的不一致之处。\n\n### 第 3 步：结论与行动\n\n该问题被判定为**有效**，因为它构成了一个在计算物理学领域内适定、有科学依据且可形式化的数据分析和模型应用练习。将继续进行求解，并附上关于测试案例 3 的物理解释的说明。\n\n### 解题过程\n\n解题过程遵循问题陈述中列举的四个任务进行。\n\n**任务 1 和 2：校准有效黏性 $\\nu_{\\mathrm{eff}}$**\n\n我们的任务是确定每种格式（WENO-Z、MP5）在每种网格间距（$\\Delta x = 0.005$ 米和 $\\Delta x = 0.01$ 米）下的有效黏性 $\\nu_{\\mathrm{eff}}$。模型方程为 $\\gamma_{\\mathrm{num}}(k) = \\gamma_{0}(k) - \\nu_{\\mathrm{eff}} k^2$。这可以重新排列以定义由耗散引起的增长率减小量 $\\Delta\\gamma(k)$：\n$$ \\Delta\\gamma(k) \\equiv \\gamma_{0}(k) - \\gamma_{\\mathrm{num}}(k) = \\nu_{\\mathrm{eff}} k^2 $$\n我们必须将数据 $(\\Delta\\gamma(k_i), k_i^2)$ 对线性模型 $y = mx$ 进行最小二乘拟合，其中 $y = \\Delta\\gamma$ 且 $x = k^2$。最佳拟合斜率 $m = \\nu_{\\mathrm{eff}}$ 由下式给出：\n$$ \\nu_{\\mathrm{eff}} = \\frac{\\sum_i (k_i^2) (\\Delta\\gamma(k_i))}{\\sum_i (k_i^2)^2} = \\frac{\\sum_i k_i^2 (\\alpha k_i - \\gamma_{\\mathrm{num}}(k_i))}{\\sum_i k_i^4} $$\n用于校准的波数 $k \\in \\{50, 100, 200\\}$ 的物理增长率为：\n- $\\gamma_{0}(50) = 0.2 \\times 50 = 10 \\text{ s}^{-1}$\n- $\\gamma_{0}(100) = 0.2 \\times 100 = 20 \\text{ s}^{-1}$\n- $\\gamma_{0}(200) = 0.2 \\times 200 = 40 \\text{ s}^{-1}$\n\n对于每种情况，我们计算 $\\Delta\\gamma(k_i)$ 然后计算 $\\nu_{\\mathrm{eff}}$。\n\n1.  **WENO-Z 在 $\\Delta x = 0.005$ 米时：**\n    - $\\Delta\\gamma(50) = 10 - 9.98 = 0.02$\n    - $\\Delta\\gamma(100) = 20 - 19.92 = 0.08$\n    - $\\Delta\\gamma(200) = 40 - 39.68 = 0.32$\n    由于 $(\\Delta\\gamma)/k^2$ 是一个常数 ($0.02/50^2 = 8 \\times 10^{-6}$)，拟合是精确的。\n    $\\nu_{\\mathrm{eff}}^{\\mathrm{WENO-Z}}(0.005) = 8.0 \\times 10^{-6} \\text{ m}^2/\\text{s}$。\n\n2.  **MP5 在 $\\Delta x = 0.005$ 米时：**\n    - $\\Delta\\gamma(50) = 10 - 9.9725 = 0.0275$\n    - $\\Delta\\gamma(100) = 20 - 19.89 = 0.11$\n    - $\\Delta\\gamma(200) = 40 - 39.56 = 0.44$\n    由于 $(\\Delta\\gamma)/k^2$ 是一个常数 ($0.0275/50^2 = 1.1 \\times 10^{-5}$)，拟合是精确的。\n    $\\nu_{\\mathrm{eff}}^{\\mathrm{MP5}}(0.005) = 1.1 \\times 10^{-5} \\text{ m}^2/\\text{s}$。\n\n3.  **WENO-Z 在 $\\Delta x = 0.01$ 米时：**\n    - $\\Delta\\gamma(50) = 10 - 9.92 = 0.08$\n    - $\\Delta\\gamma(100) = 20 - 19.68 = 0.32$\n    - $\\Delta\\gamma(200) = 40 - 38.72 = 1.28$\n    由于 $(\\Delta\\gamma)/k^2$ 是一个常数 ($0.08/50^2 = 3.2 \\times 10^{-5}$)，拟合是精确的。\n    $\\nu_{\\mathrm{eff}}^{\\mathrm{WENO-Z}}(0.01) = 3.2 \\times 10^{-5} \\text{ m}^2/\\text{s}$。\n\n4.  **MP5 在 $\\Delta x = 0.01$ 米时：**\n    - $\\Delta\\gamma(50) = 10 - 9.89 = 0.11$\n    - $\\Delta\\gamma(100) = 20 - 19.56 = 0.44$\n    - $\\Delta\\gamma(200) = 40 - 38.24 = 1.76$\n    由于 $(\\Delta\\gamma)/k^2$ 是一个常数 ($0.11/50^2 = 4.4 \\times 10^{-5}$)，拟合是精确的。\n    $\\nu_{\\mathrm{eff}}^{\\mathrm{MP5}}(0.01) = 4.4 \\times 10^{-5} \\text{ m}^2/\\text{s}$。\n\n**任务 3：估算标度指数 $r$**\n\n标度指数 $r$ 表征了有效黏性如何随网格间距变化，遵循 $\\nu_{\\mathrm{eff}}(\\Delta x) \\propto (\\Delta x)^r$。它使用以下公式计算：\n$$ r = \\frac{\\ln\\big(\\nu_{\\mathrm{eff}}(\\Delta x_{2}) / \\nu_{\\mathrm{eff}}(\\Delta x_{1})\\big)}{\\ln\\big(\\Delta x_{2}/\\Delta x_{1}\\big)} $$\n这里，$\\Delta x_1 = 0.005$ 米，$\\Delta x_2 = 0.01$ 米，所以 $\\Delta x_2 / \\Delta x_1 = 2$。\n\n- **对于 WENO-Z：**\n  $$ r_{\\mathrm{WENO-Z}} = \\frac{\\ln( (3.2 \\times 10^{-5}) / (8.0 \\times 10^{-6}) )}{\\ln(2)} = \\frac{\\ln(4)}{\\ln(2)} = \\frac{2 \\ln(2)}{\\ln(2)} = 2 $$\n- **对于 MP5：**\n  $$ r_{\\mathrm{MP5}} = \\frac{\\ln( (4.4 \\times 10^{-5}) / (1.1 \\times 10^{-5}) )}{\\ln(2)} = \\frac{\\ln(4)}{\\ln(2)} = 2 $$\n在所提供数据描述的范围内，两种格式的有效黏性都表现出与网格间距的二阶标度关系，即 $r=2$。这意味着对于某个特定于每种格式的常数 $C$，有 $\\nu_{\\mathrm{eff}} = C (\\Delta x)^2$。\n\n**任务 4：对测试案例进行预测**\n\n我们现在使用校准后的模型来预测三个测试案例的结果。\n\n**测试案例 1：$\\Delta x = 0.005$ 米, $k = 150$ 弧度/米**\n我们使用在 $\\Delta x = 0.005$ 米处校准的黏性。物理增长率为 $\\gamma_0(150) = 0.2 \\times 150 = 30 \\text{ s}^{-1}$。\n- **WENO-Z**:\n  $\\gamma_{\\mathrm{num}}^{\\mathrm{WENO-Z}}(150) = 30 - \\nu_{\\mathrm{eff}}^{\\mathrm{WENO-Z}}(0.005) \\times 150^2 = 30 - (8.0 \\times 10^{-6}) \\times 22500 = 30 - 0.18 = 29.82 \\text{ s}^{-1}$。\n- **MP5**:\n  $\\gamma_{\\mathrm{num}}^{\\mathrm{MP5}}(150) = 30 - \\nu_{\\mathrm{eff}}^{\\mathrm{MP5}}(0.005) \\times 150^2 = 30 - (1.1 \\times 10^{-5}) \\times 22500 = 30 - 0.2475 = 29.7525 \\text{ s}^{-1}$。\n- **黏性比率 $\\rho_1$**:\n  $\\rho_1 = \\frac{\\nu_{\\mathrm{eff}}^{\\mathrm{WENO-Z}}(0.005)}{\\nu_{\\mathrm{eff}}^{\\mathrm{MP5}}(0.005)} = \\frac{8.0 \\times 10^{-6}}{1.1 \\times 10^{-5}} = \\frac{8}{11}$。\n\n**测试案例 2：$\\Delta x = 0.005$ 米, $k = 0$ 弧度/米**\n这个案例对应于解的平均值（直流分量）的演化。\n- 物理增长率为 $\\gamma_0(0) = \\alpha \\times 0 = 0$。\n- 数值耗散项为 $\\sigma(0) = \\nu_{\\mathrm{eff}} \\times 0^2 = 0$。\n- 因此，对于两种格式，数值增长率均为：\n  $\\gamma_{\\mathrm{num}}(0) = \\gamma_0(0) - \\sigma(0) = 0 \\text{ s}^{-1}$。\n  这是守恒型数值格式的一个基本性质：它们不应产生或破坏守恒量的平均值。\n- **黏性比率 $\\rho_2$**:\n  该比率在 $\\Delta x = 0.005$ 米处评估，与前一个案例相同：$\\rho_2 = 8/11$。\n\n**测试案例 3：$\\Delta x = 0.0075$ 米, $k = 600$ 弧度/米**\n如验证中所述，在此处应用该模型是一种形式上的外推，因为 $k \\Delta x = 4.5 > \\pi$，这超出了奈奎斯特频率。我们按指示继续进行。首先，我们使用标度关系 $\\nu_{\\mathrm{eff}}(\\Delta x) \\propto (\\Delta x)^2$ 来估算 $\\nu_{\\mathrm{eff}}(0.0075)$：\n$$ \\nu_{\\mathrm{eff}}(0.0075) = \\nu_{\\mathrm{eff}}(0.005) \\left(\\frac{0.0075}{0.005}\\right)^2 = \\nu_{\\mathrm{eff}}(0.005) \\times (1.5)^2 = 2.25 \\times \\nu_{\\mathrm{eff}}(0.005) $$\n- **外推黏性**：\n  - $\\nu_{\\mathrm{eff}}^{\\mathrm{WENO-Z}}(0.0075) = 2.25 \\times (8.0 \\times 10^{-6}) = 1.8 \\times 10^{-5} \\text{ m}^2/\\text{s}$。\n  - $\\nu_{\\mathrm{eff}}^{\\mathrm{MP5}}(0.0075) = 2.25 \\times (1.1 \\times 10^{-5}) = 2.475 \\times 10^{-5} \\text{ m}^2/\\text{s}$。\n物理增长率为 $\\gamma_0(600) = 0.2 \\times 600 = 120 \\text{ s}^{-1}$。\n- **WENO-Z**:\n  $\\gamma_{\\mathrm{num}}^{\\mathrm{WENO-Z}}(600) = 120 - (1.8 \\times 10^{-5}) \\times 600^2 = 120 - (1.8 \\times 10^{-5}) \\times 360000 = 120 - 64.8 = 55.2 \\text{ s}^{-1}$。\n- **MP5**:\n  $\\gamma_{\\mathrm{num}}^{\\mathrm{MP5}}(600) = 120 - (2.475 \\times 10^{-5}) \\times 600^2 = 120 - (2.475 \\times 10^{-5}) \\times 360000 = 120 - 89.1 = 30.9 \\text{ s}^{-1}$。\n- **黏性比率 $\\rho_3$**:\n 由于两种黏性都以相同的指数进行标度，该比率与 $\\Delta x$ 无关。\n $\\rho_3 = \\frac{\\nu_{\\mathrm{eff}}^{\\mathrm{WENO-Z}}(0.0075)}{\\nu_{\\mathrm{eff}}^{\\mathrm{MP5}}(0.0075)} = \\frac{1.8 \\times 10^{-5}}{2.475 \\times 10^{-5}} = \\frac{1.8}{2.475} = \\frac{8}{11}$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of calibrating and applying a model for numerical dissipation\n    in HRSC schemes based on provided growth rate data.\n    \"\"\"\n\n    # --- Givens ---\n    alpha = 0.2  # m/s\n    k_calib = np.array([50.0, 100.0, 200.0])  # rad/m\n\n    # Data is structured as a dictionary: {scheme: {dx: [gamma_num array]}}\n    gamma_num_data = {\n        'WENO-Z': {\n            0.005: np.array([9.98, 19.92, 39.68]),\n            0.01: np.array([9.92, 19.68, 38.72]),\n        },\n        'MP5': {\n            0.005: np.array([9.9725, 19.89, 39.56]),\n            0.01: np.array([9.89, 19.56, 38.24]),\n        },\n    }\n\n    test_cases = [\n        # (dx, k)\n        (0.005, 150.0),\n        (0.005, 0.0),\n        (0.0075, 600.0),\n    ]\n    dx_ref = 0.005 # Reference grid spacing for scaling\n\n    # --- Calculations ---\n\n    # Tasks 1  2: Calibrate nu_eff for each scheme and dx\n    # The physical growth rate is gamma_0 = alpha * k\n    gamma_0_calib = alpha * k_calib\n    \n    # Store calculated nu_eff values: {scheme: {dx: nu_eff}}\n    nu_effs = {}\n\n    for scheme, dx_data in gamma_num_data.items():\n        nu_effs[scheme] = {}\n        for dx, gamma_num_values in dx_data.items():\n            # Calculate dissipation-induced growth rate reduction\n            delta_gamma = gamma_0_calib - gamma_num_values\n            \n            # Perform least-squares fit for nu_eff from:\n            # delta_gamma = nu_eff * k^2\n            # nu_eff = sum(k^2 * delta_gamma) / sum((k^2)^2)\n            k_sq = k_calib**2\n            numerator = np.sum(k_sq * delta_gamma)\n            denominator = np.sum(k_sq**2)\n            \n            # Note: For this problem, the data gives a perfect fit, so we could\n            # simply calculate nu_eff = delta_gamma[0] / k_sq[0]. The general\n            # formula is used for robustness.\n            nu_effs[scheme][dx] = numerator / denominator\n\n    # Task 3: Estimate scaling exponent r\n    # r = log(nu(dx2)/nu(dx1)) / log(dx2/dx1)\n    dx1, dx2 = 0.005, 0.01\n    log_dx_ratio = np.log(dx2 / dx1)\n    \n    r_scaling = {}\n    for scheme in gamma_num_data.keys():\n        log_nu_ratio = np.log(nu_effs[scheme][dx2] / nu_effs[scheme][dx1])\n        r_scaling[scheme] = log_nu_ratio / log_dx_ratio\n\n    # --- Task 4: Predictions for Test Cases ---\n    results = []\n\n    # Get reference viscosities and their ratio\n    nu_w_ref = nu_effs['WENO-Z'][dx_ref]\n    nu_m_ref = nu_effs['MP5'][dx_ref]\n    rho_ref = nu_w_ref / nu_m_ref\n\n    # Process each test case\n    for dx_test, k_test in test_cases:\n        \n        # Calculate viscosity for the current test case dx\n        # nu_eff(dx_test) = nu_eff(dx_ref) * (dx_test/dx_ref)^r\n        # Since r=2 for both, the scaling factor is the same.\n        scaling_factor = (dx_test / dx_ref) ** r_scaling['WENO-Z']\n\n        nu_w_test = nu_w_ref * scaling_factor\n        nu_m_test = nu_m_ref * scaling_factor\n        \n        # The viscosity ratio is constant because r is the same for both schemes\n        rho_test = nu_w_test / nu_m_test\n\n        # Physical growth rate\n        gamma_0_test = alpha * k_test\n        \n        # Numerical growth rate: gamma_num = gamma_0 - nu_eff * k^2\n        gamma_num_w = gamma_0_test - nu_w_test * k_test**2\n        gamma_num_m = gamma_0_test - nu_m_test * k_test**2\n        \n        results.append([gamma_num_w, gamma_num_m, rho_test])\n\n    # Final print statement in the exact required format.\n    # The format [[...], [...], [...]] is achieved by stringifying each sublist.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3476839"}]}