{"hands_on_practices": [{"introduction": "为了在数值模拟中有效地使用耗散格式，我们首先必须从根本上理解离散算子与其所近似的连续微分之间的关系。本练习将深入探讨Kreiss-Oliger (KO)耗散算子的核心构造。通过运用泰勒展开，您将推导出该算子如何近似一个高阶空间导数，并确定其主导误差项的行为，这对于理解其在网格细化下的收敛性质至关重要。[@problem_id:3481434] 这项实践不仅能加深您对有限差分法精度的理论理解，还能通过编写代码进行收敛性测试，锻炼您验证数值算法正确性的关键技能。", "problem": "考虑在一维空间中，在线方法（Method of Lines, MoL）的框架下，添加 Kreiss–Oliger (KO) 数值耗散来稳定线性化引力波传播的高阶有限差分演化。Kreiss–Oliger (KO) 耗散是一种线性高阶平滑算子，其设计目的是选择性地衰减网格尺度的振荡，同时在网格加密时，对于足够光滑的解，该项趋于零。\n\n在一个长度为 $2\\pi$ 的周期性域（角度以弧度为单位）上进行研究，光滑场 $u(x)$ 在一个包含 $N$ 个点、间距为 $\\Delta x = \\frac{2\\pi}{N}$ 的均匀网格上采样。定义前向和后向差分算子\n$$\nD_+ u_i = \\frac{u_{i+1} - u_i}{\\Delta x}, \\qquad D_- u_i = \\frac{u_i - u_{i-1}}{\\Delta x},\n$$\n其中索引是周期性的。对于整数阶参数 $p \\geq 2$，定义 KO 算子为\n$$\nQ_i = \\sigma (-1)^{p+1} \\Delta x^{2p-1}\\, \\left(D_+^p D_-^p u\\right)_i,\n$$\n其中 $D_+^p$ 和 $D_-^p$ 表示 $p$ 次复合，$\\sigma$ 是一个无量纲常数。在数值相对论的通常实践中，$\\sigma$ 的量级取为 1，并确保 KO 项随着网格加密而迅速消失。\n\n从适用于数值相对论和引力波的第一性原理出发，基于：\n- 前向和后向有限差分算子 $D_+$ 和 $D_-$ 的定义，\n- $u(x)$ 在网格点附近的泰勒展开，\n- 以及光滑周期函数的傅里叶表示，\n推导当 $\\Delta x \\to 0$ 时，对于光滑的 $u(x)$，KO 项 $Q$ 的渐近行为，包括其收敛阶和主导误差项的结构。您的推导必须识别出 $D_+^p D_-^p$ 在光滑 $u(x)$ 上所逼近的连续算子，并定量地确定 $Q$ 如何随 $\\Delta x$ 和 $u$ 的主导导数进行缩放，过程中不得使用任何快捷公式或预先给定的误差估计。\n\n然后实现一个程序，通过在测试函数上将离散 KO 算子与相应的连续目标进行比较，来经验性地测量主导误差项的收敛阶\n$$\nu(x) = \\sin(k x),\n$$\n其中 $k$ 为整数波数（角度以弧度为单位）。对于每个测试用例，分别在具有 $N$ 和 $2N$ 个点的两个网格上计算离散 KO 算子 $Q$，并将其与您识别出的主导导数所构建的连续目标进行比较。将误差定义为离散 KO 输出与在网格点上求值的连续目标之间的最大范数（上确界范数）差。设 $E(\\Delta x)$ 为此误差，并按如下方式测量经验收敛阶\n$$\nr = \\frac{\\ln\\left(E(\\Delta x)\\right) - \\ln\\left(E\\left(\\frac{\\Delta x}{2}\\right)\\right)}{\\ln\\left(\\Delta x\\right) - \\ln\\left(\\frac{\\Delta x}{2}\\right)}.\n$$\n\n使用 $\\sigma = 1$。所有计算中角度必须以弧度为单位。除此角度规定外，不需要其他物理单位。\n\n测试套件：\n- 案例 1 (通用高阶，理想路径)：$p=2$, $N=128$, $k=3$。\n- 案例 2 (更高耗散阶)：$p=3$, $N=128$, $k=3$。\n- 案例 3 (甚至更高的耗散阶)：$p=4$, $N=128$, $k=3$。\n- 案例 4 (边界分辨率)：$p=2$, $N=16$, $k=3$。\n- 案例 5 (边缘情况：近奈奎斯特频率内容)：$p=2$, $N=64$, $k=31$。\n\n您的程序应生成单行输出，其中包含五个测试用例的结果，按顺序排列。结果是一个逗号分隔的十进制数列表，四舍五入到三位小数，并用方括号括起来，例如 $[r_1,r_2,r_3,r_4,r_5]$。", "solution": "该问题要求从第一性原理推导 Kreiss-Oliger (KO) 耗散算子的渐近行为，然后通过数值实现来验证其主导误差项的收敛性质。\n\n首先，我们验证问题陈述的有效性。给定条件如下：\n- 一个长度为 $2\\pi$ 的周期性域，其上有一个包含 $N$ 个点、间距为 $\\Delta x = \\frac{2\\pi}{N}$ 的均匀网格。\n- 一个光滑标量场 $u(x)$。\n- 有限差分算子：$D_+ u_i = \\frac{u_{i+1} - u_i}{\\Delta x}$ 和 $D_- u_i = \\frac{u_i - u_{i-1}}{\\Delta x}$，索引具有周期性。\n- Kreiss-Oliger (KO) 算子：$Q_i = \\sigma (-1)^{p+1} \\Delta x^{2p-1}\\, \\left(D_+^p D_-^p u\\right)_i$，其中 $p \\geq 2$ 是整数，$\\sigma$ 是无量纲常数。\n- 数值任务涉及测试函数 $u(x) = \\sin(k x)$、计算经验收敛阶 $r$ 的特定公式，以及五个具有指定参数 $p$、$N$ 和 $k$ 的测试用例。对于数值部分，$\\sigma=1$。\n\n该问题在偏微分方程数值分析领域具有科学依据。有限差分算子的定义和 KO 项的结构是标准的。问题是适定的（well-posed），提供了执行解析推导和数值计算所需的所有信息。任务在数学上是严谨的，没有违反任何物理或逻辑原则。因此，该问题被认为是有效的。\n\n我们开始进行推导。我们的目标是确定 $D_+^p D_-^p$ 所逼近的连续算子，并找到主导误差项。我们将使用泰勒级数展开。\n\n在具有周期性边界条件的网格上，算子 $D_+$ 和 $D_-$ 是可交换的。因此，算子 $D_+^p D_-^p$ 等价于算子 $D_+D_-$ 的 $p$ 次复合，我们记为 $(D_+D_-)^p$。让我们首先分析基本算子 $D_+D_-$。\n$$\n(D_+D_-) u_i = D_+ \\left( \\frac{u_i - u_{i-1}}{\\Delta x} \\right) = \\frac{1}{\\Delta x} \\left( \\frac{u_{i+1} - u_i}{\\Delta x} - \\frac{u_i - u_{i-1}}{\\Delta x} \\right) = \\frac{u_{i+1} - 2u_i + u_{i-1}}{(\\Delta x)^2}.\n$$\n这是二阶导数的标准三点中心差分格式。为了找到其连续极限和主导误差，我们使用 $u(x)$ 在网格点 $x_i$ 附近的泰勒级数展开：\n$$\nu_{i\\pm 1} = u(x_i \\pm \\Delta x) = u_i \\pm \\Delta x \\frac{\\partial u}{\\partial x}\\bigg|_i + \\frac{(\\Delta x)^2}{2!} \\frac{\\partial^2 u}{\\partial x^2}\\bigg|_i \\pm \\frac{(\\Delta x)^3}{3!} \\frac{\\partial^3 u}{\\partial x^3}\\bigg|_i + \\frac{(\\Delta x)^4}{4!} \\frac{\\partial^4 u}{\\partial x^4}\\bigg|_i + O((\\Delta x)^5).\n$$\n将这些展开式代入 $(D_+D_-)u_i$ 的表达式中：\n$$\nu_{i+1} - 2u_i + u_{i-1} = \\left( u_i + \\Delta x u'_i + \\frac{(\\Delta x)^2}{2} u''_i + \\frac{(\\Delta x)^3}{6} u'''_i + \\frac{(\\Delta x)^4}{24} u^{(4)}_i \\right) - 2u_i + \\left( u_i - \\Delta x u'_i + \\frac{(\\Delta x)^2}{2} u''_i - \\frac{(\\Delta x)^3}{6} u'''_i + \\frac{(\\Delta x)^4}{24} u^{(4)}_i \\right) + O((\\Delta x)^6).\n$$\n由于对称性，$\\Delta x$ 的奇数次幂项相互抵消。对偶数次幂的系数求和得到：\n$$\nu_{i+1} - 2u_i + u_{i-1} = (\\Delta x)^2 \\frac{\\partial^2 u}{\\partial x^2}\\bigg|_i + \\frac{2(\\Delta x)^4}{24} \\frac{\\partial^4 u}{\\partial x^4}\\bigg|_i + O((\\Delta x)^6) = (\\Delta x)^2 \\frac{\\partial^2 u}{\\partial x^2}\\bigg|_i + \\frac{(\\Delta x)^4}{12} \\frac{\\partial^4 u}{\\partial x^4}\\bigg|_i + O((\\Delta x)^6).\n$$\n两边除以 $(\\Delta x)^2$，我们得到算子展开式：\n$$\n(D_+D_-) = \\frac{\\partial^2}{\\partial x^2} + \\frac{(\\Delta x)^2}{12} \\frac{\\partial^4}{\\partial x^4} + O((\\Delta x)^4).\n$$\n算子 $D_+D_-$ 逼近二阶偏导数 $\\frac{\\partial^2}{\\partial x^2}$，其主导误差项的阶为 $(\\Delta x)^2$。\n\n现在，我们考虑完整的算子 $(D_+D_-)^p$。我们可以对算子表达式应用二项式展开：\n$$\n(D_+D_-)^p = \\left( \\frac{\\partial^2}{\\partial x^2} + \\frac{(\\Delta x)^2}{12} \\frac{\\partial^4}{\\partial x^4} + O((\\Delta x)^4) \\right)^p.\n$$\n对于小的 $\\Delta x$，主导项为：\n$$\n(D_+D_-)^p = \\left(\\frac{\\partial^2}{\\partial x^2}\\right)^p + p \\left(\\frac{\\partial^2}{\\partial x^2}\\right)^{p-1} \\left( \\frac{(\\Delta x)^2}{12} \\frac{\\partial^4}{\\partial x^4} \\right) + O((\\Delta x)^4).\n$$\n化简后得到：\n$$\n(D_+^p D_-^p) u = \\frac{\\partial^{2p} u}{\\partial x^{2p}} + \\frac{p (\\Delta x)^2}{12} \\frac{\\partial^{2p+2} u}{\\partial x^{2p+2}} + O((\\Delta x)^4).\n$$\n由此，我们确定 $D_+^p D_-^p$ 在光滑 $u(x)$ 上所逼近的连续算子为 $\\frac{\\partial^{2p}}{\\partial x^{2p}}$。该逼近是二阶精度的。\n\n接下来，我们分析完整的 KO 项 $Q_i$：\n$$\nQ_i = \\sigma (-1)^{p+1} \\Delta x^{2p-1}\\, \\left(D_+^p D_-^p u\\right)_i.\n$$\n代入我们对差分算子的展开式：\n$$\nQ_i = \\sigma (-1)^{p+1} \\Delta x^{2p-1} \\left( \\frac{\\partial^{2p} u}{\\partial x^{2p}}\\bigg|_i + \\frac{p (\\Delta x)^2}{12} \\frac{\\partial^{2p+2} u}{\\partial x^{2p+2}}\\bigg|_i + O((\\Delta x)^4) \\right).\n$$\n当 $\\Delta x \\to 0$ 时，$Q_i$ 的渐近行为由第一项主导：\n$$\nQ_i = \\sigma (-1)^{p+1} \\Delta x^{2p-1} \\frac{\\partial^{2p} u}{\\partial x^{2p}}\\bigg|_i + \\sigma (-1)^{p+1} \\frac{p (\\Delta x)^{2p+1}}{12} \\frac{\\partial^{2p+2} u}{\\partial x^{2p+2}}\\bigg|_i + O((\\Delta x)^{2p+3}).\n$$\n因此，KO 项 $Q$ 按 $\\Delta x^{2p-1}$ 缩放，其大小与场 $u(x)$ 的 $(2p)$ 阶导数成正比。\n\n对于数值部分，我们被要求测量主导误差项的收敛阶。误差定义为离散 KO 算子 $Q$与“连续目标”之间的差。该目标由我们识别出的主导导数 $\\frac{\\partial^{2p}}{\\partial x^{2p}}$ 构建。因此，$Q$ 的连续目标是：\n$$\nQ_{\\text{cont}}(x) = \\sigma (-1)^{p+1} \\Delta x^{2p-1} \\frac{\\partial^{2p} u}{\\partial x^{2p}}(x).\n$$\n误差 $E(x)$ 是离散算子与此连续目标之间的差：\n$$\nE(x) = Q_i - Q_{\\text{cont}}(x_i) = \\left( \\sigma (-1)^{p+1} \\Delta x^{2p-1} \\frac{\\partial^{2p} u}{\\partial x^{2p}} + \\sigma (-1)^{p+1} \\frac{p (\\Delta x)^{2p+1}}{12} \\frac{\\partial^{2p+2} u}{\\partial x^{2p+2}} + \\dots \\right) - \\sigma (-1)^{p+1} \\Delta x^{2p-1} \\frac{\\partial^{2p} u}{\\partial x^{2p}}.\n$$\n主导误差项为：\n$$\nE(x) \\approx \\sigma (-1)^{p+1} \\frac{p (\\Delta x)^{2p+1}}{12} \\frac{\\partial^{2p+2} u}{\\partial x^{2p+2}}(x).\n$$\n误差 $E(\\Delta x) = \\max_i |E(x_i)|$ 按 $(\\Delta x)^{2p+1}$ 缩放。收敛阶 $r$ 由 $r = \\log_2(E(\\Delta x)/E(\\Delta x/2))$ 给出。如果 $E(\\Delta x) \\propto (\\Delta x)^\\alpha$，那么 $r = \\log_2((\\Delta x)^\\alpha / (\\Delta x/2)^\\alpha) = \\log_2(2^\\alpha) = \\alpha$。因此，预期的理论收敛阶为 $r = 2p+1$。\n\n对于特定的测试函数 $u(x) = \\sin(kx)$，我们需要它的 $(2p)$ 阶导数：\n$$\n\\frac{\\partial^{2p}}{\\partial x^{2p}} \\sin(kx) = k^{2p} \\sin\\left(kx + 2p \\cdot \\frac{\\pi}{2}\\right) = k^{2p} \\sin(kx + p\\pi) = (-1)^p k^{2p} \\sin(kx).\n$$\n数值测试的连续目标是：\n$$\nQ_{\\text{cont}}(x) = \\sigma (-1)^{p+1} \\Delta x^{2p-1} (-1)^p k^{2p} \\sin(kx) = -\\sigma \\Delta x^{2p-1} k^{2p} \\sin(kx).\n$$\n各测试用例的预测收敛阶为：\n- 案例 1 ($p=2$): $r = 2(2)+1 = 5$。\n- 案例 2 ($p=3$): $r = 2(3)+1 = 7$。\n- 案例 3 ($p=4$): $r = 2(4)+1 = 9$。\n- 案例 4 ($p=2$，粗网格)：$r=5$，但预计精度会较低。\n- 案例 5 ($p=2$，近奈奎斯特频率)：渐近分析预计会失效，导致收敛阶不同于 $5$。", "answer": "```python\nimport numpy as np\n\ndef compute_q_discrete(u_grid, p_order, delta_x):\n    \"\"\"\n    Computes the discrete Kreiss-Oliger operator Q on a grid.\n    \n    Args:\n        u_grid (np.ndarray): The field u on a uniform periodic grid.\n        p_order (int): The order parameter p of the KO operator.\n        delta_x (float): The grid spacing.\n        \n    Returns:\n        np.ndarray: The value of the discrete operator Q on the grid.\n    \"\"\"\n    sigma = 1.0\n    \n    # The operator is (D_+ D_-)^p. We implement D_+ D_- and apply it p times.\n    # D+D- u_i = (u_{i+1} - 2u_i + u_{i-1}) / dx^2\n    \n    # Initialize with the input grid function\n    op_u = u_grid\n    \n    # Apply the D_+ D_- operator p times\n    for _ in range(p_order):\n        op_u = (np.roll(op_u, -1) - 2 * op_u + np.roll(op_u, 1)) / (delta_x**2)\n        \n    # The full Q operator\n    q_val = sigma * ((-1)**(p_order + 1)) * (delta_x**(2 * p_order - 1)) * op_u\n    return q_val\n\ndef solve():\n    \"\"\"\n    Performs the full analysis for the given test cases.\n    \"\"\"\n    test_cases = [\n        # (p, N, k)\n        (2, 128, 3),  # Case 1\n        (3, 128, 3),  # Case 2\n        (4, 128, 3),  # Case 3\n        (2, 16, 3),   # Case 4\n        (2, 64, 31),  # Case 5\n    ]\n\n    results = []\n    sigma = 1.0\n\n    for p, N, k in test_cases:\n        # Set up two grids: one with N points, one with 2N points.\n        N1 = N\n        N2 = 2 * N\n        \n        # Grid 1\n        dx1 = 2 * np.pi / N1\n        x1 = np.linspace(0, 2 * np.pi, N1, endpoint=False)\n        u1 = np.sin(k * x1)\n        \n        # Grid 2\n        dx2 = 2 * np.pi / N2\n        x2 = np.linspace(0, 2 * np.pi, N2, endpoint=False)\n        u2 = np.sin(k * x2)\n        \n        # --- Compute discrete KO operator Q on both grids ---\n        Q1_discrete = compute_q_discrete(u1, p, dx1)\n        Q2_discrete = compute_q_discrete(u2, p, dx2)\n        \n        # --- Compute continuum target on both grids ---\n        # Q_cont = sigma * (-1)^(p+1) * dx^(2p-1) * d^(2p)u/dx^(2p)\n        # d^(2p)u/dx^(2p) for u=sin(kx) is (-1)^p * k^(2p) * sin(kx)\n        \n        # Continuum target on grid 1\n        d2p_u1 = (-1)**p * k**(2 * p) * np.sin(k * x1)\n        Q1_continuum = sigma * ((-1)**(p + 1)) * (dx1**(2 * p - 1)) * d2p_u1\n        \n        # Continuum target on grid 2\n        d2p_u2 = (-1)**p * k**(2 * p) * np.sin(k * x2)\n        Q2_continuum = sigma * ((-1)**(p + 1)) * (dx2**(2 * p - 1)) * d2p_u2\n        \n        # --- Compute errors ---\n        # Error is the L-infinity norm of the difference\n        E1 = np.max(np.abs(Q1_discrete - Q1_continuum))\n        E2 = np.max(np.abs(Q2_discrete - Q2_continuum))\n        \n        # --- Compute empirical convergence order r ---\n        # r = [ln(E(dx)) - ln(E(dx/2))] / [ln(dx) - ln(dx/2)]\n        # This simplifies to log2(E1 / E2)\n        if E1 > 0 and E2 > 0:\n            order = np.log(E1 / E2) / np.log(2)\n        else:\n            order = np.nan # Avoid log(0) if error is zero (e.g. machine precision)\n\n        results.append(order)\n\n    # Format the final output as specified\n    print(f\"[{','.join([f'{r:.3f}' for r in results])}]\")\n\nsolve()\n\n```", "id": "3481434"}, {"introduction": "理解了Kreiss-Oliger算子的静态性质后，下一步是研究它在时间演化系统中的动态行为。向一个演化方程中添加数值耗散项会直接影响其稳定性，若参数选择不当，可能会导致数值解迅速增长而崩溃。本练习将引导您运用冯·诺依曼稳定性分析这一基本工具，来研究一个包含四阶KO耗散并采用前向欧拉方法进行时间积分的简化模型。[@problem_id:3481413] 通过推导放大因子并施加稳定性约束，您将确定耗散系数的允许范围，从而掌握确保数值模拟稳定性的核心分析技术。", "problem": "考虑在长度为 $L$ 的一维周期性区域上的 Baumgarte-Shapiro-Shibata-Nakamura (BSSN) 表述，该表述在闵可夫斯基时空附近进行线性化，并用均匀网格 $x_{j} = j \\,\\Delta x$（其中 $j = 0, 1, \\dots, N-1$ 且 $N \\,\\Delta x = L$）进行离散化。在线性化系统中，我们关注一个连续谱速度为零的单一解耦特征场（例如，一个携带约束的模式），并通过仅添加一个高阶数值耗散项来为其半离散演化建模。网格函数 $u_{j}(t)$ 的演化方程为\n$$\n\\frac{d}{dt} u_{j}(t) \\;=\\; Q[u]_{j},\n$$\n其中 $Q$ 是四阶 Kreiss-Oliger 耗散算子，定义为\n$$\nQ[u]_{j} \\;=\\; -\\,\\sigma \\,\\Delta x^{3}\\, D_{+}^{2} D_{-}^{2} u_{j}.\n$$\n此处，$D_{+}$ 和 $D_{-}$ 分别是前向和后向差分算子，\n$$\nD_{+} u_{j} \\;=\\; \\frac{u_{j+1} - u_{j}}{\\Delta x}, \n\\qquad\nD_{-} u_{j} \\;=\\; \\frac{u_{j} - u_{j-1}}{\\Delta x},\n$$\n且 $D_{+}^{2} D_{-}^{2} \\equiv (D_{+} D_{-})^{2}$ 按通常的复合顺序应用。使用时间步长为 $\\Delta t$ 的前向欧拉法在时间上推进解，\n$$\nu_{j}^{n+1} \\;=\\; u_{j}^{n} \\;+\\; \\Delta t \\, Q[u^{n}]_{j}.\n$$\n进行一次冯·诺依曼分析：假设一个离散傅里叶模式 $u_{j}^{n} = \\hat{u}^{n} \\exp\\!\\big(i j \\xi\\big)$，其无量纲波数为 $\\xi \\in [-\\pi,\\pi]$，推导放大因子 $G(\\xi)$，并施加以下要求：没有任何傅里叶模式表现出负阻尼，并且单步放大在幅值上有界，即对所有 $\\xi$ 都有 $|G(\\xi)| \\leq 1$。确定最大允许耗散系数 $\\sigma_{\\max}$，它是一个用 $\\Delta x$ 和 $\\Delta t$ 表示的闭式解析表达式，使得上述约束对所有可分辨的傅里叶模式都成立。将你的最终答案表示为 $\\sigma_{\\max}$ 的单个解析表达式，不附带单位。", "solution": "所述问题具有科学依据、是适定的且客观的。它代表了对一个有限差分格式的标准冯·诺依曼稳定性分析，这是偏微分方程数值方法领域的一个基本过程。该设置是一个简化但具有代表性的模型，用于在数值相对论中研究耗散项的稳定性。所有必要信息都已提供，且没有矛盾之处。因此，该问题是有效的，我将着手求解。\n\n任务是求解给定数值格式的最大允许耗散系数 $\\sigma_{\\max}$。该格式包含一个网格函数 $u_j(t)$ 的半离散演化方程，然后使用前向欧拉法对其进行时间离散化。稳定性将使用冯·诺依曼方法进行分析。\n\n半离散演化方程由下式给出\n$$\n\\frac{d}{dt} u_{j}(t) = Q[u]_{j}\n$$\n其中 $Q$ 是四阶 Kreiss-Oliger 耗散算子：\n$$\nQ[u]_{j} = -\\sigma \\Delta x^{3} D_{+}^{2} D_{-}^{2} u_{j} = -\\sigma \\Delta x^{3} (D_{+} D_{-})^{2} u_{j}\n$$\n时间积分使用前向欧拉法进行：\n$$\nu_{j}^{n+1} = u_{j}^{n} + \\Delta t \\, Q[u^{n}]_{j}\n$$\n\n对于冯·诺依曼分析，我们将单个傅里叶模式 $u_j^n = \\hat{u}^n \\exp(i j \\xi)$ 代入全离散方程。这里，$\\xi = k \\Delta x$ 是无量纲波数，$k$ 是波数，对于网格上所有可分辨的模式，$\\xi \\in [-\\pi, \\pi]$。放大因子定义为 $G(\\xi) = \\hat{u}^{n+1}/\\hat{u}^{n}$。\n\n将傅里叶模式代入前向欧拉方程得到：\n$$\n\\hat{u}^{n+1} e^{i j \\xi} = \\hat{u}^{n} e^{i j \\xi} + \\Delta t \\, Q[\\hat{u}^{n} e^{i j \\xi}]_{j}\n$$\n算子 $Q$ 是一个线性的常系数差分算子。它作用于一个傅里叶模式的效果是将其乘以一个复数，即它的符号，记为 $\\hat{Q}(\\xi)$。因此，$Q[e^{i j \\xi}]_{j} = \\hat{Q}(\\xi) e^{i j \\xi}$。方程变为：\n$$\n\\hat{u}^{n+1} e^{i j \\xi} = \\hat{u}^{n} e^{i j \\xi} + \\Delta t \\, \\hat{u}^{n} \\hat{Q}(\\xi) e^{i j \\xi}\n$$\n两边同除以 $\\hat{u}^{n} e^{i j \\xi}$，我们得到放大因子：\n$$\nG(\\xi) = 1 + \\Delta t \\, \\hat{Q}(\\xi)\n$$\n\n为了求得 $G(\\xi)$，我们必须先确定算子 $Q$ 的符号 $\\hat{Q}(\\xi)$。算子为 $Q = -\\sigma \\Delta x^3 (D_+ D_-)^2$。我们首先求 $D_+ D_-$ 的符号。\n前向和后向差分算子 $D_+$ 和 $D_ -$ 的符号为：\n$$\n\\widehat{D_+}(\\xi) = \\frac{e^{i\\xi} - 1}{\\Delta x}\n$$\n$$\n\\widehat{D_-}(\\xi) = \\frac{1 - e^{-i\\xi}}{\\Delta x}\n$$\n复合算子 $D_+ D_-$ 的符号是它们各自符号的乘积：\n$$\n\\widehat{D_+ D_-}(\\xi) = \\widehat{D_+}(\\xi) \\widehat{D_-}(\\xi) = \\frac{(e^{i\\xi} - 1)(1 - e^{-i\\xi})}{(\\Delta x)^2} = \\frac{e^{i\\xi} - e^{i\\xi}e^{-i\\xi} - 1 + e^{-i\\xi}}{(\\Delta x)^2}\n$$\n$$\n\\widehat{D_+ D_-}(\\xi) = \\frac{e^{i\\xi} + e^{-i\\xi} - 2}{(\\Delta x)^2} = \\frac{2\\cos(\\xi) - 2}{(\\Delta x)^2}\n$$\n使用半角恒等式 $1 - \\cos(\\xi) = 2\\sin^2(\\xi/2)$，我们得到：\n$$\n\\widehat{D_+ D_-}(\\xi) = -\\frac{4\\sin^2(\\xi/2)}{(\\Delta x)^2}\n$$\n$Q$ 中的算子是 $(D_+ D_-)^2$，所以它的符号是 $D_+ D_-$ 符号的平方：\n$$\n\\widehat{(D_+ D_-)^2}(\\xi) = \\left( -\\frac{4\\sin^2(\\xi/2)}{(\\Delta x)^2} \\right)^2 = \\frac{16\\sin^4(\\xi/2)}{(\\Delta x)^4}\n$$\n现在，我们可以求出完整算子 $Q$ 的符号：\n$$\n\\hat{Q}(\\xi) = -\\sigma \\Delta x^3 \\widehat{(D_+ D_-)^2}(\\xi) = -\\sigma \\Delta x^3 \\left( \\frac{16\\sin^4(\\xi/2)}{(\\Delta x)^4} \\right) = -\\frac{16\\sigma}{\\Delta x} \\sin^4(\\xi/2)\n$$\n将此代入放大因子的表达式中：\n$$\nG(\\xi) = 1 + \\Delta t \\left( -\\frac{16\\sigma}{\\Delta x} \\sin^4(\\xi/2) \\right) = 1 - \\frac{16\\sigma \\Delta t}{\\Delta x} \\sin^4(\\xi/2)\n$$\n\n问题对 $\\sigma$ 施加了两个约束：\n1. 没有任何傅里叶模式表现出负阻尼。\n2. 单步放大在幅值上有界，即 $|G(\\xi)| \\leq 1$。\n\n我们来分析第一个约束。对于一个纯耗散系统，模式振幅的变化率由算子符号的实部决定。负阻尼对应于增长，即 $\\operatorname{Re}(\\hat{Q}(\\xi)) > 0$。因此，无负阻尼的约束是 $\\operatorname{Re}(\\hat{Q}(\\xi)) \\leq 0$。\n由于 $\\hat{Q}(\\xi)$ 是纯实数，这可以简化为 $\\hat{Q}(\\xi) \\leq 0$。\n$$\n-\\frac{16\\sigma}{\\Delta x} \\sin^4(\\xi/2) \\leq 0\n$$\n鉴于 $\\Delta x > 0$ 且对所有 $\\xi$ 都有 $\\sin^4(\\xi/2) \\geq 0$，该不等式要求 $-16\\sigma \\leq 0$，这意味着 $\\sigma \\geq 0$。这确保了算子 $Q$ 对所有模式确实是耗散的。\n\n现在，我们来分析第二个约束，即 $|G(\\xi)| \\leq 1$。这等价于 $-1 \\leq G(\\xi) \\leq 1$。\n$$\n-1 \\leq 1 - \\frac{16\\sigma \\Delta t}{\\Delta x} \\sin^4(\\xi/2) \\leq 1\n$$\n我们分别分析这两个不等式。\n右侧的不等式是：\n$$\n1 - \\frac{16\\sigma \\Delta t}{\\Delta x} \\sin^4(\\xi/2) \\leq 1 \\quad\\implies\\quad -\\frac{16\\sigma \\Delta t}{\\Delta x} \\sin^4(\\xi/2) \\leq 0\n$$\n在 $\\sigma \\geq 0$, $\\Delta t > 0$, $\\Delta x > 0$ 且 $\\sin^4(\\xi/2) \\geq 0$ 的条件下，这个不等式总是成立的。\n\n左侧的不等式是：\n$$\n-1 \\leq 1 - \\frac{16\\sigma \\Delta t}{\\Delta x} \\sin^4(\\xi/2)\n$$\n整理各项，我们得到：\n$$\n\\frac{16\\sigma \\Delta t}{\\Delta x} \\sin^4(\\xi/2) \\leq 2\n$$\n这个不等式必须对所有可分辨的波数成立，即对所有 $\\xi \\in [-\\pi, \\pi]$ 成立。为了找到对 $\\sigma$ 最严格的条件，我们必须找到项 $\\sin^4(\\xi/2)$ 的最大值。函数 $\\sin(\\xi/2)$ 在 $\\xi = \\pm\\pi$ 时达到最大幅值 $1$。因此，$\\sin^4(\\xi/2)$ 的最大值是 $1$。\n不等式必须在这种最坏情况下成立：\n$$\n\\frac{16\\sigma \\Delta t}{\\Delta x} (1) \\leq 2\n$$\n解出 $\\sigma$：\n$$\n\\sigma \\leq \\frac{2 \\Delta x}{16 \\Delta t} = \\frac{\\Delta x}{8 \\Delta t}\n$$\n将此与条件 $\\sigma \\geq 0$ 结合，我们发现耗散系数的允许值范围是 $0 \\leq \\sigma \\leq \\frac{\\Delta x}{8 \\Delta t}$。\n\n最大允许耗散系数 $\\sigma_{\\max}$ 是此范围的上界。\n$$\n\\sigma_{\\max} = \\frac{\\Delta x}{8 \\Delta t}\n$$\n这就是对四阶 Kreiss-Oliger 耗散算子使用前向欧拉法进行时间步进的稳定性极限。", "answer": "$$\\boxed{\\frac{\\Delta x}{8 \\Delta t}}$$", "id": "3481413"}, {"introduction": "真实的数值相对论模拟涉及复杂的耦合偏微分方程组，而不仅仅是单个标量场。数值耗散必须在不严重污染物理现象（如引力波传播）的同时，有效地抑制约束违反等非物理伪影。本练习模拟了一个简化的线性约束传播子系统，让您探究耗散在耦合系统中的作用。您将对一个包含物理传播和阻尼项的$2 \\times 2$系统进行半离散化，并加入KO耗散。[@problem_id:3481432] 通过计算该系统放大矩阵的特征值，您将亲身体会到数值耗散是如何改变系统模式（包括物理模式和非物理模式）的增长率和传播特性的，这对于在复杂的广义相对论模拟中精细调节耗散参数至关重要。", "problem": "考虑一个简化的线性约束传播子系统，它模拟了在用于引力波时空的数值相对论公式中出现的两个约束变量 $C(x,t)$ 和 $Z(x,t)$ 的演化。该连续系统为\n$$\n\\partial_{t} C = -\\,\\partial_{x} Z,\\qquad\n\\partial_{t} Z = -\\,c^{2}\\,\\partial_{x} C - \\gamma\\, Z,\n$$\n其中 $c>0$ 是一个特征传播速度，$\\gamma\\ge 0$ 是一个物理约束阻尼参数。在间距为 $h>0$ 的均匀网格 $x_{j} = j h$ 上对空间进行离散化，并使用线路法（MOL），对一阶空间导数采用二阶中心有限差分。对两个半离散方程都增加二阶 Kreiss-Oliger (KO) 耗散，其定义为在演化变量上作用 $-\\epsilon\\,h^{3} D_{+}^{2} D_{-}^{2}$，其中 $D_{+}$ 和 $D_{-}$ 分别是前向和后向差分算子，$\\epsilon>0$ 是一个无量纲耗散系数。假设周期性边界条件，并分析波数为 $k$ 的单个傅里叶模式。\n\n从连续系统和所述的离散化方法出发，推导该傅里叶模式的半离散符号，并计算所得 $2\\times 2$ 放大矩阵的两个特征值。将你的最终答案表示为关于 $c$、$\\gamma$、$\\epsilon$、$h$ 和 $k$ 的单个闭式解析表达式。不要代入数值。最终答案必须是使用 LaTeX $\\texttt{pmatrix}$ 环境写成行矩阵的一对特征值。不需要四舍五入，最终答案中也不应报告单位。[@problem_id:481]", "solution": "用户希望求出偏微分方程离散化系统放大矩阵的特征值。\n\n### 步骤 1：问题验证\n\n首先根据指定标准对问题进行验证。\n\n#### 步骤 1.1：提取已知条件\n\n*   **连续系统：**\n    $\n    \\partial_{t} C = -\\,\\partial_{x} Z\n    $\n    $\n    \\partial_{t} Z = -\\,c^{2}\\,\\partial_{x} C - \\gamma\\, Z\n    $\n*   **参数和变量：**\n    *   $C(x, t)$, $Z(x, t)$: 约束变量。\n    *   $c > 0$: 特征传播速度。\n    *   $\\gamma \\ge 0$: 物理约束阻尼参数。\n*   **离散化方案：**\n    *   在间距为 $h>0$ 的均匀网格 $x_{j} = j h$ 上使用线路法（MOL）。\n    *   一阶空间导数 $\\partial_x$ 用二阶中心有限差分近似。\n*   **耗散：**\n    *   增加了二阶 Kreiss-Oliger (KO) 耗散项：$-\\epsilon\\,h^{3} D_{+}^{2} D_{-}^{2}$。\n    *   $D_{+}$ 和 $D_{-}$ 是前向和后向差分算子。\n    *   $\\epsilon > 0$ 是一个无量纲耗散系数。\n*   **边界条件和分析：**\n    *   假设周期性边界条件。\n    *   分析针对波数为 $k$ 的单个傅里叶模式。\n*   **目标：**\n    *   推导傅里叶模式的半离散符号（放大矩阵）。\n    *   计算该矩阵的两个特征值。\n    *   结果必须是关于 $c$、$\\gamma$、$\\epsilon$、$h$ 和 $k$ 的单个闭式解析表达式。\n\n#### 步骤 1.2：使用提取的已知条件进行验证\n\n*   **科学依据：**该问题描述了一个线性双曲型偏微分方程组，这是物理学和工程学中的常见模型。所指定的数值方法——线路法、中心有限差分和 Kreiss-Oliger 耗散——是求解此类方程的标准且广泛使用的技术，尤其是在数值相对论等领域。该设置在科学上和数学上都是合理的。\n*   **适定性：**问题定义清晰。它要求基于一套完整的指令进行特定的数学推导（矩阵的特征值）。定义明确的数学运算保证了唯一且有意义的解的存在。\n*   **客观性：**问题以精确、客观和标准的数学语言陈述。它没有任何歧义、主观性或基于观点的断言。\n\n所有其他有效性标准（完备性、一致性、可行性等）均已满足。该问题是偏微分方程数值格式稳定性分析中的一个标准练习。\n\n#### 步骤 1.3：结论和行动\n\n*   **结论：**该问题是**有效的**。\n*   **行动：**进行完整的推导和求解。\n\n### 步骤 2：解的推导\n\n通过对半离散化系统应用傅里叶分析来推导解。\n\n**1. 使用线路法（MOL）进行半离散化**\n\n我们在空间上进行离散化，保持时间连续。网格点为 $x_j = j h$。函数 $C(x_j, t)$ 和 $Z(x_j, t)$ 表示为 $C_j(t)$ 和 $Z_j(t)$。应用于网格函数 $f_j$ 的一阶空间导数 $\\partial_x$ 的二阶中心差分近似由下式给出：\n$$\n\\delta_{2x} f_j = \\frac{f_{j+1} - f_{j-1}}{2h}\n$$\n将此应用于连续系统，得到网格点 $j$ 处变量的半离散方程：\n$$\n\\frac{d C_j}{dt} = - \\frac{Z_{j+1} - Z_{j-1}}{2h}\n$$\n$$\n\\frac{d Z_j}{dt} = -c^2 \\frac{C_{j+1} - C_{j-1}}{2h} - \\gamma Z_j\n$$\n\n**2. 引入 Kreiss-Oliger 耗散**\n\n问题指定向每个演化方程添加一个二阶 Kreiss-Oliger 耗散项 $-\\epsilon h^3 D_+^2 D_-^2$。前向和后向差分算子定义为 $D_+ f_j = (f_{j+1} - f_j)/h$ 和 $D_- f_j = (f_j - f_{j-1})/h$。完整的半离散系统变为：\n$$\n\\frac{d C_j}{dt} = - \\frac{Z_{j+1} - Z_{j-1}}{2h} - \\epsilon h^3 D_+^2 D_-^2 C_j\n$$\n$$\n\\frac{d Z_j}{dt} = -c^2 \\frac{C_{j+1} - C_{j-1}}{2h} - \\gamma Z_j - \\epsilon h^3 D_+^2 D_-^2 Z_j\n$$\n\n**3. 傅里叶分析**\n\n我们对单个傅里叶模式分析该系统。我们做出一个拟设，即每个网格点上的解都具有平面波的形式：\n$$\nC_j(t) = \\hat{C}(t) e^{i k x_j} = \\hat{C}(t) e^{i k j h}\n$$\n$$\nZ_j(t) = \\hat{Z}(t) e^{i k x_j} = \\hat{Z}(t) e^{i k j h}\n$$\n其中 $\\hat{C}$ 和 $\\hat{Z}$ 是随时间变化的傅里叶振幅，$k$ 是波数，$i = \\sqrt{-1}$。我们现在求出每个算子的傅里叶符号（也称为放大因子）。\n\n中心差分算子 $\\delta_{2x}$ 的符号通过将其应用于 $e^{i k j h}$ 来找到：\n$$\n\\delta_{2x} e^{i k j h} = \\frac{e^{i k (j+1) h} - e^{i k (j-1) h}}{2h} = \\frac{e^{i k h} - e^{-i k h}}{2h} e^{i k j h} = \\frac{2i \\sin(kh)}{2h} e^{i k j h} = \\frac{i \\sin(kh)}{h} e^{i k j h}\n$$\n因此，$\\partial_x$ 的符号为 $\\hat{\\partial}_x = i \\frac{\\sin(kh)}{h}$。\n\nKreiss-Oliger 耗散算子 $-\\epsilon h^3 D_+^2 D_-^2$ 的符号推导如下。$D_+$ 和 $D_-$ 的符号为：\n$$\n\\hat{D}_+ = \\frac{e^{ikh} - 1}{h}\n$$\n$$\n\\hat{D}_- = \\frac{1 - e^{-ikh}}{h}\n$$\n乘积 $D_+ D_-$ 的符号为：\n$$\n\\widehat{D_+ D_-} = \\hat{D}_+ \\hat{D}_- = \\frac{(e^{ikh} - 1)(1 - e^{-ikh})}{h^2} = \\frac{1 - e^{-ikh} - e^{ikh} + 1}{h^2} = \\frac{2(1 - \\cos(kh))}{h^2}\n$$\n使用半角恒等式 $1 - \\cos(\\theta) = 2 \\sin^2(\\theta/2)$，这变为：\n$$\n\\widehat{D_+ D_-} = \\frac{4 \\sin^2(kh/2)}{h^2}\n$$\n完整耗散算子的符号涉及该项的平方：\n$$\n\\widehat{K} = -\\epsilon h^3 \\left(\\widehat{D_+ D_-}\\right)^2 = -\\epsilon h^3 \\left(\\frac{4 \\sin^2(kh/2)}{h^2}\\right)^2 = -\\frac{16 \\epsilon}{h} \\sin^4\\left(\\frac{kh}{2}\\right)\n$$\n这个符号是一个实数、非正数，它提供数值阻尼。\n\n**4. 傅里叶空间中的系统**\n\n将傅里叶拟设和算子符号代入半离散方程，得到一个关于振幅 $\\hat{C}$ 和 $\\hat{Z}$ 的常微分方程组：\n$$\n\\frac{d \\hat{C}}{dt} = - \\left(i \\frac{\\sin(kh)}{h}\\right) \\hat{Z} + \\left(-\\frac{16 \\epsilon}{h} \\sin^4\\left(\\frac{kh}{2}\\right)\\right) \\hat{C}\n$$\n$$\n\\frac{d \\hat{Z}}{dt} = -c^2 \\left(i \\frac{\\sin(kh)}{h}\\right) \\hat{C} - \\gamma \\hat{Z} + \\left(-\\frac{16 \\epsilon}{h} \\sin^4\\left(\\frac{kh}{2}\\right)\\right) \\hat{Z}\n$$\n这可以写成矩阵形式 $\\frac{d}{dt} \\mathbf{\\hat{u}} = M \\mathbf{\\hat{u}}$，其中 $\\mathbf{\\hat{u}} = \\begin{pmatrix} \\hat{C} \\\\ \\hat{Z} \\end{pmatrix}$，$M$ 是放大矩阵：\n$$\nM = \\begin{pmatrix}\n-\\frac{16 \\epsilon}{h} \\sin^4\\left(\\frac{kh}{2}\\right) & -i \\frac{\\sin(kh)}{h} \\\\\n-i c^2 \\frac{\\sin(kh)}{h} & -\\gamma - \\frac{16 \\epsilon}{h} \\sin^4\\left(\\frac{kh}{2}\\right)\n\\end{pmatrix}\n$$\n\n**5. 特征值计算**\n\n矩阵 $M$ 的特征值 $\\lambda$ 是特征方程 $\\det(M - \\lambda I) = 0$ 的解，其中 $I$ 是单位矩阵。\n$$\n\\det\n\\begin{pmatrix}\n-\\frac{16 \\epsilon}{h} \\sin^4\\left(\\frac{kh}{2}\\right) - \\lambda & -i \\frac{\\sin(kh)}{h} \\\\\n-i c^2 \\frac{\\sin(kh)}{h} & -\\gamma - \\frac{16 \\epsilon}{h} \\sin^4\\left(\\frac{kh}{2}\\right) - \\lambda\n\\end{pmatrix}\n= 0\n$$\n让我们通过定义 $\\mathcal{K} = -\\frac{16 \\epsilon}{h} \\sin^4\\left(\\frac{kh}{2}\\right)$ 和 $\\mathcal{D} = i \\frac{\\sin(kh)}{h}$ 来简化。矩阵为 $M = \\begin{pmatrix} \\mathcal{K} & -\\mathcal{D} \\\\ -c^2 \\mathcal{D} & -\\gamma+\\mathcal{K} \\end{pmatrix}$。特征方程是：\n$$\n(\\mathcal{K} - \\lambda)(-\\gamma + \\mathcal{K} - \\lambda) - (- \\mathcal{D})(-c^2 \\mathcal{D}) = 0\n$$\n$$\n(\\mathcal{K} - \\lambda)^2 - \\gamma(\\mathcal{K} - \\lambda) - c^2 \\mathcal{D}^2 = 0\n$$\n代入 $\\mathcal{D}^2 = \\left(i \\frac{\\sin(kh)}{h}\\right)^2 = -\\frac{\\sin^2(kh)}{h^2}$：\n$$\n(\\mathcal{K} - \\lambda)^2 - \\gamma(\\mathcal{K} - \\lambda) + c^2 \\frac{\\sin^2(kh)}{h^2} = 0\n$$\n令 $\\Lambda = \\mathcal{K} - \\lambda$。关于 $\\Lambda$ 的方程是：\n$$\n\\Lambda^2 - \\gamma \\Lambda + c^2 \\frac{\\sin^2(kh)}{h^2} = 0\n$$\n使用二次公式求解 $\\Lambda$：\n$$\n\\Lambda = \\frac{\\gamma \\pm \\sqrt{(-\\gamma)^2 - 4(1)\\left(c^2 \\frac{\\sin^2(kh)}{h^2}\\right)}}{2} = \\frac{\\gamma}{2} \\pm \\frac{1}{2}\\sqrt{\\gamma^2 - \\frac{4c^2 \\sin^2(kh)}{h^2}}\n$$\n现在，求解 $\\lambda = \\mathcal{K} - \\Lambda$：\n$$\n\\lambda = \\mathcal{K} - \\left( \\frac{\\gamma}{2} \\pm \\frac{1}{2}\\sqrt{\\gamma^2 - \\frac{4c^2 \\sin^2(kh)}{h^2}} \\right)\n$$\n$$\n\\lambda = \\mathcal{K} - \\frac{\\gamma}{2} \\mp \\sqrt{\\frac{\\gamma^2}{4} - \\frac{c^2 \\sin^2(kh)}{h^2}}\n$$\n由于 $\\pm$ 和 $\\mp$ 覆盖了同一对解，我们可以使用 $\\pm$：\n$$\n\\lambda = \\mathcal{K} - \\frac{\\gamma}{2} \\pm \\sqrt{\\frac{\\gamma^2}{4} - \\frac{c^2 \\sin^2(kh)}{h^2}}\n$$\n将 $\\mathcal{K}$ 的表达式代回：\n$$\n\\lambda = -\\frac{16 \\epsilon}{h} \\sin^4\\left(\\frac{kh}{2}\\right) - \\frac{\\gamma}{2} \\pm \\sqrt{\\frac{\\gamma^2}{4} - \\frac{c^2 \\sin^2(kh)}{h^2}}\n$$\n这就是放大矩阵的两个特征值。它们代表了半离散系统中傅里叶模式的增长率。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-\\frac{16\\epsilon}{h} \\sin^4\\left(\\frac{kh}{2}\\right) - \\frac{\\gamma}{2} + \\sqrt{\\frac{\\gamma^2}{4} - \\frac{c^2 \\sin^2(kh)}{h^2}}, & -\\frac{16\\epsilon}{h} \\sin^4\\left(\\frac{kh}{2}\\right) - \\frac{\\gamma}{2} - \\sqrt{\\frac{\\gamma^2}{4} - \\frac{c^2 \\sin^2(kh)}{h^2}}\n\\end{pmatrix}\n}\n$$", "id": "3481432"}]}