{"hands_on_practices": [{"introduction": "要掌握Z4和CCZ4数值相对论公式，核心在于理解其约束阻尼机制。本练习从一个简化的阻尼波方程入手，该方程是约束传播的常用模型，旨在通过解析推导来揭示约束振幅的衰减时间尺度。通过完成这个练习，你将直接建立起阻尼参数 $\\kappa_{1}$ 与约束抑制效率之间的直观物理联系，从而为更复杂的数值模拟奠定坚实的理论基础。", "problem": "在Z4的共形协变形式（CCZ4）中，爱因斯坦约束违背被编码在一个四维矢量 $Z_{a}$ 中。在这种形式中，一个用于检验预期行为的标准数值测试是分析关于平直闵可夫斯基背景的线性化约束传播子系统，其中lapse函数为 $\\alpha = 1$，shift矢量为 $\\beta^{i} = 0$，且所有场都是空间尺度远大于数值网格间距的小微扰。在此区域中，作用于约束的演化算符的主部是类波的，并且CCZ4阻尼机制引入了一个与参数 $\\kappa_{1} > 0$ 成正比的时间导数线性阻尼。这些事实对于Z4族形式是公认的，并构成了数值相对论中使用的鲁棒稳定性和约束阻尼测试的基础。\n\n假设空间约束 $Z_{i}$ 的单个笛卡尔分量 $Z$ 解耦，并且在微扰理论的领头阶和主部水平上满足以下形式的阻尼波动方程\n$$\n\\partial_{t}^{2} Z - \\partial_{x}^{2} Z + 2 \\kappa_{1} \\,\\partial_{t} Z = 0,\n$$\n在物理波速为1的单位制下。考虑在线性化测试中使用的标准平面波拟设，\n$$\nZ(t,x) = A \\,\\exp\\!\\big(i(k x - \\omega t)\\big),\n$$\n其中 $A$ 为恒定复振幅，$k \\neq 0$ 为实波数，$\\omega$ 为复频率。欠阻尼区定义为 $|k| > \\kappa_{1}$，在此区域中，振荡持续存在，而振幅呈指数衰减。\n\n从这些前提出发，推导 $\\omega$ 的色散关系，并用它来确定欠阻尼区中振幅的e折时标 $\\tau$，$\\tau$ 定义为 $|Z|$ 减小一个因子 $\\exp(-1)$ 所需的时间。将你的最终答案表示为仅含 $\\kappa_{1}$ 的单个闭式解析表达式。无需四舍五入。使用无量纲代码单位，其中时间以光速等于1的单位进行度量。", "solution": "问题陈述被认为是有效的。它在科学上基于数值相对论的既定理论，特别是Z4类形式中约束传播的分析。该问题是适定的，提供了一个特定的偏微分方程（PDE）及其解的函数形式（一个拟设），并有明确的目标来推导一个物理量（e折时标）。语言是客观的，所有必要的参数和条件都已指明。不存在矛盾或含糊之处。\n\n任务是确定由下式给出的阻尼波动方程的平面波解的e折时标 $\\tau$\n$$\n\\partial_{t}^{2} Z - \\partial_{x}^{2} Z + 2 \\kappa_{1} \\,\\partial_{t} Z = 0\n$$\n提出的解是以下形式的平面波拟设\n$$\nZ(t,x) = A \\,\\exp\\!\\big(i(k x - \\omega t)\\big)\n$$\n其中 $k$ 是实波数，$\\omega$ 是复频率。我们的目标是首先找到连接 $\\omega$ 和 $k$ 的色散关系，然后用它来找到由 $|k| > \\kappa_{1}$ 定义的欠阻尼区中的e折时标 $\\tau$。\n\n首先，我们将拟设代入偏微分方程。为此，我们计算 $Z(t,x)$ 所需的偏导数：\n关于时间 $t$ 的一阶偏导数是：\n$$\n\\partial_{t} Z = \\frac{\\partial}{\\partial t} \\left[ A \\exp(i(kx - \\omega t)) \\right] = A (-i\\omega) \\exp(i(kx - \\omega t)) = -i\\omega Z\n$$\n关于时间 $t$ 的二阶偏导数是：\n$$\n\\partial_{t}^{2} Z = \\frac{\\partial}{\\partial t} (-i\\omega Z) = (-i\\omega)^2 Z = -\\omega^2 Z\n$$\n关于空间坐标 $x$ 的二阶偏导数是：\n$$\n\\partial_{x} Z = \\frac{\\partial}{\\partial x} \\left[ A \\exp(i(kx - \\omega t)) \\right] = A (ik) \\exp(i(kx - \\omega t)) = ikZ\n$$\n$$\n\\partial_{x}^{2} Z = \\frac{\\partial}{\\partial x} (ikZ) = (ik)^2 Z = -k^2 Z\n$$\n将这些表达式代回控制偏微分方程，得到：\n$$\n(-\\omega^2 Z) - (-k^2 Z) + 2 \\kappa_{1} (-i\\omega Z) = 0\n$$\n由于该拟设代表一个非平凡解（$A \\neq 0$），我们可以将整个方程除以 $Z$：\n$$\n-\\omega^2 + k^2 - 2i\\kappa_{1}\\omega = 0\n$$\n将此方程重排成关于频率 $\\omega$ 的标准二次形式，我们得到色散关系：\n$$\n\\omega^2 + 2i\\kappa_{1}\\omega - k^2 = 0\n$$\n这是一个关于 $\\omega$ 的二次方程，形式为 $a\\omega^2 + b\\omega + c = 0$，系数为 $a=1$, $b=2i\\kappa_{1}$, $c=-k^2$。我们可以使用二次公式求解 $\\omega$：\n$$\n\\omega = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a} = \\frac{-2i\\kappa_{1} \\pm \\sqrt{(2i\\kappa_{1})^2 - 4(1)(-k^2)}}{2(1)}\n$$\n我们来简化平方根下的表达式：\n$$\n(2i\\kappa_{1})^2 - 4(-k^2) = 4i^2\\kappa_{1}^2 + 4k^2 = -4\\kappa_{1}^2 + 4k^2 = 4(k^2 - \\kappa_{1}^2)\n$$\n将此代回 $\\omega$ 的解中：\n$$\n\\omega = \\frac{-2i\\kappa_{1} \\pm \\sqrt{4(k^2 - \\kappa_{1}^2)}}{2} = \\frac{-2i\\kappa_{1} \\pm 2\\sqrt{k^2 - \\kappa_{1}^2}}{2}\n$$\n简化表达式得到复频率的两个解：\n$$\n\\omega_{\\pm} = -i\\kappa_{1} \\pm \\sqrt{k^2 - \\kappa_{1}^2}\n$$\n问题指定了欠阻尼区，其中 $|k| > \\kappa_{1}$。这意味着 $k^2 > \\kappa_{1}^2$，所以 $k^2 - \\kappa_{1}^2$ 项为正，其平方根为实数。\n\n复频率 $\\omega$ 通常表示为 $\\omega = \\text{Re}(\\omega) + i\\,\\text{Im}(\\omega)$。将此与我们的解进行比较，我们可以确定实部和虚部：\n$$\n\\text{Re}(\\omega) = \\pm\\sqrt{k^2 - \\kappa_{1}^2}\n$$\n$$\n\\text{Im}(\\omega) = -\\kappa_{1}\n$$\n频率的实部决定了波的振荡行为，而虚部则控制其振幅的指数增长或衰减。\n\n波振幅的时间依赖性包含在因子 $\\exp(-i\\omega t)$ 中。让我们使用 $\\omega$ 的实部和虚部展开它：\n$$\n\\exp(-i\\omega t) = \\exp(-i(\\text{Re}(\\omega) + i\\,\\text{Im}(\\omega))t) = \\exp(-i\\,\\text{Re}(\\omega)t) \\exp(\\text{Im}(\\omega)t)\n$$\n完整解为 $Z(t,x) = A \\exp(\\text{Im}(\\omega)t) \\exp(i(kx - \\text{Re}(\\omega)t))$。波的振幅是 $|Z(t,x)|$。由于 $A$ 是一个复常数，我们可以写成 $A = |A|\\exp(i\\phi)$。\n$$\n|Z(t,x)| = | |A|\\exp(i\\phi) \\exp(\\text{Im}(\\omega)t) \\exp(i(kx - \\text{Re}(\\omega)t)) |\n$$\n$$\n|Z(t,x)| = |A| \\cdot |\\exp(\\text{Im}(\\omega)t)| \\cdot |\\exp(i(\\phi + kx - \\text{Re}(\\omega)t))|\n$$\n由于复指数的宗量是实数，最后一项的模为 $1$。因此振幅为：\n$$\n|Z(t,x)| = |A|\\exp(\\text{Im}(\\omega)t)\n$$\n代入我们找到的 $\\text{Im}(\\omega) = -\\kappa_{1}$ 的值：\n$$\n|Z(t,x)| = |A|\\exp(-\\kappa_{1}t)\n$$\n由于 $\\kappa_{1}>0$，振幅随时间指数衰减。e折时标 $\\tau$ 是振幅减小一个因子 $\\exp(-1)$ 所需的时间间隔。我们将时间 $t+\\tau$ 的振幅与时间 $t$ 的振幅之比设为 $\\exp(-1)$：\n$$\n\\frac{|Z(t+\\tau,x)|}{|Z(t,x)|} = \\frac{|A|\\exp(-\\kappa_{1}(t+\\tau))}{|A|\\exp(-\\kappa_{1}t)} = \\exp(-1)\n$$\n简化左侧：\n$$\n\\exp(-\\kappa_{1}t - \\kappa_{1}\\tau + \\kappa_{1}t) = \\exp(-\\kappa_{1}\\tau)\n$$\n因此，我们得到方程：\n$$\n\\exp(-\\kappa_{1}\\tau) = \\exp(-1)\n$$\n取两边的自然对数得到：\n$$\n-\\kappa_{1}\\tau = -1\n$$\n求解e折时标 $\\tau$，我们发现：\n$$\n\\tau = \\frac{1}{\\kappa_{1}}\n$$\n这个结果与波数 $k$无关，只要满足欠阻尼区的条件（$|k| > \\kappa_{1}$）。最终表达式仅依赖于阻尼参数 $\\kappa_{1}$，正如问题陈述所要求的那样。", "answer": "$$\\boxed{\\frac{1}{\\kappa_{1}}}$$", "id": "3497122"}, {"introduction": "在理解了约束阻尼的理论之后，下一步是在实践中检验它。本练习模拟了一个“规范波测试”，这是数值相对论中验证代码是否正确实现约束阻尼的标准程序 [@problem_id:3497123]。通过生成模拟数据并拟合衰减率，你将掌握一项用于代码验证的实用技能，并更深入地体会阻尼参数 $\\kappa_1$ 和 $\\kappa_2$ 如何独立地控制不同的约束衰减通道。", "problem": "您的任务是设计并实现一个周期性规范波测试，以测量在数值相对論的共形协变Z4 (CCZ4) 形式下约束范数的衰减率。从Z4框架下约束传播的第一性原理模型开始，该模型在几何单位制（光速 $c = 1$）中围绕闵可夫斯基时空进行线性化。在Z4形式中，引入了约束四维矢量 $Z_{\\mu}$，使得对爱因斯坦约束的违背作为动力学场进行传播。CCZ4形式增加了由参数 $\\kappa_1$ 和 $\\kappa_2$ 控制的阻尼项来抑制这些违背。在一维周期性规范波设置中，考虑一个简化的、线性化的、解耦的平流-阻尼模型，用于描述约束场的两个代表性分量：空间分量 $Z_x$ 和法向投影 $\\Theta \\equiv n^{\\mu} Z_{\\mu}$，\n$$\n\\partial_t Z_x + \\partial_x Z_x = -\\kappa_1 Z_x, \\quad \n\\partial_t \\Theta + \\partial_x \\Theta = -\\left(\\kappa_1 + \\kappa_2\\right)\\Theta,\n$$\n该模型建立在周期性定义域 $x \\in [0, 2\\pi)$ 上，波速为 $c=1$。该模型捕捉了约束传播的基本输运特性以及CCZ4形式中由 $\\kappa_1$ 和 $\\kappa_2$ 引入的不同阻尼通道，同时保持了解析可处理性。\n\n使用形式如下的周期性规范波初始数据\n$$\nZ_x(x,0) = A \\sin(k x), \\quad \\Theta(x,0) = 0,\n$$\n或\n$$\nZ_x(x,0) = 0, \\quad \\Theta(x,0) = A \\sin(k x),\n$$\n其中 $A > 0$ 为小量，波数 $k \\ge 1$ 为整数。对于每种情况，在时间 $t \\in [0, T]$ 内演化解，并构建约束四维矢量（此处限于两个建模分量）的 $L^2$-范数的数值时间序列，\n$$\n\\|Z_{\\mu}\\|_2(t) \\equiv \\left(\\int_0^{2\\pi} \\left[ Z_x(x,t)^2 + \\Theta(x,t)^2 \\right] \\, dx \\right)^{1/2}.\n$$\n由于在周期性定义域上，输运部分相对于 $L^2$ 内积是幺正的，因此 $L^2$-范数的衰减完全由阻尼引起。在上述平流-阻尼模型和单分量初始化的条件下，场演化为带有指数阻尼的平移正弦波，因此预计 $\\|Z_{\\mu}\\|_2(t)$ 会呈现指数衰减。您的任务是通过对数值数据 $\\|Z_{\\mu}\\|_2(t)$ 的对数进行线性最小二乘拟合来测量衰减率，从而拟合出指数衰减常数 $\\lambda$，\n$$\n\\log \\|Z_{\\mu}\\|_2(t) \\approx C - \\lambda t,\n$$\n在指定的时间窗口内，并以浮点数形式返回 $\\lambda$。\n\n实现一个程序，该程序：\n- 在 $[0,2\\pi)$ 上构建一个至少包含 $N=256$ 个点的均匀空间网格。\n- 对于每个测试用例，使用规范波解析解形式，在 $[0,T]$ 区间内 $N_t+1$ 个均匀分布的时间点上生成数值时间序列数据，其中 $T$ 和 $N_t$ 的选择应确保回归拟合的稳健性。\n- 在每个时间点上，通过网格上的数值积分计算 $\\|Z_{\\mu}\\|_2(t)$。\n- 对于每个测试用例，通过对整个区间（不包括 $t=0$ 以避免对数中出现除以零的情况）上的点集 $\\{\\left(t_j, \\log \\|Z_{\\mu}\\|_2(t_j)\\right)\\}$进行最小二乘法拟合，来拟合单个指数衰减常数 $\\lambda$。\n- 对于每个测试用例，返回拟合得到的 $\\lambda$，并四舍五入到六位小数。\n\n使用以下参数值和初始化的测试套件（所有量均为无量纲的几何单位，衰减常数必须以逆时间单位表示）：\n- 情况1：$\\kappa_1 = 0.1$，$\\kappa_2 = 0.0$，仅用 $A = 10^{-3}$ 和 $k=1$ 初始化 $Z_x$。\n- 情况2：$\\kappa_1 = 0.1$，$\\kappa_2 = 0.2$，仅用 $A = 10^{-3}$ 和 $k=1$ 初始化 $\\Theta$。\n- 情况3：$\\kappa_1 = 0.5$，$\\kappa_2 = 0.0$，仅用 $A = 10^{-3}$ 和 $k=1$ 初始化 $Z_x$。\n- 情况4：$\\kappa_1 = 0.0$，$\\kappa_2 = 0.3$，仅用 $A = 10^{-3}$ 和 $k=1$ 初始化 $\\Theta$。\n- 情况5：$\\kappa_1 = 0.05$，$\\kappa_2 = -0.05$，仅用 $A = 10^{-3}$ 和 $k=1$ 初始化 $\\Theta$。\n- 情况6：$\\kappa_1 = 0.0$，$\\kappa_2 = 0.0$，仅用 $A = 10^{-3}$ 和 $k=1$ 初始化 $Z_x$。\n\n对于每种情况，程序必须输出拟合得到的指数衰減常数 $\\lambda$，形式为浮点数，并四舍五入到六位小数。最终输出必须是单行，包含一个逗号分隔的Python风格列表，其中包含六个结果，顺序与上述情况相同，例如 $[\\lambda_1,\\lambda_2,\\lambda_3,\\lambda_4,\\lambda_5,\\lambda_6]$。\n\n您的程序必须是自包含的，且不需要任何输入。它必须使用几何单位制，并以逆时间单位报告衰减常数。角度以弧度为单位。任何百分比（如果存在）都必须表示为小数或分数；不要使用百分号。确保您的程序是确定性的，并且不使用任何外部文件或网络访问。", "solution": "问题陈述经过了仔细验证，并被确定是合理的。它在科学上基于数值相对论的原理，特别是CCZ4形式，并提出了一个基于标准简化模型（用于验证测试）的适定数学问题。目标明确，给定的条件充分且一致，问题没有歧义或非科学内容。\n\n任务是在CCZ4框架下，通过周期性规范波测试，确定简化约束矢量 $L^2$-范数 $\\|Z_{\\mu}\\|_2(t)$ 的指数衰减率 $\\lambda$。这将通过将模型 $\\log \\|Z_{\\mu}\\|_2(t) \\approx C - \\lambda t$ 拟合到从解析解派生的数值生成数据上来实现。\n\n首先，我们推导控制性平流-阻尼方程的精确解析解：\n$$\n\\partial_t Z_x + \\partial_x Z_x = -\\kappa_1 Z_x\n$$\n$$\n\\partial_t \\Theta + \\partial_x \\Theta = -\\left(\\kappa_1 + \\kappa_2\\right)\\Theta\n$$\n这些是具有常系数的线性一阶偏微分方程。对于形式为 $\\partial_t u + c \\partial_x u = -\\alpha u$ 且波速为 $c=1$ 的一般方程，可以使用特征线法找到其解。解由 $u(x,t) = u_0(x-t) e^{-\\alpha t}$ 给出，其中 $u_0(x) = u(x,0)$ 是初始数据。\n\n将此通用解应用于我们的特定场，我们得到：\n$$\nZ_x(x,t) = Z_x(x-t, 0) e^{-\\kappa_1 t}\n$$\n$$\n\\Theta(x,t) = \\Theta(x-t, 0) e^{-(\\kappa_1 + \\kappa_2) t}\n$$\n问题指定了两种类型的初始条件。我们分别分析每种情况，以找到 $L^2$-范数的时间演化，其定义为 $\\|Z_{\\mu}\\|_2(t) \\equiv \\left(\\int_0^{2\\pi} \\left[ Z_x(x,t)^2 + \\Theta(x,t)^2 \\right] \\, dx \\right)^{1/2}$。\n\n情况A：仅初始化 $Z_x$。\n初始条件为 $Z_x(x,0) = A \\sin(k x)$ 和 $\\Theta(x,0) = 0$。演化后的场为：\n$$\nZ_x(x,t) = A \\sin(k(x-t)) e^{-\\kappa_1 t}\n$$\n$$\n\\Theta(x,t) = 0\n$$\n$L^2$-范数的平方是：\n$$\n\\|Z_{\\mu}\\|_2^2(t) = \\int_0^{2\\pi} \\left( A \\sin(k(x-t)) e^{-\\kappa_1 t} \\right)^2 dx = A^2 e^{-2\\kappa_1 t} \\int_0^{2\\pi} \\sin^2(k(x-t)) dx\n$$\n由于 $k$ 是整数，在周期性定义域 $[0, 2\\pi)$ 上，任何相移参数的 $\\sin^2$ 函数的积分值为 $\\pi$。\n$$\n\\int_0^{2\\pi} \\sin^2(k(x-t)) dx = \\pi\n$$\n因此，范数为：\n$$\n\\|Z_{\\mu}\\|_2(t) = \\sqrt{A^2 \\pi e^{-2\\kappa_1 t}} = A \\sqrt{\\pi} e^{-\\kappa_1 t}\n$$\n取自然对数得到 $\\log \\|Z_{\\mu}\\|_2(t) = \\log(A\\sqrt{\\pi}) - \\kappa_1 t$。将其与指定的拟合模型 $\\log \\|Z_{\\mu}\\|_2(t) \\approx C - \\lambda t$ 进行比较，我们确定理论衰减率为 $\\lambda = \\kappa_1$。\n\n情况B：仅初始化 $\\Theta$。\n初始条件为 $Z_x(x,0) = 0$ 和 $\\Theta(x,0) = A \\sin(k x)$。演化后的场为：\n$$\nZ_x(x,t) = 0\n$$\n$$\n\\Theta(x,t) = A \\sin(k(x-t)) e^{-(\\kappa_1 + \\kappa_2) t}\n$$\n$L^2$-范数的平方是：\n$$\n\\|Z_{\\mu}\\|_2^2(t) = \\int_0^{2\\pi} \\left( A \\sin(k(x-t)) e^{-(\\kappa_1+\\kappa_2) t} \\right)^2 dx = A^2 e^{-2(\\kappa_1+\\kappa_2) t} \\int_0^{2\\pi} \\sin^2(k(x-t)) dx\n$$\n同样，积分值为 $\\pi$，所以范数为：\n$$\n\\|Z_{\\mu}\\|_2(t) = \\sqrt{A^2 \\pi e^{-2(\\kappa_1+\\kappa_2) t}} = A \\sqrt{\\pi} e^{-(\\kappa_1 + \\kappa_2) t}\n$$\n取自然对数得到 $\\log \\|Z_{\\mu}\\|_2(t) = \\log(A\\sqrt{\\pi}) - (\\kappa_1 + \\kappa_2) t$。因此理论衰减率为 $\\lambda = \\kappa_1 + \\kappa_2$。\n\n数值实现将按以下步骤进行：\n对于每个测试用例，我们定义参数 $\\kappa_1$、$\\kappa_2$、$A$、$k$ 以及初始化类型。\n在 $[0, 2\\pi)$ 上创建一个包含 $N=256$ 个点的均匀空间网格 $x_i$。网格间距为 $\\Delta x = 2\\pi/N$。\n在 $[0, T]$ 上创建一个包含 $N_t+1$ 个点的均匀时间网格 $t_j$。我们选择 $T=10$ 和 $N_t=100$ 以提供足够的数据进行稳健拟合。\n对于每个时间点 $t_j$（$j > 0$），我们在每个空间网格点上计算 $Z_x(x_i, t_j)$ 和 $\\Theta(x_i, t_j)$ 的解析解。\n计算被积函数 $I_i(t_j) = Z_x(x_i, t_j)^2 + \\Theta(x_i, t_j)^2$。\n$L^2$-范数使用数值积分计算。对于均匀网格上的周期函数，梯形法则非常精确，并简化为 $\\|Z_{\\mu}\\|_2(t_j) = \\sqrt{\\Delta x \\sum_{i=0}^{N-1} I_i(t_j)}$。\n为 $j=1, \\dots, N_t$ 生成点 $(t_j, \\log \\|Z_{\\mu}\\|_2(t_j))$ 的时间序列。\n对这些点进行线性最小二乘拟合，以找到直线 $y = mt+c$ 的斜率 $m$ 和截距 $c$。使用 `numpy.polyfit` 可以轻松实现这一点。\n然后从拟合线的斜率中提取衰减率，$\\lambda = -m$。\n对所有六个测试用例重复此过程，并生成最终的拟合 $\\lambda$ 值列表，四舍五入到六位小数。预计数值结果将与理论预测 $\\lambda = \\kappa_1$ 或 $\\lambda = \\kappa_1 + \\kappa_2$ 高精度地匹配。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the periodic gauge-wave test problem for the CCZ4 formulation.\n\n    For each test case, this function:\n    1. Sets up the numerical grid and time steps.\n    2. Generates time-series data for the L2-norm of the constraints\n       using the analytic solution of the model equations.\n    3. Computes the L2-norm via numerical quadrature.\n    4. Performs a linear least-squares fit on the logarithm of the norm\n       vs. time to find the exponential decay rate lambda.\n    5. Collects the results and prints them in the specified format.\n    \"\"\"\n\n    # Test suite of parameters from the problem statement.\n    # Format: (kappa1, kappa2, initialized_field, A, k)\n    test_cases = [\n        (0.1, 0.0, 'Zx', 1e-3, 1),\n        (0.1, 0.2, 'Theta', 1e-3, 1),\n        (0.5, 0.0, 'Zx', 1e-3, 1),\n        (0.0, 0.3, 'Theta', 1e-3, 1),\n        (0.05, -0.05, 'Theta', 1e-3, 1),\n        (0.0, 0.0, 'Zx', 1e-3, 1)\n    ]\n\n    results = []\n\n    # Numerical parameters for the simulation and fit\n    N = 256         # Number of spatial grid points\n    Nt = 100        # Number of time steps for the fit\n    T = 10.0        # Total evolution time\n\n    # Set up spatial grid on [0, 2*pi)\n    x = np.linspace(0, 2 * np.pi, N, endpoint=False)\n    dx = x[1] - x[0]\n\n    # Set up time grid on [0, T]\n    times = np.linspace(0, T, Nt + 1)\n    # We fit over t > 0 as per the problem description\n    fit_times = times[1:]\n\n    for case in test_cases:\n        kappa1, kappa2, init_field, A, k = case\n        \n        log_norms = []\n\n        for t in fit_times:\n            if init_field == 'Zx':\n                # Analytic solution for Zx, with Theta = 0\n                zx_vals = A * np.sin(k * (x - t)) * np.exp(-kappa1 * t)\n                theta_vals = np.zeros_like(x)\n                \n            elif init_field == 'Theta':\n                # Analytic solution for Theta, with Zx = 0\n                zx_vals = np.zeros_like(x)\n                theta_vals = A * np.sin(k * (x - t)) * np.exp(-(kappa1 + kappa2) * t)\n            \n            # Integrand for the L2-norm squared\n            integrand = zx_vals**2 + theta_vals**2\n\n            # Numerical quadrature (Trapezoidal rule for periodic function)\n            integral = np.sum(integrand) * dx\n            \n            # Compute the L2-norm and its logarithm\n            norm = np.sqrt(integral)\n            log_norms.append(np.log(norm))\n\n        # Perform linear least-squares fit: log(norm) = slope * t + intercept\n        # The model is C - lambda*t, so lambda = -slope.\n        slope, _ = np.polyfit(fit_times, log_norms, 1)\n        \n        lambda_fit = -slope\n        \n        # Round to 6 decimal places as required\n        results.append(round(lambda_fit, 6))\n\n    # Format and print the final output as a single-line list\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "3497123"}, {"introduction": "在真实的数值模拟中，不同类型的约束违背（如哈密顿约束和动量约束）是相互耦合的，它们的演化也并非各自独立。本练习利用一个线性化的耦合系统模型来探究这种复杂性 [@problem_id:3497100]。通过比较“完全协变阻尼”与“选择性阻尼”两种策略，你将能够研究不同阻尼方案对约束分量的精细影响，并理解CCZ4公式中各种设计选项背后的考量。", "problem": "考虑在数值相对论的 Z4 形式和共形协变 Z4 形式 (CCZ4) 中，哈密顿约束和动量约束的传播。从一个基本出发点开始：在广义相对论的 $(3+1)$ 分解中，哈密顿约束 $H$ 和动量约束 $M_i$ 在物理可行解上必须为零。Z4 方法通过引入一个约束变量的四维矢量 $Z_\\mu$ 来扩充爱因斯坦场方程，从而动态地控制这些违背，而 CCZ4 则增加了共形和协变结构以及阻尼项。在闵可夫斯基时空周围的线性化机制下，在一个 $(1+1)$ 维的设定中进行研究，并考虑一个空间中波数为 $k$ 的单一傅里叶模。假设模振幅 $\\{H(t), M(t), Z^0(t), Z^1(t)\\}$ 构成一个简化的动力学系统，其中 $H$ 表示哈密顿约束振幅，$M$ 表示空间 $x$ 方向上唯一的非平凡动量约束振幅，$Z^0$ 表示 $Z_\\mu$ 矢量的时间分量，$Z^1$ 表示与波传播方向对齐的空间分量。\n\n构建并分析以下用于约束子系统的无量纲线性化演化模型：\n$$\n\\frac{dH}{dt} \\;=\\; -a_H\\, k\\, Z^1 \\;-\\; b_H\\, Z^0 \\;-\\; d_H\\, H,\n$$\n$$\n\\frac{dM}{dt} \\;=\\; -a_M\\, k\\, Z^0 \\;-\\; b_M\\, k\\, Z^1 \\;-\\; d_M\\, M,\n$$\n$$\n\\frac{dZ^0}{dt} \\;=\\; -c_0\\, k\\, M \\;-\\; e_0\\, H \\;-\\; \\kappa_0\\, Z^0,\n$$\n$$\n\\frac{dZ^1}{dt} \\;=\\; -c_1\\, k\\, H \\;-\\; e_1\\, M \\;-\\; \\kappa_1\\, Z^1.\n$$\n此处，$a_H$、$b_H$、$d_H$、$a_M$、$b_M$、$d_M$、$c_0$、$e_0$、$c_1$、$e_1$ 是固定的正耦合系数，$\\kappa_0$、$\\kappa_1$ 是编码形式选择的阻尼率：对所有 $Z_\\mu$ 分量进行完全协变阻尼对应于 $\\kappa_0 = \\kappa$ 和 $\\kappa_1 = \\kappa$，而仅对 $Z^0$ 进行选择性阻尼则对应于 $\\kappa_0 = \\kappa$ 和 $\\kappa_1 = 0$。与 $d_H$ 和 $d_M$ 成比例的项代表了在离散化演化中约束的微小固有数值耗散。假设以下与约束和 $Z_\\mu$ 场之间的线性化耦合一致的特定系数值：\n$$\na_H = 0.8,\\quad b_H = 0.5,\\quad d_H = 0.02,\\quad a_M = 0.6,\\quad b_M = 0.4,\\quad d_M = 0.01,\n$$\n$$\nc_0 = 0.7,\\quad e_0 = 0.3,\\quad c_1 = 0.9,\\quad e_1 = 0.2.\n$$\n\n你的任务是实现并积分这个针对模振幅的常微分方程组，初始数据为\n$$\nH(0) = 1,\\quad M(0) = 1,\\quad Z^0(0) = 0,\\quad Z^1(0) = 0,\n$$\n在无量纲时间 $t$ 内进行，并比较两种阻尼策略下约束违背的演化情况。对于每个测试用例，将积分运行至指定的最终时间 $T$，并计算两个诊断量：\n$$\nR_H \\;=\\; \\log_{10}\\!\\left(\\frac{|H(T)|}{|H(0)|}\\right),\\qquad\nR_M \\;=\\; \\log_{10}\\!\\left(\\frac{|M(T)|}{|M(0)|}\\right).\n$$\n这些诊断量化了哈密顿和动量约束振幅相对于其初始值的减小（负值）或增长（正值）。\n\n所有量都是无量纲的；不需要物理单位。不使用角度。不使用百分比。你的程序必须计算并报告实值浮点数。\n\n实现程序以评估以下测试套件，该套件涵盖了一般情况、边界条件和边缘情况：\n- 测试用例 1：完全协变阻尼，$k = 0.5$，$\\kappa = 0.2$，$T = 50$。\n- 测试用例 2：仅对 $Z^0$ 进行选择性阻尼，$k = 0.5$，$\\kappa = 0.2$，$T = 50$。\n- 测试用例 3：无阻尼的边界情况，完全协变配置，$k = 0.5$，$\\kappa = 0.0$，$T = 50$。\n- 测试用例 4：高波数和强阻尼的边缘情况，完全协变配置，$k = 5.0$，$\\kappa = 1.0$，$T = 20$。\n- 测试用例 5：高波数和强阻尼的对应边缘情况，仅对 $Z^0$ 进行选择性阻尼，$k = 5.0$，$\\kappa = 1.0$，$T = 20$。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。该列表必须按顺序包含每个测试用例的 $(R_H,R_M)$ 序列，并展平为单个列表。例如，格式为 $[R_{H,1},R_{M,1},R_{H,2},R_{M,2},R_{H,3},R_{M,3},R_{H,4},R_{M,4},R_{H,5},R_{M,5}]$，不含空格和任何附加文本。", "solution": "所提出的问题是一个适定的初值问题，涉及一个由四个耦合的、线性的、具有常系数的一阶常微分方程 (ODE) 组成的系统。该系统在 Z4 和 CCZ4 形式下，模拟了数值相对论中约束违背的线性化演化。目标是积分该系统并计算用于衡量约束振幅增长或衰减的诊断量。\n\n控制方程为：\n$$\n\\frac{dH}{dt} = -d_H H - b_H Z^0 - a_H k Z^1\n$$\n$$\n\\frac{dM}{dt} = -d_M M - a_M k Z^0 - b_M k Z^1\n$$\n$$\n\\frac{dZ^0}{dt} = -e_0 H - c_0 k M - \\kappa_0 Z^0\n$$\n$$\n\\frac{dZ^1}{dt} = -c_1 k H - e_1 M - \\kappa_1 Z^1\n$$\n\n该系统可以写成紧凑的矩阵形式 $\\frac{d\\mathbf{y}}{dt} = \\mathbf{A} \\mathbf{y}$，这是分析的基本出发点。状态矢量 $\\mathbf{y}(t)$ 由约束振幅和 $Z_\\mu$ 变量定义：\n$$\n\\mathbf{y}(t) = \\begin{pmatrix} H(t) \\\\ M(t) \\\\ Z^0(t) \\\\ Z^1(t) \\end{pmatrix}\n$$\n系统矩阵 $\\mathbf{A}$ 是一个 $4 \\times 4$ 矩阵，由问题描述中提供的系数构成。它取决于波数 $k$ 和阻尼参数 $\\kappa_0$ 和 $\\kappa_1$。\n$$\n\\mathbf{A} = \\begin{pmatrix}\n-d_H  &0  &-b_H  &-a_H k \\\\\n0  &-d_M  &-a_M k  &-b_M k \\\\\n-e_0  &-c_0 k  &-\\kappa_0  &0 \\\\\n-c_1 k  &-e_1  &0  &-\\kappa_1\n\\end{pmatrix}\n$$\n问题指定了系统在时间 $t=0$ 的初始状态为：\n$$\n\\mathbf{y}(0) = \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n对于具有常系数矩阵 $\\mathbf{A}$ 的线性系统，任意时间 $t$ 的解可以正式地用矩阵指数表示：\n$$\n\\mathbf{y}(t) = e^{\\mathbf{A}t} \\mathbf{y}(0)\n$$\n这提供了一种直接而精确的方法来确定系统在最终时间 $T$ 的状态。计算过程是构建矩阵乘积 $\\mathbf{A}T$，计算其矩阵指数 $e^{\\mathbf{A}T}$，然后将其应用于初始条件矢量 $\\mathbf{y}(0)$ 以求得 $\\mathbf{y}(T)$。\n\n程序将为 5 个测试用例中的每一个实现此过程。对于每个用例，参数 $k$、$T$ 和 $\\kappa$ 用于根据指定的阻尼策略（'full' 或 'selective'）定义阻尼参数 $\\kappa_0$ 和 $\\kappa_1$。然后使用系数 $a_H = 0.8$, $b_H = 0.5$, $d_H = 0.02$, $a_M = 0.6$, $b_M = 0.4$, $d_M = 0.01$, $c_0 = 0.7$, $e_0 = 0.3$, $c_1 = 0.9$ 和 $e_1 = 0.2$ 的特定数值来填充矩阵 $\\mathbf{A}$。矩阵指数使用高保真度的数值算法（具体为 `scipy.linalg.expm`）计算。\n\n一旦获得最终状态矢量 $\\mathbf{y}(T) = [H(T), M(T), Z^0(T), Z^1(T)]^T$，就计算诊断量 $R_H$ 和 $R_M$。给定初始条件 $H(0) = 1$ 和 $M(0) = 1$，公式简化为：\n$$\nR_H = \\log_{10}\\left(\\frac{|H(T)|}{|H(0)|}\\right) = \\log_{10}(|H(T)|)\n$$\n$$\nR_M = \\log_{10}\\left(\\frac{|M(T)|}{|M(0)|}\\right) = \\log_{10}(|M(T)|)\n$$\n取绝对值是因为振幅可能会振荡并变为负值，而诊断量衡量的是约束违背的量级。然后收集每个测试用例的结果，并将其格式化为所需的输出字符串。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import expm\n\ndef solve():\n    \"\"\"\n    Solves a system of linear ODEs modeling constraint propagation in numerical relativity\n    for a series of test cases.\n    \"\"\"\n    # Define the fixed coefficients from the problem statement.\n    a_H = 0.8\n    b_H = 0.5\n    d_H = 0.02\n    a_M = 0.6\n    b_M = 0.4\n    d_M = 0.01\n    c_0 = 0.7\n    e_0 = 0.3\n    c_1 = 0.9\n    e_1 = 0.2\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (k, kappa, T, damping_type)\n    test_cases = [\n        # Test case 1: full covariant damping\n        (0.5, 0.2, 50.0, 'full'),\n        # Test case 2: selective damping\n        (0.5, 0.2, 50.0, 'selective'),\n        # Test case 3: no damping (boundary case)\n        (0.5, 0.0, 50.0, 'full'),\n        # Test case 4: high k, strong damping, full\n        (5.0, 1.0, 20.0, 'full'),\n        # Test case 5: high k, strong damping, selective\n        (5.0, 1.0, 20.0, 'selective'),\n    ]\n\n    results = []\n    \n    # Initial conditions vector y(0) = [H(0), M(0), Z^0(0), Z^1(0)]^T\n    y0 = np.array([1.0, 1.0, 0.0, 0.0])\n\n    for k, kappa, T, damping_type in test_cases:\n        # Set formulation-dependent damping rates kappa_0 and kappa_1\n        if damping_type == 'full':\n            kappa_0 = kappa\n            kappa_1 = kappa\n        elif damping_type == 'selective':\n            kappa_0 = kappa\n            kappa_1 = 0.0\n        \n        # Construct the system matrix A for the ODE system dy/dt = A*y\n        A = np.array([\n            [-d_H, 0.0, -b_H, -a_H * k],\n            [0.0, -d_M, -a_M * k, -b_M * k],\n            [-e_0, -c_0 * k, -kappa_0, 0.0],\n            [-c_1 * k, -e_1, 0.0, -kappa_1]\n        ])\n\n        # The exact solution to the linear ODE system is y(T) = exp(A*T) @ y(0).\n        # We compute the matrix exponential of (A*T).\n        evolution_operator = expm(A * T)\n        \n        # Apply the evolution operator to the initial state to get the final state.\n        y_T = evolution_operator @ y0\n\n        # Extract final constraint amplitudes\n        H_T = y_T[0]\n        M_T = y_T[1]\n\n        # Initial values are H(0) = 1.0, M(0) = 1.0\n        H_0 = 1.0\n        M_0 = 1.0\n\n        # Calculate the diagnostic quantities R_H and R_M\n        # The log10 of the ratio of final to initial absolute amplitudes\n        R_H = np.log10(np.abs(H_T) / H_0)\n        R_M = np.log10(np.abs(M_T) / M_0)\n\n        results.extend([R_H, R_M])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3497100"}]}