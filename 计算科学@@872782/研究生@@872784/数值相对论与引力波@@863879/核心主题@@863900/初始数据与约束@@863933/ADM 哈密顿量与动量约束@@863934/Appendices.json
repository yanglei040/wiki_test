{"hands_on_practices": [{"introduction": "应用ADM形式主义的第一步是根据给定的时空线元正确识别出“lapse”函数、“shift”矢量和空间度规。本练习通过在非惯性的旋转坐标系中考察平直的闵可夫斯基时空，为掌握这项基本技能提供了实践。通过完成这个例子[@problem_id:3463445]，您将具体理解这些几何量在不同坐标选择下的表现形式，并验证它们之间的基本关系。", "problem": "考虑写在惯性圆柱坐标 $\\left(t',r,\\phi',z\\right)$ 中的平直闵可夫斯基时空，其线元为 $\\mathrm{d}s^{2}=-\\mathrm{d}t'^{2}+\\mathrm{d}r^{2}+r^{2}\\mathrm{d}\\phi'^{2}+\\mathrm{d}z^{2}$。通过光滑、随时变动的坐标变换，引入一个角速度为常数 $\\Omega$ 的匀速旋转圆柱坐标图 $\\left(t,r,\\phi,z\\right)$：\n$\\displaystyle t'=t,\\quad r'=r,\\quad z'=z,\\quad \\phi'=\\phi+\\Omega t.$\n在 Arnowitt–Deser–Misner (ADM) $3+1$ 分解的框架内，明确求出在旋转坐标图中 $t=\\text{常数}$ 切片上的衰减函数 $N$、移动分量 $\\beta^{i}$ (其中 $i\\in\\{r,\\phi,z\\}$) 和空间度规分量 $\\gamma_{ij}$。然后，通过从第一性原理计算两边，验证恒等式 $\\sqrt{-g}=N\\sqrt{\\gamma}$，其中 $g$ 是时空度规的行列式，$\\gamma$ 是空间度规 $\\gamma_{ij}$ 的行列式。假设 $r\\ge 0$ 并为衰减函数选择时间前进的取向。\n\n答案规格：\n- 以单行矩阵的形式提供最终答案，顺序为 $\\left(N,\\beta^{r},\\beta^{\\phi},\\beta^{z},\\gamma_{rr},\\gamma_{\\phi\\phi},\\gamma_{zz}\\right)$，并表示为 $r$ 和 $\\Omega$ 的函数。\n- 不包含任何单位。", "solution": "该问题是有效的，因为它科学地基于广义相对论的原理，特别是 Arnowitt–Deser–Misner (ADM) $3+1$ 形式体系，并且提出了一个具有唯一解的适定数学物理问题。所有必要的信息都已提供，问题没有矛盾或含糊不清之处。\n\n我们的第一步是求出旋转圆柱坐标系 $(t, r, \\phi, z)$ 中的时空度规。给定从惯性圆柱坐标 $(t', r, \\phi', z)$ 到旋转坐标的坐标变换：\n$$t' = t$$\n$$r' = r$$\n$$z' = z$$\n$$\\phi' = \\phi + \\Omega t$$\n其中 $\\Omega$ 是一个常数角速度。为了变换线元，我们首先用非撇坐标计算撇坐标的微分：\n$$\\mathrm{d}t' = \\mathrm{d}t$$\n$$\\mathrm{d}r' = \\mathrm{d}r$$\n$$\\mathrm{d}z' = \\mathrm{d}z$$\n$$\\mathrm{d}\\phi' = \\mathrm{d}\\phi + \\Omega \\, \\mathrm{d}t$$\n惯性系中的线元给出为：\n$$\\mathrm{d}s^{2} = -\\mathrm{d}t'^{2} + \\mathrm{d}r^{2} + r^{2}\\mathrm{d}\\phi'^{2} + \\mathrm{d}z^{2}$$\n代入微分，我们得到旋转系中的线元：\n$$\\mathrm{d}s^{2} = -(\\mathrm{d}t)^{2} + (\\mathrm{d}r)^{2} + r^{2}(\\mathrm{d}\\phi + \\Omega \\, \\mathrm{d}t)^{2} + (\\mathrm{d}z)^{2}$$\n我们展开平方项：\n$$\\mathrm{d}s^{2} = -\\mathrm{d}t^{2} + \\mathrm{d}r^{2} + r^{2}(\\mathrm{d}\\phi^{2} + 2\\Omega \\, \\mathrm{d}\\phi \\, \\mathrm{d}t + \\Omega^{2} \\, \\mathrm{d}t^{2}) + \\mathrm{d}z^{2}$$\n接下来，我们按微分 $\\mathrm{d}t^{2}$、$\\mathrm{d}t \\, \\mathrm{d}x^{i}$ 和 $\\mathrm{d}x^{i}\\mathrm{d}x^{j}$ 对各项进行分组：\n$$\\mathrm{d}s^{2} = (-1 + r^{2}\\Omega^{2})\\mathrm{d}t^{2} + 2r^{2}\\Omega \\, \\mathrm{d}t \\, \\mathrm{d}\\phi + \\mathrm{d}r^{2} + r^{2}\\mathrm{d}\\phi^{2} + \\mathrm{d}z^{2}$$\n从这个表达式中，我们可以读出坐标基 $\\{\\mathrm{d}t, \\mathrm{d}r, \\mathrm{d}\\phi, \\mathrm{d}z\\}$ 中时空度规张量 $g_{\\mu\\nu}$ 的分量：\n$$g_{tt} = -1 + r^{2}\\Omega^{2}$$\n$$g_{t\\phi} = g_{\\phi t} = r^{2}\\Omega$$\n$$g_{rr} = 1$$\n$$g_{\\phi\\phi} = r^{2}$$\n$$g_{zz} = 1$$\n$g_{\\mu\\nu}$ 的所有其他分量都为零。度规张量可以写成一个矩阵：\n$$\n(g_{\\mu\\nu}) = \\begin{pmatrix}\n-1 + r^{2}\\Omega^{2} & 0 & r^{2}\\Omega & 0 \\\\\n0 & 1 & 0 & 0 \\\\\nr^{2}\\Omega & 0 & r^{2} & 0 \\\\\n0 & 0 & 0 & 1\n\\end{pmatrix}\n$$\n现在，我们将其与线元的 ADM $3+1$ 分解联系起来：\n$$\\mathrm{d}s^{2} = -N^{2}\\mathrm{d}t^{2} + \\gamma_{ij}(\\mathrm{d}x^{i} + \\beta^{i}\\mathrm{d}t)(\\mathrm{d}x^{j} + \\beta^{j}\\mathrm{d}t)$$\n展开此形式得到：\n$$\\mathrm{d}s^{2} = (-N^{2} + \\beta_{k}\\beta^{k})\\mathrm{d}t^{2} + 2\\beta_{j}\\mathrm{d}x^{j}\\mathrm{d}t + \\gamma_{ij}\\mathrm{d}x^{i}\\mathrm{d}x^{j}$$\n其中 $\\beta_{j} = \\gamma_{ji}\\beta^{i}$。通过将 $g_{\\mu\\nu}$ 的分量与此一般形式进行比较，我们可以确定衰减函数 $N$、移动向量分量 $\\beta^{i}$ 和空间度规分量 $\\gamma_{ij}$。\n空间度规分量 $\\gamma_{ij}$ 是纯空间项 $\\mathrm{d}x^{i}\\mathrm{d}x^{j}$ 的系数：\n$$\\gamma_{rr} = 1, \\quad \\gamma_{\\phi\\phi} = r^{2}, \\quad \\gamma_{zz} = 1$$\n对于 $i \\neq j$ 的所有非对角分量 $\\gamma_{ij}$ 都为零。空间度规是对角的：\n$$\n(\\gamma_{ij}) = \\begin{pmatrix}\n1 & 0 & 0 \\\\\n0 & r^{2} & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix}\n$$\n移动向量的协变分量 $\\beta_{i}$ 与度规的时空分量 $g_{ti}$ 相关，即 $\\beta_{i} = g_{ti}$。\n$$\\beta_{r} = g_{tr} = 0$$\n$$\\beta_{\\phi} = g_{t\\phi} = r^{2}\\Omega$$\n$$\\beta_{z} = g_{tz} = 0$$\n为了找到逆变分量 $\\beta^{i}$，我们必须使用逆空间度规 $\\gamma^{ij}$ 来提升指标。首先，我们计算 $\\gamma^{ij}$：\n$$\n(\\gamma^{ij}) = (\\gamma_{ij})^{-1} = \\begin{pmatrix}\n1 & 0 & 0 \\\\\n0 & r^{-2} & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix}\n$$\n现在，我们计算 $\\beta^{i} = \\gamma^{ij}\\beta_{j}$：\n$$\\beta^{r} = \\gamma^{rr}\\beta_{r} + \\gamma^{r\\phi}\\beta_{\\phi} + \\gamma^{rz}\\beta_{z} = 1 \\cdot 0 + 0 + 0 = 0$$\n$$\\beta^{\\phi} = \\gamma^{\\phi r}\\beta_{r} + \\gamma^{\\phi\\phi}\\beta_{\\phi} + \\gamma^{\\phi z}\\beta_{z} = 0 + (r^{-2})(r^{2}\\Omega) + 0 = \\Omega$$\n$$\\beta^{z} = \\gamma^{zr}\\beta_{r} + \\gamma^{z\\phi}\\beta_{\\phi} + \\gamma^{zz}\\beta_{z} = 0 + 0 + 1 \\cdot 0 = 0$$\n所以移动向量分量为 $\\beta^{r}=0$，$\\beta^{\\phi}=\\Omega$ 和 $\\beta^{z}=0$。\n最后，我们从 $g_{tt}$ 分量确定衰减函数 $N$：\n$$g_{tt} = -N^{2} + \\beta_{i}\\beta^{i}$$\n首先，计算标量积 $\\beta_{i}\\beta^{i}$：\n$$\\beta_{i}\\beta^{i} = \\beta_{r}\\beta^{r} + \\beta_{\\phi}\\beta^{\\phi} + \\beta_{z}\\beta^{z} = (0)(0) + (r^{2}\\Omega)(\\Omega) + (0)(0) = r^{2}\\Omega^{2}$$\n将此结果和 $g_{tt} = -1 + r^{2}\\Omega^{2}$ 代入 $g_{tt}$ 的方程中：\n$$-1 + r^{2}\\Omega^{2} = -N^{2} + r^{2}\\Omega^{2}$$\n$$-1 = -N^{2} \\implies N^{2} = 1$$\n问题指定为衰减函数选择时间前进的取向，这意味着 $N > 0$。因此，$N=1$。\n\n所需的 ADM 量为：\n$N=1$, $\\beta^{r}=0$, $\\beta^{\\phi}=\\Omega$, $\\beta^{z}=0$, $\\gamma_{rr}=1$, $\\gamma_{\\phi\\phi}=r^{2}$, $\\gamma_{zz}=1$。\n\n任务的第二部分是验证恒等式 $\\sqrt{-g} = N\\sqrt{\\gamma}$。\n首先，我们计算时空度规 $g_{\\mu\\nu}$ 的行列式 $g$：\n$$g = \\det \\begin{pmatrix}\n-1 + r^{2}\\Omega^{2} & 0 & r^{2}\\Omega & 0 \\\\\n0 & 1 & 0 & 0 \\\\\nr^{2}\\Omega & 0 & r^{2} & 0 \\\\\n0 & 0 & 0 & 1\n\\end{pmatrix}$$\n沿第四行展开，然后沿所得 $3 \\times 3$ 矩阵的第二行展开：\n$$g = (1) \\det \\begin{pmatrix}\n-1 + r^{2}\\Omega^{2} & 0 & r^{2}\\Omega \\\\\n0 & 1 & 0 \\\\\nr^{2}\\Omega & 0 & r^{2}\n\\end{pmatrix} = (1)(1) \\det \\begin{pmatrix}\n-1 + r^{2}\\Omega^{2} & r^{2}\\Omega \\\\\nr^{2}\\Omega & r^{2}\n\\end{pmatrix}$$\n$$g = (-1 + r^{2}\\Omega^{2})(r^{2}) - (r^{2}\\Omega)(r^{2}\\Omega) = -r^{2} + r^{4}\\Omega^{2} - r^{4}\\Omega^{2} = -r^{2}$$\n因此，恒等式的左边是：\n$$\\sqrt{-g} = \\sqrt{-(-r^{2})} = \\sqrt{r^{2}}$$\n由于给定 $r\\ge 0$，我们有 $\\sqrt{r^{2}} = r$。所以，$\\sqrt{-g}=r$。\n接下来，我们计算右边，$N\\sqrt{\\gamma}$。空间度规 $\\gamma_{ij}$ 的行列式 $\\gamma$ 是：\n$$\\gamma = \\det(\\gamma_{ij}) = \\det \\begin{pmatrix}\n1 & 0 & 0 \\\\\n0 & r^{2} & 0 \\\\\n0 & 0 & 1\n\\end{pmatrix} = (1)(r^{2})(1) = r^{2}$$\n那么 $\\sqrt{\\gamma} = \\sqrt{r^2} = r$。\n当 $N=1$ 时，右边是：\n$$N\\sqrt{\\gamma} = 1 \\cdot r = r$$\n由于两边都等于 $r$，恒等式 $\\sqrt{-g}=N\\sqrt{\\gamma}$ 得到验证。\n\n最终答案要求按顺序 $(N,\\beta^{r},\\beta^{\\phi},\\beta^{z},\\gamma_{rr},\\gamma_{\\phi\\phi},\\gamma_{zz})$ 排列这些量。\n它们是 $(1, 0, \\Omega, 0, 1, r^2, 1)$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1 & 0 & \\Omega & 0 & 1 & r^{2} & 1\n\\end{pmatrix}\n}\n$$", "id": "3463445"}, {"introduction": "ADM约束方程不仅是理论上的条件，它们也是为数值模拟构建有效初始数据的实用工具。本问题深入探讨了共形方法这一求解哈密顿约束的强大技术，并将其应用于单个无自旋黑洞这一经典案例[@problem_id:3463410]。成功求解共形因子并将其解的参数与物理上的ADM质量联系起来，是数值相对论中的一项核心技能。", "problem": "考虑在 Arnowitt–Deser–Misner (ADM) $3+1$ 分解下，空间超曲面上的广义相对论真空约束方程。假设一个共形平坦的3-度规 $ \\gamma_{ij} = \\psi^{4} \\delta_{ij}$，极大切片 $K = 0$，以及一个没有线动量的、孤立的、不自旋的刺点。在这个时间对称数据中，外曲率的无迹部分为零，因此动量约束被平凡地满足，哈密顿约束简化为关于共形因子 $ \\psi $ 的一个条件。\n\n使用一个经过充分检验的事实：在共形重标定 $ \\gamma_{ij} = \\psi^{4} \\delta_{ij}$下，标量曲率变换为 $R[\\gamma] = - 8 \\psi^{-5} \\nabla^{2} \\psi$，其中 $ \\nabla^{2} $ 是与 $ \\delta_{ij}$ 关联的平坦空间拉普拉斯算子。施加渐近平坦条件 $ \\psi \\to 1 $ 当 $ r \\to \\infty $ 时。采用刺点拟设\n$$\n\\psi(r) = 1 + \\frac{m}{2 r} + u(r),\n$$\n其中 $ m $ 是一个解释为裸质量参数的正常数，$ r $ 是平坦空间中的径向坐标，$ u(r) $ 是一个在 $ \\mathbb{R}^{3} $ 上处处正则且满足当 $ r \\to \\infty $ 时 $ u(r) \\to 0 $ 的函数。\n\n(a) 从真空哈密顿约束和 $ R[\\gamma] $ 的共形变换定律出发，确定当 $ r > 0 $ 时 $ u(r) $ 满足的方程，并在给定的正则性和边界条件下求解。\n\n(b) 使用共形平坦坐标下 Arnowitt–Deser–Misner (ADM) 质量的标准面积分定义，\n$$\nM_{\\mathrm{ADM}} = - \\frac{1}{2 \\pi} \\lim_{r \\to \\infty} \\oint_{S_{r}} \\partial_{i} \\psi \\, dS^{i},\n$$\n计算(a)部分中找到的解的 $ M_{\\mathrm{ADM}} $，以解析表达式的形式给出，并说明其与裸质量参数 $ m $ 的关系。\n\n在几何单位制 ($ G = c = 1 $) 中进行计算，并用这些单位表示最终质量。最终答案必须是单个封闭形式的解析表达式。", "solution": "对问题陈述的有效性进行审查。\n\n### 步骤 1：提取已知条件\n- **框架**：广义相对论的真空约束方程，ADM $3+1$ 分解。\n- **度规拟设**：共形平坦的3-度规，$\\gamma_{ij} = \\psi^{4} \\delta_{ij}$。\n- **切片条件**：极大切片，$K = 0$。\n- **初始数据类型**：时间对称，意味着无迹外曲率为零（$\\tilde{A}_{ij} = 0$）。这也意味着完整外曲率为零，$K_{ij}=0$，因为 $K_{ij} = \\tilde{A}_{ij} + \\frac{1}{3}\\gamma_{ij}K$。\n- **源**：单个、孤立、不自旋、无线性动量的刺点。\n- **共形变换定律**：物理度规 $\\gamma_{ij}$ 的标量曲率 $R[\\gamma]$ 与平坦空间拉普拉斯算子 $\\nabla^2$ 的关系为 $R[\\gamma] = -8 \\psi^{-5} \\nabla^{2} \\psi$。\n- **边界条件**：渐近平坦，当 $r \\to \\infty$ 时 $\\psi \\to 1$。\n- **刺点拟设**：$\\psi(r) = 1 + \\frac{m}{2r} + u(r)$，其中 $m > 0$ 是一个常数，$r$ 是平坦空间径向坐标。\n- **正则性条件**：$u(r)$ 是一个在 $\\mathbb{R}^{3}$ 上处处正则的函数。\n- **$u$ 的边界条件**：当 $r \\to \\infty$ 时 $u(r) \\to 0$。\n- **ADM 质量的定义**：$M_{\\mathrm{ADM}} = - \\frac{1}{2 \\pi} \\lim_{r \\to \\infty} \\oint_{S_{r}} \\partial_{i} \\psi \\, dS^{i}$。\n- **单位**：几何单位制，$G = c = 1$。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题牢固地植根于广义相对论的标准数学形式体系，特别是 ADM $3+1$ 分解和求解初值问题（Lichnerowicz-York 方程）的共形方法。该设置对应于为单个不自旋黑洞（史瓦西黑洞）构建初始数据。这些方程和定义在数值相对论领域是标准的。\n- **适定性**：该问题是适定的。它提供了所有必要的方程、边界条件和正则性条件，以找到 $u(r)$ 的唯一解并随后计算 ADM 质量。\n- **客观性**：该问题以精确、无偏见和正式的语言陈述，使用了物理学和数学的标准术语。没有歧义或主观性。\n- **结论**：该问题是有效的。这是一个理论物理学中标准的、非平凡的问题，旨在测试对 ADM 形式体系和初始数据构造的理解。\n\n### 步骤 3：结论与行动\n问题有效。将提供完整解答。\n\n### (a) $u(r)$ 的方程及解\n\n广义相对论中的初值问题要求在空间超曲面上满足哈密顿约束和动量约束方程。在真空中，这些方程是：\n$$\nR + K^2 - K_{ij}K^{ij} = 0 \\quad (\\text{哈密顿约束})\n$$\n$$\nD_j K^{ij} - D^i K = 0 \\quad (\\text{动量约束})\n$$\n其中 $R$ 是3-度规 $\\gamma_{ij}$ 的里奇标量，$K_{ij}$ 是外曲率，$K = \\gamma^{ij}K_{ij}$ 是其迹，$D_i$ 是与 $\\gamma_{ij}$ 相容的协变导数。\n\n该问题指定了极大切片（$K=0$）和时间对称数据。对于一个不自旋的刺点，时间对称性意味着外曲率恒为零，$K_{ij} = 0$。在这种情况下，动量约束被平凡地满足（$0=0$），哈密顿约束简化为：\n$$\nR = 0\n$$\n问题给出了在共形变换 $\\gamma_{ij} = \\psi^{4} \\delta_{ij}$下标量曲率的变换定律：\n$$\nR[\\gamma] = -8 \\psi^{-5} \\nabla^{2} \\psi\n$$\n其中 $\\nabla^2$ 是与度规 $\\delta_{ij}$ 相关的标准平坦空间拉普拉斯算子。将此代入简化的哈密顿约束中得到：\n$$\n-8 \\psi^{-5} \\nabla^{2} \\psi = 0\n$$\n共形因子 $\\psi$ 在无穷远处趋近于 $1$，而项 $\\frac{m}{2r}$ 确保其几乎处处非零。因此，为使方程成立，我们必须有：\n$$\n\\nabla^{2} \\psi = 0\n$$\n这是共形因子 $\\psi$ 在平坦空间中的拉普拉斯方程。问题陈述该方程在 $r > 0$ 时成立，这是恰当的，因为物理设置在原点 $r=0$ 处包含一个刺点。\n\n现在，我们代入给定的 $\\psi(r)$ 的拟设：\n$$\n\\psi(r) = 1 + \\frac{m}{2r} + u(r)\n$$\n应用拉普拉斯算子：\n$$\n\\nabla^2 \\left( 1 + \\frac{m}{2r} + u(r) \\right) = 0\n$$\n根据拉普拉斯算子的线性性：\n$$\n\\nabla^2(1) + \\nabla^2\\left(\\frac{m}{2r}\\right) + \\nabla^2 u(r) = 0\n$$\n常数的拉普拉斯算子为零，所以 $\\nabla^2(1) = 0$。对于第二项，我们回想起函数 $1/r$ 是三维拉普拉斯方程的基本解，即 $\\nabla^2(1/r) = -4\\pi\\delta^{(3)}(\\mathbf{r})$，其中 $\\delta^{(3)}(\\mathbf{r})$ 是以原点为中心的狄拉克δ函数。对于任何 $r>0$，我们都远离δ函数的支撑集，所以 $\\nabla^2(1/r) = 0$。因此，对于 $r>0$，有 $\\nabla^2\\left(\\frac{m}{2r}\\right) = \\frac{m}{2}\\nabla^2\\left(\\frac{1}{r}\\right) = 0$。\n\n因此，对于 $r>0$，$u(r)$ 的方程简化为：\n$$\n\\nabla^2 u(r) = 0\n$$\n我们必须在给定条件下解此方程。由于整个问题是球对称的，我们假设 $u$ 仅是径向坐标 $r$ 的函数，$u=u(r)$。三维拉普拉斯方程的一般球对称解是：\n$$\nu(r) = A + \\frac{B}{r}\n$$\n其中 $A$ 和 $B$ 是常数。我们应用关于 $u(r)$ 的两个条件：\n1.  渐近行为：当 $r \\to \\infty$ 时，$u(r) \\to 0$。将此极限应用于一般解，得到 $A = 0$。因此解必须具有 $u(r) = B/r$ 的形式。\n2.  正则性：$u(r)$ 必须在整个 $\\mathbb{R}^3$ 上是正则的，这包括原点 $r=0$。形式为 $B/r$ 的函数在 $r=0$ 处是奇异的，除非 $B=0$。因此，为了使 $u(r)$ 处处正则，我们必须有 $B=0$。\n\n这两个条件共同唯一地确定了对于所有 $r$，$u(r)=0$。\n\n$u(r)$ 满足的方程是 $\\nabla^2 u(r) = 0$，在给定条件下的解是 $u(r) = 0$。\n\n### (b) ADM 质量的计算\n\n根据(a)部分的解，共形因子为：\n$$\n\\psi(r) = 1 + \\frac{m}{2r}\n$$\nADM 质量由无穷远处的面积分给出：\n$$\nM_{\\mathrm{ADM}} = - \\frac{1}{2 \\pi} \\lim_{r \\to \\infty} \\oint_{S_{r}} \\partial_{i} \\psi \\, dS^{i}\n$$\n这里，$S_r$ 是一个半径为 $r$ 的球面，$dS^i$ 是向外的面元矢量。我们首先计算 $\\psi$ 的梯度 $\\partial_i \\psi$。由于 $\\psi$ 仅依赖于 $r = \\sqrt{x^k x_k}$，我们使用链式法则：\n$$\n\\partial_i \\psi = \\frac{d\\psi}{dr} \\frac{\\partial r}{\\partial x^i}\n$$\n关于 $r$ 的导数是：\n$$\n\\frac{d\\psi}{dr} = \\frac{d}{dr}\\left(1 + \\frac{m}{2r}\\right) = -\\frac{m}{2r^2}\n$$\n$r$ 的偏导数是：\n$$\n\\frac{\\partial r}{\\partial x^i} = \\frac{\\partial}{\\partial x^i} \\sqrt{x^k x_k} = \\frac{1}{2\\sqrt{x^k x_k}} (2x_i) = \\frac{x_i}{r}\n$$\n将这些结合起来，梯度为：\n$$\n\\partial_i \\psi = -\\frac{m}{2r^2} \\frac{x_i}{r}\n$$\n面元矢量是 $dS^i = n^i dS$，其中 $n^i = x^i/r$ 是球面的向外单位法向量，$dS$ 是标量面积元。\n现在我们可以计算面积分的被积函数（隐含对重复指标 $i$ 的求和）：\n$$\n\\partial_i \\psi \\, dS^i = \\left(-\\frac{m}{2r^2} \\frac{x_i}{r}\\right) \\left(\\frac{x^i}{r} dS\\right) = -\\frac{m}{2r^2} \\frac{x_i x^i}{r^2} dS\n$$\n由于 $x_i x^i = r^2$，被积函数简化为：\n$$\n\\partial_i \\psi \\, dS^i = -\\frac{m}{2r^2} \\frac{r^2}{r^2} dS = -\\frac{m}{2r^2} dS\n$$\n现在我们计算在球面 $S_r$ 上的积分：\n$$\n\\oint_{S_r} \\partial_i \\psi \\, dS^i = \\oint_{S_r} \\left(-\\frac{m}{2r^2}\\right) dS\n$$\n项 $-\\frac{m}{2r^2}$ 在半径为 $r$ 的球面上是常数，因此可以从积分中提出：\n$$\n-\\frac{m}{2r^2} \\oint_{S_r} dS = -\\frac{m}{2r^2} (\\text{Area of } S_r) = -\\frac{m}{2r^2} (4\\pi r^2) = -2\\pi m\n$$\n最后，我们将此结果代回 ADM 质量的公式中：\n$$\nM_{\\mathrm{ADM}} = - \\frac{1}{2 \\pi} \\lim_{r \\to \\infty} (-2\\pi m)\n$$\n由于表达式 $-2\\pi m$ 与 $r$ 无关，极限是平凡的：\n$$\nM_{\\mathrm{ADM}} = - \\frac{1}{2 \\pi} (-2\\pi m) = m\n$$\nADM 质量 $M_{\\mathrm{ADM}}$ 精确地等于裸质量参数 $m$。这个结果是预料之中的，因为该构造对应于质量为 $m$ 的史瓦西黑洞在各向同性坐标系下的空间度规。", "answer": "$$\n\\boxed{m}\n$$", "id": "3463410"}, {"introduction": "虽然爱因斯坦方程的不同形式在理论上是等价的，但它们在数值模拟中的行为可能截然不同。本练习探讨了双曲性这一关键概念，它决定了时间演化系统的稳定性和适定性[@problem_id:3463393]。通过一个引导性的数值实验，您将证明为何原始的ADM形式是弱双曲的且易于产生不稳定性，以及BSSN等改进形式如何修正这一缺陷，从而促成了现代研究所使用的稳健代码。", "problem": "要求您从第一性原理出发，设计并实现一个数值演示，通过在约束传播子系统的冻结系数、一维平面波简化下，测量微小的违反约束的微扰的增长，来区分 Arnowitt–Deser–Misner (ADM) 表述中的弱双曲性与 Baumgarte–Shapiro–Shibata–Nakamura (BSSN) 表述中的强双曲性。\n\n从爱因斯坦场方程的基本 $3+1$ 分解开始，其中空间度规用 $\\gamma_{ij}$ 表示，外在曲率用 $K_{ij}$ 表示。哈密顿约束 $H$ 和动量约束 $M_i$ 在精确解上为零。请定义 $H$ 和 $M_i$，并回顾：当在闵可夫斯基时空附近进行线性化并限定于主部（最高空间导数项）时，约束传播方程是通过将缩并的 Bianchi 恒等式与在固定规范下 $\\gamma_{ij}$ 和 $K_{ij}$ 的演化方程相结合得到的。在均匀背景下的冻结系数近似中，并采用波数为 $k$ 的一维平面波拟设，主符号将偏微分方程简化为关于约束的傅里叶振幅的常系数线性常微分方程。\n\n您的任务是：\n- 在主符号的层面上，推导能够一致地表示标量哈密顿约束和纵向动量约束传播的最小二维模态系统。此推导需针对纯粹的 Arnowitt–Deser–Misner (ADM) 表述和 Baumgarte–Shapiro–Shibata–Nakamura (BSSN) 表述，并在一维平面波拟设（波数为 $k$）下进行。您的推导应基于 $3+1$ 分解的定义以及冻结系数、平面波简化。除了从这些基本步骤得出的形式外，不要做任何其他特定形式的假设。\n- 使用您推导出的模态系统，实现一个时间上精确的积分器，为小的初始数据生成约束振幅的时间序列。对于每个时间序列，计算两种增长诊断指标：\n  - 通过在采样时间 $t \\in [0,T]$ 上将振幅 $A(t)$ 与 $a + b t$ 进行最小二乘拟合得到的最佳拟合线性增长率，返回斜率 $b$。\n  - 在相同时间区间内，通过将 $\\ln A(t)$ 与 $\\alpha + \\gamma t$ 进行最小二乘拟合得到的最佳拟合指数增长率，返回斜率 $\\gamma$。\n- 将测量的增长诊断指标与主符号分析所蕴含的理论预测进行比较：对于具有亏损主符号的弱双曲系统，预期会出现时间上的多项式增长，但没有指数增长；对于具有可对角化主符号和纯虚特征速度的强双曲系统，预期会出现有界振荡，且指数增长为零。使用这些预期来为下面的每个测试用例定义通过/失败标准。\n\n在几何单位制下工作，以使所有量均为无量纲。所有角度都应解释为弧度。您的程序必须输出布尔值，因此无需打印任何物理单位。\n\n测试套件规范：\n- 使用以下参数化测试用例，每个用例由一个元组定义，该元组包含表述标签、波数 $k$、初始模态振幅对、最终时间 $T$ 以及 $t=0$ 和 $t=T$ 之间（含两端）的均匀间隔采样点数 $N$。对于表述标签，请使用字面值字符串 \"ADM\" 和 \"BSSN\"。对于 \"ADM\"，初始对对应于 $(H(0),M(0))$。对于 \"BSSN\"，初始对对应于您所选择的二分量约束模态的 $(C_1(0),C_2(0))$。\n  - 用例 1：“ADM”，$k = 1$，$(H(0),M(0)) = (10^{-6},0)$，$T = 10^{3}$，$N = 2001$。\n  - 用例 2：“ADM”，$k = 10$，$(H(0),M(0)) = (2\\cdot 10^{-6},10^{-7})$，$T = 10^{3}$，$N = 2001$。\n  - 用例 3：“BSSN”，$k = 1$，$(C_1(0),C_2(0)) = (10^{-6},2\\cdot 10^{-6})$，$T = 10^{3}$，$N = 2001$。\n  - 用例 4：“BSSN”，$k = 0$，$(C_1(0),C_2(0)) = (10^{-6},2\\cdot 10^{-6})$，$T = 10^{3}$，$N = 2001$。\n\n将诊断指标转换为布尔值的评估标准：\n- 对于 \"ADM\" 用例，如果测得的最佳拟合线性斜率 $b$ 与您的主符号所蕴含的预测值在相对容差 $\\tau_{\\mathrm{rel}} = 5\\cdot 10^{-2}$ 内一致，并且最佳拟合指数增长率 $|\\gamma| \\le \\tau_{\\exp}$（其中 $\\tau_{\\exp} = 10^{-12}$），则宣布成功。\n- 对于 \"BSSN\" 用例，如果最佳拟合指数增长率满足 $|\\gamma| \\le \\tau_{\\exp}$（其中 $\\tau_{\\exp} = 10^{-12}$），并且最佳拟合线性斜率满足 $|b| \\le \\tau_{\\mathrm{lin}}$（其中 $\\tau_{\\mathrm{lin}} = 10^{-12}$），则宣布成功。\n\n您的程序应生成单行输出，其中包含按上述顺序列出的用例结果，格式为逗号分隔的布尔值列表，不含空格，并用方括号括起来，例如 \"[True,False,True,True]\"。", "solution": "该问题要求从第一性原理出发，推导并进行数值演示，以展示爱因斯坦方程的 Arnowitt–Deser–Misner (ADM) 表述和 Baumgarte–Shapiro–Shibata–Nakamura (BSSN) 表述的不同双曲性。这是通过在一个简化的一维平面波背景下分析约束违背的增长来实现的。\n\n### 1. 理论框架：约束传播\n\n在 $3+1$ 分解中，爱因斯坦场方程产生了一组关于空间度规 $\\gamma_{ij}$ 和外在曲率 $K_{ij}$ 的演化方程，以及一组必须始终满足的约束条件。这些约束是哈密顿约束 $H=0$ 和动量约束 $M_i=0$。在真空中，它们由以下公式给出：\n$$ H = R + K^2 - K_{ij} K^{ij} = 0 $$\n$$ M_i = \\nabla_j (K^j_i - \\delta^j_i K) = 0 $$\n其中 $R$ 是空间 Ricci 标量，$K = \\gamma^{ij}K_{ij}$ 是外在曲率的迹，$\\nabla_j$ 是与 $\\gamma_{ij}$ 兼容的协变导数。\n\n如果演化方程得到满足，约束的时间导数就由缩并的 Bianchi 恒等式（$\\nabla_\\mu G^{\\mu\\nu}=0$）确定。分析这些约束传播方程的主部（最高空间导数项）可以揭示系统的性质。我们进行平面波分析，假设所有场都具有 $e^{i k_l x^l}$ 形式的空间依赖性，这将空间导数 $\\partial_j$ 转换为代数乘法 $i k_j$。我们将分析限制在沿 $x$ 轴传播的单个平面波，因此 $\\vec{k} = (k, 0, 0)$。我们关注标量哈密顿约束 $H$ 和动量约束的纵向分量 $M_L \\equiv M_x$ 的耦合系统。\n\n### 2. Arnowitt–Deser–Misner (ADM) 表述\n\n在标准的 ADM 表述中，$\\gamma_{ij}$ 和 $K_{ij}$ 的演化方程与 Bianchi 恒等式相结合，得出一个约束传播系统，其主部为（在闵可夫斯基空间附近，采用诸如调和或测地切片的简单规范下进行线性化）：\n$$ \\partial_t \\hat{H} = 0 $$\n$$ \\partial_t \\hat{M}_i = -i k_i \\hat{H} $$\n此处，$\\hat{H}$ 和 $\\hat{M}_i$ 是约束的傅里叶振幅。考虑纵向模 $M_x$，状态向量 $C_{ADM}(t) = (\\hat{H}(t), \\hat{M}_x(t))^T$ 的系统为：\n$$ \\frac{d}{dt} \\begin{pmatrix} \\hat{H} \\\\ \\hat{M}_x \\end{pmatrix} = \\begin{pmatrix} 0 & 0 \\\\ -ik & 0 \\end{pmatrix} \\begin{pmatrix} \\hat{H} \\\\ \\hat{M}_x \\end{pmatrix} $$\n系统矩阵 $P_{ADM} = \\begin{pmatrix} 0 & 0 \\\\ -ik & 0 \\end{pmatrix}$ 有一个重复的特征值 $\\lambda=0$。然而，它只有一个线性无关的特征向量 $\\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$。这种缺少完备特征向量集的情况使得该矩阵成为亏损矩阵，这是弱双曲系统的定义特征。\n\n该系统的解通过计算矩阵指数 $e^{P_{ADM}t} = I + P_{ADM}t$ 得到（因为 $P_{ADM}^2=0$）：\n$$ \\begin{pmatrix} \\hat{H}(t) \\\\ \\hat{M}_x(t) \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ -ikt & 1 \\end{pmatrix} \\begin{pmatrix} \\hat{H}(0) \\\\ \\hat{M}_x(0) \\end{pmatrix} = \\begin{pmatrix} \\hat{H}(0) \\\\ \\hat{M}_x(0) - ikt\\hat{H}(0) \\end{pmatrix} $$\n假设初始数据 $H_0 = \\hat{H}(0)$ 和 $M_0 = \\hat{M}_x(0)$ 为实数，约束向量的 L2 范数的平方（衡量总约束违背振幅的指标）为：\n$$ A(t)^2 = |\\hat{H}(t)|^2 + |\\hat{M}_x(t)|^2 = H_0^2 + |M_0 - iktH_0|^2 = H_0^2 + M_0^2 + (kH_0t)^2 $$\n振幅为 $A(t) = \\sqrt{H_0^2 + M_0^2 + (kH_0t)^2}$。对于较大的时间 $t$，这表现为线性增长：$A(t) \\approx |kH_0|t$。这种多项式增长是弱双曲性的直接后果。理论上的线性增长率为 $b_{pred} = |kH_0|$，而指数增长率为 $\\gamma_{pred}=0$。\n\n### 3. Baumgarte–Shapiro–Shibata–Nakamura (BSSN) 表述\n\nBSSN 表述引入了新变量，并通过添加依赖于约束的项来修改演化方程。这些修改虽然在精确解上为零，但改变了离壳（off-shell）约束违背的传播方式。对于类 BSSN 表述（包括使结构清晰化的 Z4c 表述）中约束传播子系统主部的一个标准结果是一个对称耦合系统：\n$$ \\partial_t \\hat{H} = -ik_j \\hat{M}^j $$\n$$ \\partial_t \\hat{M}_i = -ik_i \\hat{H} $$\n对于我们的一维平面波，这简化为状态向量 $C_{BSSN}(t) = (\\hat{H}(t), \\hat{M}_x(t))^T$ 的二维系统：\n$$ \\frac{d}{dt} \\begin{pmatrix} \\hat{H} \\\\ \\hat{M}_x \\end{pmatrix} = \\begin{pmatrix} 0 & -ik \\\\ -ik & 0 \\end{pmatrix} \\begin{pmatrix} \\hat{H} \\\\ \\hat{M}_x \\end{pmatrix} $$\n系统矩阵 $P_{BSSN} = \\begin{pmatrix} 0 & -ik \\\\ -ik & 0 \\end{pmatrix}$ 有不同的特征值 $\\lambda = \\pm ik$。由于它有一套完备的特征向量，因此它是可对角化的。纯虚的特征值意味着这是一个强双曲系统，其解是纯粹的振荡波。\n\n在初始条件为 $C_1(0)$ 和 $C_2(0)$ 的情况下，解为：\n$$ \\begin{pmatrix} \\hat{H}(t) \\\\ \\hat{M}_x(t) \\end{pmatrix} = \\begin{pmatrix} \\cos(kt) & i\\sin(kt) \\\\ i\\sin(kt) & \\cos(kt) \\end{pmatrix} \\begin{pmatrix} C_1(0) \\\\ C_2(0) \\end{pmatrix} $$\n假设初始数据 $C_{10} = \\hat{H}(0)$ 和 $C_{20} = \\hat{M}_x(0)$ 为实数，振幅的平方为：\n$$ A(t)^2 = |\\hat{H}(t)|^2 + |\\hat{M}_x(t)|^2_2 = |C_{10}\\cos(kt) + iC_{20}\\sin(kt)|^2 + |iC_{10}\\sin(kt) + C_{20}\\cos(kt)|^2 $$\n$$ A(t)^2 = (C_{10}^2\\cos^2(kt) + C_{20}^2\\sin^2(kt)) + (C_{10}^2\\sin^2(kt) + C_{20}^2\\cos^2(kt)) = C_{10}^2 + C_{20}^2 $$\n振幅 $A(t) = \\sqrt{C_{10}^2+C_{20}^2}$ 不随时间变化。这种有界行为是强双曲系统的关键特征。因此，理论上的线性（$b$）和指数（$\\gamma$）增长率均为零。对于 $k=0$ 的特殊情况，系统矩阵为零，导致振幅恒定，同样预测 $b=0$ 和 $\\gamma=0$。\n\n### 4. 数值诊断与评估\n\n对于每个测试用例，我们使用上面推导出的精确解析解来生成振幅 $A(t)$ 的时间序列。然后我们通过最小二乘拟合计算两个诊断指标：\n1.  线性斜率 $b$：通过将 $A(t)$ 拟合到 $a+bt$ 得到。\n2.  指数增长率 $\\gamma$：通过将 $\\ln A(t)$ 拟合到 $\\alpha+\\gamma t$ 得到。\n\n每个测试的成功与否取决于将这些测量的诊断指标与理论预测进行比较，并符合指定的容差。对于 ADM，我们预期 $b \\approx b_{pred}$ 且 $\\gamma \\approx 0$。对于 BSSN，我们预期 $b \\approx 0$ 且 $\\gamma \\approx 0$。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the numerical demonstration for ADM and BSSN constraint propagation.\n    \"\"\"\n    # Test case format: (formulation, k, initial_conds, T, N)\n    test_cases = [\n        (\"ADM\", 1.0, (1e-6, 0.0), 1000.0, 2001),\n        (\"ADM\", 10.0, (2e-6, 1e-7), 1000.0, 2001),\n        (\"BSSN\", 1.0, (1e-6, 2e-6), 1000.0, 2001),\n        (\"BSSN\", 0.0, (1e-6, 2e-6), 1000.0, 2001),\n    ]\n\n    results = []\n    for case in test_cases:\n        formulation, k, initial_conds, T, N = case\n        t_samples = np.linspace(0, T, N)\n        \n        if formulation == \"ADM\":\n            H0, M0 = initial_conds\n            # Analytical solution for ADM constraint amplitude:\n            # A_adm(t) = sqrt(H0^2 + M0^2 + (k*H0*t)^2)\n            amplitudes = np.sqrt(H0**2 + M0**2 + (k * H0 * t_samples)**2)\n            \n            # Theoretical prediction for linear growth slope\n            b_pred = np.abs(k * H0)\n            \n            # --- Diagnostics ---\n            # Best-fit linear growth rate `b`\n            b, _ = np.polyfit(t_samples, amplitudes, 1)\n            \n            # Best-fit exponential growth rate `gamma`\n            # Add a small epsilon to avoid log(0), although not an issue with these inputs.\n            log_amplitudes = np.log(amplitudes + 1e-30)\n            gamma, _ = np.polyfit(t_samples, log_amplitudes, 1)\n            \n            # --- Evaluation ---\n            tol_rel = 5e-2\n            tol_exp = 1e-12\n            \n            # Check linear growth rate agreement\n            if np.abs(b_pred)  1e-20: # If prediction is zero\n                linear_check = np.abs(b) = tol_rel # Use an absolute check\n            else:\n                rel_error_b = np.abs(b - b_pred) / np.abs(b_pred)\n                linear_check = rel_error_b = tol_rel\n\n            # Check for lack of exponential growth\n            exp_check = np.abs(gamma) = tol_exp\n            \n            results.append(linear_check and exp_check)\n\n        elif formulation == \"BSSN\":\n            C1_0, C2_0 = initial_conds\n            # Analytical solution for BSSN constraint amplitude is constant:\n            # A_bssn(t) = sqrt(C1_0^2 + C2_0^2)\n            const_amplitude = np.sqrt(C1_0**2 + C2_0**2)\n            amplitudes = np.full_like(t_samples, const_amplitude)\n            \n            # --- Diagnostics ---\n            # Best-fit linear growth rate `b`\n            b, _ = np.polyfit(t_samples, amplitudes, 1)\n            \n            # Best-fit exponential growth rate `gamma`\n            log_amplitudes = np.log(amplitudes + 1e-30)\n            gamma, _ = np.polyfit(t_samples, log_amplitudes, 1)\n            \n            # --- Evaluation ---\n            tol_exp = 1e-12\n            tol_lin = 1e-12\n            \n            # Check for lack of exponential and linear growth\n            exp_check = np.abs(gamma) = tol_exp\n            linear_check = np.abs(b) = tol_lin\n            \n            results.append(exp_check and linear_check)\n\n    # Format the final output as a comma-separated list of booleans\n    print(f\"[{','.join(map(str, results))}]\")\n\n# Run the simulation\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3463393"}]}