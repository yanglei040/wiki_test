{"hands_on_practices": [{"introduction": "并合后形成的超大质量中子星（HMNS）是快速旋转的天体，其稳定性由旋转动能与引力束缚能之间的精妙平衡决定。这个平衡通常用无量纲参数 $\\beta \\equiv T/|W|$ 来量化，其中 $T$ 是旋转动能，$|W|$ 是引力束缚能的大小。本练习将指导你通过一个简化的物理模型，计算一个典型 HMNS 的 $\\beta$ 值，并与动态不稳定性（特别是主导的 $m=2$ 棒状模）的阈值进行比较，从而亲手实践如何评估这类极端天体的稳定性。[@problem_id:3483383]", "problem": "你的任务是构建一个独立的程序，该程序为一组代表并合后遗迹的超大质量中子星参数集，计算转动动能与引力结合能之比，将此比率与非轴对称 $m=2$ 棒模不稳定性的触发相关联，并评估热压力在移动不稳定性阈值中的作用。你必须从适用于连续介质力学和引力理论的第一性原理出发，并实现一个最小且物理上自洽的简正模模型来估计指数增长率。\n\n使用以下基本基础和建模假设，全部采用国际单位制 (SI)：\n\n- 转动动能为 $T = \\tfrac{1}{2} I \\Omega^2$，其中 $I$ 是转动惯量，$\\Omega$ 是角频率。\n- 总角动量为 $J = I \\Omega$，这意味着 $T = J^2/(2 I)$。\n- 引力结合能的量值建模为 $|W| = k_W \\dfrac{G M^2}{R}$，其中 $G$ 是牛顿引力常数，$M$ 是引力质量，$R$ 是恒星周向半径，$k_W$ 是一个无量綱结构系数，用于在类牛顿结合能估计中捕捉状态方程的依赖性。\n- 采用转动惯量模型 $I = k_I M R^2$，其中 $k_I$ 是一个无量綱结构系数。\n- 热压力提供超越冷态（零温）位形的额外压力支持。将其建模为半径的膨胀，膨胀的分数增量与热压能量分数 $f_{\\mathrm{th}} \\in [0,1]$ 成正比：\n  $$R = R_{\\mathrm{cold}}\\left(1 + \\chi f_{\\mathrm{th}}\\right),$$\n  其中 $R_{\\mathrm{cold}}$ 是冷半径，$\\chi$ 是一个无量綱膨胀系数。\n- 定义无量綱动能与结合能之比\n  $$\\beta \\equiv \\frac{T}{|W|}.$$\n- 使用致密性参数\n  $$C \\equiv \\frac{G M}{R c^2},$$\n  其中 $c$ 是真空中的光速。\n- 将动态 $m=2$ 棒模不稳定性触发的临界阈值建模为关于牛顿基线的、对致密性和热分数的一阶线性依赖关系：\n  $$\\beta_{\\mathrm{crit}}(C, f_{\\mathrm{th}}) = \\beta_N + a_C\\, C + a_{\\mathrm{th}}\\, f_{\\mathrm{th}},$$\n  其中 $\\beta_N$、$a_C$ 和 $a_{\\mathrm{th}}$ 是下面给出的常数。此参数化表示一个最小线性化趋势，其中广义相对论致密性移动了牛顿阈值，而热压力进一步修正了它。\n- 在不稳定性阈值附近，通过一个简正模振幅方程来模拟不稳定 $m=2$ 模式的指数增长率，该方程的线性增长率与局部转动速率以及超出阈值的分数盈余的平方根成正比：\n  $$\\gamma = \\sigma\\, \\Omega\\, \\sqrt{\\max\\!\\left(\\frac{\\beta}{\\beta_{\\mathrm{crit}}} - 1,\\, 0\\right)},$$\n  其中 $\\sigma$ 是一个无量纲缩放常数，$\\Omega = \\dfrac{J}{I}$。如果 $\\beta \\le \\beta_{\\mathrm{crit}}$，则取 $\\gamma = 0$。\n\n使用的常数：\n- $G = 6.674\\times 10^{-11}\\ \\mathrm{m^3\\,kg^{-1}\\,s^{-2}}$。\n- $c = 2.99792458\\times 10^8\\ \\mathrm{m\\,s^{-1}}$。\n- 结构系数：$k_I = 0.35$，$k_W = 0.60$。\n- 热膨胀系数：$\\chi = 0.30$。\n- 阈值模型系数：$\\beta_N = 0.266$，$a_C = -0.10$，$a_{\\mathrm{th}} = +0.05$。\n- 增长率尺度：$\\sigma = 0.60$。\n\n对于下面的每个测试案例，计算：\n1. 热膨胀半径 $R$（单位：米）。\n2. 转动惯量 $I$（单位：$\\mathrm{kg\\,m^2}$）。\n3. 引力结合能的量值 $|W|$（单位：焦耳）。\n4. 转动动能 $T$（单位：焦耳）。\n5. 比率 $\\beta = T/|W|$（无量纲）。\n6. 致密性 $C$（无量纲）。\n7. 阈值 $\\beta_{\\mathrm{crit}}$（无量纲）。\n8. 角频率 $\\Omega$（单位：$\\mathrm{s^{-1}}$）。\n9. 由 $\\beta > \\beta_{\\mathrm{crit}}$ 定义的不稳定性布尔值。\n10. 增长率 $\\gamma$（单位：$\\mathrm{s^{-1}}$）。\n\n以 $\\mathrm{s^{-1}}$ 为单位表示最终增长率 $\\gamma$。所有浮点输出应四舍五入到六位小数。除了明确指定角频率 $\\Omega$ 的单位为 $\\mathrm{s^{-1}}$ 外，不需要角度单位。\n\n测试套件（每个案例格式为 $\\{M, R_{\\mathrm{cold}}, J, f_{\\mathrm{th}}\\}$）：\n- 案例 1（亚临界，冷态）：$\\{\\, M = 5.568\\times 10^{30}\\ \\mathrm{kg},\\ R_{\\mathrm{cold}} = 1.6000\\times 10^{4}\\ \\mathrm{m},\\ J = 1.3345\\times 10^{42}\\ \\mathrm{kg\\,m^2\\,s^{-1}},\\ f_{\\mathrm{th}} = 0.0 \\,\\}$。\n- 案例 2（近阈值，冷态）：$\\{\\, M = 5.568\\times 10^{30}\\ \\mathrm{kg},\\ R_{\\mathrm{cold}} = 1.6000\\times 10^{4}\\ \\mathrm{m},\\ J = 1.3632\\times 10^{42}\\ \\mathrm{kg\\,m^2\\,s^{-1}},\\ f_{\\mathrm{th}} = 0.0 \\,\\}$。\n- 案例 3（超临界，冷态）：$\\{\\, M = 5.568\\times 10^{30}\\ \\mathrm{kg},\\ R_{\\mathrm{cold}} = 1.6000\\times 10^{4}\\ \\mathrm{m},\\ J = 1.4190\\times 10^{42}\\ \\mathrm{kg\\,m^2\\,s^{-1}},\\ f_{\\mathrm{th}} = 0.0 \\,\\}$。\n- 案例 4（临界，热支持）：$\\{\\, M = 5.568\\times 10^{30}\\ \\mathrm{kg},\\ R_{\\mathrm{cold}} = 1.6000\\times 10^{4}\\ \\mathrm{m},\\ J = 1.3913\\times 10^{42}\\ \\mathrm{kg\\,m^2\\,s^{-1}},\\ f_{\\mathrm{th}} = 0.3 \\,\\}$。\n- 案例 5（热稳定）：$\\{\\, M = 5.568\\times 10^{30}\\ \\mathrm{kg},\\ R_{\\mathrm{cold}} = 1.6000\\times 10^{4}\\ \\mathrm{m},\\ J = 1.4190\\times 10^{42}\\ \\mathrm{kg\\,m^2\\,s^{-1}},\\ f_{\\mathrm{th}} = 0.6 \\,\\}$。\n\n要求的程序输出：\n- 对于每个测试案例，输出一个包含四个元素的列表：$\\left[\\beta,\\ \\beta_{\\mathrm{crit}},\\ \\text{is\\_unstable},\\ \\gamma\\right]$，其中 $\\beta$ 和 $\\beta_{\\mathrm{crit}}$ 是无量纲浮点数，$\\text{is\\_unstable}$ 是一个布尔值，$\\gamma$ 是一个单位为 $\\mathrm{s^{-1}}$ 的浮点数。将所有浮点数四舍五入到六位小数。\n- 你的程序应生成单行输出，其中包含所有五个案例的结果，形式为一个由方括号括起来的逗号分隔列表，例如：\n$$[\\,[\\beta_1,\\ \\beta_{\\mathrm{crit},1},\\ \\text{is\\_unstable}_1,\\ \\gamma_1],\\ \\ldots,\\ [\\beta_5,\\ \\beta_{\\mathrm{crit},5},\\ \\text{is\\_unstable}_5,\\ \\gamma_5]\\,].$$", "solution": "该问题被视为有效。它提出了一个独立的、物理上和数学上自洽的建模任务，该任务基于天体物理学中的既定原理。所有必要的参数、常数和方程都已提供，且目标明确。该模型虽然简化，但使用了研究中子星转动不稳定性的标准且合理的近似方法。\n\n任务是为几种超大质量中子星位形计算 $m=2$ 棒模不稳定性的增长率。模型的核心是比较转动动能与引力结合能之比（表示为 $\\beta$）和一个此比率的临界阈值 $\\beta_{\\mathrm{crit}}$。如果 $\\beta > \\beta_{\\mathrm{crit}}$，系统则不稳定。\n\n首先，我们确定所提供的物理常数和模型参数：\n- 引力常数：$G = 6.674\\times 10^{-11}\\ \\mathrm{m^3\\,kg^{-1}\\,s^{-2}}$。\n- 光速：$c = 2.99792458\\times 10^8\\ \\mathrm{m\\,s^{-1}}$。\n- 转动惯量结构系数：$k_I = 0.35$。\n- 引力结合能结构系数：$k_W = 0.60$。\n- 热膨胀系数：$\\chi = 0.30$。\n- 不稳定性阈值模型系数：牛顿基线 $\\beta_N = 0.266$，致密性修正 $a_C = -0.10$，热修正 $a_{\\mathrm{th}} = +0.05$。\n- 增长率缩放常数：$\\sigma = 0.60$。\n\n对于每个由参数集 $\\{M, R_{\\mathrm{cold}}, J, f_{\\mathrm{th}}\\}$（分别代表引力质量、冷极限半径、总角动量和热能分数）定义的测试案例，我们按以下顺序进行计算。\n\n1.  **热膨胀半径 ($R$)**: 恒星半径受热压力影响。我们将其建模为从冷半径 $R_{\\mathrm{cold}}$ 开始的线性膨胀，与热分数 $f_{\\mathrm{th}}$ 和耦合系数 $\\chi$ 成正比。\n    $$R = R_{\\mathrm{cold}}\\left(1 + \\chi f_{\\mathrm{th}}\\right)$$\n\n2.  **转动惯量 ($I$)**: 使用膨胀后的半径 $R$，我们通过一个简单的结构模型计算转动惯量 $I$，其中 $k_I$ 是一个依赖于恒星内部密度分布的无量纲常数。\n    $$I = k_I M R^2$$\n\n3.  **引力结合能 ($|W|$)**: 引力结合能的量值 $|W|$ 使用一个类牛顿公式来估计，并通过一个结构因子 $k_W$ 进行修正。\n    $$|W| = k_W \\frac{G M^2}{R}$$\n\n4.  **转动动能 ($T$)**: 转动动能 $T$ 用总角动量 $J$ 和转动惯量 $I$ 表示。\n    $$T = \\frac{J^2}{2 I}$$\n\n5.  **动能与结合能之比 ($\\beta$)**: 这个无量纲比率是控制动态不稳定性的关键参数。它定义为：\n    $$\\beta = \\frac{T}{|W|}$$\n\n6.  **致密性 ($C$)**: 恒星致密性 $C$ 是一个衡量物体引力强度的无量纲参数，定义为其史瓦西半径与物理半径之比。它被用来参数化广义相对论效应。\n    $$C = \\frac{G M}{R c^2}$$\n\n7.  **不稳定性阈值 ($\\beta_{\\mathrm{crit}}$)**: 棒模不稳定性的临界阈值 $\\beta_{\\mathrm{crit}}$ 被建模为致密性 $C$ 和热分数 $f_{\\mathrm{th}}$ 的函数。它代表了对经典牛頓值 $\\beta_N$ 的一阶修正。由 $C$ 捕捉的广义相对论效应是去稳定的（$a_C  0$），因为它降低了不稳定性阈值，而由 $f_{\\mathrm{th}}$ 捕捉的热压力是一种稳定影响（$a_{\\mathrm{th}} > 0$），因为它提高了阈值。\n    $$\\beta_{\\mathrm{crit}}(C, f_{\\mathrm{th}}) = \\beta_N + a_C C + a_{\\mathrm{th}} f_{\\mathrm{th}}$$\n\n8.  **不稳定性条件**: 如果恒星的转动能比率 $\\beta$ 超过临界阈值 $\\beta_{\\mathrm{crit}}$，则其对 $m=2$ 棒模是动态不稳定的。我们定义一个布尔变量 $\\text{is\\_unstable}$，如果 $\\beta > \\beta_{\\mathrm{crit}}$ 则为真，否则为假。\n\n9.  **角频率 ($\\Omega$)**: 计算不稳定性增长率需要角频率 $\\Omega$。它由角动量 $J$ 和转动惯量 $I$ 推导得出。\n    $$\\Omega = \\frac{J}{I}$$\n\n10. **不稳定性增长率 ($\\gamma$)**: 如果恒星不稳定（$\\beta > \\beta_{\\mathrm{crit}}$），棒模形变的振幅将以速率 $\\gamma$ 呈指数增长。该增长率被建模为与恒星的转动速率 $\\Omega$ 以及 $\\beta$ 超出 $\\beta_{\\mathrm{crit}}$ 的分数盈余的平方根成正比。如果恒星稳定，则增长率为零。\n    $$\\gamma = \\begin{cases} \\sigma\\, \\Omega\\, \\sqrt{\\dfrac{\\beta}{\\beta_{\\mathrm{crit}}} - 1}  \\text{if } \\beta > \\beta_{\\mathrm{crit}} \\\\ 0  \\text{if } \\beta \\le \\beta_{\\mathrm{crit}} \\end{cases}$$\n\n通过将这十个步骤应用于每个测试案例，我们可以确定其稳定性属性并计算所需的输出向量 $[\\beta, \\beta_{\\mathrm{crit}}, \\text{is\\_unstable}, \\gamma]$。最终的浮点数值四舍五入到六位小数。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes instability properties for hypermassive neutron star remnants.\n    \"\"\"\n    # Define physical constants and model parameters in SI units\n    G = 6.674e-11  # Gravitational constant (m^3 kg^-1 s^-2)\n    C_LIGHT = 2.99792458e8  # Speed of light (m s^-1)\n    \n    # Structural coefficients\n    K_I = 0.35  # Moment of inertia coefficient\n    K_W = 0.60  # Gravitational binding energy coefficient\n    \n    # Thermal expansion coefficient\n    CHI = 0.30\n    \n    # Instability threshold model coefficients\n    BETA_N = 0.266  # Newtonian baseline threshold\n    A_C = -0.10     # Compactness correction\n    A_TH = 0.05     # Thermal correction\n    \n    # Growth rate scaling constant\n    SIGMA = 0.60\n\n    # Test suite: {M (kg), R_cold (m), J (kg m^2 s^-1), f_th}\n    test_cases = [\n        # Case 1 (subcritical, cold)\n        (5.568e30, 1.6000e4, 1.3345e42, 0.0),\n        # Case 2 (near threshold, cold)\n        (5.568e30, 1.6000e4, 1.3632e42, 0.0),\n        # Case 3 (supercritical, cold)\n        (5.568e30, 1.6000e4, 1.4190e42, 0.0),\n        # Case 4 (marginal, thermally supported)\n        (5.568e30, 1.6000e4, 1.3913e42, 0.3),\n        # Case 5 (thermally stabilized)\n        (5.568e30, 1.6000e4, 1.4190e42, 0.6),\n    ]\n\n    results = []\n    for case in test_cases:\n        m, r_cold, j, f_th = case\n\n        # 1. Thermally expanded radius R\n        r = r_cold * (1 + CHI * f_th)\n\n        # 2. Moment of inertia I\n        inertia = K_I * m * r**2\n\n        # 3. Gravitational binding energy magnitude |W|\n        w_abs = K_W * G * m**2 / r\n\n        # 4. Rotational kinetic energy T\n        t_rot = j**2 / (2 * inertia)\n\n        # 5. Ratio beta = T/|W|\n        beta = t_rot / w_abs\n\n        # 6. Compactness C\n        compactness = (G * m) / (r * C_LIGHT**2)\n\n        # 7. Threshold beta_crit\n        beta_crit = BETA_N + A_C * compactness + A_TH * f_th\n\n        # 8. Angular frequency Omega\n        omega = j / inertia\n\n        # 9. Instability boolean\n        is_unstable = beta > beta_crit\n\n        # 10. Growth rate gamma\n        if is_unstable:\n            gamma = SIGMA * omega * np.sqrt(beta / beta_crit - 1)\n        else:\n            gamma = 0.0\n\n        # Assemble the output list, rounding floats to 6 decimal places\n        inner_result = [\n            round(beta, 6),\n            round(beta_crit, 6),\n            is_unstable,\n            round(gamma, 6)\n        ]\n        results.append(inner_result)\n        \n    # Format the final output as a string representation of a list of lists.\n    # str(list) automatically adds spaces after commas, matching conventions.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "3483383"}, {"introduction": "超大质量中子星的内部动力学过程，如非轴对称振荡，是强大的引力波辐射源。要从探测器的噪声中识别这些信号，关键在于评估其信噪比（SNR）。本练习将引导你使用一个简化的阻尼振荡模型来代表并合后的引力波信号，并计算其在下一代引力波探测器（如爱因斯坦望远镜）中的信噪比，从而让你掌握连接源物理参数（如频率和阻尼时间）与可观测性（SNR）的基本方法。[@problem_id:3483406]", "problem": "双中子星并合中形成的超大质量中子星遗迹可近似为一个单一的阻尼四极振荡，其在探测器处的线性偏振引力波应变可以从并合时刻开始，通过 $h(t) = A\\,\\exp(-t/\\tau)\\,\\cos(2\\pi f_{2} t)\\,u(t)$ 来建模，其中 $u(t)$ 是赫维赛德阶跃函数 (Heaviside step function)，$A$ 是探测器处的应变振幅，$\\tau$ 是阻尼时间，$f_{2}$ 是并合后主导的振荡频率。假设信源相对于探测器处于最佳朝向，并且振幅与光度距离 $D$ 成反比，即 $A(D) \\propto 1/D$。\n\n使用标准的匹配滤波定义的信噪比 (SNR)，以及爱因斯坦望远镜 (Einstein Telescope, ET) 的单边应变噪声功率谱密度 $S_{n}(f)$，假设在由阻尼设定的带宽内，围绕 $f_{2}$ 处窄谱线的噪声水平是局部平坦的，即 $S_{n}(f)\\approx S_{0}$。从稳态高斯噪声中匹配滤波信噪比的基本定义出发，推导该信号在平坦噪声近似下的信噪比表达式，并针对以下代表性参数进行求值：\n- 参考光度距离 $D_{\\mathrm{ref}} = 10\\,\\mathrm{Mpc}$，\n- 在 $D_{\\mathrm{ref}}$ 处的参考振幅：$A_{\\mathrm{ref}} = 1.0\\times 10^{-22}$，\n- 阻尼时间：$\\tau = 20\\,\\mathrm{ms}$，\n- 主导频率：$f_{2} = 2.5\\,\\mathrm{kHz}$，\n- 在 $f_{2}$ 处的爱因斯坦望远镜单边应变噪声谱密度：$S_{0} = (3.0\\times 10^{-25})^{2}\\,\\mathrm{Hz}^{-1}$。\n\n根据你推导出的信噪比表达式，确定信噪比等于 $\\rho=5$ 时的光度距离 $D_{5}$。将最终距离四舍五入到三位有效数字，并以 $\\mathrm{Mpc}$ 为单位表示。你的最终答案必须是一个实数。", "solution": "首先，将对所述问题的科学性和逻辑一致性进行验证。\n\n### 第1步：提取已知条件\n- 信号模型：$h(t) = A\\,\\exp(-t/\\tau)\\,\\cos(2\\pi f_{2} t)\\,u(t)$，其中 $u(t)$ 是赫维赛德阶跃函数。\n- $A$：探测器处的应变振幅。\n- $\\tau$：阻尼时间。\n- $f_{2}$：并合后主导振荡频率。\n- 源朝向：相对于探测器为最佳朝向。\n- 振幅缩放：$A(D) \\propto 1/D$，其中 $D$ 是光度距离。\n- 噪声功率谱密度 (PSD)：单边应变噪声PSD为 $S_{n}(f)$，近似为 $S_{n}(f) \\approx S_{0}$ (局部平坦)。\n- 参考光度距离：$D_{\\mathrm{ref}} = 10\\,\\mathrm{Mpc}$。\n- 在 $D_{\\mathrm{ref}}$ 处的参考振幅：$A_{\\mathrm{ref}} = 1.0\\times 10^{-22}$。\n- 阻尼时间值：$\\tau = 20\\,\\mathrm{ms} = 2.0 \\times 10^{-2}\\,\\mathrm{s}$。\n- 频率值：$f_{2} = 2.5\\,\\mathrm{kHz} = 2.5 \\times 10^3\\,\\mathrm{Hz}$。\n- 噪声水平值：$S_{0} = (3.0\\times 10^{-25})^{2}\\,\\mathrm{Hz}^{-1} = 9.0 \\times 10^{-50}\\,\\mathrm{Hz}^{-1}$。\n- 目标信噪比 (SNR)：$\\rho = 5$。\n- 目标：推导SNR的表达式，并用它来计算SNR为5时的光度距离 $D_{5}$。\n\n### 第2步：使用提取的已知条件进行验证\n- **科学依据：** 该问题基于引力波数据分析的标准原理。信号模型是针对并合后超大质量中子星的铃振阶段的一个常见且有物理动机的近似。匹配滤波信噪比是信号检测理论的基石。所提供的信号参数以及爱因斯坦望远镜的噪声曲线是现实的，并与数值相对论和引力波天文学的当前研究一致。\n- **适定性：** 该问题是适定的。它提供了一个清晰的理论框架、一套完整的参数和一个具体的目标。可以从给定的信息中推导出一个唯一、稳定且有意义的解。\n- **客观性：** 该问题以精确、客观、无偏见的科学语言陈述。\n\n### 第3步：结论与行动\n该问题有效。将提供完整的解答。\n\n### 解答推导\n对于一个傅里叶变换为 $\\tilde{h}(f)$ 的信号，在以单边功率谱密度 $S_{n}(f)$ 为特征的稳态高斯噪声中，其信噪比的平方 $\\rho^2$ 由匹配滤波的基本公式给出：\n$$ \\rho^2 = 4 \\int_{0}^{\\infty} \\frac{|\\tilde{h}(f)|^2}{S_{n}(f)} df $$\n问题陈述中指出，在信号的带宽内，噪声PSD可以被视为常数，即 $S_{n}(f) \\approx S_{0}$。因此，我们可以写出：\n$$ \\rho^2 \\approx \\frac{4}{S_{0}} \\int_{0}^{\\infty} |\\tilde{h}(f)|^2 df $$\n利用帕塞瓦尔定理 (Parseval's theorem)，我们将频域积分转换到时域：\n$$ \\int_{0}^{\\infty} |\\tilde{h}(f)|^2 df = \\frac{1}{2} \\int_{-\\infty}^{\\infty} |h(t)|^2 dt $$\n信号 $h(t)$ 仅在 $t \\ge 0$ 时非零。我们计算信号平方的积分：\n$$ \\int_{0}^{\\infty} |h(t)|^2 dt = A^2 \\int_{0}^{\\infty} e^{-2t/\\tau}\\,\\cos^2(2\\pi f_{2} t)\\,dt $$\n利用 $\\cos^2(\\theta) = \\frac{1}{2}(1 + \\cos(2\\theta))$，并考虑到对于窄带信号（$f_2 \\tau \\gg 1$），振荡项的积分可以忽略不计，我们得到一个高度准确的近似：\n$$ \\int_{0}^{\\infty} |h(t)|^2 dt \\approx A^2 \\int_{0}^{\\infty} e^{-2t/\\tau} \\frac{1}{2} dt = \\frac{A^2}{2} \\left[ -\\frac{\\tau}{2} e^{-2t/\\tau} \\right]_{0}^{\\infty} = \\frac{A^2 \\tau}{4} $$\n将这个结果代入，我们得到信噪比平方的表达式：\n$$ \\rho^2 \\approx \\frac{4}{S_{0}} \\left( \\frac{1}{2} \\frac{A^2 \\tau}{4} \\right) = \\frac{A^2 \\tau}{2S_{0}} $$\n因此，信噪比为 $\\rho \\approx A \\sqrt{\\frac{\\tau}{2S_{0}}}$。\n\n信号振幅 $A$ 与光度距离 $D$ 成反比，因此 $A(D) = A_{\\mathrm{ref}} (D_{\\mathrm{ref}}/D)$。将此代入信噪比表达式，得到信噪比作为距离的函数：\n$$ \\rho(D) = A_{\\mathrm{ref}} \\frac{D_{\\mathrm{ref}}}{D} \\sqrt{\\frac{\\tau}{2S_{0}}} $$\n我们需要找到信噪比为 $\\rho=5$ 时的距离 $D_{5}$。求解 $D_5$ 可得：\n$$ D_{5} = \\frac{A_{\\mathrm{ref}} D_{\\mathrm{ref}}}{5} \\sqrt{\\frac{\\tau}{2S_{0}}} $$\n现在，我们代入给定的数值：\n- $A_{\\mathrm{ref}} = 1.0\\times 10^{-22}$\n- $D_{\\mathrm{ref}} = 10\\,\\mathrm{Mpc}$\n- $\\tau = 20 \\times 10^{-3}\\,\\mathrm{s}$\n- $S_{0} = 9.0 \\times 10^{-50}\\,\\mathrm{Hz}^{-1}$\n\n计算平方根内的无量纲项：\n$$ \\frac{\\tau}{2S_{0}} = \\frac{20 \\times 10^{-3}\\,\\mathrm{s}}{2 \\times 9.0 \\times 10^{-50}\\,\\mathrm{Hz}^{-1}} = \\frac{10}{9} \\times 10^{47} $$\n其平方根为：\n$$ \\sqrt{\\frac{\\tau}{2S_{0}}} = \\sqrt{\\frac{100}{9} \\times 10^{46}} = \\frac{10}{3} \\times 10^{23} $$\n将这些值代入 $D_{5}$ 的表达式中：\n$$ D_{5} = \\frac{(1.0 \\times 10^{-22}) \\times (10\\,\\mathrm{Mpc})}{5} \\left( \\frac{10}{3} \\times 10^{23} \\right) $$\n$$ D_{5} = \\frac{10^{-21}}{5} \\times \\frac{10^{24}}{3} \\,\\mathrm{Mpc} = \\frac{1000}{15} \\,\\mathrm{Mpc} = \\frac{200}{3} \\,\\mathrm{Mpc} \\approx 66.666... \\,\\mathrm{Mpc} $$\n问题要求答案四舍五入到三位有效数字。\n$$ D_{5} \\approx 66.7 \\,\\mathrm{Mpc} $$", "answer": "$$\\boxed{66.7}$$", "id": "3483406"}, {"introduction": "研究超大质量中子星的一个核心科学目标是限制极端密度下的物质状态方程（EoS）。HMNS 的宏观演化特性，例如其在坍缩成黑洞之前的寿命，对状态方程的热成分（由热力学绝热指数 $\\Gamma_{\\mathrm{th}}$ 表征）尤其敏感。本练习提供了一个分析模拟数据的实践机会，你将通过一个唯象模型来量化 HMNS 寿命与 $\\Gamma_{\\mathrm{th}}$ 之间的关系，从而理解如何利用宏观可观测量（如坍缩时间）来揭示微观物理性质。[@problem_id:3483434]", "problem": "考虑两个关于并合后超大质量中子星 (HMNS) 的广义相对论流体动力学模拟，这两个模拟除了状态方程 (EoS) 热部分中的热绝热指数参数外，其他方面完全相同。超大质量中子星 (HMNS) 的振荡会印刻在中心静止质量密度的时间演化上，而坍缩为黑洞则表现为中心密度的快速长期增长。目标是量化仅因热绝热指数不同而导致的坍缩前寿命的变化，并评估这种差异是否与“更强的热支撑会延迟坍缩”这一预期相符。\n\n此问题的基本基础：\n- 广义相对论 (GR) 和相对论性流体动力学意味着应力-能量和重子数的守恒；HMNS 中的压力支撑来自状态方程的冷分量和热分量。\n- 对于一种常用的混合状态方程，热压力贡献满足 $P_{\\mathrm{th}} = (\\Gamma_{\\mathrm{th}} - 1)\\,\\rho\\,\\epsilon_{\\mathrm{th}}$，其中 $\\Gamma_{\\mathrm{th}}$ 是热绝热指数，$\\rho$ 是质量密度，$\\epsilon_{\\mathrm{th}}$ 是比热能。对于固定的 $\\rho$ 和 $\\epsilon_{\\mathrm{th}}$，更大的 $\\Gamma_{\\mathrm{th}}$ 会产生更大的热压力，从而增加热支撑。\n- 在其他条件相同的情况下，更强的热支撑（更大的 $\\Gamma_{\\mathrm{th}}$）会降低中心密度的长期增长率，从而延长 HMNS 在坍缩前的寿命。\n\n您必须编写一个程序，对于每个测试用例，构建两个中心静止质量密度的合成时间序列，对应于仅在 $\\Gamma_{\\mathrm{th}}$ 上有所不同的两个模拟，然后：\n1) 使用一个数学上定义的准则，根据时间序列估计坍缩时间，以及\n2) 计算寿命变化 $\\Delta t$，并返回 $\\Delta t$ 的符号是否与基于 $\\Gamma_{\\mathrm{th}}$ 顺序的热支撑预期一致。\n\n合成中心密度模型：\n- 时间 $t$ 以毫秒为单位。\n- 中心密度被建模为一个围绕平衡值进行阻尼振荡并带有一个长期增长项的函数：\n$$\n\\rho_c(t;\\Gamma_{\\mathrm{th}}) = \\rho_{\\mathrm{eq}} + A\\,e^{-t/t_d}\\,\\sin\\!\\big(2\\pi f\\,t\\big) + s_1\\,t + s_2(\\Gamma_{\\mathrm{th}})\\,t^2,\n$$\n其中\n$$\ns_2(\\Gamma_{\\mathrm{th}}) = s_{2,\\mathrm{base}}\\times\\frac{\\Gamma_{\\mathrm{ref}}}{\\Gamma_{\\mathrm{th}}}.\n$$\n这里，$\\rho_{\\mathrm{eq}}$ 是并合后的平衡中心密度，$A$ 是初始振荡幅度，$t_d$ 是阻尼时间，$f$ 是以千赫兹（每毫秒周期数）为单位的振荡频率，$s_1$ 是线性长期增长系数，$s_{2,\\mathrm{base}}$ 是基础二次增长系数，$\\Gamma_{\\mathrm{ref}}$ 是用于归一化的固定参考热绝热指数。\n\n坍缩检测准则：\n- 设 $\\rho_{\\mathrm{thr}}$ 为坍缩阈值密度， $g_{\\mathrm{thr}}$ 为密度时间导数的坍缩阈值。\n- 在离散时间网格上定义有限差分导数 $\\dot{\\rho}_c(t_i) \\approx \\frac{\\rho_c(t_{i+1}) - \\rho_c(t_{i-1})}{t_{i+1}-t_{i-1}}$。\n- 坍缩时间 $t_{\\mathrm{col}}$ 是满足以下两个条件的最早时间：\n  a) $\\rho_c(t) \\ge \\rho_{\\mathrm{thr}}$，以及\n  b) $\\dot{\\rho}_c(t) \\ge g_{\\mathrm{thr}}$,\n这两个条件持续成立至少一个严格为正的持续时间 $\\tau_s$。如果在观测窗口 $[0, T_{\\mathrm{end}}]$ 内这个组合准则从未被满足，则设置 $t_{\\mathrm{col}} = T_{\\mathrm{end}}$ 并解释为“在窗口内未观测到坍缩”。\n- 所有时间以毫秒表示，四舍五入到三位小数。\n\n热支撑一致性检查：\n- 对于一对 $(\\Gamma_{\\mathrm{th}}^{(A)}, \\Gamma_{\\mathrm{th}}^{(B)})$，其寿命分别为 $t_{\\mathrm{col}}^{(A)}$ 和 $t_{\\mathrm{col}}^{(B)}$，定义 $\\Delta t = t_{\\mathrm{col}}^{(B)} - t_{\\mathrm{col}}^{(A)}$。\n- 预期：如果 $\\Gamma_{\\mathrm{th}}^{(B)} > \\Gamma_{\\mathrm{th}}^{(A)}$，那么增强的热支撑不应缩短寿命，因此 $\\Delta t \\ge 0$ 是一致的；如果 $\\Gamma_{\\mathrm{th}}^{(B)}  \\Gamma_{\\mathrm{th}}^{(A)}$，那么 $\\Delta t \\le 0$ 是一致的；如果 $\\Gamma_{\\mathrm{th}}^{(B)} = \\Gamma_{\\mathrm{th}}^{(A)}$，那么 $\\Delta t = 0$ 是一致的。\n\n算法规格：\n- 使用从 $t=0$ 到 $t=T_{\\mathrm{end}}$ 的均匀时间网格，步长为 $\\Delta t$。\n- 使用上述模型为每次模拟计算 $\\rho_c(t_i)$。\n- 对内部点使用中心差分、对边界点使用单侧差分计算 $\\dot{\\rho}_c(t_i)$。\n- 使用持续时间为 $\\tau_s$ 的持续阈值规则确定 $t_{\\mathrm{col}}$。\n- 为每个测试用例返回一个列表 $[t_{\\mathrm{col}}^{(A)}, t_{\\mathrm{col}}^{(B)}, \\Delta t, \\mathrm{consistent}]$，其中前三个条目是浮点数，单位为毫秒，四舍五入到三位小数，第四个条目是布尔值。\n\n单位和数值输出：\n- 时间输出必须以毫秒为单位，四舍五入到三位小数。\n- 模型内部密度单位是 $10^{15}\\,\\mathrm{g/cm^3}$；阈值 $\\rho_{\\mathrm{thr}}$ 以该单位指定。\n\n测试套件：\n用以下参数实现四个测试用例。在每个案例中，两个模拟共享 $\\rho_{\\mathrm{eq}}$, $A$, $t_d$, $f$, $s_1$, $s_{2,\\mathrm{base}}$, $\\Gamma_{\\mathrm{ref}}$, $T_{\\mathrm{end}}$, $\\Delta t$, $\\rho_{\\mathrm{thr}}$, $g_{\\mathrm{thr}}$, 和 $\\tau_s$，仅在 $\\Gamma_{\\mathrm{th}}$ 上有所不同。\n\n- 案例 1 (一般情况，更强的热支撑延迟坍缩):\n  - $(\\Gamma_{\\mathrm{th}}^{(A)}, \\Gamma_{\\mathrm{th}}^{(B)}) = (1.5, 1.9)$\n  - $\\rho_{\\mathrm{eq}} = 1.1$, $A = 0.08$, $t_d = 10$, $f = 2.0$, $s_1 = 0.01$, $s_{2,\\mathrm{base}} = 0.0002$, $\\Gamma_{\\mathrm{ref}} = 1.7$\n  - $T_{\\mathrm{end}} = 60$, $\\Delta t = 0.5$, $\\rho_{\\mathrm{thr}} = 1.8$, $g_{\\mathrm{thr}} = 0.02$, $\\tau_s = 4$\n\n- 案例 2 (边界情况，热绝热指数相同):\n  - $(\\Gamma_{\\mathrm{th}}^{(A)}, \\Gamma_{\\mathrm{th}}^{(B)}) = (1.7, 1.7)$\n  - $\\rho_{\\mathrm{eq}} = 1.1$, $A = 0.08$, $t_d = 10$, $f = 2.0$, $s_1 = 0.01$, $s_{2,\\mathrm{base}} = 0.0002$, $\\Gamma_{\\mathrm{ref}} = 1.7$\n  - $T_{\\mathrm{end}} = 60$, $\\Delta t = 0.5$, $\\rho_{\\mathrm{thr}} = 1.8$, $g_{\\mathrm{thr}} = 0.02$, $\\tau_s = 4$\n\n- 案例 3 (边缘情况，较高的 $\\Gamma_{\\mathrm{th}}$ 可能在窗口内不坍缩):\n  - $(\\Gamma_{\\mathrm{th}}^{(A)}, \\Gamma_{\\mathrm{th}}^{(B)}) = (2.0, 1.4)$\n  - $\\rho_{\\mathrm{eq}} = 1.1$, $A = 0.08$, $t_d = 10$, $f = 2.0$, $s_1 = 0.01$, $s_{2,\\mathrm{base}} = 0.00018$, $\\Gamma_{\\mathrm{ref}} = 1.7$\n  - $T_{\\mathrm{end}} = 60$, $\\Delta t = 0.5$, $\\rho_{\\mathrm{thr}} = 1.8$, $g_{\\mathrm{thr}} = 0.02$, $\\tau_s = 4$\n\n- 案例 4 (观测极限处的近阈值边界):\n  - $(\\Gamma_{\\mathrm{th}}^{(A)}, \\Gamma_{\\mathrm{th}}^{(B)}) = (1.8, 1.9)$\n  - $\\rho_{\\mathrm{eq}} = 1.1$, $A = 0.08$, $t_d = 10$, $f = 2.0$, $s_1 = 0.009$, $s_{2,\\mathrm{base}} = 0.00017$, $\\Gamma_{\\mathrm{ref}} = 1.7$\n  - $T_{\\mathrm{end}} = 60$, $\\Delta t = 0.5$, $\\rho_{\\mathrm{thr}} = 1.8$, $g_{\\mathrm{thr}} = 0.02$, $\\tau_s = 4$\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个元素对应一个测试用例，本身是一个形式为 $[t_{\\mathrm{col}}^{(A)}, t_{\\mathrm{col}}^{(B)}, \\Delta t, \\mathrm{consistent}]$ 的列表。\n- 例如，输出必须类似于：$[[t_{1A}, t_{1B}, \\Delta t_1, \\mathrm{True}], [t_{2A}, t_{2B}, \\Delta t_2, \\mathrm{True}], [t_{3A}, t_{3B}, \\Delta t_3, \\mathrm{False}], [t_{4A}, t_{4B}, \\Delta t_4, \\mathrm{True}]]$，其中时间以毫秒为单位，四舍五入到三位小数。", "solution": "该问题陈述已经过验证，被认为是科学上合理、适定且客观的。它基于一个关于超大质量中子星 (HMNS) 振荡和坍缩的唯象模型，提出了一个明确的计算任务，该主题属于数值相对论领域。模型、参数和准则都有明确定义，从而允许唯一且可验证的解。\n\n任务是计算两个合成的 HMNS 中心密度时间序列的坍缩时间，这两个序列仅在热绝热指数 $\\Gamma_{\\mathrm{th}}$ 上有所不同，并验证其寿命差异是否与“更大的热压力支撑会延迟坍缩”这一物理预期一致。该解是通过实现指定的算法来构建的。\n\n算法的核心对每个模拟对包括三个主要阶段：\n1.  生成两个合成的中心密度时间序列，$\\rho_c^{(A)}(t)$ 和 $\\rho_c^{(B)}(t)$。\n2.  基于持续阈值准则，为每个序列估计坍缩时间 $t_{\\mathrm{col}}^{(A)}$ 和 $t_{\\mathrm{col}}^{(B)}$。\n3.  计算寿命差异 $\\Delta t = t_{\\mathrm{col}}^{(B)} - t_{\\mathrm{col}}^{(A)}$，并与理论预期进行一致性检查。\n\n**1. 合成数据生成**\n对于每次模拟（$A$ 和 $B$），中心静止质量密度 $\\rho_c(t)$ 被建模为时间 $t$ 的函数。首先在区间 $[0, T_{\\mathrm{end}}]$ 上建立一个具有均匀步长 $\\Delta t$ 的离散时间网格。此网格中的点数为 $N = \\mathrm{int}(T_{\\mathrm{end}}/\\Delta t) + 1$，索引为 $i$ 的时间是 $t_i = i \\cdot \\Delta t$。\n\n每个时间点 $t_i$ 的密度使用提供的模型计算：\n$$\n\\rho_c(t; \\Gamma_{\\mathrm{th}}) = \\rho_{\\mathrm{eq}} + A\\,e^{-t/t_d}\\,\\sin(2\\pi f\\,t) + s_1\\,t + s_2(\\Gamma_{\\mathrm{th}})\\,t^2\n$$\n参数 $\\rho_{\\mathrm{eq}}$（平衡密度）、$A$（振荡幅度）、$t_d$（阻尼时间）、$f$（振荡频率）和 $s_1$（线性增长系数）在一对模拟中是共用的。二次增长系数 $s_2(\\Gamma_{\\mathrm{th}})$ 依赖于热绝热指数 $\\Gamma_{\\mathrm{th}}$：\n$$\ns_2(\\Gamma_{\\mathrm{th}}) = s_{2,\\mathrm{base}} \\times \\frac{\\Gamma_{\\mathrm{ref}}}{\\Gamma_{\\mathrm{th}}}\n$$\n其中 $s_{2,\\mathrm{base}}$ 是一个基础系数，$\\Gamma_{\\mathrm{ref}}$ 是一个参考值。这个公式正确地模拟了物理原理：更大的 $\\Gamma_{\\mathrm{th}}$ 提供更强的热支撑，从而降低中心密度的长期增长率（即更小的 $s_2(\\Gamma_{\\mathrm{th}})$）。\n\n**2. 坍缩时间估计**\n坍缩时间 $t_{\\mathrm{col}}$ 是通过应用一个涉及密度 $\\rho_c(t)$ 及其时间导数 $\\dot{\\rho}_c(t)$ 的精确准则来确定的。\n\n首先，时间导数 $\\dot{\\rho}_c(t_i)$ 从离散的 $\\rho_c(t_i)$ 序列中数值计算得出。按照规定，这是通过对内部点使用二阶中心差分，对边界点使用一阶单侧差分来完成的。`numpy.gradient(y, dx)` 函数非常适合此任务，其中 `y` 是 $\\rho_c$ 值的数组，`dx` 是时间步长 $\\Delta t$。\n\n接下来，评估坍缩准则。坍缩在最早的时间 $t_i$ 处启动，此时以下两个条件在至少 $\\tau_s$ 的时间间隔内持续成立：\na) 密度超过一个阈值：$\\rho_c(t) \\ge \\rho_{\\mathrm{thr}}$\nb) 密度增长率超过一个阈值：$\\dot{\\rho}_c(t) \\ge g_{\\mathrm{thr}}$\n\n为了实现这一点，首先构建一个布尔数组，标记每个满足条件 $(\\rho_c(t_i) \\ge \\rho_{\\mathrm{thr}})$ 和 $(\\dot{\\rho}_c(t_i) \\ge g_{\\mathrm{thr}})$ 的时间点 $t_i$。然后，算法搜索第一个索引 $i$，该索引启动一个持续时间至少为 $\\tau_s$ 的连续 `True` 值的序列。跨越此持续时间所需的连续时间点数为 $N_s = \\lfloor\\tau_s/\\Delta t\\rfloor + 1$。算法使用一个大小为 $N_s$ 的滑动窗口遍历时间序列。在一个窗口中所有点都满足条件的第一个起始时间 $t_i$ 被声明为坍缩时间 $t_{\\mathrm{col}} = t_i$。如果在观测时间 $T_{\\mathrm{end}}$ 内没有找到这样的窗口，则坍缩时间设置为 $t_{\\mathrm{col}} = T_{\\mathrm{end}}$。\n\n**3. 寿命差异与一致性检查**\n一旦找到了具有热指数 $\\Gamma_{\\mathrm{th}}^{(A)}$ 和 $\\Gamma_{\\mathrm{th}}^{(B)}$ 的两次模拟的坍缩时间 $t_{\\mathrm{col}}^{(A)}$ 和 $t_{\\mathrm{col}}^{(B)}$，就计算寿命差异：\n$$\n\\Delta t = t_{\\mathrm{col}}^{(B)} - t_{\\mathrm{col}}^{(A)}\n$$\n物理预期是，更大的 $\\Gamma_{\\mathrm{th}}$ 不应减少 HMNS 的寿命。这意味着如果 $\\Gamma_{\\mathrm{th}}^{(B)} > \\Gamma_{\\mathrm{th}}^{(A)}$，我们必须有 $t_{\\mathrm{col}}^{(B)} \\ge t_{\\mathrm{col}}^{(A)}$，或 $\\Delta t \\ge 0$。相反，如果 $\\Gamma_{\\mathrm{th}}^{(B)}  \\Gamma_{\\mathrm{th}}^{(A)}$，我们预期 $\\Delta t \\le 0$。如果 $\\Gamma_{\\mathrm{th}}^{(B)} = \\Gamma_{\\mathrm{th}}^{(A)}$，寿命必须相同，所以 $\\Delta t = 0$。所有这些条件都可以通过一个不等式简洁地表达：\n$$\n(\\Gamma_{\\mathrm{th}}^{(B)} - \\Gamma_{\\mathrm{th}}^{(A)}) \\cdot \\Delta t \\ge 0\n$$\n如果此不等式成立，则布尔值 `consistent` 为 `True`，否则为 `False`。\n\n最后，为每个测试用例收集计算出的值 $[t_{\\mathrm{col}}^{(A)}, t_{\\mathrm{col}}^{(B)}, \\Delta t, \\mathrm{consistent}]$，时间值按要求四舍五入到三位小数。程序随后将这些结果格式化为单个列表以供输出。", "answer": "```python\nimport numpy as np\nfrom scipy import constants\n\ndef solve():\n    \"\"\"\n    Solves the problem of calculating HMNS lifetimes and checking for consistency\n    based on the provided synthetic model and test cases.\n    \"\"\"\n\n    test_cases = [\n        # Case 1\n        {\n            \"Gamma_th_A\": 1.5, \"Gamma_th_B\": 1.9,\n            \"rho_eq\": 1.1, \"A\": 0.08, \"t_d\": 10.0, \"f\": 2.0, \"s1\": 0.01,\n            \"s2_base\": 0.0002, \"Gamma_ref\": 1.7,\n            \"T_end\": 60.0, \"dt\": 0.5, \"rho_thr\": 1.8, \"g_thr\": 0.02, \"tau_s\": 4.0\n        },\n        # Case 2\n        {\n            \"Gamma_th_A\": 1.7, \"Gamma_th_B\": 1.7,\n            \"rho_eq\": 1.1, \"A\": 0.08, \"t_d\": 10.0, \"f\": 2.0, \"s1\": 0.01,\n            \"s2_base\": 0.0002, \"Gamma_ref\": 1.7,\n            \"T_end\": 60.0, \"dt\": 0.5, \"rho_thr\": 1.8, \"g_thr\": 0.02, \"tau_s\": 4.0\n        },\n        # Case 3\n        {\n            \"Gamma_th_A\": 2.0, \"Gamma_th_B\": 1.4,\n            \"rho_eq\": 1.1, \"A\": 0.08, \"t_d\": 10.0, \"f\": 2.0, \"s1\": 0.01,\n            \"s2_base\": 0.00018, \"Gamma_ref\": 1.7,\n            \"T_end\": 60.0, \"dt\": 0.5, \"rho_thr\": 1.8, \"g_thr\": 0.02, \"tau_s\": 4.0\n        },\n        # Case 4\n        {\n            \"Gamma_th_A\": 1.8, \"Gamma_th_B\": 1.9,\n            \"rho_eq\": 1.1, \"A\": 0.08, \"t_d\": 10.0, \"f\": 2.0, \"s1\": 0.009,\n            \"s2_base\": 0.00017, \"Gamma_ref\": 1.7,\n            \"T_end\": 60.0, \"dt\": 0.5, \"rho_thr\": 1.8, \"g_thr\": 0.02, \"tau_s\": 4.0\n        }\n    ]\n\n    def find_collapse_time(params, Gamma_th):\n        \"\"\"\n        Calculates the collapse time for a single simulation.\n        \"\"\"\n        T_end = params[\"T_end\"]\n        dt = params[\"dt\"]\n        \n        # 1. Generate time grid\n        # Use np.linspace for precision\n        num_points = int(round(T_end / dt)) + 1\n        times = np.linspace(0, T_end, num_points)\n\n        # 2. Calculate density time series\n        s2 = params[\"s2_base\"] * (params[\"Gamma_ref\"] / Gamma_th)\n        \n        rho_c = (params[\"rho_eq\"] +\n                 params[\"A\"] * np.exp(-times / params[\"t_d\"]) * np.sin(2 * np.pi * params[\"f\"] * times) +\n                 params[\"s1\"] * times +\n                 s2 * times**2)\n\n        # 3. Calculate time derivative\n        rho_dot_c = np.gradient(rho_c, dt)\n        \n        # 4. Apply collapse criterion\n        is_critical = (rho_c >= params[\"rho_thr\"])  (rho_dot_c >= params[\"g_thr\"])\n        \n        # 5. Check for sustained condition\n        tau_s = params[\"tau_s\"]\n        \n        # Number of consecutive points needed to cover a duration of tau_s\n        # (N-1)*dt >= tau_s => N >= tau_s/dt + 1\n        sustain_window_size = int(tau_s / dt) + 1 if dt > 0 else 1\n        \n        t_col = T_end\n        \n        # Iterate with a sliding window\n        if sustain_window_size > 1:\n            for i in range(len(times) - sustain_window_size + 1):\n                window = is_critical[i : i + sustain_window_size]\n                if np.all(window):\n                    t_col = times[i]\n                    break\n        elif sustain_window_size == 1: # Handle edge case tau_s=0\n            for i in range(len(times)):\n                if is_critical[i]:\n                    t_col = times[i]\n                    break\n                \n        return t_col\n\n    results = []\n    for case_params in test_cases:\n        Gamma_th_A = case_params[\"Gamma_th_A\"]\n        Gamma_th_B = case_params[\"Gamma_th_B\"]\n\n        # Calculate collapse times for simulations A and B\n        t_col_A = find_collapse_time(case_params, Gamma_th_A)\n        t_col_B = find_collapse_time(case_params, Gamma_th_B)\n\n        # Calculate lifetime difference\n        delta_t = t_col_B - t_col_A\n\n        # Check for consistency\n        # Expectation: (Gamma_B - Gamma_A) * (t_col_B - t_col_A) >= 0\n        is_consistent = (Gamma_th_B - Gamma_th_A) * delta_t >= 0.0\n\n        # Small correction for floating point issues when expecting exactly 0\n        if np.isclose(Gamma_th_B, Gamma_th_A):\n            is_consistent = np.isclose(delta_t, 0.0)\n\n        results.append([\n            round(t_col_A, 3),\n            round(t_col_B, 3),\n            round(delta_t, 3),\n            is_consistent\n        ])\n    \n    # Format and print the final result string\n    result_str = \",\".join(map(str, results))\n    print(f\"[{result_str}]\")\n\nsolve()\n```", "id": "3483434"}]}