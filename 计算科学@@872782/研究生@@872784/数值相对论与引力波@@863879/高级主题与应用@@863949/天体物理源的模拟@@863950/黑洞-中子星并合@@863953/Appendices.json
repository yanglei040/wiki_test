{"hands_on_practices": [{"introduction": "黑洞-中子星并合的结果——中子星是被直接吞入还是被潮汐瓦解形成吸积盘——是研究这类事件的第一个关键问题。本练习将引导你建立一个简单而强大的半解析模型，通过比较潮汐瓦解半径与黑洞的最内层稳定圆轨道（ISCO）半径来预测并合结果 [@problem_id:3466282]。通过编程实现该模型并与数值相对论的模拟结果进行比较，你将亲身体验并掌握主导这些灾变性事件的关键物理参数。", "problem": "考虑一个用于黑洞-中子星并合的半解析瓦解判据，其中当且仅当潮汐瓦解半径超过黑洞（BH）的最内稳定圆轨道（ISCO）半径时，中子星（NS）发生潮汐瓦解并留下一个残余吸积盘。设潮汐瓦解半径由领头阶牛顿标度关系 $R_{\\rm tid} \\sim \\kappa_{\\rm tide}\\, R_{\\rm NS}\\left(M_{\\rm BH}/M_{\\rm NS}\\right)^{1/3}$ 建模，其中 $R_{\\rm NS}$ 是中子星的周长半径，$M_{\\rm BH}$ 是黑洞质量，$M_{\\rm NS}$ 是中子星质量，而 $\\kappa_{\\rm tide}$ 是一个量级为1的系数，我们将其设为 $\\kappa_{\\rm tide}=1$ 来定义一个具体的半解析模型。设ISCO半径由克尔时空中对应无量纲自旋参数 $a_\\ast$ 的解得到，并使用 $G$ 和 $c$ 转换为物理长度。判定规则定义如下：当且仅当 $R_{\\rm tid}>R_{\\rm ISCO}(a_\\ast)$ 时，形成残余盘；否则，结果为迅速坠入，形成的盘可忽略不计。\n\n从基本原理出发，使用以下基础进行推导，不要将任何目标公式导入到问题陈述中：\n- 将穿过中子星的牛顿潮汐加速度与中子星表面自引力相等，以获得 $R_{\\rm tid}$ 的领头阶标度关系。\n- 使用克尔度规中赤道圆测地线的临界稳定条件，以获得以 $M$ 为单位的 $r_{\\rm ISCO}(a_\\ast)$，其中 $M$ 是几何单位下的黑洞质量。\n- 通过 $R_{\\rm ISCO}=r_{\\rm ISCO}\\, G M_{\\rm BH}/c^2$ 将 $r_{\\rm ISCO}$ 转换为物理长度。\n\n所有半径必须以公里为单位计算。质量输入以太阳质量为单位提供，必须通过先转换为千克，再通过因子 $G M_{\\odot}/c^2$ 转换为公里的方式进行一致转换。无量纲自旋参数 $a_\\ast$ 可以是正值（顺行）或负值（逆行）。\n\n实现一个程序，该程序：\n- 为每个测试用例计算 $R_{\\rm tid}$ 和 $R_{\\rm ISCO}$，\n- 根据 $R_{\\rm tid}>R_{\\rm ISCO}$ 是否成立，以布尔值的形式预测半解析结果，\n- 将该预测与提供的数值相对论（NR）结果标签进行比较（其中 NR 代表数值相对论），\n- 为每个测试用例返回一个布尔值，指示半解析预测是否与 NR 标签匹配。\n\n使用以下参数元组的测试套件 $(M_{\\rm BH}, a_\\ast, M_{\\rm NS}, R_{\\rm NS}, \\text{NR\\_disk})$，其中 $M_{\\rm BH}$ 和 $M_{\\rm NS}$ 以太阳质量为单位，$R_{\\rm NS}$ 以公里为单位，而 $\\text{NR\\_disk}$ 是预期的NR标签（形成盘为 true 或 false）：\n- 用例 A（理想情况，迅速坠入）：(7.0, 0.0, 1.4, 12.0, false)。\n- 用例 B（高自旋和较大中子星，瓦解）：(7.0, 0.95, 1.4, 14.0, true)。\n- 用例 C（低黑洞质量和高自旋，瓦解）：(3.0, 0.9, 1.4, 12.0, true)。\n- 用例 D（高黑洞质量、近阈值高自旋，瓦解）：(10.0, 0.99, 1.4, 12.0, true)。\n- 用例 E（致密中子星和中等自旋，迅速坠入）：(5.0, 0.5, 1.4, 11.0, false)。\n- 用例 F（逆行自旋，迅速坠入）：(5.0, -0.5, 1.4, 12.0, false)。\n\n您的程序必须根据克尔度规中的临界稳定条件，为任意 $a_\\ast \\in [-1,1]$ 精确实现克尔ISCO，并实现指定的牛顿领头阶潮汐判据。使用标准常数 $G$ 和 $c$ 以及太阳质量 $M_{\\odot}$，其在国际单位制（SI）中的值如下：$G=6.67430\\times 10^{-11} \\text{ m}^3\\text{ kg}^{-1}\\text{ s}^{-2}$，$c=2.99792458\\times 10^{8} \\text{ m s}^{-1}$，以及 $M_{\\odot}=1.98847\\times 10^{30} \\text{ kg}$。所有中间物理计算必须一致执行，并且所有半径必须以公里表示。\n\n不使用角度单位。不使用百分比。\n\n最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，格式为 $\\texttt{[b\\_A,b\\_B,b\\_C,b\\_D,b\\_E,b\\_F]}$，其中每个条目是一个布尔值，当且仅当该用例的半解析预测与 NR 标签匹配时为 true，否则为 false。例如，一个有效的输出行可能看起来像 $\\texttt{[True,False,True,True,True,False]}$（这只是一个示例，不是要求的答案）。", "solution": "该问题是有效的，因为它在科学上植根于天体物理学和广义相对论，问题良定，具有明确的目标和充足的数据，并且其表述是客观的。任务是实现一个半解析模型来预测黑洞-中子星（BH-NS）并合的结果，并将此预测与提供的数值相对论（NR）结果进行比较。该模型假定，当且仅当潮汐瓦解半径 $R_{\\rm tid}$ 大于黑洞的最内稳定圆轨道（ISCO）半径 $R_{\\rm ISCO}$ 时，才会形成残余吸积盘。\n\n解决方案要求根据问题陈述中的规定，从基本原理推导和实现这两个半径的公式。所有计算都必须使用一致的物理单位进行，最终半径以公里表示。\n\n首先，我们推导潮汐瓦解半径 $R_{\\rm tid}$ 的表达式。在牛顿近似下，当来自质量为 $M_{\\rm BH}$ 的黑洞（BH）施加于质量为 $M_{\\rm NS}$、半径为 $R_{\\rm NS}$ 的中子星（NS）上的引力差超过中子星自身的自引力时，中子星就会被潮汐瓦解。在距离 $R$ 处，黑洞对中子星（特征尺寸为 $R_{\\rm NS}$）施加的潮汐加速度 $a_{\\rm tide}$ 的标度关系为 $a_{\\rm tide} \\approx G M_{\\rm BH} R_{\\rm NS} / R^3$。将中子星维系在一起的表面自引力加速度为 $a_{\\rm self} = G M_{\\rm NS} / R_{\\rm NS}^2$。令这两个加速度相等，即可定义潮汐瓦解半径 $R_{\\rm tid}$：\n$$\n\\frac{G M_{\\rm BH} R_{\\rm NS}}{R_{\\rm tid}^3} \\sim \\frac{G M_{\\rm NS}}{R_{\\rm NS}^2}\n$$\n求解 $R_{\\rm tid}$ 得到标度关系：\n$$\nR_{\\rm tid} \\sim R_{\\rm NS} \\left(\\frac{M_{\\rm BH}}{M_{\\rm NS}}\\right)^{1/3}\n$$\n问题指定使用此领头阶标度关系，并将量级为1的系数 $\\kappa_{\\rm tide}$ 设为1。因此，要实现的公式恰好是 $R_{\\rm tid} = R_{\\rm NS} \\left(M_{\\rm BH}/M_{\\rm NS}}\\right)^{1/3}$。由于 $M_{\\rm BH}$ 和 $M_{\\rm NS}$ 以相同的单位（太阳质量）提供，它们的比值是无量纲的。当 $R_{\\rm NS}$ 以公里为单位给出时，得到的 $R_{\\rm tid}$ 也以公里为单位。\n\n接下来，我们确定克尔黑洞的ISCO半径 $R_{\\rm ISCO}$。ISCO是有质量粒子能够在黑洞赤道平面上维持稳定圆轨道的最小半径。其半径是通过求解克尔度规中赤道圆测地线的临界稳定条件找到的，即 $\\frac{d V_{\\rm eff}}{dr} = 0$ 和 $\\frac{d^2 V_{\\rm eff}}{dr^2} = 0$，其中 $V_{\\rm eff}$ 是有效势。这些方程的解给出了以黑洞质量 $M = G M_{\\rm BH}/c^2$ 的几何单位表示的ISCO半径 $r_{\\rm ISCO}$。结果取决于黑洞的无量纲自旋参数 $a_\\ast = a/M$，其中 $a$ 是自旋参数。无量纲ISCO半径 $r'_{\\rm ISCO} = r_{\\rm ISCO}/M$ 的精确公式为：\n$$\nr'_{\\rm ISCO}(a_\\ast) = 3 + Z_2 \\mp \\sqrt{(3-Z_1)(3+Z_1+2Z_2)}\n$$\n其中\n$$\nZ_1 = 1 + (1-|a_\\ast|^2)^{1/3} \\left( (1+|a_\\ast|)^{1/3} + (1-|a_\\ast|)^{1/3} \\right)\n$$\n$$\nZ_2 = \\sqrt{3|a_\\ast|^2 + Z_1^2}\n$$\n符号 $\\mp$ 的选择取决于轨道相对于黑洞自旋的方向：负号（$-$）用于顺行轨道（同向旋转，$a_\\ast \\ge 0$），产生较小的ISCO；正号（$+$）用于逆行轨道（反向旋转，$a_\\ast  0$），产生较大的ISCO。\n\n为了以公里为单位获得物理半径 $R_{\\rm ISCO}$，我们必须首先将黑洞质量 $M_{\\rm BH}$ 从太阳质量（$M_\\odot$）转换为公里。转换因子是一个太阳质量的引力半径：\n$$\nM_{\\odot, \\text{km}} = \\frac{G M_\\odot}{c^2}\n$$\n使用所提供的常数，$G = 6.67430 \\times 10^{-11} \\text{ m}^3 \\text{ kg}^{-1} \\text{ s}^{-2}$，$c = 2.99792458 \\times 10^8 \\text{ m s}^{-1}$，以及 $M_\\odot = 1.98847 \\times 10^{30} \\text{ kg}$，这个因子大约是 $1.4766$ km。那么物理ISCO半径为：\n$$\nR_{\\rm ISCO} = r'_{\\rm ISCO}(a_\\ast) \\times (M_{\\rm BH} \\text{ in } M_\\odot) \\times M_{\\odot, \\text{km}}\n$$\n\n计算流程如下：\n1. 定义物理常数 $G$、$c$ 和 $M_\\odot$，并计算从太阳质量到公里的转换因子。\n2. 对于每个测试用例 $(M_{\\rm BH}, a_\\ast, M_{\\rm NS}, R_{\\rm NS}, \\text{NR\\_disk})$：\n    a. 使用潮汐半径公式计算 $R_{\\rm tid}$。\n    b. 通过首先计算给定自旋 $a_\\ast$ 的无量纲半径 $r'_{\\rm ISCO}(a_\\ast)$，然后按以公里为单位的黑洞质量进行缩放，来计算 $R_{\\rm ISCO}$。\n    c. 应用判定规则：如果 $R_{\\rm tid}  R_{\\rm ISCO}$，则预测有残余盘（`true`），否则预测迅速坠入（`false`）。\n    d. 将此布尔预测与提供的NR结果标签 $\\text{NR\\_disk}$进行比较。\n    e. 如果预测与标签匹配，则该用例的结果为 `true`，否则为 `false`。\n3. 收集所有测试用例的布尔结果，并将其格式化为指定的输出字符串。这个系统化的过程通过一组基准模拟来验证半解析模型。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and validates a semi-analytic model for black hole-neutron star\n    merger outcomes against numerical relativity results.\n    \"\"\"\n\n    # Physical constants in SI units\n    G = 6.67430e-11  # Gravitational constant (m^3 kg^-1 s^-2)\n    C = 2.99792458e8   # Speed of light (m s^-1)\n    M_SOLAR_KG = 1.98847e30  # Solar mass (kg)\n\n    # Conversion factor for mass from solar masses to kilometers\n    SOLAR_MASS_IN_KM = (G * M_SOLAR_KG) / (C**2 * 1000)\n\n    # Test cases from the problem statement\n    # Tuple format: (M_BH (M_solar), a_star, M_NS (M_solar), R_NS (km), NR_disk_label (bool))\n    test_cases = [\n        (7.0, 0.0, 1.4, 12.0, False),    # Case A\n        (7.0, 0.95, 1.4, 14.0, True),    # Case B\n        (3.0, 0.9, 1.4, 12.0, True),     # Case C\n        (10.0, 0.99, 1.4, 12.0, True),   # Case D\n        (5.0, 0.5, 1.4, 11.0, False),    # Case E\n        (5.0, -0.5, 1.4, 12.0, False),   # Case F\n    ]\n\n    def calculate_isco_radius_km(m_bh_solar, a_star):\n        \"\"\"\n        Calculates the physical ISCO radius in km for a Kerr black hole.\n        - m_bh_solar: Black hole mass in solar masses.\n        - a_star: Dimensionless black hole spin parameter [-1, 1].\n        \"\"\"\n        a = abs(a_star)\n        \n        # Handle the edge case a=1 to avoid potential numerical issues with (1-a**2)\n        if a > 1.0:\n            raise ValueError(\"Spin parameter |a*| cannot exceed 1.\")\n            \n        z1 = 1 + np.cbrt(1 - a**2) * (np.cbrt(1 + a) + np.cbrt(1 - a))\n        z2 = np.sqrt(3 * a**2 + z1**2)\n        \n        # Prograde (a_star >= 0) and retrograde (a_star  0) orbits\n        sqrt_term = np.sqrt((3 - z1) * (3 + z1 + 2 * z2))\n        \n        if a_star >= 0:\n            # Prograde orbit formula\n            r_isco_dimless = 3 + z2 - sqrt_term\n        else:\n            # Retrograde orbit formula\n            r_isco_dimless = 3 + z2 + sqrt_term\n            \n        r_isco_km = r_isco_dimless * m_bh_solar * SOLAR_MASS_IN_KM\n        return r_isco_km\n\n    def calculate_tidal_radius_km(m_bh_solar, m_ns_solar, r_ns_km):\n        \"\"\"\n        Calculates the tidal disruption radius in km.\n        - m_bh_solar: Black hole mass in solar masses.\n        - m_ns_solar: Neutron star mass in solar masses.\n        - r_ns_km: Neutron star radius in kilometers.\n        \"\"\"\n        mass_ratio = m_bh_solar / m_ns_solar\n        r_tid_km = r_ns_km * np.cbrt(mass_ratio)\n        return r_tid_km\n\n    results = []\n    for case in test_cases:\n        m_bh, a_star, m_ns, r_ns, nr_disk_label = case\n        \n        # Compute the two critical radii\n        r_isco = calculate_isco_radius_km(m_bh, a_star)\n        r_tid = calculate_tidal_radius_km(m_bh, m_ns, r_ns)\n        \n        # Apply the semi-analytic decision rule\n        # A disk forms if the tidal radius is greater than the ISCO radius\n        analytic_prediction = r_tid > r_isco\n        \n        # Compare the prediction with the numerical relativity label\n        match = (analytic_prediction == nr_disk_label)\n        results.append(match)\n\n    # Format and print the final output as a single line\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3466282"}, {"introduction": "当中子星被瓦解后，形成的吸积盘并非平静的结构；它是一个湍流环境，其中磁场驱动着其演化。本练习将深入探讨磁转动不稳定性（MRI），这是吸积盘中湍流和角动量输运的主要驱动机制 [@problem_id:3466335]。你将学习如何量化捕捉这种不稳定性所需的数值分辨率，并研究未能达到该分辨率会如何系统性地影响对重要物理结果（例如非束缚物质抛射的总质量）的预测。", "problem": "您的任务是为广义相对论磁流体动力学 (GRMHD) 模拟中黑洞-中子星并合后形成的并合后吸积盘设计并实施一项收敛性研究，重点是解析增长最快的磁转动不稳定性 (MRI) 模，并量化其对估算的非束缚质量产生的影响。该研究必须在几何化单位制（$G=c=1$）中表达和计算，这意味着质量、长度和时间共享相同的单位，所有特征速度都是无量纲的。目标是为每个测试配置计算 MRI 增长最快的尺度是否被至少 $N$ 个网格单元解析，并根据一个与形式阶为 $p$ 的方法一致的收敛模型来估算非束缚质量。\n\n推导的基本出发点必须是以下经过充分检验的关系和定义：\n- 对于绝热指数为 $\\Gamma$ 的理想流体，其比焓为 $h = 1 + \\epsilon + p/\\rho$，其中理想气体的比内能为 $\\epsilon = p / \\left((\\Gamma - 1)\\rho\\right)$，这意味着 $h = 1 + \\dfrac{\\Gamma}{\\Gamma-1} \\dfrac{p}{\\rho}$。\n- 在高斯单位制中，狭义相对论磁流体动力学 (SRMHD) 广泛使用的相对论性阿尔芬速度为 $v_{A} = \\sqrt{ \\dfrac{B^{2}}{4\\pi \\rho h + B^{2}} }$，其中 $B$ 是磁场强度，$\\rho$ 是静止质量密度，$h$ 是比焓。\n- 对于围绕一个中心质量为 $M$ 的致密天体、在弱场极限下半径为 $r$ 处的准开普勒盘，其角频率为 $\\Omega = \\sqrt{\\dfrac{M}{r^{3}}}$。这是在几何化单位制中与薄盘轨道运动一致的领头阶基线。\n\n根据磁转动不稳定性 (MRI) 的线性分析，增长最快的通道模的特征波长与阿尔芬速度和轨道频率之比成比例。请采用社群标准定义，将特征最快增长 MRI 波长定义为阿尔芬速度与轨道频率之比的倍数，并从上述基础推导出一个显式公式。然后，给定网格间距 $\\Delta x$，定义局部 MRI 品质因子 $Q = \\dfrac{\\lambda_{\\mathrm{MRI}}}{\\Delta x}$，并确定 MRI 是否被至少 $N$ 个单元解析，即 $Q \\ge N$ 是否成立。\n\n为量化对非束缚质量 $M_{\\mathrm{ej}}$ 的影响，假设一个与形式阶为 $p$ 的数值方法一致的有原则的收敛模型：$M_{\\mathrm{ej}}$ 中的相对偏差与品质因子的倒数的幂成比例。校准偏差的振幅，使得在阈值 $Q=N$ 处，相对低估量是渐近收敛值 $M_{\\mathrm{ej},\\infty}$ 的一个指定分数 $\\delta$。一个一致的模型是：\n$$\nM_{\\mathrm{ej}}(Q) \\;=\\; M_{\\mathrm{ej},\\infty} \\,\\max\\!\\left(0,\\; 1 - \\delta \\left(\\frac{N}{Q}\\right)^{p} \\right),\n$$\n该模型反映了误差随分辨率的渐近衰减，并为极度欠解析情况设置了零质量下限。\n\n您的程序必须为每个测试用例计算以下输出：\n- 一个布尔值，指示 MRI 是否在目标水平上被解析，即 $Q \\ge N$ 是否成立。\n- 满足目标所需的单元尺寸 $\\Delta x_{\\mathrm{req}} = \\dfrac{\\lambda_{\\mathrm{MRI}}}{N}$，与 $r$ 使用相同的长度单位。\n- 实际的 MRI 品质因子 $Q$。\n- 以太阳质量 $M_{\\odot}$ 为单位的估算非束缚质量 $M_{\\mathrm{ej}}$。\n\n所有计算都必须在 $G=c=1$ 的几何化单位制中一致地进行。$\\Delta x_{\\mathrm{req}}$ 以与输入半径 $r$ 相同的长度单位表示，而 $M_{\\mathrm{ej}}$ 以 $M_{\\odot}$ 表示。将所有浮点输出四舍五入到六位小数。本问题不使用角度。最终输出必须是单行，包含每个测试用例的结果列表，其中每个结果是列表 $[\\text{resolved}, \\Delta x_{\\mathrm{req}}, Q, M_{\\mathrm{ej}}]$。\n\n测试套件。使用以下参数集，每个参数集以元组形式提供\n$(M, r, \\rho, p, \\Gamma, B, \\Delta x, N, M_{\\mathrm{ej},\\infty}, \\delta, p)$，其中：\n- $M$ 是中心质量，\n- $r$ 是盘中进行诊断评估的半径，\n- $\\rho$ 是局部静止质量密度，\n- $p$ 是局部气体压力，\n- $\\Gamma$ 是绝热指数，\n- $B$ 是磁场强度（与 $4\\pi$ 一致的高斯单位制），\n- $\\Delta x$ 是网格间距，\n- $N$ 是每个 MRI 最快增长波长上的目标单元数，\n- $M_{\\mathrm{ej},\\infty}$ 是以 $M_{\\odot}$ 为单位的渐近收敛非束缚质量，\n- $\\delta$ 是在 $Q=N$ 时的分数低估量，\n- $p$（在此元组位置重用）是形式收敛阶指数。\n\n使用这四个科学上合理的测试用例：\n- 用例 1：$(M, r, \\rho, p, \\Gamma, B, \\Delta x, N, M_{\\mathrm{ej},\\infty}, \\delta, p) = (\\,5,\\; 50,\\; 10^{-4},\\; 10^{-6},\\; 4/3,\\; 10^{-3},\\; 2.0,\\; 10,\\; 0.05,\\; 0.2,\\; 2\\,)$。\n- 用例 2：$(\\,5,\\; 50,\\; 10^{-4},\\; 10^{-6},\\; 4/3,\\; 10^{-3},\\; 2.7471,\\; 10,\\; 0.05,\\; 0.2,\\; 2\\,)$。\n- 用例 3：$(\\,5,\\; 50,\\; 10^{-4},\\; 10^{-6},\\; 4/3,\\; 10^{-3},\\; 5.6,\\; 10,\\; 0.05,\\; 0.2,\\; 2\\,)$。\n- 用例 4：$(\\,7,\\; 20,\\; 10^{-6},\\; 10^{-8},\\; 4/3,\\; 10^{-1},\\; 1.0,\\; 20,\\; 0.1,\\; 0.1,\\; 1.5\\,)$。\n\n你的程序应该生成单行输出，其中包含一个由方括号括起来的、逗号分隔的列表的列表，例如 $[[\\cdots],[\\cdots],\\ldots]$，其中每个内部列表为 $[\\text{resolved}, \\Delta x_{\\mathrm{req}}, Q, M_{\\mathrm{ej}}]$，浮点数条目四舍五入至六位小数，布尔值作为字面量。不应打印任何其他文本。", "solution": "该问题是有效的。它在相对论天体物理和数值模拟领域提出了一个适定的、有科学依据的计算任务。所有必要的数据和物理关系都已提供，且测试用例的参数在物理上是合理的。目标明确，所需的输出也已精确定义。\n\n解决方案遵循所描述的物理和数学模型，对每个测试用例实施分步计算。测试用例参数以元组形式提供：$(M, r, \\rho, p_{\\text{gas}}, \\Gamma, B, \\Delta x, N, M_{\\mathrm{ej},\\infty}, \\delta, p_{\\text{conv}})$。所有计算都在 $G=c=1$ 的几何化单位中执行。\n\n单个测试用例的计算步骤如下：\n\n1.  **计算比焓 $h$**：相对论性理想流体的比焓已给出。比内能 $\\epsilon$ 为 $\\epsilon = p_{\\text{gas}} / ((\\Gamma - 1)\\rho)$。将其代入定义式 $h = 1 + \\epsilon + p_{\\text{gas}}/\\rho$ 得：\n    $$h = 1 + \\frac{p_{\\text{gas}}}{(\\Gamma - 1)\\rho} + \\frac{p_{\\text{gas}}}{\\rho} = 1 + \\left( \\frac{1}{\\Gamma-1} + 1 \\right) \\frac{p_{\\text{gas}}}{\\rho} = 1 + \\frac{\\Gamma}{\\Gamma-1} \\frac{p_{\\text{gas}}}{\\rho}$$\n    该公式使用所提供的局部静止质量密度 $\\rho$、气体压力 $p_{\\text{gas}}$ 和绝热指数 $\\Gamma$ 进行计算。\n\n2.  **计算相对论性阿尔芬速度 $v_A$**：问题提供了相对论性阿尔芬速度的公式，该公式在特定磁场约定下的狭义相对论磁流体动力学 (SRMHD) 文献中是标准的：\n    $$v_{A} = \\sqrt{ \\frac{B^{2}}{4\\pi \\rho h + B^{2}} }$$\n    这里，$B$ 是磁场强度。该速度是一个无量纲量，与使用 $c=1$ 的几何化单位相一致。\n\n3.  **计算轨道角频率 $\\Omega$**：对于准开普勒盘，围绕中心质量 $M$、半径为 $r$ 处的角频率由开普勒公式近似：\n    $$\\Omega = \\sqrt{\\frac{M}{r^{3}}}$$\n    这是在弱场极限下的一个有效近似，适用于吸积盘的外部区域。\n\n4.  **计算特征 MRI 波长 $\\lambda_{\\mathrm{MRI}}$**：磁转动不稳定性 (MRI) 的最快增长模具有一个特征波长 $\\lambda_{\\mathrm{MRI}}$。问题要求采用社群标准定义，对于由垂直磁场驱动的通道模，该定义为：\n    $$\\lambda_{\\mathrm{MRI}} = \\frac{2\\pi v_A}{\\Omega}$$\n    该波长是一个关键尺度，在数值模拟中必须被解析，以准确捕捉 MRI 的效应。\n\n5.  **计算 MRI 品质因子 $Q$**：品质因子 $Q$ 量化了特征 MRI 波长被数值网格解析的程度。它定义为 MRI 波长与网格单元尺寸 $\\Delta x$ 之比：\n    $$Q = \\frac{\\lambda_{\\mathrm{MRI}}}{\\Delta x}$$\n\n6.  **确定 MRI 解析状态**：如果品质因子 $Q$ 大于或等于目标单元数 $N$，则认为 MRI 已被充分解析。输出是一个表示该条件的布尔值：\n    $$\\text{resolved} = (Q \\ge N)$$\n\n7.  **计算所需的单元尺寸 $\\Delta x_{\\mathrm{req}}$**：为满足每个 MRI 波长 $N$ 个单元的目标分辨率，所需的网格间距为：\n    $$\\Delta x_{\\mathrm{req}} = \\frac{\\lambda_{\\mathrm{MRI}}}{N}$$\n\n8.  **估算非束缚质量 $M_{\\mathrm{ej}}$**：所提供的收敛模型描述了数值估算的非束缚质量 $M_{\\mathrm{ej}}$ 如何随分辨率 $Q$ 的变化而逼近渐近收敛值 $M_{\\mathrm{ej},\\infty}$。该模型为：\n    $$M_{\\mathrm{ej}}(Q) = M_{\\mathrm{ej},\\infty} \\max\\left(0, 1 - \\delta \\left(\\frac{N}{Q}\\right)^{p_{\\text{conv}}} \\right)$$\n    其中 $\\delta$ 是在分辨率阈值 $Q=N$ 处的分数误差，而 $p_{\\text{conv}}$ 是数值方法的形式收敛阶。$\\max(0, \\ldots)$ 函数确保估算质量为非负值，这在物理上是必需的，尤其是在分辨率极差的情况下，模型可能会预测出负值。\n\n将这些步骤应用于所提供的四个测试用例中的每一个。最终的浮点结果（$\\Delta x_{\\mathrm{req}}$、$Q$ 和 $M_{\\mathrm{ej}}$）在最终输出时四舍五入到六位小数。然后将所有测试用例的结果收集到一个列表的列表中。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes MRI resolution metrics and estimated unbound mass for a set of\n    GRMHD simulation configurations of post-merger accretion disks.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Format: (M, r, rho, p_gas, Gamma, B, delta_x, N, M_ej_inf, delta, p_conv)\n    test_cases = [\n        # Case 1\n        (5, 50, 1e-4, 1e-6, 4/3, 1e-3, 2.0, 10, 0.05, 0.2, 2),\n        # Case 2\n        (5, 50, 1e-4, 1e-6, 4/3, 1e-3, 2.7471, 10, 0.05, 0.2, 2),\n        # Case 3\n        (5, 50, 1e-4, 1e-6, 4/3, 1e-3, 5.6, 10, 0.05, 0.2, 2),\n        # Case 4\n        (7, 20, 1e-6, 1e-8, 4/3, 1e-1, 1.0, 20, 0.1, 0.1, 1.5)\n    ]\n\n    results = []\n    for case in test_cases:\n        M, r, rho, p_gas, Gamma, B, delta_x, N, M_ej_inf, delta, p_conv = case\n\n        # 1. Calculate specific enthalpy, h\n        h = 1 + (Gamma / (Gamma - 1)) * p_gas / rho\n\n        # 2. Calculate relativistic Alfvén speed, vA\n        vA_sq = (B**2) / (4 * np.pi * rho * h + B**2)\n        vA = np.sqrt(vA_sq)\n\n        # 3. Calculate orbital angular frequency, Omega\n        Omega = np.sqrt(M / r**3)\n\n        # 4. Calculate characteristic MRI wavelength, lambda_mri\n        lambda_mri = (2 * np.pi * vA) / Omega\n\n        # 5. Calculate MRI quality factor, Q\n        # Avoid division by zero, though delta_x is non-zero in test cases.\n        if delta_x > 0:\n            Q = lambda_mri / delta_x\n        else:\n            Q = np.inf\n\n        # 6. Determine MRI resolution status\n        resolved = Q >= N\n\n        # 7. Calculate required cell size, delta_x_req\n        # N is a positive integer, so no division by zero.\n        delta_x_req = lambda_mri / N\n\n        # 8. Estimate the unbound mass, M_ej\n        # Ensure Q is positive to avoid division by zero or complex numbers.\n        if Q > 0:\n            mass_factor = 1 - delta * (N / Q)**p_conv\n        else:\n            # If Q=0, the error is infinite, so mass should be 0.\n            mass_factor = -np.inf\n        \n        M_ej = M_ej_inf * max(0, mass_factor)\n\n        # Append the list of results for this case.\n        # Floating point numbers will be formatted in the final print statement.\n        results.append([resolved, delta_x_req, Q, M_ej])\n\n    # Format the final output string exactly as required.\n    result_strings = []\n    for res in results:\n        # res is [boolean, float, float, float]\n        resolved_str = str(res[0])\n        dx_req_str = f\"{res[1]:.6f}\"\n        q_str = f\"{res[2]:.6f}\"\n        m_ej_str = f\"{res[3]:.6f}\"\n        result_strings.append(f\"[{resolved_str},{dx_req_str},{q_str},{m_ej_str}]\")\n    \n    final_output = f\"[{','.join(result_strings)}]\"\n    print(final_output)\n\nsolve()\n```", "id": "3466335"}]}