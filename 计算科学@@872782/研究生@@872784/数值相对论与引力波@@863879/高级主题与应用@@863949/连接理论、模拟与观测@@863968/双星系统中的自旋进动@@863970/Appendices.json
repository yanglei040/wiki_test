{"hands_on_practices": [{"introduction": "理解自旋进动始于其在后牛顿哈密顿量中的数学根源。这第一个练习提供了一个直接的、动手的计算，将抽象的自旋-轨道相互作用项与控制简化双星系统中自旋和轨道平面动力学的具体角速度矢量联系起来。掌握这一基本推导是建立更复杂进动双星模型的第一步。[@problem_id:3487484]", "problem": "考虑一个致密双星系统，其成员质量相等 $m_1=m_2=m$，处于间距恒为 $r$ 的严格圆形轨道上。假设只有天体1带有自旋，其无量纲自旋参数 $\\chi_1$ 由关系式 $S_1 = \\chi_1 \\frac{G m_1^2}{c}$ 定义，其中 $S_1$ 是天体1的自旋角动量大小，$G$ 是引力常数，$c$ 是光速。忽略自旋-自旋相互作用和引力辐射反作用，并在后牛顿（PN）自旋-轨道耦合的领头阶上进行计算。使用哈密顿表述，其中自旋-轨道相互作用哈密顿量具有以下领头阶形式\n$$\nH_{\\mathrm{SO}} = \\frac{G}{c^2 r^3} \\,\\mathbf{L}\\cdot\\left[\\left(2+\\frac{3}{2}\\frac{m_2}{m_1}\\right)\\mathbf{S}_1+\\left(2+\\frac{3}{2}\\frac{m_1}{m_2}\\right)\\mathbf{S}_2\\right],\n$$\n其中 $\\mathbf{L}$ 是轨道角动量，$\\mathbf{S}_i$ 是自旋矢量。自旋进动方程为 $d\\mathbf{S}_i/dt = \\boldsymbol{\\Omega}_i\\times \\mathbf{S}_i$，其中 $\\boldsymbol{\\Omega}_i = \\partial H_{\\mathrm{SO}}/\\partial \\mathbf{S}_i$；在守恒极限下，轨道角动量的演化遵循 $d\\mathbf{L}/dt = \\boldsymbol{\\Omega}_L \\times \\mathbf{L}$。\n\n采用一个惯性笛卡尔坐标系，其中轨道角动量指向 $+\\hat{\\mathbf{z}}$ 轴方向，因此 $\\mathbf{L}=L\\,\\hat{\\mathbf{z}}$。其牛顿圆形轨道角动量大小为 $L=\\mu\\sqrt{GMr}$，其中 $M=m_1+m_2$ 是总质量，$\\mu=m_1 m_2/M$ 是折合质量。设天体1的自旋相对于 $\\mathbf{L}$ 倾斜角度 $\\theta_{1L}$，位于 $\\hat{\\mathbf{x}}$-$\\hat{\\mathbf{z}}$ 平面内，因此 $\\hat{\\mathbf{S}}_1=\\sin\\theta_{1L}\\,\\hat{\\mathbf{x}}+\\cos\\theta_{1L}\\,\\hat{\\mathbf{z}}$ 且 $\\mathbf{S}_1=S_1\\,\\hat{\\mathbf{S}}_1$。设 $\\mathbf{S}_2=\\mathbf{0}$。\n\n使用上述框架，从第一性原理推导在 $m_1=m_2$ 条件下，自旋进动矢量 $\\boldsymbol{\\Omega}_1$ 和轨道进动矢量 $\\boldsymbol{\\Omega}_L$ 的领头阶表达式，并使用以下参数值对其进行数值计算：\n- $m_1=m_2=30\\,M_{\\odot}$，其中 $M_{\\odot}=1.98847\\times 10^{30}\\,\\mathrm{kg}$，\n- $r=1.0\\times 10^{9}\\,\\mathrm{m}$，\n- $\\chi_1=0.7$，\n- $\\theta_{1L}=0.6\\,\\mathrm{rad}$，\n- $G=6.67430\\times 10^{-11}\\,\\mathrm{m}^3\\,\\mathrm{kg}^{-1}\\,\\mathrm{s}^{-2}$，\n- $c=2.99792458\\times 10^{8}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$。\n\n以弧度/秒为单位，提供分量 $(\\Omega_{1x},\\Omega_{1y},\\Omega_{1z},\\Omega_{Lx},\\Omega_{Ly},\\Omega_{Lz})$。将您的数值结果四舍五入到四位有效数字。最终答案必须是包含这六个数字的单行矩阵。", "solution": "### 第一步：分析问题并提取已知条件\n-   **系统**：一个致密双星系统，成员质量相等，$m_1=m_2=m$。\n-   **轨道**：严格圆形轨道，间距恒定为 $r$。\n-   **自旋**：只有天体1带有自旋 ($\\mathbf{S}_2 = \\mathbf{0}$)，其自旋大小为 $S_1 = \\chi_1 \\frac{G m_1^2}{c}$。\n-   **近似**：计算在后牛顿 (PN) 自旋-轨道 (SO) 耦合的领头阶上进行，忽略自旋-自旋相互作用和引力辐射反作用。\n-   **哈密顿量**：给定的SO相互作用哈密顿量为 $H_{\\mathrm{SO}} = \\frac{G}{c^2 r^3} \\,\\mathbf{L}\\cdot\\left[\\left(2+\\frac{3}{2}\\frac{m_2}{m_1}\\right)\\mathbf{S}_1+\\left(2+\\frac{3}{2}\\frac{m_1}{m_2}\\right)\\mathbf{S}_2\\right]$。\n-   **运动方程**：自旋进动由 $d\\mathbf{S}_i/dt = \\boldsymbol{\\Omega}_i\\times \\mathbf{S}_i$ 描述，其中 $\\boldsymbol{\\Omega}_i = \\partial H_{\\mathrm{SO}}/\\partial \\mathbf{S}_i$。轨道进动遵循 $d\\mathbf{L}/dt = \\boldsymbol{\\Omega}_L \\times \\mathbf{L}$。根据哈密顿力学，$\\boldsymbol{\\Omega}_L$ 应为 $\\partial H_{\\mathrm{SO}}/\\partial \\mathbf{L}$。\n-   **坐标系与矢量**：\n    -   轨道角动量：$\\mathbf{L}=L\\,\\hat{\\mathbf{z}}$，其大小为 $L=\\mu\\sqrt{GMr}$，其中总质量 $M=m_1+m_2$，折合质量 $\\mu=m_1 m_2/M$。\n    -   天体1的自旋矢量：$\\mathbf{S}_1=S_1(\\sin\\theta_{1L}\\,\\hat{\\mathbf{x}}+\\cos\\theta_{1L}\\,\\hat{\\mathbf{z}})$。\n-   **任务**：\n    1.  推导在 $m_1=m_2$ 条件下，自旋进动矢量 $\\boldsymbol{\\Omega}_1$ 和轨道进动矢量 $\\boldsymbol{\\Omega}_L$ 的表达式。\n    2.  对给定的数值进行计算。\n-   **数值**：\n    -   $m_1=m_2=30\\,M_{\\odot}$ ($M_{\\odot}=1.98847\\times 10^{30}\\,\\mathrm{kg}$)\n    -   $r=1.0\\times 10^{9}\\,\\mathrm{m}$\n    -   $\\chi_1=0.7$\n    -   $\\theta_{1L}=0.6\\,\\mathrm{rad}$\n    -   $G=6.67430\\times 10^{-11}\\,\\mathrm{m}^3\\,\\mathrm{kg}^{-1}\\,\\mathrm{s}^{-2}$\n    -   $c=2.99792458\\times 10^{8}\\,\\mathrm{m}\\,\\mathrm{s}^{-1}$\n-   **输出格式**：一个包含六个分量 $(\\Omega_{1x},\\Omega_{1y},\\Omega_{1z},\\Omega_{Lx},\\Omega_{Ly},\\Omega_{Lz})$ 的单行矩阵，单位为 $\\mathrm{rad/s}$，保留四位有效数字。\n\n### 第二步：解析推导\n\n首先，根据问题条件（$m_1=m_2=m$，$S_2=0$）简化哈密顿量。质量比 $m_2/m_1 = 1$ 且 $m_1/m_2 = 1$。\n$$\nH_{\\mathrm{SO}} = \\frac{G}{c^2 r^3} \\,\\mathbf{L}\\cdot\\left[\\left(2+\\frac{3}{2}(1)\\right)\\mathbf{S}_1+\\left(2+\\frac{3}{2}(1)\\right)\\mathbf{0}\\right] = \\frac{7}{2}\\frac{G}{c^2 r^3}\\,\\mathbf{L}\\cdot\\mathbf{S}_1\n$$\n\n**1. 推导自旋进动矢量 $\\boldsymbol{\\Omega}_1$**\n\n根据定义 $\\boldsymbol{\\Omega}_1 = \\partial H_{\\mathrm{SO}}/\\partial \\mathbf{S}_1$，对简化的哈密顿量求关于 $\\mathbf{S}_1$ 的偏导数：\n$$\n\\boldsymbol{\\Omega}_1 = \\frac{\\partial}{\\partial \\mathbf{S}_1} \\left( \\frac{7}{2}\\frac{G}{c^2 r^3}\\,\\mathbf{L}\\cdot\\mathbf{S}_1 \\right) = \\frac{7}{2}\\frac{G}{c^2 r^3}\\,\\mathbf{L}\n$$\n由于 $\\mathbf{L} = L\\,\\hat{\\mathbf{z}}$，$\\boldsymbol{\\Omega}_1$ 的分量为：\n$$\n\\Omega_{1x} = 0, \\quad \\Omega_{1y} = 0, \\quad \\Omega_{1z} = \\frac{7}{2}\\frac{G L}{c^2 r^3}\n$$\n\n**2. 推导轨道进动矢量 $\\boldsymbol{\\Omega}_L$**\n\n类似地，轨道进动矢量由 $\\boldsymbol{\\Omega}_L = \\partial H_{\\mathrm{SO}}/\\partial \\mathbf{L}$ 给出：\n$$\n\\boldsymbol{\\Omega}_L = \\frac{\\partial}{\\partial \\mathbf{L}} \\left( \\frac{7}{2}\\frac{G}{c^2 r^3}\\,\\mathbf{L}\\cdot\\mathbf{S}_1 \\right) = \\frac{7}{2}\\frac{G}{c^2 r^3}\\,\\mathbf{S}_1\n$$\n我们可以验证这个定义与总角动量守恒是一致的。在忽略辐射的情况下，总角动量 $\\mathbf{J} = \\mathbf{L} + \\mathbf{S}_1$ 是守恒的。其时间导数为：\n$d\\mathbf{J}/dt = d\\mathbf{L}/dt + d\\mathbf{S}_1/dt = (\\boldsymbol{\\Omega}_L \\times \\mathbf{L}) + (\\boldsymbol{\\Omega}_1 \\times \\mathbf{S}_1)$\n$= \\left(\\frac{7}{2}\\frac{G}{c^2 r^3}\\,\\mathbf{S}_1\\right) \\times \\mathbf{L} + \\left(\\frac{7}{2}\\frac{G}{c^2 r^3}\\,\\mathbf{L}\\right) \\times \\mathbf{S}_1$\n$= \\frac{7}{2}\\frac{G}{c^2 r^3}\\,(\\mathbf{S}_1 \\times \\mathbf{L} + \\mathbf{L} \\times \\mathbf{S}_1) = \\mathbf{0}$，因为 $\\mathbf{A} \\times \\mathbf{B} = -(\\mathbf{B} \\times \\mathbf{A})$。\n\n将 $\\mathbf{S}_1=S_1(\\sin\\theta_{1L}\\,\\hat{\\mathbf{x}}+\\cos\\theta_{1L}\\,\\hat{\\mathbf{z}})$ 代入，得到 $\\boldsymbol{\\Omega}_L$ 的分量：\n$$\n\\Omega_{Lx} = \\frac{7}{2}\\frac{G S_1}{c^2 r^3}\\sin\\theta_{1L}, \\quad \\Omega_{Ly} = 0, \\quad \\Omega_{Lz} = \\frac{7}{2}\\frac{G S_1}{c^2 r^3}\\cos\\theta_{1L}\n$$\n\n### 第三步：数值计算\n\n首先，计算所需物理量的大小。\n-   $m = 30 \\times 1.98847 \\times 10^{30} = 5.96541 \\times 10^{31}\\,\\mathrm{kg}$\n-   总质量：$M = 2m = 1.193082 \\times 10^{32}\\,\\mathrm{kg}$\n-   折合质量：$\\mu = m/2 = 2.982705 \\times 10^{31}\\,\\mathrm{kg}$\n-   轨道角动量大小 $L$：\n    $$\n    L = \\mu\\sqrt{GMr} = (2.982705 \\times 10^{31}) \\sqrt{(6.67430 \\times 10^{-11})(1.193082 \\times 10^{32})(1.0 \\times 10^9)} \\approx 8.41505 \\times 10^{46}\\,\\mathrm{kg\\,m^2\\,s^{-1}}\n    $$\n-   自旋角动量大小 $S_1$：\n    $$\n    S_1 = \\chi_1 \\frac{G m^2}{c} = 0.7 \\times \\frac{(6.67430 \\times 10^{-11})(5.96541 \\times 10^{31})^2}{2.99792458 \\times 10^8} \\approx 5.54568 \\times 10^{44}\\,\\mathrm{kg\\,m^2\\,s^{-1}}\n    $$\n\n现在，计算进动矢量的分量。\n-   公共前置因子 $C = \\frac{7}{2}\\frac{G}{c^2 r^3}$：\n    $$\n    C = \\frac{3.5 \\times (6.67430 \\times 10^{-11})}{(2.99792458 \\times 10^8)^2 (1.0 \\times 10^9)^3} \\approx 2.59927 \\times 10^{-54}\\,\\mathrm{kg^{-1}\\,m^{-2}\\,s}\n    $$\n-   $\\boldsymbol{\\Omega}_1$ 的分量：\n    $$\n    \\Omega_{1x} = 0, \\quad \\Omega_{1y} = 0\n    $$\n    $$\n    \\Omega_{1z} = C \\times L \\approx (2.59927 \\times 10^{-54}) \\times (8.41505 \\times 10^{46}) \\approx 2.1873 \\times 10^{-7}\\,\\mathrm{rad/s}\n    $$\n-   $\\boldsymbol{\\Omega}_L$ 的分量（使用 $\\sin(0.6) \\approx 0.564642$ 和 $\\cos(0.6) \\approx 0.825336$）：\n    $$\n    \\Omega_{Lx} = C \\times S_1 \\sin\\theta_{1L} \\approx (2.59927 \\times 10^{-54}) \\times (5.54568 \\times 10^{44}) \\times 0.564642 \\approx 8.1388 \\times 10^{-10}\\,\\mathrm{rad/s}\n    $$\n    $$\n    \\Omega_{Ly} = 0\n    $$\n    $$\n    \\Omega_{Lz} = C \\times S_1 \\cos\\theta_{1L} \\approx (2.59927 \\times 10^{-54}) \\times (5.54568 \\times 10^{44}) \\times 0.825336 \\approx 1.1897 \\times 10^{-9}\\,\\mathrm{rad/s}\n    $$\n\n### 第四步：整理最终答案\n\n将结果四舍五入到四位有效数字，并按要求格式化：\n-   $\\Omega_{1x} = 0$\n-   $\\Omega_{1y} = 0$\n-   $\\Omega_{1z} = 2.187 \\times 10^{-7}\\,\\mathrm{rad/s}$\n-   $\\Omega_{Lx} = 8.139 \\times 10^{-10}\\,\\mathrm{rad/s}$\n-   $\\Omega_{Ly} = 0$\n-   $\\Omega_{Lz} = 1.190 \\times 10^{-9}\\,\\mathrm{rad/s}$", "answer": "$$\n\\boxed{\\begin{pmatrix} 0 & 0 & 2.187 \\times 10^{-7} & 8.139 \\times 10^{-10} & 0 & 1.190 \\times 10^{-9} \\end{pmatrix}}\n$$", "id": "3487484"}, {"introduction": "虽然连续的运动方程保证了自旋大小的守恒，但这对于其数值解并非自动成立。本练习挑战您批判性地思考不同数值积分器的特性，这是在长并合过程中生成精确引力波波形的关键考量。理解为什么像显式龙格-库塔这样的方法可能会失败，以及为什么几何积分器会成功，对于计算引力物理学领域的任何工作都至关重要。[@problem_id:3487491]", "problem": "一个由成员质量为 $m_1$ 和 $m_2$、自旋矢量为 $\\mathbf{S}_1$ 和 $\\mathbf{S}_2$ 组成的准圆形双黑洞在后牛顿（PN）近似下进行建模。每个天体的自旋进动由以下形式的常微分方程控制\n$$\n\\frac{d\\mathbf{S}_i}{dt} = \\boldsymbol{\\Omega}_i(\\mathbf{L},\\mathbf{S}_1,\\mathbf{S}_2,\\ldots) \\times \\mathbf{S}_i,\\quad i\\in\\{1,2\\},\n$$\n其中 $\\boldsymbol{\\Omega}_i$ 是轨道角动量 $\\mathbf{L}$ 和自旋的光滑函数，符号 $\\times$ 表示矢量叉乘。您将对这些方程在多个进动周期上进行积分，以生成引力波相位。必须在使用 $s$ 阶显式 Runge–Kutta 方法、隐式配置方法，或基于旋转矢量（即作用于 $\\mathbf{S}_i$ 的斜对称算子的指数）的更新方法之间做出选择。\n\n从方程的基本叉乘结构以及在后牛顿主阶上自旋大小 $|\\mathbf{S}_i|$ 是运动常数的物理要求出发，评估以下关于数值积分和长期精度的陈述。选择所有有效的陈述。\n\nA. 对于具有光滑 $\\boldsymbol{\\Omega}_i$ 的系统 $\\frac{d\\mathbf{S}_i}{dt} = \\boldsymbol{\\Omega}_i \\times \\mathbf{S}_i$，一个通用的 $s$ 阶显式 Runge–Kutta 方法不能精确地保持 $|\\mathbf{S}_i|$，并且除非时间步长 $h$ 非常小，否则在多个进动周期内 $|\\mathbf{S}_i|$ 会表现出长期漂移。\n\nB. 隐式中点法（一阶 Gauss–Legendre 配置）能保持任何二次不变量，因此对于进动系统，它能在任意时间步长 $h$ 下精确地保持 $|\\mathbf{S}_i|^2$。\n\nC. 后向欧拉法（一阶隐式方法）能精确地保持进动系统的 $|\\mathbf{S}_i|$，因此更适合长期积分。\n\nD. 对于一个适当选择的 $\\boldsymbol{\\Omega}_i^{\\star}$（例如，在时间步中点处取值），使用旋转矢量积分器进行更新 $\\mathbf{S}_i^{n+1} = \\exp\\!\\big(h\\,\\boldsymbol{\\Omega}_i^{\\star}\\times\\big)\\,\\mathbf{S}_i^{n}$，根据其构造能够保持 $|\\mathbf{S}_i|$，从而避免有效自旋参数 $\\chi_{\\mathrm{eff}}$ 和引力波相位中的长期偏差。\n\nE. 保持 $|\\mathbf{S}_i|$ 对于长期波形精度不重要，因为辐射反作用在主阶上会改变 $|\\mathbf{S}_i|$，所以 $|\\mathbf{S}_i|$ 的数值变化在物理上是一致的。\n\n基于叉乘动力学、不变量及其对引力波相位的影响来解释你的推理，包括有效自旋参数 $\\chi_{\\mathrm{eff}}$ 的作用，该参数依赖于无量纲自旋 $\\boldsymbol{\\chi}_i = \\mathbf{S}_i/m_i^2$ 在 $\\hat{\\mathbf{L}}$ 上的投影，例如，通过 $\\chi_{\\mathrm{eff}} = \\frac{1}{m_1+m_2}\\big(m_1\\,\\boldsymbol{\\chi}_1 + m_2\\,\\boldsymbol{\\chi}_2\\big)\\cdot\\hat{\\mathbf{L}}$。", "solution": "问题陈述描述了后牛顿近似下双黑洞系统的自旋进动动力学，并要求评估有关这些方程数值积分的几个陈述。\n\n首先，我们必须验证问题中提到的基本物理性质。控制每个自旋 $\\mathbf{S}_i$ 进动的方程由下式给出\n$$\n\\frac{d\\mathbf{S}_i}{dt} = \\boldsymbol{\\Omega}_i \\times \\mathbf{S}_i.\n$$\n为了验证自旋大小 $|\\mathbf{S}_i|$ 是该方程的一个运动常数，我们考察其平方 $|\\mathbf{S}_i|^2 = \\mathbf{S}_i \\cdot \\mathbf{S}_i$ 的时间导数。使用导数的乘法法则：\n$$\n\\frac{d}{dt}|\\mathbf{S}_i|^2 = \\frac{d}{dt}(\\mathbf{S}_i \\cdot \\mathbf{S}_i) = 2 \\mathbf{S}_i \\cdot \\frac{d\\mathbf{S}_i}{dt}.\n$$\n代入控制方程：\n$$\n\\frac{d}{dt}|\\mathbf{S}_i|^2 = 2 \\mathbf{S}_i \\cdot (\\boldsymbol{\\Omega}_i \\times \\mathbf{S}_i).\n$$\n右侧的表达式是形式为 $\\mathbf{A} \\cdot (\\mathbf{B} \\times \\mathbf{A})$ 的标量三重积。对于任何矢量 $\\mathbf{A}$ 和 $\\mathbf{B}$，该乘积恒等于零，因为根据定义，叉积 $\\mathbf{B} \\times \\mathbf{A}$ 产生的矢量与 $\\mathbf{A}$ 正交。因此，它们的点积为零。\n于是，\n$$\n\\frac{d}{dt}|\\mathbf{S}_i|^2 = 0.\n$$\n这证实了 $|\\mathbf{S}_i|^2$，并引申到自旋大小 $|\\mathbf{S}_i|$，是所述精确连续动力学的一个守恒量或不变量。这是一个关键性质。任务是确定哪些数值方法能保持这个不变量，以及不保持它会带来什么后果。量 $|\\mathbf{S}_i|^2$ 是一个二次不变量。\n\n我们现在评估每个陈述。\n\n**A. 对于具有光滑 $\\boldsymbol{\\Omega}_i$ 的系统 $\\frac{d\\mathbf{S}_i}{dt} = \\boldsymbol{\\Omega}_i \\times \\mathbf{S}_i$，一个通用的 $s$ 阶显式 Runge–Kutta 方法不能精确地保持 $|\\mathbf{S}_i|$，并且除非时间步长 $h$ 非常小，否则在多个进动周期内 $|\\mathbf{S}_i|$ 会表现出长期漂移。**\n\n让我们考虑一个用于常微分方程 $\\frac{d\\mathbf{y}}{dt} = \\mathbf{f}(\\mathbf{y})$ 的通用显式 Runge-Kutta (ERK) 方法。从状态 $\\mathbf{y}^n$ 到 $\\mathbf{y}^{n+1}$ 经过一个时间步长 $h$ 的更新是一系列显式阶段。为了说明原理，我们分析最简单的 ERK 方法，即前向欧拉法 ($s=1$)：\n$$\n\\mathbf{S}_i^{n+1} = \\mathbf{S}_i^n + h \\left( \\boldsymbol{\\Omega}_i^n \\times \\mathbf{S}_i^n \\right),\n$$\n其中 $\\boldsymbol{\\Omega}_i^n$ 是使用第 $n$ 步的量计算的。\n让我们计算 $\\mathbf{S}_i^{n+1}$ 的大小的平方：\n$$\n|\\mathbf{S}_i^{n+1}|^2 = \\mathbf{S}_i^{n+1} \\cdot \\mathbf{S}_i^{n+1} = \\left( \\mathbf{S}_i^n + h (\\boldsymbol{\\Omega}_i^n \\times \\mathbf{S}_i^n) \\right) \\cdot \\left( \\mathbf{S}_i^n + h (\\boldsymbol{\\Omega}_i^n \\times \\mathbf{S}_i^n) \\right)\n$$\n$$\n|\\mathbf{S}_i^{n+1}|^2 = |\\mathbf{S}_i^n|^2 + 2h \\left( \\mathbf{S}_i^n \\cdot (\\boldsymbol{\\Omega}_i^n \\times \\mathbf{S}_i^n) \\right) + h^2 |\\boldsymbol{\\Omega}_i^n \\times \\mathbf{S}_i^n|^2.\n$$\n如前所述，中间项为零。因此，\n$$\n|\\mathbf{S}_i^{n+1}|^2 = |\\mathbf{S}_i^n|^2 + h^2 |\\boldsymbol{\\Omega}_i^n \\times \\mathbf{S}_i^n|^2.\n$$\n由于 $|\\boldsymbol{\\Omega}_i^n \\times \\mathbf{S}_i^n|^2 \\ge 0$，我们有 $|\\mathbf{S}_i^{n+1}|^2 \\ge |\\mathbf{S}_i^n|^2$。除非 $\\boldsymbol{\\Omega}_i^n$ 与 $\\mathbf{S}_i^n$ 平行（此时没有进动），否则自旋大小会严格增加。这种人为的增长在每个时间步都会发生，导致一个长期（累积）误差。一个通用的 $s$ 阶 ERK 方法是这类更新的线性组合，并且由于它不是为保持几何结构而设计的，通常也无法保持 $|\\mathbf{S}_i|$。这导致自旋大小出现不符合物理规律的漂移，只有通过使步长 $h$ 非常小才能抑制。\n结论：**正确**。\n\n**B. 隐式中点法（一阶 Gauss–Legendre 配置）能保持任何二次不变量，因此对于进动系统，它能在任意时间步长 $h$ 下精确地保持 $|\\mathbf{S}_i|^2$。**\n\n对于常微分方程 $\\frac{d\\mathbf{y}}{dt} = \\mathbf{f}(\\mathbf{y})$，隐式中点法定义为：\n$$\n\\mathbf{y}^{n+1} = \\mathbf{y}^n + h \\, \\mathbf{f}\\left(\\frac{\\mathbf{y}^n + \\mathbf{y}^{n+1}}{2}\\right).\n$$\n这是 Gauss-Legendre 配置方法类的一员，这类方法已知是辛的并且保持系统的所有二次不变量。让我们在我们的特定情况下证明这一点。设 $\\mathbf{S}^n \\equiv \\mathbf{S}_i^n$。\n$$\n\\mathbf{S}^{n+1} = \\mathbf{S}^n + h \\left( \\boldsymbol{\\Omega}_i^\\star \\times \\frac{\\mathbf{S}^n + \\mathbf{S}^{n+1}}{2} \\right),\n$$\n其中 $\\boldsymbol{\\Omega}_i^\\star$ 在中点处计算。我们可以将其重写为：\n$$\n\\mathbf{S}^{n+1} - \\mathbf{S}^n = h \\left( \\boldsymbol{\\Omega}_i^\\star \\times \\frac{\\mathbf{S}^n + \\mathbf{S}^{n+1}}{2} \\right).\n$$\n将等式两边与 $(\\mathbf{S}^n + \\mathbf{S}^{n+1})$ 做点积：\n$$\n(\\mathbf{S}^{n+1} - \\mathbf{S}^n) \\cdot (\\mathbf{S}^{n+1} + \\mathbf{S}^n) = h \\left( \\boldsymbol{\\Omega}_i^\\star \\times \\frac{\\mathbf{S}^n + \\mathbf{S}^{n+1}}{2} \\right) \\cdot (\\mathbf{S}^n + \\mathbf{S}^{n+1}).\n$$\n左边简化为 $|\\mathbf{S}^{n+1}|^2 - |\\mathbf{S}^n|^2$。右边是一个形式为 $k (\\mathbf{A} \\times \\mathbf{B}) \\cdot \\mathbf{B}$ 的标量三重积，其值恒为零。因此，\n$$\n|\\mathbf{S}^{n+1}|^2 - |\\mathbf{S}^n|^2 = 0 \\quad\\implies\\quad |\\mathbf{S}^{n+1}|^2 = |\\mathbf{S}^n|^2.\n$$\n隐式中点法对于任意步长 $h$ 都能精确地保持二次不变量 $|\\mathbf{S}_i|^2$。\n结论：**正确**。\n\n**C. 后向欧拉法（一阶隐式方法）能精确地保持进动系统的 $|\\mathbf{S}_i|$，因此更适合长期积分。**\n\n后向欧拉法定义为：\n$$\n\\mathbf{y}^{n+1} = \\mathbf{y}^n + h \\, \\mathbf{f}(\\mathbf{y}^{n+1}).\n$$\n对于我们的系统，这是：\n$$\n\\mathbf{S}_i^{n+1} = \\mathbf{S}_i^n + h \\left( \\boldsymbol{\\Omega}_i^{n+1} \\times \\mathbf{S}_i^{n+1} \\right).\n$$\n重新整理以解出 $\\mathbf{S}_i^n$：\n$$\n\\mathbf{S}_i^n = \\mathbf{S}_i^{n+1} - h \\left( \\boldsymbol{\\Omega}_i^{n+1} \\times \\mathbf{S}_i^{n+1} \\right).\n$$\n现在我们计算 $\\mathbf{S}_i^n$ 的大小的平方：\n$$\n|\\mathbf{S}_i^n|^2 = \\left( \\mathbf{S}_i^{n+1} - h (\\boldsymbol{\\Omega}_i^{n+1} \\times \\mathbf{S}_i^{n+1}) \\right) \\cdot \\left( \\mathbf{S}_i^{n+1} - h (\\boldsymbol{\\Omega}_i^{n+1} \\times \\mathbf{S}_i^{n+1}) \\right)\n$$\n$$\n|\\mathbf{S}_i^n|^2 = |\\mathbf{S}_i^{n+1}|^2 - 2h \\left( \\mathbf{S}_i^{n+1} \\cdot (\\boldsymbol{\\Omega}_i^{n+1} \\times \\mathbf{S}_i^{n+1}) \\right) + h^2 |\\boldsymbol{\\Omega}_i^{n+1} \\times \\mathbf{S}_i^{n+1}|^2.\n$$\n中间项为零。因此，\n$$\n|\\mathbf{S}_i^n|^2 = |\\mathbf{S}_i^{n+1}|^2 + h^2 |\\boldsymbol{\\Omega}_i^{n+1} \\times \\mathbf{S}_i^{n+1}|^2.\n$$\n这意味着 $|\\mathbf{S}_i^{n+1}|^2 \\le |\\mathbf{S}_i^n|^2$。后向欧拉法是耗散的；它导致自旋大小在每一步都衰减，这与前向欧拉法引起的增长一样不符合物理规律。它不能保持 $|\\mathbf{S}_i|$。\n结论：**错误**。\n\n**D. 对于一个适当选择的 $\\boldsymbol{\\Omega}_i^{\\star}$（例如，在时间步中点处取值），使用旋转矢量积分器进行更新 $\\mathbf{S}_i^{n+1} = \\exp\\!\\big(h\\,\\boldsymbol{\\Omega}_i^{\\star}\\times\\big)\\,\\mathbf{S}_i^{n}$，根据其构造能够保持 $|\\mathbf{S}_i|$，从而避免有效自旋参数 $\\chi_{\\mathrm{eff}}$ 和引力波相位中的长期偏差。**\n\n表达式 $\\boldsymbol{\\Omega}_i^{\\star}\\times$ 代表一个算子，它作用于一个矢量 $\\mathbf{v}$ 并返回 $\\boldsymbol{\\Omega}_i^{\\star}\\times\\mathbf{v}$。该算子可以由一个斜对称矩阵表示。设此矩阵为 $A = h[\\boldsymbol{\\Omega}_i^{\\star}]_{\\times}$。如果一个矩阵 $A$ 满足 $A^T = -A$，则它是斜对称矩阵。斜对称矩阵的指数 $R = \\exp(A)$ 总是一个正交矩阵。一个正交矩阵 $R$ 满足 $R^T R = I$，其中 $I$ 是单位矩阵。在三维空间中，这是一个旋转矩阵。\n更新由 $\\mathbf{S}_i^{n+1} = R \\mathbf{S}_i^n$ 给出。让我们计算更新后自旋矢量的大小平方：\n$$\n|\\mathbf{S}_i^{n+1}|^2 = (\\mathbf{S}_i^{n+1})^T \\mathbf{S}_i^{n+1} = (R \\mathbf{S}_i^n)^T (R \\mathbf{S}_i^n) = (\\mathbf{S}_i^n)^T R^T R \\mathbf{S}_i^n = (\\mathbf{S}_i^n)^T I \\mathbf{S}_i^n = |\\mathbf{S}_i^n|^2.\n$$\n这表明 $|\\mathbf{S}_i^{n+1}| = |\\mathbf{S}_i^n|$ 是精确成立的。该方法根据其构造保持了自旋大小，因为更新是一个纯旋转。$\\boldsymbol{\\Omega}_i^{\\star}$ 的选择（例如，在区间的开始、中间或结束处取值）会影响方法的精度和阶数，但不会影响其保持模长的性质。通过防止 $|\\mathbf{S}_i|$ 的非物理漂移，无量纲自旋大小 $|\\boldsymbol{\\chi}_i| = |\\mathbf{S}_i|/m_i^2$ 也被守恒。这避免了依赖于它们的量（如有效自旋参数 $\\chi_{\\mathrm{eff}}$）出现长期误差的一个主要来源，而 $\\chi_{\\mathrm{eff}}$ 又是决定引力波相位的关键参数。\n结论：**正确**。\n\n**E. 保持 $|\\mathbf{S}_i|$ 对于长期波形精度不重要，因为辐射反作用在主阶上会改变 $|\\mathbf{S}_i|$，所以 $|\\mathbf{S}_i|$ 的数值变化在物理上是一致的。**\n\n这个陈述从根本上是错误的。它将物理效应与数值伪迹混为一谈。\n问题陈述描述了在后牛顿主阶上的自旋动力学，这是一个 $|\\mathbf{S}_i|$ 恒定的纯保守进动。引力辐射反作用的物理效应会导致轨道衰减和自旋大小改变，这些效应出现在更高阶的后牛顿阶（例如，自旋大小的变化是一个非常高阶的效应，从 4PN 阶开始）。在每个轨道的基础上，这些物理效应通常远小于进动效应，并且在更长的辐射反作用时间尺度上演化。\n一个不保持底层保守系统不变量的数值方法（如 ERK）会引入其自身的不符合物理规律的耗散或反耗散。这种数值误差的大小和特性取决于方法和步长 $h$，而不是广义相对论的物理学。允许 $|\\mathbf{S}_i|$ 发生任意的数值漂移，会淹没微妙、真实的物理演化，并导致对引力波相位的错误预测。计算物理中的正确方法是使用一个尊重问题保守部分几何结构的数值方案（例如，一个保持 $|\\mathbf{S}_i|$ 的几何积分器），然后单独并准确地引入来自辐射反作用的较小的物理耗散项。\n结论：**错误**。", "answer": "$$\\boxed{ABD}$$", "id": "3487491"}, {"introduction": "真实的天体物理双星系统并不总是处于完美的圆形轨道上，而且我们的理论模型可能依赖于所选的坐标系（规范）。这个高级练习通过要求您比较计算轨道平均进动率的不同方法，深入探讨了这些复杂性，同时考虑了偏心率和模型化的规范移动。这个编码练习为理解在构建高精度引力波波形模型时遇到的实际挑战和系统误差提供了宝贵的见解。[@problem_id:3487478]", "problem": "考虑一个致密双星系统，其成员质量为$m_1$和$m_2$，在一个半长轴为$a$、偏心率为$e = 0.2$的束缚牛顿开普勒轨道上运动。令$G$表示引力常数，$c$表示光速。定义总质量$M = m_1 + m_2$，约化质量$\\mu = \\frac{m_1 m_2}{M}$，以及牛顿比轨道角动量大小$h = \\sqrt{G M a (1 - e^2)}$。牛顿轨道角动量的大小为$L_\\mathrm{N} = \\mu h$。在领头阶自旋-轨道耦合（后牛顿展开的1.5阶，也称为$1.5$PN阶），天体1的自旋$\\mathbf{S}_1$根据$\\frac{d \\mathbf{S}_1}{dt} = \\boldsymbol{\\Omega}_1 \\times \\mathbf{S}_1$发生进动，其中进动矢量与牛顿轨道角动量方向对齐，其大小为\n$$\n\\Omega_1(t) = \\frac{G}{c^2} \\frac{K_1 L_\\mathrm{N}}{r(t)^3},\n$$\n其中$K_1 = 2 + \\tfrac{3}{2} \\frac{m_2}{m_1}$，$r(t)$是瞬时相对距离。作为真近点角$f$的函数的开普勒径向距离为\n$$\nr(f) = \\frac{a(1 - e^2)}{1 + e \\cos f},\n$$\n时间与真近点角的关系由开普勒第二定律给出，形式为\n$$\n\\frac{dt}{df} = \\frac{r(f)^2}{h}.\n$$\n\n您的任务是数值评估和比较两种用于计算一个轨道周期内天体1的轨道平均进动率的公式，并量化由偏心率截断和坐标规范移动模型引起的相对差异：\n\n1. 一种精确的（在牛顿轨道动力学范围内）解析平均值，通过以下第一性原理计算得出\n$$\n\\langle \\Omega_1 \\rangle_\\mathrm{exact} = \\frac{G}{c^2} K_1 L_\\mathrm{N} \\left\\langle r^{-3} \\right\\rangle,\n$$\n其中一个轨道周期内的时间平均为\n$$\n\\left\\langle r^{-3} \\right\\rangle = \\frac{1}{P} \\int_0^P r(t)^{-3} \\, dt,\n$$\n$P$是轨道周期。\n\n2. 一种数值公式，它通过将$r(f)$替换为其在$e$的二阶级数展开来截断逆径向因子的偏心率展开，\n$$\nr_\\mathrm{tr}(f) = a(1 - e^2) \\left(1 - e \\cos f + e^2 \\cos^2 f \\right),\n$$\n并使用以下公式数值计算相应的平均值\n$$\n\\langle \\Omega_1 \\rangle_\\mathrm{trunc} = \\frac{\\int_0^{2\\pi} \\Omega_1^\\mathrm{tr}(f)\\,\\frac{dt_\\mathrm{tr}}{df} \\, df}{\\int_0^{2\\pi} \\frac{dt_\\mathrm{tr}}{df} \\, df},\n$$\n其中\n$$\n\\Omega_1^\\mathrm{tr}(f) = \\frac{G}{c^2} \\frac{K_1 L_\\mathrm{N}}{r_\\mathrm{tr}(f)^3}, \\quad \\frac{dt_\\mathrm{tr}}{df} = \\frac{r_\\mathrm{tr}(f)^2}{h}.\n$$\n\n此外，为了模拟一阶后牛顿阶的坐标规范移动，考虑一个径向移动的坐标\n$$\nr'(f) = r(f) + \\epsilon, \\quad \\epsilon = \\xi \\frac{G M}{c^2},\n$$\n其中$\\xi = 1$是一个无量纲常数，表示此阶下两个坐标规范之间的一个单位量级的差异。使用此定义一个规范移动的数值平均值\n$$\n\\langle \\Omega_1 \\rangle_\\mathrm{gauge} = \\frac{\\int_0^{2\\pi} \\Omega_1'(f)\\,\\frac{dt'}{df} \\, df}{\\int_0^{2\\pi} \\frac{dt'}{df} \\, df},\n$$\n其中\n$$\n\\Omega_1'(f) = \\frac{G}{c^2} \\frac{K_1 L_\\mathrm{N}}{r'(f)^3}, \\quad \\frac{dt'}{df} = \\frac{r'(f)^2}{h}.\n$$\n\n仅从上述基本的开普勒动力学和领头阶自旋-轨道进动定律出发，执行以下操作：\n\n- 在不引用任何已知的$\\left\\langle r^{-3} \\right\\rangle$轨道平均公式的情况下，推导$\\langle \\Omega_1 \\rangle_\\mathrm{exact}$中所需的$\\left\\langle r^{-3} \\right\\rangle$的解析表达式。\n- 实现对$f$的数值积分，以评估截断和规范移动的平均值。\n- 对于下面的每个测试套件案例，计算：\n  - 精确的解析平均进动率$\\langle \\Omega_1 \\rangle_\\mathrm{exact}$，单位为弧度/秒，\n  - 相对截断差异\n    $$\n    \\delta_\\mathrm{trunc} = \\frac{\\left| \\langle \\Omega_1 \\rangle_\\mathrm{trunc} - \\langle \\Omega_1 \\rangle_\\mathrm{exact} \\right|}{\\langle \\Omega_1 \\rangle_\\mathrm{exact}},\n    $$\n  - 相对规范差异\n    $$\n    \\delta_\\mathrm{gauge} = \\frac{\\left| \\langle \\Omega_1 \\rangle_\\mathrm{gauge} - \\langle \\Omega_1 \\rangle_\\mathrm{exact} \\right|}{\\langle \\Omega_1 \\rangle_\\mathrm{exact}}.\n    $$\n\n在国际单位制（SI）中使用以下常数：$G = 6.67430 \\times 10^{-11}\\,\\mathrm{m^3\\,kg^{-1}\\,s^{-2}}$，$c = 299792458\\,\\mathrm{m\\,s^{-1}}$，以及太阳质量$M_\\odot = 1.98847 \\times 10^{30}\\,\\mathrm{kg}$。角度必须以弧度为单位。所有进动率以弧度/秒表示，所有相对差异以小数表示（而非百分比）。\n\n测试套件（所有情况$e = 0.2$且$\\xi = 1$）：\n- 案例A（一般情况）：$m_1 = 35\\,M_\\odot$, $m_2 = 25\\,M_\\odot$, $a = \\tilde{A}\\,\\frac{G M}{c^2}$，其中$\\tilde{A} = 200$。\n- 案例B（朝向更强场和不等质量的边界情况）：$m_1 = 10\\,M_\\odot$, $m_2 = 1.4\\,M_\\odot$, $a = \\tilde{A}\\,\\frac{G M}{c^2}$，其中$\\tilde{A} = 100$。\n- 案例C（朝向极弱场和相等质量的边缘情况）：$m_1 = 50\\,M_\\odot$, $m_2 = 50\\,M_\\odot$, $a = \\tilde{A}\\,\\frac{G M}{c^2}$，其中$\\tilde{A} = 10000$。\n\n您的程序应生成单行输出，其中包含一个逗号分隔的列表，列表被方括号包围，每个测试案例贡献一个包含五个浮点数的列表，顺序如下：\n$$\n\\left[ \\langle \\Omega_1 \\rangle_\\mathrm{exact},\\, \\langle \\Omega_1 \\rangle_\\mathrm{trunc},\\, \\langle \\Omega_1 \\rangle_\\mathrm{gauge},\\, \\delta_\\mathrm{trunc},\\, \\delta_\\mathrm{gauge} \\right].\n$$\n因此，总输出必须是一个包含三个此类列表的列表，每个测试案例一个，例如：\n$$\n\\left[ [x_{1},x_{2},x_{3},x_{4},x_{5}], [y_{1},y_{2},y_{3},y_{4},y_{5}], [z_{1},z_{2},z_{3},z_{4},z_{5}] \\right].\n$$", "solution": "### 问题验证\n此问题是有效的。它科学地基于牛顿天体力学和后牛顿理论的既定原理，信息充分，问题适定，可以得到唯一解，并且陈述客观。所有提供的常数和方程都是引力物理领域的标准。\n\n### 核心任务\n主要目标是计算和比较致密双星系统中主天体轨道平均自旋进动率 $\\langle \\Omega_1 \\rangle$ 的三种不同评估方法。这三种方法分别是：\n1.  **精确的解析平均值**：基于完整的牛顿轨道动力学。\n2.  **截断的数值平均值**：其中径向距离的表达式在偏心率 $e$ 上被截断。\n3.  **规范移动的数值平均值**：在径向坐标中引入一个模拟后牛顿规范效应的微小位移。\n\n### 第1部分：精确平均进动率的解析推导\n\n瞬时进动率由 $\\Omega_1(t) = \\frac{G}{c^2} \\frac{K_1 L_\\mathrm{N}}{r(t)^3}$ 给出。轨道平均进动率是其在一个轨道周期 $P$ 内的时间平均值：\n$$\n\\langle \\Omega_1 \\rangle_\\mathrm{exact} = \\frac{1}{P} \\int_0^P \\Omega_1(t) \\, dt = \\frac{G K_1 L_\\mathrm{N}}{c^2} \\left( \\frac{1}{P} \\int_0^P r(t)^{-3} \\, dt \\right) = \\frac{G K_1 L_\\mathrm{N}}{c^2} \\left\\langle r^{-3} \\right\\rangle\n$$\n计算的关键是推导时间平均值 $\\left\\langle r^{-3} \\right\\rangle$。我们使用开普勒第二定律 $\\frac{dt}{df} = \\frac{r(f)^2}{h}$，将积分变量从时间 $t$ 变换为真近点角 $f$。\n$$\n\\int_0^P r(t)^{-3} \\, dt = \\int_0^{2\\pi} r(f)^{-3} \\frac{dt}{df} \\, df = \\int_0^{2\\pi} r(f)^{-3} \\frac{r(f)^2}{h} \\, df = \\frac{1}{h} \\int_0^{2\\pi} \\frac{1}{r(f)} \\, df\n$$\n代入开普勒轨道方程 $r(f) = \\frac{a(1 - e^2)}{1 + e \\cos f}$：\n$$\n\\int_0^{2\\pi} \\frac{1}{r(f)} \\, df = \\int_0^{2\\pi} \\frac{1 + e \\cos f}{a(1 - e^2)} \\, df = \\frac{1}{a(1 - e^2)} \\left[ \\int_0^{2\\pi} 1 \\, df + e \\int_0^{2\\pi} \\cos f \\, df \\right] = \\frac{2\\pi}{a(1 - e^2)}\n$$\n轨道周期 $P$ 由开普勒第三定律给出：$P = 2\\pi \\sqrt{\\frac{a^3}{GM}}$。\n将这些结果结合起来得到 $\\left\\langle r^{-3} \\right\\rangle$：\n$$\n\\left\\langle r^{-3} \\right\\rangle = \\frac{1}{P} \\left( \\frac{1}{h} \\frac{2\\pi}{a(1 - e^2)} \\right) = \\frac{1}{2\\pi \\sqrt{\\frac{a^3}{GM}}} \\frac{1}{\\sqrt{GMa(1-e^2)}} \\frac{2\\pi}{a(1 - e^2)} = \\frac{1}{a^3 (1-e^2)^{3/2}}\n$$\n最后，将此代入 $\\langle \\Omega_1 \\rangle_\\mathrm{exact}$ 的表达式中，并用 $L_\\mathrm{N} = \\mu h$ 和 $h=\\sqrt{GMa(1-e^2)}$ 替换：\n$$\n\\langle \\Omega_1 \\rangle_\\mathrm{exact} = \\frac{G K_1 (\\mu \\sqrt{GMa(1-e^2)})}{c^2} \\frac{1}{a^3 (1-e^2)^{3/2}} = \\frac{G K_1 \\mu \\sqrt{GM}}{c^2 a^{5/2} (1-e^2)}\n$$\n这个最终的解析公式将用于计算。\n\n### 第2部分：数值平均值的公式\n\n对于截断和规范移动的情况，平均值通过对真近点角 $f$ 进行加权积分来计算：\n$$\n\\langle \\tilde{\\Omega}_1 \\rangle = \\frac{\\int_0^{2\\pi} \\tilde{\\Omega}(f) \\frac{d\\tilde{t}}{df} \\, df}{\\int_0^{2\\pi} \\frac{d\\tilde{t}}{df} \\, df}\n$$\n其中 $\\tilde{r}(f)$ 是相应的径向距离函数，$\\tilde{\\Omega}_1(f) = \\frac{G K_1 L_\\mathrm{N}}{c^2 \\tilde{r}(f)^3}$，而 $\\frac{d\\tilde{t}}{df} = \\frac{\\tilde{r}(f)^2}{h}$。代入后可简化为：\n$$\n\\langle \\tilde{\\Omega}_1 \\rangle = \\frac{G K_1 L_\\mathrm{N}}{c^2} \\frac{\\int_0^{2\\pi} \\tilde{r}(f)^{-1} \\, df}{\\int_0^{2\\pi} \\tilde{r}(f)^2 \\, df}\n$$\n此公式适用于截断情况（$\\tilde{r}(f) = r_\\mathrm{tr}(f)$）和规范移动情况（$\\tilde{r}(f) = r'(f)$），其中的积分将进行数值计算。\n\n### 第3部分：算法实现\n\n解法在Python中实现。对于每个测试案例，执行以下步骤：\n1.  在SI单位制中定义物理常数 $G$、$c$ 和 $M_\\odot$。\n2.  对每个案例，将质量从太阳质量单位转换为千克，并计算 $M$、$\\mu$ 和 $a$。\n3.  计算 $h$、$L_\\mathrm{N}$ 和 $K_1$。\n4.  使用第1部分推导的解析公式计算 $\\langle \\Omega_1 \\rangle_\\mathrm{exact}$。\n5.  为计算 $\\langle \\Omega_1 \\rangle_\\mathrm{trunc}$，定义 $r_\\mathrm{tr}(f)$ 并数值计算 $\\int r_\\mathrm{tr}^{-1} df$ 和 $\\int r_\\mathrm{tr}^2 df$ 的积分。使用第2部分的公式计算平均值。\n6.  为计算 $\\langle \\Omega_1 \\rangle_\\mathrm{gauge}$，定义 $r'(f)$ 并数值计算 $\\int (r')^{-1} df$ 和 $\\int (r')^2 df$ 的积分。使用第2部分的公式计算平均值。\n7.  计算相对差异 $\\delta_\\mathrm{trunc}$ 和 $\\delta_\\mathrm{gauge}$。\n8.  整理每个案例的五个结果，并将最终输出格式化为列表的列表。", "answer": "```python\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Computes and compares exact, truncated, and gauge-shifted orbit-averaged\n    spin precession rates for compact binary systems.\n    \"\"\"\n    # Physical Constants in SI units\n    G = 6.67430e-11  # Gravitational constant (m^3 kg^-1 s^-2)\n    c = 299792458.0   # Speed of light (m s^-1)\n    M_sun = 1.98847e30 # Solar mass (kg)\n\n    # Problem parameters\n    e = 0.2  # Eccentricity\n    xi = 1.0 # Gauge shift parameter\n\n    # Test suite: (m1_msun, m2_msun, a_tilde)\n    test_cases = [\n        (35.0, 25.0, 200.0),  # Case A\n        (10.0, 1.4, 100.0),   # Case B\n        (50.0, 50.0, 10000.0) # Case C\n    ]\n\n    results_all_cases = []\n\n    for m1_msun, m2_msun, a_tilde in test_cases:\n        # Step 1: Calculate basic system parameters\n        m1 = m1_msun * M_sun\n        m2 = m2_msun * M_sun\n        M = m1 + m2\n        mu = (m1 * m2) / M\n        \n        # Step 2: Calculate orbital parameters\n        a = a_tilde * G * M / c**2\n        h = np.sqrt(G * M * a * (1 - e**2))\n        L_N = mu * h\n        \n        # Step 3: Calculate precession coefficient K1\n        K1 = 2.0 + 1.5 * (m2 / m1)\n        \n        # Step 4: Calculate the exact analytic average precession rate\n        omega_1_exact = (G / c**2) * K1 * mu * np.sqrt(G * M) / (a**2.5 * (1 - e**2))\n        \n        # Step 5: Numerically evaluate the truncated average precession rate\n        def r_tr(f):\n            return a * (1 - e**2) * (1 - e * np.cos(f) + e**2 * np.cos(f)**2)\n            \n        def integrand_num_trunc(f):\n            return 1.0 / r_tr(f)\n            \n        def integrand_den_trunc(f):\n            return r_tr(f)**2\n            \n        num_int_trunc, _ = integrate.quad(integrand_num_trunc, 0, 2 * np.pi)\n        den_int_trunc, _ = integrate.quad(integrand_den_trunc, 0, 2 * np.pi)\n        \n        omega_1_trunc = (G / c**2) * K1 * L_N * (num_int_trunc / den_int_trunc)\n        \n        # Step 6: Numerically evaluate the gauge-shifted average precession rate\n        epsilon = xi * G * M / c**2\n        \n        def r_newtonian(f):\n            return a * (1 - e**2) / (1 + e * np.cos(f))\n            \n        def r_prime(f):\n            return r_newtonian(f) + epsilon\n            \n        def integrand_num_gauge(f):\n            return 1.0 / r_prime(f)\n            \n        def integrand_den_gauge(f):\n            return r_prime(f)**2\n            \n        num_int_gauge, _ = integrate.quad(integrand_num_gauge, 0, 2 * np.pi)\n        den_int_gauge, _ = integrate.quad(integrand_den_gauge, 0, 2 * np.pi)\n        \n        omega_1_gauge = (G / c**2) * K1 * L_N * (num_int_gauge / den_int_gauge)\n        \n        # Step 7: Calculate fractional differences\n        delta_trunc = abs(omega_1_trunc - omega_1_exact) / omega_1_exact\n        delta_gauge = abs(omega_1_gauge - omega_1_exact) / omega_1_exact\n        \n        # Step 8: Store results for the current case\n        case_results = [\n            omega_1_exact, \n            omega_1_trunc, \n            omega_1_gauge, \n            delta_trunc, \n            delta_gauge\n        ]\n        results_all_cases.append(case_results)\n\n    # Format the output string as a list of lists, with comma-separated values\n    # and no spaces within the inner lists, as per the specified format.\n    formatted_cases = []\n    for case in results_all_cases:\n        formatted_cases.append(f\"[{','.join(map(str, case))}]\")\n    \n    final_output = f\"[{','.join(formatted_cases)}]\"\n    print(final_output)\n\nsolve()\n```", "id": "3487478"}]}