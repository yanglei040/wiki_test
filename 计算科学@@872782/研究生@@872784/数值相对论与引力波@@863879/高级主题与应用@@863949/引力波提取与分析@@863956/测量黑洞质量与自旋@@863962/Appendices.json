{"hands_on_practices": [{"introduction": "克里斯托杜罗质量公式是联系克尔黑洞总质量-能量、不可约质量（即其表面积）和转动能（即其自旋）的理论基石。本练习将通过理论推导和算法设计，让你掌握如何根据数值模拟中测得的视界量来计算黑洞的总质量 $M$ 和角动量 $J$ [@problem_id:3479534]，这是分析黑洞性质的一项基本功。", "problem": "给定一个框架，用于从数值相对论（NR）模拟中测量的视界量来推断克尔黑洞的质量和自旋。您的任务有两部分：首先，从克尔几何的基本且经过充分检验的性质出发，推导克尔黑洞的质量-自旋-面积关系；其次，实现一个算法，该算法根据视界面积和角动量测量值，或视界面积和无量纲自旋测量值，计算总质量和角动量。\n\n推导任务：\n- 从克尔黑洞几何在几何单位制（其中 $G=c=1$）下的以下基本事实出发：\n  - 克尔黑洞的外视界半径为 $r_{+} = M + \\sqrt{M^{2} - a^{2}}$，其中 $M$ 是总质量，$a = J/M$ 是自旋参数，$J$ 是角动量。\n  - 视界面积为 $A = 4\\pi (r_{+}^{2} + a^{2}) = 8\\pi M r_{+}$。\n  - 不可约质量定义为 $M_{\\mathrm{irr}} = \\sqrt{A/(16\\pi)}$。\n  - 无量纲自旋为 $\\chi = J/M^{2}$，对于次极端的克尔黑洞，$0 \\le \\chi \\le 1$。\n- 基于上述基本定义和关系，推导出 Christodoulou 质量公式，该公式关联了 $M$、$M_{\\mathrm{irr}}$ 和 $J$，且不引入任何新的假设。您的推导必须从所列的基本事实出发，按部就班地进行，并最终得到一个关于 $M^{2}$、$M_{\\mathrm{irr}}^{2}$ 和 $J^{2}$ 之间关系式。\n\n算法设计任务：\n- 设计一个算法，在给定测量的视界面积 $A$ 以及以下两者之一的情况下：\n  - 测量的角动量大小 $J$，或\n  - 测量的无量纲自旋 $\\chi$，\n  自洽地计算出克尔黑洞的总质量 $M$ 和角动量 $J$。\n- 使用几何单位制（$G=c=1$）。以长度单位表示 $M$，以长度的平方单位表示 $J$。\n- 您的算法必须：\n  1. 通过 $M_{\\mathrm{irr}} = \\sqrt{A/(16\\pi)}$ 从 $A$ 计算出 $M_{\\mathrm{irr}}$。\n  2. 如果提供了 $J$，则直接从推导出的质量-自旋-面积关系计算 $M$。\n  3. 如果提供了 $\\chi$，则使用一个对所有 $0 \\le \\chi \\le 1$（包括边界情况 $\\chi=0$）都数值稳定的表达式来计算 $M$；然后根据 $\\chi$ 和 $M$ 计算 $J$。\n  4. 以与克尔几何一致的方式处理边界情况 $J=0$ 和 $\\chi=0$。\n  5. 返回 $M$ 和 $J$ 的浮点数输出，四舍五入到 $10$ 位小数。\n\n输入和测试套件：\n- 将您的解决方案实现为一个自包含的程序，使用以下测试套件，其中每个测试用例包含一个视界面积和一个自旋测量类型：\n  1. 用例 1（理想情况，直接角动量）：$A = 5026.548245743669$，测量类型 $J$，值 $J = 20.0$。\n  2. 用例 2（中等无量纲自旋）：$A = 7238.229473870883$，测量类型 $\\chi$，值 $\\chi = 0.7$。\n  3. 用例 3（边界情况 $\\chi=0$）：$A = 1256.6370614359173$，测量类型 $\\chi$，值 $\\chi = 0.0$。\n  4. 用例 4（近极端无量纲自旋）：$A = 452.3893421169302$，测量类型 $\\chi$，值 $\\chi = 0.999$。\n- 所有面积均采用几何单位制，并分别对应于 $M_{\\mathrm{irr}}$ 等于 $10$、$12$、$5$ 和 $3$ 时的 $A = 16\\pi M_{\\mathrm{irr}}^{2}$，以确保测试用例的科学一致性。\n\n输出规范：\n- 您的程序应生成一行输出，其中包含用方括号括起来的逗号分隔的结果列表。\n- 列表必须按 $[M_{1},J_{1},M_{2},J_{2},M_{3},J_{3},M_{4},J_{4}]$ 的顺序展平，其中 $M_{k}$ 和 $J_{k}$ 是测试用例 $k$ 的计算值，每个值都四舍五入到 $10$ 位小数。", "solution": "该问题是有效的，因为它在科学上基于广义相对论的原理，特别是克尔度规，并且是适定的，为推导和算法任务提供了完整且一致的信息集。\n\n解决方案按要求分为两部分。首先，从提供的基本关系出发，分步推导 Christodoulou 质量公式。其次，设计并实现一个算法，用于从克尔黑洞的视界面积 $A$ 和一个自旋测量值计算其质量 $M$ 和角动量 $J$。所有计算均在几何单位制（$G=c=1$）中进行。\n\n**第一部分：Christodoulou 质量公式的推导**\n\n目标是推导出一个关联克尔黑洞总质量 $M$、不可约质量 $M_{\\mathrm{irr}}$ 和角动量 $J$ 的公式。推导从以下既定关系开始：\n1. 不可约质量的定义：$M_{\\mathrm{irr}} = \\sqrt{A/(16\\pi)}$，这意味着视界面积为 $A = 16\\pi M_{\\mathrm{irr}}^{2}$。\n2. 视界面积的另一种表达式：$A = 8\\pi M r_{+}$，其中 $r_{+}$ 是外视界半径。\n3. 外视界半径：$r_{+} = M + \\sqrt{M^{2} - a^{2}}$。\n4. 自旋参数：$a = J/M$。\n\n推导过程如下：\n\n首先，我们将关系（1）和（2）中给出的两个视界面积 $A$ 的表达式相等：\n$$16\\pi M_{\\mathrm{irr}}^{2} = 8\\pi M r_{+}$$\n两边同时除以 $8\\pi$，得到不可约质量、总质量和视界半径之间的直接关系：\n$$2 M_{\\mathrm{irr}}^{2} = M r_{+}$$\n\n接下来，我们将关系（3）中 $r_{+}$ 的表达式代入上式：\n$$2 M_{\\mathrm{irr}}^{2} = M (M + \\sqrt{M^{2} - a^{2}})$$\n展开右侧可得：\n$$2 M_{\\mathrm{irr}}^{2} = M^{2} + M \\sqrt{M^{2} - a^{2}}$$\n\n为了消去平方根，我们首先分离出含有平方根的项：\n$$M \\sqrt{M^{2} - a^{2}} = 2 M_{\\mathrm{irr}}^{2} - M^{2}$$\n现在，我们对等式两边进行平方：\n$$(M \\sqrt{M^{2} - a^{2}})^{2} = (2 M_{\\mathrm{irr}}^{2} - M^{2})^{2}$$\n这导致：\n$$M^{2} (M^{2} - a^{2}) = (2 M_{\\mathrm{irr}}^{2})^{2} - 2(2 M_{\\mathrm{irr}}^{2})(M^{2}) + (M^{2})^{2}$$\n$$M^{4} - M^{2} a^{2} = 4 M_{\\mathrm{irr}}^{4} - 4 M_{\\mathrm{irr}}^{2} M^{2} + M^{4}$$\n\n等式两边的 $M^{4}$ 项相互抵消，简化为：\n$$-M^{2} a^{2} = 4 M_{\\mathrm{irr}}^{4} - 4 M_{\\mathrm{irr}}^{2} M^{2}$$\n\n现在我们代入关系（4）中自旋参数的定义 $a = J/M$：\n$$-M^{2} \\left(\\frac{J}{M}\\right)^{2} = 4 M_{\\mathrm{irr}}^{4} - 4 M_{\\mathrm{irr}}^{2} M^{2}$$\n$$-M^{2} \\left(\\frac{J^{2}}{M^{2}}\\right) = 4 M_{\\mathrm{irr}}^{4} - 4 M_{\\mathrm{irr}}^{2} M^{2}$$\n$$-J^{2} = 4 M_{\\mathrm{irr}}^{4} - 4 M_{\\mathrm{irr}}^{2} M^{2}$$\n\n最后，我们重排这个方程，以 $M_{\\mathrm{irr}}^{2}$ 和 $J^{2}$ 来表示 $M^{2}$。这就是 Christodoulou 质量公式：\n$$4 M_{\\mathrm{irr}}^{2} M^{2} = 4 M_{\\mathrm{irr}}^{4} + J^{2}$$\n$$M^{2} = M_{\\mathrm{irr}}^{2} + \\frac{J^{2}}{4 M_{\\mathrm{irr}}^{2}}$$\n这个公式优雅地将旋转黑洞的总质能平方分解为来自其不可约质量（与其表面积相关）的贡献和来自其转动能（与其角动量相关）的贡献。\n\n**第二部分：算法设计**\n\n该算法从给定的视界面积 $A$ 以及 $J$ 的直接测量值或无量纲自旋 $\\chi = J/M^{2}$ 的测量值来计算总质量 $M$ 和角动量 $J$。\n\n对所有情况而言，共同的第一步是从视界面积 $A$ 计算不可约质量 $M_{\\mathrm{irr}}$：\n$$M_{\\mathrm{irr}} = \\sqrt{\\frac{A}{16\\pi}}$$\n\n后续步骤取决于所提供的自旋测量类型。\n\n**情况1：给定视界面积 $A$ 和角动量 $J$。**\n通过 $A$ 计算出 $M_{\\mathrm{irr}}$，并直接给定 $J$，我们可以使用推导出的 Christodoulou 质量公式来求解 $M$：\n$$M = \\sqrt{M_{\\mathrm{irr}}^{2} + \\frac{J^{2}}{4 M_{\\mathrm{irr}}^{2}}}$$\n该表达式对所有非负 $J$ 均有效。如果 $J=0$（史瓦西情况），公式正确地简化为 $M = \\sqrt{M_{\\mathrm{irr}}^{2}} = M_{\\mathrm{irr}}$。计算出的质量 $M$ 和给定的角动量 $J$ 即为输出。\n\n**情况2：给定视界面积 $A$ 和无量纲自旋 $\\chi$。**\n在这种情况下，我们有来自 $A$ 的 $M_{\\mathrm{irr}}$ 和无量纲自旋 $\\chi$。角动量通过 $J = \\chi M^{2}$ 与 $M$ 和 $\\chi$ 相关。我们将其代入 Christodoulou 公式：\n$$M^{2} = M_{\\mathrm{irr}}^{2} + \\frac{(\\chi M^{2})^{2}}{4 M_{\\mathrm{irr}}^{2}} = M_{\\mathrm{irr}}^{2} + \\frac{\\chi^{2} M^{4}}{4 M_{\\mathrm{irr}}^{2}}$$\n整理后得到一个关于 $M^{2}$ 的二次方程：\n$$\\left(\\frac{\\chi^{2}}{4 M_{\\mathrm{irr}}^{2}}\\right)M^{4} - M^{2} + M_{\\mathrm{irr}}^{2} = 0$$\n解这个关于 $M^{2}$ 的二次方程会得到两个可能的解。物理上正确的解是当 $\\chi \\to 0$ 时能够恢复史瓦西极限（$M \\to M_{\\mathrm{irr}}$）的那个解：\n$$M^{2} = 2 M_{\\mathrm{irr}}^{2} \\frac{1 - \\sqrt{1 - \\chi^{2}}}{\\chi^{2}}$$\n然而，当 $\\chi$ 很小时，这个表达式会因灾难性抵消而出现数值不稳定的问题。为了创建一个数值上鲁棒的算法，我们对分子进行有理化：\n$$\\frac{1 - \\sqrt{1 - \\chi^{2}}}{\\chi^{2}} \\times \\frac{1 + \\sqrt{1 - \\chi^{2}}}{1 + \\sqrt{1 - \\chi^{2}}} = \\frac{1 - (1 - \\chi^{2})}{\\chi^{2}(1 + \\sqrt{1 - \\chi^{2}})} = \\frac{1}{1 + \\sqrt{1 - \\chi^{2}}}$$\n这导出了数值上稳定的 $M^{2}$ 表达式：\n$$M^{2} = \\frac{2 M_{\\mathrm{irr}}^{2}}{1 + \\sqrt{1 - \\chi^{2}}}$$\n由此我们计算总质量 $M$：\n$$M = M_{\\mathrm{irr}} \\sqrt{\\frac{2}{1 + \\sqrt{1 - \\chi^{2}}}}$$\n该公式在整个有效范围 $0 \\le \\chi \\le 1$ 内表现良好，包括边界情况 $\\chi=0$（史瓦西）和 $\\chi=1$（极端克尔）。\n\n一旦计算出 $M$，角动量 $J$ 就通过其关于 $\\chi$ 的定义求出：\n$$J = \\chi M^{2}$$\n计算出的 $M$ 和 $J$ 的值即为输出。最终实现将按要求将这些结果四舍五入到 $10$ 位小数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the mass and spin of a Kerr black hole from horizon quantities.\n    \n    This function processes a series of test cases, each providing a horizon area\n    and a spin measurement (either angular momentum J or dimensionless spin chi).\n    It calculates the total mass M and angular momentum J for each case based on\n    the Christodoulou mass formula and prints the aggregated results.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a dictionary specifying the area 'A', the measurement type 'type',\n    # and the measured 'value'.\n    test_cases = [\n        {'A': 5026.548245743669, 'type': 'J', 'value': 20.0},\n        {'A': 7238.229473870883, 'type': 'chi', 'value': 0.7},\n        {'A': 1256.6370614359173, 'type': 'chi', 'value': 0.0},\n        {'A': 452.3893421169302, 'type': 'chi', 'value': 0.999},\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        A = case['A']\n        measurement_type = case['type']\n        value = case['value']\n\n        # Step 1: Compute the irreducible mass from the area A.\n        # The irreducible mass is defined by A = 16 * pi * M_irr^2.\n        M_irr = np.sqrt(A / (16.0 * np.pi))\n\n        M = 0.0\n        J = 0.0\n\n        if measurement_type == 'J':\n            # Case where angular momentum J is given directly.\n            J_val = value\n            \n            # Use the Christodoulou mass formula to find M:\n            # M^2 = M_irr^2 + J^2 / (4 * M_irr^2)\n            # This handles the J=0 case correctly, where M = M_irr.\n            if M_irr == 0:\n                # This case represents a singular state, but for completeness,\n                # if J is also 0, M would be 0. If J > 0, it is unphysical.\n                # Problem constraints ensure M_irr > 0.\n                M = 0.0 if J_val == 0.0 else float('inf')\n            else:\n                M = np.sqrt(M_irr**2 + J_val**2 / (4.0 * M_irr**2))\n            \n            J = J_val\n\n        elif measurement_type == 'chi':\n            # Case where dimensionless spin chi is given.\n            chi_val = value\n\n            # A numerically stable expression for M is used, derived from\n            # M^2 = 2 * M_irr^2 / (1 + sqrt(1 - chi^2)).\n            # This avoids catastrophic cancellation for small chi.\n            # It is well-defined for all 0 = chi = 1.\n            radicand = 1.0 - chi_val**2\n            # Handle potential floating point inaccuracies for chi=1\n            if radicand  0: radicand = 0\n            \n            M = M_irr * np.sqrt(2.0 / (1.0 + np.sqrt(radicand)))\n            \n            # Compute J from the definition chi = J / M^2.\n            J = chi_val * M**2\n\n        # Round results to 10 decimal places as specified.\n        M_rounded = round(M, 10)\n        J_rounded = round(J, 10)\n        \n        results.extend([M_rounded, J_rounded])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "3479534"}, {"introduction": "在动态的、非球对称的强引力场（如黑洞并合）中，各种准局域质量的定义可能会给出不同甚至不可靠的结果。本练习直面这一数值相对论中的实际挑战，要求你设计一个诊断工具，利用更稳健的视界面积 $A$ 和自旋 $J$ 来检验一个给定的准局域质量 $M_{\\mathrm{H}}$ 是否自洽 [@problem_id:3479624]。通过构建此工具，你将学会如何批判性地评估模拟数据的可靠性。", "problem": "您正在为广义相对论的完全三维数值模拟（不假设对称性）构建一个程序化的可靠性诊断工具，用于准局域黑洞质量的测量。在高度动态和非球形的阶段，准局域质量会表现出规范和切片依赖性，使其与从黑洞视界几何推断出的量解耦。您的任务是设计并实现一个独立的诊断工具，该工具仅使用视界面积和自旋测量来检验给定的准局域质量是否与 Kerr 族黑洞相符，并在动态演化过程中标记出可能不可靠的质量估计。\n\n您必须从黑洞力学和静态黑洞理论中经过充分检验的关系式出发：\n\n- 从给定的视界面积和自旋大小推断出一个与 Kerr 黑洞一致的质量，此处表示为 Kerr 一致性质量。除了黑洞力学定律中编码的对称性外，不要假设任何其他对称性。\n- 构建所提供的准局域质量与 Kerr 一致性质量之间的无量纲相对偏差。\n- 使用所提供的准局域质量和视界几何，为质量-自旋-面积关系构建一个无量纲残差。\n- 构建一个极端性比率，用于检验自旋和面积是否满足与次极端黑洞相关的不等式。\n- 将这些组合成一个布尔型的可靠性标志，仅当所有一致性检查都在指定容差范围内时才返回真。\n\n您必须在几何单位制下工作，其中引力常数和光速设为1，即 $G=c=1$，因此质量、长度和角动量在这些单位中是无量纲的。您程序的所有输出都必须是无量纲的。您的算法不得依赖输入数据编码之外的任何对称性假设，并且必须普遍适用于任何光滑且非简并的视界数据。\n\n从第一性原理定义以下诊断量：\n\n- 一个仅依赖于视界面积 $A$ 和自旋大小 $J$ 的 Kerr 一致性质量 $M_{\\mathrm{Kerr}}$。\n- 一个相对质量偏差 $\\delta_{M}$，定义为所提供的准局域质量 $M_{\\mathrm{H}}$ 与 $M_{\\mathrm{Kerr}}$ 之间的差，并由 $M_{\\mathrm{Kerr}}$ 归一化。\n- 质量-自旋-面积关系的一个无量纲残差 $r_{\\mathrm{norm}}$，由一个适当的 Kerr 一致性质量标度进行归一化，以使 $r_{\\mathrm{norm}}$ 无单位。\n- 一个仅依赖于 $A$ 和 $J$ 的极端性比率 $\\varepsilon$，对于次极端黑洞，该比率不得超过1。\n\n使用以下具有固定容差的可靠性决策规则：准局域质量是可靠的，当且仅当\n- 绝对相对质量偏差满足 $\\lvert \\delta_{M} \\rvert \\le \\tau_{M}$，\n- 绝对归一化残差满足 $\\lvert r_{\\mathrm{norm}} \\rvert \\le \\tau_{r}$，\n- 且极端性比率满足 $\\varepsilon \\le 1 + \\tau_{e}$，\n容差为 $\\tau_{M}=0.02$，$\\tau_{r}=0.02$ 和 $\\tau_{e}=0.001$。\n\n您的程序必须从黑洞力学的基础出发实现这些诊断，不使用任何外部数据。将您的实现应用于以下视界测量的测试套件，每个测量值均以三元组 $(A,J,M_{\\mathrm{H}})$ 的形式给出：\n\n- 案例 $1$（类静态，中等自旋）：$A=43.08110859803532$, $J=0.7$, $M_{\\mathrm{H}}=1.0$。\n- 案例 $2$（近极端，质量中存在小的建模误差）：$A=28.67824906701301$, $J=0.99$, $M_{\\mathrm{H}}=1.005$。\n- 案例 $3$（不一致的质量）：$A=46.89833316054006$, $J=0.5$, $M_{\\mathrm{H}}=1.3$。\n- 案例 $4$（数据中违反极端性不等式）：$A=21.488493750554183$, $J=0.9$, $M_{\\mathrm{H}}=1.0$。\n- 案例 $5$（类 Schwarzschild，质量略有低估）：$A=50.26548245743669$, $J=0.0$, $M_{\\mathrm{H}}=0.99$。\n\n对于每个案例，您的程序必须按以下顺序输出一个包含四个条目的列表：$[\\delta_{M}, r_{\\mathrm{norm}}, \\varepsilon, \\text{reliable}]$，其中 $\\text{reliable}$ 是一个布尔值。最终输出必须是包含这些按案例排列的列表的单行列表，不含其他文本。例如，整体输出应具有以下形式：\n$[[\\delta_{M}^{(1)}, r_{\\mathrm{norm}}^{(1)}, \\varepsilon^{(1)}, \\text{reliable}^{(1)}],\\ldots,[\\delta_{M}^{(5)}, r_{\\mathrm{norm}}^{(5)}, \\varepsilon^{(5)}, \\text{reliable}^{(5)}]]$。\n\n此问题中不出现角度，因此不需要角度单位。所有数值答案在几何单位制 $G=c=1$ 中都是无量纲的。", "solution": "该问题陈述被评估为具有科学依据、问题明确且客观。为得出唯一解提供了所有必要的数据和定义，其基础物理学基于广义相对论中关于 Kerr 黑洞的标准、公认原理。该问题有效。\n\n目标是创建一个诊断工具，用于在给定黑洞的事件视界面积 $A$ 和其自旋角动量大小 $J$ 的情况下，评估黑洞准局域质量测量值 $M_{\\mathrm{H}}$ 的可靠性。该诊断基于这些测量值与广义相对论中 Kerr 族黑洞解的性质的一致性。我们在几何单位制下操作，其中引力常数 $G$ 和光速 $c$ 设为1，即 $G=c=1$。\n\n对于 Kerr 黑洞，连接质量 $M$、自旋大小 $J$ 和视界面积 $A$ 的基本关系从其几何结构中导出。面积由 $A = 4\\pi (r_+^2 + a^2)$ 给出，其中 $r_+ = M + \\sqrt{M^2 - a^2}$ 是外事件视界的半径，而 $a=J/M$ 是自旋参数。这个关系式的一个更直接的形式，通常称为 Christodoulou-Ruffini 质量公式，用不可约质量 $M_{\\mathrm{irr}} = \\sqrt{A/(16\\pi)}$ 和自旋 $J$ 来表示质量的平方：\n$$\nM^2 = M_{\\mathrm{irr}}^2 + \\frac{J^2}{4M_{\\mathrm{irr}}^2}\n$$\n代入 $M_{\\mathrm{irr}}$ 的表达式，得到质量-自旋-面积关系式：\n$$\nM^2 = \\frac{A}{16\\pi} + \\frac{4\\pi J^2}{A}\n$$\n该方程构成了我们诊断的理论基础。\n\n我们现在定义所需的四个诊断量。\n\n1.  **Kerr 一致性质量, $M_{\\mathrm{Kerr}}$**：这是一个黑洞如果是一个具有给定视界面积 $A$ 和自旋 $J$ 的 Kerr 黑洞时*应该*具有的质量。我们可以通过求解质量-自旋-面积关系式来找到这个质量 $M$。我们将其表示为 $M_{\\mathrm{Kerr}}$：\n    $$\n    M_{\\mathrm{Kerr}}(A, J) = \\sqrt{\\frac{A}{16\\pi} + \\frac{4\\pi J^2}{A}}\n    $$\n    只要 $A > 0$，这个量就是明确定义的。\n\n2.  **相对质量偏差, $\\delta_{M}$**：这个无量纲量测量了所提供的准局域质量 $M_{\\mathrm{H}}$ 与 Kerr 一致性质量 $M_{\\mathrm{Kerr}}$ 之间的相对差异。其定义为：\n    $$\n    \\delta_{M} = \\frac{M_{\\mathrm{H}} - M_{\\mathrm{Kerr}}}{M_{\\mathrm{Kerr}}} = \\frac{M_{\\mathrm{H}}}{M_{\\mathrm{Kerr}}} - 1\n    $$\n    接近于 0 的 $\\delta_{M}$ 值表明在 Kerr 假设下，测量质量与从视界几何推断出的质量之间有很好的一致性。\n\n3.  **无量纲残差, $r_{\\mathrm{norm}}$**：此诊断量化了测量到的三元组 $(A, J, M_{\\mathrm{H}})$ 满足 Kerr 质量-自旋-面积关系式的程度。该关系式的残差 $r$ 为：\n    $$\n    r = M_{\\mathrm{H}}^2 - \\left(\\frac{A}{16\\pi} + \\frac{4\\pi J^2}{A}\\right)\n    $$\n    使用 $M_{\\mathrm{Kerr}}$ 的定义，这变为 $r = M_{\\mathrm{H}}^2 - M_{\\mathrm{Kerr}}^2$。为了使其无量纲化，我们用一个特征质量标度的平方来归一化它。自然的选择是 $M_{\\mathrm{Kerr}}^2$：\n    $$\n    r_{\\mathrm{norm}} = \\frac{M_{\\mathrm{H}}^2 - M_{\\mathrm{Kerr}}^2}{M_{\\mathrm{Kerr}}^2} = \\left(\\frac{M_{\\mathrm{H}}}{M_{\\mathrm{Kerr}}}\\right)^2 - 1\n    $$\n    对于 $\\delta_M \\ll 1$ 的小偏差，我们注意到 $r_{\\mathrm{norm}} = (1+\\delta_M)^2 - 1 \\approx 2\\delta_M$。\n\n4.  **极端性比率, $\\varepsilon$**：一个物理黑洞不能是裸奇点，这个条件被宇宙监督假设所概括。对于 Kerr 黑洞，这意味着自旋参数 $a$ 不能超过质量 $M$，即 $|a| \\le M$，这可以转化为 $M^2 \\ge |J|$。为了仅使用可测量量 $A$ 和 $|J|$ 来表示此条件，我们可以找到给定面积下允许的最大自旋。这个最大值出现在极端情况下（$M^2=|J|$），此时视界面积为 $A = 8\\pi M^2 = 8\\pi |J|$。这导致了对于任何次极端黑洞的不等式：\n    $$\n    A \\ge 8\\pi |J|\n    $$\n    我们可以基于这个不等式定义一个无量纲的极端性比率 $\\varepsilon$：\n    $$\n    \\varepsilon = \\frac{8\\pi |J|}{A}\n    $$\n    对于一个物理的（次极端的或极端的）Kerr 黑洞，该比率必须满足 $\\varepsilon \\le 1$。大于 1 的值表示违反了极端性界限，表明输入数据 $(A, J)$ 与任何黑洞解都不一致。\n\n最后，我们根据指定的容差构建可靠性标志。准局域质量 $M_{\\mathrm{H}}$ 的测量被认为是可靠的，当且仅当以下所有三个条件都得到满足：\n- 绝对相对质量偏差在其容差范围内：$|\\delta_{M}| \\le \\tau_{M}$，其中 $\\tau_{M} = 0.02$。\n- 绝对归一化残差在其容差范围内：$|r_{\\mathrm{norm}}| \\le \\tau_{r}$，其中 $\\tau_{r} = 0.02$。\n- 极端性比率得到遵守，并允许一个小的数值误差容差：$\\varepsilon \\le 1 + \\tau_{e}$，其中 $\\tau_{e} = 0.001$。\n\n该算法包括为每个输入集 $(A, J, M_{\\mathrm{H}})$ 计算这四个量（$M_{\\mathrm{Kerr}}$、$\\delta_{M}$、$r_{\\mathrm{norm}}$、$\\varepsilon$），然后基于这些条件评估布尔型的可靠性标志。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes black hole diagnostic quantities and reliability flags for a set of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement as tuples of (A, J, M_H).\n    test_cases = [\n        (43.08110859803532, 0.7, 1.0),       # Case 1\n        (28.67824906701301, 0.99, 1.005),    # Case 2\n        (46.89833316054006, 0.5, 1.3),       # Case 3\n        (21.488493750554183, 0.9, 1.0),      # Case 4\n        (50.26548245743669, 0.0, 0.99),      # Case 5\n    ]\n\n    # Define the tolerances for the reliability checks.\n    tau_M = 0.02\n    tau_r = 0.02\n    tau_e = 0.001\n\n    results = []\n    \n    for case in test_cases:\n        A, J, M_H = case\n\n        # 1. Calculate the Kerr-consistent mass, M_Kerr.\n        # The mass-spin-area relation is M^2 = A/(16*pi) + (4*pi*J^2)/A.\n        # We need to handle the case A==0, though it is not present in the tests.\n        if A == 0:\n            # Physically unrealistic, results would be undefined.\n            # For robustness, we could flag this as an error. Here we assume A > 0.\n            # Using nan for undefined results to signal invalid input.\n            M_Kerr = np.nan\n        else:\n            M_Kerr_sq = A / (16 * np.pi) + (4 * np.pi * J**2) / A\n            M_Kerr = np.sqrt(M_Kerr_sq)\n\n        # 2. Calculate the relative mass discrepancy, delta_M.\n        if M_Kerr == 0:\n            delta_M = np.inf if M_H > 0 else 0.0\n        else:\n            delta_M = (M_H / M_Kerr) - 1\n\n        # 3. Calculate the dimensionless residual, r_norm.\n        if M_Kerr == 0:\n            r_norm = np.inf if M_H > 0 else 0.0\n        else:\n            r_norm = (M_H / M_Kerr)**2 - 1\n            \n        # 4. Calculate the extremality ratio, epsilon.\n        # The condition for a sub-extremal black hole is A >= 8*pi*|J|.\n        if A == 0:\n            epsilon = np.inf\n        else:\n            epsilon = (8 * np.pi * abs(J)) / A\n\n        # 5. Combine diagnostics into a final reliability flag.\n        is_reliable = (abs(delta_M) = tau_M) and \\\n                      (abs(r_norm) = tau_r) and \\\n                      (epsilon = 1 + tau_e)\n        \n        # Append the list of results for this case.\n        results.append([delta_M, r_norm, epsilon, is_reliable])\n\n    # Format the final output string to match the required format:\n    # A list of lists, with no spaces.\n    # e.g., [[val1,val2,val3,True],[val4,val5,val6,False]]\n    inner_list_strings = []\n    for res in results:\n        # res is a list: [float, float, float, bool]\n        # str(bool) gives 'True' or 'False'\n        inner_str = f\"[{res[0]},{res[1]},{res[2]},{str(res[3])}]\"\n        inner_list_strings.append(inner_str)\n    \n    final_output_string = f\"[{','.join(inner_list_strings)}]\"\n    \n    print(final_output_string)\n\nsolve()\n```", "id": "3479624"}, {"introduction": "黑洞并合的最终阶段——“铃振”（ringdown），会辐射出特征引力波，其频率和阻尼时间由最终黑洞的质量 $M_f$ 和自旋 $\\chi_f$ 唯一确定。本练习模拟了天体物理学家从引力波信号中推断这些参数的过程，并让你着手处理一个关键的系统误差来源：在无穷远处（通过柯西特征提取，CCE）和在有限半径处提取的波形之间的差异 [@problem_id:3479619]。这让你能亲身体会从模拟波形到物理参数推断的全过程，并理解其中的微妙之处。", "problem": "您将获得两组来自数值相对论 (NR) 模拟的黑洞并合铃振测量数据：一组通过柯西特征提取 (CCE) 获得，另一组通过对有限半径提取结果进行 $1/r$ 多项式外插获得。目标是从主导的 $l=m=2$, $n=0$ 准正规模铃振中推断残骸（最终）黑洞的质量 $M_f$ 和无量纲自旋 $\\chi_f$，并分离出由近区污染引入的系统性偏差，该偏差影响的是相对于 CCE 的有限半径外插波形。您必须实现一个使用黑洞微扰理论中经过充分检验的关系式的推断算法，并将其一致地应用于 CCE 和有限半径外插测量数据。\n\n推断的基本依据：\n- 在克尔黑洞的线性铃振阶段，复准正规模频率与质量成反比，即 $\\omega \\propto 1/M_f$，比例系数由自旋 $\\chi_f$ 的无量纲函数决定。观测到的铃振频率 $f$ 和阻尼时间 $\\tau$ 通过 $Q = \\omega_R \\tau / 2 = \\pi f \\tau$ 定义了品质因子 $Q$，其中 $\\omega_R = 2\\pi f$ 是角频率的实部。引力波测量的频率 $f$ 单位假定为赫兹（Hertz），时间 $\\tau$ 单位为秒（seconds）。\n- 主导模式的无量纲频率和品质因子可以通过广泛使用、文献验证的经验拟合（已确立的事实）得到很好的近似，这些拟合将无量纲量与自旋 $\\chi_f$ 联系起来。这些拟合与标度不变性 $\\omega \\sim \\hat{\\omega}(\\chi_f) / M_f$ 相结合，使得可以从 $Q$ 推断出 $\\chi_f$，然后从 $f$ 和 $\\chi_f$ 推断出 $M_f$。物理单位转换使用 $M = G M_f / c^3$ 将质量转换为时间单位，其中 $G$ 是引力常数，$c$ 是光速。\n\n您的任务：\n1. 对下面的每个测试用例，计算：\n   - 从 CCE：根据测量的 $(f_{\\mathrm{CCE}}, \\tau_{\\mathrm{CCE}})$ 推断 $M_f$（以太阳质量 $M_\\odot$ 为单位）和 $\\chi_f$。\n   - 从有限半径外插波形：根据测量的 $(f_{\\mathrm{EXT}}, \\tau_{\\mathrm{EXT}})$ 推断 $M_f$（以 $M_\\odot$ 为单位）和 $\\chi_f$。\n2. 通过报告每个测试用例的以下数据对，分离近区污染的系统性影响：\n   - $\\Delta M = M_{f,\\mathrm{EXT}} - M_{f,\\mathrm{CCE}}$（以 $M_\\odot$ 为单位），\n   - $\\Delta \\chi = \\chi_{f,\\mathrm{EXT}} - \\chi_{f,\\mathrm{CCE}}$（无量纲）。\n3. 不要使用任何外部数据文件或输入。将下面的测试组数值硬编码。质量差异以太阳质量表示，自旋差异以无量纲小数表示。本问题不涉及角度。所有输出必须是不含单位的纯数字。\n\n测试组（每个案例提供真实参考值 $(M_f^{\\mathrm{true}}, \\chi_f^{\\mathrm{true}})$作为背景，CCE 测量值 $(f_{\\mathrm{CCE}}, \\tau_{\\mathrm{CCE}})$，以及有限半径外插测量值 $(f_{\\mathrm{EXT}}, \\tau_{\\mathrm{EXT}})$）：\n- 案例 A (一般情况): $(M_f^{\\mathrm{true}}, \\chi_f^{\\mathrm{true}}) = (60, 0.7)$, CCE: $f_{\\mathrm{CCE}} = 288.2 \\ \\mathrm{Hz}$, $\\tau_{\\mathrm{CCE}} = 0.003630 \\ \\mathrm{s}$; 外插值: $f_{\\mathrm{EXT}} = 289.64 \\ \\mathrm{Hz}$, $\\tau_{\\mathrm{EXT}} = 0.003594 \\ \\mathrm{s}$。\n- 案例 B (近极值自旋): $(M_f^{\\mathrm{true}}, \\chi_f^{\\mathrm{true}}) = (50, 0.98)$, CCE: $f_{\\mathrm{CCE}} = 534.6 \\ \\mathrm{Hz}$, $\\tau_{\\mathrm{CCE}} = 0.006360 \\ \\mathrm{s}$; 外插值: $f_{\\mathrm{EXT}} = 532.46 \\ \\mathrm{Hz}$, $\\tau_{\\mathrm{EXT}} = 0.006454 \\ \\mathrm{s}$。\n- 案例 C (低自旋): $(M_f^{\\mathrm{true}}, \\chi_f^{\\mathrm{true}}) = (30, 0.1)$, CCE: $f_{\\mathrm{CCE}} = 413.9 \\ \\mathrm{Hz}$, $\\tau_{\\mathrm{CCE}} = 0.001689 \\ \\mathrm{s}$; 外插值: $f_{\\mathrm{EXT}} = 417.21 \\ \\mathrm{Hz}$, $\\tau_{\\mathrm{EXT}} = 0.001681 \\ \\mathrm{s}$。\n- 案例 D (极大质量): $(M_f^{\\mathrm{true}}, \\chi_f^{\\mathrm{true}}) = (200, 0.8)$, CCE: $f_{\\mathrm{CCE}} = 94.70 \\ \\mathrm{Hz}$, $\\tau_{\\mathrm{CCE}} = 0.01300 \\ \\mathrm{s}$; 外插值: $f_{\\mathrm{EXT}} = 96.59 \\ \\mathrm{Hz}$, $\\tau_{\\mathrm{EXT}} = 0.01339 \\ \\mathrm{s}$。\n- 案例 E (无污染控制): $(M_f^{\\mathrm{true}}, \\chi_f^{\\mathrm{true}}) = (70, 0.5)$, CCE: $f_{\\mathrm{CCE}} = 215.6 \\ \\mathrm{Hz}$, $\\tau_{\\mathrm{CCE}} = 0.003987 \\ \\mathrm{s}$; 外插值: $f_{\\mathrm{EXT}} = 215.6 \\ \\mathrm{Hz}$, $\\tau_{\\mathrm{EXT}} = 0.003987 \\ \\mathrm{s}$。\n\n要求的最终输出格式：\n- 您的程序应生成单行输出，其中包含一个列表的列表，每个内部列表对应一个测试用例，顺序为 A、B、C、D、E。每个内部列表必须是 $[\\Delta M,\\Delta \\chi]$ 的形式，其中 $\\Delta M$ 以 $M_\\odot$ 为单位，$\\Delta \\chi$ 是无量纲的。例如：$[[\\Delta M_A,\\Delta \\chi_A],[\\Delta M_B,\\Delta \\chi_B],\\ldots]$。\n- 您的程序必须精确打印一行，仅包含此列表。使用十进制表示法（无百分号）。\n\n科学真实性：主导准正规模的经验关系是已知的、经过充分检验的，并根据克尔微扰的性质要求随总质量进行缩放。所提供的测量值在实际舍入误差范围内与这些关系一致。CCE 与有限半径外插测量值之间的比较，将近区污染分离为系统性偏差的来源，这与数值相对论和引力波数据分析中的实践相符。\n\n角度单位：不适用。所有输出均为标量；当涉及单位时，已在上方明确说明。\n\n所有质量差异均以 $M_\\odot$ 表示，所有自旋差异均以无量纲小数表示。", "solution": "所述问题是有效的。它在科学上基于广义相对论的原理，特别是黑洞准正规模 (QNM) 理论，并与数值相对论和引力波天文学的当代研究直接相关。该问题是适定的，提供了一套完整的可测量量（$f$, $\\tau$），利用已确立的理论和经验关系，可以从中唯一地确定所需的物理参数（$M_f$, $\\chi_f$）。数据的内部一致性和场景的物理真实性都是可靠的。任务是实现一个标准的推断算法，这需要识别并应用广为接受的 QNM 特性经验公式。对于该领域的问题来说，这是一个合理的要求。\n\n解决方案首先建立理论框架，然后在此基础上设计算法。\n\n**1. 理论基础**\n\n双黑洞并合的最后阶段是铃振，在此阶段，新形成的、扭曲的克尔黑洞通过辐射引力波而稳定到其最终状态。根据无毛定理，一个四维时空中的静态、不带电的孤立黑洞完全由其质量 $M_f$ 和无量纲自旋参数 $\\chi_f = J_f c / (G M_f^2)$ 描述，其中 $J_f$ 是其角动量。\n\n铃振期间的引力辐射可以分解为准正规模的叠加，每个模式都有一个特征复角频率 $\\omega_{\\ell m n} = \\omega_R + i \\omega_I$。实部 $\\omega_R$ 对应于波的振荡频率，而虚部 $\\omega_I$ 决定了指数阻尼时间。由于爱因斯坦场方程的标度不变性，这些频率与黑洞质量成反比。对于由 $(\\ell, m, n)$ 索引的给定模式，无量纲频率 $\\hat{\\omega}_{\\ell m n} = M \\omega_{\\ell m n}$ 仅是自旋 $\\chi_f$ 的函数，其中 $M$ 是几何单位下的质量（$M = G M_f / c^3$）。\n\n该问题集中于主导模式，对于大多数并合构型而言，这是 $\\ell=m=2$, $n=0$ 模式。可观测量是引力波频率 $f$ 和阻尼时间 $\\tau$，它们通过以下方式与复 QNM 频率相关：\n$$ f = \\frac{\\omega_R}{2\\pi}, \\quad \\tau = -\\frac{1}{\\omega_I} = \\frac{1}{|\\omega_I|} $$\n由此，我们定义品质因子 $Q$：\n$$ Q = \\frac{\\omega_R \\tau}{2} = \\pi f \\tau $$\n与无量纲频率一样，给定模式的品质因子 $Q$ 也仅是自旋 $\\chi_f$ 的函数。\n\n**2. 推断方法**\n\n$M_f$ 和 $\\chi_f$ 的推断依赖于精确的、经文献验证的经验公式，这些公式近似了 $(2,2,0)$ 模式的 $\\hat{\\omega}_R(\\chi_f)$ 和 $Q(\\chi_f)$ 关系。我们将使用 Berti、Cardoso 和 Will (Phys. Rev. D 73, 064030, 2006) 提供的拟合函数，这些函数是该领域的标准。\n\n品质因子 $Q$ 的拟合函数是：\n$$ Q(\\chi_f) = q_1 + q_2 (1 - \\chi_f)^{q_3} $$\n系数为 $q_1 = 0.7000$, $q_2 = 1.4187$, $q_3 = -0.4990$。\n\n无量纲实角频率 $\\hat{\\omega}_R = M \\omega_R$ 的拟合函数是：\n$$ \\hat{\\omega}_R(\\chi_f) = f_1 + f_2 (1 - \\chi_f)^{f_3} $$\n系数为 $f_1 = 1.5251$, $f_2 = -1.1568$, $f_3 = 0.1292$。\n\n对于给定的测量对 $(f, \\tau)$，推断算法是一个两步过程：\n\n**步骤 A：推断自旋 $\\chi_f$**\n首先，计算测得的品质因子 $Q_{meas} = \\pi f \\tau$。然后，反转拟合函数 $Q(\\chi_f)$ 来求解 $\\chi_f$：\n$$ Q_{meas} = q_1 + q_2 (1 - \\chi_f)^{q_3} $$\n$$ \\implies \\chi_f = 1 - \\left( \\frac{Q_{meas} - q_1}{q_2} \\right)^{1/q_3} $$\n\n**步骤 B：推断质量 $M_f$**\n利用推断出的自旋 $\\chi_f$，使用其拟合函数计算相应的无量纲角频率 $\\hat{\\omega}_R(\\chi_f)$。然后，从质量缩放关系 $\\omega_R = \\hat{\\omega}_R(\\chi_f)/M$ 中，我们求解以秒为单位的质量 $M$：\n$$ M[\\mathrm{s}] = \\frac{\\hat{\\omega}_R(\\chi_f)}{\\omega_R} = \\frac{\\hat{\\omega}_R(\\chi_f)}{2\\pi f} $$\n为了将这个以秒为单位的质量转换为常规的太阳质量单位（$M_\\odot$），我们使用转换因子 $M_{\\odot,\\mathrm{s}} = G M_\\odot / c^3$，其中 $G$ 是引力常数，$c$ 是光速。\n$$ M_f[M_\\odot] = \\frac{M[\\mathrm{s}]}{M_{\\odot,\\mathrm{s}}} = \\frac{M[\\mathrm{s}] c^3}{G M_\\odot} $$\n\n**3. 系统性偏差计算**\n\n此程序独立地应用于来自柯西特征提取的测量值 $(f_{\\mathrm{CCE}}, \\tau_{\\mathrm{CCE}})$ 和来自有限半径外插的测量值 $(f_{\\mathrm{EXT}}, \\tau_{\\mathrm{EXT}})$，从而产生两组推断参数：$(M_{f,\\mathrm{CCE}}, \\chi_{f,\\mathrm{CCE}})$ 和 $(M_{f,\\mathrm{EXT}}, \\chi_{f,\\mathrm{EXT}})$。CCE 被认为是“金标准”，因为它提供了未来零无穷远处的波形，不受近区污染的影响。有限半径外插方法容易受到残余近区效应的影响。由这些效应引入的系统性偏差通过以下差异进行量化：\n$$ \\Delta M = M_{f,\\mathrm{EXT}} - M_{f,\\mathrm{CCE}} $$\n$$ \\Delta \\chi = \\chi_{f,\\mathrm{EXT}} - \\chi_{f,\\mathrm{CCE}} $$\n\n对于问题陈述中提供的每个测试用例，都执行这整个程序。对于案例 E，CCE 和 EXT 的测量值相同，正确地得出零系统性偏差，这可作为实现的一致性检查。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.constants import G, c\n\ndef solve():\n    \"\"\"\n    Solves for the mass and spin differences between two ringdown measurement methods.\n    \"\"\"\n    # Define physical and conversion constants.\n    # Solar mass in kilograms.\n    M_SOLAR_KG = 1.98847e30\n    # Conversion factor from solar masses to seconds (geometric units).\n    M_SOLAR_IN_SECONDS = (G * M_SOLAR_KG) / (c**3)\n    \n    # Empirical fit parameters for the l=m=2, n=0 quasinormal mode,\n    # from Berti, Cardoso, and Will (2006).\n    # Fit for dimensionless angular frequency: M * omega_R = f1 + f2*(1-chi)^f3\n    F_FIT_PARAMS = {'f1': 1.5251, 'f2': -1.1568, 'f3': 0.1292}\n    # Fit for quality factor: Q = q1 + q2*(1-chi)^q3\n    Q_FIT_PARAMS = {'q1': 0.7000, 'q2': 1.4187, 'q3': -0.4990}\n\n    def infer_remnant_properties(f, tau, q_params, f_params):\n        \"\"\"\n        Infers remnant mass (in M_solar) and spin (dimensionless) from\n        the measured frequency (f) and damping time (tau) of a ringdown signal.\n        \n        Args:\n            f (float): Measured frequency in Hz.\n            tau (float): Measured damping time in seconds.\n            q_params (dict): Parameters for the Q(chi) fit.\n            f_params (dict): Parameters for the omega_R(chi) fit.\n            \n        Returns:\n            tuple: A tuple containing (inferred_mass, inferred_spin).\n        \"\"\"\n        # A frequency or damping time of zero is unphysical and would lead to errors.\n        if f == 0 or tau == 0:\n            return (0.0, 0.0)\n            \n        # Step 1: Calculate the measured quality factor Q.\n        q_meas = np.pi * f * tau\n        \n        # Step 2: Invert the Q(chi) relation to find the spin, chi.\n        q1, q2, q3 = q_params['q1'], q_params['q2'], q_params['q3']\n        # The base of the power must be positive, which holds for the given data\n        # as the Q values are within the fit's domain of validity.\n        base = (q_meas - q1) / q2\n        chi = 1.0 - base**(1.0 / q3)\n        \n        # Clamp chi to the physical range [0, 1) for robustness.\n        chi = np.clip(chi, 0.0, 1.0 - 1e-9)\n\n        # Step 3: Use the inferred chi to find the dimensionless frequency.\n        f1, f2, f3 = f_params['f1'], f_params['f2'], f_params['f3']\n        omega_hat_r = f1 + f2 * (1.0 - chi)**f3\n        \n        # Step 4: Use the mass-scaling relation to find the mass in seconds.\n        m_sec = omega_hat_r / (2.0 * np.pi * f)\n        \n        # Step 5: Convert mass from seconds to solar masses.\n        m_solar = m_sec / M_SOLAR_IN_SECONDS\n        \n        return m_solar, chi\n\n    # Test suite data as provided in the problem description.\n    test_cases = [\n        # Case A: CCE(f, tau), Extrapolated(f, tau)\n        {'cce': (288.2, 0.003630), 'ext': (289.64, 0.003594)},\n        # Case B\n        {'cce': (534.6, 0.006360), 'ext': (532.46, 0.006454)},\n        # Case C\n        {'cce': (413.9, 0.001689), 'ext': (417.21, 0.001681)},\n        # Case D\n        {'cce': (94.70, 0.01300), 'ext': (96.59, 0.01339)},\n        # Case E\n        {'cce': (215.6, 0.003987), 'ext': (215.6, 0.003987)},\n    ]\n\n    results = []\n    for case in test_cases:\n        # Infer properties from CCE measurements\n        f_cce, tau_cce = case['cce']\n        m_cce, chi_cce = infer_remnant_properties(f_cce, tau_cce, Q_FIT_PARAMS, F_FIT_PARAMS)\n        \n        # Infer properties from extrapolated measurements\n        f_ext, tau_ext = case['ext']\n        m_ext, chi_ext = infer_remnant_properties(f_ext, tau_ext, Q_FIT_PARAMS, F_FIT_PARAMS)\n\n        # Calculate the systematic differences\n        delta_m = m_ext - m_cce\n        delta_chi = chi_ext - chi_cce\n        \n        results.append([delta_m, delta_chi])\n\n    # Format the final output string as a list of lists.\n    # e.g., [[val1,val2],[val3,val4],...]\n    output_str = f\"[{','.join([f'[{dm},{dc}]' for dm, dc in results])}]\"\n    \n    # Final print statement in the exact required format.\n    print(output_str)\n\nsolve()\n```", "id": "3479619"}]}