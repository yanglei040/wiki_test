{"hands_on_practices": [{"introduction": "这项实践是连接测地线和测地偏离的抽象理论与具体数值实现的桥梁。通过从给定的度规（Brinkmann 坐标系下的平面引力波）出发，亲手推导运动方程，你将掌握将广义相对论的几何语言转化为一组可计算的常微分方程（ODEs）的核心技能。这项练习不仅能让你实现一个数值积分器，还能通过比较两条邻近测地线的实际分离与测地偏离方程的预测，来验证测地偏离方程作为描述邻近自由下落粒子相对运动的精确线性近似的有效性 [@problem_id:3492025]。", "problem": "必须编写一个程序，对以 Brinkmann 坐标表示的平面引力波时空，进行测地线方程和测地偏离方程的数值积分。时空线元为\n$$\nds^2 = -2\\,du\\,dv + dx^2 + dy^2 + g_{uu}(u,x,y)\\,du^2,\n$$\n其中\n$$\ng_{uu}(u,x,y) = H(u)\\,(x^2 - y^2).\n$$\n此处，$u$ 是沿类光测地线的仿射参数，$v$ 是共轭零坐标，而 $(x,y)$ 是横向空间坐标。平面波剖面由以下函数指定\n$$\nH(u) = A\\,\\exp\\!\\left(-\\frac{(u-u_0)^2}{2\\,\\sigma^2}\\right)\\,\\cos\\!\\left(\\omega\\,(u-u_0)\\right),\n$$\n其中 $A$ 是振幅，$\\omega$ 是角频率，$\\sigma$ 是高斯包络的宽度，$u_0$ 是脉冲中心。角度必须以弧度为单位进行解释。\n\n从以下基本依据出发：\n- 测地线方程，\n$$\n\\frac{d^2 x^\\mu}{d\\lambda^2} + \\Gamma^\\mu_{\\ \\alpha\\beta}\\,\\frac{d x^\\alpha}{d\\lambda}\\,\\frac{d x^\\beta}{d\\lambda} = 0,\n$$\n- Christoffel 符号通过度规 $g_{\\mu\\nu}$ 的定义，\n$$\n\\Gamma^\\mu_{\\ \\alpha\\beta} = \\frac{1}{2} g^{\\mu\\gamma}\\left( \\partial_\\alpha g_{\\beta\\gamma} + \\partial_\\beta g_{\\alpha\\gamma} - \\partial_\\gamma g_{\\alpha\\beta} \\right),\n$$\n- 沿切矢为 $u^\\mu$ 的参考测地线的偏离矢量 $\\xi^\\mu$ 的测地偏离方程，\n$$\n\\frac{D^2 \\xi^\\mu}{d\\lambda^2} = - R^\\mu_{\\ \\nu\\rho\\sigma}\\,u^\\nu\\,\\xi^\\rho\\,u^\\sigma,\n$$\n推导当选择仿射参数 $\\lambda$ 等于 $u$ 时，测地线的横向坐标 $x(u)$ 和 $y(u)$ 的常微分方程 (ODE)，并推导沿同一参考测地线的偏离矢量横向分量 $\\xi^x(u)$ 和 $\\xi^y(u)$ 的常微分方程。所有量都是无量纲的，不涉及物理单位。\n\n用 Python 实现一个数值求解器，该求解器：\n1. 積分一条具有以下初始条件的参考测地线\n$$\nu_{\\mathrm{start}} = 0,\\quad u_{\\mathrm{end}} = 2,\\quad x(0) = x_0,\\quad y(0) = y_0,\\quad \\frac{dx}{du}(0) = v_{x0},\\quad \\frac{dy}{du}(0) = v_{y0}.\n$$\n2. 积分一条具有以下初始条件的相邻测地线\n$$\nx(0) = x_0 + \\delta x_0,\\quad y(0) = y_0 + \\delta y_0,\\quad \\frac{dx}{du}(0) = v_{x0},\\quad \\frac{dy}{du}(0) = v_{y0}.\n$$\n3. 积分具有以下初始条件的横向偏离矢量的测地偏离方程\n$$\n\\xi^x(0) = \\delta x_0,\\quad \\xi^y(0) = \\delta y_0,\\quad \\frac{d\\xi^x}{du}(0) = 0,\\quad \\frac{d\\xi^y}{du}(0) = 0.\n$$\n\n对所有测试用例，使用以下通用初始值\n$$\nx_0 = 0.1,\\quad y_0 = 0.05,\\quad v_{x0} = 0,\\quad v_{y0} = 0,\\quad \\delta x_0 = 10^{-4},\\quad \\delta y_0 = -2\\times 10^{-4}.\n$$\n\n对于每个测试用例，在积分到 $u_{\\mathrm{end}}$ 后，计算两条测地线的实际分离矢量与测地偏离方程预测的偏离矢量之差的欧几里得范数，\n$$\n\\varepsilon = \\sqrt{\\left[(x_{\\mathrm{nbr}} - x_{\\mathrm{ref}}) - \\xi^x\\right]^2 + \\left[(y_{\\mathrm{nbr}} - y_{\\mathrm{ref}}) - \\xi^y\\right]^2}\\Bigg|_{u=u_{\\mathrm{end}}},\n$$\n并将 $\\varepsilon$ 作为浮点数报告。\n\n测试套件：\n- 用例 1：$A = 0.2$, $\\omega = 6$, $\\sigma = 0.3$, $u_0 = 1.0$。\n- 用例 2：$A = 0$, $\\omega = 6$, $\\sigma = 0.3$, $u_0 = 1.0$。\n- 用例 3：$A = 0.1$, $\\omega = 30$, $\\sigma = 0.2$, $u_0 = 1.0$。\n- 用例 4：$A = 0.5$, $\\omega = 10$, $\\sigma = 0.1$, $u_0 = 1.0$。\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如 $[r_1,r_2,r_3,r_4]$），其中每个 $r_i$ 是为相应测试用例计算出的 $\\varepsilon$。角度必须以弧度处理。不允许外部输入，程序必须能直接运行。", "solution": "我们从广义相对论的基本几何框架开始。一条测地线 $x^\\mu(\\lambda)$ 使固有时距离取极值，并满足测地线方程，\n$$\n\\frac{d^2 x^\\mu}{d\\lambda^2} + \\Gamma^\\mu_{\\ \\alpha\\beta}(x)\\,\\frac{d x^\\alpha}{d\\lambda}\\,\\frac{d x^\\beta}{d\\lambda} = 0,\n$$\n其中 $\\Gamma^\\mu_{\\ \\alpha\\beta}$ 是由度规 $g_{\\mu\\nu}$ 通过以下方式构建的 Christoffel 符号\n$$\n\\Gamma^\\mu_{\\ \\alpha\\beta} = \\frac{1}{2} g^{\\mu\\gamma}\\left( \\partial_\\alpha g_{\\beta\\gamma} + \\partial_\\beta g_{\\alpha\\gamma} - \\partial_\\gamma g_{\\alpha\\beta} \\right).\n$$\n相邻测地线的偏离由偏离矢量 $\\xi^\\mu$ 的测地偏离方程所支配，\n$$\n\\frac{D^2 \\xi^\\mu}{d\\lambda^2} = - R^\\mu_{\\ \\nu\\rho\\sigma}\\,u^\\nu\\,\\xi^\\rho\\,u^\\sigma,\n$$\n其中 $u^\\mu = \\frac{dx^\\mu}{d\\lambda}$ 是参考测地线的切矢，$R^\\mu_{\\ \\nu\\rho\\sigma}$ 是 Riemann 曲率张量。\n\n我们给定的是 Brinkmann 形式的平面波度规，\n$$\nds^2 = -2\\,du\\,dv + dx^2 + dy^2 + g_{uu}(u,x,y)\\,du^2, \\quad g_{uu}(u,x,y) = H(u)\\,(x^2 - y^2).\n$$\n非零度规分量为 $g_{uv} = g_{vu} = -1$，$g_{xx} = 1$，$g_{yy} = 1$ 以及 $g_{uu} = H(u)\\,(x^2 - y^2)$。$\\{u,v\\}$ 子空间中的逆度规可以通过对 $2\\times 2$ 分块矩阵求逆得到\n$$\n\\begin{pmatrix}\ng_{uu}  -1 \\\\\n-1  0\n\\end{pmatrix},\n$$\n这得到 $g^{uu} = 0$，$g^{uv} = g^{vu} = -1$ 以及 $g^{vv} = -g_{uu}$。在横向上，$g^{xx} = 1$，$g^{yy} = 1$。\n\n我们选择仿射参数 $\\lambda = u$，即我们用坐标 $u$ 来参数化测地线。这意味着 $\\frac{du}{d\\lambda} = 1$。横向坐标 $x$ 和 $y$ 的测地线方程简化为\n$$\n\\frac{d^2 x}{du^2} + \\Gamma^x_{\\ uu} = 0, \\qquad \\frac{d^2 y}{du^2} + \\Gamma^y_{\\ uu} = 0,\n$$\n因为唯一非零的速度平方项涉及对 $u$ 的导数。指标为 $(x;u,u)$ 和 $(y;u,u)$ 的 Christoffel 符号为\n$$\n\\Gamma^x_{\\ uu} = \\frac{1}{2} g^{x\\gamma}\\left( \\partial_u g_{u\\gamma} + \\partial_u g_{\\gamma u} - \\partial_\\gamma g_{uu} \\right) = -\\frac{1}{2}\\,\\partial_x g_{uu},\n$$\n$$\n\\Gamma^y_{\\ uu} = -\\frac{1}{2}\\,\\partial_y g_{uu},\n$$\n因为 $g_{u\\gamma}$ 与 $u$ 无关，且 $g^{x\\gamma}$ 选取 $\\gamma=x$ 而 $g^{y\\gamma}$ 选取 $\\gamma=y$。由于 $g_{uu} = H(u)\\,(x^2 - y^2)$，\n$$\n\\partial_x g_{uu} = 2 H(u)\\,x, \\qquad \\partial_y g_{uu} = - 2 H(u)\\,y.\n$$\n因此，\n$$\n\\Gamma^x_{\\ uu} = - H(u)\\,x, \\qquad \\Gamma^y_{\\ uu} = + H(u)\\,y,\n$$\n并且横向测地线方程变为线性常微分方程\n$$\n\\frac{d^2 x}{du^2} = H(u)\\,x, \\qquad \\frac{d^2 y}{du^2} = - H(u)\\,y.\n$$\n这些是含时线性二阶常微分方程，类似于在两个偏振方向上符号相反的参数振子方程，这是平面引力波中加号偏振的一个众所周知潮汐信号。\n\n对于测地偏离方程，我们需要在 $u$ 方向有两个指标的 Riemann 曲率分量。对于 Brinkmann 平面波，\n$$\nR_{uiuj} = -\\frac{1}{2}\\,\\partial_i \\partial_j g_{uu},\n$$\n其中 $i,j$ 取遍横向指标 $x,y$。使用 $g_{uu} = H(u)\\,(x^2 - y^2)$，我们发现\n$$\n\\partial_x \\partial_x g_{uu} = 2 H(u), \\quad \\partial_y \\partial_y g_{uu} = -2 H(u), \\quad \\partial_x \\partial_y g_{uu} = 0,\n$$\n因此\n$$\nR_{uxux} = - H(u), \\qquad R_{uyuy} = + H(u), \\qquad R_{uxuy} = R_{uyux} = 0.\n$$\n用 $g^{xx} = g^{yy} = 1$ 提升第一个横向指标得到\n$$\nR^x_{\\ u x u} = R_{x u x u} = R_{uxux} = - H(u), \\qquad R^y_{\\ u y u} = R_{uyuy} = + H(u).\n$$\n采用测地偏离方程的标准符号约定，\n$$\n\\frac{D^2 \\xi^\\mu}{d\\lambda^2} = - R^\\mu_{\\ \\nu\\rho\\sigma}\\,u^\\nu\\,\\xi^\\rho\\,u^\\sigma,\n$$\n并在我们的参数化中取 $u^\\mu$ 只有 $u$ 分量等于 $1$，偏离方程的横向分量变为\n$$\n\\frac{d^2 \\xi^x}{du^2} = - R^x_{\\ u x u}\\,\\xi^x = + H(u)\\,\\xi^x,\n$$\n$$\n\\frac{d^2 \\xi^y}{du^2} = - R^y_{\\ u y u}\\,\\xi^y = - H(u)\\,\\xi^y.\n$$\n这些方程与横向测地线方程的线性化差分完全匹配，这在预料之中，因为横向测地线方程对 $(x,y)$ 是线性的。因此，对于具有微小初始分离和相等初始横向速度的两条相邻测地线，偏离矢量 $\\xi^i(u)$ 在所有 $u$ 处都等于实际分离矢量 $(x_{\\mathrm{nbr}}(u) - x_{\\mathrm{ref}}(u),\\,y_{\\mathrm{nbr}}(u) - y_{\\mathrm{ref}}(u))$，差异仅在于数值积分误差。\n\n算法设计：\n- 定义具有参数 $(A,\\omega,\\sigma,u_0)$ 的波剖面 $H(u)$：\n$$\nH(u) = A\\,\\exp\\!\\left(-\\frac{(u-u_0)^2}{2\\,\\sigma^2}\\right)\\,\\cos\\!\\left(\\omega\\,(u-u_0)\\right),\n$$\n角度以弧度为单位。\n- 实现针对状态矢量 $\\mathbf{s} = (x, v_x, y, v_y)$ 的横向测地线 ODE 系统，\n$$\n\\frac{d}{du}\\begin{pmatrix} x \\\\ v_x \\\\ y \\\\ v_y \\end{pmatrix} =\n\\begin{pmatrix}\nv_x \\\\ H(u)\\,x \\\\ v_y \\\\ - H(u)\\,y\n\\end{pmatrix}.\n$$\n- 实现针对 $\\boldsymbol{\\xi} = (\\xi^x, \\dot{\\xi}^x, \\xi^y, \\dot{\\xi}^y)$ 的横向测地偏离 ODE，\n$$\n\\frac{d}{du}\\begin{pmatrix} \\xi^x \\\\ \\dot{\\xi}^x \\\\ \\xi^y \\\\ \\dot{\\xi}^y \\end{pmatrix} =\n\\begin{pmatrix}\n\\dot{\\xi}^x \\\\ H(u)\\,\\xi^x \\\\ \\dot{\\xi}^y \\\\ - H(u)\\,\\xi^y\n\\end{pmatrix}.\n$$\n- 使用高精度显式求解器在 $u \\in [u_{\\mathrm{start}}, u_{\\mathrm{end}}]$ 上积分参考测地线、相邻测地线（初始位置偏移 $(\\delta x_0,\\delta y_0)$，初始速度相同）以及初始时间导数为零的偏离矢量。\n- 在 $u = u_{\\mathrm{end}}$ 处，计算误差范数\n$$\n\\varepsilon = \\left\\| \\left( x_{\\mathrm{nbr}} - x_{\\mathrm{ref}} - \\xi^x,\\, y_{\\mathrm{nbr}} - y_{\\mathrm{ref}} - \\xi^y \\right) \\right\\|.\n$$\n- 对每个测试用例重复此过程，并将列表 $[\\varepsilon_1,\\varepsilon_2,\\varepsilon_3,\\varepsilon_4]$ 作为单行输出。\n\n数值考量：\n- 横向系统是线性的，但可能表现出参数放大效应（对于 $x$ 方向上 $H(u)  0$ 的情况），对于适中的 $A$ 和有限支撑 $\\sigma$ 而言，该系统是数值稳定的。\n- 使用具有严格容差的高阶非刚性积分器，例如显式8阶方法，以确保数值误差远小于物理效应的量级；将相对和绝对容差设置为较小的值，以便高保真地比较偏离和实际分离。\n- 在计算余弦值时，角度必须以弧度处理。\n\n该设计确保了科学真实性，以及从度规到 Christoffel 符号、测地线方程和测地偏离方程的有原则的推导，并定义了清晰、可测试的数值输出。", "answer": "```python\n# Numerical integration of geodesics and geodesic deviation in a Brinkmann plane wave spacetime\n# Environment: Python 3.12, numpy 1.23.5, scipy 1.11.4\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef H_profile(u, A, omega, sigma, u0):\n    \"\"\"Plane wave profile H(u) = A * exp(-((u-u0)^2)/(2*sigma^2)) * cos(omega*(u-u0)).\n    Angles in radians.\"\"\"\n    return A * np.exp(-((u - u0) ** 2) / (2.0 * sigma ** 2)) * np.cos(omega * (u - u0))\n\ndef geodesic_rhs(u, state, A, omega, sigma, u0):\n    \"\"\"RHS for transverse geodesic equations in Brinkmann coordinates.\n    state = [x, vx, y, vy]; dots are derivatives w.r.t. u.\"\"\"\n    x, vx, y, vy = state\n    Hu = H_profile(u, A, omega, sigma, u0)\n    dxdu = vx\n    dvxdu = Hu * x\n    dydu = vy\n    dvydu = -Hu * y\n    return [dxdu, dvxdu, dydu, dvydu]\n\ndef deviation_rhs(u, xi_state, A, omega, sigma, u0):\n    \"\"\"RHS for geodesic deviation equations in transverse directions.\n    xi_state = [xi_x, dxi_x, xi_y, dxi_y].\"\"\"\n    xi_x, dxi_x, xi_y, dxi_y = xi_state\n    Hu = H_profile(u, A, omega, sigma, u0)\n    dxi_x_du = dxi_x\n    ddxi_x_du = Hu * xi_x\n    dxi_y_du = dxi_y\n    ddxi_y_du = -Hu * xi_y\n    return [dxi_x_du, ddxi_x_du, dxi_y_du, ddxi_y_du]\n\ndef integrate_case(params, u_start, u_end, x0, y0, vx0, vy0, dx0, dy0):\n    \"\"\"Integrate reference geodesic, neighbor geodesic, and deviation vector; return final error norm.\"\"\"\n    A, omega, sigma, u0 = params\n\n    # Initial states\n    ref_init = [x0, vx0, y0, vy0]\n    nbr_init = [x0 + dx0, vx0, y0 + dy0, vy0]\n    xi_init = [dx0, 0.0, dy0, 0.0]\n\n    # Integration tolerances and method\n    method = 'DOP853'\n    rtol = 1e-12\n    atol = 1e-15\n\n    # Integrate reference geodesic\n    sol_ref = solve_ivp(\n        geodesic_rhs, (u_start, u_end), ref_init,\n        args=(A, omega, sigma, u0), method=method, rtol=rtol, atol=atol\n    )\n    # Integrate neighbor geodesic\n    sol_nbr = solve_ivp(\n        geodesic_rhs, (u_start, u_end), nbr_init,\n        args=(A, omega, sigma, u0), method=method, rtol=rtol, atol=atol\n    )\n    # Integrate deviation\n    sol_xi = solve_ivp(\n        deviation_rhs, (u_start, u_end), xi_init,\n        args=(A, omega, sigma, u0), method=method, rtol=rtol, atol=atol\n    )\n\n    # Extract final values at u_end\n    x_ref, y_ref = sol_ref.y[0, -1], sol_ref.y[2, -1]\n    x_nbr, y_nbr = sol_nbr.y[0, -1], sol_nbr.y[2, -1]\n    xi_x, xi_y = sol_xi.y[0, -1], sol_xi.y[2, -1]\n\n    # Compute error norm\n    err_x = (x_nbr - x_ref) - xi_x\n    err_y = (y_nbr - y_ref) - xi_y\n    err_norm = np.sqrt(err_x * err_x + err_y * err_y)\n    return float(err_norm)\n\ndef solve():\n    # Common initial conditions\n    u_start = 0.0\n    u_end = 2.0\n    x0 = 0.1\n    y0 = 0.05\n    vx0 = 0.0\n    vy0 = 0.0\n    dx0 = 1e-4\n    dy0 = -2e-4\n\n    # Test cases: (A, omega, sigma, u0)\n    test_cases = [\n        (0.2, 6.0, 0.3, 1.0),   # Case 1: moderate amplitude, moderate frequency\n        (0.0, 6.0, 0.3, 1.0),   # Case 2: zero amplitude (boundary case)\n        (0.1, 30.0, 0.2, 1.0),  # Case 3: high frequency\n        (0.5, 10.0, 0.1, 1.0),  # Case 4: short, strong pulse\n    ]\n\n    results = []\n    for params in test_cases:\n        err = integrate_case(params, u_start, u_end, x0, y0, vx0, vy0, dx0, dy0)\n        results.append(err)\n\n    # Final output in the exact required format\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3492025"}, {"introduction": "在计算出测地线的分离之后，下一步是深入理解其背后的物理意义。这项实践引入了一种强大的诊断工具，即分析黎曼曲率张量电性部分 $E_{ij}$ 的本征值和本征向量。通过这种方法，你将学习如何将数值模拟的结果与潮汐力的物理效应直接联系起来，揭示在引力波通过时，空间瞬时的拉伸和压缩主轴及其强度 [@problem_id:3492033]。", "problem": "您需要设计并实现一种数值方法，用于构造沿一条类时测地线、且正交于给定类时四维速度 $u^\\mu$ 的雅可比场，并将产生的偏离场投影到曲率电性部分的特征方向上。该方法必须基于第一性原理，并能适用于广义相对论（GR）中物理上合理的引力波环境。目标是通过解读曲率张量电性部分的特征值谱来量化潮汐拉伸或压缩。所有计算必须以相干单位表示，距离单位为米，时间单位为秒。角度必须以弧度指定。\n\n从以下基本基础开始：\n- 测地偏离方程（也称为雅可比方程）：\n  $$\\frac{D^2 \\xi^\\mu}{D\\tau^2} = - R^\\mu{}_{\\nu\\alpha\\beta}\\,u^\\nu\\,\\xi^\\alpha\\,u^\\beta,$$\n  其中 $\\xi^\\mu$ 是偏离（雅可比）场，$u^\\mu$ 是参考类时测地线的四维速度，$R^\\mu{}_{\\nu\\alpha\\beta}$ 是黎曼曲率张量，$\\tau$ 是沿测地线的固有时间。\n- 在参考测地线的瞬时局部静止参考系（费米标准坐标系）中，若 $u^\\mu=(1,0,0,0)$，任何正交于 $u^\\mu$ 的雅可比场的空间分量 $\\xi^i$ 满足\n  $$\\frac{d^2 \\xi^i}{d\\tau^2} + E^i{}_j(\\tau)\\,\\xi^j = 0,$$\n  其中 $E_{ij}(\\tau) = R_{i0j0}(\\tau)$ 是黎曼张量的电性部分。在真空中，这等于外尔张量（外尔曲率）的电性部分 $C_{i0j0}$。\n- 对于沿 $z$ 方向传播的弱平面横向无迹引力波，局部静止参考系中的空间度规扰动 $h_{ij}^{\\text{TT}}(\\tau)$ 可取为\n  $$h_{ij}^{\\text{TT}}(\\tau) = h_+(\\tau)\\left(\\hat{x}_i \\hat{x}_j - \\hat{y}_i \\hat{y}_j\\right) + h_\\times(\\tau)\\left(\\hat{x}_i \\hat{y}_j + \\hat{y}_i \\hat{x}_j\\right),$$\n  其中 $h_+(\\tau)$ 和 $h_\\times(\\tau)$ 分别是加（+）偏振和叉（×）偏振。在此体系下，曲率和度规扰动之间一个经过充分检验的关系是\n  $$E_{ij}(\\tau) = -\\tfrac{1}{2}\\,\\frac{d^2}{d\\tau^2} h_{ij}^{\\text{TT}}(\\tau).$$\n\n您的程序必须：\n- 为单色引力波构造 $E_{ij}(\\tau)$，其中\n  $$h_+(\\tau) = A_+ \\cos(\\omega \\tau), \\quad h_\\times(\\tau) = A_\\times \\cos(\\omega \\tau + \\phi),$$\n  其中 $A_+$ 和 $A_\\times$ 是无量纲振幅，$\\omega$ 是角频率（单位为 $\\text{rad}/\\text{s}$），$\\phi$ 是相位（单位为弧度）。根据上述关系，电性部分满足\n  $$E_{ij}(\\tau) = -\\tfrac{1}{2}\\,\\frac{d^2}{d\\tau^2} h_{ij}^{\\text{TT}}(\\tau).$$\n  确保将 $E_{ij}(\\tau)$ 构造为一个作用于空间向量的对称、无迹的 $3\\times 3$ 矩阵。\n- 对空间分量 $\\xi^i(\\tau)$ 数值积分雅可比方程\n  $$\\ddot{\\xi}^i(\\tau) + E^i{}_j(\\tau)\\,\\xi^j(\\tau) = 0$$\n  给定初始条件 $\\xi^i(0)$（单位为米，正交于 $u^\\mu$）和 $\\dot{\\xi}^i(0)$（单位为米/秒）。使用固有时间 $\\tau$（单位为秒）。点表示对 $\\tau$ 的导数。\n- 在最终固有时间 $\\tau=T$（单位为秒）时，计算 $E_{ij}(T)$ 的特征值分解：\n  $$E_{ij}(T)\\,e^{(k)}_j = \\lambda_k\\,e^{(k)}_i,$$\n  其中 $e^{(k)}_i$ 是标准正交特征向量，$\\lambda_k$ 是实特征值（单位为 $\\text{s}^{-2}$）。将特征值按升序排序，并相应地对特征向量进行排序。\n- 将最终偏离向量 $\\xi^i(T)$ 投影到特征基上：\n  $$p_k = e^{(k)}_i\\,\\xi^i(T),$$\n  使得 $p_k$ 是 $\\xi^i(T)$ 沿特征方向 $e^{(k)}_i$ 的分量。报告每个 $p_k$（单位为米）。\n- 通过计算负特征值的数量来提供可解释的潮汐特征：\n  $$N_{\\text{stretch}} = \\#\\{k \\mid \\lambda_k  0\\},$$\n  其中负的 $\\lambda_k$ 表示沿 $e^{(k)}_i$ 的瞬时潮汐拉伸，而正的 $\\lambda_k$ 表示压缩。\n\n物理单位：\n- 所有距离以米报告，时间以秒报告，角频率以 $\\text{rad}/\\text{s}$ 报告，特征值以 $\\text{s}^{-2}$ 报告。角度必须以弧度提供。\n- 所有输出必须是数值；不要输出任何单位文本。\n\n测试套件：\n为以下 $4$ 个测试用例实现您的程序。每个用例指定为一个元组 $(\\omega, A_+, A_\\times, \\phi, T, \\xi^i(0), \\dot{\\xi}^i(0))$，单位和约定如上。\n\n- 用例 1（正常路径，混合偏振）：\n  - $\\omega = 200.0$\n  - $A_+ = 1.2\\times 10^{-21}$\n  - $A_\\times = 0.8\\times 10^{-21}$\n  - $\\phi = 0.7$\n  - $T = 0.05$\n  - $\\xi^i(0) = [1000.0,\\, 500.0,\\, 0.0]$\n  - $\\dot{\\xi}^i(0) = [0.0,\\, 0.0,\\, 0.0]$\n- 用例 2（边界情况，曲率消失）：\n  - $\\omega = 150.0$\n  - $A_+ = 0.0$\n  - $A_\\times = 0.0$\n  - $\\phi = 0.0$\n  - $T = 0.1$\n  - $\\xi^i(0) = [0.0,\\, 2.0,\\, 3.0]$\n  - $\\dot{\\xi}^i(0) = [0.0,\\, 0.1,\\, -0.2]$\n- 用例 3（纯加偏振，初始分离对齐）：\n  - $\\omega = 400.0$\n  - $A_+ = 2.0\\times 10^{-21}$\n  - $A_\\times = 0.0$\n  - $\\phi = 0.0$\n  - $T = 0.02$\n  - $\\xi^i(0) = [1.0,\\, 0.0,\\, 0.0]$\n  - $\\dot{\\xi}^i(0) = [0.0,\\, 0.0,\\, 0.0]$\n- 用例 4（纯叉偏振，特征方向旋转）：\n  - $\\omega = 300.0$\n  - $A_+ = 0.0$\n  - $A_\\times = 1.0\\times 10^{-21}$\n  - $\\phi = \\pi/3$\n  - $T = 0.03$\n  - $\\xi^i(0) = [0.0,\\, 1.0,\\, 0.0]$\n  - $\\dot{\\xi}^i(0) = [0.0,\\, 0.0,\\, 0.0]$\n\n每个测试用例的所需输出：\n- 一个列表，包含 $3$ 个排序后的特征值 $\\lambda_k(T)$（单位 $\\text{s}^{-2}$），$3$ 个投影 $p_k$（单位米），以及整数 $N_{\\text{stretch}}$：\n  $$[\\lambda_1,\\,\\lambda_2,\\,\\lambda_3,\\,p_1,\\,p_2,\\,p_3,\\,N_{\\text{stretch}}].$$\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含所有 $4$ 个测试用例的结果，格式为逗号分隔的 Python 风格的列表的列表，例如：\n  $$\\texttt{[[\\lambda_1,\\lambda_2,\\lambda_3,p_1,p_2,p_3,N],[...],[...],[...]]}.$$\n- 不要打印任何附加文本。\n\n您的程序必须是自包含的，并且不得要求任何输入。它必须使用稳健的数值积分器。结果必须能用标准的双精度浮点算术复现。通过只演化初始数据正交于 $u^\\mu$（即 $\\xi^0 = 0$）的空间分量 $\\xi^i(\\tau)$ 来确保雅可比场保持与 $u^\\mu$ 正交。数值构造应反映物理学：特征值谱编码了瞬时潮汐压缩（正特征值）和拉伸（负特征值）。", "solution": "该问题要求对存在弱平面单色引力波的情况下，试验质量的测地偏离方程进行数值求解。目标是确定最终的偏离向量，并将其投影到由黎曼张量电性部分表征的瞬时潮汐场的特征方向上。\n\n### 基于原理的设计\n\n该解决方案基于广义相对论的原理，特别是通过测地偏离方程对潮汐力的描述。\n\n1.  **定义潮汐场 ($E_{ij}$):**\n    对于沿 z 方向传播的弱平面引力波，在横向无迹（TT）规范中，度规扰动由 $h_{ij}^{\\text{TT}}(\\tau)$ 给出。问题指定了单色波，其中扰动张量的非零分量为：\n    $$h_{11}^{\\text{TT}}(\\tau) = -h_{22}^{\\text{TT}}(\\tau) = h_+(\\tau) = A_+ \\cos(\\omega \\tau)$$\n    $$h_{12}^{\\text{TT}}(\\tau) = h_{21}^{\\text{TT}}(\\tau) = h_\\times(\\tau) = A_\\times \\cos(\\omega \\tau + \\phi)$$\n    分量 $h_{i3}^{\\text{TT}}$ 和 $h_{3i}^{\\text{TT}}$ 为零。矩阵形式为：\n    $$h_{ij}^{\\text{TT}}(\\tau) = \\begin{pmatrix} A_+ \\cos(\\omega \\tau)  A_\\times \\cos(\\omega \\tau + \\phi)  0 \\\\ A_\\times \\cos(\\omega \\tau + \\phi)  -A_+ \\cos(\\omega \\tau)  0 \\\\ 0  0  0 \\end{pmatrix}$$\n    黎曼张量的电性部分 $E_{ij}(\\tau)$ 描述了沿类时测地线的观察者局部静止参考系中的潮汐力，它与度规扰动的二阶时间导数相关：\n    $$E_{ij}(\\tau) = -\\frac{1}{2} \\frac{d^2}{d\\tau^2} h_{ij}^{\\text{TT}}(\\tau)$$\n    对 $h_{ij}^{\\text{TT}}(\\tau)$ 关于固有时间 $\\tau$ 求二阶导数，我们得到：\n    $$\\frac{d^2}{d\\tau^2} h_+(\\tau) = -A_+ \\omega^2 \\cos(\\omega \\tau)$$\n    $$\\frac{d^2}{d\\tau^2} h_\\times(\\tau) = -A_\\times \\omega^2 \\cos(\\omega \\tau + \\phi)$$\n    将这些代入 $E_{ij}(\\tau)$ 的表达式，我们得到潮汐张量的显式形式：\n    $$E_{ij}(\\tau) = \\frac{\\omega^2}{2} \\begin{pmatrix} A_+ \\cos(\\omega \\tau)  A_\\times \\cos(\\omega \\tau + \\phi)  0 \\\\ A_\\times \\cos(\\omega \\tau + \\phi)  -A_+ \\cos(\\omega \\tau)  0 \\\\ 0  0  0 \\end{pmatrix}$$\n    这个 $3 \\times 3$ 矩阵是对称的（$E_{ij}=E_{ji}$）且无迹的（$\\text{Tr}(E) = E_{11} + E_{22} + E_{33} = 0$），这与真空中引力波产生的潮汐力的性质一致。其单位是 $\\text{s}^{-2}$。\n\n2.  **测地偏离方程的数值积分：**\n    在观察者的局部静止参考系中，其中 $u^\\mu = (1,0,0,0)$，空间分离向量 $\\xi^i(\\tau)$ 的测地偏离方程简化为：\n    $$\\frac{d^2 \\xi^i}{d\\tau^2} + E^i{}_j(\\tau)\\,\\xi^j(\\tau) = 0$$\n    由于我们处于一个局部标准正交标架中，我们可以使用欧几里得度规来升降空间指标，因此 $E^i{}_j(\\tau) = E_{ij}(\\tau)$。该方程成为一个包含三个耦合的二阶线性常微分方程（ODEs）的系统：\n    $$\\ddot{\\vec{\\xi}}(\\tau) = -E(\\tau) \\vec{\\xi}(\\tau)$$\n    其中 $\\vec{\\xi}$ 是列向量 $(\\xi^1, \\xi^2, \\xi^3)^T$，$\\ddot{\\vec{\\xi}}$ 是其关于 $\\tau$ 的二阶导数，$E(\\tau)$ 是矩阵 $E_{ij}(\\tau)$。\n    为了进行数值求解，我们将该系统转换为一组六个一阶 ODEs。我们定义一个 $6$ 维状态向量 $Y(\\tau)$：\n    $$Y(\\tau) = \\begin{pmatrix} \\vec{\\xi}(\\tau) \\\\ \\dot{\\vec{\\xi}}(\\tau) \\end{pmatrix} = \\begin{pmatrix} \\xi^1 \\\\ \\xi^2 \\\\ \\xi^3 \\\\ \\dot{\\xi}^1 \\\\ \\dot{\\xi}^2 \\\\ \\dot{\\xi}^3 \\end{pmatrix}$$\n    则一阶系统为：\n    $$\\frac{dY}{d\\tau} = \\begin{pmatrix} \\dot{\\vec{\\xi}}(\\tau) \\\\ \\ddot{\\vec{\\xi}}(\\tau) \\end{pmatrix} = \\begin{pmatrix} \\dot{\\vec{\\xi}}(\\tau) \\\\ -E(\\tau) \\vec{\\xi}(\\tau) \\end{pmatrix} = \\begin{pmatrix} 0  I \\\\ -E(\\tau)  0 \\end{pmatrix} Y(\\tau)$$\n    其中 $I$ 是 $3 \\times 3$ 单位矩阵。该系统可以使用标准的数值 ODE 求解器（如龙格-库塔方法）从 $\\tau=0$ 积分到 $\\tau=T$。积分需要偏离向量 $\\vec{\\xi}(0)$ 及其速度 $\\dot{\\vec{\\xi}}(0)$ 的初始条件。`scipy.integrate.solve_ivp` 函数非常适合此任务。\n\n3.  **通过特征值分解进行物理解读：**\n    在最终时间 $\\tau=T$ 时，潮汐张量 $E_{ij}(T)$ 代表瞬时潮汐力。这些力的物理性质通过其特征值分解得以揭示：\n    $$E_{ij}(T) e^{(k)}_j = \\lambda_k e^{(k)}_i$$\n    三个实特征值 $\\lambda_k$（单位为 $\\text{s}^{-2}$）及其对应的标准正交特征向量 $\\vec{e}^{(k)}$ 定义了潮汐场的主轴。\n    - 如果 $\\lambda_k  0$，潮汐加速度 $\\ddot{\\xi}^i$ 在 $\\vec{e}^{(k)}$ 方向上有一个与 $\\xi^i$ 相反的分量，表示**压缩**。\n    - 如果 $\\lambda_k  0$，潮汐加速度在 $\\vec{e}^{(k)}$ 方向上有一个与 $\\xi^i$ 相同的分量，表示**拉伸**。\n    - 如果 $\\lambda_k = 0$，则沿该主轴没有潮汐力。\n    负特征值的数量 $N_{\\text{stretch}}$ 直接给出了瞬时拉伸方向的数量。我们使用 `numpy.linalg.eigh` 进行特征值分解，该函数针对对称矩阵进行了优化，并返回排序后的实特征值及其对应的标准正交特征向量。\n\n4.  **投影到特征方向：**\n    为了量化最终偏离向量 $\\vec{\\xi}(T)$ 与该时刻潮汐场主轴的对齐程度，我们将 $\\vec{\\xi}(T)$ 投影到标准正交特征基 $\\{\\vec{e}^{(k)}\\}$ 上：\n    $$p_k = \\vec{e}^{(k)} \\cdot \\vec{\\xi}(T) = e^{(k)}_i \\xi^i(T)$$\n    得到的标量 $p_k$（单位为米）是最终偏离向量沿每个主轴的分量。\n\n### 实现摘要\n程序遍历每个测试用例。对于每个用例：\n1.  它根据给定的引力波参数定义了矩阵 $E_{ij}(\\tau)$ 的函数。\n2.  它为 $6$ 维状态向量 $Y(\\tau)$ 建立了一阶 ODE 系统。\n3.  它使用 `scipy.integrate.solve_ivp` 函数，以提供的初始条件 $\\vec{\\xi}(0)$ 和 $\\dot{\\vec{\\xi}}(0)$ 将系统从 $\\tau=0$ 积分到 $\\tau=T$。对零振幅波的特殊情况进行解析处理，以避免不必要的数值计算。\n4.  在 $\\tau=T$ 时，它计算矩阵 $E_{ij}(T)$ 并执行特征值分解，以找到排序后的特征值 $\\lambda_k$ 和特征向量 $\\vec{e}^{(k)}$。\n5.  它计算最终偏离向量 $\\vec{\\xi}(T)$ 在特征向量上的投影 $p_k$。\n6.  它计算负特征值的数量 $N_{\\text{stretch}}$。\n7.  每个用例的结果 $[\\lambda_1, \\lambda_2, \\lambda_3, p_1, p_2, p_3, N_{\\text{stretch}}]$ 被收集起来，并以指定的列表的列表格式打印。\n所有单位均按规定处理：时间以秒（s）为单位，距离以米（m）为单位，频率以弧度/秒（rad/s）为单位。", "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the geodesic deviation problem for given gravitational wave parameters.\n    \"\"\"\n    \n    # Test cases: (omega, A_plus, A_cross, phi, T, xi0, xi_dot0)\n    test_cases = [\n        # Case 1\n        (200.0, 1.2e-21, 0.8e-21, 0.7, 0.05, [1000.0, 500.0, 0.0], [0.0, 0.0, 0.0]),\n        # Case 2\n        (150.0, 0.0, 0.0, 0.0, 0.1, [0.0, 2.0, 3.0], [0.0, 0.1, -0.2]),\n        # Case 3\n        (400.0, 2.0e-21, 0.0, 0.0, 0.02, [1.0, 0.0, 0.0], [0.0, 0.0, 0.0]),\n        # Case 4\n        (300.0, 0.0, 1.0e-21, np.pi/3, 0.03, [0.0, 1.0, 0.0], [0.0, 0.0, 0.0])\n    ]\n\n    results = []\n\n    for case in test_cases:\n        omega, A_plus, A_cross, phi, T, xi0_list, xi_dot0_list = case\n        \n        xi0 = np.array(xi0_list, dtype=np.float64)\n        xi_dot0 = np.array(xi_dot0_list, dtype=np.float64)\n\n        def get_E(tau, w, Ap, Ac, p):\n            \"\"\"Computes the electric part of the Riemann tensor E_ij.\"\"\"\n            cos_plus = np.cos(w * tau)\n            cos_cross = np.cos(w * tau + p)\n            \n            c1 = Ap * cos_plus\n            c2 = Ac * cos_cross\n            \n            E = (w**2 / 2.0) * np.array([\n                [c1, c2, 0.0],\n                [c2, -c1, 0.0],\n                [0.0, 0.0, 0.0]\n            ], dtype=np.float64)\n            return E\n\n        # Handle the trivial case (no gravitational wave) analytically\n        if A_plus == 0.0 and A_cross == 0.0:\n            # E_ij is always zero, so d^2(xi)/dtau^2 = 0\n            # xi(T) = xi(0) + xi_dot(0) * T\n            xi_T = xi0 + xi_dot0 * T\n            E_T = np.zeros((3, 3), dtype=np.float64)\n        else:\n            def ode_system(tau, y):\n                \"\"\"Defines the 6D first-order ODE system for geodesic deviation.\"\"\"\n                # y = [xi_x, xi_y, xi_z, v_x, v_y, v_z]\n                xi = y[0:3]\n                d_xi_dt = y[3:6]\n                \n                E_matrix = get_E(tau, omega, A_plus, A_cross, phi)\n                d_v_dt = -E_matrix @ xi\n                \n                return np.concatenate((d_xi_dt, d_v_dt))\n\n            # Set up initial conditions for the 6D state vector\n            y0 = np.concatenate((xi0, xi_dot0))\n\n            # Numerically integrate the ODE system\n            sol = solve_ivp(\n                ode_system,\n                [0, T],\n                y0,\n                t_eval=[T],\n                method='RK45', \n                rtol=1e-12,\n                atol=1e-12\n            )\n            \n            # Extract final state\n            y_final = sol.y[:, -1]\n            xi_T = y_final[0:3]\n            \n            # Compute E_ij at the final time T\n            E_T = get_E(T, omega, A_plus, A_cross, phi)\n\n        # Eigenvalue decomposition of E_ij(T)\n        # np.linalg.eigh returns eigenvalues in ascending order for symmetric matrices\n        lambdas, e_vecs = np.linalg.eigh(E_T)\n\n        # Project final deviation vector xi(T) onto the eigenbasis\n        # e_vecs are columns, so e_vecs.T @ xi_T gives the projections\n        projections = e_vecs.T @ xi_T\n        \n        # Count the number of negative eigenvalues (stretching directions)\n        n_stretch = np.sum(lambdas  0)\n\n        # Assemble results for the current case\n        case_result = lambdas.tolist() + projections.tolist() + [int(n_stretch)]\n        results.append(case_result)\n\n    # Format output as a Python-style list of lists string\n    output_str_parts = []\n    for res_list in results:\n        list_str = \"[\" + \",\".join(map(str, res_list)) + \"]\"\n        output_str_parts.append(list_str)\n        \n    final_output = \"[\" + \",\".join(output_str_parts) + \"]\"\n    print(final_output)\n\nsolve()\n```", "id": "3492033"}, {"introduction": "这项练习旨在将广义相对论中复杂的测地偏离框架与我们更熟悉的牛顿引力理论联系起来。通过直接比较相对论测地偏离和牛顿潮汐理论对粒子分离演化的预测，你将清晰地看到两种理论的适用范围和分歧点。这有助于你深刻理解为何在弱静态引力场中牛顿近似是有效的，以及为何在描述引力波等纯相对论现象时，必须采用完整的广义相对论方法 [@problem_id:3492002]。", "problem": "您需要设计并实现一个程序，在与数值相对论（NR）相关的弱场情况下，比较由Weyl张量的电性部分驱动的测地偏离方程，以及由标量引力势的Hessian矩阵驱动的牛顿潮汐近似所预测的分离演化。这种比较必须通过潮汐矩阵 $E_{ij}(t)$ 的范数以及预测分离量 $\\xi^i(t)$ 随时间的偏差来量化。您的程序必须为一套小型的物理上一致的场景测试套件生成结果，并将它们汇总为单一指定的输出格式。\n\n从以下基本定义和定律开始：\n\n- 对于切向为 $u^\\mu$、分离向量为 $\\xi^\\mu$ 的类时测地线汇，其测地偏离方程为\n$$\n\\frac{D^2 \\xi^\\mu}{d\\tau^2} = - R^\\mu{}_{\\alpha\\beta\\gamma}\\,u^\\alpha\\,\\xi^\\beta\\,u^\\gamma,\n$$\n其中 $R^\\mu{}_{\\alpha\\beta\\gamma}$ 是黎曼曲率张量，$\\tau$ 是固有时。在一个适用于静态观测者的局部正交归一参考系中，其中 $u^\\mu = (1,0,0,0)$ 并且在弱场近似的主导阶下 $\\tau$ 与坐标时间 $t$ 一致，其空间分量满足\n$$\n\\frac{d^2 \\xi^i}{dt^2} = - E^i{}_{\\,j}(t)\\,\\xi^j,\n$$\n其中 $E_{ij}(t) = R_{i0j0}(t)$ 是Weyl张量的电性部分。\n\n- 在牛顿引力中，标量引力势 $\\Phi(\\mathbf{x}, t)$ 通过其空间Hessian矩阵决定潮汐加速度，\n$$\n\\frac{d^2 \\xi^i}{dt^2} = - \\partial_i \\partial_j \\Phi(\\mathbf{x}, t)\\,\\xi^j,\n$$\n该矩阵沿着参考世界线求值。在一个由半径为 $r$ 处的点质量 $M$ 产生的静态、球对称弱场构型中，局部潮汐矩阵等于\n$$\nT_{ij} = \\partial_i \\partial_j \\Phi = \\mathrm{diag}\\!\\left( \\frac{2GM}{r^3}, -\\frac{GM}{r^3}, -\\frac{GM}{r^3} \\right),\n$$\n在一个 $x$ 轴为径向的正交归一三轴架中。这里 $G$ 是牛顿引力常数。\n\n- 对于一个在横向无迹（TT）规范下沿 $z$ 方向传播、具有加号（plus）极化应变 $h_+(t) = h_0 \\cos(\\omega t)$ 的平面线性极化引力波，电性部分的非零分量为\n$$\nE_{xx}(t) = -\\frac{1}{2}\\ddot{h}_+(t) = \\frac{1}{2} h_0 \\omega^2 \\cos(\\omega t),\\quad E_{yy}(t) = -E_{xx}(t),\\quad E_{zz}(t)=0,\n$$\n且所有非对角分量在主导阶下为零。\n\n您的程序必须：\n\n1. 实现通用系统\n$$\n\\frac{d}{dt}\\begin{pmatrix} \\xi^i \\\\ v^i \\end{pmatrix} =\n\\begin{pmatrix}\nv^i \\\\\n- E^i{}_{\\,j}(t)\\,\\xi^j\n\\end{pmatrix},\n$$\n用于广义相对论（GR）的预测，其中 $v^i = d\\xi^i/dt$；以及类似的牛顿预测，使用 $T_{ij}(t) = \\partial_i \\partial_j \\Phi(\\mathbf{x}, t)$ 代替 $E_{ij}(t)$。\n\n2. 对于测试套件中的每个场景，使用相同的初始条件，在指定的时间间隔内对两个系统进行积分。使用国际单位制（SI units）：位置单位为米（m），时间单位为秒（s），质量单位为千克（kg），角频率单位为弧度/秒（rad/s）。角度和角频率必须以弧度处理。\n\n3. 通过计算以下量来量化比较：\n   - GR潮汐矩阵的Frobenius范数随时间变化的上确界，\n     $$\n     \\|E(t)\\|_F = \\sqrt{\\sum_{i,j} E_{ij}^2(t)},\\qquad \\|E\\|_{F,\\max} = \\sup_{t \\in [0,T]} \\|E(t)\\|_F.\n     $$\n   - 最终时刻的相对偏差，\n     $$\n     \\delta_{\\mathrm{final}} = \\frac{\\|\\xi_{\\mathrm{GR}}(T) - \\xi_{\\mathrm{Newt}}(T)\\|_2}{\\max\\big(\\|\\xi_{\\mathrm{GR}}(T)\\|_2,\\,\\epsilon_{\\mathrm{floor}}\\big)},\n     $$\n     其中 $\\|\\cdot\\|_2$ 是欧几里得范数，$T$ 是最终时刻，$\\epsilon_{\\mathrm{floor}}$ 是一个很小的正数，用于防止除以零。\n   - 失效时间 $t_{\\mathrm{break}}$，定义为满足以下条件的最早时间 $t \\in [0,T]$：\n     $$\n     \\|\\xi_{\\mathrm{GR}}(t) - \\xi_{\\mathrm{Newt}}(t)\\|_2 \\ge \\varepsilon\\,\\|\\xi_{\\mathrm{GR}}(t)\\|_2,\n     $$\n     其中无量纲容差 $\\varepsilon$ 在下方指定。如果此条件从未满足，则报告 $t_{\\mathrm{break}}$ 为 $-1.0$。\n\n4. 为每个测试案例生成一个结果列表，其中包含 $[\\|E\\|_{F,\\max},\\,\\delta_{\\mathrm{final}},\\,t_{\\mathrm{break}}]$（在适用时使用国际单位制），并将每个案例的列表聚合为单行输出，形式为用方括号括起来的逗号分隔列表。\n\n使用以下测试套件，其设计旨在探测不同方面，包括静态弱场中的一致性、波主导真空中的失效情况以及边缘案例：\n\n- 案例A（静态点质量，理想路径）：一个位于点质量外部的弱场区域，该点质量 $M = 5.0\\times 10^{30}$ kg，位于固定半径 $r = 2.0\\times 10^{8}$ m 处。取径向沿 $x$ 轴的局部正交归一参考系，因此\n$$\nE_{ij} = \\mathrm{diag}\\!\\left( \\frac{2GM}{r^3}, -\\frac{GM}{r^3}, -\\frac{GM}{r^3} \\right),\\quad T_{ij} = E_{ij}.\n$$\n从初始分离 $\\xi(0) = (1.0,\\,0.5,\\,0.0)$ m 和初始相对速度 $v(0) = (0.0,\\,0.0,\\,0.0)$ m/s 开始，在 $T = 1.0$ s 的时间段内进行积分。\n\n- 案例B（平面引力波加号极化，真空中失效）：一个单色平面引力波，其加号极化振幅为 $h_0 = 1.0\\times 10^{-18}$，角频率为 $\\omega = 6.28\\times 10^{2}$ rad/s，因此\n$$\nE_{xx}(t)=\\tfrac{1}{2} h_0 \\omega^2 \\cos(\\omega t),\\quad E_{yy}(t)=-E_{xx}(t),\\quad E_{zz}(t)=0.\n$$\n在局部真空中没有牛顿物质源，因此取 $\\Phi = 0$ 且 $T_{ij}(t) = 0$。从 $\\xi(0) = (1.0,\\,0.0,\\,0.0)$ m 和 $v(0) = (0.0,\\,0.0,\\,0.0)$ m/s 开始，在 $T = 1.0\\times 10^{3}$ s 的时间段内进行积分。\n\n- 案例C（引力波，对齐分离，边缘案例）：与案例B具有相同的 $h_0$ 和 $\\omega$，但初始分离与传播方向对齐，在该方向上 $E_{zz}(t) = 0$，即 $\\xi(0) = (0.0,\\,0.0,\\,1.0)$ m 和 $v(0) = (0.0,\\,0.0,\\,0.0)$ m/s。在 $T = 1.0\\times 10^{3}$ s 的时间段内积分，其中 $T_{ij}(t)=0$。\n\n- 案例D（零场，边界条件）：无曲率且无牛顿潮汐场，$E_{ij}(t)=0$ 且 $T_{ij}(t)=0$ 对所有 $t$ 成立。从 $\\xi(0) = (1.0,\\,1.0,\\,1.0)$ m 和 $v(0) = (0.0,\\,0.0,\\,0.0)$ m/s 开始，在 $T = 1.0\\times 10^{1}$ s 的时间段内积分。\n\n使用常数 $G = 6.674\\times 10^{-11}$ m$^3$ kg$^{-1}$ s$^{-2}$，并将失效容差设置为 $\\varepsilon = 1.0\\times 10^{-6}$。为 $\\delta_{\\mathrm{final}}$ 中的分母选择一个小的下限值 $\\epsilon_{\\mathrm{floor}} = 1.0\\times 10^{-15}$ m。\n\n您的程序应生成单行输出，其中包含每个案例的结果，形式为由方括号括起来的、包含三元素列表的逗号分隔列表，例如 $[[a,b,c],[d,e,f],\\dots]$，其中每个元素 $a,b,c,\\dots$ 是一个浮点数，在适用时采用国际单位制。", "solution": "该问题要求比较两种不同物理理论所预测的两条邻近测地线之间分离向量 $\\xi^i(t)$ 的演化：弱场极限下的广义相对论（GR）和牛顿引力。该比较将针对一套四个不同的物理场景进行数值计算。\n\n基本原理是二阶常微分方程（ODE）组的数值积分。对于这两种理论，控制方程的形式均为：\n$$\n\\frac{d^2 \\xi^i}{dt^2} = - K^i{}_{\\,j}(t)\\,\\xi^j\n$$\n其中 $K_{ij}(t)$ 是一个 $3 \\times 3$ 的时变潮汐矩阵。对于GR的预测，这个矩阵是Weyl张量的电性部分，$K_{ij}(t) = E_{ij}(t) = R_{i0j0}(t)$。对于牛顿的预测，它是引力势的Hessian矩阵，$K_{ij}(t) = T_{ij}(t) = \\partial_i\\partial_j\\Phi$。\n\n为了数值求解该系统，我们首先将二阶ODE转换为一阶ODE系统。我们定义一个状态向量 $y(t)$，它由分离向量 $\\xi^i(t)$ 及其一阶时间导数，即相对速度 $v^i(t) = d\\xi^i/dt$ 组成。对于一个三维空间问题，状态向量是一个六分量向量：\n$$\ny(t) = \\begin{pmatrix} \\xi^1(t) \\\\ \\xi^2(t) \\\\ \\xi^3(t) \\\\ v^1(t) \\\\ v^2(t) \\\\ v^3(t) \\end{pmatrix}\n$$\n那么一阶系统由下式给出：\n$$\n\\frac{d}{dt}y(t) = \\frac{d}{dt}\\begin{pmatrix} \\xi^i \\\\ v^i \\end{pmatrix} = \\begin{pmatrix} v^i \\\\ -K^i{}_{\\,j}(t)\\,\\xi^j \\end{pmatrix} = F(t, y(t))\n$$\n该系统可以使用标准的数值ODE求解器，从一组初始条件 $y(0) = (\\xi^i(0), v^i(0))^T$ 出发，在时间间隔 $[0, T]$ 上进行积分。实现将使用 `scipy.integrate` 库中的 `solve_ivp` 函数，该函数为求解初值问题提供了鲁棒且自适应的算法。对于四个测试案例中的每一个，我们将定义矩阵 $E_{ij}(t)$ 和 $T_{ij}(t)$ 的具体形式、初始条件 $\\xi(0)$ 和 $v(0)$ 以及总积分时间 $T$。每个案例将执行两次独立的积分：一次使用 $E_{ij}(t)$ 进行GR预测，另一次使用 $T_{ij}(t)$ 进行牛顿预测。\n\n这四个案例旨在测试两种理论的对应性和差异性：\n- **案例A（静态点质量）：** 在此案例中，$E_{ij}$ 和 $T_{ij}$ 是相同的常数矩阵，代表了GR在潮汐力方面简化为牛頓引力的弱场极限。我们期望解 $\\xi_{\\mathrm{GR}}(t)$ 和 $\\xi_{\\mathrm{Newt}}(t)$ 在数值精度范围内是相同的。\n$E_{ij} = T_{ij} = \\mathrm{diag}(2GM/r^3, -GM/r^3, -GM/r^3)$ with $G = 6.674\\times 10^{-11}$ m$^3$ kg$^{-1}$ s$^{-2}$, $M = 5.0\\times 10^{30}$ kg, and $r = 2.0\\times 10^{8}$ m.\n\n- **案例B（平面引力波）：** 该场景模拟了一个纯GR效应，没有牛顿力学中的对应物。$E_{ij}(t)$ 是时变的，描述了一个加号极化引力波的潮汐力，而 $T_{ij}(t)=0$。我们期望解会发散。\n$E_{xx}(t) = -E_{yy}(t) = \\frac{1}{2} h_0 \\omega^2 \\cos(\\omega t)$ with $h_0 = 1.0\\times 10^{-18}$ and $\\omega = 6.28\\times 10^{2}$ rad/s.\n\n- **案例C（引力波，对齐分离）：** 这是一个边缘案例，其中初始分离向量与引力波的传播方向对齐。由于引力波是横波，不应感受到潮汐力，因此我们期望 $\\xi_{\\mathrm{GR}}(t)$ 和 $\\xi_{\\mathrm{Newt}}(t)$ 会一致。\n\n- **案例D（零场）：** 一个平凡案例，其中 $E_{ij}=0$ 且 $T_{ij}=0$，用作对积分器的健全性检查。两种理论都预测没有加速度，因此分离向量应根据其初始速度演化。\n\n在获得每个案例的数值解 $\\xi_{\\mathrm{GR}}(t)$ 和 $\\xi_{\\mathrm{Newt}}(t)$ 之后，我们将计算三个指定的度量指标。为了精确计算依赖于连续时间演化的量，例如上确界范数和失效时间，我们将利用 `solve_ivp` 的 `dense_output=True` 特性。这提供了一个插值解，可以在积分区间内的任何点进行评估。我们将使用一个精细的时间点网格来进行这些评估。\n\n1.  **最大Frobenius范数 $\\|E\\|_{F,\\max}$**：在时间网格的每个点上计算矩阵 $E(t)$ 的Frobenius范数。这些值的最大值即为结果。\n    $$\n    \\|E(t)\\|_F = \\sqrt{\\sum_{i,j=1}^3 E_{ij}(t)^2} \\qquad \\|E\\|_{F,\\max} = \\sup_{t \\in [0,T]} \\|E(t)\\|_F\n    $$\n2.  **最终时刻相对偏差 $\\delta_{\\mathrm{final}}$**：该度量指标量化了在积分时间 $T$ 结束时两种预测之间的累积差异。它是使用最终状态向量 $\\xi_{\\mathrm{GR}}(T)$ 和 $\\xi_{\\mathrm{Newt}}(T)$ 计算的。一个下限值 $\\epsilon_{\\mathrm{floor}} = 1.0\\times 10^{-15}$ m 可以防止除以接近零的范数。\n    $$\n    \\delta_{\\mathrm{final}} = \\frac{\\|\\xi_{\\mathrm{GR}}(T) - \\xi_{\\mathrm{Newt}}(T)\\|_2}{\\max\\big(\\|\\xi_{\\mathrm{GR}}(T)\\|_2, \\epsilon_{\\mathrm{floor}}\\big)}\n    $$\n3.  **失效时间 $t_{\\mathrm{break}}$**：这是两个分离向量之间的瞬时相对差异首次超过给定容差 $\\varepsilon = 1.0\\times 10^{-6}$ 的时间 $t$。我们在评估时间网格的每个点上检查此条件。如果该条件从未满足，$t_{\\mathrm{break}}$ 报告为 $-1.0$。\n    $$\n    \\|\\xi_{\\mathrm{GR}}(t) - \\xi_{\\mathrm{Newt}}(t)\\|_2 \\ge \\varepsilon\\,\\|\\xi_{\\mathrm{GR}}(t)\\|_2\n    $$\n\n最终的实现将系统地处理每个案例，计算这三个度量指标，并按照规定将结果格式化为单个列表的列表。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\n# Global constants as defined in the problem\nG_CONST = 6.674e-11  # m^3 kg^-1 s^-2\nEPSILON_BREAKDOWN = 1.0e-6\nEPSILON_FLOOR = 1.0e-15\n\ndef ode_system(t, y, K_func):\n    \"\"\"\n    Defines the first-order ODE system dy/dt = F(t, y).\n    y is a 6-element state vector [xi_x, xi_y, xi_z, v_x, v_y, v_z].\n    K_func(t) returns the 3x3 tidal matrix K_ij at time t.\n    \"\"\"\n    xi = y[:3]\n    v = y[3:]\n    K_matrix = K_func(t)\n    acceleration = -K_matrix @ xi\n    return np.concatenate((v, acceleration))\n\ndef solve_case(E_func, T_func, xi0, v0, T_final):\n    \"\"\"\n    Solves a single test case for both GR and Newtonian models and computes metrics.\n    \"\"\"\n    y0 = np.concatenate((xi0, v0))\n    t_span = (0, T_final)\n    \n    # Use a sufficient number of points for accurate post-processing.\n    # We will use dense output, but evaluate on a grid for max/breakdown time.\n    num_eval_points = 10001 \n    t_eval = np.linspace(0, T_final, num_eval_points)\n\n    # High-precision solver settings\n    solver_args = {'dense_output': True, 'method': 'RK45', 'atol': 1e-12, 'rtol': 1e-12}\n\n    # Solve for General Relativity\n    sol_gr = solve_ivp(lambda t, y: ode_system(t, y, E_func), t_span, y0, **solver_args)\n    y_gr = sol_gr.sol(t_eval)\n    xi_gr = y_gr[:3, :]\n\n    # Solve for Newtonian gravity\n    sol_newt = solve_ivp(lambda t, y: ode_system(t, y, T_func), t_span, y0, **solver_args)\n    y_newt = sol_newt.sol(t_eval)\n    xi_newt = y_newt[:3, :]\n\n    # --- Metric 1: Maximum Frobenius norm of E(t) ---\n    E_values = np.array([E_func(t) for t in t_eval])\n    frobenius_norms = np.linalg.norm(E_values, ord='fro', axis=(1, 2))\n    E_F_max = np.max(frobenius_norms) if frobenius_norms.size > 0 else 0.0\n\n    # --- Metric 2: Final-time relative deviation ---\n    xi_gr_final = xi_gr[:, -1]\n    xi_newt_final = xi_newt[:, -1]\n    numerator = np.linalg.norm(xi_gr_final - xi_newt_final)\n    denominator = max(np.linalg.norm(xi_gr_final), EPSILON_FLOOR)\n    delta_final = numerator / denominator\n\n    # --- Metric 3: Breakdown time ---\n    diff_norm = np.linalg.norm(xi_gr - xi_newt, axis=0)\n    xi_gr_norm = np.linalg.norm(xi_gr, axis=0)\n    # Avoid division by zero by adding a small number where xi_gr_norm is zero.\n    # In these test cases, xi_gr_norm is always > 0.\n    with np.errstate(divide='ignore', invalid='ignore'):\n        relative_diff = np.divide(diff_norm, xi_gr_norm, out=np.zeros_like(diff_norm), where=xi_gr_norm!=0)\n    \n    breakdown_condition = relative_diff >= EPSILON_BREAKDOWN\n    breakdown_indices = np.where(breakdown_condition)[0]\n    \n    t_break = t_eval[breakdown_indices[0]] if breakdown_indices.size > 0 else -1.0\n    \n    return [E_F_max, delta_final, t_break]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    \n    # Case A: Static point mass\n    M_A = 5.0e30\n    r_A = 2.0e8\n    c1_A = (2 * G_CONST * M_A) / (r_A**3)\n    c2_A = (-G_CONST * M_A) / (r_A**3)\n    K_A = np.diag([c1_A, c2_A, c2_A])\n    case_A = {\n        'E_func': lambda t: K_A,\n        'T_func': lambda t: K_A,\n        'xi0': np.array([1.0, 0.5, 0.0]),\n        'v0': np.array([0.0, 0.0, 0.0]),\n        'T_final': 1.0\n    }\n\n    # Case B: Plane gravitational wave\n    h0_B = 1.0e-18\n    omega_B = 6.28e2\n    A_B = 0.5 * h0_B * omega_B**2\n    def E_func_B(t):\n        val = A_B * np.cos(omega_B * t)\n        return np.array([[val, 0, 0], [0, -val, 0], [0, 0, 0]])\n    \n    T_func_zero = lambda t: np.zeros((3, 3))\n    \n    case_B = {\n        'E_func': E_func_B,\n        'T_func': T_func_zero,\n        'xi0': np.array([1.0, 0.0, 0.0]),\n        'v0': np.array([0.0, 0.0, 0.0]),\n        'T_final': 1.0e3\n    }\n    \n    # Case C: Gravitational wave, aligned separation\n    case_C = {\n        'E_func': E_func_B, # Same wave as B\n        'T_func': T_func_zero,\n        'xi0': np.array([0.0, 0.0, 1.0]),\n        'v0': np.array([0.0, 0.0, 0.0]),\n        'T_final': 1.0e3\n    }\n\n    # Case D: Null field\n    case_D = {\n        'E_func': T_func_zero,\n        'T_func': T_func_zero,\n        'xi0': np.array([1.0, 1.0, 1.0]),\n        'v0': np.array([0.0, 0.0, 0.0]),\n        'T_final': 1.0e1\n    }\n    \n    test_cases = [case_A, case_B, case_C, case_D]\n    \n    results = []\n    for case_params in test_cases:\n        result = solve_case(**case_params)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    formatted_results = ','.join([f\"[{r[0]},{r[1]},{r[2]}]\" for r in results])\n    print(f\"[{formatted_results}]\")\n\nsolve()\n\n```", "id": "3492002"}]}