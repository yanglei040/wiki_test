{"hands_on_practices": [{"introduction": "引力波辐射的产生需要质量的非对称性加速运动。这个练习旨在通过一个理想化的思想实验来阐明这一基本原理。我们将首先证明一个完美的轴对称刚体在旋转时为何是“沉默”的，即不产生引力波辐射；然后，我们将探讨一个微小的非对称性（例如，中子星上的“山”）如何打破这种沉默，并学习如何估算由此产生的引力波信号强度 [@problem_id:3494604]。", "problem": "考虑一个质量密度为 $\\rho(\\mathbf{x},t)$ 的刚体，处于广义相对论的弱场慢速区，适用线性化引力理论。质量四极矩张量定义为\n$$\nI_{ij}(t) = \\int \\rho(\\mathbf{x},t)\\left(x_i x_j - \\frac{1}{3}\\delta_{ij} r^2\\right)\\,d^3x,\n$$\n其中积分在质心参考系中进行，且 $r^2 = x_k x_k$。在横向无迹 (TT) 规范中，引力辐射的远场区度规微扰由慢速极限下 $I_{ij}(t)$ 的时间变化决定。使用线性化爱因斯坦方程和多极展开作为基本基础，结合应力-能量守恒，推断旋转构型的引力波发射性质。\n\n任务 A (轴对称性消失)：对于一个围绕其对称轴（取旋转轴为 $\\hat{z}$ 轴）刚性旋转的完美轴对称构型，从第一性原理证明四极矩张量 $I_{ij}(t)$ 在惯性参考系中不随时间变化，因此 $\\ddot{I}_{ij}(t)=0$，从而这种轴对称刚性旋转的领头阶引力辐射为零。\n\n任务 B (非轴对称 $m=2$ 棒模式)：考虑在赤道平面上存在一个小的、刚性的、非轴对称的畸变，该畸变由赤道椭率 $\\epsilon$ 参数化，使得 $I_{xx}-I_{yy}=\\Delta I$ 非零，并通过 $\\Delta I=\\epsilon I_z$ 与绕旋转轴的主转动惯量 $I_z$ 相关联。将该天体建模为具有转动惯量 $I_z = k\\,M\\,a^2$，其中 $M$ 是质量， $a$ 是特征赤道半径， $k$ 是一个无量纲结构系数（对于均匀密度球体，$k=\\frac{2}{5}$）。使用线性化引力的慢速、远场区极限，推导在距离 $R$ 处、对于最佳朝向的观测者，领头阶引力波应变振幅 $h$ 的表达式，用 $G$、$c$、$\\Omega$、$\\Delta I$ 和 $R$ 表示。然后，用 $\\epsilon$、$k$、$M$、$a$、$\\Omega$ 和 $R$ 表示 $h$。\n\n实现要求：\n- 您必须将推导出的领头阶应变 $h$ 实现为一个函数，其参数为 $\\epsilon$、$k$、$M$、$a$、$\\Omega$（角旋转频率）和 $R$。角旋转频率必须以弧度/秒为单位处理。\n- 您还必须实现逆向计算：给定一个探测阈值应变 $h_{\\mathrm{det}}$，计算在相同的物理参数下，达到 $h \\ge h_{\\mathrm{det}}$ 所需的最小椭率 $\\epsilon_{\\min}$。\n- 所有物理常量和量都必须使用国际单位制 (SI 单位) 处理。具体来说：$M$ 的单位是千克，$a$ 的单位是米，$R$ 的单位是米，$\\Omega$ 的单位是弧度/秒，$G$ 的单位是 $\\mathrm{m^3\\,kg^{-1}\\,s^{-2}}$，$c$ 的单位是 $\\mathrm{m\\,s^{-1}}$。应变 $h$ 和椭率 $\\epsilon$ 是无量纲的。\n\n测试套件：\n提供一个程序，评估以下五个测试用例。对于以赫兹 (hertz) 指定旋转频率的用例，使用 $\\Omega = 2\\pi f$（其中 $f$ 的单位是赫兹）将其转换为弧度/秒（要求的角度单位是弧度/秒）。\n\n- 情况 1 (轴对称检查：应变值)：$M = 1.4\\,M_\\odot$，$a = 12{,}000\\,\\mathrm{m}$，$k = 0.35$，$f = 600\\,\\mathrm{Hz}$，$R = 10\\,\\mathrm{kpc}$，$\\epsilon = 0$。计算并返回 $h$。\n- 情况 2 (银河系内，所需椭率)：$M = 1.4\\,M_\\odot$，$a = 12{,}000\\,\\mathrm{m}$，$k = 0.35$，$f = 600\\,\\mathrm{Hz}$，$R = 10\\,\\mathrm{kpc}$，$h_{\\mathrm{det}} = 10^{-25}$。计算并返回 $\\epsilon_{\\min}$。\n- 情况 3 (近邻河外星系，高频，所需椭率)：$M = 1.4\\,M_\\odot$，$a = 12{,}000\\,\\mathrm{m}$，$k = 0.35$，$f = 1000\\,\\mathrm{Hz}$，$R = 10\\,\\mathrm{Mpc}$，$h_{\\mathrm{det}} = 10^{-23}$。计算并返回 $\\epsilon_{\\min}$。\n- 情况 4 (远距离，较低频率，较重恒星，所需椭率)：$M = 2.0\\,M_\\odot$，$a = 10{,}000\\,\\mathrm{m}$，$k = 0.35$，$f = 100\\,\\mathrm{Hz}$，$R = 100\\,\\mathrm{Mpc}$，$h_{\\mathrm{det}} = 10^{-22}$。计算并返回 $\\epsilon_{\\min}$。\n- 情况 5 (近距离，小非轴对称性的显式应变)：$M = 1.4\\,M_\\odot$，$a = 12{,}000\\,\\mathrm{m}$，$k = 0.35$，$f = 1000\\,\\mathrm{Hz}$，$R = 1\\,\\mathrm{kpc}$，$\\epsilon = 10^{-6}$。计算并返回 $h$。\n\n程序内部使用的常量和转换：\n- $G = 6.67430\\times 10^{-11}\\,\\mathrm{m^3\\,kg^{-1}\\,s^{-2}}$。\n- $c = 299{,}792{,}458\\,\\mathrm{m\\,s^{-1}}$。\n- $M_\\odot = 1.98847\\times 10^{30}\\,\\mathrm{kg}$。\n- $1\\,\\mathrm{pc} = 3.0856775814913673\\times 10^{16}\\,\\mathrm{m}$。\n- $1\\,\\mathrm{kpc} = 10^3\\,\\mathrm{pc}$，$1\\,\\mathrm{Mpc} = 10^6\\,\\mathrm{pc}$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果。该列表必须按照上述五个用例的顺序排列。对于情况 1 和情况 5，输出应变 $h$（无量纲）。对于情况 2、情况 3 和情况 4，输出 $\\epsilon_{\\min}$（无量纲）。例如，格式应类似于“[r1,r2,r3,r4,r5]”，其中每个条目都是一个浮点数。", "solution": "问题陈述具有科学依据，是良定的，且无矛盾。它提出了一个研究连续源引力波的标准问题，基于线性化广义相对论中成熟的四极矩形式理论。所有数据、常数和任务都得到了清晰、客观的定义。因此，该问题被认为是有效的，可以提供完整的解决方案。\n\n解决方案分两部分进行，对应于问题陈述中指定的两个任务。\n\n任务 A：轴对称刚性旋转体的引力辐射消失。\n\n领头阶引力辐射由质量四极矩张量 $I_{ij}(t)$ 的二阶时间导数决定。四极矩张量在质心参考系中定义为：\n$$\nI_{ij}(t) = \\int \\rho(\\mathbf{x}, t) \\left(x_i x_j - \\frac{1}{3}\\delta_{ij} r^2\\right) d^3x\n$$\n其中 $\\rho(\\mathbf{x}, t)$ 是惯性参考系（实验室参考系）中的质量密度。\n\n考虑一个以恒定角速度 $\\Omega$ 绕 $\\hat{z}$ 轴旋转的刚体。设该物体在同步旋转参考系（物体参考系）中由一个不随时间变化的质量密度 $\\rho_0(\\mathbf{x}')$ 描述，其中 $\\mathbf{x}'$ 是该参考系中的坐标。惯性参考系中的坐标 $\\mathbf{x}$ 通过一个旋转矩阵 $\\mathcal{R}(t)$ 与物体参考系坐标相关联：$\\mathbf{x}(t) = \\mathcal{R}(t)\\mathbf{x}'$。对于绕 $\\hat{z}$ 轴的旋转，该矩阵为：\n$$\n\\mathcal{R}(t) = \\begin{pmatrix}\n\\cos(\\Omega t)  -\\sin(\\Omega t)  0 \\\\\n\\sin(\\Omega t)  \\cos(\\Omega t)  0 \\\\\n0  0  1\n\\end{pmatrix}\n$$\n$I_{ij}(t)$ 的积分可以转换到物体参考系中，在该参考系中积分域和密度都不随时间变化。由于旋转是正交变换，距离平方 $r^2 = \\mathbf{x} \\cdot \\mathbf{x} = \\mathbf{x}' \\cdot \\mathbf{x}' = r'^2$ 和体积元 $d^3x = d^3x'$ 是不变量。位置矢量的分量变换为 $x_i(t) = \\mathcal{R}_{ik}(t) x'_k$。\n惯性参考系中的四极矩张量可以用物体参考系中恒定的四极矩张量 $I'_{kl}$ 来表示：\n$$\nI'_{kl} = \\int \\rho_0(\\mathbf{x}') \\left(x'_k x'_l - \\frac{1}{3}\\delta_{kl} r'^2\\right) d^3x'\n$$\n变换关系为 $I_{ij}(t) = \\mathcal{R}_{ik}(t) \\mathcal{R}_{jl}(t) I'_{kl}$。\n\n问题指定构型是绕旋转轴（$\\hat{z}$ 轴）完美轴对称的。这对物体参考系中的张量 $I'_{kl}$ 施加了约束。在物体参考系中，轴对称意味着密度 $\\rho_0(\\mathbf{x}')$ 与围绕 $z'$ 轴的方位角无关。因此，任何形式为 $\\int (\\text{量}) \\times (x' \\text{ 或 } y' \\text{ 的奇数次幂}) d^3x'$ 的积分都为零。\n这意味着 $I'_{kl}$ 中涉及 $x'$ 或 $y'$ 轴的非对角分量为零：$I'_{xy} = I'_{xz} = I'_{yz} = 0$。因此，$I'_{kl}$ 是对角的。\n此外，轴对称意味着物理在 $x'$ 和 $y'$ 方向上是相同的。这要求 $I'_{xx} = I'_{yy}$。我们将物体参考系的主四极矩记为 $I'_{11}, I'_{22}, I'_{33}$。我们有：\n$$\nI'_{11} = I'_{22}\n$$\n现在，我们使用 $I_{ij}(t) = \\sum_{k,l} \\mathcal{R}_{ik}(t) \\mathcal{R}_{jl}(t) I'_{kl}$ 来计算惯性参考系张量 $I_{ij}(t)$ 的分量。由于 $I'_{kl}$ 是对角的，这简化为 $I_{ij}(t) = \\sum_{k} \\mathcal{R}_{ik}(t) \\mathcal{R}_{jk}(t) I'_{kk}$。\n\n- 对于 $i=j=3$ (zz-分量)：\n$I_{33}(t) = \\mathcal{R}_{31}^2 I'_{11} + \\mathcal{R}_{32}^2 I'_{22} + \\mathcal{R}_{33}^2 I'_{33} = (0)^2 I'_{11} + (0)^2 I'_{22} + (1)^2 I'_{33} = I'_{33}$。这是恒定的。\n\n- 对于 $i=j=1$ (xx-分量)：\n$I_{11}(t) = \\mathcal{R}_{11}^2 I'_{11} + \\mathcal{R}_{12}^2 I'_{22} + \\mathcal{R}_{13}^2 I'_{33} = \\cos^2(\\Omega t) I'_{11} + (-\\sin(\\Omega t))^2 I'_{22} = \\cos^2(\\Omega t) I'_{11} + \\sin^2(\\Omega t) I'_{22}$。\n由于 $I'_{11} = I'_{22}$，这变为 $I_{11}(t) = (\\cos^2(\\Omega t) + \\sin^2(\\Omega t)) I'_{11} = I'_{11}$。这是恒定的。\n\n- 对于 $i=j=2$ (yy-分量)：\n$I_{22}(t) = \\mathcal{R}_{21}^2 I'_{11} + \\mathcal{R}_{22}^2 I'_{22} + \\mathcal{R}_{23}^2 I'_{33} = \\sin^2(\\Omega t) I'_{11} + \\cos^2(\\Omega t) I'_{22}$。\n由于 $I'_{11} = I'_{22}$，这变为 $I_{22}(t) = (\\sin^2(\\Omega t) + \\cos^2(\\Omega t)) I'_{11} = I'_{11}$。这是恒定的。\n\n- 对于 $i=1, j=2$ (xy-分量)：\n$I_{12}(t) = \\mathcal{R}_{11}\\mathcal{R}_{21} I'_{11} + \\mathcal{R}_{12}\\mathcal{R}_{22} I'_{22} + \\mathcal{R}_{13}\\mathcal{R}_{23} I'_{33} = \\cos(\\Omega t)\\sin(\\Omega t) I'_{11} + (-\\sin(\\Omega t))\\cos(\\Omega t) I'_{22}$。\n由于 $I'_{11} = I'_{22}$，这变为 $I_{12}(t) = \\cos(\\Omega t)\\sin(\\Omega t) (I'_{11} - I'_{22}) = 0$。这是恒定的。\n\n类似地，可以发现所有其他分量都是恒定的（实际上为零）。由于四极矩张量 $I_{ij}(t)$ 的每个分量都不随时间变化，其一阶和二阶时间导数恒为零：$\\dot{I}_{ij}(t) = 0$ 和 $\\ddot{I}_{ij}(t) = 0$。\n领头阶引力波应变与 $\\ddot{I}_{ij}$ 成正比。因此，对于刚性旋转的轴对称物体，领头阶引力辐射为零。\n\n任务 B：来自非轴对称旋转体的引力波应变。\n\n现在我们考虑一个非轴对称的刚体，其中 $I'_{11} \\neq I'_{22}$。我们重复计算惯性参考系四极矩张量的分量。\n$I_{11}(t) = \\cos^2(\\Omega t) I'_{11} + \\sin^2(\\Omega t) I'_{22} = \\frac{I'_{11}+I'_{22}}{2} + \\frac{I'_{11}-I'_{22}}{2}\\cos(2\\Omega t)$\n$I_{22}(t) = \\sin^2(\\Omega t) I'_{11} + \\cos^2(\\Omega t) I'_{22} = \\frac{I'_{11}+I'_{22}}{2} - \\frac{I'_{11}-I'_{22}}{2}\\cos(2\\Omega t)$\n$I_{12}(t) = \\cos(\\Omega t)\\sin(\\Omega t)(I'_{11} - I'_{22}) = \\frac{I'_{11}-I'_{22}}{2}\\sin(2\\Omega t)$\n其他分量（$I_{33}$, $I_{13}$, $I_{23}$）保持恒定。对时间 $t$ 取二阶导数：\n$\\ddot{I}_{11}(t) = -(2\\Omega)^2 \\frac{I'_{11}-I'_{22}}{2}\\cos(2\\Omega t) = -2\\Omega^2(I'_{11}-I'_{22})\\cos(2\\Omega t)$\n$\\ddot{I}_{22}(t) = -(- (2\\Omega)^2) \\frac{I'_{11}-I'_{22}}{2}\\cos(2\\Omega t) = 2\\Omega^2(I'_{11}-I'_{22})\\cos(2\\Omega t) = -\\ddot{I}_{11}(t)$\n$\\ddot{I}_{12}(t) = -(2\\Omega)^2 \\frac{I'_{11}-I'_{22}}{2}\\sin(2\\Omega t) = -2\\Omega^2(I'_{11}-I'_{22})\\sin(2\\Omega t)$\n\n在横向无迹 (TT) 规范中，引力波应变由下式给出：\n$$\nh_{ij}^{\\mathrm{TT}}(t, \\mathbf{x}) = \\frac{2G}{c^4 R} \\ddot{I}_{ij}^{\\mathrm{TT}}(t_r)\n$$\n其中 $R$ 是到源的距离，$t_r = t - R/c$ 是推迟时间。对于这个源，一个最佳朝向的观测者位于旋转轴上（例如，沿 $\\hat{z}$ 轴）。对于这样的观测者，波在 $\\hat{z}$ 方向传播，所需的到横向平面（$xy$-平面）的投影使得 $i,j \\in \\{1,2\\}$ 的 $ij$ 分量保持不变。两种引力波偏振 $h_+$ 和 $h_\\times$ 通常定义为：\n$h_+(t_r) = h_{11}^{\\mathrm{TT}}(t_r) = \\frac{2G}{c^4 R}\\ddot{I}_{11}(t_r) = -\\frac{4G\\Omega^2(I'_{11}-I'_{22})}{c^4 R}\\cos(2\\Omega t_r)$\n$h_\\times(t_r) = h_{12}^{\\mathrm{TT}}(t_r) = \\frac{2G}{c^4 R}\\ddot{I}_{12}(t_r) = -\\frac{4G\\Omega^2(I'_{11}-I'_{22})}{c^4 R}\\sin(2\\Omega t_r)$\n应变振幅 $h$ 是信号的振幅。在这种圆偏振的情况下，它是恒定的：\n$$\nh = \\sqrt{h_+^2 + h_\\times^2} = \\frac{4G\\Omega^2 |I'_{11}-I'_{22}|}{c^4 R}\n$$\n问题将其与主转动惯量 $I_x, I_y, I_z$ 联系起来。转动惯量张量 $J_{ij}$ 与四极矩张量 $I_{ij}$ 的关系为 $J_{ij} = -I_{ij} + \\frac{1}{3}\\delta_{ij}\\sum_k J_{kk}$。在物体的主轴参考系中，$J'_{ij}$ 和 $I'_{ij}$ 都是对角的。主转动惯量为 $I_x = J'_{11}$，$I_y = J'_{22}$，$I_z = J'_{33}$。分量之间的关系为 $I_x = -I'_{11} + \\text{const}$，所以 $I_x - I_y = -I'_{11} - (-I'_{22}) = I'_{22} - I'_{11}$。因此， $|I'_{11}-I'_{22}|=|I_x-I_y|$。\n问题定义了 $\\Delta I = I_{xx} - I_{yy} = \\epsilon I_z$，其中这些是主转动惯量。所以，我们有 $|I'_{11}-I'_{22}| = \\Delta I = \\epsilon I_z$。\n将此代入应变振幅方程：\n$$\nh = \\frac{4G\\Omega^2 (\\epsilon I_z)}{c^4 R}\n$$\n最后，我们使用参数化 $I_z = k M a^2$：\n$$\nh = \\frac{4G k M a^2 \\Omega^2 \\epsilon}{c^4 R}\n$$\n这是应变振幅所需的表达式。对于实现，我们注意到角频率 $\\Omega$ 与以赫兹为单位的旋转频率 $f$ 的关系是 $\\Omega = 2\\pi f$。\n\n对于逆向计算，我们给定一个探测阈值 $h_{\\mathrm{det}}$，必须找到所需的最小椭率 $\\epsilon_{\\min}$。我们设 $h = h_{\\mathrm{det}}$ 并解出 $\\epsilon$：\n$$ h_{\\mathrm{det}} = \\frac{4G k M a^2 \\Omega^2 \\epsilon_{\\min}}{c^4 R} $$\n$$ \\epsilon_{\\min} = \\frac{h_{\\mathrm{det}} c^4 R}{4G k M a^2 \\Omega^2} $$\n这两个公式将在程序中实现。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the gravitational wave problem for the given test cases.\n    \"\"\"\n\n    # Physical constants in SI units\n    G = 6.67430e-11  # m^3 kg^-1 s^-2\n    c = 299792458.0   # m s^-1\n    \n    # Astronomical conversion factors\n    M_sun = 1.98847e30  # kg\n    pc = 3.0856775814913673e16  # m\n    kpc = 1e3 * pc\n    Mpc = 1e6 * pc\n\n    test_cases = [\n        # Case 1 (axisymmetric check: strain value)\n        {'type': 'compute_h', 'M_Msun': 1.4, 'a_m': 12000, 'k': 0.35, 'f_Hz': 600, 'R_kpc': 10, 'epsilon': 0},\n        # Case 2 (galactic, required ellipticity)\n        {'type': 'compute_epsilon', 'M_Msun': 1.4, 'a_m': 12000, 'k': 0.35, 'f_Hz': 600, 'R_kpc': 10, 'h_det': 1e-25},\n        # Case 3 (nearby extragalactic, high frequency, required ellipticity)\n        {'type': 'compute_epsilon', 'M_Msun': 1.4, 'a_m': 12000, 'k': 0.35, 'f_Hz': 1000, 'R_Mpc': 10, 'h_det': 1e-23},\n        # Case 4 (distant, lower frequency, heavier star, required ellipticity)\n        {'type': 'compute_epsilon', 'M_Msun': 2.0, 'a_m': 10000, 'k': 0.35, 'f_Hz': 100, 'R_Mpc': 100, 'h_det': 1e-22},\n        # Case 5 (nearby, explicit strain for small non-axisymmetry)\n        {'type': 'compute_h', 'M_Msun': 1.4, 'a_m': 12000, 'k': 0.35, 'f_Hz': 1000, 'R_kpc': 1, 'epsilon': 1e-6},\n    ]\n\n    def compute_h(epsilon, k, M, a, Omega, R):\n        \"\"\"\n        Computes the gravitational-wave strain amplitude h.\n        h = (4 * G * k * M * a^2 * Omega^2 * epsilon) / (c^4 * R)\n        \"\"\"\n        # Since epsilon=0 guarantees h=0, handle this to avoid potential division by zero if R=0 (not in tests)\n        if epsilon == 0:\n            return 0.0\n            \n        numerator = 4.0 * G * k * M * (a**2) * (Omega**2) * epsilon\n        denominator = (c**4) * R\n        return numerator / denominator\n\n    def compute_epsilon(h_det, k, M, a, Omega, R):\n        \"\"\"\n        Computes the minimum ellipticity epsilon_min for a given strain h_det.\n        epsilon_min = (h_det * c^4 * R) / (4 * G * k * M * a^2 * Omega^2)\n        \"\"\"\n        numerator = h_det * (c**4) * R\n        denominator = 4.0 * G * k * M * (a**2) * (Omega**2)\n        return numerator / denominator\n\n    results = []\n    for case in test_cases:\n        # Convert all inputs to SI units\n        M = case['M_Msun'] * M_sun\n        a = float(case['a_m'])\n        k = float(case['k'])\n        f = float(case['f_Hz'])\n        Omega = 2.0 * np.pi * f\n        \n        if 'R_kpc' in case:\n            R = float(case['R_kpc']) * kpc\n        elif 'R_Mpc' in case:\n            R = float(case['R_Mpc']) * Mpc\n\n        if case['type'] == 'compute_h':\n            epsilon = float(case['epsilon'])\n            result = compute_h(epsilon, k, M, a, Omega, R)\n        elif case['type'] == 'compute_epsilon':\n            h_det = float(case['h_det'])\n            result = compute_epsilon(h_det, k, M, a, Omega, R)\n        \n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3494604"}, {"introduction": "在知道了产生引力波的物理条件后，我们面临一个实际的计算挑战：如何在弯曲的、动态的时空中准确计算四极矩？这个问题在数值相对论中至关重要，因为我们选择的坐标系（即“规范”）不应影响物理结果。本练习将引导你对比两种计算四极矩的方法，从而深刻理解规范不变性原理以及在数值积分中正确使用固有体积元的重要性 [@problem_id:3494602]。", "problem": "在广义相对论的 3+1 形式下，对单一类空超曲面上的无迹物质四极张量 $I_{ij}$，实现、分析并比较两种体积分构造方法。仅使用来自 3+1 分解和守恒 Valencia 变量的第一性原理和核心定义：守恒质量密度 $D=\\rho W$（其中 $\\rho$ 为静止质量密度，$W$ 为洛伦兹因子）、动量密度 $S_i$ 和能量变量 $\\tau$。在 $G=c=1$ 的几何单位制下进行计算，因此所有量均为无量纲。目标是通过在合成的动力学时空上进行显式计算，证明一个由守恒变量和固有体积元构造的规范不变四极积分在空间规范扭曲下是稳健的，而朴素坐标矩则不然。\n\n推导的基本依据：\n- 在 3+1 分解中，时空被叶状剖分成类空超曲面，其空间度规为 $\\gamma_{ij}$，行列式为 $\\gamma=\\det(\\gamma_{ij})$，固有体积元为 $\\sqrt{\\gamma}\\, d^3x$。\n- 守恒变量遵循通量守恒形式，其中总重子质量和总能量分别是 $\\sqrt{\\gamma} D$ 和 $\\sqrt{\\gamma}(D+\\tau)$ 的积分。特别地，重子质量为 $M_b=\\int \\sqrt{\\gamma} D\\, d^3x$，由于 $\\sqrt{\\gamma}\\, d^3x$ 是超曲面上的固有体积元，该值在空间坐标变换下是不变的。\n- 为了构造一个适用于四极矩公式的物质四极矩，我们在慢运动极限下使用有效能量密度 $\\rho_{\\mathrm{eff}}=D+\\tau$，并通过减去其迹部分来定义一个无迹四极张量。领头阶能量源依赖于 $D$ 和 $\\tau$，而 $S_i$ 进入动力学演化，但在领头阶上不进入瞬时能量密度积分。\n\n您必须在立方体域 $[-L,L]^3$ 上实现两种构造：\n1. 一种基于固有体积加权能量密度 $\\sqrt{\\gamma}(D+\\tau)$ 的规范不变四极积分 $I_{ij}^{\\mathrm{GI}}$。通过 $X_i^{\\mathrm{GI}}=\\left(\\int \\sqrt{\\gamma}(D+\\tau) x_i\\, d^3x\\right)\\Big/\\left(\\int \\sqrt{\\gamma}(D+\\tau)\\, d^3x\\right)$ 定义质心，然后计算\n$$\nI_{ij}^{\\mathrm{GI}}=\\int \\sqrt{\\gamma}(D+\\tau)\\left[(x_i-X_i^{\\mathrm{GI}})(x_j-X_j^{\\mathrm{GI}})-\\frac{1}{3}\\delta_{ij}\\, r^2\\right]\\, d^3x,\n$$\n其中 $r^2=(x_k-X_k^{\\mathrm{GI}})(x_k-X_k^{\\mathrm{GI}})$ 且 $\\delta_{ij}$ 是克罗内克 δ。\n2. 一种朴素坐标四极矩 $I_{ij}^{\\mathrm{N}}$，通过忽略固有体积元并仅使用坐标体积进行积分来计算。定义 $X_i^{\\mathrm{N}}=\\left(\\int (D+\\tau) x_i\\, d^3x\\right)\\Big/\\left(\\int (D+\\tau)\\, d^3x\\right)$ 并且\n$$\nI_{ij}^{\\mathrm{N}}=\\int (D+\\tau)\\left[(x_i-X_i^{\\mathrm{N}})(x_j-X_j^{\\mathrm{N}})-\\frac{1}{3}\\delta_{ij}\\, r^2\\right]\\, d^3x,\n$$\n其中 $r^2=(x_k-X_k^{\\mathrm{N}})(x_k-X_k^{\\mathrm{N}})$。\n\n合成时空和物质场：\n- 使用共形平直空间度规 $\\gamma_{ij}=\\psi^4 \\delta_{ij}$，因此 $\\sqrt{\\gamma}=\\psi^6$。设 $\\psi(\\mathbf{x})=1+\\varepsilon \\sin(k x)\\sin(k y)\\sin(k z)$，其中 $\\varepsilon$ 是小的规范扭曲振幅，$k=\\pi/L$ 是波数，并确保 $\\psi>0$。\n- 通过球对称高斯分布 $\\rho_{\\mathrm{phys}}(\\mathbf{x})=\\rho_0 \\exp\\left(-\\frac{x^2+y^2+z^2}{\\sigma^2}\\right)$ 来规定物理物质分布。\n- 构造守恒变量 $D(\\mathbf{x})$ 和 $\\tau(\\mathbf{x})$，使得固有体积加权的有效能量密度 $\\sqrt{\\gamma}(D+\\tau)$ 等于 $(1+\\beta)\\rho_{\\mathrm{phys}}(\\mathbf{x})$，且与所选的空间规范无关。一个简单且物理上自洽的选择是 $D(\\mathbf{x})=\\rho_{\\mathrm{phys}}(\\mathbf{x})/\\sqrt{\\gamma}(\\mathbf{x})$ 和 $\\tau(\\mathbf{x})=\\beta\\, \\rho_{\\mathrm{phys}}(\\mathbf{x})/\\sqrt{\\gamma}(\\mathbf{x})$，其中常数 $\\beta\\ge 0$。动量密度 $S_i(\\mathbf{x})$ 在至少一个测试中应为非零以表示动力学；对于小速度和接近于 1 的比焓，设置 $S_i=D\\, v_i$，其中 $v_i$ 是一个无散旋涡，例如 $\\mathbf{v}(\\mathbf{x})=v_0(-y,x,0)$，其中 $v_0$ 很小，因此 $W\\approx 1$。\n- 所有积分必须通过在覆盖 $[-L,L]^3$ 的均匀网格上进行黎曼和来数值计算。\n\n角度单位不适用。所有计算量均以 $G=c=1$ 的几何单位制表示。测试套件的最终答案必须表示为浮点数。\n\n测试套件：\n- 情况 1（理想情况，平直规范）：$L=5$, $\\rho_0=1$, $\\sigma=1.2$, $\\varepsilon=0$, $\\beta=0$, $v_0=0$。\n- 情况 2（规范扭曲，能量仅来自静止质量）：$L=5$, $\\rho_0=1$, $\\sigma=1.2$, $\\varepsilon=0.3$, $\\beta=0$, $v_0=0$。\n- 情况 3（更强的规范扭曲，非零的内能/动能和动量）：$L=5$, $\\rho_0=1$, $\\sigma=1.2$, $\\varepsilon=0.4$, $\\beta=0.2$, $v_0=0.05$。\n\n对于每种情况，计算 $I_{ij}^{\\mathrm{GI}}$ 和 $I_{ij}^{\\mathrm{N}}$，然后报告一个单一的标量诊断量：它们差值的弗罗贝尼乌斯范数，\n$$\n\\Delta=\\left\\|I^{\\mathrm{GI}}-I^{\\mathrm{N}}\\right\\|_F=\\sqrt{\\sum_{i,j=1}^3 \\left(I_{ij}^{\\mathrm{GI}}-I_{ij}^{\\mathrm{N}}\\right)^2}.\n$$\n您的程序应生成单行输出，其中包含三个结果，格式为方括号括起来的逗号分隔列表（例如 $[d_1,d_2,d_3]$），其中 $d_1$、$d_2$ 和 $d_3$ 分别是情况 1、2 和 3 计算出的 $\\Delta$ 值。", "solution": "该问题经评估为 **有效**。它在科学上基于广义相对论和数值相对论的原理，特别是 3+1 形式和引力波源的计算。该问题定义明确、客观、自成体系，并描述了一个标准的（尽管是简化的）数值实验，用于测试和验证数值相对论代码中的概念。不存在矛盾、歧义或事实性错误。\n\n核心任务是展示物理可观测量计算中的规范不变性原理。在广义相对论中，坐标系的选择是任意的（一种“规范”选择）。物理量，例如质能分布的多极矩，必须不依赖于这种选择。该问题涉及与引力辐射相关的最低阶、非平凡的多极矩：无迹质量四极矩 $I_{ij}$。\n\n在时空的 3+1 分解中，一个类空超曲面（一个恒定时间的“切片”）的几何由空间度规 $\\gamma_{ij}$ 描述。该超曲面上的不变量体积测度是固有体积元 $d\\mathcal{V} = \\sqrt{\\gamma}\\, d^3x$，其中 $\\gamma = \\det(\\gamma_{ij})$，$d^3x$ 是坐标体积元。为了计算像重子质量 $M_b$ 这样的总规范不变量，必须将相应的密度在固有体积上积分：$M_b = \\int D \\sqrt{\\gamma}\\, d^3x$，其中 $D$ 是守恒质量密度。该问题通过对比正确使用固有体积元的“规范不变”构造 $I_{ij}^{\\mathrm{GI}}$ 和错误使用坐标体积元的“朴素”构造 $I_{ij}^{\\mathrm{N}}$ 来检验这一原理。\n\n该问题定义了一个具有共形平直度规 $\\gamma_{ij} = \\psi^4 \\delta_{ij}$ 的合成时空，其中 $\\psi$ 是共形因子，$\\delta_{ij}$ 是克罗内克 δ。因此，固有体积因子是 $\\sqrt{\\gamma} = \\det(\\psi^2 \\delta_{ij}) = \\psi^6$。规范自由度被编码在 $\\psi$ 的选择中。平直欧几里得空间对应于 $\\psi=1$，而非平凡的 $\\psi(\\mathbf{x})$ 代表一个扭曲的坐标系。该问题指定了 $\\psi(\\mathbf{x}) = 1 + \\varepsilon \\sin(k x)\\sin(k y)\\sin(k z)$，其中 $\\varepsilon$ 控制规范扭曲的大小。\n\n物理源是精心构造的。“真实”的物理能量分布被假定为 $(1+\\beta)\\rho_{\\mathrm{phys}}$，其中 $\\rho_{\\mathrm{phys}}$ 是一个球对称高斯分布。为了确保规范不变积分能够恢复这一物理现实，守恒变量 $D$ 和 $\\tau$ 的定义使得规范不变方法的被积函数 $\\sqrt{\\gamma}(D+\\tau)$ 精确等于 $(1+\\beta)\\rho_{\\mathrm{phys}}$。这是通过设置 $D = \\rho_{\\mathrm{phys}}/\\sqrt{\\gamma}$ 和 $\\tau = \\beta\\rho_{\\mathrm{phys}}/\\sqrt{\\gamma}$ 来实现的。\n\n1.  规范不变构造 ($I_{ij}^{\\mathrm{GI}}$)：要积分的有效能量密度是 $\\rho_{\\mathrm{eff,GI}} = \\sqrt{\\gamma}(D+\\tau) = (1+\\beta)\\rho_{\\mathrm{phys}}(\\mathbf{x})$。根据构造，该密度是球对称的。质心 $X_i^{\\mathrm{GI}}$ 是通过对 $\\rho_{\\mathrm{eff,GI}} x_i$ 进行体积分计算得到的。由于 $\\rho_{\\mathrm{eff,GI}}$ 的球对称性，质心将位于原点，即 $X_i^{\\mathrm{GI}} = (0,0,0)$。无迹四极张量则为 $I_{ij}^{\\mathrm{GI}}=\\int \\rho_{\\mathrm{eff,GI}}\\left(x_i x_j-\\frac{1}{3}\\delta_{ij} r^2\\right)\\, d^3x$。同样，由于球对称性，对于 $i \\ne j$ 的项如 $x_i x_j$ 的积分为零，而对角线分量的积分会相互抵消，导致对所有 $i,j$ 都有 $I_{ij}^{\\mathrm{GI}}=0$。这个解析结果将通过数值方法进行检验。\n\n2.  朴素构造 ($I_{ij}^{\\mathrm{N}}$)：此方法的有效能量密度为 $\\rho_{\\mathrm{eff,N}} = (D+\\tau) = (1+\\beta)\\rho_{\\mathrm{phys}}(\\mathbf{x})/\\sqrt{\\gamma}(\\mathbf{x})$。当存在规范扭曲时（$\\varepsilon \\ne 0$），$\\sqrt{\\gamma} = \\psi^6$ 不是球对称的。因此，$\\rho_{\\mathrm{eff,N}}$ 也不是球对称的。这种对称性的缺失意味着计算出的质心 $X_i^{\\mathrm{N}}$ 将会偏离原点，并且得到的四极张量 $I_{ij}^{\\mathrm{N}}$ 将具有非零分量。这个非零结果纯粹是坐标系的人为产物——一种“规范效应”——并不代表物理上的四极矩。\n\n数值实现将按以下步骤进行：- 将计算域 $[-L,L]^3$ 离散化为一个 $N \\times N \\times N$ 点的均匀网格。选择 $N=101$ 以确保网格点位于原点。- 对于每个测试用例，在每个网格点上计算物理场（$\\psi$, $\\sqrt{\\gamma}$, $\\rho_{\\mathrm{phys}}$）。- 构造两种有效能量密度 $\\rho_{\\mathrm{eff,GI}}$ 和 $\\rho_{\\mathrm{eff,N}}$。- 定义一个通用函数，用于计算网格上任意给定密度分布的无迹四极张量。该函数首先计算给定分布的总质能和质心。然后，通过在网格上执行黎曼和，计算对称无迹张量 $I_{ij}$ 的六个独立分量。- 对 $\\rho_{\\mathrm{eff,GI}}$ 和 $\\rho_{\\mathrm{eff,N}}$ 调用此函数，以获得矩阵 $I^{\\mathrm{GI}}$ 和 $I^{\\mathrm{N}}$。- 最后，计算它们差值的弗罗贝尼乌斯范数 $\\Delta = \\left\\|I^{\\mathrm{GI}} - I^{\\mathrm{N}}\\right\\|_F$。\n\n预期结果是，对于情况 1（$\\varepsilon = 0$），$\\rho_{\\mathrm{eff,GI}} = \\rho_{\\mathrm{eff,N}}$，所以 $\\Delta$ 在数值上将为零。对于情况 2 和 3（$\\varepsilon \\ne 0$），$\\rho_{\\mathrm{eff,GI}} \\ne \\rho_{\\mathrm{eff,N}}$，导致 $I^{\\mathrm{GI}} \\approx 0$ 但 $I^{\\mathrm{N}} \\ne 0$，从而得到一个非零的 $\\Delta$。这将从数值上证实 $I^{\\mathrm{GI}}$ 对规范扭曲是稳健的，而 $I^{\\mathrm{N}}$ 不是。", "answer": "```python\nimport numpy as np\n\ndef compute_trace_free_quadrupole(integrand, xx, yy, zz, dV_coord):\n    \"\"\"\n    Computes the trace-free quadrupole tensor for a given density distribution.\n\n    Args:\n        integrand (np.ndarray): The 3D array of the density distribution (e.g., rho_eff).\n        xx, yy, zz (np.ndarray): 3D coordinate grids.\n        dV_coord (float): The coordinate volume element dx*dy*dz.\n\n    Returns:\n        np.ndarray: The 3x3 trace-free quadrupole tensor.\n    \"\"\"\n    # Total mass-energy for the given distribution\n    M_total = np.sum(integrand) * dV_coord\n    \n    if M_total  1e-15:  # Avoid division by zero for negligible mass\n        return np.zeros((3, 3))\n\n    # Center of Mass (CoM) calculation\n    coords = [xx, yy, zz]\n    X_com = np.zeros(3)\n    for i in range(3):\n        X_com[i] = (np.sum(integrand * coords[i]) * dV_coord) / M_total\n\n    # Shifted coordinates relative to the CoM\n    xx_p = xx - X_com[0]\n    yy_p = yy - X_com[1]\n    zz_p = zz - X_com[2]\n    \n    coords_p = [xx_p, yy_p, zz_p]\n\n    # Squared distance from the CoM\n    r2_p = xx_p**2 + yy_p**2 + zz_p**2\n\n    # Compute the trace-free quadrupole tensor components\n    I_ij = np.zeros((3, 3))\n    for i in range(3):\n        for j in range(i, 3):  # Exploit symmetry I_ij = I_ji\n            moment_arm = coords_p[i] * coords_p[j]\n            if i == j:\n                moment_arm -= (1.0 / 3.0) * r2_p\n            \n            integral_val = np.sum(integrand * moment_arm) * dV_coord\n            I_ij[i, j] = integral_val\n            if i != j:\n                I_ij[j, i] = integral_val\n                \n    return I_ij\n\n\ndef solve():\n    \"\"\"\n    Main function to run the test cases and compute the diagnostic Delta.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (L, rho0, sigma, epsilon, beta, v0)\n        (5.0, 1.0, 1.2, 0.0, 0.0, 0.0),\n        (5.0, 1.0, 1.2, 0.3, 0.0, 0.0),\n        (5.0, 1.0, 1.2, 0.4, 0.2, 0.05),\n    ]\n\n    # Numerical grid resolution\n    N = 101 # Odd number to have a point at the origin\n\n    results = []\n    for case in test_cases:\n        L, rho0, sigma, eps, beta, v0 = case\n\n        # Set up the computational grid\n        x = np.linspace(-L, L, N)\n        y = np.linspace(-L, L, N)\n        z = np.linspace(-L, L, N)\n        dx = x[1] - x[0]\n        dy = y[1] - y[0]\n        dz = z[1] - z[0]\n        dV_coord = dx * dy * dz\n        xx, yy, zz = np.meshgrid(x, y, z, indexing='ij')\n\n        # Calculate physical fields on the grid\n        k = np.pi / L\n        # Conformal factor psi\n        psi = 1.0 + eps * np.sin(k * xx) * np.sin(k * yy) * np.sin(k * zz)\n        # Proper volume element factor sqrt(gamma)\n        sqrt_gamma = psi**6\n        \n        # Physical rest-mass density profile\n        r_sq = xx**2 + yy**2 + zz**2\n        rho_phys = rho0 * np.exp(-r_sq / (sigma**2))\n\n        # 1. Gauge-Invariant (GI) calculation\n        # The effective energy density for the GI integral is spherically symmetric.\n        # rho_eff_GI = sqrt(gamma) * (D + tau) = (1 + beta) * rho_phys\n        rho_eff_GI = (1.0 + beta) * rho_phys\n        I_GI = compute_trace_free_quadrupole(rho_eff_GI, xx, yy, zz, dV_coord)\n\n        # 2. Naive (N) calculation\n        # The effective energy density for the naive integral is distorted by the gauge.\n        # rho_eff_N = D + tau = (1 + beta) * rho_phys / sqrt(gamma)\n        rho_eff_N = (1.0 + beta) * rho_phys / sqrt_gamma\n        I_N = compute_trace_free_quadrupole(rho_eff_N, xx, yy, zz, dV_coord)\n\n        # 3. Compute the diagnostic: Frobenius norm of the difference\n        delta = np.linalg.norm(I_GI - I_N, 'fro')\n        results.append(delta)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3494602"}, {"introduction": "我们已经探讨了引力波辐射的物理起源和在弯曲时空中计算其源（四极矩）的正确方法。最后一步是将这个源项与我们实际可观测的引力波应变 $h(t)$ 联系起来。本练习将模拟从数值模拟数据中提取引力波信号的完整流程，通过对离散时间序列数据进行数值微分，最终应用四极矩公式计算出引力波波形 [@problem_id:3494590]。", "problem": "一项数值相对论任务要求您基于线性化广义相对论 (LGR) 的第一性原理和远场近似，从点质量的离散模拟数据中实现引力波四极矩的提取。您将从洛伦兹规范下的线性化爱因斯坦方程的推迟解以及能量-动量守恒出发，必须推导并实现一种计算方法，从致密源的质量四极矩的时间二阶导数中提取横向无迹 (TT) 引力波应变。所有物理量必须使用国际单位制 (SI)。所有角度量均以弧度为单位。需要报告的最终可观测量是引力波应变的加号偏振，它是无量纲的。您必须将最终的数值答案表示为无量纲的浮点数值。\n\n给定一个由 $N$ 个点质量组成的系统，其质量为 $\\{m_a\\}_{a=1}^{N}$，位置为离散时间序列 $\\{\\mathbf{x}_a(t_k)\\}_{k=0}^{K-1}$，时间步长均匀为 $\\Delta t$。您需要：\n\n- 使用质能守恒和 LGR 中的远场场结构来论证，主要的辐射贡献被编码在无迹质量四极矩张量 $I_{ij}(t)$ 的时间二阶导数中，其中该张量由源密度定义为坐标的无迹双线性形式的空间积分。对于点质量，这简化为对所有物体的离散求和。\n- 使用均匀时间网格上的中心差分，构建一个对 $I_{ij}(t)$ 的时间二阶导数的稳定、二阶精度的有限差分近似，该近似在索引 $k=1,\\dots,K-2$ 上有效。\n- 对于位于辐射区距离 $R$ 处、沿 $\\hat{\\mathbf{z}}$ 方向的观测者，执行适当的横向无迹投影。将其与推导出的远场标度关系结合，以获得在 $k=1,\\dots,K-2$ 上的加号偏振应变时间序列 $h_{+}(t_k)$。假设在有限采样区间上提取振幅时，由 $R/c$ 引起的推迟时间平移可以忽略不计。\n- 对于每个测试用例，计算在有效索引 $k=1,\\dots,K-2$ 上的最大绝对值 $\\max_{k} |h_{+}(t_k)|$。\n\n所有计算必须使用 SI 单位。将最终输出报告为无量纲数。\n\n您可以无需重复证明即可使用的基本依据包括：洛伦兹规范下的线性化爱因斯坦方程及其推迟格林函数解，质量四极矩张量 $I_{ij}(t)$ 的定义，即 $\\int \\rho(\\mathbf{x},t)\\,x_i x_j\\,d^3x$ 的无迹部分，孤立系统的总质量守恒和质心守恒，以及由单位观测方向 $\\hat{\\mathbf{n}}$ 的空间投影算子 $P_{ij}=\\delta_{ij}-\\hat{n}_i \\hat{n}_j$ 构建的横向无迹 (TT) 投影算子的定义和性质。\n\n您必须遵守的数值细节：\n\n- 在每个时间 $t_k$ 通过对形如 $m_a\\,(x_{a,i} x_{a,j} - \\tfrac{1}{3}\\delta_{ij}\\,|\\mathbf{x}_a|^2)$ 的贡献求和，来计算点质量的无迹质量四极矩张量。\n- 使用中心有限差分格式来近似时间二阶导数\n$$\n\\frac{d^2 I_{ij}}{dt^2}(t_k)\\approx\\frac{I_{ij}(t_{k+1})-2\\,I_{ij}(t_k)+I_{ij}(t_{k-1})}{(\\Delta t)^2},\n$$\n对 $k=1,\\dots,K-2$ 有效。\n- 对于沿 $\\hat{\\mathbf{z}}$ 方向的观测者，从该方向上的 TT 投影辐射场中提取加号偏振。使用与距离 $R$ 和基本常数 $G$ 和 $c$ 相关的远场标度关系。\n\n测试套件和数据生成：\n\n实现您的程序以生成以下三个源模型，每个模型都是一组点质量，具有均匀采样的时间序列 $\\{t_k\\}_{k=0}^{K-1}$，时间间隔为 $\\Delta t$。在所有情况下，观测者都位于距离 $R$ 处、沿 $\\hat{\\mathbf{z}}$ 方向，您必须为每种情况报告单个数值 $\\max_k|h_{+}(t_k)|$。\n\n- 情况 A (理想情况；$x$–$y$ 平面内的等质量圆形双星)：\n  - 两个相等质量 $m_1=m_2=M$，其中 $M=1.4\\,M_{\\odot}$，$M_{\\odot}=1.98847\\times 10^{30}\\,\\mathrm{kg}$。使用 $G=6.67430\\times 10^{-11}\\,\\mathrm{m^3\\,kg^{-1}\\,s^{-2}}$ 和 $c=2.99792458\\times 10^{8}\\,\\mathrm{m\\,s^{-1}}$。\n  - 每个质量体在 $x$–$y$ 平面内绕原点做半径为 $a=1.0\\times 10^{8}\\,\\mathrm{m}$ 的圆形轨道运动，角频率为 $\\omega=\\sqrt{G (m_1+m_2)/(2a)^3}$。\n  - 将运动参数化为 $\\mathbf{x}_1(t)=(a\\cos(\\omega t),\\,a\\sin(\\omega t),\\,0)$ 和 $\\mathbf{x}_2(t)=-\\mathbf{x}_1(t)$，其中 $t\\in\\{0,\\Delta t,2\\Delta t,\\dots,(K-1)\\Delta t\\}$。\n  - 使用 $K=4096$，$\\Delta t=1.0\\,\\mathrm{s}$，观测距离 $R=1.0\\times 10^{21}\\,\\mathrm{m}$。\n\n- 情况 B (边界情况；静态构型无辐射)：\n  - 两个相等质量 $m_1=m_2=M$，其中 $M$ 和其他常数与上述相同。\n  - 位置不随时间变化，对于所有 $t$，$\\mathbf{x}_1(t)=(a,\\,0,\\,0)$ 且 $\\mathbf{x}_2(t)=(-a,\\,0,\\,0)$，其中 $a=1.0\\times 10^{8}\\,\\mathrm{m}$。\n  - 使用 $K=128$，$\\Delta t=1.0\\,\\mathrm{s}$，以及 $R=1.0\\times 10^{21}\\,\\mathrm{m}$。\n\n- 情况 C (覆盖非圆形动力学；沿 $x$ 轴的对称正碰振荡)：\n  - 两个相等质量 $m_1=m_2=M$，其中 $M$ 和其他常数与上述相同。\n  - 位置为 $\\mathbf{x}_1(t)=(A\\cos(\\omega t),\\,0,\\,0)$ 和 $\\mathbf{x}_2(t)=(-A\\cos(\\omega t),\\,0,\\,0)$，其中 $A=1.0\\times 10^{8}\\,\\mathrm{m}$，$\\omega=2.0\\times 10^{-2}\\,\\mathrm{rad\\,s^{-1}}$。\n  - 使用 $K=2048$，$\\Delta t=0.5\\,\\mathrm{s}$，以及 $R=1.0\\times 10^{21}\\,\\mathrm{m}$。\n\n算法规范：\n\n- 在每个 $k$ 处，通过对所有物体的无迹点质量贡献求和来构建 $I_{ij}(t_k)$。\n- 对于 $k=1,\\dots,K-2$，使用中心有限差分公式计算其时间二阶导数。\n- 对于沿 $\\hat{\\mathbf{z}}$ 方向的观测者，应用适当的 TT 提取方法，以在有效的 $k$ 上获得 $h_{+}(t_k)$。\n- 对于每种情况，返回单个浮点数 $\\max_{k=1,\\dots,K-2}|h_{+}(t_k)|$。\n\n最终输出格式：\n\n- 您的程序应生成单行输出，其中包含三个结果，格式为方括号括起来的逗号分隔列表，顺序为 [情况 A 结果, 情况 B 结果, 情况 C 结果]。将每个浮点数以科学记数法表示，小数点后恰好有 $10$ 位数字。例如：$[\\texttt{1.2345678901e-12},\\texttt{0.0000000000e+00},\\texttt{9.8765432100e-09}]$。\n\n所有输出都是引力波应变 $h_{+}$，它们是无量纲的。角度以弧度为单位。时间以秒为单位。质量以千克为单位。长度以米为单位。", "solution": "我们从洛伦兹规范下的线性化广义相对论 (LGR) 开始，其度规为 $g_{\\mu\\nu}=\\eta_{\\mu\\nu}+h_{\\mu\\nu}$，其中 $|h_{\\mu\\nu}|\\ll 1$。对于迹反转势 $\\bar{h}_{\\mu\\nu}=h_{\\mu\\nu}-\\tfrac{1}{2}\\eta_{\\mu\\nu} h$，有 $\\partial^{\\mu}\\bar{h}_{\\mu\\nu} = 0$。线性化场方程为\n$$\n\\square \\bar{h}_{\\mu\\nu} = -\\frac{16\\pi G}{c^4} T_{\\mu\\nu},\n$$\n其推迟格林函数解为\n$$\n\\bar{h}_{\\mu\\nu}(t,\\mathbf{x}) = \\frac{4G}{c^4}\\int \\frac{T_{\\mu\\nu}(t-|\\mathbf{x}-\\mathbf{x}'|/c,\\mathbf{x}')}{|\\mathbf{x}-\\mathbf{x}'|}\\,d^3x'.\n$$\n在远场（辐射区），$|\\mathbf{x}|\\equiv R\\gg$ 源尺寸，按 $1/R$ 展开是合理的。对于具有守恒能量-动量 $\\partial_{\\mu}T^{\\mu\\nu}=0$ 的孤立源，主要含时辐射多极矩是质量四极矩；由于质量和线性动量守恒，单极和偶极贡献不产生辐射。引入质量四极矩张量 (无迹) 为\n$$\nI_{ij}(t) = \\int \\rho(t,\\mathbf{x})\\left(x_i x_j - \\frac{1}{3}\\delta_{ij} r^2\\right)\\,d^3x, \\quad r^2 = x_k x_k,\n$$\n对于位于 $\\mathbf{x}_a(t)$ 的一组点质量，这简化为离散求和\n$$\nI_{ij}(t) = \\sum_{a=1}^{N} m_a\\left[x_{a,i}(t) x_{a,j}(t) - \\frac{1}{3}\\delta_{ij} |\\mathbf{x}_a(t)|^2\\right].\n$$\n在横向无迹 (TT) 规范中，领头阶的远场度规微扰由标准四极矩公式给出，\n$$\nh_{ij}^{\\mathrm{TT}}(t,\\mathbf{x}) = \\frac{2G}{c^4 R}\\,\\Lambda_{ij,kl}(\\hat{\\mathbf{n}})\\,\\frac{d^2 I_{kl}}{dt^2}\\Big(t-\\frac{R}{c}\\Big),\n$$\n其中 $\\hat{\\mathbf{n}}=\\mathbf{x}/R$ 是指向观测者的单位方向，$\\Lambda_{ij,kl}(\\hat{\\mathbf{n}})=P_{ik}P_{jl}-\\tfrac{1}{2}P_{ij}P_{kl}$，而 $P_{ij}=\\delta_{ij}-\\hat{n}_i \\hat{n}_j$ 是与 $\\hat{\\mathbf{n}}$ 正交的空间投影算子。对于沿 $\\hat{\\mathbf{z}}$ 方向的观测者，有 $P_{ij}=\\mathrm{diag}(1,1,0)$，并且由 $h_{+}=\\tfrac{1}{2}(h_{xx}^{\\mathrm{TT}}-h_{yy}^{\\mathrm{TT}})$ 和 $h_{\\times}=h_{xy}^{\\mathrm{TT}}$ 定义的偏振分量简化为以下特别简单的形式\n$$\nh_{+}(t) = \\frac{G}{c^4 R}\\left(\\frac{d^2 I_{xx}}{dt^2}-\\frac{d^2 I_{yy}}{dt^2}\\right)\\Bigg|_{t-R/c}, \\quad\nh_{\\times}(t) = \\frac{2G}{c^4 R}\\,\\frac{d^2 I_{xy}}{dt^2}\\Bigg|_{t-R/c}.\n$$\n对于在有限采样区间上的振幅提取，推迟平移 $R/c$ 仅在时间上平移波形，而不会改变最大绝对振幅；因此，我们在采样时间点上求导，并在有效索引上评估最大值。\n\n离散算法设计：\n\n- 通过上述离散求和，为每个采样时间 $t_k$ 从点质量构建 $I_{ij}(t_k)$。由于 $I_{ij}$ 在构造上是无迹的，因此无需进一步的去迹操作。\n- 通过中心差分来近似时间二阶导数\n$$\nI_{ij}''(t_k)\\approx\\frac{I_{ij}(t_{k+1})-2\\,I_{ij}(t_k)+I_{ij}(t_{k-1})}{(\\Delta t)^2}, \\quad k=1,\\dots,K-2,\n$$\n该方法对 $\\Delta t$ 是二阶精度的，并且对于平滑信号是稳定的。\n- 对于沿 $\\hat{\\mathbf{z}}$ 方向的观测者，计算\n$$\nh_{+}(t_k) = \\frac{G}{c^4 R}\\left[I_{xx}''(t_k) - I_{yy}''(t_k)\\right], \\quad k=1,\\dots,K-2.\n$$\n- 返回 $\\max_{k=1,\\dots,K-2}|h_{+}(t_k)|$。\n\n用于验证的解析期望：\n\n- 情况 A (等质量圆形双星)，两个质量为 $M=1.4\\,M_{\\odot}$ 的物体在 $x$–$y$ 平面内绕原点做半径为 $a=1.0\\times 10^{8}\\,\\mathrm{m}$ 的圆形轨道运动，角频率为 $\\omega=\\sqrt{G(2M)/(2a)^3}$，得到\n$$\nI_{xx}(t)-I_{yy}(t) = 2 M a^2 \\cos(2\\omega t),\n$$\n所以\n$$\n\\frac{d^2}{dt^2}\\left(I_{xx}-I_{yy}\\right) = -8 M a^2 \\omega^2 \\cos(2\\omega t),\n$$\n因此\n$$\nh_{+}(t) = -\\frac{8 G M a^2 \\omega^2}{c^4 R}\\cos(2\\omega t).\n$$\n最大绝对振幅为\n$$\n\\max|h_{+}|=\\frac{8 G M a^2 \\omega^2}{c^4 R}.\n$$\n使用 $M=1.4\\times 1.98847\\times 10^{30}\\,\\mathrm{kg}$, $a=1.0\\times 10^{8}\\,\\mathrm{m}$, $R=1.0\\times 10^{21}\\,\\mathrm{m}$, $G=6.67430\\times 10^{-11}\\,\\mathrm{SI}$, $c=2.99792458\\times 10^{8}\\,\\mathrm{m\\,s^{-1}}$ 以及 $\\omega=\\sqrt{G(2M)/(2a)^3}$，数值计算结果约为 $\\sim 8.5\\times 10^{-23}$。\n\n- 情况 B (静态构型) 的 $I_{ij}(t)$ 不随时间变化，因此 $I_{ij}''(t)=0$，所以 $h_{+}(t)\\equiv 0$，在精确计算中最大值为 $0$，在给定恒定数据的情况下，数值上为机器精度下的 $0$。\n\n- 情况 C (对称正碰振荡) 中，$\\mathbf{x}_1(t)=(A\\cos(\\omega t),0,0)$，$\\mathbf{x}_2(t)=(-A\\cos(\\omega t),0,0)$，给出\n$$\nI_{xx}(t)-I_{yy}(t) = \\sum_a m_a x_a^2 - \\sum_a m_a (0) = 2 M A^2 \\cos^2(\\omega t) = M A^2\\left[1+\\cos(2\\omega t)\\right],\n$$\n所以\n$$\n\\frac{d^2}{dt^2}\\left(I_{xx}-I_{yy}\\right) = -4 M A^2 \\omega^2 \\cos(2\\omega t),\n$$\n因此\n$$\nh_{+}(t) = -\\frac{4 G M A^2 \\omega^2}{c^4 R}\\cos(2\\omega t),\n$$\n最大绝对振幅为\n$$\n\\max|h_{+}|=\\frac{4 G M A^2 \\omega^2}{c^4 R}.\n$$\n使用 $A=1.0\\times 10^{8}\\,\\mathrm{m}$, $\\omega=2.0\\times 10^{-2}\\,\\mathrm{rad\\,s^{-1}}$ 以及与上述相同的 $M, G, c, R$，数值计算结果约为 $\\sim 3.68\\times 10^{-22}$。\n\n离散化精度：\n\n- 中心二阶差分格式引入了 $\\mathcal{O}((\\Delta t)^2)$ 的误差，对于所选的 $\\Delta t$ 和平滑的正弦信号，此误差相对于信号振幅而言可以忽略。推迟时间平移 $R/c$ 仅在时间上平移波形，不影响最大振幅；因此，在离散评估中省略它不会对报告的最大值产生偏差。\n\n实现说明：\n\n- 为位置构建形状为 $K\\times N\\times 3$ 的数组，计算 $I_{ij}(t_k)$ 作为形状为 $K\\times 3\\times 3$ 的数组，然后沿时间轴应用中心差分得到一个形状为 $(K-2)\\times 3\\times 3$ 的二阶导数数组。通过 $h_{+}=(G/(c^4 R))(I_{xx}''-I_{yy}'')$ 提取 $h_{+}(t_k)$，并取索引 $k=1,\\dots,K-2$ 上的最大绝对值。\n- 按要求将三种情况的结果报告在单行上，格式为 $[\\text{A},\\text{B},\\text{C}]$，每个数字都格式化为小数点后恰好有 10 位数字的科学记数法。\n\n三种情况的预期数值量级约为 $[\\sim 8.5\\times 10^{-23},\\,0,\\,\\sim 3.7\\times 10^{-22}]$，这与上面的解析估计一致。下面的程序直接从生成的离散数据执行这些计算。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_quadrupole_tracefree(masses, positions):\n    \"\"\"\n    Compute the trace-free mass quadrupole tensor I_ij(t) for point masses.\n    positions: array of shape (K, N, 3)\n    masses: array of shape (N,)\n    Returns: array of shape (K, 3, 3)\n    \"\"\"\n    K, N, _ = positions.shape\n    I = np.zeros((K, 3, 3), dtype=np.float64)\n    # For each time, sum m_a * (x_i x_j - 1/3 delta_ij r^2)\n    # Vectorized over bodies\n    r2 = np.sum(positions**2, axis=2)  # (K, N)\n    # Compute x_i x_j per body, then sum weighted by masses\n    for i in range(3):\n        for j in range(3):\n            I[:, i, j] = np.sum(masses[None, :] * positions[:, :, i] * positions[:, :, j], axis=1)\n    # Subtract 1/3 delta_ij sum_a m_a r_a^2\n    trace_term = (1.0/3.0) * np.sum(masses[None, :] * r2, axis=1)  # (K,)\n    for i in range(3):\n        I[:, i, i] -= trace_term\n    return I\n\ndef central_second_derivative(arr, dt):\n    \"\"\"\n    Compute centered second derivative along the first axis (time).\n    arr: array of shape (K, ...)\n    Returns: array of shape (K-2, ...)\n    \"\"\"\n    return (arr[2:] - 2.0 * arr[1:-1] + arr[:-2]) / (dt * dt)\n\ndef hplus_from_I2dd_z(I2dd, G, c, R):\n    \"\"\"\n    For observer along z-axis, compute h_plus(t) = (G/(c^4 R)) * (I_xx'' - I_yy'')\n    I2dd: array of shape (K-2, 3, 3)\n    Returns: array of shape (K-2,)\n    \"\"\"\n    pref = G / (c**4 * R)\n    return pref * (I2dd[:, 0, 0] - I2dd[:, 1, 1])\n\ndef generate_case_A():\n    # Constants\n    G = 6.67430e-11\n    c = 2.99792458e8\n    Msun = 1.98847e30\n    M = 1.4 * Msun\n    R = 1.0e21\n    a = 1.0e8\n    K = 4096\n    dt = 1.0\n\n    # Angular frequency from Newtonian circular orbit\n    Mtot = 2.0 * M\n    d = 2.0 * a\n    omega = np.sqrt(G * Mtot / (d**3))\n\n    t = np.arange(K) * dt\n    # Positions for two bodies\n    x1 = a * np.cos(omega * t)\n    y1 = a * np.sin(omega * t)\n    z1 = np.zeros_like(t)\n    pos1 = np.stack([x1, y1, z1], axis=1)\n\n    pos2 = -pos1\n\n    positions = np.stack([pos1, pos2], axis=1)  # (K, N=2, 3)\n    masses = np.array([M, M], dtype=np.float64)\n    return masses, positions, dt, R, G, c\n\ndef generate_case_B():\n    # Constants as in A\n    G = 6.67430e-11\n    c = 2.99792458e8\n    Msun = 1.98847e30\n    M = 1.4 * Msun\n    R = 1.0e21\n    a = 1.0e8\n    K = 128\n    dt = 1.0\n\n    # Static positions\n    t = np.arange(K) * dt\n    pos1 = np.tile(np.array([a, 0.0, 0.0], dtype=np.float64), (K, 1))\n    pos2 = np.tile(np.array([-a, 0.0, 0.0], dtype=np.float64), (K, 1))\n    positions = np.stack([pos1, pos2], axis=1)\n    masses = np.array([M, M], dtype=np.float64)\n    return masses, positions, dt, R, G, c\n\ndef generate_case_C():\n    # Constants as in A\n    G = 6.67430e-11\n    c = 2.99792458e8\n    Msun = 1.98847e30\n    M = 1.4 * Msun\n    R = 1.0e21\n    A = 1.0e8\n    omega = 2.0e-2  # rad/s\n    K = 2048\n    dt = 0.5\n\n    t = np.arange(K) * dt\n    x1 = A * np.cos(omega * t)\n    y1 = np.zeros_like(t)\n    z1 = np.zeros_like(t)\n    pos1 = np.stack([x1, y1, z1], axis=1)\n    pos2 = -pos1\n    positions = np.stack([pos1, pos2], axis=1)\n    masses = np.array([M, M], dtype=np.float64)\n    return masses, positions, dt, R, G, c\n\ndef compute_hplus_max(masses, positions, dt, R, G, c):\n    I = compute_quadrupole_tracefree(masses, positions)\n    I2dd = central_second_derivative(I, dt)\n    hplus = hplus_from_I2dd_z(I2dd, G, c, R)\n    return float(np.max(np.abs(hplus)))\n\ndef solve():\n    # Define the test cases from the problem statement.\n    cases = [generate_case_A, generate_case_B, generate_case_C]\n\n    results = []\n    for gen in cases:\n        masses, positions, dt, R, G, c = gen()\n        result = compute_hplus_max(masses, positions, dt, R, G, c)\n        results.append(result)\n\n    # Format with scientific notation and exactly 10 digits after decimal.\n    formatted = [\"{:.10e}\".format(x) for x in results]\n    print(f\"[{','.join(formatted)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3494590"}]}