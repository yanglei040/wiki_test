{"hands_on_practices": [{"introduction": "在分子动力学模拟中，温度是一个宏观热力学量，但我们直接获取的却是微观的粒子坐标与动量。本练习将引导你从第一性原理出发，探索如何从单个微观状态中定义和计算“瞬时温度”。你将推导两种截然不同的温度估计量：一种基于动能和均分定理，另一种则源于势能面及其导数，即所谓的“构型温度”。通过这个实践，你将深化对温度的统计力学本质的理解，并掌握在模拟中检验系统热平衡的关键技能。[@problem_id:3423095]", "problem": "考虑一个经典分子动力学（MD）系统，该系统由 $N$ 个三维空间中的质点组成，其位置为 $\\{\\mathbf{r}_i\\}_{i=1}^{N}$，动量为 $\\{\\mathbf{p}_i\\}_{i=1}^{N}$，质量为 $\\{m_i\\}_{i=1}^{N}$。哈密顿量为 $H = K + U$，其中动能为 $K = \\sum_{i=1}^{N} \\frac{|\\mathbf{p}_i|^2}{2 m_i}$，势能为 $U(\\{\\mathbf{r}_i\\})$。该系统在周期性边界条件下进行模拟，且质心（COM）动量约束为零。假设系统处于温度为 $T$ 的正则系综中，并且宏观可观测量由瞬时微观态估计得出。\n\n从适用于此情境的第一性原理出发，特别是：\n- 哈密顿力学及正则系综中相空间平均的定义，以及\n- 针对二次自由度的能量均分定理，\n\n完成以下任务：\n1. 推导一个显式的瞬时动理学温度估计量 $T_{\\mathrm{K}}$，该表达式应纯粹用动量 $\\{\\mathbf{p}_i\\}$、质量 $\\{m_i\\}$ 和无约束自由度的数量表示。不假设质量相同。\n2. 仅使用正则系综中构型平均的定义和严格的数学变换（例如，在组态空间上使用高斯定理或分部积分），推导一个显式的瞬时构型温度估计量 $T_{\\mathrm{C}}$，用 $\\nabla U$ 和 $\\nabla^2 U$ 表示。\n3. 将 $U$ 具体化为三维空间中的对加性 Lennard-Jones 势，\n$$\nU(\\{\\mathbf{r}_i\\}) = \\sum_{1 \\leq i  j \\leq N} v(r_{ij}), \\quad v(r) = 4 \\varepsilon \\left[ \\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^{6} \\right], \\quad r_{ij} = |\\mathbf{r}_i - \\mathbf{r}_j|,\n$$\n并为一个特定的微观态（$N = 2$，$\\mathbf{r}_1 = (\\sigma, 0, 0)$，$\\mathbf{r}_2 = (2\\sigma, 0, 0)$）求出瞬时构型温度 $T_{\\mathrm{C}}$ 的闭合形式表达式。\n提供第（1）和第（2）部分要求的显式解析表达式，以及第（3）部分计算出的最终表达式。所有温度均以开尔文表示。如果需要任何数值近似，将答案四舍五入到四位有效数字；否则，提供精确的闭合形式表达式。", "solution": "问题陈述有效。它在科学上基于经典统计力学和分子动力学的原理，是适定、客观且内部一致的。我们按要求进行推导。\n\n问题的第一部分要求推导瞬时动理学温度估计量 $T_{\\mathrm{K}}$。在正则系综中，能量均分定理指出，对于处于温度 $T$ 热平衡状态下的经典系统，任何在哈密顿量中以二次方形式出现的自由度，其平均能量为 $\\frac{1}{2} k_B T$，其中 $k_B$ 是玻尔兹曼常数。$N$ 个粒子在 $3$ 维空间中的系统动能由下式给出：\n$$K = \\sum_{i=1}^{N} \\frac{|\\mathbf{p}_i|^2}{2 m_i} = \\sum_{i=1}^{N} \\left( \\frac{p_{ix}^2}{2 m_i} + \\frac{p_{iy}^2}{2 m_i} + \\frac{p_{iz}^2}{2 m_i} \\right)$$\n此表达式是 $3N$ 个二次项之和，每个动量分量对应一项。动能的系综平均为 $\\langle K \\rangle$。根据能量均分定理，每个二次动量项的平均能量为 $\\langle \\frac{p_{i\\alpha}^2}{2 m_i} \\rangle = \\frac{1}{2} k_B T$，其中 $\\alpha \\in \\{x, y, z\\}$。问题规定质心（COM）动量被约束为零：\n$$\\mathbf{P}_{\\mathrm{COM}} = \\sum_{i=1}^{N} \\mathbf{p}_i = \\mathbf{0}$$\n这对动量分量构成了 $3$ 个标量约束（即 $\\sum_{i=1}^{N} p_{ix} = 0$，$\\sum_{i=1}^{N} p_{iy} = 0$，$\\sum_{i=1}^{N} p_{iz} = 0$）。因此，动能项中独立的、无约束的二次自由度数量不是 $3N$，而是 $N_{\\mathrm{DOF}} = 3N - 3$。总平均动能是这些独立自由度平均能量的总和：\n$$\\langle K \\rangle = (3N - 3) \\times \\frac{1}{2} k_B T$$\n通过假设宏观可观测量的瞬时值等于其系综平均值，可以得到温度的瞬时估计量。设 $T_{\\mathrm{K}}$ 为此瞬时动理学温度。我们令瞬时动能 $K_{\\mathrm{inst}}$ 等于其期望值：\n$$K_{\\mathrm{inst}} = \\sum_{i=1}^{N} \\frac{|\\mathbf{p}_i|^2}{2 m_i} = \\frac{3N-3}{2} k_B T_{\\mathrm{K}}$$\n求解 $T_{\\mathrm{K}}$ 得到所求的估计量：\n$$T_{\\mathrm{K}} = \\frac{2K_{\\mathrm{inst}}}{(3N - 3)k_B} = \\frac{1}{(3N - 3)k_B} \\sum_{i=1}^{N} \\frac{|\\mathbf{p}_i|^2}{m_i}$$\n\n问题的第二部分要求推导瞬时构型温度估计量 $T_{\\mathrm{C}}$。这可以从正则系综中势能函数 $U(\\{\\mathbf{r}_i\\})$ 的性质推导出来。一个仅依赖于粒子位置 $\\{\\mathbf{r}_i\\}$ 的可观测量 $A(\\{\\mathbf{r}_i\\})$ 的系综平均由下式给出：\n$$\\langle A \\rangle = \\frac{\\int A(\\{\\mathbf{r}_i\\}) \\exp(-\\beta U(\\{\\mathbf{r}_i\\})) d^{3N}\\mathbf{r}}{\\int \\exp(-\\beta U(\\{\\mathbf{r}_i\\})) d^{3N}\\mathbf{r}}$$\n其中 $\\beta = 1/(k_B T)$，积分遍及 $3N$ 维组态空间。设 $\\nabla = (\\nabla_{\\mathbf{r}_1}, \\dots, \\nabla_{\\mathbf{r}_N})$ 为此空间中的梯度算子。我们考虑将散度定理（分部积分）应用于矢量场 $\\mathbf{V} = (\\nabla U) \\exp(-\\beta U)$ 所得的恒等式。其散度为：\n$$\\nabla \\cdot \\mathbf{V} = (\\nabla^2 U) \\exp(-\\beta U) + (\\nabla U) \\cdot \\nabla[\\exp(-\\beta U)]$$\n使用链式法则，$\\nabla[\\exp(-\\beta U)] = -\\beta (\\nabla U) \\exp(-\\beta U)$，我们得到：\n$$\\nabla \\cdot [(\\nabla U) \\exp(-\\beta U)] = \\left[ \\nabla^2 U - \\beta |\\nabla U|^2 \\right] \\exp(-\\beta U)$$\n其中 $|\\nabla U|^2 = (\\nabla U) \\cdot (\\nabla U) = \\sum_{i=1}^{N} |\\nabla_{\\mathbf{r}_i} U|^2$ 且 $\\nabla^2 U = \\nabla \\cdot (\\nabla U) = \\sum_{i=1}^{N} \\nabla_{\\mathbf{r}_i}^2 U$。将此散度在整个组态空间体积 $\\Omega$ 上积分，并应用散度定理，会得到一个边界积分，对于周期性或受限系统，该积分消失。因此：\n$$0 = \\int_{\\Omega} \\left[ \\nabla^2 U - \\beta |\\nabla U|^2 \\right] \\exp(-\\beta U) d^{3N}\\mathbf{r}$$\n这意味着 $\\int (\\nabla^2 U) \\exp(-\\beta U) d^{3N}\\mathbf{r} = \\beta \\int |\\nabla U|^2 \\exp(-\\beta U) d^{3N}\\mathbf{r}$，用系综平均表示即为 $\\langle \\nabla^2 U \\rangle = \\beta \\langle |\\nabla U|^2 \\rangle$。代入 $\\beta = 1/(k_B T)$ 得 $k_B T = \\frac{\\langle |\\nabla U|^2 \\rangle}{\\langle \\nabla^2 U \\rangle}$。通过去掉系综平均，得到瞬时构型温度估计量 $T_{\\mathrm{C}}$：\n$$T_{\\mathrm{C}} = \\frac{|\\nabla U|^2}{k_B \\nabla^2 U} = \\frac{\\sum_{i=1}^{N} |\\nabla_{\\mathbf{r}_i} U|^2}{k_B \\sum_{i=1}^{N} \\nabla_{\\mathbf{r}_i}^2 U}$$\n\n第三部分要求针对通过 Lennard-Jones 势 $v(r)$ 相互作用的 $N=2$ 个粒子，在特定构型下，具体化 $T_{\\mathrm{C}}$。对于双粒子系统，$U(\\mathbf{r}_1, \\mathbf{r}_2) = v(r_{12})$，其中 $r_{12} = |\\mathbf{r}_1 - \\mathbf{r}_2|$。设 $r=r_{12}$。所需的项为：\n$$|\\nabla U|^2 = |\\nabla_{\\mathbf{r}_1} U|^2 + |\\nabla_{\\mathbf{r}_2} U|^2 = 2(v'(r))^2$$\n$$\\nabla^2 U = \\nabla_{\\mathbf{r}_1}^2 U + \\nabla_{\\mathbf{r}_2}^2 U = 2\\left(v''(r) + \\frac{2}{r} v'(r)\\right)$$\n这给出了双粒子系统 $k_B T_{\\mathrm{C}}$ 的表达式：\n$$k_B T_{\\mathrm{C}} = \\frac{2(v'(r))^2}{2(v''(r) + \\frac{2}{r} v'(r))} = \\frac{(v'(r))^2}{v''(r) + \\frac{2}{r} v'(r)}$$\nLennard-Jones 势为 $v(r) = 4 \\varepsilon [ (\\frac{\\sigma}{r})^{12} - (\\frac{\\sigma}{r})^{6} ]$。其导数为：\n$$v'(r) = \\frac{24\\varepsilon}{r}\\left[-2\\left(\\frac{\\sigma}{r}\\right)^{12} + \\left(\\frac{\\sigma}{r}\\right)^{6}\\right]$$\n$$v''(r) = \\frac{4\\varepsilon}{r^2}\\left[156\\left(\\frac{\\sigma}{r}\\right)^{12} - 42\\left(\\frac{\\sigma}{r}\\right)^{6}\\right]$$\n给定的微观态为 $\\mathbf{r}_1 = (\\sigma, 0, 0)$ 和 $\\mathbf{r}_2 = (2\\sigma, 0, 0)$，所以距离为 $r = |\\mathbf{r}_1 - \\mathbf{r}_2| = \\sigma$。我们在 $r=\\sigma$ 处计算导数值：\n$$v'(\\sigma) = \\frac{24\\varepsilon}{\\sigma}[-2(1)^{12} + (1)^6] = -\\frac{24\\varepsilon}{\\sigma}$$\n$$v''(\\sigma) = \\frac{4\\varepsilon}{\\sigma^2}[156(1)^{12} - 42(1)^6] = \\frac{456\\varepsilon}{\\sigma^2}$$\n将这些值代入 $k_B T_{\\mathrm{C}}$ 的表达式中：\n$$k_B T_{\\mathrm{C}} = \\frac{\\left(-\\frac{24\\varepsilon}{\\sigma}\\right)^2}{\\frac{456\\varepsilon}{\\sigma^2} + \\frac{2}{\\sigma}\\left(-\\frac{24\\varepsilon}{\\sigma}\\right)} = \\frac{\\frac{576\\varepsilon^2}{\\sigma^2}}{\\frac{456\\varepsilon}{\\sigma^2} - \\frac{48\\varepsilon}{\\sigma^2}} = \\frac{576\\varepsilon^2/\\sigma^2}{408\\varepsilon/\\sigma^2} = \\frac{576}{408}\\varepsilon$$\n分数可简化为 $\\frac{576}{408} = \\frac{24 \\times 24}{24 \\times 17} = \\frac{24}{17}$。\n所以，$k_B T_{\\mathrm{C}} = \\frac{24}{17}\\varepsilon$。温度的最终表达式为：\n$$T_{\\mathrm{C}} = \\frac{24\\varepsilon}{17k_B}$$\n至此完成了问题的三个部分。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{(3N-3)k_B} \\sum_{i=1}^{N} \\frac{|\\mathbf{p}_i|^2}{m_i}  \\frac{\\sum_{i=1}^{N} |\\nabla_{\\mathbf{r}_i} U|^2}{k_B \\sum_{i=1}^{N} \\nabla_{\\mathbf{r}_i}^2 U}  \\frac{24\\varepsilon}{17k_B}\n\\end{pmatrix}\n}\n$$", "id": "3423095"}, {"introduction": "分子动力学模拟通常在有限尺寸的周期性边界盒子中进行，这并非真实的无限大体系。这种有限性会引入系统性误差，尤其对扩散系数这类输运性质影响显著。本练习将引导你推导扩散系数的领头阶有限尺寸修正（即Dünweg-Kremer修正），它源于粒子与其周期性镜像之间奇妙的流体动力学相互作用。掌握这一重要修正，你将能够从模拟数据中获得更精确的输运性质，并将其外推至具有真正物理意义的无限大体系。[@problem_id:3423093]", "problem": "单个球形溶质在边长为 $L$ 的立方体盒子中，在周期性边界条件（PBC）下，于通过分子动力学（MD）模拟的牛顿不可压缩溶剂中扩散。溶剂的温度为 $T$，剪切粘度为 $\\eta$。你通过溶质均方位移的长时间斜率测量得到有限尺寸自扩散系数 $D(L)$。宏观可观测量 $D(L)$ 源于微观动力学，通过线性响应和流体动力学产生。\n\n从适用于此背景的基本原理出发，即爱因斯坦扩散关系、涨落-耗散定理（FDT）以及Navier–Stokes方程的Stokes流极限，推导立方周期性复制流体中自迁移率的领先阶有限尺寸修正，并用它来获得以 $D(L)$、$T$、$\\eta$ 和 $L$ 表示的无限系统自扩散系数 $D_{\\infty}$ 的表达式。你可以使用已知的立方周期性阵列的无量纲晶格求和常数 $\\xi = 2.837297$，该常数来自于Stokes极限下Oseen张量的Ewald求和。\n\n然后，对于以下科学上符合实际的参数：\n- 盒子边长 $L = 3.000 \\times 10^{-9}\\,\\mathrm{m}$，\n- 温度 $T = 298.0\\,\\mathrm{K}$，\n- 剪切粘度 $\\eta = 8.90 \\times 10^{-4}\\,\\mathrm{Pa\\cdot s}$，\n- 测得的有限尺寸扩散系数 $D(L) = 1.900 \\times 10^{-9}\\,\\mathrm{m^2/s}$，\n- 玻尔兹曼常数 $k_B = 1.380\\,649 \\times 10^{-23}\\,\\mathrm{J/K}$，\n\n计算无限系统自扩散系数 $D_{\\infty}$。将你的答案四舍五入至四位有效数字。以 $\\mathrm{m^2/s}$ 为单位表示最终的扩散系数。", "solution": "该问题是有效的。这是一个适定的、有科学依据的计算统计力学问题，要求推导和应用周期性系统中扩散系数的领先阶有限尺寸修正。所有必需的信息均已提供，且参数在物理上是符合实际的。\n\n问题在于将边长为 $L$ 的立方体盒子中测得的扩散系数 $D(L)$ 与无限大系统中的扩散系数 $D_{\\infty}$ 联系起来。这种关系可以通过考虑周期性边界条件对扩散溶质与溶剂之间流体动力学相互作用的影响来推导。\n\n我们从爱因斯坦关系开始，该关系将扩散系数 $D$ 与粒子的迁移率 $\\mu$ 和热能 $k_B T$ 联系起来：\n$$D = \\mu k_B T$$\n其中 $k_B$ 是玻尔兹曼常数，$T$ 是绝对温度。此关系对有限尺寸系统和无限系统均成立：\n$$D(L) = \\mu(L) k_B T$$\n$$D_{\\infty} = \\mu_{\\infty} k_B T$$\n因此，任务简化为找出有限系统中的迁移率 $\\mu(L)$ 和无限系统中的迁移率 $\\mu_{\\infty}$ 之间的关系。\n\n迁移率 $\\mu$ 是衡量粒子对外力速度响应的量度。对于一个受到恒定外力 $\\mathbf{F}_{\\text{ext}}$ 的粒子，它会达到一个与该力成正比的终端速度 $\\mathbf{v}$：$\\mathbf{v} = \\mu \\mathbf{F}_{\\text{ext}}$。比例常数就是迁移率。涨落-耗散定理（FDT）为这种线性响应关系提供了微观基础，并将其与平衡涨落联系起来，但这个问题的核心在于流体动力学论证。\n\n在粘度为 $\\eta$ 的无限、不可压缩的牛顿流体中，一个受到力 $\\mathbf{F}$ 的点状粒子以速度 $\\mathbf{v}$ 运动。这种运动在周围的流体中感生出一个速度场 $\\mathbf{u}(\\mathbf{r})$。在低雷诺数（Stokes流）的极限下，这种情况由Stokes方程描述。原点处的点力 $\\mathbf{F}$ 产生一个由Oseen张量 $\\mathbf{T}(\\mathbf{r})$ 给出的速度场：\n$$\\mathbf{u}(\\mathbf{r}) = \\mathbf{T}(\\mathbf{r}) \\cdot \\mathbf{F}$$\n其中\n$$\\mathbf{T}_{ij}(\\mathbf{r}) = \\frac{1}{8 \\pi \\eta r} \\left( \\delta_{ij} + \\frac{r_i r_j}{r^2} \\right)$$\n对于位置矢量 $\\mathbf{r}$，其模为 $r$，分量为 $r_i, r_j$。\n\n粒子本身的迁移率 $\\mu_{\\infty}$ 与其所受的摩擦力有关。对于半径为 $a$ 的球形粒子，Stokes定律给出的摩擦系数为 $\\zeta_{\\infty} = 6 \\pi \\eta a$，迁移率为 $\\mu_{\\infty} = 1/\\zeta_{\\infty}$。虽然我们的推导是针对点粒子的，但迁移率的概念仍然成立。\n\n在具有周期性边界条件（PBC）的系统中，粒子不仅与周围的流体相互作用，还与其自身的周期性镜像相互作用。作用在原点粒子上的力 $\\mathbf{F}$ 会从其所有位于晶格矢量 $L\\mathbf{n}$ 处的镜像感生出速度场，其中 $\\mathbf{n}$ 是一个整数矢量 $(n_x, n_y, n_z)$。在粒子位置（$\\mathbf{r}=\\mathbf{0}$）处流体的速度受到其所有镜像（$\\mathbf{n} \\neq \\mathbf{0}$）产生的流场的影响。这就是流体动力学回流。\n\n粒子在周期系统中的速度 $\\mathbf{v}(L)$ 是其在无限介质中的速度 $\\mathbf{v}_{\\infty} = \\mu_{\\infty} \\mathbf{F}$ 减去这个回流速度 $\\mathbf{v}_{\\text{backflow}}$：\n$$\\mathbf{v}(L) = \\mu_{\\infty}\\mathbf{F} - \\mathbf{v}_{\\text{backflow}}$$\n回流速度是作用在每个镜像粒子上的力 $\\mathbf{F}$ 所感生的速度场在中心粒子位置处的总和：\n$$\\mathbf{v}_{\\text{backflow}} = \\sum_{\\mathbf{n} \\in \\mathbb{Z}^3, \\mathbf{n} \\neq \\mathbf{0}} \\mathbf{T}(L\\mathbf{n}) \\cdot \\mathbf{F}$$\n此处，求和遍及所有非零整数矢量 $\\mathbf{n}$。\n\n综合这些，粒子在周期性系统中的速度为：\n$$\\mathbf{v}(L) = \\left( \\mu_{\\infty}\\mathbf{I} - \\sum_{\\mathbf{n} \\neq \\mathbf{0}} \\mathbf{T}(L\\mathbf{n}) \\right) \\cdot \\mathbf{F}$$\n其中 $\\mathbf{I}$ 是单位张量。括号中的项是有限系统中的有效迁移率张量 $\\mathbf{M}(L)$。对于立方晶格，对称性决定了这个张量是各向同性的，即 $\\mathbf{M}(L) = \\mu(L)\\mathbf{I}$。标量迁移率 $\\mu(L)$ 是其迹的三分之一：\n$$\\mu(L) = \\frac{1}{3} \\text{Tr}(\\mathbf{M}(L)) = \\mu_{\\infty} - \\frac{1}{3} \\text{Tr}\\left( \\sum_{\\mathbf{n} \\neq \\mathbf{0}} \\mathbf{T}(L\\mathbf{n}) \\right)$$\n\n我们需要计算Oseen张量的迹：\n$$\\text{Tr}(\\mathbf{T}(\\mathbf{r})) = \\sum_{i=1}^{3} \\mathbf{T}_{ii}(\\mathbf{r}) = \\frac{1}{8 \\pi \\eta r} \\sum_{i=1}^{3} \\left( \\delta_{ii} + \\frac{r_i^2}{r^2} \\right) = \\frac{1}{8 \\pi \\eta r} \\left( 3 + \\frac{r_1^2+r_2^2+r_3^2}{r^2} \\right) = \\frac{1}{8 \\pi \\eta r} (3 + 1) = \\frac{1}{2 \\pi \\eta r}$$\n将此代入 $\\mu(L)$ 的表达式中：\n$$\\mu(L) = \\mu_{\\infty} - \\frac{1}{3} \\sum_{\\mathbf{n} \\neq \\mathbf{0}} \\frac{1}{2 \\pi \\eta |L\\mathbf{n}|} = \\mu_{\\infty} - \\frac{1}{6 \\pi \\eta L} \\sum_{\\mathbf{n} \\neq \\mathbf{0}} \\frac{1}{|\\mathbf{n}|}$$\n和式 $\\sum_{\\mathbf{n} \\neq \\mathbf{0}} \\frac{1}{|\\mathbf{n}|}$ 是一个无量纲的晶格和，其值取决于周期性单元的几何形状。对于简单立方晶格，使用Ewald求和技术来处理其条件收敛性，计算出此和由常数 $\\xi$ 给出。问题给出了它的值：$\\xi = 2.837297$。\n\n因此，对迁移率的领先阶有限尺寸修正为：\n$$\\mu(L) = \\mu_{\\infty} - \\frac{\\xi}{6 \\pi \\eta L}$$\n这表明，由于周期性镜像引起的感生阻力，有限周期系统中的迁移率与无限系统相比有所降低。\n\n现在，我们使用爱因斯坦关系将其转换回扩散系数的表达式：\n$$\\frac{D(L)}{k_B T} = \\frac{D_{\\infty}}{k_B T} - \\frac{\\xi}{6 \\pi \\eta L}$$\n两边乘以 $k_B T$，我们得到扩散系数之间的关系：\n$$D(L) = D_{\\infty} - \\frac{k_B T \\xi}{6 \\pi \\eta L}$$\n这就是著名的Dünweg-Kremer自扩散系数修正。\n\n问题要求用其他量表示 $D_{\\infty}$ 的表达式。重新整理方程，我们得到：\n$$D_{\\infty} = D(L) + \\frac{k_B T \\xi}{6 \\pi \\eta L}$$\n推导到此完成。\n\n接下来，我们使用给定的参数计算 $D_{\\infty}$ 的数值。\n参数如下：\n- $L = 3.000 \\times 10^{-9}\\,\\mathrm{m}$\n- $T = 298.0\\,\\mathrm{K}$\n- $\\eta = 8.90 \\times 10^{-4}\\,\\mathrm{Pa\\cdot s}$\n- $D(L) = 1.900 \\times 10^{-9}\\,\\mathrm{m^2/s}$\n- $k_B = 1.380649 \\times 10^{-23}\\,\\mathrm{J/K}$\n- $\\xi = 2.837297$\n\n首先，我们计算修正项 $\\Delta D = \\frac{k_B T \\xi}{6 \\pi \\eta L}$。所有值都采用国际单位制（SI）单位，因此结果的单位将是 $\\mathrm{m^2/s}$。\n分子是 $k_B T \\xi$：\n$$k_B T \\xi = (1.380649 \\times 10^{-23}\\,\\mathrm{J/K}) \\times (298.0\\,\\mathrm{K}) \\times (2.837297) \\approx 1.167345 \\times 10^{-20}\\,\\mathrm{J}$$\n分母是 $6 \\pi \\eta L$：\n$$6 \\pi \\eta L = 6\\pi \\times (8.90 \\times 10^{-4}\\,\\mathrm{Pa\\cdot s}) \\times (3.000 \\times 10^{-9}\\,\\mathrm{m}) \\approx 5.032814 \\times 10^{-11}\\,\\mathrm{Pa\\cdot s \\cdot m}$$\n修正项是：\n$$\\Delta D = \\frac{1.167345 \\times 10^{-20}\\,\\mathrm{J}}{5.032814 \\times 10^{-11}\\,\\mathrm{Pa\\cdot s \\cdot m}} \\approx 2.321437 \\times 10^{-10}\\,\\mathrm{m^2/s} = 0.2321437 \\times 10^{-9}\\,\\mathrm{m^2/s}$$\n现在，我们将此修正项加到测得的扩散系数 $D(L)$ 上：\n$$D_{\\infty} = D(L) + \\Delta D = (1.900 \\times 10^{-9}\\,\\mathrm{m^2/s}) + (0.2321437 \\times 10^{-9}\\,\\mathrm{m^2/s})$$\n$$D_{\\infty} \\approx 2.1321437 \\times 10^{-9}\\,\\mathrm{m^2/s}$$\n问题要求将答案四舍五入到四位有效数字。\n$$D_{\\infty} \\approx 2.132 \\times 10^{-9}\\,\\mathrm{m^2/s}$$", "answer": "$$\\boxed{2.132 \\times 10^{-9}}$$", "id": "3423093"}, {"introduction": "表面张力是流体界面的一个关键宏观性质，但如何从分子模拟中计算它呢？本练习将带你探索两条物理上截然不同的途径：一是基于跨界面压力张量各向异性的“力学路径”；二是基于改变界面面积所需自由能代价的“热力学路径”。你将通过编程实现这两种方法，并在此过程中直面一种独特的有限尺寸效应——毛细波，它会对热力学计算结果产生重要影响。这个实践不仅能让你体会到统计力学内部的自洽性，更能让你掌握分析和修正界面涨落所致有限尺寸效应的关键技能。[@problem_id:3423109]", "problem": "您将编写一个完整的、可运行的程序。对于分子动力学中的一个模型平面液-汽界面，该程序通过两条微观路径计算表面张力，并分离出有限尺寸的毛细波贡献。这两条路径是：(i) 通过压力张量的各向异性实现的力学路径，以及 (ii) 通过在小面积形变下由微观能量变化构建的自由能微扰实现的热力学测试面积路径。您将把这些路径应用于包含三种方形横向系统尺寸的小型测试套件，并报告每种情况的结果以及无限系统的外推值。\n\n从以下基本依据和核心定义开始：\n- 对于平衡状态下的平面界面，单个界面的表面张力的力学定义由压力各向异性沿界面法向坐标的积分给出，$ \\gamma = \\int_{-\\infty}^{\\infty} \\left[P_N(z) - P_T(z)\\right] \\, dz$，其中 $P_N(z)$ 是局域压力张量的法向分量，$P_T(z)$ 是两个切向分量的算术平均值。在一个高度为 $L_z$、包含两个平面界面的周期性模拟单元中，对整个单元进行积分得到两个界面的总和，而单个界面的表面张力通过将积分值除以界面数 $n_i = 2$ 得到。\n- 在恒定 $NVT$（粒子数、体积和温度固定）的热力学测试面积方法中，一个由分数应变 $ \\epsilon $ 引起的小的平面内面积增加所对应的自由能变化 $\\Delta F$ 可通过微观势能变化 $\\Delta U$ 计算得到：$ \\Delta F = -k_B T \\ln \\left\\langle e^{-\\beta \\Delta U} \\right\\rangle$，其中 $ \\beta = 1/(k_B T)$，$k_B$ 是玻尔兹曼常数。对于足够小的 $ \\epsilon $，二阶累积量展开可得 $ \\Delta F \\approx \\langle \\Delta U \\rangle - \\frac{\\beta}{2}\\mathrm{Var}(\\Delta U)$，单个界面的表面张力估计为 $ \\gamma \\approx \\Delta F / (2 A \\epsilon)$，其中 $A$ 是一个界面的横向面积，系数 $2$ 是因为单元中有两个界面。\n- 具有周期性边界条件的毛细波哈密顿量 $ \\mathcal{H}[h] = \\frac{\\gamma}{2}\\int d^2\\mathbf{r} \\, |\\nabla h(\\mathbf{r})|^2 $ 导致了对表观表面张力的有限尺寸修正，该表观表面张力是在横向尺寸为 $L$（因此 $A=L^2$）的有限方形盒子中通过测试面积自由能得到的。对具有微观截断长度 $a$ 的允许傅里叶模式的毛细波配分函数进行标准分析，可以得到一个依赖于 $L$ 的自由能贡献，这个贡献产生了测试面积估计的主要有限尺寸偏差：\n$$\n\\Delta \\gamma_{\\mathrm{cw}}(L) \\equiv \\gamma_{\\mathrm{TA}}(L) - \\gamma_{\\infty} \\approx - \\frac{k_B T}{4\\pi L^2} \\ln\\!\\left(\\frac{L}{a}\\right),\n$$\n其中 $\\gamma_{\\infty}$ 是无限系统表面张力。对于具有完全局域应力解析的平面界面，力学路径通过积分压力各向异性得到，并且不带有这种熵驱动的毛细模截断偏差；因此，在固定的热力学状态下，它返回与 $L$ 无关的 $\\gamma_{\\infty}$。\n\n您的程序将不读取任何输入。它必须生成符合上述原理的合成微观数据，计算宏观可观测量，并以要求的格式输出结果。您必须使用以下物理和数值参数：\n- 玻尔兹曼常数：$k_B = 1.380649 \\times 10^{-23} \\,\\mathrm{J/K}$。\n- 温度：$T = 300 \\,\\mathrm{K}$，因此 $\\beta = 1/(k_B T)$。\n- 真实无限系统表面张力：$\\gamma_{\\infty} = 0.005 \\,\\mathrm{N/m}$。\n- 毛细模的微观截断长度：$a = 0.5 \\,\\mathrm{nm}$。\n- 基础法向压力：$P_0 = 1.0 \\times 10^{5} \\,\\mathrm{Pa}$。\n- 模拟单元高度：$L_z = 12 \\,\\mathrm{nm}$。\n- 因周期性产生的界面数：$n_i = 2$。\n- 分子尺度的本征界面宽度：$w_0 = 0.3 \\,\\mathrm{nm}$。\n- 用于测试面积微扰的平面内应变：$\\epsilon = 0.01$。\n- 对于每种情况，使用一个包含 $M = 100$ 个微观能量微扰样本的确定性系综。\n\n按如下方式为每个测试用例构建微观数据：\n1. 横向盒子尺寸为方形，边长 $L \\in \\{ 2\\,\\mathrm{nm}, 4\\,\\mathrm{nm}, 8\\,\\mathrm{nm} \\}$，因此单个界面的面积为 $A = L^2$。测试套件按规定顺序包含这三种情况。这涵盖了一个小系统边缘情况、一个中等尺度情况和一个较大横向情况。\n2. 力学路径数据：沿 $z$ 轴在 $z_1 = L_z/4$ 和 $z_2 = 3L_z/4$ 处定义两个界面中心。定义毛细波展宽宽度\n$$\nw(L) = \\sqrt{w_0^2 + \\frac{k_B T}{2\\pi \\gamma_{\\infty}} \\ln\\!\\left(\\frac{L}{a}\\right)}.\n$$\n在 $[0,L_z]$ 范围内，从 $j=0$ 到 $j=5000$（即 $5001$ 个点）构建一个具有均匀间距的离散化网格 $z_j$。将局域压力分量定义为\n$$\nP_N(z_j) = P_0, \\quad\nP_T(z_j) = P_0 - \\delta p(z_j; L),\n$$\n压力各向异性为\n$$\n\\delta p(z; L) = S(L)\\left[\\exp\\!\\left(-\\frac{(z - z_1)^2}{2 w(L)^2}\\right) + \\exp\\!\\left(-\\frac{(z - z_2)^2}{2 w(L)^2}\\right)\\right],\n$$\n并选择振幅\n$$\nS(L) = \\frac{\\gamma_{\\infty}}{\\sqrt{2\\pi} \\, w(L)},\n$$\n使得 $\\delta p$ 在整个单元上的积分等于 $2 \\gamma_{\\infty}$。通过使用梯形法则进行数值积分来计算每个界面的力学表面张力\n$$\n\\gamma_{\\mathrm{mech}}(L) = \\frac{1}{n_i}\\int_{0}^{L_z} \\left[P_N(z) - P_T(z)\\right] \\, dz,\n$$\n并以 $\\mathrm{N/m}$ 为单位报告。\n3. 测试面积路径数据：对于每种情况，目标是有限尺寸偏置的单个界面表面张力\n$$\n\\gamma_{\\mathrm{TA}}^{\\mathrm{target}}(L) = \\gamma_{\\infty} + \\Delta \\gamma_{\\mathrm{cw}}(L), \\quad \\Delta \\gamma_{\\mathrm{cw}}(L) = - \\frac{k_B T}{4\\pi L^2} \\ln\\!\\left(\\frac{L}{a}\\right).\n$$\n令微观能量变化的方差按以下方式缩放\n$$\n\\mathrm{Var}(\\Delta U) = \\sigma^2(L) = c_U \\, k_B T \\, A \\, \\epsilon^2,\n$$\n其中无量纲常数 $c_U = 0.1$。通过取 $M/2$ 个等于 $\\mu(L) + \\sigma(L)$ 的值和 $M/2$ 个等于 $\\mu(L) - \\sigma(L)$ 的值来构建一个包含 $M$ 个样本的确定性系综，其中均值 $\\mu(L)$ 的选择需满足针对两个界面的目标自由能变化的二阶累积量关系：\n$$\n\\mu(L) \\equiv \\langle \\Delta U \\rangle = 2 A \\epsilon \\, \\gamma_{\\mathrm{TA}}^{\\mathrm{target}}(L) + \\frac{\\beta}{2}\\sigma^2(L).\n$$\n计算样本均值和方差，并评估\n$$\n\\Delta F_{\\mathrm{est}}(L) = \\langle \\Delta U \\rangle - \\frac{\\beta}{2}\\mathrm{Var}(\\Delta U).\n$$\n然后计算测试面积的单个界面表面张力估计值\n$$\n\\gamma_{\\mathrm{TA}}(L) = \\frac{\\Delta F_{\\mathrm{est}}(L)}{2 A \\epsilon},\n$$\n并以 $\\mathrm{N/m}$ 为单位报告。同时，通过移除毛细波偏差来计算有限尺寸校正的测试面积估计值\n$$\n\\gamma_{\\mathrm{TA}}^{\\mathrm{corr}}(L) = \\gamma_{\\mathrm{TA}}(L) - \\Delta \\gamma_{\\mathrm{cw}}(L),\n$$\n并以 $\\mathrm{N/m}$ 为单位报告。\n4. 使用三个 $L$ 值下的三个测试面积估计值 $\\gamma_{\\mathrm{TA}}(L)$，对线性模型进行最小二乘拟合\n$$\n\\gamma_{\\mathrm{TA}}(L) = \\gamma_{\\infty}^{\\mathrm{fit}} - C^{\\mathrm{fit}} \\, x(L),\n\\quad \\text{其中} \\quad x(L) = \\frac{\\ln(L/a)}{L^2},\n$$\n以估计作为截距的 $\\gamma_{\\infty}^{\\mathrm{fit}}$ 和作为正系数的 $C^{\\mathrm{fit}}$。仅报告 $\\gamma_{\\infty}^{\\mathrm{fit}}$，单位为 $\\mathrm{N/m}$。\n\n不涉及角度单位。所有报告的表面张力必须以 $\\mathrm{N/m}$ 为单位，表示为不带单位字符串的纯浮点数。\n\n最终输出格式：您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表，按顺序包含以下 $10$ 个条目：\n- 对于 $L = 2\\,\\mathrm{nm}$：$[\\gamma_{\\mathrm{mech}}(L), \\gamma_{\\mathrm{TA}}(L), \\gamma_{\\mathrm{TA}}^{\\mathrm{corr}}(L)]$，\n- 对于 $L = 4\\,\\mathrm{nm}$：$[\\gamma_{\\mathrm{mech}}(L), \\gamma_{\\mathrm{TA}}(L), \\gamma_{\\mathrm{TA}}^{\\mathrm{corr}}(L)]$，\n- 对于 $L = 8\\,\\mathrm{nm}$：$[\\gamma_{\\mathrm{mech}}(L), \\gamma_{\\mathrm{TA}}(L), \\gamma_{\\mathrm{TA}}^{\\mathrm{corr}}(L)]$，\n- 最后，是外推的无限尺寸估计值 $[\\gamma_{\\infty}^{\\mathrm{fit}}]$。\n\n因此，打印出的行必须具有以下结构\n$[\\gamma_{\\mathrm{mech}}(2\\,\\mathrm{nm}),\\gamma_{\\mathrm{TA}}(2\\,\\mathrm{nm}),\\gamma_{\\mathrm{TA}}^{\\mathrm{corr}}(2\\,\\mathrm{nm}),\\gamma_{\\mathrm{mech}}(4\\,\\mathrm{nm}),\\gamma_{\\mathrm{TA}}(4\\,\\mathrm{nm}),\\gamma_{\\mathrm{TA}}^{\\mathrm{corr}}(4\\,\\mathrm{nm}),\\gamma_{\\mathrm{mech}}(8\\,\\mathrm{nm}),\\gamma_{\\mathrm{TA}}(8\\,\\mathrm{nm}),\\gamma_{\\mathrm{TA}}^{\\mathrm{corr}}(8\\,\\mathrm{nm}),\\gamma_{\\infty}^{\\mathrm{fit}}]$ 且所有条目均为浮点数。", "solution": "解决方案通过对一个包含三种横向系统尺寸的测试套件，实现所提供理论模型的直接模拟来展开。我们将通过两条不同的路径——力学方法和热力学测试面积方法——计算表面张力 $\\gamma$，并在毛细波理论的背景下分析结果。\n\n首先，我们以国际单位制（SI）基本单位定义所有物理常数和模型参数。这些参数包括玻尔兹曼常数 $k_B = 1.380649 \\times 10^{-23} \\,\\mathrm{J/K}$，温度 $T = 300 \\,\\mathrm{K}$，真实无限系统表面张力 $\\gamma_{\\infty} = 0.005 \\,\\mathrm{N/m}$，微观截断长度 $a = 0.5 \\times 10^{-9} \\,\\mathrm{m}$，单元高度 $L_z = 12 \\times 10^{-9} \\,\\mathrm{m}$，界面数 $n_i=2$，本征界面宽度 $w_0 = 0.3 \\times 10^{-9} \\,\\mathrm{m}$，以及测试面积应变 $\\epsilon = 0.01$。计算针对三种边长分别为 $L \\in \\{2, 4, 8\\} \\times 10^{-9} \\,\\mathrm{m}$ 的方形系统进行。\n\n计算的第一部分处理表面张力的力学路径。对于平面界面，$\\gamma$ 由积分的压力各向异性给出。对于一个包含 $n_i$ 个界面的模拟单元，单个界面的表面张力为\n$$\n\\gamma_{\\mathrm{mech}}(L) = \\frac{1}{n_i}\\int_{0}^{L_z} \\left[P_N(z) - P_T(z)\\right] \\, dz.\n$$\n问题为局域压力分量指定了一个合成模型，$P_N(z_j) = P_0$ 和 $P_T(z_j) = P_0 - \\delta p(z_j; L)$，其中 $P_0$ 是一个恒定的背景压力。因此，压力各向异性 $P_N(z) - P_T(z)$ 就等于 $\\delta p(z; L)$。这个剖面被建模为以 $z_1 = L_z/4$ 和 $z_2 = 3L_z/4$ 为中心的两个高斯函数之和：\n$$\n\\delta p(z; L) = S(L)\\left[\\exp\\!\\left(-\\frac{(z - z_1)^2}{2 w(L)^2}\\right) + \\exp\\!\\left(-\\frac{(z - z_2)^2}{2 w(L)^2}\\right)\\right].\n$$\n高斯函数的宽度 $w(L)$ 考虑了毛细波展宽，由 $w(L) = \\sqrt{w_0^2 + \\frac{k_B T}{2\\pi \\gamma_{\\infty}} \\ln(L/a)}$ 给出。振幅 $S(L) = \\frac{\\gamma_{\\infty}}{\\sqrt{2\\pi} \\, w(L)}$ 的选择是为了使单个高斯剖面在全域的解析积分恰好为 $\\gamma_{\\infty}$。因此，包含两个此类剖面的 $\\delta p(z; L)$ 在整个单元上的积分是 $2\\gamma_{\\infty}$。除以 $n_i=2$ 后，解析上得到 $\\gamma_{\\mathrm{mech}}(L) = \\gamma_{\\infty}$。程序将通过在一个沿 $z$ 轴的包含 5001 个点的精细网格上使用梯形法则执行数值积分来验证这一点。\n\n计算的第二部分实现了热力学测试面积路径。该方法通过在小的分数面积增加 $\\epsilon$ 后的亥姆霍兹自由能变化 $\\Delta F$ 来估计表面张力。单个界面的表面张力为 $\\gamma_{\\mathrm{TA}} = \\Delta F / (2A\\epsilon)$。我们使用二阶累积量展开 $\\Delta F \\approx \\langle \\Delta U \\rangle - \\frac{\\beta}{2}\\mathrm{Var}(\\Delta U)$，其中 $\\Delta U$ 是微观势能变化。该问题规定了一种合成数据生成方案，旨在重现毛细波理论中已知的有限尺寸效应。对于尺寸为 $L$ 的有限系统，目标表面张力为\n$$\n\\gamma_{\\mathrm{TA}}^{\\mathrm{target}}(L) = \\gamma_{\\infty} + \\Delta \\gamma_{\\mathrm{cw}}(L), \\quad \\text{其中} \\quad \\Delta \\gamma_{\\mathrm{cw}}(L) = - \\frac{k_B T}{4\\pi L^2} \\ln\\!\\left(\\frac{L}{a}\\right).\n$$\n为实现此目标，我们为 $\\Delta U$ 构建一个确定性微观系综，其均值 $\\langle \\Delta U \\rangle = \\mu(L)$ 和方差 $\\mathrm{Var}(\\Delta U) = \\sigma^2(L)$ 由以下公式给出：\n$$\n\\sigma^2(L) = c_U \\, k_B T \\, A \\, \\epsilon^2 \\quad \\text{和} \\quad \\mu(L) = 2 A \\epsilon \\, \\gamma_{\\mathrm{TA}}^{\\mathrm{target}}(L) + \\frac{\\beta}{2}\\sigma^2(L).\n$$\n通过将这些代入累积量展开式，我们发现 $\\Delta F_{\\mathrm{est}}(L) = 2A\\epsilon\\,\\gamma_{\\mathrm{TA}}^{\\mathrm{target}}(L)$。因此，计算出的测试面积表面张力将是 $\\gamma_{\\mathrm{TA}}(L) = \\Delta F_{\\mathrm{est}}(L) / (2 A \\epsilon) = \\gamma_{\\mathrm{TA}}^{\\mathrm{target}}(L)$。程序将为每个 $L$ 计算该值。我们还通过减去理论毛细波贡献来计算一个校正后的表面张力：$\\gamma_{\\mathrm{TA}}^{\\mathrm{corr}}(L) = \\gamma_{\\mathrm{TA}}(L) - \\Delta \\gamma_{\\mathrm{cw}}(L)$。根据构造，这应该能恢复真实的无限系统值，即 $\\gamma_{\\mathrm{TA}}^{\\mathrm{corr}}(L) = \\gamma_{\\infty}$。\n\n最后，执行对无限系统极限的外推。毛细波理论预测了表观表面张力 $\\gamma_{\\mathrm{TA}}(L)$ 与变量 $x(L) = \\frac{\\ln(L/a)}{L^2}$ 之间的线性关系。该模型为\n$$\n\\gamma_{\\mathrm{TA}}(L) = \\gamma_{\\infty}^{\\mathrm{fit}} - C^{\\mathrm{fit}} \\, x(L).\n$$\n我们将对三个数据点 $(\\gamma_{\\mathrm{TA}}(L), x(L))$ 进行线性最小二乘拟合，以确定截距，该截距对应于外推的无限系统表面张力 $\\gamma_{\\infty}^{\\mathrm{fit}}$。由于我们的合成数据 $\\gamma_{\\mathrm{TA}}(L)$ 被构造成完美地落在理论直线 $\\gamma_{\\infty} - \\frac{k_B T}{4\\pi}x(L)$ 上，拟合的截距 $\\gamma_{\\infty}^{\\mathrm{fit}}$ 预计将与 $\\gamma_{\\infty}$ 在数值上完全相同。\n\n程序将为三种系统尺寸中的每一种执行这些步骤，收集所得的十个值（每个 $L$ 对应的 $\\gamma_{\\mathrm{mech}}$, $\\gamma_{\\mathrm{TA}}$, $\\gamma_{\\mathrm{TA}}^{\\mathrm{corr}}$，以及 $\\gamma_{\\infty}^{\\mathrm{fit}}$），并以指定的格式打印它们。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes surface tension via mechanical and thermodynamic routes,\n    analyzes finite-size effects, and performs an infinite-system extrapolation.\n    \"\"\"\n    # Define physical and numerical parameters from the problem statement in SI units.\n    K_B = 1.380649e-23  # Boltzmann constant (J/K)\n    T = 300.0           # Temperature (K)\n    GAMMA_INF = 0.005   # True infinite-system surface tension (N/m)\n    A_CUTOFF = 0.5e-9   # Microscopic cutoff length (m)\n    P0 = 1.0e5          # Base normal pressure (Pa)\n    L_Z = 12.0e-9       # Simulation cell height (m)\n    N_INTERFACES = 2    # Number of interfaces\n    W0 = 0.3e-9         # Intrinsic interfacial width (m)\n    EPSILON = 0.01      # In-plane strain\n    M_SAMPLES = 100     # Number of energy-perturbation samples\n    C_U = 0.1           # Dimensionless constant for energy variance\n\n    L_VALUES_NM = [2.0, 4.0, 8.0]\n    L_VALUES = [l * 1e-9 for l in L_VALUES_NM] # Lateral box sizes (m)\n    \n    results = []\n    gamma_ta_values_for_fit = []\n    x_fit_values = []\n\n    # Loop through each lateral box size\n    for L in L_VALUES:\n        # --- Mechanical Route Calculation ---\n        \n        # Capillary-broadened width\n        w_L_sq = W0**2 + (K_B * T) / (2 * np.pi * GAMMA_INF) * np.log(L / A_CUTOFF)\n        w_L = np.sqrt(w_L_sq)\n        \n        # Amplitude S(L)\n        S_L = GAMMA_INF / (np.sqrt(2 * np.pi) * w_L)\n        \n        # Discretized z-grid\n        z_grid = np.linspace(0, L_Z, 5001)\n        z1 = L_Z / 4.0\n        z2 = 3.0 * L_Z / 4.0\n        \n        # Pressure anisotropy profile\n        gauss1 = np.exp(-((z_grid - z1)**2) / (2 * w_L_sq))\n        gauss2 = np.exp(-((z_grid - z2)**2) / (2 * w_L_sq))\n        delta_p = S_L * (gauss1 + gauss2)\n        \n        # Pressure difference P_N - P_T = delta_p\n        pressure_difference = delta_p\n        \n        # Numerical integration using trapezoidal rule\n        integral_val = np.trapz(pressure_difference, z_grid)\n        \n        # Surface tension per interface\n        gamma_mech = integral_val / N_INTERFACES\n        results.append(gamma_mech)\n        \n        # --- Test-Area Route Calculation ---\n        \n        A = L**2 # Area of one interface\n        \n        # Capillary-wave finite-size correction term\n        delta_gamma_cw = - (K_B * T) / (4 * np.pi * L**2) * np.log(L / A_CUTOFF)\n        \n        # Target finite-size biased surface tension\n        gamma_ta_target = GAMMA_INF + delta_gamma_cw\n        \n        # Variance of microscopic energy changes\n        var_delta_u = C_U * K_B * T * A * EPSILON**2\n        \n        # Beta\n        beta = 1.0 / (K_B * T)\n        \n        # Mean of microscopic energy changes\n        mean_delta_u = 2 * A * EPSILON * gamma_ta_target + (beta / 2.0) * var_delta_u\n        \n        # The problem specifies a deterministic ensemble with this mean and variance.\n        # We can use these moments directly for the cumulant expansion.\n        delta_U_avg = mean_delta_u\n        delta_U_var = var_delta_u\n        \n        # Estimated free energy change\n        delta_F_est = delta_U_avg - (beta / 2.0) * delta_U_var\n        \n        # Test-area surface tension\n        gamma_ta = delta_F_est / (2 * A * EPSILON)\n        results.append(gamma_ta)\n        \n        # Finite-size-corrected test-area estimate\n        gamma_ta_corr = gamma_ta - delta_gamma_cw\n        results.append(gamma_ta_corr)\n        \n        # Store values for the final extrapolation fit\n        gamma_ta_values_for_fit.append(gamma_ta)\n        x_fit_values.append(np.log(L / A_CUTOFF) / L**2)\n\n    # --- Infinite-System Size Extrapolation ---\n    \n    # The model is: gamma_TA(L) = gamma_inf_fit - C_fit * x(L)\n    # This is a linear fit y = c + m*x, where:\n    # y = gamma_TA(L)\n    # x = x(L)\n    # c = gamma_inf_fit (intercept)\n    # m = -C_fit (slope)\n    \n    x_fit = np.array(x_fit_values)\n    y_fit = np.array(gamma_ta_values_for_fit)\n    \n    # Set up the design matrix for least-squares A*p = y\n    # A has columns [x, 1] to fit p=[slope, intercept]\n    A_fit = np.vstack([x_fit, np.ones(len(x_fit))]).T\n    \n    # Perform linear least-squares fit\n    # The model is y = m*x + c. lstsq returns [m, c].\n    m, c = np.linalg.lstsq(A_fit, y_fit, rcond=None)[0]\n    \n    gamma_inf_fit = c  # The intercept is the extrapolated value\n    results.append(gamma_inf_fit)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "3423109"}]}