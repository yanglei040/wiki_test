{"hands_on_practices": [{"introduction": "在分子动力学模拟中，力是驱动系统演化的基本量。本练习 [@problem_id:3420802] 将引导你从经典的Lennard-Jones和Buckingham势能函数出发，推导出粒子间的相互作用力。此外，它还探讨了在有限范围模拟中至关重要的势能截断与移位方案，这对于理解并避免模拟中的人为效应至关重要。", "problem": "考虑在三维空间中通过中心对势相互作用的两个原子。在分子动力学 (MD) 中，沿中心连线的成对力的大小由 $F(r)=-\\frac{dU(r)}{dr}$ 定义，其中 $r$ 是原子间的标量分离距离，而 $U(r)$ 是对势能。两种广泛使用的模型对势是 Lennard-Jones (LJ) 和 Buckingham (也称为指数–$6$) 形式，由下式给出：\n$$U_{\\mathrm{LJ}}(r)=4\\epsilon\\left[\\left(\\frac{\\sigma}{r}\\right)^{12}-\\left(\\frac{\\sigma}{r}\\right)^{6}\\right],\\quad U_{\\mathrm{B}}(r)=A\\,\\exp\\!\\left(-\\frac{r}{\\rho}\\right)-\\frac{C}{r^{6}},$$\n其中 $\\epsilon$、$\\sigma$、$A$、$\\rho$ 和 $C$ 是正常数，且 $r>0$。\n\n在有限范围的模拟中，相互作用在超出截断距离 $r_{c}>0$ 后被削减。三种典型的截断方案是：\n- 简单截断 (ST)：当 $r  r_c$ 时，势能为 $U(r)$；否则为零。\n- 势能移动 (SP)：当 $r  r_c$ 时，势能为 $U(r) - U(r_c)$；否则为零。\n- 力移动 (SF)：当 $r  r_c$ 时，势能为 $U(r) - U(r_c) - (r-r_c)U'(r_c)$；否则为零。\n\n请推导出 $U_{\\mathrm{LJ}}(r)$ 和 $U_{\\mathrm{B}}(r)$ 的力函数 $F(r)$，并分析这三种截断方案下势、力及其导数在 $r_c$ 处的连续性。", "solution": "问题陈述经评估有效。它具有科学依据，问题提出得当，客观，并包含完整求解所需的所有信息。Lennard-Jones 和 Buckingham 势以及截断方案的定义在分子动力学领域是标准的。任务明确，可利用微积分基本原理解答。\n\n解答按任务要求分为两部分进行。\n\n第 1 部分：成对力的推导\n\n力 $F(r)$ 由势能 $U(r)$ 通过关系式 $F(r) = -\\frac{dU(r)}{dr}$ 推导得出。\n\nLennard-Jones 力 $F_{\\mathrm{LJ}}(r)$ 的推导：\nLennard-Jones 势由下式给出：\n$$U_{\\mathrm{LJ}}(r) = 4\\epsilon\\left[\\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^{6}\\right]$$\n为便于求导，我们将势能重写为：\n$$U_{\\mathrm{LJ}}(r) = 4\\epsilon\\left[\\sigma^{12}r^{-12} - \\sigma^{6}r^{-6}\\right]$$\n现在我们对 $U_{\\mathrm{LJ}}(r)$ 关于 $r$ 求导：\n$$\\frac{dU_{\\mathrm{LJ}}(r)}{dr} = 4\\epsilon\\left[\\sigma^{12}(-12)r^{-13} - \\sigma^{6}(-6)r^{-7}\\right]$$\n$$\\frac{dU_{\\mathrm{LJ}}(r)}{dr} = 4\\epsilon\\left[-12\\frac{\\sigma^{12}}{r^{13}} + 6\\frac{\\sigma^{6}}{r^{7}}\\right]$$\n力是该导数的负值：\n$$F_{\\mathrm{LJ}}(r) = -\\frac{dU_{\\mathrm{LJ}}(r)}{dr} = -4\\epsilon\\left[-12\\frac{\\sigma^{12}}{r^{13}} + 6\\frac{\\sigma^{6}}{r^{7}}\\right] = 4\\epsilon\\left[12\\frac{\\sigma^{12}}{r^{13}} - 6\\frac{\\sigma^{6}}{r^{7}}\\right]$$\n为清晰起见，可将此表达式因式分解：\n$$F_{\\mathrm{LJ}}(r) = \\frac{24\\epsilon}{r}\\left[2\\frac{\\sigma^{12}}{r^{12}} - \\frac{\\sigma^{6}}{r^{6}}\\right] = \\frac{24\\epsilon}{r}\\left[2\\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^{6}\\right]$$\n\nBuckingham 力 $F_{\\mathrm{B}}(r)$ 的推导：\nBuckingham 势由下式给出：\n$$U_{\\mathrm{B}}(r) = A\\,\\exp\\left(-\\frac{r}{\\rho}\\right) - \\frac{C}{r^{6}}$$\n将第二项用负指数重写：\n$$U_{\\mathrm{B}}(r) = A\\,\\exp\\left(-\\frac{r}{\\rho}\\right) - C r^{-6}$$\n对 $U_{\\mathrm{B}}(r)$ 关于 $r$ 求导：\n$$\\frac{dU_{\\mathrm{B}}(r)}{dr} = A\\,\\exp\\left(-\\frac{r}{\\rho}\\right)\\left(-\\frac{1}{\\rho}\\right) - C(-6)r^{-7}$$\n$$\\frac{dU_{\\mathrm{B}}(r)}{dr} = -\\frac{A}{\\rho}\\exp\\left(-\\frac{r}{\\rho}\\right) + \\frac{6C}{r^{7}}$$\n力是该导数的负值：\n$$F_{\\mathrm{B}}(r) = -\\frac{dU_{\\mathrm{B}}(r)}{dr} = -\\left[-\\frac{A}{\\rho}\\exp\\left(-\\frac{r}{\\rho}\\right) + \\frac{6C}{r^{7}}\\right] = \\frac{A}{\\rho}\\exp\\left(-\\frac{r}{\\rho}\\right) - \\frac{6C}{r^{7}}$$\n\n第 2 部分：截断方案分析\n\n我们分析在截断距离 $r_c$ 处，势 $U(r)$、力 $F(r) = -U'(r)$ 和力的导数 $F'(r) = -U''(r)$ 的连续性。对于所有方案，当 $r > r_c$ 时，修正后的势及其导数均为零。因此，从上方趋近的极限为 $U(r_c^+) = 0$、$F(r_c^+) = 0$ 和 $F'(r_c^+) = 0$。分析重点是从下方趋近的极限 $r \\to r_c^-$。在 $r_c$ 处某量 $f(r)$ 的失配定义为 $\\Delta f = f(r_c^+) - f(r_c^-)$。\n\n我们使用原始势 $U(r)$ 在 $r_c$ 附近对 $r  r_c$ 的泰勒级数展开。令 $r=r_c-\\delta$，其中 $\\delta > 0$ 且 $\\delta \\to 0$。\n$$U(r_c-\\delta) = U(r_c) - \\delta U'(r_c) + \\frac{\\delta^2}{2}U''(r_c) - O(\\delta^3)$$\n$$U'(r_c-\\delta) = U'(r_c) - \\delta U''(r_c) + \\frac{\\delta^2}{2}U'''(r_c) - O(\\delta^3)$$\n$$U''(r_c-\\delta) = U''(r_c) - \\delta U'''(r_c) + O(\\delta^2)$$\n\n简单截断 (ST)\n当 $r  r_c$ 时，$U_{\\mathrm{ST}}(r) = U(r)$。\n- 势：$U_{\\mathrm{ST}}(r_c^-) = \\lim_{r \\to r_c^-} U(r) = U(r_c)$。势是不连续的，跳跃值为 $\\Delta U = 0 - U(r_c) = -U(r_c)$。\n- 力：$F_{\\mathrm{ST}}(r) = -U'(r)$。因此，$F_{\\mathrm{ST}}(r_c^-) = -U'(r_c)$。力是不连续的，跳跃值为 $\\Delta F = 0 - (-U'(r_c)) = U'(r_c)$。\n- 力的导数：$F'_{\\mathrm{ST}}(r) = -U''(r)$。因此，$F'_{\\mathrm{ST}}(r_c^-) = -U''(r_c)$。力的导数是不连续的，跳跃值为 $\\Delta F' = 0 - (-U''(r_c)) = U''(r_c)$。\n\n势移 (SP)\n当 $r  r_c$ 时，$U_{\\mathrm{SP}}(r) = U(r) - U(r_c)$。\n- 势：$U_{\\mathrm{SP}}(r_c^-) = \\lim_{r \\to r_c^-} [U(r) - U(r_c)] = U(r_c) - U(r_c) = 0$。势是连续的，$\\Delta U = 0$。\n- 力：$F_{\\mathrm{SP}}(r) = -\\frac{d}{dr}[U(r) - U(r_c)] = -U'(r)$。因此，$F_{\\mathrm{SP}}(r_c^-) = -U'(r_c)$。力是不连续的，跳跃值为 $\\Delta F = 0 - (-U'(r_c)) = U'(r_c)$。\n- 力的导数：$F'_{\\mathrm{SP}}(r) = -U''(r)$。因此，$F'_{\\mathrm{SP}}(r_c^-) = -U''(r_c)$。力的导数是不连续的，跳跃值为 $\\Delta F' = 0 - (-U''(r_c)) = U''(r_c)$。\n\n力移 (SF)\n当 $r  r_c$ 时，$U_{\\mathrm{SF}}(r) = U(r) - U(r_c) - (r-r_c)U'(r_c)$。这是 $U(r)$ 与其在 $r_c$ 处的一阶泰勒近似之间的差值。\n- 势：使用 $U(r)$ 在 $r=r_c-\\delta$ 处的泰勒展开：\n$U_{\\mathrm{SF}}(r_c-\\delta) = U(r_c-\\delta) - U(r_c) - (-\\delta)U'(r_c) \\approx [U(r_c) - \\delta U'(r_c) + \\frac{\\delta^2}{2}U''(r_c)] - U(r_c) + \\delta U'(r_c) = \\frac{\\delta^2}{2}U''(r_c)$。\n当 $\\delta \\to 0$ 时，$U_{\\mathrm{SF}}(r_c^-) \\to 0$。势是连续的，$\\Delta U = 0$。\n- 力：$F_{\\mathrm{SF}}(r) = -\\frac{d}{dr}[U(r) - U(r_c) - (r-r_c)U'(r_c)] = -[U'(r) - U'(r_c)]$。\n$F_{\\mathrm{SF}}(r_c^-) = \\lim_{r \\to r_c^-} -[U'(r) - U'(r_c)] = -[U'(r_c) - U'(r_c)] = 0$。力是连续的，$\\Delta F = 0$。\n- 力的导数：$F'_{\\mathrm{SF}}(r) = -\\frac{d}{dr}[U'(r) - U'(r_c)] = -U''(r)$。\n$F'_{\\mathrm{SF}}(r_c^-) = -U''(r_c)$。力的导数是不连续的，跳跃值为 $\\Delta F' = 0 - (-U''(r_c)) = U''(r_c)$。\n\n$r_c$ 处失配总结：\n| 方案 | 连续的量 | 失配 $\\Delta F$ | 失配 $\\Delta F'$ |\n| :---: | :---: | :---: | :---: |\n| ST | 无（通常情况下） | $U'(r_c)$ | $U''(r_c)$ |\n| SP | $U(r)$ | $U'(r_c)$ | $U''(r_c)$ |\n| SF | $U(r)$, $F(r)$ | $0$ | $U''(r_c)$ |\n\n与 $U_{\\mathrm{LJ}}(r)$ 和 $U_{\\mathrm{B}}(r)$ 的联系：\n失配取决于势在截断点的一阶和二阶导数值 $U'(r_c)$ 和 $U''(r_c)$。对于 Lennard-Jones 和 Buckingham 势，这些导数是：\n对于 $U_{\\mathrm{LJ}}(r)$：\n$$U'_{\\mathrm{LJ}}(r) = -F_{\\mathrm{LJ}}(r) = 4\\epsilon\\left[-12\\frac{\\sigma^{12}}{r^{13}} + 6\\frac{\\sigma^{6}}{r^{7}}\\right]$$\n$$U''_{\\mathrm{LJ}}(r) = \\frac{d}{dr}U'_{\\mathrm{LJ}}(r) = 4\\epsilon\\left[156\\frac{\\sigma^{12}}{r^{14}} - 42\\frac{\\sigma^{6}}{r^{8}}\\right]$$\n对于 $U_{\\mathrm{B}}(r)$：\n$$U'_{\\mathrm{B}}(r) = -F_{\\mathrm{B}}(r) = -\\frac{A}{\\rho}\\exp\\left(-\\frac{r}{\\rho}\\right) + \\frac{6C}{r^{7}}$$\n$$U''_{\\mathrm{B}}(r) = \\frac{d}{dr}U'_{\\mathrm{B}}(r) = \\frac{A}{\\rho^2}\\exp\\left(-\\frac{r}{\\rho}\\right) - \\frac{42C}{r^{8}}$$\n对于任何给定的 $r_c > 0$，可以计算这些表达式以找出每种势在每种截断方案下的具体不连续性。例如，在 ST 和 SP 方案中，LJ 势的力有一个大小为 $U'_{\\mathrm{LJ}}(r_c)$ 的跳跃，而在所有方案中，力的导数都有一个大小为 $U''_{\\mathrm{LJ}}(r_c)$ 的跳跃。类似的陈述对 Buckingham 势也成立。物理模拟要求力是连续的以确保能量守恒，这使得 SF 方案在这方面优于 ST 和 SP。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{24\\epsilon}{r}\\left[2\\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^{6}\\right]  \\frac{A}{\\rho}\\exp\\left(-\\frac{r}{\\rho}\\right) - \\frac{6C}{r^{7}} \\end{pmatrix}}$$", "id": "3420802"}, {"introduction": "在掌握了势能的基本性质（如力）之后，本练习 [@problem_id:3420796] 演示了如何将微观的势能函数形态与宏观的可测量物理量联系起来。通过分析Lennard-Jones势在其能量最低点附近的曲率并应用谐振子近似，我们可以推导出双原子分子的振动频率，这是光谱学和分子物理学中的一个基本概念。", "problem": "考虑一个双原子分子，其相互作用由兰纳-琼斯 (LJ) 势模拟，定义为 $U_{\\mathrm{LJ}}(r) = 4 \\epsilon \\left[ \\left( \\frac{\\sigma}{r} \\right)^{12} - \\left( \\frac{\\sigma}{r} \\right)^{6} \\right]$，其中 $\\epsilon$ 是一个特征能量标度，$\\sigma$ 是一个特征长度标度。平衡分离距离 $r_{e}$ 是使 $U_{\\mathrm{LJ}}(r)$ 最小化的 $r$ 值。从相对坐标的牛顿第二定律和势能在最小值点附近的泰勒展开出发，确定LJ势在最小值点处的曲率 $U''(r_{e})$，并用它来求出该双原子分子的谐振动角频率 $\\omega$（用约化质量 $\\mu$、$\\epsilon$ 和 $\\sigma$ 表示）。明确说明将曲率与振动频率联系起来所需的任何近似。最终答案应为仅包含 $\\epsilon$、$\\sigma$ 和 $\\mu$ 的单个 $\\omega$ 的闭式解析表达式；不要计算任何数值。最终表达式无需报告单位，也无需进行四舍五入。", "solution": "首先将根据所需标准对问题进行验证。\n\n### 步骤 1：提取已知条件\n- **势能函数**：兰纳-琼斯 (LJ) 势，$U_{\\mathrm{LJ}}(r) = 4 \\epsilon \\left[ \\left( \\frac{\\sigma}{r} \\right)^{12} - \\left( \\frac{\\sigma}{r} \\right)^{6} \\right]$。\n- **参数**：$\\epsilon$ 是一个特征能量标度；$\\sigma$ 是一个特征长度标度。\n- **定义**：平衡分离距离 $r_{e}$ 是使 $U_{\\mathrm{LJ}}(r)$ 最小化的 $r$ 值。\n- **目标 1**：确定 LJ 势在最小值点处的曲率 $U''(r_{e})$。\n- **目标 2**：使用曲率获得该双原子分子的谐振动角频率 $\\omega$。\n- **所需变量**：$\\omega$ 的最终表达式必须用约化质量 $\\mu$、$\\epsilon$ 和 $\\sigma$ 来表示。\n- **方法提示**：从相对坐标的牛顿第二定律和势能在最小值点附近的泰勒展开出发。\n- **近似**：明确说明所需的任何近似。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题基于兰纳-琼斯势，这是分子物理学和凝聚态物理学中的一个标准和基本模型。势能最小值、谐波近似和振动频率的概念是经典力学和量子力学的核心原理。该问题在科学上是合理的。\n- **良态性**：该问题提供了一个明确定义的势函数，并要求推导物理量。解题步骤逻辑结构清晰，并期望得到唯一答案。\n- **客观性**：该问题使用精确、标准的科学术语和数学表达式陈述，没有任何主观性或模糊性。\n- **缺陷分析**：该问题没有违反任何无效性标准。它在科学上是合理的，可形式化，是完整的，在其模型背景下是物理上现实的，是良态的，是一个非平凡的标准问题，并且是科学上可验证的。\n\n### 步骤 3：结论和行动\n问题是**有效的**。将提供完整解答。\n\n### 解题推导\n解题过程分为三个主要步骤：1. 求出平衡分离距离 $r_e$；2. 计算在该分离距离下势的曲率 $U''(r_e)$；3. 使用谐波近似将此曲率与振动角频率 $\\omega$ 联系起来。\n\n**1. 平衡分离距离 ($r_e$)**\n平衡分离距离 $r_e$ 对应于势能函数 $U_{\\mathrm{LJ}}(r)$ 的最小值。为找到这个最小值，我们计算 $U_{\\mathrm{LJ}}(r)$ 对 $r$ 的一阶导数，并令其为零。\n\n势能由下式给出：\n$$U_{\\mathrm{LJ}}(r) = 4 \\epsilon \\left[ \\left( \\frac{\\sigma}{r} \\right)^{12} - \\left( \\frac{\\sigma}{r} \\right)^{6} \\right] = 4\\epsilon ( \\sigma^{12}r^{-12} - \\sigma^6 r^{-6} )$$\n\n一阶导数是：\n$$\\frac{d U_{\\mathrm{LJ}}}{dr} = 4\\epsilon ( -12\\sigma^{12}r^{-13} - (-6)\\sigma^6 r^{-7} ) = 4\\epsilon ( -12\\sigma^{12}r^{-13} + 6\\sigma^6 r^{-7} )$$\n\n在 $r=r_e$ 处将导数设为零：\n$$4\\epsilon ( -12\\sigma^{12}r_e^{-13} + 6\\sigma^6 r_e^{-7} ) = 0$$\n由于 $\\epsilon \\neq 0$，我们有：\n$$12\\sigma^{12}r_e^{-13} = 6\\sigma^6 r_e^{-7}$$\n两边同除以 $6\\sigma^6 r_e^{-13}$ (因为 $r_e \\neq 0$):\n$$2\\sigma^6 = r_e^6$$\n解出 $r_e$:\n$$r_e = 2^{1/6}\\sigma$$\n\n**2. 平衡点处的曲率 ($U''(r_e)$)**\n势的曲率是其二阶导数 $U''(r)$。我们首先通过对 $\\frac{dU_{\\mathrm{LJ}}}{dr}$ 求导来找到 $U''(r)$ 的一般表达式：\n$$U''(r) = \\frac{d^2 U_{\\mathrm{LJ}}}{dr^2} = \\frac{d}{dr} \\left[ 4\\epsilon ( -12\\sigma^{12}r^{-13} + 6\\sigma^6 r^{-7} ) \\right]$$\n$$U''(r) = 4\\epsilon [ (-12)(-13)\\sigma^{12}r^{-14} + (6)(-7)\\sigma^6 r^{-8} ]$$\n$$U''(r) = 4\\epsilon [ 156\\sigma^{12}r^{-14} - 42\\sigma^6 r^{-8} ]$$\n\n现在，我们在平衡分离距离 $r = r_e = 2^{1/6}\\sigma$ 处计算该表达式的值。首先使用关系式 $r_e^6 = 2\\sigma^6$ 在代数上更简单。\n根据这个关系式，我们可以写出 $\\sigma^6 = \\frac{r_e^6}{2}$。将此代入 $U''(r_e)$ 的表达式中：\n$$U''(r_e) = 4\\epsilon \\left[ 156\\sigma^{12}r_e^{-14} - 42\\left(\\frac{r_e^6}{2}\\right) r_e^{-8} \\right]$$\n$$U''(r_e) = 4\\epsilon \\left[ 156(\\sigma^6)^2 r_e^{-14} - 21 r_e^{-2} \\right]$$\n$$U''(r_e) = 4\\epsilon \\left[ 156\\left(\\frac{r_e^6}{2}\\right)^2 r_e^{-14} - 21 r_e^{-2} \\right]$$\n$$U''(r_e) = 4\\epsilon \\left[ 156\\frac{r_e^{12}}{4} r_e^{-14} - 21 r_e^{-2} \\right]$$\n$$U''(r_e) = 4\\epsilon \\left[ 39 r_e^{-2} - 21 r_e^{-2} \\right] = 4\\epsilon (18 r_e^{-2}) = \\frac{72\\epsilon}{r_e^2}$$\n代入 $r_e^2 = (2^{1/6}\\sigma)^2 = 2^{1/3}\\sigma^2$:\n$$U''(r_e) = \\frac{72\\epsilon}{2^{1/3}\\sigma^2}$$\n这就是势在平衡点处的曲率。\n\n**3. 振动角频率 ($\\omega$)**\n问题要求使用势的泰勒展开。对于偏离平衡位置的小位移 $x = r - r_e$，势 $U(r)$ 可以用其在 $r_e$ 附近的泰勒级数来近似：\n$$U(r) \\approx U(r_e) + U'(r_e)(r-r_e) + \\frac{1}{2}U''(r_e)(r-r_e)^2 + \\mathcal{O}((r-r_e)^3)$$\n根据平衡的定义，$U'(r_e) = 0$。忽略恒定的能量偏移 $U(r_e)$ 和高阶项，小振动的势为：\n$$U(x) \\approx \\frac{1}{2}U''(r_e)x^2$$\n这就是**谐波近似**。该势具有简谐振子 $U(x) = \\frac{1}{2}kx^2$ 的形式，其中有效弹簧常数 $k$ 是势在最小值点处的曲率：\n$$k = U''(r_e) = \\frac{72\\epsilon}{2^{1/3}\\sigma^2}$$\n\n具有约化质量 $\\mu$ 的双原子分子相对坐标的运动方程由牛顿第二定律给出：\n$$\\mu \\ddot{x} = F = -\\frac{dU}{dx} = -kx$$\n这给出了简谐运动的标准方程：\n$$\\ddot{x} + \\frac{k}{\\mu}x = 0$$\n该运动的角频率由下式给出：\n$$\\omega = \\sqrt{\\frac{k}{\\mu}}$$\n代入 $k$ 的表达式：\n$$\\omega = \\sqrt{\\frac{1}{\\mu} \\left( \\frac{72\\epsilon}{2^{1/3}\\sigma^2} \\right)} = \\sqrt{\\frac{72\\epsilon}{2^{1/3}\\mu\\sigma^2}}$$\n为了简化数值因子：\n$$\\frac{72}{2^{1/3}} = \\frac{36 \\times 2}{2^{1/3}} = 36 \\times 2^{1-1/3} = 36 \\times 2^{2/3}$$\n所以 $\\omega^2$ 的表达式变为：\n$$\\omega^2 = \\frac{36 \\cdot 2^{2/3} \\epsilon}{\\mu\\sigma^2}$$\n取平方根得到角频率的最终表达式：\n$$\\omega = \\sqrt{\\frac{36 \\cdot 2^{2/3} \\epsilon}{\\mu\\sigma^2}} = \\frac{6 \\cdot (2^{2/3})^{1/2}}{\\sigma} \\sqrt{\\frac{\\epsilon}{\\mu}} = \\frac{6 \\cdot 2^{1/3}}{\\sigma} \\sqrt{\\frac{\\epsilon}{\\mu}}$$\n这可以写成一个单一的表达式：\n$$\\omega = 6 \\cdot 2^{1/3} \\sqrt{\\frac{\\epsilon}{\\mu\\sigma^2}}$$\n这就是该双原子分子的谐振动角频率。", "answer": "$$\\boxed{6 \\cdot 2^{1/3} \\sqrt{\\frac{\\epsilon}{\\mu \\sigma^2}}}$$", "id": "3420796"}, {"introduction": "本练习 [@problem_id:3420768] 将挑战从简单的粒子对相互作用提升到更实际的场景：单个粒子与连续固体表面间的相互作用。它不仅要求你运用解析技巧来简化问题，还需要你具备数值计算的专业知识来实现一个稳定高效的积分方案，这真实地反映了计算物理学家在研究工作中面临的实际任务。", "problem": "要求您计算一个点粒子在高度 $z  0$ 处，位于一个占据半空间 $z' \\le 0$ 的半无限平面墙上方的连续积分墙势。墙体具有均匀的数密度 $n_{\\mathrm{w}}$，并对粒子施加一种 Buckingham 类型的对相互作用，其模型为 $v(r) = A \\exp(-r/\\lambda) - C_6 r^{-6}$，其中 $A$ 和 $C_6$ 是相互作用系数，$\\lambda$ 是排斥长度尺度。在高度 $z$ 处的连续墙势定义为\n$$\n\\Phi(z) = n_{\\mathrm{w}} \\int_{z' \\le 0} v\\!\\left(\\lvert \\mathbf{r} - \\mathbf{r}' \\rvert\\right) \\, d^3 \\mathbf{r}' \\, ,\n$$\n其中粒子位置为 $\\mathbf{r} = (0,0,z)$。您的任务是实现一种数值稳定且高效的求积方案，用于评估给定参数集下的 $\\Phi(z)$，确保在 $z$ 较小和排斥范围较刚性（$\\lambda$ 较小）时方案的鲁棒性。\n\n设计约束和要求：\n- 从基本原理出发：将势能定义为对势在墙体积上的空间积分，并使用标准坐标变换。不得预先假设任何目标公式。\n- 利用圆柱对称性，尽可能解析地消去角坐标和径向坐标，将三维积分简化为一维积分。确保所得到的一维积分在 $z \\to 0^+$ 时是良态的。\n- 对于指数排斥项，设计一种在 $[0,\\infty)$ 上稳定且对小 $\\lambda$ 稳定的求积方法。对于此部分，您必须采用适用于 $[0,\\infty)$ 上具有指数衰减的积分变换，并通过使用与指数权重匹配的节点和权重的一般化高斯求积法则进行求值。\n- 对于长程吸引的 $r^{-6}$ 贡献，避免会遭受近场刚性问题的朴素数值积分。使用一种经数学证明的简化方法，该方法可以消除任何可积奇点，并对所有 $z  0$ 均精确。\n- 所有物理参数必须使用一致的单位：距离单位为纳米 (nm)，数密度单位为 nm$^{-3}$，能量单位为千焦耳/摩尔 (kJ/mol)。您的最终答案必须以浮点数形式报告，单位为 kJ/mol。\n- 数值角度单位不适用；不报告任何角度。\n- 百分比不适用，不得使用。\n\n测试套件：\n为以下五个参数集评估 $\\Phi(z)$，每个参数集以元组 $(z, n_{\\mathrm{w}}, A, \\lambda, C_6)$ 的形式给出，单位为 $(\\mathrm{nm}, \\mathrm{nm}^{-3}, \\mathrm{kJ/mol}, \\mathrm{nm}, \\mathrm{kJ\\cdot nm}^6/\\mathrm{mol})$：\n1. $(0.020,\\; 33.3,\\; 1.0\\times 10^6,\\; 0.020,\\; 0.00614)$\n2. $(0.050,\\; 33.3,\\; 1.0\\times 10^6,\\; 0.020,\\; 0.00614)$\n3. $(0.500,\\; 33.3,\\; 1.0\\times 10^6,\\; 0.020,\\; 0.00614)$\n4. $(0.200,\\; 33.3,\\; 5.0\\times 10^5,\\; 0.030,\\; 0.00614)$\n5. $(1.000,\\; 33.3,\\; 1.0\\times 10^6,\\; 0.020,\\; 0.03000)$\n\n实现和输出规范：\n- 将上述算法实现在一个单一的、自包含的程序中。\n- 对于指数排斥贡献，使用基于变量替换的数值稳定求积法，将半无限域映射到一个权重为 $\\exp(-x)$ 的加权积分，并使用为该权重设计的高斯求积法进行求值。\n- 对于吸引的 $r^{-6}$ 贡献，解析地消去径向坐标，以获得一个对于所有 $z  0$ 都表现良好的一维简化积分，并尽可能以闭式解的形式精确求值，以避免抵消或刚性问题。\n- 您的程序应计算每个测试用例的 $\\Phi(z)$，并将结果以单行逗号分隔列表的形式输出，并用方括号括起来，例如：\"[val1,val2,val3,val4,val5]\"。\n- 报告每个浮点数结果，单位为 kJ/mol，四舍五入到六位小数。\n\n您的程序必须只产生一行输出，其中包含指定格式的五个浮点数列表。输出中不允许有任何其他文本。", "solution": "该问题要求计算一个点粒子在高度 $z  0$ 处，位于一个占据半空间 $z' \\le 0$ 的半无限平面墙上方的连续积分墙势 $\\Phi(z)$。墙体具有均匀数密度 $n_{\\mathrm{w}}$。粒子与墙体微元之间的相互作用由 Buckingham 对势描述，即 $v(r) = A \\exp(-r/\\lambda) - C_6 r^{-6}$。\n\n总势能 $\\Phi(z)$ 由对势在整个墙体积上的积分定义：\n$$\n\\Phi(z) = n_{\\mathrm{w}} \\int_{z' \\le 0} v\\!\\left(\\lvert \\mathbf{r} - \\mathbf{r}' \\rvert\\right) \\, d^3 \\mathbf{r}'\n$$\n其中粒子位于位置 $\\mathbf{r} = (0, 0, z)$，积分遍及墙内所有点 $\\mathbf{r}'$。\n\n为了计算这个三维积分，我们利用系统的圆柱对称性。我们将位置向量 $\\mathbf{r}'$ 用圆柱坐标 $(\\rho, \\phi, z')$ 表示，即 $x' = \\rho \\cos\\phi$，$y' = \\rho \\sin\\phi$，体积微元为 $d^3 \\mathbf{r}' = \\rho \\, d\\rho \\, d\\phi \\, dz'$。粒子与体积微元之间的距离为 $r = \\lvert \\mathbf{r} - \\mathbf{r}' \\rvert = \\sqrt{(x')^2 + (y')^2 + (z-z')^2} = \\sqrt{\\rho^2 + (z-z')^2}$。\n\n$\\Phi(z)$ 的积分可以写成：\n$$\n\\Phi(z) = n_{\\mathrm{w}} \\int_{-\\infty}^{0} dz' \\int_{0}^{2\\pi} d\\phi \\int_{0}^{\\infty} d\\rho \\, \\rho \\, v\\left(\\sqrt{\\rho^2 + (z-z')^2}\\right)\n$$\n由于被积函数不依赖于方位角 $\\phi$，对 $\\phi$ 的积分产生一个因子 $2\\pi$：\n$$\n\\Phi(z) = 2\\pi n_{\\mathrm{w}} \\int_{-\\infty}^{0} dz' \\int_{0}^{\\infty} d\\rho \\, \\rho \\, v\\left(\\sqrt{\\rho^2 + (z-z')^2}\\right)\n$$\n为进一步简化，我们对关于 $\\rho$ 的内层积分进行变量替换。令 $s^2 = \\rho^2 + (z-z')^2$。则 $2s \\, ds = 2\\rho \\, d\\rho$，所以 $\\rho \\, d\\rho = s \\, ds$。当 $\\rho=0$ 时，$s$ 的积分下限为 $|z-z'|$。因为 $z  0$ 且 $z' \\le 0$，我们有 $z-z'  0$，所以 $s = z-z'$。上限为 $s \\to \\infty$。积分变为：\n$$\n\\Phi(z) = 2\\pi n_{\\mathrm{w}} \\int_{-\\infty}^{0} \\left( \\int_{z-z'}^{\\infty} v(s) s \\, ds \\right) dz'\n$$\n现在我们定义一个新变量 $u = z-z'$。则 $du = -dz'$。$u$ 的积分限从 $z - (-\\infty) = \\infty$ 到 $z - 0 = z$。反转积分限会引入一个负号，与来自 $du$ 的负号抵消：\n$$\n\\Phi(z) = 2\\pi n_{\\mathrm{w}} \\int_{z}^{\\infty} \\left( \\int_{u}^{\\infty} v(s) s \\, ds \\right) du\n$$\n现在我们可以将 $v(r)$ 分解为其排斥和吸引分量来计算势能，$\\Phi(z) = \\Phi_{\\text{rep}}(z) + \\Phi_{\\text{att}}(z)$。\n\n**吸引贡献 ($\\Phi_{\\text{att}}(z)$)**\n\n对势的吸引部分是 $v_{\\text{att}}(s) = -C_6 s^{-6}$。内层积分为：\n$$\n\\int_{u}^{\\infty} (-C_6 s^{-6}) s \\, ds = -C_6 \\int_{u}^{\\infty} s^{-5} \\, ds = -C_6 \\left[ \\frac{s^{-4}}{-4} \\right]_{u}^{\\infty} = -C_6 \\left( 0 - \\frac{u^{-4}}{-4} \\right) = -\\frac{C_6}{4u^4}\n$$\n将此代入势能表达式中，吸引贡献为：\n$$\n\\Phi_{\\text{att}}(z) = 2\\pi n_{\\mathrm{w}} \\int_{z}^{\\infty} \\left( -\\frac{C_6}{4u^4} \\right) du = -\\frac{\\pi n_{\\mathrm{w}} C_6}{2} \\int_{z}^{\\infty} u^{-4} \\, du\n$$\n$$\n\\Phi_{\\text{att}}(z) = -\\frac{\\pi n_{\\mathrm{w}} C_6}{2} \\left[ \\frac{u^{-3}}{-3} \\right]_{z}^{\\infty} = -\\frac{\\pi n_{\\mathrm{w}} C_6}{2} \\left( 0 - \\frac{z^{-3}}{-3} \\right) = -\\frac{\\pi n_{\\mathrm{w}} C_6}{6z^3}\n$$\n这个解析结果是精确的，并且对所有 $z  0$ 都是良态的，满足了问题对吸引部分的要求。它将被直接实现。\n\n**排斥贡献 ($\\Phi_{\\text{rep}}(z)$)**\n\n排斥部分是 $v_{\\text{rep}}(s) = A \\exp(-s/\\lambda)$。内层积分为：\n$$\n\\int_{u}^{\\infty} A e^{-s/\\lambda} s \\, ds = A \\int_{u}^{\\infty} s e^{-s/\\lambda} \\, ds\n$$\n使用分部积分法，$\\int s e^{ks} ds = \\frac{s}{k}e^{ks} - \\frac{1}{k^2}e^{ks}$，其中 $k = -1/\\lambda$：\n$$\nA \\left[ -\\lambda s e^{-s/\\lambda} - \\lambda^2 e^{-s/\\lambda} \\right]_{u}^{\\infty} = A \\left[ -\\lambda(\\lambda+s)e^{-s/\\lambda} \\right]_{u}^{\\infty} = A \\left( 0 - (-\\lambda(\\lambda+u)e^{-u/\\lambda}) \\right) = A\\lambda(\\lambda+u)e^{-u/\\lambda}\n$$\n则势能的排斥贡献为：\n$$\n\\Phi_{\\text{rep}}(z) = 2\\pi n_{\\mathrm{w}} \\int_{z}^{\\infty} A\\lambda(\\lambda+u)e^{-u/\\lambda} \\, du\n$$\n根据问题的约束，我们必须使用特定的求积方案来计算此积分。我们首先通过令 $x = u-z$（即 $u = x+z$ 且 $du=dx$）将积分域从 $[z, \\infty)$ 变换到 $[0, \\infty)$：\n$$\n\\Phi_{\\text{rep}}(z) = 2\\pi n_{\\mathrm{w}} A\\lambda \\int_{0}^{\\infty} (\\lambda+x+z)e^{-(x+z)/\\lambda} \\, dx = 2\\pi n_{\\mathrm{w}} A\\lambda e^{-z/\\lambda} \\int_{0}^{\\infty} (\\lambda+z+x)e^{-x/\\lambda} \\, dx\n$$\n接下来，为了匹配目标权重函数 $e^{-t}$，我们进行替换 $t=x/\\lambda$，因此 $x=\\lambda t$ 且 $dx=\\lambda dt$：\n$$\n\\Phi_{\\text{rep}}(z) = 2\\pi n_{\\mathrm{w}} A\\lambda e^{-z/\\lambda} \\int_{0}^{\\infty} (\\lambda+z+\\lambda t)e^{-t} (\\lambda dt) = 2\\pi n_{\\mathrm{w}} A\\lambda^2 e^{-z/\\lambda} \\int_{0}^{\\infty} (\\lambda+z+\\lambda t)e^{-t} \\, dt\n$$\n该积分形式为 $\\int_0^\\infty g(t)e^{-t}dt$，其中 $g(t) = \\lambda+z+\\lambda t$。我们使用高斯-拉盖尔求积法来计算它，该方法将积分近似为一个加权和：\n$$\n\\int_0^\\infty g(t)e^{-t}dt \\approx \\sum_{i=1}^{N} w_i g(t_i)\n$$\n其中 $t_i$ 和 $w_i$ 是 $N$ 阶高斯-拉盖尔求积的节点和权重。由于 $g(t)$ 是一次多项式，对于任何 $N \\ge 1$，该求积都是精确的。实现将使用一组预先计算的节点和权重来按规定数值地执行此求和。\n\n求和为 $\\sum_{i=1}^{N} w_i (\\lambda+z+\\lambda t_i) = (\\lambda+z)\\sum w_i + \\lambda \\sum w_i t_i$。对于高斯-拉盖尔求积，$\\sum w_i = 1$ 且 $\\sum w_i t_i = 1$，因此积分值为 $(\\lambda+z) \\cdot 1 + \\lambda \\cdot 1 = z+2\\lambda$。排斥部分的最终表达式为：\n$$\n\\Phi_{\\text{rep}}(z) = 2\\pi n_{\\mathrm{w}} A \\lambda^2 (z+2\\lambda) e^{-z/\\lambda}\n$$\n代码将明确实现求和过程，以遵守问题的约束。\n\n**总势能**\n总势能是两个贡献的总和：\n$$\n\\Phi(z) = \\Phi_{\\text{rep}}(z) + \\Phi_{\\text{att}}(z) = 2\\pi n_{\\mathrm{w}} A \\lambda^2 (z+2\\lambda) e^{-z/\\lambda} - \\frac{\\pi n_{\\mathrm{w}} C_6}{6 z^3}\n$$\n这个完整的公式将用于计算给定测试用例的势能。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import roots_laguerre\n\ndef solve():\n    \"\"\"\n    Computes the continuum-integrated wall potential for a Buckingham-type fluid\n    at a given height z above a semi-infinite planar wall.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # (z, n_w, A, lambda, C6) with units\n    # (nm, nm^-3, kJ/mol, nm, kJ*nm^6/mol)\n    test_cases = [\n        (0.020, 33.3, 1.0e6, 0.020, 0.00614),\n        (0.050, 33.3, 1.0e6, 0.020, 0.00614),\n        (0.500, 33.3, 1.0e6, 0.020, 0.00614),\n        (0.200, 33.3, 5.0e5, 0.030, 0.00614),\n        (1.000, 33.3, 1.0e6, 0.020, 0.03000),\n    ]\n\n    results = []\n    \n    # Set the order for Gauss-Laguerre quadrature.\n    # Since the integrand is linear, N=1 is sufficient for exactness.\n    # A higher number is used for robustness and to demonstrate the method.\n    N_QUADRATURE = 32\n    nodes, weights = roots_laguerre(N_QUADRATURE)\n\n    for case in test_cases:\n        z, nw, A, lam, C6 = case\n\n        # 1. Attractive contribution (analytically solved)\n        # Phi_att(z) = - (pi * n_w * C6) / (6 * z^3)\n        phi_att = - (np.pi * nw * C6) / (6 * z**3)\n\n        # 2. Repulsive contribution (numerical quadrature as required)\n        # The integral to be evaluated is of the form:\n        # integral from 0 to inf of g(t) * exp(-t) dt\n        # where g(t) = lam + z + lam * t\n        \n        # Define the function g(t) for the quadrature\n        g = lambda t: lam + z + lam * t\n        \n        # Evaluate the integral using Gauss-Laguerre quadrature sum\n        # integral_val = sum(w_i * g(t_i)) for i=1 to N\n        integral_val = np.sum(weights * g(nodes))\n        \n        # The full repulsive potential is:\n        # Phi_rep(z) = 2 * pi * n_w * A * lam^2 * exp(-z/lam) * integral_val\n        prefactor_rep = 2 * np.pi * nw * A * lam**2 * np.exp(-z / lam)\n        phi_rep = prefactor_rep * integral_val\n\n        # 3. Total potential\n        total_phi = phi_rep + phi_att\n        \n        # Round to six decimal places as specified\n        results.append(round(total_phi, 6))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3420768"}]}