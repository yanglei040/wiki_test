## 引言
在[分子模拟](@entry_id:182701)的世界中，精确捕捉分子的三维结构是理解其功能和性质的先决条件。虽然标准的键长、键角和[二面角](@entry_id:185221)势能项构成了[分子力学](@entry_id:176557)的基础，足以描绘出分子的共价骨架，但它们本身并不足以应对所有结构上的挑战。一个关键的知识缺口在于如何强制和维持特定的[立体化学](@entry_id:166094)特征，例如芳香环的共[平面性](@entry_id:274781)、[肽键](@entry_id:144731)的刚性平面结构，以及手性中心在动态模拟过程中的构型稳定性。若无特定机制，这些关键的几何特征将在[热涨落](@entry_id:143642)的作用下逐渐丧失，导致模拟结果偏离物理现实。

为了解决这一问题，[分子力](@entry_id:203760)场引入了一类特殊的[势能](@entry_id:748988)项，即**[平面外弯曲](@entry_id:175779)（out-of-plane bending）**或**非正常扭转（improper torsion）**势。这些术语是维持分子精确立体构型的“守护者”，对于模拟从[生物大分子](@entry_id:265296)到先进材料的各类体系至关重要。本文旨在深入剖析这些势能项的理论与实践。在接下来的章节中，您将学习：

在 **“原理与机制”** 一章中，我们将首先从几何学出发，辨析[非正常二面角](@entry_id:750575)与正常[二面角](@entry_id:185221)的本质区别，并探讨其维持手性的数学基础。随后，我们将详细介绍谐波势、周期性势等多种函数形式及其物理应用，包括它们如何与系统的热力学性质（如[热容](@entry_id:137594)和压力）相关联。

在 **“应用与交叉学科联系”** 一章中，我们将把视野扩展到这些原理在不同科学领域的具体应用。您将看到[平面性](@entry_id:274781)势能项如何成为[力场](@entry_id:147325)开发的核心，如何在DNA和[蛋白质模拟](@entry_id:149255)中维持关键的结构基序，以及如何决定[石墨烯](@entry_id:143512)等二维材料的宏观力学行为。

最后，在 **“动手实践”** 部分，我们将通过一系列精心设计的计算问题，引导您将理论知识付诸实践，学习如何从[第一性原理计算](@entry_id:198754)中参数化[力场](@entry_id:147325)，分析构象平衡，并解决实际研究中可能遇到的复杂[优化问题](@entry_id:266749)。

## 原理与机制

在[分子力学](@entry_id:176557)中，维持分子的三维结构依赖于对键长、键角和二面角等[内坐标](@entry_id:169764)施加的[势能](@entry_id:748988)项。虽然这些项足以描述分子的基本共价骨架，但它们不足以完全定义和维持分子的特定[立体化学](@entry_id:166094)构型，特别是涉及平面性或手性的情况。例如，芳香环中的原子应保持共平面，而肽键由于[共振效应](@entry_id:155120)也具有显著的平面特征。同样，四面体手性中心的立体构型必须在模拟过程中得以保持。为了应对这些挑战，[力场](@entry_id:147325)引入了专门的势能项，通常称为**[平面外弯曲](@entry_id:175779)（out-of-plane bending）**或**非正常扭转（improper torsion）**项。本章将深入探讨这些势能项的几何基础、数学形式、物理应用以及在实际模拟中的数值考虑。

### 平面外运动的几何基础

要理解平面外势能项，首先必须将其与标准的**正常[二面角](@entry_id:185221)（proper dihedral angle）**区分开来。这两种类型的角度都由四个原子定义，但它们的原子连接性和所描述的物理变形有着根本的不同。

一个**正常[二面角](@entry_id:185221)** $\phi(i,j,k,l)$ 是围绕一根中心化学键的扭转或旋转的量度。它的定义基于四个**依次成键**的原子，即原子 $i$ 与 $j$ 成键， $j$ 与 $k$ 成键， $k$ 与 $l$ 成键（$i-j-k-l$）。从几何上看，这个角度是两个相交平面之间的夹角：一个是由原子 $(i,j,k)$ 定义的平面，另一个是由原子 $(j,k,l)$ 定义的平面。这两个平面共享中心键 $j-k$ 作为它们的交线。因此，$\phi$ 的变化直接对应于绕 $j-k$ 键的旋转，这是[分子构象](@entry_id:163456)变化（如[烷烃](@entry_id:185193)中的交错式和重叠式构象）的核心。

相比之下，一个**[非正常二面角](@entry_id:750575)（improper dihedral angle）** $\chi(i,j,k,l)$ 旨在量化一个原子相对于由其三个邻近原子定义的平面的偏离程度。其典型的拓扑结构是一个中心原子（例如 $j$）连接到三个其他原子（$i$, $k$, $l$）。在这种情况下，这四个原子不是顺序连接的。[非正常二面角](@entry_id:750575) $\chi$ 量化了中心原子 $j$ “突出”于由其三个[取代基](@entry_id:183115) $i,k,l$ 构成的平面的程度。这种运动通常被称为**锥形化（pyramidalization）**或[平面外弯曲](@entry_id:175779)。因此，[非正常二面角](@entry_id:750575)描述的不是绕单一[化学键](@entry_id:138216)的旋转，而是一种弯曲变形 [@problem_id:3431314]。

尽管有多种几何定义，但[非正常二面角](@entry_id:750575)通常被计算为两个平面之间的夹角。例如，对于中心原子为 $j$ 的原子团 $(i,j,k,l)$，一个常见的定义是将 $\chi$ 定义为平面 $(i,k,l)$ 与平面 $(i,j,k)$ 之间的夹角。无论采用何种精确定义，其核心功能是保持或惩罚偏离特定平面外构型的行为。

#### 手性与符号约定

[非正常二面角](@entry_id:750575)的一个关键特征是它是一个**[伪标量](@entry_id:196696)（pseudoscalar）**。这意味着它的值在刚体旋转下不变，但在空间反演（例如，通过镜面反射）下会改变符号。这一特性使其成为区分手性[对映异构体](@entry_id:149008)的理想工具。为了实现这一点，必须建立一个一致的符号约定。

这个符号约定通常基于向量的**标量三重积（scalar triple product）**。考虑一个中心原子 $j$ 连接到三个邻居 $i, k, l$。我们可以定义从中心原子指向邻居的三个向量：$\mathbf{v}_i = \mathbf{r}_i - \mathbf{r}_j$, $\mathbf{v}_k = \mathbf{r}_k - \mathbf{r}_j$, 和 $\mathbf{v}_l = \mathbf{r}_l - \mathbf{r}_j$。由这三个向量构成的平行六面体的有向体积由它们的标量三重积给出，例如 $S = \mathbf{v}_l \cdot (\mathbf{v}_i \times \mathbf{v}_k)$。

这个量 $S$ 的符号具有所有[伪标量](@entry_id:196696)所需的性质：
1.  它在平移和旋转下不变。
2.  在空间反演（$\mathbf{r} \to -\mathbf{r}$）下，每个向量都变号，导致 $S \to (-1)^3 S = -S$，即符号反转。
3.  对邻居原子进行奇数次[置换](@entry_id:136432)（例如，交换 $i$ 和 $k$）会改变叉乘的符号，从而使 $S$ 的符号反转。

因此，[非正常二面角](@entry_id:750575) $\chi$ 的符号可以根据[标量三重积](@entry_id:177480)的符号来定义。例如，我们可以定义一个由原子序对 $(i, k)$ 决定的参考平[面法向量](@entry_id:749211) $\mathbf{n}_{ik} = (\mathbf{r}_i - \mathbf{r}_j) \times (\mathbf{r}_k - \mathbf{r}_j)$。然后，$\chi$ 的符号可以由向量 $\mathbf{r}_l - \mathbf{r}_j$ 在该法向量上的投影符号决定。如果 $(\mathbf{r}_l - \mathbf{r}_j) \cdot \mathbf{n}_{ik} > 0$，则 $\chi$ 为正；如果为负，则 $\chi$ 为负。这种明确的、依赖于原子排序的符号约定使得[非正常二面角](@entry_id:750575)能够明确区分和维持一个手性中心的两种对映构型 [@problem_id:3431251]。

### 用于[平面性](@entry_id:274781)和手性的[势能](@entry_id:748988)形式

分子力场采用多种函数形式来为[非正常二面角](@entry_id:750575)构建[势能](@entry_id:748988)。选择哪种形式取决于所需的精度、[计算效率](@entry_id:270255)以及所模拟的物理现象。

#### [谐波](@entry_id:181533)势

最简单且最广泛使用的形式是**[谐波](@entry_id:181533)势（harmonic potential）**：
$$
U_{\text{imp}}(\chi) = \frac{1}{2}k_{\chi}(\chi - \chi_{0})^{2}
$$
其中 $k_{\chi}$ 是力常数，决定了[势阱](@entry_id:151413)的刚度；$\chi$ 是瞬时的[非正常二面角](@entry_id:750575)；$\chi_{0}$ 是其平衡值。这个[势能函数](@entry_id:200753)通过在偏离平衡构型时施加一个与偏离量平方成正比的能量惩罚来起作用。

该[势能](@entry_id:748988)项的用途完全取决于平衡角 $\chi_0$ 的选择：

1.  **强制[平面性](@entry_id:274781)**：对于期望呈平面构型的化学基团，如 sp² 杂化的碳（例如在羰基或芳香环中），其平面构型对应于 $\chi = 0$。因此，通过设置 $\chi_0 = 0$，势能变为 $U_{\text{imp}} = \frac{1}{2}k_{\chi}\chi^2$。该势能在 $\chi = 0$ 时能量最低，任何偏离平面的锥形化都会受到能量惩罚，从而有效地将原子保持在平面上 [@problem_id:3431321]。

2.  **强制手性**：对于一个四面体手性中心，其几何构型本质上是非平面的，对应一个非零的[非正常二面角](@entry_id:750575)，我们称之为 $\chi_{\text{ref}}$。为了维持特定的手性（例如 R 或 S 构型），需要将平衡角设置为该构型的参考值，即 $\chi_0 = \chi_{\text{ref}}$。其[对映异构体](@entry_id:149008)的构型将对应于角度 $-\chi_{\text{ref}}$。当分子试图翻转其手性时，势能会变为 $U_{\text{imp}}(-\chi_{\text{ref}}) = \frac{1}{2}k_{\chi}(-\chi_{\text{ref}} - \chi_{\text{ref}})^2 = 2k_{\chi}\chi_{\text{ref}}^2$。这个显著的[能量势](@entry_id:748988)垒阻止了手性中心的构型翻转，从而在模拟过程中保持了正确的[立体化学](@entry_id:166094) [@problem_id:3431321]。

#### 周期性势

另一种替代方法是使用**周期性（傅里叶）势（periodic or Fourier potential）**，其形式与正常二面角势相同：
$$
U_{\text{F}}(\phi) = k_{\text{F}}[1 + \cos(n\phi - \delta)]
$$
其中 $\phi$ 是根据特定原子[顺序计算](@entry_id:273887)的[非正常二面角](@entry_id:750575)， $k_{\text{F}}$ 是[力常数](@entry_id:156420)， $n$ 是周期性， $\delta$ 是相移。为了用此形式强制[平面性](@entry_id:274781)，必须精心选择参数，使其在平面构型处产生一个能量极小值。

一个势能函数在某点是局部极小值的条件是：其一阶导数为零，[二阶导数](@entry_id:144508)为正。对于周期性势，这要求在平面构型对应的角度 $\phi^{\star}$ 处，$\frac{dU_{\text{F}}}{d\phi} = -n k_{\text{F}} \sin(n\phi^{\star} - \delta) = 0$，且 $\frac{d^2U_{\text{F}}}{d\phi^2} = -n^2 k_{\text{F}} \cos(n\phi^{\star} - \delta) > 0$。

第一个条件要求 $n\phi^{\star} - \delta = m\pi$（$m$ 为整数）。第二个条件要求 $\cos(m\pi)  0$（假设 $k_F > 0$），这意味着 $m$ 必须是奇数。因此，要使 $\phi^{\star}$ 成为能量极小点，必须满足 $\delta \equiv n\phi^{\star} - \pi \pmod{2\pi}$。例如，如果一种原子排序约定使得平面构型对应于 $\phi^{\star} = 0$，那么选择 $\delta = \pi$ 就会在 $\phi = 0$ 处产生一个能量极小值。[力场](@entry_id:147325)的开发者可以通过选择合适的原子顺序和参数 $(n, \delta)$，使周期性势在局部上等效于[谐波](@entry_id:181533)平面外势 [@problem_id:3431250]。

#### 四次势

虽然[谐波](@entry_id:181533)势在[平衡点](@entry_id:272705)附近表现良好，但它在能量较高时可能过于“软”，无法阻止在高温或高应力下发生大的构象变化，例如平面基团的意外翻转。为了解决这个问题，可以引入一个**四次势（quartic potential）**：
$$
V_{\text{q}}(\chi) = a \chi^{2} + b \chi^{4}
$$
其中 $a$ 和 $b$ 均为正常数。通过设置 $2a = k_{\chi}$（其中 $k_{\chi}$ 是等效[谐波](@entry_id:181533)势的力常数），可以确保两种势在 $\chi=0$ 附近的曲率相同，从而具有相同的低频振动光谱。然而，$\chi^4$ 项在 $\chi$ 值较大时提供了一个更强的排斥力，显著降低了发生大偏离（即“[缺陷形成](@entry_id:137162)”）的概率，尤其是在高温下。这使得四次势在需要鲁棒地维持平面性的同时，又能精确描述小幅度[振动](@entry_id:267781)的情况下，成为一个更优越的模型 [@problem_id:3431277]。

### 物理应用与后果

平面外[势能](@entry_id:748988)项在分子模拟中具有深远的物理意义，影响着系统的[热力学](@entry_id:141121)、动力学和结构特性。

#### [热力学与动力学](@entry_id:146887)性质

从[统计力](@entry_id:194984)学的角度来看，[谐波](@entry_id:181533)平面外势能 $U = \frac{1}{2}k_{\chi}\chi^2$ 是一个二次自由度。根据经典**[能量均分定理](@entry_id:136972)（equipartition theorem）**，在温度为 $T$ 的[热平衡](@entry_id:141693)状态下，该自由度的平均势能为 $\frac{1}{2}k_B T$。因此，我们有：
$$
\langle U \rangle = \frac{1}{2}k_{\chi}\langle \chi^2 \rangle = \frac{1}{2}k_B T
$$
这直接导出了平面外角度的均方根涨落（root-mean-square fluctuation, RMSF）：
$$
\chi_{\text{rms}} = \sqrt{\langle \chi^2 \rangle} = \sqrt{\frac{k_B T}{k_{\chi}}}
$$
这个简单的关系式蕴含着深刻的物理直觉：平面外涨落的幅度随着温度的升高而增加，并随着[势阱](@entry_id:151413)刚度（$k_{\chi}$）的增加而减小。这为理解和预测分子在不同温度下的柔性提供了量化依据 [@problem_id:3431263]。

更完整的分析表明，对于一个[经典谐振子](@entry_id:153404)模型（[哈密顿量](@entry_id:172864)为 $H = \frac{p^2}{2I} + \frac{1}{2}k_{\chi}\chi^2$），其对系统总能量的平均贡献为 $\langle E \rangle = k_B T$，对恒容[热容](@entry_id:137594)的贡献为 $C_V = k_B$。这些结果进一步强调了平面外模式作为经典[热力学](@entry_id:141121)自由度的行为 [@problem_id:3431271]。

#### 在多肽模拟中的应用

维持[肽键](@entry_id:144731)（-CO-NH-）的[平面性](@entry_id:274781)是[蛋白质模拟](@entry_id:149255)的基石。这种[平面性](@entry_id:274781)源于 $\pi$ 电子的[离域](@entry_id:183327)和共振，赋予了 C-N 键显著的双键特性。[力场](@entry_id:147325)通常采用两种主要策略来模拟这一关键特征：

1.  **直接[谐波](@entry_id:181533)约束**：大多数[力场](@entry_id:147325)在肽键的羰基碳或氮原子上施加一个谐波非正常[扭转势](@entry_id:756059)。这种方法直接、高效且稳健地惩罚偏离平面的行为。其主要局限性在于其“静态”性质：固定的[力常数](@entry_id:156420) $k_{\chi}$ 可能过于刚性，无法描述在某些化学环境（如强[氢键作用](@entry_id:142832)）下可能发生的、物理上合理的轻微锥形化。它也不能自发地响应环境引起的共振效应变化 [@problem_id:3431299]。

2.  **校正图（CMAP）**：更先进的[力场](@entry_id:147325)（如 [CHARMM](@entry_id:747300) 系列）引入了**校正图（Correction Map, CMAP）**项。与直接约束平面性不同，CMAP 是一个施加在[主链](@entry_id:183224)[二面角](@entry_id:185221)对 $(\phi, \psi)$ 上的二维网格化校正势能，$U_{\text{CMAP}} = f(\phi, \psi)$。它通过校正 $(\phi, \psi)$ 的能量[曲面](@entry_id:267450)，使其更接近于高精度量子力学计算的结果，从而*间接*地改善了整个主链的构象，包括[肽键](@entry_id:144731)的平面性。CMAP 本身不直接约束平面外偏离，它仍然需要依赖于标准的 $\omega$ 二面角势和/或非正常[扭转势](@entry_id:756059)来维持平面性。CMAP 的优势在于能够更准确地再现实验观察到的[蛋白质二级结构](@entry_id:169725)布居，但其保真度受限于训练集（通常是小的二肽模型），并且向[非标准氨基酸](@entry_id:195544)或修饰的转移性可能较差。在[力场](@entry_id:147325)开发中，必须小心避免将 CMAP 与其他项（如非正常扭转）的效应“双重计算”，以免过度约束体系 [@problem_id:3431299]。

#### 对系统压力的贡献

在 NVT 或 NPT 系综的模拟中，瞬时[压力张量](@entry_id:147910) $\mathbf{P}$ 是通过**[维里定理](@entry_id:146441)（virial theorem）**计算的，它包含动能项和构型维里项 $\mathbf{W} = -\sum_{\alpha} \mathbf{r}_{\alpha} \otimes \mathbf{F}_{\alpha}$。体系的标量压力是 $p = \frac{1}{3V} (2K - \text{Tr}(\mathbf{W}))$，其中 $K$ 是总动能。

一个[势能](@entry_id:748988)项对压力的贡献取决于它如何随系统体积的变化而变化。对于所有仅依赖于角度（如键角、正常和[非正常二面角](@entry_id:750575)）的势能项，它们具有一个重要的共同性质：在对所有原子坐标进行[均匀缩放](@entry_id:267671)变换 $\mathbf{r}_{\alpha} \to \lambda \mathbf{r}_{\alpha}$ 时，角度值保持不变。这意味着这些势能函数是坐标的零次齐次函数。

根据[欧拉齐次函数定理](@entry_id:186434)，如果一个函数 $U(\mathbf{r})$ 是坐标的零次齐次函数，则 $\sum_{\alpha} \mathbf{r}_{\alpha} \cdot \nabla_{\mathbf{r}_{\alpha}} U(\mathbf{r}) = 0$。该表达式正是维里张量 $ \mathbf{W} = \sum_{\alpha} \mathbf{r}_{\alpha} \otimes (\nabla_{\mathbf{r}_{\alpha}} U) $ 的迹。因此，对于[非正常二面角](@entry_id:750575)势以及所有其他基于角度的势，其对维里[张量的迹](@entry_id:190669)的贡献恒为零。
$$
\text{Tr}(\mathbf{W}_{\text{imp}}) = 0
$$
这意味着，**[非正常二面角](@entry_id:750575)势对系统的瞬时标量压力没有贡献**。这是一个普遍而重要的结论，它简化了压力计算，并阐明了这些[内坐标](@entry_id:169764)势在力学上如何与系统的宏观状态量[解耦](@entry_id:637294) [@problem_id:3431308]。

### 高级主题与数值考量

尽管平面外势在概念上很强大，但在数值实现时可能会遇到挑战，尤其是在处理几何[奇异点](@entry_id:199525)时。

#### 数值不稳定性与正则化

一些平面外势的定义，例如基于中心原子到由其邻居定义的平面的高度，其数学表达式中包含一个归一化因子，即平[面法向量](@entry_id:749211)的模长 $|\mathbf{n}|$。例如，$U_{\text{plane}} = \frac{k}{2} \left( \frac{(\mathbf{r}_d - \mathbf{r}_a) \cdot \mathbf{n}}{|\mathbf{n}|} \right)^2$。当定义平面的三个原子（$a,b,c$）变得近似**共线（collinear）**时，[法向量](@entry_id:264185) $\mathbf{n} = (\mathbf{r}_b - \mathbf{r}_a) \times (\mathbf{r}_c - \mathbf{r}_a)$ 的模长将趋于零。这会导致[势能的梯度](@entry_id:173126)（即力）中出现 $|\mathbf{n}|^{-1}$ 或更高阶的奇异项，从而引发数值[溢出](@entry_id:172355)和模拟崩溃。

为了确保模拟的稳定性，特别是使用保持[能量守恒](@entry_id:140514)的辛[积分算法](@entry_id:192581)（如[速度 Verlet](@entry_id:137047) 算法）时，力必须是**保守的**（即可从一个单值势能函数中导出）且**光滑的**。处理上述奇异性时，必须保持这两个特性。

一些看似简单的修复方法是不可取的。例如，对过大的力设置一个上限（force capping）会破坏力的保守性，导致[能量不守恒](@entry_id:276143)。同样，在检测到近共线构型时突然切换到不同的[势能函数](@entry_id:200753)或约束，会引入[势能](@entry_id:748988)的不连续性，同样会导致严重的[能量漂移](@entry_id:748982) [@problem_id:3431296]。

稳健的解决方案是修改势能函数本身，使其在所有构型下都保持光滑和良好定义。两种有效的方法是：

1.  **正则化（Regularization）**：将分母中的 $|\mathbf{n}|$ 替换为一个正则化的范数，例如 $|\mathbf{n}|_{\varepsilon} = \sqrt{|\mathbf{n}|^2 + \varepsilon^2}$，其中 $\varepsilon$ 是一个小的正常数。修正后的[势能](@entry_id:748988) $U_{\varepsilon} = \frac{k}{2} \frac{((\mathbf{r}_d - \mathbf{r}_a) \cdot \mathbf{n})^2}{|\mathbf{n}|^2 + \varepsilon^2}$ 在任何构型下都是光滑的（$C^\infty$），因为分母恒为正，从而消除了奇异性。

2.  **切换函数（Switching Function）**：构造一个光滑的复合[势能](@entry_id:748988)。可以定义一个关于平面面积 $A = \frac{1}{2}|\mathbf{n}|$ 的光滑切换函数 $w(A)$，当 $A$ 很大时 $w(A) \to 1$，当 $A \to 0$ 时 $w(A) \to 0$。然后，将原始[奇异势](@entry_id:754921) $U_{\text{plane}}$ 与一个在共线极限下行为良好的非[奇异势](@entry_id:754921)（如标准的非正常[扭转势](@entry_id:756059) $U_{\text{imp}}$）平滑地混合：$U_{\text{switch}} = w(A)U_{\text{plane}} + (1-w(A))U_{\text{imp}}$。通过这种方式构造的 $U_{\text{switch}}$ 在整个[构型空间](@entry_id:149531)内都是一个单一、光滑且保守的势能函数。

这两种方法都通过构造一个在数学上始终良好定义的[势能函数](@entry_id:200753)来解决奇异性问题，从而保证了力的保守性和光滑性，这对于长期、稳定的[分子动力学模拟](@entry_id:160737)至关重要 [@problem_id:3431296]。