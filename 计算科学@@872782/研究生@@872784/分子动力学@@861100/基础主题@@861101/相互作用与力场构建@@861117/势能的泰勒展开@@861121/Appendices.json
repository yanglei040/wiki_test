{"hands_on_practices": [{"introduction": "在分子动力学中，理解原子间相互作用势的局部特性是分析振动和稳定性的基础。这项基础练习通过对经典的Lennard-Jones势进行泰勒展开，将抽象的数学系数与谐振子近似（二次项）和非谐效应（高次项）等核心物理概念直接联系起来 ([@problem_id:3451240])。掌握这一计算是理解键振动、热膨胀等宏观现象微观起源的第一步。", "problem": "在分子动力学（MD）中，通常通过在平衡分离点附近对其最小值进行泰勒级数展开，来分析围绕该点的微小振动。考虑 Lennard–Jones 对势 $u(r)=4\\epsilon\\left[(\\sigma/r)^{12}-(\\sigma/r)^6\\right]$，其最小值点在 $r_0=2^{1/6}\\sigma$。将 $u(r)$ 在 $r_0$ 附近关于 $\\Delta r = r - r_0$ 的幂的泰勒展开定义为\n$$\nu(r) \\approx \\sum_{n=0}^{4} a_n \\, (\\Delta r)^{n},\n$$\n其中 $a_n = u^{(n)}(r_0)/n!$ 且 $u^{(n)}$ 表示关于 $r$ 的 $n$ 阶导数。从泰勒级数的基本定义和给定的 Lennard–Jones 势出发，计算系数 $a_0$、$a_1$、$a_2$、$a_3$ 和 $a_4$ 的闭合形式，并使用 $\\epsilon$ 和 $r_0$ 简化表达式。\n\n然后，从第一性原理出发，在微小振动以及 MD 中的谐波与非谐波近似的背景下，解释二次项（与 $a_2$ 相关）和四次项（与 $a_4$ 相关）的物理意义。\n\n在最终答案中，将最终的数值-符号系数 $(a_0, a_1, a_2, a_3, a_4)$ 以单行矩阵的形式给出。最终答案不需要单位。", "solution": "问题要求计算 Lennard-Jones (LJ) 势 $u(r)$ 在其最小值点 $r_0$ 附近的泰勒级数展开的前五个系数，并对二次项和四次项进行物理解释。\n\nLJ 势由下式给出：\n$$\nu(r) = 4\\epsilon\\left[\\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^6\\right]\n$$\n该势的最小值出现在 $r_0 = 2^{1/6}\\sigma$。这个关系允许我们用平衡分离距离 $r_0$ 来表示参数 $\\sigma$：\n$$\n\\sigma^6 = \\frac{r_0^6}{2} \\quad \\text{and} \\quad \\sigma^{12} = \\frac{r_0^{12}}{4}\n$$\n将这些代入势能表达式，可以得到一个更方便对 $r$ 求导并在 $r_0$ 处求值的形式：\n$$\nu(r) = 4\\epsilon\\left[\\frac{r_0^{12}}{4r^{12}} - \\frac{r_0^6}{2r^6}\\right] = \\epsilon\\left[\\left(\\frac{r_0}{r}\\right)^{12} - 2\\left(\\frac{r_0}{r}\\right)^6\\right]\n$$\n泰勒展开系数 $a_n$ 定义为 $a_n = \\frac{u^{(n)}(r_0)}{n!}$，其中 $u^{(n)}(r_0)$ 是 $u(r)$ 的 $n$ 阶导数在 $r=r_0$ 处的值。我们现在来计算直到 $n=4$ 的这些导数。\n\n对于 $n=0$：系数 $a_0$ 是势在最小值点的值。\n$$\nu^{(0)}(r) = u(r) = \\epsilon\\left[r_0^{12}r^{-12} - 2r_0^6r^{-6}\\right]\n$$\n$$\nu(r_0) = \\epsilon\\left[r_0^{12}r_0^{-12} - 2r_0^6r_0^{-6}\\right] = \\epsilon(1-2) = -\\epsilon\n$$\n$$\na_0 = \\frac{u(r_0)}{0!} = -\\epsilon\n$$\n这代表了势阱的深度，或原子对的离解能。\n\n对于 $n=1$：系数 $a_1$ 由一阶导数确定。\n$$\nu^{(1)}(r) = \\frac{du}{dr} = \\epsilon\\left[r_0^{12}(-12r^{-13}) - 2r_0^6(-6r^{-7})\\right] = \\epsilon\\left[-12r_0^{12}r^{-13} + 12r_0^6r^{-7}\\right]\n$$\n$$\nu^{(1)}(r_0) = \\epsilon\\left[-12r_0^{12}r_0^{-13} + 12r_0^6r_0^{-7}\\right] = \\frac{12\\epsilon}{r_0}(-1+1) = 0\n$$\n$$\na_1 = \\frac{u^{(1)}(r_0)}{1!} = 0\n$$\n这个结果是预料之中的，因为任何函数在最小值点（或任何极值点）的一阶导数都为零。这表示在平衡分离距离处没有净力。\n\n对于 $n=2$：系数 $a_2$ 由二阶导数确定。\n$$\nu^{(2)}(r) = \\frac{d^2u}{dr^2} = \\epsilon\\left[-12r_0^{12}(-13r^{-14}) + 12r_0^6(-7r^{-8})\\right] = \\epsilon\\left[156r_0^{12}r^{-14} - 84r_0^6r^{-8}\\right]\n$$\n$$\nu^{(2)}(r_0) = \\epsilon\\left[156r_0^{12}r_0^{-14} - 84r_0^6r_0^{-8}\\right] = \\frac{\\epsilon}{r_0^2}(156 - 84) = \\frac{72\\epsilon}{r_0^2}\n$$\n$$\na_2 = \\frac{u^{(2)}(r_0)}{2!} = \\frac{1}{2}\\frac{72\\epsilon}{r_0^2} = \\frac{36\\epsilon}{r_0^2}\n$$\n\n对于 $n=3$：系数 $a_3$ 由三阶导数确定。\n$$\nu^{(3)}(r) = \\frac{d^3u}{dr^3} = \\epsilon\\left[156r_0^{12}(-14r^{-15}) - 84r_0^6(-8r^{-9})\\right] = \\epsilon\\left[-2184r_0^{12}r^{-15} + 672r_0^6r^{-9}\\right]\n$$\n$$\nu^{(3)}(r_0) = \\epsilon\\left[-2184r_0^{12}r_0^{-15} + 672r_0^6r_0^{-9}\\right] = \\frac{\\epsilon}{r_0^3}(-2184 + 672) = -\\frac{1512\\epsilon}{r_0^3}\n$$\n$$\na_3 = \\frac{u^{(3)}(r_0)}{3!} = \\frac{1}{6}\\left(-\\frac{1512\\epsilon}{r_0^3}\\right) = -\\frac{252\\epsilon}{r_0^3}\n$$\n\n对于 $n=4$：系数 $a_4$ 由四阶导数确定。\n$$\nu^{(4)}(r) = \\frac{d^4u}{dr^4} = \\epsilon\\left[-2184r_0^{12}(-15r^{-16}) + 672r_0^6(-9r^{-10})\\right] = \\epsilon\\left[32760r_0^{12}r^{-16} - 6048r_0^6r^{-10}\\right]\n$$\n$$\nu^{(4)}(r_0) = \\epsilon\\left[32760r_0^{12}r_0^{-16} - 6048r_0^6r_0^{-10}\\right] = \\frac{\\epsilon}{r_0^4}(32760 - 6048) = \\frac{26712\\epsilon}{r_0^4}\n$$\n$$\na_4 = \\frac{u^{(4)}(r_0)}{4!} = \\frac{1}{24}\\left(\\frac{26712\\epsilon}{r_0^4}\\right) = \\frac{1113\\epsilon}{r_0^4}\n$$\n\n因此，势能到四阶的泰勒展开为：\n$$\nu(r) \\approx -\\epsilon + \\frac{36\\epsilon}{r_0^2}(\\Delta r)^2 - \\frac{252\\epsilon}{r_0^3}(\\Delta r)^3 + \\frac{1113\\epsilon}{r_0^4}(\\Delta r)^4\n$$\n\n二次项（$a_2$）和四次项（$a_4$）的物理解释：\n\n在最小值点附近展开势能 $u(r)$ 对于理解分子振动至关重要。\n粒子受到的力由 $F(r) = -u'(r)$ 给出。对于微小位移 $\\Delta r = r - r_0$，在 $r_0$ 附近将这个力展开为泰勒级数，得到：\n$$\nF(r) = -u'(r_0) - u''(r_0)\\Delta r - \\frac{u'''(r_0)}{2}(\\Delta r)^2 - \\dots\n$$\n由于 $u'(r_0) = 0$，力中的主导项是：\n$$\nF(r) \\approx -u''(r_0)\\Delta r = -2a_2\\Delta r\n$$\n这是胡克定律 (Hooke's Law) 的数学形式，$F = -k_s x$，其中 $k_s = u''(r_0) = 2a_2 = 72\\epsilon/r_0^2$ 是有效键的力常数或“弹簧劲度”。与此力相关的势能是 $u(r) - u(r_0) \\approx a_2(\\Delta r)^2 = \\frac{1}{2}k_s(\\Delta r)^2$，这是简谐振子（SHO）的势能。因此，由 $a_2$ 控制的二次项代表了原子间势的**谐波近似**。这种近似将键模拟为理想弹簧，对于围绕平衡位置的无穷小振动是准确的。它描述了频率与振幅无关的振荡。\n\n三次项（$a_3$）和四次项（$a_4$）代表了对势的最低阶**非谐波修正**。真实的分子键不是理想弹簧，其行为会偏离简谐振子模型，尤其是在较大的振动振幅下。这种偏离被称为非谐性。\n三次项 $a_3(\\Delta r)^3$ 在势阱中引入了不对称性。由于 LJ 势的 $a_3$ 是负值，势能在压缩时（$\\Delta r  0$）比在拉伸时（$\\Delta r > 0$）上升得更陡。这种不对称性是热膨胀的微观起源，这是一个对称的谐波模型无法解释的现象。\n四次项 $a_4(\\Delta r)^4$ 是继谐波项之后的下一个偶次幂修正。它修改了远离最小值点的势阱曲率。由于 $a_4$ 是正值，它使得势阱在较大位移处比纯谐波抛物线所预示的更陡峭和“更窄”。该项与三次项一起影响振动频率，使其依赖于振动幅度。四次项是描述非无穷小位移下势的真实形状的关键组成部分，对于精确建模依赖于势形状细节的性质（如高温下的热容和声子相互作用）至关重要。总之，四次项为键的非谐性提供了主要的对称修正，为较大振幅的振动修正了弹簧常数。", "answer": "$$\n\\boxed{\\begin{pmatrix} -\\epsilon  0  \\frac{36\\epsilon}{r_0^2}  -\\frac{252\\epsilon}{r_0^3}  \\frac{1113\\epsilon}{r_0^4} \\end{pmatrix}}\n$$", "id": "3451240"}, {"introduction": "在静态分析的基础上，下一步是探究势能面的局部曲率如何影响系统的动力学行为。一个构型是稳定的极小值点还是不稳定的过渡态（鞍点），取决于其Hessian矩阵的性质。这项计算练习让您通过编程模拟，直观地观察到一个鞍点（其Hessian矩阵存在负特征值）附近位移的指数增长行为 ([@problem_id:3451224])。这揭示了泰勒展开在连接势能面拓扑结构与系统时间演化、预测化学反应路径方面的重要作用。", "problem": "考虑一个分子动力学 (MD) 系统，其由势能函数 $U(\\mathbf{R})$ 描述。该函数依赖于 $N$ 个笛卡尔坐标，这些坐标汇集在向量 $\\mathbf{R} \\in \\mathbb{R}^{N}$ 中。令 $\\mathbf{R}^{\\ddagger}$ 表示一个驻点构型，在该构型处势能的梯度为零，即 $\\nabla U(\\mathbf{R}^{\\ddagger}) = \\mathbf{0}$。并假设在 $\\mathbf{R}^{\\ddagger}$ 处求值的 $U$ 的二阶导数海森矩阵 $H$ 恰好有一个负特征值，其余特征值均为非负。在 $\\mathbf{R}^{\\ddagger}$ 附近，$U$ 的二阶泰勒展开给出一个形式为 $U(\\mathbf{R}^{\\ddagger} + \\mathbf{x}) \\approx U(\\mathbf{R}^{\\ddagger}) + \\dfrac{1}{2} \\mathbf{x}^{\\top} H \\mathbf{x}$ 的近似，其中 $\\mathbf{x} = \\mathbf{R} - \\mathbf{R}^{\\ddagger}$ 是位移向量。对于对角质量矩阵 $M = \\mathrm{diag}(m_{1}, \\dots, m_{N})$，牛顿第二定律表述为 $M \\ddot{\\mathbf{R}} = -\\nabla U(\\mathbf{R})$。在 $\\mathbf{R}^{\\ddagger}$ 周围的线性化区域内，对于足够小的 $\\mathbf{x}$，该定律简化为 $M \\ddot{\\mathbf{x}} = - H \\mathbf{x}$。这个线性系统可以重写为一个关于增广状态 $\\mathbf{y} = \\begin{pmatrix}\\mathbf{x} \\\\ \\mathbf{v}\\end{pmatrix} \\in \\mathbb{R}^{2N}$ 的一阶系统 $\\dot{\\mathbf{y}} = A \\mathbf{y}$，其中 $\\mathbf{v} = \\dot{\\mathbf{x}}$，分块矩阵 $A = \\begin{pmatrix} 0  I \\\\ -M^{-1} H  0 \\end{pmatrix}$。$\\mathbf{x}(t)$ 的短时增长或衰减由 $H$ 的特征结构和质量 $m_{i}$ 决定，其中不定曲率会产生一个不稳定模式。\n\n你的任务是实现一个程序，对于每个给定的测试用例，计算放大因子 $a = \\dfrac{\\lVert \\mathbf{x}(T) \\rVert_{2}}{\\lVert \\mathbf{x}(0) \\rVert_{2}}$。其中，$\\lVert \\cdot \\rVert_{2}$ 表示欧几里得范数，$T$ 是一个指定的短时间，$\\mathbf{x}(t)$ 在初始条件 $\\mathbf{x}(0) = \\mathbf{x}_{0}$ 和 $\\mathbf{v}(0) = \\mathbf{0}$ 下，根据线性化动力学方程 $M \\ddot{\\mathbf{x}} = - H \\mathbf{x}$ 演化。矩阵 $H$ 是对称的，单位为牛顿/米 ($\\mathrm{N}/\\mathrm{m}$)；质量 $m_{i}$ 的单位为千克 ($\\mathrm{kg}$)；位移 $\\mathbf{x}_{0}$ 的单位为米 ($\\mathrm{m}$)；速度的单位为米/秒 ($\\mathrm{m}/\\mathrm{s}$)；时间 $T$ 的单位为秒 ($\\mathrm{s}$)。放大因子 $a$ 是无量纲的。\n\n使用以下测试套件，每个套件由 $N$、$M$、$H$、$\\mathbf{x}_{0}$、$\\mathbf{v}_{0}$ 和 $T$ 指定。在所有情况下，$N = 2$，$\\mathbf{v}_{0} = \\mathbf{0}$，且 $T = 1.0 \\times 10^{-13}\\ \\mathrm{s}$。\n\n- 测试用例 1 (不定曲率，对角海森矩阵，初始位移与不稳定模式对齐):\n  - 质量: $m_{1} = 2.0 \\times 10^{-26}\\ \\mathrm{kg}$, $m_{2} = 2.0 \\times 10^{-26}\\ \\mathrm{kg}$。\n  - 海森矩阵: $H = \\begin{pmatrix} -0.5  0.0 \\\\ 0.0  0.8 \\end{pmatrix}\\ \\mathrm{N}/\\mathrm{m}$。\n  - 初始位移: $\\mathbf{x}_{0} = \\begin{pmatrix} 1.0 \\times 10^{-12} \\\\ 0.0 \\end{pmatrix}\\ \\mathrm{m}$。\n\n- 测试用例 2 (正定曲率，对角海森矩阵，初始位移与稳定模式对齐):\n  - 质量: $m_{1} = 2.0 \\times 10^{-26}\\ \\mathrm{kg}$, $m_{2} = 2.0 \\times 10^{-26}\\ \\mathrm{kg}$。\n  - 海森矩阵: $H = \\begin{pmatrix} 0.7  0.0 \\\\ 0.0  1.1 \\end{pmatrix}\\ \\mathrm{N}/\\mathrm{m}$。\n  - 初始位移: $\\mathbf{x}_{0} = \\begin{pmatrix} 1.0 \\times 10^{-12} \\\\ 0.0 \\end{pmatrix}\\ \\mathrm{m}$。\n\n- 测试用例 3 (半正定曲率，含平坦方向):\n  - 质量: $m_{1} = 2.0 \\times 10^{-26}\\ \\mathrm{kg}$, $m_{2} = 2.0 \\times 10^{-26}\\ \\mathrm{kg}$。\n  - 海森矩阵: $H = \\begin{pmatrix} 0.0  0.0 \\\\ 0.0  0.6 \\end{pmatrix}\\ \\mathrm{N}/\\mathrm{m}$。\n  - 初始位移: $\\mathbf{x}_{0} = \\begin{pmatrix} 1.0 \\times 10^{-12} \\\\ 0.0 \\end{pmatrix}\\ \\mathrm{m}$。\n\n- 测试用例 4 (不定曲率，含模式耦合):\n  - 质量: $m_{1} = 2.0 \\times 10^{-26}\\ \\mathrm{kg}$, $m_{2} = 2.0 \\times 10^{-26}\\ \\mathrm{kg}$。\n  - 海森矩阵: $H = \\begin{pmatrix} -0.2  0.15 \\\\ 0.15  0.3 \\end{pmatrix}\\ \\mathrm{N}/\\mathrm{m}$。\n  - 初始位移: $\\mathbf{x}_{0} = \\begin{pmatrix} 1.0 \\times 10^{-12} \\\\ 1.0 \\times 10^{-12} \\end{pmatrix}\\ \\mathrm{m}$。\n\n算法要求:\n- 将线性化动力学表述为一阶系统 $\\dot{\\mathbf{y}} = A \\mathbf{y}$，其中 $A = \\begin{pmatrix} 0  I \\\\ -M^{-1} H  0 \\end{pmatrix}$，$I$ 是 $N \\times N$ 单位矩阵，$M^{-1}$ 是对角质量矩阵的逆矩阵。\n- 使用矩阵指数解 $\\mathbf{y}(T)$ 将初始状态 $\\mathbf{y}(0) = \\begin{pmatrix}\\mathbf{x}_{0} \\\\ \\mathbf{0}\\end{pmatrix}$ 演化至时间 $T$，并从 $\\mathbf{y}(T)$ 的前 $N$ 个分量中提取 $\\mathbf{x}(T)$。\n- 为每个测试用例计算放大因子 $a = \\dfrac{\\lVert \\mathbf{x}(T) \\rVert_{2}}{\\lVert \\mathbf{x}(0) \\rVert_{2}}$。\n\n你的程序应产生单行输出，其中包含 4 个测试用例的放大因子，形式为由方括号括起来的逗号分隔列表，例如 $[\\text{result}_{1},\\text{result}_{2},\\text{result}_{3},\\text{result}_{4}]$，其中每个 $\\text{result}_{i}$ 是一个浮点数。放大因子是无量纲量，必须完全按照上述规定计算。除此单行外，不允许任何额外输出。", "solution": "问题陈述是有效的。它在科学上基于应用于分子动力学的经典力学和线性稳定性分析原理。它是适定的，为每个测试用例提供了所有必需的矩阵、向量和标量参数，并指定了一个清晰、无歧义的计算任务。所提供的物理值对于分子系统是符合实际的，且单位是一致的。该问题是客观的，需要一个形式化的、算法化的解决方案。\n\n问题的核心在于求解分子系统在其势能面上一个驻点附近的线性化运动方程。提供的方程是针对偏离驻点构型 $\\mathbf{R}^{\\ddagger}$ 的小位移 $\\mathbf{x}$ 的矩阵形式的牛顿第二定律：\n$$\nM \\ddot{\\mathbf{x}} = -H \\mathbf{x}\n$$\n其中 $M$ 是对角质量矩阵，$\\ddot{\\mathbf{x}}$ 是加速度向量，$H$ 是势能函数 $U(\\mathbf{R})$ 在 $\\mathbf{R}^{\\ddagger}$ 处求值的海森矩阵。\n\n为了求解这个二阶线性系统，我们将其重构为一个一阶系统。我们定义一个状态向量 $\\mathbf{y} \\in \\mathbb{R}^{2N}$，它拼接了位置位移 $\\mathbf{x} \\in \\mathbb{R}^N$ 和速度 $\\mathbf{v} = \\dot{\\mathbf{x}} \\in \\mathbb{R}^N$：\n$$\n\\mathbf{y}(t) = \\begin{pmatrix} \\mathbf{x}(t) \\\\ \\mathbf{v}(t) \\end{pmatrix}\n$$\n该状态向量的时间导数 $\\dot{\\mathbf{y}}(t)$ 则为：\n$$\n\\dot{\\mathbf{y}}(t) = \\begin{pmatrix} \\dot{\\mathbf{x}}(t) \\\\ \\dot{\\mathbf{v}}(t) \\end{pmatrix} = \\begin{pmatrix} \\mathbf{v}(t) \\\\ \\ddot{\\mathbf{x}}(t) \\end{pmatrix}\n$$\n根据运动方程，我们可以将加速度表示为 $\\ddot{\\mathbf{x}} = -M^{-1}H\\mathbf{x}$。将此式和 $\\mathbf{v} = \\dot{\\mathbf{x}}$ 代入 $\\dot{\\mathbf{y}}$ 的表达式中，得到：\n$$\n\\dot{\\mathbf{y}}(t) = \\begin{pmatrix} \\mathbf{v}(t) \\\\ -M^{-1}H\\mathbf{x}(t) \\end{pmatrix} = \\begin{pmatrix} 0  I \\\\ -M^{-1}H  0 \\end{pmatrix} \\begin{pmatrix} \\mathbf{x}(t) \\\\ \\mathbf{v}(t) \\end{pmatrix}\n$$\n其中 $I$ 是 $N \\times N$ 单位矩阵，$0$ 是 $N \\times N$ 零矩阵。这是一个形式为 $\\dot{\\mathbf{y}} = A \\mathbf{y}$ 的线性齐次一阶常微分方程组，其动力学矩阵 $A$ 由下式给出：\n$$\nA = \\begin{pmatrix} 0  I \\\\ -M^{-1}H  0 \\end{pmatrix}\n$$\n对于初始条件 $\\mathbf{y}(0) = \\mathbf{y}_0$，该系统的解由矩阵指数给出：\n$$\n\\mathbf{y}(t) = e^{At} \\mathbf{y}_0\n$$\n对于本问题，初始条件被指定为初始位移 $\\mathbf{x}(0) = \\mathbf{x}_0$ 和零初始速度 $\\mathbf{v}(0) = \\mathbf{0}$。因此，初始状态向量为：\n$$\n\\mathbf{y}(0) = \\begin{pmatrix} \\mathbf{x}_0 \\\\ \\mathbf{0} \\end{pmatrix}\n$$\n我们需要找到在特定时间 $T$ 的状态。解是：\n$$\n\\mathbf{y}(T) = e^{AT} \\mathbf{y}(0) = \\begin{pmatrix} \\mathbf{x}(T) \\\\ \\mathbf{v}(T) \\end{pmatrix}\n$$\n时间 $T$ 时的位移向量 $\\mathbf{x}(T)$ 由所得向量 $\\mathbf{y}(T)$ 的前 $N$ 个分量组成。\n\n最后一步是计算放大因子 $a$，其定义为时间 $T$ 时的位移向量的欧几里得范数与时间 $t=0$ 时的范数之比：\n$$\na = \\frac{\\lVert \\mathbf{x}(T) \\rVert_2}{\\lVert \\mathbf{x}(0) \\rVert_2}\n$$\n其中，对于任意向量 $\\mathbf{z} \\in \\mathbb{R}^N$，$\\lVert \\mathbf{z} \\rVert_2 = \\sqrt{\\sum_{i=1}^{N} z_i^2}$。\n\n每个测试用例的算法如下：\n$1$. 根据给定值构造对角质量矩阵 $M$ 和海森矩阵 $H$。对于所有测试用例，$N=2$。\n$2$. 计算质量矩阵的逆 $M^{-1}$，这是一个对角矩阵，其元素是质量 $m_i$ 的倒数。\n$3$. 构造 $4 \\times 4$ 的动力学矩阵 $A = \\begin{pmatrix} 0  I \\\\ -M^{-1}H  0 \\end{pmatrix}$。\n$4$. 通过拼接给定的 $\\mathbf{x}_0$ 和零向量 $\\mathbf{v}_0 = \\mathbf{0}$ 来构造 $4 \\times 1$ 的初始状态向量 $\\mathbf{y}(0)$。\n$5$. 计算 $A \\times T$ 的矩阵指数，其中 $T = 1.0 \\times 10^{-13}\\ \\mathrm{s}$。在数值上，这可以通过使用一个鲁棒的算法来完成，例如 `scipy.linalg.expm` 提供的算法。\n$6$. 通过矩阵-向量乘积 $\\mathbf{y}(T) = (e^{AT}) \\mathbf{y}(0)$ 计算时间 $T$ 时的状态向量。\n$7$. 从 $\\mathbf{y}(T)$ 的前 $N=2$ 个分量中提取位移向量 $\\mathbf{x}(T)$。\n$8$. 使用 `numpy.linalg.norm` 计算 $\\mathbf{x}(T)$ 和 $\\mathbf{x}(0)$ 的欧几里得范数。\n$9$. 计算它们的比率作为放大因子 $a$。\n\n对所提供的四个测试用例中的每一个都将重复此过程，从而产生四个不同的放大因子。每种情况下海森矩阵的性质（不定的、正定的、半正定的）决定了动力学的稳定性。不定的海森矩阵意味着至少有一个负特征值，对应于一个不稳定方向（鞍点），在该方向上小位移可以指数级增长，导致 $a > 1$。正定的海森矩阵对应于一个稳定的最小值点，位移会导致振荡，通常导致 $a \\le 1$。具有零特征值的半正定海森矩阵对应于一个平坦方向，在该方向上没有初始速度的粒子不会加速，导致 $a = 1$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import expm\n\ndef solve():\n    \"\"\"\n    Computes the amplification factor for linearized dynamics near a stationary point\n    for several test cases in molecular dynamics.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test case 1\n        {\n            \"N\": 2,\n            \"M_diag\": [2.0e-26, 2.0e-26],\n            \"H\": np.array([[-0.5, 0.0], [0.0, 0.8]]),\n            \"x0\": np.array([1.0e-12, 0.0]),\n            \"v0\": np.array([0.0, 0.0]),\n            \"T\": 1.0e-13\n        },\n        # Test case 2\n        {\n            \"N\": 2,\n            \"M_diag\": [2.0e-26, 2.0e-26],\n            \"H\": np.array([[0.7, 0.0], [0.0, 1.1]]),\n            \"x0\": np.array([1.0e-12, 0.0]),\n            \"v0\": np.array([0.0, 0.0]),\n            \"T\": 1.0e-13\n        },\n        # Test case 3\n        {\n            \"N\": 2,\n            \"M_diag\": [2.0e-26, 2.0e-26],\n            \"H\": np.array([[0.0, 0.0], [0.0, 0.6]]),\n            \"x0\": np.array([1.0e-12, 0.0]),\n            \"v0\": np.array([0.0, 0.0]),\n            \"T\": 1.0e-13\n        },\n        # Test case 4\n        {\n            \"N\": 2,\n            \"M_diag\": [2.0e-26, 2.0e-26],\n            \"H\": np.array([[-0.2, 0.15], [0.15, 0.3]]),\n            \"x0\": np.array([1.0e-12, 1.0e-12]),\n            \"v0\": np.array([0.0, 0.0]),\n            \"T\": 1.0e-13\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        N = case[\"N\"]\n        M_diag = case[\"M_diag\"]\n        H = case[\"H\"]\n        x0 = case[\"x0\"]\n        v0 = case[\"v0\"]\n        T = case[\"T\"]\n\n        # 1. Construct matrices\n        M_inv = np.diag([1.0/m for m in M_diag])\n        I = np.identity(N)\n        Z = np.zeros((N, N))\n\n        # 2. Construct the dynamics matrix A\n        A = np.block([\n            [Z, I],\n            [-M_inv @ H, Z]\n        ])\n\n        # 3. Construct the initial state vector y0\n        y0 = np.concatenate([x0, v0])\n\n        # 4. Propagate using the matrix exponential\n        # y(T) = exp(A*T) @ y(0)\n        exp_AT = expm(A * T)\n        yT = exp_AT @ y0\n\n        # 5. Extract x(T)\n        xT = yT[:N]\n\n        # 6. Compute norms\n        norm_x0 = np.linalg.norm(x0)\n        norm_xT = np.linalg.norm(xT)\n        \n        # 7. Compute amplification factor a\n        # Avoid division by zero if x0 is the zero vector, although not the case here.\n        if norm_x0  0:\n            amplification_factor = norm_xT / norm_x0\n        else:\n            amplification_factor = 1.0 # Or undefined, but 1 seems reasonable.\n\n        results.append(amplification_factor)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.15f}' for r in results)}]\")\n\nsolve()\n```", "id": "3451224"}, {"introduction": "泰勒展开不仅用于物理分析，还在分子动力学模拟方法的设计中扮演着关键角色，尤其是在处理势函数截断问题时。为了在有限距离内“关闭”相互作用而又不引入数值噪音，我们需要使用平滑的切换函数。这项高级练习要求您构建并比较不同平滑度等级（$C^0$、$C^1$ 和 $C^2$）的切换函数，并量化它们对力的影响 ([@problem_id:3451255])。您将发现，最高级的$C^2$平滑性等价于在切换点匹配原始势函数的泰勒展开，这直接关系到模拟的能量守恒性和准确性。", "problem": "给定一个以约化单位（无量纲）表示的粒子对势能函数，您需要构建切换函数，该函数在截断距离处将势能平滑地降至零，同时在切换区间的起点保留基础势能的泰勒展开系数。然后，您将量化不同平滑度类别的锥削函数所引入的力噪声。\n\n定义与假设：\n- 基础势能是采用约化单位的 Lennard-Jones 形式，其中 $ \\epsilon = 1 $ 且 $ \\sigma = 1 $：\n$$\nU_0(r) = 4 \\left[ r^{-12} - r^{-6} \\right].\n$$\n- 对应的未切换力由 $ F_0(r) = -\\frac{dU_0}{dr} $ 给出，即：\n$$\nF_0(r) = 24 \\left[ 2 r^{-13} - r^{-7} \\right].\n$$\n- 切换后的势能 $ U(r) $ 定义为一个乘法切换：\n$$\nU(r) =\n\\begin{cases}\nU_0(r),  r \\le r_s, \\\\\nS\\!\\left(\\dfrac{r-r_s}{r_c - r_s}\\right)\\, U_0(r),  r_s  r  r_c, \\\\\n0,  r \\ge r_c,\n\\end{cases}\n$$\n其中 $ r_s $ 是切换起始半径，$ r_c $ 是截断半径，满足 $ r_c > r_s $，并且 $ S(x) $ 是一个在 $ x \\in [0,1] $ 上的多项式。定义切换宽度 $ w = r_c - r_s $ 和归一化坐标 $ x = (r - r_s)/w $。\n\n- 切换后的力为\n$$\nF(r) = -\\frac{d}{dr} \\big( S(x)\\, U_0(r) \\big) = -\\left[ S(x)\\, \\frac{dU_0}{dr}(r) + \\frac{1}{w}\\, \\frac{dS}{dx}(x)\\, U_0(r) \\right],\n$$\n对于 $ r \\in (r_s, r_c) $，当 $ r \\le r_s $ 时等于 $ F_0(r) $，当 $ r \\ge r_c $ 时等于 $ 0 $。\n\n- 定义切换区域内的力误差为\n$$\n\\Delta F(r) = F(r) - F_0(r).\n$$\n- 定义切换区间上的均方根（RMS）力噪声为以下连续平均值：\n$$\n\\mathrm{RMS} = \\sqrt{ \\frac{1}{r_c - r_s} \\int_{r_s}^{r_c} \\left[ \\Delta F(r) \\right]^2 \\, dr }.\n$$\n\n任务：\n1) 在 $ x \\in [0,1] $ 上构建三个平滑度类别递增的切换函数 $ S(x) $：\n   - $C^0$ 线性锥削函数，仅强制 $ S(0) = 1 $ 和 $ S(1) = 0 $，在端点处没有导数约束。这将得到一个1次多项式。\n   - $C^1$ Hermite 三次锥削函数，强制 $ S(0) = 1 $, $ \\frac{dS}{dx}(0) = 0 $, $ S(1) = 0 $, $ \\frac{dS}{dx}(1) = 0 $。这将得到一个3次多项式。\n   - $C^2$ 优化的五次锥削函数，在截断距离 $ r_c $ 处强制条件 $ U(r_c) = 0 $, $ U'(r_c) = 0 $, $ U''(r_c) = 0 $，并在 $ r_s $ 处保留 $ U_0(r) $ 的泰勒展开至二阶。证明这可以通过使 $ S(x) $ 满足以下条件来实现：\n$$\nS(0) = 1,\\quad \\frac{dS}{dx}(0) = 0,\\quad \\frac{d^2S}{dx^2}(0) = 0;\\qquad\nS(1) = 0,\\quad \\frac{dS}{dx}(1) = 0,\\quad \\frac{d^2S}{dx^2}(1) = 0,\n$$\n这决定了一个5次多项式。\n\n2) 对每个切换函数，通过在 $ r \\in [r_s, r_c] $ 上使用至少 $ N = 20001 $ 个点的均匀网格，数值计算积分，从而计算上述定义的 RMS 力噪声。所有量在约化单位下都是无量纲的。\n\n3) 使用以下参数对 $ (r_s, r_c) $ 的测试套件：\n   - 情况 A（理想情况）：$ r_s = 1.8 $，$ r_c = 2.5 $。\n   - 情况 B（窄切换）：$ r_s = 2.45 $，$ r_c = 2.5 $。\n   - 情况 C（早切换）：$ r_s = 1.3 $，$ r_c = 1.6 $。\n\n您的程序必须：\n- 通过求解上述六个端点条件所构成的线性方程组来推导 $C^2$ 优化的五次多项式系数（不要硬编码系数）。\n- 实现 $C^0$、$C^1$ 和推导出的 $C^2$ 锥削函数。\n- 对于测试套件中的每种情况，计算并返回一个包含三个 RMS 值的列表 $ [\\mathrm{RMS}_{C^0}, \\mathrm{RMS}_{C^1}, \\mathrm{RMS}_{C^2}] $。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含三个测试用例的结果，格式为逗号分隔的列表的列表，用方括号括起来，顺序为 A、B、C。例如：\n\"[ [rA_C0,rA_C1,rA_C2],[rB_C0,rB_C1,rB_C2],[rC_C0,rC_C1,rC_C2] ]\"\n所有数字都是无量纲的，应以标准浮点文字形式打印。", "solution": "用户提供的问题已经过分析，并被认为是有效的。它在分子动力学原理上具有科学依据，问题设定良好、客观，并包含获得唯一解所需的所有信息。\n\n### 1. 问题阐述\n\n该问题要求构建和分析三个多项式切换函数 $S(x)$，用于在一个有限区间 $[r_s, r_c]$ 上将 Lennard-Jones (LJ) 势能 $U_0(r)$ 平滑地截断至零。基础 LJ 势能及其对应的力在约化单位下给出：\n$$\nU_0(r) = 4 \\left( r^{-12} - r^{-6} \\right)\n$$\n$$\nF_0(r) = -\\frac{dU_0}{dr} = 24 \\left( 2r^{-13} - r^{-7} \\right)\n$$\n切换后的势能 $U(r)$ 使用归一化坐标 $x = \\frac{r-r_s}{r_c - r_s}$ 定义，适用于 $r \\in [r_s, r_c]$，其中 $w = r_c - r_s$ 是切换宽度：\n$$\nU(r) = S(x) U_0(r) \\quad \\text{for } r \\in (r_s, r_c)\n$$\n对应的切换后的力是 $F(r) = -U'(r)$。使用链式法则，可得：\n$$\nF(r) = -\\frac{d}{dr}\\left[S(x) U_0(r)\\right] = - \\left( \\frac{dS}{dx}\\frac{dx}{dr} U_0(r) + S(x) \\frac{dU_0}{dr} \\right)\n$$\n由于 $\\frac{dx}{dr} = \\frac{1}{w}$ 且 $-\\frac{dU_0}{dr} = F_0(r)$，该力为：\n$$\nF(r) = S(x) F_0(r) - \\frac{1}{w} \\frac{dS}{dx}(x) U_0(r)\n$$\n因此，在切换区域 $(r_s, r_c)$ 内的力误差 $\\Delta F(r) = F(r) - F_0(r)$ 为：\n$$\n\\Delta F(r) = \\left( S(x) - 1 \\right) F_0(r) - \\frac{1}{w} \\frac{dS}{dx}(x) U_0(r)\n$$\n切换函数的质量通过切换区间上的均方根（RMS）力噪声来量化：\n$$\n\\mathrm{RMS} = \\sqrt{ \\frac{1}{r_c - r_s} \\int_{r_s}^{r_c} \\left[ \\Delta F(r) \\right]^2 \\, dr }\n$$\n\n### 2. 切换函数 $S(x)$ 的构建\n\n我们在 $x \\in [0,1]$ 上构建三个平滑度递增的多项式切换函数。\n\n#### 2.1. $C^0$ 线性锥削函数\n该函数是一个1次多项式，$S_{C^0}(x) = c_1 x + c_0$。它必须满足边界条件以使势能连续（$C^0$）。\n1.  在 $r=r_s$ ($x=0$) 处：$U(r_s) = U_0(r_s) \\implies S(0)U_0(r_s) = U_0(r_s) \\implies S(0) = 1$。\n2.  在 $r=r_c$ ($x=1$) 处：$U(r_c) = 0 \\implies S(1)U_0(r_c) = 0 \\implies S(1) = 0$。\n\n条件 $S(0) = 1$ 和 $S(1) = 0$ 给出：\n$c_0 = 1$\n$c_1 + c_0 = 0 \\implies c_1 = -1$\n因此，线性锥削函数为 $S_{C^0}(x) = 1 - x$，其导数为 $\\frac{dS_{C^0}}{dx} = -1$。\n\n#### 2.2. $C^1$ Hermite 三次锥削函数\n该函数是一个3次多项式，$S_{C^1}(x) = c_3 x^3 + c_2 x^2 + c_1 x + c_0$。它强制势能及其一阶导数（力）连续，使得总势能 $U(r)$ 成为一个 $C^1$ 函数。这需要四个条件：\n1.  $S(0) = 1$（在 $r_s$ 处势能连续）\n2.  $S(1) = 0$（在 $r_c$ 处势能为零）\n3.  $\\frac{dS}{dx}(0) = 0$（在 $r_s$ 处力连续）\n4.  $\\frac{dS}{dx}(1) = 0$（在 $r_c$ 处力为零）\n\n将这些条件应用于 $S(x)$ 及其导数 $S'(x) = 3c_3 x^2 + 2c_2 x + c_1$：\n1.  $S(0) = 1 \\implies c_0 = 1$。\n2.  $S'(0) = 0 \\implies c_1 = 0$。\n3.  $S(1) = 0 \\implies c_3 + c_2 + c_1 + c_0 = 0 \\implies c_3 + c_2 = -1$。\n4.  $S'(1) = 0 \\implies 3c_3 + 2c_2 + c_1 = 0 \\implies 3c_3 + 2c_2 = 0$。\n\n求解方程组 $c_3 + c_2 = -1$ 和 $3c_3 + 2c_2 = 0$ 可得 $c_3 = 2$ 和 $c_2 = -3$。\n因此，三次锥削函数为 $S_{C^1}(x) = 2x^3 - 3x^2 + 1$，其导数为 $\\frac{dS_{C^1}}{dx} = 6x^2 - 6x$。\n\n#### 2.3. $C^2$ 优化的五次锥削函数\n该函数是一个5次多项式，$S_{C^2}(x) = \\sum_{i=0}^{5} c_i x^i$。它确保势能及其前两阶导数连续，使得 $U(r)$ 是一个 $C^2$ 函数。\n\n首先，我们证明对 $U(r)$ 的要求如何转化为对 $S(x)$ 的指定条件。\n$U(r) = S(x(r))U_0(r)$ 的导数为：\n$U'(r) = \\frac{1}{w}S'(x)U_0(r) + S(x)U_0'(r)$\n$U''(r) = \\frac{1}{w^2}S''(x)U_0(r) + \\frac{2}{w}S'(x)U_0'(r) + S(x)U_0''(r)$\n\n在 $r=r_s$ ($x=0$) 处，我们要求 $U(r)$ 与 $U_0(r)$ 的泰勒展开式匹配至二阶。这意味着 $U(r_s)=U_0(r_s)$, $U'(r_s)=U_0'(r_s)$ 和 $U''(r_s)=U_0''(r_s)$。\n- $U(r_s)=U_0(r_s) \\implies S(0)U_0(r_s)=U_0(r_s) \\implies S(0)=1$。\n- $U'(r_s)=U_0'(r_s) \\implies \\frac{1}{w}S'(0)U_0(r_s) + S(0)U_0'(r_s) = U_0'(r_s)$。在 $S(0)=1$ 的情况下，这简化为 $\\frac{1}{w}S'(0)U_0(r_s)=0$，意味着 $S'(0)=0$。\n- $U''(r_s)=U_0''(r_s) \\implies \\frac{1}{w^2}S''(0)U_0(r_s) + \\frac{2}{w}S'(0)U_0'(r_s) + S(0)U_0''(r_s) = U_0''(r_s)$。在 $S(0)=1$ 和 $S'(0)=0$ 的情况下，这简化为 $\\frac{1}{w^2}S''(0)U_0(r_s)=0$，意味着 $S''(0)=0$。\n\n在 $r=r_c$ ($x=1$) 处，我们要求势能及其前两阶导数为零：$U(r_c)=U'(r_c)=U''(r_c)=0$。\n- $U(r_c)=0 \\implies S(1)U_0(r_c)=0 \\implies S(1)=0$。\n- $U'(r_c)=0 \\implies \\frac{1}{w}S'(1)U_0(r_c) + S(1)U_0'(r_c)=0$。在 $S(1)=0$ 的情况下，这简化为 $\\frac{1}{w}S'(1)U_0(r_c)=0$，意味着 $S'(1)=0$。\n- $U''(r_c)=0 \\implies \\frac{1}{w^2}S''(1)U_0(r_c) + \\frac{2}{w}S'(1)U_0'(r_c) + S(1)U_0''(r_c)=0$。在 $S(1)=0$ 和 $S'(1)=0$ 的情况下，这简化为 $\\frac{1}{w^2}S''(1)U_0(r_c)=0$，意味着 $S''(1)=0$。\n\n这确认了六个条件：$S(0)=1$, $S'(0)=0$, $S''(0)=0$, $S(1)=0$, $S'(1)=0$, $S''(1)=0$。\n将这些应用于 $S(x) = \\sum_{i=0}^{5} c_i x^i$：\n- $x=0$ 处的条件立即给出 $c_0=1, c_1=0, c_2=0$。\n- $x=1$ 处对 $S(x) = c_5 x^5 + c_4 x^4 + c_3 x^3 + 1$ 的条件给出了一个关于 $(c_3, c_4, c_5)$ 的 $3 \\times 3$ 线性方程组：\n$$\n\\begin{pmatrix} 1  1  1 \\\\ 3  4  5 \\\\ 6  12  20 \\end{pmatrix} \\begin{pmatrix} c_3 \\\\ c_4 \\\\ c_5 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n该系统在实现中通过数值方法求解。解为 $c_3=-10, c_4=15, c_5=-6$。\n因此，五次锥削函数为 $S_{C^2}(x) = -6x^5 + 15x^4 - 10x^3 + 1$。\n\n### 3. RMS 力噪声的数值计算\n\n对于每个测试用例 $(r_s, r_c)$ 和三种切换函数中的每一种，都会计算 RMS 力噪声。步骤如下：\n1.  在区间 $[r_s, r_c]$ 上创建一个包含 $N=20001$ 个点的均匀网格 $\\{r_i\\}$。\n2.  计算对应的归一化坐标网格 $\\{x_i\\}$。\n3.  在每个网格点上计算基础势能 $U_0(r_i)$ 和力 $F_0(r_i)$。\n4.  对于每种平滑函数（$C^0, C^1, C^2$），计算多项式 $S(x_i)$ 及其导数 $\\frac{dS}{dx}(x_i)$。\n5.  使用第 1 节中推导的公式计算力误差数组 $\\Delta F(r_i)$。\n6.  使用梯形法则在网格数据上对定积分 $\\int_{r_s}^{r_c} [\\Delta F(r)]^2 dr$ 进行数值近似。\n7.  根据积分和切换宽度 $w=r_c-r_s$ 计算最终的 RMS 值。\n\n对每个参数集重复此过程，并将结果汇总以用于最终输出。预期结果是，随着切换函数平滑度的增加（$C^0 > C^1 > C^2$），RMS 噪声将减小，这反映了由势能截断引入的伪影的逐步减少。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom numpy.polynomial import Polynomial\n\ndef solve():\n    \"\"\"\n    Solves the molecular dynamics switching function problem.\n    1. Derives the C^2 quintic polynomial switching function.\n    2. Implements C^0, C^1, and C^2 switching functions.\n    3. Computes the RMS force noise for three test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        (1.8, 2.5),  # Case A: Happy path\n        (2.45, 2.5), # Case B: Narrow switch\n        (1.3, 1.6),  # Case C: Early switch\n    ]\n    \n    N_points = 20001\n    \n    # -------------------------------------------------------------\n    # Task 1: Construct Switching Functions S(x)\n    # -------------------------------------------------------------\n    \n    # C^0 Linear Taper: S(x) = 1 - x\n    S0_poly = Polynomial([1.0, -1.0])\n    dS0_poly = S0_poly.deriv()\n\n    # C^1 Hermite Cubic Taper: S(x) = 2x^3 - 3x^2 + 1\n    S1_poly = Polynomial([1.0, 0.0, -3.0, 2.0])\n    dS1_poly = S1_poly.deriv()\n\n    # C^2 Optimized Quintic Taper\n    # The problem requires deriving the coefficients by solving the linear system.\n    # S(x) = c5*x^5 + c4*x^4 + c3*x^3 + c2*x^2 + c1*x + c0\n    # Conditions at x=0 (S(0)=1, S'(0)=0, S''(0)=0) yield c0=1, c1=0, c2=0.\n    # Conditions at x=1 (S(1)=0, S'(1)=0, S''(1)=0) on S(x) = c5*x^5+c4*x^4+c3*x^3+1\n    # yield a 3x3 system for (c3, c4, c5):\n    # S(1)=0  = c3 + c4 + c5 = -1\n    # S'(1)=0 = 3*c3 + 4*c4 + 5*c5 = 0\n    # S''(1)=0= 6*c3 + 12*c4 + 20*c5 = 0\n    A = np.array([\n        [1.0, 1.0, 1.0],\n        [3.0, 4.0, 5.0],\n        [6.0, 12.0, 20.0]\n    ])\n    b = np.array([-1.0, 0.0, 0.0])\n    c3, c4, c5 = np.linalg.solve(A, b)\n    c2_coeffs = np.array([1.0, 0.0, 0.0, c3, c4, c5])\n    S2_poly = Polynomial(c2_coeffs)\n    dS2_poly = S2_poly.deriv()\n\n    smoothers = [\n        (S0_poly, dS0_poly),\n        (S1_poly, dS1_poly),\n        (S2_poly, dS2_poly)\n    ]\n\n    # -------------------------------------------------------------\n    # Base Potential and Force Definitions\n    # -------------------------------------------------------------\n    \n    def U0(r):\n        \"\"\"Lennard-Jones potential.\"\"\"\n        r_inv = 1.0 / r\n        r_inv6 = r_inv**6\n        return 4.0 * (r_inv6**2 - r_inv6)\n\n    def F0(r):\n        \"\"\"Lennard-Jones force.\"\"\"\n        r_inv = 1.0 / r\n        r_inv7 = r_inv**7\n        return 24.0 * (2.0 * r_inv7 * r_inv**6 - r_inv7)\n\n    all_results = []\n    for rs, rc in test_cases:\n        # -------------------------------------------------------------\n        # Task 2: Compute RMS force noise\n        # -------------------------------------------------------------\n        \n        # Setup grid and pre-compute base values\n        w = rc - rs\n        r_grid = np.linspace(rs, rc, N_points)\n        x_grid = (r_grid - rs) / w\n\n        u0_vals = U0(r_grid)\n        f0_vals = F0(r_grid)\n\n        case_results = []\n        for S_poly, dS_poly in smoothers:\n            # Evaluate switching function and its derivative on the grid\n            s_vals = S_poly(x_grid)\n            ds_dx_vals = dS_poly(x_grid)\n\n            # Calculate force error Delta_F(r)\n            # Delta_F = (S(x) - 1) * F0(r) - (1/w) * S'(x) * U0(r)\n            delta_f = (s_vals - 1.0) * f0_vals - (1.0 / w) * ds_dx_vals * u0_vals\n            \n            # Calculate integrand for RMS\n            integrand = delta_f**2\n            \n            # Numerically integrate using the trapezoidal rule\n            integral_val = np.trapz(integrand, r_grid)\n\n            # Compute RMS\n            rms = np.sqrt(integral_val / w)\n            case_results.append(rms)\n        \n        all_results.append(case_results)\n\n    # -------------------------------------------------------------\n    # Final Output Formatting\n    # -------------------------------------------------------------\n    \n    # Format the results into the required string \"[[...],[...],[...]]\"\n    sub_lists_str = [f\"[{','.join(map(str, sub))}]\" for sub in all_results]\n    print(f\"[{','.join(sub_lists_str)}]\")\n\nsolve()\n```", "id": "3451255"}]}