{"hands_on_practices": [{"introduction": "在分子动力学模拟中，为了避免在截断半径处产生不连续的能量和力，从而导致能量不守恒和模拟不稳定，我们需要对势函数进行平滑处理。此练习将指导你推导一个被广泛使用的五次多项式切换函数[@problem_id:3450554]，该函数通过设定其在切换区间端点处的函数值、一阶和二阶导数值，确保了势、力和力的导数（与“刚度”相关）的连续性。掌握这种推导是理解和实现平滑截断势函数的基本功。", "problem": "在分子动力学 (MD) 中，对势的平滑截断是通过将势乘以一个开关函数来实现的，以抑制势及其力在截断半径附近的不连续性。考虑一个对势，它被乘以一个标量开关函数 $S(t)$，其中 $t \\in [0,1]$ 是一个归一化反应坐标，定义为 $t = \\frac{r - r_{\\mathrm{on}}}{r_{\\mathrm{off}} - r_{\\mathrm{on}}}$，且 $r_{\\mathrm{on}}  r_{\\mathrm{off}}$。为避免力中出现人为的冲量及其在边界处的快速变化，通常要求开关函数是二次连续可微的，并满足以下端点条件\n$$S(0) = 1,\\quad S(1) = 0,\\quad S'(0) = 0,\\quad S'(1) = 0,\\quad S''(0) = 0,\\quad S''(1) = 0.$$\n假设 $S(t)$ 是一个形式如下的五次多项式\n$$S(t) = a_{0} + a_{1} t + a_{2} t^{2} + a_{3} t^{3} + a_{4} t^{4} + a_{5} t^{5}.$$\n从这些端点条件以及一阶和二阶导数的定义出发，推导这些条件所蕴含的唯一系数 $\\{a_{k}\\}_{k=0}^{5}$，从而得到 $S(t)$ 的显式解析表达式。然后通过直接代入，显式地验证 $S$、$S'$ 和 $S''$ 在 $t = 0$ 和 $t = 1$ 处的六个边界条件。\n\n只需提供 $S(t)$ 的闭式表达式作为最终答案。不需要进行数值舍入，也没有单位。请将最终答案表示为关于 $t$ 的单个解析表达式。", "solution": "该问题要求推导一个满足一组特定边界条件的五次多项式开关函数 $S(t)$，这是为分子动力学模拟构建平滑势时的一项常见任务。该问题是适定的，并且具有科学依据。\n\n开关函数以归一化坐标 $t \\in [0,1]$ 的五次多项式形式给出：\n$$S(t) = a_{0} + a_{1} t + a_{2} t^{2} + a_{3} t^{3} + a_{4} t^{4} + a_{5} t^{5}$$\n共有六个未知系数 $\\{a_{k}\\}_{k=0}^{5}$。为了求解这些系数，我们有六个关于 $S(t)$ 及其一阶和二阶导数 $S'(t)$ 和 $S''(t)$ 的边界条件。\n\n首先，我们求出 $S(t)$ 的一阶和二阶导数的一般表达式：\n$$S'(t) = \\frac{dS}{dt} = a_{1} + 2 a_{2} t + 3 a_{3} t^{2} + 4 a_{4} t^{3} + 5 a_{5} t^{4}$$\n$$S''(t) = \\frac{d^2S}{dt^2} = 2 a_{2} + 6 a_{3} t + 12 a_{4} t^{2} + 20 a_{5} t^{3}$$\n六个边界条件是：\n1. $S(0) = 1$\n2. $S(1) = 0$\n3. $S'(0) = 0$\n4. $S'(1) = 0$\n5. $S''(0) = 0$\n6. $S''(1) = 0$\n\n我们可以通过系统地应用这些条件来求解系数。$t=0$ 处的条件应用起来特别简单。\n\n由 $S(0) = 1$ 可得：\n$$S(0) = a_{0} + a_{1}(0) + a_{2}(0)^{2} + a_{3}(0)^{3} + a_{4}(0)^{4} + a_{5}(0)^{5} = a_{0}$$\n因此，$a_{0} = 1$。\n\n由 $S'(0) = 0$ 可得：\n$$S'(0) = a_{1} + 2 a_{2}(0) + 3 a_{3}(0)^{2} + 4 a_{4}(0)^{3} + 5 a_{5}(0)^{4} = a_{1}$$\n因此，$a_{1} = 0$。\n\n由 $S''(0) = 0$ 可得：\n$$S''(0) = 2 a_{2} + 6 a_{3}(0) + 12 a_{4}(0)^{2} + 20 a_{5}(0)^{3} = 2 a_{2}$$\n因此，$2 a_{2} = 0$，这意味着 $a_{2} = 0$。\n\n找到了 $a_{0}=1$，$a_{1}=0$ 和 $a_{2}=0$ 后，$S(t)$、$S'(t)$ 和 $S''(t)$ 的多项式大大简化为：\n$$S(t) = 1 + a_{3} t^{3} + a_{4} t^{4} + a_{5} t^{5}$$\n$$S'(t) = 3 a_{3} t^{2} + 4 a_{4} t^{3} + 5 a_{5} t^{4}$$\n$$S''(t) = 6 a_{3} t + 12 a_{4} t^{2} + 20 a_{5} t^{3}$$\n现在，我们应用 $t=1$ 处的其余三个条件来求出剩下的系数 $a_{3}$、$a_{4}$ 和 $a_{5}$。\n\n由 $S(1) = 0$ 可得：\n$$S(1) = 1 + a_{3}(1)^{3} + a_{4}(1)^{4} + a_{5}(1)^{5} = 1 + a_{3} + a_{4} + a_{5} = 0$$\n这给出了我们的第一个方程：\n$$a_{3} + a_{4} + a_{5} = -1 \\quad (\\text{方程 1})$$\n\n由 $S'(1) = 0$ 可得：\n$$S'(1) = 3 a_{3}(1)^{2} + 4 a_{4}(1)^{3} + 5 a_{5}(1)^{4} = 3 a_{3} + 4 a_{4} + 5 a_{5} = 0 \\quad (\\text{方程 2})$$\n\n由 $S''(1) = 0$ 可得：\n$$S''(1) = 6 a_{3}(1) + 12 a_{4}(1)^{2} + 20 a_{5}(1)^{3} = 6 a_{3} + 12 a_{4} + 20 a_{5} = 0$$\n我们可以将此方程除以 $2$ 来简化：\n$$3 a_{3} + 6 a_{4} + 10 a_{5} = 0 \\quad (\\text{方程 3})$$\n\n我们现在得到了一个关于三个未知数 $a_{3}$、$a_{4}$ 和 $a_{5}$ 的三元一次方程组。\n将方程 3 减去方程 2：\n$$(3 a_{3} + 6 a_{4} + 10 a_{5}) - (3 a_{3} + 4 a_{4} + 5 a_{5}) = 0 - 0$$\n$$2 a_{4} + 5 a_{5} = 0 \\implies a_{4} = -\\frac{5}{2} a_{5}$$\n将方程 1 乘以 $3$ 得到 $3a_3 + 3a_4 + 3a_5 = -3$。将方程 2 减去此式：\n$$(3 a_{3} + 4 a_{4} + 5 a_{5}) - (3 a_{3} + 3 a_{4} + 3 a_{5}) = 0 - (-3)$$\n$$a_{4} + 2 a_{5} = 3 \\implies a_{4} = 3 - 2 a_{5}$$\n现在，我们令 $a_4$ 的两个表达式相等：\n$$-\\frac{5}{2} a_{5} = 3 - 2 a_{5}$$\n$$2 a_{5} - \\frac{5}{2} a_{5} = 3$$\n$$-\\frac{1}{2} a_{5} = 3 \\implies a_{5} = -6$$\n将 $a_{5} = -6$ 代回 $a_4$ 的表达式中：\n$$a_{4} = -\\frac{5}{2} (-6) = 15$$\n最后，将 $a_{4}=15$ 和 $a_{5}=-6$ 代入方程 1：\n$$a_{3} + 15 + (-6) = -1$$\n$$a_{3} + 9 = -1 \\implies a_{3} = -10$$\n因此，唯一的系数集为：\n$a_{0}=1$, $a_{1}=0$, $a_{2}=0$, $a_{3}=-10$, $a_{4}=15$, $a_{5}=-6$.\n\n开关函数的显式解析表达式为：\n$$S(t) = 1 - 10 t^{3} + 15 t^{4} - 6 t^{5}$$\n\n最后，按照要求，我们显式地验证该解满足所有六个边界条件。\n首先，导数为：\n$S'(t) = -30 t^{2} + 60 t^{3} - 30 t^{4}$\n$S''(t) = -60 t + 180 t^{2} - 120 t^{3}$\n\n在 $t=0$ 处的验证：\n1. $S(0) = 1 - 10(0)^{3} + 15(0)^{4} - 6(0)^{5} = 1 - 0 + 0 - 0 = 1$。条件满足。\n2. $S'(0) = -30(0)^{2} + 60(0)^{3} - 30(0)^{4} = 0 + 0 - 0 = 0$。条件满足。\n3. $S''(0) = -60(0) + 180(0)^{2} - 120(0)^{3} = 0 + 0 - 0 = 0$。条件满足。\n\n在 $t=1$ 处的验证：\n4. $S(1) = 1 - 10(1)^{3} + 15(1)^{4} - 6(1)^{5} = 1 - 10 + 15 - 6 = 16 - 16 = 0$。条件满足。\n5. $S'(1) = -30(1)^{2} + 60(1)^{3} - 30(1)^{4} = -30 + 60 - 30 = 0$。条件满足。\n6. $S''(1) = -60(1) + 180(1)^{2} - 120(1)^{3} = -60 + 180 - 120 = 0$。条件满足。\n\n推导出的多项式满足所有六个条件。\n推导出的函数 $S(t) = 1 - 10 t^{3} + 15 t^{4} - 6 t^{5}$ 是许多分子动力学软件包中使用的标准开关函数。该多项式也可以因式分解为 $S(t) = (1-t)^3 (1 + 3t + 6t^2)$，这清楚地表明 $S(1)$、$S'(1)$ 和 $S''(1)$ 均为零。具体来说，因子 $(1-t)^3$ 确保了该函数及其前两个导数在 $t=1$ 时为零。", "answer": "$$\\boxed{1 - 10t^{3} + 15t^{4} - 6t^{5}}$$", "id": "3450554"}, {"introduction": "现实世界中的模拟体系通常包含多种不同类型的原子或分子，即混合物。本练习探讨了如何将切换函数的概念一致地应用于不同组分间的交叉相互作用[@problem_id:3450558]。通过运用相应状态原理和常见的组合定则（如Lorentz-Berthelot规则），我们可以为交叉相互作用定义一个物理上自洽的切换方案，确保其与纯组分的处理方式保持一致。", "problem": "考虑一个由两种组分 $i$ 和 $j$ 组成的二元混合物，通过分子动力学 (MD) 进行模拟，其中存在对加性的 Lennard-Jones (LJ) 相互作用。对于组分 $k \\in \\{i,j\\}$，纯组分的 LJ 势定义为 $u_{kk}(r) = 4 \\varepsilon_k \\left[ \\left( \\dfrac{\\sigma_k}{r} \\right)^{12} - \\left( \\dfrac{\\sigma_k}{r} \\right)^6 \\right]$，其中 $\\sigma_k$ 和 $\\varepsilon_k$ 分别是 LJ 尺寸和能量参数。交叉相互作用使用混合规则来定义 $u_{ij}(r) = 4 \\varepsilon_{ij} \\left[ \\left( \\dfrac{\\sigma_{ij}}{r} \\right)^{12} - \\left( \\dfrac{\\sigma_{ij}}{r} \\right)^6 \\right]$，其中采用 Lorentz–Berthelot 混合规则 $\\sigma_{ij} = \\dfrac{\\sigma_i + \\sigma_j}{2}$ 和 $\\varepsilon_{ij} = \\sqrt{\\varepsilon_i \\varepsilon_j}$。\n\n在实践中，为确保力的连续性并避免截断伪影，每对相互作用都乘以一个开关函数 $s_{ab}(r)$，该函数在短程范围内为1，并在有限区间 $\\left[r_{s,ab}, r_{c,ab} \\right]$ 上平滑衰减至零，其中 $ab \\in \\{ii, jj, ij\\}$。对于每个纯组分 $k \\in \\{i,j\\}$，开关窗口以约化形式定义为 $r_{s,kk} = \\alpha_s \\sigma_k$ 和 $r_{c,kk} = \\alpha_c \\sigma_k$，其中 $\\alpha_s$ 和 $\\alpha_c$ 是为模拟选择的固定无量纲常数。开关函数 $s_{kk}(r)$ 的构建需满足：当 $r \\le r_{s,kk}$ 时 $s_{kk}(r) = 1$，当 $r \\ge r_{c,kk}$ 时 $s_{kk}(r) = 0$，并确保势和力在 $r_{s,kk}$ 和 $r_{c,kk}$ 处至少是连续的。\n\n你的任务是选择跨组分的开关距离 $r_{s,ij}$ 和 $r_{c,ij}$，并定义相应的开关函数 $s_{ij}(r)$，以满足以下标准：\n\n- 经过开关函数处理的交叉相互作用 $u_{ij}^{\\text{sw}}(r) = s_{ij}(r)\\,u_{ij}(r)$，在约化变量的意义上，与由 $\\alpha_s$ 和 $\\alpha_c$ 定义的纯组分尾部行为一致。具体来说，当距离以 $\\sigma_{ij}$ 为单位表示时，$u_{ij}^{\\text{sw}}(r)$ 的无量纲截断和开关处理后的尾部行为应与纯组分的构造相匹配。\n- 经过开关函数处理的交叉相互作用确保在开关窗口的端点处，势和力都是连续的，这与纯组分的情况类似。\n\n在给定的 LJ 混合规则和纯组分约化开关窗口的条件下，以下哪个选项能正确确保与纯组分尾部行为的一致性以及平滑的交叉相互作用？\n\nA. 选择 $r_{s,ij} = \\alpha_s \\sigma_{ij}$ 和 $r_{c,ij} = \\alpha_c \\sigma_{ij}$，并在区间 $\\left[r_{s,ij}, r_{c,ij}\\right]$ 上使用一个样条函数来构造 $s_{ij}(r)$，该样条函数强制满足 $s_{ij}(r_{s,ij}) = 1$、$s_{ij}(r_{c,ij}) = 0$ 以及 $s_{ij}'(r_{s,ij}) = s_{ij}'(r_{c,ij}) = 0$，其中样条变量由约化坐标 $y = \\dfrac{r - r_{s,ij}}{r_{c,ij} - r_{s,ij}}$ 定义。\n\nB. 选择 $r_{s,ij} = \\dfrac{r_{s,i} + r_{s,j}}{2}$ 和 $r_{c,ij} = \\dfrac{r_{c,i} + r_{c,j}}{2}$，并重用纯组分的开关函数，而不修改样条变量。\n\nC. 选择 $r_{s,ij} = \\min\\{r_{s,i}, r_{s,j}\\}$ 和 $r_{c,ij} = \\min\\{r_{c,i}, r_{c,j}\\}$，并通过将较短的窗口映射到交叉相互作用上来定义 $s_{ij}(r)$，以确保更保守的截断。\n\nD. 选择 $r_{s,ij} = \\sqrt{r_{s,i} r_{s,j}}$ 和 $r_{c,ij} = \\sqrt{r_{c,i} r_{c,j}}$，并根据绝对距离 $r$ 定义 $s_{ij}(r)$，使得样条变量为 $y = \\dfrac{r - r_{s,ij}}{r_{c,ij} - r_{s,ij}}$，但不参考 $\\sigma_{ij}$。\n\n选择唯一最佳选项。", "solution": "用户希望我验证问题陈述，如果其有效，则推导正确解并评估给定选项。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n\n-   **系统**：一个由两种组分 $i$ 和 $j$ 组成的二元混合物，通过分子动力学 (MD) 模拟。\n-   **纯组分势**：对于组分 $k \\in \\{i, j\\}$，Lennard-Jones (LJ) 势为 $u_{kk}(r) = 4 \\varepsilon_k \\left[ \\left( \\dfrac{\\sigma_k}{r} \\right)^{12} - \\left( \\dfrac{\\sigma_k}{r} \\right)^6 \\right]$，其中尺寸参数为 $\\sigma_k$，能量参数为 $\\varepsilon_k$。\n-   **交叉相互作用势**：交叉相互作用为 $u_{ij}(r) = 4 \\varepsilon_{ij} \\left[ \\left( \\dfrac{\\sigma_{ij}}{r} \\right)^{12} - \\left( \\dfrac{\\sigma_{ij}}{r} \\right)^6 \\right]$。\n-   **混合规则**：交叉相互作用参数由 Lorentz–Berthelot 规则确定：$\\sigma_{ij} = \\dfrac{\\sigma_i + \\sigma_j}{2}$ 和 $\\varepsilon_{ij} = \\sqrt{\\varepsilon_i \\varepsilon_j}$。\n-   **开关函数**：每对相互作用都乘以一个开关函数 $s_{ab}(r)$，作用于有限区间 $[r_{s,ab}, r_{c,ab}]$，其中 $ab \\in \\{ii, jj, ij\\}$。\n-   **纯组分开关窗口**：对于纯组分，开关起始和截断距离以约化形式定义：$r_{s,kk} = \\alpha_s \\sigma_k$ 和 $r_{c,kk} = \\alpha_c \\sigma_k$，使用固定的无量纲常数 $\\alpha_s$ 和 $\\alpha_c$。\n-   **纯组分开关函数属性**：当 $r \\le r_{s,kk}$ 时，$s_{kk}(r) = 1$；当 $r \\ge r_{c,kk}$ 时，$s_{kk}(r) = 0$；并且它确保了在区间端点处势和力的连续性。\n-   **任务**：选择跨组分开关距离 $r_{s,ij}$ 和 $r_{c,ij}$，并定义函数 $s_{ij}(r)$。\n-   **标准 1 (一致性)**：经过开关函数处理的交叉相互作用 $u_{ij}^{\\text{sw}}(r) = s_{ij}(r)\\,u_{ij}(r)$ 必须在约化变量的意义上与纯组分的尾部行为保持一致。当距离以 $\\sigma_{ij}$ 为单位表示时，$u_{ij}^{\\text{sw}}(r)$ 的无量纲尾部行为应与纯组分的构造相匹配。\n-   **标准 2 (平滑性)**：经过开关函数处理的交叉相互作用必须确保在开关窗口端点处势和力的连续性。\n\n**步骤 2：使用提取的已知条件进行验证**\n\n-   **科学基础**：该问题在经典分子动力学模拟的标准实践中有坚实的基础。Lennard-Jones 势、Lorentz-Berthelot 混合规则以及使用开关函数平滑截断势都是该领域基础且广泛应用的概念。\n-   **适定性**：该问题要求一个满足两个明确定义标准的特定构造：与约化变量框架的一致性以及势和力的连续性。这些标准为推导一个唯一且有意义的解提供了坚实的基础。\n-   **客观性**：该问题使用计算物理和化学中常见的精确技术语言陈述。没有主观或模糊的陈述。\n\n问题陈述没有违反任何无效标准。它是科学上合理的、可形式化的、完整的和适定的。\n\n**步骤 3：结论与行动**\n\n问题陈述是有效的。现在开始求解过程。\n\n### 解的推导\n\n问题的核心在于满足约化变量下的一致性标准，这通常与对应状态原理有关。\n\n**1. 纯组分相互作用在约化单位下的分析**\n对于一个纯组分 $k$，LJ 势为 $u_{kk}(r) = 4 \\varepsilon_k \\left[ \\left( \\dfrac{\\sigma_k}{r} \\right)^{12} - \\left( \\dfrac{\\sigma_k}{r} \\right)^6 \\right]$。我们可以定义约化距离 $r_k^* = r/\\sigma_k$ 和约化势 $u_{kk}^* = u_{kk}/\\varepsilon_k$。在这些变量中，势变为：\n$$u_{kk}^*(r_k^*) = 4 \\left[ \\left( \\frac{1}{r_k^*} \\right)^{12} - \\left( \\frac{1}{r_k^*} \\right)^6 \\right]$$\n这个约化势函数对于所有用 LJ 势描述的组分都是通用的。\n\n组分 $k$ 的开关距离由 $r_{s,kk} = \\alpha_s \\sigma_k$ 和 $r_{c,kk} = \\alpha_c \\sigma_k$ 给出。在约化单位中，它们变为：\n$$r_{s,kk}^* = \\frac{r_{s,kk}}{\\sigma_k} = \\alpha_s$$\n$$r_{c,kk}^* = \\frac{r_{c,kk}}{\\sigma_k} = \\alpha_c$$\n这意味着对于任何纯组分，开关总是在相同的约化距离区间 $[\\alpha_s, \\alpha_c]$ 上发生。为保持这种通用性，开关函数 $s_{kk}(r)$ 本身必须是约化距离的函数，即 $s_{kk}(r) = S(r/\\sigma_k) = S(r_k^*)$，其中 $S$ 是一个通用的形状函数。\n\n在约化单位中，经过开关处理的势为 $u_{kk}^{\\text{sw},*}(r_k^*) = \\frac{u_{kk}^{\\text{sw}}(r)}{\\varepsilon_k} = S(r_k^*) u_{kk}^*(r_k^*)$。这整个表达式对于任何纯组分 $k$ 都是通用的。\n\n**2. 在交叉相互作用上的应用**\n问题要求交叉相互作用 $u_{ij}(r)$ 在其自身的约化变量框架中遵循相同的构造。交叉相互作用的特征长度和能量标度分别是 $\\sigma_{ij}$ 和 $\\varepsilon_{ij}$。我们定义约化距离为 $r_{ij}^* = r/\\sigma_{ij}$。\n\n“一致性”标准意味着 $ij$ 相互作用的开关也必须在约化区间 $[\\alpha_s, \\alpha_c]$ 上发生。也就是说，交叉相互作用在约化单位中的开关起始点和结束点，$r_{s,ij}^* = r_{s,ij}/\\sigma_{ij}$ 和 $r_{c,ij}^* = r_{c,ij}/\\sigma_{ij}$，必须等于 $\\alpha_s$ 和 $\\alpha_c$。这直接导出了绝对开关距离的定义：\n$$r_{s,ij} = \\alpha_s \\sigma_{ij}$$\n$$r_{c,ij} = \\alpha_c \\sigma_{ij}$$\n\n**3. 平滑性标准分析**\n第二个标准要求势 $u_{ij}^{\\text{sw}}(r) = s_{ij}(r)u_{ij}(r)$ 和力 $F_{ij}^{\\text{sw}}(r) = -\\frac{d}{dr}u_{ij}^{\\text{sw}}(r)$ 的连续性。\n\n-   当 $r \\le r_{s,ij}$ 时，势就是 $u_{ij}(r)$。在 $r = r_{s,ij}$ 处，连续性要求 $s_{ij}(r_{s,ij})u_{ij}(r_{s,ij}) = u_{ij}(r_{s,ij})$，这意味着 $s_{ij}(r_{s,ij}) = 1$。\n-   当 $r \\ge r_{c,ij}$ 时，势为 $0$。在 $r = r_{c,ij}$ 处，连续性要求 $s_{ij}(r_{c,ij})u_{ij}(r_{c,ij}) = 0$，这意味着 $s_{ij}(r_{c,ij}) = 0$。\n\n-   力为 $F_{ij}^{\\text{sw}}(r) = - \\left[ s_{ij}'(r)u_{ij}(r) + s_{ij}(r)u_{ij}'(r) \\right]$。\n-   当 $r \\le r_{s,ij}$ 时，力为 $F_{ij}(r) = -u_{ij}'(r)$。在 $r = r_{s,ij}$ 处，连续性要求 $-\\left[ s_{ij}'(r_{s,ij})u_{ij}(r_{s,ij}) + s_{ij}(r_{s,ij})u_{ij}'(r_{s,ij}) \\right] = -u_{ij}'(r_{s,ij})$。代入 $s_{ij}(r_{s,ij}) = 1$，我们得到 $-s_{ij}'(r_{s,ij})u_{ij}(r_{s,ij}) - u_{ij}'(r_{s,ij}) = -u_{ij}'(r_{s,ij})$，简化后为 $s_{ij}'(r_{s,ij})u_{ij}(r_{s,ij}) = 0$。由于 $u_{ij}(r_{s,ij})$ 通常不为零，这要求 $s_{ij}'(r_{s,ij}) = 0$。\n-   当 $r \\ge r_{c,ij}$ 时，力为 $0$。在 $r = r_{c,ij}$ 处，连续性要求 $-\\left[ s_{ij}'(r_{c,ij})u_{ij}(r_{c,ij}) + s_{ij}(r_{c,ij})u_{ij}'(r_{c,ij}) \\right] = 0$。代入 $s_{ij}(r_{c,ij}) = 0$，这变为 $-s_{ij}'(r_{c,ij})u_{ij}(r_{c,ij}) = 0$，这要求 $s_{ij}'(r_{c,ij}) = 0$。\n\n总而言之，平滑性标准要求开关函数 $s_{ij}(r)$ 满足四个边界条件：\n1.  $s_{ij}(r_{s,ij}) = 1$\n2.  $s_{ij}(r_{c,ij}) = 0$\n3.  $s_{ij}'(r_{s,ij}) = 0$\n4.  $s_{ij}'(r_{c,ij}) = 0$\n\n一个为满足这些条件而构造的样条函数，定义在归一化变量 $y = \\dfrac{r - r_{s,ij}}{r_{c,ij} - r_{s,ij}}$ 上，确保了开关函数的*形状*是通用的，从而满足了函数本身的一致性标准。\n\n### 逐项分析选项\n\n**A. 选择 $r_{s,ij} = \\alpha_s \\sigma_{ij}$ 和 $r_{c,ij} = \\alpha_c \\sigma_{ij}$，并在区间 $\\left[r_{s,ij}, r_{c,ij}\\right]$ 上使用一个样条函数来构造 $s_{ij}(r)$，该样条函数强制满足 $s_{ij}(r_{s,ij}) = 1$、$s_{ij}(r_{c,ij}) = 0$ 以及 $s_{ij}'(r_{s,ij}) = s_{ij}'(r_{c,ij}) = 0$，其中样条变量由约化坐标 $y = \\dfrac{r - r_{s,ij}}{r_{c,ij} - r_{s,ij}}$ 定义。**\n\n-   **距离**：选择 $r_{s,ij} = \\alpha_s \\sigma_{ij}$ 和 $r_{c,ij} = \\alpha_c \\sigma_{ij}$ 正是约化变量下一致性所要求的，如上文推导所示。\n-   **平滑性**：指定的样条条件 ($s_{ij}(r_{s,ij}) = 1$、$s_{ij}(r_{c,ij}) = 0$、$s_{ij}'(r_{s,ij}) = 0$、$s_{ij}'(r_{c,ij}) = 0$) 正是确保势和力连续性所需的条件。\n-   **样条变量**：使用归一化坐标 $y$ 确保了开关函数的形状是通用的，并将物理距离区间 $[r_{s,ij}, r_{c,ij}]$ 正确地映射到定义样条的数学区间 $[0, 1]$ 上。\n该选项正确且完全满足所有陈述的标准。\n**结论：正确**\n\n**B. 选择 $r_{s,ij} = \\dfrac{r_{s,i} + r_{s,j}}{2}$ 和 $r_{c,ij} = \\dfrac{r_{c,i} + r_{c,j}}{2}$，并重用纯组分的开关函数，而不修改样条变量。**\n\n-   **距离**：我们来分析建议的距离。$r_{s,i} = \\alpha_s \\sigma_i$ 且 $r_{s,j} = \\alpha_s \\sigma_j$。因此，$r_{s,ij} = \\dfrac{\\alpha_s \\sigma_i + \\alpha_s \\sigma_j}{2} = \\alpha_s \\left( \\dfrac{\\sigma_i + \\sigma_j}{2} \\right)$。根据 Lorentz-Berthelot 规则 $\\sigma_{ij} = \\dfrac{\\sigma_i + \\sigma_j}{2}$，这变为 $r_{s,ij} = \\alpha_s \\sigma_{ij}$。类似地，$r_{c,ij} = \\alpha_c \\sigma_{ij}$。建议的距离在数学上与选项 A 中的相同，因此是正确的。\n-   **函数构造**：“重用纯组分的开关函数而不修改样条变量”这一说法存在问题。它不明确要重用哪个函数（$s_{ii}(r)$、$s_{jj}(r)$ 或某种组合）。此外，如果我们重用，例如，$s_{ii}(r)$，其定义依赖于样条变量 $y_i = \\dfrac{r - r_{s,ii}}{r_{c,ii} - r_{s,ii}}$。该函数仅在区间 $[r_{s,ii}, r_{c,ii}]$ 上非平凡，而该区间通常与所需的区间 $[r_{s,ij}, r_{c,ij}]$ 不同，除非 $\\sigma_i = \\sigma_j$。使用在错误区间上定义的函数是不正确的。这部分的提议不一致且定义不明确。\n**结论：不正确**\n\n**C. 选择 $r_{s,ij} = \\min\\{r_{s,i}, r_{s,j}\\}$ 和 $r_{c,ij} = \\min\\{r_{c,i}, r_{c,j}\\}$，并通过将较短的窗口映射到交叉相互作用上来定义 $s_{ij}(r)$，以确保更保守的截断。**\n\n-   **距离**：不失一般性，我们假设 $\\sigma_i \\le \\sigma_j$。那么 $r_{s,i} = \\alpha_s \\sigma_i \\le \\alpha_s \\sigma_j = r_{s,j}$。所以，$r_{s,ij} = \\min\\{r_{s,i}, r_{s,j}\\} = r_{s,i} = \\alpha_s \\sigma_i$。一致性原理要求 $r_{s,ij} = \\alpha_s \\sigma_{ij} = \\alpha_s \\left( \\dfrac{\\sigma_i + \\sigma_j}{2} \\right)$。这两者不相等，除非 $\\sigma_i = \\sigma_j$。约化的开关起始距离将是 $r_{s,ij}/\\sigma_{ij} = \\alpha_s \\sigma_i / \\sigma_{ij}$，而不是常数 $\\alpha_s$。这违反了一致性标准。\n**结论：不正确**\n\n**D. 选择 $r_{s,ij} = \\sqrt{r_{s,i} r_{s,j}}$ 和 $r_{c,ij} = \\sqrt{r_{c,i} r_{c,j}}$，并根据绝对距离 $r$ 定义 $s_{ij}(r)$，使得样条变量为 $y = \\dfrac{r - r_{s,ij}}{r_{c,ij} - r_{s,ij}}$，但不参考 $\\sigma_{ij}$。**\n\n-   **距离**：建议的规则是 $r_{s,ij} = \\sqrt{(\\alpha_s \\sigma_i)(\\alpha_s \\sigma_j)} = \\alpha_s \\sqrt{\\sigma_i \\sigma_j}$。一致性原理要求 $r_{s,ij} = \\alpha_s \\sigma_{ij} = \\alpha_s \\left( \\dfrac{\\sigma_i + \\sigma_j}{2} \\right)$。根据算术-几何平均值不等式，$\\sqrt{\\sigma_i \\sigma_j} \\le \\dfrac{\\sigma_i + \\sigma_j}{2}$，等号仅在 $\\sigma_i = \\sigma_j$ 时成立。因此，这个开关距离的“几何平均”规则与底层 $\\sigma_{ij}$ 参数使用的“算术平均”规则不一致，违反了一致性标准。\n**结论：不正确**", "answer": "$$\\boxed{A}$$", "id": "3450558"}, {"introduction": "除了使用预设的解析势函数，现代分子模拟越来越多地采用从第一性原理数据中“学习”势函数的方法。本练习将引导你进入这一前沿领域，展示如何使用样条函数作为基函数来拟合一个灵活的对势[@problem_id:3450585]。你将学习如何构建一个优化问题，该问题不仅要平衡数据保真度和平滑度（通过曲率正则化实现），还要通过线性约束严格施加物理条件，如有限的作用范围和在截断点处力的连续性。这个问题为你连接经典分子动力学与机器学习势领域架起了一座桥梁。", "problem": "在原子分子动力学中，构建一个稳定、有限范围、各向同性的对势的常用策略是：从数据中学习一个光滑的径向函数 $f(r)$，同时在截断半径附近强制施加有限支撑和力连续性。考虑一个定义在 $r \\in [0, r_c]$ 上的各向同性对势 $f(r)$，并强制其满足硬切换条件，即对于 $r \\ge r_c$，$f(r) = 0$。为避免在截断处出现冲力，径向力 $-f'(r)$ 必须在 $r = r_c$ 处连续。给定从模拟或从头计算中收集的两个数据集：能量样本 $\\{(r_i, E_i)\\}_{i=1}^N$ 和径向力样本 $\\{(\\tilde r_j, F_j)\\}_{j=1}^M$，其中 $F_j$ 是在间距 $\\tilde r_j$ 处测得的径向力大小。假设测量值存在独立的、具有已知正权重的高斯噪声，这些权重被编码在对角矩阵 $W_E \\in \\mathbb{R}^{N \\times N}$ 和 $W_F \\in \\mathbb{R}^{M \\times M}$ 中。\n\n在 $[0, r_c]$ 上，用一组三次样条基 $\\{B_k(r)\\}_{k=1}^K$ 和系数 $\\theta \\in \\mathbb{R}^K$ 来表示 $f(r)$，使得 $f(r) = \\sum_{k=1}^K \\theta_k B_k(r)$。你需要构建一个学习策略，该策略通过一个与 $\\int_0^{r_c} (f''(r))^2 \\, dr$ 成正比的粗糙度项来惩罚曲率，从而在数据保真度与光滑性之间取得平衡，同时通过对系数施加适当的线性约束来严格执行在 $r = r_c$ 处的硬切换和力连续性条件。从以下基本原则出发：\n\n- 在经典力学中，力是势的负梯度，因此对于纯径向对势，径向力的大小为 $-f'(r)$。\n- 对于固定的基，带有二次粗糙度惩罚的惩罚最小二乘法会产生一个关于系数的凸二次目标函数。\n- 线性等式约束可以对 $f(r)$ 的基表示施加边界和切换条件。\n\n令 $\\Phi_E \\in \\mathbb{R}^{N \\times K}$ 和 $\\Phi_F' \\in \\mathbb{R}^{M \\times K}$ 分别表示能量和力的设计矩阵，其元素分别为 $(\\Phi_E)_{ik} = B_k(r_i)$ 和 $(\\Phi_F')_{jk} = B_k'(\\tilde r_j)$。令 $R \\in \\mathbb{R}^{K \\times K}$ 表示对称半正定矩阵，它在样条基中编码了由 $\\int_0^{r_c} (f''(r))^2 \\, dr$ 产生的曲率惩罚。令 $A \\in \\mathbb{R}^{2 \\times K}$ 编码在 $r_c$ 处对系数施加的硬切换约束。\n\n哪个选项正确地指定了一个连贯的优化目标，用于从能量和力数据中学习带有曲率正则化的 $f(r)$，陈述了为实现 $r_c$ 处的硬切换和力连续性而施加的适当线性约束，并给出了关于系数的 Karush–Kuhn–Tucker (KKT) 系统形式的正确一阶最优性条件？假设所有矩阵的维度兼容，并且给定的权重和基函数使得所述量均有良好定义。\n\nA. 定义惩罚目标\n$$\nJ(\\theta) = \\tfrac{1}{2} \\lVert E - \\Phi_E \\theta \\rVert_{W_E}^2 + \\tfrac{1}{2} \\lVert F + \\Phi_F' \\theta \\rVert_{W_F}^2 + \\tfrac{\\lambda}{2} \\theta^\\top R \\theta\n$$\n受以下线性等式约束\n$$\nA \\theta = 0, \\quad \\text{其中 } A = \\begin{bmatrix} B_1(r_c)  \\cdots  B_K(r_c) \\\\ B_1'(r_c)  \\cdots  B_K'(r_c) \\end{bmatrix}.\n$$\n一阶最优性条件是关于未知数 $(\\theta,\\nu)$ 的 KKT 系统：\n$$\n\\begin{bmatrix}\n\\Phi_E^\\top W_E \\Phi_E + \\Phi_F'^\\top W_F \\Phi_F' + \\lambda R  A^\\top \\\\\nA  0\n\\end{bmatrix}\n\\begin{bmatrix}\n\\theta \\\\ \\nu\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\Phi_E^\\top W_E E - \\Phi_F'^\\top W_F F \\\\ 0\n\\end{bmatrix}.\n$$\n当海森矩阵 $\\Phi_E^\\top W_E \\Phi_E + \\Phi_F'^\\top W_F \\Phi_F' + \\lambda R$ 在 $A$ 的零空间上是正定的时候，解是唯一的。\n\nB. 定义惩罚目标\n$$\nJ(\\theta) = \\tfrac{1}{2} \\lVert E - \\Phi_E \\theta \\rVert_{W_E}^2 + \\tfrac{1}{2} \\lVert F - \\Phi_F' \\theta \\rVert_{W_F}^2 + \\tfrac{\\lambda}{2} \\theta^\\top R \\theta\n$$\n受单个约束 $f(r_c)=0$ 限制，即\n$$\nA \\theta = 0, \\quad \\text{其中 } A = \\begin{bmatrix} B_1(r_c)  \\cdots  B_K(r_c) \\end{bmatrix}.\n$$\nKKT 系统为\n$$\n\\begin{bmatrix}\n\\Phi_E^\\top W_E \\Phi_E + \\Phi_F'^\\top W_F \\Phi_F' + \\lambda R  A^\\top \\\\\nA  0\n\\end{bmatrix}\n\\begin{bmatrix}\n\\theta \\\\ \\nu\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\Phi_E^\\top W_E E + \\Phi_F'^\\top W_F F \\\\ 0\n\\end{bmatrix}.\n$$\n\nC. 定义惩罚目标\n$$\nJ(\\theta) = \\tfrac{1}{2} \\lVert E - \\Phi_E \\theta \\rVert_{W_E}^2 + \\tfrac{\\lambda}{2} \\theta^\\top R \\theta\n$$\n不使用力数据，并通过以下约束强制执行在 $r_c$ 处的硬切换和力连续性\n$$\nA \\theta = 0, \\quad \\text{其中 } A = \\begin{bmatrix} B_1(r_c)  \\cdots  B_K(r_c) \\\\ B_1''(r_c)  \\cdots  B_K''(r_c) \\end{bmatrix}.\n$$\nKKT 系统与选项 A 中的相同，但省略了 $\\Phi_F'$ 和 $W_F$。\n\nD. 将样条乘以一个光滑的切换函数 $s(r)$，其中对于 $r \\le r_c$，$s(r)=1$，而对于 $r  r_c$，$s(r) \\in (0,1)$ 且递减，使得 $f(r) = \\sum_{k=1}^K \\theta_k B_k(r) s(r)$，并最小化\n$$\nJ(\\theta) = \\tfrac{1}{2} \\lVert E - \\Phi_E^s \\theta \\rVert_{W_E}^2 + \\tfrac{1}{2} \\lVert F + (\\Phi_F^s)' \\theta \\rVert_{W_F}^2 + \\tfrac{\\lambda}{2} \\theta^\\top R \\theta\n$$\n没有显式约束，其中 $\\Phi_E^s$ 和 $(\\Phi_F^s)'$ 是切换后基的设计矩阵。这会自动强制执行硬切换，并避免了 KKT 约束。\n\nE. 定义惩罚目标\n$$\nJ(\\theta) = \\tfrac{1}{2} \\lVert E - \\Phi_E \\theta \\rVert_{W_E}^2 + \\tfrac{1}{2} \\lVert F + \\Phi_F' \\theta \\rVert_{W_F}^2 + \\tfrac{\\lambda}{2} \\theta^\\top R \\theta\n$$\n受 $A \\theta = 0$ 约束，强制执行 $f(r_c)=0$ 和 $f'(r_c)=0$，如选项 A 所示。KKT 系统是奇异的，除非 $R$ 是严格正定的；因此，无论数据设计矩阵如何，唯一性都要求 $\\lambda  0$ 和 $R \\succ 0$。", "solution": "问题要求为从能量和力数据中学习各向同性对势 $f(r)$，在截断半径 $r_c$ 处受特定约束的情况下，给出惩罚最小二乘优化问题的正确表述。该表述必须包括目标函数、线性约束以及由此产生的一阶最优性（KKT）条件。\n\n### 第一步：优化问题的构建\n\n让我们从基本原则和给定的数据推导优化问题的各个组成部分。\n\n#### 1. 目标函数 $J(\\theta)$\n目标函数是三项之和：能量的数据保真度项、力的数据保真度项和光滑性的正则化项。\n\n- **能量数据保真度：** 模型对一组点 $\\{r_i\\}_{i=1}^N$ 处的能量预测由向量 $\\Phi_E \\theta$ 给出，其中 $(\\Phi_E)_{ik} = B_k(r_i)$。观测到的能量由向量 $E$ 给出。加权平方误差为 $\\lVert E - \\Phi_E \\theta \\rVert_{W_E}^2 = (E - \\Phi_E \\theta)^\\top W_E (E - \\Phi_E \\theta)$。问题使用了常规的前置因子 $\\frac{1}{2}$。因此，能量项为 $\\frac{1}{2} \\lVert E - \\Phi_E \\theta \\rVert_{W_E}^2$。\n\n- **力数据保真度：** 问题指出径向力大小为 $-f'(r)$。势的模型是 $f(r) = \\sum_{k=1}^K \\theta_k B_k(r)$。因此，径向力大小的模型是 $-f'(r) = -\\sum_{k=1}^K \\theta_k B_k'(r)$。在数据点 $\\{\\tilde{r}_j\\}_{j=1}^M$ 处，预测的力大小向量为 $-\\Phi_F' \\theta$，其中 $(\\Phi_F')_{jk} = B_k'(\\tilde{r}_j)$。观测到的力大小由向量 $F$ 给出。残差向量是观测值与预测值之差：$F - (-\\Phi_F' \\theta) = F + \\Phi_F' \\theta$。加权平方误差为 $\\lVert F + \\Phi_F' \\theta \\rVert_{W_F}^2 = (F + \\Phi_F' \\theta)^\\top W_F (F + \\Phi_F' \\theta)$。包含常规的前置因子 $\\frac{1}{2}$，力项为 $\\frac{1}{2} \\lVert F + \\Phi_F' \\theta \\rVert_{W_F}^2$。\n\n- **正则化项：** 通过惩罚二阶导数平方的积分（即曲率）来鼓励光滑性。势的二阶导数是 $f''(r) = \\sum_{k=1}^K \\theta_k B_k''(r)$。惩罚项与 $\\int_0^{r_c} (f''(r))^2 \\, dr$ 成正比。\n$$\n\\int_0^{r_c} (f''(r))^2 \\, dr = \\int_0^{r_c} \\left( \\sum_k \\theta_k B_k''(r) \\right) \\left( \\sum_l \\theta_l B_l''(r) \\right) \\, dr = \\sum_{k,l} \\theta_k \\theta_l \\left( \\int_0^{r_c} B_k''(r) B_l''(r) \\, dr \\right)\n$$\n这是一个二次型 $\\theta^\\top R \\theta$，其中矩阵 $R$ 的元素为 $R_{kl} = \\int_0^{r_c} B_k''(r) B_l''(r) \\, dr$。问题指出该项被给定为 $\\frac{\\lambda}{2} \\theta^\\top R \\theta$，其中 $\\lambda$ 是一个非负的正则化参数。\n\n- **总目标函数：** 结合这三部分，待最小化的惩罚目标函数为：\n$$\nJ(\\theta) = \\frac{1}{2} \\lVert E - \\Phi_E \\theta \\rVert_{W_E}^2 + \\frac{1}{2} \\lVert F + \\Phi_F' \\theta \\rVert_{W_F}^2 + \\frac{\\lambda}{2} \\theta^\\top R \\theta\n$$\n\n#### 2. 约束条件\n问题要求在截断半径 $r_c$ 处严格执行“硬切换”和“力连续性”。\n- **硬切换：** 对于 $r \\ge r_c$，势函数 $f(r) = 0$。为保证势函数本身在 $r_c$ 处的连续性，我们必须有 $f(r_c) = 0$。用样条表示，即：\n$$\nf(r_c) = \\sum_{k=1}^K \\theta_k B_k(r_c) = 0\n$$\n- **力连续性：** 径向力为 $-f'(r)$。对于 $r  r_c$，由于 $f(r)=0$，力为 $0$。为确保在 $r_c$ 处的连续性，当 $r \\to r_c^-$ 时，从样条表示计算出的力也必须为 $0$。即 $-f'(r_c) = 0$，这意味着 $f'(r_c) = 0$。用样条表示，即：\n$$\nf'(r_c) = \\sum_{k=1}^K \\theta_k B_k'(r_c) = 0\n$$\n- **约束矩阵：** 这两个关于 $\\theta$ 的线性齐次方程可以写成矩阵形式 $A\\theta = 0$，其中矩阵 $A \\in \\mathbb{R}^{2 \\times K}$ 定义为：\n$$\nA = \\begin{bmatrix}\nB_1(r_c)  B_2(r_c)  \\cdots  B_K(r_c) \\\\\nB_1'(r_c)  B_2'(r_c)  \\cdots  B_K'(r_c)\n\\end{bmatrix}\n$$\n\n### 第二步：一阶最优性（KKT）条件\n该问题是一个凸二次约束二次规划（QCQP），可以简化为一个带线性等式约束的二次规划（QP）。我们在 $A\\theta=0$ 的约束下最小化 $J(\\theta)$。拉格朗日函数为 $\\mathcal{L}(\\theta, \\nu) = J(\\theta) + \\nu^\\top (A\\theta)$，其中 $\\nu \\in \\mathbb{R}^2$ 是拉格朗日乘子向量。KKT 条件通过将 $\\mathcal{L}$ 关于 $\\theta$ 和 $\\nu$ 的梯度设为零来推导。\n\n- **关于 $\\nu$ 的梯度：** $\\nabla_\\nu \\mathcal{L} = A\\theta = 0$。这恢复了约束条件。\n\n- **关于 $\\theta$ 的梯度：** $\\nabla_\\theta \\mathcal{L} = \\nabla_\\theta J(\\theta) + A^\\top \\nu = 0$。让我们计算 $J(\\theta)$ 的梯度：\n$$\nJ(\\theta) = \\frac{1}{2} (E^\\top W_E E - 2E^\\top W_E \\Phi_E \\theta + \\theta^\\top \\Phi_E^\\top W_E \\Phi_E \\theta) + \\frac{1}{2} (F^\\top W_F F + 2F^\\top W_F \\Phi_F' \\theta + \\theta^\\top (\\Phi_F')^\\top W_F \\Phi_F' \\theta) + \\frac{\\lambda}{2} \\theta^\\top R \\theta\n$$\n使用标准矩阵微积分恒等式 $\\nabla_\\theta (c^\\top \\theta) = c$ 和 $\\nabla_\\theta(\\theta^\\top M \\theta) = 2 M \\theta$（对于对称矩阵 $M$），我们得到：\n$$\n\\nabla_\\theta J(\\theta) = - \\Phi_E^\\top W_E E + \\Phi_E^\\top W_E \\Phi_E \\theta + (\\Phi_F')^\\top W_F F + (\\Phi_F')^\\top W_F \\Phi_F' \\theta + \\lambda R \\theta\n$$\n$$\n\\nabla_\\theta J(\\theta) = (\\Phi_E^\\top W_E \\Phi_E + (\\Phi_F')^\\top W_F \\Phi_F' + \\lambda R) \\theta - (\\Phi_E^\\top W_E E - (\\Phi_F')^\\top W_F F)\n$$\n令 $\\nabla_\\theta \\mathcal{L} = 0$ 给出：\n$$\n(\\Phi_E^\\top W_E \\Phi_E + (\\Phi_F')^\\top W_F \\Phi_F' + \\lambda R) \\theta + A^\\top \\nu = \\Phi_E^\\top W_E E - (\\Phi_F')^\\top W_F F\n$$\n\n- **分块矩阵形式的 KKT 系统：** 结合两个梯度条件，我们得到关于未知数 $(\\theta, \\nu)$ 的 KKT 系统：\n$$\n\\begin{bmatrix}\n\\Phi_E^\\top W_E \\Phi_E + (\\Phi_F')^\\top W_F \\Phi_F' + \\lambda R  A^\\top \\\\\nA  0\n\\end{bmatrix}\n\\begin{bmatrix}\n\\theta \\\\ \\nu\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\Phi_E^\\top W_E E - (\\Phi_F')^\\top W_F F \\\\ 0\n\\end{bmatrix}\n$$\n记法 $\\Phi_F'^\\top W_F \\Phi_F'$ 等价于 $(\\Phi_F')^\\top W_F \\Phi_F'$。唯一解的条件是 KKT 矩阵可逆。如果目标函数的海森矩阵 $H = \\Phi_E^\\top W_E \\Phi_E + (\\Phi_F')^\\top W_F \\Phi_F' + \\lambda R$ 在 $A$ 的零空间上是正定的，并且 $A$ 是行满秩的，则可保证解的唯一性。\n\n### 第三步：选项评估\n\n- **选项 A：** 该选项提供：\n    - 目标：$J(\\theta) = \\tfrac{1}{2} \\lVert E - \\Phi_E \\theta \\rVert_{W_E}^2 + \\tfrac{1}{2} \\lVert F + \\Phi_F' \\theta \\rVert_{W_F}^2 + \\tfrac{\\lambda}{2} \\theta^\\top R \\theta$。这与我们推导的目标函数相符。\n    - 约束：$A \\theta = 0$，其中 $A = \\begin{bmatrix} B_1(r_c)  \\cdots  B_K(r_c) \\\\ B_1'(r_c)  \\cdots  B_K'(r_c) \\end{bmatrix}$。这正确地强制执行了 $f(r_c)=0$ 和 $f'(r_c)=0$。\n    - KKT 系统：分块矩阵系统与我们推导的系统完全相同。海森矩阵、约束块和右侧向量都正确。\n    - 唯一性：所述条件，即海森矩阵必须在 $A$ 的零空间上是正定的，是正确的条件。\n    - **结论：正确**。\n\n- **选项 B：** 该选项提供：\n    - 目标：力项为 $\\tfrac{1}{2} \\lVert F - \\Phi_F' \\theta \\rVert_{W_F}^2$。这在物理上是不正确的，因为它将观测到的力大小 $F$ 与量 $\\Phi_F'\\theta$ 进行比较，而模型预测的力大小为 $-\\Phi_F'\\theta$。\n    - 约束：约束矩阵 $A$ 仅强制执行了 $f(r_c)=0$，而忽略了力连续性约束 $f'(r_c)=0$。这是不完整的。\n    - KKT 系统：由于不正确的目标函数，右侧项存在符号错误。\n    - **结论：不正确**。\n\n- **选项 C：** 该选项提供：\n    - 目标：目标函数 $J(\\theta) = \\tfrac{1}{2} \\lVert E - \\Phi_E \\theta \\rVert_{W_E}^2 + \\tfrac{\\lambda}{2} \\theta^\\top R \\theta$ 完全忽略了被指定为学习任务一部分的力数据 $\\{(\\tilde r_j, F_j)\\}_{j=1}^M$。\n    - 约束：约束矩阵 $A$ 强制执行 $f(r_c) = 0$ 和 $f''(r_c) = 0$。第二个约束 $f''(r_c)=0$ 不是所要求的力连续性条件（$f'(r_c)=0$）。\n    - **结论：不正确**。\n\n- **选项 D：** 该选项提出了一个不同的建模方法。它不是使用线性约束，而是将样条乘以一个切换函数 $s(r)$，以将边界条件构建到基函数中。这与问题中“在 $[0, r_c]$ 上，用一组三次样条基 ... 来表示 $f(r)$”和“通过对系数施加适当的线性约束来严格执行硬切换和力连续性”的明确指示相矛盾。虽然这通常是一种有效的技术，但它没有回答所提出的问题。\n    - **结论：不正确**。\n\n- **选项 E：** 该选项提供：\n    - 目标和约束：这些与选项 A 相同，是正确的。\n    - KKT 系统和唯一性：它声称“KKT 系统是奇异的，除非 $R$ 是严格正定的...唯一性都要求 $\\lambda  0$ 和 $R \\succ 0$ 无论数据设计矩阵如何。”这个说法是错误的。它将一个唯一性的充分条件（即海森矩阵在整个空间上是正定的）表述为一个必要条件。即使 $R$ 是奇异的（即只是半正定的）和/或 $\\lambda=0$，只要海森矩阵的数据依赖部分在约束的零空间上提供了足够的信息，唯一解也可以实现。选项A中的条件才是正确的、更通用的条件。\n    - **结论：不正确**。\n\n基于此详细分析，只有选项 A 提出了与问题陈述完全相符的、正确且连贯的表述。", "answer": "$$\\boxed{A}$$", "id": "3450585"}]}