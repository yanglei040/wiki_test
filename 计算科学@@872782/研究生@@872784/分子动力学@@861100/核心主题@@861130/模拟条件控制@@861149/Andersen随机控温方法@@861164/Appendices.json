{"hands_on_practices": [{"introduction": "要掌握安德森恒温器，最核心的第一步是学习如何从正确的统计分布中为粒子生成速度。本练习将指导您从第一性原理出发，为具有不同质量的粒子实现麦克斯韦-玻尔兹曼速度采样器。更重要的是，您还将实现一个严格的统计检验（卡方检验）来验证您的采样算法是否准确地再现了理论预期的速度分布，这是确保模拟物理真实性的关键一步。[@problem_id:3395469]", "problem": "您需要为分子动力学中的安德森随机恒温器设计并实现一个显式抽样与验证程序。该任务包含两个部分：(i) 为具有非均匀质量的粒子抽样麦克斯韦-玻尔兹曼速度，以及 (ii) 实现一个统计上严谨的测试，以验证抽样得到的速度分量是否具有热力学平衡所要求的正确方差。您的最终输出必须由一个如下文所规定的单一完整程序生成。\n\n此任务的基础必须从第一性原理推导得出。使用固定温度下的正则系综作为基础。从以下基本事实出发：对于一个质量为 $m$、处于绝对温度 $T$ 下的单个粒子，其正则动量分布是可分解的，并且每个笛卡尔速度分量 $v_{\\alpha}$（其中 $\\alpha \\in \\{x,y,z\\}$）是独立的，其高斯密度与 $\\exp\\!\\big(-\\beta \\tfrac{1}{2} m v_{\\alpha}^{2}\\big)$ 成正比，其中 $\\beta = 1/(k_{B} T)$ 且 $k_{B}$ 是玻尔兹曼常数。除这些原理外，不要假定任何预先推导出的抽样公式。使用这些原理来证明您算法设计中的每一步。\n\n您必须整合安德森随机恒温器过程。在安德森恒温器中，每个粒子根据速率为 $\\nu$（每秒碰撞次数）的泊松过程经历随机碰撞。在一个持续时间为 $\\Delta t$ 的离散时间步长内，一个粒子经历至少一次碰撞的概率为 $p = 1 - \\exp(-\\nu \\Delta t)$。如果发生碰撞，粒子的笛卡尔速度分量将从目标温度 $T$ 下的麦克斯韦-玻尔兹曼分布中瞬时重新抽取；否则，其速度保持不变。\n\n您的程序必须：\n- 实现一个函数，用于在温度 $T$ 下为 $N$ 个具有非均匀质量（即对于 $i=1,\\dots,N$，$m_i$ 各不相同）的粒子抽样速度。除非测试另有规定，否则使用三维空间。粒子 $i$ 的样本必须具有独立的、均值为零且方差为 $k_{B} T / m_{i}$ 的分量。\n- 实现一个单步安德森恒温器更新，该更新在给定当前速度的情况下，以概率 $p = 1 - \\exp(-\\nu \\Delta t)$ 对每个粒子应用独立的伯努利碰撞。对于发生碰撞的粒子，从与其自身质量和目标温度 $T$ 相对应的麦克斯韦-玻尔兹曼分布中重新分配其速度。\n- 实现一个统计测试，以验证麦克斯韦-玻尔兹曼分布所蕴含的方差条件。具体来说，给定一个速度样本 $\\{v_{i,\\alpha}\\}$、质量样本 $\\{m_{i}\\}$ 和温度 $T$，定义标准化分量 $z_{i,\\alpha} = v_{i,\\alpha} \\sqrt{m_{i}/(k_{B} T)}$。在正确的麦克斯韦-玻尔兹曼分布下，$z_{i,\\alpha}$ 是独立的标准正态随机变量。因此，在方差等于 $k_{B} T / m_{i}$ 的原假设下，统计量\n$$\nS = \\sum_{i=1}^{N} \\sum_{\\alpha=1}^{d} z_{i,\\alpha}^{2}\n$$\n服从自由度为 $dN$ 的卡方分布。您的测试必须在用户指定的显著性水平 $\\alpha$ 下，通过检查 $S$ 是否位于自由度为 $dN$ 的卡方分布的 $\\alpha/2$ 和 $1-\\alpha/2$ 分位数之间，来实现一个双边卡方接受准则。\n\n单位：\n- 质量 $m_{i}$ 必须以千克 $\\mathrm{kg}$ 为单位提供。\n- 温度 $T$ 必须以开尔文 $\\mathrm{K}$ 为单位。\n- 玻尔兹曼常数 $k_{B}$ 必须使用 $k_{B} = 1.380649 \\times 10^{-23}\\,\\mathrm{J/K}$ 这个值。\n- 算法必须以米/秒 $\\mathrm{m/s}$ 为单位输出速度。\n- 时间步长 $\\Delta t$ 必须以秒 $\\mathrm{s}$ 为单位，碰撞速率 $\\nu$ 以 $\\mathrm{s}^{-1}$ 为单位。\n\n您的程序必须运行以下测试套件。对于每个测试用例，返回一个布尔值，指示卡方方差测试是否在显著性水平 $\\alpha = 0.05$ 下接受原假设。\n\n- 测试用例 1（非均匀质量，一般情况）：\n  - $N = 2000$，$d = 3$。\n  - 温度 $T = 300\\,\\mathrm{K}$。\n  - 质量从集合 $\\{28, 40, 84\\}$ 统一原子质量单位中以相等概率独立抽取，并通过将每个原子质量单位乘以 $1.66053906660 \\times 10^{-27}\\,\\mathrm{kg}$ 转换为千克。也就是说，可用质量为 $28\\,\\mathrm{u}$、$40\\,\\mathrm{u}$ 和 $84\\,\\mathrm{u}$（单位为 $\\mathrm{kg}$）。\n  - 抽样全新的麦克斯韦-玻尔兹曼速度并执行卡方方差测试。\n  - 使用固定的随机种子以确保确定性。\n\n- 测试用例 2（样本量适中，质量非均匀性大）：\n  - $N = 90$，$d = 3$。\n  - 温度 $T = 1000\\,\\mathrm{K}$。\n  - 质量在 $N$ 个粒子中从 $1\\,\\mathrm{u}$ 到 $100\\,\\mathrm{u}$ 之间线性分布，并转换为 $\\mathrm{kg}$。\n  - 抽样全新的麦克斯韦-玻尔兹曼速度并执行卡方方差测试。\n  - 使用固定的随机种子以确保确定性。\n\n- 测试用例 3（多步安德森恒温器热化）：\n  - $N = 1000$，$d = 3$。\n  - 温度 $T = 500\\,\\mathrm{K}$。\n  - 质量从区间 $[10\\,\\mathrm{u}, 50\\,\\mathrm{u}]$ 中独立均匀抽取，并转换为 $\\mathrm{kg}$。\n  - 将所有速度初始化为零。\n  - 应用 $100$ 个安德森步，碰撞速率 $\\nu = 2 \\times 10^{14}\\,\\mathrm{s}^{-1}$，时间步长 $\\Delta t = 1 \\times 10^{-15}\\,\\mathrm{s}$。\n  - 对最终速度执行卡方方差测试。\n  - 使用固定的随机种子以确保确定性。\n\n- 测试用例 4（用于检测不正确方差的阴性对照）：\n  - $N = 1500$，$d = 2$。\n  - 温度 $T = 400\\,\\mathrm{K}$。\n  - 所有质量均等于 $20\\,\\mathrm{u}$（单位为 $\\mathrm{kg}$）。\n  - 抽样麦克斯韦-玻尔兹曼速度，然后将所有速度分量乘以因子 $1.5$。\n  - 执行卡方方差测试；它应该以高概率拒绝原假设。\n  - 使用固定的随机种子以确保确定性。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，例如 $[r_{1},r_{2},r_{3},r_{4}]$，其中每个 $r_{i}$ 是一个布尔值，表示测试用例 $i$ 的方差测试的接受或拒绝情况。\n\n您的程序必须完全独立，无需任何输入。所有随机选择必须由显式固定的种子控制，以确保确定性输出。唯一允许使用的库是 Python 标准库、NumPy 和 SciPy。", "solution": "此任务旨在设计并实现一个从麦克斯韦-玻尔兹曼分布中抽样粒子速度的程序，并使用基于卡方分布的统计测试来验证样本的正确性。该程序是分子动力学模拟中使用的安德森随机恒温器的核心。从抽样到验证的整个过程都将从统计力学的原理推导得出。\n\n### 1. 理论基础：麦克斯韦-玻尔兹曼速度分布\n\n在正则系综中，一个包含 $N$ 个粒子、体积为 $V$ 的系统与一个恒定绝对温度为 $T$ 的热浴进行热接触。系统处于能量为 $E$ 的微观状态的概率与玻尔兹曼因子 $\\exp(-\\beta E)$ 成正比，其中 $\\beta = 1/(k_{B} T)$ 且 $k_{B}$ 是玻尔兹曼常数。\n\n对于一个无相互作用粒子的经典系统（或势能与动量无关的系统），总动能是单个粒子动能之和，$E_K = \\sum_{i=1}^{N} \\frac{\\mathbf{p}_i^2}{2m_i}$，其中 $\\mathbf{p}_i = m_i \\mathbf{v}_i$ 是质量为 $m_i$ 的粒子 $i$ 的动量。动量的相空间概率分布是可分解的，意味着每个粒子的动量与其他粒子相互独立。此外，对于单个粒子，动量的每个笛卡尔分量的分布也是独立的。对于 $v_{i,\\alpha}$ 的概率密度函数 (PDF) 由下式给出：\n$$\nf(v_{i,\\alpha}) \\propto \\exp\\left(-\\beta \\frac{1}{2} m_i v_{i,\\alpha}^2\\right) = \\exp\\left(-\\frac{m_i v_{i,\\alpha}^2}{2 k_B T}\\right)\n$$\n这是均值为 $\\mu = 0$、方差为 $\\sigma^2$ 的高斯（正态）分布的函数形式。一个通用的高斯 PDF 是 $N(\\mu, \\sigma^2) \\propto \\exp\\left(-\\frac{(x-\\mu)^2}{2\\sigma^2}\\right)$。通过比较这两种形式，我们确定均值为 $\\mu=0$，方差为：\n$$\n\\sigma_{i}^2 = \\frac{k_B T}{m_i}\n$$\n因此，在热平衡状态下，质量为 $m_i$ 的粒子的每个笛卡尔速度分量 $v_{i,\\alpha}$ 都是从正态分布 $N(0, k_B T / m_i)$ 中抽取的独立随机变量。\n\n### 2. 算法设计：速度抽样\n\n要从分布 $N(0, k_B T / m_i)$ 中抽样一个速度分量 $v_{i,\\alpha}$，我们可以利用这样一个性质：如果 $Z$ 是一个标准正态随机变量，$Z \\sim N(0,1)$，那么 $X = \\mu + \\sigma Z$ 就是一个正态随机变量 $X \\sim N(\\mu, \\sigma^2)$。在我们的情况下，$\\mu=0$ 且 $\\sigma_i = \\sqrt{k_B T / m_i}$。因此，一个 $v_{i,\\alpha}$ 的样本可以如下生成：\n$$\nv_{i,\\alpha} = \\sqrt{\\frac{k_B T}{m_i}} \\times Z_{i,\\alpha}\n$$\n其中每个 $Z_{i,\\alpha}$ 是从标准正态分布 $N(0,1)$ 中抽取的独立样本。在计算上，可以使用已有的算法（例如，Box-Muller 变换、Ziggurat 算法）高效地生成标准正态变量，这些算法在像 `numpy` 这样的数值库中随时可用。\n\n对一个包含 $N$ 个粒子、维度为 $d$ 的系统进行抽样的程序如下：\n1.  对于每个粒子 $i=1, \\dots, N$ 及其质量 $m_i$，计算其速度标准差 $\\sigma_i = \\sqrt{k_B T / m_i}$。\n2.  从标准正态分布 $N(0,1)$ 中生成一个 $N \\times d$ 的独立随机数矩阵。设该矩阵为 $\\mathbf{Z}$，其元素为 $Z_{i,\\alpha}$。\n3.  然后，通过将与粒子 $i$ 对应的每一行乘以其各自的 $\\sigma_i$ 来计算速度矩阵 $\\mathbf{V}$（其元素为 $v_{i,\\alpha}$）。在实践中，这可以通过将矩阵 $\\mathbf{Z}$ 与一个跨维度广播的标准差列向量进行逐元素相乘来完成。\n\n### 3. 算法设计：安德森恒温器\n\n安德森恒温器通过模拟与虚拟热浴的随机碰撞来维持系统温度。该过程被建模为每个粒子的一系列独立事件。\n- 在一个微小时间步 $\\Delta t$ 内，每个粒子都有概率 $p$ 发生一次“碰撞”。这些碰撞事件遵循一个给定速率为 $\\nu$ 的泊松过程。在 $\\Delta t$ 内发生至少一次碰撞的概率是 $p = 1 - \\exp(-\\nu \\Delta t)$。\n- 如果一个粒子被选中进行碰撞，其速度将被丢弃，并替换为从目标温度 $T$ 下的麦克斯韦-玻尔兹曼分布中抽取的新速度，使用上述抽样程序。\n- 如果一个粒子未被选中，其速度将根据系统动力学演化（在仅应用恒温器的背景下，这意味着其速度保持不变）。\n\n安德森恒温器算法的单步执行过程如下：\n1.  对于每个粒子 $i=1, \\dots, N$，从 $[0,1)$ 上的均匀分布中抽取一个随机数 $u_i$。\n2.  如果 $u_i  p$，其中 $p = 1 - \\exp(-\\nu \\Delta t)$，则粒子 $i$ 被标记为发生碰撞。\n3.  对于所有被标记的粒子，如第 2 节所述，从每个分量的麦克斯韦-玻尔兹曼分布 $N(0, k_B T / m_i)$ 中重新抽样其速度 $\\mathbf{v}_i = (v_{i,x}, v_{i,y}, v_{i,z})$。\n4.  未被标记的粒子的速度保持不变。\n\n### 4. 统计验证：方差的卡方检验\n\n为了验证抽样得到的速度是否正确服从麦克斯韦-玻尔兹曼统计，我们可以测试速度分量的方差是否与理论值 $\\sigma_i^2 = k_B T / m_i$ 相匹配。一个稳健的方法是进行卡方检验。\n\n首先，我们对抽样得到的速度分量进行标准化。标准化变量是通过减去均值并除以标准差得到的。对于一个速度分量 $v_{i,\\alpha}$，对应的标准化变量 $z_{i,\\alpha}$ 是：\n$$\nz_{i,\\alpha} = \\frac{v_{i,\\alpha} - \\mu_i}{\\sigma_i} = \\frac{v_{i,\\alpha} - 0}{\\sqrt{k_B T/m_i}} = v_{i,\\alpha} \\sqrt{\\frac{m_i}{k_B T}}\n$$\n在原假设（即 $v_{i,\\alpha}$ 正确地从 $N(0, k_B T / m_i)$ 中抽取）下，每个 $z_{i,\\alpha}$ 都是一个独立的标准正态随机变量，$z_{i,\\alpha} \\sim N(0,1)$。\n\n一个标准正态变量的平方 $z_{i,\\alpha}^2$ 服从自由度为 1 的卡方分布，即 $\\chi^2(1)$。$k$ 个独立的 $\\chi^2(1)$ 变量之和服从自由度为 $k$ 的卡方分布，即 $\\chi^2(k)$。我们可以通过对所有 $N$ 个粒子和所有 $d$ 个维度的标准化分量的平方求和，来构建一个检验统计量 $S$：\n$$\nS = \\sum_{i=1}^{N} \\sum_{\\alpha=1}^{d} z_{i,\\alpha}^{2}\n$$\n在原假设下，$S$ 服从自由度为 $df = N \\times d$ 的卡方分布。\n\n统计检验的执行步骤如下：\n1.  指定一个显著性水平 $\\alpha$（例如，$\\alpha=0.05$）。这代表了当原假设为真时拒绝它的概率（第一类错误）。\n2.  对于双边检验，我们找到包含 $\\chi^2(df)$ 概率质量中心 $1-\\alpha$ 部分的临界值。这些是概率为 $\\alpha/2$ 和 $1-\\alpha/2$ 时的分位数（或百分点函数）。设它们为 $C_{low} = \\chi^2_{df}(\\alpha/2)$ 和 $C_{high} = \\chi^2_{df}(1-\\alpha/2)$。\n3.  从速度样本中计算统计量 $S$。\n4.  如果 $S$ 落在接受域内：$C_{low} \\le S \\le C_{high}$，则接受原假设。否则，拒绝它。拒绝则意味着样本方差在统计上与理论方差有显著差异。\n\n这个验证程序非常强大，因为它将整个样本的信息汇总成一个其理论分布已知的单一统计量，从而允许进行严格的定量检查。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import chi2\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite for the Andersen thermostat simulation.\n    \"\"\"\n    \n    # Define physical constants\n    K_B = 1.380649e-23  # Boltzmann constant in J/K\n    U_TO_KG = 1.66053906660e-27  # Unified atomic mass unit to kg\n\n    def sample_maxwell_boltzmann(masses, T, d, rng):\n        \"\"\"\n        Samples velocities from the Maxwell-Boltzmann distribution.\n\n        Args:\n            masses (np.ndarray): Array of particle masses (kg), shape (N,).\n            T (float): Temperature (K).\n            d (int): Number of dimensions.\n            rng (np.random.Generator): NumPy random number generator.\n\n        Returns:\n            np.ndarray: Array of sampled velocities (m/s), shape (N, d).\n        \"\"\"\n        N = masses.shape[0]\n        # Calculate standard deviation for velocity for each particle\n        # sigma_i = sqrt(k_B * T / m_i)\n        # masses array has shape (N,), so need to reshape for broadcasting\n        sigma = np.sqrt(K_B * T / masses)\n        \n        # Generate standard normal random numbers\n        Z = rng.standard_normal(size=(N, d))\n        \n        # Scale by standard deviation. sigma has shape (N,), reshape to (N, 1)\n        # to broadcast across d dimensions.\n        velocities = Z * sigma[:, np.newaxis]\n        return velocities\n\n    def andersen_step(velocities, masses, T, nu, dt, d, rng):\n        \"\"\"\n        Performs a single step of the Andersen thermostat.\n\n        Args:\n            velocities (np.ndarray): Current velocities, shape (N, d).\n            masses (np.ndarray): Particle masses, shape (N,).\n            T (float): Temperature (K).\n            nu (float): Collision frequency (s^-1).\n            dt (float): Timestep (s).\n            d (int): Number of dimensions.\n            rng (np.random.Generator): NumPy random number generator.\n\n        Returns:\n            np.ndarray: Updated velocities after the thermostat step.\n        \"\"\"\n        N = masses.shape[0]\n        p_collision = 1.0 - np.exp(-nu * dt)\n        \n        # Determine which particles collide\n        collision_mask = rng.random(size=N)  p_collision\n        \n        num_collided = np.sum(collision_mask)\n        \n        if num_collided > 0:\n            # Get masses of particles that collide\n            collided_masses = masses[collision_mask]\n            \n            # Resample velocities for these particles\n            new_velocities = sample_maxwell_boltzmann(collided_masses, T, d, rng)\n            \n            # Update the velocities array\n            velocities[collision_mask] = new_velocities\n            \n        return velocities\n\n    def chi_square_variance_test(velocities, masses, T, alpha):\n        \"\"\"\n        Performs a chi-square test to verify the variance of velocity components.\n\n        Args:\n            velocities (np.ndarray): Sampled velocities, shape (N, d).\n            masses (np.ndarray): Particle masses, shape (N,).\n            T (float): Temperature (K).\n            alpha (float): Significance level for the test.\n\n        Returns:\n            bool: True if the test is accepted, False otherwise.\n        \"\"\"\n        N, d = velocities.shape\n        df = N * d\n        \n        # Standardize the velocity components\n        # z_i_alpha = v_i_alpha * sqrt(m_i / (k_B * T))\n        scaling_factors = np.sqrt(masses / (K_B * T))\n        z = velocities * scaling_factors[:, np.newaxis]\n        \n        # Calculate the chi-square statistic S\n        S = np.sum(z**2)\n        \n        # Determine the acceptance region from the chi-square distribution\n        lower_bound = chi2.ppf(alpha / 2, df)\n        upper_bound = chi2.ppf(1 - alpha / 2, df)\n        \n        return lower_bound = S = upper_bound\n\n    results = []\n    alpha = 0.05\n\n    # --- Test Case 1 ---\n    rng1 = np.random.default_rng(seed=1)\n    N1, d1, T1 = 2000, 3, 300.0\n    mass_options_u = np.array([28.0, 40.0, 84.0])\n    mass_options_kg = mass_options_u * U_TO_KG\n    masses1 = rng1.choice(mass_options_kg, size=N1)\n    velocities1 = sample_maxwell_boltzmann(masses1, T1, d1, rng1)\n    results.append(chi_square_variance_test(velocities1, masses1, T1, alpha))\n\n    # --- Test Case 2 ---\n    rng2 = np.random.default_rng(seed=2)\n    N2, d2, T2 = 90, 3, 1000.0\n    masses_u2 = np.linspace(1.0, 100.0, N2)\n    masses2 = masses_u2 * U_TO_KG\n    velocities2 = sample_maxwell_boltzmann(masses2, T2, d2, rng2)\n    results.append(chi_square_variance_test(velocities2, masses2, T2, alpha))\n\n    # --- Test Case 3 ---\n    rng3 = np.random.default_rng(seed=3)\n    N3, d3, T3 = 1000, 3, 500.0\n    masses_u3 = rng3.uniform(10.0, 50.0, size=N3)\n    masses3 = masses_u3 * U_TO_KG\n    velocities3 = np.zeros((N3, d3))  # Initialize at rest\n    nu3, dt3 = 2e14, 1e-15\n    num_steps = 100\n    for _ in range(num_steps):\n        velocities3 = andersen_step(velocities3, masses3, T3, nu3, dt3, d3, rng3)\n    results.append(chi_square_variance_test(velocities3, masses3, T3, alpha))\n\n    # --- Test Case 4 (Negative Control) ---\n    rng4 = np.random.default_rng(seed=4)\n    N4, d4, T4 = 1500, 2, 400.0\n    mass4_u = 20.0\n    masses4 = np.full(N4, mass4_u * U_TO_KG)\n    velocities4_correct = sample_maxwell_boltzmann(masses4, T4, d4, rng4)\n    velocities4_incorrect = velocities4_correct * 1.5\n    results.append(chi_square_variance_test(velocities4_incorrect, masses4, T4, alpha))\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3395469"}, {"introduction": "在掌握了安德森恒温器的基本实现和理论影响后，我们将把它应用到一个更高级的场景：非平衡分子动力学（NEMD）。本练习模拟了剪切流中的稀薄气体，并使用安德森恒温器来控制温度，您的任务是推导并计算系统的应力张量，如剪切应力和法向应力差。通过将结果与另一种流行的恒温器（朗之万恒温器）进行比较，本练习旨在揭示一个深刻的观点：恒温器的选择并非无足轻重，它会直接影响到从模拟中测得的宏观物理性质。[@problem_id:3395499]", "problem": "考虑一个均匀剪切流，该流由用于描述二维空间 $\\{x,y\\}$ 中相同质点（质量为 $m$）组成的稀疏、无相互作用气体的流动纵向和横向 (SLLOD) 方程所描述。施加的流速为 $u(y) = \\dot{\\gamma} y \\hat{\\mathbf{x}}$，其中 $\\dot{\\gamma}$ 是恒定的剪切速率。用 $\\mathbf{c} = \\mathbf{v} - \\mathbf{u}(\\mathbf{r})$ 表示粒子的特异速度，其中 $\\mathbf{v}$ 是实验室参考系速度，$\\mathbf{r}$ 是位置。对于无相互作用的粒子，在两次恒温器作用事件之间，特异速度的 SLLOD 演化方程为\n$$\n\\dot{c}_x = - \\dot{\\gamma} c_y, \\quad \\dot{c}_y = 0,\n$$\n这是由剪切场引起的运动学耦合。\n\n考虑使用两种不同的恒温器来维持国际单位制 (SI) 中的目标绝对温度 $T$：\n\n1. Andersen 随机恒温器：每个粒子都经历随机碰撞，该过程被建模为泊松过程，每个粒子的碰撞频率为 $\\nu$。在每次碰撞时，粒子的特异速度 $\\mathbf{c}$ 会从温度为 $T$ 的麦克斯韦-玻尔兹曼分布中瞬时重新采样，且与其碰撞前的值无关。\n\n2. 朗之万恒温器：特异速度服从一个 Ornstein–Uhlenbeck 型随机微分方程，该方程具有线性摩擦系数 $\\gamma$ 和与温度 $T$ 下的涨落-耗散关系一致的高斯白噪声，\n$$\n\\dot{\\mathbf{c}} = - \\gamma \\mathbf{c} - \\dot{\\gamma} c_y \\hat{\\mathbf{x}} + \\boldsymbol{\\xi}(t),\n$$\n其中 $\\boldsymbol{\\xi}(t)$ 的分量是独立的、零均值的高斯白噪声，每个分量的协方差为 $2 \\gamma (k_{\\mathrm{B}} T/m) \\delta(t-t')$，$k_{\\mathrm{B}}$ 是玻尔兹曼常数。\n\n令 $n$ 表示数密度（在二维中是单位面积的数量，但为本问题目的，将 $n$ 视作单位体积的数量，并以帕斯卡为单位报告应力，与 SI 单位保持一致），令 $\\boldsymbol{\\sigma}$ 表示柯西应力张量。对于这个无相互作用的系统，Irving–Kirkwood 动力学表达式给出的应力张量为\n$$\n\\boldsymbol{\\sigma} = - n m \\langle \\mathbf{c} \\mathbf{c} \\rangle,\n$$\n因此，剪切应力为 $ \\sigma_{xy} = - n m \\langle c_x c_y \\rangle$，第一法向应力差为 $N_1 = \\sigma_{xx} - \\sigma_{yy} = - n m \\left( \\langle c_x^2 \\rangle - \\langle c_y^2 \\rangle \\right)$。\n\n任务：\n\na) 从牛顿定律和上述特异速度的 SLLOD 演化方程出发，结合恒温器的定义，为每种恒温器推导二阶矩 $\\langle c_y^2 \\rangle$、$\\langle c_x c_y \\rangle$ 和 $\\langle c_x^2 \\rangle$ 的闭式线性常微分方程。对于 Andersen 恒温器，将碰撞效应建模为矩以速率 $\\nu$ 向其平衡麦克斯韦-玻尔兹曼值的弛豫过程。对于朗之万恒温器，使用 Ornstein–Uhlenbeck 过程的性质和涨落-耗散关系，写出包含摩擦和噪声的矩的演化方程。\n\nb) 求解这些矩方程的稳态值（时间导数等于零）。将稳态剪切应力 $\\sigma_{xy}$ 和第一法向应力差 $N_1$ 明确地表示为 $n$、$m$、$k_{\\mathrm{B}}$、$T$、$\\dot{\\gamma}$ 以及各自恒温器参数（Andersen 为 $\\nu$，朗之万为 $\\gamma$）的函数。所有代数推导必须基于上述基本定义，不应在没有证明的情况下引用简便公式。\n\nc) 使用推导出的稳态公式，编写一个完整的程序，为下面测试套件中的每一组参数计算以下四个量：\n- Andersen 剪切应力 $\\sigma_{xy}^{\\mathrm{A}}$（单位：帕斯卡），\n- 朗之万剪切应力 $\\sigma_{xy}^{\\mathrm{L}}$（单位：帕斯卡），\n- Andersen 第一法向应力差 $N_1^{\\mathrm{A}}$（单位：帕斯卡），\n- 朗之万第一法向应力差 $N_1^{\\mathrm{L}}$（单位：帕斯卡）。\n\n在比较中，假设朗之万恒温器的 $\\gamma = \\nu$。\n\n物理常数和单位：\n- 使用 $k_{\\mathrm{B}} = 1.380649 \\times 10^{-23} \\ \\mathrm{J/K}$。\n- 所有应力值以帕斯卡 (Pa) 为单位报告。\n- 剪切速率 $\\dot{\\gamma}$、碰撞频率 $\\nu$ 和摩擦系数 $\\gamma$ 的单位为 $\\mathrm{s}^{-1}$。\n- 质量 $m$ 的单位为 $\\mathrm{kg}$，温度 $T$ 的单位为 $\\mathrm{K}$，数密度 $n$ 的单位为 $\\mathrm{m}^{-3}$。\n\n测试套件（每个测试用例是一个元组 $(m, T, n, \\dot{\\gamma}, \\nu)$，其中 $\\gamma = \\nu$）：\n1. $(4.0 \\times 10^{-26}, \\ 300, \\ 1.0 \\times 10^{26}, \\ 1.0 \\times 10^{12}, \\ 1.0 \\times 10^{12})$。\n2. $(4.0 \\times 10^{-26}, \\ 300, \\ 1.0 \\times 10^{26}, \\ 1.0 \\times 10^{12}, \\ 5.0 \\times 10^{11})$。\n3. $(4.0 \\times 10^{-26}, \\ 300, \\ 1.0 \\times 10^{26}, \\ 1.0 \\times 10^{12}, \\ 2.0 \\times 10^{12})$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含所有测试用例的结果，形式为一个包含在方括号内的逗号分隔列表。对于每个测试用例，按上述顺序输出四个值，并将它们在整个测试套件中聚合。例如，输出应如下所示：\n$[\\sigma_{xy}^{\\mathrm{A}}(1),\\sigma_{xy}^{\\mathrm{L}}(1),N_1^{\\mathrm{A}}(1),N_1^{\\mathrm{L}}(1),\\sigma_{xy}^{\\mathrm{A}}(2),\\ldots, N_1^{\\mathrm{L}}(3)]$，\n其中每个条目都是一个以帕斯卡为单位的浮点数。", "solution": "问题陈述已经过严格验证，被认为是科学上合理、适定、自洽且可通过算法求解的。所有提供的定义、模型和参数都与非平衡统计力学和分子动力学的既定原理一致。因此，我们可以进行形式化的推导和求解。\n\n任务是推导并求解在两种不同恒温器（Andersen 随机恒温器和朗之万恒温器）影响下，受剪切稀疏气体的特异速度二阶矩 $\\langle c_x^2 \\rangle$、$\\langle c_y^2 \\rangle$ 和 $\\langle c_x c_y \\rangle$ 的稳态方程。从这些矩中，将计算剪切应力 $\\sigma_{xy}$ 和第一法向应力差 $N_1$。\n\n令 $v_T^2 = k_{\\mathrm{B}} T / m$ 表示热力学平衡时的均方速度分量。在二维空间中，温度为 $T$ 的麦克斯韦-玻尔兹曼分布给出 $\\langle c_x^2 \\rangle_{MB} = \\langle c_y^2 \\rangle_{MB} = v_T^2$ 和 $\\langle c_x c_y \\rangle_{MB} = 0$。\n\n### **a) 矩方程的推导**\n\n依赖于速度的量 $A(\\mathbf{c})$ 的系综平均值的时间演化由确定性剪切流 (SLLOD 动力学) 和随机恒温过程的贡献之和给出：\n$$\n\\frac{d}{dt}\\langle A \\rangle = \\left\\langle \\frac{dA}{dt} \\right\\rangle_{\\text{SLLOD}} + \\left\\langle \\frac{dA}{dt} \\right\\rangle_{\\text{Thermostat}}\n$$\n\n**SLLOD 贡献**\n\n特异速度分量的 SLLOD 方程为 $\\dot{c}_x = -\\dot{\\gamma} c_y$ 和 $\\dot{c}_y = 0$。由此流动对二阶矩变化率的贡献可通过链式法则求得。\n\n对于 $\\langle c_y^2 \\rangle$：\n$$\n\\left\\langle \\frac{d(c_y^2)}{dt} \\right\\rangle_{\\text{SLLOD}} = \\langle 2 c_y \\dot{c}_y \\rangle = \\langle 2 c_y (0) \\rangle = 0\n$$\n\n对于 $\\langle c_x c_y \\rangle$：\n$$\n\\left\\langle \\frac{d(c_x c_y)}{dt} \\right\\rangle_{\\text{SLLOD}} = \\langle \\dot{c}_x c_y + c_x \\dot{c}_y \\rangle = \\langle (-\\dot{\\gamma} c_y) c_y + c_x (0) \\rangle = -\\dot{\\gamma} \\langle c_y^2 \\rangle\n$$\n\n对于 $\\langle c_x^2 \\rangle$：\n$$\n\\left\\langle \\frac{d(c_x^2)}{dt} \\right\\rangle_{\\text{SLLOD}} = \\langle 2 c_x \\dot{c}_x \\rangle = \\langle 2 c_x (-\\dot{\\gamma} c_y) \\rangle = -2\\dot{\\gamma} \\langle c_x c_y \\rangle\n$$\n\n这些 SLLOD 贡献对于两种恒温器情况是共同的。\n\n**Andersen 恒温器**\n\nAndersen 恒温器以速率 $\\nu$ 通过从麦克斯韦-玻尔兹曼分布中抽取新速度来重置粒子的速度。这个过程以特征时间常数 $1/\\nu$ 驱动每个矩趋向其平衡值。对平均量 $\\langle A \\rangle$ 变化率的影响被建模为一个弛豫过程：\n$$\n\\left\\langle \\frac{dA}{dt} \\right\\rangle_{\\text{Andersen}} = -\\nu (\\langle A \\rangle - \\langle A \\rangle_{MB})\n$$\n\n将此应用于我们的二阶矩：\n-   对于 $\\langle c_y^2 \\rangle$：恒温器项是 $-\\nu (\\langle c_y^2 \\rangle - v_T^2)$。\n-   对于 $\\langle c_x c_y \\rangle$：恒温器项是 $-\\nu (\\langle c_x c_y \\rangle - 0) = -\\nu \\langle c_x c_y \\rangle$。\n-   对于 $\\langle c_x^2 \\rangle$：恒温器项是 $-\\nu (\\langle c_x^2 \\rangle - v_T^2)$。\n\n结合 SLLOD 的贡献，我们得到 Andersen 恒温器的一组耦合常微分方程：\n$$\n\\frac{d}{dt}\\langle c_y^2 \\rangle = -\\nu (\\langle c_y^2 \\rangle - v_T^2)\n$$\n$$\n\\frac{d}{dt}\\langle c_x c_y \\rangle = -\\dot{\\gamma} \\langle c_y^2 \\rangle - \\nu \\langle c_x c_y \\rangle\n$$\n$$\n\\frac{d}{dt}\\langle c_x^2 \\rangle = -2\\dot{\\gamma} \\langle c_x c_y \\rangle - \\nu (\\langle c_x^2 \\rangle - v_T^2)\n$$\n\n**朗之万恒温器**\n\n朗之万动力学由以下随机微分方程描述：\n$$\n\\dot{\\mathbf{c}} = - \\gamma \\mathbf{c} - \\dot{\\gamma} c_y \\hat{\\mathbf{x}} + \\boldsymbol{\\xi}(t)\n$$\n或以分量形式表示：\n$$\n\\dot{c}_x = -\\gamma c_x - \\dot{\\gamma} c_y + \\xi_x(t)\n$$\n$$\n\\dot{c}_y = -\\gamma c_y + \\xi_y(t)\n$$\n噪声项具有性质 $\\langle\\xi_i(t)\\rangle=0$ 和 $\\langle\\xi_i(t)\\xi_j(t')\\rangle = 2D_{ij}\\delta(t-t')$，其中扩散张量为 $D_{ij} = \\gamma (k_{\\mathrm{B}} T/m) \\delta_{ij} = \\gamma v_T^2 \\delta_{ij}$。\n\n任意函数 $f(\\mathbf{c})$ 的时间演化由 Fokker-Planck 算子 $\\mathcal{L}$ 控制。对于一个过程 $d\\mathbf{c} = \\mathbf{A}(\\mathbf{c})dt + \\mathbf{B}d\\mathbf{W}_t$，其中 $(\\mathbf{B}\\mathbf{B}^T)_{ij} = 2D_{ij}$，平均值的演化为 $\\frac{d}{dt}\\langle f \\rangle = \\langle \\mathcal{L}f \\rangle$，其中 $\\mathcal{L}f = \\sum_i A_i \\frac{\\partial f}{\\partial c_i} + \\sum_{ij} D_{ij} \\frac{\\partial^2 f}{\\partial c_i \\partial c_j}$。\n\n-   对于 $f=c_y^2$：$\\frac{\\partial f}{\\partial c_y} = 2c_y$，$\\frac{\\partial^2 f}{\\partial c_y^2} = 2$。\n    $\\mathcal{L}c_y^2 = (-\\gamma c_y)(2c_y) + D_{yy}(2) = -2\\gamma c_y^2 + 2\\gamma v_T^2$。\n    $\\frac{d}{dt}\\langle c_y^2 \\rangle = -2\\gamma \\langle c_y^2 \\rangle + 2\\gamma v_T^2$。\n\n-   对于 $f=c_x c_y$：$\\frac{\\partial f}{\\partial c_x} = c_y$，$\\frac{\\partial f}{\\partial c_y} = c_x$。由于 $D_{ij}$ 是对角矩阵，所有二阶混合偏导数项为零。\n    $\\mathcal{L}(c_x c_y) = (-\\gamma c_x - \\dot{\\gamma} c_y)(c_y) + (-\\gamma c_y)(c_x) = -2\\gamma c_x c_y - \\dot{\\gamma} c_y^2$。\n    $\\frac{d}{dt}\\langle c_x c_y \\rangle = -2\\gamma \\langle c_x c_y \\rangle - \\dot{\\gamma} \\langle c_y^2 \\rangle$。\n\n-   对于 $f=c_x^2$：$\\frac{\\partial f}{\\partial c_x} = 2c_x$，$\\frac{\\partial^2 f}{\\partial c_x^2} = 2$。\n    $\\mathcal{L}c_x^2 = (-\\gamma c_x - \\dot{\\gamma} c_y)(2c_x) + D_{xx}(2) = -2\\gamma c_x^2 - 2\\dot{\\gamma} c_x c_y + 2\\gamma v_T^2$。\n    $\\frac{d}{dt}\\langle c_x^2 \\rangle = -2\\gamma \\langle c_x^2 \\rangle - 2\\dot{\\gamma} \\langle c_x c_y \\rangle + 2\\gamma v_T^2$。\n\n朗之万恒温器的常微分方程组为：\n$$\n\\frac{d}{dt}\\langle c_y^2 \\rangle = -2\\gamma \\langle c_y^2 \\rangle + 2\\gamma v_T^2\n$$\n$$\n\\frac{d}{dt}\\langle c_x c_y \\rangle = -2\\gamma \\langle c_x c_y \\rangle - \\dot{\\gamma} \\langle c_y^2 \\rangle\n$$\n$$\n\\frac{d}{dt}\\langle c_x^2 \\rangle = -2\\gamma \\langle c_x^2 \\rangle - 2\\dot{\\gamma} \\langle c_x c_y \\rangle + 2\\gamma v_T^2\n$$\n\n### **b) 稳态解与应力计算**\n\n在稳态下，所有时间导数均为零。\n\n**Andersen 恒温器**\n\n将时间导数设为零：\n1.  $0 = -\\nu(\\langle c_y^2 \\rangle - v_T^2) \\implies \\langle c_y^2 \\rangle = v_T^2 = \\frac{k_{\\mathrm{B}} T}{m}$。\n2.  $0 = -\\dot{\\gamma} \\langle c_y^2 \\rangle - \\nu \\langle c_x c_y \\rangle \\implies \\langle c_x c_y \\rangle = -\\frac{\\dot{\\gamma}}{\\nu} \\langle c_y^2 \\rangle = -\\frac{\\dot{\\gamma}}{\\nu} \\frac{k_{\\mathrm{B}} T}{m}$。\n3.  $0 = -2\\dot{\\gamma} \\langle c_x c_y \\rangle - \\nu (\\langle c_x^2 \\rangle - v_T^2) \\implies \\langle c_x^2 \\rangle = v_T^2 - \\frac{2\\dot{\\gamma}}{\\nu} \\langle c_x c_y \\rangle$。\n    代入 $\\langle c_x c_y \\rangle$：\n    $\\langle c_x^2 \\rangle = \\frac{k_{\\mathrm{B}} T}{m} - \\frac{2\\dot{\\gamma}}{\\nu} \\left( -\\frac{\\dot{\\gamma}}{\\nu} \\frac{k_{\\mathrm{B}} T}{m} \\right) = \\left( 1 + \\frac{2\\dot{\\gamma}^2}{\\nu^2} \\right) \\frac{k_{\\mathrm{B}} T}{m}$。\n\n应力分量为：\n-   剪切应力：$\\sigma_{xy}^{\\mathrm{A}} = -nm \\langle c_x c_y \\rangle = -nm \\left( -\\frac{\\dot{\\gamma}}{\\nu} \\frac{k_{\\mathrm{B}} T}{m} \\right) = n k_{\\mathrm{B}} T \\frac{\\dot{\\gamma}}{\\nu}$。\n-   第一法向应力差：$N_1^{\\mathrm{A}} = \\sigma_{xx} - \\sigma_{yy} = -nm(\\langle c_x^2 \\rangle - \\langle c_y^2 \\rangle)$。\n    $N_1^{\\mathrm{A}} = -nm \\left[ \\left( 1 + \\frac{2\\dot{\\gamma}^2}{\\nu^2} \\right) \\frac{k_{\\mathrm{B}} T}{m} - \\frac{k_{\\mathrm{B}} T}{m} \\right] = -nm \\left( \\frac{2\\dot{\\gamma}^2}{\\nu^2} \\frac{k_{\\mathrm{B}} T}{m} \\right) = -2 n k_{\\mathrm{B}} T \\left(\\frac{\\dot{\\gamma}}{\\nu}\\right)^2$。\n\n**朗之万恒温器**\n\n将时间导数设为零，并为进行比较，假设 $\\gamma = \\nu$：\n1.  $0 = -2\\gamma \\langle c_y^2 \\rangle + 2\\gamma v_T^2 \\implies \\langle c_y^2 \\rangle = v_T^2 = \\frac{k_{\\mathrm{B}} T}{m}$。\n2.  $0 = -2\\gamma \\langle c_x c_y \\rangle - \\dot{\\gamma} \\langle c_y^2 \\rangle \\implies \\langle c_x c_y \\rangle = -\\frac{\\dot{\\gamma}}{2\\gamma} \\langle c_y^2 \\rangle = -\\frac{\\dot{\\gamma}}{2\\gamma} \\frac{k_{\\mathrm{B}} T}{m}$。\n3.  $0 = -2\\gamma \\langle c_x^2 \\rangle - 2\\dot{\\gamma} \\langle c_x c_y \\rangle + 2\\gamma v_T^2 \\implies \\langle c_x^2 \\rangle = v_T^2 - \\frac{\\dot{\\gamma}}{\\gamma} \\langle c_x c_y \\rangle$。\n    代入 $\\langle c_x c_y \\rangle$：\n    $\\langle c_x^2 \\rangle = \\frac{k_{\\mathrm{B}} T}{m} - \\frac{\\dot{\\gamma}}{\\gamma} \\left( -\\frac{\\dot{\\gamma}}{2\\gamma} \\frac{k_{\\mathrm{B}} T}{m} \\right) = \\left( 1 + \\frac{\\dot{\\gamma}^2}{2\\gamma^2} \\right) \\frac{k_{\\mathrm{B}} T}{m}$。\n\n应力分量为：\n-   剪切应力：$\\sigma_{xy}^{\\mathrm{L}} = -nm \\langle c_x c_y \\rangle = -nm \\left( -\\frac{\\dot{\\gamma}}{2\\gamma} \\frac{k_{\\mathrm{B}} T}{m} \\right) = \\frac{1}{2} n k_{\\mathrm{B}} T \\frac{\\dot{\\gamma}}{\\gamma}$。\n-   第一法向应力差：$N_1^{\\mathrm{L}} = -nm(\\langle c_x^2 \\rangle - \\langle c_y^2 \\rangle)$。\n    $N_1^{\\mathrm{L}} = -nm \\left[ \\left( 1 + \\frac{\\dot{\\gamma}^2}{2\\gamma^2} \\right) \\frac{k_{\\mathrm{B}} T}{m} - \\frac{k_{\\mathrm{B}} T}{m} \\right] = -nm \\left( \\frac{\\dot{\\gamma}^2}{2\\gamma^2} \\frac{k_{\\mathrm{B}} T}{m} \\right) = -\\frac{1}{2} n k_{\\mathrm{B}} T \\left(\\frac{\\dot{\\gamma}}{\\gamma}\\right)^2$。\n\n### **c) 计算公式**\n\n以下公式将在程序中实现，其中 $\\gamma = \\nu$。\n\n-   Andersen 剪切应力：$\\sigma_{xy}^{\\mathrm{A}} = n k_{\\mathrm{B}} T \\frac{\\dot{\\gamma}}{\\nu}$\n-   朗之万剪切应力：$\\sigma_{xy}^{\\mathrm{L}} = \\frac{1}{2} n k_{\\mathrm{B}} T \\frac{\\dot{\\gamma}}{\\gamma}$\n-   Andersen 第一法向应力差：$N_1^{\\mathrm{A}} = -2 n k_{\\mathrm{B}} T \\left(\\frac{\\dot{\\gamma}}{\\nu}\\right)^2$\n-   朗之万第一法向应力差：$N_1^{\\mathrm{L}} = -\\frac{1}{2} n k_{\\mathrm{B}} T \\left(\\frac{\\dot{\\gamma}}{\\gamma}\\right)^2$", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the steady-state shear stress and first normal stress difference\n    for a sheared dilute gas using Andersen and Langevin thermostats.\n    \"\"\"\n    # Physical constants\n    K_B = 1.380649e-23  # Boltzmann constant in J/K\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple (m, T, n, dot_gamma, nu)\n    # where m is mass (kg), T is temperature (K), n is number density (m^-3),\n    # dot_gamma is shear rate (s^-1), and nu is Andersen collision frequency (s^-1).\n    # The Langevin friction coefficient gamma is set equal to nu.\n    test_cases = [\n        (4.0e-26, 300.0, 1.0e26, 1.0e12, 1.0e12),\n        (4.0e-26, 300.0, 1.0e26, 1.0e12, 5.0e11),\n        (4.0e-26, 300.0, 1.0e26, 1.0e12, 2.0e12),\n    ]\n\n    results = []\n    for case in test_cases:\n        m, T, n, dot_gamma, nu = case\n        gamma = nu  # Langevin friction coefficient is set equal to Andersen frequency\n\n        # Common factor n * k_B * T\n        common_factor = n * K_B * T\n\n        # --- Andersen Thermostat Calculations ---\n        \n        # Ratio of shear rate to collision frequency\n        ratio_A = dot_gamma / nu\n        \n        # Andersen shear stress (Pa)\n        # Formula: sigma_xy^A = n * k_B * T * (dot_gamma / nu)\n        sigma_xy_A = common_factor * ratio_A\n        \n        # Andersen first normal stress difference (Pa)\n        # Formula: N1^A = -2 * n * k_B * T * (dot_gamma / nu)^2\n        N1_A = -2.0 * common_factor * (ratio_A**2)\n\n        # --- Langevin Thermostat Calculations ---\n        \n        # Ratio of shear rate to friction coefficient\n        ratio_L = dot_gamma / gamma\n\n        # Langevin shear stress (Pa)\n        # Formula: sigma_xy^L = (1/2) * n * k_B * T * (dot_gamma / gamma)\n        sigma_xy_L = 0.5 * common_factor * ratio_L\n\n        # Langevin first normal stress difference (Pa)\n        # Formula: N1^L = -(1/2) * n * k_B * T * (dot_gamma / gamma)^2\n        N1_L = -0.5 * common_factor * (ratio_L**2)\n\n        # Append results for the current test case\n        results.extend([sigma_xy_A, sigma_xy_L, N1_A, N1_L])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3395497"}, {"introduction": "安德森恒温器通过随机碰撞来维持系统温度，但这不可避免地会干扰系统内在的动力学行为。本练习将通过一个经典的理论模型——与安德森恒温器耦合的一维谐振子——来深入探究这种影响。通过推导并求解速度自相关函数（VACF）的运动方程，您将亲身体会到恒温器的碰撞频率如何改变系统的动力学特性，例如引入阻尼并影响振动模式。[@problem_id:3395497]", "problem": "考虑一个质量为 $m$、角频率为 $\\omega$ 的一维谐振子，耦合到绝对温度为 $T$ 的 Andersen 随机恒温器。在 Andersen 方案中，碰撞以速率为 $\\nu$ 的泊松过程发生，每次碰撞时，瞬时速度被替换为从温度为 $T$ 的麦克斯韦-玻尔兹曼分布中独立抽取的一个值；碰撞不影响位置。在碰撞之间，动力学遵循牛顿方程 $\\dot{x}=v$ 和 $\\dot{v}=-\\omega^{2}x$。设系统初始时从温度为 $T$ 的正则系综平衡分布中抽样。定义速度自相关函数 (VACF) 为 $C_{vv}(t) \\equiv \\langle v(t)\\,v(0)\\rangle$，其中尖括号表示系综平衡平均。仅从碰撞间的牛顿方程、泊松碰撞过程的更新性质以及谐振子在正则系综平衡下 $x$ 和 $v$ 的可因子化性质出发，推导一个关于 $C_{vv}(t)$ 的封闭常微分方程，并用物理上正确的初始条件求解该方程，以获得一个对所有非负实数 $\\nu$ 和 $\\omega$ 都有效的 $C_{vv}(t)$ 的显式表达式。此外，从第一性原理出发，确定 VACF 随时间表现出阻尼振荡的参数区域，并用一个包含 $\\nu$ 和 $\\omega$ 的不等式表示。将您的最终答案表示为仅包含 $t$、$\\omega$、$\\nu$、$m$、$k_B$ 和 $T$ 的单个解析表达式。最终答案中不要包含任何不等式。", "solution": "在尝试求解之前，对问题陈述进行严格验证。\n\n### 第1步：提取已知条件\n- **系统**：一维谐振子。\n- **参数**：质量 $m$，角频率 $\\omega$。\n- **恒温器**：温度为 $T$ 的 Andersen 随机恒温器。\n- **碰撞动力学**：碰撞是以速率为 $\\nu$ 的泊松过程。每次碰撞时，速度被替换为从温度为 $T$ 的麦克斯韦-玻尔兹曼分布中抽取的值。位置不受影响。\n- **碰撞间动力学**：在碰撞之间，系统通过牛顿方程演化：$\\dot{x}=v$ 和 $\\dot{v}=-\\omega^{2}x$。\n- **初始条件**：系统初始时从温度为 $T$ 的正则系综平衡分布中抽样。\n- **待计算量**：速度自相关函数 (VACF)，定义为 $C_{vv}(t) \\equiv \\langle v(t)\\,v(0)\\rangle$，其中 $\\langle \\dots \\rangle$ 表示系综平衡平均。\n- **任务**：\n  1. 推导一个关于 $C_{vv}(t)$ 的封闭常微分方程。\n  2. 求解该常微分方程，找到一个对所有非负实数 $\\nu$ 和 $\\omega$ 都有效的 $C_{vv}(t)$ 的显式表达式。\n  3. 确定 VACF 表现出阻尼振荡的参数区域。\n- **最终答案要求**：一个仅用 $t$、$\\omega$、$\\nu$、$m$、$k_B$ 和 $T$ 表示的 $C_{vv}(t)$ 的单一解析表达式。\n\n### 第2步：使用提取的已知条件进行验证\n- **科学依据**：该问题描述了一个与 Andersen 恒温器耦合的谐振子，这是统计力学和分子动力学模拟中研究正则系综动力学的一个标准且成熟的模型。其基本原理（牛顿力学、泊松过程、麦克斯韦-玻尔兹曼统计）是物理学的基础。该设定是科学合理的。\n- **适定性**：该问题定义清晰，包含所有必要的参数（$m, \\omega, T, \\nu$）和初始条件（正则系综平衡）。目标是为一个定义明确的物理量——VACF——推导并求解一个微分方程。预期存在一个唯一且有意义的解。\n- **客观性**：问题陈述使用了精确、客观和正式的科学语言。它没有歧义、主观性或非科学的主张。\n- **完整性和一致性**：该问题提供了一套自洽且一致的条件。对 Andersen 恒温器动力学和系统初始状态的描述足以进行推导。\n\n### 第3步：结论与行动\n该问题被判定为**有效**。它是科学合理的、适定的、客观的和自洽的。现在可以开始求解过程。\n\n### 控制方程的推导\n速度自相关函数 (VACF) 定义为 $C_{vv}(t) = \\langle v(t)v(0) \\rangle$。我们将通过考虑其在无穷小时间间隔 $dt$ 内的演化来推导 $C_{vv}(t)$ 的微分方程。\n\n速度 $v(t)$ 的时间演化由一种混合动力学控制。在任何区间 $[t, t+dt]$ 内，发生碰撞的概率为 $\\nu dt$，不发生碰撞的概率为 $1-\\nu dt$。\n\n我们来计算 $C_{vv}(t+dt)$：\n$C_{vv}(t+dt) = \\langle v(t+dt)v(0) \\rangle$\n我们通过对 $[t, t+dt]$ 内是否发生碰撞进行条件化来计算期望值。\n$v(t+dt) =\n\\begin{cases}\nv(t) + \\dot{v}(t)dt + O(dt^2)  \\text{概率为 } 1-\\nu dt \\quad (\\text{无碰撞}) \\\\\nv'  \\text{概率为 } \\nu dt \\quad (\\text{碰撞})\n\\end{cases}$\n此处，$v'$ 是从温度为 $T$ 的麦克斯韦-玻尔兹曼分布中抽样得到的新速度。该分布是对称的，因此其均值为零，$\\langle v' \\rangle = 0$。关键在于，$v'$ 独立于系统的历史，包括 $v(0)$。\n\n期望值是这两种可能性的贡献之和：\n$\\langle v(t+dt)v(0) \\rangle = (1-\\nu dt) \\langle (v(t)+\\dot{v}(t)dt)v(0) \\rangle + \\nu dt \\langle v'v(0) \\rangle$\n利用 $v'$ 和 $v(0)$ 的独立性，我们有 $\\langle v'v(0) \\rangle = \\langle v' \\rangle \\langle v(0) \\rangle = 0$。\n因此，舍去 $dt^2$ 及更高阶的项：\n$C_{vv}(t+dt) = (1-\\nu dt) (\\langle v(t)v(0) \\rangle + \\langle \\dot{v}(t)v(0) \\rangle dt) = C_{vv}(t) - \\nu C_{vv}(t)dt + \\langle \\dot{v}(t)v(0) \\rangle dt$\n整理并取极限 $dt \\to 0$：\n$\\frac{dC_{vv}}{dt} = \\lim_{dt\\to 0} \\frac{C_{vv}(t+dt)-C_{vv}(t)}{dt} = -\\nu C_{vv}(t) + \\langle \\dot{v}(t)v(0) \\rangle$\n\n我们定义一个互相关函数 $C_{\\dot{v}v}(t) = \\langle \\dot{v}(t)v(0) \\rangle$。方程变为：\n$$ \\frac{dC_{vv}(t)}{dt} = -\\nu C_{vv}(t) + C_{\\dot{v}v}(t) \\quad (*)$$\n\n为了封闭该系统，我们需要一个关于 $C_{\\dot{v}v}(t)$ 时间演化的方程。\n$C_{\\dot{v}v}(t) = \\langle \\dot{v}(t)v(0) \\rangle = \\langle (-\\omega^2 x(t)) v(0) \\rangle = -\\omega^2 \\langle x(t)v(0) \\rangle = -\\omega^2 C_{xv}(t)$\n现在我们来求 $C_{\\dot{v}v}(t)$ 的导数：\n$\\frac{dC_{\\dot{v}v}(t)}{dt} = -\\omega^2 \\frac{dC_{xv}(t)}{dt} = -\\omega^2 \\frac{d}{dt}\\langle x(t)v(0) \\rangle$\n\n位置 $x(t)$ 是连续的。其时间演化总是由 $\\dot{x}(t)=v(t)$ 给出，与碰撞无关（碰撞只不连续地影响 $v$ 而不改变 $x$）。因此，\n$\\frac{d}{dt}\\langle x(t)v(0) \\rangle = \\langle \\dot{x}(t)v(0) \\rangle = \\langle v(t)v(0) \\rangle = C_{vv}(t)$\n因此，我们得到第二个方程：\n$$ \\frac{dC_{\\dot{v}v}(t)}{dt} = -\\omega^2 C_{vv}(t) \\quad (**) $$\n\n现在我们有一个由两个线性一阶常微分方程组成的封闭系统。我们可以将它们合并为关于 $C_{vv}(t)$ 的单个二阶常微分方程。对等式 $(*)$ 对 $t$ 求导：\n$\\frac{d^2C_{vv}(t)}{dt^2} = -\\nu \\frac{dC_{vv}(t)}{dt} + \\frac{dC_{\\dot{v}v}(t)}{dt}$\n将等式 $(**)$ 代入可得：\n$\\frac{d^2C_{vv}(t)}{dt^2} = -\\nu \\frac{dC_{vv}(t)}{dt} - \\omega^2 C_{vv}(t)$\n\n这就是所求的 VACF 的封闭常微分方程：\n$$ \\frac{d^2C_{vv}(t)}{dt^2} + \\nu \\frac{dC_{vv}(t)}{dt} + \\omega^2 C_{vv}(t) = 0 $$\n\n### 初始条件\n为了求解这个常微分方程，我们需要两个初始条件，$C_{vv}(0)$ 和 $\\dot{C}_{vv}(0)$。\n1.  $C_{vv}(0) = \\langle v(0)^2 \\rangle$。系统处于温度为 $T$ 的正则系综平衡状态。能量均分定理指出，哈密顿量中每个二次自由度对平均能量的贡献为 $\\frac{1}{2} k_B T$。对于动能 $\\frac{1}{2}mv^2$，我们有 $\\langle \\frac{1}{2}mv(0)^2 \\rangle = \\frac{1}{2}k_B T$。这给出：\n    $$ C_{vv}(0) = \\langle v(0)^2 \\rangle = \\frac{k_B T}{m} $$\n2.  $\\dot{C}_{vv}(0) = \\left. \\frac{dC_{vv}(t)}{dt} \\right|_{t=0}$。根据 $t=0$ 时的等式 $(*)$：\n    $\\dot{C}_{vv}(0) = -\\nu C_{vv}(0) + C_{\\dot{v}v}(0)$\n    $C_{\\dot{v}v}(0) = \\langle \\dot{v}(0)v(0) \\rangle = \\langle (-\\omega^2 x(0))v(0) \\rangle = -\\omega^2\\langle x(0)v(0) \\rangle$。\n    对于正则系综平衡中的谐振子，其联合概率分布 $P(x,v)$ 正比于 $\\exp(-(\\frac{1}{2}m\\omega^2x^2 + \\frac{1}{2}mv^2)/k_B T)$，这是一个关于 $x$ 和 $v$ 的函数的乘积。因此，位置和速度是统计独立的。由于势能是对称的，$\\langle x(0) \\rangle = 0$。因此，$\\langle x(0)v(0) \\rangle = \\langle x(0) \\rangle \\langle v(0) \\rangle = 0$。这意味着 $C_{\\dot{v}v}(0)=0$。\n    那么初始导数为：\n    $$ \\dot{C}_{vv}(0) = -\\nu C_{vv}(0) = -\\frac{\\nu k_B T}{m} $$\n\n### 常微分方程的求解\n我们求解 $\\ddot{C} + \\nu\\dot{C} + \\omega^2 C = 0$，初始条件为 $C(0)=\\frac{k_B T}{m}$ 和 $\\dot{C}(0)=-\\frac{\\nu k_B T}{m}$。\n特征方程为 $r^2 + \\nu r + \\omega^2 = 0$，其根为：\n$r_{1,2} = \\frac{-\\nu \\pm \\sqrt{\\nu^2 - 4\\omega^2}}{2} = -\\frac{\\nu}{2} \\pm \\sqrt{\\frac{\\nu^2}{4} - \\omega^2}$\n\n解的形式取决于判别式 $\\Delta = \\nu^2 - 4\\omega^2$ 的符号。\n\n**情况1：欠阻尼 ($\\nu  2\\omega$)**\n根是复共轭的：$r_{1,2} = -\\frac{\\nu}{2} \\pm i\\Omega'$，其中 $\\Omega' = \\sqrt{\\omega^2 - \\frac{\\nu^2}{4}}$。\n通解为 $C_{vv}(t) = e^{-\\nu t/2}(A\\cos(\\Omega' t) + B\\sin(\\Omega' t))$。\n应用初始条件：\n$C_{vv}(0) = A = \\frac{k_B T}{m}$。\n$\\dot{C}_{vv}(0) = -\\frac{\\nu}{2}A + B\\Omega' = -\\frac{\\nu k_B T}{m}$。\n$-\\frac{\\nu}{2}\\frac{k_B T}{m} + B\\Omega' = -\\frac{\\nu k_B T}{m} \\implies B\\Omega' = -\\frac{\\nu}{2}\\frac{k_B T}{m} \\implies B = -\\frac{\\nu}{2\\Omega'}\\frac{k_B T}{m}$。\n解为：\n$C_{vv}(t) = \\frac{k_B T}{m} e^{-\\nu t/2} \\left( \\cos(\\Omega' t) - \\frac{\\nu}{2\\Omega'} \\sin(\\Omega' t) \\right)$。\n\n**情况2：过阻尼 ($\\nu  2\\omega$)**\n根是相异的实数：$r_{1,2} = -\\frac{\\nu}{2} \\pm \\Omega$，其中 $\\Omega = \\sqrt{\\frac{\\nu^2}{4} - \\omega^2}$。\n解为 $C_{vv}(t) = \\frac{k_B T}{m} e^{-\\nu t/2} \\left( \\cosh(\\Omega t) - \\frac{\\nu}{2\\Omega} \\sinh(\\Omega t) \\right)$。这可以通过将 $\\Omega' = i\\Omega$ 代入欠阻尼解并使用 $\\cos(i\\theta)=\\cosh(\\theta)$、$\\sin(i\\theta)=i\\sinh(\\theta)$ 得到。\n\n**情况3：临界阻尼 ($\\nu = 2\\omega$)**\n根是重实根：$r_1=r_2=-\\frac{\\nu}{2}=-\\omega$。\n通解为 $C_{vv}(t) = (A+Bt)e^{-\\nu t/2}$。\n$C_{vv}(0) = A = \\frac{k_B T}{m}$。\n$\\dot{C}_{vv}(0) = B - \\frac{\\nu}{2}A = -\\frac{\\nu k_B T}{m}$。\n$B - \\frac{\\nu}{2}\\frac{k_B T}{m} = -\\nu\\frac{k_B T}{m} \\implies B=-\\frac{\\nu}{2}\\frac{k_B T}{m}$。\n解为 $C_{vv}(t) = \\frac{k_B T}{m} (1-\\frac{\\nu}{2}t)e^{-\\nu t/2}$。这也是欠阻尼和过阻尼解在 $\\Omega, \\Omega' \\to 0$ 时的极限。\n\n对于所有非负实数 $\\nu$ 和 $\\omega$，可以使用欠阻尼形式写出一个单一的解析表达式，其理解是这些函数是通过对复数参数的解析延拓来定义的（或在临界情况下取相应的极限）。\n\n### 阻尼振荡的条件\n当解包含正弦项时，出现阻尼振荡，这对应于欠阻尼情况。其条件是特征方程的根为复数，这要求判别式为负：\n$\\nu^2 - 4\\omega^2  0 \\implies \\nu^2  4\\omega^2$。\n由于 $\\nu$ 和 $\\omega$ 是非负的，这给出了不等式：\n$$ \\nu  2\\omega $$\n这就是 VACF 表现出阻尼振荡的参数区域。\n\n覆盖所有情况的单一解析表达式是：\n$$ C_{vv}(t) = \\frac{k_B T}{m} e^{-\\frac{\\nu t}{2}} \\left[ \\cos\\left(t\\sqrt{\\omega^2 - \\frac{\\nu^2}{4}}\\right) - \\frac{\\nu}{2\\sqrt{\\omega^2 - \\frac{\\nu^2}{4}}} \\sin\\left(t\\sqrt{\\omega^2 - \\frac{\\nu^2}{4}}\\right) \\right] $$\n如果平方根的参数为负，则应使用 $\\cosh$ 和 $\\sinh$ 来解释此表达式；如果参数为零，则应将其解释为极限。", "answer": "$$ \\boxed{ \\frac{k_B T}{m} \\exp\\left(-\\frac{\\nu t}{2}\\right) \\left( \\cos\\left(t\\sqrt{\\omega^2 - \\frac{\\nu^2}{4}}\\right) - \\frac{\\nu}{2\\sqrt{\\omega^2 - \\frac{\\nu^2}{4}}} \\sin\\left(t\\sqrt{\\omega^2 - \\frac{\\nu^2}{4}}\\right) \\right) } $$", "id": "3395499"}]}