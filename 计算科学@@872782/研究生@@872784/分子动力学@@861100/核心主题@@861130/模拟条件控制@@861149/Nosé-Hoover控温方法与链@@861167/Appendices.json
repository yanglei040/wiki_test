{"hands_on_practices": [{"introduction": "在使用任何恒温器之前，我们必须首先理解其核心的控制方程。本练习旨在推导 Nosé-Hoover 链中第一个恒温器的运动方程，并强调在存在物理约束（如键长固定或质心不动）时，正确计算被调控的自由度数目 $g$ 的重要性。这是构建任何有效恒温模拟的基石，确保了目标温度的精确实现。", "problem": "考虑一个经典的分子系统，它由 $d$ 维空间中的 $N$ 个质点组成，质量为 $\\{m_i\\}_{i=1}^N$。系统具有 $n_c$ 个完整约束 $C_a(\\mathbf{q})=0$（$a=1,\\dots,n_c$），这些约束被精确执行。总质心（COM）线动量被约束为始终为零。该系统在温度为 $T$ 的正则系综中，使用 Nosé-Hoover 链（NHC）进行恒温控制，其中，物理动量 $\\{\\mathbf{p}_i\\}$ 仅与第一个恒温器变量耦合，该变量的速度为 $\\xi_1$，质量参数为 $Q_1$；而第一个恒温器本身又与速度为 $\\xi_2$ 的第二个恒温器耦合（链长至少为 $2$）。物理运动方程的形式为\n- $d\\mathbf{q}_i/dt=\\mathbf{p}_i/m_i$,\n- $d\\mathbf{p}_i/dt=\\mathbf{F}_i(\\mathbf{q})-\\xi_1\\,\\mathbf{p}_i+\\text{约束力}$,\n并且链变量根据某个待定的常微分方程组（ODEs）演化。令 $K$ 表示在施加所有约束后，剩余的、被恒温控制的独立动量的瞬时动能。在温度为 $T$ 的平衡态下，能量均分定理意味着 $\\langle K\\rangle=(g/2)\\,k_{\\mathrm{B}}T$，其中 $k_{\\mathrm{B}}$ 是玻尔兹曼常数，$g$ 是恒温器实际采样的独立二次型动量自由度的数量。\n\n仅使用牛顿定律、独立动量的动能定义 $K=\\sum (\\mathbf{p}_i^2/2m_i)$、类摩擦项 $-\\xi_1\\mathbf{p}_i$ 对动能变化率的影响，以及能量均分关系 $\\langle K\\rangle=(g/2)\\,k_{\\mathrm{B}}T$，推断 (i) 第一个恒温器常微分方程（ODE）的形式，该形式能一致地将 $K$ 驱动至其正则系综目标值，同时允许在链中与第二个恒温器耦合；以及 (ii) 当存在 $n_c$ 个完整约束且质心动量被约束为零时，$g$ 的正确值。选择与这些要求相符的唯一选项。\n\nA. $d\\xi_1/dt=(2K-g\\,k_{\\mathrm{B}}T)/Q_1-\\xi_2\\,\\xi_1$，其中当质心动量被约束为零时，$g=dN-n_c-d$，且 $K$ 仅根据独立动量计算。\n\nB. $d\\xi_1/dt=(K-(g/2)\\,k_{\\mathrm{B}}T)/Q_1-\\xi_2\\,\\xi_1$，其中 $g=dN$，与约束或动量移除无关。\n\nC. $d\\xi_1/dt=(2K-g\\,k_{\\mathrm{B}}T)/Q_1$，不与 $\\xi_2$ 耦合，且 $g=dN-n_c$，无论有无任何质心动量约束。\n\nD. $d\\xi_1/dt=(2K-g\\,k_{\\mathrm{B}}T)/Q_1-\\xi_1^2$，其中当质心动量被约束为零时，$g=dN-n_c-2d$。", "solution": "用户希望我验证并解决一个关于经典分子动力学模拟中 Nosé-Hoover 链恒温器的问题。\n\n### 问题验证\n\n首先，我将提取已知条件并验证问题陈述。\n\n**第 1 步：提取已知条件**\n-   系统：一个经典的分子系统，由 $d$ 维空间中的 $N$ 个质点组成，质量为 $\\{m_i\\}_{i=1}^N$。\n-   完整约束：$n_c$ 个形式为 $C_a(\\mathbf{q})=0$ 的约束被精确执行。\n-   质心（COM）动量约束：总质心线动量被约束为始终为零。\n-   恒温控制：该系统在温度为 $T$ 的正则系综中，使用长度至少为 2 的 Nosé-Hoover 链（NHC）进行恒温控制。\n-   耦合方案：物理动量 $\\{\\mathbf{p}_i\\}$ 仅与第一个恒温器变量耦合，该变量的速度为 $\\xi_1$，质量参数为 $Q_1$。第一个恒温器与速度为 $\\xi_2$ 的第二个恒温器耦合。\n-   粒子运动方程（EOMs）：\n    -   $d\\mathbf{q}_i/dt = \\mathbf{p}_i/m_i$\n    -   $d\\mathbf{p}_i/dt = \\mathbf{F}_i(\\mathbf{q}) - \\xi_1\\,\\mathbf{p}_i + \\text{约束力}$\n-   动能 $K$：$K$ 是在施加所有约束后，剩余的独立动量的瞬时动能。\n-   能量均分定理：在平衡态下，$\\langle K \\rangle = (g/2)\\,k_{\\mathrm{B}}T$，其中 $g$ 是恒温器采样的独立二次型动量自由度数，$k_{\\mathrm{B}}$ 是玻尔兹曼常数。\n\n**第 2 步：使用提取的已知条件进行验证**\n-   **科学依据：** 该问题牢固地植根于统计力学和计算物理学中公认的理论，特别是关于分子动力学模拟和恒温系综。Nosé-Hoover 链是一种标准的、广泛使用的算法。完整约束和质心动量移除的概念也是标准做法。该问题在科学上是合理的。\n-   **适定性：** 该问题要求第一个恒温器变量的运动方程（EOM）和自由度数 $g$。这些量由 NHC 恒温器和约束动力学的理论框架唯一确定。题设足以推导出一个唯一的正确答案。\n-   **客观性：** 该问题以精确、客观、技术性的语言陈述，没有歧义或主观论断。\n\n**第 3 步：结论与行动**\n问题陈述在科学上是合理的、适定的、客观的且自洽的。这是一个有效的问题。我将继续推导解答。\n\n### 推导过程\n\n该问题有两部分：(i) 确定第一个恒温器变量 $\\xi_1$ 的运动方程，以及 (ii) 确定自由度数 $g$ 的正确值。\n\n**(i) $\\xi_1$ 的运动方程**\n\nNosé-Hoover 链恒温器旨在生成正则相空间分布。这是通过引入一串虚拟的恒温器变量来实现的。第一个变量 $\\xi_1$ 直接与物理系统的动能 $K$ 耦合。链中的每个后续变量 $\\xi_j$ 对前一个变量 $\\xi_{j-1}$ 进行恒温控制。\n\nNHC 运动方程的一般结构如下。恒温器变量 $\\xi_j$ 的运动方程由它所控温的变量的“动能”驱动，并由链中的下一个恒温器变量 $\\xi_{j+1}$ 阻尼。\n\n对于第一个恒温器变量 $\\xi_1$，它控制的“动能”是物理粒子的动能 $K$。恒温器旨在将 $K$ 驱动至其正则系综平均值，即 $\\langle K \\rangle = (g/2)k_{\\mathrm{B}}T$。Nosé-Hoover 式恒温器运动方程中的驱动项与瞬时“动理学温度”与目标温度的偏差成正比。对于量 $2K$，目标值是 $g k_{\\mathrm{B}}T$。因此，驱动项是 $(2K - g k_{\\mathrm{B}}T)$。\n\n问题陈述链长至少为 2，意味着 $\\xi_1$ 与第二个恒温器变量 $\\xi_2$ 耦合。在 NHC 形式体系中，这种耦合采用类摩擦项的形式。第一个恒温器的动量 $p_1 = Q_1 \\xi_1$ 的运动方程被第二个恒温器阻尼。从扩展哈密顿量进行的标准推导表明，$\\dot{p_1}$ 的阻尼项是 $-\\xi_2 p_1$。$p_1$ 的完整方程是：\n$$ \\frac{dp_1}{dt} = 2K - g k_{\\mathrm{B}}T - \\xi_2 p_1 $$\n代入 $p_1 = Q_1 \\xi_1$ 和 $dp_1/dt = Q_1 (d\\xi_1/dt)$，我们得到：\n$$ Q_1 \\frac{d\\xi_1}{dt} = 2K - g k_{\\mathrm{B}}T - \\xi_2 (Q_1 \\xi_1) $$\n除以恒温器质量参数 $Q_1$ 得到恒温器速度 $\\xi_1$ 的运动方程：\n$$ \\frac{d\\xi_1}{dt} = \\frac{2K - g k_{\\mathrm{B}}T}{Q_1} - \\xi_2 \\xi_1 $$\n该方程表明，如果动能 $K$ 过高，$\\xi_1$ 趋于增大，从而增强对粒子的摩擦（因为 $\\dot{\\mathbf{p}}_i \\propto -\\xi_1 \\mathbf{p}_i$）并冷却系统。如果 $K$ 过低，$\\xi_1$ 趋于减小，导致系统升温。项 $-\\xi_2 \\xi_1$ 表示对第一个恒温器本身的恒温控制，这对于确保遍历性和正确的正则采样至关重要。\n\n**(ii) 自由度数 $g$**\n\n参数 $g$ 表示被恒温控制的独立二次型动量自由度的数量。这是系统的总动能自由度数。\n\n1.  系统有 $N$ 个粒子在 $d$ 维空间中。没有任何约束时，每个粒子有 $d$ 个动量分量，总共有 $dN$ 个动量自由度。\n\n2.  存在 $n_c$ 个完整约束 $C_a(\\mathbf{q})=0$。为了使这些约束在任何时候都成立，它们的时间导数必须为零：\n    $$ \\frac{dC_a}{dt} = \\sum_{i=1}^N \\frac{\\partial C_a}{\\partial \\mathbf{q}_i} \\cdot \\frac{d\\mathbf{q}_i}{dt} = \\sum_{i=1}^N \\frac{\\partial C_a}{\\partial \\mathbf{q}_i} \\cdot \\frac{\\mathbf{p}_i}{m_i} = 0 $$\n    这 $n_c$ 个方程中的每一个都对动量分量 $\\{\\mathbf{p}_i\\}$ 施加了一个独立的线性约束。因此，完整约束移除了 $n_c$ 个自由度。剩余的自由度数为 $dN - n_c$。\n\n3.  总质心（COM）动量被约束为零。质心动量是向量 $\\mathbf{P}_{\\text{COM}} = \\sum_{i=1}^N \\mathbf{p}_i$。约束 $\\mathbf{P}_{\\text{COM}} = \\mathbf{0}$ 是一个矢量方程，它分解为 $d$ 个独立的标量方程，每个空间维度一个：\n    $$ \\sum_{i=1}^N p_{i,x} = 0, \\quad \\sum_{i=1}^N p_{i,y} = 0, \\quad \\dots \\quad (d \\text{ 个分量})$$\n    这 $d$ 个约束通常独立于完整约束。例如，固定分子中的键长并不能固定其整体动量。因此，这些约束额外移除了 $d$ 个自由度。\n\n将这些结合起来，被恒温控制的独立动量自由度的总数为：\n$$ g = dN - n_c - d $$\n进入恒温器方程的动能 $K$ 必须精确地基于这 $g$ 个独立自由度来计算。\n\n### 逐项分析\n\n**A. $d\\xi_1/dt=(2K-g\\,k_{\\mathrm{B}}T)/Q_1-\\xi_2\\,\\xi_1$，其中当质心动量被约束为零时，$g=dN-n_c-d$，且 $K$ 仅根据独立动量计算。**\n-   **ODE 形式：** 方程 $d\\xi_1/dt = (2K-g\\,k_{\\mathrm{B}}T)/Q_1 - \\xi_2\\,\\xi_1$ 正确地表示了 Nosé-Hoover 链中第一个变量的动力学。\n-   **$g$ 的值：** $g=dN-n_c-d$ 这个值通过减去由 $n_c$ 个完整约束和 $d$ 个质心动量约束所移除的自由度，正确地计算了独立动量自由度的数量。\n-   **结论：** 此选项与推导结果完全一致。**正确**。\n\n**B. $d\\xi_1/dt=(K-(g/2)\\,k_{\\mathrm{B}}T)/Q_1-\\xi_2\\,\\xi_1$，其中 $g=dN$，与约束或动量移除无关。**\n-   **ODE 形式：** 形式 $d\\xi_1/dt = (K-(g/2)\\,k_{\\mathrm{B}}T)/Q_1 - \\xi_2\\,\\xi_1$ 在代数上等价于 $(2K-g\\,k_{\\mathrm{B}}T)/(2Q_1) - \\xi_2\\,\\xi_1$。虽然该形式在结构上是合理的（这只是一个如何定义 $Q_1$ 的问题），但 $g$ 的值是错误的。\n-   **$g$ 的值：** $g=dN$ 这个值没有考虑任何约束。这将导致实际动态自由度的目标温度不正确。\n-   **结论：** $g$ 的值是错误的。**错误**。\n\n**C. $d\\xi_1/dt=(2K-g\\,k_{\\mathrm{B}}T)/Q_1$，不与 $\\xi_2$ 耦合，且 $g=dN-n_c$，无论有无任何质心动量约束。**\n-   **ODE 形式：** 该方程缺少 $-\\xi_2\\,\\xi_1$ 耦合项。这描述的是一个简单的 Nosé-Hoover 恒温器，而不是问题中指定的 Nosé-Hoover *链*。\n-   **$g$ 的值：** $g=dN-n_c$ 这个值错误地忽略了因固定质心动量为零而施加的 $d$ 个约束。\n-   **结论：** ODE 形式和 $g$ 的值都是错误的。**错误**。\n\n**D. $d\\xi_1/dt=(2K-g\\,k_{\\mathrm{B}}T)/Q_1-\\xi_1^2$，其中当质心动量被约束为零时，$g=dN-n_c-2d$。**\n-   **ODE 形式：** 阻尼项是 $-\\xi_1^2$，这意味着自阻尼。在 NHC 中，恒温器 $\\xi_1$ 是由 $\\xi_2$ 阻尼的，而不是由其自身。这种形式对于 NHC 是不正确的。\n-   **$g$ 的值：** $g=dN-n_c-2d$ 这个值是错误的。它为质心约束减去了 $2d$ 个自由度，但将质心动量矢量设为零只施加了 $d$ 个约束。\n-   **结论：** ODE 形式和 $g$ 的值都是错误的。**错误**。", "answer": "$$\\boxed{A}$$", "id": "3429682"}, {"introduction": "拥有正确的运动方程只是第一步；为保证模拟的效率和稳定性，选择合适的参数至关重要。本练习深入探讨了恒温器自身的动力学特性，揭示了它也具有一个特征振动频率 [@problem_id:3429729]。通过线性化分析，您将理解恒温器质量参数 $Q$ 如何控制此频率，并学习如何调节它以避免与物理系统的固有频率发生共振，这是一种关键的实践技能。", "problem": "考虑一个质量为 $m$、角频率为 $\\omega$ 的一维谐振子，它与一个双恒温器 Nosé-Hoover 链耦合。设恒温器变量分别为 $(\\eta_{1},p_{1})$ 和 $(\\eta_{2},p_{2})$，对应的恒温器质量分别为 $Q_{1}$ 和 $Q_{2}$。假设目标温度为 $T$，玻尔兹曼常数记为 $k_{B}$。在正则系综平衡点附近的小振幅区域进行分析，在该区域中，恒温器坐标接近其稳态值，且物理振子进行小幅振荡。基于以下几点，使用扩展动力学的二次近似（在正则系综平衡点附近有效）：\n\n- 物理自由度的牛顿第二定律，\n- 与 Nosé-Hoover 链相关的恒温器的标准小振幅二次形式，其中每个恒温器坐标表现为一个谐振模式，其有效恢复系数与 $k_{B}T$ 成正比。\n\n任务：\n1. 推导线性化的运动方程，并为状态向量 $(x, v, \\eta_{1}, p_{1}, \\eta_{2}, p_{2})$ 组建线性稳定性矩阵（雅可比矩阵），其中 $x$ 是位置，$v$ 是速度。\n2. 从雅可比矩阵中，求出恒温器块的小振幅简正模式角频率。清晰地说明这些频率对 $(Q_{1},Q_{2},k_{B},T)$ 的依赖关系。\n3. 为避免与系统主频率 $\\omega$ 发生共振，工程实践中有时将恒温器频率设置在 $\\omega$ 的无公度倍数上。令 $\\varphi = \\frac{1+\\sqrt{5}}{2}$ 为黄金比例。对在第2部分中找到的两个恒温器简正模式角频率施加设计要求 $\\,\\Omega_{1}=\\varphi\\,\\omega\\,$ 和 $\\,\\Omega_{2}=\\varphi^{2}\\,\\omega\\,$。利用第一性原理和你的线性化结果，求解 $Q_{1}$ 和 $Q_{2}$，用 $\\omega$、$k_{B}$ 和 $T$ 表示。\n\n将 $\\left(Q_{1},Q_{2}\\right)$ 的最终答案以 $\\mathrm{J\\cdot s^{2}}$ 为单位表示。无需四舍五入；报告封闭形式的解析表达式。给出最终答案时，将这对值按 $\\left(Q_{1},Q_{2}\\right)$ 的顺序列为一个行矩阵。", "solution": "首先将对问题陈述进行验证。\n\n### 第1步：提取已知条件\n- **系统**：一个一维谐振子。\n- **物理变量**：质量 $m$，角频率 $\\omega$，位置 $x$，速度 $v$。\n- **恒温器**：一个双恒温器 Nosé-Hoover 链。\n- **恒温器变量**：恒温器1为 $(\\eta_{1}, p_{1})$，恒温器2为 $(\\eta_{2}, p_{2})$。\n- **恒温器参数**：质量 $Q_{1}$ 和 $Q_{2}$。\n- **常数**：目标温度 $T$，玻尔兹曼常数 $k_{B}$。\n- **区域**：正则系综平衡点附近的小振幅振荡。\n- **近似**：将使用扩展动力学的二次近似。物理部分由牛顿第二定律控制。恒温器部分被描述为“标准的......小振幅二次形式，其中每个恒温器坐标表现为一个谐振模式，其有效恢复系数与 $k_{B}T$ 成正比”。\n- **状态向量**：$(x, v, \\eta_{1}, p_{1}, \\eta_{2}, p_{2})$。\n- **设计规范**：恒温器块的两个简正模式角频率 $\\Omega_{1}$ 和 $\\Omega_{2}$ 将被设置为 $\\Omega_{1}=\\varphi\\,\\omega\\,$ 和 $\\Omega_{2}=\\varphi^{2}\\,\\omega\\,$，其中 $\\varphi = \\frac{1+\\sqrt{5}}{2}$ 是黄金比例。\n- **目标**：1) 推导线性化的运动方程和雅可比矩阵。2) 求出恒温器的简正模式频率。3) 求解 $Q_{1}$ 和 $Q_{2}$。\n\n### 第2步：使用提取的已知条件进行验证\n该问题具有科学依据，植根于统计力学和分子动力学的原理，特别是用于正则系综模拟的 Nosé-Hoover 链方法。该问题是适定的；它提供了一套清晰的指令和约束，以得到唯一的解。语言客观而精确。\n\n问题的一个关键方面是使用“标准小振幅二次形式”来处理恒温器的指令。Nosé-Hoover 链的完整非线性运动方程在相空间原点附近直接进行线性化是复杂的。问题的措辞指导我们使用一个成熟的、在平衡点附近小涨落情况下有效的简化模型。在这个模型中，Nosé-Hoover 链动力学的复杂耦合被一个系统所近似，该系统中每个恒温器变量对 $(\\eta_i, p_i)$ 的行为都像一个独立的谐振子。坐标 $\\eta_i$ 的“有效恢复系数”与 $k_{B}T$ 成正比，这意味着存在一个形式为 $-C\\eta_i$ 的力项，其中 $C \\propto k_B T$。对于一个质量为 $Q$ 的单个恒温器，其特征频率的平方已知为 $\\Omega^2 = k_B T / Q$（对于单个被恒温的自由度）。这对应于运动方程 $Q\\ddot{\\eta} = -k_B T \\eta$，意味着有效恢复系数确实是 $k_B T$。问题暗示，在指定的线性化模型中，两个恒温器被视为具有这种特征行为的非耦合谐振子。这是一个标准的、具有物理意义的简化，用于分析恒温器链的特征频率。\n\n因此，该问题被认为是有效的，因为它依赖于该领域已建立的理论模型并且是自洽的。\n\n### 第3步：结论与行动\n问题有效。将提供完整解答。\n\n### 解答\n\n第一步是根据问题陈述中指定的模型，为整个系统建立线性化的运动方程。状态向量为 $Y = (x, v, \\eta_{1}, p_{1}, \\eta_{2}, p_{2})^T$。\n\n在正则系综平衡点附近的小振幅区域，物理振子和恒温器链之间的耦合项（例如，在 $\\dot{v}$ 方程中与 $v p_1$ 成正比的项）是涨落量的二阶项，因此在线性化中被忽略。这使得系统呈块对角形式，一个块用于物理振子，另一个块用于恒温器链。\n\n**物理振子块：**\n简谐振子的运动方程是：\n$$\n\\dot{x} = v\n$$\n$$\n\\dot{v} = -\\omega^2 x\n$$\n这些方程已经是线性的。\n\n**恒温器块：**\n问题指定了一个模型，其中每个恒温器坐标表现为一个谐振模式，其恢复系数与 $k_B T$ 成正比。如前验证，这对应于将每个恒温器变量对 $(\\eta_i, p_i)$ 建模为一个独立的谐振子，其有效力为 $\\dot{p}_i = -k_B T \\eta_i$。因此，恒温器变量的运动方程是：\n$$\n\\dot{\\eta}_1 = \\frac{p_1}{Q_1}\n$$\n$$\n\\dot{p}_1 = -k_B T \\eta_1\n$$\n$$\n\\dot{\\eta}_2 = \\frac{p_2}{Q_2}\n$$\n$$\n\\dot{p}_2 = -k_B T \\eta_2\n$$\n\n**1. 线性化运动方程与雅可比矩阵**\n\n完整的线性化运动方程组是：\n$$\n\\begin{cases}\n\\dot{x} = v \\\\\n\\dot{v} = -\\omega^2 x \\\\\n\\dot{\\eta}_1 = p_1/Q_1 \\\\\n\\dot{p}_1 = -k_B T \\eta_1 \\\\\n\\dot{\\eta}_2 = p_2/Q_2 \\\\\n\\dot{p}_2 = -k_B T \\eta_2\n\\end{cases}\n$$\n这些方程可以写成矩阵形式 $\\dot{Y} = J Y$，其中 $J$ 是雅可比（线性稳定性）矩阵。通过计算偏导数 $\\partial \\dot{Y}_i / \\partial Y_j$，我们得到雅可比矩阵：\n$$\nJ = \\begin{pmatrix}\n\\frac{\\partial \\dot{x}}{\\partial x}  \\frac{\\partial \\dot{x}}{\\partial v}  \\cdots \\\\\n\\frac{\\partial \\dot{v}}{\\partial x}  \\frac{\\partial \\dot{v}}{\\partial v}  \\cdots \\\\\n\\vdots  \\vdots  \\ddots\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0  1  0  0  0  0 \\\\\n-\\omega^2  0  0  0  0  0 \\\\\n0  0  0  1/Q_1  0  0 \\\\\n0  0  -k_B T  0  0  0 \\\\\n0  0  0  0  0  1/Q_2 \\\\\n0  0  0  0  -k_B T  0\n\\end{pmatrix}\n$$\n该矩阵是块对角矩阵，这证实了在此线性模型中，物理系统与恒温器是解耦的。\n\n**2. 恒温器块的简正模式频率**\n\n雅可比矩阵的恒温器块对应于状态变量 $(\\eta_1, p_1, \\eta_2, p_2)$ 的子矩阵：\n$$\nJ_{\\text{th}} = \\begin{pmatrix}\n0  1/Q_1  0  0 \\\\\n-k_B T  0  0  0 \\\\\n0  0  0  1/Q_2 \\\\\n0  0  -k_B T  0\n\\end{pmatrix}\n$$\n这个矩阵本身也是块对角的，由两个 $2 \\times 2$ 的块组成。因此，恒温器系统的简正模式是每个恒温器的独立振荡。\n\n对于第一个恒温器，其变量为 $(\\eta_1, p_1)$，子矩阵是 $J_1 = \\begin{pmatrix} 0  1/Q_1 \\\\ -k_B T  0 \\end{pmatrix}$。特征值 $\\lambda$ 可通过特征方程 $\\det(J_1 - \\lambda I) = 0$ 求得：\n$$\n(-\\lambda)(-\\lambda) - (1/Q_1)(-k_B T) = 0 \\implies \\lambda^2 + \\frac{k_B T}{Q_1} = 0\n$$\n特征值为 $\\lambda = \\pm i \\sqrt{\\frac{k_B T}{Q_1}}$。虚部给出了简正模式的角频率，因此 $\\Omega_1 = \\sqrt{\\frac{k_B T}{Q_1}}$。\n\n对于第二个恒温器，其变量为 $(\\eta_2, p_2)$，子矩阵是 $J_2 = \\begin{pmatrix} 0  1/Q_2 \\\\ -k_B T  0 \\end{pmatrix}$。类似的计算得出特征方程 $\\lambda^2 + \\frac{k_B T}{Q_2} = 0$。此模式的角频率是 $\\Omega_2 = \\sqrt{\\frac{k_B T}{Q_2}}$。\n\n恒温器块的小振幅简正模式角频率为：\n$$\n\\Omega_1 = \\sqrt{\\frac{k_B T}{Q_1}} \\quad \\text{和} \\quad \\Omega_2 = \\sqrt{\\frac{k_B T}{Q_2}}\n$$\n这些频率通过乘积 $k_B T$ 依赖于温度 $T$ 和玻尔兹曼常数 $k_B$，并与各自恒温器质量 $Q_1$ 和 $Q_2$ 的平方根成反比。\n\n**3. 求解恒温器质量 $Q_1$ 和 $Q_2$**\n\n问题施加了以下设计标准：\n$$\n\\Omega_1 = \\varphi \\omega\n$$\n$$\n\\Omega_2 = \\varphi^2 \\omega\n$$\n其中 $\\varphi = \\frac{1+\\sqrt{5}}{2}$。我们使用前一部分推导出的 $\\Omega_1$ 和 $\\Omega_2$ 的表达式来求解 $Q_1$ 和 $Q_2$。\n\n对于 $Q_1$：\n$$\n\\Omega_1^2 = \\frac{k_B T}{Q_1} \\implies (\\varphi \\omega)^2 = \\frac{k_B T}{Q_1}\n$$\n求解 $Q_1$：\n$$\nQ_1 = \\frac{k_B T}{(\\varphi \\omega)^2} = \\frac{k_B T}{\\varphi^2 \\omega^2}\n$$\n\n对于 $Q_2$：\n$$\n\\Omega_2^2 = \\frac{k_B T}{Q_2} \\implies (\\varphi^2 \\omega)^2 = \\frac{k_B T}{Q_2}\n$$\n求解 $Q_2$：\n$$\nQ_2 = \\frac{k_B T}{(\\varphi^2 \\omega)^2} = \\frac{k_B T}{\\varphi^4 \\omega^2}\n$$\n\n$k_B T$ 的单位是能量（焦耳，J），$\\omega^2$ 的单位是时间的平方的倒数（$s^{-2}$）。因此，$Q_1$ 和 $Q_2$ 的单位是 $\\mathrm{J}\\cdot\\mathrm{s}^2$，符合要求。\n\n对 $(Q_1, Q_2)$ 的最终答案是：\n$$\n(Q_1, Q_2) = \\left( \\frac{k_B T}{\\varphi^2 \\omega^2}, \\frac{k_B T}{\\varphi^4 \\omega^2} \\right)\n$$\n其中 $\\varphi = \\frac{1+\\sqrt{5}}{2}$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{k_B T}{\\varphi^2 \\omega^2}  \\frac{k_B T}{\\varphi^4 \\omega^2}\n\\end{pmatrix}\n}\n$$", "id": "3429729"}, {"introduction": "对于包含从快到慢多种时间尺度的复杂系统，单一的恒温器设置往往难以实现均衡控温。这个高级练习将引导您为系统的每个简正模式（normal mode）配备独立的恒温器 [@problem_id:3429718]。通过推导一个普适的、依赖于频率的恒温器质量设置规则，您将掌握设计高级恒温器的核心思想，即如何在整个振动谱上实现均匀且高效的温度控制。", "problem": "考虑一个由$N$个质量为$m$、晶格间距为$a$的全同粒子组成的一维周期性谐振子链，其最近邻弹簧常数为$K$。其哈密顿量为\n$$\nH = \\sum_{j=1}^{N} \\left( \\frac{p_j^2}{2m} + \\frac{K}{2} \\left( x_{j+1} - x_j \\right)^2 \\right),\n$$\n满足周期性边界条件 $x_{N+1} \\equiv x_1$。\n\n1. 使用离散傅里叶变换到简正坐标，将该链对角化为由波数$k$索引的独立简正模式，并证明其动力学简化为一组具有坐标$q_k$、共轭动量$p_k$和角频率$\\omega_k$的解耦谐振子。\n\n2. 为每个简正模式附加一个独立的Nosé-Hoover恒温器（NHT），其定义为：为每个模式$k$引入一个恒温器摩擦变量$\\xi_k$，其恒温器质量参数为$Q_k$，温度为$T$。模式层级的运动方程为\n$$\n\\dot{q}_k = \\frac{p_k}{m},\\quad \\dot{p}_k = - m \\omega_k^2 q_k - \\xi_k p_k,\\quad \\dot{\\xi}_k = \\frac{1}{Q_k} \\left( \\frac{p_k^2}{m} - k_B T \\right),\n$$\n其中$k_B$是玻尔兹曼常数。\n\n3. 定义瞬时模式能量为 $E_k = \\frac{p_k^2}{2m} + \\frac{1}{2} m \\omega_k^2 q_k^2$。从牛顿方程和上述Nosé-Hoover方程出发，在除了谐振性之外不作任何特殊形式的假设下，通过对谐振运动的快相进行平均，推导出模式能量$E_k$和恒温器变量$\\xi_k$的平均慢动力学。围绕热力学不动点 $E_k = k_B T$, $\\xi_k = 0$ 对这些平均方程进行线性化，以获得一个二维线性系统。从此线性化系统中，提取表征模式能量与恒温器之间反馈交换率的小信号角频率$\\Omega_k$。\n\n4. 您的任务是设计一个模式特定的恒温器质量函数$Q_k(\\omega_k)$，使得反馈带宽在模式频率上是平坦的，具体来说，即对于所有模式，小信号反馈率与模式角频率之比为一个给定的正常数$c$，即对每个$k$都有$\\Omega_k / \\omega_k = c$。仅使用您的线性化结果和$\\Omega_k$的定义，确定$Q_k(\\omega_k)$作为$\\omega_k$、$k_B$、$T$和$c$的函数的闭式表达式。\n\n请以$\\omega$、$k_B$、$T$和$c$的单个闭式解析表达式形式提供您的最终答案。最终答案中不要包含单位。", "solution": "所述问题在科学上是合理的、自洽的且良定的。它概述了分子动力学模拟领域中一个标准的、尽管详细的理论练习，特别涉及将Nosé-Hoover恒温器应用于谐振系统的简正模式。因此，我们可以进行推导。\n\n第一步，通过离散傅里叶变换对角化谐振子链的哈密顿量，是固态物理学中的一个标准结果。它将$N$个粒子的集体运动分解为$N$个独立的简正模式，每个模式的行为都像一个具有特定角频率$\\omega_k$的谐振子。问题要求我们考虑这样一个具有坐标$q_k$、动量$p_k$和频率$\\omega_k$的通用模式$k$。\n\n第二步给出了该模式与Nosé-Hoover恒温器（NHT）耦合时的运动方程。这些方程定义了我们必须分析的动力学：\n$$ \\dot{q}_k = \\frac{p_k}{m} $$\n$$ \\dot{p}_k = - m \\omega_k^2 q_k - \\xi_k p_k $$\n$$ \\dot{\\xi}_k = \\frac{1}{Q_k} \\left( \\frac{p_k^2}{m} - k_B T \\right) $$\n在这里，$\\xi_k$是恒温器动力学摩擦系数，$Q_k$是设定其响应时间尺度的恒温器质量参数，$T$是目标温度，$k_B$是玻尔兹曼常数。\n\n第三步要求我们通过对谐振模式的快振荡进行平均来找到慢动力学。我们首先定义模式的瞬时能量$E_k$：\n$$ E_k = \\frac{p_k^2}{2m} + \\frac{1}{2} m \\omega_k^2 q_k^2 $$\n我们使用链式法则并代入$\\dot{q}_k$和$\\dot{p}_k$的运动方程来计算其时间导数$\\dot{E}_k$：\n$$ \\dot{E}_k = \\frac{d}{dt} \\left( \\frac{p_k^2}{2m} + \\frac{1}{2} m \\omega_k^2 q_k^2 \\right) = \\frac{p_k \\dot{p}_k}{m} + m \\omega_k^2 q_k \\dot{q}_k $$\n$$ \\dot{E}_k = \\frac{p_k}{m} \\left( - m \\omega_k^2 q_k - \\xi_k p_k \\right) + m \\omega_k^2 q_k \\left( \\frac{p_k}{m} \\right) $$\n$$ \\dot{E}_k = - \\omega_k^2 p_k q_k - \\frac{\\xi_k p_k^2}{m} + \\omega_k^2 q_k p_k $$\n包含$p_k q_k$的项相互抵消，剩下：\n$$ \\dot{E}_k = - \\frac{\\xi_k p_k^2}{m} $$\n因此，变量$(E_k, \\xi_k)$的完整系统为：\n$$ \\dot{E}_k = - \\xi_k \\frac{p_k^2}{m} $$\n$$ \\dot{\\xi}_k = \\frac{1}{Q_k} \\left( \\frac{p_k^2}{m} - k_B T \\right) $$\n慢动力学近似的核心思想是，与频率为$\\omega_k$的谐振相比，变量$E_k$和$\\xi_k$变化缓慢。因此，我们可以将这些方程的右侧在一个快运动周期内进行平均。对于能量为$E_k$的谐振子，维里定理指出平均动能等于平均势能，因此$\\left\\langle \\frac{p_k^2}{2m} \\right\\rangle_{fast} = \\frac{E_k}{2}$。这意味着方程中出现的项的平均值为$\\left\\langle \\frac{p_k^2}{m} \\right\\rangle_{fast} = E_k$。在平均过程中将$E_k$和$\\xi_k$视为常数，我们得到慢变量的平均运动方程：\n$$ \\dot{E}_k = - \\xi_k E_k $$\n$$ \\dot{\\xi}_k = \\frac{1}{Q_k} \\left( E_k - k_B T \\right) $$\n这个二维系统的不动点可以通过设置$\\dot{E}_k = 0$和$\\dot{\\xi}_k = 0$来找到。第二个方程给出$E_k^* = k_B T$。将此代入第一个方程得到$-\\xi_k^* (k_B T) = 0$，由于$k_B T > 0$，这意味着$\\xi_k^* = 0$。因此，不动点是$(E_k^*, \\xi_k^*) = (k_B T, 0)$。\n\n接下来，我们围绕不动点对该系统进行线性化。设$E_k(t) = k_B T + \\delta E_k(t)$和$\\xi_k(t) = 0 + \\delta \\xi_k(t)$，其中$\\delta E_k$和$\\delta \\xi_k$是小偏离。将这些代入平均方程并只保留一阶项，可得：\n$$ \\delta \\dot{E}_k = -(0 + \\delta \\xi_k)(k_B T + \\delta E_k) \\approx -(k_B T) \\delta \\xi_k $$\n$$ \\delta \\dot{\\xi}_k = \\frac{1}{Q_k} \\left( (k_B T + \\delta E_k) - k_B T \\right) = \\frac{1}{Q_k} \\delta E_k $$\n这是一个可以写成矩阵形式的线性系统：\n$$ \\frac{d}{dt} \\begin{pmatrix} \\delta E_k \\\\ \\delta \\xi_k \\end{pmatrix} = \\begin{pmatrix} 0  -k_B T \\\\ 1/Q_k  0 \\end{pmatrix} \\begin{pmatrix} \\delta E_k \\\\ \\delta \\xi_k \\end{pmatrix} $$\n动力学由雅可比矩阵 $J = \\begin{pmatrix} 0  -k_B T \\\\ 1/Q_k  0 \\end{pmatrix}$ 的特征值$\\lambda$决定。特征方程为$\\det(J - \\lambda I) = 0$：\n$$ \\det \\begin{pmatrix} -\\lambda  -k_B T \\\\ 1/Q_k  -\\lambda \\end{pmatrix} = \\lambda^2 + \\frac{k_B T}{Q_k} = 0 $$\n特征值为$\\lambda = \\pm i \\sqrt{\\frac{k_B T}{Q_k}}$。这些纯虚特征值描述了围绕不动点的振荡。这些振荡的角频率就是反馈交换率$\\Omega_k$：\n$$ \\Omega_k = \\sqrt{\\frac{k_B T}{Q_k}} $$\n\n最后，在第四步中，我们必须确定函数$Q_k(\\omega_k)$以满足设计准则，即反馈带宽在各个模式上是平坦的，具体由条件$\\Omega_k / \\omega_k = c$指定，其中$c$是一个正常数。\n$$ \\frac{\\Omega_k}{\\omega_k} = c \\implies \\Omega_k = c \\omega_k $$\n我们将此与我们推导出的$\\Omega_k$表达式相等：\n$$ c \\omega_k = \\sqrt{\\frac{k_B T}{Q_k}} $$\n为了求解$Q_k$，我们将两边平方：\n$$ (c \\omega_k)^2 = \\frac{k_B T}{Q_k} \\implies c^2 \\omega_k^2 = \\frac{k_B T}{Q_k} $$\n重新整理以分离出$Q_k$，得到所需的函数：\n$$ Q_k = \\frac{k_B T}{c^2 \\omega_k^2} $$\n按照要求，我们以模式频率$\\omega$的通用函数形式提供此结果。", "answer": "$$\n\\boxed{\\frac{k_B T}{c^2 \\omega^2}}\n$$", "id": "3429718"}]}