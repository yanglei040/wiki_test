{"hands_on_practices": [{"introduction": "第一个练习是基础。我们将为广泛使用的Lennard-Jones势推导能量和压力尾部校正的解析表达式。掌握这一推导 [@problem_id:3451011] 不仅能巩固宏观热力学性质与微观对势之间的联系，也为掌握统计力学中常用的积分计算提供了必要的练习。", "problem": "考虑一个通过分子动力学 (MD) 研究的宏观均匀且各向同性的单原子流体，其粒子间通过两体加和的 Lennard-Jones 势 $u(r)=4\\epsilon\\left[(\\sigma/r)^{12}-(\\sigma/r)^6\\right]$ 相互作用。在有限范围的模拟中，该势在截断距离 $r_c0$ 处被截断，这忽略了来自间距 $r\\ge r_c$ 的贡献。尾部校正通过在径向分布函数 (RDF) $g(r)$ 对于 $r\\ge r_c$ 满足 $g(r)\\approx 1$ 的标准近似下，对超出 $r_c$ 的全势进行积分来恢复缺失的贡献。\n\n仅从以下适用于具有两体相互作用的均匀流体的、经过充分检验的表达式出发：\n- 每个粒子的构型势能，$U/N=2\\pi\\rho\\int_{0}^{\\infty}r^2u(r)g(r)\\,dr$，以及\n- 压力的维里状态方程，$P=\\rho k_B T-\\frac{2\\pi}{3}\\rho^2\\int_{0}^{\\infty}r^3 u'(r)g(r)\\,dr$，\n\n其中 $u'(r)=\\frac{du}{dr}$，推导由于在 $r_c$ 处截断 Lennard-Jones 势而产生的对每个粒子的能量和压力的尾部校正。具体来说，求出以下各项的闭合形式解析表达式：\n- 每个粒子的能量尾部校正 $U_{\\text{tail}}/N=2\\pi\\rho\\int_{r_c}^{\\infty}r^2u(r)\\,dr$，以及\n- 压力尾部校正 $P_{\\text{tail}}=-\\frac{2\\pi}{3}\\rho^2\\int_{r_c}^{\\infty}r^3u'(r)\\,dr$。\n\n用符号 $\\epsilon$、$\\sigma$、$\\rho$ 和 $r_c$ 进行所有步骤的推导。然后，在 $r_c\\gg\\sigma$ 的极限下，分析 $U_{\\text{tail}}/N$ 和 $P_{\\text{tail}}$ 随数密度 $\\rho$ 和截断距离 $r_c$ 的标度关系，确定对 $r_c$ 的主导阶依赖关系以及各项校正的符号。将两个尾部校正表达式的最终答案用符号 $\\epsilon$、$\\sigma$、$\\rho$ 和 $r_c$ 表示。不要代入数值，最终表达式中也不要包含单位。", "solution": "用户要求推导 Lennard-Jones 流体分子动力学模拟中势能和压力的尾部校正，并分析其标度性质。\n\n首先，对问题陈述进行验证。\n**步骤 1：提取已知条件**\n- **系统**：宏观均匀且各向同性的单原子流体。\n- **势**：两体加和的 Lennard-Jones 势，$u(r)=4\\epsilon\\left[\\left(\\frac{\\sigma}{r}\\right)^{12}-\\left(\\frac{\\sigma}{r}\\right)^6\\right]$。\n- **模拟条件**：势在截断距离 $r_c  0$ 处被截断。\n- **近似**：对于分子间距 $r \\ge r_c$，径向分布函数 $g(r) \\approx 1$。\n- **每个粒子的构型能量表达式**：$\\frac{U}{N}=2\\pi\\rho\\int_{0}^{\\infty}r^2u(r)g(r)\\,dr$。\n- **压力表达式**：$P=\\rho k_B T-\\frac{2\\pi}{3}\\rho^2\\int_{0}^{\\infty}r^3 u'(r)g(r)\\,dr$，其中 $u'(r)=\\frac{du}{dr}$。\n- **能量尾部校正的定义**：$\\frac{U_{\\text{tail}}}{N}=2\\pi\\rho\\int_{r_c}^{\\infty}r^2u(r)\\,dr$。\n- **压力尾部校正的定义**：$P_{\\text{tail}}=-\\frac{2\\pi}{3}\\rho^2\\int_{r_c}^{\\infty}r^3u'(r)\\,dr$。\n- **要求的任务**：\n    1. 推导 $\\frac{U_{\\text{tail}}}{N}$ 和 $P_{\\text{tail}}$ 的闭合形式解析表达式。\n    2. 在 $r_c \\gg \\sigma$ 的极限下，分析这些校正随数密度 $\\rho$ 和截断距离 $r_c$ 的标度关系。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题具有科学依据，处于统计力学和分子模拟的标准框架之内。Lennard-Jones 势、能量和压力的表达式，以及对于大 $r$ 值时 $g(r) \\approx 1$ 的近似，都是该领域的经典要素。该问题提法恰当，提供了执行所要求的推导所需的全部信息，这些推导涉及计算良态函数的定积分。所用术语精确且标准。这是一个基础但非平凡的计算，旨在考察核心知识。未发现与科学合理性、完整性、一致性或清晰度相关的缺陷。\n\n**步骤 3：结论与行动**\n该问题被判定为**有效**。将提供一个完整的、有理有据的解答。\n\n**尾部校正的推导**\n\n任务是计算当对势在 $r_c$ 处截断时被忽略的构型能量和压力的长程校正。这些校正是通过假设在截断距离之外粒子呈均匀分布 ($g(r)=1$)，对从 $r_c$ 到无穷大的势及其相关的维里项进行积分来计算的。\n\n**1. 每个粒子的能量尾部校正 ($U_{\\text{tail}}/N$)**\n\n每个粒子的能量尾部校正表达式为：\n$$\n\\frac{U_{\\text{tail}}}{N} = 2\\pi\\rho\\int_{r_c}^{\\infty}r^2 u(r) \\,dr\n$$\nLennard-Jones 势为 $u(r) = 4\\epsilon\\left[\\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^6\\right]$。将其代入积分中：\n$$\n\\frac{U_{\\text{tail}}}{N} = 2\\pi\\rho\\int_{r_c}^{\\infty} r^2 \\left( 4\\epsilon\\left[ \\sigma^{12}r^{-12} - \\sigma^6r^{-6} \\right] \\right) \\,dr\n$$\n提出常数：\n$$\n\\frac{U_{\\text{tail}}}{N} = 8\\pi\\rho\\epsilon \\int_{r_c}^{\\infty} \\left( \\sigma^{12}r^{-10} - \\sigma^6r^{-4} \\right) \\,dr\n$$\n我们现在逐项进行积分：\n$$\n\\int \\left( \\sigma^{12}r^{-10} - \\sigma^6r^{-4} \\right) \\,dr = \\sigma^{12}\\frac{r^{-9}}{-9} - \\sigma^6\\frac{r^{-3}}{-3} = -\\frac{\\sigma^{12}}{9r^9} + \\frac{\\sigma^6}{3r^3}\n$$\n计算从 $r_c$ 到 $\\infty$ 的定积分：\n$$\n\\left[ -\\frac{\\sigma^{12}}{9r^9} + \\frac{\\sigma^6}{3r^3} \\right]_{r_c}^{\\infty} = \\lim_{r\\to\\infty}\\left(-\\frac{\\sigma^{12}}{9r^9} + \\frac{\\sigma^6}{3r^3}\\right) - \\left(-\\frac{\\sigma^{12}}{9r_c^9} + \\frac{\\sigma^6}{3r_c^3}\\right)\n$$\n当 $r \\to \\infty$ 时，极限为 $0$。因此，积分为：\n$$\n0 - \\left(-\\frac{\\sigma^{12}}{9r_c^9} + \\frac{\\sigma^6}{3r_c^3}\\right) = \\frac{\\sigma^{12}}{9r_c^9} - \\frac{\\sigma^6}{3r_c^3}\n$$\n将此结果代回能量校正的表达式中：\n$$\n\\frac{U_{\\text{tail}}}{N} = 8\\pi\\rho\\epsilon \\left( \\frac{\\sigma^{12}}{9r_c^9} - \\frac{\\sigma^6}{3r_c^3} \\right)\n$$\n提出公因子得到最终表达式：\n$$\n\\frac{U_{\\text{tail}}}{N} = \\frac{8\\pi\\rho\\epsilon\\sigma^3}{3} \\left( \\frac{1}{3}\\left(\\frac{\\sigma}{r_c}\\right)^9 - \\left(\\frac{\\sigma}{r_c}\\right)^3 \\right)\n$$\n\n**2. 压力尾部校正 ($P_{\\text{tail}}$)**\n\n压力尾部校正的表达式为：\n$$\nP_{\\text{tail}} = -\\frac{2\\pi}{3}\\rho^2 \\int_{r_c}^{\\infty} r^3 u'(r) \\,dr\n$$\n首先，我们必须求出 Lennard-Jones 势的导数，$u'(r) = \\frac{du}{dr}$：\n$$\nu(r) = 4\\epsilon\\left(\\sigma^{12}r^{-12} - \\sigma^6r^{-6}\\right)\n$$\n$$\nu'(r) = \\frac{d}{dr}\\left[4\\epsilon\\left(\\sigma^{12}r^{-12} - \\sigma^6r^{-6}\\right)\\right] = 4\\epsilon\\left(\\sigma^{12}(-12)r^{-13} - \\sigma^6(-6)r^{-7}\\right)\n$$\n$$\nu'(r) = 4\\epsilon\\left(-12\\sigma^{12}r^{-13} + 6\\sigma^6r^{-7}\\right) = 24\\epsilon\\left(-\\frac{2\\sigma^{12}}{r^{13}} + \\frac{\\sigma^6}{r^7}\\right)\n$$\n现在，将 $u'(r)$ 代入 $P_{\\text{tail}}$ 的积分中：\n$$\nP_{\\text{tail}} = -\\frac{2\\pi}{3}\\rho^2 \\int_{r_c}^{\\infty} r^3 \\left(24\\epsilon\\left(-2\\sigma^{12}r^{-13} + \\sigma^6r^{-7}\\right)\\right) \\,dr\n$$\n提出常数：\n$$\nP_{\\text{tail}} = -\\frac{2\\pi}{3}\\rho^2 (24\\epsilon) \\int_{r_c}^{\\infty} \\left(-2\\sigma^{12}r^{-10} + \\sigma^6r^{-4}\\right) \\,dr = -16\\pi\\rho^2\\epsilon \\int_{r_c}^{\\infty} \\left(-2\\sigma^{12}r^{-10} + \\sigma^6r^{-4}\\right) \\,dr\n$$\n我们进行积分：\n$$\n\\int \\left(-2\\sigma^{12}r^{-10} + \\sigma^6r^{-4}\\right) \\,dr = -2\\sigma^{12}\\frac{r^{-9}}{-9} + \\sigma^6\\frac{r^{-3}}{-3} = \\frac{2\\sigma^{12}}{9r^9} - \\frac{\\sigma^6}{3r^3}\n$$\n计算从 $r_c$ 到 $\\infty$ 的定积分：\n$$\n\\left[ \\frac{2\\sigma^{12}}{9r^9} - \\frac{\\sigma^6}{3r^3} \\right]_{r_c}^{\\infty} = \\lim_{r\\to\\infty}\\left(\\frac{2\\sigma^{12}}{9r^9} - \\frac{\\sigma^6}{3r^3}\\right) - \\left(\\frac{2\\sigma^{12}}{9r_c^9} - \\frac{\\sigma^6}{3r_c^3}\\right)\n$$\n当 $r \\to \\infty$ 时，极限为 $0$。积分为：\n$$\n0 - \\left(\\frac{2\\sigma^{12}}{9r_c^9} - \\frac{\\sigma^6}{3r_c^3}\\right) = \\frac{\\sigma^6}{3r_c^3} - \\frac{2\\sigma^{12}}{9r_c^9}\n$$\n将此代回压力校正的表达式中：\n$$\nP_{\\text{tail}} = -16\\pi\\rho^2\\epsilon \\left( \\frac{\\sigma^6}{3r_c^3} - \\frac{2\\sigma^{12}}{9r_c^9} \\right) = 16\\pi\\rho^2\\epsilon \\left( \\frac{2\\sigma^{12}}{9r_c^9} - \\frac{\\sigma^6}{3r_c^3} \\right)\n$$\n提出公因子得到最终表达式：\n$$\nP_{\\text{tail}} = \\frac{16\\pi\\rho^2\\epsilon\\sigma^3}{3} \\left( \\frac{2}{3}\\left(\\frac{\\sigma}{r_c}\\right)^9 - \\left(\\frac{\\sigma}{r_c}\\right)^3 \\right)\n$$\n\n**3. 在 $r_c \\gg \\sigma$ 极限下的标度分析**\n\n对于大的截断距离，比值 $\\frac{\\sigma}{r_c}$ 很小。我们分析校正项的主导阶行为。\n\n**能量校正的标度关系：**\n表达式为 $\\frac{U_{\\text{tail}}}{N} = \\frac{8\\pi\\rho\\epsilon\\sigma^3}{3} \\left( \\frac{1}{3}\\left(\\frac{\\sigma}{r_c}\\right)^9 - \\left(\\frac{\\sigma}{r_c}\\right)^3 \\right)$。\n- **对 $\\rho$ 的依赖关系**：每个粒子的能量校正与数密度成正比，$\\frac{U_{\\text{tail}}}{N} \\propto \\rho$。\n- **对 $r_c$ 的依赖关系**：在 $r_c \\gg \\sigma$ 的极限下，项 $\\left(\\frac{\\sigma}{r_c}\\right)^9$ 远小于 $\\left(\\frac{\\sigma}{r_c}\\right)^3$。因此，主导阶依赖关系是：\n$$\n\\frac{U_{\\text{tail}}}{N} \\approx \\frac{8\\pi\\rho\\epsilon\\sigma^3}{3} \\left( - \\left(\\frac{\\sigma}{r_c}\\right)^3 \\right) = -\\frac{8\\pi\\rho\\epsilon\\sigma^6}{3r_c^3}\n$$\n能量校正的标度关系为 $r_c^{-3}$。\n- **符号**：由于 $\\left(\\frac{\\sigma}{r_c}\\right)^9 \\ll \\left(\\frac{\\sigma}{r_c}\\right)^3$，括号内的项是负的。所有其他量（$\\rho, \\epsilon, \\sigma$）都是正的。因此，能量校正 $\\frac{U_{\\text{tail}}}{N}$ 是**负的**。这在物理上是正确的，因为截断势忽略了长程吸引尾部，这会人为地增加系统的势能。该校正会降低能量。\n\n**压力校正的标度关系：**\n表达式为 $P_{\\text{tail}} = \\frac{16\\pi\\rho^2\\epsilon\\sigma^3}{3} \\left( \\frac{2}{3}\\left(\\frac{\\sigma}{r_c}\\right)^9 - \\left(\\frac{\\sigma}{r_c}\\right)^3 \\right)$。\n- **对 $\\rho$ 的依赖关系**：压力校正与数密度的平方成正比，$P_{\\text{tail}} \\propto \\rho^2$。\n- **对 $r_c$ 的依赖关系**：在 $r_c \\gg \\sigma$ 的极限下，项 $\\left(\\frac{\\sigma}{r_c}\\right)^9 \\ll \\left(\\frac{\\sigma}{r_c}\\right)^3$。主导阶依赖关系是：\n$$\nP_{\\text{tail}} \\approx \\frac{16\\pi\\rho^2\\epsilon\\sigma^3}{3} \\left( - \\left(\\frac{\\sigma}{r_c}\\right)^3 \\right) = -\\frac{16\\pi\\rho^2\\epsilon\\sigma^6}{3r_c^3}\n$$\n压力校正的标度关系为 $r_c^{-3}$。\n- **符号**：由于 $\\left(\\frac{\\sigma}{r_c}\\right)^9 \\ll \\left(\\frac{\\sigma}{r_c}\\right)^3$，括号内的项是负的。所有其他量都是正的。因此，压力校正项 $P_{\\text{tail}}$ 是**负的**。总压力由 $P = P_{\\text{truncated}} + P_{\\text{tail}}$ 给出。一个负的 $P_{\\text{tail}}$ 意味着真实压力低于从截断势计算出的压力。这在物理上也是正确的：被忽略的长程力是吸引力，这倾向于将粒子拉到一起，从而减小流体施加的向外压力。", "answer": "能量尾部校正：\n$$\n\\frac{U_{\\text{tail}}}{N} = \\frac{8}{3}\\pi\\rho\\varepsilon\\sigma^3 \\left[ \\frac{1}{3}\\left(\\frac{\\sigma}{r_c}\\right)^9 - \\left(\\frac{\\sigma}{r_c}\\right)^3 \\right]\n$$\n压力尾部校正：\n$$\nP_{\\text{tail}} = \\frac{16}{3}\\pi\\rho^2\\varepsilon\\sigma^3\\left[\\frac{2}{3}\\left(\\frac{\\sigma}{r_c}\\right)^9 - \\left(\\frac{\\sigma}{r_c}\\right)^3\\right]\n$$", "id": "3451011"}, {"introduction": "我们已经为衰减较快的势推导了尾部校正，现在必须提出一个关键问题：这种方法是否普遍适用？本练习 [@problem_id:3450965] 挑战你分析基于通用幂律势 $u(r) \\sim r^{-n}$ 的尾部校正积分的收敛条件。通过这一分析，你将揭示为何简单的尾部校正对范德华力有效，但对库仑力等长程相互作用却会失效的根本数学原因，从而理解为何需要更复杂的方法。", "problem": "一个数密度为 $\\rho$ 的均匀各向同性流体通过分子动力学 (MD) 在周期性边界条件下进行模拟。对相互作用在有限截断半径 $r_c$ 处被截断，并且我们考虑添加解析“尾部校正”来补偿 $r_c$ 之外缺失的贡献，其假设是径向分布函数 $g(r)$ 在 $r\\ge r_c$ 时满足 $g(r)\\to 1$。对于以 $u(r)\\sim C r^{-n}$ 形式衰减且 $n$ 足够大（例如 $u(r)\\sim r^{-6}$）的色散型相互作用，这种做法很常见。对于静电相互作用 $u(r)\\propto r^{-1}$，通常使用专门的长程方法，如 Ewald 求和法和粒子-粒子粒子-网格 (PPPM) 方法，而不是简单的截断加尾部校正。\n\n从均匀流体的构型能（用对相互作用表达）和大间距下的连续介质近似（球壳中的邻居数量和 $g(r)\\to 1$）的定义出发，推断在 $d=3$ 空间维度下，对于 $u(r)\\sim C r^{-n}$，能量和压力尾部的收敛性，并将其与 $u(r)\\propto r^{-1}$ 的情况进行对比。然后，从下面的列表中选择所有正确的陈述。\n\nA. 在一个均匀流体中，对于在 $r_c$ 处截断的势 $u(r)=C r^{-n}$，每个粒子缺失的能量可以写成一个表现为 $\\int_{r_c}^\\infty r^{2-n}\\,\\mathrm{d}r$ 的积分，该积分仅在 $n3$ 时收敛。因此，对于 $n=6$ 的色散尾部，可以进行有限的能量尾部校正，而对于 $n=1$ 的库仑尾部则不行；这就是为什么静电相互作用要使用 Ewald 求和或粒子-粒子粒子-网格 (PPPM) 等长程求和方法，而不是简单的截断加尾部校正。\n\nB. 在 $d=3$ 维中，对于 $u(r)=C r^{-n}$，其压力尾部对任何 $n1$ 都收敛，即使能量尾部可能对更小的 $n$ 发散。因此，库仑相互作用 ($n=1$) 可以通过有限的压力尾部进行校正，而无需借助 Ewald 类型的方法。\n\nC. 对于一个电中性的周期性体系，由于正负电荷的抵消，任何有限 $r_c$ 之外的库仑 ($n=1$) 能量尾部都精确为零，使得相应的积分绝对收敛；因此，对于静电相互作用，截断加有限尾部校正就足够了。\n\nD. 在 $d=3$ 维中，发散阈值 $n\\le 3$ 源于三维球壳中的体积元 $r^2\\,\\mathrm{d}r$，这使得大 $r$ 处的被积函数按 $r^{2-n}$ 比例变化。更一般地，在 $d$ 维空间中，尾部积分仅在 $nd$ 时收敛。\n\nE. 粒子-粒子粒子-网格 (PPPM) 方法通过在 $r_c$ 处截断库仑势，并添加与色散相互作用所用的相同解析尾部校正来实现精确的静电计算，从而在不调用倒易空间计算的情况下精确地守恒能量。\n\n选择所有适用的选项。", "solution": "用户提供了一个关于在分子动力学模拟中对截断势使用尾部校正的问题，特别是对比了色散型相互作用与静电相互作用。任务是验证问题陈述的有效性，如果有效，则推导控制这些校正收敛性的原理，并评估给定的陈述。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n- **体系：** 一个数密度为 $\\rho$ 的均匀各向同性流体。\n- **模拟方法：** 分子动力学 (MD) 并采用周期性边界条件。\n- **相互作用势：** 对相互作用 $u(r)$ 在有限截断半径 $r_c$ 处被截断。\n- **校正方法：** 考虑解析“尾部校正”。\n- **校正的核心假设：** 径向分布函数 $g(r) \\approx 1$ 对于 $r \\ge r_c$ 成立。\n- **势函数形式：**\n    1. 色散型：$u(r) \\sim C r^{-n}$，其中 $n$ 较大 (例如 $n=6$)。\n    2. 静电型：$u(r) \\propto r^{-1}$ (即 $n=1$)。\n- **背景：** 对于静电相互作用，通常使用专门的长程方法，如 Ewald 求和或 PPPM，而不是简单的尾部校正。\n- **问题：** 在 $d=3$ 空间维度下，推断 $u(r) \\sim C r^{-n}$ 的能量和压力尾部的收敛性，与 $u(r) \\propto r^{-1}$ 的情况进行对比，并评估所提供的陈述。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学基础：** 该问题牢固地建立在统计力学和计算物理学的原理之上。对势、径向分布函数、周期性边界条件、势截断、尾部校正以及短程（色散）与长程（库仑）力之间的区别等概念，都是分子模拟领域的基础。\n- **适定性：** 该问题是适定的。它要求对从标准物理模型推导出的特定积分的收敛性进行数学分析，然后利用此分析来评估一组命题。基于所提供的信息，可以进行唯一且稳定的分析。\n- **客观性：** 语言技术性强、精确且客观。\n- **缺陷检查清单：**\n    1.  **科学上不健全：** 无。前提在物理上和数学上都是健全的。\n    2.  **不可形式化/不相关：** 无。该问题与其所述主题直接相关。\n    3.  **不完整/矛盾：** 无。设定提供了进行分析所必需的物理模型（$u(r)$, $g(r) \\approx 1$）和背景。\n    4.  **不切实际/不可行：** 无。所描述的模型是现实世界模拟中使用的标准近似。\n    5.  **不适定：** 无。\n    6.  **伪深刻/琐碎：** 无。该问题需要进行非平凡的推导，并理解维度和势衰减如何相互作用。\n    7.  **超出科学可验证性：** 无。结论是可以通过数学推导得出的。\n\n**步骤3：结论和行动**\n问题陈述有效。我将继续进行推导和评估。\n\n### 原理推导\n\n**1. 能量尾部校正**\n\n一个包含 $N$ 个粒子、体积为 $V$、数密度为 $\\rho=N/V$ 的体系的总构型能 $U$，可以用对势 $u(r)$ 和径向分布函数 $g(r)$ 来表示。每个粒子的平均能量为：\n$$ \\frac{U}{N} = \\frac{1}{2} \\rho \\int_0^\\infty u(r) g(r) \\, 4\\pi r^2 \\, \\mathrm{d}r $$\n当势在 $r_c$ 处被截断时，被忽略的能量部分（“尾部”）对应于 $r  r_c$ 的相互作用。每个粒子的能量尾部校正 $U_{\\text{tail}}/N$ 就是这部分缺失的贡献。使用所给的近似 $g(r) \\approx 1$ (对于 $r \\ge r_c$)，我们有：\n$$ \\frac{U_{\\text{tail}}}{N} \\approx \\frac{1}{2} \\rho \\int_{r_c}^\\infty u(r) (1) \\, 4\\pi r^2 \\, \\mathrm{d}r = 2\\pi \\rho \\int_{r_c}^\\infty u(r) r^2 \\, \\mathrm{d}r $$\n对于形式为 $u(r) = C r^{-n}$ 的势：\n$$ \\frac{U_{\\text{tail}}}{N} = 2\\pi \\rho C \\int_{r_c}^\\infty r^{-n} r^2 \\, \\mathrm{d}r = 2\\pi \\rho C \\int_{r_c}^\\infty r^{2-n} \\, \\mathrm{d}r $$\n积分 $\\int r^{k} \\, \\mathrm{d}r$ 在积分上限为 $\\infty$ 时收敛的充要条件是，积分后函数的指数 $k+1$ 为负。这里，$k = 2-n$。因此，为了收敛，我们需要 $(2-n)+1  0$，简化后为 $3-n  0$，即 $n  3$。\n\n**2. 压力尾部校正**\n\n来自对相互作用的压力贡献由维里表达式给出。在均匀各向同性流体中，这个构型压力 $P_{\\text{conf}}$ 是：\n$$ P_{\\text{conf}} = - \\frac{2\\pi \\rho^2}{3} \\int_0^\\infty r^3 \\frac{\\mathrm{d}u}{\\mathrm{d}r} g(r) \\, \\mathrm{d}r $$\n压力的尾部校正 $P_{\\text{tail}}$ 对应于 $rr_c$ 的积分。同样，我们假设 $g(r) \\approx 1$：\n$$ P_{\\text{tail}} \\approx - \\frac{2\\pi \\rho^2}{3} \\int_{r_c}^\\infty r^3 \\frac{\\mathrm{d}u}{\\mathrm{d}r} \\, \\mathrm{d}r $$\n对于 $u(r) = C r^{-n}$，其导数为 $\\frac{\\mathrm{d}u}{\\mathrm{d}r} = -n C r^{-n-1}$。代入可得：\n$$ P_{\\text{tail}} = - \\frac{2\\pi \\rho^2}{3} \\int_{r_c}^\\infty r^3 (-nC r^{-n-1}) \\, \\mathrm{d}r = \\frac{2\\pi \\rho^2 nC}{3} \\int_{r_c}^\\infty r^{3-n-1} \\, \\mathrm{d}r = \\frac{2\\pi \\rho^2 nC}{3} \\int_{r_c}^\\infty r^{2-n} \\, \\mathrm{d}r $$\n压力尾部校正的积分与能量尾部校正中出现的积分 $\\int_{r_c}^\\infty r^{2-n} \\, \\mathrm{d}r$ 成正比。因此，它具有相同的收敛判据：$n  3$。\n\n**3. 推广到 $d$ 维**\n\n在 $d$ 维空间中，半径为 $r$ 的球壳的体积元与 $r^{d-1} \\mathrm{d}r$ 成正比。\n能量尾部积分变为与以下表达式成正比：\n$$ \\int_{r_c}^\\infty u(r) r^{d-1} \\, \\mathrm{d}r = \\int_{r_c}^\\infty (C r^{-n}) r^{d-1} \\, \\mathrm{d}r = C \\int_{r_c}^\\infty r^{d-1-n} \\, \\mathrm{d}r $$\n为了收敛，积分后项的指数必须为负：$(d-1-n)+1  0$，简化后为 $d-n  0$，即 $n  d$。\n\n### 选项评估\n\n**A. 在一个均匀流体中，对于在 $r_c$ 处截断的势 $u(r)=C r^{-n}$，每个粒子缺失的能量可以写成一个表现为 $\\int_{r_c}^\\infty r^{2-n}\\,\\mathrm{d}r$ 的积分，该积分仅在 $n3$ 时收敛。因此，对于 $n=6$ 的色散尾部，可以进行有限的能量尾部校正，而对于 $n=1$ 的库仑尾部则不行；这就是为什么静电相互作用要使用 Ewald 求和或粒子-粒子粒子-网格 (PPPM) 等长程求和方法，而不是简单的截断加尾部校正。**\n\n- 能量尾部的积分确实与 $\\int_{r_c}^\\infty r^{2-n}\\,\\mathrm{d}r$ 成正比。这是正确的。\n- 在 $d=3$ 维下的收敛条件是 $n3$。这是正确的。\n- 对于色散力，通常用 Lennard-Jones 势建模，其吸引项为 $r^{-6}$。由于 $n=6  3$，校正收敛。这是正确的。\n- 对于库仑力，$u(r) \\propto r^{-1}$，所以 $n=1$。由于 $1 \\ngtr 3$，积分发散。这是正确的。\n- 这种发散是为什么简单的尾部校正对静电相互作用不充分，从而需要更复杂的方法如 Ewald 或 PPPM 的根本原因。这也是正确的。\n- **结论：正确。**\n\n**B. 在 $d=3$ 维中，对于 $u(r)=C r^{-n}$，其压力尾部对任何 $n1$ 都收敛，即使能量尾部可能对更小的 $n$ 发散。因此，库仑相互作用 ($n=1$) 可以通过有限的压力尾部进行校正，而无需借助 Ewald 类型的方法。**\n\n- 我的推导表明，压力尾部积分与 $\\int_{r_c}^\\infty r^{2-n}\\,\\mathrm{d}r$ 成正比，这与能量尾部积分的形式相同。\n- 因此，收敛判据是相同的：$n3$。\n- 该陈述声称压力尾部对`任何 n1`都收敛，这是错误的。例如，对于 $n=2$，压力尾部积分是发散的。声称能量和压力尾部的收敛判据不同是错误的。\n- 因此，库仑相互作用 ($n=1$) 可以用有限的压力尾部进行校正的结论也是错误的，因为该积分发散。\n- **结论：不正确。**\n\n**C. 对于一个电中性的周期性体系，由于正负电荷的抵消，任何有限 $r_c$ 之外的库仑 ($n=1$) 能量尾部都精确为零，使得相应的积分绝对收敛；因此，对于静电相互作用，截断加有限尾部校正就足够了。**\n\n- 这个陈述是不正确的。虽然整个体系是电中性的，但局部电荷涨落是存在的，并且 $g(r) \\to 1$ 的假设在这里尤其不准确。更根本的是，周期性晶格中库仑相互作用的总和只是条件收敛的。其值取决于求和的顺序。\n- 简单的球形截断（尾部校正所隐含的）对应于一种特定的求和顺序，它不会收敛到物理上正确的能量。\n- 尾部不是“精确为零”，电中性也不会使积分“绝对收敛”。如果这是真的，Ewald 求和就没有必要了。\n- **结论：不正确。**\n\n**D. 在 $d=3$ 维中，发散阈值 $n\\le 3$ 源于三维球壳中的体积元 $r^2\\,\\mathrm{d}r$，这使得大 $r$ 处的被积函数按 $r^{2-n}$ 比例变化。更一般地，在 $d$ 维空间中，尾部积分仅在 $nd$ 时收敛。**\n\n- 陈述的第一部分正确地指出了收敛判据的来源。大 $r$ 处球壳中的总能量的被积函数是 $u(r) \\times (\\text{球壳中的粒子数}) \\propto r^{-n} \\times r^2 = r^{2-n}$。对该项的积分 $\\int r^{2-n} \\, \\mathrm{d}r$ 仅当原函数 ($3-n$) 的指数为负时才收敛，即 $n3$。因此发散阈值为 $n \\le 3$。这是正确的。\n- 陈述的第二部分正确地进行了推广。在 $d$ 维中，体积元与 $r^{d-1}\\mathrm{d}r$ 成比例，所以被积函数与 $r^{-n}r^{d-1} = r^{d-1-n}$ 成比例。收敛要求原函数的指数 $d-n$ 为负，从而得出条件 $nd$。这也是正确的。\n- **结论：正确。**\n\n**E. 粒子-粒子粒子-网格 (PPPM) 方法通过在 $r_c$ 处截断库仑势，并添加与色散相互作用所用的相同解析尾部校正来实现精确的静电计算，从而在不调用倒易空间计算的情况下精确地守恒能量。**\n\n- 这个陈述从根本上歪曲了 PPPM 方法。PPPM 是 Ewald 求和技术的一种实现。\n- 它将库仑相互作用分解为一个短程的实空间项和一个长程的倒易空间（k空间）项。\n- 虽然实空间部分被截断，但长程部分是使用网格（“mesh”）和快速傅里叶变换 (FFT) 在倒易空间中明确计算的。\n- PPPM 绝对*确实*涉及倒易空间计算；这是它的核心特征。它不使用本问题中讨论的简单解析尾部校正，正是因为对于 $n=1$，该校正会发散。\n- **结论：不正确。**", "answer": "$$\\boxed{AD}$$", "id": "3450965"}, {"introduction": "我们的解析推导依赖于一个关键近似：在截断距离之外，流体是无序的，即径向分布函数 $g(r) \\approx 1$。这最后一个练习 [@problem_id:3450980] 将理论与计算联系起来，要求你量化这一近似所引入的误差。你将使用理论上推导出的标度率作为基准，来衡量残余结构相关性带来的影响，这是验证模拟方法和理解其精度极限时的常见任务。", "problem": "考虑一个数密度为 $\\rho$ 的均匀各向同性流体，其相互作用通过球对称的、成对相加的势能 $u(r)$ 来描述，该势能在大间距 $r$ 处衰减为 $u(r)\\sim -C_6 r^{-6}$。在分子动力学（MD）模拟中，为了降低计算成本，通常会在一个有限的截断半径 $r_c$ 处截断势能 $u(r)$。截断会忽略掉间距 $rr_c$ 的粒子对的贡献，从而产生一部分缺失的势能。对于均匀流体，单位体积的势能可以通过对间距积分的形式，用对分布函数 $g(r)$ 来表示。当应用截断时，缺失的能量密度由一个在 $r\\ge r_c$ 上的积分来捕捉。\n\n从均匀各向同性流体势能的基本定义及其与径向分布函数（RDF）$g(r)$ 的关系出发，在 $rr_c$ 时 $g(r)=1$ 以及大间距 $r$ 处 $u(r)\\sim -C_6 r^{-6}$ 的近似下，推导单位体积的缺失势能对截断半径 $r_c$ 的主导阶依赖关系。您的推导必须从均匀流体构型能量密度的标准表达式（用 $g(r)$ 和 $u(r)$ 表示）开始，并通过数学上合理的步骤进行，不得引用任何预先推导好的尾部校正公式。\n\n然后，设计并实现一个计算基准测试，该测试在一系列 $r_c$ 值上进行变化，并量化当 $g(r)\\neq 1$ 时与所推导的标度关系的偏差。通过为 $r\\ge r_c$ 设定 $g(r)=1+h(r)$ 来模拟截断半径以外的偏差，其中 $h(r)$ 是一个受控的、衰减的振荡函数：\n$$\nh(r) = A \\exp\\!\\bigg(-\\frac{r-r_c}{\\xi}\\bigg)\\cos\\!\\big(k\\,(r-r_c)\\big),\\quad r\\ge r_c,\n$$\n其中 $A$ 为振幅，$\\xi$ 为相关长度，$k$ 为波数。此 $h(r)$ 严格用于 $r\\ge r_c$ 的情况，而对于 $r  r_c$ 的情况，假定 $h(r)$ 为零。\n\n您的任务是计算并报告在四个不同的测试用例下，通过对一系列 $r_c$ 值计算得到的“表观”标度系数 $s_{\\text{fit}}$（从 $y = s_{\\text{fit}}x$ 拟合得到，其中 $y = \\Delta U/V$ 且 $x=r_c^{-3}$）与理论标度系数 $s_{\\text{th}}$（从 $g(r)=1$ 的情况推导）之间的绝对相对偏差。将最终结果报告为一个包含四个浮点数的列表，每个浮点数对应一个测试用例，按顺序排列。", "solution": "该问题要求一个两部分的回应：首先，对截断对势中的势能进行主导阶尾部校正的正式推导；其次，设计并实现一个计算基准测试，用以量化当存在结构相关性时，与此主导阶理论的偏差。\n\n### 第一部分：主导阶尾部校正的推导\n\n一个体积为 $V$、包含 $N$ 个粒子的均匀各向同性流体的构型势能 $U$ 可以用对相互作用势 $u(r)$ 和径向分布函数 $g(r)$ 来表示。距离中心粒子为 $r$、厚度为 $dr$ 的球壳中的粒子数为 $\\rho g(r) 4\\pi r^2 dr$，其中 $\\rho = N/V$ 是数密度。这些粒子对中的每一对都对势能贡献 $u(r)$。对所有粒子对求和，并除以2以校正双重计数，总势能由下式给出：\n$$\nU = \\frac{1}{2} N \\int_0^\\infty u(r) \\rho g(r) 4\\pi r^2 dr\n$$\n单位体积的势能，即能量密度，通过除以 $V$ 得到：\n$$\n\\frac{U}{V} = \\frac{1}{2} \\frac{N}{V} \\rho \\int_0^\\infty u(r) g(r) 4\\pi r^2 dr = 2\\pi\\rho^2 \\int_0^\\infty u(r) g(r) r^2 dr\n$$\n在分子模拟中，势能通常在截断距离 $r_c$ 处被截断。这意味着间距 $r  r_c$ 的粒子对对能量的贡献被忽略了。这个缺失的势能密度，我们记作 $\\Delta U/V$，由从 $r_c$ 到无穷大的积分给出：\n$$\n\\frac{\\Delta U}{V} = 2\\pi\\rho^2 \\int_{r_c}^\\infty u(r) g(r) r^2 dr\n$$\n为了推导对 $r_c$ 的主导阶依赖关系，我们引入两个对大间距 $r$ 有效的标准近似，这包括了积分区间 $r \\ge r_c$（假设 $r_c$ 足够大）：\n1. 相互作用势按照色散相互作用的主导项衰减：$u(r) \\approx -C_6 r^{-6}$。\n2. 在大间距下，粒子间的相关性消失，因此径向分布函数趋近于1：$g(r) \\approx 1$。\n\n将这些近似代入缺失能量密度的表达式中，得到：\n$$\n\\frac{\\Delta U}{V} \\approx 2\\pi\\rho^2 \\int_{r_c}^\\infty (-C_6 r^{-6}) (1) r^2 dr\n$$\n我们可以将常数因子提出并计算这个基本积分：\n$$\n\\frac{\\Delta U}{V} \\approx -2\\pi\\rho^2 C_6 \\int_{r_c}^\\infty r^{-4} dr\n$$\n该积分为：\n$$\n\\int_{r_c}^\\infty r^{-4} dr = \\left[ \\frac{r^{-3}}{-3} \\right]_{r_c}^{\\infty} = \\lim_{b \\to \\infty} \\left( -\\frac{1}{3b^3} \\right) - \\left( -\\frac{1}{3r_c^3} \\right) = 0 + \\frac{1}{3r_c^3} = \\frac{1}{3}r_c^{-3}\n$$\n将此结果代回，我们得到主导阶尾部校正的最终表达式：\n$$\n\\frac{\\Delta U}{V} \\approx -2\\pi\\rho^2 C_6 \\left( \\frac{1}{3}r_c^{-3} \\right) = -\\frac{2\\pi}{3}\\rho^2 C_6 r_c^{-3}\n$$\n此推导确定了对于大的 $r_c$，缺失的能量密度按 $r_c^{-3}$ 标度。问题要求考虑关系式 $\\Delta U/V \\approx s\\, r_c^{-3}$。通过比较，我们确定理论上的比例常数（斜率）为：\n$$\ns_{\\text{th}} = -\\frac{2\\pi}{3}\\rho^2 C_6\n$$\n\n### 第二部分：结构相关性效应的计算分析\n\n上述推导依赖于 $r  r_c$ 时 $g(r)=1$ 的近似。实际上，结构相关性仍然存在，这意味着 $g(r)$ 可能偏离1。我们被给予了一个用于描述这种偏差的模型：\n$$\ng(r) = 1 + h(r), \\quad \\text{for } r \\ge r_c\n$$\n其中\n$$\nh(r) = A \\exp\\!\\bigg(-\\frac{r-r_c}{\\xi}\\bigg)\\cos\\!\\big(k\\,(r-r_c)\\big)\n$$\n那么，实际的缺失能量密度为：\n$$\n\\frac{\\Delta U}{V} = 2\\pi\\rho^2 \\int_{r_c}^\\infty u(r) (1+h(r)) r^2 dr\n$$\n使用 $u(r) = -C_6 r^{-6}$，我们可以将积分拆分为两部分：\n$$\n\\frac{\\Delta U}{V} = -2\\pi\\rho^2 C_6 \\int_{r_c}^\\infty r^{-4} dr - 2\\pi\\rho^2 C_6 \\int_{r_c}^\\infty r^{-4}h(r) dr\n$$\n第一项是主导阶贡献，我们已经对其进行了解析计算：\n$$\n\\left(\\frac{\\Delta U}{V}\\right)_{g=1} = -\\frac{2\\pi}{3}\\rho^2 C_6 r_c^{-3} = s_{\\text{th}} r_c^{-3}\n$$\n第二项是由于结构相关性引起的校正，我们将其表示为 $(\\Delta U/V)_h$：\n$$\n\\left(\\frac{\\Delta U}{V}\\right)_{h} = -2\\pi\\rho^2 C_6 \\int_{r_c}^\\infty r^{-4} A \\exp\\!\\bigg(-\\frac{r-r_c}{\\xi}\\bigg)\\cos\\!\\big(k\\,(r-r_c)\\big) dr\n$$\n这个积分没有简单的闭式解，必须进行数值计算。对于给定的 $r_c$，总的缺失能量密度是这两项之和。\n\n对于每个测试用例，计算算法按以下步骤进行：\n1.  计算理论斜率 $s_{\\text{th}} = -\\frac{2\\pi}{3}\\rho^2 C_6$。\n2.  对于给定集合中的每个截断半径 $r_{c,i}$，计算总的缺失能量密度 $y_i = \\Delta U/V(r_{c,i})$。\n    - 主导项是 $I_{1,i} = s_{\\text{th}} r_{c,i}^{-3}$。\n    - 校正项 $I_{2,i} = (\\Delta U/V)_h$ 是通过对其定义表达式从 $r_{c,i}$ 到 $\\infty$ 进行数值积分来计算的。被积函数性质良好，呈指数衰减，使得数值积分既高效又准确。\n    - 总能量为 $y_i = I_{1,i} + I_{2,i}$。\n3.  现在我们有了一组数据点 $(x_i, y_i)$，其中 $x_i = r_{c,i}^{-3}$。我们希望将这些数据拟合到模型 $y = s_{\\text{fit}} x$。对于过零点的线性回归，斜率 $s_{\\text{fit}}$ 的最小二乘估计由下式给出：\n    $$\n    s_{\\text{fit}} = \\frac{\\sum_i x_i y_i}{\\sum_i x_i^2}\n    $$\n4.  最后，计算拟合斜率与理论斜率之间的绝对相对偏差。这个值量化了当在一系列截断半径上拟合 $r_c^{-3}$ 标度关系时，由 $g(r)=1$ 近似所引入的系统误差。\n    $$\n    \\text{Deviation} = \\frac{|s_{\\text{fit}} - s_{\\text{th}}|}{|s_{\\text{th}}|}\n    $$\n所提供的 Python 代码实现了该算法，以确定四个测试用例中每一个的偏差。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Computes the deviation from theoretical scaling for tail corrections\n    in truncated potentials due to structural correlations.\n    \"\"\"\n    # Test cases: (rho, C6, A, xi, k, list_of_rc)\n    test_cases = [\n        (0.85, 1.0, 0.0, 1.0, 1.0, [1.2, 1.5, 2.0, 3.0]),\n        (0.85, 1.0, 0.1, 1.2, 4.0, [1.2, 1.5, 2.0, 3.0]),\n        (1.2, 0.75, 0.25, 0.8, 3.0, [1.0, 1.3, 1.8, 2.5]),\n        (0.30, 2.0, 0.05, 2.5, 1.0, [5.0, 7.0, 10.0, 15.0]),\n    ]\n\n    results = []\n    for case in test_cases:\n        rho, C6, A, xi, k, rcs = case\n\n        # 1. Calculate the theoretical slope s_th based on the g(r)=1 approximation.\n        # s_th corresponds to the proportionality constant in Delta_U/V = s * r_c^(-3).\n        s_th = -(2.0 / 3.0) * np.pi * rho**2 * C6\n\n        # Lists to store values for the least squares fit\n        y_values = []  # Total missing energy density, Delta_U/V\n        x_values = []  # r_c^(-3)\n\n        for rc in rcs:\n            # The independent variable for the fit is x = r_c^(-3)\n            x = np.power(rc, -3.0)\n            x_values.append(x)\n\n            # 2. Calculate the total missing energy density y = Delta_U/V(rc).\n            # This is split into a leading term (I1) and a corrective term (I2).\n\n            # The leading term (I1) is the analytical result assuming g(r)=1.\n            I1 = s_th * x\n\n            # The corrective term (I2) arises from the deviation h(r) = g(r) - 1.\n            # It is computed via numerical integration.\n            I2 = 0.0\n            if A != 0.0:\n                # Integrand for the corrective term (excluding constant prefactors).\n                # h(r) = A * exp(-(r-rc)/xi) * cos(k*(r-rc))\n                # Full integrand is r^(-4) * h(r)\n                integrand = lambda r: np.power(r, -4.0) * A * np.exp(-(r - rc) / xi) * np.cos(k * (r - rc))\n                \n                # Perform numerical integration from rc to infinity.\n                integral_val, _ = quad(integrand, rc, np.inf)\n                \n                # Multiply by the constant prefactor.\n                prefactor = -2.0 * np.pi * rho**2 * C6\n                I2 = prefactor * integral_val\n            \n            # The total missing energy density is the sum of the two terms.\n            y = I1 + I2\n            y_values.append(y)\n\n        # 3. Perform a least squares fit with zero intercept for y = s_fit * x.\n        x_arr = np.array(x_values)\n        y_arr = np.array(y_values)\n        \n        # The formula for the slope (s_fit) is dot(x,y) / dot(x,x).\n        s_fit = np.dot(x_arr, y_arr) / np.dot(x_arr, x_arr)\n        \n        # 4. Calculate the absolute relative deviation.\n        if s_th == 0:\n            # This case is not expected with the given test data, but is good practice.\n            # If s_th is 0, the deviation is infinite if s_fit is not 0.\n            deviation = np.inf if s_fit != 0 else 0.0\n        else:\n            deviation = np.abs(s_fit - s_th) / np.abs(s_th)\n        \n        results.append(deviation)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.15f}' for r in results)}]\")\n\nsolve()\n```", "id": "3450980"}]}