{"hands_on_practices": [{"introduction": "在我们能够控制温度之前，我们必须能够精确地测量它。任何恒温器的第一步都是根据系统的微观状态计算瞬时动能温度。这个实践练习将引导您计算一个由刚性线性分子组成的系统的瞬时温度，强调在存在约束（如移除系统总动量）的情况下，正确计算自由度的关键作用。通过这个练习，您将掌握在分子动力学模拟中定义和计算温度的基本原理，这是任何温度控制算法正常工作的前提。[@problem_id:3459751]", "problem": "考虑一个分子动力学（MD）模拟，其体系包含在一个周期性立方盒子中的 $N_{m}$ 个相同的刚性线性分子。MD积分器在每个时间步都移除全局质心漂移，这等效于将系统的总线动量约束为零。速度标定弱耦合恒温器所使用的瞬时动能温度 $T_{\\mathrm{kin}}$ 的定义是：将所有受控温的二次自由度的瞬时总动能与热能相等。\n\n对于刚性线性分子，动能由平动和转动两部分组成。转动能包括绕通过质心的两个相互垂直轴的转动；绕分子轴的转动不贡献能量，因为在经典层面上，其绕该轴的转动惯量可以忽略不计。\n\n从一个瞬时构型中，您记录了以下量：\n- 平动总和 $S_{v} \\equiv \\sum_{i=1}^{N_{m}} m_{i}\\,|\\mathbf{v}_{i}|^{2} = 6.60 \\times 10^{-18}$ J。\n- 转动总和 $S_{\\omega} \\equiv \\sum_{i=1}^{N_{m}} \\boldsymbol{\\omega}_{i}^{\\top}\\mathbf{I}_{i}\\,\\boldsymbol{\\omega}_{i} = 4.17 \\times 10^{-18}$ J。\n\n假设 $N_{m} = 512$，且只施加了全局质心约束（没有其他全局约束）。玻尔兹曼常数为 $k_{B} = 1.380649 \\times 10^{-23}$ J K$^{-1}$。\n\n从第一性原理出发，并对刚性线性分子的自由度进行适当计数，计算与速度标定弱耦合恒温器一致的瞬时动能温度 $T_{\\mathrm{kin}}$。将您的答案四舍五入到四位有效数字，并以开尔文为单位表示温度。", "solution": "在尝试求解之前，将首先验证问题的科学合理性、自洽性和清晰度。\n\n### 步骤1：提取已知条件\n\n- 分子数：$N_{m} = 512$\n- 分子类型：相同的刚性线性分子\n- 约束条件：总线动量为零（$\\sum_{i=1}^{N_{m}} m_{i} \\mathbf{v}_{i} = \\mathbf{0}$）\n- 每个分子的转动自由度：$2$（绕分子轴的转动可忽略）\n- 平动总和：$S_{v} \\equiv \\sum_{i=1}^{N_{m}} m_{i}\\,|\\mathbf{v}_{i}|^{2} = 6.60 \\times 10^{-18}$ J\n- 转动总和：$S_{\\omega} \\equiv \\sum_{i=1}^{N_{m}} \\boldsymbol{\\omega}_{i}^{\\top}\\mathbf{I}_{i}\\,\\boldsymbol{\\omega}_{i} = 4.17 \\times 10^{-18}$ J\n- 玻尔兹曼常数：$k_{B} = 1.380649 \\times 10^{-23}$ J K$^{-1}$\n- 瞬时动能温度（$T_{\\mathrm{kin}}$）的定义：满足受控温自由度的总瞬时动能与热能之间关系的量，类似于能量均分定理。\n\n### 步骤2：使用提取的已知条件进行验证\n\n依据所需标准对问题进行评估：\n\n- **科学依据**：该问题植根于经典统计力学和分子动力学（MD）模拟的基本原理。动能、自由度、约束以及恒温器动能温度的定义等概念在该领域都是标准且成熟的。\n- **适定性**：所有必要的数据（$N_m$、$S_v$、$S_\\omega$、$k_B$）和条件（刚性线性分子、总动量为零）均已提供，足以计算出唯一的瞬时动能温度值。\n- **客观性**：问题陈述使用了精确的量化语言，没有歧义或主观论断。\n\n该问题不存在任何列出的缺陷。这是一个标准的、自洽的物理问题，需要仔细计算自由度，这是统计力学中的一项常见任务。所提供的数值对于纳米尺度的模拟是物理上合理的。\n\n### 步骤3：结论与行动\n\n问题陈述是**有效的**。将提供解答。\n\n### 解答\n\n瞬时动能温度 $T_{\\mathrm{kin}}$ 的定义，是通过将系统的总瞬时动能 $K_{\\mathrm{total}}$ 与可用的（受控温的）二次自由度数 $N_{\\mathrm{dof}}$ 联系起来。这种关系是能量均分定理的一个瞬时应用：\n$$K_{\\mathrm{total}} = \\frac{1}{2} N_{\\mathrm{dof}} k_{B} T_{\\mathrm{kin}}$$\n为了求得 $T_{\\mathrm{kin}}$，我们必须首先根据所提供的信息确定 $K_{\\mathrm{total}}$ 和 $N_{\\mathrm{dof}}$。\n\n**1. 计算总瞬时动能 ($K_{\\mathrm{total}}$)**\n\n总动能是所有分子的平动动能和转动动能之和：\n$$K_{\\mathrm{total}} = K_{\\mathrm{trans}} + K_{\\mathrm{rot}}$$\n平动动能 $K_{\\mathrm{trans}}$ 由 $K_{\\mathrm{trans}} = \\sum_{i=1}^{N_{m}} \\frac{1}{2} m_{i} |\\mathbf{v}_{i}|^{2}$ 给出。使用所提供的平动总和 $S_{v} = \\sum_{i=1}^{N_{m}} m_{i} |\\mathbf{v}_{i}|^{2}$，我们有：\n$$K_{\\mathrm{trans}} = \\frac{1}{2} S_{v}$$\n对于刚体系统，转动动能 $K_{\\mathrm{rot}}$ 由 $K_{\\mathrm{rot}} = \\sum_{i=1}^{N_{m}} \\frac{1}{2} \\boldsymbol{\\omega}_{i}^{\\top}\\mathbf{I}_{i}\\,\\boldsymbol{\\omega}_{i}$ 给出。使用所提供的转动总和 $S_{\\omega} = \\sum_{i=1}^{N_{m}} \\boldsymbol{\\omega}_{i}^{\\top}\\mathbf{I}_{i}\\,\\boldsymbol{\\omega}_{i}$，我们有：\n$$K_{\\mathrm{rot}} = \\frac{1}{2} S_{\\omega}$$\n因此，总瞬时动能为：\n$$K_{\\mathrm{total}} = \\frac{1}{2} S_{v} + \\frac{1}{2} S_{\\omega} = \\frac{1}{2} (S_{v} + S_{\\omega})$$\n代入给定值：\n$$S_{v} = 6.60 \\times 10^{-18} \\, \\mathrm{J}$$\n$$S_{\\omega} = 4.17 \\times 10^{-18} \\, \\mathrm{J}$$\n$$K_{\\mathrm{total}} = \\frac{1}{2} (6.60 \\times 10^{-18} \\, \\mathrm{J} + 4.17 \\times 10^{-18} \\, \\mathrm{J}) = \\frac{1}{2} (10.77 \\times 10^{-18} \\, \\mathrm{J}) = 5.385 \\times 10^{-18} \\, \\mathrm{J}$$\n\n**2. 计算自由度数 ($N_{\\mathrm{dof}}$)**\n\n受控温的自由度数是动能表达式中二次项的总数减去施加于系统的约束数。\n\n对于一个包含 $N_{m}$ 个相同的刚性线性分子的系统：\n- 每个分子有 $3$ 个平动自由度，与其质心在三维空间中的运动相关。\n- 每个分子有 $2$ 个转动自由度，因为绕与分子对齐的主轴的转动在经典上可以忽略。\n因此，对于一个无约束的系统，总自由度数将是 $(3 + 2)N_m = 5 N_m$。\n\n问题陈述施加了一个约束：全局质心漂移被移除。这等效于将系统的总线动量设置为零：\n$$\\sum_{i=1}^{N_{m}} m_{i} \\mathbf{v}_{i} = \\mathbf{0}$$\n这是一个矢量方程，它对系统的速度施加了 $3$ 个独立的标量约束（每个笛卡尔分量 $x, y, z$ 各一个）。这些约束使平动自由度的数量减少了 $3$。转动自由度不受此约束的影响。\n\n因此，受控温的自由度数为：\n$$N_{\\mathrm{dof}} = (\\text{总自由度}) - (\\text{约束数})$$\n$$N_{\\mathrm{dof}} = (3 N_{m} + 2 N_{m}) - 3 = 5 N_{m} - 3$$\n代入给定值 $N_{m} = 512$：\n$$N_{\\mathrm{dof}} = 5(512) - 3 = 2560 - 3 = 2557$$\n\n**3. 计算瞬时动能温度 ($T_{\\mathrm{kin}}$)**\n\n现在我们重新整理 $T_{\\mathrm{kin}}$ 的定义方程：\n$$T_{\\mathrm{kin}} = \\frac{2 K_{\\mathrm{total}}}{N_{\\mathrm{dof}} k_{B}}$$\n代入计算出的 $K_{\\mathrm{total}}$、$N_{\\mathrm{dof}}$ 的值以及给定的 $k_{B}$ 值：\n$$K_{\\mathrm{total}} = 5.385 \\times 10^{-18} \\, \\mathrm{J}$$\n$$N_{\\mathrm{dof}} = 2557$$\n$$k_{B} = 1.380649 \\times 10^{-23} \\, \\mathrm{J}\\,\\mathrm{K}^{-1}$$\n$$T_{\\mathrm{kin}} = \\frac{2 \\times (5.385 \\times 10^{-18})}{2557 \\times (1.380649 \\times 10^{-23})} = \\frac{1.077 \\times 10^{-17}}{3.530347 \\times 10^{-19}} \\, \\mathrm{K}$$\n$$T_{\\mathrm{kin}} \\approx 305.068... \\, \\mathrm{K}$$\n\n问题要求将答案四舍五入到四位有效数字。\n$$T_{\\mathrm{kin}} \\approx 305.1 \\, \\mathrm{K}$$\n这就是与弱耦合恒温器所用定义一致的系统瞬时动能温度。", "answer": "$$\n\\boxed{305.1}\n$$", "id": "3459751"}, {"introduction": "在理解了如何定义温度之后，我们将探讨弱耦合恒温器的核心机制。这个实践问题将 Berendsen 恒温器建模为一个一级弛豫过程，使系统温度向目标值指数衰减。通过推导并求解温度随时间演化的离散方程，您将定量地理解耦合时间常数 $\\tau_T$ 和时间步长 $\\Delta t$ 等参数如何共同决定模拟中温度平衡的速度。[@problem_id:3459750]", "problem": "在一次使用弱耦合 (Berendsen) 恒温器的恒温分子动力学 (MD) 模拟中，瞬时动能温度根据能量均分定理定义为与总动能成正比，因此将所有速度按因子 $\\lambda$ 缩放会使温度缩放 $\\lambda^{2}$ 倍。弱耦合恒温器旨在以弛豫时间 $\\tau_{T}$ 将动能温度向目标温度 $T_{0}$ 进行一阶弛豫。考虑一个时间步长为 $\\Delta t$ 的时间离散化，并令 $T_{n}$ 表示经过 $n$ 次恒温器应用后的动能温度，其初始值为 $T_{0\\text{,init}}=T(0)=T_{i}$。\n\n从牛顿力学的基本定律、能量均分定理以及通过在每个离散时间的速度重缩放步骤实现的目标温度一阶弛豫原理出发，推导 $T_{n}$ 的离散时间更新关系，并解出其闭式解，从而得到 $T_{n}$ 作为 $n$、$T_{i}$、$T_{0}$、$\\Delta t$ 和 $\\tau_{T}$ 的函数。然后，确定确保 $\\lvert T_{n}-T_{0}\\rvert\\le \\varepsilon$ 所需的最小整数步数 $n$。\n\n使用以下符合物理实际的参数：$T_{0}=300\\,\\mathrm{K}$、$T_{i}=800\\,\\mathrm{K}$、$\\Delta t=2\\,\\mathrm{fs}$、$\\tau_{T}=0.2\\,\\mathrm{ps}$ 和 $\\varepsilon=2\\,\\mathrm{K}$。仅报告最小整数 $n$ 作为最终答案。除了确定这个最小整数外，不需要根据有效数字进行舍入。将任何中间温度以 $\\mathrm{K}$ 为单位表示，时间酌情以 $\\mathrm{fs}$ 或 $\\mathrm{ps}$ 为单位表示。", "solution": "该问题是有效的，因为它以分子动力学和统计力学的原理为科学基础，问题适定，目标明确，数据充分，且表述客观。\n\nBerendsen 恒温器旨在以特征弛豫时间 $\\tau_{T}$ 强制系统温度 $T$ 向目标温度 $T_{0}$ 进行一阶动力学弛豫。其底层的连续动力学由以下微分方程描述：\n$$\n\\frac{dT}{dt} = \\frac{T_{0} - T}{\\tau_{T}}\n$$\n在具有离散时间步长 $\\Delta t$ 的分子动力学模拟中，对此方程进行简单的前向欧拉离散化，可得到基于第 $n$ 步温度 $T_{n}$ 更新至第 $n+1$ 步温度 $T_{n+1}$ 的规则：\n$$\n\\frac{T_{n+1} - T_{n}}{\\Delta t} = \\frac{T_{0} - T_{n}}{\\tau_{T}}\n$$\n这可以重新整理以直接表示 $T_{n+1}$：\n$$\nT_{n+1} = T_{n} + \\frac{\\Delta t}{\\tau_{T}} (T_{0} - T_{n})\n$$\n此更新在物理上是通过在每一步将所有粒子速度按因子 $\\lambda$ 进行缩放来实现的。动能温度 $T$ 与总动能成正比，而总动能是速度的二次函数。因此，将速度缩放 $\\lambda$ 倍会使温度缩放 $\\lambda^{2}$ 倍：$T_{n+1} = \\lambda_{n}^{2} T_{n}$。选择缩放因子 $\\lambda_{n}$ 以满足离散化的弛豫方程。\n\n我们定义常数比率 $r = \\frac{\\Delta t}{\\tau_{T}}$。递推关系变为：\n$$\nT_{n+1} = T_{n} + r(T_{0} - T_{n}) = (1-r)T_{n} + rT_{0}\n$$\n这是一个一阶线性非齐次递推关系。为求解此关系，我们可以通过设置 $T_{n+1} = T_{n} = T_{eq}$ 来找到不动点，这给出 $T_{eq} = (1-r)T_{eq} + rT_{0}$，从而得到 $rT_{eq} = rT_{0}$，因此平衡温度 $T_{eq} = T_{0}$，与预期相符。\n\n我们定义一个新变量 $\\delta_{n} = T_{n} - T_{0}$，表示与目标温度的偏差。将 $T_{n} = \\delta_{n} + T_{0}$ 代入递推关系：\n$$\n(\\delta_{n+1} + T_{0}) = (1-r)(\\delta_{n} + T_{0}) + rT_{0}\n$$\n$$\n\\delta_{n+1} + T_{0} = (1-r)\\delta_{n} + (1-r)T_{0} + rT_{0}\n$$\n$$\n\\delta_{n+1} + T_{0} = (1-r)\\delta_{n} + T_{0}\n$$\n$$\n\\delta_{n+1} = (1-r)\\delta_{n}\n$$\n这是一个简单的等比数列。其解为 $\\delta_{n} = (1-r)^{n} \\delta_{0}$。\n初始偏差为 $\\delta_{0} = T(0) - T_{0} = T_{i} - T_{0}$，其中 $T_{i}$ 是初始温度。\n代回后，我们得到第 $n$ 步偏差的表达式：\n$$\nT_{n} - T_{0} = (T_{i} - T_{0})(1-r)^{n}\n$$\n因此，$T_{n}$ 的闭式解为：\n$$\nT_{n} = T_{0} + (T_{i} - T_{0}) \\left( 1 - \\frac{\\Delta t}{\\tau_{T}} \\right)^{n}\n$$\n问题要求找到最小整数步数 $n$，以确保系统温度与目标温度之间的绝对差小于或等于容差 $\\varepsilon$：\n$$\n|T_{n} - T_{0}| \\le \\varepsilon\n$$\n使用推导出的 $T_{n} - T_{0}$ 表达式：\n$$\n\\left| (T_{i} - T_{0}) \\left( 1 - \\frac{\\Delta t}{\\tau_{T}} \\right)^{n} \\right| \\le \\varepsilon\n$$\n给定的参数为：\n- 初始温度 $T_{i}=800\\,\\mathrm{K}$\n- 目标温度 $T_{0}=300\\,\\mathrm{K}$\n- 时间步长 $\\Delta t=2\\,\\mathrm{fs}$\n- 弛豫时间 $\\tau_{T}=0.2\\,\\mathrm{ps} = 200\\,\\mathrm{fs}$\n- 温度容差 $\\varepsilon=2\\,\\mathrm{K}$\n\n首先，我们来计算各项的值。初始温差为 $T_{i} - T_{0} = 800\\,\\mathrm{K} - 300\\,\\mathrm{K} = 500\\,\\mathrm{K}$。这是一个正值。\n时间尺度之比为 $r = \\frac{\\Delta t}{\\tau_{T}} = \\frac{2\\,\\mathrm{fs}}{200\\,\\mathrm{fs}} = 0.01$。\n项 $(1 - \\frac{\\Delta t}{\\tau_{T}}) = 1 - 0.01 = 0.99$。此项为正且小于1。\n所以，不等式可以写成不带绝对值符号的形式：\n$$\n(T_{i} - T_{0}) \\left( 1 - \\frac{\\Delta t}{\\tau_{T}} \\right)^{n} \\le \\varepsilon\n$$\n我们需要解出 $n$：\n$$\n\\left( 1 - \\frac{\\Delta t}{\\tau_{T}} \\right)^{n} \\le \\frac{\\varepsilon}{T_{i} - T_{0}}\n$$\n对两边取自然对数：\n$$\nn \\ln\\left( 1 - \\frac{\\Delta t}{\\tau_{T}} \\right) \\le \\ln\\left( \\frac{\\varepsilon}{T_{i} - T_{0}} \\right)\n$$\n由于 $1 - \\frac{\\Delta t}{\\tau_{T}}  1$，其对数为负。因此，当我们除以 $\\ln(1 - \\frac{\\Delta t}{\\tau_{T}})$ 时，必须反转不等号方向：\n$$\nn \\ge \\frac{\\ln\\left( \\frac{\\varepsilon}{T_{i} - T_{0}} \\right)}{\\ln\\left( 1 - \\frac{\\Delta t}{\\tau_{T}} \\right)}\n$$\n现在，我们代入数值：\n$$\nn \\ge \\frac{\\ln\\left( \\frac{2}{800 - 300} \\right)}{\\ln\\left( 1 - \\frac{2}{200} \\right)}\n$$\n$$\nn \\ge \\frac{\\ln\\left( \\frac{2}{500} \\right)}{\\ln\\left( 1 - 0.01 \\right)}\n$$\n$$\nn \\ge \\frac{\\ln(0.004)}{\\ln(0.99)}\n$$\n使用计算器计算对数值：\n$$\n\\ln(0.004) \\approx -5.52146\n$$\n$$\n\\ln(0.99) \\approx -0.01005\n$$\n所以，$n$ 的不等式为：\n$$\nn \\ge \\frac{-5.52146}{-0.01005} \\approx 549.399\n$$\n由于 $n$ 必须是表示模拟步数的整数，我们必须取满足此条件的最小整数。这是计算值的向上取整。\n$$\nn_{min} = \\lceil 549.399 \\rceil = 550\n$$\n因此，需要最少 550 次恒温器应用（步）才能将温度偏差带入指定容差范围内。", "answer": "$$\n\\boxed{550}\n$$", "id": "3459750"}, {"introduction": "虽然速度标度恒温器因其简单和在平衡阶段的有效性而广受欢迎，但它们并非没有缺陷。这个思想实验使用一个简化的谐振晶体模型，来探究一个关键的理论问题：恒温器对系统自然动力学的非物理性干扰。通过分析周期性速度标度如何不成比例地影响不同振动模式的能量，您将揭示为什么这类方法可能无法生成真正的正则系综，并可能导致“飞行的冰块”等著名的人为现象。[@problem_id:3459746]", "problem": "考虑一个通过分子动力学 (MD) 模拟的一维谐振子晶体，它由 $N$ 个质量为 $m$ 的相同粒子组成，这些粒子通过谐振子最近邻相互作用耦合。\n\n在简正模变换下，每个由 $j$ 索引的模式都作为一个独立的谐振子演化，其坐标为 $q_j(t)$，速度为 $v_j(t)$，角频率为 $\\omega_j$，并遵循牛顿第二定律 $m\\,\\mathrm{d}^2 q_j/\\mathrm{d}t^2 = -\\partial U/\\partial q_j$，其中谐振势能为 $U = \\frac{1}{2} m \\omega_j^2 q_j^2$。\n\n一种弱耦合 (WC) 类型的全局速度标度恒温器以周期 $\\tau_s$ 周期性地施加：在时间 $t_k = k \\tau_s$（对于整数 $k \\ge 1$），所有粒子的速度被瞬时乘以相同的常数标度因子 $\\lambda$（其中 $0  \\lambda \\neq 1$ 是一个固定的值）。这意味着每个简正模的速度变换为 $v_j(t_k^{+}) = \\lambda\\, v_j(t_k^{-})$，而位置 $q_j(t)$ 在标度事件前后保持连续。\n\n假设单个简正模 $j$ 在标度事件之间进行谐振运动，其解为 $q_j(t) = A_j \\cos(\\omega_j t + \\phi_j)$ 和 $v_j(t) = -A_j \\omega_j \\sin(\\omega_j t + \\phi_j)$，其中 $A_j$ 和 $\\phi_j$ 是由初始条件决定的常数。将标度事件发生前瞬间的模式能量定义为 $E_j(t_k^{-}) = \\frac{1}{2} m \\left[\\omega_j^2 q_j(t_k^{-})^2 + v_j(t_k^{-})^2\\right]$，发生后瞬间的能量定义为 $E_j(t_k^{+}) = \\frac{1}{2} m \\left[\\omega_j^2 q_j(t_k^{+})^2 + v_j(t_k^{+})^2\\right]$。\n\n你需要分析周期性的全局速度标度如何扰动简正模能量的弛豫。具体而言：\n\n- 从基本谐振子解和能量定义出发，推导每次事件的能量倍增因子 $r_j(\\theta_k) \\equiv E_j(t_k^{+})/E_j(t_k^{-})$，用相位 $\\theta_k \\equiv \\omega_j t_k + \\phi_j$ 和标度因子 $\\lambda$ 表示。\n- 对于由于 $\\omega_j \\tau_s$ 的不可通约性导致其相位在标度时刻在 $[0,2\\pi)$ 上均匀采样的模式，通过对 $\\theta_k$ 平均 $\\ln r_j(\\theta_k)$ 来计算每次事件的几何平均能量倍增因子 $r_{\\mathrm{avg}}$。\n- 根据 $\\omega_j$ 和 $\\tau_s$ 之间的可通约性，简要指出哪些频率模式在产生最大的相干单次事件能量变化方面受周期性标度的影响最强。\n\n将你的最终答案表示为每次事件的几何平均能量倍增因子 $r_{\\mathrm{avg}}$ 作为 $\\lambda$ 的函数的单个闭式解析表达式，无需进行数值计算。所求量为无量纲量，因此不需要单位。不要在最终答案框中提供任何中间结果。", "solution": "首先验证问题，以确保其在科学上成立、适定、客观，并包含足够的信息以得到唯一解。\n\n**步骤 1：提取已知条件**\n- 系统：一维谐振子晶体，包含 $N$ 个质量为 $m$ 的相同粒子。\n- 相互作用：谐振子最近邻相互作用。\n- 模型：每个简正模 $j$ 是一个独立的谐振子，具有坐标 $q_j(t)$、速度 $v_j(t)$ 和角频率 $\\omega_j$。\n- 势能：$U = \\frac{1}{2} m \\omega_j^2 q_j^2$。\n- 事件间解：$q_j(t) = A_j \\cos(\\omega_j t + \\phi_j)$ 和 $v_j(t) = -A_j \\omega_j \\sin(\\omega_j t + \\phi_j)$。\n- 恒温器：周期为 $\\tau_s$ 的周期性全局速度标度。\n- 标度时间：$t_k = k \\tau_s$，对于整数 $k \\ge 1$。\n- 标度规则：$v_j(t_k^{+}) = \\lambda\\, v_j(t_k^{-})$，其中 $0  \\lambda \\neq 1$。\n- 连续性条件：$q_j(t)$ 是连续的，因此 $q_j(t_k^{+}) = q_j(t_k^{-})$。\n- 能量定义：$E_j(t) = \\frac{1}{2} m \\left[\\omega_j^2 q_j(t)^2 + v_j(t)^2\\right]$。\n- 任务1：推导能量倍增因子 $r_j(\\theta_k) \\equiv E_j(t_k^{+})/E_j(t_k^{-})$，其中 $\\theta_k \\equiv \\omega_j t_k + \\phi_j$。\n- 任务2：通过在 $[0, 2\\pi)$ 上对 $\\theta_k$ 的均匀分布平均 $\\ln r_j(\\theta_k)$ 来计算几何平均值 $r_{\\mathrm{avg}}$。\n- 任务3：根据可通约性确定受影响最强的模式。\n- 最终答案：$r_{\\mathrm{avg}}$ 作为 $\\lambda$ 的函数的闭式表达式。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题在科学上是合理的，它使用一种著名但简化的模拟技术（弱耦合恒温器）来模拟一个标准的物理系统（谐振子晶体）。简正模和谐振子的数学框架是标准的。该问题是适定的，提供了执行所要求的推导和计算所需的所有必要定义和条件。明确说明了不可通约模式的相位相对于均匀采样的假设，这是平均过程的必要条件。语言客观而精确。该问题不违反任何无效性标准。\n\n**步骤 3：结论与行动**\n问题有效。将提供完整解答。\n\n**解答推导**\n\n首先，我们推导每次事件的能量倍增因子 $r_j(\\theta_k)$。对于单个简正模 $j$，为使推导过程中的符号清晰，我们将省略下标 $j$。在标度时间 $t_k$，相位为 $\\theta_k = \\omega t_k + \\phi$。\n\n在 $t=t_k$ 的标度事件发生前瞬间的位置和速度是：\n$$q(t_k^{-}) = A \\cos(\\omega t_k + \\phi) = A \\cos(\\theta_k)$$\n$$v(t_k^{-}) = -A \\omega \\sin(\\omega t_k + \\phi) = -A \\omega \\sin(\\theta_k)$$\n\n标度发生前模式的能量是 $E(t_k^{-})$。由于谐振子能量在标度事件之间是守恒的，这也是模式在区间 $(t_{k-1}, t_k)$ 内的总能量。\n$$E(t_k^{-}) = \\frac{1}{2} m \\left[\\omega^2 q(t_k^{-})^2 + v(t_k^{-})^2\\right]$$\n$$E(t_k^{-}) = \\frac{1}{2} m \\left[\\omega^2 \\left(A \\cos(\\theta_k)\\right)^2 + \\left(-A \\omega \\sin(\\theta_k)\\right)^2\\right]$$\n$$E(t_k^{-}) = \\frac{1}{2} m A^2 \\omega^2 \\left[\\cos^2(\\theta_k) + \\sin^2(\\theta_k)\\right] = \\frac{1}{2} m A^2 \\omega^2$$\n\n标度事件发生后瞬间，位置是连续的，而速度乘以因子 $\\lambda$：\n$$q(t_k^{+}) = q(t_k^{-}) = A \\cos(\\theta_k)$$\n$$v(t_k^{+}) = \\lambda v(t_k^{-}) = -\\lambda A \\omega \\sin(\\theta_k)$$\n\n标度后模式的能量是 $E(t_k^{+})$：\n$$E(t_k^{+}) = \\frac{1}{2} m \\left[\\omega^2 q(t_k^{+})^2 + v(t_k^{+})^2\\right]$$\n$$E(t_k^{+}) = \\frac{1}{2} m \\left[\\omega^2 \\left(A \\cos(\\theta_k)\\right)^2 + \\left(-\\lambda A \\omega \\sin(\\theta_k)\\right)^2\\right]$$\n$$E(t_k^{+}) = \\frac{1}{2} m A^2 \\omega^2 \\left[\\cos^2(\\theta_k) + \\lambda^2 \\sin^2(\\theta_k)\\right]$$\n\n每次事件的能量倍增因子 $r_j(\\theta_k)$ 是这些能量的比率：\n$$r_j(\\theta_k) = \\frac{E_j(t_k^{+})}{E_j(t_k^{-})} = \\frac{\\frac{1}{2} m A_j^2 \\omega_j^2 \\left[\\cos^2(\\theta_k) + \\lambda^2 \\sin^2(\\theta_k)\\right]}{\\frac{1}{2} m A_j^2 \\omega_j^2} = \\cos^2(\\theta_k) + \\lambda^2 \\sin^2(\\theta_k)$$\n这完成了任务的第一部分。\n\n接下来，我们计算每次事件的几何平均能量倍增因子 $r_{\\mathrm{avg}}$。这通过对相位 $\\theta_k \\in [0, 2\\pi)$ 的均匀分布求 $r_j(\\theta_k)$ 的对数的平均值来定义。\n$$\\ln(r_{\\mathrm{avg}}) = \\langle \\ln(r_j(\\theta_k)) \\rangle_{\\theta_k}$$\n令 $\\theta$ 代表相位变量。平均值由积分计算：\n$$\\ln(r_{\\mathrm{avg}}) = \\frac{1}{2\\pi} \\int_0^{2\\pi} \\ln\\left(\\cos^2(\\theta) + \\lambda^2 \\sin^2(\\theta)\\right) d\\theta$$\n\n这个积分，我们称之为 $I$，是一个标准的定积分。\n$$I = \\int_0^{2\\pi} \\ln\\left(\\cos^2(\\theta) + \\lambda^2 \\sin^2(\\theta)\\right) d\\theta$$\n被积函数周期为 $\\pi$，且关于 $\\theta=\\pi/2$ 对称，所以我们可以写成：\n$$I = 4 \\int_0^{\\pi/2} \\ln\\left(\\cos^2(\\theta) + \\lambda^2 \\sin^2(\\theta)\\right) d\\theta$$\n我们使用这类积分的已知恒等式：\n$$\\int_0^{\\pi/2} \\ln\\left(a^2 \\cos^2(x) + b^2 \\sin^2(x)\\right) dx = \\pi \\ln\\left(\\frac{a+b}{2}\\right) \\quad \\text{对于 } a > 0, b > 0$$\n在我们的例子中，$a^2=1$ 所以 $a=1$，以及 $b^2=\\lambda^2$ 所以 $b=\\lambda$（因为给定 $0  \\lambda$）。\n应用此恒等式：\n$$\\int_0^{\\pi/2} \\ln\\left(\\cos^2(\\theta) + \\lambda^2 \\sin^2(\\theta)\\right) d\\theta = \\pi \\ln\\left(\\frac{1+\\lambda}{2}\\right)$$\n将此代回 $I$ 的表达式：\n$$I = 4 \\left[ \\pi \\ln\\left(\\frac{1+\\lambda}{2}\\right) \\right] = 4\\pi \\ln\\left(\\frac{1+\\lambda}{2}\\right)$$\n现在我们可以找到 $\\ln(r_{\\mathrm{avg}})$：\n$$\\ln(r_{\\mathrm{avg}}) = \\frac{1}{2\\pi} I = \\frac{4\\pi}{2\\pi} \\ln\\left(\\frac{1+\\lambda}{2}\\right) = 2 \\ln\\left(\\frac{1+\\lambda}{2}\\right)$$\n为了找到 $r_{\\mathrm{avg}}$，我们对两边取指数：\n$$r_{\\mathrm{avg}} = \\exp\\left(2 \\ln\\left(\\frac{1+\\lambda}{2}\\right)\\right) = \\exp\\left(\\ln\\left(\\left(\\frac{1+\\lambda}{2}\\right)^2\\right)\\right)$$\n$$r_{\\mathrm{avg}} = \\left(\\frac{1+\\lambda}{2}\\right)^2$$\n这就给出了几何平均因子的闭式解析表达式。\n\n最后，我们简要地确定受周期性标度影响最强的模式。前面的计算假设相位 $\\theta_k = \\omega_j t_k + \\phi_j$ 是均匀分布的，这种情况发生在模式频率 $\\omega_j$ 和标度周期 $\\tau_s$ 不可通约时。\n\n对于可通约模式，会出现相干的、非随机的效应，其相位演化 $\\theta_{k+1} = \\theta_k + \\omega_j \\tau_s \\pmod{2\\pi}$ 以一个短周期呈周期性。这发生在 $\\omega_j \\tau_s$ 是 $\\pi$ 的有理数倍时。最强的相干性发生在每次标度事件中相位都相同时，即 $\\omega_j \\tau_s = 2\\pi n$ (对于某个整数 $n$）。如果 $\\omega_j \\tau_s = n\\pi$，也会出现类似强度的相干效应，这会导致能量因子 $r_j(\\theta_k)$ 在每一步都相同。\n\n每次事件能量变化的大小由 $r_j(\\theta_k) = \\cos^2(\\theta_k) + \\lambda^2 \\sin^2(\\theta_k)$ 离 1 的距离决定。该函数的极值出现在：\n- $\\theta_k = n\\pi$ (转折点): $r_j = \\cos^2(n\\pi) + \\lambda^2 \\sin^2(n\\pi) = 1$。这对应于零速度，因此标度没有效果。这是最小的能量变化。\n- $\\theta_k = (n+\\frac{1}{2})\\pi$ (平衡点穿越): $r_j = \\cos^2((n+\\frac{1}{2})\\pi) + \\lambda^2 \\sin^2((n+\\frac{1}{2})\\pi) = \\lambda^2$。由于 $\\lambda \\neq 1$，这给出了与 1 的最大偏差。\n\n因此，受影响最强的模式是那些可通约的模式（其中 $\\omega_j\\tau_s$ 是 $\\pi$ 的有理数倍，最简单的情况是 $\\omega_j \\tau_s = n\\pi$），其初始相位 $\\phi_j$ 使得标度事件 $t_k$ 始终与振子的最大速度（即通过平衡位置 $q_j=0$）相吻合。", "answer": "$$\\boxed{\\left(\\frac{1+\\lambda}{2}\\right)^{2}}$$", "id": "3459746"}]}