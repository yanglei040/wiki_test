{"hands_on_practices": [{"introduction": "不同的分子动力学力场，如 AMBER 和 CHARMM，在计算细节上存在差异，尤其是在 1-4 相互作用和长程相互作用的处理上。本练习通过一个具体的计算，揭示了在未考虑这些惯例差异的情况下直接移植参数所导致的能量计算错误。理解这些差异对于在模拟中正确使用和比较不同力场的结果至关重要。", "problem": "一位开发者希望测试在化学哈佛大分子力学（CHARMM）和辅助模型构建与能量精修（AMBER）规范之间移植参数时，由互操作性引起的转移误差，重点关注 1-4 处理方法和长程切换函数的差异。考虑一个简单碳氢化合物中的一个分子内 1-4 对，其非键参数值如下：部分电荷 $q_i = -0.10\\,e$，$q_j = +0.10\\,e$，原子间距 $r_{ij} = 4.00\\,\\text{\\AA}$，Lennard-Jones 势阱深度 $\\epsilon_i = 0.10\\,\\text{kcal mol}^{-1}$ 和 $\\epsilon_j = 0.12\\,\\text{kcal mol}^{-1}$，以及 Lennard-Jones 直径 $\\sigma_i = 3.50\\,\\text{\\AA}$ 和 $\\sigma_j = 3.75\\,\\text{\\AA}$。假设使用 Lorentz-Berthelot 组合规则来获得混合的 Lennard-Jones 参数。在 AMBER 中，默认的 1-4 缩放应用于非键项，静电作用的缩放因子为 $s_{\\text{elec}} = 1/1.2$，Lennard-Jones 作用的缩放因子为 $s_{\\text{LJ}} = 1/2$，而在 CHARMM 中，1-4 非键项未经缩放。对于体相凝聚相，假设两种引擎使用相同的非键参数和截断半径 $r_{\\text{cut}}$，但 AMBER 应用长程校正来解释截断的 Lennard-Jones 势尾，而 CHARMM 采用一种力切换函数，在 $r_{\\text{switch}}$ 和 $r_{\\text{cut}}$ 之间平滑地减小 Lennard-Jones 相互作用，且没有单独的解析长程校正。仅使用静电和色散作用的基本定义，以及对均相液体的物理上合理的近似（例如，径向分布函数 $g(r)$ 在 $r_{\\text{switch}}$ 之外接近 $1$），判断下列哪些陈述是正确的。\n\nA. 将上述 AMBER 参数移植到 CHARMM 中而不实现 AMBER 的 1-4 缩放时，与 AMBER 相比，指定原子对的分子内 1-4 非键能在 CHARMM 中变得更具吸引力（更负），大约相差 $-0.19\\,\\text{kcal mol}^{-1}$。\n\nB. 在均相液体中，在所有其他条件相同的情况下，用 CHARMM 的力切换方法（无长程校正）取代 AMBER 的 Lennard-Jones 截断加解析长程校正方法，将导致每个粒子的平均 Lennard-Jones 能量吸引力减弱（负值减小）。\n\nC. AMBER 和 CHARMM 之间 1-4 缩放的差异可以通过将所有二面角势垒高度乘以 $1/1.2$ 来完全补偿，同时保持非键参数不变，从而恢复相同的分子内能量学。\n\nD. 在 CHARMM 中运行 AMBER 参数集时，为最小化互操作性引起的转移误差，一个合理的纠正措施是在 CHARMM 中启用 AMBER 风格的 1-4 缩放（使用 $s_{\\text{elec}} = 1/1.2$ 和 $s_{\\text{LJ}} = 1/2$），并添加一个与 Lennard-Jones 形式和所用截断半径一致的解析长程校正；或者，需要根据 CHARMM 的切换规范进行重新参数化。\n\nE. AMBER 和 CHARMM 之间转移误差的一个根本来源是，AMBER 对 $\\sigma$ 使用 Lorentz-Berthelot 组合规则（算术平均），而 CHARMM 对 $\\sigma$ 使用几何组合规则，因此即使在其他输入完全相同的情况下，两个引擎中 1-4 对的混合 Lennard-Jones 直径也不同。", "solution": "用户希望我验证问题陈述，如果有效，则提供详细的解决方案。\n\n### 步骤1：提取给定条件\n- **力场：** 化学哈佛大分子力学（CHARMM）和辅助模型构建与能量精修（AMBER）。\n- **重点：** 由 1-4 处理方法和长程切换函数的差异引起的互操作性转移误差。\n- **体系：** 一个简单碳氢化合物中的一个分子内 1-4 对。\n- **1-4 对的参数：**\n    - 部分电荷：$q_i = -0.10\\,e$, $q_j = +0.10\\,e$。\n    - 原子间距：$r_{ij} = 4.00\\,\\text{\\AA}$。\n    - Lennard-Jones 势阱深度：$\\epsilon_i = 0.10\\,\\text{kcal mol}^{-1}$, $\\epsilon_j = 0.12\\,\\text{kcal mol}^{-1}$。\n    - Lennard-Jones 直径：$\\sigma_i = 3.50\\,\\text{\\AA}$, $\\sigma_j = 3.75\\,\\text{\\AA}$。\n- **组合规则：** 假设使用 Lorentz-Berthelot 组合规则。\n- **1-4 相互作用缩放：**\n    - **AMBER：** 静电作用按 $s_{\\text{elec}} = 1/1.2$ 缩放。Lennard-Jones 作用按 $s_{\\text{LJ}} = 1/2$ 缩放。\n    - **CHARMM：** 非键项未经缩放（即缩放因子为 $1$）。\n- **长程处理（体相）：**\n    - 两种引擎使用相同的非键参数和截断半径 $r_{\\text{cut}}$。\n    - **AMBER：** 对截断的 Lennard-Jones 势尾应用解析长程校正。\n    - **CHARMM：** 在 $r_{\\text{switch}}$ 和 $r_{\\text{cut}}$ 之间采用力切换函数；没有单独的解析长程校正。\n- **近似：** 对于均相液体，径向分布函数 $g(r)$ 在 $r > r_{\\text{switch}}$ 时接近 $1$。\n\n### 步骤2：使用提取的给定条件进行验证\n根据验证标准评估问题陈述。\n\n- **科学依据：** 该问题牢固地植根于分子力学和计算化学的原理。对 AMBER 和 CHARMM 力场的描述，包括它们在 1-4 相互作用和长程静电/范德华力方面的不同惯例，是对该领域标准实践的准确表述。Lennard-Jones 和库仑势、Lorentz-Berthelot 组合规则以及长程校正概念的使用都是分子动力学模拟的基础。提供的数值在物理上是合理的。\n- **提法明确：** 该问题提供了执行所需计算和概念分析的所有必要数据和定义。选项中提出的问题是具体的，可以根据所提供的信息和已建立的物理原理来回答。\n- **客观性：** 语言技术性强、精确，且没有主观或含糊的术语。它以中立、事实的方式描述了两个主要力场的不同惯例。\n\n### 步骤3：结论和行动\n问题陈述是**有效的**。这是一个计算化学领域中提法良好的问题，用于测试对常见力场实现的理解。接下来进行解题推导和选项分析。\n\n### 解题推导\n\n两个非键合原子 $i$ 和 $j$ 之间的总非键势能 $U_{\\text{nonbond}}$ 是静电（库仑）势和 Lennard-Jones（LJ）势的总和：\n$$U_{\\text{nonbond}} = U_{\\text{elec}} + U_{\\text{LJ}}$$\n静电势由下式给出：\n$$U_{\\text{elec}} = k_e \\frac{q_i q_j}{r_{ij}}$$\n其中 $k_e$ 是库仑常数，在分子模拟所用的单位中约为 $332.0637\\,\\text{kcal mol}^{-1}\\text{\\AA}\\,e^{-2}$。\nLennard-Jones 势由下式给出：\n$$U_{\\text{LJ}} = 4\\epsilon_{ij} \\left[ \\left(\\frac{\\sigma_{ij}}{r_{ij}}\\right)^{12} - \\left(\\frac{\\sigma_{ij}}{r_{ij}}\\right)^6 \\right]$$\n问题陈述中说明使用 Lorentz-Berthelot 组合规则来获得混合相互作用的参数：\n$$\\sigma_{ij} = \\frac{\\sigma_i + \\sigma_j}{2}$$\n$$\\epsilon_{ij} = \\sqrt{\\epsilon_i \\epsilon_j}$$\n首先，我们根据给定的原子参数计算混合 LJ 参数 $\\sigma_{ij}$ 和 $\\epsilon_{ij}$：\n$\\sigma_i = 3.50\\,\\text{\\AA}$，$\\sigma_j = 3.75\\,\\text{\\AA}$。\n$\\epsilon_i = 0.10\\,\\text{kcal mol}^{-1}$，$\\epsilon_j = 0.12\\,\\text{kcal mol}^{-1}$。\n$$\\sigma_{ij} = \\frac{3.50\\,\\text{\\AA} + 3.75\\,\\text{\\AA}}{2} = 3.625\\,\\text{\\AA}$$\n$$\\epsilon_{ij} = \\sqrt{(0.10\\,\\text{kcal mol}^{-1})(0.12\\,\\text{kcal mol}^{-1})} = \\sqrt{0.012}\\,\\text{kcal mol}^{-1} \\approx 0.1095445\\,\\text{kcal mol}^{-1}$$\n接下来，我们计算给定的 1-4 对在 $q_i = -0.10\\,e$，$q_j = +0.10\\,e$ 和 $r_{ij} = 4.00\\,\\text{\\AA}$ 条件下未经缩放的静电和 LJ 势能。\n$$U_{\\text{elec}} = (332.0637\\,\\text{kcal mol}^{-1}\\text{\\AA}\\,e^{-2}) \\frac{(-0.10\\,e)(+0.10\\,e)}{4.00\\,\\text{\\AA}} = -0.830159\\,\\text{kcal mol}^{-1}$$\n对于 LJ 势，比率 $\\frac{\\sigma_{ij}}{r_{ij}} = \\frac{3.625}{4.00} = 0.90625$。\n$$U_{\\text{LJ}} = 4(0.1095445) \\left[ (0.90625)^{12} - (0.90625)^6 \\right]$$\n$$U_{\\text{LJ}} = 0.438178 \\left[ 0.370357 - 0.608570 \\right] = 0.438178 (-0.238213) = -0.104374\\,\\text{kcal mol}^{-1}$$\n\n现在，我们计算在 AMBER 中实现的 1-4 能量，以及如果将 AMBER 参数未经修改地用于 CHARMM 中时的能量。\n\n**AMBER 1-4 能量：**\nAMBER 对 1-4 相互作用进行缩放：$s_{\\text{elec}} = 1/1.2$ 和 $s_{\\text{LJ}} = 1/2 = 0.5$。\n$$U_{1-4, \\text{AMBER}} = s_{\\text{elec}} U_{\\text{elec}} + s_{\\text{LJ}} U_{\\text{LJ}}$$\n$$U_{1-4, \\text{AMBER}} = \\left(\\frac{1}{1.2}\\right)(-0.830159\\,\\text{kcal mol}^{-1}) + (0.5)(-0.104374\\,\\text{kcal mol}^{-1})$$\n$$U_{1-4, \\text{AMBER}} = -0.691799\\,\\text{kcal mol}^{-1} - 0.052187\\,\\text{kcal mol}^{-1} = -0.743986\\,\\text{kcal mol}^{-1}$$\n\n**CHARMM 1-4 能量（使用未修改的 AMBER 参数）：**\nCHARMM 不对 1-4 非键相互作用进行缩放（即 $s_{\\text{elec}} = 1$ 和 $s_{\\text{LJ}} = 1$）。\n$$U_{1-4, \\text{CHARMM}} = (1.0) U_{\\text{elec}} + (1.0) U_{\\text{LJ}}$$\n$$U_{1-4, \\text{CHARMM}} = -0.830159\\,\\text{kcal mol}^{-1} - 0.104374\\,\\text{kcal mol}^{-1} = -0.934533\\,\\text{kcal mol}^{-1}$$\n\n### 逐项分析选项\n\n**A. 将上述 AMBER 参数移植到 CHARMM 中而不实现 AMBER 的 1-4 缩放时，与 AMBER 相比，指定原子对的分子内 1-4 非键能在 CHARMM 中变得更具吸引力（更负），大约相差 $-0.19\\,\\text{kcal mol}^{-1}$。**\n为了评估这一点，我们计算差值 $\\Delta U = U_{1-4, \\text{CHARMM}} - U_{1-4, \\text{AMBER}}$。\n$$\\Delta U = (-0.934533\\,\\text{kcal mol}^{-1}) - (-0.743986\\,\\text{kcal mol}^{-1}) = -0.190547\\,\\text{kcal mol}^{-1}$$\nCHARMM 中的能量（$-0.9345\\,\\text{kcal mol}^{-1}$）确实比 AMBER 中的（$-0.7440\\,\\text{kcal mol}^{-1}$）更具吸引力（更负）。差值约为 $-0.19\\,\\text{kcal mol}^{-1}$。该陈述与我们的计算一致。\n**结论：正确。**\n\n**B. 在均相液体中，在所有其他条件相同的情况下，用 CHARMM 的力切换方法（无长程校正）取代 AMBER 的 Lennard-Jones 截断加解析长程校正方法，将导致每个粒子的平均 Lennard-Jones 能量吸引力减弱（负值减小）。**\nAMBER 的方法包括在 $r_{\\text{cut}}$ 处截断 LJ 势，然后添加一个解析长程校正（LRC）来解释截断半径之外粒子贡献的平均场能量。能量的 LRC 由 $U_{\\text{LRC}} = 2\\pi N\\rho \\int_{r_{\\text{cut}}}^{\\infty} U_{\\text{LJ}}(r) g(r) r^2 dr$ 给出。假设对于 $r > r_{\\text{cut}}$，$g(r) \\approx 1$，该积分可以被计算。由于 LJ 势在所有相关的长程距离上都是吸引的，所以 $U_{\\text{LRC}}$ 是一个负的（吸引的）能量项。\nCHARMM 的力切换方法在切换区域（$r_{\\text{switch}}  < r <  r_{\\text{cut}}$）内修改势和力，使它们在 $r_{\\text{cut}}$ 处平滑地变为零。这种方法固有地忽略了 $r_{\\text{cut}}$ 之外的任何相互作用，并且不包括一个单独的 LRC 项。\n因此，用 CHARMM 的方案（切换无 LRC）取代 AMBER 的方案（截断+LRC）意味着移除了吸引性的 $U_{\\text{LRC}}$ 项。这将导致总势能的吸引力减弱（负值减小，或更正）。\n**结论：正确。**\n\n**C. AMBER 和 CHARMM 之间 1-4 缩放的差异可以通过将所有二面角势垒高度乘以 $1/1.2$ 来完全补偿，同时保持非键参数不变，从而恢复相同的分子内能量学。**\n这个陈述是错误的，主要有两个原因。首先，AMBER 的 1-4 处理涉及两个不同的缩放因子：静电作用的 $s_{\\text{elec}} = 1/1.2$ 和 Lennard-Jones 作用的 $s_{\\text{LJ}} = 1/2$。提议用单一因子 $1/1.2$ 来缩放二面角势垒，不可能补偿两种不同的效应。其次，1-4 非键相互作用的能量贡献对二面角 $\\phi$ 具有特定的、复杂的函数依赖关系（通过距离 $r_{14}(\\phi)$），这通常与二面角势本身的周期形式（$U_{\\text{dihedral}} \\propto \\sum k_n(1+\\cos(n\\phi - \\delta_n))$）不同。简单地缩放二面角能量项 $U_{\\text{dihedral}}$ 无法复制非键项差异的函数形式，即 $(1-s_{\\text{elec}})U_{\\text{elec}}(\\phi) + (1-s_{\\text{LJ}})U_{\\text{LJ}}(\\phi)$。要吸收这些差异，需要对二面角项进行全面的重新参数化，而不仅仅是简单的缩放。\n**结论：错误。**\n\n**D. 在 CHARMM 中运行 AMBER 参数集时，为最小化互操作性引起的转移误差，一个合理的纠正措施是在 CHARMM 中启用 AMBER 风格的 1-4 缩放（使用 $s_{\\text{elec}} = 1/1.2$ 和 $s_{\\text{LJ}} = 1/2$），并添加一个与 Lennard-Jones 形式和所用截断半径一致的解析长程校正；或者，需要根据 CHARMM 的切换规范进行重新参数化。**\n该陈述描述了处理力场互操作性的两种主要有效策略。第一种策略是让目标模拟引擎（CHARMM）尽可能地模仿源力场（AMBER）的惯例。这包括使用 AMBER 的 1-4 缩放因子及其长程处理方法（截断加 LRC）。大多数现代模拟软件包都足够灵活，可以实现这一点。第二种策略是接受参数和函数形式是一个整体。如果希望使用 CHARMM 的原生惯例（例如，力切换），那么 AMBER 参数就不再适用，必须通过使用 CHARMM 的函数形式拟合参考数据（例如，量子力学计算或实验结果）来重新推导（重新参数化）。这两种方法在该领域都被认为是合理的做法。\n**结论：正确。**\n\n**E. AMBER 和 CHARMM 之间转移误差的一个根本来源是，AMBER 对 $\\sigma$ 使用 Lorentz-Berthelot 组合规则（算术平均），而 CHARMM 对 $\\sigma$ 使用几何组合规则，因此即使在其他输入完全相同的情况下，两个引擎中 1-4 对的混合 Lennard-Jones 直径也不同。**\n这个陈述包含一个事实错误。标准的 AMBER 和标准的 CHARMM 力场都使用 Lorentz-Berthelot（LB）组合规则。LB 规则指定直径 $\\sigma_{ij}$ 使用算术平均 $\\sigma_{ij} = (\\sigma_i + \\sigma_j)/2$，势阱深度 $\\epsilon_{ij}$ 使用几何平均 $\\epsilon_{ij} = \\sqrt{\\epsilon_i \\epsilon_j}$。虽然其他力场（如 OPLS）对 $\\sigma$ 和 $\\epsilon$ 都使用几何平均，但标准 CHARMM 并非如此。因此，AMBER 和 CHARMM 在 $\\sigma$ 的组合规则上没有分歧，这也不是转移误差的来源。\n**结论：错误。**", "answer": "$$\\boxed{ABD}$$", "id": "3457750"}, {"introduction": "标准的混合规则，如 Lorentz-Berthelot 规则，本质上是一种近似，在处理化学上不相似的原子对时可能会失效。本练习探讨了一个典型案例——离子与水分子的相互作用——并教授了如何诊断这种失效背后的物理原因。它将引导你理解，为了弥补非极化模型中缺失的物理效应（如诱导极化），为何以及如何对力场参数进行特殊优化。", "problem": "许多经典分子动力学（MD）力场的一个核心假设是，不同种类 $i$ 和 $j$ 之间的 Lennard-Jones (LJ) 交叉作用参数可以通过 Lorentz–Berthelot 组合规则从纯组分参数构建，即 $\\sigma_{ij} = (\\sigma_i + \\sigma_j)/2$ 和 $\\epsilon_{ij} = \\sqrt{\\epsilon_i \\epsilon_j}$。考虑一个非极化水模型中的离子-溶剂相互作用，其中水中的氧原子由一个 LJ 位点描述，其参数为 $\\sigma_{\\mathrm{O}}$ 和 $\\epsilon_{\\mathrm{O}}$，并带有用于静电作用的部分电荷。LJ 对势为 $U_{ij}^{\\mathrm{LJ}}(r) = 4 \\epsilon_{ij} \\left[ \\left( \\frac{\\sigma_{ij}}{r} \\right)^{12} - \\left( \\frac{\\sigma_{ij}}{r} \\right)^{6} \\right]$，其最小值在 $r_{\\min} = 2^{1/6} \\sigma_{ij}$ 处。在连续介电质中，电荷为 $z = \\pm 1$ 的单价离子的水合热力学可以通过 Born 水合模型来近似，即 $\\Delta G_{\\mathrm{hyd}} \\approx - \\frac{z^2 e^2}{8 \\pi \\varepsilon_0 r_i} \\left( 1 - \\frac{1}{\\varepsilon} \\right)$，其中 $r_i$ 是有效离子半径，$e$ 是元电荷，$\\varepsilon_0$ 是真空介电常数，$\\varepsilon$ 是溶剂的介电常数。在分子液体中，第一壳层的离子-氧接触距离还受到电致伸缩和短程诱导效应的影响；电荷 $q$ 与各向同性极化率为 $\\alpha$ 的可极化分子之间的主导诱导相互作用为 $U_{\\mathrm{ind}}(r) \\approx - \\frac{\\alpha q^2}{2 r^4}$，这种作用在非极化固定电荷水模型中是不存在的，必须通过所选的非键参数来间接表示。\n\n假设你必须仅使用两个预测变量来诊断 Lorentz–Berthelot 规则何时对离子-水氧交叉作用不再具有可移植性：离子半径 $r_i$ 和测量的水合自由能 $\\Delta G_{\\mathrm{hyd}}$。设 $\\sigma_{\\mathrm{O}} \\approx 3.15\\,\\mathrm{\\AA}$ 是常见水模型的典型值，并设氧的范德华接触尺度为 $r_{\\mathrm{vdW,O}} \\sim \\sigma_{\\mathrm{O}}/2$。你事先不知道纯组分离子的 LJ 参数，但可以根据第一性原理对相对大小和趋势进行推理。你的目标是确定正确的定性诊断方法，以及在非极化模型中为了恢复真实的离子-氧接触和水合热力学，所需对 Lorentz–Berthelot 规则的偏离方向。\n\n以下哪个选项最能捕捉到在非极化水中，离子-氧对的 Lorentz–Berthelot 规则失效的正确条件，以及对 $\\sigma_{ij}$ 和 $\\epsilon_{ij}$ 所需的正确修正？\n\nA. 当 $r_i$ 小且 $\\lvert \\Delta G_{\\mathrm{hyd}} \\rvert$ 大时，Lorentz–Berthelot 规则低估了离子-氧的吸引力并高估了接触距离：应选择 $\\sigma_{ij}  (\\sigma_i + \\sigma_{\\mathrm{O}})/2$ 和 $\\epsilon_{ij} > \\sqrt{\\epsilon_i \\epsilon_{\\mathrm{O}}}$。\n\nB. 当 $r_i$ 大且 $\\lvert \\Delta G_{\\mathrm{hyd}} \\rvert$ 大时，由于色散作用随尺寸的标度关系，Lorentz–Berthelot 规则低估了离子-氧的吸引力；应选择 $\\sigma_{ij} > (\\sigma_i + \\sigma_{\\mathrm{O}})/2$ 和 $\\epsilon_{ij}  \\sqrt{\\epsilon_i \\epsilon_{\\mathrm{O}}}$。\n\nC. 如果 $r_i$ 小，仅凭 $\\Delta G_{\\mathrm{hyd}}  0$ 这个符号就足以保证 Lorentz–Berthelot 规则的可移植性；不需要偏离 $\\sigma_{ij} = (\\sigma_i + \\sigma_{\\mathrm{O}})/2$ 或 $\\epsilon_{ij} = \\sqrt{\\epsilon_i \\epsilon_{\\mathrm{O}}}$。\n\nD. Lorentz–Berthelot 规则的可移植性与 $r_i$ 无关，只要 $\\lvert \\Delta G_{\\mathrm{hyd}} \\rvert$ 很小；因此唯一可能需要的修正总是对所有离子采用 $\\epsilon_{ij}  \\sqrt{\\epsilon_i \\epsilon_{\\mathrm{O}}}$。", "solution": "用户希望我验证问题陈述，如果有效，则提供详细的解决方案。\n\n### 问题验证\n\n**第 1 步：提取已知条件**\n\n*   **模型：** 经典分子动力学（MD）非极化水模型。\n*   **相互作用分量：**\n    *   Lennard–Jones (LJ) 对势：$U_{ij}^{\\mathrm{LJ}}(r) = 4 \\epsilon_{ij} \\left[ \\left( \\frac{\\sigma_{ij}}{r} \\right)^{12} - \\left( \\frac{\\sigma_{ij}}{r} \\right)^{6} \\right]$。\n    *   通过部分电荷实现的静电作用。\n*   **Lorentz–Berthelot (LB) 组合规则：**\n    *   $\\sigma_{ij} = (\\sigma_i + \\sigma_j)/2$\n    *   $\\epsilon_{ij} = \\sqrt{\\epsilon_i \\epsilon_j}$\n*   **体系：** 一个单价离子（$z = \\pm 1$）与水相互作用。水中的氧原子是一个 LJ 位点，其参数为 $\\sigma_{\\mathrm{O}}$ 和 $\\epsilon_{\\mathrm{O}}$。\n*   **物理性质与关系：**\n    *   LJ 势的最小值出现在 $r_{\\min} = 2^{1/6} \\sigma_{ij}$。\n    *   Born 水合模型近似：$\\Delta G_{\\mathrm{hyd}} \\approx - \\frac{z^2 e^2}{8 \\pi \\varepsilon_0 r_i} \\left( 1 - \\frac{1}{\\varepsilon} \\right)$，其中 $r_i$ 是有效离子半径。\n    *   非极化模型中缺失的物理效应：诱导相互作用，其主导项为 $U_{\\mathrm{ind}}(r) \\approx - \\frac{\\alpha q^2}{2 r^4}$。\n*   **任务预测变量与数据：**\n    *   LB 规则失效的预测变量：离子半径 $r_i$ 和测量的水合自由能 $\\Delta G_{\\mathrm{hyd}}$。\n    *   水氧尺寸参数的典型值：$\\sigma_{\\mathrm{O}} \\approx 3.15\\,\\mathrm{\\AA}$。\n    *   氧接触半径的尺度：$r_{\\mathrm{vdW,O}} \\sim \\sigma_{\\mathrm{O}}/2$。\n*   **目标：** 确定 LB 规则失效的条件，以及为弥补模型缺陷所需的 $\\sigma_{ij}$ 和 $\\epsilon_{ij}$ 的调整方向。\n\n**第 2 步：使用提取的已知条件进行验证**\n\n1.  **科学依据：** 该问题牢固地植根于物理化学和计算生物物理学的原理。它解决的是经典力场发展中一个众所周知且至关重要的问题：离子-水相互作用的参数化。简单的组合规则的失效，以及需要创建能够隐式地解释缺失物理效应（如电子极化（诱导））的“有效势”，是该领域的核心课题。所呈现的所有模型和方程（$U^{\\mathrm{LJ}}$、Born 模型、$U_{\\mathrm{ind}}$）都是标准的且表述正确。\n2.  **问题的适定性：** 这是一个适定问题。它要求对一个物理现象及其导致的参数化策略进行定性分析。所提供的信息足以根据第一性原理推导出趋势和所需校正的方向。\n3.  **客观性：** 语言客观、技术性强，没有偏见。\n4.  **完整性与一致性：** 问题是自洽的。通过 Born 模型将 $r_i$ 和 $\\Delta G_{\\mathrm{hyd}}$ 联系起来，为使用两者作为预测变量提供了一个一致的框架。问题的核心在于理解模型中缺失的物理相互作用（$U_{\\mathrm{ind}}$），以及如何通过调整现有的势能项（$U^{\\mathrm{LJ}}$）来模仿其效应。没有矛盾之处。\n5.  **现实性：** 这个场景非常现实。在常见的非极化水模型（如 TIP3P, SPC/E）中，离子的参数化往往需要显著偏离 LB 规则，原因正是题目中所述。$\\sigma_{\\mathrm{O}} \\approx 3.15\\,\\mathrm{\\AA}$ 的值确实是这类模型的代表。\n\n**第 3 步：结论与行动**\n\n问题陈述是有效的。它在科学上是合理的、适定的、客观的，并且描述了分子模拟中的一个真实挑战。我将继续进行求解推导。\n\n### 求解推导\n\n该问题要求我们确定在非极化力场中，Lorentz–Berthelot (LB) 组合规则何时对离子-水相互作用失效，以及如何校正 Lennard-Jones (LJ) 参数（$\\sigma_{ij}$ 和 $\\epsilon_{ij}$）以获得更真实的行为。\n\n1.  **识别缺失的物理效应：** 问题明确指出，非极化固定电荷水模型中缺失的一个关键相互作用是诱导作用。电荷为 $q$ 的离子与极化率为 $\\alpha$ 的可极化分子（水）之间的诱导能的主导项由 $U_{\\mathrm{ind}}(r) \\approx - \\frac{\\alpha q^2}{2 r^4}$ 给出。这是一种强的、短程的吸引相互作用。它的缺失是该模型的主要缺陷。\n\n2.  **确定缺失的物理效应在何时最为重要：** 诱导能的大小与 $q^2$ 和 $r^{-4}$ 成比例。由于我们考虑的是单价离子（$z=\\pm 1$，因此 $q^2=e^2$ 是常数），决定这种相互作用强度的主要因素是离子-水的距离 $r$。固有尺寸较小（有效离子半径 $r_i$ 较小）的离子可以更靠近水分子。这导致在水分子位置产生更强的电场，因此产生更大的诱导能。\n\n3.  **与给定的预测变量关联：** 问题给出了两个预测变量：离子半径 $r_i$ 和水合自由能 $\\Delta G_{\\mathrm{hyd}}$。Born 模型 $\\Delta G_{\\mathrm{hyd}} \\approx - \\frac{z^2 e^2}{8 \\pi \\varepsilon_0 r_i} \\left( 1 - \\frac{1}{\\varepsilon} \\right)$ 显示了这两个量之间的直接关系。小的离子半径 $r_i$ 对应于大的（负的）水合自由能的绝对值 $\\lvert \\Delta G_{\\mathrm{hyd}} \\rvert$。因此，“小 $r_i$”这一条件等价于“大 $\\lvert \\Delta G_{\\mathrm{hyd}} \\rvert$”。这正是在忽略了诱导效应的情况下，非极化模型预计会失效最严重的区域。\n\n4.  **分析缺失相互作用的后果：** 如果没有吸引性的 $U_{\\mathrm{ind}}(r)$ 项，一个使用标准 LB 参数的非极化模型将不正确地描述离子-水相互作用，特别是在与小离子相关的短距离上。\n    *   **低估吸引力：** 由于缺少一个显著的吸引贡献，离子-水相互作用的总势能阱会过浅。\n    *   **高估接触距离：** 强的短程诱导吸引力会将第一壳层水分子拉得比静电作用和标准 LJ 势所预测的更靠近离子。因此，缺乏这种效应的模型将预测一个过大的平衡离子-氧距离，该距离与 $r_{\\min} = 2^{1/6} \\sigma_{ij}$ 相关。\n\n5.  **推导必要的校正：** 为了补偿缺失的物理效应，必须调整现有势能项的参数。部分电荷通常被固定以重现体相水的性质，因此校正的负担落在了交叉相互作用的 LJ 参数 $\\sigma_{ij}$ 和 $\\epsilon_{ij}$ 上。\n    *   **为校正被低估的吸引力：** LJ 势阱的深度由 $\\epsilon_{ij}$ 给出。为了使相互作用更具吸引力并加深势阱，我们必须**增加 $\\epsilon_{ij}$**。因此，最优值将大于 LB 的预测值：$\\epsilon_{ij} > \\sqrt{\\epsilon_i \\epsilon_{\\mathrm{O}}}$。\n    *   **为校正被高估的距离：** 势能最小值的位置，也就是接触距离，与 $\\sigma_{ij}$ 成正比。为了减小预测的离子-氧距离，使模拟的水分子更靠近离子，我们必须**减小 $\\sigma_{ij}$**。因此，最优值将小于 LB 的预测值：$\\sigma_{ij}  (\\sigma_i + \\sigma_{\\mathrm{O}})/2$。\n\n**结论：** 对于具有高电荷密度的小离子（小 $r_i$，大 $\\lvert \\Delta G_{\\mathrm{hyd}} \\rvert$），LB 规则预计会失效。非极化模型会低估吸引力并高估接触距离。为了补偿，必须使用比 LB 规则建议的更小的 $\\sigma_{ij}$ 和更大的 $\\epsilon_{ij}$。这创建了一个“更紧密、更深”的有效势，模仿了缺失的短程诱导效应。\n\n### 逐项分析\n\n**A. 当 $r_i$ 小且 $\\lvert \\Delta G_{\\mathrm{hyd}} \\rvert$ 大时，Lorentz–Berthelot 规则低估了离子-氧的吸引力并高估了接触距离：应选择 $\\sigma_{ij}  (\\sigma_i + \\sigma_{\\mathrm{O}})/2$ 和 $\\epsilon_{ij} > \\sqrt{\\epsilon_i \\epsilon_{\\mathrm{O}}}$。**\n该选项正确地指出了失效条件（小 $r_i$，大 $\\lvert \\Delta G_{\\mathrm{hyd}} \\rvert$），正确地诊断了未校正模型中产生的误差（低估吸引力，高估距离），并提出了正确的参数调整方向（减小 $\\sigma_{ij}$，增大 $\\epsilon_{ij}$）。这与我们的推导完全一致。\n**结论：正确。**\n\n**B. 当 $r_i$ 大且 $\\lvert \\Delta G_{\\mathrm{hyd}} \\rvert$ 大时，由于色散作用随尺寸的标度关系，Lorentz–Berthelot 规则低估了离子-氧的吸引力；应选择 $\\sigma_{ij} > (\\sigma_i + \\sigma_{\\mathrm{O}})/2$ 和 $\\epsilon_{ij}  \\sqrt{\\epsilon_i \\epsilon_{\\mathrm{O}}}$。**\n根据 Born 模型，前提“大 $r_i$ 且大 $\\lvert \\Delta G_{\\mathrm{hyd}} \\rvert$”在物理上是不一致的。此外，小离子的主要失效原因是缺失的诱导作用，而不是色散标度。所提出的校正与模仿诱导作用所需的方向相反。\n**结论：不正确。**\n\n**C. 如果 $r_i$ 小，仅凭 $\\Delta G_{\\mathrm{hyd}}  0$ 这个符号就足以保证 Lorentz–Berthelot 规则的可移植性；不需要偏离 $\\sigma_{ij} = (\\sigma_i + \\sigma_{\\mathrm{O}})/2$ 或 $\\epsilon_{ij} = \\sqrt{\\epsilon_i \\epsilon_{\\mathrm{O}}}$。**\n这与正确结论相反。$r_i$ 小的情况正是 LB 规则已知失效最显著的地方。条件 $\\Delta G_{\\mathrm{hyd}}  0$ 是无意义的，因为离子的水合是自发过程。\n**结论：不正确。**\n\n**D. Lorentz–Berthelot 规则的可移植性与 $r_i$ 无关，只要 $\\lvert \\Delta G_{\\mathrm{hyd}} \\rvert$ 很小；因此唯一可能需要的修正总是对所有离子采用 $\\epsilon_{ij}  \\sqrt{\\epsilon_i \\epsilon_{\\mathrm{O}}}$。**\n可移植性与 $r_i$ 密切相关。$\\lvert \\Delta G_{\\mathrm{hyd}} \\rvert$ 小的条件对应于大 $r_i$，此时诱导作用较弱，LB 规则表现更好，而不是更差。所提出的校正，即普遍减小 $\\epsilon_{ij}$，会削弱吸引力，这与考虑缺失的吸引性诱导相互作用所需的方向相反。\n**结论：不正确。**", "answer": "$$\\boxed{A}$$", "id": "3457823"}, {"introduction": "在理解了参数可移植性的陷阱之后，本综合性练习让你能够亲自参与到力场的验证工作中。这个实践将指导你通过编程，实现并基准测试几种替代的 Lennard-Jones 混合规则，并将它们的预测结果与高精度的参考数据进行比较。这是一项计算化学领域的核心技能，旨在定量评估和提高参数在不同化学环境中的预测准确性。", "problem": "您的任务是在分子动力学（MD）中构建和基准测试 Lennard-Jones（LJ）势的异类对混合规则，以评估力场参数在异质混合物中的可移植性。目标是在一个跨化学体系测试套件上，实现、推导和比较两种替代的异类对规则——Kong 规则和 Waldman–Hagler 规则。对于每个测试集，您将选择能最小化该集合中所有异类对的全局可移植性误差的规则。\n\n从物种 $i$ 和 $j$ 之间的 LJ 势可以写成如下基本形式开始：\n$$\nU_{ij}(r)=4\\,\\varepsilon_{ij}\\left[\\left(\\frac{\\sigma_{ij}}{r}\\right)^{12}-\\left(\\frac{\\sigma_{ij}}{r}\\right)^{6}\\right]\n= \\frac{c_{12,ij}}{r^{12}}-\\frac{c_{6,ij}}{r^{6}},\n$$\n其中 $c_{6,ij}=4\\,\\varepsilon_{ij}\\,\\sigma_{ij}^{6}$ 且 $c_{12,ij}=4\\,\\varepsilon_{ij}\\,\\sigma_{ij}^{12}$。异类对混合规则旨在通过强制执行能保留具有物理动机的组合的不变量，来寻找以同类对参数 $\\sigma_{i}$、$\\varepsilon_{i}$ 和 $\\sigma_{j}$、$\\varepsilon_{j}$ 表示 $\\sigma_{ij}$ 和 $\\varepsilon_{ij}$ 的表达式。您必须用来推导这两种规则的约束条件是：\n- 对于这两种规则，都强制执行 London 色散组合不变量：\n$$\nc_{6,ij}=\\sqrt{c_{6,i}\\,c_{6,j}}=\\sqrt{\\left(4\\,\\varepsilon_{i}\\,\\sigma_{i}^{6}\\right)\\left(4\\,\\varepsilon_{j}\\,\\sigma_{j}^{6}\\right)}.\n$$\n- 对于 Kong 规则，额外施加一个对 LJ 尺寸参数三次方的算术平均约束：\n$$\n\\sigma_{ij}^{3}=\\frac{\\sigma_{i}^{3}+\\sigma_{j}^{3}}{2}.\n$$\n- 对于 Waldman–Hagler 规则，额外施加一个对 LJ 尺寸参数六次方的算术平均约束：\n$$\n\\sigma_{ij}^{6}=\\frac{\\sigma_{i}^{6}+\\sigma_{j}^{6}}{2}.\n$$\n根据这些约束以及 $c_{6,ij}$ 和 $c_{12,ij}$ 的定义，为每种规则推导出相应的 $\\sigma_{ij}$ 和 $\\varepsilon_{ij}$ 表达式，这些表达式仅用 $\\sigma_{i}$、$\\sigma_{j}$、$\\varepsilon_{i}$ 和 $\\varepsilon_{j}$ 表示。\n\n将给定规则下单个异类对 $(i,j)$ 的成对相对可移植性误差定义为：\n$$\nE_{ij}=\\sqrt{\n\\left(\\frac{\\sigma_{ij}-\\sigma_{ij}^{\\ast}}{\\sigma_{ij}^{\\ast}}\\right)^{2}\n+\n\\left(\\frac{\\varepsilon_{ij}-\\varepsilon_{ij}^{\\ast}}{\\varepsilon_{ij}^{\\ast}}\\right)^{2}\n},\n$$\n其中 $\\sigma_{ij}^{\\ast}$ 和 $\\varepsilon_{ij}^{\\ast}$ 是代表高精度参考值的目标交叉参数。测试集 $\\mathcal{S}$ 的全局可移植性误差是 $\\mathcal{S}$ 中所有异类对的 $E_{ij}$ 的算术平均值：\n$$\n\\overline{E}(\\mathcal{S})=\\frac{1}{|\\mathcal{S}|}\\sum_{(i,j)\\in \\mathcal{S}} E_{ij}.\n$$\n\n实现一个完整的程序，该程序能够：\n- 使用从上述第一性原理推导出的 Kong 规则和 Waldman–Hagler 规则，为每个异类对 $(i,j)$ 计算 $(\\sigma_{ij},\\varepsilon_{ij})$。\n- 使用指定的目标值，为每种规则计算每对误差 $E_{ij}$。\n- 为每种规则在每个测试集上计算全局可移植性误差 $\\overline{E}(\\mathcal{S})$。\n- 为每个测试集选择最小化 $\\overline{E}(\\mathcal{S})$ 的规则。\n\n使用以下物理上合理的同类对参数（所有尺寸参数 $\\sigma$ 的单位为纳米，所有能量参数 $\\varepsilon$ 的单位为千焦/摩尔），以及为所选异类对提供的目标交叉参数。所有能量值以 $\\text{kJ mol}^{-1}$ 为单位作答，所有尺寸值以 $\\mathrm{nm}$ 为单位作答。本问题不涉及角度。每对误差和全局误差是无量纲的。\n\n物种定义（同类对参数）：\n- 氖 (Ne): $\\sigma_{\\mathrm{Ne}} = 0.275$, $\\varepsilon_{\\mathrm{Ne}} = 0.149$。\n- 氩 (Ar): $\\sigma_{\\mathrm{Ar}} = 0.340$, $\\varepsilon_{\\mathrm{Ar}} = 0.996$。\n- 氪 (Kr): $\\sigma_{\\mathrm{Kr}} = 0.365$, $\\varepsilon_{\\mathrm{Kr}} = 1.673$。\n- 甲烷联合原子 ($\\text{CH}_4$-UA): $\\sigma_{\\mathrm{CH4}} = 0.373$, $\\varepsilon_{\\mathrm{CH4}} = 1.230$。\n- 水中的氧原子 (O): $\\sigma_{\\mathrm{O}} = 0.315$, $\\varepsilon_{\\mathrm{O}} = 0.636$。\n- $\\text{sp}^2$ 碳 (Csp$^{2}$): $\\sigma_{\\mathrm{Csp2}} = 0.355$, $\\varepsilon_{\\mathrm{Csp2}} = 0.439$。\n- 氩变体 (Arp): $\\sigma_{\\mathrm{Arp}} = 0.341$, $\\varepsilon_{\\mathrm{Arp}} = 1.000$。\n\n测试套件：\n- 测试集 $\\mathcal{S}_{1}$ 带目标值的异类对：\n    - $(\\mathrm{Ne},\\mathrm{Ar})$: $\\sigma^{\\ast} = 0.3157$, $\\varepsilon^{\\ast} = 0.3188$。\n    - $(\\mathrm{Ar},\\mathrm{Kr})$: $\\sigma^{\\ast} = 0.3537$, $\\varepsilon^{\\ast} = 1.2610$。\n    - $(\\mathrm{Ar},\\mathrm{CH4})$: $\\sigma^{\\ast} = 0.3588$, $\\varepsilon^{\\ast} = 1.0650$。\n- 测试集 $\\mathcal{S}_{2}$ 带目标值的异类对：\n    - $(\\mathrm{Ar},\\mathrm{Arp})$: $\\sigma^{\\ast} = 0.3405$, $\\varepsilon^{\\ast} = 0.9980$。\n    - $(\\mathrm{O},\\mathrm{Csp2})$: $\\sigma^{\\ast} = 0.3380$, $\\varepsilon^{\\ast} = 0.4960$。\n    - $(\\mathrm{O},\\mathrm{Kr})$: $\\sigma^{\\ast} = 0.3450$, $\\varepsilon^{\\ast} = 0.9390$。\n- 测试集 $\\mathcal{S}_{3}$ 带目标值的异类对：\n    - $(\\mathrm{Ne},\\mathrm{Csp2})$: $\\sigma^{\\ast} = 0.3267$, $\\varepsilon^{\\ast} = 0.1958$。\n    - $(\\mathrm{Ne},\\mathrm{O})$: $\\sigma^{\\ast} = 0.2986$, $\\varepsilon^{\\ast} = 0.2840$。\n    - $(\\mathrm{Kr},\\mathrm{CH4})$: $\\sigma^{\\ast} = 0.3691$, $\\varepsilon^{\\ast} = 1.4310$。\n\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表，结果按以下顺序排列：\n$$\n\\left[\\overline{E}_{\\mathrm{Kong}}(\\mathcal{S}_{1}),\\,\\overline{E}_{\\mathrm{WH}}(\\mathcal{S}_{1}),\\,I_{1},\\,\\overline{E}_{\\mathrm{Kong}}(\\mathcal{S}_{2}),\\,\\overline{E}_{\\mathrm{WH}}(\\mathcal{S}_{2}),\\,I_{2},\\,\\overline{E}_{\\mathrm{Kong}}(\\mathcal{S}_{3}),\\,\\overline{E}_{\\mathrm{WH}}(\\mathcal{S}_{3}),\\,I_{3}\\right],\n$$\n其中，$I_{k}$ 是为测试集 $\\mathcal{S}_{k}$ 选择的规则的整数索引，$0$ 代表 Kong 规则，$1$ 代表 Waldman–Hagler 规则。所有浮点输出都应由您的程序计算，除了运行时的默认行为外，不进行任何舍入操作。", "solution": "所述问题具有科学依据、提法明确、客观，并包含了获得唯一解所需的所有必要信息。这是经典分子模拟和力场开发领域中的一个典型问题，涉及 Lennard-Jones 参数在异类原子相互作用中的可移植性。所有提供的参数在物理上都是合理的。因此，该问题被认为是有效的，并给出完整解答。\n\n目标是推导和比较两种 Lennard-Jones (LJ) 参数的混合规则，即 Kong 规则和 Waldman-Hagler (WH) 规则，并为三个不同的异类原子对测试集选择性能更好的规则。\n\n相距为 $r$ 的两个粒子 $i$ 和 $j$ 之间的 LJ 势由下式给出：\n$$\nU_{ij}(r) = 4\\varepsilon_{ij}\\left[\\left(\\frac{\\sigma_{ij}}{r}\\right)^{12}-\\left(\\frac{\\sigma_{ij}}{r}\\right)^{6}\\right]\n$$\n这可以根据吸引（$C_6$）和排斥（$C_{12}$）系数重写为：\n$$\nU_{ij}(r) = \\frac{C_{12,ij}}{r^{12}} - \\frac{C_{6,ij}}{r^6}\n$$\n其中 $C_{6,ij} = 4\\varepsilon_{ij}\\sigma_{ij}^{6}$ 且 $C_{12,ij} = 4\\varepsilon_{ij}\\sigma_{ij}^{12}$。参数 $\\varepsilon_{ij}$ 和 $\\sigma_{ij}$ 分别是异类对 $(i, j)$ 的相互作用能和势能为零时的有限距离。混合规则用于根据已知的同类对参数 $(\\varepsilon_{i}, \\sigma_{i})$ 和 $(\\varepsilon_{j}, \\sigma_{j})$ 来近似这些值。\n\n两种混合规则共用一个源自 London 色散力理论的共同约束。该约束将吸引系数 $C_{6,ij}$ 与同类对系数的几何平均值关联起来：\n$$\nC_{6,ij} = \\sqrt{C_{6,i} C_{6,j}}\n$$\n代入 $C_6$ 的定义：\n$$\n4\\varepsilon_{ij}\\sigma_{ij}^{6} = \\sqrt{(4\\varepsilon_{i}\\sigma_{i}^{6})(4\\varepsilon_{j}\\sigma_{j}^{6})} = 4\\sqrt{\\varepsilon_{i}\\varepsilon_{j}}\\sigma_{i}^{3}\\sigma_{j}^{3}\n$$\n这简化为 $\\varepsilon_{ij}$ 和 $\\sigma_{ij}$ 之间的一个通用关系：\n$$\n\\varepsilon_{ij} = \\frac{\\sigma_{i}^{3}\\sigma_{j}^{3}}{\\sigma_{ij}^{6}} \\sqrt{\\varepsilon_{i}\\varepsilon_{j}}\n$$\n一旦 $\\sigma_{ij}$ 由特定规则的约束确定，该方程就成为推导 $\\varepsilon_{ij}$ 的基础。\n\n**Kong 混合规则的推导**\n\nKong 规则引入了一个基于直径三次方的算术平均值的额外约束：\n$$\n\\sigma_{ij}^{3} = \\frac{\\sigma_{i}^{3} + \\sigma_{j}^{3}}{2}\n$$\n根据这个约束，可以直接获得异类对的尺寸参数 $\\sigma_{ij}$：\n$$\n\\sigma_{ij}^{\\text{Kong}} = \\left( \\frac{\\sigma_{i}^{3} + \\sigma_{j}^{3}}{2} \\right)^{1/3}\n$$\n为了找到相应的能量参数 $\\varepsilon_{ij}$，我们将此表达式的立方 $\\sigma_{ij}^{3}$ 代入先前推导的通用关系中。首先，我们求出 $\\sigma_{ij}^{6}$：\n$$\n\\sigma_{ij}^{6} = \\left(\\sigma_{ij}^{3}\\right)^2 = \\left(\\frac{\\sigma_{i}^{3} + \\sigma_{j}^{3}}{2}\\right)^2\n$$\n将其代入 $\\varepsilon_{ij}$ 的通用方程中：\n$$\n\\varepsilon_{ij}^{\\text{Kong}} = \\frac{\\sigma_{i}^{3}\\sigma_{j}^{3}}{\\left(\\frac{\\sigma_{i}^{3} + \\sigma_{j}^{3}}{2}\\right)^2} \\sqrt{\\varepsilon_{i}\\varepsilon_{j}} = \\frac{4\\sigma_{i}^{3}\\sigma_{j}^{3}}{(\\sigma_{i}^{3} + \\sigma_{j}^{3})^2} \\sqrt{\\varepsilon_{i}\\varepsilon_{j}}\n$$\n\n**Waldman-Hagler (WH) 混合规则的推导**\n\nWaldman-Hagler 规则引入了一个不同的约束，基于直径六次方的算术平均值。选择此约束是为了在特定假设下保留 $C_{12}$ 项中隐含的对体积的加和性。\n$$\n\\sigma_{ij}^{6} = \\frac{\\sigma_{i}^{6} + \\sigma_{j}^{6}}{2}\n$$\n由此，异类对的尺寸参数 $\\sigma_{ij}$ 为：\n$$\n\\sigma_{ij}^{\\text{WH}} = \\left( \\frac{\\sigma_{i}^{6} + \\sigma_{j}^{6}}{2} \\right)^{1/6}\n$$\n为了找到能量参数 $\\varepsilon_{ij}$，我们将 $\\sigma_{ij}^{6}$ 的表达式直接代入通用关系中：\n$$\n\\varepsilon_{ij}^{\\text{WH}} = \\frac{\\sigma_{i}^{3}\\sigma_{j}^{3}}{\\frac{\\sigma_{i}^{6} + \\sigma_{j}^{6}}{2}} \\sqrt{\\varepsilon_{i}\\varepsilon_{j}} = \\frac{2\\sigma_{i}^{3}\\sigma_{j}^{3}}{\\sigma_{i}^{6} + \\sigma_{j}^{6}} \\sqrt{\\varepsilon_{i}\\varepsilon_{j}}\n$$\n\n**误差计算与规则选择**\n\n推导出两种规则的 $(\\sigma_{ij}, \\varepsilon_{ij})$ 表达式后，我们开始对其进行评估。\n每种规则的性能通过成对相对可移植性误差 $E_{ij}$ 来量化，该误差定义为参数相对误差空间中的欧几里得距离：\n$$\nE_{ij} = \\sqrt{ \\left(\\frac{\\sigma_{ij} - \\sigma_{ij}^{\\ast}}{\\sigma_{ij}^{\\ast}}\\right)^{2} + \\left(\\frac{\\varepsilon_{ij} - \\varepsilon_{ij}^{\\ast}}{\\varepsilon_{ij}^{\\ast}}\\right)^{2} }\n$$\n其中 $(\\sigma_{ij}^{\\ast}, \\varepsilon_{ij}^{\\ast})$ 是给定的用于原子对 $(i, j)$ 的高质量目标参数。\n\n对于每个测试集 $\\mathcal{S}_k$，通过对该集合中所有原子对的成对误差取算术平均值，来计算每种规则的全局可移植性误差 $\\overline{E}(\\mathcal{S}_k)$：\n$$\n\\overline{E}(\\mathcal{S}_k) = \\frac{1}{|\\mathcal{S}_k|} \\sum_{(i,j) \\in \\mathcal{S}_k} E_{ij}\n$$\n对于每个集合 $\\mathcal{S}_k$，我们比较 $\\overline{E}_{\\text{Kong}}(\\mathcal{S}_k)$ 和 $\\overline{E}_{\\text{WH}}(\\mathcal{S}_k)$。选择全局误差较小的规则。所选规则由一个整数索引 $I_k$ 表示，其中 $I_k=0$ 代表 Kong 规则，$I_k=1$ 代表 Waldman-Hagler 规则。\n\n程序化实现将使用提供的物种和目标参数，对三个测试集 $\\mathcal{S}_1$、$\\mathcal{S}_2$ 和 $\\mathcal{S}_3$ 中的每一个执行这些计算，并按规定格式化结果。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Implements, derives, and compares Kong and Waldman-Hagler mixing rules\n    for Lennard-Jones parameters and selects the best rule for given test sets.\n    \"\"\"\n\n    # --- Step 1: Define Given Data ---\n\n    # Species like-pair parameters (sigma in nm, epsilon in kJ/mol)\n    species_params = {\n        \"Ne\": {\"sigma\": 0.275, \"eps\": 0.149},\n        \"Ar\": {\"sigma\": 0.340, \"eps\": 0.996},\n        \"Kr\": {\"sigma\": 0.365, \"eps\": 1.673},\n        \"CH4\": {\"sigma\": 0.373, \"eps\": 1.230},\n        \"O\": {\"sigma\": 0.315, \"eps\": 0.636},\n        \"Csp2\": {\"sigma\": 0.355, \"eps\": 0.439},\n        \"Arp\": {\"sigma\": 0.341, \"eps\": 1.000},\n    }\n\n    # Test sets with hetero-pairs and their target parameters\n    test_sets = [\n        # Test Set S_1\n        {\n            \"pairs\": [\n                {\"p1\": \"Ne\", \"p2\": \"Ar\", \"sigma_star\": 0.3157, \"eps_star\": 0.3188},\n                {\"p1\": \"Ar\", \"p2\": \"Kr\", \"sigma_star\": 0.3537, \"eps_star\": 1.2610},\n                {\"p1\": \"Ar\", \"p2\": \"CH4\", \"sigma_star\": 0.3588, \"eps_star\": 1.0650},\n            ]\n        },\n        # Test Set S_2\n        {\n            \"pairs\": [\n                {\"p1\": \"Ar\", \"p2\": \"Arp\", \"sigma_star\": 0.3405, \"eps_star\": 0.9980},\n                {\"p1\": \"O\", \"p2\": \"Csp2\", \"sigma_star\": 0.3380, \"eps_star\": 0.4960},\n                {\"p1\": \"O\", \"p2\": \"Kr\", \"sigma_star\": 0.3450, \"eps_star\": 0.9390},\n            ]\n        },\n        # Test Set S_3\n        {\n            \"pairs\": [\n                {\"p1\": \"Ne\", \"p2\": \"Csp2\", \"sigma_star\": 0.3267, \"eps_star\": 0.1958},\n                {\"p1\": \"Ne\", \"p2\": \"O\", \"sigma_star\": 0.2986, \"eps_star\": 0.2840},\n                {\"p1\": \"Kr\", \"p2\": \"CH4\", \"sigma_star\": 0.3691, \"eps_star\": 1.4310},\n            ]\n        },\n    ]\n\n    # --- Step 2: Implement Mixing Rules and Error Functions ---\n\n    def kong_rule(s_i, e_i, s_j, e_j):\n        \"\"\"Computes (sigma_ij, eps_ij) using the Kong mixing rule.\"\"\"\n        s_i_3 = s_i**3\n        s_j_3 = s_j**3\n        \n        sigma_ij = ((s_i_3 + s_j_3) / 2.0)**(1.0 / 3.0)\n        \n        eps_ij_num = 4.0 * s_i_3 * s_j_3\n        eps_ij_den = (s_i_3 + s_j_3)**2\n        \n        epsilon_ij = (eps_ij_num / eps_ij_den) * np.sqrt(e_i * e_j)\n        \n        return sigma_ij, epsilon_ij\n\n    def wh_rule(s_i, e_i, s_j, e_j):\n        \"\"\"Computes (sigma_ij, eps_ij) using the Waldman-Hagler mixing rule.\"\"\"\n        s_i_6 = s_i**6\n        s_j_6 = s_j**6\n        \n        sigma_ij = ((s_i_6 + s_j_6) / 2.0)**(1.0 / 6.0)\n        \n        eps_ij_num = 2.0 * (s_i**3) * (s_j**3)\n        eps_ij_den = s_i_6 + s_j_6\n        \n        epsilon_ij = (eps_ij_num / eps_ij_den) * np.sqrt(e_i * e_j)\n        \n        return sigma_ij, epsilon_ij\n\n    def pairwise_error(sigma_ij, eps_ij, sigma_star, eps_star):\n        \"\"\"Computes the pairwise relative transfer error E_ij.\"\"\"\n        rel_err_sigma_sq = ((sigma_ij - sigma_star) / sigma_star)**2\n        rel_err_eps_sq = ((eps_ij - eps_star) / eps_star)**2\n        \n        return np.sqrt(rel_err_sigma_sq + rel_err_eps_sq)\n\n    # --- Step 3: Process Test Sets and Compute Results ---\n    \n    final_results = []\n    \n    for test_set in test_sets:\n        kong_errors = []\n        wh_errors = []\n        \n        for pair_info in test_set[\"pairs\"]:\n            p1_name = pair_info[\"p1\"]\n            p2_name = pair_info[\"p2\"]\n            \n            p1_params = species_params[p1_name]\n            p2_params = species_params[p2_name]\n            \n            s_i, e_i = p1_params[\"sigma\"], p1_params[\"eps\"]\n            s_j, e_j = p2_params[\"sigma\"], p2_params[\"eps\"]\n            \n            s_star, e_star = pair_info[\"sigma_star\"], pair_info[\"eps_star\"]\n            \n            # Calculate parameters and errors for Kong rule\n            s_kong, e_kong = kong_rule(s_i, e_i, s_j, e_j)\n            error_kong = pairwise_error(s_kong, e_kong, s_star, e_star)\n            kong_errors.append(error_kong)\n            \n            # Calculate parameters and errors for Waldman-Hagler rule\n            s_wh, e_wh = wh_rule(s_i, e_i, s_j, e_j)\n            error_wh = pairwise_error(s_wh, e_wh, s_star, e_star)\n            wh_errors.append(error_wh)\n            \n        # Compute global errors for the set\n        global_error_kong = np.mean(kong_errors)\n        global_error_wh = np.mean(wh_errors)\n        \n        # Determine the best rule (0 for Kong, 1 for WH)\n        chosen_rule_index = 0 if global_error_kong  global_error_wh else 1\n        \n        # Append results for this set to the final list\n        final_results.extend([global_error_kong, global_error_wh, chosen_rule_index])\n\n    # --- Step 4: Format and Print the Final Output ---\n    \n    print(f\"[{','.join(map(str, final_results))}]\")\n\nsolve()\n```", "id": "3457764"}]}