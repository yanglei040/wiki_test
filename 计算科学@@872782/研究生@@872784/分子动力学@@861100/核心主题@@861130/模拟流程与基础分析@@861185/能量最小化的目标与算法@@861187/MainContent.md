## 引言
[能量最小化](@entry_id:147698)是计算化学和[生物物理学](@entry_id:154938)中的一项基本技术，其核心目标是寻找分子系统的稳定三维构象。无论是从实验解析还是理论构建获得的分子结构，往往都含有不切实际的高能特征，如原子间的[空间冲突](@entry_id:177563)。若不加处理，这些高能构象会在分子动力学（MD）模拟的初始阶段引发巨大的作用力，导致数值不稳定甚至模拟失败。因此，在进行任何有意义的动力学模拟或[构象分析](@entry_id:177729)之前，通过能量最小化对系统进行“弛豫”是不可或缺的一步。

本文旨在系统性地解决一个核心问题：我们如何从一个任意的、可能不稳定的初始构象出发，高效且稳健地找到一个物理上合理的低能状态？这不仅仅是一个寻找最低能量点的问题，更涉及到理解能量“景观”的复杂性以及选择合适的“下山”策略。

为了全面掌握这一关键技术，我们将分三个章节进行深入探讨。首先，在“原理与机制”部分，我们将揭示[能量最小化](@entry_id:147698)的理论基石——[势能面](@entry_id:147441)，并剖析从简单到复杂的算法层次结构，包括[最速下降法](@entry_id:140448)、共轭梯度法和[L-BFGS](@entry_id:167263)法，理解它们各自的优势与局限。接着，在“应用与交叉学科联系”部分，我们将展示这些算法在[生物分子模拟](@entry_id:746829)、[材料科学](@entry_id:152226)等领域的实际应用，并探讨其与[统计力](@entry_id:194984)学、[图论](@entry_id:140799)等其他学科的深刻联系。最后，在“动手实践”部分，您将有机会通过具体的编程练习，将理论知识转化为解决实际问题的能力。

让我们首先进入第一部分，深入了解[能量最小化](@entry_id:147698)的基本目标及其背后的核心算法机制。

## 原理与机制

[能量最小化](@entry_id:147698)是分子模拟中的一个基本过程，旨在识别分子系统的稳定构象。它不仅是为后续的分子动力学（MD）模拟准备结构的必要步骤，本身也是一种强大的[构象分析](@entry_id:177729)和优化工具。本章将深入探讨[能量最小化](@entry_id:147698)的核心目标，即[势能面](@entry_id:147441)（Potential Energy Surface, PES）的拓扑结构，并系统地阐述用于探索该表面的算法层次结构，从一阶方法到准牛顿方法。我们还将讨论在实际应用中遇到的关键挑战，如处理约束、非光滑势能函数和提高收敛效率。

### [能量最小化](@entry_id:147698)的目标：[势能面](@entry_id:147441)

在[分子力学](@entry_id:176557)中，一个由 $N$ 个原子组成的系统的能量状态完全由其三维空间构型决定。这个构型可以通过一个包含所有原子笛卡尔坐标的 $3N$ 维向量 $\mathbf{r}$ 来描述。系统的[势能](@entry_id:748988)被建模为一个标量函数 $U(\mathbf{r})$，该函数将每个构型映射到一个[势能](@entry_id:748988)值，从而在 $3N$ 维构型空间上定义了一个超曲面，即 **[势能面](@entry_id:147441) (Potential Energy Surface, PES)**。

#### [势能面](@entry_id:147441)的定义与特性

根据经典[分子力学](@entry_id:176557)的定义，[势能](@entry_id:748988) $U(\mathbf{r})$ 是一个只依赖于原子坐标 $\mathbf{r}$ 的函数，而不依赖于它们的速度或动量 [@problem_id:3410256]。它通常表示为一系列物理上合理的能量项的总和，包括[键合相互作用](@entry_id:746909)（如键长伸缩、键角弯曲、二面角扭转）和[非键相互作用](@entry_id:189647)（如范德华力和[静电力](@entry_id:203379)）。这些项本身都是原子间距离和角度的函数，最终都可表示为坐标 $\mathbf{r}$ 的函数。

[势能面](@entry_id:147441)与作用在原子上的力之间存在着深刻的联系。在[哈密顿力学](@entry_id:146202)框架下，系统的[哈密顿量](@entry_id:172864)可以写成动能 $K(\mathbf{p})$ 和势能 $U(\mathbf{r})$ 的和，$H(\mathbf{p}, \mathbf{r}) = K(\mathbf{p}) + U(\mathbf{r})$。根据[哈密顿方程](@entry_id:156213)，[正则动量](@entry_id:155151) $\mathbf{p}_i$ 的时间导数等于[哈密顿量](@entry_id:172864)对相应坐标 $\mathbf{r}_i$ 的负偏导数：

$$
\dot{\mathbf{p}}_i = -\frac{\partial H}{\partial \mathbf{r}_i} = -\frac{\partial K(\mathbf{p})}{\partial \mathbf{r}_i} - \frac{\partial U(\mathbf{r})}{\partial \mathbf{r}_i}
$$

由于动能 $K$ 仅是动量的函数，其对坐标的偏导数为零。再根据[牛顿第二定律](@entry_id:274217)，力的定义是动量的时间变化率，即 $\mathbf{F}_i = \dot{\mathbf{p}}_i$。因此，我们得到了[分子模拟](@entry_id:182701)中最基本的关系之一：

$$
\mathbf{F}_i(\mathbf{r}) = -\nabla_{\mathbf{r}_i} U(\mathbf{r})
$$

这个关系表明，作用在任何原子上的[保守力](@entry_id:170586)都是势能函数在该原子坐标上的负梯度 [@problem_id:3410241]。从这个角度来看，**能量最小化的目标在物理上等同于寻找一个所有原子受力均为零的[机械平衡](@entry_id:148830)构象**。

#### [势能面](@entry_id:147441)的拓扑结构

[势能面](@entry_id:147441)的拓扑结构，即其“山谷”、“山峰”和“山脊”的[分布](@entry_id:182848)，决定了分子的稳定[状态和](@entry_id:193625)[构象转变](@entry_id:747689)路径。对这些关键点进行数学表征至关重要。

**[驻点](@entry_id:136617) (Stationary Points)** 是[势能面](@entry_id:147441)梯度为零的点，$\nabla U(\mathbf{r}^\star) = \mathbf{0}$。根据上述关系，这些点对应于系统[净力](@entry_id:163825)为零的平衡构象。

要区分不同类型的[驻点](@entry_id:136617)，我们需要考察[势能面](@entry_id:147441)在这些点附近的局部曲率，这由 **Hessian 矩阵** 给出，该矩阵是[势能](@entry_id:748988)的[二阶偏导数](@entry_id:635213)矩阵，$\mathbf{H}(\mathbf{r}) = \nabla^2 U(\mathbf{r})$。在[驻点](@entry_id:136617) $\mathbf{r}^\star$ 附近，势能的二阶[泰勒展开](@entry_id:145057)为：

$$
U(\mathbf{r}^\star + \delta\mathbf{r}) \approx U(\mathbf{r}^\star) + \nabla U(\mathbf{r}^\star)^\top \delta\mathbf{r} + \frac{1}{2} \delta\mathbf{r}^\top \mathbf{H}(\mathbf{r}^\star) \delta\mathbf{r}
$$

由于 $\nabla U(\mathbf{r}^\star) = \mathbf{0}$，构型 $\mathbf{r}^\star$ 的稳定性完全由 Hessian 矩阵的性质决定：

1.  **局部极小点 (Local Minimum)**: 如果 Hessian 矩阵 $\mathbf{H}(\mathbf{r}^\star)$ 是 **正定的** (positive definite)，即其所有[特征值](@entry_id:154894)均为正，那么对于任何微小的位移 $\delta\mathbf{r}$，$\delta\mathbf{r}^\top \mathbf{H}(\mathbf{r}^\star) \delta\mathbf{r} > 0$，这意味着能量会增加。因此，$\mathbf{r}^\star$ 是一个稳定的平衡构象，对应于[势能面](@entry_id:147441)上的一个“谷底”。在实际分析中，需要排除对应于系统整体平动和转动的零[特征值](@entry_id:154894)，这些是系统的对称性导致的，不影响其内在稳定性 [@problem_id:3410256]。

2.  **[鞍点](@entry_id:142576) (Saddle Point)**: 如果 $\mathbf{H}(\mathbf{r}^\star)$ 是 **不定的** (indefinite)，即它既有正[特征值](@entry_id:154894)也有负[特征值](@entry_id:154894)，那么 $\mathbf{r}^\star$ 是一个[鞍点](@entry_id:142576)。在某些方向上移动会增加能量，而在另一些方向上则会降低能量。**[一阶鞍点](@entry_id:165164)**，即 Hessian 恰好有一个负[特征值](@entry_id:154894)的点，在[化学反应](@entry_id:146973)和[构象转变](@entry_id:747689)中具有特殊意义，它通常代表连接两个局部极小点的能量最低路径上的最高点，即 **过渡态 (transition state)** [@problem_id:3410256]。

3.  **局部极大点 (Local Maximum)**: 如果 $\mathbf{H}(\mathbf{r}^\star)$ 是 **负定的** (negative definite)，即其所有[特征值](@entry_id:154894)均为负，那么 $\mathbf{r}^\star$ 是一个不稳定的[平衡点](@entry_id:272705)，对应于[势能面](@entry_id:147441)上的“山峰”。

一个重要的概念是 **全局极小点 (global minimum)**，即在整个构型空间中势能最低的点。对于像蛋白质这样复杂的分子，其[势能面](@entry_id:147441)极其崎岖，包含大量的局部极小点。仅通过局部信息（如在某一点的梯度和 Hessian）通常无法断定一个点是否为全局极小点 [@problem_id:3410256]。[能量最小化算法](@entry_id:175155)通常只能保证收敛到一个 **局部极小点**。

### [能量最小化算法](@entry_id:175155)：方法的层次结构

[能量最小化算法](@entry_id:175155)旨在从一个任意的初始构型 $\mathbf{r}_0$ 出发，通过一系列迭代步骤找到一个[势能](@entry_id:748988)的局部极小点 $\mathbf{r}^\star$。大多数算法都遵循一个共同的迭代框架：

$$
\mathbf{r}_{k+1} = \mathbf{r}_k + \alpha_k \mathbf{p}_k
$$

其中，$k$ 是迭代步数，$\mathbf{p}_k$ 是一个精心选择的 **搜索方向**，而 $\alpha_k > 0$ 是一个标量 **步长**，用于决定沿该方向移动多远。不同算法的核心区别在于它们如何确定搜索方向 $\mathbf{p}_k$。

#### 一阶方法：基于梯度信息

这类方法仅使用[势能](@entry_id:748988)的一阶导数（即负力）来确定搜索方向。

**[最速下降法](@entry_id:140448) (Steepest Descent, SD)** 是最简单、最直观的[能量最小化算法](@entry_id:175155)。它选择的搜索方向是势能局部下降最快的方向，即负梯度方向 [@problem_id:3410241]：

$$
\mathbf{p}_k^{\text{SD}} = -\nabla U(\mathbf{r}_k) = \mathbf{F}(\mathbf{r}_k)
$$

尽管最速下降法保证了每一步都朝着能量降低的方向前进（对于足够小的步长），但它的收敛效率非常低下。在狭长的势能谷中，[最速下降](@entry_id:141858)方向几乎垂直于通向谷底的路径，导致算法在山谷两侧反复“之”字形前进，收敛速度极慢。

**[非线性共轭梯度法](@entry_id:170766) (Nonlinear Conjugate Gradient, CG)** 是对最速下降法的重大改进。它通过引入“共轭”或“共轭性”的概念来避免[最速下降法](@entry_id:140448)的低效[振荡](@entry_id:267781)。CG 的搜索方向不仅依赖于当前的负梯度，还结合了上一步的搜索方向：

$$
\mathbf{p}_{k+1}^{\text{CG}} = -\mathbf{g}_{k+1} + \beta_k \mathbf{p}_k
$$

其中 $\mathbf{g}_k = \nabla U(\mathbf{r}_k)$ 是梯度。标量 $\beta_k$ 的计算有多种形式，其中最著名的是 **Fletcher–Reeves (FR)** 和 **Polak–Ribière (PR)** 公式 [@problem_id:3410304]：

$$
\beta_k^{\text{FR}} = \frac{\mathbf{g}_{k+1}^\top \mathbf{g}_{k+1}}{\mathbf{g}_k^\top \mathbf{g}_k} \quad \text{and} \quad \beta_k^{\text{PR}} = \frac{\mathbf{g}_{k+1}^\top (\mathbf{g}_{k+1} - \mathbf{g}_k)}{\mathbf{g}_k^\top \mathbf{g}_k}
$$

通过这种方式，CG 方法能够“记忆”之前的下降路径，从而在狭长谷中更有效地沿着谷底前进。为保证算法的[全局收敛性](@entry_id:635436)，特别是对于可能产生负 $\beta_k$ 值的 PR 方法，通常会采用 **重启策略**，例如当 $\beta_k$ 为负时将其设为零，此时搜索方向退化为[最速下降](@entry_id:141858)方向，从而确保了每一步都是下降方向 [@problem_id:3410304]。

#### 二阶方法：利用曲率信息

二阶方法利用势能的[二阶导数](@entry_id:144508)（Hessian 矩阵）来构建一个更精确的局部[势能面](@entry_id:147441)模型，从而实现更快的收敛。

**[牛顿法](@entry_id:140116) (Newton's Method)** 是二阶方法的原型。它在当前点 $\mathbf{r}_k$ 附近构建一个二次模型来近似[势能面](@entry_id:147441)：

$$
U(\mathbf{r}_k + \mathbf{p}) \approx U(\mathbf{r}_k) + \nabla U(\mathbf{r}_k)^\top \mathbf{p} + \frac{1}{2} \mathbf{p}^\top \nabla^2 U(\mathbf{r}_k) \mathbf{p}
$$

通过求解该二次模型的极小点（即令其梯度为零），可以得到 **[牛顿步](@entry_id:177069)** $\mathbf{p}_k^{\text{N}}$：

$$
\mathbf{p}_k^{\text{N}} = -[\nabla^2 U(\mathbf{r}_k)]^{-1} \nabla U(\mathbf{r}_k) = -\mathbf{H}_k^{-1} \mathbf{g}_k
$$

在局部极小点附近，Hessian 矩阵是正定的，[牛顿法](@entry_id:140116)表现出极快的 **二次收敛** 速度。然而，在远离极小点的非凸区域，Hessian 矩阵可能是 **不定的**，即包含负[特征值](@entry_id:154894)。在这种情况下，纯粹的[牛顿步](@entry_id:177069)可能指向一个[鞍点](@entry_id:142576)甚至能量更高的区域，导致算法失败。为了解决这个问题，需要对牛顿法进行修正，例如 **[修正牛顿法](@entry_id:636309)** 或 **[信赖域方法](@entry_id:138393) (Trust-Region Methods)**。[修正牛顿法](@entry_id:636309)的一个常用策略是通过向 Hessian 矩阵添加一个正的标量矩阵 $\lambda\mathbf{I}$ 来确保其[正定性](@entry_id:149643)，即求解 $(\mathbf{H}_k + \lambda\mathbf{I})\mathbf{p} = -\mathbf{g}_k$ [@problem_id:3410297]。

#### 准牛顿法：一阶与二阶的完美结合

[准牛顿法](@entry_id:138962)旨在结合牛顿法的快速收敛性与一阶方法的低计算成本。这类方法的核心思想是，不直接计算和求逆昂贵的 Hessian 矩阵，而是通过迭代过程中梯度信息的变化来逐步构建一个对逆 Hessian 矩阵的近似。

**BFGS 算法 (Broyden–Fletcher–Goldfarb–Shanno)** 是最成功的准牛顿算法之一。它维护一个对逆 Hessian 矩阵的正定近似 $\mathbf{B}_k^{-1}$，并在每一步根据梯度变化进行低秩更新。

对于拥有数万甚至数百万原子的大型分子系统，存储和操作一个完整的 ($3N \times 3N$) 近似 Hessian 矩阵（需要 $O(N^2)$ 的内存和计算）是不可行的。**有限内存 BFGS ([L-BFGS](@entry_id:167263)) 算法** 正是为此而生。它不存储完整的近似 Hessian 矩阵，而是只存储最近的 $m$ 次迭代中的位移向量 $\mathbf{s}_i = \mathbf{r}_{i+1} - \mathbf{r}_i$ 和梯度差向量 $\mathbf{y}_i = \mathbf{g}_{i+1} - \mathbf{g}_i$。利用这些信息，可以通过一个高效的递归过程（称为“[双循环](@entry_id:276370)递归”）直接计算出搜索方向 $\mathbf{p}_k = -\mathbf{B}_k^{-1} \mathbf{g}_k$。[L-BFGS](@entry_id:167263) 的内存需求仅为 $O(mN)$，其中 $m$ 通常是一个很小的常数（如 5-20），使其非常适用于大规模[分子模拟](@entry_id:182701) [@problem_id:3410257]。

在实践中，对于大型分子系统，能量和力的计算（尤其是在使用 PME 等方法处理长程静电时）占据了每次迭代的主要成本。SD、CG 和 [L-BFGS](@entry_id:167263) 的额外计算和[通信开销](@entry_id:636355)与力计算相比几乎可以忽略不计。因此，算法的总效率主要取决于收敛到极小点所需的迭代次数。由于 [L-BFGS](@entry_id:167263) 通常具有[超线性收敛](@entry_id:141654)速度，远快于 CG（[线性收敛](@entry_id:163614)）和 SD（亚[线性收敛](@entry_id:163614)），它在迭代次数上具有巨大优势，因此成为大规模分子系统能量最小化的首选方法 [@problem_id:3410257]。

### 实践中的高级主题与挑战

理论上的算法框架在应用于真实的分子系统时，会遇到一系列必须妥善处理的实际问题。

#### 线搜索：确定合适的步长

一旦确定了搜索方向 $\mathbf{p}_k$，就需要选择一个合适的步长 $\alpha_k$。一个过小的值会导致收敛缓慢，而一个过大的值可能会“越过”极小点，甚至导致能量上升。为了保证算法的稳定性和[全局收敛性](@entry_id:635436)，步长 $\alpha_k$ 必须满足一定的准则，其中最常用的是 **Wolfe 条件**。

Wolfe 条件包含两个部分 [@problem_id:3410277]：
1.  **Armijo 条件 (充分下降条件)**：要求步长能带来与预期相称的能量下降。它排除了过大的步长。
    $$
    U(\mathbf{r}_k + \alpha_k \mathbf{p}_k) \le U(\mathbf{r}_k) + c_1 \alpha_k \nabla U(\mathbf{r}_k)^\top \mathbf{p}_k
    $$
    其中 $c_1$ 是一个小的正常数（如 $10^{-4}$）。

2.  **曲率条件**：要求新位置的梯度不应过于陡峭，以排除过小的步长。**强 Wolfe 条件** 进一步要求新位置的梯度在搜索方向上的投影的[绝对值](@entry_id:147688)减小：
    $$
    |\nabla U(\mathbf{r}_k + \alpha_k \mathbf{p}_k)^\top \mathbf{p}_k| \le c_2 |\nabla U(\mathbf{r}_k)^\top \mathbf{p}_k|
    $$
    其中 $0  c_1  c_2  1$。

满足 Wolfe 条件的步长可以保证在合理的假设下，许多下降算法（如 CG 和 [L-BFGS](@entry_id:167263)）的[全局收敛性](@entry_id:635436)。

#### [预处理](@entry_id:141204)：加速在刚性系统中的收敛

生物分子等系统的[势能面](@entry_id:147441)通常是“病态的”(ill-conditioned)，其 Hessian 矩阵的[特征值分布](@entry_id:194746)范围极广。这对应于系统中同时存在非常“硬”的自由度（如 C-H [键伸缩](@entry_id:172690)，[特征值](@entry_id:154894)大）和非常“软”的自由度（如大片段的扭转，[特征值](@entry_id:154894)小）。Hessian 的 **条件数** $\kappa(\mathbf{H}) = \lambda_{\max}/\lambda_{\min}$ 非常大，这正是导致最速下降法等算法收敛缓慢的根本原因。

**[预处理](@entry_id:141204) (Preconditioning)** 是一种通过“重塑”[势能面](@entry_id:147441)来降低其有效条件数，从而加速收敛的技术。其核心思想是将求解 $\mathbf{g}_k = \mathbf{0}$ 的问题，转化为求解一个等价但[条件数](@entry_id:145150)更小的问题 $\mathbf{M}^{-1}\mathbf{g}_k = \mathbf{0}$。其中，$\mathbf{M}$ 是一个易于求逆且能近似 Hessian $\mathbf{H}$ 的正定矩阵，称为 **预处理器**。在算法中，搜索方向不再是 $-\mathbf{g}_k$，而是[预处理](@entry_id:141204)后的方向 $-\mathbf{M}^{-1}\mathbf{g}_k$。理想的[预处理器](@entry_id:753679) $\mathbf{M}$ 应使 $\mathbf{M}^{-1}\mathbf{H}$ 的条件数接近 1 [@problem_id:3410269]。

选择 $\mathbf{M} \approx \mathbf{H}$ (例如 $\mathbf{M}=\mathbf{H}$) 会使[预处理](@entry_id:141204)后的系统条件数为1，这相当于牛顿法，收敛极快，但计算 $\mathbf{M}^{-1}$ 的成本很高 [@problem_id:3410269]。一个实用的折衷是选择一个容易求逆的 $\mathbf{M}$，例如一个[对角矩阵](@entry_id:637782)。对于分子系统，一个有效的对角预处理器可以由[键合相互作用](@entry_id:746909)的刚度常数构成，因为它能有效处理由[键伸缩](@entry_id:172690)和角弯曲引起的主要刚度差异 [@problem_id:3410269]。另一种策略是使用 **质量加权**，其有效性取决于质量与刚度之间是否存在关联 [@problem_id:3410229]。

#### 处理约束和非光滑[势能](@entry_id:748988)

标准最小化算法的一个基本假设是目标函数 $U(\mathbf{r})$ 是光滑（可微）的。然而，在分子模拟中，这个假设常常被违反。

1.  **全息约束 (Holonomic Constraints)**: 为了固定高频[振动](@entry_id:267781)（如[键长](@entry_id:144592)），常引入刚性约束，表示为一组方程 $c(\mathbf{r}) = \mathbf{0}$。这限制了系统的构型必须位于一个称为 **约束[流形](@entry_id:153038)** $\mathcal{M}$ 的[子空间](@entry_id:150286)上。约束优化的必要条件由 **[Karush-Kuhn-Tucker (KKT) 条件](@entry_id:176491)** 给出。对于[等式约束](@entry_id:175290)，KKT 条件在几何上意味着，在约束极小点 $\mathbf{r}^\star$ 处，[势能的梯度](@entry_id:173126) $\nabla U(\mathbf{r}^\star)$ 必须与约束[流形](@entry_id:153038) **正交**，即它必须位于由约束梯度 $\{\nabla c_i(\mathbf{r}^\star)\}$ 张成的法空间中 [@problem_id:3410300]。代数上，这表示存在[拉格朗日乘子](@entry_id:142696) $\boldsymbol{\lambda}$ 使得：
    $$
    \nabla U(\mathbf{r}^\star) + J(\mathbf{r}^\star)^\top \boldsymbol{\lambda} = \mathbf{0} \quad \text{and} \quad c(\mathbf{r}^\star) = \mathbf{0}
    $$
    其中 $J(\mathbf{r}^\star)$ 是约束函数的[雅可比矩阵](@entry_id:264467) [@problem_id:3410300]。一个标准的非[约束最小化](@entry_id:747762)算法在处理硬约束时会失败，因为任何一步都可能离开[流形](@entry_id:153038)，导致能量无穷大。解决方法包括使用专门的约束优化算法，如将每一步投影回[流形](@entry_id:153038) [@problem_id:3410267]。

2.  **势能截断 (Potential Cutoffs)**: 为了计算效率，[非键相互作用](@entry_id:189647)通常在某个截断距离 $r_c$ 处被突然截断。如果[势能](@entry_id:748988)或力在 $r_c$ 处不为零，这将在[势能面](@entry_id:147441)上引入 **不连续性** 或 **不可微性**。当原子对在迭代过程中跨越 $r_c$ 时，梯度会发生突变，这违反了 Wolfe 条件所依赖的平滑性假设，导致[线搜索](@entry_id:141607)失败。正确的解决方法是使用 **平滑的转换函数 (switching function)** 或 **力移位函数 (force-shifting function)**，它们可以修改[势能](@entry_id:748988)，使其在 $r_c$ 处及其[一阶导数](@entry_id:749425)（力）都平滑地变为零，从而恢复势能函数的 $C^1$ 连续性 [@problem_id:3410267]。

3.  **数值参数的稳定性**: 在使用 PME 等方法处理[周期性边界条件](@entry_id:147809)下的长程相互作用时，计算出的能量和力是真实 Ewald 和的近似值，其精度由网格大小、插值阶数和 $k$ 空间截断等数值参数控制。如果这些参数在最小化过程中发生改变（例如，为了提高精度而收紧容差），目标函数 $U(\mathbf{r})$ 本身就会发生变化。这会破坏优化算法的收敛保证，因为算法正在追逐一个“移动的目标”，可能导致能量无法单调下降 [@problem_id:3410311]。因此，在一次完整的[能量最小化](@entry_id:147698)运行中，保持所有[力场](@entry_id:147325)和数值计算参数的恒定是至关重要的。

总之，有效的[能量最小化](@entry_id:147698)不仅需要选择一个强大的核心算法（如 [L-BFGS](@entry_id:167263)），还需要仔细考虑[势能函数](@entry_id:200753)的数学特性，并通过预处理、适当的约束处理和保证[目标函数](@entry_id:267263)的光滑性与稳定性来为算法的成功创造条件。