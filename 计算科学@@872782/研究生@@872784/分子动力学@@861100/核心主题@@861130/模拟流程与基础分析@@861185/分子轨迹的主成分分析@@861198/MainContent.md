## 引言
分子动力学（MD）模拟能够以前所未有的时空分辨率揭示[生物大分子](@entry_id:265296)的动态行为，但其产生的轨迹数据是海量的、高维的，并且本质上是随机的。从这些复杂的原子[坐标时](@entry_id:263720)间序列中直接提取与生物功能相关的、具有物理意义的运动模式，是一项巨大的挑战。主成分分析（Principal Component Analysis, PCA）作为一种强大的多元统计方法，为解决这一难题提供了系统性的框架。它通过将复杂的、相互关联的原子涨落转化为一组[线性无关](@entry_id:148207)的、按重要性排序的集体运动模式，极大地简化了高维构象空间的分析。

本文旨在全面而深入地介绍PCA在[分子轨迹](@entry_id:203645)分析中的应用。我们将不仅仅局限于其数学定义，而是要阐明其背后的物理直觉，展示其在解决具体科学问题时的威力。通过本文的学习，读者将掌握如何将原始的MD轨迹转化为可供分析的数据，理解PCA如何揭示系统的“本质动力学”，并学会如何将PCA分析结果与实验数据和生物功能联系起来。

文章将分为三个核心部分。在“原理与机制”一章中，我们将详细拆解PCA的每一个步骤，从[数据预处理](@entry_id:197920)到协方差矩阵的构建和[特征分解](@entry_id:181333)，并探讨质量加权PCA和[简正模分析](@entry_id:176817)等高级主题。接着，在“应用与[交叉](@entry_id:147634)学科联系”一章中，我们将通过丰富的实例展示PCA如何用于识别功能性运动、绘制自由能景观、比较不同条件下的动力学，以及与其它计算方法整合。最后，“动手实践”部分将提供具体的练习，帮助读者将理论知识转化为实践技能。

## 原理与机制

在理解了[主成分分析](@entry_id:145395)（PCA）在[分子动力学](@entry_id:147283)（MD）[轨迹分析](@entry_id:756092)中的目标和重要性之后，本章将深入探讨其核心原理和工作机制。我们将从如何将原始的MD轨迹数据转化为适合分析的数学形式开始，逐步构建协方差矩阵，并通过[特征分解](@entry_id:181333)揭示系统中最主要的运动模式。此外，我们还将探讨几种高级变体，如质量加权PCA，并阐明PCA与[简正模分析](@entry_id:176817)（NMA）等其他理论方法之间的深刻联系。

### 从[分子轨迹](@entry_id:203645)到数据矩阵：[数据预处理](@entry_id:197920)

[主成分分析](@entry_id:145395)的第一步是将[分子动力学模拟](@entry_id:160737)产生的海量、高维的时间序列数据，即原子坐标，转化为一个结构化的数学对象——数据矩阵。这个过程涉及几个关键的[预处理](@entry_id:141204)步骤，以确保分析的物理意义和结果的有效性。

#### 构建轨迹矩阵

一次MD模拟会记录下一个包含$N$个原子的系统在$T$个离散时间点（帧）的构象。在每一帧$t$，第$i$个原子的位置由一个三维向量 $\mathbf{r}_i(t) \in \mathbb{R}^3$ 描述。为了进行PCA分析，我们需要将每一帧的构象表示为一个单一的高维向量。标准做法是将所有$N$个原子的$3N$个[笛卡尔坐标](@entry_id:167698)$(x, y, z)$按顺序堆叠起来。

一个常见的约定是**按原子分组**，即首先是原子1的$(x_1, y_1, z_1)$坐标，然后是原子2的$(x_2, y_2, z_2)$坐标，以此类推，直到原子$N$。这样，第$t$帧的构象就被表示为一个$3N$维的列向量$\mathbf{x}_t$：
$$
\mathbf{x}_t = \begin{pmatrix} x_1(t) \\ y_1(t) \\ z_1(t) \\ \vdots \\ x_N(t) \\ y_N(t) \\ z_N(t) \end{pmatrix} \in \mathbb{R}^{3N}
$$
通过将所有$T$帧的构象向量作为行向量[排列](@entry_id:136432)，我们就构建了**轨迹矩阵** $X \in \mathbb{R}^{T \times 3N}$ [@problem_id:3437381]：
$$
X = \begin{pmatrix} \mathbf{x}_1^\top \\ \mathbf{x}_2^\top \\ \vdots \\ \mathbf{x}_T^\top \end{pmatrix}
$$
这个矩阵的每一行代表一个时间点的系统构象，每一列则代表一个特定原子在特定笛卡尔轴上的坐标随时间的变化。

#### 对齐轨迹：移除刚体运动

在分析分子的**内部运动**（如柔性环的开合、[蛋白质结构域](@entry_id:165258)的[相对运动](@entry_id:169798)）之前，必须移除整体的**[刚体运动](@entry_id:193355)**，即分子的平移和旋转。如果不这样做，分子的整体漂移和翻滚这种通常在能量上无关紧要的运动，会因为其巨大的振幅而主导分析结果，掩盖我们真正关心的内部[构象变化](@entry_id:185671)。

标准的做法是通过**结构叠合**（superposition）来移除刚体运动。通常选择第一帧或所有帧的平均结构作为参考结构。然后，对于轨迹中的每一帧，通过平移和旋转操作，使其与参考结构的[均方根偏差](@entry_id:170440)（RMSD）最小化。经过此步骤后，轨迹矩阵$X$中的构象变化主要反映了系统内部自由度的运动。

#### 中心化数据：聚焦于涨落

PCA旨在分析系统围绕其平均构象的涨落。因此，我们需要从每一帧的坐标中减去整个轨迹的**平均坐标**。首先，我们计算平均构象向量 $\bar{\mathbf{x}}$，它是所有帧向量的[算术平均值](@entry_id:165355)：
$$
\bar{\mathbf{x}} = \frac{1}{T} \sum_{t=1}^{T} \mathbf{x}_t \in \mathbb{R}^{3N}
$$
这个向量$\bar{\mathbf{x}}$代表了系统在模拟过程中的平均结构。然后，我们将轨迹矩阵$X$的每一行都减去平均构象的[转置](@entry_id:142115)$\bar{\mathbf{x}}^\top$，得到**中心化轨迹矩阵**$X_c$：
$$
X_c = X - \mathbf{1} \bar{\mathbf{x}}^\top
$$
其中，$\mathbf{1}$是一个$T \times 1$的全1列向量。$X_c$的第$t$行是向量$(\mathbf{x}_t - \bar{\mathbf{x}})^\top$，它表示第$t$帧构象相对于平均构象的**位移**或**涨落** [@problem_id:3437381]。PCA将直接应用于这个代表纯粹涨落的矩阵$X_c$。

#### 一个关键的实践步骤：在周期性边界条件下展开轨迹

在许多MD模拟中，为了模拟体相环境，会采用**周期性边界条件（PBC）**。这意味着当一个分子或原子穿过模拟盒的一侧时，它会从相对的一侧重新进入。在记录[坐标时](@entry_id:263720)，通常会将其位置“包裹”在[主模](@entry_id:263463)拟盒子内，这称为**成像（imaging）**。

这种包裹操作会引入非物理的坐标跳跃。例如，一个粒子平稳地从$x=0.98$ nm移动到物理上的$x=1.02$ nm，在一个边长为$L_x=1.0$ nm的盒子中，其记录坐标会从$x=0.98$ nm突变为$x=0.02$ nm [@problem_id:3437444]。如果不处理这个-0.96 nm的人为跳跃，它将在$x$方向上产生巨大的、虚假的[方差](@entry_id:200758)，从而完全扭曲PCA的结果，使得主成分错误地对齐到这个非物理的边界穿越事件上。

因此，在进行PCA之前，对轨迹进行**展开（unwrapping）**是至关重要的。展开过程通过追踪边界穿越事件，将整数倍的盒子向量加回到后续帧的坐标上，从而重建一个连续的、代表真实物理路径的轨迹 [@problem_id:3443667] [@problem_id:3437444]。只有在展开后的连续坐标上进行叠合、中心化和PCA，才能得到有物理意义的结果。

### 协方差矩阵：量化关联运动

在获得了中心化的涨落矩阵$X_c$后，下一步是构建**[协方差矩阵](@entry_id:139155)** $C$。这个矩阵是PCA的核心，它定量地描述了系统中所有原子坐标涨落之间的[线性关系](@entry_id:267880)。

#### 定义与计算

协方差矩阵 $C \in \mathbb{R}^{3N \times 3N}$ 是根据中心化数据矩阵 $X_c$ 计算得到的。其标准定义为：
$$
C = \frac{1}{T-1} X_c^{\top} X_c
$$
这里，除以$T-1$（而不是$T$）是为了得到样本协[方差](@entry_id:200758)的**无偏估计**。$X_c^\top$是$X_c$的[转置](@entry_id:142115)，维度为$3N \times T$。这个矩阵乘法 $X_c^{\top} X_c$ 的结果是一个$3N \times 3N$的方阵，这正是我们所需要的[协方差矩阵](@entry_id:139155)的维度 [@problem_id:3437429]。

#### 协方差矩阵元素的诠释

[协方差矩阵](@entry_id:139155)$C$的每一个元素$C_{ab}$都有明确的物理意义。假设索引$a$和$b$（从1到$3N$）分别对应原子$i$的$\alpha$坐标（如$x$）和原子$j$的$\beta$坐标（如$y$）：
- **对角[线元](@entry_id:196833)素 $C_{aa}$**：表示第$a$个坐标（原子$i$的$\alpha$坐标）随时间涨落的**[方差](@entry_id:200758)**。它量化了该原子在该方向上运动的幅度大小。所有对角[线元](@entry_id:196833)素之和，即矩阵的迹 $\operatorname{Tr}(C)$，代表了整个系统在所有笛卡尔自由度上的总[方差](@entry_id:200758)（总均方涨落）。

- **非对角[线元](@entry_id:196833)素 $C_{ab}$**：表示第$a$和第$b$个坐标（原子$i$的$\alpha$坐标和原子$j$的$\beta$坐标）之间的**协[方差](@entry_id:200758)**。它量化了这两个位移协同运动的程度 [@problem_id:3437429]。
    - 如果 $C_{ab} > 0$，表示这两个坐标倾向于向相同的方向运动（正相关）。例如，两个原子同时向上移动。
    - 如果 $C_{ab}  0$，表示它们倾向于向相反的方向运动（负相关）。例如，一个原子向上移动时，另一个原子向下移动。
    - 如果 $C_{ab} \approx 0$，表示它们的运动是线性无关的。

因此，协方差矩阵是一个包含了系统所有原子之间所有两两关联运动信息的“指纹图谱”。

### [特征分解](@entry_id:181333)：识别主成分

构建了协方差矩阵之后，PCA的数学核心步骤是对其进行**[特征分解](@entry_id:181333)**（也称**[谱分解](@entry_id:173707)**）。由于$C$是[实对称矩阵](@entry_id:192806)，它可以被对角化，其[特征向量](@entry_id:151813)构成一组[正交基](@entry_id:264024)。

#### [特征值问题](@entry_id:142153)

[特征分解](@entry_id:181333)旨在求解以下[特征值方程](@entry_id:192306)：
$$
C v_k = \lambda_k v_k
$$
其中：
- $v_k \in \mathbb{R}^{3N}$ 是第$k$个**[特征向量](@entry_id:151813)**。
- $\lambda_k$ 是与$v_k$对应的**[特征值](@entry_id:154894)**，是一个标量。

由于$C$是半正定的，所有的[特征值](@entry_id:154894)$\lambda_k$都是非负的（$\lambda_k \ge 0$）。我们可以将它们按从大到小的顺序[排列](@entry_id:136432)：$\lambda_1 \ge \lambda_2 \ge \dots \ge \lambda_{3N} \ge 0$。

#### [特征向量](@entry_id:151813)作为集体运动模式

每个[特征向量](@entry_id:151813)$v_k$被称为一个**主成分（Principal Component, PC）**。它是一个$3N$维的[单位向量](@entry_id:165907)，描述了一种特定的**集体运动模式**。向量$v_k$中的元素定义了在该模式下，系统中每个原子的位移方向和相对幅度。例如，如果$v_1$的元素指示蛋白质的两个结构域朝相反方向移动，那么PC1就代表了这两个结构域的“铰链”式运动。这些[特征向量](@entry_id:151813)是正交的（$v_k^\top v_j = \delta_{kj}$），意味着它们所描述的运动模式在数学上是[线性独立](@entry_id:153759)的。

#### [特征值](@entry_id:154894)作为[方差](@entry_id:200758)的度量

每个[特征值](@entry_id:154894)$\lambda_k$的物理意义是系统沿其对应的主成分$v_k$方向运动的**[方差](@entry_id:200758)**。换句话说，$\lambda_k$量化了系统在第$k$种[集体运动](@entry_id:747472)模式上[构象涨落](@entry_id:193752)的幅度。

由于[特征值](@entry_id:154894)按大小排序，$\lambda_1$是最大的，这意味着PC1（$v_1$）是系统中涨落幅度最大的运动方向。PC2（$v_2$）是在与PC1正交的所有方向中，涨落幅度最大的方向，依此类推。因此，PCA通过[特征分解](@entry_id:181333)，成功地将复杂的、高度关联的原子运动分解为一系列独立的、按重要性（涨落幅度）排序的[集体运动](@entry_id:747472)模式。

### 降维与物理诠释

PCA最强大的功能之一是其能够以一种最优的方式降低系统的维度，从而让我们能够聚焦于少数几个“本质”的运动模式。

#### 总[方差](@entry_id:200758)与解释[方差](@entry_id:200758)

如前所述，[协方差矩阵](@entry_id:139155)的迹等于系统在[笛卡尔坐标](@entry_id:167698)下的总[方差](@entry_id:200758)。同时，[矩阵的迹](@entry_id:139694)也等于其所有[特征值](@entry_id:154894)之和：
$$
\operatorname{Tr}(C) = \sum_{k=1}^{3N} C_{kk} = \sum_{k=1}^{3N} \lambda_k
$$
这说明，总[方差](@entry_id:200758)被完美地分配到了各个主成分上。第$k$个主成分“贡献”了$\lambda_k$的[方差](@entry_id:200758)。

我们可以计算前$m$个主成分所能**解释的累积[方差](@entry_id:200758)百分比** $f_m$：
$$
f_m = \frac{\sum_{k=1}^{m} \lambda_k}{\sum_{k=1}^{3N} \lambda_k}
$$
在许多[生物分子](@entry_id:176390)系统中，前几个（例如，前2到10个）主成分往往就能解释总[方差](@entry_id:200758)的70%到90% [@problem_id:3443667]。这意味着系统绝大多数的[构象变化](@entry_id:185671)都发生在由这几个主成分定义的低维[子空间](@entry_id:150286)中。这种现象被称为**本质动力学（Essential Dynamics）**，即系统的动力学行为主要由少数几个大幅度的集体运动控制。

#### 投影、重构与最优性

我们可以将原始的高维轨迹数据投影到由最重要的几个主成分张成的低维[子空间](@entry_id:150286)上。对于每一帧的涨落向量 $\delta \mathbf{x}_t = \mathbf{x}_t - \bar{\mathbf{x}}$，其在第$k$个主成分上的投影（或称为**分数**）$z_{tk}$由下式给出：
$$
z_{tk} = \delta \mathbf{x}_t^\top v_k
$$
如果我们只保留前$k$个主成分，我们可以利用这些投影值来**重构**一个近似的涨落向量 $\hat{\mathbf{x}}_t$：
$$
\hat{\mathbf{x}}_t = \sum_{j=1}^{k} z_{tj} v_j = V_k V_k^\top \delta \mathbf{x}_t
$$
其中$V_k$是包含前$k$个[特征向量](@entry_id:151813)作为列的矩阵。

PCA的一个关键理论性质是其**最优性**。对于任何给定的维数$k$，PCA投影是最小化平均重构误差的最佳线性投影。重构的残差为 $\mathbf{r}_t = \delta \mathbf{x}_t - \hat{\mathbf{x}}_t$。可以证明，在整个轨迹上的平均平方重构误差恰好等于被忽略掉的那些主成分的[方差](@entry_id:200758)之和 [@problem_id:3437439]：
$$
\frac{1}{T} \sum_{t=1}^{T} \|\mathbf{r}_t\|^2 \approx \sum_{j=k+1}^{3N} \lambda_j
$$
这个优美的结果意味着，通过保留[特征值](@entry_id:154894)最大的主成分，我们确保了在丢弃信息时，损失的[方差](@entry_id:200758)（即信息量）是最小的。

### 物理基础与高级方法

标准的PCA在[笛卡尔坐标](@entry_id:167698)下对所有原子的位移一视同仁。然而，通过引入物理原理，我们可以发展出更具洞察力的分析方法。

#### 质量加权PCA：引入物理真实性

##### 源于动能的启示
在经典力学中，一个系统的动能 $T_{kin}$ 是一个关于速度的二次型：
$$
T_{kin} = \frac{1}{2} \sum_{i=1}^N m_i \|\dot{\mathbf{r}}_i\|^2 = \frac{1}{2} \dot{\mathbf{x}}^\top M \dot{\mathbf{x}}
$$
其中$M$是对角线上为各原子质量$m_i$（每个重复三次）的$3N \times 3N$对角**[质量矩阵](@entry_id:177093)**。这个表达式表明，物理上更自然的“度量”应该考虑原子质量。我们可以通过一个坐标变换 $\mathbf{y} = M^{1/2} \mathbf{x}$ 来使用这个**动能度量**，其中$M^{1/2}$是对角元素为$\sqrt{m_i}$的对角矩阵。在这个新的[质量加权坐标](@entry_id:164904)系中，动能简化为标准的欧几里得形式 $\frac{1}{2}\dot{\mathbf{y}}^\top\dot{\mathbf{y}}$ [@problem_id:3437393]。

将这个思想应用于PCA，我们分析**质量加权[协方差矩阵](@entry_id:139155)** $C_m$：
$$
C_m = \langle \mathbf{y}\mathbf{y}^\top \rangle = \langle (M^{1/2}\mathbf{x})(M^{1/2}\mathbf{x})^\top \rangle = M^{1/2} \langle \mathbf{x}\mathbf{x}^\top \rangle (M^{1/2})^\top = M^{1/2} C M^{1/2}
$$
对$C_m$进行[特征分解](@entry_id:181333)，即为**质量加权PCA**。

##### 与等权重PCA的比较
等权重（标准）PCA和质量加权PCA所揭示的主要运动模式可能显著不同。
- **等权重PCA** 倾向于突出**几何位移幅度最大**的运动。在一个包含重原子骨架和轻原子侧链的蛋白质中，即使侧链的运动能量上不重要，但只要其摆动幅度大，就可能主导前几个主成分。
- **质量加权PCA** 通过乘以质量因子，放大了重原子的贡献。一个重原子（如金属离子）的小幅度运动，或者一个重原子骨架（如蛋白质[主链](@entry_id:183224)）的协同小幅运动，可能在能量上比一个轻原子（如氢）的大幅摆动更重要。质量加权PCA能够捕捉到这些能量上更显著的运动模式，即使它们的几何位移不大 [@problem_id:3437426]。

##### 与原子涨落（RMSF）的联系
质量加权PCA的总[方差](@entry_id:200758)与一个常见的MD分析量——**均方根涨落（RMSF）**——有着直接的联系。原子$i$的RMSF定义为 $\text{RMSF}_i = \sqrt{\langle \|\mathbf{r}_i(t) - \bar{\mathbf{r}}_i\|^2 \rangle}$。可以证明，质量加权[协方差矩阵](@entry_id:139155)的迹等于所有原子质量加权的均方涨落之和 [@problem_id:3443667]：
$$
\operatorname{Tr}(C_m) = \sum_{k=1}^{3N} \lambda_k^{(m)} = \sum_{i=1}^N m_i \text{RMSF}_i^2
$$
这个恒等式为质量加权PCA提供了坚实的物理基础，表明它分解的是系统中总的质量加权涨落。

#### 与[简正模分析](@entry_id:176817)（NMA）的联系

[简正模分析](@entry_id:176817)（NMA）是另一种研究[分子振动](@entry_id:140827)的理论方法。它通过在[势能面](@entry_id:147441)（PES）的一个极小值点[对势能](@entry_id:203104)进行二次近似（[谐振子近似](@entry_id:268588)），然后求解描述小幅度[振动](@entry_id:267781)的[运动方程](@entry_id:170720)。

##### [谐振子](@entry_id:155622)极限：当PCA与NMA重合时
在特定条件下，PCA和NMA会给出相同的结果。假设一个系统在温度$T$的正则系综下进行采样，并且其运动被限制在一个单一的、谐性的[势能](@entry_id:748988)阱中。在这种情况下，可以从[统计力](@entry_id:194984)学严格推导出，涨落的协方差矩阵$C$与[势能](@entry_id:748988)的Hessian矩阵（[力常数](@entry_id:156420)矩阵）$K$的逆成正比 [@problem_id:3437401]：
$$
C = k_B T K^{-1}
$$
其中 $k_B$ 是玻尔兹曼常数。如果进行质量加权分析，这个关系会变得更加深刻：质量加权PCA的[特征向量](@entry_id:151813)（主成分）与NMA的[简正模](@entry_id:139640)完全相同。它们的[特征值](@entry_id:154894)（[方差](@entry_id:200758)）与[简正模频率](@entry_id:169246)$\omega_k$之间存在简单的反比关系 [@problem_id:3437380]：
$$
\lambda_k^{(m)} = \frac{k_B T}{\omega_k^2}
$$
这个关系源于[能量均分定理](@entry_id:136972)。它表明，在[谐振子](@entry_id:155622)极限下，PCA识别出的最大[方差](@entry_id:200758)运动（最大的$\lambda_k$）恰好是系统最“软”的[振动](@entry_id:267781)模式（最小的$\omega_k$）。

##### 超越[谐振子](@entry_id:155622)极限：[非谐性](@entry_id:137191)与多[势阱](@entry_id:151413)采样
PCA的真正威力在于它不局限于[谐振子近似](@entry_id:268588)。当以下情况发生时，PCA和NMA的结果会分道扬镳：
- **非谐性**：即使在一个[势阱](@entry_id:151413)内，如果[势能面](@entry_id:147441)存在显著的非二次项（非谐性），涨落的统计分布将不再是[高斯分布](@entry_id:154414)。这会导致PCA模式与简正模发生偏离 [@problem_id:3437380]。
- **多[势阱](@entry_id:151413)采样**：如果MD模拟的时间足够长，系统可能会在多个[势能](@entry_id:748988)极小值（即不同的构象状态）之间来回转换。在这种情况下，NMA只能描述某个单一构象周围的小幅[振动](@entry_id:267781)。而PCA，作为一种统计方法，其[方差](@entry_id:200758)最大的主成分将不再是小幅[振动](@entry_id:267781)，而是描述这些主要构象状态之间转换的路径。这正是PCA被广泛用于研究[蛋白质构象变化](@entry_id:186291)等大规模功能性运动的原因 [@problem_id:3437380]。

#### [坐标系](@entry_id:156346)的选择：[笛卡尔坐标](@entry_id:167698) vs. [内坐标](@entry_id:169764)

到目前为止，我们主要讨论了在（质量加权的）[笛卡尔坐标](@entry_id:167698)中进行PCA。然而，我们也可以选择在**[内坐标](@entry_id:169764)**（如键长、键角、[二面角](@entry_id:185221)）中进行分析。

[内坐标](@entry_id:169764)的一个直接好处是它们自然地满足平移和[旋转不变性](@entry_id:137644)，因此省去了结构叠合的步骤。此外，由于[内坐标](@entry_id:169764)的计算本质上是基于原子间的相对位置，它们对[周期性边界条件](@entry_id:147809)下的“包裹”问题是免疫的，因此也无需进行轨迹展开 [@problem_id:3437444]。

然而，从[笛卡尔坐标](@entry_id:167698)到[内坐标](@entry_id:169764)的转换 $\phi: \mathbb{R}^{3N} \to \mathbb{R}^{d}$ 是一个高度**[非线性](@entry_id:637147)**的映射。当我们在[内坐标](@entry_id:169764)空间中进行PCA时，我们实际上是在用一个由该映射诱导的、非欧几里得的度量来衡量笛卡尔空间中的涨落。对于小的涨落，[内坐标](@entry_id:169764)的变化 $\delta\mathbf{y}$ 和[笛卡尔坐标](@entry_id:167698)的变化 $\delta\mathbf{x}$ 可以通过雅可比矩阵 $\mathbf{J} = \partial\phi/\partial\mathbf{x}$ 线性关联：$\delta\mathbf{y} \approx \mathbf{J} \delta\mathbf{x}$。[内坐标](@entry_id:169764)空间的[欧几里得度量](@entry_id:147197) $\|\delta\mathbf{y}\|^2$ 在笛卡尔空间中对应的度量张量是 $\mathbf{G} = \mathbf{J}^\top\mathbf{J}$。

因此，在[内坐标](@entry_id:169764)中进行PCA，相当于在笛卡尔空间中寻找在度量$\mathbf{G}$下最大化[方差](@entry_id:200758)的方向。这会倾向于放大那些能引起[内坐标](@entry_id:169764)剧烈变化的笛卡尔运动（例如，一个小的笛卡尔位移可能导致一个大的[二面角](@entry_id:185221)变化）。选择何种[坐标系](@entry_id:156346)取决于研究的具体问题，笛卡尔坐标更易于可视化和解释[集体运动](@entry_id:747472)，而[内坐标](@entry_id:169764)则可能更适合研究特定化学自由度的变化 [@problem_id:3437399]。