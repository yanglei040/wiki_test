{"hands_on_practices": [{"introduction": "任何粗粒度模拟的第一步都是定义“映射”——即如何将全原子表示中的原子团簇凝聚为单个粗粒度珠子的规则。一个成功的映射方案并非随意的；它必须保留原始分子的核心化学功能。本练习 [@problem_id:3453034] 旨在挑战您像力场开发者一样思考，应用 MARTINI 哲学为乙醇（一个简单但重要的两亲分子）构建一个化学上合理的映射方案。", "problem": "像乙醇这样的小两亲分子在粗粒化力场中必须以保留其主要化学功能的方式来表示。在 MARTINI 粗粒化力场中，原子组被合并成称为珠子（bead）的相互作用位点。典型的映射规则将大约 $2$–$4$ 个重原子合并成一个珠子，并分配珠子类型以编码极性、氢键能力和非极性特征，从而控制有效的非键相互作用强度。辛醇-水分配系数，记为 $K_{\\mathrm{ow}}$，定义为平衡时 $K_{\\mathrm{ow}} = c_{\\mathrm{o}}/c_{\\mathrm{w}}$，其中 $c_{\\mathrm{o}}$ 和 $c_{\\mathrm{w}}$ 分别是溶质在正辛醇相和水相中的浓度。从水到辛醇的转移热力学自由能与 $K_{\\mathrm{ow}}$ 的关系为 $\\Delta G_{\\mathrm{w}\\to \\mathrm{o}} = - R T \\ln K_{\\mathrm{ow}}$，其中 $R$ 是气体常数，$T$ 是温度。一个化学上合理的粗粒化映射应该产生遵循主要化学相互作用的溶剂化和分配行为：羟基与水的氢键作用，以及烷基与非极性环境的色散相互作用。\n\n考虑原子连接性为 $\\mathrm{CH}_3{-}\\mathrm{CH}_2{-}\\mathrm{OH}$ 的乙醇。选择最符合 MARTINI 哲学以及物理上真实的溶剂化和辛醇-水分配的映射和珠子类型分配。每个选项都指定了原子组到珠子的映射，并预测了水溶剂化和 $\\Delta G_{\\mathrm{w}\\to \\mathrm{o}}$ 符号的定性结果。\n\nA. 将乙醇映射为两个珠子：将 $\\mathrm{CH}_2{-}\\mathrm{OH}$ 基团合并为一个极性氢键珠子（记为P类，既能作为氢键供体也能作为氢键受体），将末端的 $\\mathrm{CH}_3$ 合并为一个非极性珠子（记为C类）。预测极性珠子有利于水溶剂化，非极性珠子有利于辛醇溶剂化，且净辛醇-水转移自由能满足 $\\Delta G_{\\mathrm{w}\\to \\mathrm{o}} > 0$（即 $K_{\\mathrm{ow}}  1$），反映了对水的轻微偏好。\n\nB. 将乙醇映射为单个珠子：将所有原子 $\\mathrm{CH}_3{-}\\mathrm{CH}_2{-}\\mathrm{OH}$ 合并为一个强极性珠子（记为P类，具有非常高的极性，有效模拟一个完全形成氢键的溶质）。预测非常强的水溶剂化和对辛醇的强烈不利转移，$\\Delta G_{\\mathrm{w}\\to \\mathrm{o}} \\gg 0$（即 $K_{\\mathrm{ow}} \\ll 1$）。\n\nC. 将乙醇映射为两个珠子：将 $\\mathrm{CH}_3$ 和 $\\mathrm{CH}_2{-}\\mathrm{OH}$ 基团都分配为非极性珠子（记为C类），从而忽略了氢键能力。预测弱水溶剂化、强辛醇溶剂化，且 $\\Delta G_{\\mathrm{w}\\to \\mathrm{o}}  0$（即 $K_{\\mathrm{ow}} > 1$）。\n\nD. 将乙醇映射为两个珠子：将 $\\mathrm{CH}_2{-}\\mathrm{OH}$ 基团分配为一个带电珠子（记为Q类，带有净电荷以模拟离子行为），将 $\\mathrm{CH}_3$ 基团分配为一个非极性珠子（C类）。预测由长程静电驱动的非常强的水溶剂化、在水溶液中的类盐行为，且 $\\Delta G_{\\mathrm{w}\\to \\mathrm{o}} \\gg 0$（即 $K_{\\mathrm{ow}} \\ll 1$）。\n\n基于上述定义以及关于氢键、色散和关系式 $\\Delta G_{\\mathrm{w}\\to \\mathrm{o}} = - R T \\ln K_{\\mathrm{ow}}$ 的第一性原理推理，哪个选项最符合化学上合理的 MARTINI 映射，并能得出定性正确的乙醇溶剂化和分配行为？", "solution": "用户请求对一个关于使用 MARTINI 力场对乙醇进行粗粒化建模的问题进行分析。\n\n### 问题验证\n\n**第1步：提取已知条件**\n\n*   **分子**：乙醇，原子连接性为 $\\mathrm{CH}_3{-}\\mathrm{CH}_2{-}\\mathrm{OH}$。\n*   **力场**：MARTINI 粗粒化力场。\n*   **MARTINI 原则**：\n    *   原子组被合并成相互作用位点（珠子）。\n    *   映射规则：“大约 $2$–$4$ 个重原子”被合并成一个珠子。\n    *   珠子类型编码极性、氢键能力和非极性特征。\n    *   目标：保留主要的化学功能（例如，对于两亲分子，保留羟基的氢键作用和烷基的色散相互作用）。\n*   **定义**：\n    *   辛醇-水分配系数：$K_{\\mathrm{ow}} = c_{\\mathrm{o}}/c_{\\mathrm{w}}$，其中 $c_{\\mathrm{o}}$ 和 $c_{\\mathrm{w}}$ 分别是溶质在正辛醇和水中的浓度。\n    *   从水到辛醇的转移自由能：$\\Delta G_{\\mathrm{w}\\to \\mathrm{o}} = - R T \\ln K_{\\mathrm{ow}}$，其中 R 是气体常数，T 是温度。\n*   **问题**：确定哪个选项提供的映射和珠子类型分配最符合 MARTINI 哲学和物理上真实的乙醇溶剂化/分配行为。\n\n**第2步：使用提取的已知条件进行验证**\n\n*   **科学依据**：该问题在物理化学和计算生物物理学的原理上有很好的基础。MARTINI 力场是一种广泛使用且成熟的方法。$K_{\\mathrm{ow}}$ 的定义及其与转移自由能 $\\Delta G_{\\mathrm{w}\\to \\mathrm{o}}$ 的关系是基本的热力学概念。对乙醇化学性质的描述是准确的。\n*   **问题定义明确**：问题定义明确。它要求根据一组明确陈述的原则（MARTINI 哲学）和已知的物理现实（乙醇的溶剂化性质）对给定选项进行比较分析。预期有一个唯一的最佳答案。\n*   **客观性**：问题以客观、技术性的语言陈述，没有歧义或主观性陈述。\n\n**第3步：结论和行动**\n\n问题陈述在科学上是合理的、自洽的且定义明确。它是有效的。可以开始求解过程。\n\n### 求解推导\n\n分析需要将 MARTINI 力场的原理与已知的乙醇物理化学性质相结合。\n\n**1. 分析乙醇的性质**\n乙醇（$\\mathrm{CH}_3{-}\\mathrm{CH}_2{-}\\mathrm{OH}$）是一个小的两亲分子。它拥有一个极性的、可形成氢键的羟基（$\\mathrm{-OH}$），这赋予了它在水中的高溶解度，以及一个短的、非极性的乙基（$\\mathrm{CH}_3{-}\\mathrm{CH}_2{-}$），它能与像辛醇这样的非极性环境良好地相互作用。实验上，乙醇与水可以任意比例互溶。它的辛醇-水分配系数 $\\log_{10} K_{\\mathrm{ow}}$ 约为 $-0.31$，这得出 $K_{\\mathrm{ow}} = 10^{-0.31} \\approx 0.49$。\n使用给定的热力学关系式 $\\Delta G_{\\mathrm{w}\\to \\mathrm{o}} = - R T \\ln K_{\\mathrm{ow}}$：\n由于 $K_{\\mathrm{ow}} \\approx 0.49  1$，其自然对数 $\\ln K_{\\mathrm{ow}}$ 为负。\n因此，转移自由能为正：$\\Delta G_{\\mathrm{w}\\to \\mathrm{o}} > 0$。这表明乙醇在热力学上对水相有轻微的偏好，胜过辛醇相，尽管它在两者中都可溶。一个化学上合理的模型必须能重现这种定性行为。\n\n**2. 分析 MARTINI 映射哲学**\n问题陈述了两个关键原则：\n*   每个珠子映射大约 $2$–$4$ 个重原子。乙醇有 $3$ 个重原子（两个碳，一个氧）。这意味着 $1$ 珠或 $2$ 珠表示法都是可能的。\n*   映射必须“保留其主要的化学功能”。对于像乙醇这样的两亲分子，这意味着要捕捉到极性头部（-OH）和非极性尾部（$\\mathrm{CH}_3{-}\\mathrm{CH}_2{-}$）的不同特性。双珠模型本质上更擅长这项任务，因为单个珠子会平均掉这些不同的性质。\n\n**3. 评估每个选项**\n\n**A. 将乙醇映射为两个珠子：将 $\\mathrm{CH}_2{-}\\mathrm{OH}$ 基团合并为一个极性氢键珠子（记为P类，既能作为氢键供体也能作为氢键受体），将末端的 $\\mathrm{CH}_3$ 合并为一个非极性珠子（记为C类）。预测极性珠子有利于水溶剂化，非极性珠子有利于辛醇溶剂化，且净辛醇-水转移自由能满足 $\\Delta G_{\\mathrm{w}\\to \\mathrm{o}} > 0$（即 $K_{\\mathrm{ow}}  1$），反映了对水的轻微偏好。**\n\n*   **映射一致性**：这种双珠映射（$\\mathrm{CH}_3$ 和 $\\mathrm{CH}_2{-}\\mathrm{OH}$）有效地将分子分成了更非极性的部分和更极性的部分。$\\mathrm{CH}_2{-}\\mathrm{OH}$ 珠子包含了关键的官能团。这明确地保留了两亲性质，这是 MARTINI 哲学的一个关键目标。珠子的大小（$\\mathrm{CH}_3$ 有1个重原子，$\\mathrm{CH}_2{-}\\mathrm{OH}$ 有2个）对于一个珠子来说略微超出了“2-4”规则，但为了更好地表示化学性质，这个规则对小分子常常放宽。将含羟基的基团分配为极性（P）类型，将甲基分配为非极性（C）类型是化学上正确的。\n*   **预测一致性**：极性珠子有利于水，非极性珠子有利于辛醇的预测是正确的。关键是，预测的结果 $\\Delta G_{\\mathrm{w}\\to \\mathrm{o}} > 0$（$K_{\\mathrm{ow}}  1$）完美匹配了乙醇已知的实验行为，包括“对水的轻微偏好”。\n*   **结论**：**正确**。该选项提出了一个化学上合理的映射策略，它与所述的 MARTINI 哲学一致，并产生物理上准确的定性预测。\n\n**B. 将乙醇映射为单个珠子：将所有原子 $\\mathrm{CH}_3{-}\\mathrm{CH}_2{-}\\mathrm{OH}$ 合并为一个强极性珠子（记为P类，具有非常高的极性，有效模拟一个完全形成氢键的溶质）。预测非常强的水溶剂化和对辛醇的强烈不利转移，$\\Delta G_{\\mathrm{w}\\to \\mathrm{o}} \\gg 0$（即 $K_{\\mathrm{ow}} \\ll 1$）。**\n\n*   **映射一致性**：对乙醇的 $3$ 个重原子进行单珠映射符合 $2$–$4$ 原子规则。然而，通过将其分类为“强极性”，它忽略了乙基的非极性特征，因此未能“保留其主要的化学功能”（即两亲性）。\n*   **预测一致性**：“非常强的水溶剂化”的预测是合理的，但“对辛醇的强烈不利转移”的预测（$\\Delta G_{\\mathrm{w}\\to \\mathrm{o}} \\gg 0$, $K_{\\mathrm{ow}} \\ll 1$）是与事实不符的。乙醇在辛醇中高度可溶，其对水的偏好仅是轻微的，其 $K_{\\mathrm{ow}} \\approx 0.5$。这个模型描述的是像甘油这样的分子，而不是乙醇。\n*   **结论**：**不正确**。该模型错误地表示了乙醇平衡的两亲特性，并做出了与实验现实不符的预测。\n\n**C. 将乙醇映射为两个珠子：将 $\\mathrm{CH}_3$ 和 $\\mathrm{CH}_2{-}\\mathrm{OH}$ 基团都分配为非极性珠子（记为C类），从而忽略了氢键能力。预测弱水溶剂化、强辛醇溶剂化，且 $\\Delta G_{\\mathrm{w}\\to \\mathrm{o}}  0$（即 $K_{\\mathrm{ow}} > 1$）。**\n\n*   **映射一致性**：这种映射在化学上是荒谬的。包含高度极性和可形成氢键的羟基的 $\\mathrm{CH}_2{-}\\mathrm{OH}$ 基团被错误地分配为非极性（C）珠子。这违反了基本的化学原理和保留功能的目标。\n*   **预测一致性**：弱水溶剂化和 $\\Delta G_{\\mathrm{w}\\to \\mathrm{o}}  0$ 的预测与乙醇的已知行为相反。这描述的是一个小分子烷烃，而不是醇。\n*   **结论**：**不正确**。珠子类型的分配存在根本性缺陷，导致了事实错误的预测。\n\n**D. 将乙醇映射为两个珠子：将 $\\mathrm{CH}_2{-}\\mathrm{OH}$ 基团分配为一个带电珠子（记为Q类，带有净电荷以模拟离子行为），将 $\\mathrm{CH}_3$ 基团分配为一个非极性珠子（C类）。预测由长程静电驱动的非常强的水溶剂化、在水溶液中的类盐行为，且 $\\Delta G_{\\mathrm{w}\\to \\mathrm{o}} \\gg 0$（即 $K_{\\mathrm{ow}} \\ll 1$）。**\n\n*   **映射一致性**：这种映射在化学上是不正确的。乙醇是一个中性分子。羟基是极性的，但它不是离子的，也不带净形式电荷。将其分配为带电（Q）珠子类型是对其化学性质的严重误解。\n*   **预测一致性**：关于类盐行为的预测是不正确的。带电物质确实会有非常大的正 $\\Delta G_{\\mathrm{w}\\to \\mathrm{o}}$ 并且几乎不溶于辛醇，但乙醇不是离子。\n*   **结论**：**不正确**。珠子类型的分配在化学上是无效的，导致了描述离子物质而非乙醇的预测。\n\n### 结论\n\n比较这些选项，选项A是唯一一个提出了化学上合理的映射来表示乙醇的两亲性，并做出了与实验事实定性一致的预测（$\\Delta G_{\\mathrm{w}\\to \\mathrm{o}} > 0$，对水有轻微偏好）。其他选项要么在化学表示上存在缺陷，要么在物理预测上存在缺陷。", "answer": "$$\\boxed{A}$$", "id": "3453034"}, {"introduction": "在定义了分子映射之后，下一个关键任务是对珠子间的相互作用进行参数化，以确保它们的物理行为是准确的。MARTINI 哲学的一个基石是其再现实验热力学数据的能力，例如分子在不同环境之间转移的自由能。本练习 [@problem_id:3453093] 将引导您完成一项基本的参数化任务：调整 Lennard-Jones 相互作用参数以匹配目标溶剂化自由能差异，从而阐明微观力场参数与宏观热力学可观测量之间的联系。", "problem": "要求您设计一个程序，该程序针对使用 MARTINI 粗粒化力场的粗粒化分子动力学模型，计算一个 Lennard-Jones 交叉相互作用势阱深度参数，该参数能够再现一个溶质珠子插入两种不同溶剂时的预设溶剂化自由能差。您必须从第一性原理出发，推导出一个可解的表达式，将交叉相互作用参数与插入的过剩化学势联系起来，然后实现该计算以及一个离散化步骤，该步骤需反映 MARTINI 哲学中采用一组有限的相互作用强度的思想。\n\n使用以下与上下文相符的基本原理：\n- 牛顿第二运动定律和势能的定义。\n- Lennard-Jones 势 $u_{\\mathrm{LJ}}(r) = 4\\epsilon\\left[\\left(\\dfrac{\\sigma}{r}\\right)^{12} - \\left(\\dfrac{\\sigma}{r}\\right)^{6}\\right]$，其中 $\\epsilon$ 是势阱深度，$\\sigma$ 是尺寸参数。\n- 溶剂中溶质珠子的过剩化学势的 Widom 插入公式 $\\mu_{\\mathrm{ex}} = -k_{\\mathrm{B}} T \\ln \\left\\langle \\exp\\left(-\\dfrac{\\Delta U}{k_{\\mathrm{B}} T}\\right)\\right\\rangle$，以及在平均场、低密度涨落条件下的近似，即主要贡献来自于对势的吸引尾部对溶剂数密度和对关联函数的积分。\n- 在没有特定于基质的校准时，交叉相互作用势阱深度的 Lorentz-Berthelot 混合定则基线 $\\epsilon_{ij}^{\\mathrm{LB}} = \\sqrt{\\epsilon_{ii}\\epsilon_{jj}}$。\n\n假设溶剂是均匀的，数密度为 $\\rho$，并且对关联函数在排斥核心最小值之外满足 $g(r) \\approx 1$。对于 $r \\ge r_{\\mathrm{m}}$（其中 $r_{\\mathrm{m}} = 2^{1/6}\\sigma$），用其吸引尾部 $u_{\\mathrm{attr}}(r)$ 替换全势，并积分至截断距离 $r_{\\mathrm{c}}$，以获得将珠子 $i$ 插入溶剂 $j$ 的过剩化学势 $\\mu_{\\mathrm{ex}}^{i\\in j}$ 与交叉相互作用势阱深度 $\\epsilon_{ij}$ 之间的近似线性关系。使用此线性关系，用已知量表示目标溶剂化自由能差 $\\Delta\\Delta G = \\mu_{\\mathrm{ex}}^{i\\in B} - \\mu_{\\mathrm{ex}}^{i\\in A}$，并求解所需的 $\\epsilon_{iB}$。\n\n根据平均场表达式构建连续的 $\\epsilon_{iB}$ 后，论证并应用以下任一方法：\n- 基于混合定则的标度：将 $\\epsilon_{iB}$ 与 Lorentz-Berthelot 基线 $\\epsilon_{iB}^{\\mathrm{LB}}$ 进行比较，并报告标度因子 $s = \\epsilon_{iB}/\\epsilon_{iB}^{\\mathrm{LB}}$，或者\n- 矩阵查找：将 $\\epsilon_{iB}$ 规整到代表 MARTINI 粗粒化水平的离散集合中的最近值，此处选为 $\\{2.0,2.5,3.0,3.5,4.0,4.5,5.0,5.5\\}$，单位为 $\\mathrm{kJ/mol}$。\n\n您的程序必须：\n1. 计算溶质在溶剂 A 中的 Lorentz-Berthelot 基线交叉相互作用为 $\\epsilon_{iA}^{\\mathrm{LB}} = \\sqrt{\\epsilon_{ii}\\epsilon_{AA}}$，然后使用推导出的平均场表达式计算匹配指定 $\\Delta\\Delta G$ 所需的连续 $\\epsilon_{iB}$。\n2. 计算溶剂 B 的 Lorentz-Berthelot 基线 $\\epsilon_{iB}^{\\mathrm{LB}} = \\sqrt{\\epsilon_{ii}\\epsilon_{BB}}$ 和标度因子 $s = \\epsilon_{iB}/\\epsilon_{iB}^{\\mathrm{LB}}$。\n3. 将 $\\epsilon_{iB}$ 离散化到集合 $\\{2.0,2.5,3.0,3.5,4.0,4.5,5.0,5.5\\}$ 中最接近的值，单位为 $\\mathrm{kJ/mol}$，以获得 $\\epsilon_{iB}^{\\mathrm{disc}}$。\n4. 对于每个测试用例，输出一个包含三个浮点数 $[\\epsilon_{iB}, \\epsilon_{iB}^{\\mathrm{disc}}, s]$ 的列表，每个数都四舍五入到三位小数，单位如上所示。\n\n所有能量以 $\\mathrm{kJ/mol}$ 表示，所有距离以 $\\mathrm{nm}$ 表示，所有数密度以 $\\mathrm{nm}^{-3}$ 表示。角度不使用。您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，$[[x_1,y_1,z_1],[x_2,y_2,z_2]]$）。\n\n使用以下测试套件，它涵盖了理想路径、溶剂化自由能相等、对珠子特性和约束的敏感性、尺寸参数的影响，以及一个导致不连续负势阱深度的不一致目标的边界情况：\n- 测试 $1$：$(\\epsilon_{ii}=5.0,\\epsilon_{AA}=5.0,\\epsilon_{BB}=3.5,\\rho_A=8.5,\\rho_B=6.8,\\sigma=0.47,r_{\\mathrm{c}}=1.2,\\Delta\\Delta G=10.0)$。\n- 测试 $2$：$(\\epsilon_{ii}=5.0,\\epsilon_{AA}=5.0,\\epsilon_{BB}=5.0,\\rho_A=8.0,\\rho_B=8.0,\\sigma=0.47,r_{\\mathrm{c}}=1.2,\\Delta\\Delta G=0.0)$。\n- 测试 $3$：$(\\epsilon_{ii}=4.5,\\epsilon_{AA}=5.5,\\epsilon_{BB}=4.5,\\rho_A=8.5,\\rho_B=7.5,\\sigma=0.47,r_{\\mathrm{c}}=1.2,\\Delta\\Delta G=5.0)$。\n- 测试 $4$：$(\\epsilon_{ii}=3.5,\\epsilon_{AA}=4.5,\\epsilon_{BB}=3.5,\\rho_A=7.0,\\rho_B=5.0,\\sigma=0.43,r_{\\mathrm{c}}=1.2,\\Delta\\Delta G=8.0)$。\n- 测试 $5$：$(\\epsilon_{ii}=3.5,\\epsilon_{AA}=3.5,\\epsilon_{BB}=3.5,\\rho_A=3.0,\\rho_B=6.0,\\sigma=0.47,r_{\\mathrm{c}}=1.2,\\Delta\\Delta G=12.0)$。", "solution": "该问题陈述在科学上是合理的、自洽的且适定的，可以进行严格求解。它要求推导并实现一种方法，用于确定溶质珠子 $i$ 在溶剂 $B$ 中的 Lennard-Jones (LJ) 相互作用参数 $\\epsilon_{iB}$，以再现相对于参考溶剂 $A$ 的目标溶剂化自由能差 $\\Delta\\Delta G$。这是像 MARTINI 这样的粗粒化力场参数化中的常见任务。推导过程从平均场近似下的 Widom 插入公式开始。\n\n问题陈述中关于溶质在参考溶剂中相互作用参数 $\\epsilon_{iA}$ 的值存在一个微小的模糊之处。问题指示“计算溶质在溶剂 A 中的 Lorentz-Berthelot 基线交叉相互作用为 $\\epsilon_{iA}^{\\mathrm{LB}} = \\sqrt{\\epsilon_{ii}\\epsilon_{AA}}$”，但没有明确说明在后续计算中应使用此值作为 $\\epsilon_{iA}$。然而，在此类参数化过程中，建立基线相互作用是一个标准且必要的步骤。因此，最合乎逻辑且物理上合理的解释是假设 $\\epsilon_{iA} = \\epsilon_{iA}^{\\mathrm{LB}}$。有了这个假设，问题就完全明确了，可以按如下方式求解。\n\n将单个溶质粒子插入溶剂的过剩化学势 $\\mu_{\\mathrm{ex}}$ 由 Widom 插入公式给出：\n$$\n\\mu_{\\mathrm{ex}} = -k_{\\mathrm{B}} T \\ln \\left\\langle \\exp\\left(-\\dfrac{\\Delta U}{k_{\\mathrm{B}} T}\\right)\\right\\rangle\n$$\n其中 $\\Delta U$ 是溶质与所有溶剂粒子之间的相互作用能，$k_{\\mathrm{B}}$ 是玻尔兹曼常数，$T$ 是温度，尖括号表示在溶剂构型上的系综平均。\n\n问题指定了一个平均场近似，其中对 $\\mu_{\\mathrm{ex}}$ 的主要贡献来自于在溶剂上积分的势的吸引部分。这等价于高温或弱耦合极限，此时 $\\mu_{\\mathrm{ex}} \\approx \\langle \\Delta U \\rangle$。对于数密度为 $\\rho_j$ 的溶剂 $j$ 中的一个溶质珠子 $i$，平均相互作用能 $\\langle \\Delta U \\rangle$ 为：\n$$\n\\langle \\Delta U \\rangle = \\int_V \\rho_j g_{ij}(r) u_{ij}(r) dV\n$$\n这里，$u_{ij}(r)$ 是对势，$g_{ij}(r)$ 是径向分布函数。问题提供了几个简化假设：\n1. 在排斥核心之外，$r$ 处的对关联函数 $g_{ij}(r) \\approx 1$。\n2. 只考虑 Lennard-Jones 势的吸引部分：$u_{\\mathrm{attr}}(r) = -4\\epsilon_{ij}\\left(\\dfrac{\\sigma}{r}\\right)^{6}$。\n3. 从 LJ 势能最小值的位置 $r_{\\mathrm{m}} = 2^{1/6}\\sigma$ 积分到截断距离 $r_{\\mathrm{c}}$。\n4. 假设所有相互作用的尺寸参数 $\\sigma$ 相同。\n\n基于这些假设，并使用球坐标（其中 $dV = 4\\pi r^2 dr$），将溶质 $i$ 插入溶剂 $j$ 的过剩化学势变为：\n$$\n\\mu_{\\mathrm{ex}}^{i \\in j} \\approx \\int_{r_{\\mathrm{m}}}^{r_{\\mathrm{c}}} \\rho_j (1) \\left(-4\\epsilon_{ij}\\left(\\dfrac{\\sigma}{r}\\right)^{6}\\right) 4\\pi r^2 dr\n$$\n$$\n\\mu_{\\mathrm{ex}}^{i \\in j} \\approx -16\\pi \\rho_j \\epsilon_{ij} \\sigma^6 \\int_{r_{\\mathrm{m}}}^{r_{\\mathrm{c}}} r^{-4} dr\n$$\n该积分的计算结果为：\n$$\n\\int_{r_{\\mathrm{m}}}^{r_{\\mathrm{c}}} r^{-4} dr = \\left[ \\frac{r^{-3}}{-3} \\right]_{r_{\\mathrm{m}}}^{r_{\\mathrm{c}}} = -\\frac{1}{3}\\left(\\frac{1}{r_{\\mathrm{c}}^3} - \\frac{1}{r_{\\mathrm{m}}^3}\\right) = \\frac{1}{3}\\left(\\frac{1}{r_{\\mathrm{m}}^3} - \\frac{1}{r_{\\mathrm{c}}^3}\\right)\n$$\n代入 $r_{\\mathrm{m}}^3 = (2^{1/6}\\sigma)^3 = \\sqrt{2}\\sigma^3$：\n$$\n\\mu_{\\mathrm{ex}}^{i \\in j} \\approx -16\\pi \\rho_j \\epsilon_{ij} \\sigma^6 \\left[ \\frac{1}{3}\\left(\\frac{1}{\\sqrt{2}\\sigma^3} - \\frac{1}{r_{\\mathrm{c}}^3}\\right) \\right] = -\\frac{16\\pi}{3} \\rho_j \\epsilon_{ij} \\sigma^3 \\left(\\frac{1}{\\sqrt{2}} - \\frac{\\sigma^3}{r_{\\mathrm{c}}^3}\\right)\n$$\n这就建立了所要求的线性关系 $\\mu_{\\mathrm{ex}}^{i \\in j} = K_j \\epsilon_{ij}$，其中系数 $K_j$ 取决于溶剂密度 $\\rho_j$ 和几何参数。让我们定义一个仅依赖于几何形状的常数 $C$：\n$$\nC(\\sigma, r_{\\mathrm{c}}) = -\\frac{16\\pi}{3} \\sigma^3 \\left(\\frac{1}{\\sqrt{2}} - \\frac{\\sigma^3}{r_{\\mathrm{c}}^3}\\right)\n$$\n那么，$\\mu_{\\mathrm{ex}}^{i \\in j} = C(\\sigma, r_{\\mathrm{c}}) \\rho_j \\epsilon_{ij}$。\n\n目标量是溶剂化自由能差 $\\Delta\\Delta G = \\mu_{\\mathrm{ex}}^{i\\in B} - \\mu_{\\mathrm{ex}}^{i\\in A}$。代入线性表达式：\n$$\n\\Delta\\Delta G = C(\\sigma, r_{\\mathrm{c}}) \\rho_B \\epsilon_{iB} - C(\\sigma, r_{\\mathrm{c}}) \\rho_A \\epsilon_{iA}\n$$\n我们求解未知的势阱深度 $\\epsilon_{iB}$：\n$$\nC(\\sigma, r_{\\mathrm{c}}) \\rho_B \\epsilon_{iB} = \\Delta\\Delta G + C(\\sigma, r_{\\mathrm{c}}) \\rho_A \\epsilon_{iA}\n$$\n$$\n\\epsilon_{iB} = \\frac{\\Delta\\Delta G}{C(\\sigma, r_{\\mathrm{c}}) \\rho_B} + \\frac{\\rho_A}{\\rho_B} \\epsilon_{iA}\n$$\n使用我们的假设，即参考相互作用由 Lorentz-Berthelot 混合定则给出，我们设置 $\\epsilon_{iA} = \\epsilon_{iA}^{\\mathrm{LB}} = \\sqrt{\\epsilon_{ii}\\epsilon_{AA}}$。连续势阱深度的最终表达式为：\n$$\n\\epsilon_{iB} = \\frac{\\Delta\\Delta G}{C(\\sigma, r_{\\mathrm{c}}) \\rho_B} + \\frac{\\rho_A}{\\rho_B} \\sqrt{\\epsilon_{ii}\\epsilon_{AA}}\n$$\n\n得到这个连续的 $\\epsilon_{iB}$ 值后，我们执行余下的计算步骤：\n1.  计算溶质-溶剂 B 相互作用的 Lorentz-Berthelot 基线：$\\epsilon_{iB}^{\\mathrm{LB}} = \\sqrt{\\epsilon_{ii}\\epsilon_{BB}}$。\n2.  计算标度因子 $s = \\epsilon_{iB} / \\epsilon_{iB}^{\\mathrm{LB}}$。该因子量化了为匹配目标 $\\Delta\\Delta G$ 而需对简单混合定则进行的偏离。\n3.  将 $\\epsilon_{iB}$ 离散化，找到所提供的 MARTINI 风格相互作用能级集合 $S = \\{2.0, 2.5, 3.0, 3.5, 4.0, 4.5, 5.0, 5.5\\}$ $\\mathrm{kJ/mol}$ 中的最近值。这是通过找到集合 $S$ 中的值 $s_k$，使其与 $\\epsilon_{iB}$ 的绝对差 $|\\epsilon_{iB} - s_k|$ 最小化来完成的。此步骤反映了粗粒化哲学中，为保持模型简洁性而使用有限的相互作用强度选用范围的思想。\n\n最终的程序为每个提供的测试用例实现了这一系列的计算。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes a Lennard-Jones cross-interaction parameter for the MARTINI\n    coarse-grained force field to reproduce a given solvation free energy\n    difference, based on a mean-field approximation.\n    \"\"\"\n\n    # Test suite: (eps_ii, eps_AA, eps_BB, rho_A, rho_B, sigma, rc, delta_delta_G)\n    # Units: energy in kJ/mol, distance in nm, density in nm^-3.\n    test_cases = [\n        # Test 1: Happy path\n        (5.0, 5.0, 3.5, 8.5, 6.8, 0.47, 1.2, 10.0),\n        # Test 2: Zero dG, symmetric system\n        (5.0, 5.0, 5.0, 8.0, 8.0, 0.47, 1.2, 0.0),\n        # Test 3: Sensitivity to bead identity and dG target\n        (4.5, 5.5, 4.5, 8.5, 7.5, 0.47, 1.2, 5.0),\n        # Test 4: Influence of size parameter\n        (3.5, 4.5, 3.5, 7.0, 5.0, 0.43, 1.2, 8.0),\n        # Test 5: Edge case leading to unphysical (negative) epsilon\n        (3.5, 3.5, 3.5, 3.0, 6.0, 0.47, 1.2, 12.0),\n    ]\n\n    discretization_set = np.array([2.0, 2.5, 3.0, 3.5, 4.0, 4.5, 5.0, 5.5])\n    \n    all_results = []\n    \n    for case in test_cases:\n        eps_ii, eps_AA, eps_BB, rho_A, rho_B, sigma, rc, delta_delta_G = case\n\n        # 1. Calculate the geometry-dependent constant C(sigma, rc)\n        sigma_3 = sigma**3\n        sigma_6 = sigma_3**2\n        rc_3 = rc**3\n        \n        # C(sigma, r_c) from the derived formula:\n        # C = -(16*pi/3) * sigma^3 * (1/sqrt(2) - sigma^3/rc^3)\n        C_const = -(16.0 * np.pi / 3.0) * sigma_3 * (1.0 / np.sqrt(2) - sigma_3 / rc_3)\n\n        # 2. Calculate eps_iA using the Lorentz-Berthelot rule (assumption)\n        eps_iA = np.sqrt(eps_ii * eps_AA)\n        \n        # 3. Compute the continuous value for eps_iB\n        # eps_iB = (delta_delta_G / (C * rho_B)) + (rho_A / rho_B) * eps_iA\n        \n        # Handle potential division by zero if rho_B is 0\n        if rho_B == 0:\n            # This case is physically unusual and not in tests, but good practice.\n            # If rho_B is 0, eps_iB would diverge unless delta_delta_G = -C*rho_A*eps_iA,\n            # which means mu_ex(B)=0 and mu_ex(A)=delta_delta_G.\n            # We'll treat this as an invalid scenario for this problem.\n            # For the given problem, rho_B is never zero.\n            pass\n\n        term1 = delta_delta_G / (C_const * rho_B)\n        term2 = (rho_A / rho_B) * eps_iA\n        eps_iB = term1 + term2\n\n        # 4. Compute Lorentz-Berthelot baseline for solvent B and scaling factor\n        eps_iB_LB = np.sqrt(eps_ii * eps_BB)\n        \n        # Handle division by zero for the scaling factor if eps_iB_LB is zero\n        scaling_factor = eps_iB / eps_iB_LB if eps_iB_LB != 0 else np.inf\n\n        # 5. Discretize eps_iB to the nearest value in the set\n        # Find the index of the value in discretization_set closest to eps_iB\n        idx = np.abs(discretization_set - eps_iB).argmin()\n        eps_iB_disc = discretization_set[idx]\n\n        # 6. Store the results for this case\n        all_results.append([eps_iB, eps_iB_disc, scaling_factor])\n\n    # 7. Format the output string as per requirements\n    # [[val1,val2,val3],[val4,val5,val6],...] with 3 decimal places\n    formatted_results = []\n    for res in all_results:\n        # res[0]=eps_iB, res[1]=eps_iB_disc, res[2]=scaling_factor\n        formatted_str = f\"[{res[0]:.3f},{res[1]:.3f},{res[2]:.3f}]\"\n        formatted_results.append(formatted_str)\n\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3453093"}, {"introduction": "粗粒度化一个众所周知的后果是，由于势能面更平滑且摩擦减小，系统动力学被人为地加速了。这意味着模拟时间中的一纳秒并不对应真实世界的一纳秒。本练习 [@problem_id:3453040] 旨在解决这一核心概念，通过引导您推导并应用时间缩放因子，将加速的模拟时间映射回具有物理意义的时间尺度，从而确保对扩散等动力学过程的正确解读。", "problem": "考虑一个溶质在分子动力学（MD）模拟下于均相溶剂中扩散。在原子级模拟中，溶质的长时间扩散行为由随机动力学主导，该动力学可用朗之万方程的过阻尼极限来建模，其中扩散系数 $D$ 通过爱因斯坦关系与热能和有效摩擦系数 $\\zeta$ 相关联。MARTINI 粗粒化力场减少了自由度并采用软化的相互作用势，这通常导致其测得的扩散系数与原子级模拟相比有所不同。\n\n从第一性原理出发，即三维空间扩散的爱因斯坦-斯摩洛霍夫斯基关系以及扩散系数由摩擦系数和温度定义的公式，推导出一个启发式映射关系。该关系将粗粒化 MARTINI 模拟中的时间 $t_{\\mathrm{CG}}$ 与相同温度 $T$ 下同一溶质对应的物理（原子级）时间 $t_{\\mathrm{AT}}$ 联系起来。该映射必须表示为一个无量纲的时间缩放因子 $s_t$，使得 $t_{\\mathrm{AT}} = s_t \\, t_{\\mathrm{CG}}$。您的推导必须：\n\n- 从三维空间中均方位移（MSD）的定义以及连接 MSD 与扩散系数的爱因斯坦关系开始。\n- 使用广泛接受的关系式 $D = k_B T / \\zeta$，该关系式在朗之万方程的过阻尼极限下将扩散系数 $D$ 与热能 $k_B T$ 及有效摩擦系数 $\\zeta$ 联系起来。\n- 明确论证为何在相同温度下，将原子级和粗粒化表示中相同溶质的 MSD 等同起来，可以导出一个关于 $s_t$ 的公式。\n\n然后，实现一个程序，根据提供的测试套件中相同温度下相同溶质的原子级和粗粒化扩散系数值，计算每种情况下的 $s_t$。在所有情况下，扩散系数的单位均为 $\\mathrm{nm^2/ns}$，时间的单位为 $\\mathrm{ns}$，$s_t$ 是无量纲的。输出必须四舍五入到 $6$ 位小数。程序不应读取任何输入，且必须硬编码测试套件。\n\n除了计算 $s_t$，您的推导还必须讨论原子级和 MARTINI 扩散系数之间差异的来源，包括但不限于有效摩擦减小（溶剂自由度减少和流体力学耦合改变）和相互作用势软化（更低的能垒和更平滑的能量形貌）。您的解释必须阐明为什么这些效应会导致 $D$ 的差异，从而需要进行时间缩放。\n\n使用以下测试套件，其中每种情况在相同温度 $T$ 下指定了 $(D_{\\mathrm{AT}}, D_{\\mathrm{CG}})$，单位为 $\\mathrm{nm^2/ns}$：\n\n- 案例 $1$：$D_{\\mathrm{AT}} = 0.25\\, \\mathrm{nm^2/ns}$，$D_{\\mathrm{CG}} = 1.00\\, \\mathrm{nm^2/ns}$。\n- 案例 $2$：$D_{\\mathrm{AT}} = 0.05\\, \\mathrm{nm^2/ns}$，$D_{\\mathrm{CG}} = 0.15\\, \\mathrm{nm^2/ns}$。\n- 案例 $3$：$D_{\\mathrm{AT}} = 0.01\\, \\mathrm{nm^2/ns}$，$D_{\\mathrm{CG}} = 0.012\\, \\mathrm{nm^2/ns}$。\n- 案例 $4$：$D_{\\mathrm{AT}} = 0.20\\, \\mathrm{nm^2/ns}$，$D_{\\mathrm{CG}} = 0.20\\, \\mathrm{nm^2/ns}$。\n- 案例 $5$：$D_{\\mathrm{AT}} = 0.30\\, \\mathrm{nm^2/ns}$，$D_{\\mathrm{CG}} = 0.24\\, \\mathrm{nm^2/ns}$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[result_1,result_2,result_3,result_4,result_5]$），其中每个 $result_i$ 是为案例 $i$ 计算的 $s_t$，四舍五入到 $6$ 位小数，并表示为无量纲浮点数。", "solution": "所述问题具有科学依据、提法明确，并包含了完整解答所需的所有信息。因此，我将开始推导和实现。\n\n主要目标是推导一个启发式的时间缩放因子 $s_t$，它将粗粒化（CG）模拟的时间演化 $t_{\\mathrm{CG}}$ 映射到其对应的物理时间，即全原子（AT）模拟所代表的时间 $t_{\\mathrm{AT}}$。该关系式为 $t_{\\mathrm{AT}} = s_t \\, t_{\\mathrm{CG}}$。这种映射至关重要，因为在诸如 MARTINI 等粗粒化模型中，平滑的相互作用和减少的自由度通常会相对于物理现实加速系统动力学。\n\n推导始于爱因斯坦-斯摩洛霍夫斯基关系，该关系描述了粒子的扩散运动。在三维空间（$d=3$）中，粒子的均方位移（MSD）与时间间隔 $t$ 和扩散系数 $D$ 成线性比例：\n$$\n\\mathrm{MSD}(t) = \\langle |\\mathbf{r}(t) - \\mathbf{r}(0)|^2 \\rangle = 6Dt\n$$\n这里，$\\mathbf{r}(t)$ 是粒子在时间 $t$ 的位置矢量，尖括号 $\\langle \\cdot \\rangle$ 表示系综平均。\n\n该关系对原子级和粗粒化表示均成立。我们将原子级模拟中的扩散系数和时间分别表示为 $D_{\\mathrm{AT}}$ 和 $t_{\\mathrm{AT}}$。那么 MSD 为：\n$$\n\\mathrm{MSD}_{\\mathrm{AT}}(t_{\\mathrm{AT}}) = 6 D_{\\mathrm{AT}} t_{\\mathrm{AT}}\n$$\n同样，对于粗粒化模拟，其扩散系数为 $D_{\\mathrm{CG}}$，模拟时间为 $t_{\\mathrm{CG}}$，MSD 为：\n$$\n\\mathrm{MSD}_{\\mathrm{CG}}(t_{\\mathrm{CG}}) = 6 D_{\\mathrm{CG}} t_{\\mathrm{CG}}\n$$\n建立时间映射的基本假设是，无论使用何种模拟方法建模，溶质的物理位移必须相同。这意味着我们必须将溶质在原子级表示中于物理时间 $t_{\\mathrm{AT}}$ 内的 MSD 与其在粗粒化表示中于相应模拟时间 $t_{\\mathrm{CG}}$ 内的 MSD 等同起来。这确保了长时间扩散行为在这两种理论层次之間是守恒的。\n$$\n\\mathrm{MSD}_{\\mathrm{AT}}(t_{\\mathrm{AT}}) = \\mathrm{MSD}_{\\mathrm{CG}}(t_{\\mathrm{CG}})\n$$\n代入 MSD 的表达式，我们得到：\n$$\n6 D_{\\mathrm{AT}} t_{\\mathrm{AT}} = 6 D_{\\mathrm{CG}} t_{\\mathrm{CG}}\n$$\n系数 $6$ 可以消掉，从而得到时间与扩散系数之间的直接关系：\n$$\nD_{\\mathrm{AT}} t_{\\mathrm{AT}} = D_{\\mathrm{CG}} t_{\\mathrm{CG}}\n$$\n求解 $t_{\\mathrm{AT}}$ 得到从粗粒化时间到原子级时间的映射：\n$$\nt_{\\mathrm{AT}} = \\left( \\frac{D_{\\mathrm{CG}}}{D_{\\mathrm{AT}}} \\right) t_{\\mathrm{CG}}\n$$\n将此结果与给定的定义 $t_{\\mathrm{AT}} = s_t \\, t_{\\mathrm{CG}}$进行比较，我们可以确定无量纲时间缩放因子 $s_t$ 为：\n$$\ns_t = \\frac{D_{\\mathrm{CG}}}{D_{\\mathrm{AT}}}\n$$\n这个推导出的公式允许我们根据在相同温度 $T$ 下对同一溶质通过实验或计算测得的扩散系数直接计算 $s_t$。\n\n这种时间缩放的必要性源于原子级模型和粗粒化模型之間的根本差异。问题陈述了扩散系数 $D$、热能 $k_B T$ 和有效摩擦系数 $\\zeta$ 之间的关系为 $D = k_B T / \\zeta$。由于模拟之间的温度 $T$ 保持恒定，扩散系数的比值与摩擦系数的比值成反比：\n$$\ns_t = \\frac{D_{\\mathrm{CG}}}{D_{\\mathrm{AT}}} = \\frac{k_B T / \\zeta_{\\mathrm{CG}}}{k_B T / \\zeta_{\\mathrm{AT}}} = \\frac{\\zeta_{\\mathrm{AT}}}{\\zeta_{\\mathrm{CG}}}\n$$\n在 MARTINI 模拟中，$D_{\\mathrm{CG}}$ 通常大于 $D_{\\mathrm{AT}}$，这意味着 $s_t > 1$。这反过来又意味着，溶质在 CG 模型中经历的有效摩擦 $\\zeta_{\\mathrm{CG}}$低于原子级模型中的 $\\zeta_{\\mathrm{AT}}$。这种摩擦减小的主要来源是：\n\n1.  **自由度减少和平滑的能量形貌**：MARTINI 将多个原子（通常是 $4$ 个重原子）平均为一个 CG 珠。这个过程消除了键振动和角弯曲的高频运动。此外，与原子级力场中的尖锐势相比，CG 珠之间的相互作用由软化的势（例如，移动的 Lennard-Jones 势）来描述。这创造了一个更平滑的势能面。在分子水平上，摩擦源于粒子在穿過由其邻居造成的“崎岖”能量形貌时所感受到的阻力。更平滑的形貌提供了更低的运动能垒，从而导致更小的阻力，因此有效摩擦系数 $\\zeta_{\\mathrm{CG}}$ 也更低。\n\n2.  **溶剂摩擦减小和流体力学改变**：摩擦的一个重要来源是与溶剂分子的碰撞。在 MARTINI 模型中，溶剂（例如水）也被粗粒化，一个 CG 珠代表四个水分子。溶剂粒子数量的急剧减少导致单位時間內溶质-溶剂碰撞次数减少，直接降低了摩擦的碰撞分量。这种简化也改变了溶剂的集体行为，导致 CG 溶剂的粘度远低于真实的水。较低的粘度意味着流体动力学阻力减小，进一步导致 $\\zeta_{\\mathrm{CG}}  \\zeta_{\\mathrm{AT}}$。\n\n总而言之，MARTINI 中人为加速的动力学（$D_{\\mathrm{CG}} > D_{\\mathrm{AT}}$）是粗粒化过程中固有的更平滑能量面和摩擦减小的直接结果。时间缩放因子 $s_t$ 作为一个关键修正，将加速的模拟时间映射回具有物理意义的时间尺度。\n\n下面的程序将为提供的测试用例计算 $s_t = D_{\\mathrm{CG}} / D_{\\mathrm{AT}}$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the dimensionless time scaling factor s_t for coarse-grained simulations\n    based on atomistic and coarse-grained diffusion coefficients.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each tuple contains (D_AT, D_CG) in nm^2/ns.\n    test_cases = [\n        (0.25, 1.00),  # Case 1\n        (0.05, 0.15),  # Case 2\n        (0.01, 0.012), # Case 3\n        (0.20, 0.20),  # Case 4\n        (0.30, 0.24),  # Case 5\n    ]\n\n    results = []\n    for D_AT, D_CG in test_cases:\n        # The derivation shows that the time scaling factor s_t is the ratio\n        # of the coarse-grained diffusion coefficient to the atomistic one.\n        # s_t = D_CG / D_AT\n        \n        # Ensure D_AT is not zero to prevent division by zero errors,\n        # which is a physically sound check.\n        if D_AT == 0:\n            # A zero atomistic diffusion coefficient is physically unrealistic\n            # for a diffusing solute and would imply an infinite scaling factor.\n            # We can represent this as NaN or handle it as an error.\n            # For this problem, we assume D_AT  0.\n            s_t = np.nan\n        else:\n            s_t = D_CG / D_AT\n        \n        results.append(s_t)\n\n    # Format the results to 6 decimal places and create the final output string.\n    # The map(lambda r: f\"{r:.6f}\", results) ensures each number is a string\n    # with the required precision.\n    output_string = f\"[{','.join(map(lambda r: f'{r:.6f}', results))}]\"\n    \n    # Final print statement in the exact required format.\n    print(output_string)\n\nsolve()\n```", "id": "3453040"}]}