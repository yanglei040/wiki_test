{"hands_on_practices": [{"introduction": "经验价键 (EVB) 模型通过混合代表不同化学状态（如反应物和产物）的“透热”势能面来描述化学反应。这个练习将带你推导一个双态 EVB 模型的关键性质，帮助你理解透热态之间的耦合如何导致“避免交叉”现象，并决定了反应能垒的高度。掌握这个基础数学原理是理解 EVB 如何模拟化学反应性的第一步。[@problem_id:3441390]", "problem": "考虑一个在一维经验价键 (EVB) 框架内建模的反应事件，其中势能面由一个两态透热哈密顿量表示。每个透热态由一个具有相同曲率的谐振子势描述，其中心位于反应坐标上的不同位置。具体来说，设透热能量由 $E_{i}(x)=\\frac{1}{2}k\\left(x-x_{i}\\right)^{2}+E_{i}^{0}$ 给出，其中 $i\\in\\{1,2\\}$，$k>0$ 是曲率（力常数），$x$ 是反应坐标，$x_{i}$ 是透热势阱最小值的位置（$x_{1}\\neq x_{2}$），$E_{i}^{0}$ 是恒定的能量偏移。在透热基中，EVB 哈密顿量是一个 $2\\times 2$ 的对称矩阵，其对角元为 $E_{1}(x)$ 和 $E_{2}(x)$，非对角耦合为常数 $H_{12}$（假定为实数），因此 $H(x)=\\begin{pmatrix}E_{1}(x)  &H_{12} \\\\ H_{12} & E_{2}(x)\\end{pmatrix}$。从透热态与绝热态的基本定义以及绝热能通过对角化哈密顿矩阵获得的要求出发，推导：\n1. 透热面交叉点在反应坐标上的位置 $x_{c}$，其定义为 $E_{1}(x_{c})=E_{2}(x_{c})$。\n2. 由非零 $H_{12}$ 引起的绝热面之间的最小能量分裂（避免交叉间隙），并用模型参数表示。\n\n以 $k$、$x_{1}$、$x_{2}$、$E_{1}^{0}$、$E_{2}^{0}$ 和 $H_{12}$ 的形式，用符号给出你的最终表达式。将位置以纳米表示，能量以千焦/摩尔表示。无需代入数值，也无需四舍五入。你的最终答案必须是包含两个结果的单个解析表达式或行矩阵。", "solution": "此问题被评估为有效。它在科学上基于经验价键 (EVB) 模型的标准理论框架，在数学上是适定的，并且可以从所提供的信息中推导出客观解。关于用特定单位表示最终结果的指令，在给定无单位的符号参数的情况下，被解释为对结果物理解释的背景指导，而非对符号表达式的字面约束。推导出的符号表达式将在量纲上保持一致。\n\n该问题要求推导两个量：透热交叉点的位置 $x_c$ 和两个绝热势能面之间的最小能量分裂。\n\n**1. 透热交叉位置 $x_c$ 的推导**\n\n透热势能面的交叉点定义为反应坐标 $x$ 上的点 $x_c$，在该点上两个透热态的能量相等。此条件表示为 $E_1(x_c) = E_2(x_c)$。\n透热能量由以下表达式给出：\n$$E_1(x) = \\frac{1}{2}k(x-x_1)^2 + E_1^0$$\n$$E_2(x) = \\frac{1}{2}k(x-x_2)^2 + E_2^0$$\n令 $x = x_c$ 时二者相等：\n$$\\frac{1}{2}k(x_c-x_1)^2 + E_1^0 = \\frac{1}{2}k(x_c-x_2)^2 + E_2^0$$\n为求解 $x_c$，我们首先展开平方二项式：\n$$\\frac{1}{2}k(x_c^2 - 2x_c x_1 + x_1^2) + E_1^0 = \\frac{1}{2}k(x_c^2 - 2x_c x_2 + x_2^2) + E_2^0$$\n两边同乘以 $2$ 并展开含常数 $k$ 的项，得到：\n$$k x_c^2 - 2k x_c x_1 + k x_1^2 + 2E_1^0 = k x_c^2 - 2k x_c x_2 + k x_2^2 + 2E_2^0$$\n项 $k x_c^2$ 出现在等式两边，可以消去。然后我们重新整理方程以分离含 $x_c$ 的项：\n$$2k x_c x_2 - 2k x_c x_1 = k x_2^2 - k x_1^2 + 2E_2^0 - 2E_1^0$$\n在左边提出公因式 $2k x_c$，在右边提出 $k$ 和 $2$：\n$$2k x_c (x_2 - x_1) = k (x_2^2 - x_1^2) + 2(E_2^0 - E_1^0)$$\n利用平方差公式 $x_2^2 - x_1^2 = (x_2 - x_1)(x_2 + x_1)$，我们将其代入方程中：\n$$2k x_c (x_2 - x_1) = k (x_2 - x_1)(x_2 + x_1) + 2(E_2^0 - E_1^0)$$\n问题指明 $x_1 \\neq x_2$ 且 $k>0$，因此可以除以 $2k(x_2-x_1)$。这样便可分离出 $x_c$：\n$$x_c = \\frac{k(x_2 - x_1)(x_2 + x_1)}{2k(x_2 - x_1)} + \\frac{2(E_2^0 - E_1^0)}{2k(x_2 - x_1)}$$\n简化表达式得到透热交叉点的位置：\n$$x_c = \\frac{1}{2}(x_1 + x_2) + \\frac{E_2^0 - E_1^0}{k(x_2 - x_1)}$$\n\n**2. 最小绝热能量分裂的推导**\n\n绝热势能面，记为 $E_{\\pm}(x)$，是 EVB 哈密顿矩阵 $H(x)$ 的本征值。本征值 $\\lambda$ 通过求解特征方程 $\\det(H(x) - \\lambda I) = 0$ 得到，其中 $I$ 是 $2 \\times 2$ 的单位矩阵。\n$$H(x) = \\begin{pmatrix} E_1(x) & H_{12} \\\\ H_{12} & E_2(x) \\end{pmatrix}$$\n特征方程为：\n$$\\det \\begin{pmatrix} E_1(x) - \\lambda & H_{12} \\\\ H_{12} & E_2(x) - \\lambda \\end{pmatrix} = 0$$\n$$(E_1(x) - \\lambda)(E_2(x) - \\lambda) - H_{12}^2 = 0$$\n这是一个关于 $\\lambda$ 的二次方程：\n$$\\lambda^2 - (E_1(x) + E_2(x))\\lambda + E_1(x)E_2(x) - H_{12}^2 = 0$$\n$\\lambda$ 的解代表绝热能 $E_{\\pm}(x)$，使用二次方程求根公式求得：\n$$E_{\\pm}(x) = \\frac{(E_1(x) + E_2(x)) \\pm \\sqrt{(E_1(x) + E_2(x))^2 - 4(E_1(x)E_2(x) - H_{12}^2)}}{2}$$\n我们来简化判别式：\n$$(E_1(x) + E_2(x))^2 - 4E_1(x)E_2(x) + 4H_{12}^2 = E_1(x)^2 + 2E_1(x)E_2(x) + E_2(x)^2 - 4E_1(x)E_2(x) + 4H_{12}^2$$\n$$= E_1(x)^2 - 2E_1(x)E_2(x) + E_2(x)^2 + 4H_{12}^2 = (E_1(x) - E_2(x))^2 + 4H_{12}^2$$\n将此结果代回本征值的表达式，得到绝热能：\n$$E_{\\pm}(x) = \\frac{1}{2}(E_1(x) + E_2(x)) \\pm \\frac{1}{2}\\sqrt{(E_1(x) - E_2(x))^2 + 4H_{12}^2}$$\n在任意位置 $x$ 处，两个绝热面之间的能量分裂或间隙为 $\\Delta E(x) = E_+(x) - E_-(x)$：\n$$\\Delta E(x) = \\sqrt{(E_1(x) - E_2(x))^2 + 4H_{12}^2}$$\n为了找到最小能量分裂，我们必须求出 $\\Delta E(x)$ 的最小值。项 $4H_{12}^2$ 是一个正常数（因为 $H_{12}$ 是实数）。项 $(E_1(x) - E_2(x))^2$ 是一个关于 $x$ 的非负函数。$\\Delta E(x)$ 的最小值将在 $(E_1(x) - E_2(x))^2$ 取最小值的 $x$ 位置处出现。一个实数平方的最小可能值为 $0$，这在 $E_1(x) = E_2(x)$ 时发生。\n这个条件，$E_1(x) = E_2(x)$，正是透热交叉点 $x_c$ 的定义。因此，最小能量分裂发生在 $x=x_c$ 处。\n此时，最小分裂 $\\Delta E_{min}$ 为：\n$$\\Delta E_{min} = \\Delta E(x_c) = \\sqrt{(E_1(x_c) - E_2(x_c))^2 + 4H_{12}^2} = \\sqrt{0^2 + 4H_{12}^2} = \\sqrt{4H_{12}^2}$$\n由于能量分裂必须是一个非负量，我们取正根：\n$$\\Delta E_{min} = 2|H_{12}|$$\n这表明非对角耦合 $H_{12}$ 直接决定了避免交叉间隙的大小。如果 $H_{12}=0$，则间隙为零，绝热面在 $x_c$ 处交叉。如果 $H_{12} \\neq 0$，简并将被解除，势能面表现出避免交叉，其最小间距为 $2|H_{12}|$。\n\n因此，所要求的两个量是交叉位置 $x_c$ 和最小能量分裂 $\\Delta E_{min}$。", "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{1}{2}(x_1 + x_2) + \\frac{E_2^0 - E_1^0}{k(x_2 - x_1)} & 2|H_{12}| \\end{pmatrix} } $$", "id": "3441390"}, {"introduction": "与 EVB 不同，像 ReaxFF 这样的反应力场使用“键级”的概念来平滑地开启和关闭原子间的相互作用。这确保了在化学键形成和断裂过程中能量和力的平滑过渡。本练习通过推导一个由键级调节的角能量项所产生的力，来具体展示这一关键特性，你将证明当其中一个化学键断裂时，相关的角作用力如何自然地消失。[@problem_id:3441417]", "problem": "考虑一个三原子体系，其中原子 $A$、$B$ 和 $C$ 在 $\\mathbb{R}^{3}$ 中的位置分别为 $\\mathbf{r}_{A}$、$\\mathbf{r}_{B}$ 和 $\\mathbf{r}_{C}$。定义键矢量 $\\mathbf{a} \\equiv \\mathbf{r}_{A} - \\mathbf{r}_{B}$ 和 $\\mathbf{c} \\equiv \\mathbf{r}_{C} - \\mathbf{r}_{B}$，键长为 $r_{AB} \\equiv \\|\\mathbf{a}\\|$ 和 $r_{BC} \\equiv \\|\\mathbf{c}\\|$。设 $B$ 处的角为 $\\theta \\in (0,\\pi)$，由 $\\cos \\theta \\equiv \\dfrac{\\mathbf{a} \\cdot \\mathbf{c}}{r_{AB}\\, r_{BC}}$ 定义。在反应力场（ReaxFF）式的角相互作用中，角能量由平滑依赖于键长的键级进行调制。考虑以下角能量\n$$\nE_{\\theta}(\\mathbf{r}_{A},\\mathbf{r}_{B},\\mathbf{r}_{C}) \\equiv \\frac{1}{2}\\,k_{\\theta}\\,b_{AB}(r_{AB})\\,b_{BC}(r_{BC})\\,\\big(\\theta - \\theta_{0}\\big)^{2},\n$$\n其中 $k_{\\theta} > 0$ 是角刚度，$\\theta_{0} \\in (0,\\pi)$ 是参考角，键级由以下平滑的衰减函数给出\n$$\nb_{AB}(r_{AB}) \\equiv \\exp\\!\\big(-\\alpha\\,(r_{AB} - r_{0})\\big),\\qquad\nb_{BC}(r_{BC}) \\equiv \\exp\\!\\big(-\\alpha\\,(r_{BC} - r_{0})\\big),\n$$\n参数为 $\\alpha > 0$ 和 $r_{0} > 0$。此形式是反应力场（ReaxFF）和经验价键（EVB）启发模型中使用的平滑消失的键级权重的一种简化替代形式。\n\n仅从上述定义、牛顿第二定律和多变量微积分（链式法则和梯度）出发，完成以下任务：\n\n1. 推导角项对原子 $B$ 的力 $\\mathbf{F}_{B}^{(\\theta)} \\equiv -\\nabla_{\\mathbf{r}_{B}} E_{\\theta}$，用 $k_{\\theta}$、$b_{AB}$、$b_{BC}$、它们相对于 $\\mathbf{r}_{B}$ 的梯度以及 $\\nabla_{\\mathbf{r}_{B}}\\theta$ 来表示你的结果。\n2. 当 $A$–$B$ 键级趋近于零时（即当 $r_{AB} \\to \\infty$ 使得 $b_{AB}(r_{AB}) \\to 0$ 时），计算 $\\mathbf{F}_{B}^{(\\theta)}$ 的极限。明确展示在此极限下，对 $B$ 的角力贡献平滑地消失，并给出 $\\mathbf{F}_{B}^{(\\theta)}$ 的极限表达式。\n\n以牛顿为单位表示最终的力。不需要数值。最终答案必须是角项对原子 $B$ 的极限力的单一符号表达式。", "solution": "该问题陈述在科学上是合理的、表述清晰且客观的。它描述了反应性分子动力学力场框架内一个简化的、但在概念上是标准的角势。所有定义在数学上都是精确的，任务是定义明确的微积分问题。因此，该问题被认为是有效的。\n\n根据要求，解法分为两部分。\n\n### 第1部分：B原子上力的推导\n\n角势 $E_{\\theta}$ 对原子 $B$ 产生的力由牛顿第二定律以保守力的形式给出，即 $\\mathbf{F}_{B}^{(\\theta)} \\equiv -\\nabla_{\\mathbf{r}_{B}} E_{\\theta}$。势能由下式给出：\n$$\nE_{\\theta} = \\frac{1}{2}\\,k_{\\theta}\\,b_{AB}(r_{AB})\\,b_{BC}(r_{BC})\\,\\big(\\theta - \\theta_{0}\\big)^{2}\n$$\n为了计算相对于位置矢量 $\\mathbf{r}_{B}$ 的梯度，我们对依赖于 $\\mathbf{r}_{B}$ 的三个因子应用微分的乘法法则：$b_{AB}(r_{AB})$、$b_{BC}(r_{BC})$ 和 $(\\theta - \\theta_{0})^{2}$。注意，$r_{AB} = \\|\\mathbf{r}_A - \\mathbf{r}_B\\|$、$r_{BC} = \\|\\mathbf{r}_C - \\mathbf{r}_B\\|$ 和 $\\theta$ 都依赖于 $\\mathbf{r}_{B}$。\n\n$$\n\\nabla_{\\mathbf{r}_{B}} E_{\\theta} = \\frac{1}{2}\\,k_{\\theta} \\left[ \\left(\\nabla_{\\mathbf{r}_{B}} b_{AB}\\right) b_{BC} (\\theta - \\theta_{0})^{2} + b_{AB} \\left(\\nabla_{\\mathbf{r}_{B}} b_{BC}\\right) (\\theta - \\theta_{0})^{2} + b_{AB} b_{BC} \\nabla_{\\mathbf{r}_{B}} \\left( (\\theta - \\theta_{0})^{2} \\right) \\right]\n$$\n\n对最后一项使用链式法则，并注意参考角 $\\theta_{0}$ 是一个常数，我们有：\n$$\n\\nabla_{\\mathbf{r}_{B}} \\left( (\\theta - \\theta_{0})^{2} \\right) = 2 (\\theta - \\theta_{0}) \\nabla_{\\mathbf{r}_{B}} (\\theta - \\theta_{0}) = 2 (\\theta - \\theta_{0}) \\nabla_{\\mathbf{r}_{B}}\\theta\n$$\n\n将此代入能量梯度的表达式中，得到：\n$$\n\\nabla_{\\mathbf{r}_{B}} E_{\\theta} = \\frac{1}{2}\\,k_{\\theta}(\\theta - \\theta_{0})^{2} \\left[ (\\nabla_{\\mathbf{r}_{B}}b_{AB}) b_{BC} + b_{AB} (\\nabla_{\\mathbf{r}_{B}}b_{BC}) \\right] + k_{\\theta}\\,b_{AB}\\,b_{BC}\\,(\\theta - \\theta_{0})\\,\\nabla_{\\mathbf{r}_{B}}\\theta\n$$\n\n原子 $B$ 上的力是该梯度的负值：\n$$\n\\mathbf{F}_{B}^{(\\theta)} = -\\frac{1}{2}\\,k_{\\theta}\\,(\\theta - \\theta_{0})^{2} \\left[ b_{BC} \\nabla_{\\mathbf{r}_{B}}b_{AB} + b_{AB} \\nabla_{\\mathbf{r}_{B}}b_{BC} \\right] - k_{\\theta}\\,b_{AB}\\,b_{BC}\\,(\\theta - \\theta_{0})\\,\\nabla_{\\mathbf{r}_{B}}\\theta\n$$\n\n该表达式按照问题第一部分的要求，用 $k_{\\theta}$、$b_{AB}$、$b_{BC}$、它们相对于 $\\mathbf{r}_{B}$ 的梯度以及角梯度 $\\nabla_{\\mathbf{r}_{B}}\\theta$ 表示了原子 $B$ 上的力。\n\n### 第2部分：力的极限行为\n\n为了计算当键级 $b_{AB}(r_{AB})$ 趋近于零时（即 $r_{AB} \\to \\infty$ 时）$\\mathbf{F}_{B}^{(\\theta)}$ 的极限，我们必须分析力表达式中每一项的行为。为此，我们首先需要梯度的显式表达式。\n\n键级函数为 $b_{AB}(r_{AB}) = \\exp(-\\alpha(r_{AB} - r_{0}))$ 和 $b_{BC}(r_{BC}) = \\exp(-\\alpha(r_{BC} - r_{0}))$。它们相对于 $\\mathbf{r}_{B}$ 的梯度通过链式法则求得：\n$\\nabla_{\\mathbf{r}_{B}} b_{AB} = \\frac{db_{AB}}{dr_{AB}} \\nabla_{\\mathbfr_{B}} r_{AB}$。\n相对于键长的导数为 $\\frac{db_{AB}}{dr_{AB}} = -\\alpha \\exp(-\\alpha(r_{AB} - r_{0})) = -\\alpha b_{AB}$。\n键长 $r_{AB} = \\|\\mathbf{r}_{A} - \\mathbf{r}_{B}\\|$ 的梯度为 $\\nabla_{\\mathbf{r}_{B}} r_{AB} = \\frac{\\mathbf{r}_{B} - \\mathbf{r}_{A}}{r_{AB}} = -\\frac{\\mathbf{a}}{r_{AB}} = -\\hat{\\mathbf{a}}$，其中 $\\hat{\\mathbf{a}}$ 是从 $B$ 指向 $A$ 的沿键单位矢量。\n所以，$\\nabla_{\\mathbf{r}_{B}}b_{AB} = (-\\alpha b_{AB})(-\\hat{\\mathbf{a}}) = \\alpha b_{AB} \\hat{\\mathbf{a}}$。\n通过完全相同的论证，$\\nabla_{\\mathbf{r}_{B}}b_{BC} = \\alpha b_{BC} \\hat{\\mathbf{c}}$，其中 $\\hat{\\mathbf{c}}$ 是从 $B$ 指向 $C$ 的单位矢量。\n\n角 $\\theta$ 相对于 $\\mathbf{r}_{B}$ 的梯度是分子力学中的一个标准结果：\n$$\n\\nabla_{\\mathbf{r}_{B}}\\theta = \\frac{1}{\\sin\\theta} \\left[ \\frac{\\hat{\\mathbf{c}} - (\\hat{\\mathbf{a}} \\cdot \\hat{\\mathbf{c}})\\hat{\\mathbf{a}}}{r_{AB}} + \\frac{\\hat{\\mathbf{a}} - (\\hat{\\mathbf{a}} \\cdot \\hat{\\mathbf{c}})\\hat{\\mathbf{c}}}{r_{BC}} \\right] = \\frac{1}{\\sin\\theta} \\left[ \\frac{\\hat{\\mathbf{c}} - \\cos(\\theta)\\hat{\\mathbf{a}}}{r_{AB}} + \\frac{\\hat{\\mathbf{a}} - \\cos(\\theta)\\hat{\\mathbf{c}}}{r_{BC}} \\right]\n$$\n\n现在我们分析当 $r_{AB} \\to \\infty$ 时 $\\mathbf{F}_{B}^{(\\theta)}$ 的极限：\n$$\n\\mathbf{F}_{B}^{(\\theta)} = \\underbrace{-\\frac{1}{2}\\,k_{\\theta}\\,(\\theta - \\theta_{0})^{2} b_{BC} (\\nabla_{\\mathbf{r}_{B}}b_{AB})}_{\\text{第1项}} \\underbrace{-\\frac{1}{2}\\,k_{\\theta}\\,(\\theta - \\theta_{0})^{2} b_{AB} (\\nabla_{\\mathbf{r}_{B}}b_{BC})}_{\\text{第2项}} \\underbrace{-k_{\\theta}\\,b_{AB}\\,b_{BC}\\,(\\theta - \\theta_{0})\\,(\\nabla_{\\mathbf{r}_{B}}\\theta)}_{\\text{第3项}}\n$$\n\n1.  **核心组成部分的行为**：\n    -   当 $r_{AB} \\to \\infty$ 时，由于 $\\alpha > 0$，键级 $b_{AB} = \\exp(-\\alpha(r_{AB} - r_{0}))$ 衰减到 $0$。\n    -   梯度 $\\nabla_{\\mathbf{r}_{B}}b_{AB} = \\alpha b_{AB} \\hat{\\mathbf{a}}$ 也趋近于 $\\mathbf{0}$，因为它与 $b_{AB}$ 成正比，而 $\\hat{\\mathbf{a}}$ 是一个单位矢量。\n    -   与 $B$-$C$ 键相关的量 $r_{BC}$ 和 $b_{BC}$ 与 $\\mathbf{r}_{A}$ 无关，保持不变。梯度 $\\nabla_{\\mathbf{r}_{B}}b_{BC}$ 相对于 $r_{AB}$ 也是常数。\n    -   角 $\\theta$ 趋近于一个极限值 $\\theta_{\\infty}$，由 $\\cos\\theta_{\\infty} = \\lim_{r_{AB}\\to\\infty} \\frac{\\hat{\\mathbf{a}}\\cdot\\mathbf{c}}{r_{BC}}$ 定义。这个极限是明确定义的，因此 $\\theta_{\\infty}$ 是一个有限角。\n    -   角梯度 $\\nabla_{\\mathbf{r}_{B}}\\theta$ 趋近于一个有限的矢量极限。当 $r_{AB} \\to \\infty$ 时，项 $\\frac{\\hat{\\mathbf{c}} - \\cos(\\theta)\\hat{\\mathbf{a}}}{r_{AB}}$ 消失。剩余部分趋近于一个常数矢量，前置因子 $1/\\sin\\theta$ 不是奇异的（在共线极限的情况下，其分子也会消失，使得分数是良态的）。因此，$\\nabla_{\\mathbf{r}_{B}}\\theta$ 是有界的。\n\n2.  **各项的极限**：\n    -   **第1项**：该项包含因子 $\\nabla_{\\mathbf{r}_{B}}b_{AB}$。由于 $\\lim_{r_{AB}\\to\\infty} \\nabla_{\\mathbf{r}_{B}}b_{AB} = \\mathbf{0}$ 且第1项中的所有其他因子都趋于有限极限，我们有 $\\lim_{r_{AB}\\to\\infty} \\text{第1项} = \\mathbf{0}$。\n    -   **第2项**：该项包含因子 $b_{AB}$。由于 $\\lim_{r_{AB}\\to\\infty} b_{AB} = 0$ 且所有其他因子都有界，我们有 $\\lim_{r_{AB}\\to\\infty} \\text{第2项} = \\mathbf{0}$。\n    -   **第3项**：该项也包含因子 $b_{AB}$。由于 $\\lim_{r_{AB}\\to\\infty} b_{AB} = 0$ 且所有其他因子都有界，我们有 $\\lim_{r_{AB}\\to\\infty} \\text{第3项} = \\mathbf{0}$。\n\n3.  **结论**：\n    和的极限等于极限的和。因此，原子 $B$ 上的总力消失：\n    $$\n    \\lim_{r_{AB} \\to \\infty} \\mathbf{F}_{B}^{(\\theta)} = \\mathbf{0} + \\mathbf{0} + \\mathbf{0} = \\mathbf{0}\n    $$\n    该结果展示了反应力场的一个关键特性。角相互作用由键级调制，因此当其中一个构成键断裂时（即其长度趋于无穷大），相应的键级消失。这导致整个能量项及其派生出的所有力都平滑地消失。键级函数 $b_{AB}(r_{AB})$ 的指数衰减确保了力及其相对于 $r_{AB}$ 的所有导数也趋于零，从而证实了这种截断机制的平滑性。\n\n力 $\\mathbf{F}_{B}^{(\\theta)}$ 的极限表达式是零矢量。", "answer": "$$\n\\boxed{\\pmatrix{0 & 0 & 0}}\n$$", "id": "3441417"}, {"introduction": "许多反应力场在模拟的每一步都使用电荷平衡 (QEq) 方法来动态计算原子电荷。由于 QEq 是一个迭代求解过程，不完全的收敛会产生微小的数值误差，从而引入非物理的“伪力”。这个高级练习将引导你分析这个微观的数值误差如何累积并导致宏观上可观测的能量漂移，通过推导收敛容差，你将学会评估和控制复杂模拟中的数值精度问题。[@problem_id:3441416]", "problem": "考虑一个反应力场分子动力学模拟，该模拟在每个时间步使用电荷均衡 (Charge Equilibration, QEq) 方法来确定原子部分电荷。设 QEq 能量可以写成关于电荷的凸二次型，\n$$\nE_{\\mathrm{QEq}}(q;R)=\\frac{1}{2}\\,q^{\\mathsf{T}} H(R)\\,q - b(R)^{\\mathsf{T}} q + \\mathrm{const},\n$$\n其中 $q \\in \\mathbb{R}^{N}$ 是电荷向量，$R \\in \\mathbb{R}^{3N}$ 是原子位置，$H(R)$ 是对称正定硬度矩阵，$b(R)$ 取决于电负性和屏蔽库仑项。终止时的 QEq 残差定义为 $E_{\\mathrm{QEq}}$ 关于 $q$ 的梯度，\n$$\nr(R,q)=\\nabla_{q} E_{\\mathrm{QEq}}(q;R)=H(R)\\,q - b(R).\n$$\n假设在整个轨迹上一致地满足以下条件：\n1. 逆硬度矩阵的谱范数有界，即 $\\|H(R)^{-1}\\|_{2} \\leq 0.1~\\mathrm{eV}^{-1}$。\n2. 算子 $J(R)=\\frac{\\partial^{2} E_{\\mathrm{QEq}}(q;R)}{\\partial R\\,\\partial q}$ 的谱范数有界，即 $\\|J(R)\\|_{2} \\leq 4.0~\\mathrm{eV}/\\mathrm{\\AA}$。\n\n该系统由 $N=100$ 个原子组成：60个质量为 $12~\\mathrm{amu}$ 的碳原子和40个质量为 $1~\\mathrm{amu}$ 的氢原子。模拟在温度 $T=300~\\mathrm{K}$ 的正则系综中进行，持续时间为 $1~\\mathrm{ns}$。使用速度均分定理以及换算关系 $1~\\mathrm{amu} = 1.0364 \\times 10^{-4}~\\mathrm{eV}\\cdot\\mathrm{ps}^{2}/\\mathrm{\\AA}^{2}$ 和 $k_{B}=8.617333262145\\times 10^{-5}~\\mathrm{eV/K}$。\n\n从第一性原理出发，分析非零 QEq 残差 $r$ 如何扰动瞬时力，并通过机械功率输入，累积为物理能量的长期漂移。推导一个关于 $\\|r\\|_{2}$ 的严格界限，用于描述在 $1~\\mathrm{ns}$ 轨迹上的总能量漂移，然后确定 QEq 残差的欧几里得范数的数值容差，以确保在整个轨迹上总漂移不超过 $10~\\mathrm{kJ/mol}$。\n\n将 $\\|r\\|_{2}$ 的最终容差以电子伏特 (eV) 表示，并将您的答案四舍五入到三位有效数字。", "solution": "该问题要求推导电荷均衡 (QEq) 残差的欧几里得范数 $\\|r\\|_{2}$ 的一个容差，使得在分子动力学轨迹上的累积能量漂移保持在指定的阈值以下。推导过程从第一性原理出发，通过量化由不精确的电荷解引起的原子力的误差，计算该力误差所做的功，并利用统计力学和给定的参数界限对该功进行限定。\n\n设系统的总势能为 $U(R, q)$，其与电荷相关的部分由 QEq 能量表达式 $E_{\\mathrm{QEq}}(q; R)$ 给出。作用在原子上的力是总能量相对于原子位置 $R$ 的负梯度。在精确模拟中，电荷 $q_0(R)$ 将在每个构型 $R$ 下通过完美最小化 $E_{\\mathrm{QEq}}$ 来确定，满足条件 $\\nabla_{q} E_{\\mathrm{QEq}}(q_0;R) = 0$。真实的物理力是全导数 $F_0 = -\\frac{d}{dR}U(R,q_0(R))$。使用链式法则，可得 $F_0 = -\\frac{\\partial U}{\\partial R}\\big|_{q_0} - \\left(\\frac{\\partial q_0}{\\partial R}\\right)^{\\mathsf{T}}\\frac{\\partial U}{\\partial q}\\big|_{q_0}$。由于 $\\frac{\\partial U}{\\partial q} = \\nabla_q E_{\\mathrm{QEq}}$ 且在最小值点 $q_0$ 处为零，第二项（Pulay 力）消失。因此，真实的力是 $F_0 = -\\frac{\\partial U}{\\partial R}\\big|_{q_0}$。\n\n在实际模拟中，QEq 方程是迭代求解的，得到一个近似的电荷向量 $q$ 和一个非零残差 $r = \\nabla_{q} E_{\\mathrm{QEq}}(q;R)$。大多数模拟代码计算力时采用 $F = -\\frac{\\partial U}{\\partial R}\\big|_{q}$，忽略了对于未收敛电荷而言非零的 Pulay 修正项。因此，瞬时力的误差为：\n$$\n\\delta F = F - F_0 = -\\left(\\frac{\\partial U(R,q)}{\\partial R} - \\frac{\\partial U(R,q_0)}{\\partial R}\\right)\n$$\n我们可以通过力表达式在 $q_0$ 附近的一阶泰勒展开，将力误差 $\\delta F$ 与电荷误差 $\\delta q = q - q_0$ 联系起来：\n$$\n\\delta F \\approx - \\frac{\\partial^2 U(R,q_0)}{\\partial R \\partial q} \\delta q\n$$\n问题给出了混合偏导数算子 $J(R) = \\frac{\\partial^2 E_{\\mathrm{QEq}}}{\\partial R \\partial q}$。我们假设 $U$ 对电荷的依赖性完全包含在 $E_{\\mathrm{QEq}}$ 中，因此 $\\frac{\\partial^2 U}{\\partial R \\partial q} = J(R)$。因此，$\\delta F \\approx -J(R)\\,\\delta q$。\n\n接下来，我们将电荷误差 $\\delta q$ 与残差 $r$ 联系起来。残差定义为 $r = \\nabla_q E_{\\mathrm{QEq}}(q;R) = H(R)q - b(R)$。精确解 $q_0$ 满足 $0 = H(R)q_0 - b(R)$。将这两个方程相减得到 $H(R)(q-q_0) = r$，这意味着电荷误差为 $\\delta q = H(R)^{-1}r$。\n将此代入力误差表达式可得：\n$$\n\\delta F(R) \\approx -J(R) H(R)^{-1} r\n$$\n这个虚构的力误差对系统做功，导致总能量发生漂移。由该误差引起的瞬时功率输入为 $P_{\\mathrm{err}} = (\\delta F)^{\\mathsf{T}} v$，其中 $v = \\dot{R}$ 是原子速度向量。在模拟时间 $\\tau$ 内的总能量漂移是该功率的时间积分：\n$$\n\\Delta E_{\\mathrm{drift}} = \\int_0^{\\tau} P_{\\mathrm{err}}(t) \\, dt = -\\int_0^{\\tau} \\left(J(R(t)) H(R(t))^{-1} r(t)\\right)^{\\mathsf{T}} v(t) \\, dt\n$$\n为了找到一个严格的界限，我们使用向量和矩阵范数的性质。漂移的绝对值有界如下：\n$$\n|\\Delta E_{\\mathrm{drift}}| \\leq \\int_0^{\\tau} \\left| \\left(J H^{-1} r\\right)^{\\mathsf{T}} v \\right| dt\n$$\n根据柯西-施瓦茨不等式， $|x^{\\mathsf{T}}y| \\le \\|x\\|_2 \\|y\\|_2$：\n$$\n|\\Delta E_{\\mathrm{drift}}| \\leq \\int_0^{\\tau} \\|J H^{-1} r\\|_2 \\|v(t)\\|_2 \\, dt\n$$\n使用矩阵的诱导 $L_2$-范数性质 $\\|Ax\\|_2 \\le \\|A\\|_2 \\|x\\|_2$，我们有 $\\|J H^{-1} r\\|_2 \\leq \\|J\\|_2 \\|H^{-1}\\|_2 \\|r\\|_2$。问题给出了统一的界限 $\\|H(R)^{-1}\\|_{2} \\leq C_H = 0.1~\\mathrm{eV}^{-1}$ 和 $\\|J(R)\\|_{2} \\leq C_J = 4.0~\\mathrm{eV}/\\mathrm{\\AA}$。我们寻求一个容差 $r_{\\mathrm{tol}}$，使得在所有时间点都满足 $\\|r\\|_2 \\leq r_{\\mathrm{tol}}$。界限变为：\n$$\n|\\Delta E_{\\mathrm{drift}}| \\leq C_J C_H r_{\\mathrm{tol}} \\int_0^{\\tau} \\|v(t)\\|_2 \\, dt\n$$\n积分项代表所有原子走过的总路径长度。我们可以用统计力学来估计它。根据正则系综系统的遍历性假设，时间平均等于系综平均：$\\int_0^{\\tau} \\|v(t)\\|_2 dt = \\tau \\langle \\|v\\|_2 \\rangle$。根据琴生不等式，$\\langle \\|v\\|_2 \\rangle \\le \\sqrt{\\langle \\|v\\|_2^2 \\rangle}$。项 $\\langle \\|v\\|_2^2 \\rangle$ 是速度向量的均方范数。\n$$\n\\langle \\|v\\|_2^2 \\rangle = \\left\\langle \\sum_{j=1}^{N} |v_j|^2 \\right\\rangle = \\left\\langle \\sum_{j=1}^{N} (v_{j,x}^2 + v_{j,y}^2 + v_{j,z}^2) \\right\\rangle = \\sum_{j=1}^{N} \\sum_{\\alpha \\in \\{x,y,z\\}} \\langle v_{j,\\alpha}^2 \\rangle\n$$\n根据能量均分定理，每个自由度的平均动能是 $\\frac{1}{2} k_B T$，所以 $\\langle \\frac{1}{2}m_j v_{j,\\alpha}^2 \\rangle = \\frac{1}{2}k_B T$，这意味着 $\\langle v_{j,\\alpha}^2 \\rangle = \\frac{k_B T}{m_j}$。\n因此，$\\langle \\|v\\|_2^2 \\rangle = \\sum_{j=1}^{N} 3 \\frac{k_B T}{m_j} = 3 k_B T \\sum_{j=1}^{N} \\frac{1}{m_j}$。\n求和遍及所有 $N=100$ 个原子，其中包括 $N_C=60$ 个碳原子和 $N_H=40$ 个氢原子。\n$$\n\\sum_{j=1}^{N} \\frac{1}{m_j} = \\frac{N_C}{m_C} + \\frac{N_H}{m_H}\n$$\n结合这些结果，能量漂移的界限是：\n$$\n|\\Delta E_{\\mathrm{drift}}| \\leq C_J C_H r_{\\mathrm{tol}} \\tau \\sqrt{3 k_B T \\left(\\frac{N_C}{m_C} + \\frac{N_H}{m_H}\\right)}\n$$\n我们现在代入给定的数值，确保单位一致 (eV, Å, ps)。\n$C_J = 4.0~\\mathrm{eV}/\\mathrm{\\AA}$\n$C_H = 0.1~\\mathrm{eV}^{-1}$\n$\\tau = 1~\\mathrm{ns} = 1000~\\mathrm{ps}$\n$T = 300~\\mathrm{K}$\n$k_B = 8.617333 \\times 10^{-5}~\\mathrm{eV/K} \\implies k_B T = 0.025852~\\mathrm{eV}$\n质量： $m_C = 12~\\mathrm{amu}$，$m_H = 1~\\mathrm{amu}$。\n质量换算： $1~\\mathrm{amu} = 1.0364 \\times 10^{-4}~\\mathrm{eV}\\cdot\\mathrm{ps}^2/\\mathrm{\\AA}^2$。\n$m_C = 12 \\times 1.0364 \\times 10^{-4} = 1.24368 \\times 10^{-3}~\\mathrm{eV}\\cdot\\mathrm{ps}^2/\\mathrm{\\AA}^2$\n$m_H = 1 \\times 1.0364 \\times 10^{-4} = 1.0364 \\times 10^{-4}~\\mathrm{eV}\\cdot\\mathrm{ps}^2/\\mathrm{\\AA}^2$\n\n现在我们计算逆质量之和：\n$$\n\\frac{N_C}{m_C} + \\frac{N_H}{m_H} = \\frac{60}{1.24368 \\times 10^{-3}} + \\frac{40}{1.0364 \\times 10^{-4}} \\approx 48243.5 + 385951.4 = 434194.9~\\frac{\\mathrm{\\AA}^2}{\\mathrm{eV}\\cdot\\mathrm{ps}^2}\n$$\n接下来，我们计算估计的速度项：\n$$\n\\tau \\sqrt{3 k_B T \\left(\\frac{N_C}{m_C} + \\frac{N_H}{m_H}\\right)} = 1000~\\mathrm{ps} \\times \\sqrt{3 \\times 0.025852~\\mathrm{eV} \\times 434194.9~\\frac{\\mathrm{\\AA}^2}{\\mathrm{eV}\\cdot\\mathrm{ps}^2}}\n$$\n$$\n= 1000~\\mathrm{ps} \\times \\sqrt{33674.8}~\\mathrm{\\AA}/\\mathrm{ps} \\approx 1000 \\times 183.507~\\mathrm{\\AA} = 1.83507 \\times 10^5~\\mathrm{\\AA}\n$$\n$r_{\\mathrm{tol}}$ 的总无量纲乘数为：\n$$\nK = C_J C_H \\times 1.83507 \\times 10^5~\\mathrm{\\AA} = (4.0~\\mathrm{eV}/\\mathrm{\\AA}) \\times (0.1~\\mathrm{eV}^{-1}) \\times (1.83507 \\times 10^5~\\mathrm{\\AA}) \\approx 73403\n$$\n能量漂移的界限是 $|\\Delta E_{\\mathrm{drift}}| \\leq K \\cdot r_{\\mathrm{tol}} \\approx 73403 \\cdot r_{\\mathrm{tol}}$。注意 $r_{\\mathrm{tol}}$ 的单位是能量 (eV)。\n\n最后，我们应用漂移不得超过 $\\Delta E_{\\mathrm{max}} = 10~\\mathrm{kJ/mol}$ 的约束条件。我们将其转换为每个系统的 eV。转换因子为 $1~\\mathrm{eV} \\approx 96.485~\\mathrm{kJ/mol}$。\n$$\n\\Delta E_{\\mathrm{max}} = 10~\\mathrm{kJ/mol} \\times \\frac{1~\\mathrm{eV}}{96.485~\\mathrm{kJ/mol}} \\approx 0.10364~\\mathrm{eV}\n$$\n我们求解容差 $r_{\\mathrm{tol}}$：\n$$\n73403 \\cdot r_{\\mathrm{tol}} \\leq 0.10364~\\mathrm{eV}\n$$\n$$\nr_{\\mathrm{tol}} \\leq \\frac{0.10364}{73403}~\\mathrm{eV} \\approx 1.4119 \\times 10^{-6}~\\mathrm{eV}\n$$\n四舍五入到三位有效数字，QEq 残差的欧几里得范数所需的容差为 $1.41 \\times 10^{-6}~\\mathrm{eV}$。", "answer": "$$\\boxed{1.41 \\times 10^{-6}}$$", "id": "3441416"}]}