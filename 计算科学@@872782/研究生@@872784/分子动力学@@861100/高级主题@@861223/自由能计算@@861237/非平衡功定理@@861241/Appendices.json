{"hands_on_practices": [{"introduction": "要真正掌握非平衡功定理，最好的方法莫过于从基本原理出发，亲手进行推导。这项练习将引导我们从一个具体物理系统的微观动力学出发——一个在谐振子势阱中被匀速拖拽的布朗粒子。通过直接求解其郎之万方程并计算功的分布方差，我们能直观地理解非平衡驱动和热涨落是如何共同作用产生功的涨落的[@problem_id:317561]。", "problem": "考虑一个一维的过阻尼布朗粒子，被限制在谐波势 $V(x, \\lambda) = \\frac{1}{2} k (x - \\lambda)^2$ 中。该粒子与恒定温度 $T$ 的热库接触。系统在时间 $t=0$ 时处于热平衡状态，此时势的中心位于 $\\lambda(0) = 0$。\n\n从 $t=0$ 开始，谐波陷阱的中心以恒定速度 $u$ 被拖动，持续时间为 $\\tau$。因此，在时间 $t$ 时陷阱中心的位置由 $\\lambda(t) = ut$ 给出，其中 $0 \\le t \\le \\tau$。粒子位置 $x(t)$ 的动力学由过阻尼朗之万方程描述：\n$$\n\\gamma \\frac{dx}{dt} = -\\frac{\\partial V(x, \\lambda(t))}{\\partial x} + \\xi(t)\n$$\n其中 $\\gamma$ 是摩擦系数， $k$ 是陷阱刚度，$\\xi(t)$ 是高斯白噪声项，其均值为零 $\\langle \\xi(t) \\rangle = 0$，关联为 $\\langle \\xi(t) \\xi(t') \\rangle = 2 \\gamma k_B T \\delta(t-t')$，其中 $k_B$ 是玻尔兹曼常数。\n\n在此过程中对系统所做的功 $W$ 由施加在控制参数 $\\lambda$ 上的力乘以其位移的积分给出：\n$$\nW = \\int_0^\\tau \\frac{\\partial V(x(t), \\lambda(t))}{\\partial \\lambda} \\frac{d\\lambda}{dt} dt\n$$\n\n推导功分布的方差 $\\sigma_W^2 = \\langle W^2 \\rangle - \\langle W \\rangle^2$ 的闭合解析表达式，该表达式是参数 $\\gamma, k, T, u,$ 和 $\\tau$ 的函数。", "solution": "1. 朗之万方程和功的表达式\n由摩擦系数 $\\gamma$ 和拖动的陷阱中心可得\n$$\\gamma\\dot x=-k[x-\\lambda(t)]+\\xi(t),\\quad \\lambda(t)=ut.$$\n功为\n$$W=\\int_0^\\tau\\frac{\\partial V}{\\partial\\lambda}\\dot\\lambda\\,dt\n=\\int_0^\\tau k[x(t)-\\lambda(t)]\\,u\\,dt.$$\n\n2. 定义平移坐标 $y(t)=x(t)-ut$。那么\n$$\\dot y=\\dot x-u=-\\frac{k}{\\gamma}y-u+\\frac{\\xi(t)}{\\gamma}$$\n其中初始值 $y(0)$ 从平衡分布中采样，$\\langle y(0)\\rangle=0,\\;\\mathrm{Var}[y(0)]=k_BT/k$。\n\n3. 平均功\n$$\\langle W\\rangle=k\\,u\\int_0^\\tau\\langle y(t)\\rangle dt,\\quad\n\\langle y(t)\\rangle=-\\frac{u}{\\alpha}(1-e^{-\\alpha t}),\\;\\alpha=\\frac{k}{\\gamma}.$$\n因此\n$$\\langle W\\rangle\n=\\frac{k\\,u^2}{\\alpha}\\int_0^\\tau(1-e^{-\\alpha t})dt\n=\\gamma u^2\\Bigl(\\tau-\\frac{\\gamma}{k}(1-e^{-k\\tau/\\gamma})\\Bigr).$$\n\n4. 功的方差\n由于 $y(t)=\\langle y(t)\\rangle+z(t)$，其中 $z(t)$ 是一个OU过程，其协方差为\n$$\\langle z(t_1)z(t_2)\\rangle=\\frac{k_BT}{k}e^{-\\alpha|t_1-t_2|},$$\n我们有\n$$\\sigma_W^2\n=k^2u^2\\iint_0^\\tau\\langle z(t_1)z(t_2)\\rangle dt_1dt_2\n=k^2u^2\\frac{k_BT}{k}I,$$\n其中\n$$I=\\int_0^\\tau\\!\\!\\int_0^\\tau e^{-\\alpha|t_1-t_2|}dt_1dt_2\n=2\\int_0^\\tau\\Bigl[\\int_0^{t}e^{-\\alpha(t-s)}ds\\Bigr]dt\n=\\frac{2}{\\alpha}\\Bigl(\\tau-\\frac{1-e^{-\\alpha\\tau}}{\\alpha}\\Bigr).$$\n因此\n$$\\sigma_W^2\n=2\\gamma u^2k_BT\\Bigl(\\tau-\\frac{\\gamma}{k}(1-e^{-k\\tau/\\gamma})\\Bigr).$$", "answer": "$$\\boxed{2\\gamma\\,k_B T\\,u^2\\Bigl(\\tau-\\frac{\\gamma}{k}\\bigl(1-e^{-k\\tau/\\gamma}\\bigr)\\Bigr)}$$", "id": "317561"}, {"introduction": "在理解了非平衡功的涨落特性之后，下一个关键步骤是学习如何利用这些涨落。这项练习将向我们展示非平衡功定理最核心的应用：如何从非平衡过程中测得的功分布来计算平衡态的自由能差（$\\Delta F$）。通过一个假设的、功分布为高斯函数的模型，我们可以将数学计算简化，从而更专注于Jarzynski恒等式和Crooks涨落定理所揭示的核心物理思想[@problem_id:3428948]。", "problem": "一个一维过阻尼粒子在谐波势中通过分子动力学 (MD) 进行模拟，其刚度参数 $\\lambda(t)$ 在恒定温度 $T$ 下，于有限的协议时长 $\\tau$ 内从初始值 $\\lambda_{0}$ 驱动到最终值 $\\lambda_{1}$。其微观动力学是时间反演不变的，系统最初在 $\\lambda_{0}$ 处处于正则系综平衡，其概率密度为 $\\rho_{0}(x) = Z_{0}^{-1} \\exp(-\\beta H(x;\\lambda_{0}))$，其中 $H(x;\\lambda)$ 是哈密顿量，$Z_{0}$ 是配分函数，$\\beta = 1/(R T)$，$R$ 是摩尔气体常数。对于协议的任何单次实现，功由广义力-位移泛函 $W = \\int_{0}^{\\tau} (\\partial H/\\partial \\lambda)\\, \\dot{\\lambda}(t)\\, dt$ 定义。\n\n从大量的正向实现（驱动 $\\lambda_{0} \\to \\lambda_{1}$）系综中，测得的功值 $W$ 的分布可以很好地用一个高斯分布来描述，其均值为 $\\mu_{F}$，标准差为 $\\sigma_{F}$。独立地，一个逆向实现（驱动 $\\lambda_{1} \\to \\lambda_{0}$）的系综产生的功值也呈高斯分布，其均值为 $\\mu_{R}$，标准差为 $\\sigma_{R}$。对于此处研究的协议，获得了以下经验表征：\n- 正向：$\\mu_{F} = 7.50\\,\\text{kJ/mol}$，$\\sigma_{F} = 2.50\\,\\text{kJ/mol}$。\n- 逆向：$\\mu_{R} = -4.994\\,\\text{kJ/mol}$，$\\sigma_{R} = 2.50\\,\\text{kJ/mol}$。\n温度为 $T = 300\\,\\text{K}$，摩尔气体常数为 $R = 8.314462618\\,\\text{J}\\,(\\text{mol}\\,\\text{K})^{-1}$。\n\n从平衡的正则系综定义、微观功泛函以及动力学的微观可逆性出发，推理出将正向和逆向功分布与平衡自由能差 $\\Delta F = F(\\lambda_{1}) - F(\\lambda_{0})$ 联系起来的约束条件。然后，仅使用这些基础理论和给定的正向功系综的高斯表征，通过对正向功系综进行指数平均来计算平衡自由能差，并以 $\\text{kJ/mol}$ 为单位表示您的最终结果。将您的答案四舍五入到四位有效数字。此外，基于同样的基础理论，解析地证明您获得的值等于唯一的交叉点 $W_{c}$，在该点上，正向功密度等于在 $-W$处评估的逆向功密度，即 $p_{F}(W_{c}) = p_{R}(-W_{c})$。", "solution": "该问题要求根据非平衡过程中所做功的统计数据计算平衡自由能差 $\\Delta F$，并给出一个解析证明，将该量与正向和逆向功分布的交叉点联系起来。将非平衡功与平衡自由能联系起来的基本原理是 Jarzynski 等式。\n\nJarzynski 等式是基于以下前提推导出来的：系统从正则平衡态开始，在哈密顿动力学下演化，并且其微观动力学是可逆的（即使在与维持恒温的热浴耦合时，如此处由朗之万方程描述的过阻尼情况）。该等式表明，对系统所做的功 $W$ 的指数平均值与对应于控制参数值 $\\lambda_{1}$ 和 $\\lambda_{0}$ 的末态和初态平衡态之间的自由能差 $\\Delta F = F(\\lambda_{1}) - F(\\lambda_{0})$ 相关：\n$$\n\\langle \\exp(-\\beta W) \\rangle = \\exp(-\\beta \\Delta F)\n$$\n这里，$\\beta = (RT)^{-1}$，其中 $R$ 是摩尔气体常数，$T$ 是绝对温度。尖括号表示对正向过程（将 $\\lambda$ 从 $\\lambda_{0}$ 驱动到 $\\lambda_{1}$）的实现系综所做的平均。\n\n问题陈述，正向过程的功值分布 $p_{F}(W)$ 是一个高斯分布，其均值为 $\\mu_{F}$，标准差为 $\\sigma_{F}$：\n$$\np_{F}(W) = \\frac{1}{\\sigma_{F} \\sqrt{2\\pi}} \\exp\\left(-\\frac{(W-\\mu_{F})^2}{2\\sigma_{F}^2}\\right)\n$$\n为应用 Jarzynski 等式，我们必须计算系综平均 $\\langle \\exp(-\\beta W) \\rangle$：\n$$\n\\langle \\exp(-\\beta W) \\rangle = \\int_{-\\infty}^{\\infty} \\exp(-\\beta W) p_{F}(W) \\, dW = \\int_{-\\infty}^{\\infty} \\exp(-\\beta W) \\frac{1}{\\sigma_{F} \\sqrt{2\\pi}} \\exp\\left(-\\frac{(W-\\mu_{F})^2}{2\\sigma_{F}^2}\\right) \\, dW\n$$\n我们可以通过合并指数函数的自变量并进行配方来求解这个积分。指数是 $W$ 的二次函数：\n$$\n-\\beta W - \\frac{(W-\\mu_{F})^2}{2\\sigma_{F}^2} = -\\frac{1}{2\\sigma_{F}^2} [2\\sigma_{F}^2\\beta W + (W-\\mu_{F})^2]\n$$\n$$\n= -\\frac{1}{2\\sigma_{F}^2} [2\\sigma_{F}^2\\beta W + W^2 - 2W\\mu_{F} + \\mu_{F}^2]\n$$\n$$\n= -\\frac{1}{2\\sigma_{F}^2} [W^2 - 2W(\\mu_{F} - \\beta\\sigma_{F}^2) + \\mu_{F}^2]\n$$\n对包含 $W$ 的项进行配方：\n$$\n= -\\frac{1}{2\\sigma_{F}^2} [ (W - (\\mu_{F} - \\beta\\sigma_{F}^2))^2 - (\\mu_{F} - \\beta\\sigma_{F}^2)^2 + \\mu_{F}^2 ]\n$$\n$$\n= -\\frac{(W - (\\mu_{F} - \\beta\\sigma_{F}^2))^2}{2\\sigma_{F}^2} + \\frac{(\\mu_{F} - \\beta\\sigma_{F}^2)^2 - \\mu_{F}^2}{2\\sigma_{F}^2}\n$$\n$$\n= -\\frac{(W - (\\mu_{F} - \\beta\\sigma_{F}^2))^2}{2\\sigma_{F}^2} - \\mu_{F}\\beta + \\frac{\\beta^2\\sigma_{F}^2}{2}\n$$\n积分变为：\n$$\n\\langle \\exp(-\\beta W) \\rangle = \\frac{1}{\\sigma_{F} \\sqrt{2\\pi}} \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{(W - (\\mu_{F} - \\beta\\sigma_{F}^2))^2}{2\\sigma_{F}^2}\\right) \\exp\\left(-\\mu_{F}\\beta + \\frac{\\beta^2\\sigma_{F}^2}{2}\\right) \\, dW\n$$\n由于指数项 $\\exp(-\\mu_{F}\\beta + \\frac{\\beta^2\\sigma_{F}^2}{2})$ 相对于 $W$ 是一个常数，而剩余的积分是对一个归一化的高斯概率密度（均值为 $\\mu_{F} - \\beta\\sigma_{F}^2$）进行的，其值为1，因此：\n$$\n\\langle \\exp(-\\beta W) \\rangle = \\exp\\left(-\\beta\\mu_{F} + \\frac{\\beta^2\\sigma_{F}^2}{2}\\right)\n$$\n将此结果与 Jarzynski 等式联立：\n$$\n\\exp(-\\beta \\Delta F) = \\exp\\left(-\\beta\\mu_{F} + \\frac{\\beta^2\\sigma_{F}^2}{2}\\right)\n$$\n对两边取自然对数得到：\n$$\n-\\beta \\Delta F = -\\beta\\mu_{F} + \\frac{\\beta^2\\sigma_{F}^2}{2}\n$$\n两边同除以 $-\\beta$ (因为 $\\beta \\neq 0$)，解出 $\\Delta F$：\n$$\n\\Delta F = \\mu_{F} - \\frac{\\beta\\sigma_{F}^2}{2}\n$$\n现在，我们代入给定的数值：\n$\\mu_{F} = 7.50\\,\\text{kJ/mol}$\n$\\sigma_{F} = 2.50\\,\\text{kJ/mol}$\n$T = 300\\,\\text{K}$\n$R = 8.314462618\\,\\text{J}\\,(\\text{mol}\\,\\text{K})^{-1}$\n\n首先，我们计算乘积 $RT$ 并以 $\\text{kJ/mol}$ 为单位表示：\n$$\nRT = (8.314462618\\,\\text{J}\\,(\\text{mol}\\,\\text{K})^{-1})(300\\,\\text{K}) = 2494.3387854\\,\\text{J/mol} = 2.4943387854\\,\\text{kJ/mol}\n$$\n项 $\\beta\\sigma_{F}^2/2$ 为：\n$$\n\\frac{\\beta\\sigma_{F}^2}{2} = \\frac{\\sigma_{F}^2}{2RT} = \\frac{(2.50\\,\\text{kJ/mol})^2}{2 \\times 2.4943387854\\,\\text{kJ/mol}} = \\frac{6.25\\,(\\text{kJ/mol})^2}{4.9886775708\\,\\text{kJ/mol}} \\approx 1.252839\\,\\text{kJ/mol}\n$$\n最后，我们计算 $\\Delta F$：\n$$\n\\Delta F = 7.50\\,\\text{kJ/mol} - 1.252839\\,\\text{kJ/mol} = 6.247161\\,\\text{kJ/mol}\n$$\n按要求四舍五入到四位有效数字，我们得到 $\\Delta F = 6.247\\,\\text{kJ/mol}$。\n\n任务的第二部分是证明这个 $\\Delta F$ 值等于交叉点 $W_{c}$，其定义为 $p_{F}(W_{c}) = p_{R}(-W_{c})$。这个等式是 Crooks 涨落定理的直接推论，该定理是一个比 Jarzynski 等式更强的陈述，且从相同的基础理论推导而来。Crooks 定理将正向 ($p_{F}(W)$) 和逆向 ($p_{R}(W)$) 过程的功的概率分布联系起来：\n$$\n\\frac{p_{F}(W)}{p_{R}(-W)} = \\exp(\\beta (W - \\Delta F))\n$$\n这里，$p_{R}(-W)$ 是在逆向协议中观测到功值为 $-W$ 的概率密度。\n根据定义，交叉点 $W_{c}$ 是使 $p_{F}(W_{c}) = p_{R}(-W_{c})$ 成立的 $W$ 值。在这一点，Crooks 定理左侧的比值为 1：\n$$\n\\frac{p_{F}(W_{c})}{p_{R}(-W_{c})} = 1\n$$\n将此代入定理得到：\n$$\n1 = \\exp(\\beta (W_{c} - \\Delta F))\n$$\n对两边取自然对数意味着指数必须为零：\n$$\n\\beta(W_{c} - \\Delta F) = 0 \\implies W_{c} = \\Delta F\n$$\n这个一般性结果证实了自由能差对应于正向和逆向功分布相交处的功值。\n\n为了使用给定的高斯形式进一步验证这一点，我们显式地求解 $W_c$。逆向功分布是一个均值为 $\\mu_{R}$、标准差为 $\\sigma_{R}$ 的高斯分布，因此 $-W$（来自逆向过程）的分布是一个均值为 $-\\mu_{R}$、标准差为 $\\sigma_{R}$ 的高斯分布。\n条件 $p_{F}(W_{c}) = p_{R}(-W_{c})$ 变为：\n$$\n\\frac{1}{\\sigma_{F} \\sqrt{2\\pi}} \\exp\\left(-\\frac{(W_{c}-\\mu_{F})^2}{2\\sigma_{F}^2}\\right) = \\frac{1}{\\sigma_{R} \\sqrt{2\\pi}} \\exp\\left(-\\frac{(W_{c}-(-\\mu_{R}))^2}{2\\sigma_{R}^2}\\right)\n$$\n要使 Crooks 定理对所有具有高斯分布的 $W$ 都成立，则必须有 $\\sigma_{F} = \\sigma_{R}$。给定的数据 $\\sigma_F = \\sigma_R = 2.50\\,\\text{kJ/mol}$ 满足此条件。令 $\\sigma = \\sigma_F = \\sigma_R$。方程简化为：\n$$\n(W_{c}-\\mu_{F})^2 = (W_{c}+\\mu_{R})^2\n$$\n$$\nW_{c}^2 - 2W_{c}\\mu_{F} + \\mu_{F}^2 = W_{c}^2 + 2W_{c}\\mu_{R} + \\mu_{R}^2\n$$\n$$\n\\mu_{F}^2 - \\mu_{R}^2 = 2W_{c}(\\mu_{F} + \\mu_{R})\n$$\n$$\n(\\mu_{F} - \\mu_{R})(\\mu_{F} + \\mu_{R}) = 2W_{c}(\\mu_{F} + \\mu_{R})\n$$\n由于 $\\mu_{F} + \\mu_{R} = 7.50 - 4.994 = 2.506 \\neq 0$，我们可以用该项去除，求得 $W_c$：\n$$\nW_{c} = \\frac{\\mu_{F} - \\mu_{R}}{2}\n$$\n此外，将 Crooks 定理应用于高斯功分布所推导出的一个必要条件是关系式 $\\mu_{F} + \\mu_{R} = \\beta\\sigma^2$。利用这个关系，我们可以证明我们得到的 $\\Delta F$ 和 $W_c$ 的两个表达式是相同的。从 Jarzynski 计算中，我们得到：\n$$\n\\Delta F = \\mu_{F} - \\frac{\\beta\\sigma^2}{2}\n$$\n代入 $\\beta\\sigma^2 = \\mu_{F} + \\mu_{R}$：\n$$\n\\Delta F = \\mu_{F} - \\frac{\\mu_{F} + \\mu_{R}}{2} = \\frac{2\\mu_{F} - \\mu_{F} - \\mu_{R}}{2} = \\frac{\\mu_{F} - \\mu_{R}}{2}\n$$\n这正是 $W_c$ 的表达式，因此我们在高斯功分布模型的背景下解析地证明了 $\\Delta F = W_c$。两种推导都得出相同的数值结果：\n$$\n\\Delta F = W_c = \\frac{7.50\\,\\text{kJ/mol} - (-4.994\\,\\text{kJ/mol})}{2} = \\frac{12.494\\,\\text{kJ/mol}}{2} = 6.247\\,\\text{kJ/mol}\n$$\n这证实了问题数据与涨落定理的一致性，并给出了相同的最终答案。", "answer": "$$\n\\boxed{6.247}\n$$", "id": "3428948"}, {"introduction": "理论的精确性和实际应用中的有限数据之间总存在差距，这项练习旨在弥合这一差距。虽然Jarzynski恒等式是一个精确的理论结果，但在实际的计算机模拟或实验中，我们只能获得有限次数的功的测量值，这会给自由能的估算带来统计误差。这项练习将深入探讨Jarzynski估算量的偏差和方差，这是解读和评估任何实际计算或实验结果可靠性的关键技能[@problem_id:3428984]。", "problem": "考虑一个分子动力学方案，该方案驱动系统从逆温度为 $\\beta$ 的初始平衡态演化到一个末态，并沿每条轨迹产生一个随机功 $W$。定义末态与初始平衡态之间的自由能差为 $\\Delta F$。目标是从第一性原理出发，对非平衡功定理及其估计量进行推导，然后实现一个程序来计算与统计误差和估计量偏差相关的特定量。\n\n从正则系综出发，其中微观态 $\\Gamma$ 上的平衡概率密度与哈密顿量 $H(\\Gamma)$ 的 $\\exp(-\\beta H(\\Gamma))$ 成正比。定义平衡自由能 $F$ 为 $F = -\\beta^{-1} \\ln Z$，其中 $Z$ 是配分函数。设 $W$ 是一个从初始平衡分布开始的非平衡过程中所做的机械功。利用微观可逆性以及平衡态由正则分布表征这一事实，推导 $\\Delta F$ 与随机功 $W$ 的指数平均值之间的关系。将 $W$ 视为一个标量随机变量。对于一个正向过程产生高斯分布的功 $W \\sim \\mathcal{N}(\\mu,\\sigma^2)$（参数为 $\\mu$ 和 $\\sigma$）的模型，推导用 $\\beta$、$\\mu$ 和 $\\sigma$ 表示的 $\\Delta F$ 的表达式。\n\n将 $N$ 个独立同分布样本 $W_1,\\ldots,W_N$ 的 Jarzynski 估计量定义为\n$$\n\\widehat{\\Delta F}_N = -\\frac{1}{\\beta} \\ln \\left(\\frac{1}{N} \\sum_{i=1}^N \\exp(-\\beta W_i)\\right).\n$$\n假设 $W$ 服从高斯模型，推导当 $N$ 很大时 $\\widehat{\\Delta F}_N$ 的领头阶渐近偏差和方差。你的推导必须从正则平衡的定义出发，不得使用现成的公式；应使用适当的变换和中心极限定理来获得用 $\\beta$、$\\mu$、$\\sigma$ 和 $N$ 表示的表达式。\n\n另外，考虑一个逆向过程，其产生的功也服从高斯分布 $W_{\\mathrm{R}} \\sim \\mathcal{N}(\\mu_{\\mathrm{R}},\\sigma^2)$，且方差 $\\sigma^2$ 与正向过程相同。使用 Crooks 涨落定理（该定理通过微观可逆性将正向和逆向功分布联系起来），在两种分布都是高斯分布的情况下，推导 $\\mu_{\\mathrm{F}}$、$\\mu_{\\mathrm{R}}$、$\\sigma$、$\\beta$ 和 $\\Delta F$ 之间的关系。由此，得到一个用正向和逆向分布的高斯参数表示的 $\\Delta F$ 表达式，并证明它与通过正向分布的指数平均值推导出的表达式是一致的。\n\n单位：功 $W$、能量 $F$ 和自由能差 $\\Delta F$ 必须以 $k_{\\mathrm{B}}T$ 的约化能量单位表示，即能量以 $k_{\\mathrm{B}}T$ 的倍数计量，$\\beta=1$ 的单位是约化能量的倒数。所有输出必须以这些约化单位的数值形式表示。不出现角度。不出现百分比。\n\n实现一个程序，为以下测试套件计算每种情况下的以下量：\n- 对于仅正向高斯模型，计算高斯功模型所蕴含的真实 $\\Delta F$、Jarzynski 估计量的领头阶渐近偏差，以及 Jarzynski 估计量的领头阶渐近标准差。\n- 对于高斯正向和逆向模型，分别根据正向模型和正向-逆向关系计算 $\\Delta F$，并报告它们是否在数值容差范围内一致。\n\n测试套件：\n- 案例1 (正常路径)：$\\beta=1$, $\\mu=5$, $\\sigma=2$, $N=1000$。\n- 案例2 (小方差边界)：$\\beta=1$, $\\mu=3$, $\\sigma=0.01$, $N=50$。\n- 案例3 (大耗散边缘)：$\\beta=1$, $\\mu=0$, $\\sigma=3$, $N=100$。\n- 案例4 (Crooks 一致性检查)：$\\beta=1$, 正向 $\\mu_{\\mathrm{F}}=2.0$, 逆向 $\\mu_{\\mathrm{R}}=\\mu_{\\mathrm{F}}-\\beta\\sigma^2$，其中 $\\sigma=1.5$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，顺序如下：\n$[\\Delta F_1,\\mathrm{bias}_1,\\mathrm{std}_1,\\Delta F_2,\\mathrm{bias}_2,\\mathrm{std}_2,\\Delta F_3,\\mathrm{bias}_3,\\mathrm{std}_3,\\mathrm{crooks\\_agreement}]$\n其中 $\\Delta F_i$ 是以约化能量单位表示的浮点数，$\\mathrm{bias}_i$ 是以约化能量单位表示的浮点数，$\\mathrm{std}_i$ 是以约化能量单位表示的浮点数，而 $\\mathrm{crooks\\_agreement}$ 是一个布尔值，指示仅正向和正向-逆向的 $\\Delta F$ 表达式是否在 $10^{-12}$ 约化能量单位的容差内一致。", "solution": "所提出的问题要求针对特定的功分布，从非平衡功定理中推导出关键结果，然后进行数值实现。我们将首先验证问题陈述的有效性，然后进行完整的推导和求解。\n\n### 问题验证\n该问题在科学上植根于非平衡统计力学的既定原理，特别是 Jarzynski 等式和 Crooks 涨落定理。其前提，包括使用高斯模型来描述功分布，是文献中用以阐释这些概念的标准做法。该问题是良定的，为获得唯一解提供了所有必要的定义、参数和约束。其语言客观且正式。计算任务是所推导理论结果的直接应用。因此，该问题被认定为**有效的**。\n\n### 理论推导\n\n#### 1. 从 Jarzynski 等式推导自由能差\nJarzynski 等式将两个平衡态之间的自由能差 $\\Delta F$ 与连接这两个状态的非平衡过程中对系统所做的功 $W$ 联系起来：\n$$\n\\exp(-\\beta \\Delta F) = \\langle \\exp(-\\beta W) \\rangle\n$$\n此处，$\\beta = (k_B T)^{-1}$ 是逆温度，尖括号表示对从热平衡开始的轨迹系综进行的平均。如果功 $W$ 服从概率分布 $P(W)$，则该平均值由 $\\int P(W) \\exp(-\\beta W) dW$ 给出。\n\n问题陈述功 $W$ 从高斯分布 $W \\sim \\mathcal{N}(\\mu, \\sigma^2)$ 中抽取，其概率密度函数 (PDF) 为：\n$$\nP(W) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(W-\\mu)^2}{2\\sigma^2}\\right)\n$$\n我们必须计算期望值 $\\langle \\exp(-\\beta W) \\rangle$：\n$$\n\\langle \\exp(-\\beta W) \\rangle = \\int_{-\\infty}^{\\infty} \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(W-\\mu)^2}{2\\sigma^2}\\right) \\exp(-\\beta W) dW\n$$\n为了求解这个积分，我们合并指数中的项，并对 $W$ 进行配方：\n$$\n-\\frac{(W-\\mu)^2}{2\\sigma^2} - \\beta W = -\\frac{1}{2\\sigma^2} (W^2 - 2\\mu W + \\mu^2 + 2\\sigma^2\\beta W) = -\\frac{1}{2\\sigma^2} [W^2 - 2(\\mu - \\beta\\sigma^2)W + \\mu^2]\n$$\n对包含 $W$ 的项进行配方：\n$$\nW^2 - 2(\\mu - \\beta\\sigma^2)W = [W - (\\mu - \\beta\\sigma^2)]^2 - (\\mu - \\beta\\sigma^2)^2\n$$\n将此代入指数中可得：\n$$\n-\\frac{1}{2\\sigma^2} \\left[ [W - (\\mu - \\beta\\sigma^2)]^2 - (\\mu - \\beta\\sigma^2)^2 + \\mu^2 \\right] = -\\frac{[W - (\\mu - \\beta\\sigma^2)]^2}{2\\sigma^2} + \\frac{(\\mu - \\beta\\sigma^2)^2 - \\mu^2}{2\\sigma^2}\n$$\n积分变为：\n$$\n\\langle \\exp(-\\beta W) \\rangle = \\exp\\left(\\frac{(\\mu - \\beta\\sigma^2)^2 - \\mu^2}{2\\sigma^2}\\right) \\int_{-\\infty}^{\\infty} \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{[W - (\\mu - \\beta\\sigma^2)]^2}{2\\sigma^2}\\right) dW\n$$\n该积分是对一个完整的、归一化为 $1$ 的高斯 PDF 进行的。指数前因子可简化为：\n$$\n\\exp\\left(\\frac{\\mu^2 - 2\\mu\\beta\\sigma^2 + \\beta^2\\sigma^4 - \\mu^2}{2\\sigma^2}\\right) = \\exp\\left(\\frac{-2\\mu\\beta\\sigma^2 + \\beta^2\\sigma^4}{2\\sigma^2}\\right) = \\exp\\left(-\\beta\\mu + \\frac{\\beta^2\\sigma^2}{2}\\right)\n$$\n将此结果与 Jarzynski 等式中的 $\\exp(-\\beta \\Delta F)$ 相等：\n$$\n\\exp(-\\beta \\Delta F) = \\exp\\left(-\\beta\\mu + \\frac{\\beta^2\\sigma^2}{2}\\right)\n$$\n取自然对数并除以 $-\\beta$，得到自由能差的表达式：\n$$\n\\Delta F = \\mu - \\frac{\\beta\\sigma^2}{2}\n$$\n\n#### 2. Jarzynski 估计量的渐近偏差和方差\n从 $N$ 个样本得到的 $\\Delta F$ 的 Jarzynski 估计量为：\n$$\n\\widehat{\\Delta F}_N = -\\frac{1}{\\beta} \\ln \\left(\\frac{1}{N} \\sum_{i=1}^N \\exp(-\\beta W_i)\\right) = g(\\hat{y}_N)\n$$\n其中 $y_i = \\exp(-\\beta W_i)$，$\\hat{y}_N = \\frac{1}{N}\\sum y_i$，以及 $g(x) = -\\frac{1}{\\beta}\\ln(x)$。\n真实值为 $\\Delta F = g(y)$，其中 $y = E[y_i] = \\langle \\exp(-\\beta W) \\rangle$。对于大的 $N$，我们可以通过 $g(\\hat{y}_N)$ 在 $y$ 附近的二阶泰勒展开来分析估计量的性质：\n$$\ng(\\hat{y}_N) \\approx g(y) + g'(y)(\\hat{y}_N - y) + \\frac{1}{2}g''(y)(\\hat{y}_N - y)^2\n$$\n$g(x)$ 的导数为 $g'(x) = -1/(\\beta x)$ 和 $g''(x) = 1/(\\beta x^2)$。\n偏差为 $B[\\widehat{\\Delta F}_N] = E[g(\\hat{y}_N)] - g(y)$。对展开式取期望：\n$$\nE[g(\\hat{y}_N)] \\approx g(y) + g'(y)E[\\hat{y}_N - y] + \\frac{1}{2}g''(y)E[(\\hat{y}_N - y)^2]\n$$\n由于 $E[\\hat{y}_N - y] = 0$ 且 $E[(\\hat{y}_N - y)^2] = \\mathrm{Var}(\\hat{y}_N) = \\frac{1}{N}\\mathrm{Var}(y_i)$，领头阶偏差为：\n$$\nB[\\widehat{\\Delta F}_N] \\approx \\frac{1}{2} g''(y) \\frac{\\mathrm{Var}(y_i)}{N} = \\frac{1}{2N\\beta y^2} \\mathrm{Var}(y_i)\n$$\n为了求得 $\\mathrm{Var}(y_i)$，我们需要计算 $E[y_i^2] = \\langle \\exp(-2\\beta W) \\rangle$。使用与第1部分相同的方法，但用 $2\\beta$ 替代 $\\beta$：\n$$\nE[y_i^2] = \\exp\\left(-2\\beta\\mu + \\frac{(2\\beta)^2\\sigma^2}{2}\\right) = \\exp(-2\\beta\\mu + 2\\beta^2\\sigma^2)\n$$\n我们还有 $y = E[y_i] = \\exp(-\\beta\\mu + \\beta^2\\sigma^2/2)$。因此，$\\mathrm{Var}(y_i) = E[y_i^2] - y^2$：\n$$\n\\mathrm{Var}(y_i) = \\exp(-2\\beta\\mu + 2\\beta^2\\sigma^2) - \\left[\\exp\\left(-\\beta\\mu + \\frac{\\beta^2\\sigma^2}{2}\\right)\\right]^2 = \\exp(-2\\beta\\mu + 2\\beta^2\\sigma^2) - \\exp(-2\\beta\\mu + \\beta^2\\sigma^2)\n$$\n$$\n\\mathrm{Var}(y_i) = \\exp(-2\\beta\\mu + \\beta^2\\sigma^2)[\\exp(\\beta^2\\sigma^2) - 1]\n$$\n偏差表达式的分母包含 $y^2 = \\exp(-2\\beta\\mu + \\beta^2\\sigma^2)$。将此式和 $\\mathrm{Var}(y_i)$ 代入偏差公式：\n$$\nB[\\widehat{\\Delta F}_N] \\approx \\frac{1}{2N\\beta} \\frac{\\exp(-2\\beta\\mu + \\beta^2\\sigma^2)[\\exp(\\beta^2\\sigma^2) - 1]}{\\exp(-2\\beta\\mu + \\beta^2\\sigma^2)} = \\frac{\\exp(\\beta^2\\sigma^2) - 1}{2N\\beta}\n$$\n估计量的方差，到领头阶（通过 Delta 方法）为：\n$$\n\\mathrm{Var}(\\widehat{\\Delta F}_N) \\approx [g'(y)]^2 \\mathrm{Var}(\\hat{y}_N) = \\left(-\\frac{1}{\\beta y}\\right)^2 \\frac{\\mathrm{Var}(y_i)}{N} = \\frac{\\mathrm{Var}(y_i)}{N\\beta^2 y^2}\n$$\n这给出：\n$$\n\\mathrm{Var}(\\widehat{\\Delta F}_N) \\approx \\frac{\\exp(\\beta^2\\sigma^2) - 1}{N\\beta^2}\n$$\n标准差是其平方根：\n$$\n\\mathrm{StdDev}(\\widehat{\\Delta F}_N) \\approx \\sqrt{\\frac{\\exp(\\beta^2\\sigma^2) - 1}{N\\beta^2}} = \\frac{\\sqrt{\\exp(\\beta^2\\sigma^2) - 1}}{\\beta\\sqrt{N}}\n$$\n\n#### 3. Crooks 涨落定理分析\nCrooks 定理将正向功分布 $P_{\\mathrm{F}}(W)$ 和逆向功分布 $P_{\\mathrm{R}}(W_{\\mathrm{R}})$ 联系起来：\n$$\n\\frac{P_{\\mathrm{F}}(W)}{P_{\\mathrm{R}}(-W)} = \\exp(\\beta (W - \\Delta F))\n$$\n给定 $P_{\\mathrm{F}}(W) = \\mathcal{N}(W; \\mu_{\\mathrm{F}}, \\sigma^2)$ 和 $P_{\\mathrm{R}}(W_{\\mathrm{R}}) = \\mathcal{N}(W_{\\mathrm{R}}; \\mu_{\\mathrm{R}}, \\sigma^2)$，那么 $P_{\\mathrm{R}}(-W) = \\mathcal{N}(-W; \\mu_{\\mathrm{R}}, \\sigma^2) = \\mathcal{N}(W; -\\mu_{\\mathrm{R}}, \\sigma^2)$。PDF 的比率为：\n$$\n\\frac{\\exp\\left(-\\frac{(W-\\mu_{\\mathrm{F}})^2}{2\\sigma^2}\\right)}{\\exp\\left(-\\frac{(W-(-\\mu_{\\mathrm{R}}))^2}{2\\sigma^2}\\right)} = \\exp\\left( \\frac{(W+\\mu_{\\mathrm{R}})^2 - (W-\\mu_{\\mathrm{F}})^2}{2\\sigma^2} \\right) = \\exp\\left( \\frac{2W(\\mu_{\\mathrm{F}}+\\mu_{\\mathrm{R}}) + \\mu_{\\mathrm{R}}^2 - \\mu_{\\mathrm{F}}^2}{2\\sigma^2} \\right)\n$$\n将该表达式的对数与 $\\beta W - \\beta\\Delta F$ 相等：\n$$\n\\frac{\\mu_{\\mathrm{F}}+\\mu_{\\mathrm{R}}}{\\sigma^2}W + \\frac{\\mu_{\\mathrm{R}}^2 - \\mu_{\\mathrm{F}}^2}{2\\sigma^2} = \\beta W - \\beta\\Delta F\n$$\n为使该恒等式对所有 $W$ 都成立，$W$ 的系数和常数项必须相等。\n1.  从 $W$ 的系数可得：$\\frac{\\mu_{\\mathrm{F}}+\\mu_{\\mathrm{R}}}{\\sigma^2} = \\beta \\implies \\mu_{\\mathrm{F}}+\\mu_{\\mathrm{R}} = \\beta\\sigma^2$。这是两个高斯功分布能通过 Crooks 定理关联起来的必要条件。\n2.  从常数项可得：$\\frac{\\mu_{\\mathrm{R}}^2 - \\mu_{\\mathrm{F}}^2}{2\\sigma^2} = -\\beta\\Delta F \\implies \\Delta F = \\frac{\\mu_{\\mathrm{F}}^2 - \\mu_{\\mathrm{R}}^2}{2\\beta\\sigma^2}$。\n\n为了证明一致性，我们假设条件 $\\mu_{\\mathrm{F}}+\\mu_{\\mathrm{R}} = \\beta\\sigma^2$ 成立。我们可以重写 $\\Delta F$ 的表达式：\n$$\n\\Delta F = \\frac{(\\mu_{\\mathrm{F}} - \\mu_{\\mathrm{R}})(\\mu_{\\mathrm{F}} + \\mu_{\\mathrm{R}})}{2\\beta\\sigma^2} = \\frac{(\\mu_{\\mathrm{F}} - \\mu_{\\mathrm{R}})(\\beta\\sigma^2)}{2\\beta\\sigma^2} = \\frac{\\mu_{\\mathrm{F}} - \\mu_{\\mathrm{R}}}{2}\n$$\n将 $\\mu_{\\mathrm{R}} = \\beta\\sigma^2 - \\mu_{\\mathrm{F}}$ 代入这个简化形式中可得：\n$$\n\\Delta F = \\frac{\\mu_{\\mathrm{F}} - (\\beta\\sigma^2 - \\mu_{\\mathrm{F}})}{2} = \\frac{2\\mu_{\\mathrm{F}} - \\beta\\sigma^2}{2} = \\mu_{\\mathrm{F}} - \\frac{\\beta\\sigma^2}{2}\n$$\n这恰好是从 Jarzynski 等式得到的 $\\Delta F$ 表达式，从而证实了这两个框架的一致性。\n\n对于案例4，问题定义了 $\\mu_{\\mathrm{R}} = \\mu_{\\mathrm{F}} - \\beta\\sigma^2$。这个定义通常情况下不满足条件 $\\mu_{\\mathrm{F}}+\\mu_{\\mathrm{R}} = \\beta\\sigma^2$。因此，这组参数可能代表一个物理上不一致的情景。然而，问题要求比较从 Jarzynski 公式和从 Crooks 推导出的公式 $\\Delta F = (\\mu_{\\mathrm{F}}^2 - \\mu_{\\mathrm{R}}^2)/(2\\beta\\sigma^2)$ 得到的数值结果。如推导所示，如果将 $\\mu_{\\mathrm{R}}$ 定义为 $\\mu_{\\mathrm{F}} - \\beta\\sigma^2$，这两个公式在代数上变得恒等，因此它们的结果将会一致。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes quantities related to non-equilibrium work theorems\n    for a series of test cases.\n    \"\"\"\n    \n    # Test suite defined in the problem statement.\n    # Cases 1-3: (beta, mu, sigma, N) for Jarzynski estimator analysis.\n    # Case 4: (beta, mu_F, sigma, mu_R_def) for Crooks consistency check.\n    # mu_R_def is a lambda function to define mu_R based on forward parameters.\n    test_cases = [\n        (1.0, 5.0, 2.0, 1000),      # Case 1\n        (1.0, 3.0, 0.01, 50),       # Case 2\n        (1.0, 0.0, 3.0, 100),       # Case 3\n    ]\n    \n    case4_params = {\n        \"beta\": 1.0, \n        \"mu_F\": 2.0, \n        \"sigma\": 1.5,\n        \"mu_R_def\": lambda beta, mu_F, sigma: mu_F - beta * sigma**2\n    }\n\n    results = []\n\n    # Process cases 1-3 for Jarzynski estimator properties\n    for beta, mu, sigma, N in test_cases:\n        # 1. True Delta F from the forward Gaussian model\n        # Formula: Delta_F = mu - (beta * sigma^2) / 2\n        delta_F = mu - (beta * sigma**2) / 2.0\n        \n        # 2. Leading-order asymptotic bias of the Jarzynski estimator\n        # Formula: Bias = (exp(beta^2 * sigma^2) - 1) / (2 * N * beta)\n        # Using np.expm1 for better precision when the argument is small\n        exp_arg = beta**2 * sigma**2\n        bias = np.expm1(exp_arg) / (2.0 * N * beta)\n        \n        # 3. Leading-order asymptotic standard deviation\n        # Formula: StdDev = sqrt(exp(beta^2 * sigma^2) - 1) / (beta * sqrt(N))\n        std_dev = np.sqrt(np.expm1(exp_arg)) / (beta * np.sqrt(N))\n        \n        results.extend([delta_F, bias, std_dev])\n\n    # Process case 4 for Crooks consistency check\n    beta = case4_params[\"beta\"]\n    mu_F = case4_params[\"mu_F\"]\n    sigma = case4_params[\"sigma\"]\n    \n    # Define mu_R as per the problem statement for this specific case\n    mu_R = case4_params[\"mu_R_def\"](beta, mu_F, sigma)\n    \n    # Calculate Delta F from the forward-only Jarzynski model\n    # Formula: Delta_F_J = mu_F - (beta * sigma^2) / 2\n    delta_F_Jarzynski = mu_F - (beta * sigma**2) / 2.0\n    \n    # Calculate Delta F from the forward-reverse relation (Crooks)\n    # Formula: Delta_F_C = (mu_F^2 - mu_R^2) / (2 * beta * sigma^2)\n    numerator = mu_F**2 - mu_R**2\n    denominator = 2.0 * beta * sigma**2\n    delta_F_Crooks = numerator / denominator\n    \n    # Check for agreement within the specified tolerance\n    tolerance = 1e-12\n    crooks_agreement = np.abs(delta_F_Jarzynski - delta_F_Crooks) = tolerance\n    \n    results.append(crooks_agreement)\n\n    # Format and print the final output\n    formatted_results = []\n    for item in results:\n        if isinstance(item, bool):\n            formatted_results.append(str(item).lower())\n        else:\n            formatted_results.append(f\"{item:.12g}\")\n\n    print(f\"[{','.join(formatted_results)}]\")\n\n# Execute the solution\nsolve()\n\n```", "id": "3428984"}]}