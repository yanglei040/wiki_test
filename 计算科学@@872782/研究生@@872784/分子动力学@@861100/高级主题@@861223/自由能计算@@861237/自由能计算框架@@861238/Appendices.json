{"hands_on_practices": [{"introduction": "掌握自由能计算的最好方法是从一个基本且可解析求解的例子开始。本练习将引导您在一个简单的谐波振子系统上应用热力学积分 (TI) 的核心公式。通过手动计算积分路径上的系综平均值并完成积分，您将深入理解 TI 方法的力学原理，并验证一个物理直觉：平移对称性不应改变体系的自由能 [@problem_id:3414384]。", "problem": "考虑一个处于正则系综中的一维系统，其温度为 $T$，逆热能为 $\\beta = 1/(k_{B} T)$，其中 $k_{B}$ 是玻尔兹曼常数。一个耦合参数 $\\lambda \\in [0,1]$ 定义了一个混合势\n$$\nU_{\\lambda}(x) = \\frac{k}{2}\\big[(1-\\lambda)x^{2} + \\lambda (x-a)^{2}\\big],\n$$\n其刚度为 $k>0$，位移为 $a \\in \\mathbb{R}$。在固定的 $\\lambda$ 下，正则系综平均定义为\n$$\n\\langle A\\rangle_{\\lambda} = \\frac{\\int_{-\\infty}^{\\infty} A(x)\\exp\\big(-\\beta U_{\\lambda}(x)\\big)\\,\\mathrm{d}x}{\\int_{-\\infty}^{\\infty} \\exp\\big(-\\beta U_{\\lambda}(x)\\big)\\,\\mathrm{d}x}.\n$$\n仅使用这些定义，首先计算对于每个 $\\lambda \\in [0,1]$，系综平均 $\\left\\langle \\frac{\\partial U_{\\lambda}}{\\partial \\lambda}\\right\\rangle_{\\lambda}$ 的精确解析表达式。然后进行热力学积分，\n$$\n\\Delta F = \\int_{0}^{1} \\left\\langle \\frac{\\partial U_{\\lambda}}{\\partial \\lambda}\\right\\rangle_{\\lambda}\\,\\mathrm{d}\\lambda,\n$$\n以获得在 $\\lambda=1$ 和 $\\lambda=0$ 状态之间的自由能差 $\\Delta F = F_{1} - F_{0}$。假设坐标 $x$ 覆盖整个实轴，并且没有边界效应。将最终的自由能差以焦耳为单位表示。无需四舍五入；请提供精确值作为最终答案。", "solution": "我们从温度为 $T$、逆热能为 $\\beta = 1/(k_{B} T)$ 的系统的正则系综定义开始。势能为\n$$\nU_{\\lambda}(x) = \\frac{k}{2}\\left[(1-\\lambda)x^{2} + \\lambda (x-a)^{2}\\right].\n$$\n我们需要计算 $\\left\\langle \\frac{\\partial U_{\\lambda}}{\\partial \\lambda}\\right\\rangle_{\\lambda}$。首先，计算势能对 $\\lambda$ 的导数：\n$$\n\\frac{\\partial U_{\\lambda}}{\\partial \\lambda} = \\frac{k}{2}\\left[-x^{2} + (x-a)^{2}\\right] = \\frac{k}{2}\\left[-x^{2} + x^{2} - 2 a x + a^{2}\\right] = \\frac{k}{2}\\left(a^{2} - 2 a x\\right).\n$$\n因此，\n$$\n\\left\\langle \\frac{\\partial U_{\\lambda}}{\\partial \\lambda}\\right\\rangle_{\\lambda} = \\frac{k}{2}\\left(a^{2} - 2 a \\langle x\\rangle_{\\lambda}\\right).\n$$\n为了计算 $\\langle x\\rangle_{\\lambda}$，我们分析与 $\\lambda$ 相关的二次势。展开并配方：\n$$\nU_{\\lambda}(x) = \\frac{k}{2}\\left[x^{2} - 2 \\lambda a x + \\lambda a^{2}\\right] = \\frac{k}{2}\\left[(x - \\lambda a)^{2} + \\lambda(1-\\lambda)a^{2}\\right].\n$$\n于是玻尔兹曼权重可以分解为\n$$\n\\exp\\big(-\\beta U_{\\lambda}(x)\\big) = \\exp\\left(-\\beta \\frac{k}{2} (x - \\lambda a)^{2}\\right)\\exp\\left(-\\beta \\frac{k}{2}\\lambda(1-\\lambda)a^{2}\\right).\n$$\n因子 $\\exp\\left(-\\beta \\frac{k}{2}\\lambda(1-\\lambda)a^{2}\\right)$ 与 $x$ 无关，在任何正则平均的计算中都会在分子和分母之间被约掉。与 $x$ 相关的部分是一个中心在 $x = \\lambda a$、曲率为 $k$ 的高斯函数。根据高斯函数的对称性，\n$$\n\\langle x\\rangle_{\\lambda} = \\lambda a.\n$$\n将此结果代入平均导数的表达式中，得到\n$$\n\\left\\langle \\frac{\\partial U_{\\lambda}}{\\partial \\lambda}\\right\\rangle_{\\lambda} = \\frac{k}{2}\\left(a^{2} - 2 a \\cdot \\lambda a\\right) = \\frac{k}{2} a^{2}(1 - 2\\lambda).\n$$\n我们现在从 $\\lambda=0$ 到 $\\lambda=1$ 进行热力学积分，以获得自由能差 $\\Delta F = F_{1} - F_{0}$：\n$$\n\\Delta F = \\int_{0}^{1} \\left\\langle \\frac{\\partial U_{\\lambda}}{\\partial \\lambda}\\right\\rangle_{\\lambda}\\,\\mathrm{d}\\lambda = \\int_{0}^{1} \\frac{k}{2} a^{2}(1 - 2\\lambda)\\,\\mathrm{d}\\lambda.\n$$\n计算该积分，\n$$\n\\Delta F = \\frac{k}{2} a^{2}\\int_{0}^{1} (1 - 2\\lambda)\\,\\mathrm{d}\\lambda = \\frac{k}{2} a^{2}\\left[\\lambda - \\lambda^{2}\\right]_{0}^{1} = \\frac{k}{2} a^{2}(1 - 1) = 0.\n$$\n因此，这两个状态之间的自由能差精确为零。这个结果与物理诠释是一致的：两个端点势 $U_{0}(x) = \\frac{k}{2}x^{2}$ 和 $U_{1}(x) = \\frac{k}{2}(x-a)^{2}$ 仅相差一个 $x$ 方向上的平移，而在整个实轴上，这样的平移不会改变配分函数，因此自由能没有变化。\n\n作为内部一致性检验，我们也可以直接从配分函数计算与 $\\lambda$ 相关的自由能。构型配分函数可以分解为\n$$\nZ_{\\lambda}^{\\text{conf}} = \\int_{-\\infty}^{\\infty} \\exp\\left(-\\beta \\frac{k}{2}(x - \\lambda a)^{2}\\right)\\,\\mathrm{d}x \\times \\exp\\left(-\\beta \\frac{k}{2}\\lambda(1-\\lambda)a^{2}\\right),\n$$\n其中高斯积分与 $\\lambda$ 无关，所以\n$$\nF_{\\lambda} = -\\frac{1}{\\beta}\\ln Z_{\\lambda}^{\\text{conf}} = \\text{const} + \\frac{k}{2}\\lambda(1-\\lambda)a^{2}.\n$$\n因此，\n$$\nF_{1} - F_{0} = \\frac{k}{2}\\left[1\\cdot 0 - 0\\cdot 1\\right]a^{2} = 0,\n$$\n与热力学积分的结果一致。最终答案是精确的零焦耳，无需四舍五入。", "answer": "$$\\boxed{0}$$", "id": "3414384"}, {"introduction": "在真实的炼金术自由能计算中，一个关键的挑战是处理粒子凭空出现或消失时产生的“终点奇点”问题。本练习将探讨一种标准的解决方案——软核势 (soft-core potential)，它通过平滑地修改相互作用势来避免在模拟中出现无穷大的力。通过推导其对耦合参数 $\\lambda$ 的导数，您将理解软核势如何保证热力学积分路径的光滑性和数值稳定性 [@problem_id:3414367]。", "problem": "在采用热力学积分 (TI) 的分子动力学自由能计算中，被积函数是哈密顿量对耦合参数的偏导数的系综平均。考虑一个软核 Lennard–Jones 势，其引入是为了在相互作用被开启和关闭时对奇点进行正则化。设哈密顿量的构型空间贡献为一个由下式定义的势：\n$$U_{\\text{sc}}(\\lambda,r) = \\lambda \\, U_{\\text{LJ}}(r_{\\text{sc}}),$$\n其中软核映射由下式给出：\n$$r_{\\text{sc}}^{6} = r^{6} + \\alpha \\left(1 - \\lambda\\right)^{m},$$\n其中 $r > 0$，$\\lambda \\in [0,1]$，$\\alpha > 0$ 且 $m \\geq 1$。底层的 Lennard–Jones 势为：\n$$U_{\\text{LJ}}(r) = 4 \\epsilon \\left[ \\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^{6} \\right],$$\n参数为 $\\epsilon > 0$ 和 $\\sigma > 0$。\n\n从基本微积分和上述定义出发，推导在固定 $r$ 时偏导数 $\\partial U_{\\text{sc}}/\\partial \\lambda$ 的闭式解析表达式。最终结果仅用 $r$、$\\lambda$、$\\epsilon$、$\\sigma$、$\\alpha$ 和 $m$ 来表示，并在适当情况下使用 $r^{6} + \\alpha (1-\\lambda)^{m}$ 的幂。然后，以推导出的表达式为基础，论述 $\\alpha$ 和 $m$ 的选择如何影响 TI 被积函数 $\\partial U_{\\text{sc}}/\\partial \\lambda$ 在 $\\lambda \\to 0^{+}$ 和 $\\lambda \\to 1^{-}$ 附近的有界性和平滑性，特别是对于小的 $r$。\n\n你的最终答案必须是 $\\partial U_{\\text{sc}}/\\partial \\lambda$ 的单个解析表达式。最终答案中不要包含任何讨论。不需要进行数值计算，也不需要四舍五入。表达式应不带单位。", "solution": "该问题陈述经过验证，是科学合理的、定义明确且客观的。它提出了一个计算统计力学中的标准问题，尤其与自由能计算相关。所有参数和函数都已清晰定义，求解过程是微分学和极限分析的直接应用。\n\n目标是推导偏导数 $\\frac{\\partial U_{\\text{sc}}}{\\partial \\lambda}$，并分析其在耦合参数 $\\lambda$ 端点处的行为。软核势由下式给出：\n$$U_{\\text{sc}}(\\lambda,r) = \\lambda \\, U_{\\text{LJ}}(r_{\\text{sc}})$$\n其中 Lennard-Jones 势为 $U_{\\text{LJ}}(r) = 4 \\epsilon \\left[ \\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^{6} \\right]$，软核距离 $r_{\\text{sc}}$ 通过关系式 $r_{\\text{sc}}^{6} = r^{6} + \\alpha \\left(1 - \\lambda\\right)^{m}$ 定义。\n\n为简化求导，我们定义一个中间变量 $S(\\lambda) = r_{\\text{sc}}^{6} = r^{6} + \\alpha \\left(1 - \\lambda\\right)^{m}$。于是，Lennard-Jones 势可以写成 $S$ 的函数：\n$$U_{\\text{LJ}}(S) = 4 \\epsilon \\left[ \\sigma^{12} S^{-2} - \\sigma^{6} S^{-1} \\right]$$\n软核势则为 $U_{\\text{sc}}(\\lambda, r) = \\lambda \\, U_{\\text{LJ}}(S(\\lambda))$。我们需要求出在固定 $r$ 时关于 $\\lambda$ 的偏导数。我们应用微分的乘法法则：\n$$\\frac{\\partial U_{\\text{sc}}}{\\partial \\lambda} = \\frac{\\partial}{\\partial \\lambda} \\left( \\lambda \\cdot U_{\\text{LJ}}(S) \\right) = \\frac{\\partial \\lambda}{\\partial \\lambda} U_{\\text{LJ}}(S) + \\lambda \\frac{\\partial U_{\\text{LJ}}(S)}{\\partial \\lambda}$$\n$$\\frac{\\partial U_{\\text{sc}}}{\\partial \\lambda} = U_{\\text{LJ}}(S) + \\lambda \\frac{\\partial U_{\\text{LJ}}(S)}{\\partial \\lambda}$$\n第二项需要使用链式法则，因为 $U_{\\text{LJ}}$ 通过 $S$ 依赖于 $\\lambda$：\n$$\\frac{\\partial U_{\\text{LJ}}(S)}{\\partial \\lambda} = \\frac{d U_{\\text{LJ}}}{dS} \\frac{\\partial S}{\\partial \\lambda}$$\n让我们计算右侧的两个导数。首先是 $U_{\\text{LJ}}$ 对 $S$ 的导数：\n$$\\frac{d U_{\\text{LJ}}}{dS} = \\frac{d}{dS} \\left( 4 \\epsilon \\left[ \\sigma^{12} S^{-2} - \\sigma^{6} S^{-1} \\right] \\right) = 4 \\epsilon \\left[ \\sigma^{12} (-2 S^{-3}) - \\sigma^{6} (-1 S^{-2}) \\right] = 4 \\epsilon \\left[ -2\\sigma^{12} S^{-3} + \\sigma^{6} S^{-2} \\right]$$\n接下来是 $S$ 对 $\\lambda$ 的导数：\n$$\\frac{\\partial S}{\\partial \\lambda} = \\frac{\\partial}{\\partial \\lambda} \\left( r^{6} + \\alpha (1 - \\lambda)^{m} \\right) = \\alpha \\cdot m(1-\\lambda)^{m-1} \\cdot (-1) = -m\\alpha(1-\\lambda)^{m-1}$$\n现在，我们将这些代回 $\\frac{\\partial U_{\\text{sc}}}{\\partial \\lambda}$ 的表达式中：\n$$\\frac{\\partial U_{\\text{sc}}}{\\partial \\lambda} = U_{\\text{LJ}}(S) + \\lambda \\left( 4 \\epsilon \\left[ -2\\sigma^{12} S^{-3} + \\sigma^{6} S^{-2} \\right] \\right) \\left( -m\\alpha(1-\\lambda)^{m-1} \\right)$$\n代入 $U_{\\text{LJ}}(S)$ 的表达式并展开各项：\n$$\\frac{\\partial U_{\\text{sc}}}{\\partial \\lambda} = 4 \\epsilon \\left[ \\frac{\\sigma^{12}}{S^{2}} - \\frac{\\sigma^{6}}{S} \\right] + 4 \\epsilon \\lambda m \\alpha (1-\\lambda)^{m-1} \\left[ 2\\sigma^{12} S^{-3} - \\sigma^{6} S^{-2} \\right]$$\n为了得到一个更结构化的表达式，我们可以按 $\\sigma$ 的幂对各项进行分组：\n$$\\frac{\\partial U_{\\text{sc}}}{\\partial \\lambda} = 4 \\epsilon \\sigma^{12} \\left[ \\frac{1}{S^{2}} + \\frac{2\\lambda m \\alpha (1-\\lambda)^{m-1}}{S^{3}} \\right] - 4 \\epsilon \\sigma^{6} \\left[ \\frac{1}{S} + \\frac{\\lambda m \\alpha (1-\\lambda)^{m-1}}{S^{2}} \\right]$$\n合并每个括号内的分数：\n$$\\frac{\\partial U_{\\text{sc}}}{\\partial \\lambda} = 4 \\epsilon \\sigma^{12} \\left[ \\frac{S + 2\\lambda m \\alpha (1-\\lambda)^{m-1}}{S^{3}} \\right] - 4 \\epsilon \\sigma^{6} \\left[ \\frac{S + \\lambda m \\alpha (1-\\lambda)^{m-1}}{S^{2}} \\right]$$\n最后，将 $S = r^{6} + \\alpha (1-\\lambda)^{m}$ 代回，得到所需的闭式表达式：\n$$\\frac{\\partial U_{\\text{sc}}}{\\partial \\lambda} = 4 \\epsilon \\sigma^{12} \\frac{r^{6} + \\alpha(1-\\lambda)^{m} + 2\\lambda m \\alpha (1-\\lambda)^{m-1}}{\\left(r^{6} + \\alpha (1-\\lambda)^{m}\\right)^{3}} - 4 \\epsilon \\sigma^{6} \\frac{r^{6} + \\alpha(1-\\lambda)^{m} + \\lambda m \\alpha (1-\\lambda)^{m-1}}{\\left(r^{6} + \\alpha (1-\\lambda)^{m}\\right)^{2}}$$\n这就是 TI 被积函数的解析表达式。\n\n现在我们分析 $\\alpha$ 和 $m$ 对此被积函数（记为 $I(\\lambda, r) = \\frac{\\partial U_{\\text{sc}}}{\\partial \\lambda}$）在端点 $\\lambda \\to 0^{+}$ 和 $\\lambda \\to 1^{-}$ 附近的有界性和平滑性的影响。TI 中的关键问题是确保系综平均 $\\langle I(\\lambda, r) \\rangle_{\\lambda}$ 在整个积分路径上是良态的。这要求 $I(\\lambda, r)$ 本身对于在给定 $\\lambda$ 下可及的构型 $r$ 保持有限。\n\n在 $\\lambda \\to 1^{-}$ 附近的分析：\n当 $\\lambda \\to 1^{-}$ 时，项 $(1-\\lambda) \\to 0$。因此，$r_{\\text{sc}}^{6} = r^{6} + \\alpha(1-\\lambda)^{m} \\to r^{6}$。势 $U_{\\text{sc}}$ 平滑地转变为标准的 Lennard-Jones 势 $U_{\\text{LJ}}(r)$。被积函数 $I(\\lambda, r)$ 趋近于一个极限函数。对于 $m>1$，$\\lim_{\\lambda \\to 1^{-}} I(\\lambda,r) = U_{\\text{LJ}}(r)$。对于 $m=1$，极限是 $U_{\\text{LJ}}(r)$ 及其关于 $r^{6}$ 的导数的组合。在任何一种情况下，当 $r \\to 0$ 时，$I(1,r)$ 是无界的，以 $r^{-12}$ 或更快的速度发散。这不是一个实际问题，因为当 $\\lambda \\approx 1$ 时，势能在小 $r$ 处具有很强的排斥性，因此玻尔兹曼因子 $\\exp(-U_{\\text{sc}}/k_B T)$ 确保了小 $r$ 的构型不会被采样。因此，系综平均 $\\langle I(\\lambda, r) \\rangle_{\\lambda \\to 1^{-}}$ 保持有限。$\\alpha$ 或 $m$ 的选择不会改变被积函数本身在此端点 $r=0$ 处的基本发散性。\n\n在 $\\lambda \\to 0^{+}$ 附近的分析：\n这是一个关键端点。在 $\\lambda=0$ 时，粒子无相互作用，因此具有小粒子间距（包括 $r \\to 0$）的构型在物理上是可及的。为了使 TI 积分在数值上可处理，当 $\\lambda \\to 0^{+}$ 时，被积函数必须对所有 $r$ 都有界。\n让我们考察我们推导的表达式在 $\\lambda \\to 0^{+}$ 时的极限。项 $\\lambda$ 乘以表达式的导数部分，因此我们关注主导项：\n$$\\lim_{\\lambda \\to 0^{+}} I(\\lambda,r) = \\lim_{\\lambda \\to 0^{+}} U_{\\text{LJ}}(r_{\\text{sc}}) = U_{\\text{LJ}}(r_{\\text{sc}}|_{\\lambda=0})$$\n在 $\\lambda=0$ 时，$S(0) = r_{\\text{sc}}^{6}|_{\\lambda=0} = r^{6} + \\alpha(1-0)^{m} = r^{6} + \\alpha$。所以极限为：\n$$\\lim_{\\lambda \\to 0^{+}} I(\\lambda,r) = 4 \\epsilon \\left[ \\frac{\\sigma^{12}}{(r^{6}+\\alpha)^{2}} - \\frac{\\sigma^{6}}{r^{6}+\\alpha} \\right]$$\n由于 $\\alpha > 0$，此表达式对于所有 $r \\geq 0$ 都是有限的。即使当 $r=0$ 时，分母也变为 $\\alpha$ 或 $\\alpha^{2}$，从而避免了奇点。被积函数在临界点 $(\\lambda, r) = (0, 0)$ 的值为：\n$$\\lim_{r \\to 0} \\left( \\lim_{\\lambda \\to 0^{+}} I(\\lambda,r) \\right) = 4 \\epsilon \\left[ \\frac{\\sigma^{12}}{\\alpha^{2}} - \\frac{\\sigma^{6}}{\\alpha} \\right]$$\n这是一个有限值。因此，软核势成功地对奇点进行了正则化。\n参数的作用如下：\n- $\\alpha$：参数 $\\alpha > 0$ 对于确保被积函数在 $\\lambda=0$ 处的有界性至关重要。它设定了软核半径的“底”值，$r_{\\text{sc}} \\geq \\alpha^{1/6}$，防止势及其导数即使在 $r=0$ 时也发散。它直接控制了被积函数在此端点的量级。\n- $m$：参数 $m \\geq 1$ 不影响被积函数在 $\\lambda=0$ 处的值。它影响被积函数曲线作为 $\\lambda$ 的函数的“形状”。例如，端点处的平滑性（关于 $\\lambda$ 的高阶导数）受到 $m$ 的选择的影响。然而，对于确保被积函数在 $\\lambda=0$ 处有界这一关键任务，任何 $m \\geq 1$ 都已足够。关于 $\\lambda$ 的导数在 $\\lambda=0$ 处也是有限的，确保了被积函数在此端点附近是一个平滑函数。", "answer": "$$\n\\boxed{\n4 \\epsilon \\sigma^{12} \\frac{r^{6} + \\alpha(1-\\lambda)^{m} + 2 \\lambda m \\alpha (1-\\lambda)^{m-1}}{\\left(r^{6} + \\alpha (1-\\lambda)^{m}\\right)^{3}} - 4 \\epsilon \\sigma^{6} \\frac{r^{6} + \\alpha(1-\\lambda)^{m} + \\lambda m \\alpha (1-\\lambda)^{m-1}}{\\left(r^{6} + \\alpha (1-\\lambda)^{m}\\right)^{2}}\n}\n$$", "id": "3414367"}, {"introduction": "计算蛋白质-配体结合自由能是自由能方法最重要的应用之一，但这通常需要使用位置和方向限制来防止解离的配体在溶液中“丢失”。然而，选择合适的限制力常数本身就是一个微妙的优化问题。本练习将探讨在解耦状态下限制配体的波动范围与在耦合状态下保持良好相空间重叠之间的权衡，这是确保计算高效和准确的关键 [@problem_id:3414359]。", "problem": "在一个炼金术双解耦结合自由能计算中，一个小分子配体通过六个 Boresch 类型的刚体约束被束缚在蛋白质的结合位点上：一个距离 $r$，两个极角 $\\theta_A,\\theta_B$，两个方位角 $\\phi_A,\\phi_B$，以及一个二面角 $\\chi$。每个约束都受到一个形式为 $U_x = \\tfrac{1}{2} k_x (x - x_0)^2$ 的谐波势作用于相应的坐标 $x$。模拟温度为 $T=300\\,\\mathrm{K}$。在所有炼金术状态下，这些约束都以相同的方式施加来定义标准态，并在循环结束时包含一个精确的解析约束自由能校正。\n\n你在全耦合状态（所有配体-环境相互作用均开启）下进行了一次短时间的约束平衡模拟，并测量了约束坐标相对于其参考值的束缚态涨落，发现涨落近似为高斯分布，其标准差为 $\\sigma_r^\\ast = 0.10\\,\\mathrm{nm}$，$\\sigma_{\\theta_A}^\\ast \\approx \\sigma_{\\theta_B}^\\ast = 0.17\\,\\mathrm{rad}$，$\\sigma_{\\phi_A}^\\ast \\approx \\sigma_{\\phi_B}^\\ast = 0.17\\,\\mathrm{rad}$，以及 $\\sigma_{\\chi}^\\ast = 0.35\\,\\mathrm{rad}$。假设配体在其他方面是刚性的，并且锚定原子的几何构型对于所选的角度避免了奇异的雅可比矩阵。\n\n从玻尔兹曼分布和和谐波约束的定义出发，分析约束力常数 $k_x$ 的选择如何影响 (i) 跨炼金术状态的采样效率和 (ii) 潜在的偏差来源。然后，提出一个选择力常数 $k_x$ 的策略，该策略既能紧密地局域化解耦的配体，又能保证弱耦合与强耦合炼金术状态之间有足够的相空间重叠。请选择以下最佳选项。\n\nA. 选择 $k_x$ 使得解耦极限下约束坐标的热宽度与测量的束缚态宽度相匹配。具体来说，设置 $k_r \\approx k_B T / (\\sigma_r^\\ast)^2$，$k_{\\theta_{A,B}} \\approx k_B T / (\\sigma_{\\theta_{A,B}}^\\ast)^2$，$k_{\\phi_{A,B}} \\approx k_B T / (\\sigma_{\\phi_{A,B}}^\\ast)^2$，以及 $k_\\chi \\approx k_B T / (\\sigma_\\chi^\\ast)^2$，在所有炼金术状态中保持所有 $k_x$ 不变，并通过监测相邻状态之间的简约势重叠或有效样本量来验证重叠。这大约得到 $k_r \\approx 2.5 \\times 10^2\\,\\mathrm{kJ\\,mol^{-1}\\,nm^{-2}}$，$k_{\\theta_{A,B}} \\approx 8.6 \\times 10^1\\,\\mathrm{kJ\\,mol^{-1}\\,rad^{-2}}$，$k_{\\phi_{A,B}} \\approx 8.6 \\times 10^1\\,\\mathrm{kJ\\,mol^{-1}\\,rad^{-2}}$，以及 $k_\\chi \\approx 2.0 \\times 10^1\\,\\mathrm{kJ\\,mol^{-1}\\,rad^{-2}}$。使用足够小的时间步长来解析最快的约束模式，并包含标准的解析约束校正，无需额外项。\n\nB. 使约束极度刚硬以防止配体在解耦状态下有任何运动，例如，设置 $k_r \\gtrsim 5.0 \\times 10^3\\,\\mathrm{kJ\\,mol^{-1}\\,nm^{-2}}$ 以及所有角度坐标的 $k \\gtrsim 1.0 \\times 10^3\\,\\mathrm{kJ\\,mol^{-1}\\,rad^{-2}}$，并在所有炼金术状态中保持它们不变。这保证了局域化，最大化了重叠，并且由于包含了分析校正，因此不会引入偏差。\n\nC. 使约束非常弱以最大化解耦和耦合状态之间的相空间重叠，例如，设置 $k_r \\lesssim 1.0 \\times 10^1\\,\\mathrm{kJ\\,mol^{-1}\\,nm^{-2}}$ 以及所有角度坐标的 $k \\lesssim 2.0 \\times 10^0\\,\\mathrm{kJ\\,mol^{-1}\\,rad^{-2}}$。这允许解耦的配体进行广泛探索，减少了相关时间，并确保解析约束校正能够解释额外的熵而不会产生不利后果。\n\nD. 随炼金术耦合参数改变约束强度，将 $k_x(\\lambda)$ 从 $\\lambda=0$ (完全解耦) 时的 $k_x(0)=0$ 线性缩放到 $\\lambda=1$ (完全耦合) 时的大 $k_x(1)$，同时保留为固定 $k_x$ 推导出的标准解析约束校正；这消除了在解耦状态下的重叠问题，并避免了任何额外的校正，因为最终和初始状态没有改变。", "solution": "**1. 问题验证**\n\n问题陈述已经过评估，被认为是有效的。\n- **已知条件:**\n    - 方法：使用六个 Boresch 类型约束（$r, \\theta_A, \\theta_B, \\phi_A, \\phi_B, \\chi$）的炼金术双解耦。\n    - 约束势：$U_x = \\tfrac{1}{2} k_x (x - x_0)^2$。\n    - 温度：$T = 300\\,\\mathrm{K}$。\n    - 方案：约束在所有炼金术状态中保持不变；应用解析校正。\n    - 测量的束缚态涨落（在全耦合时）：$\\sigma_r^\\ast = 0.10\\,\\mathrm{nm}$，$\\sigma_{\\theta_{A,B}}^\\ast \\approx \\sigma_{\\phi_{A,B}}^\\ast = 0.17\\,\\mathrm{rad}$，$\\sigma_{\\chi}^\\ast = 0.35\\,\\mathrm{rad}$。\n- **验证结论：**该问题具有科学依据，提问得当，客观且完整。它描述了计算生物物理学中一个标准且重要的方法学挑战。所提供的数据是现实的，足以制定出有原则的解决方案。\n\n**2. 理论推导**\n\n问题的核心在于两个极限之间的权衡，这两个极限连接了全耦合状态（配体与蛋白质相互作用，$\\lambda=1$）和完全解耦状态（配体-蛋白质相互作用关闭，$\\lambda=0$）。在所有状态中都存在约束。\n\n两个状态 A 和 B 之间的亥姆霍兹自由能差由 $\\Delta A_{A \\to B} = -k_B T \\ln \\frac{Q_B}{Q_A}$ 给出，其中 $Q$ 是正则配分函数。对于炼金术变换，这通常通过使用热力学积分 (TI) 或贝内特接受率 (BAR) 等估计器，计算一系列中间状态 $\\lambda_i$ 的自由能变化来完成。这些估计器的效率和准确性关键取决于相邻状态之间构象系综的统计重叠，即 $P(\\mathbf{q}|\\lambda_i)$ 和 $P(\\mathbf{q}|\\lambda_{i+1})$。\n\n让我们考虑配体的构象分布。\n- 在全耦合状态下（$\\lambda=1$），除了施加的约束外，配体的位置和方向还受到蛋白质结合位点势能面的限制。问题提供了在此状态下约束坐标的标准差 $\\sigma_x^\\ast$。\n- 在完全解耦状态下（$\\lambda=0$），配体与其环境之间的非键相互作用被关闭。*唯一*将配体局域化的势能项是六个谐波约束势的总和，$U_{restr} = \\sum_x \\tfrac{1}{2} k_x (x - x_0)^2$。\n\n对于解耦状态（$\\lambda=0$），假设约束坐标近似独立，单个坐标 $x$ 的概率分布由玻尔兹曼分布给出，$P(x) \\propto e^{-U_x / (k_B T)} = e^{-k_x (x-x_0)^2 / (2 k_B T)}$。这是一个均值为 $x_0$，方差为 $\\sigma_x^2$ 的高斯分布。高斯分布 $P(x) \\propto e^{-(x-\\mu)^2/(2\\sigma^2)}$ 的方差是 $\\sigma^2$。通过比较，我们发现 $\\sigma_x^2 = k_B T / k_x$。这也可以从能量均分定理推导出来，该定理指出对于一个二次自由度，平均势能为 $\\langle \\tfrac{1}{2}k_x(x-x_0)^2 \\rangle = \\tfrac{1}{2} k_B T$。由于 $\\langle (x-x_0)^2 \\rangle = \\sigma_x^2$，这导致 $\\tfrac{1}{2}k_x \\sigma_x^2 = \\tfrac{1}{2} k_B T$，即 $\\sigma_x^2 = k_B T / k_x$。\n\n在整个炼金术路径上实现良好采样的关键是确保构象系综的体积和位置在相邻的 $\\lambda$ 状态之间不会发生剧烈变化。最具挑战性的转变通常发生在 $\\lambda = 0$ 附近，此时弱的蛋白质-配体相互作用开始发挥作用。一个稳健的策略是使完全解耦的配体（$\\lambda=0$）的构象系综尽可能与完全结合的配体（$\\lambda=1$）的系综相似。这意味着要匹配涨落的宽度。我们应该选择力常数 $k_x$，使得它们在解耦状态下引起的方差 $\\sigma_x^2 = k_B T/k_x$ 与在束缚状态下观察到的方差 $(\\sigma_x^\\ast)^2$ 相匹配。\n\n因此，最优策略是设置 $k_x = k_B T / (\\sigma_x^\\ast)^2$。然后，这些力常数在从 $\\lambda=0$ 到 $\\lambda=1$ 的所有炼金术状态中保持固定。这些固定约束的自由能贡献随后通过标准的解析校正被移除。\n\n让我们使用 $T = 300\\,\\mathrm{K}$ 和 $k_B T \\approx (8.314 \\mathrm{J \\cdot mol^{-1} \\cdot K^{-1}} / 1000) \\times 300 K \\approx 2.494\\,\\mathrm{kJ\\,mol^{-1}}$ 来计算建议的力常数。\n\n- 对于距离约束：\n$k_r = \\frac{k_B T}{(\\sigma_r^\\ast)^2} = \\frac{2.494\\,\\mathrm{kJ\\,mol^{-1}}}{(0.10\\,\\mathrm{nm})^2} = \\frac{2.494}{0.01}\\,\\mathrm{kJ\\,mol^{-1}\\,nm^{-2}} = 249.4\\,\\mathrm{kJ\\,mol^{-1}\\,nm^{-2}} \\approx 2.5 \\times 10^2\\,\\mathrm{kJ\\,mol^{-1}\\,nm^{-2}}$。\n\n- 对于角度约束 $\\theta_{A,B}$ 和 $\\phi_{A,B}$：\n$k_{\\theta, \\phi} = \\frac{k_B T}{(\\sigma_{\\theta, \\phi}^\\ast)^2} = \\frac{2.494\\,\\mathrm{kJ\\,mol^{-1}}}{(0.17\\,\\mathrm{rad})^2} = \\frac{2.494}{0.0289}\\,\\mathrm{kJ\\,mol^{-1}\\,rad^{-2}} \\approx 86.3\\,\\mathrm{kJ\\,mol^{-1}\\,rad^{-2}} \\approx 8.6 \\times 10^1\\,\\mathrm{kJ\\,mol^{-1}\\,rad^{-2}}$。\n\n- 对于二面角约束 $\\chi$：\n$k_{\\chi} = \\frac{k_B T}{(\\sigma_{\\chi}^\\ast)^2} = \\frac{2.494\\,\\mathrm{kJ\\,mol^{-1}}}{(0.35\\,\\mathrm{rad})^2} = \\frac{2.494}{0.1225}\\,\\mathrm{kJ\\,mol^{-1}\\,rad^{-2}} \\approx 20.4\\,\\mathrm{kJ\\,mol^{-1}\\,rad^{-2}} \\approx 2.0 \\times 10^1\\,\\mathrm{kJ\\,mol^{-1}\\,rad^{-2}}$。\n\n这些计算值与选项A中给出的值精确匹配。\n\n**3. 逐项分析**\n\n**A. 选择 $k_x$ 使得解耦极限下约束坐标的热宽度与测量的束缚态宽度相匹配。...这大约得到 $k_r \\approx 2.5 \\times 10^2\\,\\mathrm{kJ\\,mol^{-1}\\,nm^{-2}}$，... 使用足够小的时间步长来解析最快的约束模式，并包含标准的解析约束校正，无需额外项。**\n\n这个选项描述了上面推导出的最优策略。通过将解耦配体的位置涨落与束缚配体的涨落相匹配，它确保了在 $\\lambda=0$ 时探索的相空间体积能够代表与束缚态相关的体积。这增强了整个炼金术路径上，特别是在非相互作用端点附近的相空间重叠，从而提高了收敛性和效率。力常数的计算是正确的。关于保持 $k_x$ 不变、验证重叠、使用适当的时间步长（因为强约束会引入快速运动）以及应用标准解析校正等附加点，都是方法学上合理方案的标志。\n\n结论：**正确**。\n\n**B. 使约束极度刚硬以防止配体在解耦状态下有任何运动，例如，设置 $k_r \\gtrsim 5.0 \\times 10^3\\,\\mathrm{kJ\\,mol^{-1}\\,nm^{-2}}$ 以及所有角度坐标的 $k \\gtrsim 1.0 \\times 10^3\\,\\mathrm{kJ\\,mol^{-1}\\,rad^{-2}}$，并在所有炼金术状态中保持它们不变。这保证了局域化，最大化了重叠，并且由于包含了分析校正，因此不会引入偏差。**\n\n这个策略是有缺陷的。虽然非常刚硬的约束确实能保证在 $\\lambda=0$ 时的局域化，但它们并不能“最大化重叠”。在 $\\lambda=0$ 时的系综变成了一个围绕参考几何构型 $\\{x_0\\}$ 的非常尖锐的类 delta 分布。而在 $\\lambda=1$ 时的系综则局域化在一个由复杂的蛋白质-配体势能面决定的最小值附近，这个最小值不会与 $\\{x_0\\}$ 完全重合。当炼金术参数 $\\lambda$ 从 0 增加时，这种不匹配会产生巨大的能量惩罚（从而产生巨大的自由能变化），导致相邻状态的势能分布之间出现显著的间隙。这种“势能间隙”导致极差的相空间重叠，从而导致非常高的方差和缓慢的自由能估计收敛。在有限的模拟中，这将表现为偏差。此外，刚硬的约束需要非常小的时间步长，增加了计算成本。\n\n结论：**不正确**。\n\n**C. 使约束非常弱以最大化解耦和耦合状态之间的相空间重叠，例如，设置 $k_r \\lesssim 1.0 \\times 10^1\\,\\mathrm{kJ\\,mol^{-1}\\,nm^{-2}}$ 以及所有角度坐标的 $k \\lesssim 2.0 \\times 10^0\\,\\mathrm{kJ\\,mol^{-1}\\,rad^{-2}}$。这允许解耦的配体进行广泛探索，减少了相关时间，并确保解析约束校正能够解释额外的熵而不会产生不利后果。**\n\n这个策略同样有缺陷，且原因与选项 B 相反。在双解耦计算中使用约束的全部目的，是防止 $\\lambda=0$ 时的配体探索广阔且无关的相空间体积。非常弱的约束将允许配体扩散到一个很大的区域，在 $\\lambda=0$ 时产生一个非常宽的构象分布。而相邻状态（例如 $\\lambda=0.05$ 或 $\\lambda=0.1$）中，配体开始感受到结合位点的吸引力，其分布会更加局域化。一个非常宽的分布和一个窄的分布之间的重叠很差。这导致了与约束本应解决的问题相同的问题，即高方差和差的收敛性。声称这能“最大化相空间重叠”是错误的。\n\n结论：**不正确**。\n\n**D. 随炼金术耦合参数改变约束强度，将 $k_x(\\lambda)$ 从 $\\lambda=0$ (完全解耦) 时的 $k_x(0)=0$ 线性缩放到 $\\lambda=1$ (完全耦合) 时的大 $k_x(1)$，同时保留为固定 $k_x$ 推导出的标准解析约束校正；这消除了在解耦状态下的重叠问题，并避免了任何额外的校正，因为最终和初始状态没有改变。**\n\n这个选项引入了一个系统误差（偏差）。炼金术变换的自由能是通过热力学积分计算的，即 $\\Delta A = \\int_0^1 \\langle \\partial H / \\partial \\lambda \\rangle_\\lambda d\\lambda$。如果约束力常数依赖于 $\\lambda$，即 $k_x(\\lambda)$，那么哈密顿量就有一个额外的 $\\lambda$ 依赖性：$H(\\lambda) = H_{alchemical}(\\lambda) + U_{restr}(\\lambda)$。导数变为 $\\partial H / \\partial \\lambda = \\partial H_{alchemical} / \\partial \\lambda + \\partial U_{restr} / \\partial \\lambda$。标准的自由能计算只考虑了第一项。第二项 $\\partial U_{restr} / \\partial \\lambda = \\sum_x \\tfrac{1}{2} (x-x_0)^2 (\\partial k_x / \\partial \\lambda)$，代表了改变约束刚度所做的功。忽略这一项意味着计算出的 $\\Delta A$ 是不正确的。断言为固定 $k_x$ 推导出的标准解析校正是足够的，这是错误的。该方案测量的是同时开启配体-蛋白质相互作用并加强约束的自由能，然后错误地减去了仅针对最终约束的自由能。\n\n结论：**不正确**。", "answer": "$$\\boxed{A}$$", "id": "3414359"}]}