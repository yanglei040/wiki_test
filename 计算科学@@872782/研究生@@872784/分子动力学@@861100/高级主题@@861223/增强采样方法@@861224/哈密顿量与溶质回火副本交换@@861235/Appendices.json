{"hands_on_practices": [{"introduction": "要掌握溶质回火副本交换（REST），首要任务是理解其核心机制：如何修改哈密顿量以选择性地“加热”溶质。这个练习将引导你验证一个标准的REST实现（称为REST2）中能量项的正确标度关系[@problem_id:3414963]。通过思考如何检查代码的正确性，你将深入理解溶质-溶质、溶质-溶剂以及溶剂-溶剂相互作用项为何要以不同的方式处理，这是正确应用此方法的基础。", "problem": "考虑溶质回火的哈密顿量副本交换（Hamiltonian Replica Exchange with Solute Tempering, REST），其中分子系统被划分为溶质子集 $S$ 和溶剂子集 $W$。构型 $\\mathbf{x}$ 的经典势能分解为 $U(\\mathbf{x}) = U_{SS}(\\mathbf{x}) + U_{SW}(\\mathbf{x}) + U_{WW}(\\mathbf{x})$，其中 $U_{SS}$ 包含溶质内部的相互作用，$U_{SW}$ 包含溶质与溶剂之间的相互作用，$U_{WW}$ 包含溶剂内部的相互作用。在REST中，每个副本 $i$ 使用一个由标度参数 $\\lambda_i \\in (0,1]$ 参数化的修正哈密顿量 $U_i(\\mathbf{x})$，其设计目的是使溶剂保持在物理温度 $T$ 下，而只有溶质经历有效回火。在正则系综中，副本 $i$ 对于构型 $\\mathbf{x}$ 的系综权重与 $\\exp(-\\beta U_i(\\mathbf{x}))$ 成正比，其中逆温度 $\\beta = 1/(k_{\\mathrm{B}} T)$，$k_{\\mathrm{B}}$ 是玻尔兹曼常数。副本 $i$ 和 $j$ 之间的副本交换移动必须在正则测量下满足细致平衡。\n\n您的任务是指定实际的实现检查，以验证REST代码正确地在副本之间对能量进行了分层。这些检查必须基于评估在所有副本中保持不变的单个固定构型 $\\mathbf{x}$，将 $U_i(\\mathbf{x})$ 中归因于 $U_{SS}(\\mathbf{x})$、$U_{SW}(\\mathbf{x})$ 和 $U_{WW}(\\mathbf{x})$ 的分量作为 $\\lambda_i$ 的函数进行评估。目标是确认溶剂保持未回火状态，而仅溶质和溶质-溶剂相互作用的标度方式与溶质回火以及Metropolis交换的细致平衡相一致。\n\n下列哪组实现检查对于REST溶质回火是正确的？\n\nA. 对于每个副本 $i$ 和任何固定的 $\\mathbf{x}$，验证 $U_{WW}^{(i)}(\\mathbf{x}) = U_{WW}(\\mathbf{x})$（与 $i$ 无关），$U_{SS}^{(i)}(\\mathbf{x}) = \\lambda_i\\, U_{SS}(\\mathbf{x})$，以及 $U_{SW}^{(i)}(\\mathbf{x}) = \\sqrt{\\lambda_i}\\, U_{SW}(\\mathbf{x})$。此外，验证在相同 $\\mathbf{x}$ 下，副本 $i$ 和 $j$ 之间的能量差满足 $U_j(\\mathbf{x}) - U_i(\\mathbf{x}) = (\\lambda_j - \\lambda_i)\\, U_{SS}(\\mathbf{x}) + \\big(\\sqrt{\\lambda_j} - \\sqrt{\\lambda_i}\\big)\\, U_{SW}(\\mathbf{x})$，并且在由这些分量构成的任何副本交换Metropolis指数中，溶剂-溶剂项会抵消。\n\nB. 对于每个副本 $i$ 和任何固定的 $\\mathbf{x}$，验证 $U_{SS}^{(i)}(\\mathbf{x}) = U_{SS}(\\mathbf{x})$（与 $i$ 无关），$U_{WW}^{(i)}(\\mathbf{x}) = \\lambda_i\\, U_{WW}(\\mathbf{x})$，以及 $U_{SW}^{(i)}(\\mathbf{x}) = \\lambda_i\\, U_{SW}(\\mathbf{x})$，这反映了加热溶剂驱动交换而保持溶质不变的思想。\n\nC. 对于每个副本 $i$ 和任何固定的 $\\mathbf{x}$，验证均匀标度 $U_i(\\mathbf{x}) = \\lambda_i\\, U(\\mathbf{x})$，以便整个哈密顿量被一致地回火，并且对于副本 $i$ 和 $j$，Metropolis交换指数仅取决于 $(\\lambda_j - \\lambda_i)\\, U(\\mathbf{x})$。\n\nD. 对于每个副本 $i$ 和任何固定的 $\\mathbf{x}$，验证 $U_{WW}^{(i)}(\\mathbf{x}) = U_{WW}(\\mathbf{x})$，$U_{SS}^{(i)}(\\mathbf{x}) = \\lambda_i^2\\, U_{SS}(\\mathbf{x})$，以及 $U_{SW}^{(i)}(\\mathbf{x}) = \\lambda_i\\, U_{SW}(\\mathbf{x})$，理由是溶质-溶质项应包含两个溶质标度因子，而溶质-溶剂项应包含一个因子。\n\nE. 对于每个副本 $i$ 和任何固定的 $\\mathbf{x}$，验证所有势能分量都是不变的，$U_i(\\mathbf{x}) = U(\\mathbf{x})$，而是仅通过标度溶质原子的动能来实现回火，从而只有溶质被有效加热，而溶剂动能保持在温度 $T$。", "solution": "### 问题验证\n\n第一步是严格验证问题陈述。\n\n#### 步骤1：提取已知条件\n\n问题提供了以下信息和定义：\n- **方法**：溶质回火的哈密顿量副本交换（Hamiltonian Replica Exchange with Solute Tempering, REST）。\n- **系统划分**：一个分子系统被分为一个溶质子集 $S$ 和一个溶剂子集 $W$。\n- **势能分解**：构型 $\\mathbf{x}$ 的总势能为 $U(\\mathbf{x}) = U_{SS}(\\mathbf{x}) + U_{SW}(\\mathbf{x}) + U_{WW}(\\mathbf{x})$。\n    - $U_{SS}$：溶质内部的相互作用。\n    - $U_{SW}$：溶质与溶剂之间的相互作用。\n    - $U_{WW}$：溶剂内部的相互作用。\n- **副本哈密顿量**：每个副本 $i$ 使用一个由标度因子 $\\lambda_i \\in (0,1]$ 参数化的修正哈密顿量 $U_i(\\mathbf{x})$。\n- **回火目标**：溶剂保持在物理温度 $T$，而只有溶质经历有效回火。\n- **系综权重**：副本 $i$ 的权重与 $\\exp(-\\beta U_i(\\mathbf{x}))$ 成正比，其中逆温度 $\\beta = 1/(k_{\\mathrm{B}} T)$。\n- **细致平衡**：副本 $i$ 和 $j$ 之间的副本交换移动必须满足细致平衡。\n- **任务**：基于单个固定构型 $\\mathbf{x}$，作为 $\\lambda_i$ 的函数，为 $U_i(\\mathbf{x})$ 的分量指定实现检查。这些检查必须确认标度与溶质回火原理和副本交换的细致平衡相一致。\n\n#### 步骤2：使用提取的已知条件进行验证\n\n- **科学依据**：该问题牢固地植根于统计力学和计算化学的原理。溶质回火的哈密顿量副本交换（REST）是分子动力学模拟中一种成熟且广泛使用的增强采样技术。势能的分解和修正哈密顿量的使用是该方法的核心。\n- **提法明确**：问题提法明确。它要求找出修正势能 $U_i(\\mathbf{x})$ 的正确函数形式，以实现所述的物理目标（溶质回火）。鉴于哈密顿量副本交换的原理，存在一个特定的、可推导的 $U_i(\\mathbf{x})$ 形式，可用于评估所提供的选项。\n- **客观性**：问题使用了分子模拟领域中精确、客观和标准的术语来陈述。它没有歧义或主观论断。\n- **完整性与一致性**：问题提供了推导REST哈密顿量正确形式所需的所有必要信息。约束条件——溶剂保持在温度 $T$ 而溶质被回火，且交换遵循细致平衡——足以推导出所需的能量标度关系。\n\n#### 步骤3：结论与行动\n\n问题陈述是**有效的**。这是一个关于高级分子模拟中标准方法的正确且表述良好的问题。因此，我将继续推导解答并评估选项。\n\n### 解答推导\n\n溶质回火的哈密顿量副本交换（REST）的目标是通过有效地“加热”溶质来加速其构象空间的采样，而不加热溶剂。在哈密顿量副本交换的背景下，这不是通过改变动理学温度来实现的，而是通过为每个副本 $i$ 修改势能函数 $U(\\mathbf{x})$ 来实现的。\n\n在逆温度 $\\beta = 1/(k_{\\mathrm{B}}T)$ 下，构型 $\\mathbf{x}$ 的正则概率分布为 $P(\\mathbf{x}) \\propto \\exp(-\\beta U(\\mathbf{x}))$。在H-REMD中，每个副本 $i$ 从一个分布 $P_i(\\mathbf{x}) \\propto \\exp(-\\beta U_i(\\mathbf{x}))$ 中采样，其中 $U_i(\\mathbf{x})$ 是修正后的势能。\n\n让我们将副本 $i$ 中溶质的有效温度定义为 $T_i = T/\\lambda_i$，其中 $\\lambda_i \\in (0,1]$ 是标度参数。参考副本的 $\\lambda=1$，对应于温度 $T$ 下的物理系统。较小的 $\\lambda_i$ 对应于较高的有效溶质温度。溶质的有效逆温度为 $\\beta_i = 1/(k_{\\mathrm{B}}T_i) = \\lambda_i / (k_{\\mathrm{B}}T) = \\lambda_i \\beta$。\n\n为实现这种有效回火，势能中涉及溶质的项必须相应地进行标度。让我们分析修正势能 $U_i(\\mathbf{x}) = U_{SS}^{(i)}(\\mathbf{x}) + U_{SW}^{(i)}(\\mathbf{x}) + U_{WW}^{(i)}(\\mathbf{x})$ 的分量：\n\n1.  **溶剂-溶剂项（$U_{WW}$）**：问题陈述溶剂保持在物理温度 $T$。这意味着它对玻尔兹曼权重的贡献应为 $\\exp(-\\beta U_{WW}(\\mathbf{x}))$。为了在 $\\exp(-\\beta U_i(\\mathbf{x}))$ 的框架内实现这一点，修正哈密顿量中的溶剂-溶剂势能分量必须不被标度。\n    $$U_{WW}^{(i)}(\\mathbf{x}) = U_{WW}(\\mathbf{x})$$\n\n2.  **溶质-溶质项（$U_{SS}$）**：溶质要在有效逆温度 $\\beta_i = \\lambda_i \\beta$ 下进行回火。它对玻尔兹曼权重的贡献应为 $\\exp(-\\beta_i U_{SS}(\\mathbf{x})) = \\exp(-\\lambda_i \\beta U_{SS}(\\mathbf{x}))$。这要求修正哈密顿量中的溶质-溶质项按 $\\lambda_i$ 进行标度。\n    $$U_{SS}^{(i)}(\\mathbf{x}) = \\lambda_i U_{SS}(\\mathbf{x})$$\n\n3.  **溶质-溶剂项（$U_{SW}$）**：该项涉及“热”溶质与“冷”溶剂之间的相互作用。一个物理上和计算上合理的标度方式源于考虑底层的力场参数。许多相互作用势（例如，库仑、Lennard-Jones）都是由对项构成的，其中相互作用强度取决于两个粒子的参数。如果想象将所有溶质原子的“类电荷”参数按因子 $\\sqrt{\\lambda_i}$ 进行标度，那么：\n    -   两个溶质原子之间的相互作用（$SS$）将被标度为 $(\\sqrt{\\lambda_i}) \\times (\\sqrt{\\lambda_i}) = \\lambda_i$。这与我们对 $U_{SS}$ 的发现一致。\n    -   一个溶质原子和一个溶剂原子之间的相互作用（$SW$）将被标度为 $(\\sqrt{\\lambda_i}) \\times \\sqrt{1} = \\sqrt{\\lambda_i}$。\n    -   两个溶剂原子之间的相互作用（$WW$）将被标度为 $\\sqrt{1} \\times \\sqrt{1} = 1$。这与我们对 $U_{WW}$ 的发现一致。\n    这导致溶质-溶剂项的标度如下：\n    $$U_{SW}^{(i)}(\\mathbf{x}) = \\sqrt{\\lambda_i} U_{SW}(\\mathbf{x})$$\n\n这种表述被称为REST2，是溶质回火概念的一个标准、稳健的实现。\n\n结合这些分量，副本 $i$ 的总修正势能为：\n$$U_i(\\mathbf{x}) = \\lambda_i U_{SS}(\\mathbf{x}) + \\sqrt{\\lambda_i} U_{SW}(\\mathbf{x}) + U_{WW}(\\mathbf{x})$$\n\n现在，考虑副本 $i$ 和副本 $j$ 之间交换尝试的细致平衡条件。Metropolis接受准则涉及能量差项 $\\Delta = \\beta [ U_i(\\mathbf{x}_j) - U_i(\\mathbf{x}_i) + U_j(\\mathbf{x}_i) - U_j(\\mathbf{x}_j) ]$。其中的一个关键部分是单个构型 $\\mathbf{x}$ 的势能函数之差，这正是问题要求检查的。让我们计算这个差值：\n$$ \\Delta U(\\mathbf{x}) = U_j(\\mathbf{x}) - U_i(\\mathbf{x}) $$\n$$ \\Delta U(\\mathbf{x}) = \\left( \\lambda_j U_{SS}(\\mathbf{x}) + \\sqrt{\\lambda_j} U_{SW}(\\mathbf{x}) + U_{WW}(\\mathbf{x}) \\right) - \\left( \\lambda_i U_{SS}(\\mathbf{x}) + \\sqrt{\\lambda_i} U_{SW}(\\mathbf{x}) + U_{WW}(\\mathbf{x}) \\right) $$\n$$ \\Delta U(\\mathbf{x}) = (\\lambda_j - \\lambda_i) U_{SS}(\\mathbf{x}) + (\\sqrt{\\lambda_j} - \\sqrt{\\lambda_i}) U_{SW}(\\mathbf{x}) $$\n正如所要求的那样，$U_{WW}(\\mathbf{x})$ 项（通常是势能中最大且计算最昂贵的部分）从差值中抵消了。这种抵消是副本交换计算效率的关键特征。\n\n### 逐项分析\n\n基于上述推导，我们可以评估每个选项。\n\n**A. 对于每个副本 $i$ 和任何固定的 $\\mathbf{x}$，验证 $U_{WW}^{(i)}(\\mathbf{x}) = U_{WW}(\\mathbf{x})$（与 $i$ 无关），$U_{SS}^{(i)}(\\mathbf{x}) = \\lambda_i\\, U_{SS}(\\mathbf{x})$，以及 $U_{SW}^{(i)}(\\mathbf{x}) = \\sqrt{\\lambda_i}\\, U_{SW}(\\mathbf{x})$。此外，验证在相同 $\\mathbf{x}$ 下，副本 $i$ 和 $j$ 之间的能量差满足 $U_j(\\mathbf{x}) - U_i(\\mathbf{x}) = (\\lambda_j - \\lambda_i)\\, U_{SS}(\\mathbf{x}) + \\big(\\sqrt{\\lambda_j} - \\sqrt{\\lambda_i}\\big)\\, U_{SW}(\\mathbf{x})$，并且在由这些分量构成的任何副本交换Metropolis指数中，溶剂-溶剂项会抵消。**\n\n此选项精确匹配推导出的REST2表述。\n-   $U_{WW}$ 未被标度，保持溶剂“冷”。\n-   $U_{SS}$ 按 $\\lambda_i$ 标度，正确地回火溶质。\n-   $U_{SW}$ 按 $\\sqrt{\\lambda_i}$ 标度，与标度基本力场参数一致。\n-   能量差 $U_j(\\mathbf{x}) - U_i(\\mathbf{x})$ 的表达式是分量标度的直接且正确的代数推论。\n-   正确地指出了 $U_{WW}$ 项的抵消。\n这组检查是对标准REST实现的完整且正确的验证。\n**结论：正确。**\n\n**B. 对于每个副本 $i$ 和任何固定的 $\\mathbf{x}$，验证 $U_{SS}^{(i)}(\\mathbf{x}) = U_{SS}(\\mathbf{x})$（与 $i$ 无关），$U_{WW}^{(i)}(\\mathbf{x}) = \\lambda_i\\, U_{WW}(\\mathbf{x})$，以及 $U_{SW}^{(i)}(\\mathbf{x}) = \\lambda_i\\, U_{SW}(\\mathbf{x})$，这反映了加热溶剂驱动交换而保持溶质不变的思想。**\n\n此选项描述的是溶剂的回火，而不是溶质。$U_{SS}$ 未被标度，而 $U_{WW}$ 按 $\\lambda_i$ 标度。这与REST的既定目标（溶质回火）相反。\n**结论：不正确。**\n\n**C. 对于每个副本 $i$ 和任何固定的 $\\mathbf{x}$，验证均匀标度 $U_i(\\mathbf{x}) = \\lambda_i\\, U(\\mathbf{x})$，以便整个哈密顿量被一致地回火，并且对于副本 $i$ 和 $j$，Metropolis交换指数仅取决于 $(\\lambda_j - \\lambda_i)\\, U(\\mathbf{x})$。**\n\n这描述的是标准温度副本交换（T-REMD或并行回火），而不是针对子系统的哈密顿量副本交换。在T-REMD中，整个系统在不同温度下进行模拟。在哈密顿量交换框架下（在恒定温度 $T$），这等同于将整个势能 $U(\\mathbf{x})$ 按 $\\lambda_i = T/T_i$ 进行标度。这不能实现选择性的溶质回火。\n**结论：不正确。**\n\n**D. 对于每个副本 $i$ 和任何固定的 $\\mathbf{x}$，验证 $U_{WW}^{(i)}(\\mathbf{x}) = U_{WW}(\\mathbf{x})$，$U_{SS}^{(i)}(\\mathbf{x}) = \\lambda_i^2\\, U_{SS}(\\mathbf{x})$，以及 $U_{SW}^{(i)}(\\mathbf{x}) = \\lambda_i\\, U_{SW}(\\mathbf{x})$，理由是溶质-溶质项应包含两个溶质标度因子，而溶质-溶剂项应包含一个因子。**\n\n此选项使用了不正确的标度指数。势能项的标度必须是 $\\lambda_i$ 的线性函数，才能对应于 $\\lambda_i \\beta$ 的有效逆温度。$U_{SS}$ 的 $\\lambda_i^2$ 标度与所需的有效温度没有直接的物理对应关系，也不是标准做法。\n**结论：不正确。**\n\n**E. 对于每个副本 $i$ 和任何固定的 $\\mathbf{x}$，验证所有势能分量都是不变的，$U_i(\\mathbf{x}) = U(\\mathbf{x})$，而是仅通过标度溶质原子的动能来实现回火，从而只有溶质被有效加热，而溶剂动能保持在温度 $T$。**\n\n此选项从根本上误解了哈密顿量副本交换的机制。H-REMD通过修改哈密顿量的*势能*部分来工作。整个系统耦合到单个恒温器，处于单一的动理学温度 $T$。溶质的“有效温度”是其所探索的修正势能面的结果，这有助于跨越能垒，而不是其真实动能分布的改变。所描述的方法是一种完全不同（且难以实现）的非平衡方法，而不是REST。\n**结论：不正确。**", "answer": "$$\\boxed{A}$$", "id": "3414963"}, {"introduction": "在理解了REST2的基本标度法则之后，下一步是在真实的分子动力学模拟中应用它，例如模拟一个溶剂化的生物分子。这类系统不仅包含非键相互作用，还包含定义分子几何构型的共价键、键角、二面角以及用于维持特定键长或键角的约束。本练习探讨如何在应用REST标度的同时，正确处理这些额外的能量项和约束，以确保我们只加速构象采样，而不扭曲分子自身的化学结构[@problem_id:3415019]。", "problem": "考虑一个通过分子动力学 (MD) 在固定基准温度 $T_0$（其逆热能为 $\\beta_0 = 1/(k_\\mathrm{B} T_0)$，其中 $k_\\mathrm{B}$ 是玻尔兹曼常数）下模拟的溶剂化生物分子系统。坐标被划分为溶质坐标 $q_\\mathrm{S}$ 和溶剂坐标 $q_\\mathrm{W}$。通过一个约束流形 $\\{q: g_k(q_\\mathrm{S}) = 0\\}$，使用诸如SHAKE的拉格朗日乘子算法，对溶质内坐标的一个子集施加完整约束（例如，固定键长）。系统的势能被加性分解为\n$$\nU(q) = U_{\\mathrm{SS}}(q_\\mathrm{S}) + U_{\\mathrm{SW}}(q_\\mathrm{S}, q_\\mathrm{W}) + U_{\\mathrm{WW}}(q_\\mathrm{W}) + U_{\\mathrm{bond}}(q_\\mathrm{S}),\n$$\n其中 $U_{\\mathrm{SS}}$ 集合了溶质-溶质非键项（包括分子内 $1\\text{-}4$ Lennard-Jones 和库仑相互作用），$U_{\\mathrm{SW}}$ 集合了溶质-溶剂非键项，$U_{\\mathrm{WW}}$ 是溶剂-溶剂非键项，而 $U_{\\mathrm{bond}}$ 集合了与未被约束消除的柔性自由度相对应的溶质键合项（键伸缩、键角和二面角）。\n\n在哈密顿量副本交换 (HREX) 中，人们构建一个具有修改后哈密顿量 $\\{H_m\\}$ 的副本阶梯，所有副本都耦合到相同的 $T_0$ 恒温器上，并使用一个 Metropolis 准则在副本之间交换构型，该准则强制执行相对于它们正则分布乘积的细致平衡。在溶质回火副本交换 (REST$2$) 中，目标是通过缩放哈密顿量中的相互作用项，而不是改变每个副本的物理温度，来提高溶质的有效温度，同时使溶剂保持在 $T_0$。缩放必须设计成：\n- 溶剂-溶剂系综保持在 $T_0$。\n- 溶质-溶质和溶质-溶剂的能量权重模拟了增加的溶质有效温度，同时在投影回 $T_0$ 系综时保持正确的统计特性。\n- 完整约束和任何受约束键长的分布不因缩放而改变。\n- 与内几何相关的键合项不会获得虚假的温度依赖性，以免扭曲 $T_0$ 下的平衡分布。\n\n假设非键对相互作用（库仑和 Lennard-Jones）在“溶质参数”（例如，部分电荷、Lennard-Jones 势阱深度）中是双线性的，因此将溶质参数缩放因子 $s_m$ 会导致 $U_{\\mathrm{SS}}$ 的二次方缩放和 $U_{\\mathrm{SW}}$ 的线性缩放，而保持 $U_{\\mathrm{WW}}$ 不变。设 $\\lambda_m \\in (0, 1]$ 表示每个副本 $m$ 的无量纲缩放参数，它编码了溶质相互作用相对于 $\\beta_0$ 的期望有效弱化。\n\n下面哪个选项正确地指定了 REST$2$ 缩放方案以及在副本 $m$ 和 $n$ 之间交换构型时的相关 Metropolis 交换接受因子，同时保持约束力不被缩放并避免改变键长分布？选择唯一的最佳答案。\n\nA. 将缩放后的势能定义为\n$$\nU_m(q) = \\lambda_m\\big[U_{\\mathrm{SS}}(q_\\mathrm{S}) + U_{\\mathrm{SW}}(q_\\mathrm{S}, q_\\mathrm{W}) + U_{\\mathrm{WW}}(q_\\mathrm{W}) + U_{\\mathrm{bond}}(q_\\mathrm{S})\\big],\n$$\n并将所有约束拉格朗日乘子缩放 $\\lambda_m$。使用接受因子\n$$\nP_{\\mathrm{acc}} = \\min\\left(1, \\exp\\left[-\\beta_0\\big(U_m(q^{(n)}) + U_n(q^{(m)}) - U_m(q^{(m)}) - U_n(q^{(n)})\\big)\\right]\\right).\n$$\n\nB. 将缩放后的势能定义为\n$$\nU_m(q) = \\lambda_m\\,U_{\\mathrm{SS}}(q_\\mathrm{S}) + \\sqrt{\\lambda_m}\\,U_{\\mathrm{SW}}(q_\\mathrm{S}, q_\\mathrm{W}) + U_{\\mathrm{WW}}(q_\\mathrm{W}) + U_{\\mathrm{bond}}(q_\\mathrm{S}),\n$$\n其中 $U_{\\mathrm{SS}}$ 包括分子内 $1\\text{-}4$ 非键项，并保持 SHAKE 约束力和所有键合项不被缩放。使用接受因子\n$$\nP_{\\mathrm{acc}} = \\min\\left(1, \\exp\\left[-\\beta_0\\big(U_m(q^{(n)}) + U_n(q^{(m)}) - U_m(q^{(m)}) - U_n(q^{(n)})\\big)\\right]\\right).\n$$\n\nC. 将缩放后的势能定义为\n$$\nU_m(q) = U_{\\mathrm{SS}}(q_\\mathrm{S}) + \\lambda_m\\,U_{\\mathrm{SW}}(q_\\mathrm{S}, q_\\mathrm{W}) + U_{\\mathrm{WW}}(q_\\mathrm{W}) + U_{\\mathrm{bond}}(q_\\mathrm{S}),\n$$\n保持约束和键合项不被缩放。使用接受因子\n$$\nP_{\\mathrm{acc}} = \\min\\left(1, \\exp\\left[-\\beta_0\\big(U_m(q^{(n)}) + U_n(q^{(m)}) - U_m(q^{(m)}) - U_n(q^{(n)})\\big)\\right]\\right).\n$$\n\nD. 将缩放后的势能定义为\n$$\nU_m(q) = U_{\\mathrm{SS}}(q_\\mathrm{S}) + U_{\\mathrm{SW}}(q_\\mathrm{S}, q_\\mathrm{W}) + U_{\\mathrm{WW}}(q_\\mathrm{W}) + \\lambda_m\\,U_{\\mathrm{bond}}(q_\\mathrm{S}),\n$$\n并将 SHAKE 约束力缩放 $\\sqrt{\\lambda_m}$ 以“匹配”键合缩放。使用接受因子\n$$\nP_{\\mathrm{acc}} = \\min\\left(1, \\exp\\left[-\\beta_0\\big(U_m(q^{(n)}) + U_n(q^{(m)}) - U_m(q^{(m)}) - U_n(q^{(n)})\\big)\\right]\\right).\n$$", "solution": "我们从正则系综和哈密顿量副本交换 (HREX) 的构建开始。对于在共同恒温器温度 $T_0$（逆热能 $\\beta_0$）下的副本 $m$，其坐标 $q$ 上的稳态分布为\n$$\n\\pi_m(q) \\propto \\exp\\big[-\\beta_0 U_m(q)\\big],\n$$\n其中 $U_m(q)$ 是特定于副本的缩放势能。在副本 $m$ 和 $n$ 之间交换构型 $q^{(m)}$ 和 $q^{(n)}$ 必须满足相对于乘积分布 $\\pi_m(q^{(m)})\\,\\pi_n(q^{(n)})$ 的细致平衡条件，从而得到 Metropolis 接受因子\n$$\nP_{\\mathrm{acc}} = \\min\\left(1, \\exp\\left[-\\beta_0\\big(U_m(q^{(n)}) + U_n(q^{(m)}) - U_m(q^{(m)}) - U_n(q^{(n)})\\big)\\right]\\right).\n$$\n此表达式仅依赖于缩放后的势能，因为所有副本共享相同的 $T_0$。\n\n接下来，我们需要一个具有物理动机的 REST$2$ 缩放，它能提高溶质相互作用的有效温度，同时使溶剂相互作用保持在 $T_0$。一个有原则的途径是考虑非键能量如何依赖于溶质“相互作用参数”。对于库仑相互作用，原子 $i$ 和 $j$ 之间的能量为\n$$\nU_{ij}^{\\mathrm{Coul}} = \\frac{q_i q_j}{4\\pi\\varepsilon_0 r_{ij}},\n$$\n其中 $q_i$ 和 $q_j$ 是部分电荷，$r_{ij}$ 是它们之间的距离。如果我们将所有溶质电荷缩放因子 $s_m$，那么溶质-溶质项按 $s_m^2$ 缩放（因为两个电荷都属于溶质），而溶质-溶剂项按 $s_m$ 缩放（因为只有一个电荷属于溶质）。如果我们把溶质势阱深度缩放 $s_m$，Lennard-Jones 相互作用也具有类似的双线性结构（因为交叉势阱深度与几何平均值成正比，因此与溶质因子呈线性关系）。因此，通过选择溶质参数缩放 $s_m = \\sqrt{\\lambda_m}$，我们得到了期望的势能缩放\n$$\nU_m(q) = \\lambda_m\\,U_{\\mathrm{SS}}(q_\\mathrm{S}) + \\sqrt{\\lambda_m}\\,U_{\\mathrm{SW}}(q_\\mathrm{S}, q_\\mathrm{W}) + U_{\\mathrm{WW}}(q_\\mathrm{W}) + \\text{(保持不被缩放的项)}.\n$$\n\n完整约束通过拉格朗日乘子 $\\{\\zeta_k\\}$ 来强制执行，满足 $g_k(q_\\mathrm{S}) = 0$ 并且不对 $U(q)$ 贡献显式的势能项。因此，约束力修改了运动方程，但没有修改玻尔兹曼权重 $\\exp[-\\beta_0 U_m(q)]$。缩放约束力或其乘子与系综测度不一致，并可能虚假地扭曲受约束的几何形状或接受统计。正确的处理方法是保持所有副本的约束不变。同样，键合项 $U_{\\mathrm{bond}}(q_\\mathrm{S})$（键伸缩、键角、二面角）编码了局部几何形状，不应通过缩放赋予其人为的温度依赖性；否则，会扭曲 $T_0$ 下内坐标的平衡分布。REST$2$ 的目的是降低由非键堆积和静电主导的能垒，而不是软化共价相互作用。分子内 $1\\text{-}4$ 非键相互作用是溶质-溶质非键能量的一部分，应包含在 $U_{\\mathrm{SS}}$ 中，并因此根据 $\\lambda_m$ 进行缩放。\n\n将这些部分组合起来，得到以下方案：\n- 保持 SHAKE (约束) 力不被缩放，即约束流形 $\\{q: g_k(q_\\mathrm{S}) = 0\\}$ 在所有副本中都是相同的。\n- 保持所有键合项 $U_{\\mathrm{bond}}(q_\\mathrm{S})$ 不被缩放。\n- 将溶质-溶质非键项缩放 $\\lambda_m$。\n- 将溶质-溶剂非键项缩放 $\\sqrt{\\lambda_m}$。\n- 保持溶剂-溶剂项不被缩放。\n- 在共同的 $\\beta_0$ 下使用 HREX Metropolis 接受因子。\n\n我们现在评估每个选项：\n\nA. 该选项将每一项，包括 $U_{\\mathrm{WW}}$ 和 $U_{\\mathrm{bond}}$，都缩放 $\\lambda_m$，并进一步提议缩放约束力。缩放 $U_{\\mathrm{WW}}$ 与隔离溶质有效温度的目标相矛盾，而缩放 $U_{\\mathrm{bond}}$ 会扭曲共价几何统计。缩放约束在概念上是不恰当的，因为约束不进入 $U(q)$ 且不应在副本间修改。接受因子公式本身在结构上是正确的，但缩放后的势能不合适。结论：不正确。\n\nB. 该选项定义 $U_m(q) = \\lambda_m U_{\\mathrm{SS}} + \\sqrt{\\lambda_m} U_{\\mathrm{SW}} + U_{\\mathrm{WW}} + U_{\\mathrm{bond}}$，保持 SHAKE 和键合项不被缩放，并明确地将分子内 $1\\text{-}4$ 非键相互作用包含在 $U_{\\mathrm{SS}}$ 中。这与双线性缩放的基本原理（$s_m=\\sqrt{\\lambda_m}$）相匹配，在 $T_0$ 下保持溶剂不变，避免改变键长分布，并正确地将约束视为非能量项。接受因子是在 $\\beta_0$ 下正确的 HREX Metropolis 形式。结论：正确。\n\nC. 该选项仅将 $U_{\\mathrm{SW}}$ 线性缩放 $\\lambda_m$，而保持 $U_{\\mathrm{SS}}$ 不变。这未能反映溶质-溶质能量对溶质参数缩放的二次方依赖关系，并且与预期的提高溶质有效温度的目标相矛盾。尽管约束和键合项未被缩放，但该缩放模式不是 REST$2$ 的构造。结论：不正确。\n\nD. 该选项将键合项缩放 $\\lambda_m$，并额外将 SHAKE 约束力缩放 $\\sqrt{\\lambda_m}$。这直接违反了避免改变键长分布的要求，并且与约束的非能量角色不一致。它还未缩放非键项，忽略了 REST$2$ 的核心思想。接受因子公式的形式是标准的，但应用于不合适的 $U_m$。结论：不正确。\n\n因此，唯一满足所有标准的选项是 B。", "answer": "$$\\boxed{B}$$", "id": "3415019"}, {"introduction": "我们已经学习了REST方法的原理和实际应用中的注意事项，但这种方法为何能有效增强采样？本练习通过一个简化的“玩具模型”来定量地回答这个问题[@problem_id:3414992]。你将从第一性原理出发，利用克莱默斯速率理论（Kramers' theory）推导出一个构象转变的速率如何依赖于REST的标度参数$\\lambda$。通过这个实践，你将亲眼见证并计算出，对哈密顿量的修改如何直接转化为有效能垒的降低和采样效率的提升。", "problem": "考虑一个玩具分子系统，该系统由一个处于双势阱中的溶质坐标 $x$ 和一个与之线性耦合的谐振溶剂坐标 $y$ 组成。未标度的势能为\n$$\nU(x,y) = a\\left(x^2 - b^2\\right)^2 + \\frac{1}{2} k_y y^2 + c\\,x\\,y,\n$$\n其中参数 $a$、$b$、$k_y$ 为正，耦合常数为 $c$。通过仅缩放溶质-溶剂耦合项 $c \\mapsto \\sqrt{\\lambda}\\,c$ 来实现溶质回火副本交换（REST）效应，其中给定的回火参数 $0 \\le \\lambda \\le 1$，而溶质内部项和溶剂内部项保持不缩放。假设动力学是过阻尼的，并且所有量都以约化的无量纲单位表示（即质量、时间、长度和能量都已无量纲化；不需要进行物理单位转换）。您的任务是，从第一性原理出发，使用 Kramers 理论在高摩擦极限下推导出一个越垒速率 $k(\\lambda)$ 的表达式，然后实现一个程序来评估几组参数集下的 $k(\\lambda)$。\n\n起点和约束条件：\n- 从耦合的溶质和溶剂自由度的哈密顿描述开始，通过绝热消除 $y$（假设溶剂坐标在给定 $x$ 的条件下，处于瞬时热平衡状态），推导出一维有效平均力势 $U_{\\mathrm{eff}}(x;\\lambda)$。\n- 将溶剂建模为在过阻尼区为溶质产生欧姆式（无记忆）摩擦。设总摩擦为 $\\gamma(\\lambda) = \\gamma_0 + \\alpha\\,\\lambda\\,c^2$，其中 $\\gamma_0  0$ 是一个给定的基线溶质摩擦，$\\alpha  0$ 是一个给定的比例常数，它编码了溶剂谱密度。\n- 设溶质质量为 $m  0$，逆热能为 $\\beta  0$。在 Kramers 理论的高摩擦极限下进行研究，并仅使用基本定义和经过充分检验的结果作为基础，推导出速率表达式 $k(\\lambda)$，该表达式依赖于 $U_{\\mathrm{eff}}(x;\\lambda)$ 在势阱最小值和势垒顶部处的曲率、势垒高度 $\\Delta U(\\lambda)$、质量 $m$、摩擦 $\\gamma(\\lambda)$ 和 $\\beta$。\n\n推导要求：\n- 清晰地确定 $U_{\\mathrm{eff}}(x;\\lambda)$ 的驻点和曲率，并用模型参数和 $\\lambda$ 表示势垒高度 $\\Delta U(\\lambda)$ 以及阱底和垒顶的角频率。\n- 根据您的起始假设，使用适当的高摩擦 Kramers 速率常数公式，并说明理由。\n\n数值任务：\n- 实现一个程序，计算下面每组参数集的 $k(\\lambda)$。所有量均为无量纲。将每个速率报告为四舍五入到小数点后八位的小数浮点数。\n\n测试套件（每个元组为 $(a, b, c, k_y, m, \\beta, \\gamma_0, \\alpha, \\lambda)$）：\n1. $(1.0, 1.0, 1.0, 2.0, 1.0, 3.0, 10.0, 0.5, 1.0)$\n2. $(1.0, 1.0, 1.0, 2.0, 1.0, 3.0, 10.0, 0.5, 0.0)$\n3. $(1.0, 1.0, 1.0, 2.0, 1.0, 3.0, 10.0, 0.5, 0.25)$\n4. $(1.0, 1.0, 2.0, 2.0, 1.0, 3.0, 10.0, 0.5, 1.0)$\n5. $(1.0, 1.0, 1.0, 2.0, 1.0, 1.0, 10.0, 0.5, 1.0)$\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，“[result1,result2,result3,result4,result5]”），其中每个结果是按上述顺序列出的相应测试用例的四舍五入速率。", "solution": "该问题陈述被评估为有效，因为它基于统计力学和化学动力学的既定原理，具有完整且一致的定义和参数集，并且表述客观。因此，我们可以继续进行推导和求解。\n\n目标是在 Kramers 理论的高摩擦极限框架内，推导出一维有效势中溶质坐标 $x$ 的越垒速率 $k(\\lambda)$ 的表达式。该过程包括三个主要阶段：首先，通过消除溶剂坐标来推导平均力势（PMF）；其次，分析该 PMF 的特征（驻点、曲率、势垒高度）；最后，将这些特征代入适当的 Kramers 速率公式。\n\n**1. 平均力势（PMF）的推导**\n\n包含溶质回火副本交换（REST）缩放参数 $\\lambda$ 的系统总势能由下式给出：\n$$\nU(x, y; \\lambda) = a(x^2 - b^2)^2 + \\frac{1}{2} k_y y^2 + \\sqrt{\\lambda}cxy\n$$\n其中 $0 \\le \\lambda \\le 1$。PMF，记为 $U_{\\mathrm{eff}}(x;\\lambda)$，是通过对溶剂坐标 $y$ 进行积分得到的，假设 $y$ 在固定的溶质位置 $x$ 处处于瞬时热平衡状态。PMF 的定义是：\n$$\ne^{-\\beta U_{\\mathrm{eff}}(x;\\lambda)} = \\int_{-\\infty}^{\\infty} e^{-\\beta U(x, y; \\lambda)} dy\n$$\n其中 $\\beta$ 是逆热能。代入势能表达式，我们得到：\n$$\ne^{-\\beta U_{\\mathrm{eff}}(x;\\lambda)} = \\int_{-\\infty}^{\\infty} \\exp\\left(-\\beta \\left[ a(x^2 - b^2)^2 + \\frac{1}{2} k_y y^2 + \\sqrt{\\lambda}cxy \\right]\\right) dy\n$$\n我们可以从积分中分离出不依赖于 $y$ 的项：\n$$\ne^{-\\beta U_{\\mathrm{eff}}(x;\\lambda)} = e^{-\\beta a(x^2 - b^2)^2} \\int_{-\\infty}^{\\infty} \\exp\\left(-\\beta \\left[ \\frac{1}{2} k_y y^2 + \\sqrt{\\lambda}cxy \\right]\\right) dy\n$$\n该积分为高斯形式。我们对指数中涉及 $y$ 的项进行配方：\n$$\n\\frac{1}{2} k_y y^2 + \\sqrt{\\lambda}cxy = \\frac{1}{2} k_y \\left(y^2 + \\frac{2\\sqrt{\\lambda}cx}{k_y}y\\right) = \\frac{1}{2} k_y \\left( y + \\frac{\\sqrt{\\lambda}cx}{k_y} \\right)^2 - \\frac{\\lambda c^2 x^2}{2k_y}\n$$\n将其代回，积分变为：\n$$\n\\int_{-\\infty}^{\\infty} \\exp\\left(-\\beta \\left[ \\frac{1}{2} k_y \\left( y + \\frac{\\sqrt{\\lambda}cx}{k_y} \\right)^2 - \\frac{\\lambda c^2 x^2}{2k_y} \\right]\\right) dy = e^{\\beta \\frac{\\lambda c^2 x^2}{2k_y}} \\int_{-\\infty}^{\\infty} e^{-\\beta \\frac{k_y}{2} z^2} dz\n$$\n这里我们进行了换元 $z = y + \\frac{\\sqrt{\\lambda}cx}{k_y}$。剩余的积分值为 $\\sqrt{2\\pi/(\\beta k_y)}$，这是一个常数，它只对势能增加一个恒定的偏移，对于动力学可以忽略。合并依赖于 $x$ 的项：\n$$\ne^{-\\beta U_{\\mathrm{eff}}(x;\\lambda)} \\propto e^{-\\beta a(x^2 - b^2)^2} e^{\\beta \\frac{\\lambda c^2 x^2}{2k_y}} = \\exp\\left(-\\beta \\left[a(x^2 - b^2)^2 - \\frac{\\lambda c^2}{2k_y} x^2\\right]\\right)\n$$\n因此，溶质坐标 $x$ 的有效平均力势为：\n$$\nU_{\\mathrm{eff}}(x;\\lambda) = a(x^2 - b^2)^2 - \\frac{\\lambda c^2}{2k_y} x^2\n$$\n\n**2. 有效势的分析**\n\n为了应用 Kramers 理论，我们必须确定势阱（最小值）和过渡态（鞍点，在此一维情况下为最大值）的位置，以及在这些点上的曲率。我们通过将 $U_{\\mathrm{eff}}(x;\\lambda)$ 的一阶导数设为零来找到驻点：\n$$\n\\frac{d U_{\\mathrm{eff}}}{dx} = \\frac{d}{dx} \\left[ a(x^4 - 2b^2x^2 + b^4) - \\frac{\\lambda c^2}{2k_y} x^2 \\right] = 4ax^3 - 4ab^2x - \\frac{\\lambda c^2}{k_y}x = x\\left(4ax^2 - 4ab^2 - \\frac{\\lambda c^2}{k_y}\\right) = 0\n$$\n驻点是 $x=0$ 和 $x = \\pm\\sqrt{b^2 + \\frac{\\lambda c^2}{4ak_y}}$。\n稳定性由二阶导数（曲率）确定：\n$$\n\\frac{d^2 U_{\\mathrm{eff}}}{dx^2} = 12ax^2 - 4ab^2 - \\frac{\\lambda c^2}{k_y}\n$$\n在 $x=0$ 处，曲率为 $-4ab^2 - \\frac{\\lambda c^2}{k_y}  0$。此点 $x_b = 0$ 是一个局部最大值，代表能垒的顶部。\n在 $x = \\pm\\sqrt{b^2 + \\frac{\\lambda c^2}{4ak_y}}$ 处，曲率为 $12a(b^2 + \\frac{\\lambda c^2}{4ak_y}) - 4ab^2 - \\frac{\\lambda c^2}{k_y} = 8ab^2 + \\frac{2\\lambda c^2}{k_y} > 0$。这些点 $x_w = \\pm\\sqrt{b^2 + \\frac{\\lambda c^2}{4ak_y}}$ 是局部最小值，代表势阱的底部。\n\n**3. Kramers 速率所需量的推导**\n\n高摩擦 Kramers 速率表达式依赖于势垒高度 $\\Delta U$，以及阱底曲率 $k_w$ 和垒顶曲率 $k_b$。\n阱底曲率为：$k_w(\\lambda) = \\left. \\frac{d^2 U_{\\mathrm{eff}}}{dx^2} \\right|_{x=x_w} = 8ab^2 + \\frac{2\\lambda c^2}{k_y}$。\n垒顶曲率为：$k_b(\\lambda) = \\left. \\frac{d^2 U_{\\mathrm{eff}}}{dx^2} \\right|_{x=x_b} = -4ab^2 - \\frac{\\lambda c^2}{k_y}$。Kramers 理论使用该曲率的绝对值来表示势垒“频率”。我们定义正量 $|k_b(\\lambda)| = 4ab^2 + \\frac{\\lambda c^2}{k_y}$。\n\n势垒高度 $\\Delta U(\\lambda)$ 是垒顶和阱底之间的势能差：\n$$\n\\Delta U(\\lambda) = U_{\\mathrm{eff}}(x_b; \\lambda) - U_{\\mathrm{eff}}(x_w; \\lambda) = U_{\\mathrm{eff}}(0; \\lambda) - U_{\\mathrm{eff}}(x_w; \\lambda)\n$$\n$U_{\\mathrm{eff}}(0; \\lambda) = a(0 - b^2)^2 - 0 = ab^4$。\n$U_{\\mathrm{eff}}(x_w; \\lambda) = a((x_w^2) - b^2)^2 - \\frac{\\lambda c^2}{2k_y}x_w^2$。代入 $x_w^2 = b^2 + \\frac{\\lambda c^2}{4ak_y}$，我们得到：\n$$\nU_{\\mathrm{eff}}(x_w; \\lambda) = a\\left(\\frac{\\lambda c^2}{4ak_y}\\right)^2 - \\frac{\\lambda c^2}{2k_y}\\left(b^2 + \\frac{\\lambda c^2}{4ak_y}\\right) = \\frac{\\lambda^2 c^4}{16ak_y^2} - \\frac{b^2\\lambda c^2}{2k_y} - \\frac{\\lambda^2 c^4}{8ak_y^2} = -\\frac{b^2\\lambda c^2}{2k_y} - \\frac{\\lambda^2 c^4}{16ak_y^2}\n$$\n因此，势垒高度为：\n$$\n\\Delta U(\\lambda) = ab^4 - \\left(-\\frac{b^2\\lambda c^2}{2k_y} - \\frac{\\lambda^2 c^4}{16ak_y^2}\\right) = ab^4 + \\frac{b^2\\lambda c^2}{2k_y} + \\frac{\\lambda^2 c^4}{16ak_y^2}\n$$\n这个表达式可以被看作是一个完全平方：\n$$\n\\Delta U(\\lambda) = a\\left(b^4 + \\frac{b^2\\lambda c^2}{2ak_y} + \\frac{\\lambda^2 c^4}{16a^2k_y^2}\\right) = a\\left(b^2 + \\frac{\\lambda c^2}{4ak_y}\\right)^2\n$$\n\n**4. 高摩擦 Kramers 速率公式**\n\n对于过阻尼动力学，适用的公式是 Kramers 理论的高摩擦（或 Smoluchowski）极限。从一个阱（频率 $\\omega_w$）越过一个高度为 $\\Delta U$、摩擦系数为 $\\gamma$ 的势垒（频率 $\\omega_b$）的速率 $k$ 为：\n$$\nk = \\frac{\\omega_w \\omega_b}{2\\pi(\\gamma/m)} e^{-\\beta \\Delta U}\n$$\n角频率与曲率的关系为 $\\omega_w = \\sqrt{k_w/m}$ 和 $\\omega_b = \\sqrt{|k_b|/m}$，其中 $m$ 是粒子的质量。代入这些关系式：\n$$\nk = \\frac{\\sqrt{k_w/m} \\sqrt{|k_b|/m}}{2\\pi(\\gamma/m)} e^{-\\beta \\Delta U} = \\frac{\\sqrt{k_w |k_b|}/m}{2\\pi \\gamma/m} e^{-\\beta \\Delta U} = \\frac{\\sqrt{k_w |k_b|}}{2\\pi \\gamma} e^{-\\beta \\Delta U}\n$$\n请注意，质量 $m$ 被消掉了，这是高摩擦极限的一个特征，此时动力学主要由粘性阻力而非惯性主导。现在我们代入推导出的 $k_w(\\lambda)$、$|k_b(\\lambda)|$、$\\Delta U(\\lambda)$ 表达式以及给定的摩擦模型 $\\gamma(\\lambda) = \\gamma_0 + \\alpha\\lambda c^2$：\n$$\nk(\\lambda) = \\frac{\\sqrt{\\left(8ab^2 + \\frac{2\\lambda c^2}{k_y}\\right)\\left(4ab^2 + \\frac{\\lambda c^2}{k_y}\\right)}}{2\\pi (\\gamma_0 + \\alpha\\lambda c^2)} \\exp\\left(-\\beta \\left[a\\left(b^2 + \\frac{\\lambda c^2}{4ak_y}\\right)^2\\right]\\right)\n$$\n这是速率常数作为回火参数 $\\lambda$ 和系统参数的函数的最终表达式。该公式将用于数值计算。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the Kramers' rate for a toy molecular system\n    under Replica Exchange with Solute Tempering (REST).\n    \"\"\"\n\n    test_cases = [\n        # (a, b, c, k_y, m, beta, gamma_0, alpha, lam)\n        (1.0, 1.0, 1.0, 2.0, 1.0, 3.0, 10.0, 0.5, 1.0),\n        (1.0, 1.0, 1.0, 2.0, 1.0, 3.0, 10.0, 0.5, 0.0),\n        (1.0, 1.0, 1.0, 2.0, 1.0, 3.0, 10.0, 0.5, 0.25),\n        (1.0, 1.0, 2.0, 2.0, 1.0, 3.0, 10.0, 0.5, 1.0),\n        (1.0, 1.0, 1.0, 2.0, 1.0, 1.0, 10.0, 0.5, 1.0),\n    ]\n\n    results = []\n    for params in test_cases:\n        rate = calculate_kramers_rate(params)\n        results.append(f\"{rate:.8f}\")\n\n    print(f\"[{','.join(results)}]\")\n\ndef calculate_kramers_rate(params):\n    \"\"\"\n    Computes the high-friction Kramers' rate k(lambda) using the derived formula.\n\n    The formula is:\n    k(lambda) = (sqrt(k_w * |k_b|)) / (2*pi*gamma(lambda)) * exp(-beta * delta_U(lambda))\n\n    where:\n    k_w = 8ab^2 + (2*lambda*c^2)/k_y\n    |k_b| = 4ab^2 + (lambda*c^2)/k_y\n    gamma(lambda) = gamma_0 + alpha*lambda*c^2\n    delta_U(lambda) = a*(b^2 + (lambda*c^2)/(4*a*k_y))^2\n    \"\"\"\n    a, b, c, k_y, _, beta, gamma_0, alpha, lam = params\n\n    # Calculate friction coefficient gamma(lambda)\n    gamma_lam = gamma_0 + alpha * lam * c**2\n\n    # Calculate well curvature k_w and barrier curvature magnitude |k_b|\n    c_squared = c**2\n    lambda_c_squared_over_ky = lam * c_squared / k_y\n    \n    k_w = 8 * a * b**2 + 2 * lambda_c_squared_over_ky\n    k_b_abs = 4 * a * b**2 + lambda_c_squared_over_ky\n\n    # Calculate barrier height delta_U(lambda)\n    delta_U = a * (b**2 + (lam * c_squared) / (4 * a * k_y))**2\n\n    # Calculate the pre-exponential factor\n    numerator = np.sqrt(k_w * k_b_abs)\n    denominator = 2 * np.pi * gamma_lam\n    prefactor = numerator / denominator\n\n    # Calculate the exponential term\n    exp_term = np.exp(-beta * delta_U)\n\n    # Calculate the final rate k(lambda)\n    rate = prefactor * exp_term\n\n    return rate\n\nsolve()\n```", "id": "3414992"}]}