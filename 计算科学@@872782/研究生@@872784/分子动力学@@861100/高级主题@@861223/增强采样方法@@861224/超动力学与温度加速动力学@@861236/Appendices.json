{"hands_on_practices": [{"introduction": "超动力学方法的核心在于通过施加一个偏置势来加速稀有事件的发生，同时保持系统的跃迁路径不变。然而，这种加速意味着模拟时间和真实物理时间不再相等。本练习将引导你从第一性原理出发，推导如何从一个偏置的、加速的轨迹中精确地重构出对应的物理时间，并利用这个时间来估计无偏置系统中的反应速率常数 [@problem_id:3417459]。", "problem": "在亚稳态盆地的超动力学模拟中，观察到了一个单一的反应事件。原始势能面为 $U(\\mathbf{r})$，施加了一个非负、依赖于状态的提升势 $\\Delta V(\\mathbf{r}) \\ge 0$ 来构建偏置势 $U_b(\\mathbf{r}) = U(\\mathbf{r}) + \\Delta V(\\mathbf{r})$。系统与绝对温度为 $T$ 的热浴耦合，并在偏置势下演化，直到在偏置退出时间 $\\tau_b$ 时离开该盆地。给定在退出前紧邻的偏置轨迹上，以均匀时间间隔 $\\Delta t$ 采样的施加提升势的离散时间序列：\n- 温度 $T = 300 \\ \\text{K}$，玻尔兹曼常数 $k_B = 0.008314462618 \\ \\text{kJ} \\ \\text{mol}^{-1} \\ \\text{K}^{-1}$。\n- 采样间隔 $\\Delta t = 0.2 \\ \\text{ps}$。\n- 样本数量 $N = 10$，其中 $t_k = k \\Delta t$ 且 $\\tau_b = N \\Delta t = 2.0 \\ \\text{ps}$。\n- 提升势样本，单位为 $\\text{kJ} \\ \\text{mol}^{-1}$：\n$$\n\\{\\Delta V(t_k)\\}_{k=1}^{10} = \\{24.0,\\ 25.0,\\ 23.5,\\ 24.5,\\ 26.0,\\ 25.5,\\ 24.0,\\ 23.0,\\ 22.5,\\ 24.0\\}.\n$$\n\n从平衡统计力学和正则系综中势垒穿越的第一性原理出发，并且不假设任何预制的“时间重标”公式，完成以下任务：\n1) 推导一个表达式，将偏置轨迹上累积到 $\\tau_b$ 的无偏置物理时间 $t_{\\text{phys}}$ 与随时间变化的提升势 $\\Delta V(t)$ 联系起来。此推导需满足超动力学的标准要求，即在盆地中 $\\Delta V(\\mathbf{r}) \\ge 0$ 且在过渡态区域 $\\Delta V(\\mathbf{r}) = 0$。\n2) 使用您推导的表达式和离散数据，通过适当的黎曼和近似计算 $t_{\\text{phys}}$。请将最终的 $t_{\\text{phys}}$ 以纳秒为单位表示。\n3) 假设在无偏置条件下离开盆地的过程是无记忆（泊松）过程，利用您计算出的 $t_{\\text{phys}}$，从这单次观察到的退出事件中给出无偏置速率常数 $k_0$ 的最大似然估计。请将最终的 $k_0$ 以 $\\text{microsecond}^{-1}$ 为单位表示。\n\n将两个要求的数值答案四舍五入到三位有效数字。当您报告最终答案时，将 $t_{\\text{phys}}$（单位为纳秒）放在前面，$k_0$（单位为 $\\text{microsecond}^{-1}$）放在后面，以行矩阵形式列出。", "solution": "该问题经评估具有科学依据、提法明确、客观且内部一致。它是超动力学原理的标准应用，这是一种在计算统计力学中有效且成熟的方法。唯一解所需的所有数据和条件均已提供。因此，我们可以着手求解。\n\n该问题需要一个三部分的解答：1) 推导偏置模拟时间与物理时间之间的关系，2) 计算总物理时间，以及 3) 估计无偏置速率常数。\n\n**1. 物理时间表达式的推导**\n\n超动力学的基本前提是在不改变不同逃逸路径相对概率的情况下，加速从势能盆地的逃逸。这是通过添加一个非负的提升势 $\\Delta V(\\mathbf{r})$ 来实现的，该提升势在盆地的过渡态边界处为零。\n\n设系统处于温度为 $T$ 的正则系综中。在构型空间中某点 $\\mathbf{r}$ 处找到系统的概率密度由玻尔兹曼分布给出。对于原始势 $U(\\mathbf{r})$，其表达式为：\n$$ P_0(\\mathbf{r}) \\propto \\exp\\left(-\\frac{U(\\mathbf{r})}{k_B T}\\right) $$\n在偏置势 $U_b(\\mathbf{r}) = U(\\mathbf{r}) + \\Delta V(\\mathbf{r})$ 下，概率密度变为：\n$$ P_b(\\mathbf{r}) \\propto \\exp\\left(-\\frac{U_b(\\mathbf{r})}{k_B T}\\right) = \\exp\\left(-\\frac{U(\\mathbf{r}) + \\Delta V(\\mathbf{r})}{k_B T}\\right) = P_0(\\mathbf{r}) \\exp\\left(-\\frac{\\Delta V(\\mathbf{r})}{k_B T}\\right) $$\n一条轨迹在无穷小区域 $d\\mathbf{r}$ 中花费的时间与处于该区域的概率密度成正比。设 $dt_b$ 为偏置模拟中的一个无穷小时间增量，在此期间系统位于位置 $\\mathbf{r}(t_b)$。相应的物理时间增量 $dt_{\\text{phys}}$ 必须被“重新加权”，以校正由 $\\Delta V$ 引起的驻留概率的人为降低。为了恢复无偏置的统计权重，在 $\\mathbf{r}$ 处花费的时间必须乘以其概率降低的倍数的倒数。这个因子是概率比的倒数：\n$$ \\frac{P_0(\\mathbf{r})}{P_b(\\mathbf{r})} = \\frac{\\exp\\left(-U(\\mathbf{r})/(k_B T)\\right)}{\\exp\\left(-U_b(\\mathbf{r})/(k_B T)\\right)} = \\exp\\left(\\frac{U_b(\\mathbf{r}) - U(\\mathbf{r})}{k_B T}\\right) = \\exp\\left(\\frac{\\Delta V(\\mathbf{r})}{k_B T}\\right) $$\n这就是所谓的“提升因子”。因此，无穷小时间增量之间的关系是：\n$$ dt_{\\text{phys}} = \\exp\\left(\\frac{\\Delta V(\\mathbf{r}(t_b))}{k_B T}\\right) dt_b $$\n在持续时间为 $\\tau_b$ 的偏置轨迹上，累积的总物理时间 $t_{\\text{phys}}$ 是通过将此微分关系对偏置时间 $t_b$ 从 $0$ 到 $\\tau_b$ 积分得到的。令 $\\Delta V(t)$ 表示沿轨迹随时间变化的提升势 $\\Delta V(\\mathbf{r}(t))$，我们得到：\n$$ t_{\\text{phys}} = \\int_{0}^{\\tau_b} \\exp\\left(\\frac{\\Delta V(t)}{k_B T}\\right) dt $$\n这就是所求的表达式。\n\n**2. 物理时间 $t_{\\text{phys}}$ 的计算**\n\n我们给定了一个在 $N=10$ 个点上的离散时间序列 $\\Delta V(t_k)$，其均匀时间步长为 $\\Delta t = 0.2 \\ \\text{ps}$。我们可以使用黎曼和来近似上面推导出的积分。我们将假设值 $\\Delta V(t_k)$ 代表了在第 $k$ 个持续时间为 $\\Delta t$ 的时间间隔内的提升势。\n$$ t_{\\text{phys}} \\approx \\sum_{k=1}^{N} \\exp\\left(\\frac{\\Delta V(t_k)}{k_B T}\\right) \\Delta t $$\n首先，我们用适当的单位计算热能 $k_B T$：\n$$ k_B T = (0.008314462618 \\ \\text{kJ} \\ \\text{mol}^{-1} \\ \\text{K}^{-1}) \\times (300 \\ \\text{K}) \\approx 2.49434 \\ \\text{kJ} \\ \\text{mol}^{-1} $$\n给定的提升势值为 $\\{\\Delta V_k\\}_{k=1}^{10}$ 是 $\\{24.0, 25.0, 23.5, 24.5, 26.0, 25.5, 24.0, 23.0, 22.5, 24.0\\}$，单位为 $\\text{kJ} \\ \\text{mol}^{-1}$。时间步长为 $\\Delta t = 0.2 \\ \\text{ps}$。\n\n我们计算指数函数的参数，$\\frac{\\Delta V_k}{k_B T}$：\n$$\n\\{9.6217, 10.0227, 9.4212, 9.8222, 10.4237, 10.2232, 9.6217, 9.2207, 9.0202, 9.6217\\}\n$$\n接下来，我们计算提升因子，$\\exp(\\frac{\\Delta V_k}{k_B T})$：\n$$\n\\{15088.0, 22530.4, 12347.1, 18436.4, 33644.0, 27533.1, 15088.0, 10099.9, 8266.3, 15088.0\\}\n$$\n这些提升因子的总和是：\n$$ \\sum_{k=1}^{10} \\exp\\left(\\frac{\\Delta V(t_k)}{k_B T}\\right) \\approx 178121.2 $$\n现在我们乘以时间步长 $\\Delta t$：\n$$ t_{\\text{phys}} \\approx (178121.2) \\times (0.2 \\ \\text{ps}) = 35624.24 \\ \\text{ps} $$\n问题要求结果以纳秒（$\\text{ns}$）为单位。因为 $1 \\ \\text{ns} = 1000 \\ \\text{ps}$，我们有：\n$$ t_{\\text{phys}} \\approx 35.62424 \\ \\text{ns} $$\n四舍五入到三位有效数字，我们得到 $t_{\\text{phys}} = 35.6 \\ \\text{ns}$。\n\n**3. 无偏置速率常数 $k_0$ 的最大似然估计**\n\n我们已知从盆地的无偏置退出是一个无记忆过程，这意味着它遵循泊松过程。这种过程中第一个事件的等待时间由指数概率分布描述。在给定潜在速率常数 $k_0$ 的情况下，观察到第一次退出发生在时间 $t$ 的概率密度函数是：\n$$ f(t | k_0) = k_0 \\exp(-k_0 t) $$\n我们有一次退出事件的观测，它发生在累积总物理时间 $t_{\\text{phys}}$ 之后。对于这单次观测，似然函数 $L(k_0)$ 是在 $t = t_{\\text{phys}}$ 处求值的概率密度：\n$$ L(k_0) = k_0 \\exp(-k_0 t_{\\text{phys}}) $$\n为了找到 $k_0$ 的最大似然估计（MLE），记为 $\\hat{k}_0$，我们最大化 $L(k_0)$。这等同于最大化对数似然函数 $\\ln L(k_0)$：\n$$ \\ln L(k_0) = \\ln(k_0) - k_0 t_{\\text{phys}} $$\n我们通过对 $k_0$ 求导并令其为零来找到最大值：\n$$ \\frac{d}{dk_0} \\ln L(k_0) = \\frac{1}{k_0} - t_{\\text{phys}} $$\n将导数设为零，给出 MLE $\\hat{k}_0$ 的条件：\n$$ \\frac{1}{\\hat{k}_0} - t_{\\text{phys}} = 0 \\implies \\hat{k}_0 = \\frac{1}{t_{\\text{phys}}} $$\n使用我们计算出的 $t_{\\text{phys}} \\approx 35.62424 \\ \\text{ns}$ 值：\n$$ \\hat{k}_0 = \\frac{1}{35.62424 \\ \\text{ns}} \\approx 0.0280708 \\ \\text{ns}^{-1} $$\n问题要求速率常数的单位为逆微秒（$\\mu s^{-1}$）。我们使用转换关系 $1 \\ \\text{ns}^{-1} = 10^3 \\ \\mu s^{-1}$：\n$$ \\hat{k}_0 \\approx 0.0280708 \\times 10^3 \\ \\mu s^{-1} = 28.0708 \\ \\mu s^{-1} $$\n四舍五入到三位有效数字，我们得到 $k_0 = 28.1 \\ \\mu s^{-1}$。\n\n我们被要求以纳秒报告 $t_{\\text{phys}}$，以 $\\mu s^{-1}$ 报告 $k_0$。最终的四舍五入值分别为 $35.6$ 和 $28.1$。", "answer": "$$\\boxed{\\begin{pmatrix} 35.6  28.1 \\end{pmatrix}}$$", "id": "3417459"}, {"introduction": "任何加速动力学方法的有效性都取决于其基本假设是否在实践中得到满足。对于超动力学，一个关键的要求是偏置势在区分亚稳态区域的“分界平面”上必须为零。本练习将带你进入方法验证的实际问题，你将学习如何设计一个统计检验来判断模拟中是否满足这一关键条件，并处理模拟数据中常见的时间序列相关性 [@problem_id:3417464]。", "problem": "在超动力学中，通过添加一个偏置势 $\\Delta V(\\mathbf{q})$ 来提高长寿命盆地的能量，同时通过强制偏置势在分隔亚稳态区域的分界面 $\\Sigma$ 的一个薄邻域内消失，来保持精确的过渡态动力学。在温度为 $T$ 的正则采样下，并假设过渡态理论 (TST) 有效，那么当且仅当对于 $\\mathbf{q} \\in \\Sigma$ 有 $\\Delta V(\\mathbf{q}) \\approx 0$ 时，穿过 $\\Sigma$ 的瞬时反应通量才不受偏置势的影响。为了评估一个给定的超动力学实现在实践中是否满足此要求，考虑以下诊断方法：对于每次观察到的盆地逃逸，在首次穿越 $\\Sigma$ 时收集其出口构型 $\\{\\mathbf{q}_{i}\\}_{i=1}^{n}$，并记录相应的偏置势值 $\\Delta V_{i} = \\Delta V(\\mathbf{q}_{i})$。在一个理想的实现中，出口处的 $\\Delta V_{i}$ 的分布应以零为中心。\n\n给定一个按时间排序的样本 $\\{\\Delta V_{i}\\}_{i=1}^{n}$，它来自一个出口事件重复出现的单个长轨迹，这些值是在每次出口事件首次穿越界面的瞬间测量的。假设：\n1) 轨迹处于温度为 $T$ 的稳态正则系综中，\n2) 出口构型近似于来自穿过 $\\Sigma$ 的稳态通量的样本，\n3) $\\{\\Delta V_{i}\\}$ 的序列相关性可以建模为一个延迟为1的自相关系数为 $\\hat{\\rho}$ 的一阶自回归过程。\n\n请构建一个关于\n$$\nH_{0}: \\ \\mathbb{E}[\\Delta V_{\\mathrm{exit}}]=0\n\\quad \\text{versus} \\quad\nH_{1}: \\ \\mathbb{E}[\\Delta V_{\\mathrm{exit}}]\\neq 0,\n$$\n的双边假设检验。该检验应使用均值的大样本正态近似，并通过一阶自回归模型下的积分自相关时间来解释自相关性。然后，根据以下数据集摘要计算双边p值，其中能量以热能 $k_{B}T$ 的倍数报告：\n- 样本大小 $n=80$，\n- 样本均值 $\\bar{\\Delta V}=0.018$，\n- 样本标准差 $s=0.052$，\n- 估计的延迟为1的自相关 $\\hat{\\rho}=0.70$。\n\n请写出您使用的任何中间表达式，并将最终的双边p值报告为一个纯数字（无单位）。将您的答案四舍五入到四位有效数字。", "solution": "该问题要求执行一个双边假设检验，以确定在分界面上观察到的偏置势的均值 $\\mathbb{E}[\\Delta V_{\\mathrm{exit}}]$ 是否在统计上与零一致。样本数据 $\\{\\Delta V_i\\}$ 是一个时间序列，其序列相关性必须在统计检验中予以考虑。\n\n首先，我们陈述原假设和备择假设：\n$$\nH_0: \\mu = 0\n$$\n$$\nH_1: \\mu \\neq 0\n$$\n其中 $\\mu = \\mathbb{E}[\\Delta V_{\\mathrm{exit}}]$。\n\n检验大样本均值的标准流程是使用z检验。检验统计量 $z$ 由下式给出：\n$$\nz = \\frac{\\bar{X} - \\mu_0}{\\sigma_{\\bar{X}}}\n$$\n其中 $\\bar{X}$ 是样本均值，$\\mu_0$ 是假设的总体均值（本例中为 $\\mu_0=0$），$\\sigma_{\\bar{X}}$ 是样本均值的标准误。\n\n对于一个大小为 $n$ 且观测值独立同分布 (i.i.d.) 的样本，样本均值的方差为 $\\sigma^2_{\\bar{X}} = \\frac{\\sigma^2}{n}$，其中 $\\sigma^2$ 是基础分布的方差。然而，问题指出数据 $\\{\\Delta V_i\\}$ 是序列相关的，遵循一阶自回归 (AR(1)) 过程。在存在自相关的情况下，样本均值的方差比独立同分布的情况要大，由下式给出：\n$$\n\\sigma^2_{\\bar{X}} = \\frac{\\sigma^2}{n} g\n$$\n其中 $g$ 是统计非效率，它量化了由相关性引起的有效样本大小的减少。有效样本大小为 $n_{\\mathrm{eff}} = n/g$。对于平稳过程，统计非效率定义为：\n$$\ng = 1 + 2 \\sum_{k=1}^{\\infty} \\rho_k\n$$\n其中 $\\rho_k$ 是时间序列在延迟为 $k$ 时的自相关。\n\n问题指定了 AR(1) 模型，其延迟为 $k$ 的自相关由 $\\rho_k = \\rho^k$ 给出，其中 $\\rho$ 是延迟为1的自相关系数。将此代入 $g$ 的表达式中：\n$$\ng = 1 + 2 \\sum_{k=1}^{\\infty} \\rho^k\n$$\n该求和是一个几何级数，当 $|\\rho|1$ 时收敛于 $\\sum_{k=1}^{\\infty} \\rho^k = \\frac{\\rho}{1-\\rho}$。因此，AR(1) 过程的统计非效率为：\n$$\ng = 1 + 2 \\left( \\frac{\\rho}{1-\\rho} \\right) = \\frac{1-\\rho+2\\rho}{1-\\rho} = \\frac{1+\\rho}{1-\\rho}\n$$\n总体方差 $\\sigma^2$ 是未知的，可以用样本方差 $s^2$ 来估计。那么，估计的均值标准误 $\\hat{\\sigma}_{\\bar{\\Delta V}}$ 为：\n$$\n\\hat{\\sigma}_{\\bar{\\Delta V}} = \\sqrt{\\frac{s^2}{n_{\\mathrm{eff}}}} = \\sqrt{\\frac{s^2 g}{n}} = \\frac{s}{\\sqrt{n}} \\sqrt{g}\n$$\n代入 $g$ 的表达式并使用估计的延迟为1的自相关 $\\hat{\\rho}$，我们的检验统计量变为：\n$$\nz = \\frac{\\bar{\\Delta V} - 0}{\\hat{\\sigma}_{\\bar{\\Delta V}}} = \\frac{\\bar{\\Delta V}}{\\frac{s}{\\sqrt{n}} \\sqrt{\\frac{1+\\hat{\\rho}}{1-\\hat{\\rho}}}}\n$$\n我们从模拟中得到以下数据：\n- 样本大小 $n=80$\n- 样本均值 $\\bar{\\Delta V}=0.018$\n- 样本标准差 $s=0.052$\n- 估计的延迟为1的自相关 $\\hat{\\rho}=0.70$\n\n首先，我们计算估计的统计非效率 $\\hat{g}$：\n$$\n\\hat{g} = \\frac{1+\\hat{\\rho}}{1-\\hat{\\rho}} = \\frac{1+0.70}{1-0.70} = \\frac{1.7}{0.3} = \\frac{17}{3} \\approx 5.6667\n$$\n这个值表明有效独立样本数远小于总样本大小 $n=80$，准确地说是 $n_{\\mathrm{eff}} = n/\\hat{g} = 80 / (17/3) \\approx 14.1$。\n\n接下来，我们计算估计的均值标准误：\n$$\n\\hat{\\sigma}_{\\bar{\\Delta V}} = \\frac{s}{\\sqrt{n}} \\sqrt{\\hat{g}} = \\frac{0.052}{\\sqrt{80}} \\sqrt{\\frac{17}{3}}\n$$\n$$\n\\hat{\\sigma}_{\\bar{\\Delta V}} \\approx \\frac{0.052}{8.94427} \\times 2.38048 \\approx 0.005814 \\times 2.38048 \\approx 0.013839\n$$\n现在，我们可以计算 $z$ 统计量：\n$$\nz = \\frac{\\bar{\\Delta V}}{\\hat{\\sigma}_{\\bar{\\Delta V}}} = \\frac{0.018}{0.013839} \\approx 1.3006\n$$\n最后一步是计算双边p值。对于 $z$ 统计量为 $1.3006$，p值是观察到标准正态变量 $Z$ 的值至少与此一样极端的概率，即 $P(|Z| \\ge |1.3006|)$。计算如下：\n$$\np = 2 \\times P(Z \\le -|z|) = 2 \\times \\Phi(-1.3006)\n$$\n其中 $\\Phi$ 是标准正态分布的累积分布函数 (CDF)。使用标准表或正态CDF的计算工具，我们发现：\n$$\n\\Phi(-1.3006) \\approx 0.0967\n$$\n因此，双边p值为：\n$$\np \\approx 2 \\times 0.0967 = 0.1934\n$$\np值为 $0.1934$，通常大于常见的显著性水平（例如 $\\alpha = 0.05$ 或 $\\alpha = 0.01$）。因此，基于此数据集，没有足够的证据拒绝原假设，即分界面上的平均偏置势为零。就此诊断而言，该超动力学实现似乎表现正常。\n\n按照要求将最终答案四舍五入到四位有效数字，p值为 $0.1934$。", "answer": "$$\n\\boxed{0.1934}\n$$", "id": "3417464"}, {"introduction": "温度加速动力学（TAD）通过在高温下进行模拟来预测低温下的动力学行为，但当系统存在能量相近的多个逃逸路径时，该方法会面临挑战。由于过渡态理论中的指前因子存在不确定性，在不同温度下，最快的逃逸路径可能会发生改变，导致TAD方法做出错误的预测。本练习要求你量化这种“排序错误”事件发生的概率，从而深刻理解TAD方法在处理近简并能垒系统时的局限性 [@problem_id:3417476]。", "problem": "要求您形式化并实现一个概率计算，用于诊断在一维近简并势垒系统中 Temperature-Accelerated Dynamics (TAD) 的一种失效模式。背景是高等研究生水平的分子动力学。\n\n构建一个具有三个极小值点和两个鞍点的一维三势阱势 $V(x)$，使得位于 $x = 0$ 的中心势阱通过位于位置 $x = x_\\mathrm{L}$ 和 $x = x_\\mathrm{R}$ 的鞍点有两条出口路径，其势垒能量分别为 $E_\\mathrm{L}$ 和 $E_\\mathrm{R}$（相对于中心极小值测量）。通过设置 $E_\\mathrm{R} = E_\\mathrm{L} + \\Delta E$（其中能量间隔 $\\Delta E \\ge 0$ 很小）来施加势垒的近简并性。假设谐振近似有效，因此 Transition State Theory (TST) 给出 Arrhenius 形式的逃逸速率。具体来说，对于每个通道 $i \\in \\{\\mathrm{L}, \\mathrm{R}\\}$，定义速率\n$$\nk_i(T) = A_i \\exp\\!\\left(-\\frac{E_i}{k_\\mathrm{B} T}\\right),\n$$\n其中 $A_i$ 是尝试频率（指前因子），$E_i$ 是通道 $i$ 的势垒能量，$k_\\mathrm{B}$ 是 Boltzmann 常数，$T$ 是以开尔文为单位的温度。通过 $A_i = A \\left(1 + \\delta_i\\right)$ 来建模近简并指前因子，其中 $A  0$ 是一个共同的标称指前因子，分数偏差 $\\delta_i$ 从区间 $[-\\epsilon, \\epsilon]$ 上的均匀分布中独立抽取，其中 $0 \\le \\epsilon  1$。TAD 过程不知道真实的微观指前因子 $A_i$。\n\nTemperature-Accelerated Dynamics (TAD) 在高温 $T_\\mathrm{high}  T_\\mathrm{low}$ 下运行无偏动力学，并假设按通道排列的出口速率顺序随温度保持不变，从而将出口外推到较低的目标温度 $T_\\mathrm{low}$。此处将“错序事件”定义为：在高温 $T_\\mathrm{high}$ 下的最快逃逸通道（即具有最大 $k_i(T_\\mathrm{high})$ 的通道）与在低温 $T_\\mathrm{low}$ 下的最快逃逸通道（即具有最大 $k_i(T_\\mathrm{low})$ 的通道）不同，而这种差异仅由指前因子的不确定性和近简并势垒引起。\n\n仅从 Transition State Theory 和 Arrhenius 定律的基本原理出发，并如上所述对指前因子的不确定性进行建模，推导并实现一个方法来计算 TAD 发生出口错序的概率。该概率是高温 $T_\\mathrm{high}$、势垒间隔 $\\Delta E$ 和指前因子不确定性大小 $\\epsilon$ 的函数。使用 Boltzmann 常数值 $k_\\mathrm{B} = 8.617333262145 \\times 10^{-5}\\,\\mathrm{eV/K}$，并以电子伏特表示势垒能量。假设目标低温固定为 $T_\\mathrm{low} = 300\\,\\mathrm{K}$。概率必须计算为在 $[0,1]$ 区间内的无量纲小数。\n\n您的程序必须为以下参数三元组 $(T_\\mathrm{high}, \\Delta E, \\epsilon)$ 的测试集生成结果，这些参数的选择旨在覆盖标称、边界和边缘情况：\n\n- 测试 1：$T_\\mathrm{high} = 900\\,\\mathrm{K}$, $\\Delta E = 0.02\\,\\mathrm{eV}$, $\\epsilon = 0.10$。\n- 测试 2：$T_\\mathrm{high} = 1500\\,\\mathrm{K}$, $\\Delta E = 0.01\\,\\mathrm{eV}$, $\\epsilon = 0.50$。\n- 测试 3：$T_\\mathrm{high} = 600\\,\\mathrm{K}$, $\\Delta E = 0.02\\,\\mathrm{eV}$, $\\epsilon = 0.10$。\n- 测试 4：$T_\\mathrm{high} = 1200\\,\\mathrm{K}$, $\\Delta E = 0.00\\,\\mathrm{eV}$, $\\epsilon = 0.50$。\n- 测试 5：$T_\\mathrm{high} = 1200\\,\\mathrm{K}$, $\\Delta E = 0.05\\,\\mathrm{eV}$, $\\epsilon = 0.00$。\n\n如前规定，所有温度必须以开尔文处理，势垒能量以电子伏特处理。最终输出必须是单行，包含五个测试的计算出的错序概率，格式为方括号括起来的逗号分隔列表（例如，$[p_1,p_2,p_3,p_4,p_5]$），其中每个 $p_i$ 是在 $[0,1]$ 区间内的小数。\n\n您的实现必须是一个完整、可运行的 Python 程序，仅使用标准库和指定的数值库。程序不得接受任何外部输入。它必须使用从所述假设严格推导出的方法来计算错序概率，并且必须精确地产生指定的单行输出格式。", "solution": "该问题要求计算 Temperature-Accelerated Dynamics (TAD) 中“错序事件”的概率。错序事件定义为：由于近简并能垒的反应速率指前因子的不确定性，导致在高温 $T_\\mathrm{high}$ 下的最快逃逸通道与在低温 $T_\\mathrm{low}$ 下的最快逃逸通道不同的情况。\n\n设两个逃逸通道分别表示为 L（左）和 R（右）。根据谐振近似下的 Transition State Theory (TST)，每个通道 $i \\in \\{\\mathrm{L}, \\mathrm{R}\\}$ 的逃逸速率由 Arrhenius 方程给出：\n$$\nk_i(T) = A_i \\exp\\left(-\\frac{E_i}{k_\\mathrm{B} T}\\right)\n$$\n其中 $A_i$ 是尝试频率（指前因子），$E_i$ 是活化能垒，$k_\\mathrm{B}$ 是 Boltzmann 常数，$T$ 是绝对温度。\n\n问题指定了以下关系：\n- 势垒能量：$E_\\mathrm{R} = E_\\mathrm{L} + \\Delta E$，其中 $\\Delta E \\ge 0$。我们可以将 $E_L$ 设置为参考能量，因此相对势垒高度差为 $\\Delta E$。\n- 指前因子：$A_\\mathrm{L} = A(1+\\delta_\\mathrm{L})$ 和 $A_\\mathrm{R} = A(1+\\delta_\\mathrm{R})$，其中 $\\delta_\\mathrm{L}$ 和 $\\delta_\\mathrm{R}$ 是从均匀分布 $U[-\\epsilon, \\epsilon]$ 中抽取的独立随机变量。标称指前因子 $A$ 是一个正常数。\n\n逃逸速率的顺序取决于比率 $k_\\mathrm{L}(T)/k_\\mathrm{R}(T)$。如果 $k_\\mathrm{L}(T) > k_\\mathrm{R}(T)$，则通道 L 比通道 R 快。\n$$\nA_\\mathrm{L} \\exp\\left(-\\frac{E_\\mathrm{L}}{k_\\mathrm{B} T}\\right) > A_\\mathrm{R} \\exp\\left(-\\frac{E_\\mathrm{L} + \\Delta E}{k_\\mathrm{B} T}\\right)\n$$\n两边除以公因子，我们得到：\n$$\n\\frac{A_\\mathrm{L}}{A_\\mathrm{R}} > \\exp\\left(-\\frac{\\Delta E}{k_\\mathrm{B} T}\\right)\n$$\n让我们将指前因子比率定义为随机变量 $\\rho = A_\\mathrm{R}/A_\\mathrm{L}$。不等式变为 $1/\\rho > \\exp(-\\Delta E / k_\\mathrm{B} T)$，简化为：\n$$\n\\rho  \\exp\\left(\\frac{\\Delta E}{k_\\mathrm{B} T}\\right)\n$$\n我们定义临界比率 $C(T) = \\exp(\\Delta E / k_\\mathrm B T)$。如果 $\\rho  C(T)$，则通道 L 更快；如果 $\\rho > C(T)$，则通道 R 更快。对于连续随机变量，$\\rho = C(T)$ 的情况概率为零，可以忽略。\n\n由于 $T_\\mathrm{high} > T_\\mathrm{low}$ 且 $\\Delta E \\ge 0$，指数的参数对于 $T_\\mathrm{low}$ 更大，这意味着 $C(T_\\mathrm{low}) \\ge C(T_\\mathrm{high}) \\ge 1$。让我们记 $C_\\mathrm{low} = C(T_\\mathrm{low})$ 和 $C_\\mathrm{high} = C(T_\\mathrm{high})$。\n\n如果最快通道的身份在 $T_\\mathrm{low}$ 和 $T_\\mathrm{high}$之间发生改变，就会发生错序事件。这可能通过两种方式发生：\n1.  L 在 $T_\\mathrm{high}$ 时更快，R 在 $T_\\mathrm{low}$ 时更快：$(\\rho  C_\\mathrm{high})$ 且 $(\\rho > C_\\mathrm{low})$。这是不可能的，因为 $C_\\mathrm{high} \\le C_\\mathrm{low}$。\n2.  R 在 $T_\\mathrm{high}$ 时更快，L 在 $T_\\mathrm{low}$ 时更快：$(\\rho > C_\\mathrm{high})$ 且 $(\\rho  C_\\mathrm{low})$。\n\n因此，当且仅当 $C_\\mathrm{high}  \\rho  C_\\mathrm{low}$ 时，发生错序事件。问题简化为计算此事件的概率，$P(C_\\mathrm{high}  \\rho  C_\\mathrm{low})$。\n\n随机变量 $\\rho$ 是两个独立同分布的随机变量之比，$\\rho = Y/X$，其中 $X = 1+\\delta_\\mathrm{L}$ 且 $Y = 1+\\delta_\\mathrm{R}$。由于 $\\delta_\\mathrm{L}, \\delta_\\mathrm{R} \\sim U[-\\epsilon, \\epsilon]$，因此 $X$ 和 $Y$ 都在区间 $[1-\\epsilon, 1+\\epsilon]$ 上均匀分布。\n$(X,Y)$ 的联合概率密度函数 (PDF) 在方形域 $[1-\\epsilon, 1+\\epsilon] \\times [1-\\epsilon, 1+\\epsilon]$ 上是恒定的：\n$$\nf_{X,Y}(x,y) = \\frac{1}{( (1+\\epsilon) - (1-\\epsilon) )^2} = \\frac{1}{(2\\epsilon)^2} = \\frac{1}{4\\epsilon^2}\n$$\n对于 $x, y \\in [1-\\epsilon, 1+\\epsilon]$，否则 $f_{X,Y}(x,y) = 0$。对于 $\\epsilon=0$ 的情况，概率集中在一个点上，错序的概率为 0。\n\n错序的概率是联合 PDF 在区域 $C_\\mathrm{high}  y/x  C_\\mathrm{low}$ 上的积分。\n$$\nP(\\text{misorder}) = \\iint_{D} f_{X,Y}(x,y) \\,dx\\,dy = \\frac{1}{4\\epsilon^2} \\cdot \\text{Area}(D)\n$$\n其中 $D = \\{(x,y) \\in [1-\\epsilon, 1+\\epsilon]^2 \\mid C_\\mathrm{high}  y/x  C_\\mathrm{low}\\}$。\n\n区域 $D$ 的面积可以通过从 $y/x > C_\\mathrm{high}$ 的区域面积中减去 $y/x > C_\\mathrm{low}$ 的区域面积来找到。设 $A_>(C)$ 是方形区域 $[1-\\epsilon, 1+\\epsilon]^2$ 内满足 $y/x > C$ 的区域的面积。则 $\\text{Area}(D) = A_>(C_\\mathrm{high}) - A_>(C_\\mathrm{low})$。概率为 $P = (A_>(C_\\mathrm{high}) - A_>(C_\\mathrm{low})) / (4\\epsilon^2)$。\n\n让我们推导 $A_>(C)$ 的公式。设 $a = 1-\\epsilon$ 和 $b = 1+\\epsilon$。定义域是方形区域 $[a,b]\\times[a,b]$。条件是 $y > Cx$。我们从几何上分析这个问题。\n直线 $y=Cx$ 穿过原点。由于 $C \\ge 1$，第一象限中直线上所有的点 $(x,y)$ 都满足 $y \\ge x$。\n对于 $(x,y) \\in [a,b]^2$，比率 $y/x$ 的范围是 $[a/b, b/a]$。设 $C_\\mathrm{crit} = b/a = (1+\\epsilon)/(1-\\epsilon)$。\n-   如果 $C \\ge C_\\mathrm{crit}$，那么对于方形区域内的任何点 $(x,y)$，有 $y/x \\le b/a = C_\\mathrm{crit} \\le C$。因此，在方形区域内处处有 $y \\le Cx$。区域 $y > Cx$ 是空的，所以 $A_>(C)=0$。\n-   如果 $1 \\le C  C_\\mathrm{crit}$，直线 $y=Cx$ 与方形区域的左边缘在 $(a, Ca)$ 处相交，与上边缘在 $(b/C, b)$ 处相交。方形区域内满足 $y>Cx$ 的区域是一个顶点为 $(a,b)$、$(b/C, b)$ 和 $(a, Ca)$ 的三角形。这个三角形的面积是：\n    $$\n    A_>(C) = \\frac{1}{2} \\cdot (\\text{base}) \\cdot (\\text{height}) = \\frac{1}{2} \\left( b - Ca \\right) \\left( \\frac{b}{C} - a \\right)\n    $$\n-   如果 $\\epsilon=0$，则 $a=b=1$，方形区域塌缩成一个点 $(1,1)$，$\\rho$ 固定为 $1$。错序要求 $C_\\mathrm{high}  1  C_\\mathrm{low}$，这是不可能的，因为 $C(T) \\ge 1$。概率为 0。\n-   如果 $\\Delta E=0$，则对于所有 $T$ 都有 $C(T)=1$。因此 $C_\\mathrm{high}=C_\\mathrm{low}=1$。区间 $(C_\\mathrm{high}, C_\\mathrm{low})$ 是空的，错序的概率为 0。\n\n最终概率计算如下：\n$P = S(C_\\mathrm{high}) - S(C_\\mathrm{low})$，其中 $S(C) = A_>(C) / (4\\epsilon^2)$。\n因此，函数 $S(C, \\epsilon)$ 为：\n$$\nS(C, \\epsilon) =\n\\begin{cases}\n0  \\text{if } C \\ge \\frac{1+\\epsilon}{1-\\epsilon} \\\\\n\\frac{1}{8\\epsilon^2} \\left( (1+\\epsilon) - C(1-\\epsilon) \\right) \\left( \\frac{1+\\epsilon}{C} - (1-\\epsilon) \\right)  \\text{if } 1 \\le C  \\frac{1+\\epsilon}{1-\\epsilon}\n\\end{cases}\n$$\n这个推导出的公式允许直接计算给定测试用例所需概率。", "answer": "$$ \\boxed{[0.10452, 0.11182, 0.06323, 0.0, 0.0]} $$", "id": "3417476"}]}