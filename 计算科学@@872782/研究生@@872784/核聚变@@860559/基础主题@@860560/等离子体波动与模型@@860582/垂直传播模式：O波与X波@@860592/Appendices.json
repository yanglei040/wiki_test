{"hands_on_practices": [{"introduction": "这第一个练习是一项基础的理论实践。它将引导您直接从冷磁化等离子体中的电磁波方程推导出寻常模（O-模）和非寻常模（X-模）的色散关系。通过完成这个推导 [@problem_id:3712630]，您将深刻理解等离子体介质（由介电张量和 Stix 参数描述）如何从根本上将波的传播分解为两种具有独特性质的极化模式。", "problem": "考虑一个均匀、无碰撞的冷磁化等离子体，该等离子体是磁约束核聚变装置的典型代表，由电子和单一离子种类组成。静态磁场为 $\\boldsymbol{B}_{0} = B_{0}\\,\\hat{\\boldsymbol{z}}$。一个角频率为 $\\omega$ 的单色平面波垂直于 $\\boldsymbol{B}_{0}$ 传播，其波矢为 $\\boldsymbol{k} = k\\,\\hat{\\boldsymbol{x}}$。令折射率为 $n \\equiv c k/\\omega$。在冷等离子体近似下，傅里叶空间中的电磁波方程可以写为\n$$\n\\boldsymbol{k} \\times \\left( \\boldsymbol{k} \\times \\boldsymbol{E} \\right) + \\frac{\\omega^{2}}{c^{2}}\\,\\boldsymbol{\\varepsilon} \\cdot \\boldsymbol{E} = \\boldsymbol{0},\n$$\n其中 $\\boldsymbol{\\varepsilon}$ 是冷等离子体介电张量。在 Stix 参数化中，对于 $\\boldsymbol{B}_{0} \\parallel \\hat{\\boldsymbol{z}}$，介电张量为\n$$\n\\boldsymbol{\\varepsilon} = \n\\begin{pmatrix}\nS  -\\,i D  0 \\\\\ni D  S  0 \\\\\n0  0  P\n\\end{pmatrix},\n$$\n其中 Stix 参数定义为\n$$\nS \\equiv 1 - \\sum_{s}\\frac{\\omega_{ps}^{2}}{\\omega^{2} - \\Omega_{s}^{2}}, \\quad\nD \\equiv \\sum_{s}\\frac{\\Omega_{s}}{\\omega}\\,\\frac{\\omega_{ps}^{2}}{\\omega^{2} - \\Omega_{s}^{2}}, \\quad\nP \\equiv 1 - \\sum_{s}\\frac{\\omega_{ps}^{2}}{\\omega^{2}},\n$$\n其中求和遍及等离子体组分 $s$（电子和离子），$\\omega_{ps}^{2} \\equiv n_{s} q_{s}^{2}/(\\varepsilon_{0} m_{s})$ 是组分等离子体频率，而 $\\Omega_{s} \\equiv q_{s} B_{0}/m_{s}$ 是组分回旋频率。\n\n仅从平面波麦克斯韦方程组和上述冷等离子体张量结构出发，推导垂直传播模式的色散关系。识别两种解耦的极化（寻常模和非寻常模），并获得每种模式的折射率平方 $n^{2}$ 的闭合形式表达式，仅用 Stix 参数 $S$、$D$ 和 $P$ 表示（不要在最终表达式中引入其他参数）。\n\n你的最终答案必须是寻常模和非寻常模的 $n^{2}$ 的解析表达式。不需要进行数值计算。", "solution": "此推导的起点是介质中电磁波的波动方程，在傅里叶空间中表示为：\n$$\n\\boldsymbol{k} \\times \\left( \\boldsymbol{k} \\times \\boldsymbol{E} \\right) + \\frac{\\omega^{2}}{c^{2}}\\,\\boldsymbol{\\varepsilon} \\cdot \\boldsymbol{E} = \\boldsymbol{0}\n$$\n此处，$\\boldsymbol{k}$ 是波矢，$\\boldsymbol{E}$ 是电场矢量，$\\omega$ 是角频率，$c$ 是真空中的光速，$\\boldsymbol{\\varepsilon}$ 是等离子体的介电张量。\n\n我们可以使用矢量恒等式 $\\boldsymbol{A} \\times (\\boldsymbol{B} \\times \\boldsymbol{C}) = (\\boldsymbol{A} \\cdot \\boldsymbol{C})\\boldsymbol{B} - (\\boldsymbol{A} \\cdot \\boldsymbol{B})\\boldsymbol{C}$ 展开双叉积。令 $\\boldsymbol{A} = \\boldsymbol{k}$，$\\boldsymbol{B} = \\boldsymbol{k}$，$\\boldsymbol{C} = \\boldsymbol{E}$，波动方程变为：\n$$\n(\\boldsymbol{k} \\cdot \\boldsymbol{E})\\boldsymbol{k} - (\\boldsymbol{k} \\cdot \\boldsymbol{k})\\boldsymbol{E} + \\frac{\\omega^{2}}{c^{2}}\\,\\boldsymbol{\\varepsilon} \\cdot \\boldsymbol{E} = \\boldsymbol{0}\n$$\n问题指明是垂直传播，静态磁场为 $\\boldsymbol{B}_{0} = B_{0}\\,\\hat{\\boldsymbol{z}}$，波矢为 $\\boldsymbol{k} = k\\,\\hat{\\boldsymbol{x}}$。因此，我们有 $\\boldsymbol{k} \\cdot \\boldsymbol{k} = k^{2}$ 和 $\\boldsymbol{k} \\cdot \\boldsymbol{E} = k E_{x}$。将这些代入波动方程得到：\n$$\n(k E_{x}) (k \\hat{\\boldsymbol{x}}) - k^{2}\\boldsymbol{E} + \\frac{\\omega^{2}}{c^{2}}\\,\\boldsymbol{\\varepsilon} \\cdot \\boldsymbol{E} = \\boldsymbol{0}\n$$\n我们引入由 $n^{2} \\equiv c^{2}k^{2}/\\omega^{2}$ 定义的折射率 $n$。将整个方程乘以 $c^{2}/\\omega^{2}$ 得到：\n$$\n\\frac{c^{2}}{\\omega^{2}} k^{2} E_{x} \\hat{\\boldsymbol{x}} - \\frac{c^{2}k^{2}}{\\omega^{2}}\\boldsymbol{E} + \\boldsymbol{\\varepsilon} \\cdot \\boldsymbol{E} = \\boldsymbol{0}\n$$\n$$\nn^{2} E_{x} \\hat{\\boldsymbol{x}} - n^{2}\\boldsymbol{E} + \\boldsymbol{\\varepsilon} \\cdot \\boldsymbol{E} = \\boldsymbol{0}\n$$\n这个矢量方程可以表示为矩阵形式。项 $n^{2} E_{x} \\hat{\\boldsymbol{x}}$ 可以写成 $n^{2}(\\hat{\\boldsymbol{x}} \\otimes \\hat{\\boldsymbol{x}}) \\cdot \\boldsymbol{E}$，其中 $\\hat{\\boldsymbol{x}} \\otimes \\hat{\\boldsymbol{x}}$ 是一个并矢积，由一个在 $(1,1)$ 位置为 $1$、其余位置为零的矩阵表示。项 $n^{2}\\boldsymbol{E}$ 对应于 $n^{2}\\boldsymbol{I} \\cdot \\boldsymbol{E}$，其中 $\\boldsymbol{I}$ 是单位矩阵。方程变为：\n$$\n\\left[ \\boldsymbol{\\varepsilon} - n^{2}\\boldsymbol{I} + n^{2}(\\hat{\\boldsymbol{x}} \\otimes \\hat{\\boldsymbol{x}}) \\right] \\cdot \\boldsymbol{E} = \\boldsymbol{0}\n$$\n让我们构建方括号内的矩阵。给定介电张量的 Stix 参数化形式为：\n$$\n\\boldsymbol{\\varepsilon} = \n\\begin{pmatrix}\nS  -i D  0 \\\\\ni D  S  0 \\\\\n0  0  P\n\\end{pmatrix}\n$$\n其他矩阵为：\n$$\nn^{2}\\boldsymbol{I} = \\begin{pmatrix} n^{2}  0  0 \\\\ 0  n^{2}  0 \\\\ 0  0  n^{2} \\end{pmatrix}, \\quad n^{2}(\\hat{\\boldsymbol{x}} \\otimes \\hat{\\boldsymbol{x}}) = \\begin{pmatrix} n^{2}  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix}\n$$\n合并这些项，波动方程中的矩阵（我们称之为 $\\boldsymbol{M}$）为：\n$$\n\\boldsymbol{M} = \\begin{pmatrix} S  -i D  0 \\\\ i D  S  0 \\\\ 0  0  P \\end{pmatrix} - \\begin{pmatrix} n^{2}  0  0 \\\\ 0  n^{2}  0 \\\\ 0  0  n^{2} \\end{pmatrix} + \\begin{pmatrix} n^{2}  0  0 \\\\ 0  0  0 \\\\ 0  0  0 \\end{pmatrix} = \\begin{pmatrix} S  -i D  0 \\\\ i D  S-n^{2}  0 \\\\ 0  0  P-n^{2} \\end{pmatrix}\n$$\n齐次线性方程组 $\\boldsymbol{M} \\cdot \\boldsymbol{E} = \\boldsymbol{0}$ 对电场 $\\boldsymbol{E}$ 有非平凡解的充要条件是矩阵 $\\boldsymbol{M}$ 的行列式为零：\n$$\n\\det(\\boldsymbol{M}) = 0\n$$\n$$\n\\det \\begin{pmatrix} S  -i D  0 \\\\ i D  S-n^{2}  0 \\\\ 0  0  P-n^{2} \\end{pmatrix} = 0\n$$\n沿第三行展开行列式得到：\n$$\n(P - n^{2}) \\det \\begin{pmatrix} S  -i D \\\\ i D  S-n^{2} \\end{pmatrix} = 0\n$$\n$$\n(P - n^{2}) \\left[ S(S-n^{2}) - (-i D)(i D) \\right] = 0\n$$\n$$\n(P - n^{2}) (S^{2} - S n^{2} - D^{2}) = 0\n$$\n这个垂直传播的通用色散关系可以分解为两个独立的条件，对应两种不同的波模。\n\n模式 $1$：第一种可能性是第一个因子为零：\n$$\nP - n^{2} = 0 \\implies n^{2} = P\n$$\n为了理解该模式的性质，我们将 $n^{2} = P$ 代回矩阵方程 $\\boldsymbol{M} \\cdot \\boldsymbol{E} = \\boldsymbol{0}$ 来检验电场的极化：\n$$\n\\begin{pmatrix} S  -i D  0 \\\\ i D  S-P  0 \\\\ 0  0  0 \\end{pmatrix} \\begin{pmatrix} E_{x} \\\\ E_{y} \\\\ E_{z} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n第三行意味着 $0 \\cdot E_{z} = 0$，这允许 $E_{z}$ 非零。左上角的 $2 \\times 2$ 子矩阵给出了关于 $E_{x}$ 和 $E_{y}$ 的方程组。该子矩阵的行列式为 $S(S-P) - (-i D)(i D) = S(S-P) - D^{2}$。假设该行列式非零（通常情况下如此），则该子系统的唯一解是 $E_{x} = 0$ 和 $E_{y} = 0$。因此，该模式的电场矢量为 $\\boldsymbol{E} = (0, 0, E_{z})$，平行于背景磁场 $\\boldsymbol{B}_{0}$。根据定义，此模式为 **寻常模（O-mode）**。其折射率仅由 Stix 参数 $P$ 决定。\n\n模式 $2$：第二种可能性是第二个因子为零：\n$$\nS^{2} - S n^{2} - D^{2} = 0\n$$\n解出 $n^{2}$ 得到：\n$$\nS n^{2} = S^{2} - D^{2} \\implies n^{2} = \\frac{S^{2} - D^{2}}{S}\n$$\n为了找到极化，我们再次检验矩阵方程，假设此模式与第一个模式不同（即 $P-n^{2} \\neq 0$）。方程 $(P-n^{2})E_{z} = 0$ 现在要求 $E_{z}=0$。这意味着电场被限制在垂直于 $\\boldsymbol{B}_{0}$ 的平面内，因此 $\\boldsymbol{E} \\perp \\boldsymbol{B}_{0}$。电场矢量为 $\\boldsymbol{E} = (E_{x}, E_{y}, 0)$。左上角的 $2 \\times 2$ 方程块为：\n$$\nS E_{x} - i D E_{y} = 0\n$$\n$$\ni D E_{x} + (S-n^{2}) E_{y} = 0\n$$\n由于根据此模式的条件，这个 $2 \\times 2$ 系统的行列式为零，因此这两个方程是线性相关的。我们可以用第一个方程找到关联电场分量的极化比：$E_{y} = \\frac{S}{iD} E_{x} = -i \\frac{S}{D} E_{x}$。电场在垂直于 $\\boldsymbol{B}_0$ 的平面内呈椭圆极化。根据定义，此模式为 **非寻常模（X-mode）**。其折射率取决于 Stix 参数 $S$ 和 $D$。\n\n总之，两种垂直传播模式及其折射率的平方为：\n$1$. 寻常模（O-mode）：\n   $$ n^{2}_{\\text{O}} = P $$\n$2$. 非寻常模（X-mode）：\n   $$ n^{2}_{\\text{X}} = \\frac{S^{2} - D^{2}}{S} $$\n这些就是所要求的、用 Stix 参数表示的闭合形式表达式。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nP  \\frac{S^{2} - D^{2}}{S}\n\\end{pmatrix}\n}\n$$", "id": "3712630"}, {"introduction": "在建立了 O-模和 X-模的基本属性之后，一个实际问题随之而来：我们如何选择性地将其中一种模式发射到等离子体中？这个练习 [@problem_id:324569] 通过探究入射波的功率如何在真空-等离子体界面上分配给这两种模式来解决这个问题。该问题强调了波的极化在控制波与等离子体相互作用中的关键作用，这是等离子体加热和诊断等应用中的一个核心概念。", "problem": "在一个反射计实验中，一束微波从真空区域 ($z < 0$) 发射，进入一个占据半空间 $z \\ge 0$ 的冷、均匀、磁化等离子体中。该微波束沿着z轴传播 ($\\vec{k} = k\\hat{z}$)。静态均匀磁场 $\\vec{B}_0$ 的方向垂直于传播方向，完全位于x-y平面内，与x轴成 $\\phi_B$ 角。\n\n入射微波束是线性偏振的。其电场矢量 $\\vec{E}_{inc}$ 也位于x-y平面内，与x轴成 $\\alpha$ 角。\n\n在真空-等离子体界面 ($z=0$) 处，入射波功率耦合到垂直传播的两种基本电磁模式中：寻常模 (O-mode) 和非寻常模 (X-mode)。在此构型下：\n1.  O-mode是线性偏振的，其电场矢量平行于背景磁场 $\\vec{B}_0$。\n2.  X-mode在界面处也是线性偏振的，其电场矢量同时垂直于背景磁场 $\\vec{B}_0$ 和传播方向 $\\vec{k}$。\n\n假设条件满足X-mode可以传播到等离子体中（即，发射频率高于相关的截止频率），推导入射波功率中耦合到X-mode部分所占比例的表达式。请用角度 $\\alpha$ 和 $\\phi_B$ 来表示你的答案。", "solution": "1.  在 $xy$ 平面内，与x轴成 $\\alpha$ 角的入射电场为\n    $$ \\vec{E}_{inc} = E_0 (\\cos\\alpha\\,\\hat{\\boldsymbol{x}} + \\sin\\alpha\\,\\hat{\\boldsymbol{y}}) $$\n2.  与x轴成 $\\phi_B$ 角的背景磁场单位矢量为\n    $$ \\hat{\\boldsymbol{b}}_0 = \\cos\\phi_B\\,\\hat{\\boldsymbol{x}} + \\sin\\phi_B\\,\\hat{\\boldsymbol{y}} $$\n3.  对于垂直传播 ($\\vec{k} = k\\hat{\\boldsymbol{z}}$)，X-mode的偏振单位矢量 $\\hat{\\boldsymbol{e}}_X$ 垂直于 $\\hat{\\boldsymbol{k}}$ 和 $\\hat{\\boldsymbol{b}}_0$，因此与 $\\hat{\\boldsymbol{k}} \\times \\hat{\\boldsymbol{b}}_0$ 平行。\n    $$ \\hat{\\boldsymbol{e}}_X = \\hat{\\boldsymbol{k}} \\times \\hat{\\boldsymbol{b}}_0 = \\hat{\\boldsymbol{z}} \\times (\\cos\\phi_B\\,\\hat{\\boldsymbol{x}} + \\sin\\phi_B\\,\\hat{\\boldsymbol{y}}) = \\cos\\phi_B (\\hat{\\boldsymbol{z}}\\times\\hat{\\boldsymbol{x}}) + \\sin\\phi_B (\\hat{\\boldsymbol{z}}\\times\\hat{\\boldsymbol{y}}) = -\\sin\\phi_B\\,\\hat{\\boldsymbol{x}} + \\cos\\phi_B\\,\\hat{\\boldsymbol{y}} $$\n4.  将 $\\vec{E}_{inc}$ 投影到 $\\hat{\\boldsymbol{e}}_X$ 上：\n    $$ \\vec{E}_{inc} \\cdot \\hat{\\boldsymbol{e}}_X = E_0 (\\cos\\alpha\\,\\hat{\\boldsymbol{x}} + \\sin\\alpha\\,\\hat{\\boldsymbol{y}}) \\cdot (-\\sin\\phi_B\\,\\hat{\\boldsymbol{x}} + \\cos\\phi_B\\,\\hat{\\boldsymbol{y}}) = E_0(-\\cos\\alpha\\sin\\phi_B + \\sin\\alpha\\cos\\phi_B) = E_0\\sin(\\alpha - \\phi_B) $$\n5.  X-mode中的功率占比为投影的平方值，由 $E_0^2$ 归一化：\n    $$ \\frac{P_X}{P_{inc}} = \\frac{|\\vec{E}_{inc} \\cdot \\hat{\\boldsymbol{e}}_X|^2}{|\\vec{E}_{inc}|^2} = \\sin^2(\\alpha-\\phi_B) $$", "answer": "$$\\boxed{\\sin^2(\\alpha-\\phi_B)}$$", "id": "324569"}, {"introduction": "最后的这个实践从理想化的线性模型转向探索一个更贴近现实的场景，即涉及聚变研究中常见的高功率波。这个练习 [@problem_id:3712635] 引入了一个弱相对论修正，以考虑电子在强波场中的高速“颤动”，这是电子回旋共振加热（ECRH）等应用中的一个关键非线性效应。通过将这些高级概念付诸于计算模型，您将在解析理论和数值模拟之间架起桥梁，并探究强电磁场如何改变波的传播特性。", "problem": "考虑在与核聚变相关的磁化等离子体中，电磁波垂直于均匀静磁场的传播情况。假设等离子体是均匀的，由电子和单一离子组分（氘）组成，其特征为数密度 $n_e = n_i$、电荷 $q_e = -e$，$q_i = +e$、电子静止质量 $m_e$、离子质量 $m_i = 2 m_p$、光速 $c$、真空介电常数 $\\varepsilon_0$ 以及均匀磁场强度 $B_0$。波以角频率 $\\omega$ 传播，电场振幅为 $E_0$。\n\n从麦克斯韦方程组和适用于均匀磁化等离子体中多组分的冷流体模型（线性化的洛伦兹力方程和连续性方程）的基本出发点，完成以下任务：\n\n- 推导垂直传播（$\\mathbf{k} \\perp \\mathbf{B}_0$）时的极化和介电响应。引入一个弱相对论性的高功率修正，方法是将电子质量视为有效质量 $m_e' = \\gamma m_e$，其中洛伦兹因子 $\\gamma$ 是一个由波中颤动引起的常数，$\\gamma = \\sqrt{1 + a_0^2}$ 且 $a_0 = \\frac{|q_e| E_0}{m_e c \\, \\omega}$。假设离子质量保持非相对论性。\n- 使用冷等离子体介电张量，表示垂直传播的模式折射率。将组分等离子体频率和回旋频率定义为\n$$\\omega_{ps}^2 = \\dfrac{n_s q_s^2}{\\varepsilon_0 m_s'}, \\quad \\Omega_s = \\dfrac{q_s B_0}{m_s'},$$\n其中对于电子 $m_e' = \\gamma m_e$，对于离子 $m_i' = m_i$。定义 Stix 参数\n$$R = 1 - \\sum_s \\dfrac{\\omega_{ps}^2}{\\omega(\\omega + \\Omega_s)}, \\quad L = 1 - \\sum_s \\dfrac{\\omega_{ps}^2}{\\omega(\\omega - \\Omega_s)},$$\n$$S = \\dfrac{R + L}{2}, \\quad P = 1 - \\sum_s \\dfrac{\\omega_{ps}^2}{\\omega^2}.$$\n证明寻常模（O波）和非寻常模（X波）的垂直传播折射率 $N^2 = \\dfrac{c^2 k^2}{\\omega^2}$ 满足\n$$N_\\mathrm{O}^2 = P, \\quad N_\\mathrm{X}^2 = \\dfrac{R L}{S}.$$\n从物理上解释高功率修正（通过 $\\gamma$）如何通过 $m_e'$ 来改变截止和共振位置，从而改变 $\\omega_{pe}$ 和 $\\Omega_e$。\n\n您的程序必须实现这些公式，并为指定的测试套件计算 $N_\\mathrm{O}^2$ 和 $N_\\mathrm{X}^2$。所有输入均使用国际单位制 (SI)。输出必须是无量纲的，并以浮点数形式报告。\n\n测试套件参数集，每个都是一个元组 $(n_e, B_0, \\omega, E_0)$：\n\n1. 一般传播情况：$n_e = 5.0 \\times 10^{19} \\, \\mathrm{m^{-3}}$，$B_0 = 6.0 \\, \\mathrm{T}$，$\\omega = 1.10 \\times 10^{12} \\, \\mathrm{rad/s}$，$E_0 = 1.0 \\times 10^{6} \\, \\mathrm{V/m}$。\n2. 接近寻常模截止（仅电子的名义值；计算中使用双组分冷等离子体模型）：$n_e = 5.0 \\times 10^{19} \\, \\mathrm{m^{-3}}$，$B_0 = 6.0 \\, \\mathrm{T}$，$\\omega = 3.984 \\times 10^{11} \\, \\mathrm{rad/s}$，$E_0 = 0 \\, \\mathrm{V/m}$。\n3. 接近上混杂共振（避免精确共振）：$n_e = 5.0 \\times 10^{19} \\, \\mathrm{m^{-3}}$，$B_0 = 6.0 \\, \\mathrm{T}$，$\\omega = 1.125 \\times 10^{12} \\, \\mathrm{rad/s}$，$E_0 = 0 \\, \\mathrm{V/m}$。\n4. 弱相对论性振幅情况：$n_e = 5.0 \\times 10^{19} \\, \\mathrm{m^{-3}}$，$B_0 = 6.0 \\, \\mathrm{T}$，$\\omega = 1.20 \\times 10^{12} \\, \\mathrm{rad/s}$，$E_0 = 5.0 \\times 10^{6} \\, \\mathrm{V/m}$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，数值按以下顺序排列\n$$[N_\\mathrm{O}^{2,(1)}, N_\\mathrm{X}^{2,(1)}, N_\\mathrm{O}^{2,(2)}, N_\\mathrm{X}^{2,(2)}, N_\\mathrm{O}^{2,(3)}, N_\\mathrm{X}^{2,(3)}, N_\\mathrm{O}^{2,(4)}, N_\\mathrm{X}^{2,(4)}],$$\n其中上标指测试用例的索引。所有输出均报告为无量纲浮点数。", "solution": "该问题要求推导在冷磁化等离子体中垂直于静磁场传播的寻常模（O波）和非寻常模（X波）的折射率，并包含弱相对论性高功率修正。然后，我们将实现这些公式，为给定的一组参数计算折射率。\n\n分析始于控制该系统的基本方程：麦克斯韦方程组和冷等离子体流体的线性化运动方程。\n\n在无源介质中，麦克斯韦的旋度方程为：\n$$\n\\nabla \\times \\mathbf{E} = - \\dfrac{\\partial \\mathbf{B}}{\\partial t}\n$$\n$$\n\\nabla \\times \\mathbf{B} = \\mu_0 \\mathbf{J} + \\mu_0 \\varepsilon_0 \\dfrac{\\partial \\mathbf{E}}{\\partial t}\n$$\n等离子体由电子（组分 $s=e$）和氘离子（组分 $s=i$）组成。每个组分对电磁场的响应由冷等离子体（零初始热速度）的线性化洛伦兹力方程描述：\n$$\nm_s' \\frac{\\partial \\mathbf{v}_{s1}}{\\partial t} = q_s (\\mathbf{E}_1 + \\mathbf{v}_{s1} \\times \\mathbf{B}_0)\n$$\n此处，$\\mathbf{v}_{s1}$ 和 $\\mathbf{E}_1$ 分别是一阶微扰流体速度和电场，而 $\\mathbf{B}_0$ 是均匀的静态背景磁场。质量 $m_s'$ 是每个组分的有效质量。根据题目要求，我们通过将电子质量设为 $m_e' = \\gamma m_e$ 来包含对电子的高功率修正，其中 $\\gamma = \\sqrt{1 + a_0^2}$ 且 $a_0 = |q_e| E_0 / (m_e c \\omega)$。对于离子，我们假设非相对论极限，因此 $m_i' = m_i$。\n\n我们假设所有一阶量都以 $e^{i(\\mathbf{k} \\cdot \\mathbf{r} - \\omega t)}$ 的平面波形式变化。这使我们可以进行替换 $\\partial/\\partial t \\to -i\\omega$ 和 $\\nabla \\to i\\mathbf{k}$。运动方程变为：\n$$\n-i\\omega m_s' \\mathbf{v}_{s1} = q_s (\\mathbf{E}_1 + \\mathbf{v}_{s1} \\times \\mathbf{B}_0)\n$$\n该方程可以求解，从而用电场 $\\mathbf{E}_1$ 表示速度微扰 $\\mathbf{v}_{s1}$。总等离子体电流密度是各组分贡献的总和：$\\mathbf{J}_1 = \\sum_s n_s q_s \\mathbf{v}_{s1}$。这通过关系式 $\\mathbf{J}_1 = \\boldsymbol{\\sigma} \\cdot \\mathbf{E}_1$ 定义了等离子体电导率张量 $\\boldsymbol{\\sigma}$。介电张量 $\\boldsymbol{\\epsilon}$ 则由下式给出：\n$$\n\\boldsymbol{\\epsilon} = \\varepsilon_0 \\mathbf{I} + \\frac{i}{\\omega} \\boldsymbol{\\sigma}\n$$\n不失一般性，设静磁场沿 z 轴方向，即 $\\mathbf{B}_0 = B_0 \\hat{z}$。介电张量的形式为：\n$$\n\\boldsymbol{\\epsilon} = \\varepsilon_0 \\begin{pmatrix} S  -iD  0 \\\\ iD  S  0 \\\\ 0  0  P \\end{pmatrix}\n$$\n分量 $S$、$D$ 和 $P$ 用等离子体参数表示。按照惯例，它们被定义为 $S = 1 - \\sum_s \\frac{\\omega_{ps}^2}{\\omega^2 - \\Omega_s^2}$，$D = \\sum_s \\frac{\\Omega_s \\omega_{ps}^2}{\\omega(\\omega^2 - \\Omega_s^2)}$ 和 $P = 1 - \\sum_s \\frac{\\omega_{ps}^2}{\\omega^2}$。问题将 Stix 参数 $R$ 和 $L$ 定义为：\n$$\nR = 1 - \\sum_s \\dfrac{\\omega_{ps}^2}{\\omega(\\omega + \\Omega_s)}, \\quad L = 1 - \\sum_s \\dfrac{\\omega_{ps}^2}{\\omega(\\omega - \\Omega_s)}\n$$\n其中组分等离子体频率的平方为 $\\omega_{ps}^2 = n_s q_s^2 / (\\varepsilon_0 m_s')$，组分回旋频率为 $\\Omega_s = q_s B_0 / m_s'$。这些参数通过 $S = (R+L)/2$ 和 $D = (R-L)/2$ 相关联。\n\n现在，我们构建波动方程。将平面波形式代入麦克斯韦方程组，得到：\n$$\ni \\mathbf{k} \\times \\mathbf{E}_1 = i\\omega \\mathbf{B}_1\n$$\n$$\ni \\mathbf{k} \\times \\mathbf{B}_1 = \\mu_0 \\mathbf{J}_1 - i\\omega \\mu_0 \\varepsilon_0 \\mathbf{E}_1 = -i\\omega \\mu_0 \\left( \\frac{i}{\\omega} \\boldsymbol{\\sigma} + \\varepsilon_0 \\mathbf{I} \\right) \\cdot \\mathbf{E}_1 = -i\\frac{\\omega}{c^2 \\varepsilon_0} \\boldsymbol{\\epsilon} \\cdot \\mathbf{E}_1\n$$\n合并这两个方程，得到通用波动方程：\n$$\n\\mathbf{k} \\times (\\mathbf{k} \\times \\mathbf{E}_1) + \\frac{\\omega^2}{c^2} \\frac{\\boldsymbol{\\epsilon}}{\\varepsilon_0} \\cdot \\mathbf{E}_1 = 0\n$$\n我们考虑垂直传播，因此 $\\mathbf{k} \\perp \\mathbf{B}_0$。我们选择坐标系，使得 $\\mathbf{k} = k \\hat{x}$ 且 $\\mathbf{B}_0 = B_0 \\hat{z}$。波动方程可以写成矩阵形式。令 $N = ck/\\omega$ 为折射率。张量算符 $\\mathbf{k} \\times (\\mathbf{k} \\times \\cdot)$ 变为 $\\mathbf{k}(\\mathbf{k} \\cdot \\cdot) - k^2 \\mathbf{I}$。波动方程为 $(\\frac{\\omega^2}{c^2} \\mathbf{N}\\mathbf{N} - N^2 \\frac{\\omega^2}{c^2} \\mathbf{I} + \\frac{\\omega^2}{c^2} \\frac{\\boldsymbol{\\epsilon}}{\\varepsilon_0}) \\cdot \\mathbf{E}_1 = 0$，可简化为：\n$$\n\\left( \\mathbf{N}\\mathbf{N} - N^2 \\mathbf{I} + \\frac{\\boldsymbol{\\epsilon}}{\\varepsilon_0} \\right) \\cdot \\mathbf{E}_1 = 0\n$$\n当 $\\mathbf{k} = k \\hat{x}$ 时，张量 $\\mathbf{N}\\mathbf{N}$ 只有一个非零分量 $N_x N_x = N^2$。矩阵方程变为：\n$$\n\\begin{pmatrix} S  -iD  0 \\\\ iD  S - N^2  0 \\\\ 0  0  P - N^2 \\end{pmatrix}\n\\begin{pmatrix} E_x \\\\ E_y \\\\ E_z \\end{pmatrix} = 0\n$$\n为了存在非平庸解，该矩阵的行列式必须为零：\n$$\n\\det \\begin{pmatrix} S  -iD  0 \\\\ iD  S - N^2  0 \\\\ 0  0  P - N^2 \\end{pmatrix} = (P - N^2) \\left[ S(S - N^2) - (-iD)(iD) \\right] = 0\n$$\n$$\n(P - N^2) [S(S - N^2) - D^2] = 0\n$$\n这个方程解耦为两种独立的模式：\n\n1.  **寻常模 (O-波)：** 第一个解由第一个因子给出：\n    $$ P - N^2 = 0 \\implies N_\\mathrm{O}^2 = P $$\n    对于此模式，矩阵方程意味着 $E_x = E_y = 0$，而 $E_z$ 可以非零。波的电场平行于背景磁场 $\\mathbf{B}_0$ 极化。因此，洛伦兹力项 $\\mathbf{v}_{s1} \\times \\mathbf{B}_0$ 不影响电子沿 $\\mathbf{B}_0$ 的运动，波的表现如同在非磁化等离子体中一样。\n\n2.  **非寻常模 (X-波)：** 第二个解由第二个因子给出：\n    $$ S(S - N^2) - D^2 = 0 $$\n    $$ S N^2 = S^2 - D^2 = (S-D)(S+D) $$\n    使用关系式 $R = S+D$ 和 $L = S-D$，我们发现：\n    $$ S N^2 = LR \\implies N_\\mathrm{X}^2 = \\frac{RL}{S} $$\n    对于此模式，$E_z=0$，电场在垂直于 $\\mathbf{B}_0$ 的平面内极化。这种波的传播受到磁场的强烈影响。\n\n**高功率修正的物理效应：**\n相对论质量修正 $m_e' = \\gamma m_e$ 直接改变了电子等离子体频率和电子回旋频率：\n$$\n\\omega_{pe}'^2 = \\frac{n_e e^2}{\\varepsilon_0 m_e'} = \\frac{1}{\\gamma} \\frac{n_e e^2}{\\varepsilon_0 m_e} = \\frac{\\omega_{pe}^2}{\\gamma}\n$$\n$$\n\\Omega_e' = \\frac{-e B_0}{m_e'} = \\frac{1}{\\gamma} \\frac{-e B_0}{m_e} = \\frac{\\Omega_e}{\\gamma}\n$$\n由于 $\\gamma = \\sqrt{1 + a_0^2} \\ge 1$，有效电子质量随波功率 ($E_0^2$) 的增加而增加。这种增加的惯性导致电子对波场的响应更加迟缓。因此，它们的自然等离子体振荡频率（$\\omega_{pe}'$）和它们在磁场中的回旋频率（$|\\Omega_e'|$）都降低了。\n\n截止（$N^2=0$ 处）和共振（$N^2 \\to \\infty$ 处）是波传播的关键特征。它们由特征频率 $\\omega_{pe}'$ 和 $\\Omega_e'$ 决定。\n-   **O模截止：** 发生在 $N_\\mathrm{O}^2 = P = 0$ 处。忽略离子的微小贡献，此条件为 $1 - \\omega_{pe}'^2/\\omega^2 = 0 \\implies \\omega = \\omega_{pe}' = \\omega_{pe}/\\sqrt{\\gamma}$。高功率波（更大的 $\\gamma$）降低了O模的截止频率。\n-   **X模共振（上混杂共振）：** 发生在 $N_\\mathrm{X}^2 \\to \\infty$ 处，即 $S=0$ 时。忽略离子，条件 $S = 1 - \\frac{\\omega_{pe}'^2}{\\omega^2 - \\Omega_e'^2} = 0$ 给出了上混杂频率 $\\omega_{UH}^2 = \\omega_{pe}'^2 + \\Omega_e'^2$。代入相对论修正，我们得到 $\\omega_{UH}^2 = \\frac{\\omega_{pe}^2}{\\gamma} + \\frac{\\Omega_e^2}{\\gamma^2}$。共振频率因高功率效应而向下偏移。\n-   **X模截止：** 发生在 $N_\\mathrm{X}^2 = 0$ 处，这意味着 $R=0$ 或 $L=0$。满足这些条件的频率 $\\omega_R$ 和 $\\omega_L$ 也依赖于 $\\omega_{pe}'$ 和 $\\Omega_e'$，因此也因相对论质量增加而向较低值移动。\n\n总而言之，高功率相对论修正使得电子的有效质量变大，降低了它们的特征频率，并将波的截止和共振位置移向更低的频率。这是在高功率等离子体加热方案（如电子回旋共振加热，ECRH）中的一个关键非线性效应。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the ordinary and extraordinary mode refractive indices for perpendicular\n    propagation in a magnetized plasma, including a weakly relativistic correction.\n    \"\"\"\n    # Physical Constants in SI units\n    e = 1.602176634e-19  # Elementary charge (C)\n    m_e = 9.1093837015e-31 # Electron rest mass (kg)\n    m_p = 1.67262192369e-27 # Proton mass (kg)\n    c = 299792458.0      # Speed of light (m/s)\n    eps0 = 8.8541878128e-12 # Vacuum permittivity (F/m)\n    \n    # Ion properties (Deuterium)\n    q_i = e\n    m_i = 2 * m_p\n\n    # Test cases: (n_e [m^-3], B_0 [T], omega [rad/s], E_0 [V/m])\n    test_cases = [\n        (5.0e19, 6.0, 1.10e12, 1.0e6),\n        (5.0e19, 6.0, 3.984e11, 0.0),\n        (5.0e19, 6.0, 1.125e12, 0.0),\n        (5.0e19, 6.0, 1.20e12, 5.0e6),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        n_e, B0, w, E0 = case\n        \n        # Plasma density is the same for electrons and ions\n        n_i = n_e\n\n        # --- High-Power Correction ---\n        # Calculate normalized vector potential a0 and Lorentz factor gamma\n        if E0 == 0.0:\n            gamma = 1.0\n        else:\n            # a0 = |q_e| * E0 / (m_e * c * w)\n            a0 = (e * E0) / (m_e * c * w)\n            gamma = np.sqrt(1 + a0**2)\n            \n        # Effective electron mass\n        me_eff = gamma * m_e\n        # Ion mass remains non-relativistic\n        mi_eff = m_i\n\n        # --- Plasma Species Definition ---\n        # List of dicts to hold species properties\n        species_list = [\n            {'q': -e, 'm': me_eff, 'n': n_e, 'name': 'electron'},\n            {'q': q_i, 'm': mi_eff, 'n': n_i, 'name': 'ion'}\n        ]\n\n        # --- Stix Parameter Calculation ---\n        # Initialize sums for R, L, P\n        sum_R = 0.0\n        sum_L = 0.0\n        sum_P = 0.0\n\n        for s in species_list:\n            # Species plasma frequency squared: w_ps^2 = n*q^2 / (eps0 * m)\n            w_ps2 = (s['n'] * s['q']**2) / (eps0 * s['m'])\n\n            # Species cyclotron frequency: Omega_s = q*B0 / m\n            Omega_s = (s['q'] * B0) / s['m']\n\n            # Accumulate terms for Stix parameters\n            # Check for resonance conditions to avoid division by zero, though problem inputs avoid this.\n            if w - Omega_s == 0 or w + Omega_s == 0:\n                # This case indicates a resonance not handled by cold plasma theory\n                # We can set results to NaN or handle as per a more advanced model.\n                # For this problem, inputs are chosen to avoid this.\n                sum_L = np.nan\n                sum_R = np.nan\n                break\n\n            sum_R += w_ps2 / (w * (w + Omega_s))\n            sum_L += w_ps2 / (w * (w - Omega_s))\n            sum_P += w_ps2 / (w**2)\n        \n        # Final Stix parameters\n        R = 1.0 - sum_R\n        L = 1.0 - sum_L\n        P = 1.0 - sum_P\n        S = (R + L) / 2.0\n\n        # --- Refractive Index Calculation ---\n        # Ordinary mode refractive index squared\n        # N_O^2 = P\n        N2_O = P\n\n        # Extraordinary mode refractive index squared\n        # N_X^2 = R*L / S\n        # Check for upper hybrid resonance where S=0\n        if S == 0.0:\n            N2_X = np.inf\n        else:\n            N2_X = (R * L) / S\n\n        results.extend([N2_O, N2_X])\n\n    # Format the final output string\n    output_str = f\"[{','.join(map(str, results))}]\"\n    print(output_str)\n\nsolve()\n```", "id": "3712635"}]}