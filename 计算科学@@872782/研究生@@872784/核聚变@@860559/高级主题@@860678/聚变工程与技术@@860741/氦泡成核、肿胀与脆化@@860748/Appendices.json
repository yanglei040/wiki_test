{"hands_on_practices": [{"introduction": "在我们对氦泡的群体行为进行建模之前，首先必须理解单个氦泡内部的基本物理状态。这个练习旨在通过结合理想气体定律和力学平衡条件，将气泡内部的宏观压力和温度与其微观原子结构（即氦原子与空位的比例$n/m$）联系起来[@problem_id:3702315]。掌握这种关系对于理解更高阶的成核和生长模型至关重要。", "problem": "在氘-氚（DT）聚变环境中，面向等离子体的钨壁会累积氦并形成纳米级的氦泡，这些氦泡通常被描述为 $\\text{He}_n\\text{V}_m$ 复合物，其中 $n$ 是氦原子的数量，$m$ 是构成空腔的空位数。考虑一个嵌入在钨中的单一球形 $\\text{He}_n\\text{V}_m$ 氦泡，其处于力学平衡状态，且外部静水压力可忽略不计。氦泡内部含有压力为 $p$、温度为 $T$ 的氦气。假设氦气足够稀薄，可以被视为理想单原子气体，氦泡的体积约等于 $m$ 个空位体积之和，并且氦泡的表面能引起的毛细作用与球体的力学平衡相符。\n\n已知：\n- 氦泡内部压力 $p = 1.20 \\times 10^{9}$ $\\mathrm{Pa}$，\n- 氦泡温度 $T = 1200$ $\\mathrm{K}$，\n- 钨中的空位体积 $\\Omega_{v} = 1.60 \\times 10^{-29}$ $\\mathrm{m}^{3}$，\n- 玻尔兹曼常数 $k_{B} = 1.380649 \\times 10^{-23}$ $\\mathrm{J/K}$。\n\n任务：\n1. 计算氦泡内的氦数密度，其定义为单位体积内的氦原子数，单位为 $\\mathrm{m}^{-3}$。将此中间结果四舍五入至三位有效数字。\n2. 利用力学平衡下空位的体积可加性以及氦数密度的定义，推导 $\\text{He}_n\\text{V}_m$ 复合物中每个空位的氦原子数（即 $n/m$）的解析表达式，并使用所给参数进行数值计算。将 $n/m$ 的最终值表示为一个纯数（无单位），并四舍五入至三位有效数字。\n\n在你的最终答案中，只报告 $n/m$ 的值。", "solution": "经严格评估，问题陈述有效。其科学基础在于材料科学和热力学原理，特别是与聚变反应堆材料中氦的行为相关。该问题提法明确，提供了推导唯一解所需的所有必要数据和明确假设（例如，理想气体行为、空位的体积可加性）。所给的物理量在所述场景的合理范围内。任务清晰，逻辑结构合理。\n\n按照问题陈述的要求，解答过程分两部分进行。\n\n首先，我们计算氦泡内的氦数密度 $\\rho_{He}$。问题陈述指出，氦气可被视为理想单原子气体。理想气体定律通过玻尔兹曼常数 $k_B$ 将压力 $p$、温度 $T$ 和数密度 $\\rho_{He}$ 联系起来：\n$$p = \\rho_{He} k_B T$$\n求解数密度 $\\rho_{He}$ 可得：\n$$\\rho_{He} = \\frac{p}{k_B T}$$\n我们已知以下数值：\n- 氦泡内部压力 $p = 1.20 \\times 10^{9}$ $\\mathrm{Pa}$\n- 氦泡温度 $T = 1200$ $\\mathrm{K}$\n- 玻尔兹曼常数 $k_{B} = 1.380649 \\times 10^{-23}$ $\\mathrm{J/K}$\n\n将这些数值代入 $\\rho_{He}$ 的表达式中：\n$$\\rho_{He} = \\frac{1.20 \\times 10^{9}}{(1.380649 \\times 10^{-23}) \\times 1200} \\ \\mathrm{m}^{-3}$$\n$$\\rho_{He} \\approx 7.2428 \\times 10^{28} \\ \\mathrm{m}^{-3}$$\n按照对中间结果的要求，四舍五入至三位有效数字可得：\n$$\\rho_{He} \\approx 7.24 \\times 10^{28} \\ \\mathrm{m}^{-3}$$\n\n其次，我们推导氦原子与空位之比 $n/m$ 的解析表达式，并进行数值计算。\n数密度 $\\rho_{He}$ 定义为单位体积 $V$ 内的氦原子数 $n$：\n$$\\rho_{He} = \\frac{n}{V}$$\n问题陈述指出，氦泡体积 $V$ 约等于构成它的 $m$ 个空位的体积之和。单个空位的体积为 $\\Omega_v$。因此，氦泡的总 体积为：\n$$V = m \\Omega_v$$\n将 $V$ 的这个表达式代入数密度的定义中可得：\n$$\\rho_{He} = \\frac{n}{m \\Omega_v}$$\n我们需要求出比率 $n/m$。重排上述方程可得所需的解析表达式：\n$$\\frac{n}{m} = \\rho_{He} \\Omega_v$$\n为了进行数值计算，我们代入从理想气体定律推导出的 $\\rho_{He}$ 的表达式：\n$$\\frac{n}{m} = \\left(\\frac{p}{k_B T}\\right) \\Omega_v$$\n我们使用给定的数值，包括钨中的空位体积 $\\Omega_v = 1.60 \\times 10^{-29}$ $\\mathrm{m}^3$。为了使最终结果具有更高的精度，我们使用未四舍五入的 $\\rho_{He}$ 值：\n$$\\frac{n}{m} = (7.2428... \\times 10^{28} \\ \\mathrm{m}^{-3}) \\times (1.60 \\times 10^{-29} \\ \\mathrm{m}^{3})$$\n$$\\frac{n}{m} \\approx 1.15885$$\n问题要求将最终值四舍五入至三位有效数字。\n$$\\frac{n}{m} \\approx 1.16$$\n正如预期，该比率是一个无量纲量。", "answer": "$$\\boxed{1.16}$$", "id": "3702315"}, {"introduction": "氦泡的形成是一个动态过程，其演化由复杂的反应动力学控制。本练习将指导您构建一个团簇动力学（Cluster Dynamics, CD）模型，这是一种在材料科学中用于模拟缺陷演化的强大计算工具[@problem_id:3702297]。通过亲手实现这个模型，您将深入了解原子尺度的参数（如结合能）和外部条件（如温度）如何共同决定气泡群的成核与生长速率。", "problem": "给定与核聚变等离子体面向部件相关的体心立方（BCC）难熔金属中，氦原子与单个晶格空位结合的密度泛函理论（DFT）计算的结合能。任务是利用这些结合能，为一个团簇动力学（Cluster Dynamics, CD）模型构建一套具有物理基础的参数，并量化氦泡成核对有效俘获能变化的敏感性。您的程序必须实现最终的团簇动力学速率方程，随时间对其进行积分，并报告几种测试用例下的气泡数密度。所有答案必须以每立方米（$\\mathrm{m}^{-3}$）为单位，表示为浮点数。\n\n基本原理和假设：\n- 从团簇生长步骤的正向（附着）和反向（发射）反应的细致平衡原理，以及球形吸收体的扩散限制反应速率出发。\n- 对扩散使用阿伦尼乌斯形式，对由结合能产生的平衡常数使用麦克斯韦-玻尔兹曼因子。\n- 团簇动力学模型追踪包含$n$个氦原子与单个空位（表示为$\\mathrm{V}\\text{--}\\mathrm{He}_n$）结合的团簇浓度$C_n(t)$，以及可移动的氦单体浓度$C_{\\mathrm{He}}(t)$。为便于计算，考虑$n$最大到有限值$N$。\n\n给定数据和参数构建：\n1. 提供了前四种尺寸$\\mathrm{V}\\text{--}\\mathrm{He}_n$的DFT结合能（针对一种代表性的等离子体面向金属），单位为电子伏特（$\\mathrm{eV}$）：\n   - $E_b(1) = 1.10$, $E_b(2) = 1.00$, $E_b(3) = 0.90$, $E_b(4) = 0.85$。\n2. 对于$n \\gt 4$，通过对数延续来定义$E_b(n)$，该延续能捕捉到随着团簇生长，额外氦原子结合能单调减弱的特性：\n   $$E_b(n) = \\max\\left(E_b(4) - \\alpha \\ln\\left(\\frac{n}{4}\\right),\\, E_{\\min}\\right),$$\n   其中 $\\alpha = 0.05$ 且 $E_{\\min} = 0.50$（两者单位均为$\\mathrm{eV}$）。\n3. 定义有效结合能为$E_b^{\\mathrm{eff}}(n) = E_b(n) + E_t$，其中$E_t$是一个可调的俘获能，用以解释外在的稳定效应（例如应力场、杂质或局部缺陷构型）。在测试套件中改变$E_t$以展示敏感性。\n4. 氦单体扩散系数遵循阿伦尼乌斯定律：\n   $$D_{\\mathrm{He}}(T) = D_0 \\exp\\left(-\\frac{E_m}{k_B T}\\right),$$\n   其中 $D_0 = 10^{-6}\\ \\mathrm{m}^2/\\mathrm{s}$，$E_m = 0.06\\ \\mathrm{eV}$，玻尔兹曼常数 $k_B = 8.617333262\\times 10^{-5}\\ \\mathrm{eV/K}$，绝对温度$T$单位为$\\mathrm{K}$。\n5. 对于尺寸为$n$的团簇，其扩散限制的氦捕获系数为：\n   $$k_n(T) = 4 \\pi D_{\\mathrm{He}}(T)\\, a_n,$$\n   其中捕获半径按$a_n = r_0 n^{1/3}$的规律变化，且$r_0 = 2.5\\times 10^{-10}\\ \\mathrm{m}$。\n6. 通过将$\\mathrm{V}\\text{--}\\mathrm{He}_n \\to \\mathrm{V}\\text{--}\\mathrm{He}_{n-1} + \\mathrm{He}$的发射系数$e_n(T)$与逆反应的附着系数通过$E_b^{\\mathrm{eff}}(n)$的平衡常数关联起来，来强制执行细致平衡：\n   $$e_n(T) = k_{n-1}(T)\\, c_{\\mathrm{ref}} \\exp\\left(-\\frac{E_b^{\\mathrm{eff}}(n)}{k_B T}\\right),\\quad n\\ge 2,$$\n   其中$c_{\\mathrm{ref}} = 1/\\Omega$为原子数密度，$\\Omega = 3.18\\times 10^{-29}\\ \\mathrm{m}^3$为原子体积（因此$c_{\\mathrm{ref}} \\approx 3.145\\times 10^{28}\\ \\mathrm{m}^{-3}$）。\n7. 对于$n = 1,\\dots,N$和单体，控制性的团簇动力学常微分方程（ODE）如下：\n   - 单体平衡：\n     $$\\frac{dC_{\\mathrm{He}}}{dt} = G - k_{\\mathrm{sink}} C_{\\mathrm{He}} - \\sum_{n=1}^{N} k_n C_n C_{\\mathrm{He}} + \\sum_{n=2}^{N} e_n C_n.$$\n   - 团簇平衡：\n     $$\\frac{dC_1}{dt} = -k_1 C_1 C_{\\mathrm{He}} + e_2 C_2,$$\n     $$\\frac{dC_n}{dt} = k_{n-1} C_{n-1} C_{\\mathrm{He}} - e_n C_n - k_n C_n C_{\\mathrm{He}} + e_{n+1} C_{n+1},\\quad 2\\le n\\le N-1,$$\n     $$\\frac{dC_N}{dt} = k_{N-1} C_{N-1} C_{\\mathrm{He}} - e_N C_N.$$\n   此处，$G$是单位体积的氦生成率，$k_{\\mathrm{sink}}$是单体沉陷率，代表了向扩展沉陷（如晶界和位错）的损失。假设团簇是不可移动的（没有团簇沉陷项）。\n8. 除非每个测试用例另有规定，否则使用以下固定参数：\n   - 最大团簇尺寸$N = 30$。\n   - 气泡阈值尺寸$n_{\\mathrm{bub}} = 10$；将气泡数密度报告为$\\sum_{n=n_{\\mathrm{bub}}}^{N} C_n$。\n   - 单体沉陷率$k_{\\mathrm{sink}} = 10^{3}\\ \\mathrm{s}^{-1}$。\n   - 氦生成率$G = 10^{20}\\ \\mathrm{m}^{-3}\\mathrm{s}^{-1}$。\n   - 初始条件：$C_{\\mathrm{He}}(0) = 0$，$C_1(0) = f_{\\mathrm{vac}} c_{\\mathrm{ref}}$，$C_n(0) = 0$对于$n\\ge 2$，其中$f_{\\mathrm{vac}} = 10^{-7}$是初始空位分数。\n\n任务：\n1. 使用提供的DFT值和对数延续方法，构建$n=1,\\dots,N$的$E_b(n)$。\n2. 对于每个测试用例，使用上述规则构建$k_n(T)$和$e_n(T)$，实现ODE系统，并使用刚性求解器从$t=0$数值积分到$t=t_{\\mathrm{end}}$。\n3. 计算在$t_{\\mathrm{end}}$时的气泡数密度，即$\\sum_{n=n_{\\mathrm{bub}}}^{N} C_n(t_{\\mathrm{end}})$，并以$\\mathrm{m}^{-3}$为单位表示。\n\n测试套件：\n- 案例1（无外在俘获的基准情况）：$T=900$, $E_t=0.00$, $G=10^{20}$, $t_{\\mathrm{end}}=1000$。\n- 案例2（中等俘获）：$T=900$, $E_t=0.20$, $G=10^{20}$, $t_{\\mathrm{end}}=1000$。\n- 案例3（强俘获）：$T=900$, $E_t=0.40$, $G=10^{20}$, $t_{\\mathrm{end}}=1000$。\n- 案例4（高温下的强俘获）：$T=1200$, $E_t=0.40$, $G=10^{20}$, $t_{\\mathrm{end}}=1000$。\n\n答案规格：\n- 对于每个测试用例，答案是$t_{\\mathrm{end}}$时气泡数密度的单个浮点数，单位为$\\mathrm{m}^{-3}$。\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔结果列表（例如，“[$r_1$,$r_2$,$r_3$,$r_4$]”），其中每个$r_i$是相应案例的气泡数密度，以$\\mathrm{m}^{-3}$为单位表示为浮点数。", "solution": "用户提供了一个计算材料科学领域中明确定义的问题，具体涉及金属中氦泡成核的建模。该问题具有科学依据，内部一致，并包含数值求解所需的所有信息。其方法基于团簇动力学（Cluster Dynamics, CD），这是一种用于追踪缺陷群体演化的标准介观尺度方法。解决方案涉及基于物理原理构建一套速率方程（一个常微分方程组，ODE），然后进行数值积分。\n\n验证步骤确认了问题的有效性：\n1.  **提取已知条件**：所有参数、方程和条件都在问题描述中明确说明。这些包括DFT结合能、其延续的函数形式、扩散的阿伦尼乌斯定律、基于扩散限制理论的反应速率表达式，以及团簇动力学速率方程的结构。\n2.  **验证**：\n    *   **科学依据**：该模型基于已建立的原理：扩散限制反应动力学（Smoluchowski理论）、连接正向和反向反应的热力学细致平衡，以及热激活过程的阿伦尼乌斯温度依赖性。这些都是材料物理动力学的基石。\n    *   **适定性**：该问题定义了一个一阶常微分方程组的初值问题。速率函数是良态的，确保可以找到唯一且稳定的数值解。\n    *   **客观性**：问题以精确的数学术语陈述，没有歧义或主观论断。\n    *   **完整性**：为四个测试用例提供了所有必需的常数、初始条件和参数。单位在量纲上是一致的。\n\n问题被认为是有效的，并按如下方式构建解决方案。\n\n**步骤1：团簇动力学模型的参数化**\n\n模型的核心是一套描述氦原子与空位-氦团簇（$\\mathrm{V}\\text{--}\\mathrm{He}_n$）之间反应速率的参数。这些参数源自提供的基本数据。\n\n首先，计算最后一个氦原子与$\\mathrm{V}\\text{--}\\mathrm{He}_n$团簇结合的结合能$E_b(n)$，涵盖从$1$到最大尺寸$N=30$的所有团簇尺寸。对于$n \\le 4$，使用给定的密度泛函理论（DFT）值：$E_b(1)=1.10 \\text{ eV}$，$E_b(2)=1.00 \\text{ eV}$，$E_b(3)=0.90 \\text{ eV}$，以及$E_b(4)=0.85 \\text{ eV}$。对于$n  4$，使用对数延续公式来模拟随着团簇变得更加受压，结合能减弱的现象：\n$$E_b(n) = \\max\\left(E_b(4) - \\alpha \\ln\\left(\\frac{n}{4}\\right),\\, E_{\\min}\\right)$$\n其中 $\\alpha = 0.05 \\text{ eV}$，下限值为$E_{\\min} = 0.50 \\text{ eV}$。\n然后定义一个有效结合能$E_b^{\\mathrm{eff}}(n) = E_b(n) + E_t$，其中$E_t$是一个可调的外在俘获能，在测试用例中会变化。\n\n其次，确定反应速率系数。正向反应是可移动的氦单体被团簇俘获：$\\mathrm{V}\\text{--}\\mathrm{He}_{n-1} + \\mathrm{He} \\to \\mathrm{V}\\text{--}\\mathrm{He}_n$。速率系数由球形吸收体的扩散限制模型给出：\n$$k_{n-1}(T) = 4 \\pi D_{\\mathrm{He}}(T)\\, a_{n-1}$$\n其中$a_{n-1} = r_0 (n-1)^{1/3}$是团簇的俘获半径（$r_0 = 2.5\\times 10^{-10}\\ \\mathrm{m}$），$D_{\\mathrm{He}}(T)$是氦扩散系数。$D_{\\mathrm{He}}(T)$遵循阿伦尼乌斯关系：\n$$D_{\\mathrm{He}}(T) = D_0 \\exp\\left(-\\frac{E_m}{k_B T}\\right)$$\n其中$D_0 = 10^{-6}\\ \\mathrm{m}^2/\\mathrm{s}$，迁移能$E_m = 0.06\\ \\mathrm{eV}$，玻尔兹曼常数$k_B=8.617333262 \\times 10^{-5}\\ \\mathrm{eV/K}$。\n\n第三，反向反应，即一个氦原子的热发射（$\\mathrm{V}\\text{--}\\mathrm{He}_n \\to \\mathrm{V}\\text{--}\\mathrm{He}_{n-1} + \\mathrm{He}$），由发射系数$e_n(T)$描述。该系数不是一个独立的参数，而是由细致平衡原理确定，以确保热力学一致性。它通过自由能的变化将$e_n$与逆反应的俘获系数$k_{n-1}$联系起来，其中自由能变化主要由结合能$E_b^{\\mathrm{eff}}(n)$决定：\n$$e_n(T) = k_{n-1}(T)\\, c_{\\mathrm{ref}} \\exp\\left(-\\frac{E_b^{\\mathrm{eff}}(n)}{k_B T}\\right)$$\n对于$n \\ge 2$。前置因子$c_{\\mathrm{ref}} = 1/\\Omega$是单位体积内的原子位点数，其中$\\Omega = 3.18\\times 10^{-29}\\ \\mathrm{m}^3$。\n\n**步骤2：常微分方程组的构建**\n\n可移动氦的浓度$C_{\\mathrm{He}}(t)$和各种尺寸团簇的浓度$C_n(t)$（对于$n=1,\\ldots,N$）的演化由一个耦合的一阶常微分方程组控制。设状态向量为$\\mathbf{C}(t) = [C_{\\mathrm{He}}, C_1, \\ldots, C_N]$。常微分方程组$\\frac{d\\mathbf{C}}{dt} = \\mathbf{f}(\\mathbf{C})$由以下部分给出：\n\n1.  **氦单体平衡**：可移动氦的浓度因外部生成（$G$）、向固定沉陷（如位错）的损失（$k_{\\mathrm{sink}}$）、被团簇俘获以及从团簇发射而变化。\n    $$\\frac{dC_{\\mathrm{He}}}{dt} = G - k_{\\mathrm{sink}} C_{\\mathrm{He}} - \\sum_{n=1}^{N} k_n C_n C_{\\mathrm{He}} + \\sum_{n=2}^{N} e_n C_n$$\n\n2.  **团簇平衡**：每种尺寸$C_n$的团簇浓度因形成它和消耗它的反应而改变。\n    *   对于$n=1$：\n        $$\\frac{dC_1}{dt} = -k_1 C_1 C_{\\mathrm{He}} + e_2 C_2$$\n    *   对于$2 \\le n \\le N-1$：\n        $$\\frac{dC_n}{dt} = \\left( k_{n-1} C_{n-1} C_{\\mathrm{He}} - e_n C_n \\right) - \\left( k_n C_n C_{\\mathrm{He}} - e_{n+1} C_{n+1} \\right)$$\n        这些项可分组为净通量：$(J_n) - (J_{n+1})$，其中$J_n$是从尺寸$n-1$生长到$n$的净速率。\n    *   对于$n=N$（模型中的最大尺寸）：\n        $$\\frac{dC_N}{dt} = k_{N-1} C_{N-1} C_{\\mathrm{He}} - e_N C_N$$\n        这个方程在团簇尺寸分布的上边界处充当一个沉陷，因为超过$N$的生长被截断。\n\n**步骤3：数值积分与求解**\n\n这个包含$N+1$个常微分方程的方程组是刚性的，意味着存在宽范围的时间尺度，从快速的氦扩散和俘获到缓慢的团簇生长。因此，需要一个适用于刚性系统的数值求解器，如Radau或BDF方法。该问题作为初值问题求解。在$t=0$时的初始条件是：\n*   $C_{\\mathrm{He}}(0) = 0$（初始无自由氦）\n*   $C_1(0) = f_{\\mathrm{vac}} c_{\\mathrm{ref}}$（一小部分原子位点，$f_{\\mathrm{vac}}=10^{-7}$，是准备俘获氦的单空位）\n*   $C_n(0) = 0$ 对于$n \\ge 2$（无预先存在的团簇）\n\n对于每个测试用例，使用相应的参数（$T$, $E_t$, $G$）来计算速率系数$k_n$和$e_n$。然后将常微分方程组从$t=0$积分到指定的结束时间$t_{\\mathrm{end}} = 1000 \\text{ s}$。\n\n最后，通过对足够大以被认为是稳定气泡的团簇浓度求和来计算总气泡数密度。阈值设定为$n_{\\mathrm{bub}} = 10$。每个测试用例的最终结果是：\n$$N_{\\mathrm{bubble}} = \\sum_{n=n_{\\mathrm{bub}}}^{N} C_n(t_{\\mathrm{end}})$$\n\n这个过程在提供的Python代码中实现，该代码循环遍历每个测试用例，执行积分，计算气泡密度，并按要求格式化输出。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Solves the cluster dynamics model for helium bubble nucleation.\n    \"\"\"\n\n    # --- Fixed physical and model parameters ---\n    N_max = 30  # Maximum cluster size\n    n_bub = 10  # Threshold size for a cluster to be a \"bubble\"\n    k_B = 8.617333262e-5  # Boltzmann constant in eV/K\n    D0 = 1e-6  # He diffusion pre-factor in m^2/s\n    E_m = 0.06  # He migration energy in eV\n    r0 = 2.5e-10  # Capture radius scaling factor in m\n    Omega = 3.18e-29  # Atomic volume in m^3\n    c_ref = 1.0 / Omega  # Atomic number density in m^-3\n    f_vac = 1e-7  # Initial vacancy fraction\n    k_sink = 1e3  # Monomer sink rate in s^-1\n\n    # --- Test suite definition ---\n    test_cases = [\n        # (T [K], E_t [eV], G [m^-3s^-1], t_end [s])\n        (900.0, 0.00, 1e20, 1000.0),\n        (900.0, 0.20, 1e20, 1000.0),\n        (900.0, 0.40, 1e20, 1000.0),\n        (1200.0, 0.40, 1e20, 1000.0),\n    ]\n\n    # --- Pre-calculate size-dependent binding energies E_b(n) ---\n    Eb = np.zeros(N_max)\n    Eb_dft = {1: 1.10, 2: 1.00, 3: 0.90, 4: 0.85}\n    alpha = 0.05\n    E_min = 0.50\n    for n in range(1, N_max + 1):\n        if n in Eb_dft:\n            Eb[n - 1] = Eb_dft[n]\n        else:\n            Eb[n - 1] = max(Eb_dft[4] - alpha * np.log(n / 4.0), E_min)\n\n    def get_ode_params(T, Et):\n        \"\"\"Calculates temperature-dependent reaction coefficients.\"\"\"\n        # Helium diffusion coefficient\n        D_He = D0 * np.exp(-E_m / (k_B * T))\n\n        # Capture coefficients k_n for V-He_n clusters\n        n_vals = np.arange(1, N_max + 1)\n        a_n = r0 * n_vals**(1 / 3.0)\n        k_n = 4.0 * np.pi * D_He * a_n\n\n        # Emission coefficients e_n from V-He_n clusters\n        Eb_eff = Eb + Et\n        e_n = np.zeros(N_max - 1)  # For n=2 to N_max\n        for n in range(2, N_max + 1):\n            # e_n corresponds to e_n[n-2]\n            # k_{n-1} corresponds to k_n[n-2]\n            # E_b^{eff}(n) corresponds to Eb_eff[n-1]\n            e_n[n - 2] = k_n[n - 2] * c_ref * np.exp(-Eb_eff[n - 1] / (k_B * T))\n\n        return k_n, e_n\n\n    def ode_system(t, C, G_case, k_sink_const, k, e):\n        \"\"\"Defines the system of ODEs for cluster dynamics.\"\"\"\n        dCdt = np.zeros_like(C)\n        C_He = C[0]\n        # C_clusters represents C_1, C_2, ..., C_N\n        C_clusters = C[1:]\n\n        # --- Monomer (C_He) Balance ---\n        # Net flux from capture by all clusters\n        he_capture_flux = np.sum(k * C_clusters * C_He)\n        # Total flux from emission from clusters C_2 to C_N\n        he_emission_flux = np.sum(e * C_clusters[1:])\n        dCdt[0] = G_case - k_sink_const * C_He - he_capture_flux + he_emission_flux\n\n        # --- Cluster Balances ---\n        # C_1 balance: dC1/dt = -k1*C1*C_He + e2*C2\n        dCdt[1] = -k[0] * C_clusters[0] * C_He + e[0] * C_clusters[1]\n\n        # C_2 to C_{N-1} balance: dCn/dt = J_n - J_{n+1}\n        # where J_n = k_{n-1}*C_{n-1}*C_He - e_n*C_n\n        for n in range(2, N_max):\n            # n is the cluster size, runs from 2 to N_max-1\n            # C[n] is C_clusters[n-1]\n            # k[n-1] is k_n\n            # e[n-2] is e_n\n            J_n = k[n - 2] * C_clusters[n - 2] * C_He - e[n - 2] * C_clusters[n - 1]\n            J_n_plus_1 = k[n - 1] * C_clusters[n - 1] * C_He - e[n - 1] * C_clusters[n]\n            dCdt[n] = J_n - J_n_plus_1\n\n        # C_N balance: dCN/dt = J_N\n        n = N_max\n        J_N = k[n - 2] * C_clusters[n - 2] * C_He - e[n - 2] * C_clusters[n - 1]\n        dCdt[n] = J_N\n\n        return dCdt\n\n    results = []\n    # --- Loop over test cases ---\n    for case in test_cases:\n        T_case, Et_case, G_case, t_end_case = case\n\n        # Calculate rate coefficients for the current case\n        k_coeffs, e_coeffs = get_ode_params(T_case, Et_case)\n\n        # Set initial conditions\n        C0 = np.zeros(N_max + 1)\n        C0[1] = f_vac * c_ref  # Initial concentration of V-He_1 (vacancies)\n\n        # Numerically integrate the ODE system\n        sol = solve_ivp(\n            fun=ode_system,\n            t_span=[0, t_end_case],\n            y0=C0,\n            method='Radau',  # Stiff solver\n            args=(G_case, k_sink, k_coeffs, e_coeffs),\n            dense_output=True\n        )\n\n        # Extract final concentrations at t_end\n        C_final = sol.sol(t_end_case)\n\n        # Calculate bubble number density (sum from n_bub to N_max)\n        # C_final[i] corresponds to C_i\n        bubble_density = np.sum(C_final[n_bub:])\n        results.append(bubble_density)\n\n    # Print results in the specified format\n    print(f\"[{','.join(f'{r:.8e}' for r in results)}]\")\n\nsolve()\n```", "id": "3702297"}, {"introduction": "理论模型在工程应用中的价值不仅在于其预测能力，还在于我们对其预测不确定性的理解。此练习将经典成核理论（Classical Nucleation Theory, CNT）与宏观肿胀现象联系起来，并引导您进行不确定性传播分析[@problem_id:3702308]。通过这个过程，您将学会如何量化输入参数（如表面能和结合能）的不确定性如何传递到最终的肿胀预测中，并识别出其中的关键影响因素。", "problem": "在核聚变材料中，氦注入会产生充满气体的空腔，其形核与生长会导致宏观肿胀和脆化。从经典形核理论 (CNT) 出发，对氦泡形核率和肿胀分数进行建模，并传播参数不确定性以预测肿胀的不确定性。使用围绕给定标称参数的线性化敏感性分析，并识别不确定性的主要贡献者。\n\n开始所用的基本定义和核心定义：\n- 设球形空洞的有效形核势垒由 CNT 结果给出：$$\\Delta G^\\ast = \\frac{16\\pi \\gamma^3}{3 \\Delta P^2},$$ 其中 $\\gamma$ 是泡-基体界面的有效表面能，$\\Delta P$ 是界面两侧的压力差。\n- 通过能量降低来纳入氦-空位结合的稳定作用，以获得有效势垒：$$\\Delta G_{\\mathrm{eff}} = \\Delta G^\\ast - \\alpha E_b,$$ 其中 $E_b$ 是氦-空位结合能，$\\alpha$ 是一个无量纲比例因子，代表参与形核的特征束缚氦原子数。使用以电子伏特为单位的能量单位 $E_b$，上下文隐含了到焦耳的转换。\n- 单位体积的形核率为 $$J = J_0 \\exp\\!\\left(-\\frac{\\Delta G_{\\mathrm{eff}}}{k_B T}\\right),$$ 其中 $J_0$ 是尝试前因子，$k_B$ 是 Boltzmann 常数，$T$ 是绝对温度。\n- 来自 CNT 的临界泡半径为 $$r^\\ast = \\frac{2\\gamma}{\\Delta P},$$ 相应的泡体积为 $$V_b = \\frac{4\\pi}{3} \\left(r^\\ast\\right)^3.$$\n- 在暴露时间 $\\tau$ 内，宏观肿胀分数定义为 $$S = N V_b,$$ 其中 $N = J \\tau$ 是在 $\\tau$ 期间形成的泡数密度。因此，$S$ 是一个无量纲的体积分数变化，应以小数形式报告。\n\n任务：\n1.  根据所提供的定义，推导出 $S$ 关于参数 $\\theta = [\\gamma, \\Delta P, E_b, T, J_0, \\tau]$ 和物理常数的闭式表达式。\n2.  推导在标称点处 $S$ 关于参数 $\\theta$ 的梯度 (雅可比矩阵) $\\nabla S$。\n3.  使用一阶不确定性传播，计算方差 $$\\mathrm{Var}(S) \\approx \\nabla S^\\top \\,\\Sigma\\, \\nabla S,$$ 其中 $\\Sigma$ 是 $\\theta$ 的协方差矩阵。将标准差 $\\sigma_S = \\sqrt{\\mathrm{Var}(S)}$ 报告为小数（无量纲）。\n4.  将传播的方差分解为对角参数贡献 $$\\mathrm{Var}_{\\mathrm{diag},i} = \\left(\\frac{\\partial S}{\\partial \\theta_i}\\right)^2 \\Sigma_{ii}$$ 和净非对角协方差贡献 $$\\mathrm{Var}_{\\mathrm{off}} = \\mathrm{Var}(S) - \\sum_i \\mathrm{Var}_{\\mathrm{diag},i}.$$ 计算对角贡献份额 $$w_i = \\frac{\\mathrm{Var}_{\\mathrm{diag},i}}{\\mathrm{Var}(S)}$$ 并且，为了识别主导贡献者，将主导贡献者定义为具有最大 $\\mathrm{Var}_{\\mathrm{diag},i}$ 的单个参数 $i$，或者如果 $\\mathrm{Var}_{\\mathrm{off}}$ 为正且超过每个 $\\mathrm{Var}_{\\mathrm{diag},i}$，则定义为“协方差”。在输出中，使用索引 $6$ 对“协方差”的主导地位进行编码；否则，使用主导参数的索引，遵循 $\\theta = [\\gamma, \\Delta P, E_b, T, J_0, \\tau] \\equiv [0,1,2,3,4,5]$ 的顺序。\n\n使用的常数：\n- Boltzmann 常数 $$k_B = 1.380649\\times 10^{-23}\\ \\mathrm{J/K}.$$\n- 电子伏特到焦耳的转换 $$1\\ \\mathrm{eV} = 1.602176634\\times 10^{-19}\\ \\mathrm{J}.$$\n- 设置稳定因子 $$\\alpha = 0.2.$$\n\n测试套件：\n提供三个测试用例，每个用例包含标称参数值和协方差矩阵 $\\Sigma$。\n\n-   用例 A（独立不确定性，标称条件）：\n    -   标称参数：$$\\gamma = 2.0\\ \\mathrm{J/m^2},\\quad \\Delta P = 3.0\\times 10^{10}\\ \\mathrm{Pa},\\quad E_b = 0.5\\ \\mathrm{eV},\\quad T = 1200\\ \\mathrm{K},\\quad J_0 = 1.0\\times 10^{20}\\ \\mathrm{m^{-3}s^{-1}},\\quad \\tau = 3600\\ \\mathrm{s}.$$\n    -   标准差：$$\\sigma_\\gamma = 0.10\\ \\mathrm{J/m^2},\\quad \\sigma_{\\Delta P} = 3.0\\times 10^9\\ \\mathrm{Pa},\\quad \\sigma_{E_b} = 0.05\\ \\mathrm{eV},\\quad \\sigma_T = 50\\ \\mathrm{K},\\quad \\sigma_{J_0} = 2.0\\times 10^{19}\\ \\mathrm{m^{-3}s^{-1}},\\quad \\sigma_\\tau = 600\\ \\mathrm{s}.$$\n    -   协方差矩阵：对角矩阵，元素为 $\\sigma_i^2$。\n\n-   用例 B（结合能主导的不确定性，较低温度）：\n    -   标称参数：$$\\gamma = 2.0\\ \\mathrm{J/m^2},\\quad \\Delta P = 2.5\\times 10^{10}\\ \\mathrm{Pa},\\quad E_b = 0.5\\ \\mathrm{eV},\\quad T = 900\\ \\mathrm{K},\\quad J_0 = 1.0\\times 10^{20}\\ \\mathrm{m^{-3}s^{-1}},\\quad \\tau = 3600\\ \\mathrm{s}.$$\n    -   标准差：$$\\sigma_\\gamma = 0.05\\ \\mathrm{J/m^2},\\quad \\sigma_{\\Delta P} = 2.0\\times 10^9\\ \\mathrm{Pa},\\quad \\sigma_{E_b} = 0.20\\ \\mathrm{eV},\\quad \\sigma_T = 30\\ \\mathrm{K},\\quad \\sigma_{J_0} = 1.0\\times 10^{19}\\ \\mathrm{m^{-3}s^{-1}},\\quad \\sigma_\\tau = 300\\ \\mathrm{s}.$$\n    -   协方差矩阵：对角矩阵，元素为 $\\sigma_i^2$。\n\n-   用例 C（表面能和压力差之间的强负相关）：\n    -   标称参数：$$\\gamma = 2.0\\ \\mathrm{J/m^2},\\quad \\Delta P = 3.0\\times 10^{10}\\ \\mathrm{Pa},\\quad E_b = 0.5\\ \\mathrm{eV},\\quad T = 1200\\ \\mathrm{K},\\quad J_0 = 1.0\\times 10^{20}\\ \\mathrm{m^{-3}s^{-1}},\\quad \\tau = 3600\\ \\mathrm{s}.$$\n    -   标准差：$$\\sigma_\\gamma = 0.10\\ \\mathrm{J/m^2},\\quad \\sigma_{\\Delta P} = 3.0\\times 10^9\\ \\mathrm{Pa},\\quad \\sigma_{E_b} = 0.05\\ \\mathrm{eV},\\quad \\sigma_T = 50\\ \\mathrm{K},\\quad \\sigma_{J_0} = 2.0\\times 10^{19}\\ \\mathrm{m^{-3}s^{-1}},\\quad \\sigma_\\tau = 600\\ \\mathrm{s}.$$\n    -   协方差矩阵：与用例 A 具有相同的对角元素，$\\gamma$ 和 $\\Delta P$ 之间存在系数为 $-0.8$ 的非对角相关性，即 $$\\Sigma_{\\gamma,\\Delta P} = \\Sigma_{\\Delta P,\\gamma} = -0.8\\,\\sigma_\\gamma\\,\\sigma_{\\Delta P},$$ 所有其他非对角元素为零。\n\n要求的计算和输出：\n-   对于每个测试用例，计算标准差 $\\sigma_S$（无量纲小数），对角贡献份额向量 $[w_0,w_1,w_2,w_3,w_4,w_5]$，以及如上指定的主导贡献者索引。\n-   您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，每个测试用例的结果格式为 $$[\\sigma_S,\\, \\text{dominant\\_index},\\, [w_0,w_1,w_2,w_3,w_4,w_5]]。$$", "solution": "## 问题验证\n\n该问题被评估为**有效的**。\n\n1.  **已知条件提取**：\n    -   有效形核势垒 (CNT)：$\\Delta G^\\ast = \\frac{16\\pi \\gamma^3}{3 \\Delta P^2}$\n    -   带结合能的有效势垒：$\\Delta G_{\\mathrm{eff}} = \\Delta G^\\ast - \\alpha E_b$\n    -   形核率：$J = J_0 \\exp(-\\frac{\\Delta G_{\\mathrm{eff}}}{k_B T})$\n    -   临界泡半径：$r^\\ast = \\frac{2\\gamma}{\\Delta P}$\n    -   临界泡体积：$V_b = \\frac{4\\pi}{3} (r^\\ast)^3$\n    -   宏观肿胀分数：$S = N V_b$，其中 $N = J \\tau$\n    -   分析参数：$\\theta = [\\gamma, \\Delta P, E_b, T, J_0, \\tau]$\n    -   方差公式：$\\mathrm{Var}(S) \\approx \\nabla S^\\top \\,\\Sigma\\, \\nabla S$\n    -   方差分解：$\\mathrm{Var}_{\\mathrm{diag},i} = (\\frac{\\partial S}{\\partial \\theta_i})^2 \\Sigma_{ii}$，$\\mathrm{Var}_{\\mathrm{off}} = \\mathrm{Var}(S) - \\sum_i \\mathrm{Var}_{\\mathrm{diag},i}$\n    -   贡献份额：$w_i = \\mathrm{Var}_{\\mathrm{diag},i}/\\mathrm{Var}(S)$\n    -   主导规则：主导贡献者是具有 $\\max(\\mathrm{Var}_{\\mathrm{diag},i})$ 的参数 $i$，除非 $\\mathrm{Var}_{\\mathrm{off}}  0$ 且 $\\mathrm{Var}_{\\mathrm{off}}  \\max(\\mathrm{Var}_{\\mathrm{diag},i})$，在这种情况下，它是“协方差”（索引 $6$）。\n    -   常数：$k_B=1.380649\\times 10^{-23}\\ \\mathrm{J/K}$，$1\\ \\mathrm{eV} = 1.602176634\\times 10^{-19}\\ \\mathrm{J}$，$\\alpha=0.2$。\n    -   三个测试用例（A, B, C），具有指定的标称参数、标准差和协方差结构。\n\n2.  **验证评估**：\n    -   **科学依据**：该问题基于经典形核理论 (CNT)，这是材料科学中用于建模相变的基石。包含结合能项是一种物理上合理的简化，用于解释气体-缺陷相互作用，这在先进材料建模中很常见。该问题在科学上是合理的。\n    -   **适定的**：该问题提供了一套完整的定义、参数和常数，从而为所要求的量（肿胀、其标准差和方差贡献）带来唯一、可确定的解。\n    -   **客观性**：该问题以精确的数学和物理术语陈述，没有歧义或主观性。任务是计算性和分析性的，完全基于所提供的框架。\n\n3.  **结论**：该问题是有效的。它是一个在应用物理模型以及执行敏感性与不确定性分析方面定义明确的练习。 “用例 B”的描述性名称可能看起来与计算结果不一致，但这并不构成问题数学前提中的形式上的矛盾。严格的分析必须遵循提供的方程，任何与描述性标题的差异都是一个发现，而不是一个缺陷。\n\n## 解答\n\n解答按要求的四个步骤进行：推导肿胀 $S$ 的表达式，计算其梯度 $\\nabla S$，执行不确定性传播，并识别不确定性的主导来源。\n\n### 1. 肿胀表达式 ($S$) 的推导\n\n肿胀分数 $S$ 是泡数密度 $N$ 与单个泡体积 $V_b$ 的乘积。我们分别为每个量推导表达式。\n泡体积 $V_b$ 取决于临界半径 $r^\\ast$：\n$$r^\\ast = \\frac{2\\gamma}{\\Delta P}$$\n$$V_b = \\frac{4\\pi}{3} (r^\\ast)^3 = \\frac{4\\pi}{3} \\left(\\frac{2\\gamma}{\\Delta P}\\right)^3 = \\frac{32\\pi \\gamma^3}{3 \\Delta P^3}$$\n泡数密度 $N$ 是形核率 $J$ 对时间 $\\tau$ 的积分，对于恒定速率，即为 $N=J\\tau$。速率 $J$ 由下式给出：\n$$J = J_0 \\exp\\left(-\\frac{\\Delta G_{\\mathrm{eff}}}{k_B T}\\right)$$\n有效能量势垒 $\\Delta G_{\\mathrm{eff}}$ 是：\n$$\\Delta G_{\\mathrm{eff}} = \\Delta G^\\ast - \\alpha E_b = \\frac{16\\pi \\gamma^3}{3 \\Delta P^2} - \\alpha E_b$$\n这里，$E_b$ 以电子伏特 (eV) 给出，必须通过乘以元电荷 $q_e=1.602176634\\times 10^{-19}\\ \\mathrm{J/eV}$ 转换为焦耳。\n将 $\\Delta G_{\\mathrm{eff}}$ 代入 $J$ 的表达式：\n$$J = J_0 \\exp\\left(-\\frac{1}{k_B T}\\left(\\frac{16\\pi \\gamma^3}{3 \\Delta P^2} - \\alpha q_e E_b\\right)\\right)$$\n最后，将这些组合起来求得 $S = J \\tau V_b$：\n$$S(\\theta) = J_0 \\tau \\left(\\frac{32\\pi \\gamma^3}{3 \\Delta P^3}\\right) \\exp\\left(\\frac{\\alpha q_e E_b}{k_B T} - \\frac{16\\pi \\gamma^3}{3 k_B T \\Delta P^2}\\right)$$\n这就是关于参数向量 $\\theta = [\\gamma, \\Delta P, E_b, T, J_0, \\tau]$ 的肿胀分数 $S$ 的闭式表达式。\n\n### 2. 梯度 ($\\nabla S$) 的推导\n\n我们计算 $S$ 关于 $\\theta$ 中每个参数的偏导数。为方便起见，令 $S = P_V \\exp(X)$，其中 $P_V = J_0 \\tau V_b = J_0 \\tau \\frac{32\\pi \\gamma^3}{3 \\Delta P^3}$ 是一个指前部分，而 $X = -\\frac{\\Delta G_{\\mathrm{eff}}}{k_B T} = \\frac{\\alpha q_e E_b}{k_B T} - \\frac{\\Delta G^*}{k_B T}$ 是指数部分的自变量。\n\n-   **关于 $\\gamma$ 的导数**：\n    使用乘法法则，并注意到 $P_V$ 和 $X$ 都依赖于 $\\gamma$：\n    $$\\frac{\\partial S}{\\partial \\gamma} = \\frac{\\partial P_V}{\\partial \\gamma} \\exp(X) + P_V \\exp(X) \\frac{\\partial X}{\\partial \\gamma} = S \\left( \\frac{1}{P_V} \\frac{\\partial P_V}{\\partial \\gamma} + \\frac{\\partial X}{\\partial \\gamma} \\right)$$\n    $$\\frac{1}{P_V}\\frac{\\partial P_V}{\\partial \\gamma} = \\frac{1}{\\gamma^3} (3\\gamma^2) = \\frac{3}{\\gamma} \\quad\\text{且}\\quad \\frac{\\partial X}{\\partial \\gamma} = -\\frac{1}{k_B T} \\frac{\\partial \\Delta G^*}{\\partial \\gamma} = -\\frac{1}{k_B T} \\frac{16\\pi (3\\gamma^2)}{3\\Delta P^2} = -\\frac{3}{\\gamma} \\frac{\\Delta G^*}{k_B T}$$\n    $$\\frac{\\partial S}{\\partial \\gamma} = S\\left(\\frac{3}{\\gamma} - \\frac{3}{\\gamma}\\frac{\\Delta G^*}{k_B T}\\right) = \\frac{3S}{\\gamma}\\left(1 - \\frac{\\Delta G^*}{k_B T}\\right)$$\n\n-   **关于 $\\Delta P$ 的导数**：\n    $$\\frac{1}{P_V}\\frac{\\partial P_V}{\\partial \\Delta P} = \\frac{1}{\\Delta P^{-3}}(-3\\Delta P^{-4}) = -\\frac{3}{\\Delta P} \\quad\\text{且}\\quad \\frac{\\partial X}{\\partial \\Delta P} = -\\frac{1}{k_B T}\\frac{\\partial \\Delta G^*}{\\partial \\Delta P} = -\\frac{1}{k_B T} \\frac{16\\pi\\gamma^3}{3}(-2\\Delta P^{-3}) = \\frac{2}{\\Delta P} \\frac{\\Delta G^*}{k_B T}$$\n    $$\\frac{\\partial S}{\\partial \\Delta P} = S\\left(-\\frac{3}{\\Delta P} + \\frac{2}{\\Delta P}\\frac{\\Delta G^*}{k_B T}\\right) = \\frac{S}{\\Delta P}\\left(-3 + \\frac{2\\Delta G^*}{k_B T}\\right)$$\n\n-   **关于 $E_b$ (以 eV 为单位) 的导数**：\n    只有 $X$ 依赖于 $E_b$。\n    $$\\frac{\\partial S}{\\partial E_b} = S \\frac{\\partial X}{\\partial E_b} = S \\frac{\\partial}{\\partial E_b}\\left(\\frac{\\alpha q_e E_b}{k_B T}\\right) = \\frac{S \\alpha q_e}{k_B T}$$\n\n-   **关于 $T$ 的导数**：\n    只有 $X$ 依赖于 $T$。令 $X = \\frac{K}{T}$，其中 $K = (\\alpha q_e E_b - \\Delta G^*)/k_B$。\n    $$\\frac{\\partial S}{\\partial T} = S \\frac{\\partial X}{\\partial T} = S \\left(-\\frac{K}{T^2}\\right) = -S \\frac{X}{T} = S \\frac{\\Delta G^* - \\alpha q_e E_b}{k_B T^2}$$\n\n-   **关于 $J_0$ 的导数**：\n    $S$ 与 $J_0$ 成正比。\n    $$\\frac{\\partial S}{\\partial J_0} = \\frac{S}{J_0}$$\n\n-   **关于 $\\tau$ 的导数**：\n    $S$ 与 $\\tau$ 成正比。\n    $$\\frac{\\partial S}{\\partial \\tau} = \\frac{S}{\\tau}$$\n\n梯度向量 $\\nabla S$ 是这六个偏导数组成的列向量。\n\n### 3. 不确定性传播与分解\n\n$S$ 的方差使用一阶泰勒展开（线性化不确定性传播）来计算：\n$$\\mathrm{Var}(S) \\approx \\nabla S^\\top \\,\\Sigma\\, \\nabla S$$\n其中 $\\nabla S$ 是在标称参数值处计算的梯度向量，$\\Sigma$ 是参数的 $6 \\times 6$ 协方差矩阵。标准差为 $\\sigma_S = \\sqrt{\\mathrm{Var}(S)}$。\n\n总方差被分解为来自单个参数方差（$\\Sigma$ 的对角项）和它们的协方差（$\\Sigma$ 的非对角项）的贡献。\n-   **对角贡献**：来自参数 $\\theta_i$ 的方差贡献为：\n    $$\\mathrm{Var}_{\\mathrm{diag},i} = \\left(\\frac{\\partial S}{\\partial \\theta_i}\\right)^2 \\Sigma_{ii} = \\left(\\frac{\\partial S}{\\partial \\theta_i}\\right)^2 \\sigma_i^2$$\n-   **非对角贡献**：来自所有协方差项的净贡献为：\n    $$\\mathrm{Var}_{\\mathrm{off}} = \\mathrm{Var}(S) - \\sum_{i=0}^{5} \\mathrm{Var}_{\\mathrm{diag},i}$$\n来自每个参数对角贡献的总方差的分数份额为：\n$$w_i = \\frac{\\mathrm{Var}_{\\mathrm{diag},i}}{\\mathrm{Var}(S)}$$\n\n### 4. 主导贡献者识别\n\n通过比较单个对角方差贡献（$\\mathrm{Var}_{\\mathrm{diag},i}$）和净非对角贡献（$\\mathrm{Var}_{\\mathrm{off}}$）的量级来识别不确定性的主导来源。\n1.  找到最大的对角贡献 $\\max(\\mathrm{Var}_{\\mathrm{diag},i})$ 及其对应的参数索引。\n2.  如果 $\\mathrm{Var}_{\\mathrm{off}}$ 为正且严格大于 $\\max(\\mathrm{Var}_{\\mathrm{diag},i})$，则主导来源是“协方差”，用索引 $6$ 编码。\n3.  否则，主导来源是具有最大对角贡献的参数，通过其索引 $0$ 到 $5$ 来识别。\n\n这些步骤将对提供的三个测试用例进行数值实现。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the helium bubble nucleation and swelling uncertainty problem.\n\n    The function processes three test cases, each with a unique set of nominal\n    parameters and uncertainties for helium bubble formation in a material.\n    For each case, it computes:\n    1. The standard deviation of the swelling fraction (sigma_S) using\n       linearized uncertainty propagation.\n    2. The dominant source of uncertainty, indexed 0-5 for parameters or 6 for\n       covariance.\n    3. The fractional contribution of each parameter's variance to the total\n       variance (w_i).\n\n    The final output is a single-line string representation of a list containing\n    the results for all test cases.\n    \"\"\"\n\n    # Physical and conversion constants\n    KB = 1.380649e-23  # Boltzmann constant in J/K\n    QE = 1.602176634e-19 # Electronvolt to Joule conversion\n    ALPHA = 0.2         # Dimensionless stabilization factor\n\n    # Test suite data\n    test_cases = [\n        # Case A: Independent uncertainties, nominal conditions\n        {\n            \"params\": np.array([2.0, 3.0e10, 0.5, 1200, 1.0e20, 3600]),\n            \"sigmas\": np.array([0.10, 3.0e9, 0.05, 50, 2.0e19, 600]),\n            \"corr\": None\n        },\n        # Case B: Binding-energy-dominated uncertainty, lower temperature\n        {\n            \"params\": np.array([2.0, 2.5e10, 0.5, 900, 1.0e20, 3600]),\n            \"sigmas\": np.array([0.05, 2.0e9, 0.20, 30, 1.0e19, 300]),\n            \"corr\": None\n        },\n        # Case C: Strong negative correlation (gamma, dP)\n        {\n            \"params\": np.array([2.0, 3.0e10, 0.5, 1200, 1.0e20, 3600]),\n            \"sigmas\": np.array([0.10, 3.0e9, 0.05, 50, 2.0e19, 600]),\n            \"corr\": {\"indices\": (0, 1), \"rho\": -0.8}\n        }\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        params = case[\"params\"]\n        sigmas = case[\"sigmas\"]\n        \n        # Unpack nominal parameters for clarity\n        gamma, dP, Eb_eV, T, J0, tau = params\n        Eb_J = Eb_eV * QE\n\n        # --- Step 1: Calculate nominal swelling S ---\n        dG_star = (16.0 * np.pi * gamma**3) / (3.0 * dP**2)\n        Vb = (32.0 * np.pi * gamma**3) / (3.0 * dP**3)\n        X = (ALPHA * Eb_J - dG_star) / (KB * T)\n        S = J0 * tau * Vb * np.exp(X)\n\n        # --- Step 2: Calculate the Jacobian (gradient) of S ---\n        grad_S = np.zeros(6)\n        # dS/d(gamma)\n        grad_S[0] = (3.0 * S / gamma) * (1.0 - dG_star / (KB * T))\n        # dS/d(Delta P)\n        grad_S[1] = (S / dP) * (-3.0 + 2.0 * dG_star / (KB * T))\n        # dS/d(E_b)\n        grad_S[2] = S * ALPHA * QE / (KB * T)\n        # dS/d(T)\n        grad_S[3] = S * (dG_star - ALPHA * Eb_J) / (KB * T**2)\n        # dS/d(J0)\n        grad_S[4] = S / J0\n        # dS/d(tau)\n        grad_S[5] = S / tau\n\n        # --- Step 3: Construct covariance matrix Sigma ---\n        Sigma = np.diag(sigmas**2)\n        if case[\"corr\"]:\n            i, j = case[\"corr\"][\"indices\"]\n            rho = case[\"corr\"][\"rho\"]\n            Sigma[i, j] = rho * sigmas[i] * sigmas[j]\n            Sigma[j, i] = Sigma[i, j]\n\n        # --- Step 4: Propagate uncertainty ---\n        var_S = grad_S.T @ Sigma @ grad_S\n        sigma_S = np.sqrt(var_S)\n\n        # --- Step 5: Decompose variance and find dominant contributor ---\n        var_diag = (grad_S**2) * np.diag(Sigma)\n        # Handle cases where var_S might be zero to avoid division by zero\n        if var_S > 0:\n            w = var_diag / var_S\n        else:\n            w = np.zeros(6)\n\n        var_off = var_S - np.sum(var_diag)\n        \n        max_diag_var = np.max(var_diag)\n        max_diag_idx = np.argmax(var_diag)\n        \n        if var_off > max_diag_var and var_off > 0:\n            dominant_idx = 6\n        else:\n            dominant_idx = max_diag_idx\n\n        # --- Format results for this case ---\n        w_str = f\"[{','.join([f'{wi:.6f}' for wi in w])}]\"\n        case_result_str = f\"[{sigma_S:.6e}, {dominant_idx}, {w_str}]\"\n        all_results.append(case_result_str)\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(all_results)}]\")\n\nsolve()\n```", "id": "3702308"}]}