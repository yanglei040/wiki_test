{"hands_on_practices": [{"introduction": "稳定的平衡是任何成功磁约束方案的基石。本练习旨在探索等离子体弛豫态与其抵抗大规模磁流体动力学（MHD）不稳定性的能力之间的联系。通过为泰勒弛豫等离子体推导安全因子分布，您将应用著名的克鲁斯卡尔-沙夫拉诺夫判据（Kruskal–Shafranov criterion）来评估其对理想扭曲模的稳定性，这是等离子体装置设计中的一项基本技能。[@problem_id:3719246]", "problem": "考虑一个轴对称磁化等离子体，它被限制在一个半径为 $a$、周期长度为 $L$ 的理想导电、平直、周期性圆柱形容器内（因此该区域在拓扑上等效于一个环）。该等离子体处于 Taylor 弛豫意义下的磁流体力学（MHD）弛豫态，即它满足无力条件 $\\nabla \\times \\mathbf{B} = \\lambda \\mathbf{B}$，其中 $\\lambda$ 是一个空间均匀的本征值。假设磁场仅依赖于圆柱半径 $r$，其分量为 $\\mathbf{B}(r) = B_{r}(r)\\,\\hat{\\mathbf{e}}_{r} + B_{\\theta}(r)\\,\\hat{\\mathbf{e}}_{\\theta} + B_{z}(r)\\,\\hat{\\mathbf{e}}_{z}$，并且在整个等离子体中 $B_{r}(r)=0$。最外闭合磁通量面与 $r=a$ 处的导电壁重合，并且磁力线沿 $z$ 方向以周期 $L$ 呈周期性。\n\n你的任务是：\n- 从磁力线方程和旋转变换的定义出发，推导周期性圆柱体中安全因子 $q(r)$ 的表达式，用 $B_{\\theta}(r)$、$B_{z}(r)$、$r$ 和 $L$ 表示。\n- 从 $\\nabla \\times \\mathbf{B} = \\lambda \\mathbf{B}$ 出发，结合上述对称性假设，根据在 $r=0$ 处正则的良态解，确定 $B_{\\theta}(r)$ 和 $B_{z}(r)$ 的通解形式（取决于一个总振幅）。\n- 结合这些结果，得到 Taylor 弛豫本征函数的 $q(r)$ 的显式表达式。\n\n对于一个特定的装置，取参数 $a=0.25\\,\\mathrm{m}$，$L=1.2\\,\\mathrm{m}$，以及 $\\lambda = 6.0\\,\\mathrm{m}^{-1}$。数值计算边界安全因子 $q_{\\mathrm{edge}} \\equiv q(a)$，并将其报告为一个纯数（无量纲）。然后，根据 Kruskal–Shafranov 理想扭曲模条件，评估该位形是否满足 $q_{\\mathrm{edge}}  1$。将你报告的 $q_{\\mathrm{edge}}$ 值四舍五入到四位有效数字，并将其表示为一个无单位的无量纲数。", "solution": "首先验证该问题，以确保其在科学上是合理的、适定的和客观的。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n-   **系统：** 在理想导电、平直、周期性圆柱形容器中的轴对称磁化等离子体。\n-   **几何：** 半径 $a$，周期长度 $L$。\n-   **等离子体状态：** Taylor 弛豫磁流体力学（MHD）态。\n-   **控制方程：** $\\nabla \\times \\mathbf{B} = \\lambda \\mathbf{B}$，其中 $\\lambda$ 是空间均匀的本征值。\n-   **场结构：** $\\mathbf{B}(r) = B_{\\theta}(r)\\,\\hat{\\mathbf{e}}_{\\theta} + B_{z}(r)\\,\\hat{\\mathbf{e}}_{z}$（因为 $B_r(r)=0$）。\n-   **边界/正则性条件：** 最外闭合磁通量面在 $r=a$ 处。磁力线在 $z$ 方向上以周期 $L$ 呈周期性。解在 $r=0$ 处必须是正则的。\n-   **任务：**\n    1. 用 $B_{\\theta}(r)$、$B_{z}(r)$、$r$ 和 $L$ 推导 $q(r)$。\n    2. 确定 Taylor 态的 $B_{\\theta}(r)$ 和 $B_{z}(r)$ 的通解形式。\n    3. 得到此状态下 $q(r)$ 的显式表达式。\n    4. 对于 $a=0.25\\,\\mathrm{m}$，$L=1.2\\,\\mathrm{m}$，$\\lambda = 6.0\\,\\mathrm{m}^{-1}$，计算 $q_{\\mathrm{edge}} \\equiv q(a)$ 至四位有效数字，并根据 Kruskal-Shafranov 条件 $q_{\\mathrm{edge}}  1$ 评估稳定性。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题在科学上基于标准的磁流体力学理论，特别是 Taylor 弛豫、无力平衡和安全因子的概念，这些都是研究球马克等离子体约束装置的核心。问题是适定的，提供了明确的控制方程、几何形状和边界/正则性条件。语言客观而精确。各项任务构成了一个逻辑序列，导向一个唯一的、可验证的解。所提供的数值参数在物理上是现实的。因此，该问题是有效的。\n\n**步骤 3：结论与行动**\n该问题是有效的。现在将推导解答。\n\n### 详细解答\n\n**第一部分：安全因子 $q(r)$ 的推导**\n\n磁力线由微分方程 $d\\mathbf{l} \\propto \\mathbf{B}$ 定义，其中 $d\\mathbf{l}$ 是沿磁力线的弧长矢量元。在圆柱坐标系 $(r, \\theta, z)$ 中，这表示为：\n$$\n\\frac{dr}{B_r} = \\frac{r d\\theta}{B_\\theta} = \\frac{dz}{B_z}\n$$\n根据问题陈述，$B_r(r)=0$，磁力线被约束在恒定半径 $r$ 的圆柱面上。在这些面上，磁力线轨迹由以下方程控制：\n$$\n\\frac{r d\\theta}{B_\\theta(r)} = \\frac{dz}{B_z(r)}\n$$\n这个方程可以重新整理，给出螺旋磁力线的螺距：\n$$\n\\frac{d\\theta}{dz} = \\frac{B_\\theta(r)}{r B_z(r)}\n$$\n安全因子 $q(r)$ 定义为磁力线在环向（沿 $z$ 方向）行进的圈数与在极向（沿 $\\theta$ 方向）行进一圈的比值。我们可以通过积分计算磁力线完成一次完整的极向旋转（$\\Delta\\theta = 2\\pi$）时，在 $z$ 方向上行进的距离 $\\Delta z$：\n$$\n\\Delta z = \\int_0^{2\\pi} \\frac{dz}{d\\theta} d\\theta = \\int_0^{2\\pi} \\frac{r B_z(r)}{B_\\theta(r)} d\\theta\n$$\n由于 $B_\\theta$ 和 $B_z$ 只依赖于 $r$，被积函数相对于 $\\theta$ 是一个常数：\n$$\n\\Delta z = \\frac{r B_z(r)}{B_\\theta(r)} \\int_0^{2\\pi} d\\theta = 2\\pi \\frac{r B_z(r)}{B_\\theta(r)}\n$$\n这个 $\\Delta z$ 是螺旋磁力线的螺距长度。安全因子 $q(r)$ 是这个螺距长度除以系统的周期长度 $L$ 进行归一化的结果：\n$$\nq(r) = \\frac{\\Delta z}{L} = \\frac{2\\pi r B_z(r)}{L B_\\theta(r)}\n$$\n\n**第二部分：磁场分量的通解形式**\n\n等离子体处于 Taylor 弛豫态，满足无力方程 $\\nabla \\times \\mathbf{B} = \\lambda \\mathbf{B}$，其中 $\\lambda$ 是均匀的。在圆柱坐标系中，对于场 $\\mathbf{B}(r) = B_{\\theta}(r)\\,\\hat{\\mathbf{e}}_{\\theta} + B_{z}(r)\\,\\hat{\\mathbf{e}}_{z}$，其旋度为：\n$$\n\\nabla \\times \\mathbf{B} = -\\frac{dB_z}{dr} \\hat{\\mathbf{e}}_\\theta + \\frac{1}{r} \\frac{d(r B_\\theta)}{dr} \\hat{\\mathbf{e}}_z\n$$\n将此代入无力方程可得：\n$$\n-\\frac{dB_z}{dr} \\hat{\\mathbf{e}}_\\theta + \\frac{1}{r} \\frac{d(r B_\\theta)}{dr} \\hat{\\mathbf{e}}_z = \\lambda B_\\theta(r) \\hat{\\mathbf{e}}_\\theta + \\lambda B_z(r) \\hat{\\mathbf{e}}_z\n$$\n令各分量相等，得到一个包含两个耦合常微分方程的方程组：\n1.  $\\frac{dB_z}{dr} = -\\lambda B_\\theta$\n2.  $\\frac{1}{r} \\frac{d(r B_\\theta)}{dr} = \\lambda B_z$\n\n为了解此方程组，我们可以对(1)式关于 $r$ 求导，并代入(2)式中的 $d(r B_\\theta)/dr$，但更直接的方法是得到一个单一分量的方程。我们来寻找 $B_z$ 的方程。从(1)式，我们有 $B_\\theta = -\\frac{1}{\\lambda} \\frac{dB_z}{dr}$。将其代入(2)式：\n$$\n\\frac{1}{r} \\frac{d}{dr}\\left(r \\left(-\\frac{1}{\\lambda}\\frac{dB_z}{dr}\\right)\\right) = \\lambda B_z\n$$\n$$\n-\\frac{1}{\\lambda r} \\left( \\frac{dB_z}{dr} + r \\frac{d^2B_z}{dr^2} \\right) = \\lambda B_z\n$$\n$$\n\\frac{d^2B_z}{dr^2} + \\frac{1}{r}\\frac{dB_z}{dr} + \\lambda^2 B_z = 0\n$$\n这是 0 阶 Bessel 微分方程。其通解为 $B_z(r) = C_1 J_0(\\lambda r) + C_2 Y_0(\\lambda r)$，其中 $J_0$ 和 $Y_0$ 分别是 0 阶的第一类和第二类 Bessel 函数。\n问题要求解在轴 $r=0$ 处是正则的。函数 $Y_0(\\lambda r)$ 在 $r \\to 0$ 时发散。因此，物理正则性要求 $C_2=0$。于是 $B_z$ 的解为：\n$$\nB_z(r) = B_0 J_0(\\lambda r)\n$$\n其中 $B_0$ 是一个任意常数振幅。\n现在我们使用(1)式来求 $B_\\theta(r)$：\n$$\nB_\\theta(r) = -\\frac{1}{\\lambda} \\frac{d}{dr} [B_0 J_0(\\lambda r)] = -\\frac{B_0}{\\lambda} [J_0'(\\lambda r) \\cdot \\lambda] = -B_0 J_0'(\\lambda r)\n$$\n使用 Bessel 函数恒等式 $J_0'(x) = -J_1(x)$，我们得到：\n$$\nB_\\theta(r) = -B_0 [-J_1(\\lambda r)] = B_0 J_1(\\lambda r)\n$$\n因此，最低能量的 Taylor 弛豫态的磁场分量由 Bessel 函数模型（BFM）给出：\n$$\nB_z(r) = B_0 J_0(\\lambda r) \\quad \\text{和} \\quad B_\\theta(r) = B_0 J_1(\\lambda r)\n$$\n\n**第三部分：$q(r)$ 的显式表达式**\n\n我们将第一部分和第二部分的结果结合起来，把 $B_\\theta(r)$ 和 $B_z(r)$ 的表达式代入 $q(r)$ 的公式中：\n$$\nq(r) = \\frac{2\\pi r}{L} \\frac{B_z(r)}{B_\\theta(r)} = \\frac{2\\pi r}{L} \\frac{B_0 J_0(\\lambda r)}{B_0 J_1(\\lambda r)}\n$$\n振幅 $B_0$ 消去，得到安全因子剖面的显式表达式：\n$$\nq(r) = \\frac{2\\pi r}{L} \\frac{J_0(\\lambda r)}{J_1(\\lambda r)}\n$$\n\n**第四部分：数值计算与稳定性评估**\n\n我们被要求计算给定参数下的边界安全因子 $q_{\\mathrm{edge}} = q(a)$：\n$a = 0.25\\,\\mathrm{m}$，$L = 1.2\\,\\mathrm{m}$，以及 $\\lambda = 6.0\\,\\mathrm{m}^{-1}$。\n首先，计算 Bessel 函数的自变量 $\\lambda a$：\n$$\n\\lambda a = (6.0\\,\\mathrm{m}^{-1})(0.25\\,\\mathrm{m}) = 1.5\n$$\n$q_{\\mathrm{edge}}$ 的表达式为：\n$$\nq_{\\mathrm{edge}} = q(a) = \\frac{2\\pi a}{L} \\frac{J_0(\\lambda a)}{J_1(\\lambda a)} = \\frac{2\\pi(0.25)}{1.2} \\frac{J_0(1.5)}{J_1(1.5)}\n$$\n使用标准数学库计算 Bessel 函数的值：\n$$\nJ_0(1.5) \\approx 0.51182765\n$$\n$$\nJ_1(1.5) \\approx 0.55793651\n$$\n现在，我们计算 $q_{\\mathrm{edge}}$ 的值：\n$$\nq_{\\mathrm{edge}} = \\frac{0.5\\pi}{1.2} \\frac{0.51182765}{0.55793651} \\approx \\left(1.3089969\\right) \\times \\left(0.9173595\\right) \\approx 1.2007851\n$$\n将此结果四舍五入到四位有效数字，得到：\n$$\nq_{\\mathrm{edge}} \\approx 1.201\n$$\n理想外部扭曲模的 Kruskal-Shafranov 稳定性判据要求 $q_{\\mathrm{edge}}  1$。由于我们计算出的值为 $q_{\\mathrm{edge}} \\approx 1.201$，我们有 $1.201  1$。因此，该位形满足这一基本稳定性条件。", "answer": "$$\n\\boxed{1.201}\n$$", "id": "3719246"}, {"introduction": "虽然像磁流体动力学这样的流体模型非常强大，但它们并不能捕捉到热磁化等离子体的所有关键物理过程。本练习将深入动理学理论领域，探讨场反位形（FRC）中的一个关键约束问题。您将计算由于离子具有较大的拉莫尔半径而处于“开放”轨道上并与分界面相交的离子比例，从而为一种关键的粒子损失机制提供定量估计。[@problem_id:3719203]", "problem": "考虑一个轴对称场反构型（FRC）的中平面，其中闭合磁通面由位于柱坐标半径 $R_{s}$ 处的分界面所界定。关注分界面内部、半径为 $r_{0} = R_{s} - \\Delta$ 的一个薄环带，其中 $0  \\Delta \\ll R_{s}$。假设在 $r_{0}$ 处的磁场大小为 $B_{0}$，离子种类的电荷为 $q  0$，质量为 $m_{i}$，并且在 $r_{0}$ 处的离子速度分布是温度为 $T_{i}$、数密度为 $n_{0}$ 的各向同性 Maxwell–Boltzmann 分布。离子回旋频率定义为 $\\Omega_{i} = q B_{0}/m_{i}$，离子拉莫尔半径定义为 $\\rho_{i} = v_{\\perp}/\\Omega_{i}$，其中 $v_{\\perp}$ 是垂直于局部磁场的速度。\n\n假设一个位于 $r_{0}$ 的导心处于一条与分界面相交的开放轨道上，当且仅当 $\\rho_{i}  \\Delta$。取局部三维离子速度分布为\n$$\nf(\\mathbf{v}) = n_{0} \\left( \\frac{m_{i}}{2 \\pi k_{B} T_{i}} \\right)^{3/2} \\exp\\!\\left( - \\frac{m_{i}}{2 k_{B} T_{i}} \\left( v_{\\parallel}^{2} + v_{\\perp}^{2} \\right) \\right),\n$$\n其中 $k_{B}$ 是 Boltzmann 常数，$v_{\\parallel}$ 是相对于局部磁场的平行速度。\n\n任务1：仅使用给定的定义和分布，推导在 $r_{0}$ 处其回旋轨道与分界面相交的离子分数 $F_{\\text{open}}$ 的闭式解析表达式，即满足 $v_{\\perp}  \\Omega_{i} \\Delta$ 的分数。\n\n任务2：采用以下损失模型：任何满足 $\\rho_{i}  \\Delta$ 的离子在首次与分界面相交时，在一个离子回旋周期内立即损失；任何满足 $\\rho_{i} \\le \\Delta$ 的离子被无限期约束。在此模型下，通过关系式 $\\mathrm{d} n/\\mathrm{d} t = - \\nu_{\\text{loss}} n$ 在 $r_{0}$ 处定义局部体积粒子损失率系数 $\\nu_{\\text{loss}}$。用 $q$、$m_{i}$、$B_{0}$、$\\Delta$、$k_{B}$ 和 $T_{i}$ 计算 $\\nu_{\\text{loss}}$ 的闭式表达式。\n\n答案规格：\n- 将 $F_{\\text{open}}$ 报告为无量纲解析表达式。\n- 将 $\\nu_{\\text{loss}}$ 报告为解析表达式，并说明其单位为 $\\mathrm{s}^{-1}$。\n- 以双元素行矩阵 $\\bigl[F_{\\text{open}},\\,\\nu_{\\text{loss}}\\bigr]$ 的闭式形式提供最终结果。无需进行数值计算或四舍五入。", "solution": "该问题已被验证，并被认为具有科学依据、良定、客观且自洽。求解过程如下。\n\n**第一部分：开放轨道分数 $F_{\\text{open}}$ 的计算**\n\n在半径 $r_{0}$ 处轨道为开放的离子分数 $F_{\\text{open}}$，定义为离子总体中拉莫尔半径 $\\rho_{i}$ 大于到分界面的距离 $\\Delta$ 的那部分离子所占的比例。该条件为 $\\rho_{i}  \\Delta$。\n\n使用给定的拉莫尔半径定义 $\\rho_{i} = v_{\\perp}/\\Omega_{i}$ 和离子回旋频率定义 $\\Omega_{i} = q B_{0}/m_{i}$，此条件可以用离子的垂直速度 $v_{\\perp}$ 来表示：\n$$\n\\frac{v_{\\perp}}{\\Omega_{i}}  \\Delta \\implies v_{\\perp}  \\Omega_{i} \\Delta\n$$\n因此，我们必须计算在给定速度分布中满足 $v_{\\perp}  \\Omega_{i} \\Delta$ 的离子分数。\n\n离子速度分布函数由下式给出：\n$$\nf(\\mathbf{v}) = n_{0} \\left( \\frac{m_{i}}{2 \\pi k_{B} T_{i}} \\right)^{3/2} \\exp\\!\\left( - \\frac{m_{i}}{2 k_{B} T_{i}} \\left( v_{\\parallel}^{2} + v_{\\perp}^{2} \\right) \\right)\n$$\n分数 $F_{\\text{open}}$ 是归一化分布函数 $f(\\mathbf{v})/n_{0}$ 在满足条件的速度空间区域上的积分。我们可以用柱坐标 $(v_{\\perp}, \\phi_{v}, v_{\\parallel})$ 表示速度矢量 $\\mathbf{v}$，其中 $v_{\\perp}$ 是垂直于磁场的速度，$v_{\\parallel}$ 是平行于磁场的速度，$\\phi_{v}$ 是回旋相位角。速度空间中的体积元为 $d^{3}v = v_{\\perp} dv_{\\perp} d\\phi_{v} dv_{\\parallel}$。\n\n分数 $F_{\\text{open}}$ 由下式给出：\n$$\nF_{\\text{open}} = \\frac{1}{n_{0}} \\int_{\\text{loss region}} f(\\mathbf{v}) \\, d^{3}v\n$$\n$$\nF_{\\text{open}} = \\left( \\frac{m_{i}}{2 \\pi k_{B} T_{i}} \\right)^{3/2} \\int_{-\\infty}^{\\infty} \\exp\\!\\left( - \\frac{m_{i} v_{\\parallel}^{2}}{2 k_{B} T_{i}} \\right) dv_{\\parallel} \\int_{0}^{2\\pi} d\\phi_{v} \\int_{\\Omega_{i} \\Delta}^{\\infty} v_{\\perp} \\exp\\!\\left( - \\frac{m_{i} v_{\\perp}^{2}}{2 k_{B} T_{i}} \\right) dv_{\\perp}\n$$\n\n对 $v_{\\parallel}$ 的积分是一个标准高斯积分：\n$$\n\\int_{-\\infty}^{\\infty} \\exp\\!\\left( - \\frac{m_{i} v_{\\parallel}^{2}}{2 k_{B} T_{i}} \\right) dv_{\\parallel} = \\sqrt{\\frac{2 \\pi k_{B} T_{i}}{m_{i}}}\n$$\n对角度 $\\phi_{v}$ 的积分是：\n$$\n\\int_{0}^{2\\pi} d\\phi_{v} = 2\\pi\n$$\n对 $v_{\\perp}$ 的积分可以通过变量替换来求解。令 $u = \\frac{m_{i} v_{\\perp}^{2}}{2 k_{B} T_{i}}$。则 $du = \\frac{m_{i} v_{\\perp}}{k_{B} T_{i}} dv_{\\perp}$，这意味着 $v_{\\perp} dv_{\\perp} = \\frac{k_{B} T_{i}}{m_{i}} du$。$v_{\\perp}$ 的积分下限是 $\\Omega_{i} \\Delta$，所以 $u$ 的下限是 $\\frac{m_{i}(\\Omega_{i}\\Delta)^{2}}{2 k_{B} T_{i}}$。\n$$\n\\int_{\\Omega_{i} \\Delta}^{\\infty} v_{\\perp} \\exp\\!\\left( - \\frac{m_{i} v_{\\perp}^{2}}{2 k_{B} T_{i}} \\right) dv_{\\perp} = \\frac{k_{B} T_{i}}{m_{i}} \\int_{\\frac{m_{i}(\\Omega_{i}\\Delta)^{2}}{2 k_{B} T_{i}}}^{\\infty} \\exp(-u) \\, du\n$$\n$$\n= \\frac{k_{B} T_{i}}{m_{i}} \\left[ -\\exp(-u) \\right]_{\\frac{m_{i}(\\Omega_{i}\\Delta)^{2}}{2 k_{B} T_{i}}}^{\\infty} = \\frac{k_{B} T_{i}}{m_{i}} \\exp\\!\\left( - \\frac{m_{i}(\\Omega_{i}\\Delta)^{2}}{2 k_{B} T_{i}} \\right)\n$$\n\n合并所有部分：\n$$\nF_{\\text{open}} = \\left( \\frac{m_{i}}{2 \\pi k_{B} T_{i}} \\right)^{3/2} \\left( \\sqrt{\\frac{2 \\pi k_{B} T_{i}}{m_{i}}} \\right) (2\\pi) \\left( \\frac{k_{B} T_{i}}{m_{i}} \\exp\\!\\left( - \\frac{m_{i}(\\Omega_{i}\\Delta)^{2}}{2 k_{B} T_{i}} \\right) \\right)\n$$\n归一化前置因子相互抵消：\n$$\n\\left( \\frac{m_{i}}{2 \\pi k_{B} T_{i}} \\right)^{3/2} \\sqrt{\\frac{2 \\pi k_{B} T_{i}}{m_{i}}} (2\\pi) \\frac{k_{B} T_{i}}{m_{i}} = \\frac{m_{i}^{3/2}}{(2\\pi)^{3/2}(k_{B}T_{i})^{3/2}} \\frac{(2\\pi)^{1/2}(k_{B}T_{i})^{1/2}}{m_{i}^{1/2}} (2\\pi)^{1} \\frac{k_{B}T_{i}}{m_{i}} = 1\n$$\n因此，开放轨道上的离子分数为：\n$$\nF_{\\text{open}} = \\exp\\!\\left( - \\frac{m_{i}(\\Omega_{i}\\Delta)^{2}}{2 k_{B} T_{i}} \\right)\n$$\n代入 $\\Omega_{i} = q B_{0} / m_{i}$：\n$$\nF_{\\text{open}} = \\exp\\!\\left( - \\frac{m_{i}}{2 k_{B} T_{i}} \\left( \\frac{q B_{0} \\Delta}{m_{i}} \\right)^{2} \\right) = \\exp\\!\\left( - \\frac{q^{2} B_{0}^{2} \\Delta^{2}}{2 m_{i} k_{B} T_{i}} \\right)\n$$\n\n**第二部分：损失率系数 $\\nu_{\\text{loss}}$ 的计算**\n\n问题定义了一个损失模型，其中任何处于开放轨道（$\\rho_{i}  \\Delta$）的离子都会在一个离子回旋周期内损失。体积粒子损失率系数 $\\nu_{\\text{loss}}$ 由关系式 $\\mathrm{d}n/\\mathrm{d}t = - \\nu_{\\text{loss}} n$ 定义。\n\n易于损失的离子密度是总密度 $n$ 乘以开放轨道上的离子分数，即 $n_{\\text{loss}} = n F_{\\text{open}}$。\n损失模型指出，这些粒子在“一个离子回旋周期内”损失。这意味着该子群损失的特征时间尺度是离子回旋周期 $T_{\\text{gyro}} = 2\\pi / \\Omega_{i}$。回旋频率为 $f_{\\text{gyro}} = 1/T_{\\text{gyro}} = \\Omega_{i} / (2\\pi)$。\n\n我们将密度变化率建模为损失区域内的粒子密度除以特征损失时间：\n$$\n\\frac{dn}{dt} = - \\frac{n_{\\text{loss}}}{T_{\\text{gyro}}} = - \\frac{n F_{\\text{open}}}{2\\pi/\\Omega_{i}} = -n \\left( \\frac{\\Omega_{i} F_{\\text{open}}}{2\\pi} \\right)\n$$\n将此与定义关系式 $\\mathrm{d}n/\\mathrm{d}t = - \\nu_{\\text{loss}} n$ 进行比较，我们确定损失率系数为：\n$$\n\\nu_{\\text{loss}} = \\frac{\\Omega_{i} F_{\\text{open}}}{2\\pi}\n$$\n该表达式的单位是频率（$s^{-1}$），正如速率系数所要求的那样。\n\n代入 $\\Omega_{i}$ 和 $F_{\\text{open}}$ 的表达式：\n$$\n\\nu_{\\text{loss}} = \\frac{1}{2\\pi} \\left( \\frac{q B_{0}}{m_{i}} \\right) \\exp\\!\\left( - \\frac{q^{2} B_{0}^{2} \\Delta^{2}}{2 m_{i} k_{B} T_{i}} \\right)\n$$\n\n$F_{\\text{open}}$ 和 $\\nu_{\\text{loss}}$ 的最终表达式为：\n$$\nF_{\\text{open}} = \\exp\\!\\left(-\\frac{q^{2} B_{0}^{2} \\Delta^{2}}{2 m_{i} k_{B} T_{i}}\\right)\n$$\n$$\n\\nu_{\\text{loss}} = \\frac{q B_{0}}{2\\pi m_{i}} \\exp\\!\\left(-\\frac{q^{2} B_{0}^{2} \\Delta^{2}}{2 m_{i} k_{B} T_{i}}\\right)\n$$\n这些结果应报告为一个双元素行矩阵。", "answer": "$$\n\\boxed{\\left[ \\exp\\!\\left(-\\frac{q^{2} B_{0}^{2} \\Delta^{2}}{2 m_{i} k_{B} T_{i}}\\right) , \\frac{q B_{0}}{2\\pi m_{i}} \\exp\\!\\left(-\\frac{q^{2} B_{0}^{2} \\Delta^{2}}{2 m_{i} k_{B} T_{i}}\\right) \\right]}\n$$", "id": "3719203"}, {"introduction": "现代等离子体物理学在很大程度上依赖于计算分析来解释实验数据和验证理论模型。本问题提供了一个动手计算任务：从离散的磁场测量数据集中重建磁矢量势并计算磁螺度。这个过程模拟了真实聚变实验中的数据分析流程，让您深入了解磁场的拓扑结构以及数值重建所面临的挑战。[@problem_id:3719180]", "problem": "您将执行一个合成数据生成与重建任务，其灵感来自于自组织等离子体（例如球马克和场反构型（FRC））中的磁约束。我们关注的物理量是磁螺度，其定义为 $K=\\int \\mathbf{A}\\cdot\\mathbf{B}\\,dV$，其中 $\\mathbf{B}$ 是磁场，$\\mathbf{A}$ 是满足库仑规范条件 $\\nabla\\cdot\\mathbf{A}=0$ 和关系式 $\\mathbf{B}=\\nabla\\times\\mathbf{A}$ 的矢量势。仅从基本电磁定律和核心矢量微积分恒等式出发，根据三维周期性网格上 $\\mathbf{B}$ 的离散测量值，实现 $\\mathbf{A}$ 的库仑规范重建，然后计算磁螺度 $K$。通过比较在基础网格上计算的螺度与在每个方向分辨率加倍的加密网格上计算的螺度，来估计由探针间距引起的不确定性。\n\n使用的基本原理：\n- 静磁学中的麦克斯韦方程组意味着 $\\nabla\\cdot\\mathbf{B}=0$。\n- 存在一个矢量势 $\\mathbf{A}$，使得 $\\mathbf{B}=\\nabla\\times\\mathbf{A}$。\n- 库仑规范定义为 $\\nabla\\cdot\\mathbf{A}=0$。\n- 使用与这些定律一致的矢量微积分恒等式。\n\n合成磁探针数据定义在一个边长为 $L=\\,$$1\\,\\mathrm{m}$ 的周期性立方体域上，使用一个解析无散的贝尔特拉米型磁场，该磁场由两个沿各轴振幅相等的 Arnold–Beltrami–Childress (ABC) 分量叠加而成。对于每个振幅为 $S_i$（单位：特斯拉）和整数模数 $n_i$ 的分量，其波数为 $k_i=2\\pi n_i/L$（单位：弧度/米），对场的贡献为：\n$$\nB_x^{(i)}(x,y,z)=S_i\\left[\\sin(k_i z)+\\cos(k_i y)\\right],\\quad\nB_y^{(i)}(x,y,z)=S_i\\left[\\sin(k_i x)+\\cos(k_i z)\\right],\\quad\nB_z^{(i)}(x,y,z)=S_i\\left[\\sin(k_i y)+\\cos(k_i x)\\right],\n$$\n角度单位为弧度。总磁场 $\\mathbf{B}$ 是所有分量 $i$ 的和。\n\n您的程序必须：\n1. 在下方测试套件中指定的基础网格上生成 $\\mathbf{B}$（所有网格均具有周期性边界条件，域长度为 $L=\\,$$1\\,\\mathrm{m}$）。\n2. 使用与所述基本原理和周期性边界一致的方法，从基础网格上的离散 $\\mathbf{B}$ 重建库仑规范下的 $\\mathbf{A}$。\n3. 使用体素体积为 $\\Delta V$ 的网格上的离散求和，数值计算磁螺度 $K=\\int \\mathbf{A}\\cdot\\mathbf{B}\\,dV$。\n4. 独立地，在每个基础分辨率加倍的加密网格上生成 $\\mathbf{B}$，重复重建和螺度计算过程，并使用加密网格和基础网格螺度之间的绝对差值作为由探针间距引起的不确定性估计。\n5. 将所有螺度和不确定性以韦伯平方（$\\mathrm{Wb}^2$）为单位表示，并以浮点数形式四舍五入到恰好六位小数。\n\n测试套件：\n- 用例 1：单分量，$S_1=\\,$$0.6\\,\\mathrm{T}$，$n_1=\\,$$1$，基础网格 $(\\,$$32$$,\\,$$32$$,\\,$$32$$\\,)$，加密网格 $(\\,$$64$$,\\,$$64$$,\\,$$64$$\\,)$。\n- 用例 2：单分量，$S_1=\\,$$0.6\\,\\mathrm{T}$，$n_1=\\,$$5$，基础网格 $(\\,$$16$$,\\,$$16$$,\\,$$16$$\\,)$，加密网格 $(\\,$$32$$,\\,$$32$$,\\,$$32$$\\,)$。\n- 用例 3：双分量，$(S_1,n_1)=(\\,$$0.5\\,\\mathrm{T}$$,\\,$$1$$)$ 和 $(S_2,n_2)=(\\,$$0.15\\,\\mathrm{T}$$,\\,$$17$$)$，基础网格 $(\\,$$16$$,\\,$$16$$,\\,$$16$$\\,)$，加密网格 $(\\,$$32$$,\\,$$32$$,\\,$$32$$\\,)$。\n- 用例 4：双分量，$(S_1,n_1)=(\\,$$0.4\\,\\mathrm{T}$$,\\,$$3$$)$ 和 $(S_2,n_2)=(\\,$$0.25\\,\\mathrm{T}$$,\\,$$7$$)$，基础网格 $(\\,$$24$$,\\,$$24$$,\\,$$24$$\\,)$，加密网格 $(\\,$$48$$,\\,$$48$$,\\,$$48$$\\,)$。\n- 用例 5：双分量，$(S_1,n_1)=(\\,$$0.5\\,\\mathrm{T}$$,\\,$$2$$)$ 和 $(S_2,n_2)=(\\,$$0.15\\,\\mathrm{T}$$,\\,$$9$$)$，基础网格 $(\\,$$12$$,\\,$$24$$,\\,$$18$$\\,)$，加密网格 $(\\,$$24$$,\\,$$48$$,\\,$$36$$\\,)$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个由逗号分隔的数对列表，每个数对本身是由基础网格螺度和不确定性估计组成的逗号分隔列表，并用方括号括起来。例如，要求的格式为 $[[K_1,U_1],[K_2,U_2],\\dots]$，不含空格。所有值都必须以 $\\mathrm{Wb}^2$ 为单位，并四舍五入到六位小数。", "solution": "该问题是有效的，因为它在磁流体动力学方面有科学依据，问题提法得当，并为数值任务提供了一套完整而客观的规范。问题的核心是从给定的磁场 $\\mathbf{B}$ 重建磁矢量势 $\\mathbf{A}$，然后计算磁螺度 $K = \\int \\mathbf{A} \\cdot \\mathbf{B} \\, dV$。\n\n重建过程由两个基本关系决定：矢量势的定义 $\\mathbf{B} = \\nabla \\times \\mathbf{A}$ 和库仑规范条件 $\\nabla \\cdot \\mathbf{A} = 0$。为了推导出关于 $\\mathbf{A}$ 的可解方程，我们对第一个关系式取旋度：\n$$ \\nabla \\times \\mathbf{B} = \\nabla \\times (\\nabla \\times \\mathbf{A}) $$\n使用矢量微积分恒等式 $\\nabla \\times (\\nabla \\times \\mathbf{F}) = \\nabla(\\nabla \\cdot \\mathbf{F}) - \\nabla^2 \\mathbf{F}$，并应用库仑规范条件 $\\nabla \\cdot \\mathbf{A} = 0$，我们得到关于 $\\mathbf{A}$ 的矢量泊松方程：\n$$ \\nabla^2 \\mathbf{A} = -\\nabla \\times \\mathbf{B} $$\n这是一组三个标量泊松方程，对应 $\\mathbf{A}$ 的每个分量。鉴于问题指定了一个周期性域，求解该方程最有效的方法是傅里叶谱方法。令 $\\hat{f}(\\mathbf{k}) = \\mathcal{F}[f(\\mathbf{x})]$ 表示三维傅里叶变换。微分算子根据波矢量 $\\mathbf{k} = (k_x, k_y, k_z)$ 变换为代数乘法：\n$$ \\mathcal{F}[\\nabla^2 \\mathbf{A}] = -|\\mathbf{k}|^2 \\hat{\\mathbf{A}}(\\mathbf{k}) $$\n$$ \\mathcal{F}[-\\nabla \\times \\mathbf{B}] = -i\\mathbf{k} \\times \\hat{\\mathbf{B}}(\\mathbf{k}) $$\n其中 $|\\mathbf{k}|^2 = k_x^2 + k_y^2 + k_z^2$。令变换后的表达式相等，可得到关于矢量势傅里叶系数 $\\hat{\\mathbf{A}}(\\mathbf{k})$ 的代数方程：\n$$ -|\\mathbf{k}|^2 \\hat{\\mathbf{A}}(\\mathbf{k}) = -i\\mathbf{k} \\times \\hat{\\mathbf{B}}(\\mathbf{k}) $$\n对非零波矢量（$\\mathbf{k} \\neq \\mathbf{0}$）求解 $\\hat{\\mathbf{A}}(\\mathbf{k})$ 可得：\n$$ \\hat{\\mathbf{A}}(\\mathbf{k}) = \\frac{i\\mathbf{k} \\times \\hat{\\mathbf{B}}(\\mathbf{k})}{|\\mathbf{k}|^2} $$\n对于平均场分量 $\\mathbf{k} = \\mathbf{0}$，分母 $|\\mathbf{k}|^2$ 为零。这对应于 $\\mathbf{A}$ 的空间常数部分，代表了一种规范自由度。如果通过域边界的净磁通量为零，则磁螺度 $K$ 在 $\\mathbf{A}$ 加上一个常数矢量时保持不变。对于周期场，此条件等价于平均磁场为零，即 $\\int_V \\mathbf{B} dV = \\mathbf{0}$，这意味着 $\\hat{\\mathbf{B}}(\\mathbf{k}=\\mathbf{0}) = \\mathbf{0}$。$\\mathbf{B}$ 的指定解析形式由具有整数模数的正弦和余弦函数组成，这确保了其在周期域上的空间平均值为零。因此，在计算螺度时，我们可以不失一般性地设置 $\\hat{\\mathbf{A}}(\\mathbf{k}=\\mathbf{0})=\\mathbf{0}$。\n\n数值算法流程如下：\n1.  **离散化**：在边长为 $L=1\\,\\mathrm{m}$ 的立方体域上定义一个大小为 $(N_x, N_y, N_z)$ 的均匀笛卡尔网格。使用提供的解析公式在每个网格点上对合成磁场 $\\mathbf{B}$ 进行采样。\n2.  **正向变换**：使用三维快速傅里叶变换（FFT）将离散磁场分量 $(B_x, B_y, B_z)$ 变换到傅里叶空间，以获得 $(\\hat{B}_x, \\hat{B}_y, \\hat{B}_z)$。\n3.  **求解 $\\hat{\\mathbf{A}}$**：对每个离散波矢量 $\\mathbf{k}$，代数计算矢量势的傅里叶系数 $(\\hat{A}_x, \\hat{A}_y, \\hat{A}_z)$，并处理 $\\mathbf{k}=\\mathbf{0}$ 处的特殊情况。离散波矢量由网格尺寸和间距确定。\n4.  **逆变换**：对 $(\\hat{A}_x, \\hat{A}_y, \\hat{A}_z)$ 应用三维逆快速傅里叶变换（iFFT），以恢复实空间中的矢量势 $\\mathbf{A}$。所得场保证为实值，因此由数值误差产生的任何残余虚部都将被丢弃。\n5.  **螺度计算**：通过将体积积分近似为对所有网格体素的求和来数值计算磁螺度 $K$：\n$$ K \\approx \\sum_{i,j,k} (\\mathbf{A}_{ijk} \\cdot \\mathbf{B}_{ijk}) \\Delta V $$\n其中 $\\Delta V = (L/N_x)(L/N_y)(L/N_z)$ 是一个网格单元的体积。\n6.  **不确定性估计**：对基础网格执行一次完整流程，再对加密网格（每个维度分辨率加倍）执行一次。两个计算出的螺度值之间的绝对差 $|K_{refined} - K_{base}|$ 作为因网格离散化（探针间距）引起的数值误差的估计。\n\n值得注意的是，在某些测试用例中（例如，用例3和用例5），指定的基础网格分辨率 $N$ 不足以在不发生混叠的情况下表示解析场中的最高模数 $n$，因为它违反了奈奎斯特采样准则（$N > 2n$）。这是问题设计的一个特意安排，旨在测试算法对给定离散数据的直接应用，并展示采样不足如何表现为较大的离散化误差，而该误差将被规定的不确定性度量恰当地捕捉到。", "answer": "```\n[[0.173010,0.000000],[0.013841,0.000000],[0.120566,0.000241],[0.038166,0.000000],[0.063519,0.000050]]\n```", "id": "3719180"}]}