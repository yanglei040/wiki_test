{"hands_on_practices": [{"introduction": "经验标度律是预测聚变装置性能的基石。本练习旨在通过计算对数敏感度，帮助您快速评估对约束影响最大的“控制杠杆”，这是分析实验和设计新装置的一项关键技能。通过这个练习，您将发现一个关于幂律模型的重要特性，即变量的对数敏感度就是其自身的指数 [@problem_id:3698228]。", "problem": "磁约束聚变装置的一个核心品质因数是能量约束时间，记为 $\\,\\tau_{E}\\,$，其定义为 $\\,\\tau_{E} \\equiv W/P_{\\text{loss}}\\,$，其中 $\\,W\\,$ 是等离子体的总热能含量，$\\,P_{\\text{loss}}\\,$ 是等离子体的净功率损失。多装置回归研究已经确定，在托卡马克于氘-氚相关条件下的宽泛运行域内，$\\,\\tau_{E}\\,$ 可以通过一组独立的装置和等离子体控制参数 $\\,\\{x_{i}\\}\\,$ 的可分离幂律形式很好地近似，其具有一个恒定前置因子 $\\,C\\,$ 和实指数 $\\,\\{a_{i}\\}\\,$：\n$$\n\\tau_{E} \\sim C \\prod_{i} x_{i}^{a_{i}}.\n$$\n为本题目的，设独立控制参数为\n$$\nx_{1}=I_{p},\\quad x_{2}=B_{T},\\quad x_{3}=\\bar{n}_{e},\\quad x_{4}=P,\\quad x_{5}=R,\\quad x_{6}=\\varepsilon,\\quad x_{7}=\\kappa,\\quad x_{8}=M,\n$$\n其中 $\\,I_{p}\\,$ 是等离子体电流，$\\,B_{T}\\,$ 是环向磁场，$\\,\\bar{n}_{e}\\,$ 是线平均电子密度，$\\,P\\,$ 是穿过分界面的净加热功率，$\\,R\\,$ 是大半径，$\\,\\varepsilon \\equiv a/R\\,$ 是反环径比（其中 $\\,a\\,$ 为小半径），$\\,\\kappa\\,$ 是等离子体拉长比，$\\,M\\,$ 是以原子质量单位计的有效离子质量。给定最近的拟合得出以下指数：\n$$\na_{1}=0.93,\\quad a_{2}=0.15,\\quad a_{3}=0.41,\\quad a_{4}=-0.69,\\quad a_{5}=1.97,\\quad a_{6}=0.58,\\quad a_{7}=0.78,\\quad a_{8}=0.19.\n$$\n考虑一个装置在以下条件下运行：\n$$\nI_{p}=15\\ \\text{MA},\\quad B_{T}=5.3\\ \\text{T},\\quad \\bar{n}_{e}=1.0\\times 10^{20}\\ \\text{m}^{-3},\\quad P=100\\ \\text{MW},\\quad R=6.20\\ \\text{m},\\quad a=2.00\\ \\text{m},\\quad \\kappa=1.80,\\quad M=2.50,\n$$\n因此 $\\,\\varepsilon=a/R\\,$ 由 $\\,a\\,$ 和 $\\,R\\,$ 固定。仅使用上述基本定义和标准微积分，计算约束时间相对于每个控制参数的对数敏感度（弹性），\n$$\n\\left.\\frac{\\partial \\ln \\tau_{E}}{\\partial \\ln x_{i}}\\right|_{\\text{在所述运行点}},\\qquad i=1,\\dots,8,\n$$\n并按 $\\,\\big(I_{p},B_{T},\\bar{n}_{e},P,R,\\varepsilon,\\kappa,M\\big)\\,$ 的顺序列为一个单行向量。将你的敏感度四舍五入到三位有效数字。然后，根据它们的大小和符号，在你的推理中指明哪些控制参数在该运行点上最强烈地主导约束预测，并说明原因。你最终报告的向量必须是无量纲的。最终的数值向量中不要包含任何单位。", "solution": "该问题要求计算托卡马克能量约束时间 $\\tau_{E}$ 相对于一组指定控制参数的对数敏感度（或弹性）。\n\n首先，必须评估问题陈述的有效性。\n\n### 步骤1：提取已知条件\n给定的信息如下：\n- 能量约束时间的定义：$\\tau_{E} \\equiv W/P_{\\text{loss}}$\n- 经验标度律形式：$\\tau_{E} \\sim C \\prod_{i} x_{i}^{a_{i}}$，其中 $C$ 是一个常数，$\\{a_i\\}$ 是实指数。\n- 独立控制参数集 $\\{x_i\\}$ 被确定为：\n  $x_{1}=I_{p}$ (等离子体电流)\n  $x_{2}=B_{T}$ (环向磁场)\n  $x_{3}=\\bar{n}_{e}$ (线平均电子密度)\n  $x_{4}=P$ (净加热功率)\n  $x_{5}=R$ (大半径)\n  $x_{6}=\\varepsilon \\equiv a/R$ (反环径比，其中 $a$ 是小半径)\n  $x_{7}=\\kappa$ (等离子体拉长比)\n  $x_{8}=M$ (有效离子质量)\n- 指数 $\\{a_i\\}$ 的值为：\n  $a_{1}=0.93$\n  $a_{2}=0.15$\n  $a_{3}=0.41$\n  $a_{4}=-0.69$\n  $a_{5}=1.97$\n  $a_{6}=0.58$\n  $a_{7}=0.78$\n  $a_{8}=0.19$\n- 给定一个装置的具体运行点：\n  $I_{p}=15\\ \\text{MA}$\n  $B_{T}=5.3\\ \\text{T}$\n  $\\bar{n}_{e}=1.0\\times 10^{20}\\ \\text{m}^{-3}$\n  $P=100\\ \\text{MW}$\n  $R=6.20\\ \\text{m}$\n  $a=2.00\\ \\text{m}$\n  $\\kappa=1.80$\n  $M=2.50$\n- 问题指出 $\\varepsilon=a/R$ 由 $a$ 和 $R$ 决定。\n- 任务是计算在所述运行点上，对于 $i=1,\\dots,8$ 的对数敏感度 $\\left.\\frac{\\partial \\ln \\tau_{E}}{\\partial \\ln x_{i}}\\right|_{\\text{在所述运行点}}$。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题在核聚变领域有科学依据，特别是关于托卡马克的经验约束标度律，这是该领域的标准工具。这些变量及其典型影响（例如，随功率下降）与实验结果一致。该问题是客观且量化明确的。\n\n该问题是适定的。它提供了一个八变量函数 $\\tau_{E}(x_1, \\dots, x_8)$，并要求计算其对数偏导数。要计算的量是弹性：\n$$\nE_{\\tau_E, x_i} \\equiv \\frac{\\partial \\ln \\tau_{E}}{\\partial \\ln x_{i}}\n$$\n尽管问题陈述指出 $\\varepsilon = a/R$，但它明确定义了标度律的独立控制参数集为 $\\{I_p, B_T, \\bar{n}_e, P, R, \\varepsilon, \\kappa, M\\}$。这指定了 $\\tau_E$ 作为这八个变量的函数形式。根据定义，计算偏导数 $\\partial / \\partial \\ln x_i$ 时，会将函数参数列表中的所有其他变量视为常数。因此，$R$、$a$ 和 $\\varepsilon$ 之间的物理关系不进入该特定函数形式的偏导数计算中。该问题是自洽的，并且在陈述上数学一致。所提供的运行点数据，对于最终计算可能需要，也可能不需要。\n\n因此，该问题被认为是有效的。\n\n### 解答\n能量约束时间 $\\tau_E$ 由以下幂律标度关系给出：\n$$\n\\tau_{E} = C I_{p}^{a_{1}} B_{T}^{a_{2}} \\bar{n}_{e}^{a_{3}} P^{a_{4}} R^{a_{5}} \\varepsilon^{a_{6}} \\kappa^{a_{7}} M^{a_{8}}\n$$\n其中 $C$ 是一个比例常数，指数 $\\{a_i\\}$ 已给出。\n\n需要计算的量是 $\\tau_E$ 相对于每个控制变量 $x_i$ 的对数敏感度（或弹性），定义为 $\\frac{\\partial \\ln \\tau_E}{\\partial \\ln x_i}$。这个量衡量的是，在保持所有其他变量不变的情况下，$x_i$ 发生百分之一的变化时，$\\tau_E$ 发生的百分比变化。\n\n为了方便求导，我们首先对 $\\tau_E$ 的表达式取自然对数：\n$$\n\\ln \\tau_{E} = \\ln \\left( C I_{p}^{a_{1}} B_{T}^{a_{2}} \\bar{n}_{e}^{a_{3}} P^{a_{4}} R^{a_{5}} \\varepsilon^{a_{6}} \\kappa^{a_{7}} M^{a_{8}} \\right)\n$$\n利用对数的性质，该表达式可以展开为和的形式：\n$$\n\\ln \\tau_{E} = \\ln(C) + a_{1}\\ln(I_{p}) + a_{2}\\ln(B_{T}) + a_{3}\\ln(\\bar{n}_{e}) + a_{4}\\ln(P) + a_{5}\\ln(R) + a_{6}\\ln(\\varepsilon) + a_{7}\\ln(\\kappa) + a_{8}\\ln(M)\n$$\n现在，我们计算 $\\ln \\tau_E$ 相对于每个控制变量 $x_i$ 的自然对数的偏导数。让我们考虑集合 $\\{I_p, B_T, \\dots, M\\}$ 中的任意控制参数 $x_j$ 的一般情况。\n$$\n\\frac{\\partial \\ln \\tau_{E}}{\\partial \\ln x_{j}} = \\frac{\\partial}{\\partial \\ln x_{j}} \\left( \\ln(C) + \\sum_{i=1}^{8} a_{i} \\ln(x_{i}) \\right)\n$$\n由于和的偏导数是偏导数的和，且 $\\ln(C)$ 是一个常数：\n$$\n\\frac{\\partial \\ln \\tau_{E}}{\\partial \\ln x_{j}} = \\frac{\\partial (\\ln C)}{\\partial \\ln x_{j}} + \\sum_{i=1}^{8} a_{i} \\frac{\\partial (\\ln x_{i})}{\\partial \\ln x_{j}}\n$$\n常数项的导数为零。在这个公式中，变量 $\\ln(x_i)$ 是独立的。因此，偏导数 $\\frac{\\partial (\\ln x_{i})}{\\partial \\ln x_{j}}$ 等于克罗内克δ函数 $\\delta_{ij}$，当 $i=j$ 时为 $1$，当 $i \\neq j$ 时为 $0$。\n$$\n\\frac{\\partial \\ln \\tau_{E}}{\\partial \\ln x_{j}} = 0 + \\sum_{i=1}^{8} a_{i} \\delta_{ij} = a_{j}\n$$\n这证明了幂律模型的一个基本性质：相对于给定变量的对数敏感度（弹性）就是它在幂律中的指数。这个结果是一个常数，与具体的运行点无关。因此，计算中不需要 $I_p$、$B_T$ 等的数值。\n\n问题要求的是这些敏感度的向量，它们就是指数本身，四舍五入到三位有效数字。给定的指数是：\n$a_{1} = 0.93$ (对于 $I_p$)\n$a_{2} = 0.15$ (对于 $B_T$)\n$a_{3} = 0.41$ (对于 $\\bar{n}_e$)\n$a_{4} = -0.69$ (对于 $P$)\n$a_{5} = 1.97$ (对于 $R$)\n$a_{6} = 0.58$ (对于 $\\varepsilon$)\n$a_{7} = 0.78$ (对于 $\\kappa$)\n$a_{8} = 0.19$ (对于 $M$)\n\n将每个值四舍五入到三位有效数字：\n$a_{1} = 0.930$\n$a_{2} = 0.150$\n$a_{3} = 0.410$\n$a_{4} = -0.690$\n$a_{5} = 1.97$\n$a_{6} = 0.580$\n$a_{7} = 0.780$\n$a_{8} = 0.190$\n\n最终得到的敏感度行向量，按照指定的顺序 $\\big(I_{p},B_{T},\\bar{n}_{e},P,R,\\varepsilon,\\kappa,M\\big)$，是：\n$$\n\\begin{pmatrix} 0.930  0.150  0.410  -0.690  1.97  0.580  0.780  0.190 \\end{pmatrix}\n$$\n关于哪些控制参数最强烈地主导约束预测，我们必须检查这些敏感度的绝对值。更大的绝对值意味着对 $\\tau_E$ 的影响更强。\n- 最大的绝对值是 $|a_5| = 1.97$，对应于大半径 $R$。这是最主导的参数。正号表示增加大半径会显著改善约束（$\\tau_E \\propto R^{1.97}$）。这通常被概括为“越大越好”。\n- 第二大的绝对值是 $|a_1| = 0.930$，对应于等离子体电流 $I_p$。约束几乎与等离子体电流成线性正比（$\\tau_E \\propto I_p^{0.930}$），更高的电流是有利的。\n- 第三大的绝对值是 $|a_7| = 0.780$，对应于等离子体拉长比 $\\kappa$。更高的拉长比（即一个更垂直拉伸的等离子体）能改善约束。\n- 第四大的绝对值是 $|a_4| = |-0.690| = 0.690$，对应于加热功率 $P$。符号为负，表示当向等离子体中注入更多功率时，约束会*退化*（$\\tau_E \\propto P^{-0.690}$）。这是聚变研究中的一个关键观察。\n\n总之，约束时间 $\\tau_E$ 对大半径 $R$ 最为敏感，其次是等离子体电流 $I_p$、等离子体拉长比 $\\kappa$ 和加热功率 $P$。装置的尺寸（$R$）对其性能有着最深远的影响。", "answer": "$$\n\\boxed{\\begin{pmatrix} 0.930  0.150  0.410  -0.690  1.97  0.580  0.780  0.190 \\end{pmatrix}}\n$$", "id": "3698228"}, {"introduction": "虽然约束标度律是经验性的，但它们通常受到物理理论的指导并需要通过物理理论进行检验。本练习通过引导您从基本的输运模型（玻姆和回旋玻姆模型）中推导同位素质量标度，从而在理论和实验之间架起一座桥梁。这个过程对于深化我们对输运物理的理解以及利用实验数据验证或排除简单的理论模型至关重要 [@problem_id:3698149]。", "problem": "一个由氢同位素（氢、氘、氚）组成的托卡马克等离子体，其同位素质量为 $M$，在固定的磁场 $B$、大半径 $R$、小半径 $a$、体积 $V$、线平均密度 $n$ 和吸收的加热功率 $P$ 下运行。假设离子具有单一温度 $T$，且电子与离子近似达到热平衡，因此 $T_{e} \\approx T_{i} \\equiv T$。总热能为 $W = \\frac{3}{2}\\,n\\,T\\,V$，能量约束时间定义为 $\\tau_{E} = W/P$。在以扩散为主导的平衡中，全局能量约束时间的标度关系为 $\\tau_{E} \\sim L^{2}/\\chi$，其中 $L \\sim a$，$\\chi$ 是有效湍流热扩散系数。\n\n考虑两种广泛使用的唯象输运标度律：\n- 类 Bohm 扩散系数，$\\chi_{B} = C_{B}\\,T/(e\\,B)$，其中 $e$ 是元电荷，$C_{B}$ 是一个与 $M$ 无关的无量纲常数。\n- 类 gyro-Bohm 扩散系数，$\\chi_{gB} = C_{gB}\\,\\rho_{i}^{2}\\,v_{thi}/a$，其中 $C_{gB}$ 与 $M$ 无关，$v_{thi} = \\sqrt{2T/M}$ 是离子热速度，$\\Omega_{ci} = eB/M$ 是离子回旋频率，$\\rho_{i} = v_{thi}/\\Omega_{ci}$ 是离子拉莫尔半径。\n\n仅使用这些定义和 $\\tau_{E}$ 的扩散估计，并在改变 $M$ 时保持 $B$、 $R$、 $a$、 $V$、 $n$ 和 $P$ 不变，推导每种输运模型中标度关系 $\\tau_{E} \\propto M^{h}$ 所定义的同位素质量指数 $h$。将指数对的结果以行矩阵 $\\big(h_{B},\\,h_{gB}\\big)$ 的形式报告，其中 $h_{B}$ 对应类 Bohm 模型，$h_{gB}$ 对应类 gyro-Bohm 模型。\n\n最后，将您得到的理论指数的符号和大小与高约束模式（H-mode）数据库中报告的典型经验氢同位素质量指数进行简要比较（例如，国际热核聚变实验堆（ITER）物理基础1998年 H-mode 标度律报告的值在 $h \\approx 0.2$ 附近），但不要将此比较包含在最终的数值答案中。\n\n您的最终数值答案必须是精确形式的有序对 $\\big(h_{B},\\,h_{gB}\\big)$，不带单位，无需四舍五入。", "solution": "题目要求在两种不同的输运模型下，推导托卡马克等离子体中能量约束时间标度律 $\\tau_{E} \\propto M^h$ 的同位素质量指数 $h$。推导必须假设在改变同位素质量 $M$ 时，磁场 $B$、大半径 $R$、小半径 $a$、等离子体体积 $V$、线平均密度 $n$ 和吸收的加热功率 $P$ 均保持不变。\n\n首先，我们建立主要物理量之间的关系。等离子体的总热能由 $W = \\frac{3}{2} n T V$ 给出。能量约束时间 $\\tau_E$ 由稳态功率平衡方程 $P = W / \\tau_E$ 定义。对 $\\tau_E$ 进行整理并代入 $W$ 的表达式，我们得到：\n$$\n\\tau_E = \\frac{W}{P} = \\frac{\\frac{3}{2} n V T}{P}\n$$\n由于 $n$、$V$ 和 $P$ 都保持不变，能量约束时间与等离子体温度 $T$ 成正比：\n$$\n\\tau_E \\propto T\n$$\n关键是要认识到 $T$ 并非保持不变；它是一个因变量，会随着 $M$ 的变化而调整以维持功率平衡。\n\n其次，题目提供了能量约束时间的扩散估计，$\\tau_E \\sim L^2 / \\chi$，其中特征长度尺度为 $L \\sim a$，$\\chi$ 是有效热扩散系数。由于小半径 $a$ 是固定的，这导致了以下正比关系：\n$$\n\\tau_E \\propto \\frac{1}{\\chi}\n$$\n\n通过将 $\\tau_E$ 的两个正比关系等同起来，我们得到了系统在稳态下的一个基本约束条件：\n$$\nT \\propto \\frac{1}{\\chi} \\implies T\\chi = \\text{constant}\n$$\n这种关系确保了功率平衡 $P = \\text{constant}$ 得以维持。现在我们利用这个约束来分析每种输运模型。\n\n情况1：类 Bohm 扩散系数（$\\chi_B$）\n类 Bohm 扩散系数为 $\\chi_B = C_B \\frac{T}{e B}$。参数 $C_B$（无量纲常数）、$e$（元电荷）和 $B$（磁场）都是常数。因此，扩散系数 $\\chi_B$ 与温度 $T$ 成正比：\n$$\n\\chi_B \\propto T\n$$\n将此代入我们的功率平衡约束 $T\\chi = \\text{constant}$：\n$$\nT \\chi_B \\propto T \\cdot T = T^2 = \\text{constant}\n$$\n这意味着 $T^2$ 是一个常数，即 $T$ 本身必须是常数，且与同位素质量 $M$ 无关。由于我们已经确定 $\\tau_E \\propto T$，因此 $\\tau_E$ 也与 $M$ 无关。\n$$\n\\tau_E \\propto T \\propto M^0\n$$\n因此，类 Bohm 标度律的同位素质量指数为 $h_B = 0$。\n\n情况2：类 gyro-Bohm 扩散系数（$\\chi_{gB}$）\n类 gyro-Bohm 扩散系数为 $\\chi_{gB} = C_{gB} \\frac{\\rho_i^2 v_{thi}}{a}$。参数 $C_{gB}$ 和 $a$ 是常数。我们需要用 $T$ 和 $M$ 来表示 $\\chi_{gB}$。\n离子热速度为 $v_{thi} = \\sqrt{2T/M}$，所以其标度关系为：\n$$\nv_{thi} \\propto T^{1/2} M^{-1/2}\n$$\n离子回旋频率为 $\\Omega_{ci} = eB/M$。由于 $e$ 和 $B$ 是常数，其标度关系为：\n$$\n\\Omega_{ci} \\propto M^{-1}\n$$\n离子拉莫尔半径为 $\\rho_i = v_{thi}/\\Omega_{ci}$。因此其标度关系为：\n$$\n\\rho_i \\propto \\frac{v_{thi}}{\\Omega_{ci}} \\propto \\frac{T^{1/2} M^{-1/2}}{M^{-1}} = T^{1/2} M^{1/2}\n$$\n现在我们可以确定 $\\chi_{gB}$ 的标度关系：\n$$\n\\chi_{gB} \\propto \\frac{\\rho_i^2 v_{thi}}{a} \\propto \\rho_i^2 v_{thi} \\propto (T^{1/2} M^{1/2})^2 (T^{1/2} M^{-1/2})\n$$\n$$\n\\chi_{gB} \\propto (T M) (T^{1/2} M^{-1/2}) = T^{1+1/2} M^{1-1/2} = T^{3/2} M^{1/2}\n$$\n应用功率平衡约束 $T\\chi = \\text{constant}$：\n$$\nT \\chi_{gB} \\propto T \\cdot (T^{3/2} M^{1/2}) = T^{5/2} M^{1/2} = \\text{constant}\n$$\n由此，我们求解 $T$ 随 $M$ 的标度关系：\n$$\nT^{5/2} \\propto M^{-1/2} \\implies T \\propto (M^{-1/2})^{2/5} = M^{-1/5}\n$$\n由于 $\\tau_E \\propto T$，能量约束时间随质量的标度关系为：\n$$\n\\tau_E \\propto M^{-1/5}\n$$\n因此，类 gyro-Bohm 标度律的同位素质量指数为 $h_{gB} = -1/5$。\n\n最终得到的指数对为 $(h_B, h_{gB}) = (0, -1/5)$。\n\n推导出的理论指数为 $h_B = 0$（类 Bohm 输运无同位素效应）和 $h_{gB} = -0.2$（类 gyro-Bohm 输运存在逆同位素效应，即使用更重的同位素时约束会变差）。这些理论预测与 H 模式托卡马克的实验结果形成鲜明对比。实验结果一致表明存在有利的同位素效应，即使用更重的同位素时约束会改善，对应一个正指数，通常在 $h \\approx 0.2$ 的范围内。这一显著差异表明，这些简单的唯象模型是不完整的，未能捕捉到控制湍流输运的关键物理机制，例如带状流的稳定效应或各种边缘物理现象，而这些机制被认为是观测到的有利质量标度关系的原因。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  -\\frac{1}{5}\n\\end{pmatrix}\n}\n$$", "id": "3698149"}, {"introduction": "从实验数据中建立可靠的标度律是一项复杂的统计挑战。这个编程练习提供了一个亲身实践的机会，您将通过对合成数据进行回归分析，探索模型设定的选择（例如包含或忽略某个变量）如何影响其他参数的指数以及整体拟合的质量。这项实践将让您直接体会到多参数回归分析和模型选择在经验建模中的核心作用和挑战 [@problem_id:3698201]。", "problem": "考虑磁约束聚变装置中低约束模式（L-模式）等离子体的经验性能量约束定标律。令能量约束时间表示为 $\\tau_E$，并假设它与主要工程参数呈乘性幂律关系：等离子体电流 $I_p$、环向磁场 $B_t$、弦平均密度 $\\bar{n}$、辅助加热功率 $P$、大半径 $R$、小半径 $a$ 以及有效离子电荷 $Z_{\\text{eff}}$。有效离子电荷是一个量化杂质含量的无量纲参数。经验性问题是，将 $Z_{\\text{eff}}$ 显式地作为一个回归量，是否会改变其他变量的推断指数，以及是否会减少拟合的残差方差。\n\n基本原理：观测到的 $\\tau_E$ 被建模为变量的幂律乘积，并受乘性散射的调制：\n$$\n\\tau_E = C \\, I_p^{\\alpha_I} B_t^{\\alpha_B} \\bar{n}^{\\alpha_n} P^{\\alpha_P} R^{\\alpha_R} a^{\\alpha_a} Z_{\\text{eff}}^{\\alpha_Z} \\, \\exp(\\varepsilon),\n$$\n其中 $C$ 是一个正常数，$\\alpha_\\bullet$ 是待推断的实值指数，$\\varepsilon$ 是一个代表未建模变异性的零均值残差。取自然对数可得到一个加性线性模型：\n$$\n\\ln \\tau_E = \\ln C + \\alpha_I \\ln I_p + \\alpha_B \\ln B_t + \\alpha_n \\ln \\bar{n} + \\alpha_P \\ln P + \\alpha_R \\ln R + \\alpha_a \\ln a + \\alpha_Z \\ln Z_{\\text{eff}} + \\varepsilon,\n$$\n该模型可通过普通最小二乘法（OLS）回归进行估计，通过最小化残差平方和来获得指数 $\\alpha_\\bullet$。\n\n您的任务是编写一个完整的程序，针对一个包含三个合成但科学上合理的测试数据集，对每个数据集执行以下操作：\n- 对对数形式拟合两个 OLS 模型：一个排除 $Z_{\\text{eff}}$，一个包含 $Z_{\\text{eff}}$。\n- 报告两次拟合中包含变量的共享指数的平均绝对变化（仅比较 $\\alpha_I$、$\\alpha_B$、$\\alpha_n$、$\\alpha_P$、$\\alpha_R$、$\\alpha_a$；此平均值不包括截距和 $\\alpha_Z$）。\n- 报告包含 $Z_{\\text{eff}}$ 时拟合的指数 $\\alpha_Z$。\n- 报告无偏残差方差之比，定义为 $s^2_{\\text{without}} / s^2_{\\text{with}}$，其中 $s^2$ 是残差平方和除以自由度 $N - p$，$N$ 为数据点数，$p$ 为包括截距在内的参数个数。\n- 报告一个布尔值，指示包含 $Z_{\\text{eff}}$ 是否减少了残差方差（即，该比率是否大于 $1$）。\n\n使用以下测试套件。在每种情况下，使用指定的指数和确定性残差 $\\varepsilon_i = \\delta \\sin(i)$ 计算 $\\tau_E$，其中数据索引 $i$ 从 $1$ 到 $N$（使用弧度），$\\delta$ 是指定的振幅。单位如下：$I_p$ 单位为兆安培 (MA)，$B_t$ 单位为特斯拉 (T)，$\\bar{n}$ 单位为 $10^{19}\\,\\mathrm{m}^{-3}$，$P$ 单位为兆瓦 (MW)，$R$ 单位为米 (m)，$a$ 单位为米 (m)，$\\tau_E$ 单位为秒 (s)。输出是无量纲的；输出不需要单位。对于所有浮点数，四舍五入到 $3$ 位小数。$\\sin(\\cdot)$ 中的角度单位是弧度。\n\n数据集 A（一般情况）：\n- 参数：$N = 12$，$C = 0.056$，$\\delta = 0.03$，指数 $\\alpha_I = 0.85$，$\\alpha_B = 0.20$，$\\alpha_n = 0.55$，$\\alpha_P = -0.50$，$\\alpha_R = 1.00$，$\\alpha_a = 0.35$，$\\alpha_Z = -0.25$。\n- 数组：\n  - $I_p = \\{0.6, 0.8, 1.0, 1.2, 1.5, 1.8, 1.0, 1.6, 0.9, 1.3, 1.1, 1.7\\}$,\n  - $B_t = \\{2.0, 2.2, 1.8, 3.0, 2.5, 1.6, 3.2, 2.7, 2.1, 1.9, 2.8, 3.5\\}$,\n  - $\\bar{n} = \\{3.0, 4.0, 5.5, 6.0, 7.5, 3.5, 8.0, 4.5, 5.0, 2.8, 6.5, 7.0\\}$,\n  - $P = \\{8.0, 10.0, 12.0, 14.0, 9.0, 16.0, 11.0, 7.0, 13.0, 15.0, 6.0, 5.0\\}$,\n  - $R = \\{1.7, 1.7, 1.7, 2.0, 2.0, 2.0, 2.3, 2.3, 2.3, 1.9, 1.9, 2.1\\}$,\n  - $a = \\{0.55, 0.55, 0.55, 0.62, 0.62, 0.62, 0.70, 0.70, 0.70, 0.60, 0.60, 0.65\\}$,\n  - $Z_{\\text{eff}} = \\{1.5, 1.6, 1.8, 2.0, 2.5, 1.4, 2.2, 2.8, 1.7, 1.9, 3.0, 2.6\\}$。\n\n数据集 B（边界情况，无真实 $Z_{\\text{eff}}$ 效应）：\n- 参数：$N = 12$，$C = 0.056$，$\\delta = 0.02$，指数 $\\alpha_I = 0.85$，$\\alpha_B = 0.20$，$\\alpha_n = 0.55$，$\\alpha_P = -0.50$，$\\alpha_R = 1.00$，$\\alpha_a = 0.35$，$\\alpha_Z = 0.00$。\n- 数组：\n  - $I_p = \\{0.6, 0.8, 1.0, 1.2, 1.5, 1.8, 1.0, 1.6, 0.9, 1.3, 1.1, 1.7\\}$,\n  - $B_t = \\{2.0, 2.2, 1.8, 3.0, 2.5, 1.6, 3.2, 2.7, 2.1, 1.9, 2.8, 3.5\\}$,\n  - $\\bar{n} = \\{3.0, 4.0, 5.5, 6.0, 7.5, 3.5, 8.0, 4.5, 5.0, 2.8, 6.5, 7.0\\}$,\n  - $P = \\{8.0, 10.0, 12.0, 14.0, 9.0, 16.0, 11.0, 7.0, 13.0, 15.0, 6.0, 5.0\\}$,\n  - $R = \\{1.7, 1.7, 1.7, 2.0, 2.0, 2.0, 2.3, 2.3, 2.3, 1.9, 1.9, 2.1\\}$,\n  - $a = \\{0.55, 0.55, 0.55, 0.62, 0.62, 0.62, 0.70, 0.70, 0.70, 0.60, 0.60, 0.65\\}$,\n  - $Z_{\\text{eff}} = \\{1.20, 1.25, 1.30, 1.35, 1.40, 1.45, 1.50, 1.55, 1.60, 1.65, 1.70, 1.75\\}$。\n\n数据集 C（边缘情况，$Z_{\\text{eff}}$ 和 $\\bar{n}$ 之间存在强相关性）：\n- 参数：$N = 12$，$C = 0.056$，$\\delta = 0.04$，指数 $\\alpha_I = 0.85$，$\\alpha_B = 0.20$，$\\alpha_n = 0.55$，$\\alpha_P = -0.50$，$\\alpha_R = 1.00$，$\\alpha_a = 0.35$，$\\alpha_Z = -0.40$。\n- 数组：\n  - $I_p = \\{0.6, 0.8, 1.0, 1.2, 1.5, 1.8, 1.0, 1.6, 0.9, 1.3, 1.1, 1.7\\}$,\n  - $B_t = \\{2.0, 2.2, 1.8, 3.0, 2.5, 1.6, 3.2, 2.7, 2.1, 1.9, 2.8, 3.5\\}$,\n  - $\\bar{n} = \\{3.0, 4.0, 5.5, 6.0, 7.5, 3.5, 8.0, 4.5, 5.0, 2.8, 6.5, 7.0\\}$,\n  - $P = \\{8.0, 10.0, 12.0, 14.0, 9.0, 16.0, 11.0, 7.0, 13.0, 15.0, 6.0, 5.0\\}$,\n  - $R = \\{1.7, 1.7, 1.7, 2.0, 2.0, 2.0, 2.3, 2.3, 2.3, 1.9, 1.9, 2.1\\}$,\n  - $a = \\{0.55, 0.55, 0.55, 0.62, 0.62, 0.62, 0.70, 0.70, 0.70, 0.60, 0.60, 0.65\\}$,\n  - $Z_{\\text{eff}}$ 由 $\\bar{n}$ 确定性地定义为 $Z_{\\text{eff},i} = 1.0 + 0.25 \\cdot \\dfrac{\\bar{n}_i - 3.0}{5.0}$，逐元素计算，并为清晰起见四舍五入到 $3$ 位小数。\n\n对于每个数据集，使用提供的数组和参数，通过幂律模型和指定的 $\\varepsilon_i$ 计算 $\\tau_E$。然后，为每个数据集计算并按顺序输出以下四个量：\n$[\\text{共享指数的平均绝对变化}, \\alpha_Z \\text{ (含 } Z_{\\text{eff}} \\text{)}, \\text{残差方差比}, \\text{指示是否减少的布尔值}]$。\n\n最终输出格式：您的程序应生成单行输出，其中包含所有三个数据集的结果，这些结果连接成一个扁平的、逗号分隔的列表，并用方括号括起来，浮点数四舍五入到 $3$ 位小数，例如 $[\\dots]$。具体来说，最终输出应为\n$$\n[\\text{A\\_mean\\_change}, \\text{A\\_alpha\\_Z}, \\text{A\\_var\\_ratio}, \\text{A\\_reduced}, \\text{B\\_mean\\_change}, \\text{B\\_alpha\\_Z}, \\text{B\\_var\\_ratio}, \\text{B\\_reduced}, \\text{C\\_mean\\_change}, \\text{C\\_alpha\\_Z}, \\text{C\\_var\\_ratio}, \\text{C\\_reduced}].\n$$", "solution": "用户提供的问题被评估为有效。它在科学上植根于核聚变等离子体物理学领域，特别涉及经验性能量约束定标律。该问题是适定的、客观的，并包含推导出唯一、可验证解所需的所有信息。其基础方法，即对对数线性模型进行普通最小二乘法（OLS）回归，是此类分析的标准且适当的技术。包含多重共線性情况（数据集 C）代表了经验建模中的一个现实挑战，但这并不使问题无效，而是测试了计算方法的稳健性。\n\n解决方案按以下步骤进行：首先，我们形式化统计模型。其次，我们概述拟合两个所需回归模型的程序。第三，我们定义用于模型比较的四个度量指标。最后，我们描述为三个指定数据集中的每一个生成合成数据和计算结果的算法。\n\n能量约束时间 $\\tau_E$ 的基本关系由一个幂律模型给出：\n$$\n\\tau_E = C \\, I_p^{\\alpha_I} B_t^{\\alpha_B} \\bar{n}^{\\alpha_n} P^{\\alpha_P} R^{\\alpha_R} a^{\\alpha_a} Z_{\\text{eff}}^{\\alpha_Z} \\, \\exp(\\varepsilon)\n$$\n对该方程取自然对数，可将模型线性化，使其适用于标准回归技术：\n$$\ny_i = \\beta_0 + \\beta_1 x_{i,1} + \\beta_2 x_{i,2} + \\dots + \\beta_k x_{i,k} + \\varepsilon_i\n$$\n在这里，$y_i = \\ln \\tau_{E,i}$ 是第 $i$ 次观测的响应变量。系数 $\\beta_j$ 对应于定标指数 $\\alpha_\\bullet$，其中 $\\beta_0 = \\ln C$ 是截距。预测变量 $x_{i,j}$是相应工程参数的对数（例如，$x_{i,1} = \\ln I_{p,i}$）。用矩阵表示法，这表示为通用线性模型：\n$$\n\\mathbf{y} = \\mathbf{X}\\boldsymbol{\\beta} + \\boldsymbol{\\varepsilon}\n$$\n系数向量 $\\boldsymbol{\\beta}$ 使用普通最小二乘法（OLS）进行估计，该方法找到使残差平方和（SSR）最小化的向量 $\\hat{\\boldsymbol{\\beta}}$，即 $\\text{SSR} = ||\\mathbf{y} - \\mathbf{X}\\hat{\\boldsymbol{\\beta}}||_2^2$。解析解由正规方程给出：\n$$\n\\hat{\\boldsymbol{\\beta}} = (\\mathbf{X}^T\\mathbf{X})^{-1}\\mathbf{X}^T\\mathbf{y}\n$$\n\n对于每个数据集，我们执行两次独立的回归：\n1.  **模型1（不含 $Z_{\\text{eff}}$）**：响应 $\\mathbf{y} = \\ln \\boldsymbol{\\tau}_E$ 对六个基本参数（$I_p, B_t, \\bar{n}, P, R, a$）的对数以及一个截距进行回归。设计矩阵 $\\mathbf{X}_1$ 的维度为 $N \\times p_1$，其中 $N=12$ 是数据点数，$p_1=7$ 是参数数量（一个截距和六个指数）。$\\mathbf{X}_1$ 的第一列是用于截距的全1向量。\n2.  **模型2（含 $Z_{\\text{eff}}$）**：此模型在模型1的基础上扩展，将 $\\ln Z_{\\text{eff}}$ 作为额外的预测变量包含进来。设计矩阵 $\\mathbf{X}_2$ 的维度为 $N \\times p_2$，$p_2=8$，通过将 $\\ln Z_{\\text{eff}}$ 向量作为新的一列附加到 $\\mathbf{X}_1$ 来构建。\n\n根据这两次拟合的结果（$\\hat{\\boldsymbol{\\beta}}_1$, $\\text{SSR}_1$ 和 $\\hat{\\boldsymbol{\\beta}}_2$, $\\text{SSR}_2$），我们计算四个度量指标：\n\n1.  **共享指数的平均绝对变化**：该度量指标量化了在包含 $Z_{\\text{eff}}$ 后，原始六个指数的估计值变化了多少。它计算为 $\\hat{\\boldsymbol{\\beta}}_1$ 和 $\\hat{\\boldsymbol{\\beta}}_2$ 中相应系数之间绝对差的平均值：\n    $$\n    \\Delta\\alpha_{\\text{mean}} = \\frac{1}{6} \\sum_{j=1}^{6} |\\hat{\\beta}_{2,j} - \\hat{\\beta}_{1,j}|\n    $$\n    索引 $j=1, \\dots, 6$ 对应于 $I_p, \\dots, a$ 的指数。一个较大的值表明原始模型可能存在遗漏变量偏差。\n\n2.  **拟合指数 $\\alpha_Z$**：这只是模型2中预测变量 $\\ln Z_{\\text{eff}}$ 的估计系数，即 $\\hat{\\beta}_{2,7}$（$\\hat{\\boldsymbol{\\beta}}_2$ 的第8个元素）。\n\n3.  **无偏残差方差之比**：残差方差的无偏估计定义为 $s^2 = \\text{SSR} / (N - p)$，其中分母是自由度。该度量指标考虑了这样一个事实：增加参数总是会减少 SSR，但可能不会提高模型的实际预测能力。我们计算该比率：\n    $$\n    \\text{Ratio} = \\frac{s^2_{\\text{without}}}{s^2_{\\text{with}}} = \\frac{\\text{SSR}_1 / (N-p_1)}{\\text{SSR}_2 / (N-p_2)}\n    $$\n\n4.  **指示方差减少的布尔值**：这是一个逻辑标志，如果无偏方差之比大于 $1$，则为 `True`，否则为 `False`。值为 `True` 表示即使在因损失一个自由度而受到惩罚后，包含 $Z_{\\text{eff}}$ 仍然减少了残差方差。\n\n对于三个测试数据集中的每一个，都实现了整体算法。首先，使用指定的真实参数、数据数组和确定性残差项 $\\varepsilon_i = \\delta \\sin(i)$ 生成 $\\ln \\tau_E$ 的合成数据。对于数据集 C，首先根据其与 $\\bar{n}$ 的确定性关系计算 $Z_{\\text{eff}}$ 向量。然后，使用数值稳定的线性最小二乘求解器执行两次 OLS 拟合，并根据拟合结果计算所需的四个度量指标。最终输出是所有三个数据集的这些度量指标的聚合。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the three datasets.\n    It defines the datasets, processes each one, and prints the formatted result.\n    \"\"\"\n    \n    # Dataset definitions\n    dataset_a = {\n        'N': 12, 'C': 0.056, 'delta': 0.03,\n        'alphas': {'I': 0.85, 'B': 0.20, 'n': 0.55, 'P': -0.50, 'R': 1.00, 'a': 0.35, 'Z': -0.25},\n        'data': {\n            'I_p': [0.6, 0.8, 1.0, 1.2, 1.5, 1.8, 1.0, 1.6, 0.9, 1.3, 1.1, 1.7],\n            'B_t': [2.0, 2.2, 1.8, 3.0, 2.5, 1.6, 3.2, 2.7, 2.1, 1.9, 2.8, 3.5],\n            'n_bar': [3.0, 4.0, 5.5, 6.0, 7.5, 3.5, 8.0, 4.5, 5.0, 2.8, 6.5, 7.0],\n            'P': [8.0, 10.0, 12.0, 14.0, 9.0, 16.0, 11.0, 7.0, 13.0, 15.0, 6.0, 5.0],\n            'R': [1.7, 1.7, 1.7, 2.0, 2.0, 2.0, 2.3, 2.3, 2.3, 1.9, 1.9, 2.1],\n            'a': [0.55, 0.55, 0.55, 0.62, 0.62, 0.62, 0.70, 0.70, 0.70, 0.60, 0.60, 0.65],\n            'Z_eff': [1.5, 1.6, 1.8, 2.0, 2.5, 1.4, 2.2, 2.8, 1.7, 1.9, 3.0, 2.6]\n        }\n    }\n\n    dataset_b = {\n        'N': 12, 'C': 0.056, 'delta': 0.02,\n        'alphas': {'I': 0.85, 'B': 0.20, 'n': 0.55, 'P': -0.50, 'R': 1.00, 'a': 0.35, 'Z': 0.00},\n        'data': {\n            'I_p': [0.6, 0.8, 1.0, 1.2, 1.5, 1.8, 1.0, 1.6, 0.9, 1.3, 1.1, 1.7],\n            'B_t': [2.0, 2.2, 1.8, 3.0, 2.5, 1.6, 3.2, 2.7, 2.1, 1.9, 2.8, 3.5],\n            'n_bar': [3.0, 4.0, 5.5, 6.0, 7.5, 3.5, 8.0, 4.5, 5.0, 2.8, 6.5, 7.0],\n            'P': [8.0, 10.0, 12.0, 14.0, 9.0, 16.0, 11.0, 7.0, 13.0, 15.0, 6.0, 5.0],\n            'R': [1.7, 1.7, 1.7, 2.0, 2.0, 2.0, 2.3, 2.3, 2.3, 1.9, 1.9, 2.1],\n            'a': [0.55, 0.55, 0.55, 0.62, 0.62, 0.62, 0.70, 0.70, 0.70, 0.60, 0.60, 0.65],\n            'Z_eff': [1.20, 1.25, 1.30, 1.35, 1.40, 1.45, 1.50, 1.55, 1.60, 1.65, 1.70, 1.75]\n        }\n    }\n\n    dataset_c = {\n        'N': 12, 'C': 0.056, 'delta': 0.04,\n        'alphas': {'I': 0.85, 'B': 0.20, 'n': 0.55, 'P': -0.50, 'R': 1.00, 'a': 0.35, 'Z': -0.40},\n        'data': {\n            'I_p': [0.6, 0.8, 1.0, 1.2, 1.5, 1.8, 1.0, 1.6, 0.9, 1.3, 1.1, 1.7],\n            'B_t': [2.0, 2.2, 1.8, 3.0, 2.5, 1.6, 3.2, 2.7, 2.1, 1.9, 2.8, 3.5],\n            'n_bar': [3.0, 4.0, 5.5, 6.0, 7.5, 3.5, 8.0, 4.5, 5.0, 2.8, 6.5, 7.0],\n            'P': [8.0, 10.0, 12.0, 14.0, 9.0, 16.0, 11.0, 7.0, 13.0, 15.0, 6.0, 5.0],\n            'R': [1.7, 1.7, 1.7, 2.0, 2.0, 2.0, 2.3, 2.3, 2.3, 1.9, 1.9, 2.1],\n            'a': [0.55, 0.55, 0.55, 0.62, 0.62, 0.62, 0.70, 0.70, 0.70, 0.60, 0.60, 0.65],\n        },\n        'Z_eff_formula': True\n    }\n    \n    test_cases = [dataset_a, dataset_b, dataset_c]\n    all_results = []\n\n    for case in test_cases:\n        results = process_dataset(case)\n        all_results.extend(results)\n\n    # Format the final output string\n    formatted_results = []\n    for r in all_results:\n        if isinstance(r, float):\n            formatted_results.append(f\"{r:.3f}\")\n        else:\n            formatted_results.append(str(r))\n\n    print(f\"[{','.join(formatted_results)}]\")\n\ndef process_dataset(params):\n    \"\"\"\n    Processes a single dataset to perform regressions and compute metrics.\n    \"\"\"\n    N = params['N']\n    C = params['C']\n    delta = params['delta']\n    alphas = params['alphas']\n    data = params['data']\n\n    # Convert data to numpy arrays\n    I_p = np.array(data['I_p'])\n    B_t = np.array(data['B_t'])\n    n_bar = np.array(data['n_bar'])\n    P = np.array(data['P'])\n    R = np.array(data['R'])\n    a = np.array(data['a'])\n\n    # Handle Z_eff generation for Dataset C\n    if params.get('Z_eff_formula', False):\n        Z_eff = 1.0 + 0.25 * (n_bar - 3.0) / 5.0\n        Z_eff = np.round(Z_eff, 3)\n    else:\n        Z_eff = np.array(data['Z_eff'])\n\n    # Log-transform predictors\n    log_I_p = np.log(I_p)\n    log_B_t = np.log(B_t)\n    log_n_bar = np.log(n_bar)\n    log_P = np.log(P)\n    log_R = np.log(R)\n    log_a = np.log(a)\n    log_Z_eff = np.log(Z_eff)\n\n    # Generate deterministic residuals\n    i_vals = np.arange(1, N + 1)\n    epsilon = delta * np.sin(i_vals)\n\n    # Generate the response variable log(tau_E) based on the true model\n    log_tau_E = (np.log(C) +\n                 alphas['I'] * log_I_p +\n                 alphas['B'] * log_B_t +\n                 alphas['n'] * log_n_bar +\n                 alphas['P'] * log_P +\n                 alphas['R'] * log_R +\n                 alphas['a'] * log_a +\n                 alphas['Z'] * log_Z_eff +\n                 epsilon)\n\n    # OLS for Model 1 (without Z_eff)\n    X1 = np.column_stack([np.ones(N), log_I_p, log_B_t, log_n_bar, log_P, log_R, log_a])\n    p1 = X1.shape[1]\n    coeffs1, ssr1_arr, _, _ = np.linalg.lstsq(X1, log_tau_E, rcond=None)\n    ssr1 = ssr1_arr[0] if ssr1_arr.size > 0 else 0.0\n\n    # OLS for Model 2 (with Z_eff)\n    X2 = np.column_stack([X1, log_Z_eff])\n    p2 = X2.shape[1]\n    coeffs2, ssr2_arr, _, _ = np.linalg.lstsq(X2, log_tau_E, rcond=None)\n    ssr2 = ssr2_arr[0] if ssr2_arr.size > 0 else 0.0\n\n    # Metric 1: Mean absolute change in shared exponents\n    mean_abs_change = np.mean(np.abs(coeffs2[1:p1] - coeffs1[1:p1]))\n\n    # Metric 2: Fitted exponent alpha_Z\n    alpha_Z_fit = coeffs2[p1] if len(coeffs2) > p1 else np.nan\n\n    # Metric 3: Ratio of unbiased residual variances\n    df1 = N - p1\n    df2 = N - p2\n    var1_unbiased = ssr1 / df1 if df1 > 0 else np.inf\n    var2_unbiased = ssr2 / df2 if df2 > 0 else np.inf\n    \n    var_ratio = var1_unbiased / var2_unbiased if var2_unbiased > 0 else np.inf\n\n    # Metric 4: Boolean for variance reduction\n    is_reduced = var_ratio > 1.0\n\n    return [mean_abs_change, alpha_Z_fit, var_ratio, is_reduced]\n\nsolve()\n```", "id": "3698201"}]}