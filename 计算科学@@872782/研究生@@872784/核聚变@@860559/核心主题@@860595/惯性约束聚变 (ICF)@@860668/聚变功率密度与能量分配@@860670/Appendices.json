{"hands_on_practices": [{"introduction": "在设计聚变反应堆的复杂部件之前，我们必须首先回答一个基本问题：等离子体能否自我维持？本练习介绍零维（0-D）功率平衡模型，这是聚变分析的基石。通过实现该模型，您将学习如何量化阿尔法粒子（$\\alpha$ 粒子）聚变加热与辐射和输运能量损失之间的抗衡，并确定实现点火所需的条件[@problem_id:3700254]。这项练习能让您从第一性原理出发，理解主导反应堆性能的关键参数。", "problem": "设计并实现一个完整的、可运行的程序，用于评估零维（0-D）氘-氚（D-T）聚变等离子体中的功率平衡与点火，其中包含对反应产物和损失通道中功率密度与能量分配的显式建模。问题在于，对于几个指定的稳态等离子体参数集，需要判断在总功率平衡下是否实现点火，以及在给定一个简化但科学上合理的模型下，仅电子本身是否能在无辅助加热的情况下达到功率平衡。所有结果必须从能量守恒的第一性原理以及标准的等离子体辐射和反应率模型中得出，不依赖任何外部数据。\n\n推导的基本依据应始于以下定律和核心定义：\n- 稳态能量守恒：对于每种粒子或总等离子体，净加热等于损失。\n- 聚变反应活性的定义：反应率密度是反应物密度与热平均截面的乘积。\n- 来自聚变反应的功率密度：功率密度等于反应率密度乘以每次反应沉积在等离子体中的能量。\n- 轫致辐射：完全电离的、非相对论性的电子-离子轫致辐射与电子密度的平方和电子温度的平方根成正比。\n- 热能含量与输运损失：输运功率密度等于储存的热能密度除以能量约束时间。\n\n使用以下建模假设和数值输入：\n- 燃料为50/50的氘-氚混合物，无外部加热。反应为 $\\mathrm{D} + \\mathrm{T} \\rightarrow \\alpha \\, (3.5\\,\\mathrm{MeV}) + n \\, (14.1\\,\\mathrm{MeV})$。假定α粒子的能量 $3.5\\,\\mathrm{MeV}$ 完全沉积在等离子体中，而中子能量则逃逸。\n- 假定准中性，且杂质密度对电子密度的贡献可忽略，因此电子密度 $n_e$ 等于总主离子密度，且 $n_{\\mathrm{D}} = n_{\\mathrm{T}} = n_e/2$。将有效电荷数表示为 $Z_{\\mathrm{eff}}$，它仅影响轫致辐射。\n- 假定电子和离子温度相等，$T_e = T_i = T$，以 $\\mathrm{keV}$ 为单位。\n- α粒子功率在电子和离子间的能量分配由一个恒定比例建模：α粒子功率的一部分 $f_e = 0.85$ 沉积到电子上，另一部分 $f_i = 1 - f_e = 0.15$ 沉积到离子上。这近似于在数$\\mathrm{keV}$温度范围内，快α粒子在电子和离子上的库仑慢化过程。\n- D-T聚变的热平均反应活性 $\\langle \\sigma v \\rangle$ 作为 $T$（单位 $\\mathrm{keV}$）的函数，必须通过对以下表格数据进行对数-对数线性插值获得（其中 $\\langle \\sigma v \\rangle$ 的单位为 $\\mathrm{m}^3/\\mathrm{s}$）：\n  - $T = 5$: $\\langle \\sigma v \\rangle = 1.1 \\times 10^{-23}$\n  - $T = 10$: $\\langle \\sigma v \\rangle = 1.1 \\times 10^{-22}$\n  - $T = 15$: $\\langle \\sigma v \\rangle = 3.2 \\times 10^{-22}$\n  - $T = 20$: $\\langle \\sigma v \\rangle = 6.0 \\times 10^{-22}$\n  - $T = 25$: $\\langle \\sigma v \\rangle = 9.8 \\times 10^{-22}$\n  对于严格位于表格数据点之间的任何 $T$，使用对数-对数线性插值；对于等于表格数据点的 $T$，使用相应的值。输入不会要求在表格范围之外进行外插。\n- 电子-离子轫致辐射功率密度模型为\n  $$ P_{\\mathrm{brem}} = C_b \\, Z_{\\mathrm{eff}} \\, n_e^2 \\, \\sqrt{T_e[\\mathrm{eV}]}, $$\n  其中 $C_b = 1.69 \\times 10^{-38}\\,\\mathrm{W\\,m}^3\\,\\mathrm{eV}^{-1/2}$，$T_e[\\mathrm{eV}] = 10^3 \\, T[\\mathrm{keV}]$，且 $n_e$ 的单位为 $\\mathrm{m}^{-3}$。\n- α粒子加热功率密度为\n  $$ P_\\alpha = R \\, E_\\alpha, \\quad R = n_{\\mathrm{D}} n_{\\mathrm{T}} \\langle \\sigma v \\rangle = \\frac{n_e^2}{4} \\langle \\sigma v \\rangle, $$\n  其中 $E_\\alpha = 3.5 \\times 10^6 \\,\\mathrm{eV}$ 通过基本电荷 $e = 1.602\\,176\\,634 \\times 10^{-19}\\,\\mathrm{J/eV}$ 转换为焦耳。\n- 总等离子体的热输运损失功率密度为\n  $$ P_{\\tau,\\mathrm{tot}} = \\frac{U_{\\mathrm{tot}}}{\\tau_E}, \\quad U_{\\mathrm{tot}} = \\frac{3}{2} n_e k_B T_e + \\frac{3}{2} n_i k_B T_i = 3 \\, n_e \\, k_B \\, T, $$\n  其中 $k_B$ 是玻尔兹曼常数，通过 $k_B T[\\mathrm{J}] = T[\\mathrm{eV}] \\times e$ 表示为焦耳每电子伏特，$\\tau_E$ 是能量约束时间，单位为秒。为按粒子种类记账，你也可以使用 $P_{\\tau,e} = \\frac{3}{2} n_e k_B T / \\tau_E$ 和 $P_{\\tau,i} = \\frac{3}{2} n_e k_B T / \\tau_E$。\n- 总点火条件（无辅助功率）由净总功率的非负性定义：\n  $$ \\text{Ignition (total)} \\iff P_\\alpha \\ge P_{\\mathrm{brem}} + P_{\\tau,\\mathrm{tot}}. $$\n  单独电子平衡（不考虑电子-离子能量交换）定义为\n  $$ \\text{Ignition (electrons)} \\iff f_e \\, P_\\alpha \\ge P_{\\mathrm{brem}} + P_{\\tau,e}. $$\n- 在给定的 $n_e$ 和 $T$ 下，总功率平衡的临界能量约束时间（若有意义）通过求解下式定义\n  $$ P_\\alpha = P_{\\mathrm{brem}} + \\frac{3 \\, n_e \\, k_B \\, T}{\\tau_{E,\\mathrm{crit,tot}}}, $$\n  即\n  $$ \\tau_{E,\\mathrm{crit,tot}} = \\frac{3 \\, n_e \\, k_B \\, T}{P_\\alpha - P_{\\mathrm{brem}}}, $$\n  前提是 $P_\\alpha > P_{\\mathrm{brem}}$；否则定义 $\\tau_{E,\\mathrm{crit,tot}} = +\\infty$。\n  类似地，对于仅电子的条件，\n  $$ \\tau_{E,\\mathrm{crit,e}} = \\frac{\\tfrac{3}{2} \\, n_e \\, k_B \\, T}{f_e \\, P_\\alpha - P_{\\mathrm{brem}}}, $$\n  前提是 $f_e \\, P_\\alpha > P_{\\mathrm{brem}}$；否则定义 $\\tau_{E,\\mathrm{crit,e}} = +\\infty$。\n- 定义净总裕度为无量纲小数\n  $$ \\mathcal{M}_{\\mathrm{tot}} = \\frac{P_\\alpha - \\left(P_{\\mathrm{brem}} + P_{\\tau,\\mathrm{tot}}\\right)}{P_{\\mathrm{brem}} + P_{\\tau,\\mathrm{tot}}}. $$\n\n任务：\n1. 仅使用提供的输入和常数实现上述物理模型。在适用情况下，使用严格的国际单位制（SI）进行计算。在与 $n_e$ 和 $\\tau_E$ 结合时，内部以焦耳表示温度。对 $\\langle \\sigma v \\rangle$ 使用给定的插值方法。\n2. 对下面的每个测试用例，计算：\n   - 总平衡下的布尔值点火状态，\n   - 仅电子的布尔值点火状态，\n   - 临界约束时间 $\\tau_{E,\\mathrm{crit,tot}}$ 和 $\\tau_{E,\\mathrm{crit,e}}$（单位：秒），\n   - 净总裕度 $\\mathcal{M}_{\\mathrm{tot}}$（小数形式）。\n   将所有有限浮点数输出四舍五入到六位有效数字。如果临界时间为 $+\\infty$，则输出为 $+\\infty$。\n3. 使用以下参数值测试套件（每个元组为 $(n_e[\\mathrm{m}^{-3}], T[\\mathrm{keV}], \\tau_E[\\mathrm{s}], Z_{\\mathrm{eff}})$）：\n   - 案例A（边缘，轫致辐射主导）：$(1.0 \\times 10^{20}, 10, 3.0, 1.0)$\n   - 案例B（理想路径，接近阈值）：$(1.0 \\times 10^{20}, 15, 3.0, 1.0)$\n   - 案例C（杂质惩罚）：$(1.0 \\times 10^{20}, 15, 3.0, 2.0)$\n   - 案例D（更高密度，约束降低）：$(2.0 \\times 10^{20}, 15, 1.5, 1.0)$\n   - 案例E（低温，长约束）：$(1.0 \\times 10^{20}, 5, 10.0, 1.0)$\n\n最终输出规范：\n- 你的程序应生成单行输出，包含一个由逗号分隔并用方括号括起来的列表。每个案例的结果必须是以下形式的列表\n  $$ [\\text{ignite\\_total}, \\text{ignite\\_electron}, \\tau_{E,\\mathrm{crit,tot}}[\\mathrm{s}], \\tau_{E,\\mathrm{crit,e}}[\\mathrm{s}], \\mathcal{M}_{\\mathrm{tot}}], $$\n  其中布尔值为字面量 $\\text{True}$ 或 $\\text{False}$，时间是舍入到六位有效数字的有限浮点数或在无穷大时为 $+\\infty$，裕度是舍入到六位有效数字的浮点数。因此，最终输出应如下所示\n  $$ [[b_1, b_2, t_1, t_2, m_1],[b_1', b_2', t_1', t_2', m_1'],\\ldots] $$\n  其中 $b_i$ 是布尔值，$t_i, m_i$ 是数字。所有时间必须以 $\\mathrm{s}$ 为单位，所有计算必须与SI单位自洽。", "solution": "该问题已根据指定标准进行了仔细验证，并被确定为**有效**。它具有科学依据、提法明确且客观。所提供的物理模型、常数和参数为获得一个唯一且有意义的解构成了自洽且一致的基础。因此，我们可以着手进行推导和实现。\n\n问题的核心是在稳态条件下评估氘-氚（D-T）聚变等离子体中的功率平衡。分析的关键在于比较等离子体加热功率源与功率损失通道。所有计算都将采用国际单位制（SI）以确保一致性。\n\n主要的加热源是聚变产生的α粒子所带的能量。D-T聚变反应为 $\\mathrm{D} + \\mathrm{T} \\rightarrow \\alpha + n$。α粒子携带 $E_\\alpha = 3.5\\,\\mathrm{MeV}$ 的能量，并假定其被完全约束，将其能量沉积到等离子体中。能量为 $14.1\\,\\mathrm{MeV}$ 的中子则逃逸。因此，每次反应沉积在等离子体中的能量为 $E_{\\alpha,J} = (3.5 \\times 10^6\\,\\mathrm{eV}) \\times e$，其中 $e = 1.602\\,176\\,634 \\times 10^{-19}\\,\\mathrm{J/eV}$ 是基本电荷。\n\n对于氘密度为 $n_D$、氚密度为 $n_T$ 的等离子体，其聚变反应率密度 $R$ 由 $R = n_D n_T \\langle \\sigma v \\rangle$ 给出。对于指定的50/50 D-T燃料混合物，我们有 $n_D = n_T = n_e/2$，其中 $n_e$ 是电子密度。因此，$R = \\frac{n_e^2}{4} \\langle \\sigma v \\rangle$。相应的α粒子加热功率密度 $P_\\alpha$ 是：\n$$\nP_\\alpha = R \\cdot E_{\\alpha,J} = \\frac{n_e^2}{4} \\langle \\sigma v \\rangle(T) E_{\\alpha,J}\n$$\n量 $\\langle \\sigma v \\rangle(T)$ 是D-T聚变反应活性，它是等离子体温度 $T$ 的强函数。根据规定，其值通过对提供的表格数据进行对数-对数线性插值来确定。如果我们令 $x = \\log T$ 和 $y = \\log \\langle \\sigma v \\rangle$，对于位于表格点 $(T_1, \\langle \\sigma v \\rangle_1)$ 和 $(T_2, \\langle \\sigma v \\rangle_2)$ 之间的温度 $T$，其值通过在对数空间中进行线性插值得到：\n$$\n\\log \\langle \\sigma v \\rangle(T) = \\log \\langle \\sigma v \\rangle_1 + \\frac{\\log T - \\log T_1}{\\log T_2 - \\log T_1} (\\log \\langle \\sigma v \\rangle_2 - \\log \\langle \\sigma v \\rangle_1)\n$$\n\n等离子体通过两个主要通道损失能量：辐射和输运。辐射损失被建模为电子-离子轫致辐射，其功率密度 $P_{\\mathrm{brem}}$ 由下式给出：\n$$\nP_{\\mathrm{brem}} = C_b \\, Z_{\\mathrm{eff}} \\, n_e^2 \\, \\sqrt{T_e[\\mathrm{eV}]}\n$$\n这里，$C_b = 1.69 \\times 10^{-38}\\,\\mathrm{W\\,m}^3\\,\\mathrm{eV}^{-1/2}$ 是轫致辐射常数，$Z_{\\mathrm{eff}}$ 是有效离子电荷，电子温度 $T_e$ 通过 $T_e[\\mathrm{eV}] = 1000 \\times T[\\mathrm{keV}]$ 与共同温度 $T$（单位keV）相关联。\n\n输运损失功率密度 $P_{\\tau,\\mathrm{tot}}$ 由能量约束时间 $\\tau_E$ 表征。它是热能从等离子体体积中损失的速率：\n$$\nP_{\\tau,\\mathrm{tot}} = \\frac{U_{\\mathrm{tot}}}{\\tau_E}\n$$\n对于电子和离子温度相等（$T_e=T_i=T$）且电子和总离子密度相等（$n_i = n_D+n_T = n_e$）的等离子体，总热能密度 $U_{\\mathrm{tot}}$ 为：\n$$\nU_{\\mathrm{tot}} = U_e + U_i = \\frac{3}{2} n_e k_B T + \\frac{3}{2} n_i k_B T = 3 n_e k_B T\n$$\n项 $k_B T$ 表示以焦耳为单位的热能，计算为 $k_B T[\\mathrm{J}] = (1000 \\times T[\\mathrm{keV}]) \\times e$。因此，总输运损失为：\n$$\nP_{\\tau,\\mathrm{tot}} = \\frac{3 n_e k_B T}{\\tau_E}\n$$\n针对电子的输运损失 $P_{\\tau,e}$ 定义为 $P_{\\tau,e} = \\frac{U_e}{\\tau_E} = \\frac{\\frac{3}{2} n_e k_B T}{\\tau_E}$，这恰好是总输运损失的一半。\n\n有了这些定义，我们可以评估两个点火条件。如果α粒子加热能够在没有辅助加热的情况下克服所有损失，则实现总点火：\n$$\n\\text{Ignition (total)} \\iff P_\\alpha \\ge P_{\\mathrm{brem}} + P_{\\tau,\\mathrm{tot}}\n$$\n第二个条件评估的是仅电子本身是否能达到功率平衡。一部分比例为 $f_e = 0.85$ 的α粒子功率耦合到电子上。这种电子加热必须平衡来自电子通道的损失（轫致辐射和电子输运）：\n$$\n\\text{Ignition (electrons)} \\iff f_e \\, P_\\alpha \\ge P_{\\mathrm{brem}} + P_{\\tau,e}\n$$\n\n临界能量约束时间是通过将各自的功率平衡方程设为等式并求解 $\\tau_E$ 得出的。对于总功率平衡，我们求解 $P_\\alpha = P_{\\mathrm{brem}} + P_{\\tau,\\mathrm{tot}}(\\tau_{E,\\mathrm{crit,tot}})$：\n$$\n\\tau_{E,\\mathrm{crit,tot}} = \\frac{3 n_e k_B T}{P_\\alpha - P_{\\mathrm{brem}}}\n$$\n这仅在α粒子加热超过轫致辐射损失时，即 $P_\\alpha > P_{\\mathrm{brem}}$ 时，才具有物理意义。否则，无论约束如何，点火都不可能实现，此时定义 $\\tau_{E,\\mathrm{crit,tot}}$ 为 $+\\infty$。\n\n类似地，对于仅电子的平衡，从 $f_e P_\\alpha = P_{\\mathrm{brem}} + P_{\\tau,e}(\\tau_{E,\\mathrm{crit,e}})$ 出发：\n$$\n\\tau_{E,\\mathrm{crit,e}} = \\frac{\\frac{3}{2} n_e k_B T}{f_e P_\\alpha - P_{\\mathrm{brem}}}\n$$\n这要求 $f_e P_\\alpha > P_{\\mathrm{brem}}$，否则 $\\tau_{E,\\mathrm{crit,e}} = +\\infty$。\n\n最后，净总裕度 $\\mathcal{M}_{\\mathrm{tot}}$ 量化了功率相对于损失的盈余或亏损：\n$$\n\\mathcal{M}_{\\mathrm{tot}} = \\frac{P_\\alpha - \\left(P_{\\mathrm{brem}} + P_{\\tau,\\mathrm{tot}}\\right)}{P_{\\mathrm{brem}} + P_{\\tau,\\mathrm{tot}}}\n$$\n非负裕度（$\\mathcal{M}_{\\mathrm{tot}} \\ge 0$）等同于满足总点火条件。\n\n对于每个测试用例，我们将给定的参数 $(n_e, T, \\tau_E, Z_{\\mathrm{eff}})$ 代入这些方程，以计算所需的布尔标志和数值指标。实现将系统地计算每个功率项，然后评估最终量，确保正确的单位转换并遵守指定的插值和舍入规则。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the 0-D fusion power balance problem for a set of test cases.\n    \"\"\"\n    # Define physical constants and problem parameters\n    E_ALPHA_EV = 3.5e6  # Alpha particle energy in eV\n    E_CHARGE = 1.602176634e-19  # Elementary charge in J/eV\n    C_B = 1.69e-38  # Bremsstrahlung constant in W m^3 eV^(-1/2)\n    F_E = 0.85  # Fraction of alpha power to electrons\n\n    E_ALPHA_J = E_ALPHA_EV * E_CHARGE  # Alpha particle energy in Joules\n\n    # Tabulated D-T reactivity data\n    # T in keV,", "id": "3700254"}, {"introduction": "虽然零维模型提供了关键的全局图像，但真实的聚变等离子体并非均匀。其密度和温度在核心处达到峰值，并向边缘递减，这极大地影响了聚变功率的产生。本练习要求您超越均匀近似，分析空间和时间剖面对聚变功率密度的影响[@problem_id:3700259]。您将推导并应用峰值因子的公式，这是计算总功率输出和理解反应堆部件局部功率负荷的关键概念。", "problem": "考虑一个限制在半径为 $R$、长度为 $L$ 的正圆柱体内的氘-氚（D-T）等离子体。设氘的数密度为 $n_D(r,t)$，氚的数密度为 $n_T(r,t)$。假设两种粒子具有相同的、可分离的时空分布，由 $n_D(r,t) = n_{D,0} S_r(r;\\alpha) S_t(t;\\sigma,t_0)$ 和 $n_T(r,t) = n_{T,0} S_r(r;\\alpha) S_t(t;\\sigma,t_0)$ 给出，其中\n$$\nS_r(r;\\alpha) = \\left[1 - \\left(\\frac{r}{R}\\right)^2\\right]^{\\alpha}, \\quad 0 \\le r \\le R, \\quad \\alpha \\ge 0,\n$$\n以及\n$$\nS_t(t;\\sigma,t_0) = \\exp\\left(-\\frac{(t - t_0)^2}{2 \\sigma^2}\\right), \\quad \\sigma > 0.\n$$\n假设 D-T 反应的麦克斯韦平均反应率在空间和时间上是均匀的，等于常数 $\\langle \\sigma v \\rangle_0$。D-T 聚变每次反应释放的总能量为 $E_{\\text{tot}} = 17.6\\,\\text{MeV}$，分配给带电阿尔法粒子的能量为 $E_{\\alpha} = 3.5\\,\\text{MeV}$，分配给中子的能量为 $E_{n} = 14.1\\,\\text{MeV}$。使用 $1\\,\\text{eV} = 1.602176634\\times 10^{-19}\\,\\text{J}$ 进行单位转换。\n\n局部反应率密度由经过充分验证的关系式定义：\n$$\nR(r,t) = n_D(r,t)\\, n_T(r,t)\\, \\langle \\sigma v \\rangle_0,\n$$\n将 $E_{\\alpha}$ 和 $E_{n}$ 转换为焦耳后，对应的带电粒子和中子部分的局部聚变功率密度为\n$$\np_{\\alpha}(r,t) = R(r,t)\\, E_{\\alpha}, \\quad p_{n}(r,t) = R(r,t)\\, E_{n},\n$$\n\n将任意量 $X(r,t)$ 在圆柱体积 $V = \\pi R^2 L$ 上的体积平均定义为\n$$\n\\langle X \\rangle_V(t) = \\frac{1}{V} \\int_V X(r,t)\\, \\mathrm{d}V = \\frac{1}{\\pi R^2 L} \\int_{0}^{L} \\int_{0}^{R} \\int_{0}^{2\\pi} X(r,t)\\, r\\, \\mathrm{d}\\theta\\, \\mathrm{d}r\\, \\mathrm{d}z,\n$$\n并将随时间变化的量 $Y(t)$ 在以 $t_0$ 为中心、持续时间为 $\\Delta t$ 的窗口上的时间平均定义为\n$$\n\\langle Y \\rangle_T = \\frac{1}{\\Delta t} \\int_{t_0 - \\frac{\\Delta t}{2}}^{t_0 + \\frac{\\Delta t}{2}} Y(t)\\, \\mathrm{d}t.\n$$\n\n将时间 $t$ 时的空间峰值因子定义为\n$$\nPF_r(t) = \\frac{p_{\\text{tot}}(r=0,t)}{\\langle p_{\\text{tot}} \\rangle_V(t)}, \\quad p_{\\text{tot}}(r,t) = p_{\\alpha}(r,t) + p_{n}(r,t),\n$$\n并将 $r=0$ 处的时间峰值因子定义为\n$$\nPF_t = \\frac{p_{\\text{tot}}(r=0,t_0)}{\\langle p_{\\text{tot}}(r=0,\\cdot) \\rangle_T}.\n$$\n全局时空峰值因子为\n$$\nPF_{\\text{global}} = PF_r(t_0)\\, PF_t.\n$$\n\n仅从上述定义和提供的经过充分验证的关系式出发，推导与 $S_r(r;\\alpha)$ 和 $S_t(t;\\sigma,t_0)$ 相关的形状因子的体积平均和时间平均的表达式，然后用这些表达式获得 $\\langle p_{\\alpha} \\rangle_{V,T}$、$\\langle p_{n} \\rangle_{V,T}$、$PF_r(t_0)$、$PF_t$ 和 $PF_{\\text{global}}$ 的闭式公式。\n\n您的程序必须实现这些推导出的公式，并为下面指定的每个测试用例计算以下三个量：\n- 时空平均的带电粒子聚变功率密度 $\\langle p_{\\alpha} \\rangle_{V,T}$，单位为 $\\text{W}/\\text{m}^3$。\n- 时空平均的中子聚变功率密度 $\\langle p_{n} \\rangle_{V,T}$，单位为 $\\text{W}/\\text{m}^3$。\n- 全局峰值因子 $PF_{\\text{global}}$，为一个无量纲浮点数。\n\n所有计算都必须使用提供的输入参数进行。对于所有情况，使用 $t_0 = 0\\,\\text{s}$。圆柱几何参数 $R$ 和 $L$ 的提供是为了完整性，但在给定分布的平均计算中会被消去；除已说明的几何信息外，不要做任何额外的几何假设。\n\n测试套件（每个元组列出 $(n_{D,0}, n_{T,0}, \\alpha, \\sigma, \\Delta t, \\langle \\sigma v \\rangle_0)$，单位为 $([\\text{m}^{-3}], [\\text{m}^{-3}], [-], [\\text{s}], [\\text{s}], [\\text{m}^3/\\text{s}])$）：\n- 情况 A（均匀时空分布）：$(5.0\\times 10^{19},\\ 5.0\\times 10^{19},\\ 0.0,\\ 100.0,\\ 1.0,\\ 1.0\\times 10^{-22})$。\n- 情况 B（空间和时间上中等程度的峰化）：$(5.0\\times 10^{19},\\ 5.0\\times 10^{19},\\ 1.0,\\ 0.05,\\ 0.5,\\ 1.0\\times 10^{-22})$。\n- 情况 C（时间上强峰化，空间上峰化）：$(1.0\\times 10^{20},\\ 1.0\\times 10^{20},\\ 2.0,\\ 0.005,\\ 1.0,\\ 1.2\\times 10^{-22})$。\n- 情况 D（空间上强峰化，短脉冲）：$(3.0\\times 10^{19},\\ 3.0\\times 10^{19},\\ 9.0,\\ 0.04,\\ 0.2,\\ 8.0\\times 10^{-23})$。\n\n您的程序应生成单行输出，包含一个由方括号括起来的逗号分隔列表。每个测试用例的结果必须是包含三个浮点数的列表 $[\\langle p_{\\alpha} \\rangle_{V,T}, \\langle p_{n} \\rangle_{V,T}, PF_{\\text{global}}]$，并且程序必须按测试套件的顺序输出这些逐例列表的列表，例如 $[[x_1,y_1,z_1],[x_2,y_2,z_2],[x_3,y_3,z_3],[x_4,y_4,z_4]]$。", "solution": "用户提供了一个有效的、提法恰当的问题，该问题在科学上基于核聚变等离子体物理学的原理。所有必要的定义、参数和常数都已提供，足以推导出所需的公式并计算数值结果。我们着手进行推导。\n\n问题的核心是计算聚变功率密度的时空平均值以及相关的峰值因子。功率密度由反应率导出，而反应率又取决于粒子数密度的平方。鉴于密度分布的可分离性，问题简化为计算独立的空间和时间平均因子。我们从构建局部功率密度开始。\n\n氘和氚的数密度分别由 $n_D(r,t) = n_{D,0} S_r(r;\\alpha) S_t(t;\\sigma,t_0)$ 和 $n_T(r,t) = n_{T,0} S_r(r;\\alpha) S_t(t;\\sigma,t_0)$ 给出。局部反应率密度为 $R(r,t) = n_D(r,t)\\, n_T(r,t)\\, \\langle \\sigma v \\rangle_0$。代入密度分布可得：\n$$\nR(r,t) = n_{D,0} n_{T,0} \\langle \\sigma v \\rangle_0 [S_r(r;\\alpha)]^2 [S_t(t;\\sigma,t_0)]^2\n$$\n阿尔法粒子和中子的局部功率密度分别为 $p_{\\alpha}(r,t) = R(r,t) E_{\\alpha}$ 和 $p_{n}(r,t) = R(r,t) E_{n}$。总功率密度为 $p_{\\text{tot}}(r,t) = p_{\\alpha}(r,t) + p_{n}(r,t) = R(r,t) E_{\\text{tot}}$。\n\n对于物种 $j$（$j$ 为 $\\alpha$ 或 $n$），时空平均功率密度为 $\\langle p_j \\rangle_{V,T} = \\langle \\langle p_j(r,t) \\rangle_V \\rangle_T$。由于空间和时间分布是可分离的，这可以写成：\n$$\n\\langle p_j \\rangle_{V,T} = (n_{D,0} n_{T,0} \\langle \\sigma v \\rangle_0 E_j) \\cdot \\langle [S_r(r;\\alpha)]^2 \\rangle_V \\cdot \\langle [S_t(t;\\sigma,t_0)]^2 \\rangle_T\n$$\n项 $n_{D,0} n_{T,0} \\langle \\sigma v \\rangle_0 E_j$ 是在 $r=0$ 和 $t=t_0$ 处出现的峰值功率密度 $p_{j,peak}$。问题简化为求 $[S_r]^2$ 的体积平均和 $[S_t]^2$ 的时间平均。\n\n首先，我们推导空间形状因子平方的体积平均 $\\langle [S_r(r;\\alpha)]^2 \\rangle_V$。\n$$\n\\langle [S_r]^2 \\rangle_V = \\frac{1}{V} \\int_V [S_r(r;\\alpha)]^2\\, \\mathrm{d}V = \\frac{1}{\\pi R^2 L} \\int_{0}^{L} \\int_{0}^{R} \\int_{0}^{2\\pi} \\left[1 - \\left(\\frac{r}{R}\\right)^2\\right]^{2\\alpha} r\\, \\mathrm{d}\\theta\\, \\mathrm{d}r\\, \\mathrm{d}z\n$$\n被积函数与 $z$ 和 $\\theta$ 无关，因此对这些变量的积分产生一个因子 $2\\pi L$。\n$$\n\\langle [S_r]^2 \\rangle_V = \\frac{2\\pi L}{\\pi R^2 L} \\int_{0}^{R} \\left[1 - \\left(\\frac{r}{R}\\right)^2\\right]^{2\\alpha} r\\, \\mathrm{d}r = \\frac{2}{R^2} \\int_{0}^{R} \\left[1 - \\left(\\frac{r}{R}\\right)^2\\right]^{2\\alpha} r\\, \\mathrm{d}r\n$$\n令 $u = (r/R)^2$。则 $\\mathrm{d}u = 2r/R^2 \\mathrm{d}r$，积分限从 $[0, R]$ 变为 $[0, 1]$。\n$$\n\\langle [S_r]^2 \\rangle_V = \\int_{0}^{1} (1-u)^{2\\alpha} \\mathrm{d}u = \\left[-\\frac{(1-u)^{2\\alpha+1}}{2\\alpha+1}\\right]_0^1 = 0 - \\left(-\\frac{1}{2\\alpha+1}\\right) = \\frac{1}{2\\alpha+1}\n$$\n此结果对于 $\\alpha > -1/2$ 成立，这满足问题约束 $\\alpha \\ge 0$。\n\n其次，我们推导时间形状因子平方的时间平均 $\\langle [S_t(t;\\sigma,t_0)]^2 \\rangle_T$。\n$$\n\\langle [S_t]^2 \\rangle_T = \\frac{1}{\\Delta t} \\int_{t_0 - \\frac{\\Delta t}{2}}^{t_0 + \\frac{\\Delta t}{2}} \\left[\\exp\\left(-\\frac{(t - t_0)^2}{2 \\sigma^2}\\right)\\right]^2 \\mathrm{d}t = \\frac{1}{\\Delta t} \\int_{t_0 - \\frac{\\Delta t}{2}}^{t_0 + \\frac{\\Delta t}{2}} \\exp\\left(-\\frac{(t - t_0)^2}{\\sigma^2}\\right) \\mathrm{d}t\n$$\n令 $u = (t - t_0)/\\sigma$。则 $\\mathrm{d}t = \\sigma \\mathrm{d}u$，积分限变为 $[-\\frac{\\Delta t}{2\\sigma}, \\frac{\\Delta t}{2\\sigma}]$。\n$$\n\\langle [S_t]^2 \\rangle_T = \\frac{\\sigma}{\\Delta t} \\int_{-\\frac{\\Delta t}{2\\sigma}}^{\\frac{\\Delta t}{2\\sigma}} e^{-u^2} \\mathrm{d}u\n$$\n该积分与误差函数 $\\text{erf}(x) = \\frac{2}{\\sqrt{\\pi}} \\int_0^x e^{-t^2} \\mathrm{d}t$ 相关，注意到对于像 $e^{-u^2}$ 这样的偶函数 $f(u)$，有 $\\int_{-a}^{a} f(u) \\mathrm{d}u = 2 \\int_0^a f(u) \\mathrm{d}u$。\n$$\n\\int_{-\\frac{\\Delta t}{2\\sigma}}^{\\frac{\\Delta t}{2\\sigma}} e^{-u^2} \\mathrm{d}u = \\sqrt{\\pi} \\, \\text{erf}\\left(\\frac{\\Delta t}{2\\sigma}\\right)\n$$\n因此，时间平均因子是：\n$$\n\\langle [S_t]^2 \\rangle_T = \\frac{\\sigma\\sqrt{\\pi}}{\\Delta t} \\text{erf}\\left(\\frac{\\Delta t}{2\\sigma}\\right)\n$$\n现在我们可以写出时空平均功率密度的最终表达式：\n$$\n\\langle p_{\\alpha} \\rangle_{V,T} = (n_{D,0} n_{T,0} \\langle \\sigma v \\rangle_0 E_{\\alpha}) \\left(\\frac{1}{2\\alpha+1}\\right) \\left(\\frac{\\sigma\\sqrt{\\pi}}{\\Delta t} \\text{erf}\\left(\\frac{\\Delta t}{2\\sigma}\\right)\\right)\n$$\n$$\n\\langle p_{n} \\rangle_{V,T} = (n_{D,0} n_{T,0} \\langle \\sigma v \\rangle_0 E_{n}) \\left(\\frac{1}{2\\alpha+1}\\right) \\left(\\frac{\\sigma\\sqrt{\\pi}}{\\Delta t} \\text{erf}\\left(\\frac{\\Delta t}{2\\sigma}\\right)\\right)\n$$\n其中 $E_{\\alpha}$ 和 $E_n$ 必须从 MeV 转换为焦耳。\n\n接下来，我们推导峰值因子。在时间 $t_0$ 的空间峰值因子是：\n$$\nPF_r(t_0) = \\frac{p_{\\text{tot}}(r=0, t_0)}{\\langle p_{\\text{tot}} \\rangle_V(t_0)}\n$$\n在 $r=0$ 和 $t=t_0$ 时，形状因子为 $S_r(0;\\alpha)=1$ 和 $S_t(t_0;\\sigma,t_0)=1$。\n$p_{\\text{tot}}(r=0, t_0) = n_{D,0} n_{T,0} \\langle \\sigma v \\rangle_0 E_{\\text{tot}}$。\n$\\langle p_{\\text{tot}} \\rangle_V(t_0) = n_{D,0} n_{T,0} \\langle \\sigma v \\rangle_0 E_{\\text{tot}} \\cdot \\langle [S_r]^2 \\rangle_V \\cdot [S_t(t_0)]^2 = p_{\\text{tot}}(r=0,t_0) \\cdot \\frac{1}{2\\alpha+1} \\cdot 1$。\n$$\nPF_r(t_0) = \\frac{p_{\\text{tot}}(r=0, t_0)}{p_{\\text{tot}}(r=0, t_0) \\cdot \\frac{1}{2\\alpha+1}} = 2\\alpha+1\n$$\n时间峰值因子是：\n$$\nPF_t = \\frac{p_{\\text{tot}}(r=0, t_0)}{\\langle p_{\\text{tot}}(r=0,\\cdot) \\rangle_T}\n$$\n分母是 $\\langle p_{\\text{tot}}(r=0,t) \\rangle_T = \\langle p_{\\text{tot}}(r=0,t_0) [S_t(t)]^2 \\rangle_T = p_{\\text{tot}}(r=0,t_0) \\langle [S_t]^2 \\rangle_T$。\n$$\nPF_t = \\frac{p_{\\text{tot}}(r=0,t_0)}{p_{\\text{tot}}(r=0,t_0) \\langle [S_t]^2 \\rangle_T} = \\frac{1}{\\langle [S_t]^2 \\rangle_T} = \\frac{\\Delta t}{\\sigma\\sqrt{\\pi} \\text{erf}\\left(\\frac{\\Delta t}{2\\sigma}\\right)}\n$$\n最后，全局时空峰值因子是两者的乘积：\n$$\nPF_{\\text{global}} = PF_r(t_0) \\cdot PF_t = (2\\alpha+1) \\left(\\frac{\\Delta t}{\\sigma\\sqrt{\\pi} \\text{erf}\\left(\\frac{\\Delta t}{2\\sigma}\\right)}\\right)\n$$\n这些推导出的公式将在程序中实现，用以计算每个测试用例所需的量。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import erf\n\ndef solve():\n    \"\"\"\n    Solves the fusion power density problem by deriving and applying\n    closed-form formulas for space-time averaged power densities and peaking factors.\n    \"\"\"\n    \n    # Define physical constants and conversion factors.\n    EV_TO_J = 1.602176634e-19\n    E_ALPHA_MEV = 3.5  # MeV\n    E_NEUTRON_MEV = 14.1 # MeV\n    \n    # Convert energies to Joules.\n    e_alpha_j = E_ALPHA_MEV * 1e6 * EV_TO_J\n    e_neutron_j = E_NEUTRON_MEV * 1e6 * EV_TO_J\n    \n    # Define the test cases from the problem statement.\n    # Each tuple: (n_D0 [m^-3], n_T0 [m^-3], alpha [-], sigma [s], delta_t [s], sv0 [m^3/s])\n    test_cases = [\n        (5.0e19, 5.0e19, 0.0, 100.0, 1.0, 1.0e-22), # Case A\n        (5.0e19, 5.0e19, 1.0, 0.05, 0.5, 1.0e-22),  # Case B\n        (1.0e20, 1.0e20, 2.0, 0.005, 1.0, 1.2e-22), # Case C\n        (3.0e19, 3.0e19, 9.0, 0.04, 0.2, 8.0e-23)   # Case D\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        n_d0, n_t0, alpha, sigma, delta_t, sv0 = case\n        \n        # Calculate the peak power density coefficients (at r=0, t=t0).\n        peak_power_coeff = n_d0 * n_t0 * sv0\n        p_alpha_peak = peak_power_coeff * e_alpha_j\n        p_neutron_peak = peak_power_coeff * e_neutron_j\n        \n        # Calculate the spatial averaging factor for power (proportional to S_r^2).\n        # F_space =", "id": "3700259"}]}