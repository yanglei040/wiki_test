{"hands_on_practices": [{"introduction": "理论的基石是能够从第一性原理推导出核心概念。这个练习将引导你从基础的磁流体动力学（MHD）方程出发，推导阿尔芬时间 $\\tau_A$ 和磁扩散时间 $\\tau_R$。通过计算这两个时间尺度的比值，你将亲手构建出伦奎斯特数 $S$，从而深刻理解其作为衡量理想MHD行为与电阻耗散效应相对重要性的物理本质 [@problem_id:3707898]。", "problem": "一个小半径为 $L$ 的直的、轴对称的聚变等离子体柱由单流体、电阻磁流体力学（MHD）方程建模。等离子体柱中贯穿着一个大小为 $B_0$ 的均匀轴向磁场，并且具有由50-50的氘-氚离子混合物决定的均匀质量密度 $\\rho$。该等离子体是完全电离的、电中性的，并且电子质量与离子质量相比可以忽略不计。为了研究波的动力学，假设存在小振幅、不可压缩的扰动，并忽略粘度和压力梯度。\n\n从电阻磁流体力学的动量方程和感应方程出发，推导特征阿尔芬速度 $v_A$、在尺度 $L$ 上的阿尔芬时间 $\\tau_A$ 以及在相同尺度上的磁扩散时间 $\\tau_R$ 的表达式。利用这些表达式，推导无量纲的伦奎斯特数 $S$，其定义为扩散时间尺度与阿尔芬时间尺度的比值。然后，使用以下参数对 $S$ 进行数值计算：\n- 特征长度 $L = 0.50\\,\\mathrm{m}$，\n- 背景磁场 $B_0 = 5.0\\,\\mathrm{T}$，\n- 离子数密度 $n_i = 1.00 \\times 10^{20}\\,\\mathrm{m}^{-3}$，\n- 50-50氘-氚混合物的平均离子质量 $m_i = 2.5\\,m_u$，其中 $m_u = 1.66054 \\times 10^{-27}\\,\\mathrm{kg}$，\n- 平行斯皮策电阻率 $\\eta = 1.00 \\times 10^{-8}\\,\\Omega\\cdot\\mathrm{m}$，\n- 真空磁导率 $\\mu_0 = 4\\pi \\times 10^{-7}\\,\\mathrm{H}/\\mathrm{m}$。\n\n使用 $\\rho = n_i m_i$ 计算质量密度。将最终答案表示为一个无量纲数，并将结果四舍五入到三位有效数字。", "solution": "问题要求推导阿尔芬速度 $v_A$、阿尔芬时间 $\\tau_A$、磁扩散时间 $\\tau_R$ 和伦奎斯特数 $S$，然后针对给定的聚变等离子体参数对 $S$ 进行数值计算。该分析基于特定假设下的单流体、电阻磁流体力学（MHD）方程。\n\n围绕一个具有磁场 $\\mathbf{B}_0$ 和质量密度 $\\rho$ 的静态（$\\mathbf{v}_0=0$）、均匀平衡态的小的、不可压缩的扰动（$\\mathbf{v}_1$, $\\mathbf{B}_1$）的基本方程是：\n线性化的动量方程：\n$$ \\rho \\frac{\\partial \\mathbf{v}_1}{\\partial t} = \\frac{1}{\\mu_0}(\\nabla \\times \\mathbf{B}_1) \\times \\mathbf{B}_0 $$\n包含电阻率 $\\eta$ 的线性化感应方程：\n$$ \\frac{\\partial \\mathbf{B}_1}{\\partial t} = \\nabla \\times (\\mathbf{v}_1 \\times \\mathbf{B}_0) + \\frac{\\eta}{\\mu_0} \\nabla^2 \\mathbf{B}_1 $$\n这里我们利用了以下事实：对于均匀场 $\\mathbf{B}_0$，其旋度为零（$\\nabla \\times \\mathbf{B}_0 = 0$）；对于均匀电阻率 $\\eta$，利用矢量恒等式 $\\nabla \\times (\\nabla \\times \\mathbf{A}) = \\nabla(\\nabla \\cdot \\mathbf{A}) - \\nabla^2 \\mathbf{A}$ 和螺线管条件 $\\nabla \\cdot \\mathbf{B} = 0$，电阻项可如上所示简化。\n\n首先，我们推导特征阿尔芬速度 $v_A$。这在理想MHD极限下推导，其中电阻率被忽略（$\\eta=0$）。感应方程变为：\n$$ \\frac{\\partial \\mathbf{B}_1}{\\partial t} = \\nabla \\times (\\mathbf{v}_1 \\times \\mathbf{B}_0) $$\n我们可以对这两个理想方程在特征长度尺度 $L$ 和时间尺度 $\\tau$ 上进行量纲分析。\n从动量方程：$\\rho \\frac{v}{t} \\sim \\frac{B^2}{\\mu_0 L}$。在我们的情况下，这即是 $\\rho \\frac{|\\mathbf{v}_1|}{\\tau} \\sim \\frac{|\\mathbf{B}_1| |\\mathbf{B}_0|}{\\mu_0 L}$。\n从理想感应方程：$\\frac{B}{t} \\sim \\frac{vB}{L}$。这即是 $\\frac{|\\mathbf{B}_1|}{\\tau} \\sim \\frac{|\\mathbf{v}_1||\\mathbf{B}_0|}{L}$。\n从第二个关系式，我们可以将 $|\\mathbf{B}_1|$ 表示为 $|\\mathbf{B}_1| \\sim \\frac{\\tau |\\mathbf{v}_1| |\\mathbf{B}_0|}{L}$。将其代入第一个关系式，得到：\n$$ \\rho \\frac{|\\mathbf{v}_1|}{\\tau} \\sim \\frac{1}{\\mu_0 L} \\left(\\frac{\\tau |\\mathbf{v}_1| |\\mathbf{B}_0|}{L}\\right) |\\mathbf{B}_0| $$\n$$ \\rho \\sim \\frac{\\tau^2 B_0^2}{\\mu_0 L^2} $$\n从这种平衡中导出的特征时间尺度是阿尔芬时间 $\\tau_A$，所以我们设 $\\tau = \\tau_A$。特征速度是阿尔芬速度 $v_A = L/\\tau_A$。求解 $v_A$：\n$$ v_A^2 = \\frac{L^2}{\\tau_A^2} = \\frac{B_0^2}{\\mu_0 \\rho} $$\n因此，阿尔芬速度为：\n$$ v_A = \\frac{B_0}{\\sqrt{\\mu_0 \\rho}} $$\n阿尔芬时间 $\\tau_A$ 是阿尔芬波传播特征距离 $L$ 所需的时间：\n$$ \\tau_A = \\frac{L}{v_A} = \\frac{L\\sqrt{\\mu_0 \\rho}}{B_0} $$\n\n接下来，我们推导磁扩散时间 $\\tau_R$。这个时间尺度控制着由电阻率引起的磁场耗散。我们考虑在没有流体运动（$\\mathbf{v}=0$）的情况下的感应方程：\n$$ \\frac{\\partial \\mathbf{B}}{\\partial t} = \\frac{\\eta}{\\mu_0} \\nabla^2 \\mathbf{B} $$\n这是一个扩散方程，其中磁扩散系数为 $D_m = \\eta/\\mu_0$。进行量纲分析：\n$$ \\frac{|\\mathbf{B}|}{\\tau_R} \\sim \\frac{\\eta}{\\mu_0} \\frac{|\\mathbf{B}|}{L^2} $$\n求解扩散时间 $\\tau_R$：\n$$ \\tau_R = \\frac{\\mu_0 L^2}{\\eta} $$\n\n伦奎斯特数 $S$ 是磁扩散时间与阿尔芬时间的无量纲比值。它量化了理想MHD动力学与电阻耗散的相对重要性。\n$$ S = \\frac{\\tau_R}{\\tau_A} $$\n代入推导出的 $\\tau_R$ 和 $\\tau_A$ 的表达式：\n$$ S = \\frac{\\mu_0 L^2 / \\eta}{L\\sqrt{\\mu_0 \\rho} / B_0} = \\frac{\\mu_0 L^2 B_0}{\\eta L \\sqrt{\\mu_0 \\rho}} = \\frac{L B_0 \\sqrt{\\mu_0}}{\\eta \\sqrt{\\rho}} $$\n\n现在，我们使用给定的参数对 $S$ 进行数值计算：\n- $L = 0.50\\,\\mathrm{m}$\n- $B_0 = 5.0\\,\\mathrm{T}$\n- 离子数密度 $n_i = 1.00 \\times 10^{20}\\,\\mathrm{m}^{-3}$\n- 50-50氘-氚混合物的平均离子质量 $m_i = 2.5\\,m_u$，其中 $m_u = 1.66054 \\times 10^{-27}\\,\\mathrm{kg}$。所以，$m_i = 2.5 \\times 1.66054 \\times 10^{-27}\\,\\mathrm{kg} = 4.15135 \\times 10^{-27}\\,\\mathrm{kg}$。\n- 平行斯皮策电阻率 $\\eta = 1.00 \\times 10^{-8}\\,\\Omega\\cdot\\mathrm{m}$\n- 真空磁导率 $\\mu_0 = 4\\pi \\times 10^{-7}\\,\\mathrm{H}/\\mathrm{m}$\n\n首先，使用给定的关系式 $\\rho = n_i m_i$ 计算等离子体质量密度 $\\rho$：\n$$ \\rho = (1.00 \\times 10^{20}\\,\\mathrm{m}^{-3}) \\times (4.15135 \\times 10^{-27}\\,\\mathrm{kg}) = 4.15135 \\times 10^{-7}\\,\\mathrm{kg \\cdot m^{-3}} $$\n现在，我们可以将所有数值代入 $S$ 的表达式中：\n$$ S = \\frac{(0.50\\,\\mathrm{m}) \\times (5.0\\,\\mathrm{T}) \\times \\sqrt{4\\pi \\times 10^{-7}\\,\\mathrm{H/m}}}{(1.00 \\times 10^{-8}\\,\\Omega\\cdot\\mathrm{m}) \\times \\sqrt{4.15135 \\times 10^{-7}\\,\\mathrm{kg/m^3}}} $$\n$$ S = \\frac{2.5 \\times \\sqrt{4\\pi \\times 10^{-7}}}{1.00 \\times 10^{-8} \\times \\sqrt{4.15135 \\times 10^{-7}}} = \\frac{2.5 \\times 10^8 \\times \\sqrt{4\\pi \\times 10^{-7}}}{\\sqrt{4.15135 \\times 10^{-7}}} $$\n$$ S = 2.5 \\times 10^8 \\times \\sqrt{\\frac{4\\pi \\times 10^{-7}}{4.15135 \\times 10^{-7}}} = 2.5 \\times 10^8 \\times \\sqrt{\\frac{4\\pi}{4.15135}} $$\n$$ S \\approx 2.5 \\times 10^8 \\times \\sqrt{\\frac{12.56637}{4.15135}} \\approx 2.5 \\times 10^8 \\times \\sqrt{3.0270} $$\n$$ S \\approx 2.5 \\times 10^8 \\times 1.73983 $$\n$$ S \\approx 4.34957 \\times 10^8 $$\n将结果四舍五入到三位有效数字，我们得到 $4.35 \\times 10^8$。$S$ 的巨大数值证实了对于典型的聚变等离子体，在宏观尺度和快速时间尺度上，理想MHD模型是一个极好的近似，因为相比之下，电阻效应非常缓慢。", "answer": "$$\\boxed{4.35 \\times 10^8}$$", "id": "3707898"}, {"introduction": "在真实的聚变等离子体中，伦奎斯特数并非一个固定不变的常数，而是会随着等离子体状态的改变而变化。本练习将探讨等离子体电阻率对电子温度 $T_e$ 和有效离子电荷数 $Z_{\\text{eff}}$ 的依赖关系，即著名的斯皮策电阻率。通过分析不同运行场景下的伦奎斯特数，你将理解为何等离子体的温度和纯度对于抑制电阻性不稳定性至关重要 [@problem_id:3707896]。", "problem": "在一个磁约束聚变装置中，一个环向约束的等离子体在电阻磁流体动力学（MHD）的框架下进行建模。该等离子体主要由氘组成，并混有少量全电离的高$Z$杂质，因此质量密度主要由氘离子决定，并在所考虑的场景中保持有效恒定。假设准中性，且碰撞输运由库仑相互作用主导，库仑对数为常数。考虑在同一装置中，具有相同磁几何和磁场的以下两种稳态场景：\n\n- 场景A（基准）：电子温度 $T_{e,1} = 10\\,\\text{keV}$，有效离子电荷数 $Z_{\\text{eff},1} = 1.6$，电子数密度 $n_{e,1} = 8.0 \\times 10^{19}\\,\\text{m}^{-3}$，磁场 $B = 5.0\\,\\text{T}$，特征长度 $L = 0.60\\,\\text{m}$。\n- 场景B（富含杂质，温度较低）：电子温度 $T_{e,2} = 6.0\\,\\text{keV}$，有效离子电荷数 $Z_{\\text{eff},2} = 2.4$，电子数密度 $n_{e,2} = 8.0 \\times 10^{19}\\,\\text{m}^{-3}$，与场景A具有相同的 $B$ 和 $L$。\n\n从电子动量平衡和库仑碰撞的动理学理论出发，论证电阻率对温度和杂质（通过 $Z_{\\text{eff}}$）的依赖关系，然后用适当的等离子体和磁场参数以及电阻率来表示伦德奎斯特数 $S$。在不同场景中将库仑对数视为常数，并假设质量密度 $\\rho$ 在不同场景之间保持主导阶不变。\n\n计算场景B相对于场景A的伦德奎斯特数之比 $S_{2}/S_{1}$。将最终比值四舍五入到三位有效数字。该比值为无量纲数；最终答案中不要包含任何单位。", "solution": "该问题需要分三部分回答：首先，论证等离子体电阻率对温度和杂质含量的物理依赖关系；其次，给出伦德奎斯特数的表达式；第三，计算两种不同等离子体场景下伦德奎斯特数的比值。\n\n首先，我们讨论电阻率，用 $\\eta$ 表示。在磁流体力学（MHD）的框架下，电阻率源于碰撞过程中电子和离子之间的动量传递。出发点是稳态电子动量平衡方程：\n$$0 = -e n_e (\\vec{E} + \\vec{v}_e \\times \\vec{B}) - \\nabla p_e - \\vec{R}_{ei}$$\n其中 $e$ 是元电荷，$n_e$ 是电子数密度，$\\vec{E}$ 是电场，$\\vec{v}_e$ 是电子流体速度，$\\vec{B}$ 是磁场，$p_e$ 是电子压力，$\\vec{R}_{ei}$ 是单位体积内由碰撞引起的从电子到离子的总动量传递率（碰撞摩擦力）。\n\n欧姆定律将电场与电流密度 $\\vec{j}$ 联系起来。在简化形式下，忽略霍尔项和压力梯度项，平行于磁场的分量为 $\\vec{E}_{\\parallel} = \\eta \\vec{j}_{\\parallel}$。从电子动量平衡方程出发，取平行于 $\\vec{B}$ 的分量，$\\vec{v}_e \\times \\vec{B}$ 项消失，剩下 $e n_e E_{\\parallel} = -R_{ei, \\parallel}$。平行电流密度主要由电子携带，因此 $\\vec{j}_{\\parallel} \\approx -e n_e \\vec{v}_{e,\\parallel}$（假设离子是静止的）。因此，电阻率由下式给出：\n$$\\eta = \\frac{E_{\\parallel}}{j_{\\parallel}} = \\frac{-R_{ei, \\parallel} / (e n_e)}{-e n_e v_{e,\\parallel}} = \\frac{R_{ei, \\parallel}}{e^2 n_e^2 v_{e,\\parallel}}$$\n其中 $v_{e,\\parallel}$ 是相对于离子的平行电子流体速度。\n\n摩擦力 $\\vec{R}_{ei}$ 是电子与等离子体中存在的所有离子种类碰撞的净结果。对于电荷为 $Z_s e$、数密度为 $n_s$ 的单一离子种类 '$s$'，摩擦力与每次碰撞电子损失的动量和碰撞率成正比。它可以表示为 $\\vec{R}_{es} = -m_e n_e \\nu_{es} \\vec{v}_{e,rel}$，其中 $m_e$ 是电子质量，$\\nu_{es}$ 是电子与离子种类 '$s$' 的碰撞频率，$\\vec{v}_{e,rel}$ 是电子和离子之间的相对漂移速度。对所有离子种类求和，总摩擦力为 $\\vec{R}_{ei} = \\sum_s \\vec{R}_{es}$。\n\n根据库仑碰撞的动理学理论，热速度为 $v_{th,e}$ 的电子与离子种类 '$s$' 碰撞的碰撞频率 $\\nu_{es}$ 的标度关系如下：\n$$\\nu_{es} \\propto \\frac{n_s (Z_s e)^2 e^2 \\ln \\Lambda}{m_e^2 v_{th,e}^3}$$\n其中 $\\ln \\Lambda$ 是库仑对数，我们视其为常数。电子热速度与电子温度 $T_e$ 的关系为 $\\frac{1}{2}m_e v_{th,e}^2 \\propto k_B T_e$，因此 $v_{th,e} \\propto T_e^{1/2}$。这导致了碰撞频率的特征温度依赖性：$\\nu_{es} \\propto n_s Z_s^2 T_e^{-3/2}$。\n\n与电阻率相关的总摩擦力涉及对所有离子种类的求和：总动量传递率与 $\\sum_s n_s Z_s^2$ 成正比。这个和可以方便地用有效离子电荷数 $Z_{\\text{eff}}$ 表示，其定义为：\n$$Z_{\\text{eff}} = \\frac{\\sum_s n_s Z_s^2}{n_e}$$\n结合这些结果，总有效电子-离子碰撞频率的标度关系为 $\\nu_{ei,eff} \\propto Z_{\\text{eff}} n_e T_e^{-3/2}$。电阻率 $\\eta \\propto \\nu_{ei,eff}/n_e$。因此，电阻率的标度关系为：\n$$\\eta \\propto \\frac{Z_{\\text{eff}} n_e T_e^{-3/2}}{n_e} = \\frac{Z_{\\text{eff}}}{T_e^{3/2}}$$\n这就是著名的Spitzer电阻率标度关系。它表明电阻率随着杂质含量的增加（更高的 $Z_{\\text{eff}}$）而增加，并随着电子温度的升高而急剧下降。\n\n其次，我们表达伦奎斯特数 $S$。这个无量纲数表示电阻扩散时间尺度 $\\tau_R$ 与阿尔芬渡越时间尺度 $\\tau_A$ 的比值。\n$$S = \\frac{\\tau_R}{\\tau_A}$$\n电阻扩散时间是磁场在长度尺度 $L$ 上扩散的特征时间。在国际单位制中，它由 $\\tau_R = \\frac{\\mu_0 L^2}{\\eta}$ 给出，其中 $\\mu_0$ 是真空磁导率。\n阿尔芬渡越时间是阿尔芬波在长度尺度 $L$ 上传播所需的时间，由 $\\tau_A = \\frac{L}{v_A}$ 给出。阿尔芬速度 $v_A$ 定义为：\n$$v_A = \\frac{B}{\\sqrt{\\mu_0 \\rho}}$$\n其中 $\\rho$ 是等离子体质量密度。\n结合这些表达式，伦奎斯特数为：\n$$S = \\frac{\\mu_0 L^2 / \\eta}{L / v_A} = \\frac{\\mu_0 L v_A}{\\eta} = \\frac{\\mu_0 L}{\\eta} \\left( \\frac{B}{\\sqrt{\\mu_0 \\rho}} \\right) = \\frac{L B \\sqrt{\\mu_0}}{\\eta \\sqrt{\\rho}}$$\n\n第三，我们计算场景B与场景A的伦奎斯特数之比 $S_2/S_1$。使用导出的 $S$ 表达式：\n$$S_1 = \\frac{L_1 B_1 \\sqrt{\\mu_0}}{\\eta_1 \\sqrt{\\rho_1}} \\quad \\text{和} \\quad S_2 = \\frac{L_2 B_2 \\sqrt{\\mu_0}}{\\eta_2 \\sqrt{\\rho_2}}$$\n问题指出，特征长度 $L$、磁场 $B$ 和质量密度 $\\rho$ 在两种场景中是相同的（$L_1=L_2$、$B_1=B_2$、$ \\rho_1=\\rho_2$）。常数 $\\mu_0$ 是普适的。因此，该比值简化为：\n$$\\frac{S_2}{S_1} = \\frac{\\eta_1}{\\eta_2}$$\n使用电阻率标度关系 $\\eta \\propto Z_{\\text{eff}} T_e^{-3/2}$（因为假定库仑对数是常数），我们有：\n$$\\frac{\\eta_1}{\\eta_2} = \\frac{C \\cdot Z_{\\text{eff},1} / T_{e,1}^{3/2}}{C \\cdot Z_{\\text{eff},2} / T_{e,2}^{3/2}} = \\frac{Z_{\\text{eff},1}}{Z_{\\text{eff},2}} \\left( \\frac{T_{e,2}}{T_{e,1}} \\right)^{3/2}$$\n所以，伦奎斯特数的比值为：\n$$\\frac{S_2}{S_1} = \\frac{Z_{\\text{eff},1}}{Z_{\\text{eff},2}} \\left( \\frac{T_{e,2}}{T_{e,1}} \\right)^{3/2}$$\n我们已知以下数值：\n$Z_{\\text{eff},1} = 1.6$, $T_{e,1} = 10.0\\,\\text{keV}$\n$Z_{\\text{eff},2} = 2.4$, $T_{e,2} = 6.0\\,\\text{keV}$\n将这些值代入比值表达式中：\n$$\\frac{S_2}{S_1} = \\frac{1.6}{2.4} \\left( \\frac{6.0\\,\\text{keV}}{10.0\\,\\text{keV}} \\right)^{3/2} = \\frac{2}{3} (0.6)^{3/2}$$\n现在，我们计算数值：\n$$(0.6)^{3/2} = 0.6 \\times \\sqrt{0.6} \\approx 0.6 \\times 0.77459667 = 0.46475800$$\n$$\\frac{S_2}{S_1} = \\frac{2}{3} \\times 0.46475800 \\approx 0.30983867$$\n将结果四舍五入到三位有效数字，我们得到 $0.310$。这表明，与场景A相比，场景B中的等离子体相对于其阿尔芬时间尺度而言，电阻性显著更强（表现出更快的磁扩散），这主要是由于其较低的温度和较高的杂质含量。", "answer": "$$\\boxed{0.310}$$", "id": "3707896"}, {"introduction": "理论概念只有在实际应用中才能展现其真正的力量。这个练习将磁扩散理论应用于托卡马克装置电流启动阶段的一个关键物理现象——“趋肤效应”。你将推导磁场扩散方程，并编写一个程序来计算不同等离子体参数下的电流穿透深度，从而直观地感受到伦奎斯特数的大小如何决定磁场在等离子体中渗透的快慢 [@problem_id:3707901]。", "problem": "将单流体磁流体动力学（MHD）近似应用于电流启动过程中的环形等离子体，重点关注磁扩散和趋肤效应。考虑托卡马克小半径的平板模型，该模型被建模为占据 $x \\ge 0$ 的一维半无限导电介质，等离子体初始处于静止状态。在 $t=0$ 时，于 $x=0$ 处施加一个阶跃激励，使得边界处的磁场突然改变，从而驱动电流向等离子体内部扩散。该等离子体的特征参数包括电阻率 $\\eta$（单位为 $\\Omega \\cdot \\mathrm{m}$）、质量密度 $\\rho$（单位为 $\\mathrm{kg}/\\mathrm{m}^3$）、自由空间磁导率 $\\mu_0 = 4\\pi \\times 10^{-7}\\,\\mathrm{H}/\\mathrm{m}$ 和背景磁场 $B$（单位为 $\\mathrm{T}$）。托卡马克小半径由特征长度尺度 $L$（单位为 $\\mathrm{m}$）表示。\n\n从基本关系式出发：\n- 麦克斯韦-法拉第定律 $\\nabla \\times \\mathbf{E} = -\\partial \\mathbf{B}/\\partial t$，\n- 忽略位移电流的安培定律 $\\nabla \\times \\mathbf{B} = \\mu_0 \\mathbf{J}$，\n- 欧姆定律 $\\mathbf{E} = \\eta \\mathbf{J}$，\n在等离子体流动可忽略和环向对称的假设下，推导等离子体中磁扩散的控制方程。由此，用 $\\eta$ 和 $\\mu_0$ 表示扩散系数。然后，对于边界上的阶跃变化，确定随时间变化的电流穿透剖面，并根据准则 $J(\\delta(t),t)/J(0,t) = e^{-1}$，用扩散系数定义趋肤深度 $\\delta(t)$。\n\n伦德奎斯特数 (Lundquist number) $S$ 定义为磁扩散时间 $\\tau_R$ 与阿尔芬（磁声）渡越时间 $\\tau_A$ 的比值，其中 $\\tau_R$ 由磁场跨越特征长度 $L$ 的扩散决定，而 $\\tau_A$ 由阿尔芬速度决定。阿尔芬速度 $V_A$ 定义为 $V_A = B/\\sqrt{\\mu_0 \\rho}$。使用这些定义，用 $\\mu_0$、$L$、$V_A$ 和 $\\eta$ 表示 $S$。\n\n实现一个程序，对每个测试用例计算：\n1. 伦德奎斯特数 $S$（无量纲）。\n2. 磁扩散时间 $\\tau_R$，单位为秒。\n3. 基于阶跃边界激励的趋肤效应和扩散方程，计算在三个指定时间 $t_1$、$t_2$ 和 $t_3$ 的趋肤深度 $\\delta(t)$，单位为米。\n4. 比值 $r = J(\\delta(t_3), t_3)/J(0, t_3)$（无量纲），如果推导和计算一致，该值应等于 $e^{-1}$。\n\n使用以下测试套件值（所有值均采用国际单位制（SI））：\n\n- 测试用例1（高约束核心类似参数）：\n  - $L = 1.0\\,\\mathrm{m}$,\n  - $B = 5.0\\,\\mathrm{T}$,\n  - $n_i = 1.0 \\times 10^{20}\\,\\mathrm{m}^{-3}$,\n  - $m_i = 3.344 \\times 10^{-27}\\,\\mathrm{kg}$,\n  - $\\eta = 1.0 \\times 10^{-8}\\,\\Omega \\cdot \\mathrm{m}$,\n  - $t_1 = 1.0 \\times 10^{-6}\\,\\mathrm{s}$, $t_2 = 1.0 \\times 10^{-3}\\,\\mathrm{s}$, $t_3 = 1.0 \\times 10^{-1}\\,\\mathrm{s}$.\n\n- 测试用例2（具有较高电阻率的边缘类似参数）：\n  - $L = 0.5\\,\\mathrm{m}$,\n  - $B = 2.0\\,\\mathrm{T}$,\n  - $n_i = 5.0 \\times 10^{19}\\,\\mathrm{m}^{-3}$,\n  - $m_i = 3.344 \\times 10^{-27}\\,\\mathrm{kg}$,\n  - $\\eta = 1.0 \\times 10^{-5}\\,\\Omega \\cdot \\mathrm{m}$,\n  - $t_1 = 1.0 \\times 10^{-6}\\,\\mathrm{s}$, $t_2 = 1.0 \\times 10^{-3}\\,\\mathrm{s}$, $t_3 = 1.0 \\times 10^{-1}\\,\\mathrm{s}$.\n\n- 测试用例3（小尺度、高电阻率瞬态）：\n  - $L = 0.05\\,\\mathrm{m}$,\n  - $B = 1.0\\,\\mathrm{T}$,\n  - $n_i = 1.0 \\times 10^{18}\\,\\mathrm{m}^{-3}$,\n  - $m_i = 3.344 \\times 10^{-27}\\,\\mathrm{kg}$,\n  - $\\eta = 1.0 \\times 10^{-3}\\,\\Omega \\cdot \\mathrm{m}$,\n  - $t_1 = 1.0 \\times 10^{-6}\\,\\mathrm{s}$, $t_2 = 1.0 \\times 10^{-3}\\,\\mathrm{s}$, $t_3 = 1.0 \\times 10^{-1}\\,\\mathrm{s}$.\n\n对于所有计算：\n- 使用 $\\rho = n_i m_i$。\n- 将 $\\tau_R$ 以 $\\mathrm{s}$ 表示，$\\delta(t)$ 以 $\\mathrm{m}$ 表示，$S$ 为无量纲。\n- 将报告的每个浮点数四舍五入到六位小数。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，$[result_1, result_2, \\ldots]$）。\n- 按顺序附加测试用例的结果。对于每个测试用例，按序列 $[S, \\tau_R, \\delta(t_1), \\delta(t_2), \\delta(t_3), r]$ 附加六个数字。\n- 因此，最终的单行必须包含由一对平方括号括起来的 $18$ 个逗号分隔的数字。", "solution": "目标是在托卡马克相关背景下，将磁扩散与伦德奎斯特数联系起来，并为定义的测试套件生成一个计算实现。推导过程始于核心电动力学和磁流体动力学（MHD）简化。\n\n出发点与假设：\n- 等离子体被视为具有电阻率 $\\eta$ 的导电介质，并且初始时处于静止状态，因此在启动扩散期间，由流动引起的平流可以忽略不计（$\\mathbf{v} \\approx \\mathbf{0}$）。\n- 我们采用一维平板几何来描述小半径，$x \\ge 0$，这能捕捉磁场和电流的径向扩散。\n\n根据麦克斯韦-法拉第定律、欧姆定律和安培定律：\n- 麦克斯韦-法拉第：$\\nabla \\times \\mathbf{E} = -\\dfrac{\\partial \\mathbf{B}}{\\partial t}$。\n- 欧姆：$\\mathbf{E} = \\eta \\mathbf{J}$。\n- 安培（无位移电流）：$\\nabla \\times \\mathbf{B} = \\mu_0 \\mathbf{J}$。\n\n消去 $\\mathbf{E}$ 和 $\\mathbf{J}$ 可得到感应方程。对欧姆定律取旋度，并通过安培定律代入：\n$$\n\\nabla \\times \\mathbf{E} = \\nabla \\times (\\eta \\mathbf{J}) = \\eta \\nabla \\times \\mathbf{J} = \\eta \\nabla \\times \\left(\\dfrac{1}{\\mu_0} \\nabla \\times \\mathbf{B}\\right).\n$$\n使用麦克斯韦-法拉第定律：\n$$\n-\\dfrac{\\partial \\mathbf{B}}{\\partial t} = \\dfrac{\\eta}{\\mu_0} \\nabla \\times (\\nabla \\times \\mathbf{B}).\n$$\n对于均匀的 $\\eta$ 并且在没有磁单极子（$\\nabla \\cdot \\mathbf{B} = 0$）的情况下，矢量恒等式 $\\nabla \\times (\\nabla \\times \\mathbf{B}) = \\nabla(\\nabla \\cdot \\mathbf{B}) - \\nabla^2 \\mathbf{B}$ 将其简化为：\n$$\n\\dfrac{\\partial \\mathbf{B}}{\\partial t} = \\dfrac{\\eta}{\\mu_0} \\nabla^2 \\mathbf{B}.\n$$\n这就是磁扩散方程，其形式与热方程相同，扩散系数为\n$$\nD = \\dfrac{\\eta}{\\mu_0}.\n$$\n\n阶跃边界激励的趋肤效应：\n考虑一个半无限域 $x \\ge 0$，在 $t=0$ 时，于 $x=0$ 处施加一个突变的磁场边界变化。对于边界条件 $B(0,t) = B_0$（$t \\ge 0$）和初始条件 $B(x,0) = 0$ 的扩散方程，其相似解为\n$$\nB(x,t) = B_0 \\,\\mathrm{erfc}\\!\\left(\\dfrac{x}{2\\sqrt{D t}}\\right),\n$$\n其中 $\\mathrm{erfc}$ 是互补误差函数。相关的电流密度剖面，使用平板形式的安培定律（对于适当的定向，$\\partial B/\\partial x = \\mu_0 J$），为\n$$\nJ(x,t) = \\dfrac{1}{\\mu_0}\\dfrac{\\partial B}{\\partial x} = \\dfrac{B_0}{\\mu_0} \\left[-\\dfrac{1}{\\sqrt{\\pi D t}} \\exp\\!\\left(-\\dfrac{x^2}{4 D t}\\right)\\right].\n$$\n除去一个取决于所选 $\\mathbf{B}$ 方向和电流方向的符号， $J$ 的大小随 $x$ 呈高斯衰减，其时间依赖的尺度由 $D t$ 设定。该剖面与其边界值之比为\n$$\n\\dfrac{J(x,t)}{J(0,t)} = \\exp\\!\\left(-\\dfrac{x^2}{4 D t}\\right).\n$$\n根据 $1/e$ 准则定义趋肤深度 $\\delta(t)$：\n$$\n\\dfrac{J(\\delta(t),t)}{J(0,t)} = e^{-1} \\quad \\Rightarrow \\quad \\exp\\!\\left(-\\dfrac{\\delta(t)^2}{4 D t}\\right) = e^{-1}.\n$$\n求解 $\\delta(t)$ 得\n$$\n\\delta(t) = 2\\sqrt{D t}.\n$$\n这是扩散导体中阶跃激励的瞬态趋肤深度。\n\n磁扩散时间与伦奎斯特数：\n跨越长度尺度 $L$ 的特征磁扩散时间为\n$$\n\\tau_R = \\dfrac{\\mu_0 L^2}{\\eta}.\n$$\n阿尔芬速度定义为\n$$\nV_A = \\dfrac{B}{\\sqrt{\\mu_0 \\rho}},\n$$\n阿尔芬渡越时间为 $\\tau_A = L / V_A$。伦奎斯特数是这两个时间的比值，\n$$\nS = \\dfrac{\\tau_R}{\\tau_A} = \\dfrac{\\mu_0 L V_A}{\\eta}.\n$$\n这个无量纲数比较了理想的、由波介导的输运与电阻性扩散。大的 $S$ 值表示在尺度 $L$ 上，理想MHD效应相对于电阻性扩散占主导地位。\n\n算法设计：\n- 每个测试用例的输入参数：$L$、$B$、$n_i$、$m_i$、$\\eta$ 以及时间 $t_1$、$t_2$、$t_3$。\n- 计算质量密度 $\\rho = n_i m_i$。\n- 计算阿尔芬速度 $V_A = B / \\sqrt{\\mu_0 \\rho}$。\n- 计算磁扩散时间 $\\tau_R = \\mu_0 L^2 / \\eta$。\n- 计算伦德奎斯特数 $S = \\mu_0 L V_A / \\eta$。\n- 计算扩散系数 $D = \\eta / \\mu_0$。\n- 计算趋肤深度 $\\delta(t_k) = 2 \\sqrt{D t_k}$，其中 $k \\in \\{1,2,3\\}$。\n- 计算比值 $r = \\exp\\!\\left(-\\dfrac{\\delta(t_3)^2}{4 D t_3}\\right)$，在理想推导中，该值应精确等于 $e^{-1}$。数值舍入将产生 $r \\approx e^{-1}$。\n- 在打印前将所有输出四舍五入到六位小数。\n- 生成单行输出，其中包含所有测试用例的串联结果，每个用例按顺序 $[S, \\tau_R, \\delta(t_1), \\delta(t_2), \\delta(t_3), r]$ 排列。\n\n科学真实性：\n参数的选择反映了合理的托卡马克核心、边缘和小尺度高电阻率瞬态条件。扩散系数值和产生的趋肤深度跨越多个数量级，测试了快速和慢速扩散两种机制。伦德奎斯特数范围从非常大（典型核心）到中等小，检验了类理想和电阻主导两种机制。\n\n边界情况与覆盖范围：\n- 测试用例1验证了慢扩散和小瞬态趋肤深度下的高 $S$ 行为。\n- 测试用例2检验了电阻率增加和显著瞬态趋肤深度下的中等 $S$ 行为。\n- 测试用例3探讨了高电阻率下小尺度的快速扩散，其中 $\\tau_R$ 非常短，$\\delta(t)$ 迅速超过 $L$。\n\n所有报告的量纲都是一致的：\n- $S$ 是无量纲的，\n- $\\tau_R$ 单位是秒，\n- $\\delta(t)$ 单位是米，\n- $r$ 是无量纲的。\n\n最终程序根据推导出的表达式直接计算这些值，并生成指定的单行输出。", "answer": "```python\nimport numpy as np\n\ndef compute_case(L, B, n_i, m_i, eta, times):\n    \"\"\"\n    为给定的测试用例计算 S, tau_R, delta(t1), delta(t2), delta(t3), r。\n    所有计算均使用国际单位制（SI）。\n    \"\"\"\n    mu0 = 4.0 * np.pi * 1e-7  # H/m (亨利/米)\n    rho = n_i * m_i           # kg/m^3 (千克/立方米)\n    # 阿尔芬速度\n    VA = B / np.sqrt(mu0 * rho)\n    # 磁扩散时间\n    tau_R = mu0 * L**2 / eta\n    # 伦奎斯特数\n    S = mu0 * L * VA / eta\n    # 扩散系数\n    D = eta / mu0\n    # 指定时间的趋肤深度\n    deltas = [2.0 * np.sqrt(D * t) for t in times]\n    # 使用导出的电流剖面计算最后一个时间的比值\n    t_last = times[-1]\n    delta_last = deltas[-1]\n    r = np.exp(- (delta_last**2) / (4.0 * D * t_last))\n    return S, tau_R, deltas, r\n\ndef format_number(x):\n    # 将浮点数格式化为六位小数，如果可能，不使用科学记数法。\n    return f\"{x:.6f}\"\n\ndef solve():\n    # 定义题目中的测试用例。\n    test_cases = [\n        # (L [米], B [特斯拉], n_i [1/立方米], m_i [千克], eta [欧姆·米], [t1, t2, t3] [秒])\n        (1.0, 5.0, 1.0e20, 3.344e-27, 1.0e-8, [1.0e-6, 1.0e-3, 1.0e-1]),\n        (0.5, 2.0, 5.0e19, 3.344e-27, 1.0e-5, [1.0e-6, 1.0e-3, 1.0e-1]),\n        (0.05, 1.0, 1.0e18, 3.344e-27, 1.0e-3, [1.0e-6, 1.0e-3, 1.0e-1]),\n    ]\n\n    results = []\n    for case in test_cases:\n        L, B, n_i, m_i, eta, times = case\n        S, tau_R, deltas, r = compute_case(L, B, n_i, m_i, eta, times)\n        # 按指定顺序追加结果：S, tau_R, delta(t1), delta(t2), delta(t3), r\n        results.extend([\n            format_number(S),\n            format_number(tau_R),\n            format_number(deltas[0]),\n            format_number(deltas[1]),\n            format_number(deltas[2]),\n            format_number(r),\n        ])\n\n    # 以要求的精确格式进行最终打印。\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3707901"}]}