{"hands_on_practices": [{"introduction": "¹³C NMR谱为我们提供了分子中每个唯一碳原子的信号，但标准的宽带去偶谱图并不能直接揭示每个碳原子上连接的氢原子数量。为了解决这个问题，我们使用如DEPT（无畸变极化转移增强）等谱编辑技术。这项练习 [@problem_id:3690552] 将测试您解读DEPT-135谱图的核心技能，通过分析信号的有无来准确区分没有直接连接氢的季碳原子和带有质子的碳原子。", "problem": "已知一种未知的芳香族化合物 $X$ 含有一个带有烷氧基取代基的苯型环和一个杂芳环，该杂芳环中的一个环氮原子是 $\\pi$ 体系的一部分。$X$ 在芳香区的宽带¹³C核磁共振（NMR）谱显示出 $8$ 个不同的信号，其化学位移 $\\delta$ 分别为 $162.4$、$157.8$、$149.2$、$137.0$、$129.4$、$124.6$、$117.8$ 和 $114.0 \\ \\mathrm{ppm}$。在无畸变极化转移增强（DEPT）-$135$ 实验谱中，$\\delta = 129.4$、$124.6$、$117.8$ 和 $114.0 \\ \\mathrm{ppm}$ 处出现正信号，而在 $\\delta = 162.4$、$157.8$、$149.2$ 和 $137.0 \\ \\mathrm{ppm}$ 处没有信号。\n\n根据核磁共振（NMR）中化学屏蔽的第一性原理——即观测到的化学位移 $\\delta$ 反映了外部施加的磁场与电子环流（包括芳香环电流各向异性）产生的局部屏蔽之间的平衡，并且吸电子杂原子（如 $\\mathrm{O}$ 和 $\\mathrm{N}$）会调节所连接碳原子上的电子密度和 $\\pi$-各向异性——请确定观测到的 $\\delta$ 值中，哪一个子集对应于 $X$ 中的季芳香碳或杂芳香碳（即没有直接连接氢原子的碳）。\n\n选择正确的选项：\n- A: $\\delta = 162.4$、$157.8$、$149.2$ 和 $137.0 \\ \\mathrm{ppm}$\n\n- B: $\\delta = 162.4$ 和 $149.2 \\ \\mathrm{ppm}$\n\n- C: $\\delta = 157.8$、$137.0$ 和 $129.4 \\ \\mathrm{ppm}$\n\n- D: $\\delta = 162.4$、$157.8$ 和 $129.4 \\ \\mathrm{ppm}$", "solution": "该问题要求根据所提供的¹³C核磁共振（NMR）和无畸变极化转移增强（DEPT）波谱数据，鉴定未知芳香族化合物 $X$ 中的季碳信号。\n\n首先，我们对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- 未知化合物 $X$ 含有一个带有烷氧基取代基的苯型环。\n- 化合物 $X$ 还含有一个杂芳环，其环氮原子是 $\\pi$ 体系的一部分。\n- 宽带去耦¹³C NMR谱在芳香区显示出 $8$ 个不同的信号，化学位移 $\\delta$ 分别为 $162.4$、$157.8$、$149.2$、$137.0$、$129.4$、$124.6$、$117.8$ 和 $114.0 \\ \\mathrm{ppm}$。\n- DEPT-$135$ 实验显示在 $\\delta = 129.4$、$124.6$、$117.8$ 和 $114.0 \\ \\mathrm{ppm}$ 处有正信号。\n- DEPT-$135$ 谱显示在 $\\delta = 162.4$、$157.8$、$149.2$ 和 $137.0 \\ \\mathrm{ppm}$ 处没有信号（零信号）。\n- 问题是鉴定对应于季芳香碳或杂芳香碳的信号子集。\n\n**步骤2：使用提取的已知条件进行验证**\n这个问题是有科学依据的。使用¹³C NMR和DEPT-$135$波谱法来确定碳的多重性是有机结构解析中的一项标准和基本技术。所提供的化学位移值对于所述的化学环境（芳香碳、烷氧基中与氧相连的碳、以及含氮杂芳环中的碳）是符合实际的。这个问题是适定的，因为所提供的数据充分且内部一致，足以得出一个唯一的解。语言客观而精确。问题陈述是有效的。\n\n**解题推导**\n\n这个问题的核心在于对DEPT谱的解读。DEPT脉冲序列旨在根据直接连接的氢原子数量来区分碳信号。具体来说，DEPT-$135$ 实验提供以下信息：\n- 带有一个氢的碳（次甲基，$\\mathrm{CH}$）产生正信号。\n- 带有两个氢的碳（亚甲基，$\\mathrm{CH}_2$）产生负信号。\n- 带有三个氢的碳（甲基，$\\mathrm{CH}_3$）产生正信号。\n- 不带氢的碳（季碳，$\\mathrm{C}$）不产生信号（零结果）。\n\n问题提供了来自两个实验的数据：一个显示所有碳信号的宽带¹³C谱，以及一个根据上述规则编辑的 DEPT-$135$ 谱。\n\n让我们分析所提供的数据：\n1.  **宽带¹³C信号**：$\\delta = 162.4, 157.8, 149.2, 137.0, 129.4, 124.6, 117.8, 114.0 \\ \\mathrm{ppm}$。这些代表了分子芳香区中所有 $8$ 个独特的碳环境。\n\n2.  **DEPT-$135$ 正信号**：$\\delta = 129.4, 124.6, 117.8, 114.0 \\ \\mathrm{ppm}$。根据DEPT-$135$的规则，正信号对应于 $\\mathrm{CH}$ 或 $\\mathrm{CH}_3$ 基团。由于这些信号位于芳香区（通常 $\\delta > 100 \\ \\mathrm{ppm}$），它们必须归属于 $\\mathrm{CH}$（次甲基）碳。典型有机分子中的 $\\mathrm{CH}_3$ 碳在更高场（更低的 $\\delta$ 值）处共振。\n\n3.  **DEPT-$135$ 零信号**：$\\delta = 162.4, 157.8, 149.2, 137.0 \\ \\mathrm{ppm}$。这些信号出现在宽带谱中，但在DEPT-$135$谱中缺失。根据规则，这表明这些信号源于没有直接连接氢原子的碳。因此，这些是季碳。\n\n问题陈述指导我们使用“化学屏蔽的第一性原理”。这些原理解释了信号的*位置*（$\\delta$ 值）。例如，在 $\\delta = 162.4 \\ \\mathrm{ppm}$ 和 $\\delta = 157.8 \\ \\mathrm{ppm}$ 处的非常去屏蔽的信号是直接与电负性氧原子键合的芳香碳的特征（例如，在烷氧基中，C-OR 通常出现在 $\\delta = 155-165 \\ \\mathrm{ppm}$ 范围内）。类似地，$\\delta = 149.2 \\ \\mathrm{ppm}$ 处的信号是杂芳环中与氮原子相邻的碳原子的典型信号（例如，吡啶中的 $\\alpha$-碳）。尽管这些原理有助于理解化学位移的结构来源，但它们不是确定多重性（即碳是否为季碳）的主要工具。用于鉴定季碳的决定性信息是由 DEPT-$135$ 实验提供的。\n\n基于对DEPT-$135$数据的直接解读，对应于季芳香碳或杂芳香碳的信号集合是 $\\{\\delta = 162.4, 157.8, 149.2, 137.0 \\ \\mathrm{ppm}\\}$。\n\n**选项评估**\n\n- **A: $\\delta = 162.4$、$157.8$、$149.2$ 和 $137.0 \\ \\mathrm{ppm}$**\n此选项列出了在DEPT-$135$谱中缺失（归零）的所有信号。根据DEPT-$135$实验的原理，这些信号对应于季碳。此选项与我们的推导一致。\n**结论：正确**\n\n- **B: $\\delta = 162.4$ 和 $149.2 \\ \\mathrm{ppm}$**\n此选项是一个不完整的列表。它忽略了 $\\delta = 157.8 \\ \\mathrm{ppm}$ 和 $\\delta = 137.0 \\ \\mathrm{ppm}$ 处的信号，这些信号在DEPT-$135$谱中也缺失，因此也是季碳。\n**结论：不正确**\n\n- **C: $\\delta = 157.8$、$137.0$ 和 $129.4 \\ \\mathrm{ppm}$**\n此选项错误地包含了 $\\delta = 129.4 \\ \\mathrm{ppm}$ 处的信号。该信号在DEPT-$135$谱中为正，表明它是一个 $\\mathrm{CH}$ 碳，而不是季碳。该列表也不完整，因为它忽略了 $\\delta = 162.4 \\ \\mathrm{ppm}$ 和 $\\delta = 149.2 \\ \\mathrm{ppm}$ 处的季碳信号。\n**结论：不正确**\n\n- **D: $\\delta = 162.4$、$157.8$ 和 $129.4 \\ \\mathrm{ppm}$**\n与选项C类似，此选项错误地包含了 $\\delta = 129.4 \\ \\mathrm{ppm}$ 处的信号，该信号对应于一个 $\\mathrm{CH}$ 碳。它还忽略了 $\\delta = 149.2 \\ \\mathrm{ppm}$ 和 $\\delta = 137.0 \\ \\mathrm{ppm}$ 处的季碳信号。\n**结论：不正确**\n\n唯一根据所提供的波谱数据正确鉴定出完整季碳信号集的选项是A。", "answer": "$$\\boxed{A}$$", "id": "3690552"}, {"introduction": "能够解读谱图后，下一步是理解并预测化学位移的来源。一个强大且实用的方法是使用基于取代基化学位移（Substituent Chemical Shifts, SCS）的加和模型，尤其适用于取代苯体系。这项练习 [@problem_id:3690560] 让您亲手应用这个经验模型，通过将各个取代基在其相对位置（即*ipso*、*ortho*、*meta*和*para*）的贡献值进行简单叠加，来计算目标碳原子的化学位移。这有助于将抽象的电子效应概念转化为具体的数值预测。", "problem": "在¹³C核磁共振（NMR）波谱学中，观测到的化学位移源于原子核处的电子屏蔽张量，这可以根据Ramsey屏蔽机制中的抗磁性和顺磁性贡献来解释。在芳香环内，各向异性环电流和取代基驱动的局部电子结构微扰，会对邻位、间位、对位和原地碳的化学位移产生特征性的位置效应。在一阶微扰框架下，只要交叉项和高阶耦合可以忽略不计，这些取代基效应就可以被视为相对于未取代苯的、可加和的、与位置相关的化学位移增量。\n\n假设以下经过充分测试和经验校准的参考值以及取代基诱导的增量（所有值均为相对于苯的化学位移增量，正值表示去屏蔽，负值表示屏蔽）。设苯的参考¹³C化学位移为$\\delta_{0} = 128.5$ ppm（百万分率）。对于相对于目标碳原子处于给定位置的取代基$S$，将其增量表示为$\\Delta\\delta_{S}(\\text{position})$，其中位置包括原地（ipso）、邻位（ortho）、间位（meta）和对位（para）。使用以下数据：\n\n- 甲氧基（$\\mathrm{OCH_{3}}$）：$\\Delta\\delta_{\\mathrm{OMe}}(\\text{ipso}) = +30.0$，$\\Delta\\delta_{\\mathrm{OMe}}(\\text{ortho}) = -13.0$，$\\Delta\\delta_{\\mathrm{OMe}}(\\text{meta}) = +0.5$，$\\Delta\\delta_{\\mathrm{OMe}}(\\text{para}) = -14.0$。\n- 硝基（$\\mathrm{NO_{2}}$）：$\\Delta\\delta_{\\mathrm{NO_{2}}}(\\text{ipso}) = +20.0$，$\\Delta\\delta_{\\mathrm{NO_{2}}}(\\text{ortho}) = +7.0$，$\\Delta\\delta_{\\mathrm{NO_{2}}}(\\text{meta}) = +1.5$，$\\Delta\\delta_{\\mathrm{NO_{2}}}(\\text{para}) = +12.0$。\n- 氟（$\\mathrm{F}$）：$\\Delta\\delta_{\\mathrm{F}}(\\text{ipso}) = +35.0$，$\\Delta\\delta_{\\mathrm{F}}(\\text{ortho}) = +3.0$，$\\Delta\\delta_{\\mathrm{F}}(\\text{meta}) = +1.0$，$\\Delta\\delta_{\\mathrm{F}}(\\text{para}) = +5.0$。\n\n考虑三取代芳香族化合物1-氟-2-甲氧基-4-硝基苯，并将带有氟的环碳标记为$C_{1}$。环按顺序编号，使甲氧基位于$C_{2}$，硝基位于$C_{4}$。根据上述一阶加和增量模型，并忽略超出给定增量编码范围的长程耦合，确定¹³C化学位移$\\delta(C_{1})$的预测值（以ppm为单位）。\n\n最终答案以ppm为单位表示，并四舍五入至四位有效数字。", "solution": "该问题是有效的，因为它科学地基于核磁共振（NMR）波谱学的原理，特别是使用取代基化学位移（SCS）增量来经验性预测¹³C化学位移。该问题陈述清晰、客观，并包含了得出唯一解所需的所有必要信息。\n\n任务是预测1-氟-2-甲氧基-4-硝基苯中碳原子$C_1$的¹³C化学位移。计算基于一阶加和模型，其中给定碳原子的化学位移是未取代苯中碳的化学位移$\\delta_0$与环上每个取代基的经验确定增量之和。碳原子$C_i$的预测化学位移$\\delta(C_i)$的通用公式为：\n$$\n\\delta(C_i) = \\delta_0 + \\sum_{S} \\Delta\\delta_{S}(\\text{position})\n$$\n其中$\\delta_0$是苯的参考化学位移，$\\Delta\\delta_{S}(\\text{position})$是取代基$S$在相对于碳原子$C_i$的特定位置（原地、邻位、间位、对位）的化学位移增量。\n\n问题提供了以下数据：\n- 苯的参考化学位移：$\\delta_0 = 128.5$ ppm。\n- 该化合物是1-氟-2-甲氧基-4-硝基苯，取代基分别位于$C_1$、$C_2$和$C_4$位置。\n- 提供了氟（$\\mathrm{F}$）、甲氧基（$\\mathrm{OCH_3}$）和硝基（$\\mathrm{NO_2}$）基团的取代基增量$\\Delta\\delta_{S}(\\text{position})$。\n\n我们需要计算碳原子$C_1$的化学位移，该碳原子与氟取代基相连。为此，我们必须确定每个取代基相对于$C_1$的位置关系，并对相应的增量求和。\n\n1.  **氟（$\\mathrm{F}$）基团对$C_1$的影响**：氟基团直接与$C_1$键合。这是**原地（ipso）**位置。从提供的数据中取相关增量：\n    $$\n    \\Delta\\delta_{\\mathrm{F}}(\\text{ipso}) = +35.0\n    $$\n\n2.  **甲氧基（$\\mathrm{OCH_3}$）基团对$C_1$的影响**：甲氧基位于$C_2$位置。$C_1$和$C_2$之间的关系是**邻位（ortho）**。相关增量为：\n    $$\n    \\Delta\\delta_{\\mathrm{OMe}}(\\text{ortho}) = -13.0\n    $$\n\n3.  **硝基（$\\mathrm{NO_2}$）基团对$C_1$的影响**：硝基位于$C_4$位置。在六元芳香环中，位置1和4之间的关系是**对位（para）**。相关增量为：\n    $$\n    \\Delta\\delta_{\\mathrm{NO_2}}(\\text{para}) = +12.0\n    $$\n\n现在，我们应用加和模型来计算$C_1$的预测化学位移，记为$\\delta(C_1)$：\n$$\n\\delta(C_1) = \\delta_0 + \\Delta\\delta_{\\mathrm{F}}(\\text{ipso}) + \\Delta\\delta_{\\mathrm{OMe}}(\\text{ortho}) + \\Delta\\delta_{\\mathrm{NO_2}}(\\text{para})\n$$\n代入给定的数值：\n$$\n\\delta(C_1) = 128.5 + (+35.0) + (-13.0) + (+12.0)\n$$\n进行求和：\n$$\n\\delta(C_1) = 128.5 + 35.0 - 13.0 + 12.0\n$$\n$$\n\\delta(C_1) = 163.5 - 13.0 + 12.0\n$$\n$$\n\\delta(C_1) = 150.5 + 12.0\n$$\n$$\n\\delta(C_1) = 162.5\n$$\n计算出的化学位移为$162.5$ ppm。问题要求答案四舍五入到四位有效数字。数字$162.5$已经包含四位有效数字，因此无需进一步四舍五入。", "answer": "$$\n\\boxed{162.5}\n$$", "id": "3690560"}, {"introduction": "虽然经验模型很有用，但现代化学研究越来越依赖于从第一性原理出发的量子化学计算来获得更精确的预测。然而，计算出的绝对磁屏蔽值（$\\sigma$）并不能直接等同于实验测得的化学位移（$\\delta$），它们之间需要进行校准。这项高级练习 [@problem_id:3690556] 模拟了一个真实的研究场景，您将通过最小二乘法拟合，建立一个从头算（*ab initio*）计算结果到实验数据的线性映射模型。这不仅是连接理论与实验的关键步骤，也是高精度谱图预测领域的核心技术。", "problem": "您将执行一项基于核磁共振（NMR）波谱学和计算化学的校准任务。目标是推导并实现一个仿射校准，将芳香和杂环芳香体系中碳核的计算各向同性核屏蔽值映射到实验¹³C化学位移。\n\n从以下基本原理开始：\n- 在NMR中，原子核的共振频率取决于有效磁场，而有效磁场会因电子屏蔽而减弱。如果外部磁场为 $B_0$，无量纲的屏蔽常数为 $\\sigma$，那么对于足够小的 $\\sigma$，有效磁场为 $B_{\\mathrm{eff}} = B_0 (1 - \\sigma)$。\n- ¹³C化学位移定义为 $\\delta = \\left(\\frac{\\nu - \\nu_{\\mathrm{ref}}}{\\nu_{\\mathrm{ref}}}\\right) \\times 10^6$（百万分率，ppm），其中 $\\nu$ 是样品的共振频率，$\\nu_{\\mathrm{ref}}$ 是参比物质（通常是四甲基硅烷（TMS））的共振频率。\n- 规范不变原子轨道（GIAO）密度泛函理论（DFT）计算可以得到每个原子核的绝对各向同性屏蔽值 $\\sigma^{\\mathrm{calc}}$。由于计算方法和基组依赖的偏差，通常需要进行线性校准，以便将计算出的屏蔽值差异转换为同一标度下的实验化学位移。\n\n基于这些原理，推导构建一个从计算屏蔽值差异到实验化学位移的仿射映射，并推导出一个最小二乘法程序，以从训练集中确定校准参数。\n\n校准设置：\n- 提供一个固定的TMS计算参考屏蔽值为 $\\,\\sigma_{\\mathrm{ref}}^{\\mathrm{calc}} = 188.000000\\,$ (ppm)。\n- 训练集包含芳香和杂环芳香碳的配对 $\\left(\\sigma_i^{\\mathrm{calc}}, \\delta_i^{\\mathrm{exp}}\\right)$，所有值均以ppm为单位：\n  - $\\left(58.714286, 128.5\\right)$\n  - $\\left(50.040816, 137.0\\right)$\n  - $\\left(27.591837, 159.0\\right)$\n  - $\\left(73.510204, 114.0\\right)$\n  - $\\left(38.816327, 148.0\\right)$\n  - $\\left(36.469388, 150.3\\right)$\n  - $\\left(63.306122, 124.0\\right)$\n  - $\\left(44.938776, 142.0\\right)$\n  - $\\left(77.591837, 110.0\\right)$\n  - $\\left(60.244898, 127.0\\right)$\n  - $\\left(62.795918, 124.5\\right)$\n  - $\\left(54.632653, 132.5\\right)$\n\n任务：\n1. 仅使用上述基本定义，推导出一个参数线性的校准模型，将计算的屏蔽差 $\\,\\Delta \\sigma_i = \\sigma_{\\mathrm{ref}}^{\\mathrm{calc}} - \\sigma_i^{\\mathrm{calc}}\\,$ 映射到实验化学位移 $\\,\\delta_i^{\\mathrm{exp}}\\,$。使用所提供的训练数据，通过最小二乘法确定校准系数。\n2. 应用拟合的校准模型，为以下计算屏蔽值的测试集预测 $\\,\\delta^{\\mathrm{pred}}\\,$（以ppm为单位），所有值均以ppm为单位：\n   - $\\,37.081633\\,$\n   - $\\,50.551020\\,$\n   - $\\,63.816327\\,$\n   - $\\,59.734694\\,$\n   - $\\,31.673469\\,$\n   - $\\,56.163265\\,$\n\n数值和输出要求：\n- 所有化学位移 $\\,\\delta\\,$ 必须以ppm为单位表示，并四舍五入到一位小数。\n- 您的程序必须根据训练集计算最小二乘校准，然后输出对测试集的预测。\n- 最终输出格式必须是单行，包含一个用方括号括起来的逗号分隔列表，没有空格，例如 $[\\delta_1,\\delta_2,\\delta_3,\\delta_4,\\delta_5,\\delta_6]$。将每个 $\\,\\delta_k\\,$ 替换为以ppm为单位的四舍五入后的数值。\n\n测试集覆盖范围说明：\n- 该集合包括具有显著去屏蔽效应的杂环芳香碳（例如，接近 $\\,155.0\\,$ ppm）和位于 $\\,110.0\\,$ 到 $\\,130.0\\,$ ppm附近的屏蔽效应更强的芳香碳位置，涵盖了典型的芳香区域，确保校准在有意义的范围内得到测试。\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，$[\\delta_1,\\delta_2,\\delta_3,\\delta_4,\\delta_5,\\delta_6]$）。", "solution": "问题陈述已经过严格评估，被确定为科学上合理、定义明确、客观且自洽。它提出了计算化学和NMR波谱学中的一个标准校准任务，并提供了所有必要的数据和定义。没有发现任何可能使其无效的缺陷、矛盾或模糊之处。因此，我们可以进行正式求解。\n\n任务是建立一个将计算的核屏蔽常数映射到实验化学位移的仿射校准，通过对训练数据集进行最小二乘拟合来确定校准参数，并应用所得模型预测测试集的化学位移。\n\n**步骤1：校准模型的推导**\n\n原子核的拉莫尔频率 $\\nu$、外部磁场 $B_0$、旋磁比 $\\gamma$ 和无量纲各向同性屏蔽常数 $\\sigma$ 之间的关系由下式给出：\n$$ \\nu = \\frac{\\gamma}{2\\pi} B_{\\mathrm{eff}} = \\frac{\\gamma}{2\\pi} B_0 (1 - \\sigma) $$\n化学位移 $\\delta$ 以百万分率（ppm）表示，是相对于参比化合物（例如TMS）定义的：\n$$ \\delta = \\left(\\frac{\\nu - \\nu_{\\mathrm{ref}}}{\\nu_{\\mathrm{ref}}}\\right) \\times 10^6 $$\n将样品和参比物的 $\\nu$ 表达式代入：\n$$ \\delta = \\left(\\frac{\\frac{\\gamma}{2\\pi} B_0 (1 - \\sigma) - \\frac{\\gamma}{2\\pi} B_0 (1 - \\sigma_{\\mathrm{ref}})}{\\frac{\\gamma}{2\\pi} B_0 (1 - \\sigma_{\\mathrm{ref}})}\\right) \\times 10^6 $$\n$\\frac{\\gamma}{2\\pi} B_0$ 项被消去，得到：\n$$ \\delta = \\left(\\frac{(1 - \\sigma) - (1 - \\sigma_{\\mathrm{ref}})}{1 - \\sigma_{\\mathrm{ref}}}\\right) \\times 10^6 = \\left(\\frac{\\sigma_{\\mathrm{ref}} - \\sigma}{1 - \\sigma_{\\mathrm{ref}}}\\right) \\times 10^6 $$\n由于核屏蔽常数 $\\sigma$ 通常在ppm（$10^{-6}$）量级，分母中的 $\\sigma_{\\mathrm{ref}}$ 项与1相比非常小。因此，$1 - \\sigma_{\\mathrm{ref}} \\approx 1$。理论关系简化为：\n$$ \\delta \\approx (\\sigma_{\\mathrm{ref}} - \\sigma) \\times 10^6 $$\n如果屏蔽值 $\\sigma$ 和 $\\sigma_{\\mathrm{ref}}$ 本身以ppm为单位表示，则理想关系为 $\\delta_{\\mathrm{ppm}} \\approx \\sigma_{\\mathrm{ref, ppm}} - \\sigma_{\\mathrm{ppm}}$。\n\n然而，像GIAO-DFT等方法计算出的屏蔽值（$\\sigma^{\\mathrm{calc}}$）会受到所选泛函、基组和其他近似带来的系统误差的影响。为了校正这些偏差，采用了经验性的仿射校准。我们将预测的实验化学位移 $\\delta^{\\mathrm{pred}}$ 建模为计算屏蔽差 $\\Delta\\sigma = \\sigma_{\\mathrm{ref}}^{\\mathrm{calc}} - \\sigma^{\\mathrm{calc}}$ 的线性函数：\n$$ \\delta_i^{\\mathrm{pred}} = m \\cdot (\\sigma_{\\mathrm{ref}}^{\\mathrm{calc}} - \\sigma_i^{\\mathrm{calc}}) + c $$\n在这里，$m$ 是一个校正尺度误差的斜率参数，$c$ 是一个校正恒定偏移的截距。我们的目标是通过将此模型拟合到提供的 $N$ 对 $(\\sigma_i^{\\mathrm{calc}}, \\delta_i^{\\mathrm{exp}})$ 训练数据中，找到 $m$ 和 $c$ 的最优值。设 $x_i = \\sigma_{\\mathrm{ref}}^{\\mathrm{calc}} - \\sigma_i^{\\mathrm{calc}}$ 和 $y_i = \\delta_i^{\\mathrm{exp}}$。该模型是一个简单的线性回归：$y_i \\approx m x_i + c$。\n\n**步骤2：参数的最小二乘法确定**\n\n参数 $m$ 和 $c$ 是通过最小化模型预测值与训练集实验值之间的误差平方和（SSE）来确定的：\n$$ \\mathrm{SSE}(m, c) = \\sum_{i=1}^{N} (\\delta_i^{\\mathrm{exp}} - \\delta_i^{\\mathrm{pred}})^2 = \\sum_{i=1}^{N} (y_i - (m x_i + c))^2 $$\n为求最小值，我们将 $\\mathrm{SSE}$ 对 $m$ 和 $c$ 的偏导数设为零，从而得到线性最小二乘问题的正规方程组：\n$$ \\frac{\\partial(\\mathrm{SSE})}{\\partial m} = -2 \\sum_{i=1}^{N} x_i(y_i - m x_i - c) = 0 $$\n$$ \\frac{\\partial(\\mathrm{SSE})}{\\partial c} = -2 \\sum_{i=1}^{N} (y_i - m x_i - c) = 0 $$\n这导出了一个关于 $m$ 和 $c$ 的二元线性方程组：\n$$\n\\begin{pmatrix}\n\\sum_{i=1}^{N} x_i^2 & \\sum_{i=1}^{N} x_i \\\\\n\\sum_{i=1}^{N} x_i & N\n\\end{pmatrix}\n\\begin{pmatrix} m \\\\ c \\end{pmatrix}\n=\n\\begin{pmatrix}\n\\sum_{i=1}^{N} x_i y_i \\\\\n\\sum_{i=1}^{N} y_i\n\\end{pmatrix}\n$$\n该方程组的解给出了斜率和截距的著名公式：\n$$ m = \\frac{N \\sum x_i y_i - (\\sum x_i)(\\sum y_i)}{N \\sum x_i^2 - (\\sum x_i)^2} $$\n$$ c = \\bar{y} - m \\bar{x}, \\quad \\text{其中} \\quad \\bar{x} = \\frac{1}{N}\\sum x_i \\quad \\text{且} \\quad \\bar{y} = \\frac{1}{N}\\sum y_i $$\n\n**步骤3：校准参数的计算**\n\n我们使用提供的训练数据和固定的计算参考屏蔽值 $\\sigma_{\\mathrm{ref}}^{\\mathrm{calc}} = 188.000000$ ppm。训练集包含 $N=12$ 对数据。首先，我们为每个数据点计算自变量 $x_i = \\Delta\\sigma_i = \\sigma_{\\mathrm{ref}}^{\\mathrm{calc}} - \\sigma_i^{\\mathrm{calc}}$。因变量为 $y_i = \\delta_i^{\\mathrm{exp}}$。\n\n训练数据如下：\n- $y = (\\delta_i^{\\mathrm{exp}})_{\\mathrm{ppm}} = [128.5, 137.0, 159.0, 114.0, 148.0, 150.3, 124.0, 142.0, 110.0, 127.0, 124.5, 132.5]$\n- $\\sigma^{\\mathrm{calc}}_{\\mathrm{ppm}} = [58.714286, 50.040816, 27.591837, 73.510204, 38.816327, 36.469388, 63.306122, 44.938776, 77.591837, 60.244898, 62.795918, 54.632653]$\n\n由此，我们计算 $x_i = 188.0 - \\sigma_i^{\\mathrm{calc}}$：\n- $x = (\\Delta\\sigma_i)_{\\mathrm{ppm}} = [129.285714, 137.959184, 160.408163, 114.489796, 149.183673, 151.530612, 124.693878, 143.061224, 110.408163, 127.755102, 125.204082, 133.367347]$\n\n对 $(x_i, y_i)$ 数据对进行线性回归，得到校准参数：\n- 斜率：$m \\approx 1.036417$\n- 截距：$c \\approx -5.743634$\n\n最终的校准方程为：\n$$ \\delta^{\\mathrm{pred}} = 1.036417 \\cdot (188.000000 - \\sigma^{\\mathrm{calc}}) - 5.743634 $$\n\n**步骤4：应用于测试集**\n\n现在我们将此方程应用于提供的计算屏蔽值测试集 $\\sigma^{\\mathrm{test}}$。\n\n1.  对于 $\\sigma^{\\mathrm{test}} = 37.081633$：\n    $\\delta^{\\mathrm{pred}} = 1.036417 \\cdot (188.0 - 37.081633) - 5.743634 = 150.673... \\rightarrow 150.7$ ppm\n2.  对于 $\\sigma^{\\mathrm{test}} = 50.551020$：\n    $\\delta^{\\mathrm{pred}} = 1.036417 \\cdot (188.0 - 50.551020) - 5.743634 = 136.705... \\rightarrow 136.7$ ppm\n3.  对于 $\\sigma^{\\mathrm{test}} = 63.816327$：\n    $\\delta^{\\mathrm{pred}} = 1.036417 \\cdot (188.0 - 63.816327) - 5.743634 = 122.962... \\rightarrow 123.0$ ppm\n4.  对于 $\\sigma^{\\mathrm{test}} = 59.734694$：\n    $\\delta^{\\mathrm{pred}} = 1.036417 \\cdot (188.0 - 59.734694) - 5.743634 = 127.179... \\rightarrow 127.2$ ppm\n5.  对于 $\\sigma^{\\mathrm{test}} = 31.673469$：\n    $\\delta^{\\mathrm{pred}} = 1.036417 \\cdot (188.0 - 31.673469) - 5.743634 = 156.273... \\rightarrow 156.3$ ppm\n6.  对于 $\\sigma^{\\mathrm{test}} = 56.163265$：\n    $\\delta^{\\mathrm{pred}} = 1.036417 \\cdot (188.0 - 56.163265) - 5.743634 = 130.890... \\rightarrow 130.9$ ppm\n\n测试集的最终预测化学位移（四舍五入到一位小数）为 $[150.7, 136.7, 123.0, 127.2, 156.3, 130.9]$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Derives and applies an affine calibration for NMR chemical shifts.\n    \"\"\"\n    # Define the fixed computed reference shielding for TMS in ppm.\n    sigma_ref_calc = 188.000000\n\n    # Define the training set of (computed shielding, experimental chemical shift) pairs.\n    # All values are in ppm.\n    training_data = [\n        (58.714286, 128.5),\n        (50.040816, 137.0),\n        (27.591837, 159.0),\n        (73.510204, 114.0),\n        (38.816327, 148.0),\n        (36.469388, 150.3),\n        (63.306122, 124.0),\n        (44.938776, 142.0),\n        (77.591837, 110.0),\n        (60.244898, 127.0),\n        (62.795918, 124.5),\n        (54.632653, 132.5),\n    ]\n\n    # Unpack training data into numpy arrays.\n    sigma_calc_train, delta_exp_train = zip(*training_data)\n    sigma_calc_train = np.array(sigma_calc_train)\n    delta_exp_train = np.array(delta_exp_train)\n    \n    # The model is delta_exp ≈ m * (sigma_ref_calc - sigma_calc) + c.\n    # The independent variable for the regression is the computed shielding difference.\n    # Let x = sigma_ref_calc - sigma_calc_train\n    # Let y = delta_exp_train\n    x_train = sigma_ref_calc - sigma_calc_train\n    y_train = delta_exp_train\n\n    # Perform a linear least-squares fit (polynomial of degree 1)\n    # to find the slope (m) and intercept (c).\n    # np.polyfit returns coefficients of highest power first, so [m, c].\n    m, c = np.polyfit(x_train, y_train, 1)\n\n    # Define the test suite of computed shieldings in ppm.\n    test_suite_sigma = [\n        37.081633,\n        50.551020,\n        63.816327,\n        59.734694,\n        31.673469,\n        56.163265,\n    ]\n    sigma_calc_test = np.array(test_suite_sigma)\n\n    # Apply the fitted calibration model to the test suite.\n    # Calculate the computed shielding difference for the test set.\n    x_test = sigma_ref_calc - sigma_calc_test\n    \n    # Predict the chemical shifts.\n    delta_pred = m * x_test + c\n    \n    # Format the results: round to one decimal place and create a comma-separated string.\n    # Using f-string formatting for rounding is a standard and robust method.\n    rounded_results = [f\"{val:.1f}\" for val in delta_pred]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(rounded_results)}]\")\n\nsolve()\n```", "id": "3690556"}]}