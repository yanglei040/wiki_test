{"hands_on_practices": [{"introduction": "预测化学位移是一项关键技能。化学位移并非随机分布，而是受取代基电子效应的支配。[@problem_id:3693187] 这项练习将探讨一个量化模型——双取代基参数（DSP）模型，它将取代基的影响分解为诱导/场效应和共振效应。通过应用此模型，你将对取代基如何去屏蔽或屏蔽芳环上的特定质子有更深刻的量化理解，超越简单的定性规则。", "problem": "一个带有硝基的单取代苯通过质子核磁共振 (NMR) 进行分析。假设芳香质子的化学位移由加和性取代基效应决定，该效应可分解为场/诱导效应部分和共振效应部分，每一部分通过位置依赖的传递因子传递到环上的特定位置。取未取代苯的质子化学位移为 $\\delta_{0} = 7.27$ 百万分率 (ppm)。使用以下具有物理意义的参数，这些参数与双取代基参数框架一致：硝基的诱导（场）和共振取代基常数分别为 $\\sigma_{I} = +0.65$ 和 $\\sigma_{R} = +0.13$；将这些常数与芳香质子化学位移增量联系起来的灵敏度系数分别为 $\\rho_{F} = +0.90$ ppm/$\\sigma_{I}$单位和 $\\rho_{R} = +2.00$ ppm/$\\sigma_{R}$单位；邻位、间位和对位的与位置相关的传递因子分别为 $(f_{o}, r_{o}) = (1.20, 1.00)$、$(f_{m}, r_{m}) = (0.60, 0.00)$ 和 $(f_{p}, r_{p}) = (0.70, 1.00)$。假设诱导和共振贡献是线性加和的，并将正增量视为相对于 $\\delta_{0}$ 的去屏蔽效应。计算硝基苯邻位、间位和对位芳香质子相对于 $\\delta_{0}$ 的预测化学位移 $\\delta_{o}$、$\\delta_{m}$ 和 $\\delta_{p}$。将最终数值四舍五入至四位有效数字，并以百万分率 (ppm) 表示化学位移。按 $\\delta_{o}$、$\\delta_{m}$、$\\delta_{p}$ 的顺序报告您的三个答案。", "solution": "在位置 $i$（其中 $i \\in \\{o, m, p\\}$ 分别代表邻位、间位、对位）的质子的预测化学位移 $\\delta_i$ 由苯的基础化学位移 $\\delta_0$ 和取代基诱导的位移 $\\Delta\\delta_i$ 的线性叠加决定。取代基诱导的位移被建模为场/诱导效应和共振效应的总和。通用方程为：\n$$ \\delta_i = \\delta_0 + \\Delta\\delta_i = \\delta_0 + (\\rho_F \\sigma_I f_i + \\rho_R \\sigma_R r_i) $$\n其中 $\\rho_F$ 和 $\\rho_R$ 是灵敏度系数，$\\sigma_I$ 和 $\\sigma_R$ 是硝基的取代基常数，而 $f_i$ 和 $r_i$ 是位置依赖的传递因子。\n\n我们已知以下数值：\n$\\delta_0 = 7.27$\n$\\sigma_I = 0.65$\n$\\sigma_R = 0.13$\n$\\rho_F = 0.90$\n$\\rho_R = 2.00$\n\n我们现在计算每个位置的化学位移。\n\n**邻位 ($\\delta_o$)**：\n邻位的传递因子为 $(f_o, r_o) = (1.20, 1.00)$。\n$$ \\delta_o = \\delta_0 + (\\rho_F \\sigma_I f_o + \\rho_R \\sigma_R r_o) $$\n代入给定值：\n$$ \\delta_o = 7.27 + ((0.90)(0.65)(1.20) + (2.00)(0.13)(1.00)) $$\n$$ \\delta_o = 7.27 + (0.702 + 0.260) $$\n$$ \\delta_o = 7.27 + 0.962 $$\n$$ \\delta_o = 8.232 $$\n该值有四位有效数字。\n\n**间位 ($\\delta_m$)**：\n间位的传递因子为 $(f_m, r_m) = (0.60, 0.00)$。\n$$ \\delta_m = \\delta_0 + (\\rho_F \\sigma_I f_m + \\rho_R \\sigma_R r_m) $$\n代入给定值：\n$$ \\delta_m = 7.27 + ((0.90)(0.65)(0.60) + (2.00)(0.13)(0.00)) $$\n$$ \\delta_m = 7.27 + (0.351 + 0) $$\n$$ \\delta_m = 7.27 + 0.351 $$\n$$ \\delta_m = 7.621 $$\n该值有四位有效数字。\n\n**对位 ($\\delta_p$)**：\n对位的传递因子为 $(f_p, r_p) = (0.70, 1.00)$。\n$$ \\delta_p = \\delta_0 + (\\rho_F \\sigma_I f_p + \\rho_R \\sigma_R r_p) $$\n代入给定值：\n$$ \\delta_p = 7.27 + ((0.90)(0.65)(0.70) + (2.00)(0.13)(1.00)) $$\n$$ \\delta_p = 7.27 + (0.4095 + 0.260) $$\n$$ \\delta_p = 7.27 + 0.6695 $$\n$$ \\delta_p = 7.9395 $$\n将最终值四舍五入到四位有效数字，得到：\n$$ \\delta_p \\approx 7.940 $$\n\n计算出的化学位移（单位 ppm），四舍五入至四位有效数字后，分别为 $\\delta_o = 8.232$，$\\delta_m = 7.621$ 和 $\\delta_p = 7.940$。", "answer": "$$\\boxed{\\begin{pmatrix} 8.232  7.621  7.940 \\end{pmatrix}}$$", "id": "3693187"}, {"introduction": "预测了信号的大致位置（化学位移）之后，下一步是理解其精细结构，即裂分模式。[@problem_id:3693124] 这项练习聚焦于一级自旋-自旋耦合，这是这些裂分模式背后的基本机制。你将从弱耦合自旋哈密顿量出发，推导出经典的“双重双峰”模式。这项练习将巩固核自旋之间的物理相互作用（由 $J$ 耦合常数来量化）与核磁共振谱中可观测到的多重峰之间的联系，这是解读任何复杂核磁共振谱图的一项基础技能。", "problem": "一个带有三个不等价芳香质子的取代苯环在高场条件下产生一维质子核磁共振（NMR）谱。其中两个质子，记为 $H_a$ 和 $H_b$，互为邻位，并表现出标量耦合常数 $J_{ab} = 7.5\\,\\text{Hz}$。质子 $H_a$ 也与一个间位质子 $H_c$ 耦合，标量耦合常数为 $J_{ac} = 2.0\\,\\text{Hz}$。化学位移差满足一级（弱耦合）极限，即 $\\Delta \\nu_{ab} \\gg J_{ab}$ 和 $\\Delta \\nu_{ac} \\gg J_{ac}$。\n\n从高场弱耦合自旋哈密顿量出发，并考虑三个自旋-$\\frac{1}{2}$ 核的乘积态基，推导仅存在邻位耦合 $J_{ab}$ 时，以及加入间位耦合 $J_{ac}$ 后，翻转 $H_a$ 的允许跃迁频率。根据您的推导，计算在同时存在耦合 $J_{ab}$ 和 $J_{ac}$ 的情况下，谱线相对于 $H_a$ 共振中心的一组频率偏移量（以 $\\text{Hz}$ 为单位）。将偏移量从最低频率到最高频率排序。\n\n在所述的一级条件下，定性讨论 $2.0\\,\\text{Hz}$ 的间位耦合的存在如何从谱线数量和相对强度的角度扰动简单的邻位耦合模式。\n\n以 $\\text{Hz}$ 表示最终的偏移量集合。无需四舍五入。以单行矩阵的形式提供最终的数值答案。", "solution": "### 解答\n\n在弱耦合（一级）近似下，高磁场中耦合自旋体系的量子力学描述由截断的自旋哈密顿量给出。对于一个由三个自旋-$\\frac{1}{2}$ 核 $H_a$、$H_b$ 和 $H_c$ 组成的系统，这个以频率单位（$\\text{Hz}$）表示的哈密顿量是：\n$$ \\hat{\\mathcal{H}} = \\nu_a \\hat{I}_{za} + \\nu_b \\hat{I}_{zb} + \\nu_c \\hat{I}_{zc} + J_{ab} \\hat{I}_{za} \\hat{I}_{zb} + J_{ac} \\hat{I}_{za} \\hat{I}_{zc} + J_{bc} \\hat{I}_{zb} \\hat{I}_{zc} $$\n这里，$\\nu_i$ 是在没有耦合时核 $i$ 的拉莫尔频率，$\\hat{I}_{zi}$ 是核 $i$ 的自旋角动量 $z$ 分量的算符，而 $J_{ij}$ 是核 $i$ 和 $j$ 之间的标量耦合常数。\n\n在一级近似中，乘积态 $|m_a m_b m_c\\rangle$ 是哈密顿量的本征态，其中 $m_i$是自旋 $i$ 的磁量子数（对于自旋态 $|\\alpha\\rangle$，$m_i = +\\frac{1}{2}$；对于自旋态 $|\\beta\\rangle$，$m_i = -\\frac{1}{2}$）。一个态 $|m_a m_b m_c\\rangle$ 的能量本征值 $E$ 由下式给出：\n$$ E(m_a, m_b, m_c) = \\langle m_a m_b m_c | \\hat{\\mathcal{H}} | m_a m_b m_c \\rangle $$\n$$ E(m_a, m_b, m_c) = \\nu_a m_a + \\nu_b m_b + \\nu_c m_c + J_{ab} m_a m_b + J_{ac} m_a m_c + J_{bc} m_b m_c $$\n核 $H_a$ 的核磁共振跃迁受选择定则 $\\Delta m_a = \\pm 1$ 和对于 $j \\neq a$ 有 $\\Delta m_j = 0$ 的支配。我们考虑一个吸收跃迁，这对应于将 $H_a$ 的自旋从 $|\\beta\\rangle$ 翻转到 $|\\alpha\\rangle$（即从 $m_a = -\\frac{1}{2}$到 $m_a = +\\frac{1}{2}$），而 $H_b$ 和 $H_c$ 的自旋态保持不变。\n\n初态是 $|\\beta m_b m_c\\rangle$，末态是 $|\\alpha m_b m_c\\rangle$。跃迁的能量 $\\Delta E$ 是末态和初态能量之差：\n$$ \\Delta E = E(+\\tfrac{1}{2}, m_b, m_c) - E(-\\tfrac{1}{2}, m_b, m_c) $$\n$$ \\Delta E = \\left( \\nu_a(\\tfrac{1}{2}) + \\dots + J_{ab}(\\tfrac{1}{2})m_b + J_{ac}(\\tfrac{1}{2})m_c + \\dots \\right) - \\left( \\nu_a(-\\tfrac{1}{2}) + \\dots + J_{ab}(-\\tfrac{1}{2})m_b + J_{ac}(-\\tfrac{1}{2})m_c + \\dots \\right) $$\n只涉及自旋 $b$ 和 $c$ 的项（$\\nu_b m_b$, $\\nu_c m_c$, $J_{bc} m_b m_c$）会消掉。\n$$ \\Delta E = \\nu_a(\\tfrac{1}{2} - (-\\tfrac{1}{2})) + J_{ab}(\\tfrac{1}{2} - (-\\tfrac{1}{2}))m_b + J_{ac}(\\tfrac{1}{2} - (-\\tfrac{1}{2}))m_c $$\n因此，跃迁的频率 $\\nu_{trans} = \\Delta E$ 是：\n$$ \\nu_{trans} = \\nu_a + J_{ab}m_b + J_{ac}m_c $$\n这个通用表达式给出了 $H_a$ 多重峰中谱线的频率。耦合伙伴 $H_b$ 和 $H_c$ 的自旋态决定了具体的频率。对于 $(m_b, m_c)$ 有 $2 \\times 2 = 4$ 种可能的组合：\n1.  $m_b = +\\frac{1}{2}, m_c = +\\frac{1}{2}$: $\\nu_1 = \\nu_a + \\frac{1}{2}J_{ab} + \\frac{1}{2}J_{ac}$\n2.  $m_b = +\\frac{1}{2}, m_c = -\\frac{1}{2}$: $\\nu_2 = \\nu_a + \\frac{1}{2}J_{ab} - \\frac{1}{2}J_{ac}$\n3.  $m_b = -\\frac{1}{2}, m_c = +\\frac{1}{2}$: $\\nu_3 = \\nu_a - \\frac{1}{2}J_{ab} + \\frac{1}{2}J_{ac}$\n4.  $m_b = -\\frac{1}{2}, m_c = -\\frac{1}{2}$: $\\nu_4 = \\nu_a - \\frac{1}{2}J_{ab} - \\frac{1}{2}J_{ac}$\n\n现在我们考虑所要求的具体情况。\n\n**情况1：仅存在邻位耦合（$J_{ab}$）。**\n如果我们只考虑邻位耦合，我们设置 $J_{ac} = 0$。四个跃迁频率变为：\n1.  $\\nu_1 = \\nu_a + \\frac{1}{2}J_{ab}$\n2.  $\\nu_2 = \\nu_a + \\frac{1}{2}J_{ab}$\n3.  $\\nu_3 = \\nu_a - \\frac{1}{2}J_{ab}$\n4.  $\\nu_4 = \\nu_a - \\frac{1}{2}J_{ab}$\n跃遷是二重简并的，导致在频率 $\\nu_a \\pm \\frac{1}{2}J_{ab}$ 处只有两条可观测的谱线。这种模式是一个间距为 $J_{ab}$ 的双重峰。\n\n**情况2：邻位（$J_{ab}$）和间位（$J_{ac}$）耦合都存在。**\n在这种情况下，所有四个频率 $\\nu_1, \\nu_2, \\nu_3, \\nu_4$ 都是不同的。这种模式被称为双二重峰。\n\n我们被要求计算相对于 $H_a$ 共振中心（频率为 $\\nu_a$）的频率偏移量。偏移量由 $\\nu_{trans} - \\nu_a$ 给出。\n偏移量 1: $\\frac{1}{2}J_{ab} + \\frac{1}{2}J_{ac}$\n偏移量 2: $\\frac{1}{2}J_{ab} - \\frac{1}{2}J_{ac}$\n偏移量 3: $-\\frac{1}{2}J_{ab} + \\frac{1}{2}J_{ac}$\n偏移量 4: $-\\frac{1}{2}J_{ab} - \\frac{1}{2}J_{ac}$\n\n使用给定的数值，$J_{ab} = 7.5\\,\\text{Hz}$ 和 $J_{ac} = 2.0\\,\\text{Hz}$：\n$\\frac{1}{2}J_{ab} = \\frac{1}{2}(7.5) = 3.75\\,\\text{Hz}$\n$\\frac{1}{2}J_{ac} = \\frac{1}{2}(2.0) = 1.0\\,\\text{Hz}$\n\n四个偏移量是：\n偏移量 1: $3.75 + 1.0 = 4.75\\,\\text{Hz}$\n偏移量 2: $3.75 - 1.0 = 2.75\\,\\text{Hz}$\n偏移量 3: $-3.75 + 1.0 = -2.75\\,\\text{Hz}$\n偏移量 4: $-3.75 - 1.0 = -4.75\\,\\text{Hz}$\n\n将这些偏移量从最低频率到最高频率排序，得到集合：\n$\\{-4.75, -2.75, 2.75, 4.75\\}\\,\\text{Hz}$。\n\n**定性讨论**\n间位耦合 $J_{ac}$ 的作用是扰动仅存在邻位耦合 $J_{ab}$ 时观察到的简单模式。\n- **谱线数量**：在没有间位耦合（$J_{ac} = 0$）的情况下，$H_a$ 的共振被 $H_b$ 裂分为一个双重峰（两条线）。引入较小的间位耦合（$J_{ac} = 2.0\\,\\text{Hz}$）会使这两条谱线中的每一条都进一步裂分。位于 $\\nu_a + \\frac{1}{2}J_{ab}$ 的谱线裂分为一个间距为 $J_{ac}$ 的双重峰，位于 $\\nu_a - \\frac{1}{2}J_{ab}$ 的谱线也裂分为一个间距为 $J_{ac}$ 的双重峰。因此，总谱線数从 2 增加到 4。得到的模式被称为“双二重峰”。\n- **相对强度**：在一级条件下，初始自旋态的布居数实际上是相等的，并且所有单量子跃遷都具有相等的內在概率。当只存在 $J_{ab}$ 时，双重峰的两条谱线的相对强度比为 $1:1$，因为每条谱线都源于两个简并的跃遷。当加入间位耦合 $J_{ac}$ 时，简并被解除，产生的四条谱线是不同的。由于每条谱线对应一个唯一的、允许的单量子跃遷，它们都具有相等的强度。因此，强度模式从 $1:1$ 的双重峰变为 $1:1:1:1$ 的四重峰（双二重峰）。", "answer": "$$ \\boxed{ \\begin{pmatrix} -4.75  -2.75  2.75  4.75 \\end{pmatrix} } $$", "id": "3693124"}, {"introduction": "在真实的结构解析工作中，我们通常从谱图反推分子结构。这需要根据实验数据来检验结构假设。[@problem_id:3693195] 这项练习将介绍一种用于假设检验的计算方法。你将实现一个算法，该算法可量化一组测得的耦合常数与间位二取代苯环的预期模式的吻合程度。这项高级练习弥合了传统谱图解析与现代计算化学之间的鸿沟。它训练你将化学直觉形式化为一个可量化、可检验的模型，这在数据分析和建模至关重要的当代研究中是一项关键技能。", "problem": "对于1,3-二取代（间位）苯环，其芳香质子通常构成一个ABX自旋系统，其中包含一个邻位耦合（ortho）和两个间位耦合（meta）。您的任务是编写一个算法，通过计算一个“残差值”$R$来量化一组测量的耦合常数 $\\{J_{AB}, J_{AX}, J_{BX}\\}$ 与此结构假设的吻合度。\n\n算法应遵循以下规则：\n1.  耦合常数的经验范围为：\n    *   $J_\\text{ortho} \\in [6.0, 10.0]\\,\\text{Hz}$\n    *   $J_\\text{meta} \\in [1.0, 3.5]\\,\\text{Hz}$\n2.  定义一个惩罚函数 $\\rho(J; \\sigma, [L, H])$ 来衡量一个测得的耦合常数 $J$（不确定度为 $\\sigma$）偏离其指定区间 $[L, H]$ 的程度：\n$$\n\\rho(J;\\sigma,[L,H]) \\;=\\; \n\\begin{cases}\n0,   \\text{若 } L \\le J \\le H,\\\\\n\\left(\\dfrac{\\min(|J-L|,|J-H|)}{\\sigma}\\right)^2,  \\text{其他情况}.\n\\end{cases}\n$$\n3.  由于事先不知道三个耦合中哪一个是邻位耦合，您必须考虑所有三种可能的指派情况（$J_{AB}$为邻位，$J_{AX}$为邻位，或$J_{BX}$为邻位），并为每种指派计算总惩罚值（三个$\\rho$值之和）。\n4.  最终的残差值 $R$ 是这三种指派情况算出的总惩罚值中的最小值。\n\n请为以下五个测试用例（单位为 Hz）实现该算法，并以Python代码的形式提交您的解答，代码需能计算并打印出包含五个浮点数（每个四舍五入到六位小数）的列表作为最终结果。\n1.  $J_{AB}=8.1, J_{AX}=2.1, J_{BX}=1.9$; $\\sigma_{AB}=0.1, \\sigma_{AX}=0.1, \\sigma_{BX}=0.1$\n2.  $J_{AB}=3.0, J_{AX}=3.2, J_{BX}=3.1$; $\\sigma_{AB}=0.1, \\sigma_{AX}=0.1, \\sigma_{BX}=0.1$\n3.  $J_{AB}=7.5, J_{AX}=0.6, J_{BX}=0.5$; $\\sigma_{AB}=0.1, \\sigma_{AX}=0.1, \\sigma_{BX}=0.1$\n4.  $J_{AB}=7.9, J_{AX}=1.2, J_{BX}=2.8$; $\\sigma_{AB}=0.1, \\sigma_{AX}=0.2, \\sigma_{BX}=0.15$\n5.  $J_{AB}=5.5, J_{AX}=5.0, J_{BX}=5.4$; $\\sigma_{AB}=0.1, \\sigma_{AX}=0.1, \\sigma_{BX}=0.1$", "solution": "目标是为五个不同的测试用例计算残差值 $R$。该残差量化了测得的自旋-自旋耦合常数与 1,3-二取代（间位）芳香环结构假说的一致性。该分析的核心是，对于一组测得的三个耦合常数 $\\{J_{AB}, J_{AX}, J_{BX}\\}$，评估一个邻位型和两个间位型耦合的三种可能指派。\n\n耦合常数的经验约束以区间的形式给出：\n- 邻位型耦合：$J_\\text{ortho} \\in [L_o, H_o] = [6.0, 10.0]\\,\\mathrm{Hz}$。\n- 间位型耦合：$J_\\text{meta} \\in [L_m, H_m] = [1.0, 3.5]\\,\\mathrm{Hz}$。\n\n定义了一个惩罚函数 $\\rho(J; \\sigma, [L, H])$，用于衡量一个带有不确定度 $\\sigma$ 的测量耦合常数 $J$ 偏离其指定区间 $[L, H]$ 的程度：\n$$\n\\rho(J;\\sigma,[L,H]) \\;=\\; \n\\begin{cases}\n0,  \\text{若 } L \\le J \\le H,\\\\\n\\left(\\dfrac{\\min(|J-L|,|J-H|)}{\\sigma}\\right)^2,  \\text{其他情况}.\n\\end{cases}\n$$\n该函数产生一个无量纲的非负值。如果耦合常数落在允许范围内，则该值为零；否则，该值为与范围最近边界的距离经不确定度归一化后的平方。\n\n对于一组给定的测量耦合 $\\{J_{AB}, J_{AX}, J_{BX}\\}$ 及其相关的不确定度 $\\{\\sigma_{AB}, \\sigma_{AX}, \\sigma_{BX}\\}$，我们必须考虑与间位取代假说一致的三种指派：\n1.  **指派 1**：$J_{AB}$ 是邻位型；$J_{AX}$ 和 $J_{BX}$ 是间位型。此指派的残差 $R_1$ 为：\n    $$\n    R_1 = \\rho(J_{AB}; \\sigma_{AB}, [L_o, H_o]) + \\rho(J_{AX}; \\sigma_{AX}, [L_m, H_m]) + \\rho(J_{BX}; \\sigma_{BX}, [L_m, H_m])\n    $$\n2.  **指派 2**：$J_{AX}$ 是邻位型；$J_{AB}$ 和 $J_{BX}$ 是间位型。此指派的残差 $R_2$ 为：\n    $$\n    R_2 = \\rho(J_{AB}; \\sigma_{AB}, [L_m, H_m]) + \\rho(J_{AX}; \\sigma_{AX}, [L_o, H_o]) + \\rho(J_{BX}; \\sigma_{BX}, [L_m, H_m])\n    $$\n3.  **指派 3**：$J_{BX}$ 是邻位型；$J_{AB}$ 和 $J_{AX}$ 是间位型。此指派的残差 $R_3$ 为：\n    $$\n    R_3 = \\rho(J_{AB}; \\sigma_{AB}, [L_m, H_m]) + \\rho(J_{AX}; \\sigma_{AX}, [L_m, H_m]) + \\rho(J_{BX}; \\sigma_{BX}, [L_o, H_o])\n    $$\n\n该测试用例的最终间位假说残差 $R$ 是为三种可能指派计算出的残差中的最小值，代表了与该假说的最佳拟合：\n$$\nR = \\min(R_1, R_2, R_3)\n$$\n\n让我们演示测试用例 1 的计算过程：\n- 给定数据：$J_{AB}=8.1$, $J_{AX}=2.1$, $J_{BX}=1.9$；$\\sigma_{AB}=0.1$, $\\sigma_{AX}=0.1$, $\\sigma_{BX}=0.1$。所有单位均为 $\\mathrm{Hz}$。\n- 范围：$[L_o, H_o] = [6.0, 10.0]$ 以及 $[L_m, H_m] = [1.0, 3.5]$。\n\n- **计算指派 1（$J_{AB}$ 为邻位）：**\n  - $\\rho(J_{AB}; \\sigma_{AB}, [6.0, 10.0]) = \\rho(8.1; 0.1, [6.0, 10.0]) = 0$，因为 $6.0 \\le 8.1 \\le 10.0$。\n  - $\\rho(J_{AX}; \\sigma_{AX}, [1.0, 3.5]) = \\rho(2.1; 0.1, [1.0, 3.5]) = 0$，因为 $1.0 \\le 2.1 \\le 3.5$。\n  - $\\rho(J_{BX}; \\sigma_{BX}, [1.0, 3.5]) = \\rho(1.9; 0.1, [1.0, 3.5]) = 0$，因为 $1.0 \\le 1.9 \\le 3.5$。\n  - $R_1 = 0 + 0 + 0 = 0$。\n\n- **计算指派 2（$J_{AX}$ 为邻位）：**\n  - $\\rho(J_{AB}; \\sigma_{AB}, [1.0, 3.5]) = \\rho(8.1; 0.1, [1.0, 3.5]) = \\left(\\frac{|8.1-3.5|}{0.1}\\right)^2 = \\left(\\frac{4.6}{0.1}\\right)^2 = 46^2 = 2116$。\n  - $\\rho(J_{AX}; \\sigma_{AX}, [6.0, 10.0]) = \\rho(2.1; 0.1, [6.0, 10.0]) = \\left(\\frac{|2.1-6.0|}{0.1}\\right)^2 = \\left(\\frac{3.9}{0.1}\\right)^2 = 39^2 = 1521$。\n  - $\\rho(J_{BX}; \\sigma_{BX}, [1.0, 3.5]) = 0$。\n  - $R_2 = 2116 + 1521 + 0 = 3637$。\n\n- **计算指派 3（$J_{BX}$ 为邻位）：**\n  - $\\rho(J_{AB}; \\sigma_{AB}, [1.0, 3.5]) = 2116$。\n  - $\\rho(J_{AX}; \\sigma_{AX}, [1.0, 3.5]) = 0$。\n  - $\\rho(J_{BX}; \\sigma_{BX}, [6.0, 10.0]) = \\rho(1.9; 0.1, [6.0, 10.0]) = \\left(\\frac{|1.9-6.0|}{0.1}\\right)^2 = \\left(\\frac{4.1}{0.1}\\right)^2 = 41^2 = 1681$。\n  - $R_3 = 2116 + 0 + 1681 = 3797$。\n\n- 测试用例 1 的最终残差为 $R = \\min(0, 3637, 3797) = 0$。\n\n此过程系统地应用于问题陈述中提供的五个测试用例。实现时将定义惩罚函数，并对每个测试用例的所有指派进行迭代，以找到最小残差。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\n# numpy and scipy are permitted but not necessary for this specific problem.\n\ndef solve():\n    \"\"\"\n    Calculates the meta hypothesis residual for a set of ABX spin system parameters.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (J_ab, J_ax, J_bx, sigma_ab, sigma_ax, sigma_bx)\n    test_cases = [\n        (8.1, 2.1, 1.9, 0.1, 0.1, 0.1),\n        (3.0, 3.2, 3.1, 0.1, 0.1, 0.1),\n        (7.5, 0.6, 0.5, 0.1, 0.1, 0.1),\n        (7.9, 1.2, 2.8, 0.1, 0.2, 0.15),\n        (5.5, 5.0, 5.4, 0.1, 0.1, 0.1),\n    ]\n\n    # Define the empirical ranges for ortho- and meta-like couplings.\n    ORTHO_RANGE = (6.0, 10.0)\n    META_RANGE = (1.0, 3.5)\n\n    def penalty(J, sigma, bounds):\n        \"\"\"\n        Calculates the penalty for a coupling constant being outside its allowed range.\n        \n        Args:\n            J (float): The measured coupling constant in Hz.\n            sigma (float): The uncertainty of the measurement in Hz.\n            bounds (tuple): A tuple (L, H) representing the allowed interval [L, H].\n        \n        Returns:\n            float: The dimensionless penalty value.\n        \"\"\"\n        L, H = bounds\n        if L = J = H:\n            return 0.0\n        else:\n            # Calculate the minimum distance to the interval boundaries.\n            distance = min(abs(J - L), abs(J - H))\n            # The penalty is the squared, uncertainty-normalized distance.\n            return (distance / sigma) ** 2\n\n    results = []\n    for case in test_cases:\n        J_ab, J_ax, J_bx, s_ab, s_ax, s_bx = case\n\n        # There are three possible assignments for the single ortho coupling.\n        \n        # Assignment 1: J_ab is ortho-like, J_ax and J_bx are meta-like.\n        r1 = (penalty(J_ab, s_ab, ORTHO_RANGE) +\n              penalty(J_ax, s_ax, META_RANGE) +\n              penalty(J_bx, s_bx, META_RANGE))\n        \n        # Assignment 2: J_ax is ortho-like, J_ab and J_bx are meta-like.\n        r2 = (penalty(J_ab, s_ab, META_RANGE) +\n              penalty(J_ax, s_ax, ORTHO_RANGE) +\n              penalty(J_bx, s_bx, META_RANGE))\n\n        # Assignment 3: J_bx is ortho-like, J_ab and J_ax are meta-like.\n        r3 = (penalty(J_ab, s_ab, META_RANGE) +\n              penalty(J_ax, s_ax, META_RANGE) +\n              penalty(J_bx, s_bx, ORTHO_RANGE))\n\n        # The meta hypothesis residual is the minimum of the three assignment residuals.\n        min_residual = min(r1, r2, r3)\n        results.append(min_residual)\n\n    # Format the final output as a comma-separated list in brackets,\n    # with each result rounded to six decimal places.\n    formatted_results = [f'{r:.6f}' for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3693195"}]}