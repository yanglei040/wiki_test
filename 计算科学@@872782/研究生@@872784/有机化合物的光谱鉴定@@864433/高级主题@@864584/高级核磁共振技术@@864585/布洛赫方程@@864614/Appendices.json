{"hands_on_practices": [{"introduction": "精确控制核自旋是所有核磁共振实验的基础。虽然共振脉冲在旋转坐标系中的作用最易于理解，但实际应用（如选择性激发）则需要我们掌握离共振效应。本练习将引导你计算离共振条件下的有效场以及由此产生的自旋旋转，这是设计高级脉冲序列的一项关键技能。[@problem_id:3726671]", "problem": "在应用于有机化合物鉴定的核磁共振 (NMR) 光谱学中，射频 (RF) 脉冲期间体磁化强度的动力学由 Bloch 方程决定。从磁场中磁矩的基本进动定律 $\\frac{d\\mathbf{M}}{dt} = \\gamma\\,\\mathbf{M} \\times \\mathbf{B}(t)$ 出发，其中 $\\gamma$ 是旋磁比，$\\mathbf{B}(t)$ 是总磁场，考虑一个质子自旋系统，该系统受到强静磁场 $\\mathbf{B}_0 = B_0\\,\\hat{\\mathbf{z}}$ 和一个圆偏振射频场的作用，该射频场的振幅为 $B_1$，载波角频率为 $\\omega_{\\mathrm{rf}}$，其相位经过校准，使得其在旋转坐标系中的有效横向分量沿 $\\hat{\\mathbf{x}}$ 方向。在以 $\\omega_{\\mathrm{rf}}$ 旋转的坐标系中进行分析，并采用旋转波近似 (RWA)，忽略脉冲期间的弛豫。\n\n将角频率偏移定义为 $\\Delta\\omega \\equiv \\omega_0 - \\omega_{\\mathrm{rf}}$，其中 $\\omega_0$ 是拉莫尔角频率。从第一性原理出发，根据旋转坐标系中磁化强度所感受到的有效场，解释共振旋转 ($\\Delta\\omega = 0$) 和非共振旋转 ($\\Delta\\omega \\neq 0$) 之间的区别，并推导一个持续时间为 $\\tau$ 的矩形射频脉冲的有效旋转轴（以单位向量表示）和旋转角的表达式。\n\n然后，对于与有机化合物光谱鉴定相关的选择性激发场景，计算一个质子在振幅为 $B_1 = 12\\ \\mu\\text{T}$、频率偏移为 $\\Delta\\omega = 2\\pi \\times 400\\ \\text{s}^{-1}$、持续时间为 $\\tau = 150\\ \\mu\\text{s}$ 的射频脉冲作用下的有效旋转轴和旋转角。该质子的旋磁比为 $\\gamma = 2.675 \\times 10^{8}\\ \\text{rad s}^{-1}\\ \\text{T}^{-1}$。旋转角以弧度表示。将单位向量的每个分量和旋转角四舍五入到四位有效数字。", "solution": "在时变磁场 $\\mathbf{B}(t)$ 中，宏观磁化矢量 $\\mathbf{M}(t)$ 的进动动力学由方程 $\\frac{d\\mathbf{M}}{dt} = \\gamma\\,\\mathbf{M} \\times \\mathbf{B}(t)$ 决定，该方程源于磁偶极子在磁场中所受的扭矩。在核磁共振 (NMR) 中，我们考虑一个强静磁场 $\\mathbf{B}_0 = B_0\\,\\hat{\\mathbf{z}}$，它设定了拉莫尔角频率 $\\omega_0 = \\gamma B_0$，以及一个在 $\\omega_0$ 附近振荡的横向射频 (RF) 场。\n\n为了分析脉冲引起的旋转，方便进入一个以射频角频率 $\\omega_{\\mathrm{rf}}$ 绕 $\\hat{\\mathbf{z}}$ 轴旋转的坐标系。在该旋转坐标系中，根据旋转波近似 (RWA)，射频场中快速振荡的反向旋转分量被忽略，而同向旋转分量表现为一个静态的横向场。如果射频场是圆偏振的，使其有效横向分量沿 $\\hat{\\mathbf{x}}$ 方向，那么在旋转坐标系中，磁化强度遵循\n$$\n\\frac{d\\mathbf{M}_{\\mathrm{rot}}}{dt} = \\gamma\\,\\mathbf{M}_{\\mathrm{rot}} \\times \\mathbf{B}_{\\mathrm{eff}},\n$$\n其中有效场为\n$$\n\\mathbf{B}_{\\mathrm{eff}} = B_1\\,\\hat{\\mathbf{x}} + \\frac{\\Delta\\omega}{\\gamma}\\,\\hat{\\mathbf{z}},\n$$\n其中 $\\Delta\\omega \\equiv \\omega_0 - \\omega_{\\mathrm{rf}}$ 是角频率偏移。在旋转坐标系中出现 $\\hat{\\mathbf{z}}$ 分量是因为静磁场因坐标系旋转而显得减弱，留下一个有效失谐量 $\\Delta\\omega/\\gamma$。\n\n共振旋转对应于 $\\Delta\\omega = 0$ 的情况，此时 $\\mathbf{B}_{\\mathrm{eff}} = B_1\\,\\hat{\\mathbf{x}}$，磁化强度仅以角章动速率 $\\omega_1 = \\gamma B_1$ 绕 $\\hat{\\mathbf{x}}$ 轴章动。非共振旋转对应于 $\\Delta\\omega \\neq 0$ 的情况，此时有效场从横向平面倾斜，磁化强度围绕此倾斜轴进动。旋转轴是 $\\mathbf{B}_{\\mathrm{eff}}$ 的方向，角章动速率是有效角频率矢量 $\\boldsymbol{\\omega}_{\\mathrm{eff}} = \\gamma \\mathbf{B}_{\\mathrm{eff}} = (\\gamma B_1)\\,\\hat{\\mathbf{x}} + \\Delta\\omega\\,\\hat{\\mathbf{z}}$ 的大小。因此，沿旋转轴的单位向量是\n$$\n\\hat{\\mathbf{n}} = \\frac{\\boldsymbol{\\omega}_{\\mathrm{eff}}}{\\|\\boldsymbol{\\omega}_{\\mathrm{eff}}\\|} = \\frac{(\\gamma B_1)\\,\\hat{\\mathbf{x}} + \\Delta\\omega\\,\\hat{\\mathbf{z}}}{\\sqrt{(\\gamma B_1)^{2} + (\\Delta\\omega)^{2}}},\n$$\n一个持续时间为 $\\tau$ 的矩形脉冲所产生的旋转角是\n$$\n\\theta = \\|\\boldsymbol{\\omega}_{\\mathrm{eff}}\\|\\,\\tau = \\sqrt{(\\gamma B_1)^{2} + (\\Delta\\omega)^{2}}\\;\\tau.\n$$\n\n我们现在用给定的参数来计算这些表达式。在最后一步之前保留符号，然后代入数值。给定 $\\gamma = 2.675 \\times 10^{8}\\ \\text{rad s}^{-1}\\ \\text{T}^{-1}$， $B_1 = 12 \\times 10^{-6}\\ \\text{T}$， $\\Delta\\omega = 2\\pi \\times 400\\ \\text{s}^{-1}$，以及 $\\tau = 150 \\times 10^{-6}\\ \\text{s}$，我们首先计算\n$$\n\\gamma B_1 = \\left(2.675 \\times 10^{8}\\right)\\left(12 \\times 10^{-6}\\right) = 3.21 \\times 10^{3}\\ \\text{rad s}^{-1},\n$$\n所以\n$$\n\\gamma B_1 = 3210\\ \\text{rad s}^{-1},\n\\qquad\n\\Delta\\omega = 2\\pi \\times 400 = 2513.2741229\\ \\text{rad s}^{-1}.\n$$\n有效角频率的大小为\n$$\n\\|\\boldsymbol{\\omega}_{\\mathrm{eff}}\\| = \\sqrt{(\\gamma B_1)^{2} + (\\Delta\\omega)^{2}} = \\sqrt{(3210)^{2} + (2513.2741229)^{2}}\\ \\text{rad s}^{-1}.\n$$\n数值上，\n$$\n(3210)^{2} = 10{,}304{,}100,\n\\qquad\n(2513.2741229)^{2} \\approx 6{,}316{,}546.839,\n$$\n所以\n$$\n\\|\\boldsymbol{\\omega}_{\\mathrm{eff}}\\| \\approx \\sqrt{16{,}620{,}646.839} \\approx 4076.843\\ \\text{rad s}^{-1}.\n$$\n因此，单位旋转轴的分量为\n$$\nn_x = \\frac{\\gamma B_1}{\\|\\boldsymbol{\\omega}_{\\mathrm{eff}}\\|} \\approx \\frac{3210}{4076.843} \\approx 0.7874,\n\\quad\nn_y = 0,\n\\quad\nn_z = \\frac{\\Delta\\omega}{\\|\\boldsymbol{\\omega}_{\\mathrm{eff}}\\|} \\approx \\frac{2513.2741229}{4076.843} \\approx 0.6165.\n$$\n旋转角为\n$$\n\\theta = \\|\\boldsymbol{\\omega}_{\\mathrm{eff}}\\|\\,\\tau \\approx (4076.843)\\,(150 \\times 10^{-6}) \\approx 0.6115\\ \\text{rad}.\n$$\n四舍五入到四位有效数字，有效旋转轴和旋转角如上所示，其中角度以弧度表示。", "answer": "$$\\boxed{\\begin{pmatrix}0.7874 & 0 & 0.6165 & 0.6115\\end{pmatrix}}$$", "id": "3726671"}, {"introduction": "核磁共振波谱学的真正威力之一在于其研究分子动态学过程的能力。本练习将超越静态自旋，进入化学交换领域，在这里 Bloch-McConnell 方程至关重要。通过编程实现这些方程，你将深刻地、直观地理解交换速率如何影响谱线形状，从而直接揭示反应动力学信息。[@problem_id:3726619]", "problem": "设计并实现一个程序，用于计算与有机化合物波谱鉴定相关的三组分核磁共振（NMR）系统的时域自由感应衰减（FID）及其频域谱。计算使用包含化学交换的布洛赫方程（Bloch–McConnell formalism）。其中一个组分与另一个组分之间存在中等速率的化学交换，目标是量化此交换如何改变复合谱线的线型。\n\n从以下基本原理出发：\n- 旋转坐标系中横向磁化强度的布洛赫方程，并增补了位点之间的一级化学交换。设位点 $i$ 的复数横向磁化强度为 $m_i(t)$，其中 $i \\in \\{1,2,3\\}$。假定每个位点在静态磁场下的自由进动（包含共振偏移和横向弛豫）以及化学交换均为一级且无记忆的过程。\n- 位点 $i$ 在旋转坐标系中的偏移频率为 $\\Delta \\nu_i$（单位 $\\mathrm{Hz}$），其角频率为 $\\omega_i = 2\\pi \\Delta \\nu_i$（单位 $\\mathrm{rad/s}$）。横向弛豫速率为 $R_{2,i}$（单位 $\\mathrm{s^{-1}}$）。从位点 $i$ 到位点 $j$ 的交换速率为 $k_{i\\to j}$（单位 $\\mathrm{s^{-1}}$）。\n- 横向分量的动力学是线性的，可以写成矩阵形式 $\\frac{d}{dt}\\mathbf{m}(t) = \\mathbf{A}\\,\\mathbf{m}(t)$，其中 $\\mathbf{m}(t) = [m_1(t), m_2(t), m_3(t)]^\\top$，且 $\\mathbf{A}\\in\\mathbb{C}^{3\\times 3}$ 包含了弛豫、进动和交换。观测到的复数 FID 为 $s(t)=\\mathbf{1}^\\top \\mathbf{m}(t)$。\n- 在一个翻转角为 $\\pi/2$ 弧度（90度）的非选择性硬脉冲之后，立即假设为小倾角、共振、理想激发，使得初始横向磁化强度与位点布居数成正比：$m_i(0)=p_i M_0$。其中 $M_0$ 是一个任意正比例因子，不失一般性可设为 $M_0=1$。所有角度均使用弧度。\n\n从第一性原理显式构造 $\\mathbf{A}$：\n- 对每个位点 $i$，对角元素为 $A_{ii} = -(R_{2,i} + \\mathrm{i}\\,\\omega_i) - \\sum_{j\\neq i} k_{i\\to j}$，其中 $\\mathrm{i}$ 是虚数单位。\n- 对 $i\\neq j$，非对角元素为 $A_{ij} = k_{j\\to i}$。\n- FID 表达式为 $s(t) = \\mathbf{1}^\\top \\exp(\\mathbf{A} t)\\, \\mathbf{m}(0)$，其中 $\\exp$ 表示矩阵指数。\n\n数值规格和计算要求：\n- 采样：\n  - 采集点数 $N = 2048$。\n  - 驻留时间 $\\Delta t = 1/2000$ $\\mathrm{s}$（谱宽 $= 2000$ $\\mathrm{Hz}$）。\n  - 采样 $s_n = s(n\\Delta t)$，其中 $n=0,1,\\dots,N-1$。\n- 频域谱：\n  - 使用快速傅里叶变换（FFT）计算复数 FID 的离散傅里叶变换（DFT），根据标准的 FFT 频率约定生成以 $\\mathrm{Hz}$ 为单位的频率轴，并使用平移将其中心化，使频率范围大致在 $[-1000,1000)$ $\\mathrm{Hz}$。将此网格上的复数谱记为 $S(\\nu)$。仅报告和使用其实部 $\\mathrm{Re}\\{S(\\nu)\\}$。\n  - 通过将每个谱的实部除以其在整个频率范围内的最大值来进行归一化，使其最大实数值等于 $1$。\n- 交换模型：\n  - 恰好有一对位点，即位点 $2$ 和 $3$，彼此发生交换：$k_{2\\to 3}>0$ 且 $k_{3\\to 2}>0$；所有其他交换速率均为零。\n  - 位点 $1$ 不与其他位点发生交换。\n- 与无交换情况的比较：\n  - 对每组参数，计算两个谱：一个使用指定的交换速率，另一个将所有交换速率设为零。两者都如上所述进行归一化。\n  - 通过计算两个归一化实数谱在整个频率网格上的均方根（RMS）差异，来量化 Bloch–McConnell 形式如何改变复合线型：\n    $$D = \\sqrt{\\frac{1}{N}\\sum_{n=0}^{N-1} \\left(S_{\\mathrm{ex}}^{\\mathrm{real}}(\\nu_n) - S_{\\mathrm{noex}}^{\\mathrm{real}}(\\nu_n)\\right)^2}.$$\n- 探针强度：\n  - 对每组参数，还需报告在五个探针频率（单位 $\\mathrm{Hz}$）$\\{-150,-25,0,25,150\\}$ 处的归一化实数谱值。对每个探针频率，使用计算出的频率网格上最近的频率点。\n\n测试套件（所有频率单位为 $\\mathrm{Hz}$，所有速率单位为 $\\mathrm{s^{-1}}$，布居数为无量纲且总和为 $1$）：\n- 所有案例的通用采样参数：$N=2048$，$\\Delta t = 1/2000$ $\\mathrm{s}$，翻转角 $\\pi/2$ 弧度。\n- 案例 1（慢交换）：\n  - 布居数：$(p_1,p_2,p_3) = (0.4, 0.3, 0.3)$。\n  - 偏移：$(\\Delta \\nu_1,\\Delta \\nu_2,\\Delta \\nu_3) = (-150,-25,25)$。\n  - 横向弛豫速率：$(R_{2,1},R_{2,2},R_{2,3}) = (3,5,5)$。\n  - 交换：$k_{2\\to 3}=1$, $k_{3\\to 2}=1$。\n- 案例 2（中等速率交换）：\n  - 布居数：$(0.4,0.3,0.3)$。\n  - 偏移：$(-150,-25,25)$。\n  - 弛豫：$(3,5,5)$。\n  - 交换：$k_{2\\to 3}=40$, $k_{3\\to 2}=40$。\n- 案例 3（快交换）：\n  - 布居数：$(0.4,0.3,0.3)$。\n  - 偏移：$(-150,-25,25)$。\n  - 弛豫：$(3,5,5)$。\n  - 交换：$k_{2\\to 3}=500$, $k_{3\\to 2}=500$。\n- 案例 4（边界情况，无交换）：\n  - 布居数：$(0.4,0.3,0.3)$。\n  - 偏移：$(-150,-25,25)$。\n  - 弛豫：$(3,5,5)$。\n  - 交换：$k_{2\\to 3}=0$, $k_{3\\to 2}=0$。\n\n程序要求：\n- 通过迭代离散时间传播子 $\\mathbf{P}=\\exp(\\mathbf{A}\\Delta t)$ 来生成 FID，使得 $\\mathbf{m}_{n+1}=\\mathbf{P}\\,\\mathbf{m}_n$，其中 $\\mathbf{m}_0=\\mathbf{m}(0)$ 且 $s_n=\\mathbf{1}^\\top \\mathbf{m}_n$。\n- 对每个案例，计算：\n  - 有交换和无交换情况下归一化实数谱之间的 RMS 差异 $D$。\n  - 在探针频率 $\\{-150,-25,0,25,150\\}$ 处按规定计算的五个归一化实数谱值。\n- 最终输出格式：\n  - 你的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表。列表中的每个元素对应一个案例，其本身是一个包含六个浮点数的列表，顺序为 $[D, I_{-150}, I_{-25}, I_{0}, I_{25}, I_{150}]$，每个浮点数四舍五入到恰好六位小数。打印行中不得包含任何空白字符。例如：\"[[0.012345,0.9,0.8,0.7,0.6,0.5],[...],...]\"（此处的值仅为示例占位符；你的程序必须计算实际值）。\n- 角度单位：\n  - 翻转角为 $\\pi/2$ 弧度。\n- 频率单位：\n  - 所有频率必须以 $\\mathrm{Hz}$ 表示和探测。\n- 百分比：\n  - 如果报告任何分数，请以小数形式呈现。\n\n你的程序必须是自包含的，不接受任何输入，并且只能使用指定的库。其单行输出必须按上述方式汇总四个测试案例的结果。", "solution": "我们从旋转坐标系中横向磁化强度的布洛赫方程开始，该方程已扩展以包含一级化学交换，即布洛赫-麦康奈尔方程（Bloch–McConnell equations）。令 $\\mathbf{m}(t) = [m_1(t), m_2(t), m_3(t)]^\\top \\in \\mathbb{C}^3$ 表示三个不同位点的复数横向磁化强度。其基本贡献包括：\n- 位点 $i$ 以角偏移 $\\omega_i = 2\\pi \\Delta \\nu_i$ 进行的自由进动，增加一项 $-\\mathrm{i}\\,\\omega_i m_i$。\n- 以速率 $R_{2,i}$ 进行的横向弛豫，增加一项 $-R_{2,i} m_i$。\n- 从位点 $i$ 到 $j$ 的化学交换速率为 $k_{i\\to j}$，使 $m_i$ 以速率 $k_{i\\to j} m_i$ 减少；而从 $j$ 到 $i$ 的交换使 $m_i$ 以速率 $k_{j\\to i} m_j$ 增加。\n\n汇总这些贡献，对于每个位点 $i$ 可得：\n$$\n\\frac{d}{dt} m_i(t) = -\\left(R_{2,i} + \\mathrm{i}\\,\\omega_i\\right) m_i(t) - \\sum_{j\\neq i} k_{i\\to j} m_i(t) + \\sum_{j\\neq i} k_{j\\to i} m_j(t).\n$$\n写成矩阵形式为 $\\frac{d}{dt}\\mathbf{m}(t) = \\mathbf{A}\\,\\mathbf{m}(t)$，其中 $\\mathbf{A}$ 的元素为：\n$$\nA_{ii} = -\\left(R_{2,i} + \\mathrm{i}\\,\\omega_i\\right) - \\sum_{j\\neq i} k_{i\\to j}, \\quad\nA_{ij} = k_{j\\to i}\\quad (i\\neq j).\n$$\n在理想的非选择性 $\\pi/2$ 激发下，观测到的复数自由感应衰减（FID）是横向分量的总和：\n$$\ns(t) = \\mathbf{1}^\\top \\mathbf{m}(t) = \\mathbf{1}^\\top \\exp(\\mathbf{A} t)\\,\\mathbf{m}(0),\n$$\n初始条件为 $\\mathbf{m}(0) = M_0 [p_1,p_2,p_3]^\\top$，不失一般性，设 $M_0$ 为 $1$。\n\n为了数值计算 FID，我们在 $N$ 个均匀时间点上以驻留时间 $\\Delta t$ 进行采样。令 $\\mathbf{P}=\\exp(\\mathbf{A}\\Delta t)$，则离散演化满足：\n$$\n\\mathbf{m}_{n+1} = \\mathbf{P} \\mathbf{m}_n,\\quad \\mathbf{m}_0 = \\mathbf{m}(0), \\quad s_n = \\mathbf{1}^\\top \\mathbf{m}_n,\\quad n=0,1,\\dots,N-1.\n$$\n对于小矩阵，这种迭代方法稳定且高效，并能提供采样后的 FID $\\{s_n\\}$。\n\n频域谱通过离散傅里叶变换（DFT）计算，并通过快速傅里叶变换（FFT）实现。设复数谱为 $S(\\nu_n)$，其中频率 $\\{\\nu_n\\}$（单位 $\\mathrm{Hz}$）由标准 FFT 对采样间隔 $\\Delta t$ 的频率映射生成，然后平移以使零频居中：\n$$\n\\nu_n = \\mathrm{fftshift}\\left(\\mathrm{fftfreq}(N,\\Delta t)\\right), \\quad S(\\nu) = \\mathrm{fftshift}\\left(\\mathrm{FFT}(\\{s_n\\})\\right).\n$$\n对于从 $t=0$ 开始的理想指数衰减，实部 $\\mathrm{Re}\\{S(\\nu)\\}$ 对应于每个非交换位点的吸收型洛伦兹线型；在交换作用下，Bloch–McConnell 动力学使位点混合，并根据交换速率的区域（慢、中、快）使谱峰分裂或合并。\n\n我们将每个谱的实部归一化，使其最大值为 1：\n$$\n\\tilde{S}_{\\mathrm{real}}(\\nu) = \\frac{\\mathrm{Re}\\{S(\\nu)\\}}{\\max_{\\nu} \\mathrm{Re}\\{S(\\nu)\\}}.\n$$\n为量化交换如何改变复合线型，我们计算有交换的归一化实数谱 $\\tilde{S}_{\\mathrm{ex}}(\\nu)$ 与无交换的谱 $\\tilde{S}_{\\mathrm{noex}}(\\nu)$ 之间的均方根（RMS）差异：\n$$\nD = \\sqrt{\\frac{1}{N} \\sum_{n=0}^{N-1} \\left(\\tilde{S}_{\\mathrm{ex}}(\\nu_n) - \\tilde{S}_{\\mathrm{noex}}(\\nu_n)\\right)^2 }.\n$$\n这个无量纲度量捕捉了由交换引入的展宽、合并和色散变化。\n\n算法流程如下：\n- 根据给定的 $(R_{2,i})$、转换为 $(\\omega_i = 2\\pi \\Delta \\nu_i)$ 的 $(\\Delta \\nu_i)$ 以及交换速率 $(k_{i\\to j})$ 来构造 $\\mathbf{A}$。对于交换对，仅 $k_{2\\to 3}$ 和 $k_{3\\to 2}$ 非零；位点 1 无交换。\n- 计算 $\\mathbf{P}=\\exp(\\mathbf{A}\\Delta t)$，例如通过特征分解 $\\mathbf{A}=\\mathbf{V}\\mathbf{\\Lambda}\\mathbf{V}^{-1}$，使得 $\\exp(\\mathbf{A}\\Delta t)=\\mathbf{V}\\exp(\\mathbf{\\Lambda}\\Delta t)\\mathbf{V}^{-1}$，其中指数项为对角矩阵。\n- 迭代 $\\mathbf{m}_{n+1}=\\mathbf{P}\\mathbf{m}_n$ 以生成 FID $\\{s_n\\}$，其中 $n=0,\\dots,N-1$。\n- 计算并中心化 FFT 以获得 $S(\\nu)$ 及其​​实部；如上所述进行归一化。\n- 对无交换情况重复此过程，方法是将 $k_{2\\to 3}=k_{3\\to 2}=0$（所有交换速率为零），同时保持所有其他参数不变。\n- 通过最近点选择法，计算 $D$ 并在 $\\{-150,-25,0,25,150\\}$ $\\mathrm{Hz}$ 处探测归一化实数谱。\n\n测试套件的预期定性行为：\n- 案例 1（慢交换，$k_{2\\to 3}=k_{3\\to 2}=1$）应产生三个在 $-150$ $\\mathrm{Hz}$、$-25$ $\\mathrm{Hz}$ 和 $25$ $\\mathrm{Hz}$ 附近可分辨的类洛伦兹峰，与无交换情况相比畸变最小，从而得到一个较小的 $D$ 值。\n- 案例 2（中等速率交换，$k_{2\\to 3}=k_{3\\to 2}=40$）应使两个交换位点的谱峰展宽并部分合并，导致 $D$ 值显著增加；在 $-25$ $\\mathrm{Hz}$ 和 $25$ $\\mathrm{Hz}$ 附近的探针强度会发生很大变化。\n- 案例 3（快交换，$k_{2\\to 3}=k_{3\\to 2}=500$）应在位点 2 和 3 的布居数加权平均偏移（此处约 $0$ $\\mathrm{Hz}$）附近产生一个平均后的单峰，进一步改变复合线型，并产生比案例 1 更大的 $D$ 值。\n- 案例 4（无交换）根据构造必须产生 $D=0$，因为有交换和无交换的谱完全重合；这是一个边界检查。\n\n该程序用 $N=2048$ 和 $\\Delta t = 1/2000$ $\\mathrm{s}$ 数值化地实现这些步骤，并输出单行结果。对于每个案例，该行包含 RMS 差异 $D$ 和五个探针强度，顺序为 $[D, I_{-150}, I_{-25}, I_{0}, I_{25}, I_{150}]$，每个值都四舍五入到六位小数，并以逗号分隔的列表形式连接在方括号内，不含空格。这定量地展示了 Bloch–McConnell 形式如何因交换而改变复合 NMR 线型，这在有机化合物的波谱鉴定中是一个关键考虑因素，因为线宽展宽和合并可以编码动态化学过程。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef build_A_matrix(dnu_hz, R2, k23, k32):\n    \"\"\"\n    Construct the 3x3 complex Bloch-McConnell A matrix for transverse magnetization.\n    dnu_hz: list or array of length 3 with offsets in Hz [Δν1, Δν2, Δν3]\n    R2: list or array of length 3 with transverse relaxation rates in s^-1\n    k23, k32: exchange rates between site 2 and 3 in s^-1\n    Site 1 is non-exchanging; only 2->3 exchange is present.\n    \"\"\"\n    omega = 2 * np.pi * np.array(dnu_hz, dtype=float)  # rad/s\n    R2 = np.array(R2, dtype=float)\n    # Initialize A\n    A = np.zeros((3,3), dtype=complex)\n    # Diagonal terms: -(R2_i + i*omega_i) - sum_outgoing_k\n    # Off-diagonal terms: k_{j->i}\n    # Site 1: no exchange\n    A[0,0] = -(R2[0] + 1j*omega[0])\n    # Sites 2 and 3: include exchange\n    # Outgoing from 2 to 3: k23; from 3 to 2: k32\n    A[1,1] = -(R2[1] + 1j*omega[1]) - k23\n    A[2,2] = -(R2[2] + 1j*omega[2]) - k32\n    # Off-diagonals for exchange pair\n    A[1,2] = k32  # from 3 to 2\n    A[2,1] = k23  # from 2 to 3\n    return A\n\ndef propagator_from_A(A, dt):\n    \"\"\"\n    Compute the discrete-time propagator P = expm(A*dt) using eigendecomposition.\n    \"\"\"\n    vals, vecs = np.linalg.eig(A)\n    vecs_inv = np.linalg.inv(vecs)\n    exp_diag = np.exp(vals * dt)\n    P = (vecs @ np.diag(exp_diag) @ vecs_inv).astype(complex)\n    return P\n\ndef simulate_fid(P, m0, N):\n    \"\"\"\n    Iterate m_{n+1} = P m_n to generate s_n = sum(m_n) for n=0..N-1.\n    \"\"\"\n    m = m0.astype(complex)\n    s = np.empty(N, dtype=complex)\n    one = np.array([1.0, 1.0, 1.0], dtype=complex)\n    for n in range(N):\n        s[n] = one @ m\n        m = P @ m\n    return s\n\ndef spectrum_from_fid(s, dt):\n    \"\"\"\n    Compute centered FFT spectrum and frequency axis in Hz.\n    Return (freqs, S_centered).\n    \"\"\"\n    N = s.size\n    S = np.fft.fft(s) * dt  # scale by dt to approximate continuous-time FT units\n    S_shift = np.fft.fftshift(S)\n    freqs = np.fft.fftshift(np.fft.fftfreq(N, d=dt))\n    return freqs, S_shift\n\ndef nearest_bin_indices(freqs, probe_freqs):\n    \"\"\"\n    For each probe frequency, find the index of the nearest frequency bin.\n    \"\"\"\n    idxs = []\n    for f in probe_freqs:\n        idx = int(np.argmin(np.abs(freqs - f)))\n        idxs.append(idx)\n    return idxs\n\ndef normalize_real_spectrum(S_real):\n    \"\"\"\n    Normalize the real part of spectrum to have max value 1.\n    \"\"\"\n    max_val = np.max(S_real)\n    # Avoid division by zero; if all zero (shouldn't happen), return zeros\n    if max_val == 0.0:\n        return S_real\n    return S_real / max_val\n\ndef run_case(pops, dnu_hz, R2, k23, k32, N, dt, probe_freqs):\n    \"\"\"\n    Run a single test case and return (D, [I_probe...]) according to spec.\n    \"\"\"\n    # Initial magnetizations after 90-degree pulse (π/2 radians): m0 = pops (M0=1)\n    m0 = np.array(pops, dtype=float)\n    # With exchange\n    A_ex = build_A_matrix(dnu_hz, R2, k23, k32)\n    P_ex = propagator_from_A(A_ex, dt)\n    s_ex = simulate_fid(P_ex, m0, N)\n    freqs, S_ex = spectrum_from_fid(s_ex, dt)\n    S_ex_real_norm = normalize_real_spectrum(S_ex.real)\n    # Without exchange (all k=0)\n    A_no = build_A_matrix(dnu_hz, R2, 0.0, 0.0)\n    P_no = propagator_from_A(A_no, dt)\n    s_no = simulate_fid(P_no, m0, N)\n    _, S_no = spectrum_from_fid(s_no, dt)\n    S_no_real_norm = normalize_real_spectrum(S_no.real)\n    # RMS difference\n    D = float(np.sqrt(np.mean((S_ex_real_norm - S_no_real_norm) ** 2)))\n    # Probe intensities at specified frequencies\n    idxs = nearest_bin_indices(freqs, probe_freqs)\n    I_probes = [float(S_ex_real_norm[i]) for i in idxs]\n    return D, I_probes\n\ndef solve():\n    # Define sampling parameters\n    N = 2048\n    dt = 1.0 / 2000.0  # seconds\n    probe_freqs = [-150.0, -25.0, 0.0, 25.0, 150.0]  # Hz\n    # Define test cases as specified\n    test_cases = [\n        # (pops, dnu_hz, R2, k23, k32)\n        ((0.4, 0.3, 0.3), (-150.0, -25.0, 25.0), (3.0, 5.0, 5.0), 1.0, 1.0),    # Case 1: slow exchange\n        ((0.4, 0.3, 0.3), (-150.0, -25.0, 25.0), (3.0, 5.0, 5.0), 40.0, 40.0),  # Case 2: intermediate exchange\n        ((0.4, 0.3, 0.3), (-150.0, -25.0, 25.0), (3.0, 5.0, 5.0), 500.0, 500.0),# Case 3: fast exchange\n        ((0.4, 0.3, 0.3), (-150.0, -25.0, 25.0), (3.0, 5.0, 5.0), 0.0, 0.0),    # Case 4: no exchange\n    ]\n    results = []\n    for pops, dnu_hz, R2, k23, k32 in test_cases:\n        D, I_probes = run_case(pops, dnu_hz, R2, k23, k32, N, dt, probe_freqs)\n        # Round to six decimal places as required\n        out = [round(D, 6)] + [round(val, 6) for val in I_probes]\n        results.append(out)\n    # Format output with no spaces, each float with exactly six decimals\n    def format_float(x):\n        return f\"{x:.6f}\"\n    formatted_cases = []\n    for case in results:\n        formatted_cases.append(\"[\" + \",\".join(format_float(x) for x in case) + \"]\")\n    print(\"[\" + \",\".join(formatted_cases) + \"]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3726619"}, {"introduction": "任何科学模型都有其适用范围，Bloch 方程也不例外。当自旋间的量子力学相互作用（即标量耦合 $J$）与化学位移差异 $\\Delta\\nu$ 相当时，这个经典的、唯象的 Bloch 模型便会失效。本练习旨在培养识别“强耦合”状态的能力，在这种状态下，简单的独立自旋图像不再成立，必须采用完整的量子力学处理。掌握这一关键技能可以避免对复杂谱图的误读，并加深对核磁共振中经典与量子描述界限的理解。[@problem_id:3726613]", "problem": "在用于有机物鉴定的核磁共振（NMR）波谱学中，通常使用 Bloch 方程来模拟单个、无相互作用的质子自旋 $I=\\tfrac{1}{2}$。该方程描述了在外部静磁场 $\\mathbf{B}_0$ 和弱射频激励下宏观磁化矢量 $\\mathbf{M}(t)$ 的行为。在该唯象描述中，在线性响应且自旋间无相互作用的情况下，横向磁化以自旋-自旋弛豫时间 $T_2$ 衰减，频域吸收线形是一个以拉莫尔角频率 $\\omega_0=\\gamma B_0$ 为中心的简单 Lorentzian 峰，其中 $\\gamma$ 是旋磁比。相比之下，多自旋的微观量子力学描述包含了内部相互作用，例如质子间的各向同性标量耦合 $J$，其哈密顿量为 $\\hat{H}=-\\hbar\\sum_k \\omega_k \\hat{I}_{kz} + 2\\pi\\hbar \\sum_{k\\ell} J_{k\\ell}\\,\\hat{\\mathbf{I}}_k\\cdot\\hat{\\mathbf{I}}_\\ell$。当拉莫尔角频率之差与标量耦合相当时，该哈密顿量可以混合 Zeeman 乘积态。\n\n考虑一个有机分子，其含有两个耦合的 $^1\\mathrm{H}$ 自旋（标记为 $1$ 和 $2$），各向同性标量耦合常数为 $J$（单位为 $\\mathrm{Hz}$），化学位移为 $\\delta_1$ 和 $\\delta_2$（单位为 $\\mathrm{ppm}$）。波谱仪在质子频率 $\\nu_0$（单位为 $\\mathrm{Hz}$）下工作，因此以 $\\mathrm{Hz}$ 为单位的频率差为 $\\Delta\\nu=\\nu_0\\,|\\delta_1-\\delta_2|$，角频率差为 $\\Delta\\omega=2\\pi\\Delta\\nu$，而以角频率单位表示的标量耦合为 $2\\pi J$。假设两个自旋的自旋-自旋弛豫时间 $T_2$ 相同且足够长，以至于固有线宽远窄于所引用的所有裂分，并考虑小翻转角、线性响应的采集方式。\n\n选择一个或多个选项，这些选项对应的实验条件会使两个质子间的强耦合导致 Bloch 方程关于每个跃迁均为独立、简单的 Lorentzian 线形的预测失效，从而必须使用完整的量子力学处理（例如，乘积算符或密度矩阵）才能准确预测观测到的 $^1\\mathrm{H}$ 谱图，以进行可靠的波谱鉴定。\n\nA. $\\nu_0=300\\,\\mathrm{MHz}$；$\\delta_1=7.200\\,\\mathrm{ppm}$，$\\delta_2=7.220\\,\\mathrm{ppm}$；$J=12\\,\\mathrm{Hz}$；$T_2=1.2\\,\\mathrm{s}$。\n\nB. $\\nu_0=600\\,\\mathrm{MHz}$；$\\delta_1=1.000\\,\\mathrm{ppm}$，$\\delta_2=1.500\\,\\mathrm{ppm}$；$J=7\\,\\mathrm{Hz}$；$T_2=0.8\\,\\mathrm{s}$。\n\nC. $\\nu_0=900\\,\\mathrm{MHz}$；$\\delta_1=3.000\\,\\mathrm{ppm}$，$\\delta_2=3.030\\,\\mathrm{ppm}$；$J=20\\,\\mathrm{Hz}$；$T_2=1.5\\,\\mathrm{s}$。\n\nD. $\\nu_0=400\\,\\mathrm{MHz}$；$\\delta_1=2.000\\,\\mathrm{ppm}$，$\\delta_2=2.100\\,\\mathrm{ppm}$；$J=1\\,\\mathrm{Hz}$；$T_2=1.0\\,\\mathrm{s}$。\n\n请从 Bloch 方程框架和耦合自旋的微观哈密顿量出发，阐述你的推理过程，并通过比较控制状态混合和线形偏差的相关角频率尺度来证明你的选择。", "solution": "首先对问题陈述进行严格验证。\n\n### 第1步：提取已知条件\n- 系统：两个耦合的质子（$^1\\mathrm{H}$）自旋，标记为 $1$ 和 $2$，自旋量子数为 $I = \\frac{1}{2}$。\n- 耦合：各向同性标量耦合常数 $J$（单位为 $\\mathrm{Hz}$）。\n- 化学位移：$\\delta_1$ 和 $\\delta_2$（单位为 $\\mathrm{ppm}$）。\n- 波谱仪频率：$\\nu_0$（单位为 $\\mathrm{Hz}$）。\n- 频率差：$\\Delta\\nu = \\nu_0 |\\delta_1 - \\delta_2|$。\n- 角频率差：$\\Delta\\omega = 2\\pi\\Delta\\nu$。\n- 以角频率表示的耦合：$2\\pi J$。\n- 弛豫：两个自旋的自旋-自旋弛豫时间 $T_2$ 相同且足够长，确保固有线宽可忽略不计。\n- 采集条件：小翻转角，线性响应。\n- 微观哈密顿量：$\\hat{H} = -\\hbar\\sum_k \\omega_k \\hat{I}_{kz} + 2\\pi\\hbar \\sum_{k\\ell} J_{k\\ell}\\,\\hat{\\mathbf{I}}_k\\cdot\\hat{\\mathbf{I}}_\\ell$。\n- 问题：确定在何种实验条件下，“强耦合”会使独立的自旋的简单 Bloch 方程模型失效，从而必须采用完整的量子力学处理。\n\n### 第2步：使用提取的已知条件进行验证\n- **科学基础**：该问题牢固地植根于核磁共振（NMR）波谱学的基本原理。所提供的哈密顿量是高场近似下耦合双自旋系统的标准表示。弱耦合（一级谱）和强耦合（二级谱）之间的区别是解释 NMR 数据的基石概念。所有参数（$J$、$\\delta$、$\\nu_0$、$T_2$）及其关系都定义正确且具有物理意义。\n- **适定性**：问题是适定的。它要求确定定义强耦合机制的条件。在 NMR 中，该机制由自旋间频率差（$\\Delta\\nu$）与其标量耦合常数（$J$）之比来量化定义。问题在选项中提供了计算该比值并做出明确判断所需的所有数据。\n- **客观性**：语言精确、量化，没有主观或模糊的术语。\n- **完整性与一致性**：问题是自洽的。提供的哈密顿量和定义与标准 NMR 理论一致。关于 $T_2$ 的条件很重要，因为它确保了由耦合引起的精细结构不会被弛豫导致的谱线展宽所掩盖，从而使得对耦合效应的分析有意义。\n- **真实性**：波谱仪频率（$300 - 900\\,\\mathrm{MHz}$）、化学位移（单位为 $\\mathrm{ppm}$）、耦合常数（$1 - 20\\,\\mathrm{Hz}$）和弛豫时间（$\\approx 1\\,\\mathrm{s}$）的数值对于溶液中有机分子的质子（$^1\\mathrm{H}$）NMR 来说都是符合实际的。\n\n### 第3步：结论与行动\n问题陈述在科学上是合理的、适定的且完整的。它提出了 NMR 波谱学领域一个有效且标准的问题。因此，将推导出一个完整的解答。\n\n### 强耦合判据的推导\n\nBloch 方程以其最简单的形式描述了一组相同且无相互作用的自旋的宏观磁化演化。当应用于具有多个不同自旋的分子时，该模型仅在自旋可被视为有效独立时才有效。在这个“弱耦合”极限下，谱图是每个自旋图谱的简单叠加（例如，一个与另一个自旋耦合的自旋呈现为双重峰，一个与两个等效自旋耦合的自旋呈现为三重峰等）。\n\n要理解这种近似何时失效，我们必须分析双自旋体系的完整量子力学哈密顿量，如题目所提供：\n$$ \\hat{H} = -\\hbar(\\omega_1 \\hat{I}_{1z} + \\omega_2 \\hat{I}_{2z}) + 2\\pi\\hbar J_{12}\\,\\hat{\\mathbf{I}}_1\\cdot\\hat{\\mathbf{I}}_2 $$\n这里，$\\omega_1$ 和 $\\omega_2$ 分别是自旋 $1$ 和 $2$ 的拉莫尔角频率，$J_{12}$ 是以 $\\mathrm{Hz}$ 为单位的标量耦合常数。$\\hat{\\mathbf{I}}_1\\cdot\\hat{\\mathbf{I}}_2$ 项可以展开为 $\\hat{I}_{1x}\\hat{I}_{2x} + \\hat{I}_{1y}\\hat{I}_{2y} + \\hat{I}_{1z}\\hat{I}_{2z}$。使用升降算符 $\\hat{I}_{+}, \\hat{I}_{-}$，这变为：\n$$ \\hat{\\mathbf{I}}_1\\cdot\\hat{\\mathbf{I}}_2 = \\hat{I}_{1z}\\hat{I}_{2z} + \\frac{1}{2}(\\hat{I}_{1+}\\hat{I}_{2-} + \\hat{I}_{1-}\\hat{I}_{2+}) $$\n哈密顿量可以写成（以角频率为单位，$\\hat{H}/\\hbar$）：\n$$ \\frac{\\hat{H}}{\\hbar} = -(\\omega_1 \\hat{I}_{1z} + \\omega_2 \\hat{I}_{2z}) + 2\\pi J_{12} \\left[ \\hat{I}_{1z}\\hat{I}_{2z} + \\frac{1}{2}(\\hat{I}_{1+}\\hat{I}_{2-} + \\hat{I}_{1-}\\hat{I}_{2+}) \\right] $$\n问题源于 $\\frac{1}{2}(\\hat{I}_{1+}\\hat{I}_{2-} + \\hat{I}_{1-}\\hat{I}_{2+})$ 项，通常称为“翻转-翻转”项。在简单乘积基矢 $\\{|\\alpha\\alpha\\rangle, |\\alpha\\beta\\rangle, |\\beta\\alpha\\rangle, |\\beta\\beta\\rangle\\}$ 中，此项是非对角的，其中 $\\alpha$ 代表自旋向上（$m_I=+\\frac{1}{2}$），$\\beta$ 代表自旋向下（$m_I=-\\frac{1}{2}$）。具体来说，该项会混合总磁量子数 $m_I = m_{I1} + m_{I2}$ 相同的态。$|\\alpha\\alpha\\rangle$（$m_I=1$）和 $|\\beta\\beta\\rangle$（$m_I=-1$）态不受影响。然而，$|\\alpha\\beta\\rangle$ 和 $|\\beta\\alpha\\rangle$（两者 $m_I=0$）态会因此项而混合。\n\n由于 Zeeman 相互作用，未受微扰的 $|\\alpha\\beta\\rangle$ 和 $|\\beta\\alpha\\rangle$ 态之间的能量差为 $\\hbar(\\omega_1 - \\omega_2) = \\hbar\\Delta\\omega = h\\Delta\\nu$。混合相互作用的强度与耦合常数成正比，即 $\\hbar(2\\pi J_{12})$。\n\n根据微扰理论，只有当被混合的态之间的能量差远大于它们之间的耦合大小时，简单乘积态才是真实本征态的良好近似。在此背景下，弱耦合近似（以及简单、独立自旋模型的有效性）的条件是：\n$$ \\Delta\\nu \\gg J_{12} $$\n相反，“强耦合”机制，即需要完整量子力学处理的情况，发生在不满足此条件时：\n$$ \\Delta\\nu \\approx J_{12} \\quad \\text{或} \\quad \\Delta\\nu  J_{12} $$\n一个常见的经验法则是，当比值 $\\Delta\\nu/J$ 小于约 $10$ 时，强耦合效应（也称为二级效应，导致谱线位置偏移和强度畸变，即“屋顶效应”）变得显著。当该比值接近 $1$ 或更小时，谱图会与简单的一级图谱有显著偏离，独立自旋模型完全不适用。\n\n任务是为每个选项计算比值 $\\frac{\\Delta\\nu}{J}$，并找出该值较小（表示强耦合）的情况。\n\n### 逐项分析\n\n对于每个选项，我们计算 $\\Delta\\nu = \\nu_0 |\\delta_1 - \\delta_2|$ 和比值 $\\frac{\\Delta\\nu}{J}$。\n\n**A. $\\nu_0=300\\,\\mathrm{MHz}$；$\\delta_1=7.200\\,\\mathrm{ppm}$，$\\delta_2=7.220\\,\\mathrm{ppm}$；$J=12\\,\\mathrm{Hz}$；$T_2=1.2\\,\\mathrm{s}$。**\n化学位移差为 $|\\delta_1 - \\delta_2| = |7.200 - 7.220| = 0.020\\,\\mathrm{ppm}$。\n频率差为：\n$$ \\Delta\\nu = (300 \\times 10^6\\,\\mathrm{Hz}) \\times (0.020 \\times 10^{-6}) = 6.0\\,\\mathrm{Hz} $$\n耦合常数为 $J = 12\\,\\mathrm{Hz}$。\n比值为：\n$$ \\frac{\\Delta\\nu}{J} = \\frac{6.0\\,\\mathrm{Hz}}{12\\,\\mathrm{Hz}} = 0.5 $$\n该比值小于 $1$，表明这是一个非常强的耦合机制。由化学位移差引起的能量分离小于耦合相互作用能。因此，必须采用完整的量子力学处理，谱图将是一个复杂的多重峰，而不是两个简单的双重峰。\n**结论：正确。**\n\n**B. $\\nu_0=600\\,\\mathrm{MHz}$；$\\delta_1=1.000\\,\\mathrm{ppm}$，$\\delta_2=1.500\\,\\mathrm{ppm}$；$J=7\\,\\mathrm{Hz}$；$T_2=0.8\\,\\mathrm{s}$。**\n化学位移差为 $|\\delta_1 - \\delta_2| = |1.000 - 1.500| = 0.500\\,\\mathrm{ppm}$。\n频率差为：\n$$ \\Delta\\nu = (600 \\times 10^6\\,\\mathrm{Hz}) \\times (0.500 \\times 10^{-6}) = 300\\,\\mathrm{Hz} $$\n耦合常数为 $J = 7\\,\\mathrm{Hz}$。\n比值为：\n$$ \\frac{\\Delta\\nu}{J} = \\frac{300\\,\\mathrm{Hz}}{7\\,\\mathrm{Hz}} \\approx 42.9 $$\n该比值远大于 $10$，这是弱耦合机制（一个 “AX” 体系）的标志。谱图将能很好地通过一级分析（两个独立的双重峰）来近似。独立自旋模型是有效的。\n**结论：不正确。**\n\n**C. $\\nu_0=900\\,\\mathrm{MHz}$；$\\delta_1=3.000\\,\\mathrm{ppm}$，$\\delta_2=3.030\\,\\mathrm{ppm}$；$J=20\\,\\mathrm{Hz}$；$T_2=1.5\\,\\mathrm{s}$。**\n化学位移差为 $|\\delta_1 - \\delta_2| = |3.000 - 3.030| = 0.030\\,\\mathrm{ppm}$。\n频率差为：\n$$ \\Delta\\nu = (900 \\times 10^6\\,\\mathrm{Hz}) \\times (0.030 \\times 10^{-6}) = 27\\,\\mathrm{Hz} $$\n耦合常数为 $J = 20\\,\\mathrm{Hz}$。\n比值为：\n$$ \\frac{\\Delta\\nu}{J} = \\frac{27\\,\\mathrm{Hz}}{20\\,\\mathrm{Hz}} = 1.35 $$\n该比值接近 $1$。这是一个明显的强耦合情况（一个 “AB” 体系）。谱图将表现出显著的二级特征，包括谱线位置偏移和明显的强度屋顶效应。简单的 Bloch 模型不适用。\n**结论：正确。**\n\n**D. $\\nu_0=400\\,\\mathrm{MHz}$；$\\delta_1=2.000\\,\\mathrm{ppm}$，$\\delta_2=2.100\\,\\mathrm{ppm}$；$J=1\\,\\mathrm{Hz}$；$T_2=1.0\\,\\mathrm{s}$。**\n化学位移差为 $|\\delta_1 - \\delta_2| = |2.000 - 2.100| = 0.100\\,\\mathrm{ppm}$。\n频率差为：\n$$ \\Delta\\nu = (400 \\times 10^6\\,\\mathrm{Hz}) \\times (0.100 \\times 10^{-6}) = 40\\,\\mathrm{Hz} $$\n耦合常数为 $J = 1\\,\\mathrm{Hz}$。\n比值为：\n$$ \\frac{\\Delta\\nu}{J} = \\frac{40\\,\\mathrm{Hz}}{1\\,\\mathrm{Hz}} = 40 $$\n该比值远大于 $10$。尽管化学位移有些接近，但极小的耦合常数确保了该体系是弱耦合的。一级分析是合适的。\n**结论：不正确。**\n\n总之，选项 A 和 C 描述了频率差 $\\Delta\\nu$ 与耦合常数 $J$ 处于相同数量级或更小的自旋体系。这些是强耦合的条件，此时独立自旋近似失效，需要完整的量子力学处理才能准确预测 NMR 谱图。", "answer": "$$\\boxed{AC}$$", "id": "3726613"}]}