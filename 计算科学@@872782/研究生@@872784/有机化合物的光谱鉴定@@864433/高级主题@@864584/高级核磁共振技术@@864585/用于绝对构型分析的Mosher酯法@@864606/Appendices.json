{"hands_on_practices": [{"introduction": "本练习将聚焦于Mosher酯分析中至关重要的第一步：非对映异构体酯的化学合成。一次成功的分析取决于一个纯净、高产率且能保持醇手性中心立体化学完整性的反应。本题将引导你评估不同的实验方案，以选择在反应效率与副反应（如外消旋化）最小化之间达到最佳平衡的方案，这是任何合成或分析化学家都需具备的关键技能。[@problem_id:3713925]", "problem": "给定一个手性的、对碱敏感的仲醇，其绝对构型未知（无其他可烯醇化的立体中心）。您计划通过与 $(R)$- 和 $(S)$-Mosher 酸（也称为 $\\alpha$-甲氧基-$\\alpha$-三氟甲基苯乙酸，MTPA）反应，形成两种非对映异构体酯，来确定其绝对构型。衍生化反应必须是定量的，以便进行准确的核磁共振（NMR）积分，并且该方案必须最大限度地减少底物立体中心发生的任何意外消旋或重排。您将在 $1.00\\,\\mathrm{mmol}$ 规模上对该醇进行操作，并用等量部分并行进行 $(R)$- 和 $(S)$-MTPA 酯化反应。根据基本原理，回顾以下几点：(i) 醇的酰氯酯化反应会产生一当量的氯化氢（$\\mathrm{HCl}$），因此应存在至少化学计量的非亲核性碱以中和 $\\mathrm{HCl}$；(ii) 催化性亲核酰基转移可加速酰化反应并在低温下提高转化率；(iii) 避免使用强布朗斯特碱和强酸，限制反应温度，并保持无水条件可减少副反应和消旋风险；(iv) 使用微过量的酰化剂可通过质量作用定律推动反应完成，并减少因意外水解造成的损失。\n\n以下哪种反应方案最能满足这些限制条件，并最有可能在确保 $(R)$- 和 $(S)$-MTPA 酯完全衍生化的同时，最大限度地减少消旋？\n\nA. 将醇分成两等份，每份 $0.50\\,\\mathrm{mmol}$。在两个干燥、经氮气吹扫且装有无水二氯甲烷（DCM）的小瓶中，各加入三乙胺（TEA，$1.00\\,\\mathrm{mmol}$，相对于醇为 $2.0$ 当量）和 $4$-（二甲氨基）吡啶（DMAP，$0.05\\,\\mathrm{mmol}$，$0.10$ 当量）。冷却至 $0\\,^{\\circ}\\mathrm{C}$。向一个小瓶中逐滴加入 $(R)$-MTPA 氯化物（MTPA–Cl，$0.60\\,\\mathrm{mmol}$，$1.2$ 当量）；向另一个小瓶中加入等量的 $(S)$-MTPA–Cl。在 $0\\,^{\\circ}\\mathrm{C}$ 下搅拌 $15\\,\\mathrm{min}$，然后升温至 $25\\,^{\\circ}\\mathrm{C}$ 并搅拌，直至薄层色谱法（TLC）显示醇已完全消耗（通常需要 $1$–$2\\,\\mathrm{h}$）。用饱和碳酸氢钠水溶液淬灭反应，洗涤以去除残留的 MTPA 和胺盐，干燥并浓缩。\n\nB. 对于每种对映异构体，在单个反应容器中，于氮气保护下，将氢化钠（$\\mathrm{NaH}$，$1.10$ 当量）悬浮在 $0\\,^{\\circ}\\mathrm{C}$ 的无水四氢呋喃（THF）中，加入醇（$0.50\\,\\mathrm{mmol}$），然后加入 MTPA–Cl（$0.45\\,\\mathrm{mmol}$，$0.90$ 当量），并加热至 THF 回流温度（$\\approx 66\\,^{\\circ}\\mathrm{C}$）$6\\,\\mathrm{h}$。用甲醇小心淬灭反应，然后加水，萃取，干燥并浓缩。\n\nC. 将醇分成两等份，每份 $0.50\\,\\mathrm{mmol}$。对于每一份，在 $25\\,^{\\circ}\\mathrm{C}$ 的无水 DCM 中，加入 MTPA 酸（$0.50\\,\\mathrm{mmol}$，$1.0$ 当量），$N,N'$-二环己基碳二亚胺（DCC，$0.50\\,\\mathrm{mmol}$，相对于 MTPA 酸为 $1.0$ 当量），不加额外的催化剂或碱。搅拌 $12\\,\\mathrm{h}$，过滤除去二环己基脲，然后浓缩。\n\nD. 将全部 $1.00\\,\\mathrm{mmol}$ 的醇与 MTPA 酸（$2.00\\,\\mathrm{mmol}$，$2.0$ 当量）和对甲苯磺酸（$0.20\\,\\mathrm{mmol}$，$0.20$ 当量）在甲苯中混合，并使用 Dean–Stark 分水器回流 $12\\,\\mathrm{h}$，以实现 Fischer 酯化。将粗产物混合物平分，一半指定为 $(R)$-MTPA 酯，另一半指定为 $(S)$-MTPA 酯进行分析。\n\n选择唯一的最佳选项。", "solution": "该问题要求为从一个手性的、对碱敏感的仲醇制备非对映异构体 $(R)$- 和 $(S)$-Mosher 酯（MTPA 酯）选择最合适的反应方案。主要目标是确保定量衍生化以便进行准确的核磁共振（NMR）分析，并最大限度地减少醇的立体中心的消旋。问题陈述为合适的方案提供了四个指导原则：(i) 用非亲核性碱中和生成的氯化氢（$\\mathrm{HCl}$）；(ii) 通过催化性亲核酰基转移加速酰化；(iii) 避免强布朗斯特酸/碱和高温等苛刻条件；(iv) 使用微过量的酰化剂以推动反应完成。\n\n我们将根据这些原则评估每个提议的方案。所提供的醇为 $1.00\\,\\mathrm{mmol}$ 规模，需分成两个相等的 $0.50\\,\\mathrm{mmol}$ 部分，分别与 $(R)$- 和 $(S)$-MTPA 衍生物反应。\n\n**选项 A 分析**\n\n该方案涉及在无水二氯甲烷（DCM）中，使每份 $0.50\\,\\mathrm{mmol}$ 的醇与 $(R)$- 或 $(S)$-MTPA 氯化物（MTPA–Cl，$0.60\\,\\mathrm{mmol}$，$1.2$ 当量）反应。反应在三乙胺（TEA，$1.00\\,\\mathrm{mmol}$，$2.0$ 当量）和催化量的 $4$-（二甲氨基）吡啶（DMAP，$0.05\\,\\mathrm{mmol}$，$0.10$ 当量）存在下进行。反应温度最初维持在 $0\\,^{\\circ}\\mathrm{C}$，然后升温至 $25\\,^{\\circ}\\mathrm{C}$。\n\n*   **原则 (i)**：使用 MTPA–Cl 进行酯化时，每反应一当量的酰氯会生成一当量的 $\\mathrm{HCl}$。该方案包含了 $2.0$ 当量的 TEA，这是一种位阻大的非亲核性叔胺碱，足以中和生成的 $\\mathrm{HCl}$（如果所有 MTPA-Cl 都反应，最多产生 $0.60\\,\\mathrm{mmol}$），从而防止可能损害敏感底物的酸性条件。此原则得到满足。\n*   **原则 (ii)**：该方案包含催化量（$0.10$ 当量）的 DMAP。DMAP 是一种高效的亲核催化剂，用于酰基转移反应。它与 MTPA–Cl 反应形成高活性的 $N$-酰基吡啶中间体，该中间体随后被醇迅速酰化。这种催化作用使反应在低温下高效进行，满足了此原则。\n*   **原则 (iii)**：反应在温和的温度条件下（$0\\,^{\\circ}\\mathrm{C}$ 至 $25\\,^{\\circ}\\mathrm{C}$）进行。它避免了使用强布朗斯特酸和碱（TEA 是一种中等强度的弱碱）。使用了无水溶剂。这些条件对于最大限度地减少敏感底物的消旋和其他副反应（如消除反应）是理想的。此原则得到满足。\n*   **原则 (iv)**：使用了微过量的酰化剂 MTPA–Cl（$1.2$ 当量）。应用勒夏特列原理有助于推动反应完全进行，这对于从最终的 NMR 谱中获得准确的积分数据至关重要。此原则得到满足。\n\n该方案代表了形成 Mosher 酯的标准、成熟且最可靠的方法。它遵守了所有指导原则。\n\n结论：**正确**。\n\n**选项 B 分析**\n\n该方案首先用氢化钠（$\\mathrm{NaH}$，$1.10$ 当量）将醇（$0.50\\,\\mathrm{mmol}$）去质子化形成钠醇盐，然后使其与亚化学计量的 MTPA–Cl（$0.45\\,\\mathrm{mmol}$，$0.90$ 当量）在 THF 回流（$\\approx 66\\,^{\\circ}\\mathrm{C}$）条件下反应。\n\n*   **原则 (iii)**：该方案存在严重缺陷。$\\mathrm{NaH}$ 是一种非常强的布朗斯特碱。对于“对碱敏感”的底物，使用它会带来显著的副反应风险，例如消除反应或立体中心的差向异构化。此外，在回流温度（$66\\,^{\\circ}\\mathrm{C}$）下加热构成苛刻的热条件，进一步增加了消旋或降解的风险。这违反了使用温和条件的原则。\n*   **原则 (iv)**：使用亚化学计量的酰化剂（$0.90$ 当量）使得醇的定量转化成为不可能。最多只能有 $90\\%$ 的醇转化为酯，这违背了为准确进行 NMR 分析而进行定量衍生化的目标。\n\n该方案在多个关键点上失败。\n\n结论：**不正确**。\n\n**选项 C 分析**\n\n该方案采用 Steglich 酯化反应，使用 MTPA 酸（$0.50\\,\\mathrm{mmol}$，$1.0$ 当量）、醇（$0.50\\,\\mathrm{mmol}$，$1.0$ 当量）和 $N,N'$-二环己基碳二亚胺（DCC，$0.50\\,\\mathrm{mmol}$，$1.0$ 当量），在 $25\\,^{\\circ}\\mathrm{C}$ 下进行，不加任何催化剂或额外的碱。\n\n*   **原则 (iv)**：使用精确化学计量的反应物（均为 $1.0$ 当量）使得在合理的时间内很难将反应推动至完成。任何微小的副反应或操作损失都将导致限量反应物（在这种情况下，所有反应物都是限量的）转化不完全。这未能满足定量衍生化的要求。\n*   **原则 (ii)**：该方案明确省略了催化剂。Steglich 酯化反应通常较慢，加入催化量的 DMAP 会显著加速反应。省略催化剂会使反应效率降低，更容易发生副反应，例如 $O$-酰基异脲中间体重排为稳定的 $N$-酰基脲，从而消耗活化的酸。\n*   **消旋风险**：虽然醇的立体中心可能安全，但已知 DCC 介导的偶联反应存在使手性羧酸（此处为 $(R)$- 或 $(S)$-MTPA）消旋的风险。这将导致由单一 MTPA 对映异构体产生非对映异构体酯的混合物，使得后续的 NMR 分析无法用于确定醇的构型。\n\n该方案因其化学计量和缺乏催化而并非最佳选择，使其不可能达到定量转化。\n\n结论：**不正确**。\n\n**选项 D 分析**\n\n该方案提议进行 Fischer 酯化反应，通过将整批醇（$1.00\\,\\mathrm{mmol}$）与 MTPA 酸（$2.00\\,\\mathrm{mmol}$）在强酸催化剂（对甲苯磺酸，$p$-TsOH）和高温（在甲苯中回流并使用 Dean-Stark 分水器）下反应。\n\n*   **方案设计缺陷**：实验设计不合逻辑。它涉及将醇与一种形式的 MTPA 酸（推测为外消旋体，尽管未指明）反应，然后不合逻辑地将产物混合物的一半“指定”为 $(R)$-MTPA 酯，另一半指定为 $(S)$-MTPA 酯。要进行 Mosher 分析，必须进行两个独立的、平行的反应，一个使用对映体纯的 $(R)$-MTPA，另一个使用对映体纯的 $(S)$-MTPA。该方案未能满足这一基本要求。\n*   **原则 (iii)**：Fischer 酯化需要强酸性条件（$p$-TsOH）和高温（甲苯回流，$\\approx 111\\,^{\\circ}\\mathrm{C}$）。对于一个“对碱敏感”（并且可能也对酸敏感）的仲醇来说，这些条件极其苛刻。消旋、消除（脱水）和其他重排的风险极高，直接违背了保持底物立体化学完整性的核心要求。\n\n该方案的设计不合逻辑，其条件对于敏感底物来说过于苛刻。\n\n结论：**不正确**。\n\n**总结**\n\n方案 A 是唯一系统且正确地应用化学反应性基本原理以实现所述目标的选项。它使用温和的条件、适当的化学计量、一种清除剂碱和一种亲核催化剂。这种组合确保了高效、定量的酯化反应，同时最大限度地降低了消旋风险，使其成为制备用于绝对构型分析的 Mosher 酯的最佳选择。", "answer": "$$\\boxed{A}$$", "id": "3713925"}, {"introduction": "为了连接定性模型与定量预测，最后的这个练习引入了一种计算方法。你将实现一个协议，该协议通过数学模型来模拟Mosher辅助基团的各向异性屏蔽效应，从而可以计算空间中任意一点的预期$\\Delta\\delta_{S-R}$值。这个练习展示了如何利用计算工具生成“符号图”，为立体化学构型指定提供一种强大的、基于第一性原理的替代方案，以取代经验模型。[@problem_id:3713895]", "problem": "您的任务是实现一个基于原理的计算方案，该方案将基于各向异性的屏蔽面（其理论基础为核无关化学位移（NICS）分析）与用于绝对构型确定的Mosher酯法中的符号预测联系起来。您将在一个点偶极子各向异性模型中进行操作，其中位于某个位置矢量处的核磁屏蔽贡献由一个源于磁化率的各向异性张量描述。\n\n请从以下这些经过充分检验的基本原理出发：\n1) 在点偶极子（远场）近似下，由各向异性源在位置矢量为 $\\mathbf{r} \\in \\mathbb{R}^3$ 处产生的核磁屏蔽位移，与各向异性张量和方向 $\\hat{\\mathbf{r}} = \\mathbf{r}/\\lVert \\mathbf{r} \\rVert$ 的双线性形式成正比，并按 $\\lVert \\mathbf{r} \\rVert^{-3}$ 进行缩放。也就是说，屏蔽贡献正比于 $\\hat{\\mathbf{r}}^{\\mathsf{T}} \\mathbf{A} \\hat{\\mathbf{r}} \\, \\lVert \\mathbf{r} \\rVert^{-3}$，其中 $\\mathbf{A}$ 是一个实的、对称的、无迹的各向异性张量，它描述了由环电流或羰基产生的屏蔽面（如核无关化学位移（NICS）理论中的情况）。\n2) 各向异性张量在不同分子坐标系之间的旋转通过正交变换实现：如果 $\\mathbf{R}$ 是从 $\\mathbf{A}'$ 的主轴标架到实验室坐标系的旋转矩阵，则 $\\mathbf{A} = \\mathbf{R}\\,\\mathbf{A}'\\,\\mathbf{R}^{\\mathsf{T}}$。\n\n待实现的方案：\n- 使用一个在其主轴标架中的非轴对称、无迹的各向异性张量来模拟Mosher助剂的芳香环（Mosher酸的间三氟甲基苯基部分），\n  $$\\mathbf{A}_{\\text{ring}}' = \\mathrm{diag}(a_x, a_y, a_z), \\quad a_x = 8,\\; a_y = 2,\\; a_z = -10,$$\n  其单位为百万分率乘以立方埃（$\\mathrm{ppm}\\cdot\\mathrm{\\AA}^3$），并确保 $a_x + a_y + a_z = 0$。\n- 将Mosher酯的羰基轴沿实验室坐标系的 $z$ 轴放置，并将原点设在立体中心。实验室坐标轴 $(x,y,z)$ 定义了本次练习的Mosher坐标系。\n- 使用另一个与实验室坐标系 $z$ 轴对齐的无迹张量来近似羰基的屏蔽面，\n  $$\\mathbf{A}_{\\text{C=O}} = \\mathrm{diag}(b_x, b_y, b_z), \\quad b_x = -8,\\; b_y = -8,\\; b_z = 16,$$\n  其单位同样为 $\\mathrm{ppm}\\cdot\\mathrm{\\AA}^3$。\n- 将(S)-Mosher酯芳香环的取向定义为绕实验室坐标系 $y$ 轴旋转 $45$ 度：\n  $$\\mathbf{R}_S = \\mathbf{R}_y(45^\\circ).$$\n- 将(R)-Mosher酯的取向定义为相对于(S)-取向绕实验室坐标系 $z$ 轴旋转 $90$ 度：\n  $$\\mathbf{R}_R = \\mathbf{R}_z(90^\\circ)\\,\\mathbf{R}_S.$$\n- 对于每种取向 $X \\in \\{S,R\\}$，通过以下方式将环各向异性张量变换到实验室坐标系：\n  $$\\mathbf{A}_{\\text{ring},X} = \\mathbf{R}_X\\,\\mathbf{A}_{\\text{ring}}'\\,\\mathbf{R}_X^{\\mathsf{T}}.$$\n- 对于一个探针位置 $\\mathbf{r}$（单位为埃），将预测的各向异性诱导化学位移（单位为百万分率）定义为：\n  $$\\delta_X(\\mathbf{r}) = k \\frac{\\hat{\\mathbf{r}}^{\\mathsf{T}} \\left(\\mathbf{A}_{\\text{ring},X} + \\mathbf{A}_{\\text{C=O}}\\right) \\hat{\\mathbf{r}}}{\\lVert \\mathbf{r} \\rVert^3}, \\quad \\hat{\\mathbf{r}} = \\frac{\\mathbf{r}}{\\lVert \\mathbf{r} \\rVert}, \\quad k = 1,$$\n  其中 $k$ 是一个无量纲比例常数，此处设为 $k=1$，这样当距离单位为 $\\mathrm{\\AA}$ 时，数值输出的单位直接就是 $\\mathrm{ppm}$。\n- 用于构型指定的Mosher符号图基于以下差值：\n  $$\\Delta\\delta_{S-R}(\\mathbf{r}) = \\delta_S(\\mathbf{r}) - \\delta_R(\\mathbf{r}).$$\n  这个符号编码了一种象限类型的预测：正的 $\\Delta\\delta_{S-R}$ 与负的 $\\Delta\\delta_{S-R}$ 分别对应于助剂周围空间中各向异性显著不同的区域，这与Mosher象限规则类似。因为 $\\mathbf{A}_{\\text{C=O}}$ 在 $S$ 和 $R$ 两种构型中是相同的，所以其贡献在差值中被抵消了。\n\n角度单位要求：\n- 所有旋转角度均以度为单位。您的实现必须能正确处理度，必要时在内部将其转换为弧度。\n\n单位要求：\n- 输入位置的单位为埃（$\\mathrm{\\AA}$）。\n- 输出的化学位移差值必须以百万分率（$\\mathrm{ppm}$）为单位。\n\n测试组：\n为以下探针位置计算 $\\Delta\\delta_{S-R}(\\mathbf{r})$，每个位置均以埃为单位的笛卡尔三元组形式给出：\n1) $\\mathbf{r}_1 = [1, 0, 0]$\n2) $\\mathbf{r}_2 = [0, 1, 0]$\n3) $\\mathbf{r}_3 = [0, 0, 1]$\n4) $\\mathbf{r}_4 = [1, 1, 0]$\n5) $\\mathbf{r}_5 = [10, 0, 0]$\n\n答案规格：\n- 对于每个测试向量 $\\mathbf{r}_i$，计算以 $\\mathrm{ppm}$ 为单位的浮点数 $\\Delta\\delta_{S-R}(\\mathbf{r}_i)$。\n- 将每个结果四舍五入到六位小数。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。例如，如果有三个结果 $x_1, x_2, x_3$，输出将是“[x1,x2,x3]”。对于本问题，输出“[d1,d2,d3,d4,d5]”，其中 $d_i$ 是对应于上述测试组的、四舍五入到六位小数的以 $\\mathrm{ppm}$ 为单位的浮点数。", "solution": "问题陈述已经过严格验证，并被认为是有效的。它在科学上植根于核磁共振（NMR）波谱学的原理，特别是用于各向异性诱导化学位移的点偶极子近似。该问题是适定的，为获得唯一且稳定的解提供了所有必需的常数、方程和条件。术语精确客观，设置内部一致，没有事实或数学错误。\n\n任务是为一组探针位置 $\\mathbf{r}$ 计算 $(S)$- 和 $(R)$-Mosher酯之间的化学位移差 $\\Delta\\delta_{S-R}(\\mathbf{r})$。对于给定的构型 $X \\in \\{S,R\\}$，化学位移定义为：\n$$ \\delta_X(\\mathbf{r}) = k \\frac{\\hat{\\mathbf{r}}^{\\mathsf{T}} \\left(\\mathbf{A}_{\\text{ring},X} + \\mathbf{A}_{\\text{C=O}}\\right) \\hat{\\mathbf{r}}}{\\lVert \\mathbf{r} \\rVert^3} $$\n其中 $k=1$ 是一个无量纲常数，$\\mathbf{r}$ 是位置矢量，$\\hat{\\mathbf{r}} = \\mathbf{r}/\\lVert \\mathbf{r} \\rVert$ 是相应的单位矢量，$\\mathbf{A}_{\\text{C=O}}$ 是羰基的各向异性张量，$\\mathbf{A}_{\\text{ring},X}$ 是芳香环在实验室坐标系中的各向异性张量。\n\n我们感兴趣的量是差值：\n$$ \\Delta\\delta_{S-R}(\\mathbf{r}) = \\delta_S(\\mathbf{r}) - \\delta_R(\\mathbf{r}) $$\n代入 $\\delta_X(\\mathbf{r})$ 的表达式：\n$$ \\Delta\\delta_{S-R}(\\mathbf{r}) = k \\frac{\\hat{\\mathbf{r}}^{\\mathsf{T}} \\left(\\mathbf{A}_{\\text{ring},S} + \\mathbf{A}_{\\text{C=O}}\\right) \\hat{\\mathbf{r}}}{\\lVert \\mathbf{r} \\rVert^3} - k \\frac{\\hat{\\mathbf{r}}^{\\mathsf{T}} \\left(\\mathbf{A}_{\\text{ring},R} + \\mathbf{A}_{\\text{C=O}}\\right) \\hat{\\mathbf{r}}}{\\lVert \\mathbf{r} \\rVert^3} $$\n由于涉及羰基张量 $\\mathbf{A}_{\\text{C=O}}$ 的项对于两种构型是相同的，因此它被抵消了。这种简化是Mosher方法符号分析的核心。\n$$ \\Delta\\delta_{S-R}(\\mathbf{r}) = k \\frac{\\hat{\\mathbf{r}}^{\\mathsf{T}} \\left(\\mathbf{A}_{\\text{ring},S} - \\mathbf{A}_{\\text{ring},R}\\right) \\hat{\\mathbf{r}}}{\\lVert \\mathbf{r} \\rVert^3} $$\n定义差分张量 $\\Delta\\mathbf{A} = \\mathbf{A}_{\\text{ring},S} - \\mathbf{A}_{\\text{ring},R}$，并代入 $\\hat{\\mathbf{r}} = \\mathbf{r}/\\lVert \\mathbf{r} \\rVert$ 和 $k=1$，我们得到最终的计算公式：\n$$ \\Delta\\delta_{S-R}(\\mathbf{r}) = \\frac{\\mathbf{r}^{\\mathsf{T}} (\\Delta\\mathbf{A}) \\mathbf{r}}{\\lVert \\mathbf{r} \\rVert^5} $$\n单位是一致的：$\\mathbf{A}$ 的单位是 $\\mathrm{ppm}\\cdot\\mathrm{\\AA}^3$，$\\mathbf{r}$ 的单位是 $\\mathrm{\\AA}$，所以 $\\mathbf{r}^{\\mathsf{T}} \\Delta\\mathbf{A} \\mathbf{r}$ 的单位是 $\\mathrm{ppm}\\cdot\\mathrm{\\AA}^5$，而 $\\lVert \\mathbf{r} \\rVert^5$ 的单位是 $\\mathrm{\\AA}^5$，最终得到的结果单位是 $\\mathrm{ppm}$。\n\n步骤如下：\n1.  定义芳香环在其主轴标架中的初始各向异性张量：\n    $$ \\mathbf{A}_{\\text{ring}}' = \\mathrm{diag}(8, 2, -10) = \\begin{pmatrix} 8  0  0 \\\\ 0  2  0 \\\\ 0  0  -10 \\end{pmatrix} $$\n2.  定义旋转矩阵。绕 $y$ 轴旋转角度 $\\theta$ 的矩阵是：\n    $$ \\mathbf{R}_y(\\theta) = \\begin{pmatrix} \\cos\\theta  0  \\sin\\theta \\\\ 0  1  0 \\\\ -\\sin\\theta  0  \\cos\\theta \\end{pmatrix} $$\n    绕 $z$ 轴旋转角度 $\\phi$ 的矩阵是：\n    $$ \\mathbf{R}_z(\\phi) = \\begin{pmatrix} \\cos\\phi  -\\sin\\phi  0 \\\\ \\sin\\phi  \\cos\\phi  0 \\\\ 0  0  1 \\end{pmatrix} $$\n    所有输入的角度都以度为单位，必须转换为弧度以用于三角函数。\n3.  构建旋转矩阵 $\\mathbf{R}_S$ 和 $\\mathbf{R}_R$。\n    对于 $(S)$-酯，旋转角度为 $\\theta = 45^\\circ = \\pi/4$ 弧度。\n    $$ \\mathbf{R}_S = \\mathbf{R}_y(45^\\circ) = \\begin{pmatrix} \\cos(45^\\circ)  0  \\sin(45^\\circ) \\\\ 0  1  0 \\\\ -\\sin(45^\\circ)  0  \\cos(45^\\circ) \\end{pmatrix} = \\begin{pmatrix} 1/\\sqrt{2}  0  1/\\sqrt{2} \\\\ 0  1  0 \\\\ -1/\\sqrt{2}  0  1/\\sqrt{2} \\end{pmatrix} $$\n    对于 $(R)$-酯，旋转是一个复合旋转 $\\mathbf{R}_R = \\mathbf{R}_z(90^\\circ)\\mathbf{R}_S$，其中 $\\phi = 90^\\circ = \\pi/2$ 弧度。\n    $$ \\mathbf{R}_R = \\begin{pmatrix} \\cos(90^\\circ)  -\\sin(90^\\circ)  0 \\\\ \\sin(90^\\circ)  \\cos(90^\\circ)  0 \\\\ 0  0  1 \\end{pmatrix} \\mathbf{R}_S = \\begin{pmatrix} 0  -1  0 \\\\ 1  0  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} 1/\\sqrt{2}  0  1/\\sqrt{2} \\\\ 0  1  0 \\\\ -1/\\sqrt{2}  0  1/\\sqrt{2} \\end{pmatrix} = \\begin{pmatrix} 0  -1  0 \\\\ 1/\\sqrt{2}  0  1/\\sqrt{2} \\\\ -1/\\sqrt{2}  0  1/\\sqrt{2} \\end{pmatrix} $$\n4.  使用 $\\mathbf{A}_{\\text{ring},X} = \\mathbf{R}_X \\mathbf{A}_{\\text{ring}}' \\mathbf{R}_X^{\\mathsf{T}}$ 计算变换后的张量 $\\mathbf{A}_{\\text{ring},S}$ 和 $\\mathbf{A}_{\\text{ring},R}$。\n    $$ \\mathbf{A}_{\\text{ring},S} = \\begin{pmatrix} -1  0  -9 \\\\ 0  2  0 \\\\ -9  0  -1 \\end{pmatrix}, \\quad \\mathbf{A}_{\\text{ring},R} = \\begin{pmatrix} 2  0  0 \\\\ 0  -1  -9 \\\\ 0  -9  -1 \\end{pmatrix} $$\n5.  计算差分张量 $\\Delta\\mathbf{A}$。\n    $$ \\Delta\\mathbf{A} = \\mathbf{A}_{\\text{ring},S} - \\mathbf{A}_{\\text{ring},R} = \\begin{pmatrix} -3  0  -9 \\\\ 0  3  9 \\\\ -9  9  0 \\end{pmatrix} $$\n6.  对于每个测试向量 $\\mathbf{r}_i$，计算 $\\Delta\\delta_{S-R}(\\mathbf{r}_i) = \\frac{\\mathbf{r}_i^{\\mathsf{T}} (\\Delta\\mathbf{A}) \\mathbf{r}_i}{\\lVert \\mathbf{r}_i \\rVert^5}$。\n\n测试用例计算：\n\n1)  $\\mathbf{r}_1 = [1, 0, 0]^{\\mathsf{T}}$。 $\\lVert \\mathbf{r}_1 \\rVert = 1$。\n    $\\mathbf{r}_1^{\\mathsf{T}} \\Delta\\mathbf{A} \\mathbf{r}_1 = (\\Delta\\mathbf{A})_{11} = -3$。\n    $\\Delta\\delta_{S-R}(\\mathbf{r}_1) = -3 / 1^5 = -3.0$。\n\n2)  $\\mathbf{r}_2 = [0, 1, 0]^{\\mathsf{T}}$。 $\\lVert \\mathbfr_2 \\rVert = 1$。\n    $\\mathbf{r}_2^{\\mathsf{T}} \\Delta\\mathbf{A} \\mathbf{r}_2 = (\\Delta\\mathbf{A})_{22} = 3$。\n    $\\Delta\\delta_{S-R}(\\mathbf{r}_2) = 3 / 1^5 = 3.0$。\n\n3)  $\\mathbf{r}_3 = [0, 0, 1]^{\\mathsf{T}}$。 $\\lVert \\mathbf{r}_3 \\rVert = 1$。\n    $\\mathbf{r}_3^{\\mathsf{T}} \\Delta\\mathbf{A} \\mathbf{r}_3 = (\\Delta\\mathbf{A})_{33} = 0$。\n    $\\Delta\\delta_{S-R}(\\mathbf{r}_3) = 0 / 1^5 = 0.0$。\n\n4)  $\\mathbf{r}_4 = [1, 1, 0]^{\\mathsf{T}}$。 $\\lVert \\mathbf{r}_4 \\rVert = \\sqrt{1^2+1^2} = \\sqrt{2}$。\n    $\\mathbf{r}_4^{\\mathsf{T}} \\Delta\\mathbf{A} \\mathbf{r}_4 = (\\Delta\\mathbf{A})_{11}(1)^2 + (\\Delta\\mathbf{A})_{22}(1)^2 + 2(\\Delta\\mathbf{A})_{12}(1)(1) = -3 + 3 + 2(0) = 0$。\n    $\\Delta\\delta_{S-R}(\\mathbf{r}_4) = 0 / (\\sqrt{2})^5 = 0.0$。\n\n5)  $\\mathbf{r}_5 = [10, 0, 0]^{\\mathsf{T}}$。 $\\lVert \\mathbf{r}_5 \\rVert = 10$。\n    此向量为 $10\\mathbf{r}_1$。屏蔽效应按 $1/r^3$ 比例缩放，因此差值按 $1/c^3$ 比例缩放，其中 $c$ 是缩放因子。\n    或者，使用完整公式：\n    $\\mathbf{r}_5^{\\mathsf{T}} \\Delta\\mathbf{A} \\mathbf{r}_5 = (\\Delta\\mathbf{A})_{11}(10)^2 = -3 \\times 100 = -300$。\n    $\\lVert \\mathbf{r}_5 \\rVert^5 = 10^5 = 100000$。\n    $\\Delta\\delta_{S-R}(\\mathbf{r}_5) = -300 / 100000 = -0.003$。\n\n最终结果，四舍五入到六位小数，如下所示：\n- $d_1 = -3.000000$\n- $d_2 = 3.000000$\n- $d_3 = 0.000000$\n- $d_4 = 0.000000$\n- $d_5 = -0.003000$", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the anisotropy-induced chemical shift difference Δδ(S-R)\n    for a set of probe positions based on the Mosher ester model.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each position r is given in ångström.\n    test_cases = [\n        [1, 0, 0],\n        [0, 1, 0],\n        [0, 0, 1],\n        [1, 1, 0],\n        [10, 0, 0],\n    ]\n\n    # 1. Define the initial anisotropy tensor for the aromatic ring in its\n    # principal-axis frame (units: ppm·Å^3).\n    A_ring_prime = np.diag([8.0, 2.0, -10.0])\n\n    # 2. Define rotation matrices. Angles are given in degrees, convert to radians.\n    theta_S_deg = 45.0\n    phi_R_deg = 90.0\n    theta_S_rad = np.deg2rad(theta_S_deg)\n    phi_R_rad = np.deg2rad(phi_R_deg)\n\n    # Rotation about y-axis for (S)-ester\n    c_s, s_s = np.cos(theta_S_rad), np.sin(theta_S_rad)\n    R_y_45 = np.array([\n        [c_s, 0, s_s],\n        [0, 1, 0],\n        [-s_s, 0, c_s]\n    ])\n\n    # Rotation about z-axis for the (R) vs (S) relation\n    c_r, s_r = np.cos(phi_R_rad), np.sin(phi_R_rad)\n    R_z_90 = np.array([\n        [c_r, -s_r, 0],\n        [s_r, c_r, 0],\n        [0, 0, 1]\n    ])\n\n    # 3. Construct the full rotation matrices for (S) and (R) configurations.\n    R_S = R_y_45\n    R_R = R_z_90 @ R_S\n\n    # 4. Transform the ring anisotropy tensor into the laboratory frame for each configuration.\n    # A_ring,X = R_X @ A_ring_prime @ R_X.T\n    A_ring_S = R_S @ A_ring_prime @ R_S.T\n    A_ring_R = R_R @ A_ring_prime @ R_R.T\n\n    # 5. Compute the difference tensor ΔA. The contribution from A_C=O cancels.\n    delta_A = A_ring_S - A_ring_R\n    \n    results = []\n    # 6. Iterate through test cases and calculate Δδ(S-R)\n    for r_list in test_cases:\n        r = np.array(r_list, dtype=np.float64)\n        \n        # Calculate the norm of the position vector\n        r_norm = np.linalg.norm(r)\n\n        # The formula is Δδ = (r^T * ΔA * r) / ||r||^5\n        if r_norm == 0:\n            # Shielding is undefined at the origin, but not a test case.\n            # Assign 0 for robustness.\n            delta_delta = 0.0\n        else:\n            # Numerator of the shielding equation\n            numerator = r.T @ delta_A @ r\n            \n            # Denominator: norm to the power of 5\n            denominator = r_norm**5\n            \n            # Calculate the chemical shift difference in ppm\n            delta_delta = numerator / denominator\n\n        # Round to six decimal places as per specification\n        results.append(round(delta_delta, 6))\n\n    # Format the final print statement as required.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3713895"}]}