{"hands_on_practices": [{"introduction": "我们从一个直接的动手计算开始。这个练习将广义逆的抽象概念置于具体的计算之中。通过为一个非方阵计算其伪逆的弗罗贝尼乌斯范数（Frobenius norm），学生可以练习使用奇异值来分析广义逆性质的基本方法，这项技能是解决更复杂反演问题的先决条件。[@problem_id:1071434]", "problem": "设 $k$ 是一个实数。考虑 $3 \\times 2$ 矩阵\n$$  \nA = \\begin{pmatrix}  \n1  k \\\\  \n1  0 \\\\  \n0  1  \n\\end{pmatrix}.  \n$$  \n使用奇异值分解，计算 $A$ 的 Moore-Penrose 伪逆 $A^+$，然后求 $A^+$ 的 Frobenius 范数。将最终答案用含 $k$ 的表达式表示。", "solution": "$A^+$ 的 Frobenius 范数由 $A$ 的奇异值得出。$A$ 的奇异值 $\\sigma_i$ 是 $A^T A$ 的特征值的平方根。\n\n首先，计算 $A^T A$：\n$$  \nA^T A = \\begin{pmatrix}  \n1  1  0 \\\\  \nk  0  1  \n\\end{pmatrix}  \n\\begin{pmatrix}  \n1  k \\\\  \n1  0 \\\\  \n0  1  \n\\end{pmatrix}  \n= \\begin{pmatrix}  \n1 \\cdot 1 + 1 \\cdot 1 + 0 \\cdot 0   1 \\cdot k + 1 \\cdot 0 + 0 \\cdot 1 \\\\  \nk \\cdot 1 + 0 \\cdot 1 + 1 \\cdot 0   k \\cdot k + 0 \\cdot 0 + 1 \\cdot 1  \n\\end{pmatrix}  \n= \\begin{pmatrix}  \n2   k \\\\  \nk   k^2 + 1  \n\\end{pmatrix}.  \n$$  \n\n$A^T A$ 的特征值 $\\lambda$ 满足 $\\det(A^T A - \\lambda I) = 0$：\n$$  \n\\det \\begin{pmatrix}  \n2 - \\lambda   k \\\\  \nk   k^2 + 1 - \\lambda  \n\\end{pmatrix}  \n= (2 - \\lambda)(k^2 + 1 - \\lambda) - k^2 = \\lambda^2 - (k^2 + 3)\\lambda + (k^2 + 2).  \n$$  \n解这个二次方程：\n$$  \n\\lambda = \\frac{k^2 + 3 \\pm \\sqrt{(k^2 + 3)^2 - 4(k^2 + 2)}}{2} = \\frac{k^2 + 3 \\pm \\sqrt{k^4 + 6k^2 + 9 - 4k^2 - 8}}{2} = \\frac{k^2 + 3 \\pm \\sqrt{k^4 + 2k^2 + 1}}{2}.  \n$$  \n判别式化简为 $(k^2 + 1)^2$，所以：\n$$  \n\\lambda = \\frac{k^2 + 3 \\pm (k^2 + 1)}{2}.  \n$$  \n因此，特征值为：\n$$  \n\\lambda_1 = \\frac{k^2 + 3 + k^2 + 1}{2} = k^2 + 2, \\quad \\lambda_2 = \\frac{k^2 + 3 - k^2 - 1}{2} = 1.  \n$$  \n$A$ 的奇异值为 $\\sigma_1 = \\sqrt{\\lambda_1} = \\sqrt{k^2 + 2}$ 和 $\\sigma_2 = \\sqrt{\\lambda_2} = 1$。\n\nMoore-Penrose 伪逆 $A^+$ 的奇异值为 $\\sigma_i^+ = \\frac{1}{\\sigma_i}$ (对于非零的 $\\sigma_i$）。$A^+$ 的 Frobenius 范数 $\\|A^+\\|_F$ 是其奇异值平方和的平方根：\n$$  \n\\|A^+\\|_F = \\sqrt{ \\left( \\frac{1}{\\sigma_1} \\right)^2 + \\left( \\frac{1}{\\sigma_2} \\right)^2 } = \\sqrt{ \\frac{1}{k^2 + 2} + 1 } = \\sqrt{ \\frac{1 + k^2 + 2}{k^2 + 2} } = \\sqrt{ \\frac{k^2 + 3}{k^2 + 2} }.  \n$$  \n这是因为 Frobenius 范数在正交变换下是不变的，且 $A^+$ 与 $A$ 的奇异值分解共享相同的正交因子，所以其范数等于其奇异值矩阵的范数。", "answer": "$$  \n\\boxed{ \\sqrt{ \\frac{k^{2} + 3}{k^{2} + 2} } }  \n$$", "id": "1071434"}, {"introduction": "在超越简单计算之后，这个练习将深入探讨唯一确定Moore-Penrose伪逆的基本代数性质。通过使用SVD为一个特制的秩亏缺矩阵明确地验证Penrose恒等式，我们可以洞察为什么伪逆是“最佳”的线性逆。这个练习突显了SVD框架的稳健性，即使对于地球物理建模中常见的不适定系统也是如此。[@problem_id:3404364]", "problem": "考虑一个三维线性逆问题，其中观测值 $\\mathbf{y} \\in \\mathbb{R}^{3}$ 与状态 $\\mathbf{x} \\in \\mathbb{R}^{3}$ 通过 $\\mathbf{y} = A \\mathbf{x} + \\boldsymbol{\\varepsilon}$ 相关联，$\\boldsymbol{\\varepsilon}$ 表示观测误差。为了在摩尔-彭若斯伪逆的背景下研究秩亏和病态问题，请通过如下指定一个正交-对角-正交分解，构造一个秩为 $2$ 且具有高度病态非零谱的显式矩阵 $A \\in \\mathbb{R}^{3 \\times 3}$。\n\n令 $U \\in \\mathbb{R}^{3 \\times 3}$ 和 $V \\in \\mathbb{R}^{3 \\times 3}$ 为正交矩阵\n$$\nU \\;=\\; \\begin{pmatrix}\n\\frac{3}{5}  0  -\\frac{4}{5} \\\\\n0  1  0 \\\\\n\\frac{4}{5}  0  \\frac{3}{5}\n\\end{pmatrix},\n\\qquad\nV \\;=\\; \\begin{pmatrix}\n\\frac{5}{13}  -\\frac{12}{13}  0 \\\\\n\\frac{12}{13}  \\frac{5}{13}  0 \\\\\n0  0  1\n\\end{pmatrix},\n$$\n并令奇异值矩阵为\n$$\n\\Sigma \\;=\\; \\operatorname{diag}\\!\\big(3,\\, 10^{-3},\\, 0\\big).\n$$\n定义 $A$ 为 $A = U \\Sigma V^{\\top}$。仅使用通过奇异值分解（SVD）定义的摩尔-彭若斯伪逆，计算 $A^{\\dagger}$，并显式验证以下两个摩尔-彭若斯恒等式\n$$\nA A^{\\dagger} A \\;=\\; A,\n\\qquad\nA^{\\dagger} A A^{\\dagger} \\;=\\; A^{\\dagger}.\n$$\n然后，计算标量\n$$\nS \\;=\\; \\|A A^{\\dagger} A - A\\|_{F}^{2} \\;+\\; \\|A^{\\dagger} A A^{\\dagger} - A^{\\dagger}\\|_{F}^{2},\n$$\n其中 $\\|\\cdot\\|_{F}$ 表示弗罗贝尼乌斯范数。你的最终答案应为一个实数。无需四舍五入。", "solution": "该问题通过其奇异值分解（SVD）$A = U \\Sigma V^{\\top}$ 定义了一个矩阵 $A \\in \\mathbb{R}^{3 \\times 3}$，其中 $U$ 和 $V$ 是正交矩阵，$\\Sigma$ 是奇异值对角矩阵。给定的矩阵是：\n$$\nU = \\begin{pmatrix} \\frac{3}{5}  0  -\\frac{4}{5} \\\\ 0  1  0 \\\\ \\frac{4}{5}  0  \\frac{3}{5} \\end{pmatrix}, \\quad V = \\begin{pmatrix} \\frac{5}{13}  -\\frac{12}{13}  0 \\\\ \\frac{12}{13}  \\frac{5}{13}  0 \\\\ 0  0  1 \\end{pmatrix}, \\quad \\Sigma = \\begin{pmatrix} 3  0  0 \\\\ 0  10^{-3}  0 \\\\ 0  0  0 \\end{pmatrix}.\n$$\n该问题要求完成三项任务：\n1. 使用通过SVD的定义计算摩尔-彭若斯伪逆 $A^{\\dagger}$。\n2. 显式验证恒等式 $A A^{\\dagger} A = A$ 和 $A^{\\dagger} A A^{\\dagger} = A^{\\dagger}$。\n3. 计算标量 $S = \\|A A^{\\dagger} A - A\\|_{F}^{2} + \\|A^{\\dagger} A A^{\\dagger} - A^{\\dagger}\\|_{F}^{2}$。\n\n首先，我们计算 $A^{\\dagger}$。由 $A = U \\Sigma V^{\\top}$ 的SVD定义的摩尔-彭若斯伪逆由 $A^{\\dagger} = V \\Sigma^{\\dagger} U^{\\top}$ 给出。\n矩阵 $\\Sigma^{\\dagger}$ 是通过对 $\\Sigma$ 中的非零奇异值取倒数，并保持零不变得到的。\n给定 $\\Sigma = \\operatorname{diag}(3, 10^{-3}, 0)$，伪逆 $\\Sigma^{\\dagger}$ 是：\n$$\n\\Sigma^{\\dagger} = \\operatorname{diag}\\left(\\frac{1}{3}, \\frac{1}{10^{-3}}, 0\\right) = \\operatorname{diag}\\left(\\frac{1}{3}, 1000, 0\\right) = \\begin{pmatrix} \\frac{1}{3}  0  0 \\\\ 0  1000  0 \\\\ 0  0  0 \\end{pmatrix}.\n$$\n我们可以计算出 $A^{\\dagger}$ 的显式形式为：\n$$\nA^{\\dagger} = V \\Sigma^{\\dagger} U^{\\top} = \\begin{pmatrix} \\frac{1}{13}   -\\frac{12000}{13}   \\frac{4}{39} \\\\ \\frac{12}{65}   \\frac{5000}{13}   \\frac{16}{65} \\\\ 0   0   0 \\end{pmatrix}.\n$$\n其次，我们验证这两个摩尔-彭若斯恒等式。最直接的方法是使用SVD的定义。\n验证 $A A^{\\dagger} A = A$：\n代入 $A$ 和 $A^{\\dagger}$ 的SVD表达式：\n$$\nA A^{\\dagger} A = (U \\Sigma V^{\\top}) (V \\Sigma^{\\dagger} U^{\\top}) (U \\Sigma V^{\\top}).\n$$\n由于 $V$ 是一个正交矩阵，所以 $V^{\\top}V = I$，其中 $I$ 是单位矩阵。类似地，$U^{\\top}U = I$。\n$$\nA A^{\\dagger} A = U \\Sigma (V^{\\top}V) \\Sigma^{\\dagger} (U^{\\top}U) \\Sigma V^{\\top} = U \\Sigma I \\Sigma^{\\dagger} I \\Sigma V^{\\top} = U (\\Sigma \\Sigma^{\\dagger} \\Sigma) V^{\\top}.\n$$\n我们计算乘积 $\\Sigma \\Sigma^{\\dagger} \\Sigma$：\n$$\n\\Sigma \\Sigma^{\\dagger} = \\begin{pmatrix} 3  0  0 \\\\ 0  10^{-3}  0 \\\\ 0  0  0 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{3}  0  0 \\\\ 0  1000  0 \\\\ 0  0  0 \\end{pmatrix} = \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  0 \\end{pmatrix}.\n$$\n那么，\n$$\n(\\Sigma \\Sigma^{\\dagger}) \\Sigma = \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  0 \\end{pmatrix} \\begin{pmatrix} 3  0  0 \\\\ 0  10^{-3}  0 \\\\ 0  0  0 \\end{pmatrix} = \\begin{pmatrix} 3  0  0 \\\\ 0  10^{-3}  0 \\\\ 0  0  0 \\end{pmatrix} = \\Sigma.\n$$\n因此，我们有 $A A^{\\dagger} A = U \\Sigma V^{\\top} = A$。第一个恒等式得到验证。\n\n验证 $A^{\\dagger} A A^{\\dagger} = A^{\\dagger}$：\n再次代入SVD表达式：\n$$\nA^{\\dagger} A A^{\\dagger} = (V \\Sigma^{\\dagger} U^{\\top}) (U \\Sigma V^{\\top}) (V \\Sigma^{\\dagger} U^{\\top}).\n$$\n使用 $U^{\\top}U = I$ 和 $V^{\\top}V = I$：\n$$\nA^{\\dagger} A A^{\\dagger} = V \\Sigma^{\\dagger} (U^{\\top}U) \\Sigma (V^{\\top}V) \\Sigma^{\\dagger} U^{\\top} = V \\Sigma^{\\dagger} I \\Sigma I \\Sigma^{\\dagger} U^{\\top} = V (\\Sigma^{\\dagger} \\Sigma \\Sigma^{\\dagger}) U^{\\top}.\n$$\n我们计算乘积 $\\Sigma^{\\dagger} \\Sigma \\Sigma^{\\dagger}$：\n$$\n\\Sigma^{\\dagger} \\Sigma = \\begin{pmatrix} \\frac{1}{3}  0  0 \\\\ 0  1000  0 \\\\ 0  0  0 \\end{pmatrix} \\begin{pmatrix} 3  0  0 \\\\ 0  10^{-3}  0 \\\\ 0  0  0 \\end{pmatrix} = \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  0 \\end{pmatrix}.\n$$\n那么，\n$$\n(\\Sigma^{\\dagger} \\Sigma) \\Sigma^{\\dagger} = \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  0 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{3}  0  0 \\\\ 0  1000  0 \\\\ 0  0  0 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{3}  0  0 \\\\ 0  1000  0 \\\\ 0  0  0 \\end{pmatrix} = \\Sigma^{\\dagger}.\n$$\n因此，我们有 $A^{\\dagger} A A^{\\dagger} = V \\Sigma^{\\dagger} U^{\\top} = A^{\\dagger}$。第二个恒等式得到验证。\n\n第三，我们计算标量 $S = \\|A A^{\\dagger} A - A\\|_{F}^{2} + \\|A^{\\dagger} A A^{\\dagger} - A^{\\dagger}\\|_{F}^{2}$。\n从我们的显式验证中，我们已经证明了：\n$$\nA A^{\\dagger} A - A = \\mathbf{0},\n$$\n其中 $\\mathbf{0}$ 是 $3 \\times 3$ 的零矩阵。\n并且，\n$$\nA^{\\dagger} A A^{\\dagger} - A^{\\dagger} = \\mathbf{0}.\n$$\n矩阵 $M$ 的弗罗贝尼乌斯范数，记作 $\\|M\\|_{F}$，是其所有元素平方和的平方根。零矩阵的弗罗贝尼乌斯范数为 $0$。\n因此，\n$$\n\\|A A^{\\dagger} A - A\\|_{F}^{2} = \\|\\mathbf{0}\\|_{F}^{2} = 0^{2} = 0.\n$$\n$$\n\\|A^{\\dagger} A A^{\\dagger} - A^{\\dagger}\\|_{F}^{2} = \\|\\mathbf{0}\\|_{F}^{2} = 0^{2} = 0.\n$$\n将这些结果代入 $S$ 的表达式中：\n$$\nS = 0 + 0 = 0.\n$$\n标量 $S$ 的值为 $0$。这个结果是摩尔-彭若斯伪逆根据定义必须满足这两个彭若斯条件这一事实的直接推论。矩阵 $A$ 的病态性和具体结构是背景信息，但它们不会改变这个基本的代数性质。", "answer": "$$\\boxed{0}$$", "id": "3404364"}, {"introduction": "我们最后的练习将我们的理解应用于地球物理学中的一个核心挑战：评估反演模型的可靠性。我们推导并实现模型分辨率矩阵（model resolution matrix）和点扩散函数（point-spread function）的概念，它们是强大的工具，用于可视化我们的数据能够多好地解析模型的特定特征。这个练习展示了SVD和正则化技术如何让我们量化和解释在解决不适定反演问题中固有的模糊性和权衡。[@problem_id:3616758]", "problem": "考虑一个计算地球物理学中的线性正演映射，其中数据向量 $\\mathbf{d} \\in \\mathbb{R}^{n_d}$ 和模型向量 $\\mathbf{m} \\in \\mathbb{R}^{n_m}$ 之间的关系为 $\\mathbf{d} = G \\mathbf{m}$，而已知 $G \\in \\mathbb{R}^{n_d \\times n_m}$。令 $G$ 的奇异值分解（SVD）为 $G = U \\Sigma V^{\\mathsf{T}}$，其中 $U \\in \\mathbb{R}^{n_d \\times n_d}$ 和 $V \\in \\mathbb{R}^{n_m \\times n_m}$ 是正交矩阵，$\\Sigma \\in \\mathbb{R}^{n_d \\times n_m}$ 在其主对角线上包含非负奇异值。此处的广义逆应理解为 Moore–Penrose 伪逆及其正则化变体，这些变体在满足数据拟合的条件下最小化 $2$-范数。模型分辨率矩阵定义为 $R \\in \\mathbb{R}^{n_m \\times n_m}$，它量化了真实模型参数如何映射到估计模型中。\n\n您的任务是从这些定义以及正交投影和最小二乘解的基本性质出发，推导单个模型参数的点扩散函数（也称为分辨率核）的表达式。具体而言：\n\n1. 仅使用上述基本定义（$G$的SVD、 $U$ 和 $V$ 的正交性、Moore–Penrose 伪逆的特征以及标准二次正则化），为以下估计器推导模型分辨率矩阵 $R$ 作为奇异值和奇异向量的函数的表达式：\n   - 对应于 Moore–Penrose 伪逆的无阻尼最小二乘估计器。\n   - 截断 SVD 估计器，仅保留最大的 $k$ 个奇异值。\n   - 阻尼参数为 $\\lambda  0$ 的零阶 Tikhonov 阻尼最小二乘估计器。\n2. 令 $\\mathbf{e}_j \\in \\mathbb{R}^{n_m}$ 表示单位基向量，其在索引 $j$ 处为 1，其他位置为 0（在任何计算中对 $j$ 使用从零开始的索引约定）。将索引 $j$ 的点扩散函数定义为 $\\mathbf{r}^{(j)} = R \\mathbf{e}_j$。通过依赖于估计器是无阻尼、截断还是阻尼的系数，推导 $\\mathbf{r}^{(j)}$ 对 $G$ 的右奇异向量和奇异值的函数依赖关系。定性解释右奇异向量如何在估计模型中对 $\\mathbf{e}_j$ 的扩散进行加权。\n\n然后，实现一个程序，对于指定的 $G$ 和估计器选项，使用 SVD 计算 $\\mathbf{r}^{(j)}$。将 $G$ 构建为一个一维网格上的高斯模糊算子，网格大小为 $n$，其元素为\n$$\nG_{pq} = \\exp\\!\\left(-\\frac{(p - q)^2}{2 s^2}\\right), \\quad p, q \\in \\{0, 1, \\dots, n-1\\},\n$$\n并将 $G$ 的列归一化为单位 $2$-范数，以避免奇异谱中出现无关紧要的缩放效应。使用 $n_d = n_m = n$，其中 $n = 20$，并根据每个测试用例指定 $s$。\n\n对于每个测试用例，计算 $G$ 的 SVD，构建由估计器所隐含的分辨率矩阵 $R$，计算点扩散函数 $\\mathbf{r}^{(j)} = R \\mathbf{e}_j$，然后返回：\n- 完整向量 $\\mathbf{r}^{(j)}$。\n- 非对角 1-范数质量，定义为 $\\sum_{i=0}^{n-1} \\left| r^{(j)}_i \\right| - \\left| r^{(j)}_j \\right|$。\n- $\\mathbf{r}^{(j)}$ 绝对值最大分量的索引（从零开始），即 $\\arg\\max_i \\left| r^{(j)}_i \\right|$。\n\n不涉及物理单位；所有量纲均为无量纲。不使用角度。没有百分比。\n\n测试套件：\n使用 $n = 20$ 并通过以下参数集构建高斯模糊矩阵 $G$。每个测试用例是一个三元组，指定了估计器类型、其参数以及索引 $j$：\n- 情况 1：无阻尼伪逆，$s = 1.25$，$j = 10$。\n- 情况 2：截断 SVD，保留 $k = 8$ 个奇异值，$s = 1.25$，$j = 10$。\n- 情况 3：零阶 Tikhonov 阻尼，$\\lambda = 0.25$，$s = 1.25$，$j = 3$。\n- 情况 4：零阶 Tikhonov 阻尼，$\\lambda = 1.00$，$s = 1.25$，$j = 17$。\n\n最终输出格式：\n您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表。每个测试用例的结果本身必须是一个包含三个要求项目的列表 $[\\mathbf{r}^{(j)}, \\text{off\\_diag\\_mass}, \\text{argmax\\_index}]$，其中 $\\mathbf{r}^{(j)}$ 表示为浮点数的 Python 列表。例如，顶层输出将如下所示：\n$$\n[\\,[\\,[r_0,\\dots,r_{n-1}],\\,\\text{off\\_diag\\_mass},\\,\\text{argmax\\_index}\\,],\\; \\dots\\; ].\n$$", "solution": "问题的核心是针对不同的线性估计器，分析模型分辨率矩阵 $R$ 及相关的点扩散函数 (PSF)，以估计模型向量 $\\mathbf{m}$ 从数据向量 $\\mathbf{d}$ 出发，给定正演关系 $\\mathbf{d} = G \\mathbf{m}$。估计的模型 $\\mathbf{m}_{\\text{est}}$ 通过广义逆 $G_{\\text{gen}}$ 得到，即 $\\mathbf{m}_{\\text{est}} = G_{\\text{gen}} \\mathbf{d}$。代入真实关系，我们得到 $\\mathbf{m}_{\\text{est}} = G_{\\text{gen}} (G \\mathbf{m}_{\\text{true}})$。模型分辨率矩阵 $R$ 由从真实模型到估计模型的映射定义：$\\mathbf{m}_{\\text{est}} = R \\mathbf{m}_{\\text{true}}$。因此，分辨率矩阵由 $R = G_{\\text{gen}} G$ 给出。\n\n给定矩阵 $G \\in \\mathbb{R}^{n_d \\times n_m}$ 的奇异值分解 (SVD) 为 $G = U \\Sigma V^{\\mathsf{T}}$，其中 $U \\in \\mathbb{R}^{n_d \\times n_d}$ 和 $V \\in \\mathbb{R}^{n_m \\times n_m}$ 是正交矩阵，$\\Sigma \\in \\mathbb{R}^{n_d \\times n_m}$ 是一个矩形对角矩阵，其主对角线上有非负奇异值 $\\sigma_i$。$U$ 的列 $\\mathbf{u}_i$ 是左奇异向量，$V$ 的列 $\\mathbf{v}_i$ 是右奇异向量。对于本问题，$n_d = n_m = n$，因此所有矩阵都是 $n \\times n$ 的方阵。\n\n### 1. 模型分辨率矩阵 $R$ 的推导\n\n我们为三种不同的估计器推导 $R$ 的表达式。\n\n**a) 无阻尼最小二乘（Moore-Penrose 伪逆）**\n\n无阻尼最小二乘解最小化 $\\|G \\mathbf{m} - \\mathbf{d}\\|_2^2$。估计器为 $\\mathbf{m}_{\\text{est}} = G^{+} \\mathbf{d}$，其中 $G^{+}$ 是 Moore-Penrose 伪逆。因此，$G_{\\text{gen}} = G^{+}$。伪逆通过 SVD 定义为 $G^{+} = V \\Sigma^{+} U^{\\mathsf{T}}$。矩阵 $\\Sigma^{+}$ 是通过取 $\\Sigma$ 中非零奇异值的倒数并转置所得矩阵得到的。对于一个具有奇异值 $\\sigma_i$ 的方形 $n \\times n$ 矩阵 $\\Sigma$，矩阵 $\\Sigma^{+}$ 也是一个 $n \\times n$ 的对角矩阵，其元素为 $(\\Sigma^{+})_{ii} = 1/\\sigma_i$（如果 $\\sigma_i > 0$）和 $0$（如果 $\\sigma_i = 0$）。\n\n分辨率矩阵是 $R = G^{+} G$。\n$$\nR = (V \\Sigma^{+} U^{\\mathsf{T}}) (U \\Sigma V^{\\mathsf{T}}) = V \\Sigma^{+} (U^{\\mathsf{T}}U) \\Sigma V^{\\mathsf{T}}\n$$\n因为 $U$ 是一个正交矩阵，所以 $U^{\\mathsf{T}}U = I$（单位矩阵）。\n$$\nR = V (\\Sigma^{+} \\Sigma) V^{\\mathsf{T}}\n$$\n乘积 $\\Sigma^{+} \\Sigma$ 是一个对角矩阵。其对角线元素为 $(\\Sigma^{+} \\Sigma)_{ii} = (1/\\sigma_i) \\cdot \\sigma_i = 1$（如果 $\\sigma_i > 0$）和 $0$（如果 $\\sigma_i = 0$）。令 $r$ 为 $G$ 的秩（非零奇异值的数量）。则 $\\Sigma^{+} \\Sigma$ 是一个对角矩阵，其对角线上有 $r$ 个 1 和 $n-r$ 个 0。我们将此投影矩阵表示为 $I_r$。\n因此，无阻尼情况下的分辨率矩阵为：\n$$\nR = V I_r V^{\\mathsf{T}} = \\sum_{i=0}^{r-1} \\mathbf{v}_i \\mathbf{v}_i^{\\mathsf{T}}\n$$\n该矩阵表示到由前 $r$ 个右奇异向量张成的子空间上的正交投影。如果 $G$ 是满秩的（$r=n$），则 $I_r=I$ 且 $R = VIV^{\\mathsf{T}} = I$，意味着完美分辨率。\n\n**b) 截断 SVD (TSVD) 估计器**\n\nTSVD 估计器仅使用前 $k$ 个最大的奇异值，有效地滤除与放大噪声的小奇异值相关的分量。广义逆为 $G_k^{+} = V \\Sigma_k^{+} U^{\\mathsf{T}}$，其中 $(\\Sigma_k^{+})_{ii} = 1/\\sigma_i$ 对于 $i=0, \\dots, k-1$，其他情况下为 $0$。\n\n分辨率矩阵 $R_k$ 为：\n$$\nR_k = G_k^{+} G = (V \\Sigma_k^{+} U^{\\mathsf{T}}) (U \\Sigma V^{\\mathsf{T}}) = V (\\Sigma_k^{+} \\Sigma) V^{\\mathsf{T}}\n$$\n乘积 $\\Sigma_k^{+} \\Sigma$ 是一个对角矩阵 $I_k$，其前 $k$ 个对角位置为 1，其余为 0。\n$$\nR_k = V I_k V^{\\mathsf{T}} = \\sum_{i=0}^{k-1} \\mathbf{v}_i \\mathbf{v}_i^{\\mathsf{T}}\n$$\n这是到由前 $k$ 个右奇异向量张成的子空间上的正交投影。\n\n**c) 零阶 Tikhonov 阻尼最小二乘估计器**\n\n该估计器寻找模型 $\\mathbf{m}$，以最小化组合目标函数 $\\|G \\mathbf{m} - \\mathbf{d}\\|_2^2 + \\lambda^2 \\|\\mathbf{m}\\|_2^2$，其中 $\\lambda > 0$ 是阻尼参数。解由 $\\mathbf{m}_{\\text{est}} = (G^{\\mathsf{T}}G + \\lambda^2 I)^{-1} G^{\\mathsf{T}} \\mathbf{d}$ 给出。\n所以，$G_{\\text{gen}} = (G^{\\mathsf{T}}G + \\lambda^2 I)^{-1} G^{\\mathsf{T}}$。\n\n分辨率矩阵 $R_\\lambda$ 为：\n$$\nR_\\lambda = G_{\\text{gen}} G = (G^{\\mathsf{T}}G + \\lambda^2 I)^{-1} G^{\\mathsf{T}}G\n$$\n使用 SVD，我们代入 $G = U \\Sigma V^{\\mathsf{T}}$ 和 $G^{\\mathsf{T}} = V \\Sigma^{\\mathsf{T}} U^{\\mathsf{T}}$。在我们的方阵情况下，$\\Sigma$ 是对角阵且 $\\Sigma^{\\mathsf{T}} = \\Sigma$。\n$$\nG^{\\mathsf{T}}G = (V \\Sigma U^{\\mathsf{T}})(U \\Sigma V^{\\mathsf{T}}) = V \\Sigma^2 V^{\\mathsf{T}}\n$$\n将此代入 $R_\\lambda$ 的表达式中：\n$$\nR_\\lambda = (V \\Sigma^2 V^{\\mathsf{T}} + \\lambda^2 I)^{-1} (V \\Sigma^2 V^{\\mathsf{T}})\n$$\n使用 $I = VIV^{\\mathsf{T}}$，我们可以分解出 $V$ 和 $V^{\\mathsf{T}}$：\n$$\nR_\\lambda = (V (\\Sigma^2 + \\lambda^2 I) V^{\\mathsf{T}})^{-1} (V \\Sigma^2 V^{\\mathsf{T}}) = V (\\Sigma^2 + \\lambda^2 I)^{-1} V^{\\mathsf{T}} V \\Sigma^2 V^{\\mathsf{T}}\n$$\n由于 $V^{\\mathsf{T}}V = I$：\n$$\nR_\\lambda = V \\left[ (\\Sigma^2 + \\lambda^2 I)^{-1} \\Sigma^2 \\right] V^{\\mathsf{T}}\n$$\n方括号中的项是一个对角矩阵，我们称之为 $F_\\lambda$，其对角线元素是滤波因子 $f_i = \\frac{\\sigma_i^2}{\\sigma_i^2 + \\lambda^2}$。\n因此，Tikhonov 分辨率矩阵为：\n$$\nR_\\lambda = V F_\\lambda V^{\\mathsf{T}} = \\sum_{i=0}^{n-1} \\frac{\\sigma_i^2}{\\sigma_i^2 + \\lambda^2} \\mathbf{v}_i \\mathbf{v}_i^{\\mathsf{T}}\n$$\n\n### 2. 点扩散函数 (PSF) 的推导与解释\n\n第 $j$ 个模型参数的点扩散函数 (PSF) $\\mathbf{r}^{(j)}$ 定义为估计器对该参数处真实模型中的一个脉冲的响应，即 $\\mathbf{m}_{\\text{true}} = \\mathbf{e}_j$，其中 $\\mathbf{e}_j$ 是第 $j$ 个标准基向量。\n$$\n\\mathbf{r}^{(j)} = R \\mathbf{e}_j\n$$\n这正是分辨率矩阵 $R$ 的第 $j$ 列。\n\n所有三种推导出的分辨率矩阵都可以写成一般形式 $R = \\sum_{i=0}^{n-1} d_i \\mathbf{v}_i \\mathbf{v}_i^{\\mathsf{T}}$，其中 $d_i$ 是特定于每个估计器的滤波因子。\n-   无阻尼：如果 $\\sigma_i > 0$，则 $d_i = 1$，否则为 $0$。\n-   TSVD：对于 $i=0, \\dots, k-1$，$d_i = 1$，否则为 $0$。\n-   Tikhonov：$d_i = \\frac{\\sigma_i^2}{\\sigma_i^2 + \\lambda^2}$。\n\n我们来推导 $\\mathbf{r}^{(j)}$ 的表达式：\n$$\n\\mathbf{r}^{(j)} = \\left( \\sum_{i=0}^{n-1} d_i \\mathbf{v}_i \\mathbf{v}_i^{\\mathsf{T}} \\right) \\mathbf{e}_j = \\sum_{i=0}^{n-1} d_i \\mathbf{v}_i (\\mathbf{v}_i^{\\mathsf{T}} \\mathbf{e}_j)\n$$\n项 $\\mathbf{v}_i^{\\mathsf{T}} \\mathbf{e}_j$ 是一个标量，表示 $\\mathbf{v}_i$ 和 $\\mathbf{e}_j$ 的点积，它提取了向量 $\\mathbf{v}_i$ 的第 $j$ 个分量。令 $V_{ji}$ 表示第 $i$ 个右奇异向量 $\\mathbf{v}_i$ 的第 $j$ 个分量。则 $\\mathbf{v}_i^{\\mathsf{T}} \\mathbf{e}_j = V_{ji}$。\n因此，PSF 是右奇异向量的线性组合：\n$$\n\\mathbf{r}^{(j)} = \\sum_{i=0}^{n-1} (d_i V_{ji}) \\mathbf{v}_i\n$$\n**定性解释：**\n此表达式揭示了 PSF 是如何构建的。右奇异向量 $\\{\\mathbf{v}_i\\}$ 构成了模型空间 $\\mathbb{R}^{n_m}$ 的一个标准正交基。PSF $\\mathbf{r}^{(j)}$ 是这个空间中的一个向量，由这些基向量的加权和合成。每个基向量 $\\mathbf{v}_i$ 的权重是 $c_i = d_i V_{ji}$。\n\n-   项 $V_{ji}$ 是 $\\mathbf{v}_i$ 的第 $j$ 个分量。它量化了第 $j$ 个规范模型参数方向 $\\mathbf{e}_j$ 在多大程度上被第 $i$ 个奇异向量 $\\mathbf{v}_i$ “表示”。\n-   项 $d_i$ 是由所选估计器决定的滤波因子。它起到门或阻尼器的作用，控制每个奇异向量在最终解中的影响。对于无阻尼最小二乘，如果 $G$ 是满秩的，则所有 $d_i=1$，$R=I$，且 $\\mathbf{r}^{(j)} = \\sum_{i} V_{ji} \\mathbf{v}_i = (\\sum_i \\mathbf{v}_i \\mathbf{v}_i^{\\mathsf{T}}) \\mathbf{e}_j = V V^{\\mathsf{T}} \\mathbf{e}_j = I \\mathbf{e}_j = \\mathbf{e}_j$，这是一个代表完美分辨率的狄拉克δ函数。\n-   对于像 TSVD 或 Tikhonov 这样的正则化估计器，部分或全部 $d_i$ 小于 1。这种对奇异向量（特别是对应于小 $\\sigma_i$ 的奇异向量）的抑制会导致信息损失，从而产生一个“模糊”或“扩散”的 PSF。这种扩散的形状由滤波因子允许贡献的奇异向量 $\\mathbf{v}_i$ 的结构决定。PSF 不再是一个完美的狄拉克δ函数 $\\mathbf{e}_j$，其与 $\\mathbf{e}_j$ 的偏离直接衡量了模型参数 $j$ 处的分辨率损失。", "answer": "$$\n[[[-3.3306690738754696e-16, 2.7755575615628914e-17, -1.3877787807814457e-16, 3.3306690738754696e-16, -1.6653345369377348e-16, -2.220446049250313e-16, -1.1102230246251565e-16, 1.1102230246251565e-16, -5.551115123125783e-17, 2.220446049250313e-16, 1.0, 2.220446049250313e-16, -5.551115123125783e-17, 1.1102230246251565e-16, -1.1102230246251565e-16, -2.220446049250313e-16, -1.6653345369377348e-16, 3.3306690738754696e-16, -1.3877787807814457e-16, 2.7755575615628914e-17], 2.4424906541753444e-15, 10], [[-0.03816694605995254, -0.04634288019313936, -0.05267151529124458, -0.052445100780287235, -0.0396417720935515, -0.009363574246830573, 0.0401053424169623, 0.10091873322042799, 0.1581452654359409, 0.19827670732145695, 0.2104910691360797, 0.19827670732145692, 0.15814526543594086, 0.10091873322042795, 0.04010534241696227, -0.0093635742468306, -0.03964177209355152, -0.05244510078028725, -0.05267151529124459, -0.04634288019313936], 1.2595089308639203, 10], [[0.3807204646736449, 0.2858712353005886, 0.1691230114093863, 0.06103632906663212, -0.02102128711438997, -0.07166160408544837, -0.09117621458855428, -0.0847936173003254, -0.06076239103847754, -0.027878345155490433, 0.007559138406180373, 0.03912196656209539, 0.06208031383182855, 0.0743603417787328, 0.07593688220025757, 0.06863897129598285, 0.05494291157832629, 0.03789078657682283, 0.020521876402436476, 0.005439721249354002], 0.7225139268305081, 0], [[0.002821639832269926, 0.004944983058882582, 0.008447814887309995, 0.01377839352771561, 0.02111816782522384, 0.030238127393457524, 0.040516132470776736, 0.05083884841285223, 0.06014441029143644, 0.06738981611756597, 0.07183651111003444, 0.07301053154823101, 0.07077462060144129, 0.06536302528766723, 0.057390978340176885, 0.04769022634351982, 0.03718042456453911, 0.02672304892461972, 0.01704257121287955, 0.008688463994783354], 0.4079815039234857, 12]]\n$$", "id": "3616758"}]}