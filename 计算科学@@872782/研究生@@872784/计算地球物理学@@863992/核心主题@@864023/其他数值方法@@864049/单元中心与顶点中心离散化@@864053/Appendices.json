{"hands_on_practices": [{"introduction": "在对地球物理问题进行离散化时，如何在离散网格上表示材料属性是一个核心问题，尤其是在处理具有高对比度属性（例如渗透率或电导率）的非均质介质时。一个看似简单直观的算术平均可能导致巨大的物理偏差。本练习通过一个简单的一维稳态流问题，深刻揭示了在计算跨层有效电导率（或渗透率）时，采用算术平均与物理上正确的调和平均之间的巨大差异，这对于建立可靠的地球物理模型至关重要。[@problem_id:3579264]", "problem": "考虑一个占据区间 $[0,1]$、横截面积为单位面积 $A=1$ 的复合各向同性介质中的一维、稳态、单相流。标量势 $u(x)$ 满足线性本构关系（达西或傅里叶类型），其通量 $q(x)$ 与 $u(x)$ 的梯度和材料电导率 $k(x)$ 成正比，且守恒定律表明在稳态下通量在空间上是恒定的。该介质由两层组成：位于 $x \\in [0,1/2]$ 的左层，其电导率为常数 $k_L$；以及位于 $x \\in [1/2,1]$ 的右层，其电导率为常数 $k_R$。施加狄利克雷边界条件 $u(0) = 1$ 和 $u(1) = 0$。\n\n考虑两种离散观点：\n\n1. 在以 $x=0$ 和 $x=1$ 为顶点的顶点中心离散化中，连接顶点的单条边上的通量通过两点通量法进行近似，其边电导率由相邻层电导率的算术平均值定义，$k_{\\mathrm{edge}}^{\\mathrm{arith}} = (k_L + k_R)/2$。该方案预测的通量大小为 $|q_{\\mathrm{arith}}| = k_{\\mathrm{edge}}^{\\mathrm{arith}} \\, |u(1) - u(0)| / 1$。\n\n2. 物理上正确的通量大小 $|q_{\\mathrm{phys}}|$ 可通过在两层上施行稳态守恒和本构关系，从连续介质模型中得出。\n\n使用第一性原理，推导 $|q_{\\mathrm{arith}}|$ 和 $|q_{\\mathrm{phys}}|$ 的闭合形式表达式，然后计算高对比度情况下（$k_L = 1$ 和 $k_R = 10^6$）的比率 $r = |q_{\\mathrm{arith}}| / |q_{\\mathrm{phys}}|$。将您的最终答案 $r$ 以纯数（无量纲）形式给出，并四舍五入至四位有效数字。", "solution": "问题陈述已经過验证，被认为是合理的。它在科学上基于稳态输运现象的原理，具有充分且一致的边界条件，问题设定良好，并且表述客观。该问题将精确的解析解与一种常见的数值近似方法进行比较，这是计算物理学中一个标准且有意义的练习。\n\n首先，我们推导由顶点中心离散化预测的通量大小表达式 $|q_{\\mathrm{arith}}|$。问题将此通量近似定义为：\n$$\n|q_{\\mathrm{arith}}| = k_{\\mathrm{edge}}^{\\mathrm{arith}} \\frac{|u(1) - u(0)|}{1}\n$$\n边电导率 $k_{\\mathrm{edge}}^{\\mathrm{arith}}$ 由相邻层的电导率算术平均值给出：\n$$\nk_{\\mathrm{edge}}^{\\mathrm{arith}} = \\frac{k_L + k_R}{2}\n$$\n狄利克雷边界条件为 $u(0) = 1$ 和 $u(1) = 0$。势差为 $|u(1) - u(0)| = |0 - 1| = 1$。区域的总长度为 $L=1$。将这些值代入 $|q_{\\mathrm{arith}}|$ 的公式，得到：\n$$\n|q_{\\mathrm{arith}}| = \\left(\\frac{k_L + k_R}{2}\\right) \\frac{1}{1} = \\frac{k_L + k_R}{2}\n$$\n\n接下来，我们推导物理上正确的通量大小 $|q_{\\mathrm{phys}}|$ 的表达式。这可以从连续介质模型中获得。控制方程是守恒定律和本构关系。\n对于一维稳态流，守恒定律规定通量 $q(x)$ 在整个区域内是恒定的。我们将此恒定通量表示为 $q$。\n本构关系（例如，达西定律或傅里叶定律）将通量与势梯度联系起来：\n$$\nq = -k(x) \\frac{du}{dx}\n$$\n其中 $A=1$ 是单位横截面积。负号表示流动从高势流向低势。\n\n我们可以对介质的两层积分此方程。\n对于左层 $x \\in [0, 1/2]$，电导率为 $k(x) = k_L$。我们从 $x=0$ 积分到 $x=1/2$：\n$$\n\\int_{u(0)}^{u(1/2)} du = \\int_{0}^{1/2} -\\frac{q}{k_L} dx\n$$\n$$\nu(1/2) - u(0) = -\\frac{q}{2k_L}\n$$\n对于右层 $x \\in [1/2, 1]$，电导率为 $k(x) = k_R$。我们从 $x=1/2$ 积分到 $x=1$：\n$$\n\\int_{u(1/2)}^{u(1)} du = \\int_{1/2}^{1} -\\frac{q}{k_R} dx\n$$\n$$\nu(1) - u(1/2) = -\\frac{q}{k_R} \\left(1 - \\frac{1}{2}\\right) = -\\frac{q}{2k_R}\n$$\n我们得到一个包含两个方程的方程组。我们可以通过相加来消去未知的界面势 $u(1/2)$：\n$$\n(u(1/2) - u(0)) + (u(1) - u(1/2)) = -\\frac{q}{2k_L} - \\frac{q}{2k_R}\n$$\n$$\nu(1) - u(0) = -q \\left(\\frac{1}{2k_L} + \\frac{1}{2k_R}\\right)\n$$\n现在，我们求解通量 $q$：\n$$\nq = -\\frac{u(1) - u(0)}{\\frac{1}{2}\\left(\\frac{1}{k_L} + \\frac{1}{k_R}\\right)}\n$$\n代入边界条件 $u(0)=1$ 和 $u(1)=0$：\n$$\nq = -\\frac{0 - 1}{\\frac{1}{2}\\left(\\frac{k_R + k_L}{k_L k_R}\\right)} = \\frac{1}{\\frac{k_L + k_R}{2k_L k_R}} = \\frac{2k_L k_R}{k_L + k_R}\n$$\n通量为正，表示流动方向为正 $x$ 方向，正如预期。其大小为：\n$$\n|q_{\\mathrm{phys}}| = \\frac{2k_L k_R}{k_L + k_R}\n$$\n该表达式对应于总电阻为两层串联电阻之和，$R_{total} = R_L + R_R = \\frac{L_L}{k_L A} + \\frac{L_R}{k_R A} = \\frac{1/2}{k_L} + \\frac{1/2}{k_R}$。有效电导率是 $k_L$ 和 $k_R$ 的调和平均值。\n\n现在我们计算比率 $r = |q_{\\mathrm{arith}}| / |q_{\\mathrm{phys}}|$。\n$$\nr = \\frac{\\frac{k_L + k_R}{2}}{\\frac{2k_L k_R}{k_L + k_R}} = \\frac{(k_L + k_R)(k_L + k_R)}{2 \\cdot (2k_L k_R)} = \\frac{(k_L + k_R)^2}{4k_L k_R}\n$$\n这个比率代表了在数值方案中使用电导率的算术平均值所引入的误差，而不是对此一维串联流动问题使用物理上正确的调和平均值。\n\n最后，我们代入给定的数值 $k_L = 1$ 和 $k_R = 10^6$ 来计算 $r$。\n$$\nr = \\frac{(1 + 10^6)^2}{4(1)(10^6)} = \\frac{(1,000,001)^2}{4,000,000}\n$$\n$$\nr = \\frac{1,000,002,000,001}{4,000,000} = 250000.50000025\n$$\n问题要求将结果四舍五入到四位有效数字。这个数字写作 $2.5000050000025 \\times 10^5$。前四位有效数字是 $2、5、0、0$。第五位有效数字是 $0$，所以我们不对第四位进行四舍五入。这个数四舍五入到四位有效数字是 $250,000$。为了明确地用四位有效数字表示，我们使用科学记数法。\n$$\nr \\approx 2.500 \\times 10^5\n$$\n这个巨大的 $r$ 值凸显了在高电导率对比度介质中，使用算术平均值近似通量所带来的严重不准确性。", "answer": "$$\n\\boxed{2.500 \\times 10^5}\n$$", "id": "3579264"}, {"introduction": "在处理完材料非均质性后，我们转向几何复杂性带来的挑战。在用于表示复杂地质构造的非结构或扭曲网格上，简单的通量近似方法可能会失效，导致离散算子失去对称性等重要性质。本练习将指导您推导出一个在任意多边形网格上保持守恒和对称的通量表达式，即“两点通量近似”（TPFA）中的透射率。掌握这一推导是构建能够在真实世界复杂几何上稳定、精确求解的单元中心有限体积模拟器的关键一步。[@problem_id:3579382]", "problem": "考虑二维空间中的稳态扩散方程，该方程由守恒定律 $\\nabla \\cdot \\boldsymbol{q} = 0$ 和傅里叶定律 $\\boldsymbol{q} = -k \\nabla u$ 控制，其中 $k$ 为分段常数的各向同性热导率。在一种单元中心有限体积法（FVM）中，考虑两个相邻的多边形控制体 $V_1$ 和 $V_2$，其形心分别位于 $\\boldsymbol{x}_1$ 和 $\\boldsymbol{x}_2$。它们共享一个内部面 $f$，该面的面积（在二维中为边长）为 $A_f$，单位法向量为 $\\hat{\\boldsymbol{n}}_f$，方向从 $V_1$ 指向 $V_2$。设形心沿 $\\hat{\\boldsymbol{n}}_f$ 方向到面平面的有向距离为 $d_{1f} > 0$ 和 $d_{2f} > 0$，定义为 $d_{1f} = \\hat{\\boldsymbol{n}}_f \\cdot (\\boldsymbol{x}_f - \\boldsymbol{x}_1)$ 和 $d_{2f} = \\hat{\\boldsymbol{n}}_f \\cdot (\\boldsymbol{x}_2 - \\boldsymbol{x}_f)$，其中 $\\boldsymbol{x}_f$ 是面 $f$ 的形心。在歪斜网格上，$\\boldsymbol{x}_2 - \\boldsymbol{x}_1$ 与 $\\hat{\\boldsymbol{n}}_f$ 不共线，因此通常有 $d_{1f} \\neq d_{2f}$。\n\n在单元中心离散化中，一种常见但有缺陷的面元组合方法是，仅使用局部距离为每行分配单边的、面法向的通量贡献，即在 $V_1$ 所在行中，$a_{12}^{\\text{naive}} = k_2 A_f / d_{2f}$，在 $V_2$ 所在行中，$a_{21}^{\\text{naive}} = k_1 A_f / d_{1f}$。只要 $d_{1f} \\neq d_{2f}$ 或 $k_1 \\neq k_2$，这种做法就会破坏对称正定算子所需的非对角对称性。作为一个具体的反例，取 $k_1 = k_2 = 1$，$A_f = 1$，$d_{1f} = 0.3$ 和 $d_{2f} = 0.7$；那么 $a_{12}^{\\text{naive}} \\neq a_{21}^{\\text{naive}}$。假设所有物理量都已无量纲化，因此最终结果中不出现单位。\n\n从每个控制体上积分的守恒定律和法向通量穿过面 $f$ 的连续性出发，推导出一个修正后的两点面传递率 $T_f$。该传递率通过强制共享面 $f$ 满足 $a_{12} = a_{21} = T_f$ 来恢复对称性，且仅用 $A_f$、$k_1$、$k_2$、$d_{1f}$ 和 $d_{2f}$ 表示。你的最终答案必须是 $T_f$ 的一个单一、闭式解析表达式。不要提供不等式或方程式；只提供表达式本身。", "solution": "用户希望为使用单元中心有限体积法离散化的稳态扩散问题推导对称的两点面传递率。\n\n首先对问题进行验证。\n\n### 步骤1：提取已知条件\n- **控制方程**：\n  - 守恒定律：$\\nabla \\cdot \\boldsymbol{q} = 0$。\n  - 本构关系（傅里叶定律）：$\\boldsymbol{q} = -k \\nabla u$。\n- **材料属性**：$k$ 是分段常数的各向同性热导率。\n- **离散化背景**：单元中心有限体积法（FVM）。\n- **几何设置**：\n  - 两个相邻的控制体 $V_1$ 和 $V_2$。\n  - 单元形心位于 $\\boldsymbol{x}_1$ 和 $\\boldsymbol{x}_2$。\n  - 共享的内部面 $f$，面积为 $A_f$。\n  - 面 $f$ 的单位法向量 $\\hat{\\boldsymbol{n}}_f$，方向从 $V_1$ 指向 $V_2$。\n  - 面形心位于 $\\boldsymbol{x}_f$。\n  - 从形心到面的有向法向距离：$d_{1f} = \\hat{\\boldsymbol{n}}_f \\cdot (\\boldsymbol{x}_f - \\boldsymbol{x}_1) > 0$ 和 $d_{2f} = \\hat{\\boldsymbol{n}}_f \\cdot (\\boldsymbol{x}_2 - \\boldsymbol{x}_f) > 0$。\n- **目标**：推导一个修正后的两点面传递率 $T_f$，使得得到的离散化对于面 $f$ 是对称的（即，在问题的符号约定下，$a_{12} = a_{21} = T_f$）。$T_f$ 的表达式必须用 $A_f$、$k_1$、$k_2$、$d_{1f}$ 和 $d_{2f}$ 表示。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学依据**：该问题很好地植根于偏微分方程数值方法的原理，特别是针对扩散问题的有限体积法。传递率、控制体、面通量以及网格非正交性的挑战等概念是该领域的基础。控制方程是标准的物理学定律。\n- **适定性**：要求是基于一组清晰的物理和几何约束推导一个特定的数学表达式。可以确定一个唯一且有意义的传递率表达式。\n- **客观性**：问题以精确、客观的数学和技术语言陈述。没有主观或含糊不清的术语。\n\n### 步骤3：结论与行动\n问题是有效的。这是计算物理和工程领域数值格式推导中的一个标准且定义明确的练习。将提供解答。\n\n### 对称传递率的推导\n\n目标是确定穿过由控制体 $V_1$ 和 $V_2$ 共享的面 $f$ 的通量 $F_f$，将其表示为单元中心值 $u_1$ 和 $u_2$ 的函数。通量表示为 $F_f = T_f(u_1 - u_2)$ 的形式，其中 $T_f$ 是我们寻求推导的传递率。\n\n穿过面 $f$ 从 $V_1$ 到 $V_2$ 的总通量 $F_f$ 由通量矢量 $\\boldsymbol{q}$ 的法向分量在面面积上的积分给出：\n$$F_f = \\int_f \\boldsymbol{q} \\cdot \\hat{\\boldsymbol{n}}_f \\, dS$$\n假设通量在整个面上是均匀的，我们可以将其近似为：\n$$F_f \\approx A_f (\\boldsymbol{q}|_f \\cdot \\hat{\\boldsymbol{n}}_f)$$\n使用傅里叶定律 $\\boldsymbol{q} = -k \\nabla u$，上式变为：\n$$F_f \\approx -A_f (k \\nabla u)|_f \\cdot \\hat{\\boldsymbol{n}}_f = -A_f k_f \\frac{\\partial u}{\\partial n}\\bigg|_f$$\n其中 $k_f$ 是面上的热导率，$\\frac{\\partial u}{\\partial n}|_f$ 是 $u$ 在面上的法向导数。\n\n两点通量近似的核心是将势的面值 $u_f$ 及其法向导数与单元中心值 $u_1$ 和 $u_2$ 联系起来。我们假设在面附近的区域，势 $u$ 沿着垂直于面的方向呈一维变化。\n\n设 $u_f$ 为面形心 $\\boldsymbol{x}_f$ 处的势值。我们可以从两个角度来表示通量：从单元 $V_1$ 到面 $f$，以及从面 $f$ 到单元 $V_2$。\n\n1.  **从 $V_1$ 到 $f$ 的通量**：$V_1$ 内部在面上的法向导数可以使用法向距离 $d_{1f}$ 上的有限差分来近似。该区域的热导率为 $k_1$。\n    $$F_f \\approx -A_f k_1 \\frac{u_f - u_1}{d_{1f}} = A_f \\frac{k_1}{d_{1f}}(u_1 - u_f)$$\n    在这里，一个正的势差 $(u_1 > u_f)$ 正确地驱动一个沿 $\\hat{\\boldsymbol{n}}_f$ 方向的正通量。\n\n2.  **从 $f$ 到 $V_2$ 的通量**：类似地，$V_2$ 内部在面上的法向导数可以使用法向距离 $d_{2f}$ 和热导率 $k_2$ 来近似。\n    $$F_f \\approx -A_f k_2 \\frac{u_2 - u_f}{d_{2f}} = A_f \\frac{k_2}{d_{2f}}(u_f - u_2)$$\n    在这里，一个正的势差 $(u_f > u_2)$ 正确地驱动一个从面进入 $V_2$ 的正通量。\n\n对于面上没有源或汇的稳态扩散，通量必须是连续的。因此，我们令两个 $F_f$ 的表达式相等：\n$$A_f \\frac{k_1}{d_{1f}}(u_1 - u_f) = A_f \\frac{k_2}{d_{2f}}(u_f - u_2)$$\n我们可以消去面面积 $A_f$ 并求解未知的面势 $u_f$：\n$$\\frac{k_1}{d_{1f}} u_1 - \\frac{k_1}{d_{1f}} u_f = \\frac{k_2}{d_{2f}} u_f - \\frac{k_2}{d_{2f}} u_2$$\n$$\\frac{k_1}{d_{1f}} u_1 + \\frac{k_2}{d_{2f}} u_2 = u_f \\left( \\frac{k_1}{d_{1f}} + \\frac{k_2}{d_{2f}} \\right)$$\n$$u_f = \\frac{\\frac{k_1}{d_{1f}} u_1 + \\frac{k_2}{d_{2f}} u_2}{\\frac{k_1}{d_{1f}} + \\frac{k_2}{d_{2f}}}$$\n这表明 $u_f$ 是 $u_1$ 和 $u_2$ 的加权平均值，其中权重是“半传递率”$\\frac{k_1}{d_{1f}}$ 和 $\\frac{k_2}{d_{2f}}$。\n\n现在，我们将 $u_f$ 的这个表达式代回到其中一个通量方程中（例如，第一个），以消除中间变量 $u_f$，并获得一个仅用 $u_1$ 和 $u_2$ 表示的通量表达式。\n$$F_f = A_f \\frac{k_1}{d_{1f}}(u_1 - u_f) = A_f \\frac{k_1}{d_{1f}} \\left( u_1 - \\frac{\\frac{k_1}{d_{1f}} u_1 + \\frac{k_2}{d_{2f}} u_2}{\\frac{k_1}{d_{1f}} + \\frac{k_2}{d_{2f}}} \\right)$$\n为了简化括号中的项：\n$$u_1 - u_f = \\frac{u_1 \\left( \\frac{k_1}{d_{1f}} + \\frac{k_2}{d_{2f}} \\right) - \\left( \\frac{k_1}{d_{1f}} u_1 + \\frac{k_2}{d_{2f}} u_2 \\right)}{\\frac{k_1}{d_{1f}} + \\frac{k_2}{d_{2f}}}$$\n分子简化为：\n$$\\left( \\frac{k_1}{d_{1f}} u_1 + \\frac{k_2}{d_{2f}} u_1 \\right) - \\left( \\frac{k_1}{d_{1f}} u_1 + \\frac{k_2}{d_{2f}} u_2 \\right) = \\frac{k_2}{d_{2f}}(u_1 - u_2)$$\n将其代回到 $F_f$ 的表达式中：\n$$F_f = A_f \\frac{k_1}{d_{1f}} \\left( \\frac{\\frac{k_2}{d_{2f}}(u_1 - u_2)}{\\frac{k_1}{d_{1f}} + \\frac{k_2}{d_{2f}}} \\right) = A_f \\left( \\frac{\\frac{k_1 k_2}{d_{1f} d_{2f}}}{\\frac{k_1}{d_{1f}} + \\frac{k_2}{d_{2f}}} \\right) (u_1 - u_2)$$\n乘以 $(u_1 - u_2)$ 的项就是传递率 $T_f$：\n$$T_f = A_f \\left( \\frac{\\frac{k_1 k_2}{d_{1f} d_{2f}}}{\\frac{k_1 d_{2f} + k_2 d_{1f}}{d_{1f} d_{2f}}} \\right)$$\n简化此表达式可得到对称传递率的最终形式：\n$$T_f = \\frac{A_f k_1 k_2}{k_2 d_{1f} + k_1 d_{2f}}$$\n该表达式关于交换下标1和2是对称的。如果我们交换 $k_1 \\leftrightarrow k_2$ 和 $d_{1f} \\leftrightarrow d_{2f}$，表达式保持不变。这确保了系统矩阵中相应的非对角线元素将相等，从而产生一个对称算子。这个结果也可以解释为两个串联热阻之和的倒数，$T_f = \\left(\\frac{d_{1f}}{k_1 A_f} + \\frac{d_{2f}}{k_2 A_f}\\right)^{-1}$，也就是由面积 $A_f$ 缩放的半单元热导率的调和平均值。", "answer": "$$\\boxed{\\frac{A_f k_1 k_2}{k_2 d_{1f} + k_1 d_{2f}}}$$", "id": "3579382"}, {"introduction": "在构建了离散系统之后，我们必须回答一个至关重要的问题：“我的代码实现是否正确？” 对于复杂的数值模拟，验证是一个艰巨的任务。本练习介绍了“制造解方法”（Method of Manufactured Solutions, MMS），这是一种强大而通用的代码验证技术。通过本练习，您将实践 MMS 的核心分析步骤：为一个给定的精确解和复杂的物理模型（变系数张量传导率）推导出必需的源项。这项技能对于开发任何可靠的科学计算软件都不可或缺，无论您选择的是单元中心还是顶点中心的离散格式。[@problem_id:3579337]", "problem": "考虑计算地球物理学中用于模拟热量或质量传导输运的稳态扩散方程，\n$$-\\nabla \\cdot \\left( \\mathbf{K}(\\mathbf{x}) \\nabla u(\\mathbf{x}) \\right) = s(\\mathbf{x}) \\quad \\text{in } \\Omega,$$\n该方程定义在单位正方形域 $\\Omega = (0,1) \\times (0,1)$ 上，其外单位法向量为 $\\mathbf{n}$。该控制定律源于标量守恒和线性本构关系，其中通量为 $\\mathbf{q} = -\\mathbf{K}\\nabla u$，在控制体 $V \\subset \\Omega$ 上的局部平衡可表示为\n$$\\int_{V} s \\, \\mathrm{d}V = -\\int_{\\partial V} \\mathbf{n}\\cdot \\mathbf{K}\\nabla u \\, \\mathrm{d}A.$$\n该偏微分方程是以单元为中心和以顶点为中心的空间离散化的共同连续目标。为了通过人造解法以精确的边界处理来验证这两种离散化方法，我们指定人造解为\n$$u(x,y) = \\sin(\\pi x)\\,\\sin(\\pi y),$$\n以及对称且空间变化的传导率张量 $\\mathbf{K}(x,y)$\n$$\\mathbf{K}(x,y) = \n\\begin{pmatrix}\n1 + x^{2}  xy \\\\\nxy  2 + y^{2}\n\\end{pmatrix},$$\n该张量在 $(x,y)\\in \\Omega$ 上是正定的。任何 Dirichlet 边界上的 Dirichlet 数据将由精确的人造解 $u|_{\\Gamma_D}$ 设定，任何 Neumann 边界上的 Neumann 数据将由精确的外向通量 $q_N := -\\mathbf{n}\\cdot \\mathbf{K}\\nabla u|_{\\Gamma_N}$ 设定，从而使得无论是在以单元为中心的方案还是以顶点为中心的方案中，边界都能得到精确处理。\n\n从守恒关系式和本构定律出发，且不使用任何预先推导的快捷公式，推导源项 $s(x,y)$ 在强形式下的唯一闭式表达式，该表达式使得 $u(x,y)$ 成为具有给定 $\\mathbf{K}(x,y)$ 的模型的精确解。您的最终答案必须是 $s(x,y)$ 的单一解析表达式。最终答案中无需报告边界数据。无需四舍五入，也无需物理单位。", "solution": "问题要求推导源项 $s(x,y)$，该源项满足稳态扩散方程 $-\\nabla \\cdot \\left( \\mathbf{K}(\\mathbf{x}) \\nabla u(\\mathbf{x}) \\right) = s(\\mathbf{x})$，其中给定人造解 $u(x,y)$ 和传导率张量 $\\mathbf{K}(x,y)$。该过程涉及直接计算，即通过将给定的 $u$ 和 $\\mathbf{K}$ 的表达式代入偏微分方程的左侧。\n\n给定的人造解为\n$$u(x,y) = \\sin(\\pi x)\\sin(\\pi y)$$\n传导率张量为\n$$\\mathbf{K}(x,y) = \n\\begin{pmatrix}\n1 + x^{2}  xy \\\\\nxy  2 + y^{2}\n\\end{pmatrix}$$\n\n源项定义为 $s(x,y) = -\\nabla \\cdot (\\mathbf{K}\\nabla u)$。我们将分几步计算这个表达式。\n\n首先，我们计算标量场 $u(x,y)$ 的梯度，即 $\\nabla u = \\begin{pmatrix} \\frac{\\partial u}{\\partial x} \\\\ \\frac{\\partial u}{\\partial y} \\end{pmatrix}$。\n$u(x,y)$ 的偏导数为：\n$$\\frac{\\partial u}{\\partial x} = \\frac{\\partial}{\\partial x} \\left( \\sin(\\pi x)\\sin(\\pi y) \\right) = \\pi\\cos(\\pi x)\\sin(\\pi y)$$\n$$\\frac{\\partial u}{\\partial y} = \\frac{\\partial}{\\partial y} \\left( \\sin(\\pi x)\\sin(\\pi y) \\right) = \\pi\\sin(\\pi x)\\cos(\\pi y)$$\n因此，梯度向量为：\n$$\\nabla u(x,y) = \\begin{pmatrix} \\pi\\cos(\\pi x)\\sin(\\pi y) \\\\ \\pi\\sin(\\pi x)\\cos(\\pi y) \\end{pmatrix}$$\n\n接下来，我们计算向量场 $\\mathbf{F}(x,y) = \\mathbf{K}(x,y)\\nabla u(x,y)$。源项则为 $s = -\\nabla \\cdot \\mathbf{F}$。\n$$\n\\mathbf{F}(x,y) = \\begin{pmatrix} 1 + x^{2}  xy \\\\ xy  2 + y^{2} \\end{pmatrix} \\begin{pmatrix} \\pi\\cos(\\pi x)\\sin(\\pi y) \\\\ \\pi\\sin(\\pi x)\\cos(\\pi y) \\end{pmatrix}\n$$\n执行矩阵-向量乘法，得到 $\\mathbf{F} = \\begin{pmatrix} F_x \\\\ F_y \\end{pmatrix}$ 的分量：\n$$F_x(x,y) = (1 + x^{2}) \\left( \\pi\\cos(\\pi x)\\sin(\\pi y) \\right) + (xy) \\left( \\pi\\sin(\\pi x)\\cos(\\pi y) \\right)$$\n$$F_y(x,y) = (xy) \\left( \\pi\\cos(\\pi x)\\sin(\\pi y) \\right) + (2 + y^{2}) \\left( \\pi\\sin(\\pi x)\\cos(\\pi y) \\right)$$\n为清晰起见，这些表达式可以重写为：\n$$F_x = \\pi(1+x^2)\\cos(\\pi x)\\sin(\\pi y) + \\pi xy\\sin(\\pi x)\\cos(\\pi y)$$\n$$F_y = \\pi xy\\cos(\\pi x)\\sin(\\pi y) + \\pi(2+y^2)\\sin(\\pi x)\\cos(\\pi y)$$\n\n现在，我们计算 $\\mathbf{F}$ 的散度，即 $\\nabla \\cdot \\mathbf{F} = \\frac{\\partial F_x}{\\partial x} + \\frac{\\partial F_y}{\\partial y}$。我们分别计算每个偏导数。\n\n对于 $\\frac{\\partial F_x}{\\partial x}$，我们对每一项应用乘法法则：\n$$\\frac{\\partial F_x}{\\partial x} = \\frac{\\partial}{\\partial x} \\left( \\pi(1+x^2)\\cos(\\pi x)\\sin(\\pi y) \\right) + \\frac{\\partial}{\\partial x} \\left( \\pi xy\\sin(\\pi x)\\cos(\\pi y) \\right)$$\n$$= \\pi\\sin(\\pi y) \\frac{\\partial}{\\partial x} \\left( (1+x^2)\\cos(\\pi x) \\right) + \\pi y\\cos(\\pi y) \\frac{\\partial}{\\partial x} \\left( x\\sin(\\pi x) \\right)$$\n$$= \\pi\\sin(\\pi y) \\left[ 2x\\cos(\\pi x) + (1+x^2)(-\\pi\\sin(\\pi x)) \\right] + \\pi y\\cos(\\pi y) \\left[ \\sin(\\pi x) + x(\\pi\\cos(\\pi x)) \\right]$$\n$$= 2\\pi x\\cos(\\pi x)\\sin(\\pi y) - \\pi^2(1+x^2)\\sin(\\pi x)\\sin(\\pi y) + \\pi y\\sin(\\pi x)\\cos(\\pi y) + \\pi^2 xy\\cos(\\pi x)\\cos(\\pi y)$$\n\n对于 $\\frac{\\partial F_y}{\\partial y}$，我们再次对每一项应用乘法法则：\n$$\\frac{\\partial F_y}{\\partial y} = \\frac{\\partial}{\\partial y} \\left( \\pi xy\\cos(\\pi x)\\sin(\\pi y) \\right) + \\frac{\\partial}{\\partial y} \\left( \\pi(2+y^2)\\sin(\\pi x)\\cos(\\pi y) \\right)$$\n$$= \\pi x\\cos(\\pi x) \\frac{\\partial}{\\partial y} \\left( y\\sin(\\pi y) \\right) + \\pi\\sin(\\pi x) \\frac{\\partial}{\\partial y} \\left( (2+y^2)\\cos(\\pi y) \\right)$$\n$$= \\pi x\\cos(\\pi x) \\left[ \\sin(\\pi y) + y(\\pi\\cos(\\pi y)) \\right] + \\pi\\sin(\\pi x) \\left[ 2y\\cos(\\pi y) + (2+y^2)(-\\pi\\sin(\\pi y)) \\right]$$\n$$= \\pi x\\cos(\\pi x)\\sin(\\pi y) + \\pi^2 xy\\cos(\\pi x)\\cos(\\pi y) + 2\\pi y\\sin(\\pi x)\\cos(\\pi y) - \\pi^2(2+y^2)\\sin(\\pi x)\\sin(\\pi y)$$\n\n现在我们将两个偏导数相加，求得 $\\nabla \\cdot \\mathbf{F}$：\n$$\\nabla \\cdot \\mathbf{F} = \\frac{\\partial F_x}{\\partial x} + \\frac{\\partial F_y}{\\partial y}$$\n$$= \\left( 2\\pi x\\cos(\\pi x)\\sin(\\pi y) - \\pi^2(1+x^2)\\sin(\\pi x)\\sin(\\pi y) + \\pi y\\sin(\\pi x)\\cos(\\pi y) + \\pi^2 xy\\cos(\\pi x)\\cos(\\pi y) \\right) \\\\ + \\left( \\pi x\\cos(\\pi x)\\sin(\\pi y) + \\pi^2 xy\\cos(\\pi x)\\cos(\\pi y) + 2\\pi y\\sin(\\pi x)\\cos(\\pi y) - \\pi^2(2+y^2)\\sin(\\pi x)\\sin(\\pi y) \\right)$$\n我们按三角函数因子对各项进行分组：\n\\begin{itemize}\n    \\item 含有 $\\sin(\\pi x)\\sin(\\pi y)$ 的项：$-\\pi^2(1+x^2) - \\pi^2(2+y^2) = -\\pi^2(3+x^2+y^2)$\n    \\item 含有 $\\cos(\\pi x)\\sin(\\pi y)$ 的项：$2\\pi x + \\pi x = 3\\pi x$\n    \\item 含有 $\\sin(\\pi x)\\cos(\\pi y)$ 的项：$\\pi y + 2\\pi y = 3\\pi y$\n    \\item 含有 $\\cos(\\pi x)\\cos(\\pi y)$ 的项：$\\pi^2 xy + \\pi^2 xy = 2\\pi^2 xy$\n\\end{itemize}\n将这些项合并，得到散度的表达式：\n$$\\nabla \\cdot (\\mathbf{K}\\nabla u) = -\\pi^2(3+x^2+y^2)\\sin(\\pi x)\\sin(\\pi y) + 3\\pi x\\cos(\\pi x)\\sin(\\pi y) + 3\\pi y\\sin(\\pi x)\\cos(\\pi y) + 2\\pi^2 xy\\cos(\\pi x)\\cos(\\pi y)$$\n\n源项为 $s(x,y) = -\\nabla \\cdot (\\mathbf{K}\\nabla u)$。因此，我们对上述表达式取负：\n$$s(x,y) = - \\left[ -\\pi^2(3+x^2+y^2)\\sin(\\pi x)\\sin(\\pi y) + 3\\pi x\\cos(\\pi x)\\sin(\\pi y) + 3\\pi y\\sin(\\pi x)\\cos(\\pi y) + 2\\pi^2 xy\\cos(\\pi x)\\cos(\\pi y) \\right]$$\n$$s(x,y) = \\pi^2(3+x^2+y^2)\\sin(\\pi x)\\sin(\\pi y) - 3\\pi x\\cos(\\pi x)\\sin(\\pi y) - 3\\pi y\\sin(\\pi x)\\cos(\\pi y) - 2\\pi^2 xy\\cos(\\pi x)\\cos(\\pi y)$$\n这就是源项的唯一闭式表达式。", "answer": "$$\\boxed{\\pi^{2}(3+x^{2}+y^{2})\\sin(\\pi x)\\sin(\\pi y) - 3\\pi x\\cos(\\pi x)\\sin(\\pi y) - 3\\pi y\\sin(\\pi x)\\cos(\\pi y) - 2\\pi^{2}xy\\cos(\\pi x)\\cos(\\pi y)}$$", "id": "3579337"}]}