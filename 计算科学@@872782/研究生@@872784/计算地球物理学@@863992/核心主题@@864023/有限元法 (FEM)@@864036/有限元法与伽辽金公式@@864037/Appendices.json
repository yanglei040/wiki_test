{"hands_on_practices": [{"introduction": "理论学习的最佳补充是动手实践。我们将从一个基本的一维稳态扩散问题开始，它是在计算地球物理学中遇到的许多更复杂问题的基础。通过这个练习，你将从头开始，推导弱形式，计算单元矩阵，组装全局系统，并应用边界条件，从而全面掌握有限元方法的核心流程。[@problem_id:3616475]", "problem": "考虑计算地球物理学中使用的一维（$1$-D）稳态扩散算子，其在区间 $[0,L]$ 上由强形式偏微分方程（PDE）控制\n$$\n-\\frac{d}{dx}\\left(a\\,\\frac{du}{dx}\\right)=f(x),\n$$\n其中 $a>0$ 是一个常数材料属性，$f(x)$ 是一个给定的源项。施加齐次狄利克雷边界条件 $u(0)=0$ 和 $u(L)=0$。使用标准的迦辽金公式（试探空间和检验空间相同）和连续分段线性形函数，通过有限元法（FEM）将域离散化。网格包含 $3$ 个单元，节点坐标为 $x_0=0$、$x_1=h_1$、$x_2=h_1+h_2$、$x_3=h_1+h_2+h_3=L$，其中 $h_1>0$、$h_2>0$ 和 $h_3>0$ 是单元长度。\n\n从强形式出发，推导对应的弱形式以及具有常数 $a$ 的单个线性单元的单元刚度矩阵。然后，在施加边界条件之前，为整个 $3$ 单元网格组装全局刚度矩阵，并清楚地指明由基函数的局部性产生的带状（三对角）结构。接下来，通过消去与边界节点 $x_0$ 和 $x_3$ 相关联的行和列来施加齐次狄利克雷边界条件，以获得内部自由度的简化全局系统。\n\n作为最终答案，报告简化后全局刚度矩阵的行列式的精确解析表达式，用 $a$、$h_1$、$h_2$ 和 $h_3$ 表示。将最终答案表示为符号表达式。不包括单位。无需四舍五入。", "solution": "出发点是强形式PDE\n$$\n-\\frac{d}{dx}\\left(a\\,\\frac{du}{dx}\\right)=f(x)\\quad\\text{on}\\quad [0,L],\n$$\n其齐次狄利克雷边界条件为 $u(0)=0$ 和 $u(L)=0$。为了获得弱形式，我们选择一个检验函数 $v(x)$，它与试探函数来自同一空间（迦辽金选择），且满足 $v(0)=0$ 和 $v(L)=0$。将强形式乘以 $v$ 并在 $[0,L]$ 上积分：\n$$\n\\int_{0}^{L} -\\frac{d}{dx}\\left(a\\,\\frac{du}{dx}\\right)\\,v\\,dx=\\int_{0}^{L} f\\,v\\,dx.\n$$\n在左侧使用分部积分，并利用边界条件 $v(0)=0$ 和 $v(L)=0$，我们得到\n$$\n\\int_{0}^{L} a\\,\\frac{du}{dx}\\,\\frac{dv}{dx}\\,dx=\\int_{0}^{L} f\\,v\\,dx.\n$$\n这就是弱形式：在满足本质边界条件的适当的索伯列夫空间中找到 $u$，使得\n$$\n\\int_{0}^{L} a\\,u'(x)\\,v'(x)\\,dx=\\int_{0}^{L} f(x)\\,v(x)\\,dx\n$$\n对于所有容许的 $v$ 都成立。\n\n将域离散化为 $3$ 个单元，节点位于 $x_0=0$、$x_1=h_1$、$x_2=h_1+h_2$ 和 $x_3=h_1+h_2+h_3=L$。将 $u(x)$ 近似为\n$$\nu(x)\\approx \\sum_{i=0}^{3} U_i\\,N_i(x),\n$$\n其中 $N_i(x)$ 是与节点 $x_i$ 相关联的标准连续分段线性形函数，$U_i$ 是节点值。在一维线性单元中，长度为 $h_e=x_{i+1}-x_i$ 的单元 $e=[x_i,x_{i+1}]$ 上的单元刚度矩阵由下式得出\n$$\n\\mathbf{k}^{(e)}=\\int_{x_i}^{x_{i+1}} a\\,\\mathbf{B}^\\top \\mathbf{B}\\,dx,\n$$\n其中 $\\mathbf{B}=[N_1'(x),\\,N_2'(x)]$ 集合了局部单元形函数的导数。在线性单元上，$N_1'(x)=-\\frac{1}{h_e}$ 和 $N_2'(x)=\\frac{1}{h_e}$，在单元 $e$ 上均为常数。因此，\n$$\n\\mathbf{B}^\\top \\mathbf{B}=\n\\begin{pmatrix}\n\\left(-\\frac{1}{h_e}\\right)^2 & -\\frac{1}{h_e}\\cdot \\frac{1}{h_e} \\\\\n-\\frac{1}{h_e}\\cdot \\frac{1}{h_e} & \\left(\\frac{1}{h_e}\\right)^2\n\\end{pmatrix}\n=\\frac{1}{h_e^2}\n\\begin{pmatrix}\n1 & -1 \\\\ -1 & 1\n\\end{pmatrix}.\n$$\n在单元长度上积分，\n$$\n\\mathbf{k}^{(e)}=\\int_{x_i}^{x_{i+1}} a\\,\\frac{1}{h_e^2}\n\\begin{pmatrix}\n1 & -1 \\\\ -1 & 1\n\\end{pmatrix} dx\n= a\\,\\frac{1}{h_e}\n\\begin{pmatrix}\n1 & -1 \\\\ -1 & 1\n\\end{pmatrix}.\n$$\n因此，对于每个长度为 $h_e$ 的单元 $e$，其单元刚度矩阵为\n$$\n\\mathbf{k}^{(e)}= \\frac{a}{h_e}\n\\begin{pmatrix}\n1 & -1 \\\\ -1 & 1\n\\end{pmatrix}.\n$$\n\n我们现在组装与 $4$ 个节点自由度 $\\{U_0,U_1,U_2,U_3\\}$ 相关联的 $4\\times 4$ 全局刚度矩阵 $\\mathbf{K}$。将三个单元表示为长度为 $h_1$ 的 $e_1=[x_0,x_1]$、长度为 $h_2$ 的 $e_2=[x_1,x_2]$ 和长度为 $h_3$ 的 $e_3=[x_2,x_3]$。在全局 $(0,1,2,3)$ 排序中，单元的贡献为：\n$$\n\\mathbf{k}^{(e_1)}=\\frac{a}{h_1}\n\\begin{pmatrix}\n1 & -1 \\\\ -1 & 1\n\\end{pmatrix}\n\\quad\\text{作用于全局索引}\\quad (0,1),\n$$\n$$\n\\mathbf{k}^{(e_2)}=\\frac{a}{h_2}\n\\begin{pmatrix}\n1 & -1 \\\\ -1 & 1\n\\end{pmatrix}\n\\quad\\text{作用于全局索引}\\quad (1,2),\n$$\n$$\n\\mathbf{k}^{(e_3)}=\\frac{a}{h_3}\n\\begin{pmatrix}\n1 & -1 \\\\ -1 & 1\n\\end{pmatrix}\n\\quad\\text{作用于全局索引}\\quad (2,3).\n$$\n将这些贡献相加，得到组装后的全局刚度矩阵\n$$\n\\mathbf{K}=\n\\begin{pmatrix}\n\\frac{a}{h_1} & -\\frac{a}{h_1} & 0 & 0 \\\\\n-\\frac{a}{h_1} & \\frac{a}{h_1}+\\frac{a}{h_2} & -\\frac{a}{h_2} & 0 \\\\\n0 & -\\frac{a}{h_2} & \\frac{a}{h_2}+\\frac{a}{h_3} & -\\frac{a}{h_3} \\\\\n0 & 0 & -\\frac{a}{h_3} & \\frac{a}{h_3}\n\\end{pmatrix}.\n$$\n该矩阵是对称三对角的，呈现出半带宽等于 $1$ 的带状结构，这是线性形函数下一维（$1$-D）问题中最近邻耦合的典型特征。\n\n我们现在通过消去相关联的行和列来施加齐次狄利克雷边界条件 $U_0=0$ 和 $U_3=0$，从而留下内部自由度 $\\{U_1,U_2\\}$ 的简化系统。简化后的全局刚度矩阵 $\\mathbf{K}_{\\text{r}}$ 是一个 $2\\times 2$ 的主子矩阵\n$$\n\\mathbf{K}_{\\text{r}}=\n\\begin{pmatrix}\n\\frac{a}{h_1}+\\frac{a}{h_2} & -\\frac{a}{h_2} \\\\\n-\\frac{a}{h_2} & \\frac{a}{h_2}+\\frac{a}{h_3}\n\\end{pmatrix}\n= a\\begin{pmatrix}\n\\frac{1}{h_1}+\\frac{1}{h_2} & -\\frac{1}{h_2} \\\\\n-\\frac{1}{h_2} & \\frac{1}{h_2}+\\frac{1}{h_3}\n\\end{pmatrix}.\n$$\n$\\mathbf{K}_{\\text{r}}$ 的行列式为\n$$\n\\det(\\mathbf{K}_{\\text{r}})=\\left(\\frac{a}{h_1}+\\frac{a}{h_2}\\right)\\left(\\frac{a}{h_2}+\\frac{a}{h_3}\\right)-\\left(-\\frac{a}{h_2}\\right)^2\n= a^2\\left[\\left(\\frac{1}{h_1}+\\frac{1}{h_2}\\right)\\left(\\frac{1}{h_2}+\\frac{1}{h_3}\\right)-\\left(\\frac{1}{h_2}\\right)^2\\right].\n$$\n展开并简化括号内的表达式，\n$$\n\\left(\\frac{1}{h_1}+\\frac{1}{h_2}\\right)\\left(\\frac{1}{h_2}+\\frac{1}{h_3}\\right)-\\left(\\frac{1}{h_2}\\right)^2\n= \\left(\\frac{1}{h_1 h_2} + \\frac{1}{h_1 h_3} + \\frac{1}{h_2^2} + \\frac{1}{h_2 h_3}\\right) - \\frac{1}{h_2^2} = \\frac{1}{h_1 h_2}+\\frac{1}{h_1 h_3}+\\frac{1}{h_2 h_3}.\n$$\n等价地，使用公分母 $h_1 h_2 h_3$，这可以写成\n$$\n\\frac{h_3+h_2+h_1}{h_1 h_2 h_3}.\n$$\n因此，\n$$\n\\det(\\mathbf{K}_{\\text{r}})=a^2\\,\\frac{h_1+h_2+h_3}{h_1 h_2 h_3}.\n$$\n这就是简化后全局刚度矩阵行列式的精确解析表达式，它是通过迦辽金有限元法并基于给定的三单元网格进行显式组装，从第一性原理推导得出的。", "answer": "$$\\boxed{a^{2}\\,\\frac{h_{1}+h_{2}+h_{3}}{h_{1} h_{2} h_{3}}}$$", "id": "3616475"}, {"introduction": "在掌握了一维标量问题的基础上，我们将挑战一个更贴近实际地球物理应用的二维矢量问题：平面应变下的线弹性变形。这个练习不仅将有限元方法扩展到处理矢量场和张量属性，还引入了在分层介质中进行建模的概念。通过计算一个特定位移场下的应变能，我们可以巧妙地验证我们对单元和全局刚度矩阵的构建。[@problem_id:3616479]", "problem": "考虑一个二维分层介质中的小应变、线性、各向同性平面应变弹性问题。将采用迦辽金公式的有限元法 (FEM)，并使用线性三角形单元。底层占据区域 $y \\in [0, 0.5]$，其特征由 Lamé 参数 $(\\lambda_{1}, \\mu_{1})$ 描述。顶层占据区域 $y \\in (0.5, 1]$，其 Lamé 参数为 $(\\lambda_{2}, \\mu_{2})$。假设平面外厚度为单位长度。\n\n域为单位正方形 $\\Omega = [0,1] \\times [0,1]$，被划分为四个线性三角形单元，全局节点坐标如下\n- 节点 $1$：$(0,0)$，\n- 节点 $2$：$(1,0)$，\n- 节点 $3$：$(0,0.5)$，\n- 节点 $4$：$(1,0.5)$，\n- 节点 $5$：$(0,1)$，\n- 节点 $6$：$(1,1)$，\n以及单元\n- 单元 $E_{1}$：节点 $(1,2,3)$，位于底层，\n- 单元 $E_{2}$：节点 $(2,4,3)$，位于底层，\n- 单元 $E_{3}$：节点 $(3,4,5)$，位于顶层，\n- 单元 $E_{4}$：节点 $(4,6,5)$，位于顶层。\n\n采用标准平面应变设置，对称梯度应变度量为 $\\boldsymbol{\\varepsilon}(\\boldsymbol{u}) = \\begin{pmatrix}\\partial u_{x}/\\partial x \\\\ \\partial u_{y}/\\partial y \\\\ \\partial u_{x}/\\partial y + \\partial u_{y}/\\partial x \\end{pmatrix}$，线性弹性本构关系为 $\\boldsymbol{\\sigma} = \\boldsymbol{C} \\, \\boldsymbol{\\varepsilon}$，其中每层的弹性张量由 Lamé 参数 $(\\lambda,\\mu)$ 定义为\n$$\n\\boldsymbol{C} = \\begin{pmatrix}\n\\lambda + 2\\mu & \\lambda & 0 \\\\\n\\lambda & \\lambda + 2\\mu & 0 \\\\\n0 & 0 & \\mu\n\\end{pmatrix}.\n$$\n\n任务：\n1. 对于具有节点坐标 $(x_{i},y_{i})$ 的单个线性三角形单元，从第一性原理推导常应变-位移矩阵 $\\boldsymbol{B}$，并将单元刚度矩阵写为 $\\boldsymbol{K}^{(e)} = \\int_{\\Omega_{e}} \\boldsymbol{B}^{\\top} \\boldsymbol{C} \\, \\boldsymbol{B} \\, \\mathrm{d}\\Omega$。然后，使用 $(\\lambda_{1},\\mu_{1})$ 显式计算单元 $E_{1}$ 的 $\\boldsymbol{B}$ 和 $\\boldsymbol{K}^{(e)}$。\n2. 通过对来自 $E_{1}, E_{2}$（使用 $(\\lambda_{1},\\mu_{1})$）和 $E_{3}, E_{4}$（使用 $(\\lambda_{2},\\mu_{2})$）的单元刚度贡献进行适当的放置和求和，组装整个网格的全局刚度矩阵 $\\boldsymbol{K}$。\n3. 施加本质（Dirichlet）边界条件，将底边 $y=0$ 上的所有位移分量约束为零，即在节点 1 和 2 处 $u_{x} = 0$ 且 $u_{y} = 0$。此外，在节点 5 处约束 $u_{x} = 0$ 以消除任何水平方向的残余刚体运动。令 $\\boldsymbol{K}_{\\text{red}}$ 表示施加这些约束后简化得到的全局刚度矩阵。\n4. 定义一个测试离散位移向量 $\\boldsymbol{v}$，使其在网格的自由节点上与连续场 $u_{x}(x,y) = 0, u_{y}(x,y) = y$ 一致，即将每个自由节点的位移分量设置为该场在该节点处的值（约束节点处为零）。使用与迦辽金双线性形式相关的能量恒等式，以 $(\\lambda_{1},\\mu_{1},\\lambda_{2},\\mu_{2})$ 的符号形式计算标量 $s = \\boldsymbol{v}^{\\top} \\boldsymbol{K}_{\\text{red}} \\boldsymbol{v}$。\n\n以 $s$ 的单一闭式解析表达式的形式提供最终答案。无需进行数值四舍五入。最终表达式中不应包含物理单位。", "solution": "计算 $s = \\boldsymbol{v}^{\\top} \\boldsymbol{K}_{\\text{red}} \\boldsymbol{v}$ 的一个更直接的方法是使用能量恒等式。对于给定的离散位移向量 $\\boldsymbol{d}$（在我们的案例中为 $\\boldsymbol{v}$），相关的能量二次型 $\\boldsymbol{d}^{\\top} \\boldsymbol{K} \\boldsymbol{d}$ 可以通过对每个单元的能量贡献求和来计算，因为受约束的自由度对应的位移为零，所以简化矩阵 $\\boldsymbol{K}_{\\text{red}}$ 上的计算与在完整矩阵 $\\boldsymbol{K}$ 上使用完整位移向量的计算结果相同。\n$$ s = \\boldsymbol{d}^{\\top} \\boldsymbol{K} \\boldsymbol{d} = \\sum_{e=1}^{4} (\\boldsymbol{d}^{(e)})^{\\top} \\boldsymbol{K}^{(e)} \\boldsymbol{d}^{(e)} $$\n其中 $\\boldsymbol{d}^{(e)}$ 是单元 $e$ 的节点位移。单元刚度矩阵 $\\boldsymbol{K}^{(e)}$ 定义为 $\\boldsymbol{K}^{(e)} = \\int_{\\Omega_{e}} \\boldsymbol{B}^{\\top} \\boldsymbol{C} \\boldsymbol{B} \\mathrm{d}\\Omega = A_e \\boldsymbol{B}_e^{\\top} \\boldsymbol{C}_e \\boldsymbol{B}_e$（对于常应变单元）。因此，能量可以写为单元应变的函数：\n$$ s = \\sum_{e=1}^{4} A_e (\\boldsymbol{B}_e \\boldsymbol{d}^{(e)})^{\\top} \\boldsymbol{C}_e (\\boldsymbol{B}_e \\boldsymbol{d}^{(e)}) = \\sum_{e=1}^{4} A_e (\\boldsymbol{\\varepsilon}^{(e)})^{\\top} \\boldsymbol{C}_e \\boldsymbol{\\varepsilon}^{(e)} $$\n此处，$\\boldsymbol{\\varepsilon}^{(e)} = \\boldsymbol{B}_e \\boldsymbol{d}^{(e)}$ 是单元 $e$ 内的常应变。\n\n首先，我们根据问题说明构建全局位移向量 $\\boldsymbol{d}$ (或 $\\boldsymbol{v}$)。\n- 约束节点：$u_{x1}=0, u_{y1}=0, u_{x2}=0, u_{y2}=0, u_{x5}=0$。\n- 在场 $u_x=0, u_y=y$ 处求值的自由节点：\n  - $N_3(0,0.5) \\implies u_{x3}=0, u_{y3}=0.5$\n  - $N_4(1,0.5) \\implies u_{x4}=0, u_{y4}=0.5$\n  - $N_5(0,1) \\implies u_{y5}=1$ (因为 $u_{x5}$ 受约束)\n  - $N_6(1,1) \\implies u_{x6}=0, u_{y6}=1$\n完整的全局位移向量 $\\boldsymbol{d} = [u_{x1}, u_{y1}, u_{x2}, u_{y2}, \\dots, u_{x6}, u_{y6}]^{\\top}$ 为：\n$$ \\boldsymbol{d} = [0, 0, 0, 0, 0, 0.5, 0, 0.5, 0, 1, 0, 1]^{\\top} $$\n\n接下来，我们计算每个单元的应变 $\\boldsymbol{\\varepsilon}^{(e)}$。对于一个线性三角形单元，$\\boldsymbol{\\varepsilon}^{(e)}$ 在单元内是恒定的。我们可以直接从连续位移场 $u_x=0, u_y=y$ 计算应变：\n$$ \\varepsilon_{xx} = \\frac{\\partial u_x}{\\partial x} = 0 $$\n$$ \\varepsilon_{yy} = \\frac{\\partial u_y}{\\partial y} = \\frac{\\partial y}{\\partial y} = 1 $$\n$$ \\gamma_{xy} = \\frac{\\partial u_x}{\\partial y} + \\frac{\\partial u_y}{\\partial x} = 0 + 0 = 0 $$\n因此，在整个域中应变是恒定的：对于所有 $e$ 都有 $\\boldsymbol{\\varepsilon}^{(e)} = \\boldsymbol{\\varepsilon}_0 = [0, 1, 0]^{\\top}$。由于给定的位移场是线性的，使用线性三角形单元的有限元离散化可以精确地再现这个场和它的导数（应变）。\n\n总能量 $s$ 为：\n$$ s = A_1 \\boldsymbol{\\varepsilon}_0^{\\top}\\boldsymbol{C}_1\\boldsymbol{\\varepsilon}_0 + A_2 \\boldsymbol{\\varepsilon}_0^{\\top}\\boldsymbol{C}_1\\boldsymbol{\\varepsilon}_0 + A_3 \\boldsymbol{\\varepsilon}_0^{\\top}\\boldsymbol{C}_2\\boldsymbol{\\varepsilon}_0 + A_4 \\boldsymbol{\\varepsilon}_0^{\\top}\\boldsymbol{C}_2\\boldsymbol{\\varepsilon}_0 $$\n所有单元都是直角三角形，底为1，高为0.5，因此面积均为 $A_e = \\frac{1}{2} \\times 1 \\times 0.5 = 0.25$。\n$$ s = (A_1+A_2) \\boldsymbol{\\varepsilon}_0^{\\top}\\boldsymbol{C}_1\\boldsymbol{\\varepsilon}_0 + (A_3+A_4) \\boldsymbol{\\varepsilon}_0^{\\top}\\boldsymbol{C}_2\\boldsymbol{\\varepsilon}_0 $$\n底层（单元 $E_1, E_2$）的总面积为 $0.25+0.25=0.5$。顶层（$E_3, E_4$）的总面积也为 0.5。\n$$ s = 0.5 \\times \\boldsymbol{\\varepsilon}_0^{\\top}\\boldsymbol{C}_1\\boldsymbol{\\varepsilon}_0 + 0.5 \\times \\boldsymbol{\\varepsilon}_0^{\\top}\\boldsymbol{C}_2\\boldsymbol{\\varepsilon}_0 $$\n我们来计算二次型 $\\boldsymbol{\\varepsilon}_0^{\\top}\\boldsymbol{C}\\boldsymbol{\\varepsilon}_0$：\n$$ \\boldsymbol{\\varepsilon}_0^{\\top}\\boldsymbol{C}\\boldsymbol{\\varepsilon}_0 = \\begin{pmatrix} 0 & 1 & 0 \\end{pmatrix} \\begin{pmatrix} \\lambda + 2\\mu & \\lambda & 0 \\\\ \\lambda & \\lambda + 2\\mu & 0 \\\\ 0 & 0 & \\mu \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} \\lambda & \\lambda + 2\\mu & 0 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\lambda + 2\\mu $$\n将此应用于每一层：\n$$ s = \\frac{1}{2}(\\lambda_1 + 2\\mu_1) + \\frac{1}{2}(\\lambda_2 + 2\\mu_2) $$\n此表达式即为最终答案。", "answer": "$$\n\\boxed{\\frac{1}{2}(\\lambda_1 + 2\\mu_1 + \\lambda_2 + 2\\mu_2)}\n$$", "id": "3616479"}, {"introduction": "从静态或稳态问题转向动态问题，是有限元应用的另一个重要飞跃，尤其是在地震学中。本练习将探讨标量波动方程的半离散化，这会引入一个关键的新组件：质量矩阵。你将分析“一致质量矩阵”和“集总质量矩阵”之间的权衡，这是在显式时间积分方案中平衡计算精度和效率的核心考量。[@problem_id:3616519]", "problem": "在一个有界域 $\\Omega \\subset \\mathbb{R}^d$ 中，一个标量地震波场 $u(\\mathbf{x},t)$ 满足二阶双曲型偏微分方程 $ \\rho(\\mathbf{x}) \\, \\ddot{u}(\\mathbf{x},t) - \\nabla \\cdot \\left( \\kappa(\\mathbf{x}) \\, \\nabla u(\\mathbf{x},t) \\right) = s(\\mathbf{x},t)$，其中密度 $\\rho(\\mathbf{x})$ 和体积模量 $\\kappa(\\mathbf{x})$ 随空间变化，并满足适当的边界条件。在迦辽金有限元离散化中，我们将 $u(\\mathbf{x},t)$ 表示为与节点自由度 $u_i(t)$ 相关联的基函数 $N_i(\\mathbf{x})$ 的有限展开，并用相同的函数检验弱形式。由此产生的半离散系统包含一个质量矩阵和一个刚度矩阵。在实践中，用于地震模拟的显式时间步进格式通常采用对角（集中）质量矩阵以实现局部更新，从而以精度换取效率。\n\n下列哪个陈述正确定义了一致质量和集中质量的构造，并描述了它们对地震波模拟中显式时间步进的精度和稳定性的影响？\n\nA. 在使用拉格朗日基函数 $N_i(\\mathbf{x})$ 的迦辽金有限元法中，一致质量矩阵为 $M_{ij} = \\int_{\\Omega} \\rho(\\mathbf{x}) \\, N_i(\\mathbf{x}) \\, N_j(\\mathbf{x}) \\, \\mathrm{d}\\mathbf{x}$。一种常见的集中质量近似是将 $M$ 替换为一个对角矩阵 $\\tilde{M}$，其元素为 $\\tilde{M}_{ii} = \\sum_{j} M_{ij}$。由于单位分解性质 $\\sum_j N_j(\\mathbf{x}) = 1$，这等价于 $\\tilde{M}_{ii} = \\int_{\\Omega} \\rho(\\mathbf{x}) \\, N_i(\\mathbf{x}) \\, \\mathrm{d}\\mathbf{x}$。\n\nB. 对于均匀网格上的线性单元，使用显式中心差分时间积分时，一致质量矩阵比集中质量矩阵产生一个更宽松的稳定性条件（即，一个更大的最大稳定时间步长 $\\Delta t_{\\max}$）。\n\nC. 在具有线性单元和恒定材料属性的均匀一维网格上，与广义特征值问题 $K \\phi = \\omega^2 M \\phi$ 相关的最大离散角频率，在使用一致质量矩阵时比使用集中质量矩阵时更高，这意味着当使用一致质量矩阵时，显式中心差分积分所允许的时间步长更小。\n\nD. 当密度 $\\rho(\\mathbf{x})$ 在空间上变化时，通过行和集中的质量集中方法通常会破坏质量矩阵的对称性和正定性，从而损害显式时间步进的稳定性。\n\nE. 对角质量矩阵使得加速度的计算可以在节点局部进行，无需全局线性求解，这对于大规模并行显式地震模拟非常有利；在高阶谱元法中，使用高斯-洛巴托-勒让德求积可产生一个对角质量矩阵，同时保持空间离散化的高阶精度。\n\n选择所有适用项。", "solution": "由给定波动方程的迦辽金有限元公式得到的半离散常微分方程组为：\n$$ M \\ddot{\\mathbf{u}}(t) + K \\mathbf{u}(t) = \\mathbf{f}(t) $$\n其中 $\\mathbf{u}(t)$ 是节点自由度 $u_i(t)$ 的向量，$\\ddot{\\mathbf{u}}(t)$ 是节点加速度的向量，$M$ 是质量矩阵，$K$ 是刚度矩阵，$\\mathbf{f}(t)$ 是由源项和边界条件产生的力向量。刚度矩阵和（一致）质量矩阵的元素由下式给出：\n$$ K_{ij} = \\int_{\\Omega} \\kappa(\\mathbf{x}) \\, \\nabla N_i(\\mathbf{x}) \\cdot \\nabla N_j(\\mathbf{x}) \\, \\mathrm{d}\\mathbf{x} $$\n$$ M_{ij} = \\int_{\\Omega} \\rho(\\mathbf{x}) \\, N_i(\\mathbf{x}) \\, N_j(\\mathbf{x}) \\, \\mathrm{d}\\mathbf{x} $$\n\n对于显式时间积分格式，例如中心差分法，其稳定性由 Courant-Friedrichs-Lewy (CFL) 条件控制，该条件将时间步长 $\\Delta t$ 与离散系统的最高固有频率 $\\omega_{\\max}$ 联系起来。这个最大频率是广义特征值问题最大特征值 $\\lambda_{\\max}$ 的平方根：\n$$ K \\boldsymbol{\\phi} = \\omega^2 M \\boldsymbol{\\phi} $$\n稳定性条件是 $\\Delta t \\le \\frac{2}{\\omega_{\\max}}$。\n\n**A.** 一致质量矩阵的定义 $M_{ij} = \\int_{\\Omega} \\rho(\\mathbf{x}) \\, N_i(\\mathbf{x}) \\, N_j(\\mathbf{x}) \\, \\mathrm{d}\\mathbf{x}$ 是将迦辽金原理应用于偏微分方程的 $\\rho \\ddot{u}$ 项的直接结果。这是正确的。行和集中格式是通过对一致质量矩阵的每一行元素求和并将总和放在对角线上来定义：$\\tilde{M}_{ii} = \\sum_{j} M_{ij}$。这也是正确的。利用积分的线性和基函数的单位分解性质 $\\sum_j N_j(\\mathbf{x}) = 1$，我们可以证明其等价性：\n$$ \\tilde{M}_{ii} = \\sum_{j} M_{ij} = \\sum_{j} \\int_{\\Omega} \\rho(\\mathbf{x}) \\, N_i(\\mathbf{x}) \\, N_j(\\mathbf{x}) \\, \\mathrm{d}\\mathbf{x} = \\int_{\\Omega} \\rho(\\mathbf{x}) \\, N_i(\\mathbf{x}) \\left( \\sum_{j} N_j(\\mathbf{x}) \\right) \\mathrm{d}\\mathbf{x} = \\int_{\\Omega} \\rho(\\mathbf{x}) \\, N_i(\\mathbf{x}) \\, \\mathrm{d}\\mathbf{x} $$\n该等价性成立。因此，陈述A完全正确。\n\n**B.** 稳定性条件为 $\\Delta t_{\\max} \\propto 1/\\omega_{\\max}$。一个更大的 $\\Delta t_{\\max}$ 意味着一个更小的 $\\omega_{\\max}$。这个陈述声称 $\\omega_{\\max, \\text{一致}} < \\omega_{\\max, \\text{集中}}$。然而，在有限元分析中，一个公认的结果是，一致质量矩阵相对于集中质量矩阵会高估系统的惯性效应，从而导致更高的最高频率。对于一维均匀网格上的线性单元，可以证明 $\\omega_{\\max, \\text{一致}}^2 = 3 \\omega_{\\max, \\text{集中}}^2$。因此，$\\omega_{\\max, \\text{一致}} > \\omega_{\\max, \\text{集中}}$，这意味着 $\\Delta t_{\\max, \\text{一致}} < \\Delta t_{\\max, \\text{集中}}$。一致质量矩阵导致一个更严格（更小）的时间步长。因此，陈述B不正确。\n\n**C.** 这个陈述是陈述B的逆命题。正如在对B的分析中所述，对于一维线性单元，一致质量矩阵确实导致了比集中质量矩阵更高的最大离散角频率（$\\omega_{\\max, \\text{一致}} > \\omega_{\\max, \\text{集中}}$）。由于稳定性条件 $\\Delta t_{\\max} \\propto 1/\\omega_{\\max}$，更高的 $\\omega_{\\max}$ 直接意味着更小的最大允许时间步长 $\\Delta t_{\\max}$。因此，陈述C是正确的。\n\n**D.** 行和集中格式产生一个对角矩阵。任何对角矩阵都是对称的，所以对称性不会被破坏。对角线元素为 $\\tilde{M}_{ii} = \\int_{\\Omega} \\rho(\\mathbf{x}) \\, N_i(\\mathbf{x}) \\, \\mathrm{d}\\mathbf{x}$。由于物理上的密度 $\\rho(\\mathbf{x})$ 是正的，而拉格朗日基函数 $N_i(\\mathbf{x})$ 是非负的且不恒为零，其积分结果必然是严格正的。因此，所有对角线元素都为正，该对角矩阵是正定的。无论密度是常数还是变化的，该陈述都不正确。\n\n**E.** 半离散方程是 $M \\ddot{\\mathbf{u}} = \\mathbf{f} - K \\mathbf{u}$。如果 $M$ 是对角的，则其逆矩阵也是对角的，每个节点的加速度 $\\ddot{u}_i$ 可以通过 $\\ddot{u}_i = (1/M_{ii}) (\\mathbf{f} - K \\mathbf{u})_i$ 来独立计算，无需解一个全局线性系统。这对并行计算非常有利。陈述的第一部分是正确的。在高阶谱元法（SEM）中，如果使用高斯-洛巴托-勒让德（GLL）点同时作为插值节点和数值积分点，则利用拉格朗日基函数在节点上的克罗内克-德尔塔性质，质量矩阵的数值积分自然地变成对角矩阵。这种方法在保持高阶精度的同时实现了质量集总，是SEM的一个关键优势。陈述的第二部分也是正确的。因此，整个陈述E是正确的。", "answer": "$$\\boxed{ACE}$$", "id": "3616519"}]}