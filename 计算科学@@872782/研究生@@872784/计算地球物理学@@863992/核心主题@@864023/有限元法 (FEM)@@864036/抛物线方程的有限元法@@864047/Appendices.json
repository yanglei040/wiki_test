{"hands_on_practices": [{"introduction": "理解网格质量与解的稳定性之间的联系，对任何有限元实践者都至关重要。本练习通过让您直接计算一个包含钝角单元的网格的刚度矩阵项，来探索离散极值原理的概念，该原理可以防止解中出现非物理振荡 [@problem_id:3594903]。通过这个例子，您将具体理解为何某些网格几何形状会导致不良的数值伪影，并认识到Delaunay条件等网格生成标准的重要性。", "problem": "考虑均匀各向同性介质中的二维热传导方程，\n$$c\\,\\partial_t u - \\nabla \\cdot (k\\,\\nabla u) = f \\quad \\text{in } \\Omega \\subset \\mathbb{R}^2,$$\n其中热导率 $k0$ 和体积热容 $c0$ 为常数。在三角形网格上进行线性有限元空间离散后，得到的半离散系统形式如下\n$$M\\,\\dot{\\mathbf{u}} + K\\,\\mathbf{u} = \\mathbf{F},$$\n其中 $M$ 是质量矩阵，$K$ 是刚度矩阵，$\\mathbf{F}$ 是载荷向量。采用大小为 $\\Delta t0$ 的向后Euler时间步长后，全离散系统为\n$$(M + \\Delta t\\,K)\\,\\mathbf{u}^{n+1} = M\\,\\mathbf{u}^n + \\Delta t\\,\\mathbf{F}^{n+1}。$$\n一个非对角元为非正且其逆矩阵逐项非负的矩阵称为M-矩阵（单调矩阵）。在能使离散算子产生M-矩阵的网格上，离散最大值原理成立，从而避免了伪过冲。\n\n构建如下简单的网格片：两个三角形共享节点1和2之间的内部边，节点坐标为\n$$\\mathbf{x}_1=(0,0),\\quad \\mathbf{x}_2=(1,0),\\quad \\mathbf{x}_3=(0.5,\\,0.1),\\quad \\mathbf{x}_4=(0.5,\\,-0.1),$$\n三角形为 $T_1=(1,2,3)$ 和 $T_2=(1,2,4)$。取 $k=1$ 和 $c=1$。严格从弱形式和线性形函数的定义出发，推导单元刚度贡献 $K_{12}^{T_1}$ 和 $K_{12}^{T_2}$，并为该网格片组装非对角刚度项 $K_{12}$。然后，根据 $(M+\\Delta t\\,K)$ 的性质和离散最大值原理进行推理，评估其对向后Euler解的影响以及是否会发生过冲。\n\n下列哪个陈述是正确的？\n\nA. 对于此网格，组装后的刚度矩阵非对角项 $K_{12}$ 是严格为正的，这违反了空间算子的M-矩阵性质，并可能在向后Euler解中内部边附近引起过冲。\n\nB. 使用质量集中（对角阵 $M$）可以保证即使在钝角三角形上，$(M+\\Delta t\\,K)$ 的非对角元也为非正，因此离散最大值原理成立。\n\nC. 如果某些刚度非对角项为正，仅减小时间步长 $\\Delta t$ 并不能保证在固定网格上消除过冲；这种违背源于几何原因。\n\nD. 通过适当的边翻转，将网格重构为锐角或Delaunay三角剖分，可以恢复刚度矩阵的非正非对角元和离散最大值原理所需的单调性。", "solution": "该问题陈述被评估为有效，因为它在科学上基于偏微分方程数值方法的理论，问题设定良好，目标明确，数据充分，并使用了精确、客观的语言。\n\n问题的核心是确定给定网格片的刚度矩阵非对角项 $K_{12}$ 的符号，并分析其对向后Euler时间步进格式的影响。\n\n刚度矩阵 $K$ 源于对 $-\\nabla \\cdot (k\\,\\nabla u)$ 项的空间离散。其矩阵元由弱形式给出：\n$$ K_{ij} = \\int_\\Omega k (\\nabla \\phi_j \\cdot \\nabla \\phi_i) \\, d\\Omega $$\n其中 $\\phi_i$ 和 $\\phi_j$ 是与节点 $i$ 和 $j$ 相关联的线性基函数（帽函数）。全局项 $K_{12}$ 是通过对所有同时包含节点1和2的单元的贡献求和来组装的。在本例中，这些单元是三角形 $T_1 = (1,2,3)$ 和 $T_2 = (1,2,4)$。\n$$ K_{12} = K_{12}^{T_1} + K_{12}^{T_2} = \\int_{T_1} k (\\nabla \\phi_2 \\cdot \\nabla \\phi_1) \\, d\\Omega + \\int_{T_2} k (\\nabla \\phi_2 \\cdot \\nabla \\phi_1) \\, d\\Omega $$\n对于三角形上的线性单元，有一个标准公式将非对角单元刚度项与相应边对角的余切值联系起来。对于由节点 $i$ 和 $j$ 共享的边，三角形的第三个顶点为 $k$，其贡献为：\n$$ K_{ij}^T = -k \\frac{\\cot \\theta_k}{2} $$\n其中 $\\theta_k$ 是三角形在顶点 $k$ 处的内角。\n\n我们将此公式应用于给定的网格片，其中 $k=1$。\n\n对于三角形 $T_1 = (1,2,3)$：\n顶点为 $\\mathbf{x}_1=(0,0)$，$\\mathbf{x}_2=(1,0)$ 和 $\\mathbf{x}_3=(0.5,\\,0.1)$。非对角项 $K_{12}^{T_1}$ 对应于边 $(1,2)$，因此我们需要其对顶点 $\\mathbf{x}_3$ 处的角 $\\theta_3$。我们可以使用构成该角的向量的点积来求得：\n$$ \\mathbf{v}_{31} = \\mathbf{x}_1 - \\mathbf{x}_3 = (0-0.5, \\, 0-0.1) = (-0.5, -0.1) $$\n$$ \\mathbf{v}_{32} = \\mathbf{x}_2 - \\mathbf{x}_3 = (1-0.5, \\, 0-0.1) = (0.5, -0.1) $$\n角 $\\theta_3$ 的余弦值为：\n$$ \\cos \\theta_3 = \\frac{\\mathbf{v}_{31} \\cdot \\mathbf{v}_{32}}{|\\mathbf{v}_{31}| |\\mathbf{v}_{32}|} = \\frac{(-0.5)(0.5) + (-0.1)(-0.1)}{\\sqrt{(-0.5)^2 + (-0.1)^2} \\sqrt{(0.5)^2 + (-0.1)^2}} = \\frac{-0.25 + 0.01}{0.25 + 0.01} = \\frac{-0.24}{0.26} = -\\frac{12}{13} $$\n由于 $\\cos \\theta_3  0$，角 $\\theta_3$ 是一个钝角。为了求出余切，我们首先求正弦：\n$$ \\sin \\theta_3 = \\sqrt{1 - \\cos^2 \\theta_3} = \\sqrt{1 - \\left(-\\frac{12}{13}\\right)^2} = \\sqrt{1 - \\frac{144}{169}} = \\sqrt{\\frac{25}{169}} = \\frac{5}{13} $$\n余切值为：\n$$ \\cot \\theta_3 = \\frac{\\cos \\theta_3}{\\sin \\theta_3} = \\frac{-12/13}{5/13} = -\\frac{12}{5} = -2.4 $$\n现在我们计算来自 $T_1$ 的刚度贡献：\n$$ K_{12}^{T_1} = -k \\frac{\\cot \\theta_3}{2} = -(1) \\frac{-2.4}{2} = 1.2 $$\n\n对于三角形 $T_2 = (1,2,4)$：\n顶点为 $\\mathbf{x}_1=(0,0)$，$\\mathbf{x}_2=(1,0)$ 和 $\\mathbf{x}_4=(0.5,\\,-0.1)$。这个三角形是 $T_1$ 关于x轴的镜像。根据对称性，顶点 $\\mathbf{x}_4$ 处的角 $\\theta_4$ 等于 $\\theta_3$。因此，$\\cot \\theta_4 = -2.4$。\n来自 $T_2$ 的刚度贡献为：\n$$ K_{12}^{T_2} = -k \\frac{\\cot \\theta_4}{2} = -(1) \\frac{-2.4}{2} = 1.2 $$\n\n最后，我们通过对贡献求和来组装全局（片）刚度项 $K_{12}$：\n$$ K_{12} = K_{12}^{T_1} + K_{12}^{T_2} = 1.2 + 1.2 = 2.4 $$\n结果是，非对角刚度项 $K_{12}$ 严格为正。\n\n向后Euler法的全离散系统为 $(M + \\Delta t\\,K)\\,\\mathbf{u}^{n+1} = M\\,\\mathbf{u}^n + \\Delta t\\,\\mathbf{F}^{n+1}$。令 $A = M + \\Delta t\\,K$ 为系统矩阵。一个M-矩阵必须具有非正的非对角元。非对角元 $A_{12}$ 由下式给出：\n$$ A_{12} = M_{12} + \\Delta t\\,K_{12} $$\n一致质量矩阵项 $M_{12}$ 大于零 ($M_{12} = \\sum_e \\int_{T_e} c \\phi_1 \\phi_2 d\\Omega > 0$)。当 $c=1$ 时，$M_{12} = M_{12}^{T_1} + M_{12}^{T_2} = \\frac{1 \\cdot \\text{Area}(T_1)}{12} + \\frac{1 \\cdot \\text{Area}(T_2)}{12} = \\frac{0.05}{12} + \\frac{0.05}{12} = \\frac{0.1}{12} > 0$。\n由于 $M_{12} > 0$, $K_{12} = 2.4 > 0$, 并且 $\\Delta t > 0$，所以对于任意 $\\Delta t > 0$ 的选择，非对角项 $A_{12}$ 都严格为正。\n$$ A_{12} = M_{12} + 2.4\\,\\Delta t > 0 $$\n系统矩阵 $A$ 不是一个M-矩阵。因此，防止伪振荡的离散最大值原理不保证成立。\n\n现在，我们来评估每个给定的选项。\n\nA. 对于此网格，组装后的刚度矩阵非对角项 $K_{12}$ 是严格为正的，这违反了空间算子的M-矩阵性质，并可能在向后Euler解中内部边附近引起过冲。\n我们的计算表明 $K_{12}=2.4$，是严格为正的。这违反了刚度矩阵成为（或关联于）M-矩阵的必要条件（对于 $i \\ne j$，$K_{ij} \\le 0$）。由此产生的向后Euler系统矩阵 $A=M+\\Delta t K$ 也将有一个正的非对角元 $A_{12}$，这意味着它不是一个M-矩阵。众所周知，M-矩阵性质的缺失会允许数值解中出现非物理的过冲和下冲。因此，这个陈述是准确的。\n**结论：正确。**\n\nB. 使用质量集中（对角阵 $M$）可以保证即使在钝角三角形上，$(M+\\Delta t\\,K)$ 的非对角元也为非正，因此离散最大值原理成立。\n如果使用质量集中，质量矩阵 $M$ 变为对角阵，因此其非对角元为零，即 $M_{12}=0$。系统矩阵的非对角项变为 $A_{12} = 0 + \\Delta t\\,K_{12} = \\Delta t(2.4)$。由于 $\\Delta t > 0$ 且 $K_{12} > 0$，所以 $A_{12}$ 仍然是严格为正的。关于非对角元变为非正的说法是错误的。因此，离散最大值原理不被保证。\n**结论：不正确。**\n\nC. 如果某些刚度非对角项为正，仅减小时间步长 $\\Delta t$ 并不能保证在固定网格上消除过冲；这种违背源于几何原因。\n$K_{12}$ 的正性是网格三角形中存在钝角的直接结果，这是一个纯粹的几何属性。如前所示，系统矩阵的非对角元为 $A_{12} = M_{12} + \\Delta t\\,K_{12}$。由于 $M_{12}$（无论是一致质量矩阵还是集中质量矩阵）和 $K_{12}$ 都是非负的，且至少 $K_{12}$ 是严格为正的，因此对于任何 $\\Delta t > 0$，$A_{12}$ 都是严格为正的。减小 $\\Delta t$ 会缩小 $\\Delta t K_{12}$ 项的大小，但不会改变其符号。对于所有 $\\Delta t >0$，M-矩阵条件仍然被违反。根本原因是网格几何形状，而不是时间步长的大小。\n**结论：正确。**\n\nD. 通过适当的边翻转，将网格重构为锐角或Delaunay三角剖分，可以恢复刚度矩阵的非正非对角元和离散最大值原理所需的单调性。\n从共享边 $(i,j)$ 的三角形组装的非对角项 $K_{ij}$ 是非正的（$K_{ij} \\le 0$），当且仅当该边对角的余切值之和为非负。这个条件等价于要求对角之和小于或等于 $\\pi$（$180^\\circ$），这正是该边的Delaunay条件。对所有内部边都满足此条件的三角剖分就是Delaunay三角剖分。创建一个完全由锐角（或非钝角）三角形组成的网格是一个更严格的条件，它同样能保证对所有 $i \\ne j$ 都有 $K_{ij} \\le 0$。因此，通过重构网格以满足Delaunay条件或非钝角条件，将确保所有非对角刚度项均为非正。这恢复了系统矩阵的M-矩阵性质（配合适当的质量矩阵，如集中质量矩阵），从而恢复了离散最大值原理。\n**结论：正确。**", "answer": "$$\\boxed{ACD}$$", "id": "3594914"}, {"introduction": "除了网格几何形状，有限元模拟的精度也对数值积分等实施选择很敏感。本问题研究了使用降阶积分法则计算质量矩阵所带来的影响，这是一种为节省计算成本而常用的技术 [@problem_id:3594966]。您将使用离散傅里叶分析，推导由这种近似引起的精确谱失真，从而深入了解积分误差是如何传播到离散系统的动力学特性中的。", "problem": "考虑一个代表岩石圈横断面的均匀介质中的一维热扩散问题，其边界条件为周期性的。其控制方程为定义在域 $x \\in [0,L]$ 上的抛物型偏微分方程 $u_{t} = \\kappa u_{xx}$，其中 $\\kappa0$ 是一个常数。设 $V_{h}$ 是在一个包含 $N$ 个尺寸为 $h=L/N$ 的单元的均匀网格上的连续分段线性函数空间。标准的 Galerkin 半离散化方法得到矩阵常微分方程 $M \\dot{\\mathbf{u}} + K \\mathbf{u} = \\mathbf{0}$，其中质量矩阵 $M$ 和刚度矩阵 $K$ 的元素分别为 $M_{ij} = \\int_{0}^{L} \\phi_{i} \\phi_{j} \\, \\mathrm{d}x$ 和 $K_{ij} = \\kappa \\int_{0}^{L} \\phi_{i}' \\phi_{j}' \\, \\mathrm{d}x$，$\\{\\phi_{i}\\}$ 表示标准帽状基函数。\n\n定义离散扩散算子 $A = M^{-1}K$ 并假设边界条件为周期性的，因此离散傅里叶模态是由均匀组装产生的循环矩阵的特征向量。假设 $K$ 是精确积分的。考虑 $M$ 的两种选择：精确积分的质量矩阵 $M^{\\mathrm{ex}}$ 和通过每个单元中心的一个 Gauss 点计算的减缩积分质量矩阵 $M^{\\mathrm{ri}}$。\n\n仅使用 Galerkin 方法的基本定义、均匀网格上的单元组装以及循环矩阵的离散傅里叶分析，推导算子 $A$ 对应于无量纲波数 $\\theta \\in (0,\\pi)$ 的特征值 $\\lambda^{\\mathrm{ex}}(\\theta)$ 和 $\\lambda^{\\mathrm{ri}}(\\theta)$ 的精确表达式，其中 $\\theta = 2\\pi m/N$，$m$ 为整数 $m \\in \\{1,2,\\dots,N-1\\}$，且当 $N$ 为偶数时 $m \\neq N/2$。由此，确定精确的乘性畸变因子\n$$\nR(\\theta) = \\frac{\\lambda^{\\mathrm{ri}}(\\theta)}{\\lambda^{\\mathrm{ex}}(\\theta)}\n$$\n该因子分离了质量矩阵中由求积引起的相容性误差对离散扩散算子特征值的影响。以仅含 $\\theta$ 的闭式解析表达式给出 $R(\\theta)$。无需进行数值近似或舍入。将最终答案表示为无单位的精确符号表达式。", "solution": "该问题是有效的，因为它在科学上基于偏微分方程的数值分析，是适定的、客观的，并包含了获得唯一解所需的所有信息。\n\n该问题要求在质量矩阵 $M$ 的两种不同选择下，离散扩散算子 $A = M^{-1}K$ 的特征值的比率。离散化是在具有 $N$ 个尺寸为 $h = L/N$ 的单元的均匀网格上，并采用周期性边界条件。这种设置确保了全局刚度矩阵 $K$ 和两种质量矩阵（$M^{\\mathrm{ex}}$ 用于精确积分，$M^{\\mathrm{ri}}$ 用于减缩积分）都是循环矩阵。\n\n循环矩阵的一个基本性质是它们可以被离散傅里叶变换对角化。这意味着它们共享同一组特征向量，即离散傅里叶模态 $\\mathbf{v}_m$，其分量为 $(\\mathbf{v}_m)_j = \\exp(i j \\theta)$，其中 $\\theta = 2\\pi m / N$ 是模态 $m$ 的无量纲波数。如果 $\\hat{K}(\\theta)$ 和 $\\hat{M}(\\theta)$ 分别是 $K$ 和 $M$ 对应于波数 $\\theta$ 的特征向量的特征值，那么算子 $A = M^{-1}K$ 的特征值 $\\lambda(\\theta)$ 就由这些特征值的比率给出：\n$$\nA \\mathbf{v} = M^{-1}K \\mathbf{v} = M^{-1}(\\hat{K}(\\theta)\\mathbf{v}) = \\hat{K}(\\theta) M^{-1}\\mathbf{v} = \\hat{K}(\\theta) \\frac{1}{\\hat{M}(\\theta)} \\mathbf{v} = \\frac{\\hat{K}(\\theta)}{\\hat{M}(\\theta)} \\mathbf{v}\n$$\n因此，$\\lambda(\\theta) = \\frac{\\hat{K}(\\theta)}{\\hat{M}(\\theta)}$。\n\n离散扩散算子的两组特征值为：\n$$\n\\lambda^{\\mathrm{ex}}(\\theta) = \\frac{\\hat{K}(\\theta)}{\\hat{M}^{\\mathrm{ex}}(\\theta)} \\quad \\text{和} \\quad \\lambda^{\\mathrm{ri}}(\\theta) = \\frac{\\hat{K}(\\theta)}{\\hat{M}^{\\mathrm{ri}}(\\theta)}\n$$\n所要求的畸变因子 $R(\\theta)$ 是它们的比率：\n$$\nR(\\theta) = \\frac{\\lambda^{\\mathrm{ri}}(\\theta)}{\\lambda^{\\mathrm{ex}}(\\theta)} = \\frac{\\hat{K}(\\theta) / \\hat{M}^{\\mathrm{ri}}(\\theta)}{\\hat{K}(\\theta) / \\hat{M}^{\\mathrm{ex}}(\\theta)} = \\frac{\\hat{M}^{\\mathrm{ex}}(\\theta)}{\\hat{M}^{\\mathrm{ri}}(\\theta)}\n$$\n这个结果极大地简化了问题，因为它表明刚度矩阵的性质相互抵消了，我们只需要比较两个质量矩阵的特征值。为了完整起见，根据题目要求，我们将在计算最终比率之前，推导所有三个矩阵（$K$、$M^{\\mathrm{ex}}$、$M^{\\mathrm{ri}}$）的特征值。\n\n首先，我们计算一个长度为 $h$ 的一般单元 $[x_j, x_{j+1}]$ 的单元矩阵。局部基函数是线性的“帽状”函数，在该单元上为 $n_j(x) = (x_{j+1}-x)/h$ 和 $n_{j+1}(x) = (x-x_j)/h$。它们的导数是 $n_j'(x) = -1/h$ 和 $n_{j+1}'(x) = 1/h$。\n\n单元刚度矩阵 $K^e$ 的元素为 $K^e_{ab} = \\int_{x_j}^{x_{j+1}} \\kappa \\, n'_a(x) n'_b(x) \\, \\mathrm{d}x$：\n$K^e_{11} = \\int_{x_j}^{x_{j+1}} \\kappa (-\\frac{1}{h})^2 \\, \\mathrm{d}x = \\frac{\\kappa}{h^2} h = \\frac{\\kappa}{h}$。\n$K^e_{12} = \\int_{x_j}^{x_{j+1}} \\kappa (-\\frac{1}{h})(\\frac{1}{h}) \\, \\mathrm{d}x = -\\frac{\\kappa}{h}$。\n根据对称性，$K^e_{21} = -\\frac{\\kappa}{h}$ 且 $K^e_{22} = \\frac{\\kappa}{h}$。\n$$\nK^e = \\frac{\\kappa}{h} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}\n$$\n\n精确积分的单元质量矩阵 $M^{e, \\mathrm{ex}}$ 的元素为 $M^{e, \\mathrm{ex}}_{ab} = \\int_{x_j}^{x_{j+1}} n_a(x) n_b(x) \\, \\mathrm{d}x$：\n$M^{e, \\mathrm{ex}}_{11} = \\int_{x_j}^{x_{j+1}} \\left(\\frac{x_{j+1}-x}{h}\\right)^2 \\, \\mathrm{d}x = \\frac{h}{3}$。\n$M^{e, \\mathrm{ex}}_{12} = \\int_{x_j}^{x_{j+1}} \\left(\\frac{x_{j+1}-x}{h}\\right)\\left(\\frac{x-x_j}{h}\\right) \\, \\mathrm{d}x = \\frac{h}{6}$。\n根据对称性，$M^{e, \\mathrm{ex}}_{21} = \\frac{h}{6}$ 且 $M^{e, \\mathrm{ex}}_{22} = \\frac{h}{3}$。\n$$\nM^{e, \\mathrm{ex}} = \\frac{h}{6} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix}\n$$\n\n减缩积分单元质量矩阵 $M^{e, \\mathrm{ri}}$ 是使用位于单元中心 $x_c = (x_j+x_{j+1})/2$ 的单个 Gauss 点计算的。求积法则是 $\\int_{x_j}^{x_{j+1}} f(x) \\, \\mathrm{d}x \\approx h f(x_c)$。被积函数是 $n_a(x)n_b(x)$。在 $x_c$ 处，我们有 $n_j(x_c) = 1/2$ 和 $n_{j+1}(x_c) = 1/2$。\n$M^{e, \\mathrm{ri}}_{11} \\approx h \\cdot n_j(x_c) \\cdot n_j(x_c) = h(\\frac{1}{2})(\\frac{1}{2}) = \\frac{h}{4}$。\n$M^{e, \\mathrm{ri}}_{12} \\approx h \\cdot n_j(x_c) \\cdot n_{j+1}(x_c) = h(\\frac{1}{2})(\\frac{1}{2}) = \\frac{h}{4}$。\n根据对称性，$M^{e, \\mathrm{ri}}_{21} = M^{e, \\mathrm{ri}}_{22} = \\frac{h}{4}$。\n$$\nM^{e, \\mathrm{ri}} = \\frac{h}{4} \\begin{pmatrix} 1  1 \\\\ 1  1 \\end{pmatrix}\n$$\n\n接下来，我们组装全局矩阵。对于一个一般节点 $i$，全局矩阵 $C$ 的对角元素 $C_{ii}$ 是来自左侧单元 $[x_{i-1}, x_i]$ 的局部 $C^e_{22}$ 和来自右侧单元 $[x_i, x_{i+1}]$ 的局部 $C^e_{11}$ 之和。非对角元素 $C_{i, i+1}$ 是来自单元 $[x_i, x_{i+1}]$ 的局部 $C^e_{12}$。这种结构产生一个由模板 $(c_1, c_0, c_1)$ 定义的对称三对角循环矩阵，其中 $c_0$ 是主对角元素，$c_1$ 是非对角元素。\n$c_0(C) = C^e_{11} + C^e_{22}$，$c_1(C) = C^e_{12}$。\n\n$K$ 的模板：$c_0 = \\frac{\\kappa}{h} + \\frac{\\kappa}{h} = \\frac{2\\kappa}{h}$，$c_1 = -\\frac{\\kappa}{h}$。模板：$\\frac{\\kappa}{h}(-1, 2, -1)$。\n$M^{\\mathrm{ex}}$ 的模板：$c_0 = \\frac{2h}{6} + \\frac{2h}{6} = \\frac{4h}{6}$，$c_1 = \\frac{h}{6}$。模板：$\\frac{h}{6}(1, 4, 1)$。\n$M^{\\mathrm{ri}}$ 的模板：$c_0 = \\frac{h}{4} + \\frac{h}{4} = \\frac{2h}{4}$，$c_1 = \\frac{h}{4}$。模板：$\\frac{h}{4}(1, 2, 1)$。\n\n具有模板 $(c_1, c_0, c_1)$ 的对称循环矩阵的特征值为 $\\hat{C}(\\theta) = c_0 + 2c_1\\cos(\\theta)$。\n使用这个公式，我们找到我们矩阵的特征值：\n$\\hat{K}(\\theta) = \\frac{2\\kappa}{h} + 2(-\\frac{\\kappa}{h})\\cos(\\theta) = \\frac{2\\kappa}{h}(1 - \\cos(\\theta)) = \\frac{4\\kappa}{h}\\sin^2(\\frac{\\theta}{2})$。\n$\\hat{M}^{\\mathrm{ex}}(\\theta) = \\frac{4h}{6} + 2(\\frac{h}{6})\\cos(\\theta) = \\frac{h}{3}(2 + \\cos(\\theta))$。\n$\\hat{M}^{\\mathrm{ri}}(\\theta) = \\frac{2h}{4} + 2(\\frac{h}{4})\\cos(\\theta) = \\frac{h}{2}(1 + \\cos(\\theta))$。\n\n现在我们可以写出 $\\lambda^{\\mathrm{ex}}(\\theta)$ 和 $\\lambda^{\\mathrm{ri}}(\\theta)$ 的表达式：\n$$\n\\lambda^{\\mathrm{ex}}(\\theta) = \\frac{\\hat{K}(\\theta)}{\\hat{M}^{\\mathrm{ex}}(\\theta)} = \\frac{\\frac{2\\kappa}{h}(1 - \\cos(\\theta))}{\\frac{h}{3}(2 + \\cos(\\theta))} = \\frac{6\\kappa}{h^2}\\frac{1 - \\cos(\\theta)}{2 + \\cos(\\theta)}\n$$\n$$\n\\lambda^{\\mathrm{ri}}(\\theta) = \\frac{\\hat{K}(\\theta)}{\\hat{M}^{\\mathrm{ri}}(\\theta)} = \\frac{\\frac{2\\kappa}{h}(1 - \\cos(\\theta))}{\\frac{h}{2}(1 + \\cos(\\theta))} = \\frac{4\\kappa}{h^2}\\frac{1 - \\cos(\\theta)}{1 + \\cos(\\theta)}\n$$\n最后，我们计算畸变因子 $R(\\theta)$：\n$$\nR(\\theta) = \\frac{\\lambda^{\\mathrm{ri}}(\\theta)}{\\lambda^{\\mathrm{ex}}(\\theta)} = \\frac{\\frac{4\\kappa}{h^2}\\frac{1 - \\cos(\\theta)}{1 + \\cos(\\theta)}}{\\frac{6\\kappa}{h^2}\\frac{1 - \\cos(\\theta)}{2 + \\cos(\\theta)}} = \\frac{4}{6} \\frac{2 + \\cos(\\theta)}{1 + \\cos(\\theta)}\n$$\n化简常数项后得到畸变因子的最终表达式：\n$$\nR(\\theta) = \\frac{2}{3} \\frac{2 + \\cos(\\theta)}{1 + \\cos(\\theta)}\n$$\n此表达式按要求仅是 $\\theta$ 的函数，分离了由质量矩阵中的求积误差引起的谱畸变。对于指定范围 $\\theta \\in (0, \\pi)$，分母 $1+\\cos(\\theta)$ 不为零。", "answer": "$$\n\\boxed{\\frac{2(2+\\cos(\\theta))}{3(1+\\cos(\\theta))}}\n$$", "id": "3594966"}, {"introduction": "超越传统的时间步进格式，时空有限元方法为处理复杂的时间行为和实现时间并行计算提供了强大的功能。本练习要求您为一个时间上采用间断Galerkin (dG) 方法的系统构建其矩阵，这是一种求解抛物线问题的先进方法 [@problem_id:3594901]。通过组装这个块结构的时空矩阵，您将巩固对如何构建和实现先进的完全耦合离散化方案的理解。", "problem": "在一个有界 Lipschitz 域 $\\Omega \\subset \\mathbb{R}^{d}$（其中 $d \\in \\{2,3\\}$）中，一个均匀、各向同性地质构造内的瞬态热扩散过程由以下偏微分方程（PDE）建模：\n$$\n\\rho c \\,\\partial_{t} u(\\boldsymbol{x},t) - \\nabla \\cdot \\big(\\kappa \\nabla u(\\boldsymbol{x},t)\\big) = s(\\boldsymbol{x},t) \\quad \\text{in } \\Omega \\times (0,T],\n$$\n其边界条件为在 $\\partial \\Omega \\times (0,T]$ 上的齐次狄利克雷边界条件 $u(\\boldsymbol{x},t) = 0$，初始条件为在 $\\Omega$ 内给定的 $u(\\boldsymbol{x},0) = u_{0}(\\boldsymbol{x})$。此处，$\\rho$ 是密度，$c$ 是比热，$\\kappa$ 是热导率，$s$ 是源项，它们都被视为正的有界函数或常数，与计算地球物理学中的科学现实主义相符。使用有限元法（FEM），在 $\\Omega$ 的一个协调单纯形网格上采用分片线性（$P_{1}$）形函数，半离散空间系统可以写成如下形式：\n$$\nM \\,\\frac{\\mathrm{d}}{\\mathrm{d}t} U(t) + A \\,U(t) = F(t),\n$$\n其中 $U(t)$ 是节点值向量，$M$ 是对称正定质量矩阵，其元素为 $M_{ij} = \\int_{\\Omega} \\rho c \\,\\varphi_{i} \\varphi_{j}\\,\\mathrm{d}\\boldsymbol{x}$，$A$ 是对称半正定刚度矩阵，其元素为 $A_{ij} = \\int_{\\Omega} \\kappa \\,\\nabla \\varphi_{i} \\cdot \\nabla \\varphi_{j}\\,\\mathrm{d}\\boldsymbol{x}$，$F(t)$ 是载荷向量，其元素为 $F_{i}(t) = \\int_{\\Omega} s(\\boldsymbol{x},t)\\,\\varphi_{i}(\\boldsymbol{x})\\,\\mathrm{d}\\boldsymbol{x}$。考虑在两个连续时间区间 $I_{1} = (t_{0},t_{1}]$ 和 $I_{2} = (t_{1},t_{2}]$ 上，使用均匀时间步长 $\\Delta t = t_{n} - t_{n-1}$ 的 1 阶间断 Galerkin (dG(1)) 时间离散。在每个区间 $I_{n}$ 上，用以下方式近似 $U(t)$：\n$$\nU_{h}(t)\\big|_{I_{n}} = U_{n,0}\\,\\psi_{0}(s) + U_{n,1}\\,\\psi_{1}(s), \\quad s = \\frac{t - t_{n-1}}{\\Delta t} \\in [0,1],\n$$\n其中 $\\psi_{0}(s) = 1 - s$ 和 $\\psi_{1}(s) = s$ 是局部时间基函数，$U_{n,0},U_{n,1}$ 是在 $I_{n}$ 上的空间系数向量。使用带有迎风界面通量的标准时间间断 Galerkin 弱形式，其中在左端点 $t_{n-1}$ 的跳跃项作为 $\\langle M [U_{h}]_{n-1}, V_{h}(t_{n-1}^{+}) \\rangle$ 包含在测试泛函中，此处 $[U_{h}]_{n-1} = U_{h}(t_{n-1}^{+}) - U_{h}(t_{n-1}^{-})$。在每个区间上，从由 $\\{\\psi_{0},\\psi_{1}\\}$ 张成的相同局部多项式空间中选取时间测试函数，并在 $I_{1}$ 和 $I_{2}$ 上进行组装，推导出全局分块时空线性系统。该系统将堆叠的未知向量 $(U_{1,0},U_{1,1},U_{2,0},U_{2,1})$ 映射到残差，且仅用空间质量矩阵 $M$、空间刚度矩阵 $A$ 和均匀时间步长 $\\Delta t$ 来表示。清楚地指出由 $I_{1}$ 和 $I_{2}$ 之间的界面耦合产生的分块带状结构。将最终答案写成一个仅含 $M$、$A$ 和 $\\Delta t$ 的单个矩阵表达式。无需进行数值舍入。", "solution": "该问题是适定的且有科学依据，为从一个半离散热方程的间断 Galerkin (dG) 时间离散中推导线性系统提供了完整的说明。我们着手进行推导。\n\n该半离散系统由以下时间上的常微分方程（ODE）给出：\n$$\nM \\,\\frac{\\mathrm{d}}{\\mathrm{d}t} U(t) + A \\,U(t) = F(t)\n$$\n我们旨在用 1 阶间断 Galerkin 方法 (dG(1)) 在两个连续的时间区间 $I_{1} = (t_{0},t_{1}]$ 和 $I_{2} = (t_{1},t_{2}]$ 上求解此系统，时间步长为均匀的 $\\Delta t = t_{n} - t_{n-1}$。题目要求的是将未知解系数映射到残差的矩阵算子，忽略源项 $F(t)$ 和初始条件 $u_0$。\n\ndG 方法的弱形式，在区间 $I_n$（其中 $n \\in \\{1,2\\}$）上求和后为：求 $U_h(t)$，使得对于所有合适的测试函数 $V_h(t)$，\n$$\n\\sum_{n=1}^{2} \\int_{I_{n}} V_h(t)^T \\left( M \\frac{\\mathrm{d}U_h}{\\mathrm{d}t} + A U_h \\right) \\mathrm{d}t + V_h(t_0^+)^T M [U_h]_{0} + V_h(t_1^+)^T M [U_h]_{1} = 0\n$$\n根据题目要求求系统算子，我们已将源项设为零。在时间 $t_{n-1}$ 的跳跃定义为 $[U_h]_{n-1} = U_h(t_{n-1}^{+}) - U_h(t_{n-1}^{-})$。对于我们的两个区间，跳跃项为 $[U_h]_{0} = U_h(t_0^+) - U_h(t_0^-)$ 和 $[U_h]_{1} = U_h(t_1^+) - U_h(t_1^-)$。\n\n在每个区间 $I_n = (t_{n-1}, t_n]$ 上，解 $U_h(t)$ 被一个时间上的线性多项式近似：\n$$\nU_{h}(t)\\big|_{I_{n}} = U_{n,0}\\,\\psi_{0}(s) + U_{n,1}\\,\\psi_{1}(s)\n$$\n其中 $s = \\frac{t - t_{n-1}}{\\Delta t} \\in [0,1]$ 是局部坐标，基函数为 $\\psi_{0}(s) = 1 - s$ 和 $\\psi_{1}(s) = s$。未知向量 $U_{n,0}$ 和 $U_{n,1}$ 分别代表区间 $I_n$ 开始和结束时的空间自由度。具体来说，$U_h(t_{n-1}^+) = U_{n,0}$ 且 $U_h(t_n^-) = U_{n,1}$。在 $I_n$ 上的时间导数是常数：\n$$\n\\frac{\\mathrm{d}U_h}{\\mathrm{d}t} = \\frac{1}{\\Delta t} \\frac{\\mathrm{d}U_h}{\\mathrm{d}s} = \\frac{1}{\\Delta t} (U_{n,1} - U_{n,0})\n$$\n测试函数 $V_h(t)$ 选自同一空间。全局未知向量为 $\\mathcal{U} = (U_{1,0}, U_{1,1}, U_{2,0}, U_{2,1})^T$。我们通过对测试空间的基进行测试来推导该系统。该空间由仅在单个区间 $I_n$ 上非零且为局部基函数 $\\psi_k(s)$ 之一的函数张成。\n\n我们定义变量替换 $t = t_{n-1} + s \\Delta t$，因此 $\\mathrm{d}t = \\Delta t \\mathrm{d}s$。在单个区间 $I_n$ 上，对于测试函数 $V_h(t) = W \\psi_k(s)$（其中 $W$ 是任意空间系数向量），弱形式变为：\n$$\n\\int_{0}^{1} W^T \\psi_k(s) \\left( M \\frac{U_{n,1}-U_{n,0}}{\\Delta t} + A (U_{n,0}\\psi_0(s) + U_{n,1}\\psi_1(s)) \\right) \\Delta t \\mathrm{d}s + W^T \\psi_k(0) M (U_{n,0} - U_{n-1,1}) = 0\n$$\n由于这对任意 $W$ 都成立，我们可以用向量未知数来写出该方程：\n$$\n\\int_{0}^{1} \\psi_k(s) \\left( M(U_{n,1}-U_{n,0}) + \\Delta t A (U_{n,0}\\psi_0(s) + U_{n,1}\\psi_1(s)) \\right) \\mathrm{d}s + \\psi_k(0) M (U_{n,0} - U_{n-1,1}) = 0\n$$\n注意 $U_{h}(t_{n-1}^{-}) = U_{n-1,1}$。项 $U_{0,1}$ 对应于初始条件 $U_h(t_0^-) = u_0(\\boldsymbol{x})$，该项被移到等式右边，不构成系统矩阵的一部分。\n\n我们需要以下时间基函数在 $[0,1]$ 上的积分：\n$$\n\\int_0^1 \\psi_0(s) \\mathrm{d}s = \\frac{1}{2}, \\quad \\int_0^1 \\psi_1(s) \\mathrm{d}s = \\frac{1}{2}\n$$\n$$\n\\int_0^1 \\psi_0(s)^2 \\mathrm{d}s = \\frac{1}{3}, \\quad \\int_0^1 \\psi_1(s)^2 \\mathrm{d}s = \\frac{1}{3}, \\quad \\int_0^1 \\psi_0(s)\\psi_1(s) \\mathrm{d}s = \\frac{1}{6}\n$$\n\n我们通过在 $I_1$ 和 $I_2$ 上用 $\\psi_0$ 和 $\\psi_1$ 进行测试，生成四个方程。\n\n1. 在 $I_1$ 上用 $\\psi_0(s)$ 测试：$n=1$, $k=0$。此处 $\\psi_0(0)=1$ 且 $U_{0,1} = U_h(t_0^-)$ 是初始条件。\n$$\nM(U_{1,1}-U_{1,0})\\int_0^1\\psi_0 \\mathrm{d}s + \\Delta t A(U_{1,0}\\int_0^1\\psi_0^2 \\mathrm{d}s + U_{1,1}\\int_0^1\\psi_0\\psi_1 \\mathrm{d}s) + M(U_{1,0}-U_h(t_0^-)) = 0\n$$\n$$\n\\frac{1}{2}M(U_{1,1}-U_{1,0}) + \\Delta t A(\\frac{1}{3}U_{1,0} + \\frac{1}{6}U_{1,1}) + M U_{1,0} = M U_h(t_0^-)\n$$\n合并未知数的项，得到第一个分块行：\n$$\n(\\frac{1}{2}M + \\frac{1}{3}\\Delta t A)U_{1,0} + (\\frac{1}{2}M + \\frac{1}{6}\\Delta t A)U_{1,1} = M U_h(t_0^-)\n$$\n\n2. 在 $I_1$ 上用 $\\psi_1(s)$ 测试：$n=1$, $k=1$。此处 $\\psi_1(0)=0$。\n$$\nM(U_{1,1}-U_{1,0})\\int_0^1\\psi_1 \\mathrm{d}s + \\Delta t A(U_{1,0}\\int_0^1\\psi_1\\psi_0 \\mathrm{d}s + U_{1,1}\\int_0^1\\psi_1^2 \\mathrm{d}s) = 0\n$$\n$$\n\\frac{1}{2}M(U_{1,1}-U_{1,0}) + \\Delta t A(\\frac{1}{6}U_{1,0} + \\frac{1}{3}U_{1,1}) = 0\n$$\n合并项得到第二个分块行：\n$$\n(-\\frac{1}{2}M + \\frac{1}{6}\\Delta t A)U_{1,0} + (\\frac{1}{2}M + \\frac{1}{3}\\Delta t A)U_{1,1} = 0\n$$\n\n3. 在 $I_2$ 上用 $\\psi_0(s)$ 测试：$n=2$, $k=0$。此处 $\\psi_0(0)=1$ 且 $U_{1,1} = U_h(t_1^-)$。\n$$\nM(U_{2,1}-U_{2,0})\\int_0^1\\psi_0 \\mathrm{d}s + \\Delta t A(U_{2,0}\\int_0^1\\psi_0^2 \\mathrm{d}s + U_{2,1}\\int_0^1\\psi_0\\psi_1 \\mathrm{d}s) + M(U_{2,0}-U_{1,1}) = 0\n$$\n$$\n\\frac{1}{2}M(U_{2,1}-U_{2,0}) + \\Delta t A(\\frac{1}{3}U_{2,0} + \\frac{1}{6}U_{2,1}) + M U_{2,0} - M U_{1,1} = 0\n$$\n合并所有未知数的项，得到全局系统的第三个分块行：\n$$\n-M U_{1,1} + (\\frac{1}{2}M + \\frac{1}{3}\\Delta t A)U_{2,0} + (\\frac{1}{2}M + \\frac{1}{6}\\Delta t A)U_{2,1} = 0\n$$\n\n4. 在 $I_2$ 上用 $\\psi_1(s)$ 测试：$n=2$, $k=1$。此处 $\\psi_1(0)=0$。\n$$\nM(U_{2,1}-U_{2,0})\\int_0^1\\psi_1 \\mathrm{d}s + \\Delta t A(U_{2,0}\\int_0^1\\psi_1\\psi_0 \\mathrm{d}s + U_{2,1}\\int_0^1\\psi_1^2 \\mathrm{d}s) = 0\n$$\n$$\n\\frac{1}{2}M(U_{2,1}-U_{2,0}) + \\Delta t A(\\frac{1}{6}U_{2,0} + \\frac{1}{3}U_{2,1}) = 0\n$$\n合并项得到第四个分块行：\n$$\n(-\\frac{1}{2}M + \\frac{1}{6}\\Delta t A)U_{2,0} + (\\frac{1}{2}M + \\frac{1}{3}\\Delta t A)U_{2,1} = 0\n$$\n\n将这四个方程组装成一个针对未知向量 $(U_{1,0}, U_{1,1}, U_{2,0}, U_{2,1})^T$ 的单一矩阵系统，即可得到所要求的分块时空矩阵。该矩阵将未知向量映射到残差，残差中包含来自初始条件和源项的项（此处除初始条件外均设为零，而初始条件本身不影响该矩阵）。得到的 $4 \\times 4$ 分块矩阵为：\n$$\n\\begin{pmatrix}\n\\frac{1}{2}M + \\frac{1}{3}\\Delta t A  \\frac{1}{2}M + \\frac{1}{6}\\Delta t A  0  0 \\\\\n-\\frac{1}{2}M + \\frac{1}{6}\\Delta t A  \\frac{1}{2}M + \\frac{1}{3}\\Delta t A  0  0 \\\\\n0  -M  \\frac{1}{2}M + \\frac{1}{3}\\Delta t A  \\frac{1}{2}M + \\frac{1}{6}\\Delta t A \\\\\n0  0  -\\frac{1}{2}M + \\frac{1}{6}\\Delta t A  \\frac{1}{2}M + \\frac{1}{3}\\Delta t A\n\\end{pmatrix}\n$$\n该矩阵具有明显的分块带状结构。两个对角线上的 $2 \\times 2$ 分块代表了 $I_1$ 和 $I_2$ 的区间内耦合，而非对角块 $-M$ 则代表了在时间界面 $t_1$ 处由迎风通量项产生的区间间耦合。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{2}M + \\frac{1}{3}\\Delta t A  \\frac{1}{2}M + \\frac{1}{6}\\Delta t A  0  0 \\\\\n-\\frac{1}{2}M + \\frac{1}{6}\\Delta t A  \\frac{1}{2}M + \\frac{1}{3}\\Delta t A  0  0 \\\\\n0  -M  \\frac{1}{2}M + \\frac{1}{3}\\Delta t A  \\frac{1}{2}M + \\frac{1}{6}\\Delta t A \\\\\n0  0  -\\frac{1}{2}M + \\frac{1}{6}\\Delta t A  \\frac{1}{2}M + \\frac{1}{3}\\Delta t A\n\\end{pmatrix}\n}\n$$", "id": "3594901"}]}