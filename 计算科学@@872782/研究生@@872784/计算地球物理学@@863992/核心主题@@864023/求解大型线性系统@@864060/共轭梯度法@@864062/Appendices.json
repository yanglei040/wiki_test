{"hands_on_practices": [{"introduction": "在依赖现成的数值库求解问题之前，亲手计算一遍共轭梯度法的迭代过程是至关重要的。这个练习 [@problem_id:3371621] 提供了一个简单的二维线性系统。通过从头计算CG法第一次迭代中的关键量，如步长和搜索方向，你将对算法的递归关系及其运作机制建立一个具体而深刻的理解。", "problem": "考虑一个线性系统，它源于计算流体力学中椭圆算子的对称正定离散化，例如在最小控制体格式上的压力泊松方程。设矩阵为 $A=\\begin{pmatrix} 4 & 1 \\\\ 1 & 3 \\end{pmatrix}$，右端项为 $b=\\begin{pmatrix}1\\\\2\\end{pmatrix}$，初始迭代向量为 $x_{0}=\\begin{pmatrix}0\\\\0\\end{pmatrix}$。共轭梯度法（CG）是通过在克里洛夫子空间上最小化二次泛函 $\\phi(x)=\\frac{1}{2}x^{\\top}Ax-b^{\\top}x$ 来导出的，其中残差为 $r_{k}=b-Ax_{k}$，搜索方向相互 $A$-共轭，并且步长的选择使得新残差在欧几里得内积意义下与当前搜索方向正交。从这些基本原理出发，不使用任何简化公式，为给定的 $A$、$b$ 和 $x_0$ 显式计算第一步的各量：$\\alpha_{0}$、$x_{1}$、$r_{1}$ 和 $\\beta_{0}$。提供精确值，不要四舍五入。为了报告结果，将最终答案表示为行向量 $\\left(\\alpha_{0}, x_{1,1}, x_{1,2}, r_{1,1}, r_{1,2}, \\beta_{0}\\right)$，其中 $x_{1,i}$ 和 $r_{1,i}$ 分别表示 $x_1$ 和 $r_1$ 的分量。", "solution": "该问题是适定的且在科学上是合理的。它要求对给定的线性系统计算共轭梯度（CG）法的第一次迭代，从算法的基本原理出发，而不是依赖于现成的算法总结。\n\n待求解的系统是 $Ax=b$，其中矩阵 $A$ 是对称正定的（SPD）。CG方法通过最小化二次泛函 $\\phi(x) = \\frac{1}{2}x^{\\top}Ax - b^{\\top}x$ 来迭代地构造解。这个泛函的梯度是 $\\nabla\\phi(x) = Ax - b$，它是残差 $r(x) = b - Ax$ 的负值。因此，最小化 $\\phi(x)$ 等价于找到满足 $\\nabla\\phi(x) = 0$ 的 $x$，这正是 $Ax=b$ 的解。\n\n给定的量是：\n矩阵 $A = \\begin{pmatrix} 4  1 \\\\ 1  3 \\end{pmatrix}$。\n右端项向量 $b = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}$。\n解的初始猜测 $x_{0} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$。\n\n共轭梯度算法对迭代 $k=0, 1, 2, ...$ 按如下步骤进行：\n1. 更新解：$x_{k+1} = x_{k} + \\alpha_{k} p_{k}$\n2. 更新残差：$r_{k+1} = r_{k} - \\alpha_{k} A p_{k}$\n3. 更新搜索方向：$p_{k+1} = r_{k+1} + \\beta_{k} p_{k}$\n\n参数 $\\alpha_k$ 和 $\\beta_k$ 是从核心原理推导出来的。\n\n**第0步：初始化**\n\n首先，我们根据初始猜测 $x_0$ 计算初始残差 $r_0$。\n$$r_{0} = b - Ax_{0}$$\n由于 $x_0 = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$，初始残差就是 $b$：\n$$r_{0} = b = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}$$\n第一个搜索方向 $p_0$ 被选为最速下降方向，即初始残差：\n$$p_{0} = r_{0} = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}$$\n\n**第1步：第一次迭代 ($k=0$)**\n\n我们需要计算 $\\alpha_{0}$、$x_{1}$、$r_{1}$ 和 $\\beta_{0}$。\n\n**计算步长 $\\alpha_{0}$**\n选择步长 $\\alpha_{0}$ 以沿搜索方向 $p_0$ 最小化 $\\phi(x_{1}) = \\phi(x_{0} + \\alpha_{0} p_{0})$。当新残差 $r_1$ 与当前搜索方向 $p_0$ 正交时，即 $p_{0}^{\\top}r_{1} = 0$ 时，达到最小值。\n新残差由 $r_{1} = b - Ax_{1} = b - A(x_{0} + \\alpha_{0} p_{0}) = (b - Ax_{0}) - \\alpha_{0}Ap_{0} = r_0 - \\alpha_0 A p_0$ 给出。\n将此代入正交条件中：\n$$p_{0}^{\\top}(r_{0} - \\alpha_{0} A p_{0}) = 0$$\n$$p_{0}^{\\top}r_{0} - \\alpha_{0} p_{0}^{\\top}A p_{0} = 0$$\n解出 $\\alpha_0$ 得：\n$$\\alpha_{0} = \\frac{p_{0}^{\\top}r_{0}}{p_{0}^{\\top}A p_{0}}$$\n因为 $p_0 = r_0$，这变为：\n$$\\alpha_{0} = \\frac{r_{0}^{\\top}r_{0}}{r_{0}^{\\top}A r_{0}}$$\n我们计算必要的量：\n$r_{0}^{\\top}r_{0} = \\begin{pmatrix} 1  2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix} = (1)(1) + (2)(2) = 1 + 4 = 5$。\n$A p_{0} = \\begin{pmatrix} 4  1 \\\\ 1  3 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} 4(1) + 1(2) \\\\ 1(1) + 3(2) \\end{pmatrix} = \\begin{pmatrix} 6 \\\\ 7 \\end{pmatrix}$。\n$p_{0}^{\\top}A p_{0} = r_{0}^{\\top}A p_{0} = \\begin{pmatrix} 1  2 \\end{pmatrix} \\begin{pmatrix} 6 \\\\ 7 \\end{pmatrix} = (1)(6) + (2)(7) = 6 + 14 = 20$。\n代入这些值：\n$$\\alpha_{0} = \\frac{5}{20} = \\frac{1}{4}$$\n\n**计算新的迭代向量 $x_{1}$**\n新的解的估计值 $x_1$ 是通过从 $x_0$ 沿方向 $p_0$ 移动步长 $\\alpha_0$ 得到的：\n$$x_{1} = x_{0} + \\alpha_{0} p_{0} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} + \\frac{1}{4} \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{4} \\\\ \\frac{2}{4} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{4} \\\\ \\frac{1}{2} \\end{pmatrix}$$\n所以，$x_{1,1} = \\frac{1}{4}$ 且 $x_{1,2} = \\frac{1}{2}$。\n\n**计算新残差 $r_{1}$**\n新残差 $r_1$ 可以用更新公式计算：\n$$r_{1} = r_{0} - \\alpha_{0} A p_{0} = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix} - \\frac{1}{4} \\begin{pmatrix} 6 \\\\ 7 \\end{pmatrix} = \\begin{pmatrix} 1 - \\frac{6}{4} \\\\ 2 - \\frac{7}{4} \\end{pmatrix} = \\begin{pmatrix} \\frac{4}{4} - \\frac{6}{4} \\\\ \\frac{8}{4} - \\frac{7}{4} \\end{pmatrix} = \\begin{pmatrix} -\\frac{2}{4} \\\\ \\frac{1}{4} \\end{pmatrix} = \\begin{pmatrix} -\\frac{1}{2} \\\\ \\frac{1}{4} \\end{pmatrix}$$\n所以，$r_{1,1} = -\\frac{1}{2}$ 且 $r_{1,2} = \\frac{1}{4}$。\n\n**计算系数 $\\beta_{0}$**\n系数 $\\beta_0$ 用于构造下一个搜索方向 $p_1 = r_1 + \\beta_0 p_0$。基本原理是新的搜索方向 $p_1$ 必须与前一个方向 $p_0$ 是 $A$-共轭的，即 $p_{1}^{\\top}A p_{0} = 0$。\n$$(r_{1} + \\beta_{0} p_{0})^{\\top}A p_{0} = 0$$\n$$r_{1}^{\\top}A p_{0} + \\beta_{0} p_{0}^{\\top}A p_{0} = 0$$\n解出 $\\beta_0$：\n$$\\beta_{0} = -\\frac{r_{1}^{\\top}A p_{0}}{p_{0}^{\\top}A p_{0}}$$\n根据之前的计算，我们有 $A p_0 = \\begin{pmatrix} 6 \\\\ 7 \\end{pmatrix}$ 和 $p_{0}^{\\top}A p_{0} = 20$。\n我们需要计算分子：\n$r_{1}^{\\top}A p_{0} = \\begin{pmatrix} -\\frac{1}{2}  \\frac{1}{4} \\end{pmatrix} \\begin{pmatrix} 6 \\\\ 7 \\end{pmatrix} = (-\\frac{1}{2})(6) + (\\frac{1}{4})(7) = -3 + \\frac{7}{4} = -\\frac{12}{4} + \\frac{7}{4} = -\\frac{5}{4}$。\n现在我们可以计算 $\\beta_0$：\n$$\\beta_{0} = - \\frac{-\\frac{5}{4}}{20} = \\frac{5}{4 \\cdot 20} = \\frac{5}{80} = \\frac{1}{16}$$\n\n所求的量为 $\\alpha_{0} = \\frac{1}{4}$，$x_{1} = \\begin{pmatrix} \\frac{1}{4} \\\\ \\frac{1}{2} \\end{pmatrix}$，$r_{1} = \\begin{pmatrix} -\\frac{1}{2} \\\\ \\frac{1}{4} \\end{pmatrix}$ 和 $\\beta_{0} = \\frac{1}{16}$。\n最终答案被组合成指定的行向量格式 $(\\alpha_{0}, x_{1,1}, x_{1,2}, r_{1,1}, r_{1,2}, \\beta_{0})$。\n这就得到了行向量 $(\\frac{1}{4}, \\frac{1}{4}, \\frac{1}{2}, -\\frac{1}{2}, \\frac{1}{4}, \\frac{1}{16})$。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{1}{4}  \\frac{1}{4}  \\frac{1}{2}  -\\frac{1}{2}  \\frac{1}{4}  \\frac{1}{16} \\end{pmatrix}}$$", "id": "3371621"}, {"introduction": "共轭梯度法名称中的“共轭”二字，特指相对于矩阵 $A$ 的共轭性（即 $A$-共轭），这是欧几里得正交概念的一种推广。此练习 [@problem_id:3586928] 要求你验证一对向量，它们满足 $A$-共轭条件但并非欧几里得正交。这个具体的例子清晰地揭示了CG方法高效性背后的几何原理，并帮助你区分这两种重要的向量关系。", "problem": "在求解包含对称正定 (SPD) 矩阵的线性系统的共轭梯度 (CG) 方法中，要求搜索方向关于矩阵诱导的内积是共轭的。从以下基本定义出发：一个实矩阵 $A \\in \\mathbb{R}^{n \\times n}$ 是对称正定的，如果 $A^{\\top}=A$ 且对于所有非零向量 $x \\in \\mathbb{R}^{n}$ 都有 $x^{\\top} A x > 0$；两个向量 $p_{1}, p_{2} \\in \\mathbb{R}^{n}$ 是 $A$-共轭的，如果 $p_{1}^{\\top} A p_{2}=0$。请在 $\\mathbb{R}^{3}$ 中构造一个明确的例子，以证明 $A$-共轭性与欧几里得正交性是不同的概念。\n\n设\n$$\nA \\in \\mathbb{R}^{3 \\times 3}, \\quad A \\;=\\; \\begin{pmatrix}\n2  -1  0 \\\\\n-1  2  -1 \\\\\n0  -1  2\n\\end{pmatrix}, \\quad\np_{1} \\;=\\; \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix}, \\quad\np_{2} \\;=\\; \\begin{pmatrix} 1 \\\\ 0 \\\\ 1 \\end{pmatrix}.\n$$\n仅使用对称正定矩阵和内积的基本定义与性质（不调用任何特定于算法的更新公式），完成以下操作：\n\n1. 根据第一性原理验证 $A$ 是对称正定的。\n2. 通过显式计算 $p_{1}^{\\top} A p_{2}$ 来验证 $p_{1}$ 和 $p_{2}$ 是 $A$-共轭的。\n3. 通过计算 $p_{1}^{\\top} p_{2}$ 来验证 $p_{1}$ 和 $p_{2}$ 在标准欧几里得内积下不是正交的。\n\n将欧几里得内积 $p_{1}^{\\top} p_{2}$ 的精确值作为你的最终答案。将你的最终答案表示为一个精确的整数。", "solution": "问题要求在 $\\mathbb{R}^{3}$ 中明确展示，对于一个对称正定 (SPD) 矩阵 $A$，$A$-共轭的概念与标准的欧几里得正交性是不同的。为此，我们给定了一个矩阵 $A$ 和两个向量 $p_1$ 和 $p_2$。任务是验证 $A$ 确实是 SPD 矩阵，证明 $p_1$ 和 $p_2$ 是 $A$-共轭的，并证明它们在欧几里得意义下不是正交的。最终答案是计算出的欧几里得内积的值。\n\n给定的矩阵 $A \\in \\mathbb{R}^{3 \\times 3}$ 和向量 $p_1, p_2 \\in \\mathbb{R}^{3}$ 如下：\n$$\nA = \\begin{pmatrix}\n2  -1  0 \\\\\n-1  2  -1 \\\\\n0  -1  2\n\\end{pmatrix}, \\quad\np_1 = \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix}, \\quad\np_2 = \\begin{pmatrix} 1 \\\\ 0 \\\\ 1 \\end{pmatrix}.\n$$\n\n按要求，分析分三步进行。\n\n首先，我们验证矩阵 $A$ 是对称正定 (SPD) 的。\n如果 $A = A^{\\top}$，则矩阵是对称的。通过观察 $A$，对于所有的 $i, j \\in \\{1, 2, 3\\}$，第 $i$ 行第 $j$ 列的元素都等于第 $j$ 行第 $i$ 列的元素。具体来说，$A_{12} = A_{21} = -1$，$A_{13} = A_{31} = 0$，$A_{23} = A_{32} = -1$。因此，$A$ 是对称的。\n\n如果对于所有非零向量 $x \\in \\mathbb{R}^{3}$，都有 $x^{\\top} A x > 0$，则对称矩阵 $A$ 是正定的。设 $x = \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\end{pmatrix}$ 是一个任意非零向量。我们计算二次型 $x^{\\top} A x$：\n$$\nx^{\\top} A x = \\begin{pmatrix} x_1  x_2  x_3 \\end{pmatrix} \\begin{pmatrix}\n2  -1  0 \\\\\n-1  2  -1 \\\\\n0  -1  2\n\\end{pmatrix} \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\end{pmatrix}\n$$\n$$\n= \\begin{pmatrix} x_1  x_2  x_3 \\end{pmatrix} \\begin{pmatrix} 2x_1 - x_2 \\\\ -x_1 + 2x_2 - x_3 \\\\ -x_2 + 2x_3 \\end{pmatrix}\n$$\n$$\n= x_1(2x_1 - x_2) + x_2(-x_1 + 2x_2 - x_3) + x_3(-x_2 + 2x_3)\n$$\n$$\n= 2x_1^2 - x_1x_2 - x_1x_2 + 2x_2^2 - x_2x_3 - x_2x_3 + 2x_3^2\n$$\n$$\n= 2x_1^2 - 2x_1x_2 + 2x_2^2 - 2x_2x_3 + 2x_3^2\n$$\n为了证明这个表达式是正的，我们可以通过配方法重新排列各项：\n$$\nx^{\\top} A x = (x_1^2 - 2x_1x_2 + x_2^2) + x_1^2 + (x_2^2 - 2x_2x_3 + x_3^2) + x_3^2\n$$\n$$\n= x_1^2 + (x_1 - x_2)^2 + (x_2 - x_3)^2 + x_3^2\n$$\n这个表达式是实数的平方和，所以它总是非负的。它等于零当且仅当和中的每一项都为零：$x_1^2=0$，$(x_1 - x_2)^2=0$，$(x_2 - x_3)^2=0$，以及 $x_3^2=0$。这要求 $x_1=0$，$x_3=0$，$x_1=x_2$，以及 $x_2=x_3$。综合来看，这些条件意味着 $x_1=x_2=x_3=0$，即 $x$ 是零向量。因此，对于任何非零向量 $x$，我们有 $x^{\\top} A x > 0$。由于 $A$ 既是对称的又是正定的，所以它是一个 SPD 矩阵。\n\n其次，我们验证向量 $p_1$ 和 $p_2$ 是 $A$-共轭的。如果两个向量 $p_1, p_2$ 的 $A$-内积为零，即 $p_1^{\\top} A p_2 = 0$，则它们是 $A$-共轭的。我们显式地计算这个值：\n$$\np_1^{\\top} A p_2 = \\begin{pmatrix} 1  1  0 \\end{pmatrix} \\begin{pmatrix}\n2  -1  0 \\\\\n-1  2  -1 \\\\\n0  -1  2\n\\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ 1 \\end{pmatrix}\n$$\n我们可以先计算矩阵-向量乘积 $A p_2$：\n$$\nA p_2 = \\begin{pmatrix}\n2  -1  0 \\\\\n-1  2  -1 \\\\\n0  -1  2\n\\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 2(1) - 1(0) + 0(1) \\\\ -1(1) + 2(0) - 1(1) \\\\ 0(1) - 1(0) + 2(1) \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ -2 \\\\ 2 \\end{pmatrix}\n$$\n现在，我们计算 $p_1^{\\top}$ 与这个结果的点积：\n$$\np_1^{\\top} (A p_2) = \\begin{pmatrix} 1  1  0 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ -2 \\\\ 2 \\end{pmatrix} = 1(2) + 1(-2) + 0(2) = 2 - 2 + 0 = 0\n$$\n由于 $p_1^{\\top} A p_2 = 0$，向量 $p_1$ 和 $p_2$ 确实是 $A$-共轭的。\n\n第三，我们验证 $p_1$ 和 $p_2$ 在标准欧几里得内积下不是正交的。如果两个向量的标准内积（点积）为零，则它们是正交的。$p_1$ 和 $p_2$ 的内积由 $p_1^{\\top} p_2$ 给出：\n$$\np_1^{\\top} p_2 = \\begin{pmatrix} 1  1  0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ 1 \\end{pmatrix} = 1(1) + 1(0) + 0(1) = 1 + 0 + 0 = 1\n$$\n由于 $p_1^{\\top} p_2 = 1 \\neq 0$，向量 $p_1$ 和 $p_2$ 在欧几里得意义下不是正交的。\n\n这样就完成了证明：我们找到了一对向量，它们关于给定的 SPD 矩阵 $A$ 是 $A$-共轭的，但关于标准欧几里得内积不是正交的。这个欧几里得内积的值是 $1$。", "answer": "$$\\boxed{1}$$", "id": "3586928"}, {"introduction": "共轭梯度法的收敛性和单调下降等优良性质，严格依赖于其作用矩阵的对称正定（SPD）特性。但如果这一核心前提不成立会发生什么？这个练习 [@problem_id:3586875] 通过一个精心构造的非SPD矩阵的例子，引导你分析CG法可能遇到的典型失败模式，例如因分母为零导致的算法崩溃。这有助于你深刻理解为何SPD性质是CG方法成功的基石。", "problem": "考虑使用共轭梯度 (CG) 法，通过沿搜索方向迭代地最小化二次型 $q(x) = \\tfrac{1}{2} x^\\top A x - b^\\top x$ 来求解线性系统 $A x = b$。共轭梯度 (CG) 法的经典有限终止性和单调下降性要求 $A$ 是对称正定 (SPD) 矩阵。在精确算术中，第 $k$ 次迭代的步长 $\\alpha_k$ 是通过选择 $\\alpha$ 使得 $q(x_k + \\alpha p_k)$ 关于 $\\alpha$ 取驻值来获得的，其中 $p_k$ 是搜索方向。对于 SPD 矩阵 $A$，曲率 $p_k^\\top A p_k$ 是严格为正的，确保了驻点是沿该直线的极小值点；对于非 SPD 矩阵 $A$，$p_k^\\top A p_k$ 可能为非正值。\n\n在精确算术下进行计算。设\n$$\nA = \\begin{bmatrix}\n1  0 \\\\\n0  -1\n\\end{bmatrix}, \\quad x_0 = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}.\n$$\n考虑两个右端项\n$$\nb^{(1)} = \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}, \\qquad b^{(2)} = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}.\n$$\n在这两种情况下，初始残差为 $r_0 = b - A x_0 = b$，初始搜索方向为 $p_0 = r_0$。\n\n仅使用第一性原理（$q(x)$ 的定义以及 $\\alpha_0$ 的选择是为了使 $q(x_0 + \\alpha p_0)$ 关于 $\\alpha$ 取驻值这一事实），分析对于 $b^{(1)}$ 和 $b^{(2)}$ 的 $p_0^\\top A p_0$ 以及 $\\alpha_0$ 的符号或可定义性，然后确定以下关于共轭梯度 (CG) 法为何及如何对非 SPD 矩阵 $A$ 失效的陈述中哪些是正确的；选择所有适用项。\n\nA. 存在对称不定矩阵 $A$ 和初始残差 $r_0 \\neq 0$，使得 $p_0^\\top A p_0 = 0$，导致 $\\alpha_0$ 未定义（除以0）并立即失效。上面使用 $b^{(1)}$ 的具体数据就是这样一个例子。\n\nB. 对于任何对称不定矩阵 $A$ 和任何非零 $r_0$，必定有 $p_0^\\top A p_0  0$，因此总是有 $\\alpha_0  0$；不会发生 $\\alpha_0$ 未定义意义上的立即失效。\n\nC. 如果在某次迭代 $k$ 中有 $p_k^\\top A p_k  0$，那么 $q(x_k + \\alpha p_k)$ 的驻点出现在一个负的 $\\alpha_k$ 处，并且是沿该直线的极大值点，因此共轭梯度 (CG) 法通常的下降性和单调递减保证会失效，尽管在特殊情况下迭代仍可能收敛。\n\nD. 如果在某次迭代 $k$ 中有 $p_k^\\top A p_k = 0$ 且 $r_k \\neq 0$，那么设置 $\\alpha_k = 0$ 并继续计算可以在精确算术下保持共轭梯度 (CG) 法的良定性和收敛性。\n\nE. 对于非对称矩阵 $A$，即使对所有 $k$ 都有 $p_k^\\top A p_k  0$，标准的共轭梯度 (CG) 法三项递推关系也不再保证 $A$-共轭性或有限终止性；此时应使用广义最小残差 (GMRES) 法或双共轭梯度 (BiCG) 法等方法。\n\nF. 如果 $A$ 是对称不定的，但 $r_0$ 恰好完全位于由 $A$ 的正特征值对应的特征向量张成的不变子空间中，那么克里洛夫子空间将保持在该子空间内，直到收敛前对所有 $k$ 都有 $p_k^\\top A p_k  0$，并且共轭梯度 (CG) 法的表现将如同在 SPD 情况下一样，在至多 $n$ 步内收敛。", "solution": "该问题要求在使用一个具体例子和评估几个一般性陈述的基础上，分析当矩阵 $A$ 不是对称正定 (SPD) 时共轭梯度 (CG) 法的行为。\n\n首先，我们验证问题陈述的有效性。\n**第1步：提取已知条件**\n- 线性系统：$A x = b$\n- 二次泛函：$q(x) = \\tfrac{1}{2} x^\\top A x - b^\\top x$\n- 算法：共轭梯度 (CG) 法\n- 迭代步长 $\\alpha_k$ 是通过选择 $\\alpha$ 使得 $q(x_k + \\alpha p_k)$ 关于 $\\alpha$ 取驻值来获得的。\n- 算术：假设为精确算术。\n- 矩阵：$A = \\begin{bmatrix} 1  0 \\\\ 0  -1 \\end{bmatrix}$\n- 初始猜测：$x_0 = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}$\n- 右端项：$b^{(1)} = \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}$ 和 $b^{(2)} = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}$\n- 初始残差：$r_0 = b - A x_0 = b$\n- 初始搜索方向：$p_0 = r_0$\n\n**第2步：使用提取的已知条件进行验证**\n- 问题陈述具有科学依据。它正确地描述了 CG 方法、其最小化二次型的基本原理，以及其保证成功的标准条件（$A$ 是 SPD）。矩阵 $A$ 是一个有效的对称不定矩阵（特征值为 $1$ 和 $-1$）。\n- 问题是良态的。执行 CG 算法的第一步并分析其行为所需的所有信息都已提供。\n- 问题是客观的，并使用了精确的数学语言。问题设置中没有歧义或主观陈述。\n\n**第3步：结论与行动**\n问题是有效的。我们将继续进行分析。\n\n**从第一性原理推导**\n\n目标是找到使函数 $f(\\alpha) = q(x_k + \\alpha p_k)$ 取驻值的步长 $\\alpha_k$。\n$$f(\\alpha) = \\frac{1}{2}(x_k + \\alpha p_k)^\\top A (x_k + \\alpha p_k) - b^\\top(x_k + \\alpha p_k)$$\n展开此表达式，并利用 $A$ 的对称性 ($p_k^\\top A x_k = x_k^\\top A p_k$)：\n$$f(\\alpha) = \\frac{1}{2}(x_k^\\top A x_k + 2\\alpha p_k^\\top A x_k + \\alpha^2 p_k^\\top A p_k) - (b^\\top x_k + \\alpha b^\\top p_k)$$\n为了找到驻点，我们对 $\\alpha$ 求导并令结果为零：\n$$\\frac{df}{d\\alpha} = p_k^\\top A x_k + \\alpha (p_k^\\top A p_k) - b^\\top p_k = 0$$\n解出 $\\alpha$：\n$$\\alpha (p_k^\\top A p_k) = b^\\top p_k - p_k^\\top A x_k = p_k^\\top (b - A x_k)$$\n认识到 $r_k = b - A x_k$ 是第 $k$ 次迭代的残差，我们得到：\n$$\\alpha (p_k^\\top A p_k) = p_k^\\top r_k$$\n因此，步长为：\n$$\\alpha_k = \\frac{p_k^\\top r_k}{p_k^\\top A p_k}$$\n对于第一次迭代（$k=0$），给定 $x_0 = 0$，$r_0 = b$ 和 $p_0 = r_0$。公式变为：\n$$\\alpha_0 = \\frac{p_0^\\top r_0}{p_0^\\top A p_0} = \\frac{r_0^\\top r_0}{r_0^\\top A r_0}$$\n如果分母，即‘曲率’$p_k^\\top A p_k$，为零，而分子非零，则会发生失效。\n\n**情况1分析：$b = b^{(1)}$**\n- $b^{(1)} = \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}$。\n- 由于 $x_0 = 0$，所以 $r_0 = b^{(1)} = \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}$。\n- 初始搜索方向为 $p_0 = r_0 = \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}$。\n- 我们计算 $\\alpha_0$ 的分母：\n$$p_0^\\top A p_0 = \\begin{bmatrix} 1  1 \\end{bmatrix} \\begin{bmatrix} 1  0 \\\\ 0  -1 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix} = \\begin{bmatrix} 1  1 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ -1 \\end{bmatrix} = 1 \\cdot 1 + 1 \\cdot (-1) = 0$$\n- 我们计算 $\\alpha_0$ 的分子：\n$$r_0^\\top r_0 = \\begin{bmatrix} 1  1 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix} = 1^2 + 1^2 = 2$$\n- 由于 $r_0 \\neq 0$，分子非零。步长为 $\\alpha_0 = \\frac{2}{0}$，是未定义的。CG 算法因除以零而立即失效。\n\n**情况2分析：$b = b^{(2)}$**\n- $b^{(2)} = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}$。\n- $r_0 = b^{(2)} = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}$。\n- $p_0 = r_0 = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}$。\n- 我们计算 $\\alpha_0$ 的分母：\n$$p_0^\\top A p_0 = \\begin{bmatrix} 0  1 \\end{bmatrix} \\begin{bmatrix} 1  0 \\\\ 0  -1 \\end{bmatrix} \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix} = \\begin{bmatrix} 0  1 \\end{bmatrix} \\begin{bmatrix} 0 \\\\ -1 \\end{bmatrix} = 0 \\cdot 0 + 1 \\cdot (-1) = -1$$\n- 曲率 $p_0^\\top A p_0$ 是负的。\n- 我们计算 $\\alpha_0$ 的分子：\n$$r_0^\\top r_0 = \\begin{bmatrix} 0  1 \\end{bmatrix} \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix} = 0^2 + 1^2 = 1$$\n- 步长为 $\\alpha_0 = \\frac{1}{-1} = -1$。\n- 在这种情况下，$\\alpha_0$ 是良定的。然而，负曲率 $p_0^\\top A p_0 = -1$ 对 CG 的最小化性质有影响。\n\n**评估选项**\n\n**A. 存在对称不定矩阵 $A$ 和初始残差 $r_0 \\neq 0$，使得 $p_0^\\top A p_0 = 0$，导致 $\\alpha_0$ 未定义（除以0）并立即失效。上面使用 $b^{(1)}$ 的具体数据就是这样一个例子。**\n- 我们对情况1的分析直接证实了这一说法。矩阵 $A$ 是对称不定的，$r_0 = \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}$ 是非零的，我们计算出 $p_0^\\top A p_0 = 0$，导致 $\\alpha_0$ 未定义。\n- **结论：正确。**\n\n**B. 对于任何对称不定矩阵 $A$ 和任何非零 $r_0$，必定有 $p_0^\\top A p_0  0$，因此总是有 $\\alpha_0  0$；不会发生 $\\alpha_0$ 未定义意义上的立即失效。**\n- 这一说法与我们对情况1的分析直接矛盾，在情况1中，对于一个特定的对称不定矩阵 $A$ 和一个非零的 $r_0$，我们发现 $p_0^\\top A p_0 = 0$。一个不定矩阵 $A$ 拥有使得 $x^\\top A x > 0$、$x^\\top A x  0$ 和 $x^\\top A x = 0$ 的方向 $x$。因零曲率导致的失效是一种已知的失效模式。\n- **结论：不正确。**\n\n**C. 如果在某次迭代 $k$ 中有 $p_k^\\top A p_k  0$，那么 $q(x_k + \\alpha p_k)$ 的驻点出现在一个负的 $\\alpha_k$ 处，并且是沿该直线的极大值点，因此共轭梯度 (CG) 法通常的下降性和单调递减保证会失效，尽管在特殊情况下迭代仍可能收敛。**\n- 单变量函数 $f(\\alpha)$ 的驻点性质由其二阶导数决定。这里，$f(\\alpha) = q(x_k + \\alpha p_k)$，我们计算出 $\\frac{d^2f}{d\\alpha^2} = p_k^\\top A p_k$。如果 $p_k^\\top A p_k  0$，驻点是极大值点。\n- 步长为 $\\alpha_k = \\frac{r_k^\\top p_k}{p_k^\\top A p_k}$。在 CG 算法中，可以证明 $r_k^\\top p_k = r_k^\\top r_k = \\|r_k\\|_2^2 \\ge 0$。如果 $r_k \\neq 0$，分子为正。分母为负，则 $\\alpha_k$ 必定为负。\n- 采取一个沿搜索方向最大化二次型 $q(x)$ 的步长，违反了 CG 对 SPD 矩阵的基本原理，即在每一步最小化 $q(x)$。这意味着 $q(x)$ 单调递减的保证丢失了。然而，这并不绝对排除在所有情况下的收敛，但经典的性质不再得到保证。该陈述是准确的。\n- **结论：正确。**\n\n**D. 如果在某次迭代 $k$ 中有 $p_k^\\top A p_k = 0$ 且 $r_k \\neq 0$，那么设置 $\\alpha_k = 0$ 并继续计算可以在精确算术下保持共轭梯度 (CG) 法的良定性和收敛性。**\n- 如果 $p_k^\\top A p_k = 0$ 且 $r_k \\neq 0$，步长 $\\alpha_k$ 未定义。设置 $\\alpha_k=0$ 是一种临时补救措施。我们来分析其后果：\n  - $x_{k+1} = x_k + \\alpha_k p_k = x_k$。解的估计停滞不前。\n  - $r_{k+1} = r_k - \\alpha_k A p_k = r_k$。残差也停滞不前。\n- 由于残差没有减少，算法无法收敛到解（除非 $x_k$ 已经是解，但这被 $r_k \\neq 0$ 的条件排除了）。依赖于每一步误差或残差减小的 CG 的基本收敛性质被破坏了。这种策略导致停滞，而不是收敛。\n- **结论：不正确。**\n\n**E. 对于非对称矩阵 $A$，即使对所有 $k$ 都有 $p_k^\\top A p_k  0$，标准的共轭梯度 (CG) 法三项递推关系也不再保证 $A$-共轭性或有限终止性；此时应使用广义最小残差 (GMRES) 法或双共轭梯度 (BiCG) 法等方法。**\n- CG 算法的推导，包括残差的正交性（$i \\neq j$ 时 $r_i^\\top r_j=0$）和搜索方向的 $A$-共轭性（$i \\neq j$ 时 $p_i^\\top A p_j=0$），都关键地依赖于 $A$ 的对称性。当 $A \\neq A^\\top$ 时，这些性质都会丢失。\n- 因此，对于一个非对称的 $n \\times n$ 矩阵 $A$，标准 CG 算法不保证在至多 $n$ 次迭代内收敛。实际上，将 CG 应用于 $Ax=b$ 等价于求解 $\\frac{1}{2}(A+A^\\top)x=b$，这已不是原问题。\n- 诸如 GMRES（在克里洛夫子空间上最小化残差范数）和 BiCG（使用对偶“影子”残差序列来强制实施双正交条件）等方法是专门为非对称系统设计的。这个陈述是数值线性代数中一个正确且标准的知识点。\n- **结论：正确。**\n\n**F. 如果 $A$ 是对称不定的，但 $r_0$ 恰好完全位于由 $A$ 的正特征值对应的特征向量张成的不变子空间中，那么克里洛夫子空间将保持在该子空间内，直到收敛前对所有 $k$ 都有 $p_k^\\top A p_k  0$，并且共轭梯度 (CG) 法的表现将如同在 SPD 情况下一样，在至多 $n$ 步内收敛。**\n- 设 $V_+$ 是由 $A$ 的正特征值对应的特征向量张成的不变子空间。如果 $r_0 \\in V_+$，那么任何通过将 $A$ 的幂作用于 $r_0$ 形成的向量也将位于 $V_+$ 中。具体来说，对所有 $j \\ge 0$ 都有 $A^j r_0 \\in V_+$。\n- 因此，克里洛夫子空间 $\\mathcal{K}_m(A, r_0) = \\text{span}\\{r_0, A r_0, \\dots, A^{m-1}r_0\\}$ 完全包含在 $V_+$ 中。\n- CG 算法生成的所有向量，包括残差 $r_k$ 和搜索方向 $p_k$，都是这些克里洛夫子空间的元素，因此它们也位于 $V_+$ 中。\n- 矩阵 $A$ 在子空间 $V_+$ 上的限制，根据定义，是对称正定的。\n- 对于任何非零向量 $p \\in V_+$，二次型 $p^\\top A p$ 是严格为正的。由于 $p_k \\in V_+$（且在收敛前 $p_k \\neq 0$），曲率 $p_k^\\top A p_k$ 将始终为正。\n- 因此，CG 算法的执行就如同在解决一个更小的 SPD 系统上的问题。它不会遇到由非正曲率引起的失效，并将在至多 $\\text{dim}(V_+)$ 步内收敛，这个步数小于或等于 $n$。该陈述完全正确。\n- **结论：正确。**", "answer": "$$\\boxed{ACEF}$$", "id": "3586875"}]}