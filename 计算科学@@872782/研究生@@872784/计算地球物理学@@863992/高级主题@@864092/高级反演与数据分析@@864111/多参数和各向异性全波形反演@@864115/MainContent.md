## 引言
[全波形反演](@entry_id:749622)（FWI）作为一种高分辨率的地球物理成像技术，彻底改变了我们定量探测地下结构的能力。然而，传统的基于各向同性假设的FWI在面对复杂地质构造时，往往因模型过于简化而无法准确描述真实的[地震波传播](@entry_id:165726)现象。为了获得更高保真度的地下模型，发展能够同时反演多个弹性参数和各向异性特征的多参数各向异性FWI已成为必然趋势。

然而，模型复杂性的急剧增加也带来了严峻的挑战。各向异性参数的引入不仅显著增加了计算成本，更重要的是加剧了反演问题的[非线性](@entry_id:637147)，并引发了不同参数更新之间的严重“串扰”（cross-talk），使得反演过程极易陷入局部极小值或产生与地质不符的伪影。如何有效应对这些挑战，是成功实施各向异性FWI的关键知识缺口。

本文旨在系统性地填补这一缺口，为读者提供一个关于多参数各向异性FWI的全面指南。在接下来的章节中，我们将首先在 **“原理与机制”** 一章中，深入剖析[各向异性介质](@entry_id:187796)中的波动物理以及伴随状态反演的数学框架，揭示参数[串扰](@entry_id:136295)的内在机制。随后，在 **“应用与跨学科联系”** 一章中，我们将展示如何将这些理论转化为一系列先进的、稳健的反演策略，并探索FWI在[材料科学](@entry_id:152226)等领域的跨学科应用。最后，通过 **“动手实践”** 部分，读者将有机会通过具体问题加深对[数值模拟](@entry_id:137087)精度和[参数可辨识性](@entry_id:197485)等核心概念的理解。

通过这一系列由理论到实践的学习路径，本文将引导您深入掌握多参数各向异性FWI的核心思想与前沿技术。让我们首先从构建这一宏伟框架的基石——其底层的物理原理与反演机制开始。

## 原理与机制

在多参数和[各向异性全波形反演](@entry_id:746446)（FWI）中，成功的关键在于深刻理解其两大基石：描述地震波在[复杂介质](@entry_id:164088)中传播的**正演物理模型**，以及从观测数据中稳健地推断介质参数的**反演算法机制**。本章将系统地阐述这些核心原理，从[各向异性弹性](@entry_id:186771)波的基本方程出发，逐步深入到反演过程中的关键挑战，如参数间的串扰问题。

### 正演问题：[各向异性介质](@entry_id:187796)中的波传播

为了准确地反演地下介质的多个参数，我们首先必须能够精确地预测在给定模型下地震[波的传播](@entry_id:144063)行为。这要求我们建立一个基于第一性原理的、物理一致的正演模型。

#### [各向异性弹性](@entry_id:186771)波方程

在三维[线性弹性](@entry_id:166983)介质中，地震[波的传播](@entry_id:144063)由三个基本定律共同描述：[动量守恒](@entry_id:149964)、胡克定律（本构关系）和[应变-位移关系](@entry_id:173321)。在忽略体力[源项](@entry_id:269111)的情况下，这些定律共同构成了[各向异性弹性](@entry_id:186771)波方程 [@problem_id:3611585]：

1.  **[动量守恒](@entry_id:149964)（柯西运动第一定律）**: 该定律描述了作用在介质微元上的力如何改变其动量。其[微分形式](@entry_id:146747)为：
    $$
    \rho \frac{\partial^2 u_i}{\partial t^2} = \partial_j \sigma_{ij}
    $$
    其中，$\rho$ 是介质密度，$u_i$ 是[位移矢量](@entry_id:262782)的第 $i$ 个分量，$\sigma_{ij}$ 是应力张量的分量，$\partial_j$ 表示对空间坐标 $x_j$ 的偏导数。

2.  **线弹性本构关系（胡克定律）**: 该关系定义了介质内部的应力如何响应变形（应变）。对于一般的线性[各向异性介质](@entry_id:187796)，该关系由一个四阶**[刚度张量](@entry_id:176588)** $C_{ijkl}$ 描述：
    $$
    \sigma_{ij} = C_{ijkl} \epsilon_{kl}
    $$
    这里，$\epsilon_{kl}$ 是[应变张量](@entry_id:193332)的分量。

3.  **小[应变-位移关系](@entry_id:173321)**: 在地震勘探中，地震波引起的介质变形通常非常微小，应变张量可以由[位移梯度](@entry_id:165352)的对称部分来定义：
    $$
    \epsilon_{kl} = \frac{1}{2} (\partial_k u_l + \partial_l u_k)
    $$

[刚度张量](@entry_id:176588) $C_{ijkl}$ 包含了描述介质弹性特性的所有信息。在三维空间中，它最初有 $3^4 = 81$ 个分量。然而，由于[应力张量](@entry_id:148973)（$\sigma_{ij} = \sigma_{ji}$）和[应变张量](@entry_id:193332)（$\epsilon_{kl} = \epsilon_{lk}$）的对称性，以及[应变能函数](@entry_id:178435)的存在所导致的**主对称性**（$C_{ijkl} = C_{klij}$），独立的弹性常数数量在最一般的情况下（三斜对称性）减少到 21 个。这21个参数构成了[多参数反演](@entry_id:752300)所能探寻的完整弹性参数空间。

#### 介质对称性与[刚度张量](@entry_id:176588)

地质介质通常具有一定的对称性，这可以极大地简化[刚度张量](@entry_id:176588)并减少独立参数的数量 [@problem_id:3611585]。

*   **各向同性 (Isotropic) 介质**: 这是最简单的对称性，介质在所有方向上具有相同的弹性特性。其[刚度张量](@entry_id:176588)完全由两个独立的**拉梅参数** $\lambda$ 和 $\mu$ 决定：
    $$
    C_{ijkl} = \lambda \delta_{ij}\delta_{kl} + \mu(\delta_{ik}\delta_{jl}+\delta_{il}\delta_{jk})
    $$
    其中 $\delta_{ij}$ 是克罗内克符号。

*   **[横向各向同性](@entry_id:756140) (Transversely Isotropic, TI) 介质**: 此类介质具有一个旋转对称轴，而在垂直于该轴的平面内是各向同性的。这在沉积岩中非常常见，其中层理面通常构成一个[对称面](@entry_id:198308)。当[对称轴](@entry_id:177299)是垂直的时，我们称之为**垂向[横向各向同性](@entry_id:756140) (VTI)** 介质。VTI 介质的弹性特性由 5 个独立的弹性常数决定。

*   **倾斜[横向各向同性](@entry_id:756140) (Tilted Transverse Isotropy, TTI) 介质**: 当 VTI 介质的对称轴相对于[坐标系](@entry_id:156346)是倾斜的，就构成了 TTI 介质。在局部（自然）[坐标系](@entry_id:156346)中，它仍然由 5 个弹性常数描述。然而，为了在固定的[全局坐标系](@entry_id:171029)中进[行波](@entry_id:185008)场模拟，我们需要将这 5 个参数通过一个[旋转操作](@entry_id:140575)转换到[全局坐标系](@entry_id:171029)，这通常会产生一个具有更多非零分量的、但非独立的[刚度张量](@entry_id:176588)。

*   **[正交各向异性](@entry_id:196967) (Orthorhombic) 介质**: 此类介质具有三个相互正交的[对称面](@entry_id:198308)，例如由定向裂缝系统和沉积层理共同作用形成的介质。其弹性特性由 9 个独立的弹性常数描述。

#### 各向异性相速度与克里斯托夫方程

为了将抽象的[刚度张量](@entry_id:176588)与可观测的地震波速度联系起来，我们考察平面波在均匀介质中的传播。将一个[平面波解](@entry_id:195230) $u_i = A_i \exp(i(\omega t - \mathbf{k} \cdot \mathbf{x}))$（其中 $A_i$ 为[极化矢量](@entry_id:269389)，$\omega$ 为[角频率](@entry_id:261565)，$\mathbf{k}$ 为[波数](@entry_id:172452)矢量）代入[弹性波方程](@entry_id:748864)，我们可以得到一个关于相速度 $v = \omega / |\mathbf{k}|$ 的[特征值问题](@entry_id:142153)，即**克里斯托夫方程** [@problem_id:3611602]：
$$
\Gamma_{il} A_l = \rho v^2 A_i
$$
其中，$\Gamma_{il} = C_{ijkl} n_j n_k$ 是**克里斯托夫[刚度矩阵](@entry_id:178659)**，$\mathbf{n} = \mathbf{k} / |\mathbf{k}|$ 是传播方向的单位矢量。对于任意给定的传播方向 $\mathbf{n}$，求解该特征值问题可以得到三个相速度（一个准P波和两个准[S波](@entry_id:174890)）以及它们对应的极化方向。

对于各向同性介质，克里斯托夫方程的求解给出了我们所熟知的、与方向无关的P波和S波速度：
$$
v_p = \sqrt{\frac{\lambda + 2\mu}{\rho}}, \quad v_s = \sqrt{\frac{\mu}{\rho}}
$$

然而，对于[各向异性介质](@entry_id:187796)，情况变得复杂。例如，在一个 VTI 介质中，沿对称轴（垂直方向）传播的P波速度为 $v_P^{\parallel} = \sqrt{C_{33}/\rho}$，而沿垂直于对称轴的方向（水平方向）传播的[P波](@entry_id:178440)速度为 $v_P^{\perp} = \sqrt{C_{11}/\rho}$。类似地，S波速度也表现出方向依赖性。这种速度随方向的变化是各向异性的核心特征，也是FWI中必须精确建模的关键现象。

#### [各向异性介质](@entry_id:187796)的实用参数化

直接使用[刚度张量](@entry_id:176588)的21个分量进行反演既不直观也通常不切实际。因此，[地球物理学](@entry_id:147342)家发展了更符合物理直觉的参数化方案。

*   **[Thomsen 参数](@entry_id:755939)化**: 对于 VTI 介质，Thomsen 提出了一套广泛使用的参数，它们由垂直[P波](@entry_id:178440)速度 $v_{p0}$、垂直[S波](@entry_id:174890)速度 $v_{s0}$ 和三个无量纲的各向异性参数 $\epsilon, \delta, \gamma$ 组成 [@problem_id:3611648]。这五个参数与五个独立的VTI刚度常数一一对应。在弱各向异性的情况下，这些参数具有明确的物理意义：
    *   $\epsilon \approx \frac{v_P(\text{水平}) - v_P(\text{垂直})}{v_P(\text{垂直})}$，主要描述了[P波](@entry_id:178440)速度从垂直到水平方向的变化率。
    *   $\gamma \approx \frac{v_{SH}(\text{水平}) - v_{SH}(\text{垂直})}{v_{SH}(\text{垂直})}$，描述了SH波（水平极化S波）的各向异性。
    *   $\delta$ 是一个更为复杂的参数，它不直接控制水平或垂直方向的速度，但对近垂直方向的[P波](@entry_id:178440)速度变化（即时差校正速度，NMO速度）起着决定性作用。

*   **TTI 介质的[参数化](@entry_id:272587)**: 对于 TTI 介质，其[参数化](@entry_id:272587)本质上是在 VTI 的基础上增加了描述对称轴方向的两个角度：**倾角 (tilt)** 和**方位角 (azimuth)** [@problem_id:3611581]。倾角通常定义为对称轴与垂直方向的夹角，而[方位角](@entry_id:164011)定义为[对称轴](@entry_id:177299)在水平面上投影与全局x轴的夹角。在计算波场时，需要构建一个旋转矩阵 $\mathbf{R}$，它由倾角和方位角确定。然后，使用[张量变换法则](@entry_id:185176)将[局部坐标系](@entry_id:751394)下简单的 VTI [刚度张量](@entry_id:176588) $C^{\ell}_{ijkl}$ 旋转到[全局坐标系](@entry_id:171029)：
    $$
    C^{g}_{pqrs} = R_{pi} R_{qj} R_{rk} R_{sl} C^{\ell}_{ijkl}
    $$
    这个旋转后的[刚度张量](@entry_id:176588) $C^{g}_{pqrs}$ 随后被用于[全局坐标系](@entry_id:171029)下的波[场模](@entry_id:189270)拟。

### 反演问题：多参数[全波形反演](@entry_id:749622)

FWI 的目标是找到一个地下介质模型 $\mathbf{m}$，使得通过该模型正演模拟出的合成数据 $\mathbf{p}(\mathbf{m})$ 与实际观测数据 $\mathbf{d}$ 之间的差异最小。

#### FWI 目标函数

这个差异通常由一个**目标函数**或**[失配函数](@entry_id:752010)** $J(\mathbf{m})$ 来量化。最常见的选择是基于最小二乘准则。对于多分量数据，并考虑到不同分量上可能存在的[相关噪声](@entry_id:137358)，一个更严谨的目标函数源于[高斯噪声](@entry_id:260752)假设下的[最大似然](@entry_id:146147)原理 [@problem_id:3611595]。该目标函数可以写成：
$$
J(\mathbf{m}) = \frac{1}{2} \sum_{s} \sum_{r} \int \left[\mathbf{d}_{sr}(t) - \mathbf{p}_{sr}(t;\mathbf{m})\right]^{\top} \mathbf{\Sigma}_{sr}^{-1} \left[\mathbf{d}_{sr}(t) - \mathbf{p}_{sr}(t;\mathbf{m})\right] \mathrm{d}t
$$
其中，$\mathbf{d}_{sr}(t)$ 和 $\mathbf{p}_{sr}(t;\mathbf{m})$ 分别是源 $s$ 和接收点 $r$ 处观测和预测的多分量数据矢量，$\mathbf{\Sigma}_{sr}$ 是噪声[协方差矩阵](@entry_id:139155)。$\mathbf{\Sigma}_{sr}^{-1}$ 起到了[数据加权](@entry_id:635715)的作用，它可以压制噪声大的分量或时间窗口的贡献，并[解耦](@entry_id:637294)相关的噪声。

在实际应用中，观测数据与合成数据之间的振幅差异可能不仅仅源于地下模型的错误，还可能来自未知的震源子波、接收仪器的耦合效应或未在正演物理中完全考虑的衰减效应。为了避免反演过程将这些振幅效应错误地归因于地下介质参数，通常需要在反演中引入额外的**滋扰参数** (nuisance parameters)，例如每个炮点的震源强度或频率相关的子波 $\gamma_s(\omega)$。此时，[目标函数](@entry_id:267263)会扩展为对地下模型参数 $\mathbf{m}$ 和滋扰参数 $\boldsymbol{\gamma}$ 的联合优化 [@problem_id:3611595]。

#### 通过伴随状态法计算梯度

大多数 FWI 算法都基于[梯度下降法](@entry_id:637322)或其变体，因此高效地计算[目标函数](@entry_id:267263)对模型参数的梯度 $\nabla_{\mathbf{m}} J$至关重要。对于像 FWI 这样涉及数百万甚至数十亿模型参数的问题，通过**伴随状态法** (Adjoint-State Method) 计算梯度是唯一可行的方法。

伴随状态法的核心思想是引入一个伴随场（或[拉格朗日乘子](@entry_id:142696)）$\mathbf{u}^*(\mathbf{x}, t)$，将原始的受约束优化问题（最小化目标函数，同时满足[波动方程](@entry_id:139839)）转化为一个无约束的拉格朗日泛函的寻优问题。通过一系列的变分和分部积分操作，可以推导出伴随场 $\mathbf{u}^*$ 所满足的**伴随方程**，以及目标函数的梯度表达式。

对于前述的广义多分量[弹性波](@entry_id:196203)目标函数，可以导出伴随场的源项 $\mathbf{s}^*$ [@problem_id:3611668]。这个[源项](@entry_id:269111)在物理上对应于在每个接收点位置 $\mathbf{x}_r$ 注入一个随时间变化的体力。该源项的表达式为：
$$
\mathbf{s}^{*}(\mathbf{x}, t) = - \sum_{r=1}^{N} \mathbf{Q}_{r}^{\top} \mathbf{W}_{r} \left( \mathbf{Q}_{r} \mathbf{u}(\mathbf{x}_{r},t) - \mathbf{d}_{r}(t) \right) \delta(\mathbf{x}-\mathbf{x}_r)
$$
这里的 $\mathbf{res}_r(t) = \mathbf{Q}_{r} \mathbf{u}(\mathbf{x}_{r},t) - \mathbf{d}_{r}(t)$ 是经过仪器响应 $\mathbf{Q}_r$ 变换后的数据残差，$\mathbf{W}_r$ 是数据权重（等价于逆噪声[协方差矩阵](@entry_id:139155)）。这个表达式的物理意义非常直观：它将数据空间中的残差，通过权重和仪器响应的[转置](@entry_id:142115)，反向投影回物理空间，作为驱动伴随场传播的源。伴随方程的形式与正演方程几乎相同，但伴随源项驱动着波场从时间 $t=T$ **反向传播**到 $t=0$。

在[各向异性介质](@entry_id:187796)中，伴随波场的分量耦合现象尤为显著，这源于两个方面 [@problem_id:3611668]：
1.  **测量耦合**：如果仪器[响应矩阵](@entry_id:754302) $\mathbf{Q}_r$ 或权重矩阵 $\mathbf{W}_r$ 是非对角的，那么单一分量上的数据残差也会在所有三个物理方向上产生伴随[源项](@entry_id:269111)，从而从源头就激发了多分量的伴随波场。
2.  **传播耦合**：即使伴随源是单分量的，只要介质是各向异性的（即[刚度张量](@entry_id:176588)存在非对角块耦合），伴随波在[反向传播](@entry_id:199535)过程中，其不同分量之间也会相互耦合和转换。这与正向传播中准[P波](@entry_id:178440)和准[S波](@entry_id:174890)极化方向不严格平行或垂直于传播方向是同一物理本质的体现。

一旦计算出正演波场 $\mathbf{u}$ 和伴随波场 $\mathbf{u}^*$，目标函数对某个模型参数 $m_k$ 的梯度就可以通过两个波场的零延迟[互相关](@entry_id:143353)来得到，这极大地提高了计算效率。

### 各向异性 FWI 的关键挑战与机制

多参数和各向异性为 FWI 带来了更高的保真度，但也引入了严峻的挑战，其中最核心的就是**参数串扰** (parameter cross-talk)。

#### 参数串扰：核心挑战

参数[串扰](@entry_id:136295)指的是不同模型参数对地震数据的影响相互重叠或相似，导致反演算法难以将数据中的某个特征唯一地归因于特定的参数。这在数学上表现为反演问题的Hessian矩阵存在显著的非对角元素，使得问题变得更加病态和非唯一。

#### 各向异性的[运动学](@entry_id:173318)特征

各向异性参数主要通过改变地震[波的[运动](@entry_id:756646)学](@entry_id:173318)（走时）和动力学（振幅、相位）特征来影响数据。例如，我们可以考察[P波](@entry_id:178440)在VTI介质层状界面上的[反射系数](@entry_id:194350) $R_{PP}(\theta)$。在弱各向异性和小参数反差的假设下，该反射系数可以线性化为 [@problem_id:3611642]：
$$
R_{PP}(\theta) \approx \frac{1}{2} \left[ \Delta\delta \sin^{2}\theta \cos^{2}\theta + \Delta\epsilon \sin^{4}\theta \right]
$$
其中 $\theta$ 是[入射角](@entry_id:192705)，$\Delta\delta$ 和 $\Delta\epsilon$ 是界面两侧Thomsen参数的差异。这个公式揭示了 $\delta$ 的影响在中间角度（约45度附近）达到最大，而 $\epsilon$ 的影响则随角度增大而单调增强。这意味着，为了有效地区分 $\epsilon$ 和 $\delta$，我们需要拥有良好角度覆盖范围的远偏移距数据。有趣的是，存在一个特定的角度 $\theta^* = \pi/4$，在该角度下，[反射系数](@entry_id:194350)对 $\epsilon$ 和 $\delta$ 的灵敏度大小恰好相等 [@problem_id:3611642]。

#### 不完备物理的陷阱

在实践中，为了降低计算成本，有时会采用简化的物理模型，例如**[伪声](@entry_id:190813)波 (pseudo-acoustic)** 方程，它试图在[声波方程](@entry_id:746230)的框架内模拟各向异性P[波的运动学](@entry_id:756646)行为，但完全忽略了S波物理。这种简化会引入严重的参数串扰。

考虑一个思想实验 [@problem_id:3611654]：假设真实的地下介质发生了一个微小的变化，这个变化仅仅是[S波](@entry_id:174890)速度 $v_s$ 的增加。由于 $v_s$ 通过刚度常数 $C_{44}$ 等影响着Thomsen参数 $\delta$，这个真实的变化会导致[P波](@entry_id:178440)速度随角度变化的特征发生改变。然而，一个只知道更新P波速度 $v_{p0}$ 的[伪声](@entry_id:190813)波FWI算法，会观测到这个由 $v_s$ 变化引起的运动学残差，并试图通过改变 $v_{p0}$ 来解释它。结果是，反演会产生一个虚假的、非零的 $\Delta v_{p0}$ 更新，而真实的 $v_{p0}$ 并未改变。这个虚假的更新就是由于不完备物理模型导致的参数串扰偏差。

#### [参数化](@entry_id:272587)选择与串扰

[参数化](@entry_id:272587)方案的选择对参数串扰有直接影响。不同的参数组合，其对数据的影响可能或多或少地重叠。我们可以通过计算不同参数梯度矢量之间的夹角余弦值来量化这种串扰程度 [@problem_id:3611614]。梯度矢量 $\nabla_a \Phi$ 和 $\nabla_b \Phi$ 之间的夹角余弦值接近1或-1，表示参数 $a$ 和 $b$ 对数据的影响高度线性相关，即存在强烈的[串扰](@entry_id:136295)；接近0则表示它们的影响是“正交的”，更容易被独立反演。

例如，在一个简化的TTI模型中，我们可以比较Thomsen参数化（$v_{p0}, \epsilon, \delta, \theta$）和刚度[参数化](@entry_id:272587)（$C_{11}, C_{33}, \theta$）。分析表明，在某些采集几何下，Thomsen参数间的[串扰](@entry_id:136295)（如 $v_{p0}$ 和 $\epsilon$ 之间，或 $\epsilon$ 和 $\delta$ 之间）可能非常严重。而刚度[参数化](@entry_id:272587)虽然物理意义不那么直观，但有时可能表现出更好的正交性，从而在数值上更稳定。这启示我们，参数化不仅仅是一个物理描述问题，更是一个需要根据具体问题和数据特性来决定的反演策略问题。

#### 利用Hessian[矩阵分析](@entry_id:204325)分辨率和[串扰](@entry_id:136295)

对反演问题更深入的理解来自于对 **Hessian 矩阵** $\mathbf{H}$ 的分析。Hessian 矩阵描述了目标函数在最优解附近的曲率，其逆矩阵 $\mathbf{H}^{-1}$ 是模型参数的[后验协方差矩阵](@entry_id:753631)，直接关系到解的分辨率和不确定性。在Gauss-Newton方法中，Hessian矩阵通常近似为 $\mathbf{H} \approx \mathbf{J}^{\top}\mathbf{J}$，其中 $\mathbf{J}$ 是[雅可比](@entry_id:264467)（或灵敏度）矩阵。

**[点扩散函数](@entry_id:183154) (Point-Spread Function, PSF)** 是一个强大的诊断工具，它被定义为Hessian矩阵的逆作用于一个[单位脉冲](@entry_id:272155)输入的结果 [@problem_id:3611612]。物理上，PSF代表了当我们试图反演一个位于单一网格单元的、单一参数的点状异常时，反演所能得到的“图像”。

一个理想的PSF应该是一个尖锐的脉冲，只在它自己的位置和自己的参数通道上有值。然而，在实际中：
*   **空间分辨率**：PSF在空间上的展宽或模糊程度，揭示了在该位置可实现的空间分辨率。展宽越大，分辨率越低。
*   **参数串扰**：如果对 $v_{p0}$ 参数施加一个脉冲，而在最终的PSF的 $\epsilon$ 参数通道中出现了能量，这就直接量化了从 $v_{p0}$ 到 $\epsilon$ 的[串扰](@entry_id:136295)。这个“泄露”的能量比例可以作为一个串扰比率来评估参数间的[耦合强度](@entry_id:275517)。

通过计算和分析PSF，我们可以评估不同的采集几何（例如，宽[方位角](@entry_id:164011)、长偏移距）或不同的正则化策略如何影响空间分辨率和参数[串扰](@entry_id:136295)，从而为优化勘探设计和反演流程提供理论指导。