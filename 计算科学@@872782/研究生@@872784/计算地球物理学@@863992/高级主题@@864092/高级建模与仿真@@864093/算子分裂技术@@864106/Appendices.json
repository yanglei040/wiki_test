{"hands_on_practices": [{"introduction": "要真正理解算子分裂法，亲手推导其组合步骤至关重要。本实践为应用于反应-扩散模型的Strang分裂格式提供了一个具体的分步推导。通过在一个简化的网格上实现隐式扩散和精确的反应流，你将精确地看到分离的物理过程如何组合以推动解在时间上前进 [@problem_id:3612342]。", "problem": "考虑一维热反应偏微分方程 (PDE) $u_{t}=\\kappa u_{xx}+f(u)$，这是计算地球物理学中用于热化学演化的一个典型模型。该方程建立在一个周期性域上，并使用具有 $N=2$ 个网格点和间距 $h0$ 的均匀网格进行离散化。设反应为线性反应，$f(u)=\\beta u$，其中 $\\beta$ 是一个常数。假设在时间 $t^{n}$ 的数值近似解由数对 $\\{u^{n}_{1},u^{n}_{2}\\}$ 给出。您将使用以下基于标准有限差分和时间积分实践的组件，通过一个时间步长为 $\\Delta t0$ 的 Strang 分裂步来推进解：\n- 通过逐点求解常微分方程 (ODE) $u_{t}=\\beta u$ 获得的时间 $s$ 的精确反应流。\n- 在时间 $\\Delta t$ 上的隐式扩散，其中时间上使用向后欧拉法，并对 $u_{xx}$ 使用带有周期性边界条件的二阶中心有限差分。\n\nStrang 分裂将子流组合为 $R_{\\Delta t/2}\\circ D_{\\Delta t}\\circ R_{\\Delta t/2}$，其中 $R_{s}$ 表示持续时间为 $s$ 的精确反应流，$D_{s}$ 表示由带周期性的半离散热方程的向后欧拉步所定义的持续时间为 $s$ 的隐式扩散流。\n\n从 $\\{u^{n}_{1},u^{n}_{2}\\}$ 出发，从第一性原理推导经过一个完整的 Strang 步后，在网格索引 $i=1$ 处的更新值的闭式表达式，该表达式完全用 $u^{n}_{1}$、$u^{n}_{2}$、$\\kappa$、$\\beta$、$\\Delta t$ 和 $h$ 表示。除了所述的离散化之外，不要引入任何额外的近似。提供 $u^{n+1}_{1}$ 的最终简化表达式。最终表达式中无需四舍五入，也无需单位。", "solution": "目标是在一个完整的 Strang 分裂步之后，根据初始状态 $\\{u^{n}_{1}, u^{n}_{2}\\}$ 计算更新后的值 $u^{n+1}_{1}$。分裂方案定义为三个算子的复合：$R_{\\Delta t/2}$、$D_{\\Delta t}$ 和 $R_{\\Delta t/2}$。设时间 $t^n$ 的状态向量为 $\\mathbf{u}^n = \\begin{pmatrix} u_1^n \\\\ u_2^n \\end{pmatrix}$。更新由 $\\mathbf{u}^{n+1} = R_{\\Delta t/2}(D_{\\Delta t}(R_{\\Delta t/2}(\\mathbf{u}^n)))$ 给出。我们将按顺序应用这些算子。\n\n**步骤 1：第一反应步，$R_{\\Delta t/2}$**\n\n这一步涉及求解常微分方程 (ODE) $u_t = \\beta u$，持续时间为 $s = \\frac{\\Delta t}{2}$。这是对状态向量的每个分量逐点进行的。这个 ODE 的解是 $u(t) = u(0) \\exp(\\beta t)$。\n设 $\\mathbf{u}^{*}$ 为这第一步之后的状态。将持续时间为 $\\frac{\\Delta t}{2}$ 的流应用于每个网格点的值，我们得到：\n$$ u_1^{*} = u_1^n \\exp\\left(\\frac{\\beta \\Delta t}{2}\\right) $$\n$$ u_2^{*} = u_2^n \\exp\\left(\\frac{\\beta \\Delta t}{2}\\right) $$\n向量形式为 $\\mathbf{u}^{*} = \\exp\\left(\\frac{\\beta \\Delta t}{2}\\right) \\mathbf{u}^n$。\n\n**步骤 2：隐式扩散步，$D_{\\Delta t}$**\n\n这一步使用向后欧拉法将热方程 $u_t = \\kappa u_{xx}$ 的解在一个时间步 $\\Delta t$ 上向前推进。空间导数 $u_{xx}$ 在具有 $N=2$ 个点的周期性域上使用二阶中心有限差分进行近似。\n\n对于一个网格点 $i$，中心差分近似为 $(u_{xx})_i \\approx \\frac{u_{i-1} - 2u_i + u_{i+1}}{h^2}$。\n在一个索引为 $i=1, 2$ 的 $N=2$ 个点的周期性网格上，邻点是周期性定义的。\n对于 $i=1$，邻点是 $i-1 \\equiv 2$ 和 $i+1=2$。一个更精确的解释是，网格点 $u_0$ 与 $u_2$ 等同，$u_3$ 与 $u_1$ 等同。因此，$u_1$ 的模板使用 $u_2$ 作为其左邻点和右邻点。这是 $N=2$ 情况下的一个特殊之处。\n这两点的空间离散化为：\n$$ (u_{xx})_1 \\approx \\frac{u_2 - 2u_1 + u_2}{h^2} = \\frac{2}{h^2}(u_2 - u_1) $$\n$$ (u_{xx})_2 \\approx \\frac{u_1 - 2u_2 + u_1}{h^2} = \\frac{2}{h^2}(u_1 - u_2) $$\n扩散部分的半离散 ODE 系统是：\n$$ \\frac{d}{dt}\\begin{pmatrix} u_1 \\\\ u_2 \\end{pmatrix} = \\frac{2\\kappa}{h^2}\\begin{pmatrix} -1  1 \\\\ 1  -1 \\end{pmatrix} \\begin{pmatrix} u_1 \\\\ u_2 \\end{pmatrix} $$\n设 $\\mathbf{u}^{**}$ 为从 $\\mathbf{u}^{*}$ 开始，经过扩散步之后的状态。对于系统 $\\frac{d\\mathbf{u}}{dt} = L\\mathbf{u}$ 的向后欧拉法是 $\\frac{\\mathbf{u}^{**} - \\mathbf{u}^{*}}{\\Delta t} = L \\mathbf{u}^{**}$。\n整理后得到 $(I - \\Delta t L) \\mathbf{u}^{**} = \\mathbf{u}^{*}$，其中 $I$ 是单位矩阵，而 $L = \\frac{2\\kappa}{h^2}\\begin{pmatrix} -1  1 \\\\ 1  -1 \\end{pmatrix}$。\n\n为简化符号，我们定义常数 $\\alpha = \\frac{2\\kappa \\Delta t}{h^2}$。求解 $\\mathbf{u}^{**}$ 的线性系统是：\n$$ \\left( \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} - \\Delta t \\frac{2\\kappa}{h^2}\\begin{pmatrix} -1  1 \\\\ 1  -1 \\end{pmatrix} \\right) \\begin{pmatrix} u_1^{**} \\\\ u_2^{**} \\end{pmatrix} = \\begin{pmatrix} u_1^{*} \\\\ u_2^{*} \\end{pmatrix} $$\n$$ \\begin{pmatrix} 1+\\alpha  -\\alpha \\\\ -\\alpha  1+\\alpha \\end{pmatrix} \\begin{pmatrix} u_1^{**} \\\\ u_2^{**} \\end{pmatrix} = \\begin{pmatrix} u_1^{*} \\\\ u_2^{*} \\end{pmatrix} $$\n为求解 $\\mathbf{u}^{**}$，我们必须对矩阵 $A = \\begin{pmatrix} 1+\\alpha  -\\alpha \\\\ -\\alpha  1+\\alpha \\end{pmatrix}$ 求逆。\n行列式为 $\\det(A) = (1+\\alpha)^2 - (-\\alpha)^2 = 1 + 2\\alpha + \\alpha^2 - \\alpha^2 = 1 + 2\\alpha$。\n逆矩阵为 $A^{-1} = \\frac{1}{1+2\\alpha}\\begin{pmatrix} 1+\\alpha  \\alpha \\\\ \\alpha  1+\\alpha \\end{pmatrix}$。\n因此，解为 $\\mathbf{u}^{**} = A^{-1}\\mathbf{u}^{*}$：\n$$ \\begin{pmatrix} u_1^{**} \\\\ u_2^{**} \\end{pmatrix} = \\frac{1}{1+2\\alpha} \\begin{pmatrix} (1+\\alpha)u_1^{*} + \\alpha u_2^{*} \\\\ \\alpha u_1^{*} + (1+\\alpha)u_2^{*} \\end{pmatrix} $$\n我们只需要 $u_1^{**}$ 的表达式：\n$$ u_1^{**} = \\frac{(1+\\alpha)u_1^{*} + \\alpha u_2^{*}}{1+2\\alpha} $$\n\n**步骤 3：第二反应步，$R_{\\Delta t/2}$**\n\n最后一步是对状态 $\\mathbf{u}^{**}$ 再次应用持续时间为 $s = \\frac{\\Delta t}{2}$ 的反应流。\n$$ u_1^{n+1} = u_1^{**} \\exp\\left(\\frac{\\beta \\Delta t}{2}\\right) $$\n$$ u_2^{n+1} = u_2^{**} \\exp\\left(\\frac{\\beta \\Delta t}{2}\\right) $$\n\n**综合所有步骤并简化**\n\n我们现在将前面步骤的表达式代入，以初始状态 $\\{u_1^n, u_2^n\\}$ 来表示 $u_1^{n+1}$。\n首先，将步骤 1 中 $u_1^{*}$ 和 $u_2^{*}$ 的表达式代入步骤 2 中 $u_1^{**}$ 的表达式：\n$$ u_1^{**} = \\frac{(1+\\alpha)\\left(u_1^n \\exp\\left(\\frac{\\beta \\Delta t}{2}\\right)\\right) + \\alpha \\left(u_2^n \\exp\\left(\\frac{\\beta \\Delta t}{2}\\right)\\right)}{1+2\\alpha} = \\frac{\\exp\\left(\\frac{\\beta \\Delta t}{2}\\right)}{1+2\\alpha} \\left( (1+\\alpha)u_1^n + \\alpha u_2^n \\right) $$\n现在，对 $u_1^{**}$ 应用最后的反应步（步骤 3）：\n$$ u_1^{n+1} = u_1^{**} \\exp\\left(\\frac{\\beta \\Delta t}{2}\\right) = \\left[ \\frac{\\exp\\left(\\frac{\\beta \\Delta t}{2}\\right)}{1+2\\alpha} \\left( (1+\\alpha)u_1^n + \\alpha u_2^n \\right) \\right] \\exp\\left(\\frac{\\beta \\Delta t}{2}\\right) $$\n合并指数项得到 $\\exp\\left(\\frac{\\beta \\Delta t}{2}\\right) \\exp\\left(\\frac{\\beta \\Delta t}{2}\\right) = \\exp(\\beta \\Delta t)$。\n$$ u_1^{n+1} = \\frac{\\exp(\\beta \\Delta t)}{1+2\\alpha} \\left( (1+\\alpha)u_1^n + \\alpha u_2^n \\right) $$\n最后，代回 $\\alpha = \\frac{2\\kappa \\Delta t}{h^2}$ 的定义：\n$$ u_1^{n+1} = \\frac{\\exp(\\beta \\Delta t)}{1 + 2\\left(\\frac{2\\kappa \\Delta t}{h^2}\\right)} \\left( \\left(1+\\frac{2\\kappa \\Delta t}{h^2}\\right)u_1^n + \\left(\\frac{2\\kappa \\Delta t}{h^2}\\right)u_2^n \\right) $$\n$$ u_1^{n+1} = \\frac{\\exp(\\beta \\Delta t)}{1 + \\frac{4\\kappa \\Delta t}{h^2}} \\left( \\left(1+\\frac{2\\kappa \\Delta t}{h^2}\\right)u_1^n + \\frac{2\\kappa \\Delta t}{h^2}u_2^n \\right) $$\n为了得到分子和分母中不含分数的简化表达式，我们将外层分数的分子和分母同时乘以 $h^2$：\n$$ u_1^{n+1} = \\frac{h^2 \\exp(\\beta \\Delta t)}{h^2\\left(1 + \\frac{4\\kappa \\Delta t}{h^2}\\right)} \\left( \\left(1+\\frac{2\\kappa \\Delta t}{h^2}\\right)u_1^n + \\frac{2\\kappa \\Delta t}{h^2}u_2^n \\right) $$\n$$ u_1^{n+1} = \\frac{\\exp(\\beta \\Delta t)}{h^2 + 4\\kappa \\Delta t} \\left( h^2\\left(1+\\frac{2\\kappa \\Delta t}{h^2}\\right)u_1^n + h^2\\left(\\frac{2\\kappa \\Delta t}{h^2}\\right)u_2^n \\right) $$\n$$ u_1^{n+1} = \\frac{\\exp(\\beta \\Delta t)}{h^2 + 4\\kappa \\Delta t} \\left( (h^2+2\\kappa \\Delta t)u_1^n + 2\\kappa \\Delta t u_2^n \\right) $$\n这就是 $u_1^{n+1}$ 的最终、简化的闭式表达式。", "answer": "$$\\boxed{\\frac{\\exp(\\beta \\Delta t)}{h^{2} + 4\\kappa \\Delta t} \\left( (h^{2}+2\\kappa \\Delta t)u^{n}_{1} + 2\\kappa \\Delta t u^{n}_{2} \\right)}$$", "id": "3612342"}, {"introduction": "在地球物理学中，应用算子分裂的一个主要动机是有效处理具有多种时间尺度的系统，即所谓的刚性问题。本练习展示了Lie分裂在此背景下的威力，其中刚性线性项被精确积分，仅留下非刚性非线性项进行显式处理。通过推导显式阶段的稳定性条件，你将发现这种分裂策略如何规避由刚性分量施加的严苛时间步长限制 [@problem_id:3612316]。", "problem": "考虑标量常微分方程 (ODE) $u_{t}=\\lambda u+g(u)$，该方程模拟地球物理介质中的一个刚性衰减-反应过程，其中 $\\lambda\\ll -1$ 代表一个强的线性衰减率，而 $g(u)$ 是一个非线性反应项，它在一个有界不变集 $\\mathcal{D}\\subset\\mathbb{R}$ 上是二次连续可微的。在一个时间步长 $\\Delta t0$ 上使用一阶 Lie 分裂法：首先在 $\\Delta t$ 上精确积分线性衰减子问题，然后在 $\\Delta t$ 上显式推进非线性反应子问题。\n\n仅从 Lie 分裂步骤的基本定义和显式单步格式的基于线性化的绝对稳定性判据出发，推导显式非线性阶段的最大稳定时间步长的估计值，用雅可比矩阵 $g'(u)$ 在 $\\mathcal{D}$ 上的模的上确界来表示。证明该稳定性约束是否以及如何依赖于 $\\lambda$。\n\n然后，将问题具体化到非线性反应 $g(u)=-\\alpha u^{3}$（其中 $\\alpha0$），假设动力学过程保持在集合 $\\mathcal{D}=\\{u\\in\\mathbb{R}:\\,|u|\\leq U\\}$ 内（对于给定的振幅界限 $U0$）。计算 Lie 分裂中显式阶段的最大允许时间步长 $\\Delta t_{\\max}$，用 $\\alpha$ 和 $U$ 来表示。你的最终答案必须以秒为单位，不要求四舍五入，且必须是单一的闭式解析表达式。", "solution": "问题要求分析应用于标量常微分方程 (ODE) $u_{t}=\\lambda u+g(u)$ 的一阶 Lie 分裂格式的稳定性。参数 $\\lambda \\ll -1$ 代表强的线性衰减，使得该 ODE 成为刚性方程。项 $g(u)$ 是一个非线性反应，并假设解 $u(t)$ 保持在一个有界不变集 $\\mathcal{D} \\subset \\mathbb{R}$ 内。\n\n首先，我们将 Lie 分裂格式形式化。在一个时间步长 $\\Delta t  0$ 上，从 $u(t_n)$ 的一个近似值 $u_n$ 开始，我们分两个阶段计算 $u_{n+1} \\approx u(t_n+\\Delta t)$。\n\n阶段 1：求解线性衰减子问题。\n我们在区间 $[0, \\Delta t]$ 上求解初值为 $v(0) = u_n$ 的常微分方程 $v_t = \\lambda v$。问题指明这个积分是精确执行的。解为 $v(t) = u_n \\exp(\\lambda t)$。在 $t=\\Delta t$ 处求值得到中间值 $u^*$：\n$$u^* = u_n \\exp(\\lambda \\Delta t)$$\n\n阶段 2：求解非线性反应子问题。\n我们在区间 $[0, \\Delta t]$ 上求解初值为 $w(0) = u^*$ 的常微分方程 $w_t = g(w)$。问题说明这是“显式”完成的。最基本的一阶显式方法是前向欧拉格式。应用一步前向欧拉法得到最终值 $u_{n+1}$：\n$$u_{n+1} = u^* + \\Delta t \\, g(u^*)$$\n\n问题的核心是确定由这第二个显式阶段引起的对 $\\Delta t$ 的稳定性约束。问题指定了一个基于线性化的绝对稳定性判据。对于应用于标量常微分方程 $w_t = f(w)$ 的显式单步法，其稳定性通过围绕参考解对常微分方程进行线性化来分析，这导致一个条件，即 $\\Delta t$ 乘以 $f$ 的雅可比矩阵必须位于该方法的稳定区域内。\n\n对于前向欧拉法，复数 $z$ 的稳定区域是复平面中由 $|1 + z| \\leq 1$ 定义的圆盘。在我们的例子中，函数是 $g(u)$，其雅可比矩阵是标量导数 $g'(u)$，变量 $z$ 对应于 $\\Delta t \\, g'(u)$。由于 $g(u)$ 是一个实变量的实值函数，$g'(u)$ 是实数。因此，稳定性条件变为：\n$$|1 + \\Delta t \\, g'(u)| \\leq 1$$\n对于实数值 $x = \\Delta t \\, g'(u)$，这个不等式等价于 $-1 \\leq 1 + x \\leq 1$，化简后为：\n$$-2 \\leq \\Delta t \\, g'(u) \\leq 0$$\n\n这个条件必须对第二阶段中作为函数 $g$ 输入的任何 $u$ 值都成立。输入是 $u^* = u_n \\exp(\\lambda \\Delta t)$。由于 $u_n$ 在不变集 $\\mathcal{D}$ 中，且问题说明 $\\lambda \\ll -1$，我们有 $0  \\exp(\\lambda \\Delta t) \\ll 1$。因此， $|u^*| = |u_n| \\exp(\\lambda \\Delta t) \\leq |u_n|$。如果 $\\mathcal{D}$ 是一个以 0 为中心的区间，例如 $\\{u \\in \\mathbb{R}: |u| \\leq U\\}$，那么 $u_n \\in \\mathcal{D}$ 意味着 $u^* \\in \\mathcal{D}$。为了确保对所有可能的状态都稳定，该条件必须对所有 $u \\in \\mathcal{D}$ 成立。\n\n条件 $-2 \\leq \\Delta t \\, g'(u) \\leq 0$ 对所有 $u \\in \\mathcal{D}$ 成立，意味着两个独立的约束：\n1.  $\\Delta t \\, g'(u) \\leq 0$：由于 $\\Delta t  0$，这要求对所有 $u \\in \\mathcal{D}$ 都有 $g'(u) \\leq 0$。这是前向欧拉法要保持稳定所对反应项物理性质的一个必要条件。\n2.  $\\Delta t \\, g'(u) \\geq -2$：这意味着对于任何 $g'(u)  0$ 的 $u \\in \\mathcal{D}$，都有 $\\Delta t \\leq \\frac{-2}{g'(u)}$。\n\n为了确保这个不等式对所有 $u \\in \\mathcal{D}$ 成立，$\\Delta t$ 必须小于 $\\frac{-2}{g'(u)}$ 的最小可能值。这个最小值在分母 $g'(u)$ 为最负时出现，即当 $|g'(u)| = -g'(u)$ 达到其最大值时。设 $L_g = \\sup_{u \\in \\mathcal{D}} |g'(u)|$。那么最严格的约束是：\n$$\\Delta t \\leq \\frac{2}{L_g}$$\n因此，最大稳定时间步长为 $\\Delta t_{\\max} = \\frac{2}{\\sup_{u \\in \\mathcal{D}} |g'(u)|}$。\n\n现在，我们讨论这个稳定性约束是否依赖于 $\\lambda$。推导出的估计值 $\\Delta t \\leq 2/L_g$ 仅依赖于非线性项雅可比矩阵 $g'(u)$ 的模在不变集 $\\mathcal{D}$ 上的上确界。参数 $\\lambda$ 没有出现在这个表达式中。这展示了 Lie 分裂法处理刚性问题的一个关键优势：与刚性线性项相关的稳定性约束（对于一个完全显式的方法，该约束约为 $\\Delta t \\leq 2/|\\lambda|$）通过精确积分该部分系统而被移除。整体稳定性仅由非刚性部分控制，从而允许使用大得多的时间步长。\n\n最后，我们将此结果具体化到给定的非线性反应 $g(u) = -\\alpha u^3$（其中 $\\alpha  0$）和不变集 $\\mathcal{D} = \\{u\\in\\mathbb{R}:\\,|u|\\leq U\\}$（对于给定的 $U  0$）。\n\n首先，我们计算导数 $g'(u)$：\n$$g'(u) = \\frac{d}{du}(-\\alpha u^3) = -3\\alpha u^2$$\n由于 $\\alpha  0$ 且 $u^2 \\geq 0$，我们对所有 $u$ 都有 $g'(u) \\leq 0$。这满足了稳定性的必要条件。\n\n接下来，我们在集合 $\\mathcal{D}$ 上找到 $|g'(u)|$ 的上确界：\n$$L_g = \\sup_{u \\in \\mathcal{D}} |g'(u)| = \\sup_{|u| \\leq U} |-3\\alpha u^2| = \\sup_{|u| \\leq U} 3\\alpha u^2$$\n函数 $3\\alpha u^2$ 是一个开口向上、顶点在 $u=0$ 的抛物线。在对称区间 $[-U, U]$ 上，其最大值在端点 $u = \\pm U$ 处取得。\n$$L_g = 3\\alpha U^2$$\n\n将此代入我们的最大时间步长表达式中，得到：\n$$\\Delta t_{\\max} = \\frac{2}{L_g} = \\frac{2}{3\\alpha U^2}$$\n问题要求答案以秒为单位表示。如果我们假设 $u$ 的单位是 $X$，时间的单位是秒 ($s$)，那么从 $u_t = g(u)$ 可知，$g(u)$ 的单位必须是 $X/s$。从 $g(u) = -\\alpha u^3$ 可知，$\\alpha$ 的单位必须是 $(X/s)/X^3 = X^{-2}s^{-1}$。$U$ 的单位是 $X$。因此，表达式 $\\frac{2}{3\\alpha U^2}$ 的单位是 $1/(X^{-2}s^{-1} \\cdot X^2) = 1/s^{-1} = s$。结果在量纲上是一致的。", "answer": "$$\\boxed{\\frac{2}{3\\alpha U^2}}$$", "id": "3612316"}, {"introduction": "分裂格式的稳定性并非总是直观的，它取决于各算子之间的相互作用。本实践引入严谨的冯·诺依曼稳定性分析方法，以确定一个用于对流-扩散方程的完整Lie分裂格式的稳定性。通过分析显式对流和隐式扩散组合步骤的放大因子，你将推导出一个精确的稳定性判据，它决定了整个格式所允许的最大时间步长 [@problem_id:3612346]。", "problem": "考虑线性平流-扩散方程 $u_{t} + c\\,u_{x} = \\nu\\,u_{xx}$，其中 $c \\in \\mathbb{R}$ 是一个不为零的恒定平流速度，$c \\neq 0$，$\\nu \\ge 0$ 是一个恒定的运动粘度。设空间域是周期性的，周期为 $L  0$，在均匀网格 $x_{j} = j\\,\\Delta x$ 上进行离散化，网格间距 $\\Delta x  0$ 为常数。考虑一个 Lie 分裂时间积分器，在单个时间步长 $\\Delta t  0$ 内应用以下步骤：\n\n- 一个显式平流步骤，时间上使用前向欧拉法，空间上使用与 $c$ 符号一致的一阶迎风离散化，随后是\n- 一个隐式扩散步骤，时间上使用后向欧拉法，并对 $u_{xx}$ 使用二阶中心有限差分。\n\n假设采用周期性边界条件，使得离散傅里叶模是更新算子的特征函数。对组合的单步映射（从时间层 $n$ 通过平流然后扩散到 $n+1$）进行 von Neumann 分析（傅里叶稳定性分析），并推导其稳定性的充要条件，即对于所有波数，谱放大因子的大小都以 $1$ 为界。由此，确定最大允许时间步长 $\\Delta t_{\\max}$，它是一个用 $c$、$\\nu$ 和 $\\Delta x$ 表示的显式代数表达式，使得 Lie 分裂格式对所有傅里叶模都是 von Neumann 稳定的。将最终答案表示为 $\\Delta t_{\\max}$ 的单个闭式表达式。不要提供数值；如果要进行数值计算，时间将以秒（国际单位制单位）表示，但在这里只须给出符号表达式。", "solution": "解答过程是通过分析组合的两步 Lie 分裂格式的放大因子来进行的。设 $u_j^n$ 表示在时间 $t_n = n\\Delta t$ 和空间位置 $x_j = j\\Delta x$ 的数值解。该格式通过一个我们用 $*$ 表示的中间步骤，将解从时间层 $n$ 更新到 $n+1$。\n\n总格式为 $u^n \\xrightarrow{\\text{平流}} u^* \\xrightarrow{\\text{扩散}} u^{n+1}$。\n\n**1. 平流步骤分析**\n平流方程为 $u_t + c u_x = 0$。该格式在时间上使用前向欧拉法，对空间导数 $u_x$ 使用一阶迎风离散化。迎风离散化取决于平流速度 $c$ 的符号。\n\n设 $\\alpha = \\frac{|c|\\Delta t}{\\Delta x}$ 为 Courant 数，其为非负数。\n- 若 $c  0$，迎风差分为 $\\frac{u_j - u_{j-1}}{\\Delta x}$。前向欧拉更新为：\n$$ \\frac{u_j^* - u_j^n}{\\Delta t} + c \\frac{u_j^n - u_{j-1}^n}{\\Delta x} = 0 \\implies u_j^* = u_j^n - \\frac{c\\Delta t}{\\Delta x}(u_j^n - u_{j-1}^n) = (1-\\alpha)u_j^n + \\alpha u_{j-1}^n $$\n- 若 $c  0$，迎风差分为 $\\frac{u_{j+1} - u_j}{\\Delta x}$。前向欧拉更新为：\n$$ \\frac{u_j^* - u_j^n}{\\Delta t} + c \\frac{u_{j+1}^n - u_j^n}{\\Delta x} = 0 \\implies u_j^* = u_j^n - \\frac{c\\Delta t}{\\Delta x}(u_{j+1}^n - u_j^n) = (1+\\frac{c\\Delta t}{\\Delta x})u_j^n - \\frac{c\\Delta t}{\\Delta x}u_{j+1}^n = (1-\\alpha)u_j^n + \\alpha u_{j+1}^n $$\n我们通过代入单个傅里叶模 $u_j^n = \\hat{u}^n(k) \\exp(i k x_j) = \\hat{u}^n(k) \\exp(i j \\theta)$ 来进行 von Neumann 分析，其中 $k$ 是波数，$\\theta = k \\Delta x$ 是无量纲波数或每个网格单元的相移。平流步骤的放大因子 $G_A(\\theta)$ 由 $\\hat{u}^*(k) = G_A(\\theta) \\hat{u}^n(k)$ 定义。\n\n- 对于 $c  0$：$\\hat{u}^* \\exp(ij\\theta) = (1-\\alpha)\\hat{u}^n \\exp(ij\\theta) + \\alpha \\hat{u}^n \\exp(i(j-1)\\theta)$。两边除以 $\\hat{u}^n \\exp(ij\\theta)$ 得 $G_A(\\theta) = (1-\\alpha) + \\alpha \\exp(-i\\theta)$。\n- 对于 $c  0$：$\\hat{u}^* \\exp(ij\\theta) = (1-\\alpha)\\hat{u}^n \\exp(ij\\theta) + \\alpha \\hat{u}^n \\exp(i(j+1)\\theta)$。两边除以 $\\hat{u}^n \\exp(ij\\theta)$ 得 $G_A(\\theta) = (1-\\alpha) + \\alpha \\exp(i\\theta)$。\n\n放大因子的幅值平方 $|G_A(\\theta)|^2$ 在两种情况下是相同的。对于 $c0$：\n$$ |G_A(\\theta)|^2 = |(1-\\alpha) + \\alpha(\\cos\\theta - i\\sin\\theta)|^2 = |(1-\\alpha(1-\\cos\\theta)) - i\\alpha\\sin\\theta|^2 $$\n$$ |G_A(\\theta)|^2 = (1-\\alpha(1-\\cos\\theta))^2 + (\\alpha\\sin\\theta)^2 = 1 - 2\\alpha(1-\\cos\\theta) + \\alpha^2(1-\\cos\\theta)^2 + \\alpha^2\\sin^2\\theta $$\n$$ |G_A(\\theta)|^2 = 1 - 2\\alpha(1-\\cos\\theta) + \\alpha^2(1 - 2\\cos\\theta + \\cos^2\\theta + \\sin^2\\theta) = 1 - 2\\alpha(1-\\cos\\theta) + \\alpha^2(2 - 2\\cos\\theta) $$\n$$ |G_A(\\theta)|^2 = 1 - 2(1-\\cos\\theta)(\\alpha-\\alpha^2) $$\n这个关于 $|G_A(\\theta)|^2$ 的表达式对任何 $c \\neq 0$ 都成立。\n\n**2. 扩散步骤分析**\n扩散方程为 $u_t = \\nu u_{xx}$。该格式在时间上使用后向欧拉法，对 $u_{xx}$ 使用二阶中心差分，即 $\\frac{u_{j+1} - 2u_j + u_{j-1}}{(\\Delta x)^2}$。从中间状态 $u^*$ 到最终状态 $u^{n+1}$ 的更新为：\n$$ \\frac{u_j^{n+1} - u_j^*}{\\Delta t} = \\nu \\frac{u_{j+1}^{n+1} - 2u_j^{n+1} + u_{j-1}^{n+1}}{(\\Delta x)^2} $$\n设 $\\beta = \\frac{\\nu\\Delta t}{(\\Delta x)^2}$ 为扩散数。因为 $\\nu \\ge 0$，所以有 $\\beta \\ge 0$。\n$$ u_j^* = u_j^{n+1} - \\beta(u_{j+1}^{n+1} - 2u_j^{n+1} + u_{j-1}^{n+1}) $$\n将傅里叶模 $u_j = \\hat{u}(k) \\exp(ij\\theta)$ 代入 $*$ 和 $n+1$ 两个时间层：\n$$ \\hat{u}^* = \\hat{u}^{n+1} - \\beta(\\hat{u}^{n+1}\\exp(i\\theta) - 2\\hat{u}^{n+1} + \\hat{u}^{n+1}\\exp(-i\\theta)) $$\n$$ \\hat{u}^* = \\hat{u}^{n+1} (1 - \\beta(\\exp(i\\theta) + \\exp(-i\\theta) - 2)) = \\hat{u}^{n+1}(1 - \\beta(2\\cos\\theta - 2)) $$\n$$ \\hat{u}^* = \\hat{u}^{n+1}(1 + 2\\beta(1-\\cos\\theta)) $$\n扩散步骤的放大因子 $G_D(\\theta)$ 由 $\\hat{u}^{n+1}(k) = G_D(\\theta) \\hat{u}^*(k)$ 定义。\n$$ G_D(\\theta) = \\frac{1}{1 + 2\\beta(1-\\cos\\theta)} $$\n由于 $\\beta \\ge 0$ 且 $1-\\cos\\theta \\ge 0$，分母总是大于或等于 $1$。因此，对所有 $\\theta$ 都有 $|G_D(\\theta)| \\le 1$，这验证了该步骤本身是无条件稳定的。\n\n**3. 组合格式的稳定性**\n对于完整的算子分裂步骤，总放大因子是乘积 $G(\\theta) = G_A(\\theta) G_D(\\theta)$。稳定性条件要求对于所有 $\\theta \\in [-\\pi, \\pi]$，都有 $|G(\\theta)| \\le 1$。\n$$ |G(\\theta)|^2 = |G_A(\\theta)|^2 |G_D(\\theta)|^2 \\le 1 $$\n$$ \\frac{1 - 2(1-\\cos\\theta)(\\alpha-\\alpha^2)}{(1 + 2\\beta(1-\\cos\\theta))^2} \\le 1 $$\n设 $X = 1-\\cos\\theta$。对于 $\\theta \\in [-\\pi, \\pi]$，我们有 $X \\in [0, 2]$。不等式变为：\n$$ 1 - 2X(\\alpha-\\alpha^2) \\le (1+2\\beta X)^2 = 1 + 4\\beta X + 4\\beta^2 X^2 $$\n$$ -2X(\\alpha-\\alpha^2) \\le 4\\beta X + 4\\beta^2 X^2 $$\n$$ 0 \\le 4\\beta X + 4\\beta^2 X^2 + 2X(\\alpha-\\alpha^2) $$\n当 $X=0$ (即 $\\theta=0$) 时，不等式为 $0 \\le 0$，这是平凡成立的。对于 $X  0$，我们可以除以 $X$：\n$$ 0 \\le 4\\beta + 4\\beta^2 X + 2(\\alpha-\\alpha^2) $$\n设 $f(X) = 4\\beta^2 X + (4\\beta + 2\\alpha - 2\\alpha^2)$。此不等式必须对所有 $X \\in (0, 2]$ 成立。函数 $f(X)$ 是 $X$ 的线性函数。其斜率为 $4\\beta^2 \\ge 0$，因此 $f(X)$ 是一个非减函数。$f(X)$ 在区间 $[0, 2]$ 上的最小值出现在 $X=0$ 处。因此，如果该条件在 $X=0$ 处成立，则对所有 $X$ 都成立：\n$$ 4\\beta + 2\\alpha - 2\\alpha^2 \\ge 0 $$\n$$ 2\\beta + \\alpha - \\alpha^2 \\ge 0 $$\n现在，我们代入 $\\alpha$ 和 $\\beta$ 的定义：\n$$ 2\\left(\\frac{\\nu\\Delta t}{(\\Delta x)^2}\\right) + \\frac{|c|\\Delta t}{\\Delta x} - \\left(\\frac{|c|\\Delta t}{\\Delta x}\\right)^2 \\ge 0 $$\n由于我们寻找的是非平凡的时间步长 $\\Delta t  0$，我们可以将不等式两边除以 $\\Delta t$：\n$$ \\frac{2\\nu}{(\\Delta x)^2} + \\frac{|c|}{\\Delta x} - \\frac{|c|^2 \\Delta t}{(\\Delta x)^2} \\ge 0 $$\n我们求解 $\\Delta t$ 以找到稳定性边界：\n$$ \\frac{|c|^2 \\Delta t}{(\\Delta x)^2} \\le \\frac{2\\nu}{(\\Delta x)^2} + \\frac{|c|}{\\Delta x} $$\n两边乘以 $(\\Delta x)^2$ 得：\n$$ |c|^2 \\Delta t \\le 2\\nu + |c|\\Delta x $$\n因为 $c \\neq 0$，所以 $|c|^2  0$，我们可以除以它：\n$$ \\Delta t \\le \\frac{2\\nu + |c|\\Delta x}{|c|^2} $$\n最大允许时间步长 $\\Delta t_{\\max}$ 是此不等式的上界。\n\n$$ \\Delta t_{\\max} = \\frac{2\\nu + |c|\\Delta x}{|c|^2} $$\n这也可以写成 $\\Delta t_{\\max} = \\frac{\\Delta x}{|c|} + \\frac{2\\nu}{|c|^2}$。这表明，纯平流 CFL 条件下的稳定时间步长（$\\Delta x/|c|$）被一个与粘度 $\\nu$ 成正比的项所增加。", "answer": "$$\\boxed{\\frac{2\\nu + |c|\\Delta x}{|c|^2}}$$", "id": "3612346"}]}