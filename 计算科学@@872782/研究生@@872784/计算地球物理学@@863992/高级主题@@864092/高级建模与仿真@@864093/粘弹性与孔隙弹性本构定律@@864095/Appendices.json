{"hands_on_practices": [{"introduction": "理解不同材料响应函数之间的数学关系是掌握粘弹性理论的基石。本练习使用经典的Maxwell模型，要求你从基本本构关系出发，推导蠕变柔量 $J(t)$ 与应力松弛模量 $G(t)$ 之间的内在联系。完成此推导将为你分析更复杂的模型提供必要的数学工具 [@problem_id:3618766]。", "problem": "考虑一个一维等温麦克斯韦黏弹性材料，它由一个模量为 $E$ 的线性弹性弹簧与一个黏度为 $\\eta$ 的线性黏性阻尼器串联组成。假设为小应变、单轴加载且满足因果性。各元件的本构关系为 $ \\sigma_{\\mathrm{spring}}(t) = E\\,\\epsilon_{\\mathrm{spring}}(t)$ 和 $ \\sigma_{\\mathrm{dashpot}}(t) = \\eta\\,\\dot{\\epsilon}_{\\mathrm{dashpot}}(t)$。串联时，总应变为 $ \\epsilon(t) = \\epsilon_{\\mathrm{spring}}(t) + \\epsilon_{\\mathrm{dashpot}}(t)$，且两个元件的应力相同，即 $ \\sigma(t) = \\sigma_{\\mathrm{spring}}(t) = \\sigma_{\\mathrm{dashpot}}(t)$。当 $t  0$ 时，材料处于静止状态。令 $H(t)$ 表示亥维赛阶跃函数。\n\n1) 对该材料施加单位阶跃应力历史 $ \\sigma(t) = H(t)$。仅从上述本构关系和串联条件出发，推导蠕变柔量 $J(t)$（在此加载条件下，其定义为 $ \\epsilon(t) = J(t)\\,\\sigma(t)$），并将其写成关于 $t$ 的因果分布形式。\n\n2) 麦克斯韦材料的应力松弛模量由 $ G(t) = E\\,\\exp(-t/\\tau)\\,H(t)$ 给出，其中 $ \\tau = \\eta/E$。利用第1部分得到的 $J(t)$ 的结果，计算当 $ t > 0$ 时的因果卷积 $ (G * \\dot{J})(t) = \\int_{0}^{t} G(t-s)\\,\\dot{J}(s)\\,\\mathrm{d}s$，在需要时适当考虑分布的影响，并将其简化为一个常数。\n\n报告当 $ t > 0$ 时 $ (G * \\dot{J})(t)$ 的值，结果应为一个不带单位的实数。无需四舍五入。", "solution": "该问题陈述已经过验证，被认为是科学上可靠、适定、客观且完整的。它提出了线性黏弹性理论中的一个标准问题，可以使用连续介质力学和数学的既定原理来解决。\n\n问题分为两部分。首先，我们推导麦克斯韦材料的蠕变柔量 $J(t)$。其次，我们计算一个涉及 $J(t)$ 和给定的应力松弛模量 $G(t)$ 的特定卷积积分。\n\n### 第1部分：推导蠕变柔量 $J(t)$\n\n麦克斯韦材料被建模为一个线性弹性弹簧与一个线性黏性阻尼器串联。其控制关系式如下：\n1.  弹簧：$\\sigma(t) = E\\,\\epsilon_{\\mathrm{spring}}(t)$\n2.  阻尼器：$\\sigma(t) = \\eta\\,\\dot{\\epsilon}_{\\mathrm{dashpot}}(t)$，其中 $\\dot{\\epsilon}_{\\mathrm{dashpot}}(t) = \\frac{d\\epsilon_{\\mathrm{dashpot}}(t)}{dt}$\n3.  串联：$\\epsilon(t) = \\epsilon_{\\mathrm{spring}}(t) + \\epsilon_{\\mathrm{dashpot}}(t)$\n\n应力 $\\sigma(t)$ 对两个元件是相同的。为了找到该材料的单一本构方程，我们将总应变对时间 $t$ 求导：\n$$\n\\dot{\\epsilon}(t) = \\dot{\\epsilon}_{\\mathrm{spring}}(t) + \\dot{\\epsilon}_{\\mathrm{dashpot}}(t)\n$$\n从各元件的本构关系中，我们可以用应力来表示应变率：\n$$\n\\dot{\\epsilon}_{\\mathrm{spring}}(t) = \\frac{1}{E}\\,\\dot{\\sigma}(t)\n$$\n$$\n\\dot{\\epsilon}_{\\mathrm{dashpot}}(t) = \\frac{1}{\\eta}\\,\\sigma(t)\n$$\n将这些代入总应变率的表达式，得到麦克斯韦材料本构律的微分形式：\n$$\n\\dot{\\epsilon}(t) = \\frac{1}{E}\\,\\dot{\\sigma}(t) + \\frac{1}{\\eta}\\,\\sigma(t)\n$$\n题目指定了蠕变试验，其中材料承受单位阶跃应力历史 $\\sigma(t) = H(t)$，这里的 $H(t)$ 是亥维赛阶跃函数。当 $t  0$ 时材料处于静止状态，这意味着当 $t  0$ 时 $\\epsilon(t) = 0$。应力的时间导数是狄拉克δ分布，即 $\\dot{\\sigma}(t) = \\delta(t)$。\n\n将这些代入本构方程，得到：\n$$\n\\dot{\\epsilon}(t) = \\frac{1}{E}\\,\\delta(t) + \\frac{1}{\\eta}\\,H(t)\n$$\n为了求得总应变 $\\epsilon(t)$，我们对该方程从 $t=0$ 前的一个无穷小时间（记为 $0^-$）积分到时间 $t > 0$。这能确保初始条件 $\\epsilon(0^-) = 0$ 得以满足，并且能够捕捉到 $t=0$ 处δ分布的影响。\n$$\n\\epsilon(t) = \\int_{0^-}^{t} \\dot{\\epsilon}(s)\\,\\mathrm{d}s = \\int_{0^-}^{t} \\left( \\frac{1}{E}\\,\\delta(s) + \\frac{1}{\\eta}\\,H(s) \\right) \\mathrm{d}s\n$$\n该积分可以分为两部分：\n$$\n\\epsilon(t) = \\frac{1}{E} \\int_{0^-}^{t} \\delta(s)\\,\\mathrm{d}s + \\frac{1}{\\eta} \\int_{0^-}^{t} H(s)\\,\\mathrm{d}s\n$$\n狄拉克δ函数的积分是亥维赛阶跃函数，即 $\\int_{0^-}^{t} \\delta(s)\\,\\mathrm{d}s = H(t)$。对于 $s > 0$，$H(s) = 1$，所以第二个积分变为 $\\int_{0}^{t} 1\\,\\mathrm{d}s = t$。将这些结果合并，应变响应为：\n$$\n\\epsilon(t) = \\frac{1}{E}\\,H(t) + \\frac{t}{\\eta}\\,H(t) = \\left( \\frac{1}{E} + \\frac{t}{\\eta} \\right) H(t)\n$$\n题目通过关系式 $\\epsilon(t) = J(t)\\,\\sigma(t)$ 定义了给定加载下的蠕变柔量 $J(t)$。当 $\\sigma(t) = H(t)$ 时，该关系为 $\\epsilon(t) = J(t)H(t)$。将此与我们推导出的 $\\epsilon(t)$ 的表达式进行比较：\n$$\nJ(t)H(t) = \\left( \\frac{1}{E} + \\frac{t}{\\eta} \\right) H(t)\n$$\n这就将蠕变柔量定义为如下的因果分布：\n$$\nJ(t) = \\left( \\frac{1}{E} + \\frac{t}{\\eta} \\right) H(t)\n$$\n\n### 第2部分：计算卷积 $(G * \\dot{J})(t)$\n\n首先，我们必须使用分布演算的法则来求蠕变柔量的时间导数 $\\dot{J}(t)$。应用乘积求导法则 $(uv)' = u'v + uv'$，其中 $u(t) = \\frac{1}{E} + \\frac{t}{\\eta}$ 且 $v(t) = H(t)$：\n$$\n\\dot{J}(t) = \\frac{d}{dt}\\left[ \\left( \\frac{1}{E} + \\frac{t}{\\eta} \\right) H(t) \\right] = \\left( \\frac{d}{dt}\\left[ \\frac{1}{E} + \\frac{t}{\\eta} \\right] \\right) H(t) + \\left( \\frac{1}{E} + \\frac{t}{\\eta} \\right) \\left( \\frac{d}{dt}H(t) \\right)\n$$\n$$\n\\dot{J}(t) = \\frac{1}{\\eta}\\,H(t) + \\left( \\frac{1}{E} + \\frac{t}{\\eta} \\right) \\delta(t)\n$$\n利用δ分布的筛选性质 $f(t)\\delta(t) = f(0)\\delta(t)$：\n$$\n\\dot{J}(t) = \\frac{1}{\\eta}\\,H(t) + \\left( \\frac{1}{E} + \\frac{0}{\\eta} \\right) \\delta(t) = \\frac{1}{E}\\,\\delta(t) + \\frac{1}{\\eta}\\,H(t)\n$$\n现在，我们计算当 $t > 0$ 时的卷积 $(G * \\dot{J})(t)$。该卷积定义为：\n$$\n(G * \\dot{J})(t) = \\int_{0}^{t} G(t-s)\\,\\dot{J}(s)\\,\\mathrm{d}s\n$$\n为了正确处理 $s=0$ 处的δ分布，积分下限在形式上被视为 $0^-$。\n$$\n(G * \\dot{J})(t) = \\int_{0^-}^{t} G(t-s)\\,\\left[ \\frac{1}{E}\\,\\delta(s) + \\frac{1}{\\eta}\\,H(s) \\right]\\,\\mathrm{d}s\n$$\n我们将积分分成两项：\n$$\n(G * \\dot{J})(t) = \\frac{1}{E} \\int_{0^-}^{t} G(t-s)\\,\\delta(s)\\,\\mathrm{d}s + \\frac{1}{\\eta} \\int_{0^-}^{t} G(t-s)\\,H(s)\\,\\mathrm{d}s\n$$\n第一个积分使用 $\\delta(s)$ 的筛选性质来计算：\n$$\n\\frac{1}{E} \\int_{0^-}^{t} G(t-s)\\,\\delta(s)\\,\\mathrm{d}s = \\frac{1}{E}\\,G(t-0) = \\frac{1}{E}\\,G(t)\n$$\n对于第二个积分，由于积分范围是 $s \\ge 0$，因此 $H(s)=1$，积分下限可以设为 $0$：\n$$\n\\frac{1}{\\eta} \\int_{0}^{t} G(t-s)\\,\\mathrm{d}s\n$$\n让我们进行换元，令 $u = t-s$，则 $\\mathrm{d}u = -\\mathrm{d}s$。积分限从 $s=0 \\to u=t$ 和 $s=t \\to u=0$。\n$$\n\\frac{1}{\\eta} \\int_{t}^{0} G(u)\\,(-\\mathrm{d}u) = \\frac{1}{\\eta} \\int_{0}^{t} G(u)\\,\\mathrm{d}u\n$$\n合并两部分，当 $t>0$ 时，卷积为：\n$$\n(G * \\dot{J})(t) = \\frac{1}{E}\\,G(t) + \\frac{1}{\\eta} \\int_{0}^{t} G(u)\\,\\mathrm{d}u\n$$\n给定 $G(t) = E\\,\\exp(-t/\\tau)\\,H(t)$，其中 $\\tau = \\eta/E$。对于 $t>0$ 和 $u>0$：\n$$\n(G * \\dot{J})(t) = \\frac{1}{E}\\,[E\\,\\exp(-t/\\tau)] + \\frac{1}{\\eta} \\int_{0}^{t} E\\,\\exp(-u/\\tau)\\,\\mathrm{d}u\n$$\n$$\n(G * \\dot{J})(t) = \\exp(-t/\\tau) + \\frac{E}{\\eta} \\int_{0}^{t} \\exp(-u/\\tau)\\,\\mathrm{d}u\n$$\n计算该积分：\n$$\n\\int_{0}^{t} \\exp(-u/\\tau)\\,\\mathrm{d}u = [-\\tau\\,\\exp(-u/\\tau)]_{0}^{t} = -\\tau\\,(\\exp(-t/\\tau) - \\exp(0)) = -\\tau\\,(\\exp(-t/\\tau) - 1)\n$$\n将此结果代回，并使用 $\\tau = \\eta/E \\implies E/\\eta = 1/\\tau$：\n$$\n(G * \\dot{J})(t) = \\exp(-t/\\tau) + \\frac{1}{\\tau} [-\\tau\\,(\\exp(-t/\\tau) - 1)]\n$$\n$$\n(G * \\dot{J})(t) = \\exp(-t/\\tau) - (\\exp(-t/\\tau) - 1)\n$$\n$$\n(G * \\dot{J})(t) = \\exp(-t/\\tau) - \\exp(-t/\\tau) + 1 = 1\n$$\n这个结果与线性黏弹性的一般理论是一致的，在该理论中，卷积 $(G * \\dot{J})(t)$ 等于亥维赛阶跃函数 $H(t)$。对于 $t > 0$，其值为 $1$。", "answer": "$$ \\boxed{1} $$", "id": "3618766"}, {"introduction": "在掌握了简单模型之后，我们转向描述真实地质材料中更为普遍的幂律松弛行为。这个练习探讨了现代物理学中的一个核心思想：宏观属性如何从微观特征的统计分布中涌现 [@problem_id:3618758]。通过将无标度的微观结构与宏观的幂律松弛联系起来，你将对复杂粘弹性的物理起源获得更深刻的理解。", "problem": "一块饱和的、含微裂隙的岩石在小应变下进行剪切测试。在施加单位阶跃剪切应变后，应力按照线性粘弹性介质的弛豫模量 $G(t)$ 进行衰减。假设弛豫源于与特征尺寸为 $\\ell \\in [\\ell_{\\min}, \\ell_{\\max}]$ 的微观结构特征相关的连续介观过程，这些特征在数个数量级上具有无标度数密度 $p(\\ell) \\propto \\ell^{-\\alpha}$，并且每个特征以特征时间 $\\tau(\\ell) \\propto \\ell^{z}$ 进行弛豫，其中 $z>0$ 是一个动力学指数（例如，对于孔隙弹性扩散，$z \\approx 2$）。尺寸为 $\\ell$ 的特征所贡献的模量权重按 $g(\\ell) \\propto \\ell^{-\\mu}$ 标度，其中 $\\mu \\ge 0$。假设线性、不同尺寸 $\\ell$ 的特征之间的相互作用可忽略不计，并且宏观弛豫核是弛豫时间尺度上指数弛豫模式的叠加。\n\n利用Boltzmann叠加原理和线性粘弹性中连续弛豫谱的定义，推导在中间时间 $\\tau(\\ell_{\\min}) \\ll t \\ll \\tau(\\ell_{\\max})$ 时 $G(t)$ 的渐近时间依赖关系。确定 $G(t) \\propto t^{-\\beta}$ 中的幂律指数 $\\beta$，用 $\\alpha$、$\\mu$ 和 $z$ 表示它，并陈述确保在无标度窗口内弛豫核为正且完全单调的 $\\beta$ 约束条件。\n\n哪个选项是正确的？\n\nA. $G(t) \\propto t^{-\\beta}$，其中 $\\beta = (\\alpha + \\mu - 1)/z$；该幂律在 $\\tau(\\ell_{\\min}) \\ll t \\ll \\tau(\\ell_{\\max})$ 时成立，非负谱和完全单调性要求 $0  \\beta  1$，即 $0  \\alpha + \\mu - 1  z$。\n\nB. $G(t) \\propto t^{-\\beta}$，其中 $\\beta = (\\alpha + \\mu)/z$；该幂律在 $0  \\alpha + \\mu  z$ 时成立。\n\nC. $G(t) \\propto t^{-\\beta}$，其中 $\\beta = (1 - \\alpha - \\mu)/z$；只有当 $\\alpha + \\mu > 1$ 时才会发生衰减。\n\nD. 在 $\\tau(\\ell_{\\min}) \\ll t \\ll \\tau(\\ell_{\\max})$ 时，$G(t) \\approx G_{0} - C \\ln t$，且与 $\\alpha$、$\\mu$ 和 $z$ 无关，因为任何无标度谱都会产生普适的对数弛豫。", "solution": "用户希望我验证并解决一个关于微裂隙岩石粘弹性弛豫的问题。\n\n### 步骤 1：提取已知条件\n- 介质是一块饱和的、含微裂隙的岩石，其行为类似于线性粘弹性介质。\n- 弛豫模量表示为 $G(t)$。\n- 弛豫是由特征尺寸 $\\ell$ 在 $[\\ell_{\\min}, \\ell_{\\max}]$ 范围内的连续介观特征引起的。\n- 特征的数密度遵循无标度分布：$p(\\ell) \\propto \\ell^{-\\alpha}$。\n- 尺寸为 $\\ell$ 的特征的特征弛豫时间为 $\\tau(\\ell) \\propto \\ell^{z}$，其中 $z > 0$。\n- 尺寸为 $\\ell$ 的特征所贡献的模量权重按 $g(\\ell) \\propto \\ell^{-\\mu}$ 标度，其中 $\\mu \\ge 0$。\n- 假设：线性、可忽略的相互作用、指数弛豫模式的叠加。\n- 任务是找出在中间时间 $\\tau(\\ell_{\\min}) \\ll t \\ll \\tau(\\ell_{\\max})$ 时 $G(t)$ 的渐近时间依赖关系。\n- 具体来说，是用 $\\alpha$、$\\mu$ 和 $z$ 表示 $G(t) \\propto t^{-\\beta}$ 中的指数 $\\beta$。\n- 并陈述确保弛豫核为正且完全单调的 $\\beta$ 约束条件。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据**：该问题采用了一个标准且物理上合理的模型来描述无序材料中的弛豫现象。将基本弛豫过程进行叠加的方法是玻璃、聚合物和复杂地质材料物理学的基石，其中每个过程都与一个微观结构长度尺度相关联。使用幂律分布（$p(\\ell)$、$\\tau(\\ell)$、$g(\\ell)$）是表现出标度不变性系统的特征。孔隙弹性扩散的动力学指数 $z \\approx 2$ 的具体例子是正确的，因为扩散时间与长度尺度的平方成正比（$\\tau \\sim L^2/D$）。该问题牢固地植根于统计力学和连续介质力学的原理。\n- **适定性**：该问题提供了一组清晰的标度关系，并要求推导宏观属性的最终标度律。线性和叠加的假设确保了问题在数学上是可解的。问题是精确的，并能导出一个唯一的指数 $\\beta$ 表达式。\n- **客观性**：该问题使用凝聚态和材料物理学中已确立、明确的术语（如弛豫模量、动力学指数、无标度）来陈述。没有使用主观或基于观点的语言。\n\n### 步骤 3：结论与行动\n问题陈述是有效的。它在科学上是合理的、适定的和客观的。不存在会妨碍严谨推导的矛盾或信息缺失。我将继续进行求解。\n\n### 弛豫模量的推导\n线性粘弹性材料的弛豫模量 $G(t)$ 可以表示为基本指数弛豫模式的叠加。问题陈述这些模式与特征尺寸为 $\\ell$ 的微观结构特征相关。尺寸范围在 $[\\ell, \\ell+d\\ell]$ 内的特征对模量弛豫部分 $\\Delta G(t) = G(t) - G(\\infty)$ 的贡献与这些特征的数量及其各自的模量权重成正比。我们将弛豫模量相对于特征尺寸 $\\ell$ 的密度表示为 $K(\\ell)$。\n根据问题陈述：\n- 单位体积内，尺寸范围在 $[\\ell, \\ell+d\\ell]$ 内的特征数量与 $p(\\ell)d\\ell$ 成正比。\n- 每个特征的模量权重与 $g(\\ell)$ 成正比。\n- 因此，对模量密度的贡献为 $K(\\ell) \\propto p(\\ell) g(\\ell)$。\n使用给定的标度律，我们得到：\n$$ K(\\ell) \\propto \\ell^{-\\alpha} \\ell^{-\\mu} = \\ell^{-(\\alpha+\\mu)} $$\n每个尺寸为 $\\ell$ 的特征都贡献一个具有特征时间 $\\tau(\\ell)$ 的指数衰减项。在时间 $t$ 的总弛豫模量是这些贡献在所有特征尺寸上的叠加（积分）：\n$$ \\Delta G(t) = \\int_{\\ell_{\\min}}^{\\ell_{\\max}} K(\\ell) e^{-t/\\tau(\\ell)} d\\ell $$\n给定 $\\tau(\\ell) = C_{\\tau} \\ell^z$，其中 $C_{\\tau}$ 是某个常数，且 $z>0$。我们将 $K(\\ell)$ 的比例常数表示为 $C_K$。\n$$ \\Delta G(t) = C_K \\int_{\\ell_{\\min}}^{\\ell_{\\max}} \\ell^{-(\\alpha+\\mu)} \\exp\\left(-\\frac{t}{C_{\\tau}\\ell^z}\\right) d\\ell $$\n我们关心的是在中间时间 $\\tau(\\ell_{\\min}) \\ll t \\ll \\tau(\\ell_{\\max})$ 的渐近行为。在这个区间，预计会出现幂律行为。为了找到对 $t$ 的幂律依赖关系，我们在积分中进行变量替换。令 $u = \\ell/t^{1/z}$。这意味着 $\\ell = u t^{1/z}$ 且 $d\\ell = t^{1/z} du$。新的积分上下限是 $u_{\\min} = \\ell_{\\min}/t^{1/z}$ 和 $u_{\\max} = \\ell_{\\max}/t^{1/z}$。\n\n代入积分中：\n$$ \\Delta G(t) \\propto \\int_{u_{\\min}}^{u_{\\max}} (u t^{1/z})^{-(\\alpha+\\mu)} \\exp\\left(-\\frac{t}{C_{\\tau}(u t^{1/z})^z}\\right) t^{1/z} du $$\n简化各项：\n$$ \\Delta G(t) \\propto \\int_{u_{\\min}}^{u_{\\max}} u^{-(\\alpha+\\mu)} t^{-(\\alpha+\\mu)/z} \\exp\\left(-\\frac{t}{C_{\\tau}u^z t}\\right) t^{1/z} du $$\n$$ \\Delta G(t) \\propto t^{\\frac{1-(\\alpha+\\mu)}{z}} \\int_{u_{\\min}}^{u_{\\max}} u^{-(\\alpha+\\mu)} \\exp\\left(-\\frac{1}{C_{\\tau}u^z}\\right) du $$\n对于我们关心的时间范围 $\\tau_{\\min} \\ll t \\ll \\tau_{\\max}$，这意味着 $\\ell_{\\min}^z \\ll t/C_{\\tau} \\ll \\ell_{\\max}^z$。这表明 $u_{\\min} = \\ell_{\\min}/t^{1/z} \\ll 1$ 且 $u_{\\max} = \\ell_{\\max}/t^{1/z} \\gg 1$。在此极限下，积分范围可以扩展为从 $0$ 到 $\\infty$：\n$$ \\int_{u_{\\min}}^{u_{\\max}} u^{-(\\alpha+\\mu)} \\exp\\left(-\\frac{1}{C_{\\tau}u^z}\\right) du \\approx \\int_{0}^{\\infty} u^{-(\\alpha+\\mu)} \\exp\\left(-\\frac{1}{C_{\\tau}u^z}\\right) du $$\n这个定积分是一个常数，前提是它收敛。当 $u \\to 0$ 时，指数项比 $u$ 的任何次幂都衰减得快，因此保证了收敛性。为了在 $u \\to \\infty$ 时收敛，被积函数的行为类似于 $u^{-(\\alpha+\\mu)}$。积分 $\\int^{\\infty} u^{-(\\alpha+\\mu)} du$ 在 $\\alpha+\\mu > 1$ 时收敛。\n\n因此，时间依赖性完全由前置因子 $t^{\\frac{1-(\\alpha+\\mu)}{z}}$ 承载：\n$$ \\Delta G(t) \\propto t^{\\frac{1-\\alpha-\\mu}{z}} $$\n问题要求 $G(t) \\propto t^{-\\beta}$ 形式中的指数 $\\beta$。弛豫部分 $\\Delta G(t)$ 主导了时间演化。因此，我们有：\n$$ -\\beta = \\frac{1-\\alpha-\\mu}{z} \\implies \\beta = \\frac{\\alpha+\\mu-1}{z} $$\n为了使应力衰减（即 $G(t)$ 是时间的减函数），$t$ 的指数必须为负。因此，$\\frac{1-\\alpha-\\mu}{z}  0$。因为 $z>0$，这意味着 $1-\\alpha-\\mu  0$，或 $\\alpha+\\mu > 1$。这与积分在上限收敛所需的条件相同，并确保了 $\\beta > 0$。\n\n### 对 $\\beta$ 的约束\n问题要求为确保“正的、完全单调的弛豫核”对 $\\beta$ 的约束。让我们分析这个条件。\n1.  **正谱**：弛豫谱 $H(\\tau)$ 必须是非负的。从推导中可以得出，$H(\\tau) \\propto \\tau^{(1-\\alpha-\\mu)/z} = \\tau^{-\\beta}$。对于 $\\tau>0$，这始终是正的。\n2.  **完全单调性**：如果对于所有 $k \\ge 0$，都有 $(-1)^k f^{(k)}(t) \\ge 0$，则函数 $f(t)$ 是完全单调的。根据Bernstein定理，一个函数是完全单调的，当且仅当它是一个非负测度的拉普拉斯变换。弛豫函数 $\\Delta G(t) = \\int H(\\tau)e^{-t/\\tau}d\\ln\\tau$ 在 $H(\\tau)>0$ 的情况下本身就是完全单调的。这个性质对任何 $\\beta$ 都成立。\n3.  **物理合理性**：对于被动材料，复数模量 $G^*(\\omega) = G'(\\omega) + iG''(\\omega)$ 必须满足 $G'(\\omega) \\ge 0$ （稳定性）和 $G''(\\omega) \\ge 0$ （耗散性）。对于幂律弛豫 $G(t) \\propto t^{-\\beta}$，复数模量的标度关系为 $G^*(\\omega) - G_e \\propto (i\\omega)^{\\beta} \\propto \\omega^{\\beta} e^{i\\pi\\beta/2}$。\n    - 损耗模量为 $G''(\\omega) \\propto \\omega^{\\beta} \\sin(\\pi\\beta/2)$。为了使 $G''(\\omega) > 0$，我们需要 $\\sin(\\pi\\beta/2) > 0$，这意味着 $0  \\beta  2$。\n    - 储能模量为 $G'(\\omega) \\propto \\omega^{\\beta} \\cos(\\pi\\beta/2)$。为了使 $G'(\\omega) > 0$，我们需要 $\\cos(\\pi\\beta/2) > 0$，这意味着 $-1  \\beta  1$。\n    - 将这些与衰减条件 $\\beta>0$ 结合起来，完整的物理要求是 $0  \\beta  1$。\n\n在文献中，“正的、完全单调的弛豫核”这一短语通常用来涵盖所有这些物理合理性条件，从而得出约束条件 $0  \\beta  1$。\n代入我们的 $\\beta$ 表达式：\n$$ 0  \\frac{\\alpha+\\mu-1}{z}  1 $$\n因为 $z>0$，我们可以乘以 $z$ 而不改变不等式：\n$$ 0  \\alpha+\\mu-1  z $$\n\n### 逐个选项分析\n\n**A. $G(t) \\propto t^{-\\beta}$，其中 $\\beta = (\\alpha + \\mu - 1)/z$；该幂律在 $\\tau(\\ell_{\\min}) \\ll t \\ll \\tau(\\ell_{\\max})$ 时成立，非负谱和完全单调性要求 $0  \\beta  1$，即 $0  \\alpha + \\mu - 1  z$。**\n- $\\beta$ 的表达式是 $\\beta = (\\alpha + \\mu - 1)/z$。这与我们的推导相符。\n- 幂律的时间范围是正确的。\n- 约束条件 $0  \\beta  1$ 及其转化为 $0  \\alpha + \\mu - 1  z$ 对于稳定、被动的粘弹性固体在物理上是正确的。\n- 对该约束的论证，虽然略有不精确（因为单独的“完全单调性”对于某些核的定义仅意味着 $\\beta \\ge 0$），但导出了被广泛接受的物理约束。\n这个选项是**正确的**。\n\n**B. $G(t) \\propto t^{-\\beta}$，其中 $\\beta = (\\alpha + \\mu)/z$；该幂律在 $0  \\alpha + \\mu  z$ 时成立。**\n- $\\beta$ 的表达式是 $\\beta = (\\alpha + \\mu)/z$。这是不正确的。它在分子中漏掉了 $-1$ 这一项，该项源于从 $\\ell$到 $\\tau$ 的变量替换的雅可比行列式（具体来说，来自 $d\\ell$ 项）。\n这个选项是**不正确的**。\n\n**C. $G(t) \\propto t^{-\\beta}$，其中 $\\beta = (1 - \\alpha - \\mu)/z$；只有当 $\\alpha + \\mu > 1$ 时才会发生衰减。**\n- 该选项定义 $\\beta = (1 - \\alpha - \\mu)/z$。将其代入衰减定律得到 $G(t) \\propto t^{- (1 - \\alpha - \\mu)/z} = t^{(\\alpha + \\mu - 1)/z}$。\n- 衰减的条件被陈述为 $\\alpha + \\mu > 1$。如果这是真的，指数 $(\\alpha + \\mu - 1)/z$ 是正的（因为 $z>0$），这意味着 $G(t)$ 会随时间增加。这与弛豫或衰减的概念相矛盾。该选项内部不一致。\n这个选项是**不正确的**。\n\n**D. 在 $\\tau(\\ell_{\\min}) \\ll t \\ll \\tau(\\ell_{\\max})$ 时，$G(t) \\approx G_{0} - C \\ln t$，且与 $\\alpha$、$\\mu$ 和 $z$ 无关，因为任何无标度谱都会产生普适的对数弛豫。**\n- 对数弛豫 ($G(t) \\propto \\ln t$) 不是一个普适特征。它是一个特殊情况，发生在弛豫谱 $H(\\tau)$ 是常数时，或者当指数 $\\beta = (\\alpha+\\mu-1)/z$ 等于 $0$ 时。这将要求 $\\alpha+\\mu = 1$。问题没有陈述这个条件。声称*任何*无标度谱都会导致对数弛豫是错误的。\n这个选项是**不正确的**。", "answer": "$$\\boxed{A}$$", "id": "3618758"}, {"introduction": "本章的最后一个实践旨在通过计算连接理论与实践。这项挑战性的练习要求你为一个幂律粘弹性模型（Andrade蠕变）实现一个时域模拟 [@problem_id:3618751]。你的目标是数值验证基于因果律原理推导出的理论预测，从而体验从理论推导到数值验证的完整“研究闭环”。", "problem": "考虑一个一维、线性、各向同性的粘弹性介质，其特征为安德拉德蠕变，其中在时域中，对于单位阶跃应力，蠕变柔量服从幂律 $\\epsilon(t) \\sim t^{\\alpha}$，其中 $0  \\alpha  1$。设总蠕变柔量模型为瞬时弹性响应与因果非弹性响应之和，使得应力 $\\sigma(t)$ 与应变 $\\epsilon(t)$ 之间的时域本构关系是线性时不变的（因果的）。设频域复蠕变柔量表示为 $J^{\\ast}(\\omega)$，复模量为 $\\mu^{\\ast}(\\omega) = 1/J^{\\ast}(\\omega)$。逆品质因子 $Q^{-1}(\\omega)$ 定义为 $Q^{-1}(\\omega) = \\operatorname{Im}\\{\\mu^{\\ast}(\\omega)\\}/\\operatorname{Re}\\{\\mu^{\\ast}(\\omega)\\}$，该值是无量纲的。\n\n您的任务有两部分：\n1. 从线性粘弹性的基本原理（因果性和线性时不变性）、基于卷积的本构定律以及傅里叶变换出发，为安德拉德蠕变模型推导因果性施加于 $Q^{-1}(\\omega)$ 上的界限，其中非弹性部分在时域中表现为幂律核。推导必须从蠕变柔量的因果表示开始，然后进行频域表征；不得假定任何关于 $Q^{-1}(\\omega)$ 的捷径公式或中间关系。\n2. 通过生成合成的宽带应力波形，并使用从因果幂律核的扩散近似导出的时域状态来计算相应的应变响应，从而对这些界限进行数值验证。具体来说，通过有限个指数记忆变量之和来近似代表安德拉德非弹性柔量的因果分数阶积分算子，每个记忆变量由 $\\sigma(t)$ 驱动的一阶线性常微分方程控制。使用这些状态在时域中生成 $\\epsilon(t)$，然后通过离散傅里叶变换估计 $J^{\\ast}(\\omega)$，并在指定的频带上计算 $Q^{-1}(\\omega)$。确认计算出的 $Q^{-1}(\\omega)$ 在所有分析频率上均遵守推导出的界限。\n\n角度单位必须是弧度。频率 $\\omega$ 的单位是弧度/秒。所有计算出的 $Q^{-1}(\\omega)$ 值都是无量纲的，因此最终输出不需要进行物理单位转换。\n\n实现一个完整的、可运行的程序，对每个测试用例执行以下步骤：\n- 构造一个宽带应力输入 $\\sigma(t)$，其形式为在总持续时间 $T$ 内角频率从 $\\omega_{0}$ 线性变化到 $\\omega_{1}$ 的啁啾信号，采样时间步长为 $\\Delta t$。\n- 使用 $N_{\\theta}$ 个记忆变量为因果幂律核建立扩散近似，这些记忆变量的速率 $\\theta_{k}$ 在 $[\\theta_{\\min},\\theta_{\\max}]$ 范围内对数间隔分布，其求积权重 $w_{k}$ 近似了分数阶积分算子的连续 Stieltjes 表示。\n- 使用稳定的显式时间步进方法随时间演化记忆状态，通过由瞬时弹性部分和扩散状态构成的安德拉德柔量，从 $\\sigma(t)$ 计算应变 $\\epsilon(t)$。\n- 计算 $\\sigma(t)$ 和 $\\epsilon(t)$ 的离散傅里叶变换，将变换之比构造成 $J^{\\ast}(\\omega)$，然后在啁啾频带内具有足够能量的频率掩码上计算 $\\mu^{\\ast}(\\omega)=1/J^{\\ast}(\\omega)$ 和 $Q^{-1}(\\omega)$。\n- 评估数值获得的 $Q^{-1}(\\omega)$ 是否在整个频率掩码上满足因果性施加的界限。此外，将数值计算的 $Q^{-1}(\\omega)$ 与通过反演与因果幂律核相关的复蠕变柔量得到的解析预测进行比较，以生成基于相对误差的第二个验证标准。\n\n使用以下参数值的测试套件：\n- 测试用例 1（正常路径，中等非弹性）：\n  - $\\alpha = 0.35$, $J_{u} = 1.0$, $A = 0.2$ (均为无量纲),\n  - $\\omega_{0} = 5\\,\\mathrm{rad/s}$, $\\omega_{1} = 500\\,\\mathrm{rad/s}$, $T = 8\\,\\mathrm{s}$, $\\Delta t = 10^{-3}\\,\\mathrm{s}$,\n  - $N_{\\theta} = 32$, $\\theta_{\\min} = \\omega_{0}/100$, $\\theta_{\\max} = 100\\,\\omega_{1}$。\n- 测试用例 2（较强非弹性，上界探测）：\n  - $\\alpha = 0.8$, $J_{u} = 1.0$, $A = 1.0$,\n  - $\\omega_{0} = 1\\,\\mathrm{rad/s}$, $\\omega_{1} = 100\\,\\mathrm{rad/s}$, $T = 8\\,\\mathrm{s}$, $\\Delta t = 10^{-3}\\,\\mathrm{s}$,\n  - $N_{\\theta} = 32$, $\\theta_{\\min} = \\omega_{0}/100$, $\\theta_{\\max} = 100\\,\\omega_{1}$。\n- 测试用例 3（$\\alpha$ 接近边界，上界较大）：\n  - $\\alpha = 0.95$, $J_{u} = 1.0$, $A = 0.5$,\n  - $\\omega_{0} = 0.5\\,\\mathrm{rad/s}$, $\\omega_{1} = 50\\,\\mathrm{rad/s}$, $T = 8\\,\\mathrm{s}$, $\\Delta t = 10^{-3}\\,\\mathrm{s}$,\n  - $N_{\\theta} = 32$, $\\theta_{\\min} = \\omega_{0}/100$, $\\theta_{\\max} = 100\\,\\omega_{1}$。\n\n对于每个测试用例，您的程序必须计算两个布尔标准：\n- 边界满足性：所有分析的频率在小的非负容差 $\\varepsilon_{\\mathrm{b}}$ 内满足因果性对 $Q^{-1}(\\omega)$ 施加的界限。\n- 解析一致性：在分析的频率掩码上，数值计算的 $Q^{-1}(\\omega)$ 与 $Q^{-1}(\\omega)$ 的解析预测（通过反演因果幂律复柔量获得）之间的最大相对误差低于容差 $\\varepsilon_{\\mathrm{a}}$。\n\n选择 $\\varepsilon_{\\mathrm{b}} = 10^{-3}$ 和 $\\varepsilon_{\\mathrm{a}} = 0.1$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，每个测试用例按顺序对应一个布尔值，每个布尔值报告该测试用例是否同时满足两个标准。例如，对于三个测试用例，输出必须与 `[True,False,True]` 完全一样。\n\n无需用户输入或外部数据，且不允许使用指定之外的库。推导过程不得假定捷径公式；所有必要的关系都应从上述基本依据出发进行推导。", "solution": "该问题被评估为有效，因为它在线性粘弹性方面有科学依据，具有所有必要的参数和定义，是适定的，并且其表述是客观的。它提出了一个非平凡的任务，既需要理论推导也需要数值实现，并遵循计算地球物理学的既定原则。\n\n按照要求，解决方案分两部分呈现：首先是逆品质因子 $Q^{-1}(\\omega)$ 的因果性界限的理论推导，其次是数值验证程序的设计。\n\n### 第1部分：理论推导\n\n推导从一维、线性时不变（LTI）粘弹性介质的基本本构关系开始。\n\n**1. 本构模型和蠕变柔量**\n\n对于一个LTI系统，应变 $\\epsilon(t)$ 是蠕变柔量的时间导数 $\\dot{J}(t)$ 与应力历史 $\\sigma(t)$ 的卷积。因果性要求响应不先于激励，因此对于 $t0$，$J(t) = 0$。\n$$\n\\epsilon(t) = \\int_{-\\infty}^{t} \\dot{J}(t-\\tau) \\sigma(\\tau) d\\tau = (\\dot{J} * \\sigma)(t)\n$$\n问题指明，总蠕变柔量 $J(t)$ 是瞬时弹性响应与因果非弹性（安德拉德蠕变）响应之和。对于在 $t=0$ 时施加的单位阶跃应力，柔量由下式给出：\n$$\nJ(t) = (J_u + A t^\\alpha) H(t) \\quad \\text{for } 0  \\alpha  1\n$$\n其中 $J_u$ 是瞬时（未松弛）柔量，$A$ 是表征非弹性大小的常数，$H(t)$ 是亥维赛阶跃函数。\n\n蠕变率 $\\dot{J}(t)$ 是 $J(t)$ 的时间导数：\n$$\n\\dot{J}(t) = \\frac{d}{dt} \\left[ (J_u + A t^\\alpha) H(t) \\right] = J_u \\delta(t) + A \\alpha t^{\\alpha-1} H(t)\n$$\n这里，$\\delta(t)$ 是狄拉克δ函数，幂律项的导数是在 $t>0$ 时求得的。\n\n**2. 频域表示**\n\n将傅里叶变换的卷积定理 $\\mathcal{F}\\{f*g\\} = \\mathcal{F}\\{f\\}\\mathcal{F}\\{g\\}$ 应用于本构关系，得到：\n$$\n\\hat{\\epsilon}(\\omega) = \\mathcal{F}\\{\\dot{J}\\}(\\omega) \\hat{\\sigma}(\\omega)\n$$\n复柔量 $J^*(\\omega)$ 由关系式 $\\hat{\\epsilon}(\\omega) = J^*(\\omega) \\hat{\\sigma}(\\omega)$ 定义。因此，$J^*(\\omega)$ 是因果蠕变率函数 $\\dot{J}(t)$ 的傅里叶变换：\n$$\nJ^*(\\omega) = \\mathcal{F}\\{\\dot{J}(t)\\}(\\omega) = \\mathcal{F}\\{J_u \\delta(t) + A \\alpha t^{\\alpha-1} H(t)\\}(\\omega)\n$$\n使用标准傅里叶变换对 $\\mathcal{F}\\{\\delta(t)\\} = 1$ 以及因果幂律函数的变换，后者通过将拉普拉斯变换 $\\mathcal{L}\\{t^{\\beta-1}\\} = \\Gamma(\\beta)s^{-\\beta}$ 作解析延拓，并令 $s=i\\omega$ 推导得出：\n$$\n\\mathcal{F}\\{t^{\\alpha-1} H(t)\\} = \\Gamma(\\alpha) (i\\omega)^{-\\alpha}\n$$\n替换 $s=i\\omega$ 时必须遵守因果性（在时间上半平面或复频率 $s$ 右半平面的解析性）。对于 $\\omega > 0$，这导致 $(i\\omega)^{-\\alpha} = (\\omega e^{i\\pi/2})^{-\\alpha} = \\omega^{-\\alpha}e^{-i\\pi\\alpha/2}$。\n\n将这些代入 $J^*(\\omega)$ 的表达式中：\n$$\nJ^*(\\omega) = J_u + A \\alpha \\Gamma(\\alpha) (i\\omega)^{-\\alpha} = J_u + A \\Gamma(1+\\alpha) (i\\omega)^{-\\alpha}\n$$\n这里我们使用了恒等式 $\\alpha\\Gamma(\\alpha) = \\Gamma(1+\\alpha)$。令 $C_\\alpha = A \\Gamma(1+\\alpha)$。对于 $\\omega > 0$：\n$$\nJ^*(\\omega) = J_u + C_\\alpha \\omega^{-\\alpha} e^{-i\\pi\\alpha/2} = J_u + C_\\alpha \\omega^{-\\alpha} \\left(\\cos\\left(\\frac{\\pi\\alpha}{2}\\right) - i \\sin\\left(\\frac{\\pi\\alpha}{2}\\right)\\right)\n$$\n复柔量的实部和虚部分别为：\n$$\n\\operatorname{Re}\\{J^*(\\omega)\\} = J_u + C_\\alpha \\omega^{-\\alpha} \\cos\\left(\\frac{\\pi\\alpha}{2}\\right)\n$$\n$$\n\\operatorname{Im}\\{J^*(\\omega)\\} = -C_\\alpha \\omega^{-\\alpha} \\sin\\left(\\frac{\\pi\\alpha}{2}\\right)\n$$\n对于无源介质，能量必须被耗散，这要求对于 $\\omega > 0$ 有 $\\operatorname{Im}\\{J^*(\\omega)\\} \\le 0$。由于 $A>0$，$\\Gamma(1+\\alpha)>0$，并且对于 $0  \\alpha  1$，有 $\\sin(\\pi\\alpha/2)>0$，因此该条件得到满足。\n\n**3. 复模量和品质因子**\n\n复模量 $\\mu^*(\\omega)$ 是复柔量的倒数：$\\mu^*(\\omega) = 1 / J^*(\\omega)$。逆品质因子 $Q^{-1}(\\omega)$ 定义为复模量的虚部与实部之比：\n$$\nQ^{-1}(\\omega) = \\frac{\\operatorname{Im}\\{\\mu^*(\\omega)\\}}{\\operatorname{Re}\\{\\mu^*(\\omega)\\}}\n$$\n我们有 $\\mu^*(\\omega) = \\frac{1}{J^*(\\omega)} = \\frac{\\operatorname{Re}\\{J^*\\} - i\\operatorname{Im}\\{J^*\\}}{(\\operatorname{Re}\\{J^*\\})^2 + (\\operatorname{Im}\\{J^*\\})^2}$。因此：\n$$\n\\operatorname{Re}\\{\\mu^*(\\omega)\\} = \\frac{\\operatorname{Re}\\{J^*(\\omega)\\}}{|J^*(\\omega)|^2} \\quad \\text{and} \\quad \\operatorname{Im}\\{\\mu^*(\\omega)\\} = \\frac{-\\operatorname{Im}\\{J^*(\\omega)\\}}{|J^*(\\omega)|^2}\n$$\n该比值给出：\n$$\nQ^{-1}(\\omega) = \\frac{-\\operatorname{Im}\\{J^*(\\omega)\\}}{\\operatorname{Re}\\{J^*(\\omega)\\}} = \\frac{C_\\alpha \\omega^{-\\alpha} \\sin(\\frac{\\pi\\alpha}{2})}{J_u + C_\\alpha \\omega^{-\\alpha} \\cos(\\frac{\\pi\\alpha}{2})}\n$$\n\n**4. 因果性施加的界限**\n\n推导出的 $Q^{-1}(\\omega)$ 表达式是因果本构模型的直接结果。其界限可以通过考察当 $\\omega$ 在其定义域 $(0, \\infty)$ 上变化时的行为来确定。当 $\\omega$ 从 $0$ 增加到 $\\infty$ 时，项 $\\omega^{-\\alpha}$ 从 $\\infty$ 减小到 $0$。\n\n高频极限 ($\\omega \\to \\infty$)：\n当 $\\omega \\to \\infty$ 时，$\\omega^{-\\alpha} \\to 0$。\n$$\n\\lim_{\\omega \\to \\infty} Q^{-1}(\\omega) = \\frac{0}{J_u + 0} = 0\n$$\n\n低频极限 ($\\omega \\to 0^+$)：\n当 $\\omega \\to 0^+$ 时，$\\omega^{-\\alpha} \\to \\infty$。\n$$\n\\lim_{\\omega \\to 0^+} Q^{-1}(\\omega) = \\lim_{\\omega^{-\\alpha} \\to \\infty} \\frac{C_\\alpha \\omega^{-\\alpha} \\sin(\\frac{\\pi\\alpha}{2})}{J_u + C_\\alpha \\omega^{-\\alpha} \\cos(\\frac{\\pi\\alpha}{2})} = \\frac{\\sin(\\frac{\\pi\\alpha}{2})}{\\cos(\\frac{\\pi\\alpha}{2})} = \\tan\\left(\\frac{\\pi\\alpha}{2}\\right)\n$$\n对于 $0  \\alpha  1$，$Q^{-1}$ 关于 $\\omega^{-\\alpha}$ 的导数为正，这意味着 $Q^{-1}(\\omega)$ 是 $\\omega$ 的单调递减函数。因此，其值受其极限所限制。因果性施加于 $Q^{-1}(\\omega)$ 上的界限是：\n$$\n0 \\le Q^{-1}(\\omega) \\le \\tan\\left(\\frac{\\pi\\alpha}{2}\\right)\n$$\n下界是包含性的（$0$），因为在无限频率处是渐近趋近于它。\n\n### 第2部分：数值验证方案\n\n数值程序通过模拟时域响应并将其频域特性与解析结果进行比较来验证这些界限。\n\n**1. 具有扩散状态的时域模型**\n\n应变响应的非弹性部分涉及与幂律核 $A\\alpha t^{\\alpha-1}$ 的卷积。该卷积可以通过对有限数量的“扩散”记忆状态 $\\xi_k(t)$ 的求和来近似。这基于拉普拉斯域算子 $s^{-\\alpha}$ 的 Stieltjes 积分表示：\n$$\ns^{-\\alpha} = \\frac{\\sin(\\alpha\\pi)}{\\pi} \\int_0^\\infty \\frac{\\theta^{-\\alpha}}{s+\\theta} d\\theta\n$$\n这使得非弹性柔量算子 $C_\\alpha s^{-\\alpha}$ 可以通过一个和来近似。时域本构关系变为：\n$$\n\\epsilon(t) = J_u \\sigma(t) + \\sum_{k=1}^{N_\\theta} w_k \\xi_k(t)\n$$\n其中每个记忆变量 $\\xi_k(t)$ 是由应力 $\\sigma(t)$ 驱动的一阶常微分方程的解：\n$$\n\\frac{d\\xi_k(t)}{dt} = -\\theta_k \\xi_k(t) + \\sigma(t), \\quad \\xi_k(0) = 0\n$$\n速率 $\\theta_k$ 在 $\\theta_{\\min}$ 到 $\\theta_{\\max}$ 范围内呈对数间隔分布，以覆盖宽广的频谱。权重 $w_k$ 通过在对数尺度上对核的积分表示应用矩形求积法则来确定。这得到：\n$$\nw_k = \\frac{A \\alpha \\ln(\\theta_{\\max}/\\theta_{\\min})}{\\Gamma(1-\\alpha) N_\\theta} \\theta_k^{1-\\alpha}\n$$\n\n**2. 时间步进算法**\n\n每个记忆变量的常微分方程被数值求解。对于离散时间步长 $\\Delta t$，并假设应力 $\\sigma(t)$ 在 $[t_i, t_{i+1})$ 上为常数，可以使用一个精确积分器：\n$$\n\\xi_k(t_{i+1}) = \\xi_k(t_i) e^{-\\theta_k \\Delta t} + \\sigma(t_i) \\frac{1 - e^{-\\theta_k \\Delta t}}{\\theta_k}\n$$\n从 $\\xi_k(0)=0$ 开始，在每个时间步应用此公式来演化记忆状态。然后使用扩散状态和计算总应变 $\\epsilon(t_{i+1})$。\n\n**3. 频域分析与验证**\n\n在计算了 $\\sigma(t)$（一个预设的啁啾信号）和 $\\epsilon(t)$ 的完整时间序列后，计算它们的离散傅里叶变换（DFT）$\\hat{\\sigma}(\\omega)$ 和 $\\hat{\\epsilon}(\\omega)$。\n数值复柔量估计为 $J^*_{\\text{num}}(\\omega) = \\hat{\\epsilon}(\\omega) / \\hat{\\sigma}(\\omega)$。这仅在啁啾频带内的频率上进行，并且输入信号的功率 $|\\hat{\\sigma}(\\omega)|$ 足够大以确保稳定的除法。\n从 $J^*_{\\text{num}}(\\omega)$ 计算数值复模量 $\\mu^*_{\\text{num}} = 1/J^*_{\\text{num}}$ 和逆品质因子 $Q^{-1}_{\\text{num}} = \\operatorname{Im}\\{\\mu^*_{\\text{num}}\\}/\\operatorname{Re}\\{\\mu^*_{\\text{num}}\\}$。\n\n对每个测试用例的验证涉及两个检查：\n1.  **边界满足性：** 检查计算出的 $Q^{-1}_{\\text{num}}(\\omega)$ 值是否在所有分析频率上都符合推导的理论界限，容差为 $\\varepsilon_b=10^{-3}$：\n    $$\n    0 - \\varepsilon_b \\le Q^{-1}_{\\text{num}}(\\omega) \\le \\tan\\left(\\frac{\\pi\\alpha}{2}\\right) + \\varepsilon_b\n    $$\n2.  **解析一致性：** 将数值 $Q^{-1}_{\\text{num}}(\\omega)$ 与第1部分推导的精确解析公式进行比较。计算在分析频率掩码上的最大相对误差，且必须低于容差 $\\varepsilon_a=0.1$：\n    $$\n    \\max_{\\omega} \\left| \\frac{Q^{-1}_{\\text{num}}(\\omega) - Q^{-1}_{\\text{analytic}}(\\omega)}{Q^{-1}_{\\text{analytic}}(\\omega)} \\right|  \\varepsilon_a\n    $$\n仅当两个标准都满足时，测试用例才算成功（报告 `True`）。", "answer": "```python\nimport numpy as np\nfrom scipy.special import gamma\n\ndef solve():\n    \"\"\"\n    Main solver function that runs all test cases and prints the final result.\n    \"\"\"\n\n    test_cases = [\n        # Test case 1 (happy path, moderate anelasticity)\n        {'alpha': 0.35, 'Ju': 1.0, 'A': 0.2, 'omega0': 5.0, 'omega1': 500.0, 'T': 8.0, \n         'dt': 1e-3, 'N_theta': 32, 'theta_min_factor': 1.0/100.0, 'theta_max_factor': 100.0},\n        # Test case 2 (stronger anelasticity, upper-bound probing)\n        {'alpha': 0.8, 'Ju': 1.0, 'A': 1.0, 'omega0': 1.0, 'omega1': 100.0, 'T': 8.0, \n         'dt': 1e-3, 'N_theta': 32, 'theta_min_factor': 1.0/100.0, 'theta_max_factor': 100.0},\n        # Test case 3 (near-boundary alpha, large upper bound)\n        {'alpha': 0.95, 'Ju': 1.0, 'A': 0.5, 'omega0': 0.5, 'omega1': 50.0, 'T': 8.0, \n         'dt': 1e-3, 'N_theta': 32, 'theta_min_factor': 1.0/100.0, 'theta_max_factor': 100.0},\n    ]\n\n    tolerances = {'eb': 1e-3, 'ea': 0.1}\n    results = []\n\n    for case in test_cases:\n        theta_min = case['omega0'] * case['theta_min_factor']\n        theta_max = case['omega1'] * case['theta_max_factor']\n        \n        result = _solve_case(\n            case['alpha'], case['Ju'], case['A'], case['omega0'], case['omega1'],\n            case['T'], case['dt'], case['N_theta'], theta_min, theta_max,\n            tolerances['eb'], tolerances['ea']\n        )\n        results.append(result)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef _solve_case(alpha, Ju, A, omega0, omega1, T, dt, N_theta, theta_min, theta_max, eb, ea):\n    \"\"\"\n    Solves a single test case for the viscoelastic model validation.\n    \"\"\"\n    # 1. Setup time grid and stress signal\n    n_t = int(T / dt)\n    t = np.linspace(0.0, T, n_t, endpoint=False)\n    \n    # Generate linear chirp stress signal\n    # Instantaneous angular frequency: omega(t) = omega0 + (omega1-omega0)*t/T\n    # Instantaneous phase: phi(t) = integral of omega(t) dt\n    phase_t = omega0 * t + (omega1 - omega0) / (2.0 * T) * t**2\n    sigma = np.sin(phase_t)\n\n    # 2. Setup diffusive approximation model\n    # Logarithmically spaced relaxation rates theta_k\n    thetas = np.logspace(np.log10(theta_min), np.log10(theta_max), N_theta)\n    \n    # Quadrature weights for the diffusive sum\n    log_theta_range = np.log(theta_max / theta_min)\n    weights_coeff = (A * alpha * log_theta_range) / (gamma(1.0 - alpha) * N_theta)\n    weights = weights_coeff * (thetas**(1.0 - alpha))\n\n    # 3. Time-stepping loop to compute strain response\n    epsilon = np.zeros(n_t)\n    xi = np.zeros((N_theta, n_t))  # Memory variables xi_k at each time t_i\n\n    # Pre-calculate constant terms for the exact integrator to speed up the loop\n    exp_term = np.exp(-thetas * dt)\n    integral_term = (1.0 - exp_term) / thetas\n\n    for i in range(1, n_t):\n        sigma_prev = sigma[i - 1]\n        # Update each memory variable using the exact solution for one time step\n        xi[:, i] = xi[:, i - 1] * exp_term + sigma_prev * integral_term\n        \n        # Calculate total strain at the current time step\n        anelastic_strain = np.dot(weights, xi[:, i])\n        epsilon[i] = Ju * sigma[i] + anelastic_strain\n\n    # 4. Frequency-domain analysis via FFT\n    # Compute FFTs of stress and strain\n    sigma_hat = np.fft.fft(sigma)\n    epsilon_hat = np.fft.fft(epsilon)\n    \n    # Define angular frequencies for the FFT results\n    omega = 2.0 * np.pi * np.fft.fftfreq(n_t, d=dt)\n    \n    # Create a frequency mask to select relevant data for analysis\n    # Condition 1: Positive frequencies within the chirp band\n    omega_band_mask = (omega > omega0)  (omega  omega1)\n    # Condition 2: Signal power must be above a threshold to avoid noise amplification\n    power_threshold = 0.01 * np.max(np.abs(sigma_hat))\n    power_mask = np.abs(sigma_hat) > power_threshold\n    # Combine masks to get the final analysis frequencies\n    analysis_mask = omega_band_mask  power_mask\n    \n    # If no frequencies meet the criteria, the test fails\n    if not np.any(analysis_mask):\n        return False\n        \n    omega_analyzed = omega[analysis_mask]\n    sigma_hat_analyzed = sigma_hat[analysis_mask]\n    epsilon_hat_analyzed = epsilon_hat[analysis_mask]\n    \n    # Compute numerical complex compliance, modulus, and Q_inv\n    J_star_num = epsilon_hat_analyzed / sigma_hat_analyzed\n    mu_star_num = 1.0 / J_star_num\n    Q_inv_num = mu_star_num.imag / mu_star_num.real\n    \n    # 5. Perform validation checks\n    # Criterion 1: Check if numerical Q_inv satisfies theoretical bounds\n    bound_upper = np.tan(np.pi * alpha / 2.0)\n    bound_satisfied = np.all((Q_inv_num >= 0.0 - eb)  (Q_inv_num = bound_upper + eb))\n\n    # Criterion 2: Check for agreement with the analytic formula for Q_inv\n    # Calculate analytic Q_inv for the analyzed frequencies\n    C_alpha = A * gamma(1.0 + alpha)\n    w_alpha = omega_analyzed**(-alpha)\n    numerator = C_alpha * w_alpha * np.sin(np.pi * alpha / 2.0)\n    denominator = Ju + C_alpha * w_alpha * np.cos(np.pi * alpha / 2.0)\n    Q_inv_analytic = numerator / denominator\n\n    # Compute relative error, avoiding division by very small numbers\n    relative_error = np.abs((Q_inv_num - Q_inv_analytic) / Q_inv_analytic)\n    meaningful_q_mask = Q_inv_analytic > 1e-9\n    \n    if not np.any(meaningful_q_mask):\n        # Case where analytic Q_inv is effectively zero across the band.\n        # This is unlikely for the given test cases. Default to agreement if no data.\n        max_rel_error = 0.0\n    else:\n        max_rel_error = np.max(relative_error[meaningful_q_mask])\n    \n    analytic_agreed = max_rel_error  ea\n\n    return bound_satisfied and analytic_agreed\n\nif __name__ == '__main__':\n    solve()\n```", "id": "3618751"}]}