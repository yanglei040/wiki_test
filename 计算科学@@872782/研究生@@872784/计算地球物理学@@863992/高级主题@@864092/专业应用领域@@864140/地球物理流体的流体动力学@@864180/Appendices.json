{"hands_on_practices": [{"introduction": "粘性耗散是真实流体中机械能不可逆地转化为热能的基本过程。理解和量化这个能量汇项对于分析从海洋环流到地幔对流等地球物理流动的能量收支至关重要。本练习将从柯西动量方程出发，为一个简单的剪切流推导并计算粘性耗散率，从而将抽象的能量守恒定律与具体的流场联系起来。[@problem_id:3597106]", "problem": "考虑一个在三维空间中，具有恒定动力粘度 $\\mu$ 和质量密度 $\\rho$ 的不可压缩牛顿流体。其速度场为一稳态、空间均匀的简单剪切流，\n$$\n\\boldsymbol{u}(x,y,z) = \\left(S\\,y,\\,0,\\,0\\right),\n$$\n其中 $S$ 为恒定的剪切率。从指数形式的柯西动量方程出发，\n$$\n\\rho\\,\\frac{D u_{i}}{D t} = \\partial_{j}\\,\\sigma_{ij} + \\rho\\,b_{i},\n$$\n其中牛顿应力为 $\\sigma_{ij} = -p\\,\\delta_{ij} + 2\\,\\mu\\,S_{ij}$，应变率张量为 $S_{ij} = \\frac{1}{2}\\left(\\partial_{i}u_{j} + \\partial_{j}u_{i}\\right)$，且不可压缩条件为 $\\partial_{i}u_{i} = 0$。推导动能收支方程，并用 $S_{ij}$ 和 $\\mu$ 表示体积粘性耗散项（单位体积的粘性耗散率）。然后，对于给定的剪切流，计算该粘性耗散率的显式闭合形式，作为 $S$ 和 $\\mu$ 的函数。简要解释它在该流动的机械能收支中的作用。以仅含 $S$ 和 $\\mu$ 的单个符号表达式形式给出粘性耗散率的最终结果；不要包含单位。", "solution": "我们从不可压缩牛顿流体的柯西动量方程开始，\n$$\n\\rho\\,\\frac{D u_{i}}{D t} = \\partial_{j}\\,\\sigma_{ij} + \\rho\\,b_{i},\n$$\n其中应力为 $\\sigma_{ij} = -p\\,\\delta_{ij} + 2\\,\\mu\\,S_{ij}$，应变率张量为 $S_{ij} = \\frac{1}{2}\\left(\\partial_{i}u_{j} + \\partial_{j}u_{i}\\right)$。目标是得到动能收支方程并确定单位体积的粘性耗散率。\n\n将动量方程与 $u_{i}$ 做点积，并使用乘法法则，可得\n$$\n\\rho\\,u_{i}\\,\\frac{D u_{i}}{D t} = u_{i}\\,\\partial_{j}\\,\\sigma_{ij} + \\rho\\,u_{i}\\,b_{i}.\n$$\n我们使用恒等式 $u_{i}\\,\\frac{D u_{i}}{D t} = \\frac{D}{D t}\\left(\\frac{1}{2}u_{i}u_{i}\\right)$，并将应力散度项重写为\n$$\nu_{i}\\,\\partial_{j}\\,\\sigma_{ij} = \\partial_{j}\\left(u_{i}\\,\\sigma_{ij}\\right) - \\sigma_{ij}\\,\\partial_{j}u_{i}.\n$$\n因此，\n$$\n\\rho\\,\\frac{D}{D t}\\left(\\frac{1}{2}u_{i}u_{i}\\right) = \\partial_{j}\\left(u_{i}\\,\\sigma_{ij}\\right) - \\sigma_{ij}\\,\\partial_{j}u_{i} + \\rho\\,u_{i}\\,b_{i}.\n$$\n将 $\\sigma_{ij} = -p\\,\\delta_{ij} + 2\\,\\mu\\,S_{ij}$ 代入 $\\sigma_{ij}\\,\\partial_{j}u_{i}$ 得\n$$\n\\sigma_{ij}\\,\\partial_{j}u_{i} = \\left(-p\\,\\delta_{ij} + 2\\,\\mu\\,S_{ij}\\right)\\partial_{j}u_{i} = -p\\,\\partial_{i}u_{i} + 2\\,\\mu\\,S_{ij}\\,\\partial_{j}u_{i}.\n$$\n在不可压缩条件下，$\\partial_{i}u_{i} = 0$，因此动能方程中的压力功项在局部消失。接下来，将速度梯度分解为其对称和反对称部分：\n$$\n\\partial_{j}u_{i} = S_{ij} + \\Omega_{ij}, \\quad \\text{其中} \\quad \\Omega_{ij} = \\frac{1}{2}\\left(\\partial_{j}u_{i} - \\partial_{i}u_{j}\\right),\n$$\n并注意 $S_{ij}\\,\\Omega_{ij} = 0$，因为 $S_{ij}$ 是对称的，而 $\\Omega_{ij}$ 是反对称的。于是，\n$$\n2\\,\\mu\\,S_{ij}\\,\\partial_{j}u_{i} = 2\\,\\mu\\,S_{ij}\\,(S_{ij} + \\Omega_{ij}) = 2\\,\\mu\\,S_{ij}\\,S_{ij}.\n$$\n于是局部动能收支方程变为\n$$\n\\rho\\,\\frac{D}{D t}\\left(\\frac{1}{2}u_{i}u_{i}\\right) = \\partial_{j}\\left(u_{i}\\,\\sigma_{ij}\\right) - 2\\,\\mu\\,S_{ij}\\,S_{ij} + \\rho\\,u_{i}\\,b_{i}.\n$$\n因此，单位体积的粘性耗散率（记为 $\\varepsilon$）被确定为\n$$\n\\varepsilon = 2\\,\\mu\\,S_{ij}\\,S_{ij},\n$$\n由于 $S_{ij}\\,S_{ij} \\ge 0$，该项显然是非负的。\n\n现在我们为给定的简单剪切流 $\\boldsymbol{u} = \\left(S\\,y,\\,0,\\,0\\right)$ 计算 $\\varepsilon$。速度梯度的非零分量为\n$$\n\\partial_{y}u_{x} = S,\n$$\n而所有其他 $\\partial_{j}u_{i}$ 均为零。计算应变率张量的分量：\n$$\nS_{xy} = S_{yx} = \\frac{1}{2}\\left(\\partial_{x}u_{y} + \\partial_{y}u_{x}\\right) = \\frac{1}{2}\\left(0 + S\\right) = \\frac{S}{2},\n$$\n并且所有对角分量 $S_{xx}, S_{yy}, S_{zz}$ 均为零，因为该流中不存在法向应变，而所有其他非对角分量也为零。缩并 $S_{ij}\\,S_{ij}$ 是所有分量平方的和：\n$$\nS_{ij}\\,S_{ij} = S_{xy}^{2} + S_{yx}^{2} = 2\\left(\\frac{S}{2}\\right)^{2} = \\frac{S^{2}}{2}.\n$$\n因此，\n$$\n\\varepsilon = 2\\,\\mu\\,S_{ij}\\,S_{ij} = 2\\,\\mu\\,\\left(\\frac{S^{2}}{2}\\right) = \\mu\\,S^{2}.\n$$\n\n在机械能收支中的解释：项 $\\varepsilon = \\mu\\,S^{2}$ 是该流中单位体积动能的一个恒正、空间均匀的汇项。在动能方程中，它以负号出现，会减少动能，除非通过边界通量或体积力形式的外部功或能量输入来平衡。为了维持一个抵抗粘性的稳态、空间均匀的简单剪切流，必须以等于 $\\mu\\,S^{2}$ 的单位体积功率提供机械功（例如，通过移动边界或外部强迫），以抵消粘性耗散并维持剪切。", "answer": "$$\\boxed{\\mu\\,S^{2}}$$", "id": "3597106"}, {"introduction": "除了流体自身的属性，边界条件在塑造流动结构和决定总输运量方面起着决定性作用。在地球物理学中，无滑移条件（如海床）和自由滑移条件（如海气界面）代表了两种关键的物理情景。通过解决一个经典的槽道流问题，本练习将量化这两种边界条件对速度剖面和体积流量的显著影响。[@problem_id:3597104]", "problem": "考虑一个在高度为 $H$ 的平面通道中的稳定、完全发展的层流，流体为牛顿不可压缩流体，其动力粘度为 $\\mu$，密度为 $\\rho$。设 $x$ 表示流向坐标，$y \\in [0,H]$ 表示横流向坐标。流动由一个恒定的流向压力梯度 $\\mathrm{d}p/\\mathrm{d}x$ 驱动，该梯度为负（压力沿 $+x$ 方向减小）。假设雷诺数（Reynolds number (Re)）足够小，使得惯性项可以忽略不计（斯托克斯流态）。通道在展向上是无限宽的，因此该问题实际上是二维（$2$-D）的。设 $u(y)$ 表示流向速度。\n\n从不可压缩、稳态的纳维-斯托克斯方程（Navier-Stokes (NS)）和上述假设出发，为 $u(y)$ 建立控制边界值问题，并在以下两种情况下求解：\n\n- 情况 A（基准）：两个壁面均为无滑移，即 $u(0) = 0$ 且 $u(H) = 0$。\n- 情况 B（修改）：下壁面 $y=0$ 处为无滑移，上壁面 $y = H$ 处为自由滑移。对于牛顿流体，在 $y=H$ 处的自由滑移意味着不可穿透性和零切向剪应力；在此几何结构中，这简化为 $\\partial u/\\partial y \\big|_{y=H} = 0$。\n\n对于每种情况，推导出 $u(y)$ 并计算单位展向宽度的体积流量，\n$$\nQ \\;=\\; \\int_{0}^{H} u(y)\\,\\mathrm{d}y.\n$$\n然后，确定乘法因子\n$$\nR \\;=\\; \\frac{Q_{\\text{Case B}}}{Q_{\\text{Case A}}}\n$$\n该因子量化了在施加的压力梯度 $\\mathrm{d}p/\\mathrm{d}x$ 保持不变时，将上壁面的无滑移条件替换为自由滑移条件对体积流量的影响。\n\n此外，明确求出速度剖面的变化量 $\\Delta u(y) = u_{\\text{Case B}}(y) - u_{\\text{Case A}}(y)$ 作为 $y$ 的函数。\n\n您最终提交的答案必须是无量纲因子 $R$ 的精确值，以纯数形式表示（无单位）。请勿四舍五入。", "solution": "出发点是密度为常数 $\\rho$、动力粘度为 $\\mu$ 的牛顿流体的不可压缩稳态纳维-斯托克斯方程。在没有体力的情况下，动量方程为：\n$$\n\\rho (\\mathbf{v} \\cdot \\nabla) \\mathbf{v} = -\\nabla p + \\mu \\nabla^2 \\mathbf{v}\n$$\n速度矢量为 $\\mathbf{v} = (u, v, w)$。问题陈述该流动是稳态、完全发展和二维的，这意味着：\n1.  **稳态流**：$\\frac{\\partial}{\\partial t} (\\cdot) = 0$。\n2.  **二维**：流动在展向（$z$）方向上是均匀的，因此 $w=0$ 且 $\\frac{\\partial}{\\partial z}(\\cdot) = 0$。\n3.  **完全发展**：速度剖面在流向（$x$）方向上不发生变化。这意味着 $\\frac{\\partial u}{\\partial x} = 0$。\n\n连续性方程 $\\nabla \\cdot \\mathbf{v} = 0$ 简化为 $\\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} + \\frac{\\partial w}{\\partial z} = 0$。根据这些假设，该方程简化为 $\\frac{\\partial v}{\\partial y} = 0$。由于横流向速度 $v$ 在壁面处必须为零（$v(0)=0$），因此可推断出对所有 $y$ 都有 $v=0$。\n\n因此，速度场为 $\\mathbf{v} = (u(y), 0, 0)$。现在我们来简化动量方程的各个分量。\n\n$y$ 方向动量方程变为 $0 = -\\frac{\\partial p}{\\partial y}$，这意味着压力 $p$ 不是 $y$ 的函数。由于 $p$ 也不是 $z$ 的函数（二维流），$p$ 只能是 $x$ 的函数，即 $p=p(x)$。\n\n$x$ 方向动量方程简化如下：\n惯性项 $(\\mathbf{v} \\cdot \\nabla) \\mathbf{v}$ 变为 $u\\frac{\\partial u}{\\partial x} + v\\frac{\\partial u}{\\partial y} = u(0) + 0 = 0$。这与斯托克斯流态的假设（惯性项可忽略）是一致的。\n粘性项 $\\mu \\nabla^2 \\mathbf{v}$ 变为 $\\mu (\\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2} + \\frac{\\partial^2 u}{\\partial z^2}) = \\mu \\frac{\\mathrm{d}^2 u}{\\mathrm{d} y^2}$，因为 $u$ 仅取决于 $y$。\n\n因此，$x$ 方向动量方程简化为：\n$$\n0 = -\\frac{\\mathrm{d}p}{\\mathrm{d}x} + \\mu \\frac{\\mathrm{d}^2 u}{\\mathrm{d} y^2}\n$$\n问题陈述压力梯度 $\\frac{\\mathrm{d}p}{\\mathrm{d}x}$ 是一个常数。整理后，我们得到速度剖面 $u(y)$ 的控制常微分方程 (ODE)：\n$$\n\\frac{\\mathrm{d}^2 u}{\\mathrm{d} y^2} = \\frac{1}{\\mu} \\frac{\\mathrm{d}p}{\\mathrm{d}x}\n$$\n将此 ODE 对 $y$ 积分两次，得到速度剖面的通解：\n$$\n\\frac{\\mathrm{d}u}{\\mathrm{d}y} = \\frac{1}{\\mu} \\left(\\frac{\\mathrm{d}p}{\\mathrm{d}x}\\right) y + C_1\n$$\n$$\nu(y) = \\frac{1}{2\\mu} \\left(\\frac{\\mathrm{d}p}{\\mathrm{d}x}\\right) y^2 + C_1 y + C_2\n$$\n其中 $C_1$ 和 $C_2$ 是由边界条件决定的积分常数。\n\n**情况 A：两壁面无滑移**\n边界条件为 $u(0) = 0$ 和 $u(H) = 0$。\n应用 $u(0) = 0$：\n$$\nu(0) = \\frac{1}{2\\mu} \\left(\\frac{\\mathrm{d}p}{\\mathrm{d}x}\\right) (0)^2 + C_1(0) + C_2 = 0 \\quad \\implies \\quad C_2 = 0\n$$\n应用 $u(H) = 0$：\n$$\nu(H) = \\frac{1}{2\\mu} \\left(\\frac{\\mathrm{d}p}{\\mathrm{d}x}\\right) H^2 + C_1 H = 0 \\quad \\implies \\quad C_1 = -\\frac{H}{2\\mu} \\frac{\\mathrm{d}p}{\\mathrm{d}x}\n$$\n将 $C_1$ 和 $C_2$ 代入通解，得到情况 A 的速度剖面：\n$$\nu_{\\text{Case A}}(y) = \\frac{1}{2\\mu} \\frac{\\mathrm{d}p}{\\mathrm{d}x} y^2 - \\frac{H}{2\\mu} \\frac{\\mathrm{d}p}{\\mathrm{d}x} y = \\frac{1}{2\\mu} \\frac{\\mathrm{d}p}{\\mathrm{d}x} (y^2 - Hy)\n$$\n单位展向宽度的体积流量 $Q_{\\text{Case A}}$ 为：\n$$\nQ_{\\text{Case A}} = \\int_{0}^{H} u_{\\text{Case A}}(y) \\, \\mathrm{d}y = \\frac{1}{2\\mu} \\frac{\\mathrm{d}p}{\\mathrm{d}x} \\int_{0}^{H} (y^2 - Hy) \\, \\mathrm{d}y \n$$\n$$\nQ_{\\text{Case A}} = \\frac{1}{2\\mu} \\frac{\\mathrm{d}p}{\\mathrm{d}x} \\left[ \\frac{y^3}{3} - \\frac{Hy^2}{2} \\right]_{0}^{H} = \\frac{1}{2\\mu} \\frac{\\mathrm{d}p}{\\mathrm{d}x} \\left( \\frac{H^3}{3} - \\frac{H^3}{2} \\right) = \\frac{1}{2\\mu} \\frac{\\mathrm{d}p}{\\mathrm{d}x} \\left( -\\frac{H^3}{6} \\right)\n$$\n$$\nQ_{\\text{Case A}} = -\\frac{H^3}{12\\mu} \\frac{\\mathrm{d}p}{\\mathrm{d}x}\n$$\n\n**情况 B：下壁面无滑移，上壁面自由滑移**\n边界条件为 $u(0) = 0$ 和 $\\frac{\\mathrm{d}u}{\\mathrm{d}y}\\big|_{y=H} = 0$。\n应用 $u(0) = 0$ 得到 $C_2 = 0$，和之前一样。\n将自由滑移条件 $\\frac{\\mathrm{d}u}{\\mathrm{d}y}\\big|_{y=H} = 0$ 应用于 ODE 的一次积分：\n$$\n\\frac{\\mathrm{d}u}{\\mathrm{d}y}\\bigg|_{y=H} = \\frac{1}{\\mu} \\left(\\frac{\\mathrm{d}p}{\\mathrm{d}x}\\right) H + C_1 = 0 \\quad \\implies \\quad C_1 = -\\frac{H}{\\mu} \\frac{\\mathrm{d}p}{\\mathrm{d}x}\n$$\n将 $C_1$ 和 $C_2$ 代入，得到情况 B 的速度剖面：\n$$\nu_{\\text{Case B}}(y) = \\frac{1}{2\\mu} \\frac{\\mathrm{d}p}{\\mathrm{d}x} y^2 - \\frac{H}{\\mu} \\frac{\\mathrm{d}p}{\\mathrm{d}x} y = \\frac{1}{2\\mu} \\frac{\\mathrm{d}p}{\\mathrm{d}x} (y^2 - 2Hy)\n$$\n体积流量 $Q_{\\text{Case B}}$ 为：\n$$\nQ_{\\text{Case B}} = \\int_{0}^{H} u_{\\text{Case B}}(y) \\, \\mathrm{d}y = \\frac{1}{2\\mu} \\frac{\\mathrm{d}p}{\\mathrm{d}x} \\int_{0}^{H} (y^2 - 2Hy) \\, \\mathrm{d}y\n$$\n$$\nQ_{\\text{Case B}} = \\frac{1}{2\\mu} \\frac{\\mathrm{d}p}{\\mathrm{d}x} \\left[ \\frac{y^3}{3} - Hy^2 \\right]_{0}^{H} = \\frac{1}{2\\mu} \\frac{\\mathrm{d}p}{\\mathrm{d}x} \\left( \\frac{H^3}{3} - H^3 \\right) = \\frac{1}{2\\mu} \\frac{\\mathrm{d}p}{\\mathrm{d}x} \\left( -\\frac{2H^3}{3} \\right)\n$$\n$$\nQ_{\\text{Case B}} = -\\frac{H^3}{3\\mu} \\frac{\\mathrm{d}p}{\\mathrm{d}x}\n$$\n\n**体积流量之比**\n比率 $R$ 定义为 $R = Q_{\\text{Case B}} / Q_{\\text{Case A}}$。\n$$\nR = \\frac{-\\frac{H^3}{3\\mu} \\frac{\\mathrm{d}p}{\\mathrm{d}x}}{-\\frac{H^3}{12\\mu} \\frac{\\mathrm{d}p}{\\mathrm{d}x}} = \\frac{1/3}{1/12} = \\frac{1}{3} \\times 12 = 4\n$$\n\n**速度剖面变化**\n速度剖面的变化量为 $\\Delta u(y) = u_{\\text{Case B}}(y) - u_{\\text{Case A}}(y)$。\n$$\n\\Delta u(y) = \\left( \\frac{1}{2\\mu} \\frac{\\mathrm{d}p}{\\mathrm{d}x} (y^2 - 2Hy) \\right) - \\left( \\frac{1}{2\\mu} \\frac{\\mathrm{d}p}{\\mathrm{d}x} (y^2 - Hy) \\right)\n$$\n$$\n\\Delta u(y) = \\frac{1}{2\\mu} \\frac{\\mathrm{d}p}{\\mathrm{d}x} \\left( (y^2 - 2Hy) - (y^2 - Hy) \\right) = \\frac{1}{2\\mu} \\frac{\\mathrm{d}p}{\\mathrm{d}x} (-Hy)\n$$\n$$\n\\Delta u(y) = -\\frac{H}{2\\mu} \\frac{\\mathrm{d}p}{\\mathrm{d}x} y\n$$\n由于压力梯度 $\\frac{\\mathrm{d}p}{\\mathrm{d}x}$ 为负，对于 $y>0$，速度变化量 $\\Delta u(y)$ 为正，这表明情况 B 中的流动更快，正如预期。\n\n题目要求无量纲因子 $R$ 的精确值。\n$$\nR=4\n$$", "answer": "$$\n\\boxed{4}\n$$", "id": "3597104"}, {"introduction": "大多数地球物理流动模型都依赖于近似来简化控制方程，从而在计算上变得可行，布辛涅斯克近似就是其中最核心的一个。该近似在处理密度变化较小的流动（如大多数海洋和大气流动）时极为有效，但了解其适用范围和误差来源至关重要。本编程练习旨在通过推导和计算，量化布辛涅斯克近似在动量和浮力收支中引入的误差，从而深入理解其作为建模工具的优势与局限性。[@problem_id:3597130]", "problem": "考虑一个厚度均匀为 $H$ 的单层浊流，水平流入参考密度为 $\\rho_0$ 的环境流体中。该浊流具有均匀的速度 $U$ 和均匀的密度 $\\rho$，其密度差为 $\\Delta \\rho = \\rho - \\rho_0$。假设流动是不可压缩的，并且混合得足够均匀，以至于深度平均的描述是合适的。从变密度不可压缩质量和动量平衡方程开始，\n$$\\nabla \\cdot \\mathbf{u} = 0,$$\n$$\\frac{\\partial}{\\partial t}(\\rho \\mathbf{u}) + \\nabla \\cdot (\\rho \\mathbf{u}\\mathbf{u}) = -\\nabla p + \\rho \\mathbf{g} + \\nabla \\cdot \\boldsymbol{\\tau},$$\n以及Boussinesq近似，在该近似中，除了浮力项外，各处的 $\\rho$ 都被替换为 $\\rho_0$，其中浮力被建模为 $b = \\dfrac{g \\Delta \\rho}{\\rho_0}$。该浊流由基于Boussinesq折减重力的弗劳德数 (Fr) 表征，其定义为\n$$Fr = \\frac{U}{\\sqrt{g' H}}, \\quad g' = \\frac{g \\Delta \\rho}{\\rho_0}.$$\n在一个厚度为 $H$、速度为 $U$ 的均匀层的控制体描述中，定义以下每单位宽度的深度积分通量收支：\n- 精确动量通量 $\\mathcal{F}_M^{\\text{exact}} = \\int_0^H \\rho u^2 \\, dz$ 和Boussinesq近似下的动量通量 $\\mathcal{F}_M^{\\text{B}} = \\int_0^H \\rho_0 u^2 \\, dz$。\n- 进入收支的精确浮力加速度 $b^{\\text{exact}} = \\dfrac{g \\Delta \\rho}{\\rho}$ 和Boussinesq浮力 $b^{\\text{B}} = \\dfrac{g \\Delta \\rho}{\\rho_0}$。\n\n你的任务是，从上述基本平衡方程出发，为以下三个无量纲误差度量推导表达式，然后在程序中实现它们：\n1. 由于在惯性项中使用 $\\rho_0$ 而引起的动量收支中的相对误差，定义为\n$$\\varepsilon_M = \\frac{\\mathcal{F}_M^{\\text{B}} - \\mathcal{F}_M^{\\text{exact}}}{\\mathcal{F}_M^{\\text{exact}}}.$$\n2. 由于在 $b$ 的分母中使用 $\\rho_0$ 而引起的浮力收支中的相对误差，定义为\n$$\\varepsilon_B = \\frac{b^{\\text{B}} - b^{\\text{exact}}}{b^{\\text{exact}}}.$$\n3. 一个无量纲闭合残差，用于量化在由 $Fr$ 和 $g'$ 推断出相同 $U$ 的情况下，用精确密度计算的惯性与浮力之比与用Boussinesq折减重力定义的弗劳德数平方之间的不匹配：\n$$\\mathcal{R} = \\frac{\\rho U^2}{g \\Delta \\rho \\, H} - Fr^2.$$\n\n所有量都必须用国际单位制 (SI) 表示：密度单位为 $\\mathrm{kg/m^3}$，重力加速度 $g$ 单位为 $\\mathrm{m/s^2}$，层厚 $H$ 单位为 $\\mathrm{m}$，速度 $U$ 单位为 $\\mathrm{m/s}$。输出误差 $\\varepsilon_M$、$\\varepsilon_B$ 和 $\\mathcal{R}$ 必须以小数形式报告（而非百分比）。\n\n在你的计算中使用以下常数：$\\rho_0 = 1025 \\ \\mathrm{kg/m^3}$，$g = 9.81 \\ \\mathrm{m/s^2}$，以及 $H = 10 \\ \\mathrm{m}$。给定一个包含四种情况的测试套件，每种情况都指定了密度差比 $\\Delta \\rho / \\rho$ 和用 $g' = \\dfrac{g \\Delta \\rho}{\\rho_0}$ 定义的弗劳德数 $Fr$：\n- 情况1：$\\Delta \\rho / \\rho = 0$, $Fr = 0$。\n- 情况2：$\\Delta \\rho / \\rho = 0.02$, $Fr = 1.0$。\n- 情况3：$\\Delta \\rho / \\rho = 0.05$, $Fr = 1.5$。\n- 情况4：$\\Delta \\rho / \\rho = 0.10$, $Fr = 0.8$。\n\n对于每种情况，将 $\\Delta \\rho / \\rho$ 视为基本量；从 $\\rho_0$ 和 $\\Delta \\rho / \\rho$ 推断出 $\\rho$，然后推断出 $\\Delta \\rho$。在需要时，使用给定的 $Fr$ 和 $g'$ 来推断 $U$。你的程序应产生单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试用例贡献一个按 $[\\varepsilon_M,\\varepsilon_B,\\mathcal{R}]$ 顺序排列的子列表。将所有输出表示为四舍五入到六位小数的小数。例如，最终输出应如下所示：\n$$\\big[\\,[\\varepsilon_M^{(1)},\\varepsilon_B^{(1)},\\mathcal{R}^{(1)}],\\ldots,[\\varepsilon_M^{(4)},\\varepsilon_B^{(4)},\\mathcal{R}^{(4)}]\\,\\big].$$", "solution": "目标是为三个无量纲误差度量（$\\varepsilon_M$、$\\varepsilon_B$ 和 $\\mathcal{R}$）推导表达式，这些度量用于量化在浊流模型中因使用Boussinesq近似而产生的差异。推导过程将从所提供的基本定义开始。一旦推导出来，这些表达式将用于为一组给定的测试用例计算这些度量。\n\n假设流动是一个厚度为 $H$、具有恒定速度 $U$ 和密度 $\\rho$ 的均匀层。环境流体的密度为 $\\rho_0$。所有数学符号、变量和数字将按照格式要求用LaTeX渲染。\n\n**1. 动量收支误差 $\\varepsilon_M$ 的推导**\n\n动量收支中的相对误差定义为：\n$$\n\\varepsilon_M = \\frac{\\mathcal{F}_M^{\\text{B}} - \\mathcal{F}_M^{\\text{exact}}}{\\mathcal{F}_M^{\\text{exact}}}\n$$\n项 $\\mathcal{F}_M^{\\text{exact}}$ 和 $\\mathcal{F}_M^{\\text{B}}$ 表示每单位宽度的深度积分动量通量。给定层内（从 $z=0$ 到 $z=H$）的均匀速度剖面 $u(z) = U$ 和均匀密度 $\\rho$，积分计算如下：\n$$\n\\mathcal{F}_M^{\\text{exact}} = \\int_0^H \\rho u^2 \\, dz = \\int_0^H \\rho U^2 \\, dz = \\rho U^2 H\n$$\n$$\n\\mathcal{F}_M^{\\text{B}} = \\int_0^H \\rho_0 u^2 \\, dz = \\int_0^H \\rho_0 U^2 \\, dz = \\rho_0 U^2 H\n$$\n将这些表达式代入 $\\varepsilon_M$ 的定义中：\n$$\n\\varepsilon_M = \\frac{\\rho_0 U^2 H - \\rho U^2 H}{\\rho U^2 H}\n$$\n假设水流在运动（$U \\neq 0$），我们可以消去项 $U^2 H$：\n$$\n\\varepsilon_M = \\frac{\\rho_0 - \\rho}{\\rho} = -\\frac{\\rho - \\rho_0}{\\rho}\n$$\n使用密度差的定义 $\\Delta \\rho = \\rho - \\rho_0$，我们得到最终表达式：\n$$\n\\varepsilon_M = -\\frac{\\Delta \\rho}{\\rho}\n$$\n该表达式与速度 $U$ 无关，因此即使在 $U \\to 0$ 的极限情况下也成立。该误差就是指定输入比率 $\\Delta \\rho / \\rho$ 的负值。\n\n**2. 浮力收支误差 $\\varepsilon_B$ 的推导**\n\n浮力收支中的相对误差定义为：\n$$\n\\varepsilon_B = \\frac{b^{\\text{B}} - b^{\\text{exact}}}{b^{\\text{exact}}}\n$$\n精确浮力加速度和Boussinesq浮力加速度由下式给出：\n$$\nb^{\\text{exact}} = \\frac{g \\Delta \\rho}{\\rho}\n$$\n$$\nb^{\\text{B}} = \\frac{g \\Delta \\rho}{\\rho_0}\n$$\n将这些代入 $\\varepsilon_B$ 的定义中：\n$$\n\\varepsilon_B = \\frac{\\frac{g \\Delta \\rho}{\\rho_0} - \\frac{g \\Delta \\rho}{\\rho}}{\\frac{g \\Delta \\rho}{\\rho}}\n$$\n假设密度差不为零（$\\Delta \\rho \\neq 0$），我们可以消去项 $g \\Delta \\rho$：\n$$\n\\varepsilon_B = \\frac{\\frac{1}{\\rho_0} - \\frac{1}{\\rho}}{\\frac{1}{\\rho}} = \\left(\\frac{1}{\\rho_0} - \\frac{1}{\\rho}\\right) \\rho = \\frac{\\rho}{\\rho_0} - 1 = \\frac{\\rho - \\rho_0}{\\rho_0}\n$$\n因此，我们发现：\n$$\n\\varepsilon_B = \\frac{\\Delta \\rho}{\\rho_0}\n$$\n为了计算方便，用输入比率 $\\Delta \\rho / \\rho$ 来表示 $\\varepsilon_B$ 是很有用的。我们从恒等式 $\\Delta \\rho / \\rho = 1 - \\rho_0 / \\rho$ 开始。整理得到 $\\rho_0 / \\rho = 1 - \\Delta \\rho / \\rho$，这意味着 $\\rho / \\rho_0 = (1 - \\Delta \\rho / \\rho)^{-1}$。将此代入我们关于 $\\varepsilon_B$ 的表达式中：\n$$\n\\varepsilon_B = \\frac{\\rho}{\\rho_0} - 1 = \\frac{1}{1 - \\frac{\\Delta \\rho}{\\rho}} - 1 = \\frac{1 - (1 - \\frac{\\Delta \\rho}{\\rho})}{1 - \\frac{\\Delta \\rho}{\\rho}} = \\frac{\\frac{\\Delta \\rho}{\\rho}}{1 - \\frac{\\Delta \\rho}{\\rho}}\n$$\n这种形式在计算上是稳健的，特别是对于 $\\Delta \\rho / \\rho = 0$ 的情况，它能正确地计算出 $\\varepsilon_B = 0$。\n\n**3. 闭合残差 $\\mathcal{R}$ 的推导**\n\n无量纲闭合残差定义为：\n$$\n\\mathcal{R} = \\frac{\\rho U^2}{g \\Delta \\rho \\, H} - Fr^2\n$$\n弗劳德数 $Fr$ 是使用Boussinesq折减重力 $g' = g \\Delta \\rho / \\rho_0$ 定义的：\n$$\nFr = \\frac{U}{\\sqrt{g' H}} \\implies U = Fr \\sqrt{g' H} = Fr \\sqrt{\\frac{g \\Delta \\rho}{\\rho_0} H}\n$$\n将这个关于 $U$ 的表达式平方，得到：\n$$\nU^2 = Fr^2 \\left(\\frac{g \\Delta \\rho}{\\rho_0} H\\right)\n$$\n现在，将这个关于 $U^2$ 的表达式代入 $\\mathcal{R}$ 的定义中：\n$$\n\\mathcal{R} = \\frac{\\rho}{g \\Delta \\rho H} \\left(Fr^2 \\frac{g \\Delta \\rho H}{\\rho_0}\\right) - Fr^2\n$$\n假设 $g \\neq 0$、$H \\neq 0$ 且 $\\Delta \\rho \\neq 0$，我们可以消去一些项：\n$$\n\\mathcal{R} = \\frac{\\rho}{\\rho_0} Fr^2 - Fr^2 = \\left(\\frac{\\rho}{\\rho_0} - 1\\right) Fr^2\n$$\n我们识别出项 $(\\rho / \\rho_0 - 1)$ 等于 $\\varepsilon_B$：\n$$\n\\mathcal{R} = \\varepsilon_B Fr^2\n$$\n使用以 $\\Delta \\rho / \\rho$ 表示的 $\\varepsilon_B$ 表达式，我们得到最终的计算公式：\n$$\n\\mathcal{R} = \\left(\\frac{\\frac{\\Delta \\rho}{\\rho}}{1 - \\frac{\\Delta \\rho}{\\rho}}\\right) Fr^2\n$$\n这个最终形式仅取决于每个测试用例给定的参数 $\\Delta \\rho / \\rho$ 和 $Fr$。\n\n**计算公式总结**\n对于每个由 $\\Delta \\rho / \\rho$ 和 $Fr$ 值定义的测试用例，三个所需的量计算如下：\n1. $\\varepsilon_M = -(\\Delta \\rho / \\rho)$\n2. $\\varepsilon_B = \\frac{\\Delta \\rho / \\rho}{1 - \\Delta \\rho / \\rho}$\n3. $\\mathcal{R} = \\varepsilon_B \\cdot Fr^2 = \\left(\\frac{\\Delta \\rho / \\rho}{1 - \\Delta \\rho / \\rho}\\right) Fr^2$\n\n这些公式在提供的Python代码中实现，以生成最终结果。一旦推导出这些简化表达式，计算无量纲误差度量时就不再直接需要常数 $\\rho_0$、$g$ 和 $H$，这展示了无量纲化的威力。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates three dimensionless error metrics related to the Boussinesq\n    approximation for a set of test cases describing a turbidity current.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each case is a tuple (density_contrast_ratio, froude_number).\n    test_cases = [\n        (0.0, 0.0),  # Case 1: Δρ/ρ = 0, Fr = 0\n        (0.02, 1.0), # Case 2: Δρ/ρ = 0.02, Fr = 1.0\n        (0.05, 1.5), # Case 3: Δρ/ρ = 0.05, Fr = 1.5\n        (0.10, 0.8), # Case 4: Δρ/ρ = 0.10, Fr = 0.8\n    ]\n\n    results = []\n    for case in test_cases:\n        delta_rho_over_rho, fr = case\n\n        # 1. Calculate the relative error in the momentum budget, ε_M.\n        # ε_M = -Δρ/ρ\n        epsilon_M = -delta_rho_over_rho\n\n        # 2. Calculate the relative error in the buoyancy budget, ε_B.\n        # This handles the case where delta_rho_over_rho is 0, avoiding division by zero.\n        # ε_B = (Δρ/ρ) / (1 - Δρ/ρ)\n        if delta_rho_over_rho == 1.0:\n            # This would correspond to rho_0 = 0, a physical impossibility\n            # and mathematical singularity in the formula.\n            epsilon_B = float('inf')\n        else:\n            epsilon_B = delta_rho_over_rho / (1.0 - delta_rho_over_rho)\n\n        # 3. Calculate the dimensionless closure residual, R.\n        # R = ε_B * Fr^2\n        residual_R = epsilon_B * (fr ** 2)\n        \n        # Round results to six decimal places as required.\n        # Note: round() provides standard rounding behavior.\n        # For Case 1, -0.0 rounds to -0.0. We will store it as 0.0 for cleaner representation.\n        if epsilon_M == -0.0:\n            epsilon_M = 0.0\n            \n        res_list = [\n            round(epsilon_M, 6),\n            round(epsilon_B, 6),\n            round(residual_R, 6)\n        ]\n        results.append(res_list)\n\n    # Final print statement in the exact required format.\n    # The format is a string representation of a list of lists.\n    # Example: [[-0.0, 0.0, 0.0],[-0.02, 0.020408, 0.020408]]\n    # map(str, results) converts each sublist to its string representation.\n    # ','.join() concatenates these strings with a comma.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3597130"}]}