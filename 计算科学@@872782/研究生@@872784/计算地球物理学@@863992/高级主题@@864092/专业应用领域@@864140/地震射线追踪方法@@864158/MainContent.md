## 引言
[地震射线追踪](@entry_id:754644)是[计算地球物理学](@entry_id:747618)中的一个基石性工具，它为我们理解和成像复杂的地下结构提供了一种高效且直观的物理框架。面对直接求解[波动方程](@entry_id:139839)的巨大计算挑战，尤其是在高频情况下，[射线理论](@entry_id:754096)通过一种巧妙的近似，将[波的传播](@entry_id:144063)问题转化为几何路径的追踪问题，极大地提升了[计算效率](@entry_id:270255)。本文旨在系统性地梳理[地震射线追踪](@entry_id:754644)方法的理论基础、数值实现及其在[地球科学](@entry_id:749876)内外的广泛应用，填补从基础理论到高级应用实践之间的知识鸿沟。

读者将通过本文的学习，构建一个完整而深入的知识体系。在“原理和机制”一章中，我们将从波动方程出发，推导出程函方程，并探讨其背后的数学性质与数值解法，如快速推进法与打靶法。随后的“应用与跨学科联系”一章，将展示这些理论如何应用于[地震成像](@entry_id:273056)、层析建模等核心地球物理问题，并揭示其与光学、[机器人学](@entry_id:150623)等领域的深刻联系。最后，“动手实践”部分将引导读者通过编程练习，将理论知识转化为解决实际问题的能力。这三章内容层层递进，旨在引领读者从理论的深度走向应用的广度。

## 原理和机制

本章旨在深入探讨[地震射线追踪](@entry_id:754644)方法背后的基本物理原理和数学机制。我们将从[波动方程](@entry_id:139839)的[高频近似](@entry_id:750288)出发，推导出程函方程，并以此为基础，阐述其数学解的性质。随后，我们将介绍求解程函方程的现代数值方法，包括欧拉和拉格朗日两类方法。最后，本章将讨论一些高级主题，例如[各向异性介质](@entry_id:187796)中的射线传播、界面上的[反射与透射](@entry_id:156002)、以及焦散和多路径问题，从而为读者构建一个关于[射线理论](@entry_id:754096)的系统性知识框架。

### [高频近似](@entry_id:750288)：从[波动方程](@entry_id:139839)到[射线理论](@entry_id:754096)

[地震波](@entry_id:164985)在介质中的传播本质上由[波动方程](@entry_id:139839)描述。对于一个非均匀、无损耗的声学介质，标量[声波方程](@entry_id:746230)可以写为：

$$
\nabla \cdot \left(\frac{1}{\rho(\mathbf{x})}\nabla p(\mathbf{x},t)\right) - \frac{1}{K(\mathbf{x})}\frac{\partial^2 p(\mathbf{x},t)}{\partial t^2} = 0
$$

其中，$p(\mathbf{x},t)$ 是声压场，$\rho(\mathbf{x})$ 是介质密度，$K(\mathbf{x})$ 是[体积模量](@entry_id:160069)。介质中的声速由 $c(\mathbf{x}) = \sqrt{K(\mathbf{x})/\rho(\mathbf{x})}$ 给出。直接求解这个[偏微分方程](@entry_id:141332)在计算上是昂贵的，尤其是在高频情况下。[射线理论](@entry_id:754096)提供了一种高效的近似方法，其核心思想是假设波场可以分解为一个缓慢变化的振幅和一个快速[振荡](@entry_id:267781)的相位。

这个假设被称为 **WKBJ近似**（以Wentzel、Kramers、Brillouin和Jeffreys的名字命名）。我们假设一个时间谐和解，其形式为：

$$
p(\mathbf{x},t) = \Re\{A(\mathbf{x}) \exp[i\omega(\tau(\mathbf{x}) - t)]\}
$$

这里，$\omega$ 是[角频率](@entry_id:261565)，我们假设其非常大（即**[高频近似](@entry_id:750288)**，$\omega \to \infty$）。$A(\mathbf{x})$ 是随空间缓慢变化的**振幅**，而 $\tau(\mathbf{x})$ 是**走时场**（或相[位函数](@entry_id:176105)），它随空间快速变化。

将此解代入[声波方程](@entry_id:746230)，并按 $\omega$ 的幂次进行整理，我们可以得到一个方程层级。在 $\omega \to \infty$ 的极限下，为了使方程成立，$\omega$ 的最高次幂的系数必须为零。

在 $O(\omega^2)$ 阶，我们得到一个只与相位 $\tau(\mathbf{x})$ 相关的方程：

$$
|\nabla \tau(\mathbf{x})|^2 = \frac{1}{c(\mathbf{x})^2}
$$

这个[非线性](@entry_id:637147)的[一阶偏微分方程](@entry_id:178306)被称为**程函方程**（Eikonal Equation）。它描述了波前（即 $\tau(\mathbf{x})$ 的[等值面](@entry_id:196027)）的[运动学](@entry_id:173318)。程函方程的特征线就是[几何光学](@entry_id:175509)中的**射线**。

在下一阶，即 $O(\omega)$ 阶，我们得到一个描述振幅 $A(\mathbf{x})$ 沿射线变化的方程，称为**[输运方程](@entry_id:756133)**（Transport Equation）。它可以写成一种[守恒形式](@entry_id:747710)：

$$
\nabla \cdot \left(\frac{1}{\rho(\mathbf{x})} A(\mathbf{x})^2 \nabla \tau(\mathbf{x})\right) = 0
$$

这个方程表达了沿射线管的能量通量守恒。

WKBJ近似的有效性依赖于一个关键的**[尺度分离](@entry_id:270204)假设**：波长 $\lambda \sim c/\omega$ 必须远小于介质性质（如密度 $\rho$ 和速度 $c$）变化的特征长度 $L$。这个条件，即 $\epsilon = \lambda/L \ll 1$，保证了在一个波长的尺度内介质可以被视为近似均匀的。这使得相位能够相干地累积，从而形成明确定义的射线路径。当这个条件不满足时，或者在焦散区和[波前](@entry_id:197956)反转点，简单的[射线理论](@entry_id:754096)会失效 [@problem_id:3614033]。

### 程函方程与[粘性解](@entry_id:177596)

程函方程 $|\nabla T(\mathbf{x})| = s(\mathbf{x})$ 是高频波传播[运动学](@entry_id:173318)的核心，其中 $T(\mathbf{x})$ 是走时场，$s(\mathbf{x})=1/c(\mathbf{x})$ 是介质的慢度场。这是一个一阶[非线性](@entry_id:637147)哈密顿-[雅可比](@entry_id:264467)（Hamilton-Jacobi）[偏微分方程](@entry_id:141332)。

即使在慢度场 $s(\mathbf{x})$ 非常光滑的情况下，程函方程的解 $T(\mathbf{x})$ 仍然可能出现[奇点](@entry_id:137764)。例如，在[点源](@entry_id:196698)处，走时场的梯度是未定义的。此外，当来自不同方向的射线汇交时，会形成**焦散**（caustics），在这些位置走时场不再可微。这些[奇点](@entry_id:137764)的存在意味着经典的 $C^1$ 解在全局范围内通常是不存在的。

为了克服这一困难，数学家引入了**[粘性解](@entry_id:177596)**（viscosity solution）的概念。[粘性解](@entry_id:177596)是一种弱解，它不要求函数处处可微，但在数学上保证了在适当的边界条件下解的存在性和唯一性。对于程函方程，一个关键的结论是，其唯一的[粘性解](@entry_id:177596)等价于通过**[费马原理](@entry_id:175608)**（Fermat's Principle）定义的走时。[费马原理](@entry_id:175608)指出，波在两点间的传播路径是使得走时取极小值的路径。对于初至波，这意味着走时是所有可能路径积分的下确界：

$$
T(\mathbf{x}) = \inf_{\gamma} \int_{\gamma} s(\mathbf{x}') d\ell'
$$

由于[粘性解](@entry_id:177596)的定义本质上是一种最小值选择，它自然地对应于物理上的**初至波**（first arrival）。在存在多条射线[路径连接](@entry_id:149343)源点和接收点（即**多路径传播**）的区域，[粘性解](@entry_id:177596)将只给出走时最短的那一条路径的到达时间，而忽略所有其他的晚期到达波 [@problem_id:3614082]。

对于一个位于域 $\Omega$ 内部的点源 $\mathbf{x}_0$，一个适定的（well-posed）程函问题通常这样构建：
1.  **源点条件**: $T(\mathbf{x}_0) = 0$，并要求 $T$ 在 $\Omega$ 上连续。
2.  **方程**: 在 $\Omega \setminus \{\mathbf{x}_0\}$ 上，方程 $|\nabla T(\mathbf{x})| = s(\mathbf{x})$ 在[粘性解](@entry_id:177596)的意义下成立。
3.  **边界条件**: 在区域边界 $\partial\Omega$ 上，通常施加一个**状态约束边界条件**（state-constraint boundary condition），这意味着射线在到达边界时停止，而没有从边界[外流](@entry_id:274280)入的波。

这种提法，加上[哈密顿-雅可比方程](@entry_id:145701)的**[比较原理](@entry_id:165563)**，保证了初至走时场粘性[解的唯一性](@entry_id:143619)。处理[点源](@entry_id:196698)[奇点](@entry_id:137764)的另一种等价方法是，在一个以 $\mathbf{x}_0$ 为中心的小球上设置狄利克雷（Dirichlet）边界条件，然后取球半径趋于零的极限，其结果同样收敛到唯一的[粘性解](@entry_id:177596) [@problem_id:3614017]。

### [欧拉数](@entry_id:200791)值方法：快速推进与快速扫描

直接在网格上求解程函方程的数值方法被称为欧拉方法。这类方法的核心思想是利用迎风（upwind）差分格式来离散化[梯度算子](@entry_id:275922) $\nabla T$，从而保证信息的传播方向符合物理因果性。一个典型的离散格式将程函方程转化为一个贝尔曼（Bellman）式的最优性原理，即一个节点的走时取决于其上游邻居节点的走时。

这自然地将问题与[图论](@entry_id:140799)中的[最短路径问题](@entry_id:273176)联系起来。我们可以将计算网格视为一个图，其中每个节点 $i$ 对应一个网格点 $\mathbf{x}_i$，连接相邻节点的边的权重 $w_{ij}$ 代表波从 $\mathbf{x}_i$ 传播到 $\mathbf{x}_j$ 的局部走时。例如，边的权重可以近似为 $w_{ij} = \|\mathbf{x}_i - \mathbf{x}_j\|_2 \cdot s((\mathbf{x}_i+\mathbf{x}_j)/2)$。然后，可以使用类似**[戴克斯特拉算法](@entry_id:273943)**（Dijkstra's algorithm）的方法来计算从源点到所有其他节点的最短走时。

然而，在常规的笛卡尔网格上使用固定的近邻模板（如4邻域或8邻域）会引入**网格各向异性**（grid anisotropy），导致计算出的走时依赖于传播方向，即使在物理介质是各向同性的情况下也是如此。这种角度偏差在[网格加密](@entry_id:168565)时不会消失。为了获得真正收敛到各向同性程函方程解的结果，离散格式必须在[网格细化](@entry_id:168565)时考虑更多的传播方向，例如通过扩大模板或者使用更复杂的方案 [@problem_id:3614078]。

**快速推进法 (Fast Marching Method, FMM)** 是一种高效的程函方程求解器，可以被看作是[戴克斯特拉算法](@entry_id:273943)在连续介质中的推广。FMM将网格点分为三类：已接受（Accepted）、待计算（Considered）和远端（Far Away）。它使用一个最小堆（min-heap）来管理待计算的点，每次从未冻结的点中选取走时最小的点作为下一个接受点，并更新其邻居的走时。FMM的正确性和单遍扫描的高效率依赖于一个严格的**因果性**（causality）假设：一旦一个点的走时被接受，它就是最[终值](@entry_id:141018)，不会再被后来的更新改变。这个假设在各向同性介质中成立，因为信息总是从走时小的区域“[迎风](@entry_id:756372)”传播到走时大的区域。

**[快速扫描法](@entry_id:749242) (Fast Sweeping Method, FSM)** 是另一种广泛使用的求解器。与FMM的标签设置（label-setting）策略不同，FSM是一种迭代的、类似高斯-赛德尔（Gauss-Seidel）的方法。它沿着不同的方向（例如，在二维情况下，沿着坐标轴的四个方向：右下、左下、右上、左上）反复扫描整个[计算网格](@entry_id:168560)。在每次扫描中，它利用当前扫描方向上游的邻居节点的最新走时值来更新每个节点的走时。这个过程不断重复，直到所有节点的走时值收敛到一个[不动点](@entry_id:156394)。

FMM和FSM在处理更复杂问题时表现出不同的特性。对于**各向异性**介质，波的[能量传播](@entry_id:202589)方向（[群速度](@entry_id:147686)方向）可能与波前[法线](@entry_id:167651)方向（相速度方向）不一致。这可能导致信息的“上游”方向偏离常规的网格邻域，从而破坏FMM的单遍因果性假设。在这种情况下，标准的FMM可能会得到错误的结果。相比之下，FSM的迭代性质使其更加稳健。即使某个扫描方向与特征线方向不匹配，其他方向的扫描最终也能正确地传播信息。因此，只要使用单调的离散格式，FSM在[各向异性介质](@entry_id:187796)中仍然保证收敛到正确的[粘性解](@entry_id:177596)。然而，其[收敛速度](@entry_id:636873)可能在强各向异性情况下显著下降，需要多次迭代才能完成信息的传播 [@problem_id:3614034]。

### 拉格朗日数值方法：射线追踪

与直接求解PDE的欧拉方法不同，[拉格朗日方法](@entry_id:142825)通过追踪单个射线路径来研究[波的传播](@entry_id:144063)。这种方法基于哈密顿力学框架。我们可以定义一个[哈密顿量](@entry_id:172864) $H(\mathbf{x}, \mathbf{p})$，其中 $\mathbf{x}$ 是位置向量，$\mathbf{p}$ 是慢度向量（[广义动量](@entry_id:165699)）。对于各向同性介质，[哈密顿量](@entry_id:172864)可以写为：

$$
H(\mathbf{x}, \mathbf{p}) = \frac{1}{2} \left( |\mathbf{p}|^2 - s(\mathbf{x})^2 \right)
$$

物理射线路径必须满足约束 $H(\mathbf{x}, \mathbf{p}) = 0$。射线的演化由**[哈密顿正则方程](@entry_id:176897)**描述，这是一组常微分方程（ODEs）：

$$
\frac{d\mathbf{x}}{dt} = \frac{\partial H}{\partial \mathbf{p}}, \quad \frac{d\mathbf{p}}{dt} = -\frac{\partial H}{\partial \mathbf{x}}
$$

其中 $t$ 是沿射线的参数，如走时或[弧长](@entry_id:191173)。给定初始位置 $\mathbf{x}_0$ 和初始慢度 $\mathbf{p}_0$，积分这组ODE就可以追踪一条射线。

#### 两点射线追踪

在[地震学](@entry_id:203510)中，一个核心问题是找到连接给定源点 $\mathbf{x}_S$ 和接收点 $\mathbf{x}_R$ 的射线，这被称为**两点射线追踪**。这是一个[边值问题](@entry_id:193901)（BVP）。

**打靶法 (Shooting Method)** 将BVP转化为一个[初值问题](@entry_id:144620)（IVP）。其基本步骤是：
1.  在源点 $\mathbf{x}_S$ 处，猜测一个初始的射线出射方向（例如，由两个角度 $\alpha, \beta$ 参数化）和一个总走时 $T_f$。初始慢度向量 $\mathbf{p}_0$ 的大小由当地慢度决定，即 $|\mathbf{p}_0| = s(\mathbf{x}_S)$。
2.  将哈密顿方程作为[初值问题](@entry_id:144620)从 $t=0$ 积分到 $t=T_f$，得到射线的终点位置 $\mathbf{x}(T_f)$。
3.  计算终点位置与目标接收点之间的偏差（残差） $\mathbf{r} = \mathbf{x}(T_f) - \mathbf{x}_R$。
4.  这是一个关于初始参数 $\mathbf{q} = [\alpha, \beta, T_f]^\top$ 的[非线性](@entry_id:637147)[寻根问题](@entry_id:174994) $\mathbf{r}(\mathbf{q}) = \mathbf{0}$。可以使用**牛顿法**来迭代求解。牛顿法的核心是[求解线性系统](@entry_id:146035) $\mathbf{S} \Delta\mathbf{q} = -\mathbf{r}$，其中 $\mathbf{S} = \partial \mathbf{r} / \partial \mathbf{q}$ 是**敏感度矩阵**（或雅可比矩阵）。
5.  敏感度矩阵的列是终点位置对初始参数的偏导数。对总走时 $T_f$ 的[偏导数](@entry_id:146280)就是射线在终点处的速度向量。对初始角度 $\alpha, \beta$ 的偏导数则需要通过求解**[变分方程](@entry_id:635018)**（线性化的哈密顿方程）来获得。这需要沿着主射线同时积分一组额外的线性ODE。

打靶法概念简单，但在介质非常复杂（强非均匀）时，其**[收敛域](@entry_id:269722)**可能非常狭窄和破碎。微小的初始角度变化可能导致终点位置的巨大跳跃，使得寻根过程非常困难。此时，可能需要进行密集的“地毯式搜索”来寻找解 [@problem_id:3614042]。

**弯曲法 (Bending Method)** 是解决两点BVP的另一种方法，它直接从[费马原理](@entry_id:175608)的变分性质出发。
1.  首先，构造一条连接源点和接收点的初始猜测路径。
2.  将路径离散为一系列节点。
3.  然后，迭代地调整这些内部节点的位置，以最小化整条路径的总走时。每一步迭代通常通过求解一个[大型稀疏线性系统](@entry_id:137968)来计算节点的更新量，这个[线性系统](@entry_id:147850)来自于走时泛函的[欧拉-拉格朗日方程](@entry_id:137827)。

与打靶法相比，弯曲法通常具有更大的收敛域，因为它在每次迭代中都考虑了整条路径，不易“脱靶”。然而，它可能会收敛到走时泛函的一个局部最小值，这对应于一条物理上有效但可能不是期望的射线路径。

在强[非均匀介质](@entry_id:750241)中，打靶法和弯曲法各有优劣。打靶法的计算成本可能因需要大量尝试初始角度而急剧增加。其失败的主要标志是[牛顿法](@entry_id:140116)不收敛，或者敏感度[矩阵的行列式](@entry_id:148198)趋于零（表明射线正接近焦散）。一个有效的诊断工具是监测[哈密顿量](@entry_id:172864) $H$ 是否在[数值积分](@entry_id:136578)过程中保持为零；系统性的偏离表明ODE求解器存在[数值误差](@entry_id:635587)。而弯曲法失败的迹象通常是走时或欧拉-拉格朗日残差的范数停止下降，这往往发生在路径需要极高曲率才能穿过强速度梯度区域时 [@problem_id:3614047]。

### 高级主题与扩展

#### [各向异性介质](@entry_id:187796)中的射线

在许多地质环境中，如含有定向裂缝的岩石或[晶体结构](@entry_id:140373)，地震[波的传播](@entry_id:144063)速度依赖于方向，这种现象称为**各向异性**（anisotropy）。在这种情况下，[射线理论](@entry_id:754096)变得更加复杂。

对于均匀的线性[弹性[各向异](@entry_id:196053)性介质](@entry_id:187796)，其性质由[四阶弹性张量](@entry_id:188318) $c_{ijkl}$ 和密度 $\rho$ 描述。[平面波解](@entry_id:195230)的存在性条件由**[克里斯托费尔方程](@entry_id:180126)**（Christoffel Equation）给出：

$$
\Gamma_{ik}(\mathbf{n}) A_k = \rho v^2(\mathbf{n}) A_i
$$

其中，$\mathbf{n}$ 是[波前](@entry_id:197956)[法线](@entry_id:167651)方向的[单位向量](@entry_id:165907)，$\boldsymbol{\Gamma}(\mathbf{n})$ 是克里斯托费尔矩阵，其分量为 $\Gamma_{ik} = c_{ijkl}n_j n_l$。这是一个关于 $\rho v^2$ 的特征值问题。对于每个给定的方向 $\mathbf{n}$，求解该方程可以得到三个**相速度** $v(\mathbf{n})$（对应于准P波、快S波和慢[S波](@entry_id:174890)）以及相应的偏振方向 $\mathbf{A}$。

在[各向异性介质](@entry_id:187796)中，波的[能量传播](@entry_id:202589)方向（**群速度**或**射线速度** $\mathbf{v}_g$）通常与[波前](@entry_id:197956)[法线](@entry_id:167651)方向 $\mathbf{n}$（**相速度**方向）不同。[群速度](@entry_id:147686)定义为角频率 $\omega$ 对[波矢](@entry_id:178620) $\mathbf{k}$ 的梯度：

$$
\mathbf{v}_g = \nabla_{\mathbf{k}} \omega(\mathbf{k})
$$

其中，[色散关系](@entry_id:140395)为 $\omega(\mathbf{k}) = |\mathbf{k}| v(\mathbf{k}/|\mathbf{k}|)$。由于相速度 $v$ 依赖于方向 $\mathbf{n} = \mathbf{k}/|\mathbf{k}|$，这个梯度计算并非平凡，其结果 $\mathbf{v}_g$ 的方向通常不与 $\mathbf{k}$ 平行。从几何上看，群速度向量垂直于[慢度面](@entry_id:189732)（由所有满足[克里斯托费尔方程](@entry_id:180126)的慢度向量 $\mathbf{p}=\mathbf{k}/\omega$ 构成的[曲面](@entry_id:267450)），而相速度向量则沿慢度向量方向 [@problem_id:3614024]。

#### 界面上的[反射与透射](@entry_id:156002)

当地震模型包含速度[间断面](@entry_id:180188)（界面）时，射线在到达界面时会发生反射和透射。这些现象可以用哈密顿框架下的动量[跳跃条件](@entry_id:750965)来描述。

核心物理原理是**相位在界面上的连续性**。这意味着，对于入射波、反射波和透射波，它们在界面上同一点的走时必须相等。这导致一个重要的运动学[不变量](@entry_id:148850)：**慢度向量的切向分量在界面两侧是连续的**。

令 $\mathbf{p}$ 为慢度向量，$\mathbf{n}$ 为界[面法向量](@entry_id:749211)。我们可以将 $\mathbf{p}$ 分解为切向分量 $\mathbf{p}_\parallel$ 和法向分量 $p_n$。相位连续性要求：

$$
\mathbf{p}_\parallel^{\text{inc}} = \mathbf{p}_\parallel^{\text{ref}} = \mathbf{p}_\parallel^{\text{trans}}
$$

这就是矢量形式的**斯涅尔定律**（Snell's Law）。

结合[哈密顿约束](@entry_id:161058)（即程函方程 $|\mathbf{p}|^2 = s^2$），我们可以确定法向分量的变化：
*   **反射**: 反射波仍在介质1中，因此 $|\mathbf{p}^{\text{ref}}|^2 = s_1^2$。结合切向分量守恒，可得法向分量必须反号：$p_n^{\text{ref}} = -p_n^{\text{inc}}$。
*   **透射**: 透射波进入介质2，因此 $|\mathbf{p}^{\text{trans}}|^2 = s_2^2$。由此可解出透射波的法向分量：$(p_n^{\text{trans}})^2 = s_2^2 - |\mathbf{p}_\parallel^{\text{inc}}|^2$。
*   **[全内反射](@entry_id:179014)**: 如果 $s_2^2  |\mathbf{p}_\parallel^{\text{inc}}|^2$，则 $(p_n^{\text{trans}})^2$ 为负，不存在实数的透射波法向动量。这意味着波无法透射进入介质2，所有能量都被反射，这种现象称为**[全内反射](@entry_id:179014)** [@problem_id:3614083]。

#### 焦散、多路径与晚至波

正如之前提到的，射线在传播过程中可能汇聚，形成**焦散**。从数学上讲，焦散是射线场的一个[奇点](@entry_id:137764)，它对应于从源点初始条件（如[出射角](@entry_id:264341) $\boldsymbol{\alpha}$）到空间位置 $\mathbf{x}(s, \boldsymbol{\alpha})$ 的映射的雅可比行列式 $J(s, \boldsymbol{\alpha})$ 为零的点。在焦散处，几何光学的振幅 $A \propto |J|^{-1/2}$ 趋于无穷大，表明简单的[射线理论](@entry_id:754096)失效。

与焦散密切相关的概念是**共轭点**。沿一条射线，如果存在一个非平凡的[雅可比场](@entry_id:160518)（描述相邻射线之间距离的矢量）在起点和某一点 $s_c$ 同时为零，则该点被称为起点的[共轭点](@entry_id:160335)。这等价于雅可比行列式 $J(s_c, \boldsymbol{\alpha})=0$。[共轭点](@entry_id:160335)的出现标志着该射线段不再是走时的（局部）严格最小值。

当射线穿过一个简单的[焦散面](@entry_id:158966)时，波场会获得一个 $-\pi/2$ 的相位移动，这对应于**[马斯洛夫指数](@entry_id:197875)**（Maslov Index）增加1 [@problem_id:3614031]。

焦散的存在是造成**多路径传播**的根本原因。在焦散形成的“阴影区”之后，可能会有多条具有不同走时和振幅的射线到达同一点。如前所述，求解程函方程的[粘性解](@entry_id:177596)方法（如FMM和FSM）本质上是寻找走时场的[全局最小值](@entry_id:165977)，因此只能得到初至波。

要计算**晚至波**（later arrivals），必须采用能够区分不同射线分支的方法。一种有效的策略是**欧拉相空间方法**。这种方法不再求解物理空间 $\mathbf{x}$ 上的标量场 $T(\mathbf{x})$，而是在一个扩展的**相空间**（位置-慢度空间 $(\mathbf{x}, \mathbf{p})$ 或 位置-方向空间 $(\mathbf{x}, \theta)$）中求解。通过在相空间中离散化，并将不同的射线族（按方向区分）视为在各自的“通道”中独立传播，可以避免它们合并成单一的初至[波前](@entry_id:197956)。这相当于求解相空间中的[刘维尔方程](@entry_id:156422)（Liouville equation），其特征线就是哈密顿射线。计算完成后，将结果从相空间投影回物理空间，就可以在每个网格点上得到一组离散的到达时间 $\{T_k(\mathbf{x})\}$，排序后即可得到初至、次至等所有波至 [@problem_id:3614082]。