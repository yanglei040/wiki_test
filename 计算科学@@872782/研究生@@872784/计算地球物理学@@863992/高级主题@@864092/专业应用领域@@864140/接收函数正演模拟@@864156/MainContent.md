## 引言
接收函数方法是现代地震学中探[测地球](@entry_id:201133)内部结构，尤其是地壳和上地幔[不连续面](@entry_id:180188)的关键工具。然而，从复杂的[地震波](@entry_id:164985)形中准确提取并解释结构信息，不仅需要熟练操作分析软件，更需要对该方法背后的物理原理和计算过程有深刻的理解。许多研究者和学生在使用该方法时，往往对其核心——正演模拟——的细节及其对最终结果的影响知之甚少，这构成了从“会用”到“精通”的知识鸿沟。本文旨在填补这一鸿沟，系统性地剖析接收函数正演模拟的理论、实现与应用。

在接下来的内容中，我们将分三步深入这一主题。首先，在“原理与机制”一章中，我们将从基本的卷积模型出发，详细拆解接收函数的生成机制，并探讨[数据预处理](@entry_id:197920)、反褶积和波场计算等关键技术环节的挑战与解决方案。接着，在“应用与[交叉](@entry_id:147634)学科联系”一章中，我们将展示正演模拟如何在实际研究中发挥作用，从经典的地壳厚度与波速比测定，到高级的CCP成像和各向异性分析。最后，“动手实践”部分将通过一系列精心设计的问题，引导您亲手实现和验证文中所学的核心概念。通过这一系列的学习，读者将能够建立起一个完整的知识框架，从而更自信、更准确地利用接收函数方法探索地球的奥秘。

## 原理与机制

在上一章介绍性概述的基础上，本章将深入探讨接收函数正演模拟的核心科学原理和计算机制。我们将从描述远震记录的卷积模型出发，逐步拆解接收函数的概念，并系统阐述从原始数据到最终结构响应估计过程中的关键步骤。这些步骤包括[数据预处理](@entry_id:197920)、反褶积技术、以及用于[计算理论](@entry_id:273524)地球响应的正演模拟算法。本章旨在为读者提供一个严谨的理论框架，以便理解和实施接收函数分析。

### 卷积模型与理想接收函数

远震体波在台站的记录过程可以被有效地建模为一个[线性时不变系统](@entry_id:276591)。在此模型下，观测到的地震图是多个因素线性叠加（卷积）的结果。对于一个三分量台站记录的径向（Radial）和垂向（Vertical）位移，$d_r(t)$ 和 $d_z(t)$，其卷积表达式为：
$$
d_r(t) = s(t) * i(t) * g_r(t) + n_r(t)
$$
$$
d_z(t) = s(t) * i(t) * g_z(t) + n_z(t)
$$
其中，$t$ 代表时间，$*$ 代表卷积运算。每个项都有其明确的物理意义：
- **震源时间函数 $s(t)$**：描述了地震破裂过程中能量释放的时间历程。它对于同一地震事件的所有台站是相同的。
- **仪器响应 $i(t)$**：描述了地震计及其[数据采集](@entry_id:273490)系统如何将真实的地动转换成数字记录。它是一个滤波器，其特性由仪器本身决定。
- **格林函数 $g_r(t)$ 和 $g_z(t)$**：代表地球的脉冲响应。它们描述了从震源到台站的路径效应，以及至关重要的、台站下方近地表结构的相互作用。$g_r(t)$ 和 $g_z(t)$ 分别对应径向和垂向分量，其中包含了我们最感兴趣的结构信息，例如P-S转换波。
- **噪声 $n_r(t)$ 和 $n_z(t)$**：代表所有非信号来源的随机或相干干扰。

接收函数方法的核心目标，就是从复杂的观测记录中剥离出地球的近台站结构响应，即 $g_r(t)$ 和 $g_z(t)$ 的相对关系。其基本思想是，对于一个远震P波事件，震源时间函数 $s(t)$ 和仪器响应 $i(t)$ 对径向和垂向分量的影响是共同的。因此，可以通过在两个分量之间进行反褶积来消除这些共同项。

在理想的无噪声情况下（$n_r(t)=n_z(t)=0$），我们可以利用[傅里叶变换](@entry_id:142120)的[卷积定理](@entry_id:264711)来更清晰地理解这一过程。在频率域中，卷积对应于乘法：
$$
D_r(\omega) = S(\omega) I(\omega) G_r(\omega)
$$
$$
D_z(\omega) = S(\omega) I(\omega) G_z(\omega)
$$
此处，$D_r(\omega)$、$S(\omega)$、$I(\omega)$ 和 $G_r(\omega)$ 分别是 $d_r(t)$、$s(t)$、$i(t)$ 和 $g_r(t)$ 的傅里叶谱。接收函数 $R_{RF}(\omega)$ 被定义为径向分量与垂向分量的谱比：
$$
R_{RF}(\omega) = \frac{D_r(\omega)}{D_z(\omega)} = \frac{S(\omega) I(\omega) G_r(\omega)}{S(\omega) I(\omega) G_z(\omega)} = \frac{G_r(\omega)}{G_z(\omega)}
$$
这个简单的谱比操作，在理论上完美地消除了震源时间函数 $S(\omega)$ 和仪器响应 $I(\omega)$。不仅如此，任何对两个分量有相同[乘性](@entry_id:187940)效应的深部地幔路径效应也一并被移除。最终得到的接收函数 $R_{RF}(\omega)$ 仅依赖于台站下方结构的脉冲响应之比 $G_r(\omega)/G_z(\omega)$。对于近垂直入射的远震[P波](@entry_id:178440)，垂向分量主要由入射P波控制，其响应 $g_z(t)$ 近似为一个脉冲。而径向分量则主要包含由台站下方速度[间断面](@entry_id:180188)产生的P-S转换波。因此，反褶积过程本质上是利用垂向分量作为等效的震源子波，从而从径向分量中提取出P-S转换波序列，这正是揭示地下结构的关键信息。

### 数据准备：从原始记录到可处理波形

在应用上述理想化的反褶积概念于真实数据之前，必须进行一系列细致的[数据预处理](@entry_id:197920)步骤，以确保信号的保真度和后续处理的有效性。

#### 仪器响应校正

第一步是校正仪器响应。原始的地震记录是地震计输出的“计数（counts）”，而非真实的地面运动（位移、速度或加速度）。将计数转换为物理单位需要进行仪器响应的反褶积。这一步至关重要，因为仪器本身是一个滤波器，会改变真实地动信号的振幅和相位。如果仪器响应 $I(\omega)$ 未被正确移除，它将作为污染信号残留在接收函数中。

特别需要关注的是仪器的相位特性。一个线性系统可以是**最小相位（minimum phase）**或**非最小相位（non-minimum phase）**的。如果一个[因果稳定系统](@entry_id:268775)的所有零点都位于复平面的左半部分，则其为[最小相位系统](@entry_id:268223)。[非最小相位系统](@entry_id:167094)则至少有一个零点在右半平面。对于非最小相位仪器，其精确的逆滤波器是非因果的。如果在仪器校正时强行使用一个因果滤波器（例如，仅校正振幅谱），就会引入一个**[全通滤波器](@entry_id:199836)（all-pass filter）**的相位畸变。[全通滤波器](@entry_id:199836)在不改变信号振幅谱的情况下，会严重扭曲其相位谱。这种相位畸变在时间域表现为波形弥散，更严重的是，它可能将能量从主脉冲“拖拽”到其前方，产生虚假的**前驱震相（precursory energy）**，并系统性地改变后续转换波的到时。这对基于到时拾取的结构成像而言是致命的偏差。因此，必须使用包含完整极零点信息的“复数反褶积”来精确校正仪器响应的振幅和相位。

#### [坐标系](@entry_id:156346)旋转

地震计通常按地理[坐标系](@entry_id:156346)（北-南 N, 东-西 E, 垂向 Z）布设。然而，地震波的传播和偏振是在一个与波传播方向相关的[坐标系](@entry_id:156346)中定义的。为了有效地分离不同类型的波，需要进行[坐标系](@entry_id:156346)旋转。

首先，利用已知的地震事件相对于台站的**反[方位角](@entry_id:164011)（back-azimuth）** $\phi$（从台站指向震源的方向，由正北顺时针计量），将水平分量（N, E）旋转到**径向-切向（Radial-Transverse, R-T）**[坐标系](@entry_id:156346)。径向 $R$ 指向震源方向，切向 $T$ 与其在水平面内垂直。对于一个理想的水平分层各向同性介质，入射的[P波](@entry_id:178440)和转换产生的SV波（质点[振动](@entry_id:267781)在包含P波传播路径的垂直平面内）的能量都应集中在Z-R平面内，而T分量上应无能量。旋转公式如下：
$$
\begin{pmatrix} R \\ T \end{pmatrix} = \begin{pmatrix} \cos\phi & \sin\phi \\ -\sin\phi & \cos\phi \end{pmatrix} \begin{pmatrix} N \\ E \end{pmatrix}
$$
这在矩阵形式中，将 $[Z, N, E]^T$ 向量转换为 $[Z, R, T]^T$ 向量的[变换矩阵](@entry_id:151616)为：
$$
\begin{bmatrix} Z \\ R \\ T \end{bmatrix} = \begin{bmatrix} 1 & 0 & 0 \\ 0 & \cos\phi & \sin\phi \\ 0 & -\sin\phi & \cos\phi \end{bmatrix} \begin{bmatrix} Z \\ N \\ E \end{bmatrix}
$$

为了进一步提纯信号，可以进行第二次旋转，将Z-R[坐标系](@entry_id:156346)旋转到与[P波](@entry_id:178440)传播方向对齐的**L-Q-T[坐标系](@entry_id:156346)**。这次旋转利用[P波](@entry_id:178440)的**[入射角](@entry_id:192705)** $\theta$（[P波](@entry_id:178440)射线与垂向的夹角）。L轴沿[P波](@entry_id:178440)传播方向，Q轴在Z-R平面内且与L轴垂直，近似于SV[波的偏振](@entry_id:262733)方向。在各向同性介质中，P波是纵波，其质点运动平行于传播方向；[S波](@entry_id:174890)是横波，其质点运动垂直于传播方向。通过这次旋转，入射P波的能量几乎全部投影到L分量上，而P-S转换产生的SV[波能](@entry_id:164626)量则主要投影到Q分量上。这极大地减少了[P波](@entry_id:178440)能量向径向分量的“泄漏”，显著提高了目标信号（转换波）的信噪比。其旋转矩阵为：
$$
\begin{bmatrix} L \\ Q \\ T \end{bmatrix} = \begin{bmatrix} \cos\theta & \sin\theta & 0 \\ -\sin\theta & \cos\theta & 0 \\ 0 & 0 & 1 \end{bmatrix} \begin{bmatrix} Z \\ R \\ T \end{bmatrix}
$$
在实际操作中，通常在L-Q-T系统下进行反褶积，即将Q分量作为信号，L分量作为源子波。

### 反褶积过程：技术与权衡

反褶积是接收函数计算的核心步骤，但它在数学上是一个“[不适定问题](@entry_id:182873)”（ill-posed problem）。直接进行谱比运算 $\hat{R}(\omega) = D_r(\omega)/D_z(\omega)$ 会在垂向分量谱 $D_z(\omega)$ 出现谱谷（接近于零）的频率处，极大地放大数据中的噪声，导致结果不稳定。因此，必须采用[正则化技术](@entry_id:261393)来稳定反褶积过程。

#### 稳定化反褶积技术

目前已有多种成熟的反褶积方法，其中最常用的是**[水平衡](@entry_id:140465)反褶积（water-level deconvolution）**。该方法首先将谱比写成互功率谱与自功率谱之比的形式，然后通过在分母上增加一个小的正常数（“[水平衡](@entry_id:140465)”）来避免除以零。其频率域估计器 $\hat{R}(\omega)$ 表达式为：
$$
\hat{R}(\omega) = \frac{D_r(\omega) D_z^*(\omega)}{|D_z(\omega)|^2 + \epsilon}
$$
其中，$D_z^*(\omega)$ 是 $D_z(\omega)$ 的复共轭，$|D_z(\omega)|^2$ 是垂向分量的功率谱，$\epsilon$ 是一个很小的正数，称为**水[平衡因子](@entry_id:634503)**。$\epsilon$ 的取值通常与垂向分量[功率谱](@entry_id:159996)的最大值成正比，例如 $\epsilon = \lambda \max_{\omega} |D_z(\omega)|^2$，其中 $\lambda$ 是一个小的百分比（如 $0.01$）。

另一种更先进的方法是**多窗谱互谱反褶积（multitaper cross-spectral deconvolution）**。该方法通过使用一组相互正交的[窗函数](@entry_id:139733)（通常是离散[扁球体](@entry_id:161771)序列，DPSS）对信号进行[加窗](@entry_id:145465)，得到多个独立的[谱估计](@entry_id:262779)，然后将这些[谱估计](@entry_id:262779)进行平均，从而获得[方差](@entry_id:200758)更小的互功率谱和自[功率谱估计](@entry_id:753656)。其估计器形式为：
$$
\hat{R}(\omega) = \frac{\sum_{k=1}^{K} D_r^{(k)}(\omega) D_z^{(k)*}(\omega)}{\sum_{k=1}^{K} |D_z^{(k)}(\omega)|^2}
$$
其中，$D^{(k)}$ 是使用第 $k$ 个窗函数得到的谱，$K$ 是[窗函数](@entry_id:139733)的数量。这种方法通过平均来平滑谱，减少谱谷出现的概率和深度，从而在统计意义上稳定了反褶积，而无需引入人为的水[平衡因子](@entry_id:634503)。

#### 分辨率与噪声的权衡

无论使用何种反褶积方法，通常都需要进行低通滤波来抑制高频噪声。最常用的滤波器是**高斯滤波器**，其频率域形式为：
$$
G(\omega) = \exp\left(-\frac{\omega^2}{4a}\right)
$$
其中，$a$ 是控制滤波器宽度的参数。在反褶积后，将得到的谱乘以 $G(\omega)$ 再反变换回时间域。参数 $a$ 的选择体现了一个经典的分辨率-[方差](@entry_id:200758)权衡。

- 当 **$a$ 增大**时，高斯滤波器在频率域变得更“宽”，允许更多的高频成分通过。这对应于时间域的脉冲响应 $g(t) \propto \exp(-at^2)$ 变得更“窄”（其标准差 $\sigma_t = 1/\sqrt{2a}$ 减小）。更窄的脉冲意味着更高的**时间分辨率**，能够分辨更近的震相，但也意味着更多的高频噪声会被保留在最终的接收函数中。
- 当 **$a$ 减小**时，高斯滤波器在频率域变得更“窄”，更有效地抑制高频噪声。但这对应于时间域的脉冲变得更“宽”，导致接收函数中的脉冲被平滑（模糊化），**[时间分辨率](@entry_id:194281)**降低。

因此，选择合适的$a$值是在获得清晰结构图像和抑制噪声之间做出权衡，这需要根据具体数据的[信噪比](@entry_id:185071)和研究目标来决定。

### 正演模拟：模拟地球的响应

正演模拟是指对于一个给定的地[球模型](@entry_id:161388)（如速度、密度随深度的变化），计算其理论上的接收函数。这是解释观测接收函数和进行反演的基础。

#### 平面波假设的物理基础

远震体波正演模拟的一个基本假设是**[平面波](@entry_id:189798)入射**。这是因为震源距离台站非常遥远（通常数千公里），地震波在到达台站附近时，其波前曲率已经非常小，可以近似为平面。这个假设的有效性，取决于我们所研究的地下结构的尺度。

波的传播并非严格沿几何射线路径，而是受到衍射效应的影响。一个更有物理意义的衡量标准是**第一菲涅耳带（first Fresnel zone）**的尺寸。对于一个在深度 $h$ 处发生P-S转换的界面，其对台站记录产生相长干涉贡献的主要区域就是第一菲涅耳带。这个区域的直径 $D_F$ 可以近似估算。如果该直径远小于地下界面曲率的尺度或非均匀体横向变化的尺度，那么[平面波](@entry_id:189798)假设就是有效的，因为波“看到”的界面是近似平坦和均匀的。反之，如果菲涅耳带的尺寸与结构变化的尺度相当或更大，那么三维散射和聚焦/散焦效应将变得显著，简单的[平面波](@entry_id:189798)模型将失效。

例如，对于一个在深度 $h=30$ km的Moho面，入射波主频 $f=0.5$ Hz，地壳P波和[S波](@entry_id:174890)速度分别为 $v_P=6.2$ km/s 和 $v_S=3.6$ km/s，其P-S转换的第一菲涅耳带直径可以估算为大约 $23.4$ km。如果该区域的Moho面曲率半径远大于此值（例如 $150$ km），且速度非均匀体的特征尺度也大于此值（例如 $35$ km），那么[平面波](@entry_id:189798)假设对于此次转换是合理的。

#### 一维层状介质中的波场计算

对于水平分层的（一维）各向同性介质模型，计算理论地震图已有非常成熟的算法。这些算法求解在频率-[波数](@entry_id:172452)（$\omega-p$）域中的弹性波动方程。

经典的方法是 **Thomson-Haskell[传播矩阵](@entry_id:753816)法**。该方法将介质划分为一系列均匀的薄层。对于每一层，定义一个包含位移和应力分量的**[状态向量](@entry_id:154607)** $\mathbf{y}(z) = [u_x, u_z, \sigma_{xz}, \sigma_{zz}]^T$。通过求解该层内的波动方程，可以构建一个 $4 \times 4$ 的**[传播矩阵](@entry_id:753816)** $\mathbf{P}_\ell$，它将该层顶部的[状态向量](@entry_id:154607)映射到底部。对于一个由 $N$ 层构成的介质叠层，总的[传播矩阵](@entry_id:753816)就是各层[传播矩阵](@entry_id:753816)的连乘积 $\mathbf{P}_{\text{tot}} = \mathbf{P}_N \cdots \mathbf{P}_1$。最后，结合[自由表面边界条件](@entry_id:749579)和底层半空间的辐射条件，即可求解整个系统的响应。

然而，Haskell矩阵法存在一个严重的数值问题。当频率较高或存在低速层时，波会在某些层内变为**[倏逝波](@entry_id:156713)（evanescent wave）**，其振幅随深度呈指数增长或衰减。[传播矩阵](@entry_id:753816)的[特征值](@entry_id:154894)中包含了形如 $\exp(\pm \omega |\text{Im}(q)| h)$ 的项，其中 $q$ 是虚数垂直慢度。在多层连乘后，指数增长项会迅速导致数值溢出，而指数衰减项会导致精度丧失，使得整个计算过程在数值上变得极不稳定。这被称为“大数/小数问题”。

为了克服这一困难，发展出了更为稳健的**[反射率法](@entry_id:754191)（Reflectivity Method）**，如Kennett提出的方法。该方法不直接传播包含绝对振幅的状态向量，而是递推地计算层状介质叠层的**反射和透射系数矩阵**。其核心思想是，一个层叠的反射响应，可以由顶层的反射响应，加上穿过顶层、在下伏层叠中反射、再穿回顶层的波场贡献来表示。这个过程可以被表达为一个包含所有阶次内部混响（multiple reflections）的[几何级数](@entry_id:158490)（[Neumann级数](@entry_id:191685)），并可以求得一个封闭解。例如，位于第 $j$ 层顶部的广义反射矩阵 $\boldsymbol{\Gamma}_j$ 可以由下伏层叠的反射矩阵 $\boldsymbol{\Gamma}_{j+1}$ 和第 $j$ 层的性质（反射/透射矩阵 $\mathbf{R}_j, \mathbf{T}_j$ 等，以及层内传播算子 $\mathbf{E}_j$）通过以下[递推公式](@entry_id:149465)得到：
$$
\boldsymbol{\Gamma}_j = \mathbf{R}_j + \mathbf{T}'_j \mathbf{E}_j \boldsymbol{\Gamma}_{j+1} (\mathbf{I} - \mathbf{R}'_j \mathbf{E}_j \boldsymbol{\Gamma}_{j+1} \mathbf{E}_j)^{-1} \mathbf{E}_j \mathbf{T}_j
$$
由于反射/[透射系数](@entry_id:756126)的物理性质（模长小于1），这个递推过程是无[条件数](@entry_id:145150)值稳定的，避免了指数增长项的累积。因此，[反射率法](@entry_id:754191)已成为当今计算一维介质理论地震图的标准工具。

#### 线性化正演：[Born近似](@entry_id:138141)

除了计算完全[非线性](@entry_id:637147)的地震响应外，另一种强大的正演模拟[范式](@entry_id:161181)是**线性化近似**，其中最著名的是**单次散射[Born近似](@entry_id:138141)**。该方法适用于介质属性（如P波速度 $\alpha(z)$，S波速度 $\beta(z)$, 密度 $\rho(z)$）仅在某个已知背景模型（$\alpha_0(z), \beta_0(z), \rho_0(z)$）上有微小扰动的情况。

[Born近似](@entry_id:138141)的基本思想是，总波场可以分解为背景场（在背景模型中传播的波）和散射场（由介质扰动与背景场相互作用产生）。在单次散射近似下，我们只考虑背景场被扰动散射一次所产生的波场，而忽略散射波的再次散射（即多次散射）。这种近似将一个复杂的[非线性](@entry_id:637147)问题转化为一个线性问题。最终，散射场所产生的接收函数 $R(t)$ 可以表示为一个关于介质参数扰动 $\delta\alpha(z)$, $\delta\beta(z)$, $\delta\rho(z)$ 的线性积分：
$$
R(t) = \int_{0}^{\infty} \left[ K_{\alpha}(z)\delta\alpha(z) + K_{\beta}(z)\delta\beta(z) + K_{\rho}(z)\delta\rho(z) \right] s(t - T_{ps}(z)) \mathrm{d}z
$$
这里的 $K_{\alpha}(z)$, $K_{\beta}(z)$, $K_{\rho}(z)$ 是**敏感度核（sensitivity kernels）**或Fréchet导数，它们描述了单位深度的介质参数扰动对接收函数的贡献。这些核函数由背景模型的格林函数和背景波场决定。$T_{ps}(z)$ 是在背景模型中从深度 $z$ 发生的P-S转换相对于直达[P波](@entry_id:178440)的走时。这个[线性关系](@entry_id:267880)是[地球物理反演](@entry_id:749866)理论的基石，因为它允许我们使用线性代数工具从观测数据（接收函数）中求解模型扰动。

### 质量控制与信号解释

在对真实的接收函数进行结构解释之前，最后一步是进行严格的质量控制，以识别和理解数据中的各种非理想成分。对于理想的一维各向同性介质，T分量上应无[信号能量](@entry_id:264743)。因此，T分量的存在是诊断结构复杂性的重要指标。

实践中，需要区分三种主要的“污染”源：
1.  **随机噪声**：与信号不相关，在不同事件或台站之间没有重[复性](@entry_id:162752)。其特点是在不同分量之间[相干性](@entry_id:268953)低，并且可以通过对多个事件的接收函数进行叠加来有效压制。
2.  **相干噪声**：具有确定性特征的非结构信号，例如特定频率的仪器自噪声、风或交通引起的场地噪声。其特点是在功率谱上表现为孤立的窄带峰值，并且这些峰值在不同事件记录中重复出现。
3.  **P波能量泄漏**：本应主要集中在Z或L分量上的P波能量，部分泄漏到了R或Q分量上。这可能是由于[坐标系](@entry_id:156346)旋转不准确（[方位角](@entry_id:164011)或[入射角](@entry_id:192705)错误）、台站倾斜、或更复杂的地下结构（如各向异性、倾斜界面）引起的。

可以通过一系列诊断测试来识别这些成分：
-   **[P波](@entry_id:178440)能量泄漏诊断**：计算P波窗内Z分量和R分量的**[互相关](@entry_id:143353)**和**相干性**。如果存在显著泄漏，它们在零延迟附近会表现出高峰值，并且在[P波](@entry_id:178440)的频带内具有高[相干性](@entry_id:268953)。对波形进行偏振分析，如果[P波](@entry_id:178440)到达时的主偏振方向偏离了理论的L轴方向，也指示了泄漏的存在。
-   **相干噪声诊断**：检查各个分量的**功率谱**。如果在多个事件中都出现不随慢度变化的固定频率窄带峰值，则很可能是相干噪声。
-   **随机噪声诊断**：信号中那些在分量间相干性低、在事件间不重复、且不能通过叠加增强的部分，通常被归为随机噪声。

通过这些诊断，研究者可以评估接收函数结果的可靠性，并判断所观测到的特征是真实的地下结构响应，还是数据处理或复杂地质效应的产物。