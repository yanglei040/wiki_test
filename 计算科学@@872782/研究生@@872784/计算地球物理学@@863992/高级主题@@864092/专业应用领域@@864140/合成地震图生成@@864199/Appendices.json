{"hands_on_practices": [{"introduction": "反射系数是构建合成地震记录的基本要素，它量化了地震波在介质分界面上的能量分配。在实践中，我们往往无法获得所有必需的岩石物理参数（例如密度），因此必须依赖像Gardner关系这样的经验公式进行估算。本练习将引导你亲手计算这种常见且必要的近似方法可能引入的误差或偏差，从而加深对模型参数不确定性如何影响最终合成结果的理解。[@problem_id:3615963]", "problem": "给定一组代表一维声学地球模型中平面水平界面的地层对。每个地层都是均匀、各向同性且无损耗的。一个垂直入射的平面压缩波向下传播，并与每个界面相互作用。你需要评估，对于每个界面，使用经验密度-速度幂律关系（通过压缩波速度估算密度）相对于使用实测密度，会给垂直入射反射系数带来多大的偏差。\n\n从以下基本原理出发：\n- 一维、线性、无损耗声学介质中，平面波垂直入射时，声压和质点速度在平面界面两侧的连续性。\n- 声阻抗$Z$的定义，其等于体积密度与压缩波速度的乘积。\n- 存在一个广泛使用的经验幂律关系，该关系最初由实验室和测井数据建立，连接了体积密度与压缩波速度，并由两个正常数参数化。\n\n要执行的任务和计算的量：\n1. 仅使用上述基本原理，推导两个声学半空间之间界面的垂直入射反射系数，用上、下介质的声阻抗表示。\n2. 使用连接体积密度和压缩波速度的经验幂律关系（常数为$a_g$和$b_g$），将其转换为与本问题中指定单位一致的形式。应使用的规范常数为$a_g=0.31$和$b_g=0.25$，它们将单位为米/秒的压缩波速度映射到单位为克/立方厘米的体积密度。将此关系转换为输出单位为千克/立方米的密度。你的程序必须统一使用米/秒作为压缩波速度单位，千克/立方米作为密度单位。\n3. 对于下方的每个测试界面，计算：\n   - 使用两层中实测密度计算的真实反射系数$R_{\\text{true}}$。\n   - 将实测密度替换为使用你在步骤2中建立的单位一致的经验幂律关系从压缩波速度估算出的密度，计算得到的Gardner估算反射系数$R_{\\text{est}}$。\n   - 有符号振幅偏差$\\Delta R = R_{\\text{est}} - R_{\\text{true}}$。此量为无量纲，必须以十进制数报告。\n\n数值和单位要求：\n- 压缩波速度$V_P$的单位为米/秒。\n- 密度$\\rho$的单位为千克/立方米。\n- 反射系数和振幅偏差是无量纲的。\n- 将每个报告的振幅偏差四舍五入到六位小数。\n\n测试组：\n计算以下五个界面的有符号振幅偏差$\\Delta R$，每个界面由四元组$(V_{P1},\\rho_1,V_{P2},\\rho_2)$指定，其中下标$1$表示上层，下标$2$表示下层。$V_P$的单位是米/秒，$\\rho$的单位是千克/立方米。\n\n- 情况1：$(V_{P1},\\rho_1,V_{P2},\\rho_2) = (2200, 2150, 2600, 2350)$\n- 情况2：$(V_{P1},\\rho_1,V_{P2},\\rho_2) = (2500, 2200, 6000, 2700)$\n- 情况3：$(V_{P1},\\rho_1,V_{P2},\\rho_2) = (1500, 1800, 1700, 1850)$\n- 情况4（构造成真实阻抗差为零）：$(V_{P1},\\rho_1,V_{P2},\\rho_2) = (2000, 2000, 1600, 2500)$\n- 情况5（含气砂岩示例）：$(V_{P1},\\rho_1,V_{P2},\\rho_2) = (2750, 2400, 2000, 1700)$\n\n最终输出格式：\n你的程序应生成单行输出，其中包含五个测试用例的有符号振幅偏差，形式为以逗号分隔的列表，并用方括号括起来，四舍五入到六位小数，例如$[\\Delta R_1,\\Delta R_2,\\Delta R_3,\\Delta R_4,\\Delta R_5]$。输出字符串中不能有空格。因为每个$\\Delta R$都是无量纲的，所以不应打印任何单位。", "solution": "### 步骤1：垂直入射反射系数的推导\n\n平面界面上的垂直入射反射系数$R$可以从声压和质点速度连续性的边界条件推导出来。\n\n设界面位于平面$z=0$处。上层介质（$z0$）为地层1，其性质为（$\\rho_1$, $V_{P1}$），下层介质（$z>0$）为地层2，其性质为（$\\rho_2$, $V_{P2}$）。一个简谐平面压缩波沿z轴正方向向下传播。\n\n声压$P(z,t)$和质点速度的法向分量$u(z,t)$可以用位移势$\\phi(z,t)$表示：\n$$P(z,t) = -\\rho \\frac{\\partial \\phi}{\\partial t}$$\n$$u(z,t) = \\frac{\\partial \\phi}{\\partial z}$$\n\n对于角频率为$\\omega$的简谐波，位移势为：\n- 在地层1中：$\\phi_1(z,t) = \\left( A_I e^{-ik_1 z} + A_R e^{ik_1 z} \\right) e^{i\\omega t}$\n- 在地层2中：$\\phi_2(z,t) = A_T e^{-ik_2 z} e^{i\\omega t}$\n\n此处，$A_I$、$A_R$和$A_T$分别是入射波、反射波和透射波的复振幅。每个地层中的波数为$k_j = \\omega/V_{Pj}$，其中$j=1,2$。\n\n每个地层中的压力和质点速度为：\n- 地层1：\n  - $P_1(z,t) = -i\\omega\\rho_1 \\left( A_I e^{-ik_1 z} + A_R e^{ik_1 z} \\right) e^{i\\omega t}$\n  - $u_1(z,t) = -ik_1 \\left( A_I e^{-ik_1 z} - A_R e^{ik_1 z} \\right) e^{i\\omega t}$\n- 地层2：\n  - $P_2(z,t) = -i\\omega\\rho_2 A_T e^{-ik_2 z} e^{i\\omega t}$\n  - $u_2(z,t) = -ik_2 A_T e^{-ik_2 z} e^{i\\omega t}$\n\n在$z=0$处应用边界条件：\n1.  压力连续性：$P_1(0,t) = P_2(0,t)$\n    $$\\rho_1 (A_I + A_R) = \\rho_2 A_T$$\n2.  质点速度连续性：$u_1(0,t) = u_2(0,t)$\n    $$k_1 (A_I - A_R) = k_2 A_T$$\n\n我们可以从第一个方程中表示$A_T$为$A_T = \\frac{\\rho_1}{\\rho_2} (A_I + A_R)$，并将其代入第二个方程：\n$$k_1 (A_I - A_R) = k_2 \\frac{\\rho_1}{\\rho_2} (A_I + A_R)$$\n\n代入$k_j = \\omega/V_{Pj}$并通过消去$\\omega$来简化：\n$$\\frac{1}{V_{P1}} (A_I - A_R) = \\frac{\\rho_1}{V_{P2}\\rho_2} (A_I + A_R)$$\n\n重新排列各项以求解反射系数$R = A_R/A_I$：\n$$V_{P2}\\rho_2 (A_I - A_R) = V_{P1}\\rho_1 (A_I + A_R)$$\n\n定义声阻抗为$Z_j = \\rho_j V_{Pj}$：\n$$Z_2 (A_I - A_R) = Z_1 (A_I + A_R)$$\n$$Z_2 A_I - Z_1 A_I = Z_1 A_R + Z_2 A_R$$\n$$A_I (Z_2 - Z_1) = A_R (Z_1 + Z_2)$$\n\n这得到了垂直入射反射系数的表达式：\n$$R = \\frac{A_R}{A_I} = \\frac{Z_2 - Z_1}{Z_2 + Z_1}$$\n\n### 步骤2：经验幂律关系的单位转换\n\n问题提供了一个经验幂律关系（Gardner关系式），它将体积密度$\\rho$与压缩波速度$V_P$联系起来：\n$$\\rho' = a_g (V_P)^{b_g}$$\n其中$\\rho'$的单位是克/立方厘米（$\\text{g/cm}^3$），$V_P$的单位是米/秒（$\\text{m/s}$），常数为$a_g=0.31$和$b_g=0.25$。\n\n问题要求密度$\\rho$的单位是千克/立方米（$\\text{kg/m}^3$）。这些单位之间的换算关系是：\n$$1 \\, \\text{g/cm}^3 = \\frac{10^{-3} \\, \\text{kg}}{(10^{-2} \\, \\text{m})^3} = \\frac{10^{-3}}{10^{-6}} \\, \\text{kg/m}^3 = 1000 \\, \\text{kg/m}^3$$\n因此，要将$\\rho'$从$\\text{g/cm}^3$转换为单位为$\\text{kg/m}^3$的$\\rho$，我们需要乘以$1000$：\n$$\\rho \\, (\\text{in kg/m}^3) = 1000 \\times \\rho' \\, (\\text{in g/cm}^3)$$\n将此应用于经验关系式：\n$$\\rho = 1000 \\times a_g (V_P)^{b_g}$$\n代入给定的$a_g$和$b_g$值：\n$$\\rho_{\\text{est}} = 1000 \\times 0.31 \\times (V_P)^{0.25} = 310 (V_P)^{0.25}$$\n这就是用于从单位为$\\text{m/s}$的$V_P$估算单位为$\\text{kg/m}^3$的密度$\\rho_{\\text{est}}$的单位一致性方程。我们可以为这些单位定义新的常数：$a=310$和$b=0.25$。\n\n### 步骤3：反射系数偏差的计算\n\n对于由$(V_{P1}, \\rho_1, V_{P2}, \\rho_2)$指定的每个界面，我们计算两个反射系数。\n\n1.  **真实反射系数 ($R_{\\text{true}}$)**：\n    这是使用实测的密度和速度计算的。\n    -   真实声阻抗：$Z_1 = \\rho_1 V_{P1}$和$Z_2 = \\rho_2 V_{P2}$。\n    -   真实反射系数：$R_{\\text{true}} = \\frac{Z_2 - Z_1}{Z_2 + Z_1}$。\n\n2.  **Gardner估算反射系数 ($R_{\\text{est}}$)**：\n    这是通过将实测密度替换为使用转换后的幂律关系从速度估算出的密度来计算的。\n    -   估算密度：$\\rho_{1,\\text{est}} = a (V_{P1})^b$和$\\rho_{2,\\text{est}} = a (V_{P2})^b$，其中$a=310$，$b=0.25$。\n    -   估算声阻抗：$Z_{1,\\text{est}} = \\rho_{1,\\text{est}} V_{P1} = a (V_{P1})^{b} V_{P1} = a (V_{P1})^{1+b}$和$Z_{2,\\text{est}} = a (V_{P2})^{1+b}$。\n    -   估算反射系数：\n        $$R_{\\text{est}} = \\frac{Z_{2,\\text{est}} - Z_{1,\\text{est}}}{Z_{2,\\text{est}} + Z_{1,\\text{est}}} = \\frac{a (V_{P2})^{1+b} - a (V_{P1})^{1+b}}{a (V_{P2})^{1+b} + a (V_{P1})^{1+b}}$$\n        常数$a$被消掉，表达式简化为：\n        $$R_{\\text{est}} = \\frac{(V_{P2})^{1.25} - (V_{P1})^{1.25}}{(V_{P2})^{1.25} + (V_{P1})^{1.25}}$$\n\n3.  **有符号振幅偏差 ($\\Delta R$)**：\n    偏差是估算反射系数与真实反射系数之差。\n    $$\\Delta R = R_{\\textest} - R_{\\text{true}}$$\n    对每种情况计算这个无量纲量，并四舍五入到六位小数。\n\n将此程序应用于所提供的五个测试用例。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the signed amplitude bias in reflection coefficients\n    for five geological interfaces.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (V_P1, rho_1, V_P2, rho_2)\n    # Units: V_P in m/s, rho in kg/m^3\n    test_cases = [\n        # Case 1\n        (2200.0, 2150.0, 2600.0, 2350.0),\n        # Case 2\n        (2500.0, 2200.0, 6000.0, 2700.0),\n        # Case 3\n        (1500.0, 1800.0, 1700.0, 1850.0),\n        # Case 4 (zero true impedance contrast)\n        (2000.0, 2000.0, 1600.0, 2500.0),\n        # Case 5 (gas-charged sand example)\n        (2750.0, 2400.0, 2000.0, 1700.0),\n    ]\n\n    results = []\n    \n    # Power for Gardner's relation, b = 0.25\n    b = 0.25\n    power = 1.0 + b # This is 1.25\n\n    def calculate_bias(vp1, rho1, vp2, rho2):\n        \"\"\"\n        Calculates the signed amplitude bias for a single interface.\n\n        Args:\n            vp1 (float): P-wave velocity of the upper layer (m/s).\n            rho1 (float): Density of the upper layer (kg/m^3).\n            vp2 (float): P-wave velocity of the lower layer (m/s).\n            rho2 (float): Density of the lower layer (kg/m^3).\n\n        Returns:\n            float: The signed amplitude bias.\n        \"\"\"\n        # 1. Calculate the true reflection coefficient (R_true)\n        z1_true = rho1 * vp1\n        z2_true = rho2 * vp2\n        \n        # Handle the case where Z1 + Z2 is zero to avoid division by zero,\n        # although physically unlikely for positive Vp and rho.\n        if (z1_true + z2_true) == 0:\n            # If Z1 = -Z2, R is undefined. If Z1=Z2=0, also undefined.\n            # Assuming Z1=Z2=0 results in R_true=0 as there is no impedance.\n            # Physically, Z > 0.\n            r_true = 0.0\n        else:\n            r_true = (z2_true - z1_true) / (z1_true + z2_true)\n\n        # 2. Calculate the Gardner-estimated reflection coefficient (R_est)\n        # As derived, R_est = (V_P2^(1+b) - V_P1^(1+b)) / (V_P2^(1+b) + V_P1^(1+b))\n        vp1_pow = vp1 ** power\n        vp2_pow = vp2 ** power\n\n        if (vp1_pow + vp2_pow) == 0:\n            # Should not happen for positive Vp\n            r_est = 0.0\n        else:\n            r_est = (vp2_pow - vp1_pow) / (vp1_pow + vp2_pow)\n\n        # 3. Calculate the signed amplitude bias (Delta R)\n        delta_r = r_est - r_true\n        return delta_r\n\n    for case in test_cases:\n        vp1, rho1, vp2, rho2 = case\n        bias = calculate_bias(vp1, rho1, vp2, rho2)\n        # Format the result to exactly six decimal places for the output string.\n        results.append(f\"{bias:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3615963"}, {"introduction": "一个物理上正确的模型如果数值模拟设计不当，仍然可能产生无用的结果。本练习将探讨计算地球物理学中的一个基本挑战：如何选择合适的空间网格以避免空间混叠。你将学习如何将模型的物理参数（如最小速度 $v_{\\min}$ 和最大出射角 $\\theta_{\\max}$）与数值设计参数（如网格间距 $\\Delta x$ 和最大频率 $f_{\\max}$）联系起来，以确保合成数据在数值上的保真度。[@problem_id:3615906]", "problem": "您正在使用有限差分（FD）建模方法，为各向同性声学介质设计一个二维合成炮集。接收器将沿着一条水平线以均匀间距 $\\Delta x$ 布置。模拟的震源是一个带限子波，其时间频谱在超过指定的最大频率 $f_{\\max}$ 后可以忽略不计。为确保炮集对于任何在接收器排列处的视出射角（从垂直方向测量）不超过预定最大值 $\\theta_{\\max}$ 的事件都不出现空间混叠，您必须选择足够小的 $\\Delta x$ 以满足数据中存在的所有平面波分量的空间采样要求。\n\n从以下基本依据出发：\n- 二维常系数声波方程，其单色平面波解 $p(x,z,t)=A \\exp\\{ \\mathrm{i}(\\omega t - k_x x - k_z z)\\}$ 满足色散关系 $\\omega^{2} = v^{2}(k_x^{2} + k_z^{2})$，其中 $v$ 是相速度，$\\omega=2\\pi f$ 是角频率，$(k_x,k_z)$ 是波矢量。\n- 空间奈奎斯特采样定理，该定理指出，如果波数 $k_x$ 上的带限场的波数支持满足 $|k_x| \\leq \\pi/\\Delta x$，则可以在间距为 $\\Delta x$ 的空间网格上对其进行无混叠采样，\n\n当模型中的最小相速度为 $v_{\\min}$ 时，推导一个最大允许接收器间距 $\\Delta x$ 的保守表达式，该表达式能防止所有时间频率高达 $f_{\\max}$ 和所有出射角高达 $\\theta_{\\max}$ 的情况下的空间混叠。然后，使用以下设计参数对此间距进行数值计算：\n$$v_{\\min} = 2.000 \\times 10^{3} \\text{ m/s}, \\quad f_{\\max} = 1.00 \\times 10^{2} \\text{ Hz}, \\quad \\theta_{\\max} = 60.0^\\circ.$$\n\n最终间距以米为单位表示，并将您的答案四舍五入到四位有效数字。角度使用度数。", "solution": "推导过程首先建立水平波数 $k_x$、频率 $f$、速度 $v$ 和出射角 $\\theta$ 之间的关系。然后，我们在指定约束条件下确定 $k_x$ 的最大可能值，并应用奈奎斯特采样准则来找到相应的最大允许接收器间距 $\\Delta x$。\n\n对于单色平面波，波矢量 $\\vec{k}$ 的大小由 $k = |\\vec{k}| = \\sqrt{k_x^2 + k_z^2}$ 给出。根据色散关系 $\\omega^2 = v^2 k^2$，这意味着 $k = \\omega/v$。由于 $\\omega = 2\\pi f$，我们有：\n$$k = \\frac{2\\pi f}{v}$$\n出射角 $\\theta$ 是从垂直（$z$）轴测量的。因此，波矢量的分量通过 $k_x = k \\sin\\theta$ 和 $k_z = k \\cos\\theta$ 与角度 $\\theta$ 相关。代入 $k$ 的表达式，我们得到水平波数 $k_x$：\n$$k_x = \\frac{2\\pi f}{v} \\sin\\theta$$\n空间奈奎斯特采样定理要求采样间隔 $\\Delta x$ 必须足够小，以便无混叠地捕获信号中存在的最高水平波数。条件是 $|k_x| \\le k_{x, \\text{Nyquist}} = \\frac{\\pi}{\\Delta x}$。为确保此条件对模拟中所有可能的波都成立，我们必须考虑使 $|k_x|$ 最大化的最坏情况。这将得出一个保守的（即足够小的）采样间隔。\n\n$k_x$ 的大小在以下情况下最大化：\n1. 频率 $f$ 处于其最大值 $f_{\\max}$。\n2. 相速度 $v$ 处于其最小值 $v_{\\min}$。对于给定的频率，速度较低的介质会导致波长更短，因此波数更大。\n3. 项 $|\\sin\\theta|$ 被最大化。鉴于角度 $\\theta$ 的范围可以从 $0$ 到 $\\theta_{\\max}$，并且 $\\sin\\theta$ 在区间 $[0^\\circ, 90^\\circ]$ 上是单调递增函数，其最大值出现在 $\\theta = \\theta_{\\max}$。\n\n综合这些因素，得到绝对最大水平波数 $k_{x, \\text{abs_max}}$：\n$$k_{x, \\text{abs_max}} = \\frac{2\\pi f_{\\max}}{v_{\\min}} \\sin\\theta_{\\max}$$\n对于接收器间距 $\\Delta x$ 的无混叠条件必须对这个最大波数成立：\n$$k_{x, \\text{abs_max}} \\le \\frac{\\pi}{\\Delta x}$$\n代入 $k_{x, \\text{abs_max}}$ 的表达式：\n$$\\frac{2\\pi f_{\\max}}{v_{\\min}} \\sin\\theta_{\\max} \\le \\frac{\\pi}{\\Delta x}$$\n求解 $\\Delta x$，我们得到对接收器间距的约束：\n$$\\Delta x \\le \\frac{\\pi v_{\\min}}{2\\pi f_{\\max} \\sin\\theta_{\\max}}$$\n简化此表达式，得到保证无空间混叠的最大允许接收器间距 $\\Delta x_{\\max}$ 的公式：\n$$\\Delta x_{\\max} = \\frac{v_{\\min}}{2 f_{\\max} \\sin\\theta_{\\max}}$$\n这是推导出的接收器间距的保守表达式。\n\n接下来，我们使用给定的数值计算此表达式：\n- $v_{\\min} = 2.000 \\times 10^{3} \\text{ m/s}$\n- $f_{\\max} = 1.00 \\times 10^{2} \\text{ Hz}$\n- $\\theta_{\\max} = 60.0^\\circ$\n\n我们注意到 $\\sin(60.0^\\circ) = \\frac{\\sqrt{3}}{2}$。\n\n将这些值代入 $\\Delta x_{\\max}$ 的公式中：\n$$\\Delta x_{\\max} = \\frac{2.000 \\times 10^{3}}{2 \\times (1.00 \\times 10^{2}) \\times \\sin(60.0^\\circ)}$$\n$$\\Delta x_{\\max} = \\frac{2000}{2 \\times 100 \\times \\frac{\\sqrt{3}}{2}} = \\frac{2000}{100\\sqrt{3}} = \\frac{20}{\\sqrt{3}}$$\n计算数值：\n$$\\Delta x_{\\max} \\approx 11.54700538... \\text{ m}$$\n根据问题的要求，结果必须四舍五入到四位有效数字。\n$$\\Delta x_{\\max} \\approx 11.55 \\text{ m}$$", "answer": "$$\\boxed{11.55}$$", "id": "3615906"}, {"introduction": "许多简化的合成地震图模型含蓄地使用了“远场”近似，将波前简化为平面波。然而，在近偏移距或低频情况下，这种近似可能导致显著误差。本练习将深入探讨点源波动方程的完整解，让你能够推导并量化“近场”项的贡献，从而理解在何种条件下必须考虑这些项以生成高精度的合成地震记录。[@problem_id:3615929]", "problem": "考虑一个三维、均匀、各向同性的弹性全空间，其密度为 $\\rho$，Lamé参数为 $\\lambda$ 和 $\\mu$，纵波波速为 $c_{p} = \\sqrt{\\frac{\\lambda + 2\\mu}{\\rho}}$，横波波速为 $c_{s} = \\sqrt{\\frac{\\mu}{\\rho}}$。位于原点的一个点源产生各向同性的时谐体膨胀，该点源仅激发纵波（P波），不激发横波（S波）。假设源的角频率为 $\\omega$，时间依赖关系为 $\\exp(-\\mathrm{i}\\omega t)$。在短偏移距处，合成地震记录的生成通常对弹性动力学格林张量中的近场项很敏感。\n\n从Navier弹性动力学方程出发，利用位移场的Helmholtz分解，请从第一性原理推导在距离源径向距离为 $r$ 的接收点处，径向位移 $u_{r}(r,\\omega)$ 的领头阶渐近形式。对于此各向同性源，请在频域中识别并论证哪些项构成了远场贡献和近场贡献，并用无量纲参数 $k_{p} r$ 表示近场贡献与远场贡献的幅值比，其中 $k_{p} = \\omega / c_{p}$ 是纵波波数。\n\n然后，对于一个代表短偏移距海洋采集的合成地震记录场景，使用参数 $f = 5\\,\\text{Hz}$ (因此 $\\omega = 2\\pi f$)，$c_{p} = 4.0 \\times 10^{3}\\,\\text{m/s}$ 和 $r = 1.0 \\times 10^{2}\\,\\text{m}$，计算此近场与远场的幅值比。\n\n将最终数值答案四舍五入到四位有效数字。将最终答案表示为一个无量纲数。", "solution": "我们从均匀、各向同性、弹性介质的Navier弹性动力学方程开始，该方程将位移矢量 $\\mathbf{u}(\\mathbf{x}, t)$ 与体力密度 $\\mathbf{f}(\\mathbf{x}, t)$ 联系起来：\n$$ (\\lambda + 2\\mu) \\nabla(\\nabla \\cdot \\mathbf{u}) - \\mu \\nabla \\times (\\nabla \\times \\mathbf{u}) + \\mathbf{f} = \\rho \\frac{\\partial^2 \\mathbf{u}}{\\partial t^2} $$\n其中 $\\rho$ 是密度，$\\lambda$ 和 $\\mu$ 是Lamé参数。\n\n给定时间谐波依赖关系 $\\exp(-\\mathrm{i}\\omega t)$，我们可以将场在频域中写为 $\\mathbf{u}(\\mathbf{x}, t) = \\mathbf{u}(\\mathbf{x}, \\omega) \\exp(-\\mathrm{i}\\omega t)$ 和 $\\mathbf{f}(\\mathbf{x}, t) = \\mathbf{f}(\\mathbf{x}, \\omega) \\exp(-\\mathrm{i}\\omega t)$。时间导数项变为 $\\frac{\\partial^2 \\mathbf{u}}{\\partial t^2} = (-\\mathrm{i}\\omega)^2 \\mathbf{u} = -\\omega^2 \\mathbf{u}$。将此代入运动方程，得到不含时的Navier方程，即位移矢量的Helmholtz方程：\n$$ (\\lambda + 2\\mu) \\nabla(\\nabla \\cdot \\mathbf{u}) - \\mu \\nabla \\times (\\nabla \\times \\mathbf{u}) + \\mathbf{f} + \\rho \\omega^2 \\mathbf{u} = \\mathbf{0} $$\n\n我们采用Helmholtz分解，将位移场 $\\mathbf{u}$ 表示为一个标量势 $\\phi$（压缩分量）和一个矢量势 $\\boldsymbol{\\psi}$（剪切分量）的形式：\n$$ \\mathbf{u} = \\nabla\\phi + \\nabla \\times \\boldsymbol{\\psi} $$\n将此分解代入频域Navier方程，并使用矢量恒等式 $\\nabla \\times (\\nabla \\times \\mathbf{A}) = \\nabla(\\nabla \\cdot \\mathbf{A}) - \\nabla^2 \\mathbf{A}$，我们可以将方程分为两部分。经过一些矢量微积分运算，我们得到：\n$$ \\nabla \\left[ (\\lambda + 2\\mu)(\\nabla^2 \\phi) + \\rho \\omega^2 \\phi \\right] + \\nabla \\times \\left[ \\mu(\\nabla^2 \\boldsymbol{\\psi}) + \\rho \\omega^2 \\boldsymbol{\\psi} \\right] + \\mathbf{f} = \\mathbf{0} $$\n引入纵波波速 $c_p = \\sqrt{(\\lambda + 2\\mu)/\\rho}$ 和横波波速 $c_s = \\sqrt{\\mu/\\rho}$，以及它们各自的波数 $k_p = \\omega/c_p$ 和 $k_s = \\omega/c_s$，我们得到：\n$$ \\rho c_p^2 \\nabla(\\nabla^2 \\phi + k_p^2 \\phi) + \\rho c_s^2 \\nabla \\times (\\nabla^2 \\boldsymbol{\\psi} + k_s^2 \\boldsymbol{\\psi}) + \\mathbf{f} = \\mathbf{0} $$\n源是位于原点的各向同性体膨胀。这种源的作用如同一个压缩中心，可以表示为一个体力，该体力是狄拉克δ函数的梯度：\n$$ \\mathbf{f}(\\mathbf{x}, \\omega) = -S(\\omega) \\nabla \\delta(\\mathbf{x}) $$\n其中 $S(\\omega)$ 是源强度谱。对于爆炸（膨胀）源，负号是常规用法。将此力代入方程得到：\n$$ \\nabla \\left[ \\rho c_p^2 (\\nabla^2 \\phi + k_p^2 \\phi) - S(\\omega)\\delta(\\mathbf{x}) \\right] + \\nabla \\times \\left[ \\rho c_s^2 (\\nabla^2 \\boldsymbol{\\psi} + k_s^2 \\boldsymbol{\\psi}) \\right] = \\mathbf{0} $$\n如果两个方括号内的项各自为零，则该方程成立。这得到一对解耦的Helmholtz方程：\n$$ \\nabla^2 \\phi + k_p^2 \\phi = \\frac{S(\\omega)}{\\rho c_p^2} \\delta(\\mathbf{x}) $$\n$$ \\nabla^2 \\boldsymbol{\\psi} + k_s^2 \\boldsymbol{\\psi} = \\mathbf{0} $$\n由于矢量势 $\\boldsymbol{\\psi}$ 的源项为零，并且问题陈述中说明没有S波被激发，因此我们有 $\\boldsymbol{\\psi} = \\mathbf{0}$。位移是纯纵波（压缩）的。\n\n我们求解关于 $\\phi$ 的非齐次Helmholtz方程。三维空间中出射波的解由Helmholtz算子的缩放格林函数给出：\n$$ \\phi(r, \\omega) = - \\frac{S(\\omega)}{4\\pi \\rho c_p^2} \\frac{\\exp(\\mathrm{i} k_p r)}{r} $$\n其中 $r = |\\mathbf{x}|$ 是距原点的距离。为简化记法，我们定义一个新的源常数 $C(\\omega) = -S(\\omega)/(4\\pi\\rho c_p^2)$，从而：\n$$ \\phi(r, \\omega) = C(\\omega) \\frac{\\exp(\\mathrm{i} k_p r)}{r} $$\n位移场通过取标量势的梯度得到：$\\mathbf{u} = \\nabla\\phi$。由于 $\\phi(r)$ 的球对称性，位移矢量是纯径向的，即 $\\mathbf{u} = u_r(r, \\omega) \\hat{\\mathbf{r}}$，其中 $\\hat{\\mathbf{r}}$ 是径向单位矢量。径向位移分量 $u_r$ 是：\n$$ u_r(r, \\omega) = \\frac{\\partial \\phi}{\\partial r} = \\frac{\\partial}{\\partial r} \\left( C(\\omega) \\frac{\\exp(\\mathrm{i} k_p r)}{r} \\right) $$\n使用乘积法则求导：\n$$ u_r(r, \\omega) = C(\\omega) \\left[ \\frac{1}{r} \\frac{d}{dr}(\\exp(\\mathrm{i} k_p r)) + \\exp(\\mathrm{i} k_p r) \\frac{d}{dr}\\left(\\frac{1}{r}\\right) \\right] $$\n$$ u_r(r, \\omega) = C(\\omega) \\left[ \\frac{\\mathrm{i} k_p \\exp(\\mathrm{i} k_p r)}{r} - \\frac{\\exp(\\mathrm{i} k_p r)}{r^2} \\right] $$\n提出公因式后，得到径向位移的完整表达式：\n$$ u_r(r, \\omega) = C(\\omega) \\frac{\\exp(\\mathrm{i} k_p r)}{r^2} (\\mathrm{i} k_p r - 1) $$\n该表达式包含两项，它们具有不同的径向衰减率。我们可以根据它们在 $r \\to \\infty$ 时的渐近行为来识别远场和近场贡献。\n与 $1/r$ 成正比的项是远场项，因为它在远距离处占主导地位：\n$$ u_r^{\\text{far}}(r, \\omega) = C(\\omega) \\frac{\\mathrm{i} k_p}{r} \\exp(\\mathrm{i} k_p r) $$\n与 $1/r^2$ 成正比的项是近场项，因为它衰减得更快，并且仅在靠近源的地方才显著：\n$$ u_r^{\\text{near}}(r, \\omega) = -C(\\omega) \\frac{1}{r^2} \\exp(\\mathrm{i} k_p r) $$\n它们的相对重要性由无量纲参数 $k_p r$ 决定。当 $k_p r \\gg 1$ 时，远场近似有效。\n\n问题要求计算近场与远场贡献的幅值比。它们的幅值分别为：\n$$ |u_r^{\\text{near}}(r, \\omega)| = \\left|-C(\\omega) \\frac{1}{r^2} \\exp(\\mathrm{i} k_p r)\\right| = |C(\\omega)| \\frac{1}{r^2} $$\n$$ |u_r^{\\text{far}}(r, \\omega)| = \\left|C(\\omega) \\frac{\\mathrm{i} k_p}{r} \\exp(\\mathrm{i} k_p r)\\right| = |C(\\omega)| \\frac{k_p}{r} $$\n这些幅值的比值为：\n$$ R = \\frac{|u_r^{\\text{near}}(r, \\omega)|}{|u_r^{\\text{far}}(r, \\omega)|} = \\frac{|C(\\omega)|/r^2}{|C(\\omega)|k_p/r} = \\frac{1}{k_p r} $$\n这巧妙地证明了该比值与无量纲量 $k_p r$ 成反比。\n\n现在我们根据给定参数计算这个比值：\n- 频率 $f = 5\\,\\text{Hz}$\n- P波波速 $c_p = 4.0 \\times 10^3\\,\\text{m/s}$\n- 距离 $r = 1.0 \\times 10^2\\,\\text{m}$\n\n首先，我们计算角频率 $\\omega$：\n$$ \\omega = 2\\pi f = 2\\pi(5\\,\\text{s}^{-1}) = 10\\pi\\,\\text{rad s}^{-1} $$\n接下来，我们计算纵波波数 $k_p$：\n$$ k_p = \\frac{\\omega}{c_p} = \\frac{10\\pi\\,\\text{rad s}^{-1}}{4.0 \\times 10^3\\,\\text{m s}^{-1}} = \\frac{\\pi}{400}\\,\\text{m}^{-1} $$\n然后，我们计算无量纲参数 $k_p r$：\n$$ k_p r = \\left(\\frac{\\pi}{400}\\,\\text{m}^{-1}\\right) (1.0 \\times 10^2\\,\\text{m}) = \\frac{100\\pi}{400} = \\frac{\\pi}{4} $$\n最后，幅值比为：\n$$ R = \\frac{1}{k_p r} = \\frac{1}{\\pi/4} = \\frac{4}{\\pi} $$\n该值的数值为：\n$$ R = \\frac{4}{\\pi} \\approx 1.2732395... $$\n四舍五入到四位有效数字，我们得到 $1.273$。这个结果表明，对于指定的场景，近场项的幅值实际上大于远场项的幅值，这强调了在短偏移距和低频情况下为合成地震记录加入近场项的重要性。", "answer": "$$\\boxed{1.273}$$", "id": "3615929"}]}