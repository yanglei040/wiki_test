{"hands_on_practices": [{"introduction": "为了系统地研究和比较不同的对流情景，我们必须首先将复杂的物理过程提炼为关键的无量纲参数。本练习将指导你从基本控制方程出发，通过无量纲化推导出与底部加热和内部生热相关的瑞利数$Ra$和$Ra_H$。这些参数是衡量对流强度的基本指标，为定量理解地幔动力学提供了坚实的基础。[@problem_id:3609282]", "problem": "考虑一个内半径为 $r_{i}$、外半径为 $r_{o}$ 的三维球壳中不可压缩地幔的 Boussinesq 热对流。黏度具有强烈的温度依赖性，但为了进行无量纲化，我们使用在指定参考状态下定义的参考动力黏度 $\\eta_{0}$。假设除黏度外，材料性质在径向上是均匀和恒定的：密度 $\\rho$、热膨胀系数 $\\alpha$、热导率 $k$、热扩散率 $\\kappa$ 和重力加速度 $g$。为定义控制参数，假设重力 $g$ 和材料性质是恒定的。壳层厚度为 $D=r_{o}-r_{i}$。存在两种热浮力来源：底部和顶部边界之间的底部温差 $\\Delta T_{b}$，以及由单位质量生热率 $H$（单位为 $\\mathrm{W\\,kg^{-1}}$）表征的均匀内部放射性生热，因此单位体积生热率为 $\\dot{q}=\\rho H$（单位为 $\\mathrm{W\\,m^{-3}}$）。\n\n从有量纲的 Boussinesq-Stokes 方程和能量方程出发，利用热扩散时间尺度 $D^{2}/\\kappa$、长度尺度 $D$、速度尺度 $\\kappa/D$ 以及适用于每种强迫的温度尺度，从第一性原理推导在无量纲动量方程中乘以浮力项的无量纲控制参数：\n- 与给定的底部温差 $\\Delta T_{b}$ 相关的经典瑞利数 $Ra$，以及\n- 与均匀的单位体积生热 $\\dot{q}$ 相关的内部加热瑞利数 $Ra_{H}$。\n\n然后，使用以下类地参数值\n- $r_{o}=6.371\\times 10^{6}\\ \\mathrm{m}$，$r_{i}=3.480\\times 10^{6}\\ \\mathrm{m}$，\n- $\\rho=3300\\ \\mathrm{kg\\,m^{-3}}$，$\\alpha=3.0\\times 10^{-5}\\ \\mathrm{K^{-1}}$，$g=9.81\\ \\mathrm{m\\,s^{-2}}$，\n- $\\kappa=1.0\\times 10^{-6}\\ \\mathrm{m^{2}\\,s^{-1}}$，$k=4.0\\ \\mathrm{W\\,m^{-1}\\,K^{-1}}$，\n- $\\eta_{0}=1.0\\times 10^{21}\\ \\mathrm{Pa\\,s}$，\n- $\\Delta T_{b}=2500\\ \\mathrm{K}$，以及 $H=5.0\\times 10^{-12}\\ \\mathrm{W\\,kg^{-1}}$，\n\n计算这两个瑞利数。将两个答案均表示为无量纲量，并四舍五入到四位有效数字。您的最终答案应按 $(Ra,\\ Ra_{H})$ 的顺序，使用为多个数值答案指定的格式，以单行形式报告。", "solution": "首先验证问题，发现其在科学上是合理的、适定的和完整的。因此，我们可以继续进行推导和计算。\n\n无量纲瑞利数的推导始于不可压缩流体 Boussinesq 热对流的控制方程。相关的有量纲方程是 Stokes 方程（慢速、黏性流动的动量守恒）、连续性方程（质量守恒）和热能方程（能量守恒）。\n\n在 Boussinesq 近似下，包含浮力项的 Stokes 方程为：\n$$ \\nabla \\cdot \\boldsymbol{\\tau} - \\nabla P' + \\mathbf{f}_b = \\mathbf{0} $$\n其中 $\\boldsymbol{\\tau}$ 是偏应力张量，对于参考黏度为 $\\eta_0$ 的牛顿流体，$\\boldsymbol{\\tau} = \\eta_0(\\nabla\\mathbf{u} + (\\nabla\\mathbf{u})^T)$。$P'$ 是动压力，$\\mathbf{f}_b$ 是浮力。浮力由 $\\mathbf{f}_b = \\Delta \\rho \\mathbf{g} = -\\rho \\alpha (T-T_{ref}) \\mathbf{g}$ 给出，其中 $\\rho$ 是参考密度，$\\alpha$ 是热膨胀系数，$T$ 是温度，$T_{ref}$ 是参考温度，$\\mathbf{g}$ 是重力加速度矢量。假设重力径向朝内作用（$\\mathbf{g} = -g\\hat{\\mathbf{r}}$），浮力项变为 $\\rho \\alpha (T-T_{ref}) g \\hat{\\mathbf{r}}$。\n\n不可压缩流体的连续性方程为：\n$$ \\nabla \\cdot \\mathbf{u} = 0 $$\n其中 $\\mathbf{u}$ 是速度矢量。\n\n带内部热源的热能方程为：\n$$ \\rho c_p \\left( \\frac{\\partial T}{\\partial t} + (\\mathbf{u} \\cdot \\nabla) T \\right) = k \\nabla^2 T + \\rho H $$\n其中 $c_p$ 是定压比热容，$k$ 是热导率，$H$ 是单位质量生热率。利用关系式 $\\kappa = k / (\\rho c_p)$，该方程可重写为：\n$$ \\frac{\\partial T}{\\partial t} + (\\mathbf{u} \\cdot \\nabla) T = \\kappa \\nabla^2 T + H $$\n\n接下来，我们根据指定的尺度引入无量纲变量（用撇号表示）：\n- 位置：$\\mathbf{r}' = \\mathbf{r} / D$\n- 时间：$t' = t / (D^2/\\kappa)$\n- 速度：$\\mathbf{u}' = \\mathbf{u} / (\\kappa/D)$\n- 温度：$T = T_{ref} + \\Delta T_{scale} \\theta$，其中 $\\Delta T_{scale}$ 是特征温度尺度，$\\theta$ 是无量纲温度。\n- 压力：动压力的自然尺度是黏性应力尺度，因此我们定义 $P' = (\\eta_0 \\kappa / D^2) p'$。\n\n微分算子变换为 $\\nabla = (1/D)\\nabla'$ 和 $\\nabla^2 = (1/D^2)\\nabla'^2$。\n\n我们将这些代入 Stokes 方程（将浮力项代入动量方程）：\n$$ \\nabla \\cdot \\left( \\eta_0 \\frac{\\kappa}{D^2}(\\nabla'\\mathbf{u}' + (\\nabla'\\mathbf{u}')^T) \\right) - \\nabla \\left( \\frac{\\eta_0 \\kappa}{D^2} p' \\right) + \\rho_0 \\alpha g (\\Delta T_{scale} \\theta) \\hat{\\mathbf{r}} = \\mathbf{0} $$\n$$ \\frac{\\eta_0 \\kappa}{D^3} \\nabla' \\cdot (\\nabla'\\mathbf{u}' + (\\nabla'\\mathbf{u}')^T) - \\frac{\\eta_0 \\kappa}{D^3} \\nabla' p' + \\rho_0 \\alpha g \\Delta T_{scale} \\theta \\hat{\\mathbf{r}} = \\mathbf{0} $$\n将整个方程乘以 $D^3 / (\\eta_0 \\kappa)$，得到无量纲动量方程：\n$$ \\nabla' \\cdot (\\nabla'\\mathbf{u}' + (\\nabla'\\mathbf{u}')^T) - \\nabla' p' + \\left( \\frac{\\rho_0 \\alpha g D^3 \\Delta T_{scale}}{\\eta_0 \\kappa} \\right) \\theta \\hat{\\mathbf{r}} = \\mathbf{0} $$\n乘以浮力项的无量纲群是针对所选温度尺度 $\\Delta T_{scale}$ 的广义瑞利数。\n\n现在我们对能量方程进行无量纲化：\n$$ \\frac{\\partial (T_{ref} + \\Delta T_{scale} \\theta)}{\\partial ((D^2/\\kappa)t')} + \\left( \\frac{\\kappa}{D} \\mathbf{u}' \\cdot \\frac{1}{D}\\nabla' \\right) (T_{ref} + \\Delta T_{scale} \\theta) = \\kappa \\frac{1}{D^2}\\nabla'^2 (T_{ref} + \\Delta T_{scale} \\theta) + H $$\n$$ \\frac{\\kappa \\Delta T_{scale}}{D^2} \\frac{\\partial \\theta}{\\partial t'} + \\frac{\\kappa \\Delta T_{scale}}{D^2} (\\mathbf{u}' \\cdot \\nabla' \\theta) = \\frac{\\kappa \\Delta T_{scale}}{D^2} \\nabla'^2 \\theta + H $$\n除以 $\\kappa \\Delta T_{scale} / D^2$ 得到无量纲能量方程：\n$$ \\frac{\\partial \\theta}{\\partial t'} + (\\mathbf{u}' \\cdot \\nabla') \\theta = \\nabla'^2\\theta + \\frac{H D^2}{\\kappa \\Delta T_{scale}} $$\n\n问题要求通过分别考虑每种加热模式来推导两个瑞利数。\n\n情况1：底部加热 ($Ra$)\n对于由给定的底部温差 $\\Delta T_b$ 驱动的对流，我们设置内部加热 $H=0$。温度尺度的自然选择是施加的温差本身：$\\Delta T_{scale} = \\Delta T_b$。将此代入浮力项的无量纲系数中，得到经典瑞利数 $Ra$：\n$$ Ra = \\frac{\\rho \\alpha g \\Delta T_b D^3}{\\eta_0 \\kappa} $$\n\n情况2：内部加热 ($Ra_H$)\n对于仅由均匀内部加热 $H$ 驱动的对流，不存在外部施加的温差（$\\Delta T_b=0$）。温度尺度必须是系统内在的。从无量纲能量方程来看，项 $\\frac{H D^2}{\\kappa \\Delta T_{scale}}$ 代表了内部加热的无量纲强度。为了进行适当的尺度变换，主要驱动项的量级应为1。但是，这在单位上并不平衡，因为 $H$ 的单位是 $\\mathrm{K \\cdot m^2/s^2}$ (即能量/质量)，而 $\\kappa \\Delta T_{scale}$ 的单位是 $\\mathrm{m^2/s \\cdot K}$。正确的推导需要从包含热导率 $k$ 的能量方程出发。\n$$ \\rho c_p \\left(\\frac{\\kappa \\Delta T_{scale}}{D^2} (\\dots)\\right) = k \\frac{\\Delta T_{scale}}{D^2} \\nabla'^2 \\theta + \\rho H $$\n除以一个因子使源项无量纲化，得到：\n$$ \\frac{\\partial \\theta}{\\partial t'} + \\mathbf{u}' \\cdot \\nabla' \\theta = \\nabla'^2 \\theta + \\frac{\\rho H D^2}{k \\Delta T_{scale}} $$\n将此无量纲加热项设为1，定义了内部加热的内在温度尺度 $\\Delta T_H$：\n$$ \\Delta T_H = \\frac{\\rho H D^2}{k} $$\n将这个尺度 $\\Delta T_{scale} = \\Delta T_H$ 代入广义瑞利数表达式，得到内部加热瑞利数 $Ra_H$：\n$$ Ra_H = \\frac{\\rho \\alpha g D^3}{\\eta_0 \\kappa} \\left( \\frac{\\rho H D^2}{k} \\right) = \\frac{\\rho^2 \\alpha g H D^5}{\\eta_0 \\kappa k} $$\n\n现在，我们使用提供的类地参数计算这两个瑞利数：\n- $r_{o} = 6.371 \\times 10^{6}\\ \\mathrm{m}$\n- $r_{i} = 3.480 \\times 10^{6}\\ \\mathrm{m}$\n- $\\rho = 3300\\ \\mathrm{kg\\,m^{-3}}$\n- $\\alpha = 3.0 \\times 10^{-5}\\ \\mathrm{K^{-1}}$\n- $g = 9.81\\ \\mathrm{m\\,s^{-2}}$\n- $\\kappa = 1.0 \\times 10^{-6}\\ \\mathrm{m^{2}\\,s^{-1}}$\n- $k = 4.0\\ \\mathrm{W\\,m^{-1}\\,K^{-1}}$\n- $\\eta_{0} = 1.0 \\times 10^{21}\\ \\mathrm{Pa\\,s}$\n- $\\Delta T_{b} = 2500\\ \\mathrm{K}$\n- $H = 5.0 \\times 10^{-12}\\ \\mathrm{W\\,kg^{-1}}$\n\n首先，计算壳层厚度 $D$：\n$$ D = r_o - r_i = (6.371 - 3.480) \\times 10^{6}\\ \\mathrm{m} = 2.891 \\times 10^{6}\\ \\mathrm{m} $$\n\n计算 $Ra$：\n$$ Ra = \\frac{\\rho \\alpha g \\Delta T_b D^3}{\\eta_0 \\kappa} $$\n$$ Ra = \\frac{(3300) \\cdot (3.0 \\times 10^{-5}) \\cdot (9.81) \\cdot (2500) \\cdot (2.891 \\times 10^{6})^{3}}{(1.0 \\times 10^{21}) \\cdot (1.0 \\times 10^{-6})} $$\n$$ Ra = \\frac{(2427.975) \\cdot (2.41654 \\times 10^{19})}{1.0 \\times 10^{15}} = \\frac{5.86718 \\times 10^{22}}{1.0 \\times 10^{15}} = 5.86718 \\times 10^{7} $$\n四舍五入到四位有效数字，$Ra = 5.867 \\times 10^{7}$。\n\n计算 $Ra_H$：\n$$ Ra_H = \\frac{\\rho^2 \\alpha g H D^5}{\\eta_0 \\kappa k} $$\n$$ Ra_H = \\frac{(3300)^2 \\cdot (3.0 \\times 10^{-5}) \\cdot (9.81) \\cdot (5.0 \\times 10^{-12}) \\cdot (2.891 \\times 10^{6})^{5}}{(1.0 \\times 10^{21}) \\cdot (1.0 \\times 10^{-6}) \\cdot (4.0)} $$\n$$ Ra_H = \\frac{(1.089 \\times 10^{7}) \\cdot (3.0 \\times 10^{-5}) \\cdot (9.81) \\cdot (5.0 \\times 10^{-12}) \\cdot (2.01894 \\times 10^{32})}{4.0 \\times 10^{15}} $$\n$$ Ra_H = \\frac{(1.6033 \\times 10^{-8}) \\cdot (2.01894 \\times 10^{32})}{4.0 \\times 10^{15}} = \\frac{3.2368 \\times 10^{24}}{4.0 \\times 10^{15}} = 8.092 \\times 10^{8} $$\n四舍五入到四位有效数字，$Ra_H = 8.092 \\times 10^{8}$。\n\n计算出的瑞利数为 $(Ra, Ra_H) = (5.867 \\times 10^7, 8.092 \\times 10^8)$。", "answer": "$$\\boxed{\\begin{pmatrix} 5.867 \\times 10^{7}  8.092 \\times 10^{8} \\end{pmatrix}}$$", "id": "3609282"}, {"introduction": "地幔对流的驱动力直接塑造了行星的表面特征，但它如何具体地引发板块构造？本练习通过量级分析，将深部地幔的动力学与岩石圈的力学行为联系起来。你将估算由对流产生的驱动应力，并将其与岩石圈的屈服强度进行比较，从而计算出一个无量纲的“活动性”参数$\\Lambda$，该参数有助于预测行星表面是呈现活动板块（如地球）还是停滞盖层。[@problem_id:3609252]", "problem": "考虑一个三维球壳中的全地幔对流，其内半径固定，外半径对应行星表面。假设流体为不可压缩、无限普朗特数的Boussinesq流体，其粘度依赖于温度。设参考密度为$\\rho_{0}$，热膨胀系数为$\\alpha$，重力加速度为$g$，对流壳层上的总超绝热温降为$\\Delta T$。壳层厚度为$d$。粘度随温度强烈变化，但你可以认为主导阶的对流驱动应力由深度积分的浮力决定。假设岩石圈遵循摩擦-塑性（Byerlee型）准则屈服，其屈服应力$\\sigma_{y}(z)=C_{0}+f\\,\\rho_{\\ell}\\,g\\,z$随深度变化，其中$C_{0}$是内聚力，$f$是有效摩擦系数，$\\rho_{\\ell}$是岩石圈密度，$z$是深度。\n\n从不可压缩流体的Boussinesq近似下的稳态斯托克斯动量平衡方程出发，并使用基于深度积分浮力的量级尺度分析，推导出特征对流应力尺度$\\sigma_{c}$的估计值，然后构建在特征脆-塑性深度$z=z_{b}$处评估的无量纲流动性度量$\\Lambda=\\sigma_{c}/\\sigma_{y}$。你可以假设进入浮力积分的主导几何长度尺度为$d$，并且球面曲率不改变径向应力的主導階尺度关系。\n\n使用以下类地行星参数值：$\\rho_{0}=3300\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$，$\\alpha=2.5\\times 10^{-5}\\,\\mathrm{K}^{-1}$，$\\Delta T=2500\\,\\mathrm{K}$，$g=9.8\\,\\mathrm{m}\\,\\mathrm{s}^{-2}$，$d=2.8\\times 10^{6}\\,\\mathrm{m}$，$C_{0}=2.0\\times 10^{7}\\,\\mathrm{Pa}$，$f=0.60$，$\\rho_{\\ell}=3300\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$，以及$z_{b}=5.0\\times 10^{4}\\,\\mathrm{m}$。计算$\\Lambda$的数值（作为一个纯数），并将你的最终答案四舍五入到三位有效数字。不要在最终答案中包含单位。", "solution": "该问题被评估为有效。它在科学上基于连续介质力学和地球物理学的原理，特别是地幔对流和岩石圈流变学。该问题是适定的，为尺度分析提供了所有必要的参数和明确的目标。其语言是客观的，给定的数据对于一个类地行星是物理上一致且现实的。\n\n任务是推导出特征对流应力尺度$\\sigma_{c}$的估计值，并用它来计算无量纲流动性度量$\\Lambda$，定义为$\\sigma_{c}$与在特征深度$z_{b}$处的岩石圈屈服应力$\\sigma_{y}$之比。\n\n我们从不可压缩、无限普朗特数的Boussinesq流体的动量平衡方程开始，即稳态斯托克斯方程：\n$$ -\\nabla p + \\nabla \\cdot \\boldsymbol{\\tau} + \\mathbf{F}_{b} = \\mathbf{0} $$\n此处，$p$是动态压力，$\\boldsymbol{\\tau}$是偏应力张量，$\\mathbf{F}_{b}$是单位体积的浮力。浮力源于温度引起的密度变化，由下式给出：\n$$ \\mathbf{F}_{b} = \\delta \\rho \\, \\mathbf{g} $$\n在Boussinesq近似中，密度异常$\\delta \\rho$通过热膨胀系数$\\alpha$与温度异常$\\delta T$相关联：$\\delta \\rho = -\\rho_{0} \\alpha \\, \\delta T$，其中$\\rho_{0}$是参考密度。假设重力径向朝内作用，$\\mathbf{g} = -g \\hat{\\mathbf{r}}$，则浮力矢量为$\\mathbf{F}_{b} = (\\rho_{0} \\alpha \\, \\delta T g) \\hat{\\mathbf{r}}$。单位体积浮力的大小为$|\\mathbf{F}_{b}| = \\rho_{0} \\alpha g |\\delta T|$。\n\n问题陈述主导阶的对流驱动应力$\\sigma_{c}$由深度积分的浮力决定。这个量代表作用在单位面积垂直流体柱上的总浮力，因此具有应力的单位。我们可以通过将单位体积的特征浮力在对流壳层厚度$d$上积分来估计其尺度。整个壳层上的特征温度异常$|\\delta T|$是超绝热温降$\\Delta T$。\n$$ \\sigma_{c} \\sim \\int_{0}^{d} (\\rho_{0} \\alpha g \\Delta T) \\, dz $$\n由于在此尺度分析中被积函数是常数，积分结果为：\n$$ \\sigma_{c} = \\rho_{0} \\alpha g \\Delta T d $$\n这个表达式代表了地幔对流的特征驱动应力。\n\n接下来，我们评估岩石圈的屈服应力$\\sigma_{y}$。问题提供了一个随深度变化的摩擦-塑性（Byerlee型）准则：\n$$ \\sigma_{y}(z) = C_{0} + f\\,\\rho_{\\ell}\\,g\\,z $$\n其中$C_{0}$是内聚力，$f$是有效摩擦系数，$\\rho_{\\ell}$是岩石圈密度，$z$是深度。我们需要在特征脆-塑性深度$z=z_{b}$处评估这个屈服应力。\n$$ \\sigma_{y}(z_{b}) = C_{0} + f\\,\\rho_{\\ell}\\,g\\,z_{b} $$\n\n无量綱流动性度量$\\Lambda$是对流驱动应力与岩石圈抵抗强度之比：\n$$ \\Lambda = \\frac{\\sigma_{c}}{\\sigma_{y}(z_{b})} = \\frac{\\rho_{0} \\alpha g \\Delta T d}{C_{0} + f\\,\\rho_{\\ell}\\,g\\,z_{b}} $$\n\n现在我们代入给定的类地行星参数值：\n- $\\rho_{0} = 3300\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$\n- $\\alpha = 2.5 \\times 10^{-5}\\,\\mathrm{K}^{-1}$\n- $g = 9.8\\,\\mathrm{m}\\,\\mathrm{s}^{-2}$\n- $\\Delta T = 2500\\,\\mathrm{K}$\n- $d = 2.8 \\times 10^{6}\\,\\mathrm{m}$\n- $C_{0} = 2.0 \\times 10^{7}\\,\\mathrm{Pa}$\n- $f = 0.60$\n- $\\rho_{\\ell} = 3300\\,\\mathrm{kg}\\,\\mathrm{m}^{-3}$\n- $z_{b} = 5.0 \\times 10^{4}\\,\\mathrm{m}$\n\n首先，我们计算分子$\\sigma_{c}$：\n$$ \\sigma_{c} = (3300) \\times (2.5 \\times 10^{-5}) \\times (9.8) \\times (2500) \\times (2.8 \\times 10^{6}) \\, \\mathrm{Pa} $$\n$$ \\sigma_{c} = 5.6595 \\times 10^{9} \\, \\mathrm{Pa} $$\n\n接着，我们计算分母$\\sigma_{y}(z_{b})$：\n$$ \\sigma_{y}(z_{b}) = (2.0 \\times 10^{7}) + (0.60) \\times (3300) \\times (9.8) \\times (5.0 \\times 10^{4}) \\, \\mathrm{Pa} $$\n第二项（摩擦阻力）是：\n$$ f\\,\\rho_{\\ell}\\,g\\,z_{b} = 9.702 \\times 10^{8} \\, \\mathrm{Pa} $$\n所以，总屈服应力是：\n$$ \\sigma_{y}(z_{b}) = (2.0 \\times 10^{7}) + (9.702 \\times 10^{8}) \\, \\mathrm{Pa} = (0.2 \\times 10^{8}) + (9.702 \\times 10^{8}) \\, \\mathrm{Pa} = 9.902 \\times 10^{8} \\, \\mathrm{Pa} $$\n\n最后，我们计算比值$\\Lambda$：\n$$ \\Lambda = \\frac{5.6595 \\times 10^{9}}{9.902 \\times 10^{8}} = \\frac{56.595 \\times 10^{8}}{9.902 \\times 10^{8}} \\approx 5.7155019... $$\n\n问题要求答案四舍五入到三位有效数字。\n$$ \\Lambda \\approx 5.72 $$\n这个值是一个无量纲的度量，比较了驱动板块构造的力与岩石圈脆性部分抵抗该运动的力。", "answer": "$$\\boxed{5.72}$$", "id": "3609252"}, {"introduction": "精确模拟具有剧烈变化黏度的地幔对流是一个重大的计算挑战，黏度的巨大差异会导致数值求解器难以处理的病态线性系统。本练习提供了一个估算模型，用于量化黏度跳变对代数多重网格（AMG）预条件迭代求解器性能的影响。通过比较标准光滑子与黏度加权光滑子的迭代次数，你将深入理解为何在现代地球动力学模拟中，开发针对性的高效算法是至关重要的。[@problem_id:3609251]", "problem": "考虑在具有可变黏度的三维球壳中的地幔对流的不可压缩斯托克斯流。控制动量平衡方程为 $-\\nabla \\cdot \\left(2 \\eta(\\mathbf{x}) \\mathbf{D}(\\mathbf{u})\\right) + \\nabla p = \\mathbf{f}$，以及不可压缩约束 $\\nabla \\cdot \\mathbf{u} = 0$，其中 $\\eta(\\mathbf{x})$ 是空间变化的黏度，$\\mathbf{u}$ 是速度， $p$ 是压力，$\\mathbf{D}(\\mathbf{u}) = \\frac{1}{2}\\left(\\nabla \\mathbf{u} + \\nabla \\mathbf{u}^{\\top}\\right)$ 是应变率张量，$\\mathbf{f}$ 是体力。在三维球壳的非结构化网格上进行离散化后，与对称正定算子 $-\\nabla \\cdot \\left(2 \\eta(\\mathbf{x}) \\mathbf{D}(\\cdot)\\right)$ 相关的速度块通过采用代数多重网格 (AMG) 预处理的克雷洛夫方法求解。预处理算子记为 $P^{-1}A$，其中 $A$ 是离散速度块，$P$ 是 AMG 预处理器。对于对称正定预处理算子，预处理共轭梯度 (PCG) 方法的收敛性由 $P^{-1}A$ 的有效条件数 $\\kappa_{\\text{eff}}$ 控制。\n\n您必须在非结构化网格上，针对两种光滑子策略（黏度加权光滑子和标准光滑子），估计并比较求解速度块的 AMG 预处理求解器的克雷洛夫迭代次数。该比较必须量化由黏度对比度 $\\Delta \\eta$ 衡量的系数跳跃如何影响估计的迭代次数。\n\n从以下基本基础出发：源于可变系数椭圆问题的离散对称正定算子，根据谱界定义的条件数 $\\kappa$，以及预处理共轭梯度法中每次迭代的最坏情况误差缩减，其由误差能量范数的界 $r(\\kappa) = \\frac{\\sqrt{\\kappa} - 1}{\\sqrt{\\kappa} + 1}$ 给出。利用这些来构建一个迭代次数的预测模型，该模型能捕捉与三维球壳和非结构化网格中的可变黏度相关的主要依赖关系。\n\n实现以下有效条件数估计器：\n1. 将基准 AMG 稳健性常数定义为 $\\kappa^\\star = 8$。\n2. 通过标量 $q \\in [0,1]$ 对网格质量进行建模，其中 $q=1$ 代表优良的、近各向同性的非结构化网格，$q=0$ 代表质量很差的、高度各向异性的非结构化网格。设网格因子为 $F_{\\text{mesh}}(q) = 1 + \\gamma (1 - q)$，其中 $\\gamma = 15$。\n3. 将 AMG 层级因子建模为 $F_{\\text{levels}}(L) = 1 + 0.1 (L - 1)$，以解释非结构化网格上不理想的粗化和插值，其中 $L$ 是 AMG 的层级数。\n4. 将球壳几何因子建模为 $F_{\\text{shell}}(r_{\\text{in}}, r_{\\text{out}}) = 1 + \\delta \\frac{R_m}{H}$，其中 $R_m = \\frac{r_{\\text{in}} + r_{\\text{out}}}{2}$，$H = r_{\\text{out}} - r_{\\text{in}}$，且 $\\delta = 0.05$。半径 $r_{\\text{in}}$ 和 $r_{\\text{out}}$ 必须以米为单位提供。\n5. 针对两种光滑子策略，对由黏度对比度 $\\Delta \\eta$ 引起的系数跳跃因子进行不同建模：\n   - 对于标准光滑子，使用 $F_{\\text{jump,std}}(\\Delta \\eta) = (\\Delta \\eta)^{\\beta}$，其中 $\\beta = \\frac{1}{3}$。\n   - 对于黏度加权光滑子，使用 $F_{\\text{jump,w}}(\\Delta \\eta) = 1 + c \\log_{10}(\\Delta \\eta)$，其中 $c = 0.5$。\n\n结合这些因子以获得有效条件数\n$$\n\\kappa_{\\text{eff,std}} = \\kappa^\\star \\, F_{\\text{mesh}}(q) \\, F_{\\text{levels}}(L) \\, F_{\\text{shell}}(r_{\\text{in}}, r_{\\text{out}}) \\, F_{\\text{jump,std}}(\\Delta \\eta),\n$$\n$$\n\\kappa_{\\text{eff,w}} = \\kappa^\\star \\, F_{\\text{mesh}}(q) \\, F_{\\text{levels}}(L) \\, F_{\\text{shell}}(r_{\\text{in}}, r_{\\text{out}}) \\, F_{\\text{jump,w}}(\\Delta \\eta).\n$$\n\n对于给定的误差范数缩减容差 $\\epsilon$（从单位初始误差开始），通过以下界限估计所需的 PCG 迭代次数 $n$\n$$\nn = \\left\\lceil \\frac{\\ln(\\epsilon)}{\\ln\\left(r(\\kappa_{\\text{eff}})\\right)} \\right\\rceil,\n\\quad\n\\text{其中}\n\\quad\nr(\\kappa_{\\text{eff}}) = \\frac{\\sqrt{\\kappa_{\\text{eff}}} - 1}{\\sqrt{\\kappa_{\\text{eff}}} + 1}.\n$$\n\n在您的方法中解释系数跳跃如何影响光滑子效率，以及为何黏度加权光滑子能减轻在非结构化网格上使用标准光滑子时出现的性能退化。\n\n实现一个程序，该程序对每个测试用例，使用上述估计器计算一对整数 $\\left[n_{\\text{std}}, n_{\\text{w}}\\right]$，分别代表标准光滑子和黏度加权光滑子的迭代次数。输出中不需要物理单位，因为迭代次数是无量纲的。本问题不使用角度。\n\n使用以下测试套件，其涵盖了一般情况、有利的网格质量、带有差网格的严重系数跳跃以及显著的几何薄壳效应。所有半径均以米为单位指定：\n- 测试用例 1：$\\Delta \\eta = 10^{6}$，$q = 0.5$，$L = 5$，$r_{\\text{in}} = 3.48 \\times 10^{6}$，$r_{\\text{out}} = 6.371 \\times 10^{6}$，$\\epsilon = 10^{-6}$。\n- 测试用例 2：$\\Delta \\eta = 10^{3}$，$q = 0.95$，$L = 5$，$r_{\\text{in}} = 3.48 \\times 10^{6}$，$r_{\\text{out}} = 6.371 \\times 10^{6}$，$\\epsilon = 10^{-8}$。\n- 测试用例 3：$\\Delta \\eta = 10^{8}$，$q = 0.1$，$L = 6$，$r_{\\text{in}} = 3.48 \\times 10^{6}$，$r_{\\text{out}} = 6.371 \\times 10^{6}$，$\\epsilon = 10^{-4}$。\n- 测试用例 4：$\\Delta \\eta = 10^{6}$，$q = 0.7$，$L = 4$，$r_{\\text{in}} = 6.0 \\times 10^{6}$，$r_{\\text{out}} = 6.2 \\times 10^{6}$，$\\epsilon = 10^{-6}$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，其中每个条目本身是对应于上述测试用例顺序的、包含两个元素的列表，例如 $\\left[\\left[n_{\\text{std},1},n_{\\text{w},1}\\right],\\left[n_{\\text{std},2},n_{\\text{w},2}\\right],\\ldots\\right]$。", "solution": "该问题是有效的，因为它在科学上基于计算流体力学和数值线性代数，其定义和参数完整，问题适定，并以客观、正式的语言表述。所有得到唯一、可验证解所需的组件都已提供。\n\n该问题要求估计求解斯托克斯流问题速度块所需的预处理共轭梯度 (PCG) 迭代次数，该问题模拟了地幔对流。该系统源于在三维球壳上使用非结构化网格对一个可变系数椭圆偏微分方程进行离散化。分析的核心是比较代数多重网格 (AMG) 预处理器中两种不同光滑子策略的性能：标准光滑子和黏度加权光滑子。\n\n不可压缩斯托克斯流的控制动量方程为\n$$\n-\\nabla \\cdot \\left(2 \\eta(\\mathbf{x}) \\mathbf{D}(\\mathbf{u})\\right) + \\nabla p = \\mathbf{f}\n$$\n并与不可压缩约束 $\\nabla \\cdot \\mathbf{u} = 0$ 相耦合。此处，$\\eta(\\mathbf{x})$ 是空间变化的黏度，在地球地幔内部可以变化多个数量级。速度算子的离散形式（记为 $A$）是一个对称正定矩阵。由于大的黏度对比度 $\\Delta \\eta$ 和网格的特性，$A$ 通常是病态的，因此需要为克雷洛夫求解器 (PCG) 配备如 AMG 这样的强大预处理器。\n\nPCG 的收敛速率由预处理系统 $P^{-1}A$ 的条件数 $\\kappa$ 控制。一个众所周知的界限是，经过 $n$ 次迭代后，误差的能量范数缩减为 $r(\\kappa)^n$，其中收敛因子为 $r(\\kappa) = \\frac{\\sqrt{\\kappa} - 1}{\\sqrt{\\kappa} + 1}$。为从单位初始误差达到期望的误差容差 $\\epsilon$，迭代次数 $n$ 必须满足 $r(\\kappa)^n \\le \\epsilon$。求解 $n$ 可得估计值：\n$$\nn \\ge \\frac{\\ln(\\epsilon)}{\\ln(r(\\kappa))}\n$$\n由于 $n$ 必须是整数，我们取该值的向上取整：\n$$\nn = \\left\\lceil \\frac{\\ln(\\epsilon)}{\\ln\\left(r(\\kappa)\\right)} \\right\\rceil\n$$\n该问题提供了一个现象学模型来估计 AMG 预处理系统的有效条件数 $\\kappa_{\\text{eff}}$。该模型结合了几个影响 AMG 性能的因素：\n$$\n\\kappa_{\\text{eff}} = \\kappa^\\star \\cdot F_{\\text{mesh}} \\cdot F_{\\text{levels}} \\cdot F_{\\text{shell}} \\cdot F_{\\text{jump}}\n$$\n其中 $\\kappa^\\star$ 是反映 AMG 理想稳健性的基准常数，其他因素则解释了由于网格质量、多重网格层级数、几何形状和系数非均匀性导致的性能下降。\n\n对于可变系数问题，AMG 性能的一个关键方面在于光滑子的选择，它是一种迭代方法（如 Gauss-Seidel 或 Jacobi），用于在每个网格层级上减少高频误差分量。黏度 $\\eta(\\mathbf{x})$ 的巨大跳跃导致矩阵 $A$ 的元素出现巨大跳跃。\n- **标准光滑子**：这些光滑子在运行时不考虑矩阵系数的信息。在低黏度和高黏度区域的交界面上，它们的效率会降低。它们无法充分光滑在低黏度区域振荡但在高黏度区域平滑的误差模式，导致光滑化和粗网格校正之间的协同作用失效。这种性能退化通过对黏度对比度 $\\Delta \\eta$ 的幂律依赖关系进行建模：$F_{\\text{jump,std}}(\\Delta \\eta) = (\\Delta \\eta)^{\\beta}$，其中 $\\beta = \\frac{1}{3}$。这表明随着 $\\Delta \\eta$ 的增长，条件数会发生严重的多项式增长。\n- **黏度加权光滑子**：这些方法被设计用于稳健地处理此类问题。它们明确使用矩阵系数的大小（与黏度相关）来缩放光滑化更新。这使得光滑子在系数跳跃处仍能保持有效。由此产生的 AMG 预处理器更为稳健，其性能随 $\\Delta \\eta$ 的增加仅有轻微下降。这通过一个对数依赖关系来捕捉：$F_{\\text{jump,w}}(\\Delta \\eta) = 1 + c \\log_{10}(\\Delta \\eta)$，其中 $c = 0.5$。\n\n计算过程首先为每个测试用例评估公共因子：\n1.  **网格因子**：$F_{\\text{mesh}}(q) = 1 + \\gamma (1 - q)$，其中 $\\gamma = 15$。该因子随着网格质量 $q$ 的下降（趋近于0）而增加。\n2.  **层级因子**：$F_{\\text{levels}}(L) = 1 + 0.1 (L - 1)$。该因子模拟了随着 AMG 层级数 $L$ 增加而出现的轻微性能下降。\n3.  **球壳几何因子**：$F_{\\text{shell}}(r_{\\text{in}}, r_{\\text{out}}) = 1 + \\delta \\frac{R_m}{H}$，其中 $\\delta = 0.05$，平均半径 $R_m = \\frac{r_{\\text{in}} + r_{\\text{out}}}{2}$，厚度 $H = r_{\\text{out}} - r_{\\text{in}}$。该项考虑了几何各向异性，对于薄壳（即大的 $\\frac{R_m}{H}$ 比率），这种效应更为显著。\n\n接下来，我们为每种情况计算两个不同的跳跃因子 $F_{\\text{jump,std}}$ 和 $F_{\\text{jump,w}}$。然后将它们与公共因子和基准值 $\\kappa^\\star = 8$ 结合，以计算 $\\kappa_{\\text{eff,std}}$ 和 $\\kappa_{\\text{eff,w}}$。最后，对于每个有效条件数，我们计算相应的收敛因子 $r(\\kappa_{\\text{eff}})$，并使用迭代次数公式来找到估计的迭代次数 $n_{\\text{std}}$ 和 $n_{\\text{w}}$。\n\n对于提供的每个测试用例，我们将计算迭代次数对 $[n_{\\text{std}}, n_{\\text{w}}]$。结果将定量地证明黏度加权光滑子的优越稳健性，特别是在高黏度对比度、差网格质量或具有挑战性的几何形状等场景中，这通过预测的 $n_{\\text{w}}$ 远低于 $n_{\\text{std}}$ 的迭代次数得到反映。\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and prints the estimated PCG iteration counts for standard and\n    viscosity-weighted AMG smoothers based on the provided model and test cases.\n    \"\"\"\n    \n    # Define constants from the problem statement.\n    KAPPA_STAR = 8.0\n    GAMMA = 15.0\n    DELTA = 0.05\n    BETA = 1.0 / 3.0\n    C = 0.5\n\n    # Define the factor models as functions.\n    def f_mesh(q):\n        \"\"\"Calculates the mesh quality factor.\"\"\"\n        return 1.0 + GAMMA * (1.0 - q)\n\n    def f_levels(L):\n        \"\"\"Calculates the AMG level factor.\"\"\"\n        return 1.0 + 0.1 * (L - 1.0)\n\n    def f_shell(r_in, r_out):\n        \"\"\"Calculates the spherical shell geometric factor.\"\"\"\n        if r_out == r_in:\n            return 1.0 \n        R_m = (r_in + r_out) / 2.0\n        H = r_out - r_in\n        return 1.0 + DELTA * (R_m / H)\n\n    def f_jump_std(delta_eta):\n        \"\"\"Calculates the coefficient-jump factor for standard smoothers.\"\"\"\n        return delta_eta**BETA\n\n    def f_jump_w(delta_eta):\n        \"\"\"Calculates the coefficient-jump factor for viscosity-weighted smoothers.\"\"\"\n        return 1.0 + C * np.log10(delta_eta)\n\n    def calculate_iterations(kappa_eff, epsilon):\n        \"\"\"Estimates the number of PCG iterations required.\"\"\"\n        if kappa_eff == 1.0:\n            return 1\n            \n        sqrt_kappa = np.sqrt(kappa_eff)\n        r = (sqrt_kappa - 1.0) / (sqrt_kappa + 1.0)\n        \n        if r >= 1.0:\n            return np.inf\n\n        num_iter = np.ceil(np.log(epsilon) / np.log(r))\n        return int(num_iter)\n\n    test_cases = [\n        {'delta_eta': 1e6, 'q': 0.5, 'L': 5, 'r_in': 3.48e6, 'r_out': 6.371e6, 'epsilon': 1e-6},\n        {'delta_eta': 1e3, 'q': 0.95, 'L': 5, 'r_in': 3.48e6, 'r_out': 6.371e6, 'epsilon': 1e-8},\n        {'delta_eta': 1e8, 'q': 0.1, 'L': 6, 'r_in': 3.48e6, 'r_out': 6.371e6, 'epsilon': 1e-4},\n        {'delta_eta': 1e6, 'q': 0.7, 'L': 4, 'r_in': 6.0e6, 'r_out': 6.2e6, 'epsilon': 1e-6},\n    ]\n\n    results = []\n    for case in test_cases:\n        delta_eta = case['delta_eta']\n        q = case['q']\n        L = case['L']\n        r_in = case['r_in']\n        r_out = case['r_out']\n        epsilon = case['epsilon']\n\n        factor_mesh = f_mesh(q)\n        factor_levels = f_levels(L)\n        factor_shell = f_shell(r_in, r_out)\n\n        kappa_base = KAPPA_STAR * factor_mesh * factor_levels * factor_shell\n\n        factor_jump_std = f_jump_std(delta_eta)\n        kappa_eff_std = kappa_base * factor_jump_std\n        n_std = calculate_iterations(kappa_eff_std, epsilon)\n        \n        factor_jump_w = f_jump_w(delta_eta)\n        kappa_eff_w = kappa_base * factor_jump_w\n        n_w = calculate_iterations(kappa_eff_w, epsilon)\n\n        results.append([n_std, n_w])\n    \n    # Intentionally left for the execution environment to print.\n    # The required format is a string representation of a list of lists.\n    # e.g., \"[[702,141],[135,67],[1366,142],[832,166]]\"\n\n```", "answer": "$$\\boxed{\\texttt{[[702,141],[135,67],[1366,142],[832,166]]}}$$", "id": "3609251"}]}