{"hands_on_practices": [{"introduction": "地震的孕育过程始于一个在断层面上从小尺度扰动开始扩展的失稳过程。本练习将引导您使用线性稳定性分析这一强大工具来探索这种失稳的初始条件。通过推导并数值验证临界成核尺度 $h^*$ [@problem_id:3587353]，您将把抽象的速率-状态模型参数与一个可观测的物理尺度联系起来，从而揭示断层在何种条件下会变得不稳定并可能孕育出地震。", "problem": "您需要从第一性原理出发，对由速率-状态摩擦控制的空间一维断层进行边界积分公式的线性化，推导线性化系统的特征值谱，获得作为摩擦和弹性参数函数的稳定性边界，并数值验证预测的临界成核半长度。您必须使用的基本依据包括：(i) 傅里叶空间中弹性连续介质内界面的弹性静力学卷积，(ii) 对数形式的速率-状态摩擦定律，以及 (iii) 老化形式的状态演化定律。您的推导必须从这些基本要素开始，并进行到围绕均匀稳态滑动的线性化。然后，您的程序必须实现所推导的线性化动力学，以计算特征值，确定稳定性边界，并数值验证解析预测。所有中间和最终结果都必须是科学且物理上一致的。\n\n从以下基本陈述开始。\n\n- 对于均质弹性介质中平面界面上的反平面滑动，剪切牵引扰动的傅里叶变换满足 $\\Delta \\tau(k) = - K(k) \\, \\Delta u(k)$，其中 $K(k) = \\dfrac{G}{2} \\, |k|$，$G$ 是剪切模量，$k$ 是空间波数。假设一个长度为 $L$ 的周期性域，因此容许的波数为 $k_n = \\dfrac{2 \\pi n}{L}$，其中整数 $n \\ge 1$。\n\n- 摩擦系数为 $\\mu = \\mu_0 + a \\ln \\left( \\dfrac{V}{V_0} \\right) + b \\ln \\left( \\dfrac{\\theta V_0}{D_c} \\right)$，其中 $a$ 和 $b$ 是无量纲的速率-状态参数，$V$ 是滑动速率，$V_0$ 是稳态参考滑动速率，$\\theta$ 是状态，$D_c$ 是特征滑动距离，$\\mu_0$ 是一个常数。剪切牵引为 $\\tau = \\sigma \\, \\mu$，其中 $\\sigma$ 是有效正应力。\n\n- 状态演化（老化）定律为 $\\dfrac{d \\theta}{d t} = 1 - \\dfrac{V \\, \\theta}{D_c}$。\n\n将方程组在 $V = V_0$ 和 $\\theta = D_c / V_0$ 的均匀稳态滑动周围进行线性化。引入一个波数为 $k$ 的单一空间傅里叶模式，并假设小扰动的形式为 $\\Delta u(x,t) = U \\, e^{i k x + s t}$、$\\Delta V(x,t) = s U \\, e^{i k x + s t}$ 和 $\\Delta \\theta(x,t) = \\Theta \\, e^{i k x + s t}$，其中 $s$ 是待确定的时间特征值。忽略惯性效应，并采用准静态力平衡，其中弹性牵引与摩擦牵引在每一瞬间都保持平衡。\n\n您的任务是：\n\n- 推导扰动振幅的线性化代数系统，并从中获得关于 $s$ 的特征方程，该方程是 $K(k)$、$a$、$b$、$D_c$、$\\sigma$ 和 $V_0$ 的函数。从该特征方程中，推导出对于速度弱化摩擦（$b  a$），区分衰减扰动与增长扰动的解析稳定性边界条件。基于此边界，定义基模失去稳定性时的临界波数大小 $|k^*|$，以及用给定参数表示的相应临界成核半长度 $h^*$。\n\n- 实现一个程序，对于给定的参数集，使用您推导的特征方程计算基模 $n = 1$（$k_1 = \\dfrac{2 \\pi}{L}$）的特征值 $s$，并使用稳健的求根方法数值确定域长度 $L^*$，在该长度下最不稳定特征值的实部穿过零。由此，计算临界半长度的数值估计值 $h^*_{\\text{num}} = \\dfrac{L^*}{2}$。\n\n- 通过报告相对误差 $\\left| h^*_{\\text{num}} - h^* \\right| / h^*$ 来比较解析预测 $h^*$ 与数值估计 $h^*_{\\text{num}}$。所有半长度以米为单位报告，相对误差以十进制数（无单位）报告。\n\n测试套件。使用以下三个参数集来测试您的推导和实现。在所有情况下，稳态参考滑动速率取为 $V_0 = 1 \\times 10^{-6} \\, \\mathrm{m/s}$。\n\n- 情况 A（理想情况）：$a = 5 \\times 10^{-3}$，$b = 1 \\times 10^{-2}$，$D_c = 1 \\times 10^{-3} \\, \\mathrm{m}$，$\\sigma = 5 \\times 10^{7} \\, \\mathrm{Pa}$，$G = 3 \\times 10^{10} \\, \\mathrm{Pa}$。\n\n- 情况 B（不同尺度）：$a = 8 \\times 10^{-3}$，$b = 1.2 \\times 10^{-2}$，$D_c = 5 \\times 10^{-4} \\, \\mathrm{m}$，$\\sigma = 1 \\times 10^{8} \\, \\mathrm{Pa}$，$G = 2 \\times 10^{10} \\, \\mathrm{Pa}$。\n\n- 情况 C（接近边界的速度弱化）：$a = 9.5 \\times 10^{-3}$，$b = 1 \\times 10^{-2}$，$D_c = 1 \\times 10^{-3} \\, \\mathrm{m}$，$\\sigma = 5 \\times 10^{7} \\, \\mathrm{Pa}$，$G = 3 \\times 10^{10} \\, \\mathrm{Pa}$。\n\n输出规范。您的程序应生成一行输出，其中包含三个情况的相对误差，格式为方括号括起来的逗号分隔列表。例如，输出必须类似于“[x1,x2,x3]”，其中 $x1$、$x2$ 和 $x3$ 分别是情况 A、B 和 C 的相对误差，以十进制数（而非百分比）表示。程序必须是完全自包含的，且不得读取任何外部输入。\n\n如果出现角度单位，必须使用弧度。所有物理量必须用国际单位制（SI）表示。您内部计算的最终半长度应以 $\\mathrm{m}$ 为单位，最终报告的相对误差是无量纲的。通过使用保证对给定情况收敛的根搜索的区间法来确保数值稳健性，并且如果您选择四舍五入，仅在最终打印输出时进行。测试套件的设计使得对于每种情况，最不稳定的模式都是 $n = 1$ 的基模，且数值和解析的临界半长度都是有限的，并且在典型的计算范围内。", "solution": "该问题要求对遵守弹性静力学和速率-状态摩擦的一维断层进行线性稳定性分析，以推导临界成核半长度，然后进行数值验证。\n\n首先，我们陈述所提供的控制物理定律。\n$1$. 介质的准静态弹性响应将剪切牵引的扰动 $\\Delta \\tau$ 与断层上滑移的扰动 $\\Delta u$ 联系起来。在空间傅里叶域中，这由下式给出：\n$$\\Delta \\tau(k) = -K(k) \\Delta u(k)$$\n其中 $k$ 是空间波数，反平面断层的刚度核 $K(k)$ 为：\n$$K(k) = \\frac{G}{2}|k|$$\n这里，$G$ 是剪切模量。对于长度为 $L$ 的周期性域，容许的波数为 $k_n = \\frac{2\\pi n}{L}$，其中整数 $n \\geq 1$。\n\n$2$. 断层摩擦由对数形式的速率-状态摩擦定律描述，其中摩擦系数 $\\mu$ 取决于滑动速率 $V$ 和状态变量 $\\theta$：\n$$\\mu = \\mu_0 + a \\ln\\left(\\frac{V}{V_0}\\right) + b \\ln\\left(\\frac{\\theta V_0}{D_c}\\right)$$\n剪切牵引为 $\\tau = \\sigma \\mu$，其中 $\\sigma$ 是有效正应力。参数 $a$ 和 $b$ 是无量纲的材料常数，$D_c$ 是特征滑动距离，$V_0$ 是参考速率。\n\n$3$. 状态变量 $\\theta$ 的演化由老化定律控制：\n$$\\frac{d\\theta}{dt} = 1 - \\frac{V\\theta}{D_c}$$\n\n分析通过将这些方程在稳态滑动解周围进行线性化来展开。在稳态下，所有时间导数均为零。对于恒定的滑动速率 $V = V_0$，状态演化定律得出 $\\theta$ 的稳态值，记为 $\\theta_{ss}$：\n$$0 = 1 - \\frac{V_0 \\theta_{ss}}{D_c} \\implies \\theta_{ss} = \\frac{D_c}{V_0}$$\n相应的稳态牵引为 $\\tau_{ss} = \\sigma \\mu_0$。\n\n我们引入小的、随时间变化的扰动：$V = V_0 + \\Delta V$，$\\theta = \\theta_{ss} + \\Delta \\theta$，以及 $\\tau = \\tau_{ss} + \\Delta \\tau$。我们对这些扰动的控制方程进行线性化。\n\n摩擦定律 $\\tau = \\sigma\\mu$ 的线性化得到：\n$$\\Delta \\tau \\approx \\sigma \\left( \\frac{\\partial \\mu}{\\partial V} \\bigg|_{ss} \\Delta V + \\frac{\\partial \\mu}{\\partial \\theta} \\bigg|_{ss} \\Delta \\theta \\right)$$\n在稳态（$V=V_0, \\theta=\\theta_{ss}$）下求值的偏导数为：\n$$\\frac{\\partial \\mu}{\\partial V} = \\frac{a}{V} \\implies \\frac{a}{V_0}$$\n$$\\frac{\\partial \\mu}{\\partial \\theta} = \\frac{b}{\\theta} \\implies \\frac{b}{\\theta_{ss}} = \\frac{b V_0}{D_c}$$\n因此，线性化的摩擦定律为：\n$$\\Delta \\tau = \\sigma \\left( \\frac{a}{V_0} \\Delta V + \\frac{b V_0}{D_c} \\Delta \\theta \\right)$$\n\n状态演化定律的线性化给出：\n$$\\frac{d\\Delta\\theta}{dt} = -\\frac{\\partial}{\\partial V}\\left(\\frac{V\\theta}{D_c}\\right)\\bigg|_{ss} \\Delta V - \\frac{\\partial}{\\partial \\theta}\\left(\\frac{V\\theta}{D_c}\\right)\\bigg|_{ss} \\Delta \\theta = -\\frac{\\theta_{ss}}{D_c}\\Delta V - \\frac{V_0}{D_c}\\Delta\\theta$$\n代入 $\\theta_{ss} = D_c/V_0$，我们得到：\n$$\\frac{d\\Delta\\theta}{dt} = -\\frac{1}{V_0}\\Delta V - \\frac{V_0}{D_c}\\Delta\\theta$$\n\n我们现在通过考虑单一傅里叶-拉普拉斯模式形式的扰动来分析系统的稳定性：\n$$\\Delta u(x,t) = U e^{ikx + st}, \\quad \\Delta V(x,t) = sU e^{ikx + st}, \\quad \\Delta \\theta(x,t) = \\Theta e^{ikx + st}$$\n这里，$s$ 是待确定的复增长率（特征值）。在此基底下，算子 $\\frac{d}{dt}$ 被乘以 $s$ 所取代。线性化的方程组成为关于振幅 $U$ 和 $\\Theta$ 的代数系统：\n\n从摩擦定律，其中 $\\Delta \\tau = T e^{ikx + st}$ 且弹性静力学关系为 $T = -K(k)U$：\n$$-K(k)U = \\sigma \\left( \\frac{a}{V_0} (sU) + \\frac{b V_0}{D_c} \\Theta \\right)$$\n\n从状态演化定律：\n$$s\\Theta = -\\frac{1}{V_0}(sU) - \\frac{V_0}{D_c}\\Theta \\implies \\Theta\\left(s+\\frac{V_0}{D_c}\\right) = -\\frac{sU}{V_0}$$\n解出 $\\Theta$ 关于 $U$ 的表达式：\n$$\\Theta = -\\frac{sU}{V_0(s+V_0/D_c)}$$\n将此 $\\Theta$ 的表达式代入摩擦方程以消去 $\\Theta$：\n$$-K(k)U = \\sigma \\left( \\frac{asU}{V_0} - \\frac{bV_0}{D_c} \\frac{sU}{V_0(s+V_0/D_c)} \\right)$$\n对于非平凡解（$U \\neq 0$），我们可以除以 $U$ 并重新整理各项以找到关于 $s$ 的特征方程：\n$$-K(k) = \\frac{\\sigma s}{V_0} \\left( a - \\frac{bV_0/D_c}{s+V_0/D_c} \\right) = \\frac{\\sigma s}{V_0} \\frac{as + (a-b)V_0/D_c}{s+V_0/D_c}$$\n$$-K(k)V_0(s+V_0/D_c) = \\sigma s(as + (a-b)V_0/D_c)$$\n$$-K(k)V_0s - \\frac{K(k)V_0^2}{D_c} = \\sigma a s^2 + \\sigma(a-b)\\frac{V_0}{D_c}s$$\n这得到了关于 $s$ 的二次特征方程：\n$$(\\sigma a)s^2 + \\left[ \\sigma(a-b)\\frac{V_0}{D_c} + K(k)V_0 \\right]s + K(k)\\frac{V_0^2}{D_c} = 0$$\n这是一个形如 $As^2 + Bs + C = 0$ 的方程，其系数为：\n$$A = \\sigma a$$\n$$B = \\sigma(a-b)\\frac{V_0}{D_c} + K(k)V_0$$\n$$C = K(k)\\frac{V_0^2}{D_c}$$\n该方程的根决定了系统的稳定性。如果不稳定，即扰动增长，则任意根 $s$ 的实部为正。根的实部由 $\\text{Re}(s) = \\frac{-B}{2A}$ 给出。由于 $A = \\sigma a  0$，不稳定性要求 $B  0$。因此，稳定性边界由条件 $B=0$ 定义：\n$$\\sigma(a-b)\\frac{V_0}{D_c} + K(k)V_0 = 0$$\n对于速度弱化摩擦（$b  a$），项 $a-b$ 为负，允许出现不稳定性。在稳定性边界处，刚度 $K(k)$ 达到一个临界值。解出 $K(k)$：\n$$K(k) = -\\sigma(a-b)\\frac{1}{D_c} = \\frac{\\sigma(b-a)}{D_c}$$\n这个临界刚度 $K_c = \\frac{\\sigma(b-a)}{D_c}$ 定义了不稳定性的阈值。任何满足 $K(k)  K_c$ 的模式都是不稳定的。代入 $K(k)$ 的表达式：\n$$\\frac{G|k|}{2} = \\frac{\\sigma(b-a)}{D_c}$$\n这给出了临界波数 $|k^*|$：\n$$|k^*| = \\frac{2\\sigma(b-a)}{G D_c}$$\n对于所有波数 $|k|  |k^*|$，系统都是不稳定的。当域大小 $L$ 增加时，第一个变得不稳定的模式是基模，其波数为 $|k_1| = \\frac{2\\pi}{L}$。当 $|k_1| = |k^*|$ 时，达到临界长度 $L^*$：\n$$\\frac{2\\pi}{L^*} = \\frac{2\\sigma(b-a)}{G D_c} \\implies L^* = \\frac{\\pi G D_c}{\\sigma(b-a)}$$\n临界成核半长度 $h^*$ 是这个临界长度的一半：\n$$h^* = \\frac{L^*}{2} = \\frac{\\pi G D_c}{2\\sigma(b-a)}$$\n这是解析预测。对于数值验证，我们找到方程 $\\text{Re}(s_{\\text{max}}(L))=0$ 的根 $L^*$，这等价于找到 $B(L)=0$ 的根。然后可以将数值估计 $h^*_{\\text{num}} = L^*/2$ 与解析结果 $h^*$ 进行比较。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import optimize\n\ndef solve():\n    \"\"\"\n    Solves for the relative error between analytical and numerical critical\n    nucleation half-lengths for three test cases of fault stability analysis.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # V0 is constant for all cases.\n    V0 = 1.0e-6  # m/s\n\n    test_cases = [\n        # Case A\n        {'name': 'A', 'a': 5e-3, 'b': 1e-2, 'Dc': 1e-3, 'sigma': 5e7, 'G': 3e10, 'V0': V0},\n        # Case B\n        {'name': 'B', 'a': 8e-3, 'b': 1.2e-2, 'Dc': 5e-4, 'sigma': 1e8, 'G': 2e10, 'V0': V0},\n        # Case C\n        {'name': 'C', 'a': 9.5e-3, 'b': 1e-2, 'Dc': 1e-3, 'sigma': 5e7, 'G': 3e10, 'V0': V0}\n    ]\n\n    results = []\n    for params in test_cases:\n        p = params # Use a shorter alias for the parameters dictionary\n\n        # Analytical calculation of the critical nucleation half-length h*\n        # h* = (pi * G * Dc) / (2 * sigma * (b-a))\n        # Condition b  a must hold for a physically meaningful (positive) h*.\n        if p['b'] = p['a']:\n            # This case corresponds to velocity strengthening or neutral behavior,\n            # which is stable for all wavelengths. The critical length is infinite.\n            # This case does not occur in the provided test suite.\n            relative_error = 0.0\n        else:\n            h_star_analytic = (np.pi * p['G'] * p['Dc']) / (2.0 * p['sigma'] * (p['b'] - p['a']))\n\n            # Numerical calculation of the critical nucleation half-length h*_num.\n            # This involves finding the root L* of the function B(L) = 0, where\n            # the real part of the largest eigenvalue is -B/(2A).\n            # B(L) = sigma*(a-b)*V0/Dc + K(k)*V0, with k = 2*pi/L.\n            # The term V0 is a common factor and can be cancelled.\n            # We solve for the root of B(L)/V0 = 0.\n            \n            def B_divided_by_V0(L, p_dict):\n                \"\"\"\n                Represents the B coefficient of the characteristic equation,\n                divided by V0, as a function of domain length L.\n                The root of this function gives the critical length L*.\n                \"\"\"\n                sigma_val = p_dict['sigma']\n                a_val = p_dict['a']\n                b_val = p_dict['b']\n                Dc_val = p_dict['Dc']\n                G_val = p_dict['G']\n                \n                term1 = sigma_val * (a_val - b_val) / Dc_val\n                # Stiffness term K(k) = G*|k|/2 = G*pi/L for the fundamental mode k=2*pi/L.\n                term2 = (G_val * np.pi) / L\n                return term1 + term2\n\n            # Use a robust bracketing root-finding method to find L*.\n            # The bracket [L_min, L_max] must contain the root.\n            # For small L, B_divided_by_V0  0 (stable). For large L, B_divided_by_V0  0 (unstable).\n            # So a bracket like [1e-3, 1e7] is safe for the expected values.\n            L_min, L_max = 1e-3, 1e7 # meters\n            \n            L_star_numeric = optimize.brentq(B_divided_by_V0, L_min, L_max, args=(p,))\n            \n            h_star_numeric = L_star_numeric / 2.0\n            \n            # Calculate the relative error.\n            # The analytical solution is the exact root, so the error should be near\n            # machine precision, limited by the tolerance of the root-finder.\n            if h_star_analytic == 0:\n                relative_error = 0.0 if h_star_numeric == 0 else np.inf\n            else:\n                relative_error = np.abs(h_star_numeric - h_star_analytic) / h_star_analytic\n        \n        results.append(relative_error)\n\n    # Final print statement in the exact required format.\n    # Using high precision to show the error is close to zero.\n    print(f\"[{','.join(f'{err:.15e}' for err in results)}]\")\n\nsolve()\n\n```", "id": "3587353"}, {"introduction": "完整地模拟包含从数年至数秒这样巨大时间尺度跨度的地震周期，对数值计算提出了一个严峻的挑战，即刚度问题 (stiffness)。本练习将带领您超越线性分析，直面完整的非线性动力学问题。通过设计并实现一个隐式-显式 (IMEX) 数值方案 [@problem_id:3587338]，您将学习一种高效且稳定地求解这类刚性方程组的标准方法，这是计算地震学家必备的一项核心技能。", "problem": "给定一个受剪切加载并由速率-状态摩擦控制的断层块的单自由度弹簧-滑块表示。状态变量遵循老化定律，弹性牵引力将滑动速率耦合到应力演化中。您的任务是推导一个稳定的隐式-显式格式，并实现它以对耦合系统进行时间积分，包括在每个时间步中进行稳健的非线性求解。\n\n从以下在计算地球物理学中作为标准的、经过充分检验的模型方程开始：\n\n- 由连接至以恒定速度移动的加载器的线性弹性弹簧引起的剪切牵引力演化：$$\\dot{\\tau}(t) = k\\left(V_{\\mathrm{pl}} - V(t)\\right),$$ 其中 $k$ 是剪切刚度（单位：$\\mathrm{Pa}/\\mathrm{m}$），$V_{\\mathrm{pl}}$ 是恒定的板块速度（单位：$\\mathrm{m}/\\mathrm{s}$），$V(t)$ 是滑动速率（单位：$\\mathrm{m}/\\mathrm{s}$）。\n- 速率-状态摩擦系数（Dieterich-Ruina 形式）：$$\\mu\\left(V,\\theta\\right) = \\mu_0 + a \\ln\\left(\\frac{V}{V_0}\\right) + b \\ln\\left(\\frac{\\theta V_0}{L}\\right),$$ 其中 $\\mu_0$ 是参考摩擦系数，$a$ 和 $b$ 是直接效应和演化效应参数（无量纲），$V_0$ 是参考滑动速率（单位：$\\mathrm{m}/\\mathrm{s}$），$\\theta$ 是状态变量（单位：$\\mathrm{s}$），$L$ 是特征滑动距离（单位：$\\mathrm{m}$）。\n- 状态变量的老化定律：$$\\dot{\\theta}(t) = 1 - \\frac{V(t)\\,\\theta(t)}{L}.$$\n- 关联剪切牵引力、摩擦和辐射阻尼的准动态力平衡：$$\\tau(t) = \\sigma_n\\,\\mu\\left(V(t),\\theta(t)\\right) + \\eta\\,V(t),$$ 其中 $\\sigma_n$ 是有效正应力（单位：$\\mathrm{Pa}$），$\\eta$ 是辐射阻尼系数（单位：$\\mathrm{Pa}\\cdot \\mathrm{s}/\\mathrm{m}$）。\n\n您必须构建一个隐式-显式（IMEX）时间步进格式，其中隐式-显式（IMEX）意味着刚性项被隐式离散化以增强稳定性，而非刚性项被显式离散化以保持效率。基于时间尺度和刚度的考虑，论证哪些项应被隐式处理，哪些应被显式处理。然后，按以下要求实现该格式：\n\n- 在大小为 $\\Delta t$ 的时间增量上使用一阶隐式-显式格式，积分至最终时间 $T$。\n- 在牵引力方程中，相对于 $V$ 隐式处理线性弹性加载贡献；在老化定律中，相对于 $\\theta$ 隐式处理线性衰减项，同时在该步骤的状态更新中使用显式滑动速率。在状态更新中显式使用摩擦对数项，但在新的时间层级上，为求解滑动速率，隐式求解非线性的代数牵引力-摩擦平衡方程。\n- 通过在所有对数中使用一个小的下限值 $V_{\\min}  0$ 进行正则化来强制 $V  0$，以避免奇点。选择足够小的 $V_{\\min}$，以在不污染物理解的同时保持数值稳健性。\n- 在稳态滑动下进行初始化：设置 $\\theta(0) = L/V_{\\mathrm{pl}}$ 和 $V(0)=V_{\\mathrm{pl}}$，并根据力平衡方程一致地计算 $\\tau(0)$。\n- 在每个时间步使用一个稳健的一维非线性求根器来确定满足隐式牵引力-摩擦关系的滑动速率。您的算法必须可靠地为根划定区间，然后求解它。\n- 确保科学真实性和单位一致性，并通过比较特征时间尺度和线性度来解释选择隐式与显式处理的原因。\n\n您的程序应为以下三个测试用例实现时间积分。对于每个用例，生成最终时间 $T$ 时的滑动速率，单位为 $\\mathrm{m}/\\mathrm{s}$，并四舍五入到 $6$ 位有效数字。\n\n测试套件（所有量均采用国际单位制）：\n\n- 用例 1（理想路径）：\n  - $k = 10^8\\,\\mathrm{Pa}/\\mathrm{m}$，\n  - $\\sigma_n = 5\\times 10^7\\,\\mathrm{Pa}$，\n  - $\\eta = 10^7\\,\\mathrm{Pa}\\cdot\\mathrm{s}/\\mathrm{m}$，\n  - $\\mu_0 = 0.6$，\n  - $a = 0.01$，\n  - $b = 0.015$，\n  - $V_0 = 10^{-6}\\,\\mathrm{m}/\\mathrm{s}$，\n  - $L = 10^{-2}\\,\\mathrm{m}$，\n  - $V_{\\mathrm{pl}} = 10^{-9}\\,\\mathrm{m}/\\mathrm{s}$，\n  - $\\Delta t = 1\\,\\mathrm{s}$，\n  - $T = 10^4\\,\\mathrm{s}$，\n  - $V_{\\min} = 10^{-12}\\,\\mathrm{m}/\\mathrm{s}$。\n- 用例 2（刚性弹性和小特征滑动距离）：\n  - $k = 10^9\\,\\mathrm{Pa}/\\mathrm{m}$，\n  - $\\sigma_n = 10^8\\,\\mathrm{Pa}$，\n  - $\\eta = 5\\times 10^7\\,\\mathrm{Pa}\\cdot\\mathrm{s}/\\mathrm{m}$，\n  - $\\mu_0 = 0.6$，\n  - $a = 0.01$，\n  - $b = 0.015$，\n  - $V_0 = 10^{-6}\\,\\mathrm{m}/\\mathrm{s}$，\n  - $L = 10^{-4}\\,\\mathrm{m}$，\n  - $V_{\\mathrm{pl}} = 10^{-9}\\,\\mathrm{m}/\\mathrm{s}$，\n  - $\\Delta t = 0.1\\,\\mathrm{s}$，\n  - $T = 5\\times 10^3\\,\\mathrm{s}$，\n  - $V_{\\min} = 10^{-12}\\,\\mathrm{m}/\\mathrm{s}$。\n- 用例 3（中等刚度下的速度弱化）：\n  - $k = 5\\times 10^8\\,\\mathrm{Pa}/\\mathrm{m}$，\n  - $\\sigma_n = 8\\times 10^7\\,\\mathrm{Pa}$，\n  - $\\eta = 2\\times 10^7\\,\\mathrm{Pa}\\cdot\\mathrm{s}/\\mathrm{m}$，\n  - $\\mu_0 = 0.6$，\n  - $a = 0.005$，\n  - $b = 0.015$，\n  - $V_0 = 10^{-6}\\,\\mathrm{m}/\\mathrm{s}$，\n  - $L = 5\\times 10^{-3}\\,\\mathrm{m}$，\n  - $V_{\\mathrm{pl}} = 10^{-9}\\,\\mathrm{m}/\\mathrm{s}$，\n  - $\\Delta t = 0.5\\,\\mathrm{s}$，\n  - $T = 10^4\\,\\mathrm{s}$，\n  - $V_{\\min} = 10^{-12}\\,\\mathrm{m}/\\mathrm{s}$。\n\n最终输出格式要求：\n\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，例如 $$[r_1,r_2,r_3],$$ 其中 $r_i$ 是上述用例在最终时间 $T$ 时的滑动速率，单位为 $\\mathrm{m}/\\mathrm{s}$，四舍五入到 $6$ 位有效数字，不打印任何额外文本。角度不属于此问题的一部分。不要使用百分号；所有数值答案必须是纯十进制数。您的程序打印的唯一一行必须是指定格式的最终列表。", "solution": "该问题要求为求解由速率-状态摩擦控制的单自由度弹簧-滑块系统的运动方程，构建并实现一个一阶隐式-显式（IMEX）时间步进格式。该解决方案必须有科学依据，解释数值设计选择背后的原理，并且在计算上是稳健的。\n\n该系统由一组耦合的常微分方程（ODE）和一个代数约束描述。设系统在时间 $t$ 的状态由剪切牵引力 $\\tau(t)$、滑动速率 $V(t)$ 和状态变量 $\\theta(t)$ 描述。控制方程如下：\n1.  剪切牵引力演化：$\\dot{\\tau}(t) = k\\left(V_{\\mathrm{pl}} - V(t)\\right)$\n2.  状态变量演化（老化定律）：$\\dot{\\theta}(t) = 1 - \\frac{V(t)\\,\\theta(t)}{L}$\n3.  含速率-状态摩擦的力平衡：$\\tau(t) = \\sigma_n\\left[\\mu_0 + a \\ln\\left(\\frac{V(t)}{V_0}\\right) + b \\ln\\left(\\frac{\\theta(t) V_0}{L}\\right)\\right] + \\eta\\,V(t)$\n\n这些方程表现出刚性，意味着它们涉及在极大不同时间尺度上发生的过程。在震间期，变化是缓慢的（以年为单位），由板块加载速率 $V_{\\mathrm{pl}}$ 驱动。在同震滑动期间，变化可能极其迅速（秒或更短）。对于刚性系统，除非时间步长 $\\Delta t$ 小到不可行（由系统中最快的时间尺度决定），否则显式时间积分格式在数值上是不稳定的。IMEX 格式通过隐式处理刚性项以保证稳定性，同时显式处理非刚性项以提高效率和简化性，从而缓解了这一问题。\n\n我们的策略是在一个时间步长 $\\Delta t$ 上离散化常微分方程，将解从时间 $t_n = n\\Delta t$ 推进到 $t_{n+1} = (n+1)\\Delta t$。在第 $n$ 步的状态表示为 $(\\tau_n, V_n, \\theta_n)$，在第 $n+1$ 步表示为 $(\\tau_{n+1}, V_{n+1}, \\theta_{n+1})$。\n\n**控制方程的离散化**\n\n*   **状态变量演化 ($\\dot{\\theta}$):**\n    $\\theta$ 的演化方程为 $\\dot{\\theta} = 1 - V\\theta/L$。当滑动速率 $V$ 很大时，项 $-V\\theta/L$ 可能是刚性的，因为特征时间尺度 $L/V$ 变得非常小。根据问题的规定，我们隐式处理对 $\\theta$ 的依赖，显式处理对 $V$ 的依赖。这是一种标准的 IMEX 方法，它将 $\\theta$ 的更新与求解 $V_{n+1}$ 的主要非线性问题解耦。对时间导数使用一阶后向差分，并按规定计算右侧的各项，得到：\n    $$ \\frac{\\theta_{n+1} - \\theta_n}{\\Delta t} = 1 - \\frac{V_n \\theta_{n+1}}{L} $$\n    这是一个关于 $\\theta_{n+1}$ 的线性方程，可以通过代数方法求解：\n    $$ \\theta_{n+1} \\left(1 + \\frac{\\Delta t V_n}{L}\\right) = \\theta_n + \\Delta t $$\n    $$ \\theta_{n+1} = \\frac{\\theta_n + \\Delta t}{1 + \\frac{\\Delta t V_n}{L}} $$\n    此更新在计算上是显式的，因为它仅依赖于第 $n$ 步的已知量。对于线性衰减项，它是无条件稳定的，这是隐式处理 $\\theta_{n+1}$ 的一个关键好处。为了在后续的摩擦定律计算中保持数值稳健性，我们通过强制使用一个最小值 $V_{\\min}$ 来正则化滑动速率 $V_n$，因此我们使用 $\\max(V_n, V_{\\min})$ 进行计算。\n\n*   **剪切牵引力演化 ($\\dot{\\tau}$):**\n    牵引力演化由 $\\dot{\\tau} = k(V_{\\mathrm{pl}} - V)$ 给出。项 $-kV$ 代表断层的弹性卸载。对于大的剪切刚度 $k$，此项是高度刚性的。显式处理会施加一个严格的稳定性约束 $\\Delta t  C/k$（其中 $C$ 为某个常数）。为克服此问题，我们按要求隐式处理对 $V$ 的依赖。\n    $$ \\frac{\\tau_{n+1} - \\tau_n}{\\Delta t} = k(V_{\\mathrm{pl}} - V_{n+1}) $$\n    重新整理得到 $\\tau_{n+1}$ 的表达式，该表达式依赖于尚待确定的滑动速率 $V_{n+1}$：\n    $$ \\tau_{n+1} = \\tau_n + \\Delta t \\, k(V_{\\mathrm{pl}} - V_{n+1}) $$\n\n*   **力平衡与 $V_{n+1}$ 的非线性求解:**\n    时间步的核心是在新的时间层级 $t_{n+1}$ 上强制满足代数力平衡方程：\n    $$ \\tau_{n+1} = \\sigma_n\\,\\mu(V_{n+1}, \\theta_{n+1}) + \\eta\\,V_{n+1} $$\n    代入 $\\tau_{n+1}$ 和摩擦系数 $\\mu(V_{n+1}, \\theta_{n+1})$ 的表达式，得到一个关于 $V_{n+1}$ 的单一非线性代数方程：\n    $$ \\tau_n + \\Delta t \\, k(V_{\\mathrm{pl}} - V_{n+1}) = \\sigma_n\\left[\\mu_0 + a \\ln\\left(\\frac{V_{n+1}}{V_0}\\right) + b \\ln\\left(\\frac{\\theta_{n+1} V_0}{L}\\right)\\right] + \\eta\\,V_{n+1} $$\n    在这里，$\\tau_n$ 是上一步的已知量，而 $\\theta_{n+1}$ 是使用我们之前推导的更新规则预先计算的。唯一的未知数是 $V_{n+1}$。我们定义一个残差函数 $R(V)$，其根即为所求的解 $V_{n+1}$。设 $V \\equiv V_{n+1}$：\n    $$ R(V) = \\left(\\tau_n + \\Delta t k V_{\\mathrm{pl}}\\right) - \\left( (\\eta + \\Delta t k)V + \\sigma_n\\mu_0 + \\sigma_n a \\ln\\left(\\frac{V}{V_0}\\right) + \\sigma_n b \\ln\\left(\\frac{\\theta_{n+1} V_0}{L}\\right) \\right) = 0 $$\n    为了便于求根过程，我们可以将依赖于 $V$ 的项重新组合：\n    $$ R(V) = \\sigma_n a \\ln\\left(\\frac{V}{V_0}\\right) + (\\eta + k \\Delta t)V - C = 0 $$\n    其中 $C$ 是该时间步内的常数：\n    $$ C = \\tau_n + k \\Delta t V_{\\mathrm{pl}} - \\sigma_n \\mu_0 - \\sigma_n b \\ln\\left(\\frac{\\theta_{n+1} V_0}{L}\\right) $$\n    函数 $f(V) = \\sigma_n a \\ln(V/V_0) + (\\eta + k \\Delta t)V$ 对于 $V > 0$ 是严格单调的，因为其导数 $f'(V) = \\sigma_n a / V + (\\eta + k \\Delta t)$ 总是正的（假定 $a, \\sigma_n, \\eta, k, \\Delta t > 0$）。这保证了 $V_{n+1}$ 有唯一解，我们可以使用像 Brent 方法这样的标准区间求根器找到它。对数项要求 $V > 0$，这通过使用一个小的正下限值 $V_{\\min}$ 进行正则化来强制实现。\n\n**算法总结**\n\n将解从 $t=0$ 推进到 $T$ 的完整算法如下：\n\n1.  **初始化 ($t=0$):**\n    系统在滑动速率为 $V_{\\mathrm{pl}}$ 的稳态滑动下初始化。\n    a.  设置初始滑动速率 $V(0) = V_{\\mathrm{pl}}$。\n    b.  由 $\\dot{\\theta}=0$ 可得稳态初始状态 $\\theta(0) = L/V_{\\mathrm{pl}}$。\n    c.  根据力平衡计算初始牵引力 $\\tau(0)$：\n        $\\tau(0) = \\sigma_n\\left[\\mu_0 + a \\ln\\left(\\frac{V(0)}{V_0}\\right) + b \\ln\\left(\\frac{\\theta(0) V_0}{L}\\right)\\right] + \\eta V(0)$。\n        代入 $V(0)=V_{\\mathrm{pl}}$ 和 $\\theta(0)=L/V_{\\mathrm{pl}}$：\n        $\\tau(0) = \\sigma_n\\left[\\mu_0 + a \\ln\\left(\\frac{V_{\\mathrm{pl}}}{V_0}\\right) + b \\ln\\left(\\frac{(L/V_{\\mathrm{pl}}) V_0}{L}\\right)\\right] + \\eta V_{\\mathrm{pl}}$\n        $\\tau(0) = \\sigma_n\\left[\\mu_0 + a \\ln\\left(\\frac{V_{\\mathrm{pl}}}{V_0}\\right) + b \\ln\\left(\\frac{V_0}{V_{\\mathrm{pl}}}\\right)\\right] + \\eta V_{\\mathrm{pl}}$\n        $\\tau(0) = \\sigma_n\\left[\\mu_0 + (a-b) \\ln\\left(\\frac{V_{\\mathrm{pl}}}{V_0}\\right)\\right] + \\eta V_{\\mathrm{pl}}$\n    d.  将当前状态 $(\\tau, V, \\theta)$ 设置为 $(\\tau(0), V(0), \\theta(0))$。\n\n2.  **时间步进循环：**\n    对于从 $n=0$ 开始的每个时间步，直到 $t_{n+1} > T$：\n    a.  获取当前状态 $(\\tau_n, V_n, \\theta_n)$。\n    b.  **更新状态变量：** 使用从半隐式离散化推导出的显式更新规则计算 $\\theta_{n+1}$：\n        $$ \\theta_{n+1} = \\frac{\\theta_n + \\Delta t}{1 + \\frac{\\Delta t \\max(V_n, V_{\\min})}{L}} $$\n    c.  **求解滑动速率：** 找到非线性残差方程 $R(V) = 0$ 的根 $V_{n+1}$。\n        i.   为当前步骤构建常数 $C$。\n        ii.  定义残差函数 $R(V) = \\sigma_n a \\ln\\left(\\frac{\\max(V, V_{\\min})}{V_0}\\right) + (\\eta + k \\Delta t)V - C$。\n        iii. 找到一个区间 $[V_a, V_b]$ 使得 $R(V_a) \\cdot R(V_b)  0$。由于当 $V \\to 0^+$ 时 $R(V) \\to -\\infty$，当 $V \\to \\infty$ 时 $R(V) \\to +\\infty$，因此总能找到一个区间。一个实际的选择是从 $[V_{\\min}, 1.0]$ 开始，并在必要时扩大上界。\n        iv. 使用数值求解器（例如 `scipy.optimize.brentq`）在区间内找到 $V_{n+1}$。\n    d.  **更新剪切牵引力：** 使用其后向欧拉更新规则计算 $\\tau_{n+1}$：\n        $$ \\tau_{n+1} = \\tau_n + \\Delta t \\, k(V_{\\mathrm{pl}} - V_{n+1}) $$\n    e.  **推进状态：** 为下一次迭代设置 $(\\tau_n, V_n, \\theta_n) \\leftarrow (\\tau_{n+1}, V_{n+1}, \\theta_{n+1})$。\n\n3.  **最终结果：**\n    循环终止后，最终计算出的滑动速率即为答案。此值四舍五入到 $6$ 位有效数字。\n这种 IMEX 格式稳健地处理了速率-状态摩擦模型中固有的刚性问题，允许使用计算上可行的时间步长，同时保持了这种一阶方法的准确性。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Main solver function that orchestrates the simulation for all test cases.\n    \"\"\"\n\n    test_cases = [\n        # Case 1 (happy path)\n        {\n            \"k\": 1e8, \"sigma_n\": 5e7, \"eta\": 1e7, \"mu0\": 0.6, \"a\": 0.01,\n            \"b\": 0.015, \"V0\": 1e-6, \"L\": 1e-2, \"V_pl\": 1e-9, \"dt\": 1.0,\n            \"T\": 1e4, \"V_min\": 1e-12\n        },\n        # Case 2 (stiff elastic and small characteristic slip distance)\n        {\n            \"k\": 1e9, \"sigma_n\": 1e8, \"eta\": 5e7, \"mu0\": 0.6, \"a\": 0.01,\n            \"b\": 0.015, \"V0\": 1e-6, \"L\": 1e-4, \"V_pl\": 1e-9, \"dt\": 0.1,\n            \"T\": 5e3, \"V_min\": 1e-12\n        },\n        # Case 3 (velocity-weakening with moderate stiffness)\n        {\n            \"k\": 5e8, \"sigma_n\": 8e7, \"eta\": 2e7, \"mu0\": 0.6, \"a\": 0.005,\n            \"b\": 0.015, \"V0\": 1e-6, \"L\": 5e-3, \"V_pl\": 1e-9, \"dt\": 0.5,\n            \"T\": 1e4, \"V_min\": 1e-12\n        },\n    ]\n\n    results = []\n    for params in test_cases:\n        final_v = run_simulation(**params)\n        # Format to 6 significant figures\n        results.append(f\"{final_v:.6g}\")\n\n    print(f\"[{','.join(results)}]\")\n\ndef run_simulation(k, sigma_n, eta, mu0, a, b, V0, L, V_pl, dt, T, V_min):\n    \"\"\"\n    Runs a single simulation for a given set of parameters using an IMEX scheme.\n\n    Args:\n        k (float): Shear stiffness (Pa/m)\n        sigma_n (float): Effective normal stress (Pa)\n        eta (float): Radiation damping coefficient (Pa*s/m)\n        mu0 (float): Reference friction coefficient\n        a (float): Direct effect parameter\n        b (float): Evolution effect parameter\n        V0 (float): Reference slip rate (m/s)\n        L (float): Characteristic slip distance (m)\n        V_pl (float): Constant plate speed (m/s)\n        dt (float): Time step size (s)\n        T (float): Final integration time (s)\n        V_min (float): Regularization floor for slip rate (m/s)\n\n    Returns:\n        float: The final slip rate V(T).\n    \"\"\"\n\n    # 1. Initialization at steady state\n    v_n = V_pl\n    theta_n = L / v_n\n    \n    # Correctly calculate tau_n for a consistent initial state\n    tau_n = sigma_n * (mu0 + (a - b) * np.log(v_n / V0)) + eta * v_n\n\n    # Time-stepping loop\n    current_time = 0.0\n    while current_time  T:\n        \n        # Ensure the final step does not overshoot T\n        time_step = min(dt, T - current_time)\n        if time_step = 0:\n            break\n\n        # 2a. Update state variable theta (explicitly in V, implicitly in theta)\n        v_n_reg = max(v_n, V_min)\n        theta_next = (theta_n + time_step) / (1.0 + time_step * v_n_reg / L)\n\n        # 2b. Set up the nonlinear root-finding problem for V_next\n        \n        # Constant term C in the residual equation\n        # R(V) = (sigma_n*a*log(V/V0) + (eta + k*dt)*V) - C = 0\n        C = (tau_n + k * time_step * V_pl - sigma_n * mu0\n             - sigma_n * b * np.log(theta_next * V0 / L))\n\n        def residual(v):\n            \"\"\"Residual function R(V)=0 to be solved for V_next.\"\"\"\n            # Regularize V inside the logarithm\n            v_reg = max(v, V_min)\n            return (sigma_n * a * np.log(v_reg / V0) +\n                    (eta + k * time_step) * v - C)\n\n        # Find a bracketing interval for the root\n        v_lower = V_min\n        v_upper = 1.0  # An initial guess for the upper bound (high slip rate)\n        \n        # Expand upper bound until root is bracketed\n        # residual(v_lower) is expected to be negative\n        while residual(v_upper)  0:\n            v_upper *= 10.0\n            if v_upper > 1e10: # Safety break for runaway search\n                raise RuntimeError(\"Failed to bracket the root for V.\")\n\n        # Solve for V_next using Brent's method\n        try:\n             v_next = brentq(residual, v_lower, v_upper, xtol=1e-20, rtol=1e-15)\n        except ValueError:\n            # This can happen if the interval is not bracketing, though the logic above should prevent it.\n            raise RuntimeError(f\"Root finding failed. Interval: [{v_lower}, {v_upper}], \"\n                               f\"f(a)={residual(v_lower)}, f(b)={residual(v_upper)}\")\n\n\n        # 2c. Update shear traction tau\n        tau_next = tau_n + time_step * k * (V_pl - v_next)\n\n        # 2d. Advance state for the next iteration\n        v_n = v_next\n        theta_n = theta_next\n        tau_n = tau_next\n\n        current_time += time_step\n\n    return v_n\n\nif __name__ == \"__main__\":\n    solve()\n\n```", "id": "3587338"}]}