{"hands_on_practices": [{"introduction": "走时层析成像的核心是将地下介质的模型参数（例如慢度）与观测数据（地震波走时）通过一个灵敏度矩阵（通常表示为 $G$）联系起来。这个练习将引导你完成一项基础但至关重要的任务：从第一性原理出发，推导并计算射线在模型网格单元内的路径长度。这是将一个地球物理场景精确地转化为可解的线性代数方程的第一步。", "problem": "考虑在一个轴对齐的矩形像素网格上的二维直线射线走时层析成像。单条射线的走时的基本定义是线积分 $T = \\int_{\\mathcal{L}} s(\\mathbf{x}) \\,\\mathrm{d}l$，其中 $s(\\mathbf{x})$ 是慢度场，$\\mathcal{L}$ 是射线路径。在基于像素的分段常数参数化中，层析成像正演模型将走时写为加权和 $T = \\sum_{j} w_{j} s_{j}$，其中 $w_{j}$ 是射线在像素 $j$ 内的路径长度权重，$s_{j}$ 是该像素的恒定慢度。直线射线层析成像的稀疏路径矩阵包含这些权重。\n\n从线积分定义和基本欧几里得几何出发，推导一个精确的解析表达式，用于计算一个被连接源点 $\\mathbf{s} = (x_{s}, y_{s})$ 和接收点 $\\mathbf{r} = (x_{r}, y_{r})$ 的直线段所穿过的、具有 $x$ 边界 $[x_{\\min}, x_{\\max}]$ 和 $y$ 边界 $[y_{\\min}, y_{\\max}]$ 的单一轴对齐矩形像素的路径长度权重 $w_{p,q}$。你可以使用仿射参数来参数化该直线段，并使用区间的标准性质和极值，但不要假设或调用任何预先推导的“射线-盒子相交”快捷公式；相反，应从第一性原理构建该表达式。\n\n然后，将你推导的表达式应用于以下物理上合理且非简并的构型，以计算组装此射线的单行稀疏路径矩阵所需的非零路径长度权重：\n\n- 网格由四个像素组成，覆盖了 $[0,2] \\times [0,2]$ 米的正方形区域，内部边界位于 $x=1$ 米和 $y=1$ 米。因此，对于 $p,q \\in \\{0,1\\}$，像素 $(p,q)$ 的边界为：\n  - $(0,0): x \\in [0,1], y \\in [0,1]$;\n  - $(1,0): x \\in [1,2], y \\in [0,1]$;\n  - $(0,1): x \\in [0,1], y \\in [1,2]$;\n  - $(1,1): x \\in [1,2], y \\in [1,2]$。\n- 射线连接源点 $\\mathbf{s} = (0.2, 0.3)$ 米和接收点 $\\mathbf{r} = (1.8, 1.6)$ 米。位移矢量的两个分量均不为零。\n\n按照射线从 $\\mathbf{s}$ 到 $\\mathbf{r}$ 的路径上穿过像素的顺序，列出所得的非零权重。以米为单位表示你的最终权重。无需四舍五入；提供精确值。", "solution": "为了从第一性原理计算射线在每个像素内的路径长度，我们遵循以下步骤：\n\n### 第1步：参数化射线路径\n\n射线是连接源点 $\\mathbf{s} = (0.2, 0.3)$ 和接收点 $\\mathbf{r} = (1.8, 1.6)$ 的一条直线段。\n位移向量为 $\\Delta\\mathbf{x} = \\mathbf{r} - \\mathbf{s} = (1.8 - 0.2, 1.6 - 0.3) = (1.6, 1.3)$。\n射线的总长度为 $L = \\|\\Delta\\mathbf{x}\\| = \\sqrt{1.6^2 + 1.3^2} = \\sqrt{2.56 + 1.69} = \\sqrt{4.25} = \\frac{\\sqrt{17}}{2}$ 米。\n我们可以将射线上的任意点 $\\mathbf{p}(t)$ 参数化为：\n$$ \\mathbf{p}(t) = \\mathbf{s} + t(\\mathbf{r} - \\mathbf{s}) = (0.2 + 1.6t, 0.3 + 1.3t) $$\n其中参数 $t$ 从 $0$ (源点) 变化到 $1$ (接收点)。\n\n### 第2步：计算射线与网格线的交点\n\n网格的内部边界位于 $x=1$ 和 $y=1$。\n- **与垂直线 $x=1$ 的交点：**\n  我们设置 $x$ 坐标为 1：\n  $0.2 + 1.6t_x = 1 \\implies 1.6t_x = 0.8 \\implies t_x = 0.5$。\n  在 $t=0.5$ 时，射线穿过 $x=1$ 这条线。\n\n- **与水平线 $y=1$ 的交点：**\n  我们设置 $y$ 坐标为 1：\n  $0.3 + 1.3t_y = 1 \\implies 1.3t_y = 0.7 \\implies t_y = \\frac{0.7}{1.3} = \\frac{7}{13}$。\n  在 $t=7/13 \\approx 0.538$ 时，射线穿过 $y=1$ 这条线。\n\n### 第3步：确定穿过的像素序列\n\n我们根据参数 $t$ 的值来确定射线所在的像素：\n1.  **$t=0$**: 射线起点 $\\mathbf{s}=(0.2, 0.3)$，位于像素 $(0,0)$ ($x \\in [0,1], y \\in [0,1]$)。\n2.  由于 $t_x=0.5  t_y=7/13$，射线首先穿过 $x=1$ 的边界。因此，对于 $t \\in [0, 0.5]$，射线位于像素 $(0,0)$ 内。\n3.  在 $t=0.5$ 时，射线进入像素 $(1,0)$ ($x \\in [1,2], y \\in [0,1]$)。\n4.  对于 $t \\in [0.5, 7/13]$，射线位于像素 $(1,0)$ 内。\n5.  在 $t=7/13$ 时，射线穿过 $y=1$ 的边界，进入像素 $(1,1)$ ($x \\in [1,2], y \\in [1,2]$)。\n6.  对于 $t \\in [7/13, 1]$，射线位于像素 $(1,1)$ 内，直到到达终点 $\\mathbf{r}=(1.8, 1.6)$。\n\n所以，射线依次穿过像素 $(0,0)$、$(1,0)$ 和 $(1,1)$。\n\n### 第4步：计算每个像素内的路径长度\n\n每个像素内的路径长度等于该段对应的参数区间长度 $\\Delta t$ 乘以射线的总长度 $L$。\n- **像素 $(0,0)$ 的权重 $w_{(0,0)}$:**\n  参数区间为 $[0, 0.5]$，所以 $\\Delta t_1 = 0.5 - 0 = 0.5 = \\frac{1}{2}$。\n  $w_{(0,0)} = \\Delta t_1 \\times L = \\frac{1}{2} \\times \\frac{\\sqrt{17}}{2} = \\frac{\\sqrt{17}}{4}$ 米。\n\n- **像素 $(1,0)$ 的权重 $w_{(1,0)}$:**\n  参数区间为 $[0.5, 7/13]$，所以 $\\Delta t_2 = \\frac{7}{13} - \\frac{1}{2} = \\frac{14-13}{26} = \\frac{1}{26}$。\n  $w_{(1,0)} = \\Delta t_2 \\times L = \\frac{1}{26} \\times \\frac{\\sqrt{17}}{2} = \\frac{\\sqrt{17}}{52}$ 米。\n\n- **像素 $(1,1)$ 的权重 $w_{(1,1)}$:**\n  参数区间为 $[7/13, 1]$，所以 $\\Delta t_3 = 1 - \\frac{7}{13} = \\frac{6}{13}$。\n  $w_{(1,1)} = \\Delta t_3 \\times L = \\frac{6}{13} \\times \\frac{\\sqrt{17}}{2} = \\frac{3\\sqrt{17}}{13}$ 米。\n\n### 第5步：总结\n\n射线穿过的像素 $(0,1)$ 的权重为零。\n按顺序排列的非零权重为：\n- $w_{(0,0)} = \\frac{\\sqrt{17}}{4}$\n- $w_{(1,0)} = \\frac{\\sqrt{17}}{52}$\n- $w_{(1,1)} = \\frac{3\\sqrt{17}}{13}$\n\n我们可以验证总长度：$\\frac{\\sqrt{17}}{4} + \\frac{\\sqrt{17}}{52} + \\frac{3\\sqrt{17}}{13} = \\sqrt{17} \\left( \\frac{13}{52} + \\frac{1}{52} + \\frac{12}{52} \\right) = \\sqrt{17} \\left( \\frac{26}{52} \\right) = \\frac{\\sqrt{17}}{2}$，这与射线的总长度 $L$ 相符。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{\\sqrt{17}}{4}  \\frac{\\sqrt{17}}{52}  \\frac{3\\sqrt{17}}{13} \\end{pmatrix}}\n$$", "id": "3617788"}, {"introduction": "在掌握了如何计算单个路径权重之后，我们便可以为一个包含多条射线和多个单元的系统构建完整的几何矩阵 $G$。这个练习演示了这一组装过程，并引入了在最小二乘法中至关重要的正规矩阵 $G^T G$。通过分析这个矩阵的性质（例如其行列式），我们可以深入了解观测数据对模型参数的约束能力，判断系统是否能够被唯一求解。", "problem": "考虑一个二维 (2D) 方形域，记为 $D = [0,2] \\times [0,2]$，单位为 $\\mathrm{km}$，该域被划分为四个边长为 $1\\,\\mathrm{km}$ 的相等方形单元。按如下方式用索引 $j \\in \\{1,2,3,4\\}$ 标记这些单元：$C_{1} = [0,1] \\times [0,1]$ (左下)，$C_{2} = [1,2] \\times [0,1]$ (右下)，$C_{3} = [0,1] \\times [1,2]$ (左上)，以及 $C_{4} = [1,2] \\times [1,2]$ (右上)。在走时层析成像的直射线、高频近似中，射线 $i$ 的走时 $t_{i}$ 通过线积分 $t_{i} = \\int_{\\gamma_{i}} s(\\mathbf{x}) \\,\\mathrm{d}s$ 建模，其中 $s(\\mathbf{x})$ 是慢度，$\\gamma_{i}$ 是射线路径。当假定 $s(\\mathbf{x})$ 在各单元上是分段常数，单元 $j$ 的慢度参数 $m_{j}$ 未知时，离散正演模型为 $t_{i} = \\sum_{j=1}^{4} G_{ij} m_{j}$，其中 $G_{ij}$ 等于射线 $i$ 在单元 $j$ 内的路径长度。\n\n观测到三条直射线，每条射线由一个源点和一个接收点位置（单位均为 $\\mathrm{km}$）定义，并假定它们以直线段的形式穿过 $D$：\n\n- 射线 1：源点位于 $(-0.2,\\,0.5)$，接收点位于 $(2.2,\\,0.5)$。\n- 射线 2：源点位于 $(0.5,\\,-0.2)$，接收点位于 $(0.5,\\,2.2)$。\n- 射线 3：源点位于 $(-0.2,\\,1.5)$，接收点位于 $(2.2,\\,1.5)$。\n\n假定射线不弯曲，只有它们在 $D$ 内部的线段对 $G$ 有贡献。利用每条射线与单元边界的几何相交，计算当 $i \\in \\{1,2,3\\}$ 和 $j \\in \\{1,2,3,4\\}$ 时，每条射线穿过每个单元的路径长度作为条目 $G_{ij}$（单位为 $\\mathrm{km}$）。然后显式地构建正规矩阵 $G^{T} G$（单位为 $\\mathrm{km}^{2}$）。最后，计算 $G^{T} G$ 的行列式，并用 $\\mathrm{km}^{8}$ 表示你的最终答案。请提供精确值；无需四舍五入。", "solution": "该问题提法明确，具有科学依据，并包含了进行计算所需的所有信息。任务是根据所提供的 $2\\mathrm{D}$ 层析成像设置，计算几何矩阵 $G$、正规矩阵 $G^T G$ 及其行列式。\n\n该域是一个方形区域 $D = [0,2] \\times [0,2]$，单位为 $\\mathrm{km}$。它被划分为四个边长为 $1\\,\\mathrm{km}$ 的相等方形单元：\n-   $C_{1} = [0,1] \\times [0,1]$ (左下)\n-   $C_{2} = [1,2] \\times [0,1]$ (右下)\n-   $C_{3} = [0,1] \\times [1,2]$ (左上)\n-   $C_{4} = [1,2] \\times [1,2]$ (右上)\n\n矩阵元素 $G_{ij}$ 表示射线 $i$ 在单元 $j$ 内的路径长度。我们计算这三条给定射线的这些长度。$G_{ij}$ 的单位将是 $\\mathrm{km}$。\n\n射线 1：源点位于 $(-0.2, 0.5)$，接收点位于 $(2.2, 0.5)$。\n这条射线是一条由方程 $y=0.5$ 描述的水平直线段。我们考虑它与域 $D$ 的交集，即 $x \\in [0,2]$ 的线段。\n-   与 $C_{1}$ 的交集：位于 $y=0.5$ 的射线在 $C_{1}$ 的 y 轴范围 $[0,1]$ 内。它从 $x=0$ 到 $x=1$ 穿过该单元。路径长度为 $G_{11} = 1-0 = 1$。\n-   与 $C_{2}$ 的交集：位于 $y=0.5$ 的射线在 $C_{2}$ 的 y 轴范围 $[0,1]$ 内。它从 $x=1$ 到 $x=2$ 穿过该单元。路径长度为 $G_{12} = 2-1 = 1$。\n-   与 $C_{3}$ 和 $C_{4}$ 的交集：位于 $y=0.5$ 的射线在这些单元的 y 轴范围 $[1,2]$ 之外。因此，路径长度为 $G_{13} = 0$ 和 $G_{14} = 0$。\n矩阵 $G$ 的第一行是 $[1, 1, 0, 0]$。\n\n射线 2：源点位于 $(0.5, -0.2)$，接收点位于 $(0.5, 2.2)$。\n这条射线是一条由方程 $x=0.5$ 描述的垂直直线段。我们考虑它与域 $D$ 的交集，即 $y \\in [0,2]$ 的线段。\n-   与 $C_{1}$ 的交集：位于 $x=0.5$ 的射线在 $C_{1}$ 的 x 轴范围 $[0,1]$ 内。它从 $y=0$ 到 $y=1$ 穿过该单元。路径长度为 $G_{21} = 1-0 = 1$。\n-   与 $C_{3}$ 的交集：位于 $x=0.5$ 的射线在 $C_{3}$ 的 x 轴范围 $[0,1]$ 内。它从 $y=1$ 到 $y=2$ 穿过该单元。路径长度为 $G_{23} = 2-1 = 1$。\n-   与 $C_{2}$ 和 $C_{4}$ 的交集：位于 $x=0.5$ 的射线在这些单元的 x 轴范围 $[1,2]$ 之外。因此，路径长度为 $G_{22} = 0$ 和 $G_{24} = 0$。\n矩阵 $G$ 的第二行是 $[1, 0, 1, 0]$。\n\n射线 3：源点位于 $(-0.2, 1.5)$，接收点位于 $(2.2, 1.5)$。\n这条射线是一条由方程 $y=1.5$ 描述的水平直线段。我们考虑它与域 $D$ 的交集，即 $x \\in [0,2]$ 的线段。\n-   与 $C_{3}$ 的交集：位于 $y=1.5$ 的射线在 $C_{3}$ 的 y 轴范围 $[1,2]$ 内。它从 $x=0$ 到 $x=1$ 穿过该单元。路径长度为 $G_{33} = 1-0 = 1$。\n-   与 $C_{4}$ 的交集：位于 $y=1.5$ 的射线在 $C_{4}$ 的 y 轴范围 $[1,2]$ 内。它从 $x=1$ 到 $x=2$ 穿过该单元。路径长度为 $G_{34} = 2-1 = 1$。\n-   与 $C_{1}$ 和 $C_{2}$ 的交集：位于 $y=1.5$ 的射线在这些单元的 y 轴范围 $[0,1]$ 之外。因此，路径长度为 $G_{31} = 0$ 和 $G_{32} = 0$。\n矩阵 $G$ 的第三行是 $[0, 0, 1, 1]$。\n\n综合这些结果，几何矩阵 $G$ 是一个 $3 \\times 4$ 矩阵，其条目单位为 $\\mathrm{km}$：\n$$\nG = \\begin{pmatrix}\n1   1   0   0 \\\\\n1   0   1   0 \\\\\n0   0   1   1\n\\end{pmatrix}\n$$\n接下来，我们计算正规矩阵 $N = G^{T} G$。首先，G 的转置是：\n$$\nG^{T} = \\begin{pmatrix}\n1   1   0 \\\\\n1   0   0 \\\\\n0   1   1 \\\\\n0   0   1\n\\end{pmatrix}\n$$\n现在，我们进行矩阵乘法 $N = G^{T} G$：\n$$\nN = \\begin{pmatrix}\n1   1   0 \\\\\n1   0   0 \\\\\n0   1   1 \\\\\n0   0   1\n\\end{pmatrix}\n\\begin{pmatrix}\n1   1   0   0 \\\\\n1   0   1   0 \\\\\n0   0   1   1\n\\end{pmatrix}\n= \\begin{pmatrix}\n(1)(1)+(1)(1)+(0)(0)  (1)(1)+(1)(0)+(0)(0)  (1)(0)+(1)(1)+(0)(1)  (1)(0)+(1)(0)+(0)(1) \\\\\n(1)(1)+(0)(1)+(0)(0)  (1)(1)+(0)(0)+(0)(0)  (1)(0)+(0)(1)+(0)(1)  (1)(0)+(0)(0)+(0)(1) \\\\\n(0)(1)+(1)(1)+(1)(0)  (0)(1)+(1)(0)+(1)(0)  (0)(0)+(1)(1)+(1)(1)  (0)(0)+(1)(0)+(1)(1) \\\\\n(0)(1)+(0)(1)+(1)(0)  (0)(1)+(0)(0)+(1)(0)  (0)(0)+(0)(1)+(1)(1)  (0)(0)+(0)(0)+(1)(1)\n\\end{pmatrix}\n$$\n$$\nN = G^{T} G = \\begin{pmatrix}\n2   1   1   0 \\\\\n1   1   0   0 \\\\\n1   0   2   1 \\\\\n0   0   1   1\n\\end{pmatrix}\n$$\n该矩阵的条目单位为 $\\mathrm{km}^{2}$。\n\n最后，我们计算 $4 \\times 4$ 矩阵 $N = G^{T} G$ 的行列式。我们可以沿第四行进行代数余子式展开，因为它包含两个零元素。行列式由 $\\det(N) = \\sum_{j=1}^{4} (-1)^{4+j} N_{4j} M_{4j}$ 给出，其中 $M_{4j}$ 是对应于元素 $N_{4j}$ 的余子式。\n$$\n\\det(N) = 0 \\cdot C_{41} + 0 \\cdot C_{42} + N_{43} C_{43} + N_{44} C_{44}\n$$\n其中 $C_{ij}$ 是代数余子式。\n相关的代数余子式是 $C_{43}$ 和 $C_{44}$：\n$$\nC_{43} = (-1)^{4+3} \\det \\begin{pmatrix}\n2   1   0 \\\\\n1   1   0 \\\\\n1   0   1\n\\end{pmatrix} = (-1) \\left[ 0 - 0 + 1 \\cdot \\det \\begin{pmatrix} 2   1 \\\\ 1   1 \\end{pmatrix} \\right] = (-1)[(2)(1) - (1)(1)] = -1\n$$\n$$\nC_{44} = (-1)^{4+4} \\det \\begin{pmatrix}\n2   1   1 \\\\\n1   1   0 \\\\\n1   0   2\n\\end{pmatrix} = (+1) \\left[ 1 \\cdot \\det \\begin{pmatrix} 1   1 \\\\ 1   0 \\end{pmatrix} - 0 + 2 \\cdot \\det \\begin{pmatrix} 2   1 \\\\ 1   1 \\end{pmatrix} \\right] = [(1)(0)-(1)(1)] + 2[(2)(1)-(1)(1)] = -1 + 2(1) = 1\n$$\n将这些值代回行列式表达式中：\n$$\n\\det(N) = (1)(C_{43}) + (1)(C_{44}) = (1)(-1) + (1)(1) = -1 + 1 = 0\n$$\n另一种方法是使用行化简。\n$$\n\\det \\begin{pmatrix}\n2   1   1   0 \\\\\n1   1   0   0 \\\\\n1   0   2   1 \\\\\n0   0   1   1\n\\end{pmatrix}\n\\xrightarrow{R_1 \\leftrightarrow R_2}\n-\\det \\begin{pmatrix}\n1   1   0   0 \\\\\n2   1   1   0 \\\\\n1   0   2   1 \\\\\n0   0   1   1\n\\end{pmatrix}\n\\xrightarrow[R_3 \\to R_3-R_1]{R_2 \\to R_2-2R_1}\n-\\det \\begin{pmatrix}\n1   1   0   0 \\\\\n0   -1   1   0 \\\\\n0   -1   2   1 \\\\\n0   0   1   1\n\\end{pmatrix}\n\\xrightarrow{R_3 \\to R_3-R_2}\n-\\det \\begin{pmatrix}\n1   1   0   0 \\\\\n0   -1   1   0 \\\\\n0   0   1   1 \\\\\n0   0   1   1\n\\end{pmatrix}\n$$\n由于有两行相同（第 3 行和第 4 行），行列式为 0。\n$G^{T} G$ 的行列式为 0。行列式的单位是 $(\\mathrm{km}^{2})^{4} = \\mathrm{km}^{8}$。\n值为 $0 \\, \\mathrm{km}^{8}$。", "answer": "$$\\boxed{0}$$", "id": "3617796"}, {"introduction": "许多地球物理反演问题，包括走时层析成像，本质上是病态的（ill-posed），这意味着一个微小的数据扰动可能导致解的巨大变化。这个练习介绍了一种强大的稳定化技术——吉洪诺夫正则化（Tikhonov regularization）。你将亲手推导正则化解，并量化分析正则化中一个核心的权衡关系：模型分辨率（我们解析地下结构细节的能力）与模型方差（解对数据噪声的敏感性）之间的博弈。", "problem": "在走时层析成像中，沿射线的走时一阶扰动由慢度扰动的线积分给出，在对单元进行离散化后，这成为一个线性关系 $\\mathbf{d} \\approx \\mathbf{G}\\,\\mathbf{m}$，其中 $\\mathbf{d}$ 是无量纲走时残差，$\\mathbf{m}$ 是无量纲慢度扰动，$\\mathbf{G}$ 是无量纲路径长度雅可比矩阵。考虑一个包含两条直线射线的双单元模型，使得\n$$\n\\mathbf{G} = \\begin{pmatrix} 3   2 \\\\ 1   4 \\end{pmatrix}, \\quad \\mathbf{d} = \\begin{pmatrix} 5 \\\\ 9 \\end{pmatrix}.\n$$\n假设数据已被白化，因此数据噪声协方差为单位矩阵，并且对模型范数应用 Tikhonov 阻尼。从第一性原理出发，推导作为目标函数 $J(\\mathbf{m}) = \\|\\mathbf{G}\\mathbf{m} - \\mathbf{d}\\|_{2}^{2} + \\lambda^{2} \\|\\mathbf{m}\\|_{2}^{2}$ 最小化子的 Tikhonov 正则化最小二乘估计量 $\\widehat{\\mathbf{m}}(\\lambda)$，其中 $\\lambda$ 是一个无量纲阻尼参数。计算当 $\\lambda = 0$、$\\lambda = 1$ 和 $\\lambda = 3$ 时的 $\\widehat{\\mathbf{m}}(\\lambda)$ 的具体值。\n\n定义并推导在数据协方差为单位矩阵的假设下的模型分辨率矩阵 $\\mathbf{R}(\\lambda)$ 和后验模型协方差 $\\mathbf{C}_{m}(\\lambda)$，并用 $\\lambda$ 解析地表示它们。使用这些表达式，对作为 $\\lambda$ 函数的分辨率和方差进行解析比较。\n\n最后，确定阻尼参数 $\\lambda$ 的值，使得分辨率矩阵的迹满足 $\\mathrm{tr}(\\mathbf{R}(\\lambda)) = 1.5$。将你的答案四舍五入到四位有效数字。用无量纲单位表示 $\\lambda$ 的最终值。", "solution": "该问题是有效的，因为它科学地基于地球物理反演理论的原理，特别是 Tikhonov 正则化。它是适定的，提供了所有必要的数据，并且没有矛盾或含糊之处。\n\n首先，我们通过最小化目标函数 $J(\\mathbf{m})$ 来推导 Tikhonov 正则化最小二乘估计量 $\\widehat{\\mathbf{m}}(\\lambda)$。目标函数如下：\n$$J(\\mathbf{m}) = \\|\\mathbf{G}\\mathbf{m} - \\mathbf{d}\\|_{2}^{2} + \\lambda^{2} \\|\\mathbf{m}\\|_{2}^{2}$$\n用矩阵表示法，这是：\n$$J(\\mathbf{m}) = (\\mathbf{G}\\mathbf{m} - \\mathbf{d})^T (\\mathbf{G}\\mathbf{m} - \\mathbf{d}) + \\lambda^{2} \\mathbf{m}^T \\mathbf{m}$$\n展开表达式：\n$$J(\\mathbf{m}) = \\mathbf{m}^T \\mathbf{G}^T \\mathbf{G}\\mathbf{m} - \\mathbf{m}^T \\mathbf{G}^T \\mathbf{d} - \\mathbf{d}^T \\mathbf{G}\\mathbf{m} + \\mathbf{d}^T \\mathbf{d} + \\lambda^{2} \\mathbf{m}^T \\mathbf{m}$$\n由于标量项 $\\mathbf{d}^T \\mathbf{G}\\mathbf{m}$ 等于其转置 $\\mathbf{m}^T \\mathbf{G}^T \\mathbf{d}$，我们可以合并这些项：\n$$J(\\mathbf{m}) = \\mathbf{m}^T (\\mathbf{G}^T \\mathbf{G} + \\lambda^2 \\mathbf{I}) \\mathbf{m} - 2 \\mathbf{m}^T \\mathbf{G}^T \\mathbf{d} + \\mathbf{d}^T \\mathbf{d}$$\n为了找到最小化 $J(\\mathbf{m})$ 的模型向量 $\\mathbf{m}$，我们计算 $J$ 关于 $\\mathbf{m}$ 的梯度，并将其设为零向量。\n$$\\nabla_{\\mathbf{m}} J(\\mathbf{m}) = 2(\\mathbf{G}^T \\mathbf{G} + \\lambda^2 \\mathbf{I})\\mathbf{m} - 2\\mathbf{G}^T \\mathbf{d}$$\n将梯度设为零，得到估计量 $\\widehat{\\mathbf{m}}$ 的正规方程：\n$$2(\\mathbf{G}^T \\mathbf{G} + \\lambda^2 \\mathbf{I})\\widehat{\\mathbf{m}} - 2\\mathbf{G}^T \\mathbf{d} = 0$$\n$$(\\mathbf{G}^T \\mathbf{G} + \\lambda^2 \\mathbf{I})\\widehat{\\mathbf{m}} = \\mathbf{G}^T \\mathbf{d}$$\n求解 $\\widehat{\\mathbf{m}}$ 得到 Tikhonov 正则化估计量：\n$$\\widehat{\\mathbf{m}}(\\lambda) = (\\mathbf{G}^T \\mathbf{G} + \\lambda^2 \\mathbf{I})^{-1} \\mathbf{G}^T \\mathbf{d}$$\n接下来，我们针对给定的矩阵和特定的 $\\lambda$ 值来评估此估计量。给定的矩阵是：\n$$\\mathbf{G} = \\begin{pmatrix} 3   2 \\\\ 1   4 \\end{pmatrix}, \\quad \\mathbf{d} = \\begin{pmatrix} 5 \\\\ 9 \\end{pmatrix}$$\n我们计算所需的矩阵乘积：\n$$\\mathbf{G}^T = \\begin{pmatrix} 3   1 \\\\ 2   4 \\end{pmatrix}$$\n$$\\mathbf{G}^T \\mathbf{G} = \\begin{pmatrix} 3   1 \\\\ 2   4 \\end{pmatrix} \\begin{pmatrix} 3   2 \\\\ 1   4 \\end{pmatrix} = \\begin{pmatrix} 10   10 \\\\ 10   20 \\end{pmatrix}$$\n$$\\mathbf{G}^T \\mathbf{d} = \\begin{pmatrix} 3   1 \\\\ 2   4 \\end{pmatrix} \\begin{pmatrix} 5 \\\\ 9 \\end{pmatrix} = \\begin{pmatrix} 24 \\\\ 46 \\end{pmatrix}$$\n项 $(\\mathbf{G}^T \\mathbf{G} + \\lambda^2 \\mathbf{I})$ 为：\n$$\\mathbf{G}^T \\mathbf{G} + \\lambda^2 \\mathbf{I} = \\begin{pmatrix} 10+\\lambda^2   10 \\\\ 10   20+\\lambda^2 \\end{pmatrix}$$\n该矩阵的行列式为 $\\det(\\mathbf{G}^T \\mathbf{G} + \\lambda^2 \\mathbf{I}) = (10+\\lambda^2)(20+\\lambda^2) - 100 = \\lambda^4 + 30\\lambda^2 + 100$。\n逆矩阵是：\n$$(\\mathbf{G}^T \\mathbf{G} + \\lambda^2 \\mathbf{I})^{-1} = \\frac{1}{\\lambda^4 + 30\\lambda^2 + 100} \\begin{pmatrix} 20+\\lambda^2   -10 \\\\ -10   10+\\lambda^2 \\end{pmatrix}$$\n因此，估计量是：\n$$\\widehat{\\mathbf{m}}(\\lambda) = \\frac{1}{\\lambda^4 + 30\\lambda^2 + 100} \\begin{pmatrix} 20+\\lambda^2   -10 \\\\ -10   10+\\lambda^2 \\end{pmatrix} \\begin{pmatrix} 24 \\\\ 46 \\end{pmatrix} = \\frac{1}{\\lambda^4 + 30\\lambda^2 + 100} \\begin{pmatrix} 20 + 24\\lambda^2 \\\\ 220 + 46\\lambda^2 \\end{pmatrix}$$\n对于 $\\lambda=0$：\n$\\widehat{\\mathbf{m}}(0) = \\frac{1}{100} \\begin{pmatrix} 20 \\\\ 220 \\end{pmatrix} = \\begin{pmatrix} 1/5 \\\\ 11/5 \\end{pmatrix} = \\begin{pmatrix} 0.2 \\\\ 2.2 \\end{pmatrix}$。\n对于 $\\lambda=1$：\n$\\widehat{\\mathbf{m}}(1) = \\frac{1}{1^4 + 30(1)^2 + 100} \\begin{pmatrix} 20 + 24(1)^2 \\\\ 220 + 46(1)^2 \\end{pmatrix} = \\frac{1}{131} \\begin{pmatrix} 44 \\\\ 266 \\end{pmatrix}$。\n对于 $\\lambda=3$：\n$\\widehat{\\mathbf{m}}(3) = \\frac{1}{3^4 + 30(3)^2 + 100} \\begin{pmatrix} 20 + 24(3)^2 \\\\ 220 + 46(3)^2 \\end{pmatrix} = \\frac{1}{81 + 270 + 100} \\begin{pmatrix} 20 + 216 \\\\ 220 + 414 \\end{pmatrix} = \\frac{1}{451} \\begin{pmatrix} 236 \\\\ 634 \\end{pmatrix}$。\n\n模型分辨率矩阵 $\\mathbf{R}(\\lambda)$ 将估计模型与真实模型 $\\mathbf{m}_{\\text{true}}$ 联系起来。数据为 $\\mathbf{d} = \\mathbf{G}\\mathbf{m}_{\\text{true}} + \\mathbf{n}$，其中 $\\mathbf{n}$ 是数据噪声。将此代入估计量方程中得到：\n$$\\widehat{\\mathbf{m}} = (\\mathbf{G}^T \\mathbf{G} + \\lambda^2 \\mathbf{I})^{-1} \\mathbf{G}^T (\\mathbf{G}\\mathbf{m}_{\\text{true}} + \\mathbf{n}) = [(\\mathbf{G}^T \\mathbf{G} + \\lambda^2 \\mathbf{I})^{-1} \\mathbf{G}^T \\mathbf{G}] \\mathbf{m}_{\\text{true}} + \\dots$$\n分辨率矩阵是左乘 $\\mathbf{m}_{\\text{true}}$ 的项：\n$$\\mathbf{R}(\\lambda) = (\\mathbf{G}^T \\mathbf{G} + \\lambda^2 \\mathbf{I})^{-1} \\mathbf{G}^T \\mathbf{G}$$\n后验模型协方差 $\\mathbf{C}_{m}(\\lambda)$ 描述了数据噪声如何传播到模型估计中。假设数据协方差 $\\mathbf{C}_d = \\mathbf{I}$，估计量的协方差为：\n$$\\mathbf{C}_{m}(\\lambda) = \\mathbb{E}[(\\widehat{\\mathbf{m}} - \\mathbb{E}[\\widehat{\\mathbf{m}}])(\\widehat{\\mathbf{m}} - \\mathbb{E}[\\widehat{\\mathbf{m}}])^T] = [(\\mathbf{G}^T \\mathbf{G} + \\lambda^2 \\mathbf{I})^{-1} \\mathbf{G}^T] \\mathbf{C}_d [(\\mathbf{G}^T \\mathbf{G} + \\lambda^2 \\mathbf{I})^{-1} \\mathbf{G}^T]^T$$\n$$\\mathbf{C}_{m}(\\lambda) = (\\mathbf{G}^T \\mathbf{G} + \\lambda^2 \\mathbf{I})^{-1} \\mathbf{G}^T \\mathbf{G} (\\mathbf{G}^T \\mathbf{G} + \\lambda^2 \\mathbf{I})^{-1}$$\n当 $\\lambda \\to 0$ 时，$\\mathbf{R}(\\lambda) \\to \\mathbf{I}$（完美分辨率），而 $\\mathbf{C}_m(\\lambda) \\to (\\mathbf{G}^T\\mathbf{G})^{-1}$（最大方差）。当 $\\lambda \\to \\infty$ 时，$\\mathbf{R}(\\lambda) \\to \\mathbf{0}$（无分辨率），而 $\\mathbf{C}_m(\\lambda) \\to \\mathbf{0}$（零方差）。这展示了经典的权衡关系：增加 $\\lambda$ 会以牺牲分辨率为代价来减小模型方差。\n\n最后，我们确定 $\\lambda$ 的值，使得 $\\mathrm{tr}(\\mathbf{R}(\\lambda)) = 1.5$。首先，我们计算 $\\mathbf{R}(\\lambda)$ 的解析表达式：\n$$\\mathbf{R}(\\lambda) = \\frac{1}{\\lambda^4 + 30\\lambda^2 + 100} \\begin{pmatrix} 20+\\lambda^2   -10 \\\\ -10   10+\\lambda^2 \\end{pmatrix} \\begin{pmatrix} 10   10 \\\\ 10   20 \\end{pmatrix}$$\n$$\\mathbf{R}(\\lambda) = \\frac{1}{\\lambda^4 + 30\\lambda^2 + 100} \\begin{pmatrix} 100 + 10\\lambda^2   10\\lambda^2 \\\\ 10\\lambda^2   100 + 20\\lambda^2 \\end{pmatrix}$$\n迹是主对角线元素的和：\n$$\\mathrm{tr}(\\mathbf{R}(\\lambda)) = \\frac{(100 + 10\\lambda^2) + (100 + 20\\lambda^2)}{\\lambda^4 + 30\\lambda^2 + 100} = \\frac{200 + 30\\lambda^2}{\\lambda^4 + 30\\lambda^2 + 100}$$\n我们将其设为 $1.5$（即 $3/2$）：\n$$\\frac{200 + 30\\lambda^2}{\\lambda^4 + 30\\lambda^2 + 100} = \\frac{3}{2}$$\n$$2(200 + 30\\lambda^2) = 3(\\lambda^4 + 30\\lambda^2 + 100)$$\n$$400 + 60\\lambda^2 = 3\\lambda^4 + 90\\lambda^2 + 300$$\n$$3\\lambda^4 + 30\\lambda^2 - 100 = 0$$\n令 $x = \\lambda^2$。该方程是关于 $x$ 的一元二次方程：$3x^2 + 30x - 100 = 0$。使用二次方程求根公式：\n$$x = \\frac{-30 \\pm \\sqrt{30^2 - 4(3)(-100)}}{2(3)} = \\frac{-30 \\pm \\sqrt{900 + 1200}}{6} = \\frac{-30 \\pm \\sqrt{2100}}{6}$$\n因为 $\\lambda$ 是一个实数参数，$\\lambda^2 = x$ 必须为非负数。我们取正根：\n$$\\lambda^2 = \\frac{-30 + \\sqrt{2100}}{6} = \\frac{-30 + 10\\sqrt{21}}{6} = \\frac{-15 + 5\\sqrt{21}}{3}$$\n$\\lambda$ 的值是这个量的平方根。\n$$\\lambda = \\sqrt{\\frac{-15 + 5\\sqrt{21}}{3}}$$\n数值上，$\\sqrt{21} \\approx 4.582576$。\n$$\\lambda^2 \\approx \\frac{-15 + 5(4.582576)}{3} \\approx \\frac{7.91288}{3} \\approx 2.637626$$\n$$\\lambda \\approx \\sqrt{2.637626} \\approx 1.624077$$\n四舍五入到四位有效数字，我们得到 $\\lambda \\approx 1.624$。根据要求，该值为无量纲。", "answer": "$$\\boxed{1.624}$$", "id": "3617733"}]}