{"hands_on_practices": [{"introduction": "地幔对流的核心在于热浮力与耗散力之间的竞争。本练习将通过线性稳定性分析，带你推导对流开始的临界条件。通过求解理想化的瑞利-贝纳德对流问题[@problem_id:3610794]，你将亲手确定临界瑞利数$Ra_c$与临界波数$k_c$，并深入理解不同边界条件如何影响对流的启动。", "problem": "考虑一个厚度为 $H$ 的水平无限延伸的不可压缩牛顿地幔流体层，其底部受热，顶部冷却，并在 Boussinesq 近似下进行建模。重力 $\\boldsymbol{g}= -g\\,\\hat{\\boldsymbol{z}}$ 方向向下。设密度为 $\\rho$，运动黏度为 $\\nu$，热扩散系数为 $\\kappa$，热膨胀系数为 $\\alpha$，施加在流体层上的温差为 $\\Delta T>0$。使用热扩散时间 $H^{2}/\\kappa$ 对时间进行无量纲化，使用层厚 $H$ 对长度进行无量纲化，使用施加的温差 $\\Delta T$ 对温度进行无量纲化，从而无量纲垂直坐标为 $z\\in[0,1]$，瑞利数为 $Ra = \\dfrac{\\alpha g \\Delta T H^{3}}{\\nu \\kappa}$。\n\n假设适用于地幔对流的无限普朗特数极限，因此在线性化动量方程中惯性项可以忽略。设基本热传导态为 $T_{0}(z)=1-z$ 和 $\\boldsymbol{u}_{0}=\\boldsymbol{0}$。考虑关于此基态的无穷小扰动 $(\\boldsymbol{u},p,\\theta)$，其中 $\\theta$ 是温度扰动。在上下两个平板上，对温度扰动施加等温边界条件，对速度施加自由滑移边界条件：\n- $z=0$ 和 $z=1$：$\\,\\theta=0$，$\\,w=0$，$\\,\\partial^{2} w/\\partial z^{2}=0$，其中 $w$ 是垂直速度。\n\n从关于热传导态的无量纲线性化 Boussinesq 方程出发：\n- 不可压缩性条件：$\\nabla\\cdot\\boldsymbol{u}=0$；\n- 斯托克斯动量平衡：$\\boldsymbol{0}=-\\nabla p+\\nabla^{2}\\boldsymbol{u}+Ra\\,\\theta\\,\\hat{\\boldsymbol{z}}$；\n- 热量方程：$\\dfrac{\\partial \\theta}{\\partial t}=\\nabla^{2}\\theta+w$，\n通过寻找正比于 $\\exp\\!\\big(i k x+\\sigma t\\big)$ 的解（其中水平波数 $k>0$，增长率 $\\sigma$，以及 $z$ 的垂直结构函数）来进行简正模线性稳定性分析。推导在给定边界条件下垂直速度振幅 $W(z)$ 和温度振幅 $\\Theta(z)$ 的常微分特征值问题，确定基本垂直模态的中性稳定色散关系 $Ra=Ra(k)$，并通过对 $k>0$ 最小化 $Ra(k)$ 来获得自由滑移、等温平板下定常对流起始的临界瑞利数 $Ra_{c}$ 和相应的临界波数 $k_{c}$。\n\n然后，定性地（用文字而非公式）解释这些临界值与上下两平板均为刚性、无滑移、等温的情况有何不同以及为什么不同。\n\n请以 LaTeX 的 $\\pmatrix$ 约定，用单行写出自由滑移、等温情况下无量纲数对 $\\big(Ra_{c},\\,k_{c}\\big)$ 的精确封闭形式表达式，作为您的最终答案，不进行数值舍入。", "solution": "该问题要求对厚度为 $H$、具有自由滑移、等温边界条件的水平无限流体层中的瑞利-贝纳尔对流进行线性稳定性分析。我们需要找到定常对流起始的临界瑞利数 $Ra_c$ 和临界波数 $k_c$。\n\n首先，我们从已知的无量纲线性化 Boussinesq 方程开始，这些方程描述了速度 $\\boldsymbol{u}=(u,v,w)$、压力 $p$ 和温度 $\\theta$ 对静止的、热传导的基态的扰动。问题设定在一个坐标系中，其中 $\\hat{\\boldsymbol{z}}$ 指向上方，因此垂直坐标 $z$ 的范围从 $0$ 到 $1$。方程如下：\n1. 不可压缩性条件：$\\nabla\\cdot\\boldsymbol{u}=0$\n2. 斯托克斯动量平衡（无限普朗特数）：$\\boldsymbol{0}=-\\nabla p+\\nabla^{2}\\boldsymbol{u}+Ra\\,\\theta\\,\\hat{\\boldsymbol{z}}$\n3. 热输运方程：$\\dfrac{\\partial \\theta}{\\partial t}=\\nabla^{2}\\theta+w$\n\n此处，$Ra = \\frac{\\alpha g \\Delta T H^3}{\\nu \\kappa}$ 是瑞利数。\n\n我们进行简正模分析，寻找在水平方向上是周期的、在时间上呈指数增长或衰减的解。根据 Squire 定理，不失一般性，我们可以考虑沿 y 轴方向的二维对流卷，因此所有变量都与 y 无关，且速度分量 $v=0$。扰动可以写成：\n$$w(x,z,t) = W(z) \\exp(i k x + \\sigma t)$$\n$$u(x,z,t) = U(z) \\exp(i k x + \\sigma t)$$\n$$\\theta(x,z,t) = \\Theta(z) \\exp(i k x + \\sigma t)$$\n$$p(x,z,t) = P(z) \\exp(i k x + \\sigma t)$$\n其中 $k>0$ 是水平波数，$\\sigma$ 是复增长率。将这些形式代入控制方程，将偏微分方程转化为关于振幅函数 $W(z)$、$U(z)$、$\\Theta(z)$ 和 $P(z)$ 的常微分方程（ODE）。令 $D \\equiv \\frac{d}{dz}$。\n\n不可压缩性方程 $\\frac{\\partial u}{\\partial x} + \\frac{\\partial w}{\\partial z} = 0$ 变为：\n$$ikU + DW = 0 \\quad \\implies \\quad U = \\frac{i}{k} DW$$\n\n动量方程变为：\nx 分量：$0 = -ikP + (D^2 - k^2)U$\nz 分量：$0 = -DP + (D^2 - k^2)W + Ra\\,\\Theta$\n\n热输运方程变为：\n$$\\sigma \\Theta = (D^2 - k^2)\\Theta + W$$\n\n下一步是消去 $U$ 和 $P$，得到一个关于 $W$ 和 $\\Theta$ 的方程组。\n将 $U = \\frac{i}{k}DW$ 代入 x-动量方程：\n$$0 = -ikP + (D^2 - k^2)\\left(\\frac{i}{k}DW\\right) \\implies P = \\frac{1}{k^2}(D^2 - k^2)DW$$\n现在，通过对 $P$ 的表达式求关于 $z$ 的导数，将其代入 z-动量方程：\n$$DP = \\frac{1}{k^2}(D^2 - k^2)D^2W$$\n于是 z-动量方程为：\n$$0 = -\\frac{1}{k^2}(D^2 - k^2)D^2W + (D^2 - k^2)W + Ra\\,\\Theta$$\n乘以 $k^2$ 并整理得到：\n$$k^2Ra\\,\\Theta = (D^2 - k^2)D^2W - k^2(D^2 - k^2)W = (D^2 - k^2)(D^2W - k^2W)$$\n这简化为一个耦合 $W$ 和 $\\Theta$ 的四阶常微分方程：\n$$(D^2 - k^2)^2 W = k^2 Ra\\,\\Theta \\quad (*)$$\n\n我们在寻找定常对流的起始，这对应于临界稳定情况，此时增长率为纯实数且等于零（$\\sigma=0$）。对此问题成立的稳定性交换原理证明了这一点是合理的。在热输运方程中设 $\\sigma=0$，得到第二个常微分方程：\n$$(D^2 - k^2)\\Theta = -W \\quad (**)$$\n\n我们现在有了一个关于 $W(z)$ 和 $\\Theta(z)$ 的耦合常微分方程组。顶部和底部平板（$z=0$ 和 $z=1$）的边界条件给定为等温（$\\theta=0$）、不可穿透（$w=0$）和自由滑移。自由滑移条件（在边界处 $\\frac{\\partial u}{\\partial z}=0$）与不可压缩性条件结合，导致 $\\frac{\\partial^2 w}{\\partial z^2}=0$。因此，振幅函数的边界条件是：\n$$W(0) = W(1) = 0$$\n$$\\Theta(0) = \\Theta(1) = 0$$\n$$D^2W(0) = D^2W(1) = 0$$\n\n这些特定的边界条件均可被正弦函数满足。让我们尝试一个形式为 $W(z) = A \\sin(n\\pi z)$（其中整数 $n \\ge 1$）的解。\n- $W(0) = A \\sin(0) = 0$ 且 $W(1) = A \\sin(n\\pi) = 0$。\n- $D^2W = -A(n\\pi)^2 \\sin(n\\pi z)$，所以 $D^2W(0)=0$ 且 $D^2W(1)=0$。\n此形式是该系统的一个有效特征函数。\n\n现在我们将 $W(z) = A \\sin(n\\pi z)$ 代入方程 $(*)$ 和 $(**)$ 来求特征值 $Ra$。\n从 $(**)$，我们求得 $\\Theta(z)$：\n$$(D^2 - k^2)\\Theta = -A \\sin(n\\pi z)$$\n由于 $D^2[\\sin(n\\pi z)] = -(n\\pi)^2 \\sin(n\\pi z)$，我们可以假设 $\\Theta(z) = B \\sin(n\\pi z)$。代入可得：\n$$(-(n\\pi)^2 - k^2)B \\sin(n\\pi z) = -A \\sin(n\\pi z)$$\n$$B = \\frac{A}{(n\\pi)^2 + k^2}$$\n所以，$\\Theta(z) = \\frac{A}{(n\\pi)^2 + k^2}\\sin(n\\pi z)$。此形式也满足边界条件 $\\Theta(0)=\\Theta(1)=0$。\n\n现在，将 $W(z)$ 和 $\\Theta(z)$ 都代入方程 $(*)$：\n$$(D^2 - k^2)^2 (A \\sin(n\\pi z)) = k^2 Ra \\left( \\frac{A}{(n\\pi)^2 + k^2}\\sin(n\\pi z) \\right)$$\n我们计算左侧算符：\n$$(D^2 - k^2)(A \\sin(n\\pi z)) = (-(n\\pi)^2 - k^2)A \\sin(n\\pi z)$$\n$$(D^2 - k^2)^2(A \\sin(n\\pi z)) = (-(n\\pi)^2 - k^2)^2 A \\sin(n\\pi z) = ((n\\pi)^2 + k^2)^2 A \\sin(n\\pi z)$$\n将此代回主方程：\n$$((n\\pi)^2 + k^2)^2 A \\sin(n\\pi z) = k^2 Ra \\frac{A}{(n\\pi)^2 + k^2} \\sin(n\\pi z)$$\n对于非平凡解（$A \\neq 0$），我们可以消去 $A\\sin(n\\pi z)$，得到 $Ra$ 作为 $k$ 和 $n$ 函数的色散关系：\n$$Ra(k,n) = \\frac{((n\\pi)^2 + k^2)^3}{k^2}$$\n对流的起始对应于最小可能的瑞利数。我们必须关于模数 $n$ 和波数 $k$ 最小化 $Ra$。对于任意固定的 $k>0$，函数 $Ra(k,n)$可通过选择最小可能的整数 $n$ 值来最小化，即 $n=1$（基模）。\n$$Ra(k) = \\frac{(\\pi^2 + k^2)^3}{k^2}$$\n为找到最小化 $Ra(k)$ 的临界波数 $k_c$，我们计算关于 $k$ 的导数并令其为零。使用 $x=k^2$ 作为变量会更简单：\n$$Ra(x) = \\frac{(\\pi^2 + x)^3}{x}$$\n$$\\frac{dRa}{dx} = \\frac{3(\\pi^2+x)^2 \\cdot x - (\\pi^2+x)^3 \\cdot 1}{x^2} = 0$$\n为得到最小值，分子必须为零。因为 $x=k^2>0$，所以 $\\pi^2+x \\neq 0$，故我们可以除以 $(\\pi^2+x)^2$：\n$$3x - (\\pi^2+x) = 0$$\n$$2x - \\pi^2 = 0 \\implies x = \\frac{\\pi^2}{2}$$\n因此，临界波数的平方为 $k_c^2 = \\frac{\\pi^2}{2}$，这给出临界波数：\n$$k_c = \\sqrt{\\frac{\\pi^2}{2}} = \\frac{\\pi}{\\sqrt{2}}$$\n最后，我们将此值代回 $Ra(k)$ 的表达式中，以找到临界瑞利数 $Ra_c$：\n$$Ra_c = \\frac{(\\pi^2 + k_c^2)^3}{k_c^2} = \\frac{(\\pi^2 + \\frac{\\pi^2}{2})^3}{\\frac{\\pi^2}{2}} = \\frac{(\\frac{3\\pi^2}{2})^3}{\\frac{\\pi^2}{2}}$$\n$$Ra_c = \\frac{\\frac{27\\pi^6}{8}}{\\frac{\\pi^2}{2}} = \\frac{27\\pi^6}{8} \\cdot \\frac{2}{\\pi^2} = \\frac{27\\pi^4}{4}$$\n所以，对于自由滑移、等温边界，定常对流起始的临界值为 $k_c = \\frac{\\pi}{\\sqrt{2}}$ 和 $Ra_c = \\frac{27\\pi^4}{4}$。数值上，它们约等于 $k_c \\approx 2.221$ 和 $Ra_c \\approx 657.51$。\n\n与刚性、无滑移、等温情况的定性比较：\n\n对于刚性（无滑移）边界，垂直速度振幅的边界条件变为 $W=0$ 和 $DW=0$ 在 $z=0$ 和 $z=1$ 处。这些更严格的条件导致的临界值为 $Ra_c \\approx 1707.76$ 和 $k_c \\approx 3.117$。\n\n与自由滑移边界相比，刚性边界的临界瑞利数（$Ra_c$）显著更高（$1708$ vs. $657.5$）。瑞利数代表浮力驱动力与耗散力（黏性和热）之比。刚性、无滑移边界在流体层的顶部和底部引入了强烈的黏性拖曳，比自由滑移边界更有效地耗散动能，在自由滑移边界上流体可以无剪切应力地水平移动。这种增强的黏性耗散稳定了热传导态，这意味着需要更强的浮力（因而需要更高的 $Ra$）来克服阻力并启动对流运动。\n\n与自由滑移边界相比，刚性边界的临界波数（$k_c$）更大（$3.12$ vs. $2.22$）。波数与对流单体起始时的水平波长成反比（$\\lambda_c = 2\\pi/k_c$）。更大的 $k_c$ 意味着更窄的对流单体。无滑移条件强烈约束了边界附近的垂直方向流体流动。流体必须减速并停止。为了适应这种强烈的垂直剪切，流动组织成更窄的单体。相反，对于自由滑移边界，顶部和底部缺少黏性阻力，使得流体能以较小的 effort 在更宽的水平距离上完成其翻转环流，从而导致更宽的对流单体和更小的临界波数。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{27\\pi^4}{4} \\, \\frac{\\pi}{\\sqrt{2}}\n\\end{pmatrix}\n}\n$$", "id": "3610794"}, {"introduction": "将地幔流动的控制方程（斯托克斯方程）转化为可计算的离散形式，是数值建模的关键一步，而有限元法是实现这一目标的强大工具。本练习[@problem_id:3610779]要求你推导斯托克斯方程的弱形式，并辨别哪些速度-压力单元对满足保证压力场稳定的LBB（Ladyzhenskaya–Babuška–Brezzi）条件。这对于避免伪解、确保模拟结果的物理真实性至关重要。", "problem": "考虑一个二维地幔对流模型，该模型在具有边界 $\\Gamma$ 的有界Lipschitz域 $\\Omega \\subset \\mathbb{R}^2$ 上建立，并采用Boussinesq近似。流体是不可压缩的牛顿流体，其黏度 $\\eta(T)$ 依赖于温度，并且密度变化仅在浮力项中保留。控制方程为稳态斯托克斯动量平衡和不可压缩性方程：\n$$\n\\nabla \\cdot \\boldsymbol{\\sigma} + \\rho_0 \\alpha \\left( T - T_{\\mathrm{ref}} \\right) \\mathbf{g} = \\mathbf{0}, \\quad \\nabla \\cdot \\mathbf{u} = 0 \\quad \\text{in } \\Omega,\n$$\n其中 $\\boldsymbol{\\sigma} = -p \\mathbf{I} + 2 \\eta(T) \\boldsymbol{\\varepsilon}(\\mathbf{u})$ 是柯西应力张量，$p$ 是动压力，$\\mathbf{u}$ 是速度，$\\boldsymbol{\\varepsilon}(\\mathbf{u}) = \\tfrac{1}{2} \\left( \\nabla \\mathbf{u} + \\left( \\nabla \\mathbf{u} \\right)^{\\top} \\right)$ 是对称梯度，$\\rho_0$ 是参考密度常数，$\\alpha$ 是热膨胀系数，$T$ 是温度场，$T_{\\mathrm{ref}}$ 是参考温度，$\\mathbf{g}$ 是重力加速度矢量。假设边界为自由滑移、不可穿透边界，即在 $\\Gamma$ 上有 $\\mathbf{u} \\cdot \\mathbf{n} = 0$ 和 $\\mathbf{t} \\cdot \\left( \\boldsymbol{\\sigma} \\mathbf{n} \\right) = 0$，其中 $\\mathbf{n}$ 和 $\\mathbf{t}$ 分别表示 $\\Gamma$ 上的单位法向和切向方向。\n\n从这些控制定律和边界条件出发，推导适用于伽辽金类有限元方法（FEM）的弱（变分）形式。明确指定速度和压力的试探空间和检验空间，包括为保证压力唯一性所需的任何约束，并指出由此产生的双线性和线性形式。\n\n然后，关注离散混合格式，在标准假设下的形状规则网格上，选出所有满足Ladyzhenskaya–Babuška–Brezzi (LBB) inf–sup 条件以确保压力稳定，且无需任何额外稳定化项的有限元速度-压力空间对：\n\nA. Taylor–Hood $P_2$–$P_1$（三角形上连续二次速度，连续线性压力）\n\nB. 等阶连续 $P_1$–$P_1$（三角形上线性速度，线性压力）\n\nC. MINI单元：速度空间为每个三角形上富含一个内部气泡函数的 $P_1$ 单元，压力空间为 $P_1$ 连续单元\n\nD. 四边形 $Q_2$–$Q_1$（四边形上双二次速度，双线性压力）\n\nE. 等阶连续 $P_2$–$P_2$（三角形上二次速度，二次压力）\n\nF. Scott–Vogelius $P_k$–$P_{k-1}$（速度为 $k$ 次连续分片多项式，压力为 $k-1$ 次分片多项式），在二维情况下，当 $k \\ge 3$ 时，作用于重心加密的三角形网格上\n\nG. Crouzeix–Raviart 非协调 $P_1$ 速度与三角形上的分片常数 $P_0$ 压力", "solution": "该问题陈述在科学上是合理的、适定的和客观的。它为地幔对流提供了Boussinesq近似下的斯托克斯方程的标准表述，并要求对其弱形式进行标准推导，以及对著名有限元配对的稳定性进行评估。该问题是有效的。\n\n### 弱形式的推导\n\n目标是找到满足控制方程和边界条件的速度和压力解对 $(\\mathbf{u}, p)$。弱形式是通过将控制方程乘以合适的检验函数并在域 $\\Omega$ 上积分得到的。\n\n设速度的试探空间为 $V$，压力的试探空间为 $Q$。类似地，速度的检验空间为 $V$，压力的检验空间为 $Q$。速度的试探函数 $\\mathbf{u}$ 和检验函数 $\\mathbf{v}$ 必须属于一个足够正则的空间，以确保积分有良好定义，并且该空间要包含本质（狄利克雷型）边界条件。压力的试探函数 $p$ 和检验函数 $q$ 必须属于一个适合该问题的空间。\n\n不可穿透边界条件 $\\mathbf{u} \\cdot \\mathbf{n} = 0$ 是一个必须内置于速度函数空间中的本质条件。自由滑移条件 $\\mathbf{t} \\cdot (\\boldsymbol{\\sigma} \\mathbf{n}) = 0$ 是一个将从弱形式中产生的自然条件。\n\n合适的函数空间是Sobolev空间。速度空间 $V$ 定义为：\n$$\nV = \\{ \\mathbf{v} \\in [H^1(\\Omega)]^2 \\mid \\mathbf{v} \\cdot \\mathbf{n} = 0 \\text{ on } \\Gamma \\}\n$$\n压力空间 $Q$ 定义为：\n$$\nQ = L^2_0(\\Omega) = \\left\\{ q \\in L^2(\\Omega) \\mid \\int_{\\Omega} q \\, d\\Omega = 0 \\right\\}\n$$\n施加条件 $\\int_{\\Omega} q \\, d\\Omega = 0$ 以确保压力解的唯一性，否则压力解只能在相差一个任意加性常数的意义下确定。\n\n**1. 动量方程的弱形式**\n\n我们从动量平衡方程开始：\n$$\n\\nabla \\cdot \\boldsymbol{\\sigma} + \\mathbf{f} = \\mathbf{0} \\quad \\text{in } \\Omega\n$$\n其中 $\\mathbf{f} = \\rho_0 \\alpha (T - T_{\\mathrm{ref}}) \\mathbf{g}$ 代表浮力。我们将此方程乘以一个任意检验函数 $\\mathbf{v} \\in V$ 并在域 $\\Omega$ 上积分：\n$$\n\\int_{\\Omega} (\\nabla \\cdot \\boldsymbol{\\sigma}) \\cdot \\mathbf{v} \\, d\\Omega + \\int_{\\Omega} \\mathbf{f} \\cdot \\mathbf{v} \\, d\\Omega = 0\n$$\n对第一项使用分部积分（向量的格林第一恒等式）可得：\n$$\n-\\int_{\\Omega} \\boldsymbol{\\sigma} : \\nabla \\mathbf{v} \\, d\\Omega + \\int_{\\Gamma} (\\boldsymbol{\\sigma}\\mathbf{n}) \\cdot \\mathbf{v} \\, d\\Gamma + \\int_{\\Omega} \\mathbf{f} \\cdot \\mathbf{v} \\, d\\Omega = 0\n$$\n边界积分 $\\int_{\\Gamma} (\\boldsymbol{\\sigma}\\mathbf{n}) \\cdot \\mathbf{v} \\, d\\Gamma$ 必须被计算。边界上的任何向量都可以分解为其法向和切向分量。由于 $\\mathbf{v} \\in V$，它在 $\\Gamma$ 上满足 $\\mathbf{v} \\cdot \\mathbf{n} = 0$。这意味着 $\\mathbf{v}$ 在边界上是纯切向的。设 $\\mathbf{t}$ 为 $\\Gamma$ 上的单位切向量。则 $\\mathbf{v} = (\\mathbf{v} \\cdot \\mathbf{t}) \\mathbf{t}$。被积函数变为：\n$$\n(\\boldsymbol{\\sigma}\\mathbf{n}) \\cdot \\mathbf{v} = (\\boldsymbol{\\sigma}\\mathbf{n}) \\cdot ((\\mathbf{v} \\cdot \\mathbf{t}) \\mathbf{t}) = (\\mathbf{v} \\cdot \\mathbf{t}) (\\boldsymbol{\\sigma}\\mathbf{n} \\cdot \\mathbf{t})\n$$\n自由滑移边界条件恰好是切向牵引力为零：$\\mathbf{t} \\cdot (\\boldsymbol{\\sigma}\\mathbf{n}) = 0$。因此，整个边界积分消失：\n$$\n\\int_{\\Gamma} (\\boldsymbol{\\sigma}\\mathbf{n}) \\cdot \\mathbf{v} \\, d\\Gamma = 0\n$$\n动量方程的弱形式简化为：\n$$\n\\int_{\\Omega} \\boldsymbol{\\sigma} : \\nabla \\mathbf{v} \\, d\\Omega = \\int_{\\Omega} \\mathbf{f} \\cdot \\mathbf{v} \\, d\\Omega\n$$\n现在，我们代入柯西应力张量的定义 $\\boldsymbol{\\sigma} = -p \\mathbf{I} + 2 \\eta(T) \\boldsymbol{\\varepsilon}(\\mathbf{u})$：\n$$\n\\int_{\\Omega} \\left( -p \\mathbf{I} + 2 \\eta(T) \\boldsymbol{\\varepsilon}(\\mathbf{u}) \\right) : \\nabla \\mathbf{v} \\, d\\Omega = \\int_{\\Omega} \\mathbf{f} \\cdot \\mathbf{v} \\, d\\Omega\n$$\n涉及压力的项为 $-p\\mathbf{I} : \\nabla\\mathbf{v} = -p \\sum_{i} \\frac{\\partial v_i}{\\partial x_i} = -p (\\nabla \\cdot \\mathbf{v})$。\n黏性项为 $2 \\eta(T) \\boldsymbol{\\varepsilon}(\\mathbf{u}) : \\nabla \\mathbf{v}$。由于 $\\boldsymbol{\\varepsilon}(\\mathbf{u})$ 是对称张量，其与 $\\nabla \\mathbf{v}$ 的斜对称部分的内积为零。因此，$\\boldsymbol{\\varepsilon}(\\mathbf{u}) : \\nabla \\mathbf{v} = \\boldsymbol{\\varepsilon}(\\mathbf{u}) : \\boldsymbol{\\varepsilon}(\\mathbf{v})$。\n这就得到了动量方程的最终弱形式：\n$$\n\\int_{\\Omega} 2 \\eta(T) \\boldsymbol{\\varepsilon}(\\mathbf{u}) : \\boldsymbol{\\varepsilon}(\\mathbf{v}) \\, d\\Omega - \\int_{\\Omega} p (\\nabla \\cdot \\mathbf{v}) \\, d\\Omega = \\int_{\\Omega} \\mathbf{f} \\cdot \\mathbf{v} \\, d\\Omega\n$$\n\n**2. 不可压缩性方程的弱形式**\n\n不可压缩性约束为 $\\nabla \\cdot \\mathbf{u} = 0$。我们将其乘以一个压力检验函数 $q \\in Q$ 并在 $\\Omega$ 上积分：\n$$\n\\int_{\\Omega} q (\\nabla \\cdot \\mathbf{u}) \\, d\\Omega = 0\n$$\n\n**3. 完整的变分问题**\n\n完整的问题是：求 $(\\mathbf{u}, p) \\in V \\times Q$，使得对于所有检验函数 $(\\mathbf{v}, q) \\in V \\times Q$：\n$$\n\\begin{cases}\n\\int_{\\Omega} 2 \\eta(T) \\boldsymbol{\\varepsilon}(\\mathbf{u}) : \\boldsymbol{\\varepsilon}(\\mathbf{v}) \\, d\\Omega - \\int_{\\Omega} p (\\nabla \\cdot \\mathbf{v}) \\, d\\Omega = \\int_{\\Omega} \\mathbf{f} \\cdot \\mathbf{v} \\, d\\Omega \\\\\n\\int_{\\Omega} q (\\nabla \\cdot \\mathbf{u}) \\, d\\Omega = 0\n\\end{cases}\n$$\n我们可以识别出双线性和线性形式：\n*   黏性双线性形式： $a(\\mathbf{u}, \\mathbf{v}) = \\int_{\\Omega} 2 \\eta(T) \\boldsymbol{\\varepsilon}(\\mathbf{u}) : \\boldsymbol{\\varepsilon}(\\mathbf{v}) \\, d\\Omega$\n*   压力-速度耦合双线性形式： $b(\\mathbf{v}, p) = - \\int_{\\Omega} p (\\nabla \\cdot \\mathbf{v}) \\, d\\Omega$\n*   载荷线性形式： $L(\\mathbf{v}) = \\int_{\\Omega} \\mathbf{f} \\cdot \\mathbf{v} \\, d\\Omega = \\int_{\\Omega} \\rho_0 \\alpha (T - T_{\\mathrm{ref}}) \\mathbf{g} \\cdot \\mathbf{v} \\, d\\Omega$\n\n变分问题是：求 $(\\mathbf{u}, p) \\in V \\times Q$，使得：\n$$\n\\begin{cases}\na(\\mathbf{u}, \\mathbf{v}) + b(\\mathbf{v}, p) = L(\\mathbf{v}) \\quad \\forall \\mathbf{v} \\in V \\\\\nb(\\mathbf{u}, q) = 0 \\quad \\forall q \\in Q\n\\end{cases}\n$$\n注意，$b(\\cdot, \\cdot)$ 的标准定义意味着 $b(\\mathbf{u}, q) = -\\int_{\\Omega} q (\\nabla \\cdot \\mathbf{u}) \\, d\\Omega$，因此 $b(\\mathbf{u}, q) = 0$ 等价于不可压缩性约束的弱形式。\n\n### 有限元配对的评估\n\n斯托克斯方程离散混合格式的稳定性由Ladyzhenskaya–Babuška–Brezzi (LBB) inf-sup 条件决定。如果存在一个与网格尺寸 $h$ 无关的常数 $\\beta > 0$，使得以下条件成立，则速度-压力对 $(V_h, Q_h)$ 是LBB稳定的：\n$$\n\\inf_{q_h \\in Q_h \\setminus \\{0\\}} \\sup_{\\mathbf{v}_h \\in V_h \\setminus \\{\\mathbf{0}\\}} \\frac{-\\int_{\\Omega} q_h (\\nabla \\cdot \\mathbf{v}_h) \\, d\\Omega}{\\|\\mathbf{v}_h\\|_{V} \\|q_h\\|_{Q}} \\ge \\beta\n$$\n满足此条件的配对可以在没有额外稳定化项的情况下使用。我们现在评估给定的选项。\n\nA. **Taylor–Hood $P_2$–$P_1$（三角形上连续二次速度，连续线性压力）**：这是典型的LBB稳定单元对。速度空间比压力空间更丰富，满足LBB条件。\n**结论：正确**\n\nB. **等阶连续 $P_1$–$P_1$（三角形上线性速度，线性压力）**：这是一个经典的LBB不稳定单元的例子。相对于速度空间，压力空间过大，导致伪压力振荡。这种配对需要使用稳定化技术才能工作。\n**结论：错误**\n\nC. **MINI单元：速度空间为每个三角形上富含一个内部气泡函数的 $P_1$ 单元，压力空间为 $P_1$ 连续单元**：该单元，也称为 $P_1b$-$P_1$，通过一个在单元边界上消失的三次“气泡”函数来丰富线性速度空间。这种丰富足以稳定线性压力。它满足LBB条件。\n**结论：正确**\n\nD. **四边形 $Q_2$–$Q_1$（四边形上双二次速度，双线性压力）**：这是Taylor–Hood单元在四边形网格上的类似物。它是一种众所周知的用于四边形网格的LBB稳定配对。\n**结论：正确**\n\nE. **等阶连续 $P_2$–$P_2$（三角形上二次速度，二次压力）**：与 $P_1$–$P_1$ 单元类似，这种等阶连续配对是LBB不稳定的，在没有稳定化的情况下会产生伪压力模式。\n**结论：错误**\n\nF. **Scott–Vogelius $P_k$–$P_{k-1}$（速度为 $k$ 次连续分片多项式，压力为 $k-1$ 次分片多项式），在二维情况下，当 $k \\ge 3$ 时，作用于重心加密的三角形网格上**：Scott–Vogelius配对通常指连续速度（$P_k$）和*不连续*压力（$P_{k-1}$）。尽管括号内的描述提到了连续压力，但对网格和多项式次数的特定条件强烈指向不连续压力的情况，其稳定性是非平凡的。对于一般网格，该配对不是LBB稳定的。然而，在特定的网格条件下，例如指定的重心加密，已证明在二维情况下当 $k \\ge 3$ 时是稳定的。\n**结论：正确**\n\nG. **Crouzeix–Raviart 非协调 $P_1$ 速度与三角形上的分片常数 $P_0$ 压力**：该单元使用线性多项式表示速度，这些多项式仅在边中点处连续（这使其成为非协调的，因为它不属于 $H^1(\\Omega)$），并与分片常数压力配对。该配对满足一个适用于非协调方法的修正LBB条件，是斯托克斯问题的一个众所周知的稳定选择。\n**结论：正确**", "answer": "$$\\boxed{ACDFG}$$", "id": "3610779"}, {"introduction": "在对封闭域（如整个地幔）中的不可压缩流进行建模时，一个常见的数值难题是压力解的不唯一性，这会导致代数方程组奇异。本练习[@problem_id:3610784]探讨了处理这一“压力零空间”问题的两种常用策略：固定平均压力和在单一节点钉扎压力。通过分析这两种方法的优劣，你将学会如何在实际计算中确保获得唯一且稳定的压力解。", "problem": "考虑布辛涅斯克近似下的地幔对流的不可压缩斯托克斯流，其中温度相关的浮力驱动运动，但除了浮力项外，密度的变化被忽略。设区域为一封闭连通区域 $\\Omega \\subset \\mathbb{R}^d$，其边界为不可渗透（无法向流动），并假设适当的速度边界条件以保证质量守恒。无量纲形式的控制方程为动量平衡和不可压缩性方程，\n$$\n- \\nabla \\cdot \\left( 2 \\eta(\\mathbf{x}) \\mathbf{D}(\\mathbf{u}) \\right) + \\nabla p = \\mathrm{Ra}\\, T(\\mathbf{x})\\, \\hat{\\mathbf{z}}, \\quad \\nabla \\cdot \\mathbf{u} = 0,\n$$\n其中 $\\mathbf{u}(\\mathbf{x})$ 是速度，$p(\\mathbf{x})$ 是压力，$\\eta(\\mathbf{x})$ 是黏度，$\\mathbf{D}(\\mathbf{u}) = \\tfrac{1}{2}(\\nabla \\mathbf{u} + \\nabla \\mathbf{u}^{\\top})$ 是应变率张量，$\\mathrm{Ra}$ 是瑞利数，$T(\\mathbf{x})$ 是温度，$\\hat{\\mathbf{z}}$ 是浮力方向的单位向量。一个稳定的混合有限元离散化（例如，Taylor–Hood）会导出一个线性代数鞍点系统\n$$\n\\begin{bmatrix}\n\\mathbf{A}  \\mathbf{B}^{\\top} \\\\\n\\mathbf{B}  \\mathbf{0}\n\\end{bmatrix}\n\\begin{bmatrix}\n\\mathbf{u} \\\\\n\\mathbf{p}\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\mathbf{f} \\\\\n\\mathbf{0}\n\\end{bmatrix},\n$$\n其中 $\\mathbf{A}$ 代表黏性双线性形式，$\\mathbf{B}$ 代表离散散度，$\\mathbf{u}$ 是速度基函数的系数向量，$\\mathbf{p}$ 是压力基函数的系数向量，$\\mathbf{f}$ 代表浮力驱动和边界项。在一个封闭连通的区域中，由于动量方程中只出现 $\\nabla p$，该系统存在一个压力零空间。消除此零空间并使系统具有唯一解的两种常用策略是：(i) 通过施加全局约束 $\\int_{\\Omega} p\\, \\mathrm{d}\\Omega = 0$ 来固定平均压力，以及 (ii) 通过在选定的网格节点 $\\mathbf{x}_\\star$ 处设置 $p(\\mathbf{x}_\\star) = 0$ 并从 $\\mathbf{p}$ 中消除相应的自由度来钉扎该节点的压力。\n\n下列哪个陈述最好地描述了这些策略如何消除压力零空间，以及它们对所得线性系统的条件数和结构的影响？\n\nA. 因为动量方程依赖于 $\\nabla p$，给 $p$ 加上任意常数不会改变方程，所以离散压力向量有一个由常数向量张成的1维零空间。施加零平均值约束 $\\int_{\\Omega} p\\, \\mathrm{d}\\Omega = 0$ 可以消除这个零空间而不改变 $\\mathbf{u}$，保留了对称不定的鞍点结构，并且通常比钉扎单个节点能产生稍好的条件数，因为该约束是全局的，且与常数模态正交。\n\nB. 在单个节点钉扎压力会将鞍点矩阵转换为对称正定系统，并且与固定平均压力相比改善了条件数，因为消除一个自由度总会增加最小奇异值。\n\nC. 在弱形式中添加一个压力惩罚项 $\\alpha \\int_{\\Omega} p^2 \\,\\mathrm{d}\\Omega$（其中 $\\alpha$ 很大）等价于固定平均压力，并在保持原始物理特性的同时维持最优条件数。\n\nD. 固定平均压力 $\\int_{\\Omega} p\\, \\mathrm{d}\\Omega = 0$ 会通过引入有效可压缩性来改变速度解 $\\mathbf{u}$，这种可压缩性会改变离散散度约束，因此它不适用于封闭区域。\n\n选择正确的选项。", "solution": "用户要求对所提供的问题陈述进行严格验证，然后进行严谨的求解推导并评估给定的选项。\n\n### 步骤1：提取已知信息\n问题陈述提供了以下信息：\n- **物理模型**：地幔对流的不可压缩斯托克斯流。\n- **近似**：布辛涅斯克近似，其中密度变化仅在浮力项中考虑。\n- **区域**：一个封闭连通区域 $\\Omega \\subset \\mathbb{R}^d$。\n- **边界条件**：不可渗透边界（无法向流动），以及其他未指明的确保质量守恒的速度边界条件。\n- **控制方程（无量纲）**：\n  - 动量平衡：$- \\nabla \\cdot \\left( 2 \\eta(\\mathbf{x}) \\mathbf{D}(\\mathbf{u}) \\right) + \\nabla p = \\mathrm{Ra}\\, T(\\mathbf{x})\\, \\hat{\\mathbf{z}}$\n  - 不可压缩性：$\\nabla \\cdot \\mathbf{u} = 0$\n- **定义**：\n  - $\\mathbf{u}(\\mathbf{x})$：速度场\n  - $p(\\mathbf{x})$：压力场\n  - $\\eta(\\mathbf{x})$：黏度场\n  - $\\mathbf{D}(\\mathbf{u}) = \\tfrac{1}{2}(\\nabla \\mathbf{u} + \\nabla \\mathbf{u}^{\\top})$：应变率张量\n  - $\\mathrm{Ra}$：瑞利数\n  - $T(\\mathbf{x})$：温度场\n  - $\\hat{\\mathbf{z}}$：浮力方向的单位向量\n- **数值离散化**：使用稳定的混合有限元方法（例如，Taylor–Hood）。\n- **代数系统**：离散化导出一个鞍点系统：\n  $$\n  \\begin{bmatrix}\n  \\mathbf{A}  \\mathbf{B}^{\\top} \\\\\n  \\mathbf{B}  \\mathbf{0}\n  \\end{bmatrix}\n  \\begin{bmatrix}\n  \\mathbf{u} \\\\\n  \\mathbf{p}\n  \\end{bmatrix}\n  =\n  \\begin{bmatrix}\n  \\mathbf{f} \\\\\n  \\mathbf{0}\n  \\end{bmatrix}\n  $$\n- **矩阵和向量定义**：\n  - $\\mathbf{A}$：离散黏性算子矩阵。\n  - $\\mathbf{B}$：离散散度算子矩阵。\n  - $\\mathbf{u}$：速度系数向量。\n  - $\\mathbf{p}$：压力系数向量。\n  - $\\mathbf{f}$：浮力驱动和边界项的向量。\n- **问题特征**：由于压力 $p$ 在动量方程中仅以梯度 $\\nabla p$ 的形式出现，该系统存在压力零空间。\n- **建议的解决方案**：提出了两种消除此零空间的策略：\n  - (i) 固定平均压力：施加约束 $\\int_{\\Omega} p\\, \\mathrm{d}\\Omega = 0$。\n  - (ii) 钉扎压力：在单个节点 $\\mathbf{x}_\\star$ 处设置 $p(\\mathbf{x}_\\star) = 0$。\n\n### 步骤2：使用提取的已知信息进行验证\n对问题陈述的科学有效性、适定性和客观性进行审查。\n\n1.  **科学依据**：该问题描述了布辛涅斯克近似下的典型斯托克斯方程，这是流体动力学和地球物理学中模拟对流的基石。使用混合有限元方法并将问题表述为鞍点线性系统，是计算流体动力学中的标准严谨方法。在具有自然（诺伊曼）压力边界条件的封闭区域中，压力零空间的存在是该问题有据可查的数学特征。提出的两种策略是解决此问题的教科书式方法。该问题在科学上和数学上都是合理的。\n\n2.  **适定性**：该问题是适定的。它要求比较两种标准数值技术的属性和效果。基于数值线性代数和鞍点问题的有限元理论，存在一个确切、正确的答案。\n\n3.  **客观性**：语言正式、精确，没有主观或含糊的术语。所有术语都是计算科学领域的标准术语。\n\n4.  **缺陷检查清单**：问题陈述没有表现出任何不合格的缺陷。它不是科学上不合理、非形式化、不完整、矛盾、不切实际、不适定或微不足道的。\n\n### 步骤3：结论与行动\n问题陈述是**有效的**。可以继续进行分析。\n\n### 推导与选项分析\n\n问题的核心在于，连续动量方程 $- \\nabla \\cdot \\left( 2 \\eta \\mathbf{D}(\\mathbf{u}) \\right) + \\nabla p = \\mathbf{f}_{\\text{body}}$ 中的压力 $p$ 仅在相差一个任意加性常数的意义下是确定的。如果 $p(\\mathbf{x})$ 是一个解，那么对于任意常数 $c \\in \\mathbb{R}$，$p(\\mathbf{x}) + c$ 也是一个解，因为 $\\nabla(p+c) = \\nabla p$。然而，速度场 $\\mathbf{u}$ 由 $\\nabla p$ 唯一确定。\n\n在离散情况下，这转化为鞍点矩阵中的一个零空间。矩阵 $\\mathbf{B}^\\top$ 是梯度算子的离散模拟。对于一个常数压力场，由向量 $\\mathbf{p}_c$ 表示（例如，对于标准节点基，这是一个全为1的向量），其离散梯度为零：$\\mathbf{B}^{\\top}\\mathbf{p}_c = \\mathbf{0}$。因此，完整的鞍点矩阵 $\\mathbf{K} = \\begin{bmatrix} \\mathbf{A}  \\mathbf{B}^{\\top} \\\\ \\mathbf{B}  \\mathbf{0} \\end{bmatrix}$ 是奇异的，因为它拥有一个零向量 $\\begin{bmatrix} \\mathbf{0} \\\\ \\mathbf{p}_c \\end{bmatrix}$：\n$$\n\\begin{bmatrix}\n\\mathbf{A}  \\mathbf{B}^{\\top} \\\\\n\\mathbf{B}  \\mathbf{0}\n\\end{bmatrix}\n\\begin{bmatrix}\n\\mathbf{0} \\\\\n\\mathbf{p}_c\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\mathbf{B}^{\\top} \\mathbf{p}_c \\\\\n\\mathbf{0}\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n\\mathbf{0} \\\\\n\\mathbf{0}\n\\end{bmatrix}\n$$\n因此，该系统对于压力向量 $\\mathbf{p}$ 不是唯一可解的。为了使其可解，我们必须对 $\\mathbf{p}$ 施加一个额外的约束以消除这个常数模态。\n\n**选项A的分析：**\n该选项指出压力零空间是1维的，由常数向量张成。如上所述，这是正确的。\n它声称施加 $\\int_{\\Omega} p\\, \\mathrm{d}\\Omega = 0$ 可消除此零空间。这也是正确的。此约束等效于要求压力解与常数函数正交，从而从解空间中消除了零空间分量。\n它声称这不会改变速度解 $\\mathbf{u}$。这是正确的。速度解 $\\mathbf{u}$ 依赖于压力梯度，而压力梯度不受向压力添加常数的影响。选择一个特定的常数（即那个使平均值为零的常数）只是从无限个有效解族中选择一个压力解，所有这些解都对应于同一个唯一的速度场。\n它声称该方法保留了对称不定的鞍点结构。这是正确的。该约束可以通过多种方式实现（例如，通过投影或拉格朗日乘子），这些方式能保持系统的整体结构，使其适用于专门的求解器。原始矩阵是对称的，修改后（但可解）的系统可以保持对称。由于对角线上的 $\\mathbf{0}$ 块，它是不定的。\n最后，它声称这种方法通常比钉扎法产生更好的条件数。这是数值分析中一个公认的原则。全局积分约束比钉扎节点的“暴力”局部约束更“温和”，在数学上也更优雅。它与奇异模态正交，这是消除奇异模态的理想方式，并且通常能导向条件数更好的系统。\n此陈述的所有部分都是准确的。\n**结论：正确。**\n\n**选项B的分析：**\n该选项声称钉扎压力将系统转换为对称正定（SPD）系统。这是不正确的。钉扎压力涉及从系统的压力部分移除一行和一列。所得矩阵仍然具有 $\\begin{bmatrix} \\mathbf{A}  \\tilde{\\mathbf{B}}^{\\top} \\\\ \\tilde{\\mathbf{B}}  \\mathbf{0} \\end{bmatrix}$ 的结构。对角线上的零块仍然存在，这使得矩阵是不定的，而不是正定的。一个SPD矩阵必须所有特征值都为正，而这个鞍点矩阵既有正特征值也有负特征值。\n它还声称与固定平均压力相比，钉扎法改善了条件数。如选项A的分析所述，这通常是错误的。钉扎是一种局部约束，可能会人为地使解产生应力，并且通常导致比全局约束更差的条件数。\n其理由“因为消除一个自由度总会增加最小奇异值”是一个有缺陷且过于笼统的断言。虽然消除一个零模态确实会使最小的*非零*奇异值成为新的最小奇异值，但这并不能保证这种特定的消除方法（钉扎）是最优的，也不能保证它相对于其他方法能改善条件数。\n**结论：不正确。**\n\n**选项C的分析：**\n该选项建议添加一个惩罚项 $\\alpha \\int_{\\Omega} p^2 \\,\\mathrm{d}\\Omega$。在弱形式中，这会在压力方程中添加一个项 $\\alpha \\int_{\\Omega} p q \\, \\mathrm{d}\\Omega$，其中 $q$ 是压力测试函数。这将离散不可压缩性约束从 $\\mathbf{B}\\mathbf{u} = \\mathbf{0}$ 修改为 $\\mathbf{B}\\mathbf{u} + \\alpha \\mathbf{M}_p \\mathbf{p} = \\mathbf{0}$，其中 $\\mathbf{M}_p$ 是压力质量矩阵。这等价于将连续不可压缩性方程更改为 $\\nabla \\cdot \\mathbf{u} + \\alpha p = 0$。\n声称这“等价于固定平均压力”是错误的。这是一种正则化技术，它通过引入一种形式的人工可压缩性来从根本上改变物理特性。原始问题是针对不可压缩流体（$\\nabla \\cdot \\mathbf{u} = 0$），而这个修改后的问题是针对微可压缩流体。\n声称它“维持最优条件数”是错误的。众所周知，随着惩罚参数（这里是 $\\alpha$）变大，罚函数法会恶化条件数，系统矩阵的条件数通常与 $\\alpha$ 成比例。\n声称它“保持原始物理特性”是错误的，因为它改变了不可压缩性约束。\n**结论：不正确。**\n\n**选项D的分析：**\n该选项声称固定平均压力会“改变速度解 $\\mathbf{u}$”。这是错误的。如选项A的分析所述，速度解是唯一的，不依赖于压力场中的任意常数。固定这个常数不会改变 $\\mathbf{u}$。\n它声称该方法“通过引入有效可压缩性来改变离散散度约束”。这也是错误的。固定平均压力只是对压力空间 $Q$ 的一个约束。它不改变涉及速度空间的散度约束 $\\mathbf{B}\\mathbf{u} = \\mathbf{0}$。能够引入有效可压缩性的是罚函数法（如选项C中的方法）。\n因此，其结论“它不适用于封闭区域”是基于错误的前提。事实上，它是用于封闭区域的最合适、最标准且理论上最有依据的方法之一。\n**结论：不正确。**", "answer": "$$\\boxed{A}$$", "id": "3610784"}]}