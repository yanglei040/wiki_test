## 引言
数值积分是[计算地球物理学](@entry_id:747618)及众多科学与工程领域不可或缺的基础工具，它将复杂的连续问题转化为可计算的离散形式。然而，虽然基础的[求积法则](@entry_id:753909)（如梯形法则或[辛普森法则](@entry_id:142987)）广为人知，但对其误差行为的深刻理解，尤其是在面对地球物理模型中常见的奇异、高度[振荡](@entry_id:267781)、非光滑或高维函数时，往往存在知识鸿沟。这种理解的缺失可能导致计算结果不准确、效率低下，甚至得出错误的物理结论。

本文旨在系统性地填补这一鸿沟，为研究生和科研人员提供一个关于求积误差与收敛性的全面分析框架。我们将通过三个循序渐进的章节，带领读者从核心理论走向前沿应用：

第一章“原理与机制”，将使用佩亚诺核定理构建[误差分析](@entry_id:142477)的坚实理论基础，揭示误差与[函数光滑性](@entry_id:161935)的内在联系。我们将探索不同求积方法的[收敛率](@entry_id:146534)，并阐明[高斯求积](@entry_id:146011)为何能实现惊人的精度，以及[谱方法](@entry_id:141737)在处理解析函数时的指数级收敛现象。

第二章“应用与跨学科连接”，将展示这些理论原理如何在实践中发挥威力。我们将探讨其在计算力学、波动物理和固态物理等领域的具体应用，解决有限元方法中的“变分犯罪”、边界元方法中的[奇异积分](@entry_id:167381)以及高维空间中的“维度灾难”等真实世界的计算难题。

最后，第三章“动手实践”，将通过精心设计的编程练习，让读者亲手处理奇异性、尖峰函数和数值不稳定性等挑战，将理论知识转化为解决实际问题的能力。

通过这段结构化的学习旅程，读者将获得在复杂的[科学模拟](@entry_id:637243)中精确选择、应用和调试[数值积分方法](@entry_id:141406)的专业知识。现在，让我们首先深入探讨支撑这一切的核心原理与机制。

## 原理与机制

本章在前一章介绍[数值积分](@entry_id:136578)基本概念的基础上，深入探讨求积法则[误差分析](@entry_id:142477)的核心原理与关键机制。我们将建立一个分析框架，用以理解和量化求积误差，探索不同求积方法背后的收敛性态，并讨论在[计算地球物理学](@entry_id:747618)中常见的挑战性问题，如[振荡积分](@entry_id:137059)、[奇异积分](@entry_id:167381)和[高维积分](@entry_id:143557)。

### 求积[误差分析](@entry_id:142477)的理论框架：佩亚诺核定理

理解任何数值方法的关键在于量化其误差。对于[数值积分](@entry_id:136578)，一个强大而普适的工具是**佩亚诺核定理 (Peano Kernel Theorem)**。该定理为一大类被称为**线性求积泛函 (linear quadrature functional)** 的误差提供了精确的积分表达式。

考虑一个一般的求积法则，它用节点 $x_i$ 处的函数值的加权和来逼近积分。其误差可以定义为一个作用于函数 $f$ 的泛函 $L(f)$：
$$
L(f) \equiv \int_{a}^{b} \rho(x) f(x) \,dx - \sum_{i=1}^{n} \beta_i f(x_i)
$$
其中 $\rho(x)$ 是一个已知的权重函数（例如，在地球物理模型中可能代表空间变化的密度或刚度），而 $\beta_i$ 是[求积权重](@entry_id:753910)。这个泛函 $L$ 是线性的，即 $L(c_1 f_1 + c_2 f_2) = c_1 L(f_1) + c_2 L(f_2)$。

一个求积法则的**精度阶 (degree of exactness)** 是指它能够精确积分的最高次多项式的次数。假设我们的[求积法则](@entry_id:753909)对于所有次数不超过 $m-1$ 的多项式 $p(x)$ 都是精确的，即 $L(p)=0$ for $\deg(p) \le m-1$。佩亚诺核定理指出，对于任何在 $[a,b]$ 上具有 $m$ 阶连续导数的函数 $f \in C^m([a,b])$，其求积误差可以表示为以下积分形式：
$$
L(f) = \int_{a}^{b} K(t) f^{(m)}(t) \,dt
$$
这里的 $K(t)$ 被称为**佩亚诺核 (Peano kernel)**，它完全由求积法则本身（即积分区间、权重函数 $\rho(x)$、节点 $x_i$ 和权重 $\beta_i$）决定，而与被积函数 $f$ 无关。该核函数的定义方式揭示了误差的内在结构 [@problem_id:3612087]：
$$
K(t) = L_x\left( \frac{(x-t)_+^{m-1}}{(m-1)!} \right)
$$
其中下标 $x$ 表示泛函 $L$ 是作用于变量为 $x$ 的函数上。函数 $(x-t)_+^{m-1}$ 是**截断[幂函数](@entry_id:166538) (truncated power function)**，定义为 $(y)_+ \equiv \max\{y, 0\}$。这个定义源于[泰勒定理](@entry_id:144253)的积分余项形式，它将函数 $f$ 分解为一个次数为 $m-1$ 的[泰勒多项式](@entry_id:162010)和一个包含其 $m$ 阶导数的积分[余项](@entry_id:159839)。由于泛函 $L$ 对多项式部分的作用为零，误差完全由其对积分[余项](@entry_id:159839)的作用产生，从而导出了上述[核函数](@entry_id:145324)表达式。

### 从[核函数](@entry_id:145324)到[误差界](@entry_id:139888)

佩亚诺核定理的威力在于，它将复杂的求积[误差分解](@entry_id:636944)为一个固定的[核函数](@entry_id:145324) $K(t)$ 与函数的高阶导数 $f^{(m)}(t)$ 的[内积](@entry_id:158127)。这使得我们可以通过分析 $K(t)$ 的性质来推导具体的误差界。

利用 Hölder 不等式，我们可以从误差的积分表达式推导出两种常用的误差界 [@problem_id:3612044]。
第一种界是基于 $f^{(m)}$ 的**[无穷范数](@entry_id:637586) (supremum norm)**，$\|f^{(m)}\|_\infty = \sup_{t \in [a,b]} |f^{(m)}(t)|$：
$$
|L(f)| = \left| \int_{a}^{b} K(t) f^{(m)}(t) \,dt \right| \le \int_{a}^{b} |K(t)| |f^{(m)}(t)| \,dt \le \left(\sup_{t \in [a,b]} |f^{(m)}(t)|\right) \int_{a}^{b} |K(t)| \,dt = \|f^{(m)}\|_\infty \|K\|_1
$$
第二种界是基于 $f^{(m)}$ 的 **$L^1$ 范数**，$\|f^{(m)}\|_1 = \int_a^b |f^{(m)}(t)| \,dx$：
$$
|L(f)| \le \int_{a}^{b} |K(t)| |f^{(m)}(t)| \,dt \le \left(\sup_{t \in [a,b]} |K(t)|\right) \int_{a}^{b} |f^{(m)}(t)| \,dt = \|K\|_\infty \|f^{(m)}\|_1
$$
这两种误差界提供了不同的视角。$\|f^{(m)}\|_\infty$ 范数关注 $f^{(m)}$ 的峰值大小，而 $\|f^{(m)}\|_1$ 范数关注其总体的“粗糙度”或变化量。在[计算地球物理学](@entry_id:747618)中，当地球模型中的材料属性在某个深度发生剧烈但局部的变化时（例如一个尖锐的界面），$f^{(m)}$ 可能在一个很小的区域内非常大，但在其他地方接近于零。在这种情况下，$\|f^{(m)}\|_\infty$ 可能很大，但 $\|f^{(m)}\|_1$ 可能相对较小，此时基于 $L^1$ 范数的误差界会更加紧致和实用。反之，如果 $f^{(m)}$ 的变化（如[振荡](@entry_id:267781)）[分布](@entry_id:182848)在整个区间，$\|f^{(m)}\|_\infty$ 相关的界可能更优 [@problem_id:3612044]。

让我们以**[辛普森法则](@entry_id:142987) (Simpson's rule)** 为例来具体说明 [@problem_id:3612100]。对于区间 $[a,b]$，单面板辛普森法则的误差泛函为：
$$
L(f) = \int_{a}^{b} f(x)\,dx - \frac{b-a}{6}\left(f(a) + 4 f\left(\frac{a+b}{2}\right) + f(b)\right)
$$
该法则对三次及以下多项式精确，因此 $m=4$。我们可以推导出其佩亚诺核 $K(t)$。为简化计算，可在单位区间 $[0,1]$ 上进行，然后通过尺度变换得到一般区间的结果。在 $[0,1]$ 上，[核函数](@entry_id:145324)为 $K_0(t) = \frac{t^3(3t-2)}{72}$ for $t \in [0, 1/2]$，且关于 $t=1/2$ 对称。这个[核函数](@entry_id:145324)在 $[0,1]$ 上是非正的，并在中点 $t=1/2$ 达到其最小值。其[无穷范数](@entry_id:637586) $\|K_0\|_\infty = |K_0(1/2)| = \frac{1}{1152}$。对于一般区间 $[a,b]$，[核函数](@entry_id:145324) $K(t)$ 通过尺度变换得到，其[无穷范数](@entry_id:637586)为 $\|K\|_\infty = \frac{(b-a)^4}{1152}$。因此，[辛普森法则](@entry_id:142987)的 $L^1$ 误差界为：
$$
|L(f)| \le \|K\|_\infty \|f^{(4)}\|_{L^1([a,b])} = \frac{(b-a)^4}{1152} \int_a^b |f^{(4)}(t)| \,dt
$$
这个界是**紧的 (sharp)**，意味着存在一[类函数](@entry_id:146970)使等号成立或任意接近。当 $f^{(4)}(t)$ 的“质量”集中在[核函数](@entry_id:145324) $|K(t)|$ 取最大值的点（即区间中点）时，[误差界](@entry_id:139888)最接近实际误差。这在物理上对应于被积函数最主要的非[光滑性](@entry_id:634843)恰好出现在[求积法则](@entry_id:753909)最敏感的位置。

### [光滑性](@entry_id:634843)层次与收敛性

佩亚诺核定理揭示了求积误差与被积[函数光滑性](@entry_id:161935)之间的深刻联系。对于一个由局部法则（如辛普森法则）构成的[复合求积法则](@entry_id:634240)，其在宽度为 $h$ 的子区间上的误差通常具有 $O(h^{r+1})$ 的形式。当我们将 $N=(b-a)/h$ 个这样的子区间的误差相加时，总误差的量级为 $O(N \cdot h^{r+1}) = O(h^r)$。这里的 $r$ 通常就是该法则能够精确积分的多项式次数加一，即佩亚诺阶数。然而，这种 $O(h^r)$ 的[收敛率](@entry_id:146534)成立的前提是函数 $f$ 具有足够的光滑性 [@problem_id:3612112]。

标准的[光滑性](@entry_id:634843)假设是 $f \in C^r[a,b]$，即 $f$ 具有 $r$ 阶连续导数。在此条件下，$f^{(r)}$ 在 $[a,b]$上有界，我们可以得到经典[误差界](@entry_id:139888) $|E_h(f)| \le C h^r \|f^{(r)}\|_\infty$。

在地球物理应用中，模型常常是分层的，导致函数在层与层之间仅具有有限的光滑性。例如，函数的[一阶导数](@entry_id:749425)可能存在跳跃。佩亚诺理论可以扩展到更弱的[光滑性](@entry_id:634843)假设：
1.  **$f \in W^{r,1}[a,b]$**：这是索伯列夫空间 (Sobolev space)，要求 $f$ 的直到 $r-1$ 阶的导数绝对连续，且其 $r$ 阶[弱导数](@entry_id:189356) (weak derivative) 在 $L^1$ 中。对于这类函数，基于 $L^1$ 范数的[误差界](@entry_id:139888)仍然有效，保证了 $|E_h(f)| \le C h^r \|f^{(r)}\|_{L^1}$ 的[收敛率](@entry_id:146534)。
2.  **$f^{(r-1)}$ 具有[有界变差](@entry_id:139291) (Bounded Variation)**：这个条件比 $f \in C^r$ 更弱，它允许 $f^{(r-1)}$ 存在跳跃不连续点。在这种情况下，误差表达式可以通过[分部积分](@entry_id:136350)转化为一个关于 $df^{(r-1)}$ 的[黎曼-斯蒂尔杰斯积分](@entry_id:136464) (Riemann-Stieltjes integral) 形式。最终的误差界变为 $|E_h(f)| \le C h^r V(f^{(r-1)})$，其中 $V(f^{(r-1)})$ 是 $f^{(r-1)}$ 在 $[a,b]$ 上的总变差。

这些结果至关重要，它们确保了即使面对不完全光滑的地球模型，只要其不[光滑性](@entry_id:634843)是受控的（例如，导数仅有有限次跳跃），高阶[求积法则](@entry_id:753909)的[收敛率](@entry_id:146534)依然能够得到保证。

### 实现高阶收敛：高斯求积原理

前面讨论的[复合求积法则](@entry_id:634240)，如[辛普森法则](@entry_id:142987)，其节点是预先固定的（例如等距[分布](@entry_id:182848)）。一个自然的问题是：如果我们能够自由选择 $n$ 个节点和 $n$ 个权重，我们能达到的最高精度阶是多少？我们有 $2n$ 个自由度，因此有希望使求积法则对所有次数不超过 $2n-1$ 的多项式都精确。

**[高斯求积](@entry_id:146011) (Gaussian Quadrature)** 优雅地实现了这一目标。其核心思想是，通过精心选择节点，而非任意指定，可以获得惊人的精度提升。[高斯求积](@entry_id:146011)的根本原理如下 [@problem_id:3612119]：
对于给定的权重函数 $w(x)$ 和区间 $[a,b]$，存在一个唯一的 $n$ 点求积法则 $\sum_{i=1}^n \lambda_i f(x_i)$，其精度阶达到最高的 $2n-1$。这一最优性质当且仅当求积节点 $\{x_i\}_{i=1}^n$ 是关于[内积](@entry_id:158127) $\langle f,g \rangle = \int_a^b w(x)f(x)g(x)dx$ 的 $n$ 次**正交多项式** $p_n(x)$ 的 $n$ 个根时成立。

这些[正交多项式](@entry_id:146918) $\{p_k(x)\}$ 是一族满足 $\langle p_k, p_j \rangle = 0$ (若 $k \ne j$) 的多项式。对于满足特定条件的权重函数（例如在积分区间上几乎处处为正），可以证明 $p_n(x)$ 的所有 $n$ 个根都是实数、互不相同，并且都严格位于区间 $(a,b)$ 内部。一旦这些节点被确定，相应的权重 $\{\lambda_i\}$ 也随之唯一确定，并且保证为正。

在实践中，如何计算这些节点和权重？直接求解高次多项式的根是不稳定的。现代计算方法利用了[正交多项式](@entry_id:146918)的一个深刻性质：它们满足一个**[三项递推关系](@entry_id:176845) (three-term recurrence relation)**。这个递推关系可以表示为一个[对称三对角矩阵](@entry_id:755732)，即**雅可比矩阵 (Jacobi matrix)** $J$。$n$ 点高斯求积的节点恰好是该矩阵的前导 $n \times n$ [主子矩阵](@entry_id:201119) $J_n$ 的[特征值](@entry_id:154894)。而相应的权重则可以通过 $J_n$ 的[特征向量](@entry_id:151813)的第一分量计算得到。这个过程被称为**[Golub-Welsch算法](@entry_id:749964)** [@problem_id:3612119]，它是一种数值上极其稳定和高效的方法，是现代[科学计算](@entry_id:143987)库中实现高斯求积的标准算法。

### [解析函数](@entry_id:139584)的特殊情况：谱收敛

当被积函数 $f$ 不仅是 $C^\infty$ 的，而且是**[解析函数](@entry_id:139584) (analytic function)** 时，数值[积分的收敛](@entry_id:187300)速度可以超越任何代数[收敛率](@entry_id:146534) $O(N^{-p})$，达到指数级的收敛，这种现象被称为**谱收敛 (spectral convergence)**。

一个典型的例子是**[Clenshaw-Curtis求积](@entry_id:147876)** [@problem_id:3612056]。该方法基于在**切比雪夫-洛巴托 (Chebyshev-Lobatto)** 节点 $x_k = \cos(\frac{\pi k}{N})$ 上对函数 $f(x)$ 进行多项式插值，然后精确地对这个[插值多项式](@entry_id:750764)积分。由于插值多项式 $p_N(x)$ 在 $f(x)$ 是次数 $\le N$ 的多项式时与 $f(x)$ 完全相同，所以[Clenshaw-Curtis求积](@entry_id:147876)的[精度阶](@entry_id:145189)恰好是 $N$。

谱收敛的根源在于[解析函数](@entry_id:139584)的近似理论。一个在 $[-1,1]$ 上解析的函数，可以通过变量代换 $x = \cos\theta$ 延拓到复平面 $\theta$ 中的一个水平带状区域 $| \operatorname{Im} \theta |  \tau$。这个区域在 $x$ 平面上对应一个以 $\pm 1$ 为[焦点](@entry_id:174388)的**伯恩斯坦椭圆 (Bernstein ellipse)** [@problem_id:3612072]。函数在该椭圆内的[解析性](@entry_id:140716)保证了其[切比雪夫级数](@entry_id:174443)系数 $a_n$ 会指数衰减：$|a_n| \le C \exp(-n\tau)$。

[Clenshaw-Curtis求积](@entry_id:147876)的误差本质上是函数 $f(x)$ 与其 $N$ 次插值多项式 $p_N(x)$ 之差的积分。这个差值由被截断的[切比雪夫级数](@entry_id:174443)的高阶项决定，因此误差也以指数形式衰减，其量级为 $O(\exp(-N\tau))$ [@problem_id:3612072]。

高斯-勒让德 (Gauss-Legendre) 求积（即 $w(x)=1$ 的[高斯求积](@entry_id:146011)）在面对[解析函数](@entry_id:139584)时也表现出谱收敛性。更有趣的是，它的收敛速度甚至更快。对于一个 $m$ 点的[高斯-勒让德法则](@entry_id:636900)，其误差衰减速度为 $O(\exp(-2m\tau))$。这意味着，在节点数大致相同的情况下 ($m \approx N$)，[高斯-勒让德求积](@entry_id:138201)的误差的指数衰减率是Clenshaw-Curtis的两倍。例如，若要达到 $10^{-10}$ 的精度，在某个典型场景下，Clenshaw-Curtis可能需要约 47 个节点，而高斯-勒让德仅需约 24 个 [@problem_id:3612072]。这种效率上的优势使得[高斯求积](@entry_id:146011)在被积函数光滑时成为首选。

### 求积方法的挑战：[振荡](@entry_id:267781)、奇异性与高维问题

尽管高斯求积和谱方法在处理光滑函数时表现优异，但在[计算地球物理学](@entry_id:747618)中，我们经常遇到更具挑战性的积分问题。

#### 高度[振荡积分](@entry_id:137059)

在波传播、[地震偏移](@entry_id:754641)和[远场](@entry_id:269288)[格林函数](@entry_id:147802)计算中，常出现形式为 $\int_a^b f(x) e^{i\omega g(x)} dx$ 的**高度[振荡积分](@entry_id:137059)**，其中频率参数 $\omega \gg 1$ [@problem_id:3612061]。在这种情况下，被积函数的局部波长与 $\omega^{-1}$ 成正比。任何依赖于多项式近似的标准求积方法（包括高斯求积）若要获得准确结果，其采样密度必须能够解析函数的快速[振荡](@entry_id:267781)，即网格尺寸 $h$ 必须满足 $h=O(\omega^{-1})$。这意味着计算成本将随频率 $\omega$ 线性增长，这在 $\omega$ 极大时是不可接受的。

为解决此问题，研究者发展了专门的方法，如**Filon型方法**和**Levin型方法**。这些方法的共同哲学是，不再试图用多项式去逼近整个快速[振荡](@entry_id:267781)的被积函数，而是利用其已知的[振荡](@entry_id:267781)结构。Filon型方法用[多项式逼近](@entry_id:137391)较为平缓的振幅函数 $f(x)$，然后解析地或高效地计算[振荡](@entry_id:267781)[矩量](@entry_id:152982)。Levin型方法则通过求解一个[常微分方程](@entry_id:147024)，构造一个函数来解析地“抵消”[振荡](@entry_id:267781)项。这些方法的一个显著优点是，其精度会随着 $\omega$ 的增大而提高（或保持不变），而计算成本则与 $\omega$ 无关。然而，当相位函数 $g(x)$ 存在**[驻点](@entry_id:136617) (stationary points)**（即 $g'(x)=0$ 的点）时，积分的渐近行为会发生改变，这些方法也需要进行相应的调整 [@problem_id:3612061]。

#### [奇异积分](@entry_id:167381)

在[位场](@entry_id:143025)模拟或边界元方法中，积分核函数常常包含奇异性，例如 $\int_T \frac{1}{\|\mathbf{x}-\mathbf{x}_0\|} dV$ 中的 $1/r$ 型奇异性，其中 $\mathbf{x}_0$ 可能位于积分域 $T$ 的边界甚至内部 [@problem_id:3612091]。直接在[奇异点](@entry_id:199525)附近应用标准[求积法则](@entry_id:753909)会导致灾难性的误差。

处理[奇异积分](@entry_id:167381)的核心策略是**正则化 (regularization)**，即通过**[坐标变换](@entry_id:172727)**消除或减弱奇异性。一个强大的技术是**[Duffy变换](@entry_id:748709)**及其变种。例如，当[奇异点](@entry_id:199525) $\mathbf{x}_0$ 位于四面体的一个顶点时，可以构造一个从单位立方体到该四面体的映射，该映射的雅可比行列式恰好可以抵消 $1/r$ 奇异性，从而将原始的[奇异积分](@entry_id:167381)转化为一个在单位立方体上的光滑函数积分。当[奇异点](@entry_id:199525)位于边、面或内部时，可以通过**星式剖分 (star-subdivision)** 将原始积分域分解为多个子区域，使得[奇异点](@entry_id:199525)成为每个子区域的公共顶点，然后再对每个子区域应用[Duffy变换](@entry_id:748709)。此外，通过选择与变换后被积函数中的权重项相匹配的**加权高斯求积**（例如[高斯-雅可比求积](@entry_id:197831)），可以进一步提升计算效率 [@problem_id:3612091]。

#### [高维积分](@entry_id:143557)与维度灾难

在[不确定性量化](@entry_id:138597)或统计[地球物理学](@entry_id:147342)中，需要计算的积分维度 $d$ 可能非常高。此时，基于一维法则构造的**[张量积法则](@entry_id:177156) (tensor-product rule)** 会遭遇**[维度灾难](@entry_id:143920) (curse of dimensionality)**。若一维法则需要 $n$ 个点，则 $d$ 维[张量积法则](@entry_id:177156)需要 $N=n^d$ 个点，计算量随维度[指数增长](@entry_id:141869)。其[误差收敛](@entry_id:137755)率也同样恶化，对于具有 $s$ 阶光滑性的函数，误差为 $O(N^{-s/d})$ [@problem_id:3612088]。

**[稀疏网格](@entry_id:139655) (sparse grids)** 方法，如**Smolyak构造**，是应对维度灾难的有效策略。与使用“满”[张量积](@entry_id:140694)不同，[稀疏网格](@entry_id:139655)聪明地舍弃了那些对精度贡献较小的节点组合。它通过对不同维度上不同精度水平的一维[求积法则](@entry_id:753909)进行[线性组合](@entry_id:154743)来构造高维法则。对于具有特定“[混合光滑性](@entry_id:752028)”的函数（即关于变量[子集](@entry_id:261956)的[混合偏导数](@entry_id:139334)有界），[稀疏网格](@entry_id:139655)的[误差收敛](@entry_id:137755)率可以达到接近 $O(N^{-s}(\log N)^{c(d-1)})$。最关键的是，误差率中 $N$ 的幂次 $-s$ 不再依赖于维度 $d$，从而在很大程度上克服了[维度灾难](@entry_id:143920)，使得中高维度的数值积分成为可能 [@problem_id:3612088]。

### 一个实际考量：离散误差与[统计误差](@entry_id:755391)的权衡

在许多地球物理应用中，被积函数 $A(\omega)$ 并非通过解析表达式给出，而是通过带有噪声的测量获得，即 $y_k = A(\omega_k) + \varepsilon_k$，其中 $\varepsilon_k$ 是[方差](@entry_id:200758)为 $\sigma^2$ 的随机噪声。在这种情况下，选择求积点的数量 $N$ 就不再是“越多越好”。

总误差由两部分构成：**偏差 (bias)** 和 **[方差](@entry_id:200758) (variance)**。总的**[均方误差](@entry_id:175403) (Mean Square Error, MSE)** 为 $\text{MSE} = (\text{Bias})^2 + \text{Variance}$。
- **偏差**是[数值积分方法](@entry_id:141406)固有的[离散化误差](@entry_id:748522)。对于一个 $p$ 阶方法，偏差通常随 $N$ 的增加而减小，例如 $|Bias| \sim B N^{-p}$。
- **[方差](@entry_id:200758)**来源于[测量噪声](@entry_id:275238)的传播。求积估计量 $\widehat{I}_N = \sum w_k y_k$ 的[方差](@entry_id:200758)为 $\text{Var}(\widehat{I}_N) = \sigma^2 \sum w_k^2$。对于某些求积法则，特别是高阶[等距节点](@entry_id:168260)的[牛顿-柯特斯法则](@entry_id:171388)，权重平方和 $\sum w_k^2$ 会随 $N$ 的增大而增大（例如 $\sim \alpha N^\gamma$），这会导致噪声被放大。

因此，我们面临一个权衡：增加 $N$ 可以减小离散化偏差，但同时会增大统计[方差](@entry_id:200758)。存在一个最优的 $N^*$，使得总的均方[误差最小化](@entry_id:163081) [@problem_id:3612051]。通过对 MSE 关于 $N$ 的表达式求导并令其为零，我们可以解出这个最优的 $N^*$。例如，在给定[偏差和方差](@entry_id:170697)的 scaling law 下，可以得到 $N^* = \left( \frac{2p B^{2} L^{2(p-1)}}{\gamma \alpha \sigma^{2}} \right)^{\frac{1}{2p+\gamma}}$。这个结果清晰地表明，最优的[采样策略](@entry_id:188482)取决于[离散化误差](@entry_id:748522)的收敛速度、噪声的[方差](@entry_id:200758)以及[求积权重](@entry_id:753910)的稳定性，是理论分析与实际约束之间权衡的典范。