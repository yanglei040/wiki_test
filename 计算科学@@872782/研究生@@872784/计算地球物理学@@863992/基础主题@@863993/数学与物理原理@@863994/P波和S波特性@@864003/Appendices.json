{"hands_on_practices": [{"introduction": "要掌握P波和S波的特性，第一步是理解波速与介质弹性属性之间的基本关系。本练习 [@problem_id:3612495] 将引导您从弹性动力学的第一性原理出发，推导P波和S波的速度方程。通过对给定的拉梅参数（Lamé parameters）和密度进行计算，您不仅能将理论应用于实践，还能学会如何评估计算结果在物理上的合理性，从而加深对波传播物理本质的理解。", "problem": "考虑一块被理想化为均匀、各向同性、线性弹性连续体的结晶岩。设柯西应力张量与无穷小应变张量通过各向同性材料的胡克定律相关联，并且在没有体力的情况下，线性动量平衡成立。给定岩石的拉梅参数 $\\lambda$ 和 $\\mu$ 以及质量密度 $\\rho$：$\\lambda = 20$ GPa，$\\mu = 30$ GPa，以及 $\\rho = 2500$ kg/m$^3$。从弹性动力学的基本场方程和各向同性弹性的本构定律出发，推导由位移场产生的膨胀波（纵波，$P$波）和剪切波（横波，$S$波）模式的相速度。利用这些结果，根据给定的参数计算$P$波速度 $v_{p}$、$S$波速度 $v_{s}$ 以及它们的比值 $v_{p}/v_{s}$ 的数值。将 $v_{p}$ 和 $v_{s}$ 以米/秒 (m/s) 为单位表示，将 $v_{p}/v_{s}$ 表示为无量纲小数，并将这三个量均四舍五入到四位有效数字。最后，通过讨论稳定性约束和典型的材料属性范围，评估计算出的值对于结晶岩是否在物理上是合理的。", "solution": "该问题要求推导在均匀、各向同性、线性弹性连续体中膨胀波（$P$波）和剪切波（$S$波）的相速度，然后进行数值计算和合理性评估。\n\n控制弹性介质动力学的基本场方程是线性动量平衡和本构关系。在没有体力的情况下，线性动量平衡（柯西第一运动定律）由下式给出：\n$$ \\nabla \\cdot \\boldsymbol{\\sigma} = \\rho \\frac{\\partial^2 \\mathbf{u}}{\\partial t^2} $$\n在笛卡尔指标记法中，此为：\n$$ \\frac{\\partial \\sigma_{ij}}{\\partial x_j} = \\rho \\frac{\\partial^2 u_i}{\\partial t^2} $$\n其中 $\\boldsymbol{\\sigma}$ 是柯西应力张量，$\\mathbf{u}$ 是位移矢量，$\\rho$ 是质量密度，$t$ 是时间。\n\n均匀、各向同性、线性弹性材料的本构关系是胡克定律，它将应力张量 $\\sigma_{ij}$ 与无穷小应变张量 $\\epsilon_{ij}$ 联系起来：\n$$ \\sigma_{ij} = \\lambda \\epsilon_{kk} \\delta_{ij} + 2\\mu \\epsilon_{ij} $$\n此处，$\\lambda$ 和 $\\mu$ 是拉梅参数，$\\delta_{ij}$ 是克罗内克符号。应变张量与位移场的关系为：\n$$ \\epsilon_{ij} = \\frac{1}{2} \\left( \\frac{\\partial u_i}{\\partial x_j} + \\frac{\\partial u_j}{\\partial x_i} \\right) $$\n应变张量的迹 $\\epsilon_{kk}$ 表示体积应变（膨胀），由 $\\epsilon_{kk} = \\nabla \\cdot \\mathbf{u}$ 给出。\n\n为了推导波动方程，我们首先通过将应变-位移关系代入胡克定律来用位移表示应力：\n$$ \\sigma_{ij} = \\lambda (\\nabla \\cdot \\mathbf{u}) \\delta_{ij} + \\mu \\left( \\frac{\\partial u_i}{\\partial x_j} + \\frac{\\partial u_j}{\\partial x_i} \\right) $$\n接下来，我们将此应力表达式代入运动方程：\n$$ \\rho \\frac{\\partial^2 u_i}{\\partial t^2} = \\frac{\\partial}{\\partial x_j} \\left[ \\lambda (\\nabla \\cdot \\mathbf{u}) \\delta_{ij} + \\mu \\left( \\frac{\\partial u_i}{\\partial x_j} + \\frac{\\partial u_j}{\\partial x_i} \\right) \\right] $$\n$$ \\rho \\frac{\\partial^2 u_i}{\\partial t^2} = \\lambda \\frac{\\partial}{\\partial x_i} (\\nabla \\cdot \\mathbf{u}) + \\mu \\frac{\\partial^2 u_i}{\\partial x_j \\partial x_j} + \\mu \\frac{\\partial}{\\partial x_j} \\left( \\frac{\\partial u_j}{\\partial x_i} \\right) $$\n重新排列最后一项的微分顺序，我们得到：\n$$ \\rho \\frac{\\partial^2 u_i}{\\partial t^2} = \\lambda \\frac{\\partial}{\\partial x_i} (\\nabla \\cdot \\mathbf{u}) + \\mu \\nabla^2 u_i + \\mu \\frac{\\partial}{\\partial x_i} \\left( \\frac{\\partial u_j}{\\partial x_j} \\right) $$\n$$ \\rho \\frac{\\partial^2 u_i}{\\partial t^2} = (\\lambda + \\mu) \\frac{\\partial}{\\partial x_i} (\\nabla \\cdot \\mathbf{u}) + \\mu \\nabla^2 u_i $$\n这是弹性动力学的纳维-柯西方程。其矢量形式为：\n$$ \\rho \\frac{\\partial^2 \\mathbf{u}}{\\partial t^2} = (\\lambda + \\mu) \\nabla(\\nabla \\cdot \\mathbf{u}) + \\mu \\nabla^2 \\mathbf{u} $$\n为了将其分离为P波和S波方程，我们使用亥姆霍兹分解，它将位移矢量场 $\\mathbf{u}$ 分解为一个无旋（irrotational）分量和一个无散（solenoidal）分量之和：\n$$ \\mathbf{u} = \\nabla \\phi + \\nabla \\times \\boldsymbol{\\psi} $$\n其中 $\\phi$ 是一个标量势，$\\boldsymbol{\\psi}$ 是一个矢量势。对 $\\mathbf{u}$ 取散度和旋度：\n$$ \\nabla \\cdot \\mathbf{u} = \\nabla \\cdot (\\nabla \\phi) + \\nabla \\cdot (\\nabla \\times \\boldsymbol{\\psi}) = \\nabla^2 \\phi $$\n$$ \\nabla \\times \\mathbf{u} = \\nabla \\times (\\nabla \\phi) + \\nabla \\times (\\nabla \\times \\boldsymbol{\\psi}) = \\nabla(\\nabla \\cdot \\boldsymbol{\\psi}) - \\nabla^2 \\boldsymbol{\\psi} $$\n通过将分解代入纳维-柯西方程并使用矢量恒等式 $\\nabla^2 \\mathbf{u} = \\nabla(\\nabla \\cdot \\mathbf{u}) - \\nabla \\times (\\nabla \\times \\mathbf{u})$，我们得到：\n$$ \\rho \\frac{\\partial^2}{\\partial t^2}(\\nabla \\phi + \\nabla \\times \\boldsymbol{\\psi}) = (\\lambda + 2\\mu) \\nabla(\\nabla^2 \\phi) - \\mu \\nabla \\times (\\nabla \\times (\\nabla \\times \\boldsymbol{\\psi})) $$\n我们可以为 $\\boldsymbol{\\psi}$ 设置规范，使得 $\\nabla \\cdot \\boldsymbol{\\psi} = 0$。方程变为：\n$$ \\rho \\nabla \\left( \\frac{\\partial^2 \\phi}{\\partial t^2} \\right) + \\rho \\nabla \\times \\left( \\frac{\\partial^2 \\boldsymbol{\\psi}}{\\partial t^2} \\right) = (\\lambda + 2\\mu) \\nabla (\\nabla^2 \\phi) + \\mu \\nabla \\times (\\nabla^2 \\boldsymbol{\\psi}) $$\n通过对梯度项和旋度项进行分组，该方程可以分离为两个独立的方程：\n$$ \\nabla \\left[ (\\lambda + 2\\mu) \\nabla^2 \\phi - \\rho \\frac{\\partial^2 \\phi}{\\partial t^2} \\right] + \\nabla \\times \\left[ \\rho \\frac{\\partial^2 \\boldsymbol{\\psi}}{\\partial t^2} - \\mu \\nabla^2 \\boldsymbol{\\psi} \\right] = \\mathbf{0} $$\n为使此式成立，两个方括号内的项必须独立为零（对于标量势，可能相差一个时间函数，但可以被吸收到其定义中）。\n\n第一个方程，控制标量势 $\\phi$，是：\n$$ \\frac{\\partial^2 \\phi}{\\partial t^2} = \\frac{\\lambda + 2\\mu}{\\rho} \\nabla^2 \\phi $$\n这是一个标准的波动方程，描述了以相速度 $v_p$ 传播的波。这个波对应于膨胀波，或P波（纵波），其速度为：\n$$ v_p = \\sqrt{\\frac{\\lambda + 2\\mu}{\\rho}} $$\n第二个方程，控制矢量势 $\\boldsymbol{\\psi}$，是：\n$$ \\frac{\\partial^2 \\boldsymbol{\\psi}}{\\partial t^2} = \\frac{\\mu}{\\rho} \\nabla^2 \\boldsymbol{\\psi} $$\n这是一个矢量波动方程，描述了以相速度 $v_s$ 传播的波。这个波对应于剪切波，或S波（横波），其速度为：\n$$ v_s = \\sqrt{\\frac{\\mu}{\\rho}} $$\n现在，我们使用给定参数计算数值：$\\lambda = 20$ GPa，$\\mu = 30$ GPa，以及 $\\rho = 2500$ kg/m$^3$。我们必须使用国际单位制，所以 $1 \\text{ GPa} = 10^9 \\text{ N/m}^2 = 10^9 \\text{ kg} \\cdot \\text{m}^{-1} \\cdot \\text{s}^{-2}$。\n\nP波速度为：\n$$ v_p = \\sqrt{\\frac{20 \\times 10^9 \\text{ Pa} + 2 \\times (30 \\times 10^9 \\text{ Pa})}{2500 \\text{ kg/m}^3}} = \\sqrt{\\frac{80 \\times 10^9}{2500}} \\text{ m/s} = \\sqrt{32 \\times 10^6} \\text{ m/s} $$\n$$ v_p = 5656.85... \\text{ m/s} $$\n四舍五入到四位有效数字，$v_p = 5657$ m/s。\n\nS波速度为：\n$$ v_s = \\sqrt{\\frac{30 \\times 10^9 \\text{ Pa}}{2500 \\text{ kg/m}^3}} = \\sqrt{\\frac{300 \\times 10^8}{2500}} \\text{ m/s} = \\sqrt{12 \\times 10^6} \\text{ m/s} $$\n$$ v_s = 3464.10... \\text{ m/s} $$\n四舍五入到四位有效数字，$v_s = 3464$ m/s。\n\nP波速度与S波速度之比为：\n$$ \\frac{v_p}{v_s} = \\frac{\\sqrt{(\\lambda + 2\\mu)/\\rho}}{\\sqrt{\\mu/\\rho}} = \\sqrt{\\frac{\\lambda + 2\\mu}{\\mu}} = \\sqrt{\\frac{\\lambda}{\\mu} + 2} $$\n$$ \\frac{v_p}{v_s} = \\sqrt{\\frac{20 \\text{ GPa}}{30 \\text{ GPa}} + 2} = \\sqrt{\\frac{2}{3} + 2} = \\sqrt{\\frac{8}{3}} $$\n$$ \\frac{v_p}{v_s} = 1.63299... $$\n四舍五入到四位有效数字，$v_p/v_s = 1.633$。\n\n最后，我们评估这些结果的物理合理性。\n为使弹性材料稳定，其应变能密度必须是正定的。对于各向同性材料，这对拉梅参数施加了约束，即 $\\mu > 0$ 和体积模量 $K = \\lambda + \\frac{2}{3}\\mu > 0$。给定参数为 $\\mu = 30 \\text{ GPa} > 0$ 和 $K = 20 + \\frac{2}{3}(30) = 40 \\text{ GPa} > 0$。稳定性条件得到满足。这些条件确保了波速 $v_p$ 和 $v_s$ 是实数且为正。\n计算出的P波速度 $5657$ m/s 和S波速度 $3464$ m/s 位于结晶岩（如花岗岩）的典型范围内（其中 $v_p \\approx 5.5-6.5$ km/s and $v_s \\approx 3.0-3.8$ km/s）。\n比值 $v_p/v_s \\approx 1.633$ 也是物理上合理的。这个比值取决于泊松比 $\\nu = \\frac{\\lambda}{2(\\lambda+\\mu)}$。对于给定值，$\\nu = \\frac{20}{2(20+30)} = 0.2$。常见岩石的泊松比在 $0.1$ 和 $0.4$ 之间。$0.2$ 是一个非常典型的值。作为比较，泊松比为 $\\nu=0.25$ 时，会得到一个常见的基准比值 $v_p/v_s = \\sqrt{3} \\approx 1.732$。我们计算出的比值 $1.633$ 与泊松比略小于 $0.25$ 的材料相符。因此，对于指定的材料，计算出的值是物理上合理的。", "answer": "$$ \\boxed{ \\begin{pmatrix} 5657  3464  1.633 \\end{pmatrix} } $$", "id": "3612495"}, {"introduction": "在地球物理勘探中，我们通常从测量的地震波速度反演地下介质的属性，这是一个典型的反演问题。本练习 [@problem_id:3612504] 探讨了如何利用P波和S波的速度比来估算泊松比（Poisson's ratio），这是一个对岩石物理性质（如孔隙度和流体含量）高度敏感的关键参数。更重要的是，您将学习误差传播的基本方法，这对于评估由测量不确定性导致的模型参数不确定性至关重要。", "problem": "一个均匀、各向同性的线弹性固体由其P波（纵波）速度 $v_p$、S波（横波）速度 $v_s$、Lamé参数 $\\lambda$ 和 $\\mu$、密度 $\\rho$ 以及泊松比 $\\nu$ 来表征。某次在结晶基底中进行的折射勘探给出了测量值 $v_p = 6.20$ km/s 和 $v_s = 3.58$ km/s。报告的单标准差（SD）不确定度为 $\\sigma_{v_p} = 0.03$ km/s 和 $\\sigma_{v_s} = 0.02$ km/s，且 $v_p$ 和 $v_s$ 的测量误差可视为独立的。假设 $\\rho$ 的任何不确定度均可忽略不计。\n\n从连接 $v_p$、$v_s$、$\\lambda$、$\\mu$、$\\rho$ 和 $\\nu$ 的各向同性线弹性基本关系出发，完成以下任务：\n\n1) 通过消去 $\\lambda$、$\\mu$ 和 $\\rho$，推导仅用 $v_p$ 和 $v_s$ 表示 $\\nu$ 的显式解析表达式。\n\n2) 在 $v_p$ 和 $v_s$ 误差独立的假设下，使用一阶（线性）误差传播方法，推导用 $\\nu$ 对 $v_p$ 和 $v_s$ 的偏导数以及给定的 $\\sigma_{v_p}$ 和 $\\sigma_{v_s}$ 表示的 $\\nu$ 的方差表达式。\n\n3) 使用所提供的测量值，数值计算 $\\nu$ 的传播单标准差不确定度。将最终数值答案四舍五入至三位有效数字。将最终不确定度表示为无量纲值。\n\n你的最终答案必须是一个实数（即 $\\nu$ 的传播单标准差不确定度）。", "solution": "### 解答\n按照问题陈述的要求，解答分为三个部分。\n\n#### 1) 推导用 $v_p$ 和 $v_s$ 表示 $\\nu$ 的表达式\n在均匀、各向同性的线弹性固体中，P波速度 $v_p$ 和S波速度 $v_s$ 由Lamé参数 $\\lambda$ 和 $\\mu$ 以及密度 $\\rho$ 定义如下：\n$$v_p = \\sqrt{\\frac{\\lambda + 2\\mu}{\\rho}}$$\n$$v_s = \\sqrt{\\frac{\\mu}{\\rho}}$$\n将这些方程平方，得到：\n$$v_p^2 = \\frac{\\lambda + 2\\mu}{\\rho} \\implies \\rho v_p^2 = \\lambda + 2\\mu$$\n$$v_s^2 = \\frac{\\mu}{\\rho} \\implies \\rho v_s^2 = \\mu$$\n我们可以用 $\\mu$ 和波速来表示 $\\lambda$：\n$$\\lambda = \\rho v_p^2 - 2\\mu$$\n将S波速度方程中的 $\\mu$ 表达式代入 $\\lambda$ 的方程中：\n$$\\lambda = \\rho v_p^2 - 2(\\rho v_s^2) = \\rho(v_p^2 - 2v_s^2)$$\n泊松比 $\\nu$ 由Lamé参数定义为：\n$$\\nu = \\frac{\\lambda}{2(\\lambda + \\mu)}$$\n现在，将用波速和密度表示的 $\\lambda$ 和 $\\mu$ 的表达式代入 $\\nu$ 的定义中：\n$$\\nu = \\frac{\\rho(v_p^2 - 2v_s^2)}{2[\\rho(v_p^2 - 2v_s^2) + \\rho v_s^2]}$$\n密度 $\\rho$ 是分子和分母的公因子，因此可以消去：\n$$\\nu = \\frac{v_p^2 - 2v_s^2}{2(v_p^2 - 2v_s^2 + v_s^2)}$$\n化简分母后，得到仅用 $v_p$ 和 $v_s$ 表示的 $\\nu$ 的最终表达式：\n$$\\nu(v_p, v_s) = \\frac{v_p^2 - 2v_s^2}{2(v_p^2 - v_s^2)}$$\n\n#### 2) 推导 $\\nu$ 的方差\n问题要求使用一阶（线性）误差传播，并假设 $v_p$ 和 $v_s$ 的误差是独立的。对于函数 $\\nu(v_p, v_s)$，其方差 $\\sigma_\\nu^2$ 由下式给出：\n$$\\sigma_\\nu^2 = \\left(\\frac{\\partial \\nu}{\\partial v_p}\\right)^2 \\sigma_{v_p}^2 + \\left(\\frac{\\partial \\nu}{\\partial v_s}\\right)^2 \\sigma_{v_s}^2$$\n我们必须计算 $\\nu$ 对 $v_p$ 和 $v_s$ 的偏导数。\n\n首先，计算关于 $v_p$ 的偏导数：\n$$\\frac{\\partial \\nu}{\\partial v_p} = \\frac{\\partial}{\\partial v_p}\\left[\\frac{v_p^2 - 2v_s^2}{2(v_p^2 - v_s^2)}\\right]$$\n使用商法则 $\\frac{d}{dx}\\left(\\frac{f}{g}\\right) = \\frac{f'g - fg'}{g^2}$，其中 $f(v_p) = v_p^2 - 2v_s^2$ 且 $g(v_p) = 2(v_p^2 - v_s^2)$：\n$$\\frac{\\partial \\nu}{\\partial v_p} = \\frac{(2v_p)[2(v_p^2 - v_s^2)] - (v_p^2 - 2v_s^2)[2(2v_p)]}{[2(v_p^2 - v_s^2)]^2}$$\n$$\\frac{\\partial \\nu}{\\partial v_p} = \\frac{4v_p(v_p^2 - v_s^2) - 4v_p(v_p^2 - 2v_s^2)}{4(v_p^2 - v_s^2)^2}$$\n$$\\frac{\\partial \\nu}{\\partial v_p} = \\frac{v_p[(v_p^2 - v_s^2) - (v_p^2 - 2v_s^2)]}{(v_p^2 - v_s^2)^2}$$\n$$\\frac{\\partial \\nu}{\\partial v_p} = \\frac{v_p v_s^2}{(v_p^2 - v_s^2)^2}$$\n\n其次，计算关于 $v_s$ 的偏导数：\n$$\\frac{\\partial \\nu}{\\partial v_s} = \\frac{\\partial}{\\partial v_s}\\left[\\frac{v_p^2 - 2v_s^2}{2(v_p^2 - v_s^2)}\\right]$$\n使用商法则，其中 $f(v_s) = v_p^2 - 2v_s^2$ 且 $g(v_s) = 2(v_p^2 - v_s^2)$：\n$$\\frac{\\partial \\nu}{\\partial v_s} = \\frac{(-4v_s)[2(v_p^2 - v_s^2)] - (v_p^2 - 2v_s^2)[2(-2v_s)]}{[2(v_p^2 - v_s^2)]^2}$$\n$$\\frac{\\partial \\nu}{\\partial v_s} = \\frac{-8v_s(v_p^2 - v_s^2) + 4v_s(v_p^2 - 2v_s^2)}{4(v_p^2 - v_s^2)^2}$$\n$$\\frac{\\partial \\nu}{\\partial v_s} = \\frac{-2v_s(v_p^2 - v_s^2) + v_s(v_p^2 - 2v_s^2)}{(v_p^2 - v_s^2)^2}$$\n$$\\frac{\\partial \\nu}{\\partial v_s} = \\frac{-2v_s v_p^2 + 2v_s^3 + v_s v_p^2 - 2v_s^3}{(v_p^2 - v_s^2)^2}$$\n$$\\frac{\\partial \\nu}{\\partial v_s} = \\frac{-v_s v_p^2}{(v_p^2 - v_s^2)^2}$$\n\n将这些偏导数代入方差 $\\sigma_\\nu^2$ 的公式中：\n$$\\sigma_\\nu^2 = \\left(\\frac{v_p v_s^2}{(v_p^2 - v_s^2)^2}\\right)^2 \\sigma_{v_p}^2 + \\left(\\frac{-v_s v_p^2}{(v_p^2 - v_s^2)^2}\\right)^2 \\sigma_{v_s}^2$$\n这可以更紧凑地写为：\n$$\\sigma_\\nu^2 = \\frac{v_p^2 v_s^2}{(v_p^2 - v_s^2)^4} (v_s^2 \\sigma_{v_p}^2 + v_p^2 \\sigma_{v_s}^2)$$\n这就是所要求的 $\\nu$ 的方差表达式。\n\n#### 3) $\\nu$ 的不确定度的数值计算\n$\\nu$ 的单标准差不确定度是 $\\sigma_\\nu = \\sqrt{\\sigma_\\nu^2}$。我们使用给定的值：\n$v_p = 6.20$ km/s, $v_s = 3.58$ km/s, $\\sigma_{v_p} = 0.03$ km/s, and $\\sigma_{v_s} = 0.02$ km/s.\n\n首先，计算各项的平方：\n$v_p^2 = (6.20)^2 = 38.44$\n$v_s^2 = (3.58)^2 = 12.8164$\n$\\sigma_{v_p}^2 = (0.03)^2 = 0.0009$\n$\\sigma_{v_s}^2 = (0.02)^2 = 0.0004$\n\n接下来，计算偏导数的值：\n$$\\frac{\\partial \\nu}{\\partial v_p} = \\frac{v_p v_s^2}{(v_p^2 - v_s^2)^2} = \\frac{(6.20)(12.8164)}{(38.44 - 12.8164)^2} = \\frac{79.46168}{(25.6236)^2} \\approx \\frac{79.46168}{656.568} \\approx 0.121025$$\n$$\\frac{\\partial \\nu}{\\partial v_s} = \\frac{-v_s v_p^2}{(v_p^2 - v_s^2)^2} = \\frac{-(3.58)(38.44)}{(38.44 - 12.8164)^2} = \\frac{-137.6152}{(25.6236)^2} \\approx \\frac{-137.6152}{656.568} \\approx -0.209590$$\n\n现在，计算方差 $\\sigma_\\nu^2$：\n$$\\sigma_\\nu^2 = \\left(\\frac{\\partial \\nu}{\\partial v_p}\\right)^2 \\sigma_{v_p}^2 + \\left(\\frac{\\partial \\nu}{\\partial v_s}\\right)^2 \\sigma_{v_s}^2$$\n$$\\sigma_\\nu^2 \\approx (0.121025)^2 (0.03)^2 + (-0.209590)^2 (0.02)^2$$\n$$\\sigma_\\nu^2 \\approx (0.014647) (0.0009) + (0.043928) (0.0004)$$\n$$\\sigma_\\nu^2 \\approx 1.31823 \\times 10^{-5} + 1.75712 \\times 10^{-5}$$\n$$\\sigma_\\nu^2 \\approx 3.07535 \\times 10^{-5}$$\n\n单标准差不确定度是方差的平方根：\n$$\\sigma_\\nu = \\sqrt{\\sigma_\\nu^2} \\approx \\sqrt{3.07535 \\times 10^{-5}} \\approx 0.00554558$$\n将此值四舍五入至三位有效数字，得到 $0.00555$。\n$\\nu$ 的传播单标准差不确定度是一个无量纲值。", "answer": "$$\n\\boxed{0.00555}\n$$", "id": "3612504"}, {"introduction": "将物理方程转化为计算机代码是计算地球物理学的核心，但这一过程会引入数值误差。本练习 [@problem_id:3612540] 专注于一个关键的数值伪影——数值频散（numerical dispersion），它会导致不同频率的波在计算网格上以错误的相速度传播。通过对不同阶数有限差分格式的相速度误差进行推导和编程分析，您将获得评估和选择数值模拟方案的关键技能，确保计算结果的保真度。", "problem": "您的任务是使用有限差分 (FD) 空间离散化方法，在均匀、各向同性的弹性介质中，对纵波 (P) 和横波 (S) 进行基于原理的数值频散分析。从各向同性弹性波方程和分离 P 波与 S 波势的 Helmholtz 分解入手。空间离散化采用二阶和四阶中心差分格式处理，同时保持时间连续（半离散分析）。推导这些 FD 拉普拉斯算子的离散空间傅里叶符号，并获得平面波的半离散频散关系 $\\,\\omega(\\mathbf{k})\\,$。利用该关系，计算在选定传播方向上，每波长 $\\,10\\,$ 个采样点时的相速度误差。\n\n使用的基本原理：\n- 牛顿第二定律和线性各向同性弹性理论（导出 Navier 方程），以及将位移场分解为 P 波和 S 波势的 Helmholtz 分解。\n- 均匀介质中波矢为 $\\,\\mathbf{k}\\,$ 的平面波拟设。\n- 在间距为 $\\,h\\,$ 的笛卡尔网格上，用于逼近拉普拉斯算子 $\\,\\nabla^{2}\\,$ 的二阶和四阶中心差分格式。\n\n具体要求：\n1. 从各向同性线性弹性方程出发，使用 Helmholtz 分解证明标量 P 波势 $\\,\\phi\\,$ 和矢量 S 波势 $\\,\\boldsymbol{\\psi}\\,$ 满足标量波动方程 $\\,\\partial^{2}\\phi/\\partial t^{2} = \\alpha^{2}\\,\\nabla^{2}\\phi\\,$ 和 $\\,\\partial^{2}\\boldsymbol{\\psi}/\\partial t^{2} = \\beta^{2}\\,\\nabla^{2}\\boldsymbol{\\psi}\\,$, 其中 $\\,\\alpha\\,$ 和 $\\,\\beta\\,$ 分别是 P 波和 S 波的速度。\n2. 仅使用拉普拉斯算子 $\\,\\nabla^{2}\\,$ 的中心差分近似对空间进行离散化：\n   - 一个二阶精度格式。\n   - 一个四阶精度格式。\n   假设在每个坐标方向上都有均匀的笛卡尔网格间距 $\\,h\\,$，并且周期性足以进行空间傅里叶分析。\n3. 对于平面波 $\\,\\exp\\!\\left(i(\\mathbf{k}\\cdot\\mathbf{x}-\\omega t)\\right)\\,$，推导每种格式的半离散频散关系 $\\,\\omega(\\mathbf{k})\\,$。用 FD 拉普拉斯算子的离散傅里叶符号和波速 $\\,c\\,$ 来表示该关系，其中 P 波的 $\\,c=\\alpha\\,$，S 波的 $\\,c=\\beta\\,$。\n4. 将相速度定义为 $\\,c_{\\mathrm{ph}}(\\mathbf{k})=\\omega(\\mathbf{k})/\\lVert\\mathbf{k}\\rVert\\,$。将相对相速度误差定义为 $\\,\\varepsilon = c_{\\mathrm{ph}}/c - 1\\,$。以无单位的小数形式报告误差。\n5. 使用以下测试套件，每个测试都在每波长 $\\,10\\,$ 个采样点 (PPW) 下进行。设 PPW 为 $\\,N=10\\,$，无量纲波数大小乘以网格间距为 $\\,\\theta = 2\\pi/N\\,$。不失一般性地使用 $\\,h=1\\,$。对于每种情况，评估 P 波和 S 波在二阶和四阶空间格式下的表现：\n   - 测试 A（一维，轴对齐）：空间维度 $\\,d=1\\,$, 方向 $\\,\\hat{\\mathbf{d}}=[1]$, 因此 $\\,\\mathbf{k}=k\\,\\hat{\\mathbf{d}}\\,$ 且 $\\,\\theta = kh\\,$。\n   - 测试 B（二维，轴对齐）：空间维度 $\\,d=2\\,$, 方向 $\\,\\hat{\\mathbf{d}}=[1,0]$。\n   - 测试 C（二维，对角线方向）：空间维度 $\\,d=2\\,$, 方向 $\\,\\hat{\\mathbf{d}}=\\left[\\frac{1}{\\sqrt{2}},\\frac{1}{\\sqrt{2}}\\right]$。\n   在所有情况下，使用 $\\,N=10\\,$，因此 $\\,\\theta = 2\\pi/10\\,$，坐标分量上的无量纲波数为 $\\,\\theta_{a} = \\theta \\,\\hat{d}_{a}\\,$，其中 $\\,a\\,$ 是坐标索引。\n6. 您的程序应计算每个测试案例的相对相速度误差 $\\,\\varepsilon\\,$：\n   - 使用二阶格式的 P 波。\n   - 使用四阶格式的 P 波。\n   - 使用二阶格式的 S 波。\n   - 使用四阶格式的 S 波。\n   将结果收集到以下单行输出格式中，一个用方括号括起来的逗号分隔列表： \n   [$\\varepsilon_{\\mathrm{P},2,\\mathrm{A}}$,$\\varepsilon_{\\mathrm{P},4,\\mathrm{A}}$,$\\varepsilon_{\\mathrm{S},2,\\mathrm{A}}$,$\\varepsilon_{\\mathrm{S},4,\\mathrm{A}}$,$\\varepsilon_{\\mathrm{P},2,\\mathrm{B}}$,$\\varepsilon_{\\mathrm{P},4,\\mathrm{B}}$,$\\varepsilon_{\\mathrm{S},2,\\mathrm{B}}$,$\\varepsilon_{\\mathrm{S},4,\\mathrm{B}}$,$\\varepsilon_{\\mathrm{P},2,\\mathrm{C}}$,$\\varepsilon_{\\mathrm{P},4,\\mathrm{C}}$,$\\varepsilon_{\\mathrm{S},2,\\mathrm{C}}$,$\\varepsilon_{\\mathrm{S},4,\\mathrm{C}}$]\n   其中下标 $\\,\\mathrm{P}$ 或 $\\,\\mathrm{S}\\,$ 表示波类型，$\\,2\\,$ 或 $\\,4\\,$ 表示格式阶数，$\\,\\mathrm{A},\\mathrm{B},\\mathrm{C}\\,$ 表示上述测试案例。\n7. 角度以弧度为单位。无需报告物理单位，因为所要求的输出是无单位的相对误差。\n\n您的最终答案必须是一个完整的、可运行的程序，该程序能准确地生成上述单行输出，其中包含与指定测试套件在每波长 $\\,10\\,$ 个采样点下的 $\\,12\\,$ 个条目相对应的数值。", "solution": "用户提供了有效的问题陈述。任务是使用有限差分法对 P 波和 S 波进行数值频散分析。我们将从第一性原理推导必要的关系，然后将其应用于指定的测试案例。\n\n### 第 1 部分：P 波和 S 波方程的推导\n\n均匀、各向同性、线性弹性介质中的运动由 Navier 方程控制，该方程结合了牛顿第二定律和线性弹性的本构关系：\n$$\n\\rho \\frac{\\partial^2 \\mathbf{u}}{\\partial t^2} = (\\lambda + \\mu) \\nabla(\\nabla \\cdot \\mathbf{u}) + \\mu \\nabla^2 \\mathbf{u}\n$$\n其中 $\\mathbf{u}$ 是位移矢量，$\\rho$ 是密度，$\\lambda$ 和 $\\mu$ 是 Lamé 参数。\n\n使用 Helmholtz 分解，位移矢量场 $\\mathbf{u}$ 可以表示为一个标量势 $\\phi$（P 波势）的梯度与一个矢量势 $\\boldsymbol{\\psi}$（S 波势）的旋度之和：\n$$\n\\mathbf{u} = \\nabla\\phi + \\nabla \\times \\boldsymbol{\\psi}\n$$\n如果我们强制要求 S 波势是无散的，即 $\\nabla \\cdot \\boldsymbol{\\psi} = 0$（规范条件），那么这种分解是唯一的。\n\n将此分解代入 Navier 方程，我们首先计算 $\\mathbf{u}$ 的散度和拉普拉斯算子：\n$$\n\\nabla \\cdot \\mathbf{u} = \\nabla \\cdot (\\nabla\\phi + \\nabla \\times \\boldsymbol{\\psi}) = \\nabla^2\\phi + \\nabla \\cdot (\\nabla \\times \\boldsymbol{\\psi}) = \\nabla^2\\phi\n$$\n因为旋度的散度恒为零。\n$$\n\\nabla^2\\mathbf{u} = \\nabla^2(\\nabla\\phi + \\nabla \\times \\boldsymbol{\\psi}) = \\nabla(\\nabla^2\\phi) + \\nabla \\times (\\nabla^2\\boldsymbol{\\psi})\n$$\nNavier 方程的左边变为：\n$$\n\\rho \\frac{\\partial^2 \\mathbf{u}}{\\partial t^2} = \\rho \\frac{\\partial^2}{\\partial t^2}(\\nabla\\phi + \\nabla \\times \\boldsymbol{\\psi}) = \\rho \\nabla\\left(\\frac{\\partial^2\\phi}{\\partial t^2}\\right) + \\rho \\nabla \\times \\left(\\frac{\\partial^2\\boldsymbol{\\psi}}{\\partial t^2}\\right)\n$$\n将这些表达式代回 Navier 方程可得：\n$$\n\\rho \\nabla\\left(\\frac{\\partial^2\\phi}{\\partial t^2}\\right) + \\rho \\nabla \\times \\left(\\frac{\\partial^2\\boldsymbol{\\psi}}{\\partial t^2}\\right) = (\\lambda + \\mu) \\nabla(\\nabla^2\\phi) + \\mu \\left( \\nabla(\\nabla^2\\phi) + \\nabla \\times (\\nabla^2\\boldsymbol{\\psi}) \\right)\n$$\n将带有梯度和旋度算子的项分组：\n$$\n\\nabla\\left[\\rho \\frac{\\partial^2\\phi}{\\partial t^2} - (\\lambda + 2\\mu)\\nabla^2\\phi\\right] + \\nabla \\times \\left[\\rho \\frac{\\partial^2\\boldsymbol{\\psi}}{\\partial t^2} - \\mu\\nabla^2\\boldsymbol{\\psi}\\right] = \\mathbf{0}\n$$\n为使此方程对任意波场都成立，方括号中的项必须为零。这将方程分离为两个解耦的波动方程：\n$$\n\\frac{\\partial^2\\phi}{\\partial t^2} = \\frac{\\lambda + 2\\mu}{\\rho} \\nabla^2\\phi \\quad \\text{和} \\quad \\frac{\\partial^2\\boldsymbol{\\psi}}{\\partial t^2} = \\frac{\\mu}{\\rho} \\nabla^2\\boldsymbol{\\psi}\n$$\n定义 P 波速度 $\\alpha = \\sqrt{(\\lambda+2\\mu)/\\rho}$ 和 S 波速度 $\\beta = \\sqrt{\\mu/\\rho}$，我们得到势函数的标准标量和矢量波动方程：\n$$\n\\frac{\\partial^2\\phi}{\\partial t^2} = \\alpha^2 \\nabla^2\\phi \\quad \\text{（P 波方程）}\n$$\n$$\n\\frac{\\partial^2\\boldsymbol{\\psi}}{\\partial t^2} = \\beta^2 \\nabla^2\\boldsymbol{\\psi} \\quad \\text{（S 波方程）}\n$$\n两个方程都具有 $\\frac{\\partial^2 f}{\\partial t^2} = c^2 \\nabla^2 f$ 的形式，其中 $c$ 是波速（$\\alpha$ 或 $\\beta$）。\n\n### 第 2 部分：半离散频散分析\n\n我们分析标量波动方程 $\\frac{\\partial^2 u}{\\partial t^2} = c^2 \\nabla^2 u$。我们在空间上进行离散化，但时间上不离散（半离散化）。在所有 $d$ 个维度上间距均为 $h$ 的均匀笛卡尔网格上，拉普拉斯算子 $\\nabla^2$ 由离散算子 $\\nabla_h^2$ 近似。半离散方程为：\n$$\n\\frac{d^2 u_{\\mathbf{j}}}{dt^2} = c^2 \\nabla_h^2 u_{\\mathbf{j}}\n$$\n其中 $\\mathbf{j}$ 是网格点的多重索引。\n\n我们通过代入平面波拟设 $u(\\mathbf{x}, t) = e^{i(\\mathbf{k} \\cdot \\mathbf{x} - \\omega t)}$ 来探究该系统的频散特性，其中 $\\mathbf{k}$ 是波矢，$\\omega$ 是角频率。在网格点 $\\mathbf{x}_{\\mathbf{j}}$ 处，平面波为 $u_{\\mathbf{j}}(t) = e^{i(\\mathbf{k} \\cdot \\mathbf{x}_{\\mathbf{j}} - \\omega t)}$。\n应用时间导数和离散空间算子：\n$$\n(-i\\omega)^2 e^{i(\\mathbf{k} \\cdot \\mathbf{x}_{\\mathbf{j}} - \\omega t)} = c^2 \\nabla_h^2 e^{i(\\mathbf{k} \\cdot \\mathbf{x}_{\\mathbf{j}} - \\omega t)}\n$$\n像 $\\nabla_h^2$ 这样的线性、移不变离散算子作用于离散平面波 $e^{i\\mathbf{k} \\cdot \\mathbf{x}_{\\mathbf{j}}}$ 的效果是乘法性的。它引入一个因子，称为算子的傅里叶符号，记为 $\\hat{\\nabla}_h^2(\\mathbf{k})$：\n$$\n\\nabla_h^2 e^{i\\mathbf{k} \\cdot \\mathbf{x}_{\\mathbf{j}}} = \\hat{\\nabla}_h^2(\\mathbf{k}) e^{i\\mathbf{k} \\cdot \\mathbf{x}_{\\mathbf{j}}}\n$$\n因此，该方程成为一个代数关系：\n$$\n-\\omega^2 = c^2 \\hat{\\nabla}_h^2(\\mathbf{k})\n$$\n这给出了半离散频散关系：\n$$\n\\omega(\\mathbf{k}) = c \\sqrt{-\\hat{\\nabla}_h^2(\\mathbf{k})}\n$$\n数值相速度为 $c_{\\mathrm{ph}}(\\mathbf{k}) = \\omega(\\mathbf{k}) / \\|\\mathbf{k}\\|$。在连续情况下，$\\omega = c\\|\\mathbf{k}\\|$，所以 $c_{\\mathrm{ph}} = c$。数值近似引入了 $c_{\\mathrm{ph}}$ 对 $\\mathbf{k}$ 的依赖性，这种效应称为数值频散。\n\n### 第 3 部分：有限差分拉普拉斯算子的傅里叶符号\n\n令 $\\theta_a = k_a h$ 为坐标方向 $a$ 上的无量纲波数。离散拉普拉斯算子是一维二阶导数算子之和，$\\nabla_h^2 = \\sum_{a=1}^d \\delta_{aa,h}^2$。\n\n**二阶格式：**\n一维二阶中心差分算子是 $\\delta_{xx,h}^2 u(x) = \\frac{u(x+h) - 2u(x) + u(x-h)}{h^2}$。其符号通过将其应用于 $e^{ik_x x}$ 找到：\n$$\n\\hat{\\delta}_{xx,h}^2(k_x) = \\frac{e^{ik_x h} - 2 + e^{-ik_x h}}{h^2} = \\frac{2\\cos(k_x h) - 2}{h^2} = -\\frac{4}{h^2}\\sin^2\\left(\\frac{k_x h}{2}\\right)\n$$\n对于一个 $d$ 维网格，拉普拉斯算子的符号是各维度上符号的和：\n$$\n\\hat{\\nabla}_{h,2}^2(\\mathbf{k}) = \\sum_{a=1}^d \\left( -\\frac{4}{h^2}\\sin^2\\left(\\frac{k_a h}{2}\\right) \\right) = -\\frac{4}{h^2} \\sum_{a=1}^d \\sin^2\\left(\\frac{\\theta_a}{2}\\right)\n$$\n\n**四阶格式：**\n一维四阶中心差分算子是 $\\delta_{xx,h}^2 u(x) = \\frac{-u(x+2h) + 16u(x+h) - 30u(x) + 16u(x-h) - u(x-2h)}{12h^2}$。其符号为：\n$$\n\\hat{\\delta}_{xx,h}^2(k_x) = \\frac{-e^{i2k_x h} + 16e^{ik_x h} - 30 + 16e^{-ik_x h} - e^{-i2k_x h}}{12h^2} = \\frac{-2\\cos(2k_x h) + 32\\cos(k_x h) - 30}{12h^2}\n$$\n$d$ 维拉普拉斯算子的符号是：\n$$\n\\hat{\\nabla}_{h,4}^2(\\mathbf{k}) = \\sum_{a=1}^d \\frac{-2\\cos(2\\theta_a) + 32\\cos(\\theta_a) - 30}{12h^2}\n$$\n\n### 第 4 部分：相速度误差计算\n\n相对相速度误差定义为 $\\varepsilon = c_{\\mathrm{ph}}/c - 1$。\n$$\n\\varepsilon = \\frac{\\omega(\\mathbf{k})}{c \\|\\mathbf{k}\\|} - 1 = \\frac{\\sqrt{-\\hat{\\nabla}_h^2(\\mathbf{k})}}{\\|\\mathbf{k}\\|} - 1\n$$\n令 $\\|\\boldsymbol{\\theta}\\| = \\sqrt{\\sum \\theta_a^2} = \\sqrt{\\sum (k_a h)^2} = h\\|\\mathbf{k}\\|$。\n$$\n\\varepsilon = \\frac{h \\sqrt{-\\hat{\\nabla}_h^2(\\boldsymbol{\\theta})}}{\\|\\boldsymbol{\\theta}\\|} - 1\n$$\n此误差与物理波速 $c$ 无关，因此对于 P 波和 S 波是相同的。\n\n**对于二阶格式：**\n$$\n\\varepsilon_2 = \\frac{h \\sqrt{\\frac{4}{h^2} \\sum_{a=1}^d \\sin^2(\\frac{\\theta_a}{2})}}{\\|\\boldsymbol{\\theta}\\|} - 1 = \\frac{2 \\sqrt{\\sum_{a=1}^d \\sin^2(\\frac{\\theta_a}{2})}}{\\|\\boldsymbol{\\theta}\\|} - 1\n$$\n\n**对于四阶格式：**\n$$\n-\\hat{\\nabla}_{h,4}^2(\\mathbf{k}) = \\frac{1}{12h^2} \\sum_{a=1}^d (30 - 32\\cos(\\theta_a) + 2\\cos(2\\theta_a))\n$$\n$$\n\\varepsilon_4 = \\frac{h \\sqrt{\\frac{1}{12h^2} \\sum_{a=1}^d (30 - 32\\cos(\\theta_a) + 2\\cos(2\\theta_a))}}{\\|\\boldsymbol{\\theta}\\|} - 1 = \\frac{\\sqrt{\\frac{1}{12} \\sum_{a=1}^d (30 - 32\\cos(\\theta_a) + 2\\cos(2\\theta_a))}}{\\|\\boldsymbol{\\theta}\\|} - 1\n$$\n\n### 第 5 部分：应用于测试案例\n\n问题指定每波长 $N=10$ 个采样点 (PPW)。因此，无量纲波数大小为 $\\theta = \\|\\boldsymbol{\\theta}\\| = \\|\\mathbf{k}\\|h = \\frac{2\\pi}{\\lambda} h = \\frac{2\\pi}{\\lambda} (\\frac{\\lambda}{N}) = \\frac{2\\pi}{N}$。当 $N=10$ 时，我们有 $\\theta = \\pi/5$。分量为 $\\theta_a = \\theta \\hat{d}_a$，其中 $\\hat{\\mathbf{d}}$ 是传播方向矢量。\n\n**测试 A（一维，轴对齐）：** $\\hat{\\mathbf{d}}=[1]$, $d=1$。\n$\\theta_1 = \\pi/5$, $\\|\\boldsymbol{\\theta}\\| = \\pi/5$。\n- $\\varepsilon_{2,A} = \\frac{2 \\sin(\\pi/10)}{\\pi/5} - 1$\n- $\\varepsilon_{4,A} = \\frac{\\sqrt{\\frac{1}{12} (30 - 32\\cos(\\pi/5) + 2\\cos(2\\pi/5))}}{\\pi/5} - 1$\n\n**测试 B（二维，轴对齐）：** $\\hat{\\mathbf{d}}=[1, 0]$, $d=2$。\n$\\theta_1 = \\pi/5$, $\\theta_2 = 0$, $\\|\\boldsymbol{\\theta}\\| = \\pi/5$。\n- $\\varepsilon_{2,B} = \\frac{2 \\sqrt{\\sin^2(\\pi/10) + \\sin^2(0)}}{\\pi/5} - 1 = \\varepsilon_{2,A}$\n- 对于 $\\varepsilon_{4,B}$，当 $a=2$ ($\\theta_2=0$) 时，被加数为 $30 - 32\\cos(0) + 2\\cos(0) = 30-32+2=0$。求和化简为仅含 $a=1$ 的项，使其与一维情况相同。因此，$\\varepsilon_{4,B} = \\varepsilon_{4,A}$。\n\n**测试 C（二维，对角线方向）：** $\\hat{\\mathbf{d}}=[\\frac{1}{\\sqrt{2}}, \\frac{1}{\\sqrt{2}}]$, $d=2$。\n$\\theta_1 = \\theta_2 = \\frac{\\pi}{5\\sqrt{2}}$, $\\|\\boldsymbol{\\theta}\\| = \\pi/5$。\n- $\\varepsilon_{2,C} = \\frac{2 \\sqrt{2\\sin^2(\\frac{\\pi}{10\\sqrt{2}})}}{\\pi/5} - 1 = \\frac{2\\sqrt{2}\\sin(\\frac{\\pi}{10\\sqrt{2}})}{\\pi/5} - 1$\n- $\\varepsilon_{4,C} = \\frac{\\sqrt{\\frac{1}{12} \\cdot 2 \\cdot (30 - 32\\cos(\\frac{\\pi}{5\\sqrt{2}}) + 2\\cos(\\frac{2\\pi}{5\\sqrt{2}}))}}{\\pi/5} - 1$\n\n将实现这些公式来计算所需的数值。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the fractional phase velocity error for P and S waves\n    using 2nd- and 4th-order finite difference stencils for three test cases.\n    \"\"\"\n\n    def calculate_error(stencil_order, theta_vec, theta_norm):\n        \"\"\"\n        Calculates the fractional phase velocity error for a given stencil order and wavevector.\n\n        Args:\n            stencil_order (int): The order of the spatial stencil (2 or 4).\n            theta_vec (np.ndarray): The vector of non-dimensional wavenumbers (k_i * h).\n            theta_norm (float): The norm of the non-dimensional wavevector (||k|| * h).\n\n        Returns:\n            float: The fractional phase velocity error (c_ph/c - 1).\n        \"\"\"\n        if stencil_order == 2:\n            # Formula for the 2nd-order accurate stencil\n            sum_sin_sq = np.sum(np.sin(theta_vec / 2.0)**2)\n            # The numerator is the norm of the numerical wavevector\n            k_num_norm = 2.0 * np.sqrt(sum_sin_sq)\n            error = (k_num_norm / theta_norm) - 1.0\n        elif stencil_order == 4:\n            # Formula for the 4th-order accurate stencil\n            sum_cos_terms = np.sum(30.0 - 32.0 * np.cos(theta_vec) + 2.0 * np.cos(2.0 * theta_vec))\n            # The numerator is the norm of the numerical wavevector\n            k_num_norm = np.sqrt(sum_cos_terms / 12.0)\n            error = (k_num_norm / theta_norm) - 1.0\n        else:\n            raise ValueError(\"Stencil order must be 2 or 4.\")\n        \n        return error\n\n    # Common problem parameters\n    N = 10.0  # Points per wavelength\n    theta_norm = 2.0 * np.pi / N  # Non-dimensional wavenumber magnitude\n\n    # --- Test Case A: 1D, axis-aligned ---\n    dir_A = np.array([1.0])\n    theta_vec_A = theta_norm * dir_A\n    err_2_A = calculate_error(2, theta_vec_A, theta_norm)\n    err_4_A = calculate_error(4, theta_vec_A, theta_norm)\n\n    # --- Test Case B: 2D, axis-aligned ---\n    # Propagation along a grid axis in 2D is numerically identical to the 1D case.\n    dir_B = np.array([1.0, 0.0])\n    theta_vec_B = theta_norm * dir_B\n    err_2_B = calculate_error(2, theta_vec_B, theta_norm)\n    err_4_B = calculate_error(4, theta_vec_B, theta_norm)\n    \n    # --- Test Case C: 2D, diagonal ---\n    dir_C = np.array([1.0/np.sqrt(2), 1.0/np.sqrt(2)])\n    theta_vec_C = theta_norm * dir_C\n    err_2_C = calculate_error(2, theta_vec_C, theta_norm)\n    err_4_C = calculate_error(4, theta_vec_C, theta_norm)\n\n    # The fractional error is independent of wave type (P or S).\n    # Assemble the results in the specified single-line output format:\n    # [eps_P,2,A, eps_P,4,A, eps_S,2,A, eps_S,4,A,\n    #  eps_P,2,B, eps_P,4,B, eps_S,2,B, eps_S,4,B,\n    #  eps_P,2,C, eps_P,4,C, eps_S,2,C, eps_S,4,C]\n    results = [\n        err_2_A, err_4_A, err_2_A, err_4_A,\n        err_2_B, err_4_B, err_2_B, err_4_B,\n        err_2_C, err_4_C, err_2_C, err_4_C\n    ]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3612540"}]}