## 引言
在现代计算科学与工程领域，求解高阶[偏微分方程](@entry_id:141332)（PDEs）是一项普遍而又充满挑战的任务。传统的连续有限元方法在处理复杂几何与[自适应网格](@entry_id:164379)时面临限制，而间断Galerkin（DG）方法因其局部性、[高阶精度](@entry_id:750325)和处理复杂问题的灵活性而备受青睐。然而，将DG方法直接应用于二阶及更高阶的方程会遇到一个根本性难题：在分片不连续的[函数空间](@entry_id:143478)中，高阶导数没有良好定义，导致弱形式的构建变得困难。

本文聚焦于局部间断Galerkin（[LDG](@entry_id:751395)）方法中的一个核心思想——**辅助变量公式**，它为上述难题提供了优雅而强大的解决方案。该方法通过引入新的变量来表示原变量的导数，巧妙地将一个高阶PDE转化为一个耦合的[一阶系统](@entry_id:147467)。这一转化不仅是代数上的技巧，更是构建稳定、精确且高效数值格式的基石。本文旨在系统性地剖析这一方法，揭示其从理论构建到实际应用的完整图景。

在接下来的内容中，读者将踏上一段从基础到前沿的探索之旅。在“**原理与机制**”一章中，我们将深入探讨如何将PDE重构为一阶系统，如何设计保证稳定性和一致性的[数值通量](@entry_id:752791)，并分析其独特的[代数结构](@entry_id:137052)与超收敛等理论性质。随后，在“**应用与交叉学科联系**”一章中，我们将展示这一理论框架如何灵活地扩展到处理线性弹性、[非线性](@entry_id:637147)问题、计算流体力学和不确定性量化等多样化的复杂物理模型和交叉学科挑战。最后，通过“**动手实践**”部分，我们将理论与实践相结合，提供具体的计算问题，引导读者将所学知识应用于解决实际问题。通过这三章的学习，您将全面掌握[LDG](@entry_id:751395)辅助变量公式的精髓及其在现代科学计算中的强大威力。

## 原理与机制

本章旨在深入探讨局部间断Galerkin（[LDG](@entry_id:751395)）方法的核心原理与机制。作为一种强大的数值方法，[LDG](@entry_id:751395)通过引入辅助变量将高阶[偏微分方程](@entry_id:141332)转化为一阶[方程组](@entry_id:193238)，从而在间断有限元框架内进行求解。我们将系统性地阐释这一转化过程，分析其离散格式的构建，并探讨其稳定性、一致性、收敛性等关键理论性质。此外，我们还将讨论与[LDG方法](@entry_id:751397)相关的[代数结构](@entry_id:137052)、实际实现中的挑战，以及其在更广泛的间断Galerkin方法谱系中所处的位置。

### 将二阶方程重构为一阶系统

[局部间断Galerkin方法](@entry_id:751201)的基础在于将一个[二阶偏微分方程](@entry_id:175326)（PDE）转化为一个耦合的一阶PDE系统。这个过程不仅是代数上的技巧，更是方法本身设计的核心。对于标准的间断Galerkin方法，[弱形式](@entry_id:142897)中出现的[二阶导数](@entry_id:144508)项会带来困难，因为在分片非[连续函数空间](@entry_id:150395)中，这样的导数没有良好定义。通过引入辅助变量将导数阶数降低，我们便可以构建一个仅涉及一阶导数的、适定于间断Galerkin框架的弱形式。

我们以一个典型的标量[扩散](@entry_id:141445)问题作为范例进行阐述。考虑定义在有界Lipschitz区域 $\Omega \subset \mathbb{R}^d$ 上的二阶[椭圆方程](@entry_id:169190)：
$$
-\nabla \cdot (\kappa \nabla u) = f \quad \text{in } \Omega
$$
其中 $u$ 是待求的标量场（例如温度或浓度），$\kappa$ 是一个对称正定的[扩散张量](@entry_id:748421)，它可以是空间变化的，而 $f$ 是[源项](@entry_id:269111)。该方程通常附带适当的Dirichlet或[Neumann边界条件](@entry_id:142124)。

为了将此方程转化为[一阶系统](@entry_id:147467)，我们引入一个**辅助变量** $\mathbf{q}$，其物理意义通常与通量相关。一个直接的选择是定义 $\mathbf{q}$ 等于原始变量 $u$ 的梯度 [@problem_id:3364996]：
$$
\mathbf{q} = \nabla u
$$
将此定义代入原方程，我们得到以下两个耦合的一阶[方程组](@entry_id:193238)成的系统：
$$
\begin{cases}
\mathbf{q} - \nabla u = \mathbf{0}  \text{in } \Omega \\
-\nabla \cdot (\kappa \mathbf{q}) = f  \text{in } \Omega
\end{cases}
$$
这个一阶系统在足够光滑的解的意义下与原始的二阶方程是等价的。原始问题的边界条件也需要相应地转化为关于 $u$ 和 $\mathbf{q}$ 的条件。例如，[Dirichlet边界条件](@entry_id:142800) $u=g_D$ 保持不变，而[Neumann边界条件](@entry_id:142124) $\kappa\nabla u\cdot \mathbf{n}=g_N$ 则被重写为 $(\kappa \mathbf{q})\cdot \mathbf{n}=g_N$。

从[变分法](@entry_id:163656)的角度看，这种转化的有效性依赖于为 $(u, \mathbf{q})$ 选取恰当的函数空间。原始二阶问题的标准[弱形式](@entry_id:142897)求解的是 $u \in H^1(\Omega)$。对于这样的解 $u$，其梯度 $\nabla u$ 自然地属于 $(L^2(\Omega))^d$。因此，我们要求辅助变量 $\mathbf{q}$ 至少属于 $(L^2(\Omega))^d$。进一步，第二个方程 $-\nabla \cdot (\kappa \mathbf{q}) = f$ 表明，在 $f \in L^2(\Omega)$ 的假设下，$\kappa \mathbf{q}$ 的散度必须是 $L^2$ 可积的。这自然地将 $\kappa \mathbf{q}$（假设 $\kappa$ 是有界的）置于 $H(\operatorname{div}, \Omega)$ 空间中，该空间定义为：
$$
H(\operatorname{div}, \Omega) = \{ \mathbf{v} \in (L^2(\Omega))^d \,|\, \nabla \cdot \mathbf{v} \in L^2(\Omega) \}
$$
因此，为保证[一阶系统](@entry_id:147467)与二阶问题弱解的等价性，我们寻找的解对 $(u, \mathbf{q})$ 所属的函数空间为 $H^1(\Omega) \times H(\operatorname{div}, \Omega)$ [@problem_id:3364996]。这个选择确保了 $u$ 的迹和 $\mathbf{q}$ 的法向分量迹在边界上都是良定义的，从而使得边界条件可以被有意义地施加。

### 局部间断Galerkin离散格式

在将问题转化为[一阶系统](@entry_id:147467)后，[LDG方法](@entry_id:751397)在网格剖分 $\mathcal{T}_h$ 的每个单元 $K$ 上构建离散[弱形式](@entry_id:142897)。由于我们采用的函数空间是分片[多项式空间](@entry_id:144410)，函数在单元边界上是不连续的，这导致在应用[格林公式](@entry_id:173118)（[分部积分](@entry_id:136350)）时会出现界面项。[LDG方法](@entry_id:751397)的核心机制正是通过精心设计的**数值通量**（numerical fluxes）来处理这些界面项，从而将各个孤立的单元 “粘合” 起来。

在单元 $K$ 上，对一阶系统的两条方程分别乘以[检验函数](@entry_id:166589)并使用[分部积分](@entry_id:136350)，可以得到：
$$
\int_K \mathbf{q}_h \cdot \mathbf{r}_h \, dx + \int_K u_h (\nabla \cdot \mathbf{r}_h) \, dx - \int_{\partial K} \widehat{u} (\mathbf{r}_h \cdot \mathbf{n}) \, dS = 0
$$
$$
\int_K (\kappa \mathbf{q}_h) \cdot \nabla v_h \, dx - \int_{\partial K} (\widehat{\kappa \mathbf{q} \cdot \mathbf{n}}) v_h \, dS = \int_K f v_h \, dx
$$
其中 $(u_h, \mathbf{q}_h)$ 是离散解，$(v_h, \mathbf{r}_h)$ 是对应的离散[检验函数](@entry_id:166589)。关键在于出现在边界积分中的 $\widehat{u}$ 和 $\widehat{\kappa \mathbf{q} \cdot \mathbf{n}}$，它们分别是主变量和通量法向分量的数值通量。这些数值通量是定义在单元界面上的单值函数，其取值依赖于相邻单元的解的迹（即函数从单元内部趋近于边界的值）。

为了精确定义数值通量，我们引入**平均**（average）和**跳跃**（jump）算子。对于一个共享于单元 $K^-$ 和 $K^+$ 之间的内部界面 $F$，设 $\mathbf{n}$ 是一个固定的[单位法向量](@entry_id:178851)（例如，从 $K^-$ 指向 $K^+$）。对于一个[标量场](@entry_id:151443) $v$，其迹分别为 $v^-$ 和 $v^+$，我们定义：
- **平均**: $\{v\} = \frac{1}{2}(v^- + v^+)$
- **跳跃**: $[v] = v^+ - v^-$

对于矢量场 $\mathbf{w}$，这些算子可以类似地定义。[数值通量](@entry_id:752791)的设计是[LDG方法](@entry_id:751397)中最精妙的部分，它直接决定了方法的稳定性、精度和收敛性。一个常见且重要的通量选择是所谓的**交替通量**（alternating fluxes）[@problem_id:3365052] [@problem_id:3365074]。对于[扩散](@entry_id:141445)问题，一种典型的交替通量格式为：
$$
\widehat{u} = \{u_h\} + \frac{1}{2}(\boldsymbol{\beta} \cdot \mathbf{n}) [u_h]
$$
$$
\widehat{\kappa \mathbf{q} \cdot \mathbf{n}} = \{\kappa \mathbf{q}_h \cdot \mathbf{n}\} - \tau [u_h]
$$
这里的 $\boldsymbol{\beta}$ 是一个在整个网格上定义的**定向矢量**（orientation vector），通常取为分片常数。$\boldsymbol{\beta} \cdot \mathbf{n}$ 的符号决定了在计算 $\widehat{u}$ 时，我们是偏向于上游值还是下游值。$\tau \ge 0$ 是一个**稳定化参数**或**罚参数**，它的作用至关重要，我们将在下一节详细讨论。

### 核心性质：稳定性与一致性

一个[数值格式](@entry_id:752822)要成为一个可靠的计算工具，必须具备两个基本属性：一致性和稳定性。

**一致性**（Consistency）指的是，如果将方程的精确光滑解代入离散格式，离散方程应该能够被精确满足。对于[LDG方法](@entry_id:751397)，这意味着当 $u$ 是光滑解时，数值通量 $\widehat{u}$ 和 $\widehat{\kappa \mathbf{q} \cdot \mathbf{n}}$ 必须分别收敛到 $u$ 和 $\kappa \nabla u \cdot \mathbf{n}$。我们上面给出的通量选择是自洽的，因为对于光滑解，$u$ 的跳跃 $[u]$ 为零，因此 $\widehat{u} = \{u\} = u$ 且 $\widehat{\kappa \mathbf{q} \cdot \mathbf{n}} = \{\kappa \mathbf{q} \cdot \mathbf{n}\} = \kappa \nabla u \cdot \mathbf{n}$。

**稳定性**（Stability），或称**离散矫顽性**（Discrete Coercivity），是确保离散问题具有唯一解且解的范数受数据范数控制的关键性质。在间断Galerkin方法中，由于[解空间](@entry_id:200470)的不连续性，稳定性并非自然获得，而必须通过巧妙的[数值通量](@entry_id:752791)设计来保证。

对于[椭圆问题](@entry_id:146817)，稳定性通常通过证明离散[双线性形式](@entry_id:746794) $a_h(\cdot, \cdot)$ 在某个网格依赖的能量范数 $\|\cdot\|_E$ 下是矫顽的来建立，即存在一个与网格尺寸 $h$ 和多项式次数 $p$ 无关的常数 $c>0$，使得 $a_h(u_h, u_h) \ge c \|u_h\|_E^2$ 对所有离散函数 $u_h$ 成立。这个能量范数通常包含单元内部的梯度范数和界面上的解的跳跃范数 [@problem_id:3420971]：
$$
\|u_h\|_{E}^2 = \sum_{K \in \mathcal{T}_h} \kappa \|\nabla u_h\|_{L^2(K)}^2 + \sum_{F \in \mathcal{F}_h} \tau_F \|[u_h]\|_{L^2(F)}^2
$$
其中 $\mathcal{F}_h$ 是网格中所有界面的集合。

在[LDG方法](@entry_id:751397)中，通量 $\widehat{\kappa \mathbf{q} \cdot \mathbf{n}}$ 中的罚项 $-\tau [u_h]$ 正是实现稳定性的关键。在能量分析中，这一项会产生一个正定的边界积分项 $\sum_F \int_F \tau [u_h]^2 \, dS$。这个项控制了分片多项式解在界面上的跳跃。为了确保整个[双线性形式](@entry_id:746794)是正定的，罚参数 $\tau$ 必须足够大，以抵消由[分部积分](@entry_id:136350)产生的其他可能为负的边界项。通过使用[迹不等式](@entry_id:756082)（trace inequality），可以证明，为保证稳定性，罚参数 $\tau_F$ 的尺度必须与 $\kappa \frac{p^2}{h_F}$ 成正比，其中 $h_F$ 是界面 $F$ 的尺寸，$p$ 是多项式次数 [@problem_id:3420971]。这个缩放关系直观地反映了，当网格变细（$h_F \to 0$）或多项式次数增加（$p$ 变大）时，多项式在边界上的迹相对于其在单元内部的值会变得更大，因此需要更强的惩罚来控制跳跃。

对于自伴（对称）的[椭圆算子](@entry_id:181616)，我们还期望离散格式能反映这种对称性。这就是**伴随一致性**（Adjoint Consistency）的概念 [@problem_id:3365037]。对于[LDG方法](@entry_id:751397)，这意味着其产生的双线性形式应当是对称的，并且当用光滑函数检验时，它能精确地再现连续的[格林公式](@entry_id:173118)，而不会在内部界面上留下额外的[余项](@entry_id:159839)。这要求[数值通量](@entry_id:752791)的设计必须同时满足对称性和一致性。例如，一个对称的罚项，如 $\tau[u_h]$，当与[检验函数](@entry_id:166589) $v_h$ 的跳跃 $[v_h]$ 相乘时，会产生对称项 $\tau [u_h][v_h]$。同时，由于[光滑函数](@entry_id:267124)的跳跃为零，该罚项不会破坏格式的一致性。交替通量中的定向矢量 $\boldsymbol{\beta}$ 的作用也与此相关，通过在网格上协调地选择“上游”和“下游”，可以构建出具有伴随一致性的[离散梯度](@entry_id:171970)和[散度算子](@entry_id:265975)。

### 高等主题与实际应用

[LDG方法](@entry_id:751397)的理论优雅性也带来了实际的计算优势和一些需要注意的实现细节。

#### 超收敛与后处理

[LDG方法](@entry_id:751397)的一个显著优点是其解具有**超收敛**（superconvergence）性质。这意味着虽然离散解 $u_h$ 本身在 $L^2$ 范数下的[收敛阶](@entry_id:146394)为 $\mathcal{O}(h^{k+1})$（其中 $k$ 是多项式次数），但通过一个简单的、局部的**后处理**（post-processing）步骤，可以构造出一个新的解 $u_h^\star$，其收敛阶能达到 $\mathcal{O}(h^{k+2})$ [@problem_id:3365042]。

这种现象的理论基础是伴随一致性和一个精巧的对偶分析（Aubin-Nitsche技巧）。证明过程需要构造一个离散的对偶问题（dual problem）。这个[对偶问题](@entry_id:177454)的源项是原始问题的误差 $u-u_h$。为了使对偶论证有效，离散对偶算子必须是离散原始算子的伴随。对于采用交替通量的L[DG格式](@entry_id:178043)，其伴随一致的对偶问题格式需要在数值通量中“反转”交替方向。例如，如果原始问题的通量 $\widehat{u}$ 取自 $K^-$ 单元的值，则对偶问题的通量 $\widehat{z}$ 必须取自 $K^+$ 单元的值 [@problem_id:3365042]。正是这种伴随一致的结构，使得误差与某个特定[子空间](@entry_id:150286)高度正交，从而可以通过局部求解一个[Neumann问题](@entry_id:176713)来重构出一个更高精度的解。

#### [代数结构](@entry_id:137052)与[静态凝聚](@entry_id:176722)

从代数的角度看，[LDG方法](@entry_id:751397)产生一个耦合 $(u_h, \mathbf{q}_h)$ 的[大型稀疏线性系统](@entry_id:137968)。该系统可以写成[分块矩阵](@entry_id:148435)的形式 [@problem_id:3365028] [@problem_id:3365082]：
$$
\begin{pmatrix} A  B^T \\ B  C \end{pmatrix} \begin{pmatrix} \mathbf{u} \\ \mathbf{q} \end{pmatrix} = \begin{pmatrix} \mathbf{f} \\ \mathbf{g} \end{pmatrix}
$$
这里 $\mathbf{u}$ 和 $\mathbf{q}$ 分别是 $u_h$ 和 $\mathbf{q}_h$ 的全局自由度向量。这些矩阵块具有特殊的[稀疏结构](@entry_id:755138)。由于辅助变量 $\mathbf{q}_h$ 的离散方程（源于 $\mathbf{q} - \nabla u = \mathbf{0}$）通常只包含单元内部的质量矩阵项，矩阵 $C$ 是块对角的，每个块对应一个网格单元。

这个[块对角结构](@entry_id:746869)是[LDG方法](@entry_id:751397)的一个关键代数特征。它允许我们通过**[静态凝聚](@entry_id:176722)**（static condensation）在单元层面局部地消除辅助变量 $\mathbf{q}$。从第一行方程，我们可以形式上写出 $\mathbf{q} = C^{-1}(\mathbf{g} - B \mathbf{u})$。由于 $C$ 是块对角的，求逆 $C^{-1}$ 相当于在每个单元上求解一个小的[线性系统](@entry_id:147850)。将此表达式代入第二行方程，我们得到一个只包含主变量 $\mathbf{u}$ 的全局系统，其矩阵是原系统的**舒尔补**（Schur complement）：
$$
(A - B^T C^{-1} B) \mathbf{u} = \mathbf{f} - B^T C^{-1} \mathbf{g}
$$
这个过程将一个较大的[鞍点问题](@entry_id:174221)转化为了一个较小的[对称正定](@entry_id:145886)问题（对于合适的通量选择）。然而，代价是舒尔补矩阵 $(A - B^T C^{-1} B)$ 通常比原始矩阵 $A$ 更稠密。尽管原始DG矩阵只耦合共享界面的单元，[舒尔补](@entry_id:142780)矩阵会引入额外的耦合，即一个单元的自由度会与其“邻居的邻居”耦合，导致了**填充**（fill-in）[@problem_id:3365082]。尽管如此，得到的矩阵仍然是稀疏的，并且其规模大大减小，这对于[迭代求解器](@entry_id:136910)的性能有重要影响。

#### 可变系数的处理

当[扩散](@entry_id:141445)系数 $\kappa(x)$ 在单元内部剧烈变化时，一个常见的实现陷阱是[数值积分误差](@entry_id:137490)。在[弱形式](@entry_id:142897)中，我们会遇到诸如 $\int_K \kappa(x) \mathbf{q}_h(x) \cdot \mathbf{r}_h(x) \, dx$ 这样的积分。即使我们使用对多项式积分精确的高斯求积法则，由于 $\kappa(x)$ 不是多项式，被积函数 $\kappa(x) \mathbf{q}_h \cdot \mathbf{r}_h$ 也不是多项式，因此数值积分会产生**混淆误差**（aliasing error）。如果 $\kappa(x)$ 的变化未被网格充分解析，这个[积分误差](@entry_id:171351)可能不会随着[网格加密](@entry_id:168565)而充分减小，从而破坏方法的高阶收敛性 [@problem_id:3364993]。

一个优雅的解决方案是，在积分之前，先将被积函数中包含非[多项式系数](@entry_id:262287)的部分投影到[多项式空间](@entry_id:144410)中。例如，我们可以将 $\kappa \mathbf{q}_h$ 替换为其在多项式空间 $\mathcal{P}_k(K)$ 上的 $L^2$ 投影 $\Pi_k(\kappa \mathbf{q}_h)$。修改后的积分为 $\int_K \Pi_k(\kappa \mathbf{q}_h) \cdot \mathbf{r}_h \, dx$。由于现在被积函数是两个多项式的乘积，高斯求积可以精确地计算它，从而消除了混淆误差。更重要的是，由于 $L^2$ 投影的正交性，$(\kappa \mathbf{q}_h - \Pi_k(\kappa \mathbf{q}_h), \mathbf{r}_h)_K = 0$ 对于所有[检验函数](@entry_id:166589) $\mathbf{r}_h \in \mathcal{P}_k(K)$ 都成立。这意味着 $(\kappa \mathbf{q}_h, \mathbf{r}_h)_K = (\Pi_k(\kappa \mathbf{q}_h), \mathbf{r}_h)_K$。因此，这种修改在代数上是等价的，它没有改变原始的[弱形式](@entry_id:142897)，只是将其转化为一种可以被精确积分的形式，从而恢复了方法的最优收敛阶 [@problem_id:3364993]。

#### 方法比较：[LDG](@entry_id:751395)与HDG

[LDG方法](@entry_id:751397)是众多[间断Galerkin方法](@entry_id:748369)中的一员。为了更好地理解其特点，与**可杂交间断Galerkin（HDG）**方法进行比较是很有启发性的 [@problem_id:3365045]。[HDG方法](@entry_id:170956)将[静态凝聚](@entry_id:176722)的思想推向了极致。它引入了一个新的全局未知量，即解在网格骨架（所有界面的集合）上的迹 $\widehat{u}_h$。然后，它将每个单元内部的未知量 $(u_h, \mathbf{q}_h)$ 完全用界面未知量 $\widehat{u}_h$ 表示。通过这种方式，所有单元内部的自由度都可以在单元层面被[静态凝聚](@entry_id:176722)掉，最终得到一个只涉及界面自由度 $\widehat{u}_h$ 的全局线性系统。

与[LDG](@entry_id:751395)相比，HDG的主要优势在于：
1.  **更小的全局系统**：HDG的全局系统规模仅取决于界面上的自由度数，其[数量级](@entry_id:264888)为 $\mathcal{O}(N_f k^{d-1})$（其中 $N_f$ 是界面数），而[LDG](@entry_id:751395)（即使在消去 $\mathbf{q}_h$ 后）的系统规模取决于单元内部的自由度数，[数量级](@entry_id:264888)为 $\mathcal{O}(N_{el} k^d)$（其中 $N_{el}$ 是单元数）。对于高阶多项式（大 $k$），HDG的计算成本优势巨大。
2.  **边界条件施加**：[HDG方法](@entry_id:170956)中，[Dirichlet边界条件](@entry_id:142800)可以直接施加在界面未知量 $\widehat{u}_h$ 上，非常自然。

两种方法都具有相似的超收敛性质，并且都可以通过后处理获得更高精度的解。[LDG](@entry_id:751395)的优势可能在于其概念相对更直接，并且在某些情况下，其实现可能更简单。理解这两种方法的关系，有助于我们认识到辅助变量和[静态凝聚](@entry_id:176722)是设计高效[DG格式](@entry_id:178043)的两个强大而灵活的工具。