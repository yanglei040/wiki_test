{"hands_on_practices": [{"introduction": "在任何DG方法的实现中，多项式基的选择都是一个基础性决策。本练习通过推导基本单元质量矩阵和刚度矩阵的结构，来探讨在模态（正交）基和节点基之间进行选择的实际后果，并揭示了获得对角质量矩阵等关键属性的条件。理解这些矩阵结构是构建高效DG求解器的关键 [@problem_id:3378044]。", "problem": "考虑一维参考单元 $I = [-1,1]$ 以及最高次数为 $k \\in \\mathbb{N}$ 的多项式空间 $V_h^k = \\mathbb{P}^k(I)$。我们将比较 $V_h^k$ 的两种单元多项式基：一种是由正交归一的 Legendre 多项式定义的模态基，另一种是由通过求积节点的 Lagrange 多项式定义的节点基。背景是热方程和 Poisson 方程的间断 Galerkin (DG) 离散化，其中主要的局部双线性形式涉及单元质量矩阵和单元刚度矩阵。研究工作在单个单元上进行，不包括界面通量的贡献。\n\n从以下基本定义、性质和构造出发：\n- $[-1,1]$ 上的经典 Legendre 多项式 $\\{P_n(r)\\}_{n=0}^\\infty$ 满足 $\\int_{-1}^{1} P_n(r) P_m(r)\\,dr = \\frac{2}{2n+1}\\,\\delta_{nm}$。\n- 正交归一的 Legendre 基定义为 $\\phi_n(r) = \\sqrt{\\frac{2n+1}{2}}\\,P_n(r)$，因此对于 $0 \\le n,m \\le k$ 有 $\\int_{-1}^{1} \\phi_n(r)\\,\\phi_m(r)\\,dr = \\delta_{nm}$。\n- 给定 $N_p = k+1$ 个不同的节点 $\\{\\xi_i\\}_{i=1}^{N_p} \\subset [-1,1]$，节点 Lagrange 基 $\\{\\ell_i(r)\\}_{i=1}^{N_p}$ 由 $\\ell_i(\\xi_j) = \\delta_{ij}$ 定义，并张成 $\\mathbb{P}^k(I)$。\n- 对于 Gauss–Legendre (GL) 节点，存在正权重 $\\{w_i\\}_{i=1}^{N_p}$，使得对于次数最高为 $2N_p-1$ 的所有多项式 $f$，$\\sum_{i=1}^{N_p} w_i\\,f(\\xi_i) = \\int_{-1}^{1} f(r)\\,dr$ 精确成立。\n- 对于 Gauss–Lobatto–Legendre (GLL) 节点，存在正权重 $\\{w_i\\}_{i=1}^{N_p}$，使得对于次数最高为 $2N_p-3$ 的所有多项式 $f$，$\\sum_{i=1}^{N_p} w_i\\,f(\\xi_i) = \\int_{-1}^{1} f(r)\\,dr$ 精确成立。\n- 在从参考单元到物理单元 $K = [x_L,x_R]$ 的仿射映射 $x(r) = x_c + \\frac{h}{2}\\,r$（其中 $x_c = \\frac{x_L+x_R}{2}$，$h = x_R - x_L$）下，雅可比行列式为 $J = \\frac{dx}{dr} = \\frac{h}{2}$，导数变换关系为 $\\frac{d}{dx} = \\frac{2}{h}\\frac{d}{dr}$。\n\n任务：\n1. 仅使用上述定义和 Legendre 多项式的正交性，推导在模态基 $\\{\\phi_n\\}_{n=0}^{k}$ 下参考单元 $I$ 上的单元质量矩阵和单元刚度矩阵，其中质量内积为 $\\int_{-1}^{1} (\\cdot)\\,(\\cdot)\\,dr$，刚度内积为 $\\int_{-1}^{1} \\frac{d}{dr}(\\cdot)\\,\\frac{d}{dr}(\\cdot)\\,dr$。说明每个矩阵是否为对角矩阵，并从第一性原理出发证明你的答案。\n2. 在节点基 $\\{\\ell_i\\}_{i=1}^{N_p}$ 下重复推导，并考虑两种节点选择：Gauss–Legendre 和 Gauss–Lobatto–Legendre。使用相应求积法则的精确性，推断在对被积函数足够精确的求积下，单元质量矩阵何时为对角矩阵。用求积点上的求值矩阵和权重表示质量矩阵和刚度矩阵，并解释精确性在每种情况下的作用。\n3. 通过上述仿射映射，将你的表达式映射到物理单元 $K$ 上，并推导将参考单元矩阵与物理单元矩阵联系起来的显式缩放因子，这些因子适用于热方程和 Poisson 方程相关的质量和刚度双线性形式。\n\n最后，用一个单一的封闭形式解析表达式回答以下明确问题。在一个长度为 $h$ 的物理单元上，使用位于 Gauss–Legendre 节点的节点 Lagrange 基，并采用精确的 Gauss–Legendre 求积，单元质量矩阵的每个对角线元素 $M_{ii}$ 的表达式是什么？你的最终答案必须是单一的解析表达式，且不能包含任何单位。无需四舍五入。", "solution": "该问题被评估为有效，因为它在科学上基于偏微分方程数值方法的理论，问题陈述清晰，具有一组明确且一致的定义和目标，并且没有任何主观或模糊的语言。我们可以开始求解。\n\n解决方案分为三个部分，对应于问题陈述中列出的三个任务，然后是最终答案的推导。\n\n**1. 在模态基中的分析**\n\n模态基由参考单元 $I = [-1, 1]$ 上的一组正交归一的 Legendre 多项式 $\\{\\phi_n(r)\\}_{n=0}^{k}$ 给出。该基的定义属性是其关于 $L^2$ 内积的正交归一性：\n$$\n\\int_{-1}^{1} \\phi_n(r) \\phi_m(r) \\,dr = \\delta_{nm}\n$$\n其中 $\\delta_{nm}$ 是 Kronecker delta。基函数的索引从 $n=0$ 到 $k$。\n\n参考单元上的单元质量矩阵，记作 $M^I$，其元素为 $M_{nm}$（$0 \\le n,m \\le k$）。其元素由基函数的内积定义：\n$$\nM_{nm} = \\int_{-1}^{1} \\phi_n(r) \\phi_m(r) \\,dr\n$$\n直接应用基的正交归一性，我们发现：\n$$\nM_{nm} = \\delta_{nm}\n$$\n这意味着在正交归一的模态基中，质量矩阵是单位矩阵，$M^I = I$。根据定义，单位矩阵是对角矩阵。\n\n参考单元上的单元刚度矩阵，记作 $S^I$，其元素 $S_{nm}$ 由基函数导数的内积定义：\n$$\nS_{nm} = \\int_{-1}^{1} \\frac{d\\phi_n}{dr}(r) \\frac{d\\phi_m}{dr}(r) \\,dr\n$$\n为了确定该矩阵是否为对角矩阵，我们考察其非对角元素，其中 $n \\ne m$。基函数 $\\phi_n(r)$ 是一个 $n$ 次多项式，其导数 $\\frac{d\\phi_n}{dr}$ 是一个 $n-1$ 次多项式。Legendre 多项式 $P_n(r)$ 的奇偶性为 $(-1)^n$。由于 $\\phi_n(r)$ 是 $P_n(r)$ 的标量倍，它具有相同的奇偶性。具有给定奇偶性的函数的导数具有相反的奇偶性。因此，$\\frac{d\\phi_n}{dr}$ 的奇偶性为 $(-1)^{n-1}$。被积函数是乘积 $\\frac{d\\phi_n}{dr} \\frac{d\\phi_m}{dr}$，其奇偶性为 $(-1)^{n-1}(-1)^{m-1} = (-1)^{n+m-2}$。如果 $n$ 和 $m$ 的奇偶性不同（一个偶数，一个奇数），则 $n+m$ 是奇数，$n+m-2$ 也是奇数，被积函数是奇函数。奇函数在对称区间 $[-1, 1]$ 上的积分为零。因此，如果 $n$ 和 $m$ 的奇偶性不同，$S_{nm} = 0$。\n\n然而，这并不能保证矩阵是对角矩阵。考虑一个非对角元素，其中 $n$ 和 $m$ 具有相同的奇偶性（例如，$n=2, m=0$，或 $n=3, m=1$）。对于 $n=0$，$\\phi_0(r)$ 是一个常数，所以 $\\frac{d\\phi_0}{dr} = 0$。这意味着对于所有的 $m$，$S_{0m} = S_{m0} = 0$。对于 $n, m > 0$ 且具有相同奇偶性且 $n \\ne m$ 的情况，被积函数是一个非零的偶函数，积分通常不为零。例如，对于 $k \\ge 3$，元素 $S_{13}$ 通常不为零。因此，刚度矩阵 $S^I$ 不是对角矩阵。\n\n**2. 在节点基中的分析**\n\n节点基由次数为 $k=N_p-1$ 的 Lagrange 多项式 $\\{\\ell_i(r)\\}_{i=1}^{N_p}$ 给出，在一组 $N_p$ 个不同节点 $\\{\\xi_j\\}_{j=1}^{N_p}$ 上由条件 $\\ell_i(\\xi_j) = \\delta_{ij}$ 定义。\n\n单元质量矩阵的元素为 $M_{ij} = \\int_{-1}^{1} \\ell_i(r) \\ell_j(r) \\,dr$。被积函数 $\\ell_i(r) \\ell_j(r)$ 是一个次数最高为 $k+k = 2k = 2(N_p-1) = 2N_p - 2$ 的多项式。我们使用具有节点 $\\{\\xi_p\\}_{p=1}^{N_p}$ 和权重 $\\{w_p\\}_{p=1}^{N_p}$ 的求积法则来近似这个积分：\n$$\nM_{ij} \\approx \\sum_{p=1}^{N_p} w_p \\ell_i(\\xi_p) \\ell_j(\\xi_p) = \\sum_{p=1}^{N_p} w_p \\delta_{ip} \\delta_{jp}\n$$\n仅当 $p=i$ 且 $p=j$ 时，即 $i=j$ 时，该和才非零。这给出：\n$$\nM_{ij} \\approx w_i \\delta_{ij}\n$$\n这种近似，称为质量集中，总能得到一个对角矩阵。问题是这个结果何时是精确的。\n\n- **Gauss–Legendre (GL) 节点：** 相应的求积法则对次数最高为 $2N_p-1$ 的多项式是精确的。由于被积函数的次数是 $2N_p-2$，它小于或等于 $2N_p-1$，所以求积是精确的。因此，对于在 GL 节点上构造的节点基，单元质量矩阵是精确对角的：$M_{ij} = w_i \\delta_{ij}$，其中 $\\{w_i\\}$ 是 GL 求积权重。\n\n- **Gauss–Lobatto–Legendre (GLL) 节点：** 相应的求积法则对次数最高为 $2N_p-3$ 的多项式是精确的。被积函数的次数是 $2N_p-2$。由于 $2N_p-2 > 2N_p-3$，求积法则对于非对角项通常不精确。因此，对于在 GLL 节点上构造的节点基，精确的质量矩阵不是对角的。集中的质量矩阵 $M_{ij} = w_i \\delta_{ij}$（其中 $\\{w_i\\}$ 是 GLL 权重）是一种近似。\n\n单元刚度矩阵的元素为 $S_{ij} = \\int_{-1}^{1} \\frac{d\\ell_i}{dr}(r) \\frac{d\\ell_j}{dr}(r) \\,dr$。被积函数 $\\frac{d\\ell_i}{dr} \\frac{d\\ell_j}{dr}$ 是一个次数最高为 $(k-1) + (k-1) = 2k-2 = 2N_p-4$ 的多项式。\n\n- **GL 求积：** 精确度高达 $2N_p-1$ 次。由于 $2N_p-4 \\le 2N_p-1$，求积是精确的。\n- **GLL 求积：** 精确度高达 $2N_p-3$ 次。由于 $2N_p-4 \\le 2N_p-3$，求积也是精确的。\n\n在这两种情况下，刚度矩阵都可以使用相应的求积法则精确计算：\n$$\nS_{ij} = \\sum_{p=1}^{N_p} w_p \\frac{d\\ell_i}{dr}(\\xi_p) \\frac{d\\ell_j}{dr}(\\xi_p)\n$$\n令 $D$ 为微分矩阵，其元素为 $D_{pi} = \\frac{d\\ell_i}{dr}(\\xi_p)$，令 $W$ 为权重对角矩阵，其元素为 $W_{pp} = w_p$。刚度矩阵可以写为 $S^I = D^T W D$。通常，当 $i \\ne p$ 时，元素 $\\frac{d\\ell_i}{dr}(\\xi_p)$ 不为零。因此，微分矩阵 $D$ 不是对角的，因此，对于这两种节点选择，刚度矩阵 $S^I$ 都不是对角的。\n\n**3. 映射到物理单元**\n\n令 $K=[x_L, x_R]$ 为一个长度为 $h=x_R-x_L$ 的物理单元。从参考单元 $I=[-1,1]$ 的仿射映射为 $x(r) = x_c + \\frac{h}{2}r$，其中 $x_c = \\frac{x_L+x_R}{2}$。该变换的雅可比行列式是 $J = \\frac{dx}{dr} = \\frac{h}{2}$。关于 $x$ 的导数与关于 $r$ 的导数的关系为 $\\frac{d}{dx} = \\frac{dr}{dx} \\frac{d}{dr} = (\\frac{h}{2})^{-1} \\frac{d}{dr} = \\frac{2}{h} \\frac{d}{dr}$。\n\n令 $\\chi_i(r)$ 为参考单元上的基函数，$\\psi_i(x)$ 为物理单元上对应的基函数，使得 $\\psi_i(x(r)) = \\chi_i(r)$。\n\n物理单元质量矩阵 $M^K$ 的元素为：\n$$\nM_{ij}^K = \\int_{K} \\psi_i(x) \\psi_j(x) \\,dx\n$$\n变量变换到参考坐标 $r$：\n$$\nM_{ij}^K = \\int_{-1}^{1} \\psi_i(x(r)) \\psi_j(x(r)) \\frac{dx}{dr} \\,dr = \\int_{-1}^{1} \\chi_i(r) \\chi_j(r) \\left(\\frac{h}{2}\\right) \\,dr = \\frac{h}{2} \\int_{-1}^{1} \\chi_i(r) \\chi_j(r) \\,dr\n$$\n这给出了关系 $M_{ij}^K = \\frac{h}{2} M_{ij}^I$。质量矩阵的缩放因子是 $\\frac{h}{2}$。\n\n物理单元刚度矩阵 $S^K$ 的元素为：\n$$\nS_{ij}^K = \\int_{K} \\frac{d\\psi_i}{dx}(x) \\frac{d\\psi_j}{dx}(x) \\,dx\n$$\n变量变换：\n$$\nS_{ij}^K = \\int_{-1}^{1} \\left(\\frac{2}{h} \\frac{d\\chi_i}{dr}(r)\\right) \\left(\\frac{2}{h} \\frac{d\\chi_j}{dr}(r)\\right) \\left(\\frac{h}{2}\\right) \\,dr = \\frac{4}{h^2} \\frac{h}{2} \\int_{-1}^{1} \\frac{d\\chi_i}{dr}(r) \\frac{d\\chi_j}{dr}(r) \\,dr\n$$\n这给出了关系 $S_{ij}^K = \\frac{2}{h} S_{ij}^I$。刚度矩阵的缩放因子是 $\\frac{2}{h}$。\n\n**最终答案推导**\n\n问题要求在一个长度为 $h$ 的物理单元上，使用位于 Gauss–Legendre 节点的节点 Lagrange 基，并采用精确的 Gauss–Legendre 求积时，单元质量矩阵的对角元素 $M_{ii}$ 的表达式。\n\n从第 2 部分，我们确定了对于在 GL 节点上的 Lagrange 基，参考单元质量矩阵 $M^I$ 是对角的，其元素为 $M_{ij}^I = w_i \\delta_{ij}$。因此，对角元素为 $M_{ii}^I = w_i$，其中 $w_i$ 是第 $i$ 个 GL 求积权重。\n\n从第 3 部分，我们发现物理单元质量矩阵 $M^K$ 通过缩放因子 $\\frac{h}{2}$ 与参考矩阵相关联。因此，$M_{ij}^K = \\frac{h}{2} M_{ij}^I$。\n\n结合这些结果，物理质量矩阵的对角元素为：\n$$\nM_{ii}^K = \\frac{h}{2} M_{ii}^I = \\frac{h}{2} w_i\n$$\n这是每个对角元素所需的单一封闭形式解析表达式，其中 $w_i$ 表示与第 $i$ 个 Gauss-Legendre 节点对应的第 $i$ 个求积权重。", "answer": "$$\\boxed{\\frac{h w_i}{2}}$$", "id": "3378044"}, {"introduction": "让我们将分析从静态问题扩展到瞬态现象。本练习演示了由对称内部罚Galerkin(SIPG)刚度矩阵和质量矩阵构成的空间离散算子的性质如何决定整个系统的稳定性。通过进行离散傅里叶分析，您将计算半离散热方程算子的谱半径，这是确定显式时间积分方案最大稳定时间步长的关键一步 [@problem_id:3378059]。", "problem": "考虑周期区间 $[0,L]$ 上的一维热方程 $u_{t} = \\kappa \\, u_{xx}$，其中热扩散系数 $\\kappa \\equiv 1$。使用对称内部罚Galerkin(SIPG)方法，在具有 $N$ 个单元（大小为 $h = L/N$）的均匀网格上对空间算子进行离散化。在每个单元上使用分片常数多项式（次数 $k=0$），并采用典型的单元基。设标准的SIPG双线性形式由面上的跳跃罚分公式定义，罚系数为 $(\\tau/h)$，其中 $\\tau>0$ 是无量纲的。设半离散系统以矩阵形式写作 $M \\, \\dot{U}(t) = -A \\, U(t)$，其中 $M$ 是质量矩阵，$A$ 是SIPG刚度矩阵。假设周期性边界条件和典型的跳跃方向，使得组装后的 $A$ 是一个循环矩阵。\n\n在均匀网格上使用离散傅里叶分析，推导当 $k=0$ 时SIPG算子的广义特征问题 $A \\, \\Phi = \\lambda \\, M \\, \\Phi$ 的精确特征值，并说明谱半径如何依赖于 $h$ 和罚参数 $\\tau$。然后，采用常用的与次数相关的罚尺度 $\\tau = c \\, (k+1)^{2}$，其中 $c>0$ 且独立于 $h$ 和 $k$，并将谱半径表示为关于 $k$ 和 $h$ 的闭式解析函数。\n\n你的最终答案必须是谱半径关于 $c$、$k$ 和 $h$ 的单个闭式解析表达式，不带单位。不要提供不等式。不需要四舍五入。", "solution": "### 步骤 1：提取已知条件\n- **方程**: 一维热方程 $u_{t} = \\kappa \\, u_{xx}$，热扩散系数 $\\kappa = 1$。\n- **区域**: 周期区间 $[0,L]$。\n- **离散化方法**: 对称内部罚Galerkin(SIPG)。\n- **网格**: 均匀网格，有 $N$ 个单元，大小为 $h = L/N$。\n- **多项式次数**: 分片常数多项式, $k=0$。\n- **基**: 典型的单元基。\n- **双线性形式**: 面上的跳跃罚分公式，罚系数为 $(\\tau/h)$，其中 $\\tau>0$ 是无量纲的。\n- **半离散系统**: $M \\, \\dot{U}(t) = -A \\, U(t)$，其中 $M$ 是质量矩阵，$A$ 是SIPG刚度矩阵。\n- **边界条件**: 周期性，导致 $A$ 为循环矩阵。\n- **任务1**: 使用离散傅里叶分析，推导当 $k=0$ 时广义特征问题 $A \\, \\Phi = \\lambda \\, M \\, \\Phi$ 的特征值。\n- **任务2**: 说明谱半径如何依赖于 $h$ 和 $\\tau$。\n- **任务3**: 采用罚尺度 $\\tau = c \\, (k+1)^{2}$，其中 $c>0$。\n- **任务4**: 将谱半径表示为关于 $k$ 和 $h$ 的闭式解析函数。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题在数学上和科学上都是良定义的。它描述了偏微分方程数值分析中的一个标准过程：离散化算子的谱分析。所使用的所有术语（SIPG、循环矩阵、离散傅里叶分析、广义特征问题）都是间断Galerkin方法领域的标准术语。\n\n该问题是：\n- **科学依据**：热方程是一个基础模型，而SIPG是一种成熟的数值方法。对其谱特性的分析是一个标准且有意义的科学问题。\n- **良构的**：问题陈述清晰，并提供了推导唯一数学结果所需的所有信息。设置（均匀周期网格，$k=0$）导致一个良定义的矩阵特征问题。\n- **客观的**：语言精确，没有主观论断。\n\n一个微妙之处在于，对于 $k=0$ 次多项式的标准SIPG公式（将在解题步骤中详述），其结果是 $u_t = \\tau u_{xx}$ 的一致离散化，而不是 $u_t = u_{xx}$（因为给定 $\\kappa=1$）。这是该特定格式的一个已知特性。然而，这并不会使问题无效。问题要求对*所定义的*算子进行谱分析，这是一个有效的数学问题，而不管其对于任意 $\\tau$ 是否与原始物理参数一致。因此，该问题是自洽且内部一致的。\n\n该问题有效。\n\n### 步骤 3：结论与行动\n该问题有效。我将继续进行解答。\n\n问题是要求解使用分片常数（$k=0$）基函数的一维热方程的半离散SIPG算子的特征值。半离散系统由 $M \\dot{U} = -A U$ 给出。我们需要分析广义特征问题 $A \\Phi = \\lambda M \\Phi$。\n\n首先，我们构造质量矩阵 $M$ 和刚度矩阵 $A$。空间域 $[0,L]$ 被离散化为 $N$ 个长度为 $h=L/N$ 的单元 $I_j$。我们使用分片常数基，其中第 $j$ 个基函数 $\\phi_j(x)$ 在 $x \\in I_j$ 时为 $1$，否则为 $0$。未知解为 $u_h(x,t) = \\sum_{j=1}^N U_j(t) \\phi_j(x)$。\n\n质量矩阵 $M$ 的元素由 $M_{ij} = \\int_{0}^{L} \\phi_i(x) \\phi_j(x) \\, dx$ 给出。由于当 $i \\ne j$ 时基函数的支撑集不相交，质量矩阵是对角的。对角线元素为：\n$$\nM_{jj} = \\int_{I_j} (1)^2 \\, dx = h\n$$\n因此，质量矩阵为 $M = hI$，其中 $I$ 是 $N \\times N$ 的单位矩阵。\n\n接下来，我们构造刚度矩阵 $A$，其元素为 $A_{ij} = a(\\phi_j, \\phi_i)$，其中 $a(u,v)$ 是算子 $-u_{xx}$ 的SIPG双线性形式。其一般形式为：\n$$\na(u,v) = \\sum_{k=1}^N \\int_{I_k} u_x v_x \\, dx - \\sum_{f} \\left( \\{u_x\\}[v] + \\{v_x\\}[u] \\right) + \\sum_{f} \\frac{\\tau}{h} [u][v]\n$$\n其中求和遍及所有单元面 $f$，$[u] = u^+ - u^-$ 和 $\\{w\\} = (w^+ + w^-)/2$ 分别是面上的跳跃和平均算子。对于分片常数多项式（$k=0$），基函数在每个单元内部的导数为零，因此体积积分项 $\\int_{I_k} (\\phi_j)_x (\\phi_i)_x \\, dx$ 为零。此外，在 $k=0$ 的SIPG标准定义中，涉及梯度平均值的项 $\\{(\\phi_j)_x\\}$ 和 $\\{(\\phi_i)_x\\}$ 也被视为零，因为来自单元内部的导数迹为零。因此，双线性形式简化为仅包含罚分项：\n$$\na(u,v) = \\sum_{f} \\frac{\\tau}{h} [u][v]\n$$\n我们通过使用 $v_h = \\phi_i$ 作为测试函数来计算 $A$ 的第 $i$ 行的元素。向量 $A U$ 的第 $i$ 个分量为 $(AU)_i = a(u_h, \\phi_i)$。\n测试函数 $[\\phi_i]$ 的跳跃仅在单元 $I_i$ 的两个面上非零。设这两个面位于位置 $x_{i-1/2}$ 和 $x_{i+1/2}$。\n在面 $x_{i+1/2}$（在 $I_i$ 和 $I_{i+1}$ 之间）：$[\\phi_i] = \\phi_i^+ - \\phi_i^- = 0 - 1 = -1$。\n在面 $x_{i-1/2}$（在 $I_{i-1}$ 和 $I_i$ 之间）：$[\\phi_i] = \\phi_i^+ - \\phi_i^- = 1 - 0 = 1$。\n解 $u_h$ 的跳跃为 $[u_h]_{i+1/2} = U_{i+1} - U_i$ 和 $[u_h]_{i-1/2} = U_i - U_{i-1}$。\n因此，项 $a(u_h, \\phi_i)$ 为：\n$$\na(u_h, \\phi_i) = \\frac{\\tau}{h} \\left( [u_h]_{i+1/2}[\\phi_i]_{i+1/2} + [u_h]_{i-1/2}[\\phi_i]_{i-1/2} \\right) = \\frac{\\tau}{h} \\left( (U_{i+1}-U_i)(-1) + (U_i-U_{i-1})(1) \\right)\n$$\n$$\na(u_h, \\phi_i) = \\frac{\\tau}{h} (-U_{i+1} + 2U_i - U_{i-1})\n$$\n由此，我们可以确定矩阵 $A$ 的元素。考虑到周期性边界条件（$U_0 \\equiv U_N$，$U_{N+1} \\equiv U_1$），矩阵 $A$ 是一个循环矩阵：\n$$\nA = \\frac{\\tau}{h} \\begin{pmatrix}\n2  -1  0  \\dots  0  -1 \\\\\n-1  2  -1  \\dots  0  0 \\\\\n0  -1  2  \\dots  0  0 \\\\\n\\vdots  \\vdots  \\ddots  \\ddots  \\ddots  \\vdots \\\\\n0  0  0  \\dots  2  -1 \\\\\n-1  0  0  \\dots  -1  2\n\\end{pmatrix}\n$$\n广义特征问题 $A \\Phi = \\lambda M \\Phi$ 变为 $A \\Phi = \\lambda (hI) \\Phi$，这可以简化为矩阵 $M^{-1}A = \\frac{1}{h}A$ 的标准特征问题：\n$$\n\\frac{1}{h} A \\Phi = \\lambda \\Phi\n$$\n特征值 $\\lambda$ 是矩阵 $\\frac{1}{h}A = \\frac{\\tau}{h^2} C$ 的特征值，其中 $C$ 是由向量 $(2, -1, 0, \\dots, 0, -1)$ 生成的循环矩阵。\n\n一个第一行为 $(c_0, c_1, \\dots, c_{N-1})$ 的 $N \\times N$ 循环矩阵的特征值由 $\\mu_j = \\sum_{m=0}^{N-1} c_m \\omega_j^m$ 给出，其中 $j=0, 1, \\dots, N-1$，$\\omega_j = \\exp(i \\frac{2\\pi j}{N})$ 是第 $N$ 个单位根。\n对于我们的矩阵 $C$，我们有 $c_0=2$，$c_1=-1$，$c_{N-1}=-1$，所有其他 $c_m=0$。$C$ 的特征值 $\\mu_j$ 是：\n$$\n\\mu_j = c_0 \\omega_j^0 + c_1 \\omega_j^1 + c_{N-1} \\omega_j^{N-1} = 2 - \\omega_j - \\omega_j^{N-1}\n$$\n使用性质 $\\omega_j^{N-1} = \\omega_j^{-1} = \\bar{\\omega}_j$，我们得到：\n$$\n\\mu_j = 2 - (\\omega_j + \\bar{\\omega}_j) = 2 - 2\\cos\\left(\\frac{2\\pi j}{N}\\right)\n$$\n使用半角恒等式 $1-\\cos(2\\theta) = 2\\sin^2(\\theta)$，这变为：\n$$\n\\mu_j = 2 \\left( 1 - \\cos\\left(\\frac{2\\pi j}{N}\\right) \\right) = 4\\sin^2\\left(\\frac{\\pi j}{N}\\right)\n$$\n因此，算子 $M^{-1}A$ 的特征值 $\\lambda_j$ 是：\n$$\n\\lambda_j = \\frac{\\tau}{h^2} \\mu_j = \\frac{4\\tau}{h^2} \\sin^2\\left(\\frac{\\pi j}{N}\\right), \\quad j=0, 1, \\dots, N-1\n$$\n这样就完成了精确特征值的推导。\n\n谱半径 $\\rho(M^{-1}A)$ 是这些特征值绝对值的最大值。因为所有 $\\lambda_j \\ge 0$，我们有：\n$$\n\\rho(M^{-1}A) = \\max_{j=0, \\dots, N-1} \\lambda_j = \\frac{4\\tau}{h^2} \\max_{j=0, \\dots, N-1} \\sin^2\\left(\\frac{\\pi j}{N}\\right)\n$$\n$\\sin^2(x)$ 的最大值是 $1$。在这个离散点集上的最大值出现在使 $\\frac{\\pi j}{N}$ 最接近 $\\pi/2$ 的整数 $j$ 处，即 $j = \\lfloor N/2 \\rfloor$。因此，\n$$\n\\rho(M^{-1}A) = \\frac{4\\tau}{h^2} \\sin^2\\left(\\frac{\\pi \\lfloor N/2 \\rfloor}{N}\\right)\n$$\n这个表达式依赖于 $h$、$\\tau$ 和 $N$。由于 $N=L/h$，它依赖于 $h$、$\\tau$ 和 $L$。问题要求一个关于 $k$ 和 $h$ 的闭式解析函数。向下取整函数 $\\lfloor \\cdot \\rfloor$ 的存在使得表达式非解析，并且最终形式中不要求对 $L$ 的依赖。\n\n为了获得所需的形式，我们考虑在所有可能的单元数 $N$ 上谱半径的上确界。这提供了一个与具体网格配置（例如，$N$ 是奇数还是偶数）和域大小 $L$ 无关的紧上界。这是数值方法稳定性分析（例如，CFL条件）中关注的标准量。\n对于所有整数 $N \\ge 2$，因子 $\\sin^2(\\frac{\\pi \\lfloor N/2 \\rfloor}{N})$ 的上确界是 $1$，对于任何偶数 $N$ 都可以达到。因此，我们使用这个上界作为分析的有效谱半径。\n$$\n\\rho(M^{-1}A) \\le \\frac{4\\tau}{h^2}\n$$\n我们将这个界 $\\frac{4\\tau}{h^2}$ 作为谱半径的函数形式。\n\n最后，我们采用给定的罚尺度 $\\tau = c(k+1)^2$。整个推导是针对 $k=0$ 进行的，但问题要求最终表达式用 $k$ 和 $h$ 表示。按照指示，我们将这个通用的 $\\tau$ 形式代入我们的谱半径结果中。\n$$\n\\rho = \\frac{4}{h^2} \\left[ c(k+1)^2 \\right] = \\frac{4c(k+1)^2}{h^2}\n$$\n这个表达式是关于 $k$ 和 $h$ 的闭式解析函数，符合要求。对于所分析的特定情况（$k=0$），谱半径为 $\\frac{4c}{h^2}$。", "answer": "$$\n\\boxed{\\frac{4c(k+1)^2}{h^2}}\n$$", "id": "3378064"}, {"introduction": "通过积分定义了刚度矩阵后，下一个实际挑战便是其数值计算。本练习旨在解决一个关键的实现问题：要精确计算刚度矩阵的项，所需的数值求积阶数最低是多少？通过分析被积多项式的次数，您将推导出一个精确的准则，以确保扩散算子的无误差组装 [@problem_id:3378064]。", "problem": "考虑一个从参考区间 $[-1,1]$ 映射的单个仿射一维单元上的、具有常数扩散系数的稳态热（泊松）方程。使用间断Galerkin（DG）方法和对称内部罚Galerkin（SIPG）格式，重点关注单元体积刚度双线性形式 $a_{E}(u,v) = \\int_{E} \\kappa \\,\\partial_{x} u \\,\\partial_{x} v \\,\\mathrm{d}x$，其中 $\\kappa$ 是常数，且从参考单元的映射是仿射的，因此雅可比因子是常数。设参考单元上的局部试探空间和检验空间为次数最多为 $p$ 的多项式，并考虑模态单项式基 $\\{\\phi_{k}(x)\\}_{k=0}^{p}$，其中 $\\phi_{k}(x) = x^{k}$。因此，对于 $k \\geq 1$，有 $\\partial_{x}\\phi_{k}(x) = k\\,x^{k-1}$，而 $\\partial_{x}\\phi_{0}(x) = 0$。\n\n定义精确单元刚度矩阵项为 $K_{ij} = \\int_{-1}^{1} \\partial_{x}\\phi_{i}(x)\\,\\partial_{x}\\phi_{j}(x)\\,\\mathrm{d}x$，其中 $i,j \\in \\{0,1,\\dots,p\\}$。对于数值积分，在 $[-1,1]$ 上使用高斯-勒让德求积，该求积对次数最高为 $D$（求积精确次数）的多项式是精确的，因此计算出的矩阵项为 $K_{ij}^{(D)} = \\sum_{\\ell=1}^{Q} w_{\\ell}\\,\\partial_{x}\\phi_{i}(x_{\\ell})\\,\\partial_{x}\\phi_{j}(x_{\\ell})$，其中 $\\{(x_{\\ell},w_{\\ell})\\}_{\\ell=1}^{Q}$ 是求积节点和权重，且 $D = 2Q - 1$。\n\n为了量化积分不足对扩散算子组装的影响，定义混叠计数\n$$A(D,p) = \\#\\left\\{(i,j)\\in\\{1,\\dots,p\\}^{2} \\,\\middle|\\, i+j-2  D \\text{ 和 } i+j-2 \\text{ 是偶数}\\right\\},$$\n该计数统计的是那些精确被积多项式的次数为严格大于 $D$ 的偶数（因此在 $[-1,1]$ 上的精确积分为非零值），且不会被求积精确积分的刚度矩阵项的数量。\n\n从以上定义以及高斯-勒让德求积能精确积分所有次数最高为其精确次数 $D$ 的多项式这一基本性质出发，推导出用 $p$ 和 $D$ 表示的 $A(D,p)$，然后确定最小求积精确次数 $D_{\\min}$，使得对于所有满足 $1 \\leq i,j \\leq p$ 的数对 $(i,j)$，都有 $A(D,p) = 0$。将 $D_{\\min}$ 的最终答案表示为关于 $p$ 的闭式解析表达式。无需四舍五入，也无需单位。", "solution": "问题要求解出最小求积精确次数 $D_{\\min}$，使得混叠计数 $A(D,p)$ 为零。分析从单元刚度矩阵项和数值积分方案的性质开始。\n\n参考单元 $[-1,1]$ 上的单元刚度矩阵项由下式给出：\n$$ K_{ij} = \\int_{-1}^{1} \\partial_{x}\\phi_{i}(x)\\,\\partial_{x}\\phi_{j}(x)\\,\\mathrm{d}x $$\n其中 $i,j \\in \\{0, 1, \\dots, p\\}$。基函数是单项式 $\\phi_k(x) = x^k$。它们的导数为：当 $k \\ge 1$ 时，$\\partial_x \\phi_k(x) = kx^{k-1}$；而 $\\partial_x \\phi_0(x) = 0$。\n\n如果 $i=0$ 或 $j=0$，相应的导数为零，导致 $K_{ij}=0$。这些项无论使用何种求积法则都能被精确计算。问题正确地聚焦于索引 $i,j \\in \\{1, \\dots, p\\}$，对于这些索引，导数是非零的。对于这些索引，被积函数为：\n$$ \\mathcal{I}_{ij}(x) = \\partial_{x}\\phi_{i}(x)\\,\\partial_{x}\\phi_{j}(x) = (ix^{i-1})(jx^{j-1}) = ijx^{i+j-2} $$\n该被积函数 $\\mathcal{I}_{ij}(x)$ 是一个关于 $x$ 的多项式，其次数为 $\\deg(\\mathcal{I}_{ij}) = i+j-2$。\n\n数值积分使用高斯-勒让德求积法则进行，该法则对所有次数最高为 $D$ 的多项式都是精确的。这意味着，如果被积函数的次数小于或等于 $D$，那么计算出的刚度项 $K_{ij}^{(D)}$ 就等于精确项 $K_{ij}$：\n$$ K_{ij}^{(D)} = K_{ij} \\quad \\text{如果} \\quad i+j-2 \\le D $$\n如果 $i+j-2  D$，求积法则不保证能得出精确积分，可能会出现混叠误差。\n\n混叠计数 $A(D,p)$ 定义为量化易受此误差影响的项的数量。其定义如下：\n$$ A(D,p) = \\#\\left\\{(i,j)\\in\\{1,\\dots,p\\}^{2} \\,\\middle|\\, i+j-2  D \\text{ 和 } i+j-2 \\text{ 是偶数}\\right\\} $$\n这个定义包含了一个数对 $(i,j)$ 对计数产生贡献所需满足的两个条件：\n1.  $i+j-2  D$：被积多项式的次数超过了求积的精确次数。这是可能导致数值不精确的条件。\n2.  $i+j-2$ 是偶数：精确积分 $\\int_{-1}^{1} ijx^{i+j-2} \\mathrm{d}x$ 为非零，因为 $x$ 的奇次幂在对称区间 $[-1,1]$ 上的积分为零。只有当被积值不为零时，积分误差才有意义。\n\n目标是找到最小精确次数 $D_{\\min}$，使得 $A(D,p) = 0$。要使 $A(D,p)$ 为零，满足这两个条件的数对 $(i,j)$ 集合必须为空。\n$$ \\left\\{(i,j)\\in\\{1,\\dots,p\\}^{2} \\,\\middle|\\, i+j-2  D \\text{ 和 } i+j-2 \\text{ 是偶数}\\right\\} = \\emptyset $$\n要确保这个集合为空，一个充分的方法是确保对于指定范围内的任何数对 $(i,j)$，第一个条件 $i+j-2  D$ 永远不成立。如果这个不等式永远不成立，那么它与任何其他条件的合取也永远不成立。\n\n因此，我们寻求一个 $D$ 值，使得对于所有的 $i,j \\in \\{1, 2, \\dots, p\\}$，以下不等式都成立：\n$$ i+j-2 \\le D $$\n为了对所有可能的数对 $(i,j)$ 都满足这个条件，$D$ 必须大于或等于表达式 $i+j-2$ 的最大可能值。\n$$ D \\ge \\max_{i,j \\in \\{1,\\dots,p\\}} (i+j-2) $$\n表达式 $i+j-2$ 的最大值出现在 $i$ 和 $j$ 都取其最大可能值时。在集合 $\\{1, 2, \\dots, p\\}$ 中，$i$ 和 $j$ 的最大值都是 $p$。将 $i=p$ 和 $j=p$ 代入表达式，得到我们必须积分的任何被积多项式的最大次数：\n$$ \\max_{i,j \\in \\{1,\\dots,p\\}} (i+j-2) = p+p-2 = 2p-2 $$\n因此，为确保所有被积多项式 $\\mathcal{I}_{ij}(x)$ 的次数都小于或等于 $D$，我们必须有：\n$$ D \\ge 2p-2 $$\n满足此条件的 $D$ 的最小整数值为 $D_{\\min} = 2p-2$。\n\n如果我们选择 $D = 2p-2$，那么对于任何 $(i,j) \\in \\{1,\\dots,p\\}^2$，我们有 $i+j-2 \\le p+p-2 = 2p-2 = D$。这意味着条件 $i+j-2  D$ 永远不会被满足，因此 $A(2p-2, p) = 0$。\n\n为确认这是最小值，考虑 $D = 2p-3$。对于此选择，我们考察数对 $(i,j) = (p,p)$。被积函数的次数为 $p+p-2 = 2p-2$。条件 $i+j-2  D$ 变为 $2p-2  2p-3$，这是成立的。第二个条件，$i+j-2$ 是偶数，也成立，因为对于任何整数 $p \\ge 1$，$2p-2 = 2(p-1)$ 始终是一个偶数。因此，对于 $D=2p-3$，数对 $(p,p)$ 对混叠计数有贡献，所以 $A(2p-3, p) \\ge 1$。这证实了 $D = 2p-2$ 是所需的最小精确次数。", "answer": "$$\\boxed{2p-2}$$", "id": "3378059"}]}