{"hands_on_practices": [{"introduction": "要为包含不连续解的守恒律设计稳健的数值格式，第一步是深刻理解最简单的间断初值问题——黎曼问题的精确解。本练习 [@problem_id:3377120] 将引导你推导出控制不连续性的基本“交通规则”（Rankine-Hugoniot 条件）以及筛选出物理上正确解的熵条件。掌握这些是构建戈杜诺夫型数值通量的理论基石。", "problem": "考虑标量守恒律 $u_{t} + \\partial_{x} f(u) = 0$，其中通量 $f$ 是二次连续可微且严格凸的（即，$f \\in C^{2}$ 且对于所关注范围内的所有 $u$，都有 $f''(u) > 0$）。在用于标量守恒律的间断 Galerkin (DG) 方法中，一个相容的 Godunov 型格式中的界面数值通量是通过求解在每个单元界面上设置的黎曼问题的精确解来获得的。设初始数据为一个黎曼数据\n$$\nu(x,0) = \\begin{cases}\nu_{L},  x  0, \\\\\nu_{R},  x > 0,\n\\end{cases}\n$$\n其中左右状态 $u_{L}, u_{R} \\in \\mathbb{R}$ 为常数。从守恒律和弱解的定义出发，推导跨越移动间断的跳跃条件以及针对严格凸通量的基于特征线的熵条件。利用这些条件，根据 $u_{L}$ 和 $u_{R}$ 的大小关系，判断黎曼解是速度为 $s$ 的单个激波，还是一个中心自相似稀疏波。最后，对于 $u_{L} > u_{R}$ 的情况，计算激波速度 $s$ 的闭式解，该解用 $f$、$u_{L}$ 和 $u_{R}$ 表示。你的最终答案必须是 $s$ 的一个单一闭式解析表达式。", "solution": "所述问题是研究双曲标量守恒律中的一个标准理论练习。它具有科学依据、内容自洽且提法适定。所有前提都是该领域使用的标准定义和条件。因此，该问题是有效的，我们可以着手求解。\n\n问题要求对标量守恒律的黎曼问题的解进行若干推导\n$$\nu_t + \\partial_x f(u) = 0\n$$\n其中通量函数 $f$ 是二次连续可微的（$f \\in C^2$）且严格凸的（$f''(u) > 0$）。初始条件是一个阶跃函数：\n$$\nu(x,0) = \\begin{cases}\nu_{L},  x  0, \\\\\nu_{R},  x > 0.\n\\end{cases}\n$$\n\n首先，我们推导移动间断的跳跃条件。我们从弱解的定义开始。如果对于在 $\\mathbb{R} \\times [0, \\infty)$ 上具有紧支集的任何光滑检验函数 $\\phi(x,t)$，以下积分恒等式成立，则函数 $u(x,t)$ 是该守恒律的一个弱解：\n$$\n\\int_0^\\infty \\int_{-\\infty}^\\infty \\left( u \\frac{\\partial \\phi}{\\partial t} + f(u) \\frac{\\partial \\phi}{\\partial x} \\right) dx dt + \\int_{-\\infty}^\\infty u(x,0) \\phi(x,0) dx = 0\n$$\n让我们假设存在一个分段光滑的解，其唯一的间断曲线由 $x = x(t)$ 给出。我们将激波速度记为 $s = \\frac{dx}{dt}$。对于黎曼问题的自相似解，该曲线是一条穿过原点的直线，$x = st$，其中 $s$ 是一个常数。解在间断的左侧为 $u(x,t) = u_L$，在右侧为 $u(x,t) = u_R$。设 $\\Omega$ 为上半平面 $t > 0$ 中的一个任意区域，并设方程为 $x - st = 0$ 的间断曲线 $\\Gamma$ 穿过 $\\Omega$，将其分为左区域 $\\Omega_L$ 和右区域 $\\Omega_R$。\n\n将弱解的积分定义应用于 $\\Omega_L$ 和 $\\Omega_R$ 并分别使用分部积分（或散度定理），我们得到：\n$$\n\\iint_{\\Omega_L \\cup \\Omega_R} \\left( u \\phi_t + f(u) \\phi_x \\right) dx dt = 0\n$$\n$$\n\\iint_{\\Omega_L \\cup \\Omega_R} \\left( \\partial_t(u\\phi) - u_t \\phi + \\partial_x(f(u)\\phi) - (\\partial_x f(u)) \\phi \\right) dx dt = 0\n$$\n由于 $u$ 在光滑区域 $\\Omega_L$ 和 $\\Omega_R$ 中是古典解，因此 $u_t + \\partial_x f(u)$ 项在这些区域内为零。剩下：\n$$\n\\iint_{\\Omega_L} \\left( \\partial_t(u_L \\phi) + \\partial_x(f(u_L) \\phi) \\right) dx dt + \\iint_{\\Omega_R} \\left( \\partial_t(u_R \\phi) + \\partial_x(f(u_R) \\phi) \\right) dx dt = 0\n$$\n根据散度定理，这等价于边界 $\\partial\\Omega_L$ 和 $\\partial\\Omega_R$ 上的线积分之和。\n$$\n\\oint_{\\partial\\Omega_L} \\begin{pmatrix} f(u_L)\\phi \\\\ u_L\\phi \\end{pmatrix} \\cdot \\mathbf{n} \\, d\\ell + \\oint_{\\partial\\Omega_R} \\begin{pmatrix} f(u_R)\\phi \\\\ u_R\\phi \\end{pmatrix} \\cdot \\mathbf{n} \\, d\\ell = 0\n$$\n其中 $\\mathbf{n}$ 是外指向法向量。如果我们将与 $\\Omega$ 边界重合的边界部分的贡献相加，它们会相互抵消；或者如果 $\\phi$ 在 $\\Omega$ 内具有紧支集，则这些贡献为零。唯一剩下的贡献来自界面 $\\Gamma$，对于每个积分，该界面都沿相反方向遍历。设指向从左到右的 $\\Gamma$ 的法向量为 $\\mathbf{n}_{\\Gamma} = (n_x, n_t) = (1, -s) / \\sqrt{1+s^2}$。积分关系简化为沿曲线 $\\Gamma$ 的积分：\n$$\n\\int_{\\Gamma} \\left( f(u_L) n_x + u_L n_t \\right) \\phi \\, d\\ell - \\int_{\\Gamma} \\left( f(u_R) n_x + u_R n_t \\right) \\phi \\, d\\ell = 0\n$$\n这可以简化为：\n$$\n\\int_{\\Gamma} \\left( (f(u_L) - f(u_R)) n_x + (u_L - u_R) n_t \\right) \\phi \\, d\\ell = 0\n$$\n因为这必须对任何检验函数 $\\phi$ 成立，所以被积函数必须为零。令 $[q] = q_R - q_L$ 表示物理量 $q$ 的跳跃。\n$$\n- [f(u)] n_x - [u] n_t = 0\n$$\n代入法向量 $(n_x, n_t)$ 的分量，我们得到：\n$$\n(f(u_R) - f(u_L)) \\cdot 1 + (u_R - u_L) \\cdot (-s) = 0\n$$\n对 $s$ 求解，我们得到 Rankine-Hugoniot 跳跃条件：\n$$\ns = \\frac{f(u_R) - f(u_L)}{u_R - u_L} = \\frac{[f(u)]}{[u]}\n$$\n\n接下来，我们讨论熵条件。守恒律可以写成拟线性形式 $u_t + f'(u)u_x = 0$。量 $a(u) = f'(u)$ 是特征速度，即关于值 $u$ 的信息传播的速度。由于通量 $f$ 是严格凸的，$f''(u) > 0$，这意味着特征速度 $a(u) = f'(u)$ 是 $u$ 的一个严格增函数。\n\n一个间断解，或激波，是物理上允许的，当且仅当间断两侧的特征线都流入该间断。如果特征线从间断流出，这将意味着非唯一的演化，因为小扰动可以传播开去，导致不同的解。为了使特征线从左侧进入激波，其速度必须大于激波速度 $s$。为了使特征线从右侧进入激波，其速度必须小于 $s$。这就给出了 Lax 熵条件：\n$$\na(u_L) > s > a(u_R) \\quad \\implies \\quad f'(u_L) > s > f'(u_R)\n$$\n\n现在我们可以确定黎曼问题的解的性质。\n情况1：$u_L > u_R$。由于 $f'(u)$ 是一个严格增函数，$u_L > u_R$ 意味着 $f'(u_L) > f'(u_R)$。在这种情况下，可能存在一个满足 Lax 熵条件的激波速度 $s$。根据中值定理，激波速度 $s = \\frac{f(u_L) - f(u_R)}{u_L - u_R}$ 等于某个 $c \\in (u_R, u_L)$ 的 $f'(c)$。因为 $f'$ 是严格递增的，这意味着 $f'(u_R)  f'(c)  f'(u_L)$，所以 $f'(u_R)  s  f'(u_L)$。熵条件自动满足。因此，对于 $u_L > u_R$，解是一个以速度 $s$ 移动的单个激波。特征线正在碰撞。\n\n情况2：$u_L \\le u_R$。由于 $f'(u)$ 是一个严格增函数，$u_L \\le u_R$ 意味着 $f'(u_L) \\le f'(u_R)$。Lax 熵条件 $f'(u_L) > s > f'(u_R)$ 永远无法满足。因此，间断解是不可接受的。特征线正在分散开。解必须是一个连续的、自相似的解 $u(x,t) = w(x/t)$，称为中心稀疏波，它通过所有中间值将状态 $u_L$ 连接到 $u_R$。\n\n最后，问题要求计算在 $u_L > u_R$ 情况下的激波速度 $s$。如前所示，这种情况对应于一个激波，其速度由 Rankine-Hugoniot 跳跃条件确定。我们可以将 $s$ 的表达式写为：\n$$\ns = \\frac{f(u_L) - f(u_R)}{u_L - u_R}\n$$\n这就是所要求的闭式解析表达式。", "answer": "$$\n\\boxed{\\frac{f(u_L) - f(u_R)}{u_L - u_R}}\n$$", "id": "3377120"}, {"introduction": "在黎曼问题理论的基础上，本练习 [@problem_id:3401198] 将从抽象原理过渡到间断伽辽金（DG）方法的一个具体构件：数值通量。你将运用激波和稀疏波的概念，为经典的非线性伯格斯方程推导出精确的戈杜诺夫通量。这个练习清晰地揭示了精确解的物理特性是如何被直接编码到数值格式中以确保其稳定性的。", "problem": "考虑标量守恒律 Burgers 方程 $u_{t} + (f(u))_{x} = 0$，其中 $f(u) = \\frac{u^{2}}{2}$。在一维间断 Galerkin (DG) 方法中，单元间的耦合是通过每个界面上的数值通量来实现的。Godunov 数值通量定义为，在界面 $x=0$ 处，对于初始数据 $u(x,0) = u^{-}$ (当 $x  0$) 和 $u(x,0) = u^{+}$ (当 $x>0$) 的精确自相似 Riemann 解的状态下，计算得到的物理通量。从标量守恒律的基本原理出发，即 (i) 激波的 Rankine–Hugoniot 跳跃条件，(ii) 允许间断的 Lax 熵条件，以及 (iii) 稀疏波的特征线法，推导 Burgers 方程的 Godunov 通量 $F_{G}(u^{-},u^{+})$ 关于 $u^{-}$ 和 $u^{+}$ 的显式解析表达式。然后，解释在 DG 方法的界面上使用此通量如何产生离散熵（二次熵）不等式，并通过耗散单元间跳跃来稳定半离散格式。\n\n你的最终答案必须是 $F_{G}(u^{-},u^{+})$ 的单一闭式解析表达式。无需进行数值计算。", "solution": "该问题要求推导 Burgers 方程的 Godunov 数值通量，然后解释其在间断 Galerkin (DG) 框架中确保熵稳定性的作用。\n\n所考虑的标量守恒律是 Burgers 方程：\n$$\nu_{t} + \\left(\\frac{u^2}{2}\\right)_x = 0\n$$\n其中通量函数为 $f(u) = \\frac{u^2}{2}$。特征速度由 $c(u) = f'(u) = u$ 给出。\n\nGodunov 数值通量 $F_{G}(u^{-},u^{+})$ 定义为在界面位置 $x=0$ 处 Riemann 问题的自相似解所对应的物理通量。该 Riemann 问题由以下初始条件定义：\n$$\nu(x,0) = \\begin{cases} u^{-} \\text{ for } x  0 \\\\ u^{+} \\text{ for } x > 0 \\end{cases}\n$$\n这个问题的解 $u(x,t)$ 是相似变量 $\\xi = x/t$ 的函数。因此，Godunov 通量为 $F_{G}(u^{-},u^{+}) = f(u(0,t)) = f(u(\\xi=0))$。我们必须根据 $u^{-}$ 和 $u^{+}$ 之间的关系来分析该解。\n\n**第一部分：Godunov 通量 $F_{G}(u^{-},u^{+})$ 的推导**\n\nRiemann 解的性质取决于特征线是发散还是汇聚。\n\n**情况 1：稀疏波 ($u^{-} \\le u^{+}$)**\n速度为 $c(u)=u$ 的特征线从原点发散，形成一个称为稀疏波的连续解。该解由下式给出：\n$$\nu(x,t) = \\begin{cases} u^{-}  \\text{for } x/t \\le u^{-} \\\\ x/t  \\text{for } u^{-} \\le x/t \\le u^{+} \\\\ u^{+}  \\text{for } x/t > u^{+} \\end{cases}\n$$\n界面处的状态 $u(\\xi=0)$ 是通过在 $x/t=0$ 处评估此解得到的。\n- 如果 $u^{-}  0  u^{+}$，界面状态为 $u(0,t)=0$。通量为 $F_{G} = f(0) = 0$。\n- 如果 $0 \\le u^{-} \\le u^{+}$，特征线具有正速度，因此它们都向右移动。区域 $x0$ 保持在状态 $u^{-}$，因此界面状态为 $u(0,t)=u^{-}$。通量为 $F_{G} = f(u^{-}) = \\frac{(u^{-})^2}{2}$。\n- 如果 $u^{-} \\le u^{+} \\le 0$，特征线具有负速度，因此它们都向左移动。区域 $x>0$ 保持在状态 $u^{+}$，因此界面状态为 $u(0,t)=u^{+}$。通量为 $F_{G} = f(u^{+}) = \\frac{(u^{+})^2}{2}$。\n\n稀疏波的这三种子情况可以优雅地总结。通量函数 $f(u) = u^2/2$ 是凸的，在 $u=0$ 处有全局最小值。稀疏波中的 Godunov 通量值对应于在区间 $[u^{-}, u^{+}]$ 上使 $f(u)$ 最小化的点处的物理通量值。也就是说，对于 $u^{-} \\le u^{+}$，\n$$\nF_{G}(u^{-},u^{+}) = \\min_{u \\in [u^{-}, u^{+}]} f(u)\n$$\n\n**情况 2：激波 ($u^{-} > u^{+}$)**\n特征线汇聚，导致形成不连续性，即激波。该激波的速度 $s$ 由 Rankine-Hugoniot 跳跃条件确定：\n$$\ns = \\frac{[f]}{[u]} = \\frac{f(u^{+}) - f(u^{-})}{u^{+} - u^{-}}\n$$\n对于 Burgers 方程，这得出：\n$$\ns = \\frac{\\frac{(u^{+})^2}{2} - \\frac{(u^{-})^2}{2}}{u^{+} - u^{-}} = \\frac{(u^{+} - u^{-})(u^{+} + u^{-})}{2(u^{+} - u^{-})} = \\frac{u^{-} + u^{+}}{2}\n$$\n一个激波只有在满足 Lax 熵条件时才是物理上可容许的，该条件规定特征线必须从两侧进入激波：$f'(u^{-}) > s > f'(u^{+})$。对于 Burgers 方程，即为 $u^{-} > s > u^{+}$。\n- $u^{-} > \\frac{u^{-} + u^{+}}{2} \\implies 2u^{-} > u^{-} + u^{+} \\implies u^{-} > u^{+}$\n- $\\frac{u^{-} + u^{+}}{2} > u^{+} \\implies u^{-} + u^{+}> 2u^{+} \\implies u^{-} > u^{+}$\n对于任何 $u^{-} > u^{+}$，该条件都满足，因此所有此类激波都是可容许的。\n\n界面 $x=0$ 处的状态取决于激波传播的方向，该方向由 $s$ 的符号决定。\n- 如果 $s > 0$ (即 $u^{-} + u^{+} > 0$)，激波向右传播。对于 $t>0$，$x=0$ 处的状态是左状态 $u^{-}$。通量为 $F_{G} = f(u^{-}) = \\frac{(u^{-})^2}{2}$。\n- 如果 $s \\le 0$ (即 $u^{-} + u^{+} \\le 0$)，激波向左传播。对于 $t>0$，$x=0$ 处的状态是右状态 $u^{+}$。通量为 $F_{G} = f(u^{+}) = \\frac{(u^{+})^2}{2}$。\n- 如果 $s = 0$ (即 $u^{-} + u^{+} = 0$)，激波在 $x=0$ 处是静止的。Rankine-Hugoniot 条件意味着 $f(u^{+}) - f(u^{-}) = 0$，因此 $f(u^{-}) = f(u^{+})$。通量在激波两边是连续的，我们可以取任意一个值。注意 $f(u^{-}) = f(-u^{+}) = \\frac{(-u^{+})^2}{2} = \\frac{(u^{+})^2}{2} = f(u^{+})$。我们对 $s \\le 0$ 的约定正确地选择了 $f(u^{+})$。\n\n我们可以用紧凑的形式表达激波的这些子情况。$f(u^{-}) - f(u^{+}) = \\frac{1}{2}(u^{-}-u^{+})(u^{-}+u^{+})$ 的符号取决于 $u^{-}+u^{+}$ 的符号，因为 $u^{-}-u^{+}>0$。\n- 如果 $u^{-}+u^{+} > 0$，则 $f(u^{-}) > f(u^{+})$，所以 $F_{G} = f(u^{-}) = \\max(f(u^{-}), f(u^{+}))$。\n- 如果 $u^{-}+u^{+} \\le 0$，则 $f(u^{-}) \\le f(u^{+})$，所以 $F_{G} = f(u^{+}) = \\max(f(u^{-}), f(u^{+}))$。\n由于 $f(u)=u^2/2$ 是凸函数，其在区间 $[u^{+}, u^{-}]$ 上的最大值必定出现在端点上。因此，对于 $u^{-} > u^{+}$，\n$$\nF_{G}(u^{-},u^{+}) = \\max(f(u^{-}), f(u^{+}))\n$$\n\n**$F_{G}(u^{-},u^{+})$ 的显式解析表达式**\n结合所有情况，我们得到 Burgers 方程的 Godunov 通量的显式分段定义：\n$$\nF_{G}(u^{-},u^{+}) = \\begin{cases} \\max\\left(\\frac{(u^{-})^2}{2}, \\frac{(u^{+})^2}{2}\\right)  \\text{if } u^{-} > u^{+} \\\\ \\frac{(u^{-})^2}{2}  \\text{if } 0 \\le u^{-} \\le u^{+} \\\\ 0  \\text{if } u^{-}  0  u^{+} \\\\ \\frac{(u^{+})^2}{2}  \\text{if } u^{-} \\le u^{+} \\le 0 \\end{cases}\n$$\n请注意，$u^{-}=u^{+}$ 的情况是一致的，因为 $F_G(u,u) = f(u)$。\n\n**第二部分：熵稳定性与格式稳定**\n\n在 DG 格式中使用 Godunov 通量可确保满足熵不等式的离散版本，从而保证半离散格式的非线性稳定性。\n\n对于一个凸熵函数 $U(u)$ 和相应的熵通量 $Q(u)$ (其中 $Q'(u) = U'(u)f'(u)$)，连续熵不等式为 $U(u)_t + Q(u)_x \\le 0$。对于 Burgers 方程，二次熵为 $U(u) = u^2/2$，其 $U'(u)=u$，熵通量为 $Q(u) = u^3/3$。\n\n在 DG 格式中，对所有单元的局部弱形式求和，并选择测试函数 $v_h = U'(u_h) = u_h$，会得到总熵 $\\mathcal{E}(t) = \\int_{\\Omega} U(u_h) dx$ 的演化方程。总熵的变化率由每个单元间界面的贡献总和决定。状态 $u^{-}$ 和 $u^{+}$ 之间的界面的贡献是数值熵耗散：\n$$\n\\mathcal{D}(u^{-}, u^{+}) = F_G(u^{-}, u^{+}) [U'] - [Q] = F_G(u^{-}, u^{+})(u^{+} - u^{-}) - \\left(\\frac{(u^{+})^3}{3} - \\frac{(u^{-})^3}{3}\\right)\n$$\n如果在每个界面上该项都为非正，即 $\\mathcal{D}(u^{-}, u^{+}) \\le 0$，则半离散格式是熵稳定的。这将意味着 $\\frac{d\\mathcal{E}}{dt} \\le 0$。\n\nGodunov 通量是一种“E-通量”，这是一类已知的满足熵条件的数值通量。E-通量满足属性 $(u^{-} - u^{+})(F_G(u^{-},u^{+}) - f(u)) \\ge 0$，对于 $u^{-}$ 和 $u^{+}$ 之间路径上的所有 $u$ 值均成立。如第一部分所示，Burgers 方程的 Godunov 通量在激波（$u^{-} > u^{+}$）情况下为 $F_G = \\max(f(u^{-}), f(u^{+}))$，在稀疏波（$u^{-} \\le u^{+}$）情况下为 $F_G = \\min_{u \\in [u^{-}, u^{+}]} f(u)$。可以证明，此通量是一个 E-通量，满足熵条件，从而通过耗散单元间跳跃来稳定半离散格式。", "answer": "$$\n\\boxed{F_{G}(u^{-},u^{+}) = \\begin{cases} \\max\\left(\\frac{(u^{-})^2}{2}, \\frac{(u^{+})^2}{2}\\right)  \\text{if } u^{-} > u^{+} \\\\ \\frac{(u^{-})^2}{2}  \\text{if } 0 \\le u^{-} \\le u^{+} \\\\ 0  \\text{if } u^{-}  0  u^{+} \\\\ \\frac{(u^{+})^2}{2}  \\text{if } u^{-} \\le u^{+} \\le 0 \\end{cases}}\n$$", "id": "3401198"}, {"introduction": "在学习了如何构建基于物理的数值通量之后，这个动手编程练习 [@problem_id:3377131] 将解决一个实际挑战：DG方法中的高阶多项式在表示尖锐激波时可能会产生振荡，导致激波速度等物理量的计算不准确。本问题介绍了一种子单元重构技术，它通过从振荡的数值解中提取更准确的激波结构信息，从而改进其传播速度的估计。", "problem": "考虑一维标量守恒律 $u_t + (f(u))_x = 0$ 及其包含一个激波的弱解，该激波分隔了两个恒定的平台状态 $u_L^\\star$（左侧）和 $u_R^\\star$（右侧）。Rankine–Hugoniot 条件给出了激波速度 $s^\\star = \\dfrac{f(u_R^\\star) - f(u_L^\\star)}{u_R^\\star - u_L^\\star}$。在间断伽辽金 (DG) 方法中，每个单元内的数值解在参考区间 $\\xi \\in [-1,1]$ 上表示为一个 $p$ 次的勒让德模态形式多项式，$u_h(\\xi) = \\sum_{k=0}^p a_k P_k(\\xi)$，其中 $P_k$ 是第 $k$ 个勒让德多项式，$a_k$ 是模态系数。在单元交界面处，DG 解提供了单边多项式迹，通过将这些迹代入 Rankine–Hugoniot 公式，可以用来形成激波速度的数值估计。\n\n您的任务是推导、实现和测试一种针对未充分解析激波的修正方法，该方法通过在界面附近使用子单元平均值局部重构平台状态来改进激波速度的估计。从守恒的积分形式和 Rankine–Hugoniot 的定义出发，然后推导出一个算法，该算法用界面两侧邻近小区间上的局部子单元平均值替换逐点的 DG 界面迹。请遵循以下原则和要求。\n\n- 从跨越移动间断的积分守恒陈述和 Rankine–Hugoniot 条件出发。界面处的数值 DG 状态由单边多项式迹 $u_h(\\pm 1)$ 给出。使用这些迹代入 Rankine–Hugoniot 公式，定义一个基准 DG 激波速度估计 $s_{\\mathrm{DG}}$。\n- 定义局部子单元重构如下。对于给定的整数 $M \\ge 1$，设参考坐标系中的子单元宽度为 $\\Delta \\xi = \\dfrac{2}{M}$。在左侧单元上，将左侧重构状态定义为靠近右侧界面的子单元平均值，\n  $$ \\bar{u}_L^{\\mathrm{sub}} = \\frac{1}{\\Delta \\xi} \\int_{1 - \\Delta \\xi}^{1} u_h^{(L)}(\\xi)\\, d\\xi, $$\n  在右侧单元上，将右侧重构状态定义为靠近左侧界面的右侧重构状态，\n  $$ \\bar{u}_R^{\\mathrm{sub}} = \\frac{1}{\\Delta \\xi} \\int_{-1}^{-1 + \\Delta \\xi} u_h^{(R)}(\\xi)\\, d\\xi. $$\n  使用这些重构的子单元平均值 $\\bar{u}_L^{\\mathrm{sub}}$ 和 $\\bar{u}_R^{\\mathrm{sub}}$ 作为修正后的平台状态估计，代入修正的 Rankine–Hugoniot 激波速度公式 $s_{\\mathrm{corr}} = \\dfrac{f(\\bar{u}_R^{\\mathrm{sub}}) - f(\\bar{u}_L^{\\mathrm{sub}})}{\\bar{u}_R^{\\mathrm{sub}} - \\bar{u}_L^{\\mathrm{sub}}}$。\n- 您的程序必须实现上述基准和修正后的激波速度估计。勒让德多项式必须采用标准多项式 $P_0(\\xi) = 1$，$P_1(\\xi) = \\xi$，$P_2(\\xi) = \\dfrac{1}{2}(3\\xi^2 - 1)$ 等。界面迹在 $\\xi = 1$（左侧单元的右边）和 $\\xi = -1$（右侧单元的左边）处求值。子单元平均值必须通过数值积分计算，该积分对于次数至少为 $p$ 的多项式是精确的；使用映射到子区间上的高斯-勒让德积分来计算定义 $\\bar{u}_L^{\\mathrm{sub}}$ 和 $\\bar{u}_R^{\\mathrm{sub}}$ 的积分。\n- 对于每个测试用例，根据给定的平台状态 $u_L^\\star$ 和 $u_R^\\star$ 计算精确激波速度 $s^\\star = \\dfrac{f(u_R^\\star) - f(u_L^\\star)}{u_R^\\star - u_L^\\star}$。然后计算绝对基准误差 $E_{\\mathrm{DG}} = |s_{\\mathrm{DG}} - s^\\star|$ 和绝对修正误差 $E_{\\mathrm{corr}} = |s_{\\mathrm{corr}} - s^\\star|$。对于每个测试，报告改进量 $I = E_{\\mathrm{DG}} - E_{\\mathrm{corr}}$，作为一个浮点数，其中正值表示修正改进了估计。\n\n使用以下测试套件。在所有情况下，使用多项式次数 $p = 2$ 和子单元数量 $M = 4$。\n\n- 测试 1 (凸二次通量，未充分解析的跳跃):\n  - 通量: $f(u) = \\dfrac{1}{2} u^2$。\n  - 真实平台状态: $u_L^\\star = 2.0$, $u_R^\\star = 0.0$。\n  - 左侧单元系数: $\\boldsymbol{a}^{(L)} = [1.95,\\,-0.08,\\,0.03]$。\n  - 右侧单元系数: $\\boldsymbol{a}^{(R)} = [0.10,\\,0.12,\\,0.03]$。\n- 测试 2 (线性通量边界情况，恒定信号速度):\n  - 通量: $f(u) = a\\, u$，其中 $a = 1.3$。\n  - 真实平台状态: $u_L^\\star = 1.0$, $u_R^\\star = 0.0$。\n  - 左侧单元系数: $\\boldsymbol{a}^{(L)} = [0.90,\\,0.20,\\,-0.05]$。\n  - 右侧单元系数: $\\boldsymbol{a}^{(R)} = [0.10,\\,0.00,\\,0.00]$。\n- 测试 3 (凸三次通量，非对称偏差):\n  - 通量: $f(u) = \\dfrac{1}{3} u^3$。\n  - 真实平台状态: $u_L^\\star = 1.5$, $u_R^\\star = -0.5$。\n  - 左侧单元系数: $\\boldsymbol{a}^{(L)} = [1.55,\\,-0.08,\\,0.00]$。\n  - 右侧单元系数: $\\boldsymbol{a}^{(R)} = [-0.48,\\,0.03,\\,0.00]$。\n\n实现细节和输出规格:\n\n- 将每个单元多项式表示为 $u_h(\\xi) = \\sum_{k=0}^{2} a_k P_k(\\xi)$，其中模态系数是在 $[-1,1]$ 上的标准勒让德基中给出的。\n- 通过在 $\\xi = 1$（对于左侧单元）和 $\\xi = -1$（对于右侧单元）处求值来计算单边 DG 界面迹。\n- 使用映射到子区间 $[1 - \\Delta \\xi, 1]$ 和 $[-1, -1 + \\Delta \\xi]$（其中 $\\Delta \\xi = \\dfrac{2}{M}$）的足够阶数的高斯-勒让德积分来计算子单元平均值。\n- 对于每个测试用例，输出改进量 $I = E_{\\mathrm{DG}} - E_{\\mathrm{corr}}$，并四舍五入到六位小数。\n- 最终输出格式：您的程序应生成单行输出，其中包含结果，格式为方括号括起来的逗号分隔列表（例如，“[$0.012345$, $0.000000$, $0.004200$]”），并按测试 1–3 的顺序排列。\n\n所有答案均为纯数值；本问题不要求物理单位或角度。确保本问题陈述中的每个数学实体都使用 $...$ 分隔符以 LaTeX 格式编写。", "solution": "该问题要求针对应用于一维标量守恒律 $u_t + (f(u))_x = 0$ 的间断 Galerkin (DG) 数值方法，推导并实现一种修正后的激波速度估计。该修正基于局部子单元平均，以更好地逼近激波间断两侧的平台状态。\n\n分析始于在包含一个以速度 $s$ 传播的激波的时空矩形 $[x_L, x_R] \\times [t_1, t_2]$ 上的守恒律积分形式。这导出了精确激波速度 $s^\\star$ 的 Rankine–Hugoniot 条件：\n$$\ns^\\star = \\frac{f(u_R^\\star) - f(u_L^\\star)}{u_R^\\star - u_L^\\star} = \\frac{[f(u)]}{[u]}\n$$\n其中 $u_L^\\star$ 和 $u_R^\\star$ 分别是激波左侧和右侧的恒定状态，$[ \\cdot ]$ 表示量跨越间断的跳跃。\n\n在 DG 框架中，每个计算单元内的数值解由一个多项式表示。对于此问题，多项式在参考区间 $\\xi \\in [-1, 1]$ 上的次数为 $p$，以勒让德模态基表示：\n$$\nu_h(\\xi) = \\sum_{k=0}^p a_k P_k(\\xi)\n$$\n其中 $P_k(\\xi)$ 是第 $k$ 个勒让德多项式，$a_k$ 是模态系数。给定的次数为 $p=2$，因此相关的多项式为：\n$$\nP_0(\\xi) = 1, \\quad P_1(\\xi) = \\xi, \\quad P_2(\\xi) = \\frac{1}{2}(3\\xi^2 - 1)\n$$\n因此，给定单元中的解是显式的：$u_h(\\xi) = a_0 + a_1 \\xi + a_2 \\frac{1}{2}(3\\xi^2 - 1)$。\n\n激波速度的基准数值估计 $s_{\\mathrm{DG}}$ 可以通过将单元交界面处的 DG 解的单边迹直接代入 Rankine–Hugoniot 公式来形成。设交界面位于一个“左侧”单元和一个“右侧”单元之间。左侧单元的右边界对应于 $\\xi=1$，右侧单元的左边界对应于 $\\xi=-1$。单边迹为：\n$$\nu_L = u_h^{(L)}(\\xi=1) = a_0^{(L)} P_0(1) + a_1^{(L)} P_1(1) + a_2^{(L)} P_2(1) = a_0^{(L)} + a_1^{(L)} + a_2^{(L)}\n$$\n$$\nu_R = u_h^{(R)}(\\xi=-1) = a_0^{(R)} P_0(-1) + a_1^{(R)} P_1(-1) + a_2^{(R)} P_2(-1) = a_0^{(R)} - a_1^{(R)} + a_2^{(R)}\n$$\n那么基准激波速度估计为：\n$$\ns_{\\mathrm{DG}} = \\frac{f(u_R) - f(u_L)}{u_R - u_L}\n$$\n\n对于未充分解析的激波，间断附近的（Gibbs 现象）多项式振荡会使得逐点迹 $u_L$ 和 $u_R$ 成为真实平台状态 $u_L^\\star$ 和 $u_R^\\star$ 的较差近似。所提出的修正旨在通过使用局部平均值作为平台状态的更鲁棒的估计来缓解此问题。\n\n子单元重构通过在邻近界面的小子区间上对 DG 多项式进行平均来定义修正后的状态 $\\bar{u}_L^{\\mathrm{sub}}$ 和 $\\bar{u}_R^{\\mathrm{sub}}$。给定子单元数量 $M$，参考坐标系中的子区间宽度为 $\\Delta\\xi = 2/M$。修正后的状态定义为：\n$$\n\\bar{u}_L^{\\mathrm{sub}} = \\frac{1}{\\Delta \\xi} \\int_{1 - \\Delta \\xi}^{1} u_h^{(L)}(\\xi)\\, d\\xi\n$$\n$$\n\\bar{u}_R^{\\mathrm{sub}} = \\frac{1}{\\Delta \\xi} \\int_{-1}^{-1 + \\Delta \\xi} u_h^{(R)}(\\xi)\\, d\\xi\n$$\n使用这些平均状态，可以构造成一个修正后的激波速度估计 $s_{\\mathrm{corr}}$：\n$$\ns_{\\mathrm{corr}} = \\frac{f(\\bar{u}_R^{\\mathrm{sub}}) - f(\\bar{u}_L^{\\mathrm{sub}})}{\\bar{u}_R^{\\mathrm{sub}} - \\bar{u}_L^{\\mathrm{sub}}}\n$$\n\n为了计算 $\\bar{u}_L^{\\mathrm{sub}}$ 和 $\\bar{u}_R^{\\mathrm{sub}}$ 的积分，我们采用高斯-勒让德积分，该积分要求对于次数至少为 $p=2$ 的多项式是精确的。一个 $N$ 点高斯-勒让德求积法则对于次数最高为 $2N-1$ 的多项式是精确的。对于我们次数为 $p=2$ 的被积函数，我们需要 $2N-1 \\ge 2$，这意味着 $N \\ge 1.5$。因此，一个 2 点求积法则（$N=2$，对最高 3 次多项式精确）是足够的。\n\n为了使用 $N$ 点高斯-勒让德法则计算积分 $\\int_a^b g(\\xi) d\\xi$，我们使用变换 $\\xi(\\eta) = \\frac{b-a}{2}\\eta + \\frac{a+b}{2}$ 将区间 $[a, b]$ 映射到参考求积区间 $[-1, 1]$。然后积分近似为：\n$$\n\\int_a^b g(\\xi) d\\xi = \\frac{b-a}{2} \\int_{-1}^1 g(\\xi(\\eta)) d\\eta \\approx \\frac{b-a}{2} \\sum_{i=1}^N w_i g(\\xi(\\eta_i))\n$$\n其中 $(\\eta_i, w_i)$ 是 $[-1, 1]$ 上的标准高斯-勒让德节点和权重。\n\n对于给定的参数 $p=2$ 和 $M=4$，我们有 $\\Delta\\xi = 2/4 = 0.5$。\n$\\bar{u}_L^{\\mathrm{sub}}$ 的积分区间是 $[1 - 0.5, 1] = [0.5, 1]$。\n$\\bar{u}_R^{\\mathrm{sub}}$ 的积分区间是 $[-1, -1 + 0.5] = [-1, -0.5]$。\n\n最终任务是为每个测试用例计算改进量 $I = E_{\\mathrm{DG}} - E_{\\mathrm{corr}}$，其中误差定义为 $E_{\\mathrm{DG}} = |s_{\\mathrm{DG}} - s^\\star|$ 和 $E_{\\mathrm{corr}} = |s_{\\mathrm{corr}} - s^\\star|$。$I$ 的正值表示子单元修正改进了激波速度的估计。\n\n每个测试用例的算法如下：\n1.  给定真实平台状态 $u_L^\\star$ 和 $u_R^\\star$ 以及通量函数 $f(u)$，计算精确激波速度 $s^\\star$。\n2.  给定模态系数 $\\boldsymbol{a}^{(L)}$ 和 $\\boldsymbol{a}^{(R)}$，计算界面迹 $u_L = u_h^{(L)}(1)$ 和 $u_R = u_h^{(R)}(-1)$。\n3.  计算基准激波速度 $s_{\\mathrm{DG}} = (f(u_R) - f(u_L))/(u_R - u_L)$。\n4.  为子区间 $[0.5, 1]$ 和 $[-1, -0.5]$ 建立 2 点高斯-勒让德积分。\n5.  使用求积法则计算平均值 $\\bar{u}_L^{\\mathrm{sub}}$ 和 $\\bar{u}_R^{\\mathrm{sub}}$。\n6.  计算修正后的激波速度 $s_{\\mathrm{corr}} = (f(\\bar{u}_R^{\\mathrm{sub}}) - f(\\bar{u}_L^{\\mathrm{sub}}))/(\\bar{u}_R^{\\mathrm{sub}} - \\bar{u}_L^{\\mathrm{sub}})$。\n7.  计算绝对误差 $E_{\\mathrm{DG}}$ 和 $E_{\\mathrm{corr}}$。\n8.  计算改进量 $I = E_{\\mathrm{DG}} - E_{\\mathrm{corr}}$。\n此过程应用于所有指定的测试用例。对于线性通量情况 $f(u) = au$，只要激波两侧的状态不相等，Rankine-Hugoniot 速度总是 $s=a$。这可作为对实现的一个有用的解析性检验。", "answer": "[0.006250, 0.000000, 0.029272]", "id": "3377131"}]}