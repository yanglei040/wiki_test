## 引言
不连续伽辽金（Discontinuous Galerkin, DG）方法是求解[双曲守恒律](@entry_id:147752)的一类强大的高阶数值技术，在[计算流体力学](@entry_id:747620)及其他科学与工程领域得到了广泛应用。然而，要高效且准确地模拟如线性平流方程描述的波传播和[伯格斯方程](@entry_id:177995)中出现的激波现象，对数值格式的精度、稳定性及守恒性提出了严峻挑战。本文旨在系统性地解决这一知识鸿沟，为读者提供一个关于DG方法从理论构建到实践应用的完整指南。

在接下来的内容中，您将学习到：
- **原理与机制**：我们将深入[DG方法](@entry_id:748369)的核心，阐述其基于分片[多项式空间](@entry_id:144410)的离散化框架、[数值通量](@entry_id:752791)的概念、[代数结构](@entry_id:137052)，以及L²稳定性和守恒性的理论分析。
- **应用与交叉学科联系**：本章将理论付诸实践，展示如何处理边界条件，探讨为捕捉[伯格斯方程](@entry_id:177995)中的激波而设计的限制器和[人工粘性](@entry_id:142854)等高级技术，并揭示DG方法卓越的[色散](@entry_id:263750)特性及其与其他高阶方法的深刻联系。
- **动手实践**：通过一系列精心设计的编程练习，您将有机会亲手实现[DG格式](@entry_id:178043)的关键组件，从而加深对理论知识的理解。

本指南将从[DG方法](@entry_id:748369)的基本原理出发，逐步引导您掌握其在解决典型双曲问题时的精髓。

## 原理与机制

本章在前一章介绍的基础上，深入探讨不连续伽辽金（Discontinuous Galerkin, DG）方法的核心原理与内部机制。我们将系统地阐述[DG方法](@entry_id:748369)如何应用于求解线性[平流方程](@entry_id:144869)和[非线性](@entry_id:637147)的[伯格斯方程](@entry_id:177995)。本章将从DG[空间离散化](@entry_id:172158)框架的基础讲起，逐步深入到[基函数](@entry_id:170178)的选择、[代数结构](@entry_id:137052)、稳定性和守恒性等关键问题，最终涵盖[时间积分格式](@entry_id:165373)的选择。我们的目标是为读者构建一个关于DG方法从理论到实践的完整知识体系。

### 不连续[伽辽金离散化](@entry_id:172164)框架

不[连续伽辽金方法](@entry_id:747805)最显著的特征在于其函数空间的定义。与要求解在单元边界上连续的传统有限元方法不同，[DG方法](@entry_id:748369)允许近似解在单元之间存在间断。

#### 分片[多项式空间](@entry_id:144410)

考虑一个一维有界区间 $\Omega$，我们将其剖分为 $N$ 个不重叠的子区间（单元） $K_j = (x_{j-1}, x_j)$。[DG方法](@entry_id:748369)在这样一个网格上构建其近似[解空间](@entry_id:200470) $V_h^p$。该空间由所有在每个单元 $K_j$ 内为次数不超过 $p$ 的多项式（记作 $\mathbb{P}^p(K_j)$）且在全域 $\Omega$ 上平方可积（即属于 $L^2(\Omega)$）的函数构成。其形式化定义如下：

$V_h^p = \{ v \in L^2(\Omega) : v|_{K_j} \in \mathbb{P}^p(K_j) \text{ for all } j=1,\dots,N \}$

此定义的核心在于，函数 $v \in V_h^p$ 在每个单元内部是光滑的多项式，但在单元与单元之间的边界上，不要求任何连续性。函数在[边界点](@entry_id:176493) $x_j$ 的[左极限](@entry_id:139055) $v(x_j^-)$ 和[右极限](@entry_id:140515) $v(x_j^+)$ 可以不相等。正是这种[不连续性](@entry_id:144108)，赋予了[DG方法](@entry_id:748369)一系列独特的性质。[@problem_id:3378386]

#### 局部[弱形式](@entry_id:142897)与数值通量

对于一个守恒律方程 $\partial_t u + \partial_x f(u) = 0$，DG方法不是在整个区域 $\Omega$ 上寻求全局的弱解，而是在每个单元 $K_j$ 上独立地强制其[弱形式](@entry_id:142897)成立。也就是说，对于任意测试函数 $v_h \in V_h^p$，我们要求：

$\int_{K_j} (\partial_t u_h + \partial_x f(u_h)) v_h \, dx = 0$

其中 $u_h \in V_h^p$ 是我们的近似解。对第二项进行分部积分，我们得到：

$\int_{K_j} (\partial_t u_h) v_h \, dx - \int_{K_j} f(u_h) \partial_x v_h \, dx + [f(u_h) v_h]_{x_{j-1}}^{x_j} = 0$

边界项 $[f(u_h) v_h]_{x_{j-1}}^{x_j}$ 展开为 $f(u_h(x_j^-))v_h(x_j^-) - f(u_h(x_{j-1}^+))v_h(x_{j-1}^+)$。由于 $u_h$ 在边界上是间断的，通量 $f(u_h)$ 在边界 $x_j$ 处没有唯一定义，它同时拥有来自左边单元 $K_j$ 的值 $f(u_h(x_j^-))$ 和来自右边单元 $K_{j+1}$ 的值 $f(u_h(x_j^+))$。为了解决这个[歧义](@entry_id:276744)并确保信息的正确传播以及格式的稳定性与守恒性，DG方法引入了**数值通量 (numerical flux)** 的概念，记作 $\hat{f}$。[数值通量](@entry_id:752791)是一个依赖于界面左右两个状态的函数，即 $\hat{f}(u^-, u^+)$，它在单元边界处取代了物理通量。

引入[数值通量](@entry_id:752791)后，每个单元 $K_j$ 上的[DG弱形式](@entry_id:748377)变为：

$\int_{K_j} (\partial_t u_h) v_h \, dx - \int_{K_j} f(u_h) \partial_x v_h \, dx + \hat{f}_j v_h(x_j^-) - \hat{f}_{j-1} v_h(x_{j-1}^+) = 0$

其中 $\hat{f}_j = \hat{f}(u_h(x_j^-), u_h(x_j^+))$。这个方程是DG方法的核心。它将单元内部的演化（[体积分](@entry_id:171119)项）与通过边界的通量交换（[面积分](@entry_id:275394)项）联系起来。

#### [参考单元](@entry_id:168425)映射

为了方便计算，通常的做法是将所有物理单元 $K_j = [x_{j-1/2}, x_{j+1/2}]$ 通过一个仿射变换映射到一个标准的**参考单元 (reference element)**，通常是 $I_{ref} = [-1, 1]$。设物理单元的中心为 $x_{j,c} = (x_{j-1/2} + x_{j+1/2})/2$，长度为 $h_j = x_{j+1/2} - x_{j-1/2}$。将参考坐标 $\xi \in [-1, 1]$ 映射到物理坐标 $x \in K_j$ 的仿射变换为：

$x(\xi) = x_{j,c} + \frac{h_j}{2}\xi$

这个映射的 Jacobian 是 $\frac{dx}{d\xi} = \frac{h_j}{2}$。利用链式法则和积分换元，我们可以得到导数和积分的变换关系：

$\frac{d}{dx} = \frac{2}{h_j} \frac{d}{d\xi}$

$\int_{K_j} g(x) \, dx = \frac{h_j}{2} \int_{-1}^{1} g(x(\xi)) \, d\xi$

这些变换使得我们可以在参考单元上预先计算好所有[基函数](@entry_id:170178)相关的积分，从而极大地简化了编程实现。[@problem_id:3378369]

### [基函数](@entry_id:170178)与[代数结构](@entry_id:137052)

在每个单元内，近似解 $u_h$ 可以表示为一组[局部基](@entry_id:151573)函数 $\{\phi_k^{(j)}(x)\}_{k=0}^p$ 的[线性组合](@entry_id:154743)。[基函数](@entry_id:170178)的选择直接决定了[DG格式](@entry_id:178043)离散后代数系统的结构和性质。

#### [模态基](@entry_id:752055)与[节点基](@entry_id:752522)

主要有两种[基函数](@entry_id:170178)的选择：**[模态基](@entry_id:752055) (modal basis)** 和**[节点基](@entry_id:752522) (nodal basis)**。

- **[模态基](@entry_id:752055)**通常由一组在参考单元上相互正交的多项式构成，最常用的就是勒让德多项式 (Legendre polynomials) $\{P_k(\xi)\}_{k=0}^p$。通过适当的缩放，我们可以构建一组在 $L^2([-1,1])$ 范数下标准正交的[基函数](@entry_id:170178)，例如 $\phi_k(\xi) = \sqrt{\frac{2k+1}{2}} P_k(\xi)$。[@problem_id:3378336]

- **[节点基](@entry_id:752522)**则与一组特定的节点（如Gauss-Lobatto点）相关联。它由[拉格朗日插值多项式](@entry_id:176861) (Lagrange polynomials) $\{L_k(\xi)\}_{k=0}^p$ 构成，在节点 $\xi_i$ 上满足 $L_k(\xi_i) = \delta_{ki}$（Kronecker delta）。

这两种基的选择导致了DG方法中一个核心的结构差异，主要体现在**质量矩阵 (mass matrix)** 上。[@problem_id:3378345]

#### 质量矩阵的结构

将解的表达式 $u_h(x,t)|_{K_j} = \sum_{k=0}^p U_k^j(t) \phi_k^{(j)}(x)$ 代入弱形式的时间导数项，并选择测试函数为[基函数](@entry_id:170178) $\phi_l^{(j)}(x)$，我们得到：

$\int_{K_j} (\partial_t u_h) \phi_l^{(j)} \, dx = \sum_{k=0}^p \frac{dU_k^j}{dt} \int_{K_j} \phi_k^{(j)} \phi_l^{(j)} \, dx$

积分项 $\int_{K_j} \phi_k^{(j)} \phi_l^{(j)} \, dx$ 定义了[单元质量矩阵](@entry_id:748930) $M^{(j)}$ 的元素 $(M^{(j)})_{lk}$。

- 如果使用**标准正交[模态基](@entry_id:752055)**，根据定义，在[参考单元](@entry_id:168425)上的积分为 $\int_{-1}^1 \phi_k(\xi)\phi_l(\xi) d\xi = \delta_{kl}$。通过坐标变换，物理单元上的质量矩阵元素为：
  $(M^{(j)})_{lk} = \frac{h_j}{2} \int_{-1}^1 \phi_k(\xi)\phi_l(\xi) d\xi = \frac{h_j}{2} \delta_{kl}$
  这意味着[质量矩阵](@entry_id:177093)是一个[对角矩阵](@entry_id:637782)，甚至是[单位矩阵](@entry_id:156724)的标量倍。[@problem_id:3378336] [@problem_id:3378369]
  
- 如果使用**[节点基](@entry_id:752522)**，[拉格朗日多项式](@entry_id:142463)在 $L^2$ 意义下通常不是正交的。因此，精确计算积分会得到一个**稠密的 (dense)** 质量矩阵。然而，如果采用与[节点基](@entry_id:752522)的插值点重合的求积点（即配点求积），可以利用[拉格朗日基](@entry_id:751105)的插值性质实现**[质量集中](@entry_id:175432) (mass lumping)**，从而得到一个对角化的[质量矩阵](@entry_id:177093)。[@problem_id:3378345]

#### DG方法的局部性

DG方法的一个关键优势是其高度的**局部性 (locality)** 和并行性，这直接源于其函数空间的[不连续性](@entry_id:144108)。[@problem_id:3378386]
1.  **分[块对角质量矩阵](@entry_id:140573)**：由于每个[基函数](@entry_id:170178) $\phi_k^{(j)}$ 的支集严格限制在单个单元 $K_j$ 内，全局[质量矩阵](@entry_id:177093)是分块对角阵，每个块是对应单元的局部[质量矩阵](@entry_id:177093) $M^{(j)}$。这意味着求解质量矩阵的逆（在[显式时间积分](@entry_id:165797)中是必需的）可以逐单元独立进行，这是一个高度并行的过程。
2.  **局部计算**：弱形式中的[体积分](@entry_id:171119)项，如 $\int_{K_j} f(u_h) \partial_x v_h \, dx$，只涉及单元 $K_j$ 内部的量，因此也可以在每个单元上独立计算。
3.  **局部通信**：单元间的耦合完全通过边界上的数值通量实现。计算单元 $K_j$ 的更新只需要其直接相邻单元 $K_{j-1}$ 和 $K_{j+1}$ 的解在界面上的迹（trace），而不需要任何更远单元的信息。

综上所述，DG方法将一个大的全局[问题分解](@entry_id:272624)为一系列小的、仅通过最近邻耦合的局部问题，这使其非常适合[大规模并行计算](@entry_id:268183)。

### 线性平流方程的分析

我们以最简单的[双曲守恒律](@entry_id:147752)——一维线性[平流方程](@entry_id:144869) $u_t + a u_x = 0$ ($a$为常数)——为例，深入分析[DG格式](@entry_id:178043)的性质。

#### 强形式与弱形式的等价性

[DG方法](@entry_id:748369)的空间算子可以写作两种代数上等价的形式：**强形式 (strong form)** 和**弱形式 (weak form)**。我们之[前推](@entry_id:158718)导出的形式，将微分算子作用在测试函数上，通常被称为弱形式。如果我们将[分部积分](@entry_id:136350)反向进行，将微分算子保留在解 $u_h$ 上，就得到强形式。这两种形式在精确积分下是完全等价的，因为它们的差别仅在于一个[分部积分恒等式](@entry_id:197773)。通过精心设计的表面项，可以证明两种形式会得到完全相同的半离散算子。[@problem_id:3378367] 这种等价性在分析和实现中都非常重要，它为选择更方便的计算形式提供了灵活性。

#### L²稳定性和[数值耗散](@entry_id:168584)

格式的稳定性是数值计算的生命线。对于DG方法，我们可以通过构造能量估计来分析其**L²稳定性 (L² stability)**。将测试函数选为解本身 ($v_h=u_h$)，并在整个区域上对所有单元求和，经过一番推导可以得到全局 $L^2$ 范数的时间演化方程：

$\frac{1}{2} \frac{d}{dt} \|u_h\|_{L^2(\Omega)}^2 = - \sum_{\text{interfaces}} \int_{\text{interface}} (a\{u_h\} - \hat{f})[u_h] \, dS$

其中 $\{u_h\} = \frac{1}{2}(u_h^- + u_h^+)$ 是解在界面上的平均，$[u_h] = u_h^+ - u_h^-$ 是解在界面上的跳跃。[@problem_id:3378382]

要使格式稳定，即 $\|u_h\|$ 不随时间增长，右侧的求和项必须小于等于零。这意味着每一项被积函数 $(a\{u_h\} - \hat{f})[u_h]$ 都应该是半正定的。这正是对数值通量 $\hat{f}$ 的要求。我们来考察几种常见的[数值通量](@entry_id:752791)：

- **[中心通量](@entry_id:747204) (Central Flux)**: $\hat{f} = a\{u_h\}$。此时，界面贡献项为零，$\frac{d}{dt}\|u_h\|^2 = 0$。这意味着 $L^2$ 能量被精确守恒。这种格式是**中性稳定 (neutrally stable)** 的，但它没有引入任何**[数值耗散](@entry_id:168584) (numerical dissipation)** 来抑制非物理[振荡](@entry_id:267781)，因此对于包含不光滑特征的解通常不够鲁棒。

- **[迎风通量](@entry_id:143931) (Upwind Flux)**: $\hat{f} = a u^{\text{upwind}}$，其中 $u^{\text{upwind}}$ 取决于波的传播方向。例如，若 $a>0$，波从左向右传播，则迎风状态为左侧状态 $u_h^-$。[迎风通量](@entry_id:143931)可以统一写成 $\hat{f} = a\{u_h\} - \frac{|a|}{2}[u_h]$。代入能量估计，界面贡献项变为 $\frac{|a|}{2}[u_h]^2 \ge 0$。因此，$\frac{d}{dt}\|u_h\|^2 = -\sum |a|[u_h]^2 \le 0$。这表明能量是耗散的，格式是 $L^2$ 稳定的。能量的耗散正比于解在界面跳跃的平方，这有助于抑制[振荡](@entry_id:267781)。

- **Lax-Friedrichs (LF) 通量**: $\hat{f} = a\{u_h\} - \frac{\alpha}{2}[u_h]$，其中 $\alpha$ 是一个大于等于最大特征速度[绝对值](@entry_id:147688)（此处为 $|a|$）的参数。界面贡献项为 $\frac{\alpha}{2}[u_h]^2 \ge 0$，因此格式也是 $L^2$ 稳定的。LF通量引入的耗散强度可以通过参数 $\alpha$ 来调节。

这个分析揭示了[数值通量](@entry_id:752791)设计的核心：它不仅是连接单元的桥梁，也是控制格式稳定性和数值耗散的关键机制。[@problem_id:3378382]

### [非线性](@entry_id:637147)问题：[伯格斯方程](@entry_id:177995)

当我们将DG方法应用于[非线性](@entry_id:637147)守恒律，如无粘[伯格斯方程](@entry_id:177995) $u_t + \partial_x(\frac{1}{2}u^2) = 0$，会出现新的挑战。

#### [守恒形式](@entry_id:747710)的必要性

[伯格斯方程](@entry_id:177995)可以写作[非守恒形式](@entry_id:752551) $u_t + u u_x = 0$。对于光滑解，这两种形式是等价的。然而，[双曲守恒律](@entry_id:147752)的解通常会发展出间断（激波）。对于间断解，Rankine-Hugoniot间断关系必须满足，而这是从积分形式的守恒律推导出来的。因此，一个能够正确捕捉激波的[数值格式](@entry_id:752822)**必须**基于[守恒形式](@entry_id:747710)的方程进行离散。

如果我们错误地基于[非守恒形式](@entry_id:752551)构建[DG格式](@entry_id:178043)，当解出现间断时，格式将无法保证单元平均值的守恒性。具体来说，通过选取测试函数 $v_h=1$ 来考察单元平均值 $\bar{u}_j$ 的演化，可以发现，非[守恒格式](@entry_id:747715)的离散通量在相邻单元间无法相互抵消，从而导致虚假的源或汇，破坏了离散守恒性。而基于[守恒形式](@entry_id:747710)的[DG格式](@entry_id:178043)，只要数值通量 $\hat{f}$ 在界面上是单值的（即从左单元看的流出等于从右单元看的流入），就能精确地保证单元平均值的守恒。这是捕捉正确激波速度和强度的先决条件。[@problem_id:3378339]

#### [非线性](@entry_id:637147)项的混淆与分裂格式

在[DG方法](@entry_id:748369)中，[非线性](@entry_id:637147)项（如[伯格斯方程](@entry_id:177995)中的 $u_h^2$）的处理带来了另一个微妙的问题：**混淆 (aliasing)**。当我们在单元内计算形如 $\int_K (\partial_x f(u_h)) v_h \, dx$ 的[体积分](@entry_id:171119)时，如果采用[数值求积](@entry_id:136578)，由于被积函数 $(\partial_x f(u_h)) v_h$ 的次数可能很高（对于 $\mathbb{P}^p$ 近似和[伯格斯方程](@entry_id:177995)，次数可达 $3p-1$），标准求积公式（如与[节点基](@entry_id:752522)对应的[Gauss-Lobatto求积](@entry_id:749739)）可能不够精确。

这种不精确的积分会破坏离散的分部积分性质，导致之前讨论的强形式和[弱形式](@entry_id:142897)在代数上不再等价。[@problem_id:3378401] 这种不等价性可能导致[非线性](@entry_id:637147)不稳定。为了解决这个问题，可以采用以下策略：
1.  **过积分 (Over-integration)**：使用足够高精度的求积公式来精确计算[非线性](@entry_id:637147)项的积分。例如，对于[伯格斯方程](@entry_id:177995)和 $\mathbb{P}^p$ 基，需要一个能精确积分 $3p-1$ 次多项式的[求积公式](@entry_id:753909)。
2.  **反混淆 (De-aliasing)**：在计算积分前，先将[非线性](@entry_id:637147)通量 $f(u_h)$（一个 $2p$ 次多项式）$L^2$ 投影回 $\mathbb{P}^p$ 空间，然后再进行积分。这需要一个能精确积分 $3p$ 次多项式的[求积公式](@entry_id:753909)。
3.  **分裂格式 (Split Forms)**：重新构造体积项，使其天然具有更好的稳定性质。例如，使用[熵守恒通量](@entry_id:749013)或对称的skew-symmetric形式。这些**分裂格式**通过在离散层面恢复分部积分的对称性，可以有效地控制混淆误差并增强[非线性](@entry_id:637147)稳定性，即使在使用标准求积时也能恢复强弱形式的等价性。[@problem_id:3378401]

### 逼近理论与[时间积分](@entry_id:267413)

最后，我们讨论DG方法的两个重要方面：其[高阶精度](@entry_id:750325)的理论基础和[时间离散化](@entry_id:169380)的实际考虑。

#### 逼近误差

[DG方法](@entry_id:748369)之所以备受青睐，一个重要原因是它能够系统地达到任意[高阶精度](@entry_id:750325)。其理论基础在于[多项式逼近理论](@entry_id:753571)。给定一个足够光滑的函数 $u \in H^{p+1}(K_j)$（即函数及其直到 $p+1$ 阶的导数都在 $L^2(K_j)$ 中），它在 $\mathbb{P}^p(K_j)$ 空间中的最佳 $L^2$ 逼近，即它的 **$L^2$ 投影 (L² projection)** $u_h$，满足如下[误差估计](@entry_id:141578)：

$\|u - u_h\|_{L^2(K_j)} \le C h_j^{p+1} \|u\|_{H^{p+1}(K_j)}$

其中 $C$ 是一个不依赖于单元尺寸 $h_j$ 的常数。$L^2$ 投影 $u_h$ 由正交条件 $(u-u_h, v_h)_{K_j}=0$ 对所有 $v_h \in \mathbb{P}^p(K_j)$ 唯一确定。这个估计表明，通过增加多项式次数 $p$（$p$-refinement）或减小单元尺寸 $h_j$（$h$-refinement），我们可以系统地减小逼近误差。对于光滑解，DG方法可以实现阶数为 $p+1$ 的[收敛率](@entry_id:146534)。[@problem_id:3378395]

#### 时间积分：[强稳定保持方法](@entry_id:755294)

DG[空间离散化](@entry_id:172158)最终得到一个[常微分方程组](@entry_id:266774)（ODEs），形式为 $\frac{d\mathbf{U}}{dt} = \mathcal{L}(\mathbf{U})$，其中 $\mathbf{U}$ 是所有自由度的向量，$\mathcal{L}$ 是包含[体积分](@entry_id:171119)和面积分贡献的DG空间算子。为了保持整个格式的稳定性和精度，[时间积分格式](@entry_id:165373)的选择至关重要。

对于包含激波等间断的解，我们通常希望空间离散算子满足某些[非线性](@entry_id:637147)稳定性，如总变差不增（Total Variation Diminishing, TVD）。一个自然的要求是，[时间积分格式](@entry_id:165373)不应破坏这种良好的性质。**强稳定保持 (Strong Stability Preserving, SSP)** Runge-Kutta 方法正是为此而设计的。

[SSP方法](@entry_id:755294)的关键思想是，如果[前向欧拉法](@entry_id:141238)在时间步长 $\Delta t \le \Delta t_{FE}$下是TVD的，那么一个具有SSP系数 $C$ 的 $s$ 阶[Runge-Kutta方法](@entry_id:144251)，在时间步长 $\Delta t \le C \cdot \Delta t_{FE}$下也能保持TVD性质。这是因为这类RK方法的一个时间步可以被分解为一系列[凸组合](@entry_id:635830)形式的前向欧拉步骤。因此，使用[SSP方法](@entry_id:755294)可以采用比简单前向欧拉法大得多的时间步长，同时保证[非线性](@entry_id:637147)稳定性。对于DG方法，[前向欧拉法](@entry_id:141238)的稳定性步长 $\Delta t_{FE}$ 通常由一个CFL类型的条件决定，而[SSP方法](@entry_id:755294)则允许我们将此CFL数有效地放大 $C$ 倍。[@problem_id:3378337]