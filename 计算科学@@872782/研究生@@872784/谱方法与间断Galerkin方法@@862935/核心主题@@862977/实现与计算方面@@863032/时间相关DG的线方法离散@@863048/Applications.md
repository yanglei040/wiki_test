## 应用与交叉学科联系

### 引言

在前面的章节中，我们已经详细阐述了用于求解时间相关问题的间断伽辽金（DG）方法的原理和机制，重点是建立半离散的常微分方程（ODE）系统。然而，从理论公式到能够解决现实世界科学与工程问题的可靠数值模拟工具，还需要跨越巨大的鸿沟。实际应用中充满了各种挑战，这些挑战源于复杂的物理现象、不规则的几何形状以及对计算效率的严苛要求。

本章的宗旨在弥合理论与实践之间的差距。我们不会重复介绍核心概念，而是将探讨如何在多样化、跨学科的应用背景下运用、扩展和整合这些基本原理。我们将通过一系列面向应用的问题，展示 DG-MoL（方法线）框架的强大功能和灵活性。这些问题将引导我们思考如何处理多尺度物理、[非线性](@entry_id:637147)现象（如激波）、移动边界、复杂的计算域，以及如何为大规模模[拟设](@entry_id:184384)计高效的算法。通过这些探索，读者将深刻理解将 DG 方法从教科书中的理想化模型转化为前沿研究和工程实践中强大工具所涉及的艺术和科学。

### 从公式化到全离散化：实用的[时间积分方法](@entry_id:136323)

将 DG [空间离散化](@entry_id:172158)应用于一个时间相关的[偏微分方程](@entry_id:141332)（PDE）后，我们得到一个常微分方程（ODE）系统，其形式为 $\dot{u} = \mathcal{L}(u)$，其中 $\mathcal{L}$ 是 DG 空间算子。方[法线](@entry_id:167651)（MoL）框架的下一步是为这个 ODE 系统选择并应用一个时间积分器。这个过程被称为全离散化。

对于许多由 DG 方法（尤其是在双曲问题中）产生的[半离散系统](@entry_id:754680)，其稳定性受到严格的 [Courant-Friedrichs-Lewy (CFL) 条件](@entry_id:747986)限制。显式龙格库塔（Explicit Runge-Kutta, RK）方法由于其易于实现且无需解[线性系统](@entry_id:147850)而成为一种流行的选择。在这些方法中，强稳定性保持（Strong Stability Preserving, SSP）RK 方法尤为重要。它们被设计用来保证在满足一定[时间步长限制](@entry_id:756010)的条件下，可以保持由一个（单调的）前向欧拉步所满足的某些[非线性](@entry_id:637147)稳定性性质（例如总变差不增，TVD）。

一个典型的例子是三阶三级 SSPRK 方法，即 SSPRK(3,3)。当应用于 DG [半离散系统](@entry_id:754680) $\dot{u} = M^{-1}R(u)$ 时（其中 $M$ 是[质量矩阵](@entry_id:177093)，$R(u)$ 是空间残差），其全离散格式由一系列阶段更新组成。在每个阶段，我们首先使用当前解（或前一阶段的解）计算 DG 残差 $R(\cdot)$，然后通过求解一个由质量矩阵定义的[线性系统](@entry_id:147850)来应用 $M^{-1}$（在实践中，由于 $M$ 是块对角的，这个求解过程非常高效）。例如，SSPRK(3,3) 方法的三个阶段可以写成一系列凸组合，每个阶段都涉及到对先前阶段结果的更新和一次算子 $M^{-1}R(\cdot)$ 的评估。为了分析该方法的线性稳定性，可以将其应用于线性标量测试方程 $\dot{u} = \lambda u$，此时全离散更新可以表示为 $u^{n+1} = G(z)u^n$，其中 $z = \lambda \Delta t$，$G(z)$ 是该方法的稳定性多项式。对于 SSPRK(3,3)，这个多项式是 $G(z) = 1 + z + \frac{1}{2}z^2 + \frac{1}{6}z^3$，它与[指数函数](@entry_id:161417) $\exp(z)$ 的泰勒展开式的前四项相匹配，这证实了该方法的三阶精度 [@problem_id:3399457]。

### 应对复杂的物理与多尺度问题

现实世界的问题往往涉及多种物理现象，这些现象可能在不同的时间尺度上发生，或者表现出强烈的[非线性](@entry_id:637147)行为，例如激波或复杂的[平衡态](@entry_id:168134)。DG-MoL 框架的灵活性使其能够通过巧妙地设计空间和时间离散格式来应对这些挑战。

#### [对流](@entry_id:141806)[扩散](@entry_id:141445)问题与 IMEX 方法

一个常见的例子是[对流扩散方程](@entry_id:152018)，例如 $u_t + \nabla \cdot f(u) = \nabla \cdot (\nu \nabla u)$。这类问题结合了[双曲性](@entry_id:262766)（[对流](@entry_id:141806)项）和抛物性（[扩散](@entry_id:141445)项）。当粘性系数 $\nu$ 很小时，[扩散](@entry_id:141445)项通常要求非常小的时间步长才能保证[显式时间积分](@entry_id:165797)的稳定性（通常 $\Delta t \sim h^2/\nu$），而[对流](@entry_id:141806)项的稳定性限制则宽松得多（$\Delta t \sim h/|a|$）。在这种“刚性”情况下，使用一个全局的显式方法会因为[扩散](@entry_id:141445)项的稳定性要求而变得极其低效。

一个有效的解决方案是采用隐式-显式（Implicit-Explicit, IMEX）龙格库塔方法。其核心思想是将半离散[算子分解](@entry_id:154443)为显式部分（非刚性，如此处的[对流](@entry_id:141806)项 $C(U)$）和隐式部分（刚性，如此处的[扩散](@entry_id:141445)项 $K_{\nu}U$）。[半离散系统](@entry_id:754680)写为 $M\dot{U} = E(U) + I(U)$。在每个 IMEX-RK 阶段，显式部分 $E(U)$ 使用显式 RK 格式进行评估，而隐式部分 $I(U)$ 则使用[隐式格式](@entry_id:166484)。对于[对流](@entry_id:141806)[扩散](@entry_id:141445)问题，通常采用[对称内部罚](@entry_id:755719)伽辽金（Symmetric Interior Penalty Galerkin, SIPG）方法离散化[扩散](@entry_id:141445)项，它会产生一个对称正定的[刚度矩阵](@entry_id:178659) $K$。如果 IMEX 格式是对角隐式龙格库塔（Diagonally Implicit [Runge-Kutta](@entry_id:140452), DIRK）类型，那么在每个阶段，我们需要求解一个形如 $(M - \Delta t \gamma I'(U)) U^{(i)} = \dots$ 的[线性系统](@entry_id:147850)。对于线性[扩散](@entry_id:141445) $I(U) = -\nu K U$，该系统变为 $(M + \Delta t \gamma \nu K) U^{(i)} = \dots$。如果 DIRK 方法的所有对[角系数](@entry_id:756502) $\gamma$ 都相同（即 SDIRK），那么在整个时间步中我们只需要分解一次矩阵 $(M + \Delta t \gamma \nu K)$，从而显著提高计算效率 [@problem_id:3399430]。

#### [算子分裂](@entry_id:634210)与[单体](@entry_id:136559) IMEX 方法的比较

除了[单体](@entry_id:136559)（monolithic）IMEX 方法外，[算子分裂](@entry_id:634210)是处理多物理场问题的另一种常用技术。例如，Strang [分裂法](@entry_id:755245)将[对流](@entry_id:141806)和[扩散算子](@entry_id:136699)分开处理，通过交替求解[对流](@entry_id:141806)方程和扩散方程来推进一个时间步。这种方法实现起来可能更简单，因为它允许为每个子问题使用最优的求解器。

然而，[算子分裂](@entry_id:634210)会引入一种额外的误差，即“[分裂误差](@entry_id:755244)”，它源于两个离散算子通常不可交换。对于线性[对流](@entry_id:141806)[扩散](@entry_id:141445)问题，其半离散算子为 $A$（[对流](@entry_id:141806)）和 $B$（[扩散](@entry_id:141445)），[分裂误差](@entry_id:755244)的主要项与[交换子](@entry_id:158878) $[A,B]=AB-BA$ 有关。在某些情况下，这个[分裂误差](@entry_id:755244)可能非常大，从而主导总的[数值误差](@entry_id:635587)。通过量纲分析可以发现，[分裂误差](@entry_id:755244)的大小与无量纲的网格佩克莱数 $Pe = ah/\nu$ 密切相关。在[对流](@entry_id:141806)主导的区域（$Pe \gg p$，其中 $p$ 是多项式次数），[分裂误差](@entry_id:755244)相对于[单体](@entry_id:136559) IMEX 方法固有的截断误差来说非常小，此时两种方法的精度相当。然而，在[扩散](@entry_id:141445)主导或[对流](@entry_id:141806)[扩散平衡](@entry_id:150874)的区域（$Pe \lesssim p$），[分裂误差](@entry_id:755244)可能会变得非常显著，甚至超过 IMEX 方法的误差，导致精度下降。因此，在选择时间积分策略时，必须考虑所模拟的物理机制 [@problem_id:3399400]。

#### 带有激波的[非线性](@entry_id:637147)问题

将高阶 DG 方法应用于[非线性](@entry_id:637147)[双曲守恒律](@entry_id:147752)时，一个主要的挑战是如何处理解中可能出现的激波或其他[不连续性](@entry_id:144108)。标准的高阶方法在不连续点附近会产生非物理的[振荡](@entry_id:267781)（[吉布斯现象](@entry_id:138701)），可能导致计算不稳定。

为了解决这个问题，通常会引入“激波捕捉”机制。一种流行的方法是混合 DG/有限体积（Finite Volume, FV）方法。该方法使用一个“问题单元检测器”来识别可能出现激波的单元。在这些被标记的“问题单元”内部，DG 方法的演化被暂停，取而代之的是一个更稳健的低阶方法，例如在一个更精细的[子网](@entry_id:156282)格上使用一阶或二阶的有限体积格式。这种子单元 FV 格式通常包含[数值粘性](@entry_id:142854)（可以是显式的，也可以是数值通量本身固有的），以抑制[振荡](@entry_id:267781)并稳定计算。当一个单元从 DG 模式切换到 FV 模式时，其局部的稳定性约束也会发生改变。例如，一个引入了[人工粘性](@entry_id:142854) $\nu_s$ 的一阶 FV 子单元格式，其稳定的时间步长将同时受到[对流](@entry_id:141806)速度 $a$ 和人工粘性 $\nu_s$ 的限制，通常形式为 $\Delta t \le 1 / (a/\Delta x_{\text{sub}} + 2\nu_s/\Delta x_{\text{sub}}^2)$，其中 $\Delta x_{\text{sub}}$ 是子单元的宽度。这通常比纯 DG 格式的 CFL 限制更为严格，需要在[自适应时间步进](@entry_id:142338)算法中加以考虑 [@problem_id:3399408]。

#### 平衡律与守恒型格式

许多物理系统由平衡律来描述，其形式为 $u_t + f(u)_x = s(u,x)$，其中[源项](@entry_id:269111) $s(u,x)$ 可能与通量梯度 $f(u)_x$ 相平衡，形成一个非平凡的[稳态解](@entry_id:200351) $u^*(x)$。例如，在带有地形的浅水波方程中，水流的重力效应（[源项](@entry_id:269111)）可以与水压梯度（通量梯度）精确平衡。对于这类问题，一个关键要求是[数值格式](@entry_id:752822)能够精确地（或以高精度）保持这种[稳态](@entry_id:182458)，这种性质被称为“守恒型”（well-balanced）。

标准的 DG 格式在离散层面通常无法精确保持这种平衡，因为[数值积分误差](@entry_id:137490)和离散算子本身会破坏通量梯度和[源项](@entry_id:269111)之间的精确抵消。这会导致在[稳态解](@entry_id:200351)附近产生虚假的[振荡](@entry_id:267781)和误差。为了构建守恒型格式，一种现代而强大的技术是“波动分裂”（fluctuation-splitting）或“平衡重构”（equilibrium reconstruction）方法。其核心思想是将解 $u_h$ 分解为一个已知的离散平衡态 $u^*_{\text{disc}}$ 和一个波动量 $w_h = u_h - u^*_{\text{disc}}$。然后，将整个 DG 格式重新写成关于波动量 $w_h$ 的[演化方程](@entry_id:268137)。通过精心设计，使得当波动量为零（即 $u_h = u^*_{\text{disc}}$）时，离散的残差项恒为零。这样，只要数值解被初始化为离散[稳态](@entry_id:182458)，它就会在时间积分过程中保持不变。任何标准的 Runge-Kutta 时间积分器都能保持这个性质，因为当 ODE 的右端项（残差）为零时，所有 RK 阶段的增量也都为零 [@problem_id:3399464]。

#### [非线性系统](@entry_id:168347)的[熵稳定性](@entry_id:749023)

对于一般的[非线性](@entry_id:637147)[双曲系统](@entry_id:260647)，[线性稳定性分析](@entry_id:154985)（如[能量稳定性](@entry_id:748991)）是不够的。正确的稳定性概念是“[熵稳定性](@entry_id:749023)”，它要求数值解满足一个离散形式的[熵不等式](@entry_id:184404)，这对应于物理上的[热力学第二定律](@entry_id:142732)。一个熵稳定的空间离散格式，通常通过使用[熵守恒](@entry_id:749018)/熵耗散的数值通量和特殊的求积（如 SBP 求积）来构造，可以保证[半离散系统](@entry_id:754680)满足一个[熵不等式](@entry_id:184404)，即 $\frac{d}{dt}E_h(U(t)) \le 0$（在没有边界通量的情况下），其中 $E_h$ 是总的离散熵。

接下来的问题是，如何选择时间积分器来保持这个性质，从而得到一个全离散的[熵稳定格式](@entry_id:749017)。一个非常有效的途径是利用强稳定性保持（SSP）Runge-Kutta 方法。如果一个[半离散格式](@entry_id:165671)对于前向欧拉步是熵稳定的（在某个[时间步长限制](@entry_id:756010)下），那么由于 SSP-RK 方法的更新过程可以表示为一系列前向欧拉步的[凸组合](@entry_id:635830)，并且熵函数是[凸函数](@entry_id:143075)，利用延森不等式可以证明，SSP-RK 方法在相应的 CFL 限制下也能保持[熵稳定性](@entry_id:749023)。这为构造高阶、[非线性](@entry_id:637147)稳定的全离散格式提供了一个系统性的框架 [@problem_id:3399472]。

### 适应现实世界：几何与边界

将 DG 方法应用于实际问题，首先要面对的就是如何处理复杂的几何形状和真实的边界条件。标准的矩形网格和周期性边界在教科书中很方便，但在工程应用中却很少见。

#### 复杂几何与弯曲单元

为了模拟飞机机翼周围的气流或人体血管中的血液流动，[计算网格](@entry_id:168560)必须能精确地贴合物体的弯曲边界。高阶 DG 方法的一大优势就是它能够自然地处理弯曲单元。这通常通过等参（isoparametric）映射实现，即用与逼近解的[基函数](@entry_id:170178)相同次数（或不同次数）的多项式来描述从一个简单的参考单元（如正方形或立方体）到物理空间中弯曲单元的[几何映射](@entry_id:749852)。

然而，这种几何上的灵活性带来了计算上的挑战。当使用非仿射（即弯曲）的映射时，映射的雅可比行列式 $J$ 不再是常数，而是一个多项式。这会改变 DG 弱形式中所有积分项的被积函数的次数。例如，质量矩阵项的被积函数为 $\phi_i \phi_j J$，其次数会因为雅可比行列式 $J$ 的存在而增加。为了精确计算这些积分（或者为了保持稳定性所需的离散守恒性质），必须使用更高阶的[求积法则](@entry_id:753909)。具体来说，如果解的多项式次数为 $p$，[几何映射](@entry_id:749852)的多项式次数为 $p_g$，那么为了精确计算[质量矩阵](@entry_id:177093)，求积法则必须能精确积分次数高达 $2p + 2p_g - 1$ 的多项式。类似地，为了保证线性稳定性，边界积分也需要更高阶的求积。这揭示了在[高阶方法](@entry_id:165413)中，几何表示与数值离散之间深刻的相互作用 [@problem_id:3399418]。

#### 移动区域：ALE 公式

许多重要的应用，如[流固耦合](@entry_id:171183)、燃烧或材料加工，都涉及到计算区域随时间移动或变形。为了在这种情况下求解 PDE，任意拉格朗日-欧拉（Arbitrary Lagrangian-Eulerian, ALE）框架是一个强大的工具。在 ALE 方法中，网格可以独立于流体质点运动，从而允许对[网格运动](@entry_id:163293)进行优化控制，以保持单元质量。

当将 DG-MOL 框架应用于 ALE 公式时，控制方程需要在移动的参考[坐标系](@entry_id:156346)中重新推导。这会导致原始的 PDE 发生改变。例如，对于一维线性[平流方程](@entry_id:144869) $u_t + a u_x = 0$，如果网格以恒定速度 $w$ 运动，那么在随动参考[坐标系](@entry_id:156346) $\xi$ 中，方程会变为 $\tilde{u}_t + (a-w)\tilde{u}_{\xi} = 0$。这里的[平流](@entry_id:270026)速度从物理速度 $a$ 变为了[相对速度](@entry_id:178060) $a-w$。因此，DG 空间离散[算子的谱](@entry_id:272027)（[特征值](@entry_id:154894)）将由 $|a-w|$ 决定，而不是 $|a|$。这直接影响了[显式时间积分](@entry_id:165797)的稳定性约束。相对于静态网格，[时间步长限制](@entry_id:756010)将按比例因子 $|a|/|a-w|$ 进行缩放。如果网格与流动同向运动，CFL 限制会放宽；如果网格与流动反向运动，CFL 限制则会变得更加严格。这个简单的结果清晰地揭示了[网格运动](@entry_id:163293)如何改变显式 DG 方法的稳定性边界 [@problem_id:3399428]。

#### [时变边界条件](@entry_id:150189)

在许多应用中，边界条件本身就是随时间变化的，例如，一个入口的流速或温度随时间脉动。在 DG-MOL 框架中，这些[时变边界条件](@entry_id:150189)通过数值通量自然地融入到[半离散系统](@entry_id:754680)中。

以一维平流方程为例，假设在[入口边界](@entry_id:187498) $x=0$ 处给定一个[时变边界条件](@entry_id:150189) $u(0,t) = g(t)$。在使用[迎风通量](@entry_id:143931)时，数值通量 $\hat{u}$ 在该边界上直接取为给定的边界值 $g(t)$。当推导半离散 ODE 系统时，这个时变的函数 $g(t)$ 会成为 ODE 系统的一个非齐次（驱动）项。例如，对于一个包含[入口边界](@entry_id:187498)的单元，其控制方程可能形如 $\dot{\mathbf{a}}(t) = \mathbf{M}\mathbf{a}(t) + \mathbf{f}(t)$，其中驱动向量 $\mathbf{f}(t)$ 依赖于 $g(t)$。分析这样一个系统的稳定性需要考虑由矩阵 $\mathbf{M}$ 的[特征值](@entry_id:154894)决定的内部动力学。时间步长的选择必须保证[时间积分](@entry_id:267413)器能够稳定地处理这个系统的齐次部分。对于一个给定的强稳定性保持（SSP）RK 方法，其最大[稳定时间步长](@entry_id:755325)最终取决于由单元尺寸、多项式次数和物理速度决定的[特征值](@entry_id:154894)谱 [@problem_id:3399432]。

### [高性能计算](@entry_id:169980)与算法效率

将 DG 方法应用于具有数百万甚至数十亿自由度的大规模问题，需要关注算法的每一个细节，以最大限度地提高[计算效率](@entry_id:270255)和减少内存占用。这使得 DG 方法的研究与高性能计算和计算科学领域紧密相连。

#### 实现选择：[模态基](@entry_id:752055)与[节点基](@entry_id:752522)

在实现 DG 方法时，一个基本的选择是使用哪种类型的[基函数](@entry_id:170178)来表示单元内的多项式解。两种常见的选择是[模态基](@entry_id:752055)（modal basis）和[节点基](@entry_id:752522)（nodal basis）。

*   **[模态基](@entry_id:752055)** 通常使用一组正交多项式，如勒让德多项式。在这种基下，[质量矩阵](@entry_id:177093) $M$ 在精确积分下是对角的，这使得求 $M^{-1}$ 的过程变得非常简单。然而，刚度矩阵（例如来[自扩散](@entry_id:754665)项的矩阵）通常是带状或稀疏的，但不是对角的。
*   **[节点基](@entry_id:752522)** 通常与一组特定的求积点（如 [Legendre-Gauss-Lobatto](@entry_id:751235), LGL 节点）相关联。在这种基下，如果使用与[基函数](@entry_id:170178)节点重合的求积点（即所谓的“谱元”或配点方法），质量矩阵由于求积的正交性也会变成对角的（这一过程称为“[质量集中](@entry_id:175432)”）。[节点基](@entry_id:752522)的主要优势在于通量和[非线性](@entry_id:637147)项的计算非常高效，因为它们只需要在节点上进行点态操作。然而，[微分算子](@entry_id:140145)（以及相应的[刚度矩阵](@entry_id:178659)）在[节点基](@entry_id:752522)下通常是稠密的。

尽管刚度矩阵在[节点基](@entry_id:752522)下是稠密的，但这并不意味着算子应用的成本就高。对于[张量积](@entry_id:140694)单元（二维的四边形或三维的六面体），无论使用[模态基](@entry_id:752055)还是[节点基](@entry_id:752522)，都可以利用“[和因子分解](@entry_id:755628)”（sum-factorization）技术，将多维操作分解为一系列一维操作。这使得算子应用的计算成本从 $\mathcal{O}(p^{2d})$ 降低到 $\mathcal{O}(p^{d+1})$（其中 $d$ 是空间维度），这对于高阶方法 ($p$ 较大) 来说是至关重要的。[节点基](@entry_id:752522)和[模态基](@entry_id:752055)的选择还深刻影响着[预条件子](@entry_id:753679)的设计和效率 [@problem_id:3399454]。

#### 求解隐式系统：[Newton-Krylov](@entry_id:752475) 与预条件

对于需要[隐式时间积分](@entry_id:171761)的问题（如前面讨论的 IMEX 方法或用于[非线性](@entry_id:637147)问题的[隐式方法](@entry_id:137073)），每个时间步或每个牛顿迭代步都需要求解一个大型的[线性系统](@entry_id:147850)，形如 $J\delta u = r$。对于大规模问题，直接分解[雅可比矩阵](@entry_id:264467) $J$ 在计算和内存上都是不可行的。

现代的方法是使用迭代的 [Krylov 子空间](@entry_id:751067)求解器，如 GMRES。Krylov 方法的一个关键优势是它们不需要知道矩阵 $J$ 的显式形式，只需要一个能够计算矩阵-向量乘积 $Jv$ 的“黑盒子”函数。这催生了“无矩阵”（matrix-free）技术。利用 Gateaux 导数的定义，$J(u)v = \frac{d}{d\epsilon} R(u+\epsilon v)|_{\epsilon=0}$，可以推导出计算[雅可比](@entry_id:264467)-向量乘积的程序。这个程序的结构与计算残差 $R(u)$ 本身的程序非常相似，只是将物理通量 $f(u)$ 替换为其方向导数 $f'(u)v$。这避免了组装和存储巨大的雅可比矩阵，从而极大地节省了内存 [@problem_id:3399413]。

然而，仅仅有高效的矩阵-向量乘积是不够的。由 DG 方法产生的[线性系统](@entry_id:147850)通常是病态的，导致 Krylov 方法收敛非常缓慢。为了加速收敛，必须使用有效的“[预条件子](@entry_id:753679)”$P$，它是一个易于求逆且能“近似”$J$ 的算子。一个非常有效且广泛使用的策略是“块-[雅可比](@entry_id:264467)”（block-Jacobi）预条件。它只保留了[系统矩阵](@entry_id:172230)的块对角部分，即每个单元内部的贡献，而忽略了单元之间的耦合。由于 DG [质量矩阵](@entry_id:177093)和（部分）[刚度矩阵](@entry_id:178659)的局部性，这个[预条件子](@entry_id:753679)是块对角的，其逆的计算等价于在每个单元上独立地求解一个小得多的局部问题。理论分析表明，对于 SIPG 等格式，只要罚参数选择得当，块-[雅可比预条件子](@entry_id:141670)就能提供与网格尺寸 $h$ 和多项式次数 $p$ 无关的[收敛速度](@entry_id:636873)，使其成为一种非常稳健的预条件策略 [@problem_id:3399405]。针对特定[基函数](@entry_id:170178)，还可以设计更复杂的[预条件子](@entry_id:753679)，例如利用[节点基](@entry_id:752522)的[张量积](@entry_id:140694)结构和快速[对角化方法](@entry_id:273007)（Fast Diagonalization Method, FDM）[@problem_id:3399454]。

#### 自适应方法与多速率时间步进

为了以最少的计算资源达到给定的精度要求，自适应方法是必不可少的。这包括空间自适应（$h/p$-自适应），即在需要的地方加密网格或提高多项式次数，以及时间自适应，即根据解的动态特性调整时间步长。

在一个成熟的自适应 DG-MOL 框架中，分离和控制空间误差与时间误差是核心。空间误差通常通过基于单元残差和界面跳跃项的[后验误差估计](@entry_id:167288)子 $\eta_x$ 来评估。时间误差 $\eta_t$ 则可以由嵌入式 [Runge-Kutta](@entry_id:140452) 对提供。一个稳健的自适应策略是确保[时间积分](@entry_id:267413)的误差始终小于空间离散的误差，例如，通过强制执行条件 $\eta_t \le \theta \eta_x$，其中 $\theta$ 是一个小于 1 的安全因子。如果违反此条件，则应减小时间步长。这确保了空间[误差估计](@entry_id:141578)的可靠性，因为它所作用的数值解 $u_h^n$ 是半离散解 $u_h(t_n)$ 的一个足够精确的近似 [@problem_id:3399447]。

在一个具有高度局部化特征的[自适应网格](@entry_id:164379)上，不同区域的单元尺寸可能相差悬殊。此时，使用全局统一的时间步长会非常低效，因为它受限于最小单元的 CFL 条件。[局部时间步进](@entry_id:751409)（Local Time Stepping, LTS）或多速率（multirate）方法通过允许不同区域的单元采用不同的时间步长来解决这个问题。

实现一个高阶、守恒的多速率 DG 格式是一个巨大的挑战。主要困难在于如何处理不同时间步长区域之间的界面。为了保持[高阶精度](@entry_id:750325)，粗网格一侧必须能向细网格一侧提供在其子时间步长阶段点上的高阶状态预测（通常通过 RK 方法的稠密输出实现）。为了保持守恒性，必须确保在一个粗时间步长内，跨界面交换的总通量对于两侧是相同的。由于粗细两侧使用不同的求积规则来积分时间相关的通量，这通常会导致一个“通量不匹配”。为了精确守恒，必须计算这个不匹配量，并将其作为一个修正项应用到粗网格一侧的更新中，从而确保离散守恒律得到精确满足 [@problem_id:3399449] [@problem_id:3399439]。

### 结论

本章的旅程从一个基本的 DG [半离散系统](@entry_id:754680)出发，探索了将其转化为能够应对真实世界挑战的复杂数值工具所需的各种扩展和连接。我们看到，DG-MOL 框架不仅仅是一个单一的方法，而是一个功能强大的工具箱，充满了用于处理特定物理、几何和计算挑战的专门技术。

从 IMEX 和[算子分裂](@entry_id:634210)方法处理多尺度物理，到守恒型格式精确捕捉平衡态；从 ALE 方法模拟移动域，到弯曲单元处理复杂几何；再到无矩阵 Krylov 方法和多速率时间步进等高性能计算策略——所有这些都展示了 DG 方法的巨大灵活性和广阔的应用前景。

成功的应用不仅需要对 DG 方法本身有深刻的理解，还需要借鉴来自[数值分析](@entry_id:142637)、物理学、计算几何和计算机科学等多个领域的知识。正是这种跨学科的特性，使得 DG 方法成为计算科学与工程中一个充满活力和持续发展的研究领域。