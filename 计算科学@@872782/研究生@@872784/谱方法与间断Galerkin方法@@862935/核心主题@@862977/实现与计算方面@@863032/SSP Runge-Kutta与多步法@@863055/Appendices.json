{"hands_on_practices": [{"introduction": "对于求解双曲型偏微分方程的数值方法，稳定性是一个多方面的概念。虽然线性稳定性分析（如冯·诺依曼分析）是基础，但它并不能保证高阶方法在处理间断或陡峭梯度时不会产生非物理的振荡。本练习将引导你区分两种不同但都至关重要的稳定性限制：线性的 CFL 限制和强稳定性（SSP）限制，并理解为何对于许多应用，后者可能更为关键。[@problem_id:3420323]", "problem": "考虑一维线性平流初值问题 $u_{t} + a\\,u_{x} = 0$，其中平流速度为常数 $a  0$，定义在一个周期性域上，该域被划分为大小为 $h$ 的均匀网格单元。使用间断 Galerkin (DG) 方法，以分片常数 ($p=0$) 基函数和迎风数值通量对空间算子进行离散化。令 $u_{j}(t)$ 表示单元 $j$ 中的单元平均值，并定义无量纲 Courant–Friedrichs–Lewy (CFL) 数 $\\nu = \\frac{a\\,\\Delta t}{h}$，其中 $\\Delta t$ 是时间步长。\n\n1. 从守恒性和 DG 弱形式出发，推导 $u_{j}(t)$ 的半离散演化方程，并使用 Fourier 拟设 $u_{j}(t) = \\hat{u}(t)\\,\\exp(i\\,j\\,\\theta)$ 进行 von Neumann 分析，其中 $\\theta \\in [0,2\\pi]$ 是无量纲波数。求出半离散算子的 Fourier 符号 $\\lambda(\\theta)$，使得 $\\frac{d}{dt}\\hat{u}(t) = \\lambda(\\theta)\\,\\hat{u}(t)$。\n\n2. 对于采用经典的四阶四级显式 Runge–Kutta 方法 (RK$(4,4)$) 进行的时间积分，其线性稳定性函数是指数函数的 4 次 Taylor 多项式：\n$$\np(z) = 1 + z + \\frac{z^{2}}{2} + \\frac{z^{3}}{6} + \\frac{z^{4}}{24},\n$$\n确定最大的 $\\nu$，使得对于所有 $\\theta \\in [0,2\\pi]$，$|p(\\Delta t\\,\\lambda(\\theta))| \\leq 1$ 成立。\n\n3. 独立地，根据更新系数保持非负的要求，确定半离散 DG 算子对 $\\nu$ 的前向欧拉单调性界限。利用强稳定性保持 (SSP) 方法的定义，回顾三阶三级 SSP Runge–Kutta 方法 (SSP RK$(3,3)$) 的 SSP 系数 $C=1$，因此其允许的时间步长受前向欧拉极限的限制。计算 SSP RK$(3,3)$ 的 SSP 限制下的最大 $\\nu$。\n\n将有效 CFL 极限报告为两个界限中的最小值：\n$$\n\\nu_{\\text{active}} = \\min\\left\\{\\nu_{\\text{RK}(4,4)},\\,\\nu_{\\text{SSP}(3,3)}\\right\\}.\n$$\n将 $\\nu_{\\text{active}}$ 表示为一个纯数，并将您的答案四舍五入到四位有效数字。", "solution": "该问题经验证具有科学依据、适定、客观且完整。问题的所有组成部分在偏微分方程数值分析领域都是标准的。我将继续解答。\n\n根据要求，解答分为三个部分：\n1.  推导半离散算子及其 Fourier 符号。\n2.  计算 RK$(4,4)$ 方法的线性稳定性极限。\n3.  计算 SSP RK$(3,3)$ 方法的强稳定性保持 (SSP) 极限。\n最后，将有效 CFL 极限确定为这两个界限的最小值。\n\n第 1 部分：半离散化与 Fourier 符号\n\n一维线性平流方程为\n$$\nu_{t} + a\\,u_{x} = 0\n$$\n其中 $a  0$ 是一个恒定的平流速度。为推导间断 Galerkin (DG) 半离散格式，我们将该偏微分方程乘以一个检验函数 $v_h$，并在一个大小为 $h=x_{j+1/2}-x_{j-1/2}$ 的单元 $I_j = [x_{j-1/2}, x_{j+1/2}]$ 上积分。\n$$\n\\int_{I_j} \\frac{\\partial u_h}{\\partial t} v_h \\,dx + \\int_{I_j} a \\frac{\\partial u_h}{\\partial x} v_h \\,dx = 0\n$$\n这里，$u_h$ 是 DG 函数空间中的近似解。对空间项进行分部积分得到\n$$\n\\int_{I_j} \\frac{\\partial u_h}{\\partial t} v_h \\,dx + \\left[ a u_h v_h \\right]_{x_{j-1/2}}^{x_{j+1/2}} - \\int_{I_j} a u_h \\frac{\\partial v_h}{\\partial x} \\,dx = 0\n$$\n这可以写成\n$$\n\\int_{I_j} \\frac{\\partial u_h}{\\partial t} v_h \\,dx + a u_h(x_{j+1/2}^-, t) v_h(x_{j+1/2}^-) - a u_h(x_{j-1/2}^+, t) v_h(x_{j-1/2}^+) - \\int_{I_j} a u_h \\frac{\\partial v_h}{\\partial x} \\,dx = 0\n$$\n其中 $u_h(x^\\pm)$ 表示从界面左/右侧的极限。$u_h$ 在单元界面处的间断性质要求将通量 $a u_h$ 替换为一个单值的数值通量，记为 $\\widehat{f}(u^-, u^+)$。弱形式变为\n$$\n\\int_{I_j} \\frac{\\partial u_h}{\\partial t} v_h \\,dx + \\widehat{f}_{j+1/2} v_h(x_{j+1/2}^-) - \\widehat{f}_{j-1/2} v_h(x_{j-1/2}^+) - \\int_{I_j} a u_h \\frac{\\partial v_h}{\\partial x} \\,dx = 0\n$$\n对于本问题，我们使用分片常数 ($p=0$) 基函数和检验函数。在单元 $I_j$ 中，解为 $u_h(x,t) = u_j(t)$（单元平均值），我们选择检验函数 $v_h(x) = 1$。对于常数基函数，导数项 $\\frac{\\partial v_h}{\\partial x}$ 为零。弱形式简化为\n$$\n\\int_{I_j} \\frac{d u_j(t)}{dt} (1) \\,dx + \\widehat{f}_{j+1/2} (1) - \\widehat{f}_{j-1/2} (1) = 0\n$$\n$$\nh \\frac{d u_j(t)}{dt} + \\widehat{f}_{j+1/2} - \\widehat{f}_{j-1/2} = 0\n$$\n问题指定使用迎风数值通量。对于 $a0$，通量由“迎风”状态决定，即界面左侧的状态。因此，$\\widehat{f}(u^-, u^+) = a u^-$。\n在界面 $x_{j+1/2}$ 处：$u^- = u_h(x_{j+1/2}^-) = u_j(t)$。通量为 $\\widehat{f}_{j+1/2} = a u_j(t)$。\n在界面 $x_{j-1/2}$ 处：$u^- = u_h(x_{j-1/2}^-) = u_{j-1}(t)$。通量为 $\\widehat{f}_{j-1/2} = a u_{j-1}(t)$。\n将这些通量代入方程，得到单元平均值 $u_j(t)$ 的半离散演化方程：\n$$\nh \\frac{d u_j(t)}{dt} + a u_j(t) - a u_{j-1}(t) = 0\n$$\n$$\n\\frac{d u_j(t)}{dt} = -\\frac{a}{h} \\left( u_j(t) - u_{j-1}(t) \\right)\n$$\n这与一阶迎风有限差分法的半离散格式相同。为了进行 von Neumann 分析，我们代入 Fourier 拟设 $u_j(t) = \\hat{u}(t)\\exp(i j \\theta)$，其中 $\\theta \\in [0, 2\\pi]$ 是无量纲波数。\n$$\n\\frac{d}{dt} \\left( \\hat{u}(t)\\exp(i j \\theta) \\right) = -\\frac{a}{h} \\left( \\hat{u}(t)\\exp(i j \\theta) - \\hat{u}(t)\\exp(i(j-1)\\theta) \\right)\n$$\n提出公因子：\n$$\n\\exp(i j \\theta) \\frac{d\\hat{u}(t)}{dt} = -\\frac{a}{h} \\hat{u}(t)\\exp(i j \\theta) \\left( 1 - \\exp(-i\\theta) \\right)\n$$\n两边同除以 $\\exp(i j \\theta)$，得到 Fourier 模幅值 $\\hat{u}(t)$ 的演化方程：\n$$\n\\frac{d\\hat{u}(t)}{dt} = \\left[ -\\frac{a}{h} (1 - \\exp(-i\\theta)) \\right] \\hat{u}(t)\n$$\n其形式为 $\\frac{d\\hat{u}(t)}{dt} = \\lambda(\\theta)\\hat{u}(t)$，其中 Fourier 符号 $\\lambda(\\theta)$ 是：\n$$\n\\lambda(\\theta) = -\\frac{a}{h} (1 - \\exp(-i\\theta)) = -\\frac{a}{h} (1 - \\cos\\theta + i\\sin\\theta)\n$$\n\n第 2 部分：RK(4,4) 线性稳定性极限\n\n为使时间步进方法稳定，其放大因子的模必须小于或等于 1。对于应用于 $\\frac{dy}{dt} = \\lambda y$ 的显式 Runge-Kutta 方法，更新公式为 $y^{n+1} = p(\\Delta t \\lambda) y^n$，其中 $p(z)$ 是方法的稳定性多项式，且 $z = \\Delta t \\lambda$。稳定性条件是 $|p(z)| \\leq 1$。\n我们问题的宗量 $z$ 是：\n$$\nz = \\Delta t \\lambda(\\theta) = \\Delta t \\left( -\\frac{a}{h} (1 - \\exp(-i\\theta)) \\right) = -\\frac{a \\Delta t}{h} (1 - \\exp(-i\\theta)) = -\\nu (1 - \\exp(-i\\theta))\n$$\n其中 $\\nu = \\frac{a \\Delta t}{h}$ 是 CFL 数。当 $\\theta \\in [0, 2\\pi]$ 时，$z(\\theta)$ 的轨迹是在复平面上以 $-\\nu$ 为中心、半径为 $\\nu$ 的圆。这个圆经过原点 $z=0$（当 $\\theta=0$ 时），其最左点在 $z=-2\\nu$（当 $\\theta=\\pi$ 时）。\n\n为使格式稳定，这个完整的圆形轨迹必须位于 RK$(4,4)$ 方法的稳定域内，即复数 $z$ 的集合，其中 $|p(z)| \\leq 1$ 对于\n$$\np(z) = 1 + z + \\frac{z^{2}}{2} + \\frac{z^{3}}{6} + \\frac{z^{4}}{24}\n$$\n轨迹的稳定性通常受其与负实轴交点的限制。我们找到 RK$(4,4)$ 稳定域在负实轴上的范围。对于负实数 $z=x$，稳定性条件 $|p(x)| \\leq 1$ 变为 $-1 \\leq p(x) \\leq 1$。\n$p(x)$ 对于 $x0$ 的图像显示它从 $p(0)=1$ 开始，减小到一个最小值，然后增加。最小值是正的，所以条件简化为 $p(x) \\leq 1$。\n$$\n1 + x + \\frac{x^{2}}{2} + \\frac{x^{3}}{6} + \\frac{x^{4}}{24} \\leq 1\n$$\n$$\nx + \\frac{x^{2}}{2} + \\frac{x^{3}}{6} + \\frac{x^{4}}{24} \\leq 0\n$$\n$$\nx \\left( 1 + \\frac{x}{2} + \\frac{x^{2}}{6} + \\frac{x^{3}}{24} \\right) \\leq 0\n$$\n由于 $x0$，我们要求括号内的项为非负：\n$$\n1 + \\frac{x}{2} + \\frac{x^{2}}{6} + \\frac{x^{3}}{24} \\geq 0 \\quad \\text{或} \\quad x^3 + 4x^2 + 12x + 24 \\geq 0\n$$\n令 $g(x) = x^3 + 4x^2 + 12x + 24$。我们必须找到 $g(x)=0$ 的根 $x_0$。数值求根得出 $x_0 \\approx -2.78529$。因此，负实轴上的稳定区间约为 $[-2.78529, 0]$。\n$z(\\theta)$ 的轨迹必须包含在这个区域内。轨迹的最左点是 $-2\\nu$。所以，我们必须满足：\n$$\n-2\\nu \\geq -2.78529 \\implies \\nu \\leq \\frac{2.78529}{2} \\approx 1.3926\n$$\n因此，使用 RK$(4,4)$ 方法的线性稳定性的最大 CFL 数为 $\\nu_{\\text{RK}(4,4)} \\approx 1.3926$。\n\n第 3 部分：SSP RK(3,3) 极限\n\n首先，我们确定前向欧拉单调性界限。半离散格式的前向欧拉时间积分为：\n$$\nu_j^{n+1} = u_j^n + \\Delta t \\left( -\\frac{a}{h} (u_j^n - u_{j-1}^n) \\right) = u_j^n - \\nu (u_j^n - u_{j-1}^n)\n$$\n$$\nu_j^{n+1} = (1 - \\nu) u_j^n + \\nu u_{j-1}^n\n$$\n为使该格式保持单调性，新值 $u_j^{n+1}$ 必须是前一步值的凸组合。这要求系数为非负。\n1.  $\\nu \\geq 0$：由于 $a0$，$ \\Delta t0$，$h0$，此条件满足。\n2.  $1 - \\nu \\geq 0$：这意味着 $\\nu \\leq 1$。\n\n因此，前向欧拉单调性界限是 $\\nu_{\\text{FE}} = 1$。\n强稳定性保持 (SSP) 方法旨在保持前向欧拉步的非线性稳定性性质（如单调性），前提是时间步长足够小。对于一个 SSP 系数为 $C$ 的 SSP 方法，其稳定时间步长 $\\Delta t_{\\text{SSP}}$ 与前向欧拉时间步长极限 $\\Delta t_{\\text{FE}}$ 的关系为 $\\Delta t_{\\text{SSP}} \\leq C \\Delta t_{\\text{FE}}$。用 CFL 数表示，即 $\\nu_{\\text{SSP}} \\leq C \\nu_{\\text{FE}}$。\n问题指出 SSP RK$(3,3)$ 方法的 SSP 系数为 $C=1$。因此，其 SSP 限制的 CFL 数为：\n$$\n\\nu_{\\text{SSP}(3,3)} = C \\cdot \\nu_{\\text{FE}} = 1 \\cdot 1 = 1\n$$\n\n最终计算：有效 CFL 极限\n\n有效 CFL 极限是推导出的界限中最严格的（最小的）一个：\n$$\n\\nu_{\\text{active}} = \\min\\left\\{\\nu_{\\text{RK}(4,4)},\\,\\nu_{\\text{SSP}(3,3)}\\right\\}\n$$\n$$\n\\nu_{\\text{active}} = \\min\\left\\{1.3926...,\\,1\\right\\} = 1\n$$\n问题要求将答案四舍五入到四位有效数字。\n$$\n\\nu_{\\text{active}} = 1.000\n$$\n这个结果突显了虽然 RK$(4,4)$ 方法比前向欧拉方法有更大的线性稳定域，但由 SSP RK$(3,3)$ 方法的 SSP 条件所强制的保持单调性的要求，对时间步长施加了更严格的约束。", "answer": "$$\\boxed{1.000}$$", "id": "3420323"}, {"introduction": "在理解了 SSP 限制的重要性之后，本练习提供了一个直观的实例，来展示 SSP 方法在实践中的优势。你将实现并对比一个 SSP 龙格-库塔方法和一个经典的高阶非 SSP 方法（RK4），亲眼观察 SSP 方法是如何成功地保持解的总变差不增（TVD），从而抑制了在间断附近产生的伪振荡。这个编码练习将使 SSP 的理论概念变得具体可见。[@problem_id:3420259]", "problem": "考虑周期性域上的标量线性平流方程，\n$$u_t + a\\,u_x = 0,$$\n该方程定义在区间 $$[0,1]$$ 上，具有周期性边界条件和常数平流速度 $$a0$$。将空间域离散为 $$N$$ 个宽度为 $$\\Delta x = \\frac{1}{N}$$ 的均匀单元，并考虑使用零次多项式（分段常数基）的间断 Galerkin (DG) 格式，以及迎风数值通量。使用以下基本要素，从 DG 弱形式推导出单元平均值的半离散常微分方程：\n- 使用分段常数基函数的 DG 方法的定义，\n- 在单元交界处构造与 $$a0$$ 的迎风格式一致的数值通量，\n- 在通量计算中应用的周期性边界条件。\n\n使用推导出的半离散算子，实现两种显式时间积分器：\n- 三阶三步的强稳定性保持 Runge-Kutta 方法 (SSPRK($3,3$))，其特性是当前向欧拉方法在时间步长限制下稳定时，该方法可以表示为前向欧拉步的凸组合，\n- 一种可比较的非强稳定性保持方法，即经典的四阶显式 Runge-Kutta 方法 (RK4)。\n\n将在时间 $$t^n$$ 的单元平均值的离散总变差定义为\n$$TV(u^n) = \\sum_{i=0}^{N-1} \\left|u_{i+1}^n - u_i^n\\right|,$$\n其中使用周期性索引，使得 $$u_N^n = u_0^n$$。\n\n您的任务是通过对半离散系统进行时间推进积分，数值验证 SSPRK($3,3$) 的总变差递减 (TVD) 行为，并展示 RK4 对该性质的违背。对于每个时间步，计算 $$TV(u^n)$$ 并检查序列 $$\\{TV(u^n)\\}_{n\\ge 0}$$ 是否为非增序列，即在小的数值容差范围内，$$TV(u^{n+1}) \\le TV(u^n)$$。\n\n使用以下测试套件，每个套件由 $$N$$、库朗数 $$\\nu = \\frac{a\\,\\Delta t}{\\Delta x}$$（其中 $$a=1$$）、时间步数 $$n_\\text{steps}$$ 以及初始数据指定：\n- 测试用例 1（在粗分辨率下的急剧间断的理想情况）：$$N=50$$，$$\\nu=0.99$$，$$n_\\text{steps}=12$$，初始数据\n  $$u(x,0) = \\begin{cases}\n  0  \\text{if } x \\in [0,0.45),\\\\\n  1  \\text{if } x \\in [0.45,0.55),\\\\\n  0  \\text{if } x \\in [0.55,1),\n  \\end{cases}$$\n  在周期性边界条件下按单元进行解释。\n- 测试用例 2（中等分辨率方波脉冲）：$$N=200$$，$$\\nu=0.90$$，$$n_\\text{steps}=20$$，初始数据\n  $$u(x,0) = \\begin{cases}\n  1  \\text{if } x \\in [0.30,0.70),\\\\\n  0  \\text{otherwise},\n  \\end{cases}$$\n  在周期性边界条件下按单元进行解释。\n- 测试用例 3（三能级分段常数）：$$N=100$$，$$\\nu=1.00$$，$$n_\\text{steps}=15$$，初始数据\n  $$u(x,0) = \\begin{cases}\n  -0.5  \\text{if } x \\in [0.00,0.20),\\\\\n  1.0  \\text{if } x \\in [0.20,0.50),\\\\\n  0.0  \\text{if } x \\in [0.50,1.00),\n  \\end{cases}$$\n  在周期性边界条件下按单元进行解释。\n\n对于每个测试用例，计算两个布尔值输出：\n- 一个布尔值，表示 SSPRK($3,3$) 方法在所有时间步中是否产生了非增的总变差序列，\n- 一个布尔值，表示 RK4 方法在所有时间步中是否产生了非增的总变差序列。\n\n最终的时间步长必须满足 $$\\Delta t = \\nu\\,\\Delta x/a$$。程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个测试结果是一个二元列表 $$[b_\\text{SSP}, b_\\text{RK4}]$$。对于上述三个测试用例，最终输出格式必须为\n$$[\\,[b_{1,\\text{SSP}},b_{1,\\text{RK4}}],\\,[b_{2,\\text{SSP}},b_{2,\\text{RK4}}],\\,[b_{3,\\text{SSP}},b_{3,\\text{RK4}}]\\,],$$\n其中布尔值以该语言的原生布尔文字打印。此问题不涉及任何物理单位或角度；所有量均为无量纲量。", "solution": "该问题旨在数值研究两种时间积分方案——SSPRK($3,3$) 和经典 RK4——在应用于线性平流方程的半离散化时，其总变差递减 (TVD) 的性质。空间离散化采用的是带有分段常数基函数 ($p=0$) 和迎风通量的间断 Galerkin (DG) 方法。\n\n**1. 使用间断 Galerkin 方法进行半离散化**\n\n控制偏微分方程 (PDE) 是线性平流方程：\n$$\nu_t + a\\,u_x = 0\n$$\n定义在域 $[0,1]$ 上，具有周期性边界条件和常数平流速度 $a0$。\n\n该域被划分为 $N$ 个单元 $I_i = [x_{i-1/2}, x_{i+1/2}]$（$i=0, \\dots, N-1$），每个单元的宽度为 $\\Delta x = 1/N$。单元交界位于 $x_{i+1/2} = (i+1)\\Delta x$。在每个单元 $I_i$ 内，解由分段常数函数（多项式阶数 $p=0$）近似：\n$$\nu_h(x,t) = u_i(t) \\quad \\text{for } x \\in I_i\n$$\n$u_i(t)$ 的值表示单元 $I_i$ 中解的单元平均值。\n\nDG 弱形式通过将 PDE 乘以一个测试函数 $v_h$，在单元 $I_i$ 上积分，并对空间项进行分部积分得到：\n$$\n\\int_{I_i} (u_h)_t v_h \\,dx - \\int_{I_i} a\\,u_h (v_h)_x \\,dx + [a\\,u_h v_h]_{x_{i-1/2}}^{x_{i+1/2}} = 0\n$$\n由于基函数和测试函数是分段常数，因此在单元内部 $(v_h)_x=0$。方程简化为：\n$$\n\\int_{I_i} \\frac{du_i}{dt} v_h \\,dx + \\left( a\\,u_h(x_{i+1/2}, t)v_h(x_{i+1/2}^-) - a\\,u_h(x_{i-1/2}, t)v_h(x_{i-1/2}^+) \\right) = 0\n$$\n在单元交界处的项 $a\\,u_h$ 是不连续的，必须用一个单值数值通量 $\\hat{f}(u_L, u_R)$ 代替，其中 $u_L$ 和 $u_R$ 分别是交界面左侧和右侧的状态。对于物理通量 $f(u) = au$，弱形式变为：\n$$\n\\int_{I_i} \\frac{du_i}{dt} v_h \\,dx + \\left( \\hat{f}(u_h(x_{i+1/2}^-), u_h(x_{i+1/2}^+)) v_h(x_{i+1/2}^-) - \\hat{f}(u_h(x_{i-1/2}^-), u_h(x_{i-1/2}^+)) v_h(x_{i-1/2}^+) \\right) = 0\n$$\n选择测试函数 $v_h$ 在单元 $I_i$ 中为 $1$，在其他地方为 $0$，我们得到 $v_h(x_{i+1/2}^-) = 1$ 和 $v_h(x_{i-1/2}^+) = 1$。时间导数的积分是 $\\Delta x \\frac{du_i}{dt}$。交界面上的状态为 $u_h(x_{i+1/2}^-) = u_i$、$u_h(x_{i+1/2}^+) = u_{i+1}$、$u_h(x_{i-1/2}^-) = u_{i-1}$ 和 $u_h(x_{i-1/2}^+) = u_i$。这导致：\n$$\n\\Delta x \\frac{du_i}{dt} + \\hat{f}(u_i, u_{i+1}) - \\hat{f}(u_{i-1}, u_i) = 0\n$$\n问题指定了当 $a  0$ 时的迎风通量，即 $\\hat{f}(u_L, u_R) = f(u_L) = a u_L$。将此应用于我们的交界面：\n- 在 $x_{i+1/2}$ 处：$\\hat{f}(u_i, u_{i+1}) = a u_i$。\n- 在 $x_{i-1/2}$ 处：$\\hat{f}(u_{i-1}, u_i) = a u_{i-1}$。\n\n将这些通量代入方程得到：\n$$\n\\Delta x \\frac{du_i}{dt} + a u_i - a u_{i-1} = 0\n$$\n整理后，我们得到单元平均值的半离散常微分方程 (ODE) 组：\n$$\n\\frac{du_i}{dt} = -\\frac{a}{\\Delta x} (u_i - u_{i-1})\n$$\n其中周期性索引使得 $u_{-1} \\equiv u_{N-1}$。这是著名的一阶迎风有限差分格式。我们可以将此系统写成向量形式 $\\frac{d\\mathbf{u}}{dt} = L(\\mathbf{u})$，其中 $\\mathbf{u} = [u_0, u_1, \\dots, u_{N-1}]^T$ 且 $(L(\\mathbf{u}))_i = -\\frac{a}{\\Delta x} (u_i - u_{i-1})$。\n\n**2. 时间积分方案**\n\n将前向欧拉方法应用于此系统，$u_i^{n+1} = u_i^n + \\Delta t L(u^n)_i$，得到：\n$$\nu_i^{n+1} = u_i^n - \\frac{a \\Delta t}{\\Delta x}(u_i^n - u_{i-1}^n) = (1-\\nu)u_i^n + \\nu u_{i-1}^n\n$$\n其中 $\\nu = \\frac{a \\Delta t}{\\Delta x}$ 是库朗数。如果 $0 \\le \\nu \\le 1$，该格式是 TVD 的。\n\n**a) 强稳定性保持 Runge-Kutta (SSPRK(3,3))**\n这种三阶三步方法旨在保持前向欧拉方法的稳定性属性，如 TVD。其公式为：\n$$\n\\mathbf{u}^{(1)} = \\mathbf{u}^n + \\Delta t L(\\mathbf{u}^n)\n$$\n$$\n\\mathbf{u}^{(2)} = \\frac{3}{4} \\mathbf{u}^n + \\frac{1}{4} \\left( \\mathbf{u}^{(1)} + \\Delta t L(\\mathbf{u}^{(1)}) \\right)\n$$\n$$\n\\mathbf{u}^{n+1} = \\frac{1}{3} \\mathbf{u}^n + \\frac{2}{3} \\left( \\mathbf{u}^{(2)} + \\Delta t L(\\mathbf{u}^{(2)}) \\right)\n$$\nSSPRK($3,3$) 可以看作是前向欧拉步的凸组合。如果前向欧拉方法是 TVD 的，并且时间步满足 $\\Delta t \\le c \\cdot \\Delta t_{\\text{FE,TVD}}$，其中 $c$ 是 SSP 系数，那么它就是 TVD 的。对于此方案，$c=1$。因此，对于我们的半离散化，只要 $\\nu \\le 1$，SSPRK($3,3$) 就有望是 TVD 的。所有测试用例都满足此条件。\n\n**b) 经典四阶 Runge-Kutta (RK4)**\n标准的 RK4 方法由以下公式给出：\n$$\n\\mathbf{k}_1 = L(\\mathbf{u}^n)\n$$\n$$\n\\mathbf{k}_2 = L(\\mathbf{u}^n + \\frac{\\Delta t}{2} \\mathbf{k}_1)\n$$\n$$\n\\mathbf{k}_3 = L(\\mathbf{u}^n + \\frac{\\Delta t}{2} \\mathbf{k}_2)\n$$\n$$\n\\mathbf{k}_4 = L(\\mathbf{u}^n + \\Delta t \\mathbf{k}_3)\n$$\n$$\n\\mathbf{u}^{n+1} = \\mathbf{u}^n + \\frac{\\Delta t}{6} (\\mathbf{k}_1 + 2\\mathbf{k}_2 + 2\\mathbf{k}_3 + \\mathbf{k}_4)\n$$\nRK4 不是 SSP 方法。对于非线性问题，甚至对于具有非光滑解的线性问题，它都不能保证是 TVD 的，因为它会在间断附近引入虚假振荡，从而增加总变差。\n\n**3. 总变差和数值验证**\n\n离散总变差定义为：\n$$\nTV(\\mathbf{u}^n) = \\sum_{i=0}^{N-1} |u_{i+1}^n - u_i^n|\n$$\n其中周期性索引意味着 $u_N^n = u_0^n$。如果对所有 $n$ 都有 $TV(\\mathbf{u}^{n+1}) \\le TV(\\mathbf{u}^n)$，则该格式是 TVD 的。对于数值验证，我们将在每个时间步为 SSPRK($3,3$) 和 RK4 检查此条件。由于浮点运算，检查实现为 $TV(\\mathbf{u}^{n+1}) \\le TV(\\mathbf{u}^n) + \\epsilon$，其中 $\\epsilon$ 是一个很小的容差（例如，$10^{-12}$）。每个方法的布尔标志将记录 TVD 属性在整个模拟过程中是否成立。\n\n实现过程将通过为每个测试用例定义初始条件，设置空间算子 $L(\\mathbf{u})$，然后使用每个时间积分方案对指定的步数进行迭代，并在每个步骤中检查总变差来进行。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem by running three test cases to verify the TVD property\n    of SSPRK(3,3) and the violation of this property by RK4 for a DG-discretized\n    advection equation.\n    \"\"\"\n\n    test_cases = [\n        {\n            \"N\": 50, \"nu\": 0.99, \"n_steps\": 12,\n            \"u0_func\": lambda x: np.where((x >= 0.45)  (x  0.55), 1.0, 0.0)\n        },\n        {\n            \"N\": 200, \"nu\": 0.90, \"n_steps\": 20,\n            \"u0_func\": lambda x: np.where((x >= 0.30)  (x  0.70), 1.0, 0.0)\n        },\n        {\n            \"N\": 100, \"nu\": 1.00, \"n_steps\": 15,\n            \"u0_func\": lambda x: np.select(\n                [x  0.20, (x >= 0.20)  (x  0.50), x >= 0.50],\n                [-0.5, 1.0, 0.0]\n            )\n        }\n    ]\n\n    results = []\n    for params in test_cases:\n        N = params[\"N\"]\n        nu = params[\"nu\"]\n        n_steps = params[\"n_steps\"]\n        u0_func = params[\"u0_func\"]\n        \n        b_ssp, b_rk4 = run_test_case(N, nu, n_steps, u0_func)\n        results.append([b_ssp, b_rk4])\n\n    # The final output should be a single line string representation of the list of lists.\n    # The `print` function on a list will produce the required format with native boolean literals.\n    print(results)\n\n\ndef get_spatial_operator(a, dx):\n    \"\"\"Returns the spatial operator L(u) for the semi-discretization.\"\"\"\n    def L(u):\n        # u_i - u_{i-1} with periodic boundaries\n        diff = u - np.roll(u, 1)\n        return -a / dx * diff\n    return L\n    \ndef total_variation(u):\n    \"\"\"Computes the total variation of a 1D array with periodic boundaries.\"\"\"\n    return np.sum(np.abs(u - np.roll(u, -1)))\n\ndef run_test_case(N, nu, n_steps, u0_func):\n    \"\"\"\n    Runs a single test case for both SSPRK(3,3) and RK4, checking the TVD property.\n\n    Returns:\n        A tuple of two booleans: (ssp_is_tvd, rk4_is_tvd)\n    \"\"\"\n    a = 1.0\n    dx = 1.0 / N\n    dt = nu * dx / a\n\n    # Define cell centers and initial condition\n    x = (np.arange(N) + 0.5) * dx\n    u0 = u0_func(x)\n\n    L = get_spatial_operator(a, dx)\n    \n    # Tolerance for floating point comparison of TV\n    tolerance = 1e-12\n\n    # --- SSPRK(3,3) Simulation ---\n    u_ssp = u0.copy()\n    ssp_is_tvd = True\n    tv_old = total_variation(u_ssp)\n    for _ in range(n_steps):\n        # SSPRK(3,3) steps\n        u1 = u_ssp + dt * L(u_ssp)\n        u2 = 0.75 * u_ssp + 0.25 * (u1 + dt * L(u1))\n        u_ssp = (1/3.0) * u_ssp + (2/3.0) * (u2 + dt * L(u2))\n        \n        tv_new = total_variation(u_ssp)\n        if tv_new > tv_old + tolerance:\n            ssp_is_tvd = False\n        tv_old = tv_new\n\n    # --- RK4 Simulation ---\n    u_rk4 = u0.copy()\n    rk4_is_tvd = True\n    tv_old = total_variation(u_rk4)\n    for _ in range(n_steps):\n        # RK4 steps\n        k1 = L(u_rk4)\n        k2 = L(u_rk4 + 0.5 * dt * k1)\n        k3 = L(u_rk4 + 0.5 * dt * k2)\n        k4 = L(u_rk4 + dt * k3)\n        u_rk4 = u_rk4 + (dt / 6.0) * (k1 + 2 * k2 + 2 * k3 + k4)\n        \n        tv_new = total_variation(u_rk4)\n        if tv_new > tv_old + tolerance:\n            rk4_is_tvd = False\n        tv_old = tv_new\n        \n    return ssp_is_tvd, rk4_is_tvd\n\nsolve()\n```", "id": "3420259"}, {"introduction": "SSP 方法的有效性，其核心保证依赖于一个重要前提：其底层的向前欧拉格式必须能保持所需的凸性质（如正定性或单调性）。本练习将探讨一个更复杂的情况：当引入一个非线性源项时，这个前提被破坏，导致标准 SSP 方法也随之失效。你将通过构建一个反例来诊断这一问题，并学习使用算子分裂（operator splitting）的思想，实现一种混合方法来恢复解的正定性，这是一种在处理复杂物理问题时非常实用的高级技巧。[@problem_id:3420247]", "problem": "考虑用于一维空间中标量线性平流-反应方程的零次多项式（分片常数）半离散间断 Galerkin (DG) 方法，\n$$\n\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = S(u),\n$$\n其中 $a \\in \\mathbb{R}$ 是一个恒定的平流速度，$S(u)$ 是逐点作用于单元平均值的非线性源项。在宽度为 $h$ 的单元组成的均匀网格上，当 $a \\ge 0$ 时，采用迎风数值通量的 DG 半离散化会得到关于单元平均未知量向量 $u(t) \\in \\mathbb{R}^N$ 的常微分方程 (ODE)，\n$$\n\\frac{d u_i}{d t} = L_i(u) + S(u_i), \\quad L_i(u) = -\\frac{a}{h}\\left(u_i - u_{i-1}\\right),\n$$\n对于 $i = 0, 1, \\dots, N-1$，并采用周期性索引 $u_{-1} := u_{N-1}$。应用于全算子 $F(u) := L(u) + S(u)$ 的前向 Euler 方法为\n$$\nu^{n+1} = u^n + \\Delta t \\, F(u^n).\n$$\n强稳定性保持 (SSP) 显式 Runge–Kutta 方法的定义性质是：其数值更新可以写成应用于 $F(u)$ 的前向 Euler 步的凸组合，这保证了在前向 Euler 方法满足某个时间步长限制下所能保持的任何凸稳定性性质，该 SSP 方法也能同样保持。特别地，如果存在一个系数 $c  0$，使得当对于所有 $0 \\le \\Delta t \\le \\Delta t_{\\mathrm{FE}}$，前向 Euler 方法都满足 $\\Phi\\left(u^n + \\Delta t \\, F(u^n)\\right) \\le \\Phi(u^n)$ 时，SSP 方法对于所有 $0 \\le \\Delta t \\le c \\, \\Delta t_{\\mathrm{FE}}$ 也满足 $\\Phi(u^{n+1}) \\le \\Phi(u^n)$，则称该方法关于凸泛函 $\\Phi(u)$ 是 SSP 的。\n\n本问题要求您在上述 DG 背景下构造一个反例，以表明当非线性源项破坏了前向 Euler 方法相对于正锥\n$$\n\\mathcal{C}_+ := \\left\\{ u \\in \\mathbb{R}^N \\,:\\, u_i \\ge 0 \\text{ for all } i \\right\\}\n$$\n的单调性时，SSP 方法会失效。具体来说，取非线性源\n$$\nS(u) = -k \\sqrt{u}, \\quad k  0,\n$$\n其以分量形式作用于 $u$，并约定 $S(0) = 0$。在仅含源项的 ODE $\\dot{u} = S(u)$ 下的精确演化会保持非负不变集 $\\mathcal{C}_+$，即如果 $u(0) \\in \\mathcal{C}_+$, 则对于所有 $t \\ge 0$ 都有 $u(t) \\in \\mathcal{C}_+$。然而，当 $u$ 足够小时，应用于 $S(u)$ 的前向 Euler 方法即使对于任意小的时间步长 $\\Delta t  0$ 也可能破坏非负性。\n\n您必须：\n- 实现 DG 前向 Euler 通量更新\n$$\n\\mathrm{FE\\_flux}(u) := u + \\Delta t \\, L(u),\n$$\n其中 $L(u)$ 如上文为周期性边界条件所定义。\n- 实现用于全算子 $F(u) = L(u) + S(u)$ 的前向 Euler 更新。\n- 实现应用于全算子 $F(u)$ 的强稳定性保持三阶 Runge–Kutta 方法 (Shu–Osher 形式)：\n  1. $u^{(1)} = u^n + \\Delta t \\, F(u^n)$,\n  2. $u^{(2)} = \\frac{3}{4} u^n + \\frac{1}{4}\\left(u^{(1)} + \\Delta t \\, F(u^{(1)})\\right)$,\n  3. $u^{n+1} = \\frac{1}{3} u^n + \\frac{2}{3}\\left(u^{(2)} + \\Delta t \\, F(u^{(2)})\\right)$。\n- 推导并实现 ODE $\\dot{u} = -k \\sqrt{u}$ 在一个时间步长 $\\Delta t$ 内以分量形式作用时的精确源演化：\n  从可分离方程 $2 \\frac{d}{dt} \\sqrt{u} = -k$ 开始，可得到精确更新\n  $$\n  \\sqrt{u^{n+1}} = \\max\\left( \\sqrt{u^n} - \\frac{k \\Delta t}{2}, \\, 0 \\right), \\quad\\text{thus}\\quad\n  u^{n+1} = \\left( \\max\\left( \\sqrt{u^n} - \\tfrac{k \\Delta t}{2}, \\, 0 \\right) \\right)^2.\n  $$\n- 通过将精确源演化与前向 Euler 通量更新进行凸混合，构建一个保正性校正步，\n$$\nu^{n+1}_{\\mathrm{blend}} = \\theta \\, \\mathrm{ExactSource}(u^n) + (1 - \\theta) \\, \\mathrm{FE\\_flux}(u^n), \\quad \\theta \\in [0,1],\n$$\n并论证当 $\\mathrm{FE\\_flux}$ 保持非负性（例如，在 $a \\Delta t / h \\le 1$ 等 Courant–Friedrichs–Lewy 条件下）且 ExactSource 保持非负性时，为何该方法能保持 $\\mathcal{C}_+$。\n\n您的程序应生成一个反例，以证明前向 Euler 方法和 SSP Runge–Kutta 方法在全算子 $F$ 上会破坏非负性，然后展示凸混合校正能保持非负性。请使用以下测试套件。对于每个测试用例，您将获得：\n- $N$: DG 单元数，\n- $a$: 平流速度，\n- $h$: 单元宽度，\n- $\\Delta t$: 时间步长，\n- $k$: 源强度，\n- $\\theta$: 混合参数，\n- $u^0$: 初始单元平均值向量。\n\n测试套件：\n1. $N=1$, $a=0.0$, $h=1.0$, $\\Delta t=0.1$, $k=10.0$, $\\theta=0.5$, $u^0 = [10^{-8}]$。\n2. $N=3$, $a=1.0$, $h=1.0$, $\\Delta t=0.2$, $k=10.0$, $\\theta=0.5$, $u^0 = [1.0, 10^{-6}, 0.5]$。\n3. $N=3$, $a=1.0$, $h=1.0$, $\\Delta t=0.5$, $k=10.0$, $\\theta=0.5$, $u^0 = [0.0, 0.0, 0.0]$。\n4. $N=3$, $a=1.0$, $h=1.0$, $\\Delta t=10^{-4}$, $k=10.0$, $\\theta=0.5$, $u^0 = [1.0, 10^{-2}, 0.5]$。\n\n对于每个测试用例，计算三个布尔值，分别指示以下方法的 $u^{n+1}$ 的最小值是否为非负：\n- 应用于 $F(u)$ 的前向 Euler 更新，\n- 应用于 $F(u)$ 的三阶 SSP Runge–Kutta 更新，\n- 混合校正 $u^{n+1}_{\\mathrm{blend}}$。\n\n最终输出格式必须是单行，包含一个列表的列表，每个内部列表对应一个测试用例，且每个内部列表按上述顺序精确包含三个布尔值。例如，\n$$\n\\left[ [\\mathrm{True}, \\mathrm{False}, \\mathrm{True}], [\\dots], \\dots \\right].\n$$\n本问题不需要物理单位。不涉及角度。不涉及百分比。您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，并使用 Python 布尔字面量。", "solution": "该问题要求构造一个数值反例，以证明强稳定性保持 (SSP) 时间积分方法在一个系统中的失效。在该系统中，其基础的前向 Euler (FE) 方法不保持期望的凸性属性，具体来说就是解的非负性。其背景是用于标量平流-反应方程的半离散间断 Galerkin (DG) 方法。\n\n控制偏微分方程为一维平流-反应方程：\n$$\n\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = S(u)\n$$\n其中 $a \\in \\mathbb{R}$ 是一个恒定的平流速度，$S(u)$ 是一个非线性源项。\n\n在使用零阶（分片常数基函数）DG 方法，在单元宽度为 $h$ 的均匀网格上，并对 $a \\ge 0$ 使用迎风通量进行离散化后，关于单元平均值 $u_i(t)$ 的常微分方程 (ODE) 组由下式给出：\n$$\n\\frac{d u_i}{d t} = L_i(u) + S(u_i), \\quad \\text{for } i = 0, 1, \\dots, N-1\n$$\n这可以写成向量形式 $\\frac{d u}{d t} = F(u)$，其中 $F(u) = L(u) + S(u)$。空间算子 $L(u)$ 和源算子 $S(u)$ 以分量形式定义如下：\n$$\nL_i(u) = -\\frac{a}{h}\\left(u_i - u_{i-1}\\right) \\quad (\\text{with periodic indexing } u_{-1} := u_{N-1})\n$$\n$$\nS(u_i) = -k \\sqrt{u_i}, \\quad k  0 \\quad (\\text{with the convention } S(0) = 0)\n$$\n目标是分析非负性的保持情况，即 $u^n \\in \\mathcal{C}_+$ 是否意味着 $u^{n+1} \\in \\mathcal{C}_+$，其中 $\\mathcal{C}_+ = \\{ u \\in \\mathbb{R}^N : u_i \\ge 0 \\text{ for all } i \\}$。\n\n我们将分析三种时间步进方法：\n1.  **前向 Euler (FE) 方法**：\n    应用于全算子 $F(u)$ 的 FE 方法是：\n    $$\n    u^{n+1} = u^n + \\Delta t \\, F(u^n) = u^n + \\Delta t \\, (L(u^n) + S(u^n))\n    $$\n    对于分量 $u_i$，其形式为 $u_i^{n+1} = u_i^n + \\Delta t \\left(-\\frac{a}{h}(u_i^n - u_{i-1}^n) - k\\sqrt{u_i^n}\\right)$。非负性不被保证。源项本身就可能导致正性的丧失。仅含源项的更新 $u_i^{n+1} = u_i^n - \\Delta t k \\sqrt{u_i^n}$ 保持非负的条件是 $u_i^{n+1} = u_i^n - \\Delta t k \\sqrt{u_i^n} \\ge 0$，这要求 $\\Delta t \\le \\frac{\\sqrt{u_i^n}}{k}$。这个时间步长限制依赖于状态 $u_i^n$，并且当 $u_i^n \\to 0$ 时趋近于 $0$。因此，对于任意固定的 $\\Delta t  0$，总可以找到一个足够小的 $u_i^n  0$ 来违反此条件。\n\n2.  **三阶 SSP Runge-Kutta (SSP-RK3)**：\n    该方法由以下三个阶段给出：\n    $$\n    \\begin{aligned}\n    u^{(1)} = u^n + \\Delta t \\, F(u^n) \\\\\n    u^{(2)} = \\frac{3}{4} u^n + \\frac{1}{4}\\left(u^{(1)} + \\Delta t \\, F(u^{(1)})\\right) \\\\\n    u^{n+1} = \\frac{1}{3} u^n + \\frac{2}{3}\\left(u^{(2)} + \\Delta t \\, F(u^{(2)})\\right)\n    \\end{aligned}\n    $$\n    SSP 属性保证，如果 FE 步 $v \\mapsto v + \\delta t F(v)$ 对于所有时间步长 $0 \\le \\delta t \\le \\Delta t_{\\mathrm{FE}}$ 都保持一个凸集，那么 SSP-RK3 方法将在时间步长 $0 \\le \\Delta t \\le c \\Delta t_{\\mathrm{FE}}$（其中 SSP 系数 $c  0$）下保持该集合。然而，如上所述，不存在一个统一的时间步长限制 $\\Delta t_{\\mathrm{FE}}  0$ 能使得 FE 对所有 $u \\in \\mathcal{C}_+$ 都保持正性。SSP 保证的前提条件未被满足，因此 SSP-RK3 方法不保证能保持正性。我们预期它将在 FE 方法失效的情况下失效。\n\n3.  **混合保正性方法**：\n    该方法使用一种类似算子分裂的方法，将一个保持非负性的平流更新与一个保持非负性的精确源更新进行混合。其公式为：\n    $$\n    u^{n+1}_{\\mathrm{blend}} = \\theta \\, \\mathrm{ExactSource}(u^n) + (1 - \\theta) \\, \\mathrm{FE\\_flux}(u^n), \\quad \\theta \\in [0,1]\n    $$\n    这两个分量是：\n    - **前向 Euler 通量更新**：$\\mathrm{FE\\_flux}(u^n) := u^n + \\Delta t \\, L(u^n)$。分量形式为 $u_i^{n+1} = u_i^n - \\frac{a \\Delta t}{h}(u_i^n - u_{i-1}^n) = (1 - \\frac{a \\Delta t}{h})u_i^n + (\\frac{a \\Delta t}{h})u_{i-1}^n$。如果 Courant-Friedrichs-Lewy (CFL) 条件 $a \\Delta t / h \\le 1$ 成立且 $u^n \\in \\mathcal{C}_+$，那么系数 $(1-a\\Delta t/h)$ 和 $a\\Delta t/h$ 均为非负。该更新是非负值的凸组合，因此 $\\mathrm{FE\\_flux}(u^n) \\in \\mathcal{C}_+$。\n    - **精确源更新**：从 ODE $\\frac{d\\sqrt{u}}{dt} = -\\frac{k}{2}$ 开始，在 $[t^n, t^{n+1}]$ 上积分得到 $\\sqrt{u(t^{n+1})} = \\sqrt{u(t^n)} - k\\Delta t/2$。由于解不能变为负数，精确更新为 $u^{n+1} = \\left( \\max\\left( \\sqrt{u^n} - \\frac{k \\Delta t}{2}, \\, 0 \\right) \\right)^2$。此更新根据其构造，将非负值映至非负值，因此 $\\mathrm{ExactSource}(u^n) \\in \\mathcal{C}_+$。\n\n    混合更新是两个向量 $\\mathrm{ExactSource}(u^n)$ 和 $\\mathrm{FE\\_flux}(u^n)$ 的凸组合（因为 $\\theta \\in [0,1]$），而这两个向量都位于凸锥 $\\mathcal{C}_+$ 内。因此，只要通量部分满足 CFL 条件，$u^{n+1}_{\\mathrm{blend}}$ 就保证位于 $\\mathcal{C}_+$ 内。所提供的测试用例满足此条件。实现将展示这种鲁棒性。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main solver function to run test cases and generate the final output.\n    \"\"\"\n\n    test_cases = [\n        # (N, a, h, dt, k, theta, u0)\n        (1, 0.0, 1.0, 0.1, 10.0, 0.5, np.array([1e-8])),\n        (3, 1.0, 1.0, 0.2, 10.0, 0.5, np.array([1.0, 1e-6, 0.5])),\n        (3, 1.0, 1.0, 0.5, 10.0, 0.5, np.array([0.0, 0.0, 0.0])),\n        (3, 1.0, 1.0, 1e-4, 10.0, 0.5, np.array([1.0, 1e-2, 0.5])),\n    ]\n\n    # --- Operator Definitions ---\n\n    def L_op(u, a, h):\n        \"\"\"Computes the spatial operator L(u) with periodic BCs.\"\"\"\n        if a == 0.0:\n            return np.zeros_like(u)\n        u_prev = np.roll(u, 1)\n        return -(a / h) * (u - u_prev)\n\n    def S_op(u, k):\n        \"\"\"\n        Computes the nonlinear source term S(u).\n        Uses np.maximum(0, u) to avoid NaN for negative inputs that may\n        arise in intermediate stages of RK methods.\n        \"\"\"\n        return -k * np.sqrt(np.maximum(0, u))\n\n    def F_op(u, a, h, k):\n        \"\"\"Computes the full RHS operator F(u) = L(u) + S(u).\"\"\"\n        return L_op(u, a, h) + S_op(u, k)\n\n    # --- Time Stepping Methods ---\n\n    def fe_step(u0, dt, a, h, k):\n        \"\"\"Performs one Forward Euler step on the full operator F(u).\"\"\"\n        return u0 + dt * F_op(u0, a, h, k)\n\n    def ssprk3_step(u0, dt, a, h, k):\n        \"\"\"Performs one SSP-RK3 step on the full operator F(u).\"\"\"\n        # Stage 1\n        u1 = u0 + dt * F_op(u0, a, h, k)\n        # Stage 2\n        u2 = 0.75 * u0 + 0.25 * (u1 + dt * F_op(u1, a, h, k))\n        # Stage 3 (Final)\n        u_final = (1.0 / 3.0) * u0 + (2.0 / 3.0) * (u2 + dt * F_op(u2, a, h, k))\n        return u_final\n\n    def blended_method(u0, dt, a, h, k, theta):\n        \"\"\"Performs one step of the blended positivity-preserving method.\"\"\"\n        # FE flux-only update\n        fe_flux_update = u0 + dt * L_op(u0, a, h)\n\n        # Exact source update\n        # Use np.maximum on the input u0 to be safe, although it should be non-negative.\n        sqrt_u0 = np.sqrt(np.maximum(0, u0))\n        exact_source_update = np.square(np.maximum(sqrt_u0 - 0.5 * k * dt, 0))\n\n        # Convex blending\n        return theta * exact_source_update + (1.0 - theta) * fe_flux_update\n\n    # --- Main Loop ---\n    \n    results = []\n    for N, a, h, dt, k, theta, u0 in test_cases:\n        \n        # 1. Forward Euler update\n        u_fe = fe_step(u0, dt, a, h, k)\n        fe_is_positive = np.all(u_fe >= 0)\n\n        # 2. SSP-RK3 update\n        u_ssprk3 = ssprk3_step(u0, dt, a, h, k)\n        ssprk3_is_positive = np.all(u_ssprk3 >= 0)\n\n        # 3. Blended correction update\n        u_blend = blended_method(u0, dt, a, h, k, theta)\n        blend_is_positive = np.all(u_blend >= 0)\n\n        results.append([fe_is_positive, ssprk3_is_positive, blend_is_positive])\n    \n    # The final output should be a single line string representation of the list of lists.\n    # The `print` function on a list will produce the required format with native boolean literals.\n    print(results)\n\nsolve()\n```", "id": "3420247"}]}