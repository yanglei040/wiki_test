{"hands_on_practices": [{"introduction": "我们的第一个练习将聚焦于处理刚性问题的对角隐式龙格-库塔（DIRK）方法的核心设计原则。我们将从一个通用的两级单对角隐式龙格-库塔（SDIRK）格式出发，通过施加二阶精度和L-稳定性条件，来推导一种广泛使用的方法的具体系数。这个练习将展示理论要求如何转化为具体的、实用的算法 [@problem_id:3378920]。", "problem": "有界域上线性扩散算子的半离散间断伽辽金 (DG) 空间离散化产生一个形如 $\\frac{\\mathrm{d} \\boldsymbol{u}}{\\mathrm{d} t} = \\boldsymbol{L}\\,\\boldsymbol{u}$ 的常微分方程，其中由于扩散通量引起的刚性，矩阵 $\\boldsymbol{L}$ 的特征值具有大的负实部。考虑使用具有公共对角系数 $\\gamma$ 和刚性精度（stiff accuracy）的两阶段单对角隐式龙格-库塔 (SDIRK) 方法对此系统进行时间推进。刚性精度意味着最后一个阶段等于步长解，并且权重等于龙格-库塔矩阵的最后一行。\n\n设 Butcher 矩阵为 $\\boldsymbol{A} = \\begin{pmatrix}\\gamma  0 \\\\ a_{21}  \\gamma\\end{pmatrix}$，权重为 $\\boldsymbol{b} = \\begin{pmatrix}b_{1} \\\\ b_{2}\\end{pmatrix}$，满足刚性精度 $\\boldsymbol{b}^{\\top} = \\begin{pmatrix}a_{21}  \\gamma\\end{pmatrix}$，横坐标（abscissae）为 $\\boldsymbol{c} = \\begin{pmatrix}c_{1} \\\\ c_{2}\\end{pmatrix}$，由 $c_{i} = \\sum_{j} a_{ij}$ 给出。假设该方法恰好是二阶精度的。\n\n从标量线性测试方程 $\\frac{\\mathrm{d} u}{\\mathrm{d} t} = \\lambda u$ 出发，通过应用具有剛性精度的两阶段 SDIRK 更新来定义稳定性函数 $R(z)$，其中 $z = h \\lambda$。对刚性系统施加 $L$-稳定性的要求，此处将其定义为 $A$-稳定性（区域 $\\{z \\in \\mathbb{C} : \\operatorname{Re}(z) \\le 0\\}$ 包含在稳定性区域 $\\{z : |R(z)| \\le 1\\}$ 内）和 $\\lim_{|z|\\to\\infty} R(z) = 0$ 的组合。此外，要求横坐标表示步长内的时间阶段，即 $0 \\le c_{i} \\le 1$。\n\n确定在上述约束条件下，满足刚性精度、二阶精度和 $L$-稳定性的唯一 $\\gamma$ 值。将您的最终答案表示为 $\\gamma$ 的封闭形式解析表达式。", "solution": "用户希望找到单对角隐式龙格-库塔 (SDIRK) 方法的一个特定参数。\n\n### 步骤 1：问题验证\n\n**1.1. 提取已知条件**\n-   控制常微分方程 (ODE) 的形式为 $\\frac{\\mathrm{d} \\boldsymbol{u}}{\\mathrm{d} t} = \\boldsymbol{L}\\,\\boldsymbol{u}$。\n-   时间积分方法是两阶段 SDIRK 方法。\n-   Butcher 矩阵 $\\boldsymbol{A}$ 的结构为 $\\boldsymbol{A} = \\begin{pmatrix}\\gamma  0 \\\\ a_{21}  \\gamma\\end{pmatrix}$。\n-   该方法具有刚性精度，其定义为权重 $\\boldsymbol{b}$ 等于龙格-库塔矩阵的最后一行。对于两阶段方法 ($s=2$)，这意味着 $\\boldsymbol{b}^{\\top} = \\begin{pmatrix}a_{21}  a_{22}\\end{pmatrix}$。鉴于 $\\boldsymbol{A}$ 的结构，这意味着 $b_1 = a_{21}$ 且 $b_2 = \\gamma$。\n-   横坐标 $\\boldsymbol{c}$ 由行和条件 $c_i = \\sum_{j} a_{ij}$ 给出。\n-   该方法被要求是精确二阶的。\n-   稳定性分析是在标量线性测试方程 $\\frac{\\mathrm{d} u}{\\mathrm{d} t} = \\lambda u$ 上进行的，其中 $z = h \\lambda$。\n-   稳定性要求是 $L$-稳定性，其定义为以下两者的组合：\n    1.  $A$-稳定性：稳定性区域 $\\{z : |R(z)| \\le 1\\}$ 包含复平面的左半部分 $\\{z \\in \\mathbb{C} : \\operatorname{Re}(z) \\le 0\\}$。\n    2.  渐近行为：$\\lim_{|z|\\to\\infty} R(z) = 0$。\n-   横坐标被约束在时间步长区间内：$0 \\le c_{i} \\le 1$。\n\n**1.2. 使用提取的已知条件进行验证**\n该问题设定在刚性常微分方程数值分析的标准框架内。所有使用的术语（SDIRK、Butcher 表、刚性精度、阶条件、L-稳定性）在该领域都有明確定義且是标准术语。问题要求基于一组数学约束求解唯一的参数值。初步检查表明，这些约束很可能是一致的，并足以确定唯一解。该问题具有科学依据、适定、客观且可形式化。没有明显违反验证标准的情况。\n\n**1.3. 结论与行动**\n问题被判定为有效。将提供一个完整的、有理有据的解答。\n\n### 步骤 2：求解推导\n\n目标是通过施加给定约束来确定对角系数 $\\gamma$ 的唯一值。\n\n**2.1. 来自方法属性的代数约束**\n首先，我们将龙格-库塔方法的属性转化为关于其系数的代数方程组。\n\n-   **刚性精度**：权重 $\\boldsymbol{b}$ 由 $\\boldsymbol{A}$ 的第二行给出：\n    $b_1 = a_{21}$\n    $b_2 = \\gamma$\n-   **横坐标**：横坐标 $c_i$ 是 $\\boldsymbol{A}$ 的行和：\n    $c_1 = a_{11} + a_{12} = \\gamma + 0 = \\gamma$\n    $c_2 = a_{21} + a_{22} = a_{21} + \\gamma$\n\n**2.2. 精度阶条件**\n为了使龙格-库塔方法达到某一阶精度，其系数必须满足一组称为阶条件的方程。\n\n-   **一阶条件**：$\\sum_{i=1}^{2} b_i = 1$。\n    代入 $b_1$ 和 $b_2$ 的表达式：\n    $a_{21} + \\gamma = 1$\n    这使我们能够用 $\\gamma$ 来表示 $a_{21}$：\n    $a_{21} = 1 - \\gamma$\n    利用这个结果，我们可以求得 $c_2$ 的一个固定值：\n    $c_2 = a_{21} + \\gamma = (1 - \\gamma) + \\gamma = 1$\n\n-   **二阶条件**：$\\sum_{i=1}^{2} b_i c_i = \\frac{1}{2}$。\n    代入 $b_i$ 和 $c_i$ 的表达式：\n    $b_1 c_1 + b_2 c_2 = \\frac{1}{2}$\n    $(a_{21})(\\gamma) + (\\gamma)(1) = \\frac{1}{2}$\n    现在，代入 $a_{21} = 1 - \\gamma$：\n    $(1 - \\gamma)\\gamma + \\gamma = \\frac{1}{2}$\n    $\\gamma - \\gamma^2 + \\gamma = \\frac{1}{2}$\n    $2\\gamma - \\gamma^2 = \\frac{1}{2}$\n    整理后得到一个关于 $\\gamma$ 的二次方程：\n    $\\gamma^2 - 2\\gamma + \\frac{1}{2} = 0$\n    乘以 $2$ 得到 $2\\gamma^2 - 4\\gamma + 1 = 0$。\n\n**2.3. 求解 $\\gamma$ 并应用约束**\n我们使用二次公式求解关于 $\\gamma$ 的二次方程：\n$\\gamma = \\frac{-(-4) \\pm \\sqrt{(-4)^2 - 4(2)(1)}}{2(2)} = \\frac{4 \\pm \\sqrt{16-8}}{4} = \\frac{4 \\pm 2\\sqrt{2}}{4}$\n这产生了 $\\gamma$ 的两个可能解：\n$\\gamma_1 = 1 - \\frac{\\sqrt{2}}{2}$\n$\\gamma_2 = 1 + \\frac{\\sqrt{2}}{2}$\n\n接下来，我们应用横坐标的约束条件：$0 \\le c_i \\le 1$。\n我们有 $c_1 = \\gamma$ 和 $c_2 = 1$。\n约束 $0 \\le c_2 \\le 1$ 是满足的，因为 $c_2=1$。\n约束 $0 \\le c_1 \\le 1$ 要求 $0 \\le \\gamma \\le 1$。\n我们检查 $\\gamma$ 的两个解中哪一个满足此条件：\n-   对于 $\\gamma_1 = 1 - \\frac{\\sqrt{2}}{2} \\approx 1 - 0.7071 = 0.2929$。该值位于区间 $[0, 1]$ 内。\n-   对于 $\\gamma_2 = 1 + \\frac{\\sqrt{2}}{2} \\approx 1 + 0.7071 = 1.7071$。该值不位于区间 $[0, 1]$ 内。\n\n因此，唯一满足二阶精度、刚性精度和横坐标约束的 $\\gamma$ 值是 $\\gamma = 1 - \\frac{\\sqrt{2}}{2}$。\n\n**2.4. L-稳定性的验证**\n最后，我们必须验证这个唯一的 $\\gamma$ 值也能产生一个 $L$-稳定的方法。\n$s$ 阶 SDIRK 方法的稳定性函数 $R(z)$ 由 $R(z) = 1 + z \\boldsymbol{b}^\\top (\\boldsymbol{I} - z\\boldsymbol{A})^{-1} \\boldsymbol{1}$ 给出。对于具有刚性精度的二阶 SDIRK 方法，可以证明其稳定性函数简化为：\n$R(z) = \\frac{1 + z(1-2\\gamma)}{(1-\\gamma z)^2}$\n这里，二阶精度要求的条件 $2\\gamma - \\gamma^2 = \\frac{1}{2}$ 已被用来建立与 $e^z$ 的泰勒级数在 $z^2$ 项之前都匹配的 $R(z)$ 的一般形式。\n\n我们为 $\\gamma=1-\\frac{\\sqrt{2}}{2}$ 检验 $L$-稳定性的两个条件：\n\n1.  **渐近行为**：我们需要 $\\lim_{|z|\\to\\infty} R(z) = 0$。\n    $R(z)$ 是一个关于 $z$ 的有理函数。分子的次数是 1，分母的次数是 2。只要分母多项式的首项系数 $\\gamma^2$ 非零，当 $|z|\\to\\infty$ 时极限将为 0。\n    我们的值是 $\\gamma = 1 - \\frac{\\sqrt{2}}{2} \\ne 0$，所以此条件满足。\n\n2.  **A-稳定性**：我们需要对于所有 $\\operatorname{Re}(z) \\le 0$ 的 $z$，都有 $|R(z)| \\le 1$。根据最大模原理，只需在边界上检验即可，即对于 $z=iy$，$y \\in \\mathbb{R}$。\n    $|R(iy)|^2 = \\frac{|1 + iy(1-2\\gamma)|^2}{|(1 - iy\\gamma)^2|^2} = \\frac{1^2 + (y(1-2\\gamma))^2}{((1 - iy\\gamma)(1+iy\\gamma))^2} = \\frac{1 + y^2(1-2\\gamma)^2}{(1+y^2\\gamma^2)^2}$\n    条件 $|R(iy)|^2 \\le 1$ 变为：\n    $1 + y^2(1-4\\gamma+4\\gamma^2) \\le 1 + 2y^2\\gamma^2 + y^4\\gamma^4$\n    $y^2(1-4\\gamma+4\\gamma^2) \\le 2y^2\\gamma^2 + y^4\\gamma^4$\n    对于 $y \\ne 0$，我们可以除以 $y^2$：\n    $1-4\\gamma+4\\gamma^2 \\le 2\\gamma^2 + y^2\\gamma^4$\n    $2\\gamma^2 - 4\\gamma + 1 \\le y^2\\gamma^4$\n    这个不等式必须对所有 $y \\in \\mathbb{R}$ 成立。由于右侧可以任意接近于 0（对于小的 $y$），左侧必须小于或等于 0。\n    $2\\gamma^2 - 4\\gamma + 1 \\le 0$\n    二次方程 $2\\gamma^2 - 4\\gamma + 1 = 0$ 的根恰好是 $1 \\pm \\frac{\\sqrt{2}}{2}$。由于抛物线 $p(\\gamma)=2\\gamma^2 - 4\\gamma + 1$ 开口向上，不等式 $p(\\gamma) \\le 0$ 在 $\\gamma$ 位于其根之间时成立，即 $\\gamma \\in [1 - \\frac{\\sqrt{2}}{2}, 1 + \\frac{\\sqrt{2}}{2}]$。\n    我们选择的值 $\\gamma = 1 - \\frac{\\sqrt{2}}{2}$ 位于该区间的边界上。对于这个值，$2\\gamma^2 - 4\\gamma + 1 = 0$，所以不等式变为 $0 \\le y^2\\gamma^4$，由于 $y^2 \\ge 0$ 且 $\\gamma \\ne 0$，这总是成立的。因此，该方法是 A-稳定的。\n\n由于两个条件都满足，该方法对于 $\\gamma = 1 - \\frac{\\sqrt{2}}{2}$ 确实是 $L$-稳定的。\n\n问题陈述中指定的所有条件都被这个唯一的 $\\gamma$ 值所满足。", "answer": "$$\\boxed{1 - \\frac{\\sqrt{2}}{2}}$$", "id": "3378920"}, {"introduction": "虽然L-稳定性至关重要，但它并不能完全描述一个方法在长时间积分下的行为。本练习将引入一个更严格的概念——代数稳定性，并演示违反该性质如何导致收缩性的丧失，即使对于精确解是衰减的问题也是如此。通过分析一个特意构造的不良DIRK格式，你将对数值稳定性的微妙之处有更深刻的理解 [@problem_id:3378945]。", "problem": "考虑一个由线性对流扩散算子的间断Galerkin (DG) 空间离散得到的半离散常微分方程，在标准迎风数值通量和适当的谱滤波下，该方程的矩阵生成元的谱位于闭合的左半平面。对于标量测试方程，这简化为线性模型问题 $u'(t)=\\lambda u(t)$，其中 $\\operatorname{Re}(\\lambda)\\le 0$。时间积分使用对角隐式龙格-库塔 (DIRK) 方法进行，其 Butcher 阵为\n$$\n\\begin{array}{c|cc}\na    a  0 \\\\\na+c  c  a \\\\\n\\hline\n     b_1  b_2\n\\end{array}\n$$\n其中 $A=\\begin{pmatrix} a  0 \\\\ c  a \\end{pmatrix}$ 是一个具有相同对角线元素的下三角矩阵，且 $b=\\begin{pmatrix} b_1 \\\\ b_2 \\end{pmatrix}$。设具体选择为 $a=\\frac{1}{2}$，$c=3$，$b_1=0$ 和 $b_2=1$，因此级横坐标为 $c_1=a$ 和 $c_2=a+c$。\n\n从龙格-库塔方法和代数稳定性的核心定义出发，完成以下任务：\n- 通过对称矩阵条件 $M = B A + A^{\\top} B - b b^{\\top}$（其中 $B=\\operatorname{diag}(b_1,b_2)$）解释代数稳定性的概念，并证明给定的 DIRK 阵违反了代数稳定性。\n- 对于线性测试方程 $u'=\\lambda u$，通过放大关系式 $u^{n+1}=R(z)\\,u^n$（其中 $z=h\\lambda$）定义龙格-库塔稳定性函数 $R(z)$，并根据给定的 DIRK 阵推导出 $R(z)$ 关于 $z$ 的符号表达式。\n- 通过在 $z=-2$ 处计算放大因子并确定 $|R(-2)|$，使用 $R(z)$ 预测沿负实轴的收缩性丧失。\n\n提供 $|R(-2)|$ 的值，作为一个无需四舍五入的精确数值。不需要物理单位。", "solution": "我们首先回顾与收缩性和代数稳定性相关的龙格-库塔 (RK) 方法的基本性质。一个系数矩阵为 $A \\in \\mathbb{R}^{s \\times s}$、权重为 $b \\in \\mathbb{R}^s$ 的 RK 方法是代数稳定的，如果对所有 $i$ 都有 $b_i\\ge 0$，并且对称矩阵\n$$\nM \\equiv B A + A^{\\top} B - b b^{\\top}, \\quad B=\\operatorname{diag}(b_1,\\dots,b_s),\n$$\n是半正定的。对于一个 2 级 DIRK，其\n$$\nA=\\begin{pmatrix} a  0 \\\\ c  a \\end{pmatrix}, \\quad b=\\begin{pmatrix} b_1 \\\\ b_2 \\end{pmatrix},\n$$\n我们对给定的数值 $a=\\frac{1}{2}$，$c=3$，$b_1=0$，$b_2=1$ 显式计算 $M$。\n\n通过用 $B=\\operatorname{diag}(0,1)$ 左乘 $A$ 来计算 $B A$，这将缩放 $A$ 的行：\n$$\nB A = \\begin{pmatrix} 0  0 \\\\ 3  \\frac{1}{2} \\end{pmatrix}.\n$$\n通过用 $B$ 右乘 $A^{\\top}$ 来计算 $A^{\\top} B$，这将缩放 $A^{\\top}$ 的列。由于\n$$\nA^{\\top}=\\begin{pmatrix} \\frac{1}{2}  3 \\\\ 0  \\frac{1}{2} \\end{pmatrix},\n$$\n我们有\n$$\nA^{\\top} B = \\begin{pmatrix} \\frac{1}{2}\\cdot 0  3\\cdot 1 \\\\ 0\\cdot 0  \\frac{1}{2}\\cdot 1 \\end{pmatrix}\n= \\begin{pmatrix} 0  3 \\\\ 0  \\frac{1}{2} \\end{pmatrix}.\n$$\n最后，\n$$\nb b^{\\top} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\\begin{pmatrix} 0  1 \\end{pmatrix}\n= \\begin{pmatrix} 0  0 \\\\ 0  1 \\end{pmatrix}.\n$$\n因此，\n$$\nM = B A + A^{\\top} B - b b^{\\top}\n= \\begin{pmatrix} 0  0 \\\\ 3  \\frac{1}{2} \\end{pmatrix}\n+ \\begin{pmatrix} 0  3 \\\\ 0  \\frac{1}{2} \\end{pmatrix}\n- \\begin{pmatrix} 0  0 \\\\ 0  1 \\end{pmatrix}\n= \\begin{pmatrix} 0  3 \\\\ 3  0 \\end{pmatrix}.\n$$\n$M$ 的特征值是特征多项式 $\\det(M-\\mu I)=\\mu^2-9$ 的根，因此 $\\mu=\\pm 3$。由于 $M$ 有一个负特征值，$M$ 不是半正定的，因此该 DIRK 阵违反了代数稳定性。这种违反意味着，即使对于耗散线性问题（例如具有 $\\operatorname{Re}(\\lambda)\\le 0$ 的半离散 DG 系统），对于某些步长，收缩性也可能丧失。\n\n接下来，我们推导线性测试方程 $u'=\\lambda u$（其中 $z=h\\lambda$）的龙格-库塔稳定性函数 $R(z)$。对于一般的 RK 方法，放大因子由熟知的公式给出\n$$\nR(z) = 1 + z\\, b^{\\top} (I - z A)^{-1} e,\n$$\n其中 $e=(1,\\dots,1)^{\\top}$。对于我们的 2 级 DIRK，有 $e=\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$ 和\n$$\nI - z A = \\begin{pmatrix} 1 - z a  0 \\\\ - z c  1 - z a \\end{pmatrix}.\n$$\n令 $\\alpha \\equiv 1 - z a$ 和 $\\beta \\equiv - z c$。形如 $\\begin{pmatrix} \\alpha  0 \\\\ \\beta  \\alpha \\end{pmatrix}$ 的下三角矩阵的逆矩阵是\n$$\n\\begin{pmatrix} \\alpha^{-1}  0 \\\\ -\\beta \\alpha^{-2}  \\alpha^{-1} \\end{pmatrix}.\n$$\n因此，\n$$\n(I - z A)^{-1} e\n= \\begin{pmatrix} \\alpha^{-1}  0 \\\\ -\\beta \\alpha^{-2}  \\alpha^{-1} \\end{pmatrix}\n\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n= \\begin{pmatrix} \\alpha^{-1} \\\\ -\\beta \\alpha^{-2} + \\alpha^{-1} \\end{pmatrix}\n= \\begin{pmatrix} \\alpha^{-1} \\\\ z c\\, \\alpha^{-2} + \\alpha^{-1} \\end{pmatrix}.\n$$\n对于 $b=\\begin{pmatrix} b_1 \\\\ b_2 \\end{pmatrix}$，我们有\n$$\nb^{\\top} (I - z A)^{-1} e\n= b_1\\, \\alpha^{-1} + b_2\\left( z c\\, \\alpha^{-2} + \\alpha^{-1} \\right)\n= (b_1 + b_2)\\, \\alpha^{-1} + b_2\\, z c\\, \\alpha^{-2}.\n$$\n代入 $R(z)$ 得到其符号形式\n$$\nR(z) = 1 + z\\, \\frac{b_1 + b_2}{1 - z a} + b_2\\, c\\, \\frac{z^{2}}{(1 - z a)^{2}}.\n$$\n对于我们的具体系数 $a=\\frac{1}{2}$，$c=3$，$b_1=0$，$b_2=1$，稳定性函数化简为\n$$\nR(z) = 1 + \\frac{z}{1 - \\frac{z}{2}} + \\frac{3 z^{2}}{\\left(1 - \\frac{z}{2}\\right)^{2}}.\n$$\n为了量化沿负实轴的收缩性丧失，我们在 $z=-2$ 处求值。那么 $1 - \\frac{z}{2}=1 - \\left( -1 \\right)=2$，所以\n$$\nR(-2) = 1 + \\frac{-2}{2} + \\frac{3\\cdot (-2)^{2}}{2^{2}}\n= 1 - 1 + \\frac{3\\cdot 4}{4}\n= 0 + 3\n= 3.\n$$\n因此 $|R(-2)|=3$，该值严格大于 $1$。这证明了收缩性的丧失：对于 $z=-2$ 的耗散模式，该方法在一个时间步内将解放大了 3 倍，这与上面发现的违反代数稳定性的结论一致。", "answer": "$$\\boxed{3}$$", "id": "3378945"}]}