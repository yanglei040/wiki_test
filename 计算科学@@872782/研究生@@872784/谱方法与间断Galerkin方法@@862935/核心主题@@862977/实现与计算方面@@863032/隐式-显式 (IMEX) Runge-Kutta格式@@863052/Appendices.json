{"hands_on_practices": [{"introduction": "在处理刚性极强的微分方程时，我们希望隐式-显式（IMEX）格式的最终解就是最后一个隐式阶段的计算结果。这个被称为“刚性精度”（stiff accuracy）的特性可以同时提升计算效率和稳定性。本练习提供了一种直接的方法来验证给定格式是否具备这一关键特性。[@problem_id:3391644]", "problem": "考虑一个半离散系统，该系统通过对周期性区域上的线性平流-扩散方程进行谱间断伽辽金 (DG) 空间离散化得到，并写成一个分裂为非刚性分量和刚性分量的常微分方程 (ODE)，\n$$\n\\frac{d}{dt} u(t) \\;=\\; f(u(t)) \\;+\\; g(u(t)),\n$$\n其中 $f$ 表示非刚性平流贡献，$g$ 表示刚性扩散贡献。时间积分采用一个 2 阶隐式-显式 (IMEX) 龙格-库塔 (RK) 格式进行，其显式和隐式 Butcher 表的系数为\n$$\nA^{E} \\;=\\;\n\\begin{pmatrix}\n0  0 \\\\\n1  0\n\\end{pmatrix},\n\\quad\nb^{E} \\;=\\;\n\\begin{pmatrix}\n\\frac{1}{2} \\\\ \\frac{1}{2}\n\\end{pmatrix},\n\\quad\nc^{E} \\;=\\;\n\\begin{pmatrix}\n0 \\\\ 1\n\\end{pmatrix},\n$$\n和\n$$\nA^{I} \\;=\\;\n\\begin{pmatrix}\n\\frac{1}{3}  0 \\\\\n\\frac{2}{3}  \\frac{1}{3}\n\\end{pmatrix},\n\\quad\nb^{I} \\;=\\;\n\\begin{pmatrix}\n\\frac{2}{3} \\\\ \\frac{1}{3}\n\\end{pmatrix},\n\\quad\nc^{I} \\;=\\;\n\\begin{pmatrix}\n\\frac{1}{3} \\\\ 1\n\\end{pmatrix}.\n$$\n假设在一个时间步长内，非刚性贡献消失，即 $f \\equiv 0$，因此只有刚性分量起作用。使用隐式-显式 (IMEX) 龙格-库塔 (RK) 格式的阶段和更新的基本定义，通过检查准则 $(b^{I})^T = A^{I}_{s,:}$ 来确定隐式部分是否是刚性精确的，其中 $s = 2$ 是阶段数。然后，在 $f \\equiv 0$ 的条件下，判断单步更新 $u^{n+1}$ 是否等于最后一个隐式阶段。\n\n为了进行单个标量诊断，计算\n$$\n\\delta \\;=\\; \\left|b^{I}_{1} \\;-\\; A^{I}_{2,1}\\right| \\;+\\; \\left|b^{I}_{2} \\;-\\; A^{I}_{2,2}\\right|.\n$$\n以精确形式（无舍入）表示最终的标量 $\\delta$。", "solution": "用户提供的问题被评估为有效，因为它在科学上基于微分方程数值方法的理论，是适定的和客观的。它包含了得出唯一解所需的所有必要信息。\n\n该问题要求在微分方程的非刚性部分消失的条件下，分析一个特定的 2 阶隐式-显式 (IMEX) 龙格-库塔 (RK) 格式。\n\n首先，我们回顾常微分方程 (ODE) $\\frac{d}{dt} u(t) = f(u(t)) + g(u(t))$ 的 $s$ 阶 IMEX-RK 格式的一般形式。该格式根据前一个时间步的解 $u^n$ 在大小为 $\\Delta t$ 的时间步长上计算更新后的解 $u^{n+1}$。中间阶段 $U_i$ 的计算如下：\n$$\nU_i = u^n + \\Delta t \\sum_{j=1}^{s} A^{E}_{ij} f(U_j) + \\Delta t \\sum_{j=1}^{s} A^{I}_{ij} g(U_j), \\quad \\text{for } i = 1, \\dots, s\n$$\n显式部分通常是严格下三角矩阵（当 $j \\ge i$ 时，$A^E_{ij} = 0$），而隐式部分是下三角矩阵（当 $j > i$ 时，$A^I_{ij} = 0$）。因此，阶段方程为：\n$$\nU_i = u^n + \\Delta t \\sum_{j=1}^{i-1} A^{E}_{ij} f(U_j) + \\Delta t \\sum_{j=1}^{i} A^{I}_{ij} g(U_j), \\quad \\text{for } i = 1, \\dots, s\n$$\n最终的解更新由以下公式给出：\n$$\nu^{n+1} = u^n + \\Delta t \\sum_{i=1}^{s} b^{E}_{i} f(U_i) + \\Delta t \\sum_{i=1}^{s} b^{I}_{i} g(U_i)\n$$\n问题指定非刚性贡献消失，即 $f \\equiv 0$。在此条件下，IMEX-RK 格式显著简化。阶段方程变为：\n$$\nU_i = u^n + \\Delta t \\sum_{j=1}^{i} A^{I}_{ij} g(U_j), \\quad \\text{for } i = 1, \\dots, s\n$$\n最终更新变为：\n$$\nu^{n+1} = u^n + \\Delta t \\sum_{i=1}^{s} b^{I}_{i} g(U_i)\n$$\n这等同于对刚性常微分方程 $\\frac{d}{dt} u(t) = g(u(t))$ 应用一个系数为 $(A^I, b^I, c^I)$ 的标准隐式龙格-库塔 (IRK) 方法。\n\n问题要求确定隐式部分是否是刚性精确的。如果一个 IRK 格式的权重向量 $b^I$ 等于其系数矩阵 $A^I$ 的最后一行，则称该格式是刚性精确的。对于一个 $s$ 阶格式，这个准则为 $(b^I)^T = A^I_{s,:}$，这意味着对于所有的 $j=1, \\dots, s$，都有 $b^I_j = A^I_{s,j}$。\n\n给定的格式有 $s=2$ 个阶段。隐式 Butcher 表的系数为：\n$$\nA^{I} = \\begin{pmatrix} \\frac{1}{3}  0 \\\\ \\frac{2}{3}  \\frac{1}{3} \\end{pmatrix} \\quad \\text{and} \\quad b^{I} = \\begin{pmatrix} \\frac{2}{3} \\\\ \\frac{1}{3} \\end{pmatrix}\n$$\n阶段数为 $s=2$。矩阵 $A^I$ 的最后一行是第二行 $A^I_{2,:}$：\n$$\nA^{I}_{2,:} = \\begin{pmatrix} A^{I}_{2,1}  A^{I}_{2,2} \\end{pmatrix} = \\begin{pmatrix} \\frac{2}{3}  \\frac{1}{3} \\end{pmatrix}\n$$\n我们将权重向量 $b^I$ 的转置与此进行比较：\n$$\n(b^{I})^T = \\begin{pmatrix} b^{I}_{1}  b^{I}_{2} \\end{pmatrix} = \\begin{pmatrix} \\frac{2}{3}  \\frac{1}{3} \\end{pmatrix}\n$$\n我们观察到 $(b^{I})^T = A^{I}_{2,:}$。因此，该格式的隐式部分确实是刚性精确的。\n\n接下来，我们判断单步更新 $u^{n+1}$ 是否等于最后一个隐式阶段 $U_s$。当 $f \\equiv 0$ 且 $s=2$ 时，最后一个阶段 $U_2$ 由下式给出：\n$$\nU_2 = u^n + \\Delta t \\sum_{j=1}^{2} A^{I}_{2j} g(U_j) = u^n + \\Delta t \\left( A^{I}_{2,1} g(U_1) + A^{I}_{2,2} g(U_2) \\right)\n$$\n最终更新 $u^{n+1}$ 由下式给出：\n$$\nu^{n+1} = u^n + \\Delta t \\sum_{i=1}^{2} b^{I}_{i} g(U_i) = u^n + \\Delta t \\left( b^{I}_{1} g(U_1) + b^{I}_{2} g(U_2) \\right)\n$$\n由于该格式是刚性精确的，我们有 $b^{I}_{1} = A^{I}_{2,1}$ 和 $b^{I}_{2} = A^{I}_{2,2}$。将这些等式代入 $u^{n+1}$ 的表达式中得到：\n$$\nu^{n+1} = u^n + \\Delta t \\left( A^{I}_{2,1} g(U_1) + A^{I}_{2,2} g(U_2) \\right)\n$$\n这个表达式与 $U_2$ 的表达式完全相同。因此，我们可以得出结论，对于此格式，在 $f \\equiv 0$ 的条件下，单步更新等于最后一个隐式阶段：$u^{n+1} = U_2$。这是刚性精确方法的一个关键优点，特别是对于具有刚性边界条件的问题或确保稳定性属性的问题。\n\n最后，我们计算标量诊断值 $\\delta$，它量化了 $b^I$ 和 $A^I$ 最后一行之间的差异。其定义为：\n$$\n\\delta = |b^{I}_{1} - A^{I}_{2,1}| + |b^{I}_{2} - A^{I}_{2,2}|\n$$\n我们代入所提供的 Butcher 表中的值：\n- $b^{I}_{1} = \\frac{2}{3}$\n- $b^{I}_{2} = \\frac{1}{3}$\n- $A^{I}_{2,1} = \\frac{2}{3}$\n- $A^{I}_{2,2} = \\frac{1}{3}$\n\n计算过程如下：\n$$\n\\delta = \\left|\\frac{2}{3} - \\frac{2}{3}\\right| + \\left|\\frac{1}{3} - \\frac{1}{3}\\right|\n$$\n$$\n\\delta = |0| + |0|\n$$\n$$\n\\delta = 0\n$$\n$\\delta = 0$ 的值证实了我们之前的发现，即该格式的隐式部分是刚性精确的。", "answer": "$$\\boxed{0}$$", "id": "3391644"}, {"introduction": "数值模拟的效率通常需要自适应时间步长，即根据局部误差的估计来调整步长 $\\Delta t$。本练习将探讨如何构建一个“嵌入式”IMEX对，它能提供两个不同阶的解，从而估计误差并控制时间步。这个过程将理论（阶条件）与实践（效率）联系起来，展示了IMEX方法在实际应用中的灵活性和强大功能。[@problem_id:3391633]", "problem": "考虑一个周期性区域上线性平流扩散方程的半离散间断Galerkin (DG) 近似，写成加法形式\n$$\n\\frac{\\mathrm{d} \\boldsymbol{u}}{\\mathrm{d} t} \\;=\\; \\boldsymbol{f}(\\boldsymbol{u}) \\;+\\; \\boldsymbol{g}(\\boldsymbol{u}),\n$$\n其中 $\\boldsymbol{f}$ 表示非刚性对流贡献（将进行显式处理），$\\boldsymbol{g}$ 表示刚性黏性贡献（将进行隐式处理）。您需要为该半离散系统的时间积分构建一个阶数为 $(p,p-1) = (2,1)$ 的隐式-显式 (IMEX) Runge–Kutta (RK) 嵌入对，并推导一个用于自适应时间步长控制的、混合了显式和隐式残差的误差估计器。\n\n采用具有步值 $\\boldsymbol{Y}_{i}$ ($i \\in \\{1,2\\}$) 和时间步长 $\\Delta t$ 的两步加法RK结构，形式如下：\n$$\n\\boldsymbol{Y}_{i} \\;=\\; \\boldsymbol{u}^{n} \\;+\\; \\Delta t \\sum_{j=1}^{i-1} a^{\\mathrm{E}}_{i j} \\, \\boldsymbol{f}(\\boldsymbol{Y}_{j}) \\;+\\; \\Delta t \\sum_{j=1}^{i} a^{\\mathrm{I}}_{i j} \\, \\boldsymbol{g}(\\boldsymbol{Y}_{j}),\n$$\n以及解的更新公式\n$$\n\\boldsymbol{u}^{n+1} \\;=\\; \\boldsymbol{u}^{n} \\;+\\; \\Delta t \\sum_{i=1}^{2} b^{\\mathrm{E}}_{i} \\, \\boldsymbol{f}(\\boldsymbol{Y}_{i}) \\;+\\; \\Delta t \\sum_{i=1}^{2} b^{\\mathrm{I}}_{i} \\, \\boldsymbol{g}(\\boldsymbol{Y}_{i}).\n$$\n将显式部分取为两步显式梯形法（也称为Heun法），\n$$\nA^{\\mathrm{E}} \\;=\\; \\begin{pmatrix} 0  0 \\\\ 1  0 \\end{pmatrix}, \n\\quad \\boldsymbol{b}^{\\mathrm{E}} \\;=\\; \\begin{pmatrix} \\tfrac{1}{2} \\\\ \\tfrac{1}{2} \\end{pmatrix}, \n\\quad \\boldsymbol{c}^{\\mathrm{E}} \\;=\\; \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix},\n$$\n将隐式部分取为带有未知对角参数 $\\gamma$ 的两步单对角隐式Runge–Kutta (SDIRK) 格式，\n$$\nA^{\\mathrm{I}} \\;=\\; \\begin{pmatrix} \\gamma  0 \\\\ 1-\\gamma  \\gamma \\end{pmatrix}, \n\\quad \\boldsymbol{b}^{\\mathrm{I}} \\;=\\; \\begin{pmatrix} 1-\\gamma \\\\ \\gamma \\end{pmatrix}, \n\\quad \\boldsymbol{c}^{\\mathrm{I}} \\;=\\; \\begin{pmatrix} \\gamma \\\\ 1 \\end{pmatrix}.\n$$\n假设隐式部分是刚性精确的，即 $A^{\\mathrm{I}}$ 的最后一行等于 $(\\boldsymbol{b}^{\\mathrm{I}})^{\\top}$ 且 $c^{\\mathrm{I}}_{2} = 1$。通过采用一阶显式和隐式权重来构造嵌入的低阶 $(p-1)=1$ 对：\n$$\n\\widetilde{\\boldsymbol{b}}^{\\mathrm{E}} \\;=\\; \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix},\n\\qquad\n\\widetilde{\\boldsymbol{b}}^{\\mathrm{I}} \\;=\\; \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}.\n$$\n\n任务：\n\n- 从线性测试方程 $\\boldsymbol{u}' = \\boldsymbol{f}(\\boldsymbol{u})$ 和 $\\boldsymbol{u}' = \\boldsymbol{g}(\\boldsymbol{u})$ 以及直到 $p=2$ 阶的标准Runge–Kutta阶条件出发，确定当应用于 $\\boldsymbol{u}' = \\boldsymbol{g}(\\boldsymbol{u})$ 时，使隐式部分达到二阶精度且L-稳定的 $\\gamma$ 的精确值。\n\n- 将嵌入式误差估计器定义为高阶和低阶IMEX更新的差值，\n$$\n\\boldsymbol{e} \\;=\\; \\Delta t \\sum_{i=1}^{2} \\bigl(b^{\\mathrm{E}}_{i} - \\widetilde{b}^{\\mathrm{E}}_{i}\\bigr) \\, \\boldsymbol{f}(\\boldsymbol{Y}_{i}) \\;+\\; \\Delta t \\sum_{i=1}^{2} \\bigl(b^{\\mathrm{I}}_{i} - \\widetilde{b}^{\\mathrm{I}}_{i}\\bigr) \\, \\boldsymbol{g}(\\boldsymbol{Y}_{i}),\n$$\n并且，为了在DG背景下进行自适应时间步进，引入一个结合了显式和隐式残差贡献的混合标量指示器，\n$$\n\\eta \\;=\\; \\Bigl( \\alpha \\, \\|\\boldsymbol{e}_{\\mathrm{E}}\\|^{2} \\;+\\; (1-\\alpha)\\, \\|\\boldsymbol{e}_{\\mathrm{I}}\\|^{2} \\Bigr)^{1/2},\n$$\n其中\n$$\n\\boldsymbol{e}_{\\mathrm{E}} \\;=\\; \\Delta t \\sum_{i=1}^{2} \\bigl(b^{\\mathrm{E}}_{i} - \\widetilde{b}^{\\mathrm{E}}_{i}\\bigr) \\, \\boldsymbol{f}(\\boldsymbol{Y}_{i}),\n\\qquad\n\\boldsymbol{e}_{\\mathrm{I}} \\;=\\; \\Delta t \\sum_{i=1}^{2} \\bigl(b^{\\mathrm{I}}_{i} - \\widetilde{b}^{\\mathrm{I}}_{i}\\bigr) \\, \\boldsymbol{g}(\\boldsymbol{Y}_{i}),\n$$\n且 $\\alpha \\in (0,1)$ 是一个用户选择的权重。使用主阶截断误差缩放，证明步长控制器\n$$\n\\Delta t_{\\mathrm{new}} \\;=\\; \\theta \\, \\Delta t \\, \\Bigl(\\frac{\\mathrm{TOL}}{\\eta}\\Bigr)^{1/2},\n$$\n的合理性，其中安全因子 $\\theta \\in (0,1)$ 且容差 $\\mathrm{TOL}  0$。不需要对 $\\Delta t_{\\mathrm{new}}$进行数值计算。\n\n您的最终交付成果是唯一的 $\\gamma \\in (0,1)$ 的精确解析表达式，该值保证了隐式部分的二阶精度和L-稳定性。请仅报告该值作为您的最终答案，形式为精确形式，无近似，无单位。", "solution": "首先验证问题，以确保其具有科学依据、是适定的、客观的和完整的。所有给定的数据、变量和条件都在微分方程数值分析的标准框架内得到了明确定义。该问题是推导隐式-显式 (IMEX) Runge-Kutta 格式性质的一个形式化练习，这是一个成熟的课题。问题中没有矛盾、歧义或不科学的前提。该问题是有效的。\n\n问题分为两个任务：首先，确定该格式隐式部分的参数 $\\gamma$；其次，证明所提出的自适应时间步长控制器的合理性。\n\n第一个任务是找到 $\\gamma \\in (0,1)$ 的值，使得隐式Runge-Kutta格式在应用于常微分方程 $\\boldsymbol{u}' = \\boldsymbol{g}(\\boldsymbol{u})$ 时具有二阶精度和L-稳定性。该隐式格式是一种单对角隐式Runge-Kutta (SDIRK) 方法，由以下Butcher tableau描述：\n$$\n\\begin{array}{c|c}\n\\boldsymbol{c}^{\\mathrm{I}}  A^{\\mathrm{I}} \\\\\n\\hline\n (\\boldsymbol{b}^{\\mathrm{I}})^{\\top}\n\\end{array}\n\\;=\\;\n\\begin{array}{c|cc}\n\\gamma  \\gamma  0 \\\\\n1  1-\\gamma  \\gamma \\\\\n\\hline\n 1-\\gamma  \\gamma\n\\end{array}\n$$\n节点向量 $\\boldsymbol{c}^{\\mathrm{I}}$ 与矩阵 $A^{\\mathrm{I}}$ 是一致的，因为 $c^{\\mathrm{I}}_1 = a^{\\mathrm{I}}_{11} + a^{\\mathrm{I}}_{12} = \\gamma + 0 = \\gamma$ 且 $c^{\\mathrm{I}}_2 = a^{\\mathrm{I}}_{21} + a^{\\mathrm{I}}_{22} = (1-\\gamma) + \\gamma = 1$。\n\nRunge-Kutta方法达到 $p=2$ 阶的阶条件是：\n1. 一阶：$\\sum_{i=1}^{s} b^{\\mathrm{I}}_i = 1$。\n2. 二阶：$\\sum_{i=1}^{s} b^{\\mathrm{I}}_i c^{\\mathrm{I}}_i = \\frac{1}{2}$。\n\n这里，$s=2$。我们为给定的隐式格式检查这些条件。\n对于一阶条件：\n$$\n\\sum_{i=1}^{2} b^{\\mathrm{I}}_i = b^{\\mathrm{I}}_1 + b^{\\mathrm{I}}_2 = (1-\\gamma) + \\gamma = 1.\n$$\n此条件对任意 $\\gamma$ 值都满足。\n\n对于二阶条件：\n$$\n\\sum_{i=1}^{2} b^{\\mathrm{I}}_i c^{\\mathrm{I}}_i = b^{\\mathrm{I}}_1 c^{\\mathrm{I}}_1 + b^{\\mathrm{I}}_2 c^{\\mathrm{I}}_2 = (1-\\gamma)(\\gamma) + (\\gamma)(1) = \\gamma - \\gamma^2 + \\gamma = 2\\gamma - \\gamma^2.\n$$\n为达到二阶精度，该和必须等于 $\\frac{1}{2}$：\n$$\n2\\gamma - \\gamma^2 = \\frac{1}{2}.\n$$\n这可以重写为一个标准二次方程：\n$$\n\\gamma^2 - 2\\gamma + \\frac{1}{2} = 0.\n$$\n使用求根公式 $\\gamma = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$，其中 $a=1$，$b=-2$，$c=\\frac{1}{2}$：\n$$\n\\gamma = \\frac{2 \\pm \\sqrt{(-2)^2 - 4(1)(\\frac{1}{2})}}{2(1)} = \\frac{2 \\pm \\sqrt{4 - 2}}{2} = \\frac{2 \\pm \\sqrt{2}}{2} = 1 \\pm \\frac{\\sqrt{2}}{2}.\n$$\n问题指明 $\\gamma \\in (0,1)$。解 $1 + \\frac{\\sqrt{2}}{2} \\approx 1.707$ 在此区间之外。另一个解 $1 - \\frac{\\sqrt{2}}{2} \\approx 0.293$ 在此区间之内。因此，保证二阶精度的唯一 $\\gamma$ 值为：\n$$\n\\gamma = 1 - \\frac{\\sqrt{2}}{2}.\n$$\n\n接下来，我们必须验证这个 $\\gamma$ 的选择会得到一个L-稳定的方法。L-稳定性要求方法是A-稳定的，并且其稳定性函数 $R(z)$ 满足 $\\lim_{|z| \\to \\infty} |R(z)| = 0$。\n\n问题指出该方法是刚性精确的，这意味着数值解的更新与最终步值一致。对于线性测试方程 $u' = \\lambda u$，其中 $z = \\lambda \\Delta t$，稳定性函数 $R(z)$ 是 $u_{n+1}/u_n = 1 + z (\\boldsymbol{b}^{\\mathrm{I}})^\\top (\\boldsymbol{I} - z A^{\\mathrm{I}})^{-1} \\boldsymbol{e}$，其中 $\\boldsymbol{e}=(1, 1, \\dots, 1)^{\\top}$。对于SDIRK方法，其稳定性函数也可以写成 $R(z) = \\frac{\\det(\\boldsymbol{I}-zA^\\mathrm{I} + z\\boldsymbol{e}(\\boldsymbol{b}^\\mathrm{I})^\\top)}{\\det(\\boldsymbol{I}-zA^\\mathrm{I})}$。对于刚性精确的SDIRK方法，稳定性函数就是 $(\\boldsymbol{I} - z A^{\\mathrm{I}})^{-1} \\boldsymbol{e}$ 的最后一个分量。\n$$\n\\boldsymbol{I} - z A^{\\mathrm{I}} = \\begin{pmatrix} 1 - z\\gamma  0 \\\\ -z(1-\\gamma)  1 - z\\gamma \\end{pmatrix}.\n$$\n逆矩阵是：\n$$\n(\\boldsymbol{I} - z A^{\\mathrm{I}})^{-1} = \\frac{1}{(1-z\\gamma)^2} \\begin{pmatrix} 1 - z\\gamma  0 \\\\ z(1-\\gamma)  1 - z\\gamma \\end{pmatrix}.\n$$\n那么，$(\\boldsymbol{I} - z A^{\\mathrm{I}})^{-1} \\boldsymbol{e}$ 是：\n$$\n\\frac{1}{(1-z\\gamma)^2} \\begin{pmatrix} 1 - z\\gamma \\\\ z(1-\\gamma) + (1 - z\\gamma) \\end{pmatrix} = \\frac{1}{(1-z\\gamma)^2} \\begin{pmatrix} 1 - z\\gamma \\\\ 1 + z(1-2\\gamma) \\end{pmatrix}.\n$$\n稳定性函数是该向量的第二个分量：\n$$\nR(z) = \\frac{1 + z(1-2\\gamma)}{(1-z\\gamma)^2}.\n$$\n为了判断L-稳定性，我们首先检查 $|z| \\to \\infty$ 时的极限：\n$$\n\\lim_{|z| \\to \\infty} |R(z)| = \\lim_{|z| \\to \\infty} \\left| \\frac{1 + z(1-2\\gamma)}{(1-z\\gamma)^2} \\right| = \\lim_{|z| \\to \\infty} \\left| \\frac{z(1-2\\gamma)}{z^2\\gamma^2} \\right| = \\lim_{|z| \\to \\infty} \\left| \\frac{1-2\\gamma}{\\gamma^2 z} \\right| = 0.\n$$\n对于任何 $\\gamma \\neq 0$，此条件都满足。\n\n接下来，我们检查A-稳定性，这要求对于左半平面中所有的 $z$（即 $\\mathrm{Re}(z) \\le 0$），都有 $|R(z)| \\le 1$。根据最大模原理，只需在虚轴上检查此条件即可，即对于所有实数 $y$，都有 $|R(iy)| \\le 1$。\n$$\n|R(iy)|^2 = \\left| \\frac{1 + iy(1-2\\gamma)}{(1-iy\\gamma)^2} \\right|^2 = \\frac{|1 + iy(1-2\\gamma)|^2}{|(1-iy\\gamma)^2|^2} = \\frac{1 + y^2(1-2\\gamma)^2}{(1+y^2\\gamma^2)^2}.\n$$\n条件 $|R(iy)|^2 \\le 1$ 变为：\n$$\n1 + y^2(1-2\\gamma)^2 \\le (1+y^2\\gamma^2)^2 = 1 + 2y^2\\gamma^2 + y^4\\gamma^4.\n$$\n两边减去 $1$ 并除以 $y^2$（对于 $y \\neq 0$）：\n$$\n(1-2\\gamma)^2 \\le 2\\gamma^2 + y^2\\gamma^4.\n$$\n$$\n1 - 4\\gamma + 4\\gamma^2 \\le 2\\gamma^2 + y^2\\gamma^4.\n$$\n$$\n1 - 4\\gamma + 2\\gamma^2 \\le y^2\\gamma^4.\n$$\n由于这个不等式必须对所有实数 $y$ 成立，它必须在 $y \\to 0$ 时也成立。这意味着左侧不能为正：\n$$\n2\\gamma^2 - 4\\gamma + 1 \\le 0.\n$$\n二次方程 $2\\gamma^2 - 4\\gamma + 1 = 0$ 的根是 $\\gamma = 1 \\pm \\frac{\\sqrt{2}}{2}$。由于抛物线开口向上，该不等式对于位于这两根之间的 $\\gamma$ 成立：$1 - \\frac{\\sqrt{2}}{2} \\le \\gamma \\le 1 + \\frac{\\sqrt{2}}{2}$。\n我们的值 $\\gamma = 1 - \\frac{\\sqrt{2}}{2}$ 位于该区域的边界上，使得条件中的等号成立。因此，该格式是A-稳定的。由于A-稳定性和极限条件都得到满足，所以该格式对于 $\\gamma = 1 - \\frac{\\sqrt{2}}{2}$ 是L-稳定的。\n\n第二个任务是证明步长控制器的合理性。误差估计器 $\\boldsymbol{e}$ 是二阶解 $\\boldsymbol{u}^{n+1}$ 和一阶嵌入解 $\\widetilde{\\boldsymbol{u}}^{n+1}$ 之间的差。高阶方法的局部截断误差 (LTE) 为 $LTE_p = O((\\Delta t)^{p+1}) = O((\\Delta t)^3)$，而低阶方法的局部截断误差为 $LTE_{p-1} = O((\\Delta t)^p) = O((\\Delta t)^2)$。\n因此，误差估计为：\n$$\n\\boldsymbol{e} = \\boldsymbol{u}^{n+1} - \\widetilde{\\boldsymbol{u}}^{n+1} = (\\boldsymbol{u}(t_{n+1}) - \\widetilde{\\boldsymbol{u}}^{n+1}) - (\\boldsymbol{u}(t_{n+1}) - \\boldsymbol{u}^{n+1}) = LTE_{p-1} - LTE_p.\n$$\n对于小的 $\\Delta t$，主项来自低阶方法：\n$$\n\\boldsymbol{e} \\approx LTE_{p-1} \\approx \\boldsymbol{C} (\\Delta t)^2,\n$$\n其中 $\\boldsymbol{C}$ 是一个取决于解的导数的向量，但在单个时间步内假定其近似为常数。标量误差指示器 $\\eta$ 是 $\\boldsymbol{e}$ 分量的一个范数，因此其缩放行为是相同的：\n$$\n\\eta \\approx K (\\Delta t)^2,\n$$\n其中 $K$ 是一个标量常数。自适应时间步进的目标是选择一个新的步长 $\\Delta t_{\\mathrm{new}}$，使得新步长的估计误差 $\\eta_{\\mathrm{new}}$ 等于一个指定的容差 $\\mathrm{TOL}$。\n假设 $K$ 是常数，我们有：\n$$\n\\eta \\approx K (\\Delta t)^2 \\quad \\text{和} \\quad \\mathrm{TOL} \\approx K (\\Delta t_{\\mathrm{new}})^2.\n$$\n将这两个表达式相除得到：\n$$\n\\frac{\\mathrm{TOL}}{\\eta} \\approx \\frac{K (\\Delta t_{\\mathrm{new}})^2}{K (\\Delta t)^2} = \\left(\\frac{\\Delta t_{\\mathrm{new}}}{\\Delta t}\\right)^2.\n$$\n解出 $\\Delta t_{\\mathrm{new}}$ 可得：\n$$\n\\Delta t_{\\mathrm{new}} \\approx \\Delta t \\left(\\frac{\\mathrm{TOL}}{\\eta}\\right)^{1/2}.\n$$\n引入一个安全因子 $\\theta \\in (0,1)$ 以提供更保守的步长更新并考虑到近似的影响，从而得到控制器：\n$$\n\\Delta t_{\\mathrm{new}} = \\theta \\, \\Delta t \\, \\left(\\frac{\\mathrm{TOL}}{\\eta}\\right)^{1/2}.\n$$\n这证明了所提出控制器形式的合理性，其中指数 $1/2$ 源于误差估计器与时间步长呈二次方关系这一事实。\n\n最终的交付成果是前面提到的 $\\gamma$ 值。", "answer": "$$\\boxed{1 - \\frac{\\sqrt{2}}{2}}$$", "id": "3391633"}, {"introduction": "一个设计良好的IMEX格式在刚性参数 $\\varepsilon$ 趋于零的极限情况下，应当能自动捕捉到极限“松弛”系统的物理行为，而其时间步长不受 $\\varepsilon$ 的限制。这种特性被称为“渐近保持”（asymptotic preserving）。本练习通过分析格式在无限刚性极限下的稳定性函数，深入探讨了这一重要性质，揭示了高级IMEX格式设计的精髓。[@problem_id:3391641]", "problem": "考虑由分裂谱间断Galerkin (DG) 格式的傅里叶模式半离散化产生的线性松弛常微分方程，\n$$\n\\frac{\\mathrm{d}u}{\\mathrm{d}t} \\;=\\; \\lambda_{E}\\,u \\;+\\; \\frac{1}{\\varepsilon}\\,\\bigl(R(u)-u\\bigr),\n$$\n其中 $u$ 是半离散状态，$\\lambda_{E}\\in\\mathbb{C}$ 是对流算子的非刚性傅里叶符号，$\\varepsilon0$ 是一个刚度参数，$R$ 是满足 $R^{2}=R$ 的线性平衡投影。将平衡（或松弛）变量记为 $v:=R(u)$，因此平衡流形上的点满足 $R(u)=u$。时间推进通过 Ascher–Ruuth–Spiteri 类型的二阶两步隐式-显式 (IMEX) 加性龙格-库塔格式进行，其显式和对角隐式表由下式给出\n$$\nA^{E} \\;=\\; \\begin{pmatrix} 0  0 \\\\ \\gamma  0 \\end{pmatrix}, \n\\qquad\nb^{E} \\;=\\; \\begin{pmatrix} b_{1}^{E} \\\\ b_{2}^{E} \\end{pmatrix} \\;=\\; \\begin{pmatrix} 1 - \\frac{1}{2\\gamma} \\\\ \\frac{1}{2\\gamma} \\end{pmatrix},\n$$\n和\n$$\nA^{I} \\;=\\; \\begin{pmatrix} \\gamma  0 \\\\ 1-\\gamma  \\gamma \\end{pmatrix}, \n\\qquad\nb^{I} \\;=\\; \\begin{pmatrix} 1-\\gamma \\\\ \\gamma \\end{pmatrix},\n$$\n其中 \n$$\n\\gamma \\;=\\; 1 - \\frac{1}{\\sqrt{2}}.\n$$\n设 $\\Delta t0$ 为时间步长，并定义无量纲参数 $z_{E}:=\\Delta t\\,\\lambda_{E}$ 和 $z_{I}:=\\Delta t/\\varepsilon$。将上述 IMEX 格式应用于给定的半离散系统。\n\n任务：在渐近状态 $z_{I}\\to\\infty$（$z_{E}$ 固定）下，计算平衡变量 $v=R(u)$ 的极限稳定函数 $R_{\\mathrm{lim}}(z_{E})$，并验证在此极限下，每个显式阶段都作用于满足 $R(Y_{i})=Y_{i}$ 的平衡数据。请以 $z_{E}$ 的封闭形式解析表达式提供您的最终答案（无单位）。", "solution": "该问题被验证为具有科学依据、适定且客观。所提供的信息是自洽的，足以推导出解决方案。\n\n给定的常微分方程 (ODE) 是\n$$\n\\frac{\\mathrm{d}u}{\\mathrm{d}t} \\;=\\; \\lambda_{E}\\,u \\;+\\; \\frac{1}{\\varepsilon}\\,\\bigl(R(u)-u\\bigr)\n$$\n该系统被分为非刚性（显式）部分 $F(u)$ 和刚性（隐式）部分 $G(u)$：\n$$\nF(u) = \\lambda_{E} u\n$$\n$$\nG(u) = \\frac{1}{\\varepsilon}(R(u) - u)\n$$\n时间积分使用两步隐式-显式 (IMEX) 加性龙格-库塔格式进行。阶段值 $Y_i$ 计算如下：\n$$\nY_i = u_n + \\Delta t \\sum_{j=1}^{i-1} A^E_{ij} F(Y_j) + \\Delta t \\sum_{j=1}^{s} A^I_{ij} G(Y_j), \\quad i=1, \\dots, s\n$$\n解通过以下方式更新\n$$\nu_{n+1} = u_n + \\Delta t \\sum_{i=1}^{s} b^E_i F(Y_i) + \\Delta t \\sum_{i=1}^{s} b^I_i G(Y_i)\n$$\n对于给定的两步格式 ($s=2$)，显式和隐式Butcher表为：\n$$\nA^{E} = \\begin{pmatrix} 0  0 \\\\ \\gamma  0 \\end{pmatrix}, \\quad b^{E} = \\begin{pmatrix} 1 - \\frac{1}{2\\gamma} \\\\ \\frac{1}{2\\gamma} \\end{pmatrix}\n$$\n$$\nA^{I} = \\begin{pmatrix} \\gamma  0 \\\\ 1-\\gamma  \\gamma \\end{pmatrix}, \\quad b^{I} = \\begin{pmatrix} 1-\\gamma \\\\ \\gamma \\end{pmatrix}\n$$\n其中 $\\gamma = 1 - \\frac{1}{\\sqrt{2}}$。\n\n让我们明确写出阶段方程：\n阶段 1：\n$$\nY_1 = u_n + \\Delta t A^I_{11} G(Y_1) = u_n + \\Delta t \\gamma \\frac{1}{\\varepsilon}(R(Y_1) - Y_1)\n$$\n阶段 2：\n$$\nY_2 = u_n + \\Delta t A^E_{21} F(Y_1) + \\Delta t \\left( A^I_{21} G(Y_1) + A^I_{22} G(Y_2) \\right)\n$$\n$$\nY_2 = u_n + \\Delta t \\gamma \\lambda_E Y_1 + \\Delta t \\frac{1-\\gamma}{\\varepsilon}(R(Y_1) - Y_1) + \\Delta t \\frac{\\gamma}{\\varepsilon}(R(Y_2) - Y_2)\n$$\n我们引入无量纲参数 $z_E = \\Delta t \\lambda_E$ 和 $z_I = \\Delta t / \\varepsilon$。阶段方程变为：\n$$\nY_1 = u_n + z_I \\gamma (R(Y_1) - Y_1) \\quad (1)\n$$\n$$\nY_2 = u_n + z_E \\gamma Y_1 + z_I (1-\\gamma)(R(Y_1) - Y_1) + z_I \\gamma(R(Y_2) - Y_2) \\quad (2)\n$$\n\n我们关心的是在 $z_E$ 固定的情况下，$z_I \\to \\infty$ 的渐近状态。\n\n首先，我们来分析阶段 1。重排方程 (1)：\n$$\n(1 + z_I \\gamma)Y_1 = u_n + z_I \\gamma R(Y_1)\n$$\n$$\nY_1 = \\frac{1}{1+z_I\\gamma}u_n + \\frac{z_I\\gamma}{1+z_I\\gamma} R(Y_1)\n$$\n在极限 $z_I \\to \\infty$ 下，第一项消失，第二项的系数趋近于 1。假设 $Y_1$ 收敛于一个极限 $Y_{1, \\mathrm{lim}}$，我们有：\n$$\nY_{1, \\mathrm{lim}} = \\lim_{z_I \\to \\infty} R(Y_1) = R\\left(\\lim_{z_I \\to \\infty} Y_1\\right) = R(Y_{1, \\mathrm{lim}})\n$$\n这表明在极限情况下，阶段值 $Y_1$ 位于平衡流形上，满足 $R(Y_1)=Y_1$。这验证了第一阶段参数的条件。为了找到 $Y_{1, \\mathrm{lim}}$ 的值，我们将投影算子 $R$ 应用于方程 (1)，利用 $R$ 的线性和 $R^2=R$ 的性质：\n$$\nR(Y_1) = R(u_n) + z_I \\gamma R(R(Y_1) - Y_1) = R(u_n) + z_I \\gamma(R^2(Y_1) - R(Y_1)) = R(u_n)\n$$\n取极限 $z_I \\to \\infty$，我们得到 $\\lim_{z_I \\to \\infty} R(Y_1) = R(u_n)$。由于 $Y_{1, \\mathrm{lim}} = R(Y_{1, \\mathrm{lim}}) = \\lim_{z_I \\to \\infty} R(Y_1)$，可以得出：\n$$\nY_{1, \\mathrm{lim}} = R(u_n)\n$$\n\n接下来，我们在极限 $z_I \\to \\infty$ 下分析阶段 2。重排方程 (2)：\n$$\n(1 + z_I \\gamma)Y_2 = u_n + z_E \\gamma Y_1 + z_I (1-\\gamma)(R(Y_1) - Y_1) + z_I \\gamma R(Y_2)\n$$\n由方程 (1)，我们有 $R(Y_1) - Y_1 = -\\frac{1}{z_I \\gamma}(Y_1-u_n)$。将其代入 $Y_2$ 的方程中：\n$$\n(1 + z_I \\gamma)Y_2 = u_n + z_E \\gamma Y_1 - \\frac{1-\\gamma}{\\gamma}(Y_1-u_n) + z_I \\gamma R(Y_2)\n$$\n除以 $(1+z_I\\gamma)$ 并取极限 $z_I \\to \\infty$ 得到 $Y_{2, \\mathrm{lim}} = R(Y_{2, \\mathrm{lim}})$，这验证了第二阶段的平衡条件。为了求其值，我们将算子 $R$ 应用于方程 (2)：\n$$\nR(Y_2) = R(u_n) + z_E \\gamma R(Y_1) + z_I (1-\\gamma)R(R(Y_1) - Y_1) + z_I \\gamma R(R(Y_2) - Y_2)\n$$\n包含 $z_I$ 的项消失，因为 $R(R(X)-X) = R^2(X)-R(X)=0$。剩下：\n$$\nR(Y_2) = R(u_n) + z_E \\gamma R(Y_1)\n$$\n取极限 $z_I \\to \\infty$ 并利用 $\\lim_{z_I \\to \\infty} R(Y_1) = R(u_n)$ 的事实：\n$$\n\\lim_{z_I \\to \\infty} R(Y_2) = R(u_n) + z_E \\gamma R(u_n) = (1 + z_E \\gamma)R(u_n)\n$$\n由于 $Y_{2, \\mathrm{lim}} = R(Y_{2, \\mathrm{lim}}) = \\lim_{z_I \\to \\infty} R(Y_2)$，我们有：\n$$\nY_{2, \\mathrm{lim}} = (1 + z_E \\gamma)R(u_n)\n$$\n\n问题要求计算平衡变量 $v=R(u)$ 的极限稳定函数。完整变量 $u$ 的时间更新由下式给出：\n$$\nu_{n+1} = u_n + \\Delta t \\left( b^E_1 F(Y_1) + b^E_2 F(Y_2) \\right) + \\Delta t \\left( b^I_1 G(Y_1) + b^I_2 G(Y_2) \\right)\n$$\n我们通过应用投影算子 $R$ 来找到 $v_{n+1} = R(u_{n+1})$ 的更新：\n$$\nv_{n+1} = R(u_n) + \\Delta t R\\left( b^E_1 F(Y_1) + b^E_2 F(Y_2) \\right) + \\Delta t R\\left( b^I_1 G(Y_1) + b^I_2 G(Y_2) \\right)\n$$\n我们来分析包含隐式贡献的项。对于任意 $Y$：\n$$\nR(G(Y)) = R\\left(\\frac{1}{\\varepsilon}(R(Y)-Y)\\right) = \\frac{1}{\\varepsilon}(R^2(Y) - R(Y)) = 0\n$$\n因此，当投影到平衡流形上时，更新的隐式部分消失，与极限无关。$v$ 的更新简化为：\n$$\nv_{n+1} = R(u_n) + \\Delta t R\\left( b^E_1 \\lambda_E Y_1 + b^E_2 \\lambda_E Y_2 \\right) = v_n + z_E \\left( b^E_1 R(Y_1) + b^E_2 R(Y_2) \\right)\n$$\n其中 $v_n = R(u_n)$。在极限 $z_I \\to \\infty$ 下，我们代入 $R(Y_1)$ 和 $R(Y_2)$ 的极限值：\n$$\nv_{n+1} = v_n + z_E \\left( b^E_1 R(u_n) + b^E_2 (1+z_E\\gamma)R(u_n) \\right)\n$$\n$$\nv_{n+1} = v_n + z_E \\left( b^E_1 v_n + b^E_2 (1+z_E\\gamma)v_n \\right)\n$$\n$$\nv_{n+1} = \\left[ 1 + z_E b^E_1 + z_E b^E_2 (1+z_E\\gamma) \\right] v_n\n$$\n方括号中的项是极限稳定函数 $R_{\\mathrm{lim}}(z_E)$：\n$$\nR_{\\mathrm{lim}}(z_E) = 1 + z_E (b^E_1 + b^E_2) + z_E^2 \\gamma b^E_2\n$$\n问题提供了系数的值：\n$$\nb^E_1 = 1 - \\frac{1}{2\\gamma}, \\quad b^E_2 = \\frac{1}{2\\gamma}\n$$\n和为 $b^E_1 + b^E_2 = 1$。积为 $\\gamma b^E_2 = \\gamma \\left(\\frac{1}{2\\gamma}\\right) = \\frac{1}{2}$。\n将这些值代入 $R_{\\mathrm{lim}}(z_E)$ 的表达式中：\n$$\nR_{\\mathrm{lim}}(z_E) = 1 + z_E(1) + z_E^2 \\left(\\frac{1}{2}\\right) = 1 + z_E + \\frac{1}{2}z_E^2\n$$\n该表达式是标准二阶显式龙格-库塔方法的稳定函数。", "answer": "$$\\boxed{1 + z_{E} + \\frac{1}{2}z_{E}^{2}}$$", "id": "3391641"}]}