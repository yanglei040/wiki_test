{"hands_on_practices": [{"introduction": "在谱方法和间断Galerkin (Discontinuous Galerkin, DG) 方法中，高精度数值求积是保证算法达到设计精度的基石。本练习旨在通过一个基础但至关重要的任务来巩固您对求积法则“精确度”概念的理解。您将通过直接计算来验证一个为三角形设计的Dunavant求积法则，将其应用于一个简单单项式的积分，并与解析计算得到的精确值进行比较 [@problem_id:3406319]。", "problem": "在高阶谱元和间断Galerkin (DG) 方法中，单纯形上的数值求积法则必须能精确再现低次多项式的体积和面积分，以保证设计阶精度。考虑参考三角形 $\\mathcal{T}$，其顶点为 $(0,0)$、$(1,0)$ 和 $(0,1)$，即 $\\mathcal{T}=\\{(x,y)\\in\\mathbb{R}^{2}: x\\ge 0,\\ y\\ge 0,\\ x+y\\le 1\\}$。从二维积分作为 $\\mathcal{T}$ 上累次积分的基本定义出发，计算单项式 $x^{i}y^{j}$ 在 $i=1$ 和 $j=1$ 时的积分精确值，即\n$$\nI=\\int_{\\mathcal{T}} x^{1}y^{1}\\,\\mathrm{d}x\\,\\mathrm{d}y.\n$$\n然后，使用以下 Dunavant 三角形求积法则来验证此精确值，该法则是为对所有总次数最高为 $2$ 的多项式精确而设计的。该法则使用 $N_{q}=3$ 个对称点，其重心坐标 $(\\lambda_{1},\\lambda_{2},\\lambda_{3})$ 由集合\n$$\n\\{( \\tfrac{2}{3},\\tfrac{1}{6},\\tfrac{1}{6}),\\ (\\tfrac{1}{6},\\tfrac{2}{3},\\tfrac{1}{6}),\\ (\\tfrac{1}{6},\\tfrac{1}{6},\\tfrac{2}{3})\\},\n$$\n给出，每个点在 $\\mathcal{T}$ 上的权重为 $w=\\tfrac{1}{6}$。使用从相对于顶点 $(0,0)$、$(1,0)$、$(0,1)$ 的重心坐标到笛卡尔坐标的标准映射，即 $x=\\lambda_{2}$ 和 $y=\\lambda_{3}$，来计算求积近似值\n$$\nQ=\\sum_{q=1}^{N_{q}} w\\, x_{q}^{1} y_{q}^{1}.\n$$\n确认 $Q=I$，从而验证该求积法则对此单项式的精确阶。将 $I$ 的精确值作为最终答案。无需四舍五入，不涉及单位。您的最终答案必须是单个数字。", "solution": "该问题需要进行两部分计算。首先，我们必须求出积分 $I=\\int_{\\mathcal{T}} x^{1}y^{1}\\,\\mathrm{d}x\\,\\mathrm{d}y$ 在参考三角形 $\\mathcal{T}$ 上的精确解析值。其次，我们必须使用指定的3点 Dunavant 求积法则计算该积分的数值近似值 $Q$，并验证 $Q=I$。最终答案是 $I$ 的精确值。\n\n参考三角形 $\\mathcal{T}$ 由其顶点 $(0,0)$、$(1,0)$ 和 $(0,1)$ 定义。这个笛卡尔平面中的区域对应于满足不等式 $x \\ge 0$、$y \\ge 0$ 和 $x+y \\le 1$ 的点集 $(x,y)$。\n\n首先，我们通过将积分 $I$ 表示为累次积分来计算其精确值。我们选择先对 $y$ 积分，然后对 $x$ 积分。$x$ 的积分限是从 $0$ 到 $1$。对于此区间内的一个固定值 $x$，$y$ 的范围是从 $0$ 到 $1-x$。\n$$\nI = \\int_{\\mathcal{T}} xy \\,\\mathrm{d}x\\,\\mathrm{d}y = \\int_{x=0}^{x=1} \\left( \\int_{y=0}^{y=1-x} xy \\,\\mathrm{d}y \\right) \\mathrm{d}x\n$$\n我们计算关于 $y$ 的内层积分：\n$$\n\\int_{0}^{1-x} xy \\,\\mathrm{d}y = x \\left[ \\frac{y^2}{2} \\right]_{0}^{1-x} = x \\left( \\frac{(1-x)^2}{2} - \\frac{0^2}{2} \\right) = \\frac{x(1-x)^2}{2}\n$$\n接下来，我们将此结果代入外层积分并对 $x$ 积分：\n$$\nI = \\int_{0}^{1} \\frac{x(1-x)^2}{2} \\,\\mathrm{d}x\n$$\n我们展开被积函数以便于积分：\n$$\nI = \\frac{1}{2} \\int_{0}^{1} x(1 - 2x + x^2) \\,\\mathrm{d}x = \\frac{1}{2} \\int_{0}^{1} (x - 2x^2 + x^3) \\,\\mathrm{d}x\n$$\n逐项进行积分：\n$$\nI = \\frac{1}{2} \\left[ \\frac{x^2}{2} - \\frac{2x^3}{3} + \\frac{x^4}{4} \\right]_{0}^{1}\n$$\n计算所得多项式在积分限处的值：\n$$\nI = \\frac{1}{2} \\left( \\left( \\frac{1^2}{2} - \\frac{2(1)^3}{3} + \\frac{1^4}{4} \\right) - (0) \\right) = \\frac{1}{2} \\left( \\frac{1}{2} - \\frac{2}{3} + \\frac{1}{4} \\right)\n$$\n为化简括号内的表达式，我们找到公分母 $12$：\n$$\nI = \\frac{1}{2} \\left( \\frac{6}{12} - \\frac{8}{12} + \\frac{3}{12} \\right) = \\frac{1}{2} \\left( \\frac{6 - 8 + 3}{12} \\right) = \\frac{1}{2} \\left( \\frac{1}{12} \\right) = \\frac{1}{24}\n$$\n积分的精确值为 $I = \\frac{1}{24}$。\n\n其次，我们使用指定的 Dunavant 求积法则来验证这个结果。该法则将积分近似为一个加权和：\n$$\nQ = \\sum_{q=1}^{N_{q}} w\\, x_{q}^{1} y_{q}^{1}\n$$\n其中点的数量为 $N_q=3$，每个点的权重为 $w=\\frac{1}{6}$。求积点以重心坐标 $(\\lambda_1, \\lambda_2, \\lambda_3)$ 给出，必须使用提供的映射 $x=\\lambda_2$ 和 $y=\\lambda_3$ 将其转换为笛卡尔坐标 $(x_q, y_q)$。\n\n三个求积点如下：\n1.  $(\\lambda_1, \\lambda_2, \\lambda_3) = (\\frac{2}{3}, \\frac{1}{6}, \\frac{1}{6})$。这映射到 $(x_1, y_1) = (\\frac{1}{6}, \\frac{1}{6})$。\n2.  $(\\lambda_1, \\lambda_2, \\lambda_3) = (\\frac{1}{6}, \\frac{2}{3}, \\frac{1}{6})$。这映射到 $(x_2, y_2) = (\\frac{2}{3}, \\frac{1}{6})$。\n3.  $(\\lambda_1, \\lambda_2, \\lambda_3) = (\\frac{1}{6}, \\frac{1}{6}, \\frac{2}{3})$。这映射到 $(x_3, y_3) = (\\frac{1}{6}, \\frac{2}{3})$。\n\n然后我们计算被积函数 $f(x,y)=xy$ 在每个笛卡尔坐标点上的值：\n-   $f(x_1, y_1) = x_1 y_1 = (\\frac{1}{6})(\\frac{1}{6}) = \\frac{1}{36}$\n-   $f(x_2, y_2) = x_2 y_2 = (\\frac{2}{3})(\\frac{1}{6}) = \\frac{2}{18} = \\frac{1}{9}$\n-   $f(x_3, y_3) = x_3 y_3 = (\\frac{1}{6})(\\frac{2}{3}) = \\frac{2}{18} = \\frac{1}{9}$\n\n现在我们计算求积和 $Q$：\n$$\nQ = w f(x_1, y_1) + w f(x_2, y_2) + w f(x_3, y_3) = \\frac{1}{6} \\left( \\frac{1}{36} \\right) + \\frac{1}{6} \\left( \\frac{1}{9} \\right) + \\frac{1}{6} \\left( \\frac{1}{9} \\right)\n$$\n$$\nQ = \\frac{1}{6} \\left( \\frac{1}{36} + \\frac{1}{9} + \\frac{1}{9} \\right)\n$$\n对括号内的项使用公分母 $36$：\n$$\nQ = \\frac{1}{6} \\left( \\frac{1}{36} + \\frac{4}{36} + \\frac{4}{36} \\right) = \\frac{1}{6} \\left( \\frac{1+4+4}{36} \\right) = \\frac{1}{6} \\left( \\frac{9}{36} \\right) = \\frac{1}{6} \\left( \\frac{1}{4} \\right) = \\frac{1}{24}\n$$\n由求积法则计算出的值为 $Q = \\frac{1}{24}$。\n\n将精确积分值 $I=\\frac{1}{24}$ 与求积近似值 $Q=\\frac{1}{24}$ 进行比较，我们发现它们是相同的。这证实了给定的求积法则对于总次数为 $1+1=2$ 的单项式 $x^1y^1$ 是精确的，正如问题前提所述。所要求的最终答案是 $I$ 的精确值。", "answer": "$$\n\\boxed{\\frac{1}{24}}\n$$", "id": "3406319"}, {"introduction": "在构建数值方法时，我们不仅需要验证求积法则的正确性，还需要根据任务需求选择最高效的法则。本练习将探讨一维区间上两种最核心的求积方法：Gauss-Legendre (GL) 求积和Gauss-Lobatto-Legendre (GLL) 求积。您将从理论上推导并比较这两种方法为达到同一目标积分精度所需的最小节点数，从而揭示它们在效率和节点布局上的关键差异 [@problem_id:3406258]。", "problem": "考虑一个一维参考单元，其定义域为 $[-1,1]$，权重函数为 $w(x)=1$。在谱元法和间断 Galerkin (DG) 方法中，多项式试验空间和测试空间上的体积积分和面积分是通过数值求积来计算的。在 $[-1,1]$ 上两种广泛使用的求积法则是：使用 $N$ 个内部节点的高斯-勒让德 (GL) 求积法，以及使用包括端点 $x=-1$ 和 $x=1$ 在内的 $N$ 个节点的高斯-洛巴托-勒让德 (GLL) 求积法。一个求积法则的精度阶是指该法则能够精确积分所有次数 $\\deg(p)\\le r$ 的多项式 $p(x)$ 的最大整数 $r$。\n\n从正交多项式的基本性质、其相关的高斯求积法以及多项式求积的经典误差表示出发，确定所需的最少节点数 $N$（作为目标多项式次数 $D\\in\\mathbb{N}$ 的函数），使得：\n- 具有 $N$ 个节点的 GL 求积法能够精确积分所有次数 $\\deg(p)\\le D$ 的多项式 $p(x)$，以及\n- 具有 $N$ 个节点的 GLL 求积法能够精确积分所有次数 $\\deg(p)\\le D$ 的多项式 $p(x)$。\n\n然后，对这些最小节点数进行解析比较。将你的最终答案表示为一个行矩阵，其元素依次为 GL 求积法的最小节点数 $N$、GLL 求积法的最小节点数 $N$ 以及这两个最小节点数之差。不需要进行数值舍入，也不涉及物理单位。最终答案必须是单一的封闭形式解析表达式。", "solution": "目标是确定高斯-勒让德 (GL) 求积法和高斯-洛巴托-勒让德 (GLL) 求积法在区间 $[-1, 1]$ 上（权重函数 $w(x)=1$）精确积分任何次数至多为 $D$（其中 $D \\in \\mathbb{N}$）的多项式 $p(x)$ 所需的最小节点数 $N$。一个求积法则的精度阶是该法则对所有次数小于或等于 $r$ 的多项式都能精确积分的最大整数 $r$。问题要求找到使精度阶至少为 $D$ 的最小 $N$。\n\n设函数 $f(x)$ 的积分为 $I(f) = \\int_{-1}^{1} f(x) \\, \\mathrm{d}x$。一个 $N$ 点求积法则将其近似为 $Q_N(f) = \\sum_{i=1}^{N} w_i f(x_i)$，其中 $\\{x_i\\}$ 是节点，$\\{w_i\\}$ 是权重。\n\n**高斯-勒让德 (GL) 求积**\n\nGL 求积法则是区间 $[-1, 1]$ 上权重函数为 $w(x)=1$ 的标准高斯求积法。相关的正交多项式是勒让德多项式 $P_n(x)$，当 $m \\neq n$ 时，它们满足正交条件 $\\int_{-1}^{1} P_m(x) P_n(x) \\, \\mathrm{d}x = 0$。\n\n一个 $N$ 点 GL 求积法则是使用勒让德多项式 $P_N(x)$ 的 $N$ 个根作为节点 $\\{x_i\\}_{i=1}^N$ 来构造的。高斯求积的一个基本定理指出，这样的法则具有 $2N-1$ 的精度阶。我们可以如下证明。\n\n设 $p(x)$ 是任意次数至多为 $2N-1$ 的多项式。我们可以用 $N$ 次勒让德多项式 $P_N(x)$ 对 $p(x)$ 进行多项式除法：\n$$p(x) = q(x) P_N(x) + r(x)$$\n其中 $q(x)$ 是商，$r(x)$ 是余数。这些多项式的次数满足 $\\deg(q) \\le (2N-1) - N = N-1$ 和 $\\deg(r) \\le N-1$。\n\n$p(x)$ 的精确积分为：\n$$I(p) = \\int_{-1}^{1} p(x) \\, \\mathrm{d}x = \\int_{-1}^{1} \\left( q(x) P_N(x) + r(x) \\right) \\, \\mathrm{d}x = \\int_{-1}^{1} q(x) P_N(x) \\, \\mathrm{d}x + \\int_{-1}^{1} r(x) \\, \\mathrm{d}x$$\n由于 $\\deg(q) \\le N-1$，$q(x)$ 可以表示为勒让德多项式 $P_0(x), \\dots, P_{N-1}(x)$ 的线性组合。根据正交性，$P_N(x)$ 与所有次数小于 $N$ 的多项式正交。因此，第一个积分项为零：\n$$\\int_{-1}^{1} q(x) P_N(x) \\, \\mathrm{d}x = 0$$\n这使得我们得到 $I(p) = \\int_{-1}^{1} r(x) \\, \\mathrm{d}x = I(r)$。\n\n现在，我们计算 $p(x)$ 的求积和：\n$$Q_N(p) = \\sum_{i=1}^{N} w_i p(x_i)$$\n求积节点 $x_i$ 是 $P_N(x)$ 的根，因此对于所有 $i=1, \\dots, N$都有 $P_N(x_i) = 0$。在这些节点上计算 $p(x)$ 得到：\n$$p(x_i) = q(x_i) P_N(x_i) + r(x_i) = q(x_i) \\cdot 0 + r(x_i) = r(x_i)$$\n因此，求积和变为：\n$$Q_N(p) = \\sum_{i=1}^{N} w_i r(x_i) = Q_N(r)$$\n一个具有 $N$ 个节点的高斯求积法则被构造成对所有次数不超过 $N-1$ 的多项式都是精确的。由于 $\\deg(r) \\le N-1$，我们有 $Q_N(r) = I(r)$。\n结合这些结果，我们得到 $I(p) = I(r) = Q_N(r) = Q_N(p)$，这表明该法则对任何次数 $\\deg(p) \\le 2N-1$ 的多项式 $p(x)$ 都是精确的。这个精度阶是最高的。\n\n为使 GL 法则能精确积分所有次数 $\\deg(p) \\le D$ 的多项式 $p(x)$，其精度阶必须至少为 $D$。\n$$2N_{GL} - 1 \\ge D$$\n求解 $N_{GL}$，我们发现：\n$$N_{GL} \\ge \\frac{D+1}{2}$$\n由于 $N_{GL}$ 必须是整数，我们取满足此不等式的最小整数，这由向上取整函数给出：\n$$N_{GL} = \\left\\lceil \\frac{D+1}{2} \\right\\rceil$$\n\n**高斯-洛巴托-勒让德 (GLL) 求积**\n\nGLL 求积法则是高斯求积法的一种变体，其中区间的端点 $x=-1$ 和 $x=1$被预先指定为节点。对于一个 $N$ 点法则，两个节点是固定的（$x_1=-1$，$x_N=1$），其余 $N-2$ 个内部节点被选择以最大化精度阶。可以证明，这 $N-2$ 个内部节点是 $(N-1)$ 次勒让德多项式的一阶导数 $P'_{N-1}(x)$ 的根。\n\n一个 $N$ 点 GLL 法则的精度阶是 $2N-3$。我们来证明这一点。\n设 $p(x)$ 是一个次数至多为 $2N-3$ 的多项式。$N$ 个 GLL 节点是多项式 $\\omega(x) = (x^2-1)P'_{N-1}(x)$ 的根，该多项式的次数为 $N$。我们将 $p(x)$ 除以 $\\omega(x)$：\n$$p(x) = q(x) (x^2-1)P'_{N-1}(x) + r(x)$$\n其中 $\\deg(q) \\le (2N-3) - N = N-3$ 且 $\\deg(r) \\le N-1$。\n\n精确积分为 $I(p) = \\int_{-1}^{1} q(x)(x^2-1)P'_{N-1}(x) \\, \\mathrm{d}x + \\int_{-1}^{1} r(x) \\, \\mathrm{d}x$。\n对第一项使用分部积分法：\n$$\\int_{-1}^{1} q(x)(x^2-1)P'_{N-1}(x) \\, \\mathrm{d}x = \\left[ q(x)(x^2-1)P_{N-1}(x) \\right]_{-1}^{1} - \\int_{-1}^{1} \\frac{d}{dx}\\left(q(x)(x^2-1)\\right) P_{N-1}(x) \\, \\mathrm{d}x$$\n边界项为零，因为 $(x^2-1)$ 在 $x=\\pm 1$ 处为零。导数 $\\frac{d}{dx}(q(x)(x^2-1))$ 的结果是一个次数至多为 $(N-3)+2-1 = N-2$ 的多项式。根据正交性，这个多项式乘以 $P_{N-1}(x)$ 的积分是零。因此，第一个积分项消失，并且 $I(p) = I(r)$。\n\n求积和为 $Q_N(p) = \\sum_{i=1}^{N} w_i p(x_i)$。由于 GLL 节点 $x_i$ 是 $(x^2-1)P'_{N-1}(x)$ 的根，我们在每个节点上都有 $p(x_i) = r(x_i)$。因此，$Q_N(p) = Q_N(r)$。\nGLL 法则被构造成对次数不超过 $N-1$ 的多项式是精确的。由于 $\\deg(r) \\le N-1$，我们有 $Q_N(r) = I(r)$。\n因此，$I(p) = I(r) = Q_N(r) = Q_N(p)$，该法则对所有次数不超过 $2N-3$ 的多项式都是精确的。\n\n为使 GLL 法则能精确积分所有次数 $\\deg(p) \\le D$ 的多项式 $p(x)$，其精度阶必须至少为 $D$。\n$$2N_{GLL} - 3 \\ge D$$\n求解 $N_{GLL}$：\n$$2N_{GLL} \\ge D+3 \\implies N_{GLL} \\ge \\frac{D+3}{2}$$\n最小整数 $N_{GLL}$ 为：\n$$N_{GLL} = \\left\\lceil \\frac{D+3}{2} \\right\\rceil$$\n\n**比较**\n\n我们现在比较最小节点数 $N_{GL}$ 和 $N_{GLL}$。\n$$N_{GL} = \\left\\lceil \\frac{D+1}{2} \\right\\rceil$$\n$$N_{GLL} = \\left\\lceil \\frac{D+3}{2} \\right\\rceil = \\left\\lceil \\frac{D+1}{2} + \\frac{2}{2} \\right\\rceil = \\left\\lceil \\frac{D+1}{2} + 1 \\right\\rceil$$\n使用向上取整函数的性质 $\\lceil z+k \\rceil = \\lceil z \\rceil + k$（对于任意整数 $k$），我们得到：\n$$N_{GLL} = \\left\\lceil \\frac{D+1}{2} \\right\\rceil + 1 = N_{GL} + 1$$\n最小节点数之差为：\n$$N_{GLL} - N_{GL} = 1$$\n这表明，对于给定的所需精度阶 $D$，GLL 求积法比 GL 求积法恰好多需要一个节点。这是强制将端点包含在节点集中的权衡。\n\n最终答案要求一个行矩阵，其元素为 $N_{GL}$、$N_{GLL}$ 和 $N_{GLL} - N_{GL}$。它们是：\n1. $N_{GL} = \\left\\lceil \\frac{D+1}{2} \\right\\rceil$\n2. $N_{GLL} = \\left\\lceil \\frac{D+3}{2} \\right\\rceil$\n3. $N_{GLL} - N_{GL} = 1$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\left\\lceil \\frac{D+1}{2} \\right\\rceil & \\left\\lceil \\frac{D+3}{2} \\right\\rceil & 1\n\\end{pmatrix}\n}\n$$", "id": "3406258"}, {"introduction": "如果我们选择的求积法则精度不足，会产生什么后果？本练习通过一个具体的例子来揭示数值积分中的一个核心陷阱：混淆（aliasing）效应。您将使用一个精度恰好不足的求积法则来计算一个高阶多项式在低阶多项式空间上的$L^2$投影，并量化由此产生的误差 [@problem_id:3406257]。这个实践将清晰地展示，不精确的积分如何导致高频信息被错误地表示为低频分量，从而强调了为保证数值稳定性与准确性而必须采用充分精确的求积法则的重要性。", "problem": "考虑一维参考单元 $[-1,1]$，其上定义了标准的 $L^2$ 内积 $\\langle u, v \\rangle = \\int_{-1}^{1} u(x)\\,v(x)\\,\\mathrm{d}x$。令 $\\{P_{n}(x)\\}_{n\\geq 0}$ 表示区间 $[-1,1]$ 上的 Legendre 多项式，它们关于内积 $\\langle \\cdot, \\cdot \\rangle$ 正交，且其精确范数为 $\\|P_{n}\\|_{L^{2}(-1,1)}^{2} = \\int_{-1}^{1} P_{n}(x)^{2}\\,\\mathrm{d}x = \\frac{2}{2n+1}$。在多项式谱方法和间断 Galerkin 方法中，一个函数 $f$ 到 $p$ 次多项式空间上的 $L^2$ 投影由系数 $c_{k}$ 定义，这些系数满足 $\\langle f - \\sum_{k=0}^{p} c_{k} P_{k}, P_{j} \\rangle = 0$ 对所有 $j=0,\\dots,p$ 成立。\n\n假设内积由一个多项式精度为 $2p-1$ 的求积法则近似，具体而言是 $[-1,1]$ 上的 $(p+1)$ 点 Gauss–Lobatto–Legendre (GLL) 求积，该求积对次数至多为 $2p-1$ 的被积函数是精确的。为了演示将一个 $2p$ 次多项式投影到 $p$ 次空间时出现的混淆现象，构建并分析以下具体示例：\n\n- 取 $p=2$ 且 $f(x) = P_{4}(x)$。\n- 使用 3 点 GLL 求积节点和权重：$x_{1}=-1$，$x_{2}=0$，$x_{3}=1$，权重为 $w_{1}=\\frac{1}{3}$，$w_{2}=\\frac{4}{3}$，$w_{3}=\\frac{1}{3}$。\n\n通过离散法向方程\n$$\n\\sum_{m=0}^{2} \\left(\\sum_{i=1}^{3} w_{i}\\,P_{m}(x_{i})\\,P_{j}(x_{i})\\right) c_{m} \\;=\\; \\sum_{i=1}^{3} w_{i}\\,f(x_{i})\\,P_{j}(x_{i}), \\quad j=0,1,2,\n$$\n计算基于求积的投影系数 $c_{0}$、$c_{1}$ 和 $c_{2}$，从而得到基于求积的投影 $u_{Q}(x)=\\sum_{k=0}^{2} c_{k} P_{k}(x)$。证明混淆现象的发生（即 $u_{Q}(x)\\not\\equiv 0$），尽管 $f(x)=P_{4}(x)$ 到 2 次多项式空间上的精确 $L^2$ 投影是零多项式。最后，通过报告由混淆引起的误差的 $L^2([-1,1])$ 范数的精确值 $\\|u_{Q}-0\\|_{L^{2}(-1,1)}$ 来量化所产生的投影误差。你的最终答案必须是一个无单位的闭式解析表达式。", "solution": "所述问题具有科学依据，是自洽且适定的。它提出了谱方法数值分析中的一个标准练习，具体演示了因使用不精确求积进行投影而产生的混淆概念。所有必要的数据，包括要投影的函数、基多项式、近似次数以及特定的求积法则（节点和权重），均已提供。该问题在数学上是合理的，其解可通过直接计算来验证。因此，该问题是有效的，下面将给出解答。\n\n该问题要求计算函数 $f(x) = P_4(x)$ 在区间 $[-1,1]$ 上到次数至多为 $p=2$ 的多项式空间上的基于求积的 $L^2$ 投影。该投影我们记为 $u_Q(x)$，它是空间 $\\mathbb{P}_2 = \\mathrm{span}\\{P_0(x), P_1(x), P_2(x)\\}$ 中的一个元素，可以写为 $u_Q(x) = \\sum_{k=0}^{2} c_k P_k(x)$。\n\n系数 $c_k$ 是通过使用指定的求积法则近似 Galerkin 正交条件中的内积来确定的。真实 $L^2$ 投影的精确正交条件是 $\\langle f - \\sum_{k=0}^{2} c_k P_k, P_j \\rangle = 0$ 对 $j=0,1,2$ 成立。用求积法则诱导的离散内积 $\\langle u, v \\rangle_Q = \\sum_{i=1}^{3} w_i u(x_i)v(x_i)$ 替换精确内积 $\\langle u, v \\rangle = \\int_{-1}^{1} u(x)v(x)\\,\\mathrm{d}x$，我们得到问题陈述中提供的线性方程组：\n$$ \\sum_{m=0}^{2} \\langle P_m, P_j \\rangle_Q c_m = \\langle f, P_j \\rangle_Q, \\quad j=0,1,2 $$\n这可以写成矩阵系统 $M_Q \\mathbf{c} = \\mathbf{f}_Q$，其中 $(M_Q)_{jm} = \\langle P_m, P_j \\rangle_Q$，$\\mathbf{c} = (c_0, c_1, c_2)^\\mathsf{T}$ 且 $(\\mathbf{f}_Q)_j = \\langle f, P_j \\rangle_Q$。\n\n问题指定了 $p=2$ 并使用 3 点 Gauss-Lobatto-Legendre (GLL) 求积，节点为 $x_1=-1$，$x_2=0$，$x_3=1$，权重为 $w_1=1/3$，$w_2=4/3$，$w_3=1/3$。该求积法则对次数至多为 $2p-1=2(2)-1=3$ 的多项式是精确的。\n\n首先，我们需要相关 Legendre 多项式在求积节点处的值。前几个 Legendre 多项式是：\n$P_0(x) = 1$\n$P_1(x) = x$\n$P_2(x) = \\frac{1}{2}(3x^2 - 1)$\n$P_4(x) = \\frac{1}{8}(35x^4 - 30x^2 + 3)$\n\n在节点 $x \\in \\{-1, 0, 1\\}$ 处计算这些多项式的值：\n$P_0(-1)=1, P_0(0)=1, P_0(1)=1$\n$P_1(-1)=-1, P_1(0)=0, P_1(1)=1$\n$P_2(-1)=1, P_2(0)=-\\frac{1}{2}, P_2(1)=1$\n$P_4(-1)=1, P_4(0)=\\frac{3}{8}, P_4(1)=1$\n\n接下来，我们计算离散质量矩阵 $M_Q$ 的元素。对于 $j,m \\in \\{0,1,2\\}$：\n$(M_Q)_{jm} = \\langle P_m, P_j \\rangle_Q = \\sum_{i=1}^{3} w_i P_j(x_i) P_m(x_i)$。\n由于被积函数 $P_j(x)P_m(x)$ 的次数最高为 $2+2=4$，而求积的精度只到 3 次，我们不期望离散质量矩阵与单位矩阵成比例，如果它等于精确的（对角）质量矩阵，情况会是这样。然而，由于 GLL 节点和权重的对称性，以及 Legendre 偶/奇多项式的性质，非对角项为零：\n$\\langle P_0, P_1 \\rangle_Q = \\frac{1}{3}(1)(-1) + \\frac{4}{3}(1)(0) + \\frac{1}{3}(1)(1) = 0$ (精确，次数=1)\n$\\langle P_0, P_2 \\rangle_Q = \\frac{1}{3}(1)(1) + \\frac{4}{3}(1)(-\\frac{1}{2}) + \\frac{1}{3}(1)(1) = \\frac{2}{3} - \\frac{2}{3} = 0$ (精确，次数=2)\n$\\langle P_1, P_2 \\rangle_Q = \\frac{1}{3}(-1)(1) + \\frac{4}{3}(0)(-\\frac{1}{2}) + \\frac{1}{3}(1)(1) = 0$ (精确，次数=3)\n对角元素为：\n$\\langle P_0, P_0 \\rangle_Q = \\sum_{i=1}^{3} w_i (1)^2 = \\frac{1}{3} + \\frac{4}{3} + \\frac{1}{3} = 2$。这是精确的：$\\|P_0\\|^2=2$。\n$\\langle P_1, P_1 \\rangle_Q = \\frac{1}{3}(-1)^2 + \\frac{4}{3}(0)^2 + \\frac{1}{3}(1)^2 = \\frac{2}{3}$。这是精确的：$\\|P_1\\|^2=2/3$。\n$\\langle P_2, P_2 \\rangle_Q = \\frac{1}{3}(1)^2 + \\frac{4}{3}(-\\frac{1}{2})^2 + \\frac{1}{3}(1)^2 = \\frac{1}{3} + \\frac{4}{3}(\\frac{1}{4}) + \\frac{1}{3} = 1$。这不精确：$\\|P_2\\|^2=2/5$。\n离散质量矩阵是对角的：\n$$ M_Q = \\begin{pmatrix} 2  0  0 \\\\ 0  2/3  0 \\\\ 0  0  1 \\end{pmatrix} $$\n现在，我们计算右端向量 $\\mathbf{f}_Q$，其中 $f(x)=P_4(x)$：\n$(\\mathbf{f}_Q)_j = \\langle P_4, P_j \\rangle_Q = \\sum_{i=1}^{3} w_i P_4(x_i) P_j(x_i)$。\n对于 $j=0$：$\\langle P_4, P_0 \\rangle_Q = \\frac{1}{3}(1)(1) + \\frac{4}{3}(\\frac{3}{8})(1) + \\frac{1}{3}(1)(1) = \\frac{1}{3} + \\frac{1}{2} + \\frac{1}{3} = \\frac{7}{6}$。\n对于 $j=1$：$\\langle P_4, P_1 \\rangle_Q = \\frac{1}{3}(1)(-1) + \\frac{4}{3}(\\frac{3}{8})(0) + \\frac{1}{3}(1)(1) = 0$。\n对于 $j=2$：$\\langle P_4, P_2 \\rangle_Q = \\frac{1}{3}(1)(1) + \\frac43(\\frac{3}{8})(-\\frac{1}{2}) + \\frac{1}{3}(1)(1) = \\frac{2}{3} - \\frac{1}{4} = \\frac{5}{12}$。\n\n系统 $M_Q \\mathbf{c} = \\mathbf{f}_Q$ 为：\n$$ \\begin{pmatrix} 2  0  0 \\\\ 0  2/3  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} c_0 \\\\ c_1 \\\\ c_2 \\end{pmatrix} = \\begin{pmatrix} 7/6 \\\\ 0 \\\\ 5/12 \\end{pmatrix} $$\n求解系数：\n$c_0 = \\frac{7/6}{2} = \\frac{7}{12}$\n$c_1 = \\frac{0}{2/3} = 0$\n$c_2 = \\frac{5/12}{1} = \\frac{5}{12}$\n\n基于求积的投影是 $u_Q(x) = \\frac{7}{12}P_0(x) + 0 \\cdot P_1(x) + \\frac{5}{12}P_2(x)$。\n函数 $f(x) = P_4(x)$ 到空间 $\\mathbb{P}_2$ 上的精确 $L^2$ 投影是零多项式，因为根据 Legendre 多项式的正交性，对于 $j=0,1,2$ 有 $\\langle P_4, P_j \\rangle = 0$。然而，计算出的投影 $u_Q(x)$ 不是零多项式，因为系数 $c_0$ 和 $c_2$ 非零。这种差异就是混淆误差，它是由求积法则无法精确积分乘积 $P_4(x)P_j(x)$（其次数高达 $4+2=6$）所引起的。高频分量 $P_4(x)$ 被“混淆”到了低频空间 $\\mathbb{P}_2$ 中。在求积点上，$u_Q(x_i)$ 等于 $P_4(x_i)$，所以误差对于求积法则是不可见的。\n\n问题要求计算由混淆引起的误差的 $L^2$ 范数。误差是计算出的投影与精确投影之差，即 $u_Q(x) - 0 = u_Q(x)$。我们需要计算 $\\|u_Q\\|_{L^2(-1,1)}$。\n利用 Legendre 多项式在精确内积下的正交性：\n$$ \\|u_Q\\|^2 = \\left\\langle \\frac{7}{12}P_0 + \\frac{5}{12}P_2, \\frac{7}{12}P_0 + \\frac{5}{12}P_2 \\right\\rangle $$\n$$ \\|u_Q\\|^2 = \\left(\\frac{7}{12}\\right)^2 \\langle P_0, P_0 \\rangle + \\left(\\frac{5}{12}\\right)^2 \\langle P_2, P_2 \\rangle $$\n使用已知的范数 $\\|P_n\\|^2 = \\frac{2}{2n+1}$：\n$\\|P_0\\|^2 = \\frac{2}{2(0)+1} = 2$\n$\\|P_2\\|^2 = \\frac{2}{2(2)+1} = \\frac{2}{5}$\n代入这些值：\n$$ \\|u_Q\\|^2 = \\left(\\frac{49}{144}\\right)(2) + \\left(\\frac{25}{144}\\right)\\left(\\frac{2}{5}\\right) = \\frac{98}{144} + \\frac{50}{144 \\cdot 5} = \\frac{98}{144} + \\frac{10}{144} = \\frac{108}{144} $$\n化简该分数：\n$$ \\|u_Q\\|^2 = \\frac{108}{144} = \\frac{9 \\times 12}{12 \\times 12} = \\frac{9}{12} = \\frac{3}{4} $$\n混淆误差的 $L^2$ 范数是该值的平方根：\n$$ \\|u_Q - 0\\|_{L^2(-1,1)} = \\|u_Q\\| = \\sqrt{\\frac{3}{4}} = \\frac{\\sqrt{3}}{2} $$\n这就是由混淆引起的投影误差的最终度量。", "answer": "$$\\boxed{\\frac{\\sqrt{3}}{2}}$$", "id": "3406257"}]}