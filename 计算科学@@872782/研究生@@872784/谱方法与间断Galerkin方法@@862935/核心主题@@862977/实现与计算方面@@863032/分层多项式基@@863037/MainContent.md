## 引言
在[高阶数值方法](@entry_id:142601)（如谱方法和[间断Galerkin方法](@entry_id:748369)）的领域中，选择合适的[函数空间](@entry_id:143478)基底是决定算法效率与准确性的核心环节。传统的[节点基](@entry_id:752522)（如[拉格朗日多项式](@entry_id:142463)）虽然直观，但在需要动态调整逼近阶数（即$p$-自适应）时，其结构往往导致复杂的计算转换。这一局限性促使研究者们寻求一种更灵活、结构更优的替代方案，而**分层多项式基 (hierarchical polynomial bases)** 正是这一探索的关键成果。

本文旨在系统地介绍分层多项式基的理论与实践。我们将深入探讨这种基底为何能在自适应计算、求解器效率和复杂物理建模中展现出卓越的性能。通过本文的学习，读者将能够：

*   在第一章“**原理与机制**”中，掌握分层基的严格定义、构造方法（包括基于[正交多项式](@entry_id:146918)和基于边界条件的策略），并理解其如何通过[静态凝聚](@entry_id:176722)等机制优化离散系统。
*   在第二章“**应用与跨学科联系**”中，探索这些理论在实际问题中的应用，包括它们如何驱动$hp$-[自适应算法](@entry_id:142170)，用于[计算流体力学](@entry_id:747620)中的激波捕捉，以及在[不确定性量化](@entry_id:138597)等前沿交叉领域中发挥作用。
*   在第三章“**动手实践**”中，通过具体的编程练习，将理论知识转化为解决实际数值问题的能力。

现在，让我们从分层多项式基最基本的概念出发，深入剖析其构建原理和内在机制。

## 原理与机制

在谱方法和间断 Galerkin (DG) 方法的高阶逼近理论中，选择合适的[基函数](@entry_id:170178)是构建高效、准确数值方案的核心。与在固定的节点集上定义的传统[节点基](@entry_id:752522)（如[拉格朗日多项式](@entry_id:142463)）不同，**分层多项式基 (hierarchical polynomial bases)** 提供了一种替代方案，它具有独特的结构优势，特别是在自适应计算和求解效率方面。本章将深入探讨分层基的定义、[构造原理](@entry_id:141667)及其在离散系统中所表现出的关键机制。

### 分层基的定义与基本性质

从根本上说，一个多项式基是分层的，如果它能够以一种嵌套的方式构建[多项式空间](@entry_id:144410)。更确切地说，对于一维参考区间（例如 $[-1, 1]$）上的一系列多项式空间 $\mathbb{P}_0 \subset \mathbb{P}_1 \subset \cdots \subset \mathbb{P}_N$，其中 $\mathbb{P}_k$ 表示所有次数不超过 $k$ 的实多项式集合，一个有序的**[模态基](@entry_id:752055) (modal basis)** $\{\phi_0, \phi_1, \ldots, \phi_N\}$ 被称为**分层基**，若它满足以下属性：
$$
\mathrm{span}\{\phi_0, \phi_1, \ldots, \phi_k\} = \mathbb{P}_k \quad \forall k \in \{0, 1, \ldots, N\}
$$
这个定义意味着，要获得 $k$ 次[多项式空间](@entry_id:144410) $\mathbb{P}_k$ 的一个基，我们只需取整个基中的前 $k+1$ 个函数。这要求每个[基函数](@entry_id:170178) $\phi_k$ 的[精确次数](@entry_id:175703)为 $k$。[@problem_id:3390225]

这一结构最直接和最重要的优势体现在 **$p$-自适应 ($p$-adaptivity)** 过程中，即在计算中提升[多项式逼近](@entry_id:137391)次数。假设我们有一个在 $\mathbb{P}_{N-1}$ 空间中的离散解 $u_h = \sum_{j=0}^{N-1} c_j \phi_j$。由于 $\mathbb{P}_{N-1}$ 是 $\mathbb{P}_{N}$ 的[子空间](@entry_id:150286)，函数 $u_h$ 本身也属于 $\mathbb{P}_{N}$。利用分层基的嵌套属性，我们可以立即写出 $u_h$ 在更高阶空间 $\mathbb{P}_N$ 的基 $\{\phi_j\}_{j=0}^N$ 中的表示：
$$
u_h = \sum_{j=0}^{N-1} c_j \phi_j + 0 \cdot \phi_N
$$
由于向量在给定基下的表示是唯一的，这意味着当我们将解从 $\mathbb{P}_{N-1}$ 嵌入到 $\mathbb{P}_{N}$ 时，其低阶[模态系数](@entry_id:752057) $\{c_0, \ldots, c_{N-1}\}$ 得以完全保留，而新的高阶系数则初始化为零。这个过程可以形式化地描述为：包含映射 $I: \mathbb{P}_{N-1} \to \mathbb{P}_{N}$ 在分层基下的坐标表示为 $(c_0, \ldots, c_{N-1}) \mapsto (c_0, \ldots, c_{N-1}, 0)$。[@problem_id:3390244] 这种系数保持特性是一个纯粹的[代数结构](@entry_id:137052)属性，它不要求基具有正交性等任何几何特性。

这种简便性与传统的**[节点基](@entry_id:752522) (nodal basis)** 形成鲜明对比，例如构建在 Gauss-Lobatto 点上的[拉格朗日多项式](@entry_id:142463)基。一个次数为 $N$ 的[拉格朗日基](@entry_id:751105)由 $N+1$ 个节点唯一确定，而一个次数为 $N-1$ 的基则由另一组 $N$ 个节点确定。由于 Gauss-Lobatto 节点集通常不是嵌套的（即次数为 $N-1$ 的节点集不是次数为 $N$ 的节点集的[子集](@entry_id:261956)），因此对应的[拉格朗日基](@entry_id:751105)函数也不是分层的。进行 $p$-自适应时，必须完全丢弃旧的基，并在新的节点集上构建一套全新的基，这需要通过插值或投影来转换自由度，过程更为复杂。[@problem_id:3390225]

### 一维分层基的构造

构造满足分层属性的基有多种策略，其中两种最为常见，它们分别侧重于正交性和边界条件。

#### 基于[正交多项式](@entry_id:146918)的[模态基](@entry_id:752055)

构造分层基最自然的方式是使用正交多项式族，因为它们天然满足次数递增的属性。在一维区间 $[-1, 1]$ 上，**勒让德多项式 (Legendre polynomials)** $\{P_n(x)\}_{n \ge 0}$ 是一个典型的选择。它们满足 $\deg(P_n) = n$，并且在标准的 $L^2$ [内积](@entry_id:158127)下是正交的：
$$
\int_{-1}^{1} P_m(x) P_n(x) \,dx = \frac{2}{2n+1} \delta_{mn}
$$
其中 $\delta_{mn}$ 是克罗内克符号。通过对[勒让德多项式](@entry_id:141510)进行归一化，我们可以得到一组 $L^2$-标准正交的分层[基函数](@entry_id:170178)：
$$
\phi_n(x) = \sqrt{n + \frac{1}{2}} P_n(x)
$$
使得 $\int_{-1}^1 \phi_m(x) \phi_n(x) \,dx = \delta_{mn}$。[@problem_id:3390227]

使用标准正交基的主要优点在于，它极大地简化了离散系统中矩阵的结构。例如，在有限元或 DG 方法中，单元**质量矩阵 (mass matrix)** $M$ 的定义为 $M_{ij} = \int_K \phi_i \phi_j \,dx$。对于[标准正交基](@entry_id:147779)，该矩阵直接变为单位矩阵 $M = I$，其[条件数](@entry_id:145150)为 1，与多项式次数 $p$ 无关，这在计算上极为有利。[@problem_id:3390279]

#### 基于边界条件的组合基

另一种构造策略是根据函数在单元边界上的行为来设计[基函数](@entry_id:170178)，这在 DG 和[谱元法](@entry_id:755171)中尤其重要。这种方法将基[函数分解](@entry_id:197881)为处理边界自由度的部分和处理内部自由度的部分。对于一维区间 $[-1, 1]$，这种基通常包含三类：

1.  **顶点模态 (Vertex modes)**：与区间的两个端点（顶点）关联。最简单的选择是两个线性函数，它们在一个端点处为 1，在另一个端点处为 0。例如 $\phi^v_-(x) = \frac{1-x}{2}$ 和 $\phi^v_+(x) = \frac{1+x}{2}$。[@problem_id:3390278]

2.  **内部模态 (Interior modes)** 或 **气泡模态 (Bubble modes)**：这些函数在区间的两个端点 $x = \pm 1$ 处均为零。它们用于丰富单元内部的逼近空间，而不影响边界上的值。

构造气泡模态的一种标准方法是使用**[雅可比多项式](@entry_id:197425) (Jacobi polynomials)** $P_k^{(\alpha, \beta)}$。[雅可比多项式](@entry_id:197425)是在权重函数 $(1-x)^\alpha (1+x)^\beta$ 下的正交多项式族。通过乘以一个在边界上为零的因子，我们可以构造出[气泡函数](@entry_id:176111)。一个典型的例子是：[@problem_id:3390236]
$$
\psi_n(x) = (1-x^2) P_{n-2}^{(1,1)}(x), \quad n \ge 2
$$
这里的因子 $(1-x^2)$ 确保了函数在 $x=\pm 1$ 时为零。$P_{n-2}^{(1,1)}(x)$ 是[雅可比多项式](@entry_id:197425)，其选择与特定的正交性或算子性质有关。这些函数是分层的，因为 $\psi_n(x)$ 的次数为 $n$。

另一种构造内部模态的方法是对勒让德多项式进行积分：[@problem_id:3390278]
$$
\phi^e_n(x) = \int_{-1}^x P_{n-1}(t) \,dt, \quad n \ge 2
$$
由于 $P_{n-1}(-1)$ 是有限的，在积分下限处 $\phi^e_n(-1)=0$。同时，由于[勒让德多项式](@entry_id:141510) $P_k$ 对于 $k \ge 1$ 满足 $\int_{-1}^1 P_k(t) \,dt = 0$，所以 $\phi^e_n(1) = 0$。因此，这些积分形式的函数也是有效的内部（或边）模态。

### 高维空间中的分层基

将分层基的概念推广到二维和三维是实际应用的关键。构造方法取决于单元的几何形状。

#### [四边形单元](@entry_id:176937)上的[张量积](@entry_id:140694)构造

对于具有[张量积](@entry_id:140694)结构的域，如参考正方形 $[-1,1]^2$，构造高维[基函数](@entry_id:170178)非常直接。我们可以取一维[基函数](@entry_id:170178)集，并通过[张量积](@entry_id:140694)生成二维基。例如，如果我们使用前面提到的顶点模态 $\{\phi^v_-, \phi^v_+\}$ 和内部（边）模态 $\{\phi^e_n\}_{n=2}^p$ 作为一维基，那么二维基就是所有形如 $\phi_i(x) \phi_j(y)$ 的乘积。[@problem_id:3390278]

根据这些张量积函数在正方形边界上的迹（即函数值），可以将它们分为三类：

*   **顶点模态 (Vertex modes)**：由两个一维顶点模态的张量积构成，形如 $\phi^v_\sigma(x) \phi^v_\tau(y)$。每个这样的函数仅在一个顶点处非零，而在其他三个顶点处为零。总共有 4 个顶点模态。

*   **边模态 (Edge modes)**：由一个一维顶点模态和一个一维内部模态的张量积构成，形如 $\phi^v_\sigma(x) \phi^e_n(y)$ 或 $\phi^e_m(x) \phi^v_\tau(y)$。这些函数在所有顶点处为零，但在一条边上非零。对于每个 $p \ge 2$，每条边上有 $p-1$ 个这样的模态，总共有 $4(p-1)$ 个边模态。

*   **内部模态 (Interior modes)**：由两个一维内部模态的张量积构成，形如 $\phi^e_m(x) \phi^e_n(y)$。这些函数在整个单元边界上均为零。总共有 $(p-1)^2$ 个内部模态。

这种顶点-边-内部的分解是 $hp$-自适应有限元/[DG方法](@entry_id:748369)的基础，因为它允许我们根据需要独立地调整与不同几何实体（顶点、边、面、体）相关的逼近。

#### [三角形单元](@entry_id:167871)上的非张量积构造

对于不具有[张量积](@entry_id:140694)结构的单纯形单元（如三角形或四面体），构造过程更为复杂。在参考三角形上，通常使用**[重心坐标](@entry_id:155488) (barycentric coordinates)** $(\lambda_1, \lambda_2, \lambda_3)$。一个著名且有效的分层基（通常称为 Dubiner 基或 Karniadakis-Sherwin 基）也遵循顶点-边-内部的分解思想。[@problem_id:3390264]

*   **边模态**：与边 $E_{ij}$（顶点 $k$ 的对边）关联的模态需要在这条边的两个端点（即顶点 $i$ 和 $j$）处为零。这可以通过因子 $\lambda_i \lambda_j$ 实现。为了将边上的函数表示为标准的一维多项式，通常引入一个映射到 $[-1,1]$ 的折叠坐标，如 $t_{ij} = (\lambda_j - \lambda_i)/(\lambda_i + \lambda_j)$。一个典型的边模态形式为：
    $$
    e_{ij,k}(\lambda) = \lambda_i \lambda_j s_{ij}^{\,k} P_k^{(1,1)}(t_{ij}), \quad k=0, \ldots, p-2
    $$
    其中 $s_{ij} = \lambda_i+\lambda_j$。因子 $s_{ij}^k$ 是为了确保整个表达式是关于 $\lambda$ 的多项式（次数为 $k+2$）。$P_k^{(1,1)}$ 是[雅可比多项式](@entry_id:197425)，其选择与端点为零的权重 $(1-t^2)$ 天然相关。对于给定的总次数 $p$，每条边上有 $p-1$ 个这样的模态。

*   **内部模态**：需要再三角形的所有三条边上为零，这可以通过基本[气泡函数](@entry_id:176111) $\lambda_1 \lambda_2 \lambda_3$ 来保证。更高阶的内部模态通过乘以基于内部坐标（同样由[重心坐标](@entry_id:155488)构造）的[雅可比多项式](@entry_id:197425)得到，形式复杂，如：
    $$
    b_{i,j}(\lambda) = \lambda_1 \lambda_2 \lambda_3 s^{\,i} P_i^{(1,1)}(a) P_j^{(2i+1,1)}(b), \quad i+j \le p-3
    $$
    这里 $a,b,s$ 是由 $\lambda_1, \lambda_2, \lambda_3$ 定义的内部坐标。总共有 $\frac{(p-1)(p-2)}{2}$ 个内部模态。

尽管形式复杂，但这种构造系统地生成了一个分层基，并保持了将自由度与几何实体清晰关联的重要特性。

### 离散系统中的应用与机制

分层基的结构优势在它们被用于[求解偏微分方程](@entry_id:138485)时变得尤为突出。

#### [静态凝聚](@entry_id:176722)与 DG 方法

在间断 Galerkin 方法中，单元之间的耦合完全通过边界上的**数值通量 (numerical flux)** $\widehat{\boldsymbol{f}}$ 实现。DG 的[弱形式](@entry_id:142897)在一个单元 $K$ 上为：
$$
\frac{d}{dt} \int_K v u \,dV = \int_K \nabla v \cdot \boldsymbol{f}(u) \,dV - \int_{\partial K} v \widehat{\boldsymbol{f}} \,dS
$$
当我们使用一个分为**迹模态 (trace modes)**（在边界 $\partial K$ 上非零）和**气泡模态 (bubble modes)**（在 $\partial K$ 上为零）的分层基时，一个关键现象发生了。[@problem_id:3390254]

如果我们选择一个气泡模态 $\phi^b$ 作为[检验函数](@entry_id:166589) $v$，由于 $\phi^b$ 在边界上处处为零，弱形式中的边界积分项自动消失：
$$
\int_{\partial K} \phi^b \widehat{\boldsymbol{f}} \,dS = 0
$$
这意味着与气泡[模态系数](@entry_id:752057)相关的方程只包含本单元内的项，而与相邻单元完全解耦。因此，这些局部自由度可以在单元级别被求解并消除，这个过程称为**[静态凝聚](@entry_id:176722) (static condensation)**。最终的全局[线性系统](@entry_id:147850)只涉及在单元间耦合的迹模态自由度，从而极大地减小了求解规模，提高了[计算效率](@entry_id:270255)。

#### 离散算子的性质

分层基的选择对质量矩阵和刚度/[微分矩阵](@entry_id:149870)的性质有深刻影响。

*   **质量矩阵**：如前所述，对于仿射单元（即物理单元与[参考单元](@entry_id:168425)之间为[线性映射](@entry_id:185132)），$L^2$-标准正交[模态基](@entry_id:752055)（如归一化的勒让德基）产生的质量矩阵是单位矩阵。然而，当单元是弯曲的，通过非仿射的**[等参映射](@entry_id:173239) (isoparametric map)** $x = \chi(\hat{x})$ 描述时，情况会发生变化。[积分变换](@entry_id:186209)会引入一个与位置相关的[雅可比行列式](@entry_id:137120) $J(\hat{x}) = |\partial x / \partial \hat{x}|$ 作为权重：
    $$
    M_{ij} = \int_{\hat{K}} \phi_i(\hat{x}) \phi_j(\hat{x}) J(\hat{x}) \,d\hat{x}
    $$
    如果映射非仿射，$J(\hat{x})$ 将不是常数。例如，对于映射 $x = \hat{x} + \alpha \hat{x}^2$，[雅可比](@entry_id:264467)为 $J(\hat{x}) = 1 + 2\alpha\hat{x}$ (假设 $|2\alpha|  1$)。这导致[质量矩阵](@entry_id:177093)变为 $M_{ij} = \int_{-1}^1 P_i P_j \,d\hat{x} + 2\alpha \int_{-1}^1 \hat{x} P_i P_j \,d\hat{x}$。由于[勒让德多项式](@entry_id:141510)的[三项递推关系](@entry_id:176845)，第二项对于某些 $i \neq j$ 不为零，从而破坏了对角性。例如，可以计算出 $M_{12} = 8\alpha/15$。[@problem_id:3390267] 这表明，几何曲率会导致[质量矩阵](@entry_id:177093)变得稠密，从而抵消了正交基的部分优势。

*   **[微分算子](@entry_id:140145)**：在[模态基](@entry_id:752055)下，微分[算子的矩阵表示](@entry_id:153664)通常是稀疏的。例如，对于勒让德基，其导数 $P'_j$ 可以表示为次数小于 $j$ 且奇偶性相反的[勒让德多项式](@entry_id:141510)的和。这导致微分算子在系数空间的[矩阵表示](@entry_id:146025) $D^{\text{modal}}$ 是一个具有棋盘状[稀疏结构](@entry_id:755138)的严格上三角矩阵。相比之下，[节点基](@entry_id:752522)的[微分矩阵](@entry_id:149870) $G^{\text{nodal}}$ (其元素为 $G^{\text{nodal}}_{ij} := \ell'_j(\xi_i)$) 通常是稠密的。[@problem_id:3390279] 此外，[模态系数](@entry_id:752057)可以直接与[算子的谱](@entry_id:272027)性质关联，例如，对于亥姆霍兹方程，一个[模态基](@entry_id:752055)下的刚度矩阵对角元 $s_n = a(\phi_n, \phi_n)$ 可以被解析地计算出来。对于勒让德基和算子 $a(u,v)=\int (1-x^2)u'v'dx$，通过[Sturm-Liouville理论](@entry_id:142729)可以证明 $s_n=n(n+1)$。[@problem_id:3390227]

### 实际考虑：[非线性](@entry_id:637147)与混淆误差

在求解[非线性](@entry_id:637147)问题时，例如，需要计算 $u(x)^2$ 这样的项，通常采用[数值求积](@entry_id:136578)（如 Gauss 求积）来计算其[模态系数](@entry_id:752057) $c_k = \int_{-1}^1 u(x)^2 \phi_k(x) \,dx$。如果求积点的数量 $N_q$ 不足以精确积分被积函数，就会产生**混淆误差 (aliasing error)**，即高频分量被错误地表示为低频分量，可能导致数值不稳定。[@problem_id:3390273]

为了避免混淆，被积函数的次数必须在[求积法则](@entry_id:753909)的精确积分范围内。对于 $u \in \mathbb{P}_p$ 和 $\phi_k \in \mathbb{P}_k$，被积函数 $u^2 \phi_k$ 的次数最高为 $2p+k$。Gauss-Legendre 求积使用 $N_q$ 个点，可以精确积分次数不超过 $2N_q-1$ 的多项式。因此，无混淆的条件是：
$$
2p + k \le 2N_q - 1 \quad \implies \quad k \le 2N_q - 1 - 2p
$$
这个条件界定了一个“安全”的模态指数范围。任何超出此范围的[模态系数](@entry_id:752057) $c_k$ 的计算都可能受到混淆误差的污染。分层基的一个强大应用是设计**模态滤波器 (modal filter)**，即通过将这些受污染的高阶[模态系数](@entry_id:752057)强制设为零来稳定计算。一个最小的“截断”滤波器会将所有 $k > \min\{p, 2N_q - 1 - 2p\}$ 的系数置零，从而在保持低阶模态精确性的同时消除不稳定的高频伪影。这种基于模态的滤波操作对于[节点基](@entry_id:752522)来说难以实现。

总之，分层多项式基通过其独特的嵌套结构，为[高阶数值方法](@entry_id:142601)提供了强大的理论框架和计算优势。它们简化了 $p$-自适应，并允许通过[静态凝聚](@entry_id:176722)等技术显著提高计算效率。尽管在处理弯曲几何和[非线性](@entry_id:637147)项时需要特别注意，但它们提供的结构化和灵活性，使其成为现代谱方法和间断 Galerkin 方法中不可或-缺的工具。