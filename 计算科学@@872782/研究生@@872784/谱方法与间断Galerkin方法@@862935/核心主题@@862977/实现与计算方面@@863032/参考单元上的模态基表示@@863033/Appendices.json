{"hands_on_practices": [{"introduction": "在谱方法和间断Galerkin方法中，使用正交基函数至关重要，因为它们能将质量矩阵对角化，从而极大地简化求解过程。本练习将带您从勒让德多项式的基本性质出发，推导其在一维参考区间 $[-1,1]$ 上的归一化常数。掌握这一过程是理解和构建任何模态基的基石。[@problem_id:3400583]", "problem": "考虑在谱方法和间断 Galerkin (DG) 方法中使用的标准一维参考单元 $I = [-1,1]$。令 $\\{P_{n}\\}_{n=0}^{\\infty}$ 表示 $I$ 上的未归一化勒让德多项式，其特征为 $P_{n}(1)=1$，这些多项式构成了 $I$ 上的一个模态基。定义权重为单位1的 $L^{2}(I)$ 内积为 $\\langle f,g\\rangle = \\int_{-1}^{1} f(x)\\,g(x)\\,dx$，并令质量矩阵的元素由 $M_{mn} = \\int_{-1}^{1} P_{m}(x)\\,P_{n}(x)\\,dx$ 给出。从内积和质量矩阵的定义出发，并且仅使用勒让德多项式在 $[-1,1]$ 上的基本性质，推导对角元素 $M_{nn}$ 的闭式表达式，并确定一个缩放因子 $\\alpha_{n}$，使得 $\\phi_{n}(x) = \\alpha_{n}\\,P_{n}(x)$ 构成一个 $L^{2}(I)$-标准正交基，即对所有 $m,n \\ge 0$ 都有 $\\int_{-1}^{1} \\phi_{m}(x)\\,\\phi_{n}(x)\\,dx = \\delta_{mn}$。将您的最终答案以一个单行矩阵的形式给出，其中包含 $M_{nn}$ 和 $\\alpha_{n}$ 关于 $n$ 的表达式。不需要数值近似，也不涉及任何单位。", "solution": "首先验证问题，以确保其具有科学依据、良定性和客观性。\n\n**步骤 1：提取已知条件**\n- **参考单元：** $I = [-1,1]$。\n- **基函数：** $\\{P_{n}\\}_{n=0}^{\\infty}$，即 $I$ 上的未归一化勒让德多项式。\n- **归一化条件：** 对所有 $n \\ge 0$，$P_{n}(1)=1$。\n- **内积：** $\\langle f,g\\rangle = \\int_{-1}^{1} f(x)\\,g(x)\\,dx$。\n- **质量矩阵：** $M_{mn} = \\int_{-1}^{1} P_{m}(x)\\,P_{n}(x)\\,dx$。\n- **目标 1：** 求质量矩阵对角元素 $M_{nn}$ 的闭式表达式。\n- **目标 2：** 求一个缩放因子 $\\alpha_{n}$，使得 $\\{\\phi_{n}(x) = \\alpha_{n}\\,P_{n}(x)\\}$ 是一个 $L^{2}(I)$-标准正交基，即 $\\int_{-1}^{1} \\phi_{m}(x)\\,\\phi_{n}(x)\\,dx = \\delta_{mn}$。\n- **约束：** 推导过程必须仅使用勒让德多项式在 $[-1,1]$ 上的基本性质。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题具有科学依据，植根于正交多项式的标准理论及其在偏微分方程数值方法（特别是谱方法和间断 Galerkin 方法）中的应用。勒让德多项式、$L^2$ 内积和标准正交性等概念都是明确定义的数学构造。该问题是良定的，陈述了明确的目标，并提供了所有必要的定义和约束。它是客观的，没有任何歧义或主观论断。该问题没有违反提示中列出的任何无效标准。\n\n**步骤 3：结论与行动**\n该问题被判定为**有效**。将提供完整解答。\n\n**质量矩阵对角元素 $M_{nn}$ 的推导**\n\n质量矩阵的对角元素由 $M_{nn} = \\langle P_{n},P_{n}\\rangle = \\int_{-1}^{1} (P_{n}(x))^{2}\\,dx$ 给出。我们将利用勒让德多项式的三项递推关系（这是一个基本性质）来推导 $M_{nn}$ 的闭式表达式。具有归一化条件 $P_{n}(1)=1$ 的勒让德多项式满足以下对于 $n \\ge 1$ 的递推关系：\n$$ (n+1)P_{n+1}(x) = (2n+1)xP_{n}(x) - nP_{n-1}(x) $$\n对上式进行整理，得到关于 $xP_{n}(x)$ 的表达式：\n$$ (2n+1)xP_{n}(x) = (n+1)P_{n+1}(x) + nP_{n-1}(x) $$\n将此方程两边乘以 $P_{n-1}(x)$ 并在区间 $I=[-1,1]$ 上积分：\n$$ (2n+1)\\int_{-1}^{1} xP_{n}(x)P_{n-1}(x)\\,dx = (n+1)\\int_{-1}^{1} P_{n+1}(x)P_{n-1}(x)\\,dx + n\\int_{-1}^{1} (P_{n-1}(x))^{2}\\,dx $$\n勒让德多项式的一个基本性质是它们在 $[-1,1]$ 上关于 $L^2$ 内积是正交的，即当 $m \\ne n$ 时，$\\int_{-1}^{1} P_{m}(x)P_{n}(x)\\,dx = 0$。应用此性质，右边的第一个积分为零。第二个积分根据定义是 $M_{n-1,n-1}$。因此，对于 $n \\ge 1$：\n$$ (2n+1)\\int_{-1}^{1} xP_{n}(x)P_{n-1}(x)\\,dx = n M_{n-1,n-1} $$\n这给出了包含 $x$ 的积分的第一个表达式：\n$$ \\int_{-1}^{1} xP_{n}(x)P_{n-1}(x)\\,dx = \\frac{n}{2n+1} M_{n-1,n-1} $$\n接下来，我们可以将递推关系中的索引从 $n$ 移至 $n-1$（对于 $n \\ge 2$，或更一般地，通过定义 $P_{-1}=0$）：\n$$ nP_{n}(x) = (2(n-1)+1)xP_{n-1}(x) - (n-1)P_{n-2}(x) $$\n整理得到 $xP_{n-1}(x)$ 的表达式：\n$$ (2n-1)xP_{n-1}(x) = nP_{n}(x) + (n-1)P_{n-2}(x) $$\n现在，将此方程两边乘以 $P_{n}(x)$ 并在 $I$ 上积分：\n$$ (2n-1)\\int_{-1}^{1} xP_{n-1}(x)P_{n}(x)\\,dx = n\\int_{-1}^{1} (P_{n}(x))^{2}\\,dx + (n-1)\\int_{-1}^{1} P_{n-2}(x)P_{n}(x)\\,dx $$\n根据正交性，右边的第二个积分为零。右边的第一个积分是 $M_{nn}$。因此，对于 $n \\ge 1$：\n$$ (2n-1)\\int_{-1}^{1} xP_{n}(x)P_{n-1}(x)\\,dx = n M_{nn} $$\n这得到了同一积分的第二个表达式：\n$$ \\int_{-1}^{1} xP_{n}(x)P_{n-1}(x)\\,dx = \\frac{n}{2n-1} M_{nn} $$\n将积分 $\\int_{-1}^{1} xP_{n}(x)P_{n-1}(x)\\,dx$ 的两个表达式相等，我们得到 $M_{nn}$ 的一个递推关系：\n$$ \\frac{n}{2n-1} M_{nn} = \\frac{n}{2n+1} M_{n-1,n-1} $$\n对于 $n \\ge 1$，两边除以 $n$ 可得：\n$$ M_{nn} = \\frac{2n-1}{2n+1} M_{n-1,n-1} $$\n为了找到闭式表达式，我们需要一个初始条件。对于 $n=0$，$P_0(x)$ 是一个常数。条件 $P_0(1)=1$ 意味着 $P_0(x)=1$。因此，\n$$ M_{00} = \\int_{-1}^{1} (P_0(x))^2\\,dx = \\int_{-1}^{1} 1^2\\,dx = [x]_{-1}^{1} = 1 - (-1) = 2 $$\n通过反复应用递推关系，我们得到一个连乘积：\n$$ M_{nn} = \\left(\\frac{2n-1}{2n+1}\\right)M_{n-1,n-1} = \\left(\\frac{2n-1}{2n+1}\\right)\\left(\\frac{2n-3}{2n-1}\\right)M_{n-2,n-2} = \\dots = \\left(\\frac{2n-1}{2n+1}\\right)\\left(\\frac{2n-3}{2n-1}\\right)\\dots\\left(\\frac{1}{3}\\right)M_{00} $$\n中间项相互抵消，剩下：\n$$ M_{nn} = \\frac{1}{2n+1} M_{00} = \\frac{2}{2n+1} $$\n该公式对所有 $n \\ge 0$ 成立。\n\n**标准正交缩放因子 $\\alpha_{n}$ 的推导**\n\n要求基 $\\{\\phi_{n}(x) = \\alpha_{n}P_{n}(x)\\}$ 是标准正交的，这意味着 $\\int_{-1}^{1} \\phi_{m}(x)\\phi_{n}(x)\\,dx = \\delta_{mn}$。\n代入 $\\phi_n(x)$ 的定义：\n$$ \\int_{-1}^{1} (\\alpha_{m}P_{m}(x))(\\alpha_{n}P_{n}(x))\\,dx = \\alpha_{m}\\alpha_{n}\\int_{-1}^{1} P_{m}(x)P_{n}(x)\\,dx = \\alpha_{m}\\alpha_{n}M_{mn} = \\delta_{mn} $$\n勒让德多项式 $\\{P_n\\}$ 的正交性确保了当 $m \\ne n$ 时 $M_{mn} = 0$，因此对于非对角项，该条件已经满足。对于对角项（$m=n$），我们要求：\n$$ \\alpha_{n}^2 M_{nn} = 1 $$\n求解 $\\alpha_n^2$：\n$$ \\alpha_{n}^2 = \\frac{1}{M_{nn}} $$\n使用先前推导出的 $M_{nn}$ 表达式：\n$$ \\alpha_{n}^2 = \\frac{1}{\\frac{2}{2n+1}} = \\frac{2n+1}{2} $$\n按照惯例，缩放因子 $\\alpha_n$ 取正值。因此，取正平方根得到：\n$$ \\alpha_{n} = \\sqrt{\\frac{2n+1}{2}} $$\n\n推导出的质量矩阵对角元素和标准正交缩放因子的闭式表达式分别为 $M_{nn} = \\frac{2}{2n+1}$ 和 $\\alpha_{n} = \\sqrt{\\frac{2n+1}{2}}$。", "answer": "$$ \\boxed{\\begin{pmatrix} \\frac{2}{2n+1} & \\sqrt{\\frac{2n+1}{2}} \\end{pmatrix}} $$", "id": "3400583"}, {"introduction": "从一维转到二维和三维时，选择参考单元的几何形状（如三角形或四边形）是算法设计的一个基本决策。不同形状的单元所对应的多项式空间结构有显著差异，这直接影响了计算自由度和成本。本练习通过计算和比较三角形上的全次数多项式空间 ($P^p$) 与四边形上的张量积多项式空间 ($Q^p$) 的维度，帮助您直观地理解不同单元类型对模态自由度数量的影响。[@problem_id:3400513]", "problem": "考虑参考三角形 $\\hat{T}^2 := \\{(r,s)\\in \\mathbb{R}^2 : r \\ge 0, s \\ge 0, r+s \\le 1\\}$ 和参考四边形 $\\hat{Q}^2 := [-1,1]^2$。令 $P^p(\\hat{T}^2)$ 表示在 $\\hat{T}^2$ 上的总次数最高为 $p$ 的二元多项式空间，令 $Q^p(\\hat{Q}^2)$ 表示在 $\\hat{Q}^2$ 上由每个坐标方向次数最高为 $p$ 的多项式构成的张量积多项式空间。在谱方法和间断Galerkin (DG) 方法的背景下，通常会构造 $\\hat{T}^2$ 和 $\\hat{Q}^2$ 上的模态基，以分别张成 $P^p(\\hat{T}^2)$ 和 $Q^p(\\hat{Q}^2)$。从这些多项式空间的核心定义和对单项式的基本组合计数出发，推导关于 $p$ 的 $\\dim P^p(\\hat{T}^2)$ 和 $\\dim Q^p(\\hat{Q}^2)$ 的通用表达式。然后，显式计算当 $p=0,1,2,3$ 时这些空间的维数。最后，解释关于 $p$ 的渐近增长率，并用文字说明增长的差异是如何源于总次数结构与张量积结构的不同，以及对于相同的 $p$ 值，这对 $\\hat{T}^2$ 与 $\\hat{Q}^2$ 上的模态自由度数量有何影响。\n\n对于你的最终方框答案，请将所要求的八个维数按 $\\dim P^0(\\hat{T}^2)$、$\\dim P^1(\\hat{T}^2)$、$\\dim P^2(\\hat{T}^2)$、$\\dim P^3(\\hat{T}^2)$、$\\dim Q^0(\\hat{Q}^2)$、$\\dim Q^1(\\hat{Q}^2)$、$\\dim Q^2(\\hat{Q}^2)$、$\\dim Q^3(\\hat{Q}^2)$ 的顺序列在一个单行矩阵中。无需四舍五入，也不涉及物理单位。", "solution": "该问题是有效的，因为它在科学上基于数值分析中使用的多项式逼近空间理论，其提法是适定的，定义清晰且标准，并以客观、正式的语言表述。我们可以开始求解。\n\n问题的核心是确定谱方法和间断Galerkin方法中使用的两个标准多项式空间 $P^p(\\hat{T}^2)$ 和 $Q^p(\\hat{Q}^2)$ 的维数。一个向量空间的维数等于其任何一组基中元素的数量。我们将通过计算构成每个空间基的单项式的数量来确定这些维数。\n\n首先，我们来求 $P^p(\\hat{T}^2)$ 的维数，这是总次数最高为 $p$ 的二元（我们用 $r$ 和 $s$）多项式空间。该空间的一组基由所有形如 $r^i s^j$ 的单项式给出，其中 $i$ 和 $j$ 是满足条件 $i+j \\le p$ 的非负整数。\n为了计算这样的数对 $(i, j)$ 的数量，我们可以使用组合论证。这个问题等价于求不等式 $i+j \\le p$ 的非负整数解的数量。我们可以引入一个非负整数松弛变量 $k$，使得 $k = p - (i+j)$。这样，不等式就转化为方程 $i+j+k = p$，其中 $i \\ge 0$，$j \\ge 0$ 且 $k \\ge 0$。\n这是一个经典的组合数学中的隔板法问题（stars-and-bars problem）。我们正在将 $p$ 个相同的物品（星）分配到 $3$ 个不同的箱子（代表变量 $i$、$j$ 和 $k$）中。实现这一目标的方法数由多重集系数公式给出：\n$$ \\dim P^p(\\hat{T}^2) = \\binom{p+3-1}{3-1} = \\binom{p+2}{2} $$\n展开二项式系数，我们得到维数的通用表达式：\n$$ \\dim P^p(\\hat{T}^2) = \\frac{(p+2)!}{2!(p+2-2)!} = \\frac{(p+2)(p+1)}{2} $$\n\n接下来，我们求 $Q^p(\\hat{Q}^2)$ 的维数，即在 $\\hat{Q}^2 = [-1,1]^2$ 上的张量积多项式空间。该空间由每个坐标变量（我们用 $\\xi$ 和 $\\eta$）次数最高为 $p$ 的多项式构成。$Q^p(\\hat{Q}^2)$ 的一组基是单项式集合 $\\xi^i \\eta^j$，其中指数 $i$ 和 $j$ 独立地满足 $0 \\le i \\le p$ 和 $0 \\le j \\le p$。\n指数 $i$ 可能的整数值（从 $0$ 到 $p$）有 $p+1$ 个。\n同样，指数 $j$ 可能的整数值（从 $0$ 到 $p$）也有 $p+1$ 个。\n由于 $i$ 和 $j$ 的选择是独立的，基单项式的总数是每个指数选择数量的乘积。因此，维数为：\n$$ \\dim Q^p(\\hat{Q}^2) = (p+1)(p+1) = (p+1)^2 $$\n\n现在，我们计算当多项式次数 $p=0, 1, 2, 3$ 时这些空间的具体维数。\n\n对于三角形单元空间 $P^p(\\hat{T}^2)$：\n- 当 $p=0$ 时： $\\dim P^0(\\hat{T}^2) = \\frac{(0+2)(0+1)}{2} = \\frac{2 \\cdot 1}{2} = 1$。\n- 当 $p=1$ 时： $\\dim P^1(\\hat{T}^2) = \\frac{(1+2)(1+1)}{2} = \\frac{3 \\cdot 2}{2} = 3$。\n- 当 $p=2$ 时： $\\dim P^2(\\hat{T}^2) = \\frac{(2+2)(2+1)}{2} = \\frac{4 \\cdot 3}{2} = 6$。\n- 当 $p=3$ 时： $\\dim P^3(\\hat{T}^2) = \\frac{(3+2)(3+1)}{2} = \\frac{5 \\cdot 4}{2} = 10$。\n\n对于四边形单元空间 $Q^p(\\hat{Q}^2)$：\n- 当 $p=0$ 时： $\\dim Q^0(\\hat{Q}^2) = (0+1)^2 = 1^2 = 1$。\n- 当 $p=1$ 时： $\\dim Q^1(\\hat{Q}^2) = (1+1)^2 = 2^2 = 4$。\n- 当 $p=2$ 时： $\\dim Q^2(\\hat{Q}^2) = (2+1)^2 = 3^2 = 9$。\n- 当 $p=3$ 时： $\\dim Q^3(\\hat{Q}^2) = (3+1)^2 = 4^2 = 16$。\n\n最后，我们解释渐近增长和结构上的差异。\n对于较大的 $p$，每个维数的渐近增长率由其公式中 $p$ 的最高次幂决定：\n- $\\dim P^p(\\hat{T}^2) = \\frac{1}{2}p^2 + \\frac{3}{2}p + 1$。增长是二次的，当 $p \\to \\infty$ 时，$\\dim P^p(\\hat{T}^2) \\sim \\frac{1}{2}p^2$。\n- $\\dim Q^p(\\hat{Q}^2) = p^2 + 2p + 1$。增长也是二次的，当 $p \\to \\infty$ 时，$\\dim Q^p(\\hat{Q}^2) \\sim p^2$。\n\n增长的差异直接源于对单项式指数的不同约束。对于 $P^p(\\hat{T}^2)$，指数 $(i,j)$ 必须满足 $i \\ge 0, j \\ge 0, i+j \\le p$。如果我们将这些整数对绘制在平面上，它们将完全填满一个顶点为 $(0,0)$、$(p,0)$ 和 $(0,p)$ 的离散三角形。对于 $Q^p(\\hat{Q}^2)$，指数必须满足 $0 \\le i \\le p$ 和 $0 \\le j \\le p$。这些整数对则填满一个顶点为 $(0,0)$、$(p,0)$、$(p,p)$ 和 $(0,p)$ 的离散正方形。\n\n对于任何 $p \\ge 1$，$Q^p$ 的正方形指数区域严格包含 $P^p$ 的三角形指数区域。$Q^p$ 中“多余”的单项式是那些满足 $i+j > p$ 的项。这些项包括更高阶的交互项，例如 $\\xi^p\\eta^p$，其总次数为 $2p$。$Q^p(\\hat{Q}^2)$ 中的最大总次数是 $2p$，而根据定义，$P^p(\\hat{T}^2)$ 中的最大总次数是 $p$。这种结构上的差异意味着，对于相同的多项式阶数参数 $p$，四边形空间 $Q^p(\\hat{Q}^2)$ 比三角形空间 $P^p(\\hat{T}^2)$ 包含更多的基函数或自由度。渐近地看，对于较大的 $p$，一个四边形单元的自由度数量大约是三角形单元的两倍（$\\lim_{p \\to \\infty} \\frac{\\dim Q^p}{\\dim P^p} = \\frac{p^2}{p^2/2} = 2$）。这对像DG这样的方法的计算成本有直接影响，在这些方法中，当使用相同的多项式阶数 $p$ 时，三角形网格可能比四边形网格更经济。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1 & 3 & 6 & 10 & 1 & 4 & 9 & 16\n\\end{pmatrix}\n}\n$$", "id": "3400513"}, {"introduction": "数值方法的真正考验往往在于其处理非光滑解（如激波或材料界面）的能力，这些现象在科学与工程计算中普遍存在。本练习将深入探讨当函数存在跳跃间断时，其勒让德模态系数的衰减行为。通过分析这些系数的代数衰减率，我们不仅能预测DG方法 $L^2$ 投影误差的收敛速度，还能更深刻地理解谱近似中的吉布斯现象。[@problem_id:3400525]", "problem": "考虑参考单元 $\\left[-1,1\\right]$，其上的模态 Legendre 基为 $\\left\\{P_{n}(x)\\right\\}_{n\\geq 0}$，该基关于 $\\left[-1,1\\right]$ 上的标准内积是正交的。令 $u(x)=v(x)+\\Delta\\,H\\!\\left(x-\\xi\\right)$，其中 $v(x)$ 是在 $\\left[-1,1\\right]$ 上无限可微的函数，$H$ 是 Heaviside 阶跃函数，$\\xi\\in\\left(-1,1\\right)$ 是一个固定的内点，$\\Delta\\in\\mathbb{R}$ 是 $u$ 在 $x=\\xi$ 处的跳跃幅度。Legendre 模态系数定义为 $a_{n}=\\dfrac{2n+1}{2}\\int_{-1}^{1}u(x)P_{n}(x)\\,\\mathrm{d}x$，并令 $\\Pi_{p}$ 表示 $u$ 到多项式子空间 $\\mathrm{span}\\left\\{P_{0},P_{1},\\dots,P_{p}\\right\\}$ 上的 $L^{2}$ 投影。在间断 Galerkin (DG) 方法的背景下，参考单元上的 $L^{2}$ 投影误差为 $E_{p}:=\\left\\|u-\\Pi_{p}u\\right\\|_{L^{2}\\!\\left([-1,1]\\right)}$。\n\n从 Legendre 多项式的正交性和 $P_{n}$ 在内点处经过充分检验的渐近公式出发，推导由跳跃贡献产生的模态系数 $\\left\\{a_{n}\\right\\}$ 的代数衰减率，并用此预测当多项式次数 $p\\to\\infty$ 时，DG $L^{2}$ 投影误差 $E_{p}$ 的主阶渐近行为。用 $\\Delta$、$p$ 和参数 $\\theta=\\arccos(\\xi)\\in\\left(0,\\pi\\right)$ 表示你的最终结果。将最终答案表示为单个闭式解析表达式。无需四舍五入，也不涉及物理单位。", "solution": "问题要求推导在参考区间 $\\left[-1,1\\right]$ 上具有单个跳跃间断点的函数 $u(x)$ 的 $L^{2}$ 投影误差 $E_{p}$ 的主阶渐近行为。该函数由 $u(x)=v(x)+\\Delta\\,H\\!\\left(x-\\xi\\right)$ 给出，其中 $v(x)$ 是一个 $C^{\\infty}$ 函数，$H$ 是 Heaviside 阶跃函数，$\\xi\\in\\left(-1,1\\right)$，$\\Delta \\in \\mathbb{R}$ 是跳跃幅度。\n\n首先，我们分析 Legendre 模态系数 $a_{n}$，其定义为 $a_{n}=\\dfrac{2n+1}{2}\\int_{-1}^{1}u(x)P_{n}(x)\\,\\mathrm{d}x$。根据积分的线性性质，我们可以将该系数分解为两部分：\n$$a_{n} = \\frac{2n+1}{2}\\int_{-1}^{1}v(x)P_{n}(x)\\,\\mathrm{d}x + \\frac{2n+1}{2}\\int_{-1}^{1}\\Delta H(x-\\xi)P_{n}(x)\\,\\mathrm{d}x = a_{n}^{(v)} + a_{n}^{(\\text{jump})}$$\n对于光滑部分 $v(x)$，它是无限可微的，其 Legendre 系数 $a_{n}^{(v)}$ 表现出谱衰减。这意味着它们比 $n$ 的任何代数幂次衰减得都快，即当 $n\\to\\infty$ 时，对任何 $k>0$ 都有 $a_{n}^{(v)} = O(n^{-k})$。而来自跳跃间断点的贡献 $a_{n}^{(\\text{jump})}$ 的代数衰减率要慢得多，因此将主导 $a_n$ 的渐近行为。我们重点关注这一项。\n\n系数的跳跃贡献为：\n$$a_{n}^{(\\text{jump})} = \\Delta \\frac{2n+1}{2}\\int_{-1}^{1} H(x-\\xi) P_{n}(x)\\,\\mathrm{d}x$$\n根据 Heaviside 函数的定义，当 $x  \\xi$ 时 $H(x-\\xi)=0$，当 $x > \\xi$ 时 $H(x-\\xi)=1$。该积分变为：\n$$a_{n}^{(\\text{jump})} = \\Delta \\frac{2n+1}{2}\\int_{\\xi}^{1} P_{n}(x)\\,\\mathrm{d}x$$\n我们使用与 Legendre 多项式导数相关的恒等式：$P'_{n+1}(x) - P'_{n-1}(x) = (2n+1)P_n(x)$。对这个关系式进行积分得到：\n$$\\int (2n+1)P_n(x)\\,\\mathrm{d}x = P_{n+1}(x) - P_{n-1}(x) + C$$\n将此应用于我们的定积分：\n$$\\int_{\\xi}^{1} (2n+1)P_{n}(x)\\,\\mathrm{d}x = \\left[P_{n+1}(x) - P_{n-1}(x)\\right]_{\\xi}^{1} = \\left(P_{n+1}(1) - P_{n-1}(1)\\right) - \\left(P_{n+1}(\\xi) - P_{n-1}(\\xi)\\right)$$\n由于对所有整数 $k \\geq 0$ 都有 $P_k(1)=1$，第一项为 $1-1=0$。因此，\n$$\\int_{\\xi}^{1} (2n+1)P_{n}(x)\\,\\mathrm{d}x = -\\left(P_{n+1}(\\xi) - P_{n-1}(\\xi)\\right)$$\n将此代回 $a_{n}^{(\\text{jump})}$ 的表达式中：\n$$a_{n}^{(\\text{jump})} = \\frac{\\Delta}{2} \\left(P_{n-1}(\\xi) - P_{n+1}(\\xi)\\right)$$\n这个表达式是精确的。为了找到大 $n$ 时的渐近行为，我们使用 Hilb 提出的 Legendre 多项式在内点 $x=\\cos(\\theta)\\in(-1,1)$ 的渐近公式：\n$$P_n(\\cos\\theta) = \\sqrt{\\frac{2}{n\\pi\\sin\\theta}} \\cos\\left(\\left(n+\\frac{1}{2}\\right)\\theta - \\frac{\\pi}{4}\\right) + O(n^{-3/2})$$\n设 $\\xi = \\cos(\\theta)$，对于大的 $n$ 我们有：\n$$P_{n-1}(\\xi) - P_{n+1}(\\xi) \\approx \\sqrt{\\frac{2}{n\\pi\\sin\\theta}} \\left[ \\cos\\left(\\left(n-\\frac{1}{2}\\right)\\theta - \\frac{\\pi}{4}\\right) - \\cos\\left(\\left(n+\\frac{3}{2}\\right)\\theta - \\frac{\\pi}{4}\\right) \\right]$$\n使用三角恒等式 $\\cos(A)-\\cos(B) = -2\\sin\\left(\\frac{A+B}{2}\\right)\\sin\\left(\\frac{A-B}{2}\\right)$，其中 $A=\\left(n-\\frac{1}{2}\\right)\\theta - \\frac{\\pi}{4}$ 且 $B=\\left(n+\\frac{3}{2}\\right)\\theta - \\frac{\\pi}{4}$，我们得到：\n$$\\frac{A+B}{2} = \\left(n+\\frac{1}{2}\\right)\\theta - \\frac{\\pi}{4} \\quad \\text{和} \\quad \\frac{A-B}{2} = -\\theta$$\n余弦之差变为 $2\\sin\\theta \\sin\\left(\\left(n+\\frac{1}{2}\\right)\\theta - \\frac{\\pi}{4}\\right)$。\n将此代入 $a_{n}^{(\\text{jump})}$ 的表达式，得到主阶项：\n$$a_{n} \\approx a_{n}^{(\\text{jump})} \\approx \\frac{\\Delta}{2} \\sqrt{\\frac{2}{n\\pi\\sin\\theta}} \\left(2\\sin\\theta \\sin\\left(\\left(n+\\frac{1}{2}\\right)\\theta - \\frac{\\pi}{4}\\right)\\right)$$\n$$a_{n} \\approx \\Delta \\sqrt{\\frac{2\\sin\\theta}{n\\pi}} \\sin\\left(\\left(n+\\frac{1}{2}\\right)\\theta - \\frac{\\pi}{4}\\right)$$\n这表明系数以 $|a_n| = O(n^{-1/2})$ 的代数速率衰减。\n\n$L^2$ 投影误差为 $E_p = \\|u - \\Pi_p u\\|_{L^2}$。根据 Legendre 级数的 Parseval 恒等式，误差的平方是次数大于 $p$ 的所有模态的平方和：\n$$E_p^2 = \\|u - \\Pi_p u\\|_{L^{2}}^{2} = \\sum_{n=p+1}^{\\infty} a_n^2 \\|P_n\\|_{L^2}^2 = \\sum_{n=p+1}^{\\infty} a_n^2 \\frac{2}{2n+1}$$\n代入 $a_n$ 的渐近表达式：\n$$E_p^2 \\approx \\sum_{n=p+1}^{\\infty} \\left(\\Delta \\sqrt{\\frac{2\\sin\\theta}{n\\pi}} \\sin\\left(\\left(n+\\frac{1}{2}\\right)\\theta - \\frac{\\pi}{4}\\right)\\right)^2 \\frac{2}{2n+1}$$\n$$E_p^2 \\approx \\sum_{n=p+1}^{\\infty} \\Delta^2 \\frac{2\\sin\\theta}{n\\pi} \\sin^2\\left(\\left(n+\\frac{1}{2}\\right)\\theta - \\frac{\\pi}{4}\\right) \\frac{2}{2n+1}$$\n对于大的 $n$，我们可以近似 $2n+1 \\approx 2n$。\n$$E_p^2 \\approx \\frac{2\\Delta^2\\sin\\theta}{\\pi} \\sum_{n=p+1}^{\\infty} \\frac{1}{n^2} \\sin^2\\left(\\left(n+\\frac{1}{2}\\right)\\theta - \\frac{\\pi}{4}\\right)$$\n为了找到此和式在大 $p$ 下的主阶行为，我们可以用积分来近似它。$\\sin^2\\left(\\dots\\right)$ 项快速振荡。其平均值为 $1/2$。严格的分析表明，该和式的主项可以通过将振荡项替换为其平均值得到：\n$$E_p^2 \\approx \\frac{2\\Delta^2\\sin\\theta}{\\pi} \\sum_{n=p+1}^{\\infty} \\frac{1}{n^2} \\left(\\frac{1}{2}\\right) = \\frac{\\Delta^2\\sin\\theta}{\\pi} \\sum_{n=p+1}^{\\infty} \\frac{1}{n^2}$$\n对于大的 $p$，剩余的和式可以用积分来近似：\n$$\\sum_{n=p+1}^{\\infty} \\frac{1}{n^2} \\approx \\int_{p}^{\\infty} \\frac{1}{x^2}\\,\\mathrm{d}x = \\left[-\\frac{1}{x}\\right]_{p}^{\\infty} = \\frac{1}{p}$$\n结合这些结果，我们得到误差平方的渐近行为：\n$$E_p^2 \\approx \\frac{\\Delta^2\\sin\\theta}{\\pi p}$$\n取平方根，得到 $L^2$ 投影误差的主阶渐近行为：\n$$E_p \\approx \\sqrt{\\frac{\\Delta^2\\sin\\theta}{\\pi p}} = |\\Delta| \\sqrt{\\frac{\\sin\\theta}{\\pi p}}$$\n这个表达式给出了以跳跃幅度 $\\Delta$、多项式次数 $p$ 和跳跃位置参数 $\\theta=\\arccos(\\xi)$ 表示的误差。", "answer": "$$\\boxed{|\\Delta| \\sqrt{\\frac{\\sin(\\theta)}{\\pi p}}}$$", "id": "3400525"}]}