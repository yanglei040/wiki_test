{"hands_on_practices": [{"introduction": "不连续伽辽金 (DG) 方法的核心优势之一源于其逐单元计算的局部性。该练习将引导您完成一个基本但至关重要的计算：将计算从标准“参考”单元映射到物理网格单元。通过这个过程，您将推导出局部质量矩阵，并揭示其结构如何直接转化为显著的计算效率，尤其是在求解与时间相关的偏微分方程时。[@problem_id:3401227]", "problem": "考虑一个在无量纲坐标系下的单个四边形单元上的间断伽辽金（DG）方法。令参考单元为方形 $\\widehat{K} = [-1,1] \\times [-1,1]$，其局部坐标为 $(r,s)$。物理单元 $K$ 的顶点按逆时针顺序排列，对应于参考角点 $(-1,-1)$、$(1,-1)$、$(1,1)$、$(-1,1)$，在物理坐标系 $(x,y)$ 中由点 $(0,0)$、$(2,0)$、$(2,3)$、$(0,3)$ 给出。使用由 $\\widehat{K}$ 上的四个双线性 Lagrange 形函数构建的标准双线性等参映射：\n$$\nN_{1}(r,s) = \\frac{1}{4}(1-r)(1-s),\\quad\nN_{2}(r,s) = \\frac{1}{4}(1+r)(1-s),\\quad\nN_{3}(r,s) = \\frac{1}{4}(1+r)(1+s),\\quad\nN_{4}(r,s) = \\frac{1}{4}(1-r)(1+s),\n$$\n并将到物理单元的映射定义为\n$$\nx(r,s) = \\sum_{i=1}^{4} N_{i}(r,s)\\,x_{i},\\qquad\ny(r,s) = \\sum_{i=1}^{4} N_{i}(r,s)\\,y_{i},\n$$\n其中 $(x_{i},y_{i})$ 是按上述顺序排列的物理顶点坐标。令 $\\widehat{K}$ 上的逼近空间为张量积 $L^{2}$-正交归一多项式基\n$$\n\\psi_{p,q}(r,s) = \\varphi_{p}(r)\\,\\varphi_{q}(s),\\qquad p,q \\in \\{0,1,\\dots,P\\},\n$$\n其中一维基函数为 $\\varphi_{p}(r) = \\sqrt{\\frac{2p+1}{2}}\\,P_{p}(r)$，$P_{p}$ 是 $[-1,1]$ 上的 $p$ 次 Legendre 多项式，使得\n$$\n\\int_{-1}^{1}\\int_{-1}^{1} \\psi_{p,q}(r,s)\\,\\psi_{p',q'}(r,s)\\,dr\\,ds = \\delta_{p,p'}\\,\\delta_{q,q'}.\n$$\nDG 方法的局部质量矩阵元定义为\n$$\nM_{(p,q),(p',q')} = \\int_{K} \\psi_{p,q}(x,y)\\,\\psi_{p',q'}(x,y)\\,dA,\n$$\n其中 $dA$ 是物理面积元，$\\delta_{i,j}$ 表示克罗内克δ。\n\n从这些定义出发：\n- 计算显式的从参考单元到物理单元的映射 $(x(r,s),y(r,s))$ 以及雅可比行列式 $J(r,s) = \\det\\left(\\frac{\\partial(x,y)}{\\partial(r,s)}\\right)$。\n- 使用变量替换公式，将 $M_{(p,q),(p',q')}$ 写成包含雅可比行列式的在 $\\widehat{K}$ 上的积分。\n- 以闭合形式计算该积分。\n\n根据你的推导，简要解释局部质量矩阵的最终结构如何体现间断伽辽金方法（DG）的核心计算动机和优势，重点关注局部性和效率。将你的最终答案表示为单个闭合形式的解析表达式；无需四舍五入。", "solution": "首先验证问题，以确保其科学基础可靠、良定且客观。\n\n### 步骤1：提取已知条件\n-   参考单元：方形 $\\widehat{K} = [-1,1] \\times [-1,1]$，局部坐标为 $(r,s)$。\n-   物理单元顶点：按逆时针顺序排列，对应于参考角点 $(-1,-1)$、$(1,-1)$、$(1,1)$、$(-1,1)$，分别为 $(x_1,y_1)=(0,0)$、$(x_2,y_2)=(2,0)$、$(x_3,y_3)=(2,3)$、$(x_4,y_4)=(0,3)$。\n-   双线性 Lagrange 形函数：\n    $N_{1}(r,s) = \\frac{1}{4}(1-r)(1-s)$\n    $N_{2}(r,s) = \\frac{1}{4}(1+r)(1-s)$\n    $N_{3}(r,s) = \\frac{1}{4}(1+r)(1+s)$\n    $N_{4}(r,s) = \\frac{1}{4}(1-r)(1+s)$\n-   等参映射：$x(r,s) = \\sum_{i=1}^{4} N_{i}(r,s)\\,x_{i}$，$y(r,s) = \\sum_{i=1}^{4} N_{i}(r,s)\\,y_{i}$。\n-   $\\widehat{K}$ 上的逼近基：$\\psi_{p,q}(r,s) = \\varphi_{p}(r)\\,\\varphi_{q}(s)$，其中 $p,q \\in \\{0,1,\\dots,P\\}$。\n-   一维基函数：$\\varphi_{p}(r) = \\sqrt{\\frac{2p+1}{2}}\\,P_{p}(r)$，其中 $P_{p}$ 是 $p$ 次 Legendre 多项式。\n-   正交归一性条件：$\\int_{-1}^{1}\\int_{-1}^{1} \\psi_{p,q}(r,s)\\,\\psi_{p',q'}(r,s)\\,dr\\,ds = \\delta_{p,p'}\\,\\delta_{q,q'}$。\n-   局部质量矩阵定义：$M_{(p,q),(p',q')} = \\int_{K} \\psi_{p,q}(x,y)\\,\\psi_{p',q'}(x,y)\\,dA$。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题是间断伽辽金（DG）方法计算理论中的一个标准练习。所有给定的定义，包括形函数、等参映射和 Legendre 多项式基，在谱方法和有限元方法领域都是标准的。该问题是自洽的，提供了所有必要的数据和定义。这些顶点定义了一个简单的矩形，这简化了雅可比行列式的计算，是阐述基本原理的常用技巧。该问题是客观的、可数学形式化的，并且直接关系到指定的主题。不存在科学或事实上的不健全、矛盾或含糊之处。\n\n### 步骤3：结论与行动\n该问题被视为有效。将提供完整的解答。\n\n### 求解推导\n\n按照要求，解答分为三个部分：计算映射和雅可比行列式，变换质量矩阵积分，以及计算积分，最后解释结果的意义。\n\n**1. 参考单元到物理单元的映射与雅可比行列式**\n\n从参考坐标 $(r,s) \\in \\widehat{K}$ 到物理坐标 $(x,y) \\in K$ 的等参映射是利用给定的形函数和顶点坐标构建的。\n\n$x$-坐标映射为：\n$$\nx(r,s) = N_{1}(r,s)x_{1} + N_{2}(r,s)x_{2} + N_{3}(r,s)x_{3} + N_{4}(r,s)x_{4}\n$$\n代入顶点坐标 $(x_1, x_2, x_3, x_4) = (0, 2, 2, 0)$：\n$$\nx(r,s) = \\frac{1}{4}(1-r)(1-s)(0) + \\frac{1}{4}(1+r)(1-s)(2) + \\frac{1}{4}(1+r)(1+s)(2) + \\frac{1}{4}(1-r)(1+s)(0)\n$$\n$$\nx(r,s) = \\frac{1}{2}(1+r)(1-s) + \\frac{1}{2}(1+r)(1+s) = \\frac{1}{2}(1+r)[(1-s)+(1+s)] = \\frac{1}{2}(1+r)(2) = 1+r\n$$\n\n$y$-坐标映射为：\n$$\ny(r,s) = N_{1}(r,s)y_{1} + N_{2}(r,s)y_{2} + N_{3}(r,s)y_{3} + N_{4}(r,s)y_{4}\n$$\n代入顶点坐标 $(y_1, y_2, y_3, y_4) = (0, 0, 3, 3)$：\n$$\ny(r,s) = \\frac{1}{4}(1-r)(1-s)(0) + \\frac{1}{4}(1+r)(1-s)(0) + \\frac{1}{4}(1+r)(1+s)(3) + \\frac{1}{4}(1-r)(1+s)(3)\n$$\n$$\ny(r,s) = \\frac{3}{4}(1+r)(1+s) + \\frac{3}{4}(1-r)(1+s) = \\frac{3}{4}(1+s)[(1+r)+(1-r)] = \\frac{3}{4}(1+s)(2) = \\frac{3}{2}(1+s)\n$$\n显式映射为 $(x(r,s), y(r,s)) = \\left(1+r, \\frac{3}{2}(1+s)\\right)$。这是一个仿射映射。\n\n接下来，我们计算变换的雅可比矩阵 $\\frac{\\partial(x,y)}{\\partial(r,s)}$：\n$$\n\\mathbf{J} =\n\\begin{pmatrix}\n\\frac{\\partial x}{\\partial r} & \\frac{\\partial x}{\\partial s} \\\\\n\\frac{\\partial y}{\\partial r} & \\frac{\\partial y}{\\partial s}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\frac{\\partial}{\\partial r}(1+r) & \\frac{\\partial}{\\partial s}(1+r) \\\\\n\\frac{\\partial}{\\partial r}\\left(\\frac{3}{2}(1+s)\\right) & \\frac{\\partial}{\\partial s}\\left(\\frac{3}{2}(1+s)\\right)\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1 & 0 \\\\\n0 & \\frac{3}{2}\n\\end{pmatrix}\n$$\n雅可比行列式 $J(r,s)$ 是该矩阵的行列式：\n$$\nJ(r,s) = \\det(\\mathbf{J}) = (1)\\left(\\frac{3}{2}\\right) - (0)(0) = \\frac{3}{2}\n$$\n雅可比行列式是常数，因为该映射是仿射映射（将一个正方形映射到一个矩形）。这个常数代表了物理单元面积与参考单元面积之比：$\\text{Area}(K) / \\text{Area}(\\widehat{K}) = (2 \\times 3) / (2 \\times 2) = 6/4 = 3/2$。\n\n**2. 质量矩阵积分变换**\n\n局部质量矩阵元定义为在物理单元 $K$ 上的积分：\n$$\nM_{(p,q),(p',q')} = \\int_{K} \\psi_{p,q}(x,y)\\,\\psi_{p',q'}(x,y)\\,dA\n$$\n基函数 $\\psi_{p,q}$ 是在参考单元 $\\widehat{K}$ 上用 $(r,s)$ 定义的。我们使用积分的变量替换公式，其中物理面积元 $dA$ 被替换为 $J(r,s)\\,dr\\,ds$。\n$$\nM_{(p,q),(p',q')} = \\int_{\\widehat{K}} \\psi_{p,q}(r,s)\\,\\psi_{p',q'}(r,s)\\,J(r,s)\\,dr\\,ds\n$$\n代入计算出的雅可比行列式 $J(r,s) = \\frac{3}{2}$：\n$$\nM_{(p,q),(p',q')} = \\int_{-1}^{1}\\int_{-1}^{1} \\psi_{p,q}(r,s)\\,\\psi_{p',q'}(r,s)\\,\\left(\\frac{3}{2}\\right)\\,dr\\,ds\n$$\n\n**3. 闭合形式计算与解释**\n\n由于雅可比行列式是一个常数，它可以从积分中提出来：\n$$\nM_{(p,q),(p',q')} = \\frac{3}{2} \\int_{-1}^{1}\\int_{-1}^{1} \\psi_{p,q}(r,s)\\,\\psi_{p',q'}(r,s)\\,dr\\,ds\n$$\n问题陈述中给出了基函数 $\\psi_{p,q}$ 的正交归一性：\n$$\n\\int_{-1}^{1}\\int_{-1}^{1} \\psi_{p,q}(r,s)\\,\\psi_{p',q'}(r,s)\\,dr\\,ds = \\delta_{p,p'}\\,\\delta_{q,q'}\n$$\n其中 $\\delta_{i,j}$ 是克罗内克δ。将此代入质量矩阵元的表达式，得到最终的闭合形式结果：\n$$\nM_{(p,q),(p',q')} = \\frac{3}{2}\\,\\delta_{p,p'}\\,\\delta_{q,q'}\n$$\n此结果表明局部质量矩阵是一个对角矩阵。具体来说，它是 $\\frac{3}{2}$ 倍的单位矩阵。\n\n**计算动机与优势解释：**\n\n该推导阐明了间断伽辽金方法的一个核心计算优势，尤其是在使用正交基时。\n\n1.  **局部性与块对角结构：** 质量矩阵是逐个单元计算的。在一个由许多单元组装成的全局系统中，全局质量矩阵呈块对角形式，其中每个块是对应单元的局部质量矩阵。不同单元上的基函数之间没有耦合，因此逼近具有“间断”的性质。\n\n2.  **通过对角化实现效率：** 这里的关键结果是局部质量矩阵是对角阵。对于常使用显式时间步进格式（例如，Runge-Kutta 方法）求解的瞬态问题，一个关键步骤涉及求解 $M\\dot{u} = F(u)$ 形式的线性系统，这需要计算 $M^{-1}F(u)$。\n    -   因为全局质量矩阵 $M$ 是块对角的，其逆矩阵 $M^{-1}$ 也是块对角的，其中每个块是相应局部质量矩阵的逆。求逆可以在每个单元上局部进行。\n    -   至关重要的是，由于局部质量矩阵本身是对角的（$M_{\\text{local}} = cI$），其逆矩阵的计算非常简单：$(M_{\\text{local}})^{-1} = (1/c)I$。在这个具体问题中，任何局部质量矩阵块的逆矩阵就是乘以 $2/3$。\n    -   这就避免了在每个时间步进行计算成本高昂的全局线性求解，而在连续伽辽金方法中这是必需的，因为其全局质量矩阵是稀疏但非块对角的。因此，DG方法的质量矩阵是“显式格式友好的”，从而带来了高效且可并行的算法。\n\n虽然完美的对角质量矩阵只在仿射单元和正交基的情况下出现，但块对角的全局结构是 DG 方法的一个普遍特征。对于更复杂的非仿射（弯曲）单元，雅可比行列式不再是常数，局部质量矩阵会变成稠密矩阵。然而，它仍然是一个小矩阵，其求逆效率远高于大型全局系统矩阵，从而保留了相比于连续方法显著的计算优势。", "answer": "$$\n\\boxed{\\frac{3}{2}\\delta_{p,p'}\\delta_{q,q'}}\n$$", "id": "3401227"}, {"introduction": "虽然像 DG 这样的高阶方法在求解平滑解时表现出色，但在处理双曲守恒律中的激波或不连续点时，它们可能会产生非物理的伪振荡。为了确保数值解的稳定性和物理真实性，引入了“斜率限制器”这一关键技术。本练习提供了一个应用广泛使用的 `minmod` 限制器的具体计算，它展示了 DG 方法如何通过实时监测和调整解的斜率，来稳健地捕捉尖锐特征，从而避免数值崩溃。[@problem_id:3401228]", "problem": "考虑一维标量守恒律 $u_{t} + f(u)_{x} = 0$，该守恒律在宽度为 $h$ 的单元 $I_{j} = [x_{j - \\frac{1}{2}}, x_{j + \\frac{1}{2}}]$ 组成的均匀网格上，通过多项式次数为 $p=1$ 的间断伽辽金(DG)方法进行离散。在每个单元 $I_{j}$ 中，近似解通过 $x = x_{j} + \\frac{h}{2}\\,\\xi$ 从参考区间 $[-1,1]$ 映射，在一个模态勒让德基中表示为\n$$\nu_{h}(x)\\big|_{I_{j}} = \\bar{u}_{j} + \\hat{u}_{j,1}\\,\\xi,\n$$\n其中 $\\bar{u}_{j}$ 是单元平均值，$\\hat{u}_{j,1}$ 是与参考基函数 $\\xi$ 相关联的线性模态系数，且 $\\xi \\in [-1,1]$。\n\n为了在存在间断时增强鲁棒性，一个基于minmod函数的斜率限制器被逐单元地应用于物理斜率 $s_{j}$。对于 $p=1$，该物理斜率定义为单元内的常数导数，\n$$\ns_{j} := \\frac{\\mathrm{d}u_{h}}{\\mathrm{d}x}\\bigg|_{I_{j}}.\n$$\n受限斜率定义为\n$$\ns_{j}^{\\mathrm{lim}} = \\minmod\\!\\Big(s_{j}, s_{j}^{-}, s_{j}^{+}\\Big),\n$$\n其中\n$$\ns_{j}^{-} := \\frac{\\bar{u}_{j} - \\bar{u}_{j-1}}{h}, \\qquad s_{j}^{+} := \\frac{\\bar{u}_{j+1} - \\bar{u}_{j}}{h},\n$$\n且minmod函数为\n$$\n\\minmod(a_{1},\\dots,a_{n}) = \\begin{cases}\n\\operatorname{sign}(a_{1})\\,\\min\\{|a_{1}|,\\dots,|a_{n}|\\},  & \\text{如果 } \\operatorname{sign}(a_{1}) = \\cdots = \\operatorname{sign}(a_{n}),\\\\\n0,  & \\text{否则}.\n\\end{cases}\n$$\n\n给定一个在单元 $I_{j}$ 右侧存在间断的测试配置：\n- 网格宽度 $h = 0.5$，\n- 单元平均值 $\\bar{u}_{j-1} = 1.9$, $\\bar{u}_{j} = 2.0$, $\\bar{u}_{j+1} = -1.8$，\n- 模态系数 $\\hat{u}_{j,1} = 0.15$。\n\n仅使用这些数据和上述定义，计算受限斜率 $s_{j}^{\\mathrm{lim}}$。将你的最终答案表示为一个精确的实数，无需四舍五入。简要解释在存在间断的情况下，在间断伽辽金框架中应用此限制器的动机，并阐明此操作保留了该方法的哪些属性，但请确保你最终报告的值仅为所要求的受限斜率。", "solution": "该问题有效。这是一个来自偏微分方程数值分析领域的适定的、有科学依据的问题，具体涉及谱方法和间断伽辽金(DG)方法。它提供了计算唯一解所需的所有必要定义和数据。\n\n任务是根据给定的数据和DG方法设置，计算受限斜率 $s_{j}^{\\mathrm{lim}}$。受限斜率定义为\n$$\ns_{j}^{\\mathrm{lim}} = \\minmod\\!\\Big(s_{j}, s_{j}^{-}, s_{j}^{+}\\Big).\n$$\n为了计算这个值，我们必须首先确定 `minmod` 函数的三个参数的值：单元 $I_j$ 内的物理斜率 $s_j$，以及根据相邻单元平均值估算的斜率 $s_j^-$ 和 $s_j^+$。\n\n首先，我们计算单元 $I_j$ 内的物理斜率 $s_j$。其定义为单元内近似解 $u_h(x)$ 的空间导数：\n$$\ns_{j} := \\frac{\\mathrm{d}u_{h}}{\\mathrm{d}x}\\bigg|_{I_{j}}.\n$$\n解以参考坐标 $\\xi \\in [-1, 1]$ 表示为 $u_{h}(x)\\big|_{I_{j}} = \\bar{u}_{j} + \\hat{u}_{j,1}\\,\\xi$。物理坐标 $x$ 和参考坐标 $\\xi$ 之间的映射为 $x = x_{j} + \\frac{h}{2}\\,\\xi$。我们使用链式法则求导：\n$$\n\\frac{\\mathrm{d}u_{h}}{\\mathrm{d}x} = \\frac{\\mathrm{d}u_{h}}{\\mathrm{d}\\xi} \\frac{\\mathrm{d}\\xi}{\\mathrm{d}x}.\n$$\n根据解的表示，关于 $\\xi$ 的导数为：\n$$\n\\frac{\\mathrm{d}u_{h}}{\\mathrm{d}\\xi} = \\frac{\\mathrm{d}}{\\mathrm{d}\\xi} (\\bar{u}_{j} + \\hat{u}_{j,1}\\,\\xi) = \\hat{u}_{j,1}.\n$$\n从坐标映射中，我们得到 $\\frac{\\mathrm{d}x}{\\mathrm{d}\\xi} = \\frac{h}{2}$，这意味着 $\\frac{\\mathrm{d}\\xi}{\\mathrm{d}x} = \\frac{2}{h}$。结合这些结果，物理斜率 $s_j$ 为：\n$$\ns_{j} = \\hat{u}_{j,1} \\cdot \\frac{2}{h}.\n$$\n代入给定值 $h = 0.5$ 和 $\\hat{u}_{j,1} = 0.15$：\n$$\ns_{j} = 0.15 \\cdot \\frac{2}{0.5} = 0.15 \\cdot 4 = 0.6.\n$$\n\n接下来，我们根据相邻单元的平均值计算斜率 $s_j^-$ 和 $s_j^+$。定义如下：\n$$\ns_{j}^{-} := \\frac{\\bar{u}_{j} - \\bar{u}_{j-1}}{h}, \\qquad s_{j}^{+} := \\frac{\\bar{u}_{j+1} - \\bar{u}_{j}}{h}.\n$$\n使用提供的单元平均值 $\\bar{u}_{j-1} = 1.9$、$\\bar{u}_{j} = 2.0$、$\\bar{u}_{j+1} = -1.8$ 和网格宽度 $h = 0.5$：\n$$\ns_{j}^{-} = \\frac{2.0 - 1.9}{0.5} = \\frac{0.1}{0.5} = 0.2.\n$$\n$$\ns_{j}^{+} = \\frac{-1.8 - 2.0}{0.5} = \\frac{-3.8}{0.5} = -7.6.\n$$\n\n最后，我们使用 `minmod` 函数和已计算出的三个斜率：$s_{j} = 0.6$、$s_{j}^{-} = 0.2$ 和 $s_{j}^{+} = -7.6$ 来计算受限斜率 $s_{j}^{\\mathrm{lim}}$：\n$$\ns_{j}^{\\mathrm{lim}} = \\minmod(0.6, 0.2, -7.6).\n$$\n`minmod` 函数定义为：\n$$\n\\minmod(a_{1},\\dots,a_{n}) = \\begin{cases}\n\\operatorname{sign}(a_{1})\\,\\min\\{|a_{1}|,\\dots,|a_{n}|\\},  & \\text{如果 } \\operatorname{sign}(a_{1}) = \\cdots = \\operatorname{sign}(a_{n}),\\\\\n0,  & \\text{否则}.\n\\end{cases}\n$$\n我们检查参数的符号：$\\operatorname{sign}(0.6) = +1$，$\\operatorname{sign}(0.2) = +1$ 和 $\\operatorname{sign}(-7.6) = -1$。由于这三个参数的符号不完全相同，因此适用 `minmod` 定义的第二种情况。因此，受限斜率为：\n$$\ns_{j}^{\\mathrm{lim}} = 0.\n$$\n\n应用此类限制器的动机是，在使用像DG这样的高阶方法求解守恒律时，确保数值稳定性和物理真实性。高阶格式可以精确地捕捉光滑解，但在诸如激波之类的间断附近容易产生虚假的、非物理的振荡（吉布斯现象）。这些振荡可能导致非物理状态（例如，负密度）并导致数值模拟失败。\n\n限制器的功能是检测即将产生振荡的区域，并局部地修改解以抑制它们。限制器所保持或强制的关键属性是**单调性**。如果一个格式不会在解中产生新的局部极大值或极小值，那么它就是保单调的。通过将单元内的斜率($s_j$)与其邻居的有限差分斜率($s_j^-$ 和 $s_j^+$)进行比较，限制器评估解是否是单调的。在此问题中，单元平均值 $\\bar{u}_{j-1} = 1.9$、$\\bar{u}_{j} = 2.0$ 和 $\\bar{u}_{j+1} = -1.8$ 表明在单元 $I_j$ 处存在一个局部最大值。`minmod` 函数参数中正负斜率的混合是这种非单调剖面的直接结果。通过返回一个值为0，限制器有效地消除了单元 $I_j$ 中的斜率，将多项式表示降为一个常数，$u_h(x)|_{I_j} = \\bar{u}_j$。这在局部将格式的精度降低到一阶，而一阶格式本质上是无振荡的，从而以牺牲局部精度为代价来保持单调性。这个过程对于使高阶DG方法在处理涉及激波的问题时具有鲁棒性至关重要。", "answer": "$$\\boxed{0}$$", "id": "3401228"}, {"introduction": "DG 方法的一个显著特点是其“超收敛”性质，即原始 DG 解中隐藏着比其名义精度更高的信息。通过一种称为“光滑增进保精度” (SIAC) 滤波的后处理技术，我们可以“解锁”这种额外的精度。本练习旨在探讨这种强大技术背后的理论，通过推导经过后处理的解的收敛阶，您将理解一个简单且计算成本低廉的卷积操作如何能将整个模拟的精度阶数翻倍。[@problem_id:3401253]", "problem": "考虑一维环面 $\\mathbb{T} = \\mathbb{R}/\\mathbb{Z}$ 上的线性平流方程 $u_{t} + a\\,u_{x} = 0$，其具有光滑的 1-周期初始数据 $u(x,0) = u_{0}(x)$ 和恒定的平流速度 $a > 0$。设 $u_{h}$ 表示在尺寸为 $h$ 的均匀网格上，使用 $p$ 次分片多项式和迎风数值通量得到的半离散间断 Galerkin (DG) 近似解。已知 $p=1$ 且解在 $t \\in [0,T]$ 上保持光滑。在计算出 $u_{h}(\\cdot,T)$ 后，你执行一个定义如下的光滑性提升保精度 (SIAC) 后处理。\n\n定义一个紧支集核函数 $K:\\mathbb{R}\\to\\mathbb{R}$，它是 $p+1$ 阶单变量 B-样条的整数平移的线性组合，其选择方式使得 $K$ 在 Strang–Fix 条件的意义下能够精确再生最高 $2p$ 次的多项式：对于任意次数 $\\deg(q)\\le 2p$ 的多项式 $q$，都有 $\\int_{\\mathbb{R}} K(x)\\,q(x)\\,dx = q(0)$。对于 $h>0$，定义缩放核函数 $K_{h}(x) = h^{-1}K(x/h)$，并通过卷积定义后处理解 $\\widetilde{u}_{h}(\\cdot,T)$ 为 $\\widetilde{u}_{h}(x,T) = \\int_{\\mathbb{T}} K_{h}(x-y)\\,u_{h}(y,T)\\,dy$，其中积分是周期性的。假设网格是均匀的，核函数中的系数是对称的（因此 $K$ 是偶函数），并且卷积在分片多项式 $u_{h}$ 上是精确计算的。\n\n从使用再生核的卷积的基本近似原理和均匀网格上 DG 离散化的结构出发，概述在此设置下应用 SIAC 滤波器的步骤，并推导后处理误差的 $L^{2}(\\mathbb{T})$ 范数 $\\|\\widetilde{u}_{h}(\\cdot,T) - u(\\cdot,T)\\|_{L^{2}(\\mathbb{T})}$ 作为 $p$ 的函数的渐近收敛阶。然后，将您的结果应用于给定的 $p=1$ 的情况，并以单个数字的形式给出预测的收敛率。无需四舍五入。您的最终答案必须是这个预测率的数值。", "solution": "该问题要求分析应用于线性平流方程的间断 Galerkin (DG) 数值解的光滑性提升保精度 (SIAC) 后处理方法的收敛性质。我们必须首先概述其精度提升的理论基础，然后推导在给定参数下的具体收敛率。\n\n问题陈述已经过验证，被认为是科学上合理、适定且内部一致的。它描述了 DG 方法数值分析中的一个标准情景。我们可以继续进行求解。\n\n设 $u(x,t)$ 是在一维环面 $\\mathbb{T}$ 上，具有 $a > 0$ 和光滑初始数据 $u_0(x)$ 的线性平流方程 $u_{t} + a\\,u_{x} = 0$ 的精确解。设 $u_{h}(x,t)$ 是在尺寸为 $h$ 的均匀网格上，使用 $p$ 次分片多项式得到的半离散 DG 近似解。问题陈述解在 $t \\in [0,T]$ 上保持光滑。此 DG 近似在 $L^{2}(\\mathbb{T})$ 范数下的标准最优误差估计为\n$$\n\\|u(\\cdot,T) - u_{h}(\\cdot,T)\\|_{L^{2}(\\mathbb{T})} = O(h^{p+1})\n$$\n时刻 $T$ 的后处理解 $\\widetilde{u}_{h}$ 由与缩放核函数 $K_{h}(x) = h^{-1}K(x/h)$ 的周期性卷积定义：\n$$\n\\widetilde{u}_{h}(x,T) = (K_{h} \\star u_{h})(x,T) = \\int_{\\mathbb{T}} K_{h}(x-y)\\,u_{h}(y,T)\\,dy\n$$\n我们的目标是确定当 $h \\to 0$ 时，后处理误差 $\\|\\widetilde{u}_{h}(\\cdot,T) - u(\\cdot,T)\\|_{L^{2}(\\mathbb{T})}$ 的渐近收敛阶。\n\n我们首先使用三角不等式分解误差：\n$$\n\\|\\widetilde{u}_{h} - u\\|_{L^{2}} = \\|K_{h} \\star u_{h} - u\\|_{L^{2}} \\le \\|K_{h} \\star u_{h} - K_{h} \\star u\\|_{L^{2}} + \\|K_{h} \\star u - u\\|_{L^{2}}\n$$\n让我们分别分析右侧的两项。\n\n第二项 $\\|K_{h} \\star u - u\\|_{L^{2}}$ 表示卷积算子本身应用于精确解 $u$ 时的逼近误差。在此，核函数 $K$ 的性质至关重要。问题陈述指出 $K$ 能再生最高 $2p$ 次的多项式，这意味着它满足 $2p+1$ 阶的 Strang-Fix 条件。也就是说，对于任意次数 $\\deg(q) \\le 2p$ 的多项式 $q(x)$，我们有 $\\int_{\\mathbb{R}} K(x)\\,q(x)\\,dx = q(0)$。逼近论中的一个标准结果表明，对于一个足够光滑的函数 $u$（这是已知的），与这样一个缩放核函数进行卷积的误差由 Strang-Fix 条件的阶数决定。具体来说，误差阶为 $2p+1$。\n$$\n\\|K_{h} \\star u - u\\|_{L^{2}(\\mathbb{T})} = O(h^{2p+1})\n$$\n这种高阶精度是预料之中的，因为核函数就是为此目的而明确设计的。\n\n第一项 $\\|K_{h} \\star u_{h} - K_{h} \\star u\\|_{L^{2}}$ 可以写成 $\\|K_{h} \\star (u_{h} - u)\\|_{L^{2}}$。这一项表示卷积滤波器对 DG 误差 $e_{h} = u_{h} - u$ 的影响。根据卷积的 Young 不等式，我们知道 $\\|K_{h} \\star e_{h}\\|_{L^{2}} \\le \\|K_{h}\\|_{L^{1}} \\|e_{h}\\|_{L^{2}}$。由于 $\\|K_{h}\\|_{L^{1}} = \\|K\\|_{L^{1}} = \\text{常数}$（且通常归一化为 1），这个界只会给出 $\\|K_{h} \\star e_{h}\\|_{L^{2}} = O(h^{p+1})$，这并未显示出任何改进。\n\n然而，这正是线性双曲问题在均匀网格上的 DG 误差的特殊结构变得至关重要的地方。这是 DG 方法的 SIAC 后处理的基石。误差 $e_{h} = u_{h} - u$ 并不是一个量级为 $O(h^{p+1})$ 的普通函数。相反，它表现出一种结构化振荡和超收敛的性质。对于在均匀网格上建立的平移不变问题，DG 误差虽然在 $L^2$ 范数下很大，但在某种特定意义上，它在每个单元上与低次多项式近似正交。\n\nSIAC 后处理理论最初由 Bramble 和 Schatz 发展，后来由 Cockburn、Shu 等人应用于 DG 方法，该理论表明，与适当选择的核函数 $K$ 进行卷积能有效滤除 DG 误差的主要振荡分量。这一分析的结果（可以通过在周期域上使用傅里叶分析或通过拟插值的性质来严格证明）是，卷积后的 DG 误差也是高阶的。\n$$\n\\|K_{h} \\star (u_{h} - u)\\|_{L^{2}(\\mathbb{T})} = O(h^{2p+1})\n$$\n这种卷积后误差比原始误差具有更高收敛率的现象，正是该方法被称为“保精度”（或更准确地说是“精度提升”）的原因。这个结果依赖于所有给定的假设：一个线性常系数偏微分方程、一个均匀网格、一个恰当设计的核函数 $K$ 以及一个足够光滑的精确解。\n\n结合这两个误差界，我们得到：\n$$\n\\|\\widetilde{u}_{h} - u\\|_{L^{2}(\\mathbb{T})} \\le O(h^{2p+1}) + O(h^{2p+1}) = O(h^{2p+1})\n$$\n因此，后处理解的渐近收敛阶为 $2p+1$。这相对于底层 DG 格式 $p+1$ 的收敛率是一个显著的改进。\n\n问题指定使用 $p=1$ 的 $p$ 次分片多项式。为了求出预测的收敛率，我们将 $p=1$ 代入我们推导出的收敛阶公式。\n收敛率为 $2p+1$。\n对于 $p=1$，收敛率为 $2(1)+1 = 3$。\n所以，我们预测后处理误差的 $L^{2}$ 范数将以 $O(h^3)$ 的速度收敛到零，这意味着收敛率为 3。", "answer": "$$\\boxed{3}$$", "id": "3401253"}]}