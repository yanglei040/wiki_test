{"hands_on_practices": [{"introduction": "理解一个抽象数学概念的最好方法之一就是通过一个具体的例子亲手计算。本练习将引导你完成最简单非平凡情形下（一维线性单元上）提升算子的计算，从而揭开其神秘面纱。通过实践这个从定义出发推导离散算子的过程，你将为理解更复杂的间断Galerkin方法奠定坚实的基础。[@problem_id:3395997]", "problem": "考虑一维参考单元 $K=[-1,1]$ 以及 $K$ 上次数最多为 $1$ 的多项式构成的标量有限维逼近空间 $V_h=\\mathbb{P}_1(K)$。在间断 Galerkin (DG) 方法中，面提升算子 $L_F$ 将支撑在单个面 $F\\subset \\partial K$ 上的面函数 $g$ 映射为一个体函数 $L_F(g)\\in V_h$，该函数由边界泛函关于 $L^2(K)$ 内积的 Riesz 表示定义：\n$$\n\\int_{K} L_F(g)\\, v \\, dx \\;=\\; \\int_{F} g\\, v \\, ds \\quad \\text{对所有 } v\\in V_h.\n$$\n假设端点面为 $F=\\{1\\}$，且在 $F$ 上 $g=1$。使用标准的 $L^2(K)$ 内积作为 Riesz 映射，并通过求解相关的质量矩阵系统，在 $V_h$ 的基 $\\{\\phi_0(x),\\phi_1(x)\\}=\\{1,x\\}$ 中表示 $L_F(g)$。计算 $L_F(g)$ 作为 $x$ 的函数的显式闭式表达式。\n\n你的最终答案必须是单个闭式解析表达式。不要在最终答案中提供中间方程。", "solution": "首先验证问题，以确保其具有科学依据、适定、客观和完整。\n\n### 步骤 1：提取已知条件\n- 定义域：一维参考单元 $K = [-1, 1]$。\n- 逼近空间：$V_h = \\mathbb{P}_1(K)$，次数最多为 $1$ 的多项式空间。\n- $V_h$ 的基：$\\{\\phi_0(x), \\phi_1(x)\\} = \\{1, x\\}$。\n- 面提升算子 $L_F(g) \\in V_h$ 的定义：\n$$ \\int_{K} L_F(g)\\, v \\, dx = \\int_{F} g\\, v \\, ds \\quad \\text{对所有 } v \\in V_h. $$\n- 特定面：$F = \\{1\\}$。\n- 特定面函数：在 $F$ 上 $g = 1$。\n- Riesz 映射的内积：标准 $L^2(K)$ 内积，$\\langle u, v \\rangle = \\int_K uv \\, dx$。\n- 任务：计算 $L_F(g)$ 作为 $x$ 的函数的显式闭式表达式。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题在数值分析领域，特别是在间断 Galerkin (DG) 方法中，具有科学依据。通过 Riesz 表示定理定义提升算子是 DG 方法理论中的一个标准核心概念。该问题是适定的；对于具有给定内积的有限维空间 $V_h$，Riesz 表示定理保证了解 $L_F(g)$ 的存在性和唯一性。问题陈述是客观的，使用了精确的数学术语，没有歧义。所有必要的数据和定义都已提供，并且没有矛盾之处。该问题是应用 DG 提升算子定义的一个标准、可解的练习。\n\n### 步骤 3：结论和行动\n问题是有效的。将推导解答。\n\n### 解答推导\n目标是找到函数 $L_F(g) \\in V_h = \\mathbb{P}_1(K)$。由于 $L_F(g)$ 是一个次数最多为 $1$ 的多项式，它可以表示为基函数 $\\{\\phi_0(x), \\phi_1(x)\\} = \\{1, x\\}$ 的线性组合。设此表示为：\n$$\nL_F(g)(x) = c_0 \\phi_0(x) + c_1 \\phi_1(x) = c_0 \\cdot 1 + c_1 \\cdot x\n$$\n其中 $c_0$ 和 $c_1$ 是待确定的未知系数。\n\n提升算子的定义方程是：\n$$\n\\int_{K} L_F(g)\\, v \\, dx = \\int_{F} g\\, v \\, ds\n$$\n该方程必须对所有测试函数 $v \\in V_h$ 成立。只需对基函数 $v = \\phi_0(x)$ 和 $v = \\phi_1(x)$ 施加此条件即可。这将得到一个关于两个未知数 $c_0$ 和 $c_1$ 的线性方程组。\n\n将 $L_F(g)(x)$ 的表达式代入定义方程，我们得到：\n$$\n\\int_{-1}^{1} (c_0 + c_1 x) \\, v(x) \\, dx = \\int_{\\{1\\}} g(1) \\, v(1) \\, ds\n$$\n在面 $F=\\{1\\}$ 上的积分被解释为点求值，因此 $\\int_{\\{1\\}} f(x) ds = f(1)$。给定在 $F$ 上 $g=1$，右侧变为 $g(1)v(1) = 1 \\cdot v(1) = v(1)$。\n\n我们现在对每个基函数进行测试：\n\n情况 1：$v(x) = \\phi_0(x) = 1$。\n方程变为：\n$$\n\\int_{-1}^{1} (c_0 + c_1 x) \\cdot 1 \\, dx = \\phi_0(1) = 1\n$$\n$$\nc_0 \\int_{-1}^{1} 1 \\, dx + c_1 \\int_{-1}^{1} x \\, dx = 1\n$$\n计算积分：\n$$\n\\int_{-1}^{1} 1 \\, dx = [x]_{-1}^{1} = 1 - (-1) = 2\n$$\n$$\n\\int_{-1}^{1} x \\, dx = \\left[\\frac{x^2}{2}\\right]_{-1}^{1} = \\frac{1}{2} - \\frac{1}{2} = 0\n$$\n所以，第一个方程是：\n$$\n2c_0 + 0 \\cdot c_1 = 1\n$$\n\n情况 2：$v(x) = \\phi_1(x) = x$。\n方程变为：\n$$\n\\int_{-1}^{1} (c_0 + c_1 x) \\cdot x \\, dx = \\phi_1(1) = 1\n$$\n$$\nc_0 \\int_{-1}^{1} x \\, dx + c_1 \\int_{-1}^{1} x^2 \\, dx = 1\n$$\n计算积分：\n$$\n\\int_{-1}^{1} x \\, dx = 0\n$$\n$$\n\\int_{-1}^{1} x^2 \\, dx = \\left[\\frac{x^3}{3}\\right]_{-1}^{1} = \\frac{1}{3} - \\left(-\\frac{1}{3}\\right) = \\frac{2}{3}\n$$\n所以，第二个方程是：\n$$\n0 \\cdot c_0 + \\frac{2}{3} c_1 = 1\n$$\n\n我们得到关于 $(c_0, c_1)$ 的以下线性方程组：\n$$\n\\begin{pmatrix}\n\\int_K \\phi_0 \\phi_0 dx  & \\int_K \\phi_0 \\phi_1 dx \\\\\n\\int_K \\phi_1 \\phi_0 dx  & \\int_K \\phi_1 \\phi_1 dx\n\\end{pmatrix}\n\\begin{pmatrix}\nc_0 \\\\\nc_1\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\phi_0(1) \\\\\n\\phi_1(1)\n\\end{pmatrix}\n$$\n代入计算出的值：\n$$\n\\begin{pmatrix}\n2  & 0 \\\\\n0 & \\frac{2}{3}\n\\end{pmatrix}\n\\begin{pmatrix}\nc_0 \\\\\nc_1\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1 \\\\\n1\n\\end{pmatrix}\n$$\n这就是问题中提到的质量矩阵系统。由于质量矩阵是对角的（因为基函数 $\\{1, x\\}$ 在对称区间 $[-1, 1]$ 上是 $L^2$-正交的），可以直接求得解：\n从第一行：\n$$\n2c_0 = 1 \\implies c_0 = \\frac{1}{2}\n$$\n从第二行：\n$$\n\\frac{2}{3}c_1 = 1 \\implies c_1 = \\frac{3}{2}\n$$\n找到系数后，我们可以构造出提升算子作用于面 $F=\\{1\\}$ 上的 $g=1$ 时的显式表达式：\n$$\nL_F(g)(x) = c_0 + c_1 x = \\frac{1}{2} + \\frac{3}{2}x\n$$\n这就是所要求的闭式表达式。", "answer": "$$\n\\boxed{\\frac{1}{2} + \\frac{3}{2}x}\n$$", "id": "3395997"}, {"introduction": "在理解了提升算子的定义之后，一个自然而然的问题是如何在实际的大规模模拟中高效地实现它。本练习探讨了一个在科学计算中至关重要的算法权衡：内存占用（预先计算并存储算子矩阵）与计算开销（实时地重新计算算子作用）。通过分析这两种策略的计算成本，你将培养对高性能DG方法实现中性能优化的直觉。[@problem_id:3396038]", "problem": "考虑在由六面体单元构成的三维结构化网格上，使用次数为 $p=4$ 的张量积多项式基的非连续伽辽金 (DG) 方法。对任意单元 $K$，通过离散 Riesz 表示来定义面提升算子 $r_{F}$：对于任意面 $F \\subset \\partial K$ 以及迹空间中的任意面函数 $v$，算子 $r_{F} v \\in \\mathcal{P}_{p}(K)$ 满足\n$$\n(r_{F} v, w)_{K} = \\langle v, w|_{F} \\rangle_{F} \\quad \\text{for all } w \\in \\mathcal{P}_{p}(K),\n$$\n其中 $(\\cdot,\\cdot)_{K}$ 表示单元 $L^{2}$ 内积，而 $\\langle \\cdot,\\cdot \\rangle_{F}$ 表示面 $L^{2}$ 内积。在有限维表示中，这导出一个线性代数关系\n$$\n\\mathbf{M}_{K} \\, \\mathbf{R}_{F} = \\mathbf{B}_{F}^{\\top},\n$$\n其中 $\\mathbf{M}_{K} \\in \\mathbb{R}^{N_{p} \\times N_{p}}$ 是单元质量矩阵，$\\mathbf{R}_{F} \\in \\mathbb{R}^{N_{p} \\times N_{f}}$ 是 $r_{F}$ 的矩阵表示，$\\mathbf{B}_{F}^{\\top} \\in \\mathbb{R}^{N_{p} \\times N_{f}}$ 将面自由度与体测试函数耦合。对于六面体上的张量积基，单元自由度数为 $N_{p} = (p+1)^{3}$，面自由度数为 $N_{f} = (p+1)^{2}$。每个六面体单元有 $6$ 个面。\n\n采用以下稠密线性代数成本模型（将浮点加法和乘法均计为一次浮点运算）：\n- 对称正定矩阵 $\\mathbf{M}_{K} \\in \\mathbb{R}^{N_{p} \\times N_{p}}$ 的 Cholesky 分解成本为 $\\frac{1}{3} N_{p}^{3}$ 次浮点运算。\n- 使用 Cholesky 因子通过前向和后向代换求解 $\\mathbf{M}_{K} \\mathbf{x} = \\mathbf{b}$ 的成本为每个右端项 $2 N_{p}^{2}$ 次浮点运算。\n- 与 $\\mathbb{R}^{m \\times n}$ 中的矩阵进行矩阵向量乘积的成本为 $2 m n$ 次浮点运算。\n\n假设网格是 $N_{x} \\times N_{y} \\times N_{z}$ 个单元的结构化网格，并且单元质量矩阵的分解（Cholesky 分解）每个单元只执行一次，之后重复使用。考虑两种策略：\n1. 通过求解所有面 $F$ 的方程 $\\mathbf{M}_{K} \\mathbf{R}_{F} = \\mathbf{B}_{F}^{\\top}$，为每个单元的每个面预计算其提升矩阵 $\\mathbf{R}_{F}$。\n2. 即时应用提升算子：对于任意给定的面数据向量 $\\mathbf{w} \\in \\mathbb{R}^{N_{f}}$，通过先构造 $\\mathbf{b} = \\mathbf{B}_{F}^{\\top} \\mathbf{w}$，然后使用已存储的 Cholesky 因子求解 $\\mathbf{M}_{K} \\mathbf{y} = \\mathbf{b}$ 来计算 $\\mathbf{y} = \\mathbf{R}_{F}\\mathbf{w}$。\n\n对于 $p=4$，计算策略1（为每个单元的每个面构建所有 $\\mathbf{R}_{F}$ 算子）的总浮点运算次数与策略2在所有单元的所有面上进行单次即时应用的总浮点运算次数之比。将最终答案表示为单个精确有理数。无需四舍五入。", "solution": "我们首先列举在具有张量积基的六面体单元上，多项式次数为 $p=4$ 时的自由度。体自由度数为\n$$\nN_{p} = (p+1)^{3} = (4+1)^{3} = 125,\n$$\n面自由度数为\n$$\nN_{f} = (p+1)^{2} = (4+1)^{2} = 25.\n$$\n每个单元有 6 个面。\n\n我们采用所述的浮点运算模型：\n- $\\mathbf{M}_{K} \\in \\mathbb{R}^{N_{p} \\times N_{p}}$ 的 Cholesky 分解成本为 $\\frac{1}{3} N_{p}^{3}$ 次浮点运算。\n- 使用 Cholesky 因子求解一个右端项 (RHS) 的成本为 $2 N_{p}^{2}$ 次浮点运算。\n- 矩阵向量乘积 $\\mathbb{R}^{m \\times n} \\to \\mathbb{R}^{m}$ 的成本为 $2 m n$ 次浮点运算。\n\n我们接下来计算每个单元的成本，然后乘以单元数量 $N_{e} = N_{x} N_{y} N_{z}$。由于我们最终将计算两个成本的比率，而这两个成本都与 $N_{e}$ 成线性关系，因此 $N_{e}$ 将被消去。\n\n策略1的成本（预计算所有每个面的提升矩阵 $\\mathbf{R}_{F}$）：\n- 每个单元执行一次 $\\mathbf{M}_{K}$ 的 Cholesky 分解：成本为 $\\frac{1}{3} N_{p}^{3}$ 次浮点运算。\n- 对于每个面，求解 $\\mathbf{M}_{K} \\mathbf{R}_{F} = \\mathbf{B}_{F}^{\\top}$ 以得到 $\\mathbf{R}_{F} \\in \\mathbb{R}^{N_{p} \\times N_{f}}$。这等同于为每个面的 $N_{f}$ 个列求解 $\\mathbf{M}_{K} \\mathbf{x} = \\mathbf{b}$，每列成本为 $2 N_{p}^{2}$ 次浮点运算。因此，每个面的成本为 $2 N_{p}^{2} N_{f}$ 次浮点运算。\n- 每个单元有 $6$ 个面，因此每个单元的总求解成本为 $6 \\cdot 2 N_{p}^{2} N_{f} = 12 N_{p}^{2} N_{f}$ 次浮点运算。\n\n因此，每个单元的总预计算成本为\n$$\nC_{\\text{pre}}^{(K)} = \\frac{1}{3} N_{p}^{3} + 12 N_{p}^{2} N_{f}.\n$$\n在所有单元上，总预计算成本为\n$$\nC_{\\text{pre}} = N_{e} \\left( \\frac{1}{3} N_{p}^{3} + 12 N_{p}^{2} N_{f} \\right).\n$$\n\n策略2单次全局应用的成本（在所有单元的所有面上即时应用提升）：\n- 假设 $\\mathbf{M}_{K}$ 的 Cholesky 分解已经执行并存储，所以我们不在此处包含该成本（在使用中，它被分摊并且是两种策略共有的）。\n- 对于每个单元面的应用，我们首先以 $2 N_{p} N_{f}$ 次浮点运算的成本构造 $\\mathbf{b} = \\mathbf{B}_{F}^{\\top} \\mathbf{w}$，然后以 $2 N_{p}^{2}$ 次浮点运算的成本求解 $\\mathbf{M}_{K} \\mathbf{y} = \\mathbf{b}$。因此，每个面的即时应用成本为\n$$\nC_{\\text{otf}}^{(F)} = 2 N_{p} N_{f} + 2 N_{p}^{2}.\n$$\n- 由于每个单元有 $6$ 个面，单次全局应用的每个单元成本为\n$$\nC_{\\text{otf}}^{(K)} = 6 \\left( 2 N_{p} N_{f} + 2 N_{p}^{2} \\right) = 12 N_{p} N_{f} + 12 N_{p}^{2}.\n$$\n在所有单元上，单次全局应用的总成本为\n$$\nC_{\\text{otf}} = N_{e} \\left( 12 N_{p} N_{f} + 12 N_{p}^{2} \\right).\n$$\n\n题目要求我们计算对于 $p=4$，策略1（构建所有 $\\mathbf{R}_{F}$ 算子）的总浮点运算次数与策略2单次即时应用（在所有单元的所有面上）的总浮点运算次数之比。该比率为\n$$\n\\mathcal{R} = \\frac{C_{\\text{pre}}}{C_{\\text{otf}}} = \\frac{N_{e} \\left( \\frac{1}{3} N_{p}^{3} + 12 N_{p}^{2} N_{f} \\right)}{N_{e} \\left( 12 N_{p} N_{f} + 12 N_{p}^{2} \\right)}.\n$$\n因子 $N_{e}$ 被消去。我们可以从分子和分母中提出公因子 $N_p^2$：\n$$\n\\mathcal{R} = \\frac{N_p^2 (\\frac{1}{3} N_p + 12 N_f)}{N_p (12 N_f + 12 N_p)} = \\frac{N_p (\\frac{1}{3} N_p + 12 N_f)}{12 (N_f + N_p)}.\n$$\n对于 $p=4$，我们代入 $N_{p} = 125$ 和 $N_{f} = 25$：\n$$\n\\mathcal{R} = \\frac{125 (\\frac{1}{3} \\cdot 125 + 12 \\cdot 25)}{12 (25 + 125)} = \\frac{125 (\\frac{125}{3} + 300)}{12 (150)} = \\frac{125 (\\frac{125+900}{3})}{1800} = \\frac{125 \\cdot \\frac{1025}{3}}{1800} = \\frac{125 \\cdot 1025}{3 \\cdot 1800} = \\frac{128125}{5400}.\n$$\n将分数化为最简形式：\n$$\n\\mathcal{R} = \\frac{128125 \\div 25}{5400 \\div 25} = \\frac{5125}{216}.\n$$\n这已经是最简形式，因为 $5125 = 5^3 \\cdot 41$ 和 $216 = 2^{3} \\cdot 3^{3}$ 没有共同的素因子。因此，精确比率为\n$$\n\\mathcal{R} = \\frac{5125}{216}.\n$$\n对此的解释是，对于 $p=4$ 的结构化六面体网格，在所述成本模型下，构建所有每个面的提升算子的成本是跨所有面执行单次全局即时提升应用的成本的 $\\frac{5125}{216}$ 倍。", "answer": "$$\\boxed{\\frac{5125}{216}}$$", "id": "3396038"}, {"introduction": "一个稳健的数值实现需要关注实现细节中的微妙之处。本练习深入探讨了多项式基函数的选择（例如，模态基与节点基）以及数值积分的精度（求积法则）如何影响最终计算出的提升算子。它清晰地揭示了精确的数学算子与其离散近似之间的差异，这是理解间断Galerkin方法精度与稳定性的一个核心概念。[@problem_id:3396023]", "problem": "考虑单个参考单元 $K$（例如，张量积区间或正方形）和多项式空间 $[\\mathbb{P}_p(K)]^d$，其中 $\\mathbb{P}_p(K)$ 表示在 $K$ 上总次数至多为 $p$ 的多项式，且 $d \\in \\{1,2,3\\}$。在二阶问题的内罚间断 Galerkin (DG) 公式中，一个典范提升算子 $R_h$ 将定义在 $\\partial K$ 上的面数据 $\\lambda$ 映射为一个矢量场 $R_h(\\lambda) \\in [\\mathbb{P}_p(K)]^d$，该映射通过与 $L^2(K)$ 内积相关的 Riesz 表示给出：对于所有 $v \\in [\\mathbb{P}_p(K)]^d$，\n$$\n(R_h(\\lambda), v)_{L^2(K)} \\;=\\; \\langle \\lambda, v \\cdot n \\rangle_{L^2(\\partial K)}.\n$$\n这里 $n$ 是 $\\partial K$ 上的外单位法向量。在实际实现中，$K$ 和 $\\partial K$ 上的内积通过精确计算或求积来计算，离散 Riesz 映射依赖于这些选择。\n\n两种常见的实现方式是：\n- 模态实现：使用一个在 $L^2(K)$ 上正交的 Legendre 多项式基（采用精确积分），因此在精确积分下，$K$ 上的质量矩阵是对角的。\n- 节点实现：使用与 Legendre-Gauss-Lobatto (LGL) 节点相关的节点基，并通过在每个坐标方向上使用 $p+1$ 个点的配置 LGL 求积来计算所有体积和面积分。\n\n需要使用的经过验证的求积事实：\n- 区间上的 $N$ 点 Gauss-Legendre (GL) 求积对于次数最高为 $2N-1$ 的多项式是精确的。\n- 区间上的 $(N+1)$ 点 Legendre-Gauss-Lobatto (LGL) 求积对于次数最高为 $2N-1$ 的多项式是精确的。\n- 张量积法则的精确度由一维次数的张量积给出。\n\n回答以下多项选择题。选择所有正确的陈述，并从第一性原理出发，明确引用 Riesz 映射的定义和求积的精确度来证明你的选择。\n\n关于提升算子的实现和求积精确度，以下哪些陈述是正确的？\n\nA. 使用模态 Legendre 基，并在体积和面上进行精确积分，对于所有 $\\lambda \\in \\mathbb{P}_p(\\partial K)$，计算出的提升算子与面泛函的精确 $L^2(K)$ Riesz 表示一致。\n\nB. 使用模态 Legendre 基，但体积和面积分都由 $(p+1)$ 点 LGL 求积近似，对于任意多项式面数据 $\\lambda$，所得提升算子与精确提升算子的差异仅在于每个单元中最高阶 Legendre 模态的系数；所有较低阶的模态系数都与精确提升算子匹配。\n\nC. 使用节点 LGL 基，并在体积和面上使用配置的 $(p+1)$ 点 LGL 求积，计算出的提升算子是关于求积诱导内积 $(\\cdot,\\cdot)_Q$ 的精确 Riesz 表示，而不是精确的 $L^2(K)$ 内积，且其相对于精确 $L^2(K)$ 提升算子的差异仅限于体积和面上次数为 $2p$ 的多项式的贡献。\n\nD. 为保证对于所有次数至多为 $p$ 的多项式面数据 $\\lambda$，离散提升算子与精确 $L^2(K)$ Riesz 映射一致，体积积分使用 $(p+1)$ 点 LGL 求积就足够了，而任何每个方向上至少有 $(p+1)$ 个点的面积分都是足够的。\n\nE. 如果在体积和每个面上都使用 $(p+1)$ 点 Gauss-Legendre 求积，那么对于所有 $\\lambda \\in \\mathbb{P}_p(\\partial K)$，模态和节点实现都会产生与精确 $L^2(K)$ Riesz 表示相同的提升系数。", "solution": "用户请求对一个关于间断 Galerkin 方法中提升算子的问题进行严格的验证和解答。\n\n### 问题验证\n\n**第1步：提取已知条件**\n\n*   **域**：单个参考单元 $K$（例如，张量积区间或正方形）。\n*   **多项式空间**：$[\\mathbb{P}_p(K)]^d$，矢量值多项式空间，其中每个分量是总次数至多为 $p$ 的多项式。维度 $d \\in \\{1,2,3\\}$。\n*   **提升算子**：$R_h$ 将面数据 $\\lambda$ 从 $\\partial K$ 映射到矢量场 $R_h(\\lambda) \\in [\\mathbb{P}_p(K)]^d$。\n*   **定义方程（Riesz 映射）**：对于所有测试函数 $v \\in [\\mathbb{P}_p(K)]^d$，提升算子 $R_h(\\lambda)$ 满足：\n    $$\n    (R_h(\\lambda), v)_{L^2(K)} = \\langle \\lambda, v \\cdot n \\rangle_{L^2(\\partial K)}\n    $$\n    其中 $n$ 是 $\\partial K$ 上的外单位法向量。\n*   **实现方式**：\n    1.  **模态**：使用 $L^2(K)$ 正交的 Legendre 多项式基。\n    2.  **节点**：使用与 Legendre-Gauss-Lobatto (LGL) 节点相关的节点基，并使用每个维度 $p+1$ 个点的配置 LGL 求积来计算积分。\n*   **求积法则**：\n    1.  区间上的 $N$ 点 Gauss-Legendre (GL) 求积对于次数最高为 $2N-1$ 的多项式是精确的。\n    2.  区间上的 $(N+1)$ 点 Legendre-Gauss-Lobatto (LGL) 求积对于次数最高为 $2N-1$ 的多项式是精确的。\n*   **面数据**：选项指定 $\\lambda \\in \\mathbb{P}_p(\\partial K)$。\n\n**第2步：使用提取的已知条件进行验证**\n\n*   **科学基础**：该问题牢固地植根于谱方法和间断 Galerkin (DG) 方法的理论中，这是数值分析中一个标准且成熟的领域。将提升算子定义为 Riesz 映射是典范的。\n*   **适定性**：问题要求基于所提供的定义和事实评估几个陈述。这是一个定义明确的任务，有一组可确定的正确答案。\n*   **客观性**：问题以精确、客观的数学语言陈述，没有主观或模糊的术语。\n*   **完整性和一致性**：问题提供了所有必要的定义（提升算子、多项式空间、内积）和事实（求积法则）来分析这些陈述。没有内部矛盾。\n\n**第3步：结论与行动**\n\n问题陈述在科学上是合理的、适定的、客观的和自洽的。它是有效的。我现在将进行解答。\n\n### 推导\n\n问题的核心在于理解数值计算的提升算子 $R_{h,Q}(\\lambda)$ 何时等于精确的提升算子 $R_h(\\lambda)$。精确的提升算子是 $[\\mathbb{P}_p(K)]^d$ 中满足定义方程的唯一元素。\n\n设 $\\{\\phi_i\\}_{i=1}^M$ 为 $[\\mathbb{P}_p(K)]^d$ 的一组基。我们可以将提升算子表示为 $R_h(\\lambda) = \\sum_{j=1}^M r_j \\phi_j$。将其代入定义方程，并对每个基函数 $\\phi_i$ 进行测试，得到一个关于系数 $r = (r_j)$ 的线性系统：\n$$ \\sum_{j=1}^M \\underbrace{(\\phi_j, \\phi_i)_{L^2(K)}}_{M_{ij}} r_j = \\underbrace{\\langle \\lambda, \\phi_i \\cdot n \\rangle_{L^2(\\partial K)}}_{F_i} \\implies Mr = F $$\n其中 $M$ 是质量矩阵，$F$ 是载荷向量。精确解为 $r = M^{-1}F$。\n\n数值实现用求积法则代替了精确积分，从而得到计算出的质量矩阵 $M_Q$ 和计算出的载荷向量 $F_Q$。计算出的系数为 $r_Q = M_Q^{-1} F_Q$。计算出的提升算子 $R_{h,Q}(\\lambda)$ 等于精确的提升算子 $R_h(\\lambda)$ 当且仅当系数完全相同，即 $r_Q = r$。这当且仅当求积对所有涉及的积分都是精确的时才会发生，即 $M_Q = M$ 和 $F_Q = F$。\n\n让我们确定求积法则所需的精确度。\n1.  **质量矩阵被积函数**：$M$ 的元素是 $\\phi_j \\cdot \\phi_i$ 在 $K$ 上的积分。由于 $\\phi_i, \\phi_j \\in [\\mathbb{P}_p(K)]^d$，它们的点积是总次数至多为 $p$ 的多项式乘积之和。所得被积函数的总次数至多为 $p+p=2p$。\n2.  **载荷向量被积函数**：$F$ 的元素是 $\\lambda (v \\cdot n)$ 在 $\\partial K$ 上的积分。问题考虑 $\\lambda \\in \\mathbb{P}_p(\\partial K)$。测试函数的分量是 $\\mathbb{P}_p(K)$ 中多项式的迹，因此它们属于 $\\mathbb{P}_p(\\partial K)$。因此，每个面上的被积函数的次数至多为 $p+p=2p$。\n\n因此，为了保证对于所有 $\\lambda \\in \\mathbb{P}_p(\\partial K)$ 都有 $R_{h,Q}(\\lambda) = R_h(\\lambda)$，用于质量矩阵的体积求积和用于载荷向量的面积分求积都必须对次数至多为 $2p$ 的多项式是精确的。\n\n让我们分析所提供的求积法则：\n*   **$(p+1)$ 点 GL 求积**：在“对于次数 $2N-1$ 是精确的”法则中令 $N=p+1$，得到精确度为 $2(p+1)-1 = 2p+1$。这足以精确地积分次数为 $2p$ 的多项式。\n*   **$(p+1)$ 点 LGL 求积**：在“对于次数 $2N-1$ 是精确的”法则中令 $N+1=p+1 \\implies N=p$，得到精确度为 $2p-1$。这**不足以**精确地积分次数为 $2p$ 的多项式。\n\n### 逐项分析\n\n**A. 使用模态 Legendre 基，并在体积和面上进行精确积分，对于所有 $\\lambda \\in \\mathbb{P}_p(\\partial K)$，计算出的提升算子与面泛函的精确 $L^2(K)$ Riesz 表示一致。**\n\n该陈述假定使用“精确积分”。这意味着计算出的质量矩阵 $M_Q$ 与精确的质量矩阵 $M$ 相同，计算出的载荷向量 $F_Q$ 与精确的载荷向量 $F$ 相同。根据定义，系统 $Mr=F$ 的解给出了精确 $L^2(K)$ Riesz 表示的系数。由于计算使用了精确的矩阵和向量，结果必然是精确的 Riesz 表示。基的选择（模态 Legendre）对此结论是附带的；对于任何基，这都是正确的。\n\n**结论：正确。**\n\n**B. 使用模态 Legendre 基，但体积和面积分都由 $(p+1)$ 点 LGL 求积近似，对于任意多项式面数据 $\\lambda$，所得提升算子与精确提升算子的差异仅在于每个单元中最高阶 Legendre 模态的系数；所有较低阶的模态系数都与精确提升算子匹配。**\n\n设基 $\\{\\phi_i\\}$ 按多项式次数排序。我们使用 $(p+1)$ 点 LGL 求积，它对于次数 $2p-1$ 是精确的。\n质量矩阵为 $M_{ij} = (\\phi_j, \\phi_i)_{L^2(K)}$。对于模态 Legendre 基，$M$ 是单位矩阵 ($I$)。计算出的质量矩阵 $(M_Q)_{ij}$ 是使用求积得到的。被积函数 $\\phi_j \\cdot \\phi_i$ 的次数为 $\\deg(\\phi_j) + \\deg(\\phi_i)$。如果 $\\deg(\\phi_j) + \\deg(\\phi_i) \\le 2p-1$，则积分是精确的。如果我们将基划分为次数小于 $p$ 的函数（低阶）和次数等于 $p$ 的函数（高阶），则计算出的质量矩阵 $M_Q$ 是块对角的，具体为 $\\begin{pmatrix} I  & 0 \\\\ 0 & M_{hh,Q} \\end{pmatrix}$，其中 $M_{hh,Q}$ 是高阶模态的子矩阵，且不等于单位矩阵。\n载荷向量为 $F_i = \\langle \\lambda, \\phi_i \\cdot n \\rangle_{L^2(\\partial K)}$。被积函数的次数最高为 $\\deg(\\lambda) + \\deg(\\phi_i)$。假设 $\\lambda \\in \\mathbb{P}_p(\\partial K)$，则次数最高为 $p + \\deg(\\phi_i)$。如果 $p + \\deg(\\phi_i) \\le 2p-1$，即 $\\deg(\\phi_i) \\le p-1$，则积分是精确的。因此，低阶模态的载荷向量分量被精确计算 ($F_{l,Q} = F_l$)，但高阶模态则不然 ($F_{h,Q} \\neq F_h$)。\n计算出的系数 $r_Q$ 解 $M_Q r_Q = F_Q$。这解耦为 $I r_{l,Q} = F_{l,Q}$ 和 $M_{hh,Q} r_{h,Q} = F_{h,Q}$。由第一个方程，我们有 $r_{l,Q} = F_{l,Q} = F_l$，这是低阶模态的精确系数。高阶系数 $r_{h,Q}$ 与精确系数不同。\n分析证实，误差仅限于次数为 $p$ 的基函数的系数。然而，该陈述声称误差“仅在于……**那个**最高阶 Legendre 模态的系数”。这种措辞暗示存在唯一的最高阶模态。这仅在一维 ($d=1$) 时成立。对于 $d>1$（例如，在正方形上），空间 $\\mathbb{P}_p(K)$ 包含多个最高次数为 $p$ 的基函数（例如，当 $p=2$ 时，有 $x^2, xy, y^2$）。因此，对于问题设置中描述的一般情况，该陈述在形式上是不正确的。严谨的评估必须因其不精确而拒绝它。\n\n**结论：不正确。**\n\n**C. 使用节点 LGL 基，并在体积和面上使用配置的 $(p+1)$ 点 LGL 求积，计算出的提升算子是关于求积诱导内积 $(\\cdot,\\cdot)_Q$ 的精确 Riesz 表示，而不是精确的 $L^2(K)$ 内积，且其相对于精确 $L^2(K)$ 提升算子的差异仅限于体积和面上次数为 $2p$ 的多项式的贡献。**\n\n计算出的提升算子 $R_{h,Q}(\\lambda)$ 是通过求解 $(R_{h,Q}, v)_Q = \\langle \\lambda, v \\cdot n \\rangle_Q$ 对于所有 $v \\in [\\mathbb{P}_p(K)]^d$ 得到的。这正是赋予以离散内积 $(\\cdot,\\cdot)_Q$ 的空间 $[\\mathbb{P}_p(K)]^d$ 中 Riesz 表示的定义。所以陈述的第一部分根据定义是正确的。\n差异产生的原因是 $(\\cdot,\\cdot)_Q \\neq (\\cdot,\\cdot)_{L^2(K)}$ 和 $\\langle\\cdot,\\cdot\\rangle_Q \\neq \\langle\\cdot,\\cdot\\rangle_{L^2(\\partial K)}$。$(p+1)$ 点 LGL 求积对次数至多为 $2p-1$ 的多项式是精确的。质量矩阵和载荷向量的被积函数次数最高可达 $2p$。对于任何次数 $\\le 2p-1$ 的多项式被积函数，求积误差泛函为零。求积不精确的第一个次数是 $2p$。因此，计算解与精确解之间任何差异的来源都源于求积法则未能精确积分次数为 $2p$ 的多项式。陈述中“差异仅限于……次数为 $2p$ 的多项式的贡献”正确地指出了这个来源。\n\n**结论：正确。**\n\n**D. 为保证对于所有次数至多为 $p$ 的多项式面数据 $\\lambda$，离散提升算子与精确 $L^2(K)$ Riesz 映射一致，体积积分使用 $(p+1)$ 点 LGL 求积就足够了，而任何每个方向上至少有 $(p+1)$ 个点的面积分都是足够的。**\n\n为了保证计算出的提升算子与精确的提升算子相同，体积和面积分求积都必须对次数至多为 $2p$ 的多项式是精确的。该陈述建议对体积积分使用 $(p+1)$ 点 LGL 求积。如前所述，此法则仅对次数至多为 $2p-1$ 的多项式是精确的。因此，它不足以精确计算质量矩阵，因为一些元素涉及次数为 $2p$ 的多项式的积分。仅凭这一点，该陈述就是错误的。\n\n**结论：不正确。**\n\n**E. 如果在体积和每个面上都使用 $(p+1)$ 点 Gauss-Legendre 求积，那么对于所有 $\\lambda \\in \\mathbb{P}_p(\\partial K)$，模态和节点实现都会产生与精确 $L^2(K)$ Riesz 表示相同的提升系数。**\n\n如前所推导，要确保计算出的提升算子与精确的提升算子相同，需要求积法则对次数至多为 $2p$ 的多项式是精确的。$(p+1)$ 点 Gauss-Legendre (GL) 求积法则对次数至多为 $2(p+1)-1 = 2p+1$ 的多项式是精确的。由于 $2p+1 \\ge 2p$，此法则足以精确计算质量矩阵和载荷向量的元素。这意味着 $M_Q = M$ 和 $F_Q = F$。因此，计算出的系数 $r_Q = M_Q^{-1}F_Q$ 将与精确系数 $r=M^{-1}F$ 相同。这个结论与基的选择（模态或节点）无关，因为由这些系数表示的底层函数 $R_h(\\lambda)$ 是唯一的。\n\n**结论：正确。**", "answer": "$$\\boxed{ACE}$$", "id": "3396023"}]}