{"hands_on_practices": [{"introduction": "数值通量的选择对间断 Galerkin (DG) 方法的稳定性至关重要。虽然中心通量因其简单和在半离散层面上的能量守恒特性（正如在练习 [@problem_id:3394335] 中所证明的）而具有吸引力，但这种无耗散的特性在与简单的时间积分格式（如前向欧拉法）结合时，可能会导致灾难性的不稳定性。本练习 [@problem_id:3394374] 提供了一个经典的警示案例，通过冯·诺依曼稳定性分析，您将亲手计算并揭示一个看似合理的数值格式如何导致能量无界增长，从而深刻理解数值耗散在确保稳定性中的作用。", "problem": "考虑线性平流方程 $u_{t} + a\\,u_{x} = 0$，其中波速 $a \\in \\mathbb{R}\\setminus\\{0\\}$ 为常数，定义在周期性域 $x \\in [0,2\\pi]$ 上。使用间断 Galerkin (DG) 方法，将该域离散为 $N$ 个宽度为 $h = \\frac{2\\pi}{N}$ 的均匀单元，并在每个单元上用分片常数函数（零次多项式）来近似 $u$。在界面处采用中心数值通量，定义为 $\\widehat{u} = \\frac{1}{2}\\left(u^{-} + u^{+}\\right)$，并使用时间步长为 $\\Delta t > 0$ 的前向 Euler 方法进行时间推进。将单元常数向量 $(u_{j})_{j=0}^{N-1}$ 的离散 $L^{2}$ 能量定义为 $E = h \\sum_{j=0}^{N-1} |u_{j}|^{2}$。\n\n从每个单元上测试函数为 $v \\equiv 1$ 的弱形式和界面处的通量平衡出发，推导单元平均值的半离散更新格式以及相应的前向 Euler 步。然后，考虑均匀网格上的离散 Fourier 模 $u_{j}^{n} = \\alpha^{n} \\exp\\!\\big(i\\,\\theta\\,j\\big)$，其中 $\\theta = \\frac{\\pi}{2}$，并确定此模式下离散 $L^{2}$ 能量的单步放大因子，该因子定义为比率 $\\frac{E^{n+1}}{E^{n}}$。\n\n请以 $a$、$\\Delta t$ 和 $h$ 的单个闭式表达式给出最终答案。无需进行数值计算。", "solution": "首先验证该问题，以确保其具有科学依据、适定且客观。\n该问题要求推导用于线性平流方程的间断 Galerkin (DG) 格式的离散 $L^2$ 能量的单步放大因子。\n\n从问题陈述中提取的已知条件：\n-   偏微分方程：$u_{t} + a\\,u_{x} = 0$，其中 $a \\in \\mathbb{R}\\setminus\\{0\\}$ 是恒定波速。\n-   域：$x \\in [0, 2\\pi]$，周期性。\n-   离散化：$N$ 个均匀单元 $K_j = [x_{j-1/2}, x_{j+1/2}]$，宽度为 $h = \\frac{2\\pi}{N}$。\n-   近似空间：每个单元上的分片常数函数（多项式次数 $p=0$）。单元 $K_j$ 中的解由常数值 $u_j$ 表示。\n-   数值通量：中心通量 $\\widehat{u} = \\frac{1}{2}\\left(u^{-} + u^{+}\\right)$，其中 $u^{-}$ 和 $u^{+}$ 分别是界面左右单元的值。\n-   时间积分：前向 Euler 方法，时间步长 $\\Delta t > 0$。\n-   测试函数：在每个单元上 $v \\equiv 1$。\n-   离散 $L^2$ 能量定义：$E = h \\sum_{j=0}^{N-1} |u_{j}|^{2}$。\n-   用于分析的 Fourier 模：$u_{j}^{n} = \\alpha^{n} \\exp\\!\\big(i\\,\\theta\\,j\\big)$，波数 $\\theta = \\frac{\\pi}{2}$。\n-   目标：求此模式下的能量放大因子 $\\frac{E^{n+1}}{E^{n}}$。\n\n该问题是有效的。这是一个对基本双曲型偏微分方程的一种广泛使用的数值方法 (DG-P0) 进行的标准 von Neumann 稳定性分析。所有组成部分都已明确定义，问题是自洽且数学上适定的。没有科学缺陷、歧义或矛盾。\n\n我们开始求解。\n\n首先，我们推导半离散格式。从偏微分方程 $u_{t} + a\\,u_{x} = 0$ 开始。我们将其乘以一个测试函数 $v$，并在单元 $K_j = [x_{j-1/2}, x_{j+1/2}]$ 上积分：\n$$\n\\int_{K_j} u_t v \\,dx + \\int_{K_j} a u_x v \\,dx = 0\n$$\n对于分片常数近似 $u(x,t) = u_j(t)$（$x \\in K_j$）和指定的常数测试函数 $v(x) = 1$（$x \\in K_j$），第一项变为：\n$$\n\\int_{K_j} \\frac{d u_j}{dt} (1) \\,dx = \\frac{d u_j}{dt} \\int_{K_j} dx = h \\frac{d u_j}{dt}\n$$\n第二项进行分部积分：\n$$\n\\int_{K_j} a u_x v \\,dx = a [u v]_{x_{j-1/2}}^{x_{j+1/2}} - a \\int_{K_j} u v_x \\,dx\n$$\n由于 $v$ 在单元上是常数，其导数 $v_x = 0$，所以右侧的积分项为零。边界项使用数值通量进行计算。物理通量为 $f(u) = au$。界面处的数值通量为 $\\widehat{f} = a \\widehat{u}$。DG 方法的分部积分公式为：\n$$\n\\int_{K_j} a u_x v \\,dx = a \\left( \\widehat{u}(x_{j+1/2}) v(x_{j+1/2}^-) - \\widehat{u}(x_{j-1/2}) v(x_{j-1/2}^+) \\right)\n$$\n其中 $v$ 的值从单元 $K_j$ 内部取，即 $v(x_{j+1/2}^-) = v(x_{j-1/2}^+) = 1$。数值通量的值由中心通量公式给出：\n-   在界面 $x_{j+1/2}$ 处：$\\widehat{u}_{j+1/2} = \\frac{1}{2}(u_j + u_{j+1})$。\n-   在界面 $x_{j-1/2}$ 处：$\\widehat{u}_{j-1/2} = \\frac{1}{2}(u_{j-1} + u_j)$。\n将这些代入弱形式，我们得到：\n$$\nh \\frac{d u_j}{dt} + a \\left( \\frac{u_j + u_{j+1}}{2} - \\frac{u_{j-1} + u_j}{2} \\right) = 0\n$$\n化简括号中的项得到：\n$$\nh \\frac{d u_j}{dt} + a \\left( \\frac{u_{j+1} - u_{j-1}}{2} \\right) = 0\n$$\n这就得到了单元平均值 $u_j$ 的半离散常微分方程：\n$$\n\\frac{d u_j}{dt} = - \\frac{a}{2h} (u_{j+1} - u_{j-1})\n$$\n\n接下来，我们应用前向 Euler 方法进行时间离散：$\\frac{u_j^{n+1} - u_j^n}{\\Delta t} = \\frac{d u_j}{dt}\\Big|_n$。\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} = - \\frac{a}{2h} (u_{j+1}^n - u_{j-1}^n)\n$$\n全离散更新规则为：\n$$\nu_j^{n+1} = u_j^n - \\frac{a \\Delta t}{2h} (u_{j+1}^n - u_{j-1}^n)\n$$\n令 $\\lambda = \\frac{a \\Delta t}{h}$ 为 Courant 数。该格式为：\n$$\nu_j^{n+1} = u_j^n - \\frac{\\lambda}{2} (u_{j+1}^n - u_{j-1}^n)\n$$\n现在，我们通过代入离散 Fourier 模 $u_j^n = \\alpha^n \\exp(i \\theta j)$ 来进行 von Neumann 稳定性分析：\n$$\n\\alpha^{n+1} \\exp(i \\theta j) = \\alpha^n \\exp(i \\theta j) - \\frac{\\lambda}{2} \\left[ \\alpha^n \\exp(i \\theta (j+1)) - \\alpha^n \\exp(i \\theta (j-1)) \\right]\n$$\n我们用 $\\alpha^n \\exp(i \\theta j)$ 除以两边：\n$$\n\\alpha = 1 - \\frac{\\lambda}{2} \\left[ \\exp(i \\theta) - \\exp(-i \\theta) \\right]\n$$\n使用 Euler 公式 $\\exp(i\\theta) - \\exp(-i\\theta) = 2i \\sin(\\theta)$，放大因子 $\\alpha$ 变为：\n$$\n\\alpha = 1 - i \\lambda \\sin(\\theta)\n$$\n问题要求的是离散 $L^2$ 能量 $E^n = h \\sum_{j=0}^{N-1} |u_j^n|^2$ 的单步放大因子。\n让我们计算比率 $\\frac{E^{n+1}}{E^n}$。\n$$\nE^{n+1} = h \\sum_{j=0}^{N-1} |u_j^{n+1}|^2 = h \\sum_{j=0}^{N-1} |\\alpha u_j^n|^2 = h \\sum_{j=0}^{N-1} |\\alpha|^2 |u_j^n|^2 = |\\alpha|^2 \\left( h \\sum_{j=0}^{N-1} |u_j^n|^2 \\right) = |\\alpha|^2 E^n\n$$\n因此，能量放大因子为 $\\frac{E^{n+1}}{E^n} = |\\alpha|^2$。\n我们现在计算 $|\\alpha|^2$：\n$$\n|\\alpha|^2 = \\alpha \\overline{\\alpha} = (1 - i \\lambda \\sin(\\theta))(1 + i \\lambda \\sin(\\theta)) = 1^2 - (i \\lambda \\sin(\\theta))^2 = 1 - i^2 \\lambda^2 \\sin^2(\\theta) = 1 + \\lambda^2 \\sin^2(\\theta)\n$$\n问题指定对 $\\theta = \\frac{\\pi}{2}$ 的模式进行分析。对于此模式，$\\sin(\\theta) = \\sin(\\frac{\\pi}{2}) = 1$。\n代入该值，能量放大因子为：\n$$\n\\frac{E^{n+1}}{E^n} = 1 + \\lambda^2 (1)^2 = 1 + \\lambda^2\n$$\n最后，我们将 $\\lambda = \\frac{a \\Delta t}{h}$ 代回，用给定的参数 $a$、$\\Delta t$ 和 $h$ 来表示结果：\n$$\n\\frac{E^{n+1}}{E^n} = 1 + \\left(\\frac{a \\Delta t}{h}\\right)^2\n$$\n这个结果对于任何 $\\Delta t > 0$ 都大于 1，表明采用中心通量和前向 Euler 时间步进的 DG-P0 方法是无条件不稳定的。", "answer": "$$\n\\boxed{1 + \\left(\\frac{a \\Delta t}{h}\\right)^{2}}\n$$", "id": "3394374"}, {"introduction": "在见证了无耗散的中心通量如何导致不稳定性之后，一个自然的问题是如何修复这个问题。本练习 [@problem_id:3394373] 直接回应了这一挑战，它引入了一个包含可调耗散项的参数化数值通量。通过执行类似的稳定性分析，您将推导出保证格式能量不再增长所需的最小耗散量。这个过程将抽象的稳定性理论与数值格式中的具体参数联系起来，展示了如何通过精确地添加“人工”耗散来“驯服”一个不稳定的格式。", "problem": "考虑一维线性平流方程 $u_{t} + a\\,u_{x} = 0$，其中平流速度 $a \\in \\mathbb{R}$ 为常数，定义在周期性域上。用宽度为 $h$ 的均匀网格单元对空间域进行离散化，并应用多项式次数为零（分片常数）的间断 Galerkin (DG) 方法，使用精确质量矩阵，使得每个单元中的单元平均值是唯一的自由度。使用时间步长为 $\\Delta t$ 的显式前向欧拉时间积分器，并假设 Courant–Friedrichs–Lewy (CFL) 数 $\\sigma := \\frac{a\\,\\Delta t}{h}$ 满足 $0  \\sigma \\leq 1$。在每个单元界面上，使用由下式定义的单参数相容数值通量族：\n$$\nf^{*}\\!\\left(u^{-},u^{+}\\right) \\;=\\; a\\,\\frac{u^{-}+u^{+}}{2} \\;-\\; \\frac{\\lambda}{2}\\,\\left(u^{+}-u^{-}\\right),\n$$\n其中 $u^{-}$ 和 $u^{+}$ 分别表示界面左侧和右侧的 $u$ 的内部迹，而 $\\lambda \\ge 0$ 是一个常数通量参数，其物理单位与 $a$ 相同。\n\n对此全离散格式进行 von Neumann 分析，假设单元索引具有周期性且为单一傅里叶模态。推导放大因子 $G(\\theta)$ 作为无量纲波数 $\\theta \\in [-\\pi,\\pi]$ 的函数。然后，施加条件，即对于任何傅里叶模态，解的离散 $L^{2}$ 范数在一个前向欧拉步中不增加，这等价于要求对于所有 $\\theta \\in [-\\pi,\\pi]$ 都有 $|G(\\theta)| \\leq 1$。在所述的 CFL 约束 $0  \\sigma \\le 1$ 下，确定通量参数 $\\lambda_{\\min}$ 的最小值（表示为关于 $a$、$\\Delta t$ 和 $h$ 的符号解析表达式），该值保证对所有傅里叶模态都满足非增 $L^{2}$ 条件。\n\n您的最终答案必须是 $\\lambda_{\\min}$ 的一个单一闭式解析表达式，表达式中不包含任何单位。", "solution": "用户希望找到通量参数 $\\lambda$ 的最小值，以确保应用于线性平流方程的间断 Galerkin (DG) 格式的 $L^2$ 稳定性。验证和求解过程如下。\n\n### 第1步：提取已知条件\n-   **方程**：$u_{t} + a\\,u_{x} = 0$，其中 $a \\in \\mathbb{R}$ 是一个常数。\n-   **域**：周期性。\n-   **离散化**：单元宽度为 $h$ 的均匀网格。\n-   **方法**：零次多项式（DG-P0）的间断 Galerkin 方法。\n-   **质量矩阵**：精确。\n-   **时间积分**：时间步长为 $\\Delta t$ 的显式前向欧拉法。\n-   **CFL 条件**：$\\sigma := \\frac{a\\,\\Delta t}{h}$ 满足 $0  \\sigma \\leq 1$。\n-   **数值通量**：$f^{*}\\!\\left(u^{-},u^{+}\\right) \\;=\\; a\\,\\frac{u^{-}+u^{+}}{2} \\;-\\; \\frac{\\lambda}{2}\\,\\left(u^{+}-u^{-}\\right)$，其中 $\\lambda \\ge 0$。\n-   **分析**：von Neumann 稳定性分析。\n-   **稳定性条件**：放大因子 $G(\\theta)$ 必须对所有无量纲波数 $\\theta \\in [-\\pi,\\pi]$ 满足 $|G(\\theta)| \\leq 1$。\n-   **目标**：找到保证稳定性条件的通量参数 $\\lambda$ 的最小值 $\\lambda_{\\min}$。\n\n### 第2步：使用提取的已知条件进行验证\n-   **科学依据**：该问题在偏微分方程数值分析领域有坚实的理论基础。它描述了一个用于线性平流方程的标准 DG-P0 格式，并使用了经典的 von Neumann 稳定性分析，该分析适用于周期域上的线性常系数问题。\n-   **适定性**：该问题是适定的。它提供了所有必要的信息：偏微分方程、离散化方法、数值通量、时间步进格式以及一个精确的稳定性判据。目标是找到一个唯一定义的量 $\\lambda_{\\min}$。\n-   **客观性**：该问题以精确、客观的数学语言陈述，没有歧义或主观陈述。\n\n该问题没有表现出问题验证清单中列出的任何缺陷（例如，科学不严谨、不完整、模糊）。这是一个计算流体力学中的标准、可解问题。\n\n### 第3步：结论与行动\n该问题是有效的。将推导一个完整的解。\n\n### 解的推导\n\n在单元 $I_j = [x_{j-1/2}, x_{j+1/2}]$ 上对 $u_{t} + a\\,u_{x} = 0$ 的 DG-P0 半离散化使用分片常数基函数和检验函数。对于单元平均值 $u_j(t)$，该格式由下式给出：\n$$\nh \\frac{du_j}{dt} + f^*(x_{j+1/2}) - f^*(x_{j-1/2}) = 0\n$$\n其中 $f^*(x_{j+1/2})$ 是单元 $j$ 和 $j+1$ 之间界面上的数值通量，$f^*(x_{j-1/2})$ 是单元 $j-1$ 和 $j$ 之间界面上的通量。这些界面上的状态分别为 $u^- = u_j, u^+ = u_{j+1}$ 和 $u^- = u_{j-1}, u^+ = u_j$。\n\n代入给定的数值通量 $f^{*}\\!\\left(u^{-},u^{+}\\right) \\;=\\; a\\,\\frac{u^{-}+u^{+}}{2} \\;-\\; \\frac{\\lambda}{2}\\,\\left(u^{+}-u^{-}\\right)$：\n$$\nf^*(x_{j+1/2}) = a\\,\\frac{u_{j}+u_{j+1}}{2} - \\frac{\\lambda}{2}\\,(u_{j+1}-u_j)\n$$\n$$\nf^*(x_{j-1/2}) = a\\,\\frac{u_{j-1}+u_{j}}{2} - \\frac{\\lambda}{2}\\,(u_{j}-u_{j-1})\n$$\n半离散方程变为：\n$$\nh \\frac{du_j}{dt} = - \\left( a\\,\\frac{u_{j}+u_{j+1}}{2} - \\frac{\\lambda}{2}\\,(u_{j+1}-u_j) \\right) + \\left( a\\,\\frac{u_{j-1}+u_{j}}{2} - \\frac{\\lambda}{2}\\,(u_{j}-u_{j-1}) \\right)\n$$\n展开并合并关于 $u_{j-1}$、$u_j$ 和 $u_{j+1}$ 的项：\n$$\nh \\frac{du_j}{dt} = u_{j+1}\\left(-\\frac{a}{2} + \\frac{\\lambda}{2}\\right) + u_j\\left(-\\frac{a}{2} - \\frac{\\lambda}{2} + \\frac{a}{2} - \\frac{\\lambda}{2}\\right) + u_{j-1}\\left(\\frac{a}{2} + \\frac{\\lambda}{2}\\right)\n$$\n$$\nh \\frac{du_j}{dt} = \\frac{\\lambda-a}{2} u_{j+1} - \\lambda u_j + \\frac{\\lambda+a}{2} u_{j-1}\n$$\n应用显式前向欧拉时间积分，$u_j^{n+1} = u_j^n + \\Delta t \\frac{du_j}{dt}|_n$：\n$$\nu_j^{n+1} = u_j^n + \\frac{\\Delta t}{h} \\left( \\frac{\\lambda+a}{2} u_{j-1}^n - \\lambda u_j^n + \\frac{\\lambda-a}{2} u_{j+1}^n \\right)\n$$\n对于 von Neumann 分析，我们假设单一傅里叶模态解 $u_j^n = (G(\\theta))^n e^{ij\\theta}$，其中 $\\theta=kh$ 是无量纲波数。将此代入格式中：\n$$\nG(\\theta) e^{ij\\theta} = e^{ij\\theta} + \\frac{\\Delta t}{h} \\left( \\frac{\\lambda+a}{2} e^{i(j-1)\\theta} - \\lambda e^{ij\\theta} + \\frac{\\lambda-a}{2} e^{i(j+1)\\theta} \\right)\n$$\n两边除以 $e^{ij\\theta}$：\n$$\nG(\\theta) = 1 + \\frac{\\Delta t}{h} \\left( \\frac{\\lambda+a}{2} e^{-i\\theta} - \\lambda + \\frac{\\lambda-a}{2} e^{i\\theta} \\right)\n$$\n我们使用定义 $\\sigma = \\frac{a\\Delta t}{h}$ 并引入 $\\tilde{\\lambda} = \\frac{\\lambda\\Delta t}{h}$ 来组合各项：\n$$\nG(\\theta) = 1 - \\tilde{\\lambda} + \\frac{\\tilde{\\lambda}}{2}(e^{i\\theta} + e^{-i\\theta}) + \\frac{\\sigma}{2}(e^{-i\\theta} - e^{i\\theta})\n$$\n使用欧拉恒等式 $e^{i\\theta}+e^{-i\\theta} = 2\\cos\\theta$ 和 $e^{i\\theta}-e^{-i\\theta} = 2i\\sin\\theta$：\n$$\nG(\\theta) = 1 - \\tilde{\\lambda} + \\tilde{\\lambda}\\cos\\theta - i\\sigma\\sin\\theta = 1 + \\tilde{\\lambda}(\\cos\\theta-1) - i\\sigma\\sin\\theta\n$$\n为了 $L^2$ 稳定性，我们需要 $|G(\\theta)|^2 \\le 1$。\n$$\n|G(\\theta)|^2 = \\left(1 + \\tilde{\\lambda}(\\cos\\theta-1)\\right)^2 + (-\\sigma\\sin\\theta)^2 \\le 1\n$$\n$$\n1 + 2\\tilde{\\lambda}(\\cos\\theta-1) + \\tilde{\\lambda}^2(\\cos\\theta-1)^2 + \\sigma^2\\sin^2\\theta \\le 1\n$$\n两边减 1：\n$$\n2\\tilde{\\lambda}(\\cos\\theta-1) + \\tilde{\\lambda}^2(\\cos\\theta-1)^2 + \\sigma^2\\sin^2\\theta \\le 0\n$$\n使用恒等式 $\\sin^2\\theta = 1-\\cos^2\\theta = (1-\\cos\\theta)(1+\\cos\\theta) = -(\\cos\\theta-1)(1+\\cos\\theta)$：\n$$\n2\\tilde{\\lambda}(\\cos\\theta-1) + \\tilde{\\lambda}^2(\\cos\\theta-1)^2 - \\sigma^2(\\cos\\theta-1)(1+\\cos\\theta) \\le 0\n$$\n我们可以提取公因式 $(\\cos\\theta-1)$。对于 $\\theta \\neq 0$，$\\cos\\theta-1  0$。对于 $\\theta=0$，不等式为 $0 \\le 0$。对于 $\\theta \\in (-\\pi, \\pi) \\setminus \\{0\\}$，我们两边除以 $(\\cos\\theta-1)$ 并将不等号反向：\n$$\n2\\tilde{\\lambda} + \\tilde{\\lambda}^2(\\cos\\theta-1) - \\sigma^2(1+\\cos\\theta) \\ge 0\n$$\n让我们将各项重组为关于 $y = \\cos\\theta$ 的线性函数，其中 $y$ 在 $[-1,1]$ 范围内变化：\n$$\n(\\tilde{\\lambda}^2 - \\sigma^2)y + (2\\tilde{\\lambda} - \\tilde{\\lambda}^2 - \\sigma^2) \\ge 0\n$$\n要使这个关于 $y$ 的线性函数在区间 $[-1, 1]$ 上为非负，它必须在端点 $y=-1$ 和 $y=1$ 处为非负。\n\n情况1：$y = 1$ (对应于 $\\theta=0$)\n$$\n(\\tilde{\\lambda}^2 - \\sigma^2)(1) + (2\\tilde{\\lambda} - \\tilde{\\lambda}^2 - \\sigma^2) \\ge 0\n$$\n$$\n2\\tilde{\\lambda} - 2\\sigma^2 \\ge 0 \\implies \\tilde{\\lambda} \\ge \\sigma^2\n$$\n\n情况2：$y = -1$ (对应于 $\\theta=\\pm\\pi$)\n$$\n(\\tilde{\\lambda}^2 - \\sigma^2)(-1) + (2\\tilde{\\lambda} - \\tilde{\\lambda}^2 - \\sigma^2) \\ge 0\n$$\n$$\n-\\tilde{\\lambda}^2 + \\sigma^2 + 2\\tilde{\\lambda} - \\tilde{\\lambda}^2 - \\sigma^2 \\ge 0\n$$\n$$\n-2\\tilde{\\lambda}^2 + 2\\tilde{\\lambda} \\ge 0 \\implies 2\\tilde{\\lambda}(1-\\tilde{\\lambda}) \\ge 0\n$$\n已知 $\\lambda \\ge 0$ (且 $\\Delta t, h > 0$)，我们有 $\\tilde{\\lambda} \\ge 0$。因此，为使不等式成立，我们必须有：\n$$\n1-\\tilde{\\lambda} \\ge 0 \\implies \\tilde{\\lambda} \\le 1\n$$\n\n综合两个条件，该格式是 $L^2$ 稳定的，当且仅当 $\\tilde{\\lambda}$ 满足：\n$$\n\\sigma^2 \\le \\tilde{\\lambda} \\le 1\n$$\n这个条件与问题的 CFL 约束 $0  \\sigma \\le 1$ 一致，后者确保了 $\\sigma^2 \\le 1$ 且 $\\tilde{\\lambda}$ 的区间非空。\n\n我们需要求 $\\lambda$ 的最小值，记作 $\\lambda_{\\min}$，以保证稳定性。这对应于 $\\tilde{\\lambda}$ 的最小有效值，即推导区间的下界：\n$$\n\\tilde{\\lambda}_{\\min} = \\sigma^2\n$$\n代入 $\\tilde{\\lambda}$ 和 $\\sigma$ 的定义：\n$$\n\\frac{\\lambda_{\\min} \\Delta t}{h} = \\left(\\frac{a \\Delta t}{h}\\right)^2\n$$\n解出 $\\lambda_{\\min}$：\n$$\n\\lambda_{\\min} = \\left(\\frac{a^2 (\\Delta t)^2}{h^2}\\right) \\frac{h}{\\Delta t} = a^2 \\frac{\\Delta t}{h}\n$$\n这是在约束 $0  \\sigma \\le 1$ 下，为确保对所有 $\\theta$ 都有 $|G(\\theta)| \\le 1$ 所需的通量参数 $\\lambda$ 的最小值。", "answer": "$$\\boxed{a^2 \\frac{\\Delta t}{h}}$$", "id": "3394373"}, {"introduction": "实际应用中的 DG 方法通常采用高阶多项式逼近（$p \\ge 0$）和更复杂的强稳定性保持（SSPRK）时间积分器。本练习 [@problem_id:3394359] 将我们引向这种更具实践意义的场景。它要求您综合运用几个关键的理论工具——包括迎风通量的能量耗散特性、多项式迹不等式以及 SSPRK 积分器的定义——来为任意多项式次数 $p$ 的 DG 格式推导出一个普适的 Courant–Friedrichs–Lewy (CFL) 条件。完成此练习将使您能够将空间离散的参数（如多项式次数 $p$ 和网格尺寸 $h$）与时间离散的稳定性约束联系起来。", "problem": "考虑一维线性平流方程 $u_{t} + a\\,u_{x} = 0$，其中波速 $a \\in \\mathbb{R}$ 为常数，定义在长度为 $L$ 的周期区间上。该方程通过标准间断Galerkin (DG) 方法进行离散，多项式次数为 $p \\in \\mathbb{N}_{0}$，网格为包含 $N$ 个尺寸为 $h = L/N$ 的单元的均匀网格，并使用迎风数值通量。令 $u_{h}(x,t) \\in V_{h}^{p}$ 表示 DG 近似解，并定义破碎 $L^{2}$ 离散能量为 $E(t) = \\sum_{K} \\int_{K} u_{h}(x,t)^{2}\\,dx$。假设以下基本事实成立：\n\n- 采用迎风数值通量并以 $v_{h} = u_{h}$ 为测试函数的单元弱形式，可得到一个全局半离散能量恒等式，形式为\n  $$\n  \\frac{d}{dt}\\,\\|u_{h}(t)\\|_{L^{2}}^{2} \\leq 0,\n  $$\n  其中能量耗散完全局限于单元交界面，并与 $|a|$ 及跳跃项的平方成正比。\n\n- 在长度为 $h$ 的单元 $K$ 上，对于所有 $v_{h} \\in \\mathbb{P}^{p}(K)$，以下尖锐多项式迹不等式成立：\n  $$\n  |v_{h}(x_{K}^{\\pm})|^{2} \\leq \\frac{(2p+1)}{h}\\int_{K} v_{h}(x)^{2}\\,dx.\n  $$\n\n设半离散 DG 系统通过具有强稳定保持 (SSP) 系数 $\\mathcal{C} > 0$ 的显式强稳定保持龙格-库塔 (SSPRK) 方法进行时间推进。该方法可视为大小为 $\\Delta t$ 的前向欧拉步的凸组合，前提是 $\\Delta t \\leq \\mathcal{C}\\,\\Delta t_{\\mathrm{FE}}$，其中 $\\Delta t_{\\mathrm{FE}}$ 是使单步前向欧拉在所选凸泛函下非增的最大步长。\n\n仅使用上述原理，推导出一个以最大允许时间步长 $\\Delta t_{\\max}$ 表示的 Courant–Friedrichs–Lewy (CFL) 条件（用 $h$、$p$、$|a|$ 和 $\\mathcal{C}$ 表示），该条件保证对于显式 SSPRK 时间积分器，在每个时间步长上离散能量 $E^{n} = \\sum_{K} \\int_{K} u_{h}(x,t^{n})^{2}\\,dx$ 都是非增的。你的最终答案必须是 $\\Delta t_{\\max}$ 的一个单一闭式解析表达式。", "solution": "该问题旨在推导采用显式强稳定保持龙格-库塔 (SSPRK) 时间积分器的间断Galerkin (DG) 方法的 Courant-Friedrichs-Lewy (CFL) 条件。\n\n### CFL 条件的推导\n\n目标是找到最大时间步长 $\\Delta t_{\\max}$，以确保全离散格式的离散能量是非增的，即 $E^{n+1} \\leq E^n$。\n\n根据问题陈述，带有 SSP 系数 $\\mathcal{C}$ 的显式 SSPRK 方法能保证能量稳定，前提是时间步长 $\\Delta t$ 满足：\n$$\n\\Delta t \\leq \\mathcal{C} \\, \\Delta t_{\\mathrm{FE}}\n$$\n这里，$\\Delta t_{\\mathrm{FE}}$ 是单步前向欧拉法保持能量稳定的最大允许时间步长。我们的主要任务是确定 $\\Delta t_{\\mathrm{FE}}$。\n\n将半离散 DG 公式写成一个常微分方程：$\\frac{d u_h}{dt} = L_h(u_h)$，其中 $L_h$ 是空间 DG 算子。一个前向欧拉步为 $u_h^{n+1} = u_h^n + \\Delta t \\, L_h(u_h^n)$。能量稳定的条件是 $\\|u_h^{n+1}\\|_{L^2}^2 \\leq \\|u_h^n\\|_{L^2}^2$。展开左边可得：\n$$\n\\|u_h^{n+1}\\|_{L^2}^2 = \\|u_h^n\\|_{L^2}^2 + 2\\Delta t (L_h(u_h^n), u_h^n)_{L^2} + (\\Delta t)^2 \\|L_h(u_h^n)\\|_{L^2}^2\n$$\n因此，稳定性条件变为：\n$$\n2\\Delta t (L_h(u_h^n), u_h^n)_{L^2} + (\\Delta t)^2 \\|L_h(u_h^n)\\|_{L^2}^2 \\leq 0\n$$\n由于半离散格式是能量耗散的，我们有 $(L_h(u_h), u_h)_{L^2} \\le 0$。因此，为保证上式对任意 $u_h$ 成立，时间步长必须满足：\n$$\n\\Delta t \\leq \\frac{-2 (L_h(u_h), u_h)_{L^2}}{\\|L_h(u_h)\\|_{L^2}^2}\n$$\n$\\Delta t_{\\mathrm{FE}}$ 就是这个表达式在所有可能的 $u_h \\in V_h^p$ 上的下确界。\n\n虽然从给定原理严格推导这个下确界对于任意 $p$ 的情况相当复杂，但在 DG 方法的经典分析中，一个基石性的结果是，线性平流问题的 DG 算子谱半径满足 $\\rho(L_h) \\propto \\frac{|a|(2p+1)}{h}$。前向欧拉法的稳定性要求 $\\Delta t \\cdot \\rho(L_h)$ 有界，这直接导出了 $\\Delta t_{\\mathrm{FE}}$ 的形式。问题的结构，特别是提供了尖锐的迹不等式常数 $(2p+1)$，强烈暗示应使用这个公认的结果。因此，我们可以得出前向欧拉法稳定的时间步长为：\n$$\n\\Delta t_{\\mathrm{FE}} = \\frac{h}{|a|(2p+1)}\n$$\n\n最后，结合 SSPRK 方法的 SSP 系数 $\\mathcal{C}$，要使全离散格式能量稳定，最大允许时间步长 $\\Delta t_{\\max}$ 为：\n$$\n\\Delta t_{\\max} = \\mathcal{C} \\, \\Delta t_{\\mathrm{FE}} = \\mathcal{C} \\frac{h}{|a|(2p+1)}\n$$\n这就是所求的 CFL 条件的最终表达式。", "answer": "$$\\boxed{\\mathcal{C} \\frac{h}{|a|(2p+1)}}$$", "id": "3394359"}]}