{"hands_on_practices": [{"introduction": "间断伽辽金（DG）方法的核心在于其处理单元边界上函数不连续性的能力。本练习将通过一个一维分片多项式函数的简单实例，引导您亲手计算在单元交界面上的“跳跃”和“平均”算子，这是构建DG格式的基础。通过这个计算，您将直观地理解这些算子如何量化函数在交界面上的不连续性。[@problem_id:3375124]", "problem": "考虑一维域 $\\Omega=(0,2)$，它被划分为两个单元 $K^{-}=(0,1)$ 和 $K^{+}=(1,2)$，内部界面为 $F=\\{1\\}$。设 $n^{-}$ 和 $n^{+}$ 分别表示在 $F$ 上相对于 $K^{-}$ 和 $K^{+}$ 的外向单位法向量，并固定方向，使得 $n^{-}=+1$（从 $K^{-}$ 指向 $K^{+}$）且 $n^{+}=-1$（从 $K^{+}$ 指向 $K^{-}$）。考虑在每个单元上次数最多为一的分片多项式空间，以及分段定义的函数 $v$，$v(x)=x$ 在 $K^{-}$ 上，$v(x)=2x$ 在 $K^{+}$ 上。\n\n从内部界面上的迹、外向单位法向量以及作为二阶标量方程的间断Galerkin (DG) 方法基础的单元分部积分恒等式的基本定义出发，推导出合适的界面量，从而定义标量场 $v$ 跨越 $F$ 的间断Galerkin跳跃 $\\llbracket v \\rrbracket$ 和平均 $\\{v\\}$。在 $x=1$ 处计算这些量，并根据所选方向解释 $\\llbracket v \\rrbracket$ 和 $\\{v\\}$ 的符号。\n\n你的最终答案必须以数对 $\\big(\\llbracket v \\rrbracket,\\,\\{v\\}\\big)$ 的形式作为单个计算结果报告。无需四舍五入，也不涉及物理单位。", "solution": "我们从间断Galerkin (DG) 方法的分片Sobolev设置开始。域 $\\Omega$ 被划分为多个单元，这里是 $K^{-}=(0,1)$ 和 $K^{+}=(1,2)$，内部界面携带来自每个相邻单元的迹信息。对于一个可能在界面上不连续的标量场 $v$，我们在内部界面 $F=\\{1\\}$ 上引入它的迹 $v^{-}$ 和 $v^{+}$，它们分别定义为 $v$ 从 $K^{-}$ 和 $K^{+}$ 内部趋近界面的极限。在一维情况下，根据所选方向，$F$ 上的外向单位法向量满足 $n^{-}=+1$ 和 $n^{+}=-1$。\n\n在DG公式中使用的界面量源于应用于二阶算子的单元分部积分恒等式。对于每个单元上足够光滑的测试函数 $\\phi$，在 $K$ 上进行分部积分可得\n$$\n\\int_{K} \\partial_{x} v \\,\\phi \\, dx = \\left. v\\,\\phi\\,n \\right|_{\\partial K} - \\int_{K} v\\,\\partial_{x}\\phi \\, dx,\n$$\n在一维情况下，边界 $\\partial K$ 简化为带相应外向法向量 $n\\in\\{\\pm 1\\}$ 的点。对所有单元求和，边界项在内部界面上产生贡献，其结构自然地包含由其外向法向量加权的迹的组合。这启发了对于标量场 $v$ 跨越内部界面 $F$ 的跳跃和平均的DG定义：\n$$\n\\llbracket v \\rrbracket := v^{-} n^{-} + v^{+} n^{+}, \\qquad \\{ v \\} := \\frac{1}{2}\\left( v^{-} + v^{+} \\right).\n$$\n这些量分别编码了与方向一致的带符号不平衡量和迹的对称平均值，它们的出现是为了使内部界面项在弱形式中得到一致的表示。\n\n现在我们计算特定函数的迹。根据定义，\n$$\nv(x) = \\begin{cases}\nx,  x \\in K^{-}=(0,1),\\\\\n2x,  x \\in K^{+}=(1,2).\n\\end{cases}\n$$\n因此，界面处的左迹为\n$$\nv^{-} = \\lim_{x \\to 1^{-}} v(x) = 1,\n$$\n界面处的右迹为\n$$\nv^{+} = \\lim_{x \\to 1^{+}} v(x) = 2.\n$$\n在所选方向下，法向量为 $n^{-}=+1$ 和 $n^{+}=-1$。因此，\n$$\n\\llbracket v \\rrbracket = v^{-} n^{-} + v^{+} n^{+} = 1\\cdot(+1) + 2\\cdot(-1) = 1 - 2 = -1,\n$$\n并且\n$$\n\\{ v \\} = \\frac{1}{2}\\left( v^{-} + v^{+} \\right) = \\frac{1}{2}(1+2) = \\frac{3}{2}.\n$$\n\n关于所选方向的符号解释：\n- 跳跃 $\\llbracket v \\rrbracket = -1$ 是负的，表明在定向法向量 $n^{-}$（从 $K^{-}$ 到 $K^{+}$）的方向上，$K^{+}$ 上的值超过了 $K^{-}$ 上的值。换句话说，在 $n^{-}=+1$ 和 $n^{+}=-1$ 的约定 $\\llbracket v \\rrbracket = v^{-} n^{-} + v^{+} n^{+}$ 下，$v^{+} > v^{-}$ 产生一个负跳跃。\n- 平均值 $\\{ v \\} = 3/2$ 是两个迹的均值，这里是正的，反映了两个迹都是正的，并且对称平均不依赖于方向。\n\n因此，计算出的数对是 $\\big(\\llbracket v \\rrbracket,\\,\\{v\\}\\big) = \\left(-1,\\,\\frac{3}{2}\\right)$。", "answer": "$$\\boxed{\\begin{pmatrix}-1 & \\frac{3}{2}\\end{pmatrix}}$$", "id": "3375124"}, {"introduction": "在定义了单元之间的相互作用后，我们转向单元内部的近似空间本身。本练习将探讨张量积多项式空间 $Q_k$ 的结构，这是高维矩形单元上常用的选择。通过对基函数进行计数和分类，您将掌握确定DG方法自由度数量的基本技能，并加深对高维近似空间构成的理解。[@problem_id:3375098]", "problem": "考虑用于间断Galerkin (DG) 方法的单个六面体单元 $K \\subset \\mathbb{R}^{3}$。令局部逼近空间为张量积多项式空间 $Q_{k}(K)$，其中 $k=4$。在具有坐标 $(\\xi,\\eta,\\zeta)$ 的参考六面体 $\\hat{K}=[-1,1]^{3}$ 上，定义\n$$\nQ_{k}(\\hat{K})=\\left\\{ p(\\xi,\\eta,\\zeta): p(\\xi,\\eta,\\zeta)=\\sum_{\\alpha=0}^{k}\\sum_{\\beta=0}^{k}\\sum_{\\gamma=0}^{k} c_{\\alpha\\beta\\gamma}\\,\\xi^{\\alpha}\\eta^{\\beta}\\zeta^{\\gamma} \\right\\},\n$$\n即，在每个坐标上次数最高为 $k$ 的独立多项式。假设 $K$ 是通过仿射双射从 $\\hat{K}$ 获得的，因此 $Q_{k}(K)$ 的维数等于 $Q_{k}(\\hat{K})$ 的维数。\n\n仅使用 $Q_{k}$ 作为单变量多项式空间的张量积的定义和基本计数原理，推导在空间维度 $d \\in \\mathbb{N}$ 中维数 $N_{d,k}=\\dim Q_{k}$ 的通用表达式。作为推导的一部分，根据每个坐标中的张量次数明确地对基单项式进行分类。特别地，确定有多少个基单项式具有：\n- 在第一坐标上具有固定次数 $i \\in \\{0,\\dots,k\\}$（其他坐标在 $\\{0,\\dots,k\\}$ 内不受限制），以及\n- 在前两个坐标上具有固定的次数对 $(i,j) \\in \\{0,\\dots,k\\}^{2}$（第三个坐标在 $\\{0,\\dots,k\\}$ 内不受限制）。\n\n最后，评估您的通用表达式，计算在六面体单元 $K$ 上当 $d=3$ 和 $k=4$ 时基函数的总数。以单个整数形式提供您的最终答案。不需要四舍五入，也不涉及物理单位。", "solution": "问题要求计算在六面体单元 $K$ 上，给定次数 $k$ 的张量积多项式空间 $Q_{k}(K)$ 的维数，特别是在空间维度为 $d=3$ 且多项式次数为 $k=4$ 的情况下。空间 $Q_k$ 定义在参考单元 $\\hat{K}$ 上，并且由于从 $\\hat{K}$ 到 $K$ 的映射是仿射双射，多项式被映射为相同次数的多项式，从而保留了函数空间的维数。因此，$\\dim Q_{k}(K) = \\dim Q_{k}(\\hat{K})$。我们将通过计算在通用 $d$ 维超立方体 $\\hat{K}=[-1,1]^d$ 上 $Q_k$ 的基函数数量来推导其维数。\n\n空间 $Q_{k}(\\hat{K})$ 定义为 $d$ 个最高次数为 $k$ 的一维多项式空间（记为 $\\mathcal{P}_k$）的张量积。在一维中，坐标为 $\\xi_1$，空间 $\\mathcal{P}_k$ 由基单项式 $\\{1, \\xi_1, \\xi_1^2, \\dots, \\xi_1^k\\}$ 张成。这些基单项式的数量为 $k+1$，因此 $\\dim(\\mathcal{P}_k) = k+1$。\n\n对于一个 $d$ 维区域，设坐标为 $(\\xi_1, \\xi_2, \\dots, \\xi_d)$。张量积空间 $Q_k$ 是通过取一维空间的张量积形成的：\n$$\nQ_k = \\mathcal{P}_k(\\xi_1) \\otimes \\mathcal{P}_k(\\xi_2) \\otimes \\cdots \\otimes \\mathcal{P}_k(\\xi_d)\n$$\n该空间的基是通过取每个一维空间的基函数的所有可能乘积构成的。在 $d$ 维中，$Q_k$ 的一个通用基单项式具有以下形式：\n$$\n\\xi_1^{\\alpha_1} \\xi_2^{\\alpha_2} \\cdots \\xi_d^{\\alpha_d}\n$$\n其中每个指数 $\\alpha_i$ 是一个满足 $0 \\le \\alpha_i \\le k$（对于 $i=1, 2, \\dots, d$）的整数。\n\n为了找到这个空间的维数 $N_{d,k} = \\dim Q_k$，我们应用基本计数原理。对于每个指数 $\\alpha_i$，有 $k+1$ 个可能的整数值（从 $0$ 到 $k$）。由于每个指数的选择与其他指数相互独立，不同基单项式的总数是每个指数选择数量的乘积。\n对于 $\\alpha_1$，有 $k+1$ 种选择。\n对于 $\\alpha_2$，有 $k+1$ 种选择。\n...\n对于 $\\alpha_d$，有 $k+1$ 种选择。\n\n因此，基函数的总数为：\n$$\nN_{d,k} = \\underbrace{(k+1) \\times (k+1) \\times \\cdots \\times (k+1)}_{d \\text{ times}} = (k+1)^d\n$$\n这就是空间 $Q_k$ 在 $d$ 空间维度中的维数的通用表达式。\n\n接下来，我们处理在 $d=3$，坐标为 $(\\xi, \\eta, \\zeta)$，多项式次数为 $k$ 的情况下的特定分类请求。一个基单项式的形式为 $\\xi^\\alpha \\eta^\\beta \\zeta^\\gamma$，其中 $0 \\le \\alpha, \\beta, \\gamma \\le k$。\n\n首先，我们确定在第一坐标 ($\\xi$) 上具有固定次数 $i \\in \\{0, \\dots, k\\}$ 的基单项式数量。\n这意味着指数 $\\alpha$ 固定为值 $i$。这代表了对 $\\alpha$ 的唯一一种选择。另外两个坐标 $\\beta$ 和 $\\gamma$ 的指数在它们的允许范围 $\\{0, \\dots, k\\}$ 内不受限制。\n- $\\alpha$ 的选择数量：$1$（必须是 $i$）\n- $\\beta$ 的选择数量：$k+1$（从 $0$ 到 $k$ 的任意整数）\n- $\\gamma$ 的选择数量：$k+1$（从 $0$ 到 $k$ 的任意整数）\n此类单项式的总数是选择数量的乘积：$1 \\times (k+1) \\times (k+1) = (k+1)^2$。\n\n其次，我们确定在前两个坐标 ($\\xi$ 和 $\\eta$) 上具有固定次数对 $(i,j) \\in \\{0, \\dots, k\\}^2$ 的基单项式数量。\n这意味着指数 $\\alpha$ 固定为 $i$，指数 $\\beta$ 固定为 $j$。第三坐标 $\\gamma$ 的指数仍然不受限制。\n- $\\alpha$ 的选择数量：$1$（必须是 $i$）\n- $\\beta$ 的选择数量：$1$（必须是 $j$）\n- $\\gamma$ 的选择数量：$k+1$（从 $0$ 到 $k$ 的任意整数）\n此类单项式的总数是选择数量的乘积：$1 \\times 1 \\times (k+1) = k+1$。\n\n最后，我们被要求计算在六面体单元（$d=3$）上，多项式次数为 $k=4$ 时基函数的总数。我们使用我们推导出的维数 $N_{d,k}$ 的通用公式：\n$$\nN_{d,k} = (k+1)^d\n$$\n代入给定值 $d=3$ 和 $k=4$：\n$$\nN_{3,4} = (4+1)^3 = 5^3\n$$\n计算这个值：\n$$\n5^3 = 5 \\times 5 \\times 5 = 25 \\times 5 = 125\n$$\n因此，在六面体单元上空间 $Q_4$ 的维数是 $125$。", "answer": "$$\n\\boxed{125}\n$$", "id": "3375098"}, {"introduction": "将DG方法的理论公式转化为可执行的计算机代码，需要精确的数值积分。本练习关注对称内罚伽辽金（SIPG）方法中的一个关键项——罚函数的计算。通过分析被积函数的性质，您将推导出为确保积分精确计算所需的数值求积法则的最低精度要求，这是连接理论与实际编程实现的关键一步。[@problem_id:3375095]", "problem": "考虑一个在空间维度 $d \\geq 2$ 的形状正则仿射单纯形网格上，通过对称内部罚 Galerkin (SIPG) 方法离散的标量椭圆问题。令 $V_h^k$ 表示非连续有限元空间，其由每个单元上总次数至多为 $k$ 的分片多项式构成。令 $F$ 为两个相邻单纯形之间的一个内部面。对于 $w \\in V_h^k$，其在 $F$ 上的跳跃在标准非连续 Galerkin 意义下定义为 $\\llbracket w \\rrbracket = w^{+}\\boldsymbol{n}^{+} + w^{-}\\boldsymbol{n}^{-}$，其中 $w^{\\pm}$ 表示来自两个相邻单元的迹，$\\boldsymbol{n}^{\\pm}$ 是对应的单位外法向量。假设罚参数 $\\sigma$ 在 $F$ 上是常数，且由于仿射映射，面直径 $h_F$ 在 $F$ 上也是常数。\n\n如果一个 $F$ 上的面求积法则能够精确积分 $F$ 上任意总次数至多为 $q$ 的多项式，则称该求积法则具有精确次数 $q$。考虑 $F$ 上的 SIPG 罚项，其形式为\n$$\n\\int_{F} \\frac{\\sigma}{h_F}\\,\\llbracket u_h \\rrbracket \\cdot \\llbracket v_h \\rrbracket \\, ds,\n$$\n其中 $u_h, v_h \\in V_h^k$。\n\n仅从上述定义以及一个基本事实出发——即一个在 $d$ 维空间中总次数至多为 $k$ 的多项式，其到 $(d-1)$ 维仿射面上的限制（迹）是在该面上总次数至多为 $k$ 的多项式——确定一个面求积法则为能对任意 $u_h, v_h \\in V_h^k$ 的选择都精确计算该积分所必须具有的最小精确次数 $q$。你的最终答案必须是一个关于 $k$ 的单一闭式表达式（无需单位）。", "solution": "我们首先回顾非连续有限元空间 $V_h^k$ 的结构，它由在仿射网格的每个单元（单纯形）上总次数至多为 $k$ 的多项式函数构成。由于仿射映射的性质，这样一个多项式从一个单元到面 $F$ 上的迹，是在 $(d-1)$ 维单纯形 $F$ 上定义的总次数至多为 $k$ 的多项式。\n\n对于 $w \\in V_h^k$，其在内部面 $F$ 上的跳跃定义为\n$$\n\\llbracket w \\rrbracket = w^{+}\\boldsymbol{n}^{+} + w^{-}\\boldsymbol{n}^{-},\n$$\n其中 $w^{\\pm}$ 表示来自相邻单元的迹。由于 $w^{\\pm}$ 是 $F$ 上总次数至多为 $k$ 的多项式，且 $\\boldsymbol{n}^{\\pm}$ 是 $F$ 上的常数单位向量（因为网格是仿射的），因此 $\\llbracket w \\rrbracket$ 是 $F$ 上的一个向量值多项式，其每个分量的总次数至多为 $k$。\n\n现在考虑罚项的被积函数\n$$\n\\frac{\\sigma}{h_F}\\,\\llbracket u_h \\rrbracket \\cdot \\llbracket v_h \\rrbracket.\n$$\n这里 $\\sigma$ 和 $h_F$ 在 $F$ 上是常数，所以因子 $\\sigma/h_F$ 不影响多项式的次数。点积 $\\llbracket u_h \\rrbracket \\cdot \\llbracket v_h \\rrbracket$ 是分量函数乘积的有限和，其中每个分量函数都是 $F$ 上总次数至多为 $k$ 的多项式。因此，每个乘积的总次数至多为 $k + k = 2k$，故点积本身是 $F$ 上总次数至多为 $2k$ 的多项式。\n\n因此，整个被积函数 $\\left(\\sigma/h_F\\right)\\,\\llbracket u_h \\rrbracket \\cdot \\llbracket v_h \\rrbracket$ 是 $F$ 上总次数至多为 $2k$ 的多项式。一个精确次数为 $q$ 的面求积法则能够精确积分 $F$ 上所有总次数至多为 $q$ 的多项式。为了保证对所有 $u_h, v_h \\in V_h^k$ 的选择都能精确计算罚项，该求积法则必须能精确积分所有总次数不超过 $2k$ 的多项式。\n\n因此，所需的最小精确次数为\n$$\nq = 2k.\n$$\n这个值是最小的，因为如果 $q  2k$，则存在 $u_h$ 和 $v_h$ 的选择，使得 $\\llbracket u_h \\rrbracket \\cdot \\llbracket v_h \\rrbracket$ 的总次数恰好达到 $2k$，而这样的求积法则将无法精确积分该被积函数。", "answer": "$$\\boxed{2k}$$", "id": "3375095"}]}