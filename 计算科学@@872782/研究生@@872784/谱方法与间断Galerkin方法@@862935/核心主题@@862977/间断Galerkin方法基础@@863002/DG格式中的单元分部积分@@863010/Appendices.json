{"hands_on_practices": [{"introduction": "第一个练习是任何DG实践者的基本构成模块。我们将离散化一个简单的一维平流方程，并推导出单元级的质量和刚度（平流）矩阵。这个练习的核心是对空间导数项应用单元分部积分，这自然地将单元内部积分与边界通量项分开，为引入迎风数值通量奠定了基础。这个过程是构建半离散DG系统的核心。[@problem_id:3382909]", "problem": "考虑区间 $[0,1]$ 上的一维线性平流初值问题：\n$$u_{t} + a\\,u_{x} = 0,$$\n其中平流速度 $a>0$ 为常数，且在 $x=0$ 处的入流边界数据设置为零。使用单个谱元 $K=[0,1]$，通过仿射映射 $x(\\xi) = \\frac{1}{2}(1+\\xi)$ 从参考坐标 $\\xi\\in[-1,1]$ 映射到物理坐标 $x$，因此 $h=1$ 且 $dx = \\frac{1}{2}\\,d\\xi$。采用间断 Galerkin (DG) 方法，在参考单元上使用以下标准正交模态基：\n$$\\phi_{0}(\\xi) = \\frac{1}{\\sqrt{2}},\\qquad \\phi_{1}(\\xi) = \\sqrt{\\frac{3}{2}}\\,\\xi.$$\n设离散解为 $u_{h}(x(\\xi),t) = c_{0}(t)\\,\\phi_{0}(\\xi) + c_{1}(t)\\,\\phi_{1}(\\xi)$，并选择由单元面上 $a\\cdot n$ 的符号决定的迎风数值通量 $\\widehat{u}$。在一维情况下，单位外法向量在 $\\xi=-1$ 处为 $n=-1$，在 $\\xi=+1$ 处为 $n=+1$，因此在左侧面上 $a\\cdot n < 0$，在右侧面上 $a\\cdot n>0$。在 $x=0$ (左侧面) 处施加入流边界数据 $u_{\\text{in}}=0$，因此该处的通量为 $\\widehat{u}=u_{\\text{in}}=0$。在 $x=1$ (右侧面) 处取 $\\widehat{u}=u^{-}$，其中 $u^{-}$ 表示内部迹。\n\n从单元上的弱形式出发，在 $K$上进行分部积分，推导与以下双线性形式相关的单元级质量矩阵项 $M_{ij}$ 和平流 (刚度) 矩阵项 $A_{ij}$：\n$$M_{ij} = \\int_{K} \\phi_{i}\\,\\phi_{j}\\,dx,\\qquad\nA_{ij} = -\\int_{K} a\\,\\partial_{x}\\phi_{i}\\,\\phi_{j}\\,dx + \\sum_{f\\subset\\partial K} \\int_{f} a\\,n\\,\\widehat{u}\\,\\phi_{i}\\,ds,$$\n对于 $i,j\\in\\{0,1\\}$，其中 $ds$ 是面上的测度。将最终答案表示为一个单行矩阵，按以下顺序包含八个元素：\n$$(M_{00},\\,M_{01},\\,M_{10},\\,M_{11},\\,A_{00},\\,A_{01},\\,A_{10},\\,A_{11}).$$\n无需四舍五入。请以 $a$ 的精确代数表达式形式提供答案。", "solution": "用户希望求出单个单元上一维线性平流问题的间斷 Galerkin (DG) 离散化的质量矩阵和刚度矩阵项。\n\n### 步骤 1：问题验证\n\n**1.1. 提取已知条件**\n- **偏微分方程 (PDE):** $u_{t} + a\\,u_{x} = 0$ on the interval $[0,1]$.\n- **平流速度:** $a > 0$, constant.\n- **边界条件:** Inflow boundary data $u_{\\text{in}} = 0$ at $x=0$.\n- **单元:** A single spectral element $K=[0,1]$, so the element size is $h=1$.\n- **映射:** Affine map from reference coordinate $\\xi \\in [-1,1]$ to physical coordinate $x \\in [0,1]$ is $x(\\xi) = \\frac{1}{2}(1+\\xi)$.\n- **雅可比变换:** The differential transformation is $dx = \\frac{1}{2}d\\xi$. The derivative transformation is $\\partial_x = (\\frac{d\\xi}{dx})\\partial_\\xi = 2\\partial_\\xi$.\n- **基函数:** An orthonormal modal basis on the reference element:\n    -   $\\phi_{0}(\\xi) = \\frac{1}{\\sqrt{2}}$\n    -   $\\phi_{1}(\\xi) = \\sqrt{\\frac{3}{2}}\\,\\xi$\n- **离散解:** $u_{h}(x(\\xi),t) = c_{0}(t)\\,\\phi_{0}(\\xi) + c_{1}(t)\\,\\phi_{1}(\\xi)$.\n- **数值通量:** Upwind flux $\\widehat{u}$.\n    - At the left face ($x=0, \\xi=-1$), the outward normal is $n=-1$. Since $a>0$, $a \\cdot n  0$ (inflow). The flux is $\\widehat{u} = u_{\\text{in}} = 0$.\n    - At the right face ($x=1, \\xi=1$), the outward normal is $n=+1$. Since $a0$, $a \\cdot n  0$ (outflow). The flux is $\\widehat{u} = u^{-}$, where $u^{-}$ is the interior trace of the solution.\n- **矩阵定义:**\n    - 质量矩阵: $M_{ij} = \\int_{K} \\phi_{i}\\,\\phi_{j}\\,dx$ for $i,j \\in \\{0,1\\}$.\n    - 平流矩阵: $A_{ij} = -\\int_{K} a\\,\\partial_{x}\\phi_{i}\\,\\phi_{j}\\,dx + \\sum_{f\\subset\\partial K} \\int_{f} a\\,n\\,\\widehat{u}\\,\\phi_{i}\\,ds$ for $i,j \\in \\{0,1\\}$.\n\n**1.2. 验证**\n该问题具有科学依据、适定、客观且自洽。它描述了 DG 方法领域的一个标准流程。定义和数据一致且足以执行所需的计算。该问题被判定为**有效**。\n\n### 步骤 2：矩阵项的计算\n\n**2.1. 质量矩阵 $M_{ij}$**\n\n质量矩阵项定义为 $M_{ij} = \\int_{K} \\phi_{i}\\,\\phi_{j}\\,dx$。我们使用 $dx = \\frac{1}{2}d\\xi$ 将积分从物理单元 $K=[0,1]$ 变换到参考单元 $\\xi \\in [-1,1]$。\n$$M_{ij} = \\int_{-1}^{1} \\phi_{i}(\\xi)\\,\\phi_{j}(\\xi)\\,\\frac{1}{2}\\,d\\xi = \\frac{1}{2} \\int_{-1}^{1} \\phi_{i}(\\xi)\\,\\phi_{j}(\\xi)\\,d\\xi$$\n基函数 $\\{\\phi_0, \\phi_1\\}$ 在参考单元上是标准正交的，这意味着 $\\int_{-1}^{1} \\phi_{i}(\\xi)\\phi_{j}(\\xi)d\\xi = \\delta_{ij}$ (克罗内克 δ)。\n因此，$M_{ij} = \\frac{1}{2}\\delta_{ij}$。\n\n具体各项为：\n-   $M_{00} = \\frac{1}{2}(1) = \\frac{1}{2}$\n-   $M_{01} = \\frac{1}{2}(0) = 0$\n-   $M_{10} = \\frac{1}{2}(0) = 0$\n-   $M_{11} = \\frac{1}{2}(1) = \\frac{1}{2}$\n\n**2.2. 平流 (刚度) 矩阵 $A_{ij}$**\n\n平流矩阵项由以下公式给出：\n$$A_{ij} = -\\int_{K} a\\,\\partial_{x}\\phi_{i}\\,\\phi_{j}\\,dx + \\sum_{f\\subset\\partial K} \\int_{f} a\\,n\\,\\widehat{u}\\,\\phi_{i}\\,ds$$\n该表达式由体积分部分和边值通量部分组成。\n\n**体积分部分：** 让我们将这部分表示为 $V_{ij}$。\n$$V_{ij} = -\\int_{K} a\\,\\partial_{x}\\phi_{i}\\,\\phi_{j}\\,dx$$\n我们变换到参考单元，使用 $\\partial_x = 2\\partial_\\xi$ 和 $dx = \\frac{1}{2}d\\xi$：\n$$V_{ij} = -\\int_{-1}^{1} a\\,(2\\partial_{\\xi}\\phi_{i})\\,\\phi_{j}\\,\\frac{1}{2}\\,d\\xi = -a\\int_{-1}^{1} (\\partial_{\\xi}\\phi_{i})\\,\\phi_{j}\\,d\\xi$$\n首先，我们求基函数相对于 $\\xi$ 的导数：\n-   $\\partial_{\\xi}\\phi_{0}(\\xi) = \\partial_{\\xi}(\\frac{1}{\\sqrt{2}}) = 0$\n-   $\\partial_{\\xi}\\phi_{1}(\\xi) = \\partial_{\\xi}(\\sqrt{\\frac{3}{2}}\\xi) = \\sqrt{\\frac{3}{2}}$\n\n现在我们计算各项 $V_{ij}$：\n-   $V_{00} = -a\\int_{-1}^{1} (0)\\,\\phi_{0}\\,d\\xi = 0$\n-   $V_{01} = -a\\int_{-1}^{1} (0)\\,\\phi_{1}\\,d\\xi = 0$\n-   $V_{10} = -a\\int_{-1}^{1} (\\partial_{\\xi}\\phi_{1})\\,\\phi_{0}\\,d\\xi = -a\\int_{-1}^{1} \\sqrt{\\frac{3}{2}}\\,\\frac{1}{\\sqrt{2}}\\,d\\xi = -a\\frac{\\sqrt{3}}{2}\\int_{-1}^{1}d\\xi = -a\\frac{\\sqrt{3}}{2}(2) = -a\\sqrt{3}$\n-   $V_{11} = -a\\int_{-1}^{1} (\\partial_{\\xi}\\phi_{1})\\,\\phi_{1}\\,d\\xi = -a\\int_{-1}^{1} \\sqrt{\\frac{3}{2}}\\,\\sqrt{\\frac{3}{2}}\\xi\\,d\\xi = -a\\frac{3}{2}\\int_{-1}^{1}\\xi\\,d\\xi = -a\\frac{3}{2}\\left[\\frac{\\xi^2}{2}\\right]_{-1}^{1} = 0$\n\n**边值通量部分：** 让我们将这部分对矩阵的贡献表示为 $B_{ij}$。该项是 $\\sum_{f\\subset\\partial K} \\int_{f} a\\,n\\,\\widehat{u}\\,\\phi_{i}\\,ds$。尽管 $\\widehat{u}$ 依赖于完整解 $u_h = \\sum_j c_j \\phi_j$，但我们可以通过观察该项如何依赖于每个系数 $c_j$ 来推导出矩阵项 $B_{ij}$。单元 $K=[0,1]$ 的边界由两个面组成：$x=0$ 和 $x=1$。积分变成了在这些点上的求和。\n$$\\sum_{f\\subset\\partial K} \\int_{f} a\\,n\\,\\widehat{u}\\,\\phi_{i}\\,ds = [a\\,n\\,\\widehat{u}\\,\\phi_{i}]_{x=1} + [a\\,n\\,\\widehat{u}\\,\\phi_{i}]_{x=0}$$\n- 在左侧面 ($x=0$, $\\xi=-1$)：$n=-1$，通量为 $\\widehat{u}=u_{\\text{in}}=0$。贡献为 $0$。\n- 在右侧面 ($x=1$, $\\xi=1$)：$n=+1$，通量为 $\\widehat{u}=u^{-} = u_h(1,t)$。贡献为 $a(1)u_h(1,t)\\phi_i(1) = a\\,u_h(1,t)\\phi_i(1)$。\n\n第 $i$ 个方程的总边界项是 $a\\,u_h(1,t)\\phi_i(1)$。代入 $u_h(1,t) = \\sum_j c_j(t)\\phi_j(1)$：\n$$a\\left(\\sum_{j} c_j(t)\\phi_j(1)\\right)\\phi_i(1) = \\sum_{j} c_j(t) [a\\,\\phi_i(1)\\phi_j(1)]$$\n由此，我们确定矩阵贡献为 $B_{ij} = a\\,\\phi_i(1)\\phi_j(1)$。\n我们需要基函数在 $\\xi=1$ 处的值：\n-   $\\phi_0(1) = \\frac{1}{\\sqrt{2}}$\n-   $\\phi_1(1) = \\sqrt{\\frac{3}{2}}$\n\n现在我们计算各项 $B_{ij}$：\n-   $B_{00} = a\\,\\phi_0(1)\\phi_0(1) = a(\\frac{1}{\\sqrt{2}})(\\frac{1}{\\sqrt{2}}) = \\frac{a}{2}$\n-   $B_{01} = a\\,\\phi_0(1)\\phi_1(1) = a(\\frac{1}{\\sqrt{2}})(\\sqrt{\\frac{3}{2}}) = \\frac{a\\sqrt{3}}{2}$\n-   $B_{10} = a\\,\\phi_1(1)\\phi_0(1) = a(\\sqrt{\\frac{3}{2}})(\\frac{1}{\\sqrt{2}}) = \\frac{a\\sqrt{3}}{2}$\n-   $B_{11} = a\\,\\phi_1(1)\\phi_1(1) = a(\\sqrt{\\frac{3}{2}})(\\sqrt{\\frac{3}{2}}) = \\frac{3a}{2}$\n\n**总平流矩阵：** $A_{ij} = V_{ij} + B_{ij}$.\n-   $A_{00} = V_{00} + B_{00} = 0 + \\frac{a}{2} = \\frac{a}{2}$\n-   $A_{01} = V_{01} + B_{01} = 0 + \\frac{a\\sqrt{3}}{2} = \\frac{\\sqrt{3}}{2}a$\n-   $A_{10} = V_{10} + B_{10} = -a\\sqrt{3} + \\frac{a\\sqrt{3}}{2} = -\\frac{a\\sqrt{3}}{2} = -\\frac{\\sqrt{3}}{2}a$\n-   $A_{11} = V_{11} + B_{11} = 0 + \\frac{3a}{2} = \\frac{3}{2}a$\n\n### 步骤 3：最终答案组合\n\n问题要求最终答案为一个单行矩阵，按以下顺序包含八个元素 $(M_{00},\\,M_{01},\\,M_{10},\\,M_{11},\\,A_{00},\\,A_{01},\\,A_{10},\\,A_{11})$。\n计算出的值为：\n-   $M_{00} = \\frac{1}{2}$\n-   $M_{01} = 0$\n-   $M_{10} = 0$\n-   $M_{11} = \\frac{1}{2}$\n-   $A_{00} = \\frac{a}{2}$\n-   $A_{01} = \\frac{\\sqrt{3}}{2}a$\n-   $A_{10} = -\\frac{\\sqrt{3}}{2}a$\n-   $A_{11} = \\frac{3}{2}a$\n将这些值组合成最终的行矩阵即得到解。", "answer": "$$ \\boxed{ \\begin{pmatrix} \\frac{1}{2}  0  0  \\frac{1}{2}  \\frac{a}{2}  \\frac{\\sqrt{3}}{2}a  -\\frac{\\sqrt{3}}{2}a  \\frac{3}{2}a \\end{pmatrix} } $$", "id": "3382909"}, {"introduction": "在构建了基本的DG系统之后，我们现在来审视数值积分所扮演的关键角色。这个练习探讨了当分部积分过程中的积分没有被精确计算时（即所谓的“欠积分”）会发生什么。通过量化由此产生的“守恒缺陷”，您将更深刻地理解为何强形式和弱形式之间的代数等价性至关重要，以及这种等价性的破坏如何损害DG方法的基本守恒性质。[@problem_id:3382930]", "problem": "考虑单个参考单元 $\\widehat{K}=[-1,1]$ 上的一维标量守恒律，\n$$\nu_{t} + \\partial_{x} f(u) = 0,\n$$\n其中通量 $f$ 是光滑的。在间断伽辽金 (DG) 格式中，弱形式和强形式通过单元分部积分相联系。对于精确积分，恒等式\n$$\n\\int_{-1}^{1} \\varphi'(x)\\, g(x)\\, dx + \\int_{-1}^{1} \\varphi(x)\\, g'(x)\\, dx = \\left[\\varphi(x)\\, g(x)\\right]_{x=-1}^{x=1}\n$$\n对光滑函数 $g$ 和检验函数 $\\varphi$ 成立。该恒等式是局部守恒的基础：选择 $\\varphi(x)=1$ 可得，$u$ 的单元平均值的时间变化率等于穿过单元边界的净通量。\n\n现在，用一个次数为 $q$（对最高为 $q$ 次的多项式精确）的求积法则（用线性泛函 $Q[\\cdot]$ 表示）来代替精确积分。定义离散分部积分残差\n$$\n\\mathcal{E}(\\varphi,g) \\equiv Q\\!\\left[\\varphi'(x)\\, g(x)\\right] + Q\\!\\left[\\varphi(x)\\, g'(x)\\right] - \\left[\\varphi(x)\\, g(x)\\right]_{x=-1}^{x=1}.\n$$\n当 $\\mathcal{E}(\\varphi,g)\\neq 0$ 时，离散分部积分失效，并且在所选的求积法则下，强形式和弱形式的 DG 格式在代数上不再等价。\n\n为了在积分不足的情况下具体量化单个单元上局部守恒性的损失，请按以下步骤操作。\n\n1. 使用 $f(u)=u$（线性平流），因此 $g(x)=u(x)$ 且 $g'(x)=u_{x}(x)$。\n2. 使用强形式的体积项 $Q\\!\\left[\\varphi(x)\\, u_{x}(x)\\right]$ 以及与物理通量相等的相容边界数值通量，因此对于任何满足 $\\varphi(1)=\\varphi(-1)=1$ 的 $\\varphi$，边界贡献为 $\\left[u(x)\\right]_{x=-1}^{x=1}$。\n3. 取 $\\varphi(x)=1$ 并选择一个多项式试探解 $u(x)=x^{5}$，它属于一个次数为 $p=6$ 的 DG 多项式空间（因此下面的求积选择满足 $q  p$）。\n4. 使用 $[-1,1]$ 上的 **Simpson 法则**作为求积法则 $Q[\\cdot]$，该法则对最高次数为 $q=3$ 的多项式精确。\n\n计算所产生的标量**守恒缺陷**（Conservation Defect），定义为\n$$\n\\mathcal{C} \\equiv Q[u_x(x)] - \\big(u(1) - u(-1)\\big).\n$$\n无需四舍五入。", "solution": "我们从单元 $\\widehat{K}=[-1,1]$ 上的基本分部积分恒等式开始：\n$$\n\\int_{-1}^{1} \\varphi'(x)\\, g(x)\\, dx + \\int_{-1}^{1} \\varphi(x)\\, g'(x)\\, dx \\;=\\; \\left[\\varphi(x)\\, g(x)\\right]_{x=-1}^{x=1}.\n$$\n在间断伽辽金背景下，当积分被精确计算时，该恒等式确保了弱形式和强形式的等价性。当求积法则 $Q[\\cdot]$ 取代每个积分时，其离散对应形式为\n$$\nQ\\!\\left[\\varphi'(x)\\, g(x)\\right] + Q\\!\\left[\\varphi(x)\\, g'(x)\\right] \\;\\stackrel{?}{=}\\; \\left[\\varphi(x)\\, g(x)\\right]_{x=-1}^{x=1}.\n$$\n通常，只要该求积法则对所涉及的多项式被积函数是精确的，等式就成立。否则，残差\n$$\n\\mathcal{E}(\\varphi,g) \\equiv Q\\!\\left[\\varphi'(x)\\, g(x)\\right] + Q\\!\\left[\\varphi(x)\\, g'(x)\\right] - \\left[\\varphi(x)\\, g(x)\\right]_{x=-1}^{x=1}\n$$\n就度量了离散分部积分的失效程度。\n\n通过取 $\\varphi(x)=1$，可以得到单元的局部守恒性。对于具有精确积分的连续问题，我们有\n$$\n\\int_{-1}^{1} 1 \\cdot g'(x)\\, dx = \\left[g(x)\\right]_{x=-1}^{x=1}.\n$$\n在求积法则下，强形式的体积项变为 $Q[g'(x)]$，从而产生离散守恒平衡关系\n$$\nQ[g'(x)] \\;\\stackrel{?}{=}\\; \\left[g(x)\\right]_{x=-1}^{x=1}.\n$$\n因此，标量守恒缺陷为\n$$\n\\mathcal{C} \\equiv Q[g'(x)] - \\left[g(x)\\right]_{x=-1}^{x=1}.\n$$\n\n对于指定的数据，我们设 $f(u)=u$，因此 $g(x)=u(x)$ 且 $g'(x)=u_{x}(x)$。我们选择 $\\varphi(x)=1$，多项式次数为 $p=6$，以及 $u(x)=x^{5}$，它位于近似空间 $\\mathbb{P}_{6}$ 中。求积法则是 $[-1,1]$ 上的 Simpson 法则，\n$$\nQ[h] = \\frac{1}{3}\\,\\big(h(-1) + 4\\,h(0) + h(1)\\big),\n$$\n其精确度为 $q=3$，严格小于 $p$。\n\n我们现在计算 $\\mathcal{C}$：\n1. 计算 $u_{x}(x)$：\n$$\nu(x) = x^{5} \\quad\\Rightarrow\\quad u_{x}(x) = 5 x^{4}.\n$$\n2. 计算 $u_{x}$ 的求积：\n$$\nQ[u_{x}] = \\frac{1}{3}\\,\\big(u_{x}(-1) + 4\\,u_{x}(0) + u_{x}(1)\\big) = \\frac{1}{3}\\,\\big(5(-1)^{4} + 4\\cdot 5\\, 0^{4} + 5(1)^{4}\\big) = \\frac{1}{3}\\,(5 + 0 + 5) = \\frac{10}{3}.\n$$\n3. 计算 $u$ 的边界差值：\n$$\nu(1) - u(-1) = 1^{5} - (-1)^{5} = 1 - (-1) = 2.\n$$\n4. 构成守恒缺陷：\n$$\n\\mathcal{C} = Q[u_{x}] - \\big(u(1) - u(-1)\\big) = \\frac{10}{3} - 2 = \\frac{4}{3}.\n$$\n\n解释。非零值 $\\mathcal{C}=\\frac{4}{3}$ 定量地表明，当求积法则相对于 $u \\in \\mathbb{P}_{6}$ 的强形式中出现的多项式相互作用而言积分不足（次数 $q=3$）时，离散分部积分会失效，并因此导致单元上局部守恒性的损失。若采用精确积分，$\\mathcal{C}$ 将为零，因为 $\\int_{-1}^{1} u_{x}\\, dx = u(1) - u(-1)$。在这里，Simpson 法则不能精确地积分 $u_{x}=5x^{4}$，所产生的求积误差直接表现为守恒缺陷。", "answer": "$$\\boxed{\\frac{4}{3}}$$", "id": "3382930"}, {"introduction": "实际的模拟常常需要包含悬挂节点的复杂非协调网格，这给维持守恒性带来了挑战。本练习通过要求您设计一个通量分配方案来解决这个高级场景。其目标是确保在粗糙父单元面上计算的通量能够守恒地分配给相邻的加密子单元面，从而保持分部积分在界面上所保证的精确平衡。这项技术对于开发具有自适应网格加密功能的稳健DG方法至关重要。[@problem_id:3382918]", "problem": "考虑二维空间中的标量线性平流方程，\n$$\n\\partial_{t} u + \\nabla \\cdot \\boldsymbol{F}(u) = 0, \\quad \\boldsymbol{F}(u) = \\boldsymbol{v} \\, u,\n$$\n其中速度向量 $\\boldsymbol{v} = (v_{x}, v_{y})$ 为常数，且满足 $v_{x}  0$。在间断伽辽金（Discontinuous Galerkin, DG）方法中，通过在每个单元上应用分部积分（integration by parts, IBP）并将界面通量替换为数值通量，可以得到单元弱形式。考虑一个具有悬挂节点配置的非协调网格：一个矩形父单元 $E_{p}$ 的东侧面 $F$ 长度为 $2$，与两个加密的子单元 $E_{c,1}$ 和 $E_{c,2}$ 相邻，这两个子单元分别通过两个长度为 $1$ 和 $1$ 的子面 $F_{1}$ 和 $F_{2}$ 与 $F$ 相接。用坐标 $y \\in [0,2]$ 参数化 $F$，使得 $F_{1}$ 对应于 $y \\in [0,1]$，$F_{2}$ 对应于 $y \\in [1,2]$。设父单元在 $F$ 上的单位外法向量为 $\\boldsymbol{n}_{p} = (1,0)$，子单元西侧面上的单位外法向量为 $\\boldsymbol{n}_{c} = (-1,0)$。\n\n假设 $F$ 上的数值通量是平流的迎风通量，即对于 $v_{x}  0$，它使用父单元的迹 $u_{p}(y)$；因此，父单元边界项中的面积分被积函数为 $(\\boldsymbol{v} \\cdot \\boldsymbol{n}_{p}) u_{p}(y) = v_{x} u_{p}(y)$。父单元使用两点高斯-勒让德求积法在 $[0,2]$ 上计算其在 $F$ 上的面积分，节点为\n$$\ny_{1} = 1 - \\frac{1}{\\sqrt{3}}, \\quad y_{2} = 1 + \\frac{1}{\\sqrt{3}},\n$$\n权重分别为 $1$ 和 $1$。每个子单元使用对线性函数精确的单点高斯求积法计算其在子面上的面积分：在 $F_{1}$ 上的中点 $y = \\frac{1}{2}$ 和在 $F_{2}$ 上的中点 $y = \\frac{3}{2}$，权重分别为 $1$ 和 $1$。\n\n为了在具有悬挂节点的网格上，在单元分部积分下保持局部守恒，设计一个从父单元面到子单元子面的守恒通量分配，具体如下：对于 $[0,2]$ 上的任意线性函数 $g(y)$，要求其精确的子面积分\n$$\n\\int_{0}^{1} g(y) \\, dy \\quad \\text{和} \\quad \\int_{1}^{2} g(y) \\, dy\n$$\n可以通过父单元在 $g(y_{1})$ 和 $g(y_{2})$ 处的求值的线性组合来恢复，\n$$\n\\int_{0}^{1} g(y) \\, dy = \\alpha_{11} \\, g(y_{1}) + \\alpha_{12} \\, g(y_{2}), \\qquad\n\\int_{1}^{2} g(y) \\, dy = \\alpha_{21} \\, g(y_{1}) + \\alpha_{22} \\, g(y_{2}),\n$$\n其中系数 $\\alpha_{11}, \\alpha_{12}, \\alpha_{21}, \\alpha_{22}$ 不依赖于 $g$。这些系数将用于将父单元面积分求积的贡献在分裂的面上守恒地分配给子单元。\n\n从 $E_{p}$ 和 $E_{c,1}, E_{c,2}$ 上的 DG 弱形式和 IBP 出发，导出上述要求对 $[0,2]$ 上的多项式基 $\\{1, y\\}$ 所隐含的矩匹配条件，并求解四个通量分配系数 $\\alpha_{11}, \\alpha_{12}, \\alpha_{21}, \\alpha_{22}$ 的闭式解析表达式。你的最终答案应为这四个系数，按 $\\alpha_{11}, \\alpha_{12}, \\alpha_{21}, \\alpha_{22}$ 的顺序排列，并表示为单行矩阵。无需四舍五入。", "solution": "问题要求确定四个通量分配系数 $\\alpha_{11}$、$\\alpha_{12}$、$\\alpha_{21}$ 和 $\\alpha_{22}$，这些系数确保任意线性函数 $g(y)$ 在两个子区间上的精确积分可以通过该函数在两个特定点上的值的线性组合来恢复。给定的条件是：\n$$\n\\int_{0}^{1} g(y) \\, dy = \\alpha_{11} \\, g(y_{1}) + \\alpha_{12} \\, g(y_{2})\n$$\n$$\n\\int_{1}^{2} g(y) \\, dy = \\alpha_{21} \\, g(y_{1}) + \\alpha_{22} \\, g(y_{2})\n$$\n这些条件必须对区间 $[0,2]$ 上的任何线性函数 $g(y)$ 成立。求值点是父单元在 $[0,2]$ 上的高斯求积节点，给定为 $y_{1} = 1 - \\frac{1}{\\sqrt{3}}$ 和 $y_{2} = 1 + \\frac{1}{\\sqrt{3}}$。\n\n为了求解这四个未知系数，只需对线性多项式空间 $\\mathcal{P}^1([0,2])$ 的一组基强制施加这些条件即可。我们将使用基 $\\{1, y\\}$。\n\n首先，我们使用关于区间 $[0,1]$ 的第一个方程来确定系数 $\\alpha_{11}$ 和 $\\alpha_{12}$。\n\n情况 1：$g(y) = 1$。\n左侧（LHS）是精确积分：\n$$\n\\int_{0}^{1} 1 \\, dy = [y]_{0}^{1} = 1 - 0 = 1\n$$\n右侧（RHS）是：\n$$\n\\alpha_{11} g(y_{1}) + \\alpha_{12} g(y_{2}) = \\alpha_{11}(1) + \\alpha_{12}(1) = \\alpha_{11} + \\alpha_{12}\n$$\n令 LHS 和 RHS 相等，得到我们的第一个方程：\n$$\n\\alpha_{11} + \\alpha_{12} = 1 \\quad (1)\n$$\n\n情况 2：$g(y) = y$。\nLHS 是精确积分：\n$$\n\\int_{0}^{1} y \\, dy = \\left[\\frac{y^2}{2}\\right]_{0}^{1} = \\frac{1^2}{2} - \\frac{0^2}{2} = \\frac{1}{2}\n$$\nRHS 是：\n$$\n\\alpha_{11} g(y_{1}) + \\alpha_{12} g(y_{2}) = \\alpha_{11} y_{1} + \\alpha_{12} y_{2} = \\alpha_{11} \\left(1 - \\frac{1}{\\sqrt{3}}\\right) + \\alpha_{12} \\left(1 + \\frac{1}{\\sqrt{3}}\\right)\n$$\n令 LHS 和 RHS 相等，得到我们的第二个方程：\n$$\n\\alpha_{11} \\left(1 - \\frac{1}{\\sqrt{3}}\\right) + \\alpha_{12} \\left(1 + \\frac{1}{\\sqrt{3}}\\right) = \\frac{1}{2} \\quad (2)\n$$\n我们现在求解线性方程组 (1) 和 (2)。整理方程 (2)：\n$$\n(\\alpha_{11} + \\alpha_{12}) + \\frac{1}{\\sqrt{3}}(-\\alpha_{11} + \\alpha_{12}) = \\frac{1}{2}\n$$\n将方程 (1) 代入此表达式：\n$$\n1 + \\frac{1}{\\sqrt{3}}(-\\alpha_{11} + \\alpha_{12}) = \\frac{1}{2}\n$$\n$$\n\\frac{1}{\\sqrt{3}}(-\\alpha_{11} + \\alpha_{12}) = -\\frac{1}{2}\n$$\n$$\n-\\alpha_{11} + \\alpha_{12} = -\\frac{\\sqrt{3}}{2} \\quad (3)\n$$\n我们现在有一个由方程 (1) 和 (3) 组成的更简单的方程组：\n$$\n\\alpha_{11} + \\alpha_{12} = 1\n$$\n$$\n-\\alpha_{11} + \\alpha_{12} = -\\frac{\\sqrt{3}}{2}\n$$\n将这两个方程相加得到 $2\\alpha_{12} = 1 - \\frac{\\sqrt{3}}{2}$，所以 $\\alpha_{12} = \\frac{1}{2} - \\frac{\\sqrt{3}}{4}$。\n从第一个新方程中减去第二个得到 $2\\alpha_{11} = 1 - (-\\frac{\\sqrt{3}}{2}) = 1 + \\frac{\\sqrt{3}}{2}$，所以 $\\alpha_{11} = \\frac{1}{2} + \\frac{\\sqrt{3}}{4}$。\n\n接下来，我们使用关于区间 $[1,2]$ 的第二个方程来确定系数 $\\alpha_{21}$ 和 $\\alpha_{22}$。\n\n情况 3：$g(y) = 1$。\nLHS 是：\n$$\n\\int_{1}^{2} 1 \\, dy = [y]_{1}^{2} = 2 - 1 = 1\n$$\nRHS 是：\n$$\n\\alpha_{21} g(y_{1}) + \\alpha_{22} g(y_{2}) = \\alpha_{21}(1) + \\alpha_{22}(1) = \\alpha_{21} + \\alpha_{22}\n$$\n这给出我们的第三个方程：\n$$\n\\alpha_{21} + \\alpha_{22} = 1 \\quad (4)\n$$\n\n情况 4：$g(y) = y$。\nLHS 是：\n$$\n\\int_{1}^{2} y \\, dy = \\left[\\frac{y^2}{2}\\right]_{1}^{2} = \\frac{2^2}{2} - \\frac{1^2}{2} = 2 - \\frac{1}{2} = \\frac{3}{2}\n$$\nRHS 是：\n$$\n\\alpha_{21} g(y_{1}) + \\alpha_{22} g(y_{2}) = \\alpha_{21} y_{1} + \\alpha_{22} y_{2} = \\alpha_{21} \\left(1 - \\frac{1}{\\sqrt{3}}\\right) + \\alpha_{22} \\left(1 + \\frac{1}{\\sqrt{3}}\\right)\n$$\n这给出我们的第四个方程：\n$$\n\\alpha_{21} \\left(1 - \\frac{1}{\\sqrt{3}}\\right) + \\alpha_{22} \\left(1 + \\frac{1}{\\sqrt{3}}\\right) = \\frac{3}{2} \\quad (5)\n$$\n我们求解方程组 (4) 和 (5)。整理方程 (5)：\n$$\n(\\alpha_{21} + \\alpha_{22}) + \\frac{1}{\\sqrt{3}}(-\\alpha_{21} + \\alpha_{22}) = \\frac{3}{2}\n$$\n代入方程 (4)：\n$$\n1 + \\frac{1}{\\sqrt{3}}(-\\alpha_{21} + \\alpha_{22}) = \\frac{3}{2}\n$$\n$$\n\\frac{1}{\\sqrt{3}}(-\\alpha_{21} + \\alpha_{22}) = \\frac{1}{2}\n$$\n$$\n-\\alpha_{21} + \\alpha_{22} = \\frac{\\sqrt{3}}{2} \\quad (6)\n$$\n我们现在求解由方程 (4) 和 (6) 组成的方程组：\n$$\n\\alpha_{21} + \\alpha_{22} = 1\n$$\n$$\n-\\alpha_{21} + \\alpha_{22} = \\frac{\\sqrt{3}}{2}\n$$\n将这两个方程相加得到 $2\\alpha_{22} = 1 + \\frac{\\sqrt{3}}{2}$，所以 $\\alpha_{22} = \\frac{1}{2} + \\frac{\\sqrt{3}}{4}$。\n从第一个新方程中减去第二个得到 $2\\alpha_{21} = 1 - \\frac{\\sqrt{3}}{2}$，所以 $\\alpha_{21} = \\frac{1}{2} - \\frac{\\sqrt{3}}{4}$。\n\n四个通量分配系数为：\n$\\alpha_{11} = \\frac{1}{2} + \\frac{\\sqrt{3}}{4}$\n$\\alpha_{12} = \\frac{1}{2} - \\frac{\\sqrt{3}}{4}$\n$\\alpha_{21} = \\frac{1}{2} - \\frac{\\sqrt{3}}{4}$\n$\\alpha_{22} = \\frac{1}{2} + \\frac{\\sqrt{3}}{4}$", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{1}{2} + \\frac{\\sqrt{3}}{4}  \\frac{1}{2} - \\frac{\\sqrt{3}}{4}  \\frac{1}{2} - \\frac{\\sqrt{3}}{4}  \\frac{1}{2} + \\frac{\\sqrt{3}}{4} \\end{pmatrix}}\n$$", "id": "3382918"}]}