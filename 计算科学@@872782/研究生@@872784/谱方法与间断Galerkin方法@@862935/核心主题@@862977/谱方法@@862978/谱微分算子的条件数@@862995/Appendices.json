{"hands_on_practices": [{"introduction": "谱微分算子是出了名的病态，但这种病态性源于何处？通过分析算子对不同频率基函数（模式）的作用，我们可以揭示其根源。此练习 [@problem_id:3372568] 将引导你通过推导条件数的渐近尺度，从根本上理解谱方法为何病态，并将这一现象与微分算子放大高频分量的本质联系起来。", "problem": "考虑由 $x_j = \\cos\\left(\\frac{\\pi j}{N}\\right)$（其中 $j \\in \\{0,1,\\dots,N\\}$）定义的 Chebyshev–Gauss–Lobatto 网格，并令 $D \\in \\mathbb{R}^{(N+1)\\times(N+1)}$ 表示通过对构建在 $\\{x_j\\}$ 上的 $N$ 次拉格朗日插值多项式求导得到的谱微分矩阵。令 $\\omega_j$ 表示任意一组求积权重，该权重能够对与 Chebyshev 权重 $w(x) = \\frac{1}{\\sqrt{1-x^2}}$ 相关联的带权 $L^2$ 内积产生一个谱精确的离散近似，即对于足够光滑的函数 $f$，有 $\\sum_{j=0}^{N} \\omega_j f(x_j) \\approx \\int_{-1}^{1} \\frac{f(x)}{\\sqrt{1-x^2}}\\,dx$，且误差衰减速度快于 $N$ 的任何次幂。对向量 $v \\in \\mathbb{R}^{N+1}$ 定义离散带权 $\\ell^2$ 范数为 $\\|v\\|_{2,w} = \\left(\\sum_{j=0}^{N} \\omega_j |v_j|^2\\right)^{1/2}$，并定义零均值子空间为\n$$\n\\mathcal{M} = \\left\\{ v \\in \\mathbb{R}^{N+1} : \\sum_{j=0}^{N} \\omega_j v_j = 0 \\right\\}。\n$$\n考虑限制 $D|_{\\mathcal{M}}$ 及其奇异值分解 (SVD)，即关于由 $\\|\\cdot\\|_{2,w}$ 导出的内积的奇异值和奇异向量分解。令 $\\sigma_{\\min}(N)$ 和 $\\sigma_{\\max}(N)$ 分别表示 $D|_{\\mathcal{M}}$ 在带权 $\\ell^2$ 范数下的最小和最大奇异值。仅使用关于 Chebyshev 多项式、节点分布 $\\{x_j\\}$以及谱精确求积与相应连续带权 $L^2$ 范数之间的范数等价性的基本事实，推导当 $N \\to \\infty$ 时 $\\sigma_{\\min}(N)$ 和 $\\sigma_{\\max}(N)$ 的渐近尺度，并解释与这两个极值奇异值相关联的右奇异向量的主要模态内容（以 Chebyshev 多项式表示）。\n\n您最终报告的量必须是条件数\n$$\n\\kappa(N) = \\frac{\\sigma_{\\max}(N)}{\\sigma_{\\min}(N)} \\sim C N^{\\alpha}\n$$\n的领阶渐近尺度中的指数 $\\alpha$，其中 $C>0$ 是一个与 $N$ 无关的常数。请提供 $\\alpha$ 的单一值作为您的最终答案。无需四舍五入。", "solution": "用户想要确定限制在零均值子空间上的 Chebyshev 谱微分矩阵的条件数的渐近尺度。\n\n问题定义在 Chebyshev-Gauss-Lobatto (CGL) 网格 $x_j = \\cos\\left(\\frac{\\pi j}{N}\\right)$（其中 $j \\in \\{0, 1, \\dots, N\\}$）上。令 $D$ 为相关的 $(N+1) \\times (N+1)$ 谱微分矩阵。分析是关于离散带权内积 $\\langle u, v \\rangle_{2,w} = \\sum_{j=0}^{N} \\omega_j u_j v_j$ 进行的，该内积导出范数 $\\|v\\|_{2,w} = \\left(\\sum_{j=0}^{N} \\omega_j |v_j|^2\\right)^{1/2}$。权重 $\\omega_j$ 使得该内积是连续带权内积 $\\langle f, g \\rangle_{L^2_w} = \\int_{-1}^{1} \\frac{f(x)g(x)}{\\sqrt{1-x^2}}\\,dx$ 的一个谱精确近似。问题依赖于 $\\|v\\|_{2,w}$ 和 $\\|p\\|_{L^2_w}$ 之间的范数等价性，其中对于一个次数至多为 $N$ 的多项式 $p(x)$，有 $v_j=p(x_j)$。\n\n算子被限制在零均值子空间 $\\mathcal{M} = \\left\\{ v \\in \\mathbb{R}^{N+1} : \\sum_{j=0}^{N} \\omega_j v_j = 0 \\right\\}$ 上。这个离散条件对于相应的多项式 $p(x)$ 而言，等价于连续条件 $\\int_{-1}^{1} \\frac{p(x)}{\\sqrt{1-x^2}}\\,dx=0$。在 Chebyshev 多项式 $T_k(x)$ 的基中，这个条件意味着 $T_0(x)=1$ 的系数为零。因此，$\\mathcal{M}$ 对应于多项式空间 $\\text{span}\\{T_1(x), T_2(x), \\dots, T_N(x)\\}$。\n\n受限算子 $D|_{\\mathcal{M}}$ 的奇异值 $\\sigma$ 由 $(D|_{\\mathcal{M}})^* (D|_{\\mathcal{M}})$ 的特征值的平方根给出，其中伴随是关于带权内积计算的。等价地，它们由瑞利商刻画：\n$$\n\\sigma = \\sup_{v \\in \\mathcal{M}, v \\neq 0} \\frac{\\|Dv\\|_{2,w}}{\\|v\\|_{2,w}}\n$$\n根据问题中陈述的范数等价性原理，离散算子 $D$ 的奇异值的尺度可以通过分析作用于相应多项式空间上的连续微分算子 $\\mathcal{D} = \\frac{d}{dx}$ 的范数来确定，其中范数是在 $L^2_w$ 中计算的。我们寻求 $\\sigma_{\\min}(N)$ 和 $\\sigma_{\\max}(N)$ 的尺度，它们分别对应于比值 $\\frac{\\|\\mathcal{D}p\\|_{L^2_w}}{\\|p\\|_{L^2_w}}$ 在所有 $p \\in \\text{span}\\{T_1, \\dots, T_N\\}$ 上的下确界和上确界。\n\n### **最小奇异值 $\\sigma_{\\min}(N)$ 的分析**\n\n最小奇异值对应于被微分放大得最少的模态。这对应于空间 $\\mathcal{M}$ 中“最光滑”或频率最低的函数。与 $\\mathcal{M}$ 对应的多项式空间的基是 $\\{T_k(x)\\}_{k=1}^N$。最低频率的模态是 $T_1(x)=x$。\n\n我们来计算多项式 $p(x) = T_1(x)$ 的瑞利商：\n$p(x)$ 在 $L^2_w$ 中的范数平方为：\n$$\n\\|T_1\\|^2_{L^2_w} = \\int_{-1}^{1} \\frac{T_1(x)^2}{\\sqrt{1-x^2}}\\,dx = \\frac{\\pi}{2}\n$$\n其导数为 $p'(x) = T_1'(x) = 1 = T_0(x)$。导数的范数平方为：\n$$\n\\|T_1'\\|^2_{L^2_w} = \\int_{-1}^{1} \\frac{T_0(x)^2}{\\sqrt{1-x^2}}\\,dx = \\pi\n$$\n$T_1(x)$ 的瑞利商为 $\\frac{\\|T_1'\\|_{L^2_w}}{\\|T_1\\|_{L^2_w}} = \\sqrt{\\frac{\\pi}{\\pi/2}} = \\sqrt{2}$。\n\n这为最小奇异值提供了一个上界。由于作用在零均值函数空间上的算子 $\\mathcal{D}$ 是可逆的，其奇异值有大于零的下界。空间族 $\\text{span}\\{T_1, \\dots, T_N\\}$ 是嵌套的。最小奇异值 $\\sigma_{\\min}(N)$ 是 $N$ 的非增函数，并且由一个正常数从下方界定。因此，当 $N \\to \\infty$ 时，它收敛到一个正常数。\n$$\n\\sigma_{\\min}(N) \\sim O(1)\n$$\n与 $\\sigma_{\\min}(N)$ 相关联的右奇异向量由最低频率模态 $T_1(x)$ 主导。\n\n### **最大奇异值 $\\sigma_{\\max}(N)$ 的分析**\n\n最大奇异值是算子范数 $\\|D|_{\\mathcal{M}}\\|_{2,w}$。为了找到它的尺度，我们可以构造一个被 $D$ 极大放大的测试向量 $v \\in \\mathcal{M}$。众所周知，微分算子对快速变化的函数会产生很大的导数。在 CGL 网格上，节点密度在端点 $x=\\pm 1$ 附近最高。这表明，一个局部化在端点附近的函数将具有大的离散导数。\n\n让我们考虑与节点 $x_0 = 1$ 相关联的拉格朗日基多项式 $p_0(x)=L_0(x)$。对应的向量 $v^{(0)}$ 的分量为 $v^{(0)}_j = \\delta_{j0}$。这个向量不在零均值子空间 $\\mathcal{M}$ 中，因为 $\\sum_{j=0}^N \\omega_j v^{(0)}_j = \\omega_0 \\neq 0$。我们将 $v^{(0)}$ 投影到 $\\mathcal{M}$ 上以获得一个有效的测试向量 $\\tilde{v}$。与常数函数 $T_0(x)=1$ 对应的向量是 $\\mathbf{1}=(1,1,\\dots,1)^T$。投影为：\n$$\n\\tilde{v} = v^{(0)} - \\frac{\\langle v^{(0)}, \\mathbf{1} \\rangle_{2,w}}{\\|\\mathbf{1}\\|_{2,w}^2} \\mathbf{1}\n$$\n我们有 $\\langle v^{(0)}, \\mathbf{1} \\rangle_{2,w} = \\sum_{j=0}^N \\omega_j \\delta_{j0} (1) = \\omega_0$。求积权重之和对于 $T_0(x)=1$ 的积分是精确的：$\\|\\mathbf{1}\\|_{2,w}^2 = \\sum_{j=0}^N \\omega_j = \\int_{-1}^1 \\frac{1}{\\sqrt{1-x^2}}dx = \\pi$。所以，$\\tilde{v} = v^{(0)} - \\frac{\\omega_0}{\\pi} \\mathbf{1}$。\n\n现在我们计算 $\\tilde{v}$ 和 $D\\tilde{v}$ 的范数。$\\tilde{v}$ 的范数平方为：\n$$\n\\|\\tilde{v}\\|_{2,w}^2 = \\|v^{(0)}\\|_{2,w}^2 - \\frac{|\\langle v^{(0)}, \\mathbf{1} \\rangle_{2,w}|^2}{\\|\\mathbf{1}\\|_{2,w}^2} = \\omega_0 - \\frac{\\omega_0^2}{\\pi}\n$$\n对于常用的 Clenshaw-Curtis 求积权重，有 $\\omega_0 = \\frac{\\pi}{2N}$。因此，$\\|\\tilde{v}\\|_{2,w}^2 = \\frac{\\pi}{2N} - O(N^{-2})$，其尺度为 $O(N^{-1})$。\n\n接下来，我们计算 $D\\tilde{v}$。因为 $D$ 作用于常数向量为零，所以 $D\\mathbf{1}=0$。\n$$\nD\\tilde{v} = D\\left(v^{(0)} - \\frac{\\omega_0}{\\pi} \\mathbf{1}\\right) = Dv^{(0)}\n$$\n向量 $Dv^{(0)}$ 是微分矩阵 $D$ 的第 $0$ 列。其分量为 $(Dv^{(0)})_j = D_{j0}$。范数平方为：\n$$\n\\|D\\tilde{v}\\|_{2,w}^2 = \\|Dv^{(0)}\\|_{2,w}^2 = \\sum_{j=0}^{N} \\omega_j (D_{j0})^2\n$$\nChebyshev 微分矩阵的元素是已知的。第 $0$ 列中的主导元素是对角元素：\n$$\nD_{00} = \\frac{2N^2+1}{6} \\sim O(N^2)\n$$\n非对角元素 $D_{j0}$ 较小。$j=0$ 项对求和的贡献将主导其尺度。让我们用这一项来近似范数：\n$$\n\\|D\\tilde{v}\\|_{2,w}^2 \\approx \\omega_0 (D_{00})^2 \\approx \\left(\\frac{\\pi}{2N}\\right) \\left(\\frac{2N^2+1}{6}\\right)^2 \\approx \\frac{\\pi}{2N} \\frac{4N^4}{36} = \\frac{\\pi}{18} N^3\n$$\n范数的平方尺度为 $O(N^3)$。\n这个测试向量 $\\tilde{v}$ 的瑞利商是：\n$$\n\\frac{\\|D\\tilde{v}\\|_{2,w}^2}{\\|\\tilde{v}\\|_{2,w}^2} \\approx \\frac{O(N^3)}{O(N^{-1})} = O(N^4)\n$$\n因为 $\\sigma_{\\max}^2(N) \\ge \\frac{\\|D\\tilde{v}\\|_{2,w}^2}{\\|\\tilde{v}\\|_{2,w}^2}$，我们有 $\\sigma_{\\max}^2(N) \\sim O(N^4)$，这意味着：\n$$\n\\sigma_{\\max}(N) \\sim O(N^2)\n$$\n这是 Chebyshev 微分的一个著名结果。与 $\\sigma_{\\max}(N)$ 相关联的右奇异向量不是单个 Chebyshev 多项式，而是一个高度局部化在某个边界（$x=\\pm 1$）附近的函数，它是许多 $T_k(x)$ 模态的宽带叠加。\n\n### **条件数尺度**\n条件数 $\\kappa(N)$ 是最大奇异值与最小奇异值的比值：\n$$\n\\kappa(N) = \\frac{\\sigma_{\\max}(N)}{\\sigma_{\\min}(N)} \\sim \\frac{O(N^2)}{O(1)} = O(N^2)\n$$\n问题要求的是尺度定律 $\\kappa(N) \\sim C N^\\alpha$ 中的指数 $\\alpha$。与我们的结果比较，我们发现 $\\alpha=2$。", "answer": "$$\n\\boxed{2}\n$$", "id": "3372568"}, {"introduction": "在完成理论分析之后，让我们通过一个具体的低维算例来动手实践。我们将为勒让德-高斯-洛巴托节点手动构建一个 $3 \\times 3$ 的微分矩阵 $D$ 及其相关的对称刚度类矩阵 $S$。这个练习 [@problem_id:3372555] 将抽象的定义转化为可计算的实体，从而加深你的理解。它还揭示了如何通过恰当的加权来获得一个更易于分析的对称矩阵，并让你有机会应用Gershgorin圆盘定理等特征值估计工具。", "problem": "考虑在区间 $[-1,1]$ 上，多项式次数为 $n=2$ 的 Legendre–Gauss–Lobatto (LGL) 配置，其节点为 $x_0=-1$，$x_1=0$，$x_2=1$，求积权重为 $w_0=w_2=\\frac{1}{3}$ 和 $w_1=\\frac{4}{3}$。设 $\\{\\ell_j(x)\\}_{j=0}^2$ 是与这些节点相关联的 Lagrange 基多项式，并设谱微分矩阵 $D\\in\\mathbb{R}^{3\\times 3}$ 定义为 $D_{ij}=\\ell_j'(x_i)$，$0\\le i,j\\le 2$。设对角质量矩阵为 $W=\\mathrm{diag}(w_0,w_1,w_2)$，并定义对角加权的对称刚度类矩阵\n$$\nS \\;=\\; -\\,W^{-1/2}\\,D^{\\top}\\,W\\,D\\,W^{-1/2}\\,\\in\\mathbb{R}^{3\\times 3}.\n$$\n你的任务是：\n- 仅使用上述定义和第一性原理（例如，Lagrange 多项式的性质和标准矩阵范数），显式地构造 $D$ 并构成 $S$。\n- 应用 Gershgorin 圆盘定理推导 $D$ 和 $S$ 的 Gershgorin 圆盘，并将其并集写成实线上的区间（注意 $S$ 是对称的）。\n- 计算 $D$ 和 $S$ 的精确特征值，以评估 Gershgorin 界的紧致性，并讨论将 $D$ 映射到 $S$ 的对角权重缩放所提供的定性条件数见解。\n\n最后，设 $\\rho$ 表示 $S$ 的谱半径（最大绝对特征值），并设 $\\rho_G$ 表示由 $S$ 的 Gershgorin 区间所蕴含的关于 $|\\lambda|$ 的最小统一界（即 Gershgorin 并集端点上的最大绝对值）。给出比值 $\\rho_G/\\rho$ 的精确值作为你的最终答案。最终答案需以精确形式表示，无需四舍五入。", "solution": "该问题要求对多项式次数为 $n=2$ 的 Legendre–Gauss–Lobatto (LGL) 配置下的谱微分矩阵 $D$ 和一个相关的对称刚度类矩阵 $S$ 进行详细分析。任务包括构造这些矩阵、应用 Gershgorin 圆盘定理、计算它们的精确特征值、讨论条件数，并最后计算一个从 $S$ 的分析中导出的特定比值。\n\n首先，我们构造微分矩阵 $D$。对于 $n=2$，LGL 节点给定为 $x_0=-1$，$x_1=0$ 和 $x_2=1$。相应的 Lagrange 基多项式 $\\{\\ell_j(x)\\}_{j=0}^2$ 是：\n$$\n\\ell_0(x) = \\frac{(x-x_1)(x-x_2)}{(x_0-x_1)(x_0-x_2)} = \\frac{x(x-1)}{(-1)(-2)} = \\frac{1}{2}(x^2 - x)\n$$\n$$\n\\ell_1(x) = \\frac{(x-x_0)(x-x_2)}{(x_1-x_0)(x_1-x_2)} = \\frac{(x+1)(x-1)}{(1)(-1)} = 1 - x^2\n$$\n$$\n\\ell_2(x) = \\frac{(x-x_0)(x-x_1)}{(x_2-x_0)(x_2-x_1)} = \\frac{(x+1)x}{(2)(1)} = \\frac{1}{2}(x^2 + x)\n$$\n它们的导数是：\n$$\n\\ell_0'(x) = x - \\frac{1}{2}, \\quad \\ell_1'(x) = -2x, \\quad \\ell_2'(x) = x + \\frac{1}{2}\n$$\n微分矩阵 $D$ 的元素是 $D_{ij} = \\ell_j'(x_i)$。在节点处计算导数：\n$$\nD_{0j} = (\\ell_0'(-1), \\ell_1'(-1), \\ell_2'(-1)) = (-\\frac{3}{2}, 2, -\\frac{1}{2})\n$$\n$$\nD_{1j} = (\\ell_0'(0), \\ell_1'(0), \\ell_2'(0)) = (-\\frac{1}{2}, 0, \\frac{1}{2})\n$$\n$$\nD_{2j} = (\\ell_0'(1), \\ell_1'(1), \\ell_2'(1)) = (\\frac{1}{2}, -2, \\frac{3}{2})\n$$\n因此，微分矩阵是：\n$$\nD = \\begin{pmatrix} -3/2 & 2 & -1/2 \\\\ -1/2 & 0 & 1/2 \\\\ 1/2 & -2 & 3/2 \\end{pmatrix}\n$$\n\n接下来，我们构造矩阵 $S$。求积权重给定为 $w_0=1/3$，$w_1=4/3$，$w_2=1/3$。对角质量矩阵是 $W = \\mathrm{diag}(1/3, 4/3, 1/3)$，其逆平方根是 $W^{-1/2} = \\mathrm{diag}(\\sqrt{3}, \\sqrt{3}/2, \\sqrt{3})$。\n矩阵 $S$ 定义为 $S = -W^{-1/2}\\,D^{\\top}\\,W\\,D\\,W^{-1/2}$。我们首先计算刚度矩阵 $K = D^\\top W D$：\n$$\nK = \\begin{pmatrix} -3/2 & -1/2 & 1/2 \\\\ 2 & 0 & -2 \\\\ -1/2 & 1/2 & 3/2 \\end{pmatrix} \\begin{pmatrix} 1/3 & 0 & 0 \\\\ 0 & 4/3 & 0 \\\\ 0 & 0 & 1/3 \\end{pmatrix} \\begin{pmatrix} -3/2 & 2 & -1/2 \\\\ -1/2 & 0 & 1/2 \\\\ 1/2 & -2 & 3/2 \\end{pmatrix}\n$$\n$$\nK = \\begin{pmatrix} -1/2 & -2/3 & 1/6 \\\\ 2/3 & 0 & -2/3 \\\\ -1/6 & 2/3 & 1/2 \\end{pmatrix} \\begin{pmatrix} -3/2 & 2 & -1/2 \\\\ -1/2 & 0 & 1/2 \\\\ 1/2 & -2 & 3/2 \\end{pmatrix} = \\begin{pmatrix} 7/6 & -4/3 & 1/6 \\\\ -4/3 & 8/3 & -4/3 \\\\ 1/6 & -4/3 & 7/6 \\end{pmatrix}\n$$\n现在我们应用缩放：$S = -W^{-1/2} K W^{-1/2}$。\n$$\nS = - \\begin{pmatrix} \\sqrt{3} & 0 & 0 \\\\ 0 & \\sqrt{3}/2 & 0 \\\\ 0 & 0 & \\sqrt{3} \\end{pmatrix} \\begin{pmatrix} 7/6 & -4/3 & 1/6 \\\\ -4/3 & 8/3 & -4/3 \\\\ 1/6 & -4/3 & 7/6 \\end{pmatrix} \\begin{pmatrix} \\sqrt{3} & 0 & 0 \\\\ 0 & \\sqrt{3}/2 & 0 \\\\ 0 & 0 & \\sqrt{3} \\end{pmatrix}\n$$\n$$\nS = - \\begin{pmatrix} 3(7/6) & (3/2)(-4/3) & 3(1/6) \\\\ (3/2)(-4/3) & (3/4)(8/3) & (3/2)(-4/3) \\\\ 3(1/6) & (3/2)(-4/3) & 3(7/6) \\end{pmatrix} = - \\begin{pmatrix} 7/2 & -2 & 1/2 \\\\ -2 & 2 & -2 \\\\ 1/2 & -2 & 7/2 \\end{pmatrix}\n$$\n$$\nS = \\begin{pmatrix} -7/2 & 2 & -1/2 \\\\ 2 & -2 & 2 \\\\ -1/2 & 2 & -7/2 \\end{pmatrix}\n$$\n\n现在，我们应用 Gershgorin 圆盘定理。对于一个矩阵 $A$，圆盘是 $G_i = \\{z \\in \\mathbb{C} : |z - A_{ii}| \\leq \\sum_{j \\neq i} |A_{ij}|\\}$。\n对于 $D$：\n$G_0$：圆心 $z_0 = -3/2$，半径 $R_0 = |2| + |-1/2| = 5/2$。\n$G_1$：圆心 $z_1 = 0$，半径 $R_1 = |-1/2| + |1/2| = 1$。\n$G_2$：圆心 $z_2 = 3/2$，半径 $R_2 = |1/2| + |-2| = 5/2$。\n问题要求将并集写成实线上的区间。这可以解释为圆盘并集与实轴的交集。\n$G_0 \\cap \\mathbb{R} = [-3/2 - 5/2, -3/2 + 5/2] = [-4, 1]$。\n$G_1 \\cap \\mathbb{R} = [-1, 1]$。\n$G_2 \\cap \\mathbb{R} = [3/2 - 5/2, 3/2 + 5/2] = [-1, 4]$。\n这些区间的并集是 $[-4, 4]$。\n\n对于对称矩阵 $S$，其特征值是实数，所以 Gershgorin 圆盘是实线上的区间。\n$G_0$：圆心 $c_0 = -7/2$，半径 $R_0 = |2| + |-1/2| = 5/2$。区间是 $[-7/2 - 5/2, -7/2 + 5/2] = [-6, -1]$。\n$G_1$：圆心 $c_1 = -2$，半径 $R_1 = |2| + |2| = 4$。区间是 $[-2 - 4, -2 + 4] = [-6, 2]$。\n$G_2$：圆心 $c_2 = -7/2$，半径 $R_2 = |-1/2| + |2| = 5/2$。区间是 $[-7/2 - 5/2, -7/2 + 5/2] = [-6, -1]$。\n$S$ 的 Gershgorin 区间的并集是 $[-6, 2]$。\n\n接下来，我们计算精确的特征值。\n对于 $D$，每行的和为 $0$，所以 $D\\mathbf{1}=\\mathbf{0}$，意味着 $\\lambda=0$ 是一个特征值。特征多项式是 $\\det(D-\\lambda I)$。\n$\\mathrm{tr}(D) = -3/2 + 0 + 3/2 = 0$。\n$\\det(D) = (-3/2)(0 - (-1)) - 2(-3/4-1/4) + (-1/2)(1-0) = -3/2 - 2(-1) - 1/2 = -2+2=0$。\n$2 \\times 2$ 主子式之和为 $C_2 = (1) + (-9/4 - (-1/4)) + (1) = 1-2+1=0$。\n特征多项式是 $-\\lambda^3 + \\mathrm{tr}(D)\\lambda^2 - C_2\\lambda + \\det(D) = -\\lambda^3 = 0$。\n因此，$D$ 的所有特征值都是 $0$。$D$ 是一个幂零矩阵；具体来说，$D^3=0$。Gershgorin 界是正确的（圆盘并集包含 $0$）但非常松弛。\n\n对于 $S$，我们知道它是奇异的，因为 $\\det(S) \\propto \\det(D^\\top W D) = \\det(D^\\top)\\det(W)\\det(D) = 0$。所以 $\\lambda_1=0$ 是一个特征值。\n迹为 $\\mathrm{tr}(S) = -7/2 - 2 - 7/2 = -9$。因为 $\\lambda_1+\\lambda_2+\\lambda_3=-9$，我们有 $\\lambda_2+\\lambda_3=-9$。\n$2 \\times 2$ 主子式之和为：\n$C_2 = \\det\\begin{pmatrix}-7/2 & 2 \\\\ 2 & -2\\end{pmatrix} + \\det\\begin{pmatrix}-7/2 & -1/2 \\\\ -1/2 & -7/2\\end{pmatrix} + \\det\\begin{pmatrix}-2 & 2 \\\\ 2 & -7/2\\end{pmatrix}$\n$C_2 = (7-4) + (49/4 - 1/4) + (7-4) = 3 + 12 + 3 = 18$。\n特征多项式是 $-\\lambda^3 - 9\\lambda^2 - 18\\lambda = -\\lambda(\\lambda^2+9\\lambda+18) = 0$。\n对二次式进行因式分解得到 $-\\lambda(\\lambda+3)(\\lambda+6)=0$。\n$S$ 的特征值为 $\\{0, -3, -6\\}$。它们位于 Gershgorin 并集 $[-6, 2]$ 内。特征值 $-6$ 位于并集的边界上，表明界在这方面是紧的。\n\n定性条件数见解：矩阵 $D$ 是一阶导数算子的离散化。对于这个特定的低阶 $n=2$，它是幂零的。幂零矩阵在许多数值计算情境下是病态的，并且它们的谱半径（$\\rho(D)=0$）可能是其范数或放大行为的一个误导性指标。\n矩阵 $S$ 通过 $S = -\\tilde{D}^\\top\\tilde{D}$ 与 $D$ 相关，其中 $\\tilde{D} = W^{1/2}DW^{-1/2}$ 是 $D$ 的一个加权版本。$S$ 代表自伴算子 $-d^2/dx^2$。权重矩阵 $W$ 至关重要；它引入了正确的内积结构，从而得到一个具有实数、不同（非零部分）特征值的对称矩阵 $S$。虽然 $D$ 是非正常的且性态不良，但 $S$ 是对称的并且在其值域上是良态的。$S$ 值域上的条件数是 $|\\lambda_{max}|/|\\lambda_{min}| = |-6|/|-3|=2$，这是非常好的。因此，对角缩放将一个非正常、奇异的算子转换为一个对称、奇异的算子，其非平凡作用是良态的。\n\n最后，我们计算比值 $\\rho_G/\\rho$。\n$S$ 的谱半径是 $\\rho = \\max\\{|0|, |-3|, |-6|\\} = 6$。\n$S$ 的 Gershgorin 并集是区间 $U = [-6, 2]$。这个并集所蕴含的关于 $|\\lambda|$ 的最小统一界是 $\\rho_G = \\sup_{z \\in U} |z| = \\max\\{|-6|, |2|\\} = 6$。\n因此，该比值为：\n$$\n\\frac{\\rho_G}{\\rho} = \\frac{6}{6} = 1\n$$", "answer": "$$\n\\boxed{1}\n$$", "id": "3372555"}, {"introduction": "现在，我们从一维理论扩展到一个更实际的二维计算问题，其中几何各向异性等新挑战将会出现。你将使用一维构建模块，在拉伸网格上为拉普拉斯算子构建二维刚度矩阵。这个编码练习 [@problem_id:3372537] 连接了理论与实践，展示了病态问题在更高维度下如何表现。更重要的是，它将挑战你实现并比较不同的预处理策略，这是为实际应用开发高效、稳健的谱方法求解器的关键技能。", "problem": "考虑一个对称正定刚度矩阵，该矩阵由标量拉普拉斯算子在单个仿射矩形单元上进行张量积谱元离散化而产生，该单元具有各向异性拉伸。设参考正方形为 $[-1,1]^2$，坐标为 $(\\xi,\\eta)$，并通过 $(x,y)=(a\\,\\xi,b\\,\\eta)$（其中 $a,b>0$）将其映射到物理单元。定义纵横比 $r:=a/b\\ge 1$。物理单元上拉普拉斯算子的弱形式产生以下双线性形式：\n$$\n\\int_{\\Omega} \\nabla u \\cdot \\nabla v \\, \\mathrm{d}x\\mathrm{d}y\n=\n\\int_{[-1,1]^2}\n\\left(\\frac{b}{a} \\, \\partial_\\xi u \\, \\partial_\\xi v + \\frac{a}{b} \\, \\partial_\\eta u \\, \\partial_\\eta v \\right) \\, \\mathrm{d}\\xi \\mathrm{d}\\eta,\n$$\n因此，在具有齐次 Dirichlet 边界条件的 Legendre–Gauss–Lobatto (LGL) 张量积节点离散化中，刚度矩阵具有以下形式：\n$$\nK(r,p) \\;=\\; \\frac{1}{r}\\,\\bigl(K_x \\otimes M_y\\bigr) \\;+\\; r \\,\\bigl(M_x \\otimes K_y\\bigr),\n$$\n其中 $p$ 是每个坐标方向的多项式次数，$K_x = D^\\top W D \\in \\mathbb{R}^{(p+1)\\times(p+1)}$ 是在参考区间 $[-1,1]$ 上的一维刚度矩阵，由 LGL 一阶微分矩阵 $D$ 和对角求积权重矩阵 $W$ 构建，$M_x=W$ 是一维质量矩阵（$K_y,M_y$ 的定义类似）。齐次 Dirichlet 边界条件通过消除边界节点来施加，即将 $K_x,M_x$ 和 $K_y,M_y$ 限制在内部索引 $1,2,\\dots,p-1$ 上，因此 $K(r,p)\\in\\mathbb{R}^{(p-1)^2\\times(p-1)^2}$。将欧几里得（二-）范数下的谱条件数定义为：\n$$\n\\kappa_2(A) \\;:=\\; \\frac{\\lambda_{\\max}(A)}{\\lambda_{\\min}(A)},\n$$\n对于对称正定预处理器 $P$，将广义预处理条件数定义为：\n$$\n\\kappa_2\\bigl(P^{-1}K\\bigr) \\;:=\\; \\frac{\\lambda_{\\max}\\text{ of }(K,P)}{\\lambda_{\\min}\\text{ of }(K,P)},\n$$\n即 $K \\mathbf{v} = \\lambda P \\mathbf{v}$ 的最大广义特征值 $\\lambda$ 与最小广义特征值之比，其中 $P$ 是对称正定的。\n\n从上述弱形式和张量积构造出发，实现一个程序，该程序：\n\n1) 对于给定的 $p\\in\\mathbb{N}$，构建一维 LGL 节点、求积权重和一阶微分矩阵，形成一维质量和刚度矩阵，通过限制在内部节点来应用齐次 Dirichlet 边界条件，并根据上述克罗内克和结构为给定的 $r\\ge 1$ 构建二维矩阵 $K(r,p)$。\n\n2) 通过计算一组 $(p,r)$ 对的归一化量，数值验证缩放定律 $\\kappa_2\\bigl(K(r,p)\\bigr) \\sim r^2 p^4$：\n$$\n\\Theta(p,r) \\;:=\\; \\frac{\\kappa_2\\bigl(K(r,p)\\bigr)}{r^2\\, p^4}.\n$$\n\n3) 测试两种预处理器，以评估对 $r$ 依赖性的降低效果：\n   - 一种各向同性 Jacobi（对角）预处理器 $P_J := \\mathrm{diag}\\bigl(K(r,p)\\bigr)$。\n   - 一种感知各向异性的克罗内克和预处理器\n     $$\n     P_K \\;:=\\; \\frac{1}{r}\\,\\bigl(K_x \\otimes I_y\\bigr) \\;+\\; r\\,\\bigl(I_x \\otimes K_y\\bigr),\n     $$\n     其中 $I_x$ 和 $I_y$ 是与每个坐标方向的内部节点相对应的 $(p-1)\\times(p-1)$ 大小的单位矩阵。\n   对于每个 $r$，在固定的 $p$ 值下计算广义条件数 $\\kappa_2\\bigl(P_J^{-1}K(r,p)\\bigr)$ 和 $\\kappa_2\\bigl(P_K^{-1}K(r,p)\\bigr)$，并报告相对于各向同性情况 $r=1$ 的比率，即\n   $$\n   \\rho_J(r) \\;:=\\; \\frac{\\kappa_2\\bigl(P_J^{-1}K(r,p)\\bigr)}{\\kappa_2\\bigl(P_J^{-1}K(1,p)\\bigr)}, \\qquad\n   \\rho_K(r) \\;:=\\; \\frac{\\kappa_2\\bigl(P_K^{-1}K(r,p)\\bigr)}{\\kappa_2\\bigl(P_K^{-1}K(1,p)\\bigr)}.\n   $$\n\n使用以下测试套件：\n\n- 对 $(p,r)\\in\\{(8,1),(8,4),(8,16),(12,1),(12,4),(12,16)\\}$ 进行缩放定律测试，即 $p\\in\\{8,12\\}$ 和 $r\\in\\{1,4,16\\}$。\n- 在固定 $p=12$ 的情况下对 $r\\in\\{1,4,16\\}$ 进行预处理器测试，计算三个 $\\rho_J(r)$ 值和三个 $\\rho_K(r)$ 值。\n\n您的程序必须计算：\n\n- 上述六个 $(p,r)$ 对的六个归一化条件数 $\\Theta(p,r)$，作为浮点值。\n- 当 $p=12$ 时，对于 $r\\in\\{1,4,16\\}$ 的三个 $\\rho_J(r)$ 值，作为浮点值。\n- 当 $p=12$ 时，对于 $r\\in\\{1,4,16\\}$ 的三个 $\\rho_K(r)$ 值，作为浮点值。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[result\\_1,result\\_2,\\dots]$），结果按以下顺序排列：\n\n- 首先是六个 $\\Theta(p,r)$ 值，顺序为 $(8,1)$、$(8,4)$、$(8,16)$、$(12,1)$、$(12,4)$、$(12,16)$。\n- 然后是在 $p=12$ 时，对于 $r=1$、$r=4$、$r=16$ 的三个 $\\rho_J(r)$ 值。\n- 最后是在 $p=12$ 时，对于 $r=1$、$r=4$、$r=16$ 的三个 $\\rho_K(r)$ 值。\n\n所有可能出现的角度都必须以弧度表示。此问题中没有物理单位，因此不需要单位转换。所有数值输出必须是浮点数。", "solution": "用户提供的问题是有效的，因为它在数值分析领域，特别是偏微分方程的谱方法方面，具有科学依据。该问题是适定的、客观的，并包含一套完整且一致的定义和约束，以得出唯一的数值解。这些任务涉及计算科学中的标准（尽管不简单）程序，例如谱微分算子的构建和矩阵条件数的分析。\n\n解决方案是通过遵循问题陈述中概述的任务序列来实现的。该方法的核心涉及构建必要的一维和二维矩阵，然后进行特征值分析以确定它们的条件数。\n\n**1. 参考区间上的一维离散化**\n\n该方法的基础是参考区间 $[-1, 1]$ 上的一维 Legendre-Gauss-Lobatto (LGL) 节点基。对于给定的多项式次数 $p \\in \\mathbb{N}$，我们定义 $p+1$ 个 LGL 节点和相应的求积权重。\n\n设 $L_p(\\xi)$ 为 $p$ 次 Legendre 多项式。这 $p+1$ 个 LGL 节点（记为 $\\xi_j$, $j=0, 1, \\dots, p$）是多项式 $(1-\\xi^2)L'_p(\\xi)$ 的根。具体来说，$\\xi_0 = -1$，$\\xi_p = 1$，而内部节点 $\\{\\xi_j\\}_{j=1}^{p-1}$ 是 Legendre 多项式导数 $L'_p(\\xi)$ 的根。\n\n相关的 LGL 求积权重 $w_j$ 由以下公式给出：\n$$\nw_j = \\frac{2}{p(p+1) [L_p(\\xi_j)]^2}, \\quad j = 0, 1, \\dots, p.\n$$\n这些权重定义了一个对角质量矩阵 $M_{p+1} = W = \\mathrm{diag}(w_0, w_1, \\dots, w_p) \\in \\mathbb{R}^{(p+1)\\times(p+1)}$。\n\n一阶微分矩阵 $D \\in \\mathbb{R}^{(p+1)\\times(p+1)}$ 将 LGL 节点上的函数值映射到这些相同节点上的导数值，其元素为：\n$$\nD_{ij} = \\begin{cases}\n\\frac{L_p(\\xi_i)}{L_p(\\xi_j)(\\xi_i - \\xi_j)}  &\\text{if } i \\neq j \\\\\n-\\frac{p(p+1)}{4}  &\\text{if } i=j=0 \\\\\n\\frac{p(p+1)}{4}  &\\text{if } i=j=p \\\\\n0  &\\text{otherwise}\n\\end{cases}\n$$\n然后，使用弱形式构建算子 $-\\frac{d^2}{d\\xi^2}$ 的一维刚度矩阵，得到 $K_{p+1} = D^\\top W D$。\n\n齐次 Dirichlet 边界条件通过将基函数限制为在端点 $\\xi_0 = -1$ 和 $\\xi_p = 1$ 处为零的函数来施加。在此节点框架中，这等同于消除完整矩阵的第一行和最后一列以及第一列和最后一列。由此产生的内部矩阵 $K_x$ 和 $M_x$ 是 $K_{p+1}$ 和 $M_{p+1}$ 的 $(p-1) \\times (p-1)$ 子矩阵，对应于内部节点 $j=1, \\dots, p-1$。由于对称性，$\\eta$ 方向使用相同的矩阵 $K_y=K_x$ 和 $M_y=M_x$。\n\n**2. 二维刚度矩阵和预处理器**\n\n物理单元上各向异性拉普拉斯算子的二维刚度矩阵 $K(r,p)$ 使用克罗内克积 ($\\otimes$) 组装，这自然地源于张量积基函数。给定弱形式和纵横比 $r=a/b$，矩阵为：\n$$\nK(r,p) = \\frac{1}{r}(K_x \\otimes M_y) + r(M_x \\otimes K_y) \\in \\mathbb{R}^{(p-1)^2 \\times (p-1)^2}.\n$$\n该矩阵是对称正定 (SPD) 的。其条件数 $\\kappa_2(K(r,p))$ 计算为其最大特征值与最小特征值之比，即 $\\lambda_{\\max}/\\lambda_{\\min}$。这些特征值是数值计算的。然后计算归一化量 $\\Theta(p,r)$ 以验证缩放定律：\n$$\n\\Theta(p,r) = \\frac{\\kappa_2(K(r,p))}{r^2 p^4}.\n$$\n\n构建并测试了两种预处理器：\n- **Jacobi 预处理器** $P_J$ 是由刚度矩阵的对角线元素形成的对角矩阵：$P_J = \\mathrm{diag}(K(r,p))$。它易于构建和应用，但对于各向异性问题通常效果不佳。\n- **克罗内克和预处理器** $P_K$ 旨在更好地捕捉算子的各向异性结构，同时其结构适用于快速求逆求解器（尽管这里不需要直接求逆）。它定义为：\n$$\nP_K = \\frac{1}{r}(K_x \\otimes I_y) + r(I_x \\otimes K_y),\n$$\n其中 $I_x$ 和 $I_y$ 是大小为 $(p-1) \\times (p-1)$ 的单位矩阵。\n\n**3. 预处理系统分析**\n\n对于一个 SPD 预处理器 $P$，预处理系统 $P^{-1}K$ 的条件数由广义特征值问题 $K\\mathbf{v} = \\lambda P\\mathbf{v}$ 的最大广义特征值 $\\lambda$ 与最小广义特征值之比给出。$P_J$ 和 $P_K$ 都是 SPD，因此这是良定义的。\n\n通过计算固定多项式次数 $p=12$ 时的比率 $\\rho_J(r)$ 和 $\\rho_K(r)$ 来评估预处理器在处理各向异性方面的有效性。这些比率将给定纵横比 $r$ 下预处理系统的条件数通过其在各向同性情况（$r=1$）下的值进行归一化：\n$$\n\\rho_J(r) = \\frac{\\kappa_2(P_J^{-1}K(r,p))}{\\kappa_2(P_J^{-1}K(1,p))}, \\qquad \\rho_K(r) = \\frac{\\kappa_2(P_K^{-1}K(r,p))}{\\kappa_2(P_K^{-1}K(1,p))}.\n$$\n$\\rho(r)$ 的值接近 1 表明预处理器成功地减轻了由几何各向异性引入的病态条件。\n\n该实现为指定的 $(p,r)$ 对测试套件计算了这些量。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import legendre\nfrom scipy.linalg import eigh\n\ndef get_lgl_matrices(p: int):\n    \"\"\"\n    Computes 1D Legendre-Gauss-Lobatto mass and stiffness matrices for a given\n    polynomial degree p, with homogeneous Dirichlet boundary conditions imposed.\n\n    Args:\n        p: The polynomial degree.\n\n    Returns:\n        A tuple (Kx_int, Mx_int) containing the (p-1)x(p-1) interior \n        stiffness and mass matrices.\n    \"\"\"\n    if p  2:\n        raise ValueError(\"Polynomial degree p must be at least 2 for interior nodes.\")\n\n    # 1. Compute LGL nodes and weights for degree p\n    # The p+1 LGL nodes are the roots of (1-x^2) * L_p'(x), where L_p is the\n    # Legendre polynomial of degree p.\n    lp_poly = legendre(p)\n    lp_deriv_poly = lp_poly.deriv(1)\n    \n    # Interior nodes are the roots of L_p'(x)\n    interior_nodes = lp_deriv_poly.roots\n    # The full set of nodes includes the endpoints -1 and +1\n    nodes = np.concatenate(([-1.0], np.sort(interior_nodes), [1.0]))\n\n    # LGL quadrature weights\n    lp_vals_at_nodes = lp_poly(nodes)\n    weights = 2.0 / (p * (p + 1) * lp_vals_at_nodes**2)\n    \n    # 2. Compute the (p+1)x(p+1) differentiation matrix D\n    N = p\n    D = np.zeros((N + 1, N + 1))\n    # Off-diagonal entries\n    for i in range(N + 1):\n        for j in range(N + 1):\n            if i != j:\n                D[i, j] = lp_vals_at_nodes[i] / (lp_vals_at_nodes[j] * (nodes[i] - nodes[j]))\n    \n    # Diagonal entries\n    D[0, 0] = -N * (N + 1) / 4.0\n    D[N, N] = N * (N + 1) / 4.0\n    # Diagonal entries for interior nodes are 0 and are already set.\n\n    # 3. Form full (p+1)x(p+1) 1D mass and stiffness matrices\n    W = np.diag(weights)\n    M_full = W\n    K_full = D.T @ W @ D\n    \n    # 4. Apply homogeneous Dirichlet BCs by restricting to interior nodes.\n    # The interior nodes are indexed from 1 to p-1.\n    interior_slice = slice(1, p)\n    Mx_int = M_full[interior_slice, interior_slice]\n    Kx_int = K_full[interior_slice, interior_slice]\n    \n    return Kx_int, Mx_int\n\ndef solve():\n    # Define the test cases from the problem statement.\n    scaling_law_tests = [(8, 1), (8, 4), (8, 16), (12, 1), (12, 4), (12, 16)]\n    preconditioner_p = 12\n    preconditioner_r_values = [1, 4, 16]\n\n    results = []\n\n    # --- Part 1: Scaling-law tests ---\n    theta_results = []\n    for p, r in scaling_law_tests:\n        Kx, Mx = get_lgl_matrices(p)\n        Ky, My = Kx, Mx # Same discretization in each direction\n        \n        # Build the 2D stiffness matrix K(r, p)\n        K_rp = (1.0 / r) * np.kron(Kx, My) + r * np.kron(Mx, Ky)\n        \n        # Compute the spectral condition number kappa_2(K).\n        # K_rp is symmetric, so we use eigvalsh for stability and efficiency.\n        eigenvalues = np.linalg.eigvalsh(K_rp)\n        kappa_2_K = eigenvalues[-1] / eigenvalues[0]\n        \n        # Compute the normalized quantity Theta(p, r)\n        theta = kappa_2_K / (r**2 * p**4)\n        theta_results.append(theta)\n    \n    results.extend(theta_results)\n\n    # --- Part 2: Preconditioner tests ---\n    p = preconditioner_p\n    r_values = preconditioner_r_values\n\n    # Get 1D interior matrices for p=12\n    Kx, Mx = get_lgl_matrices(p)\n    Ky, My = Kx, Mx\n    \n    # Precompute identity matrices of size (p-1)x(p-1)\n    dim_int = p - 1\n    Ix = np.eye(dim_int)\n    Iy = np.eye(dim_int)\n\n    # Calculate baseline condition numbers for the isotropic case r=1\n    r_base = 1.0\n    K_base = (1.0 / r_base) * np.kron(Kx, My) + r_base * np.kron(Mx, Ky)\n    \n    P_J_base = np.diag(np.diag(K_base))\n    gen_eigvals_J_base = eigh(K_base, P_J_base, eigvals_only=True)\n    kappa_J_base = gen_eigvals_J_base[-1] / gen_eigvals_J_base[0]\n    \n    P_K_base = (1.0 / r_base) * np.kron(Kx, Iy) + r_base * np.kron(Ix, Ky)\n    gen_eigvals_K_base = eigh(K_base, P_K_base, eigvals_only=True)\n    kappa_K_base = gen_eigvals_K_base[-1] / gen_eigvals_K_base[0]\n\n    rho_J_results = []\n    rho_K_results = []\n    \n    for r in r_values:\n        K_rp = (1.0 / r) * np.kron(Kx, My) + r * np.kron(Mx, Ky)\n        \n        # Jacobi Preconditioner\n        P_J_rp = np.diag(np.diag(K_rp))\n        gen_eigvals_J_rp = eigh(K_rp, P_J_rp, eigvals_only=True)\n        kappa_J_rp = gen_eigvals_J_rp[-1] / gen_eigvals_J_rp[0]\n        rho_J = kappa_J_rp / kappa_J_base\n        rho_J_results.append(rho_J)\n        \n        # Kronecker-sum Preconditioner\n        P_K_rp = (1.0 / r) * np.kron(Kx, Iy) + r * np.kron(Ix, Ky)\n        # For r=1, P_K_rp == P_K_base, and K_rp == K_base, so rho_K will be 1 as expected.\n        gen_eigvals_K_rp = eigh(K_rp, P_K_rp, eigvals_only=True)\n        kappa_K_rp = gen_eigvals_K_rp[-1] / gen_eigvals_K_rp[0]\n        rho_K = kappa_K_rp / kappa_K_base\n        rho_K_results.append(rho_K)\n        \n    results.extend(rho_J_results)\n    results.extend(rho_K_results)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3372537"}]}