{"hands_on_practices": [{"introduction": "这个练习旨在巩固卷积定理的核心思想。我们将看到，如何将时域中一个相对复杂的操作（卷积）转换到频域中一个简单的操作（乘法），从而极大地简化傅里叶分析。通过一个经典示例——求解三角脉冲的傅里叶变换——我们将亲身体验这一定理的威力与便捷性 ([@problem_id:27693])。", "problem": "一个三角脉冲函数 $f_a(t)$ 可由一个更简单的函数的自卷积生成。考虑一个矩形脉冲函数 $p_a(t)$，定义为：\n$$\np_a(t) = \n\\begin{cases} \n1  \\text{当 } |t| \\le \\frac{a}{2} \\\\\n0  \\text{当 } |t|  \\frac{a}{2} \n\\end{cases}\n$$\n其中 $a$ 是表示脉冲宽度的正常数。\n\n三角脉冲 $f_a(t)$ 由此矩形脉冲与自身的卷积给出：\n$$\nf_a(t) = (p_a * p_a)(t) = \\int_{-\\infty}^{\\infty} p_a(\\tau) p_a(t - \\tau) d\\tau\n$$\n所得的三角脉冲以 $t=0$ 为中心，基底宽度为 $2a$，峰值为 $a$。\n\n你的任务是推导这个三角脉冲的傅里叶变换 $\\hat{f}_a(k)$。你必须使用卷积定理。\n\n**定义与定理：**\n\n1.  **傅里叶变换：** 函数 $g(t)$ 的傅里叶变换记为 $\\hat{g}(k)$ 或 $\\mathcal{F}\\{g(t)\\}$，定义为：\n    $$\n    \\hat{g}(k) = \\int_{-\\infty}^{\\infty} g(t) e^{-ikt} dt\n    $$\n2.  **卷积定理：** 两个函数 $g(t)$ 和 $h(t)$ 的卷积的傅里叶变换，等于它们各自傅里叶变换的乘积：\n    $$\n    \\mathcal{F}\\{ (g * h)(t) \\} = \\hat{g}(k) \\hat{h}(k)\n    $$\n\n使用这些定义，推导出 $\\hat{f}_a(k)$ 的表达式。", "solution": "根据卷积定理，\n$$\\mathcal{F}\\{f_a(t)\\}=\\mathcal{F}\\{p_a * p_a\\}\n=\\bigl(\\mathcal{F}\\{p_a(t)\\}\\bigr)^2.$$\n首先计算\n$$\\hat{p}_a(k)=\\int_{-\\infty}^{\\infty}p_a(t)\\,e^{-ikt}dt\n=\\int_{-a/2}^{a/2}e^{-ikt}dt\n=\\left[\\frac{e^{-ikt}}{-ik}\\right]_{-a/2}^{a/2}\n=\\frac{e^{-ik(a/2)}-e^{ik(a/2)}}{-ik}\n=\\frac{2\\sin\\!\\bigl(\\tfrac{ka}{2}\\bigr)}{k}。$$\n因此\n$$\\hat{f}_a(k)=\\bigl(\\hat{p}_a(k)\\bigr)^2\n=\\left(\\frac{2\\sin\\!\\bigl(\\tfrac{ka}{2}\\bigr)}{k}\\right)^2\n=\\frac{4\\sin^2\\!\\bigl(\\tfrac{ka}{2}\\bigr)}{k^2}\\,. $$", "answer": "$$\\boxed{\\frac{4\\sin^2\\!\\bigl(\\frac{ka}{2}\\bigr)}{k^2}}$$", "id": "27693"}, {"introduction": "现在，我们将卷积定理应用于计算科学中的一个实际问题。这个练习展示了如何为间断伽辽金（DG）方法设计一个数值滤波器，并确保其具有诸如相容性和稳定性（单调性）等理想性质。我们将运用对卷积核的傅里叶分析来推导这些条件，从而将抽象的理论与稳健的数值格式设计联系起来 ([@problem_id:3374076])。", "problem": "考虑标量线性守恒律 $u_{t} + c\\,u_{x} = 0$，其在周期性域上具有恒定的平流速度 $c \\in \\mathbb{R}$。在间断Galerkin (DG)方法中，假设界面数值通量通过与一个紧支集核函数 $K(x) \\in L^{1}(\\mathbb{R})$ 进行卷积来后处理，使得滤波后的通量为 $\\mathcal{F}(x) = (K * f)(x)$，其中 $f(u) = c\\,u$，$*$ 表示卷积。设傅里叶变换定义为 $\\widehat{g}(\\xi) = \\int_{\\mathbb{R}} g(x)\\,\\exp(-i\\,\\xi\\,x)\\,dx$。\n\n从基本定义（傅里叶变换、卷积、DG通量相容性和关于全变差的单调性）出发，推导一个作用于乘子 $\\widehat{K}(\\xi)$ 的傅里叶域条件，以确保：\n- 通量相容性（常数被滤波后的通量保持），以及\n- 单调性（滤波后的通量不会增加DG解在界面上迹的全变差）。\n\n然后，考虑一个特定的紧支集、偶、单位质量的核函数\n$$\nK(x) = \\frac{1}{a}\\left(1 - \\frac{|x|}{a}\\right)_{+}, \\quad a > 0,\n$$\n其中 $(\\cdot)_{+}$ 表示正部。计算其傅里叶变换 $\\widehat{K}(\\xi)$ 的显式闭式形式。\n\n你的最终答案必须是上述 $K(x)$ 的 $\\widehat{K}(\\xi)$ 的解析表达式。", "solution": "用户提供了一个需要解决的问题。根据说明，第一步是验证问题陈述的有效性。\n\n### 第1步：提取已知条件\n-   **控制方程**：标量线性守恒律 $u_{t} + c\\,u_{x} = 0$，具有恒定平流速度 $c \\in \\mathbb{R}$。\n-   **域**：周期性。\n-   **数值方法背景**：间断Galerkin (DG) 方法。\n-   **通量处理**：界面数值通量通过与核函数 $K(x)$ 进行卷积后处理。\n-   **通量函数**：$f(u) = c\\,u$。\n-   **核函数性质**：$K(x) \\in L^{1}(\\mathbb{R})$ 且为紧支集。\n-   **滤波后的通量**：$\\mathcal{F}(x) = (K * f)(x)$，其中 $*$ 表示卷积。\n-   **傅里叶变换定义**：$\\widehat{g}(\\xi) = \\int_{\\mathbb{R}} g(x)\\,\\exp(-i\\,\\xi\\,x)\\,dx$。\n-   **任务1**：推导 $\\widehat{K}(\\xi)$ 需满足的傅里叶域条件以实现：\n    1.  **通量相容性**：常数被滤波后的通量保持。\n    2.  **单调性**：滤波后的通量不增加DG解在界面上迹的全变差。\n-   **任务2**：对于特定的核函数 $K(x) = \\frac{1}{a}\\left(1 - \\frac{|x|}{a}\\right)_{+}$，其中 $a > 0$，计算其傅里叶变换 $\\widehat{K}(\\xi)$。\n\n### 第2步：使用提取的已知条件进行验证\n根据验证标准对问题进行评估。\n-   **科学基础**：该问题在偏微分方程数值方法理论中有坚实的基础，特别是在间断Galerkin方法、稳定性分析和傅里叶分析方面。所有概念（守恒律、卷积、傅里叶变换、全变差）在应用数学和工程学中都是标准概念。\n-   **适定性**：该问题是适定的。它要求基于清晰的定义推导条件，并计算一个特定的傅里叶变换。两部分都有唯一的、可确定的答案。\n-   **客观性**：问题以精确、客观的数学语言陈述，没有歧义或主观内容。\n\n该问题未表现出任何无效标志：\n1.  **科学或事实不健全**：前提在数学上和科学上都是健全的。\n2.  **不可形式化或不相关**：问题与指定主题直接相关，并且是完全可形式化的。\n3.  **设置不完整或矛盾**：问题提供了进行所需的所有必要定义和函数。\n4.  **不切实际或不可行**：该设置是数值分析中的标准理论模型。\n5.  **不适定或结构不良**：问题是具体的，并导向唯一的解。\n6.  **伪深刻、琐碎或同义反复**：问题需要实质性的推理和计算。\n7.  **超出科学可验证范围**：所有推导和计算在数学上都是可验证的。\n\n### 第3步：结论与行动\n该问题是**有效的**。将提供一个完整的、有理有据的解答。\n\n---\n\n### 解答\n\n问题包括两部分。首先，我们推导通量相容性和单调性的傅里叶域条件。其次，我们计算特定核函数的傅里叶变换。\n\n#### 第1部分：$\\widehat{K}(\\xi)$ 条件的推导\n\n**1. 通量相容性**\n\n通量相容性要求滤波过程保持常数状态。设解为常数 $u(x) = u_0$。物理通量为 $f(u_0) = c\\,u_0$，它也是一个关于 $x$ 的常数函数。滤波后的通量 $\\mathcal{F}(x)$ 是核函数 $K$ 与常数函数 $f(x) = c\\,u_0$ 的卷积：\n$$\n\\mathcal{F}(x) = (K * f)(x) = \\int_{-\\infty}^{\\infty} K(y) f(x-y) dy = \\int_{-\\infty}^{\\infty} K(y) (c\\,u_0) dy\n$$\n由于 $c$ 和 $u_0$ 是常数，它们可以从积分中提出：\n$$\n\\mathcal{F}(x) = c\\,u_0 \\int_{-\\infty}^{\\infty} K(y) dy\n$$\n为了相容性，滤波后的通量必须等于原始通量，即 $\\mathcal{F}(x) = f(u_0) = c\\,u_0$。\n$$\nc\\,u_0 \\int_{-\\infty}^{\\infty} K(y) dy = c\\,u_0\n$$\n假设 $c \\neq 0$ 且 $u_0 \\neq 0$，这意味着核函数必须具有单位质量：\n$$\n\\int_{-\\infty}^{\\infty} K(y) dy = 1\n$$\n这是在空间域中的条件。为了找到傅里叶域中的等价条件，我们计算 $K(x)$ 在频率 $\\xi = 0$ 处的傅里叶变换：\n$$\n\\widehat{K}(0) = \\int_{-\\infty}^{\\infty} K(x)\\,\\exp(-i \\cdot 0 \\cdot x)\\,dx = \\int_{-\\infty}^{\\infty} K(x)\\,dx\n$$\n因此，通量相容性的傅里叶域条件是：\n$$\n\\widehat{K}(0) = 1\n$$\n\n**2. 单调性（全变差不增）**\n\n问题将单调性定义为滤波后的通量不增加解的迹的全变差（TV）的性质。设 $v(x)$ 表示DG解的迹。与该迹相关的通量为 $f(v(x)) = c\\,v(x)$。滤波操作应用于此通量函数。条件是 $TV(\\mathcal{F}) \\leq TV(f)$，其中 $\\mathcal{F} = K * f$。\n\n可微函数 $g(x)$ 的全变差定义为 $TV(g) = \\int_{-\\infty}^{\\infty} |g'(x)| dx = ||g'||_{L^1}$。\n对于我们的线性通量 $f(v) = c\\,v$，我们有 $TV(f) = TV(c\\,v) = |c|\\,TV(v)$。滤波后的通量是 $\\mathcal{F} = K * (c\\,v) = c\\,(K*v)$。其全变差为 $TV(\\mathcal{F}) = |c|\\,TV(K*v)$。条件变为 $|c|\\,TV(K*v) \\leq |c|\\,TV(v)$，对于任何迹函数 $v(x)$，这可以简化为 $TV(K*v) \\leq TV(v)$。\n\n使用卷积的导数性质，$(K*v)' = K*v'$。因此，\n$$\nTV(K*v) = ||(K*v)'||_{L^1} = ||K*v'||_{L^1}\n$$\n根据卷积的杨氏不等式，对于函数 $g \\in L^1(\\mathbb{R})$ 和 $h \\in L^1(\\mathbb{R})$，我们有 $||g*h||_{L^1} \\leq ||g||_{L^1} ||h||_{L^1}$。将此应用于 $g=K$ 和 $h=v'$，我们得到：\n$$\n||K*v'||_{L^1} \\leq ||K||_{L^1} ||v'||_{L^1}\n$$\n代回到全变差的表达式中：\n$$\nTV(K*v) \\leq ||K||_{L^1} TV(v)\n$$\n为了使单调性条件 $TV(K*v) \\leq TV(v)$ 对任何 $v$ 都成立，核函数 $K$ 的一个充分条件是：\n$$\n||K||_{L^1} = \\int_{-\\infty}^{\\infty} |K(x)| dx \\leq 1\n$$\n对此类滤波器，一个常见且具有物理意义的选择是要求核函数非负，$K(x) \\geq 0$。如果 $K(x) \\geq 0$，则 $|K(x)| = K(x)$，且 $L^1$-范数就是该函数的积分：$||K||_{L^1} = \\int K(x) dx$。\n在这种情况下，相容性条件 $\\int K(x) dx = 1$ 自动满足单调性条件 $||K||_{L^1} = 1 \\leq 1$。\n\n问题要求一个傅里叶域条件。如果 $K(x) \\geq 0$ 且为实值，我们可以建立其傅里叶变换的一个界：\n$$\n|\\widehat{K}(\\xi)| = \\left| \\int_{-\\infty}^{\\infty} K(x)\\,e^{-i\\,\\xi\\,x}\\,dx \\right| \\leq \\int_{-\\infty}^{\\infty} |K(x)\\,e^{-i\\,\\xi\\,x}|\\,dx = \\int_{-\\infty}^{\\infty} K(x) |e^{-i\\,\\xi\\,x}|\\,dx\n$$\n由于 $|e^{-i\\,\\xi\\,x}| = 1$，我们有：\n$$\n|\\widehat{K}(\\xi)| \\leq \\int_{-\\infty}^{\\infty} K(x)\\,dx\n$$\n使用相容性条件 $\\int K(x) dx = \\widehat{K}(0) = 1$，我们得到对单调性（在 $K(x) \\geq 0$ 的前提下）充分的傅里叶域条件：\n$$\n|\\widehat{K}(\\xi)| \\leq 1 \\quad \\text{for all } \\xi \\in \\mathbb{R}\n$$\n这个条件意味着滤波器不放大任何傅里叶模式，这是一个经典的稳定性条件。\n\n总而言之，推导出的傅里叶域条件是：\n-   **相容性**：$\\widehat{K}(0) = 1$。\n-   **单调性 (TVD)**：对于所有 $\\xi \\in \\mathbb{R}$，有 $|\\widehat{K}(\\xi)| \\leq 1$。\n\n#### 第2部分：$\\widehat{K}(\\xi)$ 的计算\n\n我们给定的核函数是：\n$$\nK(x) = \\frac{1}{a}\\left(1 - \\frac{|x|}{a}\\right)_{+} = \\begin{cases} \\frac{1}{a}\\left(1 - \\frac{|x|}{a}\\right)  \\text{if } |x| \\leq a \\\\ 0  \\text{if } |x|  a \\end{cases}\n$$\n其中 $a > 0$。这是一个三角核函数。我们计算它的傅里叶变换 $\\widehat{K}(\\xi)$：\n$$\n\\widehat{K}(\\xi) = \\int_{-\\infty}^{\\infty} K(x)\\,\\exp(-i\\,\\xi\\,x)\\,dx = \\int_{-a}^{a} \\frac{1}{a}\\left(1 - \\frac{|x|}{a}\\right) \\exp(-i\\,\\xi\\,x)\\,dx\n$$\n函数 $K(x)$ 是实偶函数。因此，它的傅里叶变换也是实偶函数。我们可以使用 $\\exp(-i\\,\\xi\\,x) = \\cos(\\xi\\,x) - i\\,\\sin(\\xi\\,x)$ 来简化积分。偶函数 $K(x)$ 和奇函数 $\\sin(\\xi\\,x)$ 的乘积在对称区间 $[-a, a]$ 上的积分为零。\n$$\n\\widehat{K}(\\xi) = \\int_{-a}^{a} \\frac{1}{a}\\left(1 - \\frac{|x|}{a}\\right) \\cos(\\xi\\,x)\\,dx = \\frac{2}{a} \\int_{0}^{a} \\left(1 - \\frac{x}{a}\\right) \\cos(\\xi\\,x)\\,dx\n$$\n我们使用分部积分法进行此积分。令 $u = 1 - \\frac{x}{a}$ 且 $dv = \\cos(\\xi\\,x)\\,dx$。则 $du = -\\frac{1}{a} dx$ 且 $v = \\frac{1}{\\xi} \\sin(\\xi\\,x)$。\n$$\n\\int \\left(1 - \\frac{x}{a}\\right) \\cos(\\xi\\,x)\\,dx = \\left(1 - \\frac{x}{a}\\right)\\frac{\\sin(\\xi\\,x)}{\\xi} - \\int \\frac{\\sin(\\xi\\,x)}{\\xi} \\left(-\\frac{1}{a}\\right) dx\n$$\n$$\n= \\left(1 - \\frac{x}{a}\\right)\\frac{\\sin(\\xi\\,x)}{\\xi} + \\frac{1}{a\\xi} \\int \\sin(\\xi\\,x)\\,dx = \\left(1 - \\frac{x}{a}\\right)\\frac{\\sin(\\xi\\,x)}{\\xi} - \\frac{\\cos(\\xi\\,x)}{a\\xi^2}\n$$\n现在，我们计算从 $0$ 到 $a$ 的定积分：\n$$\n\\int_{0}^{a} \\left(1 - \\frac{x}{a}\\right) \\cos(\\xi\\,x)\\,dx = \\left[ \\left(1 - \\frac{x}{a}\\right)\\frac{\\sin(\\xi\\,x)}{\\xi} - \\frac{\\cos(\\xi\\,x)}{a\\xi^2} \\right]_{0}^{a}\n$$\n$$\n= \\left( \\left(1 - \\frac{a}{a}\\right)\\frac{\\sin(\\xi\\,a)}{\\xi} - \\frac{\\cos(\\xi\\,a)}{a\\xi^2} \\right) - \\left( \\left(1 - 0\\right)\\frac{\\sin(0)}{\\xi} - \\frac{\\cos(0)}{a\\xi^2} \\right)\n$$\n$$\n= \\left( 0 - \\frac{\\cos(\\xi\\,a)}{a\\xi^2} \\right) - \\left( 0 - \\frac{1}{a\\xi^2} \\right) = \\frac{1 - \\cos(\\xi\\,a)}{a\\xi^2}\n$$\n此结果在 $\\xi \\neq 0$ 时成立。将其代回 $\\widehat{K}(\\xi)$ 的表达式中：\n$$\n\\widehat{K}(\\xi) = \\frac{2}{a} \\left( \\frac{1 - \\cos(\\xi\\,a)}{a\\xi^2} \\right) = \\frac{2(1 - \\cos(\\xi\\,a))}{a^2\\xi^2}\n$$\n使用半角三角恒等式 $1 - \\cos(2\\theta) = 2\\sin^2(\\theta)$，并令 $\\theta = \\frac{a\\xi}{2}$，我们有 $1 - \\cos(a\\xi) = 2\\sin^2\\left(\\frac{a\\xi}{2}\\right)$。\n$$\n\\widehat{K}(\\xi) = \\frac{2 \\cdot 2\\sin^2\\left(\\frac{a\\xi}{2}\\right)}{a^2\\xi^2} = \\frac{4\\sin^2\\left(\\frac{a\\xi}{2}\\right)}{a^2\\xi^2}\n$$\n这可以写成一个更紧凑、更易于识别的形式：\n$$\n\\widehat{K}(\\xi) = \\left( \\frac{2\\sin\\left(\\frac{a\\xi}{2}\\right)}{a\\xi} \\right)^2 = \\left( \\frac{\\sin\\left(\\frac{a\\xi}{2}\\right)}{\\frac{a\\xi}{2}} \\right)^2\n$$\n这个表达式是 sinc 函数的平方，即 $\\text{sinc}^2\\left(\\frac{a\\xi}{2}\\right)$。当 $\\xi \\to 0$ 时，使用极限 $\\lim_{z \\to 0} \\frac{\\sin(z)}{z} = 1$，我们得到 $\\widehat{K}(0) = 1$，这证实了相容性条件。此外，由于对所有实数 $z$，都有 $|\\sin(z)/z| \\leq 1$，因此我们有 $|\\widehat{K}(\\xi)| \\leq 1$，满足单调性条件。\n最终 $\\widehat{K}(\\xi)$ 的闭式表达式如下所示。", "answer": "$$\n\\boxed{\\left(\\frac{\\sin\\left(\\frac{a\\xi}{2}\\right)}{\\frac{a\\xi}{2}}\\right)^{2}}\n$$", "id": "3374076"}, {"introduction": "从连续理论到离散计算的转变引入了新的挑战，其中最突出的就是混叠效应。最后的这个练习将探讨卷积定理如何帮助我们理解并解决伪谱方法中的混叠问题。我们将推导出精确计算一个三次非线性项所需的“零填充”量，并由此揭示为何标准的经验法则对于高阶相互作用可能会失效 ([@problem_id:3423295])。", "problem": "考虑一个周期性域，以及在谱方法和间断Galerkin (DG) 方法背景下，对三次非线性项的伪谱法计算。设 $u(x)$、$v(x)$ 和 $w(x)$ 是三个场，其复傅里叶级数仅在满足 $|k|\\le K$ 的整数波数 $k$ 上有支撑，其中 $K$ 为某个固定的正整数。您希望以一种在保留的波数带 $|k|\\le K$ 上没有混叠的方式来计算乘积 $q(x)=u(x)\\,v(x)\\,w(x)$。\n\n采用以下步骤：使用离散傅里叶变换 (DFT) 将每个场变换到由 $M$ 个等距点组成的均匀网格上的物理空间，逐点相乘以获得该网格上的 $q(x)$，然后使用快速傅里叶变换 (FFT) 变换回来，并进行截断，只保留波数满足 $|k|\\le K$ 的模态。假设 $M$ 是一个偶数，并且 DFT 的波数索引是通常的主集 $k\\in\\{-M/2,\\dots,M/2-1\\}$。\n\n仅从傅里叶级数的卷积定理以及傅里叶空间中的离散卷积由DFT计算模 $M$ 这一事实出发，推导出形成三次乘积时，能保证混叠误差不污染保留模态 $|k|\\le K$ 的最小填充大小 $M$（作为 $K$ 的函数）。然后，将相应的填充因子 $p:=\\dfrac{M}{2K}$ 表示为一个精确的数值。最后，根据您的推导，解释为什么对于二次非线性项来说已经足够的三分之二法则（即填充因子 $p=\\dfrac{3}{2}$），对于三次相互作用却不适用。\n\n您的最终答案必须是 $p$ 的单个值（无单位）。无需进行数值四舍五入。", "solution": "设场 $u(x)$、$v(x)$ 和 $w(x)$ 由其复傅里叶级数表示。鉴于它们的谱仅在满足 $|k| \\le K$ 的整数波数 $k$ 上有支撑，其级数表示为：\n$$u(x) = \\sum_{k=-K}^{K} \\hat{u}_k e^{ikx}$$\n$$v(x) = \\sum_{l=-K}^{K} \\hat{v}_l e^{ilx}$$\n$$w(x) = \\sum_{m=-K}^{K} \\hat{w}_m e^{imx}$$\n其中 $\\hat{u}_k$、$\\hat{v}_l$ 和 $\\hat{w}_m$ 是复傅里叶系数。\n\n精确的乘积是 $q(x) = u(x)v(x)w(x)$。为了确定 $q(x)$ 的谱含量，我们应用卷积定理。首先，我们求中间乘积 $p(x) = u(x)v(x)$ 的谱。$p(x)$ 的傅里叶系数（记为 $\\hat{p}_j$）由 $u(x)$ 和 $v(x)$ 系数的卷积给出：\n$$\\hat{p}_j = (\\hat{u} * \\hat{v})_j = \\sum_{k=-\\infty}^{\\infty} \\hat{u}_k \\hat{v}_{j-k}$$\n由于 $\\hat{u}_k$ 仅在 $|k| \\le K$ 时非零，而 $\\hat{v}_{j-k}$ 仅在 $|j-k| \\le K$ 时非零，因此系数 $\\hat{p}_j$ 只有在存在一个同时满足这两个条件的 $k$ 时才可能非零。对波数应用三角不等式可得 $|j| = |k + (j-k)| \\le |k| + |j-k| \\le K + K = 2K$。因此，场 $p(x)$ 的谱支撑在波数 $|j| \\le 2K$ 上。\n\n接下来，我们求最终乘积 $q(x) = p(x)w(x)$ 的谱。其傅里叶系数 $\\hat{q}_n$ 是 $p(x)$ 和 $w(x)$ 系数的卷积：\n$$\\hat{q}_n = (\\hat{p} * \\hat{w})_n = \\sum_{j=-\\infty}^{\\infty} \\hat{p}_j \\hat{w}_{n-j}$$\n这里，$\\hat{p}_j$ 仅在 $|j| \\le 2K$ 时非零，而 $\\hat{w}_{n-j}$ 仅在 $|n-j| \\le K$ 时非零。再次应用三角不等式，我们找到 $\\hat{q}_n$ 的支撑范围：\n$$|n| = |j + (n-j)| \\le |j| + |n-j| \\le 2K + K = 3K$$\n因此，精确的三次乘积 $q(x)$ 是一个带限函数，其傅里叶谱支撑在波数 $|n| \\le 3K$ 上。\n\n伪谱法在 $M$ 个点的离散网格上计算该乘积。逐点乘积 $q_j = u_j v_j w_j$ 的离散傅里叶变换 (DFT) 产生数值系数 $\\tilde{q}_n$。由于有限采样，这些数值系数通过混叠公式与精确的傅里叶系数 $\\hat{q}_n$ 相关联：\n$$\\tilde{q}_n = \\sum_{s=-\\infty}^{\\infty} \\hat{q}_{n+sM}$$\n我们的目标是确保计算出的系数对于保留的模态（即满足 $|n| \\le K$ 的模态）没有混叠误差。这意味着我们要求对于所有 $|n| \\le K$，都有 $\\tilde{q}_n = \\hat{q}_n$。为使此条件成立，混叠项之和必须为零：\n$$\\sum_{s \\in \\mathbb{Z}, s \\neq 0} \\hat{q}_{n+sM} = 0 \\quad \\text{for all } n \\text{ s.t. } |n| \\le K$$\n因为我们知道 $\\hat{q}_{k'}$ 仅在 $|k'| \\le 3K$ 时非零，所以在保留模态上无混叠的条件是：对于范围 $|n| \\le K$ 内的任何整数 $n$ 和任何非零整数 $s$，混叠波数 $n+sM$ 必须落在精确乘积的谱支撑之外。即：\n$$|n+sM| > 3K \\quad \\text{for all } n \\in [-K, K] \\text{ and } s \\in \\mathbb{Z} \\setminus \\{0\\}$$\n我们只需检查最严格的情况，即对应于 $s = 1$ 和 $s = -1$ 的情况。对于 $|s| \\ge 2$，如果该不等式对于 $|s|=1$ 成立，那么在合理的网格尺寸 $MK$ 的假设下，它也将成立。\n\n情况 1: $s=1$。我们必须有 $|n+M| > 3K$。由于 $M$ 必须足够大以表示初始场（即 $M \\ge 2K+1$），所以 $M$ 是正数且大于 $K$。因此对于所有 $|n|\\le K$，$n+M$ 都是正数。条件变为 $n+M > 3K$。这必须对所有 $n \\in [-K, K]$ 成立。最坏的情况（即左侧的最小值）发生在 $n=-K$ 时：\n$$-K + M > 3K \\implies M > 4K$$\n\n情况 2: $s=-1$。我们必须有 $|n-M| > 3K$。由于 $M > K$，对于所有 $|n|\\le K$，$n-M$ 都是负数。条件变为 $-(n-M) > 3K$，即 $M-n > 3K$。这必须对所有 $n \\in [-K, K]$ 成立。最坏的情况（即左侧的最小值）发生在 $n=K$ 时：\n$$M - K > 3K \\implies M > 4K$$\n两种情况都得出相同的严格不等式：$M > 4K$。这是保证三次乘积在所有保留模态 $|k|\\le K$ 上都去混叠的对网格尺寸 $M$ 的最小条件。\n\n问题将填充因子定义为 $p := \\dfrac{M}{2K}$。代入推导出的 $M$ 的条件：\n$$p \\cdot (2K) > 4K$$\n由于 $K$ 是一个正整数，$2K > 0$，我们可以用它来除不等式两边而不改变不等号的方向：\n$$p > 2$$\n问题要求将“该”填充因子表示为一个精确的数值。这对应于所需条件的边界。任何大于 $2$ 的填充因子都将成功地对三次非线性项进行去混叠。因此，该法则是基于此边界值。所需的最小填充因子从上方趋近于该值，因此该法则用数字 $2$ 表示。\n\n最后，我们解释为什么三分之二法则，$p=\\dfrac{3}{2}$，是不充分的。填充因子 $p=\\dfrac{3}{2}$ 意味着网格尺寸为 $M = p \\cdot (2K) = \\dfrac{3}{2} \\cdot (2K) = 3K$。对于任何正整数 $K$，这个 $M$ 的选择都违反了我们推导出的必要条件 $M > 4K$。\n为明确地看到其失败之处，考虑 $M=3K$。对于模态 $n=K$，混叠公式为 $\\tilde{q}_K = \\sum_s \\hat{q}_{K+s(3K)}$。当 $s=-1$ 时，其中一个混叠项是 $\\hat{q}_{K-3K} = \\hat{q}_{-2K}$。波数 $-2K$ 位于精确乘积 $q(x)$ 的谱支撑范围内（因为对于 $K\\ge 0$，有 $|-2K| \\le 3K$）。通常情况下，$\\hat{q}_{-2K}$ 是非零的。因此，$\\tilde{q}_K$ 的计算被 $\\hat{q}_{-2K}$ 污染，结果产生混叠：$\\tilde{q}_K = \\hat{q}_K + \\hat{q}_{-2K} + \\dots \\neq \\hat{q}_K$。因此，对于二次非线性项（要求 $M>3K$）足够的三分之二法则，对于产生更高波数从而需要更大网格进行去混叠的三次非线性项来说，是不充分的。", "answer": "$$\n\\boxed{2}\n$$", "id": "3423295"}]}