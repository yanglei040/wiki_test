{"hands_on_practices": [{"introduction": "我们从第一性原理出发，亲手构建勒让德多项式 (Legendre polynomials) 的三项递推关系，以此开启我们的实践之旅。这个练习不仅是一次计算，它旨在揭示多项式的正交性与其优美的递推代数结构之间的深刻联系。通过完成这个推导 [@problem_id:3423659]，你将对这一基本工具的来源有更坚实的理解，这对于在谱方法中自如地应用它至关重要。", "problem": "考虑在区间 $[-1,1]$ 上权重函数为 $w(x)=1$ 的勒让德多项式族 $\\{P_n(x)\\}_{n=0}^{\\infty}$。仅使用正交多项式的基本定义和性质来完成以下任务。\n\n1. 从罗德里格斯公式 $P_n(x)=\\dfrac{1}{2^n n!}\\dfrac{d^n}{dx^n}\\left(x^2-1\\right)^n$ 以及 $\\{P_n\\}$ 关于内积 $\\langle f,g\\rangle=\\int_{-1}^{1}f(x)g(x)\\,dx$ 是正交的这一事实出发，推导三项递推关系，该关系将 $P_{n+1}(x)$ 表示为 $xP_n(x)$ 和 $P_{n-1}(x)$ 的线性组合，对所有整数 $n\\geq 1$ 成立。不要使用任何已有的递推关系；您的推导必须从罗德里格斯公式和所述的正交结构出发。\n\n2. 定义首一勒让德多项式 $\\{p_n(x)\\}_{n=0}^{\\infty}$ 为 $p_n(x)=\\kappa_n P_n(x)$，其中 $\\kappa_n$ 的选取使得 $p_n(x)$ 的首项系数为 1。显式地确定 $\\kappa_n$。\n\n3. 将第 1 部分中的递推关系重写为首一形式 $p_{n+1}(x)=\\left(x-\\alpha_n\\right)p_n(x)-\\beta_n p_{n-1}(x)$，并确定递推系数 $\\alpha_n$ 和 $\\beta_n$ 为关于 $n$ 的闭式解析表达式。\n\n将有序对 $(\\alpha_n,\\beta_n)$ 的最终答案表示为单行矩阵。不需要数值近似。", "solution": "该问题被认为是有效的，因为它具有科学依据、问题明确且客观。它涉及勒让德多项式的基本性质，所要求的推导是数学物理中一个标准但并非平凡的练习。所有必要的信息均已提供。\n\n解答按照题目要求分三部分呈现。\n\n**第 1 部分：三项递推关系的推导**\n\n设 $\\{P_n(x)\\}_{n=0}^{\\infty}$ 为勒让德多项式族，在区间 $[-1, 1]$ 上关于权重函数 $w(x)=1$ 正交。其内积为 $\\langle f, g \\rangle = \\int_{-1}^{1} f(x)g(x) \\, dx$。\n多项式 $xP_n(x)$ 的次数为 $n+1$，因此可以表示为基多项式 $\\{P_k(x)\\}$ 的线性组合：\n$$xP_n(x) = \\sum_{k=0}^{n+1} c_k P_k(x)$$\n其中系数由 $c_k = \\frac{\\langle xP_n, P_k \\rangle}{\\langle P_k, P_k \\rangle}$ 给出。\n根据内积的性质，$\\langle xP_n, P_k \\rangle = \\langle P_n, xP_k \\rangle$。由于 $xP_k(x)$ 是一个 $k+1$ 次多项式，根据勒让德多项式的正交性，如果 $k+1  n$ (即 $k  n-1$)，该内积为零。\n因此，只有系数 $c_{n+1}$、$c_n$ 和 $c_{n-1}$ 可能不为零。展开式简化为：\n$$xP_n(x) = c_{n+1}P_{n+1}(x) + c_n P_n(x) + c_{n-1}P_{n-1}(x)$$\n系数 $c_n$ 由 $c_n = \\frac{\\langle xP_n, P_n \\rangle}{\\langle P_n, P_n \\rangle}$ 给出。分子中的积分是 $\\int_{-1}^{1} x [P_n(x)]^2 \\, dx$。勒让德多项式的奇偶性为 $P_n(-x) = (-1)^n P_n(x)$。因此，$[P_n(-x)]^2 = ((-1)^n P_n(x))^2 = [P_n(x)]^2$，这意味着 $[P_n(x)]^2$ 对所有 $n$ 都是偶函数。项 $x$ 是奇函数。乘积 $x[P_n(x)]^2$ 是奇函数。奇函数在对称区间 $[-1, 1]$ 上的积分为零。因此，$\\langle xP_n, P_n \\rangle = 0$，这意味着 $c_n=0$。\n递推关系变为：\n$$xP_n(x) = c_{n+1} P_{n+1}(x) + c_{n-1} P_{n-1}(x)$$\n为了找到系数 $c_{n+1}$ 和 $c_{n-1}$，我们首先从罗德里格斯公式 $P_n(x) = \\frac{1}{2^n n!} \\frac{d^n}{dx^n} (x^2-1)^n$ 确定 $P_n(x)$ 的首项系数。\n项 $(x^2-1)^n$ 是一个多项式，其最高次项是 $x^{2n}$。\n$x^{2n}$ 的 $n$ 阶导数是 $\\frac{d^n}{dx^n}x^{2n} = (2n)(2n-1)\\cdots(n+1)x^n = \\frac{(2n)!}{n!}x^n$。\n因此，$P_n(x)$ 的首项系数（我们记为 $k_n$）是：\n$$k_n = \\frac{1}{2^n n!} \\frac{(2n)!}{n!} = \\frac{(2n)!}{2^n (n!)^2}$$\n通过比较递推关系 $xP_n(x) = c_{n+1}P_{n+1}(x) + c_{n-1}P_{n-1}(x)$ 中的首项系数：\n$k_n = c_{n+1} k_{n+1}$。这给出 $c_{n+1} = \\frac{k_n}{k_{n+1}}$。\n$$ \\frac{k_n}{k_{n+1}} = \\frac{(2n)!}{2^n (n!)^2} \\left/ \\frac{(2(n+1))!}{2^{n+1} ((n+1)!)^2} \\right. = \\frac{(2n)!}{2^n (n!)^2} \\frac{2^{n+1} (n+1)^2 (n!)^2}{(2n+2)!} = \\frac{2(n+1)^2}{(2n+2)(2n+1)} = \\frac{n+1}{2n+1} $$\n所以，$c_{n+1} = \\frac{n+1}{2n+1}$。\n\n接下来，我们求 $c_{n-1} = \\frac{\\langle xP_n, P_{n-1} \\rangle}{\\langle P_{n-1}, P_{n-1} \\rangle} = \\frac{\\langle P_n, xP_{n-1} \\rangle}{\\langle P_{n-1}, P_{n-1} \\rangle}$。\n多项式 $xP_{n-1}(x)$ 的次数为 $n$，其首项系数为 $k_{n-1}$。我们可以写成 $xP_{n-1}(x) = \\frac{k_{n-1}}{k_n}P_n(x) + (\\text{低于 } n \\text{ 次的项})$。\n因此，$\\langle P_n, xP_{n-1} \\rangle = \\frac{k_{n-1}}{k_n} \\langle P_n, P_n \\rangle$。\n那么系数 $c_{n-1}$ 就是 $c_{n-1} = \\frac{k_{n-1}}{k_n} \\frac{\\langle P_n, P_n \\rangle}{\\langle P_{n-1}, P_{n-1} \\rangle}$。\n为了继续，我们必须推导平方范数 $\\langle P_n, P_n \\rangle = \\int_{-1}^{1} [P_n(x)]^2 \\, dx$。\n$\\langle P_n, P_n \\rangle = \\langle P_n, k_n x^n + \\dots \\rangle = k_n \\langle P_n, x^n \\rangle$，因为 $P_n$ 与所有次数低于 $n$ 的多项式正交。\n我们使用罗德里格斯公式和 $n$ 次分部积分来计算 $\\langle P_n, x^n \\rangle = \\int_{-1}^1 x^n P_n(x) \\, dx$。\n$$ \\langle P_n, x^n \\rangle = \\frac{1}{2^n n!} \\int_{-1}^1 x^n \\left(\\frac{d^n}{dx^n} (x^2-1)^n\\right) dx $$\n每次分部积分都会引入一个负号，并降低 $(x^2-1)^n$ 上的导数阶数，同时对 $x^n$ 进行微分。边界项在每一步都为零，因为 $(x^2-1)^n$ 的直到 $n-1$ 阶的导数在 $x=\\pm 1$ 处都为零。经过 $n$ 步后：\n$$ \\langle P_n, x^n \\rangle = \\frac{(-1)^n}{2^n n!} \\int_{-1}^1 \\left(\\frac{d^n}{dx^n} x^n\\right) (x^2-1)^n dx = \\frac{(-1)^n n!}{2^n n!} \\int_{-1}^1 (x^2-1)^n dx = \\frac{1}{2^n} \\int_{-1}^1 (1-x^2)^n dx $$\n该积分通过换元 $x=\\sin\\theta$, $dx=\\cos\\theta d\\theta$ 来计算：\n$$ \\int_{-1}^1 (1-x^2)^n dx = \\int_{-\\pi/2}^{\\pi/2} (\\cos^2\\theta)^n \\cos\\theta d\\theta = 2 \\int_0^{\\pi/2} \\cos^{2n+1}\\theta d\\theta $$\n这是一个标准的瓦利斯积分，其值为 $2\\frac{(2n)!!}{(2n+1)!!} = 2 \\frac{2^n n!}{(2n+1)!!} = \\frac{2^{2n+1}(n!)^2}{(2n+1)!}$。\n所以，$\\langle P_n, x^n \\rangle = \\frac{1}{2^n} \\frac{2^{2n+1}(n!)^2}{(2n+1)!} = \\frac{2^{n+1}(n!)^2}{(2n+1)!}$。\n现在，我们求范数：\n$$ \\langle P_n, P_n \\rangle = k_n \\langle P_n, x^n \\rangle = \\frac{(2n)!}{2^n (n!)^2} \\frac{2^{n+1}(n!)^2}{(2n+1)!} = \\frac{2}{2n+1} $$\n使用这个结果，$\\frac{\\langle P_n, P_n \\rangle}{\\langle P_{n-1}, P_{n-1} \\rangle} = \\frac{2/(2n+1)}{2/(2(n-1)+1)} = \\frac{2n-1}{2n+1}$。\n首项系数之比 $\\frac{k_{n-1}}{k_n}$ 为 $\\frac{n}{2n-1}$（从 $c_{n+1} = k_n/k_{n+1} = (n+1)/(2n+1)$ 出发，将 $n$ 替换为 $n-1$ 可得 $k_{n-1}/k_n=n/(2n-1)$）。具体来说，$k_{n-1}/k_n = 1/(k_n/k_{n-1})$。$k_n/k_{n-1} = (2n-1)/n$。因此，$k_{n-1}/k_n=n/(2n-1)$ 是正确的。\n代入 $c_{n-1}$ 的表达式中：\n$$ c_{n-1} = \\frac{k_{n-1}}{k_n} \\frac{\\langle P_n, P_n \\rangle}{\\langle P_{n-1}, P_{n-1} \\rangle} = \\frac{n}{2n-1} \\frac{2n-1}{2n+1} = \\frac{n}{2n+1} $$\n递推关系是 $xP_n(x) = \\frac{n+1}{2n+1} P_{n+1}(x) + \\frac{n}{2n+1} P_{n-1}(x)$。\n解出 $P_{n+1}(x)$：\n$$ (n+1)P_{n+1}(x) = (2n+1)xP_n(x) - nP_{n-1}(x) $$\n$$ P_{n+1}(x) = \\frac{2n+1}{n+1}xP_n(x) - \\frac{n}{n+1}P_{n-1}(x) $$\n此关系对所有整数 $n \\geq 1$ 成立。\n\n**第 2 部分：首一比例因子 $\\kappa_n$ 的确定**\n\n首一多项式 $\\{p_n(x)\\}$ 定义为 $p_n(x) = \\kappa_n P_n(x)$，其中 $p_n(x)$ 的首项系数为 1。$p_n(x)$ 的首项系数是 $\\kappa_n k_n$。\n令 $\\kappa_n k_n = 1$ 得到 $\\kappa_n = \\frac{1}{k_n}$。\n$$ \\kappa_n = \\frac{2^n (n!)^2}{(2n)!} $$\n\n**第 3 部分：首一递推关系及系数 $\\alpha_n, \\beta_n$**\n\n我们使用 $P_k(x) = \\frac{1}{\\kappa_k}p_k(x)$ 重写第 1 部分的递推关系：\n$$ \\frac{1}{\\kappa_{n+1}}p_{n+1}(x) = \\frac{2n+1}{n+1}x \\frac{1}{\\kappa_n}p_n(x) - \\frac{n}{n+1}\\frac{1}{\\kappa_{n-1}}p_{n-1}(x) $$\n两边乘以 $\\kappa_{n+1}$ 得到：\n$$ p_{n+1}(x) = \\frac{\\kappa_{n+1}}{\\kappa_n}\\frac{2n+1}{n+1}x p_n(x) - \\frac{\\kappa_{n+1}}{\\kappa_{n-1}}\\frac{n}{n+1}p_{n-1}(x) $$\n我们计算 $x p_n(x)$ 项的系数。我们需要比值 $\\kappa_{n+1}/\\kappa_n$：\n$$ \\frac{\\kappa_{n+1}}{\\kappa_n} = \\frac{2^{n+1}((n+1)!)^2}{(2n+2)!} \\left/ \\frac{2^n (n!)^2}{(2n)!} \\right. = \\frac{2(n+1)^2}{(2n+2)(2n+1)} = \\frac{n+1}{2n+1} $$\n$x p_n(x)$ 的系数是 $\\frac{n+1}{2n+1} \\frac{2n+1}{n+1} = 1$。\n递推关系变为 $p_{n+1}(x) = x p_n(x) - \\beta_n p_{n-1}(x)$ 的形式。\n将其与目标形式 $p_{n+1}(x) = (x-\\alpha_n)p_n(x) - \\beta_n p_{n-1}(x)$ 进行比较，我们立即确定 $\\alpha_n = 0$。\n系数 $\\beta_n$ 由以下公式给出：\n$$ \\beta_n = \\frac{\\kappa_{n+1}}{\\kappa_{n-1}}\\frac{n}{n+1} $$\n我们计算比值 $\\kappa_{n+1}/\\kappa_{n-1}$：\n$$ \\frac{\\kappa_{n+1}}{\\kappa_{n-1}} = \\frac{2^{n+1}((n+1)!)^2}{(2n+2)!} \\left/ \\frac{2^{n-1}((n-1)!)^2}{(2n-2)!} \\right. = \\frac{2^2 (n+1)^2 n^2}{(2n+2)(2n+1)(2n)(2n-1)} = \\frac{4n^2(n+1)^2}{4n(n+1)(2n+1)(2n-1)} = \\frac{n(n+1)}{(2n+1)(2n-1)} $$\n将此结果代入 $\\beta_n$ 的表达式中：\n$$ \\beta_n = \\frac{n(n+1)}{(2n+1)(2n-1)} \\frac{n}{n+1} = \\frac{n^2}{(2n+1)(2n-1)} = \\frac{n^2}{4n^2-1} $$\n这个 $\\beta_n$ 的表达式对 $n \\geq 1$ 有效。\n首一勒让德多项式的递推系数为 $\\alpha_n=0$ 和 $\\beta_n = \\frac{n^2}{4n^2-1}$。", "answer": "$$ \\boxed{ \\begin{pmatrix} 0  \\frac{n^2}{4n^2-1} \\end{pmatrix} } $$", "id": "3423659"}, {"introduction": "在建立了递推关系的基础之上，我们现在转向它在构造高效算法方面的威力。本练习 [@problem_id:3423649] 聚焦于 $p$-自适应间断 Galerkin 方法中的一个核心挑战：当多项式次数增加时，如何高效地更新数值求积规则。你将推导出一个极为简洁高效的求积权重更新公式，它完美展示了正交多项式的抽象理论如何直接转化为显著的计算优势。", "problem": "考虑一个坐标为 $x \\in [-1,1]$ 的单个参考单元和一个严格正的权函数 $\\rho(x)$，该权函数定义了内积 $(f,g)_{\\rho} = \\int_{-1}^{1} f(x) g(x) \\rho(x)\\,dx$。设 $\\{\\phi_{n}\\}_{n \\ge 0}$ 是关于 $\\rho(x)$ 的正交多项式族，即 $(\\phi_{m},\\phi_{n})_{\\rho} = \\delta_{mn}$，它们满足三项递推关系\n$$\nx\\,\\phi_{n}(x) \\;=\\; a_{n+1}\\,\\phi_{n+1}(x) \\;+\\; b_{n}\\,\\phi_{n}(x) \\;+\\; a_{n}\\,\\phi_{n-1}(x),\n$$\n其中对于所有 $n \\ge 1$ 都有 $a_{n}  0$，并约定 $\\phi_{-1}(x) \\equiv 0$。\n\n一个间断 Galerkin (DG) 单元使用一个 $p$ 次的模态表示 $u_{p}(x) = \\sum_{n=0}^{p} c_{n}\\,\\phi_{n}(x)$，并通过在具有权重 $\\{w_{i}^{(p)}\\}_{i=1}^{M}$ 的固定节点 $\\{x_{i}\\}_{i=1}^{M}$ 上的离散内积来近似 $L^{2}$ 内积。假设权重被选择为 Christoffel 型权重\n$$\nw_{i}^{(p)} \\;=\\; \\frac{1}{K_{p}(x_{i})}, \n\\qquad \nK_{p}(x) \\;=\\; \\sum_{k=0}^{p} \\phi_{k}(x)^{2},\n$$\n使得对于最高 $p$ 次的多项式，离散内积模拟了连续内积。\n\n你希望执行一个从 $p$ 次到 $p+1$ 次的 $p$ 自适应加密，同时：\n- 基于已有的 $\\phi_{p}(x_{i})$ 和 $\\phi_{p-1}(x_{i})$，使用三项递推关系的单次扫描来更新求值结果 $\\phi_{p+1}(x_{i})$，以及\n- 将求积权重 $\\{w_{i}^{(p)}\\}$ 更新为 $\\{w_{i}^{(p+1)}\\}$，而无需从头重新计算。\n\n仅从三项递推关系、正交性和 $K_{p}(x)$ 的定义出发，推导一个仅用 $w_{i}^{(p)}$ 和 $\\phi_{p+1}(x_{i})$ 表示的、对每个节点 $x_i$ 都有效的更新后权重 $w_{i}^{(p+1)}$ 的闭式表达式。\n\n你的最终答案必须是仅用 $w_{i}^{(p)}$ 和 $\\phi_{p+1}(x_{i})$ 表示的 $w_{i}^{(p+1)}$ 的单个解析表达式。不需要进行数值计算。", "solution": "该问题被验证为科学上合理、适定且自洽的。解决该问题所需的所有必要定义都已提供。其背景是 $p$ 自适应间断 Galerkin (DG) 方法，但核心任务是基于所提供的正交多项式、求和核以及相关权重的定义进行数学推导。\n\n目标是推导一个用先前的权重 $w_{i}^{(p)}$ 和新基函数 $\\phi_{p+1}(x_{i})$ 在给定节点 $x_i$ 处的值表示的更新后求积权重 $w_{i}^{(p+1)}$ 的闭式表达式。该推导将仅依赖于问题陈述中提供的显式定义。\n\n问题为给定的多项式次数 $p$ 提供了以下关键定义：\n1.  核函数 $K_{p}(x)$ 被定义为最高 $p$ 次的正交基函数的平方和：\n    $$K_{p}(x) = \\sum_{k=0}^{p} \\phi_{k}(x)^{2}$$\n2.  在一个固定节点 $x_i$ 处的 Christoffel 型求积权重 $w_{i}^{(p)}$ 被定义为在该节点求值的核的倒数：\n    $$w_{i}^{(p)} = \\frac{1}{K_{p}(x_{i})}$$\n\n问题还提供了 $p$ 自适应加密的背景，其中近似次数从 $p$ 增加到 $p+1$。这涉及到在现有节点上计算新基函数 $\\phi_{p+1}(x)$ 的值。问题陈述指出 $\\phi_{p+1}(x_i)$ 是使用三项递推关系计算的。这一信息证明了在权重更新过程中 $\\phi_{p+1}(x_i)$ 的可用性，但在权重更新公式的推导中，递推关系本身并未被直接操作。\n\n我们的目标是找到 $w_{i}^{(p+1)}$ 的表达式。根据所提供的定义，$p+1$ 次的权重是：\n$$w_{i}^{(p+1)} = \\frac{1}{K_{p+1}(x_{i})}$$\n\n$p+1$ 次的核 $K_{p+1}(x)$ 被定义为：\n$$K_{p+1}(x) = \\sum_{k=0}^{p+1} \\phi_{k}(x)^{2}$$\n\n我们可以分解这个和式，以便将 $K_{p+1}(x)$ 与 $K_{p}(x)$ 联系起来。通过分离出求和的最后一项，我们得到：\n$$K_{p+1}(x) = \\left(\\sum_{k=0}^{p} \\phi_{k}(x)^{2}\\right) + \\phi_{p+1}(x)^{2}$$\n\n根据定义，括号中的表达式是 $p$ 次的核 $K_{p}(x)$。因此，我们得到了核函数的一个简单递推关系：\n$$K_{p+1}(x) = K_{p}(x) + \\phi_{p+1}(x)^{2}$$\n\n这个关系对任何 $x$ 都成立，因此它对每个固定的求积节点 $x_i$ 也成立：\n$$K_{p+1}(x_{i}) = K_{p}(x_{i}) + \\phi_{p+1}(x_{i})^{2}$$\n\n现在我们可以将权重的定义代入这个方程。从定义 $w_{i}^{(p)} = 1/K_{p}(x_i)$，我们有反向关系：\n$$K_{p}(x_i) = \\frac{1}{w_{i}^{(p)}}$$\n和\n$$K_{p+1}(x_i) = \\frac{1}{w_{i}^{(p+1)}}$$\n\n将这两个表达式代入核的递推关系，得到：\n$$\\frac{1}{w_{i}^{(p+1)}} = \\frac{1}{w_{i}^{(p)}} + \\phi_{p+1}(x_{i})^{2}$$\n\n这个方程将新权重的倒数与旧权重的倒数以及新基函数的值联系起来。为了找到 $w_{i}^{(p+1)}$ 的最终表达式，我们求解它。我们首先通过通分来合并右侧的项：\n$$\\frac{1}{w_{i}^{(p+1)}} = \\frac{1 + w_{i}^{(p)} \\phi_{p+1}(x_{i})^{2}}{w_{i}^{(p)}}$$\n\n最后，对等式两边取倒数，得到更新后权重的所需闭式表达式：\n$$w_{i}^{(p+1)} = \\frac{w_{i}^{(p)}}{1 + w_{i}^{(p)} \\phi_{p+1}(x_{i})^{2}}$$\n\n这个表达式提供了一个高效的更新规则。为了计算新权重 $\\{w_{i}^{(p+1)}\\}$，人们不需要从头重新计算核 $K_{p+1}(x_i)$ 的整个和。相反，人们可以使用已经计算出的权重 $\\{w_{i}^{(p)}\\}$ 和新计算出的 $\\{\\phi_{p+1}(x_i)\\}$ 的值，这与高效 $p$ 自适应加密过程的既定目标相一致。", "answer": "$$\n\\boxed{\\frac{w_{i}^{(p)}}{1 + w_{i}^{(p)} \\phi_{p+1}(x_{i})^{2}}}\n$$", "id": "3423649"}, {"introduction": "最后，我们来探讨实现递推关系时一个至关重要的方面：数值稳定性。一个理论上正确的算法，如果导致舍入误差被放大，那么在实践中可能会产生毫无意义的结果。本练习 [@problem_id:3423673] 通过比较前向和后向递推在计算“最小解”时的表现，深入探讨了这个问题，这类解在某些边界条件的处理中非常关键。通过此番分析，你将培养出选择稳健计算策略和规避数值陷阱所必需的判断力。", "problem": "考虑一个在紧区间上关于一个正常数权重的实正交多项式族 $\\{p_n\\}_{n \\ge 0}$，该多项式族经过归一化以满足三项递推关系\n$$\nx\\,p_n(x) \\;=\\; a_{n+1}\\,p_{n+1}(x) \\;+\\; b_n\\,p_n(x) \\;+\\; a_n\\,p_{n-1}(x), \\qquad n \\ge 0,\n$$\n其中 $a_n  0$，$b_n \\in \\mathbb{R}$，初始值为 $p_{-1}(x) \\equiv 0$，$p_0(x) \\equiv 1$。假设递推系数收敛，即当 $n \\to \\infty$ 时，$a_n \\to a  0$ 且 $b_n \\to 0$，这在经过适当归一化后对经典的雅可比(Jacobi)多项式族成立。定义第二类连带多项式 $\\{q_n(x)\\}_{n \\ge 0}$ 为具有不同初始值的相同齐次三项递推关系的唯一解，其初始值的选择使得对于任意固定的满足 $|x|  2a$ 的 $x$，该解在如下意义上是最小解：当 $n \\to \\infty$ 时，$q_n(x)$ 相对于任何其他线性无关解趋于 0。这些连带多项式出现在高阶谱元法和间断伽辽金(DG)方法中的边界算子求值中，在这些方法中，通常需要计算 $\\{q_n(x)\\}_{n=0}^N$，其中 $x$ 是一个固定的满足 $x  2a$ 的值，且 $N$ 很大。\n\n仅从 $(a_n,b_n)$ 的收敛性以及二阶线性差分方程的最小解和主导解的定义出发，分析在计算 $\\{q_n(x)\\}$（对于一个固定的 $x  2a$）时，控制前向（增加 $n$）和后向（减小 $n$，如Miller算法）误差放大的渐近增长因子。基于此分析，以下哪个陈述最准确地论证了在计算 $\\{q_n(x)\\}_{n=0}^N$ 时，为实现最小的舍入误差放大，在前向和后向递推之间应做出的数值稳定选择？\n\nA. 使用前向递推，因为当 $x  2a$ 时 $q_n(x)$ 随 $n$ 衰减，所以舍入误差被最小根 $|r_-|  1$ 所抑制；目标解的衰减保证了稳定性。\n\nB. 当 $a_n$ 随 $n$ 变化时，两个方向通常都不稳定；只有当 $a_n$ 是严格常数时，后向递推才可能稳定。否则，必须在每一步重新正交化。\n\nC. 使用后向递推（Miller算法），因为一般性扰动包含主导解的一个分量，该分量在前向迭代下以因子 $|r_+|  1$ 增长；反转方向会使这个不需要的分量在每一步乘以 $|r_+|^{-1}  1$，从而抑制它，使得最小解在相差一个归一化常数的情况下得以恢复。\n\nD. 对于 $x  2a$，两个方向的稳定性相同，因为特征根满足 $r_+ r_- = 1$，所以在浮点运算中，一个解的增长被另一个解的衰减精确抵消。", "solution": "首先将对问题陈述的科学严谨性、自洽性和清晰性进行验证。\n\n### 问题验证\n\n**第1步：提取已知条件**\n\n- 一个实正交多项式族 $\\{p_n\\}_{n \\ge 0}$ 满足三项递推关系：\n$$\nx\\,p_n(x) \\;=\\; a_{n+1}\\,p_{n+1}(x) \\;+\\; b_n\\,p_n(x) \\;+\\; a_n\\,p_{n-1}(x), \\qquad n \\ge 0\n$$\n- $\\{p_n\\}$ 的初始条件是 $p_{-1}(x) \\equiv 0$ 和 $p_0(x) \\equiv 1$。\n- 递推系数满足 $a_n  0$ 和 $b_n \\in \\mathbb{R}$。\n- 系数的渐近行为：当 $n \\to \\infty$ 时，$a_n \\to a  0$ 和 $b_n \\to 0$。\n- 第二个解族 $\\{q_n(x)\\}_{n \\ge 0}$（第二类连带多项式）满足相同的递推关系，但初始值不同。\n- 对于任何固定的满足 $|x|  2a$ 的 $x$，序列 $\\{q_n(x)\\}$ 被定义为最小解，意味着对于任何其他线性无关解 $\\{y_n(x)\\}$，都有 $\\lim_{n \\to \\infty} q_n(x) / y_n(x) = 0$。\n- 任务是分析使用前向与后向递推计算 $\\{q_n(x)\\}_{n=0}^N$（对于一个固定的 $x  2a$ 和大的 $N$）的数值稳定性。\n\n**第2步：使用提取的已知条件进行验证**\n\n- **科学依据：** 该问题根植于成熟的正交多项式数学理论和线性递推关系（差分方程）的数值分析。三项递推是正交多项式的一个基本性质（Favard定理）。最小解和主导解的概念是此类递推稳定性理论的核心，如Poincaré定理和Perron定理所述。条件 $|x|  2a$ 正确地将求值点置于正交区间 $[-2a, 2a]$ 之外，多项式的零点渐近地在该区间内累积，这是一个预期会出现指数增长/衰减的区域。谱元法和间断伽辽金(DG)方法的应用背景是真实的。\n- **适定的：** 该问题提供了确定计算稳定性的所有必要信息。递推关系、其系数的渐近行为以及目标解的定义属性（最小性）都已明确。这样的设置允许进行唯一且有意义的误差传播分析。\n- **客观的：** 问题使用精确、无歧义的数学语言陈述。诸如“最小解”和“舍入误差放大”等术语在数值分析中有清晰、客观的含义。\n\n**第3步：结论与行动**\n\n该问题具有科学严谨性、适定性和客观性。它代表了数值计算中一个经典且重要的话题。因此，该问题是**有效的**。我们可以继续进行求解。\n\n### 推导\n\n该分析关注计算二阶线性齐次差分方程特定解的数值稳定性：\n$$\na_{n+1}\\,y_{n+1}(x) + (b_n - x)\\,y_n(x) + a_n\\,y_{n-1}(x) = 0\n$$\n问题指明，当 $n \\to \\infty$ 时，系数具有极限 $a_n \\to a  0$ 和 $b_n \\to 0$。该递推关系渐近地趋近于常系数形式：\n$$\na\\,y_{n+1} - x\\,y_n + a\\,y_{n-1} \\approx 0\n$$\n我们通过寻找 $y_n = r^n$ 形式的解来分析这个极限方程。代入此拟设得到特征方程：\n$$\na\\,r^2 - x\\,r + a = 0 \\quad \\implies \\quad r^2 - \\frac{x}{a}\\,r + 1 = 0\n$$\n这个二次方程的根是：\n$$\nr_{\\pm} = \\frac{\\frac{x}{a} \\pm \\sqrt{(\\frac{x}{a})^2 - 4}}{2} = \\frac{x \\pm \\sqrt{x^2 - 4a^2}}{2a}\n$$\n问题考虑一个固定的 $x  2a$，这意味着 $x^2  4a^2$。因此，判别式为正，两个特征根 $r_+$ 和 $r_-$ 是实数且不相等。\n\n根据韦达定理，根的乘积为 $r_+ r_- = 1$。由于 $x  2a  0$ 且 $\\sqrt{x^2 - 4a^2}  0$，我们可以确定根的量级：\n- $r_+ = \\frac{x + \\sqrt{x^2 - 4a^2}}{2a}  \\frac{2a + 0}{2a} = 1$。因此， $|r_+|  1$。\n- $r_- = \\frac{1}{r_+}$。因此，$0  |r_-|  1$。\n\n根据线性差分方程理论（Perron-Kreuser定理），原始变系数递推的通解是两个基本解的线性组合，这两个基本解的渐近行为由这些根主导。\n- 一个解，即**主导解**，渐近地以 $r_+^n$ 增长。多项式解 $\\{p_n(x)\\}$ 是主导解的一个例子。\n- 另一个解，即**最小解**，渐近地以 $r_-^n$ 衰减。问题指出，对于 $x  2a$，$\\{q_n(x)\\}$ 就是这个最小解。\n\n**前向递推分析（增加 $n$）**\n要使用前向递推计算 $\\{q_n(x)\\}_{n=0}^N$，需要从 $q_0(x)$ 和 $q_1(x)$ 开始迭代：\n$$\nq_{n+1}(x) = \\frac{x-b_n}{a_{n+1}}\\,q_n(x) - \\frac{a_n}{a_{n+1}}\\,q_{n-1}(x)\n$$\n令 $\\hat{q}_n$ 为在浮点运算中计算出的值。在每一步，都会引入一个小的舍入误差。这意味着计算出的序列不是纯粹的最小解，而是一个受扰动的解。一个通解可以表示为：\n$$\n\\hat{q}_n = C_1 p_n(x) + C_2 q_n(x)\n$$\n即使我们从 $q_n(x)$ 的精确初始值开始，即初始的 $\\hat{q}_0, \\hat{q}_1$ 具有 $C_1=0$，后续的浮点运算也会引入等效于增加一个微小的主导解分量 $p_n(x)$ 的误差。设此误差分量为 $\\epsilon p_n(x)$。\n总的计算解为 $\\hat{q}_n(x) = q_n(x) + \\epsilon p_n(x)$。相对误差为：\n$$\n\\frac{|\\hat{q}_n(x) - q_n(x)|}{|q_n(x)|} = \\frac{|\\epsilon p_n(x)|}{|q_n(x)|} \\sim \\frac{|\\epsilon| |A r_+^n|}{|B r_-^n|} = \\frac{|\\epsilon A|}{|B|} |r_+|^{2n}\n$$\n由于 $|r_+|  1$，相对误差呈指数级增长。计算是数值不稳定的，因为期望的衰减解被不可避免的、增长的误差分量所淹没。\n\n**后向递推分析（减小 $n$）**\n要使用后向递推进行计算，需要重新整理公式以求解 $y_{n-1}$：\n$$\ny_{n-1}(x) = \\frac{x-b_n}{a_n}\\,y_n(x) - \\frac{a_{n+1}}{a_n}\\,y_{n+1}(x)\n$$\n在这个方向上，解的角色被反转了。一个行为类似于 $y_n \\sim r^n$ 的分量被转换为 $y_{n-1} \\sim r^{n-1} = y_n/r$。\n- 主导解分量 $p_n(x) \\sim r_+^n$ 在每一步被一个因子 $|r_+|^{-1}  1$ 所抑制。\n- 最小解分量 $q_n(x) \\sim r_-^n$ 在每一步被一个因子 $|r_-|^{-1} = |r_+|  1$ 所放大。\n\n这就是Miller算法的基础。从一个远大于 $N$ 的索引 $M$ 处，用任意值（例如 $\\tilde{q}_{M+1} = 0$ 和 $\\tilde{q}_{M} = 1$）开始后向递推。这些初始值代表了在该索引处真实主导解和最小解的某种线性组合。当从 $n=M-1$ 向下迭代到 $0$ 时，对应于原始主导解 $p_n(x)$ 的分量被指数级抑制。对应于最小解 $q_n(x)$ 的分量被指数级放大，并迅速主导该序列。因此，计算出的序列 $\\{\\tilde{q}_n\\}_{n=0}^N$ 变得与真实的最小解 $\\{q_n(x)\\}_{n=0}^N$ 成比例。\n$$\n\\tilde{q}_n \\approx C \\cdot q_n(x) \\quad \\text{for } n \\le N\n$$\n比例常数 $C$ 可以通过使用序列的一个已知属性来找到，例如一个求和规则或一个已知值（例如 $q_0(x)$，如果它可以被独立确定）。该方法是数值稳定的，因为它系统地消除了不需要的增长解。\n\n### 逐项分析\n\n**A. 使用前向递推，因为当 $x > 2a$ 时 $q_n(x)$ 随 $n$ 衰减，所以舍入误差被最小根 $|r_-|  1$ 所抑制；目标解的衰减保证了稳定性。**\n这是一个谬误的论点。递推的稳定性是由误差的行为决定的，而不是由目标解决定的。因为通解包含一个以 $|r_+|^n$ 增长的分量，任何舍入误差都会激发这个主导模式，而这个模式在前向迭代中被放大，导致不稳定。目标解的衰减使情况变得更糟，因为增长的误差会迅速淹没它。\n**结论：不正确。**\n\n**B. 当 $a_n$ 随 $n$ 变化时，两个方向通常都不稳定；只有当 $a_n$ 是严格常数时，后向递推才可能稳定。否则，必须在每一步重新正交化。**\n这是不正确的。稳定性分析基于系数的渐近行为，正如适用于变系数递推的Poincaré-Perron-Kreuser理论所阐述的那样。极限根 $|r_+|>1$ 和 $|r_-|1$ 的存在就足够了。Miller算法是用于变系数递推的一种标准的、稳定的技术，并且不要求系数为常数。\n**结论：不正确。**\n\n**C. 使用后向递推（Miller算法），因为一般性扰动包含主导解的一个分量，该分量在前向迭代下以因子 $|r_+| > 1$ 增长；反转方向会使这个不需要的分量在每一步乘以 $|r_+|^{-1}  1$，从而抑制它，使得最小解在相差一个归一化常数的情况下得以恢复。**\n这个陈述提供了一个正确且完整的论证。它正确地指出了前向迭代由于误差中主导解分量的放大而变得不稳定。它接着准确地描述了后向递推的机制：解的角色被反转，不需要的主导分量在每一步被一个因子 $|r_+|^{-1}  1$ 所抑制，从而确保计算出的序列收敛到所需的最小解（相差一个缩放因子）。这是对Miller算法稳定性的标准解释。\n**结论：正确。**\n\n**D. 对于 $x > 2a$，两个方向的稳定性相同，因为特征根满足 $r_+ r_- = 1$，所以在浮点运算中，一个解的增长被另一个解的衰减精确抵消。**\n这是不正确的。属性 $r_+ r_- = 1$ 是正确的，但结论是错误的。在浮点运算中，将一个大数（增长的误差）与一个小数（衰减的解）相加，会导致小数丢失。不存在抵消。同时存在增长解和衰减解是一个问题的决定性特征，在这种问题中，计算方向对稳定性至关重要。两个方向在稳定性属性上有着根本的不同。\n**结论：不正确。**", "answer": "$$\\boxed{C}$$", "id": "3423673"}]}