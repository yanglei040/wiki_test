{"hands_on_practices": [{"introduction": "这个首个实践练习将让您亲身体验范德蒙德矩阵臭名昭著的病态特性。通过数值计算在不同区间上等距节点的条件数，您将亲眼见证数值稳定性是如何随着节点数的增加而迅速恶化的。这个练习 [@problem_id:3256284] 为理解为何基函数的选择和节点分布在谱方法和高阶方法中至关重要，奠定了经验基础。", "problem": "考虑 Newton–Cotes 求积法则的推导，其中权重是通过在多项式基上强制其精确性来确定的。设区间上有 $n$ 个等距节点，记为 $x_0, x_1, \\dots, x_{n-1}$。为构造能够精确积分直至 $n-1$ 次多项式的权重，需要使用一个匹配单项式矩的线性系统。该线性系统中的系数矩阵是范德蒙矩阵 $V \\in \\mathbb{R}^{n \\times n}$，其元素为 $V_{i,j} = x_i^j$，其中 $i = 0,1,\\dots,n-1$ 且 $j = 0,1,\\dots,n-1$。求解此类线性系统的数值敏感性由矩阵 $V$ 在矩阵 2-范数下的条件数决定，其定义为 $\\kappa_2(V) = \\|V\\|_2 \\|V^{-1}\\|_2$，可计算为 $V$ 的最大奇异值与最小奇异值之比。\n\n从一个基本事实出发：Newton–Cotes 权重是通过求解一个线性系统得到的，该系统的系数矩阵是一个由等距节点构造的范德蒙矩阵。结合通过奇异值定义的矩阵 2-范数条件数，研究此范德蒙矩阵的条件如何依赖于节点数 $n$ 和区间缩放。具体来说，比较两个区间：\n(1) 单位区间 $[0,1]$，其节点为 $x_i = \\frac{i}{n-1}$ (当 $n > 1$ 时) 和 $x_0 = 0$ (当 $n = 1$ 时)，以及\n(2) 对称区间 $[-1,1]$，其节点为 $x_i = -1 + \\frac{2 i}{n-1}$ (当 $n > 1$ 时) 和 $x_0 = 0$ (当 $n = 1$ 时)。\n对于每个 $n$，使用单项式基 $1, x, x^2, \\dots, x^{n-1}$ 构造相应的范德蒙矩阵 $V$，通过奇异值分解计算 $\\kappa_2(V)$，并报告两个区间上 $\\log_{10}(\\kappa_2(V))$ 的值（以 10 为底的对数）。此外，报告差值 $\\log_{10}(\\kappa_2(V \\text{ on } [0,1])) - \\log_{10}(\\kappa_2(V \\text{ on } [-1,1]))$ 以量化区间缩放对条件的影响。\n\n您的任务是编写一个完整的、可运行的程序，对以下节点数 $n$ 的测试套件进行双精度计算：$n \\in \\{1,2,3,5,10,15,20\\}$。该测试套件包括一个边界情况 $n=1$、一些小案例以及一些条件会变得非常差的大案例。对于测试套件中的每个 $n$，您的程序必须输出一个浮点数三元组 $[\\log_{10}(\\kappa_2(V_{[0,1]})), \\log_{10}(\\kappa_2(V_{[-1,1]})), \\log_{10}(\\kappa_2(V_{[0,1]})) - \\log_{10}(\\kappa_2(V_{[-1,1]}))]$。\n\n最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每个元素对应测试套件中的一个 $n$，其本身也是一个用方括号括起来的逗号分隔三元组。例如，输出应类似于 $[[a,b,c],[d,e,f],\\dots]$，不含任何空格。\n\n不涉及物理单位或角度。所有答案必须是指定的浮点数，并且数值应如前所述，使用通过奇异值计算的矩阵 2-范数条件数来得出。", "solution": "该问题要求研究在两个不同区间（单位区间 $[0,1]$ 和对称区间 $[-1,1]$）上由等距节点构造的范德蒙矩阵的数值条件。此分析对于理解推导 Newton-Cotes 求积权重方法的数值稳定性至关重要，这些方法依赖于求解一个包含此类矩阵的线性系统。\n\n推导一个对所有直至 $n-1$ 次的多项式都精确的 $n$ 点求积法则的权重，需要求解线性系统 $Vw = \\mathbf{m}$。在此系统中，$V$ 是一个 $n \\times n$ 的范德蒙矩阵，$w$ 是未知权重的向量，$\\mathbf{m}$ 是单项式基函数的矩向量，其元素为 $m_j = \\int_a^b x^j dx$，其中 $j=0, 1, \\dots, n-1$。范德蒙矩阵 $V$ 由 $n$ 个求积节点 $x_0, x_1, \\dots, x_{n-1}$ 构造，其元素定义为 $V_{i,j} = x_i^j$，其中 $i,j \\in \\{0, \\dots, n-1\\}$。\n\n求解 $Vw = \\mathbf{m}$ 的数值稳定性由矩阵 $V$ 的条件数决定。大的条件数意味着输入数据（例如，矩向量 $\\mathbf{m}$）中的小误差可能导致计算解（权重 $w$）中的大误差。矩阵 2-范数条件数，记为 $\\kappa_2(V)$，定义为 $\\kappa_2(V) = \\|V\\|_2 \\|V^{-1}\\|_2$。它被计算为矩阵最大奇异值 ($\\sigma_{\\max}$) 与最小奇异值 ($\\sigma_{\\min}$) 之比：\n$$ \\kappa_2(V) = \\frac{\\sigma_{\\max}(V)}{\\sigma_{\\min}(V)} $$\n奇异值通过奇异值分解 (SVD) 计算。对于由等距点构造的范德蒙矩阵，已知 $\\kappa_2(V)$ 会随着节点数 $n$ 呈指数级增长，导致极端病态。为了处理这些数值的巨大数量级，我们分析它们以 10 为底的对数，即 $\\log_{10}(\\kappa_2(V))$。\n\n解决该问题的步骤如下：\n对于测试套件 $\\{1, 2, 3, 5, 10, 15, 20\\}$ 中的每个节点数 $n$：\n$1$. 首先处理 $n=1$ 的特殊情况。问题指定两个区间的节点均为 $x_0 = 0$。这产生一个 $1 \\times 1$ 的范德蒙矩阵 $V = [x_0^0] = [1]$。其奇异值为 $1$，因此两个区间的 $\\kappa_2(V) = 1$ 且 $\\log_{10}(\\kappa_2(V)) = 0$。\n\n$2$. 对于 $n > 1$ 的情况：\n   a. **区间 $[0,1]$**：使用公式 $x_i = \\frac{i}{n-1}$ (其中 $i=0, 1, \\dots, n-1$) 生成一组 $n$ 个等距节点 $\\{x_i\\}$。构造相应的范德蒙矩阵 $V_{[0,1]}$。\n   b. **区间 $[-1,1]$**：使用公式 $x_i = -1 + \\frac{2i}{n-1}$ (其中 $i=0, 1, \\dots, n-1$) 生成第二组 $n$ 个等距节点 $\\{x_i\\}$。构造相应的范德蒙矩阵 $V_{[-1,1]}$。\n   c. 对于两个矩阵，均使用基于 SVD 的方法计算 2-范数条件数。\n   d. 计算每个条件数以 10 为底的对数。\n   e. 计算差值 $\\log_{10}(\\kappa_2(V_{[0,1]})) - \\log_{10}(\\kappa_2(V_{[-1,1]}))$，以量化区间选择对条件的影响。\n\n区间的选择对条件有深刻影响。在 $[0,1]$ 上，所有节点都是非负的。基函数 $x^j$ 和 $x^{j+1}$ 在此区间上的行为相似，导致范德蒙矩阵的列向量近似线性相关。这种近似共线性是导致严重病态的根源。相比之下，区间 $[-1,1]$ 关于原点对称。这种对称性在范德蒙矩阵的列向量之间（例如，对于奇次幂和偶次幂 $j$）引入了一定程度的正交性，从而显著缓解了病态问题。以下程序实现了这一分析。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the log10 of the 2-norm condition number for Vandermonde matrices\n    on two different intervals for a given set of node counts.\n    \"\"\"\n    \n    # Test suite of node counts as specified in the problem statement.\n    test_cases_n = [1, 2, 3, 5, 10, 15, 20]\n    \n    results = []\n    \n    for n in test_cases_n:\n        # The problem statement defines V_{i,j} = x_i^j, which corresponds to\n        # increasing powers in the numpy.vander function.\n        # This is handled by setting the 'increasing' parameter to True.\n        \n        # We perform calculations in double precision as requested.\n        # numpy's default float is float64 (double precision).\n        dtype = np.float64\n        \n        # Handle the special case n=1 as per the problem description.\n        if n == 1:\n            # For n=1, x0=0 for both intervals. V=[[1]].\n            # The condition number of a 1x1 non-zero matrix is 1.\n            # log10(1) = 0.\n            log_kappa_01 = 0.0\n            log_kappa_m11 = 0.0\n        else:\n            # --- Interval [0, 1] ---\n            # Generate n equispaced nodes from 0 to 1.\n            nodes_01 = np.linspace(0.0, 1.0, n, dtype=dtype)\n            # Construct the Vandermonde matrix.\n            V_01 = np.vander(nodes_01, N=n, increasing=True)\n            # Compute the 2-norm condition number.\n            kappa_01 = np.linalg.cond(V_01, p=2)\n            # Compute the base-10 logarithm.\n            log_kappa_01 = np.log10(kappa_01)\n            \n            # --- Interval [-1, 1] ---\n            # Generate n equispaced nodes from -1 to 1.\n            nodes_m11 = np.linspace(-1.0, 1.0, n, dtype=dtype)\n            # Construct the Vandermonde matrix.\n            V_m11 = np.vander(nodes_m11, N=n, increasing=True)\n            # Compute the 2-norm condition number.\n            kappa_m11 = np.linalg.cond(V_m11, p=2)\n            # Compute the base-10 logarithm.\n            log_kappa_m11 = np.log10(kappa_m11)\n\n        # Calculate the difference in log-condition numbers.\n        diff = log_kappa_01 - log_kappa_m11\n        \n        # Store the triple of results for this n.\n        results.append([log_kappa_01, log_kappa_m11, diff])\n        \n    # Format the final output string exactly as required: [[a,b,c],[d,e,f],...].\n    # No spaces are permitted in the final output string.\n    output_str = \"[\" + \",\".join([f\"[{r[0]},{r[1]},{r[2]}]\" for r in results]) + \"]\"\n    \n    # Print the single-line result to standard output.\n    print(output_str)\n\nsolve()\n```", "id": "3256284"}, {"introduction": "在观察到病态现象后，我们现在深入探讨其理论根源。这个练习 [@problem_id:3372894] 将引导您用格拉姆矩阵 $G = V^{\\top} V$ 的特征值来重新表达条件数。这揭示了一个深层的联系：条件数反映了范德蒙德矩阵列向量之间的非正交程度，从而为前一个实践中观察到的数值不稳定性提供了精确的数学解释。", "problem": "在高阶谱方法和间断伽辽金方法中，在不同节点 $\\{x_i\\}_{i=1}^{n}$ 上，次数至多为 $n-1$ 的多项式的节点表示会产生一个范德蒙矩阵 $V \\in \\mathbb{R}^{n \\times n}$，其列由选定的多项式基在这些节点上的求值构成。考虑这样一个可逆的范德蒙矩阵 $V$ 及其格拉姆矩阵 $G = V^{\\top} V$。欧几里得范数下的谱条件数定义为 $\\kappa_{2}(V) = \\|V\\|_{2} \\,\\|V^{-1}\\|_{2}$，其中 $\\|\\cdot\\|_{2}$ 表示由欧几里得内积诱导的谱范数。\n\n从奇异值、谱范数和格拉姆矩阵的定义出发，完成以下任务：\n\n- 推导 $\\kappa_{2}(V)$ 关于 $G$ 的特征值的表达式。\n- 此外，假设 $V$ 的列已被缩放至单位欧几里得范数，且不同列之间的两两内积的绝对值被一个常数 $\\varepsilon \\in [0,1)$ 一致地界定，即，若 $v_i$ 表示第 $i$ 列，则对所有 $i$ 有 $v_i^{\\top} v_i = 1$ 且 $\\max_{i \\neq j} |v_i^{\\top} v_j| \\le \\varepsilon$。仅使用标准谱理论来分析此近正交性假设如何约束 $G$ 的谱，并推导出一个仅依赖于 $n$ 和 $\\varepsilon$ 的 $\\kappa_{2}(V)$ 的界。\n\n请给出你在近正交性假设下得到的 $\\kappa_{2}(V)$ 的界的单一闭式解析表达式。无需进行数值计算。", "solution": "我们从数值线性代数的核心定义开始。对于任何实矩阵 $V \\in \\mathbb{R}^{n \\times n}$，其谱范数为 $\\|V\\|_{2} = \\sigma_{\\max}(V)$，即 $V$ 的最大奇异值；如果 $V$ 可逆，则 $\\|V^{-1}\\|_{2} = \\sigma_{\\max}(V^{-1}) = 1/\\sigma_{\\min}(V)$，其中 $\\sigma_{\\min}(V)$ 是 $V$ 的最小奇异值。因此，\n$$\n\\kappa_{2}(V) \\;=\\; \\|V\\|_{2}\\,\\|V^{-1}\\|_{2} \\;=\\; \\frac{\\sigma_{\\max}(V)}{\\sigma_{\\min}(V)}.\n$$\n$V$ 的奇异值是正定格拉姆矩阵 $G = V^{\\top} V$ 的特征值的非负平方根。具体来说，如果 $\\lambda_{1}(G) \\ge \\lambda_{2}(G) \\ge \\cdots \\ge \\lambda_{n}(G) > 0$ 是 $G$ 的特征值，那么\n$$\n\\sigma_{i}(V) \\;=\\; \\sqrt{\\lambda_{i}(G)} \\quad \\text{对每个 } i \\text{ 成立},\n$$\n因此\n$$\n\\sigma_{\\max}(V) \\;=\\; \\sqrt{\\lambda_{\\max}(G)}, \\qquad \\sigma_{\\min}(V) \\;=\\; \\sqrt{\\lambda_{\\min}(G)}.\n$$\n由此直接可得\n$$\n\\kappa_{2}(V) \\;=\\; \\frac{\\sqrt{\\lambda_{\\max}(G)}}{\\sqrt{\\lambda_{\\min}(G)}} \\;=\\; \\sqrt{\\frac{\\lambda_{\\max}(G)}{\\lambda_{\\min}(G)}}.\n$$\n\n现在我们引入近正交性假设。设 $v_{1},\\dots,v_{n}$ 为 $V$ 的列，它们已被缩放以使对所有 $i$ 都有 $v_{i}^{\\top} v_{i} = 1$，且两两相干性以 $\\varepsilon \\in [0,1)$ 为界：\n$$\n\\max_{i \\neq j} |v_{i}^{\\top} v_{j}| \\;\\le\\; \\varepsilon.\n$$\n在这些假设下，格拉姆矩阵 $G = V^{\\top} V$ 具有厄米矩阵的结构，其对角元等于 $1$，非对角元的绝对值以 $\\varepsilon$ 为界：\n$$\nG_{ii} \\;=\\; 1, \\qquad |G_{ij}| \\;\\le\\; \\varepsilon \\quad \\text{for } i \\neq j.\n$$\n我们使用盖尔圆盘定理来约束 $G$ 的特征值。对于每一行 $i$，盖尔圆盘以 $G_{ii} = 1$ 为中心，半径为\n$$\nR_{i} \\;=\\; \\sum_{j \\neq i} |G_{ij}| \\;\\le\\; (n-1)\\,\\varepsilon.\n$$\n因此，$G$ 的每个特征值 $\\lambda(G)$ 都位于这些圆盘的并集中，这意味着以下粗略但一致的界\n$$\n\\lambda_{\\min}(G) \\;\\ge\\; 1 - (n-1)\\varepsilon, \\qquad \\lambda_{\\max}(G) \\;\\le\\; 1 + (n-1)\\varepsilon.\n$$\n因为 $G$ 是正定的，为使下界有意义，我们需要 $1 - (n-1)\\varepsilon > 0$；如果 $(n-1)\\varepsilon  1$，这个条件就能得到保证。将这些界与前面 $\\kappa_{2}(V)$ 的恒等式结合，得到\n$$\n\\kappa_{2}(V) \\;=\\; \\sqrt{\\frac{\\lambda_{\\max}(G)}{\\lambda_{\\min}(G)}} \\;\\le\\; \\sqrt{\\frac{1 + (n-1)\\varepsilon}{1 - (n-1)\\varepsilon}}.\n$$\n\n这个表达式量化了近正交性的影响：当 $\\varepsilon \\to 0$ 时，格拉姆矩阵 $G$ 趋近于单位矩阵，因此其特征值聚集在 $1$ 附近，条件数界也趋近于 $1$。反之，增加 $\\varepsilon$ 会扩大 $G$ 的最大和最小特征值之间的差距，从而恶化条件数；其敏感度通过因子 $(n-1)\\varepsilon$ 随 $n$ 的增长而增长。\n\n所要求的最终解析表达式即为上面推导出的 $\\kappa_{2}(V)$ 的界。", "answer": "$$\\boxed{\\sqrt{\\frac{1+(n-1)\\varepsilon}{\\,1-(n-1)\\varepsilon\\,}}}$$", "id": "3372894"}, {"introduction": "这最后一个实践从诊断转向治疗，提出了一种强大的技术来克服单项式范德蒙德系统的病态问题。您将构建一个基于基变换的预条件子，转换到勒让德正交多项式基，这是谱方法的一个基石。这个练习 [@problem_id:3372834] 证明了这种优雅的变换如何产生一个条件数完美的系统，突显了在高阶数值格式中使用正交基的深远优势。", "problem": "考虑节点谱方法或间断 Galerkin (DG) 离散化中区间 $[-1,1]$ 上的一个一维单元。设 $N \\in \\mathbb{N}$ 是一个固定的数，并设 $\\{x_{i}\\}_{i=1}^{N}$ 表示 $N$ 个 Gauss–Legendre 节点，即 $N$ 次 Legendre 多项式的 $N$ 个不同根。设 $\\{w_{i}\\}_{i=1}^{N}$ 是相关的 Gauss–Legendre 求积权重。定义单项式 Vandermonde 矩阵 $V \\in \\mathbb{R}^{N \\times N}$ 如下：\n$$\nV_{i,k} = x_{i}^{k}, \\quad 1 \\leq i \\leq N, \\quad 0 \\leq k \\leq N-1.\n$$\n设 $\\{p_{j}\\}_{j=0}^{N-1}$ 为 $[-1,1]$ 上的 Legendre 多项式，其经过归一化，关于带单位权重的标准 $L^{2}([-1,1])$ 内积是标准正交的，即：\n$$\n\\int_{-1}^{1} p_{j}(x)\\,p_{k}(x)\\,\\mathrm{d}x = \\delta_{jk}, \\quad 0 \\leq j,k \\leq N-1.\n$$\n定义求值矩阵 $\\Phi \\in \\mathbb{R}^{N \\times N}$ 如下：\n$$\n\\Phi_{i,j} = p_{j}(x_{i}), \\quad 1 \\leq i \\leq N, \\quad 0 \\leq j \\leq N-1.\n$$\n存在一个从单项式基到标准正交多项式基的基变换矩阵 $C \\in \\mathbb{R}^{N \\times N}$，使得 $\\Phi = V C$。同时考虑求积权重的对角矩阵 $W = \\mathrm{diag}(w_{1},\\dots,w_{N})$ 及其正定平方根 $L = W^{1/2} = \\mathrm{diag}(\\sqrt{w_{1}},\\dots,\\sqrt{w_{N}})$。\n\n仅从上述定义以及标准正交多项式和 Gauss–Legendre 求积的基本性质出发，推导一个基于到标准正交多项式基的投影的预处理器，该预处理器将单项式 Vandermonde 矩阵转换为一个近似正交的求值矩阵。具体来说，利用 $L$ 和 $C$ 构建左、右预处理器，使得预处理后的矩阵的列在欧几里得内积下是标准正交的，并以此严格分析该预处理对 2-范数条件数 $\\kappa_{2}$ 的有效性。\n\n你的任务是，当多项式次数为 $N-1$ 且节点为 $N$ 个 Gauss–Legendre 点及其相关求积权重时，计算完全预处理后的矩阵的 2-范数条件数 $\\kappa_{2}$ 的精确值。将最终答案表示为一个精确的数，无需四舍五入。", "solution": "目标是为单项式 Vandermonde 矩阵 $V$ 推导一个预处理策略，并计算得到的预处理后矩阵的 2-范数条件数。该预处理应使用给定的矩阵 $L$ 和 $C$ 来构建。\n\n设预处理后的矩阵记为 $A$。对矩阵 $V$ 的一般双边预处理形式为 $A = P_L V P_R$，其中 $P_L$ 和 $P_R$ 分别是左、右预处理器。问题指定这些预处理器应由基变换矩阵 $C$ 和缩放后的求积权重矩阵 $L = W^{1/2}$ 构建。\n\n问题陈述了存在一个从单项式基 $\\{x^k\\}_{k=0}^{N-1}$ 到标准正交多项式基 $\\{p_j\\}_{j=0}^{N-1}$ 的基变换矩阵 $C \\in \\mathbb{R}^{N \\times N}$，使得 $\\Phi = V C$。这个关系将病态的单项式 Vandermonde 矩阵 $V$ 与条件更好的标准正交多项式求值矩阵 $\\Phi$ 联系起来。右预处理器的一个自然选择是 $P_R = C$，因为这能有效地将问题的基从单项式基变为标准正交 Legendre 多项式基。\n\n应用这个右预处理器，我们得到一个中间矩阵 $V C = \\Phi$。$\\Phi$ 的列是标准正交多项式 $\\{p_j\\}_{j=0}^{N-1}$ 在 Gauss-Legendre 节点 $\\{x_i\\}_{i=1}^{N}$ 处的求值。问题要求最终的预处理矩阵的列在欧几里得内积下是标准正交的。让我们检验一下 $\\Phi$ 的列。$\\Phi$ 的第 $j$ 列和第 $k$ 列的内积由下式给出：\n$$\n(\\Phi_{:,j})^T (\\Phi_{:,k}) = \\sum_{i=1}^{N} \\Phi_{ij} \\Phi_{ik} = \\sum_{i=1}^{N} p_j(x_i) p_k(x_i)\n$$\n这个表达式通常不等于 Kronecker delta $\\delta_{jk}$。然而，我们可以利用 Gauss-Legendre 求积的基本性质。使用 $N$ 个节点 $\\{x_i\\}$ 和权重 $\\{w_i\\}$ 的求积法则对任何次数至多为 $2N-1$ 的多项式 $f(x)$ 都是精确的。即，\n$$\n\\int_{-1}^{1} f(x)\\,\\mathrm{d}x = \\sum_{i=1}^{N} w_i f(x_i)\n$$\n给定的多项式 $\\{p_j(x)\\}_{j=0}^{N-1}$ 在 $[-1,1]$ 上关于单位权重函数是标准正交的：\n$$\n\\int_{-1}^{1} p_j(x) p_k(x)\\,\\mathrm{d}x = \\delta_{jk}\n$$\n考虑函数 $f(x) = p_j(x) p_k(x)$。这个多项式的次数是 $j+k$。由于 $0 \\le j, k \\le N-1$，最大次数为 $(N-1) + (N-1) = 2N-2$。因为 $2N-2  2N-1$，Gauss-Legendre 求积法则对 $p_j(x) p_k(x)$ 是精确的。因此，我们可以写出：\n$$\n\\delta_{jk} = \\int_{-1}^{1} p_j(x) p_k(x)\\,\\mathrm{d}x = \\sum_{i=1}^{N} w_i p_j(x_i) p_k(x_i)\n$$\n让我们用矩阵形式表示这个结果。右边的和是矩阵乘积 $\\Phi^T W \\Phi$ 的第 $(j,k)$ 个元素，其中 $W = \\mathrm{diag}(w_1, \\dots, w_N)$。具体来说：\n$$\n(\\Phi^T W \\Phi)_{jk} = \\sum_{l=1}^{N} (\\Phi^T)_{jl} (W \\Phi)_{lk} = \\sum_{l=1}^{N} \\Phi_{lj} \\sum_{m=1}^{N} W_{lm} \\Phi_{mk} = \\sum_{l=1}^{N} \\Phi_{lj} (w_l \\Phi_{lk}) = \\sum_{l=1}^{N} w_l p_j(x_l) p_k(x_l)\n$$\n与求积结果比较，我们发现：\n$$\n\\Phi^T W \\Phi = I\n$$\n其中 $I$ 是 $N \\times N$ 的单位矩阵。这表明 $\\Phi$ 的列关于由矩阵 $W$ 加权的内积是正交的。\n\n问题要求预处理后的矩阵 $A$ 的列在标准欧几里得内积下是标准正交的，这意味着我们需要 $A^T A = I$。设左预处理器为 $P_L$。预处理后的矩阵为 $A = P_L V C = P_L \\Phi$。让我们计算 $A^T A$：\n$$\nA^T A = (P_L \\Phi)^T (P_L \\Phi) = \\Phi^T P_L^T P_L \\Phi\n$$\n我们希望它等于单位矩阵 $I$。与我们推导出的性质 $\\Phi^T W \\Phi = I$ 比较，一个显而易见的选择是设 $P_L^T P_L = W$。\n问题提供了矩阵 $L = W^{1/2} = \\mathrm{diag}(\\sqrt{w_1},\\dots,\\sqrt{w_N})$。由于求积权重 $w_i$ 是正的，$L$ 是一个实对称正定矩阵。我们选择 $P_L=L$。那么：\n$$\nP_L^T P_L = L^T L = L L = W^{1/2} W^{1/2} = W\n$$\n这个选择满足条件。因此，完全预处理后的矩阵是 $A = L V C$。\n\n现在我们可以验证 $A$ 的列的标准正交性：\n$$\nA = L(VC) = L\\Phi\n$$\n$$\nA^T A = (L\\Phi)^T (L\\Phi) = \\Phi^T L^T L \\Phi = \\Phi^T W \\Phi = I\n$$\n由于 $A$ 是一个 $N \\times N$ 的方阵且满足 $A^T A = I$，所以 $A$ 是一个正交矩阵。\n\n最后的任务是计算该矩阵 $A$ 的 2-范数条件数 $\\kappa_2(A)$。条件数定义为 $\\kappa_2(A) = \\|A\\|_2 \\|A^{-1}\\|_2$。或者，对于非奇异矩阵，它可以表示为最大奇异值与最小奇异值的比值：$\\kappa_2(A) = \\frac{\\sigma_{\\max}(A)}{\\sigma_{\\min}(A)}$。\n\n矩阵 $A$ 的奇异值是矩阵 $A^T A$ 的特征值的平方根。在我们的例子中，我们已经证明了 $A^T A = I$。单位矩阵 $I$ 的所有特征值都等于 $1$。设 $\\lambda_j$ 是 $A^T A$ 的特征值，则对所有 $j=1, \\dots, N$，有 $\\lambda_j = 1$。\n奇异值 $\\sigma_j(A)$ 由下式给出：\n$$\n\\sigma_j(A) = \\sqrt{\\lambda_j(A^T A)} = \\sqrt{1} = 1 \\quad \\text{for } j=1, \\dots, N\n$$\n由于 $A$ 的所有奇异值都等于 $1$，所以最大奇异值 $\\sigma_{\\max}(A) = 1$，最小奇异值 $\\sigma_{\\min}(A) = 1$。\n因此，$A$ 的 2-范数条件数是：\n$$\n\\kappa_2(A) = \\frac{\\sigma_{\\max}(A)}{\\sigma_{\\min}(A)} = \\frac{1}{1} = 1\n$$\n这个结果表明了该预处理策略极高的有效性。原始的单项式 Vandermonde 矩阵 $V$ 是出了名的病态矩阵，其条件数随 $N$ 指数增长。而预处理后的矩阵 $A=LVC$ 是一个正交矩阵，具有最优的条件数 $1$。", "answer": "$$\n\\boxed{1}\n$$", "id": "3372834"}]}