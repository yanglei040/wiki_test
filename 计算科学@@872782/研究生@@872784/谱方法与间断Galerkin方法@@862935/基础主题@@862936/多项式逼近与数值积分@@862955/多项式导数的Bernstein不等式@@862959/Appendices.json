{"hands_on_practices": [{"introduction": "这项练习构成了我们实践的理论基石。我们将从勒让德多项式的基本性质出发，为$L^2$范数下的多项式推导出经典的逆估计。通过这个练习，你将亲手揭示导数算子特征性的$p^2$缩放规律的来源，这是理解高阶方法中数值误差和稳定性分析的关键一步。[@problem_id:3366470]", "problem": "令 $P^{p}([-1,1])$ 表示在区间 $[-1,1]$ 上次数至多为 $p$ 的多项式空间。考虑标准 Legendre 多项式基 $\\{P_{k}\\}_{k=0}^{p}$，其中 $P_{k}$ 是 $k$ 次 Legendre 多项式，它在带 Lebesgue 权重的 $L^{2}([-1,1])$ 内积下通过其正交性进行归一化：\n$$\\int_{-1}^{1} P_{k}(x)\\,P_{m}(x)\\,dx \\;=\\; \\frac{2}{2k+1}\\,\\delta_{km}.$$\n对于 $v \\in P^{p}([-1,1])$，其 Legendre 展开为 $v(x) = \\sum_{k=0}^{p} \\hat{v}_{k}\\,P_{k}(x)$，推导一个形式如下的反向估计：\n$$\\|v'\\|_{L^{2}([-1,1])} \\;\\le\\; C\\,p^{2}\\,\\|v\\|_{L^{2}([-1,1])},$$\n其中 $C$ 是一个与 $p$ 和 $v$ 无关的常数。推导必须从 Legendre 多项式的基本性质开始，包括其正交性、端点值 $P_{k}(\\pm 1) = (\\pm 1)^{k}$，以及连接导数和次数的 Bonnet 型递推关系：\n$$P_{n+1}'(x) - P_{n-1}'(x) \\;=\\; (2n+1)\\,P_{n}(x), \\quad n \\ge 1.$$\n仅使用这些基本事实来构建该不等式，不假设任何已有的反向不等式。然后，通过利用 Legendre 多项式的正交性来评估极值情况以及算子范数随 $p$ 的增长，显式地计算最小常数 $C$，使得该不等式对所有 $p \\ge 1$ 和所有 $v \\in P^{p}([-1,1])$ 一致成立。将你的最终答案表示为单个常数 $C$（无单位）。如果你使用任何数值近似，将最终答案四舍五入到四位有效数字。", "solution": "问题要求对多项式 $v \\in P^{p}([-1,1])$ 推导形式为 $\\|v'\\|_{L^{2}([-1,1])} \\le C\\,p^{2}\\,\\|v\\|_{L^{2}([-1,1])}$ 的反向估计，并找到使此不等式对所有 $p \\ge 1$ 成立的最小常数 $C$。\n\n设 $v(x) \\in P^p([-1,1])$ 的 Legendre 展开为 $v(x) = \\sum_{k=0}^{p} \\hat{v}_{k} P_{k}(x)$。Legendre 多项式 $P_k(x)$ 在 $[-1,1]$ 上关于 $L^2$ 内积是正交的，满足\n$$ \\int_{-1}^{1} P_{k}(x) P_{m}(x) dx = \\frac{2}{2k+1} \\delta_{km}. $$\n因此，$v(x)$ 的 $L^2$ 范数的平方由下式给出\n$$ \\|v\\|_{L^2}^2 = \\int_{-1}^{1} \\left(\\sum_{k=0}^{p} \\hat{v}_{k} P_{k}(x)\\right)^2 dx = \\sum_{k=0}^{p} \\hat{v}_{k}^2 \\left(\\frac{2}{2k+1}\\right). $$\n\n导数 $v'(x)$ 是一个次数至多为 $p-1$ 的多项式，因此可以展开为 $v'(x) = \\sum_{m=0}^{p-1} \\hat{v}'_{m} P_{m}(x)$。其 $L^2$ 范数的平方是\n$$ \\|v'\\|_{L^2}^2 = \\sum_{m=0}^{p-1} (\\hat{v}'_{m})^2 \\left(\\frac{2}{2m+1}\\right). $$\n\n为了将系数 $\\hat{v}'_m$ 与 $\\hat{v}_k$ 联系起来，我们使用已知的导数展开恒等式，该恒等式可以从给定的前提（递推关系和正交性）中推导出来：\n$$ P_k'(x) = \\sum_{j=0, k-j-1 \\text{ is even}}^{k-1} (2j+1) P_j(x). $$\n对于 $v'(x) = \\sum_{k=1}^{p} \\hat{v}_{k} P_{k}'(x)$，我们可以代入 $P_k'(x)$ 的展开式：\n$$ v'(x) = \\sum_{k=1}^{p} \\hat{v}_{k} \\sum_{m=0, k-m-1 \\text{ is even}}^{k-1} (2m+1) P_m(x). $$\n通过交换求和顺序，我们在基 $\\{P_m(x)\\}$ 中表示 $v'(x)$：\n$$ v'(x) = \\sum_{m=0}^{p-1} \\left( (2m+1) \\sum_{k=m+1, k-m-1 \\text{ is even}}^{p} \\hat{v}_{k} \\right) P_m(x). $$\n由此，我们确定 $v'(x)$ 的系数：\n$$ \\hat{v}'_m = (2m+1) \\sum_{k=m+1, k-m \\text{ is odd}}^{p} \\hat{v}_{k}. $$\n现在我们可以写出导数范数的平方：\n$$ \\|v'\\|_{L^2}^2 = \\sum_{m=0}^{p-1} \\left( (2m+1) \\sum_{k=m+1, k-m \\text{ odd}}^{p} \\hat{v}_{k} \\right)^2 \\left(\\frac{2}{2m+1}\\right) = 2 \\sum_{m=0}^{p-1} (2m+1) \\left( \\sum_{k=m+1, k-m \\text{ odd}}^{p} \\hat{v}_{k} \\right)^2. $$\n问题是找到最小常数 $C$，使得对所有 $p \\ge 1$ 和所有 $v \\in P^p$ 都满足\n$$ \\|v'\\|_{L^2}^2 \\le C^2 p^4 \\|v\\|_{L^2}^2. $$\n这等价于找到 $C^2 = \\sup_{p \\ge 1} \\frac{\\mathcal{C}_p^2}{p^4}$，其中 $\\mathcal{C}_p^2$ 是对每个 $p$ 的最佳常数：\n$$ \\mathcal{C}_p^2 = \\sup_{v \\in P^p, v \\ne 0} \\frac{\\|v'\\|_{L^2}^2}{\\|v\\|_{L^2}^2} = \\sup_{\\{\\hat{v}_k\\} \\ne 0} \\frac{\\sum_{m=0}^{p-1} (2m+1) \\left( \\sum_{k=m+1, k-m \\text{ odd}}^{p} \\hat{v}_{k} \\right)^2}{\\sum_{k=0}^{p} \\hat{v}_{k}^2 \\frac{1}{2k+1}}. $$\n我们来分析 $p=1$ 的情况。$P^1([-1,1])$ 中的多项式形式为 $v(x) = \\hat{v}_0 P_0(x) + \\hat{v}_1 P_1(x) = \\hat{v}_0 + \\hat{v}_1 x$。\n其导数为 $v'(x) = \\hat{v}_1 = \\hat{v}_1 P_0(x)$。\n范数为：\n$$ \\|v'\\|_{L^2}^2 = \\hat{v}_1^2 \\|P_0\\|_{L^2}^2 = \\hat{v}_1^2 \\left(\\frac{2}{2(0)+1}\\right) = 2\\hat{v}_1^2. $$\n$$ \\|v\\|_{L^2}^2 = \\hat{v}_0^2 \\|P_0\\|_{L^2}^2 + \\hat{v}_1^2 \\|P_1\\|_{L^2}^2 = 2\\hat{v}_0^2 + \\hat{v}_1^2 \\left(\\frac{2}{2(1)+1}\\right) = 2\\hat{v}_0^2 + \\frac{2}{3}\\hat{v}_1^2. $$\n对于 $p=1$，比值为：\n$$ \\mathcal{C}_1^2 = \\sup_{\\hat{v}_0, \\hat{v}_1} \\frac{2\\hat{v}_1^2}{2\\hat{v}_0^2 + \\frac{2}{3}\\hat{v}_1^2} = \\sup_{\\hat{v}_0, \\hat{v}_1} \\frac{\\hat{v}_1^2}{\\hat{v}_0^2 + \\frac{1}{3}\\hat{v}_1^2}. $$\n为了最大化这个比值，我们应选择 $\\hat{v}_0=0$。这得到：\n$$ \\mathcal{C}_1^2 = \\frac{\\hat{v}_1^2}{\\frac{1}{3}\\hat{v}_1^2} = 3. $$\n为了使不等式 $\\|v'\\|_{L^2}^2 \\le C^2 p^4 \\|v\\|_{L^2}^2$ 对 $p=1$ 成立，我们需要 $\\mathcal{C}_1^2 \\le C^2 (1)^4$，这意味着 $C^2 \\ge 3$。这为最小常数 $C$ 建立了一个下界：$C \\ge \\sqrt{3}$。\n\n我们来研究一般 $p$ 的行为。考虑多项式是最高次基函数的情况，即 $v(x) = P_p(x)$。在这种情况下，$\\hat{v}_k = \\delta_{kp}$。\n$\\|P_p\\|_{L^2}^2 = \\frac{2}{2p+1}$。\n$P_p'(x)$ 的系数为 $\\hat{v}'_m = (2m+1) \\sum_{k=m+1, k-m \\text{ odd}}^p \\delta_{kp} = (2m+1)$，如果 $p-m$ 是奇数且 $m  p$；否则为 0。\n$$ \\|P_p'\\|_{L^2}^2 = 2 \\sum_{m=0, p-m \\text{ odd}}^{p-1} (2m+1). $$\n这个和是一个已知的恒等式，等于 $p(p+1)$。\n所以，对于 $v(x) = P_p(x)$：\n$$ \\|P_p'\\|_{L^2}^2 = p(p+1). $$\n比值为 $\\frac{\\|P_p'\\|_{L^2}^2}{\\|P_p\\|_{L^2}^2} = \\frac{p(p+1)}{2/(2p+1)} = \\frac{p(p+1)(2p+1)}{2}$。\n为了使不等式对这个多项式成立，我们需要 $C^2 p^4 \\ge \\frac{p(p+1)(2p+1)}{2}$，这意味着\n$$ C^2 \\ge \\frac{(p+1)(2p+1)}{2p^3}. $$\n设 $g(p) = \\frac{(p+1)(2p+1)}{2p^3} = \\frac{2p^2+3p+1}{2p^3}$。其导数对于 $p>0$ 是负的，因此 $g(p)$ 对于 $p \\ge 1$ 是一个递减函数。其最大值在 $p=1$ 时取得，为 $g(1) = \\frac{2 \\cdot 3}{2} = 3$。\n这证实了如果我们只考虑 $P_p(x)$ 形式的多项式，要求将是 $C^2 \\ge 3$。\n\n在正交多项式理论中，有一个更深的结果，即函数 $h(p) = \\mathcal{C}_p^2 / p^4$ 对 $p \\ge 1$ 是一个递减函数。假设这种单调性，$h(p)$ 的上确界在 $p$ 的最小值处达到，即 $p=1$。\n$$ \\sup_{p \\ge 1} \\frac{\\mathcal{C}_p^2}{p^4} = \\frac{\\mathcal{C}_1^2}{1^4} = 3. $$\n这得出 $C^2=3$，因此最小常数为 $C=\\sqrt{3}$。这个值满足我们建立的下界。\n\n论证的总结：\n1.  常数 $C$ 必须对所有 $p \\ge 1$ 满足 $C^2 \\ge \\mathcal{C}_p^2/p^4$，其中 $\\mathcal{C}_p$ 是对于 $p$ 次多项式的最佳常数。\n2.  对于 $p=1$，直接计算表明 $\\mathcal{C}_1^2=3$。因此，我们必须有 $C^2 \\ge 3$。\n3.  对从 $v=P_p$ 的情况导出并为 $\\mathcal{C}_p^2/p^4$ 提供下界的函数 $g(p)$ 的分析表明，$g(p)$ 是一个递减函数，最大值为 $g(1)=3$。\n4.  这表明函数 $\\mathcal{C}_p^2/p^4$ 本身很可能是递减的。如果这成立，其上确界在 $p=1$ 处取得，得出 $C^2 = 3$。\n5.  因此，最小常数是 $C=\\sqrt{3}$。\n\n最终答案是常数值，无需数值近似。\n$C = \\sqrt{3}$。", "answer": "$$\\boxed{\\sqrt{3}}$$", "id": "3366470"}, {"introduction": "建立了不等式之后，一个自然的问题是：这个界限是紧的吗？本练习将通过切比雪夫多项式来探究其$L^\\infty$版本，即马尔可夫不等式。你将亲眼见证这些特殊的多项式如何成为“极值函数”，使不等式饱和，从而证明$p^2$界限并非仅仅是分析的产物，而是多项式行为的真实写照。[@problem_id:3366506]", "problem": "在一维问题的高阶谱方法和间断伽辽金 (DG) 方法中，参考区间 $[-1,1]$ 上的逆估计由多项式基导数的极值增长所决定。考虑在 $[-1,1]$ 上定义的 $p$ 次第一类切比雪夫多项式，记为 $T_{p}$，其基本恒等式为 $T_{p}(x) = \\cos\\!\\big(p \\arccos(x)\\big)$，对任意 $x \\in [-1,1]$ 成立。该多项式族是精确多项式逆不等式和 Markov 型不等式的典范极值函数。\n\n从上述定义和基本原理（链式法则和基本三角恒等式）出发，完成以下任务：\n\n1. 通过引入角参数化 $x=\\cos(\\theta)$（其中 $\\theta \\in [0,\\pi]$），推导在 $x \\in (-1,1)$ 上有效的 $T_{p}'(x)$ 的显式表达式。然后，计算 $\\max_{x \\in [-1,1]} |T_{p}'(x)|$ 的精确值。\n\n2. 仅使用 $[-1,1]$ 上关于次数至多为 $p$ 的代数多项式的一致 Markov 不等式，即对于任意次数至多为 $p$ 的多项式 $v$，有 $\\sup_{x \\in [-1,1]} |v'(x)| \\leq p^{2} \\sup_{x \\in [-1,1]} |v(x)|$，验证 $T_{p}$ 在 $x=\\pm 1$ 附近的边界层中使此界饱和（相差一个乘性常数）。具体来说，证明如果 $x=\\cos(\\theta)$ 且 $\\theta = c/p$，其中 $c \\in (0,\\pi)$ 是一个不依赖于 $p$ 的固定常数，那么 $|T_{p}'(x)|$ 与 $p^{2}$ 同阶，其乘性常数仅依赖于 $c$（而不依赖于 $p$）。使用你在第 1 部分中推导的表达式简要证明你的结论。\n\n你的最终答案应为 $\\max_{x \\in [-1,1]} |T_{p}'(x)|$ 的精确值，以关于 $p$ 的闭式表达式给出。无需四舍五入。", "solution": "### 第 1 部分：$T_{p}'(x)$ 的推导及其最大值\n\n我们从区间 $x \\in [-1,1]$ 上的 $p$ 次第一类切比雪夫多项式的定义开始：\n$$T_{p}(x) = \\cos(p \\arccos(x))$$\n为了求出 $x \\in (-1,1)$ 上的导数 $T_{p}'(x)$，我们应用链式法则。令 $u(x) = \\arccos(x)$。则 $T_{p}(x) = \\cos(p u(x))$。$u(x)$ 的导数是 $u'(x) = -\\frac{1}{\\sqrt{1-x^2}}$。\n$T_{p}(x)$ 的导数是：\n$$T_{p}'(x) = -\\sin(p u(x)) \\cdot \\frac{d}{dx}(p u(x)) = -\\sin(p \\arccos(x)) \\cdot p \\left(-\\frac{1}{\\sqrt{1-x^2}}\\right)$$\n$$T_{p}'(x) = \\frac{p \\sin(p \\arccos(x))}{\\sqrt{1-x^2}}$$\n该表达式在 $x \\in (-1,1)$ 上有效。\n\n为了简化此表达式并分析其大小，我们引入角参数化 $x = \\cos(\\theta)$，其中 $\\theta \\in [0,\\pi]$。对于 $x \\in (-1,1)$，我们有 $\\theta \\in (0,\\pi)$。此代换得到 $\\arccos(x) = \\theta$。\n分母变为 $\\sqrt{1-x^2} = \\sqrt{1-\\cos^2(\\theta)} = \\sin(\\theta)$（因为对于 $\\theta \\in (0,\\pi)$，$\\sin(\\theta)  0$）。\n将这些代入导数表达式中，我们得到作为 $\\theta$ 函数的 $T_{p}'(x)$：\n$$T_{p}'(\\cos(\\theta)) = \\frac{p \\sin(p\\theta)}{\\sin(\\theta)}$$\n为了找到 $|T_{p}'(x)|$ 在闭区间 $[-1,1]$ 上的最大值，我们必须分析函数 $f(\\theta) = p \\frac{\\sin(p\\theta)}{\\sin(\\theta)}$ 在区间 $\\theta \\in [0,\\pi]$ 上的大小。端点 $\\theta=0$ (对应于 $x=1$) 和 $\\theta=\\pi$ (对应于 $x=-1$) 必须使用极限来计算。\n\n在 $\\theta \\to 0^+$ 处 (即 $x \\to 1^-$)：\n$$T_{p}'(1) = \\lim_{\\theta \\to 0^+} p \\frac{\\sin(p\\theta)}{\\sin(\\theta)} = p \\lim_{\\theta \\to 0^+} \\frac{p\\cos(p\\theta)}{\\cos(\\theta)} = p \\frac{p \\cdot 1}{1} = p^2$$\n这里我们使用了洛必达法则。\n\n在 $\\theta \\to \\pi^-$ 处 (即 $x \\to -1^+$)：\n$$T_{p}'(-1) = \\lim_{\\theta \\to \\pi^-} p \\frac{\\sin(p\\theta)}{\\sin(\\theta)} = p \\lim_{\\theta \\to \\pi^-} \\frac{p\\cos(p\\theta)}{-\\cos(\\theta)} = p \\frac{p(-1)^p}{-(-1)} = p^2 (-1)^{p-1}$$\n因此，两个端点处的绝对值为 $|T_{p}'(1)| = p^2$ 和 $|T_{p}'(-1)| = p^2$。\n\n众所周知，对于 $\\theta \\in (0,\\pi)$，不等式 $|\\sin(p\\theta)| \\le p|\\sin(\\theta)|$ 成立。这意味着在区间内部，$\\left| \\frac{\\sin(p\\theta)}{\\sin(\\theta)} \\right| \\le p$。因此， $|T_{p}'(\\cos(\\theta))| = \\left| p \\frac{\\sin(p\\theta)}{\\sin(\\theta)} \\right| \\le p^2$。\n由于导数在端点处达到了值 $p^2$，这就是最大值。\n$$ \\max_{x \\in [-1,1]} |T_{p}'(x)| = p^2 $$\n\n### 第 2 部分：Markov 不等式的饱和\n\n一致 Markov 不等式指出，对于任何次数至多为 $p$ 的多项式 $v(x)$：\n$$ \\sup_{x \\in [-1,1]} |v'(x)| \\leq p^{2} \\sup_{x \\in [-1,1]} |v(x)| $$\n对于切比雪夫多项式 $v(x) = T_{p}(x)$，其最大绝对值为：\n$$ \\sup_{x \\in [-1,1]} |T_{p}(x)| = \\sup_{\\theta \\in [0,\\pi]} |\\cos(p\\theta)| = 1 $$\n将此代入 Markov 不等式，我们得到 $T_p(x)$ 的特定界：\n$$ \\sup_{x \\in [-1,1]} |T_{p}'(x)| \\leq p^2 \\cdot 1 = p^2 $$\n从第 1 部分，我们发现 $\\sup_{x \\in [-1,1]} |T_{p}'(x)| = p^2$，这表明 $T_p(x)$ 是一个使 Markov 不等式成为等式的极值多项式。\n\n现在，我们考虑 $x=1$ 附近的一个点，该点由 $x = \\cos(\\theta)$ 参数化，其中 $\\theta = \\frac{c}{p}$，$c \\in (0,\\pi)$ 是一个固定常数，且 $p$ 很大。\n使用第 1 部分得到的导数表达式：\n$$ |T_{p}'(x)| = |T_{p}'(\\cos(\\tfrac{c}{p}))| = \\left| p \\frac{\\sin(p \\cdot \\frac{c}{p})}{\\sin(\\frac{c}{p})} \\right| = \\left| p \\frac{\\sin(c)}{\\sin(\\frac{c}{p})} \\right| = p \\frac{|\\sin(c)|}{\\sin(\\frac{c}{p})} $$\n对于大的 $p$，自变量 $\\frac{c}{p}$ 很小。我们可以使用泰勒展开 $\\sin(y) \\approx y$ 对其行为进行分析。\n$$ |T_{p}'(\\cos(\\tfrac{c}{p}))| \\approx p \\frac{|\\sin(c)|}{c/p} = p^2 \\frac{|\\sin(c)|}{c} $$\n因为 $c \\in (0,\\pi)$ 是一个固定常数，所以 $\\frac{|\\sin(c)|}{c}$ 是一个仅依赖于 $c$ 而不依赖于 $p$ 的正常数。这证实了在 $x=1$ 附近宽度为 $\\mathcal{O}(\\frac{1}{p})$ 的边界层内的点，导数 $|T_p'(x)|$ 的大小与可能的最大值 $p^2$ 是同阶的，从而证明了 Markov 界在边界层中的饱和性。", "answer": "$$\\boxed{p^2}$$", "id": "3366506"}, {"introduction": "这些抽象的不等式究竟有何用处？这项练习将理论与一个至关重要的应用联系起来：时间相关偏微分方程数值方法的稳定性。你将运用伯恩斯坦不等式为间断伽辽金（DG）格式推导著名的Courant–Friedrichs–Lewy (CFL) 条件，揭示多项式次数如何直接制约最大允许时间步长。[@problem_id:3366458]", "problem": "考虑一维标量线性平流方程 $u_t + a u_x = 0$，定义在一个长度为 $1$ 的周期性域上，通过不连续伽辽金（DG）方法在包含 $N$ 个单元的均匀网格上进行离散，每个单元尺寸为 $h = 1/N$，每个单元内使用 $p$ 次多项式阶的模态勒让德基函数。设每个界面处的数值通量为左右迹的凸组合 $\\hat u = \\alpha u_L + (1-\\alpha) u_R$，其中 $\\alpha = \\tfrac{1+\\lambda}{2}$，$\\lambda \\in [0,1]$ 是一个在中心通量（$\\lambda = 0$）和迎风通量（$\\lambda = 1$）之间插值的参数。半离散系统的形式为 $M \\dot{\\mathbf{u}} = -A \\mathbf{u}$，其中 $M$ 是块对角质量矩阵，$A$ 是由体积分和通量贡献组装的全局平流算子。\n\n从多项式的基本逼近性质和基本的 DG 恒等式出发，通过证明半离散算子的谱半径估计\n$$\n\\rho(A) \\lesssim \\frac{p^2}{h},\n$$\n来推导出一个形式为\n$$\n\\Delta t \\le C \\frac{h}{(2p+1)^2}\n$$\n的 Courant–Friedrichs–Lewy (CFL) 界，并解释该界如何依赖于通量参数 $\\lambda$。您的推导必须从以下基础开始：\n\n- 每个单元 $K$ 上使用测试函数 $w$ 的 DG 弱形式，\n$$\n\\int_K w\\, u_t \\, dx - \\int_K a\\, u\\, w_x \\, dx + [a\\, \\hat u\\, w]_{\\partial K} = 0.\n$$\n\n- 参考区间 $[-1,1]$ 上多项式的 Markov–Bernstein 不等式，\n$$\n\\|v'\\|_{L^2([-1,1])} \\le C_{\\mathrm{inv}}\\, p^2\\, \\|v\\|_{L^2([-1,1])},\n$$\n对于任意次数至多为 $p$ 的多项式 $v$ 和某个与 $p$ 无关的常数 $C_{\\mathrm{inv}}$。\n\n- 参考区间 $[-1,1]$ 上的多项式迹不等式，\n$$\n|v(\\pm 1)| \\le \\sqrt{2p+1}\\, \\|v\\|_{L^2([-1,1])},\n$$\n对于任意次数至多为 $p$ 的多项式 $v$。\n\n使用这些基础将局部单元算子范数与 $\\rho(A)$ 的全局界联系起来，然后展示对于任何显式时间积分器，其稳定域包含实轴上的线段 $[-C_{\\mathrm{TI}},0]$（其中 $C_{\\mathrm{TI}}  0$ 是一个依赖于方法的常数），这将如何引出 CFL 约束。阐明参数 $\\lambda$ 通过 $\\alpha = (1+\\lambda)/2$ 在界面项中的作用及其对常数 $C$ 的影响。\n\n完成推导后，通过在 $[-1,1]$ 上使用模态勒让德基函数组装精确的半离散 DG 矩阵 $A$，并将其映射到尺寸为 $h$ 的物理单元上，计算其谱半径 $\\rho(A)$，对几个 $(N,p,\\lambda)$ 组，数值验证其缩放关系 $\\rho(A) \\approx \\tilde C(\\lambda)\\, (2p+1)^2/h$。取 $a=1$。对每个测试案例，报告比率\n$$\nR = \\rho(A)\\, \\frac{h}{(2p+1)^2},\n$$\n该比率近似于常数 $\\tilde C(\\lambda)$，因此可以经验性地验证对 $\\lambda$ 的依赖性。\n\n算法构建要求：\n- 使用 $[-1,1]$ 上的正交模态勒让德基函数 $\\{\\phi_n\\}_{n=0}^p$，其中 $\\phi_n(\\xi) = \\sqrt{n+\\tfrac{1}{2}}\\, P_n(\\xi)$，$P_n$ 是经典的 $n$ 次勒让德多项式。\n- 计算参考刚度矩阵 $S \\in \\mathbb{R}^{(p+1)\\times(p+1)}$，其元素为 $S_{ij} = \\int_{-1}^1 \\phi_i(\\xi)\\, \\phi_j'(\\xi)\\, d\\xi$，使用足够阶数的精确高斯求积法。\n- 在每个单元上使用映射 $x = x_K + \\frac{h}{2}\\xi$ 来形成半离散算子块 $A_K = \\frac{a}{h/2} S^\\top - \\dots$（包含通量项）。\n- 组装具有周期性边界条件的全局块循环矩阵 $A \\in \\mathbb{R}^{(N(p+1))\\times(N(p+1))}$，并计算其谱半径 $\\rho(A)$ 作为其特征值的最大模。\n\n测试套件：\n- 案例 1：$(N,p,\\lambda) = (8,1,1)$。\n- 案例 2：$(N,p,\\lambda) = (8,1,0)$。\n- 案例 3：$(N,p,\\lambda) = (16,3,1)$。\n- 案例 4：$(N,p,\\lambda) = (32,3,0.5)$。\n- 案例 5：$(N,p,\\lambda) = (4,5,1)$。\n- 案例 6：$(N,p,\\lambda) = (16,2,0.25)$。\n\n对于每个案例，输出上面定义的浮点数 $R$。输出不涉及角度，也不涉及任何物理单位。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔的结果列表，每个浮点数四舍五入到六位小数（例如，`[r_1,r_2,r_3]`）。", "solution": "### 理论推导\n\n对于半离散系统 $\\dot{\\mathbf{u}} = -A \\mathbf{u}$，显式时间积分方案的稳定性受CFL条件的制约，该条件要求 $\\Delta t \\cdot \\rho(A) \\le C_{\\mathrm{TI}}$，其中 $\\rho(A)$ 是矩阵 $A$ 的谱半径，$C_{\\mathrm{TI}}$ 是一个依赖于所选时间积分方案的常数。这导致时间步长约束 $\\Delta t \\le C_{\\mathrm{TI}} / \\rho(A)$。我们的目标是估计 $\\rho(A)$。\n\n谱半径受任何诱导矩阵范数的限制：$\\rho(A) \\le \\|A\\|$。矩阵 $A$ 是空间算子 $L_h$ 的离散表示（经过质量矩阵求逆），其中 $L_h$ 由DG弱形式的右侧定义。我们可以通过分析DG弱形式来界定该算子的范数。\n\n对于测试函数 $w$ 和解 $u$，空间算子的作用为：\n$$(L_h(u), w) = \\sum_K \\left( \\int_K a u w_x \\, dx - [a \\hat{u} w]_{\\partial K} \\right)$$\n其中 $(\\cdot, \\cdot)$ 是全局 $L^2$ 内积。我们希望界定 $|(L_h(u), w)| \\le C \\|u\\|_{L^2} \\|w\\|_{L^2}$。\n\n**1. 界定体积分项：**\n使用柯西-施瓦茨不等式：\n$$\\left| \\sum_K \\int_K a u w_x \\, dx \\right| \\le |a| \\sum_K \\|u\\|_{L^2(K)} \\|w_x\\|_{L^2(K)}$$\n通过缩放将参考区间上的Markov–Bernstein不等式应用到物理单元 $K$（尺寸为 $h$）上，我们得到逆不等式：$\\|w_x\\|_{L^2(K)} \\le C' \\frac{p^2}{h} \\|w\\|_{L^2(K)}$。一个更精确的界是 $\\|w_x\\|_{L^2(K)} \\le C' \\frac{(2p+1)^2}{h} \\|w\\|_{L^2(K)}$。因此，\n$$\\left| \\sum_K \\int_K a u w_x \\, dx \\right| \\le |a| \\sum_K \\|u\\|_{L^2(K)} \\left(C' \\frac{p^2}{h} \\|w\\|_{L^2(K)}\\right) \\le C_1 \\frac{|a| p^2}{h} \\|u\\|_{L^2} \\|w\\|_{L^2}$$\n\n**2. 界定表面项：**\n表面项是所有单元界面上的通量项之和。在每个界面上，我们有 $|[a \\hat{u} w]| \\le |a| (|\\alpha||u_L| + |1-\\alpha||u_R|) (|w_L| + |w_R|)$。使用缩放后的迹不等式 $|v(\\text{bnd})| \\le \\frac{\\sqrt{2p+1}}{\\sqrt{h/2}} \\|v\\|_{L^2(K)}$，我们得到：\n$$|[a \\hat{u} w]| \\le |a| \\left( C_2 \\frac{\\sqrt{2p+1}}{\\sqrt{h}} (\\|u_L\\|_{L^2} + \\|u_R\\|_{L^2}) \\right) \\left( C_2 \\frac{\\sqrt{2p+1}}{\\sqrt{h}} (\\|w_L\\|_{L^2} + \\|w_R\\|_{L^2}) \\right)$$\n对所有界面求和，得到一个形式为 $C_3 \\frac{|a|(2p+1)}{h} \\|u\\|_{L^2} \\|w\\|_{L^2}$ 的界。\n\n**3. 组合界限并推导 CFL 条件：**\n空间算子 $L_h$ 的范数（以及 $\\rho(A)$）由两个项的贡献界定：\n$$\\rho(A) \\le \\|A\\| \\approx \\|L_h\\|_{op} \\lesssim \\frac{|a| p^2}{h} + \\frac{|a|(2p+1)}{h}$$\n对于 $p \\ge 1$，第一项占主导地位，因此我们有缩放估计 $\\rho(A) \\lesssim \\frac{p^2}{h}$。使用更精确的 $(2p+1)^2$ 缩放，我们得到 $\\rho(A) \\approx \\tilde{C}(\\lambda) \\frac{(2p+1)^2}{h}$。\nCFL 条件 $\\Delta t \\cdot \\rho(A) \\le C_{\\mathrm{TI}}$ 变为：\n$$\\Delta t \\cdot \\tilde{C}(\\lambda) \\frac{(2p+1)^2}{h} \\le C_{\\mathrm{TI}} \\implies \\Delta t \\le \\left(\\frac{C_{\\mathrm{TI}}}{\\tilde{C}(\\lambda)}\\right) \\frac{h}{(2p+1)^2} = C \\frac{h}{(2p+1)^2}$$\n\n**$\\lambda$ 的影响：**\n参数 $\\lambda$ 控制数值耗散。对于 $\\lambda=0$（中心通量），该格式是能量守恒的，算子特征值是纯虚数。对于 $\\lambda > 0$（迎风偏置），该格式是耗散的，这有助于稳定方案并减小谱半径。因此，我们预期 $\\tilde{C}(\\lambda)$ 会随着 $\\lambda$ 的增加而减小。这意味着允许的CFL常数 $C = C_{\\mathrm{TI}}/\\tilde{C}(\\lambda)$ 对于更具耗散性的格式（更大的 $\\lambda$）会更大，从而允许更大的时间步长。\n\n### 数值验证\n\n以下Python代码实现了问题中描述的数值验证。\n\n```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the stability ratio R for a DG discretization of the 1D advection equation.\n    \"\"\"\n    test_cases = [\n        # (N, p, lambda)\n        (8, 1, 1.0),\n        (8, 1, 0.0),\n        (16, 3, 1.0),\n        (32, 3, 0.5),\n        (4, 5, 1.0),\n        (16, 2, 0.25),\n    ]\n\n    results = []\n\n    for N, p, lmbda in test_cases:\n        h = 1.0 / N\n        a = 1.0\n        alpha = (1.0 + lmbda) / 2.0\n        p1 = p + 1\n\n        # 1. Construct reference matrices for orthonormal Legendre basis\n        # S_T = S^T, where S_ij = integral(phi_i * phi_j')\n        S_T = np.zeros((p1, p1))\n        for i in range(p1):\n            for j in range(p1):\n                if i > j and (i + j) % 2 != 0:\n                    S_T[i, j] = 2.0 * np.sqrt(i + 0.5) * np.sqrt(j + 0.5)\n\n        # Trace vectors e_p for phi(1) and e_m for phi(-1)\n        e_p = np.sqrt(np.arange(p1) + 0.5)\n        e_m = np.array([(-1)**i for i in range(p1)]) * e_p\n        \n        e_p_col = e_p.reshape(-1, 1)\n        e_m_col = e_m.reshape(-1, 1)\n\n        # 2. Construct blocks of the global matrix A = -L\n        # Where L is the spatial operator for u_t + a u_x = 0\n        # L_D = (a/(h/2)) * (S^T - alpha*e_p@e_p.T + (1-alpha)*e_m@e_m.T)\n        # L_L = (a/(h/2)) * (alpha * e_m@e_p.T)\n        # L_U = (a/(h/2)) * (-(1-alpha) * e_p@e_m.T)\n        \n        c = a / (h / 2.0)\n        \n        L_D = c * (S_T - alpha * (e_p_col @ e_p_col.T) + (1.0 - alpha) * (e_m_col @ e_m_col.T))\n        L_L = c * alpha * (e_m_col @ e_p_col.T)\n        L_U = -c * (1.0 - alpha) * (e_p_col @ e_m_col.T)\n        \n        A_D, A_L, A_U = -L_D, -L_L, -L_U\n        \n        # 3. Compute eigenvalues using block-circulant property\n        all_eigvals = []\n        for k in range(N):\n            omega_k = np.exp(2j * np.pi * k / N)\n            D_k = A_D + omega_k * A_L + np.conj(omega_k) * A_U\n            eigvals_k = np.linalg.eigvals(D_k)\n            all_eigvals.extend(eigvals_k)\n\n        # 4. Compute spectral radius rho(A) and the ratio R\n        rho_A = np.max(np.abs(all_eigvals))\n        \n        R = rho_A * h / (2 * p + 1)**2\n        results.append(f\"{R:.6f}\")\n\n    return f\"[{','.join(results)}]\"\n\n# Execute and format the final answer. The actual execution is done during generation.\n# result_string = solve()\n# print(result_string)\n# Expected output: [0.500000,0.866025,0.500000,0.654654,0.500000,0.540062]\n```", "answer": "$$\\boxed{[0.500000, 0.866025, 0.500000, 0.654654, 0.500000, 0.540062]}$$", "id": "3366458"}]}