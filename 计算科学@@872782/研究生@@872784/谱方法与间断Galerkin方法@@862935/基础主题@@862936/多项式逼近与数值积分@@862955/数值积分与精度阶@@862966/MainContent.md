## 引言
在现代科学与工程计算中，谱方法与间断Galerkin（DG）方法等高阶数值技术扮演着至关重要的角色。这些方法成功的基石在于能够精确、高效地处理[微分方程](@entry_id:264184)弱形式中出现的各类积分。然而，对于复杂的[非线性](@entry_id:637147)项或变系数问题，解析积分往往遥不可及，我们必须依赖**[数值求积](@entry_id:136578)**（numerical quadrature）。

本文旨在深入探讨数值求积的核心——**[精度阶](@entry_id:145189)**（degree of precision）的概念，并揭示其选择如何超越简单的数值近似，从根本上决定了[高阶格式](@entry_id:150564)的稳定性、守恒性乃至物理保真度。我们将解答一个关键问题：为何一个看似微小的[积分误差](@entry_id:171351)，有时会导致整个[数值模拟](@entry_id:137087)的崩溃？

通过本文的学习，读者将首先掌握构建和分析求积法则的基本**原理与机制**，理解从基础的[辛普森法则](@entry_id:142987)到最优的高斯求积法则的内在逻辑。随后，我们将深入**应用与跨学科联系**，探讨求积精度如何在DG方法的稳定性、[非线性](@entry_id:637147)问题的处理以及[曲线网格](@entry_id:748122)计算中发挥关键作用，并揭示其与信号处理、机器学习等前沿领域的深刻联系。最后，通过一系列**动手实践**，读者将有机会亲手构建和测试这些求积法则，将理论知识转化为解决实际问题的能力。

## 原理与机制

在谱方法与间断 Galerkin (DG) 方法的数学框架中，对单元上的积分进行准确高效的计算是一项核心任务。虽然解析积分在少数情况下可行，但对于一般的被积函数，特别是那些涉及[非线性](@entry_id:637147)项或变系数的函数，我们必须依赖于数值积分，也称为**[数值求积](@entry_id:136578)** (numerical quadrature)。本章旨在阐述数值求积的**基础原理与机制**，重点关注其**精度** (precision) 的概念，以及这一概念如何深刻影响[高阶方法](@entry_id:165413)的稳定性和准确性。

### 数值求积的基本概念

一个一维区间 $[a,b]$ 上的数值求积法则通常具有以下形式：
$$
\int_{a}^{b} f(x) \,dx \approx \mathcal{Q}[f] = \sum_{i=1}^{n} w_{i} f(x_{i})
$$
该法则通过在特定点集上的函数值的加权和来近似积分。这个公式包含两个关键要素：
1.  **节点 (Nodes)**：$\{x_{i}\}_{i=1}^{n}$ 是区间 $[a,b]$ 内预先选定的一组 $n$ 个不同的点。
2.  **权重 (Weights)**：$\{w_{i}\}_{i=1}^{n}$ 是与每个节点相关联的 $n$ 个系数。

求积法则的质量由其**精度阶 (degree of precision)** 来衡量。一个求积法则的精度阶被定义为整数 $m$，使得该法则能够精确计算所有次数不超过 $m$ 的多项式的积分，但对于某个次数为 $m+1$ 的多项式则不精确。换言之，对于任意次数 $\deg(p) \le m$ 的多项式 $p(x)$，下式恒成立：
$$
\sum_{i=1}^{n} w_{i} p(x_{i}) = \int_{a}^{b} p(x) \,dx
$$

### [求积法则](@entry_id:753909)的构建：[待定系数法](@entry_id:166225)

构建求积法则最直接的方法是**[待定系数法](@entry_id:166225) (method of undetermined coefficients)**。该方法首先固定 $n$ 个节点 $\{x_i\}$，然后通过求解一个[线性方程组](@entry_id:148943)来确定相应的 $n$ 个权重 $\{w_i\}$。

为了使法则的[精度阶](@entry_id:145189)至少为 $m$，我们要求它对[多项式空间](@entry_id:144410) $\mathbb{P}_m$ 的一组[基函数](@entry_id:170178)是精确的。最自然的基是单项式基 $\{1, x, x^2, \dots, x^m\}$。对每个[基函数](@entry_id:170178) $x^k$（其中 $k=0, 1, \dots, m$）强制执行精确积分条件，我们得到一系列线性方程：
$$
\mathcal{Q}[x^k] = \sum_{i=1}^{n} w_{i} x_{i}^{k} = \int_{a}^{b} x^{k} \,dx \quad \text{对于 } k=0, 1, \dots, m
$$
这构成了一个关于 $n$ 个未知权重 $w_1, \dots, w_n$ 的 $m+1$ 个线性方程组 [@problem_id:3405893]。该[方程组](@entry_id:193238)可以写成矩阵形式：
$$
\begin{pmatrix}
x_1^0  & x_2^0  & \dots  & x_n^0 \\
x_1^1  & x_2^1  & \dots  & x_n^1 \\
\vdots & \vdots & \ddots & \vdots \\
x_1^m  & x_2^m  & \dots  & x_n^m
\end{pmatrix}
\begin{pmatrix}
w_1 \\
w_2 \\
\vdots \\
w_n
\end{pmatrix}
=
\begin{pmatrix}
\int_a^b x^0 \,dx \\
\int_a^b x^1 \,dx \\
\vdots \\
\int_a^b x^m \,dx
\end{pmatrix}
$$
[方程组](@entry_id:193238)左侧的系数矩阵是一个 $(m+1) \times n$ 的**[范德蒙矩阵](@entry_id:147747) (Vandermonde matrix)**。为了得到一个唯一确定的解，方程的个数必须等于未知数的个数，即 $m+1=n$。在这种情况下，[系数矩阵](@entry_id:151473)是一个 $n \times n$ 的方阵。[范德蒙矩阵](@entry_id:147747)的一个基本性质是，当且仅当所有节点 $x_i$ 互不相同时，其[行列式](@entry_id:142978)非零。因此，只要我们选择 $n$ 个不同的节点，就可以通过强制法则对所有次数不超过 $n-1$ 的多项式精确，来唯一地确定 $n$ 个权重。此时，[精度阶](@entry_id:145189)至少为 $n-1$。

**示例：构建三点辛普森法则**

让我们在[参考单元](@entry_id:168425) $[-1,1]$ 上，为给定的节点 $x_1 = -1$, $x_2 = 0$, $x_3 = 1$ 构建一个求积法则。这里有 $n=3$ 个节点，因此我们可以期望达到至少 $m = n-1 = 2$ 的精度阶。我们通过求解关于权重 $w_1, w_2, w_3$ 的线性方程组来实现这一点 [@problem_id:3405893]：
- **对于 $k=0$ ($p(x)=1$)**:
  $w_1(1) + w_2(1) + w_3(1) = \int_{-1}^{1} 1 \,dx = 2$
- **对于 $k=1$ ($p(x)=x$)**:
  $w_1(-1) + w_2(0) + w_3(1) = \int_{-1}^{1} x \,dx = 0 \implies -w_1 + w_3 = 0$
- **对于 $k=2$ ($p(x)=x^2$)**:
  $w_1(-1)^2 + w_2(0)^2 + w_3(1)^2 = \int_{-1}^{1} x^2 \,dx = \frac{2}{3} \implies w_1 + w_3 = \frac{2}{3}$

解这个[方程组](@entry_id:193238)，我们得到 $w_1 = w_3 = \frac{1}{3}$，代入第一个方程得到 $w_2 = 2 - \frac{2}{3} = \frac{4}{3}$。因此，该求积法则是：
$$
\mathcal{Q}[f] = \frac{1}{3} f(-1) + \frac{4}{3} f(0) + \frac{1}{3} f(1)
$$
这就是著名的**[辛普森法则](@entry_id:142987) (Simpson's rule)**。

### 求积法则的分析：精度阶与误差

#### [精度阶](@entry_id:145189)的确定

一旦一个[求积法则](@entry_id:753909)被构建或给定，我们可以通过系统性地测试它对更高次幂单项式的积分能力来确定其确切的精度阶。

以上述[辛普森法则](@entry_id:142987)为例，我们已经通过构造保证了它对次数为 $0, 1, 2$ 的多项式是精确的，即其[精度阶](@entry_id:145189)至少为 $2$。现在我们测试更高次的单项式 [@problem_id:3405830]：
- **对于 $k=3$ ($p(x)=x^3$)**:
  - 精确积分: $\int_{-1}^{1} x^3 \,dx = 0$
  - 求积近似: $\frac{1}{3}(-1)^3 + \frac{4}{3}(0)^3 + \frac{1}{3}(1)^3 = -\frac{1}{3} + \frac{1}{3} = 0$
  两者相等，所以该法则对 $x^3$ 也是精确的。

- **对于 $k=4$ ($p(x)=x^4$)**:
  - 精确积分: $\int_{-1}^{1} x^4 \,dx = \frac{2}{5}$
  - 求积近似: $\frac{1}{3}(-1)^4 + \frac{4}{3}(0)^4 + \frac{1}{3}(1)^4 = \frac{1}{3} + \frac{1}{3} = \frac{2}{3}$
  由于 $\frac{2}{5} \neq \frac{2}{3}$，该法则对 $x^4$ 不精确。

因此，辛普森法则能够精确积分的最高次多项式是 $3$ 次。其[精度阶](@entry_id:145189) $m=3$。对于一个具有 $n$ 个节点的[求积法则](@entry_id:753909)，我们期望的精度阶是 $n-1$。然而，[辛普森法则](@entry_id:142987)（$n=3$）的[精度阶](@entry_id:145189)是 $3$，比预期的 $2$ 要高。这种“附赠”的精度提升是对称[求积法则](@entry_id:753909)的一个常见特性，当积分区间和节点[分布](@entry_id:182848)都关于[原点对称](@entry_id:172995)时，该法则对所有[奇函数](@entry_id:173259)都能精确积分为零。

#### 误差表示：[皮亚诺核定理](@entry_id:753303)

精度阶告诉我们[求积法则](@entry_id:753909)是精确的“范围”，但当被积函数不在此范围内时，误差是多少？**[皮亚诺核定理](@entry_id:753303) (Peano Kernel Theorem)** 为此提供了一个优美的解析表达式。

定义**误差泛函 (error functional)** $L(f) = I(f) - \mathcal{Q}[f] = \int_a^b f(x)dx - \sum_i w_i f(x_i)$。[皮亚诺核定理](@entry_id:753303)指出，如果一个求积法则的精度阶为 $m-1$（即 $L$ 能够零化所有次数不超过 $m-1$ 的多项式），那么对于任何 $m$ 次连续可微的函数 $f \in C^m([a,b])$，其误差可以表示为：
$$
L(f) = \int_{a}^{b} K(t) f^{(m)}(t) \,dt
$$
这里的 $K(t)$ 被称为**[皮亚诺核](@entry_id:635826) (Peano kernel)**，它完全由[求积法则](@entry_id:753909)自身决定，而与被积函数 $f$ 无关。核的表达式为：
$$
K(t) = \frac{1}{(m-1)!} L_x \left[ (x-t)_+^{m-1} \right]
$$
其中 $(x-t)_+^{k}$ 是截断[幂函数](@entry_id:166538)，定义为当 $x>t$ 时为 $(x-t)^k$，当 $x \le t$ 时为 $0$。下标 $x$ 表示泛函 $L$ 作用于变量为 $x$ 的函数上。

例如，对于在 $[-1,1]$ 上的**[梯形法则](@entry_id:145375)** $\mathcal{Q}(f) = f(-1) + f(1)$，其精度阶为 $m-1=1$，所以 $m=2$。其[皮亚诺核](@entry_id:635826)可以计算得出 [@problem_id:3405863]：
$$
K_{\mathrm{T}}(t) = \frac{1}{2}(t^2-1)
$$
对于[精度阶](@entry_id:145189)为 $m-1=3$ 的[辛普森法则](@entry_id:142987)，所以 $m=4$。其[皮亚诺核](@entry_id:635826)更为复杂，但同样可以推导出来 [@problem_id:3405863]：
$$
K_{\mathrm{S}}(t) = -\frac{1}{72}(1-|t|)^3(1+3|t|)
$$
[皮亚诺核定理](@entry_id:753303)的重要性在于它将求积[误差分解](@entry_id:636944)为两个部分：完全由求积法则决定的核 $K(t)$ 和完全由被积函数决定的高阶导数 $f^{(m)}(t)$。如果核 $K(t)$ 在积分区间内不变号，我们就可以使用[积分中值定理](@entry_id:159120)得到一个更简洁的误差表达式，这在经典数值分析中非常有用。

### 最优求积：[高斯求积](@entry_id:146011)

[待定系数法](@entry_id:166225)要求我们预先指定节点的位置。一个更深刻的问题是：我们能否通过同时优化节点和权重的位置来最大化[精度阶](@entry_id:145189)？

在一个 $n$ 点[求积法则](@entry_id:753909)中，我们有 $n$ 个节点和 $n$ 个权重，共 $2n$ 个自由度。这启发我们或许可以满足 $2n$ 个约束条件，即精确积分次数从 $0$ 到 $2n-1$ 的所有单项式。这意味着可能达到的最高[精度阶](@entry_id:145189)是 $2n-1$。这一目标确实可以实现，其关键在于与**[正交多项式](@entry_id:146918) (orthogonal polynomials)** 的深刻联系。

#### 高斯求积的基本定理

**高斯求积基本定理**指出：对于一个给定的权重函数 $w(x) > 0$，为了使 $n$ 点[求积法则](@entry_id:753909) $\sum_{i=1}^n \omega_i f(x_i) \approx \int_a^b f(x) w(x) dx$ 达到最高的[精度阶](@entry_id:145189) $2n-1$，节点 $\{x_i\}_{i=1}^n$ 必须是关于权重函数 $w(x)$ 的 $n$ 次[正交多项式](@entry_id:146918) $P_n(x)$ 的 $n$ 个根。

这个结论的证明既巧妙又深刻 [@problem_id:3405866]。其核心思想如下：
1.  选择节点 $\{x_i\}$ 作为 $n$ 次[正交多项式](@entry_id:146918) $P_n(x)$ 的根。[正交多项式](@entry_id:146918)的一个基本性质是 $P_n(x)$ 在积分区间 $(a,b)$ 内有 $n$ 个不同的实根。
2.  对于这些节点，我们可以唯一地确定权重 $\{\omega_i\}$，使得[求积法则](@entry_id:753909)对所有次数不超过 $n-1$ 的多项式都是精确的。
3.  现在考虑任意一个次数不超过 $2n-1$ 的多项式 $p(x)$。我们可以用 $P_n(x)$ 对其作[多项式除法](@entry_id:151800)，得到：
    $p(x) = s(x) P_n(x) + t(x)$
    其中商 $s(x)$ 和余数 $t(x)$ 的次数都不超过 $n-1$。
4.  计算 $p(x)$ 的精确积分：
    $$
    \int_a^b p(x)w(x)dx = \int_a^b s(x)P_n(x)w(x)dx + \int_a^b t(x)w(x)dx
    $$
    根据正交多项式的定义，$\int_a^b s(x)P_n(x)w(x)dx = \langle s, P_n \rangle_w = 0$，因为 $s(x)$ 的次数小于 $n$。因此，精确积分为 $\int_a^b t(x)w(x)dx$。
5.  计算 $p(x)$ 的求积近似：
    $$
    \mathcal{Q}[p] = \sum_{i=1}^n \omega_i p(x_i) = \sum_{i=1}^n \omega_i [s(x_i)P_n(x_i) + t(x_i)]
    $$
    因为节点 $x_i$ 是 $P_n(x)$ 的根，所以 $P_n(x_i) = 0$。因此，求积近似简化为 $\sum_{i=1}^n \omega_i t(x_i) = \mathcal{Q}[t]$。
6.  由于 $t(x)$ 的次数不超过 $n-1$，根据构造，$\mathcal{Q}[t] = \int_a^b t(x)w(x)dx$。
7.  结合以上步骤，我们得到 $\mathcal{Q}[p] = I[p]$。这证明了该法则对所有次数不超过 $2n-1$ 的多项式都精确。

此外，该法则是最优的，因为对于次数为 $2n$ 的多项式 $P_n(x)^2$，其精确积分 $\int_a^b P_n(x)^2 w(x)dx > 0$，而求积近似 $\mathcal{Q}[P_n^2] = \sum_i \omega_i P_n(x_i)^2 = 0$。因此，最高精度阶恰好是 $2n-1$。

#### 高斯求积族

在谱方法和 DG 方法的实践中，[参考单元](@entry_id:168425) $[-1,1]$ 上 $w(x)=1$ 的**勒让德 (Legendre)** 多项式相关的高斯求积法则最为常用。根据对节点是否包含端点的不同约束，产生了几个重要的高斯求积族 [@problem_id:3405891]：

- **高斯-勒让德 (Gauss-Legendre) 求积**：节点是 $P_n(x)$ 的 $n$ 个根，全部位于开区间 $(-1,1)$ 内。这是无约束情况下精度最高的法则，其[精度阶](@entry_id:145189)为 $2n-1$。

- **高斯-拉道 (Gauss-Radau) 求积**：一个端点（如 $x=-1$ 或 $x=1$）被预先指定为节点，其余 $n-1$ 个节点被优化选择。$n$ 点[高斯-拉道求积](@entry_id:749741)的[精度阶](@entry_id:145189)为 $2n-2$。

- **高斯-洛巴托 (Gauss-Lobatto) 求积**：两个端点 $x=-1$ 和 $x=1$ 都被预先指定为节点，其余 $n-2$ 个节点被优化选择。$n$ 点[高斯-洛巴托求积](@entry_id:749739)的[精度阶](@entry_id:145189)为 $2n-3$。

在实际应用中，特别是对于基于节点的[谱元法 (SEM)](@entry_id:164629) 或 DG 方法，将求积节点与[多项式插值](@entry_id:145762)节点重合通常会带来巨大的计算便利（例如，得到[对角质量矩阵](@entry_id:173002)）。[高斯-洛巴托求积](@entry_id:749739)因其节点包含单元端点，成为这类应用中的首选。然而，这种便利性是以牺牲[精度阶](@entry_id:145189)为代价的：对于相同数量的节点 $n$，包含端点会使精度阶相对于最优的[高斯-勒让德求积](@entry_id:138201)降低 $1$ 或 $2$。

### 实际构建与数值稳定性

理论上，我们可以用[待定系数法](@entry_id:166225)构建任何插值型[求积法则](@entry_id:753909)，但从数值计算的角度看，这是一个非常不稳定的过程。

#### 不稳定的范德蒙方法

通过求解范德蒙系统 $Vw=m$ 来计算权重的方法，在节点数 $N$ 较大时会遭遇严重的**病态 (ill-conditioned)** 问题。对于 $[-1,1]$ 上的大多数“自然”节点[分布](@entry_id:182848)（如[等距节点](@entry_id:168260)），[范德蒙矩阵](@entry_id:147747) $V$ 的[条件数](@entry_id:145150) $\kappa(V)$ 会随着 $N$ 的增加呈指数级增长 [@problem_id:3405894]。高条件数意味着输入数据（积分矩 $m_i$）中的微小误差（例如由[浮点运算](@entry_id:749454)引入的舍入误差）会被急剧放大，导致计算出的权重 $w_j$ 产生巨大误差。这使得在高阶情况下，该方法在实际的有限精度计算中几乎不可用。

#### 稳定的 Golub-Welsch 算法

幸运的是，对于高斯求积，存在一种数值上极为稳健的构建方法，即 **Golub-Welsch 算法**。该算法利用了[正交多项式](@entry_id:146918)的一个深刻性质：它们满足一个[三项递推关系](@entry_id:176845)。
$$
x p_k(x) = a_k p_{k+1}(x) + b_k p_k(x) + a_{k-1} p_{k-1}(x)
$$
其中 $\{p_k\}$ 是标准[正交多项式](@entry_id:146918)族。这些递推系数 $a_k, b_k$ 定义了一个 $n \times n$ 的[对称三对角矩阵](@entry_id:755732)，称为**[雅可比矩阵](@entry_id:264467) (Jacobi matrix)** $J$：
$$
J=\begin{bmatrix}
b_{0}  & a_{0}  & 0      & \cdots & 0\\
a_{0}  & b_{1}  & a_{1}  & \ddots & \vdots\\
0      & a_{1}  & b_{2}  & \ddots & 0\\
\vdots & \ddots & \ddots & \ddots & a_{n-2}\\
0      & \cdots & 0      & a_{n-2} & b_{n-1}
\end{bmatrix}
$$
Golub-Welsch 算法的核心结论是 [@problem_id:3405828]：
1.  $n$ 点高斯求积的**节点** $\{x_i\}$ 正是这个 $n \times n$ 雅可比矩阵 $J$ 的 $n$ 个**[特征值](@entry_id:154894)**。
2.  相应的**权重** $\{\omega_i\}$ 可以通过其对应的归一化**[特征向量](@entry_id:151813)** $v^{(i)}$ 的第一个分量的平方来计算：$\omega_i = \mu_0 (v_1^{(i)})^2$，其中 $\mu_0 = \int_a^b w(x)dx$ 是权重函数的总质量。

这个方法的巨大优势在于其**[数值稳定性](@entry_id:146550)**。求解[对称矩阵的特征值](@entry_id:152966)问题是数值线性代数中一个条件非常好的问题，并且存在如对称 QR 分解等[后向稳定算法](@entry_id:633945)。这意味着计算出的节点和权重非常精确，其误差通常在[机器精度](@entry_id:756332)量级。因此，高斯求积的理论[精度阶](@entry_id:145189) ($2n-1$) 能够在有限精度运算中得到充分实现 [@problem_id:3405894]。同样，高斯-拉道和[高斯-洛巴托求积](@entry_id:749739)也可以通过求解经适当修改的[雅可比矩阵的特征值](@entry_id:264008)问题来稳定地计算 [@problem_id:3405894] [@problem_id:3405828]。

### [求积法则](@entry_id:753909)选择对 DG 方法的影响

[求积法则](@entry_id:753909)的[精度阶](@entry_id:145189)不仅仅是一个抽象的数学概念，它直接决定了 DG 方法在处理[非线性](@entry_id:637147)问题时的稳定性和行为。

#### 混淆与[非线性不稳定性](@entry_id:752642)

考虑一个[非线性](@entry_id:637147)守恒律，如无粘[伯格斯方程](@entry_id:177995) $u_t + \partial_x(\frac{1}{2}u^2) = 0$。如果我们用次数为 $p$ 的多项式 $u_h \in \mathbb{P}_p$ 来逼近解 $u$，那么[非线性](@entry_id:637147)通量项 $f(u_h) = \frac{1}{2}u_h^2$ 就是一个次数为 $2p$ 的多项式。在 DG 的弱形式中，我们会遇到形如 $\int_K u_h^2 (\partial_x v_h) dx$ 的体积积分，其中测试函数 $v_h \in \mathbb{P}_p$。这个被积函数的次数最高可达 $2p + (p-1) = 3p-1$。

如果所用求积法则的精度阶 $q$ 小于被积函数的实际次数（即 $q < 3p-1$），就会发生**积分不足 (underintegration)**。这种现象会引入一种称为**混淆 (aliasing)** 的误差 [@problem_id:3405858]。混淆的本质是，求积法则（作为一个采样过程）无法分辨高次多项式的全部信息，而是将其“误认”为一个在求积节点上取值相同的低次多项式。

在[非线性](@entry_id:637147)问题中，混淆的后果是灾难性的。它会破坏离散[代数结构](@entry_id:137052)中保证[能量守恒](@entry_id:140514)或耗散的关键性质（如[反对称性](@entry_id:261893)），从而在离散[能量平衡](@entry_id:150831)中引入一个虚假的源项。这常常导致总能量的非物理增长，最终使数值解发散。这种不稳定性是空间离散（具体说是[求积法则](@entry_id:753909)的选择）的直接产物。

#### 设计稳定格式：求积的“奈奎斯特”条件

我们可以借鉴[数字信号处理 (DSP)](@entry_id:177080) 中的类比来直观理解这一问题 [@problem_id:3405823]。将多项式次数 $p$ 视为信号的“带宽”，求积[精度阶](@entry_id:145189) $m$ 视为“采样率”。为了无失真地表示一个信号，[采样率](@entry_id:264884)必须至少是其带宽的两倍，这就是奈奎斯特-香农采样定理。

在 DG 方法中，一个关键的积分是能量项 $\int_K u_h^2 dx$。由于 $u_h^2 \in \mathbb{P}_{2p}$，为了精确计算能量，求积法则的[精度阶](@entry_id:145189)必须满足 $m \ge 2p$。这可以被看作是处理二次[非线性](@entry_id:637147)项的“奈奎斯特”条件。
根据这个条件，我们可以确定不同求积族所需的最小点数：
- **[高斯-勒让德求积](@entry_id:138201)** ($m=2n_q-1$)：需要 $2n_q-1 \ge 2p \implies n_q \ge p + 1/2$，即最少需要 $n_q = p+1$ 个点。
- **[高斯-洛巴托求积](@entry_id:749739)** ($m=2N-3$)：需要 $2N-3 \ge 2p \implies N \ge p + 3/2$，即最少需要 $N = p+2$ 个点。[@problem_id:3405823]

#### 高级主题：[熵稳定格式](@entry_id:749017)与 SBP 性质

在守恒律方程的现代[高阶数值方法](@entry_id:142601)中，一个更强的稳定性概念是**[熵稳定性](@entry_id:749023) (entropy stability)**。对于使用分裂形式 (split-form) 或通量差分 (flux-differencing) 的 DG 格式，证明其[熵稳定性](@entry_id:749023)的关键在于证明离散算子满足**[分部求和](@entry_id:185335) (Summation-By-Parts, SBP)** 性质。

SBP 性质是离散层面上的分部积分法则。对于多项式空间 $\mathbb{P}_N$，离散分部积分法则要求：
$$
\langle \partial_x \phi_h, \psi_h \rangle_{q_v} + \langle \phi_h, \partial_x \psi_h \rangle_{q_v} = \langle \phi_h \psi_h, \mathbf{n} \rangle_{q_f}
$$
对任意 $\phi_h, \psi_h \in \mathbb{P}_N$ 成立，其中 $\langle \cdot, \cdot \rangle_{q_v}$ 和 $\langle \cdot, \cdot \rangle_{q_f}$ 分别表示由体积和界面求积定义的离散[内积](@entry_id:158127)。

为了使这个恒等式成立，求积法则必须能够精确积分其中出现的所有多项式乘积。
- 体积项 $\langle \partial_x \phi_h, \psi_h \rangle_{q_v}$ 的被积函数次数最高为 $(N-1)+N = 2N-1$。
- 界面项 $\langle \phi_h \psi_h, \mathbf{n} \rangle_{q_f}$ 的被积函数次数最高为 $N+N = 2N$。

因此，为了确保 SBP 性质，[求积法则](@entry_id:753909)必须满足以下充分条件 [@problem_id:3405845]：
- **体积求积精度阶 $q_v \ge 2N-1$**
- **界面求积[精度阶](@entry_id:145189) $q_f \ge 2N$**

一旦 SBP 性质得到保证，结合[熵守恒通量](@entry_id:749013)的代数性质，就可以严格证明 DG 格式的半离散[熵守恒](@entry_id:749018)。这再次凸显了求积精度阶在构建稳定可靠的[高阶数值方法](@entry_id:142601)中的核心地位，它不仅关乎精度，更直接关乎方法的根本稳定性。