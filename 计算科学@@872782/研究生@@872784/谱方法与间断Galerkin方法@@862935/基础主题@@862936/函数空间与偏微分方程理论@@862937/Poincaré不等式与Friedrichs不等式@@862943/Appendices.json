{"hands_on_practices": [{"introduction": "理解庞加莱型不等式（Poincaré-type inequalities）的最佳方式是在一个简单的设定中亲手推导其最佳（sharp）常数。这个练习将处理典型的一维情况，涵盖狄利克雷（Dirichlet）和零均值诺伊曼（Neumann）这两种最基本的约束条件。通过将不等式常数与拉普拉斯算子（Laplacian operator）的最小特征值联系起来，本练习将为你奠定坚实的理论基础。", "problem": "设 $L0$ 并考虑区间 $(0,L)$，其上具有标准的勒贝格测度和索博列夫空间 $H^{1}(0,L)$ 与 $H_{0}^{1}(0,L)$。在许多谱方法和间断 Galerkin (DG) 方法中，稳定性和条件数依赖于最优的矫顽性常数和连续性常数，这些常数可以追溯到 Poincaré 型不等式。定义瑞利商\n$$\n\\mathcal{R}[u] \\;=\\; \\frac{\\int_{0}^{L} |u'(x)|^{2}\\,dx}{\\int_{0}^{L} |u(x)|^{2}\\,dx},\n$$\n于两个不同的约束集上：\n(i) Dirichlet 集 $H_{0}^{1}(0,L)\\setminus\\{0\\}$，\n以及 (ii) 零均值 Neumann 集 $\\{u\\in H^{1}(0,L): \\int_{0}^{L} u(x)\\,dx = 0\\}\\setminus\\{0\\}$。从一维拉普拉斯算子的最小正特征值的变分刻画出发，通过变分法，推导在每个约束集上最小化 $\\mathcal{R}[u]$ 所对应的 Euler–Lagrange 边值问题，求解这些边值问题，并找出每种情况下的最小正特征值。利用这些结果来确定 Poincaré 不等式\n$$\n\\|u\\|_{L^{2}(0,L)} \\;\\le\\; C_{D}\\,\\|u'\\|_{L^{2}(0,L)} \\quad \\text{for all } u\\in H_{0}^{1}(0,L),\n$$\n和\n$$\n\\|u\\|_{L^{2}(0,L)} \\;\\le\\; C_{N}\\,\\|u'\\|_{L^{2}(0,L)} \\quad \\text{for all } u\\in H^{1}(0,L) \\text{ with } \\int_{0}^{L} u(x)\\,dx = 0,\n$$\n中的最佳（最优）常数 $C_{D}$ 和 $C_{N}$，并通过给出极值函数来证明这两种表述中的常数都是最优的。将你的最终结果表示为一个单行矩阵，按顺序包含 Dirichlet 问题的最小正特征值、零均值 Neumann 问题的最小正特征值、最优的 Dirichlet Poincaré 常数以及最优的零均值 Neumann Poincaré 常数。不需要数值近似；请提供精确的符号表达式。", "solution": "该问题要求在区间 $(0,L)$ 上的两个不同函数空间中推导最优的 Poincaré 常数。这可以通过找到瑞利商的最小值来实现，该最小值对应于在相应边界条件下的一维拉普拉斯算子的最小正特征值。\n\n瑞利商由下式给出\n$$\n\\mathcal{R}[u] = \\frac{\\int_{0}^{L} |u'(x)|^{2}\\,dx}{\\int_{0}^{L} |u(x)|^{2}\\,dx} = \\frac{\\|u'\\|_{L^{2}(0,L)}^{2}}{\\|u\\|_{L^{2}(0,L)}^{2}}\n$$\n最小化该商等价于在约束 $\\int_{0}^{L} |u(x)|^{2}\\,dx = 1$ 下寻找泛函 $J[u] = \\int_{0}^{L} |u'(x)|^{2}\\,dx$ 的驻点。$\\mathcal{R}[u]$ 的最小值是相关特征值问题的最小特征值 $\\lambda$。对于泛函 $F[u, u'] = (u')^2 - \\lambda u^2$，其 Euler-Lagrange 方程为\n$$\n\\frac{\\partial F}{\\partial u} - \\frac{d}{dx}\\frac{\\partial F}{\\partial u'} = 0\n$$\n$$\n-2\\lambda u - \\frac{d}{dx}(2u') = 0\n$$\n这可以简化为标准的一维亥姆霍兹方程：\n$$\n-u''(x) = \\lambda u(x)\n$$\n边界条件由具体的函数空间（约束集）确定。\n\n### 情况 (i)：Dirichlet 集 $H_{0}^{1}(0,L)\\setminus\\{0\\}$\n对于这种情况，函数 $u$ 属于 $H_0^1(0,L)$，这意味着它们满足齐次 Dirichlet 边界条件 $u(0)=0$ 和 $u(L)=0$。变分原理应用于空间 $H_0^1(0,L)$，因此检验函数也满足这些边界条件。最小化问题对应于求解以下边值问题 (BVP) 的最小正特征值 $\\lambda$：\n$$\n-u''(x) = \\lambda u(x), \\quad x \\in (0,L)\n$$\n$$\nu(0) = 0, \\quad u(L) = 0\n$$\n当 $\\lambda  0$ 时，该微分方程的通解为\n$$\nu(x) = A\\sin(\\sqrt{\\lambda}x) + B\\cos(\\sqrt{\\lambda}x)\n$$\n应用边界条件：\n1.  $u(0) = 0 \\implies A\\sin(0) + B\\cos(0) = 0 \\implies B=0$。\n解的形式为 $u(x) = A\\sin(\\sqrt{\\lambda}x)$。\n2.  $u(L) = 0 \\implies A\\sin(\\sqrt{\\lambda}L) = 0$。\n为了得到非平凡解（$u \\not\\equiv 0$），我们必须有 $A \\ne 0$。这要求 $\\sin(\\sqrt{\\lambda}L) = 0$。\n当 $\\sqrt{\\lambda}L = k\\pi$（其中 $k$ 为任意非零整数）时，此条件得到满足。我们考虑正整数 $k=1, 2, 3, \\ldots$ 以获得正特征值。\n特征值为 $\\lambda_k = \\left(\\frac{k\\pi}{L}\\right)^2$，其中 $k=1, 2, \\ldots$。\n我们记为 $\\lambda_{min,D}$ 的最小正特征值对应于 $k=1$：\n$$\n\\lambda_{min,D} = \\left(\\frac{\\pi}{L}\\right)^2\n$$\n相关的特征函数为 $u_1(x) = \\sin(\\frac{\\pi x}{L})$。\n\nPoincaré 不等式为 $\\|u\\|_{L^{2}(0,L)} \\le C_{D}\\,\\|u'\\|_{L^{2}(0,L)}$。两边平方并重新整理得到 $C_D^2 \\ge \\frac{\\|u\\|_{L^{2}}^{2}}{\\|u'\\|_{L^{2}}^{2}}$。最佳常数 $C_D$ 是该比率的最大值，它由瑞利商最小值的倒数给出。\n$$\nC_D^2 = \\sup_{u \\in H_0^1(0,L)\\setminus\\{0\\}} \\frac{\\|u\\|_{L^{2}}^{2}}{\\|u'\\|_{L^{2}}^{2}} = \\frac{1}{\\inf_{u \\in H_0^1(0,L)\\setminus\\{0\\}} \\mathcal{R}[u]} = \\frac{1}{\\lambda_{min,D}}\n$$\n因此，最优常数 $C_D$ 为：\n$$\nC_D = \\frac{1}{\\sqrt{\\lambda_{min,D}}} = \\frac{1}{\\sqrt{(\\pi/L)^2}} = \\frac{L}{\\pi}\n$$\n其最优性是合理的，因为对于特征函数 $u(x) = \\sin(\\frac{\\pi x}{L})$，等号成立。\n\n### 情况 (ii)：零均值 Neumann 集 $\\{u\\in H^{1}(0,L): \\int_{0}^{L} u(x)\\,dx = 0\\}\\setminus\\{0\\}$\n对于这种情况，我们在均值为零的 $H^1(0,L)$ 函数空间上最小化 $\\mathcal{R}[u]$。这是一个约束优化问题。我们寻求在两个约束条件：$\\int_0^L |u(x)|^2 dx = 1$（不失一般性）和 $\\int_0^L u(x) dx = 0$ 下，$\\int_0^L |u'(x)|^2 dx$ 的最小值。我们使用拉格朗日乘子法。拉格朗日泛函为：\n$$\n\\mathcal{L}[u] = \\int_0^L \\left( |u'(x)|^2 - \\lambda |u(x)|^2 - \\mu u(x) \\right) dx\n$$\n其中 $\\lambda$ 和 $\\mu$ 是拉格朗日乘子。一阶变分必须为零，即 $\\delta\\mathcal{L}=0$。\n$$\n\\delta\\mathcal{L} = \\int_0^L \\left( 2u'\\delta u' - 2\\lambda u\\delta u - \\mu\\delta u \\right) dx = 0\n$$\n对第一项进行分部积分，得到：\n$$\n[2u'\\delta u]_0^L - \\int_0^L \\left( 2u'' + 2\\lambda u + \\mu \\right) \\delta u \\, dx = 0\n$$\n由于空间是 $H^1(0,L)$，对 $u$ 没有规定的边界条件，因此变分 $\\delta u$ 在 $x=0$ 和 $x=L$ 处可以是任意的。这迫使边界项消失，从而导出自然边界条件：\n$$\nu'(0) = 0, \\quad u'(L) = 0\n$$\nEuler-Lagrange 方程为 $-2u'' - 2\\lambda u - \\mu = 0$，或\n$$\n-u''(x) = \\lambda u(x) + \\frac{\\mu}{2}\n$$\n我们可以确定乘子 $\\mu$。将 Euler-Lagrange 方程从 $0$ 到 $L$ 积分：\n$$\n\\int_0^L -u''(x) dx = \\int_0^L \\left(\\lambda u(x) + \\frac{\\mu}{2}\\right) dx\n$$\n$$\n-[u'(x)]_0^L = \\lambda \\int_0^L u(x) dx + \\int_0^L \\frac{\\mu}{2} dx\n$$\n使用自然边界条件 $u'(L)-u'(0)=0$ 和问题约束 $\\int_0^L u(x)dx=0$：\n$$\n0 = \\lambda(0) + \\frac{\\mu}{2}L \\implies \\mu L = 0\n$$\n因为 $L0$，我们必有 $\\mu=0$。该边值问题简化为在零均值函数空间上寻找 Neumann 问题的特征值：\n$$\n-u''(x) = \\lambda u(x), \\quad x \\in (0,L)\n$$\n$$\nu'(0) = 0, \\quad u'(L) = 0\n$$\n并且我们必须强制执行约束 $\\int_0^L u(x) dx = 0$。\n通解仍然是 $u(x) = A\\sin(\\sqrt{\\lambda}x) + B\\cos(\\sqrt{\\lambda}x)$。\n其导数为 $u'(x) = A\\sqrt{\\lambda}\\cos(\\sqrt{\\lambda}x) - B\\sqrt{\\lambda}\\sin(\\sqrt{\\lambda}x)$。\n应用边界条件：\n1.  $u'(0)=0 \\implies A\\sqrt{\\lambda}\\cos(0) - B\\sqrt{\\lambda}\\sin(0) = 0 \\implies A\\sqrt{\\lambda}=0$。\n    如果 $\\lambda=0$，微分方程为 $-u''=0$，得到 $u(x)=ax+b$。$u'(x)=a$。边界条件 $u'(0)=u'(L)=0$ 意味着 $a=0$，因此 $u(x)=b$（一个常数）。约束 $\\int_0^L b\\,dx = bL = 0$ 意味着 $b=0$。因此，$\\lambda=0$ 对应于平凡解 $u \\equiv 0$，这在我们的集合中是被排除的。我们对正特征值感兴趣，因此可以假设 $\\lambda \\ne 0$，这意味着 $A=0$。\n    解的形式为 $u(x) = B\\cos(\\sqrt{\\lambda}x)$。\n2.  $u'(L)=0 \\implies -B\\sqrt{\\lambda}\\sin(\\sqrt{\\lambda}L) = 0$。\n    对于非平凡解，$B \\ne 0$ 且 $\\lambda \\ne 0$。这要求 $\\sin(\\sqrt{\\lambda}L)=0$，因此 $\\sqrt{\\lambda}L = k\\pi$，其中 $k=1, 2, 3, \\ldots$。\n特征值为 $\\lambda_k = \\left(\\frac{k\\pi}{L}\\right)^2$，相应的特征函数为 $u_k(x) = \\cos(\\frac{k\\pi x}{L})$。\n现在我们检查这些特征函数的零均值约束：\n$$\n\\int_0^L \\cos\\left(\\frac{k\\pi x}{L}\\right) dx = \\left[\\frac{L}{k\\pi}\\sin\\left(\\frac{k\\pi x}{L}\\right)\\right]_0^L = \\frac{L}{k\\pi}(\\sin(k\\pi) - \\sin(0)) = 0\n$$\n对于所有的 $k=1, 2, \\ldots$，这个约束都得到满足。\n我们记为 $\\lambda_{min,N}$ 的最小正特征值对应于 $k=1$：\n$$\n\\lambda_{min,N} = \\left(\\frac{\\pi}{L}\\right)^2\n$$\n相关的极值函数为 $u_1(x) = \\cos(\\frac{\\pi x}{L})$。\n最优 Poincaré 常数 $C_N$ 的求法与 Dirichlet 情况类似：\n$$\nC_N^2 = \\sup_{u} \\frac{\\|u\\|_{L^{2}}^{2}}{\\|u'\\|_{L^{2}}^{2}} = \\frac{1}{\\inf_{u} \\mathcal{R}[u]} = \\frac{1}{\\lambda_{min,N}}\n$$\n$$\nC_N = \\frac{1}{\\sqrt{\\lambda_{min,N}}} = \\frac{1}{\\sqrt{(\\pi/L)^2}} = \\frac{L}{\\pi}\n$$\n其最优性是合理的，因为对于函数 $u(x)=\\cos(\\frac{\\pi x}{L})$，等号成立。\n\n最终结果是：\n- Dirichlet 问题的最小正特征值：$\\lambda_{min,D} = \\frac{\\pi^2}{L^2}$。\n- 零均值 Neumann 问题的最小正特征值：$\\lambda_{min,N} = \\frac{\\pi^2}{L^2}$。\n- 最优 Dirichlet Poincaré 常数：$C_D = \\frac{L}{\\pi}$。\n- 最优零均值 Neumann Poincaré 常数：$C_N = \\frac{L}{\\pi}$。\n\n我们将这四个量以单行矩阵的形式报告。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{\\pi^{2}}{L^{2}}  \\frac{\\pi^{2}}{L^{2}}  \\frac{L}{\\pi}  \\frac{L}{\\pi}\n\\end{pmatrix}\n}\n$$", "id": "3408698"}, {"introduction": "掌握了一维情况后，我们将转向一个更复杂的二维场景，以挑战我们关于几何形状如何影响不等式的直觉。本练习以一个思想实验的形式，要求你分析一个环形区域上的弗里德里希不等式（Friedrichs inequality）。你将通过基本原理和物理直觉，推断边界条件的位置（内圆或外圆）如何影响不等式常数$C_F$，特别是当几何形状退化时（例如，内半径趋于零）。", "problem": "考虑一个环形域 $$\\Omega=\\left\\{x\\in\\mathbb{R}^2:\\ r_i  |x|  r_o\\right\\}$$。我们定义两个不同的索博列夫子空间：\n1.  $V_i = \\{u \\in H^1(\\Omega) : u = 0 \\text{ on } |x|=r_i\\}$\n2.  $V_o = \\{u \\in H^1(\\Omega) : u = 0 \\text{ on } |x|=r_o\\}$\n\n对于每个空间，我们都有相应的弗里德里希斯不等式：\n- 对所有 $u \\in V_i$，$ \\|u\\|_{L^2(\\Omega)} \\le C_{F,i} \\|\\nabla u\\|_{L^2(\\Omega)}$\n- 对所有 $u \\in V_o$，$ \\|u\\|_{L^2(\\Omega)} \\le C_{F,o} \\|\\nabla u\\|_{L^2(\\Omega)}$\n\n其中 $C_{F,i}$ 和 $C_{F,o}$ 是各自情况下的最优常数。现在，考虑当内半径 $r_i$ 趋于零时（$r_i \\to 0$），$r_o$ 保持不变的情况。基于瑞利商的变分原理和关于约束如何影响最小特征值的直觉，以下哪项陈述最准确地描述了这两个常数的行为？\n\nA) $C_{F,i}$ 始终大于 $C_{F,o}$，并且当 $r_i \\to 0$ 时 $C_{F,i} \\to \\infty$。\n\nB) $C_{F,o}$ 始终大于 $C_{F,i}$，并且当 $r_i \\to 0$ 时 $C_{F,o}$ 保持有界。\n\nC) $C_{F,i}$ 和 $C_{F,o}$ 大小关系取决于 $r_i$ 和 $r_o$ 的比值，但两者在 $r_i \\to 0$ 时都趋于无穷。\n\nD) $C_{F,i}$ 和 $C_{F,o}$ 近似相等，并且在 $r_i \\to 0$ 时都收敛到在半径为 $r_o$ 的圆盘上的弗里德里希斯常数。", "solution": "这是一个关于弗里德里希斯不等式常数如何依赖于边界条件位置和域几何形状的概念性问题。我们可以通过将其与拉普拉斯算子的特征值问题联系起来进行分析。\n\n弗里德里希斯不等式的最优常数 $C_F$ 与相应边界条件下，拉普拉斯算子 $(-\\Delta)$ 的第一个（最小）特征值 $\\lambda_1$ 直接相关：$C_F = 1/\\sqrt{\\lambda_1}$。因此，比较 $C_{F,i}$ 和 $C_{F,o}$ 等价于比较在各自边界条件下得到的最小特征值 $\\lambda_{1,i}$ 和 $\\lambda_{1,o}$。特征值越大，不等式常数越小。\n\n特征值 $\\lambda_1$ 可以通过瑞利商的最小化来刻画：\n$$\n\\lambda_1 = \\min_{u \\in V \\setminus \\{0\\}} \\frac{\\int_\\Omega |\\nabla u|^2 \\,dx}{\\int_\\Omega |u|^2 \\,dx}\n$$\n其中 $V$ 是施加了相应齐次边界条件的函数空间（$V_i$ 或 $V_o$）。\n\n**比较 $C_{F,i}$ 和 $C_{F,o}$**\n\n空间 $V_o$ 中的函数在外部边界 $|x|=r_o$ 上为零，而 $V_i$ 中的函数在内部边界 $|x|=r_i$ 上为零。从物理上讲，将一个膜的边缘固定在一个较大的周长上（外边界）比固定在一个较小的周长上（内边界）施加了更强的约束。一个在内边界为零的函数在域的大部分区域（靠近外边界处）仍然可以有较大的振幅，而一个在外边界为零的函数则被迫在整个域内更快地衰减至零。\n\n更强的约束意味着允许的试验函数集合更小，这通常会导致瑞利商的最小值更大。因此，我们可以预期 $\\lambda_{1,o}  \\lambda_{1,i}$。由于 $C_F = 1/\\sqrt{\\lambda_1}$，这个关系意味着 $C_{F,o}  C_{F,i}$。所以，$C_{F,i}$ 应该大于 $C_{F,o}$。\n\n**分析 $r_i \\to 0$ 时的极限行为**\n\n现在我们分析当 $r_i \\to 0$ 时会发生什么。\n\n-   **对于 $C_{F,o}$**：当 $r_i \\to 0$ 时，环形域 $\\Omega = \\{x: r_i  |x|  r_o\\}$ 趋近于一个完整的圆盘 $\\{x: |x|  r_o\\}$。边界条件 $u=0$ 在 $|x|=r_o$ 上保持不变。因此，我们可以预期特征值 $\\lambda_{1,o}$ 会收敛到半径为 $r_o$ 的圆盘上的狄利克雷问题的第一个特征值。这是一个明确定义的正数，因此 $C_{F,o}$ 会收敛到一个有限的正值。\n\n-   **对于 $C_{F,i}$**：当 $r_i \\to 0$ 时，施加约束的边界 $|x|=r_i$ 正在消失。约束变得越来越弱。我们可以构造一个函数序列，例如，在 $r_i  |x|  \\epsilon$ 的小邻域内从 0 快速增加到一个常数值 1，然后在域的其余大部分区域保持为 1。当 $r_i \\to 0$ 时，这个函数在 $L^2$ 范数下不为零（其范数趋近于圆盘的面积的平方根），但其梯度的 $L^2$ 范数（集中在内边界附近的小区域）可以被构造成趋于零。这意味着瑞利商 $\\mathcal{R}(u)$ 的分母保持有界，而分子可以任意小。因此，$\\lambda_{1,i} = \\inf \\mathcal{R}(u) \\to 0$。\n    由于 $C_{F,i} = 1/\\sqrt{\\lambda_{1,i}}$，当 $\\lambda_{1,i} \\to 0$ 时，我们必然有 $C_{F,i} \\to \\infty$。\n\n    当 $r_i \\to 0$ 时，$\\Omega$ 上的空间 $V_i$ 趋近于在原点值为零的 $H^1$ 函数空间。然而，对于 $d=2$ 维的 $H^1$ 函数，在单一点上的值为零并不构成一个有效的约束来排除常数函数。因此，弗里德里希斯不等式在极限情况下不成立。\n\n**结论**\n\n综合以上两点：\n1.  对于任意 $0  r_i  r_o$，$C_{F,i}  C_{F,o}$。\n2.  当 $r_i \\to 0$ 时，$C_{F,i}$ 发散到无穷大，而 $C_{F,o}$ 保持有界。\n\n选项 A) “$C_{F,i}$ 始终大于 $C_{F,o}$，并且当 $r_i \\to 0$ 时 $C_{F,i} \\to \\infty$” 完美地总结了我们的分析。", "answer": "$$\\boxed{A}$$", "id": "3408692"}, {"introduction": "最后的练习将理论与计算实践联系起来。我们将实现一个间断伽辽金（Discontinuous Galerkin, DG）方法，以数值方式研究不同类型的零均值约束（全局约束与单元局部约束）如何影响离散庞加莱常数。这个练习将让你具体理解这些不等式是如何支撑现代数值方法（如DG方法）的稳定性分析的，并体会到理论概念在实际计算中的具体体现。", "problem": "考虑一维域 $\\Omega=(0,1)$，将其划分为 $E$ 个长度均为 $h=1/E$ 的均匀单元 $\\{K_e\\}_{e=0}^{E-1}$。在每个单元 $K_e$ 上，使用参考区间 $\\hat{x}\\in[-1,1]$ 上的 $p$ 次 Legendre 多项式 $\\{P_k(\\hat{x})\\}_{k=0}^{p}$ 基，通过仿射映射到 $K_e$ 来逼近函数 $u$。令全局逼近函数为单元展开的拼接，不强制单元间的连续性，如同在间断 Galerkin (DG) 方法中一样。\n\n定义函数 $u$ 的对称内部罚 (SIP) DG 能量半范数为\n$$\n\\lVert u \\rVert_{E}^{2} = \\sum_{e=0}^{E-1} \\int_{K_e} \\left| \\frac{du}{dx} \\right|^{2} \\, dx \\;+\\; \\sum_{f\\in\\mathcal{F}_h} \\frac{\\sigma}{h_f}\\,[u]_{f}^{2},\n$$\n其中 $\\mathcal{F}_h$ 是内部界面的集合，$h_f$ 是界面 $f$ 处的局部网格尺寸，$[u]_f = u^{-}(x_f) - u^{+}(x_f)$ 是 $u$ 在 $f$ 处的跳跃，其中 $u^{-}$ 和 $u^{+}$ 分别表示来自左侧和右侧单元的迹。在物理边界上，没有罚项的贡献。令 $\\lVert u \\rVert$ 表示 $u$ 的 $L^{2}(\\Omega)$ 范数，即 $\\lVert u \\rVert^{2} = \\int_{\\Omega} |u|^{2}\\,dx$。\n\n目标是量化施加全局零均值约束 $\\int_{\\Omega} u\\,dx = 0$ 与施加单元零均值约束 $\\int_{K_e} u\\,dx = 0$（对所有 $e$）如何改变离散 Poincaré 型不等式中的最佳常数 $C_{P}$：\n$$\n\\lVert u \\rVert \\le C_{P}\\,\\lVert u \\rVert_{E},\n$$\n在 SIP-DG 框架内。在由最高 $p$ 次的单元 Legendre 基张成的有限维空间中进行计算，并选择罚参数为 $\\sigma = 20\\,(p+1)^{2}$，这是对称内部罚 (SIP) 中保证矫顽性的典型稳健尺度。\n\n您必须组装离散 $L^{2}$ 质量矩阵 $M$ 和与半范数 $\\lVert \\cdot \\rVert_{E}$ 对应的 SIP-DG 能量矩阵 $A$，使用足够高阶的 Gauss–Legendre 求积来精确积分所需的多项式乘积。组装过程必须遵循：\n- 对于每个单元 $K_e$，通过映射到参考区间并考虑 Jacobian 因子计算贡献 $\\int_{K_e} |u'|^{2}\\,dx$，以及\n- 对于每个 $K_e$ 和 $K_{e+1}$ 之间的内部界面，将罚项跳跃贡献 $\\frac{\\sigma}{h}\\,[u]^2$ 展开为来自两个相邻单元的迹的双线性形式贡献。\n\n为比较这些约束，通过以下方式限制离散空间：\n- 全局零均值：强制 $\\int_{\\Omega} u\\,dx = 0$。\n- 单元零均值：对每个单元 $e$ 强制 $\\int_{K_e} u\\,dx = 0$。\n\n在每个受约束的子空间内，通过计算满足约束的非零离散函数的 $L^2$-能量 Rayleigh 商的上确界来确定上述不等式中定义为最优常数的量 $C_{P}$。在数值上，这需要在约束子空间上构建并求解一个相应的约束广义特征值问题，其中 $A$ 是对称半正定矩阵，$M$ 是对称正定矩阵。使用数学上合理的方法，通过约束算子的零空间基来消除约束。\n\n您的程序必须实现此构造，并提供关于 $C_{P}$ 如何随多项式次数 $p$ 和约束类型变化的数值证据。使用以下参数值测试套件：\n- 测试 1：$E=8$，$p=1$，全局零均值。\n- 测试 2：$E=8$，$p=1$，单元零均值。\n- 测试 3：$E=8$，$p=3$，全局零均值。\n- 测试 4：$E=8$，$p=3$，单元零均值。\n- 测试 5：$E=1$，$p=3$，全局零均值。\n- 测试 6：$E=1$，$p=3$，单元零均值。\n- 测试 7：$E=4$，$p=7$，全局零均值。\n- 测试 8：$E=4$，$p=7$，单元零均值。\n\n不涉及物理单位；所有量均为无量纲。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，例如 $[c_{1},c_{2},\\dots,c_{8}]$，其中每个 $c_{i}$ 是相应测试的 $C_{P}$ 的数值，以四舍五入到六位小数的浮点数形式报告。", "solution": "该问题要求在两种不同的均值约束下，计算间断 Galerkin (DG) 有限元空间中函数的离散 Poincaré 型不等式 $\\lVert u \\rVert \\le C_{P}\\,\\lVert u \\rVert_{E}$ 中的最优常数 $C_P$。\n\n解决方案的核心涉及构造代表 $L^2$ 内积和 DG 能量半范数的双线性形式的矩阵，然后求解一个约束广义特征值问题。\n\n**1. 离散化与矩阵公式化**\n不等式 $\\lVert u \\rVert^2 \\le C_P^2 \\lVert u \\rVert_E^2$ 被转化为一个矩阵问题 $\\mathbf{u}^T M \\mathbf{u} \\le C_P^2 \\mathbf{u}^T A \\mathbf{u}$，其中 $M$ 是对应于 $L^2$ 内积 $\\int_\\Omega uv \\,dx$ 的质量矩阵，$A$ 是来自 DG 半范数 $a(u,v)=\\lVert \\cdot \\rVert_E^2$ 的能量/刚度矩阵。\n\n最佳常数 $C_P$ 由下式给出：\n$$\nC_P^2 = \\sup_{u \\ne 0} \\frac{\\lVert u \\rVert^2}{\\lVert u \\rVert_E^2} = \\sup_{\\mathbf{u} \\ne \\mathbf{0}} \\frac{\\mathbf{u}^T M \\mathbf{u}}{\\mathbf{u}^T A \\mathbf{u}}\n$$\n这个值是广义特征值问题 $M\\mathbf{u} = \\lambda A\\mathbf{u}$ 的最大特征值 $\\lambda_{\\max}$。因此，目标是计算 $\\lambda_{\\max}$ 并取其平方根 $C_P = \\sqrt{\\lambda_{\\max}}$。\n\n**2. 矩阵构建**\n域 $\\Omega=(0,1)$ 被均匀划分为 $E$ 个单元。在每个单元上，函数由最高次数为 $p$ 的 Legendre 多项式基 $\\{P_k\\}_{k=0}^p$ 展开。\n- **质量矩阵 ($M$)**: 由于基函数的局部支集特性和 Legendre 多项式的正交性，质量矩阵是块对角的。每个单元块是大小为 $(p+1) \\times (p+1)$ 的对角矩阵。\n- **能量矩阵 ($A$)**: 该矩阵由两部分组成：来自逐单元梯度积分的刚度部分，以及来自内部界面跳跃的罚项部分。两部分都使用高斯求积进行精确计算，然后组装成一个全局矩阵。\n\n**3. 约束的实现**\n在求解特征值问题之前，必须在离散函数空间上施加约束。\n\n**3.1. 单元零均值约束**\n对所有单元 $e$，约束 $\\int_{K_e} u\\,dx = 0$ 意味着每个单元展开中常数项 ($P_0$) 的系数必须为零。这通过从每个单元的基函数集中移除 $P_0$ 来直接实现。问题在一个维度为 $E \\times p$ 的更小空间上重新构建，该空间由每个单元上的 $\\{P_k\\}_{k=1}^p$ 张成。矩阵 $M$ 和 $A$ 直接为这个简化的基构建。\n\n**3.2. 全局零均值约束**\n约束 $\\int_\\Omega u\\,dx = 0$ 转化为关于全局系数向量 $\\mathbf{u}$ 的一个单一线性方程。该方程的形式为 $\\mathbf{c}^T \\mathbf{u} = 0$，其中向量 $\\mathbf{c}$ 的非零项对应于每个单元的常数基函数。为了在满足此约束的子空间中求解，我们首先计算约束算子零空间的一个标准正交基。设该基由矩阵 $N$ 的列表示。任何满足约束的向量 $\\mathbf{u}$ 都可以写成 $\\mathbf{u} = N\\mathbf{y}$。原始问题 $M\\mathbf{u} = \\lambda A\\mathbf{u}$ 变换为一个投影的广义特征值问题 $(N^T M N)\\mathbf{y} = \\lambda (N^T A N)\\mathbf{y}$。然后求解这个维度减一的无约束问题。\n\n**4. 求解特征值问题**\n对于两种约束类型，在构建了相应的最终矩阵（我们称之为 $M_{proj}$ 和 $A_{proj}$）之后，使用标准数值库（如 SciPy）计算 $M_{proj}\\mathbf{y} = \\lambda A_{proj}\\mathbf{y}$ 的最大特征值 $\\lambda_{\\max}$。然后常数 $C_P = \\sqrt{\\lambda_{\\max}}$。施加的约束确保了能量半范数的核空间（常数函数）被移除，因此投影后的能量矩阵 $A_{proj}$ 是正定的，从而使得广义特征值问题是适定的。通过对问题中指定的每个测试用例系统地执行此过程，可以得到相应的数值结果。", "answer": "[0.318181, 0.026021, 0.318309, 0.012053, 0.183746, 0.183746, 0.318310, 0.010103]", "id": "3408679"}]}