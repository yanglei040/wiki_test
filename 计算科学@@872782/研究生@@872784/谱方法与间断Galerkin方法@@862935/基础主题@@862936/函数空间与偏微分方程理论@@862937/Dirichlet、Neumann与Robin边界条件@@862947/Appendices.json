{"hands_on_practices": [{"introduction": "边界条件如何深刻地影响偏微分方程的解结构？本练习将通过一个基础但极具启发性的例子来回答这个问题。我们将求解带有齐次狄利克雷（Dirichlet）条件的拉普拉斯算符特征值问题，您将亲手推导出这些约束如何催生出一组离散且正交的特征函数（即傅里叶正弦级数基），这是通过模态展开法求解更复杂问题的基石。[@problem_id:3379345]", "problem": "考虑区间 $(0,1)$ 上的一维拉普拉斯特征值问题，其由常微分方程 $-u''(x) = \\lambda u(x)$ 和齐次狄利克雷边界条件 $u(0) = 0$ 及 $u(1) = 0$ 给出。在谱方法和间断伽辽金方法的框架下，这是一个典型的 Sturm–Liouville 问题，其特征结构是正交展开、稳定性和数值格式收敛性的基础。从以下基本事实出发：狄利克雷拉普拉斯算子是 $L^{2}(0,1)$ 上的自伴算子，其定义域为 $H^{2}(0,1) \\cap H_{0}^{1}(0,1)$；并且自伴的 Sturm–Liouville 算子具有实特征值，其对应的正交特征函数构成 $L^{2}(0,1)$ 中的一个完备集。请执行以下步骤：\n\n1. 求解边值问题 $-u''(x) = \\lambda u(x)$，边界条件为 $u(0) = 0$ 和 $u(1) = 0$，以确定所有的特征对 $(\\lambda_{n}, u_{n})$。证明特征值是实数，且对应于不同特征值的特征函数在 $L^{2}(0,1)$ 中是正交的，并解释为什么这些特征函数在 $L^{2}(0,1)$ 中构成一个完备集。\n2. 对于区间 $(0,1)$ 上的函数 $f(x) = x$，在特征函数基 $\\{u_{n}\\}_{n \\ge 1}$ 中，使用 $L^{2}(0,1)$ 内积 $\\langle v, w \\rangle = \\int_{0}^{1} v(x) w(x) \\,\\mathrm{d}x$ 来构建其傅里叶正弦展开。展开系数 $b_{n}$ 由投影公式 $b_{n} = \\langle f, u_{n} \\rangle / \\langle u_{n}, u_{n} \\rangle$ 定义，请对所有 $n \\ge 1$ 显式地确定 $b_{n}$。\n3. 利用正交性和完备性，对此展开应用帕塞瓦尔恒等式（Parseval’s identity），计算无穷级数\n$$\nS \\;=\\; \\sum_{n=1}^{\\infty} \\frac{1}{2}\\,b_{n}^{2}.\n$$\n的精确值。请将 $S$ 的最终结果表示为一个精确的数。不需要四舍五入。最终答案必须是一个不带单位的实数。", "solution": "所述问题是一个标准的、适定的 Sturm-Liouville 特征值问题，它是偏微分方程和数值方法理论的基础。所有提供的信息都是一致且充分的，足以确定一个唯一解。该问题是有效的。\n\n我们按要求分三部分进行求解。\n\n第1部分：确定特征对并证明其性质\n\n特征值问题由常微分方程\n$$\n-u''(x) = \\lambda u(x), \\quad x \\in (0,1)\n$$\n和齐次狄利克雷边界条件 $u(0) = 0$ 和 $u(1) = 0$ 给出。该方程可重写为 $u''(x) + \\lambda u(x) = 0$。我们分析特征值 $\\lambda$ 的性质。\n\n情况1：$\\lambda  0$。令 $\\lambda = -\\mu^2$，其中 $\\mu > 0$。方程变为 $u''(x) - \\mu^2 u(x) = 0$，其通解为 $u(x) = A \\cosh(\\mu x) + B \\sinh(\\mu x)$。应用边界条件：\n$u(0) = A \\cosh(0) + B \\sinh(0) = A = 0$。\n解简化为 $u(x) = B \\sinh(\\mu x)$。第二个边界条件给出 $u(1) = B \\sinh(\\mu) = 0$。由于 $\\mu > 0$，$\\sinh(\\mu) \\neq 0$，这意味着 $B=0$。这只得到平凡解 $u(x) = 0$，因此不存在负特征值。\n\n情况2：$\\lambda = 0$。方程为 $u''(x) = 0$，其通解为 $u(x) = Ax + B$。应用边界条件：\n$u(0) = B = 0$。\n$u(1) = A \\cdot 1 = A = 0$。\n这同样只得到平凡解，因此 $\\lambda=0$ 不是一个特征值。\n\n情况3：$\\lambda > 0$。令 $\\lambda = k^2$，其中 $k > 0$。方程变为 $u''(x) + k^2 u(x) = 0$，其通解为 $u(x) = A \\cos(k x) + B \\sin(k x)$。应用边界条件：\n$u(0) = A \\cos(0) + B \\sin(0) = A = 0$。\n解现在是 $u(x) = B \\sin(k x)$。第二个边界条件给出 $u(1) = B \\sin(k) = 0$。为了获得非平凡解，我们必须有 $B \\neq 0$，这要求 $\\sin(k) = 0$。对于 $k>0$ 的解是 $k = n\\pi$，其中 $n = 1, 2, 3, \\ldots$。\n因此，特征值为 $\\lambda_n = k_n^2 = (n\\pi)^2$，其中 $n \\in \\{1, 2, 3, \\ldots\\}$。\n对应的特征函数是 $u_n(x) = B_n \\sin(n\\pi x)$。为简单起见，我们可以选择常数 $B_n=1$，从而得到特征对：\n$$\n(\\lambda_n, u_n(x)) = ((n\\pi)^2, \\sin(n\\pi x)) \\quad \\text{for } n=1, 2, 3, \\dots\n$$\n\n性质证明：\n该问题是区间 $[0,1]$ 上算子 $L[u] = -u''$ 在指定边界条件下的一个正则 Sturm-Liouville 问题。这类系统的性质是众所周知的。\n1.  实特征值：在给定边界条件下，算子 $L$ 在 $L^2(0,1)$ 上是自伴的。设 $(\\lambda, u)$ 是一个特征对。那么 $\\langle Lu, u \\rangle = \\langle \\lambda u, u \\rangle = \\lambda \\langle u, u \\rangle$。使用分部积分和边界条件 $u(0)=u(1)=0$：\n    $$\n    \\langle Lu, u \\rangle = \\int_{0}^{1} -u''(x) \\overline{u(x)} \\, \\mathrm{d}x = \\left[-u'(x)\\overline{u(x)}\\right]_{0}^{1} + \\int_{0}^{1} u'(x) \\overline{u'(x)} \\, \\mathrm{d}x = \\int_{0}^{1} |u'(x)|^2 \\, \\mathrm{d}x\n    $$\n    这是一个实的非负量。由于对于非平凡特征函数 $u$，$\\langle u, u \\rangle = \\int_{0}^{1} |u(x)|^2 \\, \\mathrm{d}x > 0$，因此 $\\lambda = \\frac{\\int_{0}^{1} |u'(x)|^2 \\, \\mathrm{d}x}{\\int_{0}^{1} |u(x)|^2 \\, \\mathrm{d}x}$ 必须是实数且非负。我们的直接计算证实了这一点。\n2.  特征函数的正交性：设 $(\\lambda_n, u_n)$ 和 $(\\lambda_m, u_m)$ 是两个特征对，其中 $\\lambda_n \\neq \\lambda_m$。我们有 $Lu_n = \\lambda_n u_n$ 和 $Lu_m = \\lambda_m u_m$。根据 $L$ 的自伴性：\n    $$\n    \\langle Lu_n, u_m \\rangle = \\langle u_n, Lu_m \\rangle\n    $$\n    代入特征值关系并利用特征值是实数这一事实：\n    $$\n    \\langle \\lambda_n u_n, u_m \\rangle = \\langle u_n, \\lambda_m u_m \\rangle \\implies \\lambda_n \\langle u_n, u_m \\rangle = \\lambda_m \\langle u_n, u_m \\rangle\n    $$\n    这给出 $(\\lambda_n - \\lambda_m) \\langle u_n, u_m \\rangle = 0$。因为 $\\lambda_n \\neq \\lambda_m$，我们必须有 $\\langle u_n, u_m \\rangle = 0$。因此，特征函数在 $L^2(0,1)$ 中是正交的。\n3.  完备性：Sturm-Liouville 理论的一个核心定理指出，一个正则 Sturm-Liouville 问题的特征函数集构成了该区间上希尔伯特空间 $L^2$ 的一个完备正交基。由于我们的问题是一个正则 Sturm-Liouville 问题，因此特征函数集 $\\{u_n(x) = \\sin(n\\pi x)\\}_{n \\ge 1}$ 是 $L^2(0,1)$ 的一个完备基。\n\n第2部分：傅里叶正弦展开系数\n\n我们希望找到函数 $f(x) = x$ 在特征函数基 $\\{u_n\\}_{n \\ge 1}$ 中的展开系数 $b_n$。所提供的公式是 $b_n = \\frac{\\langle f, u_n \\rangle}{\\langle u_n, u_n \\rangle}$。\n\n首先，我们计算分母，即特征函数 $u_n(x) = \\sin(n\\pi x)$ 的 $L^2$-范数的平方：\n$$\n\\langle u_n, u_n \\rangle = \\int_{0}^{1} \\sin^2(n\\pi x) \\, \\mathrm{d}x = \\int_{0}^{1} \\frac{1 - \\cos(2n\\pi x)}{2} \\, \\mathrm{d}x = \\frac{1}{2} \\left[ x - \\frac{\\sin(2n\\pi x)}{2n\\pi} \\right]_{0}^{1} = \\frac{1}{2} (1 - 0) = \\frac{1}{2}\n$$\n\n接着，我们计算分子，即 $f(x)=x$ 在 $u_n(x)$ 上的投影：\n$$\n\\langle f, u_n \\rangle = \\int_{0}^{1} x \\sin(n\\pi x) \\, \\mathrm{d}x\n$$\n使用分部积分，令 $u=x$ 和 $dv = \\sin(n\\pi x)dx$：\n$$\n\\int_{0}^{1} x \\sin(n\\pi x) \\, \\mathrm{d}x = \\left[ x \\left(-\\frac{\\cos(n\\pi x)}{n\\pi}\\right) \\right]_{0}^{1} - \\int_{0}^{1} \\left(-\\frac{\\cos(n\\pi x)}{n\\pi}\\right) \\, \\mathrm{d}x\n$$\n$$\n= \\left( -\\frac{1 \\cdot \\cos(n\\pi)}{n\\pi} - 0 \\right) + \\frac{1}{n\\pi} \\int_{0}^{1} \\cos(n\\pi x) \\, \\mathrm{d}x\n$$\n$$\n= -\\frac{(-1)^n}{n\\pi} + \\frac{1}{n\\pi} \\left[ \\frac{\\sin(n\\pi x)}{n\\pi} \\right]_{0}^{1} = \\frac{(-1)^{n+1}}{n\\pi} + \\frac{1}{(n\\pi)^2}(\\sin(n\\pi) - \\sin(0)) = \\frac{(-1)^{n+1}}{n\\pi}\n$$\n\n现在我们将分子和分母结合起来求 $b_n$：\n$$\nb_n = \\frac{\\frac{(-1)^{n+1}}{n\\pi}}{\\frac{1}{2}} = \\frac{2(-1)^{n+1}}{n\\pi}\n$$\n\n第3部分：使用帕塞瓦尔恒等式计算级数和\n\n问题要求计算级数和 $S = \\sum_{n=1}^{\\infty} \\frac{1}{2}\\,b_{n}^{2}$ 的值。我们将使用帕塞瓦尔恒等式。对于一个在完备正交基 $\\{u_n\\}$ 中展开为 $f(x) = \\sum_{n=1}^{\\infty} c_n u_n(x)$ 的函数 $f$，其中 $c_n = \\frac{\\langle f, u_n \\rangle}{\\langle u_n, u_n \\rangle}$，帕塞瓦尔恒等式表明：\n$$\n\\langle f, f \\rangle = \\sum_{n=1}^{\\infty} |c_n|^2 \\langle u_n, u_n \\rangle\n$$\n在我们的例子中，$f(x)=x$，系数为 $b_n=c_n$，且特征函数是实函数。该恒等式变为：\n$$\n\\int_{0}^{1} (f(x))^2 \\, \\mathrm{d}x = \\sum_{n=1}^{\\infty} b_n^2 \\langle u_n, u_n \\rangle\n$$\n代入已知值 $f(x)=x$ 和 $\\langle u_n, u_n \\rangle = 1/2$：\n$$\n\\int_{0}^{1} x^2 \\, \\mathrm{d}x = \\sum_{n=1}^{\\infty} b_n^2 \\left(\\frac{1}{2}\\right)\n$$\n等式右侧正是我们需要计算的级数和 $S$。因此，$S$ 的值由等式左侧的积分给出。\n$$\nS = \\int_{0}^{1} x^2 \\, \\mathrm{d}x = \\left[ \\frac{x^3}{3} \\right]_{0}^{1} = \\frac{1^3}{3} - \\frac{0^3}{3} = \\frac{1}{3}\n$$\n该无穷级数的精确值为 $1/3$。", "answer": "$$\n\\boxed{\\frac{1}{3}}\n$$", "id": "3379345"}, {"introduction": "在探讨了狄利克雷条件的具体影响后，我们将转向一个更通用、更强大的理论框架——弱形式。弱形式方法是现代偏微分方程分析和有限元等数值方法的核心。通过为包含诺伊曼（Neumann）和罗宾（Robin）条件的边值问题推导其弱形式，您将探究解的存在性和唯一性等核心理论问题，从而揭示这些边界条件类型在数学上的精妙之处。[@problem_id:3379401]", "problem": "考虑一维泊松边值问题，其定义在区间 $\\Omega = (-1,1)$ 上，\n$$\n-\\frac{\\mathrm{d}^2 u}{\\mathrm{d}x^2} = f(x),\n$$\n带有混合 Neumann–Robin 边界条件\n$$\n\\frac{\\mathrm{d}u}{\\mathrm{d}x}(-1) = g_{N}, \\qquad \\frac{\\mathrm{d}u}{\\mathrm{d}x}(1) + \\beta\\, u(1) = g_{R},\n$$\n其中 $\\beta>0$ 是一个给定常数，$f$、$g_{N}$、$g_{R}$ 是给定数据。从基于分部积分的弱解基本定义出发，推导适用于 Legendre 谱 Galerkin 方法和间断 Galerkin (DG, Discontinuous Galerkin) 方法的弱形式。然后：\n\n1. 通过使用常数函数进行测试，严格推导当 Robin 边界条件关闭时（即当 $\\beta=0$ 使得右边界条件为 Neumann 条件时）确保可解性的相容性条件，并通过建立带有迹项的双线性形式的矫顽性来证明混合 Neumann–Robin 情况（$\\beta>0$）下解的唯一性。\n\n2. 对于特定数据 $f(x) = p\\,x + q$（其中 $p,q \\in \\mathbb{R}$ 为常数），计算其精确解，并确定平均值 $\\overline{u} = \\frac{1}{2}\\int_{-1}^{1} u(x)\\,\\mathrm{d}x$ 关于 $p$、$q$、$g_{N}$、$g_{R}$ 和 $\\beta$ 的封闭形式表达式。将 $\\overline{u}$ 的最终答案表示为单个解析表达式。无需四舍五入。", "solution": "用户希望分析一个带混合边界条件的一维泊松问题。\n\n### 步骤 1：提取已知条件\n-   **偏微分方程 (PDE)**：$-\\frac{\\mathrm{d}^2 u}{\\mathrm{d}x^2} = f(x)$，在 $\\Omega = (-1,1)$ 上。\n-   **边界条件 (BCs)**：\n    -   左侧 (Neumann)：$\\frac{\\mathrm{d}u}{\\mathrm{d}x}(-1) = g_{N}$。\n    -   右侧 (Robin)：$\\frac{\\mathrm{d}u}{\\mathrm{d}x}(1) + \\beta\\, u(1) = g_{R}$。\n-   **参数**：$\\beta > 0$ 是一个常数。$f$、$g_N$、$g_R$ 是给定数据。\n-   **第 2 部分的特定数据**：$f(x) = p\\,x + q$，其中 $p, q \\in \\mathbb{R}$ 为常数。\n-   **任务 1**：推导弱形式。推导 $\\beta=0$ 时的相容性条件。通过证明矫顽性来证明 $\\beta>0$ 时的唯一性。\n-   **任务 2**：对于特定的 $f(x)$，求其精确解并计算其平均值 $\\overline{u} = \\frac{1}{2}\\int_{-1}^{1} u(x)\\,\\mathrm{d}x$。\n\n### 步骤 2：使用提取的已知条件进行验证\n-   **科学依据**：该问题基于泊松方程和标准边界条件（Neumann、Robin），这些是物理和工程（例如，热传导、静电学、弹性力学）众多领域的基础。分析方法（弱形式、Galerkin 方法、矫顽性分析）是现代偏微分方程理论及其数值解法的基石。该问题在数学上和科学上都是合理的。\n-   **适定性**：该问题的结构设计为在 $\\beta>0$ 时有唯一解，并探讨在失去唯一性时（$\\beta=0$）的可解性条件。这是一个标准且适定的数学任务。\n-   **客观性**：该问题以精确、客观的数学语言陈述，没有任何主观或模糊的术语。\n-   **完整性和一致性**：提供了所有必要的信息（偏微分方程、定义域、边界条件、参数）。任务清晰明确。所提供的设置中没有矛盾。\n\n### 步骤 3：结论和行动\n该问题有效。这是分析边值问题及其数值处理的一个标准练习。我将继续提供完整解答。\n\n### 弱形式的推导\n\n为了推导弱形式，我们从问题的强形式开始。我们在一个合适的函数空间中寻找解 $u$，对于此问题，该空间为 Sobolev 空间 $H^1(\\Omega)$。我们将偏微分方程乘以一个任意的测试函数 $v \\in H^1(\\Omega)$，并在定义域 $\\Omega = (-1, 1)$ 上积分：\n$$\n-\\int_{-1}^{1} \\frac{\\mathrm{d}^2 u}{\\mathrm{d}x^2} v(x) \\,\\mathrm{d}x = \\int_{-1}^{1} f(x) v(x) \\,\\mathrm{d}x\n$$\n我们对左侧应用分部积分：\n$$\n\\int_{-1}^{1} \\frac{\\mathrm{d}u}{\\mathrm{d}x} \\frac{\\mathrm{d}v}{\\mathrm{d}x} \\,\\mathrm{d}x - \\left[ \\frac{\\mathrm{d}u}{\\mathrm{d}x}(x) v(x) \\right]_{-1}^{1} = \\int_{-1}^{1} f(x) v(x) \\,\\mathrm{d}x\n$$\n展开边界项，我们得到：\n$$\n\\int_{-1}^{1} \\frac{\\mathrm{d}u}{\\mathrm{d}x} \\frac{\\mathrm{d}v}{\\mathrm{d}x} \\,\\mathrm{d}x - \\frac{\\mathrm{d}u}{\\mathrm{d}x}(1)v(1) + \\frac{\\mathrm{d}u}{\\mathrm{d}x}(-1)v(-1) = \\int_{-1}^{1} f(x) v(x) \\,\\mathrm{d}x\n$$\n现在，我们代入边界条件。Neumann 条件 $\\frac{\\mathrm{d}u}{\\mathrm{d}x}(-1) = g_N$ 是一个自然边界条件，可以直接代入。Robin 条件给出 $\\frac{\\mathrm{d}u}{\\mathrm{d}x}(1) = g_R - \\beta u(1)$，也将其代入。\n$$\n\\int_{-1}^{1} \\frac{\\mathrm{d}u}{\\mathrm{d}x} \\frac{\\mathrm{d}v}{\\mathrm{d}x} \\,\\mathrm{d}x - (g_R - \\beta u(1))v(1) + g_N v(-1) = \\int_{-1}^{1} f(x) v(x) \\,\\mathrm{d}x\n$$\n重新整理各项，将包含未知解 $u$ 的项放在左边，已知数据放在右边：\n$$\n\\int_{-1}^{1} \\frac{\\mathrm{d}u}{\\mathrm{d}x} \\frac{\\mathrm{d}v}{\\mathrm{d}x} \\,\\mathrm{d}x + \\beta u(1) v(1) = \\int_{-1}^{1} f(x) v(x) \\,\\mathrm{d}x + g_R v(1) - g_N v(-1)\n$$\n这就是问题的弱形式。我们定义一个双线性形式 $a(u,v)$ 和一个线性泛函 $L(v)$ 如下：\n-   双线性形式：$a(u,v) = \\int_{-1}^{1} \\frac{\\mathrm{d}u}{\\mathrm{d}x} \\frac{\\mathrm{d}v}{\\mathrm{d}x} \\,\\mathrm{d}x + \\beta u(1) v(1)$\n-   线性泛函：$L(v) = \\int_{-1}^{1} f(x) v(x) \\,\\mathrm{d}x + g_R v(1) - g_N v(-1)$\n\n弱问题是找到 $u \\in H^1(\\Omega)$，使得对于所有 $v \\in H^1(\\Omega)$，都有 $a(u,v) = L(v)$。此形式适用于通过谱 Galerkin 或连续 Galerkin 有限元方法进行逼近。间断 Galerkin (DG) 方法需要在单元边界（在本例中为定义域边界）处引入数值通量，因此需要稍作修改，但此形式是其基本出发点。\n\n### 第 1 部分：相容性与唯一性分析\n\n**$\\beta = 0$ 时的相容性条件（纯 Neumann 边界条件）**\n\n当 $\\beta=0$ 时，Robin 条件变为 Neumann 条件：$\\frac{\\mathrm{d}u}{\\mathrm{d}x}(1) = g_R$。弱形式简化为：找到 $u \\in H^1(\\Omega)$，使得对于所有 $v \\in H^1(\\Omega)$，\n$$\n\\int_{-1}^{1} \\frac{\\mathrm{d}u}{\\mathrm{d}x} \\frac{\\mathrm{d}v}{\\mathrm{d}x} \\,\\mathrm{d}x = \\int_{-1}^{1} f(x) v(x) \\,\\mathrm{d}x + g_R v(1) - g_N v(-1)\n$$\n问题要求用常数函数进行测试。我们选择测试函数 $v(x) = 1$。对于此选择，$\\frac{\\mathrm{d}v}{\\mathrm{d}x} = 0$，$v(1)=1$ 且 $v(-1)=1$。将此代入弱形式得到：\n$$\n\\int_{-1}^{1} \\frac{\\mathrm{d}u}{\\mathrm{d}x} (0) \\,\\mathrm{d}x = \\int_{-1}^{1} f(x) (1) \\,\\mathrm{d}x + g_R (1) - g_N (1)\n$$\n$$\n0 = \\int_{-1}^{1} f(x) \\,\\mathrm{d}x + g_R - g_N\n$$\n这就得出了可解性的相容性条件：\n$$\n\\int_{-1}^{1} f(x) \\,\\mathrm{d}x = g_N - g_R\n$$\n这个条件是解存在的必要条件。如果该条件成立，解是存在的，但仅在相差一个加性常数的意义下是唯一的，因为如果 $u(x)$ 是一个解，那么对于任意常数 $C$，$u(x)+C$ 也是解。这是因为双线性形式 $a(u,v)=\\int u'v' dx$ 的核由所有常数函数组成。\n\n**$\\beta>0$ 时的唯一性（混合 Neumann-Robin 边界条件）**\n\n对于 $\\beta>0$ 的情况，我们可以通过 Lax-Milgram 定理来确立解的存在性和唯一性。这要求双线性形式 $a(u,v)$ 在 $H^1(\\Omega)$ 上是连续且矫顽的。连续性是直接的。我们专注于证明矫顽性，即存在一个常数 $C > 0$ 使得对于所有 $u \\in H^1(\\Omega)$ 都有 $a(u,u) \\ge C \\|u\\|_{H^1}^2$。$H^1$ 范数定义为 $\\|u\\|_{H^1}^2 = \\|u\\|_{L^2}^2 + \\|u'\\|_{L^2}^2 = \\int_{-1}^1 u^2 dx + \\int_{-1}^1 (u')^2 dx$。\n\n对于 $v=u$ 时，双线性形式的计算结果为：\n$$\na(u,u) = \\int_{-1}^{1} \\left(\\frac{\\mathrm{d}u}{\\mathrm{d}x}\\right)^2 \\,\\mathrm{d}x + \\beta (u(1))^2 = \\|u'\\|_{L^2}^2 + \\beta (u(1))^2\n$$\n由于 $\\beta>0$，两项都是非负的。我们将使用反证法来证明矫顽性。假设 $a(u,u)$ 不是矫顽的。那么存在一个序列 $\\{u_n\\}_{n=1}^{\\infty} \\subset H^1(\\Omega)$，使得对所有 $n$ 都有 $\\|u_n\\|_{H^1} = 1$，并且当 $n \\to \\infty$ 时 $a(u_n, u_n) \\to 0$。\n\n条件 $a(u_n, u_n) \\to 0$ 意味着 $\\|u_n'\\|_{L^2}^2 \\to 0$ 和 $\\beta (u_n(1))^2 \\to 0$。因为 $\\beta>0$，这意味着 $\\|u_n'\\|_{L^2} \\to 0$ 且 $u_n(1) \\to 0$。\n条件 $\\|u_n\\|_{H^1} = 1$ 意味着 $\\|u_n\\|_{L^2}^2 + \\|u_n'\\|_{L^2}^2 = 1$。由于 $\\|u_n'\\|_{L^2} \\to 0$，我们必然有 $\\|u_n\\|_{L^2} \\to 1$。\n\n现在，对于任意 $u_n \\in H^1(\\Omega)$，我们可以使用微积分基本定理：\n$$\nu_n(x) = u_n(1) - \\int_x^1 u_n'(t) \\,\\mathrm{d}t\n$$\n取绝对值并对积分应用 Cauchy-Schwarz 不等式：\n$$\n|u_n(x)| \\le |u_n(1)| + \\left|\\int_x^1 u_n'(t) \\,\\mathrm{d}t\\right| \\le |u_n(1)| + \\left(\\int_x^1 1^2 \\,\\mathrm{d}t\\right)^{1/2} \\left(\\int_x^1 (u_n'(t))^2 \\,\\mathrm{d}t\\right)^{1/2}\n$$\n$$\n|u_n(x)| \\le |u_n(1)| + \\sqrt{1-x} \\left(\\int_x^1 (u_n')^2 \\,\\mathrm{d}t\\right)^{1/2} \\le |u_n(1)| + \\sqrt{2} \\|u_n'\\|_{L^2}\n$$\n当 $n \\to \\infty$ 时，我们知道 $u_n(1) \\to 0$ 且 $\\|u_n'\\|_{L^2} \\to 0$。因此，对于任意 $x \\in [-1,1]$，有 $|u_n(x)| \\to 0$。该收敛在 $x$ 上是一致的。\n一致收敛意味着 $L^2$ 收敛。因此，$\\|u_n\\|_{L^2} \\to 0$。\n这个结果 $\\|u_n\\|_{L^2} \\to 0$ 与我们之前发现的 $\\|u_n\\|_{L^2} \\to 1$ 直接矛盾。\n\n矛盾源于 $a(u,u)$ 不是矫顽的假设。因此，$a(u,u)$ 在 $H^1(\\Omega)$ 上是矫顽的。根据 Lax-Milgram 定理，对于任意给定的 $f, g_N, g_R$，该弱问题有唯一解。\n\n### 第 2 部分：精确解与平均值\n\n给定 $f(x) = px+q$，偏微分方程为 $-\\frac{\\mathrm{d}^2 u}{\\mathrm{d}x^2} = px+q$。我们通过对 $x$ 积分两次来求通解：\n$$\n\\frac{\\mathrm{d}u}{\\mathrm{d}x} = -\\int (px+q) \\,\\mathrm{d}x = -\\frac{p}{2}x^2 - qx + C_1\n$$\n$$\nu(x) = \\int \\left(-\\frac{p}{2}x^2 - qx + C_1\\right) \\,\\mathrm{d}x = -\\frac{p}{6}x^3 - \\frac{q}{2}x^2 + C_1x + C_2\n$$\n积分常数 $C_1$ 和 $C_2$ 由边界条件确定。\n\n1.  根据 $x=-1$ 处的 Neumann 条件：$\\frac{\\mathrm{d}u}{\\mathrm{d}x}(-1) = g_N$。\n    $$\n    -\\frac{p}{2}(-1)^2 - q(-1) + C_1 = g_N \\implies -\\frac{p}{2} + q + C_1 = g_N\n    $$\n    $$\n    C_1 = g_N + \\frac{p}{2} - q\n    $$\n\n2.  根据 $x=1$ 处的 Robin 条件：$\\frac{\\mathrm{d}u}{\\mathrm{d}x}(1) + \\beta u(1) = g_R$。\n    $$\n    \\frac{\\mathrm{d}u}{\\mathrm{d}x}(1) = -\\frac{p}{2}(1)^2 - q(1) + C_1 = -\\frac{p}{2} - q + C_1\n    $$\n    $$\n    u(1) = -\\frac{p}{6}(1)^3 - \\frac{q}{2}(1)^2 + C_1(1) + C_2 = -\\frac{p}{6} - \\frac{q}{2} + C_1 + C_2\n    $$\n    将这些代入 Robin 条件：\n    $$\n    \\left(-\\frac{p}{2} - q + C_1\\right) + \\beta\\left(-\\frac{p}{6} - \\frac{q}{2} + C_1 + C_2\\right) = g_R\n    $$\n    代入 $C_1$ 的表达式：\n    $$\n    \\left(-\\frac{p}{2} - q + g_N + \\frac{p}{2} - q\\right) + \\beta\\left(-\\frac{p}{6} - \\frac{q}{2} + g_N + \\frac{p}{2} - q + C_2\\right) = g_R\n    $$\n    $$\n    (g_N - 2q) + \\beta\\left(\\frac{p}{3} - \\frac{3q}{2} + g_N + C_2\\right) = g_R\n    $$\n    现在，求解 $C_2$：\n    $$\n    \\beta(C_2) = g_R - (g_N - 2q) - \\beta\\left(\\frac{p}{3} - \\frac{3q}{2} + g_N\\right)\n    $$\n    $$\n    C_2 = \\frac{g_R - g_N + 2q}{\\beta} - \\left(\\frac{p}{3} - \\frac{3q}{2} + g_N\\right) = \\frac{g_R - g_N + 2q}{\\beta} - \\frac{p}{3} + \\frac{3q}{2} - g_N\n    $$\n\n最后，我们计算平均值 $\\overline{u}$：\n$$\n\\overline{u} = \\frac{1}{2}\\int_{-1}^{1} u(x)\\,\\mathrm{d}x = \\frac{1}{2}\\int_{-1}^{1} \\left(-\\frac{p}{6}x^3 - \\frac{q}{2}x^2 + C_1x + C_2\\right) \\,\\mathrm{d}x\n$$\n在对称区间 $(-1,1)$ 上，奇次幂（$x^3$，$x$）的积分为零。\n$$\n\\overline{u} = \\frac{1}{2} \\left[ -\\frac{q}{2} \\int_{-1}^{1} x^2 \\,\\mathrm{d}x + C_2 \\int_{-1}^{1} 1 \\,\\mathrm{d}x \\right] = \\frac{1}{2} \\left[ -\\frac{q}{2} \\left(\\frac{x^3}{3}\\right)\\bigg|_{-1}^{1} + C_2 (x)\\bigg|_{-1}^{1} \\right]\n$$\n$$\n\\overline{u} = \\frac{1}{2} \\left[ -\\frac{q}{2} \\left(\\frac{1}{3} - \\frac{-1}{3}\\right) + C_2 (1 - (-1)) \\right] = \\frac{1}{2} \\left[ -\\frac{q}{2}\\left(\\frac{2}{3}\\right) + 2C_2 \\right] = -\\frac{q}{6} + C_2\n$$\n代入 $C_2$ 的表达式：\n$$\n\\overline{u} = -\\frac{q}{6} + \\left( \\frac{g_R - g_N + 2q}{\\beta} - \\frac{p}{3} + \\frac{3q}{2} - g_N \\right)\n$$\n按 $p$、$q$、$g_N$ 和 $g_R$ 分组：\n$$\n\\overline{u} = -\\frac{p}{3} + q\\left(-\\frac{1}{6} + \\frac{2}{\\beta} + \\frac{3}{2}\\right) + g_N\\left(-1 - \\frac{1}{\\beta}\\right) + g_R\\left(\\frac{1}{\\beta}\\right)\n$$\n简化系数：\n$$\n-\\frac{1}{6} + \\frac{3}{2} = \\frac{-1+9}{6} = \\frac{8}{6} = \\frac{4}{3}\n$$\n$$\n-1 - \\frac{1}{\\beta} = -\\frac{\\beta+1}{\\beta}\n$$\n所以，平均值为：\n$$\n\\overline{u} = -\\frac{p}{3} + q\\left(\\frac{4}{3} + \\frac{2}{\\beta}\\right) - g_N\\left(\\frac{\\beta+1}{\\beta}\\right) + \\frac{g_R}{\\beta}\n$$\n为了将其表示为分母为 $3\\beta$ 的单个分数：\n$$\n\\overline{u} = \\frac{-p\\beta}{3\\beta} + \\frac{q(4\\beta+6)}{3\\beta} - \\frac{3g_N(\\beta+1)}{3\\beta} + \\frac{3g_R}{3\\beta}\n$$\n$$\n\\overline{u} = \\frac{-p\\beta + (4\\beta+6)q - (3\\beta+3)g_N + 3g_R}{3\\beta}\n$$", "answer": "$$\n\\boxed{\\frac{3g_R - (3\\beta+3)g_N - \\beta p + (4\\beta+6)q}{3\\beta}}\n$$", "id": "3379401"}, {"introduction": "在掌握了边界条件的解析和理论性质后，最后一个练习将聚焦于在高级数值格式中实际应用混合边界条件。您将运用“人造解方法”（Method of Manufactured Solutions）——一项代码验证的关键技能——来实现一个切比雪夫配置法，用以求解同时包含狄利克雷和诺伊曼数据的泊松问题，并数值验证谱方法所预期的指数收敛性。[@problem_id:3379366]", "problem": "考虑在区间 $(0,1)$ 上的一维泊松方程 $-\\Delta u = f$，其中 $\\Delta$ 表示关于 $x$ 的二阶导数算子，该方程服从混合边界条件：在 $x=0$ 处为狄利克雷边界条件，在 $x=1$ 处为诺伊曼边界条件。具体而言，强制施加 $u(0) = g_D$ 和 $\\partial_x u(1) = g_N$。目标是构造解析解 $u$ 及其关联的右端项 $f$，使用基于切比雪夫-高斯-洛巴托点的切比雪夫配置法对问题进行离散化，并数值验证谱（指数）收敛性。\n\n必须遵循谱配置法的基本定义。使用区间 $[-1,1]$ 上的切比雪夫-高斯-洛巴托点 $\\{\\xi_j\\}_{j=0}^N$，其由 $\\xi_j = \\cos\\left(\\frac{\\pi j}{N}\\right)$ 给出；并使用在 $[-1,1]$ 上的标准切比雪夫微分矩阵 $D$，其由经过充分检验的显式公式定义，矩阵元素为\n$$D_{ij} = \\begin{cases}\n\\frac{c_i}{c_j}\\frac{(-1)^{i+j}}{\\xi_i - \\xi_j},  i \\neq j,\\\\\n-\\sum_{k \\neq i} D_{ik},  i=j,\n\\end{cases}$$\n其中 $c_0 = 2$，$c_N = 2$，且对于 $j=1,\\dots,N-1$ 有 $c_j = 1$。使用 $x = \\frac{\\xi+1}{2}$ 映射计算域，使得 $\\xi = -1$ 对应于 $x=0$，$\\xi=1$ 对应于 $x=1$。在此映射下，$d/dx = 2\\,d/d\\xi$ 且 $d^2/dx^2 = 4\\,d^2/d\\xi^2$。将关于 $x$ 的离散二阶导数算子构造为 $D^{(2)}_x = 4 D^2$。\n\n按如下方式构建配置线性系统。对于内部配置点（$j=1,\\dots,N-1$），使用 $-D^{(2)}_x u = f$ 强制施加方程的强形式 $-u''(x_j) = f(x_j)$。在右端点（$j=0$，对应于 $x=1$），使用离散算子 $2 D u = g_N$ 强制施加诺伊曼边界条件 $\\partial_x u(1) = g_N$。在左端点（$j=N$，对应于 $x=0$），通过将相应行替换为单位约束来强制施加狄利克雷边界条件 $u(0) = g_D$。\n\n所有三角函数的角度必须以弧度为单位。\n\n构造的解析解：\n- 选择 $u_1(x) = e^{x} \\sin(2\\pi x)$，其对应的 $f_1(x) = -u_1''(x)$，以及边界数据 $g_{D,1} = u_1(0)$ 和 $g_{N,1} = u_1'(1)$。\n- 选择 $u_2(x) = \\cosh(3x) + \\cos(5x)$，其对应的 $f_2(x) = -u_2''(x)$，以及边界数据 $g_{D,2} = u_2(0)$ 和 $g_{N,2} = u_2'(1)$。\n\n验证目标：\n- 对于解析解 $u$，切比雪夫配置法预期会产生随 $N$ 指数衰减的误差。通过计算一系列 $N$ 值下 $\\log_{10}(\\text{error})$ 相对于 $N$ 的最小二乘斜率 $b$ 和决定系数 $R^2$ 来量化此特性。指数收敛的数值证据是一个显著的负斜率 $b0$ 和一个接近 $1$ 的高 $R^2$ 值。\n\n误差定义：\n- 使用配置网格上的点态最大范数：$\\|e\\|_{\\infty} = \\max_j |u_{\\text{num}}(x_j) - u_{\\text{exact}}(x_j)|$。\n\n测试套件和要求的输出：\n- 测试用例 $\\mathsf{A}$ (正常情况)：使用 $u_1$ 和 $N \\in \\{8,16,32,64\\}$。计算 $y = \\log_{10}(\\|e\\|_{\\infty})$ 相对于 $N$ 的最小二乘斜率 $b_{\\mathsf{A}}$ 和 $R^2_{\\mathsf{A}}$，并报告最大 $N=64$ 时的 $\\|e\\|_{\\infty}$。\n- 测试用例 $\\mathsf{B}$ (备用解析解)：使用 $u_2$ 和 $N \\in \\{6,12,24,48\\}$。计算 $b_{\\mathsf{B}}$、$R^2_{\\mathsf{B}}$。\n- 测试用例 $\\mathsf{C}$ (边界条件验证)：对于 $u_1$ 和 $N=32$，使用离散算子计算边界上的绝对残差，即 $r_D = |u_{\\text{num}}(0) - g_{D,1}|$ 和 $r_N = |\\partial_x u_{\\text{num}}(1) - g_{N,1}|$，其中 $\\partial_x u_{\\text{num}}(1)$ 通过在右端点行计算 $2\\,D u$ 得到。\n- 测试用例 $\\mathsf{D}$ (边缘情况小 $N$)：对于 $u_1$ 和 $N=4$，计算最大范数误差 $\\|e\\|_{\\infty}$。\n\n您的程序必须数值地构建和求解配置线性系统，并严格按照此顺序，生成一个单行输出，其中包含一个由方括号括起来的逗号分隔列表，列表包含以下八个结果：\n$$[b_{\\mathsf{A}}, R^2_{\\mathsf{A}}, \\|e\\|_{\\infty}\\text{ at }N=64, b_{\\mathsf{B}}, R^2_{\\mathsf{B}}, r_D, r_N, \\|e\\|_{\\infty}\\text{ at }N=4].$$\n所有值必须是实数。$\\sin$ 和 $\\cos$ 中的角度必须是弧度。由于所有量都是无量纲的，因此不需要单位。最终输出必须是严格符合要求格式的单行文本。", "solution": "此问题是有效的。它提出了一个清晰、独立且科学上合理可靠的任务：使用切比雪夫配置谱方法求解具有混合边界条件的一维泊松方程。该方法论，包括使用构造解进行验证，是计算科学与工程领域的标准实践。所有必需的数据、定义和程序都得到了明确无误的规定。\n\n该方法的核心是在一组配置点上对微分方程和边界条件进行离散化，从而将问题转化为一个线性代数方程组。然后通过求解该方程组获得解。\n\n首先，我们定义计算域和物理域。问题指定物理域为区间 $x \\in [0, 1]$。我们使用一个标准的仿射映射将其关联到经典的切比雪夫域 $\\xi \\in [-1, 1]$：\n$$x(\\xi) = \\frac{\\xi + 1}{2}$$\n配置点是切比雪夫-高斯-洛巴托（CGL）点，由 $\\xi_j = \\cos\\left(\\frac{\\pi j}{N}\\right)$ 给出，其中 $j=0, 1, \\dots, N$。请注意，在此标准索引下，$\\xi_0=1$ 对应于 $x=1$，而 $\\xi_N=-1$ 对应于 $x=0$。\n\n关于 $x$ 的导数通过链式法则与关于 $\\xi$ 的导数相关联：\n$$ \\frac{d}{dx} = \\frac{d\\xi}{dx} \\frac{d}{d\\xi} = 2 \\frac{d}{d\\xi} $$\n$$ \\frac{d^2}{dx^2} = 4 \\frac{d^2}{d\\xi^2} $$\n在谱配置法中，微分是通过矩阵-向量乘法来执行的。我们在 CGL 网格 $\\{\\xi_j\\}$ 上构建 $(N+1) \\times (N+1)$ 的切比雪夫微分矩阵 $D$。问题提供了其元素 $D_{ij}$ 的显式公式。物理域中的离散一阶和二阶导数算子 $D^{(1)}_x$ 和 $D^{(2)}_x$ 则由以下公式给出：\n$$ D^{(1)}_x = 2D $$\n$$ D^{(2)}_x = 4D^2 $$\n\n任务是找到一个向量 $U$，其元素为配置点 $x_j = x(\\xi_j)$ 处的近似解值 $U_j \\approx u(x_j)$。该向量是一个线性系统 $A U = b$ 的解，其中矩阵 $A$ 和向量 $b$ 在配置点上强制施加控制方程和边界条件。\n\n该系统构建如下：\n1.  内部点 ($j=1, \\dots, N-1$)：在这些点上，我们强制施加泊松方程 $-\\Delta u = f$，即 $-u''(x_j) = f(x_j)$。其离散形式为 $-[D^{(2)}_x U]_j = f(x_j)$。这些方程填充了系统 $A U = b$ 的第 $1$ 行至第 $N-1$ 行。\n\n2.  $x=1$ 处的诺伊曼边界 ($j=0$)：在此点，我们强制施加条件 $\\partial_x u(1) = g_N$。其离散形式为 $[D^{(1)}_x U]_0 = g_N$。此方程填充了系统的第 $0$ 行。\n\n3.  $x=0$ 处的狄利克雷边界 ($j=N$)：在此点，我们强制施加 $u(0) = g_D$。这是通过直接设置未知数值 $U_N = g_D$ 来完成的。具体实现方法是，将矩阵 $A$ 的第 $N$ 行替换为一个单位行（除第 $N$ 列为 $1$ 外，其余全为零），并将右端项向量 $b$ 的相应元素设置为 $g_D$。\n\n在构建了 $(N+1) \\times (N+1)$ 矩阵 $A$ 和右端项向量 $b$ 之后，使用标准线性求解器求解系统 $A U = b$ 以得到未知向量 $U$。\n\n为验证该方法，我们使用构造解法。我们选择一个光滑函数 $u(x)$，然后推导出相应的源项 $f(x) = -u''(x)$ 以及边界数据 $g_D = u(0)$ 和 $g_N=u'(1)$。然后可以将数值解 $U$ 与在配置点上求值的已知精确解 $u(x)$ 进行比较。对于解析解 $u(x)$，谱方法预期会表现出指数收敛性，即误差 $\\|e\\|_\\infty = \\max_j |U_j - u(x_j)|$ 会随 $N$ 的增大而指数衰减。通过观察 $\\log_{10}(\\|e\\|_\\infty)$ 是否近似为 $N$ 的线性函数来验证这一点。我们通过执行最小二乘线性回归来计算斜率 $b$ 和决定系数 $R^2$ 来量化这种关系。一个大的负斜率和一个接近 $1$ 的 $R^2$ 值可以证实指数收敛性。\n\n指定的测试用例涉及两种不同的构造解、收敛性度量指标的计算、边界条件残差的检查以及对小 $N$ 值下误差的评估。边界残差 $r_D = |u_{\\text{num}}(0) - g_D|$ 和 $r_N = |\\partial_x u_{\\text{num}}(1) - g_N|$ 可作为健全性检查，以验证线性系统是否正确地施加了边界条件。鉴于施加边界条件的方法，这些残差预期会接近机器精度。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef linear_regression(x_data, y_data):\n    \"\"\"\n    Performs a linear regression y = a + b*x and calculates R^2.\n    \"\"\"\n    x_data = np.asarray(x_data)\n    y_data = np.asarray(y_data)\n\n    # Use numpy.polyfit to get slope and intercept\n    slope, intercept = np.polyfit(x_data, y_data, 1)\n    \n    # Calculate R-squared value\n    y_mean = np.mean(y_data)\n    y_predicted = slope * x_data + intercept\n    ss_total = np.sum((y_data - y_mean)**2)\n    ss_residual = np.sum((y_data - y_predicted)**2)\n    \n    if ss_total == 0:\n        # Handle case where all y_data points are the same\n        r_squared = 1.0 if ss_residual == 0 else 0.0\n    else:\n        r_squared = 1.0 - (ss_residual / ss_total)\n        \n    return slope, r_squared\n\ndef chebyshev_diff_matrix(N):\n    \"\"\"\n    Constructs the Chebyshev differentiation matrix D on N+1 CGL points.\n    \"\"\"\n    if N == 0:\n        return np.zeros((1, 1))\n    \n    j = np.arange(N + 1)\n    xi = np.cos(np.pi * j / N)\n    \n    c = np.ones(N + 1)\n    c[0] = 2.\n    c[N] = 2.\n    \n    # Off-diagonal entries\n    c_i = c[:, np.newaxis]\n    c_j = c[np.newaxis, :]\n    xi_i = xi[:, np.newaxis]\n    xi_j = xi[np.newaxis, :]\n    d_xi = xi_i - xi_j\n    \n    signs = (-1)**(np.arange(N + 1)[:, np.newaxis] + np.arange(N + 1)[np.newaxis, :])\n    \n    D = (c_i / c_j) * signs / (d_xi + np.eye(N + 1))\n    np.fill_diagonal(D, 0.)\n    \n    # Diagonal entries\n    np.fill_diagonal(D, -np.sum(D, axis=1))\n    \n    return D\n\ndef solve_poisson_1d(N, u_func, f_func, g_D_val, g_N_val):\n    \"\"\"\n    Solves the 1D Poisson BVP using Chebyshev collocation.\n    \"\"\"\n    j = np.arange(N + 1)\n    xi = np.cos(np.pi * j / N)\n    x = (xi + 1.0) / 2.0\n    \n    D = chebyshev_diff_matrix(N)\n    D1x = 2.0 * D\n    D2x = 4.0 * np.dot(D, D)\n\n    A = np.zeros((N + 1, N + 1))\n    b = np.zeros(N + 1)\n    \n    # Interior points: -u'' = f\n    A[1:N, :] = -D2x[1:N, :]\n    b[1:N] = f_func(x[1:N])\n    \n    # Neumann BC at x=1 (j=0)\n    A[0, :] = D1x[0, :]\n    b[0] = g_N_val\n    \n    # Dirichlet BC at x=0 (j=N)\n    A[N, :] = 0.0\n    A[N, N] = 1.0\n    b[N] = g_D_val\n    \n    U_num = np.linalg.solve(A, b)\n    U_exact = u_func(x)\n    \n    error = np.max(np.abs(U_num - U_exact))\n    \n    return {\n        \"error\": error,\n        \"U_num\": U_num,\n        \"D1x\": D1x,\n    }\n\ndef solve():\n    \"\"\"\n    Main function to execute all test cases and print results.\n    \"\"\"\n    # Manufactured solution 1\n    u1 = lambda x: np.exp(x) * np.sin(2. * np.pi * x)\n    u1_prime = lambda x: np.exp(x) * (np.sin(2. * np.pi * x) + 2. * np.pi * np.cos(2. * np.pi * x))\n    f1 = lambda x: -np.exp(x) * ( (1. - 4. * np.pi**2) * np.sin(2. * np.pi * x) + 4. * np.pi * np.cos(2. * np.pi * x) )\n    g_D1 = u1(0.0)\n    g_N1 = u1_prime(1.0)\n\n    # Manufactured solution 2\n    u2 = lambda x: np.cosh(3. * x) + np.cos(5. * x)\n    u2_prime = lambda x: 3. * np.sinh(3. * x) - 5. * np.sin(5. * x)\n    f2 = lambda x: -(9. * np.cosh(3. * x) - 25. * np.cos(5. * x))\n    g_D2 = u2(0.0)\n    g_N2 = u2_prime(1.0)\n    \n    # Test case A: u1, N = {8, 16, 32, 64}\n    Ns_A = np.array([8, 16, 32, 64])\n    errors_A = []\n    for N in Ns_A:\n        result = solve_poisson_1d(N, u1, f1, g_D1, g_N1)\n        errors_A.append(result[\"error\"])\n    log_errors_A = np.log10(np.array(errors_A))\n    b_A, R2_A = linear_regression(Ns_A, log_errors_A)\n    error_N64_A = errors_A[-1]\n\n    # Test case B: u2, N = {6, 12, 24, 48}\n    Ns_B = np.array([6, 12, 24, 48])\n    errors_B = []\n    for N in Ns_B:\n        result = solve_poisson_1d(N, u2, f2, g_D2, g_N2)\n        errors_B.append(result[\"error\"])\n    log_errors_B = np.log10(np.array(errors_B))\n    b_B, R2_B = linear_regression(Ns_B, log_errors_B)\n    \n    # Test case C: u1, N=32, boundary residuals\n    N_C = 32\n    result_C = solve_poisson_1d(N_C, u1, f1, g_D1, g_N1)\n    U_num_C = result_C[\"U_num\"]\n    D1x_C = result_C[\"D1x\"]\n    # Dirichlet residual at x=0 (index N)\n    r_D = np.abs(U_num_C[-1] - g_D1)\n    # Neumann residual at x=1 (index 0)\n    du_dx_at_1_num = (D1x_C @ U_num_C)[0]\n    r_N = np.abs(du_dx_at_1_num - g_N1)\n    \n    # Test case D: u1, N=4, error\n    N_D = 4\n    result_D = solve_poisson_1d(N_D, u1, f1, g_D1, g_N1)\n    error_N4_D = result_D[\"error\"]\n    \n    final_results = [b_A, R2_A, error_N64_A, b_B, R2_B, r_D, r_N, error_N4_D]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, final_results))}]\")\n\nsolve()\n```", "id": "3379366"}]}