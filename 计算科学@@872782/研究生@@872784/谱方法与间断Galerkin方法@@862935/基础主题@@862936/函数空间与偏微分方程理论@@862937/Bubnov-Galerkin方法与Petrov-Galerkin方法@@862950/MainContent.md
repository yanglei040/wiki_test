## 引言
在[数值求解偏微分方程](@entry_id:634353)（PDEs）的广阔领域中，伽辽金方法（Galerkin methods）作为一类基于变分原理的强大技术，占据着核心地位。其基本思想是将复杂的[微分方程](@entry_id:264184)问题转化为一个更易于处理的代数系统，为科学与工程计算提供了坚实的基础。然而，最经典的[布勃诺夫-伽辽金方法](@entry_id:747000)虽然在处理特定类型问题时表现出优雅的对称性和理论完备性，但在面对[流[体力](@entry_id:136788)](@entry_id:174230)学中常见的[对流](@entry_id:141806)主导现象或复杂的混合物理场时，却常常遭遇数值不稳定性的瓶颈。这便引出了一个关键的知识缺口：我们如何系统性地设计出既能保持高精度，又能在更广泛、更具挑战性的问题中保持稳健的[数值格式](@entry_id:752822)？

本文旨在系统地回答这一问题。我们将深入探索伽辽金方法的两个主要分支：[布勃诺夫-伽辽金方法](@entry_id:747000)与[彼得罗夫-伽辽金方法](@entry_id:753372)。在第一章“原理与机制”中，我们将奠定理论基础，详细解析两种方法的数学构造、核心性质（如[伽辽金正交性](@entry_id:173536)）以及保证其稳定性的关键定理（如Lax-Milgram与Inf-Sup条件）。接着，在第二章“应用与[交叉](@entry_id:147634)学科联系”中，我们将展示[彼得罗夫-伽辽金方法](@entry_id:753372)如何作为一种灵活的设计哲学，催生出[流线](@entry_id:266815)[迎风](@entry_id:756372)（SUPG）、间断伽辽金（DG）等先进技术，并探讨其在[流体力学](@entry_id:136788)、[固体力学](@entry_id:164042)等多个领域的应用。最后，在第三章“动手实践”中，您将通过一系列精心设计的练习，将理论知识应用于具体问题，亲手实现和分析这些方法，从而将抽象概念转化为切实的计算技能。

通过这趟从理论到实践的旅程，读者将全面掌握这两种方法的精髓，学会根据问题特性选择或设计合适的伽辽金格式。现在，让我们从它们最根本的原理与机制开始。

## 原理与机制

在上一章中，我们介绍了求解[偏微分方程的数值方法](@entry_id:143514)的一般概念。本章我们将深入探讨一类功能强大且应用广泛的技巧——伽辽金方法（Galerkin methods）的原理与机制。伽辽金方法属于更广泛的[加权余量法](@entry_id:165159)（weighted residual methods）框架，其核心思想在于将一个[微分方程](@entry_id:264184)的求解问题，转化为一个等价的、在无穷维[函数空间](@entry_id:143478)中寻找满足某种“正交性”条件的解的[变分问题](@entry_id:756445)。然后，通过将问题限制在一个精心选择的有限维[子空间](@entry_id:150286)内，我们将无穷维问题简化为一个有限维的线性代数问题，从而能够进行计算。

本章我们将重点区分两种主要的方法：**[布勃诺夫-伽辽金方法](@entry_id:747000) (Bubnov-Galerkin method)** 和 **[彼得罗夫-伽辽金方法](@entry_id:753372) ([Petrov-Galerkin](@entry_id:174072) method)**。我们将从它们的理论基础、稳定性保证、误差特性出发，阐明它们各自的优势与局限，并展示它们在解决复杂物理问题，特别是处理非自伴随算子和特征值问题时的应用。

### [布勃诺夫-伽辽金方法](@entry_id:747000)：一种对称的途径

[布勃诺夫-伽辽金方法](@entry_id:747000)是最经典和最直观的伽辽金方法。其定义性的特征是：**试验[函数空间](@entry_id:143478) (trial function space)** 与 **检验函数空间 (test function space)** 完全相同。换言之，我们用来构造近似解的函数集合，也同样被用来“检验”该解的误差。

#### 从强形式到[弱形式](@entry_id:142897)

让我们通过一个典范的一维泊松方程来阐释这个过程。考虑在区间 $\Omega=(0,1)$ 上的[边值问题](@entry_id:193901)，其强形式（strong form）为：
$$
-u''(x) = f(x), \quad x \in (0,1)
$$
并带有齐次狄利克雷边界条件 $u(0)=u(1)=0$。这里，$f(x)$ 是一个已知的[源项](@entry_id:269111)。

直接求解这个二阶微分方程可能很困难，特别是对于复杂的定义域或[源项](@entry_id:269111)。伽辽金方法的第一步是将其转化为一个等价的[弱形式](@entry_id:142897)（weak form）或[变分形式](@entry_id:166033)（variational form）。我们选择一个函数空间，例如 $V=H_0^1(0,1)$，这是一个包含了所有在边界上为零且其一阶[弱导数](@entry_id:189356)平方可积的函数的[索博列夫空间](@entry_id:141995)。我们任取一个“检验函数” $v \in V$，将原方程两边同乘 $v$ 并在定义域上积分：
$$
-\int_0^1 u''(x)v(x) dx = \int_0^1 f(x)v(x) dx
$$

为了降低对解 $u$ 的光滑性要求，我们对左侧项使用分部积分法：
$$
\int_0^1 u'(x)v'(x) dx - [u'(x)v(x)]_0^1 = \int_0^1 f(x)v(x) dx
$$

由于[检验函数](@entry_id:166589) $v$ 来自 $H_0^1(0,1)$，它满足 $v(0)=v(1)=0$，因此边界项 $[u'(x)v(x)]_0^1$ 自然消失。这样，我们便得到了[弱形式](@entry_id:142897)问题：寻找一个解 $u \in V$，使得对于**所有**的[检验函数](@entry_id:166589) $v \in V$ 都满足：
$$
\int_0^1 u'(x)v'(x) dx = \int_0^1 f(x)v(x) dx
$$

这个方程的优雅之处在于，它现在只要求 $u$ 的[一阶导数](@entry_id:749425)存在（在[弱导数](@entry_id:189356)的意义下），而不再是[二阶导数](@entry_id:144508)。这极大地扩展了可能解的范围。为了更抽象地表达，我们定义一个**双线性形式 (bilinear form)** $a(\cdot, \cdot)$ 和一个**[线性泛函](@entry_id:276136) (linear functional)** $f(\cdot)$：
$$
a(u,v) = \int_0^1 u'(x)v'(x) dx
$$
$$
f(v) = \int_0^1 f(x)v(x) dx
$$

于是，[弱形式](@entry_id:142897)问题可以简洁地写成：寻找 $u \in V$ 使得 $a(u,v) = f(v)$ 对所有 $v \in V$ 成立。

布勃诺夫-[伽辽金离散化](@entry_id:172164)的核心思想是，在一个有限维[子空间](@entry_id:150286) $V_h \subset V$ 中去寻找近似解 $u_h$。也就是说，我们寻找 $u_h \in V_h$，使得对于**所有**的[检验函数](@entry_id:166589) $v_h \in V_h$ 都满足：
$$
a(u_h, v_h) = f(v_h)
$$
由于试验空间与检验空间相同 ($V_h$)，这正是[布勃诺夫-伽辽金方法](@entry_id:747000)的标志 [@problem_id:3368124]。如果我们将 $u_h$ 表示为一组[基函数](@entry_id:170178) $\{\phi_j\}_{j=1}^N$ 的线性组合 $u_h(x) = \sum_{j=1}^N c_j \phi_j(x)$，那么上述问题就转化为了一个关于未知系数 $c_j$ 的 $N \times N$ 线性方程组 $K\mathbf{c} = \mathbf{f}$，其中 $K_{ij} = a(\phi_j, \phi_i)$ 是**刚度矩阵**，$f_i = f(\phi_i)$ 是**[载荷向量](@entry_id:635284)**。

#### 基本性质

[布勃诺夫-伽辽金方法](@entry_id:747000)的对称性选择带来了几个至关重要且优美的性质。

**[伽辽金正交性](@entry_id:173536) (Galerkin Orthogonality)**

这是该方法最核心的性质。我们知道精确解 $u$ 和近似解 $u_h$ 分别满足：
$$
a(u, v_h) = f(v_h), \quad \forall v_h \in V_h \quad (\text{因为 } V_h \subset V)
$$
$$
a(u_h, v_h) = f(v_h), \quad \forall v_h \in V_h
$$
两式相减，并利用 $a(\cdot, \cdot)$ 的线性性质，我们立刻得到：
$$
a(u - u_h, v_h) = 0, \quad \forall v_h \in V_h
$$
这个关系被称为[伽辽金正交性](@entry_id:173536) [@problem_id:3368121]。它表明，近似解的误差 $e = u - u_h$ 在由[双线性形式](@entry_id:746794) $a(\cdot, \cdot)$ 定义的“能量”[内积](@entry_id:158127)意义下，与整个近似[子空间](@entry_id:150286) $V_h$ 正交。这是一个深刻的几何解释：伽辽金解 $u_h$ 是精确解 $u$ 在[子空间](@entry_id:150286) $V_h$ 上的一个投影。此外，这个性质有一个直接推论：如果某个量是由 $a(v,z)$ 定义的，其中 $z \in V_h$，那么[伽辽金近似](@entry_id:171392)对这个量是精确的，即 $a(u,z) = a(u_h,z)$ [@problem_id:3368121]。

**与能量最小化的等价性**

对于许多物理问题，[双线性形式](@entry_id:746794) $a(\cdot, \cdot)$ 是对称且正定的，例如在弹性力学或[静电学](@entry_id:140489)中。在这种情况下，$a(v,v)$ 可以被看作是系统储存在状态 $v$ 中的“能量”。我们可以定义一个能量泛函：
$$
J(v) = \frac{1}{2}a(v,v) - f(v)
$$
可以证明，求解布勃诺夫-伽辽金问题 $a(u_h, v_h) = f(v_h)$ 完全等价于在[子空间](@entry_id:150286) $V_h$ 中寻找一个函数 $u_h$ 来最小化这个[能量泛函](@entry_id:170311) $J(v)$ [@problem_id:3368121]。这为伽辽金方法提供了坚实的物理背景，即系统总是趋向于能量最低的状态。

**矩阵对称性**

当双线性形式 $a(\cdot, \cdot)$ 是对称的，即 $a(u,v) = a(v,u)$ 时，由于试验[基函数](@entry_id:170178)和检验[基函数](@entry_id:170178)相同，刚度矩阵的元素满足 $K_{ij} = a(\phi_j, \phi_i) = a(\phi_i, \phi_j) = K_{ji}$。这意味着刚度矩阵 $K$ 是一个[对称矩阵](@entry_id:143130) [@problem_id:3368124]。对称矩阵不仅在理论上性质良好（例如，保证有实[特征值](@entry_id:154894)），在计算上也极具优势，因为存储和求解[对称线性系统](@entry_id:755721)的成本大约是非对称系统的一半。

#### [适定性](@entry_id:148590)与[误差分析](@entry_id:142477)

一个数值方法是否可靠，取决于其离散问题是否**适定 (well-posed)**，即解是否存在、是否唯一，并是否连续依赖于输入数据。对于[布勃诺夫-伽辽金方法](@entry_id:747000)，其理论基石是**[Lax-Milgram定理](@entry_id:137966)**。该定理指出，如果[双线性形式](@entry_id:746794) $a(\cdot, \cdot)$ 在[希尔伯特空间](@entry_id:261193) $V$ 上是**连续的 (continuous)**（或称有界的）和**矫顽的 (coercive)**（或称 $V$-椭圆的），那么弱形式问题 $a(u,v) = f(v)$ 存在唯一解 [@problem_id:3368124]。
*   **连续性**: 存在常数 $M > 0$ 使得 $|a(u,v)| \le M \|u\|_V \|v\|_V$ 对所有 $u, v \in V$ 成立。
*   **[矫顽性](@entry_id:159399)**: 存在常数 $\alpha > 0$ 使得 $a(v,v) \ge \alpha \|v\|_V^2$ 对所有 $v \in V$ 成立。

矫顽性本质上保证了[能量泛函](@entry_id:170311)是严格凸的，从而确保了最小值的唯一性。对于我们的[泊松方程](@entry_id:143763)例子，可以证明其[双线性形式](@entry_id:746794) $a(u,v) = \int_0^1 u'v' dx$ 在 $H_0^1(0,1)$ 空间上确实满足这两个条件 [@problem_id:3368134]。

在保证了[适定性](@entry_id:148590)之后，我们可以分析近似解的误差。**[Céa引理](@entry_id:165386)** 给出了一个优雅而强大的结果。基于[伽辽金正交性](@entry_id:173536)，可以推导出近似误差满足如下的**[准最优性](@entry_id:167176) (quasi-optimality)** 估计 [@problem_id:3368121]：
$$
\|u - u_h\|_V \le \frac{M}{\alpha} \inf_{v_h \in V_h} \|u - v_h\|_V
$$
这个不等式告诉我们，布勃诺夫-伽辽金解 $u_h$ 的误差，在范数 $\| \cdot \|_V$ 的度量下，与精确解 $u$ 到[子空间](@entry_id:150286) $V_h$ 的**最佳逼近误差**只相差一个常数因子 $M/\alpha$。换言之，伽辽金解的质量几乎和我们能从[子空间](@entry_id:150286) $V_h$ 中找到的最佳逼近一样好。这说明，只要我们选择的[子空间](@entry_id:150286) $V_h$ 具有良好的逼近能力（即 $\inf_{v_h \in V_h} \|u - v_h\|_V$ 会随着 $h$ 的减小或 $N$ 的增大而减小），伽辽金解的收敛性就得到了保证。

### [彼得罗夫-伽辽金方法](@entry_id:753372)：灵活性与稳定性

尽管[布勃诺夫-伽辽金方法](@entry_id:747000)具有理论上的优雅和对称性，但它并非万能。当微分算子不是自伴随时（例如，在[流体力学](@entry_id:136788)中常见的[对流](@entry_id:141806)项），其对应的双线性形式将不再对称，更严重的是，它可能失去矫顽性。在这种情况下，[布勃诺夫-伽辽金方法](@entry_id:747000)可能会产生严重不稳定的、充满[伪振荡](@entry_id:152404)的数值解 [@problem_id:2612183]。

为了克服这一挑战，**[彼得罗夫-伽辽金方法](@entry_id:753372)**应运而生。其核心思想是打破对称性的束缚，允许**试验空间 $U_h$ 与检验空间 $V_h$ 不同** ($U_h \neq V_h$) [@problem_id:3368153]。这种灵活性使得我们可以专门设计检验空间来保证[数值格式](@entry_id:752822)的稳定性，即使在困难的问题中也是如此。

#### 为何需要不同的检验空间？

考虑一个更具挑战性的一维[对流-扩散-反应方程](@entry_id:156456)：
$$
Lu := -\epsilon u'' + \beta u' + \sigma u = f
$$
其中 $\epsilon > 0$ 是[扩散](@entry_id:141445)系数，$\beta$ 是[对流](@entry_id:141806)速度。当[对流](@entry_id:141806)远大于[扩散](@entry_id:141445)时（即 $\epsilon$ 很小而 $|\beta|$ 很大），该问题被称为**[对流](@entry_id:141806)占优 (advection-dominated)**。对应的双线性形式为：
$$
a(u,v) = \int_0^1 (\epsilon u'v' + \beta u'v + \sigma uv) dx
$$
由于[对流](@entry_id:141806)项 $\int \beta u'v dx$，这个[双线性形式](@entry_id:746794)是非对称的。更关键的是，它通常不满足[矫顽性](@entry_id:159399)条件。如果直接应用[布勃诺夫-伽辽金方法](@entry_id:747000)，当网格不够精细时，解中会出现严重的非物理[振荡](@entry_id:267781)。

[彼得罗夫-伽辽金方法](@entry_id:753372)的策略是，保持试验空间 $U_h$ 不变（例如，标准的分片多项式空间），但对检验空间 $V_h$ 进行特殊构造。例如，在**[流线迎风彼得罗夫-伽辽金](@entry_id:755505) (SUPG)** 方法中，检验函数被修改为 $v_h^* = v_h + \delta \beta v_h'$，其中 $v_h$ 是标准的[检验函数](@entry_id:166589)，$\delta$ 是一个依赖于网格和物理参数的稳定化参数。这个附加项在[流线](@entry_id:266815)方向上引入了[人工黏性](@entry_id:756576)（[数值扩散](@entry_id:755256)），有效地抑制了[振荡](@entry_id:267781)，从而恢复了稳定性 [@problem_id:2612183]。其他方法，如**[子域](@entry_id:155812)方法 (subdomain method)** 使用分片常数函数作为检验函数，**[配置法](@entry_id:142690) (collocation method)** 使用狄拉克 $\delta$ 函数作为检验函数，都是[彼得罗夫-伽辽金](@entry_id:174072)框架下的具体实例 [@problem_id:2612183]。

#### [适定性](@entry_id:148590)与稳定性：Inf-Sup条件

由于不再有[矫顽性](@entry_id:159399)作为保障，我们需要一个更通用的理论来分析[彼得罗夫-伽辽金方法](@entry_id:753372)的[适定性](@entry_id:148590)。这个理论由**Babuška-Nečas-Brezzi (BNB)定理**（或称Babuška-[Lax-Milgram定理](@entry_id:137966)）提供。该定理用两个条件取代了[矫顽性](@entry_id:159399) [@problem_id:3368124]：

1.  **Inf-Sup 条件**: 存在常数 $\beta > 0$ 使得
    $$
    \inf_{0 \neq u_h \in U_h} \sup_{0 \neq v_h \in V_h} \frac{a(u_h, v_h)}{\|u_h\|_U \|v_h\|_V} \ge \beta
    $$
    这个条件也常被称为Ladyzhenskaya-Babuška-Brezzi (LBB)条件。它直观地保证了对于试验空间中的任何一个非零函数，都存在一个检验空间中的函数能够“看到”它（即它们之间的[双线性形式](@entry_id:746794)不为零）。

2.  **伴随唯一性条件**: 对于任意非零的 $v_h \in V_h$，存在 $u_h \in U_h$ 使得 $a(u_h, v_h) \neq 0$。

只要这两个条件（以及双线性形式的连续性）得到满足，离散问题就是适定的。Inf-Sup常数 $\beta$ 的大小直接关系到方法的稳定性，一个不依赖于离散化参数（如网格尺寸 $h$）而保持正值的 $\beta$ 意味着方法是**一致稳定 (uniformly stable)** 的。我们可以通过求解一个[变分问题](@entry_id:756445)来具体计算这个常数，如问题[@problem_id:3368174]所示，该问题揭示了稳定性如何依赖于问题的物理参数（如定义域长度 $L$）。

#### [误差分析](@entry_id:142477)

对于满足Inf-Sup条件的[彼得罗夫-伽辽金方法](@entry_id:753372)，同样可以得到一个[准最优性](@entry_id:167176)误差估计。[伽辽金正交性](@entry_id:173536) $a(u-u_h, v_h)=0$ 对于[彼得罗夫-伽辽金方法](@entry_id:753372)依然成立 [@problem_id:3368153]。基于此，可以证明误差满足 [@problem_id:3368153]：
$$
\|u - u_h\|_U \le \left(1 + \frac{C_a}{\beta_h}\right) \inf_{w_h \in U_h} \|u - w_h\|_U
$$
其中 $C_a$ 是双线性形式的连续性常数，$\beta_h$ 是离散Inf-Sup常数。这个估计清晰地表明，近似误差不仅取决于试验空间的逼近能力（$\inf \|u - w_h\|_U$），还反比于稳定性常数 $\beta_h$。一个不稳定的方法（$\beta_h \to 0$）即使拥有很好的逼近空间，其误差也可能被放大到不可接受的程度。因此，构造一个满足一致Inf-Sup条件的检验空间是[彼得罗夫-伽辽金方法](@entry_id:753372)设计的核心。

一个值得注意的[彼得罗夫-伽辽金方法](@entry_id:753372)的例子是**[Nitsche方法](@entry_id:175793)**，用于[弱形式](@entry_id:142897)施加狄利克雷边界条件。它通过在双线性形式中添加对称的、包含罚参数 $\gamma$ 的边界项来代替在函数空间中强加边界条件。通过精心设计，可以保证方法的相容性和稳定性，其双线性形式如下 [@problem_id:3368193]：
$$
a_{\gamma}(u,v) = \int_{\Omega} \nabla u \cdot \nabla v \,dx - \int_{\partial\Omega}(\partial_n u)v\,ds - \int_{\partial\Omega}(\partial_n v)u\,ds + \gamma\int_{\partial\Omega}uv\,ds
$$
这种方法在处理不[贴体网格](@entry_id:746935)或断裂伽辽金方法时特别有用。

### 在[特征值问题](@entry_id:142153)中的应用

伽辽金方法同样是求解微分算子特征值问题的强大工具。

#### 布勃诺夫-伽辽金用于自伴随问题

考虑一个一般的[Sturm-Liouville特征值](@entry_id:175904)问题，其弱形式为：寻找[特征值](@entry_id:154894) $\lambda$ 和非零[特征函数](@entry_id:186820) $u \in V$，使得对于所有 $v \in V$ 成立：
$$
a(u,v) = \lambda \, b(u,v)
$$
其中 $a(\cdot, \cdot)$ 和 $b(\cdot, \cdot)$ 是两个对称的双线性形式，例如对应于刚度和质量。应用[布勃诺夫-伽辽金方法](@entry_id:747000)，我们在[子空间](@entry_id:150286) $V_h$ 中寻找近似解，这自然地导出一个**广义[矩阵特征值问题](@entry_id:142446)** [@problem_id:3368178]：
$$
K \mathbf{u} = \lambda_h M \mathbf{u}
$$
其中 $K$ 和 $M$ 分别是由 $a(\cdot, \cdot)$ 和 $b(\cdot, \cdot)$ 生成的[刚度矩阵](@entry_id:178659)和**[质量矩阵](@entry_id:177093)**。由于 $a$ 和 $b$ 的对称性以及试验与检验空间的同一性，矩阵 $K$ 和 $M$ 都是对称的。如果双线性形式还是正定的，那么它们就是对称正定（SPD）矩阵。这在计算上非常有利，因为[对称特征值问题](@entry_id:755714)有成熟高效的求解器，并且保证所有[特征值](@entry_id:154894)为实数。

#### [彼得罗夫-伽辽金](@entry_id:174072)用于非自伴随问题

当处理非自伴随算子的[特征值问题](@entry_id:142153)时，双线性形式 $a(\cdot, \cdot)$ 是非对称的。此时，即使使用[布勃诺夫-伽辽金方法](@entry_id:747000)，得到的矩阵 $A_h$ 也是非对称的。[彼得罗夫-伽辽金方法](@entry_id:753372)提供了一个更通用的框架。离散化后，我们得到一个非对称的广义[矩阵特征值问题](@entry_id:142446) $A_h \mathbf{u}_h = \lambda_h B_h \mathbf{u}_h$ [@problem_id:3368135]。

非[对称矩阵[特征](@entry_id:151909)值问题](@entry_id:142153)的一个显著特点是其**左[特征向量](@entry_id:151813)**和**右[特征向量](@entry_id:151813)**通常是不同的。右[特征向量](@entry_id:151813)就是我们通常所说的[特征向量](@entry_id:151813) $\mathbf{u}_h$，而左[特征向量](@entry_id:151813) $\mathbf{w}_h$ 满足 $A_h^\ast \mathbf{w}_h = \overline{\lambda_h} B_h^\ast \mathbf{w}_h$。在收敛性理论下，右[特征向量](@entry_id:151813)的函数重构收敛于原问题的特征函数，而左[特征向量](@entry_id:151813)的函数重构则收敛于**伴随问题**的特征函数 [@problem_id:3368135]。此外，这些左右[特征向量](@entry_id:151813)之间满足一种**双[正交关系](@entry_id:145540) (biorthogonality)**，例如，对应不同[特征值](@entry_id:154894) $\lambda_h^{(j)} \neq \lambda_h$ 的右[特征向量](@entry_id:151813) $\mathbf{u}_h^{(j)}$ 和左[特征向量](@entry_id:151813) $\mathbf{w}_h$ 满足 $\mathbf{w}_h^\ast B_h \mathbf{u}_h^{(j)} = 0$ [@problem_id:3368135]。

### 计算影响：[基函数](@entry_id:170178)的选择与[条件数](@entry_id:145150)

将[变分问题](@entry_id:756445)离散化为矩阵问题后，最终的计算效率和精度深受矩阵性质的影响，特别是其**条件数 (condition number)** $\kappa$。[条件数](@entry_id:145150)衡量了矩阵对输入的微小扰动的敏感性，一个高[条件数](@entry_id:145150)的矩阵（即[病态矩阵](@entry_id:147408)）会导致迭代求解器收敛缓慢，并可能放大舍入误差。

[基函数](@entry_id:170178)的选择对矩阵的结构和条件数有决定性影响。
*   **“理想”[基函数](@entry_id:170178)**: 如果我们幸运地选择了一组[基函数](@entry_id:170178)，它们恰好是相关[微分算子](@entry_id:140145)的[特征函数](@entry_id:186820)，那么[刚度矩阵](@entry_id:178659)和[质量矩阵](@entry_id:177093)都会变成[对角矩阵](@entry_id:637782)。例如，在区间 $(0,1)$ 上求解 $-u''=f$ 时，使用正弦函[数基](@entry_id:634389)底 $\phi_k(x)=\sqrt{2}\sin(k\pi x)$，[刚度矩阵](@entry_id:178659) $K$ 就是对角的 [@problem_id:3368134]。同样，在求解[勒让德方程](@entry_id:264827)时使用勒让德多项式作为基底，也会得到对角化的刚度矩阵和[质量矩阵](@entry_id:177093) [@problem_id:3368173]。这种情况下，线性系统求解变得异常简单，但这种理想情况仅限于少数具有[特殊几何](@entry_id:194564)和算子的问题。

*   **[谱方法](@entry_id:141737)中的条件数**: 对于更一般的问题，即使使用正交多项式（如勒让德或[切比雪夫多项式](@entry_id:145074)）作为[基函数](@entry_id:170178)，得到的矩阵通常也是满阵且病态的。例如，对于标准[二阶椭圆问题](@entry_id:754613)，使用 $p$ 次多项式的谱方法，刚度[矩阵的条件数](@entry_id:150947)通常按 $O(p^4)$ 增长。这种剧烈的增长使得对于[高阶谱](@entry_id:191458)方法，**预条件 (preconditioning)** 成为迭代求解器必不可少的一部分。问题[@problem_id:3368173]的分析揭示了一个有趣的现象：对于特定的算子和基底，[条件数](@entry_id:145150)的增长可能非常温和（例如 $O(p)$ 或 $O(p^2)$），这凸显了算子与基底之间深刻的内在联系。该分析还表明，将基底变换为质量矩阵正交的基底（即将质量矩阵变为单位阵）虽然听起来很理想，但可能会恶化刚度[矩阵的条件数](@entry_id:150947)。

总而言之，[布勃诺夫-伽辽金方法](@entry_id:747000)以其对称性和与能量最小化的联系，为自伴随问题提供了坚实而优雅的框架。而[彼得罗夫-伽辽金方法](@entry_id:753372)则通过牺牲对称性换取了宝贵的灵活性，使其能够通过精心设计检验空间来保证非自伴随问题和复杂边界条件下的稳定性和收敛性，其理论核心是Inf-Sup条件。这两种方法共同构成了现代计算科学与工程中[求解偏微分方程](@entry_id:138485)的基石。