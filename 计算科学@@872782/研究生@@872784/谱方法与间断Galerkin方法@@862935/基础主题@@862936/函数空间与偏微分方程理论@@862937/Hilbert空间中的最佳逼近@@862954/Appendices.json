{"hands_on_practices": [{"introduction": "理论学习之后，最好的检验方式莫过于亲手实践。这个练习将引导你解决一个核心问题：如何在 $L_2$ 范数下，为一个不可导的函数 $f(x)=|x|$ 找到其在二次多项式空间中的最佳逼近。通过构建并求解一个线性方程组（即正规方程），你将直接应用希尔伯特空间中的正交投影定理，这是所有逼近理论的基石。", "problem": "在计算工程中，人们常常用一个在给定区间上最小二乘意义下最优的低次多项式来替代一个非光滑函数。考虑区间 $[-1,1]$ 上的函数 $f(x)=|x|$。令 $P_2$ 表示所有次数至多为 $2$ 的实系数多项式组成的空间。为 $[-1,1]$ 上的平方可积函数空间（记为勒贝格 $L_2([-1,1])$ 空间）赋予标准内积 $\\langle g,h\\rangle=\\int_{-1}^{1} g(x)\\,h(x)\\,dx$ 及其关联的范数 $\\|g\\|_{2}=\\sqrt{\\langle g,g\\rangle}$。\n\n仅使用内积、范数的基本定义，以及希尔伯特空间中最佳逼近是到有限维子空间上的正交投影这一性质，确定唯一的 $p^{\\star}(x)\\in P_2$ 多项式，使得它在所有 $p\\in P_2$ 中最小化 $\\|f-p\\|_{2}$。将你的最终结果表示为单项式基下的一个显式多项式 $p^{\\star}(x)=a x^{2}+b x+c$，其系数为精确的有理数，不要进行四舍五入。", "solution": "空间 $L_2([-1,1])$ 是一个希尔伯特空间，其内积定义为 $\\langle g,h\\rangle=\\int_{-1}^{1} g(x)\\,h(x)\\,dx$。我们寻求多项式 $p^{\\star}(x) \\in P_2$，它对于函数 $f(x)=|x|$，在所有多项式 $p(x) \\in P_2$ 中，最小化误差的范数 $\\|f - p\\|_{2}$。根据希尔伯特空间中的投影定理，这个唯一的最佳逼近 $p^{\\star}(x)$ 是 $f(x)$ 到有限维子空间 $P_2$ 上的正交投影。\n\n正交投影的定义性质是误差向量 $f - p^{\\star}$ 与子空间 $P_2$ 正交。这意味着对于 $P_2$ 中的任何多项式 $q(x)$，内积必须为零：\n$$\n\\langle f - p^{\\star}, q \\rangle = 0\n$$\n对子空间 $P_2$ 的一组基向量施加这个正交性条件就足够了。我们将使用 $P_2$（次数至多为2的多项式空间）的标准单项式基：$\\{\\phi_0(x), \\phi_1(x), \\phi_2(x)\\} = \\{1, x, x^2\\}$。\n设所求的多项式在该基下写为 $p^{\\star}(x) = a x^2 + b x + c$。系数 $a, b, c$ 是待定的实值未知数。正交性条件为：\n$$\n\\langle f - p^{\\star}, \\phi_j \\rangle = 0 \\quad \\text{for } j = 0, 1, 2\n$$\n根据内积的线性性，这等价于 $\\langle f, \\phi_j \\rangle = \\langle p^{\\star}, \\phi_j \\rangle$。代入 $p^{\\star}(x)$ 的形式得到：\n$$\n\\langle f, \\phi_j \\rangle = \\langle a x^2 + b x + c, \\phi_j \\rangle = a \\langle x^2, \\phi_j \\rangle + b \\langle x, \\phi_j \\rangle + c \\langle 1, \\phi_j \\rangle\n$$\n这给出了一个关于3个未知系数 $a, b, c$ 的3元线性方程组。为了匹配 $p^{\\star}(x)=a x^2 + b x + c$ 的形式，重新整理各项，该方程组为：\n$$\nc \\langle 1, \\phi_j \\rangle + b \\langle x, \\phi_j \\rangle + a \\langle x^2, \\phi_j \\rangle = \\langle f, \\phi_j \\rangle \\quad \\text{for } j = 0, 1, 2\n$$\n写成矩阵形式，这就是 Gram 系统，其中矩阵元素是基函数的内积。我们现在来计算这些内积。积分区间 $[-1, 1]$ 关于原点对称，因此任何奇函数在该区间上的积分都为 $0$。对于偶函数 $g(x)$，有 $\\int_{-1}^1 g(x) dx = 2 \\int_0^1 g(x) dx$。\n\n首先，我们计算 Gram 矩阵 $G$ 的元素，其中 $G_{ij} = \\langle \\phi_i, \\phi_j \\rangle$，基的顺序为 $\\{1, x, x^2\\}$。\n$$\n\\langle 1, 1 \\rangle = \\int_{-1}^1 1 dx = [x]_{-1}^1 = 2\n$$\n$$\n\\langle 1, x \\rangle = \\int_{-1}^1 x dx = 0 \\quad (\\text{被积函数为奇函数})\n$$\n$$\n\\langle 1, x^2 \\rangle = \\int_{-1}^1 x^2 dx = 2 \\int_0^1 x^2 dx = 2\\left[\\frac{x^3}{3}\\right]_0^1 = \\frac{2}{3}\n$$\n$$\n\\langle x, x \\rangle = \\int_{-1}^1 x^2 dx = \\frac{2}{3}\n$$\n$$\n\\langle x, x^2 \\rangle = \\int_{-1}^1 x^3 dx = 0 \\quad (\\text{被积函数为奇函数})\n$$\n$$\n\\langle x^2, x^2 \\rangle = \\int_{-1}^1 x^4 dx = 2 \\int_0^1 x^4 dx = 2\\left[\\frac{x^5}{5}\\right]_0^1 = \\frac{2}{5}\n$$\n方程组的结构如下，系数向量为 $[c, b, a]^T$：\n$$\n\\begin{pmatrix}\n\\langle 1, 1 \\rangle  \\langle x, 1 \\rangle  \\langle x^2, 1 \\rangle \\\\\n\\langle 1, x \\rangle  \\langle x, x \\rangle  \\langle x^2, x \\rangle \\\\\n\\langle 1, x^2 \\rangle  \\langle x, x^2 \\rangle  \\langle x^2, x^2 \\rangle\n\\end{pmatrix}\n\\begin{pmatrix} c \\\\ b \\\\ a \\end{pmatrix}\n=\n\\begin{pmatrix}\n\\langle f, 1 \\rangle \\\\\n\\langle f, x \\rangle \\\\\n\\langle f, x^2 \\rangle\n\\end{pmatrix}\n$$\n接下来，我们计算右端向量的分量。函数 $f(x)=|x|$ 是一个偶函数。\n$$\n\\langle f, 1 \\rangle = \\int_{-1}^1 |x| dx = 2 \\int_0^1 x dx = 2\\left[\\frac{x^2}{2}\\right]_0^1 = 1\n$$\n$$\n\\langle f, x \\rangle = \\int_{-1}^1 |x|x dx = 0 \\quad (\\text{被积函数为奇函数, } |x| \\text{为偶函数, } x \\text{为奇函数})\n$$\n$$\n\\langle f, x^2 \\rangle = \\int_{-1}^1 |x|x^2 dx = 2 \\int_0^1 x \\cdot x^2 dx = 2 \\int_0^1 x^3 dx = 2\\left[\\frac{x^4}{4}\\right]_0^1 = \\frac{1}{2}\n$$\n组合成方程组：\n$$\n\\begin{pmatrix}\n2  0  \\frac{2}{3} \\\\\n0  \\frac{2}{3}  0 \\\\\n\\frac{2}{3}  0  \\frac{2}{5}\n\\end{pmatrix}\n\\begin{pmatrix} c \\\\ b \\\\ a \\end{pmatrix}\n=\n\\begin{pmatrix}\n1 \\\\\n0 \\\\\n\\frac{1}{2}\n\\end{pmatrix}\n$$\n从第二行，我们推断出 $\\frac{2}{3}b = 0$，这意味着 $b=0$。这是预料之中的，因为在一个对称区间上，偶函数的最佳多项式逼近也必须是偶函数。\n关于 $a$ 和 $c$ 的方程组化简为：\n$$\n\\begin{cases}\n2c + \\frac{2}{3}a = 1 \\\\\n\\frac{2}{3}c + \\frac{2}{5}a = \\frac{1}{2}\n\\end{cases}\n$$\n为了消去分母，我们将第一个方程乘以 $3$，第二个方程乘以 $30$：\n$$\n\\begin{cases}\n6c + 2a = 3 \\\\\n20c + 12a = 15\n\\end{cases}\n$$\n从这两个新方程中的第一个，我们得到 $2a = 3 - 6c$，即 $a = \\frac{3-6c}{2}$。将这个关于 $a$ 的表达式代入第二个方程：\n$$\n20c + 12\\left(\\frac{3-6c}{2}\\right) = 15\n$$\n$$\n20c + 6(3-6c) = 15\n$$\n$$\n20c + 18 - 36c = 15\n$$\n$$\n-16c = -3\n$$\n$$\nc = \\frac{3}{16}\n$$\n现在，我们将 $c$ 的值代回以求出 $a$：\n$$\na = \\frac{3 - 6(\\frac{3}{16})}{2} = \\frac{3 - \\frac{9}{8}}{2} = \\frac{\\frac{24 - 9}{8}}{2} = \\frac{\\frac{15}{8}}{2} = \\frac{15}{16}\n$$\n系数为 $a=\\frac{15}{16}$, $b=0$, $c=\\frac{3}{16}$。\n因此，最小化 $\\|f-p\\|_{2}$ 的唯一多项式 $p^{\\star}(x) \\in P_2$ 是：\n$$\np^{\\star}(x) = \\frac{15}{16}x^2 + \\frac{3}{16}\n$$", "answer": "$$\n\\boxed{\\frac{15}{16}x^{2} + \\frac{3}{16}}\n$$", "id": "2395859"}, {"introduction": "最佳逼近的概念在本质上取决于我们如何定义“距离”或“范数”。这个练习 [@problem_id:3366993] 深入探讨了这一点，它要求你比较同一个函数在两个不同加权希尔伯特空间（分别对应切比雪夫和勒让德多项式）中的最佳逼近。通过这个对比，你将清晰地看到，“最佳”并非绝对，而是与所选择的内积紧密相关，这对于在不同应用场景中选择合适的多项式基至关重要。", "problem": "考虑在区间 $[-1,1]$ 上的平方可积函数所构成的希尔伯特空间，其内积由权重定义。具体来说，对于一个权重函数 $w(x)$，定义空间 $L^{2}([-1,1],w)$，其内积为 $\\langle f,g\\rangle_{w}=\\int_{-1}^{1} f(x)\\,g(x)\\,w(x)\\,dx$，相关范数为 $\\|f\\|_{w}=\\big(\\int_{-1}^{1}|f(x)|^{2}w(x)\\,dx\\big)^{1/2}$。一个元素 $f$ 在一个有限维子空间中的最佳逼近，是 $f$ 在该希尔伯特空间的内积下到该子空间上的正交投影。\n\n第一类切比雪夫多项式 $\\{T_{n}(x)\\}_{n\\geq 0}$ 在 $[-1,1]$ 上关于权重 $w_{C}(x)=(1-x^{2})^{-1/2}$ 是正交的，而勒让德多项式 $\\{P_{n}(x)\\}_{n\\geq 0}$ 在 $[-1,1]$ 上关于单位权重 $w_{L}(x)=1$ 是正交的。在谱方法和间断 Galerkin 方法中，截断正交展开在这些加权 $L^{2}$ 空间中实现了最佳逼近。\n\n令 $f(x)=T_{3}(x)=4x^{3}-3x$。考虑次数至多为一的多项式子空间：\n- 切比雪夫子空间 $\\mathcal{C}_{1}=\\operatorname{span}\\{T_{0},T_{1}\\}$，其内积为 $\\langle\\cdot,\\cdot\\rangle_{w_{C}}$。\n- 勒让德子空间 $\\mathcal{L}_{1}=\\operatorname{span}\\{P_{0},P_{1}\\}$，其内积为 $\\langle\\cdot,\\cdot\\rangle_{w_{L}}$。\n\n仅使用希尔伯特空间中正交投影的定义，以及 $\\{T_{n}\\}$ 在 $L^{2}([-1,1],w_{C})$ 中的正交性和 $\\{P_{n}\\}$ 在 $L^{2}([-1,1],1)$ 中的正交性，确定：\n1. $f$ 在 $L^{2}([-1,1],w_{C})$ 中从 $\\mathcal{C}_{1}$ 出发的最佳逼近（次数至多为一的截断切比雪夫展开）。\n2. $f$ 在 $L^{2}([-1,1],1)$ 中从 $\\mathcal{L}_{1}$ 出发的最佳逼近（次数至多为一的截断勒让德展开）。\n\n然后，通过计算这两个最佳逼近之差的无权 $L^{2}([-1,1])$ 范数来量化它们之间的差异，即计算 $\\big\\|p_{L}-p_{C}\\big\\|_{L^{2}([-1,1])}$，其中 $p_{C}\\in\\mathcal{C}_{1}$ 和 $p_{L}\\in\\mathcal{L}_{1}$ 分别是各自的最佳逼近多项式。请将您的最终答案表示为单个精确的解析表达式。无需四舍五入。", "solution": "问题要求从两个不同的次数至多为一的多项式子空间中，分别在不同的加权内积下，求出函数 $f(x)=T_{3}(x)=4x^{3}-3x$ 的最佳逼近。随后，要求计算这两个逼近之差的无权 $L^{2}$ 范数。\n\n这里应用的基本原理是：一个函数 $f$ 在希尔伯特空间 $H$ 的一个有限维子空间 $V$ 中的最佳逼近是 $f$ 到 $V$ 上的正交投影。如果 $\\{v_{k}\\}_{k=0}^{N}$ 是 $V$ 的一个正交基，那么 $f$ 到 $V$ 上的正交投影，记作 $\\operatorname{proj}_{V}f$，由下式给出：\n$$\n\\operatorname{proj}_{V}f = \\sum_{k=0}^{N} \\frac{\\langle f, v_{k} \\rangle}{\\langle v_{k}, v_{k} \\rangle} v_{k}\n$$\n其中 $\\langle \\cdot, \\cdot \\rangle$ 是希尔伯特空间 $H$ 的内积。\n\n1.  **从切比雪夫子空间 $\\mathcal{C}_{1}$ 出发的最佳逼近**\n\n第一个任务是在希尔伯特空间 $L^{2}([-1,1], w_{C})$（权重为 $w_{C}(x)=(1-x^{2})^{-1/2}$）中，从子空间 $\\mathcal{C}_{1}=\\operatorname{span}\\{T_{0}, T_{1}\\}$ 出发，求 $f(x)=T_{3}(x)$ 的最佳逼近。其内积为 $\\langle f,g\\rangle_{w_{C}}=\\int_{-1}^{1} f(x)g(x)(1-x^{2})^{-1/2}dx$。设最佳逼近为 $p_{C}(x)$。\n\n$\\mathcal{C}_{1}$ 的基是 $\\{T_{0}(x), T_{1}(x)\\}$。切比雪夫多项式族 $\\{T_{n}(x)\\}_{n\\geq 0}$ 关于内积 $\\langle\\cdot,\\cdot\\rangle_{w_{C}}$ 是正交的。逼近 $p_{C}(x)$ 是 $f(x)$ 到 $\\mathcal{C}_{1}$ 上的正交投影：\n$$\np_{C}(x) = \\frac{\\langle f, T_{0} \\rangle_{w_{C}}}{\\langle T_{0}, T_{0} \\rangle_{w_{C}}} T_{0}(x) + \\frac{\\langle f, T_{1} \\rangle_{w_{C}}}{\\langle T_{1}, T_{1} \\rangle_{w_{C}}} T_{1}(x)\n$$\n待逼近的函数是 $f(x)=T_{3}(x)$。我们使用切比雪夫多项式的正交性质：当 $m \\neq n$ 时，$\\langle T_{m}, T_{n} \\rangle_{w_{C}} = 0$。\n\n对于第一个系数，分子中的内积是 $\\langle f, T_{0} \\rangle_{w_{C}} = \\langle T_{3}, T_{0} \\rangle_{w_{C}}$。由于 $3 \\neq 0$，该内积为 $0$。\n对于第二个系数，分子中的内积是 $\\langle f, T_{1} \\rangle_{w_{C}} = \\langle T_{3}, T_{1} \\rangle_{w_{C}}$。由于 $3 \\neq 1$，该内积也为 $0$。\n\n因此，展开式的系数均为零。$f(x)$ 从 $\\mathcal{C}_{1}$ 出发的最佳逼近是：\n$$\np_{C}(x) = 0 \\cdot T_{0}(x) + 0 \\cdot T_{1}(x) = 0\n$$\n\n2.  **从勒让德子空间 $\\mathcal{L}_{1}$ 出发的最佳逼近**\n\n第二个任务是在希尔伯特空间 $L^{2}([-1,1], 1)$（权重为 $w_{L}(x)=1$）中，从子空间 $\\mathcal{L}_{1}=\\operatorname{span}\\{P_{0}, P_{1}\\}$ 出发，求 $f(x) = 4x^{3}-3x$ 的最佳逼近。其内积是标准的无权内积 $\\langle f,g\\rangle_{w_{L}}=\\int_{-1}^{1} f(x)g(x)dx$。设最佳逼近为 $p_{L}(x)$。\n\n$\\mathcal{L}_{1}$ 的基是 $\\{P_{0}(x), P_{1}(x)\\}$。勒让德多项式族 $\\{P_{n}(x)\\}_{n\\geq 0}$ 关于内积 $\\langle\\cdot,\\cdot\\rangle_{w_{L}}$ 是正交的。标准的前两个勒让德多项式是 $P_{0}(x)=1$ 和 $P_{1}(x)=x$。\n\n逼近 $p_{L}(x)$ 是 $f(x)$ 到 $\\mathcal{L}_{1}$ 上的正交投影：\n$$\np_{L}(x) = \\frac{\\langle f, P_{0} \\rangle_{w_{L}}}{\\langle P_{0}, P_{0} \\rangle_{w_{L}}} P_{0}(x) + \\frac{\\langle f, P_{1} \\rangle_{w_{L}}}{\\langle P_{1}, P_{1} \\rangle_{w_{L}}} P_{1}(x)\n$$\n首先，我们计算基向量的范数平方：\n$$\n\\langle P_{0}, P_{0} \\rangle_{w_{L}} = \\int_{-1}^{1} (1)^{2} dx = [x]_{-1}^{1} = 1 - (-1) = 2\n$$\n$$\n\\langle P_{1}, P_{1} \\rangle_{w_{L}} = \\int_{-1}^{1} (x)^{2} dx = \\left[\\frac{x^{3}}{3}\\right]_{-1}^{1} = \\frac{1}{3} - \\frac{-1}{3} = \\frac{2}{3}\n$$\n接下来，我们计算 $f(x)$ 与基向量的内积：\n$$\n\\langle f, P_{0} \\rangle_{w_{L}} = \\int_{-1}^{1} (4x^{3}-3x)(1) dx\n$$\n被积函数 $4x^{3}-3x$ 是一个奇函数，因此它在对称区间 $[-1,1]$ 上的积分为 $0$。所以，$\\langle f, P_{0} \\rangle_{w_{L}} = 0$。\n\n$$\n\\langle f, P_{1} \\rangle_{w_{L}} = \\int_{-1}^{1} (4x^{3}-3x)(x) dx = \\int_{-1}^{1} (4x^{4}-3x^{2}) dx\n$$\n被积函数 $4x^{4}-3x^{2}$ 是一个偶函数。\n$$\n\\int_{-1}^{1} (4x^{4}-3x^{2}) dx = \\left[\\frac{4x^{5}}{5} - x^{3}\\right]_{-1}^{1} = \\left(\\frac{4}{5} - 1\\right) - \\left(-\\frac{4}{5} - (-1)\\right) = -\\frac{1}{5} - \\frac{1}{5} = -\\frac{2}{5}\n$$\n现在我们可以计算 $p_{L}(x)$ 的系数：\n$P_{0}(x)$ 的系数是 $\\frac{0}{2}=0$。\n$P_{1}(x)$ 的系数是 $\\frac{-2/5}{2/3} = -\\frac{2}{5} \\cdot \\frac{3}{2} = -\\frac{3}{5}$。\n\n$f(x)$ 从 $\\mathcal{L}_{1}$ 出发的最佳逼近是：\n$$\np_{L}(x) = 0 \\cdot P_{0}(x) + \\left(-\\frac{3}{5}\\right) \\cdot P_{1}(x) = -\\frac{3}{5}x\n$$\n\n3.  **差的范数**\n\n最后的任务是计算两个逼近之差的无权 $L^{2}([-1,1])$ 范数，即 $\\|p_{L}-p_{C}\\|_{L^{2}([-1,1])}$。\n我们有 $p_{C}(x)=0$ 和 $p_{L}(x)=-\\frac{3}{5}x$。它们的差是 $p_{L}(x)-p_{C}(x) = -\\frac{3}{5}x$。\n范数定义为 $\\|g\\|_{L^{2}([-1,1])} = \\left(\\int_{-1}^{1} |g(x)|^{2} dx\\right)^{1/2}$。\n$$\n\\|p_{L}-p_{C}\\|_{L^{2}([-1,1])} = \\left(\\int_{-1}^{1} \\left|-\\frac{3}{5}x\\right|^{2} dx\\right)^{1/2} = \\left(\\int_{-1}^{1} \\frac{9}{25}x^{2} dx\\right)^{1/2}\n$$\n我们计算该积分：\n$$\n\\int_{-1}^{1} \\frac{9}{25}x^{2} dx = \\frac{9}{25} \\int_{-1}^{1} x^{2} dx = \\frac{9}{25} \\left[\\frac{x^{3}}{3}\\right]_{-1}^{1} = \\frac{9}{25} \\left(\\frac{1}{3} - \\frac{-1}{3}\\right) = \\frac{9}{25} \\cdot \\frac{2}{3} = \\frac{3 \\cdot 2}{25} = \\frac{6}{25}\n$$\n范数是这个值的平方根：\n$$\n\\|p_{L}-p_{C}\\|_{L^{2}([-1,1])} = \\sqrt{\\frac{6}{25}} = \\frac{\\sqrt{6}}{5}\n$$", "answer": "$$\n\\boxed{\\frac{\\sqrt{6}}{5}}\n$$", "id": "3366993"}, {"introduction": "现在，我们将抽象的理论与计算方法中的一个实际挑战联系起来：处理弯曲几何。当使用等参单元进行数值模拟时，从参考单元到物理单元的几何映射会自然地引入一个加权内积（其权重为雅可比行列式）。这个练习 [@problem_id:3367015] 旨在量化当忽略此几何效应、采用简化的非加权内积时所产生的逼近误差，从而揭示在谱元法（SEM）和间断伽辽金（DG）方法中正确处理几何的重要性。", "problem": "考虑在谱元法和间断伽辽金(DG)方法中使用的一个等参弯曲单元。设参考单元为坐标为 $\\xi$ 的区间 $[-1,1]$，并定义到物理单元的等参映射为 $F(\\xi) = \\xi + \\epsilon \\xi^{3}$，其中扭曲参数满足 $\\epsilon > -\\frac{1}{3}$，以使雅可比行列式 $J(\\xi) = \\frac{dF}{d\\xi} = 1 + 3 \\epsilon \\xi^{2}$ 严格为正。设物理单元 $K = F([-1,1])$ 上的希尔伯特空间为 $L^{2}(K)$，其配备了弯曲元 $L^{2}$ 内积 $(u,v)_{L^{2}(K)} = \\int_{K} u(x) v(x) \\, dx$。在拉回到 $[-1,1]$ 之后，该内积变为 $(\\hat{u},\\hat{v})_{J} = \\int_{-1}^{1} \\hat{u}(\\xi) \\hat{v}(\\xi) J(\\xi) \\, d\\xi$，其中 $\\hat{u}(\\xi) = u(F(\\xi))$ 且 $\\hat{v}(\\xi) = v(F(\\xi))$。作为对比，考虑无权拉回参考内积 $(\\hat{u},\\hat{v})_{\\text{ref}} = \\int_{-1}^{1} \\hat{u}(\\xi) \\hat{v}(\\xi) \\, d\\xi$。\n\n设局部等参逼近空间为参考多项式 $\\mathbb{P}_{1}$ 张成的空间，由 $V_{h} = \\operatorname{span}\\{ \\phi_{1}(\\xi), \\phi_{2}(\\xi) \\}$ 给出，其中 $\\phi_{1}(\\xi) = 1$ 且 $\\phi_{2}(\\xi) = \\xi$。考虑物理单元上的目标函数，其拉回形式定义为 $\\hat{f}(\\xi) = \\xi + \\xi^{2}$。\n\n定义 $f$ 到 $V_{h}$ 上的两个最佳逼近（正交投影）：\n1. 弯曲元 $L^{2}$ 投影 $P_{J} f \\in V_{h}$，它在 $L^{2}(K)$ 范数下最小化误差，等价地，在加权内积 $(\\cdot,\\cdot)_{J}$ 中满足正交性。\n2. 拉回参考内积投影 $P_{\\text{ref}} f \\in V_{h}$，它在 $(\\cdot,\\cdot)_{\\text{ref}}$ 中满足正交性。\n\n两个投影都在参考坐标中计算，形式为 $P_{J} f(\\xi) = c_{1}^{(J)} + c_{2}^{(J)} \\xi$ 和 $P_{\\text{ref}} f(\\xi) = c_{1}^{(\\text{ref})} + c_{2}^{(\\text{ref})} \\xi$，其系数由各自的内积确定。\n\n从希尔伯特空间中最佳逼近是关于所选内积的正交投影这一定义出发，推导这两个投影之差的物理 $L^{2}$ 范数平方的显式闭式解析表达式，即\n$$\nE(\\epsilon) = \\int_{K} \\big| P_{J} f(x) - P_{\\text{ref}} f(x) \\big|^{2} \\, dx = \\int_{-1}^{1} \\big| P_{J} f(\\xi) - P_{\\text{ref}} f(\\xi) \\big|^{2} J(\\xi) \\, d\\xi,\n$$\n作为 $\\epsilon$ 的函数。您的最终答案必须是关于 $\\epsilon$ 的单个闭式解析表达式，不带单位。不要进行四舍五入。", "solution": "该问题要求推导函数 $f$ 在多项式子空间 $V_h$ 上的两个最佳逼近（或正交投影）之差的 $L^2$ 范数平方。这两个投影是关于两个不同内积定义的：一个对应于真实的弯曲几何，$(\\cdot, \\cdot)_J$；另一个对应于简化的参考几何，$(\\cdot, \\cdot)_{\\text{ref}}$。\n\n待计算的量为\n$$ E(\\epsilon) = \\int_{K} \\big| P_{J} f(x) - P_{\\text{ref}} f(x) \\big|^{2} \\, dx $$\n通过使用等参映射 $x=F(\\xi)$ 进行变量替换，上式变为\n$$ E(\\epsilon) = \\int_{-1}^{1} \\big| P_{J} f(\\xi) - P_{\\text{ref}} f(\\xi) \\big|^{2} J(\\xi) \\, d\\xi = \\left( P_{J} f - P_{\\text{ref}} f, P_{J} f - P_{\\text{ref}} f \\right)_J $$\n其中 $J(\\xi) = 1 + 3 \\epsilon \\xi^{2}$。投影 $P_{J} f$ 和 $P_{\\text{ref}} f$ 是空间 $V_h = \\operatorname{span}\\{\\phi_1(\\xi), \\phi_2(\\xi)\\}$ 中的函数，其中 $\\phi_1(\\xi) = 1$ 且 $\\phi_2(\\xi) = \\xi$。设目标函数的拉回为 $\\hat{f}(\\xi) = \\xi + \\xi^2$。\n\n推导过程包括三个主要步骤：\n1.  计算投影 $P_{\\text{ref}} f$ 的系数。\n2.  计算投影 $P_{J} f$ 的系数。\n3.  计算投影之间的差，并求出 $E(\\epsilon)$ 的积分。\n\n**步骤 1：计算 $P_{\\text{ref}} f(\\xi) = c_{1}^{(\\text{ref})} + c_{2}^{(\\text{ref})} \\xi$**\n\n投影 $P_{\\text{ref}} f$ 由正交条件定义\n$$ (\\hat{f} - P_{\\text{ref}} f, v)_{\\text{ref}} = 0 \\quad \\forall v \\in V_h $$\n其中 $(\\hat{u},\\hat{v})_{\\text{ref}} = \\int_{-1}^{1} \\hat{u}(\\xi) \\hat{v}(\\xi) \\, d\\xi$。这等价于对基函数进行测试：\n$$ (\\hat{f}, \\phi_i)_{\\text{ref}} = (P_{\\text{ref}} f, \\phi_i)_{\\text{ref}} \\quad \\text{对于 } i \\in \\{1, 2\\} $$\n基函数 $\\phi_1(\\xi) = 1$ 和 $\\phi_2(\\xi) = \\xi$ 在 $[-1,1]$ 上关于 $(\\cdot, \\cdot)_{\\text{ref}}$ 内积是正交的，因为 $\\int_{-1}^{1} \\phi_1(\\xi) \\phi_2(\\xi) \\, d\\xi = \\int_{-1}^1 \\xi \\, d\\xi = 0$。\n因此，系数由下式给出：\n$$ c_{1}^{(\\text{ref})} = \\frac{(\\hat{f}, \\phi_1)_{\\text{ref}}}{(\\phi_1, \\phi_1)_{\\text{ref}}}, \\quad c_{2}^{(\\text{ref})} = \\frac{(\\hat{f}, \\phi_2)_{\\text{ref}}}{(\\phi_2, \\phi_2)_{\\text{ref}}} $$\n我们计算必要的积分：\n$$ (\\phi_1, \\phi_1)_{\\text{ref}} = \\int_{-1}^{1} 1^2 \\, d\\xi = 2 $$\n$$ (\\phi_2, \\phi_2)_{\\text{ref}} = \\int_{-1}^{1} \\xi^2 \\, d\\xi = \\left[ \\frac{\\xi^3}{3} \\right]_{-1}^{1} = \\frac{2}{3} $$\n$$ (\\hat{f}, \\phi_1)_{\\text{ref}} = \\int_{-1}^{1} (\\xi + \\xi^2) \\cdot 1 \\, d\\xi = \\left[ \\frac{\\xi^2}{2} + \\frac{\\xi^3}{3} \\right]_{-1}^{1} = \\frac{2}{3} $$\n$$ (\\hat{f}, \\phi_2)_{\\text{ref}} = \\int_{-1}^{1} (\\xi + \\xi^2) \\cdot \\xi \\, d\\xi = \\int_{-1}^{1} (\\xi^2 + \\xi^3) \\, d\\xi = \\left[ \\frac{\\xi^3}{3} + \\frac{\\xi^4}{4} \\right]_{-1}^{1} = \\frac{2}{3} $$\n系数为：\n$$ c_{1}^{(\\text{ref})} = \\frac{2/3}{2} = \\frac{1}{3} $$\n$$ c_{2}^{(\\text{ref})} = \\frac{2/3}{2/3} = 1 $$\n因此，参考投影为 $P_{\\text{ref}} f(\\xi) = \\frac{1}{3} + \\xi$。\n\n**步骤 2：计算 $P_{J} f(\\xi) = c_{1}^{(J)} + c_{2}^{(J)} \\xi$**\n\n投影 $P_{J} f$ 由使用加权内积 $(\\hat{u},\\hat{v})_{J} = \\int_{-1}^{1} \\hat{u}(\\xi) \\hat{v}(\\xi) J(\\xi) \\, d\\xi$ 的正交条件定义：\n$$ (\\hat{f} - P_{J} f, v)_J = 0 \\quad \\forall v \\in V_h $$\n这为系数 $(c_1^{(J)}, c_2^{(J)})$ 产生了一个 $2 \\times 2$ 的伽辽金系统：\n$$ \\begin{pmatrix} (\\phi_1, \\phi_1)_J  (\\phi_2, \\phi_1)_J \\\\ (\\phi_1, \\phi_2)_J  (\\phi_2, \\phi_2)_J \\end{pmatrix} \\begin{pmatrix} c_1^{(J)} \\\\ c_2^{(J)} \\end{pmatrix} = \\begin{pmatrix} (\\hat{f}, \\phi_1)_J \\\\ (\\hat{f}, \\phi_2)_J \\end{pmatrix} $$\n雅可比行列式 $J(\\xi)=1+3\\epsilon\\xi^2$ 是一个偶函数。由于 $\\phi_1$ 是偶函数而 $\\phi_2$ 是奇函数，质量矩阵的非对角项是在对称域上对奇函数的积分，因此为零：\n$$ (\\phi_1, \\phi_2)_J = (\\phi_2, \\phi_1)_J = \\int_{-1}^{1} \\xi (1+3\\epsilon\\xi^2) \\, d\\xi = 0 $$\n对角项为：\n$$ M_{11} = (\\phi_1, \\phi_1)_J = \\int_{-1}^{1} 1^2 (1+3\\epsilon\\xi^2) \\, d\\xi = \\left[ \\xi + \\epsilon\\xi^3 \\right]_{-1}^{1} = 2 + 2\\epsilon $$\n$$ M_{22} = (\\phi_2, \\phi_2)_J = \\int_{-1}^{1} \\xi^2 (1+3\\epsilon\\xi^2) \\, d\\xi = \\int_{-1}^{1} (\\xi^2+3\\epsilon\\xi^4) \\, d\\xi = \\left[ \\frac{\\xi^3}{3} + \\frac{3\\epsilon\\xi^5}{5} \\right]_{-1}^{1} = \\frac{2}{3} + \\frac{6\\epsilon}{5} $$\n右端向量的分量为：\n$$ b_1 = (\\hat{f}, \\phi_1)_J = \\int_{-1}^{1} (\\xi+\\xi^2)(1+3\\epsilon\\xi^2) \\, d\\xi = \\int_{-1}^{1} (\\xi^2 + 3\\epsilon\\xi^4 + \\text{奇次项}) \\, d\\xi = \\frac{2}{3} + \\frac{6\\epsilon}{5} $$\n$$ b_2 = (\\hat{f}, \\phi_2)_J = \\int_{-1}^{1} (\\xi+\\xi^2)\\xi(1+3\\epsilon\\xi^2) \\, d\\xi = \\int_{-1}^{1} (\\xi^2 + 3\\epsilon\\xi^4 + \\text{奇次项}) \\, d\\xi = \\frac{2}{3} + \\frac{6\\epsilon}{5} $$\n由于质量矩阵是对角矩阵，求解很简单：\n$$ c_1^{(J)} = \\frac{b_1}{M_{11}} = \\frac{\\frac{2}{3} + \\frac{6\\epsilon}{5}}{2+2\\epsilon} = \\frac{\\frac{10+18\\epsilon}{15}}{2(1+\\epsilon)} = \\frac{10+18\\epsilon}{30(1+\\epsilon)} = \\frac{5+9\\epsilon}{15(1+\\epsilon)} $$\n$$ c_2^{(J)} = \\frac{b_2}{M_{22}} = \\frac{\\frac{2}{3} + \\frac{6\\epsilon}{5}}{\\frac{2}{3} + \\frac{6\\epsilon}{5}} = 1 $$\n因此，弯曲元投影为 $P_{J} f(\\xi) = \\frac{5+9\\epsilon}{15(1+\\epsilon)} + \\xi$。\n\n**步骤 3：计算 $E(\\epsilon)$**\n\n两个投影之差为：\n$$ P_{J} f(\\xi) - P_{\\text{ref}} f(\\xi) = \\left(\\frac{5+9\\epsilon}{15(1+\\epsilon)} + \\xi\\right) - \\left(\\frac{1}{3} + \\xi\\right) = \\frac{5+9\\epsilon}{15(1+\\epsilon)} - \\frac{5(1+\\epsilon)}{15(1+\\epsilon)} = \\frac{4\\epsilon}{15(1+\\epsilon)} $$\n这个差是关于 $\\xi$ 的常数函数。令 $\\Delta P(\\xi) = \\frac{4\\epsilon}{15(1+\\epsilon)}$。\n现在我们可以计算 $E(\\epsilon)$：\n$$ E(\\epsilon) = \\int_{-1}^{1} \\big| \\Delta P(\\xi) \\big|^{2} J(\\xi) \\, d\\xi = \\int_{-1}^{1} \\left( \\frac{4\\epsilon}{15(1+\\epsilon)} \\right)^2 (1+3\\epsilon\\xi^2) \\, d\\xi $$\n常数项可以从积分中提出：\n$$ E(\\epsilon) = \\left( \\frac{4\\epsilon}{15(1+\\epsilon)} \\right)^2 \\int_{-1}^{1} (1+3\\epsilon\\xi^2) \\, d\\xi $$\n该积分恰好是质量矩阵元素 $M_{11} = (\\phi_1, \\phi_1)_J = 2+2\\epsilon$。\n代入此值：\n$$ E(\\epsilon) = \\frac{16\\epsilon^2}{225(1+\\epsilon)^2} \\cdot (2+2\\epsilon) = \\frac{16\\epsilon^2}{225(1+\\epsilon)^2} \\cdot 2(1+\\epsilon) $$\n通过消去一个因子 $(1+\\epsilon)$ 来化简表达式，得到最终结果：\n$$ E(\\epsilon) = \\frac{32\\epsilon^2}{225(1+\\epsilon)} $$\n这个表达式量化了因使用基于无权参考内积的投影，而非正确的、考虑几何的加权内积的投影所产生的误差平方，该误差是在物理单元的 $L^2$ 范数下度量的。", "answer": "$$\n\\boxed{\\frac{32\\epsilon^2}{225(1+\\epsilon)}}\n$$", "id": "3367015"}]}