{"hands_on_practices": [{"introduction": "这个实践从最简单的不连续伽勒金（DG）离散格式入手，即在每个单元上使用常数（$p=0$）来近似解。通过对这个基础模型进行冯·诺依曼分析，你将推导出其傅里叶符号，并确定前向欧拉时间积分格式的稳定性条件。[@problem_id:3426865] 这项练习不仅能让你逐步掌握完整的稳定性分析流程，还能揭示 DG($p=0$) 方法与经典的一阶迎风有限差分格式之间的深刻联系，为你理解更复杂的高阶方法奠定坚实基础。", "problem": "考虑线性平流方程 $u_{t} + a\\,u_{x} = 0$，其中平流速度 $a  0$ 为常数，定义域为周期性一维域，该域被划分为大小为 $h$ 的均匀单元网格。使用多项式次数 $p=0$（分片常数）的间断Galerkin (DG) 方法和针对 $a0$ 的迎风数值通量来离散该方程，并将得到的半离散系统写成 $M\\,\\dot{U} = K\\,U$ 的形式，其中 $M$ 是单元质量矩阵，$K$ 是由数值通量引起的刚度算子。\n\n请分析两种常见的修正方法如何影响半离散算子、其傅里叶符号以及平流问题所允许的显式时间步长：\n- 对角预处理：定义对称预处理算子 $B := M^{-1/2} K M^{-1/2}$。\n- 质量集中：用对角近似 $L$ 替换 $M$，并用 $L^{-1}K$ 进行演化。\n\n通过考虑形式为 $U_{j}(t) = \\widehat{U}(t)\\,\\exp(i \\kappa j h)$ 的平面波解来进行 von Neumann 傅里叶分析，其中 $j$ 是单元索引，$\\kappa$ 是连续波数，$\\theta := \\kappa h \\in [-\\pi, \\pi]$ 是以弧度为单位的无量纲波数。从 DG 弱形式和上述定义出发，推导：\n1. 此 DG 离散化中 $M$ 和 $K$ 的显式形式，以及相应的演化算子 $A := M^{-1}K$。\n2. $A$ 的傅里叶符号 $\\lambda(\\theta)$，以及由 $\\lambda(\\theta) = -i\\,a\\,k_{\\mathrm{eff}}(\\theta) + \\text{dissipation}(\\theta)$ 定义的修正波数 $k_{\\mathrm{eff}}(\\theta)$。\n3. $A$ 和 $B$（通过对角预处理得到）的谱之间的关系，以及这对允许的前向欧拉 (FE) 时间步长的影响。\n4. 前向欧拉时间步长 $\\Delta t$ 的稳定性精确上界，该上界通过要求 FE 放大因子 $1 + \\Delta t\\,\\lambda(\\theta)$ 对所有 $\\theta \\in [-\\pi,\\pi]$ 保持在 FE 稳定域内得到。\n\n请用一个关于 $h$ 和 $a$ 的单一闭式解析表达式给出最大允许时间步长 $\\Delta t_{\\max}$ 作为最终答案。无需进行数值代入。清晰地陈述所有中间步骤和假设，并以无单位形式表示答案。如果出现任何角度量，请明确将其视为弧度。最终答案必须是单一表达式。", "solution": "该问题要求分析多项式次数 $p=0$ 的间断Galerkin (DG) 方法应用于一维线性平流方程 $u_t + a u_x = 0$ 的情况，其中平流速度 $a$ 是一个正常数。分析内容包括推导半离散算子，进行 von Neumann 稳定性分析，以及确定前向欧拉法的最大稳定时间步长。\n\n### 第一步：半离散系统的推导\n\n在大小为 $h = x_{j+1/2} - x_{j-1/2}$ 的均匀网格单元 $I_j = [x_{j-1/2}, x_{j+1/2}]$ 上的 DG 弱形式为：从有限维空间 $V_h$ 中找到近似解 $u_h$，使得对于每个测试函数 $v_h \\in V_h$，\n$$\n\\int_{I_j} \\frac{\\partial u_h}{\\partial t} v_h \\, dx - \\int_{I_j} a u_h \\frac{\\partial v_h}{\\partial x} \\, dx + \\left[ a u_h^* v_h \\right]_{x_{j-1/2}}^{x_{j+1/2}} = 0\n$$\n其中 $u_h^*$ 是单元界面上的数值通量。\n\n对于多项式次数 $p=0$，解 $u_h$ 和测试函数 $v_h$ 都是分片常数。在单元 $I_j$ 上，我们将解表示为 $u_h(x,t) = U_j(t)$（对于 $x \\in I_j$）。基函数是指示函数 $\\phi_j(x)$，当 $x \\in I_j$ 时为 $1$，否则为 $0$。我们选择测试函数为 $v_h(x) = \\phi_j(x)$。\n\n将这些代入弱形式：\n1.  第一项是 $\\int_{I_j} \\frac{d U_j}{dt} \\cdot 1 \\, dx = \\dot{U}_j \\int_{I_j} dx = h \\dot{U}_j$。\n2.  第二项是 $- \\int_{I_j} a U_j \\frac{\\partial \\phi_j}{\\partial x} \\, dx = 0$，因为在单元 $I_j$ 内部 $\\frac{\\partial \\phi_j}{\\partial x} = 0$。\n3.  第三项代表在单元边界上的通量贡献：\n    $$\n    \\left[ a u_h^* v_h \\right]_{x_{j-1/2}}^{x_{j+1/2}} = a u_h^*(x_{j+1/2}, t) v_h(x_{j+1/2}^-) - a u_h^*(x_{j-1/2}, t) v_h(x_{j-1/2}^+)\n    $$\n    由于 $v_h(x_{j+1/2}^-) = \\phi_j(x_{j+1/2}^-) = 1$ 且 $v_h(x_{j-1/2}^+) = \\phi_j(x_{j-1/2}^+) = 1$，该项变为 $a u_h^*(x_{j+1/2}, t) - a u_h^*(x_{j-1/2}, t)$。\n\n问题指定了迎风数值通量。由于 $a  0$，信息从左向右传播。界面处的迎风通量是来自迎风（左）侧的解的值。\n在界面 $x_{j+1/2}$ 处，迎风值为 $u_h(x_{j+1/2}^-) = U_j(t)$。\n在界面 $x_{j-1/2}$ 处，迎风值为 $u_h(x_{j-1/2}^-) = U_{j-1}(t)$。\n因此，数值通量为 $u_h^*(x_{j+1/2}, t) = U_j(t)$ 和 $u_h^*(x_{j-1/2}, t) = U_{j-1}(t)$。\n\n结合这些项，单元 $j$ 的半离散方程为：\n$$\nh \\dot{U}_j + a U_j - a U_{j-1} = 0\n$$\n将其整理为 $M \\dot{U} = K U$ 的形式：\n$$\nh \\dot{U}_j = a U_{j-1} - a U_j\n$$\n左侧对应于质量矩阵算子。质量矩阵 $M$ 的 $(j,k)$ 元为 $M_{jk} = \\int_{\\Omega} \\phi_j \\phi_k \\, dx$。对于 $p=0$，基函数具有不交的支集，因此当 $j \\neq k$ 时 $M_{jk}=0$。对角元为 $M_{jj} = \\int_{I_j} 1 \\cdot 1 \\, dx = h$。因此，质量矩阵为 $M = hI$，其中 $I$ 是单位矩阵。\n\n右侧对应于刚度算子 $K$。向量 $KU$ 的第 $j$ 行为 $a U_{j-1} - a U_j$。这意味着矩阵 $K$ 的对角元为 $K_{jj} = -a$，次对角元为 $K_{j, j-1} = a$。所有其他元均为零。\n\n演化算子为 $A := M^{-1}K$。由于 $M=hI$，其逆为 $M^{-1} = \\frac{1}{h}I$。\n$$ A = \\frac{1}{h}K $$\n半离散系统可以写为 $\\dot{U} = A U$，对单元 $j$ 而言是：\n$$ \\dot{U}_j = \\frac{a}{h}(U_{j-1} - U_j) $$\n这与一阶迎风有限差分格式相同。\n\n### 第二步：傅里叶符号和修正波数\n\n我们通过将平面波解 $U_j(t) = \\widehat{U}(t) \\exp(i\\kappa j h)$ 代入半离散方程来进行 von Neumann 傅里叶分析，其中 $\\kappa$ 是波数，$\\theta := \\kappa h$ 是无量纲波数。\n$$\n\\frac{d}{dt} \\left( \\widehat{U}(t) e^{i\\kappa j h} \\right) = \\frac{a}{h} \\left( \\widehat{U}(t) e^{i\\kappa (j-1) h} - \\widehat{U}(t) e^{i\\kappa j h} \\right)\n$$\n$$\n\\dot{\\widehat{U}}(t) e^{i\\kappa j h} = \\frac{a}{h} \\widehat{U}(t) e^{i\\kappa j h} \\left( e^{-i\\kappa h} - 1 \\right)\n$$\n两边同除以 $\\widehat{U}(t) e^{i\\kappa j h}$，得到傅里叶振幅的演化方程 $\\dot{\\widehat{U}}(t) = \\lambda(\\theta) \\widehat{U}(t)$。算子 $A$ 的傅里叶符号（特征值）$\\lambda(\\theta)$ 为：\n$$\n\\lambda(\\theta) = \\frac{a}{h} (e^{-i\\theta} - 1)\n$$\n我们使用 $e^{-i\\theta} = \\cos\\theta - i\\sin\\theta$ 将其分为实部和虚部：\n$$\n\\lambda(\\theta) = \\frac{a}{h} (\\cos\\theta - 1 - i\\sin\\theta) = \\frac{a}{h}(\\cos\\theta - 1) - i \\frac{a}{h}\\sin\\theta\n$$\n方程 $u_t+au_x=0$ 的精确解具有纯虚数傅里叶符号 $-ia\\kappa$。数值符号有一个代表数值耗散的实部，以及一个与数值色散相关的虚部。修正波数 $k_{\\mathrm{eff}}$ 的定义使得 $\\lambda(\\theta)$ 的虚部具有 $-ia k_{\\mathrm{eff}}$ 的形式。\n$$\n-a k_{\\mathrm{eff}}(\\theta) = \\text{Im}[\\lambda(\\theta)] = - \\frac{a}{h} \\sin\\theta\n$$\n求解 $k_{\\mathrm{eff}}$ 可得：\n$$\nk_{\\mathrm{eff}}(\\theta) = \\frac{\\sin\\theta}{h}\n$$\n$\\lambda(\\theta)$ 的实部 $\\text{Re}[\\lambda(\\theta)] = \\frac{a}{h}(\\cos\\theta-1)$ 代表数值耗散。由于 $a0$，$h0$ 且 $\\cos\\theta-1 \\le 0$，实部为非正，表明该格式是耗散的。\n\n### 第三步：算子修正分析\n\n问题提到了两种修正：对角预处理和质量集中。\n- **对角预处理**：算子 $B$ 定义为 $B := M^{-1/2} K M^{-1/2}$。对于 $p=0$ 的情况，$M=hI$ 本身就是对角的。所以，$M^{-1/2} = (1/\\sqrt{h})I$。\n$$\nB = \\left( \\frac{1}{\\sqrt{h}}I \\right) K \\left( \\frac{1}{\\sqrt{h}}I \\right) = \\frac{1}{h}K\n$$\n这与原始演化算子 $A = M^{-1}K = \\frac{1}{h}K$ 相同。因此，对于 $p=0$，$A=B$。一般来说，$A=M^{-1}K$ 通过相似变换 $B = M^{1/2} A M^{-1/2}$ 与对称矩阵 $B$ 相关联，这意味着 $A$ 和 $B$ 具有相同的谱（特征值）。在我们的情况下，由于算子相同，这一点显然成立。对前向欧拉时间步长的影响是，稳定性限制（取决于演化算子的谱）对于 $A$ 和 $B$ 都是相同的。\n\n- **质量集中**：这涉及用对角近似 $L$ 替换一致质量矩阵 $M$。对于 $p=0$ 的 DG 方法，一致质量矩阵 $M=hI$ 内在地是对角的。因此，任何标准的质量集中过程（例如，行和集中）都会得到 $L=M$。“质量集中”算子 $L^{-1}K$ 与 $M^{-1}K=A$ 相同。\n\n总之，对于 $p=0$ 的特定情况，提出的两种修正都不会改变半离散演化算子 $A$。\n\n### 第四步：前向欧拉时间步长限制\n\n对于 $\\dot{U} = AU$ 的前向欧拉时间步进格式是 $U^{n+1} = U^n + \\Delta t A U^n$。波数为 $\\kappa$ 的模态被因子 $G(\\theta) = 1 + \\Delta t \\lambda(\\theta)$ 放大。为保证稳定性，该放大因子的模对于任何模态都不能超过 $1$，即对于所有 $\\theta \\in [-\\pi, \\pi]$，$|G(\\theta)| \\le 1$。\n$$\n|1 + \\Delta t \\lambda(\\theta)| \\le 1\n$$\n代入 $\\lambda(\\theta) = \\frac{a}{h}(e^{-i\\theta} - 1)$：\n$$\n\\left|1 + \\frac{a \\Delta t}{h}(e^{-i\\theta} - 1)\\right| \\le 1\n$$\n令 $C = \\frac{a \\Delta t}{h}$ 为库朗数。不等式变为：\n$$\n|1 + C(e^{-i\\theta} - 1)| \\le 1\n$$\n我们来几何地分析这个问题。复数 $z = \\Delta t \\lambda(\\theta) = C(e^{-i\\theta}-1)$ 必须位于前向欧拉稳定域内，该稳定域是复平面上以 $-1$ 为中心、半径为 $1$ 的圆盘。\n当 $\\theta$ 变化时，$e^{-i\\theta}$ 描绘出单位圆。项 $e^{-i\\theta}-1$ 描绘出以 $-1$ 为中心、半径为 $1$ 的圆。项 $C(e^{-i\\theta}-1)$ 描绘出以 $-C$ 为中心、半径为 $C$ 的圆。\n为了使这个特征值圆（域 $L$）被包含在稳定域圆盘（域 $S$）内，其最左点必须在 $S$ 的最左点之内。\n$L$ 的最左点在 $-2C$。\n$S$ 的最左点在 $-2$。\n条件是 $-2C \\ge -2$，简化为 $C \\le 1$。\n\n或者，我们可以进行代数推导：\n$$\n| (1 - C + C\\cos\\theta) - i(C\\sin\\theta) |^2 \\le 1\n$$\n$$\n(1 - C + C\\cos\\theta)^2 + (C\\sin\\theta)^2 \\le 1\n$$\n$$\n(1-C)^2 + 2C(1-C)\\cos\\theta + C^2\\cos^2\\theta + C^2\\sin^2\\theta \\le 1\n$$\n$$\n1 - 2C + C^2 + 2C(1-C)\\cos\\theta + C^2 \\le 1\n$$\n$$\n-2C + 2C^2 + 2C(1-C)\\cos\\theta \\le 0\n$$\n由于 $C  0$，我们可以两边同除以 $2C$：\n$$\n-1 + C + (1-C)\\cos\\theta \\le 0\n$$\n$$\n(C-1) - (C-1)\\cos\\theta \\le 0\n$$\n$$\n(C-1)(1-\\cos\\theta) \\le 0\n$$\n由于对于所有实数 $\\theta$，$1-\\cos\\theta \\ge 0$，而我们需要该不等式对所有 $\\theta$ 都成立，因此必须确保另一个因子为非正。\n$$ C-1 \\le 0 \\implies C \\le 1 $$\n库朗数必须小于或等于 $1$。\n$$\n\\frac{a \\Delta t}{h} \\le 1\n$$\n这给出了稳定性的最大允许时间步长：\n$$\n\\Delta t_{\\max} = \\frac{h}{a}\n$$", "answer": "$$\\boxed{\\frac{h}{a}}$$", "id": "3426865"}, {"introduction": "在掌握了最简单的情况后，我们将挑战提升到更高阶的 $p=1$ 多项式近似。在这个练习中，你需要为这个高阶DG格式推导其离散算子的块符号（block symbol）。[@problem_id:3426843] 这是理解冯·诺依曼分析如何应用于高阶方法的关键一步，因为当每个单元包含多个自由度时，算子的符号就不再是标量，而是一个矩阵。掌握块符号及其特征值的推导，是分析任何高阶DG格式稳定性和色散性质的核心技能。", "problem": "考虑一维线性平流方程 $u_t + a u_x = 0$，该方程建立在具有均匀网格（单元尺寸为 $h$）的周期性域上，其中 $a0$ 是一个恒定的平流速度。在每个单元上使用多项式次数为 $p=1$ 的间断Galerkin (DG) 方法，采用参考单元映射 $x = x_j + \\frac{h}{2}\\,\\xi$（其中 $\\xi \\in [-1,1]$）和局部基 $\\{\\phi_0(\\xi), \\phi_1(\\xi)\\} = \\{1, \\xi\\}$。采用与 $a0$ 对应的迎风数值通量，因此 $x_{j+1/2}$ 处的数值界面值为左侧单元的迹。\n\n从弱形式出发，并使用 von Neumann (傅里叶) 分析，其中无量纲波数为 $\\theta = k h$（取 $\\theta$ 为弧度），推导此 $p=1$ 格式的半离散DG块符号，并获得其作为 $\\theta$ 函数的特征值。将您的最终答案表示为半离散算子的一对特征值 $\\lambda_{\\pm}(\\theta)$，以 $a$、$h$ 和 $\\theta$ 的闭合形式写出。最终答案中不应出现任何中间结果或证明。不需要四舍五入，最终表达式中也不应包含任何物理单位。", "solution": "用户希望找到应用于一维线性平流方程的间断Galerkin (DG) 方法的半离散算子的特征值。\n\n### 第1步：问题陈述的验证\n\n问题陈述提供了以下信息：\n- **PDE**：一维线性平流方程 $u_t + a u_x = 0$，具有恒定的平流速度 $a0$。\n- **域和网格**：具有均匀网格（单元尺寸为 $h$）的周期性域。\n- **数值方法**：间断Galerkin (DG) 方法。\n- **多项式次数**：$p=1$。\n- **参考单元**：从参考单元 $\\xi \\in [-1,1]$ 到物理单元 $K_j$ 的映射为 $x = x_j + \\frac{h}{2}\\,\\xi$。单元中心为 $x_j$，边界为 $x_{j \\pm 1/2} = x_j \\pm h/2$。\n- **局部基**：参考单元上的基函数为 $\\{\\phi_0(\\xi), \\phi_1(\\xi)\\} = \\{1, \\xi\\}$。\n- **数值通量**：对于 $a0$ 的迎风通量。界面处的值取自左侧单元的迹。\n- **分析方法**：使用无量纲波数 $\\theta = k h$ 的 von Neumann (傅里叶) 分析。\n\n该问题具有科学依据，是偏微分方程数值分析中的一个标准课题。它的设定是合理的，目标明确，并提供了足够的信息来推导唯一的特征值解。该领域的术语和设置是谱方法和间断Galerkin方法中的标准。问题是客观的，没有歧义。因此，该问题被认为是有效的。\n\n### 第2步：半离散DG公式的推导\n\nDG方法从每个单元 $K_j = [x_j - h/2, x_j + h/2]$ 上的偏微分方程的弱形式开始。我们将偏微分方程乘以与解 $u_h$ 属于同一多项式空间的测试函数 $v_h$，并在 $K_j$ 上积分。\n$$ \\int_{K_j} (u_t + a u_x) v_h \\, dx = 0 $$\n对空间项进行分部积分可得：\n$$ \\int_{K_j} u_t v_h \\, dx + \\left[ a u_h v_h \\right]_{x_{j-1/2}}^{x_{j+1/2}} - \\int_{K_j} a u_h (v_h)_x \\, dx = 0 $$\n离散解 $u_h$ 在单元边界上是不连续的。我们将边界上的 $u_h$ 替换为数值通量，记作 $\\hat{u}$。弱形式变为：\n$$ \\int_{K_j} (u_h)_t v_h \\, dx + a \\hat{u}_{j+1/2} v_h(x_{j+1/2}^-) - a \\hat{u}_{j-1/2} v_h(x_{j-1/2}^+) - \\int_{K_j} a u_h (v_h)_x \\, dx = 0 $$\n问题指定了对于 $a0$ 的迎风通量。界面处的值取自迎风（左）侧。\n- 在界面 $x_{j+1/2}$ 处，迎风单元是 $K_j$。因此，$\\hat{u}_{j+1/2} = u_h(x_{j+1/2}^-)$，这是来自单元 $K_j$ 内部的解在其右边界的迹。\n- 在界面 $x_{j-1/2}$ 处，迎风单元是 $K_{j-1}$。因此，$\\hat{u}_{j-1/2} = u_h(x_{j-1/2}^-)$，这是来自单元 $K_{j-1}$ 的解在其右边界的迹。\n\n令 $u_j(x)$ 为单元 $K_j$ 中解的局部多项式表示。单元 $K_j$ 的弱形式为：\n$$ \\int_{K_j} \\frac{\\partial u_j}{\\partial t} v_j \\, dx - \\int_{K_j} a u_j \\frac{\\partial v_j}{\\partial x} \\, dx + a u_j(x_{j+1/2}) v_j(x_{j+1/2}) - a u_{j-1}(x_{j-1/2}) v_j(x_{j-1/2}) = 0 $$\n我们使用映射 $x(\\xi) = x_j + \\frac{h}{2}\\xi$ 将此方程转换到参考单元 $\\xi \\in [-1,1]$ 上。这表示 $dx = \\frac{h}{2}d\\xi$ 和 $\\frac{\\partial}{\\partial x} = \\frac{2}{h}\\frac{\\partial}{\\partial \\xi}$。局部解为 $u_j(\\xi) = u_{j,0}\\phi_0(\\xi) + u_{j,1}\\phi_1(\\xi) = u_{j,0} + u_{j,1}\\xi$。测试函数 $v_j$ 是基函数 $\\phi_0$ 和 $\\phi_1$。\n界面 $x_{j+1/2}$ 对应于单元 $K_j$ 中的 $\\xi=1$。界面 $x_{j-1/2}$ 对应于单元 $K_j$ 中的 $\\xi=-1$，以及单元 $K_{j-1}$ 中的 $\\xi=1$。\n参考单元上的弱形式是：\n$$ \\frac{h}{2} \\int_{-1}^1 \\frac{\\partial u_j}{\\partial t} v_j \\, d\\xi - a \\int_{-1}^1 u_j \\frac{\\partial v_j}{\\partial \\xi} \\, d\\xi + a u_j(\\xi=1) v_j(\\xi=1) - a u_{j-1}(\\xi=1) v_j(\\xi=-1) = 0 $$\n令 $\\mathbf{u}_j(t) = \\begin{pmatrix} u_{j,0}(t) \\\\ u_{j,1}(t) \\end{pmatrix}$。我们对 $v_j = \\phi_0=1$ 和 $v_j = \\phi_1=\\xi$ 进行测试。\n\n对于 $v_j=\\phi_0=1$：\n第一项是 $\\frac{h}{2} \\int_{-1}^1 (\\dot{u}_{j,0} + \\dot{u}_{j,1}\\xi) \\cdot 1 \\, d\\xi = \\frac{h}{2} (2\\dot{u}_{j,0}) = h\\dot{u}_{j,0}$。\n第二项是 $-a \\int_{-1}^1 (u_{j,0}+u_{j,1}\\xi) \\cdot 0 \\, d\\xi = 0$。\n边界项是 $a u_j(1)\\phi_0(1) - a u_{j-1}(1)\\phi_0(-1) = a (u_{j,0}+u_{j,1}) - a (u_{j-1,0}+u_{j-1,1})$。\n关于 $\\dot{u}_{j,0}$ 的方程：\n$$ h\\dot{u}_{j,0} + a(u_{j,0}+u_{j,1}) - a(u_{j-1,0}+u_{j-1,1}) = 0 $$\n$$ \\dot{u}_{j,0} = -\\frac{a}{h}(u_{j,0}+u_{j,1}) + \\frac{a}{h}(u_{j-1,0}+u_{j-1,1}) $$\n\n对于 $v_j=\\phi_1=\\xi$：\n第一项是 $\\frac{h}{2} \\int_{-1}^1 (\\dot{u}_{j,0} + \\dot{u}_{j,1}\\xi)\\xi \\, d\\xi = \\frac{h}{2} (\\frac{2}{3}\\dot{u}_{j,1}) = \\frac{h}{3}\\dot{u}_{j,1}$。\n第二项是 $-a \\int_{-1}^1 (u_{j,0}+u_{j,1}\\xi) \\cdot 1 \\, d\\xi = -a (2u_{j,0})$。\n边界项是 $a u_j(1)\\phi_1(1) - a u_{j-1}(1)\\phi_1(-1) = a (u_{j,0}+u_{j,1})(1) - a (u_{j-1,0}+u_{j-1,1})(-1) = a(u_{j,0}+u_{j,1}) + a(u_{j-1,0}+u_{j-1,1})$。\n关于 $\\dot{u}_{j,1}$ 的方程：\n$$ \\frac{h}{3}\\dot{u}_{j,1} - 2au_{j,0} + a(u_{j,0}+u_{j,1}) + a(u_{j-1,0}+u_{j-1,1}) = 0 $$\n$$ \\frac{h}{3}\\dot{u}_{j,1} = a(u_{j,0}-u_{j,1}) - a(u_{j-1,0}+u_{j-1,1}) $$\n$$ \\dot{u}_{j,1} = \\frac{3a}{h}(u_{j,0}-u_{j,1}) - \\frac{3a}{h}(u_{j-1,0}+u_{j-1,1}) $$\n矩阵形式的半离散系统为 $\\frac{d\\mathbf{u}_j}{dt} = A_0 \\mathbf{u}_j + A_1 \\mathbf{u}_{j-1}$，其中：\n$$ A_0 = \\frac{a}{h} \\begin{pmatrix} -1  -1 \\\\ 3  -3 \\end{pmatrix}, \\quad A_1 = \\frac{a}{h} \\begin{pmatrix} 1  1 \\\\ -3  -3 \\end{pmatrix} $$\n\n### 第3步：Von Neumann分析与特征值计算\n\n对于 von Neumann 分析，我们寻求形式为 $\\mathbf{u}_j(t) = \\hat{\\mathbf{u}} e^{\\lambda t} e^{ij\\theta}$ 的解，其中 $\\theta=kh$。将其代入半离散系统可得：\n$$ \\lambda \\hat{\\mathbf{u}} e^{\\lambda t} e^{ij\\theta} = A_0 \\hat{\\mathbf{u}} e^{\\lambda t} e^{ij\\theta} + A_1 \\hat{\\mathbf{u}} e^{\\lambda t} e^{i(j-1)\\theta} $$\n两边除以 $e^{\\lambda t} e^{ij\\theta}$，我们得到一个关于 $\\hat{\\mathbf{u}}$ 的特征值问题：\n$$ \\lambda \\hat{\\mathbf{u}} = (A_0 + e^{-i\\theta} A_1) \\hat{\\mathbf{u}} $$\n矩阵 $S(\\theta) = A_0 + e^{-i\\theta} A_1$ 是半离散算子的块符号。特征值 $\\lambda(\\theta)$ 是该矩阵的特征值。\n令 $z = e^{-i\\theta}$。\n$$ S(\\theta) = \\frac{a}{h} \\left[ \\begin{pmatrix} -1  -1 \\\\ 3  -3 \\end{pmatrix} + z \\begin{pmatrix} 1  1 \\\\ -3  -3 \\end{pmatrix} \\right] = \\frac{a}{h} \\begin{pmatrix} z-1  z-1 \\\\ 3-3z  -3-3z \\end{pmatrix} = \\frac{a}{h} \\begin{pmatrix} z-1  z-1 \\\\ -3(z-1)  -3(1+z) \\end{pmatrix} $$\n令 $\\lambda' = \\lambda \\frac{h}{a}$。矩阵 $M' = \\frac{h}{a}S(\\theta)$ 的特征值为 $\\lambda'$。\n$$ M' = \\begin{pmatrix} z-1  z-1 \\\\ -3(z-1)  -3(1+z) \\end{pmatrix} $$\n特征值由特征方程 $\\det(M' - \\lambda' I) = 0$ 求得。\n$$ (z-1-\\lambda')(-3(1+z)-\\lambda') - (z-1)(-3(z-1)) = 0 $$\n$$ (z-1-\\lambda')(-3-3z-\\lambda') + 3(z-1)^2 = 0 $$\n$$ (\\lambda')^2 - \\lambda'(z-1-3-3z) + (z-1)(-3-3z) + 3(z-1)^2 = 0 $$\n$$ (\\lambda')^2 - \\lambda'(-4-2z) -3(z-1)(z+1) + 3(z-1)^2 = 0 $$\n$$ (\\lambda')^2 + (4+2z)\\lambda' -3(z^2-1) + 3(z^2-2z+1) = 0 $$\n$$ (\\lambda')^2 + (4+2z)\\lambda' -3z^2+3 + 3z^2-6z+3 = 0 $$\n$$ (\\lambda')^2 + (4+2z)\\lambda' + (6-6z) = 0 $$\n我们求解这个关于 $\\lambda'$ 的二次方程：\n$$ \\lambda' = \\frac{-(4+2z) \\pm \\sqrt{(4+2z)^2 - 4(6-6z)}}{2} $$\n$$ \\lambda' = \\frac{-4-2z \\pm \\sqrt{16+16z+4z^2 - 24+24z}}{2} $$\n$$ \\lambda' = \\frac{-4-2z \\pm \\sqrt{4z^2+40z-8}}{2} $$\n$$ \\lambda' = -2-z \\pm \\sqrt{z^2+10z-2} $$\n代回 $\\lambda = \\frac{a}{h}\\lambda'$ 和 $z = e^{-i\\theta}$：\n$$ \\lambda_{\\pm}(\\theta) = \\frac{a}{h} \\left( -2-e^{-i\\theta} \\pm \\sqrt{(e^{-i\\theta})^2+10e^{-i\\theta}-2} \\right) $$\n$$ \\lambda_{\\pm}(\\theta) = \\frac{a}{h} \\left( -(2+e^{-i\\theta}) \\pm \\sqrt{e^{-2i\\theta}+10e^{-i\\theta}-2} \\right) $$\n这是半离散算子两个特征值的最终闭合形式表达式。", "answer": "$$\\boxed{\\lambda_{\\pm}(\\theta) = \\frac{a}{h} \\left( -2-e^{-i\\theta} \\pm \\sqrt{e^{-2i\\theta}+10e^{-i\\theta}-2} \\right)}$$", "id": "3426843"}, {"introduction": "这项实践旨在连接抽象的谱分析理论与数值模拟的实际应用。它将复杂的符号计算结果抽象为一个谱半径的标度律，并要求你利用这一信息来做出设计决策。[@problem_id:3426857] 具体来说，你需要在给定的时间步长（以CFL数 $\\nu$ 体现）和显式时间积分格式（以其稳定性域半径 $r_{\\mathrm{in}}$ 体现）下，确定能够保证数值稳定性的最高多项式阶数 $p$。这项练习展示了稳定性分析的实用价值，促使你综合运用空间算子谱特性和时间积分器稳定域的知识，为高阶方法的参数选择做出明智的权衡。", "problem": "考虑线性平流方程 $u_{t} + a\\,u_{x} = 0$，其中波速 $a0$ 为常数，方程定义在一个周期性区域上，该区域由单元尺寸为 $h$ 的均匀网格离散。在每个单元内，用 $p$ 次多项式逼近 $u$，并使用标准的节点间断伽辽金(DG)方法，该方法采用精确质量和如下数值通量\n$$\nf^{\\ast} = a\\,\\{u\\} - \\frac{\\alpha\\,a}{2}\\,[u],\n$$\n其中 $\\{u\\}$ 和 $[u]$ 分别表示 $u$ 跨越界面的平均值和跳跃值，$\\alpha \\in [0,1]$ 是一个参数，用于在中心通量($\\alpha=0$)和完全迎风通量($\\alpha=1$)之间进行插值。时间积分通过一个固定的显式Runge-Kutta方法进行，其绝对稳定区域 $\\mathcal{S}_{\\mathrm{RK}}$ 包含一个以原点为中心、半径为 $r_{\\mathrm{in}}0$ 的最大闭圆盘。\n\n定义 Courant–Friedrichs–Lewy (CFL) 数 $\\nu := a\\,\\Delta t / h$，其中 $\\Delta t$ 是时间步长。令 $\\lambda_{\\mathrm{DG},p}(\\theta)$ 表示 DG 半离散算子的任一特征值（作为通过 von Neumann 分析得到的无量纲波数 $\\theta \\in [-\\pi,\\pi]$ 的函数），并定义最坏情况下的无量纲谱半径\n$$\n\\rho_{p} := \\max_{\\theta \\in [-\\pi,\\pi]} \\frac{h}{a}\\,|\\lambda_{\\mathrm{DG},p}(\\theta)|.\n$$\n已知存在一个依赖于通量的常数 $\\kappa(\\alpha) \\geq 1$，使得\n$$\n\\rho_{p} \\leq \\kappa(\\alpha)\\,(2p+1).\n$$\n从绝对稳定区域和 von Neumann 放大因子的定义出发，推导关于 $\\nu$ 的稳定性要求（用 $r_{\\mathrm{in}}$、$\\kappa(\\alpha)$ 和 $p$ 表示），然后求解最大的容许的多项式次数 $p$ (记为 $p_{\\max}$)，该次数要保证 $\\Delta t\\,\\max_{\\theta}|\\lambda_{\\mathrm{DG},p}(\\theta)|$ 位于 $\\mathcal{S}_{\\mathrm{RK}}$ 内。将你的最终答案表示为关于 $\\nu$、$r_{\\mathrm{in}}$ 和 $\\kappa(\\alpha)$ 的 $p_{\\max}$ 的单个闭式解析表达式。\n\n在你的推导中，从显式Runge-Kutta方法的绝对稳定性和线性常系数格式的von Neumann稳定性的基本定义开始。使用修正波数的观点来证明最坏情况下谱半径随 $p$ 的缩放关系，但不要在没有清晰论证的情况下假设任何最终结果。最后，从概念层面简要讨论 $\\alpha$ 的选择如何影响 $\\kappa(\\alpha)$，从而影响 $p_{\\max}$ 对通量选择的敏感性。不需要进行数值计算，你应该提供精确的解析表达式。不需要单位。", "solution": "该问题要求推导间断伽辽金(DG)方法的稳定性条件，并随后确定最大允许的多项式次数 $p_{\\max}$。分析始于线方法，即首先对偏微分方程进行空间离散，得到一个常微分方程组(ODEs)，然后对该方程组进行时间积分。\n\n使用DG方法对线性平流方程 $u_{t} + a\\,u_{x} = 0$ 进行半离散化，得到一个形式如下的常微分方程组：\n$$\n\\frac{d\\mathbf{u}}{dt} = \\mathbf{L}_{\\mathrm{DG},p} \\mathbf{u}\n$$\n其中 $\\mathbf{u}$ 是表示 $p$ 次多项式逼近的自由度向量，而 $\\mathbf{L}_{\\mathrm{DG},p}$ 是空间离散算子。该算子的特征值记为 $\\lambda_{\\mathrm{DG},p}$，它依赖于多项式次数 $p$ 和无量纲波数 $\\theta$。\n\n时间积分采用显式Runge-Kutta (RK)方法。全离散格式的稳定性取决于空间算子的特征值与时间积分器稳定区域之间的相互作用。对于测试方程 $y' = \\lambda y$，如果复数 $z = \\Delta t \\lambda$ 位于方法的绝对稳定区域 $\\mathcal{S}_{\\mathrm{RK}}$ 内，则显式RK方法是稳定的。对于该常微分方程组，此条件必须对算子 $\\mathbf{L}_{\\mathrm{DG},p}$ 的所有特征值都成立。因此，为使数值格式稳定，我们需要：\n$$\n\\Delta t \\lambda_{\\mathrm{DG},p}(\\theta) \\in \\mathcal{S}_{\\mathrm{RK}} \\quad \\forall \\theta \\in [-\\pi, \\pi]\n$$\n对于所有对应于空间离散化的特征值。\n\n问题陈述了稳定区域 $\\mathcal{S}_{\\mathrm{RK}}$ 包含一个以原点为中心、半径为 $r_{\\mathrm{in}}  0$ 的最大闭圆盘。这意味着任何满足 $|z| \\leq r_{\\mathrm{in}}$ 的复数 $z$ 都保证位于 $\\mathcal{S}_{\\mathrm{RK}}$ 内。这为稳定性提供了一个充分条件：\n$$\n|\\Delta t \\lambda_{\\mathrm{DG},p}(\\theta)| \\leq r_{\\mathrm{in}} \\quad \\forall \\theta \\in [-\\pi, \\pi]\n$$\n为确保此条件对所有特征值和所有波数都成立，我们必须考虑模最大的特征值（即算子的谱半径）：\n$$\n\\Delta t \\cdot \\max_{\\theta \\in [-\\pi,\\pi]} |\\lambda_{\\mathrm{DG},p}(\\theta)| \\leq r_{\\mathrm{in}}\n$$\n\n我们可以用给定的无量纲参数来表示这个条件。CFL数是 $\\nu := a\\,\\Delta t / h$，最坏情况下的无量纲谱半径是 $\\rho_{p} := \\max_{\\theta \\in [-\\pi,\\pi]} \\frac{h}{a}\\,|\\lambda_{\\mathrm{DG},p}(\\theta)|$。\n根据 $\\rho_{p}$ 的定义，我们可以写出：\n$$\n\\max_{\\theta \\in [-\\pi,\\pi]} |\\lambda_{\\mathrm{DG},p}(\\theta)| = \\frac{a}{h} \\rho_{p}\n$$\n将此式代入稳定性条件，得到：\n$$\n\\Delta t \\left( \\frac{a}{h} \\rho_{p} \\right) \\leq r_{\\mathrm{in}}\n$$\n整理左边的项，我们识别出CFL数：\n$$\n\\left( \\frac{a \\Delta t}{h} \\right) \\rho_{p} \\leq r_{\\mathrm{in}}\n$$\n$$\n\\nu \\rho_{p} \\leq r_{\\mathrm{in}}\n$$\n这个不等式是一个普适的稳定性要求，它关联了CFL数、DG算子的谱特性以及RK方法的稳定区域。\n\n问题为无量纲谱半径提供了一个特定的界：$\\rho_{p} \\leq \\kappa(\\alpha)\\,(2p+1)$，其中 $\\kappa(\\alpha) \\geq 1$ 是一个依赖于数值通量参数 $\\alpha$ 的常数。为保证稳定性，我们可以将此上界代入我们的稳定性条件，从而得到一个更严格但充分的条件：\n$$\n\\nu \\left( \\kappa(\\alpha)\\,(2p+1) \\right) \\leq r_{\\mathrm{in}}\n$$\n这就是以 $r_{\\mathrm{in}}$、$\\kappa(\\alpha)$ 和 $p$ 表示的关于 $\\nu$ 的显式稳定性要求。\n\n最后一步是解这个不等式，求出最大的容许的多项式次数 $p$，我们将其记为 $p_{\\max}$。我们重新整理不等式以分离出 $p$：\n$$\n2p+1 \\leq \\frac{r_{\\mathrm{in}}}{\\nu \\kappa(\\alpha)}\n$$\n$$\n2p \\leq \\frac{r_{\\mathrm{in}}}{\\nu \\kappa(\\alpha)} - 1\n$$\n$$\np \\leq \\frac{1}{2} \\left( \\frac{r_{\\mathrm{in}}}{\\nu \\kappa(\\alpha)} - 1 \\right)\n$$\n由于多项式次数 $p$ 必须是非负整数，满足此条件的最大整数 $p$ 值可通过对右侧表达式取底函数（floor function）得到。我们还必须确保结果是有效的多项式次数，即非负。底函数恰当地确定了最大整数。\n因此，$p_{\\max}$ 的表达式为：\n$$\np_{\\max} = \\left\\lfloor \\frac{1}{2} \\left( \\frac{r_{\\mathrm{in}}}{\\nu \\kappa(\\alpha)} - 1 \\right) \\right\\rfloor\n$$\n此表达式在参数 $\\nu$、$r_{\\mathrm{in}}$ 和 $\\kappa(\\alpha)$ 使得底函数的参数为非负（从而至少允许 $p=0$）的假设下有效。\n\n从概念上讲，通量参数 $\\alpha$ 的选择通过常数 $\\kappa(\\alpha)$ 对稳定性有显著影响。\n当 $\\alpha=0$ 时，通量是中心的且非耗散的。$\\mathbf{L}_{\\mathrm{DG},p}$ 的特征值位于虚轴上。在这种情况下，已知DG算子的谱半径很大（在某些范数下呈 $O(p^2)$ 缩放），这意味着 $\\kappa(0)$ 将是 $\\kappa(\\alpha)$ 取值范围内的最大值。对于给定的CFL数 $\\nu$，一个大的 $\\kappa(\\alpha)$ 会导致一个小的 $p_{\\max}$，这反映了严格的稳定性约束。\n相反，当 $\\alpha=1$ 时，通量是完全迎风的，并引入了数值耗散。这种耗散将 $\\mathbf{L}_{\\mathrm{DG},p}$ 的特征值从虚轴移入复平面的左开半平面。这通常会减小谱半径（特征值的最大模）。因此，预计 $\\kappa(1)$ 会小于 $\\kappa(0)$，并且问题中给出的谱半径的 $O(p)$ 缩放关系更能代表迎风偏置格式。\n从 $p_{\\max}$ 的表达式中，我们看到它与 $\\kappa(\\alpha)$ 成反比。一个较小的 $\\kappa(\\alpha)$ 值（通过将 $\\alpha$ 增大至接近1来实现）在固定的CFL数 $\\nu$ 下允许一个较大的 $p_{\\max}$ 值。这说明了数值方法中的一个基本权衡：增加耗散（通过选择更接近1的 $\\alpha$）可以增强稳定性，从而允许使用更高阶的多项式或更大的时间步长，但代价是由于人工扩散而降低了精度。", "answer": "$$\n\\boxed{\\left\\lfloor \\frac{1}{2} \\left( \\frac{r_{\\mathrm{in}}}{\\nu \\kappa(\\alpha)} - 1 \\right) \\right\\rfloor}\n$$", "id": "3426857"}]}