{"hands_on_practices": [{"introduction": "理解一个数值格式的特性，一个强大的工具是推导其修正方程（modified equation）。修正方程揭示了该格式实际上求解的“等效”偏微分方程，从而让我们洞察其长期的行为。本练习将引导你通过泰勒展开，为经典的Lax-Wendroff格式推导其修正方程 [@problem_id:3373281]。通过识别出主导误差项，你将能够量化格式引入的数值耗散与数值频散，这让你对格式一致性的理解超越了简单的精度阶数。", "problem": "考虑常系数线性平流偏微分方程 (PDE) $u_{t} + a\\,u_{x} = 0$，其中 $a \\in \\mathbb{R}$，$a \\neq 0$，该方程建立在空间步长为 $\\Delta x$、时间步长为 $\\Delta t$ 的均匀空间网格上。令 $u^{n}_{j}$ 表示 $u(x_{j}, t^{n})$ 的数值近似，其中 $x_{j} = j \\,\\Delta x$ 且 $t^{n} = n\\,\\Delta t$。求解此PDE的基于泰勒展开的两步Lax–Wendroff格式通过以下方式更新 $u^{n}_{j}$：\n$$\nu^{n+1}_{j} \\;=\\; u^{n}_{j}\n\\;-\\;\\frac{a\\,\\Delta t}{2\\,\\Delta x}\\,\\bigl(u^{n}_{j+1} - u^{n}_{j-1}\\bigr)\n\\;+\\;\\frac{a^{2}\\,\\Delta t^{2}}{2\\,\\Delta x^{2}}\\,\\bigl(u^{n}_{j+1} - 2\\,u^{n}_{j} + u^{n}_{j-1}\\bigr).\n$$\n仅使用通过泰勒展开得到的一致性的基本定义以及修正方程的概念（一个等效的连续PDE，其光滑解在指定阶数内与数值格式一致），推导光滑函数 $u(x,t)$ 所满足的修正方程，直到并包括 $u_{t}+a\\,u_{x}$ 之外的最低阶非零偶数阶和奇数阶导数修正项。将您的结果表示为以下标准化形式\n$$\nu_{t} + a\\,u_{x} \\;=\\; \\Delta x\\,\\alpha_{2}\\,u_{xx} \\;+\\; \\Delta x^{2}\\,\\alpha_{3}\\,u_{xxx} \\;+\\; \\text{更高阶项},\n$$\n其中系数 $\\alpha_{2}$ 和 $\\alpha_{3}$ 依赖于 $a$、$\\Delta t$ 和 $\\Delta x$。指明这些项中哪些是耗散项（偶数阶导数），哪些是色散项（奇数阶导数），并明确确定 $\\alpha_{2}$ 和 $\\alpha_{3}$。您可以引入库朗数 $r = a\\,\\Delta t/\\Delta x$，但您最终的 $\\alpha_{2}$ 和 $\\alpha_{3}$ 表达式必须用 $a$、$\\Delta t$ 和 $\\Delta x$ 来量化。\n\n作为最终答案，报告包含 $\\alpha_{2}$ 和 $\\alpha_{3}$（按此顺序）的行矩阵。无需进行数值计算。", "solution": "本问题要求推导应用于线性平流方程 $u_t + a u_x = 0$ 的两步Lax-Wendroff格式的修正方程。目标是找到修正方程标准化形式中的系数 $\\alpha_2$ 和 $\\alpha_3$：\n$$\nu_{t} + a\\,u_{x} \\;=\\; \\Delta x\\,\\alpha_{2}\\,u_{xx} \\;+\\; \\Delta x^{2}\\,\\alpha_{3}\\,u_{xxx} \\;+\\; \\text{更高阶项}。\n$$\n推导过程是通过对数值格式中的每一项在点 $(x_j, t_n)$ 附近进行泰勒级数展开，假设在该点数值解 $u^n_j$ 对应于一个光滑函数 $u(x,t)$。\n\n给定的Lax-Wendroff格式为：\n$$\nu^{n+1}_{j} \\;=\\; u^{n}_{j}\n\\;-\\;\\frac{a\\,\\Delta t}{2\\,\\Delta x}\\,\\bigl(u^{n}_{j+1} - u^{n}_{j-1}\\bigr)\n\\;+\\;\\frac{a^{2}\\,\\Delta t^{2}}{2\\,\\Delta x^{2}}\\,\\bigl(u^{n}_{j+1} - 2\\,u^{n}_{j} + u^{n}_{j-1}\\bigr).\n$$\n为便于分析，我们将格式两边同除以 $\\Delta t$ 进行整理：\n$$\n\\frac{u^{n+1}_{j} - u^{n}_{j}}{\\Delta t} \\;=\\; -\\frac{a}{2\\,\\Delta x}\\,\\bigl(u^{n}_{j+1} - u^{n}_{j-1}\\bigr)\n\\;+\\;\\frac{a^{2}\\,\\Delta t}{2\\,\\Delta x^{2}}\\,\\bigl(u^{n}_{j+1} - 2\\,u^{n}_{j} + u^{n}_{j-1}\\bigr).\n$$\n现在我们将每一项在 $(x_j, t_n)$ 附近展开为泰勒级数，其中 $u$ 及其导数在该点求值。\n\n左侧（LHS）是时间导数的向前差分近似：\n$$\n\\frac{u^{n+1}_{j} - u^{n}_{j}}{\\Delta t} = \\frac{u(x_j, t_n+\\Delta t) - u(x_j, t_n)}{\\Delta t} = u_t + \\frac{\\Delta t}{2}u_{tt} + \\frac{\\Delta t^2}{6}u_{ttt} + \\mathcal{O}(\\Delta t^3).\n$$\n右侧（RHS）包含两个涉及空间差分的项。第一项是 $u_x$ 的中心差分近似：\n$$\n-\\frac{a}{2\\,\\Delta x}\\,\\bigl(u^{n}_{j+1} - u^{n}_{j-1}\\bigr) = -\\frac{a}{2\\,\\Delta x} \\left[ \\left(u + \\Delta x u_x + \\frac{\\Delta x^2}{2}u_{xx} + \\frac{\\Delta x^3}{6}u_{xxx} + \\dots \\right) - \\left(u - \\Delta x u_x + \\frac{\\Delta x^2}{2}u_{xx} - \\frac{\\Delta x^3}{6}u_{xxx} + \\dots \\right) \\right]\n$$\n$$\n= -\\frac{a}{2\\,\\Delta x} \\left( 2\\Delta x u_x + \\frac{\\Delta x^3}{3}u_{xxx} + \\dots \\right) = -a u_x - \\frac{a \\Delta x^2}{6}u_{xxx} + \\mathcal{O}(\\Delta x^4).\n$$\nRHS上的第二项是 $u_{xx}$ 的中心差分近似：\n$$\n\\frac{a^{2}\\,\\Delta t}{2\\,\\Delta x^{2}}\\,\\bigl(u^{n}_{j+1} - 2\\,u^{n}_{j} + u^{n}_{j-1}\\bigr) = \\frac{a^{2}\\,\\Delta t}{2\\,\\Delta x^{2}} \\left[ \\left(u + \\Delta x u_x + \\frac{\\Delta x^2}{2}u_{xx} + \\dots \\right) - 2u + \\left(u - \\Delta x u_x + \\frac{\\Delta x^2}{2}u_{xx} - \\dots \\right) \\right]\n$$\n$$\n= \\frac{a^{2}\\,\\Delta t}{2\\,\\Delta x^{2}} \\left( \\Delta x^2 u_{xx} + \\frac{\\Delta x^4}{12}u_{xxxx} + \\dots \\right) = \\frac{a^2 \\Delta t}{2}u_{xx} + \\frac{a^2 \\Delta t \\Delta x^2}{24}u_{xxxx} + \\mathcal{O}(\\Delta t \\Delta x^4).\n$$\n令展开后的LHS和RHS相等，得到局部截断误差的表达式：\n$$\nu_t + \\frac{\\Delta t}{2}u_{tt} + \\frac{\\Delta t^2}{6}u_{ttt} + \\dots = -a u_x + \\frac{a^2 \\Delta t}{2}u_{xx} - \\frac{a \\Delta x^2}{6}u_{xxx} + \\dots\n$$\n整理以匹配原始PDE的形式，我们得到：\n$$\nu_t + a u_x = \\left(\\frac{a^2 \\Delta t}{2}u_{xx} - \\frac{\\Delta t}{2}u_{tt}\\right) - \\frac{a \\Delta x^2}{6}u_{xxx} - \\frac{\\Delta t^2}{6}u_{ttt} + \\text{更高阶项}\n$$\n为得到修正方程，我们必须将RHS上的所有时间导数用空间导数表示。这通过对修正方程自身进行反复微分来实现。在最低阶上，修正方程为 $u_t = -a u_x$。我们用此关系来替换更高阶的时间导数。\n算子关系为 $\\frac{\\partial}{\\partial t} \\approx -a \\frac{\\partial}{\\partial x}$。\n将此应用于 $u_{tt}$ 和 $u_{ttt}$：\n$$\nu_{tt} = \\frac{\\partial}{\\partial t} u_t \\approx (-a\\frac{\\partial}{\\partial x})(-a u_x) = a^2 u_{xx}.\n$$\n$$\nu_{ttt} = \\frac{\\partial}{\\partial t} u_{tt} \\approx (-a\\frac{\\partial}{\\partial x})(a^2 u_{xx}) = -a^3 u_{xxx}.\n$$\n将这些近似值代回到 $u_t+au_x$ 的方程中：\n$$\nu_t + a u_x \\approx \\left(\\frac{a^2 \\Delta t}{2}u_{xx} - \\frac{\\Delta t}{2}(a^2 u_{xx})\\right) - \\frac{a \\Delta x^2}{6}u_{xxx} - \\frac{\\Delta t^2}{6}(-a^3 u_{xxx}).\n$$\n我们按空间导数的阶数对各项进行分组：\n二阶导数项 $u_{xx}$ 的系数为：\n$$\n\\frac{a^2 \\Delta t}{2} - \\frac{a^2 \\Delta t}{2} = 0.\n$$\n三阶导数项 $u_{xxx}$ 的系数为：\n$$\n-\\frac{a \\Delta x^2}{6} - \\frac{\\Delta t^2(-a^3)}{6} = -\\frac{a \\Delta x^2}{6} + \\frac{a^3 \\Delta t^2}{6}.\n$$\n因此，截至三阶导数项的修正方程为：\n$$\nu_t + a u_x = \\left( -\\frac{a \\Delta x^2}{6} + \\frac{a^3 \\Delta t^2}{6} \\right) u_{xxx} + \\text{更高阶项}\n$$\n这个方程揭示了主阶误差的性质。偶数阶导数项（$u_{xx}$），对应于数值耗散，其系数为零。奇数阶导数项（$u_{xxx}$），对应于数值色散，其系数非零（除非库朗数 $r = a\\Delta t / \\Delta x$ 的绝对值为1）。这表明该格式是色散的。最低阶非零偶数阶导数项是四阶项（$u_{xxxx}$），这确保了当 $|r|1$ 时格式是耗散的。\n\n现在我们将我们的结果与指定的标准化形式进行匹配：\n$$\nu_{t} + a\\,u_{x} \\;=\\; \\Delta x\\,\\alpha_{2}\\,u_{xx} \\;+\\; \\Delta x^{2}\\,\\alpha_{3}\\,u_{xxx} \\;+\\; \\text{更高阶项}\n$$\n通过比较系数，我们找到 $\\alpha_2$ 和 $\\alpha_3$。\n对于 $u_{xx}$ 项：\n$$\n\\Delta x\\,\\alpha_{2} = 0 \\quad \\implies \\quad \\alpha_{2} = 0.\n$$\n对于 $u_{xxx}$ 项：\n$$\n\\Delta x^{2}\\,\\alpha_{3} = -\\frac{a \\Delta x^2}{6} + \\frac{a^3 \\Delta t^2}{6}.\n$$\n求解 $\\alpha_3$：\n$$\n\\alpha_{3} = \\frac{1}{\\Delta x^2} \\left( -\\frac{a \\Delta x^2}{6} + \\frac{a^3 \\Delta t^2}{6} \\right) = -\\frac{a}{6} + \\frac{a^3 \\Delta t^2}{6 \\Delta x^2}.\n$$\n因此系数被确定。$\\alpha_2$ 为零，表示不存在二阶数值耗散。$\\alpha_3$ 通常非零，表示存在三阶数值色散。\n\n系数的最终表达式为：\n$\\alpha_2 = 0$。\n$\\alpha_3 = \\frac{a^3 \\Delta t^2}{6 \\Delta x^2} - \\frac{a}{6}$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  \\frac{a^{3} \\Delta t^{2}}{6 \\Delta x^{2}} - \\frac{a}{6}\n\\end{pmatrix}\n}\n$$", "id": "3373281"}, {"introduction": "在研究了局部截断误差（一致性）之后，我们转向稳定性分析，它决定了误差在时间上如何传播。本练习将运用冯·诺伊曼（von Neumann）稳定性分析，研究一种将无耗散的谱方法空间离散与显式的欧拉前向时间积分相结合的格式 [@problem_id:3373430]。通过推导其放大因子，你将发现一个关键的数值分析原理：对于双曲问题，将一个非耗散的空间格式与一个稳定性区域不足以覆盖虚轴相关部分的显式时间积分格式相结合，会导致无条件不稳定。", "problem": "考虑在周期性区域 $x \\in [0,L]$ 上的线性平流方程 $u_{t} + a\\,u_{x} = 0$，其中平流速度 $a \\in \\mathbb{R}\\setminus\\{0\\}$ 是一个常数。使用傅里叶谱配置法在 $N$ 个等距节点 $x_{j} = j\\,h$（其中 $j \\in \\{0,1,\\dots,N-1\\}$ 且 $h = L/N$）上对空间进行离散化。空间导数由标准的傅里叶伪谱微分矩阵近似，当该矩阵作用于波数为 $\\kappa$ 的离散傅里叶模态时，其作用等效于对所有可解波数乘以 $i\\,\\kappa$。该微分算子是斜对称的，并且具有纯虚数特征值，这反映了中心差分的非耗散特性。使用时间步长为 $\\Delta t  0$ 的前向欧拉法进行时间推进。\n\n从傅里叶谱配置导数的定义和应用于线性平流方程的前向欧拉更新出发，推导波数为 $\\kappa$ 的离散傅里叶模态的单步放大因子 $G(\\kappa,\\Delta t)$。基于此放大因子，确定对于任何固定的 $\\Delta t0$，导致线性不稳定性（即 $|G(\\kappa,\\Delta t)|1$）的可解波数集合。最后，定义库朗数 $\\lambda = a\\,\\Delta t/h$，并确定最大的 $\\lambda_{\\max}$ 值，使得对于所有可解波数和所有 $N \\ge 2$，都有 $|G(\\kappa,\\Delta t)| \\le 1$。请提供 $\\lambda_{\\max}$ 的精确值作为最终答案。无需四舍五入。最终答案必须是一个不带单位的实数。", "solution": "该问题要求对一维线性平流方程的一个数值格式进行稳定性分析。该格式结合了用于空间离散化的傅里叶谱配置法和用于时间积分的前向欧拉法。\n\n线性平流方程为：\n$$\nu_t + a u_x = 0\n$$\n其中 $u=u(x,t)$，$u_t = \\frac{\\partial u}{\\partial t}$，$u_x = \\frac{\\partial u}{\\partial x}$，平流速度 $a$ 是一个非零实常数 ($a \\in \\mathbb{R}\\setminus\\{0\\}$)。空间区域为 $x \\in [0,L]$，具有周期性边界条件。\n\n我们通过考虑单个傅里叶模态的行为来进行 von Neumann 稳定性分析。一个通用的解分量可以表示为平面波：\n$$\nu(x,t) = \\hat{u}_\\kappa(t) e^{i\\kappa x}\n$$\n其中 $\\kappa$ 是波数，$\\hat{u}_\\kappa(t)$ 是该模态随时间变化的振幅。\n\n将此形式代入偏微分方程 (PDE)，我们得到：\n$$\n\\frac{d\\hat{u}_\\kappa(t)}{dt} e^{i\\kappa x} + a \\frac{\\partial}{\\partial x} \\left( \\hat{u}_\\kappa(t) e^{i\\kappa x} \\right) = 0\n$$\n$$\n\\frac{d\\hat{u}_\\kappa(t)}{dt} e^{i\\kappa x} + a (i\\kappa) \\hat{u}_\\kappa(t) e^{i\\kappa x} = 0\n$$\n除以空间部分 $e^{i\\kappa x}$（它永远不为零），我们得到模态 $\\kappa$ 的振幅所满足的常微分方程 (ODE)：\n$$\n\\frac{d\\hat{u}_\\kappa}{dt} = -i a \\kappa \\hat{u}_\\kappa\n$$\n问题陈述指出，对于空间离散化，傅里叶谱配置法的微分算子作用于波数为 $\\kappa$ 的离散傅里叶模态时，其作用等效于乘以 $i\\kappa$。这意味着每个模态的半离散系统是上述连续傅里叶变换方程的精确表示。因此，在网格点 $x_j$ 处，模态 $\\kappa$ 的半离散方程确实是上面推导出的 ODE。\n\n接下来，我们应用前向欧拉法进行时间推进。对于形如 $\\frac{dy}{dt} = f(y)$ 的一般 ODE，前向欧拉更新为 $y^{n+1} = y^n + \\Delta t f(y^n)$，其中 $\\Delta t$ 是时间步长。\n将此应用于我们关于 $\\hat{u}_\\kappa$ 的特定 ODE，其中 $f(\\hat{u}_\\kappa) = -i a \\kappa \\hat{u}_\\kappa$，我们得到：\n$$\n\\hat{u}_\\kappa^{n+1} = \\hat{u}_\\kappa^n + \\Delta t (-i a \\kappa \\hat{u}_\\kappa^n)\n$$\n$$\n\\hat{u}_\\kappa^{n+1} = (1 - i a \\kappa \\Delta t) \\hat{u}_\\kappa^n\n$$\n单步放大因子 $G(\\kappa, \\Delta t)$ 是时间步 $n+1$ 的振幅与时间步 $n$ 的振幅之比：\n$$\nG(\\kappa, \\Delta t) = \\frac{\\hat{u}_\\kappa^{n+1}}{\\hat{u}_\\kappa^n} = 1 - i a \\kappa \\Delta t\n$$\n这完成了问题的第一部分。\n\n为使格式线性稳定，对于所有可解波数，放大因子的模必须小于或等于 1，即 $|G(\\kappa, \\Delta t)| \\le 1$。如果 $|G(\\kappa, \\Delta t)|  1$，相应模态的振幅将呈指数增长，导致不稳定性。\n\n我们来计算 $G(\\kappa, \\Delta t)$ 的模。由于 $G$ 是一个形如 $z = x+iy$ 的复数，其模的平方为 $|z|^2 = x^2+y^2$。这里，$x=1$ 且 $y=-a\\kappa\\Delta t$。\n$$\n|G(\\kappa, \\Delta t)|^2 = |1 - i a \\kappa \\Delta t|^2 = 1^2 + (-a \\kappa \\Delta t)^2 = 1 + (a \\kappa \\Delta t)^2\n$$\n问题要求找出导致不稳定性（定义为 $|G(\\kappa, \\Delta t)|  1$）的可解波数集合。这等价于 $|G(\\kappa, \\Delta t)|^2  1$。\n$$\n1 + (a \\kappa \\Delta t)^2  1\n$$\n$$\n(a \\kappa \\Delta t)^2  0\n$$\n由于 $a$、$\\kappa$ 和 $\\Delta t$ 都是实数，平方 $(a \\kappa \\Delta t)^2$ 总是非负的。它严格为正当且仅当 $a \\kappa \\Delta t \\neq 0$。\n问题指定 $a \\in \\mathbb{R}\\setminus\\{0\\}$ 且 $\\Delta t  0$。因此，对于任何非零的可解波数 $\\kappa \\neq 0$ 都会发生不稳定性。模态 $\\kappa=0$ 对应于常数平均分量，对此有 $G(0, \\Delta t) = 1$ 且 $|G(0, \\Delta t)| = 1$，因此它是中性稳定的。因此，导致线性不稳定的可解波数集合是所有非零可解波数的集合。\n\n最后，我们被要求找到库朗数 $\\lambda = a \\Delta t/h$ 的最大值，使得该格式对于所有可解波数都是稳定的，即对于所有 $\\kappa$ 都有 $|G(\\kappa, \\Delta t)| \\le 1$。\n稳定性条件是 $|G(\\kappa, \\Delta t)|^2 \\le 1$：\n$$\n1 + (a \\kappa \\Delta t)^2 \\le 1\n$$\n该不等式简化为：\n$$\n(a \\kappa \\Delta t)^2 \\le 0\n$$\n同样，由于 $(a \\kappa \\Delta t)^2$ 是一个实数的平方，它不能是负数。满足此条件的唯一方法是该平方项恰好为零：\n$$\n(a \\kappa \\Delta t)^2 = 0 \\implies a \\kappa \\Delta t = 0\n$$\n对于给定的具有 $N \\ge 2$ 个点的网格，此稳定性条件必须对*所有*可解波数 $\\kappa$ 成立。在长度为 $L$ 的周期性区域上，具有 $N$ 个点的可解波数集合包含非零值。例如，基频非零波数为 $\\kappa_1 = 2\\pi/L$。更一般地，波数集合为 $\\kappa_k = k \\frac{2\\pi}{L}$，其中整数 $k$ 直到奈奎斯特频率。由于该条件必须对所有可解的 $\\kappa$ 成立，因此它必须对离散化中存在的任何非零 $\\kappa$ 成立。对于任何这样的 $\\kappa \\neq 0$，并且给定 $a \\neq 0$ 和 $\\Delta t  0$，乘积 $a \\kappa \\Delta t$ 是非零的。因此，稳定性条件 $a \\kappa \\Delta t = 0$ 被违反。\n\n使该条件对所有波数都成立的唯一方法是，不存在非零波数（这不是一个有效的离散化），或者 $a=0$ 或 $\\Delta t=0$，而这两者都被问题陈述所排除。这意味着该格式对于任何 $\\Delta t  0$ 都是无条件不稳定的。\n\n让我们用库朗数 $\\lambda = a \\Delta t/h$ 来表示该条件。稳定性条件 $a \\kappa \\Delta t = 0$ 必须成立。\n$$\n\\left(\\frac{a \\Delta t}{h}\\right) (\\kappa h) = 0 \\implies \\lambda (\\kappa h) = 0\n$$\n对于任何具有 $N \\ge 2$ 的网格，都存在一个最大的非零可解波数 $\\kappa_{\\max}$。例如，当 $N$ 为偶数时，$\\kappa_{\\max} = \\pi/h$。为使此格式稳定，该条件必须对 $\\kappa_{\\max}$ 成立，因此 $\\lambda (\\kappa_{\\max} h) = \\lambda \\pi = 0$，这意味着 $\\lambda=0$。\n如果 $\\lambda = 0$，则 $a \\Delta t / h = 0$。由于 $a \\neq 0$ 且 $h  0$，这要求 $\\Delta t=0$，而这是不允许的。然而，问题要求的是满足稳定性条件的 $\\lambda_{\\max}$ 的最大值。条件 $\\lambda (\\kappa h)=0$ 对所有 $\\kappa$ 成立当且仅当 $\\lambda=0$。因此，$\\lambda$ 的稳定区域是单点 $\\{0\\}$。此集合中的最大值为 $0$。\n\n这个结果是数值分析中的一个经典结论：将一个纯非耗散的空间离散化方法（如傅里叶谱方法，其一阶导数算子具有纯虚数特征值）与一个其稳定区域未恰当包含虚轴上一段的时间步进格式（如前向欧拉法，其稳定区域仅在原点处接触虚轴）相结合，会导致求解双曲型方程的方法无条件不稳定。为保证稳定性，允许的最大库朗数为零。\n因此，$\\lambda_{\\max} = 0$。", "answer": "$$\n\\boxed{0}\n$$", "id": "3373430"}, {"introduction": "我们已经分别探讨了一致性和稳定性，而Lax等价定理（Lax Equivalence Theorem）将这两者与收敛性联系起来。该定理指出，对于一个适定的线性问题，一个数值格式是收敛的，当且仅当它既是稳定的又是一致的。本练习通过一个巧妙的例子，让你亲手验证一致性的必要性：你将分析一个被构造成稳定但与原问题不一致的格式 [@problem_id:3394996]。通过求解，你将证明即使是稳定的格式，如果不具备一致性，也无法收敛到正确的解，从而深刻理解这三个核心概念之间缺一不可的关系。", "problem": "考虑周期性线性平流初值问题 $u_{t} + a\\,u_{x} = 0$，其中 $x \\in [0,2\\pi]$，$t \\ge 0$，具有周期性边界条件和零初始数据 $u(x,0) = 0$。该问题是适定的，即对于合适赋范空间中的任何容许初始数据，都存在一个唯一解，并且该解连续依赖于初始数据。在谱方法和间断Galerkin (DG) 方法的背景下，如果一个线性格式的齐次部分在所选范数下产生有界演化，则称其为稳定的；如果将离散算子应用于足够光滑的精确解所产生的残差在网格加密时趋于零，则称其为一致的。\n\n构建以下具有 $N$ 个模态（由满足 $|k| \\le K$ 的整数 $k$ 标记，其中 $N = 2K+1$）的傅里叶谱半离散格式：将 $u_{N}(x,t)$ 展开为 $\\sum_{|k| \\le K} \\hat{u}_{k}(t)\\,\\exp(i k x)$，并根据下式演化模态系数：\n$$\n\\frac{d}{dt}\\,\\hat{u}_{k}(t) \\;=\\; -\\,i\\,a\\,k\\,\\hat{u}_{k}(t) \\;+\\; \\gamma\\,\\delta_{k,0},\n$$\n其中参数 $a = 1$，强迫振幅 $\\gamma = 1$，$\\delta_{k,0}$ 为克罗内克δ函数。假设此半离散系统进行精确时间积分。该格式是线性的，其齐次部分对应于反自伴平流算子的标准傅里叶谱离散化，该离散化在 $L^{2}$ 范数下是保范数的。然而，增加的零模态强迫项使得该格式与原始齐次问题不一致。\n\n从上述定义和半离散系统的精确演化出发，利用第一性原理进行推导，证明该格式是稳定的（即齐次演化保持 $L^{2}$ 范数）但不一致，并解释为何它不收敛于精确解 $u \\equiv 0$。然后，计算当模态数 $N \\to \\infty$ 时，在时间 $t = 1$ 的 $L^{2}$ 误差的极限：\n$$\n\\lim_{N \\to \\infty} \\,\\left\\| u_{N}(\\cdot,1) - 0 \\right\\|_{L^{2}(0,2\\pi)}.\n$$\n请以单一闭式解析表达式的形式提供最终答案。不需要四舍五入。如果涉及角度，必须以弧度表示。", "solution": "首先，我们分析格式的稳定性。根据问题陈述，稳定性由格式的齐次部分的行为决定。给定的半离散格式为：\n$$\n\\frac{d}{dt}\\,\\hat{u}_{k}(t) \\;=\\; -\\,i\\,a\\,k\\,\\hat{u}_{k}(t) \\;+\\; \\gamma\\,\\delta_{k,0}\n$$\n齐次部分通过移除强迫项 $\\gamma\\,\\delta_{k,0}$ 得到：\n$$\n\\frac{d}{dt}\\,\\hat{u}_{k}^{h}(t) \\;=\\; -\\,i\\,a\\,k\\,\\hat{u}_{k}^{h}(t)\n$$\n其中 $\\hat{u}_{k}^{h}(t)$ 表示齐次演化的系数。这个线性常微分方程的解是 $\\hat{u}_{k}^{h}(t) = \\hat{u}_{k}^{h}(0) \\exp(-iakt)$。根据帕塞瓦尔定理（Parseval's theorem），数值解 $u_{N}(x,t)$ 的 $L^{2}$ 范数与其傅里叶系数相关：\n$$\n\\left\\| u_{N}(\\cdot, t) \\right\\|_{L^{2}(0,2\\pi)}^{2} = \\int_{0}^{2\\pi} |u_{N}(x,t)|^{2} dx = 2\\pi \\sum_{|k| \\le K} |\\hat{u}_{k}(t)|^{2}\n$$\n对于齐次演化，我们考察系数模的平方：\n$$\n|\\hat{u}_{k}^{h}(t)|^{2} = \\left| \\hat{u}_{k}^{h}(0) \\exp(-iakt) \\right|^{2} = |\\hat{u}_{k}^{h}(0)|^{2} |\\exp(-iakt)|^{2} = |\\hat{u}_{k}^{h}(0)|^{2}\n$$\n因为对于任意实数 $\\theta$，都有 $|\\exp(i\\theta)|=1$。对所有模态求和，我们得到：\n$$\n\\sum_{|k| \\le K} |\\hat{u}_{k}^{h}(t)|^{2} = \\sum_{|k| \\le K} |\\hat{u}_{k}^{h}(0)|^{2}\n$$\n这意味着 $\\left\\| u_{N}^{h}(\\cdot, t) \\right\\|_{L^{2}}^{2} = \\left\\| u_{N}^{h}(\\cdot, 0) \\right\\|_{L^{2}}^{2}$。齐次格式解的 $L^{2}$ 范数在所有时间内都是守恒的。一个保范数的演化是有界的（算子范数为1）。因此，根据所给定义，该格式是稳定的。\n\n其次，我们分析一致性。如果截断误差——即将偏微分方程的精确解代入数值格式得到的残差——在离散化加密时（$N \\to \\infty$）趋于零，则称该格式与偏微分方程是一致的。对于 $u_{t} + a u_{x} = 0$ 和 $u(x,0)=0$，其精确解为 $u(x,t) = 0$（对所有 $t \\ge 0$）。精确解的傅里叶系数为 $\\hat{u}_{k,exact}(t) = 0$（对所有 $k$ 和 $t$）。\n我们将这些精确解的系数代入完整的数值格式，以求得每个模态的残差 $\\tau_k(t)$：\n$$\n\\tau_k(t) = \\frac{d}{dt}\\hat{u}_{k,exact}(t) - \\left( -iak\\,\\hat{u}_{k,exact}(t) + \\gamma\\,\\delta_{k,0} \\right)\n$$\n代入 $\\hat{u}_{k,exact}(t) = 0$ 及其时间导数 $\\frac{d}{dt}(0)=0$：\n$$\n\\tau_k(t) = 0 - \\left( -iak \\cdot 0 + \\gamma\\,\\delta_{k,0} \\right) = -\\gamma\\,\\delta_{k,0}\n$$\n当 $\\gamma=1$ 时，残差为 $\\tau_k(t) = -\\delta_{k,0}$。对于 $k=0$ 模态，残差为 $\\tau_0 = -1$，而对于所有其他模态 $k \\neq 0$，残差为 $\\tau_k = 0$。零模态的残差是一个非零常数。它不依赖于模态数 $N$，因此当 $N \\to \\infty$ 时不趋于零。因此，该格式与齐次偏微分方程 $u_t + a u_x = 0$ 不一致。\n\n不收敛是这种不一致性的直接后果，这可由Lax-Richtmyer等价定理来解释。该定理指出，对于一个适定的线性初值问题，一个一致的线性有限差分格式是收敛的当且仅当它是稳定的。在这里，格式是稳定的但并不一致。定理的收敛条件未被满足。该格式实际上是另一个不同偏微分方程的一致离散化：$u_t + a u_x = F(x)$，其中 $F(x)$ 是一个傅里叶系数为 $\\gamma\\,\\delta_{k,0}$ 的函数。这对应于一个空间上恒定的强迫项 $F(x) = \\gamma=1$。该数值格式正在解决一个错误的问题，因此其解不会收敛到预期问题的解。源项 $\\gamma\\,\\delta_{k,0}$ 不断地向零模态注入一个非物理信号，导致数值解偏离真实解 $u=0$。\n\n最后，我们计算在 $t=1$ 时的 $L^{2}$ 误差的极限。我们必须求解具有指定参数 $a=1, \\gamma=1$ 和初始条件 $\\hat{u}_k(0)=0$ 的半离散系统的精确解。该常微分方程组为：\n$$\n\\frac{d}{dt}\\hat{u}_{k}(t) = -ik\\hat{u}_{k}(t) + \\delta_{k,0}\n$$\n我们分两种情况求解。\n情况1：$k \\neq 0$。方程为 $\\frac{d}{dt}\\hat{u}_{k}(t) = -ik\\hat{u}_{k}(t)$。在初始条件 $\\hat{u}_k(0)=0$ 下，唯一解为 $\\hat{u}_{k}(t)=0$ 对所有 $t$ 成立。\n情况2：$k=0$。方程为 $\\frac{d}{dt}\\hat{u}_{0}(t) = -i(0)\\hat{u}_{0}(t) + 1$，简化为 $\\frac{d}{dt}\\hat{u}_{0}(t) = 1$。从 $0$ 到 $t$ 积分得到 $\\hat{u}_{0}(t) - \\hat{u}_{0}(0) = \\int_0^t 1 ds = t$。因为 $\\hat{u}_{0}(0)=0$，所以我们有 $\\hat{u}_{0}(t)=t$。\n\n因此，数值解的系数为 $\\hat{u}_{k}(t) = t\\,\\delta_{k,0}$。物理空间中的数值解为：\n$$\nu_{N}(x,t) = \\sum_{|k| \\le K} \\hat{u}_{k}(t)\\,\\exp(ikx) = \\hat{u}_{0}(t)\\exp(i \\cdot 0 \\cdot x) = t\n$$\n解 $u_{N}(x,t)=t$ 是一个空间常数函数，随时间线性增长。该解对任何 $N \\ge 1$（即 $K \\ge 0$）都有效。\n\n误差为 $e_{N}(x,t) = u_{N}(x,t) - u(x,t) = t - 0 = t$。\n题目要求我们计算在时间 $t=1$ 时的误差的 $L^{2}$ 范数。此时的误差为 $e_N(x,1) = 1$。\n误差的 $L^{2}$ 范数的平方是：\n$$\n\\left\\| e_{N}(\\cdot,1) \\right\\|_{L^{2}(0,2\\pi)}^{2} = \\int_{0}^{2\\pi} |e_{N}(x,1)|^{2} dx = \\int_{0}^{2\\pi} |1|^{2} dx = \\int_{0}^{2\\pi} 1 dx = 2\\pi\n$$\n因此，在 $t=1$ 时误差的 $L^{2}$ 范数是 $\\left\\| e_{N}(\\cdot,1) \\right\\|_{L^{2}(0,2\\pi)} = \\sqrt{2\\pi}$。\n\n这个结果与 $N$ 无关。因此，当 $N \\to \\infty$ 时的极限是相同的值：\n$$\n\\lim_{N \\to \\infty} \\,\\left\\| u_{N}(\\cdot,1) - 0 \\right\\|_{L^{2}(0,2\\pi)} = \\sqrt{2\\pi}\n$$\n这个非零极限证实了该格式不收敛于精确解。", "answer": "$$\n\\boxed{\\sqrt{2\\pi}}\n$$", "id": "3394996"}]}