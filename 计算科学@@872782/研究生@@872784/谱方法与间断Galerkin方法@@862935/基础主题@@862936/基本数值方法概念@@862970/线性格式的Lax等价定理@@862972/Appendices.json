{"hands_on_practices": [{"introduction": "Lax等价定理指出，对于一个适定的线性问题，一个相容的格式是收敛的当且仅当它是稳定的。本练习 [@problem_id:3394971] 将通过构建一个与偏微分方程相容但无条件不稳定的数值格式，来探讨稳定性这一必要条件。通过冯·诺依曼分析，您将发现即使一个格式在截断误差意义上是准确的，如果它不能控制误差的增长，解也会发散，从而深刻理解为何稳定性是收敛的基石。", "problem": "考虑一个周期区间上的一维线性平流初值问题，\n$$\n\\partial_{t} u(x,t) + a\\,\\partial_{x} u(x,t) = 0,\\quad x\\in[0,L],\\ t\\ge 0,\\quad a>0,\n$$\n其具有光滑的周期性初始数据 $u(x,0) = u_{0}(x)$。将空间域离散为 $N$ 个大小为 $h=L/N$ 的均匀单元，并使用间断 Galerkin (DG) 方法，在每个单元上采用分片常数（多项式次数 $p=0$）来逼近 $u$。对平流通量使用中心数值通量，即在每个界面上 $F^{*}(u^{-},u^{+}) = a\\,\\frac{u^{-}+u^{+}}{2}$，并使用时间步长为 $\\Delta t>0$ 的前向欧拉法进行时间推进。定义库朗数 $\\nu = \\frac{a\\,\\Delta t}{h}$。\n\n从测试函数等于单元常数基函数的 DG 弱形式出发，推导单元平均值 $u_{j}^{n}$ 的全离散更新格式，其中 $j\\in\\{0,1,\\dots,N-1\\}$ 为单元索引，$n\\in\\mathbb{N}$ 为时间步索引。然后，通过考虑单个傅里叶模式 $u_{j}^{n} = \\hat{u}^{n}\\exp(i\\,\\theta\\,j)$（其中 $\\theta\\in[-\\pi,\\pi]$ 以弧度为单位），在周期网格上进行 von Neumann (傅里叶) 分析，并求出单步放大因子 $G(\\theta,\\nu)$。\n\n使用此分析，计算放大因子模在所有傅里叶模式上的上确界，\n$$\n\\sup_{\\theta\\in[-\\pi,\\pi]} |G(\\theta,\\nu)|,\n$$\n将其表示为仅关于库朗数 $\\nu$ 的函数。最后，使用关于线性格式的 Lax 等价定理，解释为什么该格式是不收敛的，尽管当 $\\nu$ 很小时，对于光滑的初始数据可能表现出表观的短期精度。你的最终答案必须是 $\\sup_{\\theta} |G(\\theta,\\nu)|$ 的闭式解析表达式。", "solution": "该问题要求对一维线性平流方程推导并分析一个间断 Galerkin (DG) 格式。分析的最终结果将基于 Lax 等价定理来解释该格式的不收敛性。\n\n控制偏微分方程 (PDE) 是线性平流方程：\n$$\n\\partial_{t} u(x,t) + a\\,\\partial_{x} u(x,t) = 0\n$$\n在周期域 $x\\in[0,L]$ 上，对于 $t\\ge 0$，具有恒定的平流速度 $a>0$。\n\n首先，我们推导全离散数值格式。DG 方法从弱形式出发。我们将 PDE 乘以一个与数值解 $u_h(x,t)$ 来自相同逼近空间的测试函数 $v_h(x)$，并在一个大小为 $h$ 的计算单元 $I_j = [x_{j-1/2}, x_{j+1/2}]$ 上积分。对于多项式次数 $p=0$，逼近函数 $u_h(x,t)$ 是一个分片常数函数，在单元 $I_j$ 上取值为 $u_j(t)$。测试函数 $v_h(x)$ 是相应的基函数，它在 $I_j$ 上为 $1$，在其他地方为 $0$。\n\n在单元 $I_j$ 上的弱形式为：\n$$\n\\int_{I_j} v_h(x) \\left( \\partial_{t} u_h(x,t) + a\\,\\partial_{x} u_h(x,t) \\right) dx = 0\n$$\n对平流项进行分部积分，我们得到：\n$$\n\\int_{I_j} v_h \\partial_{t} u_h dx + \\left[ v_h a u_h \\right]_{x_{j-1/2}}^{x_{j+1/2}} - \\int_{I_j} ( \\partial_{x} v_h ) a u_h dx = 0\n$$\n由于在 $I_j$ 上 $u_h(x,t) = u_j(t)$ 且 $v_h(x) = 1$，时间导数项变为 $\\int_{I_j} \\partial_t u_j(t) dx = h \\frac{du_j}{dt}$。由于 $v_h$ 在单元上是常数，其导数 $\\partial_x v_h$ 在单元内部为零。方程简化为：\n$$\nh \\frac{du_j}{dt} + a u_h(x_{j+1/2},t) - a u_h(x_{j-1/2},t) = 0\n$$\n项 $u_h(x_{j\\pm1/2},t)$ 在解是间断的单元界面处取值。这些单值通量必须由数值通量 $F^{*}(u^-, u^+)$ 代替，其中 $u^-$ 和 $u^+$ 分别是解在界面左侧和右侧的值。半离散格式为：\n$$\nh \\frac{du_j}{dt} + F^*(u_j(t), u_{j+1}(t)) - F^*(u_{j-1}(t), u_j(t)) = 0\n$$\n这里，在界面 $x_{j+1/2}$ 处，$u^-=u_j(t)$ 且 $u^+=u_{j+1}(t)$。在界面 $x_{j-1/2}$ 处，$u^-=u_{j-1}(t)$ 且 $u^+=u_j(t)$。问题指定了中心数值通量，$F^{*}(u^{-},u^{+}) = a\\,\\frac{u^{-}+u^{+}}{2}$。将其代入格式中：\n$$\nh \\frac{du_j}{dt} + a \\frac{u_j + u_{j+1}}{2} - a \\frac{u_{j-1} + u_j}{2} = 0\n$$\n简化表达式可得：\n$$\nh \\frac{du_j}{dt} = - \\frac{a}{2} (u_j + u_{j+1} - u_{j-1} - u_j) = - \\frac{a}{2} (u_{j+1} - u_{j-1})\n$$\n这就是半离散格式。现在，我们应用前向欧拉法进行时间离散化，其中用 $\\frac{u_j^{n+1}-u_j^n}{\\Delta t}$ 逼近 $\\frac{du_j}{dt}$：\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} = - \\frac{a}{2h} (u_{j+1}^n - u_{j-1}^n)\n$$\n重新整理并引入库朗数 $\\nu = \\frac{a\\,\\Delta t}{h}$，我们得到全离散更新方程：\n$$\nu_j^{n+1} = u_j^n - \\frac{a \\Delta t}{2h} (u_{j+1}^n - u_{j-1}^n) = u_j^n - \\frac{\\nu}{2} (u_{j+1}^n - u_{j-1}^n)\n$$\n该格式与从空间中心差分和时间前向欧拉的有限差分法推导出的格式相同。\n\n接下来，我们进行 von Neumann 稳定性分析。我们考虑解的单个傅里叶模式形式为 $u_j^n = \\hat{u}^n \\exp(i\\theta j)$，其中 $\\theta \\in [-\\pi, \\pi]$ 是无量纲波数。将其代入离散格式中可得：\n$$\n\\hat{u}^{n+1}\\exp(i\\theta j) = \\hat{u}^{n}\\exp(i\\theta j) - \\frac{\\nu}{2} \\left( \\hat{u}^{n}\\exp(i\\theta (j+1)) - \\hat{u}^{n}\\exp(i\\theta (j-1)) \\right)\n$$\n两边同除以 $\\hat{u}^{n}\\exp(i\\theta j)$（假设其非零），我们得到放大因子 $G(\\theta,\\nu) = \\frac{\\hat{u}^{n+1}}{\\hat{u}^{n}}$：\n$$\nG(\\theta,\\nu) = 1 - \\frac{\\nu}{2} \\left( \\exp(i\\theta) - \\exp(-i\\theta) \\right)\n$$\n使用欧拉恒等式 $\\sin(\\theta) = \\frac{\\exp(i\\theta) - \\exp(-i\\theta)}{2i}$，我们有 $\\exp(i\\theta) - \\exp(-i\\theta) = 2i\\sin\\theta$。放大因子变为：\n$$\nG(\\theta,\\nu) = 1 - \\frac{\\nu}{2} (2i\\sin\\theta) = 1 - i\\nu\\sin\\theta\n$$\n现在，我们计算这个复值放大因子在所有可能的模式 $\\theta \\in [-\\pi, \\pi]$ 上的模的上确界。其模为：\n$$\n|G(\\theta,\\nu)| = |1 - i\\nu\\sin\\theta| = \\sqrt{1^2 + (-\\nu\\sin\\theta)^2} = \\sqrt{1 + \\nu^2\\sin^2\\theta}\n$$\n为了找到上确界，我们需要关于 $\\theta$ 最大化这个表达式。由于 $\\nu = \\frac{a\\Delta t}{h} > 0$ 且平方根函数是单调的，最大化 $|G(\\theta,\\nu)|$ 等价于最大化 $\\sin^2\\theta$。对于 $\\theta \\in [-\\pi,\\pi]$，$\\sin\\theta$ 的值域是 $[-1,1]$，所以 $\\sin^2\\theta$ 的最大值是 $1$，在 $\\theta = \\pm\\frac{\\pi}{2}$ 时取得。\n因此，放大因子模的上确界是：\n$$\n\\sup_{\\theta\\in[-\\pi,\\pi]} |G(\\theta,\\nu)| = \\sqrt{1 + \\nu^2(1)^2} = \\sqrt{1 + \\nu^2}\n$$\n最后，我们使用 Lax 等价定理来解释为什么该格式是不收敛的。该定理指出，对于一个线性的、适定的初值问题，一个相容的数值格式是收敛的当且仅当它是稳定的。\n\n1.  **线性性**：该 PDE 和离散格式都是线性的。\n2.  **相容性**：该格式是平流方程的一个标准有限差分逼近（空间中心差分，时间前向差分）。泰勒级数展开显示其截断误差为 $O(\\Delta t, h^2)$，当 $\\Delta t, h \\to 0$ 时，该误差趋于零。因此，该格式是相容的。\n3.  **稳定性**：一个格式要在 von Neumann 意义下是稳定的，其放大因子必须对所有相关模式 $\\theta$ 以及在时空加密过程中满足 $|G(\\theta,\\nu)| \\le 1$。在我们的例子中，我们发现 $|G(\\theta, \\nu)| = \\sqrt{1 + \\nu^2\\sin^2\\theta}$。对于任何 $\\nu > 0$，只要模式满足 $\\sin\\theta \\neq 0$（即，除了零频率模式 $\\theta=0$ 或混叠的零频率模式 $\\theta=\\pm\\pi$ 之外的任何模式），这个值都严格大于 $1$。具体来说，$\\sup_\\theta |G(\\theta,\\nu)| = \\sqrt{1+\\nu^2} > 1$。\n\n由于稳定性条件 $|G| \\le 1$ 对任何 $\\nu > 0$ 的选择都被违反，该格式是无条件不稳定的。初始数据中存在的任何数值误差或高频分量都会随时间被指数级放大，导致数值解的爆破。\n\n根据 Lax 等价定理，因为该格式是相容但不稳定的，所以它是**不收敛的**。对于光滑的初始数据，该问题可能表现出表观的短期精度，这是因为光滑数据的高频分量非常小，而不稳定性正是在这些高频处最为严重（在 $\\theta=\\pm\\pi/2$ 处，对应于网格上最高的非混叠频率）。对于小的 $\\nu$，放大因子仅略大于 $1$（例如，$|G| \\approx 1 + \\frac{1}{2}\\nu^2\\sin^2\\theta$）。每个时间步的增长很小，但会累积。对于任何固定的时间 $T = n\\Delta t$，当我们加密网格时（$\\Delta t \\to 0$，$n \\to \\infty$），总放大 $(|G|)^n$ 将会发散，从而证实了其不收敛性。", "answer": "$$\n\\boxed{\\sqrt{1 + \\nu^2}}\n$$", "id": "3394971"}, {"introduction": "在验证了稳定性的重要性之后，我们转向Lax等价定理的另一个核心支柱：相容性。此练习 [@problem_id:3394996] 提出了一个思想实验，您将分析一个能量守恒（因此是稳定的）的格式，但该格式被人为地修改，使其与目标齐次偏微分方程不相容。通过求解这个格式，您会发现它虽然不会发散，但会收敛到一个错误问题的解，这清晰地揭示了为何格式必须在离散化步长趋于零时精确逼近原始方程。", "problem": "考虑周期性线性平流初值问题 $u_{t} + a\\,u_{x} = 0$，其中 $x \\in [0,2\\pi]$ 且 $t \\ge 0$，具有周期性边界条件和零初始数据 $u(x,0) = 0$。在某种意义上，该问题是适定的，即对于在合适的赋范空间中的任何可容许的初始数据，都存在一个唯一解，并且该解连续依赖于初始数据。在谱方法和间断 Galerkin (DG) 方法的背景下，如果一个线性格式的齐次部分在所选范数下产生有界演化，则称该格式是稳定的；如果将离散算子应用于足够光滑的精确解所产生的残差在加密过程中趋于零，则称该格式是一致的。\n\n构建以下具有 $N$ 个模式（由满足 $|k| \\le K$ 的整数 $k$ 标记，其中 $N = 2K+1$）的傅里叶谱半离散格式：将 $u_{N}(x,t)$ 展开为 $u_{N}(x,t) = \\sum_{|k| \\le K} \\hat{u}_{k}(t)\\,\\exp(i k x)$，并根据以下方程演化模式系数：\n$$\n\\frac{d}{dt}\\,\\hat{u}_{k}(t) \\;=\\; -\\,i\\,a\\,k\\,\\hat{u}_{k}(t) \\;+\\; \\gamma\\,\\delta_{k,0},\n$$\n其中参数 $a = 1$，强迫项振幅 $\\gamma = 1$，$\\delta_{k,0}$ 为克罗内克 delta 函数。假设此半离散系统的时间积分为精确积分。该格式是线性的，其齐次部分对应于斜伴随平流算子的标准傅里叶谱离散化，在 $L^{2}$ 范数下是保范数的。然而，增加的零模态强迫项使得该格式与原始的齐次问题不一致。\n\n从上述定义和半离散系统的精确演化出发，运用第一性原理进行推理，证明该格式是稳定的（即齐次演化保持 $L^{2}$ 范数）但不一致，并解释为什么它不收敛于精确解 $u \\equiv 0$。然后，计算当模式数 $N \\to \\infty$ 时，在时间 $t = 1$ 处的 $L^{2}$ 误差的极限：\n$$\n\\lim_{N \\to \\infty} \\,\\left\\| u_{N}(\\cdot,1) - 0 \\right\\|_{L^{2}(0,2\\pi)}.\n$$\n请以单个封闭形式的解析表达式给出你的最终答案。不需要四舍五入。角度（如果有）必须以弧度表示。", "solution": "首先验证问题以确保其科学上可靠、适定且客观。\n\n给定条件如下：\n1.  偏微分方程 (PDE) 是线性平流方程：$u_{t} + a\\,u_{x} = 0$。\n2.  空间域为 $x \\in [0,2\\pi]$，具有周期性边界条件。\n3.  时间域为 $t \\ge 0$。\n4.  初始条件为 $u(x,0) = 0$。\n5.  提出了一个傅里叶谱半离散格式用于数值解 $u_{N}(x,t) = \\sum_{|k| \\le K} \\hat{u}_{k}(t)\\,\\exp(i k x)$，其中 $N = 2K+1$。\n6.  模式系数 $\\hat{u}_{k}(t)$ 的演化由以下常微分方程 (ODE) 系统给出：$\\frac{d}{dt}\\,\\hat{u}_{k}(t) \\;=\\; -\\,i\\,a\\,k\\,\\hat{u}_{k}(t) \\;+\\; \\gamma\\,\\delta_{k,0}$。\n7.  该格式的初始条件与 $u(x,0)=0$ 一致，这意味着对所有 $k$，$\\hat{u}_{k}(0)=0$。\n8.  参数指定为 $a = 1$ 和 $\\gamma = 1$。\n9.  该初值问题的精确解为 $u(x,t) = 0$（对所有 $x$ 和 $t$）。\n10. 任务是证明该格式是稳定的但不一致，解释其不收敛的原因，并计算当 $N \\to \\infty$ 时在 $t=1$ 处的 $L^{2}$ 误差的极限。\n\n该问题在数学上是明确定义的，内部一致，并直接关系到偏微分方程数值方法的分析，特别是 Lax 等价定理所描述的稳定性、一致性和收敛性之间的相互作用。所构建的格式是用于说明一致性重要性的教科书式例子。因此，该问题是有效的。\n\n我们继续求解，包括三个部分：稳定性与一致性分析、不收敛性解释和误差计算。\n\n首先，我们分析格式的稳定性。根据问题陈述，稳定性由格式的齐次部分的行为决定。给定的半离散格式为：\n$$\n\\frac{d}{dt}\\,\\hat{u}_{k}(t) \\;=\\; -\\,i\\,a\\,k\\,\\hat{u}_{k}(t) \\;+\\; \\gamma\\,\\delta_{k,0}\n$$\n移除强迫项 $\\gamma\\,\\delta_{k,0}$ 得到齐次部分：\n$$\n\\frac{d}{dt}\\,\\hat{u}_{k}^{h}(t) \\;=\\; -\\,i\\,a\\,k\\,\\hat{u}_{k}^{h}(t)\n$$\n其中 $\\hat{u}_{k}^{h}(t)$ 表示齐次演化的系数。这个线性 ODE 的解为 $\\hat{u}_{k}^{h}(t) = \\hat{u}_{k}^{h}(0) \\exp(-iakt)$。数值解 $u_{N}(x,t)$ 的 $L^{2}$ 范数通过 Parseval 定理与其傅里叶系数相关联：\n$$\n\\left\\| u_{N}(\\cdot, t) \\right\\|_{L^{2}(0,2\\pi)}^{2} = \\int_{0}^{2\\pi} |u_{N}(x,t)|^{2} dx = 2\\pi \\sum_{|k| \\le K} |\\hat{u}_{k}(t)|^{2}\n$$\n对于齐次演化，我们考察系数的模的平方：\n$$\n|\\hat{u}_{k}^{h}(t)|^{2} = \\left| \\hat{u}_{k}^{h}(0) \\exp(-iakt) \\right|^{2} = |\\hat{u}_{k}^{h}(0)|^{2} |\\exp(-iakt)|^{2} = |\\hat{u}_{k}^{h}(0)|^{2}\n$$\n因为对于任意实数 $\\theta$，都有 $|\\exp(i\\theta)|=1$。对所有模式求和，我们发现：\n$$\n\\sum_{|k| \\le K} |\\hat{u}_{k}^{h}(t)|^{2} = \\sum_{|k| \\le K} |\\hat{u}_{k}^{h}(0)|^{2}\n$$\n这意味着 $\\left\\| u_{N}^{h}(\\cdot, t) \\right\\|_{L^{2}}^{2} = \\left\\| u_{N}^{h}(\\cdot, 0) \\right\\|_{L^{2}}^{2}$。齐次格式的解的 $L^{2}$ 范数在所有时间内都守恒。一个保持范数的演化是有界的（算子范数为 $1$）。因此，根据所给定义，该格式是稳定的。\n\n其次，我们分析一致性。如果将 PDE 的精确解代入数值格式所得到的截断误差（残差）在离散化加密（$N \\to \\infty$）时趋于零，则该格式与该 PDE 是一致的。对于 $u_{t} + a u_{x} = 0$ 和 $u(x,0)=0$，其精确解为 $u(x,t) = 0$（对所有 $t \\ge 0$）。该精确解的傅里叶系数为 $\\hat{u}_{k,exact}(t) = 0$（对所有 $k$ 和 $t$）。\n我们将这些精确解的系数代入完整的数值格式，以求得每个模式的残差 $\\tau_k(t)$：\n$$\n\\tau_k(t) = \\frac{d}{dt}\\hat{u}_{k,exact}(t) - \\left( -iak\\,\\hat{u}_{k,exact}(t) + \\gamma\\,\\delta_{k,0} \\right)\n$$\n代入 $\\hat{u}_{k,exact}(t) = 0$ 及其时间导数 $\\frac{d}{dt}(0)=0$：\n$$\n\\tau_k(t) = 0 - \\left( -iak \\cdot 0 + \\gamma\\,\\delta_{k,0} \\right) = -\\gamma\\,\\delta_{k,0}\n$$\n当 $\\gamma=1$ 时，残差为 $\\tau_k(t) = -\\delta_{k,0}$。对于模式 $k=0$，残差为 $\\tau_0 = -1$，而对于所有其他模式 $k \\neq 0$，残差为 $\\tau_k = 0$。第零个模式的残差是一个非零常数。它不依赖于模式数 $N$，因此当 $N \\to \\infty$ 时不趋于零。因此，该格式与齐次 PDE $u_t + a u_x = 0$ 不一致。\n\n正如 Lax-Richtmyer 等价定理所解释的，不收敛是这种不一致性的直接后果。该定理指出，对于一个适定的线性初值问题，一个一致的线性有限差分格式是收敛的当且仅当它是稳定的。在这里，格式是稳定的但不是一致的。不满足定理中关于收敛的条件。该格式实际上是另一个 PDE 的一致离散化：$u_t + a u_x = F(x)$，其中 $F(x)$ 是一个傅里叶系数为 $\\gamma\\,\\delta_{k,0}$ 的函数。这对应于一个空间上为常数的强迫项 $F(x) = \\gamma=1$。该数值格式在求解一个错误的问题，因此其解不收敛于预期问题的解。源项 $\\gamma\\,\\delta_{k,0}$ 不断地向零模态注入一个非物理信号，导致数值解偏离真实解 $u=0$。\n\n最后，我们计算在 $t=1$ 时的 $L^{2}$ 误差的极限。我们必须求解具有指定参数 $a=1$, $\\gamma=1$ 和初始条件 $\\hat{u}_k(0)=0$ 的半离散系统的精确解。ODE 系统为：\n$$\n\\frac{d}{dt}\\hat{u}_{k}(t) = -ik\\hat{u}_{k}(t) + \\delta_{k,0}\n$$\n我们分两种情况求解。\n情况 1：$k \\neq 0$。方程为 $\\frac{d}{dt}\\hat{u}_{k}(t) = -ik\\hat{u}_{k}(t)$。在初始条件 $\\hat{u}_k(0)=0$ 下，唯一解为 $\\hat{u}_{k}(t)=0$（对所有 $t$）。\n情况 2：$k=0$。方程为 $\\frac{d}{dt}\\hat{u}_{0}(t) = -i(0)\\hat{u}_{0}(t) + 1$，简化为 $\\frac{d}{dt}\\hat{u}_{0}(t) = 1$。从 $0$ 到 $t$ 积分得到 $\\hat{u}_{0}(t) - \\hat{u}_{0}(0) = \\int_0^t 1 ds = t$。由于 $\\hat{u}_{0}(0)=0$，我们有 $\\hat{u}_{0}(t)=t$。\n\n因此，数值解的系数为 $\\hat{u}_{k}(t) = t\\,\\delta_{k,0}$。物理空间中的数值解为：\n$$\nu_{N}(x,t) = \\sum_{|k| \\le K} \\hat{u}_{k}(t)\\,\\exp(ikx) = \\hat{u}_{0}(t)\\exp(i \\cdot 0 \\cdot x) = t\n$$\n解 $u_{N}(x,t)=t$ 是一个随时间线性增长的空间常数函数。该解对任何 $N \\ge 1$（即 $K \\ge 0$）都有效。\n\n误差为 $e_{N}(x,t) = u_{N}(x,t) - u(x,t) = t - 0 = t$。\n我们需要计算在时间 $t=1$ 时的误差的 $L^{2}$ 范数。此时的误差为 $e_N(x,1) = 1$。\n误差的 $L^{2}$ 范数的平方为：\n$$\n\\left\\| e_{N}(\\cdot,1) \\right\\|_{L^{2}(0,2\\pi)}^{2} = \\int_{0}^{2\\pi} |e_{N}(x,1)|^{2} dx = \\int_{0}^{2\\pi} |1|^{2} dx = \\int_{0}^{2\\pi} 1 dx = 2\\pi\n$$\n因此，在 $t=1$ 时误差的 $L^{2}$ 范数为 $\\left\\| e_{N}(\\cdot,1) \\right\\|_{L^{2}(0,2\\pi)} = \\sqrt{2\\pi}$。\n\n这个结果与 $N$ 无关。因此，当 $N \\to \\infty$ 时的极限是相同的值：\n$$\n\\lim_{N \\to \\infty} \\,\\left\\| u_{N}(\\cdot,1) - 0 \\right\\|_{L^{2}(0,2\\pi)} = \\sqrt{2\\pi}\n$$\n这个非零极限证实了该格式不收敛于精确解。", "answer": "$$\n\\boxed{\\sqrt{2\\pi}}\n$$", "id": "3394996"}, {"introduction": "在分别探讨了因不稳定或不相容而失败的格式后，我们将分析一个成功的范例：采用迎风通量的间断Galerkin（DG）方法。这个综合性练习 [@problem_id:3395011] 将引导您完成一个现代高阶数值方法的完整推导与分析。通过推导半离散算子并通过Bloch-Floquet分析计算其特征值，您将直接观察到一个稳定且相容的格式所具有的数学特征，并理解为何迎风格式的选择能够引入必要的耗散以确保稳定性，从而保证收敛。", "problem": "考虑一维线性平流方程 $\\partial_{t} u + a \\,\\partial_{x} u = 0$，其中平流速度 $a>0$ 为常数，定义域为周期性区间 $[0,L]$。将该定义域划分为 $N$ 个大小为 $h = L/N$ 的均匀单元，在每个单元 $K_{e}$ 上，通过仿射映射 $x = x_{e} + \\tfrac{h}{2}\\,\\xi$，在参考坐标 $\\xi \\in [-1,1]$ 上采用模态 Legendre 基 $\\{P_{j}(\\xi)\\}_{j=0}^{p}$。使用带有迎风数值通量的不连续 Galerkin (DG) 方法。\n\n仅从 Galerkin 方法弱形式的定义、Legendre 多项式 $\\{P_{j}\\}$ 的性质以及 $x$ 和 $\\xi$ 之间的映射规则出发，完成以下任务：\n\n1. 在每个单元 $K_{e}$ 上推导半离散 DG 公式，其中测试函数取自同一多项式空间 $\\mathbb{P}_{p}(K_{e})$，并在单元间边界处对 $a>0$ 使用迎风数值通量。将结果表示为以下形式：\n$$\nM\\,\\dot{u} = A\\,u,\n$$\n其中 $M$ 是全局块对角质量矩阵，$A$ 是由单元局部体积贡献和数值通量组装而成的全局平流算子。通过识别周期性均匀网格上由于通量引起的对角质量贡献和最近邻耦合，明确单元局部结构。\n\n2. 将多项式次数特化为 $p=1$，并写出单元局部质量矩阵 $M_{e}$ 和两个块矩阵 $A_{0}$（自耦合）与 $A_{-1}$（来自左侧紧邻单元的耦合），使得在均匀周期性网格上，\n$$\nM_{e}\\,\\dot{u}_{e} \\;=\\; A_{0}\\,u_{e} \\;+\\; A_{-1}\\,u_{e-1},\n$$\n其中 $u_{e}$ 是单元 $K_{e}$ 上的模态系数向量，索引以 $N$ 为模。\n\n3. 使用 Bloch–Floquet 分析，假设一个 Fourier 模式 $u_{e}(t) = \\widehat{u}\\,\\exp\\!\\big(i k x_{e}\\big)$，其中波数 $k \\in \\mathbb{R}$，并定义 $\\theta = k h$（以弧度为单位）。推导 $p=1$ 时半离散算子的 $2 \\times 2$ 符号 $S(\\theta)$，并以 $\\theta$、$a$ 和 $h$ 的函数形式计算其两个特征值的闭式解。识别“物理”分支，即当 $\\theta \\to 0$ 时渐近匹配连续符号 $-i a k$ 的特征值。\n\n4. 根据线性格式的 Lax 等价定理，简要论证为什么迎风选择能保证半离散算子的稳定性，并因此与相容性一同保证在周期性网格上的收敛性。然而，为评分起见，仅报告所要求的特征值表达式。\n\n答案要求：作为最终答案，提供 $p=1$ 时物理分支特征值 $\\lambda_{\\mathrm{phys}}(\\theta)$ 关于 $a$、$h$ 和 $\\theta$（$\\theta$ 以弧度为单位）的单个闭式解析表达式。最终答案中不要包含任何单位，也不要进行近似或四舍五入。", "solution": "该问题是有效的，因为它提出了一个关于偏微分方程数值分析的标准、适定问题，特别涉及不连续 Galerkin (DG) 方法。所有必需信息均已提供，且该问题在科学上和数学上都是合理的。\n\n我们首先推导一维线性平流方程 $\\partial_{t} u + a \\,\\partial_{x} u = 0$ 的半离散 DG 公式，其中 $a>0$ 是一个常数速度。\n\n**1. 半离散 DG 公式的推导**\n\n我们将偏微分方程乘以一个来自有限维多项式空间 $\\mathbb{P}_p(K_e)$ 的测试函数 $v_h$，并在一个通用单元 $K_e = [x_{e-1/2}, x_{e+1/2}]$ 上积分。\n$$\n\\int_{K_e} (\\partial_t u_h) v_h \\,dx + \\int_{K_e} a (\\partial_x u_h) v_h \\,dx = 0\n$$\n这里，$u_h$ 是近似解，在 $K_e$ 上是一个 $p$ 次多项式。对第二项应用分部积分得到：\n$$\n\\int_{K_e} (\\partial_t u_h) v_h \\,dx + \\left[ a u_h v_h \\right]_{x_{e-1/2}}^{x_{e+1/2}} - \\int_{K_e} a u_h (\\partial_x v_h) \\,dx = 0\n$$\n由于 $u_h$ 在单元边界上是不连续的，通量项 $a u_h$ 必须被一个单值数值通量 $\\widehat{au_h}$ 所替代。\n$$\n\\int_{K_e} (\\partial_t u_h) v_h \\,dx - \\int_{K_e} a u_h (\\partial_x v_h) \\,dx + \\widehat{au_h}(x_{e+1/2}) v_h(x_{e+1/2}^-) - \\widehat{au_h}(x_{e-1/2}) v_h(x_{e-1/2}^+) = 0\n$$\n对于 $a>0$，迎风通量由界面“迎风”侧或左侧的值定义，因此 $\\widehat{au_h} = a u_h^-$。对于单元 $K_e$，其右边界处的解是 $u_e(x_{e+1/2})$，而其左边界处的迎风信息来自单元 $K_{e-1}$ 在其右边界处的解，即 $u_{e-1}(x_{e-1/2})$。\n因此，单元 $K_e$ 的弱形式为：\n$$\n\\int_{K_e} (\\partial_t u_e) v_e \\,dx = \\int_{K_e} a u_e (\\partial_x v_e) \\,dx - a u_e(x_{e+1/2}) v_e(x_{e+1/2}) + a u_{e-1}(x_{e-1/2}) v_e(x_{e-1/2})\n$$\n我们引入从参考单元 $\\xi \\in [-1,1]$ 到物理单元 $x \\in K_e$ 的仿射映射：$x = x_e + \\frac{h}{2}\\xi$，其中 $x_e$ 是单元的中心，$h$ 是其宽度。这意味着 $dx=\\frac{h}{2}d\\xi$ 且 $\\partial_x = \\frac{2}{h}\\partial_\\xi$。解和测试函数在模态 Legendre 基 $\\{P_j(\\xi)\\}_{j=0}^p$ 中展开：\n$u_e(x(\\xi),t) = \\sum_{j=0}^p u_{e,j}(t) P_j(\\xi)$ 且 $v_e(x(\\xi)) = P_k(\\xi)$，对于 $k=0,\\dots,p$。\n将这些代入弱形式，我们得到关于系数 $u_{e,j}$ 的常微分方程组。\n$$\n\\sum_{j=0}^{p} \\dot{u}_{e,j} \\int_{-1}^{1} P_j P_k \\frac{h}{2}d\\xi = a \\sum_{j=0}^{p} u_{e,j} \\int_{-1}^{1} P_j \\frac{2}{h} \\frac{dP_k}{d\\xi} \\frac{h}{2}d\\xi - a \\sum_{j=0}^{p} u_{e,j} P_j(1)P_k(1) + a \\sum_{j=0}^{p} u_{e-1,j} P_j(1)P_k(-1)\n$$\n这可以写成系数向量 $u_e = [u_{e,0}, \\dots, u_{e,p}]^T$ 的矩阵形式：\n$$ M_e \\dot{u}_e = a(S - F_R)u_e + a F_L u_{e-1} $$\n其中单元局部矩阵定义如下：\n质量矩阵：$(M_e)_{kj} = \\int_{-1}^1 P_j P_k \\frac{h}{2} d\\xi$。\n刚度矩阵：$(S)_{kj} = \\int_{-1}^1 P_j \\frac{dP_k}{d\\xi} d\\xi$。\n右边界通量矩阵：$(F_R)_{kj} = P_j(1) P_k(1)$。\n左边界通量矩阵：$(F_L)_{kj} = P_j(1) P_k(-1)$。注意 $u_{e-1}$ 在其右边界处取值，这对应于其自身的局部坐标 $\\xi=1$。\n\n全局系统是 $M \\dot{u} = A u$，其中 $M$ 是一个以 $M_e$ 为块的块对角矩阵，而 $A$ 包含对应于均匀周期性网格的自耦合 $A_0 = a(S - F_R)$ 和邻居耦合 $A_{-1} = a F_L$ 的块项。\n\n**2. 多项式次数特化为 $p=1$**\n\n对于 $p=1$，基为 $\\{P_0(\\xi), P_1(\\xi)\\} = \\{1, \\xi\\}$。我们使用 Legendre 多项式的性质：\n$\\int_{-1}^1 P_j P_k d\\xi = \\frac{2}{2j+1}\\delta_{jk}$。\n$P_0(1)=1, P_0(-1)=1$。\n$P_1(1)=1, P_1(-1)=-1$。\n$\\frac{dP_0}{d\\xi}=0, \\frac{dP_1}{d\\xi}=1$。\n\n$2\\times 2$ 的单元矩阵为：\n*   质量矩阵 $M_e$：$(M_e)_{kj} = \\frac{h}{2} \\frac{2}{2k+1}\\delta_{kj} = \\frac{h}{2k+1}\\delta_{kj}$。\n    $$ M_e = h \\begin{pmatrix} 1  & 0 \\\\ 0  & \\frac{1}{3} \\end{pmatrix} $$\n*   刚度矩阵 $S$：$(S)_{kj} = \\int_{-1}^1 P_j \\frac{dP_k}{d\\xi} d\\xi$。\n    $S_{10} = \\int_{-1}^1 P_0 \\frac{dP_1}{d\\xi} d\\xi = \\int_{-1}^1 (1)(1) d\\xi = 2$。所有其他项均为零。\n    $$ S = \\begin{pmatrix} 0  & 0 \\\\ 2  & 0 \\end{pmatrix} $$\n*   通量矩阵 $F_R$ 和 $F_L$：\n    $(F_R)_{kj} = P_j(1) P_k(1) \\implies F_R = \\begin{pmatrix} P_0(1) \\\\ P_1(1) \\end{pmatrix} \\begin{pmatrix} P_0(1)  & P_1(1) \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} 1  & 1 \\end{pmatrix} = \\begin{pmatrix} 1  & 1 \\\\ 1  & 1 \\end{pmatrix}$。\n    $(F_L)_{kj} = P_j(1) P_k(-1) \\implies F_L = \\begin{pmatrix} P_0(1) \\\\ P_1(1) \\end{pmatrix} \\begin{pmatrix} P_0(-1)  & P_1(-1) \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} 1  & -1 \\end{pmatrix} = \\begin{pmatrix} 1  & -1 \\\\ 1  & -1 \\end{pmatrix}$。\n    等等，$(F_L)_{kj} = P_j(1) P_k(-1)$。所以 $F_L = \\begin{pmatrix} P_0(-1) \\\\ P_1(-1) \\end{pmatrix} \\begin{pmatrix} P_0(1) & P_1(1) \\end{pmatrix}^T$ is wrong. It should be column vector times row vector.\n    $F_L = \\begin{pmatrix} P_0(1) \\\\ P_1(1) \\end{pmatrix} \\begin{pmatrix} P_0(-1) & P_1(-1) \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} \\begin{pmatrix} 1 & -1 \\end{pmatrix} = \\begin{pmatrix} 1 & -1 \\\\ 1 & -1 \\end{pmatrix}$. This is incorrect logic.\n    The term is $\\sum_{j=0}^p u_{e-1,j} P_j(1)P_k(-1)$. The matrix acting on $u_{e-1}$ is $(F_L)_{kj} = P_j(1)P_k(-1)$.\n    $F_L$ is:\n    $(F_L)_{00} = P_0(1)P_0(-1) = 1 \\cdot 1 = 1$.\n    $(F_L)_{01} = P_1(1)P_0(-1) = 1 \\cdot 1 = 1$.\n    $(F_L)_{10} = P_0(1)P_1(-1) = 1 \\cdot (-1) = -1$.\n    $(F_L)_{11} = P_1(1)P_1(-1) = 1 \\cdot (-1) = -1$.\n    So $F_L = \\begin{pmatrix} 1 & 1 \\\\ -1 & -1 \\end{pmatrix}$. The original solution is correct.\n\n半离散系统 $M_e \\dot{u}_e = A_0 u_e + A_{-1} u_{e-1}$ 的块矩阵为：\n$$ A_0 = a(S - F_R) = a \\left( \\begin{pmatrix} 0  & 0 \\\\ 2  & 0 \\end{pmatrix} - \\begin{pmatrix} 1  & 1 \\\\ 1  & 1 \\end{pmatrix} \\right) = a \\begin{pmatrix} -1  & -1 \\\\ 1  & -1 \\end{pmatrix} $$\n$$ A_{-1} = a F_L = a \\begin{pmatrix} 1  & 1 \\\\ -1  & -1 \\end{pmatrix} $$\n\n**3. Bloch-Floquet 分析和特征值**\n\n我们假设系数向量具有平面波解（Bloch-Floquet 模式）：$u_e(t) = \\widehat{u} \\exp(\\lambda t) \\exp(i k x_e)$，其中 $\\widehat{u}$ 是一个常向量振幅，$\\lambda$ 是时间特征值，$k$ 是波数。在均匀网格上，$x_{e-1} = x_e - h$，所以 $u_{e-1} = u_e \\exp(-ikh)$。定义 $\\theta = kh$，我们有 $u_{e-1} = u_e \\exp(-i\\theta)$。\n将此代入半离散方程：\n$$ \\lambda M_e u_e = A_0 u_e + A_{-1} u_e \\exp(-i\\theta) $$\n这是一个关于 $\\lambda$ 的广义特征值问题：$\\lambda M_e \\widehat{u} = (A_0 + \\exp(-i\\theta) A_{-1}) \\widehat{u}$。特征值 $\\lambda$ 是符号矩阵 $S(\\theta) = M_e^{-1} (A_0 + \\exp(-i\\theta) A_{-1})$ 的特征值。\n令 $C = \\exp(-i\\theta)$。\n$A_0 + C A_{-1} = a \\begin{pmatrix} -1  & -1 \\\\ 1  & -1 \\end{pmatrix} + a C \\begin{pmatrix} 1  & 1 \\\\ -1  & -1 \\end{pmatrix} = a \\begin{pmatrix} C-1  & C-1 \\\\ 1-C  & -1-C \\end{pmatrix}$。\n$M_e^{-1} = \\frac{1}{h} \\begin{pmatrix} 1  & 0 \\\\ 0  & 3 \\end{pmatrix}$。\n$S(\\theta) = \\frac{a}{h} \\begin{pmatrix} 1  & 0 \\\\ 0  & 3 \\end{pmatrix} \\begin{pmatrix} C-1  & C-1 \\\\ 1-C  & -3(1+C) \\end{pmatrix} = \\frac{a}{h} \\begin{pmatrix} C-1  & C-1 \\\\ 3(1-C)  & -3(1+C) \\end{pmatrix}$。\n\n$S(\\theta)$ 的特征值 $\\lambda$ 满足特征方程 $\\det(S(\\theta) - \\lambda I) = 0$。\n令 $H(\\theta) = \\frac{h}{a}S(\\theta)$。$H(\\theta)$ 的特征值（记为 $\\tilde{\\lambda}$）通过 $\\lambda = \\frac{a}{h}\\tilde{\\lambda}$ 相关联。\n$\\tilde{\\lambda}$ 的特征方程是 $\\tilde{\\lambda}^2 - \\text{tr}(H)\\tilde{\\lambda} + \\det(H) = 0$。\n$\\text{tr}(H) = (C-1) - 3(1+C) = -4-2C$。\n$\\det(H) = (C-1)(-3-3C) - (C-1)(3(1-C)) = (C-1)[-3-3C - 3+3C] = -6(C-1) = 6-6C$。\n该方程为 $\\tilde{\\lambda}^2 + (4+2C)\\tilde{\\lambda} + (6-6C) = 0$。\n解为：\n$$\n\\tilde{\\lambda} = \\frac{-(4+2C) \\pm \\sqrt{(4+2C)^2 - 4(6-6C)}}{2} = -(2+C) \\pm \\sqrt{(2+C)^2 - (6-6C)}\n$$\n$$\n\\tilde{\\lambda} = -(2+C) \\pm \\sqrt{C^2+4C+4 - 6+6C} = -(2+C) \\pm \\sqrt{C^2+10C-2}\n$$\n$\\lambda = \\frac{a}{h} \\tilde{\\lambda}$ 的两个特征值为：\n$$\n\\lambda(\\theta) = \\frac{a}{h} \\left( -(2+\\exp(-i\\theta)) \\pm \\sqrt{\\exp(-i2\\theta)+10\\exp(-i\\theta)-2} \\right)\n$$\n为了识别物理分支，我们考察 $\\theta \\to 0$ 时的行为。连续算子 $\\partial_t = -a\\partial_x$ 的符号为 $-iak = -ia\\frac{\\theta}{h}$。\n我们对小 $\\theta$ 进行展开：$C = \\exp(-i\\theta) \\approx 1-i\\theta - \\frac{\\theta^2}{2}$。\n$-(2+C) \\approx -3+i\\theta+\\frac{\\theta^2}{2}$。\n平方根下的项变为 $\\sqrt{(1-i\\theta)^2 + 10(1-i\\theta) - 2} \\approx \\sqrt{1-2i\\theta + 10-10i\\theta - 2} = \\sqrt{9-12i\\theta} = 3\\sqrt{1-\\frac{4}{3}i\\theta} \\approx 3(1-\\frac{2}{3}i\\theta) = 3-2i\\theta$。\n$\\tilde{\\lambda}$ 的两个分支是：\n$\\tilde{\\lambda}_+ \\approx (-3+i\\theta) + (3-2i\\theta) = -i\\theta$。\n$\\tilde{\\lambda}_- \\approx (-3+i\\theta) - (3-2i\\theta) = -6+3i\\theta$。\n对应的特征值 $\\lambda$ 是：\n$\\lambda_+ \\approx \\frac{a}{h}(-i\\theta) = -iak$。这是物理分支。\n$\\lambda_- \\approx \\frac{a}{h}(-6+3i\\theta)$。这是一个非物理的、有阻尼的数值模式。\n物理分支对应于我们 $\\lambda$ 解中的 '+' 号。\n\n**4. Lax 等价定理和稳定性**\n\nLax-Richtmyer 等价定理指出，对于一个相容的线性格式，稳定性是收敛的充要条件。\nDG 格式是相容的，这一点可以通过以下事实证明：对于长波（$k h \\to 0$），物理特征值分支趋近于连续算子的符号。\n迎风数值通量的选择对稳定性至关重要。对于 $a>0$，这种选择在单元界面引入了数值耗散，从而消除了因不连续表示而可能累积的能量。通过设置测试函数 $v_h=u_h$ 进行的正式能量分析表明，总能量的变化率 $\\frac{d}{dt} \\int |u_h|^2 dx$ 是非正的。这种能量稳定性（或 $L^2$-稳定性）意味着半离散算子的所有特征值 $\\lambda$ 的实部都是非正的，即 $\\text{Re}(\\lambda) \\le 0$。\n由于该格式是相容且稳定的，因此它是收敛的。\n\n所要求的最终答案是物理分支特征值 $\\lambda_{\\mathrm{phys}}(\\theta)$ 的闭式表达式。", "answer": "$$ \\boxed{ \\frac{a}{h} \\left( -(2+\\exp(-i\\theta)) + \\sqrt{\\exp(-i2\\theta)+10\\exp(-i\\theta)-2} \\right) } $$", "id": "3395011"}]}