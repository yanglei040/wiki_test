{"hands_on_practices": [{"introduction": "数值分析的第一步通常是将复杂问题分解为可管理的部分。本练习将重点关注由时间积分方案引入的误差，通过对一个代表性的常微分方程应用经典的四阶龙格－库塔（RK4）方法，您将学习如何通过对放大因子的泰勒展开来量化时间色散和耗散误差。掌握这项基本技能对于评估和选择适合波传播问题的时间积分器至关重要，它使我们能够独立于空间离散化误差来理解时间演化的准确性 [@problem_id:3404837]。", "problem": "考虑一个一维线性常系数双曲偏微分方程，它在周期性域上通过高阶谱间断伽辽金 (SDG) 格式进行空间离散。对于波数对应于半离散频率 $\\omega  0$ 的单个傅里叶模式，其模态振幅的半离散系统可简化为线性常微分方程 $\\frac{d y}{d t} = i \\omega y$，其中 $i$ 是虚数单位。这个纯虚的半离散特征值反映了所考虑模式的基础空间离散格式的非耗散特性。\n\n将经典的显式四阶四步龙格-库塔 (RK) 方法 (RK4) 应用于此半离散系统，时间步长为 $\\Delta t$。令 $z = i \\omega \\Delta t$，并将单步数值放大因子记为 $G(z)$。将时间耗散误差定义为 $\\left|G(z)\\right| - 1$（即放大因子模量与1的偏差），并将时间色散误差定义为 $\\Phi(z) - \\omega \\Delta t$，其中 $\\Phi(z) = \\arg(G(z))$ 是每个时间步长的数值相移（以弧度为单位）。\n\n从 RK4 方法的定义和线性测试方程 $\\frac{d y}{d t} = \\lambda y$（其中 $\\lambda = i \\omega$）出发，推导 RK4 的时间色散误差和时间耗散误差在小参数 $\\xi = \\omega \\Delta t$ 展开中的前导项。明确指出每种误差关于 $\\Delta t$ 的阶数。\n\n将您的最终答案表示为一个行矩阵，其第一项是每个时间步长的弧度制前导色散误差，第二项是每个时间步长的前导耗散误差，两者都写成 $\\omega$ 和 $\\Delta t$ 的解析函数。无需四舍五入。", "solution": "问题陈述是在常微分方程数值分析领域中一个适定且有科学依据的练习，具体涉及经典四阶龙格-库塔方法对振荡问题的稳定性和准确性分析。所有提供的信息在数值方法领域内都是一致、完整且标准的。因此，该问题被认为是有效的。\n\n任务是分析经典的四阶四步龙格-库塔 (RK4) 方法在应用于线性测试方程 $\\frac{d y}{d t} = \\lambda y$ 时引入的时间色散和耗散误差，其中特征值 $\\lambda$ 是纯虚数，$\\lambda = i \\omega$，且 $\\omega  0$。因此，半离散方程为 $\\frac{d y}{d t} = i \\omega y$。\n\n对于初值问题 $\\frac{d y}{d t} = f(t, y)$，时间步长为 $\\Delta t$ 的经典 RK4 方法由以下公式给出：\n$$y_{n+1} = y_n + \\frac{\\Delta t}{6}(k_1 + 2k_2 + 2k_3 + k_4)$$\n其中，各阶段为：\n$$k_1 = f(t_n, y_n)$$\n$$k_2 = f(t_n + \\frac{\\Delta t}{2}, y_n + \\frac{\\Delta t}{2} k_1)$$\n$$k_3 = f(t_n + \\frac{\\Delta t}{2}, y_n + \\frac{\\Delta t}{2} k_2)$$\n$$k_4 = f(t_n + \\Delta t, y_n + \\Delta t k_3)$$\n\n对于线性测试方程，$f(t, y) = \\lambda y$。设 $y_n$ 是在时间 $t_n$ 的近似值。各阶段变为：\n$$k_1 = \\lambda y_n$$\n$$k_2 = \\lambda (y_n + \\frac{\\Delta t}{2} k_1) = \\lambda (y_n + \\frac{\\Delta t}{2} \\lambda y_n) = \\lambda y_n (1 + \\frac{\\lambda \\Delta t}{2})$$\n$$k_3 = \\lambda (y_n + \\frac{\\Delta t}{2} k_2) = \\lambda (y_n + \\frac{\\Delta t}{2} \\lambda y_n (1 + \\frac{\\lambda \\Delta t}{2})) = \\lambda y_n (1 + \\frac{\\lambda \\Delta t}{2} + \\frac{(\\lambda \\Delta t)^2}{4})$$\n$$k_4 = \\lambda (y_n + \\Delta t k_3) = \\lambda (y_n + \\Delta t \\lambda y_n (1 + \\frac{\\lambda \\Delta t}{2} + \\frac{(\\lambda \\Delta t)^2}{4})) = \\lambda y_n (1 + \\lambda \\Delta t + \\frac{(\\lambda \\Delta t)^2}{2} + \\frac{(\\lambda \\Delta t)^3}{4})$$\n\n将这些代入 $y_{n+1}$ 的更新公式中：\n$$y_{n+1} = y_n + \\frac{\\Delta t}{6} \\left[ \\lambda y_n + 2\\lambda y_n \\left(1 + \\frac{\\lambda \\Delta t}{2}\\right) + 2\\lambda y_n \\left(1 + \\frac{\\lambda \\Delta t}{2} + \\frac{(\\lambda \\Delta t)^2}{4}\\right) + \\lambda y_n \\left(1 + \\lambda \\Delta t + \\frac{(\\lambda \\Delta t)^2}{2} + \\frac{(\\lambda \\Delta t)^3}{4}\\right) \\right]$$\n提出因子 $y_n$ 并令 $z = \\lambda \\Delta t$：\n$$\\frac{y_{n+1}}{y_n} = 1 + \\frac{1}{6} \\left[ z + 2z\\left(1 + \\frac{z}{2}\\right) + 2z\\left(1 + \\frac{z}{2} + \\frac{z^2}{4}\\right) + z\\left(1 + z + \\frac{z^2}{2} + \\frac{z^3}{4}\\right) \\right]$$\n$$\\frac{y_{n+1}}{y_n} = 1 + \\frac{1}{6} \\left[ z + 2z + z^2 + 2z + z^2 + \\frac{z^3}{2} + z + z^2 + \\frac{z^3}{2} + \\frac{z^4}{4} \\right]$$\n$$\\frac{y_{n+1}}{y_n} = 1 + \\frac{1}{6} \\left[ 6z + 3z^2 + z^3 + \\frac{z^4}{4} \\right] \\rightarrow \\text{这又错了。存在计算错误。}$$\n让我们仔细地重新开始求和：\n$\\frac{y_{n+1}}{y_n} = 1 + \\frac{\\Delta t}{6} \\left[ (1+2+2+1)\\lambda + (2\\frac{\\Delta t}{2} + 2\\frac{\\Delta t}{2} + \\Delta t)\\lambda^2 + (2\\frac{\\Delta t^2}{4} + \\frac{\\Delta t^2}{2})\\lambda^3 + \\frac{\\Delta t^3}{4}\\lambda^4 \\right]$\n$\\frac{y_{n+1}}{y_n} = 1 + \\frac{\\Delta t}{6} \\left[ 6\\lambda + 3\\lambda^2\\Delta t + \\lambda^3\\Delta t^2 + \\frac{1}{4}\\lambda^4\\Delta t^3 \\right]$\n$\\frac{y_{n+1}}{y_n} = 1 + \\lambda\\Delta t + \\frac{(\\lambda\\Delta t)^2}{2} + \\frac{(\\lambda\\Delta t)^3}{6} + \\frac{(\\lambda\\Delta t)^4}{24}$\n所以，放大因子是正确的：\n$$G(z) = 1 + z + \\frac{z^2}{2!} + \\frac{z^3}{3!} + \\frac{z^4}{4!}$$\n这是 $\\exp(z)$ 的四阶泰勒级数展开。\n\n问题指定 $\\lambda = i\\omega$，所以我们设置 $z = i\\omega\\Delta t$。令 $\\xi = \\omega\\Delta t$。因此，$z = i\\xi$。\n$$G(i\\xi) = 1 + i\\xi + \\frac{(i\\xi)^2}{2} + \\frac{(i\\xi)^3}{6} + \\frac{(i\\xi)^4}{24} = 1 + i\\xi - \\frac{\\xi^2}{2} - i\\frac{\\xi^3}{6} + \\frac{\\xi^4}{24}$$\n分离实部和虚部：\n$$G(i\\xi) = \\left(1 - \\frac{\\xi^2}{2} + \\frac{\\xi^4}{24}\\right) + i\\left(\\xi - \\frac{\\xi^3}{6}\\right)$$\n\n**时间色散误差**\n\n每个时间步长的色散误差是 $\\Phi(z) - \\omega\\Delta t = \\arg(G(i\\xi)) - \\xi$。数值相位是 $\\Phi(i\\xi) = \\arg(G(i\\xi))$，可以使用虚部与实部之比的反正切函数计算。\n$$\\Phi(i\\xi) = \\arctan\\left(\\frac{\\xi - \\xi^3/6}{1 - \\xi^2/2 + \\xi^4/24}\\right)$$\n对于小的 $\\xi$，我们进行泰勒展开。首先，展开 $\\arctan$ 函数的自变量：\n$$\\frac{\\xi - \\xi^3/6}{1 - \\xi^2/2 + \\xi^4/24} = (\\xi - \\frac{\\xi^3}{6})\\left(1 - (\\frac{\\xi^2}{2} - \\frac{\\xi^4}{24}))\\right)^{-1}$$\n使用 $(1-u)^{-1} = 1 + u + u^2 + \\dots$ 并令 $u = \\frac{\\xi^2}{2} - \\frac{\\xi^4}{24}$：\n$$= (\\xi - \\frac{\\xi^3}{6})\\left(1 + \\left(\\frac{\\xi^2}{2} - \\frac{\\xi^4}{24}\\right) + \\left(\\frac{\\xi^2}{2}\\right)^2 + O(\\xi^6)\\right)$$\n$$= (\\xi - \\frac{\\xi^3}{6})\\left(1 + \\frac{\\xi^2}{2} - \\frac{\\xi^4}{24} + \\frac{\\xi^4}{4} + O(\\xi^6)\\right) = (\\xi - \\frac{\\xi^3}{6})\\left(1 + \\frac{\\xi^2}{2} + \\frac{5\\xi^4}{24} + O(\\xi^6)\\right)$$\n$$= \\xi + \\frac{\\xi^3}{2} + \\frac{5\\xi^5}{24} - \\frac{\\xi^3}{6} - \\frac{\\xi^5}{12} + O(\\xi^7) = \\xi + \\frac{\\xi^3}{3} + \\frac{3\\xi^5}{24} + O(\\xi^7) = \\xi + \\frac{\\xi^3}{3} + \\frac{\\xi^5}{8} + O(\\xi^7)$$\n现在，使用 $\\arctan(x) = x - \\frac{x^3}{3} + \\frac{x^5}{5} - \\dots$ 的泰勒级数：\n$$\\Phi(i\\xi) = \\left(\\xi + \\frac{\\xi^3}{3} + \\frac{\\xi^5}{8}\\right) - \\frac{1}{3}\\left(\\xi + \\frac{\\xi^3}{3}\\right)^3 + \\frac{1}{5}\\left(\\xi\\right)^5 + O(\\xi^7)$$\n$$\\Phi(i\\xi) = \\xi + \\frac{\\xi^3}{3} + \\frac{\\xi^5}{8} - \\frac{1}{3}\\left(\\xi^3 + \\xi^5 + \\dots\\right) + \\frac{\\xi^5}{5} + O(\\xi^7)$$\n$$\\Phi(i\\xi) = \\xi + \\left(\\frac{1}{3} - \\frac{1}{3}\\right)\\xi^3 + \\left(\\frac{1}{8} - \\frac{1}{3} + \\frac{1}{5}\\right)\\xi^5 + O(\\xi^7)$$\n$$\\Phi(i\\xi) = \\xi + \\left(\\frac{15 - 40 + 24}{120}\\right)\\xi^5 + O(\\xi^7) = \\xi - \\frac{1}{120}\\xi^5 + O(\\xi^7)$$\n色散误差是 $\\Phi(i\\xi) - \\xi$。其前导项是：\n$$\\text{色散误差} = -\\frac{1}{120}\\xi^5 = -\\frac{1}{120}(\\omega\\Delta t)^5$$\n此误差的阶数为 $O((\\Delta t)^5)$。\n\n**时间耗散误差**\n\n耗散误差是 $|G(z)| - 1 = |G(i\\xi)| - 1$。我们首先计算 $|G(i\\xi)|^2$：\n$$|G(i\\xi)|^2 = \\left(1 - \\frac{\\xi^2}{2} + \\frac{\\xi^4}{24}\\right)^2 + \\left(\\xi - \\frac{\\xi^3}{6}\\right)^2$$\n展开每一项并合并 $\\xi$ 的同次幂：\n$$= \\left(1 - \\xi^2 + \\frac{\\xi^4}{3} - \\frac{\\xi^6}{24} + \\frac{\\xi^8}{576}\\right) + \\left(\\xi^2 - \\frac{\\xi^4}{3} + \\frac{\\xi^6}{36}\\right)$$\n$$= 1 + (-\\xi^2 + \\xi^2) + (\\frac{\\xi^4}{3} - \\frac{\\xi^4}{3}) + (-\\frac{\\xi^6}{24} + \\frac{\\xi^6}{36}) + O(\\xi^8)$$\n$$= 1 + \\left(\\frac{-3+2}{72}\\right)\\xi^6 + O(\\xi^8) = 1 - \\frac{\\xi^6}{72} + O(\\xi^8)$$\n现在我们通过取平方根来求 $|G(i\\xi)|$。使用二项式展开 $(1+x)^{1/2} = 1 + \\frac{1}{2}x + O(x^2)$：\n$$|G(i\\xi)| = \\left(1 - \\frac{\\xi^6}{72} + O(\\xi^8)\\right)^{1/2} = 1 + \\frac{1}{2}\\left(-\\frac{\\xi^6}{72}\\right) + O(\\xi^8) = 1 - \\frac{\\xi^6}{144} + O(\\xi^8)$$\n耗散误差是 $|G(i\\xi)| - 1$。其前导项是：\n$$\\text{耗散误差} = -\\frac{1}{144}\\xi^6 = -\\frac{1}{144}(\\omega\\Delta t)^6$$\n此误差的阶数为 $O((\\Delta t)^6)$。\n\n每个时间步长的领先阶时间色散误差为 $-\\frac{(\\omega\\Delta t)^5}{120}$，领先阶时间耗散误差为 $-\\frac{(\\omega\\Delta t)^6}{144}$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-\\frac{(\\omega \\Delta t)^5}{120}  -\\frac{(\\omega \\Delta t)^6}{144}\n\\end{pmatrix}\n}\n$$", "id": "3404837"}, {"introduction": "在分析了时间误差之后，我们将注意力转向空间离散化，特别是间断伽辽金（DG）方法。这个练习通过两个对比鲜明的场景，揭示了求积规则在 DG 方法中的核心作用。您将首先证明在线性问题中，精确的求积如何确保能量守恒，然后计算在处理非线性项时因积分不足而产生的混叠误差 [@problem_id:3404800]。这项实践突显了非线性如何引入独特的数值挑战，并强调了在设计数值方案时仔细考虑积分精确度的重要性。", "problem": "考虑在周期区间 $\\left[-\\pi,\\pi\\right]$ 上标量场的一维平流问题。现提出两个问题。\n\n问题 A（线性平流与伪耗散消除）：设偏微分方程为线性平流方程 $u_{t} + a\\,u_{x} = 0$，其中波速 $a \\in \\mathbb{R}$ 为常数。在 $\\left[-\\pi,\\pi\\right]$ 上使用单元数为1的间断伽辽金 (DG) 方法，以 $p$ 次多项式进行逼近，并在边界处使用中心数值通量进行离散。DG 弱形式使用精确的体积分和面积分求积。假设使用具有 $N_{q} = p+1$ 个节点的 Gauß–Lobatto 求积，该求积方法对次数最高为 $2N_{q}-3 = 2p-1$ 的多项式是精确的。从 DG 质量矩阵、刚度算子以及由质量矩阵诱导的能量范数的定义出发，推导半离散格式的离散能量平衡，并证明在周期区间上，使用中心通量和精确求积时，离散能量率为零。\n\n问题 B（非线性平流与欠积分下的残余混叠误差）：在同一周期区间 $\\left[-\\pi,\\pi\\right]$ 上考虑守恒形式的无粘性 Burgers 方程 $u_{t} + \\left(\\frac{u^{2}}{2}\\right)_{x} = 0$。设初始条件为 $u(x,0) = \\sin(x)$。连续能量率是 $\\frac{1}{2}\\int_{-\\pi}^{\\pi}u^{2}(x,t)\\,\\mathrm{d}x$ 的时间导数，对于周期域上的光滑解，已知其值为零。在 DG 体积分项中，假设非线性通量导数 $\\left(\\frac{u^{2}}{2}\\right)_{x}$ 在物理区间上使用具有 $N_{q} = 4$ 个节点的 Gauß–Lobatto 求积进行积分。参考区间 $\\left[-1,1\\right]$ 上的 $N_{q} = 4$ 个 Gauß–Lobatto 节点为 $\\xi_{1}=-1$, $\\xi_{2}=-\\frac{1}{\\sqrt{5}}$, $\\xi_{3}=\\frac{1}{\\sqrt{5}}$, $\\xi_{4}=1$，对应的权重为 $w_{1}=\\frac{1}{6}$, $w_{2}=\\frac{5}{6}$, $w_{3}=\\frac{5}{6}$, $w_{4}=\\frac{1}{6}$。通过 $x = \\pi \\,\\xi$ 映射到物理区间，因此求积权重按 $\\pi$ 缩放。将残余混叠误差 $E_{\\mathrm{alias}}$ 定义为在 $t=0$ 时应用的连续能量率泛函的求积近似，即 $u^{2}(x,0)\\,u_{x}(x,0)$ 在 $\\left[-\\pi,\\pi\\right]$ 上的 Gauß–Lobatto 求积，由于非线性被积函数的欠积分，该值会偏离精确值 $0$。使用给定的求积节点和权重，计算 $E_{\\mathrm{alias}}$ 的闭式解析表达式。\n\n请将您的最终答案以一个包含两个元素的行矩阵形式给出，其中包括：\n- 问题 A 在周期区间上使用中心通量和精确求积时的离散能量率。\n- 问题 B 在指定的欠积分设置下的残余混叠误差 $E_{\\mathrm{alias}}$。\n\n无需四舍五入。在出现三角函数时，角度以弧度隐式表示。", "solution": "该问题被评估为有效，因为它具有科学依据、适定、客观，并为偏微分方程数值分析中的两个标准问题提供了完整且一致的设置。\n\n### 问题 A：线性平流与伪耗散消除\n\n我们被要求推导线性平流方程 $u_{t} + a\\,u_{x} = 0$ 在周期区间 $[-\\pi, \\pi]$ 上的间断伽辽金 (DG) 离散的离散能量平衡，并证明能量率为零。\n\nDG 半离散格式是通过将偏微分方程与一个来自 $p$ 次多项式空间的测试函数 $v_h$ 相乘，并在单个单元 $\\Omega = [-\\pi, \\pi]$ 上积分得到的：\n$$ \\int_{-\\pi}^{\\pi} u_{h,t} v_h \\, \\mathrm{d}x + \\int_{-\\pi}^{\\pi} a u_{h,x} v_h \\, \\mathrm{d}x = 0 $$\n此处，$u_h(x,t)$ 是 $p$ 次多项式逼近。对第二项进行分部积分可得：\n$$ \\int_{-\\pi}^{\\pi} u_{h,t} v_h \\, \\mathrm{d}x - \\int_{-\\pi}^{\\pi} a u_h v_{h,x} \\, \\mathrm{d}x + [a u_h v_h]_{x=-\\pi}^{x=\\pi} = 0 $$\n边界项 $[a u_h v_h]_{-\\pi}^{\\pi}$ 被替换为来自数值通量 $F^*(u_h^-, u_h^+)$ 的贡献。对于周期域，边界由点 $x=\\pi$ 连接到点 $x=-\\pi$ 构成。边界项可以写成 $\\oint_{\\partial\\Omega} F^* v_h \\, \\mathrm{d}S$。对于我们的一维、单单元情况，这变为：\n$$ F^*(u_h(\\pi), u_h(-\\pi)) v_h(\\pi) - F^*(u_h(-\\pi), u_h(\\pi)) v_h(-\\pi) $$\n因此，弱形式为：\n$$ \\int_{-\\pi}^{\\pi} u_{h,t} v_h \\, \\mathrm{d}x - \\int_{-\\pi}^{\\pi} a u_h v_{h,x} \\, \\mathrm{d}x + F^*(u_h(\\pi), u_h(-\\pi)) v_h(\\pi) - F^*(u_h(-\\pi), u_h(\\pi)) v_h(-\\pi) = 0 $$\n为了得到能量平衡，我们将测试函数设为等于解，即 $v_h = u_h$：\n$$ \\int_{-\\pi}^{\\pi} u_{h,t} u_h \\, \\mathrm{d}x - \\int_{-\\pi}^{\\pi} a u_h u_{h,x} \\, \\mathrm{d}x + F^*(u_h(\\pi), u_h(-\\pi)) u_h(\\pi) - F^*(u_h(-\\pi), u_h(\\pi)) u_h(-\\pi) = 0 $$\n第一项是离散能量 $E(t) = \\frac{1}{2} \\int_{-\\pi}^{\\pi} u_h^2 \\, \\mathrm{d}x$ 的时间导数：\n$$ \\int_{-\\pi}^{\\pi} u_{h,t} u_h \\, \\mathrm{d}x = \\frac{1}{2} \\frac{\\mathrm{d}}{\\mathrm{d}t} \\int_{-\\pi}^{\\pi} u_h^2 \\, \\mathrm{d}x = \\frac{\\mathrm{d}E}{\\mathrm{d}t} $$\n重新整理以求能量变化率：\n$$ \\frac{\\mathrm{d}E}{\\mathrm{d}t} = \\int_{-\\pi}^{\\pi} a u_h u_{h,x} \\, \\mathrm{d}x - \\left( F^*(u_h(\\pi), u_h(-\\pi)) u_h(\\pi) - F^*(u_h(-\\pi), u_h(\\pi)) u_h(-\\pi) \\right) $$\n问题陈述中指明使用了精确求积。因此，体积分项可以被精确计算：\n$$ \\int_{-\\pi}^{\\pi} a u_h u_{h,x} \\, \\mathrm{d}x = a \\int_{-\\pi}^{\\pi} \\frac{1}{2} \\frac{\\mathrm{d}}{\\mathrm{d}x}(u_h^2) \\, \\mathrm{d}x = \\frac{a}{2} [u_h^2]_{-\\pi}^{\\pi} = \\frac{a}{2} (u_h^2(\\pi) - u_h^2(-\\pi)) $$\n问题指定了中心数值通量，定义为 $F^*(u_L, u_R) = a \\frac{u_L+u_R}{2}$。在 $x=\\pi$ 处，内部状态为 $u_L = u_h(\\pi)$，外部状态（来自周期性对应的另一侧）为 $u_R = u_h(-\\pi)$。在 $x=-\\pi$ 处，内部状态为 $u_L = u_h(-\\pi)$，外部状态为 $u_R = u_h(\\pi)$。面积分项变为：\n$$ a \\frac{u_h(\\pi)+u_h(-\\pi)}{2} u_h(\\pi) - a \\frac{u_h(-\\pi)+u_h(\\pi)}{2} u_h(-\\pi) $$\n$$ = \\frac{a}{2} \\left( (u_h(\\pi)+u_h(-\\pi))u_h(\\pi) - (u_h(\\pi)+u_h(-\\pi))u_h(-\\pi) \\right) $$\n$$ = \\frac{a}{2} \\left( u_h^2(\\pi) + u_h(\\pi)u_h(-\\pi) - u_h(\\pi)u_h(-\\pi) - u_h^2(-\\pi) \\right) $$\n$$ = \\frac{a}{2} (u_h^2(\\pi) - u_h^2(-\\pi)) $$\n将计算出的体积分项和面积分项代回能量率方程：\n$$ \\frac{\\mathrm{d}E}{\\mathrm{d}t} = \\frac{a}{2} (u_h^2(\\pi) - u_h^2(-\\pi)) - \\frac{a}{2} (u_h^2(\\pi) - u_h^2(-\\pi)) = 0 $$\n因此，离散能量率为零。该格式是能量守恒的。\n\n### 问题 B：非线性平流与欠积分下的残余混叠误差\n\n我们被要求在指定的 Gauß–Lobatto 求积法则下，计算无粘性 Burgers 方程的残余混叠误差 $E_{\\mathrm{alias}}$。\n问题将 $E_{\\mathrm{alias}}$ 定义为 $u^2(x,0) u_x(x,0)$ 在 $[-\\pi, \\pi]$ 上的积分的求积近似。\n初始条件为 $u(x,0) = \\sin(x)$。其空间导数为 $u_x(x,0) = \\cos(x)$。\n被积函数为 $f(x) = u^2(x,0) u_x(x,0) = \\sin^2(x) \\cos(x)$。\n$\\int_{-\\pi}^{\\pi} f(x) \\, \\mathrm{d}x$ 的求积近似由 $\\sum_{j=1}^{N_q} f(x_j) w_j^{\\text{phys}}$ 给出，其中 $N_q=4$。\n\n求积在参考区间 $\\xi \\in [-1,1]$ 上定义，其节点和权重如下：\n节点：$\\xi_1=-1$, $\\xi_2=-\\frac{1}{\\sqrt{5}}$, $\\xi_3=\\frac{1}{\\sqrt{5}}$, $\\xi_4=1$。\n权重：$w_1=\\frac{1}{6}$, $w_2=\\frac{5}{6}$, $w_3=\\frac{5}{6}$, $w_4=\\frac{1}{6}$。\n到物理区间 $x \\in [-\\pi, \\pi]$ 的映射为 $x = \\pi \\xi$。该变换的雅可比为 $J = \\frac{\\mathrm{d}x}{\\mathrm{d}\\xi} = \\pi$。\n物理节点 $x_j = \\pi \\xi_j$ 为：\n$x_1 = -\\pi$, $x_2 = -\\frac{\\pi}{\\sqrt{5}}$, $x_3 = \\frac{\\pi}{\\sqrt{5}}$, $x_4 = \\pi$。\n物理权重 $w_j^{\\text{phys}} = w_j J$ 为：\n$w_1^{\\text{phys}} = \\frac{\\pi}{6}$, $w_2^{\\text{phys}} = \\frac{5\\pi}{6}$, $w_3^{\\text{phys}} = \\frac{5\\pi}{6}$, $w_4^{\\text{phys}} = \\frac{\\pi}{6}$。\n\n现在我们通过对每个节点的贡献求和来计算 $E_{\\mathrm{alias}}$：\n$$ E_{\\mathrm{alias}} = \\sum_{j=1}^{4} \\sin^2(x_j) \\cos(x_j) w_j^{\\text{phys}} $$\n对于 $j=1$ ($x_1 = -\\pi$) 的项：\n$$ \\sin^2(-\\pi) \\cos(-\\pi) \\cdot \\frac{\\pi}{6} = (0)^2 \\cdot (-1) \\cdot \\frac{\\pi}{6} = 0 $$\n对于 $j=2$ ($x_2 = -\\frac{\\pi}{\\sqrt{5}}$) 的项：\n$$ \\sin^2(-\\frac{\\pi}{\\sqrt{5}}) \\cos(-\\frac{\\pi}{\\sqrt{5}}) \\cdot \\frac{5\\pi}{6} = (-\\sin(\\frac{\\pi}{\\sqrt{5}}))^2 \\cos(\\frac{\\pi}{\\sqrt{5}}) \\cdot \\frac{5\\pi}{6} = \\frac{5\\pi}{6} \\sin^2(\\frac{\\pi}{\\sqrt{5}}) \\cos(\\frac{\\pi}{\\sqrt{5}}) $$\n对于 $j=3$ ($x_3 = \\frac{\\pi}{\\sqrt{5}}$) 的项：\n$$ \\sin^2(\\frac{\\pi}{\\sqrt{5}}) \\cos(\\frac{\\pi}{\\sqrt{5}}) \\cdot \\frac{5\\pi}{6} = \\frac{5\\pi}{6} \\sin^2(\\frac{\\pi}{\\sqrt{5}}) \\cos(\\frac{\\pi}{\\sqrt{5}}) $$\n对于 $j=4$ ($x_4 = \\pi$) 的项：\n$$ \\sin^2(\\pi) \\cos(\\pi) \\cdot \\frac{\\pi}{6} = (0)^2 \\cdot (-1) \\cdot \\frac{\\pi}{6} = 0 $$\n对各项求和：\n$$ E_{\\mathrm{alias}} = 0 + \\frac{5\\pi}{6} \\sin^2(\\frac{\\pi}{\\sqrt{5}}) \\cos(\\frac{\\pi}{\\sqrt{5}}) + \\frac{5\\pi}{6} \\sin^2(\\frac{\\pi}{\\sqrt{5}}) \\cos(\\frac{\\pi}{\\sqrt{5}}) + 0 $$\n$$ E_{\\mathrm{alias}} = 2 \\cdot \\frac{5\\pi}{6} \\sin^2(\\frac{\\pi}{\\sqrt{5}}) \\cos(\\frac{\\pi}{\\sqrt{5}}) $$\n$$ E_{\\mathrm{alias}} = \\frac{5\\pi}{3} \\sin^2(\\frac{\\pi}{\\sqrt{5}}) \\cos(\\frac{\\pi}{\\sqrt{5}}) $$\n这就是残余混叠误差的闭式解析表达式。该积分的精确值为 $\\int_{-\\pi}^{\\pi} \\sin^2(x)\\cos(x)\\,\\mathrm{d}x = 0$，因此计算出的非零值完全代表了由欠解析求积引起的混叠误差。\n\n两个问题的最终结果是：\n1.  问题 A 的离散能量率：$0$。\n2.  问题 B 的残余混叠误差 $E_{\\mathrm{alias}}$：$\\frac{5\\pi}{3} \\sin^2(\\frac{\\pi}{\\sqrt{5}}) \\cos(\\frac{\\pi}{\\sqrt{5}})$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  \\frac{5\\pi}{3} \\sin^2\\left(\\frac{\\pi}{\\sqrt{5}}\\right) \\cos\\left(\\frac{\\pi}{\\sqrt{5}}\\right)\n\\end{pmatrix}\n}\n$$", "id": "3404800"}, {"introduction": "理论分析的最终目的是指导实际的计算实践。本练习将通过一个编程任务，将色散和耗散的概念应用于一个现实世界的问题：设计一个数值滤波器以抑制吉布斯振荡。您将实现一个可调谐的指数滤波器，并量化其在耗散高波数内容与保持低波数相位精度之间的权衡 [@problem_id:3404850]。这个动手实践的编码练习将理论与实践联系起来，让您能够构建、测试并直接观察到您的设计选择如何影响最终的解的质量。", "problem": "考虑一维线性平流方程 $u_t + a\\,u_x = 0$，定义在周期性域 $x \\in [0,2\\pi)$ 上，其中波速为 $a$。傅里叶谱配置法可以精确表示单个傅里叶模式 $u(x,t) = \\hat{u}(t)\\,e^{i k x}$ 的空间导数，其中 $k \\in \\mathbb{Z}$ 表示整数波数。为了在保持低波数相位精度的同时减少间断点附近的吉布斯振荡，在每个显式时间步后应用一个模式滤波器。目标是量化在高波数内容抑制（耗散）与低波数相速度保持（色散）之间的权衡。\n\n从控制方程 $u_t + a\\,u_x = 0$ 出发，谱导数的傅里叶符号是 $i k$。使用三阶强保稳龙格-库塔方法（SSP-RK3），特别是 Shu–Osher 形式的三阶总变差减小龙格-库塔方法（TVD-RK3），对于线性常系数系统 $u_t = L u$ 的单步放大因子多项式由指数函数的截断泰勒级数给出：\n$$\nG_{\\text{RK3}}(\\lambda) = 1 + \\lambda + \\frac{1}{2}\\lambda^2 + \\frac{1}{6}\\lambda^3,\n$$\n其中 $\\lambda = \\Delta t\\,L$。对于线性平流，$L = -a\\,\\partial_x$，对于傅里叶模式 $e^{i k x}$，有 $L \\mapsto -a\\,i k$，因此 $\\lambda = -i\\,a\\,k\\,\\Delta t$。一个 $m$ 阶的调谐指数模式滤波器的传递函数定义为\n$$\n\\sigma(k) = \\exp\\!\\left(-\\alpha\\,\\left(\\frac{|k|}{k_{\\max}}\\right)^{2m}\\right),\n$$\n其中 $k_{\\max}$ 是网格上可分辨的最大波数，$m \\in \\mathbb{N}$ 是滤波器阶数，并且选择 $\\alpha  0$ 以在截止比率 $r_{\\mathrm{cut}} \\in (0,1)$ 处满足指定的衰减：\n$$\n\\sigma\\!\\left(r_{\\mathrm{cut}}\\,k_{\\max}\\right) = s_{\\mathrm{target}} \\quad \\Rightarrow \\quad \\alpha = -\\frac{\\ln(s_{\\mathrm{target}})}{r_{\\mathrm{cut}}^{2m}}.\n$$\n因此，波数 $k$ 的组合单步放大因子为\n$$\nG(k) = \\sigma(k)\\,G_{\\text{RK3}}(-i\\,a\\,k\\,\\Delta t).\n$$\n将数值角频率定义为 $G_{\\text{RK3}}$ 的辐角（以弧度为单位），\n$$\n\\omega_{\\text{num}}(k) = \\frac{\\arg\\!\\left(G_{\\text{RK3}}(-i\\,a\\,k\\,\\Delta t)\\right)}{\\Delta t},\n$$\n数值相速度定义为 $c_{\\text{num}}(k) = \\omega_{\\text{num}}(k)/k$。因为 $\\sigma(k)$ 是实数且为正，所以它不改变相位，只改变振幅。\n\n您必须编写一个完整、可运行的程序，为每个测试案例计算两个度量指标：\n- 低波数相位误差：\n$$\nE_{\\text{phase,low}} = \\max_{k/k_{\\max} \\in (0,r_{\\text{phase}}]}\\left| \\frac{c_{\\text{num}}(k)}{a} - 1 \\right|,\n$$\n它量化了低波数处的色散，表示为一个无量纲小数。角度必须以弧度为单位进行测量。\n- 高波数平均每步耗散：\n$$\nD_{\\text{high}} = \\frac{1}{\\#\\{k: k/k_{\\max} \\in [r_{\\text{diss}},1]\\}} \\sum_{k/k_{\\max} \\in [r_{\\text{diss}},1]}\\left(1 - |G(k)|\\right),\n$$\n它量化了由滤波器和时间步长引起的衰减，表示为一个无量纲小数。\n\n使用在 $[0,2\\pi)$ 上的具有 $N$ 个点的均匀网格，因此可分辨的波数是整数且 $k_{\\max} = N/2$。取 $a = 1$。程序必须在正波数集合 $k = 1,2,\\dots,k_{\\max}$ 上评估这些度量指标。低波数阈值为 $r_{\\text{phase}} = 0.2$，高波数阈值为 $r_{\\text{diss}} = 0.6$。\n\n通过上述公式，根据 $s_{\\mathrm{target}}$ 和 $r_{\\mathrm{cut}}$ 选择 $\\alpha$ 来实现调谐滤波器。如果 $s_{\\mathrm{target}} = 1$，则将其解释为无滤波器情况，即 $\\alpha = 0$。\n\n设计程序以处理以下三个测试案例：\n- 案例 $1$：$(N=\\;256,\\; \\Delta t=\\;0.05,\\; m=\\;8,\\; r_{\\mathrm{cut}}=\\;0.7,\\; s_{\\mathrm{target}}=\\;1.0)$。\n- 案例 $2$：$(N=\\;256,\\; \\Delta t=\\;0.05,\\; m=\\;8,\\; r_{\\mathrm{cut}}=\\;0.7,\\; s_{\\mathrm{target}}=\\;0.1)$。\n- 案例 $3$：$(N=\\;256,\\; \\Delta t=\\;0.05,\\; m=\\;16,\\; r_{\\mathrm{cut}}=\\;0.6,\\; s_{\\mathrm{target}}=\\;0.001)$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，顺序为 $[E_{\\text{phase,low}}^{(1)},D_{\\text{high}}^{(1)},E_{\\text{phase,low}}^{(2)},D_{\\text{high}}^{(2)},E_{\\text{phase,low}}^{(3)},D_{\\text{high}}^{(3)}]$，其中上标表示案例编号。所有角度必须以弧度处理，输出为无量纲小数。", "solution": "起点是周期域上的一维线性平流方程 $u_t + a\\,u_x = 0$。对于一个傅里叶模式 $u(x,t) = \\hat{u}(t)\\,e^{i k x}$，代入可得\n$$\n\\frac{d\\hat{u}}{dt} + a\\,i\\,k\\,\\hat{u} = 0,\n$$\n这是一个常系数 $L = -a\\,i\\,k$ 的线性常微分方程。在一个时间步 $\\Delta t$ 内的精确解具有放大因子 $e^{\\lambda}$，其中 $\\lambda = \\Delta t\\,L = -i\\,a\\,k\\,\\Delta t$。\n\n我们考虑 Shu–Osher 三阶总变差减小龙格-库塔方法（三阶强保稳龙ge-库塔方法）。对于任何线性系统 $u_t = L u$，其单步放大因子多项式是指数函数的三阶泰勒多项式：\n$$\nG_{\\text{RK3}}(\\lambda) = 1 + \\lambda + \\frac{1}{2}\\lambda^2 + \\frac{1}{6}\\lambda^3.\n$$\n当 $L$ 是线性时，这直接源于 Shu–Osher TVD-RK3 的分步更新：\n- 第一阶段：$u^{(1)} = (1+\\lambda)u^n$。\n- 第二阶段：$u^{(2)} = \\frac{3}{4}u^n + \\frac{1}{4}\\left(1 + 2\\lambda + \\lambda^2\\right)u^n = \\left(1 + \\frac{1}{2}\\lambda + \\frac{1}{4}\\lambda^2\\right)u^n$。\n- 第三阶段：$u^{n+1} = \\frac{1}{3}u^n + \\frac{2}{3}\\left(1 + \\frac{3}{2}\\lambda + \\frac{3}{4}\\lambda^2 + \\frac{1}{4}\\lambda^3\\right)u^n = \\left(1 + \\lambda + \\frac{1}{2}\\lambda^2 + \\frac{1}{6}\\lambda^3\\right)u^n$。\n\n对于空间导数的傅里叶谱配置离散化，其符号是精确的：对于模式 $e^{i k x}$，有 $\\partial_x \\mapsto i k$。因此，对于平流速度 $a$，半离散算子为 $L = -a\\,i\\,k$，龙格-库塔步的放大因子为 $G_{\\text{RK3}}(-i\\,a\\,k\\,\\Delta t)$。\n\n为减轻与高波数内容相关的吉布斯振荡，我们在每一步后应用一个调谐指数模式滤波器。该滤波器的传递函数是\n$$\n\\sigma(k) = \\exp\\!\\left(-\\alpha\\,\\left(\\frac{|k|}{k_{\\max}}\\right)^{2m}\\right),\n$$\n其中 $m$ 是滤波器阶数，$k_{\\max} = N/2$ 对应于 $[0,2\\pi)$ 上的 $N$ 个等距点，并选择 $\\alpha$ 以满足在截止比率 $r_{\\mathrm{cut}}$ 处的设计约束：\n$$\n\\sigma(r_{\\mathrm{cut}}\\,k_{\\max}) = s_{\\mathrm{target}} \\;\\Rightarrow\\; \\alpha = -\\frac{\\ln(s_{\\mathrm{target}})}{r_{\\mathrm{cut}}^{2m}}.\n$$\n当 $s_{\\mathrm{target}} = 1$ 时，我们将其解释为无滤波，因此 $\\alpha = 0$ 且对所有 $k$ 都有 $\\sigma(k) = 1$。\n\n波数 $k$ 的组合单步放大因子是\n$$\nG(k) = \\sigma(k)\\,G_{\\text{RK3}}(-i\\,a\\,k\\,\\Delta t),\n$$\n这是一个复数。其模 $|G(k)|$ 反映了耗散（振幅衰减），其辐角 $\\arg(G(k))$ 反映了相位推进。然而，由于 $\\sigma(k)$ 是实数且为正，它不改变相位；因此，色散完全由 $G_{\\text{RK3}}$ 控制。\n\n我们将数值角频率定义为\n$$\n\\omega_{\\text{num}}(k) = \\frac{\\arg\\!\\left(G_{\\text{RK3}}(-i\\,a\\,k\\,\\Delta t)\\right)}{\\Delta t},\n$$\n数值相速度定义为 $c_{\\text{num}}(k) = \\omega_{\\text{num}}(k)/k$。精确相速度为 $a$。低波数相位误差度量指标则为\n$$\nE_{\\text{phase,low}} = \\max_{k/k_{\\max} \\in (0,r_{\\text{phase}}]}\\left| \\frac{c_{\\text{num}}(k)}{a} - 1 \\right|,\n$$\n该指标在正波数集合 $k = 1,2,\\dots,k_{\\max}$ 上评估，其中比率 $k/k_{\\max}$ 位于 $(0,r_{\\text{phase}}]$ 内，$r_{\\text{phase}}$ 是一个预设的阈值。此度量指标是无量纲的。\n\n高波数平均每步耗散定义为\n$$\nD_{\\text{high}} = \\frac{1}{K_{\\text{count}}}\\sum_{k/k_{\\max} \\in [r_{\\text{diss}},1]}\\left(1 - |G(k)|\\right),\n$$\n其中 $K_{\\text{count}}$ 是指定高波数范围内的波数数量，而 $|G(k)|$ 是组合放大因子的模。此度量指标也是无量纲的，并反映了权衡关系：更大的耗散能抑制吉布斯振荡，但会减小高频内容的振幅。\n\n对于每个测试案例 $(N,\\Delta t,m,r_{\\mathrm{cut}},s_{\\mathrm{target}})$（其中 $a=1$）的算法步骤如下：\n1. 设置 $k_{\\max} = N/2$，并构建正整数波数数组 $k = 1,2,\\dots,k_{\\max}$。\n2. 对每个 $k$ 计算比率 $r(k) = k/k_{\\max}$。\n3. 计算 $\\alpha = -\\ln(s_{\\mathrm{target}})/r_{\\mathrm{cut}}^{2m}$，并约定如果 $s_{\\mathrm{target}} = 1$ 则 $\\alpha = 0$。\n4. 评估滤波器 $\\sigma(k) = \\exp\\left(-\\alpha\\,r(k)^{2m}\\right)$。\n5. 计算 $\\lambda(k) = -i\\,a\\,k\\,\\Delta t$ 和龙格-库塔放大因子 $G_{\\text{RK3}}(\\lambda) = 1 + \\lambda + \\frac{1}{2}\\lambda^2 + \\frac{1}{6}\\lambda^3$。\n6. 构成组合放大因子 $G(k) = \\sigma(k)\\,G_{\\text{RK3}}(\\lambda)$。\n7. 仅使用 $G_{\\text{RK3}}$ 计算相速度：$c_{\\text{num}}(k) = \\arg(G_{\\text{RK3}}(\\lambda))/(\\Delta t\\,k)$，其中角度以弧度为单位。\n8. 计算 $E_{\\text{phase,low}}$，即在 $r(k) \\in (0,r_{\\text{phase}}]$ 的 $k$ 范围内 $\\left|c_{\\text{num}}(k)/a - 1\\right|$ 的最大值，其中 $r_{\\text{phase}} = 0.2$。\n9. 计算 $D_{\\text{high}}$，即在 $r(k) \\in [r_{\\text{diss}},1]$ 的 $k$ 范围内 $1 - |G(k)|$ 的平均值，其中 $r_{\\text{diss}} = 0.6$。\n10. 按指定的顺序和格式输出三个测试案例的六个结果。\n\n科学真实性和数值稳健性：\n- 傅里叶谱导数符号 $i k$ 对于傅里叶模式是精确的，这为色散分析提供了一个没有导数空间离散化误差的清晰基础。\n- TVD-RK3 放大因子多项式是一个经过充分检验的公式，代表了三阶时间精度。\n- 指数滤波器是谱方法中的一种标准设计；通过在截止比率处指定衰减来调整 $\\alpha$ 的方法被广泛用于控制吉布斯振荡，同时最小化低波数失真。\n- 色散度量指标关注物理保真度最关键的低波数区域，而耗散度量指标则强调吉布斯振荡发生的高波数区域。\n- 角度以弧度为单位测量，所有输出均为无量纲小数，符合单位要求。\n\n测试套件与最终输出：\n- 案例 $1$：$(N=\\;256,\\; \\Delta t=\\;0.05,\\; m=\\;8,\\; r_{\\mathrm{cut}}=\\;0.7,\\; s_{\\mathrm{target}}=\\;1.0)$。\n- 案例 $2$：$(N=\\;256,\\; \\Delta t=\\;0.05,\\; m=\\;8,\\; r_{\\mathrm{cut}}=\\;0.7,\\; s_{\\mathrm{target}}=\\;0.1)$。\n- 案例 $3$：$(N=\\;256,\\; \\Delta t=\\;0.05,\\; m=\\;16,\\; r_{\\mathrm{cut}}=\\;0.6,\\; s_{\\mathrm{target}}=\\;0.001)$。\n程序必须打印单行：$[E_{\\text{phase,low}}^{(1)},D_{\\text{high}}^{(1)},E_{\\text{phase,low}}^{(2)},D_{\\text{high}}^{(2)},E_{\\text{phase,low}}^{(3)},D_{\\text{high}}^{(3)}]$，其中每个量都是一个小数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef rk3_amplification(lambda_k: np.ndarray) - np.ndarray:\n    \"\"\"\n    Compute the Shu-Osher TVD-RK3 amplification polynomial G_RK3(lambda)\n    for a given array of lambda values.\n    G_RK3(lambda) = 1 + lambda + 0.5*lambda^2 + (1/6)*lambda^3\n    \"\"\"\n    return 1.0 + lambda_k + 0.5 * (lambda_k ** 2) + (1.0 / 6.0) * (lambda_k ** 3)\n\ndef tuned_exponential_filter(r: np.ndarray, m: int, r_cut: float, s_target: float) - np.ndarray:\n    \"\"\"\n    Compute the tuned exponential filter sigma(k) = exp(-alpha * r^(2m)),\n    where r = |k|/k_max. Alpha is chosen so that sigma(r_cut) = s_target.\n    If s_target == 1.0, alpha is set to 0 (no filter).\n    \"\"\"\n    if np.isclose(s_target, 1.0):\n        alpha = 0.0\n    else:\n        # alpha = -ln(s_target) / r_cut^(2m)\n        alpha = -np.log(s_target) / (r_cut ** (2 * m))\n    sigma = np.exp(-alpha * (r ** (2 * m)))\n    return sigma\n\ndef compute_metrics(N: int, dt: float, m: int, r_cut: float, s_target: float,\n                    a: float = 1.0, r_phase: float = 0.2, r_diss: float = 0.6) - tuple[float, float]:\n    \"\"\"\n    Compute E_phase_low and D_high for the given parameters.\n    - N: number of grid points on [0, 2*pi)\n    - dt: time step\n    - m: filter order\n    - r_cut: cut-off ratio for tuning\n    - s_target: target attenuation at r_cut\n    - a: advection speed (default 1.0)\n    - r_phase: threshold for low-wavenumber phase error metric\n    - r_diss: threshold for high-wavenumber dissipation metric\n    Returns (E_phase_low, D_high) as floats.\n    \"\"\"\n    k_max = N // 2\n    # Positive wavenumbers 1..k_max\n    k = np.arange(1, k_max + 1, dtype=float)\n    r = k / k_max\n\n    # Semi-discrete lambda for linear advection with spectral derivative\n    lambda_k = -1j * a * k * dt\n\n    # RK3 amplification (phase carrier)\n    G_rk3 = rk3_amplification(lambda_k)\n\n    # Tuned filter sigma (magnitude-only; real and positive)\n    sigma = tuned_exponential_filter(r, m, r_cut, s_target)\n\n    # Combined amplification per step\n    G_combined = sigma * G_rk3\n\n    # Low-wavenumber phase error metric: use phase of G_rk3 only (filter does not change phase)\n    # angle in radians\n    omega_num = np.angle(G_rk3) / dt\n    c_num = omega_num / k  # numerical phase speed\n\n    # Mask for low-wavenumber band\n    low_mask = (r > 0.0)  (r = r_phase)\n    if not np.any(low_mask):\n        # Should not happen for provided parameters, but guard anyway\n        E_phase_low = 0.0\n    else:\n        E_phase_low = np.max(np.abs(c_num[low_mask] / a - 1.0))\n\n    # High-wavenumber dissipation: mean(1 - |G|)\n    high_mask = (r >= r_diss)  (r = 1.0)\n    if not np.any(high_mask):\n        D_high = 0.0\n    else:\n        mag = np.abs(G_combined[high_mask])\n        D_high = float(np.mean(1.0 - mag))\n\n    return float(E_phase_low), float(D_high)\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each test case: (N, dt, m, r_cut, s_target)\n    test_cases = [\n        (256, 0.05, 8, 0.7, 1.0),     # Case 1: no filter\n        (256, 0.05, 8, 0.7, 0.1),     # Case 2: moderate filter\n        (256, 0.05, 16, 0.6, 0.001),  # Case 3: aggressive filter\n    ]\n\n    results = []\n    for case in test_cases:\n        N, dt, m, r_cut, s_target = case\n        E_phase_low, D_high = compute_metrics(N=N, dt=dt, m=m, r_cut=r_cut, s_target=s_target)\n        # Optionally round for cleaner output; keep sufficient precision\n        results.append(f\"{E_phase_low:.10f}\")\n        results.append(f\"{D_high:.10f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3404850"}]}