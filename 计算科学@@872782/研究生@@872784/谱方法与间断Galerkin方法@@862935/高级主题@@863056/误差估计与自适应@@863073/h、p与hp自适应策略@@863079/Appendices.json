{"hands_on_practices": [{"introduction": "任何自适应方法的核心都是能够在每个单元上局部地估计数值误差。本练习将重点计算基于残差的后验误差估计量的各个贡献项，这是不连续伽辽金方法中的一个常用工具。通过计算单元和面上的项，您将具体理解不同误差源是如何被加权和识别的，这是指导网格加密的关键第一步 [@problem_id:3389838]。", "problem": "考虑一个在二维域上通过对称内部罚间断伽辽金方法 (SIPDG) 离散化的标量泊松问题。设单个内部四边形单元 $T$ 是一个边长为 $h=10^{-1}$ 的正方形，多项式次数为 $p=3$。记内部残差为 $r_{T}=f+\\Delta u_{h}$，梯度法向分量在面 $F$ 上的跳跃为 $j_{F}=[\\nabla u_{h}\\cdot n_{F}]$，解在面 $F$ 上的跳跃为 $s_{F}=[u_{h}]$。假设罚参数具有典范 SIPDG 缩放 $\\sigma=\\kappa p^{2}/h$，并将形状正则常数和 $\\kappa$ 设为 $1$。\n\n给定以下 $L^{2}$-范数：\n- 单元 $T$ 上的内部残差范数：$\\|r_{T}\\|_{T}=2.0$。\n- 四个面 $F_{1},F_{2},F_{3},F_{4}$ 上的通量跳跃范数：$\\|j_{F_{1}}\\|_{F_{1}}=1.5$, $\\|j_{F_{2}}\\|_{F_{2}}=0.6$, $\\|j_{F_{3}}\\|_{F_{3}}=1.0$, $\\|j_{F_{4}}\\|_{F_{4}}=0.2$。\n- 四个面上的解跳跃范数：$\\|s_{F_{1}}\\|_{F_{1}}=2\\times 10^{-2}$, $\\|s_{F_{2}}\\|_{F_{2}}=8\\times 10^{-2}$, $\\|s_{F_{3}}\\|_{F_{3}}=4\\times 10^{-2}$, $\\|s_{F_{4}}\\|_{F_{4}}=10^{-1}$。\n\n从形状正则单元上多项式的基本不等式（逆估计和迹不等式）以及 SIPDG 稳定性缩放出发，推导基于局部残差的后验估计子对单元和面的贡献的典范 $h-p$ 加权形式。使用这些推导出的缩放关系计算：\n- 单元残差贡献 $\\eta_{T}$。\n- 对 $i\\in\\{1,2,3,4\\}$ 的面贡献 $\\eta_{F_{i}}$。\n\n最后，确定哪个面 $F_{i}$ 具有最大的面贡献（即起主导作用），并报告该主导面的索引 $i\\in\\{1,2,3,4\\}$ 作为最终答案。不需要四舍五入，最终答案必须是无单位的单个整数索引 $i$。", "solution": "对于标量泊松方程，对称内部罚间断伽辽金方法 (SIPDG) 通过添加一个罚项来构建矫顽性。对于多项式次数为 $p$ 和特征单元尺寸为 $h$ 的情况，该罚项的缩放形式为 $\\sigma=\\kappa p^{2}/h$，其中 $\\kappa>0$ 是一个常数。在此背景下，对于基于残差的后验估计子，单元残差和面跳跃的典范 $h-p$ 缩放关系源于多项式空间的逆不等式和迹不等式的组合，并与本文“原理与机制”一章中给出的公式一致。\n\n这些权重为：\n- 单元内部残差的平方以 $(h/p)^2$ 进行加权：\n$$\n\\eta_{T}^2=\\left(\\frac{h}{p}\\right)^2\\|r_{T}\\|_{T}^{2}\n$$\n- 面 $F$ 上的通量跳跃的平方以 $h/p$ 进行加权：\n$$\n\\eta_{F, \\text{flux}}^2=\\left(\\frac{h}{p}\\right)\\|j_{F}\\|_{F}^{2}\n$$\n- 面 $F$ 上的解跳跃的平方以 $p^2/h$ 进行加权，这与 SIPDG 罚项的缩放一致：\n$$\n\\eta_{F, \\text{sol}}^2=\\left(\\frac{p^{2}}{h}\\right)\\|s_{F}\\|_{F}^{2}\n$$\n\n在本练习中，我们将问题中的“贡献”$\\eta_T$ 和 $\\eta_F$ 理解为这些加权后的平方项。我们将形状正则常数和 $\\kappa$ 设为 $1$。局部面贡献是通量贡献和解跳跃贡献之和：\n$$\n\\eta_{F}^2=\\left(\\frac{h}{p}\\right)\\|j_{F}\\|_{F}^{2}+\\left(\\frac{p^{2}}{h}\\right)\\|s_{F}\\|_{F}^{2}\n$$\n\n我们现在计算 $h=10^{-1}$ 和 $p=3$ 时的数值：\n$$\n\\frac{h}{p}=\\frac{10^{-1}}{3}=\\frac{1}{30},\\quad \\left(\\frac{h}{p}\\right)^2=\\frac{1}{900},\\quad \\frac{p^{2}}{h}=\\frac{9}{10^{-1}}=90\n$$\n\n单元残差贡献：\n$$\n\\eta_{T}^2=\\left(\\frac{h}{p}\\right)^{2}\\|r_{T}\\|_{T}^{2}=\\frac{1}{900}(2.0)^{2}=\\frac{4}{900}=\\frac{1}{225}\\approx 0.00444\\ldots\n$$\n\n面贡献：\n\n对于 $F_{1}$，其中 $\\|j_{F_{1}}\\|_{F_{1}}=1.5$ 且 $\\|s_{F_{1}}\\|_{F_{1}}=2\\times 10^{-2}$，\n$$\n\\eta_{F_{1}}^2=\\frac{1}{30}(1.5)^{2}+90(2\\times 10^{-2})^{2}=\\frac{1}{30}\\cdot 2.25+90\\cdot 4\\times 10^{-4}=0.075+0.036=0.111\n$$\n\n对于 $F_{2}$，其中 $\\|j_{F_{2}}\\|_{F_{2}}=0.6$ 且 $\\|s_{F_{2}}\\|_{F_{2}}=8\\times 10^{-2}$，\n$$\n\\eta_{F_{2}}^2=\\frac{1}{30}(0.6)^{2}+90(8\\times 10^{-2})^{2}=\\frac{1}{30}\\cdot 0.36+90\\cdot 6.4\\times 10^{-3}=0.012+0.576=0.588\n$$\n\n对于 $F_{3}$，其中 $\\|j_{F_{3}}\\|_{F_{3}}=1.0$ 且 $\\|s_{F_{3}}\\|_{F_{3}}=4\\times 10^{-2}$，\n$$\n\\eta_{F_{3}}^2=\\frac{1}{30}(1.0)^{2}+90(4\\times 10^{-2})^{2}=\\frac{1}{30}\\cdot 1+90\\cdot 1.6\\times 10^{-3} \\approx 0.0333\\ldots+0.144 \\approx 0.1773\\ldots\n$$\n\n对于 $F_{4}$，其中 $\\|j_{F_{4}}\\|_{F_{4}}=0.2$ 且 $\\|s_{F_{4}}\\|_{F_{4}}=10^{-1}$，\n$$\n\\eta_{F_{4}}^2=\\frac{1}{30}(0.2)^{2}+90(10^{-1})^{2}=\\frac{1}{30}\\cdot 0.04+90\\cdot 10^{-2} \\approx 0.00133\\ldots+0.9 \\approx 0.9013\\ldots\n$$\n\n为了确定主导面，我们比较各个面的贡献：\n$$\n\\eta_{F_{1}}^2 \\approx 0.111,\\quad\n\\eta_{F_{2}}^2 \\approx 0.588,\\quad\n\\eta_{F_{3}}^2 \\approx 0.177,\\quad\n\\eta_{F_{4}}^2 \\approx 0.901\n$$\n最大值为 $\\eta_{F_{4}}^2$，因此主导面是 $F_{4}$，其索引为 $4$。", "answer": "$$\\boxed{4}$$", "id": "3389838"}, {"introduction": "一旦计算出整个网格的局部误差指标，下一步就是决定要加密哪些单元。Dörfler标记策略为此提供了一个稳健且广泛使用的选择标准，确保总估计误差的固定部分被作为优化的目标。本练习将让您亲手实践这一基本的标记算法，它是“估计-标记-加密”循环中的一个关键组成部分 [@problem_id:3389874]。", "problem": "考虑一个标量椭圆边值问题在一维网格上的间断 Galerkin (DG) 离散，该网格有 $10$ 个单元。离散采用 $hp$ 自适应策略，其中网格尺寸 ($h$) 和多项式阶数 ($p$) 在后续步骤中都根据局部后验误差指标进行细化。假设一个可靠且高效的基于残差的估计子为当前网格提供了非负的局部指标 $\\{\\eta_{K}\\}_{K=1}^{10}$，下面列出了各指标及其单元索引 $K=1,2,\\dots,10$：\n- $K=1$: $\\eta_{1}=0.90$,\n- $K=2$: $\\eta_{2}=0.85$,\n- $K=3$: $\\eta_{3}=0.75$,\n- $K=4$: $\\eta_{4}=0.60$,\n- $K=5$: $\\eta_{5}=0.58$,\n- $K=6$: $\\eta_{6}=0.40$,\n- $K=7$: $\\eta_{7}=0.35$,\n- $K=8$: $\\eta_{8}=0.30$,\n- $K=9$: $\\eta_{9}=0.25$,\n- $K=10$: $\\eta_{10}=0.20$。\n\n使用参数为 $\\theta=0.50$ 的 Dörfler 体标记策略，确定必须标记的单元的最小数量，使得被标记指标的总和至少是所有指标总和的 $\\theta$ 倍。然后，在你的推理中，证明为什么通过你的程序得到的被标记单元集合在满足体准则的条件下最小化了被标记单元的数量。\n\n将你的最终答案报告为被标记集合的最小基数 $m$。无需四舍五入。", "solution": "该问题要求将 Dörfler 体标记策略应用于给定的一组局部误差指标 $\\{\\eta_K\\}_{K=1}^{10}$，该指标集用于一维间断 Galerkin (DG) 离散。目标是确定必须为细化而标记的最小单元数。\n\nDörfler 体标记策略识别出一个被标记的单元集合，记为 $\\mathcal{M}$，它是所有单元集合 $\\mathcal{T}$ 的一个子集。标记的准则是，被标记单元的局部误差指标之和必须大于或等于所有局部误差指标总和的预定分数 $\\theta$。数学上，这表示为：\n$$\n\\sum_{K \\in \\mathcal{M}} \\eta_K \\ge \\theta \\sum_{K \\in \\mathcal{T}} \\eta_K\n$$\n问题要求满足此条件的集合 $\\mathcal{M}$ 的最小可能基数 $m = |\\mathcal{M}|$。\n\n首先，我们列出给定的数据：\n- 10个局部误差指标的集合：\n  $\\eta_{1}=0.90$, $\\eta_{2}=0.85$, $\\eta_{3}=0.75$, $\\eta_{4}=0.60$, $\\eta_{5}=0.58$, $\\eta_{6}=0.40$, $\\eta_{7}=0.35$, $\\eta_{8}=0.30$, $\\eta_{9}=0.25$, $\\eta_{10}=0.20$。\n- Dörfler 标记参数：$\\theta = 0.50$。\n\n第一步是计算所有误差指标的总和，我们将其记为 $E_{\\text{total}}$。\n$$\nE_{\\text{total}} = \\sum_{K=1}^{10} \\eta_K = 0.90 + 0.85 + 0.75 + 0.60 + 0.58 + 0.40 + 0.35 + 0.30 + 0.25 + 0.20\n$$\n$$\nE_{\\text{total}} = 5.18\n$$\n接下来，我们计算 Dörfler 准则所要求的目标和，我们将其记为 $E_{\\text{target}}$。\n$$\nE_{\\text{target}} = \\theta \\cdot E_{\\text{total}} = 0.50 \\times 5.18 = 2.59\n$$\n任务是找到一个具有最少单元数量的集合 $\\mathcal{M}$，使得 $\\sum_{K \\in \\mathcal{M}} \\eta_K \\ge 2.59$。\n\n为了最小化 $\\mathcal{M}$ 中的单元数量，我们必须选择对总和贡献最大的单元。这提示我们使用贪心算法：我们应该按降序对误差指标进行排序，并将它们逐一添加到我们的集合中，直到它们的累积和达到或超过目标和 $E_{\\text{target}}$。\n\n给定的指标已经按降序排列：\n$\\eta_1 = 0.90 > \\eta_2 = 0.85 > \\eta_3 = 0.75 > \\dots > \\eta_{10} = 0.20$。\n\n让我们计算累积和，每次添加一个单元，从最大的指标开始：\n1.  标记单元 $K=1$：累积和 = $\\eta_1 = 0.90$。条件 $0.90 \\ge 2.59$ 未满足。\n2.  标记单元 $K=2$：累积和 = $\\eta_1 + \\eta_2 = 0.90 + 0.85 = 1.75$。条件 $1.75 \\ge 2.59$ 未满足。\n3.  标记单元 $K=3$：累积和 = $1.75 + \\eta_3 = 1.75 + 0.75 = 2.50$。条件 $2.50 \\ge 2.59$ 未满足。\n4.  标记单元 $K=4$：累积和 = $2.50 + \\eta_4 = 2.50 + 0.60 = 3.10$。条件 $3.10 \\ge 2.59$ 已满足。\n\n过程到此停止。被标记的单元集合是 $\\mathcal{M} = \\{K=1, K=2, K=3, K=4\\}$。该集合中的单元数量为 4。因此，最小基数为 $m=4$。\n\n现在，我们必须证明为什么这个过程能够产生具有最少单元数量的集合。\n设指标按降序排序：$\\eta_{(1)} \\ge \\eta_{(2)} \\ge \\dots \\ge \\eta_{(10)}$。我们的贪心程序选择前 $m$ 个单元，其中 $m$ 是满足 $\\sum_{i=1}^m \\eta_{(i)} \\ge E_{\\text{target}}$ 的最小整数。在我们的例子中，$m=4$。\n\n考虑任何其他基数为 $m'  m$ 的被标记单元集合 $\\mathcal{M}'$。我们要证明 $\\mathcal{M}'$ 不能满足 Dörfler 准则。集合 $\\mathcal{M}'$ 的指标之和为 $\\sum_{K \\in \\mathcal{M}'} \\eta_K$。对于固定的基数 $m'$，要最大化这个和，必须选择具有最大指标的 $m'$ 个单元。因此，对于任何基数为 $|\\mathcal{M}'| = m'$ 的集合 $\\mathcal{M}'$，以下不等式成立：\n$$\n\\sum_{K \\in \\mathcal{M}'} \\eta_K \\le \\sum_{i=1}^{m'} \\eta_{(i)}\n$$\n因为我们假设 $m'  m$，我们知道 $m' \\le m-1$。因为所有指标都是非负的，所以和是项数的非减函数。因此：\n$$\n\\sum_{i=1}^{m'} \\eta_{(i)} \\le \\sum_{i=1}^{m-1} \\eta_{(i)}\n$$\n根据我们贪心算法的停止条件，我们知道前 $m-1$ 个最大指标的和严格小于目标和：\n$$\n\\sum_{i=1}^{m-1} \\eta_{(i)}  E_{\\text{target}}\n$$\n结合这些不等式，我们得到：\n$$\n\\sum_{K \\in \\mathcal{M}'} \\eta_K \\le \\sum_{i=1}^{m'} \\eta_{(i)} \\le \\sum_{i=1}^{m-1} \\eta_{(i)}  E_{\\text{target}}\n$$\n这表明，任何基数 $m'$ 小于 $m$ 的集合 $\\mathcal{M}'$ 都将无法满足 Dörfler 准则。因此，所需的最小单元数量确实是 $m=4$，这是通过贪心选择过程找到的。", "answer": "$$\n\\boxed{4}\n$$", "id": "3389874"}, {"introduction": "当一个单元被标记为需要加密后，一个 $hp$-自适应策略必须决定是分裂该单元（$h$-加密）还是提高其多项式阶数（$p$-加密）。一个用于 $p$-自适应的有力指标是解的光谱系数的衰减率。本练习将指导您将一个节点解的表示形式转换为模态表示，并利用最高阶模态中的能量来做出关于 $p$-加密的明智决策 [@problem_id:3389829]。", "problem": "考虑在区间 $[-1,1]$ 上的一个一维谱元，在间断伽辽金（DG）离散化中，其多项式阶数为 $p=3$。其中，DG 基函数是在 Gauss–Lobatto–Legendre 点上的节点拉格朗日多项式。对于 $p=3$，Gauss–Lobatto–Legendre 点为 $x_0=-1$，$x_1=-\\frac{1}{\\sqrt{5}}$，$x_2=\\frac{1}{\\sqrt{5}}$ 和 $x_3=1$，对应的求积权重为 $w_0=\\frac{1}{6}$，$w_1=\\frac{5}{6}$，$w_2=\\frac{5}{6}$ 和 $w_3=\\frac{1}{6}$。节点 DG 系数（即多项式近似在这些节点上的值）由下式给出：\n$$\nu_0=-2,\\quad\nu_1=2-\\frac{3}{\\sqrt{5}}-\\frac{1}{5},\\quad\nu_2=2+\\frac{3}{\\sqrt{5}}-\\frac{1}{5},\\quad\nu_3=4.\n$$\n使用 $[-1,1]$ 上的标准勒让德多项式 $L_n(x)$（其中 $L_0(x)=1$，$L_1(x)=x$，$L_2(x)=\\frac{1}{2}(3x^2-1)$，$L_3(x)=\\frac{1}{2}(5x^3-3x)$）和 $L^2([-1,1])$ 内积，通过确定模态系数 $a_n$，将节点表示转换为分层模态表示 $u(x)=\\sum_{n=0}^{p} a_n L_n(x)$。然后，将总能量定义为\n$$\nE_{\\mathrm{tot}}=\\sum_{n=0}^{p} a_n^2 \\,\\frac{2}{2n+1},\n$$\n并将高阶能量定义为包含在最高两个模态中的能量，\n$$\nE_{\\mathrm{hi}}=a_2^2 \\,\\frac{2}{5}+a_3^2 \\,\\frac{2}{7}.\n$$\n从第一性原理出发，使用 $L^2$ 投影的定义和勒让德多项式的正交性来求得 $a_n$。你可以使用上面所述的 Gauss–Lobatto–Legendre 求积法则来计算所需的积分。设 $p$-自适应决策规则为：如果比率 $r=\\frac{E_{\\mathrm{hi}}}{E_{\\mathrm{tot}}}$ 严格小于阈值 $\\tau=0.02$，则将 $p$ 增加 $1$；否则将 $p$ 减少 $1$。计算该谱元的下一个多项式阶数 $p_{\\mathrm{next}}$。最终答案必须是单个实数 $p_{\\mathrm{next}}$。无需四舍五入。", "solution": "该问题是有效的，因为它具有科学依据、适定且客观。它提供了数值分析领域（特别是谱方法）中一套完整且一致的数据和定义，用以在 $p$-自适应方案中确定下一个多项式阶数。\n\n求解过程需要将谱元上函数 $u(x)$ 的给定节点表示转换为分层模态表示。函数 $u(x)$ 在单元 $[-1, 1]$ 内是一个阶数为 $p=3$ 的多项式。其模态表示由一系列正交勒让德多项式 $L_n(x)$ 给出：\n$$u(x) = \\sum_{n=0}^{p} a_n L_n(x)$$\n模态系数 $a_n$ 是通过使用 $L^2([-1,1])$ 内积将 $u(x)$ 投影到每个基函数 $L_n(x)$ 上来确定的，该内积定义为 $\\langle f, g \\rangle = \\int_{-1}^1 f(x)g(x) dx$。勒让德多项式在此内积下是正交的，满足：\n$$\\langle L_n, L_m \\rangle = \\int_{-1}^{1} L_n(x) L_m(x) dx = \\frac{2}{2n+1} \\delta_{nm}$$\n其中 $\\delta_{nm}$ 是克罗内克 δ。\n\n为了求出系数 $a_k$，我们将 $u(x)$ 与 $L_k(x)$ 做内积：\n$$\\langle u, L_k \\rangle = \\left\\langle \\sum_{n=0}^{3} a_n L_n, L_k \\right\\rangle = \\sum_{n=0}^{3} a_n \\langle L_n, L_k \\rangle = a_k \\langle L_k, L_k \\rangle = a_k \\frac{2}{2k+1}$$\n这就得到了模态系数的公式：\n$$a_k = \\frac{2k+1}{2} \\int_{-1}^{1} u(x) L_k(x) dx$$\n问题规定，此积分必须使用给定的 Gauss–Lobatto–Legendre (GLL) 求积法则进行计算，该法则具有 $p+1=4$ 个节点 $\\{x_j\\}_{j=0}^3$ 和权重 $\\{w_j\\}_{j=0}^3$：\n$$\\int_{-1}^1 f(x) dx \\approx \\sum_{j=0}^{3} f(x_j) w_j$$\n该求积对于最高阶为 $2p-1 = 2(3)-1=5$ 的多项式是精确的。将此应用于 $a_k$ 的公式，我们得到：\n$$a_k = \\frac{2k+1}{2} \\sum_{j=0}^{3} u(x_j) L_k(x_j) w_j$$\n我们已知节点值 $u_j = u(x_j)$。首先，我们在 GLL 节点 $x_j$ 上计算勒让德多项式 $L_k(x)$ 的值：\n节点为 $x_0=-1$，$x_1=-1/\\sqrt{5}$，$x_2=1/\\sqrt{5}$，$x_3=1$。\n勒让德多项式为 $L_0(x)=1$，$L_1(x)=x$，$L_2(x)=\\frac{1}{2}(3x^2-1)$，$L_3(x)=\\frac{1}{2}(5x^3-3x)$。\n\n$L_k(x_j)$ 的值为：\n对于 $k=0$：对所有 $j$ 都有 $L_0(x_j)=1$。\n对于 $k=1$：$L_1(x_0)=-1$, $L_1(x_1)=-1/\\sqrt{5}$, $L_1(x_2)=1/\\sqrt{5}$, $L_1(x_3)=1$。\n对于 $k=2$：$L_2(x_0)=1$, $L_2(x_1)=-1/5$, $L_2(x_2)=-1/5$, $L_2(x_3)=1$。\n对于 $k=3$：$L_3(x_0)=-1$, $L_3(x_1)=1/\\sqrt{5}$, $L_3(x_2)=-1/\\sqrt{5}$, $L_3(x_3)=1$。\n\n现在我们使用给定的节点值 $u_0=-2$，$u_1=2-\\frac{3}{\\sqrt{5}}-\\frac{1}{5}$，$u_2=2+\\frac{3}{\\sqrt{5}}-\\frac{1}{5}$，$u_3=4$ 和权重 $w_0=1/6$，$w_1=5/6$，$w_2=5/6$，$w_3=1/6$ 来计算系数 $a_k$。\n\n对于 $a_0$ ($k=0$)：\n$$a_0 = \\frac{1}{2} \\sum_{j=0}^{3} u_j w_j = \\frac{1}{2} \\left[(-2)\\frac{1}{6} + \\left(2-\\frac{3}{\\sqrt{5}}-\\frac{1}{5}\\right)\\frac{5}{6} + \\left(2+\\frac{3}{\\sqrt{5}}-\\frac{1}{5}\\right)\\frac{5}{6} + (4)\\frac{1}{6}\\right]$$\n$$a_0 = \\frac{1}{12} \\left[-2 + 5\\left(2-\\frac{3}{\\sqrt{5}}-\\frac{1}{5} + 2+\\frac{3}{\\sqrt{5}}-\\frac{1}{5}\\right) + 4\\right] = \\frac{1}{12} \\left[2 + 5\\left(4-\\frac{2}{5}\\right)\\right] = \\frac{1}{12} \\left[2 + 20-2\\right] = \\frac{20}{12} = \\frac{5}{3}$$\n\n对于 $a_1$ ($k=1$)：\n$$a_1 = \\frac{3}{2} \\sum_{j=0}^{3} u_j w_j L_1(x_j) = \\frac{3}{2} \\left[(-2)\\frac{1}{6}(-1) + \\left(2-\\frac{3}{\\sqrt{5}}-\\frac{1}{5}\\right)\\frac{5}{6}\\left(-\\frac{1}{\\sqrt{5}}\\right) + \\left(2+\\frac{3}{\\sqrt{5}}-\\frac{1}{5}\\right)\\frac{5}{6}\\left(\\frac{1}{\\sqrt{5}}\\right) + (4)\\frac{1}{6}(1)\\right]$$\n$$a_1 = \\frac{3}{12} \\left[2 + \\frac{5}{\\sqrt{5}}\\left(-\\left(2-\\frac{3}{\\sqrt{5}}-\\frac{1}{5}\\right) + \\left(2+\\frac{3}{\\sqrt{5}}-\\frac{1}{5}\\right)\\right) + 4\\right] = \\frac{1}{4} \\left[6 + \\sqrt{5}\\left(\\frac{6}{\\sqrt{5}}\\right)\\right] = \\frac{1}{4} [6+6] = 3$$\n\n对于 $a_2$ ($k=2$)：\n$$a_2 = \\frac{5}{2} \\sum_{j=0}^{3} u_j w_j L_2(x_j) = \\frac{5}{2} \\left[(-2)\\frac{1}{6}(1) + \\left(2-\\frac{3}{\\sqrt{5}}-\\frac{1}{5}\\right)\\frac{5}{6}\\left(-\\frac{1}{5}\\right) + \\left(2+\\frac{3}{\\sqrt{5}}-\\frac{1}{5}\\right)\\frac{5}{6}\\left(-\\frac{1}{5}\\right) + (4)\\frac{1}{6}(1)\\right]$$\n$$a_2 = \\frac{5}{12} \\left[-2 - \\left(2-\\frac{3}{\\sqrt{5}}-\\frac{1}{5} + 2+\\frac{3}{\\sqrt{5}}-\\frac{1}{5}\\right) + 4\\right] = \\frac{5}{12} \\left[2 - \\left(4-\\frac{2}{5}\\right)\\right] = \\frac{5}{12} \\left[2 - \\frac{18}{5}\\right] = \\frac{5}{12} \\left[\\frac{10-18}{5}\\right] = \\frac{5}{12} \\left(-\\frac{8}{5}\\right) = -\\frac{8}{12} = -\\frac{2}{3}$$\n\n对于 $a_3$ ($k=3$)：\n$$a_3 = \\frac{7}{2} \\sum_{j=0}^{3} u_j w_j L_3(x_j) = \\frac{7}{2} \\left[(-2)\\frac{1}{6}(-1) + \\left(2-\\frac{3}{\\sqrt{5}}-\\frac{1}{5}\\right)\\frac{5}{6}\\left(\\frac{1}{\\sqrt{5}}\\right) + \\left(2+\\frac{3}{\\sqrt{5}}-\\frac{1}{5}\\right)\\frac{5}{6}\\left(-\\frac{1}{\\sqrt{5}}\\right) + (4)\\frac{1}{6}(1)\\right]$$\n$$a_3 = \\frac{7}{12} \\left[2 + \\frac{5}{\\sqrt{5}}\\left(\\left(2-\\frac{3}{\\sqrt{5}}-\\frac{1}{5}\\right) - \\left(2+\\frac{3}{\\sqrt{5}}-\\frac{1}{5}\\right)\\right) + 4\\right] = \\frac{7}{12} \\left[6 + \\sqrt{5}\\left(-\\frac{6}{\\sqrt{5}}\\right)\\right] = \\frac{7}{12} [6-6] = 0$$\n注意，给定的节点值定义了一个多项式 $u(x)=2+3x-x^2$，其阶数为 $2$。这与 $a_3=0$ 一致。$a_3$ 的被积函数是 $u(x)L_3(x)$，是一个阶数为 $2+3=5$ 的多项式，因此 GLL 求积是精确的。\n\n模态系数为 $a_0 = \\frac{5}{3}$，$a_1 = 3$，$a_2 = -\\frac{2}{3}$ 和 $a_3=0$。接下来，我们计算总能量 $E_{\\mathrm{tot}}$ 和高阶能量 $E_{\\mathrm{hi}}$。\n$$E_{\\mathrm{tot}}=\\sum_{n=0}^{3} a_n^2 \\frac{2}{2n+1} = a_0^2(2) + a_1^2\\left(\\frac{2}{3}\\right) + a_2^2\\left(\\frac{2}{5}\\right) + a_3^2\\left(\\frac{2}{7}\\right)$$\n$$E_{\\mathrm{tot}} = \\left(\\frac{5}{3}\\right)^2(2) + (3)^2\\left(\\frac{2}{3}\\right) + \\left(-\\frac{2}{3}\\right)^2\\left(\\frac{2}{5}\\right) + (0)^2\\left(\\frac{2}{7}\\right)$$\n$$E_{\\mathrm{tot}} = \\frac{25}{9}(2) + 9\\left(\\frac{2}{3}\\right) + \\frac{4}{9}\\left(\\frac{2}{5}\\right) = \\frac{50}{9} + 6 + \\frac{8}{45}$$\n$$E_{\\mathrm{tot}} = \\frac{250}{45} + \\frac{270}{45} + \\frac{8}{45} = \\frac{528}{45} = \\frac{176}{15}$$\n\n$$E_{\\mathrm{hi}} = a_2^2 \\frac{2}{5} + a_3^2 \\frac{2}{7} = \\left(-\\frac{2}{3}\\right)^2\\left(\\frac{2}{5}\\right) + (0)^2\\left(\\frac{2}{7}\\right) = \\frac{4}{9}\\left(\\frac{2}{5}\\right) = \\frac{8}{45}$$\n\n自适应决策基于比率 $r = \\frac{E_{\\mathrm{hi}}}{E_{\\mathrm{tot}}}$：\n$$r = \\frac{8/45}{528/45} = \\frac{8}{45} \\cdot \\frac{45}{528} = \\frac{8}{528}$$\n由于 $528 = 8 \\times 66$，比率为：\n$$r = \\frac{1}{66}$$\n给定的阈值为 $\\tau=0.02 = \\frac{2}{100} = \\frac{1}{50}$。我们将 $r$ 与 $\\tau$ 进行比较：\n$$\\frac{1}{66}  \\frac{1}{50}$$\n因此，$r  \\tau$。自适应规则规定：“如果比率 $r=\\frac{E_{\\mathrm{hi}}}{E_{\\mathrm{tot}}}$ 严格小于阈值 $\\tau=0.02$，则将 $p$ 增加 $1$；否则将 $p$ 减少 $1$。”\n由于满足条件 $r  \\tau$，多项式阶数应增加 $1$。当前阶数为 $p=3$。\n因此，下一个多项式阶数为 $p_{\\mathrm{next}} = p+1 = 3+1=4$。", "answer": "$$\\boxed{4}$$", "id": "3389829"}]}