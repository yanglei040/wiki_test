## 引言
对飞行器周围的[湍流](@entry_id:151300)或交通网络中的拥堵进行[高保真度模拟](@entry_id:750285)，依赖于能够精确捕捉复杂物理现象的数值方法。[双曲守恒律](@entry_id:147752)是描述这类流动现象的数学模型，而[高阶数值方法](@entry_id:142601)，如间断Galerkin（DG）方法，因其高精度和对复杂几何的适应性而备受青睐。然而，一个核心挑战在于，当面对[非线性](@entry_id:637147)问题产生的激波等不连续性时，如何确保数值解的鲁棒性和物理真实性。仅仅保证能量稳定是不够的，这可能导致违反[热力学第二定律](@entry_id:142732)的非物理解。

本文旨在系统性地解决这一知识鸿沟，详细阐述一类先进的数值方法——基于[分部求和](@entry_id:185335)（SBP）算子的熵稳定DG方法。这种方法通过在离散层面严格模仿连续世界的熵分析，为[非线性](@entry_id:637147)[双曲守恒律](@entry_id:147752)的数值模拟提供了可证明的鲁棒性保证。

通过本文的学习，读者将踏上一条从理论到应用的完整路径。在 **“原理与机制”** 一章中，我们将深入探讨构建[熵稳定格式](@entry_id:749017)的基石，包括SBP算子、熵变量、[熵守恒通量](@entry_id:749013)，以及克服[混叠误差](@entry_id:637691)的关键技术。随后，在 **“应用与[交叉](@entry_id:147634)学科联系”** 一章中，我们将展示这些理论如何在实际问题中发挥作用，从处理复杂的边界条件和几何形状，到在交通工程等[交叉](@entry_id:147634)学科领域建立创新的分析模型。最后，通过 **“动手实践”** 部分，读者将有机会通过具体的计算和编程练习来巩固所学知识。

让我们首先进入第一章，揭示这些强大格式背后的核心原理与精妙机制。

## 原理与机制

本章旨在阐述构建熵稳定间断 Galerkin (DG) 方法的核心原理与关键机制。我们将从[离散微积分](@entry_id:265628)的基本工具——[分部求和](@entry_id:185335) (SBP) 算子——出发，进而探讨[双曲守恒律](@entry_id:147752)[数值稳定性](@entry_id:146550)的精细概念，即从[线性系统](@entry_id:147850)的能量稳定过渡到非线性系统的熵稳定。随后，我们将详细介绍[熵稳定格式](@entry_id:749017)的构造模块，包括熵变量、[熵守恒通量](@entry_id:749013)以及熵势。本章的重点在于阐明一个核心挑战——[混叠误差](@entry_id:637691)——以及如何通过分裂形式（或称通量差分形式）的体积项来克服这一挑战。最后，我们将展示如何引入[数值耗散](@entry_id:168584)来满足物理[熵不等式](@entry_id:184404)，从而组装成一个完整的、可证明其鲁棒性的高阶数值格式。

### [分部求和](@entry_id:185335) (SBP) 算子：离散的积分恒等式

许多[数值方法的稳定性](@entry_id:165924)分析都依赖于模仿连续微积分中的一个基本工具：分部积分 (IBP)。对于定义在区间 $[a,b]$ 上的两个[可微函数](@entry_id:144590) $u(x)$ 和 $v(x)$，[分部积分公式](@entry_id:145262)为：
$$
\int_{a}^{b} u(x) v'(x) dx = [u(x)v(x)]_{a}^{b} - \int_{a}^{b} u'(x) v(x) dx
$$
这个恒等式将一个导数的积分与另一个导数的积分以及边界项联系起来，是证明[能量守恒](@entry_id:140514)或耗散的关键。**[分部求和](@entry_id:185335) (Summation-By-Parts, SBP)** 性质是这一连续恒等式在离散网格点上的直接模拟。

一个离散的一阶微分算子若要具备 SBP 性质，它必须与一个离散的范数（或[内积](@entry_id:158127)）相结合，以一种精确的方式再现分部积分。在一个离散单元上，我们考虑一组节点 $\{x_i\}$ 上的函数值向量 $\boldsymbol{u}$。离散[内积](@entry_id:158127)由一个对称正定的**[质量矩阵](@entry_id:177093) (mass matrix)** $H$ 定义，通常由[求积权重](@entry_id:753910)构成，即 $(\boldsymbol{u}, \boldsymbol{v})_H = \boldsymbol{u}^T H \boldsymbol{v}$。设 $D$ 为一个逼近[一阶导数](@entry_id:749425)的**[微分矩阵](@entry_id:149870) (differentiation matrix)**。那么，$(H, D)$ 算子对如果满足以下条件，就被称为具有 SBP 性质：
$$
H D + D^T H = B
$$
其中 $B$ 是一个**边界矩阵 (boundary matrix)**，它只在对应于单元端点的条目上具有非零值。这个矩阵恒等式是离散的[分部积分公式](@entry_id:145262)。对于任意两个[节点向量](@entry_id:176218) $\boldsymbol{u}$ 和 $\boldsymbol{v}$，它等价于：
$$
\boldsymbol{v}^T H (D \boldsymbol{u}) + \boldsymbol{u}^T H (D \boldsymbol{v}) = \boldsymbol{v}^T B \boldsymbol{u}
$$
左侧两项分别代表了 $\int v (u') dx$ 和 $\int u (v') dx$ 的离散模拟，而右侧则精确地表示了边界项 $[uv]_a^b$。

一个特别重要且常用的 SBP 算子是在[勒让德-高斯-洛巴托](@entry_id:751235) ([Legendre-Gauss-Lobatto](@entry_id:751235), LGL) 节点上构建的谱配点算子 [@problem_id:3384650]。对于参考单元 $[-1,1]$ 上的 $p$ 次多项式空间，我们使用 $p+1$ 个 LGL 节点。此时，[质量矩阵](@entry_id:177093) $H$ 是一个对角矩阵，其对角元为 LGL [求积权重](@entry_id:753910) $\{w_i\}$。[微分矩阵](@entry_id:149870) $D$ 由[拉格朗日基](@entry_id:751105)函数的导数在节点处的值构成。由于 LGL 求积对于最高 $2p-1$ 次的多项式是精确的，我们可以证明，对于任意次数不高于 $p$ 的多项式 $u(r)$ 和 $v(r)$，离散[内积](@entry_id:158127)精确等于连续积分。通过这一性质，可以推导出 SBP 关系式，其中边界矩阵为 $B = \mathrm{diag}(-1, 0, \dots, 0, 1)$。这个结果揭示了 LGL 节点上的谱配点 DG 方法 (DGSEM) 与 SBP 格式之间的内在联系。一个强大的特性是，在从参考单元到物理单元 $[a,b]$ 的[仿射变换](@entry_id:144885)下，物理[边界算子](@entry_id:160216) $B_x$ 与参考[边界算子](@entry_id:160216) $B$ 相同，即 $B_x = B$ [@problem_id:3384650]。这确保了无论单元大小如何，SBP 性质都以一种统一的方式保持不变。

这些 SBP 算子的另一个关键特性是它们的高精度。对于次数最高为 $p$ 的多项式，基于 $p+1$ 个 LGL 节点的[微分矩阵](@entry_id:149870) $D$ 能够精确地计算其导数。这意味着，将算子 $D$ 应用于任何次数不高于 $p$ 的多项式（例如 $x^k, k \le p$）的节点值向量上，得到的[截断误差](@entry_id:140949)为零 [@problem_id:3384645]。这种“谱精度”是高阶方法吸[引力](@entry_id:175476)的核心所在。

### 从能量稳定到熵稳定

拥有了 SBP 这个强大的工具后，我们来探讨如何用它来为[双曲守恒律](@entry_id:147752) $u_t + f(u)_x = 0$ 构建稳定的数值格式。

对于一个线性的、对称[双曲系统](@entry_id:260647) $u_t + A u_x = 0$（其中 $A=A^T$），稳定性分析通常基于 $L^2$ **能量模**。连续的能量方法是通过方程左乘 $u^T$ 并在空间上积分，利用分部积分得到 $\frac{d}{dt} \int |u|^2 dx \le 0$（取决于边界条件）。一个 SBP 离散格式自然地模仿了这一过程。离散能量定义为 $\lVert \boldsymbol{u} \rVert_M^2 = \boldsymbol{u}^T M \boldsymbol{u}$。通过分析离散能量的时间导数，并利用 SBP 性质将体积项转化为边界/界面项，只要选择合适的数值通量（例如，基于 $A$ 的[特征值分解](@entry_id:272091)的迎风格式），就可以证明离散能量是不会增长的。这就是**能量稳定 (energy stability)** [@problem_id:3384660]。

然而，对于[非线性](@entry_id:637147)守恒律，如[可压缩欧拉方程](@entry_id:747588)或[伯格斯方程](@entry_id:177995)，情况要复杂得多。[非线性系统](@entry_id:168347)可以产生激波等不连续解，仅仅要求 $L^2$ 模不增是不够的，甚至可能允许非物理的、违反热力学第二定律的解（如膨胀激波）出现。因此，我们需要一个更强的[稳定性判据](@entry_id:755304)，即**熵稳定 (entropy stability)**。

[熵稳定性](@entry_id:749023)的概念源于物理上的[熵增原理](@entry_id:142282)。对于一个守恒律系统，如果存在一个凸函数 $U(u)$（称为**数学熵 (mathematical entropy)**）和一个与之配对的**熵通量 (entropy flux)** $F(u)$，使得光滑解满足[熵守恒](@entry_id:749018)律 $U(u)_t + F(u)_x = 0$，那么物理上相关的[弱解](@entry_id:161732)（包含激波的解）必须满足[熵不等式](@entry_id:184404) $U(u)_t + F(u)_x \le 0$。这个不等式保证了解的物理正确性。

一个[数值格式](@entry_id:752822)被称为熵稳定的，如果它能满足该[熵不等式](@entry_id:184404)的离散模拟。具体而言，我们希望总离散熵 $\mathcal{S} = \sum_k \boldsymbol{1}^T M_k U(\boldsymbol{u}_k)$（在所有单元 $k$ 上求和）的时间导数是非正的，即 $\frac{d\mathcal{S}}{dt} \le 0$。

重要的是要认识到，$L^2$ 能量稳定和熵稳定是两个不同的概念 [@problem_id:3384660]。前者控制的是解的二次范数，而后者控制的是一个通常非二次的凸泛函 $U(u)$。一个为线性化系统设计的 $L^2$ 稳定格式，当应用于完全的非线性系统时，不一定能保证熵稳定。一个典型的例子是，一个为[可压缩欧拉方程](@entry_id:747588)的 Roe 线性化[系统设计](@entry_id:755777)的、基于 Roe 通量的 DG-SBP 格式，虽然在其线性化意义上是 $L^2$ 稳定的，但若不经过特殊修正（即“[熵修正](@entry_id:749021)”），它可能会产生违反[熵条件](@entry_id:166346)的解 [@problem_id:3384660]。因此，为[非线性](@entry_id:637147)问题设计[数值格式](@entry_id:752822)时，我们的目标必须是更严格的[熵稳定性](@entry_id:749023)。

### [熵守恒](@entry_id:749018)机制的构造模块

为了构造一个满足[离散熵不等式](@entry_id:748505)的格式，我们需要引入几个关键的构造模块。这些模块的作用是在离散层面精确地复制连续熵分析中的[代数结构](@entry_id:137052)。

#### [熵变](@entry_id:138294)量与熵势

分析[熵不等式](@entry_id:184404)时，直接使用[守恒变量](@entry_id:747720) $u$ 并不方便。更自然的一组变量是**熵变量 (entropy variables)**，定义为熵函数 $U(u)$ 关于[守恒变量](@entry_id:747720) $u$ 的梯度：
$$
\boldsymbol{v}(u) = \nabla_u U(u)
$$
通过链式法则，我们有 $d U = \boldsymbol{v}^T d\boldsymbol{u}$。这意味着，在分析离散总熵 $\mathcal{S}$ 的时间导数时，我们应该将离散的控制方程残差与[熵变](@entry_id:138294)量向量 $\boldsymbol{v}$ 做[内积](@entry_id:158127)，而非与 $\boldsymbol{u}$ 做[内积](@entry_id:158127)。

另一个至关重要的量是**熵势 (entropy potential)** $\psi(u)$，它通过以下关系定义：
$$
\psi(u) = \boldsymbol{v}(u)^T \boldsymbol{f}(u) - F(u)
$$
其中 $F(u)$ 是与 $U(u)$ 配对的熵通量。熵势之所以重要，是因为它满足一个关键的恒等式：$\nabla_u \psi = (\nabla_u \boldsymbol{f})^T \boldsymbol{v}$ [@problem_id:3384655]。这个恒等式将物理通量 $\boldsymbol{f}$ 与[熵变](@entry_id:138294)量 $\boldsymbol{v}$ 和熵势 $\psi$ 联系起来，是推导[熵守恒通量](@entry_id:749013)的基础。

例如，对于标量问题 $f(u) = \frac{1}{3}u^3 - u$ 和二次熵 $U(u) = \frac{1}{2}u^2$，我们可以直接计算这些量。[熵变](@entry_id:138294)量为 $v(u) = U'(u) = u$。通量雅可比为 $f'(u) = u^2 - 1$。根据定义，熵势的导数为 $\psi'(u) = f'(u)v(u) = (u^2-1)u = u^3-u$。通[过积分](@entry_id:753033)并设定 $\psi(0)=0$，我们得到熵势为 $\psi(u) = \frac{1}{4}u^4 - \frac{1}{2}u^2$ [@problem_id:3384655]。

#### [熵守恒通量](@entry_id:749013)

有了熵变量和熵势，我们就可以定义熵[守恒[数值格](@entry_id:747712)式](@entry_id:752822)的核心部件：**[熵守恒](@entry_id:749018) (entropy conservative, EC) 通量**。这是一个在单元界面处使用的两点数值通量 $\boldsymbol{f}^{ec}(\boldsymbol{u}_L, \boldsymbol{u}_R)$，它被设计用来在离散界面上精确模拟连续熵分析中的一个关键步骤。

在连续情况下，我们有恒等式 $\partial_x \psi = (\partial_x \boldsymbol{v})^T \boldsymbol{f}$。一个两点[数值通量](@entry_id:752791) $\boldsymbol{f}^{ec}$ 如果满足这个恒等式的离散模拟，就被称为[熵守恒](@entry_id:749018)的。这个离散模拟被称为**塔德莫条件 (Tadmor's condition)** [@problem_id:3384651]：
$$
(\boldsymbol{v}_R - \boldsymbol{v}_L)^T \boldsymbol{f}^{ec}(\boldsymbol{u}_L, \boldsymbol{u}_R) = \psi_R - \psi_L
$$
其中 $\llbracket \cdot \rrbracket = (\cdot)_R - (\cdot)_L$ 表示界面左右两侧值的“跳跃”。这个条件是构造[熵守恒格式](@entry_id:749014)的基石。当一个数值格式在所有内部界面都使用满足此条件的通量时，熵在这些界面上的通量贡献会形成一个伸缩求和（telescoping sum），从而导致离散总熵的精确守恒（不考虑边界和耗散）。

对于给定的守恒律和熵对，通常可以推导出满足塔德莫条件的 EC 通量的显式表达式。例如，对于[伯格斯方程](@entry_id:177995) $u_t + \partial_x (\frac{u^2}{2}) = 0$，使用熵 $U(u) = \frac{u^2}{2}$，我们有 $v(u)=u$ 和 $\psi(u)=\frac{u^3}{6}$。代入塔德莫条件并求解 $\widehat{f}^{\mathrm{ec}}$，可以得到一个对称且自洽的 EC 通量 [@problem_id:3384665]：
$$
\widehat{f}^{\mathrm{ec}}(u_L, u_R) = \frac{u_L^2 + u_L u_R + u_R^2}{6}
$$
这个具体的例子清晰地展示了如何从抽象的定义得到一个可用的[数值通量](@entry_id:752791)。

### 克服[混叠误差](@entry_id:637691)：分裂形式体积项

即使我们有了[熵守恒](@entry_id:749018)的界面通量，挑战还未结束。在 DG 方法中，单元内部的体积积分项 $\int \phi_i \partial_x f(u_h) dx$ 也必须被小心处理。对于[非线性](@entry_id:637147)通量 $f(u)$，标准配点格式会引入一种称为**混叠 (aliasing)** 的误差，这会破坏熵的守恒性并导致不稳定。

[混叠误差](@entry_id:637691)的根源在于，当解 $u_h$ 是一个 $p$ 次多项式时，[非线性](@entry_id:637147)通量项 $f(u_h(x))$ 通常不再是多项式，或者其次数远高于 $p$ [@problem_id:3384654]。在配点法中，我们只能在有限的节点上计算 $f(u_h)$ 的值，然后用一个 $p$ 次多项式来插值这些值。这个过程会将 $f(u_h)$ 中无法被 $p$ 次多项式空间表示的高频成分“误认”为空间中的低频成分。这种高频到低频的能量泄露就是混叠。当使用不精确的求积规则（如 LGL 求积，其对两个 $p$ 次多项式乘积的积分是精确的，但对更复杂的函数则不是）计算体积项时，这种[混叠误差](@entry_id:637691)会产生虚假的熵源，从而破坏稳定性。

我们可以通过一个具体的例子来量化这个虚假的[熵产生](@entry_id:141771) [@problem_id:3384649]。对于[伯格斯方程](@entry_id:177995)，在 $p=3$ 的 LGL 节点上，如果我们考虑一个三次多项式解 $u(x)=x^3-x$，标准配点格式（即 $E_{\mathrm{col}} = \boldsymbol{u}^T M D \boldsymbol{f}$）计算出的体积[熵产生](@entry_id:141771)项并不为零，尽管其连续对应物在周期边界下为零。这个非零值 $\Delta E = \frac{16}{375}$ 直接源于 LGL 求积法则无法精确计算熵分析中出现的高次多项式被积函数，是[混叠误差](@entry_id:637691)的直接体现。

幸运的是，有一种优雅的方法可以消除体积项带来的虚假[熵产生](@entry_id:141771)。这种方法被称为**分裂形式 (split forms)** 或**通量差分 (flux differencing)** [@problem_id:3384667] [@problem_id:3384654]。其核心思想是将标准的体积项 $\boldsymbol{Q} \boldsymbol{f}(\boldsymbol{u})$ (其中 $\boldsymbol{Q} = M D$) 替换为一个代数上等价或近似的、具有更好稳定性属性的形式。一个特别有效的形式是利用 SBP 算子 $\boldsymbol{Q}$ 的斜对称部分 $\boldsymbol{S} = \frac{1}{2}(\boldsymbol{Q} - \boldsymbol{Q}^T)$ 和一个对称的两点通量 $F^{ec}$ 来构造体积项，例如：
$$
[\mathbf{Vol}]_i = \sum_{j=1}^{N+1} 2\,S_{ij}\,F^{ec}(\mathbf{u}_i, \mathbf{u}_j)
$$
由于 $S$ 的斜对称性和 $F^{ec}$ 的对称性，这个体积项的总和（在单元内部所有节点上求和）恒为零。这意味着它在代数上是守恒的。更重要的是，当 $F^{ec}$ 选择为前面定义的[熵守恒通量](@entry_id:749013)时，可以证明这个体积项对离散熵变化率的贡献恰好为零。它通过代数操作（利用 SBP 性质）将内部贡献转化为一个在单元边界上伸缩求和的项，从而在体积内部完美地守恒了熵。这种构造方式有效地“绕过”了混叠问题：无论标准求积会产生什么样的[混叠误差](@entry_id:637691)，分裂形式的[代数结构](@entry_id:137052)保证了这些误差不会投影到熵的增长模态上。这一优雅的解决方案是现代熵稳定 DG-SBP 方法的支柱。

值得注意的是，这种代数上的精确抵消依赖于[谱方法](@entry_id:141737)的基本性质，即求积法则与[多项式空间](@entry_id:144410)之间的精确关系。为了保证这些代数操作的有效性，要求所使用的求积法则至少对于次数为 $2p-1$ 的多项式是精确的 [@problem_id:3384646]。这恰好是 LGL 求积所满足的条件。

### 引入物理耗散：从守恒到稳定

到目前为止，我们已经构建了一个**[熵守恒](@entry_id:749018)**的格式：它有一个[熵守恒](@entry_id:749018)的体积项和一个在界面处使用 EC 通量的表面项。对于光滑解，这样的格式表现优异。但为了处理激波，我们必须满足熵**不等式**，即需要引入**熵耗散 (entropy dissipation)**。

这可以通过在界面通量中加入一个耗散项来实现。我们将[熵守恒通量](@entry_id:749013) $f^{ec}$ 升级为一个**熵稳定 (entropy stable, ES)** 通量 $f^{es}$：
$$
f^{es}(u_L, u_R) = f^{ec}(u_L, u_R) - \frac{1}{2} \alpha (v_R - v_L)
$$
这里的耗散项正比于[熵变](@entry_id:138294)量的跳跃 $\llbracket v \rrbracket = v_R - v_L$，系数 $\alpha$ 是一个耗散系数，通常选择为某种形式的局部最大[特征速度](@entry_id:165394)，例如在 Lax-Friedrichs 型通量中，$\alpha = \max(|f'(u_L)|, |f'(u_R)|)$。

这个耗散项对[熵变](@entry_id:138294)化率的贡献是多少？我们可以直接计算。由熵稳定分析可知，界面产生的熵为 $(v_R - v_L)^T [f^{es} - f^{ec}]$。物理耗散 $D$ 是其相反数。代入 $f^{es}$ 的定义，我们得到 [@problem_id:3384656]：
$$
D = -(v_R - v_L)^T \left[ -\frac{1}{2} \alpha (v_R - v_L) \right] = \frac{1}{2} \alpha (v_R - v_L)^T (v_R - v_L) = \frac{1}{2} \alpha \lVert v_R - v_L \rVert^2
$$
由于 $\alpha \ge 0$，这个耗散项 $D$ 保证是非负的。它只在界面两侧状态不同（即 $\llbracket v \rrbracket \neq 0$）时才起作用，并且其大小正比于状态差异的平方。对于[伯格斯方程](@entry_id:177995)的例子，耗散项为 $D = \frac{1}{2} \max(|u_L|, |u_R|) (u_L - u_R)^2$ [@problem_id:3384656]。这正是物理上在激波处产生熵所需要的机制。

### 综合：完整的熵稳定 DG-SBP 格式

综上所述，一个现代的、高阶的、可证明熵稳定的 DG-SBP 格式是通过以下组件精心构建而成的：

1.  **单元离散化**：在每个单元上，使用与对角范数[质量矩阵](@entry_id:177093) $M$ 配对的 SBP [微分算子](@entry_id:140145) $D$，例如基于 LGL 节点的谱配点算子。

2.  **体积项**：采用分裂形式（通量差分）来计算[非线性](@entry_id:637147)体积项。这利用了算子的 SBP 性质和一个两点[熵守恒通量](@entry_id:749013)，以确保体积项本身是[熵守恒](@entry_id:749018)的，从而消除了[混叠误差](@entry_id:637691)的影响。

3.  **界面通量**：在单元界面处，使用一个熵稳定 (ES) 数值通量。该通量由两部分组成：一个满足塔德莫条件的[熵守恒](@entry_id:749018) (EC) 基通量，以及一个与[熵变](@entry_id:138294)量跳跃成比例的、保证产生正确符号熵耗散的[数值黏性](@entry_id:141318)项。

通过这种方式，整个[半离散格式](@entry_id:165671)的离散总熵的时间导数可以被证明为非正，即 $\frac{d\mathcal{S}}{dt} \le 0$（在适当的边界条件下）。这不仅为[非线性](@entry_id:637147)[双曲守恒律](@entry_id:147752)的模拟提供了坚实的理论保证和鲁棒性，而且通过模仿连续世界的物理原理，实现了代数与分析的深刻统一。