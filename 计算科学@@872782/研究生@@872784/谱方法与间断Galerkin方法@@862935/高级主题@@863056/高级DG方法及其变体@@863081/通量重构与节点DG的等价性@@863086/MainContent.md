## 引言
在[高阶数值方法](@entry_id:142601)领域，[通量重构](@entry_id:147076)（Flux Reconstruction, FR）方法和间断伽辽金（Discontinuous Galerkin, DG）方法是求解偏微分方程的两种强大工具，尤其在计算流体力学等领域备受青睐。尽管它们源于不同的思想——FR通过修正通量多项式，而DG通过弱形式和[数值通量](@entry_id:752791)——但它们在实践中却表现出惊人的相似性。然而，这两种方法常被视为独立的框架，它们之间深刻的内在联系往往被忽视，这构成了一个理解上的空白。本文旨在填补这一空白，严格证明在特定且常见的离散化选择下，FR方法的一个特定族与节点[DG方法](@entry_id:748369)在代数上是完全等价的。

为了系统地揭示这一等价性，本文将分为三个核心章节。首先，在**“原理与机制”**一章中，我们将从一维[标量守恒律](@entry_id:754532)出发，构建两种方法所需的离散算子，推导其[半离散格式](@entry_id:165671)，并最终证明等价性的核心条件。接着，在**“应用与跨学科联系”**一章中，我们将探讨这一理论结果的广泛影响，说明它如何统一[稳定性分析](@entry_id:144077)、[算法设计](@entry_id:634229)，并扩展到多维、黏性问题等更复杂的物理场景。最后，**“动手实践”**部分将通过具体的计算练习，让读者亲手验证和体验这种等价性及其在特定情况下的微妙之处，从而将理论知识转化为实践能力。

## 原理与机制

本章旨在阐述两种先进的[高阶数值方法](@entry_id:142601)——[通量重构](@entry_id:147076)（Flux Reconstruction, FR）方法和节点间断伽辽金（nodal Discontinuous Galerkin, DG）方法——之间的深刻代数等价性。我们将从一维[标量守恒律](@entry_id:754532)出发，系统地构建两种方法所需的离散算子，推导各自的[半离散格式](@entry_id:165671)，并最终证明在特定条件下它们是完全相同的。这一等价性不仅统一了看似不同的数值方法，还为设计稳定、精确的计算方案提供了坚实的理论基础。

### 节点离散化的基本要素

为了构建[数值格式](@entry_id:752822)，我们首先在标准参考单元 $\xi \in [-1, 1]$ 上定义我们的离散化框架。这个框架是节点 DG 和 FR 方法的共同基础。

一个次数最高为 $p$ 的实系数[多项式空间](@entry_id:144410)，记为 $\mathbb{P}_p$。我们在此空间中寻找近似解。为了唯一地表示一个多项式，我们在参考单元上选取 $p+1$ 个不同的插值节点 $\{\xi_i\}_{i=0}^p$。一个特别重要且常用的选择是 **[勒让德-高斯-洛巴托](@entry_id:751235)（[Legendre-Gauss-Lobatto](@entry_id:751235), LGL）** 节点集，因为它包含了单元的两个端点 $\xi_0 = -1$ 和 $\xi_p = 1$，这在处理边界通量时极为方便。

给定这些节点，我们可以构建一个唯一的 **拉格朗日[节点基](@entry_id:752522)** $\{\ell_j(\xi)\}_{j=0}^p$。每个[基函数](@entry_id:170178) $\ell_j(\xi)$ 都是 $\mathbb{P}_p$ 中的一个多项式，并满足插值属性 $\ell_j(\xi_i) = \delta_{ij}$，其中 $\delta_{ij}$ 是克罗内克符号。这意味着，任何次数不超过 $p$ 的多项式 $u_h(\xi)$ 都可以通过其在节点上的值 $u_j = u_h(\xi_j)$ 进行精确表示：$u_h(\xi) = \sum_{j=0}^p u_j \ell_j(\xi)$。

基于此节点表示，我们可以定义几个核心的离散算子：

- **配置[微分矩阵](@entry_id:149870) (Collocation Differentiation Matrix)** $D$：该矩阵将多项式在节点上的值向量 $\mathbf{u} = [u_0, \dots, u_p]^T$ 映射到其导数在节点上的值向量 $\mathbf{u}' = [u_h'(\xi_0), \dots, u_h'(\xi_p)]^T$。通过对[拉格朗日插值](@entry_id:167052)公式求导并在节点 $\xi_i$ 上取值，我们得到 $u_h'(\xi_i) = \sum_{j=0}^p u_j \ell_j'(\xi_i)$。由此可见，[微分矩阵](@entry_id:149870)的元素由[拉格朗日基](@entry_id:751105)函数的导数在节点上的值给定，即 $D_{ij} = \ell_j'(\xi_i)$ [@problem_id:3385005]。

- **[质量矩阵](@entry_id:177093) (Mass Matrix)** $M$：在伽辽金方法中，我们需要计算形如 $\int_{-1}^1 \phi u \, d\xi$ 的[内积](@entry_id:158127)。如果使用[拉格朗日基](@entry_id:751105)，这将产生 **精确质量矩阵** $M_{ij}^{\text{exact}} = \int_{-1}^1 \ell_i(\xi) \ell_j(\xi) \, d\xi$。这个矩阵通常是稠密的，计算成本较高。然而，在节点方法中，一个关键的简化来自于采用与插值节点相匹配的 **[数值积分](@entry_id:136578)（quadrature）** 来近似该积分。对于 LGL 节点，相应的 LGL 积分法则使用权重 $\{w_i\}_{i=0}^p$，其积分近似为 $\int_{-1}^1 g(\xi) d\xi \approx \sum_{k=0}^p w_k g(\xi_k)$。当我们将此规则应用于质量矩阵的计算时，由于[拉格朗日基](@entry_id:751105)的插值特性 $\ell_i(\xi_k) \ell_j(\xi_k) = \delta_{ik} \ell_j(\xi_k)$，我们得到一个[对角矩阵](@entry_id:637782) $M_{ij}^{\text{quad}} = \sum_{k=0}^p w_k \ell_i(\xi_k) \ell_j(\xi_k) = \sum_{k=0}^p w_k \delta_{ik} \delta_{jk} = w_i \delta_{ij}$。这个[对角矩阵](@entry_id:637782) $M = \mathrm{diag}(w_0, \dots, w_p)$ 被称为 **配置[质量矩阵](@entry_id:177093)** 或 **[对角质量矩阵](@entry_id:173002)**，它的可逆性使得计算变得极为高效。值得注意的是，$p+1$ 个节点的 LGL 积分对于次数不超过 $2p-1$ 的多项式是精确的。由于 $\ell_i \ell_j$ 的乘积是一个次数为 $2p$ 的多项式，LGL 积分会引入一个微小的 **混淆误差（aliasing error）**。[精确质量](@entry_id:746222)矩阵与[对角质量矩阵](@entry_id:173002)之间的差异可以通过勒让德多项式展开来量化，其差值为一个秩-1 修正项 [@problem_id:3384950]。尽管存在差异，但采用[对角质量矩阵](@entry_id:173002)是现代节点 DG 和 FR 方法的标志性特征。

- **[边界算子](@entry_id:160216) (Boundary Operators)**：为了处理单元边界上的通量，我们需要从节点值向量中提取出端点值。这通过 **[限制算子](@entry_id:754316) (restriction operator)** $R \in \mathbb{R}^{2 \times (p+1)}$ 实现，对于 LGL 节点，它可以简单地从向量中选取第一个和最后一个元素，即 $(R\mathbf{u}) = [u(-1), u(1)]^T = [u_0, u_p]^T$。我们还定义一个 **边界定向矩阵 (boundary orientation matrix)** $B = \mathrm{diag}(-1, 1)$，它用于处理边界法向量的朝向 [@problem_id:3385005]。

### 节点间断伽辽金 (DG) 方法

现在我们考虑一维[标量守恒律](@entry_id:754532) $u_t + \partial_x f(u) = 0$。通过[仿射映射](@entry_id:746332) $x(\xi)$，我们可以将其转换到[参考单元](@entry_id:168425)上，形式为 $J u_t + \partial_\xi f(u) = 0$，其中 $J$ 是常数[雅可比行列式](@entry_id:137120)。

节点 DG 方法的[半离散格式](@entry_id:165671)源于[加权余量法](@entry_id:165159)。其 **强形式** 的推导尤为重要，因为它直接揭示了与 FR 的联系。我们从弱形式出发，将方程乘以一个测试函数 $\phi \in \mathbb{P}_p$，并在单元上积分：
$$
J \int_{-1}^1 \phi u_t \, d\xi + \int_{-1}^1 \phi \, \partial_\xi f(u_h) \, d\xi = 0
$$
对第二项进行两次分部积分（或者说，一次[分部积分](@entry_id:136350)后再积回来），并将边界上的物理通量 $f(u_h)$ 替换为考虑了邻近单元信息的 **数值通量** $\hat{f}$，我们得到如下的强形式[积分方程](@entry_id:138643) [@problem_id:3384984]：
$$
J \int_{-1}^1 \phi u_t \, d\xi + \int_{-1}^1 \phi \, \partial_\xi f(u_h) \, d\xi + \phi(1)(\hat{f}_R - f_R) - \phi(-1)(\hat{f}_L - f_L) = 0
$$
其中 $f_L = f(u_h(-1))$ 和 $f_R = f(u_h(1))$ 是单元内部解在边界上的迹。

现在，我们采用伽辽金方法，令测试函数 $\phi$ 为[拉格朗日基](@entry_id:751105)函数 $\ell_i(\xi)$，并在节点上进行配置（即使用 LGL 积分）。这导致了如下的[半离散系统](@entry_id:754680) [@problem_id:3384984]：
$$
J w_i \frac{du_i}{dt} + w_i (\partial_\xi f_h)|_{\xi_i} + \delta_{ip}(\hat{f}_R - f_R) - \delta_{i0}(\hat{f}_L - f_L) = 0
$$
写成矩阵形式，并整理后得到节点解向量 $\mathbf{u}$ 的[常微分方程组](@entry_id:266774)：
$$
\frac{d\mathbf{u}}{dt} = -\frac{1}{J} \left( D \mathbf{f} + M^{-1} R^T B (\hat{\mathbf{f}} - R\mathbf{f}) \right)
$$
其中 $\mathbf{f}$ 是通量 $f(u_h)$ 的节点值向量，$\hat{\mathbf{f}} = [\hat{f}_L, \hat{f}_R]^T$ 是[数值通量](@entry_id:752791)向量。这个方程清晰地展示了 DG 格式的结构：一个由[微分矩阵](@entry_id:149870) $D$ 产生的 **[体积分](@entry_id:171119)项**，和一个将边界通量[不连续性](@entry_id:144108)“提升”到整个单元内部的 **面积分修正项** (也称为[提升算子](@entry_id:751273))。数值通量 $\hat{f}(u^-, u^+)$ 的选择至关重要，它必须是 **相容的**（即 $\hat{f}(u,u) = f(u)$）和 **保守的**，以保证方法的正确性和物理守恒性。对于双曲问题，通常需要使用 **单调** 或 **迎风** 格式的数值通量来引入必要的数值耗散，从而确保稳定性 [@problem_id:3384959]。

### [通量重构](@entry_id:147076) (FR) 方法

与 DG 方法通过修正项来处理边界不同，FR 方法的核心思想是先在单元内部构造一个连续的、更高阶的 **重构通量多项式** $q(\xi)$，然后对其求导。这个重构通量 $q(\xi)$ 被设计为在单元边界上精确匹配[数值通量](@entry_id:752791) $\hat{f}_L$ 和 $\hat{f}_R$。

FR 的构造基于以下 **拟设 (ansatz)** [@problem_id:3385009]：
$$
q(\xi) = f(u_h(\xi)) + (\hat{f}_L - f_L) g_L(\xi) + (\hat{f}_R - f_R) g_R(\xi)
$$
这里，$f(u_h(\xi))$ 是解的多项式 $u_h$ 对应的通量多项式（在节点上插值得到）。项 $(\hat{f}_{L/R} - f_{L/R})$ 是左右边界上的 **通量不连续量**。$g_L(\xi)$ 和 $g_R(\xi)$ 是 **修正函数**，它们是预先定义的多项式，用于将边界上的通量修正平滑地[分布](@entry_id:182848)到单元内部。

为了使重构通量 $q(\xi)$ 在边界上等于数值通量，即 $q(-1)=\hat{f}_L$ 和 $q(1)=\hat{f}_R$，修正函数必须满足如下的边界条件 [@problem_id:3385009] [@problem_id:3384960]：
$$
g_L(-1)=1, \quad g_L(1)=0 \quad \text{以及} \quad g_R(-1)=0, \quad g_R(1)=1
$$
此外，为了保证最终的[半离散格式](@entry_id:165671)保持在[多项式空间](@entry_id:144410) $\mathbb{P}_p$ 内，我们需要 $\partial_\xi q(\xi)$ 是一个次数不超过 $p$ 的多项式。由于 $f(u_h(\xi))$ 的导数 $\partial_\xi f(u_h)$ 的次数为 $p-1$（假设 $f$ 是线性的），这就要求修正函数 $g_L$ 和 $g_R$ 的导数 $g_L'$ 和 $g_R'$ 的次数最高为 $p$。因此，修正函数本身必须是次数不超过 $p+1$ 的多项式，即 $g_L, g_R \in \mathbb{P}_{p+1}$ [@problem_id:3384960]。

FR 方法的[半离散格式](@entry_id:165671)通过对重构通量求导得到：$\frac{du_i}{dt} = -\frac{1}{J} q'(\xi_i)$。其矩阵形式为 [@problem_id:3384989]：
$$
\frac{d\mathbf{u}}{dt} = -\frac{1}{J} \left( D\mathbf{f} + \mathbf{g}'_L \delta_L + \mathbf{g}'_R \delta_R \right)
$$
其中 $\mathbf{g}'_{L/R}$ 是修正函数导数在节点上的值向量，$\delta_{L/R}$ 是左右边界的通量不连续量。这可以写得更紧凑：
$$
\frac{d\mathbf{u}}{dt} = -\frac{1}{J} \left( D\mathbf{f} + C(\hat{\mathbf{f}} - R\mathbf{f}) \right)
$$
其中 $C$ 是一个 $(p+1) \times 2$ 的矩阵，其列向量是 $\mathbf{g}'_L$ 和 $\mathbf{g}'_R$。

### 代数等价性的证明

通过比较节点 DG 和 FR 的[半离散格式](@entry_id:165671)，我们可以发现它们的结构惊人地相似。两者都有一个相同的[体积分](@entry_id:171119)项 $D\mathbf{f}$，不同之处在于处理边界通量的修正项。

- DG 修正项: $M^{-1}R^T B (\hat{\mathbf{f}} - R\mathbf{f})$
- FR 修正项: $C(\hat{\mathbf{f}} - R\mathbf{f})$

为了使这两种方法对于任意解（即任意的通量不连续量 $\hat{\mathbf{f}} - R\mathbf{f}$）都完[全等](@entry_id:273198)价，它们的修正项必须完全相同 [@problem_id:3385003] [@problem_id:3385005]。这就给出了 FR 和 DG 等价的核心条件：
$$
C = M^{-1} R^T B
$$
这个简洁的公式构成了两种方法之间的桥梁。它表明，只要我们选择的 FR 修正函数，其导数在节点上构成的矩阵 $C$ 满足这个条件，那么得到的 FR 格式就与基于 LGL 节点的强形式 DG 格式完全相同。

我们可以进一步揭示这些“DG-恢复”修正函数 $g_L$ 和 $g_R$ 的具体形式。对于 LGL 节点，我们有 $M = \mathrm{diag}(w_i)$，$R$ 是一个简单的选取算子，$B=\mathrm{diag}(-1,1)$。因此，对修正函数导数的节点值要求变为 [@problem_id:3384989]：
- $g_L'(\xi_i)$ 的向量是 $M^{-1}R^T B$ 的第一列，即 $M^{-1} [1, 0, \dots, 0]^T \cdot (-1) = [-1/w_0, 0, \dots, 0]^T$。
- $g_R'(\xi_i)$ 的向量是 $M^{-1}R^T B$ 的第二列，即 $M^{-1} [0, \dots, 0, 1]^T \cdot (1) = [0, \dots, 0, 1/w_p]^T$。

这意味着 $g_L'(\xi)$ 是一个在 $\xi_0=-1$ 处取值为 $-1/w_0$ 并在所有其他节点上为零的多项式，而 $g_R'(\xi)$ 是一个在 $\xi_p=1$ 处取值为 $1/w_p$ 并在所有其他节点上为零的多项式。利用[拉格朗日插值](@entry_id:167052)，我们可以写出 $g_L'(\xi) = -\frac{1}{w_0}\ell_0(\xi)$ 和 $g_R'(\xi) = \frac{1}{w_p}\ell_p(\xi)$。通过对这些表达式进行积分并利用边界条件，可以得到 $g_L(\xi)$ 和 $g_R(\xi)$ 的显式表达式，它们通常用[勒让德多项式](@entry_id:141510)来表示 [@problem_id:3384989]。例如，对于次数为 $p$ 的多项式，这两个修正函数可以表示为：
$$
g_L(\xi) = \frac{(-1)^p}{2} \left( (1-\xi)P_p(\xi) + \frac{P_{p+1}(\xi)-P_{p-1}(\xi)}{2p+1} \right)
$$
$$
g_R(\xi) = \frac{1}{2} \left( (1+\xi)P_p(\xi) - \frac{P_{p+1}(\xi)-P_{p-1}(\xi)}{2p+1} \right)
$$
这具体地证明了存在一个特定的 FR 格式，它与节点 DG 格式是代数等价的。

### [分部求和](@entry_id:185335) (SBP) 属性：一个统一的视角

这种等价性的背后是一个更深层次的数学结构，即 **[分部求和](@entry_id:185335)（Summation-by-Parts, SBP）** 属性。一个离散[微分算子](@entry_id:140145) $D$ 和一个[对称正定](@entry_id:145886)的范数矩阵 $H$ 若满足 $HD + D^T H = E$，其中 $E$ 是一个仅在边界上非零的算子，则称它们构成一个 SBP 算子对。这可以看作是[分部积分法](@entry_id:136350)则 $\int u'v \,d\xi = [uv] - \int uv' \,d\xi$ 的离散模拟。

对于在 LGL 节点上的配置方法，可以证明，以[对角质量矩阵](@entry_id:173002) $M$作为范数矩阵（$H=M$），其与[微分矩阵](@entry_id:149870) $D$ 恰好满足 SBP 属性 [@problem_id:3385008]：
$$
MD + D^T M = R^T B R
$$
这个属性是证明[数值格式稳定性](@entry_id:752825)的关键。它确保了[体积分](@entry_id:171119)项在离散能量范数下是反对称的（即不产生或消耗能量），因此格式的稳定性完全取决于边界项，也就是[数值通量](@entry_id:752791)的选择。例如，使用[迎风格式](@entry_id:756374)的[数值通量](@entry_id:752791)可以保证能量是耗散的（非增的），从而得到一个 $L^2$ 稳定的格式 [@problem_id:3384959] [@problem_id:3385008]。

由于节点 DG 方法（在 LGL 节点上）天然地具有 SBP 结构，而 FR 方法又可以与之代数等价，这意味着通过选择合适的修正函数，FR 方法也继承了 SBP 属性和与之相关的稳定性保证 [@problem_id:3385008]。这为 FR 方法提供了一个坚实的理论基础，并将其置于更广泛的 SBP 稳定格式框架之中。

### 等价性的扩展与局限

尽管 FR 和 DG 之间的等价性非常强大，但它依赖于某些假设。当这些假设不成立时，等价性可能会被打破。

#### [非线性](@entry_id:637147)通量与混淆误差

我们的推导很大程度上依赖于精确的多项式运算。对于线性守恒律 $u_t + au_x=0$，通量 $f(u_h)=au_h$ 仍然是一个次数为 $p$ 的多项式，所有积分都可以被 LGL 积分精确计算。然而，对于[非线性](@entry_id:637147)通量，例如 $f(u)=u^m$ ($m \ge 2$)，情况就变得复杂了。此时，$f(u_h)=(u_h)^m$ 是一个次数高达 $mp$ 的多项式。

在 DG 的弱形式或强形式中，我们需要计算形如 $\int \phi \, \partial_\xi f(u_h) d\xi$ 的积分，其被积函数次数最高可达 $(m+1)p-1$。标准的 LGL 积分（$p+1$ 个点）的精度只有 $2p-1$，当 $(m+1)p-1 > 2p-1$（即对于任何 $m \ge 2$ 和 $p \ge 1$）时，积分是不精确的，会产生 **混淆误差 (aliasing error)**。这种误差破坏了离散的[分部积分法](@entry_id:136350)则，导致 DG 的强形式和[弱形式](@entry_id:142897)不再等价。由于 FR-DG 的等价性是建立在强弱形式等价的基础上的，混淆误差也因此打破了 FR 和 DG 之间的等价性。为了恢复这种等价性，必须采用 **[过积分](@entry_id:753033) (over-integration)**，即使用足够多的积分点以精确计算所有高阶多项式积分，这要求积分的[精确度](@entry_id:143382)至少达到 $Q \ge (m+1)p-1$ [@problem_id:3384999]。

#### 曲线单元与[几何守恒律 (GCL)](@entry_id:749845)

当从[参考单元](@entry_id:168425)到物理单元的映射是非仿射的（即曲线单元）时，变换后的守恒律中会出现与坐标变换相关的 **度量项 (metric terms)**，如[雅可比行列式](@entry_id:137120) $J$ 和[逆变基](@entry_id:197906)向量 $\boldsymbol{a}^i$。方程的形式变为 $\partial_t(J u) + \sum_i \partial_{\xi_i}(J \boldsymbol{a}^i \cdot \boldsymbol{f}) = 0$。

在连续层面，这些度量项满足一个重要的恒等式，称为 **[几何守恒律](@entry_id:170384)（Geometric Conservation Law, GCL）**：$\sum_i \partial_{\xi_i}(J \boldsymbol{a}^i) = \boldsymbol{0}$。这个定律保证了即使在弯曲的[坐标系](@entry_id:156346)中，一个均匀流场（例如 $u$=常数）的散度仍然为零。然而，如果对度量项进行简单的离散化（例如在节点上插值），离散的 GCL $\sum_i D_i(J \boldsymbol{a}^i) = \boldsymbol{0}$ 通常不成立。这种离散几何误差会破坏格式的自由流保持特性，并打破 FR 和 DG 之间的等价性。

为了在曲线单元上维持 FR-DG 的等价性，必须采用特殊的[离散化方法](@entry_id:272547)来计算度量项，以确保离散 GCL 在节点上精确成立。同时，单元面上的度量项也必须与体内的度量项协调一致。只有满足了这些严格的离散几何条件，代数等价性才能从仿射单元推广到曲线单元 [@problem_id:3384951]。