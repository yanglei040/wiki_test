{"hands_on_practices": [{"introduction": "本练习将引导您通过一步步的计算，直接验证节点间断伽辽金（DG）方法和一种特定通量重构（FR）方法的半离散算子在代数上是等价的。通过研究最简单的非平凡情况——在单个单元上使用 $N=1$ 次多项式的线性平流问题——我们可以精确地看到 DG 方法的提升算子（lifting operator）如何与 FR 方法的修正项相对应，从而为理解这两种方法之间的深层联系打下坚实基础。[@problem_id:3384954]", "problem": "考虑一维线性平流方程 $u_{t} + a\\,u_{x} = 0$，其中平流速度 $a \\neq 0$ 为常数，定义在一个由单个谱元表示的周期性区域上。通过 $x = x_{c} + J\\,\\xi$ 将物理单元映射到参考区间 $\\xi \\in [-1,1]$，其中雅可比 $J = h/2$，$h$ 为物理单元的长度。使用多项式阶数 $N=1$，配置点为勒让德-高斯-洛巴托 (LGL) 点 $\\xi_{1} = -1$ 和 $\\xi_{2} = 1$，以及相应的拉格朗日基多项式 $\\{\\ell_{1}(\\xi), \\ell_{2}(\\xi)\\}$。设对角质量矩阵为 $M = J\\,\\mathrm{diag}(w_{1},w_{2})$，其中 LGL 权重为 $w_{1} = w_{2} = 1$，参考单元上的节点微分矩阵为\n$$\nD \\;=\\; \\begin{pmatrix}\n-\\tfrac{1}{2}  & \\tfrac{1}{2} \\\\\n-\\tfrac{1}{2}  & \\tfrac{1}{2}\n\\end{pmatrix},\n$$\n因此对于任意节点向量 $U = \\begin{pmatrix}u_{1} \\\\ u_{2}\\end{pmatrix}$，参考导数的近似为 $U_{\\xi} \\approx D\\,U$。\n\n在两个面上均采用中心数值通量：对于任意界面，其内部状态为 $u^{-}$，外部状态为 $u^{+}$，则通量为 $\\widehat{f} = a\\,\\tfrac{1}{2}(u^{-} + u^{+})$。由于区域是周期性的且由单个单元表示，两个面上的状态对均为 $(u^{-},u^{+}) = (u_{2},u_{1})$，因此面通量满足 $\\widehat{f}_{L} = \\widehat{f}_{R} = a\\,\\tfrac{u_{1} + u_{2}}{2}$。定义面残差\n$$\nr_{L} \\;=\\; \\widehat{f}_{L} - a\\,u_{1} \\;=\\; \\tfrac{a}{2}\\,(u_{2} - u_{1}), \n\\qquad\nr_{R} \\;=\\; \\widehat{f}_{R} - a\\,u_{2} \\;=\\; \\tfrac{a}{2}\\,(u_{1} - u_{2}) \\;=\\; -\\,r_{L}.\n$$\n\n定义如下两个用于推进节点状态 $U(t)$ 的半离散算子。\n\n1) 强形式的节点间断伽辽金 (DG) 方法，采用 LGL 配置（有时称为间断伽辽金谱元法）：通过 $M^{-1}R^{T}B$ 进行提升，其中 $R \\in \\mathbb{R}^{2 \\times 2}$ 是到面上的限制算子（在此单单元设置中 $R = I_{2}$），$B = \\mathrm{diag}(-1,1)$ 编码了面的方向。半离散算子 $L^{\\mathrm{DG}}(U)$ 为\n$$\n\\frac{dU}{dt} \\;=\\; L^{\\mathrm{DG}}(U) \\;:=\\; -\\,\\frac{a}{J}\\,D\\,U \\;-\\; M^{-1} R^{T} B \\begin{pmatrix} r_{L} \\\\ r_{R} \\end{pmatrix}.\n$$\n\n2) 强形式的通量重构 (FR) 方法，采用 $N=1$ 阶的 Huynh 型线性修正函数，\n$$\nh_{L}(\\xi) \\;=\\; \\frac{1 - \\xi}{2}, \n\\qquad\nh_{R}(\\xi) \\;=\\; \\frac{1 + \\xi}{2},\n$$\n使得 $h_{L}(-1)=1$，$h_{L}(1)=0$，$h_{R}(-1)=0$，$h_{R}(1)=1$，且\n$$\nh_{L}'(\\xi) \\;=\\; -\\frac{1}{2}, \n\\qquad\nh_{R}'(\\xi) \\;=\\; \\frac{1}{2}.\n$$\n定义重构通量 $q(\\xi) = a\\,u_{h}(\\xi) + r_{L}\\,h_{L}(\\xi) + r_{R}\\,h_{R}(\\xi)$，其中 $u_{h}(\\xi) = u_{1}\\,\\ell_{1}(\\xi) + u_{2}\\,\\ell_{2}(\\xi)$，并将半离散 FR 算子取为强形式在节点上的值，\n$$\n\\frac{dU}{dt} \\;=\\; L^{\\mathrm{FR}}(U) \\;:=\\; -\\,\\frac{1}{J}\\,\\left(\\frac{dq}{d\\xi}\\right)\\Big|_{\\{\\xi_{1},\\xi_{2}\\}}\n\\;=\\; -\\,\\frac{a}{J}\\,D\\,U \\;-\\; \\frac{1}{J}\\,\\begin{pmatrix} h_{L}'(\\xi_{1})  & h_{R}'(\\xi_{1}) \\\\ h_{L}'(\\xi_{2})  & h_{R}'(\\xi_{2}) \\end{pmatrix} \\begin{pmatrix} r_{L} \\\\ r_{R} \\end{pmatrix}.\n$$\n\n设 $U^{n}$ 表示在时间 $t^{n}$ 的状态，并使用 Shu 和 Osher 的三阶强稳定保持龙格-库塔 (SSP-RK3) 格式对两个半离散系统进行时间推进，时间步长为 $\\Delta t$：\n- 阶段 1： $U^{(1)} = U^{n} + \\Delta t\\,L(U^{n})$。\n- 阶段 2： $U^{(2)} = \\tfrac{3}{4}\\,U^{n} + \\tfrac{1}{4}\\,\\big(U^{(1)} + \\Delta t\\,L(U^{(1)})\\big)$。\n- 阶段 3： $U^{n+1} = \\tfrac{1}{3}\\,U^{n} + \\tfrac{2}{3}\\,\\big(U^{(2)} + \\Delta t\\,L(U^{(2)})\\big)$。\n\n此处，$L$ 对于节点间断伽辽金方法实例化为 $L^{\\mathrm{DG}}$，对于通量重构方法实例化为 $L^{\\mathrm{FR}}$。假设两种方法均使用上述定义的相同中心数值通量，并取任意初始节点状态 $U^{n} = \\begin{pmatrix} u_{1}^{n} \\\\ u_{2}^{n} \\end{pmatrix} \\in \\mathbb{R}^{2}$。\n\n计算经过一个完整的 SSP-RK3 时间步后，更新后状态之间差异的欧几里得范数，\n$$\n\\left\\| U^{n+1}_{\\mathrm{FR}} - U^{n+1}_{\\mathrm{DG}} \\right\\|_{2},\n$$\n并将您的答案以一个精确的实数形式给出。无需四舍五入，也无需物理单位。", "solution": "用户想要找到经过一个完整的 SSP-RK3 时间步后，由节点间断伽辽金 (DG) 方法和通量重构 (FR) 方法更新的状态向量之间差异的欧几里得范数。两种方法都从相同的初始状态 $U^{n}$ 开始，应用于相同的半离散问题，并使用相同的时间积分格式。\n\nSSP-RK3 格式是一个确定性过程。如果对于任何状态向量 $U$，半离散算子 $L^{\\mathrm{DG}}(U)$ 和 $L^{\\mathrm{FR}}(U)$ 都是相同的，那么将相同的时间步进格式应用于相同的初始数据 $U^n$ 将在所有阶段产生相同的结果。也就是说，如果 $L^{\\mathrm{DG}}(U) = L^{\\mathrm{FR}}(U)$，则 $U^{n+1}_{\\mathrm{DG}} = U^{n+1}_{\\mathrm{FR}}$，差向量 $U^{n+1}_{\\mathrm{FR}} - U^{n+1}_{\\mathrm{DG}}$ 将是零向量，其范数为 $0$。\n\n因此，我们的首要任务是确定这两个算子是否等价。让我们使用给定的定义来分析每个算子。\n\n节点状态向量为 $U = \\begin{pmatrix} u_1 \\\\ u_2 \\end{pmatrix}$。面残差由 $r_L = \\frac{a}{2}(u_2 - u_1)$ 和 $r_R = -r_L$ 给出。这可以写成向量形式 $\\begin{pmatrix} r_L \\\\ r_R \\end{pmatrix} = \\frac{a}{2}(u_2-u_1)\\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$。\n\n首先，我们分析节点 DG 算子 $L^{\\mathrm{DG}}(U)$。\n该算子定义为：\n$$\nL^{\\mathrm{DG}}(U) = -\\frac{a}{J}\\,D\\,U - M^{-1} R^{T} B \\begin{pmatrix} r_{L} \\\\ r_{R} \\end{pmatrix}\n$$\n第一项是体贡献项。第二项是面/通量贡献项，通常称为提升项。让我们使用提供的矩阵来计算提升项：\n$M = J\\,I_2 \\implies M^{-1} = \\frac{1}{J}\\,I_2$，其中 $I_2$ 是 $2 \\times 2$ 的单位矩阵。\n$R = I_2$ 是一个限制矩阵，对于 $N=1$ 的情况，它就是单位矩阵。\n$B = \\mathrm{diag}(-1, 1) = \\begin{pmatrix} -1  & 0 \\\\ 0  & 1 \\end{pmatrix}$。\n\n提升项为：\n$$\n- M^{-1} R^{T} B \\begin{pmatrix} r_{L} \\\\ r_{R} \\end{pmatrix} = - \\frac{1}{J} I_2 \\begin{pmatrix} -1  & 0 \\\\ 0  & 1 \\end{pmatrix} \\begin{pmatrix} r_{L} \\\\ r_{R} \\end{pmatrix} = - \\frac{1}{J} \\begin{pmatrix} -r_{L} \\\\ r_{R} \\end{pmatrix} = \\frac{1}{J} \\begin{pmatrix} r_{L} \\\\ -r_{R} \\end{pmatrix}\n$$\n代入 $r_R = -r_L$：\n$$\n\\frac{1}{J} \\begin{pmatrix} r_{L} \\\\ -(-r_{L}) \\end{pmatrix} = \\frac{r_L}{J} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n$$\n代入 $r_L = \\frac{a}{2}(u_2 - u_1)$ 的表达式：\n$$\n\\frac{1}{J} \\frac{a}{2}(u_2-u_1) \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n$$\n所以，DG 算子是：\n$$\nL^{\\mathrm{DG}}(U) = -\\frac{a}{J}\\,D\\,U + \\frac{a}{2J}(u_2-u_1) \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n$$\n\n接下来，我们分析通量重构算子 $L^{\\mathrm{FR}}(U)$。\n该算子定义为：\n$$\nL^{\\mathrm{FR}}(U) = -\\frac{a}{J}\\,D\\,U - \\frac{1}{J}\\,\\begin{pmatrix} h_{L}'(\\xi_{1})  & h_{R}'(\\xi_{1}) \\\\ h_{L}'(\\xi_{2})  & h_{R}'(\\xi_{2}) \\end{pmatrix} \\begin{pmatrix} r_{L} \\\\ r_{R} \\end{pmatrix}\n$$\n第一项与 DG 算子的体项相同。我们来计算第二项，即修正项。修正函数的导数由 $h_L'(\\xi) = -1/2$ 和 $h_R'(\\xi) = 1/2$ 给出。这些是常数，所以导数矩阵为：\n$$\n\\begin{pmatrix} h_{L}'(\\xi_{1})  & h_{R}'(\\xi_{1}) \\\\ h_{L}'(\\xi_{2})  & h_{R}'(\\xi_{2}) \\end{pmatrix} = \\begin{pmatrix} -1/2  & 1/2 \\\\ -1/2  & 1/2 \\end{pmatrix}\n$$\n这与给定的微分矩阵 $D$ 相同。我们称这个矩阵为 $D_h = D$。\nFR 修正项是：\n$$\n- \\frac{1}{J} D_h \\begin{pmatrix} r_{L} \\\\ r_{R} \\end{pmatrix} = - \\frac{1}{J} \\begin{pmatrix} -1/2  & 1/2 \\\\ -1/2  & 1/2 \\end{pmatrix} \\begin{pmatrix} r_{L} \\\\ -r_{L} \\end{pmatrix} = - \\frac{r_L}{J} \\begin{pmatrix} -1/2  & 1/2 \\\\ -1/2  & 1/2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}\n$$\n执行矩阵-向量乘法：\n$$\n- \\frac{r_L}{J} \\begin{pmatrix} (-1/2)(1) + (1/2)(-1) \\\\ (-1/2)(1) + (1/2)(-1) \\end{pmatrix} = - \\frac{r_L}{J} \\begin{pmatrix} -1 \\\\ -1 \\end{pmatrix} = \\frac{r_L}{J} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n$$\n代入 $r_L$ 的表达式：\n$$\n\\frac{1}{J} \\frac{a}{2}(u_2-u_1) \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n$$\n因此，FR 算子是：\n$$\nL^{\\mathrm{FR}}(U) = -\\frac{a}{J}\\,D\\,U + \\frac{a}{2J}(u_2-u_1) \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n$$\n比较 $L^{\\mathrm{DG}}(U)$ 和 $L^{\\mathrm{FR}}(U)$ 的表达式，我们发现它们是相同的。\n$$\nL^{\\mathrm{DG}}(U) = L^{\\mathrm{FR}}(U)\n$$\n由于半离散算子相同，且两种格式都从相同的初始条件 $U^n$ 开始，并采用完全相同的 SSP-RK3 时间步进算法，因此经过一个时间步后计算出的状态 $U^{n+1}$ 对于两种方法必须是相同的。\n$$\nU^{n+1}_{\\mathrm{DG}} = U^{n+1}_{\\mathrm{FR}}\n$$\n因此，两个状态向量之差是零向量：\n$$\nU^{n+1}_{\\mathrm{FR}} - U^{n+1}_{\\mathrm{DG}} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n这个差向量的欧几里得范数是：\n$$\n\\left\\| U^{n+1}_{\\mathrm{FR}} - U^{n+1}_{\\mathrm{DG}} \\right\\|_{2} = \\left\\| \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} \\right\\|_{2} = \\sqrt{0^2 + 0^2} = 0\n$$\n\n为了完整起见，我们也可以计算完整的算子。体项为：\n$$\n-\\frac{a}{J}\\,D\\,U = -\\frac{a}{J} \\begin{pmatrix} -1/2  & 1/2 \\\\ -1/2  & 1/2 \\end{pmatrix} \\begin{pmatrix} u_1 \\\\ u_2 \\end{pmatrix} = -\\frac{a}{J} \\frac{1}{2} \\begin{pmatrix} u_2-u_1 \\\\ u_2-u_1 \\end{pmatrix} = -\\frac{a}{2J}(u_2-u_1)\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n$$\n加上两种方法共有的修正项：\n$$\nL(U) = -\\frac{a}{2J}(u_2-u_1)\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} + \\frac{a}{2J}(u_2-u_1) \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n这表明，对于这个特定的问题设置，两个半离散算子都是零算子。因此，时间导数 $dU/dt$ 为零，解不随时间演化：对于两种方法，$U^{n+1} = U^n$。这进一步证实了最终状态相同的结论。", "answer": "$$\\boxed{0}$$", "id": "3384954"}, {"introduction": "此练习探讨了一个关键情景，在此情景下，如果实施不当，FR 和 DG 之间的形式等价性可能会被打破。我们将研究一个常速流场流经弯曲网格的问题，并展示一个朴素的 FR 实现为何无法保持这个简单的“自由流”解，从而违反了离散几何守恒律（Geometric Conservation Law, GCL）。这个计算揭示了使用保守度量计算的重要性，而这正是某些精心设计的 DG 公式所固有的优势。[@problem_id:3384975]", "problem": "考虑一个常系数二维线性平流方程，其守恒形式定义在单个曲线四边形单元上。该单元通过将参考正方形 $\\{(\\xi,\\eta): -1 \\le \\xi,\\eta \\le 1\\}$ 映射到物理空间得到，映射关系为：\n$$\nx(\\xi,\\eta) = \\xi + \\alpha\\,\\xi\\,\\eta^{2}, \\qquad y(\\xi,\\eta) = \\eta,\n$$\n其中 $\\alpha \\in \\mathbb{R}$。设物理平流速度为常数 $\\,\\boldsymbol{v} = (0,1)\\,$，解为一个严格的均匀流 $\\,u(\\boldsymbol{x},t) \\equiv u_{0}\\,$，其中 $u_{0} \\in \\mathbb{R}$ 为常数。用标准映射导数 $\\,x_{\\xi}, x_{\\eta}, y_{\\xi}, y_{\\eta}\\,$ 表示雅可比行列式和协变基向量，其中 $\\,J = x_{\\xi} y_{\\eta} - x_{\\eta} y_{\\xi}\\,$。守恒形式的逆变向量为 $\\,J \\boldsymbol{a}^{\\xi} = \\begin{bmatrix} y_{\\eta} \\\\ -x_{\\eta} \\end{bmatrix}$ 和 $\\,J \\boldsymbol{a}^{\\eta} = \\begin{bmatrix} -y_{\\xi} \\\\ x_{\\xi} \\end{bmatrix}\\,$。\n\n在每个坐标方向上，使用多项式次数为 $N=1$ 的张量积高斯-洛巴托-勒让德 (GLL) 节点进行离散化，即 $\\{\\xi_{1},\\xi_{2}\\}=\\{-1,1\\}$ 和 $\\{\\eta_{1},\\eta_{2}\\}=\\{-1,1\\}$，相应的一维节点微分矩阵为：\n$$\nD \\;=\\; \\begin{bmatrix} -\\tfrac{1}{2}  & \\tfrac{1}{2} \\\\ -\\tfrac{1}{2}  & \\tfrac{1}{2} \\end{bmatrix}.\n$$\n假设采用周期性边界条件（或等效地，对于常数状态，界面数值通量的贡献为零），因此只有体积离散化决定节点的残差。考虑以下两种用于计算映射通量散度的半离散体积公式：\n- 通量重构 (FR)：将逐点的解析导数 $\\,x_{\\xi},x_{\\eta},y_{\\xi},y_{\\eta}\\,$直接代入上述定义中，从而构造节点逆变因子 $\\,J \\boldsymbol{a}^{\\xi}\\,$ 和 $\\,J \\boldsymbol{a}^{\\eta}\\,$。然后，通过在每个坐标方向上对逆变通量 $F^{\\xi} = (J \\boldsymbol{a}^{\\xi}\\cdot \\boldsymbol{v})\\,u_{0}$ 和 $F^{\\eta} = (J \\boldsymbol{a}^{\\eta}\\cdot \\boldsymbol{v})\\,u_{0}$ 相应的节点分量应用 $D$ 来计算离散散度。\n- 使用守恒度量的节点间断伽辽金 (DG)：不通过逐点乘积来构造 $\\,J \\boldsymbol{a}^{\\xi}$ 和 $\\,J \\boldsymbol{a}^{\\eta}$；而是通过离散守恒旋度形式来计算它们：\n$$\nJ \\boldsymbol{a}^{\\xi} \\;=\\; \\begin{bmatrix} D_{\\eta}\\,y \\\\ -\\,D_{\\eta}\\,x \\end{bmatrix}, \n\\qquad\nJ \\boldsymbol{a}^{\\eta} \\;=\\; \\begin{bmatrix} -\\,D_{\\xi}\\,y \\\\ D_{\\xi}\\,x \\end{bmatrix},\n$$\n其中，$D_{\\xi}$ 在保持 $\\eta$ 固定的情况下沿 $\\xi$ 索引应用 $D$，$D_{\\eta}$ 在保持 $\\xi$ 固定的情况下沿 $\\eta$ 索引应用 $D$。\n\n仅使用这些定义和给定的映射，以闭式形式计算任意张量节点 $(\\xi_{i},\\eta_{j})$ 处的节点FR体积残差 $\\,\\mathcal{R}^{\\mathrm{FR}}_{i,j}\\,$，并证明对于相同的配置，使用守恒度量的节点DG体积残差 $\\,\\mathcal{R}^{\\mathrm{DG}}_{i,j}\\,$ 恒等于零。你的最终答案应该是 $\\,\\mathcal{R}^{\\mathrm{FR}}_{i,j}\\,$ 关于 $\\alpha$、$u_{0}$ 和 $\\eta_{j}$ 的闭式解析表达式。无需四舍五入，且无单位适用。", "solution": "该问题经评估有效。这是一个适定的、具有科学依据的偏微分方程数值分析领域的问题，特别涉及谱方法和间断伽辽金方法。所有定义、数据和条件均已提供，相互一致，且没有任何科学或逻辑上的缺陷。该问题可作为一个标准测试用例，用于检验数值格式在曲线网格上的均匀流保持性质，这是一个与几何守恒律 (GCL) 相关的关键概念。\n\n我们将首先计算通量重构 (FR) 公式的体积残差，然后计算使用守恒度量的节点间断伽辽金 (DG) 公式的体积残差。\n\n### 通量重构 (FR) 残差计算\n\nFR 方法需要在每个节点上使用解析推导的度量项来评估逆变通量，然后应用离散散度算子。\n\n1.  **解析度量导数：**\n    从参考单元 $(\\xi, \\eta)$ 到物理空间 $(x, y)$ 的映射由下式给出：\n    $$\n    x(\\xi,\\eta) = \\xi + \\alpha\\,\\xi\\,\\eta^{2}, \\qquad y(\\xi,\\eta) = \\eta\n    $$\n    偏导数（协变基向量的分量）为：\n    $$\n    x_{\\xi} = \\frac{\\partial x}{\\partial \\xi} = 1 + \\alpha\\,\\eta^{2}\n    $$\n    $$\n    x_{\\eta} = \\frac{\\partial x}{\\partial \\eta} = 2\\,\\alpha\\,\\xi\\,\\eta\n    $$\n    $$\n    y_{\\xi} = \\frac{\\partial y}{\\partial \\xi} = 0\n    $$\n    $$\n    y_{\\eta} = \\frac{\\partial y}{\\partial \\eta} = 1\n    $$\n\n2.  **守恒逆变向量：**\n    使用所提供的定义，逆变向量的守恒形式为：\n    $$\n    J \\boldsymbol{a}^{\\xi} = \\begin{bmatrix} y_{\\eta} \\\\ -2\\,\\alpha\\,\\xi\\,\\eta \\end{bmatrix} = \\begin{bmatrix} 1 \\\\ -2\\,\\alpha\\,\\xi\\,\\eta \\end{bmatrix}\n    $$\n    $$\n    J \\boldsymbol{a}^{\\eta} = \\begin{bmatrix} -y_{\\xi} \\\\ x_{\\xi} \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ 1 + \\alpha\\,\\eta^{2} \\end{bmatrix}\n    $$\n\n3.  **逆变通量：**\n    物理平流速度为 $\\boldsymbol{v} = (0, 1)$，解为常数 $u = u_0$。逆变通量 $F^{\\xi}$ 和 $F^{\\eta}$ 计算如下：\n    $$\n    F^{\\xi} = (J \\boldsymbol{a}^{\\xi} \\cdot \\boldsymbol{v})\\,u_{0} = \\left(\\begin{bmatrix} 1 \\\\ -2\\,\\alpha\\,\\xi\\,\\eta \\end{bmatrix} \\cdot \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}\\right) u_{0} = -2\\,\\alpha\\,\\xi\\,\\eta\\,u_{0}\n    $$\n    $$\n    F^{\\eta} = (J \\boldsymbol{a}^{\\eta} \\cdot \\boldsymbol{v})\\,u_{0} = \\left(\\begin{bmatrix} 0 \\\\ 1 + \\alpha\\,\\eta^{2} \\end{bmatrix} \\cdot \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}\\right) u_{0} = (1 + \\alpha\\,\\eta^{2})\\,u_{0}\n    $$\n\n4.  **离散散度（残差）：**\n    节点 $(\\xi_i, \\eta_j)$ 处的体积残差由逆变通量的离散散度给出。离散化使用 $N=1$ 的张量积GLL节点，因此 $(\\xi_i, \\eta_j) \\in \\{-1, 1\\} \\times \\{-1, 1\\}$。\n    $$\n    \\mathcal{R}^{\\mathrm{FR}}_{i,j} = \\left(D_{\\xi} F^{\\xi}\\right)_{i,j} + \\left(D_{\\eta} F^{\\eta}\\right)_{i,j}\n    $$\n    其中 $D_{\\xi}$ 和 $D_{\\eta}$ 分别表示沿相应坐标方向应用微分矩阵 $D$。\n\n    我们分别计算这两项。\n\n    **来自 $F^{\\xi}$ 的贡献：**\n    对于固定的 $\\eta_j$，沿 $\\xi$ 方向的通量值为：\n    $$\n    F^{\\xi}_{1,j} = F^{\\xi}(\\xi_1, \\eta_j) = F^{\\xi}(-1, \\eta_j) = -2\\,\\alpha\\,(-1)\\,\\eta_j\\,u_{0} = 2\\,\\alpha\\,\\eta_j\\,u_{0}\n    $$\n    $$\n    F^{\\xi}_{2,j} = F^{\\xi}(\\xi_2, \\eta_j) = F^{\\xi}(1, \\eta_j) = -2\\,\\alpha\\,(1)\\,\\eta_j\\,u_{0} = -2\\,\\alpha\\,\\eta_j\\,u_{0}\n    $$\n    将微分矩阵 $D = \\begin{bmatrix} -1/2 & 1/2 \\\\ -1/2 & 1/2 \\end{bmatrix}$ 应用于这些通量值的向量：\n    $$\n    \\begin{bmatrix} (D_{\\xi} F^{\\xi})_{1,j} \\\\ (D_{\\xi} F^{\\xi})_{2,j} \\end{bmatrix} = \\begin{bmatrix} -\\frac{1}{2} & \\frac{1}{2} \\\\ -\\frac{1}{2} & \\frac{1}{2} \\end{bmatrix} \\begin{bmatrix} 2\\,\\alpha\\,\\eta_j\\,u_{0} \\\\ -2\\,\\alpha\\,\\eta_j\\,u_{0} \\end{bmatrix} = \\begin{bmatrix} -\\alpha\\,\\eta_j\\,u_{0} - \\alpha\\,\\eta_j\\,u_{0} \\\\ -\\alpha\\,\\eta_j\\,u_{0} - \\alpha\\,\\eta_j\\,u_{0} \\end{bmatrix} = \\begin{bmatrix} -2\\,\\alpha\\,\\eta_j\\,u_{0} \\\\ -2\\,\\alpha\\,\\eta_j\\,u_{0} \\end{bmatrix}\n    $$\n    因此，对于任何 $i \\in \\{1, 2\\}$，来自 $\\xi$-通量散度的残差贡献为 $(D_{\\xi} F^{\\xi})_{i,j} = -2\\,\\alpha\\,\\eta_j\\,u_{0}$。\n\n    **来自 $F^{\\eta}$ 的贡献：**\n    在GLL节点处，$\\eta_j \\in \\{-1, 1\\}$，所以 $\\eta_j^2 = 1$。通量 $F^{\\eta}$ 在所有节点上都为常数：\n    $$\n    F^{\\eta}_{i,j} = (1 + \\alpha\\,\\eta_j^{2})\\,u_{0} = (1 + \\alpha)\\,u_{0}\n    $$\n    对于固定的 $\\xi_i$，沿 $\\eta$ 方向的通量值为 $(F^{\\eta}_{i,1}, F^{\\eta}_{i,2}) = ((1+\\alpha)u_0, (1+\\alpha)u_0)$。将 $D$ 应用于此常数向量：\n    $$\n    \\begin{bmatrix} (D_{\\eta} F^{\\eta})_{i,1} \\\\ (D_{\\eta} F^{\\eta})_{i,2} \\end{bmatrix} = \\begin{bmatrix} -\\frac{1}{2} & \\frac{1}{2} \\\\ -\\frac{1}{2} & \\frac{1}{2} \\end{bmatrix} \\begin{bmatrix} (1 + \\alpha)\\,u_{0} \\\\ (1 + \\alpha)\\,u_{0} \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ 0 \\end{bmatrix}\n    $$\n    所以，$(D_{\\eta} F^{\\eta})_{i,j} = 0$。\n\n    **总FR残差：**\n    结合这两项贡献，FR残差为：\n    $$\n    \\mathcal{R}^{\\mathrm{FR}}_{i,j} = -2\\,\\alpha\\,\\eta_j\\,u_{0} + 0 = -2\\,\\alpha\\,\\eta_j\\,u_{0}\n    $$\n    对于 $\\alpha \\ne 0$，该残差非零，表明此公式不能保持常数均匀流解。\n\n### 使用守恒度量的节点DG残差计算\n\n该方法使用离散微分算子来计算度量项本身。\n\n1.  **节点坐标场：**\n    在节点 $(\\xi_i, \\eta_j)$ 处，其中 $\\eta_j^2 = 1$，坐标为：\n    $$\n    x_{i,j} = \\xi_i + \\alpha\\,\\xi_i\\,\\eta_j^2 = \\xi_i(1+\\alpha)\n    $$\n    $$\n    y_{i,j} = \\eta_j\n    $$\n\n2.  **离散守恒逆变向量：**\n    度量项使用离散旋度形式计算：\n    $$\n    (J \\boldsymbol{a}^{\\xi})_{i,j} = \\begin{bmatrix} (D_{\\eta}\\,y)_{i,j} \\\\ -(D_{\\eta}\\,x)_{i,j} \\end{bmatrix}, \\qquad (J \\boldsymbol{a}^{\\eta})_{i,j} = \\begin{bmatrix} -(D_{\\xi}\\,y)_{i,j} \\\\ (D_{\\xi}\\,x)_{i,j} \\end{bmatrix}\n    $$\n    我们计算节点 $(\\xi_i, \\eta_j)$ 处的每个分量。\n    - $(D_{\\eta}\\,y)_{i,j}$：对于固定的 $\\xi_i$，$y$ 坐标的向量为 $(y_{i,1}, y_{i,2}) = (\\eta_1, \\eta_2) = (-1, 1)$。应用 $D$：$D \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1/2+1/2 \\\\ 1/2+1/2 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。因此，对所有 $i,j$，$(D_{\\eta}\\,y)_{i,j} = 1$。\n    - $(D_{\\eta}\\,x)_{i,j}$：对于固定的 $\\xi_i$，$x$ 坐标的向量为 $(x_{i,1}, x_{i,2}) = (\\xi_i(1+\\alpha), \\xi_i(1+\\alpha))$。由于这是一个常数向量，应用 $D$ 会得到一个零向量。因此，对所有 $i,j$，$(D_{\\eta}\\,x)_{i,j} = 0$。\n    - $(D_{\\xi}\\,y)_{i,j}$：对于固定的 $\\eta_j$，$y$ 坐标的向量为 $(y_{1,j}, y_{2,j}) = (\\eta_j, \\eta_j)$。这是一个常数向量，所以应用 $D$ 得到零。因此，对所有 $i,j$，$(D_{\\xi}\\,y)_{i,j} = 0$。\n    - $(D_{\\xi}\\,x)_{i,j}$：对于固定的 $\\eta_j$，$x$ 坐标的向量为 $(x_{1,j}, x_{2,j}) = (\\xi_1(1+\\alpha), \\xi_2(1+\\alpha)) = (-(1+\\alpha), 1+\\alpha)$。应用 $D$：$D \\begin{pmatrix} -(1+\\alpha) \\\\ 1+\\alpha \\end{pmatrix} = \\begin{pmatrix} 1/2(1+\\alpha)+1/2(1+\\alpha) \\\\ 1/2(1+\\alpha)+1/2(1+\\alpha) \\end{pmatrix} = \\begin{pmatrix} 1+\\alpha \\\\ 1+\\alpha \\end{pmatrix}$。因此，对所有 $i,j$，$(D_{\\xi}\\,x)_{i,j} = 1+\\alpha$。\n\n    在任何节点 $(\\xi_i, \\eta_j)$ 处计算的离散度量项为：\n    $$\n    (J \\boldsymbol{a}^{\\xi})^{\\mathrm{DG}}_{i,j} = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}, \\qquad (J \\boldsymbol{a}^{\\eta})^{\\mathrm{DG}}_{i,j} = \\begin{bmatrix} 0 \\\\ 1+\\alpha \\end{bmatrix}\n    $$\n\n3.  **离散逆变通量：**\n    $$\n    (F^{\\xi})^{\\mathrm{DG}}_{i,j} = ((J \\boldsymbol{a}^{\\xi})^{\\mathrm{DG}}_{i,j} \\cdot \\boldsymbol{v})\\,u_{0} = \\left(\\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} \\cdot \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}\\right) u_{0} = 0\n    $$\n    $$\n    (F^{\\eta})^{\\mathrm{DG}}_{i,j} = ((J \\boldsymbol{a}^{\\eta})^{\\mathrm{DG}}_{i,j} \\cdot \\boldsymbol{v})\\,u_{0} = \\left(\\begin{bmatrix} 0 \\\\ 1+\\alpha \\end{bmatrix} \\cdot \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}\\right) u_{0} = (1+\\alpha)\\,u_{0}\n    $$\n\n4.  **离散散度（残差）：**\n    $$\n    \\mathcal{R}^{\\mathrm{DG}}_{i,j} = \\left(D_{\\xi} (F^{\\xi})^{\\mathrm{DG}}\\right)_{i,j} + \\left(D_{\\eta} (F^{\\eta})^{\\mathrm{DG}}\\right)_{i,j}\n    $$\n    - 通量 $(F^{\\xi})^{\\mathrm{DG}}$ 在所有节点上均为零。因此其离散导数也为零。\n    - 通量 $(F^{\\eta})^{\\mathrm{DG}}$ 在所有节点上均为常数 $(1+\\alpha)u_0$。用 $D$ 对常数场求导得到零。\n    因此，两项都为零。\n\n    **总DG残差：**\n    $$\n    \\mathcal{R}^{\\mathrm{DG}}_{i,j} = 0 + 0 = 0\n    $$\n\n这表明使用守恒度量的节点DG公式是均匀流保持的，对于曲线网格上的常数解，其残差恒为零。这是因为这种构造在设计上就满足了离散几何守恒律 (GCL)。而使用解析度量的FR公式不满足离散GCL，因此会产生一个伪源项。\n\n最终答案是推导出的通量重构残差的表达式。", "answer": "$$\n\\boxed{-2\\,\\alpha\\,u_{0}\\,\\eta_{j}}\n$$", "id": "3384975"}, {"introduction": "为了在解析推导和实际应用之间建立桥梁，这最后一个练习将指导您完成为节点 DG 和 FR 方法构建完整算子矩阵的过程。通过为一个更高阶（$N=3$）的格式数值地构建这些矩阵并进行比较，您将为它们内在的等价性提供一个具体的、计算上的证实。这个练习通过将理论概念转化为线性代数和代码的语言，来巩固您的理解。[@problem_id:3385018]", "problem": "考虑参考单元 $\\xi \\in [-1,1]$ 上的一维线性平流方程 $u_t + a u_x = 0$。设 $u_h(\\xi,t)$ 在多项式阶数为 $N$ 的 $N+1$ 个 Gauss-Lobatto-Legendre (GLL) 节点上，用节点拉格朗日基表示。此推导使用以下基本基：在不同节点上通过拉格朗日多项式进行插值，对于 $N$ 阶多项式使用 GLL 权重的精确求积，以及微分矩阵的定义，即插值多项式在节点处求值的导数。\n\n您将专注于 $N=3$ 的情况，该情况在参考区间上有 $4$ 个 GLL 节点和 $4$ 个 GLL 求积权重。将节点值的列向量记为 $u \\in \\mathbb{R}^4$，对角质量矩阵记为 $M = \\mathrm{diag}(w_0,w_1,w_2,w_3)$，微分矩阵 $D \\in \\mathbb{R}^{4 \\times 4}$ 定义为 $D_{ij} = \\ell_j'(\\xi_i)$，其中 $\\ell_j$ 是第 $j$ 个拉格朗日基多项式，$\\xi_i$ 是节点。设两个面选择向量分别为 $e_L = [1,0,0,0]^T$ 和 $e_R = [0,0,0,1]^T$，分别对应于左右端点 $\\xi=-1$ 和 $\\xi=+1$。\n\n对于线性通量 $f(u) = a u$，定义界面上的数值通量 $f^*$ 如下，用内部（$+$）和外部（$-$）迹表示：\n- 迎风通量：$f^* = \\begin{cases} a u^- & \\text{if } a > 0, \\\\ a u^+ & \\text{if } a  0, \\\\ 0  \\text{if } a=0, \\end{cases}$\n- 中心通量：$f^* = \\frac{a}{2}(u^- + u^+)$。\n\n对于单个单元，将其自身自由度对半离散强形式不连续伽辽金（DG）算子的贡献写成一个矩阵 $A_{\\mathrm{DG}} \\in \\mathbb{R}^{4 \\times 4}$，使得 $u_t = A_{\\mathrm{DG}} u + \\text{(相邻项)}$。类似地，根据修正通量，为同一单元写出通量重构（FR）算子 $A_{\\mathrm{FR}}$。您的推导必须从上述基本基出发，推导出显式算子矩阵，而不依赖任何快捷公式。确保所有数学对象都用 LaTeX 表示。\n\n具体而言：\n1. 在 $[-1,1]$ 上构建 $N=3$ 的 GLL 节点 $\\{\\xi_i\\}_{i=0}^3$ 及其权重 $\\{w_i\\}_{i=0}^3$。\n2. 使用不同节点上用于微分的重心公式，从这些节点上的拉格朗日基构建微分矩阵 $D$。\n3. 对于 DG 强形式，使用 $D$、$M$ 以及左右界面上 $(f^* - f)$ 的局部贡献来表示 $A_{\\mathrm{DG}}$。只包含 $(f^* - f)$ 中依赖于单元自身节点边界值 $u_L$ 和 $u_R$ 的部分；排除依赖于相邻单元的项。\n4. 对于 FR，使用修正通量 $f_h = f(u) + (f^*_L - f_L) g_L + (f^*_R - f_R) g_R$，并用 $D$ 和修正函数在节点处的离散导数 $\\{D g_L, D g_R\\}$ 来表示 $A_{\\mathrm{FR}}$。您的推导必须展示如何正确选择 $D g_L$ 和 $D g_R$，以在指定基下实现与 DG 的等价性。\n\n然后，您必须实现一个程序，为以下测试用例组装 $A_{\\mathrm{DG}}$ 和 $A_{\\mathrm{FR}}$，并计算每种情况下它们差值的弗罗贝尼乌斯范数 $\\|A_{\\mathrm{FR}} - A_{\\mathrm{DG}}\\|_F$。测试涵盖不同的波速 $a$ 和通量类型：\n- 测试 1：$a=1.0$，迎风通量。\n- 测试 2：$a=-1.75$，迎风通量。\n- 测试 3：$a=1.0$，中心通量。\n- 测试 4：$a=-3.7$，中心通量。\n- 测试 5：$a=0.0$，迎风通量。\n\n所有答案都是无量纲的；不需要物理单位。您的程序的最终输出必须是单行，包含一个用方括号括起来的逗号分隔的浮点数列表，按上述测试的顺序对应于弗罗贝尼乌斯范数（例如，$[\\text{result1},\\text{result2},\\text{result3},\\text{result4},\\text{result5}]$）。输出必须是浮点数。", "solution": "目标是证明在一维线性平流方程 $u_t + a u_x = 0$ 的参考单元 $\\xi \\in [-1,1]$上，强形式不连续伽辽金（DG）方法的算子与通量重构（FR）方法的算子是等价的。该分析是针对阶数为 $N=3$ 的多项式近似进行的，使用定义在 $N+1=4$ 个 Gauss-Lobatto-Legendre (GLL) 点上的节点拉格朗日基。\n\n问题的核心是从第一性原理推导半离散算子 $A_{\\mathrm{DG}}$ 和 $A_{\\mathrm{FR}}$，其中单元的节点值 $u$ 根据 $u_t = A u + \\text{(相邻单元贡献)}$演化。我们将证明，通过对 FR 修正函数进行特定选择，$A_{\\mathrm{FR}}$ 会变得与 $A_{\\mathrm{DG}}$ 完全相同。\n\n**步骤 1：GLL 节点、权重和微分矩阵 ($N=3$)**\n\n对于 $N=3$ 的多项式阶数，我们在区间 $[-1,1]$ 上使用 $N+1 = 4$ 个 GLL 节点。这些节点是 $(1-\\xi^2)P_3'(\\xi)$ 的根，其中 $P_3(\\xi)$ 是 3 阶勒让德多项式。节点 $\\{\\xi_i\\}_{i=0}^3$ 是：\n$$ \\xi_0=-1, \\quad \\xi_1 = -\\sqrt{\\frac{1}{5}}, \\quad \\xi_2 = \\sqrt{\\frac{1}{5}}, \\quad \\xi_3 = 1 $$\n相应的 GLL 求积权重 $\\{w_i\\}_{i=0}^3$ 用于定义对角质量矩阵 $M=\\mathrm{diag}(w_0, w_1, w_2, w_3)$，它们是：\n$$ w_0 = \\frac{1}{6}, \\quad w_1 = \\frac{5}{6}, \\quad w_2 = \\frac{5}{6}, \\quad w_3 = \\frac{1}{6} $$\n微分矩阵 $D$ 的元素为 $D_{ij} = \\ell_j'(\\xi_i)$，其中 $\\ell_j(\\xi)$ 是第 $j$ 个拉格朗日多项式。对于 GLL 节点，微分矩阵具有分部求和（SBP）性质：\n$$ MD + D^T M = e_R e_R^T - e_L e_L^T = \\mathrm{diag}(-1, 0, 0, 1) $$\n其中 $e_L = [1,0,0,0]^T$ 和 $e_R = [0,0,0,1]^T$ 是面选择向量。此性质对稳定性和等价性证明至关重要。$N=3$ GLL 节点的唯一 $4 \\times 4$ 微分矩阵是：\n$$ D = \\begin{pmatrix} -3  \\frac{3\\sqrt{5}}{2}  - \\frac{\\sqrt{5}}{2}  \\frac{1}{2} \\\\ -\\frac{3\\sqrt{5}}{10}  0  \\frac{\\sqrt{5}}{2}  -\\frac{1}{10} \\\\ \\frac{1}{10}  -\\frac{\\sqrt{5}}{2}  0  \\frac{3\\sqrt{5}}{10} \\\\ -\\frac{1}{2}  \\frac{\\sqrt{5}}{2}  -\\frac{3\\sqrt{5}}{2}  3 \\end{pmatrix} $$\n\n**步骤 2：不连续伽辽金（DG）算子, $A_{\\mathrm{DG}}$**\n\n我们从 $u_t + a u_\\xi = 0$ 的 DG 方法的强形式出发。对于检验函数 $v_h$，我们有：\n$$ \\int_{-1}^1 v_h \\frac{\\partial u_h}{\\partial t} d\\xi = -a \\int_{-1}^1 v_h \\frac{\\partial u_h}{\\partial \\xi} d\\xi + \\left[ v_h(a u_h - f^*) \\right]_{\\xi=-1}^{\\xi=1} $$\n其中 $f^*$ 是数值通量。展开边界项可得：\n$$ \\int_{-1}^1 v_h \\frac{\\partial u_h}{\\partial t} d\\xi = -a \\int_{-1}^1 v_h \\frac{\\partial u_h}{\\partial \\xi} d\\xi + v_h(1)(a u_R^+ - f^*_R) - v_h(-1)(a u_L^+ - f^*_L) $$\n此处，$u_L^+ = u_h(-1)$ 和 $u_R^+ = u_h(1)$ 是内部迹。使用节点基 $u_h(\\xi) = \\sum_j u_j \\ell_j(\\xi)$ 和检验函数 $v_h = \\ell_i(\\xi)$进行离散化，并对积分使用 GLL 求积（这将使质量矩阵集总），我们得到关于节点值 $u$ 的一个系统：\n$$ w_i \\frac{du_i}{dt} = -a \\sum_j u_j \\left(w_i \\ell_j'(\\xi_i)\\right) + \\delta_{i3}(a u_3 - f^*_R) - \\delta_{i0}(a u_0 - f^*_L) $$\n除以 $w_i$ 并写成矩阵形式：\n$$ \\frac{du}{dt} = -a D u + M^{-1}e_R(a e_R^T u - f^*_R) - M^{-1}e_L(a e_L^T u - f^*_L) $$\n为了找到 $A_{\\mathrm{DG}}$，我们分离出依赖于单元自身解向量 $u$ 的项。数值通量可以写作 $f^*(u^+, u^-) = f^{*,+}(u^+) + f^{*,-}(u^-)$。设 $f^{*,+}(u^+) = \\alpha u^+$。\n对半离散化的局部贡献是：\n$$ A_{\\mathrm{DG}}u = -a D u + M^{-1}e_R(a e_R^T u - \\alpha_R e_R^T u) - M^{-1}e_L(a e_L^T u - \\alpha_L e_L^T u) $$\n因式分解各项，得到 DG 算子：\n$$ A_{\\mathrm{DG}} = -a D - (a - \\alpha_L) M^{-1}e_L e_L^T + (a - \\alpha_R) M^{-1}e_R e_R^T $$\n我们定义提升算子 $L_L = M^{-1}e_L e_L^T$ 和 $L_R = M^{-1}e_R e_R^T$。DG 算子是：\n$$ A_{\\mathrm{DG}} = -a D - (a - \\alpha_L) L_L + (a - \\alpha_R) L_R $$\n通量参数 $\\alpha_L$ 和 $\\alpha_R$ 取決于通量函数：\n- **迎风通量：** 如果 $a>0$，$f^* = a u^-$，因此 $\\alpha_L=\\alpha_R=0$。如果 $a0$，$f^*=au^+$，因此 $\\alpha_L=\\alpha_R=a$。\n- **中心通量：** $f^* = \\frac{a}{2}(u^+ + u^-)$，因此 $\\alpha_L=\\alpha_R=\\frac{a}{2}$。\n\n**步骤 3：通量重构（FR）算子, $A_{\\mathrm{FR}}$**\n\nFR 方法从一个不稳定的格式 $u_t = -a D u$ 开始，通过在单元边界添加修正项来使其稳定。这是通过使用一个修正通量多项式 $f_h(\\xi)$ 实现的：\n$$ f_h(\\xi) = f(u_h(\\xi)) + (f^*_L - f_L)g_L(\\xi) + (f^*_R - f_R)g_R(\\xi) $$\n其中 $f(u)=au$ 是物理通量，$f_L=f(u_L^+)$，$f_R=f(u_R^+)$，而 $g_L(\\xi)$ 和 $g_R(\\xi)$ 是修正函数。通过对这个修正通量求导并在节点处求值，可以得到半离散 FR 格式：\n$$ \\frac{du}{dt} = -D f_h(u) $$\n以向量形式表示，其中 $g_L$ 和 $g_R$ 代表在节点处求值的修正函数向量：\n$$ \\frac{du}{dt} = -D \\left[ a u + (f^*_L - a e_L^T u)g_L + (f^*_R - a e_R^T u)g_R \\right] $$\n$$ \\frac{du}{dt} = -a D u - (f^*_L - a e_L^T u) D g_L - (f^*_R - a e_R^T u) D g_R $$\n通过代入 $f^{*,+} = \\alpha u^+$，分离出依赖于 $u$ 的项：\n$$ A_{\\mathrm{FR}}u = -a D u - (\\alpha_L e_L^T u - a e_L^T u) D g_L - (\\alpha_R e_R^T u - a e_R^T u) D g_R $$\n$$ A_{\\mathrm{FR}}u = -a D u + (a - \\alpha_L)(D g_L)e_L^T u + (a - \\alpha_R)(D g_R)e_R^T u $$\n这就得到了 FR 算子：\n$$ A_{\\mathrm{FR}} = -a D + (a - \\alpha_L)(D g_L)e_L^T + (a - \\alpha_R)(D g_R)e_R^T $$\n\n**步骤 4：DG 和 FR 的等价性**\n\n为了建立等价性，我们令 $A_{\\mathrm{DG}} = A_{\\mathrm{FR}}$：\n$$ -a D - (a - \\alpha_L) L_L + (a - \\alpha_R) L_R = -a D + (a - \\alpha_L)(D g_L)e_L^T + (a - \\alpha_R)(D g_R)e_R^T $$\n体积项 $-a D$ 消掉了。为了使方程对任何通量选择（任何有效的 $a, \\alpha_L, \\alpha_R$，其中系数非零）都成立，我们必须独立地匹配边界修正项：\n$$ -(a - \\alpha_L) L_L = (a - \\alpha_L)(D g_L)e_L^T \\implies -M^{-1}e_L e_L^T = (D g_L)e_L^T $$\n$$ (a - \\alpha_R) L_R = (a - \\alpha_R)(D g_R)e_R^T \\implies M^{-1}e_R e_R^T = (D g_R)e_R^T $$\n这些算子等式必须成立，这意味着 FR 修正函数的离散导数应作如下选择：\n$$ D g_L = -M^{-1}e_L \\quad \\text{and} \\quad D g_R = M^{-1}e_R $$\n通过这个特定的选择，FR 算子变为：\n$$ A_{\\mathrm{FR}} = -a D + (a - \\alpha_L)(-M^{-1}e_L)e_L^T + (a - \\alpha_R)(M^{-1}e_R)e_R^T $$\n$$ A_{\\mathrm{FR}} = -a D - (a - \\alpha_L)L_L + (a - \\alpha_R)L_R $$\n这与 $A_{\\mathrm{DG}}$ 的表达式完全相同。\n\n结论：如果 FR 修正函数的离散导数被选为 DG 提升算子，即 $D g_L = -M^{-1} e_L$ 和 $D g_R = M^{-1} e_R$，那么使用 GLL 节点和非精确（集总质量）求积的节点 DG 格式在数学上等价于 FR 格式。因此，矩阵差 $A_{\\mathrm{FR}} - A_{\\mathrm{DG}}$ 是零矩阵，并且这个差的弗罗贝尼乌斯范数 $\\|A_{\\mathrm{FR}} - A_{\\mathrm{DG}}\\|_F$ 对于所有测试用例都将为 $0$（在机器精度范围内）。", "answer": "[0.0,0.0,0.0,0.0,0.0]", "id": "3385018"}]}