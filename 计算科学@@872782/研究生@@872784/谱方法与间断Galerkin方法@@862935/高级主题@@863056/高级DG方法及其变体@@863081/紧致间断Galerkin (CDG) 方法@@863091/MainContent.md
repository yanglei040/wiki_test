## 引言
在现代科学与工程计算中，对高精度、高效率数值方法的需求日益迫切。紧凑非连续伽辽金（Compact Discontinuous Galerkin, CDG）方法作为非连续伽辽金（DG）方法家族中的一个精密分支，因其独特的计算结构和优异的性能而备受关注。传统[DG方法](@entry_id:748369)在带来[高阶精度](@entry_id:750325)和几何灵活性的同时，其耦合模式有时会超出最近邻单元，增加了计算和通信的复杂性。[CDG方法](@entry_id:747172)的设计初衷正是为了解决这一问题，通过实现一种严格局部的“紧凑模板”，从而在保持[DG方法](@entry_id:748369)优势的同时，最大限度地提升[计算效率](@entry_id:270255)和[并行可扩展性](@entry_id:753141)。

本文旨在系统性地剖析[CDG方法](@entry_id:747172)。在“原理与机制”一章中，我们将深入探讨紧凑模板的定义、实现机制（如[提升算子](@entry_id:751273)）以及支撑其稳定性和收敛性的数学理论。接下来，“应用与跨学科连接”一章将展示[CDG方法](@entry_id:747172)如何在[流体力学](@entry_id:136788)、电磁学和[固体力学](@entry_id:164042)等领域解决复杂的实际问题，并与其他先进[数值格式](@entry_id:752822)进行对比。最后，通过“动手实践”部分提供的一系列概念性练习，读者将有机会巩固对核心概念的理解。通过这三个章节的层层递进，读者将全面掌握[CDG方法](@entry_id:747172)从理论基础到应用实践的完整图景，并领会其作为一种先进计算工具的强大潜力。

## 原理与机制

本章深入探讨紧凑非连续伽辽金 (Compact Discontinuous Galerkin, CDG) 方法的核心原理与内在机制。在上一章介绍性概述的基础上，我们将系统性地剖析定义 CDG 方法的关键特征，阐明其独特的计算优势，并建立支撑这些方法的严谨数学理论。我们将从定义紧凑模板的概念开始，逐步揭示实现这一性质的机制，并最终探讨其在稳定性、精度和实际应用中的深远影响。

### 紧凑模板：一个核心定义

在基于网格的数值方法领域，一个离散算子的**模板 (stencil)** 描述了在计算任意一个单元（或节点）的离散方程时，哪些其他的单元（或节点）的未知量会参与其中。模板的局部性直接影响着最终形成的代数系统的[稀疏性](@entry_id:136793)和[计算效率](@entry_id:270255)。

对于非[连续伽辽金方法](@entry_id:747805)，其模板最自然地由单元之间的邻接关系决定。一个 DG 方法被称为具有**紧凑模板 (compact stencil)**，如果其单元之间的耦合严格限制在共享一个公共面（即一个 $(d-1)$ 维边界）的直接邻居之间。从[图论](@entry_id:140799)的角度来看，这意味着最终离散系统（在可能的情况下通过[静态凝聚](@entry_id:176722)消除辅助变量后）的单元块稀疏模式与网格的面邻接图完全一致 [@problem_id:3371755]。换言之，对于任意两个不共享公共面的单元 $K_i$ 和 $K_j$（例如，它们仅共享一个顶点或一条边，或者完全分离），连接它们各自自由度的[全局刚度矩阵](@entry_id:138630)块必然为零。

为了更清晰地理解这一概念，我们可以将其与其他几种 DG 方法进行比较 [@problem_id:3371732]：

*   **[对称内部罚](@entry_id:755719)分伽辽金 (SIPG) 方法**：SIPG 方法的弱形式直接通过对共享面的法向通量跳跃和解的跳跃进行罚分来耦合相邻单元。这种耦合天然地局限于面邻居，因此 SIPG 方法同样具有紧凑的、仅涉及一面环邻居的模板。

*   **可杂交非连续伽辽金 (HDG) 方法**：HDG 方法引入了定义在网格骨架（所有面的集合）上的全局未知量，即解的迹。通过[静态凝聚](@entry_id:176722)，单元内部的未知量可以被局部地表示为该单元边界上迹未知量的函数。最终，我们得到一个只包含迹未知量的全局系统。在这个系统中，耦合的模式有所不同：某个面上的一组迹未知量，会与属于**同一单元**的所有其他面上的迹未知量耦合，同时也会与穿过共享面到达邻近单元的其他面上的迹未知量耦合。尽管耦合的对象是“面”而非“单元”，但其本质上仍然是局部的，仅涉及面邻居单元，因此也体现了紧凑性的思想。

CDG 方法作为一类特殊的 DG 公式，其设计的核心目标之一就是获得并保持这种严格的面邻接紧凑模板。这种结构不仅在理论上具有吸[引力](@entry_id:175476)，更在高性能计算中带来了显著的优势，我们将在后续章节中详细探讨。

### 紧凑性机制：[提升算子](@entry_id:751273)的作用

要理解 CDG 方法如何实现其紧凑模板，我们必须引入一个关键的数学工具：**[提升算子](@entry_id:751273) (lifting operator)**。[提升算子](@entry_id:751273)的核心功能是将定义在单元边界（面）上的函数（通常是解的跳跃项）“提升”为一个定义在单元体内的向量场。通过这种方式，原本需要在面上进行的积分可以被等价地转换成[体积分](@entry_id:171119) [@problem_id:3417391]。

考虑一个面 $F \subset \partial K$，一个局部[提升算子](@entry_id:751273) $\mathcal{R}_F^K$ 可以通过 Riesz [表示定理](@entry_id:637872)来定义。对于一个定义在 $F$ 上的标量函数 $\phi$，其提升 $\mathcal{R}_F^K(\phi)$ 是一个定义在单元 $K$ 上的向量多项式场，满足：
$$
\int_K \mathcal{R}_F^K(\phi) \cdot \boldsymbol{\tau}_h \, \mathrm{d}\boldsymbol{x} \;=\; \int_F \phi \, \left(\boldsymbol{\tau}_h|_K \cdot \boldsymbol{n}_K\right) \, \mathrm{d}s \quad \forall \, \boldsymbol{\tau}_h \in [\mathbb{P}_p(K)]^d
$$
其中 $\boldsymbol{\tau}_h$ 是任意一个向量测试函数，$\boldsymbol{n}_K$ 是 $K$ 的单位外法向。这个定义本质上是将一个面上的量（如解的跳跃 $\llbracket u_h \rrbracket$）的作用，通过 $L^2$ [内积](@entry_id:158127)的形式，重新分配到整个单元的体上。

[提升算子](@entry_id:751273)的“作用域”是决定模板大小的关键。我们可以区分两种主要的[提升算子](@entry_id:751273)：

1.  **局部[提升算子](@entry_id:751273) (Local Lifting Operators)**：如上定义，这种算子是针对每个单元和其上的每个面独立定义的。当我们需要重构一个单元 $K$ 上的梯度时（例如，$\boldsymbol{G}_h(u_h)|_K = \nabla_h u_h|_K + \sum_{F \subset \partial K} \mathcal{R}_F^K(\llbracket u_h \rrbracket)$），重构出的梯度 $\boldsymbol{G}_h(u_h)|_K$ 仅依赖于 $K$ 自身的梯度以及定义在 $K$ 边界所有面上的跳跃项。由于跳跃项 $\llbracket u_h \rrbracket$ 只涉及 $K$ 和其直接面邻居的解，因此，通过局部[提升算子](@entry_id:751273)构建的[数值格式](@entry_id:752822)，其单元 $K$ 的方程只会耦合其直接面邻居。这正是 CDG 方法和某些 [LDG](@entry_id:751395) (Local Discontinuous Galerkin) 变体（如 BR2 格式）获得紧凑模板的根本机制 [@problem_id:3417391]。

2.  **全局[提升算子](@entry_id:751273) (Global Lifting Operators)**：与局部算子不同，全局[提升算子](@entry_id:751273) $\mathcal{R}$ 一次性地将所有面上的跳跃提升到整个计算域的（分片）向量场中。某些 DG 格式（如最初的 Bassi–Rebay 格式，即 BR1）在数值通量中使用了这种全局提升后的重构梯度的平均值，例如 $\hat{\boldsymbol{q}}_h = -\{\kappa \boldsymbol{G}_h(u_h)\}$。这种做法会破坏紧凑性。单元 $K$ 方程的计算需要其邻居 $K'$ 上的重构梯度 $\boldsymbol{G}_h(u_h)|_{K'}$，而这个梯度又依赖于 $K'$ 所有边界上的跳跃，其中包含了 $K'$ 的邻居（即 $K$ 的二重环邻居，next-nearest neighbors）的信息。这就导致了一个更宽的、非紧凑的二重环模板 (two-ring stencil) [@problem_id:3417391]。

因此，“紧凑”非[连续伽辽金方法](@entry_id:747805)这一名称的背后，隐藏着对数值格式构建方式的特定选择，即策略性地使用**局部[提升算子](@entry_id:751273)**来确保耦合的局部性。

### 从杂交化到[区域分解](@entry_id:165934)

CDG 方法可以被看作是更广泛的**可杂交非连续伽辽金 (HDG)** 方法族的一个成员。理解这一联系有助于我们揭示 CDG 方法的另一个强大属性：它与高效[并行计算](@entry_id:139241)的天然契合性。

HDG 和 CDG 方法的核心思想是**杂交化 (hybridization)**，即引入定义在网格骨架（所有面的集合）上的辅助未知量 $\widehat{u}_h$，代表解在面上的迹。整个求解过程可以分解为两个阶段 [@problem_id:3371736]：

1.  **局部求解与[静态凝聚](@entry_id:176722) (Local Solve and Static Condensation)**：在每个单元 $K$ 上，原始的[偏微分方程](@entry_id:141332)被转化为一个局部问题，该问题关联了单元内部的未知量 $u_h|_K$ 和其边界 $\partial K$ 上的迹未知量 $\widehat{u}_h|_{\partial K}$。由于单元内部的问题是局部的（不直接依赖其他单元的内部未知量），我们可以形式上（或在计算中实际地）求解出内部未知量，将其表示为边界上迹未知量的函数。这个过程称为**[静态凝聚](@entry_id:176722)**。

2.  **全局界面问题 (Global Interface Problem)**：将上一步得到的内部解的表达式代入到全局通量[连续性方程](@entry_id:195013)中（该方程施加在每个面上），我们就能完全消除所有单元内部的未知量。最终得到一个规模更小、只包含网格骨架上迹未知量 $\widehat{u}_h$ 的全局线性系统。

这个过程的关键在于最终得到的全局系统的结构。由于[静态凝聚](@entry_id:176722)是纯粹的单元局部操作，一个单元 $K$ 的局部问题只会耦合其自身边界 $\partial K$ 上的迹未知量。因此，在最终的全局迹系统（或称 Schur 补系统）中，两个不同面上的迹未知量会产生耦合，**当且仅当这两个面属于同一个单元的边界** [@problem_id:3371736]。

这种“以单元为中心”的耦合结构对**[区域分解](@entry_id:165934) (Domain Decomposition)** 方法具有非凡的价值。在区域分解中，整个计算域被划分为若干个子区域（由许多单元构成）。我们可以将同样的杂交化思想应用在子区域层面：
*   在每个子区域内部，独立地求解一个局部问题（类似于[静态凝聚](@entry_id:176722)）。
*   在所有子区域的边界上，求解一个规模小得多的全局界面问题。

这种结构极大地减少了并行计算中不同处理器之间的[通信开销](@entry_id:636355)，因为通信仅限于[交换子](@entry_id:158878)区域边界上的数据。这使得基于 CDG/HDG 的求解器能够展现出优异的[并行可扩展性](@entry_id:753141)，使其成为求解大规模科学与工程问题的有力工具 [@problem_id:3371736]。

### 理论基础与分析

一个数值方法的价值不仅在于其计算效率，更在于其数学上的可靠性，即稳定性与收敛性。CDG 方法的理论分析同样揭示了其设计的精妙之处。

#### 稳定性与强迫性

在许多 DG 方法中（如 SIPG），稳定性（或**强迫性 (coercivity)**）是通过在[双线性形式](@entry_id:746794)中添加一个显式的罚项来实现的，例如 $\sum_{F} \frac{\sigma_F}{h_F} \int_F \llbracket u_h \rrbracket \llbracket v_h \rrbracket \, \mathrm{d}s$。这个罚项惩罚了不连续解在单元边界的跳跃，从而保证了离散问题的[适定性](@entry_id:148590)。

CDG 方法通常被称为“无罚 (penalty-free)”格式，但这并不意味着它忽略了对解的跳跃的控制。恰恰相反，CDG 通过[提升算子](@entry_id:751273)的[代数结构](@entry_id:137052)**内隐地**实现了稳定化。其双线性形式可以被优雅地写成一个增广梯度 (augmented gradient) 的 $L^2$ [内积](@entry_id:158127)形式：
$$
a_h(u_h, v_h) = \int_{\Omega} (\nabla_h u_h + \mathbf{R}_h(\llbracket u_h \rrbracket)) \cdot (\nabla_h v_h + \mathbf{R}_h(\llbracket v_h \rrbracket)) \,\mathrm{d}x
$$
其中 $\mathbf{R}_h(\llbracket u_h \rrbracket)$ 是解的跳跃的全局提升。从这个形式可以看出，$a_h(v_h, v_h)$ 直接定义了一个能量[半范数](@entry_id:264573) $\|v_h\|_{\mathrm{CDG}}^2$。

这里的关键在于证明 $\|v_h\|_{\mathrm{CDG}}$ 与一个标准的 DG [能量范数](@entry_id:274966)等价。标准 DG 范数通常包含一个显式的跳跃罚分项，如 $\sum_{F} h_F^{-1} \|\llbracket v_h \rrbracket\|_{0,F}^2$。通过使用[迹不等式](@entry_id:756082)和反不等式，可以证明[提升算子](@entry_id:751273)满足一个关键的稳定性界 [@problem_id:3371800]：
$$
\sum_{K} \|\mathbf{R}_h(\llbracket v_h \rrbracket)\|_{0,K}^2 \simeq \sum_{F} h_F^{-1} \|\llbracket v_h \rrbracket\|_{0,F}^2
$$
这个等价关系表明，CDG 方法中通过[提升算子](@entry_id:751273)引入的[体积分](@entry_id:171119)项，其作用与传统 DG 方法中的面积分罚分项完全相同。它将对解的跳跃的控制从面“提升”到了体中，从而确保了方法的强迫性，并且相应的强迫性常数不依赖于网格尺寸 $h$ [@problem_id:3371800]。

#### 收敛性与伴随一致性

在保证了稳定性之后，我们关心方法的收敛性。对于[二阶椭圆问题](@entry_id:754613)，DG 方法通常能得到关于能量范数的最优[收敛阶](@entry_id:146394)，即 $\|u-u_h\|_{\mathrm{DG}} = \mathcal{O}(h^p)$。然而，在许多应用中，我们更关心 $L^2$ 范数下的误差。

为了获得 $L^2$ 范数下的最优[收敛阶](@entry_id:146394)（即 $\mathcal{O}(h^{p+1})$），需要借助一个名为 Aubin-Nitsche 的对偶技巧。这个技巧的成功应用依赖于离散格式满足一个称为**伴随一致性 (adjoint consistency)** 的性质。对于自伴随的连续问题（如泊松方程），伴随一致性要求离散双线性形式 $a_h(\cdot, \cdot)$ 也是对称的，即 $a_h(u_h, v_h) = a_h(v_h, u_h)$ [@problem_id:3371748]。

CDG 方法的设计，特别是其对称的[数值通量](@entry_id:752791)构造，确保了[双线性形式](@entry_id:746794)的对称性。这种对称性使得离散算子成为其自身的伴随，完美地模拟了[连续算子](@entry_id:143297)的自伴随特性。正是这一特性使得对偶论证能够顺利进行，从而将[能量范数](@entry_id:274966)的[收敛阶](@entry_id:146394)提升一阶，得到最优的 $L^2$ 误差估计。如果采用非对称的数值通量，伴随一致性将被破坏，通常会导致 $L^2$ [误差收敛](@entry_id:137755)阶降为次优的 $\mathcal{O}(h^p)$ [@problem_id:3371748]。

### 实际应用考量与稳健性

将理论方法应用于实际问题时，我们必须考虑更多现实因素，如介质的非[均匀性](@entry_id:152612)、几何的复杂性以及离散[基函数](@entry_id:170178)的选择。

#### [非均匀介质](@entry_id:750241)问题

当处理具有**非均匀系数**（例如，[扩散](@entry_id:141445)系数 $\kappa$ 在不同区域有巨大差异）的问题时，数值方法的**稳健性 (robustness)** 变得至关重要。一个稳健的方法，其稳定性和收敛性常数不应该依赖于系数的跳跃比（或称反差比）$\kappa_{\max}/\kappa_{\min}$。

对于 CDG 方法，实现稳健性的关键在于[数值通量](@entry_id:752791)的设计和稳定化参数的选取 [@problem_id:3371756]。研究表明，为了得到反差比无关的误差界，必须：

1.  **使用[调和平均](@entry_id:750175) (Harmonic Averaging)**：在计算跨越不同 $\kappa$ 值界面的[数值通量](@entry_id:752791)时，必须使用 $\kappa$ 的[调和平均](@entry_id:750175)值，而不是简单的算术平均值。例如，在面 $F$ 上，使用 $\overline{\kappa}_F = 2\kappa^+\kappa^-/(\kappa^+ + \kappa^-)$。算术平均会导致稳定性常数对反差比产生不良依赖 [@problem_id:3371778, @problem_id:3371756]。

2.  **缩放稳定化参数**：稳定化参数（无论是显式的罚分还是内隐在[提升算子](@entry_id:751273)中）的大小需要根据局部的 $\kappa$ 值进行缩放。一个稳健的选择是让稳定化强度正比于局部的 $\kappa$ 值（通常是调和平均值），例如 $\sigma_F \gtrsim \overline{\kappa}_F p^2/h_F$ [@problem_id:3371756]。

#### 复杂几何与[基函数](@entry_id:170178)选择

在处理**弯曲边界或弯曲单元**时，单元上的计算通常通过一个从[参考单元](@entry_id:168425)到物理单元的等参数映射 $\Phi_K$ 来完成。为了保证整个 DG 格式的守恒性和对称性，必须在相邻单元共享的弯[曲面](@entry_id:267450)上采用一致的几何信息和数值积分方案。标准做法是采用“主从 (master-slave)”策略：选择一个单元（主元）来定义面上的物理积分点和[法向量](@entry_id:264185)，然后通过映射关系找到另一个单元（从元）在自己参考[坐标系](@entry_id:156346)下的对应积分点。这样可以确保在每个物理积分点上，法向量严格相反，函数迹值被精确地对应起来 [@problem_id:3371795]。

最后，单元上**多项式[基函数](@entry_id:170178)的选择**虽然不改变全局的紧凑耦合模式，但对局部矩阵的性质（如[稀疏性](@entry_id:136793)和[条件数](@entry_id:145150)）以及计算的稳健性有重大影响 [@problem_id:3371786]：

*   **模态正交基 (Modal Orthonormal Basis)**：例如基于 Gram-Schmidt 正交化得到的[基函数](@entry_id:170178)，或等级化的 Jacobi/Legendre 多项式。它们的主要优势是使得[单元质量矩阵](@entry_id:748930) $M^{(K)}$ 成为单位矩阵。这导致了完美的条件数 $\kappa(M^{(K)})=1$，对于高阶 ($p$) 计算和时间依赖问题极为有利，因为它简化了时间推进求解过程。

*   **[节点基](@entry_id:752522) (Nodal Basis)**：例如与一组插值点相关的 Lagrange 多项式。这种基的物理解释直观（自由度是函数在节点上的值）。然而，如果使用等距[分布](@entry_id:182848)的插值点，所形成的基底会随着多项式次数 $p$ 的增加而变得严重病态（其背后的数学原理与龙格现象和[范德蒙矩阵](@entry_id:147747)的病态性有关）。这会导致质量矩阵的条件数爆炸式增长，严重影响[数值稳定性](@entry_id:146550)。因此，在[高阶方法](@entry_id:165413)中，如果使用[节点基](@entry_id:752522)，通常会选择非等距的节点，如 Gauss-Lobatto 点，以改善条件数。

总而言之，对于需要[高阶精度](@entry_id:750325)和稳健性的 CDG 应用，模态[正交基](@entry_id:264024)因其优越的谱性质而成为首选 [@problem_id:3371786]。

通过以上对原理、机制、理论和实践的系统性剖析，我们看到，紧凑非[连续伽辽金方法](@entry_id:747805)并非仅仅是一个孤立的[数值格式](@entry_id:752822)，而是一个综合了[代数结构](@entry_id:137052)、分析性质和计算考量的精密设计。其核心的紧凑性不仅带来了计算上的便利，更与方法的稳定性、精度以及在现代计算架构上的可扩展性紧密相连。