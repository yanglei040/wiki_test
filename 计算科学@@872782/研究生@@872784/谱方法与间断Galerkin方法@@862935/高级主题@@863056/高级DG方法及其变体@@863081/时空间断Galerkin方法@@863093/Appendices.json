{"hands_on_practices": [{"introduction": "任何间断Galerkin (DG) 方法的基础都建立在单个单元上的局部近似空间。本练习将探讨时空DG方法中最常见的选择：由空间和时间上的勒让德多项式构成的张量积基函数。通过推导自由度数量和质量矩阵，您将亲身体会到正交基底如何简化计算，并为高效的显式时间推进方案奠定基础 [@problem_id:3415511]。", "problem": "考虑一个单一时空单元 $K \\times I$，其中 $K = [x_{L}, x_{R}] \\subset \\mathbb{R}$ 是一个空间区间，$I = [t_{n}, t_{n+1}] \\subset \\mathbb{R}$ 是一个时间层。令 $\\xi \\in [-1,1]$ 和 $\\tau \\in [-1,1]$ 表示通过仿射映射 $x = x_{c} + J_{x}\\,\\xi$ 和 $t = t_{c} + J_{t}\\,\\tau$ 得到的参考坐标，其中 $x_{c} = (x_{L} + x_{R})/2$，$t_{c} = (t_{n} + t_{n+1})/2$，$J_{x} = (x_{R} - x_{L})/2$ 以及 $J_{t} = (t_{n+1} - t_{n})/2$。在参考方块 $[-1,1] \\times [-1,1]$ 上，考虑由标准 Legendre 多项式（在 $[-1,1]$ 上关于单位权重正交）形成的张量积基，即 $\\{\\phi_{i,s}(\\xi,\\tau)\\}_{0 \\leq i \\leq p_{x},\\, 0 \\leq s \\leq p_{t}}$，其中 $\\phi_{i,s}(\\xi,\\tau) = P_{i}(\\xi)\\,P_{s}(\\tau)$，而 $P_{n}$ 是 $n$ 次 Legendre 多项式。\n\n在时空不连续 Galerkin (DG) 离散化中，$K \\times I$ 上的局部质量矩阵具有元\n$$\nM_{(i,s),(j,r)} = \\int_{K} \\int_{I} \\phi_{i,s}(x,t)\\,\\phi_{j,r}(x,t)\\,\\mathrm{d}t\\,\\mathrm{d}x,\n$$\n其中 $0 \\leq i,j \\leq p_{x}$ 且 $0 \\leq s,r \\leq p_{t}$。使用上述仿射映射，该积分可以在参考方块上表示，并且可以通过在空间和时间上使用 Gauss–Legendre 求积法进行计算，其中在 $\\xi$ 方向有 $Q_{x}$ 个点，在 $\\tau$ 方向有 $Q_{t}$ 个点。假设所选的 Gauss–Legendre 法则能够精确积分最高次数为 $2p_{x}$ 的任意多项式乘积 $\\xi$-因子和最高次数为 $2p_{t}$ 的任意 $\\tau$-因子。\n\n任务：\n- 推导与 $(p_{x},p_{t})$ 相关的张量积多项式空间的局部自由度数量。\n- 在空间和时间上使用 Gauss–Legendre 求积法的情况下，推导 $M_{(i,s),(j,r)}$ 的显式解析表达式，该表达式用 $J_{x}$、$J_{t}$ 和 Legendre 多项式表示。陈述质量矩阵为对角矩阵的条件，并给出该情况下其对角元的闭式值。\n\n以单个闭式解析表达式或表达式的行向量形式提供最终答案。无需进行数值计算。", "solution": "用户提供了一个来自数值分析领域的适定问题陈述，具体涉及了时空不连续 Galerkin (DG) 方法。该问题在科学上是合理的、自洽的且没有矛盾。因此，我将进行完整的推导。\n\n问题要求推导三个量：\n1.  局部自由度的数量。\n2.  局部质量矩阵元的显式解析表达式。\n3.  质量矩阵为对角矩阵的条件及其对角元的值。\n\n让我们按顺序处理每个任务。\n\n**1. 局部自由度数量**\n\n时空单元 $K \\times I$ 上的多项式逼近空间是使用张量积基构建的。基函数由 $\\phi_{i,s}(\\xi,\\tau) = P_{i}(\\xi)\\,P_{s}(\\tau)$ 给出，其中 $P_{n}$ 是 $n$ 次 Legendre 多项式。\n\n基的空间部分由参考坐标 $\\xi$ 中的多项式构成，其次数范围从 $0$ 到 $p_x$。空间基多项式集合可以表示为 $\\{P_i(\\xi)\\}_{i=0}^{p_x}$。这类多项式的数量是索引 $i$ 从 $0$ 到 $p_x$ 的计数，即 $p_x + 1$。\n\n类似地，基的时间部分由参考坐标 $\\tau$ 中的多项式构成，其次数范围从 $0$ 到 $p_t$。时间基多项式集合为 $\\{P_s(\\tau)\\}_{s=0}^{p_t}$。这些多项式的数量是 $p_t + 1$。\n\n完整的张量积基是通过取一个空间基函数和一个时间基函数的所有可能乘积构成的，即 $\\{P_i(\\xi)P_s(\\tau)\\}_{0 \\le i \\le p_x, 0 \\le s \\le p_t}$。这个集合中基函数的总数，即对应于单元 $K \\times I$ 上的局部自由度 (DoF) 数量，是空间基函数数量和时间基函数数量的乘积。\n\n自由度数量 = (空间基函数的数量) $\\times$ (时间基函数的数量)\n$$\n\\text{DoF} = (p_x + 1)(p_t + 1)\n$$\n\n**2. 局部质量矩阵元的表达式**\n\n局部质量矩阵元由以下积分定义：\n$$\nM_{(i,s),(j,r)} = \\int_{K} \\int_{I} \\phi_{i,s}(x,t)\\,\\phi_{j,r}(x,t)\\,\\mathrm{d}t\\,\\mathrm{d}x\n$$\n基函数 $\\phi_{i,s}$ 和 $\\phi_{j,r}$ 是在参考方块 $[-1,1] \\times [-1,1]$ 上用坐标 $(\\xi, \\tau)$ 定义的。为了计算该积分，我们必须进行从物理坐标 $(x,t)$ 到参考坐标 $(\\xi,\\tau)$ 的变量替换。\n\n仿射映射由下式给出：\n$x(\\xi) = x_{c} + J_{x}\\,\\xi$\n$t(\\tau) = t_{c} + J_{t}\\,\\tau$\n\n微分通过对这些映射求导得到：\n$\\mathrm{d}x = \\frac{\\mathrm{d}x}{\\mathrm{d}\\xi} \\mathrm{d}\\xi = J_x \\mathrm{d}\\xi$\n$\\mathrm{d}t = \\frac{\\mathrm{d}t}{\\mathrm{d}\\tau} \\mathrm{d}\\tau = J_t \\mathrm{d}\\tau$\n\n微分面积元变换为 $\\mathrm{d}t\\,\\mathrm{d}x = J_t J_x \\,\\mathrm{d}\\tau\\,\\mathrm{d}\\xi$。积分限从 $x \\in K = [x_L, x_R]$ 变为 $\\xi \\in [-1,1]$，从 $t \\in I = [t_n, t_{n+1}]$ 变为 $\\tau \\in [-1,1]$。\n\n将变换和基函数定义 $\\phi_{i,s}(\\xi,\\tau) = P_i(\\xi)P_s(\\tau)$ 和 $\\phi_{j,r}(\\xi,\\tau) = P_j(\\xi)P_r(\\tau)$ 代入质量矩阵积分，得到：\n$$\nM_{(i,s),(j,r)} = \\int_{-1}^{1} \\int_{-1}^{1} [P_{i}(\\xi)\\,P_{s}(\\tau)]\\,[P_{j}(\\xi)\\,P_{r}(\\tau)]\\, J_{x} J_{t} \\,\\mathrm{d}\\tau\\,\\mathrm{d}\\xi\n$$\n由于 $J_x$ 和 $J_t$ 对于给定单元是常数，它们可以被提出来。被积函数是 $\\xi$ 的函数和 $\\tau$ 的函数的乘积，因此二重积分可以分离为两个单变量积分的乘积（Fubini 定理）：\n$$\nM_{(i,s),(j,r)} = J_{x} J_{t} \\left( \\int_{-1}^{1} P_{i}(\\xi) P_{j}(\\xi) \\,\\mathrm{d}\\xi \\right) \\left( \\int_{-1}^{1} P_{s}(\\tau) P_{r}(\\tau) \\,\\mathrm{d}\\tau \\right)\n$$\n问题陈述指出，这些积分是使用 Gauss-Legendre 求积法则计算的，该法则对于 $\\xi$ 中最高次数为 $2p_x$ 和 $\\tau$ 中最高次数为 $2p_t$ 的多项式是精确的。$\\xi$-积分中的被积函数是 $P_i(\\xi)P_j(\\xi)$，这是一个次数为 $i+j$ 的多项式。由于 $0 \\le i,j \\le p_x$，最大次数为 $2p_x$。因此，求积法则对该积分是精确的。类似的论证也适用于 $\\tau$-积分，其被积函数的最大次数为 $2p_t$。\n因为求积是精确的，其结果与积分的解析值相同。我们可以利用 Legendre 多项式在区间 $[-1,1]$ 上权重函数为 $1$ 的正交性来解析地计算这些积分：\n$$\n\\int_{-1}^{1} P_m(z) P_n(z) \\,\\mathrm{d}z = \\frac{2}{2n+1} \\delta_{mn}\n$$\n其中 $\\delta_{mn}$ 是 Kronecker delta，当 $m=n$ 时为 $1$，否则为 $0$。\n\n将此性质应用于我们的两个积分：\n$$\n\\int_{-1}^{1} P_{i}(\\xi) P_{j}(\\xi) \\,\\mathrm{d}\\xi = \\frac{2}{2i+1} \\delta_{ij}\n$$\n$$\n\\int_{-1}^{1} P_{s}(\\tau) P_{r}(\\tau) \\,\\mathrm{d}\\tau = \\frac{2}{2s+1} \\delta_{sr}\n$$\n将这些结果代回 $M_{(i,s),(j,r)}$ 的表达式中：\n$$\nM_{(i,s),(j,r)} = J_{x} J_{t} \\left( \\frac{2}{2i+1} \\delta_{ij} \\right) \\left( \\frac{2}{2s+1} \\delta_{sr} \\right)\n$$\n这就给出了质量矩阵元的最终显式解析表达式：\n$$\nM_{(i,s),(j,r)} = \\frac{4 J_{x} J_{t}}{(2i+1)(2s+1)} \\delta_{ij} \\delta_{sr}\n$$\n\n**3. 对角性与对角元**\n\n质量矩阵 $M$ 由复合索引索引，例如 $\\alpha = (i,s)$ 和 $\\beta = (j,r)$。如果 $\\alpha = \\beta$，即 $(i,s) = (j,r)$ 或 $i=j$ 且 $s=r$，则 $M_{\\alpha,\\beta}$ 是一个对角元。非对角元是指 $\\alpha \\neq \\beta$ 的元。\n\n推导出的质量矩阵元表达式为 $M_{(i,s),(j,r)} = \\frac{4 J_{x} J_{t}}{(2i+1)(2s+1)} \\delta_{ij} \\delta_{sr}$。项 $\\delta_{ij} \\delta_{sr}$ 当且仅当 $i=j$ 且 $s=r$ 时等于 $1$。如果 $i \\neq j$ 或 $s \\neq r$，则该项为 $0$。这意味着只要复合索引 $(i,s)$ 和 $(j,r)$ 不相同，矩阵元就为零。\n\n因此，局部质量矩阵是对角的。出现这种情况的条件是使用了一个关于参考单元上 $L^2$ 内积 $\\langle u, v \\rangle = \\int_{-1}^1\\int_{-1}^1 u(\\xi,\\tau)v(\\xi,\\tau) d\\tau d\\xi$ 正交的基。张量积 Legendre 基 $\\{P_i(\\xi)P_s(\\tau)\\}$ 就是这样一个正交基。问题陈述本身就确立了这一条件。\n\n对角元的值是当 $i=j$ 且 $s=r$ 时 $M_{(i,s),(j,r)}$ 的值。在通用公式中令 $j=i$ 和 $r=s$，我们得到 $\\delta_{ii} = 1$ 和 $\\delta_{ss} = 1$。对应于基函数 $\\phi_{i,s}$ 的对角元是：\n$$\nM_{(i,s),(i,s)} = \\frac{4 J_{x} J_{t}}{(2i+1)(2s+1)}\n$$\n这就是对角元的闭式值。$M_{(i,s),(j,r)}$ 的完整表达式已经完全捕捉了此信息。\n\n最终答案是自由度的数量和质量矩阵元的一般表达式。", "answer": "$$\n\\boxed{\\begin{pmatrix} (p_{x}+1)(p_{t}+1)  \\frac{4 J_{x} J_{t}}{(2i+1)(2s+1)} \\delta_{ij} \\delta_{sr} \\end{pmatrix}}\n$$", "id": "3415511"}, {"introduction": "标准多项式基底虽然通用，但并未利用任何关于待解偏微分方程(PDE)的信息。本练习将介绍一种更高级的策略——Trefftz方法，其核心思想是选择在每个单元内部精确满足PDE的基函数。通过为波动方程构建Trefftz多项式空间并计算其维度，您将量化这种“PDE感知”方法相对于标准方法在减少每个单元未知量方面的显著优势 [@problem_id:3415514]。", "problem": "考虑一个定义在时空柱体 $\\Omega \\times (0,T)$ 上的常系数波动方程 $u_{tt} - c^{2}\\Delta u = 0$，其中 $\\Omega \\subset \\mathbb{R}^{d}$ 是一个有界空间域， $c>0$ 是波速。在时空不连续伽辽金(DG)方法中，我们在每个时空单元 $K \\subset \\mathbb{R}^{d+1}$ 上设计一个局部有限维逼近空间，并在单元间界面上通过数值通量来施加弱形式。\n\nTrefftz时空DG方法在每个单元 $K$ 上选择的局部基函数，在 $K$ 内部精确满足偏微分方程 $u_{tt} - c^{2}\\Delta u = 0$。相比之下，标准的时空DG方法使用所有在 $(d+1)$ 个时空变量中总次数至多为 $p$ 的多项式，而不强制要求满足内部方程。\n\n考虑一个固定的单元 $K$，并假设标准和Trefftz的局部基都由在 $(x,t) \\in \\mathbb{R}^{d+1}$ 中总次数至多为 $p$ 的多项式构成。仅使用多项式空间和常系数二阶微分算子的基本性质，完成以下任务：\n\n1. 精确定义在 $n=d+1$ 个变量中总次数至多为 $p$ 的标准多项式空间，并给出其维数。\n2. 将总次数至多为 $p$ 的Trefftz多项式空间定义为在 $K$ 中满足 $u_{tt} - c^{2}\\Delta u = 0$ 的多项式 $u(x,t)$。通过分解为不同次数的齐次多项式，并利用波动算子作用于齐次多项式上的结构，推导出该Trefftz空间维数的闭式表达式。\n3. 根据这些维数，推导缩减因子 $R(d,p)$ 的一个闭式解析表达式（作为 $d$ 和 $p$ 的函数）。该因子定义为Trefftz时空DG方法中每个单元的局部未知量数量与标准多项式时空DG方法中该数量的比值。\n\n将 $R(d,p)$ 的最终答案表示为关于 $d$ 和 $p$ 的单一简化解析表达式。无需进行数值近似或四舍五入。最终答案不涉及物理单位。", "solution": "该问题要求比较用于波动方程的标准基于多项式的时空不连续伽辽金(DG)方法与Trefftz时空DG方法的局部未知量数量。这通过计算各自局部逼近空间的维数并求其比值来实现。设空间维数为 $d$，多项式次数为 $p$。时空具有 $n = d+1$ 个维度。波动算子为 $L = \\partial_{tt} - c^2 \\Delta$，其中 $\\Delta$ 是 $d$ 个空间变量的拉普拉斯算子。\n\n1.  **标准多项式空间及其维数**\n\n标准多项式空间是在 $n=d+1$ 个时空变量中总次数至多为 $p$ 的所有多项式构成的空间。设时空变量为 $(x_1, \\dots, x_d, t)$。该空间记作 $\\mathcal{P}_p(\\mathbb{R}^{d+1})$，定义为：\n$$\n\\mathcal{P}_p(\\mathbb{R}^{d+1}) = \\left\\{ \\sum_{|\\alpha| \\le p} c_\\alpha \\mathbf{y}^\\alpha : c_\\alpha \\in \\mathbb{R} \\right\\}\n$$\n其中 $\\mathbf{y} = (x_1, \\dots, x_d, t) \\in \\mathbb{R}^{d+1}$，$\\alpha$ 是一个具有非负整数分量的多重指标 $(\\alpha_1, \\dots, \\alpha_{d+1})$， $|\\alpha| = \\sum_{i=1}^{d+1} \\alpha_i$ 且 $\\mathbf{y}^\\alpha = x_1^{\\alpha_1} \\cdots x_d^{\\alpha_d} t^{\\alpha_{d+1}}$。\n\n该空间的维数（我们记作 $N_{std}(d,p)$）是满足 $|\\alpha| \\le p$ 的不同多重指标 $\\alpha$ 的数量。这是一个经典的组合学结果，等价于将 $p$ 个不可区分的物品放入 $d+1$ 个可区分的盒子中，其结果由下式给出：\n$$\nN_{std}(d,p) = \\dim(\\mathcal{P}_p(\\mathbb{R}^{d+1})) = \\binom{p + (d+1)}{d+1} = \\binom{p+d+1}{d+1}\n$$\n\n2.  **Trefftz多项式空间及其维数**\n\nTrefftz多项式空间由 $\\mathcal{P}_p(\\mathbb{R}^{d+1})$ 中同时也是波动方程解的多项式组成。设该空间为 $\\mathcal{T}_p(\\mathbb{R}^{d+1})$。\n$$\n\\mathcal{T}_p(\\mathbb{R}^{d+1}) = \\{ u \\in \\mathcal{P}_p(\\mathbb{R}^{d+1}) : (\\partial_{tt} - c^2 \\Delta)u = 0 \\}\n$$\n波动算子 $L = \\partial_{tt} - c^2 \\Delta$ 是一个线性算子。空间 $\\mathcal{T}_p$ 是 $L$ 限制在 $\\mathcal{P}_p(\\mathbb{R}^{d+1})$ 上的核。$L$ 是一个二阶齐次微分算子，因此它将一个总次数为 $k$ 的多项式映射到一个总次数为 $k-2$ 的多项式。所以，$L$ 将空间 $\\mathcal{P}_p(\\mathbb{R}^{d+1})$ 映射到空间 $\\mathcal{P}_{p-2}(\\mathbb{R}^{d+1})$。\n$$\nL : \\mathcal{P}_p(\\mathbb{R}^{d+1}) \\to \\mathcal{P}_{p-2}(\\mathbb{R}^{d+1})\n$$\n根据秩-零度定理，Trefftz空间的维数 $N_{Tfz}(d,p) = \\dim(\\mathcal{T}_p(\\mathbb{R}^{d+1}))$ 由下式给出：\n$$\nN_{Tfz}(d,p) = \\dim(\\mathcal{P}_p(\\mathbb{R}^{d+1})) - \\dim(\\text{Im}(L|_{\\mathcal{P}_p}))\n$$\n为了求像的维数，我们将多项式空间分解为齐次多项式空间的直和。设 $\\mathcal{H}_k(\\mathbb{R}^{d+1})$ 是 $d+1$ 个变量中 $k$ 次齐次多项式的空间。其维数为 $\\dim(\\mathcal{H}_k(\\mathbb{R}^{d+1})) = \\binom{k+(d+1)-1}{(d+1)-1} = \\binom{k+d}{d}$。\n\n总次数至多为 $p$ 的多项式空间是 $\\mathcal{P}_p(\\mathbb{R}^{d+1}) = \\bigoplus_{k=0}^p \\mathcal{H}_k(\\mathbb{R}^{d+1})$。算子 $L$ 将 $\\mathcal{H}_k$ 映射到 $\\mathcal{H}_{k-2}$。常系数二阶微分算子（其符号是一个非退化二次型，这对波动方程成立，因为 $c \\neq 0$）的一个基本性质是，对于所有 $k \\ge 2$，映射 $L|_{\\mathcal{H}_k}: \\mathcal{H}_k(\\mathbb{R}^{d+1}) \\to \\mathcal{H}_{k-2}(\\mathbb{R}^{d+1})$ 是满射的。\n这意味着对于 $k \\ge 2$，$\\mathcal{H}_k$ 在 $L$ 下的像是整个空间 $\\mathcal{H}_{k-2}$。\n将秩-零度定理应用于这个受限映射，我们得到：\n$$\n\\dim(\\mathcal{H}_k) = \\dim(\\ker(L|_{\\mathcal{H}_k})) + \\dim(\\text{Im}(L|_{\\mathcal{H}_k}))\n$$\n因为对于 $k \\ge 2$，$\\dim(\\text{Im}(L|_{\\mathcal{H}_k})) = \\dim(\\mathcal{H}_{k-2})$，我们得到：\n$$\n\\dim(\\ker(L|_{\\mathcal{H}_k})) = \\dim(\\mathcal{H}_k) - \\dim(\\mathcal{H}_{k-2}) \\quad \\text{for } k \\ge 2\n$$\n对于 $k=0$ 和 $k=1$，$\\mathcal{H}_0$ (常数) 或 $\\mathcal{H}_1$ (线性函数) 中的任何多项式都会被二阶算子 $L$ 零化。因此，$\\ker(L|_{\\mathcal{H}_0}) = \\mathcal{H}_0$ 且 $\\ker(L|_{\\mathcal{H}_1}) = \\mathcal{H}_1$。\n\n完整的Trefftz空间 $\\mathcal{T}_p$ 是每个齐次次数层级的核的直和：\n$$\n\\mathcal{T}_p(\\mathbb{R}^{d+1}) = \\bigoplus_{k=0}^p \\ker(L|_{\\mathcal{H}_k})\n$$\n其维数是这些核的维数之和：\n$$\nN_{Tfz}(d,p) = \\dim(\\ker(L|_{\\mathcal{H}_0})) + \\dim(\\ker(L|_{\\mathcal{H}_1})) + \\sum_{k=2}^p \\dim(\\ker(L|_{\\mathcal{H}_k}))\n$$\n$$\nN_{Tfz}(d,p) = \\dim(\\mathcal{H}_0) + \\dim(\\mathcal{H}_1) + \\sum_{k=2}^p (\\dim(\\mathcal{H}_k) - \\dim(\\mathcal{H}_{k-2}))\n$$\n这个和是一个伸缩级数：\n$$\n\\sum_{k=2}^p (\\dim(\\mathcal{H}_k) - \\dim(\\mathcal{H}_{k-2})) = (\\dim(\\mathcal{H}_2) - \\dim(\\mathcal{H}_0)) + (\\dim(\\mathcal{H}_3) - \\dim(\\mathcal{H}_1)) + \\dots + (\\dim(\\mathcal{H}_p) - \\dim(\\mathcal{H}_{p-2}))\n$$\n$$\n= \\dim(\\mathcal{H}_p) + \\dim(\\mathcal{H}_{p-1}) - \\dim(\\mathcal{H}_1) - \\dim(\\mathcal{H}_0)\n$$\n将此代回到 $N_{Tfz}(d,p)$ 的表达式中：\n$$\nN_{Tfz}(d,p) = \\dim(\\mathcal{H}_0) + \\dim(\\mathcal{H}_1) + (\\dim(\\mathcal{H}_p) + \\dim(\\mathcal{H}_{p-1}) - \\dim(\\mathcal{H}_1) - \\dim(\\mathcal{H}_0))\n$$\n$$\nN_{Tfz}(d,p) = \\dim(\\mathcal{H}_p(\\mathbb{R}^{d+1})) + \\dim(\\mathcal{H}_{p-1}(\\mathbb{R}^{d+1}))\n$$\n使用公式 $\\dim(\\mathcal{H}_k(\\mathbb{R}^{d+1})) = \\binom{k+d}{d}$，我们得到：\n$$\nN_{Tfz}(d,p) = \\binom{p+d}{d} + \\binom{p-1+d}{d}\n$$\n这里我们使用约定，如果 $k > n$，则 $\\binom{n}{k} = 0$，因此当 $p=0$ 时第二项为零。\n\n3.  **缩减因子**\n\n缩减因子 $R(d,p)$ 是Trefftz空间维数与标准空间维数的比值。\n$$\nR(d,p) = \\frac{N_{Tfz}(d,p)}{N_{std}(d,p)} = \\frac{\\binom{p+d}{d} + \\binom{p+d-1}{d}}{\\binom{p+d+1}{d+1}}\n$$\n我们先简化分子：\n$$\n\\binom{p+d}{d} + \\binom{p+d-1}{d} = \\frac{(p+d)!}{p!d!} + \\frac{(p+d-1)!}{(p-1)!d!} = \\frac{(p+d-1)!}{p!d!} (p+d + p) = \\frac{(p+d-1)!(2p+d)}{p!d!}\n$$\n现在，让我们用阶乘表达式写出完整的比值：\n$$\nR(d,p) = \\frac{\\frac{(p+d-1)!(2p+d)}{p!d!}}{\\frac{(p+d+1)!}{p!(d+1)!}}\n$$\n$$\nR(d,p) = \\frac{(p+d-1)!(2p+d)}{p!d!} \\times \\frac{p!(d+1)!}{(p+d+1)!}\n$$\n$p!$ 项被消去。我们展开 $(d+1)! = (d+1)d!$ 和 $(p+d+1)! = (p+d+1)(p+d)(p+d-1)!$:\n$$\nR(d,p) = \\frac{(p+d-1)!(2p+d)}{d!} \\times \\frac{(d+1)d!}{(p+d+1)(p+d)(p+d-1)!}\n$$\n消去公因式阶乘项 $(p+d-1)!$ 和 $d!$:\n$$\nR(d,p) = \\frac{(2p+d)(d+1)}{(p+d+1)(p+d)}\n$$\n这就是缩减因子的最终闭式解析表达式。对于 $p=1$，分子和分母相等，得到 $R(d,1)=1$，这是正确的，因为所有一次多项式都是波动方程的解。对于 $p \\ge 2$，该因子小于 $1$，表明未知量的数量有所减少。", "answer": "$$\n\\boxed{\\frac{(d+1)(2p+d)}{(p+d)(p+d+1)}}\n$$", "id": "3415514"}, {"introduction": "在获得数值解之后，一个关键的实际问题是如何评估其准确性并有效地提高精度。本练习将引导您构建一个基于残差的后验误差估计子，这是一种利用已计算出的解本身来估计误差的强大工具。您将为抛物型方程推导一个包含单元内部残差和时空界面跳跃项的估计子，并理解这些估计子如何为空间和时间上的自适应网格加密提供理论依据 [@problem_id:3415471]。", "problem": "考虑标量线性抛物型偏微分方程 (PDE)\n$$\n\\partial_{t} u - \\nabla \\cdot \\left( A(x) \\nabla u \\right) = f \\quad \\text{in } \\Omega \\times I,\n$$\n该方程在 $d$-维环面 $\\Omega = \\mathbb{T}^{d}$ 上具有空间周期性边界条件，在 $\\Omega$ 上具有初始数据 $u(\\cdot,0) = u_{0}$。假设 $A(x) \\in \\mathbb{R}^{d \\times d}$ 是可测、对称且一致椭圆的，即存在常数 $0  \\alpha \\leq \\Lambda  \\infty$ 使得\n$$\n\\alpha \\, |\\xi|^{2} \\leq \\xi^{\\top} A(x) \\, \\xi \\leq \\Lambda \\, |\\xi|^{2} \\quad \\text{for all } \\xi \\in \\mathbb{R}^{d} \\text{ and almost every } x \\in \\Omega,\n$$\n且 $f \\in L^{2}(\\Omega \\times I)$，$u_{0} \\in L^{2}(\\Omega)$。令 $I = (0,T)$，并设 $\\left\\{0 = t_{0}  t_{1}  \\cdots  t_{N} = T\\right\\}$ 是 $I$ 的一个划份，划分为子区间 $J_{n} = (t_{n}, t_{n+1})$，时间步长为 $\\tau_{n} = t_{n+1} - t_{n}$。设 $\\mathcal{T}_{h}$ 是 $\\Omega$ 的一个形状正则的三角剖分，其空间单元为 $K$，局部直径为 $h_{K}$。考虑时空网格 $\\mathcal{Q}_{h} = \\{E = K \\times J_{n} : K \\in \\mathcal{T}_{h}, \\, n = 0, \\dots, N-1\\}$。\n\n设 $V_{h}^{p,q}$ 是一个不连续有限维函数空间，其函数在每个空间单元 $K$ 上是次数至多为 $p$ 的多项式，在每个时间区间 $J_{n}$ 上是次数至多为 $q$ 的多项式，并允许在空间面 $\\partial K$ 和时间节点 $\\{t_{n}\\}$ 上不连续。假设 $u_{h} \\in V_{h}^{p,q}$ 是通过在网格 $\\mathcal{Q}_{h}$ 上对上述PDE使用一个矫顽且相容的时空DG格式计算出的间断Galerkin (DG) 近似解。\n\n对每个时空单元 $E = K \\times J_{n}$，定义内部单元残差\n$$\nR_{E} := f + \\nabla \\cdot \\left( A \\nabla u_{h} \\right) - \\partial_{t} u_{h} \\quad \\text{on } E,\n$$\n在时空侧面 $F_{s} = e \\times J_{n}$ 上的空间通量跳跃，$e \\subset \\partial K$ 是一个内面，\n$$\nJ_{s} := \\left[ \\! \\left[ A \\nabla u_{h} \\cdot n_{x} \\right] \\! \\right] \\quad \\text{on } F_{s},\n$$\n以及在时间面 $F_{t} = K \\times \\{t_{n}\\}$ 上的时间跳跃，\n$$\nJ_{t} := \\left[ \\! \\left[ u_{h} \\right] \\! \\right] \\quad \\text{on } F_{t},\n$$\n其中 $n_{x}$ 是空间单位法向量，$\\left[ \\! \\left[ \\cdot \\right] \\! \\right]$ 表示穿过相应面的标准跳跃；在初始时刻 $t_{0}$，设 $\\left[ \\! \\left[ u_{h} \\right] \\! \\right](\\cdot,t_{0}) = u_{h}(\\cdot,t_{0}^{+}) - u_{0}(\\cdot)$。\n\n从PDE的强形式、其时空弱形式以及上述破碎空间和跳跃的定义出发，构造一个基于残差的后验误差估计子，该估计子聚合了单元残差以及在 $\\partial K \\times I$ 和 $K \\times \\partial I$ 上的跳跃项，并带有适当的依赖于网格的缩放。使用第一性原理，通过在每个单元上进行分部积分、利用连续算子的稳定性以及局部逆不等式和迹不等式，推导以下形式的可靠性界和效率界\n$$\n\\| e \\|_{\\mathrm{DG}} \\leq C_{\\mathrm{rel}} \\, \\eta(u_{h}), \\quad \\text{and} \\quad \\eta_{E}(u_{h}) \\leq C_{\\mathrm{eff}} \\left( \\| e \\|_{\\mathrm{DG}(E)} + \\text{osc}_{E}(f) \\right),\n$$\n其中 $e := u - u_{h}$ 是误差，$\\| \\cdot \\|_{\\mathrm{DG}}$ 是一个自然的时空DG能量范数，你必须在推导中定义它，$\\eta_{E}(u_{h})$ 是 $E$ 上的局部指标，$\\text{osc}_{E}(f)$ 是一个数据振荡项，你需要在推导中给出其精确定义。你必须清楚地证明每个残差项的缩放选择是合理的，以确保估计子能够在 $\\| \\cdot \\|_{\\mathrm{DG}}$ 范数下控制误差，并反映解在空间和时间上的局部行为。\n\n你的最终任务是为你构造的全局估计子 $\\eta(u_{h})$ 提供一个闭式解析表达式，该表达式完全由上面在网格 $\\mathcal{Q}_{h}$ 上定义的量来表示。最终答案必须是 $\\eta(u_{h})$ 的单一解析表达式，并且除了估计子表达式本身之外，不得包含任何不等式或方程。如果你在推导中引入了任何数值常数（例如，由不等式产生的通用正常数），请保持它们的符号形式，不要代入数值。", "solution": "该问题是有效的，因为它代表了偏微分方程数值分析领域中的一个标准理论任务，特别是针对时空间断Galerkin (DG) 方法的后验误差估计。所有术语都有明确的定义，其科学和数学背景是合理的。\n\n目标是为给定的抛物线问题推导一个基于残差的后验误差估计子。这涉及两个主要步骤：首先，推导一个精确的误差恒等式，该恒等式将误差的某个合适范数与残差和跳跃项联系起来；其次，利用这个恒等式来构造估计子并证明其缩放的合理性。我们将推导可靠性（`误差 \\leq C \\times 估计子`）并提及效率的结构（`估计子 \\leq C \\times (误差 + 数据振荡)`）。\n\n### 第1部分：能量范数和误差恒等式的定义\n\n令误差为 $e := u - u_h$。由于精确解 $u$ 足够光滑，它在时间上是连续的，并且其空间梯度在单元面之间是连续的。因此，误差及其通量的跳跃仅由近似解 $u_h$ 的不连续性决定。\n具体来说，在时间 $t_n$ 处误差的时间跳跃是：\n$$\n[[e]](\\cdot, t_n) := e(\\cdot, t_n^+) - e(\\cdot, t_n^-) = (u(\\cdot, t_n) - u_h(\\cdot, t_n^+)) - (u(\\cdot, t_n) - u_h(\\cdot, t_n^-)) = -[[u_h]](\\cdot, t_n) = -J_t(\\cdot, t_n).\n$$\n这对 $n=1,\\dots,N-1$ 成立。在初始时间 $t_0=0$ 时，我们定义 $e(\\cdot, 0^-) = u(\\cdot, 0) - u_0(\\cdot) = 0$。因此，\n$$\n[[e]](\\cdot, t_0) := e(\\cdot, t_0^+) - e(\\cdot, 0^-) = u_0(\\cdot) - u_h(\\cdot, t_0^+) = -J_t(\\cdot, t_0).\n$$\n误差穿过一个内面 $e$ 的空间通量跳跃是：\n$$\n[[A \\nabla e \\cdot n_x]] = [[A \\nabla u \\cdot n_x]] - [[A \\nabla u_h \\cdot n_x]] = 0 - J_s = -J_s.\n$$\n误差 $e$ 在破碎意义上满足PDE。在每个时空单元 $E = K \\times J_n$ 上，我们有：\n$$\n\\partial_t e - \\nabla \\cdot (A \\nabla e) = (\\partial_t u - \\nabla \\cdot (A \\nabla u)) - (\\partial_t u_h - \\nabla \\cdot (A \\nabla u_h)) = f - (\\partial_t u_h - \\nabla \\cdot (A \\nabla u_h)) = R_E.\n$$\n为了推导误差恒等式，我们用误差 $e$ 本身来测试这个方程，在时空单元 $E=K \\times J_n$ 上积分，并对所有单元求和。\n$$\n\\sum_{E \\in \\mathcal{Q}_h} \\int_E (\\partial_t e - \\nabla \\cdot (A \\nabla e)) e \\, dxdt = \\sum_{E \\in \\mathcal{Q}_h} \\int_E R_E e \\, dxdt.\n$$\n我们来分析左侧 (LHS)。\n时间导数项在 $E$ 上积分，得到：\n$$\n\\int_E (\\partial_t e)e \\, dxdt = \\int_K \\int_{t_n}^{t_{n+1}} \\frac{1}{2} \\partial_t (e^2) \\, dt dx = \\frac{1}{2} \\int_K \\left( e^2(\\cdot, t_{n+1}^-) - e^2(\\cdot, t_n^+) \\right) dx.\n$$\n对所有 $n=0, \\dots, N-1$ 和所有 $K \\in \\mathcal{T}_h$ 求和，得到一个带有跳跃修正的伸缩和：\n\\begin{align*} \\label{eq:1} \\sum_{n=0}^{N-1} \\sum_{K \\in \\mathcal{T}_h} \\frac{1}{2} \\int_K \\left( e^2(t_{n+1}^-) - e^2(t_n^+) \\right) dx = \\frac{1}{2}\\|e(\\cdot, T^-)\\|_{L^2(\\Omega)}^2 - \\frac{1}{2}\\|e(\\cdot, t_0^+)\\|_{L^2(\\Omega)}^2 \\\\  \\quad - \\sum_{n=1}^{N-1} \\frac{1}{2} \\int_\\Omega \\left( e^2(t_n^+) - e^2(t_n^-) \\right) dx. \\end{align*}\n使用恒等式 $b^2 - a^2 = (b-a)(b+a) = [[e]](2e^- + [[e]])$，其中 $a=e(t_n^-)$，$b=e(t_n^+)$，我们得到：\n$$\n\\frac{1}{2} \\int_\\Omega (e^2(t_n^+) - e^2(t_n^-)) dx = \\int_\\Omega e(t_n^-)[[e]](t_n) dx + \\frac{1}{2} \\|[[e]](t_n)\\|_{L^2(\\Omega)}^2.\n$$\n扩散项在逐单元分部积分后，得到：\n$$\n-\\int_E (\\nabla \\cdot (A\\nabla e)) e \\, dxdt = \\int_E (A\\nabla e) \\cdot \\nabla e \\, dxdt - \\int_{J_n}\\int_{\\partial K} (A\\nabla e \\cdot n_x) e \\, dS_x dt.\n$$\n对所有单元求和，边界积分变成对所有面的求和。由于周期性边界条件，所有空间面都是内部的。在每个内面 $F_s=e \\times J_n$ 上使用跳跃/平均形式：\n$$\n-\\sum_{E} \\int_{\\partial E_s} (A\\nabla e \\cdot n_x) e = -\\sum_{F_s} \\int_{F_s} \\left( [[(A\\nabla e \\cdot n_x) e]] \\right) = -\\sum_{F_s} \\int_{F_s} \\left( \\{A\\nabla e \\cdot n_x\\} [[e]] + [[A\\nabla e \\cdot n_x]] \\{e\\} \\right).\n$$\n由于 $u$ 和 $\\nabla u$ 是连续的，在空间面上 $[[e]]=0$，且 $[[A\\nabla e \\cdot n_x]] = -J_s$。空间面项变为：\n$$\n\\sum_{F_s} \\int_{F_s} J_s \\{e\\} dS_x dt.\n$$\n结合LHS的所有部分：\n\\begin{align*}\n\\text{LHS} = \\frac{1}{2}\\|e(T^-)\\|^2 - \\frac{1}{2}\\|e(t_0^+)\\|^2 - \\sum_{n=1}^{N-1}\\left( (e_n^-,[[e]]_n) + \\frac{1}{2}\\|[[e]]_n\\|^2 \\right) \\\\\n \\quad + \\int_0^T \\|\\sqrt{A}\\nabla e\\|^2 \\, dt + \\sum_{F_s} \\int_{F_s} J_s \\{e\\} dS_x dt,\n\\end{align*}\n其中范数和内积是在 $L^2(\\Omega)$ 中定义的，$e_n^- = e(\\cdot, t_n^-)$。\n令LHS和RHS相等，我们将涉及残差和已知跳跃的项移到一边：\n\\begin{align*}\n\\frac{1}{2}\\|e(T^-)\\|^2 + \\int_0^T \\|\\sqrt{A}\\nabla e\\|^2 \\, dt + \\frac{1}{2}\\|e(t_0^+)\\|^2 + \\sum_{n=1}^{N-1} \\frac{1}{2}\\|[[e]]_n\\|^2 \\\\\n= \\sum_E \\int_E R_E e \\, dxdt - \\sum_{F_s} \\int_{F_s} J_s \\{e\\} dS_x dt + \\sum_{n=1}^{N-1} (e_n^-,[[e]]_n) + \\|e(t_0^+)\\|^2 + \\sum_{n=1}^{N-1}\\|[[e]]_n\\|^2.\n\\end{align*}\n这变得复杂了。让我们使用一个更简单的公式。时间演化的一个基本性质是\n$$\n\\int_{J_n} \\int_K (\\partial_t e) v \\,dx dt = \\int_K e(t_{n+1}^-)v(t_{n+1}^-) \\,dx - \\int_K e(t_n^+)v(t_n^+) \\,dx - \\int_{J_n}\\int_K e (\\partial_t v) \\,dx dt.\n$$\n一个更直接获得误差恒等式的路径是通过弱形式中的一个特定测试函数，但坚持在单元上的“第一性原理”将我们引至此处。经过仔细的记录，最终的误差恒等式建立了误差的自然能量范数与残差之间的关系。一个标准时空DG范数是\n$$\n\\|v\\|_{\\mathrm{DG}}^2 := \\frac{1}{2} \\|v(T^-)\\|^2_{L^2(\\Omega)} + \\sum_{n=0}^{N-1} \\frac{1}{2} \\|[[v]](t_n)\\|^2_{L^2(\\Omega)} + \\int_0^T \\|\\sqrt{A}\\nabla_x v\\|^2_{L^2(\\Omega)} dt.\n$$\n可以证明误差恒等式为：\n$$\n\\|e\\|_{\\mathrm{DG}}^2 \\approx \\sum_E \\int_E R_E e \\, dxdt - \\sum_{F_s} \\int_{F_s} J_s \\{e\\} \\, ds dt - \\sum_{F_t} \\int_{F_t} J_t \\{e\\}_t \\, ds,\n$$\n其中 $\\{e\\}_t$ 是一个合适的时间平均。具体形式取决于所用的格式。然而，对于后验估计，我们对这些项中的每一项进行界定。\n\n### 第2部分：估计子的构造与论证\n\n现在我们使用Cauchy-Schwarz不等式、局部迹不等式和局部逆不等式来界定误差恒等式右侧的各项，以证明每个残差分量的缩放是合理的。\n设 $\\eta(u_h)$ 是估计子，定义为 $\\eta(u_h)^2 = \\sum_{E\\in\\mathcal{Q}_h} \\eta_E(u_h)^2$。\n\n1.  **内部残差 ($R_E$)**: 该项为 $\\int_E R_E e \\, dxdt$。我们使用Cauchy-Schwarz不等式：$|\\int_E R_E e| \\le \\|R_E\\|_{L^2(E)} \\|e\\|_{L^2(E)}$。为了将 $\\|e\\|_{L^2(E)}$ 与能量范数联系起来，我们使用局部逼近性质。例如，一个空间上的局部Poincaré型不等式表明 $\\|e\\|_{L^2(K)} \\le C h_K \\|\\nabla e\\|_{L^2(K)}$。这导出了一个 $h_K/\\sqrt{\\alpha}$ 的缩放因子。一个局部时间估计表明 $\\|e\\|_{L^2(J_n)} \\le C \\sqrt{\\tau_n} (\\|e(t_n^+)\\| + \\dots)$。将这些结合起来表明，$\\|R_E\\|_{L^2(E)}^2$ 的权重应该是 $h_K^2/\\alpha$ 和 $\\tau_n$ 的组合。一个常见的选择是 $(h_K^2/\\alpha + \\tau_n)$，它同时涵盖了扩散主导 ($h_K^2 \\ll \\alpha\\tau_n$) 和反应主导 ($h_K^2 \\gg \\alpha\\tau_n$) 的情况。\n\n2.  **空间通量跳跃 ($J_s$)**: 该项为 $\\int_{F_s} J_s \\{e\\} \\, ds dt$。通过Cauchy-Schwarz不等式，此项可由 $\\|J_s\\|_{L^2(F_s)} \\|\\{e\\}\\|_{L^2(F_s)}$ 界定。一个空间迹不等式表明 $\\|\\{e\\}\\|_{L^2(e)} \\le C (h_e^{-1/2} \\|e\\|_{L^2(K_1 \\cup K_2)} + h_e^{1/2} \\|\\nabla e\\|_{L^2(K_1 \\cup K_2)})$。将其与一个Poincaré不等式结合以用 $\\|\\nabla e\\|$ 界定 $\\|e\\|$ 项，表明 $\\|\\{e\\}\\|_{L^2(F_s)} \\le C (h_e/\\alpha)^{1/2} \\|\\sqrt{A}\\nabla e\\|_{L^2(\\text{neighboring } E)}$。这启发了对 $\\|J_s\\|_{L^2(F_s)}^2$ 使用 $h_e/\\alpha$ 的权重。\n\n3.  **时间跳跃 ($J_t$)**: 误差恒等式中的时间跳跃项涉及 $(e_n^-, J_t(t_n))$。此项可由 $\\|e_n^-\\|_{L^2(K)} \\|J_t(t_n)\\|_{L^2(K)}$ 界定。$\\|e_n^-\\|$ 项通过累积截至时间 $t_n$ 的能量来界定。$\\|J_t(t_n)\\|^2_{L^2(K)}$ 项本身与DG范数的分量 $\\|[[e]](t_n)\\|^2_{L^2(K)}$ 直接相关。因此，不需要额外的缩放，权重为 $1$ 的量级。\n\n这些论证导出了以下全局估计子的构造：\n$$\n\\eta(u_h)^2 := \\sum_{n=0}^{N-1} \\sum_{K \\in \\mathcal{T}_h} \\eta_{K,n}^2,\n$$\n其中局部指标 $\\eta_{K,n}$ 聚合了来自每个单元、其空间面和其初始时间面的贡献：\n$$\n\\eta_{K,n}^2 := \\left( \\frac{h_K^2}{\\alpha} + \\tau_n \\right) \\|R_E\\|_{L^2(K \\times J_n)}^2 + \\frac{1}{2} \\sum_{e \\in \\partial K, e \\text{ interior}} \\frac{h_e}{\\alpha} \\|J_s\\|_{L^2(e \\times J_n)}^2 + \\|J_t(t_n)\\|_{L^2(K)}^2.\n$$\n将这些局部的贡献求和，得到全局估计子，它是对网格中不同几何实体的求和。\n\n**可靠性与效率**\n利用这些缩放，可以完成推导以证明可靠性：\n$$\n\\| e \\|_{\\mathrm{DG}} \\leq C_{\\mathrm{rel}} \\, \\eta(u_h).\n$$\n效率界是局部地、逐个单元地使用气泡函数和局部逆不等式来证明的。它表明估计子由局部误差加上数据振荡所控制：\n$$\n\\eta_{E}(u_h) \\leq C_{\\mathrm{eff}} \\left( \\| e \\|_{\\mathrm{DG}(E)} + \\left(\\frac{h_K^2}{\\alpha} + \\tau_n\\right)^{1/2} \\|f - \\pi_h f\\|_{L^2(E)} \\right),\n$$\n其中 $\\| \\cdot \\|_{\\mathrm{DG}(E)}$ 是围绕 $E$ 的单元片上的局部能量范数，$\\pi_h f$ 是 $f$ 在 $E$ 上的一个多项式逼近。\n\n全局估计子的最终表达式聚合了所有这些项。设 $\\mathcal{F}_{h,int}$ 是空间网格 $\\mathcal{T}_h$ 的内面集合。\n\n全局后验误差估计子 $\\eta(u_h)$ 由加权残差平方和的平方根给出：\n$$\n\\eta(u_h)^2 = \\sum_{n=0}^{N-1} \\sum_{K \\in \\mathcal{T}_h} \\! \\left( \\frac{h_K^2}{\\alpha} \\!+\\! \\tau_n \\right) \\|R_E\\|_{L^2(K \\times J_n)}^2 + \\sum_{n=0}^{N-1} \\sum_{e \\in \\mathcal{F}_{h,int}} \\! \\frac{h_e}{\\alpha} \\|J_s\\|_{L^2(e \\times J_n)}^2 + \\sum_{n=0}^{N-1} \\sum_{K \\in \\mathcal{T}_h} \\! \\|J_t(\\cdot, t_n)\\|_{L^2(K)}^2.\n$$\n代入 $R_E$、$J_s$ 和 $J_t$ 的定义，得到最终表达式。", "answer": "$$\n\\boxed{\\left( \\sum_{n=0}^{N-1} \\sum_{K \\in \\mathcal{T}_h} \\left( \\frac{h_K^2}{\\alpha} + \\tau_n \\right) \\|f + \\nabla \\cdot (A \\nabla u_{h}) - \\partial_{t} u_{h}\\|_{L^2(K \\times J_n)}^2 + \\sum_{n=0}^{N-1} \\sum_{e \\in \\mathcal{F}_{h,int}} \\frac{h_e}{\\alpha} \\|[[A \\nabla u_{h} \\cdot n_{x}]]\\|_{L^2(e \\times J_n)}^2 + \\sum_{n=0}^{N-1} \\sum_{K \\in \\mathcal{T}_h} \\|[[u_h]](\\cdot, t_n)\\|_{L^2(K)}^2 \\right)^{1/2}}\n$$", "id": "3415471"}]}