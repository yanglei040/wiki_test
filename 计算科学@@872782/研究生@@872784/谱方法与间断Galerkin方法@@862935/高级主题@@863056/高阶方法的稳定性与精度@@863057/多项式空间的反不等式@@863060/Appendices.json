{"hands_on_practices": [{"introduction": "我们从探索一个基本关系开始。本练习要求计算一个精确常数，该常数将勒让德多项式的连续加权导数范数与其通过高斯-洛巴托-勒让德(Gauss-Lobatto-Legendre)求积定义的离散范数联系起来。这项实践有助于巩固对连续分析和离散数值表示之间相互作用的理解，这是谱方法和间断伽辽金方法(DG methods)的基石。", "problem": "考虑参考单元 $[-1,1]$ 和次数至多为 $N$ 的多项式空间，记为 $\\mathbb{P}_{N}$。设 $P_{N}(x)$ 为 $N$ 次勒让德多项式，其归一化满足 $\\displaystyle \\int_{-1}^{1} P_{N}(x)^{2}\\,\\mathrm{d}x = \\frac{2}{2N+1}$。定义具有 $N+1$ 个点 $\\{x_{i}\\}_{i=1}^{N+1}$ 的 Gauss–Lobatto–Legendre 求积，这些点由端点 $x_{1}=-1$ 和 $x_{N+1}=1$ 以及作为 $P_{N}'(x)$ 的 $N-1$ 个不同根的内点组成。相应的求积权重 $\\{w_{i}\\}_{i=1}^{N+1}$ 由以下著名公式给出：\n$$\nw_{1}=w_{N+1}=\\frac{2}{N(N+1)},\\qquad w_{i}=\\frac{2}{N(N+1)\\left[P_{N}(x_{i})\\right]^{2}},\\quad i=2,\\dots,N.\n$$\n这些权重是在 spectral element 和 discontinuous Galerkin 方法中用于通过求积定义离散 $L^{2}$ 范数的权重。考虑由 $[-1,1]$ 上的勒让德算子导出的加权 $H^{1}$ 半范数，对于可微函数 $p$ 定义为 $\\displaystyle \\int_{-1}^{1} \\left(1-x^{2}\\right) \\left[p'(x)\\right]^{2}\\,\\mathrm{d}x$。在多项式空间的逆不等式背景下，人们通常关心用离散 $L^{2}$ 范数 $\\displaystyle \\sum_{i=1}^{N+1} w_{i}\\, [p(x_{i})]^{2}$ 来界定此半范数。\n\n您的任务是确定精确常数 $C_{N}$，使得对于特定选择 $p(x)=P_{N}(x)$，以下恒等式成立：\n$$\n\\int_{-1}^{1} \\left(1-x^{2}\\right) \\left[P_{N}'(x)\\right]^{2}\\,\\mathrm{d}x \\;=\\; C_{N} \\sum_{i=1}^{N+1} w_{i}\\, \\left[P_{N}(x_{i})\\right]^{2}.\n$$\n您的答案必须是关于 $N$ 的单个闭式解析表达式 $C_{N}$。最终答案不允许包含不等式或方程。无需四舍五入。", "solution": "问题是根据以下恒等式确定常数 $C_{N}$，该恒等式指定对多项式选择 $p(x) = P_{N}(x)$ 成立：\n$$\n\\int_{-1}^{1} \\left(1-x^{2}\\right) \\left[P_{N}'(x)\\right]^{2}\\,\\mathrm{d}x \\;=\\; C_{N} \\sum_{i=1}^{N+1} w_{i}\\, \\left[P_{N}(x_{i})\\right]^{2}\n$$\n为求得 $C_{N}$，我们将分别计算该方程的左侧（LHS）和右侧（RHS）。\n\n我们首先分析右侧（RHS），即离散求和项：\n$$\n\\text{RHS} = \\sum_{i=1}^{N+1} w_{i}\\, \\left[P_{N}(x_{i})\\right]^{2}\n$$\n该求和可以分为来自端点（$i=1$ 和 $i=N+1$）和内点（$i=2, \\dots, N$）的贡献。\n\nGauss–Lobatto–Legendre (GLL) 网格的端点是 $x_{1}=-1$ 和 $x_{N+1}=1$。相应的求积权重为 $w_{1} = w_{N+1} = \\frac{2}{N(N+1)}$。\n勒让德多项式 $P_{N}(x)$，在标准归一化 $\\int_{-1}^{1} [P_{N}(x)]^2\\,\\mathrm{d}x = \\frac{2}{2N+1}$ 下，满足 $P_{N}(1)=1$ 和 $P_{N}(-1)=(-1)^{N}$。\n因此，来自端点的贡献总和为：\n$$\nw_{1} [P_{N}(x_{1})]^{2} + w_{N+1} [P_{N}(x_{N+1})]^{2} = \\frac{2}{N(N+1)} [P_{N}(-1)]^{2} + \\frac{2}{N(N+1)} [P_{N}(1)]^{2}\n$$\n$$\n= \\frac{2}{N(N+1)} [(-1)^{N}]^{2} + \\frac{2}{N(N+1)} [1]^{2} = \\frac{2}{N(N+1)} (1+1) = \\frac{4}{N(N+1)}\n$$\n\n内部 GLL 点 $\\{x_{i}\\}_{i=2}^{N}$ 是勒让德多项式导数 $P_{N}'(x)$ 的 $N-1$ 个不同的根。相应的求积权重由公式 $w_{i} = \\frac{2}{N(N+1)[P_{N}(x_{i})]^{2}}$ 给出（$i=2, \\dots, N$）。\n来自内点的贡献总和为：\n$$\n\\sum_{i=2}^{N} w_{i} [P_{N}(x_{i})]^{2} = \\sum_{i=2}^{N} \\left(\\frac{2}{N(N+1)[P_{N}(x_{i})]^{2}}\\right) [P_{N}(x_{i})]^{2} = \\sum_{i=2}^{N} \\frac{2}{N(N+1)}\n$$\n因为有 $N-1$ 个内点（从 $i=2$ 到 $i=N$），这个和的计算结果为：\n$$\n(N-1) \\times \\frac{2}{N(N+1)} = \\frac{2(N-1)}{N(N+1)}\n$$\n\n结合端点和内点的贡献，RHS 的总值为：\n$$\n\\text{RHS} = \\frac{4}{N(N+1)} + \\frac{2(N-1)}{N(N+1)} = \\frac{4 + 2N - 2}{N(N+1)} = \\frac{2N+2}{N(N+1)} = \\frac{2(N+1)}{N(N+1)} = \\frac{2}{N}\n$$\n\n接下来，我们计算 LHS，即积分项：\n$$\n\\text{LHS} = \\int_{-1}^{1} (1-x^{2}) [P_{N}'(x)]^{2}\\,\\mathrm{d}x\n$$\n这个积分可以用分部积分法求解。令 $u = (1-x^{2})P_{N}'(x)$ 且 $\\mathrm{d}v = P_{N}'(x)\\,\\mathrm{d}x$。则 $\\mathrm{d}u = \\frac{\\mathrm{d}}{\\mathrm{d}x}\\left[(1-x^{2})P_{N}'(x)\\right]\\,\\mathrm{d}x$ 且 $v = P_{N}(x)$。\n$$\n\\text{LHS} = \\left[ (1-x^{2})P_{N}'(x)P_{N}(x) \\right]_{-1}^{1} - \\int_{-1}^{1} P_{N}(x) \\frac{\\mathrm{d}}{\\mathrm{d}x}\\left[(1-x^{2})P_{N}'(x)\\right]\\,\\mathrm{d}x\n$$\n边界项为零，因为因子 $(1-x^{2})$ 在 $x=1$ 和 $x=-1$ 处为零。\n所以，我们剩下：\n$$\n\\text{LHS} = - \\int_{-1}^{1} P_{N}(x) \\frac{\\mathrm{d}}{\\mathrm{d}x}\\left[(1-x^{2})P_{N}'(x)\\right]\\,\\mathrm{d}x\n$$\n勒让德多项式是勒让德微分方程的解：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}x}\\left[(1-x^{2})\\frac{\\mathrm{d}y}{\\mathrm{d}x}\\right] + n(n+1)y = 0\n$$\n对于 $y=P_{N}(x)$，这变成：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}x}\\left[(1-x^{2})P_{N}'(x)\\right] = -N(N+1)P_{N}(x)\n$$\n将此代入我们 LHS 的表达式中：\n$$\n\\text{LHS} = - \\int_{-1}^{1} P_{N}(x) \\left[-N(N+1)P_{N}(x)\\right]\\,\\mathrm{d}x = N(N+1) \\int_{-1}^{1} [P_{N}(x)]^{2}\\,\\mathrm{d}x\n$$\n使用给定的勒让德多项式归一化条件 $\\int_{-1}^{1} [P_{N}(x)]^{2}\\,\\mathrm{d}x = \\frac{2}{2N+1}$，我们得到：\n$$\n\\text{LHS} = N(N+1) \\left(\\frac{2}{2N+1}\\right) = \\frac{2N(N+1)}{2N+1}\n$$\n\n最后，我们将 LHS 和 RHS 的表达式相等，以解出 $C_{N}$：\n$$\n\\text{LHS} = C_{N} \\times \\text{RHS}\n$$\n$$\n\\frac{2N(N+1)}{2N+1} = C_{N} \\times \\frac{2}{N}\n$$\n解出 $C_{N}$ 得：\n$$\nC_{N} = \\frac{2N(N+1)}{2N+1} \\times \\frac{N}{2} = \\frac{N^{2}(N+1)}{2N+1}\n$$\n这就是给定恒等式的精确常数。", "answer": "$$\n\\boxed{\\frac{N^{2}(N+1)}{2N+1}}\n$$", "id": "3392878"}, {"introduction": "基于参考单元上多项式的性质，本练习将研究反向不等式如何随单元尺寸 $h$ 和多项式次数 $p$ 缩放。您将运用此缩放分析来评估后处理算子的稳定性，这是一种提高解精度的常用技术。本练习展示了反向不等式在确定数值参数以确保计算稳定性方面所起的关键作用。", "problem": "考虑一个长度为 $h$ 的一维网格单元 $K$，它支撑一个次数至多为 $p$ 的多项式有限维空间 $\\mathbb{P}_{p}(K)$，这在谱方法和间断Galerkin (DG) 方法中很常用。令 $v_{h} \\in \\mathbb{P}_{p}(K)$ 为 $K$ 上的一个多项式场。采用一个基于 $k$ 阶导数的局部后处理算子，记为 $\\mathcal{P}_{k}$，通过使用直到 $k$ 阶导数的多项式重构来抵消主阶误差项，从而提高 $v_{h}$ 的最大范数（即 $L^{\\infty}$-范数）精度。这种重构的 $L^{\\infty}$ 改进是关于 $k$ 单调的，较大的 $k$ 会导致 $L^{\\infty}$-误差的更显著减小。\n\n从参考单元 $[-1,1]$ 到 $K$ 的仿射映射、该映射下导数的缩放以及 $\\mathbb{P}_{p}([-1,1])$ 的范数等价性质出发，推导一个反不等式，其形式为将 $\\|D^{k} v_{h}\\|_{L^{2}(K)}$ 的上界表示为一个常数乘以 $p$ 和 $h$ 的幂再乘以 $\\|v_{h}\\|_{L^{2}(K)}$。使用这个反不等式来证明后处理器的稳定性放大可以被一个形如 $\\alpha \\, C_{\\mathrm{inv}} \\, p^{2k} \\, h^{-k}$ 的表达式作为上界，其中常数 $C_{\\mathrm{inv}}$ 仅依赖于参考范数的选择和多项式基，而不依赖于 $h$ 或 $p$。假设 $L^{\\infty}$ 改进随 $k$ 单调增长（因此更大的 $k$ 更优），但必须选择 $k$ 以使放大因子以1为界，并且 $k$ 必须满足 $0 \\le k \\le p$。\n\n给定数值 $p=8$，$h=20$，$\\alpha=0.25$ 和 $C_{\\mathrm{inv}}=0.125$，选择一个最大的整数 $k$，在不违反稳定性约束 $\\alpha \\, C_{\\mathrm{inv}} \\, p^{2k} \\, h^{-k} \\le 1$ 且满足 $k \\le p$ 的前提下，优化 $L^{\\infty}$ 改进。将所选的整数 $k$ 作为你的最终答案。", "solution": "问题要求我们首先推导一个反不等式，将多项式 $k$ 阶导数的 $L^2$-范数与多项式本身的 $L^2$-范数联系起来。随后，我们必须证明给定的稳定性放大界限形式的合理性，然后确定在稳定性约束下后处理算子的最优整数阶数 $k$。\n\n首先，我们推导反不等式。令 $\\hat{K} = [-1, 1]$ 为参考单元，$K$ 为长度为 $h$ 的物理单元。仿射映射 $F: \\hat{K} \\to K$ 可以写为 $x = x_c + \\frac{h}{2}\\hat{x}$，其中 $x_c$ 是单元 $K$ 的中心。该映射的雅可比是 $J = \\frac{dx}{d\\hat{x}} = \\frac{h}{2}$。\n\n令 $v_h \\in \\mathbb{P}_p(K)$ 为物理单元 $K$ 上的一个次数至多为 $p$ 的多项式。我们可以通过复合 $\\hat{v}(\\hat{x}) = v_h(x(\\hat{x}))$ 在参考单元上定义一个对应的多项式 $\\hat{v} \\in \\mathbb{P}_p(\\hat{K})$。使用微分链式法则，我们关联 $K$ 和 $\\hat{K}$ 上的导数：\n$$ \\frac{dv_h}{dx} = \\frac{d\\hat{v}}{d\\hat{x}} \\frac{d\\hat{x}}{dx} = \\frac{d\\hat{v}}{d\\hat{x}} \\left(\\frac{dx}{d\\hat{x}}\\right)^{-1} = \\frac{2}{h} \\frac{d\\hat{v}}{d\\hat{x}} $$\n通过重复应用此法则，物理单元上的 $k$ 阶导数与参考单元上的 $k$ 阶导数的关系为：\n$$ D^k v_h \\equiv \\frac{d^k v_h}{dx^k} = \\left(\\frac{2}{h}\\right)^k \\frac{d^k \\hat{v}}{d\\hat{x}^k} \\equiv \\left(\\frac{2}{h}\\right)^k D^k \\hat{v} $$\n接下来，我们关联两个单元上的 $L^2$-范数。单元 $I$ 上函数 $w$ 的 $L^2$-范数定义为 $\\|w\\|_{L^2(I)} = \\left(\\int_I |w|^2 dx\\right)^{1/2}$。对于函数 $v_h$，我们进行变量替换 $x \\to \\hat{x}$，其微分元变换为 $dx = J d\\hat{x} = \\frac{h}{2} d\\hat{x}$：\n$$ \\|v_h\\|_{L^2(K)}^2 = \\int_K |v_h(x)|^2 dx = \\int_{-1}^1 |\\hat{v}(\\hat{x})|^2 \\frac{h}{2} d\\hat{x} = \\frac{h}{2} \\|\\hat{v}\\|_{L^2(\\hat{K})}^2 $$\n这给出了关系 $\\|\\hat{v}\\|_{L^2(\\hat{K})}^2 = \\frac{2}{h} \\|v_h\\|_{L^2(K)}^2$。\n\n我们将相同的变换应用于 $k$ 阶导数的范数：\n$$ \\|D^k v_h\\|_{L^2(K)}^2 = \\int_K |D^k v_h(x)|^2 dx = \\int_{-1}^1 \\left|\\left(\\frac{2}{h}\\right)^k D^k \\hat{v}(\\hat{x})\\right|^2 \\frac{h}{2} d\\hat{x} = \\left(\\frac{2}{h}\\right)^{2k} \\frac{h}{2} \\|D^k \\hat{v}\\|_{L^2(\\hat{K})}^2 $$\n参考单元上多项式 $\\hat{v} \\in \\mathbb{P}_p(\\hat{K})$ 的一个标准反不等式表明，存在一个与 $p$ 无关的常数 $\\hat{C}_k$，使得：\n$$ \\|D^k \\hat{v}\\|_{L^2(\\hat{K})} \\le \\hat{C}_k p^{2k} \\|\\hat{v}\\|_{L^2(\\hat{K})} $$\n对于大的多项式次数，$p^{2k}$ 的缩放是一个已知的精确估计。将此不等式代入我们关于 $\\|D^k v_h\\|_{L^2(K)}^2$ 的表达式中：\n$$ \\|D^k v_h\\|_{L^2(K)}^2 \\le \\left(\\frac{2}{h}\\right)^{2k} \\frac{h}{2} \\left( \\hat{C}_k p^{2k} \\|\\hat{v}\\|_{L^2(\\hat{K})} \\right)^2 = \\left(\\frac{2}{h}\\right)^{2k} \\frac{h}{2} \\hat{C}_k^2 p^{4k} \\|\\hat{v}\\|_{L^2(\\hat{K})}^2 $$\n现在我们将 $\\|\\hat{v}\\|_{L^2(\\hat{K})}^2 = \\frac{2}{h} \\|v_h\\|_{L^2(K)}^2$ 代入右侧：\n$$ \\|D^k v_h\\|_{L^2(K)}^2 \\le \\left(\\frac{2^{2k}}{h^{2k}}\\right) \\frac{h}{2} \\hat{C}_k^2 p^{4k} \\left(\\frac{2}{h} \\|v_h\\|_{L^2(K)}^2\\right) = \\hat{C}_k^2 \\frac{2^{2k}}{h^{2k}} p^{4k} \\|v_h\\|_{L^2(K)}^2 $$\n对两边取平方根，我们得到反不等式的最终形式：\n$$ \\|D^k v_h\\|_{L^2(K)} \\le \\left(\\hat{C}_k 2^k\\right) p^{2k} h^{-k} \\|v_h\\|_{L^2(K)} $$\n该表达式将 $k$ 阶导数的范数限定为一个常数乘以 $p$ 和 $h$ 的幂以及函数本身范数的积，如题所求。\n\n问题陈述，后处理器 $\\mathcal{P}_k$ 的稳定性放大由形如 $\\alpha \\, C_{\\mathrm{inv}} \\, p^{2k} \\, h^{-k}$ 的表达式作为上界。后处理器 $\\mathcal{P}_k$ 使用直到 $k$ 阶的导数。此类算子的稳定性与输入函数范数的放大有着根本的联系。由于该算子涉及导数，其稳定性性质必须依赖于这些导数的范数。推导出的反不等式表明，$k$ 阶导数的相对大小，即比率 $\\|D^k v_h\\|_{L^2(K)}/\\|v_h\\|_{L^2(K)}$，由一个与 $p^{2k}h^{-k}$ 成正比的项作为上界。因此，一个涉及 $D^k$ 的算子的稳定性放大度量受此界限控制是完全合理的。常数 $\\alpha$ 和 $C_{\\mathrm{inv}}$ 包含了算子构造的细节以及来自底层不等式的常数。\n\n最后，我们必须找到能优化 $L^{\\infty}$-误差改进的最大整数 $k$，而已知该改进是关于 $k$ 单调的。这需要找到满足稳定性约束 $\\alpha \\, C_{\\mathrm{inv}} \\, p^{2k} \\, h^{-k} \\le 1$ 和问题空间约束 $0 \\le k \\le p$ 的最大整数 $k$。\n我们被给予数值 $p=8$，$h=20$，$\\alpha=0.25$ 和 $C_{\\mathrm{inv}}=0.125$。\n将这些值代入稳定性不等式，得到：\n$$ (0.25) \\cdot (0.125) \\cdot (8)^{2k} \\cdot (20)^{-k} \\le 1 $$\n我们可以将常数重写为分数：$\\alpha = \\frac{1}{4}$ 和 $C_{\\mathrm{inv}} = \\frac{1}{8}$。\n$$ \\frac{1}{4} \\cdot \\frac{1}{8} \\cdot (8^2)^k \\cdot \\frac{1}{20^k} \\le 1 $$\n$$ \\frac{1}{32} \\cdot \\left(\\frac{64}{20}\\right)^k \\le 1 $$\n化简幂的底数：\n$$ \\left(\\frac{64}{20}\\right)^k = \\left(\\frac{16}{5}\\right)^k = (3.2)^k $$\n因此不等式变为：\n$$ (3.2)^k \\le 32 $$\n我们必须找到满足此不等式且受 $k \\le p=8$ 约束的最大整数 $k$。我们可以测试 $k$ 的整数值：\n当 $k=0$ 时：$(3.2)^0 = 1 \\le 32$。条件满足。\n当 $k=1$ 时：$(3.2)^1 = 3.2 \\le 32$。条件满足。\n当 $k=2$ 时：$(3.2)^2 = 10.24 \\le 32$。条件满足。\n当 $k=3$ 时：$(3.2)^3 = 10.24 \\times 3.2 = 32.768$。由于 $32.768 > 32$，条件不满足。\n由于当 $k0$ 时，$(3.2)^k$ 是一个严格递增函数，任何整数 $k \\ge 3$ 也将不满足该不等式。\n满足稳定性约束的最大整数 $k$ 是 $2$。这也满足 $k \\le 8$。因为较大的 $k$ 会带来更好的 $L^\\infty$ 改进，我们选择允许的最大整数值。\n因此，$k$ 的最优选择是 $2$。", "answer": "$$\\boxed{2}$$", "id": "3392877"}, {"introduction": "最后的这项练习在一个更复杂的设计背景下应用了反向常数的概念。您将首先确定一个特定的“高通”多项式子空间上的最优反向常数，然后利用这一洞察力设计一个受大涡模拟(Large Eddy Simulation)启发的谱滤波器。本练习突显了对多项式空间谱性质的深刻理解如何能够催生用于复杂模拟的先进数值工具。", "problem": "设 $I=[-1,1]$，并设 $\\mathbb{P}_p$ 表示 $I$ 上所有次数至多为 $p$ 的实多项式空间。为 $\\mathbb{P}_p$ 配备标准的 $L^2$ 内积 $(u,v)=\\int_{-1}^{1} u(x)\\,v(x)\\,dx$。设 $\\{P_k\\}_{k\\ge 0}$ 为 Legendre 多项式，其特征是在 $I$ 上的二阶 Sturm–Liouville 问题 $-\\frac{d}{dx}\\big((1-x^2)\\,P_k'(x)\\big)=k(k+1)\\,P_k(x)$ 的唯一多项式解，且对于每个非负整数 $k$ 满足 $P_k(1)=1$。已知它们在 $L^2(I)$ 中是相互正交的。\n\n定义高通子空间 $\\mathcal{H}_{p,m}=\\{v\\in\\mathbb{P}_p:\\,(v,q)=0\\text{ for all }q\\in\\mathbb{P}_m\\}$，其中 $m$ 是一个满足 $0\\le m  p$ 的整数。这个子空间包含了所有“高频”多项式，即那些与所有低次多项式正交的多项式。\n考虑两个双线性形式：$b(u,v)=(u,v)$ 和加权形式 $a(u,v)=\\int_{-1}^{1}(1-x^2)\\,u'(x)v'(x)\\,dx$。最优逆常数 $C_{p,m}$ 定义为 Rayleigh 商在 $\\mathcal{H}_{p,m}$ 上的最大值：\n$$\nC_{p,m} = \\sup_{v\\in\\mathcal{H}_{p,m}\\setminus\\{0\\}} \\frac{\\sqrt{a(v,v)}}{\\sqrt{b(v,v)}}\n$$\n此外，考虑一个由以下变分问题定义的线性滤波器 $\\mathcal{F}_\\kappa: \\mathbb{P}_p \\to \\mathbb{P}_p$：对于给定的 $v \\in \\mathbb{P}_p$，其滤波后的像 $u = \\mathcal{F}_\\kappa(v)$ 由下式给出：\n$$\nb(u,w) + \\kappa^{-2}a(u,w) = b(v,w) \\quad \\text{for all } w \\in \\mathbb{P}_p\n$$\n其中 $\\kappa>0$ 是一个可调参数。这个滤波器在 Legendre 基 $\\{P_k\\}_{k=0}^p$ 上是对角的，这意味着 $\\mathcal{F}_\\kappa(P_k) = g_k P_k$，其中 $g_k$ 是依赖于 $k$ 和 $\\kappa$ 的增益因子。\n\n您的任务是推导两个量：\n1. 最优逆常数 $C_{p,m}$，作为 $p$ 和 $m$ 的函数。\n2. 滤波器参数 $\\kappa$ 的值，该值应设置为使得最低高通模式 $P_{m+1}$ (即次数为 $m+1$ 的 Legendre 多项式) 的振幅增益 $g_{m+1}$ 恰好为 $1/2$。\n\n将您的答案表示为一个 $1 \\times 2$ 的矩阵，其中第一个元素是 $C_{p,m}$ 的表达式，第二个元素是 $\\kappa$ 的表达式。", "solution": "所述问题在数学上是适定的，其科学基础在于数值分析和正交多项式理论，并包含了唯一解所需的所有信息。因此，我们可以进行推导。\n\n问题分为两部分。首先，我们确定最优逆常数 $C_{p,m}$。其次，我们推导滤波器参数 $\\kappa$ 的表达式。\n\n第一部分：确定逆常数 $C_{p,m}$。\n\n常数 $C_{p,m}$ 定义为一个 Rayleigh 商的上确界：\n$$\nC_{p,m}^2 = \\sup_{v\\in\\mathcal{H}_{p,m}\\setminus\\{0\\}} \\frac{a(v,v)}{b(v,v)} = \\sup_{v\\in\\mathcal{H}_{p,m}\\setminus\\{0\\}} \\frac{\\int_{-1}^{1}(1-x^2)\\,(v'(x))^2\\,dx}{\\int_{-1}^{1}(v(x))^2\\,dx}\n$$\n空间 $\\mathcal{H}_{p,m}$ 由 $\\mathbb{P}_p$ 中与 $\\mathbb{P}_m$ 中所有多项式 $L^2$-正交的多项式组成。Legendre 多项式 $\\{P_k\\}_{k=0}^p$ 构成了 $\\mathbb{P}_p$ 的一个正交基。子空间 $\\mathbb{P}_m$ 由 $\\{P_k\\}_{k=0}^m$ 张成。因此，对所有 $q\\in\\mathbb{P}_m$ 成立的正交条件 $(v,q)=0$ 意味着任何 $v \\in \\mathcal{H}_{p,m}$ 都可以表示为次数高于 $m$ 的 Legendre 多项式的线性组合：\n$$\nv(x) = \\sum_{k=m+1}^{p} c_k P_k(x)\n$$\n其中 $c_k$ 为实系数。\n\n我们现在用这些系数来表示 Rayleigh 商的分子和分母。分母是 $b(v,v) = (v,v)$。利用 $v$ 的展开式和 Legendre 多项式的正交性 $(P_k, P_j) = \\delta_{kj} \\|P_k\\|_{L^2}^2$，我们有：\n$$\nb(v,v) = \\left(\\sum_{k=m+1}^{p} c_k P_k, \\sum_{j=m+1}^{p} c_j P_j\\right) = \\sum_{k=m+1}^{p} \\sum_{j=m+1}^{p} c_k c_j (P_k, P_j) = \\sum_{k=m+1}^{p} c_k^2 \\|P_k\\|_{L^2}^2\n$$\n第 $k$ 个 Legendre 多项式的 $L^2$-范数的平方是一个标准结果：$\\|P_k\\|_{L^2}^2 = \\int_{-1}^{1} P_k(x)^2 dx = \\frac{2}{2k+1}$。因此，\n$$\nb(v,v) = \\sum_{k=m+1}^{p} c_k^2 \\frac{2}{2k+1}\n$$\n对于分子 $a(v,v) = \\int_{-1}^{1}(1-x^2)\\,(v'(x))^2\\,dx$，我们分析双线性形式 $a(P_k, P_j)$。使用分部积分法：\n$$\na(P_k, P_j) = \\int_{-1}^{1} (1-x^2) P_k'(x) P_j'(x) dx = \\left[(1-x^2)P_k'(x) P_j(x)\\right]_{-1}^{1} - \\int_{-1}^{1} P_j(x) \\frac{d}{dx}\\left((1-x^2)P_k'(x)\\right) dx\n$$\n边界项由于在 $x=\\pm 1$ 时 $(1-x^2)=0$ 而消失。剩下的是积分项。通过代入 $P_k$ 的 Sturm-Liouville 方程 $-\\frac{d}{dx}\\big((1-x^2)P_k'(x)\\big)=k(k+1)P_k(x)$，我们得到：\n$$\na(P_k, P_j) = \\int_{-1}^{1} P_j(x) \\left(-\\frac{d}{dx}\\big((1-x^2)P_k'(x)\\big)\\right) dx = \\int_{-1}^{1} P_j(x) [k(k+1)P_k(x)] dx = k(k+1) (P_k, P_j)\n$$\n这表明 Legendre 多项式关于内积 $a(\\cdot,\\cdot)$ 也是正交的。现在我们可以计算 $a(v,v)$：\n$$\na(v,v) = a\\left(\\sum_{k=m+1}^{p} c_k P_k, \\sum_{j=m+1}^{p} c_j P_j\\right) = \\sum_{k,j=m+1}^{p} c_k c_j a(P_k, P_j) = \\sum_{k=m+1}^{p} c_k^2 a(P_k, P_k)\n$$\n使用关系式 $a(P_k,P_k) = k(k+1)(P_k,P_k) = k(k+1)\\|P_k\\|_{L^2}^2$：\n$$\na(v,v) = \\sum_{k=m+1}^{p} c_k^2 k(k+1) \\|P_k\\|_{L^2}^2 = \\sum_{k=m+1}^{p} c_k^2 k(k+1) \\frac{2}{2k+1}\n$$\n$C_{p,m}^2$ 的 Rayleigh 商变为：\n$$\n\\frac{a(v,v)}{b(v,v)} = \\frac{\\sum_{k=m+1}^{p} c_k^2 k(k+1) \\frac{2}{2k+1}}{\\sum_{k=m+1}^{p} c_k^2 \\frac{2}{2k+1}}\n$$\n这是一个关于 $k \\in \\{m+1, \\dots, p\\}$ 的值 $\\lambda_k = k(k+1)$ 的加权平均，其非负权重为 $w_k = c_k^2 \\frac{2}{2k+1}$。这种加权平均的上确界是被平均的值中的最大值。函数 $f(k) = k(k+1)$ 在 $k \\ge 0$ 时是严格递增的。因此，当 $k$ 在从 $m+1$ 到 $p$ 的范围内时，$\\lambda_k$ 的最大值在 $k=p$ 处取得。\n$$\nC_{p,m}^2 = \\sup_{v\\in\\mathcal{H}_{p,m}\\setminus\\{0\\}} \\frac{a(v,v)}{b(v,v)} = \\max_{k \\in \\{m+1, \\dots, p\\}} k(k+1) = p(p+1)\n$$\n取平方根，得到逆常数的最终表达式：\n$$\nC_{p,m} = \\sqrt{p(p+1)}\n$$\n\n第二部分：确定滤波器参数 $\\kappa$。\n\n滤波器由变分问题定义：对于给定的 $v \\in \\mathbb{P}_p$，找到 $u \\in \\mathbb{P}_p$ 使得\n$$\nb(u,w) + \\kappa^{-2}a(u,w) = b(v,w) \\quad \\text{for all } w \\in \\mathbb{P}_p\n$$\n问题陈述该滤波器在 Legendre 基上起对角作用。我们来验证这一点并求出增益。设输入为单个模式 $v = P_k$，其中 $k \\in \\{0, \\dots, p\\}$。我们寻求形式为 $u = g_k P_k$ 的解，其中 $g_k$ 是该模式的振幅增益。\n将 $v=P_k$ 和 $u=g_k P_k$ 代入变分形式：\n$$\nb(g_k P_k, w) + \\kappa^{-2}a(g_k P_k, w) = b(P_k, w)\n$$\n$$\ng_k b(P_k, w) + g_k \\kappa^{-2}a(P_k, w) = b(P_k, w)\n$$\n这必须对所有测试函数 $w \\in \\mathbb{P}_p$ 成立。只需对基函数 $w=P_j$ ($j \\in \\{0, \\dots, p\\}$) 进行测试即可。\n$$\ng_k (P_k, P_j) + g_k \\kappa^{-2} a(P_k, P_j) = (P_k, P_j)\n$$\n使用恒等式 $(P_k, P_j) = \\delta_{kj} \\|P_k\\|_{L^2}^2$ 和 $a(P_k, P_j) = k(k+1) \\delta_{kj} \\|P_k\\|_{L^2}^2$：\n$$\ng_k \\delta_{kj} \\|P_k\\|_{L^2}^2 + g_k \\kappa^{-2} k(k+1) \\delta_{kj} \\|P_k\\|_{L^2}^2 = \\delta_{kj} \\|P_k\\|_{L^2}^2\n$$\n如果 $j \\neq k$，方程平凡地满足为 $0=0$。对于 $j=k$，我们有：\n$$\ng_k \\|P_k\\|_{L^2}^2 + g_k \\kappa^{-2} k(k+1) \\|P_k\\|_{L^2}^2 = \\|P_k\\|_{L^2}^2\n$$\n由于 $\\|P_k\\|_{L^2}^2 \\neq 0$，我们可以用它来除：\n$$\ng_k (1 + \\kappa^{-2} k(k+1)) = 1\n$$\n第 $k$ 个模式的振幅增益是：\n$$\ng_k = \\frac{1}{1 + \\kappa^{-2} k(k+1)}\n$$\n问题要求设置 $\\kappa$，使得在最低高通模式 $P_{m+1}$ (次数为 $k=m+1$) 上的增益等于 $1/2$。\n所以我们设 $g_{m+1} = \\frac{1}{2}$：\n$$\n\\frac{1}{1 + \\kappa^{-2} (m+1)((m+1)+1)} = \\frac{1}{2}\n$$\n$$\n1 + \\kappa^{-2} (m+1)(m+2) = 2\n$$\n$$\n\\kappa^{-2} (m+1)(m+2) = 1\n$$\n$$\n\\kappa^2 = (m+1)(m+2)\n$$\n由于 $\\kappa0$，我们取正平方根：\n$$\n\\kappa = \\sqrt{(m+1)(m+2)}\n$$\n\n推导出的两个表达式是 $C_{p,m} = \\sqrt{p(p+1)}$ 和 $\\kappa = \\sqrt{(m+1)(m+2)}$。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\sqrt{p(p+1)}  \\sqrt{(m+1)(m+2)} \\end{pmatrix}}\n$$", "id": "3392892"}]}