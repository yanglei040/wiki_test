{"hands_on_practices": [{"introduction": "谱方法指示器的核心机制是什么？本练习通过分析一个经典的平滑内层来深入探讨其核心机制。通过检验模态系数的渐近行为，我们可以理解能量在不同阶多项式模态上的分布如何作为一个稳健的代理，来反映解的局部光滑性，从而使我们能够精确控制何时激活限制器。[@problem_id:3425756]", "problem": "考虑一个以 $x=0$ 为中心的一维间断伽辽金（DG）单元 $K=[-h/2,h/2]$，在勒让德多项式模态基中使用阶数为 $p=3$ 的多项式逼近。通过 $x=(h/2)\\,\\xi$（其中 $\\xi\\in[-1,1]$）将 $K$ 映射到参考区间。设 $K$ 上的精确解为光滑内层\n$$\nu(x)=\\tanh(\\alpha x),\n$$\n并记 $\\beta=\\alpha h/2$。设 $\\{P_n(\\xi)\\}_{n=0}^{3}$ 为 $[-1,1]$ 上的勒让德多项式。将 $u$ 在 $\\mathrm{span}\\{P_0,P_1,P_2,P_3\\}$ 上的 $L^2$ 投影的模态系数定义为\n$$\na_n=\\frac{2n+1}{2}\\int_{-1}^{1} u\\big((h/2)\\,\\xi\\big)\\,P_n(\\xi)\\,d\\xi,\\quad n=0,1,2,3.\n$$\n采用一种 Persson–Peraire 型的谱衰减指示器，该指示器通过聚合最高的两个模态实现对奇偶性鲁棒的选择性激活：\n$$\ns_K=\\ln\\!\\left(\\frac{a_2^2+a_3^2}{a_0^2+a_1^2+a_2^2+a_3^2}\\right).\n$$\n在一个选择性限制策略中，当且仅当对于给定的容差 $\\varepsilon$ 有 $s_K  \\ln(\\varepsilon)$ 时，在 $K$ 上的限制才被激活。\n\n仅使用勒让德多项式的正交性、$\\tanh$ 的已知解析性质以及对小 $\\beta$ 和大 $\\beta$ 有效的渐近展开，完成以下任务：\n\n1. 推导 $s_K(\\beta)$ 在小 $\\beta$ 情况下的主阶渐近式。\n2. 通过将 $\\tanh(\\beta\\xi)$ 与其在 $\\beta\\to\\infty$ 时的逐点极限联系起来，并投影到相同的模态基上，推导 $s_K(\\beta)$ 在大 $\\beta$ 情况下的主阶渐近式。\n3. 使用小 $\\beta$ 渐近式，确定主阶临界值 $(\\alpha h)_c$，使得 $s_K(\\beta)$ 穿过激活阈值 $s_K=\\ln(\\varepsilon)$，即对于 $\\alpha h(\\alpha h)_c$ 激活限制，而对于 $\\alpha h(\\alpha h)_c$ 不激活限制。\n\n假设阈值参数为 $\\varepsilon=10^{-4}$。你的最终答案必须是 $(\\alpha h)_c$ 的一个无单位的单一闭式解析表达式。不要四舍五入；请提供精确表达式。", "solution": "首先根据指定标准对问题进行验证。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n- **间断伽辽金 (DG) 单元：** $K = [-h/2, h/2]$，以 $x=0$ 为中心。\n- **多项式逼近阶数：** $p=3$。\n- **基：** $[-1, 1]$ 上的勒让德多项式模态基 $\\{P_n(\\xi)\\}_{n=0}^{3}$。\n- **到参考区间的映射：** $x = (h/2)\\xi$，其中 $\\xi \\in [-1, 1]$。\n- **精确解：** $u(x) = \\tanh(\\alpha x)$。\n- **参数：** $\\beta = \\alpha h / 2$。\n- **模态系数：** $a_n = \\frac{2n+1}{2} \\int_{-1}^{1} u((h/2)\\xi) P_n(\\xi) d\\xi$，其中 $n=0, 1, 2, 3$。\n- **谱衰减指示器：** $s_K = \\ln\\left(\\frac{a_2^2 + a_3^2}{a_0^2 + a_1^2 + a_2^2 + a_3^2}\\right)$。\n- **限制激活条件：** $s_K  \\ln(\\varepsilon)$。\n- **阈值参数：** $\\varepsilon = 10^{-4}$。\n- **任务：**\n    1. 推导 $s_K(\\beta)$ 的小 $\\beta$ 主阶渐近式。\n    2. 推导 $s_K(\\beta)$ 的大 $\\beta$ 主阶渐近式。\n    3. 使用小 $\\beta$ 结果确定主阶临界值 $(\\alpha h)_c$。\n- **约束条件：** 仅使用勒让德多项式的正交性、$\\tanh$ 的解析性质和渐近展开。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学依据：** 该问题牢固地植根于偏微分方程的数值分析领域，特别涉及谱方法和间断伽辽金方法。使用勒让德多项式、$L^2$ 投影和用于问题单元检测的谱衰减指示器（如 Persson-Peraire 指示器）是标准概念。函数 $\\tanh(\\alpha x)$ 是光滑层的典型表示。\n- **适定性：** 该问题在数学上是适定的。所有变量、函数和目标都已精确指定。这些任务导向一个唯一且有意义的解。\n- **客观性：** 问题陈述是客观的，没有任何主观或模糊的语言。\n- **完整性与一致性：** 问题是自洽的。所有必要的信息（定义、常数、条件）都已提供。设置中没有矛盾。\n- **真实性与可行性：** 该问题描述了数值方法开发或研究中的一个标准理论分析练习。所需的计算是可行的。\n\n**步骤 3：结论与行动**\n问题有效。将提供完整解答。\n\n### 解答\n\n按照要求，解答分为三个部分推导。首先，我们注意到一个源于奇偶性的关键性质。待投影的函数是 $u((h/2)\\xi) = \\tanh(\\alpha (h/2) \\xi) = \\tanh(\\beta \\xi)$。这是一个关于 $\\xi$ 的奇函数，因为 $\\tanh(-y) = -\\tanh(y)$。勒让德多项式 $P_n(\\xi)$ 对于偶数 $n$ 是偶函数，对于奇数 $n$ 是奇函数。奇函数与偶函数在对称区间（如 $[-1, 1]$）上的积分为零。\n\n模态系数由 $a_n = \\frac{2n+1}{2} \\int_{-1}^{1} \\tanh(\\beta \\xi) P_n(\\xi) d\\xi$ 给出。\n对于 $n=0$ 和 $n=2$，多项式 $P_0(\\xi)=1$ 和 $P_2(\\xi)=\\frac{1}{2}(3\\xi^2-1)$ 是偶函数。因此，对于 $n=0, 2$，被积函数 $\\tanh(\\beta \\xi) P_n(\\xi)$ 是奇函数。所以，在 $[-1, 1]$ 上的积分为零。\n$$ a_0 = 0, \\quad a_2 = 0 $$\n这对所有 $\\beta$ 值都成立。指示器 $s_K$ 简化为：\n$$ s_K = \\ln\\left(\\frac{a_3^2}{a_1^2 + a_3^2}\\right) $$\n\n**1. $s_K(\\beta)$ 的小 $\\beta$ 渐近式**\n\n对于其自变量 $y$ 的小值，$\\tanh(y)$ 的泰勒展开为 $\\tanh(y) = y - \\frac{1}{3}y^3 + O(y^5)$。因此，对于小 $\\beta$：\n$$ \\tanh(\\beta \\xi) \\approx \\beta \\xi - \\frac{1}{3}(\\beta \\xi)^3 = \\beta \\xi - \\frac{\\beta^3}{3}\\xi^3 $$\n为了求系数 $a_1$ 和 $a_3$，我们将此多项式投影到勒让德基上。我们使用以下关系：\n$$ P_1(\\xi) = \\xi $$\n$$ P_3(\\xi) = \\frac{1}{2}(5\\xi^3 - 3\\xi) \\implies \\xi^3 = \\frac{2}{5}P_3(\\xi) + \\frac{3}{5}\\xi = \\frac{2}{5}P_3(\\xi) + \\frac{3}{5}P_1(\\xi) $$\n将这些代入 $\\tanh(\\beta \\xi)$ 的展开式：\n$$ \\tanh(\\beta \\xi) \\approx \\beta P_1(\\xi) - \\frac{\\beta^3}{3}\\left(\\frac{2}{5}P_3(\\xi) + \\frac{3}{5}P_1(\\xi)\\right) $$\n$$ \\tanh(\\beta \\xi) \\approx \\left(\\beta - \\frac{\\beta^3}{5}\\right)P_1(\\xi) - \\frac{2\\beta^3}{15}P_3(\\xi) $$\n模态系数 $a_n$ 正是勒让德级数展开中的系数。因此，对于小 $\\beta$：\n$$ a_1 \\approx \\beta - \\frac{\\beta^3}{5} \\implies a_1 = \\beta + O(\\beta^3) $$\n$$ a_3 \\approx -\\frac{2\\beta^3}{15} $$\n为了找到 $s_K$ 的主阶行为，我们使用系数的主阶项：$a_1 \\approx \\beta$ 和 $a_3 \\approx -2\\beta^3/15$。\n$$ s_K(\\beta) \\approx \\ln\\left(\\frac{(-\\frac{2\\beta^3}{15})^2}{(\\beta)^2 + (-\\frac{2\\beta^3}{15})^2}\\right) = \\ln\\left(\\frac{\\frac{4\\beta^6}{225}}{\\beta^2 + \\frac{4\\beta^6}{225}}\\right) $$\n在分母中，对于小 $\\beta$，$\\beta^2$ 是主导项。\n$$ s_K(\\beta) \\approx \\ln\\left(\\frac{\\frac{4\\beta^6}{225}}{\\beta^2}\\right) = \\ln\\left(\\frac{4\\beta^4}{225}\\right) $$\n这就是 $s_K$ 的主阶小 $\\beta$ 渐近行为。\n\n**2. $s_K(\\beta)$ 的大 $\\beta$ 渐近式**\n\n当 $\\beta \\to \\infty$ 时，函数 $\\tanh(\\beta \\xi)$ 对于 $\\xi \\neq 0$ 逐点逼近符号函数：\n$$ \\lim_{\\beta\\to\\infty} \\tanh(\\beta \\xi) = \\text{sgn}(\\xi) = \\begin{cases} 1  \\xi > 0 \\\\ 0  \\xi = 0 \\\\ -1  \\xi  0 \\end{cases} $$\n渐近系数，记作 $a_n^{(\\infty)}$，是通过将 $\\text{sgn}(\\xi)$ 投影到勒让德基上得到的。和之前一样，由于奇偶性，$a_0^{(\\infty)}=a_2^{(\\infty)}=0$。\n对于 $a_1^{(\\infty)}$：\n$$ a_1^{(\\infty)} = \\frac{3}{2}\\int_{-1}^{1} \\text{sgn}(\\xi)P_1(\\xi)d\\xi = \\frac{3}{2}\\int_{-1}^{1} \\xi\\,\\text{sgn}(\\xi)d\\xi = \\frac{3}{2}\\int_{-1}^{1} |\\xi|d\\xi = \\frac{3}{2} \\left( 2\\int_{0}^{1} \\xi d\\xi \\right) = 3\\left[\\frac{\\xi^2}{2}\\right]_0^1 = \\frac{3}{2} $$\n对于 $a_3^{(\\infty)}$：\n$$ a_3^{(\\infty)} = \\frac{7}{2}\\int_{-1}^{1} \\text{sgn}(\\xi)P_3(\\xi)d\\xi = \\frac{7}{2}\\int_{-1}^{1} \\text{sgn}(\\xi)\\frac{1}{2}(5\\xi^3 - 3\\xi)d\\xi $$\n被积函数是一个偶函数，所以我们可以写成：\n$$ a_3^{(\\infty)} = \\frac{7}{2} \\cdot 2 \\int_{0}^{1} \\frac{1}{2}(5\\xi^3 - 3\\xi)d\\xi = \\frac{7}{2}\\left[5\\frac{\\xi^4}{4} - 3\\frac{\\xi^2}{2}\\right]_0^1 = \\frac{7}{2}\\left(\\frac{5}{4}-\\frac{3}{2}\\right) = \\frac{7}{2}\\left(-\\frac{1}{4}\\right) = -\\frac{7}{8} $$\n该指示器的大 $\\beta$ 极限是：\n$$ s_K^{(\\infty)} = \\ln\\left(\\frac{(a_3^{(\\infty)})^2}{(a_1^{(\\infty)})^2 + (a_3^{(\\infty)})^2}\\right) = \\ln\\left(\\frac{(-\\frac{7}{8})^2}{(\\frac{3}{2})^2 + (-\\frac{7}{8})^2}\\right) = \\ln\\left(\\frac{\\frac{49}{64}}{\\frac{9}{4} + \\frac{49}{64}}\\right) $$\n$$ s_K^{(\\infty)} = \\ln\\left(\\frac{\\frac{49}{64}}{\\frac{144}{64} + \\frac{49}{64}}\\right) = \\ln\\left(\\frac{49}{193}\\right) $$\n\n**3. 临界值 $(\\alpha h)_c$**\n\n当 $s_K  \\ln(\\varepsilon)$ 时，限制程序被激活。临界值对应于阈值 $s_K = \\ln(\\varepsilon)$。我们使用在第 1 部分中推导的小 $\\beta$ 渐近式，因为阈值 $\\varepsilon = 10^{-4}$ 会导致 $\\ln(\\varepsilon)$ 成为一个大的负值，这在 $\\beta$ 很小时达到。\n$$ \\ln\\left(\\frac{4\\beta^4}{225}\\right) = \\ln(\\varepsilon) $$\n对两边取指数：\n$$ \\frac{4\\beta^4}{225} = \\varepsilon $$\n求解临界值 $\\beta_c$：\n$$ \\beta_c^4 = \\frac{225}{4}\\varepsilon \\implies \\beta_c = \\left(\\frac{225\\varepsilon}{4}\\right)^{1/4} $$\n临界值用 $(\\alpha h)_c = 2\\beta_c$ 表示：\n$$ (\\alpha h)_c = 2 \\left(\\frac{15^2 \\varepsilon}{2^2}\\right)^{1/4} = 2 \\left(\\frac{15}{2}\\right)^{2/4} \\varepsilon^{1/4} = 2 \\left(\\frac{15}{2}\\right)^{1/2} \\varepsilon^{1/4} = 2 \\frac{\\sqrt{15}}{\\sqrt{2}} \\varepsilon^{1/4} = \\sqrt{2}\\sqrt{15}\\varepsilon^{1/4} = \\sqrt{30}\\varepsilon^{1/4} $$\n代入给定值 $\\varepsilon = 10^{-4}$：\n$$ (\\alpha h)_c = \\sqrt{30}(10^{-4})^{1/4} = \\sqrt{30} \\times 10^{-1} = \\frac{\\sqrt{30}}{10} $$\n这就是临界值的最终解析表达式。", "answer": "$$\\boxed{\\frac{\\sqrt{30}}{10}}$$", "id": "3425756"}, {"introduction": "一旦指示器将一个单元标记为“问题单元”(troubled cell)，下一步就是应用限制器来施加物理约束并防止伪振荡。这个问题提供了一个具体的分步计算，使用了在激波捕捉格式中广泛应用的TVB minmod限制器。这种动手计算将揭示限制过程的神秘面紗，并阐明如何根据相邻单元的行为来调整无限制的DG斜率。[@problem_id:3425753]", "problem": "考虑一个一维标量守恒律，它在一个单元尺寸为 $h$ 的均匀网格上，使用分片线性多项式，通过二阶间断 Galerkin (DG) 方法进行离散化。一个问题单元指示器标记了单元 $i$，因为精确解是分片线性的，在单元 $i$ 和 $i+1$ 之间的界面处存在一个斜率不连续点。在这样一个被标记的单元中，对单元斜率应用全变差有界 (TVB) minmod 限制器。\n\n使用以下数据：\n- 均匀单元尺寸为 $h = \\frac{1}{10}$。\n- 相邻单元中的单元平均值为 $\\bar{u}_{i-1} = 1$，$\\bar{u}_{i} = \\frac{8}{5}$ 和 $\\bar{u}_{i+1} = 2$。\n- 单元 $i$ 中的未限制斜率（从 DG 多项式表示中获得）为 $s_{i} = 8$。\n- TVB 参数为 $M = 30$。\n\n采用用于分片线性重构的标准 TVB minmod 限制器，其定义为\n$$\n\\tilde{s}_{i} = \\operatorname{mm}_{\\mathrm{TVB}}\\!\\left(s_{i}, \\frac{\\bar{u}_{i} - \\bar{u}_{i-1}}{h}, \\frac{\\bar{u}_{i+1} - \\bar{u}_{i}}{h}\\right),\n$$\n其中全变差有界 (TVB) 修正是\n$$\n\\operatorname{mm}_{\\mathrm{TVB}}(a_{1}, a_{2}, a_{3}) =\n\\begin{cases}\na_{1},  \\text{if } |a_{1}| \\le M h^{2}, \\\\\n\\operatorname{mm}(a_{1}, a_{2}, a_{3}),  \\text{otherwise},\n\\end{cases}\n$$\n标准 minmod 函数是\n$$\n\\operatorname{mm}(a_{1}, a_{2}, a_{3}) =\n\\begin{cases}\n\\operatorname{sgn}(a_{1}) \\min\\left(|a_{1}|, |a_{2}|, |a_{3}|\\right),  \\text{if } \\operatorname{sgn}(a_{1}) = \\operatorname{sgn}(a_{2}) = \\operatorname{sgn}(a_{3}), \\\\\n0,  \\text{otherwise}.\n\\end{cases}\n$$\n\n计算单元 $i$ 中的受限斜率 $\\tilde{s}_{i}$。将你的最终答案表示为单个实数。无需四舍五入。", "solution": "该问题要求使用全变差有界 (TVB) minmod 限制器计算单元 $i$ 的受限斜率 $\\tilde{s}_{i}$。问题提供了执行此计算所需的所有必要数据和定义。\n\n该问题是有效的，因为它在守恒律数值方法领域具有科学基础，是适定的，具有充分且一致的数据，并以客观、正式的语言表述。我们可以开始求解。\n\n受限斜率 $\\tilde{s}_{i}$ 定义为：\n$$\n\\tilde{s}_{i} = \\operatorname{mm}_{\\mathrm{TVB}}\\!\\left(s_{i}, \\frac{\\bar{u}_{i} - \\bar{u}_{i-1}}{h}, \\frac{\\bar{u}_{i+1} - \\bar{u}_{i}}{h}\\right)\n$$\n其中 TVB minmod 函数由下式给出：\n$$\n\\operatorname{mm}_{\\mathrm{TVB}}(a_{1}, a_{2}, a_{3}) =\n\\begin{cases}\na_{1},  \\text{if } |a_{1}| \\le M h^{2}, \\\\\n\\operatorname{mm}(a_{1}, a_{2}, a_{3}),  \\text{otherwise}.\n\\end{cases}\n$$\n标准 minmod 函数 $\\operatorname{mm}(a_{1}, a_{2}, a_{3})$ 定义为：\n$$\n\\operatorname{mm}(a_{1}, a_{2}, a_{3}) =\n\\begin{cases}\n\\operatorname{sgn}(a_{1}) \\min\\left(|a_{1}|, |a_{2}|, |a_{3}|\\right),  \\text{if } \\operatorname{sgn}(a_{1}) = \\operatorname{sgn}(a_{2}) = \\operatorname{sgn}(a_{3}), \\\\\n0,  \\text{otherwise}.\n\\end{cases}\n$$\n\n第一步是检查 TVB 修正的条件。我们必须判断是否满足 $|s_{i}| \\le M h^{2}$。\n给定的值为：\n- 单元 $i$ 中的未限制斜率：$s_{i} = 8$。\n- TVB 参数：$M = 30$。\n- 均匀单元尺寸：$h = \\frac{1}{10}$。\n\n我们计算阈值 $M h^{2}$：\n$$\nM h^{2} = 30 \\times \\left(\\frac{1}{10}\\right)^{2} = 30 \\times \\frac{1}{100} = \\frac{30}{100} = \\frac{3}{10}.\n$$\n接下来，我们取未限制斜率 $s_{i}$ 的绝对值：\n$$\n|s_{i}| = |8| = 8.\n$$\n现在，我们将 $|s_{i}|$ 与 $M h^{2}$ 进行比较：\n$$\n8 > \\frac{3}{10}.\n$$\n由于 $|s_{i}| > M h^{2}$，条件 $|s_{i}| \\le M h^{2}$ 不成立。因此，我们必须使用 $\\operatorname{mm}_{\\mathrm{TVB}}$ 函数的第二种情况，即涉及标准 minmod 函数的情况：\n$$\n\\tilde{s}_{i} = \\operatorname{mm}\\left(s_{i}, \\frac{\\bar{u}_{i} - \\bar{u}_{i-1}}{h}, \\frac{\\bar{u}_{i+1} - \\bar{u}_{i}}{h}\\right).\n$$\n\n为了计算该函数，我们必须首先计算其自变量。设它们为 $a_1$、$a_2$ 和 $a_3$。\n第一个自变量是未限制的斜率：\n$$\na_{1} = s_{i} = 8.\n$$\n第二个自变量是后向差分斜率：\n$$\na_{2} = \\frac{\\bar{u}_{i} - \\bar{u}_{i-1}}{h}.\n$$\n使用给定的单元平均值 $\\bar{u}_{i} = \\frac{8}{5}$ 和 $\\bar{u}_{i-1} = 1$，以及单元尺寸 $h = \\frac{1}{10}$：\n$$\na_{2} = \\frac{\\frac{8}{5} - 1}{\\frac{1}{10}} = \\frac{\\frac{8}{5} - \\frac{5}{5}}{\\frac{1}{10}} = \\frac{\\frac{3}{5}}{\\frac{1}{10}} = \\frac{3}{5} \\times 10 = 6.\n$$\n第三个自变量是前向差分斜率：\n$$\na_{3} = \\frac{\\bar{u}_{i+1} - \\bar{u}_{i}}{h}.\n$$\n使用给定的单元平均值 $\\bar{u}_{i+1} = 2$ 和 $\\bar{u}_{i} = \\frac{8}{5}$：\n$$\na_{3} = \\frac{2 - \\frac{8}{5}}{\\frac{1}{10}} = \\frac{\\frac{10}{5} - \\frac{8}{5}}{\\frac{1}{10}} = \\frac{\\frac{2}{5}}{\\frac{1}{10}} = \\frac{2}{5} \\times 10 = 4.\n$$\n现在我们必须计算 $\\operatorname{mm}(8, 6, 4)$。\n首先，我们检查自变量 $a_1=8$，$a_2=6$ 和 $a_3=4$ 的符号：\n$$\n\\operatorname{sgn}(8) = +1, \\quad \\operatorname{sgn}(6) = +1, \\quad \\operatorname{sgn}(4) = +1.\n$$\n由于所有自变量的符号都相同，因此应用 $\\operatorname{mm}$ 函数的第一种情况：\n$$\n\\tilde{s}_{i} = \\operatorname{sgn}(a_{1}) \\min(|a_{1}|, |a_{2}|, |a_{3}|).\n$$\n代入数值：\n$$\n\\tilde{s}_{i} = \\operatorname{sgn}(8) \\min(|8|, |6|, |4|) = (+1) \\min(8, 6, 4).\n$$\n集合 $\\{8, 6, 4\\}$ 的最小值是 $4$。因此，受限斜率为：\n$$\n\\tilde{s}_{i} = 4.\n$$", "answer": "$$\\boxed{4}$$", "id": "3425753"}, {"introduction": "对于像气体动力学欧拉方程这样的方程组，一个关键问题出现了：我们应该使用哪个物理变量（例如，密度、压力、熵）来进行指示？本练习模拟了一个包含爆轰波的真实场景，展示了变量的选择如何显著影响指示器的性能。通过将不同变量的结果与已知的“真实解”进行比较，您将学会如何为实现高精度和高效率而选择一个具有物理动机的指示变量。[@problem_id:3425758]", "problem": "一个一维欧拉冲击波快照在三个连续单元 $E \\in \\{1,2,3\\}$ 上，通过多项式阶数为 $p=2$ 的间断伽辽金（DG）离散化来表示。对于三个标量变量集——密度 $\\rho$、压力 $p$ 和数学熵 $s=\\ln(p)-\\gamma \\ln(\\rho)$（其中 $\\gamma=1.4$）——在参考单元上，您被给定了每个单元中DG多项式在$L^2$-标准正交勒让德基下的2阶模态系数。对于变量 $v \\in \\{\\rho,p,s\\}$，其模态系数记为 $\\{\\hat{v}_{k}^{(E)}\\}_{k=0}^{2}$。所使用的单元问题指示器是 Persson–Peraire 高阶模态内容指示器：\n$$\nI_{E}^{(v)} \\;=\\; \\ln\\!\\left(\\frac{\\left(\\hat{v}_{2}^{(E)}\\right)^{2}}{\\sum_{k=0}^{2}\\left(\\hat{v}_{k}^{(E)}\\right)^{2}}\\right).\n$$\n如果 $I_{E}^{(v)}  \\tau$（阈值 $\\tau=-4.5$），则单元 $E$ 对变量 $v$ 被标记为问题单元。对于此快照，真正需要限制的物理上一致的目标单元集为 $\\mathcal{T}=\\{3\\}$。\n\n特定于变量的模态系数如下（每个数字是标准正交勒让德基下的一个系数）：\n\n- 对于密度 $v=\\rho$：\n  - $E=1$: $\\left(\\hat{\\rho}_{0}^{(1)},\\hat{\\rho}_{1}^{(1)},\\hat{\\rho}_{2}^{(1)}\\right)=(1.0,\\,0.02,\\,0.01)$。\n  - $E=2$: $\\left(\\hat{\\rho}_{0}^{(2)},\\hat{\\rho}_{1}^{(2)},\\hat{\\rho}_{2}^{(2)}\\right)=(1.1,\\,0.05,\\,0.3)$。\n  - $E=3$: $\\left(\\hat{\\rho}_{0}^{(3)},\\hat{\\rho}_{1}^{(3)},\\hat{\\rho}_{2}^{(3)}\\right)=(3.0,\\,0.5,\\,0.4)$。\n\n- 对于压力 $v=p$：\n  - $E=1$: $\\left(\\hat{p}_{0}^{(1)},\\hat{p}_{1}^{(1)},\\hat{p}_{2}^{(1)}\\right)=(1.0,\\,0.3,\\,0.2)$。\n  - $E=2$: $\\left(\\hat{p}_{0}^{(2)},\\hat{p}_{1}^{(2)},\\hat{p}_{2}^{(2)}\\right)=(1.05,\\,0.25,\\,0.15)$。\n  - $E=3$: $\\left(\\hat{p}_{0}^{(3)},\\hat{p}_{1}^{(3)},\\hat{p}_{2}^{(3)}\\right)=(2.0,\\,0.6,\\,0.4)$。\n\n- 对于熵 $v=s$：\n  - $E=1$: $\\left(\\hat{s}_{0}^{(1)},\\hat{s}_{1}^{(1)},\\hat{s}_{2}^{(1)}\\right)=(0.2,\\,0.01,\\,0.001)$。\n  - $E=2$: $\\left(\\hat{s}_{0}^{(2)},\\hat{s}_{1}^{(2)},\\hat{s}_{2}^{(2)}\\right)=(0.25,\\,0.015,\\,0.0015)$。\n  - $E=3$: $\\left(\\hat{s}_{0}^{(3)},\\hat{s}_{1}^{(3)},\\hat{s}_{2}^{(3)}\\right)=(0.9,\\,0.2,\\,0.12)$。\n\n为每个变量集 $v$ 定义选择性和物理一致性得分：\n$$\nC(v) \\;=\\; 3\\,N_{\\mathrm{FN}}(v) \\;+\\; N_{\\mathrm{FP}}(v),\n$$\n其中 $N_{\\mathrm{FN}}(v)$ 是假阴性（在 $\\mathcal{T}$ 中但未为变量 $v$ 标记的单元数）的数量，$N_{\\mathrm{FP}}(v)$ 是假阳性（为变量 $v$ 标记但不在 $\\mathcal{T}$ 中的单元数）的数量。得分越低，表示限制越具选择性和物理一致性。\n\n计算所有 $v \\in \\{\\rho,p,s\\}$ 和 $E \\in \\{1,2,3\\}$ 的 $I_{E}^{(v)}$，使用阈值 $\\tau=-4.5$ 确定每个 $v$ 的被标记单元，评估 $C(v)$，并决定哪个变量集能最小化 $C(v)$。通过代码报告您的最终选择：$\\rho \\mapsto 1$, $p \\mapsto 2$, $s \\mapsto 3$。最终答案必须是这个单一的整数代码。无需四舍五入，不涉及单位。", "solution": "用户提供了一个关于在间断伽辽金（DG）模拟中为问题单元指示器选择最优变量的问题。该问题提法明确，在守恒律数值方法领域具有科学依据，并为获得唯一解提供了所有必要数据。我将继续进行所需的计算。\n\n问题的核心是，对三个不同的变量——密度($\\rho$)、压力($p$)和熵($s$)——在三个计算单元上评估 Persson–Peraire 指示器，并确定哪个变量提供的“问题”单元集与给定的基准真相相比最准确。\n\n在单元 $E$ 中，变量 $v$ 的 Persson–Peraire 指示器由下式给出：\n$$\nI_{E}^{(v)} = \\ln\\left(\\frac{\\left(\\hat{v}_{2}^{(E)}\\right)^{2}}{\\sum_{k=0}^{2}\\left(\\hat{v}_{k}^{(E)}\\right)^{2}}\\right)\n$$\n其中 $\\{\\hat{v}_{k}^{(E)}\\}_{k=0}^{2}$ 是阶数为 $p=2$ 的 DG 多项式在标准正交基下的模态系数。如果 $I_{E}^{(v)} > \\tau$（其中阈值为 $\\tau = -4.5$），则单元 $E$ 被标记为问题单元。真正的问题单元集是 $\\mathcal{T}=\\{3\\}$。\n\n对于每个变量 $v$，我们将确定被标记的单元集 $\\mathcal{F}^{(v)}$。然后我们计算假阴性的数量 $N_{\\mathrm{FN}}(v) = |\\mathcal{T} \\setminus \\mathcal{F}^{(v)}|$ 和假阳性的数量 $N_{\\mathrm{FP}}(v) = |\\mathcal{F}^{(v)} \\setminus \\mathcal{T}|$。性能由成本函数 $C(v) = 3 N_{\\mathrm{FN}}(v) + N_{\\mathrm{FP}}(v)$ 衡量。目标是找到最小化 $C(v)$ 的变量。\n\n每个变量的计算如下：\n\n**1. 密度变量 ($v=\\rho$)**\n\n*   **单元 $E=1$**：系数为 $(\\hat{\\rho}_{0}^{(1)}, \\hat{\\rho}_{1}^{(1)}, \\hat{\\rho}_{2}^{(1)}) = (1.0, 0.02, 0.01)$。\n    $$\n    I_{1}^{(\\rho)} = \\ln\\left(\\frac{(0.01)^2}{(1.0)^2 + (0.02)^2 + (0.01)^2}\\right) = \\ln\\left(\\frac{0.0001}{1.0 + 0.0004 + 0.0001}\\right) = \\ln\\left(\\frac{0.0001}{1.0005}\\right) \\approx -9.2108\n    $$\n    由于 $I_{1}^{(\\rho)} \\approx -9.2108  -4.5$，单元 $1$ 未被标记。\n\n*   **单元 $E=2$**：系数为 $(\\hat{\\rho}_{0}^{(2)}, \\hat{\\rho}_{1}^{(2)}, \\hat{\\rho}_{2}^{(2)}) = (1.1, 0.05, 0.3)$。\n    $$\n    I_{2}^{(\\rho)} = \\ln\\left(\\frac{(0.3)^2}{(1.1)^2 + (0.05)^2 + (0.3)^2}\\right) = \\ln\\left(\\frac{0.09}{1.21 + 0.0025 + 0.09}\\right) = \\ln\\left(\\frac{0.09}{1.3025}\\right) \\approx -2.6723\n    $$\n    由于 $I_{2}^{(\\rho)} \\approx -2.6723 > -4.5$，单元 $2$ 被标记。\n\n*   **单元 $E=3$**：系数为 $(\\hat{\\rho}_{0}^{(3)}, \\hat{\\rho}_{1}^{(3)}, \\hat{\\rho}_{2}^{(3)}) = (3.0, 0.5, 0.4)$。\n    $$\n    I_{3}^{(\\rho)} = \\ln\\left(\\frac{(0.4)^2}{(3.0)^2 + (0.5)^2 + (0.4)^2}\\right) = \\ln\\left(\\frac{0.16}{9.0 + 0.25 + 0.16}\\right) = \\ln\\left(\\frac{0.16}{9.41}\\right) \\approx -4.0743\n    $$\n    由于 $I_{3}^{(\\rho)} \\approx -4.0743 > -4.5$，单元 $3$ 被标记。\n\n密度的被标记单元集是 $\\mathcal{F}^{(\\rho)} = \\{2, 3\\}$。\n*   假阴性 ($N_{\\mathrm{FN}}$): $\\mathcal{T} \\setminus \\mathcal{F}^{(\\rho)} = \\{3\\} \\setminus \\{2, 3\\} = \\emptyset$。所以，$N_{\\mathrm{FN}}(\\rho) = 0$。\n*   假阳性 ($N_{\\mathrm{FP}}$): $\\mathcal{F}^{(\\rho)} \\setminus \\mathcal{T} = \\{2, 3\\} \\setminus \\{3\\} = \\{2\\}$。所以，$N_{\\mathrm{FP}}(\\rho) = 1$。\n*   密度的成本：$C(\\rho) = 3 \\times 0 + 1 = 1$。\n\n**2. 压力变量 ($v=p$)**\n\n*   **单元 $E=1$**：系数为 $(\\hat{p}_{0}^{(1)}, \\hat{p}_{1}^{(1)}, \\hat{p}_{2}^{(1)}) = (1.0, 0.3, 0.2)$。\n    $$\n    I_{1}^{(p)} = \\ln\\left(\\frac{(0.2)^2}{(1.0)^2 + (0.3)^2 + (0.2)^2}\\right) = \\ln\\left(\\frac{0.04}{1.0 + 0.09 + 0.04}\\right) = \\ln\\left(\\frac{0.04}{1.13}\\right) \\approx -3.3414\n    $$\n    由于 $I_{1}^{(p)} \\approx -3.3414 > -4.5$，单元 $1$ 被标记。\n\n*   **单元 $E=2$**：系数为 $(\\hat{p}_{0}^{(2)}, \\hat{p}_{1}^{(2)}, \\hat{p}_{2}^{(2)}) = (1.05, 0.25, 0.15)$。\n    $$\n    I_{2}^{(p)} = \\ln\\left(\\frac{(0.15)^2}{(1.05)^2 + (0.25)^2 + (0.15)^2}\\right) = \\ln\\left(\\frac{0.0225}{1.1025 + 0.0625 + 0.0225}\\right) = \\ln\\left(\\frac{0.0225}{1.1875}\\right) \\approx -3.9655\n    $$\n    由于 $I_{2}^{(p)} \\approx -3.9655 > -4.5$，单元 $2$ 被标记。\n\n*   **单元 $E=3$**：系数为 $(\\hat{p}_{0}^{(3)}, \\hat{p}_{1}^{(3)}, \\hat{p}_{2}^{(3)}) = (2.0, 0.6, 0.4)$。\n    $$\n    I_{3}^{(p)} = \\ln\\left(\\frac{(0.4)^2}{(2.0)^2 + (0.6)^2 + (0.4)^2}\\right) = \\ln\\left(\\frac{0.16}{4.0 + 0.36 + 0.16}\\right) = \\ln\\left(\\frac{0.16}{4.52}\\right) \\approx -3.3414\n    $$\n    由于 $I_{3}^{(p)} \\approx -3.3414 > -4.5$，单元 $3$ 被标记。\n\n压力的被标记单元集是 $\\mathcal{F}^{(p)} = \\{1, 2, 3\\}$。\n*   假阴性 ($N_{\\mathrm{FN}}$): $\\mathcal{T} \\setminus \\mathcal{F}^{(p)} = \\{3\\} \\setminus \\{1, 2, 3\\} = \\emptyset$。所以，$N_{\\mathrm{FN}}(p) = 0$。\n*   假阳性 ($N_{\\mathrm{FP}}$): $\\mathcal{F}^{(p)} \\setminus \\mathcal{T} = \\{1, 2, 3\\} \\setminus \\{3\\} = \\{1, 2\\}$。所以，$N_{\\mathrm{FP}}(p) = 2$。\n*   压力的成本：$C(p) = 3 \\times 0 + 2 = 2$。\n\n**3. 熵变量 ($v=s$)**\n\n*   **单元 $E=1$**：系数为 $(\\hat{s}_{0}^{(1)}, \\hat{s}_{1}^{(1)}, \\hat{s}_{2}^{(1)}) = (0.2, 0.01, 0.001)$。\n    $$\n    I_{1}^{(s)} = \\ln\\left(\\frac{(0.001)^2}{(0.2)^2 + (0.01)^2 + (0.001)^2}\\right) = \\ln\\left(\\frac{10^{-6}}{0.04 + 0.0001 + 10^{-6}}\\right) = \\ln\\left(\\frac{10^{-6}}{0.040101}\\right) \\approx -10.5991\n    $$\n    由于 $I_{1}^{(s)} \\approx -10.5991  -4.5$，单元 $1$ 未被标记。\n\n*   **单元 $E=2$**：系数为 $(\\hat{s}_{0}^{(2)}, \\hat{s}_{1}^{(2)}, \\hat{s}_{2}^{(2)}) = (0.25, 0.015, 0.0015)$。\n    $$\n    I_{2}^{(s)} = \\ln\\left(\\frac{(0.0015)^2}{(0.25)^2 + (0.015)^2 + (0.0015)^2}\\right) = \\ln\\left(\\frac{2.25 \\times 10^{-6}}{0.0625 + 0.000225 + 2.25 \\times 10^{-6}}\\right) = \\ln\\left(\\frac{2.25 \\times 10^{-6}}{0.06272725}\\right) \\approx -10.2364\n    $$\n    由于 $I_{2}^{(s)} \\approx -10.2364  -4.5$，单元 $2$ 未被标记。\n\n*   **单元 $E=3$**：系数为 $(\\hat{s}_{0}^{(3)}, \\hat{s}_{1}^{(3)}, \\hat{s}_{2}^{(3)}) = (0.9, 0.2, 0.12)$。\n    $$\n    I_{3}^{(s)} = \\ln\\left(\\frac{(0.12)^2}{(0.9)^2 + (0.2)^2 + (0.12)^2}\\right) = \\ln\\left(\\frac{0.0144}{0.81 + 0.04 + 0.0144}\\right) = \\ln\\left(\\frac{0.0144}{0.8644}\\right) \\approx -4.0954\n    $$\n    由于 $I_{3}^{(s)} \\approx -4.0954 > -4.5$，单元 $3$ 被标记。\n\n熵的被标记单元集是 $\\mathcal{F}^{(s)} = \\{3\\}$。\n*   假阴性 ($N_{\\mathrm{FN}}$): $\\mathcal{T} \\setminus \\mathcal{F}^{(s)} = \\{3\\} \\setminus \\{3\\} = \\emptyset$。所以，$N_{\\mathrm{FN}}(s) = 0$。\n*   假阳性 ($N_{\\mathrm{FP}}$): $\\mathcal{F}^{(s)} \\setminus \\mathcal{T} = \\{3\\} \\setminus \\{3\\} = \\emptyset$。所以，$N_{\\mathrm{FP}}(s) = 0$。\n*   熵的成本：$C(s) = 3 \\times 0 + 0 = 0$。\n\n**结论**\n\n比较三个变量的成本：\n*   $C(\\rho) = 1$\n*   $C(p) = 2$\n*   $C(s) = 0$\n\n最小成本为 $0$，这是使用熵变量 $s$ 时达成的。问题指定最终答案应为一个代码：$\\rho \\mapsto 1$, $p \\mapsto 2$, $s \\mapsto 3$。由于最优变量是 $s$，对应的代码是 $3$。", "answer": "$$\\boxed{3}$$", "id": "3425758"}]}