{"hands_on_practices": [{"introduction": "B-样条是等几何分析的数学基石，其核心在于能够利用 Cox-de Boor 递归公式高效地计算基函数及其导数。本练习 [@problem_id:3393174] 旨在通过一个具体的计算任务，引导你熟悉B-样条基函数、其局部支集特性以及导数的计算方法。掌握这些基本功，是理解后续更复杂的几何表示和分析应用的前提。", "problem": "考虑等几何分析 (IGA)，其中开节点矢量和样条基提供了光滑的高阶试探空间，这些空间通过其多项式结构和局部支集，与谱方法和间断 Galerkin 方法紧密相连。设开节点矢量为 $\\Xi=\\{0,0,0, \\frac{1}{3}, \\frac{2}{3}, 1,1,1\\}$，样条次数为 $p=2$，这样就有 $n = |\\Xi| - p - 1 = 5$ 个二次 $B$-样条基函数 $\\{N_{i,2}(\\xi)\\}_{i=0}^{4}$。从 $B$-样条的 Cox–de Boor 递归公式以及 Greville 横坐标的定义 $\\xi_{i}^{G} = \\frac{1}{p}\\sum_{j=1}^{p} \\xi_{i+j}$ (对于 $i=0,1,\\dots,4$) 出发，完成以下任务：\n\n- 确定在参数位置 $\\xi=\\frac{1}{2}$ 处，哪些索引 $i$ 对应的 $N_{i,2}(\\xi)$ 非零。\n- 计算那些非零基函数的函数值 $N_{i,2}\\!\\left(\\frac{1}{2}\\right)$。\n- 计算那些非零基函数的一阶导数值 $N_{i,2}'\\!\\left(\\frac{1}{2}\\right)$。\n- 计算这些相同索引对应的 Greville 横坐标 $\\xi_{i}^{G}$，并计算 $N_{i,2}(\\xi_{i}^{G})$ 的值。\n\n将您的最终答案表示为单个行向量，按顺序包含：\n对每个非零索引 $i$ 按索引递增顺序排列的 $N_{i,2}\\!\\left(\\frac{1}{2}\\right)$，然后是按相同顺序排列的 $N_{i,2}'\\!\\left(\\frac{1}{2}\\right)$，最后是按相同顺序排列的 $N_{i,2}(\\xi_{i}^{G})$。提供精确值；无需四舍五入。", "solution": "所述问题是有效的。它在科学上基于 B-样条的成熟数学理论，而 B-样条是等几何分析的基础。该问题是适定的，提供了所有必要的信息——节点矢量、样条次数和明确的定义——以得出一个唯一的、可验证的解。术语精确客观。没有矛盾或含糊不清之处。因此，我们可以开始求解。\n\n问题要求在特定情况下计算 B-样条基函数的值、其导数以及在相应 Greville 横坐标处的值。\n给定的样条次数为 $p=2$。\n开节点矢量为 $\\Xi = \\{\\xi_0, \\xi_1, \\xi_2, \\xi_3, \\xi_4, \\xi_5, \\xi_6, \\xi_7\\} = \\{0,0,0, \\frac{1}{3}, \\frac{2}{3}, 1,1,1\\}$。\n基函数的数量为 $n = |\\Xi| - p - 1 = 8 - 2 - 1 = 5$，索引从 $i=0$ 到 $i=4$。\n\nB-样条求值的核心公式是 Cox–de Boor 递归关系：\n$$N_{i,p}(\\xi) = \\frac{\\xi - \\xi_i}{\\xi_{i+p} - \\xi_i} N_{i,p-1}(\\xi) + \\frac{\\xi_{i+p+1} - \\xi}{\\xi_{i+p+1} - \\xi_{i+1}} N_{i+1,p-1}(\\xi)$$\n递归从次数 $p=0$ 开始：\n$$N_{i,0}(\\xi) = \\begin{cases} 1  \\text{如果 } \\xi_i \\le \\xi  \\xi_{i+1} \\\\ 0  \\text{否则} \\end{cases}$$\n如果递归中的分母为零（由于重复节点），则相应的项定义为零。\n\n首先，我们确定在 $\\xi = \\frac{1}{2}$ 处哪些基函数 $N_{i,2}(\\xi)$ 是非零的。B-样条函数 $N_{i,p}(\\xi)$ 具有局部支集，这意味着它仅在区间 $[\\xi_i, \\xi_{i+p+1})$ 上非零。在我们 $p=2$ 的情况下，支集为 $[\\xi_i, \\xi_{i+3})$。我们在 $\\xi = \\frac{1}{2}$ 处检查每个基函数的这个条件：\n- $i=0$：支集为 $[\\xi_0, \\xi_3) = [0, \\frac{1}{3})$。$\\frac{1}{2}$ 不在此区间内。$N_{0,2}(\\frac{1}{2}) = 0$。\n- $i=1$：支集为 $[\\xi_1, \\xi_4) = [0, \\frac{2}{3})$。$\\frac{1}{2}$ 在此区间内。$N_{1,2}(\\frac{1}{2}) \\ne 0$。\n- $i=2$：支集为 $[\\xi_2, \\xi_5) = [0, 1)$。$\\frac{1}{2}$ 在此区间内。$N_{2,2}(\\frac{1}{2}) \\ne 0$。\n- $i=3$：支集为 $[\\xi_3, \\xi_6) = [\\frac{1}{3}, 1)$。$\\frac{1}{2}$ 在此区间内。$N_{3,2}(\\frac{1}{2}) \\ne 0$。\n- $i=4$：支集为 $[\\xi_4, \\xi_7) = [\\frac{2}{3}, 1)$。$\\frac{1}{2}$ 不在此区间内。$N_{4,2}(\\frac{1}{2}) = 0$。\n在 $\\xi = \\frac{1}{2}$ 处产生非零基函数的索引是 $i=1, 2, 3$。\n\n接下来，我们计算 $i=1, 2, 3$ 时 $N_{i,2}(\\frac{1}{2})$ 的值。\n在 $\\xi=\\frac{1}{2}$ 处，我们位于节点区间 $[\\frac{1}{3}, \\frac{2}{3}) = [\\xi_3, \\xi_4)$ 内。因此，对于 $p=0$，只有 $N_{3,0}(\\frac{1}{2}) = 1$，所有其他的 $N_{k,0}(\\frac{1}{2}) = 0$。\n\n对于 $p=1$：\n$N_{2,1}(\\frac{1}{2}) = \\frac{\\frac{1}{2}-\\xi_2}{\\xi_3-\\xi_2}N_{2,0}(\\frac{1}{2}) + \\frac{\\xi_4-\\frac{1}{2}}{\\xi_4-\\xi_3}N_{3,0}(\\frac{1}{2}) = 0 + \\frac{\\frac{2}{3}-\\frac{1}{2}}{\\frac{2}{3}-\\frac{1}{3}}(1) = \\frac{1/6}{1/3} = \\frac{1}{2}$。\n$N_{3,1}(\\frac{1}{2}) = \\frac{\\frac{1}{2}-\\xi_3}{\\xi_4-\\xi_3}N_{3,0}(\\frac{1}{2}) + \\frac{\\xi_5-\\frac{1}{2}}{\\xi_5-\\xi_4}N_{4,0}(\\frac{1}{2}) = \\frac{\\frac{1}{2}-\\frac{1}{3}}{\\frac{2}{3}-\\frac{1}{3}}(1) + 0 = \\frac{1/6}{1/3} = \\frac{1}{2}$。\n所有其他的 $N_{k,1}(\\frac{1}{2})=0$。\n\n对于 $p=2$：\n$N_{1,2}(\\frac{1}{2}) = \\frac{\\frac{1}{2}-\\xi_1}{\\xi_3-\\xi_1}N_{1,1}(\\frac{1}{2}) + \\frac{\\xi_4-\\frac{1}{2}}{\\xi_4-\\xi_2}N_{2,1}(\\frac{1}{2}) = 0 + \\frac{\\frac{2}{3}-\\frac{1}{2}}{\\frac{2}{3}-0}(\\frac{1}{2}) = \\frac{1/6}{2/3}(\\frac{1}{2}) = \\frac{1}{4} \\cdot \\frac{1}{2} = \\frac{1}{8}$。\n$N_{2,2}(\\frac{1}{2}) = \\frac{\\frac{1}{2}-\\xi_2}{\\xi_4-\\xi_2}N_{2,1}(\\frac{1}{2}) + \\frac{\\xi_5-\\frac{1}{2}}{\\xi_5-\\xi_3}N_{3,1}(\\frac{1}{2}) = \\frac{\\frac{1}{2}-0}{\\frac{2}{3}-0}(\\frac{1}{2}) + \\frac{1-\\frac{1}{2}}{1-\\frac{1}{3}}(\\frac{1}{2}) = \\frac{3}{4}(\\frac{1}{2}) + \\frac{1/2}{2/3}(\\frac{1}{2}) = \\frac{3}{8} + \\frac{3}{4}(\\frac{1}{2}) = \\frac{3}{8} + \\frac{3}{8} = \\frac{6}{8} = \\frac{3}{4}$。\n$N_{3,2}(\\frac{1}{2}) = \\frac{\\frac{1}{2}-\\xi_3}{\\xi_5-\\xi_3}N_{3,1}(\\frac{1}{2}) + \\frac{\\xi_6-\\frac{1}{2}}{\\xi_6-\\xi_4}N_{4,1}(\\frac{1}{2}) = \\frac{\\frac{1}{2}-\\frac{1}{3}}{1-\\frac{1}{3}}(\\frac{1}{2}) + 0 = \\frac{1/6}{2/3}(\\frac{1}{2}) = \\frac{1}{4} \\cdot \\frac{1}{2} = \\frac{1}{8}$。\n单位分解性质得到满足：$\\frac{1}{8} + \\frac{6}{8} + \\frac{1}{8} = 1$。\n\n第三，我们计算 $i=1, 2, 3$ 时的一阶导数 $N'_{i,2}(\\frac{1}{2})$。导数的公式为：\n$$N'_{i,p}(\\xi) = p \\left( \\frac{N_{i,p-1}(\\xi)}{\\xi_{i+p} - \\xi_i} - \\frac{N_{i+1,p-1}(\\xi)}{\\xi_{i+p+1} - \\xi_{i+1}} \\right)$$\n对于 $p=2$，我们使用先前计算的 $N_{k,1}(\\frac{1}{2})$ 值。\n$N'_{1,2}(\\frac{1}{2}) = 2 \\left( \\frac{N_{1,1}(\\frac{1}{2})}{\\xi_3-\\xi_1} - \\frac{N_{2,1}(\\frac{1}{2})}{\\xi_4-\\xi_2} \\right) = 2 \\left( \\frac{0}{\\frac{1}{3}-0} - \\frac{1/2}{\\frac{2}{3}-0} \\right) = 2 \\left( -\\frac{1/2}{2/3} \\right) = 2(-\\frac{3}{4}) = -\\frac{3}{2}$。\n$N'_{2,2}(\\frac{1}{2}) = 2 \\left( \\frac{N_{2,1}(\\frac{1}{2})}{\\xi_4-\\xi_2} - \\frac{N_{3,1}(\\frac{1}{2})}{\\xi_5-\\xi_3} \\right) = 2 \\left( \\frac{1/2}{\\frac{2}{3}-0} - \\frac{1/2}{1-\\frac{1}{3}} \\right) = 2 \\left( \\frac{1/2}{2/3} - \\frac{1/2}{2/3} \\right) = 0$。\n$N'_{3,2}(\\frac{1}{2}) = 2 \\left( \\frac{N_{3,1}(\\frac{1}{2})}{\\xi_5-\\xi_3} - \\frac{N_{4,1}(\\frac{1}{2})}{\\xi_6-\\xi_4} \\right) = 2 \\left( \\frac{1/2}{1-\\frac{1}{3}} - \\frac{0}{1-\\frac{2}{3}} \\right) = 2 \\left( \\frac{1/2}{2/3} \\right) = 2(\\frac{3}{4}) = \\frac{3}{2}$。\n导数之和为 $-\\frac{3}{2} + 0 + \\frac{3}{2} = 0$，符合预期。\n\n最后，我们计算 $i=1, 2, 3$ 时的 Greville 横坐标 $\\xi_{i}^{G}$ 并计算 $N_{i,2}(\\xi_{i}^{G})$ 的值。Greville 横坐标的公式是 $\\xi_{i}^{G} = \\frac{1}{p} \\sum_{j=1}^{p} \\xi_{i+j}$。对于 $p=2$，这简化为 $\\xi_{i}^{G} = \\frac{1}{2}(\\xi_{i+1} + \\xi_{i+2})$。\n- 对于 $i=1$：$\\xi_{1}^{G} = \\frac{1}{2}(\\xi_2 + \\xi_3) = \\frac{1}{2}(0 + \\frac{1}{3}) = \\frac{1}{6}$。\n- 对于 $i=2$：$\\xi_{2}^{G} = \\frac{1}{2}(\\xi_3 + \\xi_4) = \\frac{1}{2}(\\frac{1}{3} + \\frac{2}{3}) = \\frac{1}{2}(1) = \\frac{1}{2}$。\n- 对于 $i=3$：$\\xi_{3}^{G} = \\frac{1}{2}(\\xi_4 + \\xi_5) = \\frac{1}{2}(\\frac{2}{3} + 1) = \\frac{1}{2}(\\frac{5}{3}) = \\frac{5}{6}$。\n\n现在我们计算 $N_{i,2}(\\xi_{i}^{G})$ 的值：\n- 对于 $i=2$，我们需要计算 $N_{2,2}(\\xi_{2}^{G}) = N_{2,2}(\\frac{1}{2})$，我们已经计算出其值为 $\\frac{3}{4}$。\n\n- 对于 $i=1$，我们需要计算 $N_{1,2}(\\xi_1^G) = N_{1,2}(\\frac{1}{6})$。点 $\\xi=\\frac{1}{6}$ 位于 $[\\xi_2, \\xi_3) = [0, \\frac{1}{3})$ 内，因此 $N_{2,0}(\\frac{1}{6})=1$。\n对于 $p=1$：\n$N_{1,1}(\\frac{1}{6}) = \\frac{\\xi_3-\\frac{1}{6}}{\\xi_3-\\xi_2}N_{2,0}(\\frac{1}{6}) = \\frac{\\frac{1}{3}-\\frac{1}{6}}{\\frac{1}{3}-0}(1) = \\frac{1/6}{1/3} = \\frac{1}{2}$。\n$N_{2,1}(\\frac{1}{6}) = \\frac{\\frac{1}{6}-\\xi_2}{\\xi_3-\\xi_2}N_{2,0}(\\frac{1}{6}) = \\frac{\\frac{1}{6}-0}{\\frac{1}{3}-0}(1) = \\frac{1/6}{1/3} = \\frac{1}{2}$。\n对于 $p=2$：\n$N_{1,2}(\\frac{1}{6}) = \\frac{\\frac{1}{6}-\\xi_1}{\\xi_3-\\xi_1}N_{1,1}(\\frac{1}{6}) + \\frac{\\xi_4-\\frac{1}{6}}{\\xi_4-\\xi_2}N_{2,1}(\\frac{1}{6}) = \\frac{\\frac{1}{6}-0}{\\frac{1}{3}-0}(\\frac{1}{2}) + \\frac{\\frac{2}{3}-\\frac{1}{6}}{\\frac{2}{3}-0}(\\frac{1}{2}) = \\frac{1}{2}(\\frac{1}{2}) + \\frac{3/6}{2/3}(\\frac{1}{2}) = \\frac{1}{4} + \\frac{1/2}{2/3}(\\frac{1}{2}) = \\frac{1}{4} + \\frac{3}{4}(\\frac{1}{2}) = \\frac{1}{4} + \\frac{3}{8} = \\frac{5}{8}$。\n\n- 对于 $i=3$，我们需要计算 $N_{3,2}(\\xi_3^G) = N_{3,2}(\\frac{5}{6})$。节点矢量关于 $\\xi=\\frac{1}{2}$ 对称。基函数表现出对称性：$N_{i,p}(\\xi) = N_{n-1-i,p}(1-\\xi)$，其中 $n=5$ 是基函数的数量。因此，$N_{3,2}(\\frac{5}{6}) = N_{5-1-3,2}(1-\\frac{5}{6}) = N_{1,2}(\\frac{1}{6})$。我们刚刚计算出这个值为 $\\frac{5}{8}$。\n\n$i=1, 2, 3$ 时 $N_{i,2}(\\xi_i^G)$ 的结果是 $\\frac{5}{8}$、$\\frac{3}{4}$ 和 $\\frac{5}{8}$。\n\n我们现在按要求组合最终答案。向量将包含：\n1. $i=1,2,3$ 时的 $N_{i,2}(\\frac{1}{2})$：$\\frac{1}{8}, \\frac{3}{4}, \\frac{1}{8}$。\n2. $i=1,2,3$ 时的 $N'_{i,2}(\\frac{1}{2})$：$-\\frac{3}{2}, 0, \\frac{3}{2}$。\n3. $i=1,2,3$ 时的 $N_{i,2}(\\xi_{i}^{G})$：$\\frac{5}{8}, \\frac{3}{4}, \\frac{5}{8}$。\n\n最终的行向量按指定顺序连接这些结果。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{8}  \\frac{3}{4}  \\frac{1}{8}  -\\frac{3}{2}  0  \\frac{3}{2}  \\frac{5}{8}  \\frac{3}{4}  \\frac{5}{8}\n\\end{pmatrix}\n}\n$$", "id": "3393174"}, {"introduction": "等几何分析的关键优势之一是采用与计算机辅助设计（CAD）相同的非均匀有理B样条（NURBS）基函数来表示几何和逼近物理场，从而实现两者的无缝集成。本练习 [@problem_id:3393171] 将通过构建一个精确的圆弧来展示NURBS的强大几何表示能力。你将计算有理基函数、几何映射点及其雅可比行列式，从而深入理解参数空间与物理空间之间的转换关系，这是在复杂几何上进行分析计算的基础。", "problem": "在等几何分析中，非均匀有理B样条（NURBS）能够精确表示二次曲线几何，同时为基于样条的计算机辅助设计与谱元法、间断Galerkin方法（DGM）等高阶方法之间架起了直接的桥梁。考虑一个用作高阶单元边界段的二次有理Bézier曲线（NURBS曲线的一种特例）。该曲线由 $3$ 个控制点 $\\{(R,0),(R,R),(0,R)\\}$、相应的权重 $\\{1,\\tfrac{1}{\\sqrt{2}},1\\}$ 和半径 $R=1$ 定义。参数坐标为 $\\xi \\in [0,1]$。从以下基本定义出发：\n- 二次Bernstein多项式 $B_{0}(\\xi)=(1-\\xi)^{2}$，$B_{1}(\\xi)=2\\xi(1-\\xi)$，$B_{2}(\\xi)=\\xi^{2}$，\n- 有理基函数 $R_{i}(\\xi)=\\dfrac{w_{i}B_{i}(\\xi)}{\\sum_{j=0}^{2}w_{j}B_{j}(\\xi)}$，\n- 几何映射 $\\mathbf{C}(\\xi)=\\sum_{i=0}^{2}R_{i}(\\xi)\\mathbf{P}_{i}$，\n- 以及一维雅可比行列式 $J(\\xi)=\\left\\|\\dfrac{d\\mathbf{C}}{d\\xi}(\\xi)\\right\\|$，\n计算在参数值 $\\xi=\\tfrac{1}{2}$ 处：\n$1)$ NURBS基函数的值 $R_{0}(\\tfrac{1}{2})$，$R_{1}(\\tfrac{1}{2})$，$R_{2}(\\tfrac{1}{2})$，\n$2)$ 映射后的物理点 $\\mathbf{C}(\\tfrac{1}{2})$，\n$3)$ 雅可比行列式 $J(\\tfrac{1}{2})$。\n所有结果均需以简化的根式形式精确表示。请勿提供任何小数近似值。最终答案必须是一个单行矩阵，依次包含 $R_{0}(\\tfrac{1}{2})$，$R_{1}(\\tfrac{1}{2})$，$R_{2}(\\tfrac{1}{2})$，$\\mathbf{C}(\\tfrac{1}{2})$ 的x坐标，$\\mathbf{C}(\\tfrac{1}{2})$ 的y坐标，以及 $J(\\tfrac{1}{2})$。", "solution": "该问题是适定的，其科学基础在于等几何分析和非均匀有理B样条（NURBS）理论，并为求得唯一解提供了所有必要信息。我们开始进行计算。\n\n给定的参数如下：\n控制点：$\\mathbf{P}_{0}=\\{R,0\\}$, $\\mathbf{P}_{1}=\\{R,R\\}$, $\\mathbf{P}_{2}=\\{0,R\\}$\n权重：$w_{0}=1$, $w_{1}=\\tfrac{1}{\\sqrt{2}}$, $w_{2}=1$\n半径：$R=1$\n关注的参数坐标：$\\xi=\\tfrac{1}{2}$\n\n当 $R=1$ 时，控制点变为 $\\mathbf{P}_{0}=\\{1,0\\}$, $\\mathbf{P}_{1}=\\{1,1\\}$, $\\mathbf{P}_{2}=\\{0,1\\}$。\n\n二次Bernstein多项式定义为：\n$B_{0}(\\xi)=(1-\\xi)^{2}$\n$B_{1}(\\xi)=2\\xi(1-\\xi)$\n$B_{2}(\\xi)=\\xi^{2}$\n\n首先，我们计算这些基函数在 $\\xi=\\tfrac{1}{2}$ 处的值：\n$B_{0}(\\tfrac{1}{2})=(1-\\tfrac{1}{2})^{2} = (\\tfrac{1}{2})^{2} = \\tfrac{1}{4}$\n$B_{1}(\\tfrac{1}{2})=2(\\tfrac{1}{2})(1-\\tfrac{1}{2}) = 1 \\cdot \\tfrac{1}{2} = \\tfrac{1}{2}$\n$B_{2}(\\tfrac{1}{2})=(\\tfrac{1}{2})^{2} = \\tfrac{1}{4}$\n\n有理基函数的分母 $W(\\xi) = \\sum_{j=0}^{2}w_{j}B_{j}(\\xi)$ 在 $\\xi=\\tfrac{1}{2}$ 处的值计算如下：\n$W(\\tfrac{1}{2}) = w_{0}B_{0}(\\tfrac{1}{2}) + w_{1}B_{1}(\\tfrac{1}{2}) + w_{2}B_{2}(\\tfrac{1}{2})$\n$W(\\tfrac{1}{2}) = (1)(\\tfrac{1}{4}) + (\\tfrac{1}{\\sqrt{2}})(\\tfrac{1}{2}) + (1)(\\tfrac{1}{4}) = \\tfrac{1}{4} + \\tfrac{1}{2\\sqrt{2}} + \\tfrac{1}{4} = \\tfrac{1}{2} + \\tfrac{\\sqrt{2}}{4} = \\dfrac{2+\\sqrt{2}}{4}$\n\n1) 现在我们计算NURBS基函数 $R_{i}(\\xi)=\\dfrac{w_{i}B_{i}(\\xi)}{W(\\xi)}$ 在 $\\xi=\\tfrac{1}{2}$ 处的值。\n\n对于 $i=0$：\n$R_{0}(\\tfrac{1}{2}) = \\dfrac{w_{0}B_{0}(\\tfrac{1}{2})}{W(\\tfrac{1}{2})} = \\dfrac{(1)(\\tfrac{1}{4})}{\\tfrac{2+\\sqrt{2}}{4}} = \\dfrac{1}{2+\\sqrt{2}} = \\dfrac{1}{2+\\sqrt{2}} \\cdot \\dfrac{2-\\sqrt{2}}{2-\\sqrt{2}} = \\dfrac{2-\\sqrt{2}}{4-2} = \\dfrac{2-\\sqrt{2}}{2} = 1-\\dfrac{\\sqrt{2}}{2}$\n\n对于 $i=1$：\n$R_{1}(\\tfrac{1}{2}) = \\dfrac{w_{1}B_{1}(\\tfrac{1}{2})}{W(\\tfrac{1}{2})} = \\dfrac{(\\tfrac{1}{\\sqrt{2}})(\\tfrac{1}{2})}{\\tfrac{2+\\sqrt{2}}{4}} = \\dfrac{\\tfrac{1}{2\\sqrt{2}}}{\\tfrac{2+\\sqrt{2}}{4}} = \\dfrac{1}{2\\sqrt{2}}\\cdot\\dfrac{4}{2+\\sqrt{2}} = \\dfrac{2}{\\sqrt{2}(2+\\sqrt{2})} = \\dfrac{\\sqrt{2}}{2+\\sqrt{2}}$\n分母有理化：\n$R_{1}(\\tfrac{1}{2}) = \\dfrac{\\sqrt{2}(2-\\sqrt{2})}{(2+\\sqrt{2})(2-\\sqrt{2})} = \\dfrac{2\\sqrt{2}-2}{4-2} = \\dfrac{2(\\sqrt{2}-1)}{2} = \\sqrt{2}-1$\n\n对于 $i=2$：\n由于对称性（$w_0=w_2$ 且 $B_0(1/2)=B_2(1/2)$），我们有 $R_{2}(\\tfrac{1}{2}) = R_{0}(\\tfrac{1}{2})$。\n$R_{2}(\\tfrac{1}{2}) = \\dfrac{w_{2}B_{2}(\\tfrac{1}{2})}{W(\\tfrac{1}{2})} = \\dfrac{(1)(\\tfrac{1}{4})}{\\tfrac{2+\\sqrt{2}}{4}} = 1-\\dfrac{\\sqrt{2}}{2}$\n\n2) 接下来，我们计算映射后的物理点 $\\mathbf{C}(\\xi)=\\sum_{i=0}^{2}R_{i}(\\xi)\\mathbf{P}_{i}$ 在 $\\xi=\\tfrac{1}{2}$ 处的值。\n$\\mathbf{C}(\\tfrac{1}{2}) = R_{0}(\\tfrac{1}{2})\\mathbf{P}_{0} + R_{1}(\\tfrac{1}{2})\\mathbf{P}_{1} + R_{2}(\\tfrac{1}{2})\\mathbf{P}_{2}$\n$\\mathbf{C}(\\tfrac{1}{2}) = (1-\\dfrac{\\sqrt{2}}{2})\\{1,0\\} + (\\sqrt{2}-1)\\{1,1\\} + (1-\\dfrac{\\sqrt{2}}{2})\\{0,1\\}$\nx坐标 $C_x$ 为：\n$C_x(\\tfrac{1}{2}) = (1-\\dfrac{\\sqrt{2}}{2})(1) + (\\sqrt{2}-1)(1) + (1-\\dfrac{\\sqrt{2}}{2})(0) = 1-\\dfrac{\\sqrt{2}}{2} + \\sqrt{2}-1 = \\dfrac{\\sqrt{2}}{2}$\ny坐标 $C_y$ 为：\n$C_y(\\tfrac{1}{2}) = (1-\\dfrac{\\sqrt{2}}{2})(0) + (\\sqrt{2}-1)(1) + (1-\\dfrac{\\sqrt{2}}{2})(1) = \\sqrt{2}-1 + 1-\\dfrac{\\sqrt{2}}{2} = \\dfrac{\\sqrt{2}}{2}$\n因此，该点为 $\\mathbf{C}(\\tfrac{1}{2}) = \\{\\dfrac{\\sqrt{2}}{2}, \\dfrac{\\sqrt{2}}{2}\\}$。正如对圆弧的NURBS表示所预期的那样，该点位于单位圆上。\n\n3) 最后，我们计算雅可比行列式 $J(\\xi)=\\left\\|\\dfrac{d\\mathbf{C}}{d\\xi}(\\xi)\\right\\|$ 在 $\\xi=\\tfrac{1}{2}$ 处的值。\n几何映射是一个有理函数 $\\mathbf{C}(\\xi) = \\dfrac{\\mathbf{A}(\\xi)}{W(\\xi)}$，其中 $\\mathbf{A}(\\xi) = \\sum_{i=0}^{2}w_{i}B_{i}(\\xi)\\mathbf{P}_{i}$。\n其导数由商法则给出：$\\dfrac{d\\mathbf{C}}{d\\xi} = \\dfrac{\\mathbf{A}'(\\xi)W(\\xi) - \\mathbf{A}(\\xi)W'(\\xi)}{[W(\\xi)]^2}$。\n我们需要Bernstein多项式的导数：\n$B'_{0}(\\xi) = -2(1-\\xi)$，$B'_{1}(\\xi) = 2-4\\xi$，$B'_{2}(\\xi) = 2\\xi$。\n在 $\\xi=\\tfrac{1}{2}$ 处：\n$B'_{0}(\\tfrac{1}{2}) = -1$，$B'_{1}(\\tfrac{1}{2}) = 0$，$B'_{2}(\\tfrac{1}{2}) = 1$。\n\n现在，我们求 $W'(\\tfrac{1}{2})$ 和 $\\mathbf{A}'(\\tfrac{1}{2})$：\n$W'(\\xi) = w_{0}B'_{0}(\\xi) + w_{1}B'_{1}(\\xi) + w_{2}B'_{2}(\\xi) = 1(-2(1-\\xi)) + \\tfrac{1}{\\sqrt{2}}(2-4\\xi) + 1(2\\xi)$\n$W'(\\tfrac{1}{2}) = -2(1-\\tfrac{1}{2}) + \\tfrac{1}{\\sqrt{2}}(2-4(\\tfrac{1}{2})) + 2(\\tfrac{1}{2}) = -1 + \\tfrac{1}{\\sqrt{2}}(0) + 1 = 0$。\n由于 $W'(\\tfrac{1}{2})=0$，导数被显著简化为：$\\dfrac{d\\mathbf{C}}{d\\xi}(\\tfrac{1}{2}) = \\dfrac{\\mathbf{A}'(\\tfrac{1}{2})}{W(\\tfrac{1}{2})}$。\n\n$\\mathbf{A}'(\\xi) = \\sum_{i=0}^{2}w_{i}B'_{i}(\\xi)\\mathbf{P}_{i}$\n$\\mathbf{A}'(\\tfrac{1}{2}) = w_{0}B'_{0}(\\tfrac{1}{2})\\mathbf{P}_{0} + w_{1}B'_{1}(\\tfrac{1}{2})\\mathbf{P}_{1} + w_{2}B'_{2}(\\tfrac{1}{2})\\mathbf{P}_{2}$\n$\\mathbf{A}'(\\tfrac{1}{2}) = (1)(-1)\\{1,0\\} + (\\tfrac{1}{\\sqrt{2}})(0)\\{1,1\\} + (1)(1)\\{0,1\\} = \\{-1,0\\} + \\{0,0\\} + \\{0,1\\} = \\{-1,1\\}$。\n\n现在我们计算切向量：\n$\\dfrac{d\\mathbf{C}}{d\\xi}(\\tfrac{1}{2}) = \\dfrac{\\{-1,1\\}}{W(\\tfrac{1}{2})} = \\dfrac{\\{-1,1\\}}{\\tfrac{2+\\sqrt{2}}{4}} = \\dfrac{4}{2+\\sqrt{2}}\\{-1,1\\}$。\n简化标量因子：\n$\\dfrac{4}{2+\\sqrt{2}} = \\dfrac{4(2-\\sqrt{2})}{(2+\\sqrt{2})(2-\\sqrt{2})} = \\dfrac{4(2-\\sqrt{2})}{4-2} = 2(2-\\sqrt{2}) = 4-2\\sqrt{2}$。\n因此，$\\dfrac{d\\mathbf{C}}{d\\xi}(\\tfrac{1}{2}) = (4-2\\sqrt{2})\\{-1,1\\} = \\{-4+2\\sqrt{2}, 4-2\\sqrt{2}\\}$。\n\n雅可比行列式是该向量的欧几里得范数（模）：\n$J(\\tfrac{1}{2}) = \\left\\| \\{-4+2\\sqrt{2}, 4-2\\sqrt{2}\\} \\right\\| = \\sqrt{(-4+2\\sqrt{2})^{2} + (4-2\\sqrt{2})^{2}}$。\n因为 $(-x)^2 = x^2$，所以：\n$J(\\tfrac{1}{2}) = \\sqrt{2(4-2\\sqrt{2})^{2}} = \\sqrt{2}|4-2\\sqrt{2}|$。\n由于 $4 = \\sqrt{16}$ 且 $2\\sqrt{2} = \\sqrt{8}$，我们有 $4  2\\sqrt{2}$，所以绝对值为正。\n$J(\\tfrac{1}{2}) = \\sqrt{2}(4-2\\sqrt{2}) = 4\\sqrt{2} - 2(\\sqrt{2})^2 = 4\\sqrt{2}-4$。\n\n最终结果是：\n$R_{0}(\\tfrac{1}{2}) = 1-\\dfrac{\\sqrt{2}}{2}$\n$R_{1}(\\tfrac{1}{2}) = \\sqrt{2}-1$\n$R_{2}(\\tfrac{1}{2}) = 1-\\dfrac{\\sqrt{2}}{2}$\n$\\mathbf{C}(\\tfrac{1}{2}) = \\{\\dfrac{\\sqrt{2}}{2}, \\dfrac{\\sqrt{2}}{2}\\}$\n$J(\\tfrac{1}{2}) = 4\\sqrt{2}-4$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1-\\frac{\\sqrt{2}}{2}  \\sqrt{2}-1  1-\\frac{\\sqrt{2}}{2}  \\frac{\\sqrt{2}}{2}  \\frac{\\sqrt{2}}{2}  4\\sqrt{2}-4\n\\end{pmatrix}\n}\n$$", "id": "3393171"}, {"introduction": "将样条基函数应用于求解偏微分方程是等几何分析的核心环节，这与传统有限元法（FEM）在思想上是一致的，即通过构建刚度矩阵来离散化控制方程。然而，IGA使用具有更高阶连续性的样条基函数，这带来了独特的优势和挑战。本练习 [@problem_id:3393185] 要求你为一个一维问题组装全局刚度矩阵，并将其矩阵结构与标准 $C^0$ 有限元进行比较，从而直观地揭示高连续性基函数对数值求解系统性质的影响。", "problem": "考虑一维泊松算子的对称强制双线性形式，定义为 $a(u,v) = \\int_{0}^{1} u'(x)\\,v'(x)\\,dx$，作用于区间 $[0,1]$ 上。\n\nA部分（等几何分析）。在均匀开放节点矢量 $U = \\{0,0,0,\\tfrac{1}{2},1,1,1\\}$ 上使用二次B样条进行等几何分析 (IGA)。该节点矢量对应于 $[0,1]$ 上的两个相等节点区间，多项式次数为 $p=2$，内部连续性为 $C^{1}$。令 $\\{N_{i,2}(x)\\}_{i=0}^{3}$ 表示按节点索引非递减排序的二次B样条基。定义全局刚度矩阵 $K \\in \\mathbb{R}^{4 \\times 4}$ 为\n$$K_{ij} = \\int_{0}^{1} N_{i,2}'(x)\\,N_{j,2}'(x)\\,dx.$$\n请显式计算 $K$ 的所有非零元。\n\nB部分（经典 $C^{0}$ 二次有限元）。考虑在 $[0,1]$ 上划分为两个均匀单元的相同分割上使用标准的 $C^{0}$ 二次拉格朗日有限元方法 (FEM)，其节点位于 $x=0, x=\\tfrac{1}{2}, x=1$，中点位于 $x=\\tfrac{1}{4}, x=\\tfrac{3}{4}$，按坐标递增排序为 $\\{0,\\tfrac{1}{4},\\tfrac{1}{2},\\tfrac{3}{4},1\\}$。令 $K^{\\mathrm{FEM}} \\in \\mathbb{R}^{5 \\times 5}$ 表示由相同双线性形式 $a(\\cdot,\\cdot)$ 的单元矩阵组装而成的相应全局刚度矩阵。\n\n带宽的定义。对于一个对称矩阵 $A \\in \\mathbb{R}^{n\\times n}$，定义其带宽 $B(A)$ 为非零对角线的总数，即：\n$$B(A) = 2\\,\\beta(A) - 1,\\quad \\beta(A) = 1 + \\max\\{\\,i-j \\;:\\; A_{ij} \\neq 0,\\ i \\ge j\\,\\}.$$\n\nC部分（比较）。确定如上定义的 $B(K)$ 和 $B(K^{\\mathrm{FEM}})$，并给出比值\n$$\\frac{B(K)}{B(K^{\\mathrm{FEM}})}.$$\n\n以单个实数的形式给出最终答案。无需四舍五入，不涉及单位。", "solution": "该问题被评估为有效，因为它是自洽的，在数值分析领域有科学依据，并且是适定的。因此，我们可以进行完整的解答。\n\n该问题要求比较由等几何分析 (IGA) 和标准有限元方法 (FEM) 求解一维泊松问题所产生的刚度矩阵的带宽。双线性形式由 $a(u,v) = \\int_{0}^{1} u'(x)\\,v'(x)\\,dx$ 给出。\n\nA部分：等几何分析刚度矩阵 $K$\n\nIGA 基于开放节点矢量 $U = \\{0,0,0,\\frac{1}{2},1,1,1\\}$ 上的二次B样条 ($p=2$)。该节点矢量有 $m+1=7$ 个节点，因此 $m=6$。对于多项式次数 $p=2$，基函数的数量为 $n+1$，其中 $m=n+p+1$。这得出 $6=n+2+1$，因此 $n=3$，这意味着有 4 个基函数，记为 $\\{N_{i,2}(x)\\}_{i=0}^{3}$。内部节点 $\\tfrac{1}{2}$ 的重复度为 1，这确保了 $C^{p-1} = C^1$ 的连续性。\n\nB样条基函数 $N_{i,2}(x)$ 可以使用 Cox-de Boor 递归公式导出。对于给定的节点矢量，它们在节点区间 $[0, \\frac{1}{2}]$ 和 $[\\frac{1}{2}, 1]$ 上是分段定义的。\n四个基函数是：\n$N_{0,2}(x) = \\begin{cases} (1-2x)^2  x \\in [0, \\frac{1}{2}] \\\\ 0  x \\in [\\frac{1}{2}, 1] \\end{cases}$\n$N_{1,2}(x) = \\begin{cases} 4x-6x^2  x \\in [0, \\frac{1}{2}] \\\\ 2(1-x)^2  x \\in [\\frac{1}{2}, 1] \\end{cases}$\n$N_{2,2}(x) = \\begin{cases} 2x^2  x \\in [0, \\frac{1}{2}] \\\\ -6x^2+8x-2  x \\in [\\frac{1}{2}, 1] \\end{cases}$\n$N_{3,2}(x) = \\begin{cases} 0  x \\in [0, \\frac{1}{2}] \\\\ (2x-1)^2  x \\in [\\frac{1}{2}, 1] \\end{cases}$\n\n导数 $N'_{i,2}(x)$ 是：\n$N'_{0,2}(x) = \\begin{cases} -4(1-2x)  x \\in [0, \\frac{1}{2}] \\\\ 0  x \\in [\\frac{1}{2}, 1] \\end{cases}$\n$N'_{1,2}(x) = \\begin{cases} 4-12x  x \\in [0, \\frac{1}{2}] \\\\ -4(1-x)  x \\in [\\frac{1}{2}, 1] \\end{cases}$\n$N'_{2,2}(x) = \\begin{cases} 4x  x \\in [0, \\frac{1}{2}] \\\\ -12x+8  x \\in [\\frac{1}{2}, 1] \\end{cases}$\n$N'_{3,2}(x) = \\begin{cases} 0  x \\in [0, \\frac{1}{2}] \\\\ 4(2x-1)  x \\in [\\frac{1}{2}, 1] \\end{cases}$\n\n刚度矩阵的元 $K_{ij} = \\int_{0}^{1} N'_{i,2}(x)\\,N'_{j,2}(x)\\,dx$ 计算如下。矩阵 $K$ 是对称的，所以我们计算 $i \\le j$ 的元。\n$K_{00} = \\int_0^{1/2} (-4(1-2x))^2 dx = 16 \\int_0^{1/2} (1-4x+4x^2) dx = 16[x-2x^2+\\frac{4}{3}x^3]_0^{1/2} = \\frac{8}{3}$。\n$K_{01} = \\int_0^{1/2} -4(1-2x)(4-12x) dx = -16 \\int_0^{1/2} (1-5x+6x^2)dx = -16[x-\\frac{5}{2}x^2+2x^3]_0^{1/2} = -2$。\n$K_{02} = \\int_0^{1/2} -4(1-2x)(4x) dx = -16 \\int_0^{1/2} (x-2x^2)dx = -16[\\frac{x^2}{2}-\\frac{2x^3}{3}]_0^{1/2} = -16(\\frac{1}{24}) = -\\frac{2}{3}$。\n$K_{03} = \\int_0^1 N'_{0,2}N'_{3,2} dx = 0$，因为它们的支集仅在一个点上相交。\n\n$K_{11} = \\int_0^{1/2} (4-12x)^2 dx + \\int_{1/2}^1 (-4(1-x))^2 dx = 2 + \\frac{2}{3} = \\frac{8}{3}$。\n$K_{12} = \\int_0^{1/2} (4-12x)(4x)dx + \\int_{1/2}^1 (-4(1-x))(-12x+8)dx = [8x^2-16x^3]_0^{1/2} + 16[-x^3+\\frac{5}{2}x^2-2x]_{1/2}^1 = 0+0 = 0$。\n$K_{13} = \\int_{1/2}^1 (-4(1-x))(4(2x-1))dx = -16\\int_{1/2}^1(-2x^2+3x-1)dx = -16[-\\frac{2}{3}x^3+\\frac{3}{2}x^2-x]_{1/2}^1 = -16(\\frac{1}{24}) = -\\frac{2}{3}$。\n\n$K_{22} = \\int_0^{1/2} (4x)^2 dx + \\int_{1/2}^1 (-12x+8)^2 dx = \\frac{2}{3} + 2 = \\frac{8}{3}$。\n根据基函数的对称性 ($N_{i,2}(x)=N_{n-i,2}(1-x)$ 对于 $n=3$)，我们有 $K_{ij}=K_{n-j,n-i}$。\n$K_{23} = K_{3-3,3-2} = K_{01} = -2$。\n$K_{33} = K_{3-3,3-3} = K_{00} = \\frac{8}{3}$。\n\n完整的刚度矩阵 $K \\in \\mathbb{R}^{4 \\times 4}$ 是：\n$$ K = \\begin{pmatrix} \\frac{8}{3}  -2  -\\frac{2}{3}  0 \\\\ -2  \\frac{8}{3}  0  -\\frac{2}{3} \\\\ -\\frac{2}{3}  0  \\frac{8}{3}  -2 \\\\ 0  -\\frac{2}{3}  -2  \\frac{8}{3} \\end{pmatrix} $$\n非零元已被显式计算。\n\nB部分：标准 $C^0$ 二次有限元刚度矩阵 $K^{\\mathrm{FEM}}$\n\n有限元法在相同的分割 $[0, \\frac{1}{2}]$ 和 $[\\frac{1}{2}, 1]$ 上使用 $C^0$ 二次单元。\n全局节点为 $\\{0, \\frac{1}{4}, \\frac{1}{2}, \\frac{3}{4}, 1\\}$，从 0 到 4 编号。这会得到一个 $5\\times 5$ 的矩阵 $K^{\\mathrm{FEM}}$。单元 1 连接节点 $\\{0,1,2\\}$。单元 2 连接节点 $\\{2,3,4\\}$。\n一个元 $K^{\\mathrm{FEM}}_{ij}$ 非零，当且仅当节点 $i$ 和 $j$ 属于同一单元。\n$K^{\\mathrm{FEM}}$ 的结构在索引为 $\\{0,1,2\\}$ 的 $3\\times 3$ 块和索引为 $\\{2,3,4\\}$ 的另一个 $3 \\times 3$ 块中具有非零元。示意图如下：\n$$ K^{\\mathrm{FEM}} = \\begin{pmatrix} *  *  *  0  0 \\\\ *  *  *  0  0 \\\\ *  *  *  *  * \\\\ 0  0  *  *  * \\\\ 0  0  *  *  * \\end{pmatrix} $$\n其中 $*$ 表示一个非零元。\n\nC部分：带宽比较\n\n带宽 $B(A)$ 定义为 $B(A) = 2\\,\\beta(A) - 1$，其中 $\\beta(A) = 1 + \\max\\{\\,i-j \\;:\\; A_{ij} \\neq 0,\\ i \\ge j\\,\\}$。项 $b = \\max\\{\\,i-j \\;:\\; A_{ij} \\neq 0,\\ i \\ge j\\,\\}$ 是非零次对角线的数量。\n\n对于 IGA 矩阵 $K$：\n对于 $i \\ge j$ 的非零元 $K_{ij}$ 位于位置 $(1,0)$, $(2,0)$, $(2,2)$, $(3,1)$, $(3,2)$, $(3,3)$。注意到 $K_{21}=K_{12}=0$。\n对于这些非零的非对角元，差值 $i-j$ 为 $1-0=1, 2-0=2, 3-1=2, 3-2=1$。\n最大差值为 $\\max\\{1,2\\} = 2$。\n所以，$\\beta(K) = 1 + 2 = 3$。\n带宽为 $B(K) = 2 \\times 3 - 1 = 5$。\n\n对于 FEM 矩阵 $K^{\\mathrm{FEM}}$：\n对于 $i \\ge j$ 的非零元 $K^{\\mathrm{FEM}}_{ij}$ 对应于一个单元内的节点对。\n对于单元 1：节点对为 $(1,0), (2,0), (2,1)$，差值为 $1, 2, 1$。\n对于单元 2：节点对为 $(3,2), (4,2), (4,3)$，差值为 $1, 2, 1$。\n最大差值为 $\\max\\{1,2\\} = 2$。\n所以，$\\beta(K^{\\mathrm{FEM}}) = 1 + 2 = 3$。\n带宽为 $B(K^{\\mathrm{FEM}}) = 2 \\times 3 - 1 = 5$。\n\n最后，带宽的比值为：\n$$\\frac{B(K)}{B(K^{\\mathrm{FEM}})} = \\frac{5}{5} = 1.$$\n对于这个特定的 IGA 和 FEM 设置，刚度矩阵的带宽是相同的。", "answer": "$$\\boxed{1}$$", "id": "3393185"}]}