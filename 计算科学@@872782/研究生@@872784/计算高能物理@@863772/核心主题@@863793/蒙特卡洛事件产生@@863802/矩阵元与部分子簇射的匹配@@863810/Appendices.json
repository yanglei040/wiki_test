{"hands_on_practices": [{"introduction": "许多匹配方案（如CKKW方法）的基石，是能够根据固定阶矩阵元计算的末态部分子来重建一个合理的簇射历史。本练习将引导您逆向应用喷注算法来完成这一过程。通过计算Durham $k_\\perp$距离并进行顺序聚类，您将确定出事件的发射标度，这对于后续使用正确的运行耦合常数和Sudakov形状因子进行重加权至关重要 [@problem_id:3521642]。", "problem": "考虑在质心能量 $\\sqrt{s} = 100~\\mathrm{GeV}$ 下的正负电子湮没过程，产生四个无质量的部分子，分别为一个夸克 $q$、一个反夸克 $\\bar{q}$ 和两个胶子 $g$。在质心系中，该事件由以下四动量（单位为 $\\mathrm{GeV}$）指定，其顺序为 $p^{\\mu} = (E, p_x, p_y, p_z)$:\n- $p_1$ (夸克): $p_1 = \\left(\\frac{187}{5},\\, 0,\\, 0,\\, \\frac{187}{5}\\right)$，\n- $p_2$ (反夸克): $p_2 = \\left(\\frac{208}{5},\\, 0,\\, 0,\\, -\\frac{208}{5}\\right)$，\n- $p_3$ (胶子): $p_3 = \\left(12,\\, \\frac{36}{5},\\, 0,\\, \\frac{48}{5}\\right)$，\n- $p_4$ (胶子): $p_4 = \\left(9,\\, -\\frac{36}{5},\\, 0,\\, -\\frac{27}{5}\\right)$。\n\n这四个四动量满足总的能量动量守恒，并且每个部分子都在质量壳上。使用Durham $k_{\\perp}$喷注算法（适用于正负电子对撞），其对间距离定义为\n$$\nk_{\\perp,ij}^{2} \\equiv 2\\,\\min\\!\\big(E_i^{2}, E_j^{2}\\big)\\,\\big(1-\\cos\\theta_{ij}\\big),\n$$\n其中 $\\theta_{ij}$ 是部分子 $i$ 和 $j$ 的三动量之间的夹角。使用E方案重组 $p_{ij}^{\\mu} \\equiv p_i^{\\mu} + p_j^{\\mu}$ 进行聚类，迭代地合并具有最小 $k_{\\perp,ij}^{2}$ 的对，直到剩下两个赝喷注。将用于Catani–Krauss–Kuhn–Webber (CKKW)重加权的发射标度定义为与每次聚类相关联的 $k_{\\perp}$ 值（即每次合并步骤中 $k_{\\perp,ij}^{2}$ 的平方根）。\n\n对于一个简化的类CKKW耦合重加权，定义权重\n$$\nW \\equiv \\frac{\\alpha_s\\!\\big(k_{\\perp,1}\\big)\\,\\alpha_s\\!\\big(k_{\\perp,2}\\big)}{\\alpha_s\\!\\big(\\mu_0\\big)^{2}},\n$$\n其中 $\\mu_0 = 10~\\mathrm{GeV}$，$\\alpha_s(Q)$ 是具有 $n_f = 5$ 种轻味的单圈量子色动力学（QCD）跑动耦合常数，\n$$\n\\alpha_s(Q) = \\frac{4\\pi}{\\beta_0\\,\\ln\\!\\big(Q^{2}/\\Lambda^{2}\\big)}, \\quad \\beta_0 = 11 - \\frac{2}{3}n_f, \\quad \\Lambda = 0.2~\\mathrm{GeV}.\n$$\n\n从上述定义和给定的四动量出发，完成以下任务：\n1. 计算初始集合 $\\{1,2,3,4\\}$ 的所有对间Durham距离 $k_{\\perp,ij}^{2}$，并找出值最小的对。使用E方案重组合并该对，并记录第一个发射标度 $k_{\\perp,1}$。\n2. 重新计算生成的包含三个对象的集合中的距离，并找出下一个要合并的对。执行重组并记录第二个发射标度 $k_{\\perp,2}$。当剩下两个赝喷注时停止。\n3. 使用记录的发射标度，计算权重 $W$。\n\n将 $W$ 的最终数值表示为一个无量纲数，并将答案四舍五入到四位有效数字。", "solution": "问题陈述已经过验证，是自洽的、有科学依据且良定的。所提供的四动量在质心系中满足无质量部分子的在壳条件和总的能量动量守恒。所有定义和常数在计算高能物理的语境中都是标准的。因此我们可以开始解答。\n\n该问题要求使用Durham $k_{\\perp}$喷注算法对四个部分子进行两步聚类，然后根据聚类过程中找到的发射标度计算一个类CKKW权重。\n\n四个初始的无质量部分子的四动量 $p^{\\mu}=(E, p_x, p_y, p_z)$ 以 $\\mathrm{GeV}$ 为单位给出：\n- $p_1 = (37.4,\\, 0,\\, 0,\\, 37.4)$\n- $p_2 = (41.6,\\, 0,\\, 0,\\, -41.6)$\n- $p_3 = (12,\\, 7.2,\\, 0,\\, 9.6)$\n- $p_4 = (9,\\, -7.2,\\, 0,\\, -5.4)$\n\n对应的能量为 $E_1 = 37.4$, $E_2 = 41.6$, $E_3 = 12$, $E_4 = 9$。由于部分子是无质量的，三动量的模 $|\\vec{p}_i|$ 等于能量 $E_i$。\n\n### 第一步：首次聚类\n我们计算六个对间Durham距离，$k_{\\perp,ij}^{2} = 2\\,\\min(E_i^2, E_j^2)\\,(1-\\cos\\theta_{ij})$，其中 $\\cos\\theta_{ij} = \\frac{\\vec{p}_i \\cdot \\vec{p}_j}{|\\vec{p}_i||\\vec{p}_j|} = \\frac{\\vec{p}_i \\cdot \\vec{p}_j}{E_i E_j}$。\n\n1.  **对 (1,2):** $\\vec{p}_1=(0,0,37.4)$, $\\vec{p}_2=(0,0,-41.6)$。\n    $\\cos\\theta_{12} = \\frac{(37.4)(-41.6)}{(37.4)(41.6)} = -1$。\n    $k_{\\perp,12}^{2} = 2\\,\\min(37.4^2, 41.6^2)\\,(1 - (-1)) = 2 \\cdot (37.4)^2 \\cdot 2 = 4 \\cdot 1398.76 = 5595.04$。\n\n2.  **对 (1,3):** $\\vec{p}_1=(0,0,37.4)$, $\\vec{p}_3=(7.2,0,9.6)$。\n    $\\vec{p}_1 \\cdot \\vec{p}_3 = (37.4)(9.6) = 359.04$。\n    $E_1 E_3 = (37.4)(12) = 448.8$。\n    $\\cos\\theta_{13} = \\frac{359.04}{448.8} = 0.8$。\n    $k_{\\perp,13}^{2} = 2\\,\\min(37.4^2, 12^2)\\,(1 - 0.8) = 2 \\cdot 12^2 \\cdot 0.2 = 2 \\cdot 144 \\cdot 0.2 = 57.6$。\n\n3.  **对 (1,4):** $\\vec{p}_1=(0,0,37.4)$, $\\vec{p}_4=(-7.2,0,-5.4)$。\n    $\\vec{p}_1 \\cdot \\vec{p}_4 = (37.4)(-5.4) = -201.96$。\n    $E_1 E_4 = (37.4)(9) = 336.6$。\n    $\\cos\\theta_{14} = \\frac{-201.96}{336.6} = -0.6$。\n    $k_{\\perp,14}^{2} = 2\\,\\min(37.4^2, 9^2)\\,(1 - (-0.6)) = 2 \\cdot 9^2 \\cdot 1.6 = 2 \\cdot 81 \\cdot 1.6 = 259.2$。\n\n4.  **对 (2,3):** $\\vec{p}_2=(0,0,-41.6)$, $\\vec{p}_3=(7.2,0,9.6)$。\n    $\\vec{p}_2 \\cdot \\vec{p}_3 = (-41.6)(9.6) = -399.36$。\n    $E_2 E_3 = (41.6)(12) = 499.2$。\n    $\\cos\\theta_{23} = \\frac{-399.36}{499.2} = -0.8$。\n    $k_{\\perp,23}^{2} = 2\\,\\min(41.6^2, 12^2)\\,(1 - (-0.8)) = 2 \\cdot 12^2 \\cdot 1.8 = 2 \\cdot 144 \\cdot 1.8 = 518.4$。\n\n5.  **对 (2,4):** $\\vec{p}_2=(0,0,-41.6)$, $\\vec{p}_4=(-7.2,0,-5.4)$。\n    $\\vec{p}_2 \\cdot \\vec{p}_4 = (-41.6)(-5.4) = 224.64$。\n    $E_2 E_4 = (41.6)(9) = 374.4$。\n    $\\cos\\theta_{24} = \\frac{224.64}{374.4} = 0.6$。\n    $k_{\\perp,24}^{2} = 2\\,\\min(41.6^2, 9^2)\\,(1 - 0.6) = 2 \\cdot 9^2 \\cdot 0.4 = 2 \\cdot 81 \\cdot 0.4 = 64.8$。\n\n6.  **对 (3,4):** $\\vec{p}_3=(7.2,0,9.6)$, $\\vec{p}_4=(-7.2,0,-5.4)$。\n    $\\vec{p}_3 \\cdot \\vec{p}_4 = (7.2)(-7.2) + (9.6)(-5.4) = -51.84 - 51.84 = -103.68$。\n    $E_3 E_4 = (12)(9) = 108$。\n    $\\cos\\theta_{34} = \\frac{-103.68}{108} = -0.96$。\n    $k_{\\perp,34}^{2} = 2\\,\\min(12^2, 9^2)\\,(1 - (-0.96)) = 2 \\cdot 9^2 \\cdot 1.96 = 2 \\cdot 81 \\cdot 1.96 = 317.52$。\n\n最小距离是 $k_{\\perp,13}^{2} = 57.6$。我们合并对 $(1,3)$。第一个发射标度是 $k_{\\perp,1} = \\sqrt{57.6}$。\n\n### 第二步：二次聚类\n我们使用E方案重组将部分子1和3合并，$p_{13}^{\\mu} = p_1^{\\mu} + p_3^{\\mu}$：\n$p_{13} = \\left(37.4+12,\\, 0+7.2,\\, 0+0,\\, 37.4+9.6\\right) = \\left(49.4,\\, 7.2,\\, 0,\\, 47.0\\right)$。\n我们将这个新的赝喷注记为 $A$，所以 $p_A \\equiv p_{13}$。剩余的部分子是 $p_B \\equiv p_2$ 和 $p_C \\equiv p_4$。用于聚类的新对象集合是 $\\{A, B, C\\}$。\n能量为 $E_A = 49.4$, $E_B = 41.6$, $E_C = 9$。注意，赝喷注 $A$ 是有质量的，所以其三动量的模 $|\\vec{p}_A|$ 不等于 $E_A$。\n$|\\vec{p}_A|^2 = 7.2^2 + 47.0^2 = 51.84 + 2209 = 2260.84$。所以，$|\\vec{p}_A| = \\sqrt{2260.84} \\approx 47.548$。\n\n我们现在计算 $\\{A, B, C\\}$ 的对间距离。\n1.  **对 (A,B):** ($p_{13}$, $p_2$)\n    $\\vec{p}_A = (7.2, 0, 47.0)$, $\\vec{p}_B = (0, 0, -41.6)$。\n    $\\vec{p}_A \\cdot \\vec{p}_B = 47.0 \\times (-41.6) = -1955.2$。\n    $|\\vec{p}_A| = \\sqrt{2260.84}$, $|\\vec{p}_B| = E_B=41.6$。\n    $\\cos\\theta_{AB} = \\frac{-1955.2}{\\sqrt{2260.84} \\cdot 41.6} \\approx -0.98856$。\n    $k_{\\perp,AB}^{2} = 2\\,\\min(E_A^2, E_B^2)\\,(1 - \\cos\\theta_{AB}) = 2 \\cdot 41.6^2 \\cdot (1 - (-0.98856)) \\approx 6883.6$。\n\n2.  **对 (A,C):** ($p_{13}$, $p_4$)\n    $\\vec{p}_A = (7.2, 0, 47.0)$, $\\vec{p}_C = (-7.2, 0, -5.4)$。\n    $\\vec{p}_A \\cdot \\vec{p}_C = (7.2)(-7.2) + (47.0)(-5.4) = -51.84 - 253.8 = -305.64$。\n    $|\\vec{p}_A| = \\sqrt{2260.84}$, $|\\vec{p}_C| = E_C = 9$。\n    $\\cos\\theta_{AC} = \\frac{-305.64}{\\sqrt{2260.84} \\cdot 9} \\approx -0.71421$。\n    $k_{\\perp,AC}^{2} = 2\\,\\min(E_A^2, E_C^2)\\,(1 - \\cos\\theta_{AC}) = 2 \\cdot 9^2 \\cdot (1 - (-0.71421)) \\approx 277.7$。\n\n3.  **对 (B,C):** ($p_2$, $p_4$)\n    这与初始的 $k_{\\perp,24}^{2}$ 计算相同。\n    $k_{\\perp,BC}^{2} = k_{\\perp,24}^{2} = 64.8$。\n\n比较这些距离 $\\{6883.6, 277.7, 64.8\\}$，最小值是 $k_{\\perp,BC}^{2} = 64.8$。我们合并对 $(B,C)$，它对应于初始的部分子 $(2,4)$。第二个发射标度是 $k_{\\perp,2} = \\sqrt{64.8}$。\n\n聚类过程终止，因为剩下了两个赝喷注 $(1,3)$ 和 $(2,4)$。\n\n### 第三步：计算权重\n发射标度（的平方）为 $k_{\\perp,1}^2 = 57.6~\\mathrm{GeV}^2$ 和 $k_{\\perp,2}^2 = 64.8~\\mathrm{GeV}^2$。\n权重由 $W = \\frac{\\alpha_s(k_{\\perp,1})\\,\\alpha_s(k_{\\perp,2})}{\\alpha_s(\\mu_0)^2}$ 给出。\n跑动耦合常数为 $\\alpha_s(Q) = \\frac{4\\pi}{\\beta_0\\,\\ln(Q^2/\\Lambda^2)}$。\n将此代入权重表达式，常数因子 $\\frac{4\\pi}{\\beta_0}$ 被约掉：\n$$\nW = \\frac{\\frac{1}{\\ln(k_{\\perp,1}^2/\\Lambda^2)} \\cdot \\frac{1}{\\ln(k_{\\perp,2}^2/\\Lambda^2)}}{\\left(\\frac{1}{\\ln(\\mu_0^2/\\Lambda^2)}\\right)^2} = \\frac{\\left(\\ln(\\mu_0^2/\\Lambda^2)\\right)^2}{\\ln(k_{\\perp,1}^2/\\Lambda^2)\\,\\ln(k_{\\perp,2}^2/\\Lambda^2)}.\n$$\n给定 $\\mu_0 = 10~\\mathrm{GeV}$ 和 $\\Lambda = 0.2~\\mathrm{GeV}$。我们现在可以计算对数的宗量：\n- $\\mu_0^2 / \\Lambda^2 = (10 / 0.2)^2 = 50^2 = 2500$。\n- $k_{\\perp,1}^2 / \\Lambda^2 = 57.6 / (0.2)^2 = 57.6 / 0.04 = 1440$。\n- $k_{\\perp,2}^2 / \\Lambda^2 = 64.8 / (0.2)^2 = 64.8 / 0.04 = 1620$。\n\n将这些值代入W的表达式中：\n$$\nW = \\frac{(\\ln(2500))^2}{\\ln(1440)\\,\\ln(1620)}\n$$\n使用自然对数：\n$\\ln(2500) \\approx 7.824046$\n$\\ln(1440) \\approx 7.272398$\n$\\ln(1620) \\approx 7.390182$\n$$\nW \\approx \\frac{(7.824046)^2}{7.272398 \\times 7.390182} \\approx \\frac{61.2157}{53.7449} \\approx 1.13904\n$$\n四舍五入到四位有效数字得到 $1.139$。\n参数 $\\beta_0 = 11 - \\frac{2}{3}(5) = \\frac{23}{3}$ 在最终计算权重 $W$ 时并不需要，因为它在比值中被约掉了。", "answer": "$$\\boxed{1.139}$$", "id": "3521642"}, {"introduction": "MLM匹配方案提供了一种独特的策略，其核心在于检验矩阵元部分子与重建喷注之间的一致性，从而实现矩阵元和部分子簇射的合并。该方法并非进行事件重加权，而是通过接受或拒绝整个事件来避免双重计数。本练习提供了一个具体场景，让您应用MLM匹配的核心逻辑，在这里您必须实施几何匹配判据和喷注否决机制，以正确地对事件进行分类 [@problem_id:3521637]。", "problem": "在量子色动力学事件生成的背景下，考虑一个其矩阵元（ME）描述包含两个末态部分子的专属样本。经过部分子簇射（PS）和强子化之后，事件使用红外安全算法重建为强子喷注。为避免固定阶矩阵元描述和对数重求和的部分子簇射之间的双重计数，使用 Mangano–Moretti–Pantano–Nason–Ridolfi 匹配方案，通常称为 MLM 匹配。以下定义和事实构成了该程序的基础：\n\n- 在共线安全的运动学中，喷注由强子重建，并由横向动量 $p_T$、赝快度 $\\eta$ 和方位角 $\\phi$ 来表征。角分离由 $\\eta$–$\\phi$ 平面中的欧几里得度量定义，$\\Delta R = \\sqrt{(\\Delta \\eta)^2 + (\\Delta \\phi)^2}$，其中 $\\Delta \\phi$ 对 $2\\pi$ 取模，并落在主区间 $(-\\pi, \\pi]$ 内。\n- 当且仅当每个矩阵元部分子都能在最大匹配半径 $\\Delta R_{\\text{match}}$ 内唯一匹配到一个不同的重建喷注，且该喷注满足最小喷注 $p_T$ 阈值 $p_{T,\\text{min}}$，并且没有超过 $p_{T,\\text{min}}$ 的额外喷注（喷注否决）时，这个专属的双部分子样本才被接受。\n\n给定一个事件，其矩阵元末态包含两个部分子 $p_1$ 和 $p_2$，其重建产生三个喷注 $J_1$、$J_2$ 和 $J_3$。它们的运动学坐标如下：\n\n- 矩阵元部分子：\n  - $p_1$: $(\\eta, \\phi, p_T) = (0.70, 1.90\\,\\text{rad}, 60\\,\\text{GeV})$，\n  - $p_2$: $(\\eta, \\phi, p_T) = (-1.20, -0.40\\,\\text{rad}, 45\\,\\text{GeV})$。\n- 重建的喷注：\n  - $J_1$: $(\\eta, \\phi, p_T) = (0.72, 2.05\\,\\text{rad}, 58\\,\\text{GeV})$，\n  - $J_2$: $(\\eta, \\phi, p_T) = (-1.18, -0.35\\,\\text{rad}, 46\\,\\text{GeV})$，\n  - $J_3$: $(\\eta, \\phi, p_T) = (2.40, -2.80\\,\\text{rad}, 25\\,\\text{GeV})$。\n\n应用 MLM 匹配决策，匹配半径 $\\Delta R_{\\text{match}} = 0.30$，喷注横向动量阈值 $p_{T,\\text{min}} = 30\\,\\text{GeV}$，以及专属否决条件，即如果任何 $p_T \\geq p_{T,\\text{min}}$ 的重建喷注未匹配到矩阵元部分子，则拒绝该事件。使用弧度单位的 $\\phi$。计算唯一的一对一匹配所需的所有 $\\Delta R$ 值，强制执行阈值，并决定该事件是被接受还是被拒绝。\n\n将最终的接受决定报告为一个无量纲数，$1$ 表示接受，$0$ 表示拒绝。无需四舍五入。", "solution": "该问题要求应用 Mangano–Moretti–Pantano–Nason–Ridolfi (MLM) 匹配方案来决定一个给定事件是被接受还是被拒绝。该事件包含两个矩阵元（ME）部分子 $p_1$ 和 $p_2$，以及三个重建的喷注 $J_1$、$J_2$ 和 $J_3$。决策基于一组指定的标准，包括匹配半径 $\\Delta R_{\\text{match}}$、最小喷注横向动量 $p_{T,\\text{min}}$ 和专属喷注否决。\n\n此专属双部分子样本的接受标准如下：\n1. 两个矩阵元部分子中的每一个都必须唯一地匹配到一个不同的重建喷注，该喷注的横向动量 $p_T$ 大于或等于 $p_{T,\\text{min}}$。\n2. 每个匹配的部分子-喷注对之间的角分离 $\\Delta R$ 必须小于或等于 $\\Delta R_{\\text{match}}$。\n3. 不得存在其他 $p_T \\ge p_{T,\\text{min}}$ 的重建喷注未匹配到矩阵元部分子。\n\n步骤如下：\n\n首先，我们根据最小横向动量阈值 $p_{T,\\text{min}} = 30\\,\\text{GeV}$ 筛选重建的喷注。\n给定的喷注是：\n- 喷注 $J_1$：$p_T(J_1) = 58\\,\\text{GeV}$。由于 $58\\,\\text{GeV} \\ge 30\\,\\text{GeV}$，此喷注被保留。\n- 喷注 $J_2$：$p_T(J_2) = 46\\,\\text{GeV}$。由于 $46\\,\\text{GeV} \\ge 30\\,\\text{GeV}$，此喷注也被保留。\n- 喷注 $J_3$：$p_T(J_3) = 25\\,\\text{GeV}$。由于 $25\\,\\text{GeV}  30\\,\\text{GeV}$，此喷注从匹配程序中被丢弃，并且不会触发喷注否决。\n\n因此，只有喷注 $J_1$ 和 $J_2$ 被考虑用于匹配。由于有两个矩阵元部分子和两个通过 $p_T$ 截断的喷注，一对一匹配是可能的。\n\n其次，我们计算每个矩阵元部分子与每个幸存喷注之间的角分离 $\\Delta R = \\sqrt{(\\Delta \\eta)^2 + (\\Delta \\phi)^2}$。坐标如下：\n- 部分子 $p_1$：$(\\eta, \\phi) = (0.70, 1.90)$\n- 部分子 $p_2$：$(\\eta, \\phi) = (-1.20, -0.40)$\n- 喷注 $J_1$：$(\\eta, \\phi) = (0.72, 2.05)$\n- 喷注 $J_2$：$(\\eta, \\phi) = (-1.18, -0.35)$\n\n方位角之差 $\\Delta \\phi$ 在 $(-\\pi, \\pi]$ 范围内计算。对于给定的值，无需进行模运算，因为所有差值都在此范围内。\n\n成对的 $\\Delta R$ 计算如下：\n- 对于对 $(p_1, J_1)$：\n  $\\Delta \\eta = 0.70 - 0.72 = -0.02$\n  $\\Delta \\phi = 1.90 - 2.05 = -0.15$\n  $\\Delta R(p_1, J_1) = \\sqrt{(-0.02)^2 + (-0.15)^2} = \\sqrt{0.0004 + 0.0225} = \\sqrt{0.0229} \\approx 0.1513$\n\n- 对于对 $(p_1, J_2)$：\n  $\\Delta \\eta = 0.70 - (-1.18) = 1.88$\n  $\\Delta \\phi = 1.90 - (-0.35) = 2.25$\n  $\\Delta R(p_1, J_2) = \\sqrt{(1.88)^2 + (2.25)^2} = \\sqrt{3.5344 + 5.0625} = \\sqrt{8.5969} \\approx 2.9320$\n\n- 对于对 $(p_2, J_1)$：\n  $\\Delta \\eta = -1.20 - 0.72 = -1.92$\n  $\\Delta \\phi = -0.40 - 2.05 = -2.45$\n  $\\Delta R(p_2, J_1) = \\sqrt{(-1.92)^2 + (-2.45)^2} = \\sqrt{3.6864 + 6.0025} = \\sqrt{9.6889} \\approx 3.1127$\n\n- 对于对 $(p_2, J_2)$：\n  $\\Delta \\eta = -1.20 - (-1.18) = -0.02$\n  $\\Delta \\phi = -0.40 - (-0.35) = -0.05$\n  $\\Delta R(p_2, J_2) = \\sqrt{(-0.02)^2 + (-0.05)^2} = \\sqrt{0.0004 + 0.0025} = \\sqrt{0.0029} \\approx 0.0539$\n\n第三，我们执行匹配。对于每个部分子，我们找到最近的喷注，并检查角分离是否在匹配半径 $\\Delta R_{\\text{match}} = 0.30$ 之内。\n- 对于部分子 $p_1$，最近的喷注是 $J_1$，其 $\\Delta R(p_1, J_1) = \\sqrt{0.0229}$。由于 $\\sqrt{0.0229} \\approx 0.1513 \\le 0.30$，部分子 $p_1$ 与喷注 $J_1$ 匹配。\n- 对于部分子 $p_2$，最近的喷注是 $J_2$，其 $\\Delta R(p_2, J_2) = \\sqrt{0.0029}$。由于 $\\sqrt{0.0029} \\approx 0.0539 \\le 0.30$，部分子 $p_2$ 与喷注 $J_2$ 匹配。\n\n最终的分配是 $p_1 \\to J_1$ 和 $p_2 \\to J_2$。这是矩阵元部分子与不同重建喷注之间的唯一的一对一匹配。标准1和2得到满足。\n\n第四，我们应用专属喷注否决。否决条件规定，如果存在任何 $p_T \\ge p_{T,\\text{min}}$ 的喷注未匹配到矩阵元部分子，则该事件被拒绝。$p_T \\ge p_{T,\\text{min}}$ 的喷注集合是 $\\{J_1, J_2\\}$。匹配的喷注集合也是 $\\{J_1, J_2\\}$。没有未匹配的且 $p_T \\ge p_{T,\\text{min}}$ 的喷注。因此，该事件通过了喷注否决。\n\n由于所有接受标准都已满足，该事件被接受。最终答案是 $1$。", "answer": "$$\n\\boxed{1}\n$$", "id": "3521637"}, {"introduction": "合并不同喷注多重度的专属矩阵元计算会带来一个根本性挑战：如何确保它们的截面之和能正确地重现总包含截面，即幺正性原理。UMEPS方法通过将最高多重度的样本视为包含性的，为这个问题提供了一个强大而优雅的解决方案。本练习要求您从第一性原理出发，推导出喷注发射的泊松统计行为，并实现一个模型来证明UMEPS如何完美地保持幺正性，这与朴素的截断求和方法形成了鲜明对比 [@problem_id:3521626]。", "problem": "考虑一个用于在幺正矩阵元加部分子簇射 (Unitary Matrix Element plus Parton Shower, UMEPS) 中检验幺正化的玩具但物理上可靠的喷注发射模型。一个全包含硬过程的总速率（截面）记为 $\\sigma_{\\mathrm{incl}}$，单位为皮靶 (pb)。发射被建模为在一个硬标度 $Q_{\\max}$ 和一个合并标度 $Q_{\\mathrm{cut}}$（两者单位均为 $\\mathrm{GeV}$）之间，在一个单一硬度变量 $q$ 上独立且强有序的。喷注由满足 $q \\ge Q_{\\mathrm{cut}}$ 的发射定义。对于符合喷注条件的发射，其相空间接受度由一个无量纲分数 $C \\in [0,1]$ 编码，它表示通过所有应用截断的完整相空间所占的比例。每单位对数标度的有效常数发射率定义为 $\\kappa \\equiv \\bar{\\alpha}\\, C$，其中 $\\bar{\\alpha}$ 是一个无量纲常数，它在这个简化模型中聚合了相关的耦合和色因子。\n\n使用以下基本原理作为出发点：\n- 事件产生器的簇射物理遵循独立发射近似，并在 $q$ 上强有序，这意味着除了有序性之外，连续的发射是不相关的。\n- 在两个标度 $Q_a$ 和 $Q_b$ ($Q_a  Q_b$) 之间无发射的概率由 Sudakov 形状因子给出，\n$$\n\\Delta(Q_a,Q_b) = \\exp\\left(-\\int_{\\ln Q_b}^{\\ln Q_a} \\kappa \\, d\\ln q\\right).\n$$\n- 喷注由通过硬度阈值 $Q_{\\mathrm{cut}}$ 和由 $C$ 封装的相空间接受度的发射来定义。\n\n仅从这些原理出发，并且不假设任何预先给定的多重数分布的最终公式，推导独占 $n$-喷注截面并按如下方式在 UMEPS 中验证幺正化：\n1) 从 Sudakov 形状因子的定义和独立强有序发射出发，推导在区间 $[Q_{\\mathrm{cut}}, Q_{\\max}]$ 内观测到恰好 $n$ 个满足 $q \\ge Q_{\\mathrm{cut}}$ 的发射的概率分布，用对数范围 $L \\equiv \\ln(Q_{\\max}/Q_{\\mathrm{cut}})$ 和有效速率 $\\kappa$ 表示。然后用 $\\sigma_{\\mathrm{incl}}$、$L$ 和 $\\kappa$ 表示独占 $n$-喷注截面 $\\sigma_n$。不要先验地假设某个特定的命名分布；要从独立发射和 Sudakov 形状因子的第一性原理中得到它。\n2) 假设只保留最高可分辨多重数为 $N_{\\max}$ 的独占样本。定义朴素截断求和总量，\n$$\n\\Sigma_{\\text{naive}}(N_{\\max}) \\equiv \\sum_{n=0}^{N_{\\max}} \\sigma_n,\n$$\n以及相应的与幺正性的分数偏差，\n$$\n\\delta_{\\text{naive}} \\equiv \\frac{\\Sigma_{\\text{naive}}(N_{\\max}) - \\sigma_{\\mathrm{incl}}}{\\sigma_{\\mathrm{incl}}}.\n$$\n3) 在 UMEPS 中，最高多重数的样本被全包含地处理以恢复幺正性。通过定义\n$$\n\\sigma_{N_{\\max}}^{\\text{UMEPS}} \\equiv \\sigma_{\\mathrm{incl}} - \\sum_{n=0}^{N_{\\max}-1} \\sigma_n,\n$$\n来实现这一点，同时保持对于 $n  N_{\\max}$，$\\sigma_n^{\\text{UMEPS}} = \\sigma_n$。定义\n$$\n\\Sigma_{\\text{UMEPS}}(N_{\\max}) \\equiv \\sum_{n=0}^{N_{\\max}} \\sigma_n^{\\text{UMEPS}},\n$$\n以及相应的分数偏差，\n$$\n\\delta_{\\text{UMEPS}} \\equiv \\frac{\\Sigma_{\\text{UMEPS}}(N_{\\max}) - \\sigma_{\\mathrm{incl}}}{\\sigma_{\\mathrm{incl}}}.\n$$\n4) 实现一个程序，为每个指定的测试案例计算偏差对 $\\left[\\delta_{\\text{naive}}, \\delta_{\\text{UMEPS}}\\right]$，结果为实数（无量纲小数）。该程序不得读取任何输入；它必须使用下面给出的测试套件。\n\n使用以下测试套件，其中所有 $Q$ 标度的单位均为 $\\mathrm{GeV}$，$\\sigma_{\\mathrm{incl}}$ 的单位为 $\\mathrm{pb}$。对于每个案例，将偏差计算为小数：\n- 案例 A (一般情况): $\\sigma_{\\mathrm{incl}} = 100\\,\\mathrm{pb}$, $Q_{\\max} = 1000\\,\\mathrm{GeV}$, $Q_{\\mathrm{cut}} = 20\\,\\mathrm{GeV}$, $\\bar{\\alpha} = 0.2$, $C = 0.5$, $N_{\\max} = 2$.\n- 案例 B (大对数): $\\sigma_{\\mathrm{incl}} = 100\\,\\mathrm{pb}$, $Q_{\\max} = 1000\\,\\mathrm{GeV}$, $Q_{\\mathrm{cut}} = 1\\,\\mathrm{GeV}$, $\\bar{\\alpha} = 0.3$, $C = 1.0$, $N_{\\max} = 2$.\n- 案例 C (近阈值): $\\sigma_{\\mathrm{incl}} = 100\\,\\mathrm{pb}$, $Q_{\\max} = 1000\\,\\mathrm{GeV}$, $Q_{\\mathrm{cut}} = 900\\,\\mathrm{GeV}$, $\\bar{\\alpha} = 0.5$, $C = 0.8$, $N_{\\max} = 3$.\n- 案例 D (零接受度边缘): $\\sigma_{\\mathrm{incl}} = 100\\,\\mathrm{pb}$, $Q_{\\max} = 1000\\,\\mathrm{GeV}$, $Q_{\\mathrm{cut}} = 100\\,\\mathrm{GeV}$, $\\bar{\\alpha} = 0.2$, $C = 0.0$, $N_{\\max} = 4$.\n- 案例 E (极大尾部，小 $N_{\\max}$): $\\sigma_{\\mathrm{incl}} = 100\\,\\mathrm{pb}$, $Q_{\\max} = 1000\\,\\mathrm{GeV}$, $Q_{\\mathrm{cut}} = 0.5\\,\\mathrm{GeV}$, $\\bar{\\alpha} = 0.5$, $C = 1.0$, $N_{\\max} = 1$.\n\n数值和输出要求：\n- 所有对 $Q_{\\max}$ 和 $Q_{\\mathrm{cut}}$ 的内部使用必须以 $\\mathrm{GeV}$ 为单位处理；所有 $\\sigma$ 以 $\\mathrm{pb}$ 为单位。最终的偏差 $\\delta_{\\text{naive}}$ 和 $\\delta_{\\text{UMEPS}}$ 必须报告为无单位的小数。\n- 您的程序应生成单行输出，其中包含结果，形式为逗号分隔的每个测试案例的列表，每个内部列表为 $\\left[\\delta_{\\text{naive}}, \\delta_{\\text{UMEPS}}\\right]$，并用方括号括起来。例如，输出必须具有 '[[dA_naive,dA_umeps],[dB_naive,dB_umeps],...]' 的形式，不含任何额外文本。", "solution": "该问题要求从简化部分子簇射模型的第一性原理出发，推导独占 $n$-喷注截面，并随后计算两种不同求和方案下与幺正性的分数偏差。\n\n### 第 1 部分：独占 $n$-喷注截面的推导\n\n该模型的基础是部分子的独立且强有序发射，如果部分子的硬度 $q$ 超过截断值 $Q_{\\mathrm{cut}}$，则它们被识别为喷注。每单位对数硬度的发射率是恒定的，由有效速率 $\\kappa$ 给出。可用于发射的总对数范围是 $L \\equiv \\ln(Q_{\\max}/Q_{\\mathrm{cut}})$。\n\nSudakov 形状因子 $\\Delta(Q_a, Q_b)$ 给出了在标度 $Q_a$ 和 $Q_b$ ($Q_a  Q_b$) 之间没有发射的概率。由于 $\\kappa$ 是常数，定义 Sudakov 形状因子的积分为：\n$$ \\Delta(Q_a, Q_b) = \\exp\\left(-\\int_{\\ln Q_b}^{\\ln Q_a} \\kappa \\, d\\ln q\\right) = \\exp\\left(-\\kappa [\\ln q]_{\\ln Q_b}^{\\ln Q_a}\\right) = \\exp(-\\kappa \\ln(Q_a/Q_b)) $$\n\n在从 $Q_{\\mathrm{cut}}$ 到 $Q_{\\max}$ 的整个范围内，恰好有零次发射（喷注）的概率，记为 $P(0)$，由该区间的 Sudakov 因子给出：\n$$ P(0) = \\Delta(Q_{\\max}, Q_{\\mathrm{cut}}) = \\exp(-\\kappa \\ln(Q_{\\max}/Q_{\\mathrm{cut}})) = e^{-\\kappa L} $$\n\n为了找到恰好有一次发射的概率 $P(1)$，我们必须考虑在区间 $[Q_{\\mathrm{cut}}, Q_{\\max}]$ 内某个标度 $q_1$ 处有一次发射，且没有其他发射。在无穷小对数区间 $d\\ln q_1$ 内发生一次发射的微分概率是 $\\kappa \\, d\\ln q_1$。对于在 $q_1$ 处的一次发射，在范围 $[q_1, Q_{\\max}]$ 内和范围 $[Q_{\\mathrm{cut}}, q_1]$ 内都必须没有发射。总概率通过对所有可能的 $q_1$ 值进行积分得到：\n$$ P(1) = \\int_{\\ln Q_{\\mathrm{cut}}}^{\\ln Q_{\\max}} \\Delta(Q_{\\max}, q_1) \\cdot (\\kappa \\, d\\ln q_1) \\cdot \\Delta(q_1, Q_{\\mathrm{cut}}) $$\nSudakov 因子的乘积简化为：\n$$ \\Delta(Q_{\\max}, q_1) \\Delta(q_1, Q_{\\mathrm{cut}}) = e^{-\\kappa \\ln(Q_{\\max}/q_1)} e^{-\\kappa \\ln(q_1/Q_{\\mathrm{cut}})} = e^{-\\kappa(\\ln(Q_{\\max}/q_1) + \\ln(q_1/Q_{\\mathrm{cut}}))} = e^{-\\kappa \\ln(Q_{\\max}/Q_{\\mathrm{cut}})} = e^{-\\kappa L} $$\n此项与 $q_1$ 无关。积分变为：\n$$ P(1) = \\int_{\\ln Q_{\\mathrm{cut}}}^{\\ln Q_{\\max}} \\kappa e^{-\\kappa L} \\, d\\ln q_1 = \\kappa e^{-\\kappa L} \\left[\\ln q_1\\right]_{\\ln Q_{\\mathrm{cut}}}^{\\ln Q_{\\max}} = \\kappa e^{-\\kappa L} (\\ln Q_{\\max} - \\ln Q_{\\mathrm{cut}}) = (\\kappa L) e^{-\\kappa L} $$\n\n对于恰好有 $n$ 次发射的概率 $P(n)$，我们考虑在强有序标度 $Q_{\\max}  q_1  q_2  \\dots  q_n  Q_{\\mathrm{cut}}$ 处的 $n$ 次发射。此特定构型的微分概率是在每个 $q_i$ 处发射的概率与中间无发射概率的乘积：\n$$ dP(n) = \\Delta(Q_{\\max}, q_1) (\\kappa d\\ln q_1) \\Delta(q_1, q_2) (\\kappa d\\ln q_2) \\cdots \\Delta(q_{n-1}, q_n) (\\kappa d\\ln q_n) \\Delta(q_n, Q_{\\mathrm{cut}}) $$\n所有 Sudakov 因子的乘积像之前一样可伸缩，得到 $e^{-\\kappa L}$。微分概率简化为：\n$$ dP(n) = e^{-\\kappa L} \\kappa^n \\, d\\ln q_1 \\, d\\ln q_2 \\cdots d\\ln q_n $$\n为了找到总概率 $P(n)$，我们在有序相空间上积分。令 $t_i = \\ln q_i$, $T_{\\max} = \\ln Q_{\\max}$, $T_{\\mathrm{cut}} = \\ln Q_{\\mathrm{cut}}$。积分的体积由 $T_{\\max}  t_1  t_2  \\dots  t_n  T_{\\mathrm{cut}}$ 定义。\n$$ P(n) = \\kappa^n e^{-\\kappa L} \\int_{T_{\\mathrm{cut}}}^{T_{\\max}} dt_1 \\int_{T_{\\mathrm{cut}}}^{t_1} dt_2 \\cdots \\int_{T_{\\mathrm{cut}}}^{t_{n-1}} dt_n $$\n这个嵌套积分是边长为 $(T_{\\max} - T_{\\mathrm{cut}}) = L$ 的 n-单纯形的体积，其计算结果为 $L^n/n!$。\n因此，恰好有 $n$ 次发射的概率是：\n$$ P(n) = \\frac{(\\kappa L)^n e^{-\\kappa L}}{n!} $$\n这是均值为 $\\lambda = \\kappa L$ 的泊松分布。\n\n独占 $n$-喷注截面 $\\sigma_n$ 是全包含截面 $\\sigma_{\\mathrm{incl}}$ 乘以 $n$-喷注末态的概率：\n$$ \\sigma_n = \\sigma_{\\mathrm{incl}} \\cdot P(n) = \\sigma_{\\mathrm{incl}} \\frac{(\\kappa L)^n e^{-\\kappa L}}{n!} $$\n\n### 第 2 部分：朴素幺正性偏差\n\n将独占样本求和至 $N_{\\max}$ 的朴素总截面是 $\\Sigma_{\\text{naive}}(N_{\\max}) = \\sum_{n=0}^{N_{\\max}} \\sigma_n$。相应的与幺正性的分数偏差是：\n$$ \\delta_{\\text{naive}} = \\frac{\\Sigma_{\\text{naive}}(N_{\\max}) - \\sigma_{\\mathrm{incl}}}{\\sigma_{\\mathrm{incl}}} = \\frac{\\sigma_{\\mathrm{incl}} \\left(\\sum_{n=0}^{N_{\\max}} P(n)\\right) - \\sigma_{\\mathrm{incl}}}{\\sigma_{\\mathrm{incl}}} = \\left(\\sum_{n=0}^{N_{\\max}} P(n)\\right) - 1 $$\n代入泊松概率 $P(n)$：\n$$ \\delta_{\\text{naive}} = \\left(\\sum_{n=0}^{N_{\\max}} \\frac{(\\kappa L)^n e^{-\\kappa L}}{n!}\\right) - 1 $$\n这个偏差表示对应于多重数大于 $N_{\\max}$ 的总截面部分，这部分在这个朴素方案中被截断了。\n\n### 第 3 部分：UMEPS 幺正性偏差\n\nUMEPS 过程通过构造恢复了幺正性。对于 $n  N_{\\max}$ 的截面保持不变（$\\sigma_n^{\\text{UMEPS}} = \\sigma_n$），而最高多重数箱被定义为吸收剩余的截面：\n$$ \\sigma_{N_{\\max}}^{\\text{UMEPS}} \\equiv \\sigma_{\\mathrm{incl}} - \\sum_{n=0}^{N_{\\max}-1} \\sigma_n $$\nUMEPS 的总截面是这些贡献的总和：\n$$ \\Sigma_{\\text{UMEPS}}(N_{\\max}) = \\sum_{n=0}^{N_{\\max}} \\sigma_n^{\\text{UMEPS}} = \\left(\\sum_{n=0}^{N_{\\max}-1} \\sigma_n^{\\text{UMEPS}}\\right) + \\sigma_{N_{\\max}}^{\\text{UMEPS}} $$\n代入定义：\n$$ \\Sigma_{\\text{UMEPS}}(N_{\\max}) = \\left(\\sum_{n=0}^{N_{\\max}-1} \\sigma_n\\right) + \\left(\\sigma_{\\mathrm{incl}} - \\sum_{n=0}^{N_{\\max}-1} \\sigma_n\\right) = \\sigma_{\\mathrm{incl}} $$\n总截面是精确守恒的。因此，分数偏差是：\n$$ \\delta_{\\text{UMEPS}} = \\frac{\\Sigma_{\\text{UMEPS}}(N_{\\max}) - \\sigma_{\\mathrm{incl}}}{\\sigma_{\\mathrm{incl}}} = \\frac{\\sigma_{\\mathrm{incl}} - \\sigma_{\\mathrm{incl}}}{\\sigma_{\\mathrm{incl}}} = 0 $$\n这个结果对于任何有效的参数集都解析成立。\n\n### 第 4 部分：计算实现\n\n程序将实现推导出的公式。对于每个测试案例，算法如下：\n1. 读取参数：$\\sigma_{\\mathrm{incl}}$、$Q_{\\max}$、$Q_{\\mathrm{cut}}$、$\\bar{\\alpha}$、$C$ 和 $N_{\\max}$。\n2. 计算有效发射率 $\\kappa = \\bar{\\alpha} C$。\n3. 计算对数范围 $L = \\ln(Q_{\\max}/Q_{\\mathrm{cut}})$。如果 $Q_{\\max} \\le Q_{\\mathrm{cut}}$，则 $L$ 设置为 0。\n4. 计算泊松均值 $\\lambda = \\kappa L$。\n5. 计算 $\\delta_{\\text{naive}} = (\\sum_{n=0}^{N_{\\max}} \\frac{\\lambda^n e^{-\\lambda}}{n!}) - 1$。\n6. 设置 $\\delta_{\\text{UMEPS}} = 0.0$。\n7. 返回偏差对 $[\\delta_{\\text{naive}}, \\delta_{\\text{UMEPS}}]$。\n程序将对所有指定的测试案例执行此操作，并按要求格式化输出。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport math\n\ndef solve():\n    \"\"\"\n    Solves the UMEPS unitarization problem for a suite of test cases.\n    \"\"\"\n    \n    # Test cases defined in the problem statement.\n    # Each tuple contains: (sigma_incl, Q_max, Q_cut, alpha_bar, C, N_max)\n    test_cases = [\n        # Case A (general case)\n        {'sigma_incl': 100.0, 'Q_max': 1000.0, 'Q_cut': 20.0, 'alpha_bar': 0.2, 'C': 0.5, 'N_max': 2},\n        # Case B (large logarithm)\n        {'sigma_incl': 100.0, 'Q_max': 1000.0, 'Q_cut': 1.0, 'alpha_bar': 0.3, 'C': 1.0, 'N_max': 2},\n        # Case C (near-threshold)\n        {'sigma_incl': 100.0, 'Q_max': 1000.0, 'Q_cut': 900.0, 'alpha_bar': 0.5, 'C': 0.8, 'N_max': 3},\n        # Case D (zero acceptance edge)\n        {'sigma_incl': 100.0, 'Q_max': 1000.0, 'Q_cut': 100.0, 'alpha_bar': 0.2, 'C': 0.0, 'N_max': 4},\n        # Case E (very large tail, small N_max)\n        {'sigma_incl': 100.0, 'Q_max': 1000.0, 'Q_cut': 0.5, 'alpha_bar': 0.5, 'C': 1.0, 'N_max': 1},\n    ]\n\n    results = []\n    for case in test_cases:\n        # Main logic to calculate the result for one case goes here.\n        result = calculate_deviations(\n            case['Q_max'], \n            case['Q_cut'], \n            case['alpha_bar'], \n            case['C'], \n            case['N_max']\n        )\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # The format is a list of lists, e.g., [[-0.1, 0.0], [-0.2, 0.0]]\n    # map(str, results) correctly handles converting inner lists to string representation.\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef calculate_deviations(Q_max, Q_cut, alpha_bar, C, N_max):\n    \"\"\"\n    Calculates the naive and UMEPS fractional deviations from unitarity.\n\n    Args:\n        Q_max (float): The hard scale in GeV.\n        Q_cut (float): The merging scale in GeV.\n        alpha_bar (float): The dimensionless effective coupling.\n        C (float): The phase-space acceptance fraction.\n        N_max (int): The maximum resolved multiplicity.\n\n    Returns:\n        list: A list containing [delta_naive, delta_umeps].\n    \"\"\"\n    \n    # 1. Calculate the effective emission rate per unit logarithmic scale, kappa.\n    kappa = alpha_bar * C\n\n    # 2. Calculate the logarithmic range, L.\n    # The physical regime is Q_max > Q_cut. If Q_max = Q_cut, L must be non-positive.\n    # By convention, if Q_max = Q_cut, there is no phase space for emission, so L=0.\n    if Q_max = Q_cut:\n        L = 0.0\n    else:\n        L = np.log(Q_max / Q_cut)\n    \n    # 3. Calculate the mean of the Poisson distribution, lambda.\n    lmbda = kappa * L\n\n    # 4. Calculate the sum of probabilities for n=0 to N_max.\n    # P(n) = (lambda^n * exp(-lambda)) / n!\n    sum_P_naive = 0.0\n    \n    # The case lambda = 0 is special. P(0) = 1, P(n>0) = 0.\n    if lmbda == 0:\n        sum_P_naive = 1.0\n    else:\n        # Sum the Poisson probabilities from n=0 to N_max.\n        # Direct summation is numerically stable for the small N_max values in test cases.\n        exp_neg_lmbda = np.exp(-lmbda)\n        for n in range(N_max + 1):\n            prob_n = (lmbda**n * exp_neg_lmbda) / math.factorial(n)\n            sum_P_naive += prob_n\n\n    # 5. Calculate the naive fractional deviation.\n    delta_naive = sum_P_naive - 1.0\n    \n    # 6. The UMEPS fractional deviation is 0 by construction, as shown in the derivation.\n    delta_umeps = 0.0\n    \n    return [delta_naive, delta_umeps]\n\nsolve()\n```", "id": "3521626"}]}