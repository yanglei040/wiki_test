{"hands_on_practices": [{"introduction": "Feldman-Cousins方法的核心在于其独特的排序原则，即似然比排序。在构造置信区间之前，我们必须首先为每个假设的信号强度$s$定义一个“接受域”，这个练习将带你实践这一基础步骤。你将通过计算似然比来对可能的观测结果进行排序，并确定定义$90\\%$置信水平接受域的临界阈值，从而深入理解Feldman-Cousins构造的核心机制 ([@problem_id:3514604])。", "problem": "在高能物理的一次计数实验中，信号区域内观测到的事件数 $n$ 被建模为一个泊松随机变量，其均值为 $\\mu = s + b$，其中 $s \\geq 0$ 是非负的信号强度，$b$ 是已知的本底贡献。其概率质量函数为 $P(n \\mid \\mu) = \\exp(-\\mu)\\,\\mu^{n} / n!$。你需要使用基于似然比检验（LRT）的排序原则，在指定的置信水平下构建 Feldman-Cousins 接受域。LRT 通过比值 $R(n \\mid s_{0}) = \\mathcal{L}(s_{0}; n)/\\mathcal{L}(\\hat{s}(n); n)$ 对结果 $n$ 进行排序，其中 $\\mathcal{L}(s; n)$ 是在给定 $n$ 的情况下 $s$ 的似然函数，$\\hat{s}(n)$ 是在物理约束 $s \\geq 0$ 下 $s$ 的最大似然估计（MLE）。\n\n考虑本底 $b = 3.0$ 和指定检验信号 $s_{0} = 1.5$ 的情况。置信水平为 $C = 0.9$。从泊松模型和似然函数的定义出发，并在确定 $\\hat{s}(n)$ 时明确施加物理约束 $s \\geq 0$，推导出似然比排序函数 $R(n \\mid s_{0})$，并计算临界似然比阈值 $R_{c}$。该阈值需满足：$s_{0}$ 的 Feldman-Cousins 接受域是计数集合 $\\{n\\}$，其中 $R(n \\mid s_{0}) \\geq R_{c}$，且总概率 $\\sum_{n: R(n \\mid s_{0}) \\geq R_{c}} P(n \\mid s_{0}+b) \\geq C$；同时，若从中移除任何一个具有最小 $R(n \\mid s_{0})$ 值的 $n$，总概率将低于 $C$。\n\n提供在 $b = 3.0$，$s_{0} = 1.5$ 和 $C = 0.9$ 条件下阈值 $R_{c}$ 的数值。最终答案应表示为无量纲数，并四舍五入到四位有效数字。", "solution": "该问题要求确定用于构建 Feldman-Cousins 接受域的临界似然比阈值 $R_c$。实验涉及观测事件数 $n$，它是一个均值为 $\\mu = s+b$ 的泊松分布随机变量。其中，$s$ 是信号强度（$s \\geq 0$），$b$ 是已知的本底。\n\n**1. 给定值和定义**\n提供的参数如下：\n- 本底：$b = 3.0$\n- 检验信号假设：$s_0 = 1.5$\n- 置信水平：$C = 0.9$\n\n观测事件数 $n$ 服从均值为 $\\mu = s+b$ 的泊松分布。其概率质量函数（PMF）为：\n$$P(n \\mid s, b) = \\frac{(s+b)^n \\exp(-(s+b))}{n!}$$\n对于固定的观测值 $n$，$s$ 的似然函数为 $\\mathcal{L}(s; n) = P(n \\mid s, b)$。对于给定的检验假设 $s_0$，结果 $n$ 的排序基于似然比：\n$$R(n \\mid s_0) = \\frac{\\mathcal{L}(s_0; n)}{\\mathcal{L}(\\hat{s}(n); n)}$$\n其中 $\\hat{s}(n)$ 是在物理约束 $s \\geq 0$ 下 $s$ 的最大似然估计（MLE）。\n\n**2. 确定最大似然估计（MLE）$\\hat{s}(n)**\n为求 $s$ 的 MLE，我们对对数似然函数 $\\ln \\mathcal{L}(s; n)$ 关于 $s$ 进行最大化：\n$$\\ln \\mathcal{L}(s; n) = n \\ln(s+b) - (s+b) - \\ln(n!)$$\n对 $s$ 求导并令其为零，得到无约束的最大值：\n$$\\frac{d}{ds} \\ln \\mathcal{L}(s; n) = \\frac{n}{s+b} - 1 = 0 \\implies s+b = n \\implies s = n-b$$\n我们必须施加物理约束 $s \\geq 0$。\n- 如果 $n-b \\geq 0$，即 $n \\geq b$，无约束的 MLE 是物理的，因此 $\\hat{s}(n) = n-b$。\n- 如果 $n-b  0$，即 $n  b$，无约束的最大值位于非物理区域。对数似然函数是凹函数，因此其在允许区域 $s \\geq 0$ 内的最大值出现在边界上，即 $\\hat{s}(n) = 0$。\n综合这两种情况，带物理约束的 MLE 是 $\\hat{s}(n) = \\max(0, n-b)$。\n\n对应于 MLE $\\hat{s}(n)$ 的均值 $\\mu = s+b$ 的值为 $\\hat{\\mu}(n) = \\hat{s}(n)+b = \\max(0, n-b) + b = \\max(b, n)$。\n\n**3. 构建似然比**\n似然比 $R(n \\mid s_0)$ 比较了检验假设 $s_0$ 的似然与最佳拟合假设 $\\hat{s}(n)$ 的似然：\n$$R(n \\mid s_0) = \\frac{P(n \\mid s_0+b)}{P(n \\mid \\hat{s}(n)+b)}$$\n令 $\\mu_0 = s_0+b$。该比值为：\n$$R(n \\mid s_0) = \\left(\\frac{\\mu_0}{\\hat{\\mu}(n)}\\right)^n \\exp(\\hat{\\mu}(n) - \\mu_0)$$\n代入给定值，$b=3.0$ 和 $s_0=1.5$，我们得到：\n- $\\mu_0 = s_0+b = 1.5 + 3.0 = 4.5$\n- $\\hat{\\mu}(n) = \\max(3.0, n)$\n针对此问题的似然比为：\n$$R(n \\mid 1.5) = \\left(\\frac{4.5}{\\max(3.0, n)}\\right)^n \\exp(\\max(3.0, n) - 4.5)$$\n\n**4. 构建接受域**\n$s_0$ 的接受域是通过按似然比 $R(n \\mid 1.5)$ 的降序包含结果 $n$ 来构建的，直到累积概率达到置信水平 $C=0.9$。概率是在检验假设下计算的，即使用均值为 $\\mu_0=4.5$ 的泊松 PMF：$P(n \\mid 4.5) = \\frac{(4.5)^n \\exp(-4.5)}{n!}$。\n\n我们为一系列整数值 $n$ 计算 $P(n \\mid 4.5)$ 和 $R(n \\mid 1.5)$：\n| $n$ | $\\hat{\\mu}(n)$ | $P(n \\mid 4.5)$ | $R(n \\mid 1.5)$ |\n|---|---|---|---|\n| 0 | 3.0 | 0.0111090 | 0.223130 |\n| 1 | 3.0 | 0.0499905 | 0.334695 |\n| 2 | 3.0 | 0.1124786 | 0.502043 |\n| 3 | 3.0 | 0.1687179 | 0.753064 |\n| 4 | 4.0 | 0.1898076 | 0.968134 |\n| 5 | 5.0 | 0.1708269 | 0.973510 |\n| 6 | 6.0 | 0.1281201 | 0.797732 |\n| 7 | 7.0 | 0.0823629 | 0.552227 |\n| 8 | 8.0 | 0.0463292 | 0.324229 |\n| 9 | 9.0 | 0.0231646 | 0.175815 |\n| ...| ... | ... | ... |\n\n接下来，我们按 $R(n \\mid 1.5)$ 的降序对结果 $n$ 进行排序，并计算其概率的累积和 $\\sum P(n \\mid 4.5)$：\n| 排名 | $n$ | $R(n \\mid 1.5)$ | $P(n \\mid 4.5)$ | 累积 $P$ |\n|------|---|-------------|-----------------|------------------|\n| 1 | 5 | 0.973510 | 0.170827 | 0.170827 |\n| 2 | 4 | 0.968134 | 0.189808 | 0.360635 |\n| 3 | 6 | 0.797732 | 0.128120 | 0.488755 |\n| 4 | 3 | 0.753064 | 0.168718 | 0.657473 |\n| 5 | 7 | 0.552227 | 0.082363 | 0.739836 |\n| 6 | 2 | 0.502043 | 0.112479 | 0.852315 |\n| 7 | 1 | 0.334695 | 0.049990 | 0.902305 |\n| 8 | 8 | 0.324229 | 0.046329 | 0.948634 |\n\n为了达到至少 $C=0.9$ 的置信水平，我们必须累积概率直到总和 $\\geq 0.9$。\n- 包含前6个结果（直到 $n=2$）后，累积概率为 $0.852315$，小于 $0.9$。\n- 我们必须包含排序列表中的下一个结果，即 $n=1$（排名第7）。\n- 加上 $n=1$ 的概率，累积和变为 $0.852315 + 0.049990 = 0.902305$。这个总和现在超过了 $0.9$。\n\n接受域是所包含的结果集合：$\\{5, 4, 6, 3, 7, 2, 1\\}$。\n问题要求的是临界阈值 $R_c$，它通过条件 $R(n \\mid s_0) \\geq R_c$ 定义了这个区域。该阈值是添加到该区域的最后一个结果的似然比值。最后添加的结果是 $n=1$。\n因此，临界阈值 $R_c$ 是 $R(1 \\mid 1.5)$ 的值。\n\n**5. 计算最终值**\n$$R_c = R(1 \\mid 1.5) = \\left(\\frac{4.5}{\\max(3.0, 1)}\\right)^1 \\exp(\\max(3.0, 1) - 4.5)$$\n$$R_c = \\left(\\frac{4.5}{3.0}\\right) \\exp(3.0 - 4.5) = 1.5 \\exp(-1.5)$$\n数值上，这是：\n$$R_c = 1.5 \\times 0.22313016... = 0.33469524...$$\n四舍五入到四位有效数字，我们得到 $R_c = 0.3347$。", "answer": "$$\\boxed{0.3347}$$", "id": "3514604"}, {"introduction": "在为所有可能的信号强度$s$定义了接受域（构成所谓的“置信带”）之后，下一步就是“反演”这个置信带来获得我们最终的置信区间。这个练习通过提供预先计算好的接受域，让你能专注于反演过程本身，即根据给定的观测事件数$n$，找出所有包含该$n$值的接受域对应的$s$值集合。通过这个练习，你将清晰地看到Feldman-Cousins方法如何根据数据的“信号显著性”，平滑地从报告信号强度的上限过渡到给出一个双边测量区间 ([@problem_id:3514615])。", "problem": "在一个计算高能物理中典型的计数实验里，观测到的事件数 $n$ 被建模为一个泊松随机变量，其均值为 $\\mu = s + b$，其中 $s \\geq 0$ 是未知的信号期望，而 $b$ 是已知的本底期望。考虑 $b = 2.5$ 的情况。使用 Feldman-Cousins 统一方法构建区间时，接受域由似然比排序定义，即对于每个固定的 $s$，整数计数 $n$ 按以下比值递减排序：\n$$\nR(n; s) = \\frac{L(n \\mid s)}{L(n \\mid s_{\\mathrm{best}}(n))},\n$$\n其中 $L(n \\mid s) = \\exp(-(s+b))\\,(s+b)^{n}/n!$ 且 $s_{\\mathrm{best}}(n) = \\max\\{0, n - b\\}$ 是在物理约束 $s \\geq 0$ 下信号的最大似然估计。对于一个指定的置信水平（取 $90\\%$），接受域 $\\mathcal{A}(s)$ 的构建方法是，从最大的 $R(n; s)$ 开始，逐个包含结果 $n$，直到在 $L(n \\mid s)$ 下的总概率达到 $0.90$。\n\nFeldman-Cousins 置信区间是通过反演这个接受带得到的：对于给定的观测值 $n_{\\mathrm{obs}}$，其置信区间是所有使得 $n_{\\mathrm{obs}} \\in \\mathcal{A}(s)$ 成立的 $s$ 的集合。\n\n假设对于 $b=2.5$ 的情况，已经在 $90\\%$ 置信水平下预先计算了接受域 $\\mathcal{A}(s)$，并且对于特定的观测计数 $n \\in \\{0, 1, 2, 5\\}$，每个 $n$ 作为 $s$ 的函数在 $\\mathcal{A}(s)$ 中的成员关系由以下预先计算的阈值给出：\n- 对于 $n = 0$：$n \\in \\mathcal{A}(s)$ 当且仅当 $0 \\leq s \\leq 1.320$。\n- 对于 $n = 1$：$n \\in \\mathcal{A}(s)$ 当且仅当 $0 \\leq s \\leq 2.930$。\n- 对于 $n = 2$：$n \\in \\mathcal{A}(s)$ 当且仅当 $0 \\leq s \\leq 4.500$。\n- 对于 $n = 5$：$n \\in \\mathcal{A}(s)$ 当且仅当 $0.9800 \\leq s \\leq 7.450$。\n\n仅使用上述基本定义和提供的预先计算的接受成员关系，通过反演接受带，确定对于每个 $n \\in \\{0, 1, 2, 5\\}$，信号 $s$ 的 Feldman-Cousins $90\\%$ 置信区间。为每个 $n$ 清晰地标出区间端点 $(s_{\\mathrm{low}}(n), s_{\\mathrm{high}}(n))$。\n\n将你的最终数值答案以有序元组的形式返回：\n$$\n\\left(s_{\\mathrm{low}}(0),\\, s_{\\mathrm{high}}(0),\\, s_{\\mathrm{low}}(1),\\, s_{\\mathrm{high}}(1),\\, s_{\\mathrm{low}}(2),\\, s_{\\mathrm{high}}(2),\\, s_{\\mathrm{low}}(5),\\, s_{\\mathrm{high}}(5)\\right).\n$$\n将你的答案四舍五入到四位有效数字。不需要物理单位。\n\n此外，基于所提供的接受带，简要讨论在存在非零本底 $b = 2.5$ 的情况下，当 $n$ 从 $0$ 增加到 $5$ 时，Feldman-Cousins 区间的性质发生的定性变化。", "solution": "核心任务是，通过反演一个预先计算的接受带，为几个观测到的事件数 $n$ 确定信号强度 $s$ 的 $90\\%$ 置信区间。\n\n对于一个未知参数（此处为信号强度 $s$）和相应的观测值 $n_{\\mathrm{obs}}$，Feldman-Cousins 置信区间是通过“反演”接受带构建的。接受带是每个可能的真实值 $s$ 的接受域 $\\mathcal{A}(s)$ 的集合。接受域 $\\mathcal{A}(s)$ 是被认为代表该 $s$ 的可观测结果 $n$ 的集合，通常包含 $90\\%$（或其他指定的置信水平）的概率质量。\n\n反演过程定义如下：对于给定的观测值 $n_{\\mathrm{obs}}$，信号 $s$ 的置信区间是所有使得观测值 $n_{\\mathrm{obs}}$ 位于相应接受域 $\\mathcal{A}(s)$ 内的 $s$ 值的集合。在数学上，置信区间为：\n$$\n\\text{CI}(n_{\\mathrm{obs}}) = \\{s \\mid n_{\\mathrm{obs}} \\in \\mathcal{A}(s)\\}\n$$\n问题为观测计数 $n \\in \\{0, 1, 2, 5\\}$ 提供了在 $\\mathcal{A}(s)$ 中的成员资格的明确条件，这实际上给了我们反演的结果。我们只需读出每种情况下的区间即可。这些区间的端点表示为 $(s_{\\mathrm{low}}(n), s_{\\mathrm{high}}(n))$。\n\n情况 $n=0$：\n问题陈述，对于观测计数 $n = 0$，其在接受域 $\\mathcal{A}(s)$ 中的成员关系由条件 $0 \\leq s \\leq 1.320$ 定义。根据区间反演的定义，这个 $s$ 的范围恰好构成了观测值 $n_{\\mathrm{obs}} = 0$ 的 $90\\%$ 置信区间。\n因此，区间为 $[0, 1.320]$，端点为 $s_{\\mathrm{low}}(0) = 0$ 和 $s_{\\mathrm{high}}(0) = 1.320$。\n\n情况 $n=1$：\n对于 $n=1$ 的成员关系条件为 $0 \\leq s \\leq 2.930$。对观测值 $n_{\\mathrm{obs}} = 1$ 应用区间反演的定义， $s$ 的置信区间为 $[0, 2.930]$。\n端点为 $s_{\\mathrm{low}}(1) = 0$ 和 $s_{\\mathrm{high}}(1) = 2.930$。\n\n情况 $n=2$：\n对于 $n=2$ 的成员关系条件为 $0 \\leq s \\leq 4.500$。对于观测值 $n_{\\mathrm{obs}} = 2$，置信区间为 $[0, 4.500]$。\n端点为 $s_{\\mathrm{low}}(2) = 0$ 和 $s_{\\mathrm{high}}(2) = 4.500$。\n\n情况 $n=5$：\n对于 $n=5$ 的成员关系条件为 $0.9800 \\leq s \\leq 7.450$。对于观测值 $n_{\\mathrm{obs}} = 5$，置信区间为 $[0.9800, 7.450]$。\n端点为 $s_{\\mathrm{low}}(5) = 0.9800$ 和 $s_{\\mathrm{high}}(5) = 7.450$。\n\n问题要求将答案四舍五入到四位有效数字。所提供的非零端点（$1.320$、$2.930$、$4.500$、$0.9800$、$7.450$）已经用四位有效数字表示。对于 $n \\in \\{0, 1, 2\\}$，下限端点由于物理约束 $s \\geq 0$ 而精确为 $0$，而不是计算后四舍五入的结果。为了在最终答案中保持符号一致性，我们将这个精确值表示为 $0.000$，以匹配其他端点的小数精度。\n\n端点总结：\n- $s_{\\mathrm{low}}(0) = 0.000$, $s_{\\mathrm{high}}(0) = 1.320$\n- $s_{\\mathrm{low}}(1) = 0.000$, $s_{\\mathrm{high}}(1) = 2.930$\n- $s_{\\mathrm{low}}(2) = 0.000$, $s_{\\mathrm{high}}(2) = 4.500$\n- $s_{\\mathrm{low}}(5) = 0.9800$, $s_{\\mathrm{high}}(5) = 7.450$\n\n所要求的有序元组是：\n$$\n\\left(s_{\\mathrm{low}}(0),\\, s_{\\mathrm{high}}(0),\\, s_{\\mathrm{low}}(1),\\, s_{\\mathrm{high}}(1),\\, s_{\\mathrm{low}}(2),\\, s_{\\mathrm{high}}(2),\\, s_{\\mathrm{low}}(5),\\, s_{\\mathrm{high}}(5)\\right)\n$$\n\n关于区间定性性质的讨论：\n得到的区间展示了 Feldman-Cousins 统一方法的一个主要特征。已知的本底期望是 $b=2.5$。\n\n对于观测到的计数 $n \\in \\{0, 1, 2\\}$，事件数小于或与本底期望相当。在这些情况下，信号的最大似然估计为 $s_{\\mathrm{best}}(n) = \\max\\{0, n-b\\} = 0$。数据与纯本底假设（$s=0$）一致。相应的 Feldman-Cousins 置信区间分别为 $[0, 1.320]$、$[0, 2.930]$ 和 $[0, 4.500]$。这些是建立信号强度 $s$ 上限的单边区间。这是一个物理上合理的结果，因为观测并未提供足够的证据来声称存在非零信号。该方法自然地包含了物理边界 $s \\geq 0$，并且不会产生非物理的负区间。\n\n相比之下，对于观测到的计数 $n=5$，事件数显著大于本底期望（$5  2.5$）。此时，$s_{\\mathrm{best}}(5) = \\max\\{0, 5-2.5\\} = 2.5$。得到的置信区间 $[0.9800, 7.450]$ 是一个双边区间。关键是，其下界严格大于零。这表明纯本底假设（$s=0$）在 $90\\%$ 置信水平上被排除，为信号的存在提供了统计证据。\n\n定性上的变化是，当信号微弱或不存在时，报告一个上限；当信号显著时，报告一个双边测量区间，这是一个平滑的过渡。这正是该方法的“统一”之处，它避免了在观察数据后才决定是报告上限还是双边区间的有问题的“摇摆”做法。", "answer": "$$\\boxed{(0.000, 1.320, 0.000, 2.930, 0.000, 4.500, 0.9800, 7.450)}$$", "id": "3514615"}, {"introduction": "在实际的物理分析中，验证我们所使用的统计方法是否具有其声称的性质是至关重要的一步。Feldman-Cousins方法的一个关键优点是保证了正确的频率覆盖率。这个练习将指导你设计一个伪实验（或称“玩具蒙特卡洛”研究）来经验性地验证这一点，这是计算高能物理中的一项标准实践。你将学习如何正确地生成伪数据，并评估在此过程中可能遇到的常见概念陷阱，同时本问题还引入了如何处理讨厌参数（nuisance parameter）的真实复杂性 ([@problem_id:3514663])。", "problem": "一个计算高能物理中的计数实验观测到一个事件数，其模型为 $n \\sim \\mathrm{Poisson}(s + b)$，其中 $s \\ge 0$ 是我们感兴趣的信号率，$b \\ge 0$ 是一个本底率。一个辅助控制测量 $x$ 对 $b$ 提供了一个高斯约束，其模型为 $x \\sim \\mathcal{N}(b, \\sigma_b)$，其中标准差 $\\sigma_b  0$ 已知。联合似然为 $L(n, x; s, b) = \\mathrm{Poisson}(n \\mid s + b) \\cdot \\mathcal{N}(x \\mid b, \\sigma_b)$。您使用 Neyman 构造法，基于联合似然以及对讨厌参数 $b$ 的剖析，采用似然比 (LR) 排序原则，为 $s$ 构建一个置信水平为 $90\\%$ 的 Feldman-Cousins (FC) 置信区间。对于每个候选的 $s$，排序量是剖面似然比 $R(n, x; s) = L(n, x; s, \\hat{b}_s)/L(n, x; \\hat{s}, \\hat{b})$，其中 $\\hat{b}_s$ 是在固定 $s$ 约束下 $b$ 的最大似然估计 (MLE)，而 $(\\hat{s}, \\hat{b})$ 是无约束的最大似然估计，并强制 $s \\ge 0$。\n\n您的目标是通过伪实验 (蒙特卡洛 (MC) 模拟) 来经验性地验证，在特定的固定真实参数 $s_\\mathrm{true} \\in \\{0, 1, 3\\}$ 和 $b_\\mathrm{true} = 2.5$ (已知 $\\sigma_b = 0.5$) 下，为 $s$ 构建的 $90\\%$ FC 区间的频率论覆盖率。对于固定的 $(s_\\mathrm{true}, b_\\mathrm{true})$，水平为 $1 - \\alpha$ 的频率论覆盖率定义为：相对于在 $(s_\\mathrm{true}, b_\\mathrm{true})$ 处的 $(n, x)$ 抽样分布，所构建的 $s$ 的区间包含 $s_\\mathrm{true}$ 的概率。如果该构造具有名义覆盖率，则在大量伪实验的极限下，此概率应等于 $1 - \\alpha = 90\\%$。\n\n以下哪个程序能够对所述的 $(s_\\mathrm{true}, b_\\mathrm{true})$ 下 $s$ 的 $90\\%$ FC 区间的覆盖率，给出一个无偏的经验估计？\n\nA. 对于每个 $s_\\mathrm{true}$，抽取一个单一的辅助值 $x_\\ast \\sim \\mathcal{N}(b_\\mathrm{true}, \\sigma_b)$，并在所有伪实验中将 $b$ 固定为 $x_\\ast$。然后生成 $N_\\mathrm{toys}$ 个值 $n_i \\sim \\mathrm{Poisson}(s_\\mathrm{true} + x_\\ast)$，对每个 $n_i$ 使用基于 $L(n, x_\\ast; s, b)$（其中 $x$ 固定为 $x_\\ast$）的 LR 排序来构建一个 FC 区间，并将包含 $s_\\mathrm{true}$ 的区间比例作为覆盖率的估计。\n\nB. 对于每个 $s_\\mathrm{true}$，固定 $b_\\mathrm{true}$ 并生成 $N_\\mathrm{toys}$ 个独立的对 $(n_i, x_i)$，其中 $x_i \\sim \\mathcal{N}(b_\\mathrm{true}, \\sigma_b)$ 且 $n_i \\sim \\mathrm{Poisson}(s_\\mathrm{true} + b_\\mathrm{true})$，它们在给定 $(s_\\mathrm{true}, b_\\mathrm{true})$ 的条件下独立。使用与分析中相同的 FC 构造方法：对于每个候选的 $s$，从 $b$ 被剖析的联合似然中定义 $R(n, x; s)$，并通过选择 LR 阈值来确定 $(n, x)$ 空间中的临界接受域，使得在联合抽样分布 $P(n, x \\mid s, b_\\mathrm{true})$下的概率质量等于 $90\\%$。对每个观测到的 $(n_i, x_i)$，通过反转该接受域来获得 FC 区间，并将包含 $s_\\mathrm{true}$ 的区间比例作为覆盖率的估计。\n\nC. 对于每个 $s_\\mathrm{true}$，指定一个先验 $\\pi(b)$，并在每个伪实验中抽取 $b_i \\sim \\pi(b)$，然后抽取 $x_i \\sim \\mathcal{N}(b_i, \\sigma_b)$ 和 $n_i \\sim \\mathrm{Poisson}(s_\\mathrm{true} + b_i)$。通过使用 $L(n, x; s, b)$（其中 $b$ 被剖析）的 FC LR 排序来为 $s$ 构建区间，并将包含 $s_\\mathrm{true}$ 的区间比例作为覆盖率的估计。\n\nD. 对于每个 $s_\\mathrm{true}$，如选项 B 那样生成 $N_\\mathrm{toys}$ 个独立的对 $(n_i, x_i)$，但是通过反转基于 Wilks 定理对 $-2 \\ln \\lambda(s)$ 的渐近剖面似然检验来构建 $s$ 的区间，而不是在 $(n, x)$ 空间中构建 LR 排序的接受域。将包含 $s_\\mathrm{true}$ 的区间比例作为覆盖率的估计。\n\n假设 $N_\\mathrm{toys}$ 很大 (例如，$N_\\mathrm{toys} = 10^5$)，用于 MLE 的数值优化是精确的，并且在伪实验中必须使用与实际分析中相同的区间构建规则。选择能够正确实现对具有高斯讨厌参数约束的指定 FC 构造进行无偏频率论覆盖率研究的唯一最佳选项。", "solution": "问题要求找到正确的程序，以经验性地验证信号率 $s$ 的 Feldman-Cousins (FC) 置信区间的频率论覆盖率。实验观测由一个事件数 $n$ 和一个辅助测量 $x$ 组成。模型由联合似然 $L(n, x; s, b) = \\mathrm{Poisson}(n \\mid s + b) \\cdot \\mathcal{N}(x \\mid b, \\sigma_b)$ 描述，其中 $b$ 是本底率的讨厌参数。\n\n首先，我们必须确立频率论覆盖率研究的基本原则。一个置信区间程序的频率论覆盖率是相对于模型所有参数的固定的、真实的值来定义的。在这种情况下，参数是信号率 $s$ 和本底率 $b$。在参数空间中针对一个特定点 $(s_\\mathrm{true}, b_\\mathrm{true})$ 的覆盖率研究按以下步骤进行：\n1.  假设一个“真实”的自然状态由固定参数 $s = s_\\mathrm{true}$ 和 $b = b_\\mathrm{true}$ 定义。\n2.  模拟大量独立的实验。每个实验根据其以真实参数为条件的联合概率分布生成一个随机的可观测量数据集 $(n_i, x_i)$：$n_i \\sim \\mathrm{Poisson}(s_\\mathrm{true} + b_\\mathrm{true})$ 和 $x_i \\sim \\mathcal{N}(b_\\mathrm{true}, \\sigma_b)$。\n3.  对于每个模拟的数据集 $(n_i, x_i)$，使用正在评估的精确统计程序为感兴趣的参数 $s$ 构建置信区间。在本例中，该程序是指定的带有似然比排序的 Feldman-Cousins 构造法。\n4.  然后，经验覆盖率被计算为这些构建的区间中包含用于生成数据的真实值 $s_\\mathrm{true}$ 的比例。\n\n对于一个置信水平为 $1-\\alpha$ 的置信区间程序，频率论原则保证对于所有可能的参数真值 $(s, b)$，其覆盖率将大于或等于 $1-\\alpha$。Feldman-Cousins 方法是专门设计来避免覆盖不足，并提供名义上为 $1-\\alpha$ 的覆盖率。验证此属性需要上述的模拟程序。\n\n现在，我们将根据这一原则评估每个提议的选项。\n\n**选项 A 评估**\n该选项建议抽取一个单一的辅助值 $x_\\ast \\sim \\mathcal{N}(b_\\mathrm{true}, \\sigma_b)$，然后对所有伪实验都将此值固定。事件数随后生成为 $n_i \\sim \\mathrm{Poisson}(s_\\mathrm{true} + x_\\ast)$。这个程序存在根本性缺陷。在频率论框架中，可观测量是随机变量。$n$ 和 $x$ 都是可观测量。通过将 $x$ 固定为单个实现值 $x_\\ast$，该程序没有模拟完整的实验。它检查的是以 $x = x_\\ast$ 为条件的覆盖率，而不是整个实验的无条件覆盖率。所使用的抽样分布是错误的；它应该是在 $(n, x)$ 的联合空间上，这意味着在每个伪实验中，必须从由 $(s_\\mathrm{true}, b_\\mathrm{true})$ 定义的各自的分布中抽取 $n$ 和 $x$ 的*新*实现值。此程序将讨厌参数 $b$ 与其测量值 $x$ 混为一谈。\n**结论：** **错误**。\n\n**选项 B 评估**\n该选项描述了以下程序：\n1. 对于每对真实参数 $(s_\\mathrm{true}, b_\\mathrm{true})$，生成 $N_\\mathrm{toys}$ 个独立的可观测量对 $(n_i, x_i)$。\n2. 生成过程根据正确的抽样分布进行：$x_i \\sim \\mathcal{N}(b_\\mathrm{true}, \\sigma_b)$ 和 $n_i \\sim \\mathrm{Poisson}(s_\\mathrm{true} + b_\\mathrm{true})$。\n3. 对于每个模拟对 $(n_i, x_i)$，使用问题陈述中指定的方法（带有LR排序和对$b$进行剖析的FC构造法）为 $s$ 构建置信区间。\n4. 经验覆盖率被估计为包含 $s_\\mathrm{true}$ 的区间的比例。\n\n此程序完全符合经验性频率论覆盖率研究的定义。它正确地将真实参数识别为固定常数，正确地模拟了两个可观测量 $(n, x)$ 的随机性，并使用正确的方法为每个模拟实验构建区间。对FC构造法的描述虽然略有简化，但正确地指出了关键组成部分（反转接受域、使用LR排序、寻找阈值），并关键性地指出使用了与分析中相同的FC构造法。\n**结论：** **正确**。\n\n**选项 C 评估**\n该选项为讨厌参数 $b$ 引入了一个先验分布 $\\pi(b)$，并在每个伪实验中抽取一个值 $b_i \\sim \\pi(b)$。然后，可观测量被生成为 $x_i \\sim \\mathcal{N}(b_i, \\sigma_b)$ 和 $n_i \\sim \\mathrm{Poisson}(s_\\mathrm{true} + b_i)$。这不是一个频率论覆盖率研究。频率论覆盖率是为参数（包括讨厌参数）的*固定*值定义的属性。此程序评估的是一个不同的量：在讨厌参数 $b$ 的一个分布上平均的覆盖率。虽然这可能是一个相关的研究，但它没有回答在特定点 $(s_\\mathrm{true}, b_\\mathrm{true} = 2.5)$ 验证频率论覆盖率的问题，而这是问题陈述和频率论覆盖率定义所要求的。它将贝叶斯概念（参数的先验）混入了一个频率论检验中。\n**结论：** **错误**。\n\n**选项 D 评估**\n该选项像选项B一样正确地生成了伪实验数据集 $(n_i, x_i)$。然而，它建议使用一种不同的方法来构建置信区间：“通过反转基于Wilks定理的渐近剖面似然检验”。该方法将检验统计量 $-2 \\ln R(n, x; s)$ 的分布近似为一个自由度为1的卡方分布，即 $-2 \\ln R(n, x; s) \\sim \\chi^2_1$。相比之下，Feldman-Cousins 程序不依赖于这种渐近近似。相反，它使用似然比进行排序来构建接受域，并通过蒙特卡洛模拟或对每个假设的 $s$ 进行直接计算，来确定给定置信水平下的似然比临界值。渐近方法和FC方法是截然不同的程序，它们会产生不同的区间，尤其是在低统计量或接近物理边界的情况下，而这些恰恰是FC方法最有价值的场景。问题要求使用“与实际分析中使用的……相同的区间构建规则”，即FC方法。该选项通过替换为另一个虽然相关但不同的程序，违反了这一关键条件。\n**结论：** **错误**。", "answer": "$$\\boxed{B}$$", "id": "3514663"}]}