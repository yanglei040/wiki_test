{"hands_on_practices": [{"introduction": "本练习介绍高能物理学中的一项基石技术：在计数实验中合并来自多个通道的数据。我们将基于各个泊松分布的通道构建一个联合似然函数，通过使用控制区来约束背景不确定性，并应用最大似然估计原理，对讨厌参数（nuisance parameters）进行剖面（profiling）以提取共同的信号强度 $\\mu$。这项实践旨在巩固基于似然的组合分析的基本机制，以及使用费雪信息矩阵（Fisher information matrix）计算统计不确定性的方法。", "problem": "在一次典型的高能物理计算中的双通道测量中，考虑两个统计独立的通道，索引为 $k \\in \\{1,2\\}$。每个通道都有一个信号区（SR）计数 $n^{SR}_k$ 和一个控制区（CR）计数 $n^{CR}_k$。信号区被建模为泊松过程，其均值为\n$$\n\\lambda^{SR}_k(\\mu, b_k) = \\mu\\, s^{SR}_k + t_k\\, b_k,\n$$\n其中 $\\mu$ 是一个共同的信号强度参数，用于缩放信号区中已知的预期信号产额 $s^{SR}_k$，$t_k$ 是一个已知的转移因子，它将控制区的本底率 $b_k$ 与信号区的预期本底联系起来。控制区被建模为泊松过程，其均值为\n$$\n\\lambda^{CR}_k(b_k) = b_k.\n$$\n假设在给定 $(\\mu, b_1, b_2)$ 的条件下，各通道是独立的，并且联合似然是两个通道在两个区域中的泊松似然的乘积。\n\n从泊松似然的定义和最大似然估计（MLE）的概念出发，通过对本底率 $b_k$ 进行剖析（profiling），推导出组合的 MLE $\\hat{\\mu}$，并使用观测信息（定义为在 MLE 处评估并对 $b_k$ 进行剖析的对数似然函数的负海森矩阵）计算 $\\hat{\\mu}$ 的近似标准差。\n\n使用以下指定的数值：\n- 通道 1：$n^{SR}_1 = 11$， $n^{CR}_1 = 40$， $s^{SR}_1 = 5.0$， $t_1 = 0.2$。\n- 通道 2：$n^{SR}_2 = 10$， $n^{CR}_2 = 14$， $s^{SR}_2 = 5.0$， $t_2 = 0.5$。\n\n将组合的 $\\hat{\\mu}$ 及其近似标准差均四舍五入到四位有效数字。将这两个量表示为无量纲数。", "solution": "用户提供了一个适定（well-posed）的高能物理统计问题。该问题具有科学依据，是客观的，并包含了唯一解所需的所有必要信息。\n\n首先，我们为两个通道（索引为 $k \\in \\{1,2\\}$）定义参数和观测量：\n- 信号区（SR）中的观测量：$n^{SR}_k$\n- 控制区（CR）中的观测量：$n^{CR}_k$\n- 信号区中的预期信号产额：$s^{SR}_k$\n- 从CR到SR的转移因子：$t_k$\n- 信号强度修正因子：$\\mu$\n- CR中的本底率（无关参数）：$b_k$\n\n信号区和控制区的计数被建模为独立的泊松过程。每个区域的泊松分布的均值由以下公式给出：\n- 信号区均值：$\\lambda^{SR}_k(\\mu, b_k) = \\mu\\, s^{SR}_k + t_k\\, b_k$\n- 控制区均值：$\\lambda^{CR}_k(b_k) = b_k$\n\n联合似然函数 $L(\\mu, b_1, b_2)$ 是四个泊松概率的乘积：\n$$L(\\mu, b_1, b_2) = \\prod_{k=1,2} \\left[ \\frac{(\\lambda^{SR}_k)^{n^{SR}_k} \\exp(-\\lambda^{SR}_k)}{n^{SR}_k!} \\cdot \\frac{(\\lambda^{CR}_k)^{n^{CR}_k} \\exp(-\\lambda^{CR}_k)}{n^{CR}_k!} \\right]$$\n为了找到最大似然估计（MLEs），我们最大化对数似然函数 $\\ell = \\ln L$。忽略常数阶乘项，我们得到：\n$$\\ell(\\mu, b_1, b_2) = \\sum_{k=1,2} \\left[ n^{SR}_k \\ln(\\lambda^{SR}_k) - \\lambda^{SR}_k + n^{CR}_k \\ln(\\lambda^{CR}_k) - \\lambda^{CR}_k \\right]$$\n代入均值的表达式：\n$$\\ell(\\mu, b_1, b_2) = \\sum_{k=1,2} \\left[ n^{SR}_k \\ln(\\mu s^{SR}_k + t_k b_k) - (\\mu s^{SR}_k + t_k b_k) + n^{CR}_k \\ln(b_k) - b_k \\right]$$\n为了找到 MLEs $(\\hat{\\mu}, \\hat{b}_1, \\hat{b}_2)$，我们将 $\\ell$ 对每个参数的偏导数设为零：\n1. $\\frac{\\partial \\ell}{\\partial \\mu} = \\sum_{k=1,2} \\left( \\frac{n^{SR}_k s^{SR}_k}{\\mu s^{SR}_k + t_k b_k} - s^{SR}_k \\right) = 0$\n2. $\\frac{\\partial \\ell}{\\partial b_k} = \\frac{n^{SR}_k t_k}{\\mu s^{SR}_k + t_k b_k} - t_k + \\frac{n^{CR}_k}{b_k} - 1 = 0 \\quad \\text{对于 } k=1,2$\n\n请注意，对于均值为 $\\lambda$ 的简单泊松测量 $n$，其 MLE 为 $\\hat{\\lambda}=n$。在我们的多参数问题中，参数是受约束的。然而，让我们研究一下无约束最大值（即每个区域的预期事件数等于观测数）是否满足给定数据的模型约束。\n均值的无约束 MLEs 将是 $\\hat{\\lambda}^{SR}_k = n^{SR}_k$ 和 $\\hat{\\lambda}^{CR}_k = n^{CR}_k$。\n根据控制区的定义，$\\hat{\\lambda}^{CR}_k = b_k$，因此这意味着 $\\hat{b}_k = n^{CR}_k$。\n将这些代入信号区均值的模型方程，得到关于 $\\mu$ 的一个条件：\n$$n^{SR}_k = \\mu s^{SR}_k + t_k n^{CR}_k \\implies \\mu = \\frac{n^{SR}_k - t_k n^{CR}_k}{s^{SR}_k}$$\n要使这成为组合拟合的有效解，从每个通道推导出的 $\\mu$ 值必须相同。让我们用给定的数值来检验这一点。\n- 通道 1：$n^{SR}_1 = 11$, $n^{CR}_1 = 40$, $s^{SR}_1 = 5.0$, $t_1 = 0.2$。\n$$\\mu_1 = \\frac{11 - (0.2)(40)}{5.0} = \\frac{11 - 8}{5.0} = \\frac{3}{5.0} = 0.6$$\n- 通道 2：$n^{SR}_2 = 10$, $n^{CR}_2 = 14$, $s^{SR}_2 = 5.0$, $t_2 = 0.5$。\n$$\\mu_2 = \\frac{10 - (0.5)(14)}{5.0} = \\frac{10 - 7}{5.0} = \\frac{3}{5.0} = 0.6$$\n由于 $\\mu_1 = \\mu_2$，点 $(\\hat{\\mu}, \\hat{b}_1, \\hat{b}_2) = (0.6, 40, 14)$ 同时满足所有三个参数的一阶条件。该点对应于似然函数的全局最大值，且恰好位于模型定义的约束曲面上。\n因此，信号强度的组合 MLE 为 $\\hat{\\mu} = 0.6$。\n\n接下来，我们计算 $\\hat{\\mu}$ 的近似标准差。对于大样本，MLE $\\hat{\\theta}$ 的方差可以通过观测信息矩阵 $J(\\hat{\\theta}) = -\\frac{\\partial^2 \\ell}{\\partial \\theta_i \\partial \\theta_j} \\big|_{\\hat{\\theta}}$ 的逆来近似。\n当存在无关参数（这里是 $b_k$）时，感兴趣参数（$\\mu$）的方差可以从完整信息矩阵的逆的相应对角元素中获得。这等效于使用 $\\mu$ 的剖析信息的逆。\n剖析参数 $\\mu$ 的信息由 $I_{p}(\\mu) = I_{\\mu\\mu} - \\mathbf{I}_{\\mu b} \\mathbf{I}_{bb}^{-1} \\mathbf{I}_{b\\mu}$ 给出，其中 $I_{ij} = -H_{ij} = -\\frac{\\partial^2 \\ell}{\\partial\\theta_i \\partial\\theta_j}$。\n海森矩阵的元素是：\n$H_{\\mu\\mu} = \\frac{\\partial^2 \\ell}{\\partial \\mu^2} = -\\sum_k \\frac{n^{SR}_k (s^{SR}_k)^2}{(\\lambda^{SR}_k)^2}$\n$H_{b_k b_k} = \\frac{\\partial^2 \\ell}{\\partial b_k^2} = -\\frac{n^{SR}_k t_k^2}{(\\lambda^{SR}_k)^2} - \\frac{n^{CR}_k}{b_k^2}$\n$H_{\\mu b_k} = \\frac{\\partial^2 \\ell}{\\partial \\mu \\partial b_k} = -\\frac{n^{SR}_k s^{SR}_k t_k}{(\\lambda^{SR}_k)^2}$\n$H_{b_1 b_2} = 0$，这使得矩阵 $\\mathbf{H}_{bb}$ 是对角的。\n\n我们在 MLEs 处评估这些值：$\\hat{\\mu}=0.6$, $\\hat{b}_1=40$, $\\hat{b}_2=14$。在这一点上，$\\hat{\\lambda}^{SR}_k = n^{SR}_k$ 且 $\\hat{b}_k = n^{CR}_k$。\n$H_{\\mu\\mu} = -\\sum_k \\frac{(s^{SR}_k)^2}{n^{SR}_k} = -\\left( \\frac{5.0^2}{11} + \\frac{5.0^2}{10} \\right) = -25 \\left(\\frac{1}{11} + \\frac{1}{10}\\right) = -\\frac{525}{110} = -\\frac{105}{22}$。\n$H_{b_k b_k} = -\\frac{n^{SR}_k t_k^2}{(n^{SR}_k)^2} - \\frac{n^{CR}_k}{(n^{CR}_k)^2} = -\\frac{t_k^2}{n^{SR}_k} - \\frac{1}{n^{CR}_k}$。\n$H_{\\mu b_k} = -\\frac{s^{SR}_k t_k}{n^{SR}_k}$。\n\n方差 $\\sigma^2_{\\hat{\\mu}}$ 由 $(I_p(\\hat{\\mu}))^{-1}$ 给出。\n$I_p(\\hat{\\mu}) = -H_{\\mu\\mu} - \\sum_k \\frac{H_{\\mu b_k}^2}{H_{b_k b_k}} = \\sum_k \\left( -H_{\\mu\\mu,k} - \\frac{H_{\\mu b_k, k}^2}{H_{b_k b_k, k}} \\right)$，其中求和是针对所有通道。\n来自每个通道的信息是线性相加的。对于单个通道 $k$，其信息为：\n$I_k = -H_{\\mu\\mu, k} - \\frac{H_{\\mu b_k,k}^2}{H_{b_k b_k,k}} = \\frac{(s^{SR}_k)^2}{n^{SR}_k} - \\frac{(-s^{SR}_k t_k/n^{SR}_k)^2}{-(t_k^2/n^{SR}_k + 1/n^{CR}_k)}$\n$I_k = \\frac{(s^{SR}_k)^2}{n^{SR}_k} \\left( 1 - \\frac{t_k^2/n^{SR}_k}{(t_k^2 n^{CR}_k + n^{SR}_k)/(n^{SR}_k n^{CR}_k)} \\right) = \\frac{(s^{SR}_k)^2}{n^{SR}_k} \\left( 1 - \\frac{t_k^2 n^{CR}_k}{t_k^2 n^{CR}_k + n^{SR}_k} \\right)$\n$I_k = \\frac{(s^{SR}_k)^2}{n^{SR}_k} \\left( \\frac{n^{SR}_k}{n^{SR}_k + t_k^2 n^{CR}_k} \\right) = \\frac{(s^{SR}_k)^2}{n^{SR}_k + t_k^2 n^{CR}_k}$。\n这是一个标准结果。总信息是各通道信息之和：$I_p(\\hat{\\mu}) = \\sum_k I_k$。\n\n- 通道 1：$I_1 = \\frac{5.0^2}{11 + 0.2^2(40)} = \\frac{25}{11 + 1.6} = \\frac{25}{12.6} = \\frac{125}{63}$。\n- 通道 2：$I_2 = \\frac{5.0^2}{10 + 0.5^2(14)} = \\frac{25}{10 + 3.5} = \\frac{25}{13.5} = \\frac{50}{27}$。\n\n$I_p(\\hat{\\mu}) = I_1 + I_2 = \\frac{125}{63} + \\frac{50}{27} = \\frac{375 + 350}{189} = \\frac{725}{189}$。\n方差为 $\\sigma^2_{\\hat{\\mu}} = \\frac{1}{I_p(\\hat{\\mu})} = \\frac{189}{725}$。\n标准差为 $\\sigma_{\\hat{\\mu}} = \\sqrt{\\frac{189}{725}} \\approx 0.510577765$。\n\n将结果四舍五入到四位有效数字：\n$\\hat{\\mu} = 0.6000$\n$\\sigma_{\\hat{\\mu}} \\approx 0.5106$", "answer": "$$ \\boxed{ \\begin{pmatrix} 0.6000  0.5106 \\end{pmatrix} } $$", "id": "3509004"}, {"introduction": "真实的分析往往由系统不确定性主导，而这些不确定性在不同通道间的相关性会显著影响最终结果，本练习旨在探讨这一关键方面。我们将采用高斯似然框架，模拟一个主要系统不确定性（如光度）的影响，您将计算在两种不同假设下——即系统不确定性在通道间不相关与完全相关——组合信号强度估计量的方差。这项实践提供了关于正确建模相关性重要性的定量见解，并揭示了错误的建模如何导致对最终精度的不正确估计。", "problem": "考虑在计算高能物理（HEP）中对信号强度参数 $\\mu$ 进行的双通道测量，其中每个通道 $i \\in \\{1,2\\}$ 提供一个近似高斯分布的可观测量 $y_{i}$，其均值为 $\\mu s_{i}$，以及一个由统计不确定度和一个主导的归一化系统不确定度构成的不确定度预算。在大样本（渐近）情况下，并假设联合向量 $\\mathbf{y} = (y_{1}, y_{2})^{\\top}$ 的高斯似然，其均值为 $\\boldsymbol{\\mu} = \\mu \\mathbf{s}$，其中 $\\mathbf{s} = (s_{1}, s_{2})^{\\top}$ 表示 $\\mu = 1$ 时的标称信号产额。\n\n主导的系统不确定度是一个积分亮度不确定度，它以分数大小 $f$ 乘性地作用于产额，其对 $\\mu = 1$ 时各通道产额的影响可以线性化为绝对标准差 $d_{i} = f s_{i}$。你需要比较这个单一主导系统不确定度在两个通道间的两种假设：\n- 独立性假设：亮度不确定度的贡献在通道间被视为独立的，仅将 $d_{i}^{2}$ 加到协方差矩阵的对角元素上。\n- 完全相关假设：亮度不确定度被视为完全相关的，贡献一个秩为1的协方差项 $\\mathbf{d}\\mathbf{d}^{\\top}$，其中 $\\mathbf{d} = (d_{1}, d_{2})^{\\top}$。\n\n假设针对 $\\mu$ 接近1的分析，使用以下科学上合理的输入：\n- 标称信号产额: $s_{1} = 80$, $s_{2} = 120$。\n- 统计标准差: $\\sigma_{\\text{stat},1} = 20$, $\\sigma_{\\text{stat},2} = 25$。\n- 主导的亮度分数不确定度: $f = 0.05$。\n\n仅使用高斯似然框架和费雪信息的第一性原理，推导并计算在每种主导系统不确定度假设下组合估计量 $\\hat{\\mu}$ 的方差，然后计算由下式定义的方差变化\n$$\\Delta \\mathrm{Var}(\\hat{\\mu}) \\equiv \\mathrm{Var}_{\\text{full corr}}(\\hat{\\mu}) - \\mathrm{Var}_{\\text{indep}}(\\hat{\\mu}).$$\n将你的最终数值答案四舍五入到四位有效数字。将最终量表示为无量纲数（无单位）。", "solution": "该问题被认为是有效的，因为它科学地基于高能物理中使用的统计方法，问题陈述清晰且提供了所有必要信息，并以客观、正式的语言表述。不存在矛盾、歧义或事实不准确之处。\n\n该问题要求计算信号强度参数 $\\mu$ 的最大似然估计量（MLE）的方差。该框架是一个双通道测量，其可观测量 $\\mathbf{y} = (y_1, y_2)^{\\top}$ 由多元高斯似然描述。在大样本极限下，MLE $\\hat{\\mu}$ 的方差由克拉默-拉奥下限（Cramér-Rao Lower Bound）给出，即费雪信息 $I(\\mu)$ 的倒数。\n\n似然函数由下式给出：\n$$L(\\mu; \\mathbf{y}) \\propto \\exp\\left(-\\frac{1}{2} (\\mathbf{y} - \\mu\\mathbf{s})^{\\top} \\mathbf{V}^{-1} (\\mathbf{y} - \\mu\\mathbf{s})\\right)$$\n其中 $\\mathbf{s} = (s_1, s_2)^{\\top}$ 是标称信号产额的向量，$\\mathbf{V}$ 是可观测量的总协方差矩阵。对数似然函数为：\n$$\\ln L(\\mu) = C - \\frac{1}{2} (\\mathbf{y} - \\mu\\mathbf{s})^{\\top} \\mathbf{V}^{-1} (\\mathbf{y} - \\mu\\mathbf{s})$$\n其中 $C$ 是一个与 $\\mu$ 无关的常数。\n\n费雪信息 $I(\\mu)$ 计算为 $I(\\mu) = -E\\left[\\frac{\\partial^2 \\ln L}{\\partial \\mu^2}\\right]$。\n关于 $\\mu$ 的一阶导数为：\n$$\\frac{\\partial \\ln L}{\\partial \\mu} = - \\frac{1}{2} \\left[ (-\\mathbf{s})^{\\top} \\mathbf{V}^{-1} (\\mathbf{y} - \\mu\\mathbf{s}) + (\\mathbf{y} - \\mu\\mathbf{s})^{\\top} \\mathbf{V}^{-1} (-\\mathbf{s}) \\right] = \\mathbf{s}^{\\top} \\mathbf{V}^{-1} (\\mathbf{y} - \\mu\\mathbf{s})$$\n二阶导数为：\n$$\\frac{\\partial^2 \\ln L}{\\partial \\mu^2} = \\frac{\\partial}{\\partial \\mu} \\left[ \\mathbf{s}^{\\top} \\mathbf{V}^{-1} \\mathbf{y} - \\mu \\mathbf{s}^{\\top} \\mathbf{V}^{-1} \\mathbf{s} \\right] = -\\mathbf{s}^{\\top} \\mathbf{V}^{-1} \\mathbf{s}$$\n由于二阶导数与数据 $\\mathbf{y}$ 无关，其期望值的计算是平凡的：\n$$I(\\mu) = -E\\left[-\\mathbf{s}^{\\top} \\mathbf{V}^{-1} \\mathbf{s}\\right] = \\mathbf{s}^{\\top} \\mathbf{V}^{-1} \\mathbf{s}$$\n因此，估计量 $\\hat{\\mu}$ 的方差为：\n$$\\mathrm{Var}(\\hat{\\mu}) = I(\\mu)^{-1} = (\\mathbf{s}^{\\top} \\mathbf{V}^{-1} \\mathbf{s})^{-1}$$\n我们现在必须为两种假设分别构建协方差矩阵 $\\mathbf{V}$。总协方差矩阵是统计协方差矩阵和系统协方差矩阵之和，$\\mathbf{V} = \\mathbf{V}_{\\text{stat}} + \\mathbf{V}_{\\text{sys}}$。\n\n首先，我们以矩阵/向量形式定义给定的量：\n标称信号产额: $\\mathbf{s} = \\begin{pmatrix} s_1 \\\\ s_2 \\end{pmatrix} = \\begin{pmatrix} 80 \\\\ 120 \\end{pmatrix}$。\n统计标准差: $\\sigma_{\\text{stat},1} = 20$, $\\sigma_{\\text{stat},2} = 25$。\n统计协方差矩阵 $\\mathbf{V}_{\\text{stat}}$ 是对角矩阵，因为统计不确定度是独立的：\n$$\\mathbf{V}_{\\text{stat}} = \\begin{pmatrix} \\sigma_{\\text{stat},1}^2  0 \\\\ 0  \\sigma_{\\text{stat},2}^2 \\end{pmatrix} = \\begin{pmatrix} 20^2  0 \\\\ 0  25^2 \\end{pmatrix} = \\begin{pmatrix} 400  0 \\\\ 0  625 \\end{pmatrix}$$\n系统不确定度由分数大小 $f=0.05$ 定义。产额的绝对标准差为 $d_i = f s_i$：\n$d_1 = 0.05 \\times 80 = 4$\n$d_2 = 0.05 \\times 120 = 6$\n系统标准差的向量为 $\\mathbf{d} = \\begin{pmatrix} 4 \\\\ 6 \\end{pmatrix}$。\n\n**独立性假设**\n在此假设下，系统不确定度是不相关的。系统协方差矩阵 $\\mathbf{V}_{\\text{sys, indep}}$ 是对角矩阵：\n$$\\mathbf{V}_{\\text{sys, indep}} = \\begin{pmatrix} d_1^2  0 \\\\ 0  d_2^2 \\end{pmatrix} = \\begin{pmatrix} 4^2  0 \\\\ 0  6^2 \\end{pmatrix} = \\begin{pmatrix} 16  0 \\\\ 0  36 \\end{pmatrix}$$\n总协方差矩阵 $\\mathbf{V}_{\\text{indep}}$ 为：\n$$\\mathbf{V}_{\\text{indep}} = \\mathbf{V}_{\\text{stat}} + \\mathbf{V}_{\\text{sys, indep}} = \\begin{pmatrix} 400  0 \\\\ 0  625 \\end{pmatrix} + \\begin{pmatrix} 16  0 \\\\ 0  36 \\end{pmatrix} = \\begin{pmatrix} 416  0 \\\\ 0  661 \\end{pmatrix}$$\n费雪信息为 $I_{\\text{indep}} = \\mathbf{s}^{\\top} \\mathbf{V}_{\\text{indep}}^{-1} \\mathbf{s}$。由于 $\\mathbf{V}_{\\text{indep}}$ 是对角矩阵，计算很简单：\n$$I_{\\text{indep}} = \\begin{pmatrix} 80  120 \\end{pmatrix} \\begin{pmatrix} 1/416  0 \\\\ 0  1/661 \\end{pmatrix} \\begin{pmatrix} 80 \\\\ 120 \\end{pmatrix} = \\frac{80^2}{416} + \\frac{120^2}{661} = \\frac{6400}{416} + \\frac{14400}{661}$$\n$$I_{\\text{indep}} = \\frac{200}{13} + \\frac{14400}{661} = \\frac{200 \\times 661 + 14400 \\times 13}{13 \\times 661} = \\frac{132200 + 187200}{8593} = \\frac{319400}{8593}$$\n在独立性假设下的方差为：\n$$\\mathrm{Var}_{\\text{indep}}(\\hat{\\mu}) = I_{\\text{indep}}^{-1} = \\frac{8593}{319400}$$\n\n**完全相关假设**\n在此假设下，系统不确定度是完全相关的，贡献一个秩为1的项 $\\mathbf{V}_{\\text{sys, full corr}} = \\mathbf{d}\\mathbf{d}^{\\top}$：\n$$\\mathbf{V}_{\\text{sys, full corr}} = \\begin{pmatrix} 4 \\\\ 6 \\end{pmatrix} \\begin{pmatrix} 4  6 \\end{pmatrix} = \\begin{pmatrix} 16  24 \\\\ 24  36 \\end{pmatrix}$$\n总协方差矩阵 $\\mathbf{V}_{\\text{full corr}}$ 为：\n$$\\mathbf{V}_{\\text{full corr}} = \\mathbf{V}_{\\text{stat}} + \\mathbf{V}_{\\text{sys, full corr}} = \\begin{pmatrix} 400  0 \\\\ 0  625 \\end{pmatrix} + \\begin{pmatrix} 16  24 \\\\ 24  36 \\end{pmatrix} = \\begin{pmatrix} 416  24 \\\\ 24  661 \\end{pmatrix}$$\n为了计算费雪信息 $I_{\\text{full corr}} = \\mathbf{s}^{\\top} \\mathbf{V}_{\\text{full corr}}^{-1} \\mathbf{s}$，我们首先求 $\\mathbf{V}_{\\text{full corr}}$ 的逆矩阵。其行列式为：\n$$\\det(\\mathbf{V}_{\\text{full corr}}) = (416)(661) - (24)^2 = 274976 - 576 = 274400$$\n逆矩阵为：\n$$\\mathbf{V}_{\\text{full corr}}^{-1} = \\frac{1}{274400} \\begin{pmatrix} 661  -24 \\\\ -24  416 \\end{pmatrix}$$\n现在，我们计算费雪信息：\n$$I_{\\text{full corr}} = \\frac{1}{274400} \\begin{pmatrix} 80  120 \\end{pmatrix} \\begin{pmatrix} 661  -24 \\\\ -24  416 \\end{pmatrix} \\begin{pmatrix} 80 \\\\ 120 \\end{pmatrix}$$\n$$I_{\\text{full corr}} = \\frac{1}{274400} \\left[ 80^2(661) - 2(80)(120)(24) + 120^2(416) \\right]$$\n$$I_{\\text{full corr}} = \\frac{1}{274400} \\left[ (6400)(661) - (19200)(24) + (14400)(416) \\right]$$\n$$I_{\\text{full corr}} = \\frac{1}{274400} \\left[ 4230400 - 460800 + 5990400 \\right] = \\frac{9760000}{274400} = \\frac{12200}{343}$$\n在完全相关假设下的方差为：\n$$\\mathrm{Var}_{\\text{full corr}}(\\hat{\\mu}) = I_{\\text{full corr}}^{-1} = \\frac{343}{12200}$$\n\n**方差变化**\n最后一步是计算方差的变化，$\\Delta \\mathrm{Var}(\\hat{\\mu}) = \\mathrm{Var}_{\\text{full corr}}(\\hat{\\mu}) - \\mathrm{Var}_{\\text{indep}}(\\hat{\\mu})$：\n$$\\Delta \\mathrm{Var}(\\hat{\\mu}) = \\frac{343}{12200} - \\frac{8593}{319400}$$\n转换为数值：\n$$\\mathrm{Var}_{\\text{full corr}}(\\hat{\\mu}) \\approx 0.028114754...$$\n$$\\mathrm{Var}_{\\text{indep}}(\\hat{\\mu}) \\approx 0.026903570...$$\n$$\\Delta \\mathrm{Var}(\\hat{\\mu}) \\approx 0.028114754 - 0.026903570 = 0.001211184...$$\n将结果四舍五入到四位有效数字，得到 $0.001211$。", "answer": "$$\\boxed{0.001211}$$", "id": "3509031"}, {"introduction": "我们所用方法的统计保证，例如置信区间的覆盖范围，依赖于我们底层模型的正确性。这个高级练习将研究当这一假设被违反时会发生什么。我们将模拟一个其中一个通道模型存在偏差的情景，这是一种常见且危险的模型设定错误，您将推导组合估计量的真实分布，并用它来计算置信区间的实际频率主义覆盖范围。这项练习对于培养对统计建模的批判性思维至关重要，它展示了一个看似微小的模型设定错误如何导致覆盖范围的显著损失，从而削弱科学结论的可靠性。", "problem": "您的任务是，在一个典型的计算高能物理场景中，量化一个跨多个测量通道的共享信号强度的组合高斯置信区间的频率覆盖率。考虑一个具有 $N=3$ 个通道的系统，这些通道测量一个共同的信号强度参数 $\\,\\mu\\,$。数据模型构建如下。\n\n- 存在一个潜在的系统误差移位向量 $\\,\\boldsymbol{\\theta} \\in \\mathbb{R}^3\\,$ 和独立的统计噪声 $\\,\\boldsymbol{\\varepsilon} \\in \\mathbb{R}^3\\,$。真实的数据生成过程是\n$$\n\\mathbf{X} \\equiv (X_1,X_2,X_3)^\\top = \\mu_0\\,\\mathbf{1} + \\boldsymbol{\\theta} + \\boldsymbol{\\varepsilon},\n$$\n其中 $\\,\\mu_0\\,$ 是真实信号强度，$\\,\\mathbf{1}=(1,1,1)^\\top\\,$。\n- 统计噪声具有对角协方差 $\\,\\mathrm{Cov}(\\boldsymbol{\\varepsilon}) = \\mathrm{diag}(\\sigma_1^2,\\sigma_2^2,\\sigma_3^2)\\,$，其中按规定顺序 $\\,\\sigma = (\\sigma_1,\\sigma_2,\\sigma_3) = (1.0,\\,1.2,\\,0.8)\\,$，单位任意但一致。\n- 系统误差向量是高斯分布的 $\\,\\boldsymbol{\\theta} \\sim \\mathcal{N}(\\mathbf{b}, \\Sigma_{\\text{nuis,true}})\\,$，其中 $\\mathbf{b} = (\\delta,\\,0,\\,0)^\\top$ 编码了一个仅应用于通道 $\\,1\\,$ 的建模误差水平 $\\,\\delta\\,$，以及一个依赖于相关的协方差\n$$\n\\Sigma_{\\text{nuis,true}}(\\rho)_{ij} = \n\\begin{cases}\n\\tau_i^2  \\text{if } i=j,\\\\\n\\rho\\,\\tau_i \\tau_j  \\text{if } i\\neq j,\n\\end{cases}\n$$\n其中 $\\,\\tau = (\\tau_1,\\tau_2,\\tau_3) = (0.5,\\,0.5,\\,0.5)\\,$，相关强度参数 $\\,\\rho \\in [0,\\,0.9]\\,$。该结构捕捉了建模错误的通道与建模良好的通道之间的相关性。假设 $\\,\\boldsymbol{\\theta}\\,$ 和 $\\,\\boldsymbol{\\varepsilon}\\,$ 是独立的。\n\n分析是在一个高斯似然模型下进行的，该模型将系统误差作为零均值积分掉，并使用与真实情况相同的协方差结构，即假设 $\\,\\boldsymbol{\\theta} \\sim \\mathcal{N}(\\mathbf{0}, \\Sigma_{\\text{nuis,model}}(\\rho))\\,$，其中 $\\,\\Sigma_{\\text{nuis,model}}(\\rho) = \\Sigma_{\\text{nuis,true}}(\\rho)\\,$，并且 $\\,\\boldsymbol{\\varepsilon}\\sim \\mathcal{N}(\\mathbf{0},\\mathrm{diag}(\\sigma_1^2,\\sigma_2^2,\\sigma_3^2))\\,$. 定义总模型协方差\n$$\nV(\\rho) = \\mathrm{diag}(\\sigma_1^2,\\sigma_2^2,\\sigma_3^2) + \\Sigma_{\\text{nuis,model}}(\\rho).\n$$\n\n在此模型下，$\\,\\mu\\,$ 的最大似然估计 (MLE) 及其在名义水平 $\\,1-\\alpha\\,$ 下的相关双边对称区间按常规高斯方法构建。您必须计算真实频率覆盖率 $\\,\\mathcal{C}(1-\\alpha;\\delta,\\rho)\\,$，其定义为（在上述真实数据生成过程下）该区间包含 $\\,\\mu_0\\,$ 的概率，作为建模误差水平 $\\,\\delta\\,$ 和相关强度 $\\,\\rho\\,$ 的函数。使用 $\\,\\mu_0 = 0\\,$ 和固定的名义水平 $\\,1-\\alpha = 0.90\\,$，并将覆盖率表示为 $\\,0\\,$ 到 $\\,1\\,$ 之间的小数。\n\n您的程序必须仅从多元高斯建模、基于似然的估计和线性估计器属性的基本原理出发，实现以下内容：\n\n1. 基于所述高斯模型，推导 $\\,\\mu\\,$ 的有效组合估计器，以及在水平 $\\,1-\\alpha\\,$ 下的双边对称区间所需的相应基于模型的标准差。\n2. 在真实数据生成过程下（包括偏差向量 $\\,\\mathbf{b}=(\\delta,0,0)^\\top\\,$），推导组合估计器的分布，并计算作为 $\\,\\delta\\,$ 和 $\\,\\rho\\,$ 函数的覆盖率 $\\,\\mathcal{C}(1-\\alpha;\\delta,\\rho)\\,$。\n3. 实现一个数值程序，对于下面的每个测试用例，通过使用适当的高斯累积分布函数，在高斯假设下精确评估覆盖率，而不使用蒙特卡洛模拟。\n\n在所有计算中使用以下固定数值：\n- $\\,\\sigma = (1.0,\\,1.2,\\,0.8)\\,$，\n- $\\,\\tau = (0.5,\\,0.5,\\,0.5)\\,$，\n- $\\,\\mu_0 = 0\\,$，\n- $\\,1-\\alpha = 0.90\\,$。\n\n待评估的参数对 $\\,(\\delta,\\rho)\\,$ 测试套件：\n- $\\,(\\delta,\\rho) = (0.0,\\,0.0)\\,$，\n- $\\,(\\delta,\\rho) = (0.0,\\,0.9)\\,$，\n- $\\,(\\delta,\\rho) = (0.5,\\,0.0)\\,$，\n- $\\,(\\delta,\\rho) = (0.5,\\,0.5)\\,$，\n- $\\,(\\delta,\\rho) = (0.5,\\,0.9)\\,$，\n- $\\,(\\delta,\\rho) = (1.0,\\,0.0)\\,$，\n- $\\,(\\delta,\\rho) = (1.0,\\,0.9)\\,$，\n- $\\,(\\delta,\\rho) = (-0.5,\\,0.5)\\,$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含覆盖率，顺序与上述测试套件相同，以逗号分隔列表的形式包含在方括号中，例如 $\\,\\big[$value1,value2,\\dots\\big]$。\n- 每个覆盖率必须四舍五入到小数点后六位，并以小数（而非百分比）表示。\n\n假设与约束：\n- 所有矩阵计算必须确保数值稳定性，在可避免的情况下，不要显式地对协方差矩阵求逆。\n- 不涉及角度；不需要角度单位。\n- 物理单位是任意的，并在各通道间保持一致；按規定報告無量綱的覆蓋率值。", "solution": "我们基于多元高斯建模和线性高斯模型的最大似然估计（MLE）的基本性质，建立了一个基于原理的构造。核心步骤使用了经过充分检验的事实：已知协方差的均值参数的高斯似然、广义最小二乘法（GLS）估计器的形式，以及正态变量的变换。频率覆盖率是通过对估计器的真实抽樣分布相对于基于模型的区间进行积分来计算的。\n\n1. 模型、对系统误差的积分和 GLS 估计器。分析模型假设 $\\,\\boldsymbol{\\theta} \\sim \\mathcal{N}(\\mathbf{0}, \\Sigma_{\\text{nuis,model}}(\\rho))\\,$、$\\,\\boldsymbol{\\varepsilon}\\sim\\mathcal{N}(\\mathbf{0},\\mathrm{diag}(\\sigma_1^2,\\sigma_2^2,\\sigma_3^2))\\,$ 且相互独立。因此，数据的边际模型是多元高斯分布\n$$\n\\mathbf{X} \\mid \\mu \\sim \\mathcal{N}\\!\\left(\\mu\\,\\mathbf{1},\\, V(\\rho)\\right),\n\\quad V(\\rho) \\equiv \\mathrm{diag}(\\sigma_1^2,\\sigma_2^2,\\sigma_3^2) + \\Sigma_{\\text{nuis,model}}(\\rho).\n$$\n给定数据向量 $\\,\\mathbf{x}\\,$，$\\,\\mu\\,$ 的对数似然（不计加法常数）为\n$$\n\\ell(\\mu;\\mathbf{x}) = -\\tfrac{1}{2}\\,(\\mathbf{x} - \\mu\\,\\mathbf{1})^\\top V(\\rho)^{-1} (\\mathbf{x} - \\mu\\,\\mathbf{1}).\n$$\n求导并将导数设为零，得到 MLE（一个标准的广义最小二乘法结果）：\n$$\n\\hat{\\mu} = \\frac{\\mathbf{1}^\\top V(\\rho)^{-1} \\mathbf{x}}{\\mathbf{1}^\\top V(\\rho)^{-1} \\mathbf{1}}.\n$$\n定义权重向量\n$$\n\\mathbf{w} \\equiv \\frac{V(\\rho)^{-1} \\mathbf{1}}{\\mathbf{1}^\\top V(\\rho)^{-1} \\mathbf{1}},\n$$\n使得 $\\,\\hat{\\mu} = \\mathbf{w}^\\top \\mathbf{x}\\,$ 且 $\\,\\mathbf{1}^\\top \\mathbf{w} = 1\\,$。在分析模型下，该估计器对 $\\,\\mu\\,$ 是无偏的，并且方差为\n$$\n\\mathrm{Var}_{\\text{model}}(\\hat{\\mu}) = \\mathbf{w}^\\top V(\\rho)\\,\\mathbf{w} = \\frac{1}{\\mathbf{1}^\\top V(\\rho)^{-1} \\mathbf{1}} \\equiv s^2(\\rho).\n$$\n在名义水平 $\\,1-\\alpha\\,$ 下，通常的双边对称区间是\n$$\nI(\\mathbf{x}) = \\left[\\,\\hat{\\mu} - z_{1-\\alpha/2}\\,s(\\rho),\\;\\; \\hat{\\mu} + z_{1-\\alpha/2}\\,s(\\rho)\\,\\right],\n$$\n其中 $\\,z_{1-\\alpha/2}\\,$ 是满足 $\\,\\Phi(z_{1-\\alpha/2})=1-\\alpha/2\\,$ 的标准正态分位数，而 $\\,\\Phi(\\cdot)\\,$ 是标准正态累积分布函数。\n\n2. 真实数据生成过程和估计器的分布。真实过程包括通道 $\\,1\\,$ 的系统误差中一个建模错误的均值：\n$$\n\\boldsymbol{\\theta} \\sim \\mathcal{N}(\\mathbf{b}, \\Sigma_{\\text{nuis,true}}(\\rho)),\\quad \\mathbf{b}=(\\delta,0,0)^\\top,\n$$\n其中 $\\,\\Sigma_{\\text{nuis,true}}(\\rho)=\\Sigma_{\\text{nuis,model}}(\\rho)\\,$。因此，真实的边际数据分布是\n$$\n\\mathbf{X} \\sim \\mathcal{N}\\!\\left(\\mu_0\\,\\mathbf{1} + \\mathbf{b},\\, V(\\rho)\\right).\n$$\n估计器是一个线性泛函 $\\,\\hat{\\mu} = \\mathbf{w}^\\top \\mathbf{X}\\,$，因此在真实情况下，它是高斯分布的，具有\n$$\n\\mathbb{E}_{\\text{true}}[\\hat{\\mu}] = \\mathbf{w}^\\top \\big(\\mu_0\\,\\mathbf{1} + \\mathbf{b}\\big) = \\mu_0 + \\mathbf{w}^\\top \\mathbf{b},\n\\quad\n\\mathrm{Var}_{\\text{true}}(\\hat{\\mu}) = \\mathbf{w}^\\top V(\\rho)\\,\\mathbf{w} = s^2(\\rho).\n$$\n设 $\\,w_1\\,$ 是 $\\,\\mathbf{w}\\,$ 的第一个分量。由于 $\\,\\mathbf{b}=(\\delta,0,0)^\\top\\,$，在真实情况下估计器均值的偏差是\n$$\n\\Delta_{\\text{eff}}(\\delta,\\rho) \\equiv \\mathbf{w}^\\top \\mathbf{b} = w_1(\\rho)\\,\\delta.\n$$\n因此，\n$$\n\\hat{\\mu} \\;\\stackrel{\\text{true}}{\\sim}\\; \\mathcal{N}\\!\\left(\\mu_0 + \\Delta_{\\text{eff}}(\\delta,\\rho),\\, s^2(\\rho)\\right).\n$$\n\n3. 覆盖率计算。区间 $\\,I(\\mathbf{X})\\,$ 包含 $\\,\\mu_0\\,$ 当且仅当\n$$\n\\left|\\,\\hat{\\mu} - \\mu_0\\,\\right| \\le z_{1-\\alpha/2}\\, s(\\rho).\n$$\n定义标准化变量\n$$\nZ \\equiv \\frac{\\hat{\\mu} - \\mu_0}{s(\\rho)}.\n$$\n在真实过程下，$\\,Z \\sim \\mathcal{N}(m,1)\\,$，其均值为\n$$\nm(\\delta,\\rho) \\equiv \\frac{\\Delta_{\\text{eff}}(\\delta,\\rho)}{s(\\rho)} = \\frac{w_1(\\rho)\\,\\delta}{s(\\rho)}.\n$$\n因此，覆盖率是正态概率\n$$\n\\mathcal{C}(1-\\alpha;\\delta,\\rho) = \\mathbb{P}_{\\text{true}}\\!\\left( |Z| \\le z_{1-\\alpha/2} \\right) \n= \\Phi\\!\\big(z_{1-\\alpha/2} - m(\\delta,\\rho)\\big) - \\Phi\\!\\big(-z_{1-\\alpha/2} - m(\\delta,\\rho)\\big).\n$$\n在 $\\,\\delta=0\\,$（无建模误差）的特殊情况下，$\\,m=0\\,$ 且对于任何 $\\,\\rho\\,$ 都有 $\\,\\mathcal{C}(1-\\alpha;0,\\rho)=1-\\alpha\\,$。\n\n4. 算法计算。对于每个指定的参数对 $\\,(\\delta,\\rho)\\,$：\n- 构建 $\\,\\Sigma_{\\text{nuis}}(\\rho)\\,$，其元素为 $\\,(\\Sigma_{\\text{nuis}})_{ii}=\\tau_i^2\\,$ 和 $\\,(\\Sigma_{\\text{nuis}})_{ij}=\\rho\\,\\tau_i\\tau_j\\,$（当 $\\,i\\neq j\\,$ 时）。\n- 形成 $\\,V(\\rho) = \\mathrm{diag}(\\sigma_1^2,\\sigma_2^2,\\sigma_3^2) + \\Sigma_{\\text{nuis}}(\\rho)\\,$。\n- 计算 $\\,\\mathbf{y}\\,$ 作为 $\\,V(\\rho)\\,\\mathbf{y}=\\mathbf{1}\\,$ 的解。然后 $\\,\\mathbf{w}=\\mathbf{y}/(\\mathbf{1}^\\top \\mathbf{y})\\,$ 且 $\\,s^2(\\rho)=1/(\\mathbf{1}^\\top \\mathbf{y})\\,$。\n- 计算 $\\,w_1(\\rho)\\,$、$\\,s(\\rho)\\,$、$\\,m(\\delta,\\rho)=w_1(\\rho)\\delta/s(\\rho)\\,$、$\\,1-\\alpha=0.90\\,$ 时的标准正态分位数 $\\,z_{1-\\alpha/2}\\,$，最后通过上述正态累积分布函数的差值计算 $\\,\\mathcal{C}(1-\\alpha;\\delta,\\rho)\\,$。\n- 将覆盖率四舍五入到小数点后六位。\n\n5. 数值稳定性。避免对 $\\,V(\\rho)\\,$ 进行显式求逆；而是使用稳定的求解器求解线性系统 $\\,V(\\rho)\\,\\mathbf{y}=\\mathbf{1}\\,$，这是合适的，因为对于给定的参数范围 $\\,\\rho \\in [0,0.9]\\,$ 和正方差 $\\,\\sigma_i^2,\\tau_i^2  0\\,$，$\\,V(\\rho)\\,$ 是对称正定的。\n\n将此方法应用于 $\\,(\\delta,\\rho)\\,$ 参数对的测试套件，会产生一个完全按规定顺序排列的覆盖率值列表。结果以单行打印，值包含在方括号中，用逗号分隔，每个值保留六位小数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.stats import norm\n\ndef build_sigma_nuis(tau, rho):\n    \"\"\"\n    Construct the nuisance covariance matrix Sigma_nuis with given tau and common correlation rho.\n    Sigma_ij = tau_i * tau_j * rho for i != j; Sigma_ii = tau_i^2\n    \"\"\"\n    tau = np.asarray(tau, dtype=float)\n    # Outer product for off-diagonals\n    outer = np.outer(tau, tau)\n    sigma = rho * outer\n    # Set diagonal to tau^2 exactly\n    np.fill_diagonal(sigma, tau**2)\n    return sigma\n\ndef compute_weights_and_s(V):\n    \"\"\"\n    Given covariance matrix V (symmetric positive definite), compute:\n    - w = V^{-1} 1 / (1^T V^{-1} 1)\n    - s^2 = 1 / (1^T V^{-1} 1)\n    Returns (w, s)\n    \"\"\"\n    n = V.shape[0]\n    ones = np.ones(n)\n    # Solve V y = 1 for y\n    y = np.linalg.solve(V, ones)\n    denom = ones @ y  # 1^T V^{-1} 1\n    s2 = 1.0 / denom\n    w = y / denom\n    s = np.sqrt(s2)\n    return w, s\n\ndef coverage(delta, rho, sigma, tau, alpha):\n    \"\"\"\n    Compute coverage C(1-alpha; delta, rho) for the specified parameters.\n    \"\"\"\n    # Build covariance V\n    D = np.diag(np.array(sigma, dtype=float)**2)\n    Sigma_nuis = build_sigma_nuis(tau, rho)\n    V = D + Sigma_nuis\n\n    # Weights and model-based standard deviation s\n    w, s = compute_weights_and_s(V)\n    w1 = float(w[0])\n\n    # Bias-induced mean shift in standardized estimator\n    m = (w1 * delta) / s\n\n    # z-quantile for two-sided interval at nominal 1 - alpha\n    z = norm.ppf(1.0 - alpha/2.0)\n\n    # Coverage: P(|Z| = z) where Z ~ N(m, 1)\n    cov = norm.cdf(z - m) - norm.cdf(-z - m)\n    return cov\n\ndef solve():\n    # Fixed parameters\n    sigma = [1.0, 1.2, 0.8]\n    tau = [0.5, 0.5, 0.5]\n    alpha = 0.10  # nominal 1 - alpha = 0.90\n\n    # Test cases: list of (delta, rho) pairs in the specified order\n    test_cases = [\n        (0.0, 0.0),\n        (0.0, 0.9),\n        (0.5, 0.0),\n        (0.5, 0.5),\n        (0.5, 0.9),\n        (1.0, 0.0),\n        (1.0, 0.9),\n        (-0.5, 0.5),\n    ]\n\n    results = []\n    for delta, rho in test_cases:\n        cov = coverage(delta, rho, sigma, tau, alpha)\n        # Round to six decimals as required\n        results.append(f\"{cov:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3509058"}]}