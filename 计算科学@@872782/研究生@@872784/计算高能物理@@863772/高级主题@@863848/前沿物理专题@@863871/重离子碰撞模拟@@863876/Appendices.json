{"hands_on_practices": [{"introduction": "在任何流体动力学模拟中，数值稳定性都是至关重要的。为了确保显式时间积分方案的收敛性，时间步长的选择必须满足 Courant–Friedrichs–Lewy (CFL) 条件。这个实践练习 [@problem_id:3516494] 将指导你如何在对重离子碰撞几何描述至关重要的曲线坐标系（如 Milne 坐标系）中，从第一性原理出发推导并应用 CFL 条件，从而计算出最大允许时间步长。", "problem": "考虑一个用于重离子碰撞模拟的相对论理想流体动力学显式有限体积求解器，它通过源项将背景流体与来自喷注的局域能量动量沉积（喷注淬实）耦合起来。流体遵循能量动量守恒，表示为 $\\partial_{\\mu} T^{\\mu \\nu} = J^{\\nu}$，其中对于理想流体 $T^{\\mu \\nu} = (\\varepsilon + p) u^{\\mu} u^{\\nu} - p g^{\\mu \\nu}$，$J^{\\nu}$ 描述了喷注的能量动量沉积。演化在 Milne 坐标系 $(\\tau, x, y, \\eta_{s})$ 中进行，该坐标系适用于重离子碰撞中的近似 boost 不变纵向膨胀，其度规为 $\\mathrm{diag}(+1,-1,-1,-\\tau^{2})$。在这个曲线坐标系中，对于固定的 $\\tau$，沿 $x$、$y$ 和 $\\eta_{s}$ 方向的固有空间距离分别为 $|dx|$、$|dy|$ 和 $\\tau |d\\eta_{s}|$。\n\n显式格式稳定性的一个必要条件是 Courant–Friedrichs–Lewy (CFL) 判据，该判据要求在单个时间步内，沿任何坐标方向传播的最快信号，在以网格单元的固有空间尺度衡量时，其传播距离不能超过该方向上的一个单元格。在局域标准正交参考系中，相对于流体的最快信号速度以声速 $c_{s}$ 为界，而实验室参考系中沿给定方向的最快信号速度的上限是该方向上流体速度分量的大小与 $c_{s}$ 之和。在曲线坐标系中，对于具有非平凡度规尺度因子的方向，坐标速度必须使用相应的固有长度与坐标长度的关系进行转换。\n\n假设状态方程是近似共形的，因此在自然单位制（设光速 $c = 1$）中 $c_{s} = \\sqrt{1/3}$，并且在某一网格点处，（在与 $(x,y,\\eta_{s})$ 对齐的局域标准正交参考系中）的三维速度分量为 $v_{x} = 0.40$，$v_{y} = 0.30$ 和 $v_{\\eta} = 0.05$。在流体动力学时间 $\\tau = 3.0$ fm/$c$ 时，网格间距为 $\\Delta x = 0.06$ fm，$\\Delta y = 0.08$ fm 和 $\\Delta \\eta_{s} = 0.02$。该显式时间积分器使用 Courant 数 $C = 0.50$。\n\n基于以上原理，推导适用于 Milne 坐标系的 CFL 稳定性条件，并计算该网格点的最大允许时间步长 $\\Delta \\tau_{\\max}$。将您的答案四舍五入到四位有效数字，并以飞米/光速 (fm/$c$) 为单位表示 $\\Delta \\tau_{\\max}$。", "solution": "该问题要求推导在 Milne 坐标系下进行相对论流体动力学模拟的 Courant–Friedrichs–Lewy (CFL) 稳定性条件，并计算特定网格点上的最大允许时间步长 $\\Delta \\tau_{\\max}$。\n\n验证过程确认该问题具有科学依据、是适定的、客观的且内部一致。所有必要的物理原理和数值数据均已提供。其背景是计算高能物理中的一个标准场景。因此，该问题是有效的，可以构建解决方案。\n\nCFL 条件是求解偏微分方程的显式数值格式稳定性的一个必要条件。它规定，一个网格点的数值依赖域必须包含其物理依赖域。对于一个显式时间步进格式，这意味着在单个时间步长 $\\Delta t$ 内，传播最快的信号行进的距离不能超过一个网格单元。对于每个空间维度 $i$，这可以表示为：\n$$ \\Delta t \\le C \\frac{\\Delta L_i}{v_{\\text{sig}, i}} $$\n其中 $\\Delta L_i$ 是网格单元在方向 $i$ 上的固有物理尺寸，$v_{\\text{sig}, i}$ 是该方向上任何信号的最大固有速度，$C$ 是 Courant 数，一个通常小于或等于 1 的安全系数。总的最大时间步长受这些条件中最严格的一个限制：\n$$ \\Delta t_{\\max} = C \\cdot \\min_{i} \\left( \\frac{\\Delta L_i}{v_{\\text{sig}, i}} \\right) $$\n\n在这个问题中，时间坐标是固有时 $\\tau$，因此我们要求解 $\\Delta \\tau_{\\max}$。空间坐标是 $(x, y, \\eta_{s})$，它们是曲线坐标。坐标间隔与固有空间距离之间的关系由时空度规 $g_{\\mu\\nu} = \\mathrm{diag}(+1, -1, -1, -\\tau^2)$ 给出。不变线元为 $ds^2 = g_{\\mu\\nu} dx^{\\mu} dx^{\\nu}$。在固定的时间 $\\tau$（即 $d\\tau = 0$），固有空间距离元 $dL$ 的平方为：\n$$ dL^2 = -ds^2 = dx^2 + dy^2 + \\tau^2 d\\eta_s^2 $$\n由此，我们根据坐标网格间距 $\\Delta x$、$\\Delta y$ 和 $\\Delta \\eta_s$，确定沿每个坐标轴的网格单元的固有长度：\n\\begin{itemize}\n    \\item 沿 $x$ 轴：$\\Delta L_x = \\Delta x$\n    \\item 沿 $y$ 轴：$\\Delta L_y = \\Delta y$\n    \\item 沿 $\\eta_s$ 轴：$\\Delta L_{\\eta} = \\tau \\Delta \\eta_s$\n\\end{itemize}\n\n接下来，我们确定最大信号传播速度。问题指明，在局域标准正交参考系中，沿方向 $i$ 的最快信号速度是流体速度分量的大小 $|v_i|$ 与声速 $c_s$ 之和。这些是固有速度，对应于在固有距离上的传播。\n\\begin{itemize}\n    \\item $x$ 方向的信号速度：$v_{\\text{sig}, x} = |v_x| + c_s$\n    \\item $y$ 方向的信号速度：$v_{\\text{sig}, y} = |v_y| + c_s$\n    \\item $\\eta$ 方向的信号速度：$v_{\\text{sig}, \\eta} = |v_{\\eta}| + c_s$\n\\end{itemize}\n光速设为 $c=1$。\n\n综合这些要素，最大时间步长 $\\Delta \\tau_{\\max}$ 的 CFL 条件变为：\n$$ \\Delta \\tau_{\\max} = C \\cdot \\min \\left( \\frac{\\Delta L_x}{v_{\\text{sig}, x}}, \\frac{\\Delta L_y}{v_{\\text{sig}, y}}, \\frac{\\Delta L_{\\eta}}{v_{\\text{sig}, \\eta}} \\right) $$\n代入固有长度和信号速度的表达式：\n$$ \\Delta \\tau_{\\max} = C \\cdot \\min \\left( \\frac{\\Delta x}{|v_x| + c_s}, \\frac{\\Delta y}{|v_y| + c_s}, \\frac{\\tau \\Delta \\eta_s}{|v_{\\eta}| + c_s} \\right) $$\n\n现在我们代入问题陈述中提供的数值：\n\\begin{itemize}\n    \\item Courant 数：$C = 0.50$\n    \\item 声速：$c_s = \\sqrt{1/3}$\n    \\item 流体速度分量：$v_x = 0.40$，$v_y = 0.30$，$v_{\\eta} = 0.05$\n    \\item 流体动力学时间：$\\tau = 3.0$ fm/$c$\n    \\item 网格间距：$\\Delta x = 0.06$ fm，$\\Delta y = 0.08$ fm，$\\Delta \\eta_s = 0.02$\n\\end{itemize}\n\n首先，我们计算对应于每个空间方向的三个时间尺度限制：\n1.  对于 $x$ 方向：\n    $$ \\frac{\\Delta x}{|v_x| + c_s} = \\frac{0.06}{|0.40| + \\sqrt{1/3}} = \\frac{0.06}{0.40 + \\sqrt{1/3}} \\text{ fm}/c $$\n2.  对于 $y$ 方向：\n    $$ \\frac{\\Delta y}{|v_y| + c_s} = \\frac{0.08}{|0.30| + \\sqrt{1/3}} = \\frac{0.08}{0.30 + \\sqrt{1/3}} \\text{ fm}/c $$\n3.  对于 $\\eta_s$ 方向：\n    $$ \\frac{\\tau \\Delta \\eta_s}{|v_{\\eta}| + c_s} = \\frac{(3.0)(0.02)}{|0.05| + \\sqrt{1/3}} = \\frac{0.06}{0.05 + \\sqrt{1/3}} \\text{ fm}/c $$\n\n现在，我们对这些表达式进行数值计算。我们使用 $c_s = \\sqrt{1/3} \\approx 0.57735$。\n1.  $x$ 方向的限制：\n    $$ \\frac{0.06}{0.40 + 0.57735} = \\frac{0.06}{0.97735} \\approx 0.061395 \\text{ fm}/c $$\n2.  $y$ 方向的限制：\n    $$ \\frac{0.08}{0.30 + 0.57735} = \\frac{0.08}{0.87735} \\approx 0.091184 \\text{ fm}/c $$\n3.  $\\eta_s$ 方向的限制：\n    $$ \\frac{0.06}{0.05 + 0.57735} = \\frac{0.06}{0.62735} \\approx 0.095640 \\text{ fm}/c $$\n\n这三个值中的最小值决定了总的时间步长约束：\n$$ \\min(0.061395, 0.091184, 0.095640) = 0.061395 \\text{ fm}/c $$\n这个最严格的条件来自 $x$ 方向。\n\n最后，我们应用 Courant 数 $C = 0.50$ 来求得最大允许时间步长 $\\Delta \\tau_{\\max}$：\n$$ \\Delta \\tau_{\\max} = C \\cdot \\min(\\dots) = 0.50 \\times 0.061395 \\text{ fm}/c \\approx 0.0306975 \\text{ fm}/c $$\n\n问题要求答案四舍五入到四位有效数字。前四位有效数字是 $3, 0, 6, 9$。下一位数字是 $7$，所以我们将最后一位有效数字向上进一。\n$$ \\Delta \\tau_{\\max} \\approx 0.03070 \\text{ fm}/c $$\n末尾的零是有效数字。", "answer": "$$\\boxed{0.03070}$$", "id": "3516494"}, {"introduction": "数值求解的正确性验证是计算物理学中的一个核心环节。此练习 [@problem_id:3516455] 介绍了一个重要的基准检验工具：Gubser 流，这是一个具有非平庸横向动力学的相对论理想流体动力学方程的精确解析解。通过探究其利用 Weyl 变换到弯曲时空的巧妙构造，你将理解如何利用这一解析解来严格检验和验证复杂的数值模拟程序，确保其能够准确地描述具有横向膨胀的系统。", "problem": "考虑在高能核-核碰撞中产生的一种流体，采用理想共形相对论流体力学进行描述。该模型建立在平直的闵可夫斯基时空中，使用 Milne 坐标，其度规为 $ds^{2} = -d\\tau^{2} + dr^{2} + r^{2} d\\phi^{2} + \\tau^{2} d\\eta^{2}$。假设能量-动量张量是理想流体的形式，$T^{\\mu\\nu} = (\\epsilon + p) u^{\\mu} u^{\\nu} + p\\, g^{\\mu\\nu}$，其状态方程为共形的 $\\epsilon = 3 p$，且体积粘滞系数为零，因此系统在经过外尔（Weyl）重标度并结合适当的场重定义后保持不变。施加纵向 boost 不变性、横向平面上的方位角对称性，以及一个与共形对称性一致的、由有量纲参数 $q$ 表征的非平庸横向标度，从而产生流的 $\\mathrm{SO}(3)_{q} \\times \\mathrm{SO}(1,1) \\times \\mathbb{Z}_{2}$ 对称性。仅使用这些要素，选择一个选项，该选项提出了一个具有横向动力学的非平庸解析解的自洽构造，包括：一个正确的外尔映射，将流映射到流为静态的弯曲背景上；平直坐标与弯曲坐标之间的适当坐标变换；在弯曲参考系中温度的演化方程及其解；将热力学场和四维速度映射回闵可夫斯基空间；并简要解释为何该解可以作为数值求解器和喷注能量损失模块在纯纵向膨胀之外的一个严格基准。\n\nA. 执行外尔重标度，因子为 $\\Omega = 1/\\tau$，使得 $d\\hat{s}^{2} = ds^{2}/\\tau^{2}$ 成为 $\\mathrm{dS}_{3} \\times \\mathbb{R}$ 在坐标 $(\\rho,\\theta,\\phi,\\eta)$ 下的度规，坐标变换由下式给出\n$$\n\\sinh \\rho \\equiv -\\frac{1 - q^{2}\\tau^{2} + q^{2} r^{2}}{2 q \\tau}\\,, \\qquad \\tan \\theta \\equiv \\frac{2 q r}{1 + q^{2}\\tau^{2} - q^{2} r^{2}}\\,,\n$$\n于是 $d\\hat{s}^{2} = - d\\rho^{2} + \\cosh^{2}\\!\\rho\\, (d\\theta^{2} + \\sin^{2}\\!\\theta\\, d\\phi^{2}) + d\\eta^{2}$。在带帽参考系中，施加一个静态流 $\\hat{u}^{\\mu} = (1,0,0,0)$ 并求解能量-动量守恒 $\\hat{\\nabla}_{\\mu} \\hat{T}^{\\mu\\nu} = 0$（其中 $\\hat{T}^{\\mu\\nu}$ 是理想共形的），该方程简化为关于温度的常微分方程，\n$$\n\\frac{1}{\\hat{T}(\\rho)} \\frac{d \\hat{T}}{d\\rho} = - \\frac{2}{3} \\tanh \\rho\\,,\n$$\n因此 $\\hat{T}(\\rho) = \\hat{T}_{0} \\, (\\cosh \\rho)^{-2/3}$ 且 $\\hat{\\epsilon}(\\rho) \\propto \\hat{T}^{4}(\\rho) \\propto (\\cosh \\rho)^{-8/3}$。使用适用于共形流体的外尔权重，将结果映射回闵可夫斯基空间，$T(\\tau,r) = \\hat{T}(\\rho)/\\tau$ 和 $\\epsilon(\\tau,r) = \\hat{\\epsilon}(\\rho)/\\tau^{4}$，并得到一个具有径向速度的横向流\n$$\nv_{\\perp}(\\tau,r) = \\tanh \\kappa(\\tau,r) = \\frac{2 q^{2}\\, \\tau\\, r}{1 + q^{2}\\tau^{2} + q^{2} r^{2}}\\,,\n$$\n其中 $u^{\\tau} = \\cosh \\kappa$ 和 $u^{r} = \\sinh \\kappa$。这个被称为 Gubser 流的解，在保持 boost 不变性的同时，提供了解析的、依赖时间的横向梯度和径向流，为流体力学求解器以及与喷注能量损失模块的耦合提供了一个非平庸的基准，以测试对横向流和路径长度变化的敏感性，这远超出了纯纵向的 Bjorken 膨胀。\n\nB. 执行外尔重标度，因子为 $\\Omega = \\tau$，并将平直闵可夫斯基空间映射到 $\\mathrm{AdS}_{3} \\times \\mathbb{R}$，其中流在闵可夫斯基坐标下保持静态 $u^{\\mu} = (1,0,0,0)$。然后施加 boost 不变性，得到一个仅通过 $T(\\tau) \\propto \\tau^{-1/3}$ 依赖于固有时且无径向依赖性的温度分布，并将此纯纵向解用作基准，因为在早期横向动力学很小。\n\nC. 通过将体积和剪切粘滞系数都设为零来强制共形对称性，这意味着在任何弯曲参考系中温度必须满足 $d\\hat{T}/d\\rho = - \\frac{1}{3} \\hat{T}\\, \\tanh \\rho$，从而得到 $\\hat{T}(\\rho) \\propto (\\cosh \\rho)^{-1/3}$。通过 $T(\\tau,r) = \\hat{T}(\\rho)$ 映射回去，并在闵可夫斯基空间中保持 $u^{\\mu} = (1,0,0,0)$，得到一个径向静态的构型，但它仍然表现出足以用于基准测试具有路径长度依赖性的喷注淬火的横向压力梯度。\n\nD. 使用与选项 A 中相同的外尔映射，但允许一个非静态的带帽流，其中 $\\hat{u}^{\\rho} \\neq 0$，以产生更强的横向动力学。在闵可夫斯基空间中得到的速度为 $v_{\\perp}(\\tau,r) = \\frac{q\\, r}{1 + q^{2}\\tau^{2} - q^{2} r^{2}}$，而温度变换为 $T(\\tau,r) = \\hat{T}(\\rho)\\, \\tau$，因为温度的外尔权重为 -1。该流具有非平庸的横向剪切，因此是比任何静态带帽参考系构造更好的基准。\n\nE. 不执行外尔重标度，而是在状态方程 $p(\\epsilon) = \\epsilon/3 + q^{4}$ 中手动引入标度 $q$ 以破坏平移不变性，同时保持 $u^{\\mu} = (1,0,0,0)$。由此产生的横向平面上的压力梯度导致一个径向加速的解，该解是精确 boost 不变的，因此无需任何到弯曲空间的映射，就能为流体力学和喷注淬火提供一个稳健的基准。", "solution": "问题要求在给定特定对称性（包括纵向 boost 不变性和一个横向标度）的条件下，从理想共形相对论流体力学中，找出一个在闵可夫斯基空间中的非平庸解析解的正确自洽构造。这类解被称为 Gubser 流。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n- **系统：** 理想共形相对论流体力学。\n- **时空：** 平直闵可夫斯基空间，Milne 坐标，度规为 $ds^{2} = -d\\tau^{2} + dr^{2} + r^{2} d\\phi^{2} + \\tau^{2} d\\eta^{2}$。\n- **能量-动量张量：** 理想流体，$T^{\\mu\\nu} = (\\epsilon + p) u^{\\mu} u^{\\nu} + p\\, g^{\\mu\\nu}$。\n- **状态方程 (EoS)：** 共形，$\\epsilon = 3 p$。\n- **粘滞性：** 体积粘滞系数为零，与共形对称性一致。\n- **不变性：** 系统在经过外尔重标度并结合适当的场重定义后保持不变。\n- **对称性：**\n    1.  纵向 boost 不变性（纵向快度 $\\eta$ 方向上的 $\\mathrm{SO}(1,1)$ 对称性）。\n    2.  横向平面上的方位角对称性。\n    3.  一个产生流的 $\\mathrm{SO}(3)_{q} \\times \\mathrm{SO}(1,1) \\times \\mathbb{Z}_{2}$ 对称性的非平庸横向标度 $q$。\n- **任务：** 选择一个选项，该选项正确描述了一个具有横向动力学的非平庸解析解的构造过程，包括外尔映射、坐标变换、演化方程、解以及最终映射回物理时空。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学基础：** 该问题牢固地建立在相对论流体力学及其在高能核物理中应用的成熟框架内。所有概念，如 Milne 坐标、共形对称性、外尔变换以及指定的对称群，都是该理论物理领域的标准内容。该问题描述了推导 Gubser 流的设置，这是一个已知且重要的解析解。\n- **良定性：** 问题要求在一组选项中确定一个已知解的正确推导过程。在这些对称性下，Gubser 流构造的存在性和唯一性确保了该问题的良定性。\n- **客观性：** 问题陈述使用精确、技术性的语言，没有主观性或歧义。\n\n**步骤3：结论与行动**\n问题陈述在科学上是合理的、良定的和客观的。它提供了评估选项所需的所有信息。因此，该问题是**有效的**。我将继续推导解答并评估每个选项。\n\n### 解答推导与选项分析\n\n找到此解的核心策略是利用流体力学方程的共形对称性。我们对度规进行外尔变换，$g_{\\mu\\nu} \\to \\hat{g}_{\\mu\\nu} = \\Omega^2 g_{\\mu\\nu}$，并伴随一个坐标变换，将问题从平直的闵可夫斯基空间（其中流是复杂且依赖时间的）映射到一个流是静态的弯曲时空。在这个“带帽”参考系中，流体力学方程变得简单得多，简化为一个常微分方程 (ODE)。解出 ODE 后，我们将解映射回物理的闵可夫斯基时空。\n\n对称群 $\\mathrm{SO}(3)_{q} \\times \\mathrm{SO}(1,1) \\times \\mathbb{Z}_{2}$ 表明，映射的合适目标空间是3维德西特空间与一条实线的直积，即 $\\mathrm{dS}_{3} \\times \\mathbb{R}$。\n\n让我们基于这个框架来分析每个选项。\n\n**A. 执行外尔重标度，因子为 $\\Omega = 1/\\tau$，使得 $d\\hat{s}^{2} = ds^{2}/\\tau^{2}$ 成为 $\\mathrm{dS}_{3} \\times \\mathbb{R}$ 在坐标 $(\\rho,\\theta,\\phi,\\eta)$ 下的度规……**\n\n1.  **外尔映射与坐标：** 该选项提出了一个外尔因子 $\\Omega = 1/\\tau$。这给出了带帽度规 $\\hat{g}_{\\mu\\nu} = (1/\\tau^2) g_{\\mu\\nu}$，因此 $d\\hat{s}^2 = ds^2/\\tau^2$。所提出的坐标变换，\n    $$\n    \\sinh \\rho \\equiv -\\frac{1 - q^{2}\\tau^{2} + q^{2} r^{2}}{2 q \\tau}\\,, \\qquad \\tan \\theta \\equiv \\frac{2 q r}{1 + q^{2}\\tau^{2} - q^{2} r^{2}}\\,,\n    $$\n    结合外尔标度变换，是一个已知的（尽管不是唯一的）映射，它将 Milne 坐标下的平直度规变换为 $\\mathrm{dS}_3 \\times \\mathbb{R}$ 的度规，该度规被正确地给出为 $d\\hat{s}^{2} = - d\\rho^{2} + \\cosh^{2}\\!\\rho\\, (d\\theta^{2} + \\sin^{2}\\!\\theta\\, d\\phi^{2}) + d\\eta^{2}$。\n\n2.  **带帽参考系中的流：** 目标是在弯曲参考系中找到一个静态解。在这个 $\\mathrm{dS}_3$ 的静态区域中，类时坐标是 $\\rho$。静态流体相对于坐标是静止的，因此其四维速度 $\\hat{u}^{\\mu}$ 必须纯粹指向时间方向。归一化条件 $\\hat{g}_{\\mu\\nu}\\hat{u}^\\mu\\hat{u}^\\nu = -1$ 和 $\\hat{g}_{\\rho\\rho}=-1$ 要求在 $(\\rho,\\theta,\\phi,\\eta)$ 坐标下 $\\hat{u}^{\\mu} = (1,0,0,0)$。这是正确的。\n\n3.  **流体力学方程及其解：** 我们必须在此背景下求解静态流体的 $\\hat{\\nabla}_{\\mu} \\hat{T}^{\\mu\\nu} = 0$。能量守恒方程是 $\\hat{\\nabla}_{\\mu}(\\hat{\\epsilon}\\hat{u}^{\\mu})+\\hat{p}\\hat{\\nabla}_{\\mu}\\hat{u}^{\\mu}=0$。将此方程沿流线投影（$\\hat{u}_\\nu \\hat{\\nabla}_\\mu \\hat{T}^{\\mu\\nu}=0$）得到 $\\partial_{\\rho}\\hat{\\epsilon} = -(\\hat{\\epsilon}+\\hat{p})(\\hat{\\nabla}_{\\mu}\\hat{u}^{\\mu})$。\n    静态速度场的四维散度是 $\\hat{\\nabla}_{\\mu}\\hat{u}^{\\mu} = \\frac{1}{\\sqrt{-\\hat{g}}}\\partial_{\\rho}(\\sqrt{-\\hat{g}})$，其中 $\\sqrt{-\\hat{g}} = \\cosh^2\\rho \\sin\\theta$。这得出 $\\hat{\\nabla}_{\\mu}\\hat{u}^{\\mu} = 2\\tanh\\rho$。\n    使用共形状态方程 $\\hat{\\epsilon}=3\\hat{p}$，我们有 $\\hat{\\epsilon}+\\hat{p} = \\frac{4}{3}\\hat{\\epsilon}$。能量守恒方程变为\n    $$\n    \\frac{d\\hat{\\epsilon}}{d\\rho} = -\\frac{4}{3}\\hat{\\epsilon} (2 \\tanh\\rho) = -\\frac{8}{3}\\hat{\\epsilon}\\tanh\\rho\n    $$\n    由于对于共形流体有 $\\hat{\\epsilon} \\propto \\hat{T}^4$，我们有 $\\frac{1}{\\hat{\\epsilon}}\\frac{d\\hat{\\epsilon}}{d\\rho} = \\frac{4}{\\hat{T}}\\frac{d\\hat{T}}{d\\rho}$。代入此式得到\n    $$\n    \\frac{1}{\\hat{T}} \\frac{d\\hat{T}}{d\\rho} = -\\frac{2}{3}\\tanh\\rho\n    $$\n    这与选项中的方程相符。对这个常微分方程积分得到 $\\ln\\hat{T} = -\\frac{2}{3}\\ln(\\cosh\\rho) + C$，这导致 $\\hat{T}(\\rho) = \\hat{T}_{0}(\\cosh\\rho)^{-2/3}$，与所述完全一致。因此，$\\hat{\\epsilon} \\propto \\hat{T}^4 \\propto (\\cosh\\rho)^{-8/3}$。\n\n4.  **映射回闵可夫斯基空间：** 质量量纲为 $\\Delta$ 的场 $\\Phi$ 变换为 $\\hat{\\Phi} = \\Omega^{-\\Delta}\\Phi$。温度 $T$ 的量纲 $\\Delta=1$，能量密度 $\\epsilon$ 的量纲 $\\Delta=4$。对于 $\\Omega=1/\\tau$，我们有 $\\hat{T} = (1/\\tau)^{-1}T = \\tau T \\implies T = \\hat{T}/\\tau$。类似地，$\\hat{\\epsilon} = (1/\\tau)^{-4}\\epsilon = \\tau^4\\epsilon \\implies \\epsilon = \\hat{\\epsilon}/\\tau^4$。这些变换法则是正确的。\n\n5.  **速度场：** 四维速度由 $u^\\tau = \\cosh\\kappa$ 和 $u^r = \\sinh\\kappa$ 给出。横向速度为 $v_\\perp=u^r/u^\\tau = \\tanh\\kappa$。给出的表达式，\n    $$\n    v_{\\perp}(\\tau,r) = \\frac{2 q^{2}\\, \\tau\\, r}{1 + q^{2}\\tau^{2} + q^{2} r^{2}}\n    $$\n    是与此特定坐标选择相关联的 Gubser 流的正确横向速度表达式。\n\n6.  **作为基准的重要性：** 解释是准确的。Bjorken 流是一种 1+1D（时间+纵向）的膨胀。Gubser 流是第一个已知的 3+1D 解析解，它在保持 boost 不变性的同时，包含了非平庸的横向膨胀动力学。这使其成为验证数值流体力学代码准确性，以及研究像喷注淬火这类现象（其中介质的路径长度和流速至关重要）的一个重要基准。\n\n**对 A 的结论：** **正确**。该选项的所有部分都是一致的，并准确地描述了 Gubser 流的构造和性质。\n\n---\n\n**B. 执行外尔重标度，因子为 $\\Omega = \\tau$，并将平直闵可夫斯基空间映射到 $\\mathrm{AdS}_{3} \\times \\mathbb{R}$，其中流在闵可夫斯基坐标下保持静态 $u^{\\mu} = (1,0,0,0)$。……**\n\n-   映射的目标空间是德西特空间（$\\mathrm{dS}_3$），而不是反德西特空间（$\\mathrm{AdS}_3$）。\n-   假设流在闵可夫斯基坐标下是静态的，$u^\\mu=(1,0,0,0)$，意味着没有流动，也没有横向动力学，这与问题的目标相矛盾。\n-   温度分布 $T(\\tau) \\propto \\tau^{-1/3}$ 描述的是 Bjorken 流，它只有纵向膨胀而没有横向动力学，再次与问题的要求相矛盾。\n\n**对 B 的结论：** **不正确**。它错误地识别了目标时空，并描述了平庸解/Bjorken 解，而不是一个具有横向动力学的解。\n\n---\n\n**C. 通过将体积和剪切粘滞系数都设为零来强制共形对称性，这意味着在任何弯曲参考系中温度必须满足 $d\\hat{T}/d\\rho = - \\frac{1}{3} \\hat{T}\\, \\tanh \\rho$，从而得到 $\\hat{T}(\\rho) \\propto (\\cosh \\rho)^{-1/3}$。……**\n\n-   温度演化方程是错误的。正确的系数是 $-2/3$，如上所述。系数 $-1/3$ 会导致不正确的解。\n-   映射法则 $T(\\tau,r) = \\hat{T}(\\rho)$ 是不正确的。它缺少了来自外尔变换的因子 $\\Omega^{-1}$（即 $1/\\tau$）。\n-   它假设在闵可夫斯基空间中 $u^{\\mu}=(1,0,0,0)$，这是一个没有流动的静态流体，与问题的目标相矛盾。\n\n**对 C 的结论：** **不正确**。它提出了一个错误的演化方程、一个错误的温度映射法则，并假设了一个平庸的速度场。\n\n---\n\n**D. 使用与选项 A 中相同的外尔映射，但允许一个非静态的带帽流，其中 $\\hat{u}^{\\rho} \\neq 0$，以产生更强的横向动力学。在闵可夫斯基空间中得到的速度为 $v_{\\perp}(\\tau,r) = \\frac{q\\, r}{1 + q^{2}\\tau^{2} - q^{2} r^{2}}$，而温度变换为 $T(\\tau,r) = \\hat{T}(\\rho)\\, \\tau$，因为温度的外尔权重为 -1。该流具有非平庸的横向剪切，因此是比任何静态带帽参考系构造更好的基准。**\n\n-   Gubser 流的共形映射技术的核心思想是通过找到一个流是静态的参考系来简化问题。允许在带帽参考系中存在非静态流违背了这一目的，并使问题再次变得困难。\n-   速度 $v_{\\perp}(\\tau,r) = \\frac{q\\, r}{1 + q^{2}\\tau^{2} - q^{2} r^{2}}$ 是非物理的；对于某些 $\\tau$ 和 $r$ 的值，分母可以为零，导致超光速。\n-   温度变换 $T(\\tau,r) = \\hat{T}(\\rho)\\, \\tau$ 是不正确的。如在对 A 的分析中所确立的，正确的关系是 $T = \\hat{T}/\\tau$。\n-   根据定义，理想流体的剪切粘滞系数为零，因此它不可能具有“非平庸的横向剪切”（即非零的剪切应力张量）。\n\n**对 D 的结论：** **不正确**。它滥用了映射技术，提出了一个非物理的速度，使用了错误的变换法则，并对剪切应力作出了错误的论断。\n\n---\n\n**E. 不执行外尔重标度，而是在状态方程 $p(\\epsilon) = \\epsilon/3 + q^{4}$ 中手动引入标度 $q$ 以破坏平移不变性，同时保持 $u^{\\mu} = (1,0,0,0)$。……**\n\n-   提出的状态方程 $p(\\epsilon) = \\epsilon/3 + q^{4}$ 不是共形的。它违反了问题中明确的条件 $\\epsilon=3p$。\n-   它建议保持 $u^{\\mu} = (1,0,0,0)$，这意味着没有流动。\n-   该选项是自相矛盾的：它声称由此产生的压力梯度导致加速，这与静态速度场 $u^{\\mu}=(1,0,0,0)$ 的假设不相容。\n\n**对 E 的结论：** **不正确**。它违反了问题的一个基本前提（共形状态方程），并且内部是矛盾的。", "answer": "$$\\boxed{A}$$", "id": "3516455"}, {"introduction": "重离子碰撞模拟的最终目标之一是研究夸克-胶子等离子体（QGP）中的物理现象，而喷注淬火是其中的关键探针。高能部分子（喷注）在穿过 QGP 时会损失能量，其损失率由输运系数 $\\hat{q}$ 表征，并受到介质集体流动的显著影响。此实践练习 [@problem_id:3516447] 让你能够将宏观的流体模型与微观的相互作用物理联系起来，通过从洛伦兹协变性出发推导有效输运系数，并计算其沿路径的积分，你将掌握如何量化介质流对喷注能量损失的关键影响。", "problem": "考虑在高能重离子碰撞中，超相对论性喷注与流体动力学介质的相互作用。在自然单位制（其中 $c=1$）下进行计算。采用闵可夫斯基度规，其符号为 $(+,-,-,-)$。设喷注的四动量为 $p^\\mu = (E,\\vec{p})$，其中 $|\\vec{p}| \\approx E$，单位方向为 $\\vec{n} = \\vec{p}/|\\vec{p}|$。设介质的四速度为 $u^\\mu = \\gamma(\\vec{v}) \\, (1,\\vec{v})$，其中 $\\gamma(\\vec{v}) = 1/\\sqrt{1-|\\vec{v}|^2}$。将局域静止系（LRF）中的横向动量展宽输运系数 $\\hat{q}_{\\mathrm{LRF}}(T)$ 定义为喷注在流体局域静止系中每单位长度获得的横向动量平方的变化率。假设本构关系为：当 $T \\ge T_c$ 时，$\\hat{q}_{\\mathrm{LRF}}(T) = \\kappa \\, T^3$；当 $T  T_c$ 时，$\\hat{q}_{\\mathrm{LRF}}(T) = 0$。其中 $T$ 是局域温度，$T_c$ 是赝临界温度，$\\kappa$ 是一个常数。温度的单位是 $\\mathrm{GeV}$，长度的单位是 $\\mathrm{fm}$，$\\hat{q}$ 的单位是 $\\mathrm{GeV}^2/\\mathrm{fm}$。\n\n任务1（推导）：仅从洛伦兹协变性、四速度 $u^\\mu$ 和四动量 $p^\\mu$ 的定义、洛伦兹不变量标量 $u^\\mu p_\\mu$ 以及 $\\hat{q}_{\\mathrm{LRF}}$ 作为局域静止系中每单位长度变化率的物理解释出发，推导一个表达式，用于描述在流动的介质中运动的喷注所经历的瞬时有效展宽率（相对于实验室坐标系单位长度），记为 $\\hat{q}_{\\mathrm{eff}}$。您的推导必须明确地将 $\\hat{q}_{\\mathrm{eff}}$ 与 $\\hat{q}_{\\mathrm{LRF}}$、$u^\\mu$ 和 $p^\\mu$ 联系起来，并且必须确定一个乘法因子，该因子在喷注是超相对论性且 $|\\vec{v}|  1$ 时简化为类多普勒形式。推导之初，不要预设 $\\hat{q}_{\\mathrm{eff}}$ 的任何具体形式；相反，应从所述的不变性性质和物理解释中推导出来。\n\n任务2（路径积分）：考虑一个喷注在时间 $t_0 = 0$ 从位置 $\\vec{x}_0 = (x_0,y_0)$ 出发，以速度 $|\\vec{v}_{\\mathrm{jet}}|=1$ 沿着单位方向 $\\vec{n}=(n_x,n_y)$ 穿过一个二维横向对称的介质。该介质具有静态温度场\n$$\nT(x,y) = T_0 \\exp\\!\\left(-\\frac{x^2 + y^2}{2 \\sigma^2}\\right).\n$$\n介质具有均匀且恒定的流速 $\\vec{v} = (V_x,V_y)$，因此 $u^\\mu$ 在空间上是恒定的。用实验室坐标系中的弧长 $s \\in [0,L]$ 来参数化喷注路径，其中 $\\vec{x}(s) = \\vec{x}_0 + s \\, \\vec{n}$ 且 $t(s) = t_0 + s$。使用您推导出的 $\\hat{q}_{\\mathrm{eff}}$，计算线积分\n$$\nJ = \\int_0^L \\hat{q}_{\\mathrm{eff}}(\\vec{x}(s)) \\, ds,\n$$\n其单位为 $\\mathrm{GeV}^2$。该积分表示沿路径累积的横向动量展宽。如果在路径上的某点 $T(\\vec{x}(s))  T_c$，则该点的 $\\hat{q}_{\\mathrm{LRF}}$ 为零，该路径段不应计入积分贡献。\n\n任务3（实现与输出）：实现一个程序，对以下每个测试用例执行上述计算。对于每个用例，使用给定的参数，并通过在 $s \\in [0,L]$ 上使用稳定、收敛的求积方法，以高数值精度计算 $J$。所有 $J$ 值均以 $\\mathrm{GeV}^2$ 为单位，并精确到小数点后 $6$ 位。\n\n所有用例的通用参数：\n- $\\kappa = 2.0 \\, \\mathrm{GeV}^2/(\\mathrm{fm}\\cdot\\mathrm{GeV}^3)$,\n- $T_c = 0.16 \\, \\mathrm{GeV}$,\n- $t_0 = 0$.\n\n介质温度场参数为 $T_0$ 和 $\\sigma$，具体值见各用例。对于每个用例，介质速度 $\\vec{v} = (V_x,V_y)$ 在时空中是均匀的。喷注从 $\\vec{x}_0 = (x_0,y_0)$ 出发，沿着方向 $\\vec{n}=(n_x,n_y)$ 传播长度 $L$，其中 $\\vec{n}$ 是横向平面上的单位矢量。\n\n测试套件：\n- 用例 $1$（基准静止介质）：$T_0 = 0.5$, $\\sigma = 5.0$, $(V_x,V_y) = (0.0,0.0)$, $(x_0,y_0) = (0.0,0.0)$, $(n_x,n_y) = (1.0,0.0)$, $L = 10.0$。\n- 用例 $2$（沿喷注方向同向流动）：$T_0 = 0.5$, $\\sigma = 5.0$, $(V_x,V_y) = (0.6,0.0)$, $(x_0,y_0) = (0.0,0.0)$, $(n_x,n_y) = (1.0,0.0)$, $L = 10.0$。\n- 用例 $3$（逆喷注方向反向流动）：$T_0 = 0.5$, $\\sigma = 5.0$, $(V_x,V_y) = (-0.6,0.0)$, $(x_0,y_0) = (0.0,0.0)$, $(n_x,n_y) = (1.0,0.0)$, $L = 10.0$。\n- 用例 $4$（正交快速流动）：$T_0 = 0.5$, $\\sigma = 5.0$, $(V_x,V_y) = (0.0,0.9)$, $(x_0,y_0) = (0.0,0.0)$, $(n_x,n_y) = (1.0,0.0)$, $L = 10.0$。\n- 用例 $5$（在边缘附近与同向流动的短程重叠）：$T_0 = 0.5$, $\\sigma = 5.0$, $(V_x,V_y) = (0.6,0.0)$, $(x_0,y_0) = (6.0,0.0)$, $(n_x,n_y) = (1.0,0.0)$, $L = 10.0$。\n\n所有未标明单位的量，温度的单位为 $\\mathrm{GeV}$，长度的单位为 $\\mathrm{fm}$；速度是在自然单位制下光速的无量纲分数。角度不直接使用；方向由单位矢量的分量给出。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的每个 $J$ 值都精确到小数点后 $6$ 位，并按测试套件的指定顺序排列，例如 $[J_1,J_2,J_3,J_4,J_5]$，其中每个 $J_i$ 是一个代表 $\\mathrm{GeV}^2$ 的浮点数。", "solution": "该问题要求一个三部分的解决方案：有效动量展宽率 $\\hat{q}_{\\mathrm{eff}}$ 的理论推导，总累积展宽的路径积分 $J$ 的公式化，以及一个计算多个测试用例中 $J$ 值的数值实现。\n\n### 任务1：有效展宽率 $\\hat{q}_{\\mathrm{eff}}$ 的推导\n我们的任务是从介质局域静止系（LRF）中每单位长度的变化率 $\\hat{q}_{\\mathrm{LRF}}$ 出发，推导实验室坐标系中每单位长度的横向动量展宽率 $\\hat{q}_{\\mathrm{eff}}$ 的表达式。\n\n设 $d\\langle p_\\perp^2 \\rangle$ 为喷注获得的横向动量平方的无穷小增量。问题将LRF输运系数定义为：\n$$\n\\hat{q}_{\\mathrm{LRF}} = \\frac{d\\langle p_\\perp^2 \\rangle}{ds_{\\mathrm{LRF}}}\n$$\n其中 $ds_{\\mathrm{LRF}}$ 是喷注在流体元局域静止系中测量的无穷小路径长度。\n\n我们的目标是找到实验室坐标系中的有效变化率：\n$$\n\\hat{q}_{\\mathrm{eff}} = \\frac{d\\langle p_\\perp^2 \\rangle}{ds_{\\mathrm{lab}}}\n$$\n其中 $ds_{\\mathrm{lab}}$ 是实验室坐标系中的无穷小路径长度。\n\n根据链式法则，我们可以将这两个量联系起来：\n$$\n\\hat{q}_{\\mathrm{eff}} = \\frac{d\\langle p_\\perp^2 \\rangle}{ds_{\\mathrm{LRF}}} \\frac{ds_{\\mathrm{LRF}}}{ds_{\\mathrm{lab}}} = \\hat{q}_{\\mathrm{LRF}} \\frac{ds_{\\mathrm{LRF}}}{ds_{\\mathrm{lab}}}\n$$\n推导的核心是找到 $ds_{\\mathrm{LRF}}$ 和 $ds_{\\mathrm{lab}}$ 之间的洛伦兹不变关系。\n\n设 $dx^\\mu$ 为喷注在实验室坐标系中的无穷小时空位移四维矢量。由于喷注是超相对论性的，它以光速（$c=1$）运动。如果 $ds_{\\mathrm{lab}}$ 是路径长度，所用时间为 $dt_{\\mathrm{lab}} = ds_{\\mathrm{lab}}$。喷注沿单位矢量 $\\vec{n}$ 给出的方向行进。因此，位移四维矢量为：\n$$\ndx^\\mu = (dt_{\\mathrm{lab}}, d\\vec{x}_{\\mathrm{lab}}) = (ds_{\\mathrm{lab}}, \\vec{n} \\, ds_{\\mathrm{lab}})\n$$\n现在，考虑介质的四速度 $u^\\mu = \\gamma(\\vec{v})(1, \\vec{v})$，其中 $\\vec{v}$ 是实验室坐标系中的流体速度，且 $\\gamma(\\vec{v}) = (1 - |\\vec{v}|^2)^{-1/2}$。\n\n与时空位移 $dx^\\mu$ 对应的流体元局域静止系中流逝的时间 $dt_{\\mathrm{LRF}}$，由 $dx^\\mu$ 在流体四速度 $u_\\mu$ 上的洛伦兹不变投影给出。在LRF中，$u'^\\mu = (1, \\vec{0})$，所以 $u'_\\mu dx'^\\mu = dt_{\\mathrm{LRF}}$。由于洛伦兹不变性，这在任何坐标系中都成立：\n$$\ndt_{\\mathrm{LRF}} = u_\\mu dx^\\mu\n$$\n使用符号为 $(+,-,-,-)$ 的闵可夫斯基度规，我们有 $u_\\mu = \\gamma(\\vec{v})(1, -\\vec{v})$。我们计算点积：\n$$\ndt_{\\mathrm{LRF}} = \\gamma(\\vec{v})(1, -\\vec{v}) \\cdot (ds_{\\mathrm{lab}}, \\vec{n} \\, ds_{\\mathrm{lab}}) = \\gamma(\\vec{v}) (1 \\cdot ds_{\\mathrm{lab}} - \\vec{v} \\cdot \\vec{n} \\, ds_{\\mathrm{lab}}) = \\gamma(\\vec{v})(1 - \\vec{v} \\cdot \\vec{n}) \\, ds_{\\mathrm{lab}}\n$$\n由于喷注是无质量的（或超相对论性的），它在任何惯性系中都以光速运动。因此，在LRF中行进的路径长度 $ds_{\\mathrm{LRF}}$ 等于在LRF中流逝的时间 $dt_{\\mathrm{LRF}}$（因为 $c=1$）。\n$$\nds_{\\mathrm{LRF}} = dt_{\\mathrm{LRF}}\n$$\n将此代入我们关于 $dt_{\\mathrm{LRF}}$ 的表达式，我们得到路径长度之间的关系：\n$$\n\\frac{ds_{\\mathrm{LRF}}}{ds_{\\mathrm{lab}}} = \\gamma(\\vec{v})(1 - \\vec{v} \\cdot \\vec{n})\n$$\n这就是所要求的乘法因子。它具有“类多普勒”形式。现在，我们将其代回到 $\\hat{q}_{\\mathrm{eff}}$ 的关系式中：\n$$\n\\hat{q}_{\\mathrm{eff}} = \\hat{q}_{\\mathrm{LRF}} \\cdot \\gamma(\\vec{v})(1 - \\vec{v} \\cdot \\vec{n})\n$$\n为了用喷注四动量 $p^\\mu = (E, \\vec{p})$ 来表示它，我们注意到对于超相对论性喷注，有 $|\\vec{p}| \\approx E$ 和 $\\vec{n} = \\vec{p}/|\\vec{p}| \\approx \\vec{p}/E$。\n洛伦兹标量 $u^\\mu p_\\mu$ 是：\n$$\nu^\\mu p_\\mu = \\gamma(\\vec{v})(1, \\vec{v}) \\cdot (E, -\\vec{p}) = \\gamma(\\vec{v})(E - \\vec{v} \\cdot \\vec{p}) = \\gamma(\\vec{v})E(1 - \\vec{v} \\cdot (\\vec{p}/E)) \\approx \\gamma(\\vec{v})E(1 - \\vec{v} \\cdot \\vec{n})\n$$\n由此可见，推导出的因子是 $\\frac{u^\\mu p_\\mu}{E}$。有效展宽率的最终表达式是：\n$$\n\\hat{q}_{\\mathrm{eff}} = \\hat{q}_{\\mathrm{LRF}}(T) \\frac{u^\\mu p_\\mu}{E} = \\hat{q}_{\\mathrm{LRF}}(T) \\, \\gamma(\\vec{v})(1 - \\vec{v} \\cdot \\vec{n})\n$$\n\n### 任务2：路径积分的公式化\n我们需要通过沿喷注路径对 $\\hat{q}_{\\mathrm{eff}}$ 进行积分来计算总累积横向动量展宽 $J$：\n$$\nJ = \\int_0^L \\hat{q}_{\\mathrm{eff}}(\\vec{x}(s)) \\, ds\n$$\n喷注的路径由实验室坐标系中的弧长 $s \\in [0,L]$ 参数化为 $\\vec{x}(s) = \\vec{x}_0 + s\\vec{n}$。介质具有均匀的流速 $\\vec{v} = (V_x, V_y)$ 和静态温度分布 $T(x,y) = T_0 \\exp[-(x^2+y^2)/(2\\sigma^2)]$。$\\hat{q}_{\\mathrm{LRF}}$ 的本构关系是：当 $T \\ge T_c$ 时为 $\\kappa T^3$，否则为 $0$。\n\n结合这些元素，被积函数是：\n$$\n\\hat{q}_{\\mathrm{eff}}(s) = \\kappa [T(\\vec{x}(s))]^3 \\cdot \\gamma(\\vec{v})(1 - \\vec{v} \\cdot \\vec{n})\n$$\n类多普勒因子 $F_D = \\gamma(\\vec{v})(1 - \\vec{v} \\cdot \\vec{n})$ 沿路径是恒定的。温度通过位置 $\\vec{x}(s)$ 依赖于路径参数 $s$：\n$$\nT(\\vec{x}(s)) = T_0 \\exp\\left(-\\frac{|\\vec{x}_0 + s\\vec{n}|^2}{2\\sigma^2}\\right) = T_0 \\exp\\left(-\\frac{|\\vec{x}_0|^2 + 2s(\\vec{x}_0 \\cdot \\vec{n}) + s^2}{2\\sigma^2}\\right)\n$$\n积分 $J$ 可以写成：\n$$\nJ = \\kappa \\, T_0^3 \\, \\gamma(\\vec{v})(1 - \\vec{v} \\cdot \\vec{n}) \\int_{\\text{path}} \\exp\\left(-\\frac{3(|\\vec{x}_0|^2 + 2s(\\vec{x}_0 \\cdot \\vec{n}) + s^2)}{2\\sigma^2}\\right) ds\n$$\n积分仅在路径上 $T(\\vec{x}(s)) \\ge T_c$ 的部分非零。这个条件定义了积分的上下限。\n$$\nT_0 \\exp\\left(-\\frac{|\\vec{x}(s)|^2}{2\\sigma^2}\\right) \\ge T_c \\implies |\\vec{x}(s)|^2 \\le 2\\sigma^2 \\ln\\left(\\frac{T_0}{T_c}\\right)\n$$\n令 $R_{\\mathrm{max}}^2 = 2\\sigma^2 \\ln(T_0/T_c)$。如果 $T_0  T_c$，这个量没有良好定义或是负数，积分为 $0$。不等式变为 $|\\vec{x}_0|^2 + 2s(\\vec{x}_0 \\cdot \\vec{n}) + s^2 \\le R_{\\mathrm{max}}^2$，这是一个关于 $s$ 的二次不等式：\n$$\ns^2 + 2(\\vec{x}_0 \\cdot \\vec{n})s + (|\\vec{x}_0|^2 - R_{\\mathrm{max}}^2) \\le 0\n$$\n解对应的一元二次方程 $s^2 + 2(\\vec{x}_0 \\cdot \\vec{n})s + (|\\vec{x}_0|^2 - R_{\\mathrm{max}}^2) = 0$ 得到两个根 $s_1$ 和 $s_2$。条件 $T \\ge T_c$ 在 $s \\in [s_1, s_2]$ 时满足。实际的积分范围还必须位于喷注的总路径长度 $[0,L]$ 之内。因此，积分的上下限是：\n$$\ns_{\\mathrm{start}} = \\max(0, s_1) \\quad \\text{和} \\quad s_{\\mathrm{end}} = \\min(L, s_2)\n$$\n如果二次方程的判别式为负，或者 $s_{\\mathrm{end}} \\le s_{\\mathrm{start}}$，则喷注路径不穿过热区，此时 $J=0$。\n\n### 任务3：数值实现\n所得的定积分通常没有以初等函数表示的简单闭合形式解。一个稳健的方法是使用数值求积。实现将通过以下步骤为每个测试用例计算 $J$：\n1.  计算恒定的多普勒因子 $F_D = \\gamma(1 - \\vec{v} \\cdot \\vec{n})$。\n2.  通过解由条件 $T(s) \\ge T_c$ 推导出的二次不等式，确定积分上下限 $s_{\\mathrm{start}}$ 和 $s_{\\mathrm{end}}$。\n3.  定义被积函数，它与 $\\exp(-3|\\vec{x}(s)|^2 / (2\\sigma^2))$ 成正比。\n4.  使用数值积分程序（如 `scipy.integrate.quad`）计算在 $[s_{\\mathrm{start}}, s_{\\mathrm{end}}]$ 上的积分。\n5.  将积分的数值结果乘以常数前置因子 $\\kappa \\, T_0^3 \\, F_D$，得到 $J$ 的最终值。\n\n#### 代码实现\n```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import quad\n\ndef solve():\n    \"\"\"\n    Computes the accumulated transverse momentum broadening for a jet in a\n    hydrodynamic medium for a series of test cases.\n    \"\"\"\n    # Common parameters for all cases\n    kappa = 2.0  # GeV^2/(fm*GeV^3)\n    Tc = 0.16    # GeV\n\n    # Test suite from the problem statement\n    test_cases = [\n        # Case 1: baseline rest medium\n        {'T0': 0.5, 'sigma': 5.0, 'Vx': 0.0, 'Vy': 0.0, 'x0': 0.0, 'y0': 0.0, 'nx': 1.0, 'ny': 0.0, 'L': 10.0},\n        # Case 2: co-flow along the jet\n        {'T0': 0.5, 'sigma': 5.0, 'Vx': 0.6, 'Vy': 0.0, 'x0': 0.0, 'y0': 0.0, 'nx': 1.0, 'ny': 0.0, 'L': 10.0},\n        # Case 3: counter-flow against the jet\n        {'T0': 0.5, 'sigma': 5.0, 'Vx': -0.6, 'Vy': 0.0, 'x0': 0.0, 'y0': 0.0, 'nx': 1.0, 'ny': 0.0, 'L': 10.0},\n        # Case 4: orthogonal fast flow\n        {'T0': 0.5, 'sigma': 5.0, 'Vx': 0.0, 'Vy': 0.9, 'x0': 0.0, 'y0': 0.0, 'nx': 1.0, 'ny': 0.0, 'L': 10.0},\n        # Case 5: short overlap near edge with co-flow\n        {'T0': 0.5, 'sigma': 5.0, 'Vx': 0.6, 'Vy': 0.0, 'x0': 6.0, 'y0': 0.0, 'nx': 1.0, 'ny': 0.0, 'L': 10.0},\n    ]\n\n    results = []\n\n    for case in test_cases:\n        T0 = case['T0']\n        sigma = case['sigma']\n        Vx, Vy = case['Vx'], case['Vy']\n        x0, y0 = case['x0'], case['y0']\n        nx, ny = case['nx'], case['ny']\n        L = case['L']\n\n        # Step 1: Calculate the constant Doppler factor\n        v_norm_sq = Vx**2 + Vy**2\n        if v_norm_sq >= 1.0:\n            # Physically impossible velocity, handle gracefully\n            results.append(0.0)\n            continue\n        gamma = 1.0 / np.sqrt(1.0 - v_norm_sq)\n        v_dot_n = Vx * nx + Vy * ny\n        doppler_factor = gamma * (1.0 - v_dot_n)\n\n        # Step 2: Determine the integration limits from T(s) >= Tc\n        if T0  Tc:\n            results.append(0.0)\n            continue\n        \n        R2_max = 2.0 * sigma**2 * np.log(T0 / Tc)\n\n        # Solve s^2 + 2*(x0 . n)*s + (|x0|^2 - R2_max) = 0\n        x0_dot_n = x0 * nx + y0 * ny\n        x0_norm_sq = x0**2 + y0**2\n\n        # Quadratic equation coefficients: a*s^2 + b*s + c = 0\n        a = 1.0\n        b = 2.0 * x0_dot_n\n        c = x0_norm_sq - R2_max\n\n        discriminant = b**2 - 4.0 * a * c\n        if discriminant  0:\n            results.append(0.0)\n            continue\n\n        sqrt_discriminant = np.sqrt(discriminant)\n        s1 = (-b - sqrt_discriminant) / (2.0 * a)\n        s2 = (-b + sqrt_discriminant) / (2.0 * a)\n\n        s_start = max(0.0, s1)\n        s_end = min(L, s2)\n\n        if s_start >= s_end:\n            results.append(0.0)\n            continue\n\n        # Step 3: Define the integrand for numerical integration\n        def integrand(s):\n            x = x0 + s * nx\n            y = y0 + s * ny\n            r_sq = x**2 + y**2\n            # This is the T^3 part, scaled by T0^3, which is a prefactor\n            return np.exp(-3.0 * r_sq / (2.0 * sigma**2))\n\n        # Step 4: Perform the integration\n        integral_val, _ = quad(integrand, s_start, s_end, epsabs=1e-12, epsrel=1e-12)\n\n        # Step 5: Combine all factors to get the final result for J\n        J = doppler_factor * kappa * (T0**3) * integral_val\n        results.append(J)\n    \n    return results\n\n# The solve function is not called here directly but is available.\n# This entire code block is part of the solution.\n# The final answer tag will contain the numerical result from running this code.\n```", "answer": "`[0.898495,0.449247,1.796990,2.061218,0.007693]`", "id": "3516447"}]}