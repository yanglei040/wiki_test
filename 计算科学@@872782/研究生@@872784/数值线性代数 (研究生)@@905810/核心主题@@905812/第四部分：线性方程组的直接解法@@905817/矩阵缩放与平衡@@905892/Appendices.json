{
        "hands_on_practices": [
            {
                "introduction": "矩阵缩放的一个主要动机是改善线性系统求解的数值稳定性。本练习通过一个具体的例子，让您亲手计算并比较缩放前后范数后向误差的变化，从而直观地理解一个简单的对角缩放如何能显著提高计算结果的可靠性。[@problem_id:3559217]",
                "problem": "考虑线性系统 $A x = b$，其中\n$$\nA \\;=\\; \\begin{pmatrix} 1000  1 \\\\ 1  0.001 \\end{pmatrix}, \\qquad \\widehat{x} \\;=\\; \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}.\n$$\n假设计算出的残差为\n$$\nr \\;=\\; b - A \\widehat{x} \\;=\\; \\begin{pmatrix} 1 \\\\ 0.001 \\end{pmatrix},\n$$\n因此 $b = A \\widehat{x} + r$。你需要评估对角缩放对范数反向误差的影响，使用诱导无穷范数。\n\n对于未缩放的系统，将范数反向误差（在无穷范数下）定义为最小标量 $\\eta \\ge 0$，使得存在扰动 $\\Delta A$ 和 $\\Delta b$ 满足 $(A + \\Delta A)\\,\\widehat{x} = b + \\Delta b$，且 $\\|\\Delta A\\|_{\\infty} \\le \\eta \\,\\|A\\|_{\\infty}$ 和 $\\|\\Delta b\\|_{\\infty} \\le \\eta \\,\\|b\\|_{\\infty}$。对于缩放后的系统，应用对角列缩放 $D_c = \\mathrm{diag}(10^{-3}, 10^{3})$，将系统重写为 $(A D_c) y = b$，其中 $y = D_c^{-1} \\widehat{x}$，并为对 $(A D_c, b)$ 类似地定义缩放后的范数反向误差。\n\n仅使用诱导矩阵范数和范数反向误差的基本定义，推导未缩放和缩放后系统在无穷范数下的范数反向误差的标准界，并计算缩减因子\n$$\n\\rho \\;=\\; \\frac{\\eta_{\\mathrm{scaled}}}{\\eta_{\\mathrm{unscaled}}}.\n$$\n将你计算的 $\\rho$ 的最终答案四舍五入到 $4$ 位有效数字。该答案是无量纲的，应以实数形式给出。",
                "solution": "该问题要求评估对角列缩放对给定线性系统的范数反向误差的影响。分析将使用诱导无穷范数进行。我们必须首先推导范数反向误差的标准公式，然后将其应用于未缩放和缩放后的系统以计算缩减因子。\n\n设给定系统 $A x = b$ 的近似解为 $\\widehat{x}$。残差为 $r = b - A\\widehat{x}$。范数反向误差 $\\eta$ 定义为最小的非负数，使得存在扰动 $\\Delta A$ 和 $\\Delta b$ 满足\n$$\n(A + \\Delta A)\\,\\widehat{x} = b + \\Delta b\n$$\n且满足约束条件 $\\|\\Delta A\\|_{\\infty} \\le \\eta \\,\\|A\\|_{\\infty}$ 和 $\\|\\Delta b\\|_{\\infty} \\le \\eta \\,\\|b\\|_{\\infty}$。\n\n首先，我们推导 $\\eta$ 的通用公式。重新整理扰动后的系统方程，我们得到残差的表达式：\n$$\nr = b - A\\widehat{x} = \\Delta A \\widehat{x} - \\Delta b\n$$\n对两边取无穷范数并应用三角不等式，我们得到：\n$$\n\\|r\\|_{\\infty} = \\|\\Delta A \\widehat{x} - \\Delta b\\|_{\\infty} \\le \\|\\Delta A \\widehat{x}\\|_{\\infty} + \\|\\Delta b\\|_{\\infty}\n$$\n利用诱导矩阵范数的性质 $\\|\\Delta A \\widehat{x}\\|_{\\infty} \\le \\|\\Delta A\\|_{\\infty} \\|\\widehat{x}\\|_{\\infty}$，我们有：\n$$\n\\|r\\|_{\\infty} \\le \\|\\Delta A\\|_{\\infty} \\|\\widehat{x}\\|_{\\infty} + \\|\\Delta b\\|_{\\infty}\n$$\n现在，我们代入关于扰动的约束条件 $\\|\\Delta A\\|_{\\infty} \\le \\eta \\,\\|A\\|_{\\infty}$ 和 $\\|\\Delta b\\|_{\\infty} \\le \\eta \\,\\|b\\|_{\\infty}$：\n$$\n\\|r\\|_{\\infty} \\le (\\eta \\,\\|A\\|_{\\infty}) \\|\\widehat{x}\\|_{\\infty} + (\\eta \\,\\|b\\|_{\\infty}) = \\eta \\left( \\|A\\|_{\\infty} \\|\\widehat{x}\\|_{\\infty} + \\|b\\|_{\\infty} \\right)\n$$\n这个不等式给出了 $\\eta$ 的一个下界：\n$$\n\\eta \\ge \\frac{\\|r\\|_{\\infty}}{\\|A\\|_{\\infty} \\|\\widehat{x}\\|_{\\infty} + \\|b\\|_{\\infty}}\n$$\n这个下界是可以达到的。可以构造一组特定的扰动 $\\Delta A$ 和 $\\Delta b$ 来证明这个最小值是可以达到的。令 $\\theta = \\|A\\|_{\\infty} \\|\\widehat{x}\\|_{\\infty} + \\|b\\|_{\\infty}$。考虑扰动\n$$\n\\Delta b = - \\frac{\\|b\\|_{\\infty}}{\\theta} r \\qquad \\text{和} \\qquad \\Delta A = \\frac{\\|A\\|_{\\infty}}{\\theta} \\frac{r z^T}{z^T \\widehat{x} / \\|\\widehat{x}\\|_{\\infty}}\n$$\n其中 $z$ 是来自对偶空间的一个向量，满足 $\\|z\\|_1 = 1$ 和 $z^T \\widehat{x} = \\|\\widehat{x}\\|_{\\infty}$。这些扰动满足 $\\Delta A \\widehat{x} - \\Delta b = r$，并且当 $\\eta$ 等于下界时，满足界限 $\\|\\Delta A\\|_{\\infty} = \\eta \\|A\\|_{\\infty}$ 和 $\\|\\Delta b\\|_{\\infty} = \\eta \\|b\\|_{\\infty}$。因此，范数反向误差精确地为：\n$$\n\\eta = \\frac{\\|r\\|_{\\infty}}{\\|A\\|_{\\infty} \\|\\widehat{x}\\|_{\\infty} + \\|b\\|_{\\infty}}\n$$\n\n现在，我们将此公式应用于未缩放的系统。给定的量为：\n$$\nA = \\begin{pmatrix} 1000  1 \\\\ 1  0.001 \\end{pmatrix}, \\quad \\widehat{x} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}, \\quad r = \\begin{pmatrix} 1 \\\\ 0.001 \\end{pmatrix}\n$$\n由此，我们可以确定右端向量 $b$：\n$$\nb = A\\widehat{x} + r = \\begin{pmatrix} 1000  1 \\\\ 1  0.001 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} + \\begin{pmatrix} 1 \\\\ 0.001 \\end{pmatrix} = \\begin{pmatrix} 1001 \\\\ 1.001 \\end{pmatrix} + \\begin{pmatrix} 1 \\\\ 0.001 \\end{pmatrix} = \\begin{pmatrix} 1002 \\\\ 1.002 \\end{pmatrix}\n$$\n我们计算所需的无穷范数。诱导矩阵无穷范数是最大绝对行和。\n$$\n\\|A\\|_{\\infty} = \\max(|1000| + |1|, |1| + |0.001|) = \\max(1001, 1.001) = 1001\n$$\n$$\n\\|\\widehat{x}\\|_{\\infty} = \\max(|1|, |1|) = 1\n$$\n$$\n\\|b\\|_{\\infty} = \\max(|1002|, |1.002|) = 1002\n$$\n$$\n\\|r\\|_{\\infty} = \\max(|1|, |0.001|) = 1\n$$\n未缩放系统的反向误差 $\\eta_{\\mathrm{unscaled}}$ 为：\n$$\n\\eta_{\\mathrm{unscaled}} = \\frac{\\|r\\|_{\\infty}}{\\|A\\|_{\\infty} \\|\\widehat{x}\\|_{\\infty} + \\|b\\|_{\\infty}} = \\frac{1}{1001 \\cdot 1 + 1002} = \\frac{1}{2003}\n$$\n\n接下来，我们分析缩放后的系统。缩放由 $D_c = \\mathrm{diag}(10^{-3}, 10^{3})$ 定义。系统被重写为 $(A D_c) y = b$，其中新矩阵为 $A' = A D_c$，新未知数为 $y = D_c^{-1} x$。缩放后系统的近似解为 $\\widehat{y} = D_c^{-1} \\widehat{x}$。\n让我们计算缩放后系统的各个组成部分：\n$$\nA' = A D_c = \\begin{pmatrix} 1000  1 \\\\ 1  0.001 \\end{pmatrix} \\begin{pmatrix} 10^{-3}  0 \\\\ 0  10^{3} \\end{pmatrix} = \\begin{pmatrix} 1  1000 \\\\ 0.001  1 \\end{pmatrix}\n$$\n$$\n\\widehat{y} = D_c^{-1} \\widehat{x} = \\begin{pmatrix} 10^{3}  0 \\\\ 0  10^{-3} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1000 \\\\ 0.001 \\end{pmatrix}\n$$\n缩放后系统的残差 $r' = b - A'\\widehat{y}$ 为：\n$$\nr' = b - (A D_c)(D_c^{-1} \\widehat{x}) = b - A\\widehat{x} = r = \\begin{pmatrix} 1 \\\\ 0.001 \\end{pmatrix}\n$$\n现在我们计算缩放后问题的范数：\n$$\n\\|A'\\|_{\\infty} = \\max(|1| + |1000|, |0.001| + |1|) = \\max(1001, 1.001) = 1001\n$$\n$$\n\\|\\widehat{y}\\|_{\\infty} = \\max(|1000|, |0.001|) = 1000\n$$\n$b$ 和 $r'$（即 $r$）的范数保持不变：$\\|b\\|_{\\infty} = 1002$ 和 $\\|r'\\|_{\\infty} = 1$。\n缩放后系统的反向误差 $\\eta_{\\mathrm{scaled}}$ 为：\n$$\n\\eta_{\\mathrm{scaled}} = \\frac{\\|r'\\|_{\\infty}}{\\|A'\\|_{\\infty} \\|\\widehat{y}\\|_{\\infty} + \\|b\\|_{\\infty}} = \\frac{1}{1001 \\cdot 1000 + 1002} = \\frac{1}{1001000 + 1002} = \\frac{1}{1002002}\n$$\n最后，我们计算缩减因子 $\\rho$，即缩放后反向误差与未缩放反向误差之比：\n$$\n\\rho = \\frac{\\eta_{\\mathrm{scaled}}}{\\eta_{\\mathrm{unscaled}}} = \\frac{1/1002002}{1/2003} = \\frac{2003}{1002002}\n$$\n为了得到最终的数值答案，我们计算此值并将其四舍五入到 $4$ 位有效数字：\n$$\n\\rho \\approx 0.001998994...\n$$\n四舍五入到 $4$ 位有效数字得到 $0.001999$。",
                "answer": "$$\\boxed{0.001999}$$",
                "id": "3559217"
            },
            {
                "introduction": "除了改善数值稳定性，矩阵缩放还可用于将矩阵变换为具有特定期望结构的形态，例如双随机矩阵。本练习将引导您应用 Sinkhorn-Knopp 缩放理论，通过分析一个非负矩阵的置换支持来确定缩放的存在性，并计算出相应的对角缩放矩阵。[@problem_id:3559220]",
                "problem": "考虑一个非负矩阵 $A \\in \\mathbb{R}^{n \\times n}$ 以及将其通过对角缩放转换为双随机形式的问题，该问题被称为 Sinkhorn-Knopp 缩放。如果一个矩阵 $B \\in \\mathbb{R}^{n \\times n}$ 的所有元素均为非负，并且其每行之和与每列之和均等于 $1$，则该矩阵被称为双随机矩阵。Sinkhorn-Knopp 缩放问题要求找到正对角矩阵 $D = \\mathrm{diag}(d_{1}, \\dots, d_{n})$ 和 $E = \\mathrm{diag}(e_{1}, \\dots, e_{n})$，使得 $B = D A E$ 是一个双随机矩阵。一个经过充分检验的事实是：如果 $A$ 具有全支撑（等价地，$A$ 的每个正元素都位于一个正置换上），则 Sinkhorn-Knopp 算法收敛，且存在这样的缩放；此外，如果 $A$ 是完全不可分解的（即其零元素模式不允许任何非平凡的分块三角形式），那么该缩放在一个公共正常数因子内是唯一的，这意味着如果 $D$ 和 $E$ 得到一个双随机缩放，那么对于任何 $t > 0$，$t D$ 和 $t^{-1} E$ 同样可以，并且所有解都以这种方式产生。\n\n使用以下具体矩阵进行计算\n$$\nA \\;=\\; \\begin{pmatrix}\n0  1  2 \\\\\n2  0  1 \\\\\n1  2  0\n\\end{pmatrix}.\n$$\n\n仅使用核心定义和上述普遍接受的事实，完成以下任务：\n- 通过在置换支撑层面上验证相应的结构性条件，判断给定的矩阵 $A$ 是否存在 Sinkhorn-Knopp 缩放。\n- 利用可从定义中导出的任何结构不变性，为 $A$ 计算一对显式的正对角缩放 $D$ 和 $E$，使得 $B = D A E$ 是一个双随机矩阵（不要引用未经证明的快捷公式）。\n- 分析此矩阵的缩放在一个正常数因子内的唯一性，并找出在变换 $(D,E) \\mapsto (t D, t^{-1} E)$ 下缩放的一个不变乘法量。\n\n将与您计算出的缩放相关的不变积 $\\det(D)\\,\\det(E)$ 的精确值作为您的最终答案。无需四舍五入。答案应表示为单个实数或单个无单位的闭式解析表达式。",
                "solution": "该问题经确认为科学上合理、适定且客观，属于矩阵分析的标准理论范畴。我们将给出完整解答。解答分为三个部分：首先，验证 Sinkhorn-Knopp 缩放的存在性；其次，计算一对显式的缩放矩阵；第三，分析缩放的唯一性并计算指定的不变量。\n\n**第一部分：缩放的存在性**\n\n问题指出，如果矩阵 $A$ 具有全支撑，则 Sinkhorn-Knopp 缩放存在。一个矩阵具有全支撑的条件是它的每个正元素都位于一个正置换上。对于一个 $n \\times n$ 矩阵 $A$，如果其对应元素的乘积 $\\prod_{i=1}^{n} a_{i, \\sigma(i)}$ 为正，则称 $\\{1, 2, \\dots, n\\}$ 的一个置换 $\\sigma$ 是正的。\n\n给定矩阵为 $A = \\begin{pmatrix} 0  1  2 \\\\ 2  0  1 \\\\ 1  2  0 \\end{pmatrix}$。这是一个 $3 \\times 3$ 矩阵，因此我们考察 $\\{1, 2, 3\\}$ 的 $3! = 6$ 个置换。令 $P_{\\sigma}$ 为对应于 $\\sigma$ 的置换矩阵。项 $\\prod_{i=1}^{3} a_{i, \\sigma(i)}$ 是 $A$ 的行列式的莱布尼茨公式中的一项。这些项是：\n\\begin{enumerate}\n    \\item $\\sigma = (1, 2, 3)$ (恒等置换): $a_{11}a_{22}a_{33} = 0 \\cdot 0 \\cdot 0 = 0$。不是正置换。\n    \\item $\\sigma = (1, 3, 2)$: $a_{11}a_{23}a_{32} = 0 \\cdot 1 \\cdot 2 = 0$。不是正置换。\n    \\item $\\sigma = (2, 1, 3)$: $a_{12}a_{21}a_{33} = 1 \\cdot 2 \\cdot 0 = 0$。不是正置换。\n    \\item $\\sigma = (2, 3, 1)$: $a_{12}a_{23}a_{31} = 1 \\cdot 1 \\cdot 1 = 1 > 0$。这是一个正置换。涉及的元素是 $\\{a_{12}, a_{23}, a_{31}\\}$。\n    \\item $\\sigma = (3, 1, 2)$: $a_{13}a_{21}a_{32} = 2 \\cdot 2 \\cdot 2 = 8 > 0$。这是一个正置换。涉及的元素是 $\\{a_{13}, a_{21}, a_{32}\\}$。\n    \\item $\\sigma = (3, 2, 1)$: $a_{13}a_{22}a_{31} = 2 \\cdot 0 \\cdot 1 = 0$。不是正置换。\n\\end{enumerate}\n有两个正置换。$A$ 中的正元素集合是 $\\{ a_{12}, a_{13}, a_{21}, a_{23}, a_{31}, a_{32} \\}$。我们检查每个正元素是否位于这两个正置换之一上：\n- $a_{12} = 1$：位于置换 $\\sigma=(2, 3, 1)$ 上。\n- $a_{13} = 2$：位于置换 $\\sigma=(3, 1, 2)$ 上。\n- $a_{21} = 2$：位于置换 $\\sigma=(3, 1, 2)$ 上。\n- $a_{23} = 1$：位于置换 $\\sigma=(2, 3, 1)$ 上。\n- $a_{31} = 1$：位于置换 $\\sigma=(2, 3, 1)$ 上。\n- $a_{32} = 2$：位于置换 $\\sigma=(3, 1, 2)$ 上。\n由于 $A$ 的每个正元素都位于一个正置换上，所以 $A$ 具有全支撑。因此，Sinkhorn-Knopp 缩放存在。\n\n**第二部分：计算缩放矩阵 $D$ 和 $E$**\n\n我们寻找正对角矩阵 $D = \\mathrm{diag}(d_1, d_2, d_3)$ 和 $E = \\mathrm{diag}(e_1, e_2, e_3)$，使得 $B = DAE$ 是双随机矩阵。矩阵 $B$ 的元素为 $b_{ij} = d_i a_{ij} e_j$。\n$$\nB = \\begin{pmatrix} d_1  0  0 \\\\ 0  d_2  0 \\\\ 0  0  d_3 \\end{pmatrix} \\begin{pmatrix} 0  1  2 \\\\ 2  0  1 \\\\ 1  2  0 \\end{pmatrix} \\begin{pmatrix} e_1  0  0 \\\\ 0  e_2  0 \\\\ 0  0  e_3 \\end{pmatrix} = \\begin{pmatrix} 0  d_1 e_2  2 d_1 e_3 \\\\ 2 d_2 e_1  0  d_2 e_3 \\\\ d_3 e_1  2 d_3 e_2  0 \\end{pmatrix}\n$$\n$B$ 是双随机矩阵的条件是其行和与列和均等于 $1$。\n行和：\n1. $d_1 e_2 + 2 d_1 e_3 = 1 \\implies d_1 (e_2 + 2 e_3) = 1$\n2. $2 d_2 e_1 + d_2 e_3 = 1 \\implies d_2 (2 e_1 + e_3) = 1$\n3. $d_3 e_1 + 2 d_3 e_2 = 1 \\implies d_3 (e_1 + 2 e_2) = 1$\n列和：\n4. $2 d_2 e_1 + d_3 e_1 = 1 \\implies e_1 (2 d_2 + d_3) = 1$\n5. $d_1 e_2 + 2 d_3 e_2 = 1 \\implies e_2 (d_1 + 2 d_3) = 1$\n6. $2 d_1 e_3 + d_2 e_3 = 1 \\implies e_3 (2 d_1 + d_2) = 1$\n\n由方程 (1) 和 (5) 可得 $d_1 (e_2 + 2 e_3) = e_2 (d_1 + 2 d_3)$，化简为 $d_1 e_2 + 2d_1 e_3 = d_1 e_2 + 2d_3 e_2$，所以 $d_1 e_3 = d_3 e_2$。\n由方程 (2) 和 (6) 可得 $d_2 (2 e_1 + e_3) = e_3 (2 d_1 + d_2)$，化简为 $2d_2 e_1 + d_2 e_3 = 2d_1 e_3 + d_2 e_3$，所以 $d_2 e_1 = d_1 e_3$。\n由方程 (3) 和 (4) 可得 $d_3 (e_1 + 2 e_2) = e_1 (2 d_2 + d_3)$，化简为 $d_3 e_1 + 2d_3 e_2 = 2d_2 e_1 + d_3 e_1$，所以 $d_3 e_2 = d_2 e_1$。\n综合这些关系，我们得到 $d_2 e_1 = d_3 e_2 = d_1 e_3$。设这个公共正值为 $k$。\n于是 $e_1 = k/d_2$，$e_2 = k/d_3$，$e_3 = k/d_1$。将这些代入方程 (1)、(2)、(3)：\n1. $d_1 (k/d_3 + 2 k/d_1) = 1 \\implies k d_1/d_3 + 2k = 1$\n2. $d_2 (2 k/d_2 + k/d_1) = 1 \\implies 2k + k d_2/d_1 = 1$\n3. $d_3 (k/d_2 + 2 k/d_3) = 1 \\implies k d_3/d_2 + 2k = 1$\n\n从 $k d_1/d_3 + 2k = 2k + k d_2/d_1$，我们得到 $d_1/d_3 = d_2/d_1 \\implies d_1^2 = d_2 d_3$。\n从 $2k + k d_2/d_1 = k d_3/d_2 + 2k$，我们得到 $d_2/d_1 = d_3/d_2 \\implies d_2^2 = d_1 d_3$。\n由于 $d_1, d_2, d_3 > 0$，我们可以将这些方程相除：$(d_1/d_2)^2 = (d_2 d_3)/(d_1 d_3) = d_2/d_1$。这得到 $(d_1/d_2)^3=1$，对于正实数，这意味着 $d_1/d_2=1$，所以 $d_1 = d_2$。将此代入 $d_2^2 = d_1 d_3$ 得到 $d_1^2 = d_1 d_3$，所以 $d_1 = d_3$。因此，$d_1 = d_2 = d_3 = d$，其中 $d>0$。\n从 $d_2 e_1 = d_3 e_2 = d_1 e_3$，我们得到 $d e_1 = d e_2 = d e_3$，这意味着 $e_1 = e_2 = e_3 = e$，其中 $e>0$。\n将 $d_i=d$ 和 $e_j=e$ 代入六个原始方程中的任意一个，例如方程(1)，得到 $d(e+2e) = 1$，即 $3de=1$。\n因此，任何解都必须具有 $D=dI$ 和 $E=eI$ 的形式，其中 $I$ 是 $3 \\times 3$ 单位矩阵，而 $d,e$ 是满足 $de = 1/3$ 的正常数。\n这与观察到 $A$ 的行和与列和均为常数 $3$ 是一致的。为了使 $B = deA$ 成为双随机矩阵，其行和与列和必须为 $1$，因此 $3de=1$。\n为得到一对显式解，我们可以选择 $d=e$。那么 $d^2 = 1/3 \\implies d = 1/\\sqrt{3}$。\n所以，一对可能的缩放矩阵是 $D = \\mathrm{diag}(1/\\sqrt{3}, 1/\\sqrt{3}, 1/\\sqrt{3})$ 和 $E = \\mathrm{diag}(1/\\sqrt{3}, 1/\\sqrt{3}, 1/\\sqrt{3})$。\n\n**第三部分：唯一性与不变量**\n\n问题指出，如果 $A$ 是完全不可分解的，则缩放在一个标量因子内是唯一的。一个矩阵如果非负且具有全支撑，则它是完全不可分解的。我们在第一部分验证了 $A$ 具有全支撑，因此它是完全不可分解的。\n唯一性性质意味着，如果 $(D, E)$ 是一对缩放矩阵，那么任何其他对 $(D', E')$ 都必须是 $(tD, t^{-1}E)$ 的形式，其中 $t>0$ 是某个标量。\n我们在第二部分的推导表明，所有解的形式均为 $D=dI, E=eI$ 且 $de=1/3$。这与所述的唯一性性质是一致的。设 $(D_0, E_0)$ 是一个解，例如 $D_0=I$ 和 $E_0=(1/3)I$。那么任何其他解都是 $(tD_0, t^{-1}E_0) = (tI, (1/3t)I)$。这符合 $(dI, eI)$ 的形式，其中 $d=t$ 且 $e=1/(3t)$，所以 $de = t \\cdot (1/(3t)) = 1/3$。\n\n我们被要求找出在变换 $(D, E) \\mapsto (tD, t^{-1}E)$ 下不变量 $\\det(D)\\det(E)$ 的值。\n令 $D' = tD$ 且 $E' = t^{-1}E$。\n一个缩放后的对角矩阵的行列式是 $\\det(tD) = \\det(\\mathrm{diag}(td_1, \\dots, td_n)) = (td_1)\\cdots(td_n) = t^n \\det(D)$。\n对于我们 $n=3$ 的情况：\n$\\det(D') = \\det(tD) = t^3 \\det(D)$。\n$\\det(E') = \\det(t^{-1}E) = (t^{-1})^3 \\det(E) = t^{-3} \\det(E)$。\n乘积为 $\\det(D')\\det(E') = (t^3 \\det(D))(t^{-3} \\det(E)) = t^3 t^{-3} \\det(D)\\det(E) = \\det(D)\\det(E)$。\n这证实了量 $\\det(D)\\det(E)$ 确实是一个不变量。\n\n为了计算它的值，我们可以使用任何一对有效的缩放。根据第二部分，任何有效的缩放都具有 $D=dI$ 和 $E=eI$ 的形式，且 $de = 1/3$。\n$\\det(D) = \\det(dI) = d^3$。\n$\\det(E) = \\det(eI) = e^3$。\n不变积为 $\\det(D)\\det(E) = d^3 e^3 = (de)^3$。\n由于 $de = 1/3$，该不变量的值为 $(1/3)^3$。\n$$\n\\det(D)\\det(E) = \\left(\\frac{1}{3}\\right)^3 = \\frac{1}{27}\n$$\n这个值与 $t$ 的具体选择无关，正如不变量所应具有的性质。",
                "answer": "$$\\boxed{\\frac{1}{27}}$$",
                "id": "3559220"
            },
            {
                "introduction": "在许多科学与工程应用中，矩阵具有必须在计算中保持的特殊代数结构（如辛结构或哈密顿结构）。本练习通过一个具体的反例，揭示了不加选择的对角缩放会如何破坏这些重要结构，并引导您推导出保持此类结构的缩放所必须满足的约束条件。[@problem_id:3559228]",
                "problem": "如果一个矩阵保持一个固定的非退化斜对称双线性形式不变，则称该矩阵为辛矩阵。在典范坐标中，该形式由标准辛矩阵 $J \\in \\mathbb{R}^{2n \\times 2n}$ 表示，对于 $n \\in \\mathbb{N}$ 定义为\n$$\nJ \\;=\\; \\begin{pmatrix}\n0  I_n \\\\\n- I_n  0\n\\end{pmatrix},\n$$\n其中 $I_n$ 是 $n \\times n$ 的单位矩阵。一个矩阵 $S \\in \\mathbb{R}^{2n \\times 2n}$ 是辛矩阵当且仅当 $S^{\\top} J S = J$。一个矩阵 $A \\in \\mathbb{R}^{2n \\times 2n}$ 是哈密顿矩阵当且仅当 $A^{\\top} J + J A = 0$。\n\n在矩阵平衡中，通常通过对角矩阵 $L$ 和 $R$ 进行左右缩放来平衡行和列。然而，除非此操作遵守由 $J$ 定义的双线性形式的不变性所产生的约束，否则它可能会破坏辛结构或哈密顿结构。\n\n考虑 $n = 1$ 的情况，此时 $J \\in \\mathbb{R}^{2 \\times 2}$ 为\n$$\nJ \\;=\\; \\begin{pmatrix}\n0  1 \\\\\n-1  0\n\\end{pmatrix}.\n$$\n令 $S = I_2$ 为 $2 \\times 2$ 的单位矩阵，它是一个辛矩阵。通过选择以下矩阵进行非对称的左右缩放\n$$\nL \\;=\\; \\operatorname{diag}(2, 1), \\qquad R \\;=\\; \\operatorname{diag}(1, 1),\n$$\n并构造 $B = L S R$。定义辛性缺陷\n$$\nE \\;=\\; B^{\\top} J B \\;-\\; J,\n$$\n并用弗罗贝尼乌斯范数 $\\|E\\|_F$ 来衡量其大小。\n\n任务：\n- 对于上述给定的 $L$、$R$、$S$ 和 $J$，计算 $\\|E\\|_F$ 的值。\n- 作为推导的一部分，从基本原理出发，证明为什么非对称的左右缩放会破坏辛结构或哈密顿结构，并解释对于一般的 $S$ 和 $A$，保持这种结构的对称缩放所需要满足的结构性约束。\n\n你的最终答案必须是 $\\|E\\|_F$ 的一个实数值或一个封闭形式的解析表达式。不需要四舍五入；请提供精确值。",
                "solution": "该问题既要求对矩阵缩放下辛结构和哈密顿结构的保持性进行概念性论证，又要求对“辛性缺陷”进行具体计算。我们将首先处理概念部分，然后进行计算。\n\n一个矩阵 $S \\in \\mathbb{R}^{2n \\times 2n}$ 如果保持由矩阵 $J$ 定义的典范辛形式不变，即 $S^{\\top} J S = J$，则该矩阵是辛矩阵。一个矩阵 $A \\in \\mathbb{R}^{2n \\times 2n}$ 如果其无穷小生成元性质成立，即满足条件 $A^{\\top} J + J A = 0$，则该矩阵是哈密顿矩阵。\n\n如问题所述，矩阵缩放（或平衡）涉及一个变换 $M \\to LMR$，其中 $L$ 和 $R$ 是对角矩阵。这是一个等价变换。\n\n首先，我们来分析为什么一般的非对称左右缩放（其中 $L \\neq R$）会破坏这些结构。辛性条件 $S^{\\top} J S = J$ 建立了一个矩阵 $S$ 与其转置 $S^{\\top}$ 之间的精确关系。当我们构造一个新矩阵 $B = LSR$ 时，其转置为 $B^{\\top} = (LSR)^{\\top} = R^{\\top} S^{\\top} L^{\\top}$。由于 $L$ 和 $R$ 是对角矩阵，这等于 $R S^{\\top} L$。检验 $B$ 的辛性就是看 $B^{\\top} J B = (R S^{\\top} L) J (LSR) = R S^{\\top} L J L S R$ 是否等于 $J$。不同的缩放矩阵 $L$ 和 $R$ 的存在（它们在转置项中位置互换）破坏了原有的结构。即使 $S^{\\top} J S = J$ 成立，也没有普遍的理由保证 $R S^{\\top} L J L S R = J$ 会成立。缩放操作与辛群的代数结构不可交换。\n\n接下来，考虑对称缩放，其中 $L=R=D$，且 $D$ 是一个对角矩阵。这种缩放将一个辛矩阵 $S$ 变换为 $B = DSD$。要使 $B$ 是辛矩阵，我们需要 $B^{\\top} J B = J$。让我们计算这一项：\n$$\nB^{\\top} J B = (DSD)^{\\top} J (DSD) = D^{\\top} S^{\\top} D^{\\top} J D S D\n$$\n由于 $D$ 是对角矩阵，所以 $D^{\\top} = D$。该表达式变为 $D S^{\\top} D J D S D$。将此与原始条件 $S^{\\top} J S = J$ 比较，我们看到内部的矩阵 $J$ 实际上被替换成了 $DJD$。如果对 $J$ 的这种缩放操作结果是 $J$ 的一个倍数，那么对于任意辛矩阵 $S$，该结构都将被保持。具体来说，假设对于某个标量 $c$，有 $DJD = cJ$。那么\n$$\nD S^{\\top} D J D S D = D S^{\\top} (cJ) S D = c D (S^{\\top} J S) D = c D J D = c(cJ) = c^2 J\n$$\n要使 $B$ 是辛矩阵，我们需要 $B^{\\top} J B = J$，这意味着 $c^2 J = J$，即 $c = \\pm 1$。在平衡中，缩放矩阵是正定的，所以我们关注 $c=1$ 的情况。对称对角缩放 $D$ 在变换 $S \\to DSD$ 下保持辛矩阵集合不变的约束是 $DJD = J$。由于 $D$ 是对角矩阵，这等价于 $D$ 本身是一个辛矩阵的条件（$D^{\\top}JD=J$）。\n如果我们将 $D$ 分块为 $n \\times n$ 的对角块 $D = \\operatorname{diag}(D_1, D_2)$，则条件 $DJD = J$ 变为\n$$\n\\begin{pmatrix} D_1  0 \\\\ 0  D_2 \\end{pmatrix} \\begin{pmatrix} 0  I_n \\\\ -I_n  0 \\end{pmatrix} \\begin{pmatrix} D_1  0 \\\\ 0  D_2 \\end{pmatrix} = \\begin{pmatrix} 0  D_1 D_2 \\\\ -D_2 D_1  0 \\end{pmatrix} = \\begin{pmatrix} 0  I_n \\\\ -I_n  0 \\end{pmatrix}\n$$\n这要求 $D_1 D_2 = I_n$，意味着 $D_2 = D_1^{-1}$。因此，为了通过映射 $S \\to DSD$ 保持辛性，对对称对角缩放矩阵 $D$ 的结构性约束是，对于某个 $n \\times n$ 的非奇异对角矩阵 $D_1$，$D$ 必须具有 $D = \\operatorname{diag}(D_1, D_1^{-1})$ 的形式。\n\n对于哈密顿矩阵 $A$，如果我们应用相同的缩放 $A \\to DAD$，得到的矩阵 $A' = DAD$ 通常不是哈密顿矩阵，即使 $D$ 是一个对角辛矩阵。对于哈密顿矩阵，保持结构的变换是相似变换 $A \\to D^{-1}AD$，其中 $D$ 是一个辛矩阵。\n\n现在，我们进行问题中要求的具体计算。对于 $n=1$ 的情况，给定条件如下：\n$$\nJ = \\begin{pmatrix} 0  1 \\\\ -1  0 \\end{pmatrix}, \\quad S = I_2 = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}\n$$\n缩放矩阵由下式给出：\n$$\nL = \\operatorname{diag}(2, 1) = \\begin{pmatrix} 2  0 \\\\ 0  1 \\end{pmatrix}, \\quad R = \\operatorname{diag}(1, 1) = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = I_2\n$$\n我们构造缩放后的矩阵 $B = LSR$：\n$$\nB = L S R = \\begin{pmatrix} 2  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 2  0 \\\\ 0  1 \\end{pmatrix} = L\n$$\n接下来，我们计算 $B^{\\top} J B$。由于 $B$ 是对角矩阵，所以 $B^{\\top} = B$。\n$$\nB^{\\top} J B = B J B = \\begin{pmatrix} 2  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 0  1 \\\\ -1  0 \\end{pmatrix} \\begin{pmatrix} 2  0 \\\\ 0  1 \\end{pmatrix}\n$$\n我们分步进行矩阵乘法：\n$$\n\\begin{pmatrix} 2  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 0  1 \\\\ -1  0 \\end{pmatrix} = \\begin{pmatrix} (2)(0) + (0)(-1)  (2)(1) + (0)(0) \\\\ (0)(0) + (1)(-1)  (0)(1) + (1)(0) \\end{pmatrix} = \\begin{pmatrix} 0  2 \\\\ -1  0 \\end{pmatrix}\n$$\n$$\nB^{\\top} J B = \\begin{pmatrix} 0  2 \\\\ -1  0 \\end{pmatrix} \\begin{pmatrix} 2  0 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} (0)(2) + (2)(0)  (0)(0) + (2)(1) \\\\ (-1)(2) + (0)(0)  (-1)(0) + (0)(1) \\end{pmatrix} = \\begin{pmatrix} 0  2 \\\\ -2  0 \\end{pmatrix}\n$$\n辛性缺陷定义为 $E = B^{\\top} J B - J$。\n$$\nE = \\begin{pmatrix} 0  2 \\\\ -2  0 \\end{pmatrix} - \\begin{pmatrix} 0  1 \\\\ -1  0 \\end{pmatrix} = \\begin{pmatrix} 0-0  2-1 \\\\ -2-(-1)  0-0 \\end{pmatrix} = \\begin{pmatrix} 0  1 \\\\ -1  0 \\end{pmatrix}\n$$\n有趣的是，缺陷矩阵 $E$ 等于 $J$。最后，我们计算其弗罗贝尼乌斯范数 $\\|E\\|_F$。一个元素为 $x_{ij}$ 的矩阵 $X$ 的弗罗贝尼乌斯范数定义为 $\\|X\\|_F = \\sqrt{\\sum_{i,j} |x_{ij}|^2}$。\n$$\n\\|E\\|_F = \\left\\| \\begin{pmatrix} 0  1 \\\\ -1  0 \\end{pmatrix} \\right\\|_F = \\sqrt{0^2 + 1^2 + (-1)^2 + 0^2} = \\sqrt{1 + 1} = \\sqrt{2}\n$$\n辛性缺陷的大小为 $\\sqrt{2}$。",
                "answer": "$$\\boxed{\\sqrt{2}}$$",
                "id": "3559228"
            }
        ]
    }