{
        "hands_on_practices": [
            {
                "introduction": "掌握任何数值算法的第一步是熟悉其执行过程。本练习提供了一个具体的 $3 \\times 3$ 矩阵，旨在通过手动计算来练习带部分主元分解的 LU 分解。通过此练习 [@problem_id:3507947]，你将实践如何识别主元、执行行交换，并正确构建置换矩阵 $P$、下三角矩阵 $L$ 和上三角矩阵 $U$，从而为理解更复杂的稳定性分析打下坚实基础。",
                "problem": "在计算天体物理学的辐射流体力学隐式时间积分中，由耦合的能量密度和辐射矩线性化产生的局部雅可比块，会形成一个虽小但非平凡的系统，该系统必须被稳健地求解。考虑矩阵\n$$\nA=\\begin{pmatrix}\n0  2  3 \\\\\n1  -1  0 \\\\\n2  0  1\n\\end{pmatrix}.\n$$\n为了在浮点运算中提高数值稳定性，请执行带部分主元法的LU分解（下三角-上三角分解）。这是一种高斯消元法过程，通过行置换来增强，即在每一列中选择绝对值最大的元素作为主元。构造记录行交换的置换矩阵 $P$、由乘数组成的单位下三角矩阵 $L$ 以及上三角矩阵 $U$，使得\n$$\nP\\,A = L\\,U.\n$$\n通过矩阵乘法显式地验证等式 $P\\,A=L\\,U$。最后，利用你的分解，将 $A$ 的行列式确定为一个实数值。最终答案请表示为一个精确值，无需四舍五入，也无需单位。最终答案必须仅为 $A$ 的行列式。",
                "solution": "该问题要求我们对一个给定的 $3 \\times 3$ 矩阵 $A$ 执行带部分主元法的LU分解（下三角-上三角分解），找出矩阵 $P$、$L$ 和 $U$，使得 $PA = LU$。然后，我们必须验证这个分解，并用它来计算 $A$ 的行列式。部分主元法是高斯消元法中采用的一种策略，通过选择当前列中绝对值最大的元素作为主元元素，来提高数值稳定性，从而最小化乘数的大小并控制舍入误差的传播。\n\n给定的矩阵是：\n$$\nA = \\begin{pmatrix}\n0  2  3 \\\\\n1  -1  0 \\\\\n2  0  1\n\\end{pmatrix}\n$$\n\n我们将逐步进行高斯消元，并在一个初始化为单位矩阵 $I$ 的置换矩阵 $P$ 中记录行置换。\n\n**第一步：对第一列进行消元**\n\n我们从 $A^{(0)} = A$ 和 $P^{(0)} = I$ 开始。\n$$\nA^{(0)} = \\begin{pmatrix}\n0  2  3 \\\\\n1  -1  0 \\\\\n2  0  1\n\\end{pmatrix}, \\quad P^{(0)} = \\begin{pmatrix}\n1  0  0 \\\\\n0  1  0 \\\\\n0  0  1\n\\end{pmatrix}\n$$\n对于第一列，我们检查对角线上及以下的元素：$|a_{11}| = 0$，$|a_{21}| = 1$，$|a_{31}| = 2$。最大绝对值是 $2$，位于第三行。因此，我们必须交换第1行和第3行。这个置换对应于左乘置换矩阵 $P_1$：\n$$\nP_1 = \\begin{pmatrix}\n0  0  1 \\\\\n0  1  0 \\\\\n1  0  0\n\\end{pmatrix}\n$$\n我们将此置换应用于 $A^{(0)}$ 和我们的累积置换矩阵 $P^{(0)}$：\n$$\nA' = P_1 A^{(0)} = \\begin{pmatrix}\n2  0  1 \\\\\n1  -1  0 \\\\\n0  2  3\n\\end{pmatrix}\n$$\n$$\nP^{(1)} = P_1 P^{(0)} = \\begin{pmatrix}\n0  0  1 \\\\\n0  1  0 \\\\\n1  0  0\n\\end{pmatrix}\n$$\n现在主元是 $a'_{11} = 2$。我们计算消除 $A'$ 第一列中次对角线元素所需的乘数：\n第2行的乘数：$m_{21} = \\frac{a'_{21}}{a'_{11}} = \\frac{1}{2}$。\n第3行的乘数：$m_{31} = \\frac{a'_{31}}{a'_{11}} = \\frac{0}{2} = 0$。\n\n我们执行行操作 $R_2 \\leftarrow R_2 - m_{21}R_1$ 和 $R_3 \\leftarrow R_3 - m_{31}R_1$：\n$R_2 \\leftarrow R_2 - \\frac{1}{2}R_1 \\Rightarrow [1, -1, 0] - \\frac{1}{2}[2, 0, 1] = [0, -1, -\\frac{1}{2}]$。\n$R_3 \\leftarrow R_3 - 0 \\cdot R_1 \\Rightarrow R_3$ 保持不变。\n\n第一阶段消元后的矩阵是：\n$$\nA^{(1)} = \\begin{pmatrix}\n2  0  1 \\\\\n0  -1  -\\frac{1}{2} \\\\\n0  2  3\n\\end{pmatrix}\n$$\n我们将存储乘数 $m_{21}$ 和 $m_{31}$，以便后续构造矩阵 $L$。\n\n**第二步：对第二列进行消元**\n\n现在我们考虑从第二行第二列开始的子矩阵。我们检查第二列中对角线上及以下的元素：$|a^{(1)}_{22}| = |-1| = 1$，$|a^{(1)}_{32}| = |2| = 2$。最大绝对值是 $2$，位于（当前矩阵的）第三行。我们必须交换第2行和第3行。这个置换对应于矩阵 $P_2$：\n$$\nP_2 = \\begin{pmatrix}\n1  0  0 \\\\\n0  0  1 \\\\\n0  1  0\n\\end{pmatrix}\n$$\n我们将此置换应用于 $A^{(1)}$ 并更新我们的累积置换矩阵 $P^{(1)}$：\n$$\nA'' = P_2 A^{(1)} = \\begin{pmatrix}\n2  0  1 \\\\\n0  2  3 \\\\\n0  -1  -\\frac{1}{2}\n\\end{pmatrix}\n$$\n$$\nP = P_2 P^{(1)} = \\begin{pmatrix}\n1  0  0 \\\\\n0  0  1 \\\\\n0  1  0\n\\end{pmatrix} \\begin{pmatrix}\n0  0  1 \\\\\n0  1  0 \\\\\n1  0  0\n\\end{pmatrix} = \\begin{pmatrix}\n0  0  1 \\\\\n1  0  0 \\\\\n0  1  0\n\\end{pmatrix}\n$$\n关键的是，这次行交换也适用于我们已经计算出的乘数。第一列的乘数是 $(m_{21}, m_{31}) = (\\frac{1}{2}, 0)$。交换它们的位置得到 $(\\tilde{m}_{21}, \\tilde{m}_{31}) = (0, \\frac{1}{2})$。\n\n现在主元是 $a''_{22} = 2$。我们计算第3行的乘数：\n$m_{32} = \\frac{a''_{32}}{a''_{22}} = \\frac{-1}{2}$。\n\n我们执行行操作 $R_3 \\leftarrow R_3 - m_{32}R_2$：\n$R_3 \\leftarrow R_3 - (-\\frac{1}{2})R_2 \\Rightarrow [0, -1, -\\frac{1}{2}] + \\frac{1}{2}[0, 2, 3] = [0, 0, -\\frac{1}{2} + \\frac{3}{2}] = [0, 0, 1]$。\n\n最终的上三角矩阵 $U$ 是：\n$$\nU = \\begin{pmatrix}\n2  0  1 \\\\\n0  2  3 \\\\\n0  0  1\n\\end{pmatrix}\n$$\n单位下三角矩阵 $L$ 是由乘数构造的，这些乘数被放置在所有置换操作完成后的最终位置上。\n$L_{21} = \\tilde{m}_{21} = 0$。\n$L_{31} = \\tilde{m}_{31} = \\frac{1}{2}$。\n$L_{32} = m_{32} = -\\frac{1}{2}$。\n$$\nL = \\begin{pmatrix}\n1  0  0 \\\\\n0  1  0 \\\\\n\\frac{1}{2}  -\\frac{1}{2}  1\n\\end{pmatrix}\n$$\n最终的置换矩阵是 $P = \\begin{pmatrix}\n0  0  1 \\\\\n1  0  0 \\\\\n0  1  0\n\\end{pmatrix}$。\n\n**分解总结：**\n$$\nP = \\begin{pmatrix}\n0  0  1 \\\\\n1  0  0 \\\\\n0  1  0\n\\end{pmatrix}, \\quad\nL = \\begin{pmatrix}\n1  0  0 \\\\\n0  1  0 \\\\\n\\frac{1}{2}  -\\frac{1}{2}  1\n\\end{pmatrix}, \\quad\nU = \\begin{pmatrix}\n2  0  1 \\\\\n0  2  3 \\\\\n0  0  1\n\\end{pmatrix}\n$$\n**验证**\n\n我们必须显式地验证 $PA = LU$。首先，我们计算 $PA$：\n$$\nPA = \\begin{pmatrix}\n0  0  1 \\\\\n1  0  0 \\\\\n0  1  0\n\\end{pmatrix}\n\\begin{pmatrix}\n0  2  3 \\\\\n1  -1  0 \\\\\n2  0  1\n\\end{pmatrix}\n= \\begin{pmatrix}\n2  0  1 \\\\\n0  2  3 \\\\\n1  -1  0\n\\end{pmatrix}\n$$\n接着，我们计算 $LU$：\n$$\nLU = \\begin{pmatrix}\n1  0  0 \\\\\n0  1  0 \\\\\n\\frac{1}{2}  -\\frac{1}{2}  1\n\\end{pmatrix}\n\\begin{pmatrix}\n2  0  1 \\\\\n0  2  3 \\\\\n0  0  1\n\\end{pmatrix}\n= \\begin{pmatrix}\n1 \\cdot 2 + 0 \\cdot 0 + 0 \\cdot 0   1 \\cdot 0 + 0 \\cdot 2 + 0 \\cdot 0   1 \\cdot 1 + 0 \\cdot 3 + 0 \\cdot 1 \\\\\n0 \\cdot 2 + 1 \\cdot 0 + 0 \\cdot 0   0 \\cdot 0 + 1 \\cdot 2 + 0 \\cdot 0   0 \\cdot 1 + 1 \\cdot 3 + 0 \\cdot 1 \\\\\n\\frac{1}{2} \\cdot 2 - \\frac{1}{2} \\cdot 0 + 1 \\cdot 0   \\frac{1}{2} \\cdot 0 - \\frac{1}{2} \\cdot 2 + 1 \\cdot 0   \\frac{1}{2} \\cdot 1 - \\frac{1}{2} \\cdot 3 + 1 \\cdot 1\n\\end{pmatrix}\n$$\n$$\nLU = \\begin{pmatrix}\n2  0  1 \\\\\n0  2  3 \\\\\n1  -1  \\frac{1}{2} - \\frac{3}{2} + 1\n\\end{pmatrix}\n= \\begin{pmatrix}\n2  0  1 \\\\\n0  2  3 \\\\\n1  -1  0\n\\end{pmatrix}\n$$\n等式 $PA = LU$ 得到验证。\n\n**行列式计算**\n\n根据分解 $PA = LU$，我们可以写出 $\\det(PA) = \\det(LU)$。\n利用行列式的乘法性质，这可以写成 $\\det(P)\\det(A) = \\det(L)\\det(U)$。\n因此，$\\det(A) = \\frac{\\det(L)\\det(U)}{\\det(P)}$。\n\n我们计算每个矩阵的行列式：\n1. $\\det(L)$: 因为 $L$ 是一个单位下三角矩阵，其行列式是其对角线元素的乘积。$\\det(L) = 1 \\cdot 1 \\cdot 1 = 1$。\n2. $\\det(U)$: 因为 $U$ 是一个上三角矩阵，其行列式也是其对角线元素的乘积。$\\det(U) = 2 \\cdot 2 \\cdot 1 = 4$。\n3. $\\det(P)$: 置换矩阵的行列式是 $(-1)^s$，其中 $s$ 是执行的行交换次数。我们执行了两次交换：$(R_1 \\leftrightarrow R_3)$ 然后 $(R_2 \\leftrightarrow R_3)$。因此，$s=2$。\n    $\\det(P) = (-1)^2 = 1$。\n\n将这些值代入 $\\det(A)$ 的方程中：\n$$\n\\det(A) = \\frac{1 \\cdot 4}{1} = 4\n$$\n矩阵 $A$ 的行列式是 $4$。这证实了我们最初的判断，即该矩阵是非奇异的，并且LU分解是良定义的。",
                "answer": "$$\\boxed{4}$$",
                "id": "3507947"
            },
            {
                "introduction": "在掌握了部分主元法的基本操作后，理解其背后的动机——控制元素增长——至关重要。本练习引入了“增长因子”这一核心概念，它是衡量高斯消元法数值稳定性的关键指标。通过分析一个特殊构造的矩阵 [@problem_id:3564374]，你将亲眼观察到在消元过程中元素幅值如何逐步增大，并学会量化这一增长过程。",
                "problem": "考虑给定矩阵 $A \\in \\mathbb{R}^{5 \\times 5}$\n$$\nA \\;=\\;\n\\begin{pmatrix}\n1  0  0  0  1 \\\\\n-1  1  0  0  1 \\\\\n0  -1  1  0  1 \\\\\n0  0  -1  1  1 \\\\\n0  0  0  -1  1\n\\end{pmatrix}.\n$$\n应用部分主元高斯消元法 (GEPP)，其中每一步的主元选择为当前列中尚未被消元的行里绝对值最大的元素，并相应地进行行交换。令 $U$ 表示 GEPP 生成的上三角因子，使得对于某个置换矩阵 $P$ 和单位下三角矩阵 $L$，有 $P A = L U$。使用高斯消元法和部分主元法的基本定义，追踪消元过程中 $U$ 的元素演变，并明确指出哪些元素的量值相对于 $A$ 中的元素增大了。然后计算增长因子\n$$\n\\rho(A) \\;=\\; \\frac{\\displaystyle \\max_{1 \\leq i,j \\leq 5} |u_{ij}|}{\\displaystyle \\max_{1 \\leq i,j \\leq 5} |a_{ij}|}.\n$$\n将 $\\rho(A)$ 的最终答案表示为精确值。不需要四舍五入。",
                "solution": "问题是对给定的 $5 \\times 5$ 矩阵 $A$ 执行部分主元高斯消元法 (GEPP) 以找到其 LU 分解 $PA=LU$，然后计算增长因子 $\\rho(A)$。\n\n给定的矩阵是\n$$\nA \\;=\\; A^{(1)} \\;=\\;\n\\begin{pmatrix}\n1  0  0  0  1 \\\\\n-1  1  0  0  1 \\\\\n0  -1  1  0  1 \\\\\n0  0  -1  1  1 \\\\\n0  0  0  -1  1\n\\end{pmatrix}.\n$$\n矩阵 $A$ 中元素的最大绝对值为 $\\displaystyle \\max_{1 \\leq i,j \\leq 5} |a_{ij}| = 1$。\n\n我们将逐步进行消元。令 $A^{(k)}$ 为第 $k$ 步开始时的矩阵。\n\n第 1 步：对第 1 列进行消元。\n$A^{(1)}$ 的第一列是 $(1, -1, 0, 0, 0)^T$。主元的候选元素是此列中的元素。最大绝对值为 $1$，在 $a_{11}^{(1)}=1$ 和 $a_{21}^{(1)}=-1$ 处取得。在出现相同值的情况下，标准的部分主元策略选择行索引最小的元素。因此，主元是 $a_{11}^{(1)}=1$。不需要行交换。\n唯一的非零乘数是针对第二行的：\n$$\nl_{21} = \\frac{a_{21}^{(1)}}{a_{11}^{(1)}} = \\frac{-1}{1} = -1.\n$$\n第二行更新为：$R_2 \\leftarrow R_2 - l_{21} R_1 = R_2 + R_1$。\n$$\n(-1, 1, 0, 0, 1) + (1, 0, 0, 0, 1) = (0, 1, 0, 0, 2).\n$$\n第 1 步后的矩阵是：\n$$\nA^{(2)} \\;=\\;\n\\begin{pmatrix}\n1  0  0  0  1 \\\\\n0  1  0  0  2 \\\\\n0  -1  1  0  1 \\\\\n0  0  -1  1  1 \\\\\n0  0  0  -1  1\n\\end{pmatrix}.\n$$\n在此阶段，我们观察到元素 $a_{25}^{(2)}=2$ 的量值大于原始矩阵 $A$ 中任何元素的最大量值。\n\n第 2 步：对第 2 列进行消元。\n我们考虑从第 2 行到第 5 行的子矩阵。该子矩阵的第二列是 $(1, -1, 0, 0)^T$。最大绝对值为 $1$，在 $a_{22}^{(2)}=1$ 和 $a_{32}^{(2)}=-1$ 处取得。我们选择 $a_{22}^{(2)}=1$ 作为主元（行索引最小）。不需要行交换。\n唯一的非零乘数是针对第三行的：\n$$\nl_{32} = \\frac{a_{32}^{(2)}}{a_{22}^{(2)}} = \\frac{-1}{1} = -1.\n$$\n第三行更新为：$R_3 \\leftarrow R_3 - l_{32} R_2 = R_3 + R_2$。\n$$\n(0, -1, 1, 0, 1) + (0, 1, 0, 0, 2) = (0, 0, 1, 0, 3).\n$$\n第 2 步后的矩阵是：\n$$\nA^{(3)} \\;=\\;\n\\begin{pmatrix}\n1  0  0  0  1 \\\\\n0  1  0  0  2 \\\\\n0  0  1  0  3 \\\\\n0  0  -1  1  1 \\\\\n0  0  0  -1  1\n\\end{pmatrix}.\n$$\n元素 $a_{35}^{(3)}=3$ 的量值进一步增长。\n\n第 3 步：对第 3 列进行消元。\n主元候选者位于第 3 列从第 3 行开始的位置：$(1, -1, 0)^T$。最大绝对值为 $1$，对应于 $a_{33}^{(3)}=1$ 和 $a_{43}^{(3)}=-1$。我们选择主元 $a_{33}^{(3)}=1$。不需要行交换。\n第四行的乘数是：\n$$\nl_{43} = \\frac{a_{43}^{(3)}}{a_{33}^{(3)}} = \\frac{-1}{1} = -1.\n$$\n第四行更新为：$R_4 \\leftarrow R_4 - l_{43} R_3 = R_4 + R_3$。\n$$\n(0, 0, -1, 1, 1) + (0, 0, 1, 0, 3) = (0, 0, 0, 1, 4).\n$$\n第 3 步后的矩阵是：\n$$\nA^{(4)} \\;=\\;\n\\begin{pmatrix}\n1  0  0  0  1 \\\\\n0  1  0  0  2 \\\\\n0  0  1  0  3 \\\\\n0  0  0  1  4 \\\\\n0  0  0  -1  1\n\\end{pmatrix}.\n$$\n元素 $a_{45}^{(4)}=4$ 的量值持续增长。\n\n第 4 步：对第 4 列进行消元。\n主元候选者位于第 4 列从第 4 行开始的位置：$(1, -1)^T$。最大绝对值为 $1$，对应于 $a_{44}^{(4)}=1$ 和 $a_{54}^{(4)}=-1$。我们选择主元 $a_{44}^{(4)}=1$。不需要行交换。\n第五行的乘数是：\n$$\nl_{54} = \\frac{a_{54}^{(4)}}{a_{44}^{(4)}} = \\frac{-1}{1} = -1.\n$$\n第五行更新为：$R_5 \\leftarrow R_5 - l_{54} R_4 = R_5 + R_4$。\n$$\n(0, 0, 0, -1, 1) + (0, 0, 0, 1, 4) = (0, 0, 0, 0, 5).\n$$\n第 4 步后的矩阵是最终的上三角矩阵 $U$：\n$$\nU \\;=\\; A^{(5)} \\;=\\;\n\\begin{pmatrix}\n1  0  0  0  1 \\\\\n0  1  0  0  2 \\\\\n0  0  1  0  3 \\\\\n0  0  0  1  4 \\\\\n0  0  0  0  5\n\\end{pmatrix}.\n$$\n元素 $u_{55}=a_{55}^{(5)}=5$ 是量值最大的元素。\n\n最后一列中元素的演变展示了增长。初始的最后一列向量是 $(1, 1, 1, 1, 1)^T$。通过消元过程，这些元素变成了 $U$ 的最后一列，即 $(1, 2, 3, 4, 5)^T$。$u_{25}$、$u_{35}$、$u_{45}$ 和 $u_{55}$ 的量值都大于 $A$ 中元素的最大量值。\n\n现在，我们计算增长因子 $\\rho(A)$。其定义为：\n$$\n\\rho(A) \\;=\\; \\frac{\\displaystyle \\max_{1 \\leq i,j \\leq 5} |u_{ij}|}{\\displaystyle \\max_{1 \\leq i,j \\leq 5} |a_{ij}|}.\n$$\n从矩阵 $U$ 中，其元素的最大绝对值为：\n$$\n\\max_{1 \\leq i,j \\leq 5} |u_{ij}| = |u_{55}| = 5.\n$$\n从原始矩阵 $A$ 中，其元素的最大绝对值为：\n$$\n\\max_{1 \\leq i,j \\leq 5} |a_{ij}| = 1.\n$$\n因此，增长因子为：\n$$\n\\rho(A) = \\frac{5}{1} = 5.\n$$",
                "answer": "$$\n\\boxed{5}\n$$",
                "id": "3564374"
            },
            {
                "introduction": "部分主元法是控制误差增长的有效策略，但并非唯一选择。本练习将介绍一种更为稳健但计算成本更高的策略：完全主元法。通过对同一个矩阵 [@problem_id:3564346] 分别应用部分主元法和完全主元法，并计算各自的增长因子，你将能直观地比较两种策略的优劣，从而更深刻地理解在不同主元选择方案中计算成本与数值稳定性之间的权衡。",
                "problem": "考虑下列矩阵 $A \\in \\mathbb{R}^{4 \\times 4}$：\n$$\nA \\;=\\;\n\\begin{bmatrix}\n1  0  0  1 \\\\\n-1  1  0  1 \\\\\n0  -1  1  1 \\\\\n0  0  -1  1\n\\end{bmatrix}.\n$$\n在整个过程中，将高斯消去法理解为一种标准算法，该算法对首主子块执行连续的舒尔补运算，并可在每个舒尔补步骤之前根据选主元规则自由地对行和/或列进行置换。\n\n对于给定的选主策略 $\\mathcal{P}$，我们将增长因子 $\\rho(A,\\mathcal{P})$ 定义为\n$$\n\\rho(A,\\mathcal{P}) \\;=\\; \\frac{\\displaystyle \\max_{k} \\max_{i,j} \\left| a_{ij}^{(k)} \\right|}{\\displaystyle \\max_{i,j} \\left| a_{ij}^{(0)} \\right|},\n$$\n其中 $a_{ij}^{(0)}$ 是初始矩阵 $A$ 的元素，而 $a_{ij}^{(k)}$ 是（在采用所选主元策略下）经过第 $k$ 步消去后的矩阵的元素。分子是消去过程中任何中间阶段（包括任何行/列置换后）出现的所有元素绝对值的最大值；分母是初始矩阵 $A$ 中所有元素绝对值的最大值。\n\n考虑两种选主策略：\n- 部分选主元的高斯消去法 (GEPP)：在第 $k$ 步，通过行置换，将第 $k$ 列（行 $k,k+1,\\ldots$ 中）绝对值最大的元素置于 $(k,k)$ 位置。若有多个最大值，则选择行索引最小者。\n- 完全选主元的高斯消去法 (GECP)：在第 $k$ 步，通过行和列置换，将余子矩阵（行和列从 $k, k+1, \\ldots$ 开始）中绝对值最大的元素置于 $(k,k)$ 位置。若有多个最大值，则选择行索引最小，然后列索引最小者。\n\n仅根据上述高斯消去法、部分选主、完全选主和增长因子的定义，计算给定矩阵 $A$ 的两个增长因子 $\\rho(A,\\text{GEPP})$ 和 $\\rho(A,\\text{GECP})$。最终答案必须是写成单行矩阵的一对数值。无需四舍五入，也不涉及单位。",
                "solution": "问题要求计算在部分选主元的高斯消去法 (GEPP) 和完全选主元的高斯消去法 (GECP) 下，给定 $4 \\times 4$ 矩阵 $A$ 的增长因子。\n\n给定的矩阵是：\n$$\nA = A^{(0)} =\n\\begin{bmatrix}\n1  0  0  1 \\\\\n-1  1  0  1 \\\\\n0  -1  1  1 \\\\\n0  0  -1  1\n\\end{bmatrix}\n$$\n增长因子定义为 $\\rho(A,\\mathcal{P}) = \\frac{\\displaystyle \\max_{k,i,j} \\left| a_{ij}^{(k)} \\right|}{\\displaystyle \\max_{i,j} \\left| a_{ij}^{(0)} \\right|}$，其中分子是在任何中间矩阵中出现的任何元素的最大绝对值，分母是初始矩阵中任何元素的最大绝对值。\n\n首先，我们确定分母。$A^{(0)}$ 的元素来自集合 $\\{1, 0, -1\\}$。这些元素的最大绝对值是：\n$$\n\\max_{i,j} |a_{ij}^{(0)}| = 1\n$$\n因此，对于任何选主策略 $\\mathcal{P}$ 的增长因子简化为：\n$$\n\\rho(A,\\mathcal{P}) = \\max_{k,i,j} |a_{ij}^{(k)}|\n$$\n这是消去过程中（包括初始矩阵和所有中间矩阵）遇到的任何元素的最大幅值。我们将跟踪这个最大值，记为 $M$，并初始化为 $M=1$。\n\n### 部分选主元的高斯消去法 (GEPP)\n\n**步骤 $k=1$：**\n我们检查 $A^{(0)}$ 的第一列：$[1, -1, 0, 0]^T$。最大绝对值为 $1$，出现在第 1 行和第 2 行。GEPP 的平局决胜规则选择索引最小的行，因此我们选择 $a_{11}^{(0)}=1$ 作为主元。不需要行置换。\n乘数为 $m_{21} = \\frac{-1}{1} = -1$，$m_{31}=0$ 和 $m_{41}=0$。消去步骤是更新第 2 行：$R_2 \\to R_2 - m_{21} R_1 = R_2 + R_1$。\n$R_2' = [-1, 1, 0, 1] + [1, 0, 0, 1] = [0, 1, 0, 2]$。\n第 1 步后的矩阵是：\n$$\nA^{(1)} = \\begin{bmatrix}\n1  0  0  1 \\\\\n0  1  0  2 \\\\\n0  -1  1  1 \\\\\n0  0  -1  1\n\\end{bmatrix}\n$$\n$A^{(1)}$ 的元素中包含一个新值 2。到目前为止所见的最大绝对值为 $M = \\max(1, |2|) = 2$。\n\n**步骤 $k=2$：**\n我们在第二列中从第 2 行向下搜索主元：$[1, -1, 0]^T$。最大绝对值为 $1$，出现在第 2 行和第 3 行。平局决胜规则选择第 2 行，所以主元是 $a_{22}^{(1)}=1$。无需行置换。\n乘数为 $m_{32} = \\frac{-1}{1} = -1$ 和 $m_{42}=0$。消去步骤是 $R_3 \\to R_3 - m_{32} R_2 = R_3 + R_2$。\n$R_3' = [0, -1, 1, 1] + [0, 1, 0, 2] = [0, 0, 1, 3]$。\n第 2 步后的矩阵是：\n$$\nA^{(2)} = \\begin{bmatrix}\n1  0  0  1 \\\\\n0  1  0  2 \\\\\n0  0  1  3 \\\\\n0  0  -1  1\n\\end{bmatrix}\n$$\n新出现的元素是 3。当前的最大绝对值现在是 $M = \\max(2, |3|) = 3$。\n\n**步骤 $k=3$：**\n我们在第三列中从第 3 行向下搜索主元：$[1, -1]^T$。最大绝对值为 $1$，出现在第 3 行和第 4 行。平局决胜规则选择第 3 行，所以主元是 $a_{33}^{(2)}=1$。无需行置换。\n乘数是 $m_{43} = \\frac{-1}{1} = -1$。消去步骤是 $R_4 \\to R_4 - m_{43}R_3 = R_4 + R_3$。\n$R_4' = [0, 0, -1, 1] + [0, 0, 1, 3] = [0, 0, 0, 4]$。\n最终的上三角矩阵是：\n$$\nA^{(3)} = U = \\begin{bmatrix}\n1  0  0  1 \\\\\n0  1  0  2 \\\\\n0  0  1  3 \\\\\n0  0  0  4\n\\end{bmatrix}\n$$\n新出现的元素是 4。当前的最大绝对值变为 $M = \\max(3, |4|) = 4$。\n\n在所有矩阵 $A^{(0)}, A^{(1)}, A^{(2)}, A^{(3)}$ 中，最大的绝对值是 4。\n因此，GEPP 的增长因子为 $\\rho(A,\\text{GEPP}) = 4$。\n\n### 完全选主元的高斯消去法 (GECP)\n\n**步骤 $k=1$：**\n我们在整个矩阵 $A^{(0)}$ 中搜索绝对值最大的元素。最大绝对值为 1，存在多个这样的元素。GECP 的平局决胜规则是选择行索引最小，然后列索引最小的那个。这对应于 $a_{11}^{(0)}=1$。所以，主元是 $1$。不需要进行置换。\n这一步与 GEPP 相同。第 1 步后的矩阵是：\n$$\nA^{(1)} = \\begin{bmatrix}\n1  0  0  1 \\\\\n0  1  0  2 \\\\\n0  -1  1  1 \\\\\n0  0  -1  1\n\\end{bmatrix}\n$$\n遇到的最大绝对值是 $M = 2$。\n\n**步骤 $k=2$：**\n我们在余子矩阵 $A^{(1)}_{2:4, 2:4}$ 中搜索主元：\n$$\nS_2 = \\begin{bmatrix} 1  0  2 \\\\ -1  1  1 \\\\ 0  -1  1 \\end{bmatrix}\n$$\n$S_2$ 中绝对值最大的元素是 2，在完整矩阵 $A^{(1)}$ 中位于位置 $(2,4)$。我们必须将此元素移动到主元位置 $(2,2)$。这需要交换第 2 列和第 4 列。由于该元素已在最小行索引（第 2 行），因此无需行交换。我们将置换后的矩阵记为 $\\tilde{A}^{(1)}$：\n$$\n\\tilde{A}^{(1)} = \\begin{bmatrix}\n1  1  0  0 \\\\\n0  2  0  1 \\\\\n0  1  1  -1 \\\\\n0  1  -1  0\n\\end{bmatrix}\n$$\n此矩阵中的最大绝对值仍然是 2。主元是 $p_2 = 2$。\n乘数是 $m_{32} = \\frac{1}{2}$ 和 $m_{42} = \\frac{1}{2}$。\n$R_3 \\to R_3 - \\frac{1}{2}R_2$：$[0, 1, 1, -1] - \\frac{1}{2}[0, 2, 0, 1] = [0, 0, 1, -3/2]$。\n$R_4 \\to R_4 - \\frac{1}{2}R_2$：$[0, 1, -1, 0] - \\frac{1}{2}[0, 2, 0, 1] = [0, 0, -1, -1/2]$。\n第 2 步后的矩阵是：\n$$\nA^{(2)} = \\begin{bmatrix}\n1  1  0  0 \\\\\n0  2  0  1 \\\\\n0  0  1  -3/2 \\\\\n0  0  -1  -1/2\n\\end{bmatrix}\n$$\n新元素的幅值为 $|1|, |-3/2|=1.5, |-1|=1, |-1/2|=0.5$。到目前为止所见的所有元素的最大幅值仍然是 $M=2$。\n\n**步骤 $k=3$：**\n我们搜索子矩阵 $A^{(2)}_{3:4, 3:4}$：\n$$\nS_3 = \\begin{bmatrix} 1  -3/2 \\\\ -1  -1/2 \\end{bmatrix}\n$$\n最大绝对值是 $|-3/2| = 1.5$，位于 $A^{(2)}$ 的 $(3,4)$ 位置。该元素成为主元。我们交换第 3 列和第 4 列，将其移至 $(3,3)$ 位置。\n置换后的矩阵是：\n$$\n\\tilde{A}^{(2)} = \\begin{bmatrix}\n1  1  0  0 \\\\\n0  2  1  0 \\\\\n0  0  -3/2  1 \\\\\n0  0  -1/2  -1\n\\end{bmatrix}\n$$\n此矩阵中的最大绝对值仍然是 2。主元是 $p_3 = -3/2$。\n乘数是 $m_{43} = \\frac{-1/2}{-3/2} = 1/3$。\n$R_4 \\to R_4 - \\frac{1}{3}R_3$：$[0, 0, -1/2, -1] - \\frac{1}{3}[0, 0, -3/2, 1] = [0, 0, 0, -4/3]$。\n最终的矩阵是：\n$$\nA^{(3)} = U = \\begin{bmatrix}\n1  1  0  0 \\\\\n0  2  1  0 \\\\\n0  0  -3/2  1 \\\\\n0  0  0  -4/3\n\\end{bmatrix}\n$$\n新元素是 $-4/3$。其绝对值约为 1.33。$A^{(3)}$ 中的最大绝对值是 2。\n在 GECP 过程中遇到的所有矩阵集合为 $A^{(0)}, A^{(1)}, \\tilde{A}^{(1)}, A^{(2)}, \\tilde{A}^{(2)}, A^{(3)}$。所有这些矩阵的所有元素的最大绝对值是 2。\n因此，GECP 的增长因子是 $\\rho(A,\\text{GECP}) = 2$。\n\n计算出的两个增长因子是 $\\rho(A,\\text{GEPP}) = 4$ 和 $\\rho(A,\\text{GECP}) = 2$。",
                "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n4  2\n\\end{pmatrix}\n}\n$$",
                "id": "3564346"
            }
        ]
    }