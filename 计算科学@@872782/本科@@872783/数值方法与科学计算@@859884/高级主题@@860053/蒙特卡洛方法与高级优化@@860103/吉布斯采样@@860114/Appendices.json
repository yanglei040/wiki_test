{"hands_on_practices": [{"introduction": "吉布斯采样的核心在于从条件分布中进行迭代采样。第一个练习旨在解决一个基本前提：如何从一个给定的联合概率分布中推导出这些条件分布。我们将通过一个在统计物理和机器学习中常见的基于能量的模型，来学习当其他变量保持不变时，如何计算单个变量的条件概率[@problem_id:1363738]。", "problem": "考虑一个简化的概率模型，该模型用于一个具有两个相互作用组件的系统，这两个组件由二元随机变量 $X$ 和 $Y$ 表示。每个变量都可以在集合 $\\{0, 1\\}$ 中取值。该系统的联合概率质量函数由一个基于能量的模型描述，这在统计物理和机器学习中很常见：\n$$P(X=x, Y=y) = \\frac{1}{Z} \\exp\\left(\\alpha xy + \\beta(x+y)\\right)$$\n在这个模型中，$\\alpha$ 和 $\\beta$ 是正实值参数，分别代表组件之间相互作用的强度和外部场的影响。项 $Z$ 是归一化常数，也称为配分函数，它是 $\\exp\\left(\\alpha xy + \\beta(x+y)\\right)$ 对所有可能状态 $(x, y)$ 的总和，以确保所有概率之和为一。\n\nGibbs 采样是一种通过从其条件分布中迭代采样来从此类分布中抽取样本的算法。这个过程中的一个关键步骤是能够计算这些条件概率。\n\n您的任务是推导在组件 $Y$ 处于状态 $y$ 的条件下，组件 $X$ 处于状态 1 的条件概率表达式。推导 $P(X=1 | Y=y)$ 的封闭形式表达式，其中 $y \\in \\{0, 1\\}$。该表达式应以参数 $\\alpha$、$\\beta$ 和变量 $y$ 的形式给出。", "solution": "给定联合分布\n$$P(X=x, Y=y) = \\frac{1}{Z} \\exp\\left(\\alpha x y + \\beta(x+y)\\right),$$\n其中 $x,y \\in \\{0,1\\}$。条件概率 $P(X=1 \\mid Y=y)$ 定义为\n$$P(X=1 \\mid Y=y) = \\frac{P(X=1, Y=y)}{\\sum_{x \\in \\{0,1\\}} P(X=x, Y=y)}.$$\n代入给定的联合质量函数，并注意到归一化常数 $Z$ 在分子和分母之间被约掉，我们得到\n$$P(X=1 \\mid Y=y) = \\frac{\\exp\\left(\\alpha \\cdot 1 \\cdot y + \\beta(1+y)\\right)}{\\exp\\left(\\alpha \\cdot 1 \\cdot y + \\beta(1+y)\\right) + \\exp\\left(\\alpha \\cdot 0 \\cdot y + \\beta(0+y)\\right)}.$$\n计算每个指数项：\n- 分子：$\\exp\\left(\\alpha y + \\beta + \\beta y\\right)$。\n- 分母项：$\\exp\\left(\\alpha y + \\beta + \\beta y\\right)$ 和 $\\exp\\left(\\beta y\\right)$。\n因此，\n$$P(X=1 \\mid Y=y) = \\frac{\\exp\\left(\\alpha y + \\beta + \\beta y\\right)}{\\exp\\left(\\alpha y + \\beta + \\beta y\\right) + \\exp\\left(\\beta y\\right)}.$$\n从分子和分母中提出因子 $\\exp(\\beta y)$：\n$$P(X=1 \\mid Y=y) = \\frac{\\exp(\\beta y)\\exp\\left(\\alpha y + \\beta\\right)}{\\exp(\\beta y)\\left[\\exp\\left(\\alpha y + \\beta\\right) + 1\\right]}.$$\n约去公因式 $\\exp(\\beta y)$ 得到\n$$P(X=1 \\mid Y=y) = \\frac{\\exp\\left(\\alpha y + \\beta\\right)}{1 + \\exp\\left(\\alpha y + \\beta\\right)} = \\frac{1}{1 + \\exp\\left(-\\alpha y - \\beta\\right)}.$$\n这就得到了关于 $\\alpha$、$\\beta$ 和 $y \\in \\{0,1\\}$ 的所求封闭形式表达式。", "answer": "$$\\boxed{\\frac{1}{1+\\exp\\left(-\\alpha y-\\beta\\right)}}$$", "id": "1363738"}, {"introduction": "在获得了条件分布之后，我们就可以执行吉布斯采样算法了。本练习将为一个双变量系统，一步步地演示一轮完整的吉布斯采样过程。通过使用逆变换采样法和给定的随机数，我们将采样过程变得确定和透明，从而将抽象的算法转化为具体的计算[@problem_id:1920320]。", "problem": "考虑一个二维随机向量 $(X, Y)$，其联合概率分布由以下完全条件分布定义：\n- 给定 $Y=y$ 时 $X$ 的条件分布是率参数为 $y$ 的指数分布。其概率密度函数为 $p(x|y) = y \\exp(-yx)$，其中 $x > 0$。\n- 给定 $X=x$ 时 $Y$ 的条件分布是均值参数为 $x$ 的泊松分布。其概率质量函数为 $p(y=k|x) = \\frac{x^k \\exp(-x)}{k!}$，其中 $k \\in \\{0, 1, 2, \\dots\\}$。\n\n您的任务是执行一次完整的吉布斯采样器迭代。从初始状态 $(x^{(0)}, y^{(0)}) = (2, 3)$ 开始，您将生成一个新状态 $(x^{(1)}, y^{(1)})$。迭代的过程如下：首先，从分布 $p(x|y^{(0)})$ 中为 $x^{(1)}$ 抽取一个样本，然后，使用这个新值 $x^{(1)}$，从分布 $p(y|x^{(1)})$ 中为 $y^{(1)}$ 抽取一个样本。\n\n为了生成所需的随机变量，您必须使用逆变换采样法。请使用以下从 Uniform(0,1) 分布中抽取的随机数：\n- 为生成 $x^{(1)}$，使用均匀随机数 $u_x = 0.600$。\n- 为生成 $y^{(1)}$，使用均匀随机数 $u_y = 0.750$。\n\n新状态 $(x^{(1)}, y^{(1)})$ 的数值是多少？$x^{(1)}$ 的值必须四舍五入到四位有效数字。", "solution": "我们使用逆变换采样法执行一次吉布斯更新。\n\n1) 从 $p(x \\mid y^{(0)}=3)$ 中抽取样本 $x^{(1)}$。\n对于率参数为 $y$ 的指数分布，其条件累积分布函数(CDF)为\n$$\nF(x \\mid y)=1-\\exp(-yx), \\quad x>0.\n$$\n逆变换采样法使用 $u_{x}=F(x \\mid y)$，因此\n$$\nx^{(1)}=F^{-1}(u_{x})=-\\frac{1}{y^{(0)}}\\ln\\!\\bigl(1-u_{x}\\bigr).\n$$\n当 $y^{(0)}=3$ 且 $u_{x}=0.600$ 时，\n$$\nx^{(1)}=-\\frac{1}{3}\\ln(1-0.600)=-\\frac{1}{3}\\ln(0.4)=\\frac{1}{3}\\ln(2.5)\\approx 0.3054302439.\n$$\n四舍五入到四位有效数字：$x^{(1)}=0.3054$。\n\n2) 使用 $u_{y}=0.750$ 从 $p(y \\mid x^{(1)})$ 中抽取样本 $y^{(1)}$。\n对于均值为 $x$ 的泊松分布，其概率质量函数(pmf)为\n$$\np(y=k \\mid x)=\\frac{x^{k}\\exp(-x)}{k!}, \\quad k\\in\\{0,1,2,\\dots\\}.\n$$\n对于离散分布，逆变换采样法选择满足 $F(k \\mid x)=\\sum_{j=0}^{k}p(j \\mid x)\\ge u_{y}$ 的最小 $k$。\n\n当 $x=x^{(1)}=\\frac{1}{3}\\ln(2.5)$ 时，计算\n$$\np(0 \\mid x)=\\exp(-x)=\\exp\\!\\Bigl(-\\tfrac{1}{3}\\ln(2.5)\\Bigr)=2.5^{-1/3}\\approx 0.7368.\n$$\n由于 $p(0 \\mid x) \\approx 0.7368  0.750$，继续计算 $k=1$ 的情况：\n$$\np(1 \\mid x)=x\\exp(-x)=x\\,2.5^{-1/3}\\approx 0.30543\\times 0.7368\\approx 0.2250.\n$$\n然后\n$$\nF(1 \\mid x)=p(0 \\mid x)+p(1 \\mid x)\\approx 0.7368+0.2250=0.96180.750,\n$$\n因此，满足 $F(k \\mid x)\\ge 0.750$ 的最小 $k$ 是 $k=1$。所以 $y^{(1)}=1$。\n\n因此，新状态为 $(x^{(1)},y^{(1)})=(0.3054,1)$，其中 $x^{(1)}$ 已四舍五入到四位有效数字。", "answer": "$$\\boxed{\\begin{pmatrix}0.3054  1\\end{pmatrix}}$$", "id": "1920320"}, {"introduction": "吉布斯采样虽然功能强大，但并非万能的，它在实际应用中也面临挑战。最后一个练习将探讨一个最常见的陷阱：当模型中的变量高度相关时，采样器会混合缓慢。通过一种简化的、确定性的方式模拟采样器的路径，我们可以清晰地观察到强相关性如何阻碍采样器有效探索目标分布，这对于任何实践者来说都是一个至关重要的洞察[@problem_id:1363745]。", "problem": "在一个用于光学元件的高精度制造过程中，透镜的两个几何参数 $x_1$ 和 $x_2$ 对其性能至关重要。这些参数代表了与理想设计规格的归一化偏差。由于制造过程的物理原理，这些参数不是独立的。对生产数据的分析表明，它们的联合概率分布可以用一个未归一化的密度函数 $f(x_1, x_2)$ 来建模，其形式如下：\n$$f(x_1, x_2) \\propto \\exp \\left( -\\frac{1}{2(1-\\rho^2)} (x_1^2 - 2\\rho x_1 x_2 + x_2^2) \\right)$$\n对于这个特定的过程，发现相关系数为 $\\rho = 0.99$。该分布的众数位于 $(0, 0)$，这对应于一个完美的元件。\n\n为了模拟过程变异，你需要使用吉布斯采样器。你从初始状态 $(x_1^{(0)}, x_2^{(0)}) = (-4.0, -4.1)$ 开始，这代表一个处于可接受质量范围边缘的元件。\n\n你的任务是确定经过两次完整迭代后采样器的状态 $(x_1^{(2)}, x_2^{(2)})$。一次完整迭代包括先更新 $x_1$，然后更新 $x_2$。为了使计算具有确定性，你必须假设在每个采样步骤中，为变量抽取的新值等于其条件分布的均值。\n\n计算状态 $(x_1^{(2)}, x_2^{(2)})$ 的坐标。在最终答案中报告这两个坐标，并四舍五入到四位有效数字。", "solution": "我们识别出给定的未归一化联合密度\n$$\nf(x_{1},x_{2}) \\propto \\exp\\left(-\\frac{1}{2(1-\\rho^{2})}\\left(x_{1}^{2}-2\\rho x_{1}x_{2}+x_{2}^{2}\\right)\\right)\n$$\n是一个均值向量为 $(0,0)$、单位方差、相关系数为 $\\rho$ 的二元正态分布的核。为了推导完全条件分布，对 $x_1$ 进行配方：\n$$\nx_{1}^{2}-2\\rho x_{1}x_{2}+x_{2}^{2}=(x_{1}-\\rho x_{2})^{2}+(1-\\rho^{2})x_{2}^{2}。\n$$\n因此，在给定 $x_2$ 的条件下，\n$$\nf(x_{1}\\mid x_{2}) \\propto \\exp\\left(-\\frac{1}{2(1-\\rho^{2})}(x_{1}-\\rho x_{2})^{2}\\right),\n$$\n这是一个正态分布的核，其分布为\n$$\nx_{1}\\mid x_{2} \\sim \\mathcal{N}\\!\\left(\\rho x_{2},\\,1-\\rho^{2}\\right)。\n$$\n根据对称性，我们同样有\n$$\nx_{2}\\mid x_{1} \\sim \\mathcal{N}\\!\\left(\\rho x_{1},\\,1-\\rho^{2}\\right)。\n$$\n\n吉布斯采样器首先使用 $x_2$ 更新 $x_1$，然后使用新的 $x_1$ 更新 $x_2$。在每次抽样等于条件均值的确定性规则下，更新规则为\n$$\nx_{1}^{(t+1)}=\\rho\\,x_{2}^{(t)},\\qquad x_{2}^{(t+1)}=\\rho\\,x_{1}^{(t+1)}。\n$$\n结合这两者，\n$$\nx_{2}^{(t+1)}=\\rho^{2}\\,x_{2}^{(t)},\\qquad x_{1}^{(t+1)}=\\rho\\,x_{2}^{(t)}。\n$$\n从 $(x_{1}^{(0)},x_{2}^{(0)})=(-4.0,-4.1)$ 开始，并使用 $\\rho=0.99$，第一次完整迭代得出\n$$\nx_{1}^{(1)}=\\rho\\,x_{2}^{(0)}=0.99\\times(-4.1)=-4.059,\\qquad\nx_{2}^{(1)}=\\rho\\,x_{1}^{(1)}=0.99\\times(-4.059)=-4.01841。\n$$\n第二次完整迭代则给出\n$$\nx_{1}^{(2)}=\\rho\\,x_{2}^{(1)}=0.99\\times(-4.01841)=-3.9782259,\\qquad\nx_{2}^{(2)}=\\rho\\,x_{1}^{(2)}=0.99\\times(-3.9782259)=-3.938443641。\n$$\n将每个坐标四舍五入到四位有效数字：\n$$\nx_{1}^{(2)}\\approx -3.978,\\qquad x_{2}^{(2)}\\approx -3.938。\n$$", "answer": "$$\\boxed{\\begin{pmatrix}-3.978  -3.938\\end{pmatrix}}$$", "id": "1363745"}]}