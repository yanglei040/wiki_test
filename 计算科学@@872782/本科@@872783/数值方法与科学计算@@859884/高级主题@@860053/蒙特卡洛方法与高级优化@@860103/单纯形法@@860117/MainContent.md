## 引言
线性规划是[运筹学](@entry_id:145535)和[优化理论](@entry_id:144639)的基石，它为在资源有限的条件下做出最佳决策提供了一个强大的数学框架。然而，仅仅建立一个[线性规划](@entry_id:138188)模型是不够的；我们还需要一种系统而高效的方法来求解它。这正是单纯形法（Simplex Method）的用武之地。作为解决线性规划问题最经典、最重要的算法之一，单纯形法不仅是一个计算工具，更是一种揭示问题深层经济和几何结构的思维方式。

本文旨在填补从理论概念到实际求解之间的鸿沟，全面解析单纯形法的内在逻辑与广泛应用。读者将通过本文深入学习三个核心部分。首先，在“原理与机制”章节中，我们将剖析算法的每一步，从几何直观到代数操作，理解枢轴变换、[两阶段法](@entry_id:166636)以及[对偶理论](@entry_id:143133)的精髓。接着，在“应用与跨学科联系”章节中，我们将探索单纯形法如何在[运筹学](@entry_id:145535)、经济金融、工程乃至数据科学等领域解决真实的复杂问题。最后，“动手实践”部分将提供具体的练习，帮助读者巩固所学知识，将理论付诸实践。

通过这三章的学习，您将不仅掌握单纯形法的计算技巧，更能建立起利用优化思想解决实际问题的能力。让我们从算法的核心——它的原理与机制开始探索。

## 原理与机制

在上一章介绍线性规划的基本概念之后，本章将深入探讨求解这些问题的核心算法——单纯形法的原理与机制。单纯形法不仅是一种高效的计算工具，其背后还蕴含着深刻的几何直观和代数理论。我们将从问题的[标准化](@entry_id:637219)表示开始，逐步解析算法的每一步，并最终将其与更广泛的优化理论联系起来。

### 从几何到代数：线性规划的标准型

[线性规划](@entry_id:138188)问题的可行域是一个凸多胞体，而最优解必然在该多胞体的某个顶点上达到。单纯形法的基本思想，正是在这些顶点之间进行系统性的移动，以寻找最优解。为了将这一几何思想转化为可执行的代数操作，我们首先需要将问题转化为一种统一的格式，即**标准型 (standard form)**。

标准型通常要求所有约束都是[等式约束](@entry_id:175290)，并且所有决策变量都非负。对于不同形式的原始约束，我们可以通过引入辅助变量来完成转化：

1.  **对于“小于等于”($\le$)约束**：我们引入一个非负的**[松弛变量](@entry_id:268374) (slack variable)**，它代表了约束资源未被充分利用的量。例如，一个约束 $2x_1 + 3x_2 \le 12$ 可以转化为等式 $2x_1 + 3x_2 + s_1 = 12$，其中 $s_1 \ge 0$。

2.  **对于“大于等于”($\ge$)约束**：我们减去一个非负的**剩余变量 (surplus variable)**，它代表了超出约束要求的部分。例如，约束 $x_1 + 4x_2 \ge 8$ 可以转化为 $x_1 + 4x_2 - s_2 = 8$，其中 $s_2 \ge 0$。

3.  **对于“等于”($=$)约束**：约束本身已经是等式，无需引入松弛或剩余变量。

然而，仅有松弛和剩余变量还不足以保证我们能轻松找到一个初始的出发点。单纯形法要求一个初始的**基本[可行解](@entry_id:634783)**，这通常对应于一个[单位矩阵](@entry_id:156724)作为部分约束系数矩阵。[松弛变量](@entry_id:268374)天然地满足此要求，但剩余变量（系数为-1）和原始的[等式约束](@entry_id:175290)则不然。为了解决这个问题，我们引入**[人工变量](@entry_id:164298) (artificial variable)**。

考虑一个混合约束问题 [@problem_id:2222356]：
最大化 $Z = 3x_1 + 5x_2$
约束于：
1.  $2x_1 + x_2 \le 10$
2.  $x_1 + 4x_2 \ge 8$
3.  $x_1 + x_2 = 6$
以及 $x_1, x_2 \ge 0$。

为了将其转化为适合启动单纯形法的标准形式，我们需要：
-   为第一个 $\le$ 约束引入一个[松弛变量](@entry_id:268374) $s_1$，得到 $2x_1 + x_2 + s_1 = 10$。
-   为第二个 $\ge$ 约束引入一个剩余变量 $s_2$ 和一个[人工变量](@entry_id:164298) $a_2$，得到 $x_1 + 4x_2 - s_2 + a_2 = 8$。
-   为第三个 $=$ 约束引入一个[人工变量](@entry_id:164298) $a_3$，得到 $x_1 + x_2 + a_3 = 6$。

最终的等式系统包含了**一个[松弛变量](@entry_id:268374)**、$s_1$；**一个剩余变量**、$s_2$；以及**两个[人工变量](@entry_id:164298)**、$a_2$ 和 $a_3$。这些[人工变量](@entry_id:164298)只是为了构造初始解而存在的临时工具，我们必须在后续的计算中将它们从解中移除。这引出了[两阶段单纯形法](@entry_id:176724)，我们稍后将详细讨论。

### 基石：基本可行解 (BFS)

在将问题转化为标准型 $Ax = b, x \ge 0$ 后，单纯形法的核心操作单元是**基本可行解 (Basic Feasible Solution, BFS)**。

一个[基本解](@entry_id:184782)是通过将 $n$ 个变量中的 $n-m$ 个（其中 $m$ 是约束方程的个数）设置为零，然后求解剩余 $m$ 个变量得到。被设为零的变量称为**非基本变量 (non-basic variables)**，被求解的 $m$ 个变量称为**基本变量 (basic variables)**。如果一个[基本解](@entry_id:184782)中所有变量的值都非负，那么它就是一个基本[可行解](@entry_id:634783)。几何上，每一个基本可行解都精确地对应着可行域[多胞体](@entry_id:635589)的一个**顶点**。

单纯形算法的起始点是一个初始基本[可行解](@entry_id:634783)。对于只包含 $\le$ 约束且右端项非负的标准最大化问题，初始BFS的构造非常直观 [@problem_id:2220999]。我们只需将所有的原始决策变量（如 $x_1, x_2$）设为非基本变量，即令它们的值为0。此时，[松弛变量](@entry_id:268374)就构成了初始的基，它们的值等于约束的右端项。例如，对于约束 $2x_1 + 3x_2 \le 12$ 和 $3x_1 + x_2 \le 9$，初始BFS通过设置 $x_1=0, x_2=0$ 得到，此时 $s_1=12, s_2=9$。这个解在原始的 $(x_1, x_2)$ 决策空间中，对应的正是坐标原点 $(0, 0)$，这也是[可行域](@entry_id:136622)的一个顶点。

理解BFS的关键在于，它代表了一种[资源分配](@entry_id:136615)的“极端”策略。在一个涉及 $n$ 种资产和 $m$ 条约束的投资[组合优化](@entry_id:264983)问题中，一个BFS的特性是至关重要的 [@problem_id:2443963]。一个基本[可行解](@entry_id:634783)意味着，在非退化的情况下，投资组合将精确地持有 $m$ 种资产（或[松弛变量](@entry_id:268374)，代表未用尽的预算或限制），而所有其他资产的权重为零。更准确地说，一个BFS是通过从所有决策变量和松弛/剩余变量中选择 $m$ 个[线性无关](@entry_id:148207)的列构成**基**，并将所有非基本变量设为0来获得的。投资组合实际“持有”的资产，是那些作为基本变量并且其解出来的值严格为正的资产。因此，在任何一个BFS中，持有资产的数量不会超过约束的总数 $m$。

### 进步的引擎：单纯形枢轴变换

单纯形法的迭代过程，就是从一个BFS（顶点）移动到另一个相邻的、目标函数值更优的BFS（顶点）。这一移动是通过一次**枢轴变换 (pivot operation)** 完成的。

从几何上看，一次非退化的枢轴变换恰好对应于沿着[可行域](@entry_id:136622)多胞体的一条**棱**从一个顶点移动到相邻的另一个顶点 [@problem_id:2443978]。一个顶点由 $n$ 个线性无关的[有效约束](@entry_id:635234)（在 $\mathbb{R}^n$ 空间中）的交点定义。枢轴变换的过程是：
1.  **放松一个约束**：选择一个当前值为0的非基本变量，允许其值增加。这相当于放松了该变量的非负性约束 $x_j=0$。
2.  **沿棱移动**：在保持其他 $n-1$ 个约束有效的情况下增加该变量的值，这个运动轨迹就是一条一维的线，即[多胞体](@entry_id:635589)的一条棱。
3.  **遇到新约束**：持续移动，直到某个基本变量的值下降到0。这相当于遇到了一个新的[有效约束](@entry_id:635234)。
4.  **到达相邻顶点**：此时，我们到达了一个新的顶点，它与原顶点共享 $n-1$ 个[有效约束](@entry_id:635234)，因此是相邻的。

这个几何过程在代数上通过以下两个步骤实现：

#### 1. 选择入基变量：[检验数](@entry_id:173345)的角色

如何决定沿哪条棱移动能改善目标函数值？这取决于各非基本变量的**[检验数](@entry_id:173345) (reduced cost)**。在一个典型的单纯形表（或字典）中，目标函数行表达了 $Z$ 与所有非基本变量的关系。例如，对于最大化问题，[目标函数](@entry_id:267263)行可能表示为 $Z = Z_0 - \sum_{j} \bar{c}_j x_j$，其中 $x_j$ 是非基本变量。

这里的 $\bar{c}_j$ 就是非基本变量 $x_j$ 的[检验数](@entry_id:173345)。它表示当 $x_j$ 的值从0增加一个单位时，[目标函数](@entry_id:267263) $Z$ 的变化率。对于最大化问题，如果存在一个非基本变量 $x_j$ 的[检验数](@entry_id:173345) $\bar{c}_j > 0$（在某些表格形式中，这表现为目标函数行系数为负，如 $Z + \dots - \bar{c}_j x_j + \dots = Z_0$），则增加 $x_j$ 的值可以提高 $Z$。因此，单纯形法的**[最优性条件](@entry_id:634091)**是：对于最大化问题，所有[检验数](@entry_id:173345)均非正（$\bar{c}_j \le 0$）。

如果当前解不是最优的，我们就需要选择一个[检验数](@entry_id:173345)为正的非基本变量作为**入基变量 (entering variable)**。一个常见的策略（Dantzig's rule）是选择具有最大正[检验数](@entry_id:173345)的变量，因为它提供了最快的目标[函数增长率](@entry_id:267648)。例如，在一个处于中间迭代步骤的单纯形表中 [@problem_id:2221004]，目标行显示为 $Z - 4x_2 + 2s_1 = 800$。由于 $x_2$ 的系数是-4，这意味着每增加一个单位的 $x_2$，$Z$ 将增加4个单位。因此，当前解不是最优的，而 $x_2$ 是一个合适的入基变量。

#### 2. 选择出基变量：比率测试的几何意义

确定了入基变量（即移动方向）后，我们需要决定沿这条棱能走多远。这个“距离”不能无限大，否则可能会穿出可行域，违反其他约束。**比率测试 (ratio test)** 正是用来确定这个最大步长的机制。

当我们增加一个入基变量 $x_j$ 的值时，为了维持[等式约束](@entry_id:175290) $Ax=b$ 成立，一些基本变量的值将会减少。非负性要求所有变量的值必须始终大于等于0。比率测试计算了每个当前基本变量被新增加的 $x_j$ “挤压”至0所需 $x_j$ 的增量。我们必须选择这些比率中最小的那个正值。

从几何角度看，比率测试的意义是确定我们沿选定的棱线移动时，会最先碰到哪一个“阻塞面” [@problem_id:2443989]。每个基本变量对应一个当前不生效的非负约束。当某个基本变量的值降至0时，意味着我们碰到了由该变量的非负约束所定义的[超平面](@entry_id:268044)（例如 $x_i=0$）。比率测试找到的最小正比率，就对应着沿该方向移动所能达到的第一个这样的[超平面](@entry_id:268044)。撞上这个超平面后，我们就到达了一个新的顶点。该基本变量也就成为了**出基变量 (leaving variable)**。

如果对于一个希望入基的变量，其所在列的所有系数都非正，这意味着增加该变量的值不会导致任何基本变量减少。我们可以无限增加它的值而始终保持可行性。在这种情况下，目标函数是**无界的 (unbounded)**。

### 处理复杂情况：特殊案例与高级方法

标准的单纯形法流程简洁优美，但在实践中会遇到一些需要特殊处理的复杂情况。

#### 寻找起点：[两阶段法](@entry_id:166636)

当问题包含 $\ge$ 或 $=$ 约束时，我们无法像之前那样简单地通过设置决策变量为0来获得初始基本可行解。这时就需要**[两阶段法](@entry_id:166636) (Two-Phase Simplex Method)**。

**第一阶段 (Phase I)** 的唯一目标是为原问题找到一个基本[可行解](@entry_id:634783)。我们通过引入[人工变量](@entry_id:164298)，构造一个**辅助问题 (auxiliary problem)**，其目标是最小化所有[人工变量](@entry_id:164298)之和。
-   如果辅助问题的最小值为0，这意味着所有[人工变量](@entry_id:164298)都可以被驱动为0。此时我们已经找到了原问题的一个BFS，可以丢弃[人工变量](@entry_id:164298)，并以这个解为起点，进入第二阶段。
-   如果辅助问题的最小值严格大于0，这意味着不可能在满足原约束的情况下使所有[人工变量](@entry_id:164298)都为0。这证明了原问题的[可行域](@entry_id:136622)是空的，即原问题**无可行解 (infeasible)** [@problem_em_id:2443981]。因此，第一阶段的最优值是判断原问题是否可行的决定性依据。

**第二阶段 (Phase II)** 从第一阶段找到的BFS开始，使用标准的单纯形法求解原始的目标函数。

#### 退化、停滞与循环

一个基本[可行解](@entry_id:634783)中，如果至少有一个基本变量的值为0，则称该解是**退化的 (degenerate)**。退化在几何上意味着一个顶点被超过 $n$ 个约束[超平面](@entry_id:268044)所定义。

退化在算法上可能导致一种称为**停滞 (stalling)** 的现象 [@problem_id:2443962]。在一次退化枢轴变换中，比率测试选出的最小比率为0。这意味着入基变量增加的步长为0，算法的解（顶点）没有移动，目标函数值也没有改善，但基变量集合却发生了改变。

在大型实际问题中，尤其是具有大量约束的金融模型（如资产[分配问题](@entry_id:174209)），[退化现象](@entry_id:183258)非常普遍，而非罕见。虽然单次停滞无害，但一系列的停滞枢轴变换可能导致**循环 (cycling)**——即算法在多个基之间无限循环，而始终停留在同一个顶点，无法终止。

为了应对这些问题，发展了多种**反循环枢轴规则**。其中最著名的是**布兰德规则 (Blan[d'](@entry_id:189153)s rule)**，它规定在有多个选择时，总是选择下标最小的变量作为入基和出基变量。布兰德规则可以保证算法最终会终止，从而避免循环，但它并不能阻止停滞的发生 [@problem_id:2443962]。另一种更根本的方法是**扰动法 (perturbation methods)**，例如词典序方法。它通过对约束的右端项向量 $b$ 施加一个极小的扰动，从理论上消除退化，确保所有基本[可行解](@entry_id:634783)都是非退化的。然而，这种方法可能会轻微改变问题的经济学含义，尤其是在[等式约束](@entry_id:175290)代表精确的会计平衡时。

### 深层理论：对偶与[最优性条件](@entry_id:634091)

单纯形法不仅是一个计算过程，它还揭示了[线性规划](@entry_id:138188)深层的理论结构，特别是[对偶理论](@entry_id:143133)。

#### 强对偶性与最终单纯形表

每个线性规划问题（称为**原问题 (primal problem)**）都有一个与之对应的**对偶问题 (dual problem)**。例如，一个最大化问题的对偶通常是一个最小化问题。**强[对偶定理](@entry_id:137804) (Strong Duality Theorem)** 指出，如果一个问题有最优解，那么它的对偶问题也有最优解，并且它们的最优[目标函数](@entry_id:267263)值相等。

单纯形法为这个深刻的理论提供了一个**[构造性证明](@entry_id:157587)**。当单纯形法终止时，最终的单纯形表（或字典）实际上包含了原问题和[对偶问题](@entry_id:177454)的双重信息 [@problem_id:2443938]。
-   **原问题最优解** $x^*$：可以直接从表中读出基本变量的值（非基本变量为0）。
-   **对偶问题最优解** $y^*$：可以从最终[目标函数](@entry_id:267263)行中，与**初始基变量**（通常是[松弛变量](@entry_id:268374)）相对应的[检验数](@entry_id:173345)中读出。对于标准最大化问题 $\max \{c^\top x \mid Ax \le b, x \ge 0\}$，其对偶解 $y^*$ 的分量等于最终目标函数行中[松弛变量](@entry_id:268374) $s_i$ 的系数的[相反数](@entry_id:151709)。

例如，在问题 [@problem_id:2443938] 中，最终的字典显示原问题最优解为 $x^*=(1,3)$，目标值为 $z=9$。目标行 $z = 9 - s_1 - s_2$ 表明，[对偶变量](@entry_id:143282)的最优解是 $y_1^* = -(-1) = 1$ 和 $y_2^* = -(-1) = 1$。我们可以验证，对偶解 $y^*=(1,1)$ 是对偶可行的，并且其[目标函数](@entry_id:267263)值 $4y_1 + 5y_2 = 4(1) + 5(1) = 9$，与原问题目标值完全相等。这样，单纯形法的终点同时给出了原问题和[对偶问题](@entry_id:177454)的最优解，并验证了强[对偶定理](@entry_id:137804)。

#### [KKT条件](@entry_id:185881)与单纯形法的统一

[线性规划](@entry_id:138188)的[最优性条件](@entry_id:634091)也可以从更一般的[非线性规划](@entry_id:636219)理论——**[Karush-Kuhn-Tucker (KKT) 条件](@entry_id:176491)**——中导出。对于一个标准形式的最小化[线性规划](@entry_id:138188)问题 ($\min c^\top x$ s.t. $Ax=b, x \ge 0$)，其[KKT条件](@entry_id:185881)可以概括为以下三点 [@problem_id:3246253]：

1.  **原始可行性 (Primal Feasibility)**: $Ax = b, x \ge 0$.
2.  **对偶可行性 (Dual Feasibility)**: 存在对偶变量 $y$ 和 $s$ 使得 $A^\top y + s = c$ 且 $s \ge 0$。（这里的 $s$ 相当于单纯形法中的[检验数](@entry_id:173345)向量）。
3.  **[互补松弛性](@entry_id:141017) (Complementary Slackness)**: 对于所有变量 $i$，都有 $x_i s_i = 0$。

这三个条件与单纯形法的最优性检查有着惊人的一致性：
-   单纯形法在整个迭代过程中始终保持**原始可行性**，因为每个BFS都满足这个条件。
-   单纯形法的**[最优性条件](@entry_id:634091)**（例如，对于最小化问题，所有[检验数](@entry_id:173345)非负，即 $s \ge 0$）正是KKT的**对偶可行性**条件。
-   **[互补松弛性](@entry_id:141017)**在任何一个基本[可行解](@entry_id:634783)中都自动满足。因为对于任何变量 $x_i$，它要么是非基本变量（此时 $x_i=0$），要么是基本变量（在单纯形法中，通过选取[对偶变量](@entry_id:143282) $y$ 使得基本变量的[检验数](@entry_id:173345) $s_i=0$）。无论哪种情况，$x_i s_i = 0$ 都成立。

因此，单纯形法可以被看作是一个巧妙的算法，它在迭代过程中始终维持原始可行性和[互补松弛性](@entry_id:141017)，同时不断向着对偶可行性的目标前进。当对偶可行性最终达成时，所有[KKT条件](@entry_id:185881)均被满足，算法便找到了最优解。这一联系将单纯形法的具体步骤置于现代[优化理论](@entry_id:144639)的坚实基础之上。