{"hands_on_practices": [{"introduction": "障碍法的核心思想是通过引入一个对数障碍项，将受约束的优化问题转化为一系列无约束问题。这个练习 [@problem_id:2155925] 将引导你通过一个最简单的一维线性规划问题，亲手推导出中心路径的显式表达式。通过这个过程，你将直观地理解中心路径是如何形成的，以及它如何依赖于障碍参数 $t$。", "problem": "考虑一个简单的一维线性规划问题，其定义为：\n最小化 $f(x) = c x$\n约束条件为 $x \\ge 0$\n其中 $x$ 是一个标量变量，$c$ 是一个给定的正常数，$c > 0$。\n\n为使用内点法求解此问题，我们可以采用对数障碍函数。通过在目标函数中增加一个障碍项，原始的约束问题被转化为一系列无约束优化问题。该问题的修正目标函数由下式给出：\n$$P(x; t) = t(cx) - \\ln(x)$$\n其中 $t > 0$ 是一个标量障碍参数。对于给定的 $t$ 值，$P(x; t)$ 的最小值点是所谓的“中心路径”上的一个点，我们将其记为 $x^*(t)$。\n\n请确定中心路径点 $x^*(t)$ 关于常数 $c$ 和 $t$ 的显式公式。", "solution": "我们考虑对于 $x>0$ 的障碍增广目标函数：\n$$\nP(x;t) = t c x - \\ln(x),\n$$\n其中 $t>0$ 且 $c>0$。为求中心路径点 $x^{*}(t)$，我们将一阶导数置零：\n$$\n\\frac{dP}{dx} = t c - \\frac{1}{x} = 0.\n$$\n求解 $x$ 可得\n$$\n\\frac{1}{x} = t c \\quad \\Rightarrow \\quad x^{*}(t) = \\frac{1}{c t}.\n$$\n为验证这是一个最小值点，我们检查二阶导数：\n$$\n\\frac{d^{2}P}{dx^{2}} = \\frac{1}{x^{2}} > 0 \\quad \\text{for } x>0,\n$$\n因此 $P(\\cdot;t)$ 在其定义域上是严格凸的，该临界点是唯一的最小值点。所以，中心路径为\n$$\nx^{*}(t) = \\frac{1}{c t}.\n$$", "answer": "$$\\boxed{\\frac{1}{c t}}$$", "id": "2155925"}, {"introduction": "中心路径不仅仅是一个数学构造，它与优化问题的对偶理论有着深刻的联系，尤其体现在对偶间隙上。这个练习 [@problem_id:2155911] 将让你计算一个简单优化问题的对偶间隙，并发现它与障碍参数 $t$ 之间简洁的倒数关系。这个结果是内点法中的一个基本结论，它量化了中心路径上的点与最优解的接近程度。", "problem": "考虑以下一维凸优化问题：\n$$\n\\text{minimize } x \\quad \\text{subject to } x \\ge 1\n$$\n该问题可以使用对数障碍法进行近似。对于一个形如 $\\min f_0(x)$ 且约束为 $f_i(x) \\le 0$（$i=1, \\dots, m$）的标准问题，障碍法涉及求解以下无约束问题：\n$$\n\\text{minimize } t f_0(x) - \\sum_{i=1}^{m} \\ln(-f_i(x))\n$$\n其中 $t > 0$ 是给定的障碍参数。令 $x^*(t)$ 为该无约束问题的解。\n\n对于给定的 $t$，对偶间隙定义为在障碍解处的主目标值 $p^*(t) = f_0(x^*(t))$ 与在相应对偶可行点处的对偶目标值 $d^*(t) = g(\\lambda^*(t))$ 之间的差值。\n\n您的任务是计算给定优化问题的对偶间隙，作为参数 $t$ 的函数。请用关于 $t$ 的封闭形式解析表达式来表示您的答案。", "solution": "我们首先通过定义 $f_{1}(x) = 1 - x$ 将约束 $x \\ge 1$ 重写为标准形式 $f_{1}(x) \\le 0$。目标函数为 $f_{0}(x) = x$。对于参数 $t > 0$，对数障碍问题是\n$$\n\\min_{x>1} \\; F_{t}(x) = t f_{0}(x) - \\ln\\big(-f_{1}(x)\\big) = t x - \\ln(x - 1).\n$$\n为了找到最小值点 $x^{*}(t)$，我们求导并令其为零：\n$$\n\\frac{d}{dx}F_{t}(x) = t - \\frac{1}{x - 1} = 0 \\quad \\Longrightarrow \\quad x^{*}(t) = 1 + \\frac{1}{t}.\n$$\n二阶导数为 $F_{t}''(x) = \\frac{1}{(x - 1)^{2}} > 0$（对于 $x > 1$），因此这确实是唯一的最小值点。相应的主目标值为\n$$\np^{*}(t) = f_{0}\\big(x^{*}(t)\\big) = 1 + \\frac{1}{t}.\n$$\n对偶问题由拉格朗日函数 $L(x,\\lambda) = f_{0}(x) + \\lambda f_{1}(x) = x + \\lambda(1 - x)$ 构成，其中 $\\lambda \\ge 0$。对偶函数是\n$$\ng(\\lambda) = \\inf_{x} \\big\\{x + \\lambda(1 - x)\\big\\} = \n\\begin{cases}\n\\lambda,  \\text{if } 1 - \\lambda = 0,\\\\\n-\\infty,  \\text{otherwise},\n\\end{cases}\n$$\n因此，唯一能产生有限值的对偶可行点是 $\\lambda = 1$，此时 $g(1) = 1$。\n\n与障碍解相关联的对偶变量满足扰动 KKT（中心路径）关系。使用 $f_{1}(x) = 1 - x$，中心路径乘子是\n$$\n\\lambda^{*}(t) = -\\frac{1}{t f_{1}\\big(x^{*}(t)\\big)}.\n$$\n由于 $f_{1}\\big(x^{*}(t)\\big) = 1 - \\left(1 + \\frac{1}{t}\\right) = -\\frac{1}{t}$，我们得到 $\\lambda^{*}(t) = 1$，这与平稳性条件 $\\nabla f_{0}(x) + \\lambda \\nabla f_{1}(x) = 0$ 一致。\n\n因此，在相应对偶可行点处的对偶目标值为\n$$\nd^{*}(t) = g\\big(\\lambda^{*}(t)\\big) = g(1) = 1.\n$$\n对偶间隙是\n$$\np^{*}(t) - d^{*}(t) = \\left(1 + \\frac{1}{t}\\right) - 1 = \\frac{1}{t}.\n$$\n等价地，在中心路径上，互补松弛乘积满足 $-\\lambda^{*}(t) f_{1}\\big(x^{*}(t)\\big) = \\frac{1}{t}$，并且由于只有一个约束，间隙等于 $\\frac{1}{t}$。", "answer": "$$\\boxed{\\frac{1}{t}}$$", "id": "2155911"}, {"introduction": "理解了中心路径的理论概念之后，下一步是探索如何在数值上“追踪”这条路径。这个练习 [@problem_id:3208894] 将带你深入原始-对偶内点法的核心，通过一个具体的例子，构建并求解计算牛顿步长的KKT（Karush-Kuhn-Tucker）线性系统。这是将理论付诸实践的关键一步，让你体验现代优化算法的计算引擎。", "problem": "考虑标准形式的线性规划问题：最小化 $c^T x$，约束条件为 $A x = b$ 和 $x \\ge 0$，其中 $A \\in \\mathbb{R}^{m \\times n}$ 是行满秩矩阵，$b \\in \\mathbb{R}^{m}$，$c \\in \\mathbb{R}^{n}$，$x \\in \\mathbb{R}^{n}$。此问题的 Karush-Kuhn-Tucker (KKT) 条件（一阶最优性条件）为等式约束引入了拉格朗日乘子 $y \\in \\mathbb{R}^{m}$，为非负约束引入了松弛变量 $s \\in \\mathbb{R}^{n}$，从而得到原始可行性条件 $A x = b$，对偶可行性条件 $A^T y + s = c$，以及对每个下标 $i$ 的互补松弛条件 $x_i s_i = 0$。在带有对数障碍的原始-对偶内点法中，互补松弛条件被扰动为中心路径条件 $x_i s_i = \\mu$，其中障碍参数 $\\mu > 0$。然后，在严格正迭代点 $x > 0$、$s > 0$ 处，对扰动后的 KKT 系统应用一个牛顿步。\n\n考虑 $m = 1$ 和 $n = 2$ 的具体实例：\n- $A = \\begin{bmatrix} 1  2 \\end{bmatrix}$，\n- $b = 4$，\n- $c = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}$。\n\n在当前迭代点，取 $x = \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}$，$y = 0$，$s = \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}$，障碍参数 $\\mu = \\tfrac{1}{2}$。\n\n从上面给出的原始可行性、对偶可行性和扰动互补性的定义出发，并围绕当前迭代点使用一阶泰勒线性化（牛顿法）：\n1) 在给定的迭代点上，推导牛顿搜索方向 $(\\Delta x, \\Delta y, \\Delta s)$ 的显式线性 KKT 系统，并用此实例中的 $A$、$x$、$y$、$s$、$c$、$b$ 和 $\\mu$ 写出所有系数矩阵和右端项。\n2) 通过消元得到只含 $\\Delta y$ 的简化对称正定正规方程，并为此实例显式地写出该方程。\n3) 求解所得系统以得到 $(\\Delta y, \\Delta s, \\Delta x)$，然后计算原始牛顿步的第一个分量 $\\Delta x_1$。\n\n提供 $\\Delta x_1$ 的最终值，结果应为精确数，无需四舍五入。", "solution": "问题描述了一个标准形式的线性规划（LP）问题：\n$$ \\text{minimize} \\quad c^T x $$\n$$ \\text{subject to} \\quad Ax = b, \\quad x \\ge 0 $$\n原始-对偶内点法旨在求解 Karush-Kuhn-Tucker (KKT) 条件，其中互补松弛条件 $x_i s_i = 0$ 被扰动。得到的关于变量 $(x, y, s)$ 的非线性方程组为：\n1.  原始可行性：$Ax = b$\n2.  对偶可行性：$A^T y + s = c$\n3.  扰动互补性：$XSe = \\mu e$，其中 $X = \\text{diag}(x)$，$S = \\text{diag}(s)$，$e$ 是全一向量，$\\mu > 0$ 是障碍参数。\n\n在当前迭代点 $(x, y, s)$ 为该系统计算一个牛顿步 $(\\Delta x, \\Delta y, \\Delta s)$。这涉及求解线性化系统：\n$$ J \\begin{pmatrix} \\Delta x \\\\ \\Delta y \\\\ \\Delta s \\end{pmatrix} = -F(x,y,s) $$\n其中 $F(x,y,s) = \\begin{pmatrix} A^T y + s - c \\\\ Ax - b \\\\ XSe - \\mu e \\end{pmatrix}$ 是表示 KKT 系统的函数，$J$ 是其雅可比矩阵。雅可比矩阵由下式给出：\n$$ J = \\begin{pmatrix} \\frac{\\partial(A^Ty+s-c)}{\\partial x}  \\frac{\\partial(A^Ty+s-c)}{\\partial y}  \\frac{\\partial(A^Ty+s-c)}{\\partial s} \\\\ \\frac{\\partial(Ax-b)}{\\partial x}  \\frac{\\partial(Ax-b)}{\\partial y}  \\frac{\\partial(Ax-b)}{\\partial s} \\\\ \\frac{\\partial(XSe-\\mu e)}{\\partial x}  \\frac{\\partial(XSe-\\mu e)}{\\partial y}  \\frac{\\partial(XSe-\\mu e)}{\\partial s} \\end{pmatrix} = \\begin{pmatrix} 0  A^T  I \\\\ A  0  0 \\\\ S  0  X \\end{pmatrix} $$\n右端项是当前迭代点残差向量的负值：\n$$ -F = \\begin{pmatrix} c - (A^T y + s) \\\\ b - Ax \\\\ \\mu e - XSe \\end{pmatrix} = \\begin{pmatrix} r_d \\\\ r_p \\\\ r_c \\end{pmatrix} $$\n因此，牛顿系统为：\n$$ \\begin{pmatrix} 0  A^T  I \\\\ A  0  0 \\\\ S  0  X \\end{pmatrix} \\begin{pmatrix} \\Delta x \\\\ \\Delta y \\\\ \\Delta s \\end{pmatrix} = \\begin{pmatrix} r_d \\\\ r_p \\\\ r_c \\end{pmatrix} $$\n这等价于以下三个线性方程组成的系统：\n1.  $A^T \\Delta y + \\Delta s = r_d$ (对偶步方程)\n2.  $A \\Delta x = r_p$ (原始步方程)\n3.  $S \\Delta x + X \\Delta s = r_c$ (中心性步方程)\n\n我们得到的具体实例是：\n-   $A = \\begin{bmatrix} 1  2 \\end{bmatrix}$，$b = 4$，$c = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}$\n-   当前迭代点：$x = \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}$，$y = 0$，$s = \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}$\n-   障碍参数：$\\mu = \\frac{1}{2}$\n\n首先，我们计算残差 $r_p$，$r_d$ 和 $r_c$：\n$$ r_p = b - Ax = 4 - \\begin{bmatrix} 1  2 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix} = 4 - (1+2) = 1 $$\n$$ r_d = c - A^T y - s = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} - \\begin{bmatrix} 1 \\\\ 2 \\end{bmatrix}(0) - \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix} = \\begin{bmatrix} 1 - 1 \\\\ 0 - 1 \\end{bmatrix} = \\begin{bmatrix} 0 \\\\ -1 \\end{bmatrix} $$\n对于 $r_c$，我们需要对角矩阵 $X$ 和 $S$：\n$$ X = \\text{diag}(x) = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}, \\quad S = \\text{diag}(s) = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} $$\n$$ r_c = \\mu e - XSe = \\frac{1}{2} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} - \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1/2 \\\\ 1/2 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} -1/2 \\\\ -1/2 \\end{pmatrix} $$\n\n**1) 关于 $(\\Delta x, \\Delta y, \\Delta s)$ 的显式线性 KKT 系统**\n\n搜索方向为 $\\Delta x = \\begin{pmatrix} \\Delta x_1 \\\\ \\Delta x_2 \\end{pmatrix}$，$\\Delta y \\in \\mathbb{R}^1$ 以及 $\\Delta s = \\begin{pmatrix} \\Delta s_1 \\\\ \\Delta s_2 \\end{pmatrix}$。牛顿系统为：\n$$ \\begin{pmatrix} 0_{2 \\times 2}  A^T  I_2 \\\\ A  0  0_{1 \\times 2} \\\\ S  0_{2 \\times 1}  X \\end{pmatrix} \\begin{pmatrix} \\Delta x \\\\ \\Delta y \\\\ \\Delta s \\end{pmatrix} = \\begin{pmatrix} r_d \\\\ r_p \\\\ r_c \\end{pmatrix} $$\n代入此实例的具体矩阵和向量：\n- 系数矩阵：\n$$ \\begin{pmatrix}\n0  0  1  1  0 \\\\\n0  0  2  0  1 \\\\\n1  2  0  0  0 \\\\\n1  0  0  1  0 \\\\\n0  1  0  0  1\n\\end{pmatrix} $$\n_注意：在此矩阵表示中，我们按 $(\\Delta x_1, \\Delta x_2, \\Delta y, \\Delta s_1, \\Delta s_2)$ 的顺序列出变量。_\n\n- 右端向量：\n$$ \\begin{pmatrix} r_{d1} \\\\ r_{d2} \\\\ r_p \\\\ r_{c1} \\\\ r_{c2} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -1 \\\\ 1 \\\\ -1/2 \\\\ -1/2 \\end{pmatrix} $$\n因此，显式系统为：\n$$ \\begin{pmatrix} 0  0  1  1  0 \\\\ 0  0  2  0  1 \\\\ 1  2  0  0  0 \\\\ 1  0  0  1  0 \\\\ 0  1  0  0  1 \\end{pmatrix}\n\\begin{pmatrix} \\Delta x_1 \\\\ \\Delta x_2 \\\\ \\Delta y \\\\ \\Delta s_1 \\\\ \\Delta s_2 \\end{pmatrix} =\n\\begin{pmatrix} 0 \\\\ -1 \\\\ 1 \\\\ -1/2 \\\\ -1/2 \\end{pmatrix} $$\n\n**2) 关于 $\\Delta y$ 的简化正规方程**\n\n为了得到仅含 $\\Delta y$ 的方程，我们消去 $\\Delta s$ 和 $\\Delta x$。\n从第一个块方程 $A^T \\Delta y + \\Delta s = r_d$ 中，我们求解 $\\Delta s$：\n$$ \\Delta s = r_d - A^T \\Delta y $$\n从第三个块方程 $S \\Delta x + X \\Delta s = r_c$ 中，我们求解 $\\Delta x$：\n$$ \\Delta x = S^{-1}(r_c - X \\Delta s) $$\n将 $\\Delta s$ 的表达式代入 $\\Delta x$ 的方程中：\n$$ \\Delta x = S^{-1}(r_c - X(r_d - A^T \\Delta y)) = S^{-1}r_c - S^{-1}X r_d + S^{-1}X A^T \\Delta y $$\n最后，将这个 $\\Delta x$ 的表达式代入第二个块方程 $A \\Delta x = r_p$ 中：\n$$ A(S^{-1}r_c - S^{-1}X r_d + S^{-1}X A^T \\Delta y) = r_p $$\n整理后得到关于 $\\Delta y$ 的正规方程：\n$$ (A S^{-1} X A^T) \\Delta y = r_p - A S^{-1} r_c + A S^{-1} X r_d $$\n对于我们的具体实例，$X = I_2$ 且 $S = I_2$，因此 $S^{-1} = I_2$。方程简化为：\n$$ (A A^T) \\Delta y = r_p - A r_c + A r_d $$\n我们逐项计算系数矩阵和右端项：\n- 系数矩阵：\n$$ A A^T = \\begin{bmatrix} 1  2 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 2 \\end{bmatrix} = (1)(1) + (2)(2) = 5 $$\n- 右端项：\n$$ r_p - A r_c + A r_d = 1 - \\begin{bmatrix} 1  2 \\end{bmatrix} \\begin{pmatrix} -1/2 \\\\ -1/2 \\end{pmatrix} + \\begin{bmatrix} 1  2 \\end{bmatrix} \\begin{pmatrix} 0 \\\\ -1 \\end{pmatrix} $$\n$$ = 1 - (1(-\\tfrac{1}{2}) + 2(-\\tfrac{1}{2})) + (1(0) + 2(-1)) = 1 - (-\\tfrac{1}{2} - 1) + (-2) = 1 - (-\\tfrac{3}{2}) - 2 = 1 + \\tfrac{3}{2} - 2 = \\tfrac{1}{2} $$\n显式简化正规方程为：\n$$ 5 \\Delta y = \\frac{1}{2} $$\n\n**3) 求解 $(\\Delta y, \\Delta s, \\Delta x)$ 并求出 $\\Delta x_1$**\n\n首先，求解关于 $\\Delta y$ 的正规方程：\n$$ \\Delta y = \\frac{1}{5} \\left(\\frac{1}{2}\\right) = \\frac{1}{10} $$\n接下来，使用步骤 2 中的表达式求解 $\\Delta s$：\n$$ \\Delta s = r_d - A^T \\Delta y = \\begin{pmatrix} 0 \\\\ -1 \\end{pmatrix} - \\begin{bmatrix} 1 \\\\ 2 \\end{bmatrix} \\left(\\frac{1}{10}\\right) = \\begin{pmatrix} 0 \\\\ -1 \\end{pmatrix} - \\begin{pmatrix} 1/10 \\\\ 2/10 \\end{pmatrix} = \\begin{pmatrix} -1/10 \\\\ -1 - 1/5 \\end{pmatrix} = \\begin{pmatrix} -1/10 \\\\ -6/5 \\end{pmatrix} $$\n最后，求解 $\\Delta x$。我们可以使用方程 $\\Delta x = S^{-1}(r_c - X \\Delta s)$。由于 $S=I$ 且 $X=I$：\n$$ \\Delta x = r_c - \\Delta s = \\begin{pmatrix} -1/2 \\\\ -1/2 \\end{pmatrix} - \\begin{pmatrix} -1/10 \\\\ -6/5 \\end{pmatrix} = \\begin{pmatrix} -\\frac{1}{2} + \\frac{1}{10} \\\\ -\\frac{1}{2} + \\frac{6}{5} \\end{pmatrix} $$\n$$ \\Delta x = \\begin{pmatrix} -\\frac{5}{10} + \\frac{1}{10} \\\\ -\\frac{5}{10} + \\frac{12}{10} \\end{pmatrix} = \\begin{pmatrix} -\\frac{4}{10} \\\\ \\frac{7}{10} \\end{pmatrix} = \\begin{pmatrix} -\\frac{2}{5} \\\\ \\frac{7}{10} \\end{pmatrix} $$\n作为检验，我们可以验证是否 $A \\Delta x = r_p$：\n$$ A \\Delta x = \\begin{bmatrix} 1  2 \\end{bmatrix} \\begin{pmatrix} -2/5 \\\\ 7/10 \\end{pmatrix} = -\\frac{2}{5} + 2\\left(\\frac{7}{10}\\right) = -\\frac{2}{5} + \\frac{7}{5} = \\frac{5}{5} = 1 $$\n这与 $r_p = 1$ 相符，因此计算是一致的。\n\n问题要求原始牛顿步的第一个分量 $\\Delta x_1$。\n$$ \\Delta x_1 = -\\frac{2}{5} $$", "answer": "$$\\boxed{-\\frac{2}{5}}$$", "id": "3208894"}]}