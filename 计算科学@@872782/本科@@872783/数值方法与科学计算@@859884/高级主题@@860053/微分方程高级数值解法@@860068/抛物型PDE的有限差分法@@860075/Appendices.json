{"hands_on_practices": [{"introduction": "本次实践将引导你从头到尾解决一个完整的问题：模拟一根同时向周围环境散热的杆中的热传递。这项练习旨在巩固你对整个数值工作流程的理解，从推导有限差分格式、分析其稳定性，到编写代码并与精确解进行比较 [@problem_id:3229635]。这是求解带源项或反应项的抛物型偏微分方程的一项基础实践。", "problem": "考虑一根长度为 $L$ 的一维细杆，其温度场 $u(x,t)$（单位：$\\mathrm{K}$）由包含向环境空气的分布热损失的线性热方程决定，\n$$\nu_t = k\\,u_{xx} - h\\left(u - u_{\\mathrm{amb}}\\right), \\quad 0  x  L,\\ t0,\n$$\n服从狄利克雷（Dirichlet）边界条件\n$$\nu(0,t) = u(L,t) = u_{\\mathrm{amb}},\n$$\n和初始条件\n$$\nu(x,0) = u_{\\mathrm{amb}} + A \\sin\\left(\\frac{n\\pi x}{L}\\right).\n$$\n其中，$k$ 是热扩散系数（单位：$\\mathrm{m}^2/\\mathrm{s}$），$h$ 是有效线性冷却系数（单位：$\\mathrm{s}^{-1}$），$u_{\\mathrm{amb}}$ 是环境温度（单位：$\\mathrm{K}$），$A$ 是初始模态振幅（单位：$\\mathrm{K}$），$n$ 是正整数模态指数。\n\n您的任务是：\n\n1. 从偏微分方程以及时间上的向前差分和空间上的中心差分的定义出发，针对变换后的变量 $v(x,t) = u(x,t) - u_{\\mathrm{amb}}$，在间距为 $\\Delta x$、时间步长为 $\\Delta t$ 的均匀网格上，推导出一个前向时间中心空间（FTCS）有限差分格式。清晰地陈述内部网格点的更新规则，以及如何用 $v$ 处理边界条件。\n\n2. 对 $v$ 的齐次问题使用冯·诺依曼（Von Neumann）（傅里葉）稳定性分析，为您在任务1中得到的显式FTCS格式推導出一个必要的稳定性条件。将该条件表示为一个关联 $\\Delta t$、$\\Delta x$、$k$ 和 $h$ 的约束。您的推导必须从傅里葉模态的离散放大因子开始，并施加稳定性所需的大小约束。\n\n3. 对于特殊初始条件 $v(x,0) = A \\sin\\left(\\frac{n\\pi x}{L}\\right)$ 和齐次狄利克雷边界条件 $v(0,t) = v(L,t) = 0$，推导连续问题的精确解 $v(x,t)$。然后，表示出 $u(x,t)$ 的精确解。\n\n4. 实现一个程序，该程序：\n   - 在 $[0,L]$ 上构建一个包含 $N$ 个子区间的均匀网格，因此网格点为 $x_j = j\\Delta x$，其中 $\\Delta x = L/N$ 且 $j=0,1,\\dots,N$。\n   - 对于 $j=0,\\dots,N$，初始化 $u_j^0 = u_{\\mathrm{amb}} + A \\sin\\left(\\frac{n\\pi x_j}{L}\\right)$，并对所有时间步 $n$ 强制执行边界条件 $u_0^n=u_N^n=u_{\\mathrm{amb}}$。\n   - 使用您在任务1中为 $v=u-u_{\\mathrm{amb}}$ 推导的显式FTCS更新规则，以步长 $\\Delta t$ 将解在时间上推进指定的 $M$ 个时间步。\n   - 在最终时间 $T = M\\Delta t$ 时，计算离散 $L^2$ 误差（单位：$\\mathrm{K}$）\n     $$\n     E = \\left(\\Delta x \\sum_{j=0}^{N} \\left[u_j^M - u_{\\mathrm{exact}}(x_j,T)\\right]^2 \\right)^{1/2},\n     $$\n     其中 $u_{\\mathrm{exact}}(x,T)$ 是任务3中得到的精确解。\n   - 独立地检查您在任务2中为所选的 $\\Delta t$ 和 $\\Delta x$ 推导出的理论稳定性条件，并返回一个布尔值，指示该条件是否成立。\n\n5. 使用以下测试套件。除非另有说明，取 $L=1\\,\\mathrm{m}$，$u_{\\mathrm{amb}}=300\\,\\mathrm{K}$，$A=2\\,\\mathrm{K}$，$n=1$，$N=50$。\n   - 测试 1 (正常路径)：$k=1\\times 10^{-4}\\,\\mathrm{m}^2/\\mathrm{s}$，$h=0.1\\,\\mathrm{s}^{-1}$，$\\Delta t=0.25\\,\\mathrm{s}$，$M=4$。\n   - 测试 2 (接近稳定性边界)：$k=1\\times 10^{-4}\\,\\mathrm{m}^2/\\mathrm{s}$，$h=0.1\\,\\mathrm{s}^{-1}$，令 $\\Delta t = 0.95 \\Delta t_{\\max}$，$M=4$，其中 $\\Delta t_{\\max}$ 是您在任务2中为给定的 $k$、$h$ 和 $\\Delta x$ 推導的稳定性条件所允许的最大时间步长。\n   - 测试 3 (违反稳定性)：$k=1\\times 10^{-4}\\,\\mathrm{m}^2/\\mathrm{s}$，$h=0.1\\,\\mathrm{s}^{-1}$，令 $\\Delta t = 1.05 \\Delta t_{\\max}$，$M=4$。\n   - 测试 4 (纯扩散极限)：$k=1\\times 10^{-4}\\,\\mathrm{m}^2/\\mathrm{s}$，$h=0\\,\\mathrm{s}^{-1}$，令 $\\Delta t = 0.49 \\Delta t_{\\max}$，$M=10$。\n   - 测试 5 (纯反应极限)：$k=0\\,\\mathrm{m}^2/\\mathrm{s}$，$h=2.0\\,\\mathrm{s}^{-1}$，取 $\\Delta t = 1.9/h\\,\\mathrm{s}$，$M=6$。\n\n6. 单位与输出：\n   - 所有长度单位必须是 $\\mathrm{m}$，时间单位是 $\\mathrm{s}$，温度单位是 $\\mathrm{K}$。\n   - 以 $\\mathrm{K}$ 为单位报告每个离散 $L^2$ 误差 $E$，四舍五入到六位小数。\n   - 对于每个测试，还需报告一个布尔值，指示您推导的理论稳定性条件对于所选的 $\\Delta t$ 和 $\\Delta x$ 是否成立。\n   - 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，顺序如下\n     $$\n     [E_1,\\ \\mathrm{stable}_1,\\ E_2,\\ \\mathrm{stable}_2,\\ E_3,\\ \\mathrm{stable}_3,\\ E_4,\\ \\mathrm{stable}_4,\\ E_5,\\ \\mathrm{stable}_5].\n     $$\n\n您的程序必须完全自包含，不接受任何外部输入，并直接实现上述测试。最终打印的输出必须是严格符合指定格式的一行。", "solution": "首先将对用户提供的问题进行严格的验证过程。\n\n### 步骤 1：提取给定信息\n\n**偏微分方程 (PDE):**\n$u_t = k\\,u_{xx} - h\\left(u - u_{\\mathrm{amb}}\\right)$, for $0  x  L$, $t>0$.\n\n**边界条件 (BCs):**\n$u(0,t) = u(L,t) = u_{\\mathrm{amb}}$.\n\n**初始条件 (IC):**\n$u(x,0) = u_{\\mathrm{amb}} + A \\sin\\left(\\frac{n\\pi x}{L}\\right)$.\n\n**定义：**\n- $u(x,t)$: 温度场，单位 $\\mathrm{K}$。\n- $k$: 热扩散系数，单位 $\\mathrm{m}^2/\\mathrm{s}$。\n- $h$: 有效线性冷却系数，单位 $\\mathrm{s}^{-1}$。\n- $u_{\\mathrm{amb}}$: 环境温度，单位 $\\mathrm{K}$。\n- $A$: 初始模态振幅，单位 $\\mathrm{K}$。\n- $n$: 正整数模态指数。\n- $L$: 杆的长度，单位 $\\mathrm{m}$。\n- 变换后的变量：$v(x,t) = u(x,t) - u_{\\mathrm{amb}}$。\n\n**网格参数：**\n- $N$: 子区间数量。\n- $\\Delta x = L/N$: 网格间距。\n- $x_j = j\\Delta x$ for $j=0,1,\\dots,N$: 网格点。\n- $\\Delta t$: 时间步长。\n- $M$: 时间步数。\n- $T = M\\Delta t$: 最终时间。\n\n**任务：**\n1. 为 $v(x,t)$ 推导前向时间中心空间 (FTCS) 有限差分格式。\n2. 为该格式推导冯·诺依曼（Von Neumann）稳定性条件。\n3. 推导精确解析解 $u_{\\mathrm{exact}}(x,t)$。\n4. 实现一个程序来数值求解该问题，计算离散 $L^2$ 误差，并检查稳定性。\n5. 为一组特定的五个测试用例执行程序。\n\n**误差度量：**\n离散 $L^2$ 误差：$E = \\left(\\Delta x \\sum_{j=0}^{N} \\left[u_j^M - u_{\\mathrm{exact}}(x_j,T)\\right]^2 \\right)^{1/2}$。\n\n**测试套件通用参数：**\n$L=1\\,\\mathrm{m}$, $u_{\\mathrm{amb}}=300\\,\\mathrm{K}$, $A=2\\,\\mathrm{K}$, $n=1$, $N=50$。\n\n**测试用例具体参数：**\n- 测试 1: $k=1\\times 10^{-4}\\,\\mathrm{m}^2/\\mathrm{s}$, $h=0.1\\,\\mathrm{s}^{-1}$, $\\Delta t=0.25\\,\\mathrm{s}$, $M=4$.\n- 测试 2: $k=1\\times 10^{-4}\\,\\mathrm{m}^2/\\mathrm{s}$, $h=0.1\\,\\mathrm{s}^{-1}$, $\\Delta t = 0.95 \\Delta t_{\\max}$, $M=4$.\n- 测试 3: $k=1\\times 10^{-4}\\,\\mathrm{m}^2/\\mathrm{s}$, $h=0.1\\,\\mathrm{s}^{-1}$, $\\Delta t = 1.05 \\Delta t_{\\max}$, $M=4$.\n- 测试 4: $k=1\\times 10^{-4}\\,\\mathrm{m}^2/\\mathrm{s}$, $h=0\\,\\mathrm{s}^{-1}$, $\\Delta t = 0.49 \\Delta t_{\\max}$, $M=10$.\n- 测试 5: $k=0\\,\\mathrm{m}^2/\\mathrm{s}$, $h=2.0\\,\\mathrm{s}^{-1}$, $\\Delta t = 1.9/h\\,\\mathrm{s}$, $M=6$.\n\n**输出格式：**\n单行文本：$[E_1, \\mathrm{stable}_1, E_2, \\mathrm{stable}_2, E_3, \\mathrm{stable}_3, E_4, \\mathrm{stable}_4, E_5, \\mathrm{stable}_5]$，误差四舍五入到六位小数。\n\n### 步骤 2：使用提取的给定信息进行验证\n\n- **科学上成立：** 该问题基于带有一阶反应项（牛顿冷却定律）的线性热方程，这是物理学和工程学中一个基础且成熟的模型。所有参数都具有物理意义。\n- **适定的：** 该问题是一个抛物型偏微分方程的标准初边值问题。初始条件和边界条件均已指定且一致，确保了连续问题存在唯一且稳定的解。\n- **客观的：** 问题由精确的数学方程和参数定义。任务是客观的，需要进行形式推导和计算。\n- **完整且一致的：** 每个测试用例所需的所有信息（$k$、$h$、$L$、$A$、$n$、$u_{\\mathrm{amb}}$、$N$、$M$、$\\Delta t$）均已直接提供或通过基于其他参数的公式提供。变换 $v=u-u_{\\mathrm{amb}}$ 是标准的，并一致地简化了偏微分方程和边界条件。\n- **可形式化且相关的：** 该问题与抛物型偏微分方程的有限差分法主题直接相关。它是数值分析和科学计算教学中使用的典型示例。\n\n### 步骤 3：结论与行动\n该问题在科学上是合理的，适定的，并且是完整的。所有任务都明确指定且在数学上是可处理的。该问题被判定为**有效**。将提供完整解答。\n\n### 解答推导\n\n#### 任务 1：FTCS 格式的推导\n我们从变换后的变量 $v(x,t) = u(x,t) - u_{\\mathrm{amb}}$ 开始。求偏导数，我们发现 $v_t = u_t$ 和 $v_{xx} = u_{xx}$。将这些代入原始偏微分方程，得到关于 $v$ 的齐次方程：\n$$\nv_t = k v_{xx} - h v\n$$\n边界条件变为 $v(0,t) = u(0,t) - u_{\\mathrm{amb}} = u_{\\mathrm{amb}} - u_{\\mathrm{amb}} = 0$ 和 $v(L,t) = u(L,t) - u_{\\mathrm{amb}} = u_{\\mathrm{amb}} - u_{\\mathrm{amb}} = 0$。\n\n令离散网格由 $x_j = j\\Delta x$ 和 $t_m = m\\Delta t$ 定义，并令 $v_j^m \\approx v(x_j, t_m)$。我们使用有限差分来近似导数：\n- 时间上的向前差分 (在 $t_m, x_j$): $v_t \\approx \\frac{v_j^{m+1} - v_j^m}{\\Delta t}$\n- 空间上的中心差分 (在 $t_m, x_j$): $v_{xx} \\approx \\frac{v_{j+1}^m - 2v_j^m + v_{j-1}^m}{(\\Delta x)^2}$\n\n将这些近似代入关于 $v$ 的偏微分方程中：\n$$\n\\frac{v_j^{m+1} - v_j^m}{\\Delta t} = k \\left( \\frac{v_{j+1}^m - 2v_j^m + v_{j-1}^m}{(\\Delta x)^2} \\right) - h v_j^m\n$$\n我们求解下一个时间步的温度 $v_j^{m+1}$：\n$$\nv_j^{m+1} = v_j^m + \\frac{k\\Delta t}{(\\Delta x)^2} (v_{j+1}^m - 2v_j^m + v_{j-1}^m) - h\\Delta t v_j^m\n$$\n令 $\\mu = \\frac{k\\Delta t}{(\\Delta x)^2}$ 为数值扩散数。整理各项，我们得到内部网格点（$j=1, 2, \\dots, N-1$）的FTCS更新规则：\n$$\nv_j^{m+1} = \\mu v_{j-1}^m + (1 - 2\\mu - h\\Delta t)v_j^m + \\mu v_{j+1}^m\n$$\n$v$ 的边界条件通过在所有时间步 $m$ 固定定义域边缘的值来处理：\n$$\nv_0^m = 0 \\quad \\text{and} \\quad v_N^m = 0\n$$\n\n#### 任务 2：Von Neumann 稳定性分析\n我们分析为 $v$ 推导的齐次格式的稳定性。我们假设一个形式为 $v_j^m = G^m e^{i\\kappa x_j}$ 的傅立叶单模解，其中 $G$ 是放大因子，$\\kappa$ 是波数。将其代入更新规则中：\n$$\nG^{m+1} e^{i\\kappa j\\Delta x} = \\mu G^m e^{i\\kappa (j-1)\\Delta x} + (1 - 2\\mu - h\\Delta t)G^m e^{i\\kappa j\\Delta x} + \\mu G^m e^{i\\kappa (j+1)\\Delta x}\n$$\n两边除以 $G^m e^{i\\kappa j\\Delta x}$，得到 $G$ 的表达式：\n$$\nG = \\mu e^{-i\\kappa\\Delta x} + (1 - 2\\mu - h\\Delta t) + \\mu e^{i\\kappa\\Delta x}\n$$\n使用恒等式 $e^{i\\theta} + e^{-i\\theta} = 2\\cos(\\theta)$:\n$$\nG = 1 - 2\\mu - h\\Delta t + 2\\mu \\cos(\\kappa\\Delta x) = 1 - h\\Delta t - 2\\mu(1 - \\cos(\\kappa\\Delta x))\n$$\n使用半角恒等式 $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$:\n$$\nG = 1 - h\\Delta t - 4\\mu \\sin^2\\left(\\frac{\\kappa\\Delta x}{2}\\right)\n$$\n为使格式稳定，对于所有可能的波数，放大因子的模必须小于或等于1，即 $|G| \\leq 1$。这等价于 $-1 \\leq G \\leq 1$。\n\n上界 $G \\leq 1$ 意味着 $1 - h\\Delta t - 4\\mu \\sin^2(\\frac{\\kappa\\Delta x}{2}) \\leq 1$，简化为 $-h\\Delta t - 4\\mu \\sin^2(\\frac{\\kappa\\Delta x}{2}) \\leq 0$。由于 $h \\ge 0$，$\\Delta t > 0$，$\\mu \\ge 0$，以及 $\\sin^2(\\cdot) \\ge 0$，此条件总是满足的。\n\n下界 $G \\geq -1$ 意味着：\n$$\n1 - h\\Delta t - 4\\mu \\sin^2\\left(\\frac{\\kappa\\Delta x}{2}\\right) \\ge -1\n$$\n$$\n2 \\ge h\\Delta t + 4\\mu \\sin^2\\left(\\frac{\\kappa\\Delta x}{2}\\right)\n$$\n这个不等式必须对所有 $\\kappa$ 都成立。对于网格所能支持的最高频率模态，$\\sin^2(\\frac{\\kappa\\Delta x}{2})$ 项最大化为 $1$。因此，我们要求：\n$$\n2 \\ge h\\Delta t + 4\\mu\n$$\n代入 $\\mu = \\frac{k\\Delta t}{(\\Delta x)^2}$:\n$$\n2 \\ge h\\Delta t + \\frac{4k\\Delta t}{(\\Delta x)^2} = \\Delta t \\left( h + \\frac{4k}{(\\Delta x)^2} \\right)\n$$\n因此，必要的稳定性条件是：\n$$\n\\Delta t \\le \\frac{2}{h + \\frac{4k}{(\\Delta x)^2}}\n$$\n\n#### 任务 3：精确解的推导\n我们求解偏微分方程 $v_t = k v_{xx} - h v$，其边界条件为 $v(0,t)=v(L,t)=0$，初始条件为 $v(x,0) = A \\sin(\\frac{n\\pi x}{L})$。我们使用分离变量法，假设解的形式为 $v(x,t) = X(x)T(t)$。代入偏微分方程得到：\n$$\nX(x)T'(t) = k X''(x)T(t) - h X(x)T(t)\n$$\n两边除以 $kX(x)T(t)$，我们可以分离变量：\n$$\n\\frac{T'(t)}{k T(t)} + \\frac{h}{k} = \\frac{X''(x)}{X(x)} = -\\sigma^2\n$$\n其中 $-\\sigma^2$ 是分离常数。这给出了两个常微分方程：\n1. 空间部分：$X''(x) + \\sigma^2 X(x) = 0$，其中 $X(0)=0, X(L)=0$。\n2. 时间部分：$T'(t) + (h+k\\sigma^2)T(t) = 0$。\n\n空间部分是一个标准的Sturm-Liouville问题，其满足边界条件的特征函数为 $X_m(x) = \\sin(\\sigma_m x)$，其中 $\\sigma_m = \\frac{m\\pi}{L}$，整数 $m \\ge 1$。\n\n对于每个模态 $m$，时间方程为 $T_m'(t) + (h+k(\\frac{m\\pi}{L})^2)T_m(t) = 0$，其解为 $T_m(t) = C_m \\exp\\left(-\\left(h+k(\\frac{m\\pi}{L})^2\\right)t\\right)$。\n\n$v(x,t)$ 的通解是这些模态的叠加：\n$$\nv(x,t) = \\sum_{m=1}^{\\infty} C_m \\sin\\left(\\frac{m\\pi x}{L}\\right) \\exp\\left(-\\left(h + k\\left(\\frac{m\\pi}{L}\\right)^2\\right)t\\right)\n$$\n为了找到系数 $C_m$，我们在 $t=0$ 时应用初始条件：\n$$\nv(x,0) = \\sum_{m=1}^{\\infty} C_m \\sin\\left(\\frac{m\\pi x}{L}\\right) = A \\sin\\left(\\frac{n\\pi x}{L}\\right)\n$$\n通过将级数与初始条件进行比较（或利用正弦函数的正交性），我们发现除了 $C_n = A$ 外，所有系数均为零。这是因为初始条件本身已经是空间算子的单个特征函数。\n\n因此，$v(x,t)$ 的精确解为：\n$$\nv(x,t) = A \\sin\\left(\\frac{n\\pi x}{L}\\right) \\exp\\left(-\\left(h + k\\left(\\frac{n\\pi}{L}\\right)^2\\right)t\\right)\n$$\n变换回 $u(x,t) = v(x,t) + u_{\\mathrm{amb}}$，我们得到温度的精确解：\n$$\nu_{\\mathrm{exact}}(x,t) = u_{\\mathrm{amb}} + A \\sin\\left(\\frac{n\\pi x}{L}\\right) \\exp\\left(-\\left(h + k\\left(\\frac{n\\pi}{L}\\right)^2\\right)t\\right)\n$$", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the heat equation problem for a suite of test cases.\n    It implements the FTCS scheme, computes the L2 error against the\n    exact solution, and checks the theoretical stability condition.\n    \"\"\"\n\n    # --- Common parameters ---\n    L = 1.0  # m\n    u_amb = 300.0  # K\n    A = 2.0  # K\n    n_mode = 1  # integer mode index\n    N = 50  # number of subintervals\n    \n    dx = L / N\n    x = np.linspace(0, L, N + 1)\n    \n    # --- Test suite definition ---\n    test_cases = [\n        # (k, h, dt_spec, M) where dt_spec can be a value or a string\n        # 'max_stable' means dt = dt_max * factor\n        # Test 1\n        {'k': 1e-4, 'h': 0.1, 'dt_spec': ('val', 0.25), 'M': 4},\n        # Test 2\n        {'k': 1e-4, 'h': 0.1, 'dt_spec': ('max_stable', 0.95), 'M': 4},\n        # Test 3\n        {'k': 1e-4, 'h': 0.1, 'dt_spec': ('max_stable', 1.05), 'M': 4},\n        # Test 4\n        {'k': 1e-4, 'h': 0.0, 'dt_spec': ('max_stable', 0.49), 'M': 10},\n        # Test 5\n        {'k': 0.0, 'h': 2.0, 'dt_spec': ('h_rel', 1.9), 'M': 6},\n    ]\n\n    results = []\n\n    for case in test_cases:\n        k = case['k']\n        h = case['h']\n        M = case['M']\n        dt_spec_type, dt_spec_val = case['dt_spec']\n\n        # --- Calculate dt_max and dt for the current test case ---\n        # The stability limit denominator can be zero if k=0 and h=0, handle this.\n        stability_denom = h + (4 * k / (dx**2))\n        dt_max = 2.0 / stability_denom if stability_denom > 0 else np.inf\n\n        if dt_spec_type == 'val':\n            dt = dt_spec_val\n        elif dt_spec_type == 'max_stable':\n            dt = dt_spec_val * dt_max\n        elif dt_spec_type == 'h_rel':\n            dt = dt_spec_val / h\n        else:\n            raise ValueError(\"Invalid dt_spec type\")\n\n        # --- Stability Check ---\n        # Use a small tolerance for floating point comparison\n        is_stable = dt = dt_max + 1e-9  \n        results.append(is_stable)\n\n        # --- Initialization ---\n        # Initialize v, as the scheme is for v = u - u_amb\n        v0 = A * np.sin(n_mode * np.pi * x / L)\n        v_current = v0.copy()\n\n        # --- Time Evolution (FTCS) ---\n        mu = k * dt / (dx**2)\n        \n        for _ in range(M):\n            v_next = np.zeros(N + 1) # Enforces v=0 at boundaries\n            for j in range(1, N):\n                v_next[j] = mu * v_current[j-1] \\\n                          + (1 - 2*mu - h*dt) * v_current[j] \\\n                          + mu * v_current[j+1]\n            v_current = v_next\n\n        # --- Error Calculation ---\n        T_final = M * dt\n        \n        # Numerical solution for u\n        u_numerical = v_current + u_amb\n\n        # Exact solution for u\n        decay_exponent = -(h + k * (n_mode * np.pi / L)**2) * T_final\n        v_exact = A * np.sin(n_mode * np.pi * x / L) * np.exp(decay_exponent)\n        u_exact = v_exact + u_amb\n        \n        # Discrete L2 error\n        error_sq_sum = np.sum((u_numerical - u_exact)**2)\n        l2_error = np.sqrt(dx * error_sq_sum)\n        \n        # Insert error before the stability boolean in the results list\n        results.insert(-1, f\"{l2_error:.6f}\")\n        \n    # Python booleans need to be lowercase as per some conventions, but\n    # the problem doesn't specify. str(True) -> 'True', so we convert.\n    formatted_results = [str(r).lower() if isinstance(r, bool) else r for r in results]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "3229635"}, {"introduction": "现实世界中的系统通常由具有不同属性的多种材料构成。本次实践将挑战你模拟一根复合杆，这需要你对材料界面处的基本物理原理有更深入的理解 [@problem_id:3229593]。通过从守恒定律推导界面条件并实施一个守恒的数值格式，你将学会如何精确地模拟非均匀介质中的热传递。", "problem": "考虑一个占据区间 $[0,L]$ 的一维复合杆，由两种均匀材料在界面位置 $x_0 \\in (0,L)$ 连接而成。热扩散系数是分段常数，在 $[0,x_0]$ 上等于 $k_1$，在 $(x_0,L]$ 上等于 $k_2$。温度 $u(x,t)$ 根据瞬态热方程（一个线性抛物型偏微分方程）和狄利克雷边界条件演化：\n$$\n\\frac{\\partial u}{\\partial t}(x,t) \\;=\\; \\frac{\\partial}{\\partial x}\\Big(k(x)\\,\\frac{\\partial u}{\\partial x}(x,t)\\Big), \\quad x \\in (0,L),\\; t0,\n$$\n$$\nu(0,t) \\;=\\; T_L,\\quad u(L,t) \\;=\\; T_R,\\quad t \\ge 0,\n$$\n$$\nu(x,0) \\;=\\; u_0(x), \\quad x \\in [0,L],\n$$\n其中分段常数热扩散系数为\n$$\nk(x) \\;=\\; \\begin{cases}\nk_1,  0 \\le x \\le x_0,\\\\\nk_2,  x_0  x \\le L.\n\\end{cases}\n$$\n使用能量守恒基本原理和傅里叶热传导定律，推导在 $x=x_0$ 处对所有 $t0$ 都必须成立的物理上正确的界面条件，然后构造一个在离散方程中强制执行这些条件的有限差分方法。\n\n您的推导必须从以下基本基础开始：\n- 控制体上的能量守恒，即内能的变化率等于流入该体积的净热通量。\n- 傅里叶定律 $q(x,t) = -\\,k(x)\\,\\dfrac{\\partial u}{\\partial x}(x,t)$。\n- 微分算子的散度形式 $\\dfrac{\\partial}{\\partial x}\\big(k(x)\\,\\dfrac{\\partial u}{\\partial x}\\big)$。\n\n将空间域离散化为包含 $N$ 个子区间的均匀网格，网格间距为 $h=L/N$，节点为 $x_i=i\\,h$, $i=0,1,\\dots,N$。假设通过选择 $N$ 使得 $x_0/h$ 为整数，界面与一个网格节点对齐。使用时间步长为 $\\Delta t0$ 的后向欧拉法进行时间离散。对于空间离散，使用在每个内部节点 $x_i$ 处的保守面通量平衡来近似散度形式的算子：\n$$\n\\big((k u_x)_x\\big)\\big|_{x_i} \\;\\approx\\; \\frac{1}{h}\\left[\\;k_{i+\\frac{1}{2}}\\;\\frac{u_{i+1}-u_i}{h}\\;-\\;k_{i-\\frac{1}{2}}\\;\\frac{u_i-u_{i-1}}{h}\\;\\right],\n$$\n其中 $k_{i+\\frac{1}{2}}$ 是与 $x_i$ 和 $x_{i+1}$ 之间面相关的扩散系数，其选择与占据该面的材料一致。在所有时间层 $t^n=n\\,\\Delta t$ 强制执行 $u_0^n=T_L$ 和 $u_N^n=T_R$。\n\n您还必须：\n- 从所述原理推导 $x=x_0$ 处的界面条件，并解释离散通量平衡如何在不引入界面节点处任何特定约束的情况下强制执行这些条件。\n- 通过分段积分并使用您推导出的物理上正确的界面条件，推导求解 $\\dfrac{d}{dx}\\big(k(x)\\,\\dfrac{du}{dx}\\big)=0$ 且满足 $u(0)=T_L$ 和 $u(L)=T_R$ 的稳态解析温度分布 $u_\\infty(x)$。用 $L$、$x_0$、$k_1$、$k_2$、$T_L$ 和 $T_R$ 表示 $x\\in[0,L]$ 上 $u_\\infty(x)$ 的闭合形式表达式。\n\n实现要求：\n- 实现应用于上述保守空间离散的时间上的后向欧拉法。从 $t=0$ 开始，使用初始条件 $u_0(x)\\equiv 0$ 进行时间推进，直到收敛到稳态。稳态的判断条件为 $\\|u^{n+1}-u^n\\|_\\infty  \\varepsilon$，其中 $\\varepsilon$ 是给定的容差。\n- 如果面位于 $[0,x_0)$ 内，则使用基于面的扩散系数 $k_{i+\\frac{1}{2}} = k_1$；如果面位于 $(x_0,L]$ 内，则使用 $k_{i+\\frac{1}{2}} = k_2$。由于 $x_0$ 与一个网格节点对齐，没有面会跨越界面。\n- 收敛后，计算所有网格节点上的最大范数误差 $E=\\|u^{n}-u_\\infty\\|_\\infty$。\n\n测试套件：\n为以下3个参数集提供结果，每个参数集都旨在测试该方法的一个不同方面。在所有情况下，取 $L=1$ 和初始条件 $u_0(x)\\equiv 0$。\n- 情况A（一般非对称界面耦合）：$k_1=1$, $k_2=5$, $x_0=0.4$, $T_L=0$, $T_R=1$, $N=100$, $\\Delta t=0.2$, $\\varepsilon=10^{-12}$。\n- 情况B（均匀介质一致性检查）：$k_1=1$, $k_2=1$, $x_0=0.3$, $T_L=0$, $T_R=1$, $N=120$, $\\Delta t=0.2$, $\\varepsilon=10^{-12}$。\n- 情况C（恒定边界平衡）：$k_1=2$, $k_2=0.5$, $x_0=0.25$, $T_L=0.3$, $T_R=0.3$, $N=64$, $\\Delta t=0.2$, $\\varepsilon=10^{-12}$。\n\n答案规范：\n- 对于每种情况，将标量最大范数误差 $E$ 输出为浮点数。\n- 您的程序应生成单行输出，其中包含以逗号分隔并用方括号括起来的结果列表，顺序为 [情况A, 情况B, 情况C]。例如，格式必须与“[0.001,0.002,0.003]”完全相同。", "solution": "问题陈述具有科学依据、良定、客观且自洽。它提出了一个计算传热学中的标准问题，基于复合介质的热方程。所提出的参数和方法与已建立的物理学和数值分析原理一致。因此，该问题被认为是有效的。\n\n### 界面条件的推导\n\n控制偏微分方程以散度形式给出，\n$$\n\\frac{\\partial u}{\\partial t} \\;=\\; \\frac{\\partial}{\\partial x}\\left(k(x)\\,\\frac{\\partial u}{\\partial x}\\right).\n$$\n这种形式源于能量守恒原理。让我们考虑一个以材料界面 $x_0$ 为中心的无穷小控制体 $V = [x_0 - \\epsilon, x_0 + \\epsilon]$，其中 $\\epsilon  0$ 是一个小数。该体积内热能的变化率必须等于穿过其边界的净热通量。\n$$\n\\frac{d}{dt} \\int_{x_0-\\epsilon}^{x_0+\\epsilon} \\rho c_p u(x,t) \\, dx \\;=\\; q(x_0-\\epsilon, t) - q(x_0+\\epsilon, t)\n$$\n其中 $\\rho$ 是密度，$c_p$ 是比热容，$q(x,t)$ 是热通量。假设温度 $u(x,t)$ 和材料属性有界，当我们通过取极限 $\\epsilon \\to 0$ 使体积收缩时，左侧的积分消失。\n$$\n\\lim_{\\epsilon \\to 0} \\left( \\frac{d}{dt} \\int_{x_0-\\epsilon}^{x_0+\\epsilon} \\rho c_p u(x,t) \\, dx \\right) \\;=\\; 0\n$$\n这意味着进入这个极小体积的净通量必须为零：\n$$\n\\lim_{\\epsilon \\to 0} \\big( q(x_0-\\epsilon, t) - q(x_0+\\epsilon, t) \\big) \\;=\\; 0\n$$\n这导致了第一个界面条件：热通量必须跨界面连续。\n$$\nq(x_0^-, t) \\;=\\; q(x_0^+, t)\n$$\n其中 $q(x_0^-)$ 是从左侧接近的通量，$q(x_0^+)$ 是从右侧接近的通量。代入傅里叶热传导定律 $q(x,t) = -k(x)\\frac{\\partial u}{\\partial x}(x,t)$，并使用 $k(x)$ 的分段定义，我们得到通量连续性条件：\n$$\n-k_1 \\frac{\\partial u}{\\partial x}(x_0^-, t) \\;=\\; -k_2 \\frac{\\partial u}{\\partial x}(x_0^+, t) \\quad \\implies \\quad k_1 \\frac{\\partial u}{\\partial x}(x_0^-, t) \\;=\\; k_2 \\frac{\\partial u}{\\partial x}(x_0^+, t).\n$$\n第二个界面条件是温度的连续性。某一点的温度不连续将意味着无限大的温度梯度，根据傅里叶定律，这将导致不符合物理的无限大热通量。因此，对于所有 $t0$：\n$$\nu(x_0^-, t) \\;=\\; u(x_0^+, t).\n$$\n\n### 稳态解析解\n\n在稳态下，温度分布 $u_\\infty(x)$ 与时间无关，因此 $\\frac{\\partial u}{\\partial t}=0$。控制方程简化为一个常微分方程：\n$$\n\\frac{d}{dx}\\left(k(x)\\,\\frac{du_\\infty}{dx}\\right) \\;=\\; 0.\n$$\n对 $x$ 积分一次表明，整个区域内的热通量是恒定的：\n$$\nk(x)\\,\\frac{du_\\infty}{dx} \\;=\\; -C_1,\n$$\n其中 $C_1$ 是一个代表通量的常数。这等价于陈述 $q(x) = C_1$。由于温度分布是分段线性的，我们可以写出：\n$$\nu_\\infty(x) \\;=\\; \\begin{cases} A_1 x + B_1,  0 \\le x \\le x_0 \\\\ A_2 x + B_2,  x_0  x \\le L \\end{cases}\n$$\n常数 $A_1, B_1, A_2, B_2$ 由边界和界面条件确定。\n$1$. $x=0$ 处的边界条件：$u_\\infty(0) = T_L \\implies A_1(0) + B_1 = T_L \\implies B_1 = T_L$。\n$2$. $x=L$ 处的边界条件：$u_\\infty(L) = T_R \\implies A_2 L + B_2 = T_R \\implies B_2 = T_R - A_2 L$。\n这使我们可以将第二段的解重写为 $u_\\infty(x) = A_2(x-L) + T_R$。\n$3$. $x=x_0$ 处的温度连续性：$u_\\infty(x_0^-) = u_\\infty(x_0^+)$。\n$$\nA_1 x_0 + T_L \\;=\\; A_2(x_0-L) + T_R.\n$$\n$4$. $x=x_0$ 处的通量连续性：$k_1 u'_\\infty(x_0^-) = k_2 u'_\\infty(x_0^+)$。从线性形式可知，$x_0$处的导数就是斜率：\n$$\nk_1 A_1 = k_2 A_2.\n$$\n将 $A_2 = \\frac{k_1}{k_2}A_1$ 代入温度连续性方程，我们得到\n$$\nA_1 x_0 + T_L = \\frac{k_1}{k_2} A_1 (x_0 - L) + T_R \\implies A_1 \\left(x_0 - \\frac{k_1}{k_2}(x_0-L)\\right) = T_R - T_L.\n$$\n这得到\n$$\nA_1 = \\frac{k_2(T_R - T_L)}{k_2 x_0 - k_1(x_0-L)} = \\frac{k_2(T_R - T_L)}{k_1(L-x_0) + k_2 x_0}, \\quad A_2 = \\frac{k_1(T_R - T_L)}{k_1(L-x_0) + k_2 x_0}.\n$$\n因此，稳态解是\n$$\nu_\\infty(x) \\;=\\; \\begin{cases}\n \\frac{k_2(T_R - T_L)}{k_1(L-x_0) + k_2 x_0} x + T_L,  \\text{if } 0 \\le x \\le x_0 \\\\\n \\frac{k_1(T_R - T_L)}{k_1(L-x_0) + k_2 x_0} (x-L) + T_R,  \\text{if } x_0  x \\le L\n\\end{cases}\n$$\n\n### 离散化方案\n\n使用后向欧拉法，时间导数在 $n+1$ 时刻近似，而空间导数也一样。\n$$\n\\frac{u_i^{n+1} - u_i^n}{\\Delta t} = \\frac{1}{h}\\left[ k_{i+\\frac{1}{2}} \\frac{u_{i+1}^{n+1}-u_i^{n+1}}{h} - k_{i-\\frac{1}{2}} \\frac{u_i^{n+1}-u_{i-1}^{n+1}}{h} \\right]\n$$\n整理后得到一个关于 $u_i^{n+1}$ 的线性方程组：\n$$\n-\\lambda k_{i-\\frac{1}{2}} u_{i-1}^{n+1} + (1 + \\lambda(k_{i-\\frac{1}{2}} + k_{i+\\frac{1}{2}})) u_i^{n+1} - \\lambda k_{i+\\frac{1}{2}} u_{i+1}^{n+1} = u_i^n,\n$$\n其中 $\\lambda = \\frac{\\Delta t}{h^2}$。该方程组可以写成一个三对角矩阵系统，在每个时间步求解。\n\n面扩散系数 $k_{i+1/2}$ 的选择取决于面 $x_{i+1/2}$ 的位置。如果 $x_{i+1/2}  x_0$，则 $k_{i+1/2}=k_1$。如果 $x_{i+1/2} > x_0$，则 $k_{i+1/2}=k_2$。因为界面 $x_0$ 与某个节点 $x_j$ 对齐，所以 $x_0$ 绝不会恰好位于一个面的中间。\n\n这种保守的离散化自动强制执行通量连续性。在界面节点 $x_j=x_0$ 处，格式变为\n$$\n\\dots (1 + \\lambda(k_{j-\\frac{1}{2}} + k_{j+\\frac{1}{2}})) u_j^{n+1} \\dots\n$$\n其中 $k_{j-1/2} = k_1$ 且 $k_{j+1/2} = k_2$。这正确地混合了来自两个区域的影响，而无需任何特殊的界面方程。\n```python\ndef solve_case(L, k1, k2, x0, TL, TR, N, dt, epsilon):\n    # ...\n    den = k1 * (L - x0) + k2 * x0\n    if abs(den)  1e-15:\n        # ...\n    \n    u_inf = np.piecewise(x, [x = x0, x > x0],\n                         # ...\n                         )\n\n    # ...\n    \n    # A is of size (N-1)x(N-1)\n    A = np.zeros((N - 1, N - 1))\n    \n    # Populate the diagonals of A\n    for i in range(N - 1):\n        phys_i = i + 1\n        # Main diagonal\n        A[i, i] = 1 + lam * (k_face[phys_i] + k_face[phys_i - 1])\n        # Lower diagonal\n        if i > 0:\n            A[i, i - 1] = -lam * k_face[phys_i - 1]\n        # Upper diagonal\n        if i  N - 2:\n            A[i, i + 1] = -lam * k_face[phys_i]\n\n    # ... Time-stepping loop\n    for _ in range(max_iter):\n        # ...\n        # Check for convergence using the infinity norm\n        if np.max(np.abs(u_new - u_old))  epsilon:\n            break\n        # ...\n```", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve_case(L, k1, k2, x0, TL, TR, N, dt, epsilon):\n    \"\"\"\n    Solves the 1D transient heat equation for a composite rod until steady state\n    and computes the error against the analytical solution.\n    \"\"\"\n    # 1. Grid and problem parameters\n    h = L / N\n    x = np.linspace(0, L, N + 1)\n    # The interface node index j is such that x_j = x0\n    j = int(round(x0 / h))\n\n    # 2. Analytical steady-state solution u_inf(x)\n    # The solution is piecewise linear: u(x) = A*x + B\n    # For segment 1 (x in [0, x0]): u1(x) = A1*x + TL\n    # For segment 2 (x in (x0, L]): u2(x) = A2*(x-L) + TR\n    den = k1 * (L - x0) + k2 * x0\n    if abs(den)  1e-15:\n        # This occurs only in trivial or unphysical cases, e.g., L=0.\n        # For k1=k2, den = k1*L. If L=0, it's 0.\n        # The main logic below correctly handles k1=k2 by having A1=A2.\n        # This is a safe guard.\n        if abs(TR-TL)  1e-15:\n            A1, A2 = 0, 0\n        else: # Unphysical, infinite flux case\n            # This branch should not be reached by the given test cases.\n            A1, A2 = np.inf, np.inf\n    else:\n        A1 = k2 * (TR - TL) / den\n        A2 = k1 * (TR - TL) / den\n    \n    u_inf = np.piecewise(x, [x = x0, x > x0],\n                         [lambda xi: A1 * xi + TL,\n                          lambda xi: A2 * (xi - L) + TR])\n\n    # 3. Numerical method setup\n    \n    # Face diffusivities k_{i+1/2}. k_face[i] corresponds to face between i and i+1.\n    k_face = np.zeros(N)\n    k_face[:j] = k1\n    k_face[j:] = k2\n\n    # Tridiagonal matrix A for the system Au_new = b for interior nodes\n    lam = dt / (h * h)\n    \n    # A is of size (N-1)x(N-1)\n    A = np.zeros((N - 1, N - 1))\n    \n    # Populate the diagonals of A. Row `i` (0-indexed) corresponds to spatial node `i+1`.\n    for i in range(N - 1):\n        phys_i = i + 1\n        # Main diagonal\n        A[i, i] = 1 + lam * (k_face[phys_i] + k_face[phys_i - 1])\n        # Lower diagonal\n        if i > 0:\n            A[i, i - 1] = -lam * k_face[phys_i - 1]\n        # Upper diagonal\n        if i  N - 2:\n            A[i, i + 1] = -lam * k_face[phys_i]\n\n    # 4. Time-stepping loop\n    u_old = np.zeros(N + 1)\n    # The problem specifies u_0(x) = 0 for x in [0,L], but also gives BCs for t>=0.\n    # The standard interpretation is that the initial state u(x,0) is zero in the\n    # interior (0,L), and the boundary values are set at t=0.\n    u_old[0], u_old[N] = TL, TR\n    u_new = u_old.copy()\n\n    # Safety break for the loop\n    max_iter = 50000\n    for _ in range(max_iter):\n        # Right-hand side vector b (size N-1)\n        b = u_old[1:N].copy()\n        \n        # Add boundary condition terms to the first and last elements of b\n        b[0] += lam * k_face[0] * TL\n        b[N - 2] += lam * k_face[N - 1] * TR\n        \n        # Solve the linear system Au_new = b for interior nodes\n        u_new[1:N] = np.linalg.solve(A, b)\n        \n        # Check for convergence using the infinity norm\n        if np.max(np.abs(u_new - u_old))  epsilon:\n            break\n            \n        u_old[:] = u_new[:]\n    \n    # 5. Compute max-norm error against analytical steady-state solution\n    error = np.max(np.abs(u_new - u_inf))\n    \n    return error\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print results.\n    \"\"\"\n    # Test cases: (L, k1, k2, x0, TL, TR, N, dt, epsilon)\n    test_cases = [\n        # Case A: General asymmetric interface coupling\n        (1.0, 1.0, 5.0, 0.4, 0.0, 1.0, 100, 0.2, 1e-12),\n        # Case B: Uniform medium consistency check\n        (1.0, 1.0, 1.0, 0.3, 0.0, 1.0, 120, 0.2, 1e-12),\n        # Case C: Constant boundary equilibrium\n        (1.0, 2.0, 0.5, 0.25, 0.3, 0.3, 64, 0.2, 1e-12),\n    ]\n\n    results = []\n    for params in test_cases:\n        error = solve_case(*params)\n        results.append(error)\n\n    # Format the output as a comma-separated list in brackets\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3229593"}, {"introduction": "并非所有源于物理的方程都能按我们预期的方式求解。这最后一个实践将探索“反向热方程”，这是一个典型的“不适定问题”(ill-posed problem)，其解对微小扰动极其敏感 [@problem_id:3229600]。通过稳定性分析和数值实验，你将发现为什么将扩散过程反向进行会导致爆炸性的、非物理的增长，并对问题的数学结构与其数值可解性之间的联系获得关键的洞察。", "problem": "考虑反向热传导方程，这是一个定义在一维周期性域上的抛物线型偏微分方程 (PDE)，由 $u_t = -u_{xx}$ 在 $x \\in [0,1]$ 上给出，具有周期性边界条件，且所有量均为无量纲单位。任务是使用有限差分法 (FDM) 来研究在计算时间上正向求解该方程的数值后果，并解释为何该问题是不适定的。从以下基本基础出发：时间一阶导数和空间二阶导数的定义、数值格式的相容性和稳定性概念，以及在适定问题中，初始数据的微小扰动不应导致无界增长的思想。\n\n使用具有 $N$ 个点的均匀网格，网格间距为 $\\Delta x = 1/N$，以及均匀的时间步长 $\\Delta t$。定义网格索引 $j \\in \\{0,1,\\dots,N-1\\}$ 和时间索引 $n \\in \\{0,1,2,\\dots\\}$。对于空间二阶导数，在点 $x_j$ 处使用标准的二阶中心差分近似：\n$$u_{xx}(x_j,t) \\approx \\frac{u(x_{j+1},t) - 2 u(x_j,t) + u(x_{j-1},t)}{(\\Delta x)^2}.$$\n对于时间导数，考虑三种经典的单步法：\n- 前向欧拉法（显式）：在时间层 $n$ 用前向差分近似 $u_t$。\n- 后向欧拉法（隐式）：在时间层 $n+1$ 用后向差分近似 $u_t$。\n- Crank–Nicolson 法（半隐式）：在时间上使用梯形法则，使得空间二阶导数在时间层 $n$ 和 $n+1$ 之间取平均。\n\n通过考虑傅里叶模态 $\\exp(i \\theta j)$（其中 $\\theta$ 以弧度为单位）来进行 von Neumann 分析。推导每种方法的放大因子 $g(\\theta,r)$，其中 $r = \\Delta t / (\\Delta x)^2$。基于推导出的 $g(\\theta,r)$，解释为什么反向热传导方程对于这三种方法都是数值不稳定的，并将其与连续问题的潜在不适定性（对高频分量的敏感性）联系起来。\n\n然后，编写一个程序，对于大小为 $N$ 的网格上的单个傅里叶模态 $k$，计算角度 $\\theta = 2\\pi k / N$（以弧度为单位），并为所选方法评估每时间步的绝对放大率 $|g(\\theta,r)|$。程序随后应输出经过 $n_{\\text{steps}}$ 个时间步后，最终 $L^2$ 范数与初始 $L^2$ 范数的比值，当从单个傅里叶模态开始时，该比值等于 $|g(\\theta,r)|^{n_{\\text{steps}}}$。所有量均为无量纲，且角度必须以弧度为单位。\n\n使用以下参数值测试套件来检验不同的情况：\n- 测试 $1$ (显式增长的理想路径): 方法 = 前向欧拉法, $N = 64$, $k = 32$, $r = 0.1$, $n_{\\text{steps}} = 10$。\n- 测试 $2$ (隐式强增长但有限): 方法 = 后向欧拉法, $N = 64$, $k = 32$, $r = 0.24$, $n_{\\text{steps}} = 5$。\n- 测试 $3$ (中频下的半隐式增长): 方法 = Crank–Nicolson 法, $N = 64$, $k = 16$, $r = 0.2$, $n_{\\text{steps}} = 8$。\n- 测试 $4$ (隐式近奇异放大): 方法 = 后向欧拉法, $N = 64$, $k = 32$, $r = 0.249$, $n_{\\text{steps}} = 1$。\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，每个结果四舍五入到六位小数（例如，$\\texttt{[1.234567,8.765432,2.000000,0.500000]}$）。", "solution": "所述问题是有效的。这是一个关于不适定的反向热传导方程数值性质的适定探究，使用了数值分析中标准的、可验证的方法。所有必需的数据和定义都已提供，并且问题具有科学依据、客观且内部一致。因此，我们可以着手解决。\n\n该问题要求分析反向热传导方程，这是一个在一维周期性域 $x \\in [0,1]$ 上由\n$$u_t = -u_{xx}$$\n给出的抛物线型偏微分方程 (PDE)。该方程描述了一个反向运行的扩散过程。标准（正向）热传导方程 $u_t = u_{xx}$ 是一个平滑初始数据的适定问题的经典例子，而反向方程则是不适定的，表现出对其初始条件中的扰动，特别是高空间频率的扰动，具有极端的敏感性。我们将通过分析几种有限差分法的稳定性来证明这一性质。\n\n我们考虑一个具有 $N$ 个点 $x_j = j \\Delta x$（其中 $j \\in \\{0, 1, \\dots, N-1\\}$）的均匀空间网格，网格间距为 $\\Delta x = 1/N$。时间被离散化为大小为 $\\Delta t$ 的步长，即 $t_n = n \\Delta t$。我们将解的数值近似表示为 $u_j^n \\approx u(x_j, t_n)$。\n\n空间二阶导数 $u_{xx}$ 使用二阶中心差分格式来近似：\n$$\\delta_x^2 u_j^n = \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{(\\Delta x)^2}$$\n因此，该偏微分方程的半离散形式为 $\\frac{d u_j}{d t} = - \\delta_x^2 u_j$。\n\n为了分析时间步进格式的稳定性，我们采用 von Neumann 稳定性分析。我们考虑形如 $u_j^n = (g)^n e^{i \\theta j}$ 的单个傅里叶模态的演化，其中 $\\theta = 2\\pi k/N$ 是对应于模态 $k$ 的离散波数，而 $g = g(\\theta, r)$ 是每时间步的复放大因子。一个数值格式要稳定，对于所有相关的波数 $\\theta$，必须满足 $|g| \\le 1$。\n\n首先，我们确定离散空间算子 $\\delta_x^2$ 如何作用于一个傅里叶模态：\n$$\\delta_x^2 e^{i\\theta j} = \\frac{e^{i\\theta(j+1)} - 2e^{i\\theta j} + e^{i\\theta(j-1)}}{(\\Delta x)^2} = \\frac{e^{i\\theta j} (e^{i\\theta} - 2 + e^{-i\\theta})}{(\\Delta x)^2}$$\n使用恒等式 $e^{i\\theta} + e^{-i\\theta} = 2\\cos\\theta$，上式变为：\n$$\\delta_x^2 e^{i\\theta j} = \\frac{2(\\cos\\theta - 1)}{(\\Delta x)^2} e^{i\\theta j}$$\n进一步，使用半角恒等式 $1 - \\cos\\theta = 2\\sin^2(\\theta/2)$，我们得到：\n$$\\delta_x^2 e^{i\\theta j} = -\\frac{4\\sin^2(\\theta/2)}{(\\Delta x)^2} e^{i\\theta j}$$\n因此，对于反向热传导方程 $u_t = -u_{xx}$，空间算子对傅里叶模态的作用是乘以一个正实数：\n$$- \\delta_x^2 e^{i\\theta j} = \\frac{4\\sin^2(\\theta/2)}{(\\Delta x)^2} e^{i\\theta j}$$\n\n现在我们使用参数 $r = \\Delta t / (\\Delta x)^2$ 来推导三种指定的时间步进格式各自的放大因子 $g$。\n\n**1. 前向欧拉法（显式）**\n该格式由 $\\frac{u_j^{n+1} - u_j^n}{\\Delta t} = - \\delta_x^2 u_j^n$ 给出。\n代入傅里叶模态 $u_j^n = g^n e^{i\\theta j}$ 及其时间推进形式 $u_j^{n+1} = g^{n+1} e^{i\\theta j} = g \\cdot g^n e^{i\\theta j}$：\n$$\\frac{g \\cdot g^n e^{i\\theta j} - g^n e^{i\\theta j}}{\\Delta t} = - \\left( -\\frac{4\\sin^2(\\theta/2)}{(\\Delta x)^2} g^n e^{i\\theta j} \\right)$$\n两边除以 $g^n e^{i\\theta j}$ 并化简得到：\n$$\\frac{g - 1}{\\Delta t} = \\frac{4\\sin^2(\\theta/2)}{(\\Delta x)^2}$$\n$$g_{FE} - 1 = \\frac{4\\Delta t}{(\\Delta x)^2} \\sin^2(\\theta/2) = 4r\\sin^2(\\theta/2)$$\n放大因子为：\n$$g_{FE}(\\theta, r) = 1 + 4r\\sin^2(\\theta/2)$$\n由于 $r  0$ 且 $\\sin^2(\\theta/2) \\ge 0$，我们有 $g_{FE} \\ge 1$。对于任何非零模态（$\\theta \\ne 0$），我们有 $|g_{FE}|  1$。该方法对于反向热传导方程是无条件不稳定的。增长在网格上的最高频率模态 $\\theta = \\pi$（对应于 $k=N/2$）处最为显著，此时 $\\sin^2(\\pi/2)=1$ 且 $g_{FE} = 1 + 4r$。\n\n**2. 后向欧拉法（隐式）**\n该格式由 $\\frac{u_j^{n+1} - u_j^n}{\\Delta t} = - \\delta_x^2 u_j^{n+1}$ 给出。\n代入傅里叶模态及其时间推进形式（现在右侧也有）：\n$$\\frac{g \\cdot g^n e^{i\\theta j} - g^n e^{i\\theta j}}{\\Delta t} = - \\left( -\\frac{4\\sin^2(\\theta/2)}{(\\Delta x)^2} g \\cdot g^n e^{i\\theta j} \\right)$$\n$$\\frac{g - 1}{\\Delta t} = g \\left( \\frac{4\\sin^2(\\theta/2)}{(\\Delta x)^2} \\right)$$\n$$g - 1 = g \\left( 4r\\sin^2(\\theta/2) \\right)$$\n解出 $g$：\n$$g (1 - 4r\\sin^2(\\theta/2)) = 1$$\n放大因子为：\n$$g_{BE}(\\theta, r) = \\frac{1}{1 - 4r\\sin^2(\\theta/2)}$$\n为了使格式稳定，我们需要 $|g_{BE}| \\le 1$。然而，对于任何 $r  0$ 和 $\\theta \\ne 0$，分母 $1 - 4r\\sin^2(\\theta/2)  1$。如果分母为正，则 $g_{BE}  1$，表明不稳定。当 $1 - 4r\\sin^2(\\theta/2) = 0$ 时，该方法变得奇异，导致无限放大。例如，当 $r=1/4$ 时，这种情况发生在最高频率模态（$\\theta=\\pi$）上。因此，后向欧拉法也是无条件不稳定的。\n\n**3. Crank–Nicolson 法**\n该格式由 $\\frac{u_j^{n+1} - u_j^n}{\\Delta t} = -\\frac{1}{2}(\\delta_x^2 u_j^n + \\delta_x^2 u_j^{n+1})$ 给出。\n代入傅里叶模态：\n$$\\frac{g-1}{\\Delta t} g^n e^{i\\theta j} = -\\frac{1}{2} \\left( -\\frac{4\\sin^2(\\theta/2)}{(\\Delta x)^2} g^n e^{i\\theta j}  -\\frac{4\\sin^2(\\theta/2)}{(\\Delta x)^2} g \\cdot g^n e^{i\\theta j} \\right)$$\n$$\\frac{g-1}{\\Delta t} = \\frac{1}{2} (1+g) \\frac{4\\sin^2(\\theta/2)}{(\\Delta x)^2}$$\n$$g-1 = (1+g) \\left( 2r\\sin^2(\\theta/2) \\right)$$\n令 $A = 2r\\sin^2(\\theta/2)$。则 $g-1 = A(1+g)$。解出 $g$：\n$$g(1-A) = 1+A$$\n放大因子为：\n$$g_{CN}(\\theta, r) = \\frac{1 + 2r\\sin^2(\\theta/2)}{1 - 2r\\sin^2(\\theta/2)}$$\n对于任何 $r0$ 和 $\\theta \\ne 0$，$2r\\sin^2(\\theta/2)$ 这一项是正的。因此，分子总是大于分母（假设分母为正）。这意味着 $|g_{CN}|  1$。当分母为零时，该方法是奇异的，例如，对于最高频率模态（$\\theta=\\pi$）当 $r=1/2$ 时。Crank-Nicolson 法也是无条件不稳定的。\n\n**结论：数值不稳定性与不适定性**\n所有三种标准的数值格式在应用于反向热传导方程时，都是无条件不稳定的。任何非零频率模态的放大因子其绝对值都大于 $1$。这意味着数值解中对应于空间变化的任何分量，无论多么微小，都将在时间上被指数级放大。放大率在最高频率处最大。\n\n这种数值行为是连续反向热传导方程不适定性质的直接后果。对于连续问题，傅里叶模态解 $u(x, t) = e^{i\\omega x} e^{\\omega^2 t}$ 表明，高频分量（大的 $\\omega$）会以任意快的速度指数增长。任何数值求解该问题的尝试都将不可避免地引入微小误差（例如，来自有限精度算术），这些误差可以表示为傅里叶模态之和。该误差的高频分量将被迅速放大，从而破坏解。这违反了适定问题的原则，该原则要求解连续依赖于初始数据。我们的数值分析正确地捕捉到了这种基本的病态性质。\n\n现在的任务是为指定的测试用例计算总放大率 $|g(\\theta, r)|^{n_{\\text{steps}}}$。该值表示从单个傅里叶模态开始的解，其最终 $L^2$ 范数与初始 $L^2$ 范数的比值。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the amplification of Fourier modes for the backward heat equation\n    using three different finite difference schemes.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Format: (method_name, N, k, r, n_steps)\n    test_cases = [\n        (\"Forward Euler\", 64, 32, 0.1, 10),\n        (\"Backward Euler\", 64, 32, 0.24, 5),\n        (\"Crank-Nicolson\", 64, 16, 0.2, 8),\n        (\"Backward Euler\", 64, 32, 0.249, 1),\n    ]\n\n    results = []\n    for case in test_cases:\n        method, N, k, r, n_steps = case\n        \n        # Calculate the angle theta in radians for the given mode k and grid size N.\n        # theta = 2 * pi * k / N\n        theta = 2 * np.pi * k / N\n        \n        # Pre-calculate the term sin^2(theta/2), which appears in all amplification factors.\n        sin_sq_theta_half = np.sin(theta / 2.0)**2\n        \n        # Calculate the amplification factor g based on the chosen method.\n        g = 0.0\n        if method == \"Forward Euler\":\n            # g = 1 + 4*r*sin^2(theta/2)\n            g = 1.0 + 4.0 * r * sin_sq_theta_half\n        elif method == \"Backward Euler\":\n            # g = 1 / (1 - 4*r*sin^2(theta/2))\n            denominator = 1.0 - 4.0 * r * sin_sq_theta_half\n            # Handle potential division by zero, though test cases avoid it.\n            if denominator == 0:\n                g = np.inf\n            else:\n                g = 1.0 / denominator\n        elif method == \"Crank-Nicolson\":\n            # g = (1 + 2*r*sin^2(theta/2)) / (1 - 2*r*sin^2(theta/2))\n            numerator = 1.0 + 2.0 * r * sin_sq_theta_half\n            denominator = 1.0 - 2.0 * r * sin_sq_theta_half\n            # Handle potential division by zero.\n            if denominator == 0:\n                g = np.inf\n            else:\n                g = numerator / denominator\n\n        # The ratio of final to initial L2 norm for a single mode is |g|^n_steps.\n        abs_g = np.abs(g)\n        total_amplification = abs_g ** n_steps\n        \n        results.append(total_amplification)\n\n    # Format the results into a comma-separated string, with each number\n    # rounded to six decimal places.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "3229600"}]}