## 引言
[抛物型偏微分方程](@entry_id:168935)（PDEs），如经典的[热传导方程](@entry_id:194763)和[扩散方程](@entry_id:170713)，是描述自然界和工程领域中各类瞬态、耗散过程的基础数学模型。从物理学中的热量传播、化学中的物质[扩散](@entry_id:141445)，到金融学中的期权定价，这些方程无处不在。然而，除了少数理想情况，绝大多数实际问题中的[抛物型PDE](@entry_id:168935)s过于复杂，难以求得解析解，这使得开发准确、高效且稳定的数值方法成为科学与工程计算的核心任务之一。有限差分法因其直观性和易于实现，成为了求解此类问题的基石。

本文旨在为读者提供一个关于使用有限差分法求解[抛物型偏微分方程](@entry_id:168935)的全面指南。我们将系统性地解决从理论构建到实际应用中的关键问题。通过学习本文，你将掌握必要的理论知识和实践技能，从而能够自信地分析、实现和验证针对各种[扩散](@entry_id:141445)类问题的数值求解器。

在接下来的内容中，我们将分三个章节展开：

- **第一章：原理与机制** 将深入探讨[有限差分法](@entry_id:147158)的核心理论。你将学习如何对[抛物型PDE](@entry_id:168935)进行离散化，理解“系统刚性”的概念，并通过冯·诺伊曼分析等工具来判断不同数值格式（如FTCS、BTCS和Crank-Nicolson）的稳定性与精度。此外，我们还将介绍制造解方法等关键的[程序验证](@entry_id:264153)技术。

- **第二章：应用与[交叉](@entry_id:147634)学科联系** 将展示这些数值方法的强大威力。我们将跨越多个学科领域，探索[有限差分法](@entry_id:147158)在解决[非均匀介质](@entry_id:750241)热传导、[反应-扩散系统](@entry_id:136900)、[移动边界问题](@entry_id:170533)、金融衍生品定价、[图像处理](@entry_id:276975)甚至量子力学等真实世界问题中的具体应用。

- **第三章：动手实践** 则提供了一系列精心设计的问题，旨在巩固你的理论知识并提升编码实践能力。你将有机会从头开始实现一个数值求解器，处理复杂的边界条件，并亲自体验[不适定问题](@entry_id:182873)带来的挑战。

现在，让我们从第一章开始，深入[有限差分法](@entry_id:147158)的核心原理。

## 原理与机制

在介绍性章节之后，我们现在深入探讨[抛物型偏微分方程](@entry_id:168935)（PDEs）数值解的核心原理和机制。本章的目标是建立一个坚实的理论基础，涵盖从方程分类到高级[数值分析技术](@entry_id:146014)的广泛主题。我们将系统地阐述基本性质、[离散化方法](@entry_id:272547)、稳定性与[收敛性分析](@entry_id:151547)，以及确保数值解既准确又具有物理真实性的实际实现策略。

### [抛物型偏微分方程](@entry_id:168935)的性质

在选择或设计数值方法之前，理解待解方程的数学和物理特性至关重要。一个[二阶线性偏微分方程](@entry_id:195856)的一般形式为：
$$
A u_{xx} + 2B u_{xy} + C u_{yy} + \dots = 0
$$
其中系数 $A, B, C$ 可以是常数或变量 $x, y$ 的函数。方程的类型由其**[判别式](@entry_id:174614)** $\Delta = B^2 - AC$ 的符号决定：

-   **双曲型 (Hyperbolic)**：$\Delta > 0$，例如波动方程。这类方程描述了[波的传播](@entry_id:144063)，其特征是信息沿着特定的特征线传播。
-   **抛物型 (Parabolic)**：$\Delta = 0$，例如[热传导方程](@entry_id:194763)。这类方程描述了[扩散过程](@entry_id:170696)，其解具有平滑效应。
-   **椭圆型 (Elliptic)**：$\Delta  0$，例如[拉普拉斯方程](@entry_id:143689)。这类方程通常描述[稳态](@entry_id:182458)系统，其解在整个区域内是相互关联的。

方程的类型深刻地影响其解的行为以及合适的数值求解策略。例如，[双曲型方程](@entry_id:145657)通常使用沿时间方向“推进”的显式方法，而椭圆型方程则需要求解一个覆盖整个空间域的[联立方程](@entry_id:193238)组。更复杂的是，如果系数 $A, B, C$ 是变量，方程可能在求解域的不同区域呈现不同的类型，即成为**[混合型方程](@entry_id:167751)**。在这种情况下，单一的标准[数值格式](@entry_id:752822)可能无法在整个区域内稳定、准确地工作，必须采用特殊的处理方法[@problem_id:2159300]。

本章将聚焦于**[抛物型方程](@entry_id:144670)**，其最典型的代表是**一维[热传导](@entry_id:147831)（或[扩散](@entry_id:141445)）方程**：
$$
\frac{\partial u}{\partial t} = \alpha \frac{\partial^2 u}{\partial x^2}
$$
其中 $u(x,t)$ 通常代表温度或浓度，$\alpha > 0$ 是[热扩散](@entry_id:148740)系数或[扩散](@entry_id:141445)系数。该方程体现了抛物型系统的两个关键性质：

#### 平滑特性

[抛物型方程](@entry_id:144670)最显著的特征之一是其**平滑特性**（smoothing property）。即使[初始条件](@entry_id:152863)包含不连续点或尖锐的梯度（例如一个[阶跃函数](@entry_id:159192)），解在 $t>0$ 的任何时刻都会变得无限可微（即光滑）。物理上，这意味着热量会立即从高温区域流向低温区域，从而迅速抹平任何尖锐的温度变化。

我们可以通过一个数值实验来直观地理解这一点。考虑在周期性边界条件下，分别用热传导方程和波动方程（一种[双曲型方程](@entry_id:145657)）演化一个阶跃函数[初始条件](@entry_id:152863)。随着时间的推移，[热传导方程的解](@entry_id:165228)将迅速变得平滑，阶跃处的陡峭边缘会变缓。相反，波动方程的解会将初始的阶跃分解为两个向相反方向传播的、保持其不连续性的波。通过[追踪解](@entry_id:159403)的最大梯度随时间的变化，我们可以定量地观察到[抛物型方程](@entry_id:144670)的“边缘强度”衰减，而[双曲型方程](@entry_id:145657)则保持不变[@problem_id:3213856]。这一本质差异意味着[抛物型方程](@entry_id:144670)中的信息似乎以无限速度传播（一个点的扰动会瞬时影响到所有其他点），但其影响会随着距离的增加而无限衰减。

#### [极值原理](@entry_id:138611)

**极值原理**（Maximum Principle）是[抛物型方程](@entry_id:144670)的另一个基石性质。对于一个有界区域内的热传导方程，在没有内部热源的情况下，解 $u(x,t)$ 的最大值和最小值必然出现在初始时刻（$t=0$）或区域的空间边界上。这意味着，在一个没有热源的物体内部，不可能自发地产生一个新的最热点或最冷点。例如，一根杆的最高温度要么是它的初始最高温度，要么是由其端点处的外部加热决定的。这个原理为我们评估数值解的物理真实性提供了一个重要的准则[@problem_id:3229680]。

此外，[抛物型方程](@entry_id:144670)也与**守恒律**密切相关。例如，对于一个两端绝热（即[诺伊曼边界条件](@entry_id:142124) $u_x=0$）的杆，其总热能 $E(t) = \int_0^L u(x,t) dx$ 应该随时间保持不变。一个好的[数值格式](@entry_id:752822)应该能在离散层面上近似地或精确地保持这种守恒性[@problem_id:3229535]。

### [半离散化](@entry_id:163562)与系统刚性

[有限差分法](@entry_id:147158)的核心思想是将连续的[偏微分方程](@entry_id:141332)转化为一个代数方程组。对于抛物型问题，一个常见的策略是首先只对空间变量进行离散化，这个过程称为**[半离散化](@entry_id:163562)**（semi-discretization）或**线方法**（Method of Lines）。

考虑在一个均匀网格 $x_j = j \Delta x$ 上，用[二阶中心差分](@entry_id:170774)来近似空间[二阶导数](@entry_id:144508)：
$$
\frac{\partial^2 u}{\partial x^2}\bigg|_{x_j} \approx \frac{u(x_{j+1}, t) - 2u(x_j, t) + u(x_{j-1}, t)}{\Delta x^2}
$$
将此近似代入热传导方程 $u_t = \alpha u_{xx}$，并考虑齐次[狄利克雷边界条件](@entry_id:173524)（例如 $u(0,t)=u(L,t)=0$），我们得到一个关于在每个内部网格点上的解 $u_j(t) \approx u(x_j,t)$ 的[常微分方程](@entry_id:147024)（ODE）组：
$$
\frac{d u_j(t)}{dt} = \frac{\alpha}{\Delta x^2} (u_{j-1}(t) - 2u_j(t) + u_{j+1}(t)), \quad \text{for } j=1, \dots, N
$$
这个ODE系统可以写成紧凑的矩阵形式 $\frac{d\mathbf{U}}{dt} = A\mathbf{U}$，其中 $\mathbf{U}(t) = [u_1(t), u_2(t), \dots, u_N(t)]^T$ 是所有内部节点解的向量，而矩阵 $A$ 是一个 $N \times N$ 的三对角矩阵：
$$
A = \frac{\alpha}{\Delta x^2}
\begin{pmatrix}
-2   1   0   \dots   0 \\
1   -2   1   \dots   0 \\
0   \ddots   \ddots   \ddots   0 \\
\vdots    1   -2   1 \\
0   \dots   0   1   -2
\end{pmatrix}
$$
这个ODE系统的性质由矩阵 $A$ 的谱（即其[特征值](@entry_id:154894)集合）决定。我们可以通过分析 $A$ 在离散正弦模上的作用来精确地找到它的[特征值](@entry_id:154894)。对于齐次[狄利克雷边界条件](@entry_id:173524)，合适的[特征向量](@entry_id:151813)是 $\mathbf{v}^{(k)}$，其分量为 $v_j^{(k)} = \sin\left(\frac{k \pi j}{N+1}\right)$。经过推导，可以得到 $A$ 的[特征值](@entry_id:154894)为[@problem_id:3229586]：
$$
\lambda_k = -\frac{4\alpha}{\Delta x^2} \sin^2\left(\frac{k\pi}{2(N+1)}\right), \quad \text{for } k=1, 2, \dots, N
$$
所有[特征值](@entry_id:154894)都是负实数，这与[扩散过程](@entry_id:170696)的衰减特性是一致的。然而，这些[特征值](@entry_id:154894)的幅度范围非常大。ODE系统的**刚性**（stiffness）通常用其雅可比矩阵（在此即为 $A$）的最大与最小幅度[特征值](@entry_id:154894)之比来衡量。该系统的刚性比为：
$$
\rho(N) = \frac{|\lambda_{\max}|}{|\lambda_{\min}|} = \frac{|\lambda_N|}{|\lambda_1|} = \frac{\sin^2\left(\frac{N\pi}{2(N+1)}\right)}{\sin^2\left(\frac{\pi}{2(N+1)}\right)} = \cot^2\left(\frac{\pi}{2(N+1)}\right)
$$
当网格加密时（$N \to \infty$），$\Delta x \to 0$，刚性比的[渐近行为](@entry_id:160836)是 $\rho(N) \approx \left(\frac{2(N+1)}{\pi}\right)^2 = O(N^2) = O(1/\Delta x^2)$。

这意味着，随着空间分辨率的提高，系统的刚性会急剧增长。一个**刚性系统**的解包含变化速率迥异的多个模式。其中，与 $|\lambda_{\max}|$ 对应的模式（高频空间[振荡](@entry_id:267781)）衰减得非常快，而与 $|\lambda_{\min}|$ 对应的模式（平滑的长波）衰减得非常慢。对于[显式时间积分](@entry_id:165797)方法（如[前向欧拉法](@entry_id:141238)），为了保持数值稳定，其时间步长 $\Delta t$ 必须由最快的模式决定，即 $\Delta t$ 必须非常小（与 $\Delta x^2$ 成正比）。这使得即使解的整体变化非常缓慢，显式方法也必须以极小的步长“爬行”，导致计算效率低下。这正是我们需要引入[隐式时间积分](@entry_id:171761)方法的核心动机。

### [时间积分格式](@entry_id:165373)：[θ方法](@entry_id:197481)

在完成[空间离散化](@entry_id:172158)得到[半离散系统](@entry_id:754680) $\frac{d\mathbf{U}}{dt} = A\mathbf{U}$ 后，下一步是在时间上进行离散化。**[θ方法](@entry_id:197481)**提供了一个统一的框架，涵盖了多种常见的一步法[时间积分格式](@entry_id:165373)：
$$
\frac{\mathbf{U}^{n+1} - \mathbf{U}^n}{\Delta t} = A \left( \theta \mathbf{U}^{n+1} + (1-\theta)\mathbf{U}^n \right)
$$
其中 $\mathbf{U}^n$ 是在时间 $t_n = n\Delta t$ 的数值解，$\theta \in [0, 1]$ 是一个加权参数。这个方程可以通过整理得到求解 $\mathbf{U}^{n+1}$ 的线性系统：
$$
(I - \theta \Delta t A) \mathbf{U}^{n+1} = (I + (1-\theta) \Delta t A) \mathbf{U}^n
$$
不同的 $\theta$ 值对应不同的著名格式[@problem_id:3229538]：

-   **前向欧拉法 (Forward Euler, $\theta=0$)**：该格式是**显式的**，因为 $\mathbf{U}^{n+1}$ 可以直接由 $\mathbf{U}^n$ 计算得到，无需[解线性方程组](@entry_id:136676)：$\mathbf{U}^{n+1} = (I + \Delta t A) \mathbf{U}^n$。这种方法每个时间步的计算成本很低，但它是**条件稳定**的，如前所述，对[刚性问题](@entry_id:142143)其时间步长受限于严苛的稳定性条件。这种格式在[有限差分](@entry_id:167874)中通常被称为**FTCS**（Forward-Time Centered-Space）。

-   **后向欧拉法 (Backward Euler, $\theta=1$)**：该格式是**隐式的**，每个时间步都需要求解一个[线性方程组](@entry_id:148943)：$(I - \Delta t A) \mathbf{U}^{n+1} = \mathbf{U}^n$。幸运的是，对于[热传导方程](@entry_id:194763)，矩阵 $(I - \Delta t A)$ 是三对角的，可以使用高效的[托马斯算法](@entry_id:141077)（Thomas Algorithm）在 $O(N)$ 的复杂度内求解。这种方法的关键优势是它是**无条件稳定**的，可以选择远大于显式方法稳定极限的时间步长。其时间精度为一阶。这种格式通常被称为**BTCS**（Backward-Time Centered-Space）。

-   **[Crank-Nicolson方法](@entry_id:748041) ($\theta=0.5$)**：该格式也是**隐式的**，并且同样需要求解一个[三对角线性系统](@entry_id:171114)。它的主要优点是时间精度提高到了**二阶**，同时也是**无条件稳定**的。这使得它对于要求高精度的计算非常有吸[引力](@entry_id:175476)。

总结来说，显式方法简单但受制于刚性；隐式方法虽然每步计算更复杂，但其优越的稳定性允许使用更大的时间步长，对于求解[扩散](@entry_id:141445)主导的刚性问题通常远比显式方法高效。

### 核心分析工具：[稳定性分析](@entry_id:144077)

一个数值格式能否成功应用，**稳定性**是其先决条件。一个不稳定的格式会无限放大计算过程中产生的微小误差（如舍入误差），最终导致解发散并变得毫无意义。

**冯·诺伊曼（Fourier）[稳定性分析](@entry_id:144077)**是分析线性、[常系数](@entry_id:269842)PDE的[有限差分格式](@entry_id:749361)稳定性的标准工具。其基本思想是将[数值误差](@entry_id:635587)分解为一系列傅里叶模式，并考察每个模式在时间步进过程中的演化。我们假设误差的一个模式具有形式 $u_j^n = G^n e^{i k j \Delta x}$，其中 $k$ 是波数，$i=\sqrt{-1}$，$G$ 是**放大因子**，表示该模式在一个时间步长内的振幅变化。为了使格式稳定，所有可能的[波数](@entry_id:172452)对应的[放大因子](@entry_id:144315)的模都必须不大于1，即 $|G| \le 1$。

#### 案例1：纯[扩散方程](@entry_id:170713)（[热传导方程](@entry_id:194763)）
我们将此分析应用于热传导方程的[FTCS格式](@entry_id:146585)：$u_j^{n+1} = u_j^n + r(u_{j+1}^n - 2u_j^n + u_{j-1}^n)$，其中 $r = \frac{\alpha \Delta t}{\Delta x^2}$。代入傅里叶模式，经过化简可得放大因子为：
$$
G = 1 + r(e^{i k \Delta x} - 2 + e^{-i k \Delta x}) = 1 + 2r(\cos(k \Delta x) - 1)
$$
由于 $1-\cos(\theta) \ge 0$，要满足稳定性条件 $|G| \le 1$（即 $-1 \le G \le 1$），必须有 $1 + 2r(\cos(k \Delta x) - 1) \ge -1$，这导出 $2r(1-\cos(k \Delta x)) \le 2$。这个不等式对于所有[波数](@entry_id:172452)都必须成立，最严格的约束发生在 $k \Delta x = \pi$ 时（最[高频模式](@entry_id:750297)），此时 $1-\cos(\pi)=2$。代入得到 $4r \le 2$，即：
$$
r = \frac{\alpha \Delta t}{\Delta x^2} \le \frac{1}{2}
$$
这就是著名的[FTCS格式](@entry_id:146585)求解[热传导方程的稳定性](@entry_id:137473)条件。

#### 案例2：[对流-扩散方程](@entry_id:144002)
为了展示该分析方法的普适性，我们考虑更复杂的[对流-扩散方程](@entry_id:144002) $u_t + c u_x = \alpha u_{xx}$，其中增加了一个[对流](@entry_id:141806)项 $c u_x$ [@problem_id:3229657]。使用[FTCS格式](@entry_id:146585)（时间[前向差分](@entry_id:173829)，空间中心差分），其离散形式包含[对流](@entry_id:141806)项的[中心差分](@entry_id:173198)。进行冯·诺伊曼分析会得到一个复数[放大因子](@entry_id:144315)：
$$
G = 1 - 2r(1-\cos\theta) - i \frac{c\Delta t}{\Delta x}\sin\theta, \quad \theta = k\Delta x
$$
稳定性条件 $|G|^2 \le 1$ 经过推导，会产生两个必须同时满足的条件：
1.  [扩散](@entry_id:141445)稳定性约束：$\frac{\alpha \Delta t}{\Delta x^2} \le \frac{1}{2}$
2.  [对流稳定性](@entry_id:152951)约束：$c^2 \Delta t \le 2\alpha$

第二个条件，有时与单元[佩克莱数](@entry_id:141791)（cell Péclet number）相关，它限制了在一个时间步内，[对流](@entry_id:141806)相对于[扩散](@entry_id:141445)的强度。这表明，增加新的物理过程（如[对流](@entry_id:141806)）可能会引入新的稳定性限制。这也解释了为什么用于纯[对流](@entry_id:141806)方程（$\alpha=0$）的[FTCS格式](@entry_id:146585)是无条件不稳定的。

相比之下，后向欧拉法和[Crank-Nicolson方法](@entry_id:748041)对于热传导方程是**无条件稳定**的，这意味着对于任意大小的时间步长 $\Delta t$（即任意 $r0$），它们的[放大因子](@entry_id:144315)模总是不大于1。

### 精度、收敛性与验证

一个好的数值格式不仅要稳定，还必须**收敛**，即当网格尺寸 $\Delta x$ 和 $\Delta t$ 趋于零时，数值解要趋近于真实的连续解。

-   **[局部截断误差](@entry_id:147703) (LTE)** 是将真实解代入离散格式后所产生的[余项](@entry_id:159839)，它衡量了离散格式与原PDE的偏离程度。如果LTE随着网格尺寸的减小而趋于零，则称格式是**一致的**。
-   **收敛阶**描述了误差随网格尺寸减小的速率。如果误差 $E \propto \Delta x^p$，则称该方法具有 $p$ 阶空间收敛精度。
-   **[Lax等价定理](@entry_id:139112)**是[数值分析](@entry_id:142637)的基石之一，它指出：对于一个适定线性问题，一个一致的[有限差分格式](@entry_id:749361)是收敛的，当且仅当它是稳定的。

[FTCS格式](@entry_id:146585)的时间和空间精度分别为 $O(\Delta t)$ 和 $O(\Delta x^2)$。Crank-Nicolson法则在时间和空间上都是二阶的，即 $O(\Delta t^2, \Delta x^2)$。

#### 解的[光滑性](@entry_id:634843)对收敛阶的影响
理论[收敛阶](@entry_id:146394)是基于真实解足够**光滑**（即具有足够阶数的连续导数）的假设下推导的。如果解不光滑，实际观察到的收敛阶可能会显著降低。一个典型的例子是使用FTCS求解带有不连续初始条件（如阶跃函数）的[热传导方程](@entry_id:194763)。即使理论上空间精度是二阶的，由于初始解在不连续点附近缺乏光滑性，数值误差会比预期的要大，导致在[网格加密](@entry_id:168565)时，观察到的收敛阶会从2显著下降，通常降至0.5左右[@problem_id:3229558]。这提醒我们，在评估数值方法时，必须考虑待解问题的内在特性。

#### 用制造解方法进行验证
在开发数值求解器时，如何确保代码的正确性？**制造解方法**（Method of Manufactured Solutions, MMS）提供了一种严谨的[程序验证](@entry_id:264153)（code verification）流程[@problem_id:3229592]。其步骤如下：
1.  **制造一个解**：选择一个任意但足够光滑的解析函数作为“真实”解，例如 $u_m(x,t) = \exp(t) \sin(\pi x)$。
2.  **导出源项**：将这个制造解代入目标PDE（例如 $u_t = \alpha u_{xx} + f$）中，反解出所需的[源项](@entry_id:269111) $f(x,t)$。对于上面的例子，$f(x,t) = (1 + \alpha \pi^2) \exp(t) \sin(\pi x)$。
3.  **求解新问题**：使用你的数值求解器求解这个带有[源项](@entry_id:269111)的新PDE，其初始条件和边界条件均由制造解 $u_m$ 在相应位置的值给出。
4.  **计算误差**：由于你已经知道了这个问题的精确解（就是你制造的 $u_m$），你可以精确地计算出你的数值解与真实解之间的误差。
5.  **检验[收敛阶](@entry_id:146394)**：通过在一系列不断加密的网格上运行求解器，并计算误差，你可以检验观察到的收敛阶是否与理论预测相符。如果相符，就极大地增强了对代码实现正确性的信心。

MMS是一种极其强大的技术，因为它允许我们在没有已知解析解的情况下，对复杂的PDE、边界条件和几何形状的求解器进行严格的定量测试。

### 实现细节与高级概念

#### 边界条件的处理
准确处理边界条件是获得精确数值解的关键。

-   **狄利克雷边界条件**：当网格点直接落在边界上时（**节点中心网格**），可以直接将解的值固定为边界值。但在**单元中心网格**中，物理边界位于两个网格点之间。为了保持二阶空间精度，通常引入一个**虚拟点**（ghost point）。例如，在左边界 $x=0$ 处，我们可以通过[线性插值](@entry_id:137092)来近似边界值：$\frac{u_0 + u_1}{2} = g(t)$，其中 $u_1$ 是第一个单元中心的解， $u_0$ 是虚拟点的解，$g(t)$ 是边界值。由此可以解出虚拟点的值 $u_0 = 2g(t) - u_1$，然后将其代入第一个单元的离散格式中[@problem_id:3229614]。

-   **[诺伊曼边界条件](@entry_id:142124)**：这种边界[条件指定](@entry_id:273103)了[法向导数](@entry_id:169511)，物理上常对应于绝热或通量已知的边界。例如，[绝热边界](@entry_id:162724) $u_x(0,t)=0$。同样可以使用虚拟点来处理。在 $x=0$ 处用[中心差分近似](@entry_id:177025)导数：$\frac{u_1 - u_{-1}}{2\Delta x} = 0$，得到虚拟点的值 $u_{-1} = u_1$。将此关系代入边界点 $j=0$ 的离散格式，即可得到[边界点](@entry_id:176493)的更新规则[@problem_id:3229535]。

#### 解的定性保真度
除了稳定性和精度，一个好的数值格式还应能再现原[PDE解](@entry_id:166250)的关键定性特征。

-   **离散极值原理**：我们已经知道热传导方程满足[极值原理](@entry_id:138611)。一个数值格式如果能保证其解也满足类似的性质，则称其为**保单调的**（monotone）。如果一个格式的更新规则可以写成 $u_j^{n+1} = \sum_k c_k u_k^n$ 的形式，且所有系数 $c_k$ 均非负，则该格式是保单调的。
-   对于[FTCS格式](@entry_id:146585)，其更新系数为 $r, (1-2r), r$。当且仅当 $1-2r \ge 0$ 即 $r \le 1/2$ 时，所有系数非负。这恰好与冯·诺伊曼稳定性条件相同。因此，当FTCS稳定时，它也是保单调的，能够满足离散[极值原理](@entry_id:138611)。
-   [后向欧拉法](@entry_id:139674)（BTCS）可以被证明是无条件保单调的。
-   然而，一个重要的警示是：**[Crank-Nicolson方法](@entry_id:748041)虽然无条件稳定且二阶精确，但它不是无条件保单调的**。当时间步长较大（例如 $r > 1$）时，其更新矩阵的某些系数会变为负值。这会导致在解的梯度较大处（如不连续的初始条件附近）产生非物理的[振荡](@entry_id:267781)（"wiggles"），从而可能违反离散极值原理（例如，从正的初始数据产生负值）。这是一个经典的权衡：Crank-Nicolson提供了更高的理论精度，但在某些情况下，一阶的后向欧拉法可能因其更好的定性保真度而更受青睐[@problem_id:3229680]。

#### 离散守恒性
许多物理定律都表现为守恒律。在数值模拟中，保持这些守恒量（如质量、动量、能量）的离散模拟至关重要。对于带有[绝热边界](@entry_id:162724)的热传导方程，总热能是守恒的。然而，使用前面为[诺伊曼边界条件](@entry_id:142124)推导的直接[有限差分格式](@entry_id:749361)，并用简单的求和来定义离散总能量 $E^n = \Delta x \sum u_i^n$，我们会发现这个离散能量并不是严格守恒的[@problem_id:3229535]。其原因是离散格式在边界处的数值通量并非精确为零。要实现严格的离散守恒，通常需要采用基于积分形式的**[有限体积法](@entry_id:749372)**，这种方法从设计之初就保证了通量的守恒。这预示了更高级数值方法的发展方向。