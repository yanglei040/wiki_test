{"hands_on_practices": [{"introduction": "在计算机上，即使是像减法这样最基本的运算也可能产生令人惊讶的结果。本练习通过一个减去两个几乎相等数字的经典例子，引导你使用后向误差的概念来分析灾难性抵消现象。你将亲手计算，体会为何即使算法本身是后向稳定的，一个微小的输入扰动就能解释巨大的输出误差，从而揭示问题的“病态”本质。[@problem_id:3231943]", "problem": "设 $x$ 和 $y$ 是实数，在一个十进制浮点系统中进行存储和相减，该系统采用四舍五入到最近值的方式，精度为 $p=7$ 位有效数字。设真实输入为 $x=1.0000004$ 和 $y=1.0000001$。存储值为 $\\mathrm{fl}(x)$ 和 $\\mathrm{fl}(y)$，每个值都是通过将真实值四舍五入到 $7$ 位有效数字得到的，计算出的减法结果为 $z_{\\mathrm{comp}}=\\mathrm{fl}(\\mathrm{fl}(x)-\\mathrm{fl}(y))$。使用前向误差和后向误差的核心定义，并结合“四舍五入到 $p$ 位有效数字是浮点存储的一个经过充分检验的模型”这一事实，来分析相近两数相减的问题。具体来说，确定 $x$ 的相对后向误差，定义为 $\\frac{|\\Delta x|}{|x|}$，其中 $\\Delta x$ 是使精确减法 $(x+\\Delta x)-y$ 等于 $0$ 的对 $x$ 的最小扰动。将您的最终数值答案四舍五入到 $4$ 位有效数字。", "solution": "该问题已经过验证，被认为是数值分析领域中一个适定且科学合理的问题。它要求在特定定义下计算减法运算的相对后向误差。\n\n目标是确定输入 $x$ 在运算 $x-y$ 中的相对后向误差，其中后向误差是相对于目标结果 $0$ 来定义的。给定的真实输入为 $x=1.0000004$ 和 $y=1.0000001$。$x$ 的相对后向误差由公式 $\\frac{|\\Delta x|}{|x|}$ 给出，其中 $\\Delta x$ 是导致精确减法结果为 $0$ 的对 $x$ 的最小扰动。\n\n首先，我们分析浮点系统提供的上下文。该系统是一个十进制浮点系统，精度为 $p=7$，并四舍五入到最接近的可表示数。\n$x$ 的真实值为 $1.0000004$。要以 $7$ 位有效数字存储该值，我们必须对其进行四舍五入。该数字可以写成 $1.0000004 \\times 10^0$。第 $8$ 位有效数字是 $4$。由于 $4  5$，我们向下舍入。\n因此，$x$ 的存储值为 $\\mathrm{fl}(x) = 1.000000$。\n$y$ 的真实值为 $1.0000001$。同样，这可以写成 $1.0000001 \\times 10^0$。第 $8$ 位有效数字是 $1$。由于 $1  5$，我们向下舍入。\n因此，$y$ 的存储值为 $\\mathrm{fl}(y) = 1.000000$。\n\n计算出的减法结果由 $z_{\\mathrm{comp}}=\\mathrm{fl}(\\mathrm{fl}(x)-\\mathrm{fl}(y))$ 给出。\n代入存储值：\n$z_{\\mathrm{comp}} = \\mathrm{fl}(1.000000 - 1.000000) = \\mathrm{fl}(0) = 0$。\n这证实了在指定的浮点系统中，减法运算的计算结果确实是 $0$。因此，问题要求的是实际执行的计算的后向误差，其中计算结果为 $0$。这种两个几乎相等的数相减导致精度损失（本例中是完全损失）的现象，被称为灾难性抵消。\n\n核心任务是找到问题中定义的扰动 $\\Delta x$。问题陈述 $\\Delta x$ 是使精确减法 $(x+\\Delta x)-y$ 等于 $0$ 的对 $x$ 的最小扰动。\n我们根据这个定义建立方程：\n$$ (x + \\Delta x) - y = 0 $$\n这是一个关于 $\\Delta x$ 的线性方程。我们可以通过重新排列项来求解 $\\Delta x$：\n$$ \\Delta x = y - x $$\n现在，我们代入 $x$ 和 $y$ 的给定真实值：\n$$ x = 1.0000004 $$\n$$ y = 1.0000001 $$\n所以，扰动 $\\Delta x$ 是：\n$$ \\Delta x = 1.0000001 - 1.0000004 = -0.0000003 $$\n问题指定了“最小扰动”。由于关于 $\\Delta x$ 的方程有唯一解，因此该解在绝对值上自然是最小的。扰动的绝对值是：\n$$ |\\Delta x| = |-0.0000003| = 0.0000003 = 3 \\times 10^{-7} $$\n\n接下来，我们计算 $x$ 的相对后向误差，其定义为 $\\frac{|\\Delta x|}{|x|}$。\n$x$ 的绝对值为 $|x| = |1.0000004| = 1.0000004$。\n因此，相对后向误差为：\n$$ \\frac{|\\Delta x|}{|x|} = \\frac{3 \\times 10^{-7}}{1.0000004} $$\n现在，我们进行数值除法：\n$$ \\frac{|\\Delta x|}{|x|} \\approx 2.999998800000479... \\times 10^{-7} $$\n问题要求将此最终数值答案四舍五入到 $4$ 位有效数字。设该值为 $V = 2.9999988... \\times 10^{-7}$。\n前四位有效数字是 $2$、$9$、$9$、$9$。第五位有效数字是 $9$。由于 $9 \\ge 5$，我们必须将第四位数字向上舍入。将 $2.999$ 向上舍入得到 $3.000$。尾随的零是有效数字，必须包含在内以表明舍入后结果的精度。\n所以，四舍五入到 $4$ 位有效数字的相对后向误差是 $3.000 \\times 10^{-7}$。\n\n这个小的后向误差表明，对于此实例，该算法（减法）是后向稳定的，因为输入 $x$ 的一个非常小的相对变化就足以解释计算出的输出 $0$。然而，需要注意的是，前向误差很大。真实结果是 $x-y = 0.0000003$，而计算结果是 $0$。相对前向误差是 $\\frac{|(x-y) - z_{\\mathrm{comp}}|}{|x-y|} = \\frac{|0.0000003 - 0|}{|0.0000003|} = 1$，代表 $100\\%$ 的误差。这突显了后向稳定性和前向误差放大之间的区别。", "answer": "$$\\boxed{3.000 \\times 10^{-7}}$$", "id": "3231943"}, {"introduction": "数值误差的影响在求解线性方程组时尤为突出，特别是当系统“病态”时。本练习将一个直观的几何问题——求解两条近乎平行的直线的交点——转化为一个线性代数问题。通过这个实践，你将量化一个微小的数据扰动如何导致解的巨大偏差，并计算出误差放大因子，从而深刻理解问题条件数在误差分析中的核心作用。[@problem_id:3232092]", "problem": "给定平面上的两条直线，其斜截式方程为 $y = m_1 x + d_1$ 和 $y = m_2 x + d_2$，其中 $m_1 = 1$，$d_1 = 0$，$m_2 = 1 + 10^{-6}$，$d_2 = 1$。它们的交点可以表示为一个 $2 \\times 2$ 的线性系统 $A \\mathbf{x} = \\mathbf{c}$，其中 $A = \\begin{pmatrix} -m_1  1 \\\\ -m_2  1 \\end{pmatrix}$，$\\mathbf{x} = \\begin{pmatrix} x \\\\ y \\end{pmatrix}$，$ \\mathbf{c} = \\begin{pmatrix} d_1 \\\\ d_2 \\end{pmatrix}$。由于两条直线几乎平行，矩阵 $A$ 是几乎奇异的。假设系数在测量时存在小的相对误差，产生扰动值 $\\tilde{m}_2 = m_2 (1 + \\varepsilon_m)$ 和 $\\tilde{d}_2 = d_2 (1 + \\varepsilon_d)$，其中 $\\varepsilon_m = 10^{-8}$ 且 $\\varepsilon_d = -10^{-8}$，而 $m_1$ 和 $d_1$ 保持不变。将 $\\tilde{m}_2$ 和 $\\tilde{d}_2$ 视为唯一的扰动数据。\n\n从前向误差、后向误差的核心定义以及直线相交的几何解释出发，完成以下任务：\n\n- 计算未扰动直线的精确交点 $\\mathbf{x}^{\\ast} = \\begin{pmatrix} x^{\\ast} \\\\ y^{\\ast} \\end{pmatrix}$。\n- 使用扰动系数 $\\tilde{m}_2$ 和 $\\tilde{d}_2$ 计算扰动直线的交点 $\\tilde{\\mathbf{x}} = \\begin{pmatrix} \\tilde{x} \\\\ \\tilde{y} \\end{pmatrix}$。\n- 使用欧几里得范数（也称 $2$-范数），评估范数相对前向误差 $\\frac{\\|\\tilde{\\mathbf{x}} - \\mathbf{x}^{\\ast}\\|_{2}}{\\|\\mathbf{x}^{\\ast}\\|_{2}}$。\n- 将系数相对后向误差定义为 $\\max\\!\\left\\{\\frac{|\\tilde{m}_2 - m_2|}{|m_2|}, \\frac{|\\tilde{d}_2 - d_2|}{|d_2|}\\right\\}$，并为给定的扰动计算其值。\n- 计算放大因子，其定义为范数相对前向误差与系数相对后向误差之比，并给出其数值。\n\n将最终的放大因子四舍五入到四位有效数字。不需要单位。", "solution": "该问题陈述被评估为具有科学依据、提法恰当且客观。它提供了一套完整且一致的数据和定义，用以解决数值分析中一个关于病态线性系统中误差放大的标准问题。因此，该问题是有效的，并将提供解答。\n\n该问题要求分析两条直线的交点，这等同于求解一个 $2 \\times 2$ 线性系统。我们被给予了未扰动系统和一个扰动版本，并被要求计算前向误差、后向误差以及它们的比率（放大因子）。\n\n两条直线由以下方程描述：\n直线 1：$y = m_1 x + d_1$\n直线 2：$y = m_2 x + d_2$\n\n给定的未扰动系数为 $m_1 = 1$，$d_1 = 0$，$m_2 = 1 + 10^{-6}$，$d_2 = 1$。\n\n**步骤 1：计算精确交点 $\\mathbf{x}^{\\ast}$**\n通过令 $y$ 的表达式相等来找到交点 $(x^{\\ast}, y^{\\ast})$：\n$$m_1 x^{\\ast} + d_1 = m_2 x^{\\ast} + d_2$$\n求解 $x^{\\ast}$：\n$$(m_1 - m_2) x^{\\ast} = d_2 - d_1$$\n$$x^{\\ast} = \\frac{d_2 - d_1}{m_1 - m_2}$$\n代入给定值：\n$$x^{\\ast} = \\frac{1 - 0}{1 - (1 + 10^{-6})} = \\frac{1}{-10^{-6}} = -10^6$$\n现在，我们使用直线 1 的方程来求 $y^{\\ast}$：\n$$y^{\\ast} = m_1 x^{\\ast} + d_1 = (1)(-10^6) + 0 = -10^6$$\n因此，精确交点为 $\\mathbf{x}^{\\ast} = \\begin{pmatrix} x^{\\ast} \\\\ y^{\\ast} \\end{pmatrix} = \\begin{pmatrix} -10^6 \\\\ -10^6 \\end{pmatrix}$。\n\n**步骤 2：计算扰动交点 $\\tilde{\\mathbf{x}}$**\n系数 $m_2$ 和 $d_2$ 被扰动。新的系数是 $\\tilde{m}_2$ 和 $\\tilde{d}_2$。\n扰动由 $\\varepsilon_m = 10^{-8}$ 和 $\\varepsilon_d = -10^{-8}$ 给出。\n$$\\tilde{m}_2 = m_2(1 + \\varepsilon_m) = (1 + 10^{-6})(1 + 10^{-8}) = 1 + 10^{-6} + 10^{-8} + 10^{-14}$$\n$$\\tilde{d}_2 = d_2(1 + \\varepsilon_d) = 1(1 - 10^{-8}) = 1 - 10^{-8}$$\n系数 $m_1$ 和 $d_1$ 保持不变。扰动交点 $(\\tilde{x}, \\tilde{y})$ 通过求解带有扰动系数的系统得到：\n$$m_1 \\tilde{x} + d_1 = \\tilde{m}_2 \\tilde{x} + \\tilde{d}_2$$\n$$\\tilde{x} = \\frac{\\tilde{d}_2 - d_1}{m_1 - \\tilde{m}_2} = \\frac{(1 - 10^{-8}) - 0}{1 - (1 + 10^{-6} + 10^{-8} + 10^{-14})} = \\frac{1 - 10^{-8}}{-10^{-6} - 10^{-8} - 10^{-14}}$$\n对于新的 $y$ 坐标，使用未扰动的直线 1 方程：\n$$\\tilde{y} = m_1 \\tilde{x} + d_1 = (1)\\tilde{x} + 0 = \\tilde{x}$$\n所以，扰动交点是 $\\tilde{\\mathbf{x}} = \\begin{pmatrix} \\tilde{x} \\\\ \\tilde{x} \\end{pmatrix}$。\n\n**步骤 3：评估范数相对前向误差**\n范数相对前向误差定义为 $\\frac{\\|\\tilde{\\mathbf{x}} - \\mathbf{x}^{\\ast}\\|_{2}}{\\|\\mathbf{x}^{\\ast}\\|_{2}}$。\n首先，计算 $\\mathbf{x}^{\\ast}$ 的范数：\n$$\\|\\mathbf{x}^{\\ast}\\|_{2} = \\sqrt{(x^{\\ast})^2 + (y^{\\ast})^2} = \\sqrt{(-10^6)^2 + (-10^6)^2} = \\sqrt{2 \\cdot 10^{12}} = \\sqrt{2} \\cdot 10^6$$\n由于 $\\tilde{y}=\\tilde{x}$ 且 $y^*=x^*$，相对前向误差可以简化为：\n$$E_{fwd} = \\frac{\\|\\begin{pmatrix} \\tilde{x} - x^* \\\\ \\tilde{x} - x^* \\end{pmatrix}\\|_2}{\\|\\begin{pmatrix} x^* \\\\ x^* \\end{pmatrix}\\|_2} = \\frac{\\sqrt{2(\\tilde{x}-x^*)^2}}{\\sqrt{2(x^*)^2}} = \\frac{|\\tilde{x}-x^*|}{|x^*|} = \\frac{|\\tilde{x}+10^6|}{10^6}$$\n我们来计算 $\\tilde{x} + 10^6$ 的值：\n$$\\tilde{x} + 10^6 = \\frac{1 - 10^{-8}}{-(10^{-6} + 10^{-8} + 10^{-14})} + 10^6 = \\frac{(1 - 10^{-8}) - 10^6(10^{-6} + 10^{-8} + 10^{-14})}{-(10^{-6} + 10^{-8} + 10^{-14})}$$\n$$= \\frac{1 - 10^{-8} - (1 + 10^{-2} + 10^{-8})}{-(10^{-6} + 10^{-8} + 10^{-14})} = \\frac{-10^{-2} - 2 \\cdot 10^{-8}}{-(10^{-6} + 10^{-8} + 10^{-14})} = \\frac{10^{-2} + 2 \\cdot 10^{-8}}{10^{-6} + 10^{-8} + 10^{-14}}$$\n因此，相对前向误差为：\n$$E_{fwd} = \\frac{1}{10^6} \\left( \\frac{10^{-2} + 2 \\cdot 10^{-8}}{10^{-6} + 10^{-8} + 10^{-14}} \\right) = \\frac{10^{-8} + 2 \\cdot 10^{-14}}{10^{-6} + 10^{-8} + 10^{-14}}$$\n\n**步骤 4：评估系数相对后向误差**\n系数相对后向误差 $E_{bwd}$ 定义为：\n$$E_{bwd} = \\max\\!\\left\\{\\frac{|\\tilde{m}_2 - m_2|}{|m_2|}, \\frac{|\\tilde{d}_2 - d_2|}{|d_2|}\\right\\}$$\n使用定义 $\\tilde{m}_2 = m_2(1+\\varepsilon_m)$ 和 $\\tilde{d}_2 = d_2(1+\\varepsilon_d)$：\n$$\\frac{|\\tilde{m}_2 - m_2|}{|m_2|} = \\frac{|m_2(1+\\varepsilon_m) - m_2|}{|m_2|} = |\\varepsilon_m|$$\n$$\\frac{|\\tilde{d}_2 - d_2|}{|d_2|} = \\frac{|d_2(1+\\varepsilon_d) - d_2|}{|d_2|} = |\\varepsilon_d|$$\n给定 $\\varepsilon_m = 10^{-8}$ 和 $\\varepsilon_d = -10^{-8}$：\n$$E_{bwd} = \\max\\{|10^{-8}|, |-10^{-8}|\\} = 10^{-8}$$\n\n**步骤 5：计算放大因子**\n放大因子是相对前向误差与相对后向误差之比：\n$$\\text{放大因子} = \\frac{E_{fwd}}{E_{bwd}} = \\frac{\\frac{10^{-8} + 2 \\cdot 10^{-14}}{10^{-6} + 10^{-8} + 10^{-14}}}{10^{-8}} = \\frac{1 + 2 \\cdot 10^{-6}}{10^{-6} + 10^{-8} + 10^{-14}}$$\n我们可以从分母中提出 $10^{-6}$ 来简化表达式：\n$$\\text{放大因子} = \\frac{1 + 2 \\cdot 10^{-6}}{10^{-6}(1 + 10^{-2} + 10^{-8})} = 10^6 \\frac{1 + 2 \\cdot 10^{-6}}{1 + 10^{-2} + 10^{-8}}$$\n现在，我们计算其数值：\n$$\\text{放大因子} = 10^6 \\frac{1.000002}{1.01000001} \\approx 10^6(0.990100980297)$$\n$$\\text{放大因子} \\approx 990100.980297$$\n问题要求将最终答案四舍五入到四位有效数字。前四位有效数字是 $9, 9, 0, 1$。第五位数字是 $0$，所以我们向下舍入。\n$$\\text{放大因子} \\approx 990100$$\n用科学记数法表示，这是 $9.901 \\times 10^5$。", "answer": "$$\\boxed{9.901 \\times 10^5}$$", "id": "3232092"}, {"introduction": "对于一个给定的函数，我们如何预测其在特定输入范围内的数值稳定性？本练习将带你超越单个数据点的分析，进入更具普遍性的渐近误差分析领域。你将使用微积分和极限思想，来推导在输入值$x$趋于无穷大时，一个看似无害的函数表达式$f(x) = \\sqrt{x+1} - \\sqrt{x}$的朴素计算会如何放大舍入误差，并从前向和后向误差两个角度来刻画这种不稳定性。[@problem_id:3231896]", "problem": "设 $f(x) = \\sqrt{x+1} - \\sqrt{x}$，并假设它在一台遵循电气和电子工程师协会（IEEE）浮点算术标准（IEEE 754）、采用四舍五入到最近模式、单位舍入误差为 $u$ 的机器上进行计算。对于每个基本运算和平方根，假设采用标准的一阶舍入模型：对于任意运算 $\\circ \\in \\{+, -, \\times, \\div\\}$ 以及浮点数范围内的任意 $a,b$，$\\operatorname{fl}(a \\circ b) = (a \\circ b)(1 + \\delta)$ 且 $|\\delta| \\le u$，以及 $\\operatorname{fl}(\\sqrt{y}) = \\sqrt{y}(1 + \\delta)$ 且 $|\\delta| \\le u$。考虑 $f(x)$ 的朴素计算方法，即计算 $s = \\sqrt{x}$ 和 $t = \\sqrt{x+1}$，然后进行浮点减法 $\\widehat{f} = \\operatorname{fl}(t - s)$。\n\n仅使用基本恒等式 $(a - b)(a + b) = a^{2} - b^{2}$ 和上述舍入模型作为基础，分析该朴素计算中对于大 $x$ 值的灾难性相消。推导到 $u$ 的一阶，当 $x \\to \\infty$ 时以下两项的首项最坏情况下的渐近表达式：\n1) 相对前向误差 $\\varepsilon_{f} = (\\widehat{f} - f)/f$，以及\n2) 一种后向误差解释，其中存在一个扰动 $\\Delta$，使得 $\\widehat{f} = f(x + \\Delta)$ 到一阶成立；确定当 $x \\to \\infty$ 时，这种最小 $|\\Delta|$ 的首项最坏情况下的渐近量级。\n\n将您的最终结果表示为一个二元行矩阵 $\\begin{pmatrix}E  B\\end{pmatrix}$，其中 $E$ 是相对前向误差的首项最坏情况下的渐近表达式，$B$ 是绝对后向误差 $|\\Delta|$ 的首项最坏情况下的渐近表达式，两者都用 $x$ 和 $u$ 表示。最终答案必须是单一的解析表达式；不包含单位。无需四舍五入。", "solution": "该问题要求分析函数 $f(x) = \\sqrt{x+1} - \\sqrt{x}$ 在 $x$ 值较大时进行朴素浮点计算的前向和后向误差。\n\n首先验证问题。\n\n**步骤 1：提取已知条件**\n- 函数：$f(x) = \\sqrt{x+1} - \\sqrt{x}$。\n- 浮点模型：对于运算 $\\circ \\in \\{+, -, \\times, \\div\\}$ 和平方根函数，一个精确运算的浮点结果 $\\operatorname{fl}(\\cdot)$ 与真实结果之间存在一个由单位舍入误差 $u$ 界定的相对误差。具体来说，$\\operatorname{fl}(a \\circ b) = (a \\circ b)(1 + \\delta)$ 且 $\\operatorname{fl}(\\sqrt{y}) = \\sqrt{y}(1 + \\delta)$，其中 $|\\delta| \\le u$。\n- 算法：计算过程如下：$s = \\sqrt{x}$，$t = \\sqrt{x+1}$，以及 $\\widehat{f} = \\operatorname{fl}(t - s)$。\n- 分析：到 $u$ 的一阶，当 $x \\to \\infty$ 时的渐近行为。\n- 要求输出：\n    1. 相对前向误差 $\\varepsilon_{f} = (\\widehat{f} - f)/f$ 的首项最坏情况下的渐近表达式。\n    2. 使得 $\\widehat{f} = f(x + \\Delta)$ 到一阶成立的最小绝对后向误差 $|\\Delta|$ 的首项最坏情况下的渐近量级。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题在数值分析领域，特别是在浮点误差分析方面，具有科学依据。这是一个标准的、适定的问题，目标明确，并提供了所有必要的信息。该问题没有事实上的不健全、模糊不清或主观论断。这是一个可形式化的问题，直接关系到前向和后向误差分析的主题。\n\n**步骤 3：结论和行动**\n问题有效。将提供完整解答。\n\n用帽子符号表示计算值。计算步骤建模如下，假设 $x$ 是一个精确的浮点数，并且加法 $x+1$ 也是精确的。\n第一个计算值是 $\\widehat{s}$：\n$$ \\widehat{s} = \\operatorname{fl}(\\sqrt{x}) = \\sqrt{x}(1 + \\delta_1), \\quad |\\delta_1| \\le u $$\n第二个计算值是 $\\widehat{t}$：\n$$ \\widehat{t} = \\operatorname{fl}(\\sqrt{x+1}) = \\sqrt{x+1}(1 + \\delta_2), \\quad |\\delta_2| \\le u $$\n最终结果 $\\widehat{f}$ 是 $\\widehat{t}$ 和 $\\widehat{s}$ 的浮点减法：\n$$ \\widehat{f} = \\operatorname{fl}(\\widehat{t} - \\widehat{s}) = (\\widehat{t} - \\widehat{s})(1 + \\delta_3), \\quad |\\delta_3| \\le u $$\n\n将 $\\widehat{s}$ 和 $\\widehat{t}$ 的表达式代入 $\\widehat{f}$ 的方程中：\n$$ \\widehat{f} = (\\sqrt{x+1}(1 + \\delta_2) - \\sqrt{x}(1 + \\delta_1))(1 + \\delta_3) $$\n展开此表达式，并只保留误差项 $\\delta_i$ 的一阶项（即忽略像 $\\delta_i \\delta_j$ 这样 $u^2$ 阶的项）：\n$$ \\widehat{f} \\approx (\\sqrt{x+1} - \\sqrt{x}) + \\delta_2\\sqrt{x+1} - \\delta_1\\sqrt{x} + \\delta_3(\\sqrt{x+1} - \\sqrt{x}) $$\n认识到 $f(x) = \\sqrt{x+1} - \\sqrt{x}$，绝对误差为：\n$$ \\widehat{f} - f(x) \\approx \\delta_2\\sqrt{x+1} - \\delta_1\\sqrt{x} + \\delta_3 f(x) $$\n\n**1. 相对前向误差分析**\n\n相对前向误差为 $\\varepsilon_f = (\\widehat{f} - f(x))/f(x)$。使用绝对误差表达式：\n$$ \\varepsilon_f \\approx \\frac{\\delta_2\\sqrt{x+1} - \\delta_1\\sqrt{x}}{f(x)} + \\delta_3 $$\n这个表达式揭示了灾难性相消。对于大的 $x$，$f(x)$ 项是两个几乎相等的大数之差，所以其值很小，从而放大了来自份子的误差。为了分析这一点，我们使用问题中建议的恒等式 $(a-b)(a+b)=a^2-b^2$，这使我们能够重写 $f(x)$：\n$$ f(x) = \\sqrt{x+1} - \\sqrt{x} = \\frac{(\\sqrt{x+1} - \\sqrt{x})(\\sqrt{x+1} + \\sqrt{x})}{\\sqrt{x+1} + \\sqrt{x}} = \\frac{(x+1) - x}{\\sqrt{x+1} + \\sqrt{x}} = \\frac{1}{\\sqrt{x+1} + \\sqrt{x}} $$\n将此代入 $\\varepsilon_f$ 的表达式中：\n$$ \\varepsilon_f \\approx (\\delta_2\\sqrt{x+1} - \\delta_1\\sqrt{x})(\\sqrt{x+1} + \\sqrt{x}) + \\delta_3 $$\n对于大的 $x$，我们使用渐近展开 $\\sqrt{x+1} \\approx \\sqrt{x}(1+\\frac{1}{2x})$ 和 $\\sqrt{x+1}+\\sqrt{x} \\approx 2\\sqrt{x}$。\n因此，$\\delta_2\\sqrt{x+1} - \\delta_1\\sqrt{x} \\approx \\delta_2\\sqrt{x} - \\delta_1\\sqrt{x} = (\\delta_2 - \\delta_1)\\sqrt{x}$。\n$$ \\varepsilon_f \\approx (\\delta_2 - \\delta_1)\\sqrt{x} \\cdot (2\\sqrt{x}) + \\delta_3 = 2x(\\delta_2 - \\delta_1) + \\delta_3 $$\n当 $x \\to \\infty$ 时，主导项是 $2x(\\delta_2 - \\delta_1)$。为了找到最坏情况下的量级，我们必须最大化 $|\\delta_2 - \\delta_1|$。由于 $|\\delta_1| \\le u$ 和 $|\\delta_2| \\le u$， $|\\delta_2 - \\delta_1|$ 的最大值是 $2u$，这发生在 $\\delta_1$ 和 $\\delta_2$ 符号相反且量级最大时（例如，$\\delta_2=u$ 和 $\\delta_1=-u$）。\n因此，相对前向误差的首项最坏情况下的渐近表达式为：\n$$ |\\varepsilon_f| \\approx |2x(2u)| = 4xu $$\n第一个要求的表达式是 $E = 4xu$。\n\n**2. 绝对后向误差分析**\n\n后向误差分析旨在找到输入 $x$ 上的一个扰动 $\\Delta$，使得计算结果 $\\widehat{f}$ 是扰动后输入的精确结果，即 $\\widehat{f} = f(x+\\Delta)$。\n使用 $f(x+\\Delta)$ 在 $x$ 附近的泰勒一阶展开：\n$$ f(x+\\Delta) \\approx f(x) + \\Delta f'(x) $$\n将其与计算值相等，得到 $\\widehat{f} \\approx f(x) + \\Delta f'(x)$。\n这意味着绝对误差是 $\\widehat{f} - f(x) \\approx \\Delta f'(x)$。\n我们可以解出 $\\Delta$：\n$$ \\Delta \\approx \\frac{\\widehat{f} - f(x)}{f'(x)} $$\n我们已经有了绝对误差的表达式：$\\widehat{f} - f(x) \\approx \\delta_2\\sqrt{x+1} - \\delta_1\\sqrt{x} + \\delta_3 f(x)$。\n接下来，我们求 $f(x)$ 的导数：\n$$ f'(x) = \\frac{d}{dx}(\\sqrt{x+1} - \\sqrt{x}) = \\frac{1}{2\\sqrt{x+1}} - \\frac{1}{2\\sqrt{x}} = \\frac{\\sqrt{x} - \\sqrt{x+1}}{2\\sqrt{x(x+1)}} $$\n现在我们求当 $x \\to \\infty$ 时，$\\Delta$ 表达式的分子和分母的渐近行为。\n\n对于分子，即绝对误差 $\\widehat{f} - f(x)$：当 $x \\to \\infty$ 时，$\\sqrt{x+1}\\approx\\sqrt{x}$ 且 $f(x) \\to 0$。绝对误差中的主导项是 $(\\delta_2-\\delta_1)\\sqrt{x}$。\n$$ \\widehat{f} - f(x) \\approx (\\delta_2-\\delta_1)\\sqrt{x} $$\n\n对于分母 $f'(x)$：当 $x \\to \\infty$ 时，分子 $\\sqrt{x} - \\sqrt{x+1} = -f(x) \\approx -\\frac{1}{2\\sqrt{x}}$。分母 $2\\sqrt{x(x+1)} \\approx 2x$。\n$$ f'(x) \\approx \\frac{-1/(2\\sqrt{x})}{2x} = -\\frac{1}{4x^{3/2}} $$\n将这些组合起来，求 $\\Delta$ 的渐近表达式：\n$$ \\Delta \\approx \\frac{(\\delta_2-\\delta_1)\\sqrt{x}}{-1/(4x^{3/2})} = -4x^2(\\delta_2-\\delta_1) $$\n为了找到 $|\\Delta|$ 的最坏情况下的量级，我们再次最大化 $|\\delta_2 - \\delta_1|$，其值为 $2u$。\n后向误差的首项最坏情况下的渐近量级是：\n$$ |\\Delta| \\approx |-4x^2(2u)| = 8x^2 u $$\n第二个要求的表达式是 $B = 8x^2u$。\n\n最终结果是包含最坏情况下相对前向误差和最坏情况下绝对后向误差量级表达式的二元行矩阵。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n4xu  8x^2u\n\\end{pmatrix}\n}\n$$", "id": "3231896"}]}