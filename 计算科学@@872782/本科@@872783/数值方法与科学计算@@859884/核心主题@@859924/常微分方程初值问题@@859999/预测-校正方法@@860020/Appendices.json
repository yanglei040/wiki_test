{"hands_on_practices": [{"introduction": "理解预测-校正方法的核心在于掌握其两步过程：首先进行一个初步的“预测”，然后利用该预测值进行更精确的“校正”。本练习将引导您完成一个基本的欧拉-梯形预测-校正法的单步计算。通过这个实践 [@problem_id:2194236]，您将亲手体验这一基本机制，为理解更复杂的多步法打下坚实的基础。", "problem": "考虑由以下常微分方程定义的初值问题：\n$$ y' = x^2 - y^2 $$\n初始条件为 $y(0) = 1$。\n\n你的任务是使用步长 $h=0.1$，通过执行单步欧拉预估-梯形校正法来近似 $y(0.1)$ 的值。\n\n将你的最终答案四舍五入到四位有效数字。", "solution": "我们将微分方程定义为 $y' = f(x,y)$，其中 $f(x,y) = x^{2} - y^{2}$，初始条件为 $y(0) = 1$。令 $h = 0.1$, $x_{0} = 0$，以及 $x_{1} = x_{0} + h = 0.1$。\n\n欧拉预估公式由下式给出\n$$\ny_{1}^{(p)} = y_{0} + h\\,f(x_{0},y_{0}).\n$$\n计算\n$f(x_{0},y_{0}) = f(0,1) = 0^{2} - 1^{2} = -1$,\n所以\n$y_{1}^{(p)} = 1 + 0.1(-1) = 0.9$.\n\n梯形校正公式（使用预估值进行一次校正）为\n$$\ny_{1} = y_{0} + \\frac{h}{2}\\left[f(x_{0},y_{0}) + f(x_{1},y_{1}^{(p)})\\right].\n$$\n计算\n$f(x_{1},y_{1}^{(p)}) = f(0.1,0.9) = (0.1)^{2} - (0.9)^{2} = 0.01 - 0.81 = -0.8$.\n因此\n$y_{1} = 1 + \\frac{0.1}{2}\\left[(-1) + (-0.8)\\right] = 1 + 0.05(-1.8) = 1 - 0.09 = 0.91$.\n\n四舍五入到四位有效数字，得到 $0.9100$。", "answer": "$$\\boxed{0.9100}$$", "id": "2194236"}, {"introduction": "掌握了单步计算后，下一步是学习如何将这些步骤串联起来，对一个时间区间进行积分。本练习 [@problem_id:2194665] 采用了一对更常用且精度更高的组合：两步 Adams-Bashforth 预测子和两步 Adams-Moulton 校正子。您将需要管理历史函数值来执行计算，这正是多步法的一个关键特征，这个练习将帮助您熟悉实际应用中的完整计算流程。", "problem": "一位工程师正在对一个系统进行初值问题的数值求解，该系统的行为由以下常微分方程描述：\n$$\n\\frac{dy}{dt} = y - t^2 + 1\n$$\n初始条件为 $y(0) = 0.5$。\n\n该求解过程使用固定步长 $h=0.2$ 的两步预测-校正方法在时间上推进。在从 $y_n$ 到 $y_{n+1}$ 的每一步中，算法按以下步骤进行：\n\n1.  **预测：** 使用两步 Adams-Bashforth 公式计算 $y_{n+1}$ 的估计值，记为 $y_{n+1}^p$：\n    $$\n    y_{n+1}^p = y_n + \\frac{h}{2} \\left( 3f_n - f_{n-1} \\right)\n    $$\n2.  **求值：** 使用预测值计算函数 $f$ 的值：$f_{n+1}^p = f(t_{n+1}, y_{n+1}^p)$。\n3.  **校正：** 使用带有预测值的两步 Adams-Moulton 公式计算 $y_{n+1}$ 的最终值：\n    $$\n    y_{n+1} = y_n + \\frac{h}{2} \\left( f_{n+1}^p + f_n \\right)\n    $$\n\n在这些公式中，$t_k = k \\cdot h$ 且 $f_k = f(t_k, y_k)$。为了执行从 $t_n$ 到 $t_{n+1}$ 的一步，算法需要其历史记录中最近的两次函数求值，即 $f_n$ 和 $f_{n-1}$。在完成一个完整的步骤（预测和校正）得到最终值 $y_{n+1}$ 后，计算新的函数值 $f_{n+1} = f(t_{n+1}, y_{n+1})$ 并更新历史记录以进行下一次迭代。\n\n作为一个多步法，它需要起始值。我们已知 $y_0 = y(0) = 0.5$。第一步的值 $y_1 = y(0.2)$ 已经使用更精确的单步法预先计算得出，结果为 $y_1 = 0.8293$。\n\n使用此方案，计算 $y(0.6)$ 的数值近似值。将您的最终答案四舍五入到四位有效数字。", "solution": "我们已知初值问题 $y' = f(t,y) = y - t^{2} + 1$，其中 $h=0.2$，$y_{0}=0.5$，$y_{1}=0.8293$。该两步预测-校正方法使用：\n- 预测公式 (Adams-Bashforth 2)：\n$$\ny_{n+1}^{p} = y_{n} + \\frac{h}{2}\\left(3f_{n} - f_{n-1}\\right)\n$$\n- 校正公式 (Adams-Moulton 2，使用预测的 $f_{n+1}^{p}$):\n$$\ny_{n+1} = y_{n} + \\frac{h}{2}\\left(f_{n+1}^{p} + f_{n}\\right)\n$$\n其中 $t_{k} = k h$ 且 $f_{k} = f(t_{k}, y_{k})$。\n\n计算初始函数值：\n$t_{0} = 0,\\quad y_{0} = 0.5,\\quad f_{0} = y_{0} - t_{0}^{2} + 1 = 0.5 + 1 = 1.5,$\n$t_{1} = 0.2,\\quad y_{1} = 0.8293,\\quad f_{1} = y_{1} - t_{1}^{2} + 1 = 0.8293 - 0.04 + 1 = 1.7893.$\n\n从 $t_{1}$ 到 $t_{2}=0.4$ 的步骤：\n- 预测：\n$y_{2}^{p} = y_{1} + \\frac{h}{2}\\left(3f_{1} - f_{0}\\right) = 0.8293 + 0.1\\left(3\\cdot 1.7893 - 1.5\\right) = 0.8293 + 0.38679 = 1.21609.$\n- 求值：\n$f_{2}^{p} = f(t_{2}, y_{2}^{p}) = y_{2}^{p} - t_{2}^{2} + 1 = 1.21609 - 0.16 + 1 = 2.05609.$\n- 校正：\n$y_{2} = y_{1} + \\frac{h}{2}\\left(f_{2}^{p} + f_{1}\\right) = 0.8293 + 0.1\\left(2.05609 + 1.7893\\right) = 0.8293 + 0.384539 = 1.213839.$\n- 更新：\n$f_{2} = f(t_{2}, y_{2}) = y_{2} - t_{2}^{2} + 1 = 1.213839 - 0.16 + 1 = 2.053839.$\n\n从 $t_{2}$ 到 $t_{3}=0.6$ 的步骤：\n- 预测：\n$y_{3}^{p} = y_{2} + \\frac{h}{2}\\left(3f_{2} - f_{1}\\right) = 1.213839 + 0.1\\left(3\\cdot 2.053839 - 1.7893\\right) = 1.213839 + 0.4372217 = 1.6510607.$\n- 求值：\n$f_{3}^{p} = f(t_{3}, y_{3}^{p}) = y_{3}^{p} - t_{3}^{2} + 1 = 1.6510607 - 0.36 + 1 = 2.2910607.$\n- 校正：\n$y_{3} = y_{2} + \\frac{h}{2}\\left(f_{3}^{p} + f_{2}\\right) = 1.213839 + 0.1\\left(2.2910607 + 2.053839\\right) = 1.213839 + 0.43448997 = 1.64832897.$\n\n因此，在 $t=0.6$ 处的数值近似值为 $y(0.6) \\approx 1.64832897$。四舍五入到四位有效数字得到 $1.648$。", "answer": "$$\\boxed{1.648}$$", "id": "2194665"}, {"introduction": "一个数值方法的优劣不仅在于其精度，还在于它是否能“尊重”其所模拟的物理系统的基本定律。本练习 [@problem_id:2194239] 将探讨一个深刻的问题：数值积分过程是否守恒能量？我们以简谐振子——一个具有精确能量守恒定律 $E = \\frac{1}{2}(v^2 + x^2)$ 的经典物理模型——为试验场，通过分析欧拉-梯形法单步计算后系统能量的变化，您将学会批判性地评估一个方法是否适用于保守系统的长期模拟。", "problem": "在计算物理学中，对任何数值积分算法的一个关键测试是其遵循其旨在建模的连续物理系统的守恒定律的能力。考虑物理学中的一个基本模型——简谐振子，它由二阶微分方程 $\\frac{d^2x}{dt^2} = -x$ 描述。这可以表示为一个由两个一阶常微分方程组成的系统：\n$$\n\\frac{dx}{dt} = v\n$$\n$$\n\\frac{dv}{dt} = -x\n$$\n其中 $x$ 是位置，$v$ 是速度。对于这个连续系统，总能量定义为 $E = \\frac{1}{2}(v^2 + x^2)$，它是一个守恒量。\n\n我们希望研究一种特定的数值方法——欧拉-梯形预测-校正法（Euler-Trapezoid predictor-corrector method）的能量守恒特性。为了将解从时间 $t_n$推进到 $t_{n+1} = t_n + h$（其中 $h$ 是步长），该方法分两个阶段进行：\n\n1.  **预测阶段**：首先，使用一个前向欧拉步从状态 $(x_n, v_n)$ 计算出一个中间的预测状态 $(\\tilde{x}_{n+1}, \\tilde{v}_{n+1})$：\n    $$\n    \\tilde{x}_{n+1} = x_n + h \\cdot v_n\n    $$\n    $$\n    \\tilde{v}_{n+1} = v_n + h \\cdot (-x_n)\n    $$\n2.  **校正阶段**：然后，通过应用梯形法则来计算最终状态 $(x_{n+1}, v_{n+1})$，该法则对步长开始时的导数 $(v_n, -x_n)$ 和预测的步长结束时的导数 $(\\tilde{v}_{n+1}, -\\tilde{x}_{n+1})$ 进行平均：\n    $$\n    x_{n+1} = x_n + \\frac{h}{2}(v_n + \\tilde{v}_{n+1})\n    $$\n    $$\n    v_{n+1} = v_n + \\frac{h}{2}(-x_n - \\tilde{x}_{n+1})\n    $$\n\n设 $E_n = \\frac{1}{2}(v_n^2 + x_n^2)$ 为系统在第 $n$ 步的数值能量。在使用步长为 $h$ 的此预测-校正方法进行单步计算后，能量将变为 $E_{n+1} = \\frac{1}{2}(v_{n+1}^2 + x_{n+1}^2)$。\n\n假设初始状态 $(x_n, v_n)$ 不是原点，请确定一步之后能量与初始能量之比 $E_{n+1}/E_n$ 作为步长 $h$ 的函数。", "solution": "我们从给定的针对系统 $x' = v$, $v' = -x$ 的预测-校正方案开始。\n\n预测阶段：\n$$\n\\tilde{x}_{n+1} = x_{n} + h v_{n}, \\qquad \\tilde{v}_{n+1} = v_{n} - h x_{n}.\n$$\n\n校正阶段：\n$$\nx_{n+1} = x_{n} + \\frac{h}{2}\\left(v_{n} + \\tilde{v}_{n+1}\\right), \\qquad v_{n+1} = v_{n} + \\frac{h}{2}\\left(-x_{n} - \\tilde{x}_{n+1}\\right).\n$$\n将预测值代入校正公式可得\n$$\nx_{n+1} = x_{n} + \\frac{h}{2}\\left(v_{n} + v_{n} - h x_{n}\\right) = \\left(1 - \\frac{h^{2}}{2}\\right)x_{n} + h v_{n},\n$$\n$$\nv_{n+1} = v_{n} + \\frac{h}{2}\\left(-x_{n} - (x_{n} + h v_{n})\\right) = -h x_{n} + \\left(1 - \\frac{h^{2}}{2}\\right)v_{n}.\n$$\n\n因此，单步更新可以写成矩阵形式\n$$\n\\begin{pmatrix} x_{n+1} \\\\ v_{n+1} \\end{pmatrix}\n=\n\\underbrace{\\begin{pmatrix} 1 - \\frac{h^{2}}{2}  h \\\\ -h  1 - \\frac{h^{2}}{2} \\end{pmatrix}}_{M}\n\\begin{pmatrix} x_{n} \\\\ v_{n} \\end{pmatrix}.\n$$\n令 $a = 1 - \\frac{h^{2}}{2}$ 且 $b = h$。则 $M = a I + b J$，其中\n$$\nI = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}, \\qquad J = \\begin{pmatrix} 0  1 \\\\ -1  0 \\end{pmatrix}.\n$$\n注意性质 $J^{T} = -J$ 和 $J^{2} = -I$。计算\n$$\nM^{T}M = (a I - b J)(a I + b J) = a^{2} I - b^{2} J^{2} = (a^{2} + b^{2}) I.\n$$\n对于任意状态向量 $w_{n} = \\begin{pmatrix} x_{n} \\\\ v_{n} \\end{pmatrix}$，这意味着\n$$\nx_{n+1}^{2} + v_{n+1}^{2} = \\|w_{n+1}\\|^{2} = w_{n}^{T} M^{T} M w_{n} = (a^{2} + b^{2}) \\|w_{n}\\|^{2} = (a^{2} + b^{2})(x_{n}^{2} + v_{n}^{2}).\n$$\n根据 $E_{n} = \\frac{1}{2}(x_{n}^{2} + v_{n}^{2})$，我们得到\n$$\n\\frac{E_{n+1}}{E_{n}} = \\frac{\\frac{1}{2}(x_{n+1}^{2} + v_{n+1}^{2})}{\\frac{1}{2}(x_{n}^{2} + v_{n}^{2})} = a^{2} + b^{2}.\n$$\n代入 $a = 1 - \\frac{h^{2}}{2}$ 和 $b = h$，\n$$\na^{2} + b^{2} = \\left(1 - \\frac{h^{2}}{2}\\right)^{2} + h^{2} = 1 - h^{2} + \\frac{h^{4}}{4} + h^{2} = 1 + \\frac{h^{4}}{4}.\n$$\n根据假设 $(x_{n}, v_{n}) \\neq (0,0)$，该比值是良定义的，并且与具体的初始状态无关。\n\n因此，\n$$\n\\frac{E_{n+1}}{E_{n}} = 1 + \\frac{h^{4}}{4}.\n$$", "answer": "$$\\boxed{1+\\frac{h^{4}}{4}}$$", "id": "2194239"}]}