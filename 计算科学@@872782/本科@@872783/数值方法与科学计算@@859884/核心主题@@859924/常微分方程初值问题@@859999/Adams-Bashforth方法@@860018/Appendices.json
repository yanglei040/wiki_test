{"hands_on_practices": [{"introduction": "多步法，顾名思义，需要利用前面几步的信息来计算当前步。这就引出了一个“启动”问题：在计算刚开始时，我们並沒有足够的历史数据。这个练习将引导你完成一个基本但至关重要的操作：使用像前向欧拉法这样的一步法来生成初始点，然后无缝切换到效率更高的Adams-Bashforth方法。[@problem_id:2152563] 掌握这个过程是应用任何多步法的第一步。", "problem": "考虑以下初值问题 (IVP)：\n$$ y'(t) = -y(t)\\sin(t), \\quad y(0) = 1 $$\n我们希望使用多步法求出 $y(0.3)$ 的一个数值近似。\n\n你需要使用两步 Adams-Bashforth (AB2) 方法，固定步长为 $h=0.1$。AB2 方法的公式由下式给出：\n$$ y_{n+1} = y_n + \\frac{h}{2}(3f_n - f_{n-1}) $$\n其中 $t_k = kh$，$y_k \\approx y(t_k)$，且 $f_k = f(t_k, y_k) = -y_k\\sin(t_k)$。\n\n由于 AB2 方法是两步法，它需要两个初始值来启动。使用给定的初始条件 $y_0 = y(0) = 1$，并使用前向欧拉法计算第一个近似值 $y_1 \\approx y(0.1)$：\n$$ y_{n+1} = y_n + h f_n $$\n在求出 $y_1$ 后，使用 AB2 方法计算后续步骤，以求出 $y(0.3)$ 的近似值。\n\n计算 $y(0.3)$ 近似值的数值。将你的最终答案四舍五入到五位有效数字。", "solution": "给定初值问题 $y'(t)=-y(t)\\sin(t)$，其中 $y(0)=1$，步长 $h=0.1$，且 $f(t,y)=-y\\sin(t)$。定义 $t_{k}=kh$，$y_{k}\\approx y(t_{k})$，且 $f_{k}=f(t_{k},y_{k})$。\n\n从前向欧拉法开始以获得 $y_{1}$：\n$$\ny_{0}=1,\\quad f_{0}=-y_{0}\\sin(0)=0,\\quad y_{1}=y_{0}+h f_{0}=1+0.1\\cdot 0=1.\n$$\n\n现在应用 AB2 方法 $y_{n+1}=y_{n}+\\frac{h}{2}\\left(3f_{n}-f_{n-1}\\right)$。\n\n计算到 $t_{2}=0.2$：\n$$\nf_{1}=-y_{1}\\sin(0.1)=-\\sin(0.1)\\approx -0.0998334166468282,\n$$\n$$\ny_{2}=y_{1}+\\frac{h}{2}\\left(3f_{1}-f_{0}\\right)=1+0.05\\left(3(-0.0998334166468282)-0\\right)\n=1-0.0149750124970242\\approx 0.9850249875029758.\n$$\n\n计算 $f_{2}$：\n$$\nf_{2}=-y_{2}\\sin(0.2)\\approx -0.9850249875029758\\cdot 0.19866933079506122\\approx -0.19569425508362975.\n$$\n\n计算到 $t_{3}=0.3$：\n$$\ny_{3}=y_{2}+\\frac{h}{2}\\left(3f_{2}-f_{1}\\right)\n=0.9850249875029758+0.05\\left(3(-0.19569425508362975)-(-0.0998334166468282)\\right)\n$$\n$$\n=0.9850249875029758+0.05\\left(-0.58708276525088925+0.0998334166468282\\right)\n=0.9850249875029758-0.0243624674302031\\approx 0.9606625200727727.\n$$\n\n因此，$y(0.3)$ 的 AB2 近似值为 $0.9606625200727727$，四舍五入到五位有效数字为 $0.96066$。", "answer": "$$\\boxed{0.96066}$$", "id": "2152563"}, {"introduction": "高阶方法一定更好吗？这个练习旨在挑战这种直觉。Adams-Bashforth方法依赖于多项式插值来外推未来的值，这隐含地假设了函数是光滑的。本练习通过一个在某点导数不光滑（存在“尖点”）的特例，生动地展示了当这个假设被违反时，高阶方法可能反而比简单的一阶方法产生更大的误差。[@problem_id:2152541] 这有助于培养我们在选择数值方法时批判性思考的能力。", "problem": "考虑由常微分方程给出的初值问题：\n$$\n\\frac{dy}{dt} = |t - 1|\n$$\n初始条件为 $y(0) = 0$。\n\n我们希望使用两种不同的数值方法来近似计算 $y(2.0)$ 的值，两种方法的步长均为 $h=1.0$。\n\n方法1是前向欧拉法，定义为：\n$y_{n+1} = y_n + h f(t_n, y_n)$。\n\n方法2是两步 Adams-Bashforth (AB2) 方法，定义为：\n$y_{n+1} = y_n + \\frac{h}{2} [3 f(t_n, y_n) - f(t_{n-1}, y_{n-1})]$。\n为了初始化 AB2 方法，第一步的值，即 $y(1.0)$ 的近似值，将使用一步前向欧拉法计算。\n\n设 $E_{FE}$ 为前向欧拉法的绝对误差 $|y_{true}(2.0) - y_{approx}^{FE}(2.0)|$，设 $E_{AB2}$ 为两步 Adams-Bashforth 方法的绝对误差 $|y_{true}(2.0) - y_{approx}^{AB2}(2.0)|$。\n\n根据您的计算，以下哪个陈述正确描述了这两个误差之间的关系？\n\nA. $E_{AB2}  E_{FE}$\n\nB. $E_{AB2} = E_{FE}$\n\nC. $E_{AB2} > E_{FE}$\n\nD. 两种方法都是精确的，即 $E_{AB2} = E_{FE} = 0$。\n\nE. Adams-Bashforth 方法无法应用，因为函数 $f(t,y)=|t-1|$ 在 $t=1$ 处不可微。", "solution": "我们给定的初值问题是 $y'(t) = |t - 1|$，其中 $y(0)=0$，我们要求解步长为 $h=1.0$ 时 $y(2.0)$ 的值。\n\n首先，计算在 $t=2$ 处的精确解。由于 $y'(t)=|t-1|$ 仅依赖于 $t$，解是积分\n$$\ny(t) = \\int_{0}^{t} |s - 1| \\, ds.\n$$\n因此，\n$$\ny(2) = \\int_{0}^{1} (1 - s) \\, ds + \\int_{1}^{2} (s - 1) \\, ds = \\left[ s - \\frac{s^{2}}{2} \\right]_{0}^{1} + \\left[ \\frac{s^{2}}{2} - s \\right]_{1}^{2} = \\frac{1}{2} + \\frac{1}{2} = 1.\n$$\n\n步长为 $h=1.0$ 的前向欧拉法 (FE) 使用 $t_{0}=0$, $t_{1}=1$, $t_{2}=2$，以及 $y_{0}=0$，其更新公式为\n$$\ny_{n+1} = y_{n} + h f(t_{n}, y_{n}), \\quad f(t,y)=|t-1|.\n$$\n从 $t_{0}$ 到 $t_{1}$ 的步骤：\n$$\ny_{1} = y_{0} + 1 \\cdot |0 - 1| = 0 + 1 = 1.\n$$\n从 $t_{1}$ 到 $t_{2}$ 的步骤：\n$$\ny_{2}^{FE} = y_{1} + 1 \\cdot |1 - 1| = 1 + 0 = 1.\n$$\n因此 $y_{approx}^{FE}(2.0)=1$，所以\n$$\nE_{FE} = |y_{true}(2.0) - y_{approx}^{FE}(2.0)| = |1 - 1| = 0.\n$$\n\n用一步前向欧拉法进行初始化的两步 Adams-Bashforth (AB2) 方法。前向欧拉法初始化得到 $y_{1}=1$，如上所示。AB2 的更新公式为\n$$\ny_{n+1} = y_{n} + \\frac{h}{2} \\big(3 f(t_{n}, y_{n}) - f(t_{n-1}, y_{n-1}) \\big).\n$$\n对于 $n=1$，步长 $h=1$，$t_{1}=1$，$t_{0}=0$，我们有\n$$\nf(t_{1}, y_{1}) = |1 - 1| = 0, \\quad f(t_{0}, y_{0}) = |0 - 1| = 1,\n$$\n所以\n$$\ny_{2}^{AB2} = y_{1} + \\frac{1}{2} \\big(3 \\cdot 0 - 1 \\big) = 1 - \\frac{1}{2} = \\frac{1}{2}.\n$$\n因此\n$$\nE_{AB2} = |y_{true}(2.0) - y_{approx}^{AB2}(2.0)| = \\left| 1 - \\frac{1}{2} \\right| = \\frac{1}{2}.\n$$\n\n因此，误差满足 $E_{AB2} > E_{FE}$。Adams-Bashforth 方法在这里是适用的，因为它只需要对 $f(t,y)$ 进行函数求值，而 $f(t,y)=|t-1|$ 在所需的点上是连续且良定义的；在单一点的不可微性并不妨碍该方法的应用。\n\n正确选项是 C。", "answer": "$$\\boxed{C}$$", "id": "2152541"}, {"introduction": "即使函数是光滑的，如果步长相对于解的变化速度过大，数值方法也可能失效，产生定性上错误的结果。这个练习通过标准测试方程 $y' = \\lambda y$ 探索了数值稳定性的概念。你将亲眼看到，一个看似合理的步长如何导致数值解出现非物理的振荡并最终偏离真解，从而揭示该方法固有的稳定性限制。[@problem_id:2152575]", "problem": "考虑由常微分方程 $y'(t) = -5y(t)$ 和初始条件 $y(0)=1$ 定义的初值问题。我们希望使用显式三步 Adams-Bashforth 方法来近似求解该问题。该方法的公式如下：\n$$y_{n+1} = y_n + \\frac{h}{12} (23 f_n - 16 f_{n-1} + 5 f_{n-2})$$\n其中 $h$ 是步长，$t_k = kh$，$y_k \\approx y(t_k)$，且 $f_k = f(t_k, y_k)$。\n\n使用步长 $h=0.3$。为了启动该多步过程，必须提供初始值 $y_0$、$y_1$ 和 $y_2$。假设这些初始值取自该初值问题在相应时间步 $t_0$、$t_1$ 和 $t_2$ 处的精确解析解。\n\n你的任务是确定最小的整数索引 $k  2$，使得数值计算值 $y_k$ 与精确解 $y(t_k)$ 的符号相反（即一个为正，另一个为负）。", "solution": "$y'(t)=-5y(t)$ 且 $y(0)=1$ 的精确解是 $y(t)=\\exp(-5t)$，对于所有 $t\\geq 0$，该解都满足 $y(t)0$。因此，对于所有 $k$，$y(t_{k})0$。\n\n对于显式三步 Adams-Bashforth 方法，\n$$\ny_{n+1}=y_{n}+\\frac{h}{12}\\left(23f_{n}-16f_{n-1}+5f_{n-2}\\right),\n$$\n其中 $f_{k}=f(t_{k},y_{k})=-5y_{k}$ 且 $h=0.3$，我们有\n$$\ny_{n+1}=y_{n}+\\frac{h}{12}\\left(-5\\right)\\left(23y_{n}-16y_{n-1}+5y_{n-2}\\right)\n= y_{n}-\\frac{5h}{12}\\left(23y_{n}-16y_{n-1}+5y_{n-2}\\right).\n$$\n由于 $5h/12=1/8$，上式可简化为\n$$\ny_{n+1}=y_{n}-\\frac{1}{8}\\left(23y_{n}-16y_{n-1}+5y_{n-2}\\right)\n=-\\frac{15}{8}y_{n}+2y_{n-1}-\\frac{5}{8}y_{n-2}.\n$$\n\n该方法使用精确值启动：\n$$\ny_{0}=1,\\quad y_{1}=\\exp(-5h)=\\exp(-1.5),\\quad y_{2}=\\exp(-10h)=\\exp(-3).\n$$\n计算 $y_{3}$：\n$$\ny_{3}=-\\frac{15}{8}y_{2}+2y_{1}-\\frac{5}{8}y_{0}\n=-\\frac{15}{8}\\exp(-3)+2\\exp(-1.5)-\\frac{5}{8}.\n$$\n令 $q=\\exp(-1.5)$，则 $\\exp(-3)=q^{2}$。那么\n$$\ny_{3}=-\\frac{15}{8}q^{2}+2q-\\frac{5}{8}.\n$$\n考虑 $g(q)=-\\frac{15}{8}q^{2}+2q-\\frac{5}{8}$。这是一个开口向下的二次函数，其顶点位于\n$$\nq^{\\ast}=\\frac{-2}{2\\left(-\\frac{15}{8}\\right)}=\\frac{8}{15}.\n$$\n其最大值为\n$$\ng\\!\\left(\\frac{8}{15}\\right)=-\\frac{15}{8}\\left(\\frac{64}{225}\\right)+2\\left(\\frac{8}{15}\\right)-\\frac{5}{8}\n=-\\frac{8}{15}+\\frac{16}{15}-\\frac{5}{8}\n=\\frac{8}{15}-\\frac{5}{8}\n=\\frac{64-75}{120}\n=-\\frac{11}{120}  0.\n$$\n因此对于所有 $q$，$g(q)  0$，特别是对于 $q=\\exp(-1.5)$。因此 $y_{3}  0$，而精确值 $y(t_{3})=\\exp(-4.5)0$。由于 $y_{0},y_{1},y_{2}$ 等于精确的正值，符号相反的最小索引 $k2$ 是 $k=3$。", "answer": "$$\\boxed{3}$$", "id": "2152575"}]}