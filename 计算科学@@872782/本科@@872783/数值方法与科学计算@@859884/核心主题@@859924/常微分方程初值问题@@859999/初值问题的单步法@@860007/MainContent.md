## 引言
常微分方程（ODEs）的初值问题（IVPs）是描述从[行星运动](@entry_id:170895)到[化学反应](@entry_id:146973)等各种动态系统的基本数学语言。然而，绝大多数现实世界中的IVP都无法求得解析解，这使得数值方法成为现代科学与工程研究中不可或缺的工具。在众多[数值算法](@entry_id:752770)中，[单步法](@entry_id:164989)因其概念清晰和易于实现而构成了[求解IVP](@entry_id:170405)的基石。本文旨在为读者提供一个关于[单步法](@entry_id:164989)的全面而深入的理解，不仅介绍算法本身，更重要的是剖析其背后的数学原理和在实践中选择与应用方法的智慧。

为实现此目标，本文将分为三个核心部分。首先，在“原理与机制”一章中，我们将深入探讨[单步法](@entry_id:164989)的构造，以通用的[龙格-库塔](@entry_id:140452)框架为核心，系统性地分析决定其性能的精度和稳定性两大支柱，并延伸至[刚性问题](@entry_id:142143)和[几何积分](@entry_id:261978)等高级主题。接着，在“应用与跨学科联系”一章中，我们将展示这些理论如何在物理学、生物学、工程学乃至机器学习等不同领域中发挥作用，通过具体案例揭示理论与实践的紧密联系。最后，通过一系列“动手实践”练习，我们鼓励读者亲手实现和验证关键概念，例如[误差分析](@entry_id:142477)、[自适应步长控制](@entry_id:142684)等，从而将理论知识转化为真正的计算能力。

## 原理与机制

本章旨在深入探讨[求解初值问题](@entry_id:170405)（IVP）的单步方法的内在原理与核心机制。在上一章“引言”的基础上，我们将超越简单的算法描述，系统地剖析决定数值方法性能的三个关键维度：精度、稳定性与结构保持性。我们将从单步方法的基本构造出发，逐步揭示这些方法如何逼近真实解，为何某些方法在特定问题上表现优异而另一些则完全失效，以及如何为现代科学与工程中的复杂问题（如刚性系统、哈密顿系统和[微分代数方程](@entry_id:748394)）设计和选择合适的[数值积分器](@entry_id:752799)。

### 单步方法的构造与抽象框架

单步方法构成了[求解常微分方程](@entry_id:635033)[初值问题](@entry_id:144620)（$y'(t) = f(t, y(t))$, $y(t_0) = y_0$）的一大类[数值算法](@entry_id:752770)。其核心思想在于，仅利用当前时间步 $(t_n, y_n)$ 的信息来计算下一个时间步的近似解 $y_{n+1}$。这一过程可以抽象地表示为：

$y_{n+1} = y_n + h \Phi(t_n, y_n, h)$

其中，$h = t_{n+1} - t_n$ 是步长，$y_n \approx y(t_n)$ 是在时间 $t_n$ 的[数值近似](@entry_id:161970)解，而函数 $\Phi$ 被称为**增量函数**，它具体定义了一个单步方法的特征。

虽然存在无数种可能的增量函数，但其中最重要和最通用的一族是**[龙格-库塔](@entry_id:140452) ([Runge-Kutta](@entry_id:140452), RK) 方法**。RK方法通过在时间步 $[t_n, t_{n+1}]$ 内部计算若干个“中间级”（stages）的导数值，然后将它们加权平均来构造增量函数，从而实现更高阶的精度。一个通用的 $s$ 级[龙格-库塔方法](@entry_id:144251)由以下公式定义：

首先，计算 $s$ 个中间级斜率 $k_i$：
$k_i = f\left(t_n + c_i h, y_n + h \sum_{j=1}^{s} a_{ij} k_j \right), \quad i=1, \dots, s$

然后，通过这些斜率的加权和来更新解：
$y_{n+1} = y_n + h \sum_{i=1}^{s} b_i k_i$

这个方法的所有系数——节点 $c_i$、[系数矩阵](@entry_id:151473) $A = (a_{ij})$ 和权重 $b_i$——可以方便地组织在一个称为**[布彻表](@entry_id:170706) (Butcher Tableau)** 的表格中：

$$
\begin{array}{c|c}
c & A \\
\hline
 & b^{\top}
\end{array}
=
\begin{array}{c|cccc}
c_1 & a_{11} & a_{12} & \dots & a_{1s} \\
c_2 & a_{21} & a_{22} & \dots & a_{2s} \\
\vdots & \vdots & \vdots & \ddots & \vdots \\
c_s & a_{s1} & a_{s2} & \dots & a_{ss} \\
\hline
 & b_1 & b_2 & \dots & b_s
\end{array}
$$

RK框架的强大之处在于其普适性。许多看似不同的方法都可以被统一到这个框架下。例如，考虑一个由两步构成的复合方法：首先，使用步长为 $\theta h$ 的**[显式欧拉法](@entry_id:141307)**进行预测；然后，从该预测点出发，使用步长为 $(1-\theta)h$ 的**[隐式欧拉法](@entry_id:176177)**进行校正 [@problem_id:3259757]。具体公式为：

1.  预测步：$y^{(1)} = y_n + \theta h f(t_n, y_n)$
2.  校正步：$y_{n+1} = y^{(1)} + (1-\theta) h f(t_{n+1}, y_{n+1})$

将第一步代入第二步，我们得到完整的更新公式：
$y_{n+1} = y_n + \theta h f(t_n, y_n) + (1-\theta) h f(t_{n+1}, y_{n+1})$

为了将其转化为RK形式，我们定义两个级斜率：$k_1 = f(t_n, y_n)$ 和 $k_2 = f(t_{n+1}, y_{n+1})$。于是更新公式变为 $y_{n+1} = y_n + h(\theta k_1 + (1-\theta) k_2)$。这直接给出了权重 $b = (\theta, 1-\theta)^{\top}$。接着，我们分析 $k_1$ 和 $k_2$ 的表达式以确定系数矩阵 $A$ 和节点 $c$。
- 对于 $k_1 = f(t_n, y_n)$，它对应于 $k_1 = f(t_n + c_1 h, y_n + h(a_{11}k_1 + a_{12}k_2))$。比较可知，$c_1=0$、$a_{11}=0$、$a_{12}=0$。
- 对于 $k_2 = f(t_{n+1}, y_{n+1})$，它对应于 $k_2 = f(t_n + c_2 h, y_n + h(a_{21}k_1 + a_{22}k_2))$。时间参数的比较给出 $t_{n+1} = t_n+h$，因此 $c_2=1$。状态参数的比较给出 $y_{n+1} = y_n + h(a_{21}k_1 + a_{22}k_2)$。将其与我们之前导出的 $y_{n+1}$ 表达式相匹配，我们得到 $a_{21}=\theta$ 和 $a_{22}=1-\theta$。

综上所述，这个复合方法的[布彻表](@entry_id:170706)为 [@problem_id:3259757]：
$$
\begin{array}{c|cc}
0 & 0 & 0 \\
1 & \theta & 1-\theta \\
\hline
 & \theta & 1-\theta
\end{array}
$$
这个例子清晰地展示了如何将一个具体的过程抽象为RK框架，从而能够利用更一般化的理论工具进行分析。

### 精度：数值解与真实解的接近程度

一个数值方法的核心价值在于其逼近真实解的能力。我们从两个层面来衡量这种能力：局部和全局。

**[局部截断误差](@entry_id:147703) (Local Truncation Error, LTE)** 指的是方法在**单步**积分中引入的误差，假设步的起点 $y_n$ 是精确的，即 $y_n = y(t_n)$。LTE $\tau_n(h)$ 定义为：

$\tau_n(h) = \frac{y(t_{n+1}) - \left( y(t_n) + h \Phi(t_n, y(t_n), h) \right)}{h}$

它衡量了真实解 $y(t_{n+1})$ 与数值方法从真实解 $y(t_n)$ 出发产生的一步近似值之间的差异，并按步长 $h$ 进行了归一化。

一个方法被称为是**相容的 (consistent)**，如果当步长 $h$ 趋于零时，其[局部截断误差](@entry_id:147703)也趋于零，即 $\lim_{h \to 0} \tau_n(h) = 0$。相容性是任何有用方法的基本要求，它确保了[数值格式](@entry_id:752822)在局部上确实是在逼近原[微分方程](@entry_id:264184)。

**[全局截断误差](@entry_id:143638) (Global Truncation Error)**，或简称为**全局误差**，是指在经过多步积分后，在某个固定的最终时间 $T$ 处，数值解 $y_N$ 与真实解 $y(T)$ 之间的总偏差 $E(h) = |y_N - y(T)|$。[全局误差](@entry_id:147874)是局部误差在整个积分区间上[累积和](@entry_id:748124)传播的结果。

对于一个表现良好的方法，全局误差会随着步长 $h$ 的减小而减小。这种关系通常可以表示为 $E(h) \approx C h^p$，其中 $C$ 是一个常数，$p$ 是方法的**[收敛阶](@entry_id:146394) (order of convergence)**。阶数 $p$ 是衡量方法效率的关键指标：一个 $p=4$ 的方法将步长减半，误差大约会减少到原来的 $1/16$，而一个 $p=1$ 的方法，误差仅减少到 $1/2$。

为了在实践中验证一个方法的阶数，我们可以通过数值实验来计算**观测阶**。假设误差服从 $E(h) = C h^p$，那么对于步长 $h$ 和 $h/2$，我们有：

$\frac{E(h)}{E(h/2)} \approx \frac{C h^p}{C (h/2)^p} = 2^p$

取以2为底的对数，即可解出 $p$：

$p \approx \log_2\left(\frac{E(h)}{E(h/2)}\right)$

当 $h \to 0$ 时，这个观测阶会逼近理论阶。例如，让我们用**休恩 (Heun) 方法**来验证这个过程 [@problem_id:3259636]。休恩方法，也称为[改进欧拉法](@entry_id:171291)或显式[梯形法](@entry_id:634036)，是一个二阶RK方法，其公式为：

$y_{n+1} = y_n + \frac{h}{2} \left( f(t_n, y_n) + f(t_n + h, y_n + h f(t_n, y_n)) \right)$

对于一个已知精确解（例如 $y'(t) = -2ty(t)+t$, $y(0)=1$ 的解是 $y(t) = \frac{1}{2} + \frac{1}{2}\exp(-t^2)$），我们可以使用不同步长 $h$ 计算到终点 $T=1$ 的[全局误差](@entry_id:147874)。实验表明，当我们比较 $h=0.5$ 和 $h=0.25$ 时的误差，以及 $h=0.25$ 和 $h=0.125$ 时的误差，计算出的观测阶 $p$ 会非常接近理论值 $2$。这为该方法的[二阶收敛](@entry_id:174649)性提供了有力的数值证据。

那么，一个方法的阶数是如何确定的呢？理论上，这需要将数值方法的单步更新公式围绕 $(t_n, y_n)$ 进行[泰勒展开](@entry_id:145057)，并与真实解 $y(t_{n+1})$ 的[泰勒展开](@entry_id:145057)进行比较。为了使方法的[局部截断误差](@entry_id:147703)为 $\mathcal{O}(h^p)$（这通常对应于[全局误差](@entry_id:147874)为 $\mathcal{O}(h^p)$），两个展开式中直到 $h^p$ 的所有项都必须完全匹配。这会产生一系列关于[布彻表](@entry_id:170706)系数的代数方程，称为**阶条件 (order conditions)**。

例如，为了达到四阶精度，RK方法的系数必须满足8个独立的[非线性方程](@entry_id:145852)。这些方程是通过匹配 $y', y'', y''', y^{(4)}$ 的展开式得到的。以 $y^{(4)}$ 的展开为例，它包含了多种导数的组合，对应着不同的**基本[微分](@entry_id:158718) (elementary differentials)**。其中一项源于 $f'''(f,f,f)$ [@problem_id:3259602]。通过繁琐但直接的推导，可以发现，为了匹配这一项，RK方法的系数必须满足条件：

$\sum_{i=1}^{s} b_i c_i^3 = \frac{1}{4}$

这是四阶精度的8个条件之一。这揭示了[高阶方法](@entry_id:165413)设计的复杂性：我们必须精心[选择系数](@entry_id:155033)，以满足一个不断增长的[方程组](@entry_id:193238)。

### 稳定性：误差是否会无限放大？

精度告诉我们方法在局部有多准，但稳定性则关系到这些局部误差在全局积分过程中的传播行为。一个不稳定的方法，即使局部精度很高，其计算结果也毫无价值。

一个方法的**稳定性**指的是，在数值积分过程中，对初始值的微小扰动（或由计算引入的[舍入误差](@entry_id:162651)）的影响是受控的，不会被无限放大。这一概念由**[达尔奎斯特等价定理](@entry_id:634938) (Dahlquist's Equivalence Theorem)** 精炼地总结：

> 对于一个相容的单步方法，其收敛的充分必要条件是该方法是**零稳定的 (zero-stable)**。

“零稳定”是稳定性的一种形式，对于单步方法而言，它通常是自动满足的，只要增量函数 $\Phi$ 对 $y$ 是[利普希茨连续的](@entry_id:267396)。然而，理解其精神至关重要。我们可以通过一个反例来深刻体会稳定性的必要性 [@problem_id:3259698]。考虑以下为求解 $y'=\cos(t), y(0)=0$ 而构造的单步方法：

$y_{n+1} = 2 y_{n} + h \cos(t_{n}) - \sin(t_{n})$

首先，我们分析其相容性。其[局部截断误差](@entry_id:147703)为 $\tau_n(h) = -\frac{h}{2}\sin(t_n) + \mathcal{O}(h^2)$。当 $h \to 0$ 时，LTE 趋于零，因此该方法是相容的。

然而，我们来考察其稳定性。假设有两个从略微不同的初始值 $y_0$ 和 $z_0$ 出发的数值序列。它们之间的差值 $\delta_n = y_n - z_n$ 的演化规律为：
$\delta_{n+1} = y_{n+1} - z_{n+1} = (2y_n + \dots) - (2z_n + \dots) = 2\delta_n$

这意味着每一步，扰动都会被放大一倍！经过 $N=T/h$ 步后，初始扰动 $\delta_0$ 会被放大 $2^N = 2^{T/h}$ 倍。当步长 $h \to 0$ 时，$T/h \to \infty$，这个[放大因子](@entry_id:144315)会爆炸性增长。因此，该方法是**不稳定**的。

根据等价定理，这个相容但不稳定的方法必然不收敛。任何微小的误差都会被指数级放大，导致数值解迅速偏离真实解 $y(t)=\sin(t)$。这个例子雄辩地证明了，相容性只是方法有效性的门槛，而稳定性才是其能否在实际中使用的生命线。

### [绝对稳定性](@entry_id:165194)与刚性问题

之前讨论的稳定性（[零稳定性](@entry_id:178549)）关注的是在 $h \to 0$ 极限下的行为。在实际计算中，我们使用有限的步长 $h$，此时我们需要一个更实用的概念：**[绝对稳定性](@entry_id:165194)**。

[绝对稳定性](@entry_id:165194)的分析通常基于一个简单的**线性测试方程**：
$y' = \lambda y, \quad \lambda \in \mathbb{C}$

这个方程虽然简单，但它捕捉了非线性系统局部动力学的本质，因为 $\lambda$ 可以被看作是系统[雅可比矩阵的特征值](@entry_id:264008)。将一个单步RK方法应用于该测试方程，可以得到一个递推关系：

$y_{n+1} = R(z) y_n, \quad \text{其中 } z = h\lambda$

函数 $R(z)$ 被称为方法的**[放大因子](@entry_id:144315)**或**[稳定性函数](@entry_id:178107)**。它完全决定了数值解的增长行为。为了使数值解不发散（即 $|y_{n+1}| \le |y_n|$），我们要求 $|R(z)| \le 1$。

一个方法的**[绝对稳定域](@entry_id:171484) (region of absolute stability)** 定义为复平面上所有满足 $|R(z)| \le 1$ 的点 $z$ 的集合 $\mathcal{S}$。
$\mathcal{S} = \{ z \in \mathbb{C} \mid |R(z)| \le 1 \}$

对于一个给定的问题（由 $\lambda$ 决定），为了保证数值解的稳定，我们必须选择步长 $h$，使得 $z=h\lambda$ 落在方法的[绝对稳定域](@entry_id:171484)内。

我们可以通过数值计算来可视化一个方法的稳定域 [@problem_id:3259596]。对于显式RK方法，其[稳定性函数](@entry_id:178107) $R(z)$ 是一个关于 $z$ 的多项式。我们可以通过在复平面的一个网格上计算 $|R(z)|$ 的值，并检查其是否小于等于1，来绘制稳定域的图像。
- **[显式欧拉法](@entry_id:141307)** ($s=1$)：$R(z) = 1+z$。稳定域是一个以 $(-1,0)$ 为圆心，半径为1的圆盘。
- **休恩方法** ($s=2$)：$R(z) = 1+z+\frac{1}{2}z^2$。稳定域比[欧拉法](@entry_id:749108)更大。
- **经典四阶RK方法** ($s=4$)：$R(z) = 1+z+\frac{1}{2}z^2+\frac{1}{6}z^3+\frac{1}{24}z^4$。其稳定域进一步扩大。

一个重要的观察是，所有**显式RK方法**的稳定域都是有界的。这对求解**刚性 (stiff)** 问题构成了严重障碍。刚性问题是指系统包含多个时间尺度差异巨大的动态过程，对应于[雅可比矩阵的特征值](@entry_id:264008) $\lambda$ 在模长上相差悬殊。其中，模长非常大的负实部[特征值](@entry_id:154894) $\lambda$ 会要求步长 $h$ 必须非常小，才能使得 $h\lambda$ 落在有界的稳定域内，即使这个快速衰减的模态对解的长期行为几乎没有贡献。这种稳定性的限制而非精度的限制，使得用显式方法求解[刚性问题](@entry_id:142143)变得极其低效。

为了克服这一困难，我们需要具有更大稳定域的方法。最理想的情况是，稳定域包含整个左半复平面 $\mathbb{C}^- = \{z \in \mathbb{C} \mid \Re(z) \le 0\}$。具有此性质的方法被称为 **A-稳定的 (A-stable)**。[A-稳定方法](@entry_id:746185)可以对任何稳定的[线性系统](@entry_id:147850)（所有 $\Re(\lambda) \le 0$）使用任意大的步长而保持数值稳定。

一个经典的例子是**$\theta$-方法** [@problem_id:3259608]，其公式为：
$y_{n+1}=y_{n}+h\left[\theta f(t_{n+1},y_{n+1})+\left(1-\theta\right) f(t_{n},y_{n})\right]$

其[稳定性函数](@entry_id:178107)为 $R(z) = \frac{1 + (1-\theta)z}{1 - \theta z}$。通过分析不等式 $|R(z)|^2 \le 1$ 对所有 $\Re(z) \le 0$ 成立的条件，可以推导出，该方法是A-稳定的当且仅当 $\theta \ge \frac{1}{2}$。这意味着：
- **[隐式欧拉法](@entry_id:176177)** ($\theta=1$) 是A-稳定的。
- **Crank-Nicolson (梯形) 方法** ($\theta=1/2$) 是A-稳定的。
- **[显式欧拉法](@entry_id:141307)** ($\theta=0$) 不是A-稳定的。

稳定域的形状也直接影响方法对特定类型问题的适用性。例如，对于描述无[阻尼振荡](@entry_id:167749)的系统（如理想弹簧或摆），其[雅可比矩阵的特征值](@entry_id:264008)是纯虚数 $\lambda=i\omega$。这意味着 $z=h\lambda$ 位于虚轴上。如果一个方法的稳定域不包含虚轴上的任何片段，它就无法稳定地积分这类问题，通常会人为地引入[数值耗散](@entry_id:168584)（能量衰减）或反耗散（能量增长）。例如，**[显式中点法](@entry_id:137018)**的[稳定性函数](@entry_id:178107)是 $R(z)=1+z+\frac{1}{2}z^2$。对于[虚轴](@entry_id:262618)上的点 $z=ix$（$x \in \mathbb{R}$），其模长的平方为 $|R(ix)|^2 = 1+\frac{1}{4}x^4$，这对于任何 $x \ne 0$ 都大于1 [@problem_id:3259689]。因此，该方法会放大无阻尼振荡的能量，不适用于此类问题的[精确模拟](@entry_id:749142)。

### 高级主题与现代视角

超越了传统的精度和稳定性分析，现代数值方法的设计还关注更深层次的性质，特别是与问题的物理或几何结构相关的性质。

#### [几何积分](@entry_id:261978)与辛方法

对于许[多源](@entry_id:170321)于物理学的系统，特别是力学中的**[哈密顿系统](@entry_id:143533)**，保持某些物理[不变量](@entry_id:148850)（如能量、动量、相空间体积）比单纯追求高阶局部精度更为重要。**[几何积分](@entry_id:261978)**就是致力于设计能够精确保持这些离散模拟中结构性质的算法。

一个典型的例子是[简谐振子](@entry_id:145764)，其[哈密顿量](@entry_id:172864)（能量）为 $H(q,p) = \frac{1}{2}(q^2+p^2)$。其运动方程为 $dq/dt = p, dp/dt = -q$。精确解在相空间中沿着一个[圆周运动](@entry_id:269135)，能量 $H$ 保持恒定。我们来比较三种方法在该问题上的长期表现 [@problem_id:3259633]：
- **[显式欧拉法](@entry_id:141307)**：数值结果显示能量会随时间[指数增长](@entry_id:141869)，[轨道](@entry_id:137151)呈螺旋形向外发散。
- **[隐式欧拉法](@entry_id:176177)**：能量会指数衰减，[轨道](@entry_id:137151)螺旋形向内收缩。
- **[辛欧拉](@entry_id:174650)法 (Symplectic Euler)**：这是一个简单的[几何积分](@entry_id:261978)器，其更新方式为 $p_{n+1} = p_n - h q_n, q_{n+1} = q_n + h p_{n+1}$。数值结果显示，虽然[哈密顿量](@entry_id:172864) $H$ 本身不是严格守恒的，但它在一个非常小的范围内[振荡](@entry_id:267781)。能量误差在很长的时间内保持有界，[轨道](@entry_id:137151)也近似地保持在原来的圆周附近。

这种卓越的[长期行为](@entry_id:192358)源于辛方法能够精确地保持相空间的**辛结构**（一种广义的面积保持性质）。这防止了系统性的[能量漂移](@entry_id:748982)，使其成为长期模拟[保守系统](@entry_id:167760)的首选。

#### 刚性问题中的阶数退化

在求解刚性问题时，高阶隐式方法可能会出现一种被称为**阶数退化 (order reduction)** 的现象。即，方法的观测阶会低于其理论上的经典阶数。这种现象的根源在于方法的**级阶 (stage order)**。级阶 $q$ 衡量了RK方法的内部级 $Y_i$ 逼近真实解在对应时间点 $y(t_n+c_i h)$ 的精度。对于非刚性问题，最终解的精度由权重 $b_i$ 巧妙组合所决定的经典阶 $p$ 控制。但在刚性问题中，由于快速衰减模的存在，内部级的精度变得至关重要。如果级阶 $q$ 低于经典阶 $p$，那么[全局误差](@entry_id:147874)将由级阶 $q$ 主导。

一个典型的例子是使用高斯-勒让德方法求解Prothero-Robinson问题 [@problem_id:3259622]。这是一个形式为 $y'(t)=\lambda(y(t)-\phi(t))+\phi'(t)$ 的刚性测试问题，其精确解就是 $y(t)=\phi(t)$。两级高斯-勒让德方法是一个经典的4阶方法($p=4$)，但其级阶为2 ($q=2$)。数值实验表明：
- 当问题非刚性时（例如 $\lambda=-1$），该方法表现出预期的4阶收敛。
- 当问题是刚性或极端刚性时（例如 $\lambda=-1000$ 或 $\lambda=-10^6$），观测到的[收敛阶](@entry_id:146394)会显著下降，并稳定在2阶左右。

这一现象警示我们，在[刚性问题](@entry_id:142143)背景下，不能盲目相信方法的经典阶数；具有高阶级（或满足某些额外刚性精度条件）的方法会表现得更稳健。

#### 刚性精确方法与[微分代数方程](@entry_id:748394)

单步方法的研究最终延伸到了更广义的**[微分代数方程 (DAE)](@entry_id:193643)**。一类常见的DAE是半显式指标-1系统，形如：
$y'(t) = f(t, y, z)$
$0 = g(t, y, z)$

这里，$y$ 是[微分](@entry_id:158718)变量，$z$ 是代数变量，它通过代数约束 $g=0$ 与 $y$ 和 $t$ 关联。在使用隐式RK方法求解DAE时，代数约束必须在每个（或某些）内部级上得到满足。

在这种背景下，一类称为**刚性精确 (stiffly accurate)** 的RK方法展现出独特的优势 [@problem_id:3259665]。一个RK方法是刚性精确的，如果它的最后一个级恰好就是时间步的终点（$c_s=1$），并且更新权值与最后一级的系数相同（$a_{sj}=b_j, \forall j$）。

这些条件带来了两个关键好处：
1.  **避免约束漂移**：由于 $y_{n+1} = Y_s$ 且 $t_{n+1} = t_n+c_s h$，最后一个内部级的代数约束 $g(t_{n+1}, Y_s, Z_s)=0$ 直接保证了终点解 $(y_{n+1}, z_{n+1})$ 也满足代数约束。这从根本上消除了数值解在多步积分后逐渐偏离约束[流形](@entry_id:153038)的**约束漂移**问题。
2.  **提高计算效率**：对于非刚性精确方法，在计算完所有内部级并得到 $y_{n+1}$ 后，通常还需要一个独立的[非线性](@entry_id:637147)求解步骤来从 $g(t_{n+1}, y_{n+1}, z)=0$ 中解出 $z_{n+1}$。而对于刚性精确方法，由于 $z_{n+1}=Z_s$，终点的代数变量已经作为最后一个级求解的一部分计算出来了，无需额外的求解步骤，从而减少了每一步的计算量。

因此，刚性精确性虽然最初可能是为处理[刚性ODE](@entry_id:143281)的无穷远处稳定性（[L-稳定性](@entry_id:143644)）而引入，但它在求解DAE时表现出的这些几何和计算上的优良特性，使其成为该领域现代求解器的关键设计原则之一。