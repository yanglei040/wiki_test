## 引言
在数值线性代数领域，[相似变换](@entry_id:152935)是一种极其强大的基础工具，它构成了我们理解、分析和计算[矩阵特征值](@entry_id:156365)的理论基石。[特征值](@entry_id:154894)作为一个系统的内在“指纹”，描述了从物理[振动频率](@entry_id:199185)到动态[系统稳定性](@entry_id:273248)等一系列核心特性。然而，直接从一个复杂矩阵中提取这些信息往往异常困难。这就引出了一个核心问题：我们能否在不改变矩阵根本谱特性的前提下，将其转化为一种更简单、更易于分析的形式？

相似变换正是解决这一问题的关键。它允许我们通过一次“[坐标系](@entry_id:156346)”的更换，来审视同一个线性变换，从而在保持[特征值](@entry_id:154894)不变的同时，将[矩阵化](@entry_id:751739)为对角、三角或[若尔当标准型](@entry_id:155670)等更具洞察力的结构。本文将系统地剖析[相似变换](@entry_id:152935)的理论框架与实际应用。首先，在“原理与机制”一章中，我们将从第一性原理出发，揭示相似变换为何能保持[特征值](@entry_id:154894)不变，并辨析其所保持与不保持的各类矩阵属性。接着，在“应用和跨学科联系”一章中，我们将跨越学科边界，展示相似变换如何在[数值算法](@entry_id:752770)（如QR迭代）、量子力学、控制理论和数据科学等领域中扮演关键角色。最后，通过一系列“动手实践”的练习，您将有机会将理论知识应用于解决具体问题，从而深化对这一核心概念的理解。

## 原理与机制

在数值线性代数中，相似变换是理解和计算[矩阵特征值](@entry_id:156365)的核心工具。它允许我们将一个矩阵转换为一个结构更简单（例如，对角或三角形式）的矩阵，同时保持其谱特性（即[特征值](@entry_id:154894)）不变。本章将深入探讨相似变换的原理、其对矩阵各种性质的影响，以及这些原理在数值计算稳定性方面的重要意义。

### 相似变换的定义与基本性质

我们称两个方阵 $A, B \in \mathbb{C}^{n \times n}$ 是**相似 (similar)** 的，如果存在一个[可逆矩阵](@entry_id:171829) $S \in \mathbb{C}^{n \times n}$，使得：
$$
B = S^{-1} A S
$$
这个过程称为对矩阵 $A$ 的**相似变换 (similarity transformation)**，而矩阵 $S$ 称为变换矩阵。

这个定义具有深刻的几何意义。一个 $n \times n$ 矩阵 $A$ 可以被看作是[向量空间](@entry_id:151108) $\mathbb{C}^n$ 上的一个线性算子在某个标准基下的表示。[相似变换](@entry_id:152935) $B = S^{-1}AS$ 的本质，是同一个线性算子在另一个由 $S$ 的列向量构成的基下的表示。矩阵 $S$ 扮演了**[基变换矩阵](@entry_id:184480) (change-of-basis matrix)** 的角色 [@problem_id:3273865]。因此，[相似矩阵](@entry_id:155833) $A$ 和 $B$ 描述的是同一个内在的线性变换，只是从不同的“视角”（即[坐标系](@entry_id:156346)）观察而已。

既然 $A$ 和 $B$ 代表同一个[线性算子](@entry_id:149003)，我们可以预期该算子的内在属性（那些不依赖于[坐标系](@entry_id:156346)选择的属性）在相似变换下应保持不变。其中最核心的[不变量](@entry_id:148850)是**[特征多项式](@entry_id:150909) (characteristic polynomial)**。

一个矩阵 $A$ 的[特征多项式](@entry_id:150909)定义为 $p_A(\lambda) = \det(\lambda I - A)$。让我们来推导[相似矩阵](@entry_id:155833) $B$ 的[特征多项式](@entry_id:150909) $p_B(\lambda)$：
$$
\begin{align*}
p_B(\lambda)  &= \det(\lambda I - B) \\
 &= \det(\lambda I - S^{-1} A S) \\
 &= \det(\lambda S^{-1}S - S^{-1} A S) \\
 &= \det(S^{-1}(\lambda I - A)S)
\end{align*}
$$
利用[行列式的乘法性质](@entry_id:148055) $\det(XYZ) = \det(X)\det(Y)\det(Z)$，我们得到：
$$
p_B(\lambda) = \det(S^{-1}) \det(\lambda I - A) \det(S)
$$
因为 $\det(S^{-1}) = 1/\det(S)$，并且[行列式](@entry_id:142978)是一个标量，可以自由交换位置，所以：
$$
p_B(\lambda) = \left(\frac{1}{\det(S)}\right) \det(S) \det(\lambda I - A) = \det(\lambda I - A) = p_A(\lambda)
$$
这个推导从第一性原理出发，证明了[相似变换](@entry_id:152935)不改变矩阵的[特征多项式](@entry_id:150909) [@problem_id:3273940]。这一结论至关重要，它直接引出了一系列重要的**[相似不变量](@entry_id:149886) (similarity invariants)**：

1.  **[特征值](@entry_id:154894) (Eigenvalues)**：由于[特征值](@entry_id:154894)是[特征多项式的根](@entry_id:270910)，因此[相似矩阵](@entry_id:155833) $A$ 和 $B$ 拥有完全相同的[特征值](@entry_id:154894)集合，包括每个[特征值](@entry_id:154894)的**[代数重数](@entry_id:154240) (algebraic multiplicity)**。

2.  **迹 (Trace)**：[矩阵的迹](@entry_id:139694)是其对角元素之和，也等于其所有[特征值](@entry_id:154894)之和。由于[特征值](@entry_id:154894)不变，迹也是一个[相似不变量](@entry_id:149886)。即 $\operatorname{trace}(A) = \operatorname{trace}(B)$。

3.  **[行列式](@entry_id:142978) (Determinant)**：矩阵的行列式等于其所有[特征值](@entry_id:154894)之积。因此，[行列式](@entry_id:142978)也是一个[相似不变量](@entry_id:149886)。即 $\det(A) = \det(B)$。

这些[不变量](@entry_id:148850)为我们提供了一种有力的快捷方式。例如，在计算一个通过相似变换得到的复杂矩阵 $\hat{A}$ 的[特征值](@entry_id:154894)乘积时，我们无需计算 $\hat{A}$ 本身，只需计算原始矩阵 $A$ 的[行列式](@entry_id:142978)即可，因为它们必然相等 [@problem_id:1755249]。

### [特征向量](@entry_id:151813)的变换

与[特征值](@entry_id:154894)的不变性形成鲜明对比的是，**[特征向量](@entry_id:151813)在相似变换下会发生改变**。它们会根据[基变换矩阵](@entry_id:184480) $S$ 进行相应的[坐标变换](@entry_id:172727)。

假设 $v$ 是矩阵 $B=S^{-1}AS$ 的一个[特征向量](@entry_id:151813)，其对应的[特征值](@entry_id:154894)为 $\lambda$。根据定义，我们有：
$$
Bv = \lambda v
$$
将 $B = S^{-1}AS$ 代入，得到：
$$
(S^{-1}AS)v = \lambda v
$$
用 $S$ 左乘等式两边：
$$
S(S^{-1}AS)v = S(\lambda v)
$$
利用[矩阵乘法](@entry_id:156035)的结合律，我们得到：
$$
A(Sv) = \lambda (Sv)
$$
如果我们令 $x=Sv$，那么上式就变成了 $Ax = \lambda x$。这正是矩阵 $A$ 的[特征值](@entry_id:154894)-[特征向量](@entry_id:151813)方程。这表明，如果 $v$ 是 $B$ 对应于 $\lambda$ 的[特征向量](@entry_id:151813)，那么 $x=Sv$ 就是 $A$ 对应于同一个[特征值](@entry_id:154894) $\lambda$ 的[特征向量](@entry_id:151813) [@problem_id:3273865]。

这个关系完美地诠释了[相似变换](@entry_id:152935)的几何意义：矩阵 $B$ 的[特征向量](@entry_id:151813) $v$ 是在“新”[坐标系](@entry_id:156346)下的坐标表示，当通过[基变换矩阵](@entry_id:184480) $S$ 将其转换回“旧”[坐标系](@entry_id:156346)时，得到的向量 $x=Sv$ 正是矩阵 $A$ 的[特征向量](@entry_id:151813)。它们代表的是同一个几何上的**[不变子空间](@entry_id:152829) (invariant subspace)**，只是在不同基下的坐标表示不同而已。

### [相似变换](@entry_id:152935)的保持与不保持

深刻理解[相似变换](@entry_id:152935)保留了什么、不保留什么，对于避免常见的概念混淆至关重要。

#### 矩阵的结构性质

[相似变换](@entry_id:152935)并不总是能保持矩阵的特殊结构。例如，**斜埃尔米特 (skew-Hermitian)** 性质（即 $A^* = -A$）在任意相似变换下通常不被保留。只有当变换矩阵 $S$ 是**酉矩阵 (unitary matrix)** 时（即 $S^*S=I$，或 $S^{-1}=S^*$），这种结构才能得以保持。

让我们来验证这一点。设 $B=S^{-1}AS$，其中 $A^* = -A$。我们计算 $B^*$：
$$
B^* = (S^{-1}AS)^* = S^*A^*(S^{-1})^* = -S^*A(S^{-1})^*
$$
为了使 $B$ 也是[斜埃尔米特矩阵](@entry_id:153530)，即 $B^*=-B$，我们需要满足 $-S^*A(S^{-1})^* = -S^{-1}AS$。这个等式在任意可逆矩阵 $S$ 下通常不成立。然而，如果 $S$ 是一个酉矩阵 $U$，那么 $S^{-1}=U^*$ 且 $(S^{-1})^* = (U^*)^* = U$。此时：
$$
B^* = -U^*AU = -U^{-1}AU = -B
$$
因此，只有**酉[相似变换](@entry_id:152935) (unitary similarity transformation)** 才能保证将一个[斜埃尔米特矩阵](@entry_id:153530)变换为另一个[斜埃尔米特矩阵](@entry_id:153530)。然而，无论变换是否是[酉变换](@entry_id:152599)，只要是相似变换，矩阵的[特征值](@entry_id:154894)（对于[斜埃尔米特矩阵](@entry_id:153530)而言是纯虚数）始终保持不变 [@problem_id:3273862]。

#### 奇异值

另一个重要的、且在[相似变换](@entry_id:152935)下**不保持不变**的量是**[奇异值](@entry_id:152907) (singular values)**。一个矩阵 $M$ 的奇异值 $\sigma_i$ 定义为矩阵 $M^*M$ [特征值](@entry_id:154894)的非负平方根。奇异值在数据科学和数值分析中（如[主成分分析PCA](@entry_id:173144)和矩阵低秩近似）扮演着核心角色。

尽管[相似变换](@entry_id:152935)保留了 $A$ 的[特征值](@entry_id:154894)，但它通常不保留 $A^*A$ 的[特征值](@entry_id:154894)。让我们考虑变换后矩阵 $B$ 的 $B^*B$：
$$
B^*B = (S^{-1}AS)^*(S^{-1}AS) = (S^*A^*(S^{-1})^*) (S^{-1}AS)
$$
这个表达式通常与 $A^*A$ 没有直接的相似关系，因此它们的[特征值](@entry_id:154894)（以及[奇异值](@entry_id:152907)的平方）一般是不同的。

我们可以通过一个具体的例子来验证。考虑矩阵 $A = \begin{pmatrix} 1  0 \\ 0  2 \end{pmatrix}$ 和变换矩阵 $P = \begin{pmatrix} 1  1 \\ 0  1 \end{pmatrix}$。
矩阵 $A$ 的[奇异值](@entry_id:152907)是 $1$ 和 $2$。经过[相似变换](@entry_id:152935)后，我们得到 $B = P^{-1}AP = \begin{pmatrix} 1  -1 \\ 0  2 \end{pmatrix}$。计算 $B^\mathsf{T}B = \begin{pmatrix} 1  -1 \\ -1  5 \end{pmatrix}$，其[特征值](@entry_id:154894)为 $3 \pm \sqrt{5}$。因此，$B$ 的[奇异值](@entry_id:152907)为 $\sqrt{3 \pm \sqrt{5}}$。显然，[奇异值](@entry_id:152907)在这次变换中发生了改变 [@problem_id:3273847]。

#### 与[合同变换](@entry_id:154837)的辨析

在处理二次型和对称矩阵时，另一种常见的变换是**[合同变换](@entry_id:154837) (congruence transformation)**，其形式为 $C = P^\mathsf{T}AP$（或 $P^*AP$），其中 $P$ 是可逆矩阵。一个常见的误区是混淆[相似变换](@entry_id:152935)与[合同变换](@entry_id:154837)的性质。

- **相似变换 ($P^{-1}AP$) 保持[特征值](@entry_id:154894)。**
- **[合同变换](@entry_id:154837) ($P^\mathsf{T}AP$) 保持对称性，并且根据西尔维斯特惯性定理 (Sylvester's Law of Inertia)，它保持对称[矩阵的惯性](@entry_id:193431) (inertia)**，即正、负、零[特征值](@entry_id:154894)的个数。

关键在于，[合同变换](@entry_id:154837)**通常不保持[特征值](@entry_id:154894)本身**。例如，对于[对称矩阵](@entry_id:143130) $A = \begin{pmatrix} 3  1 \\ 1  1 \end{pmatrix}$ 和非[正交矩阵](@entry_id:169220) $P = \begin{pmatrix} 2  1 \\ 0  1 \end{pmatrix}$， $A$ 的[特征值](@entry_id:154894)是 $2 \pm \sqrt{2}$。而[合同变换](@entry_id:154837)后的矩阵 $C=P^\mathsf{T}AP = \begin{pmatrix} 12  8 \\ 8  6 \end{pmatrix}$ 的[特征值](@entry_id:154894)是 $9 \pm \sqrt{73}$，两者完全不同 [@problem_id:3273881]。

然而，由于相似变换保持所有[特征值](@entry_id:154894)，它自然也保持了[特征值](@entry_id:154894)的符号[分布](@entry_id:182848)，因此它也保持了埃尔米特矩阵的惯性 [@problem_id:3273935]。这一点虽然与西尔维斯特惯性定理的结论相似，但其背后的原理是更强的[特征值](@entry_id:154894)不变性，而非仅限于[合同变换](@entry_id:154837)。

只有当[变换矩阵](@entry_id:151616) $P$ 是正交（或酉）矩阵时，$P^{-1} = P^\mathsf{T}$（或 $P^{-1}=P^*$），此时[相似变换](@entry_id:152935)与[合同变换](@entry_id:154837)的形式才合二为一。

### 相似性的充分条件：若尔当标准型

我们已经看到，两个[矩阵相似](@entry_id:153186)必然意味着它们有相同的[特征值](@entry_id:154894)。那么反过来是否成立呢？即，如果两个矩阵有相同的[特征值](@entry_id:154894)（包括[代数重数](@entry_id:154240)），它们一定相似吗？

答案是否定的。一个经典的例子是：
$$
A = \begin{pmatrix} 2  0 \\ 0  2 \end{pmatrix} \quad \text{和} \quad B = \begin{pmatrix} 2  1 \\ 0  2 \end{pmatrix}
$$
这两个矩阵有相同的[特征多项式](@entry_id:150909) $(\lambda-2)^2$，因此它们的[特征值](@entry_id:154894)都是 $\{2, 2\}$。然而，它们并不相似。一个简单的判据是比较[特征值](@entry_id:154894) $\lambda=2$ 的**[几何重数](@entry_id:155584) (geometric multiplicity)**，即[特征空间](@entry_id:638014) $\ker(M-2I)$ 的维数。
- 对矩阵 $A$，$A-2I$ 是零矩阵，其核空间的维数是 $2$。
- 对矩阵 $B$，$B-2I = \begin{pmatrix} 0  1 \\ 0  0 \end{pmatrix}$，其核空间的维数是 $1$。
由于[几何重数](@entry_id:155584)是[相似不变量](@entry_id:149886)，而 $A$ 和 $B$ 的[几何重数](@entry_id:155584)不同，故它们不相似。

这揭示了要完全确定一个矩阵的相似等价类，仅有[特征值](@entry_id:154894)是不够的，我们还需要描述与每个[特征值](@entry_id:154894)相关联的广义[特征空间](@entry_id:638014)的结构。这正是**[若尔当标准型](@entry_id:155670) (Jordan Normal Form, JNF)** 所做的事情。

一个基本结论是：**两个复[矩阵相似](@entry_id:153186)的充分必要条件是它们具有（在不计若尔当块顺序的情况下）相同的[若尔当标准型](@entry_id:155670)。** 对于实矩阵，对应的概念是**实[若尔当标准型](@entry_id:155670) (Real Jordan Normal Form, RJNF)**。

若尔当标准型揭示了矩阵的精细结构，包括每个[特征值](@entry_id:154894)对应的若尔当块的大小和数量。这些信息比[特征值](@entry_id:154894)本身要丰富得多。例如，上述矩阵 $A$ 的若尔当标准型是它自身（两个 $1 \times 1$ 的块），而 $B$ 的若尔当标准型也是它自身（一个 $2 \times 2$ 的块）。由于它们的若尔当标准型不同，它们不相似。

一个重要的特例是**[可对角化矩阵](@entry_id:150100) (diagonalizable matrices)**。如果一个矩阵可对角化，它的[若尔当标准型](@entry_id:155670)就是一个[对角矩阵](@entry_id:637782)（所有[若尔当块](@entry_id:155003)都是 $1 \times 1$）。在这种情况下，[若尔当标准型](@entry_id:155670)完全由其[特征值](@entry_id:154894)决定。因此，我们有一个更简洁的结论：**如果两个实矩阵都可在[复数域](@entry_id:153768)上被对角化，并且它们有相同的[特征值](@entry_id:154894)（及重数），那么它们在实数域上是相似的** [@problem_id:3273852]。

### 特征值问题的数值稳定性

在理论上，相似变换精确地保持[特征值](@entry_id:154894)。但在实际的数值计算中，由于[浮点运算](@entry_id:749454)的舍入误差，我们处理的是被扰动的矩阵 $A+\Delta A$。一个关键问题是：矩阵的微小扰动 $\Delta A$ 会对[特征值](@entry_id:154894)造成多大的影响？

对于可对角化的矩阵 $A=PDP^{-1}$（其中 $D$ 是[特征值](@entry_id:154894)构成的[对角矩阵](@entry_id:637782)， $P$ 是[特征向量](@entry_id:151813)构成的矩阵），**Bauer-Fike 定理**给出了一个经典的界：
对于 $A+\Delta A$ 的任意一个[特征值](@entry_id:154894) $\mu$，都存在一个 $A$ 的[特征值](@entry_id:154894) $\lambda$，使得：
$$
|\mu - \lambda| \le \kappa(P) \|\Delta A\|
$$
这里的 $\|\cdot\|$ 是某种[算子范数](@entry_id:752960)，而 $\kappa(P) = \|P\| \|P^{-1}\|$ 是变换矩阵 $P$ 的**条件数 (condition number)**。

这个定理揭示了特征值问题敏感性的根源 [@problem_id:3273920]：

-   **[特征值问题](@entry_id:142153)的敏感性由其[特征向量](@entry_id:151813)矩阵 $P$ 的条件数 $\kappa(P)$ 控制。**
-   如果 $\kappa(P)$ 接近 $1$，特征值问题就是**良态的 (well-conditioned)**。这意味着[特征值](@entry_id:154894)的变化与矩阵的扰动在同一量级。
-   如果 $\kappa(P)$ 非常大，特征值问题就是**病态的 (ill-conditioned)**。这意味着即使矩阵有非常微小的扰动，[特征值](@entry_id:154894)也可能发生巨大的变化。当矩阵的[特征向量](@entry_id:151813)接近[线性相关](@entry_id:185830)时，$\kappa(P)$ 会很大。

一个特别重要的良态情形是**[正规矩阵](@entry_id:185943) (normal matrices)**，它们满足 $A^*A=AA^*$。这包括埃尔米特矩阵、[斜埃尔米特矩阵](@entry_id:153530)和酉矩阵。[正规矩阵](@entry_id:185943)的一个关键性质是它们可以被酉[矩阵[对角](@entry_id:138930)化](@entry_id:147016)，即 $A=U\Lambda U^*$。在这种情况下，我们可以取 $P=U$。由于 $U$ 是[酉矩阵](@entry_id:138978)，在 $2$-范数下，$\|U\|_2 = \|U^{-1}\|_2 = 1$，因此 $\kappa_2(U)=1$。
对于[正规矩阵](@entry_id:185943)，Bauer-Fike 定理的界简化为：
$$
|\mu - \lambda| \le \|\Delta A\|_2
$$
这表明[正规矩阵](@entry_id:185943)的特征值问题总是良态的 [@problem_id:3273920] [@problem_id:3273869]。

相反，对于[非正规矩阵](@entry_id:752668)，即使其[特征值](@entry_id:154894)都是互不相同的，其[特征向量](@entry_id:151813)也可能接近线性相关，导致 $\kappa(P)$ 巨大，从而使得[特征值](@entry_id:154894)对扰动极其敏感。

更进一步，当矩阵具有[重根](@entry_id:151486)[特征值](@entry_id:154894)时（特别是在非对角化的**[亏损矩阵](@entry_id:184234) (defective matrix)** 的情况下），情况会变得更加复杂。此时，[特征值](@entry_id:154894)通常不再是矩阵元素的[可微函数](@entry_id:144590)。一个大小为 $\varepsilon$ 的扰动可能导致[特征值](@entry_id:154894)发生大小为 $\varepsilon^{1/k}$ 的变化，其中 $k$ 是若尔当块的大小。这是一种更极端的敏感性，也是为什么在[数值算法](@entry_id:752770)中处理具有[重根](@entry_id:151486)或簇状根的[非正规矩阵](@entry_id:752668)尤其具有挑战性的原因 [@problem_id:3273869]。