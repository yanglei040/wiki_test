{"hands_on_practices": [{"introduction": "亲手处理一个小矩阵是理解 Cholesky 和 $LDL^{\\top}$ 分解机理的最佳方式。这个练习将引导你完成分步计算，从而巩固算法步骤与正定性之间的联系。通过手动执行此过程，你将为这些分解的工作原理建立起坚实的直观基础。[@problem_id:3213055]", "problem": "令 $A \\in \\mathbb{R}^{3 \\times 3}$ 为对称矩阵\n$$\nA \\;=\\; \\begin{pmatrix}\n4  1  0 \\\\\n1  3  1 \\\\\n0  1  2\n\\end{pmatrix}.\n$$\n首先，根据与顺序主子式符号相关的正定性基本检验方法，从第一性原理出发，证明 $A$ 是对称正定矩阵。接着，通过对定义关系所蕴含的系数进行相等匹配，手动计算 Cholesky 分解 $A = L L^{\\top}$（其中 $L$ 是正对角元的下三角矩阵）和 $LDL^{\\top}$ 分解 $A = \\tilde{L} D \\tilde{L}^{\\top}$（其中 $\\tilde{L}$ 是单位下三角矩阵，$D$ 是对角矩阵）。你必须以符号形式明确地进行消元和对角元更新，不得使用任何现成的快捷公式。\n\n最后，使用你得到的任一分解（并说明为何这样做是有效的），确定 $\\det(A)$ 的精确值。将你的最终答案表示为一个无舍入的精确实数。", "solution": "用户提供了一个问题陈述，在尝试解答之前需要对其进行验证。\n\n### 第 1 步：提取已知条件\n已知条件如下：\n-   $A \\in \\mathbb{R}^{3 \\times 3}$ 是一个对称矩阵。\n-   $A = \\begin{pmatrix} 4  1  0 \\\\ 1  3  1 \\\\ 0  1  2 \\end{pmatrix}$。\n-   要求从第一性原理出发，通过检验顺序主子式的符号来证明 $A$ 是对称正定的。\n-   要求手动计算 Cholesky 分解 $A = L L^{\\top}$，其中 $L$ 是具有正对角元的下三角矩阵。\n-   要求手动计算 $LDL^{\\top}$ 分解 $A = \\tilde{L} D \\tilde{L}^{\\top}$，其中 $\\tilde{L}$ 是单位下三角矩阵，$D$ 是对角矩阵。\n-   计算必须通过系数相等匹配来完成，并明确展示符号消元过程。\n-   要求使用其中一种分解来确定 $\\det(A)$ 的精确值。\n\n### 第 2 步：使用提取的已知条件进行验证\n1.  **科学基础：** 该问题牢固地植根于线性代数领域，特别是关于矩阵分解（Cholesky 分解，$LDL^T$ 分解）和对称正定（SPD）矩阵的性质。所有概念都是标准的，并且在数学上是严谨的。\n2.  **适定性：** 对于一个对称矩阵，存在具有正对角元的 Cholesky 分解等价于该矩阵是正定的。顺序主子式检验（Sylvester 判据）是确定正定性的标准方法。该问题为 $L$、$\\tilde{L}$ 和 $D$ 的唯一解提供了所有必要信息。\n3.  **客观性：** 问题使用精确的数学语言和符号进行陈述，没有主观或含糊不清的术语。\n4.  **完整性与一致性：** 已知条件是完整的且内部一致。\n5.  **相关性：** 该问题与 Cholesky 分解和 $LDL^T$ 分解的主题直接相关。\n\n问题陈述中未发现任何缺陷。\n\n### 第 3 步：结论与行动\n该问题是**有效的**。将提供解答。\n\n### 解答\n\n该问题包括四个部分：验证正定性、计算 Cholesky 分解、计算 $LDL^T$ 分解，以及最后计算矩阵 $A$ 的行列式。\n\n**第 1 部分：正定性的证明**\n\n一个对称矩阵是正定的，当且仅当其所有顺序主子式均为正。这被称为 Sylvester 判据。矩阵 $A$ 如下：\n$$A \\;=\\; \\begin{pmatrix} 4  1  0 \\\\ 1  3  1 \\\\ 0  1  2 \\end{pmatrix}$$\n令 $A_k$ 表示 $A$ 的 $k \\times k$ 顺序主子矩阵。我们必须计算 $A_1$、$A_2$ 和 $A_3$ 的行列式。\n\n第一个顺序主子式是 $A_1$ 的行列式：\n$$\\det(A_1) = \\det\\begin{pmatrix} 4 \\end{pmatrix} = 4$$\n由于 $\\det(A_1) = 4  0$，第一个条件满足。\n\n第二个顺序主子式是 $A_2$ 的行列式：\n$$\\det(A_2) = \\det\\begin{pmatrix} 4  1 \\\\ 1  3 \\end{pmatrix} = (4)(3) - (1)(1) = 12 - 1 = 11$$\n由于 $\\det(A_2) = 11  0$，第二个条件满足。\n\n第三个顺序主子式是 $A_3 = A$ 的行列式：\n$$\\det(A_3) = \\det(A) = \\det\\begin{pmatrix} 4  1  0 \\\\ 1  3  1 \\\\ 0  1  2 \\end{pmatrix}$$\n沿第一行进行余子式展开：\n$$\\det(A) = 4 \\cdot \\det\\begin{pmatrix} 3  1 \\\\ 1  2 \\end{pmatrix} - 1 \\cdot \\det\\begin{pmatrix} 1  1 \\\\ 0  2 \\end{pmatrix} + 0 \\cdot \\det\\begin{pmatrix} 1  3 \\\\ 0  1 \\end{pmatrix}$$\n$$\\det(A) = 4((3)(2) - (1)(1)) - 1((1)(2) - (1)(0)) = 4(6-1) - 1(2) = 4(5) - 2 = 20 - 2 = 18$$\n由于 $\\det(A_3) = 18  0$，第三个条件满足。\n\n所有顺序主子式均为正（$4$，$11$，$18$）。因此，对称矩阵 $A$ 是正定的。\n\n**第 2 部分：Cholesky 分解 ($A = LL^{\\top}$)**\n\n我们寻求一个对角元为正的下三角矩阵 $L$，使得 $A = LL^{\\top}$。令 $L$ 为：\n$$L = \\begin{pmatrix} l_{11}  0  0 \\\\ l_{21}  l_{22}  0 \\\\ l_{31}  l_{32}  l_{33} \\end{pmatrix}$$\n那么 $LL^{\\top}$ 是：\n$$LL^{\\top} = \\begin{pmatrix} l_{11}  0  0 \\\\ l_{21}  l_{22}  0 \\\\ l_{31}  l_{32}  l_{33} \\end{pmatrix} \\begin{pmatrix} l_{11}  l_{21}  l_{31} \\\\ 0  l_{22}  l_{32} \\\\ 0  0  l_{33} \\end{pmatrix} = \\begin{pmatrix} l_{11}^2  l_{11}l_{21}  l_{11}l_{31} \\\\ l_{21}l_{11}  l_{21}^2 + l_{22}^2  l_{21}l_{31} + l_{22}l_{32} \\\\ l_{31}l_{11}  l_{31}l_{21} + l_{32}l_{22}  l_{31}^2 + l_{32}^2 + l_{33}^2 \\end{pmatrix}$$\n通过将 $LL^{\\top}$ 与 $A$ 相等，我们逐列求解 $L$ 的元素。\n\n对于 $L$ 的第一列：\n- $a_{11} = 4 = l_{11}^2 \\implies l_{11} = \\sqrt{4} = 2$ （因为 $l_{11}  0$）。\n- $a_{21} = 1 = l_{11}l_{21} \\implies 1 = 2l_{21} \\implies l_{21} = \\frac{1}{2}$。\n- $a_{31} = 0 = l_{11}l_{31} \\implies 0 = 2l_{31} \\implies l_{31} = 0$。\n\n对于 $L$ 的第二列：\n- $a_{22} = 3 = l_{21}^2 + l_{22}^2 \\implies 3 = (\\frac{1}{2})^2 + l_{22}^2 \\implies 3 = \\frac{1}{4} + l_{22}^2 \\implies l_{22}^2 = 3 - \\frac{1}{4} = \\frac{11}{4} \\implies l_{22} = \\sqrt{\\frac{11}{4}} = \\frac{\\sqrt{11}}{2}$ （因为 $l_{22}  0$）。\n- $a_{32} = 1 = l_{21}l_{31} + l_{22}l_{32} \\implies 1 = (\\frac{1}{2})(0) + (\\frac{\\sqrt{11}}{2})l_{32} \\implies l_{32} = \\frac{2}{\\sqrt{11}} = \\frac{2\\sqrt{11}}{11}$。\n\n对于 $L$ 的第三列：\n- $a_{33} = 2 = l_{31}^2 + l_{32}^2 + l_{33}^2 \\implies 2 = 0^2 + (\\frac{2}{\\sqrt{11}})^2 + l_{33}^2 \\implies 2 = \\frac{4}{11} + l_{33}^2 \\implies l_{33}^2 = 2 - \\frac{4}{11} = \\frac{18}{11} \\implies l_{33} = \\sqrt{\\frac{18}{11}} = \\frac{3\\sqrt{2}}{\\sqrt{11}} = \\frac{3\\sqrt{22}}{11}$ （因为 $l_{33}  0$）。\n\n因此，Cholesky 因子 $L$ 是：\n$$L = \\begin{pmatrix} 2  0  0 \\\\ \\frac{1}{2}  \\frac{\\sqrt{11}}{2}  0 \\\\ 0  \\frac{2\\sqrt{11}}{11}  \\frac{3\\sqrt{22}}{11} \\end{pmatrix}$$\n\n**第 3 部分：$LDL^T$ 分解 ($A = \\tilde{L} D \\tilde{L}^{\\top}$)**\n\n我们寻求一个单位下三角矩阵 $\\tilde{L}$ 和一个对角矩阵 $D$，使得 $A = \\tilde{L} D \\tilde{L}^{\\top}$。\n令 $\\tilde{L} = \\begin{pmatrix} 1  0  0 \\\\ \\tilde{l}_{21}  1  0 \\\\ \\tilde{l}_{31}  \\tilde{l}_{32}  1 \\end{pmatrix}$ 且 $D = \\begin{pmatrix} d_1  0  0 \\\\ 0  d_2  0 \\\\ 0  0  d_3 \\end{pmatrix}$。\n乘积 $\\tilde{L}D\\tilde{L}^{\\top}$ 是：\n$$\\tilde{L}D\\tilde{L}^{\\top} = \\begin{pmatrix} d_1  d_1\\tilde{l}_{21}  d_1\\tilde{l}_{31} \\\\ \\tilde{l}_{21}d_1  \\tilde{l}_{21}^2 d_1 + d_2  \\tilde{l}_{21}d_1\\tilde{l}_{31} + d_2\\tilde{l}_{32} \\\\ \\tilde{l}_{31}d_1  \\tilde{l}_{31}d_1\\tilde{l}_{21} + \\tilde{l}_{32}d_2  \\tilde{l}_{31}^2 d_1 + \\tilde{l}_{32}^2 d_2 + d_3 \\end{pmatrix}$$\n将系数与 $A$ 相等：\n\n对于第一列的更新：\n- $a_{11} = 4 = d_1$。\n- $a_{21} = 1 = d_1\\tilde{l}_{21} \\implies 1 = 4\\tilde{l}_{21} \\implies \\tilde{l}_{21} = \\frac{1}{4}$。\n- $a_{31} = 0 = d_1\\tilde{l}_{31} \\implies 0 = 4\\tilde{l}_{31} \\implies \\tilde{l}_{31} = 0$。\n\n对于第二列的更新：\n- $a_{22} = 3 = \\tilde{l}_{21}^2 d_1 + d_2 \\implies 3 = (\\frac{1}{4})^2(4) + d_2 \\implies 3 = \\frac{1}{16}(4) + d_2 \\implies 3 = \\frac{1}{4} + d_2 \\implies d_2 = 3 - \\frac{1}{4} = \\frac{11}{4}$。\n- $a_{32} = 1 = \\tilde{l}_{21}d_1\\tilde{l}_{31} + d_2\\tilde{l}_{32} \\implies 1 = (\\frac{1}{4})(4)(0) + (\\frac{11}{4})\\tilde{l}_{32} \\implies \\tilde{l}_{32} = \\frac{4}{11}$。\n\n对于第三列的更新：\n- $a_{33} = 2 = \\tilde{l}_{31}^2 d_1 + \\tilde{l}_{32}^2 d_2 + d_3 \\implies 2 = (0)^2(4) + (\\frac{4}{11})^2(\\frac{11}{4}) + d_3 \\implies 2 = \\frac{16}{121}\\frac{11}{4} + d_3 \\implies 2 = \\frac{4}{11} + d_3 \\implies d_3 = 2 - \\frac{4}{11} = \\frac{18}{11}$。\n\n得到的矩阵是：\n$$\\tilde{L} = \\begin{pmatrix} 1  0  0 \\\\ \\frac{1}{4}  1  0 \\\\ 0  \\frac{4}{11}  1 \\end{pmatrix}, \\quad D = \\begin{pmatrix} 4  0  0 \\\\ 0  \\frac{11}{4}  0 \\\\ 0  0  \\frac{18}{11} \\end{pmatrix}$$\n\n**第 4 部分：$A$ 的行列式**\n\n我们可以使用任一分解来计算 $A$ 的行列式。$LDL^T$ 分解提供了一个更直接的计算方法。矩阵乘积的行列式是它们行列式的乘积。\n$$\\det(A) = \\det(\\tilde{L} D \\tilde{L}^{\\top}) = \\det(\\tilde{L}) \\det(D) \\det(\\tilde{L}^{\\top})$$\n三角矩阵的行列式是其对角元的乘积。\n对于单位下三角矩阵 $\\tilde{L}$，对角元全为 1，所以：\n$$\\det(\\tilde{L}) = 1 \\cdot 1 \\cdot 1 = 1$$\n矩阵转置的行列式等于原矩阵的行列式，所以 $\\det(\\tilde{L}^{\\top}) = \\det(\\tilde{L}) = 1$。\n对于对角矩阵 $D$，行列式是其对角元的乘积：\n$$\\det(D) = d_1 \\cdot d_2 \\cdot d_3$$\n因此，$A$ 的行列式就是 $D$ 的行列式：\n$$\\det(A) = 1 \\cdot \\det(D) \\cdot 1 = d_1 d_2 d_3$$\n代入计算出的 $d_1, d_2, d_3$ 的值：\n$$\\det(A) = (4) \\left(\\frac{11}{4}\\right) \\left(\\frac{18}{11}\\right) = 11 \\left(\\frac{18}{11}\\right) = 18$$\n这个结果与第 1 部分计算的值一致。", "answer": "$$\\boxed{18}$$", "id": "3213055"}, {"introduction": "对一个对称正定 (SPD) 矩阵的行和列进行重新排序，会如何影响其 Cholesky 因子？本练习通过研究一个对称置换后的矩阵 $\\tilde{A} = J A J$ 来探讨这个问题。你会发现，虽然 SPD 特性在这种变换下得以保持，但 Cholesky 因子本身并不会以简单的方式进行变换，这揭示了分解算法中微妙但重要的结构依赖性。[@problem_id:3213037]", "problem": "设 $A \\in \\mathbb{R}^{3 \\times 3}$ 是对称矩阵\n$$\nA = \\begin{pmatrix}\n4  1  2 \\\\\n1  3  0 \\\\\n2  0  5\n\\end{pmatrix},\n$$\n并设 $J \\in \\mathbb{R}^{3 \\times 3}$ 是反转坐标顺序的交换置换矩阵，\n$$\nJ = \\begin{pmatrix}\n0  0  1 \\\\\n0  1  0 \\\\\n1  0  0\n\\end{pmatrix}.\n$$\n考虑对称置换矩阵 $\\tilde{A} = J^{\\top} A J$。你只能使用对称正定（SPD）的定义和置换矩阵的基本性质，并且不能引用任何已有的分解恒等式。\n\na) 使用SPD的定义以及置换矩阵是正交矩阵这一事实，判断 $\\tilde{A}$ 是否为对称正定（SPD）矩阵。\n\nb) 设 $A = L L^{\\top}$ 和 $\\tilde{A} = \\tilde{L} \\tilde{L}^{\\top}$ 表示 Cholesky 分解，其中 $L$ 和 $\\tilde{L}$ 是具有正对角线元素的下三角矩阵。通过强制 $A = L L^{\\top}$ 和 $\\tilde{A} = \\tilde{L} \\tilde{L}^{\\top}$ 中对应元素相等，从第一性原理推导 $L$ 和 $\\tilde{L}$，并解释 $\\tilde{L}$ 是否可以通过简单地反转 $L$ 的行和列的顺序得到。使用三角结构来证明你的解释。\n\nc) 定义标量\n$$\nS \\;=\\; \\frac{\\prod_{i=1}^{3} \\tilde{L}_{ii}}{\\prod_{i=1}^{3} L_{ii}}.\n$$\n计算 $S$。将你的最终答案表示为一个实数。不需要四舍五入。", "solution": "按照要求，问题分三部分进行分析。\n\na) 判断 $\\tilde{A}$ 是否为对称正定（SPD）矩阵。\n\n首先，我们必须确定给定的矩阵 $A$ 是 SPD 的。\n$$\nA = \\begin{pmatrix}\n4  1  2 \\\\\n1  3  0 \\\\\n2  0  5\n\\end{pmatrix}.\n$$\n通过观察可知矩阵 $A$ 是对称的，因为 $A_{ij}=A_{ji}$。为了检查正定性，我们可以使用 Sylvester 准则，该准则指出，一个对称矩阵是正定的，当且仅当其所有主子式都为正。\n第一主子式为 $\\det(A_{1}) = |4| = 4  0$。\n第二主子式为 $\\det(A_{2}) = \\det\\begin{pmatrix} 4  1 \\\\ 1  3 \\end{pmatrix} = (4)(3) - (1)(1) = 12 - 1 = 11  0$。\n第三主子式为 $\\det(A_3) = \\det(A)$。\n$$\n\\det(A) = 4 \\det\\begin{pmatrix} 3  0 \\\\ 0  5 \\end{pmatrix} - 1 \\det\\begin{pmatrix} 1  0 \\\\ 2  5 \\end{pmatrix} + 2 \\det\\begin{pmatrix} 1  3 \\\\ 2  0 \\end{pmatrix}\n$$\n$$\n\\det(A) = 4(15 - 0) - 1(5 - 0) + 2(0 - 6) = 60 - 5 - 12 = 43  0.\n$$\n由于所有主子式都为正，对称矩阵 $A$ 是正定的。因此，$A$ 是 SPD 矩阵。\n\n现在我们考虑对称置换矩阵 $\\tilde{A} = J^{\\top} A J$。\n首先，我们检查对称性。置换矩阵 $J$ 是正交的，意味着 $J^{\\top} J = J J^{\\top} = I$，这表明 $J^{-1} = J^{\\top}$。\n$$\n\\tilde{A}^{\\top} = (J^{\\top} A J)^{\\top} = J^{\\top} A^{\\top} (J^{\\top})^{\\top} = J^{\\top} A^{\\top} J.\n$$\n由于 $A$ 是对称的（$A^{\\top} = A$），我们有\n$$\n\\tilde{A}^{\\top} = J^{\\top} A J = \\tilde{A}.\n$$\n因此，$\\tilde{A}$ 是一个对称矩阵。\n\n接下来，我们检查正定性。正定矩阵 $\\tilde{A}$ 的定义是，对于任何非零向量 $x \\in \\mathbb{R}^3$，二次型 $x^{\\top} \\tilde{A} x$ 必须为正。\n$$\nx^{\\top} \\tilde{A} x = x^{\\top} (J^{\\top} A J) x = (J x)^{\\top} A (J x).\n$$\n我们定义一个新向量 $y = Jx$。由于 $J$ 是一个置换矩阵，它是可逆的。因此，如果 $x \\neq 0$，那么 $y = Jx \\neq 0$。\n表达式变为 $y^{\\top} A y$。\n我们已经确定 $A$ 是正定的，这意味着对于任何非零向量 $y$，我们有 $y^{\\top} A y  0$。\n由于 $x \\neq 0$ 意味着 $y \\neq 0$，因此可以得出 $x^{\\top} \\tilde{A} x = y^{\\top} A y  0$。\n这对所有非零的 $x \\in \\mathbb{R}^3$ 都成立。因此，$\\tilde{A}$ 是正定的。\n由于 $\\tilde{A}$ 既是对称的又是正定的，它是一个 SPD 矩阵。\n\nb) 从第一性原理推导 $L$ 和 $\\tilde{L}$ 并分析它们之间的关系。\n\n对于矩阵 $A$，我们寻找一个具有正对角线元素的下三角矩阵 $L$，使得 $A = L L^{\\top}$。设\n$$\nL = \\begin{pmatrix} L_{11}  0  0 \\\\ L_{21}  L_{22}  0 \\\\ L_{31}  L_{32}  L_{33} \\end{pmatrix}.\n$$\n则\n$$\nL L^{\\top} = \\begin{pmatrix} L_{11}^2  L_{11}L_{21}  L_{11}L_{31} \\\\ L_{21}L_{11}  L_{21}^2+L_{22}^2  L_{21}L_{31}+L_{22}L_{32} \\\\ L_{31}L_{11}  L_{31L_{21}+L_{32}L_{22}  L_{31}^2+L_{32}^2+L_{33}^2 \\end{pmatrix} = \\begin{pmatrix} 4  1  2 \\\\ 1  3  0 \\\\ 2  0  5 \\end{pmatrix}.\n$$\n逐列对等各项：\n从第 1 列：\n$A_{11} = 4 = L_{11}^2 \\implies L_{11} = 2$。\n$A_{21} = 1 = L_{11}L_{21} = 2 L_{21} \\implies L_{21} = \\frac{1}{2}$。\n$A_{31} = 2 = L_{11}L_{31} = 2 L_{31} \\implies L_{31} = 1$。\n从第 2 列：\n$A_{22} = 3 = L_{21}^2 + L_{22}^2 = (\\frac{1}{2})^2 + L_{22}^2 \\implies L_{22}^2 = 3 - \\frac{1}{4} = \\frac{11}{4} \\implies L_{22} = \\frac{\\sqrt{11}}{2}$。\n$A_{32} = 0 = L_{21}L_{31} + L_{22}L_{32} = (\\frac{1}{2})(1) + \\frac{\\sqrt{11}}{2}L_{32} \\implies L_{32} = -\\frac{1/2}{\\sqrt{11}/2} = -\\frac{1}{\\sqrt{11}}$。\n从第 3 列：\n$A_{33} = 5 = L_{31}^2 + L_{32}^2 + L_{33}^2 = 1^2 + (-\\frac{1}{\\sqrt{11}})^2 + L_{33}^2 \\implies 5 = 1 + \\frac{1}{11} + L_{33}^2 \\implies L_{33}^2 = 5 - \\frac{12}{11} = \\frac{43}{11} \\implies L_{33} = \\sqrt{\\frac{43}{11}}$。\n所以，$A$ 的 Cholesky 因子是\n$$\nL = \\begin{pmatrix} 2  0  0 \\\\ \\frac{1}{2}  \\frac{\\sqrt{11}}{2}  0 \\\\ 1  -\\frac{1}{\\sqrt{11}}  \\sqrt{\\frac{43}{11}} \\end{pmatrix}.\n$$\n接下来，我们求 $\\tilde{A}$ 的 Cholesky 因子 $\\tilde{L}$。首先，我们计算 $\\tilde{A} = J^{\\top} A J$。由于 $J$ 是对称的，所以 $J^{\\top}=J$。\n$$\n\\tilde{A} = J A J = \\begin{pmatrix} 0  0  1 \\\\ 0  1  0 \\\\ 1  0  0 \\end{pmatrix} \\begin{pmatrix} 4  1  2 \\\\ 1  3  0 \\\\ 2  0  5 \\end{pmatrix} \\begin{pmatrix} 0  0  1 \\\\ 0  1  0 \\\\ 1  0  0 \\end{pmatrix} = \\begin{pmatrix} 5  0  2 \\\\ 0  3  1 \\\\ 2  1  4 \\end{pmatrix}.\n$$\n我们寻找 $\\tilde{L}$ 使得 $\\tilde{A} = \\tilde{L} \\tilde{L}^{\\top}$。\n$$\n\\tilde{L} = \\begin{pmatrix} \\tilde{L}_{11}  0  0 \\\\ \\tilde{L}_{21}  \\tilde{L}_{22}  0 \\\\ \\tilde{L}_{31}  \\tilde{L}_{32}  \\tilde{L}_{33} \\end{pmatrix}.\n$$\n对等 $\\tilde{A} = \\tilde{L}\\tilde{L}^{\\top}$ 的各项：\n从第 1 列：\n$\\tilde{A}_{11} = 5 = \\tilde{L}_{11}^2 \\implies \\tilde{L}_{11} = \\sqrt{5}$。\n$\\tilde{A}_{21} = 0 = \\tilde{L}_{11}\\tilde{L}_{21} \\implies \\tilde{L}_{21} = 0$。\n$\\tilde{A}_{31} = 2 = \\tilde{L}_{11}\\tilde{L}_{31} = \\sqrt{5} \\tilde{L}_{31} \\implies \\tilde{L}_{31} = \\frac{2}{\\sqrt{5}}$。\n从第 2 列：\n$\\tilde{A}_{22} = 3 = \\tilde{L}_{21}^2 + \\tilde{L}_{22}^2 = 0^2 + \\tilde{L}_{22}^2 \\implies \\tilde{L}_{22} = \\sqrt{3}$。\n$\\tilde{A}_{32} = 1 = \\tilde{L}_{21}\\tilde{L}_{31} + \\tilde{L}_{22}\\tilde{L}_{32} = (0)(\\frac{2}{\\sqrt{5}}) + \\sqrt{3}\\tilde{L}_{32} \\implies \\tilde{L}_{32} = \\frac{1}{\\sqrt{3}}$。\n从第 3 列：\n$\\tilde{A}_{33} = 4 = \\tilde{L}_{31}^2 + \\tilde{L}_{32}^2 + \\tilde{L}_{33}^2 = (\\frac{2}{\\sqrt{5}})^2 + (\\frac{1}{\\sqrt{3}})^2 + \\tilde{L}_{33}^2 \\implies 4 = \\frac{4}{5} + \\frac{1}{3} + \\tilde{L}_{33}^2 \\implies 4 = \\frac{17}{15} + \\tilde{L}_{33}^2 \\implies \\tilde{L}_{33}^2 = 4 - \\frac{17}{15} = \\frac{43}{15} \\implies \\tilde{L}_{33} = \\sqrt{\\frac{43}{15}}$。\n所以，$\\tilde{A}$ 的 Cholesky 因子是\n$$\n\\tilde{L} = \\begin{pmatrix} \\sqrt{5}  0  0 \\\\ 0  \\sqrt{3}  0 \\\\ \\frac{2}{\\sqrt{5}}  \\frac{1}{\\sqrt{3}}  \\sqrt{\\frac{43}{15}} \\end{pmatrix}.\n$$\n问题是问 $\\tilde{L}$ 是否可以通过简单地反转 $L$ 的行和列的顺序得到。反转矩阵 $M$ 的行和列的顺序等价于变换 $J M J$。让我们检查一下 $J L J$ 的结构。\n如果 $L$ 是一个下三角矩阵，设 $U = J L J$。$U$ 的一个元素由 $U_{ij} = L_{n+1-i, n+1-j}$ 给出。对于下三角矩阵 $L$，$L_{rs}=0$ 如果 $r  s$。这意味着 $U_{ij} = L_{n+1-i, n+1-j} = 0$ 如果 $n+1-i  n+1-j$，这简化为 $i > j$。因此，$U=JLJ$ 是一个上三角矩阵。由于 $\\tilde{L}$ 是下三角矩阵，它不能等于上三角矩阵 $J L J$（除非它们都是对角矩阵）。因此，$\\tilde{L}$ 无法通过简单地反转 $L$ 的行和列来获得。\n\nc) 定义标量\n$$\nS \\;=\\; \\frac{\\prod_{i=1}^{3} \\tilde{L}_{ii}}{\\prod_{i=1}^{3} L_{ii}}.\n$$\n计算 $S$。将你的最终答案表示为一个实数。不需要四舍五入。S 的计算结果为 1。", "answer": "$$\\boxed{1}$$", "id": "3213037"}, {"introduction": "在实际应用中，我们不能总是预先假设一个矩阵是正定的。一个稳健的算法必须能够优雅地处理分解失败的情况。这个编程挑战要求你从头开始实现 Cholesky 算法，并使用异常处理来精确定位当矩阵非正定时分解失败的原因。[@problem_id:3213017]", "problem": "要求您实现、论证并测试一个算法检测器，用于检测实对称矩阵的 Cholesky 分解失败。该检测器必须在不带主元选择的 Cholesky 分解过程中，识别出第一个非严格为正的主元的索引，并使用异常处理来报告和收集该索引。为确保数值一致性，该算法应在对称化后的输入矩阵上运行。\n\n从以下基本定义和事实出发：\n- 一个实对称矩阵 $A \\in \\mathbb{R}^{n \\times n}$ 是正定的，当且仅当对于所有非零向量 $x \\in \\mathbb{R}^n$，都有 $x^\\top A x \\gt 0$。\n- 一个实对称矩阵 $A$ 是正定的，当且仅当它具有唯一的、不带主元选择的 Cholesky 分解 $A = L L^\\top$，其中 $L$ 是具有严格为正对角线的下三角矩阵。\n- 在不带主元选择的 Cholesky 算法中，第 $k$ 步的主元量为 $p_k = a_{kk} - \\sum_{j=1}^{k-1} \\ell_{kj}^2$，算法成功要求 $p_k \\gt 0$，这样 $\\ell_{kk} = \\sqrt{p_k}$ 才是实数且严格为正。\n- Sylvester 准则指出，一个实对称矩阵是正定的，当且仅当其所有主子式都为正。这与不带主元选择的 Cholesky 算法中所有主元 $p_k$ 都必须严格为正的要求是一致的。\n\n您的任务是：\n1. 在对称化矩阵 $\\widehat{A} = (A + A^\\top)/2$ 上尝试进行不带主元选择的 Cholesky 分解，数值容差为 $\\tau = 10^{-12}$。在第 $k$ 步，如果计算出的主元 $p_k \\le \\tau$，算法必须抛出一个 Python 异常，该异常携带失败的主元索引 $k$（基于 1 的索引）和主元值 $p_k$。\n2. 使用异常处理来捕获此失败，并为每个测试矩阵记录失败的主元索引。如果没有抛出异常（算法完成），则为该矩阵记录整数 $0$ 以表示成功。\n3. 算法必须通过 Cholesky 递推公式直接实现，不得调用内置的 Cholesky 例程，并且必须使用具有以下元素的下三角形式 $L$：\n   - 对于 $k = 1, 2, \\dots, n$，\n     - $p_k = \\widehat{a}_{kk} - \\sum_{j=1}^{k-1} \\ell_{kj}^2$，\n     - 如果 $p_k \\le \\tau$，抛出异常，\n     - 否则，设置 $\\ell_{kk} = \\sqrt{p_k}$，\n     - 对于 $i = k+1, \\dots, n$，设置 $\\ell_{ik} = \\left(\\widehat{a}_{ik} - \\sum_{j=1}^{k-1} \\ell_{ij} \\ell_{kj}\\right)/\\ell_{kk}$。\n\n边界情况处理要求：\n- 在应用算法之前，始终将输入对称化为 $\\widehat{A} = (A + A^\\top)/2$。\n- 统一使用容差 $\\tau = 10^{-12}$ 来判断主元 $p_k$ 是否可接受。将 $p_k \\le \\tau$ 视为失败。\n- 报告结果中的索引必须是基于 1 的整数。\n\n测试套件：\n使用以下固定的实数矩阵集作为输入。下面的每个数值项都以精确的十进制形式给出。\n- $A_1 = \\begin{bmatrix} 2  -1 \\\\ -1  2 \\end{bmatrix}$。\n- $A_2 = \\begin{bmatrix} 1  2 \\\\ 2  1 \\end{bmatrix}$。\n- $A_3 = \\begin{bmatrix} 1  1 \\\\ 1  1 \\end{bmatrix}$。\n- $A_4 = \\begin{bmatrix} 0 \\end{bmatrix}$。\n- $A_5 = \\begin{bmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  -0.1 \\end{bmatrix}$。\n- $A_6 = \\begin{bmatrix} 2  3 \\times 10^{-16} \\\\ 0  2 \\end{bmatrix}$。\n- $A_7 = \\begin{bmatrix} 10^{-14} \\end{bmatrix}$。\n\n覆盖范围理据：\n- $A_1$ 是对称正定的，应该会成功。\n- $A_2$ 是对称不定的，应该会在一个非平凡的主元处失败。\n- $A_3$ 是对称半正定的，应该会因零主元而失败。\n- $A_4$ 是一个对角线为零的边界情况，应该会立即失败。\n- $A_5$ 是对角矩阵，含有一个负元素，应该会在后面的主元处失败。\n- $A_6$ 是轻微非对称的，但在经过 $\\widehat{A} = (A + A^\\top)/2$ 对称化后变为对称矩阵，并且由于非常小的非对角耦合，应该会成功。\n- $A_7$ 是一个微小的正标量，在指定的容差下应被视为非正数。\n\n最终输出格式：\n您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，\"[r1,r2,...,r7]\"），其中如果对测试套件中的第 $k$ 个矩阵的 Cholesky 分解尝试成功，则每个 $r_k$ 为整数 $0$，否则等于失败主元的基于 1 的索引。不应打印任何其他文本。本问题不涉及物理单位、角度单位或百分比。唯一使用的数值容差是上面描述的主元容差 $\\tau = 10^{-12}$。", "solution": "我们从定义出发：一个实对称矩阵 $A \\in \\mathbb{R}^{n \\times n}$ 是正定的，当且仅当对于每个非零向量 $x \\in \\mathbb{R}^n$，都有 $x^\\top A x \\gt 0$。一个经典且经过充分检验的特征是，$A$ 是正定的，当且仅当它具有唯一的、不带主元选择的 Cholesky 分解 $A = L L^\\top$，其中 $L$ 是具有严格为正对角元素的下三角矩阵。这个等价性与 Sylvester 准则一致，该准则指出，一个实对称矩阵是正定的，当且仅当它的所有顺序主子式都为正。在不带主元选择的 Cholesky 算法中，第 $k$ 步的主元是量\n$$ p_k \\equiv a_{kk} - \\sum_{j=1}^{k-1} \\ell_{kj}^2, $$\n算法成功要求 $p_k > 0$，这样 $\\ell_{kk} = \\sqrt{p_k}$ 才是实数且严格为正。非对角元素的更新由下式给出\n$$ \\ell_{ik} = \\frac{1}{\\ell_{kk}} \\left( a_{ik} - \\sum_{j=1}^{k-1} \\ell_{ij} \\ell_{kj} \\right), \\quad i = k+1, \\dots, n. $$\n如果在任何步骤中我们遇到 $p_k \\le 0$（或者在数值上，对于一个小的容差 $\\tau$，有 $p_k \\le \\tau$），算法就会失败，因为无法取实数平方根，或者因为对角线无法保持严格为正。使得 $p_k \\le 0$ 的最小索引 $k$ 是第一个非正主元的索引，它对应于分解失败的第一个点，也对应于第一个不严格为正的顺序主子式。\n\n为了稳健地处理输入数据中的轻微不对称性，并将注意力限制在对称部分，我们将分解应用于对称化矩阵 $\\widehat{A} = (A + A^\\top)/2$。我们使用一个固定的容差 $\\tau = 10^{-12}$，并将 $p_k \\le \\tau$ 视为失败，抛出一个携带基于 1 的失败主元索引 $k$ 和主元值 $p_k$ 的异常。调用代码捕获此异常并记录 $k$。如果没有抛出异常，则认为分解成功，记录值为 $0$。\n\n与 $L D L^\\top$ 分解的联系：不带主元选择的对称不定分解 $A = L D L^\\top$ 产生的对角元素 $d_k$ 正是舒尔补主元 $p_k$。在严格正定的情况下，对所有 $k$ 都有 $d_k > 0$，通过将 Cholesky 对角线设置为 $\\sqrt{d_k}$ 即可恢复 Cholesky 分解。因此，$L D L^\\top$ 中的第一个非正 $d_k$ 与 Cholesky 分解中的第一个失败主元重合，并产生相同的失败索引。\n\n现在我们通过计算或界定主元来分析测试套件：\n- 对于 $A_1 = \\begin{bmatrix} 2  -1 \\\\ -1  2 \\end{bmatrix}$，我们有 $p_1 = 2 > 0$，$\\ell_{11} = \\sqrt{2}$，然后 $\\ell_{21} = \\frac{-1}{\\sqrt{2}}$，以及 $p_2 = 2 - \\ell_{21}^2 = 2 - \\frac{1}{2} = \\frac{3}{2} > 0$。成功，记录 $0$。\n- 对于 $A_2 = \\begin{bmatrix} 1  2 \\\\ 2  1 \\end{bmatrix}$，我们有 $p_1 = 1 > 0$，$\\ell_{11} = 1$，$\\ell_{21} = 2$，以及 $p_2 = 1 - \\ell_{21}^2 = 1 - 4 = -3 \\le 0$。在 $k = 2$ 处失败，记录 $2$。\n- 对于 $A_3 = \\begin{bmatrix} 1  1 \\\\ 1  1 \\end{bmatrix}$，我们有 $p_1 = 1 > 0$，$\\ell_{11} = 1$，$\\ell_{21} = 1$，以及 $p_2 = 1 - \\ell_{21}^2 = 1 - 1 = 0 \\le \\tau$。在 $k = 2$ 处失败，记录 $2$。\n- 对于 $A_4 = \\begin{bmatrix} 0 \\end{bmatrix}$，我们有 $p_1 = 0 \\le \\tau$。在 $k = 1$ 处失败，记录 $1$。\n- 对于 $A_5 = \\operatorname{diag}(1, 1, -0.1)$，我们有 $p_1 = 1 > 0$，$p_2 = 1 > 0$，以及 $p_3 = -0.1 \\le 0$。在 $k = 3$ 处失败，记录 $3$。\n- 对于 $A_6 = \\begin{bmatrix} 2  3 \\times 10^{-16} \\\\ 0  2 \\end{bmatrix}$，对称化矩阵为 $\\widehat{A}_6 = \\begin{bmatrix} 2  1.5 \\times 10^{-16} \\\\ 1.5 \\times 10^{-16}  2 \\end{bmatrix}$。我们有 $p_1 = 2 > 0$，$\\ell_{11} = \\sqrt{2}$，$\\ell_{21} = \\dfrac{1.5 \\times 10^{-16}}{\\sqrt{2}}$，以及 $p_2 = 2 - \\ell_{21}^2 = 2 - \\dfrac{(1.5 \\times 10^{-16})^2}{2} \\approx 2 > \\tau$。成功，记录 $0$。\n- 对于 $A_7 = \\begin{bmatrix} 10^{-14} \\end{bmatrix}$，我们有 $p_1 = 10^{-14} \\le 10^{-12}$。在 $k = 1$ 处失败，记录 $1$。\n\n因此，预期的输出是单行列表\n$$\n[0, 2, 2, 1, 3, 0, 1].\n$$\n附带的程序使用指定的容差和异常处理实现了不带主元选择的 Cholesky 过程，将其应用于对称化输入，收集所需的索引，并精确打印出指定的列表。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\nclass CholeskyFailure(Exception):\n    \"\"\"Custom exception to signal Cholesky failure with failing 1-based pivot index and pivot value.\"\"\"\n    def __init__(self, index_1based: int, pivot_value: float):\n        super().__init__(f\"Cholesky failed at pivot {index_1based} with value {pivot_value}\")\n        self.index = int(index_1based)  # 1-based index\n        self.pivot = float(pivot_value)\n\ndef cholesky_with_exception(A: np.ndarray, tol: float = 1e-12) - np.ndarray:\n    \"\"\"\n    Attempt unpivoted Cholesky on the symmetric part of A with tolerance tol.\n    Returns the lower-triangular factor L if successful.\n    Raises CholeskyFailure with 1-based failing pivot index and pivot value if it fails.\n    \"\"\"\n    # Symmetrize to be robust to slight asymmetry: Ahat = (A + A.T)/2\n    Ahat = 0.5 * (A + A.T)\n    n = Ahat.shape[0]\n    L = np.zeros_like(Ahat, dtype=float)\n\n    for k in range(n):\n        # Compute the pivot p_k = a_kk - sum_{jk} l_{kj}^2\n        sum_sq = np.dot(L[k, :k], L[k, :k])\n        pivot = Ahat[k, k] - sum_sq\n        \n        if pivot = tol:\n            raise CholeskyFailure(k + 1, pivot)\n            \n        L[k, k] = np.sqrt(pivot)\n        \n        # Update column k\n        for i in range(k + 1, n):\n            sum_prod = np.dot(L[i, :k], L[k, :k])\n            L[i, k] = (Ahat[i, k] - sum_prod) / L[k, k]\n            \n    return L\n\ndef solve():\n    \"\"\"Main solver function to run the test suite and print the results.\"\"\"\n    test_suite = [\n        np.array([[2.0, -1.0], [-1.0, 2.0]]),\n        np.array([[1.0, 2.0], [2.0, 1.0]]),\n        np.array([[1.0, 1.0], [1.0, 1.0]]),\n        np.array([[0.0]]),\n        np.array([[1.0, 0.0, 0.0], [0.0, 1.0, 0.0], [0.0, 0.0, -0.1]]),\n        np.array([[2.0, 3e-16], [0.0, 2.0]]),\n        np.array([[1e-14]])\n    ]\n    \n    results = []\n    \n    for A in test_suite:\n        try:\n            cholesky_with_exception(A)\n            results.append(0)\n        except CholeskyFailure as e:\n            results.append(e.index)\n            \n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3213017"}]}