{"hands_on_practices": [{"introduction": "我们从一个看似简单的 $3 \\times 3$ 矩阵开始。这个练习旨在揭示一个关键概念：主元选择的必要性可能源于消元过程中产生的中间“填充”元素，而不仅仅是初始矩阵的结构。通过这个动手计算 [@problem_id:3262474]，你将亲身体验为何部分主元法是一个动态的过程。", "problem": "考虑矩阵 $A \\in \\mathbb{R}^{3 \\times 3}$，其形式如下\n$$\nA \\;=\\; \\begin{pmatrix}\n1  \\frac{9}{10}  0 \\\\\n\\frac{9}{10}  1  0 \\\\\n\\frac{1}{5}  \\frac{4}{5}  1\n\\end{pmatrix}.\n$$\n所有对角线元素均为 $1$，所有非对角线元素的绝对值严格小于 $1$。应用带部分主元选择的高斯消元法 (GEPP)。从部分主元选择的基本定义出发（在每一步中，在活动行中，选择当前列中绝对值最大的元素作为主元，并在必要时将当前行与该主元行交换），根据第一性原理进行推理：\n- 判断 GEPP 是否在第二步消元时执行行交换，并说明理由。\n- 完成消元过程，得到上三角因子 $U$。\n- 使用 GEPP 的元素增长因子的核心定义，即上三角因子 $U$ 中产生的最大绝对值元素与原始矩阵 $A$ 的最大绝对值元素之比，计算该增长因子的精确值。\n\n将你的最终答案以单个实数形式给出。无需四舍五入。", "solution": "该问题被验证为科学上合理、定义明确且客观。这是一个数值线性代数中的标准问题。我们将从第一性原理出发，应用带部分主元选择的高斯消元法 (GEPP) 来进行求解。\n\n初始矩阵为：\n$$ A = A^{(1)} = \\begin{pmatrix} 1  \\frac{9}{10}  0 \\\\ \\frac{9}{10}  1  0 \\\\ \\frac{1}{5}  \\frac{4}{5}  1 \\end{pmatrix} $$\n\n**第 1 步：对第 $k=1$ 列进行消元**\n\n根据 GEPP 算法，我们首先确定第一列中的主元元素。我们检查该列中对角线及其下方的元素：$a_{11}^{(1)}$、$a_{21}^{(1)}$ 和 $a_{31}^{(1)}$。\n这些值分别为 $1$、$\\frac{9}{10}$ 和 $\\frac{1}{5}$。我们比较它们的绝对值：\n$$ |a_{11}^{(1)}| = 1 $$\n$$ |a_{21}^{(1)}| = \\frac{9}{10} = 0.9 $$\n$$ |a_{31}^{(1)}| = \\frac{1}{5} = 0.2 $$\n绝对值最大的元素是 $a_{11}^{(1)} = 1$，它已经位于主元位置（第 $1$ 行，第 $1$ 列）。因此，在这一步中无需进行行交换。\n\n我们继续进行消元。乘子计算如下：\n$$ m_{21} = \\frac{a_{21}^{(1)}}{a_{11}^{(1)}} = \\frac{9/10}{1} = \\frac{9}{10} $$\n$$ m_{31} = \\frac{a_{31}^{(1)}}{a_{11}^{(1)}} = \\frac{1/5}{1} = \\frac{1}{5} $$\n\n我们通过执行行操作 $R_2 \\leftarrow R_2 - m_{21} R_1$ 和 $R_3 \\leftarrow R_3 - m_{31} R_1$ 来更新矩阵。\n新矩阵的元素，记为 $A^{(2)}$，如下：\n对于第 2 行：\n$a_{22}^{(2)} = a_{22}^{(1)} - m_{21} a_{12}^{(1)} = 1 - \\left(\\frac{9}{10}\\right)\\left(\\frac{9}{10}\\right) = 1 - \\frac{81}{100} = \\frac{19}{100}$\n$a_{23}^{(2)} = a_{23}^{(1)} - m_{21} a_{13}^{(1)} = 0 - \\left(\\frac{9}{10}\\right)(0) = 0$\n对于第 3 行：\n$a_{32}^{(2)} = a_{32}^{(1)} - m_{31} a_{12}^{(1)} = \\frac{4}{5} - \\left(\\frac{1}{5}\\right)\\left(\\frac{9}{10}\\right) = \\frac{4}{5} - \\frac{9}{50} = \\frac{40}{50} - \\frac{9}{50} = \\frac{31}{50}$\n$a_{33}^{(2)} = a_{33}^{(1)} - m_{31} a_{13}^{(1)} = 1 - \\left(\\frac{1}{5}\\right)(0) = 1$\n\n第一步消元后，矩阵为：\n$$ A^{(2)} = \\begin{pmatrix} 1  \\frac{9}{10}  0 \\\\ 0  \\frac{19}{100}  0 \\\\ 0  \\frac{31}{50}  1 \\end{pmatrix} $$\n\n**第 2 步：对第 $k=2$ 列进行消元并判断是否需要行交换**\n\n现在我们考虑第二列。主元的选择在由对角线及其下方元素组成的子列上进行，即 $a_{22}^{(2)}$ 和 $a_{32}^{(2)}$。我们比较它们的绝对值：\n$$ |a_{22}^{(2)}| = \\left|\\frac{19}{100}\\right| = \\frac{19}{100} = 0.19 $$\n$$ |a_{32}^{(2)}| = \\left|\\frac{31}{50}\\right| = \\frac{31}{50} = \\frac{62}{100} = 0.62 $$\n由于 $|a_{32}^{(2)}| > |a_{22}^{(2)}|$，GEPP 需要进行一次行交换。主元必须是绝对值最大的元素，即 $a_{32}^{(2)}$。\n\n**关于第二步进行行交换的理由：**\n是的，在第二步消元时执行了一次行交换。这是因为部分主元选择策略要求选择当前列中（从对角线元素开始往下）绝对值最大的元素作为主元。在第 $k=2$ 步，第 $2$ 列的主元候选元素是 $a_{22}^{(2)} = \\frac{19}{100}$ 和 $a_{32}^{(2)} = \\frac{31}{50}$。由于 $|\\frac{31}{50}| > |\\frac{19}{100}|$，必须通过交换第 $2$ 行和第 $3$ 行，将第 $3$ 行的元素移到主元位置（第 $2$ 行，第 $2$ 列）。\n\n我们执行交换 $R_2 \\leftrightarrow R_3$。矩阵变为：\n$$ A'^{(2)} = \\begin{pmatrix} 1  \\frac{9}{10}  0 \\\\ 0  \\frac{31}{50}  1 \\\\ 0  \\frac{19}{100}  0 \\end{pmatrix} $$\n新的主元是 $a_{22}'^{(2)} = \\frac{31}{50}$。用于消去主元下方元素的乘子是：\n$$ m_{32} = \\frac{a_{32}'^{(2)}}{a_{22}'^{(2)}} = \\frac{19/100}{31/50} = \\frac{19}{100} \\cdot \\frac{50}{31} = \\frac{19}{2 \\cdot 31} = \\frac{19}{62} $$\n我们执行行操作 $R_3 \\leftarrow R_3 - m_{32} R_2$：\n$a_{33}^{(3)} = a_{33}'^{(2)} - m_{32} a_{23}'^{(2)} = 0 - \\left(\\frac{19}{62}\\right)(1) = -\\frac{19}{62}$\n\n消元过程现已完成。得到的上三角矩阵 $U$ 为：\n$$ U = A^{(3)} = \\begin{pmatrix} 1  \\frac{9}{10}  0 \\\\ 0  \\frac{31}{50}  1 \\\\ 0  0  -\\frac{19}{62} \\end{pmatrix} $$\n\n**第 3 步：计算增长因子**\n\n问题将增长因子 $\\rho$ 定义为上三角矩阵 $U$ 中绝对值最大的元素与原始矩阵 $A$ 中绝对值最大的元素之比。\n$$ \\rho = \\frac{\\max_{i,j} |u_{ij}|}{\\max_{i,j} |a_{ij}|} $$\n\n首先，我们找到矩阵 $A$ 中绝对值最大的元素：\n$$ \\max_{i,j} |a_{ij}| = \\max\\left\\{|1|, \\left|\\frac{9}{10}\\right|, |0|, \\left|\\frac{9}{10}\\right|, |1|, |0|, \\left|\\frac{1}{5}\\right|, \\left|\\frac{4}{5}\\right|, |1|\\right\\} = \\max\\left\\{1, \\frac{9}{10}, 0, \\frac{1}{5}, \\frac{4}{5}\\right\\} = 1 $$\n\n接下来，我们找到矩阵 $U$ 中绝对值最大的元素：\n$$ \\max_{i,j} |u_{ij}| = \\max\\left\\{|1|, \\left|\\frac{9}{10}\\right|, |0|, \\left|\\frac{31}{50}\\right|, |1|, \\left|-\\frac{19}{62}\\right|\\right\\} = \\max\\left\\{1, 0.9, 0, 0.62, 1, \\frac{19}{62}\\right\\} $$\n由于 $\\frac{19}{62} \\approx 0.306$，该集合中的最大值为 $1$。\n$$ \\max_{i,j} |u_{ij}| = 1 $$\n\n最后，我们计算增长因子：\n$$ \\rho = \\frac{1}{1} = 1 $$\n\n增长因子恰好为 $1$。", "answer": "$$\\boxed{1}$$", "id": "3262474"}, {"introduction": "在前面例子的基础上，我们现在来处理一个结构清晰的 $5 \\times 5$ 矩阵。这个练习 [@problem_id:3262489] 旨在加强你对部分主元高斯消元法（GEPP）分步操作的理解。它清晰地展示了即使需要进行多次行交换，该策略也能成功地保持数值稳定性，并得到最小的增长因子。", "problem": "考虑方阵 $\\mathbf{A} \\in \\mathbb{R}^{5 \\times 5}$，其元素定义为 $a_{ij} = \\max(i,j)$，其中 $1 \\leq i,j \\leq 5$。从部分主元高斯消去法 (GEPP) 的核心定义出发——即在每一步中，在尚未消去的行中选择当前列绝对值最大的元素作为主元——计算排列矩阵 $\\mathbf{P}$、单位下三角矩阵 $\\mathbf{L}$ 和上三角矩阵 $\\mathbf{U}$，使得 $\\mathbf{P}\\mathbf{A} = \\mathbf{L}\\mathbf{U}$。然后，根据 GEPP 中增长因子的正式定义，即比率\n$$\\rho \\;=\\; \\frac{\\max_{i,j,k}\\left|a_{ij}^{(k)}\\right|}{\\max_{i,j}\\left|a_{ij}\\right|},$$\n其中 $a_{ij}^{(k)}$ 表示第 $k$ 步消元后的 $(i,j)$ 元素，确定此分解的增长因子的确切值。\n\n请给出增长因子 $\\rho$ 的唯一确切值作为最终答案。不包含单位。仅报告 $\\rho$ 的值作为最终答案。", "solution": "题目要求使用部分主元高斯消元法 (GEPP) 对一个特定的 $5 \\times 5$ 矩阵 $\\mathbf{A}$ 进行 $\\mathbf{PA} = \\mathbf{LU}$ 分解，然后确定增长因子 $\\rho$。\n\n首先，我们构造矩阵 $\\mathbf{A}$，其元素为 $a_{ij} = \\max(i, j)$。\n$$\n\\mathbf{A} = \\begin{pmatrix}\n1  2  3  4  5 \\\\\n2  2  3  4  5 \\\\\n3  3  3  4  5 \\\\\n4  4  4  4  5 \\\\\n5  5  5  5  5\n\\end{pmatrix}\n$$\n这个矩阵 $\\mathbf{A}$ 可记为 $\\mathbf{A}^{(0)}$。增长因子的分母是 $\\mathbf{A}$ 中各元素绝对值的最大值：\n$$\n\\max_{i,j} |a_{ij}| = \\max_{i,j} |a_{ij}^{(0)}| = 5\n$$\n\n我们现在逐步执行 GEPP，以确定所有中间矩阵 $\\mathbf{A}^{(k)}$ 和最终的 $\\mathbf{U}$ 矩阵。\n\n**步骤 1: $k=1$ (消去第 1 列)**\n$\\mathbf{A}^{(0)}$ 的第一列是 $[1, 2, 3, 4, 5]^T$。绝对值最大的元素是 $a_{51}^{(0)} = 5$。因此，我们必须交换第 $1$ 行和第 $5$ 行。\n交换后的矩阵为：\n$$\n\\begin{pmatrix}\n5  5  5  5  5 \\\\\n2  2  3  4  5 \\\\\n3  3  3  4  5 \\\\\n4  4  4  4  5 \\\\\n1  2  3  4  5\n\\end{pmatrix}\n$$\n主元是 $5$。对于 $i > 1$，乘数 $m_{i1}$ 为：\n$m_{21} = 2/5, m_{31} = 3/5, m_{41} = 4/5, m_{51} = 1/5$。\n我们对 $i=2,3,4,5$ 执行行操作 $R_i \\leftarrow R_i - m_{i1} R_1$：\n$R_2 \\leftarrow R_2 - \\frac{2}{5}R_1 = [2, 2, 3, 4, 5] - [2, 2, 2, 2, 2] = [0, 0, 1, 2, 3]$\n$R_3 \\leftarrow R_3 - \\frac{3}{5}R_1 = [3, 3, 3, 4, 5] - [3, 3, 3, 3, 3] = [0, 0, 0, 1, 2]$\n$R_4 \\leftarrow R_4 - \\frac{4}{5}R_1 = [4, 4, 4, 4, 5] - [4, 4, 4, 4, 4] = [0, 0, 0, 0, 1]$\n$R_5 \\leftarrow R_5 - \\frac{1}{5}R_1 = [1, 2, 3, 4, 5] - [1, 1, 1, 1, 1] = [0, 1, 2, 3, 4]$\n\n第一步消元后的矩阵是 $\\mathbf{A}^{(1)}$:\n$$\n\\mathbf{A}^{(1)} = \\begin{pmatrix}\n5  5  5  5  5 \\\\\n0  0  1  2  3 \\\\\n0  0  0  1  2 \\\\\n0  0  0  0  1 \\\\\n0  1  2  3  4\n\\end{pmatrix}\n$$\n$\\mathbf{A}^{(1)}$ 中的最大绝对值为 $\\max_{i,j} |a_{ij}^{(1)}| = 5$。\n\n**步骤 2: $k=2$ (消去第 2 列)**\n我们在 $\\mathbf{A}^{(1)}$ 中检查从第 $2$ 行开始的第 $2$ 列：$[0, 0, 0, 1]^T$。最大绝对值是 $a_{52}^{(1)} = 1$。我们交换第 $2$ 行和第 $5$ 行。\n交换后的矩阵为：\n$$\n\\begin{pmatrix}\n5  5  5  5  5 \\\\\n0  1  2  3  4 \\\\\n0  0  0  1  2 \\\\\n0  0  0  0  1 \\\\\n0  0  1  2  3\n\\end{pmatrix}\n$$\n主元是 $a_{22} = 1$。对于 $i > 2$，乘数 $m_{i2} = a_{i2}/a_{22}$ 均为 $0$。因此不执行行操作。第二步后的矩阵 $\\mathbf{A}^{(2)}$ 与交换后的矩阵相同。\n$\\max_{i,j} |a_{ij}^{(2)}| = 5$。\n\n**步骤 3: $k=3$ (消去第 3 列)**\n我们在 $\\mathbf{A}^{(2)}$ 中检查从第 $3$ 行开始的第 $3$ 列：$[0, 0, 1]^T$。最大绝对值是 $a_{53}^{(2)} = 1$。我们交换第 $3$ 行和第 $5$ 行。\n交换后的矩阵为：\n$$\n\\begin{pmatrix}\n5  5  5  5  5 \\\\\n0  1  2  3  4 \\\\\n0  0  1  2  3 \\\\\n0  0  0  0  1 \\\\\n0  0  0  1  2\n\\end{pmatrix}\n$$\n主元是 $a_{33}=1$。对于 $i > 3$，乘数 $m_{i3}$ 均为 $0$。不执行行操作。$\\mathbf{A}^{(3)}$ 与该矩阵相同。\n$\\max_{i,j} |a_{ij}^{(3)}| = 5$。\n\n**步骤 4: $k=4$ (消去第 4 列)**\n我们在 $\\mathbf{A}^{(3)}$ 中检查从第 $4$ 行开始的第 $4$ 列：$[0, 1]^T$。最大绝对值是 $a_{54}^{(3)}=1$。我们交换第 $4$ 行和第 $5$ 行。\n交换后的矩阵即为最终的上三角矩阵 $\\mathbf{U}$：\n$$\n\\mathbf{U} = \\mathbf{A}^{(4)} = \\begin{pmatrix}\n5  5  5  5  5 \\\\\n0  1  2  3  4 \\\\\n0  0  1  2  3 \\\\\n0  0  0  1  2 \\\\\n0  0  0  0  1\n\\end{pmatrix}\n$$\n$\\mathbf{A}^{(4)}$ 中的最大绝对值为 $\\max_{i,j} |a_{ij}^{(4)}| = 5$。\n\n**L 和 P 矩阵**\n整个过程中的行交换顺序为：$1 \\leftrightarrow 5$，然后 (新) $2 \\leftrightarrow 5$，然后 (新) $3 \\leftrightarrow 5$，然后 (新) $4 \\leftrightarrow 5$。这相当于将原始行 $(1,2,3,4,5)$ 重新排列为 $(5,1,2,3,4)$。\n因此，排列矩阵 $\\mathbf{P}$ 为：\n$$\n\\mathbf{P} = \\begin{pmatrix}\n0  0  0  0  1 \\\\\n1  0  0  0  0 \\\\\n0  1  0  0  0 \\\\\n0  0  1  0  0 \\\\\n0  0  0  1  0\n\\end{pmatrix}\n$$\n对应的 $\\mathbf{L}$ 矩阵为：\n$$\n\\mathbf{L} = \\begin{pmatrix}\n1  0  0  0  0 \\\\\n1/5  1  0  0  0 \\\\\n2/5  0  1  0  0 \\\\\n3/5  0  0  1  0 \\\\\n4/5  0  0  0  1\n\\end{pmatrix}\n$$\n\n**计算增长因子**\n增长因子 $\\rho$ 的定义为：\n$$\n\\rho = \\frac{\\max_{i,j,k}\\left|a_{ij}^{(k)}\\right|}{\\max_{i,j}\\left|a_{ij}\\right|}\n$$\n分子是在所有中间矩阵 $\\mathbf{A}^{(k)}$（对于 $k=0,1,2,3,4$）的所有元素中找到的最大绝对值。\n$\\max |a_{ij}^{(0)}| = 5$\n$\\max |a_{ij}^{(1)}| = 5$\n$\\max |a_{ij}^{(2)}| = 5$\n$\\max |a_{ij}^{(3)}| = 5$\n$\\max |a_{ij}^{(4)}| = 5$\n因此，总的最大值是 $\\max_{i,j,k} |a_{ij}^{(k)}| = 5$。\n\n分母是 $\\max_{i,j} |a_{ij}| = 5$。\n因此，增长因子为：\n$$\n\\rho = \\frac{5}{5} = 1\n$$", "answer": "$$\n\\boxed{1}\n$$", "id": "3262489"}, {"introduction": "我们前两个练习展示了部分主元法的操作机理和有效性。这最后一个练习 [@problem_id:3262594] 将通过分析一个著名的矩阵族来探索其局限性。通过解析推导其增长因子，你会发现随着矩阵尺寸 $n$ 的增加，增长因子可能会变得很大，这证明了部分主元法虽然强大，但并不能绝对保证元素不会显著增长。", "problem": "设 $n \\geq 3$ 为一个整数。在使用部分主元法的高斯消元过程中（每一步的主元都选择当前列剩余行中绝对值最大的元素，若有多个最大值则选择行索引最小的那个），增长因子定义为在上三角因子中产生的最大绝对值元素与原始矩阵中最大绝对值元素之比。等价地，如果 $P A = L U$ 是由部分主元高斯消元法产生的分解（其中 $P$ 是一个置换矩阵，$L$ 是单位下三角矩阵，$U$ 是上三角矩阵），则增长因子为 $\\gamma(A) = \\max_{i,j} |u_{ij}| \\big/ \\max_{i,j} |a_{ij}|$。\n\n构造一个显式的 $n \\times n$ 矩阵 $A_n$，使其在部分主元消去法下的增长因子 $\\gamma(A_n)$ 随着 $n$ 的增大而增大，但同时精确满足 $\\det(A_n) = 1$。你的构造必须仅依赖于核心定义和经过验证的事实，例如分块对角矩阵的行列式的乘法性质以及将一行的倍数加到另一行上行列式不变的性质。\n\n考虑由以下方式定义的 $(n-1) \\times (n-1)$ 矩阵 $W_{n-1}$\n- 对 $1 \\leq i \\leq n-1$，$w_{ii} = 1$，\n- 对 $1 \\leq i \\leq n-2$，$w_{i+1,i} = -1$，\n- 对 $1 \\leq i \\leq n-1$，$w_{i,\\,n-1} = 1$，\n- 其他情况 $w_{ij} = 0$，\n并定义\n$$\nA_n \\;=\\; \\operatorname{diag}\\!\\Big(W_{n-1},\\, \\frac{1}{\\,n-1\\,}\\Big),\n$$\n该分块对角矩阵的左上角块是 $W_{n-1}$，右下角块是 $1 \\times 1$ 矩阵 $\\big[\\tfrac{1}{n-1}\\big]$。\n\n从给定的定义和事实出发，推导 $A_n$ 的行列式，分析对 $A_n$ 进行部分主元高斯消元的过程，并确定增长因子 $\\gamma(A_n)$ 作为 $n$ 的函数的精确封闭形式表达式。请将你的最终答案以单一解析表达式的形式给出。不需要进行四舍五入。", "solution": "该问题要求对一个特定的 $n \\times n$ 矩阵 $A_n$（其中 $n \\geq 3$）进行分析。我们必须首先验证问题的陈述。该问题在数值线性代数的标准框架内是良定义的。它为矩阵 $A_n$ 提供了显式构造，定义了如部分主元法和增长因子等所有术语，并提出了一个明确的目标：推导该矩阵的行列式和增长因子。该问题在科学上是合理的、自洽的且客观的。这是一个有效的问题。\n\n我们继续进行求解，该过程包括两个主要部分：计算 $A_n$ 的行列式，以及分析部分主元高斯消元的过程以求出增长因子。\n\n矩阵 $A_n$ 定义为一个分块对角矩阵：\n$$\nA_n = \\operatorname{diag}\\!\\Big(W_{n-1},\\, \\frac{1}{\\,n-1\\,}\\Big)\n$$\n其中 $W_{n-1}$ 是一个 $(n-1) \\times (n-1)$ 矩阵，其元素定义如下：\n$w_{ii} = 1$ 对 $1 \\leq i \\leq n-1$\n$w_{i+1,i} = -1$ 对 $1 \\leq i \\leq n-2$\n$w_{i,n-1} = 1$ 对 $1 \\leq i \\leq n-1$\n$w_{ij} = 0$ 其他情况。\n\n例如，当 $n=4$ 时，矩阵 $W_3$ 为：\n$$\nW_3 = \\begin{pmatrix} 1  0  1 \\\\ -1  1  1 \\\\ 0  -1  1 \\end{pmatrix}\n$$\n而 $A_4$ 为：\n$$\nA_4 = \\begin{pmatrix} 1  0  1  0 \\\\ -1  1  1  0 \\\\ 0  -1  1  0 \\\\ 0  0  0  \\frac{1}{3} \\end{pmatrix}\n$$\n\n**1. $A_n$ 的行列式**\n\n由于 $A_n$ 是一个分块对角矩阵，其行列式是其对角块行列式的乘积。\n$$\n\\det(A_n) = \\det(W_{n-1}) \\cdot \\det\\left(\\left[\\frac{1}{n-1}\\right]\\right) = \\frac{1}{n-1} \\det(W_{n-1})\n$$\n为了计算 $\\det(W_{n-1})$，我们可以沿 $W_{n-1}$ 的第一列进行代数余子式展开。第一列中仅有的非零元素是 $w_{11}=1$ 和 $w_{21}=-1$。\n$$\n\\det(W_{n-1}) = 1 \\cdot \\det(M_{11}) - (-1) \\cdot \\det(M_{21}) = \\det(M_{11}) + \\det(M_{21})\n$$\n其中 $M_{ij}$ 是对应于元素 $w_{ij}$ 的余子式。\n\n余子式 $M_{11}$ 是通过移除 $W_{n-1}$ 的第一行和第一列得到的。得到的 $(n-2) \\times (n-2)$ 矩阵与 $W_{n-1}$ 具有相同的结构，但维数为 $n-2$。因此，$M_{11} = W_{n-2}$。设 $d_k = \\det(W_k)$。那么 $\\det(M_{11}) = d_{n-2}$。\n\n余子式 $M_{21}$ 是通过移除 $W_{n-1}$ 的第二行和第一列得到的。\n$$\nM_{21} = \\begin{pmatrix}\n0  0  \\dots  0  1 \\\\\n-1  1  \\dots  0  1 \\\\\n0  -1  \\ddots  \\vdots  1 \\\\\n\\vdots    \\ddots  1  \\vdots \\\\\n0  \\dots  0  -1  1\n\\end{pmatrix}_{(n-2) \\times (n-2)}\n$$\n我们可以通过沿 $M_{21}$ 的第一行进行代数余子式展开来计算其行列式。唯一的非零元素是最后一列（第 $n-2$ 列）中的 $1$。\n$$\n\\det(M_{21}) = (-1)^{1+(n-2)} \\cdot 1 \\cdot \\det(M'_{1,n-2})\n$$\n其中 $M'_{1,n-2}$ 是通过移除 $M_{21}$ 的第一行和最后一列得到的子矩阵。这个子矩阵是一个大小为 $(n-3) \\times (n-3)$ 的下三角矩阵，其所有对角元素都等于 $-1$。\n$$\nM'_{1,n-2} = \\begin{pmatrix}\n-1  1  0  \\dots \\\\\n0  -1  1  \\dots \\\\\n\\vdots  \\ddots  \\ddots  \\ddots \\\\\n0  \\dots  0  -1\n\\end{pmatrix}\n$$\n三角矩阵的行列式是其对角元素的乘积，所以 $\\det(M'_{1,n-2}) = (-1)^{n-3}$。\n因此，$\\det(M_{21}) = (-1)^{n-1} \\cdot (-1)^{n-3} = (-1)^{2n-4} = 1$。\n\n我们建立了递推关系 $d_{n-1} = d_{n-2} + 1$。\n对于基准情形，我们考虑 $W_1 = [1]$，所以 $d_1 = 1$。该递推关系给出 $d_2 = d_1+1 = 2$。我们直接检验一下：$W_2 = \\begin{pmatrix} 1  1 \\\\ -1  1 \\end{pmatrix}$，所以 $d_2 = 1 \\cdot 1 - 1 \\cdot (-1) = 2$。该递推关系成立。\n展开该递推关系，我们得到 $d_k = d_{k-1}+1 = d_{k-2}+2 = \\dots = d_1 + (k-1) = 1 + k - 1 = k$。\n因此，$\\det(W_{n-1}) = n-1$。\n\n最后，$A_n$ 的行列式为：\n$$\n\\det(A_n) = \\frac{1}{n-1} \\det(W_{n-1}) = \\frac{n-1}{n-1} = 1\n$$\n\n**2. $A_n$ 的增长因子**\n\n增长因子为 $\\gamma(A_n) = \\max_{i,j} |u_{ij}| / \\max_{i,j} |a_{ij}|$。\n首先，我们找到 $A_n$ 中绝对值最大的元素。$A_n$ 的元素来自集合 $\\{0, 1, -1, 1/(n-1)\\}$。由于 $n \\geq 3$，我们有 $0  1/(n-1) \\leq 1/2$。最大绝对值为 $\\max_{i,j} |a_{ij}| = 1$。\n\n接下来，我们对 $A_n$ 执行部分主元高斯消元。由于其分块对角结构，对前 $n-1$ 行和列的消元过程只涉及 $W_{n-1}$ 块。设 $A^{(k)}$ 表示消元第 $k-1$ 步后的矩阵。我们从 $A^{(1)} = W_{n-1}$ 开始。\n\n第 $k$ 步（$1 \\le k \\le n-2$）：在第 $k$ 步开始时，矩阵是 $A^{(k)}$。主元列是第 $k$ 列。对于 $j \\geq k$，第 $j$ 列中对角线下方的元素与原始矩阵 $W_{n-1}$ 中的相同。具体来说，对于当前的主元列 $k$，从第 $k$ 行向下的元素是 $(a_{kk}^{(k)}, a_{k+1,k}^{(k)}, \\dots)^T$。主元下方唯一的非零元素是 $a_{k+1,k}^{(k)} = -1$。主元元素本身是 $a_{kk}^{(k)} = 1$。主元列中（从第 $k$ 行向下）的最大绝对值是 $1$。因此，对于每一步 $k$，$a_{kk}^{(k)}$ 都被选为主元。没有发生行交换，所以置换矩阵 $P$ 是单位矩阵 $I$。乘数是 $m_{k+1,k} = a_{k+1,k}^{(k)}/a_{kk}^{(k)} = -1/1 = -1$。行操作是 $R_{k+1} \\leftarrow R_{k+1} - m_{k+1,k}R_k = R_{k+1} + R_k$。\n\n上三角矩阵 $U$ 的元素（对于 $A_n$ 来说，是 $\\operatorname{diag}(U_W, 1/(n-1))$，其中 $U_W$ 是对 $W_{n-1}$ 进行消元的结果）由这些行操作生成。最大的元素出现在 $W_{n-1}$ 块的最后一列。设 $u_{i,j}$ 表示 $U_W$ 的元素。\n最初，$W_{n-1}$ 最后一列的所有元素都是 $1$。\n第 1 步之后（$R_2 \\leftarrow R_2+R_1$）：元素 $u_{2,n-1}$ 变为 $w_{2,n-1} + w_{1,n-1} = 1+1=2$。\n第 2 步之后（$R_3 \\leftarrow R_3+R_2$）：元素 $u_{3,n-1}$ 变为 $w_{3,n-1} + u_{2,n-1} = 1+2=3$。\n通常，在第 $k$ 步，对当前矩阵执行操作 $R_{k+1} \\leftarrow R_{k+1}+R_k$。设 $a_{i,j}^{(k+1)}$ 是此操作后矩阵的元素。第 $k+1$ 行最后一列的元素变为：\n$$\na_{k+1,n-1}^{(k+1)} = a_{k+1,n-1}^{(k)} + a_{k,n-1}^{(k)}\n$$\n在此操作之前，$a_{k+1,n-1}^{(k)}$ 仍然是原始值 $1$，而 $a_{k,n-1}^{(k)}$ 是上一步计算出的值。对于 $i \\leq k$，元素 $a_{i, n-1}^{(k)}$ 是最终值，$u_{i,n-1} = a_{i,n-1}^{(i)}$。最后一列最终值的递推关系是，对于 $i \\ge 2$，$u_{i,n-1} = 1 + u_{i-1, n-1}$，且 $u_{1,n-1}=1$。这给出对于 $i=1, \\dots, n-2$，$u_{i,n-1}=i$。\n\n最终矩阵 $U_W$ 在 $n-2$ 步后形成。在第 $n-2$ 步，操作是 $R_{n-1} \\leftarrow R_{n-1}+R_{n-2}$。此时第 $n-2$ 行中的所有元素都已是最终值。对第 $n-1$ 行最后一个元素（即 $u_{n-1,n-1}$）的更新为：\n$$\nu_{n-1,n-1} = a_{n-1,n-1}^{(n-2)} + a_{n-2,n-1}^{(n-2)}\n$$\n这里，$a_{n-1,n-1}^{(n-2)}$ 是原始元素 $w_{n-1,n-1}=1$，而 $a_{n-2,n-1}^{(n-2)}$ 是最终值 $u_{n-2,n-1}=n-2$。\n因此，$u_{n-1,n-1} = 1 + (n-2) = n-1$。\n\n对 $A_n$ 进行消元后得到的上三角矩阵 $U$ 是：\n$$\nU = \\begin{pmatrix}\n1  0  \\dots  0  1  0 \\\\\n0  1  \\dots  0  2  0 \\\\\n\\vdots    \\ddots    \\vdots  \\vdots \\\\\n0  0  \\dots  1  n-2  0 \\\\\n0  0  \\dots  0  n-1  0 \\\\\n0  0  \\dots  0  0  \\frac{1}{n-1}\n\\end{pmatrix}\n$$\n$U$ 的元素是 $\\{0, 1, 2, \\dots, n-1\\}$ 和 $\\{1/(n-1)\\}$。由于 $n \\geq 3$，$n-1 \\geq 2$。$U$ 的所有元素中的最大绝对值为 $\\max_{i,j} |u_{ij}| = n-1$。\n\n因此，增长因子为：\n$$\n\\gamma(A_n) = \\frac{\\max_{i,j} |u_{ij}|}{\\max_{i,j} |a_{ij}|} = \\frac{n-1}{1} = n-1\n$$\n这表明，对于给定的矩阵族 $A_n$，即使在部分主元消去法下，增长因子也随矩阵大小线性增长。此外，这些矩阵的行列式恰好为 $1$。", "answer": "$$\\boxed{n-1}$$", "id": "3262594"}]}