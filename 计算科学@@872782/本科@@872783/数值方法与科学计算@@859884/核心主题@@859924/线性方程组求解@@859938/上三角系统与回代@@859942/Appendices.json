{"hands_on_practices": [{"introduction": "这第一个练习是回代法算法的直接应用。通过处理一个 $4 \\times 4$ 的上三角系统，你将从最后一个方程开始向上求解，从而巩固对该逐步过程的理解。该问题要求使用分数运算，旨在强调精确度的重要性，并帮助你在没有舍入误差的情况下跟踪确切的计算流程。[@problem_id:1029943]", "problem": "使用回代法求解线性方程组 $ A \\mathbf{x} = \\mathbf{b} $，其中 $ A $ 是一个 4×4 的上三角矩阵，$ \\mathbf{b} $ 是一个向量。该矩阵和向量如下所示：\n\n\n$$\nA = \\begin{pmatrix}\n2.5  1.25  -0.6  1.8 \\\\\n0  0.4  2.1  -1.2 \\\\\n0  0  3.3  0.9 \\\\\n0  0  0  1.5\n\\end{pmatrix}, \\quad \n\\mathbf{b} = \\begin{pmatrix}\n1.1 \\\\\n-0.5 \\\\\n2.4 \\\\\n0.6\n\\end{pmatrix}.\n$$\n\n\n使用分数算术进行所有精确计算。将解向量 $ \\mathbf{x} = \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\\\ x_4 \\end{pmatrix} $ 表示为最简分数形式。", "solution": "我们将小数表示为分数，重写该方程组如下：\n$$\\begin{cases}\n\\frac52x_1+\\frac54x_2-\\frac35x_3+\\frac95x_4=\\frac{11}{10},\\\\\n\\frac25x_2+\\frac{21}{10}x_3-\\frac65x_4=-\\frac12,\\\\\n\\frac{33}{10}x_3+\\frac{9}{10}x_4=\\frac{12}{5},\\\\\n\\frac32x_4=\\frac35.\n\\end{cases}$$\n\n1. 从第四个方程：\n$$\\frac32x_4=\\frac35\\;\\Longrightarrow\\;\nx_4=\\frac{\\frac35}{\\frac32}=\\frac35\\cdot\\frac23=\\frac25.$$\n\n2. 第三个方程：\n$$\\frac{33}{10}x_3+\\frac{9}{10}\\cdot\\frac25=\\frac{12}{5}\n\\;\\Longrightarrow\\;\\frac{33}{10}x_3=\\frac{12}{5}-\\frac{18}{50}\n=\\frac{120-18}{50}=\\frac{102}{50}=\\frac{51}{25},$$\n$$x_3=\\frac{\\tfrac{51}{25}}{\\tfrac{33}{10}}\n=\\frac{51}{25}\\cdot\\frac{10}{33}=\\frac{510}{825}=\\frac{34}{55}.$$\n\n3. 第二个方程：\n$$\\frac25x_2+\\frac{21}{10}\\cdot\\frac{34}{55}-\\frac{6}{5}\\cdot\\frac25=-\\frac12\n\\;\\Longrightarrow\\;\\frac25x_2=-\\frac12-\\frac{357}{275}+\\frac{12}{25}\n=-\\frac{725}{550}=-\\frac{29}{22},$$\n$$x_2=-\\frac{29}{22}\\cdot\\frac52=-\\frac{145}{44}.$$\n\n4. 第一个方程：\n$$\\frac52x_1+\\frac54\\Bigl(-\\frac{145}{44}\\Bigr)-\\frac35\\cdot\\frac{34}{55}\n+\\frac95\\cdot\\frac25=\\frac{11}{10},$$\n$$\\frac52x_1=\\frac{11}{10}+\\frac{725}{176}+\\frac{102}{275}-\\frac{18}{25}\n=\\frac{21429}{4400},$$\n$$x_1=\\frac{21429}{4400}\\cdot\\frac25=\\frac{21429}{11000}.$$\n\n因此\n$$\\mathbf{x}=\\begin{pmatrix}\\frac{21429}{11000}\\\\-\\frac{145}{44}\\\\\\frac{34}{55}\\\\\\frac25\\end{pmatrix}.$$", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{21429}{11000}\\\\-\\frac{145}{44}\\\\\\frac{34}{55}\\\\\\frac25\\end{pmatrix}}$$", "id": "1029943"}, {"introduction": "虽然回代法非常强大，但它依赖于一个关键假设：矩阵必须是非奇异的。本练习探讨了当此条件不满足时会发生什么，特别是当对角线上出现零元素时。你将研究标准算法为何会失效，然后应用一种称为正则化的常用技术来恢复唯一解，并分析这种“修正”如何影响解的行为。[@problem_id:3285231]", "problem": "考虑上三角线性系统 $U x = b$，其中\n$$\nU \\;=\\; \\begin{pmatrix}\n2  -3  1 \\\\\n0  0  4 \\\\\n0  0  0\n\\end{pmatrix},\n\\qquad\nb \\;=\\; \\begin{pmatrix}\n7 \\\\\n5 \\\\\n0\n\\end{pmatrix},\n$$\n其中 $x \\in \\mathbb{R}^{3}$ 是未知向量。对角线元素满足 $U_{22} = 0$ 和 $U_{33} = 0$，因此 $U$ 是秩亏的。从上三角矩阵的核心定义和标准的回代算法出发，解释为什么 $U x = b$ 无法通过回代法唯一求解。然后，通过构造 $U_{\\lambda} = U + \\lambda I$（其中 $\\lambda  0$）来提出一种正则化方法，并使用回代法精确求解 $U_{\\lambda} x(\\lambda) = b$ 以得到 $x(\\lambda)$。分析当 $\\lambda \\to 0^{+}$ 时 $x(\\lambda)$ 的行为，并解释这种正则化对解分量的稳定性和大小的影响。\n\n作为最终答案，报告 $x(\\lambda)$ 的第二个分量 $x_{2}(\\lambda)$ 的精确封闭形式表达式。无需四舍五入。", "solution": "### 详细解答\n\n给定的线性系统是 $U x = b$，可以写成：\n$$\n\\begin{pmatrix}\n2  -3  1 \\\\\n0  0  4 \\\\\n0  0  0\n\\end{pmatrix}\n\\begin{pmatrix}\nx_1 \\\\\nx_2 \\\\\nx_3\n\\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\n7 \\\\\n5 \\\\\n0\n\\end{pmatrix}\n$$\n这对应于以下线性方程组：\n$1) \\quad 2x_1 - 3x_2 + x_3 = 7$\n$2) \\quad 4x_3 = 5$\n$3) \\quad 0 = 0$\n\n**关于无法通过回代法唯一求解的解释：**\n\n对于一个 $n \\times n$ 的上三角系统 $Ux=b$，标准的回代算法按从 $x_n$ 到 $x_1$ 的逆序计算 $x$ 的分量，使用以下公式：\n$$x_i = \\frac{1}{U_{ii}} \\left( b_i - \\sum_{j=i+1}^n U_{ij} x_j \\right)$$\n该算法要求所有对角线元素 $U_{ii}$ 都非零，因为它涉及除以 $U_{ii}$。在给定的矩阵 $U$ 中，我们有 $U_{22}=0$ 和 $U_{33}=0$。零对角线元素的存在导致标准回代算法因除以零而失败。\n\n为了确定系统的可解性，我们必须直接分析这些方程。\n- 第三个方程 $0=0$ 是一个重言式，没有提供关于变量的任何信息或约束。\n- 第二个方程 $4x_3 = 5$ 唯一地确定了 $x_3$ 的值为 $x_3 = \\frac{5}{4}$。\n- 将 $x_3 = \\frac{5}{4}$ 代入第一个方程得到：\n$$2x_1 - 3x_2 + \\frac{5}{4} = 7$$\n$$2x_1 - 3x_2 = 7 - \\frac{5}{4} = \\frac{28 - 5}{4} = \\frac{23}{4}$$\n这是一个包含两个未知数 $x_1$ 和 $x_2$ 的单线性方程。它有无穷多解。我们可以用一个变量表示另一个变量。例如，如果我们将 $x_2$ 视为自由参数，设 $x_2 = t$（对于任意 $t \\in \\mathbb{R}$），那么：\n$$2x_1 = \\frac{23}{4} + 3t \\implies x_1 = \\frac{23}{8} + \\frac{3}{2}t$$\n解集是 $\\mathbb{R}^3$ 中的一条直线，由向量函数给出：\n$$x(t) = \\begin{pmatrix} \\frac{23}{8} + \\frac{3}{2}t \\\\ t \\\\ \\frac{5}{4} \\end{pmatrix}$$\n由于该系统有无穷多解，因此它不是唯一可解的。\n\n**正则化及正则化系统的求解：**\n\n问题提出通过构造 $U_{\\lambda} = U + \\lambda I$ 进行正则化，其中 $I$ 是 $3 \\times 3$ 单位矩阵且 $\\lambda  0$。\n$$U_{\\lambda} = \\begin{pmatrix} 2  -3  1 \\\\ 0  0  4 \\\\ 0  0  0 \\end{pmatrix} + \\lambda \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\\\ 0  0  1 \\end{pmatrix} = \\begin{pmatrix} 2+\\lambda  -3  1 \\\\ 0  \\lambda  4 \\\\ 0  0  \\lambda \\end{pmatrix}$$\n对于 $\\lambda  0$，$U_{\\lambda}$ 的对角线元素为 $2+\\lambda$、$\\lambda$ 和 $\\lambda$，它们都非零。因此，$U_{\\lambda}$ 是一个非奇异（可逆）的上三角矩阵，正则化系统 $U_{\\lambda} x(\\lambda) = b$ 有唯一解，该解可以通过回代法求得。\n\n正则化系统为：\n$$\n\\begin{pmatrix}\n2+\\lambda  -3  1 \\\\\n0  \\lambda  4 \\\\\n0  0  \\lambda\n\\end{pmatrix}\n\\begin{pmatrix}\nx_1(\\lambda) \\\\\nx_2(\\lambda) \\\\\nx_3(\\lambda)\n\\end{pmatrix}\n\\;=\\;\n\\begin{pmatrix}\n7 \\\\\n5 \\\\\n0\n\\end{pmatrix}\n$$\n我们使用回代法求解 $x(\\lambda) = (x_1(\\lambda), x_2(\\lambda), x_3(\\lambda))^T$：\n- 从第三行：$\\lambda x_3(\\lambda) = 0$。由于 $\\lambda  0$，我们得到 $x_3(\\lambda) = 0$。\n- 从第二行：$\\lambda x_2(\\lambda) + 4x_3(\\lambda) = 5$。代入 $x_3(\\lambda) = 0$：\n$$\\lambda x_2(\\lambda) + 4(0) = 5 \\implies \\lambda x_2(\\lambda) = 5 \\implies x_2(\\lambda) = \\frac{5}{\\lambda}$$\n- 从第一行：$(2+\\lambda)x_1(\\lambda) - 3x_2(\\lambda) + x_3(\\lambda) = 7$。代入 $x_2(\\lambda)$ 和 $x_3(\\lambda)$ 的值：\n$$(2+\\lambda)x_1(\\lambda) - 3\\left(\\frac{5}{\\lambda}\\right) + 0 = 7$$\n$$(2+\\lambda)x_1(\\lambda) = 7 + \\frac{15}{\\lambda} = \\frac{7\\lambda + 15}{\\lambda}$$\n$$x_1(\\lambda) = \\frac{7\\lambda + 15}{\\lambda(2+\\lambda)}$$\n正则化系统的唯一解是：\n$$x(\\lambda) = \\begin{pmatrix} \\frac{7\\lambda + 15}{\\lambda(2+\\lambda)} \\\\ \\frac{5}{\\lambda} \\\\ 0 \\end{pmatrix}$$\n\n**渐近行为分析与解释：**\n\n我们现在分析当正则化参数 $\\lambda$ 从正方向趋近于 $0$（$\\lambda \\to 0^{+}$）时，解分量的行为：\n- 对于 $x_1(\\lambda)$: $\\lim_{\\lambda \\to 0^+} x_1(\\lambda) = \\lim_{\\lambda \\to 0^+} \\frac{7\\lambda + 15}{\\lambda(2+\\lambda)} = \\lim_{\\lambda \\to 0^+} \\frac{15}{2\\lambda} = +\\infty$。\n- 对于 $x_2(\\lambda)$: $\\lim_{\\lambda \\to 0^+} x_2(\\lambda) = \\lim_{\\lambda \\to 0^+} \\frac{5}{\\lambda} = +\\infty$。\n- 对于 $x_3(\\lambda)$: $\\lim_{\\lambda \\to 0^+} x_3(\\lambda) = 0$。\n\n正则化使得问题对于任何 $\\lambda  0$ 都是唯一可解的。然而，当 $\\lambda \\to 0^{+}$ 时，解向量的前两个分量 $x_1(\\lambda)$ 和 $x_2(\\lambda)$ 发散到无穷大。这表明解对正则化参数高度敏感，并且在极限情况下数值不稳定。解的模 $\\|x(\\lambda)\\|$ 会爆炸。\n\n这种行为与原始矩阵 $U$ 的零空间有关。$U$ 的零空间由满足 $Uv=0$ 的向量 $v$ 组成。从 $4v_3=0$ 得到 $v_3=0$。从 $2v_1-3v_2+v_3=0$ 得到 $2v_1=3v_2$。零空间由向量 $v_{null} = (3/2, 1, 0)^T$ 张成。\n\n当 $\\lambda \\to 0^{+}$ 时，我们解的发散分量的比值为：\n$$\\lim_{\\lambda \\to 0^+} \\frac{x_1(\\lambda)}{x_2(\\lambda)} = \\lim_{\\lambda \\to 0^+} \\frac{(7\\lambda + 15)/(\\lambda(2+\\lambda))}{5/\\lambda} = \\lim_{\\lambda \\to 0^+} \\frac{7\\lambda + 15}{5(2+\\lambda)} = \\frac{15}{5(2)} = \\frac{3}{2}$$\n这表明当 $\\lambda \\to 0^{+}$ 时，解向量 $x(\\lambda)$ 变得与零空间向量 $v_{null}$ 的方向对齐，其大小按 $1/\\lambda$ 的比例缩放：\n$$ x(\\lambda) \\approx \\frac{5}{\\lambda} \\begin{pmatrix} 3/2 \\\\ 1 \\\\ 0 \\end{pmatrix} $$\n正则化强制得到一个唯一解，但这个解由 $U$ 的零空间中一个非常大的分量主导。这是病态问题的一个典型特征，其中正则化可能导致大范数解。此外，$x_3(\\lambda)$ 的极限值为 $0$，这与原始非正则化系统的每个解中找到的值 $x_3 = 5/4$ 不同。这突显出这种类型的正则化不一定收敛到原始问题的解，而是为一个扰动问题找到了一个唯一解，而该扰动问题变得越来越病态。\n\n所要求的最终答案是 $x_2(\\lambda)$ 的精确封闭形式表达式。根据以上推导，这个表达式是 $x_2(\\lambda) = \\frac{5}{\\lambda}$。", "answer": "$$\\boxed{\\frac{5}{\\lambda}}$$", "id": "3285231"}, {"introduction": "从精确的数学运算转向计算机的实际应用，这个问题揭示了浮点数计算中隐藏的风险。你将使用精确数学和模拟的单精度算术来求解同一个系统，观察微小的舍入误差如何滚雪球般地发展成一个完全错误的答案——这一现象被称为“灾难性抵消”。这个练习对于培养在科学计算中对数值稳定性的直觉至关重要。[@problem_id:3285335]", "problem": "考虑使用标准的回代算法求解一个上三角线性系统，从最后一个方程开始向上进行。设\n$$\nU = \\begin{pmatrix}\n10^{-8}  10^{8}  10^{8}  10^{8} \\\\\n0  1  10^{8}  10^{8} \\\\\n0  0  1  10^{8} \\\\\n0  0  0  1\n\\end{pmatrix}, \n\\quad\nb = \\begin{pmatrix}\n3\\times 10^{8} + 10^{-8} \\\\\n2\\times 10^{8} + 1 \\\\\n10^{8} + 1 \\\\\n1\n\\end{pmatrix}.\n$$\n回代算法仅对这些条目使用加法、减法和乘法/除法。\n\n你将使用两种算术模型执行回代：\n1. 精确实数算术，作为概念上的基准真相。\n2. 由电气与电子工程师协会（IEEE）754标准指定的单精度（binary32）浮点算术，采用舍入到最近值、平局则舍入到偶数（ties to even），以及通常的规格化有限格式。假设在进行任何算术运算之前，$U$ 和 $b$ 的条目中提供的每个十进制字面常量都存储为最接近的 binary32 可表示值，并且随后的每个算术运算都在 binary32 中执行，并舍入到最近值。\n\n任务：\n- 使用精确实数算术，确定精确解，并解释 $U$ 和 $b$ 的哪些结构特征使得 $x_1$ 的计算对相消（cancellation）敏感。\n- 然后，按照描述在 IEEE 754 单精度（binary32）下执行回代，并确定为 $x_1$ 返回的值，明确引用所遇到数量级附近的相邻浮点数之间的间距尺度（末位单位），以证明每个导致相消或有效数字损失的舍入事件的合理性。\n\n答案规格：\n- 以科学记数法形式的单个实数报告计算出的 $x_1$ 的 IEEE 754 单精度值。\n- 将最终报告的数字四舍五入到四位有效数字。", "solution": "### 第 1 部分：精确实数算术解与敏感性分析\n\n使用精确实数算术进行回代：\n\n1.  从第四个方程，$u_{44}x_4 = b_4$：\n    $$1 \\cdot x_4 = 1 \\implies x_4 = 1$$\n\n2.  从第三个方程，$u_{33}x_3 + u_{34}x_4 = b_3$：\n    $$1 \\cdot x_3 + 10^8 \\cdot x_4 = 10^8 + 1$$\n    代入 $x_4=1$：\n    $$x_3 + 10^8 = 10^8 + 1 \\implies x_3 = 1$$\n\n3.  从第二个方程，$u_{22}x_2 + u_{23}x_3 + u_{24}x_4 = b_2$：\n    $$1 \\cdot x_2 + 10^8 \\cdot x_3 + 10^8 \\cdot x_4 = 2 \\times 10^8 + 1$$\n    代入 $x_3=1$ 和 $x_4=1$：\n    $$x_2 + 10^8(1) + 10^8(1) = 2 \\times 10^8 + 1$$\n    $$x_2 + 2 \\times 10^8 = 2 \\times 10^8 + 1 \\implies x_2 = 1$$\n\n4.  从第一个方程，$u_{11}x_1 + u_{12}x_2 + u_{13}x_3 + u_{14}x_4 = b_1$：\n    $$10^{-8} \\cdot x_1 + 10^8 \\cdot x_2 + 10^8 \\cdot x_3 + 10^8 \\cdot x_4 = 3 \\times 10^8 + 10^{-8}$$\n    代入 $x_2=1, x_3=1, x_4=1$：\n    $$10^{-8} x_1 + 10^8(1) + 10^8(1) + 10^8(1) = 3 \\times 10^8 + 10^{-8}$$\n    $$10^{-8} x_1 + 3 \\times 10^8 = 3 \\times 10^8 + 10^{-8}$$\n    $$10^{-8} x_1 = 10^{-8} \\implies x_1 = 1$$\n\n精确解为 $x = (1, 1, 1, 1)^T$。\n\n**$x_1$ 的敏感性分析**：\n$x_1$ 的计算公式为：\n$$x_1 = \\frac{1}{u_{11}} \\left( b_1 - \\sum_{j=2}^{4} u_{1j} x_j \\right)$$\n代入精确值：\n$$x_1 = \\frac{1}{10^{-8}} \\left( (3 \\times 10^8 + 10^{-8}) - (10^8 \\cdot 1 + 10^8 \\cdot 1 + 10^8 \\cdot 1) \\right)$$\n$$x_1 = 10^8 \\left( (3 \\times 10^8 + 10^{-8}) - (3 \\times 10^8) \\right)$$\n括号中的项涉及两个非常大且几乎相等的数的减法。这种现象被称为 **灾难性相消 (catastrophic cancellation)**。如果项 $b_1$ 和和 $\\sum u_{1j}x_j$ 的计算有任何精度损失，它们差值中微小但重要的部分（$10^{-8}$）就可能丢失。导致这种情况的 $U$ 和 $b$ 的结构特征是：\n1. 对角元素 $u_{11} = 10^{-8}$ 非常小，因此其倒数 $1/u_{11} = 10^8$ 非常大。这会放大括号内计算项的任何误差。\n2. 第一行中的非对角元素（$u_{12}$、$u_{13}$、$u_{14}$）非常大（$10^8$）。\n3. 右侧向量元素 $b_1 = 3 \\times 10^8 + 10^{-8}$ 被构造成非常接近于和 $\\sum_{j=2}^{4} u_{1j} x_j = 3 \\times 10^8$。\n这些条件使得系统是病态的，且 $x_1$ 的计算对舍入误差高度敏感。\n\n### 第 2 部分：IEEE 754 单精度（binary32）解\n\n设 $\\text{fl}(z)$ 表示实数 $z$ 的最近单精度浮点表示。我们将使用 binary32 算术执行回代。\n\n**步骤 A：初始数据表示**\n我们必须首先分析给定常数在单精度浮点格式下的表示。当一个实数被存储时，它会被舍入到最接近的可表示浮点值。\n- 末位单位（ulp）$\\text{ulp}(y) = 2^{\\lfloor \\log_2|y| \\rfloor - 23}$ 是机器精度的一个度量，代表了数值 $y$ 附近可表示数之间的间距。\n- 对于 $b_3 = 10^8 + 1$：$\\text{fl}(10^8)$ 附近的 ulp 是 $\\text{ulp}(\\text{fl}(10^8)) = 2^{\\lfloor \\log_2(10^8) \\rfloor - 23} = 2^{26 - 23} = 8$。由于加数 $1$ 远小于 ulp 的一半（即 4），$10^8+1$ 在存储时将被舍入到与 $10^8$ 相同的浮点值。因此，$\\text{fl}(10^8+1) = \\text{fl}(10^8)$。\n- 对于 $b_2 = 2 \\times 10^8 + 1$：$\\text{ulp}(\\text{fl}(2 \\times 10^8)) = 2^{\\lfloor \\log_2(2\\times 10^8) \\rfloor - 23} = 2^{27 - 23} = 16$。由于加数 $1$ 远小于 ulp 的一半（即 8），我们有 $\\text{fl}(2 \\times 10^8 + 1) = \\text{fl}(2 \\times 10^8)$。\n- 对于 $b_1 = 3 \\times 10^8 + 10^{-8}$：$\\text{ulp}(\\text{fl}(3 \\times 10^8)) = 2^{\\lfloor \\log_2(3\\times 10^8) \\rfloor - 23} = 2^{28 - 23} = 32$。加数 $10^{-8}$ 与 ulp 相比可以忽略不计，因此 $\\text{fl}(3 \\times 10^8 + 10^{-8}) = \\text{fl}(3 \\times 10^8)$。\n\n由于这些舍入效应，在浮点算术中求解的系统等效于 $U_f x_f = b_f$，其中矩阵 $U_f$ 与 $U$ 几乎相同（除了 $\\tilde{u}_{11} = \\text{fl}(10^{-8})$），而向量 $b_f$ 的条目实际上是：\n$$\nb_f = \\begin{pmatrix}\n\\text{fl}(3\\times 10^{8}) \\\\\n\\text{fl}(2\\times 10^{8}) \\\\\n\\text{fl}(10^{8}) \\\\\n1\n\\end{pmatrix}.\n$$\n\n**步骤 B：浮点回代**\n设 $\\oplus, \\ominus, \\otimes, \\oslash$ 表示相应的 IEEE 754 运算。\n\n1.  计算 $x_{f,4}$：\n    $$x_{f,4} = b_{f,4} \\oslash u_{f,44} = 1 \\oslash 1 = 1$$\n\n2.  计算 $x_{f,3}$：\n    $$x_{f,3} = (b_{f,3} \\ominus u_{f,34} \\otimes x_{f,4}) \\oslash u_{f,33} = (10^8 \\ominus 10^8 \\otimes 1) \\oslash 1 = (10^8 \\ominus 10^8) \\oslash 1 = 0 \\oslash 1 = 0$$\n    存储 $b_3$ 时的舍入误差导致精确值 $x_3=1$ 变为了 $x_{f,3}=0$。\n\n3.  计算 $x_{f,2}$：\n    $$x_{f,2} = (b_{f,2} \\ominus (u_{f,23} \\otimes x_{f,3} \\oplus u_{f,24} \\otimes x_{f,4})) \\oslash u_{f,22}$$\n    和为 $10^8 \\otimes 0 \\oplus 10^8 \\otimes 1 = 0 \\oplus 10^8 = 10^8$。\n    $$x_{f,2} = (2\\times 10^8 \\ominus 10^8) \\oslash 1 = 10^8 \\oslash 1 = 10^8$$\n    $x_{f,3}$ 的误差传播，导致精确值 $x_2=1$ 变为了 $x_{f,2}=10^8$。\n\n4.  计算 $x_{f,1}$：\n    $$x_{f,1} = (b_{f,1} \\ominus (u_{f,12} \\otimes x_{f,2} \\oplus u_{f,13} \\otimes x_{f,3} \\oplus u_{f,14} \\otimes x_{f,4})) \\oslash \\tilde{u}_{11}$$\n    我们来计算和 $S_f = u_{f,12} \\otimes x_{f,2} \\oplus u_{f,13} \\otimes x_{f,3} \\oplus u_{f,14} \\otimes x_{f,4}$。\n    $$S_f = 10^8 \\otimes 10^8 \\oplus 10^8 \\otimes 0 \\oplus 10^8 \\otimes 1$$\n    $$S_f = \\text{fl}(10^{16}) \\oplus 0 \\oplus 10^8 = \\text{fl}(10^{16}) \\oplus 10^8$$\n    现在我们必须分析运算 $\\text{fl}(10^{16}) \\oplus 10^8$。这是一个 **淹没 (swamping)** 的例子。$\\lfloor \\log_2(10^{16}) \\rfloor = 53$。数量级为 $10^{16}$ 的数的 ulp 是 $\\text{ulp}(\\text{fl}(10^{16})) = 2^{53} \\times 2^{-23} = 2^{30} \\approx 1.07 \\times 10^9$。被加数 $10^8$ 小于 ulp 的一半（$2^{29}$）。因此，在单精度下，这个加法对值没有影响。\n    $$S_f = \\text{fl}(10^{16})$$\n    分子是 $N_f = b_{f,1} \\ominus S_f = 3\\times 10^8 \\ominus \\text{fl}(10^{16})$。这是另一个淹没事件。减数 $\\text{fl}(10^{16})$ 远大于 $3\\times 10^8$，且 $3\\times 10^8$ 小于 $\\text{ulp}(\\text{fl}(10^{16}))/2$。\n    $$N_f = \\text{fl}(3\\times 10^8 - \\text{fl}(10^{16})) = -\\text{fl}(10^{16})$$\n    最后，我们计算 $x_{f,1}$：\n    $$x_{f,1} = N_f \\oslash \\tilde{u}_{11} = (-\\text{fl}(10^{16})) \\oslash \\text{fl}(10^{-8})$$\n    使用高精度计算器计算由 binary32 格式表示的值：\n    $\\text{fl}(10^{16}) \\approx 1.00000001335 \\times 10^{16}$\n    $\\text{fl}(10^{-8}) \\approx 9.99999996004 \\times 10^{-9}$\n    商大约是：\n    $$x_{f,1} \\approx -\\frac{1.00000001335 \\times 10^{16}}{9.99999996004 \\times 10^{-9}} \\approx -1.00000001735 \\times 10^{24}$$\n    最接近此值的单精度浮点数通过舍入得到。\n    $\\text{fl}(-1.00000001735\\times 10^{24}) \\approx -1.0000000 \\times 10^{24}$。\n    保留四位有效数字，结果是 $-1.000 \\times 10^{24}$。\n\n精确实数算术分析中预期的灾难性相消并未发生。相反，$b_3$ 上的初始舍入误差被传播和放大，导致在计算 $x_1$ 的最后阶段出现淹没，产生了一个与真实解相差几个数量级的结果。", "answer": "$$\n\\boxed{-1.000 \\times 10^{24}}\n$$", "id": "3285335"}]}