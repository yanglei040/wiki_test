{"hands_on_practices": [{"introduction": "我们从一个直接的应用开始。这项练习将指导你使用复合辛普森法则，对一个我们熟悉且可以轻松求得精确解的函数进行积分。通过将数值近似结果与精确解进行比较，你可以直观地理解近似误差的概念，并验证你对公式的掌握情况。这是掌握任何数值方法的第一步：确保你能够正确地执行计算过程 [@problem_id:2210199]。", "problem": "一个物理系统中可观测的量 $Q$ 的变化率由函数 $f(t) = V_0 \\cos(\\omega t)$ 描述，其中 $t$ 是时间。该量在区间 $[a, b]$ 上的总变化量由定积分 $\\Delta Q = \\int_{a}^{b} f(t) \\, dt$ 给出。\n\n考虑一个系统，其常数为 $V_0 = 1.0$ 单位/秒 和 $\\omega = 1.0$ 弧度/秒。你的任务是分析在时间区间从 $t=0$ 到 $t=\\frac{\\pi}{2}$ 秒内，$Q$ 的总变化量 $\\Delta Q$（以单位计）。\n\n首先，计算总变化量的精确值 $\\Delta Q_{exact}$。\n其次，通过使用 $n=4$ 个子区间的复合辛普森 1/3 法则，计算总变化量的近似值 $\\Delta Q_{approx}$。对于一个积分 $\\int_a^b g(x) \\, dx$，使用偶数个子区间 $n$ 的复合辛普森 1/3 法则的近似公式为\n$$S_n = \\frac{h}{3} \\left[ g(x_0) + 4\\sum_{i=1}^{n/2} g(x_{2i-1}) + 2\\sum_{i=1}^{n/2-1} g(x_{2i}) + g(x_n) \\right]$$\n其中 $h = \\frac{b-a}{n}$ 且 $x_i = a+ih$，对于 $i=0, 1, \\dots, n$。\n\n最后，计算该近似的绝对误差的大小，其定义为 $|\\Delta Q_{exact} - \\Delta Q_{approx}|$。将此绝对误差作为你的最终答案。将最终答案四舍五入到五位有效数字。", "solution": "我们已知变化率 $f(t) = V_{0}\\cos(\\omega t)$ 和在 $[a,b]$ 上的总变化量：\n$$\n\\Delta Q=\\int_{a}^{b} f(t)\\,dt.\n$$\n当 $V_{0}=1$ 和 $\\omega=1$ 时，我们有 $f(t)=\\cos t$，$a=0$，$b=\\frac{\\pi}{2}$。\n\n精确值：\n使用不定积分 $\\int \\cos t\\,dt=\\sin t$，根据微积分基本定理可得\n$$\n\\Delta Q_{\\text{exact}}=\\int_{0}^{\\frac{\\pi}{2}} \\cos t\\,dt=\\left[\\sin t\\right]_{0}^{\\frac{\\pi}{2}}=\\sin\\!\\left(\\frac{\\pi}{2}\\right)-\\sin(0)=1-0=1.\n$$\n\n使用 $n=4$ 的复合辛普森 1/3 法则：\n这里 $h=\\frac{b-a}{n}=\\frac{\\frac{\\pi}{2}-0}{4}=\\frac{\\pi}{8}$ 且 $x_{i}=a+ih=0+i\\frac{\\pi}{8}$，对于 $i=0,1,2,3,4$。因此\n$$\nx_{0}=0,\\quad x_{1}=\\frac{\\pi}{8},\\quad x_{2}=\\frac{\\pi}{4},\\quad x_{3}=\\frac{3\\pi}{8},\\quad x_{4}=\\frac{\\pi}{2}.\n$$\n使用复合辛普森公式\n$$\nS_{4}=\\frac{h}{3}\\left[g(x_{0})+4\\sum_{i=1}^{2}g(x_{2i-1})+2\\sum_{i=1}^{1}g(x_{2i})+g(x_{4})\\right],\n$$\n当 $g(t)=\\cos t$ 时，我们得到\n$$\nS_{4}=\\frac{\\pi}{24}\\left[\\cos 0+4\\left(\\cos\\!\\left(\\frac{\\pi}{8}\\right)+\\cos\\!\\left(\\frac{3\\pi}{8}\\right)\\right)+2\\cos\\!\\left(\\frac{\\pi}{4}\\right)+\\cos\\!\\left(\\frac{\\pi}{2}\\right)\\right].\n$$\n使用精确的特殊值 $\\cos 0=1$, $\\cos\\!\\left(\\frac{\\pi}{4}\\right)=\\frac{\\sqrt{2}}{2}$, $\\cos\\!\\left(\\frac{\\pi}{2}\\right)=0$ 和数值近似值 $\\cos\\!\\left(\\frac{\\pi}{8}\\right)\\approx 0.9238795325$, $\\cos\\!\\left(\\frac{3\\pi}{8}\\right)\\approx 0.3826834324$，我们计算\n$$\nS_{4}\\approx \\frac{\\pi}{24}\\left[1+4(0.9238795325+0.3826834324)+2\\cdot 0.7071067812+0\\right]\\approx 1.000134584974194.\n$$\n\n绝对误差：\n$$\n\\left|\\Delta Q_{\\text{exact}}-\\Delta Q_{\\text{approx}}\\right|=\\left|1-1.000134584974194\\right|\\approx 0.000134584974194.\n$$\n四舍五入到五位有效数字得到 $1.3458\\times 10^{-4}$。", "answer": "$$\\boxed{1.3458 \\times 10^{-4}}$$", "id": "2210199"}, {"introduction": "仅仅会应用公式是不够的；在实际工程和科学问题中，我们通常需要确保数值结果达到一定的精度要求。这项练习将带你从“计算”走向“设计”，通过引入复合辛普森法则的误差界限公式，你将学会如何预先确定需要多少个子区间才能保证近似误差小于指定的容差。这是一种至关重要的能力，它使得数值积分从一次性的估算变成一个可控、可靠的求解过程 [@problem_id:2210241]。", "problem": "在数值分析中，当一个函数的解析解难以或无法求得时，其定积分通常使用求积法则来近似计算。复合辛普森 1/3 法则就是这样一种方法。\n\n考虑近似计算积分 $I = \\int_1^2 \\frac{1}{x} \\, dx$ 的值。\n\n使用偶数个子区间 $n$ 的复合辛普森 1/3 法则来近似计算 $\\int_a^b f(x) \\, dx$ 时，其绝对误差 $E_S$ 的上界由以下不等式给出：\n$$|E_S| \\leq \\frac{(b-a)^5}{180n^4} M_4$$\n其中 $M_4$ 是函数 $f(x)$ 在区间 $[a, b]$ 上四阶导数绝对值的一个上界；即对所有 $x \\in [a, b]$ 都有 $|f^{(4)}(x)| \\leq M_4$。\n\n求保证使用复合辛普森 1/3 法则对积分 $I$ 的近似值其绝对误差小于 $10^{-5}$ 所需的最小偶数 $n$ 值。", "solution": "我们使用复合辛普森 1/3 法则和 $n$ 个（偶数）子区间来近似计算 $I=\\int_{1}^{2}\\frac{1}{x}\\,dx$。误差界为\n$$\n|E_{S}|\\leq \\frac{(b-a)^{5}}{180\\,n^{4}}\\,M_{4},\n$$\n其中 $M_{4}$ 满足对于 $x\\in[1,2]$ 有 $|f^{(4)}(x)|\\leq M_{4}$，且 $f(x)=\\frac{1}{x}$。\n\n计算导数：\n$$\nf(x)=x^{-1},\\quad f'(x)=-x^{-2},\\quad f''(x)=2x^{-3},\\quad f^{(3)}(x)=-6x^{-4},\\quad f^{(4)}(x)=24x^{-5}.\n$$\n因此 $|f^{(4)}(x)|=24x^{-5}$，该函数在 $[1,2]$ 上是递减的，故其最大值在 $x=1$ 处取得。因此\n$$\nM_{4}=24.\n$$\n\n当 $a=1$ 且 $b=2$ 时，我们有 $b-a=1$，所以误差界变为\n$$\n|E_{S}|\\leq \\frac{1^{5}}{180\\,n^{4}}\\cdot 24=\\frac{24}{180\\,n^{4}}=\\frac{2}{15\\,n^{4}}.\n$$\n为保证 $|E_{S}|  10^{-5}$，我们只需满足\n$$\n\\frac{2}{15\\,n^{4}}  10^{-5}\\quad\\Longrightarrow\\quad n^{4}\\geq \\frac{2}{15}\\times 10^{5}=\\frac{40000}{3}.\n$$\n两边取四次方根，得到 $n\\geq \\left(\\frac{40000}{3}\\right)^{1/4}$。由于 $n$ 必须是偶数，我们测试 $n=10$ 和 $n=12$：\n$$\n10^{4}=10000  \\frac{40000}{3},\\quad 12^{4}=20736 > \\frac{40000}{3}.\n$$\n因此，确保 $|E_{S}|  10^{-5}$ 的最小偶数 $n$ 是 $n=12$。", "answer": "$$\\boxed{12}$$", "id": "2210241"}, {"introduction": "复合辛普森法则的理论保证依赖于被积函数足够“光滑”（即具有连续的高阶导数）。然而，当我们面对带有“尖角”或不连续点的函数时，应该如何处理？本练习将探讨这一重要特例，通过对一个在积分区间内存在不可导点的函数进行积分，你将学习到一种关键的“分而治之”策略。这种分段处理的方法不仅是解决此类问题的标准技巧，更能让你深刻理解数值方法背后的理论假设及其适用边界 [@problem_id:2210259]。", "problem": "一个函数 $f(x)$ 在区间 $[0, 2]$ 上定义为 $f(x) = |x^3 - 1|$。你的任务是求定积分 $I = \\int_0^2 f(x) \\, dx$ 的一个数值近似值。\n\n由于被积函数 $f(x)$ 有一个不可导的点，所以必须小心地应用标准的数值积分法则。为了处理这个问题，你必须首先在不可导点将积分拆分成两个独立的积分。然后，对每个积分应用复合辛普森 1/3 法则。\n\n对于区间 $[0, 1]$ 上的积分，使用 $n_1 = 2$ 个子区间。对于区间 $[1, 2]$ 上的积分，使用 $n_2 = 2$ 个子区间。这样在原定义域 $[0, 2]$ 上总共有 $n = n_1 + n_2 = 4$ 个子区间。\n\n计算积分 $I$ 的数值近似值。将你的最终答案表示为最简精确分数。", "solution": "我们有 $f(x)=|x^{3}-1|$，它在 $x^{3}-1=0$ 的根，即 $x=1$ 处不可导。将 $\\int_{0}^{2}f(x)\\,dx$ 在 $x=1$ 处拆分，并分别在 $[0,1]$ 上对 $n_{1}=2$ 和在 $[1,2]$ 上对 $n_{2}=2$ 的每个子区间应用复合辛普森 $\\frac{1}{3}$ 法则。\n\n在 $[0,1]$上，$f(x)=1-x^{3}$。当 $n_{1}=2$ 时，步长为 $h_{1}=\\frac{1}{2}$，节点为 $x_{0}=0$，$x_{1}=\\frac{1}{2}$，$x_{2}=1$。函数值为\n$$\nf(x_{0})=1,\\quad f(x_{1})=1-\\left(\\frac{1}{2}\\right)^{3}=1-\\frac{1}{8}=\\frac{7}{8},\\quad f(x_{2})=0.\n$$\n使用 $n=2$ 的复合辛普森 $\\frac{1}{3}$ 法则得到\n$$\nI_{1}\\approx \\frac{h_{1}}{3}\\left[f(x_{0})+4f(x_{1})+f(x_{2})\\right]\n=\\frac{\\frac{1}{2}}{3}\\left[1+4\\cdot \\frac{7}{8}+0\\right]\n=\\frac{1}{6}\\left(1+\\frac{7}{2}\\right)\n=\\frac{1}{6}\\cdot \\frac{9}{2}\n=\\frac{3}{4}.\n$$\n\n在 $[1,2]$上，$f(x)=x^{3}-1$。当 $n_{2}=2$ 时，步长为 $h_{2}=\\frac{1}{2}$，节点为 $x_{0}=1$，$x_{1}=\\frac{3}{2}$，$x_{2}=2$。函数值为\n$$\nf(x_{0})=0,\\quad f(x_{1})=\\left(\\frac{3}{2}\\right)^{3}-1=\\frac{27}{8}-1=\\frac{19}{8},\\quad f(x_{2})=8-1=7.\n$$\n复合辛普森 $\\frac{1}{3}$ 法则得到\n$$\nI_{2}\\approx \\frac{h_{2}}{3}\\left[f(x_{0})+4f(x_{1})+f(x_{2})\\right]\n=\\frac{1}{6}\\left[0+4\\cdot \\frac{19}{8}+7\\right]\n=\\frac{1}{6}\\left(\\frac{19}{2}+7\\right)\n=\\frac{1}{6}\\cdot \\frac{33}{2}\n=\\frac{11}{4}.\n$$\n\n将两个近似值相加，\n$$\nI\\approx I_{1}+I_{2}=\\frac{3}{4}+\\frac{11}{4}=\\frac{14}{4}=\\frac{7}{2}.\n$$\n由于每一部分都是三次多项式，而辛普森 $\\frac{1}{3}$ 法则对于最高三次的多项式是精确的，因此这个值等于精确积分值。", "answer": "$$\\boxed{\\frac{7}{2}}$$", "id": "2210259"}]}