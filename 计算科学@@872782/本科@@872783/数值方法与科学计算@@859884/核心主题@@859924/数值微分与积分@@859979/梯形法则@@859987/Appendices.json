{"hands_on_practices": [{"introduction": "理论知识需要通过实践来巩固。在许多物理和工程问题中，我们会遇到难以通过解析方法求解的积分。这项练习将理论与一个具体的物理情景——计算压缩气体所做的功——相结合，让你在一个具体问题中练习使用梯形法则进行数值近似，这是将实际问题转化为数值计算的基本步骤。通过解决这个问题 [@problem_id:2222091]，你将掌握梯形法则最直接的应用。", "problem": "在一个材料科学实验中，一个活塞被用来压缩一个圆筒中的气体。该过程进行得很缓慢，因此可以被视为准静态和等温过程。将活塞保持在位置 $x$（从圆筒的封闭端测量）所需的力 $F$ 被发现遵循定律 $F(x) = k/x$，其中 $k$ 是一个与温度和气体量有关的常数。\n\n要移动活塞并压缩气体，必须做功。外部作用力将活塞从初始位置 $x_i$ 移动到最终位置 $x_f$ 所做的精确功 $W$ 由积分 $W = \\int_{x_i}^{x_f} F(x) dx$ 给出。\n\n假设活塞从 $x_i = 1$ 米移动到 $x_f = 3$ 米，常数 $k = 1$ 牛·米。你的任务是求出所做功的近似值。近似方法包括以下步骤：\n1. 将总位移区间 $[x_i, x_f]$ 分成两个等长的子区间。\n2. 对于每个子区间，用由x轴、子区间端点处的垂线以及连接这些端点处力值的直线段所形成的梯形面积来近似力-位移曲线下的面积。\n3. 将这两个梯形的面积相加，得到总的近似功。\n\n使用这种方法，计算移动活塞所做的近似功。以焦耳为单位，将你的答案表示为最简分数。", "solution": "题目要求在力 $F(x) = \\frac{k}{x}$ 的作用下，将活塞从 $x_i = 1$ 米移动到 $x_f = 3$ 米所做的功 $W$ 的近似值。我们已知 $k = 1$ 牛·米。功由以下积分给出：\n$$W = \\int_{1}^{3} \\frac{1}{x} dx$$\n\n题目描述了一种数值近似方法，该方法等价于使用两个分段的复合梯形法则。设区间为 $[a, b] = [1, 3]$，分段数为 $n=2$。要积分的函数是 $f(x) = \\frac{1}{x}$。\n\n首先，我们计算每个子区间的宽度 $h$：\n$$h = \\frac{b - a}{n} = \\frac{3 - 1}{2} = 1$$\n\n两个子区间是 $[1, 2]$ 和 $[2, 3]$。求值点（子区间的端点）是 $x_0 = 1$，$x_1 = 2$ 和 $x_2 = 3$。\n\n所描述的近似方法是求两个梯形的面积之和。\n第一个梯形在区间 $[x_0, x_1]$ 上的面积是：\n$$A_1 = \\frac{h}{2} (f(x_0) + f(x_1))$$\n第二个梯形在区间 $[x_1, x_2]$ 上的面积是：\n$$A_2 = \\frac{h}{2} (f(x_1) + f(x_2))$$\n\n总的近似功 $W_{\\text{approx}}$ 是这两个面积的和：\n$$W_{\\text{approx}} = A_1 + A_2 = \\frac{h}{2}(f(x_0) + f(x_1)) + \\frac{h}{2}(f(x_1) + f(x_2))$$\n这可以简化为标准的复合梯形法则公式：\n$$W_{\\text{approx}} = \\frac{h}{2} (f(x_0) + 2f(x_1) + f(x_2))$$\n\n现在我们在点 $x_0, x_1, x_2$ 处计算函数 $f(x) = \\frac{1}{x}$ 的值：\n$$f(x_0) = f(1) = \\frac{1}{1} = 1$$\n$$f(x_1) = f(2) = \\frac{1}{2}$$\n$$f(x_2) = f(3) = \\frac{1}{3}$$\n\n现在，我们将这些值代入 $W_{\\text{approx}}$ 的公式中。我们还代入 $h=1$。\n$$W_{\\text{approx}} = \\frac{1}{2} \\left( 1 + 2\\left(\\frac{1}{2}\\right) + \\frac{1}{3} \\right)$$\n\n我们简化括号内的表达式：\n$$W_{\\text{approx}} = \\frac{1}{2} \\left( 1 + 1 + \\frac{1}{3} \\right)$$\n$$W_{\\text{approx}} = \\frac{1}{2} \\left( 2 + \\frac{1}{3} \\right)$$\n\n为了将括号内的项相加，我们找到一个公分母：\n$$W_{\\text{approx}} = \\frac{1}{2} \\left( \\frac{6}{3} + \\frac{1}{3} \\right)$$\n$$W_{\\text{approx}} = \\frac{1}{2} \\left( \\frac{7}{3} \\right)$$\n\n最后，我们进行乘法运算：\n$$W_{\\text{approx}} = \\frac{7}{6}$$\n\n题目说明 $k$ 的单位是牛·米，$x$ 的单位是米，所以功 $W$ 的单位是焦耳。题目要求答案以焦耳为单位，表示为最简分数。我们的结果是 $7/6$。", "answer": "$$\\boxed{\\frac{7}{6}}$$", "id": "2222091"}, {"introduction": "一个数值近似方法只有当我们了解其精度时才真正有用。在第一个练习的基础上，这项实践 [@problem_id:2210520] 从简单的计算转向了更关键的任务：误差控制。通过一个药物动力学的实际案例，你将学习如何使用梯形法则的误差界限公式来确定需要多少个子区间，才能确保计算结果达到预期的精度，这在科学计算中是一项至关重要的技能。", "problem": "在一项药代动力学研究中，一种新药在患者血液中的浓度被建模为时间 $t$ 的函数，由方程 $C(t) = C_0 \\exp(-kt^2)$ 给出。此处，$t$ 是注射后的小时数，$C_0 = 50$ mg/L 是初始浓度，$k = 0.5 \\text{ hr}^{-2}$ 是一个与药物消除速率相关的常数。\n\n为评估前两个小时内的总药物暴露量，一名生物医学工程师需要计算曲线下面积（AUC），它由定积分 $A = \\int_{0}^{T} C(t) dt$ 给出，其中 $T=2$ 小时。\n\n该工程师使用一种数值近似方法。时间区间 $[0, T]$ 被分成 $n$ 个相等的子区间，积分值通过对每个子区间上连接点 $(t_i, C(t_i))$ 和 $(t_{i+1}, C(t_{i+1}))$ 所形成的梯形的面积求和来近似。\n\n对于这种特定的数值方法，已知绝对误差 $|E_n|$ 受以下不等式约束：\n$$|E_n| \\le \\frac{M(T-0)^3}{12n^2}$$\n其中 $M$ 是浓度函数二阶导数的最大绝对值，$M = \\max_{t \\in [0, T]} |C''(t)|$。\n\n确定工程师必须使用的最小整数子区间数 $n$，以保证计算出的 AUC 的绝对误差小于 $10^{-3}$ mg·hr/L。", "solution": "给定 $C(t) = C_{0}\\exp(-k t^{2})$，其中 $C_{0} = 50$，$k = 0.5$，以及梯形法则的误差界\n$$|E_{n}| \\le \\frac{M(T-0)^{3}}{12 n^{2}}, \\quad M = \\max_{t \\in [0,T]} |C''(t)|, \\quad T=2.$$\n\n首先计算 $C''(t)$。求导得，\n$$C'(t) = C_{0}\\exp(-k t^{2})(-2 k t),$$\n$$C''(t) = C_{0}\\exp(-k t^{2})\\left(-2k + 4k^{2} t^{2}\\right) = 2k C_{0}\\exp(-k t^{2})\\left(-1 + 2k t^{2}\\right).$$\n因此\n$$|C''(t)| = 2k C_{0}\\exp(-k t^{2})\\left| -1 + 2k t^{2} \\right|.$$\n\n令 $t_{0} = \\frac{1}{\\sqrt{2k}}$。对于 $t \\in [0,t_{0}]$，我们有 $-1 + 2k t^{2} \\le 0$，所以\n$$|C''(t)| = 2k C_{0}\\exp(-k t^{2})\\left(1 - 2k t^{2}\\right).$$\n定义 $h_{1}(t) = 2k C_{0}\\exp(-k t^{2})(1 - 2k t^{2})$。其导数为\n$$h_{1}'(t) = 4 k^{2} C_{0} t \\exp(-k t^{2})\\left(-3 + 2k t^{2}\\right).$$\n在 $(0,t_{0}]$ 上，因为 $t_{0}^{2} = \\frac{1}{2k}$，我们有 $-3 + 2k t^{2} \\le -3 + 1 = -2  0$，因此 $h_{1}'(t)  0$。所以 $h_{1}$ 在 $[0,t_{0}]$ 上是递减的，并在 $t=0$ 处取得其最大值：\n$$h_{1}(0) = 2k C_{0}.$$\n\n对于 $t \\in [t_{0},T]$，我们有 $-1 + 2k t^{2} \\ge 0$，所以\n$$|C''(t)| = 2k C_{0}\\exp(-k t^{2})\\left(-1 + 2k t^{2}\\right).$$\n定义 $h_{2}(t) = 2k C_{0}\\exp(-k t^{2})(-1 + 2k t^{2})$。其导数为\n$$h_{2}'(t) = 4 k^{2} C_{0} t \\exp(-k t^{2})\\left(3 - 2k t^{2}\\right).$$\n在 $[t_{0},T]$ 内的临界点出现在 $t = \\sqrt{\\frac{3}{2k}}$，如果该点位于区间内。当 $k = 0.5$ 时，我们有 $t_{0} = 1$，$T=2$，且 $\\sqrt{\\frac{3}{2k}} = \\sqrt{3} \\in [1,2]$。在候选点处计算 $h_{2}$ 的值：\n- 在 $t = t_{0}$ 处，$h_{2}(t_{0}) = 0$。\n- 在 $t = \\sqrt{\\frac{3}{2k}}$ 处，因为 $2k t^{2} = 3$，\n$$h_{2}\\!\\left(\\sqrt{\\frac{3}{2k}}\\right) = 2k C_{0} \\cdot 2 \\cdot \\exp\\!\\left(-\\frac{3}{2}\\right) = 4k C_{0}\\exp\\!\\left(-\\frac{3}{2}\\right).$$\n- 在 $t = T=2$ 处，\n$$h_{2}(2) = 2k C_{0}\\left(-1 + 8k\\right)\\exp(-4k).$$\n\n将这些值与 $2k C_{0}$ 比较。注意到\n$$4k C_{0}\\exp\\!\\left(-\\frac{3}{2}\\right) = 2k C_{0}\\cdot 2\\exp\\!\\left(-\\frac{3}{2}\\right)  2k C_{0}$$\n因为 $\\exp\\!\\left(\\frac{3}{2}\\right) > 2$，所以 $2\\exp(-\\frac{3}{2})  1$。对于 $k=0.5$，$h_{2}(2)$ 也小于 $2k C_{0}$。因此，在 $[0,2]$ 上的最大值在 $t=0$ 处取得：\n$$M = \\max_{t \\in [0,2]} |C''(t)| = 2k C_{0} = 2 \\cdot 0.5 \\cdot 50 = 50.$$\n\n应用 $T=2$ 的误差界：\n$$|E_{n}| \\le \\frac{M T^{3}}{12 n^{2}} = \\frac{50 \\cdot 2^{3}}{12 n^{2}} = \\frac{100}{3 n^{2}}.$$\n要求 $|E_{n}|  10^{-3}$：\n$$\\frac{100}{3 n^{2}}  10^{-3} \\quad \\Longleftrightarrow \\quad n^{2} > \\frac{100}{3 \\cdot 10^{-3}} = \\frac{100000}{3}.$$\n因此 $n > \\sqrt{\\frac{100000}{3}}$。因为 $182^{2} = 33124  \\frac{100000}{3}  33489 = 183^{2}$，满足该不等式的最小整数 $n$ 是\n$$n = 183.$$", "answer": "$$\\boxed{183}$$", "id": "2210520"}, {"introduction": "我们很容易陷入一个误区，认为更复杂、更高阶的数值方法总是更优越。这项高级练习 [@problem_id:3284359] 通过一个巧妙的思想实验来挑战这一普遍直觉。你需要设计一个特殊的函数，使得简单的梯形法则在该函数上的表现优于更高阶的辛普森法则。完成这个挑战将帮助你深入理解数值方法与被积函数特性之间的相互作用，培养批判性思维和对算法局限性的认识。", "problem": "考虑在区间 $[0,1]$ 上对一个光滑函数进行数值积分，使用固定的9个函数求值预算，这些求值点位于均匀间隔的节点 $x_j = j/8$（其中 $j = 0,1,\\dots,8$）上。对于这组节点，可以通过用多项式对 $f(x)$ 进行局域插值，然后对这些插值多项式进行积分来构建复合求积法则，以近似定积分 $\\int_{0}^{1} f(x)\\,dx$。两种广泛使用的此类法则是基于线性插值（复合梯形法则）和二次插值（复合辛普森法则），两者都作用于均匀网格上。\n\n请严格从数值求积的这些核心定义（即在均匀节点上构建的插值型公式）出发，并且不引用任何预先给定的误差常数或闭合形式的误差公式，设计一个在 $[0,1]$ 上具体的、连续可微的函数 $f(x)$，使得当两种法则在节点 $\\{x_j\\}_{j=0}^{8}$ 上使用相同的9个函数求值点时，复合梯形法则对 $\\int_{0}^{1} f(x)\\,dx$ 的近似结果比复合辛普森法则更精确。\n\n你的答案必须是 $f(x)$ 的一个明确解析表达式，并且你必须在推理中证明，对于这个 $f(x)$ 和指定的节点，复合梯形法则的结果严格地比复合辛普森法则更接近真实的积分值。不需要四舍五入，也不涉及任何单位；请在你的推理过程中提供精确值。", "solution": "我们的目标是构造一个在 $[0,1]$ 上连续可微的函数 $f(x)$，使得对于节点 $x_j = j/8$ ($j=0, \\dots, 8$)，复合梯形法则的近似值比复合辛普森法则更精确。这意味着我们需要证明 $|I - T|  |I - S|$，其中 $I$ 是精确积分，$T$ 是梯形法则近似值，$S$ 是辛普森法则近似值。\n\n一个关键的洞察是，当一个函数的振荡频率与采样网格的频率有特定关系时，低阶方法可能会表现得比高阶方法更好。让我们提出一个候选函数：\n$$f(x) = \\cos(8\\pi x)$$\n这个函数在 $[0,1]$ 上是连续可微的（实际上是无限次可微的）。\n\n**1. 计算函数在节点上的值**\n网格间距为 $h=1/8$。在节点 $x_j = j/8$ 处，函数值为：\n$$f(x_j) = f\\left(\\frac{j}{8}\\right) = \\cos\\left(8\\pi \\frac{j}{8}\\right) = \\cos(j\\pi) = (-1)^j$$\n函数值的序列为 $\\{f_j\\}_{j=0}^8 = \\{1, -1, 1, -1, 1, -1, 1, -1, 1\\}$。\n\n**2. 计算精确积分**\n$$I = \\int_{0}^{1} \\cos(8\\pi x) \\,dx = \\left[ \\frac{\\sin(8\\pi x)}{8\\pi} \\right]_{0}^{1} = \\frac{\\sin(8\\pi) - \\sin(0)}{8\\pi} = 0$$\n\n**3. 计算复合梯形法则近似值 (T)**\n使用8个子区间 ($N=8$) 的复合梯形法则公式为：\n$$T = h \\left( \\frac{1}{2}f_0 + \\sum_{j=1}^{7} f_j + \\frac{1}{2}f_8 \\right)$$\n代入我们的值：\n$$T = \\frac{1}{8} \\left( \\frac{1}{2}(1) + (-1) + 1 + (-1) + 1 + (-1) + 1 + (-1) + \\frac{1}{2}(1) \\right)$$\n$$T = \\frac{1}{8} \\left( \\frac{1}{2} + (-1) + \\frac{1}{2} \\right) = \\frac{1}{8} (0) = 0$$\n\n**4. 计算复合辛普森法则近似值 (S)**\n使用8个子区间（4对）的复合辛普森法则公式为：\n$$S = \\frac{h}{3} \\left( f_0 + 4f_1 + 2f_2 + 4f_3 + 2f_4 + 4f_5 + 2f_6 + 4f_7 + f_8 \\right)$$\n代入我们的值：\n$$S = \\frac{1/8}{3} \\left( 1 + 4(-1) + 2(1) + 4(-1) + 2(1) + 4(-1) + 2(1) + 4(-1) + 1 \\right)$$\n$$S = \\frac{1}{24} \\left( 1 - 4 + 2 - 4 + 2 - 4 + 2 - 4 + 1 \\right)$$\n$$S = \\frac{1}{24} \\left( (1+2+2+2+1) + 4 \\times (-4) \\right) = \\frac{1}{24} (8 - 16) = \\frac{-8}{24} = -\\frac{1}{3}$$\n\n**5. 比较误差**\n梯形法则的绝对误差为：\n$$|E_T| = |I - T| = |0 - 0| = 0$$\n辛普森法则的绝对误差为：\n$$|E_S| = |I - S| = \\left|0 - \\left(-\\frac{1}{3}\\right)\\right| = \\frac{1}{3}$$\n显然，$0  \\frac{1}{3}$，因此 $|E_T|  |E_S|$。\n\n我们的函数 $f(x)=\\cos(8\\pi x)$ 满足所有条件。梯形法则是完全精确的，而辛普森法则产生了显著的误差。其原因是，我们选择的函数频率（4个完整周期在 $[0,1]$ 上）与采样率（$h=1/8$）之间存在一种特殊关系。梯形法之所以精确，是因为在每个子区间 $[x_j, x_{j+1}]$ 内，函数的曲线部分与连接两端点的弦所围成的区域关于子区间中点呈反对称，导致正负误差恰好抵消。然而，辛普森法则是通过二次多项式来插值三个点 $(x_{j}, f_{j}), (x_{j+1}, f_{j+1}), (x_{j+2}, f_{j+2})$。对于我们的函数，这三个点是 $(x_j, (-1)^j), (x_{j+1}, (-1)^{j+1}), (x_{j+2}, (-1)^{j+2})$，即 $(x_j, 1), (x_{j+1}, -1), (x_{j+2}, 1)$ 或 $(x_j, -1), (x_{j+1}, 1), (x_{j+2}, -1)$。插值抛物线严重偏离了真实的余弦曲线，导致了较大的积分误差。", "answer": "$$\\boxed{\\cos(8\\pi x)}$$", "id": "3284359"}]}