{"hands_on_practices": [{"introduction": "我们将从一个经典的几何优化问题入手，但会增加一些复杂性。标准的挑战是求固定体积下表面积最小的圆柱体，而这个练习 [@problem_id:3251810] 额外引入了一个关于其高与半径之比的非线性约束。这个附加条件使得问题更贴近实际工程设计中的多重限制，它将考验你建立和求解包含多个约束条件的拉格朗日系统的能力。", "problem": "一个闭合的直立圆柱体，其半径为 $r$，高为 $h$。其总表面积为 $S(r,h) = 2\\pi r h + 2\\pi r^{2}$，体积为 $V(r,h) = \\pi r^{2} h$。假设一项工程设计要求纵横比 $x = h/r$ 满足一个非线性约束，形式为 $x + \\frac{1}{x} = \\kappa$，其中 $\\kappa$ 是一个给定的常数。假设 $V > 0$, $\\kappa > 2$, 且 $r > 0$, $h > 0$，从而使约束条件可行且具有物理意义。\n\n从 $S(r,h)$ 和 $V(r,h)$ 的基本几何公式以及用于等式约束优化的拉格朗日乘数法出发，确定在两个等式约束 $V(r,h) = V$ 和 $x + \\frac{1}{x} = \\kappa$ 条件下，圆柱体可实现的最小总表面积 $S_{\\min}$。将您的最终答案表示为以 $V$ 和 $\\kappa$ 表示的闭式解析表达式。最终表达式无需进行数值舍入，也不应包含单位。", "solution": "我们首先陈述优化问题。我们希望最小化一个半径为 $r > 0$、高为 $h > 0$ 的圆柱体的表面积函数 $S(r,h) = 2\\pi r h + 2\\pi r^2$。此最小化问题受两个约束条件限制：\n1. 固定体积 $V(r,h) = \\pi r^2 h = V$，其中 $V>0$ 为常数。\n2. 纵横比 $x=h/r$ 上的约束，形式为 $x + \\frac{1}{x} = \\kappa$，其中 $\\kappa > 2$ 为常数。\n\n我们将约束条件形式化为设为零的函数。\n第一个约束是 $g_1(r,h) = \\pi r^2 h - V = 0$。\n第二个约束 $\\frac{h}{r} + \\frac{r}{h} = \\kappa$，可以通过乘以 $rh$（由于 $r>0, h>0$，故其非零）重写为 $h^2 + r^2 = \\kappa r h$。这给出了第二个约束函数 $g_2(r,h) = h^2 + r^2 - \\kappa r h = 0$。\n\n尽管我们可以建立一个包含两个拉格朗日乘子的完整系统，但更直接的解决方法是首先分析约束的性质。将 $g_2=0$ 的方程两边同除以 $r^2$（因为 $r>0$），我们得到：\n$$ (h/r)^2 + 1 - \\kappa (h/r) = 0 $$\n令纵横比为 $x = h/r$。那么 $x$ 必须是二次方程 $t^2 - \\kappa t + 1 = 0$ 的一个根。这些根由二次公式给出：\n$$ t = \\frac{\\kappa \\pm \\sqrt{\\kappa^2-4}}{2} $$\n由于 $\\kappa > 2$，两个根都是实数且为正。设根为 $x_1$ 和 $x_2$：\n$$ x_1 = \\frac{\\kappa + \\sqrt{\\kappa^2-4}}{2} \\quad \\text{和} \\quad x_2 = \\frac{\\kappa - \\sqrt{\\kappa^2-4}}{2} $$\n我们观察到 $x_1 > 1$ 且 $x_2 = 1/x_1$，因此 $0  x_2  1$。\n约束条件将圆柱体的几何形状固定为这两种可能的纵横比之一。对于每一种 $x$ 的选择，体积约束 $\\pi r^2 h = \\pi r^2 (xr) = \\pi x r^3 = V$ 唯一地确定了半径 $r$（从而也确定了高 $h$）。因此，问题简化为评估这两种可行几何形状的表面积，并选择较小的一个。\n\n表面积是 $S(r,h) = 2\\pi r^2 + 2\\pi rh = 2\\pi r^2(1+h/r) = 2\\pi r^2(1+x)$。\n使用 $r = (V/(\\pi x))^{1/3}$，我们将 $S$ 表示为 $x$ 的函数：\n$$ S(x) = 2\\pi \\left(\\frac{V}{\\pi x}\\right)^{2/3}(1+x) = 2\\pi \\frac{V^{2/3}}{\\pi^{2/3} x^{2/3}}(1+x) = 2\\pi^{1/3}V^{2/3} \\frac{1+x}{x^{2/3}} $$\n为找到最小表面积，我们必须比较 $S(x_1)$ 和 $S(x_2)$。这等同于比较函数 $f(x) = \\frac{1+x}{x^{2/3}}$ 在 $x_1$ 和 $x_2$ 处的值。\n$$ f(x_1) = \\frac{1+x_1}{x_1^{2/3}} $$\n$$ f(x_2) = f(1/x_1) = \\frac{1+1/x_1}{(1/x_1)^{2/3}} = \\frac{(x_1+1)/x_1}{x_1^{-2/3}} = \\frac{1+x_1}{x_1^{1-2/3}} = \\frac{1+x_1}{x_1^{1/3}} $$\n由于 $\\kappa2$, $x_1  1$。对于 $x_1  1$，我们有 $x_1^{2/3}  x_1^{1/3}$。由于这些项为正且位于分母中，这意味着 $\\frac{1}{x_1^{2/3}}  \\frac{1}{x_1^{1/3}}$。\n因此，$f(x_1)  f(x_2)$。\n最小表面积在较大的纵横比 $x_1$ 处取得。\n最小表面积 $S_{\\min}$ 的表达式为：\n$$ S_{\\min} = S(x_1) = 2\\pi^{1/3}V^{2/3} \\frac{1+x_1}{x_1^{2/3}} $$\n代入以 $\\kappa$ 表示的 $x_1$ 的表达式：\n$$ S_{\\min} = 2\\pi^{1/3}V^{2/3} \\frac{1 + \\frac{\\kappa + \\sqrt{\\kappa^2-4}}{2}}{\\left(\\frac{\\kappa + \\sqrt{\\kappa^2-4}}{2}\\right)^{2/3}} $$\n这就是以 $V$ 和 $\\kappa$ 表示的最小表面积的最终闭式解析表达式。", "answer": "$$\\boxed{2\\pi^{1/3}V^{2/3} \\frac{1 + \\frac{\\kappa + \\sqrt{\\kappa^2-4}}{2}}{\\left(\\frac{\\kappa + \\sqrt{\\kappa^2-4}}{2}\\right)^{2/3}}}$$", "id": "3251810"}, {"introduction": "许多优化问题源于将几何直觉转化为严谨的代数形式。在这个练习中 [@problem_id:3251729]，你的任务是找出能够内接于单位正方形的最大面积的轴对齐椭圆。这项挑战要求你应用处理不等式约束的卡鲁什-库恩-塔克（KKT）条件，它不仅能锻炼你建立不等式约束的能力，还能加深你对互补松弛性等核心概念的理解。", "problem": "考虑由半轴和中心参数化的轴对齐椭圆族，\n$$\n\\mathcal{E}(a,b,h,k) \\;=\\; \\left\\{ (x,y) \\in \\mathbb{R}^{2} \\;:\\; \\frac{(x-h)^{2}}{a^{2}} + \\frac{(y-k)^{2}}{b^{2}} \\le 1 \\right\\},\n$$\n其中 $a0$, $b0$, $h \\in \\mathbb{R}$ 且 $k \\in \\mathbb{R}$。令单位正方形为\n$$\n\\mathcal{S} \\;=\\; [0,1] \\times [0,1].\n$$\n在所有完全包含在 $\\mathcal{S}$ 中的此类椭圆中，确定可能的最大面积。仅从 $\\mathcal{E}(a,b,h,k) \\subset \\mathcal{S}$ 的定义包含要求和椭圆面积的几何公式出发，使用不等式约束的拉格朗日乘子法（Karush–Kuhn–Tucker 条件）将问题表述为约束优化问题。推导必要的最优性条件并求解它们以获得最大面积。请以精确表达式给出最终答案，不要四舍五入。", "solution": "问题要求解完全包含在单位正方形 $\\mathcal{S} = [0,1] \\times [0,1]$ 内的轴对齐椭圆的最大面积。\n\n首先，我们必须将其表述为一个约束优化问题。变量是椭圆 $\\mathcal{E}(a,b,h,k)$ 的半轴 $a$ 和 $b$，以及中心坐标 $(h,k)$。问题陈述指明 $a0$ 和 $b0$。\n\n需要最大化的目标函数是椭圆的面积，由公式 $A(a,b) = \\pi ab$ 给出。最大化 $\\pi ab$ 等价于最大化乘积 $ab$，因为 $\\pi$ 是一个正常数。设我们的目标函数为 $f(a,b,h,k) = ab$。\n\n接下来，我们必须将几何包含约束 $\\mathcal{E}(a,b,h,k) \\subset \\mathcal{S}$ 转化为一组代数不等式。椭圆由 $\\frac{(x-h)^2}{a^2} + \\frac{(y-k)^2}{b^2} \\le 1$ 定义。椭圆的水平范围由区间 $[h-a, h+a]$ 给出，其垂直范围由 $[k-b, k+b]$ 给出。为了使椭圆包含在单位正方形 $\\mathcal{S} = [0,1] \\times [0,1]$ 内，这些区间必须是 $[0,1]$ 的子集。\n\nx轴的包含条件是 $[h-a, h+a] \\subseteq [0,1]$，这产生两个不等式：\n1. $h-a \\ge 0$\n2. $h+a \\le 1$\n\ny轴的包含条件是 $[k-b, k+b] \\subseteq [0,1]$，这又产生两个不等式：\n3. $k-b \\ge 0$\n4. $k+b \\le 1$\n\n我们将使用Karush-Kuhn-Tucker (KKT) 条件来解决这个问题。标准形式是针对形如 $g_i(\\mathbf{x}) \\le 0$ 的约束的最小化问题。最大化 $ab$ 等价于最小化 $-ab$。约束可以写成：\n$c_1(a,h) = a-h \\le 0$\n$c_2(a,h) = a+h-1 \\le 0$\n$c_3(b,k) = b-k \\le 0$\n$c_4(b,k) = b+k-1 \\le 0$\n\n因此，优化问题是：\n最小化 $F(a,b,h,k) = -ab$\n约束条件为 $c_1, c_2, c_3, c_4 \\le 0$，以及隐式约束 $a0, b0$。\n\n拉格朗日函数是：\n$$ \\mathcal{L}(a,b,h,k, \\mu_1, \\mu_2, \\mu_3, \\mu_4) = -ab + \\mu_1(a-h) + \\mu_2(a+h-1) + \\mu_3(b-k) + \\mu_4(b+k-1) $$\n其中 $\\mu_1, \\mu_2, \\mu_3, \\mu_4$ 是拉格朗日乘子。\n\n最优解 $(a^*,b^*,h^*,k^*)$ 的KKT条件是：\n1.  **平稳性 (Stationarity)**：拉格朗日函数关于变量 $a,b,h,k$ 的梯度必须为零。\n    $$ \\frac{\\partial \\mathcal{L}}{\\partial a} = -b + \\mu_1 + \\mu_2 = 0 \\implies b = \\mu_1 + \\mu_2 $$\n    $$ \\frac{\\partial \\mathcal{L}}{\\partial b} = -a + \\mu_3 + \\mu_4 = 0 \\implies a = \\mu_3 + \\mu_4 $$\n    $$ \\frac{\\partial \\mathcal{L}}{\\partial h} = -\\mu_1 + \\mu_2 = 0 \\implies \\mu_1 = \\mu_2 $$\n    $$ \\frac{\\partial \\mathcal{L}}{\\partial k} = -\\mu_3 + \\mu_4 = 0 \\implies \\mu_3 = \\mu_4 $$\n\n2.  **原始可行性 (Primal Feasibility)**：必须满足约束条件。\n    $$ a-h \\le 0 $$\n    $$ a+h-1 \\le 0 $$\n    $$ b-k \\le 0 $$\n    $$ b+k-1 \\le 0 $$\n\n3.  **对偶可行性 (Dual Feasibility)**：不等式约束的拉格朗日乘子必须为非负。\n    $$ \\mu_1, \\mu_2, \\mu_3, \\mu_4 \\ge 0 $$\n\n4.  **互补松弛性 (Complementary Slackness)**：每个乘子与其对应约束的乘积必须为零。\n    $$ \\mu_1(a-h) = 0 $$\n    $$ \\mu_2(a+h-1) = 0 $$\n    $$ \\mu_3(b-k) = 0 $$\n    $$ \\mu_4(b+k-1) = 0 $$\n\n我们现在求解这个方程和不等式组。\n从平稳性条件，我们有 $\\mu_1 = \\mu_2$ 和 $\\mu_3 = \\mu_4$。将这些代入前两个平稳性方程，得到：\n$$ b = 2\\mu_1 $$\n$$ a = 2\\mu_3 $$\n\n我们寻求最大化面积，所以我们对 $a=0$ 或 $b=0$ 的平凡解不感兴趣，因为它产生的面积为 $0$。我们必须有 $a  0$ 和 $b  0$。\n如果 $a  0$，那么 $a = 2\\mu_3  0$，这意味着 $\\mu_3  0$。由于 $\\mu_3 = \\mu_4$，我们有 $\\mu_4  0$。\n如果 $b  0$，那么 $b = 2\\mu_1  0$，这意味着 $\\mu_1  0$。由于 $\\mu_1 = \\mu_2$，我们有 $\\mu_2  0$。\n因此，对于一个面积非零的解，所有的拉格朗日乘子都必须是严格正的：$\\mu_1, \\mu_2, \\mu_3, \\mu_4  0$。\n\n现在我们应用互补松弛性条件。由于所有乘子都非零，它们对应的约束函数必须等于零。这意味着所有四个不等式约束都必须是激活的（即，等式成立）：\n1.  $a-h = 0 \\implies a = h$\n2.  $a+h-1 = 0$\n3.  $b-k = 0 \\implies b = k$\n4.  $b+k-1 = 0$\n\n我们现在有一个关于四个变量 $a,b,h,k$ 的四元线性方程组。\n从第一对方程中，将 $h=a$ 代入 $a+h-1=0$：\n$$ a+a-1 = 0 \\implies 2a = 1 \\implies a = \\frac{1}{2} $$\n由于 $h=a$，我们有 $h = \\frac{1}{2}$。\n\n从第二对方程中，将 $k=b$ 代入 $b+k-1=0$：\n$$ b+b-1 = 0 \\implies 2b = 1 \\implies b = \\frac{1}{2} $$\n由于 $k=b$，我们有 $k = \\frac{1}{2}$。\n\n满足非零面积KKT条件的唯一解是 $(a,b,h,k) = (\\frac{1}{2}, \\frac{1}{2}, \\frac{1}{2}, \\frac{1}{2})$。这代表一个半径为 $\\frac{1}{2}$、中心在 $(\\frac{1}{2}, \\frac{1}{2})$ 的圆。\n我们来验证这个解。参数 $a=\\frac{1}{2}, b=\\frac{1}{2}$ 是正的。所有约束都以等式形式满足，因此原始可行性得到满足。乘子为 $b = 2\\mu_1 \\implies \\frac{1}{2} = 2\\mu_1 \\implies \\mu_1 = \\frac{1}{4}$，以及 $a = 2\\mu_3 \\implies \\frac{1}{2} = 2\\mu_3 \\implies \\mu_3 = \\frac{1}{4}$。因此，$\\mu_1=\\mu_2=\\mu_3=\\mu_4=\\frac{1}{4}$，它们都是非负的，满足对偶可行性。所有KKT条件都已满足。\n\n变量的可行域是凸的，但目标函数 $F=-ab$ 不是凸函数。然而，我们可以通过检查约束来论证全局最优性。不等式 $a-h \\le 0$ 和 $a+h-1 \\le 0$ 意味着 $a \\le h$ 和 $h \\le 1-a$。这要求 $a \\le 1-a$，简化为 $2a \\le 1$ 或 $a \\le \\frac{1}{2}$。类似地，关于 $b$ 和 $k$ 的不等式意味着 $b \\le \\frac{1}{2}$。由于我们希望在 $a0, b0$ 的条件下最大化 $ab$，并且函数 $ab$ 在这个定义域上对 $a$ 和 $b$ 是严格递增的，所以最大值必须在 $a$ 和 $b$ 可行域的上界处取得，即 $a=\\frac{1}{2}$ 和 $b=\\frac{1}{2}$。这证实了我们的KKT解确实是全局最大值。\n\n使用这些最优参数值获得的最大可能面积是：\n$$ A_{max} = \\pi a b = \\pi \\left(\\frac{1}{2}\\right)\\left(\\frac{1}{2}\\right) = \\frac{\\pi}{4} $$", "answer": "$$\\boxed{\\frac{\\pi}{4}}$$", "id": "3251729"}, {"introduction": "理论是算法的基石，而将理论付诸实践是掌握知识的关键一步。这个练习 [@problem_id:3251733] 提供了一个动手编码的机会，让你亲手实现求解带不等式约束的二次规划问题的核心逻辑。通过为一系列测试案例编写程序，你将以数值方式验证KKT理论的关键原则，如对偶可行性和互补松弛性，从而真正打通从抽象理论到计算实践的“最后一公里”。", "problem": "考虑在 $\\mathbb{R}^2$ 中带单个线性不等式约束的光滑、严格凸二次优化问题。设目标函数为 $f(x) = \\tfrac{1}{2} x^\\top Q x + c^\\top x$，约束为 $g(x) = a^\\top x - b \\le 0$，其中 $Q \\in \\mathbb{R}^{2 \\times 2}$ 是对称正定矩阵，$c \\in \\mathbb{R}^2$，$a \\in \\mathbb{R}^2$，$b \\in \\mathbb{R}$。对于带单个乘子 $\\lambda^\\star$ 的极小值点 $x^\\star$，Karush-Kuhn-Tucker (KKT) 条件断言了原始可行性、对偶可行性、平稳性和互补松弛性。您的任务是数值验证其中的两个条件，即对偶可行性和互补松弛性，不假设任何特殊情况的捷径。\n\n从光滑函数的无约束极小值点满足 $\\nabla f(x) = 0$ 这一基本定义出发，以及根据拉格朗日乘子法，激活的不等式约束变为带拉格朗日乘子的等式，设计一个程序，该程序：\n- 通过求解 $\\nabla f(x) = 0$ 来计算无约束极小值点 $x_{\\mathrm{un}}$。\n- 如果 $g(x_{\\mathrm{un}}) \\le 0$，则声明约束为非激活，并设置 $\\lambda = 0$，此时 $x^\\star = x_{\\mathrm{un}}$。\n- 如果 $g(x_{\\mathrm{un}})  0$，则强制约束为激活，并使用平稳性条件和激活约束方程联立求解 $x^\\star$ 和 $\\lambda$。\n\n在计算出 $(x^\\star, \\lambda)$ 后，数值检验：\n1. 对偶可行性：$\\lambda \\ge 0$。\n2. 互补松弛性：$\\lambda \\, g(x^\\star) = 0$。\n\n使用数值公差 $\\varepsilon = 10^{-9}$ 进行比较。也就是说，如果 $r \\ge -\\varepsilon$，则将实数 $r$ 视为非负数；如果 $|p| \\le \\varepsilon$，则将乘积 $p$ 视为零。\n\n实现一个程序，将此验证应用于以下由五个案例组成的测试套件，每个案例由 $(Q, c, a, b)$ 指定：\n- 案例 A (激活约束，一般可行性):\n  $$Q = \\begin{bmatrix}1  0\\\\ 0  1\\end{bmatrix}, \\quad c = \\begin{bmatrix}-2\\\\ -3\\end{bmatrix}, \\quad a = \\begin{bmatrix}1\\\\ 0\\end{bmatrix}, \\quad b = 1.$$\n- 案例 B (非激活约束，无约束最小值可行):\n  $$Q = \\begin{bmatrix}1  0\\\\ 0  1\\end{bmatrix}, \\quad c = \\begin{bmatrix}-0.5\\\\ -0.5\\end{bmatrix}, \\quad a = \\begin{bmatrix}1\\\\ 0\\end{bmatrix}, \\quad b = 1.$$\n- 案例 C (激活约束，非单位海森矩阵):\n  $$Q = \\begin{bmatrix}2  0\\\\ 0  1\\end{bmatrix}, \\quad c = \\begin{bmatrix}-1\\\\ 0\\end{bmatrix}, \\quad a = \\begin{bmatrix}1\\\\ 1\\end{bmatrix}, \\quad b = 0.2.$$\n- 案例 D (接近边界，乘子非常小):\n  $$Q = \\begin{bmatrix}1  0\\\\ 0  1\\end{bmatrix}, \\quad c = \\begin{bmatrix}-0.6\\\\ -0.6\\end{bmatrix}, \\quad a = \\begin{bmatrix}1\\\\ 1\\end{bmatrix}, \\quad b = 1.2 - 10^{-9}.$$\n- 案例 E (无约束最小值满足边界等式):\n  $$Q = \\begin{bmatrix}1  0\\\\ 0  1\\end{bmatrix}, \\quad c = \\begin{bmatrix}-1\\\\ 0\\end{bmatrix}, \\quad a = \\begin{bmatrix}1\\\\ 0\\end{bmatrix}, \\quad b = 1.$$\n\n对于每个案例，您的程序必须输出一对布尔值 $[\\text{dual\\_feasible}, \\text{comp\\_slack}]$，其中如果 $\\lambda \\ge 0$ (在公差范围内)，则 $\\text{dual\\_feasible}$ 为真；如果 $\\lambda \\, g(x^\\star) = 0$ (在公差范围内)，则 $\\text{comp\\_slack}$ 为真。最终输出必须将所有案例的结果聚合为单行：一个用方括号括起来的逗号分隔列表，其中每个元素本身就是一个包含两个布尔值的列表。例如，输出格式必须如下所示\n$$[\\,[\\text{bool},\\text{bool}],\\,[\\text{bool},\\text{bool}],\\,\\dots\\,]$$\n不带任何附加文本。\n\n角度或物理单位不适用。所有计算都是纯数学的，无量纲的。", "solution": "该问题要求对一系列二次规划问题，数值验证其对偶可行性和互补松弛性 Karush-Kuhn-Tucker (KKT) 条件。每个问题都涉及在单个线性不等式约束 $g(x) \\le 0$ 下，最小化一个严格凸二次目标函数 $f(x)$。函数定义如下：\n$$\nf(x) = \\frac{1}{2} x^\\top Q x + c^\\top x\n$$\n$$\ng(x) = a^\\top x - b \\le 0\n$$\n其中 $x, c, a \\in \\mathbb{R}^2$，$b \\in \\mathbb{R}$，且 $Q \\in \\mathbb{R}^{2 \\times 2}$ 是一个对称正定矩阵。\n\n求解方法遵循解决此类问题的标准方法，即首先确定在最优解处约束是否为激活状态。\n\n首先，我们计算 $f(x)$ 的无约束极小值点，记为 $x_{\\mathrm{un}}$。该点通过将 $f(x)$ 的梯度设为零来找到。梯度为：\n$$\n\\nabla f(x) = Qx + c\n$$\n令 $\\nabla f(x) = 0$ 得 $Qx + c = 0$。由于 $Q$ 是对称正定矩阵，因此它是可逆的。所以，唯一的无约束极小值点是：\n$$\nx_{\\mathrm{un}} = -Q^{-1}c\n$$\n\n接下来，我们在无约束极小值点 $x_{\\mathrm{un}}$ 处评估约束函数 $g(x)$。这决定了无约束解是否可行。我们使用提供的数值公差 $\\varepsilon = 10^{-9}$ 来处理浮点数比较。\n\n情况 1：约束为非激活或在边界上满足 ($g(x_{\\mathrm{un}}) \\le \\varepsilon$)。\n如果无约束极小值点位于可行域内部或边界上，则它就是约束问题的最优解。\n$$\nx^\\star = x_{\\mathrm{un}}\n$$\n在这种情况下，与不等式约束相关联的拉格朗日乘子 $\\lambda$ 为零。\n$$\n\\lambda = 0\n$$\n\n情况 2：约束为激活 ($g(x_{\\mathrm{un}})  \\varepsilon$)。\n如果无约束极小值点在可行域之外，则约束问题的解必须位于可行域的边界上，意味着约束是激活的：$g(x^\\star) = 0$。解 $(x^\\star, \\lambda)$ 是通过求解关于平稳性和激活约束的 KKT 方程组来找到的：\n1. 平稳性：$\\nabla f(x^\\star) + \\lambda \\nabla g(x^\\star) = 0$\n2. 激活约束：$g(x^\\star) = 0$\n\n约束的梯度是 $\\nabla g(x) = a$。将梯度代入平稳性条件，得到：\n$$\nQx^\\star + c + \\lambda a = 0\n$$\n由此，我们可以用 $\\lambda$ 来表示 $x^\\star$：\n$$\nx^\\star = -Q^{-1}(c + \\lambda a) = -Q^{-1}c - \\lambda Q^{-1}a = x_{\\mathrm{un}} - \\lambda Q^{-1}a\n$$\n我们将 $x^\\star$ 的这个表达式代入激活约束方程 $a^\\top x^\\star - b = 0$：\n$$\na^\\top (x_{\\mathrm{un}} - \\lambda Q^{-1}a) - b = 0\n$$\n$$\na^\\top x_{\\mathrm{un}} - b = \\lambda (a^\\top Q^{-1} a)\n$$\n求解 $\\lambda$，我们得到：\n$$\n\\lambda = \\frac{a^\\top x_{\\mathrm{un}} - b}{a^\\top Q^{-1} a}\n$$\n注意，由于我们处于激活情况，分子 $a^\\top x_{\\mathrm{un}} - b = g(x_{\\mathrm{un}})$ 是正的。分母 $a^\\top Q^{-1} a$ 也是正的，因为 $Q$ 以及因此 $Q^{-1}$ 是正定的且 $a \\neq 0$。因此，$\\lambda$ 将是正的。\n\n在为每个案例计算出解对 $(x^\\star, \\lambda)$ 后，我们使用公差 $\\varepsilon = 10^{-9}$ 执行两个指定的数值检验。\n1.  对偶可行性：$\\lambda \\ge 0$。检验条件为 $\\lambda \\ge -\\varepsilon$。\n2.  互补松弛性：$\\lambda g(x^\\star) = 0$。检验条件为 $|\\lambda g(x^\\star)| \\le \\varepsilon$。注意 $g(x^\\star) = a^\\top x^\\star - b$。\n\n将此程序应用于所提供的五个测试案例中的每一个。每个案例的两个检验结果，表示为一对布尔值，然后被聚合成一个最终列表。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves a series of quadratic optimization problems with a single linear inequality constraint\n    and verifies the KKT conditions of dual feasibility and complementary slackness.\n    \"\"\"\n    epsilon = 1e-9\n\n    test_cases = [\n        # Case A: active constraint\n        {'Q': np.array([[1.0, 0.0], [0.0, 1.0]]), 'c': np.array([-2.0, -3.0]), 'a': np.array([1.0, 0.0]), 'b': 1.0},\n        # Case B: inactive constraint\n        {'Q': np.array([[1.0, 0.0], [0.0, 1.0]]), 'c': np.array([-0.5, -0.5]), 'a': np.array([1.0, 0.0]), 'b': 1.0},\n        # Case C: active constraint, non-identity Hessian\n        {'Q': np.array([[2.0, 0.0], [0.0, 1.0]]), 'c': np.array([-1.0, 0.0]), 'a': np.array([1.0, 1.0]), 'b': 0.2},\n        # Case D: near-boundary case\n        {'Q': np.array([[1.0, 0.0], [0.0, 1.0]]), 'c': np.array([-0.6, -0.6]), 'a': np.array([1.0, 1.0]), 'b': 1.2 - 1e-9},\n        # Case E: boundary equality satisfied by unconstrained minimum\n        {'Q': np.array([[1.0, 0.0], [0.0, 1.0]]), 'c': np.array([-1.0, 0.0]), 'a': np.array([1.0, 0.0]), 'b': 1.0},\n    ]\n\n    results = []\n\n    for case in test_cases:\n        Q, c, a, b = case['Q'], case['c'], case['a'], case['b']\n\n        # Step 1: Compute the unconstrained minimizer x_un by solving Qx + c = 0\n        Q_inv = np.linalg.inv(Q)\n        x_un = -Q_inv @ c\n\n        # Step 2: Evaluate the constraint at the unconstrained minimizer\n        g_x_un = a.T @ x_un - b\n\n        # Step 3: Determine if the constraint is active and find (x*, lambda)\n        # We check against epsilon to handle floating-point arithmetic.\n        # If g(x_un) is a very small positive number less than epsilon, we treat it as 0,\n        # meaning the unconstrained minimum is on the boundary and thus feasible.\n        if g_x_un = epsilon:\n            # Case 1: Constraint is inactive (or on the boundary).\n            # The unconstrained minimizer is the solution.\n            x_star = x_un\n            lambda_val = 0.0\n        else:\n            # Case 2: Constraint is active.\n            # The solution lies on the constraint boundary g(x*) = 0.\n            # Solve for lambda from the KKT system.\n            lambda_numerator = g_x_un\n            lambda_denominator = a.T @ Q_inv @ a\n            lambda_val = lambda_numerator / lambda_denominator\n            \n            # Compute the optimal x* using lambda.\n            x_star = x_un - lambda_val * (Q_inv @ a)\n\n        # Step 4: Numerically verify dual feasibility and complementary slackness\n        \n        # 1. Dual feasibility: lambda >= 0\n        dual_feasible = lambda_val >= -epsilon\n\n        # 2. Complementary slackness: lambda * g(x*) = 0\n        g_x_star = a.T @ x_star - b\n        comp_slack_product = lambda_val * g_x_star\n        comp_slack = abs(comp_slack_product) = epsilon\n\n        results.append([dual_feasible, comp_slack])\n\n    # Format the final output string as a list of lists of booleans,\n    # e.g., [[true,true],[true,true],...]\n    str_results = []\n    for res_pair in results:\n        str_results.append(f\"[{str(res_pair[0]).lower()},{str(res_pair[1]).lower()}]\")\n    print(f\"[{','.join(str_results)}]\")\n\nsolve()\n```", "id": "3251733"}]}