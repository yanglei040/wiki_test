## 引言
在数值线性代数的广阔工具箱中，吉文斯旋转 (Givens Rotations) 占据着一个独特而重要的位置。与[豪斯霍尔德变换](@entry_id:168808)等一次性作用于整个向量列的方法不同，吉文斯旋转提供了一种如同外科手术般精准的手段，它通过在特定平面内进行旋转，选择性地操作向量或矩阵中的个别元素。这种精细的控制能力解决了在许多复杂计算任务中，需要逐步、稳定地改造矩阵结构（例如，引入零元素）而不过度扰动其整体特性的核心问题。从求解特殊结构的线性系统到迭代计算矩阵的[特征值](@entry_id:154894)，吉文斯旋转都是不可或缺的关键技术。

本文旨在带领读者全面探索吉文斯旋转的世界。我们将从以下三个方面展开：
- 在 **“原理与机制”** 一章中，我们将深入探讨吉文斯旋转的几何本质，揭示其作为[正交变换](@entry_id:155650)的内在属性，并详细阐述其选择性置零的核心机制。我们还将讨论其在高维空间中的推广以及稳健实现的关键技术。
- 接下来，在 **“应用与跨学科联系”** 一章中，我们将展示吉文斯旋转如何在QR分解、[特征值计算](@entry_id:145559)等核心算法中发挥作用，并将其视野扩展到控制理论、信号处理和机器学习等前沿领域，揭示其强大的跨学科应用价值。
- 最后，通过 **“动手实践”** 部分，你将有机会通过具体的编程练习来巩固所学知识，将理论应用于解决实际问题。

通过本次学习，你将不仅掌握吉文斯旋转的计算方法，更能深刻理解其在现代科学与工程计算中的重要地位和灵活应用。

## 原理与机制

在数值线性代数领域，**吉文斯旋转 (Givens Rotations)** 是一种基本而强大的工具。与一次性作用于整列向量的[豪斯霍尔德变换](@entry_id:168808)（Householder transformation）不同，吉文斯旋转是一种平面旋转，它以极高的精度和选择性对向量或矩阵中的特定元素进行操作。这种精細的控制能力使其在求解特定结构的线性系统、矩阵的QR分解以及[特征值计算](@entry_id:145559)等算法中不可或缺。本章将深入探讨吉文斯旋转的基本原理、核心机制及其在实际应用中的关键性质。

### 吉文斯旋转的几何本质

从根本上说，吉文斯旋转是在一个由两个坐标轴张成的二维[子空间](@entry_id:150286)（即一个平面）内进行的旋转。为了理解其性质，我们首先考虑最简单的二维情况。一个在二维平面中将向量逆时针旋转角度 $\theta$ 的标准[旋转矩阵](@entry_id:140302) $R(\theta)$ 形式如下：

$R(\theta) = \begin{pmatrix} \cos\theta  -\sin\theta \\ \sin\theta  \cos\theta \end{pmatrix}$

吉文斯旋转矩阵是这种标准[旋转矩阵](@entry_id:140302)的一般化和应用。一个关键的特性是，无论旋转角度为何，[旋转变换](@entry_id:200017)都保持了向量的几何属性，如长度和向量间的夹角。执行这种“纯旋转”而不引入任何缩放或剪切形变的变换，其对应的矩阵必须是**[正交矩阵](@entry_id:169220) (orthogonal matrix)**。

一个方阵 $Q$ 被称为正交矩阵，如果其转置等于其逆，即 $Q^T Q = I$，其中 $I$ 是单位矩阵。这一条件等价于要求矩阵的列向量构成一个[标准正交集](@entry_id:155086)（即它们两两正交且长度为1）。例如，考虑一个形似吉文斯旋转的 $3 \times 3$ 矩阵，我们需要确定参数 $k$ 的值以使其成为一个合法的正交[旋转矩阵](@entry_id:140302) [@problem_id:2176491]：

$R(k) = \begin{pmatrix} \frac{3}{5}  0  \frac{4}{5} \\ 0  1  0 \\ -\frac{4}{5}  0  k \end{pmatrix}$

为了使 $R(k)$ 正交，其列向量必须是标准正交的。我们检查第一列和第三列的[点积](@entry_id:149019)，它必须为零：
$(\frac{3}{5})(\frac{4}{5}) + (0)(0) + (-\frac{4}{5})(k) = \frac{12}{25} - \frac{4}{5}k = 0$
解得 $k = \frac{3}{5}$。同时，我们还需验证第三列的范数为1：
$\|c_3\|^2 = (\frac{4}{5})^2 + 0^2 + k^2 = \frac{16}{25} + (\frac{3}{5})^2 = \frac{16}{25} + \frac{9}{25} = 1$
该条件也得到满足。因此，当且仅当 $k=\frac{3}{5}$ 时，该矩阵是一个[正交矩阵](@entry_id:169220)，代表了一次在第一和第三坐标轴张成的平面中的旋转。

正交性最重要的推论之一是它**保持向量的[欧几里得范数](@entry_id:172687) (Euclidean norm)**。也就是说，对于任意向量 $x$ 和任意正交矩阵 $Q$，变换后向量的长度不变，即 $\|Qx\|_2 = \|x\|_2$。我们可以通过一个二维吉文斯矩阵 $G$ 来直接验证这一点 [@problem_id:2176533]。令 $G = \begin{pmatrix} c  -s \\ s  c \end{pmatrix}$，其中 $c^2 + s^2 = 1$。对于任意向量 $x = \begin{pmatrix} x_1 \\ x_2 \end{pmatrix}$，变换后的向量为：

$Gx = \begin{pmatrix} cx_1 - sx_2 \\ sx_1 + cx_2 \end{pmatrix}$

计算其范数的平方：
$\|Gx\|_2^2 = (cx_1 - sx_2)^2 + (sx_1 + cx_2)^2$
$= (c^2x_1^2 - 2csx_1x_2 + s^2x_2^2) + (s^2x_1^2 + 2csx_1x_2 + c^2x_2^2)$
$= (c^2+s^2)x_1^2 + (s^2+c^2)x_2^2$

由于 $c^2+s^2=1$，我们得到：
$\|Gx\|_2^2 = x_1^2 + x_2^2 = \|x\|_2^2$

这一性质是吉文斯旋转在数值算法中保持数值稳定性的基石，因为它确保了在计算过程中误差不会因为变换本身而被放大。

### 核心机制：选择性向量置零

吉文斯旋转最常见的应用是精确地将向量或矩阵中的某个特定元素置为零。这与前面描述的标准旋转略有不同，它采用了稍微变化的形式来实现这一目标。假设我们有一个二维向量 $v = \begin{pmatrix} a \\ b \end{pmatrix}$，我们希望找到一个[旋转矩阵](@entry_id:140302) $G$，使得变换后的向量 $v' = Gv$ 的第二个分量为零。

为此，我们定义吉文斯[旋转矩阵](@entry_id:140302)为：
$G = \begin{pmatrix} c  s \\ -s  c \end{pmatrix}$
其中 $c$ 和 $s$ 同样满足 $c^2 + s^2 = 1$。请注意这里 $s$ 和 $-s$ 的位置，这是为了方便实现置零操作而采用的惯例。应用此变换：

$v' = Gv = \begin{pmatrix} c  s \\ -s  c \end{pmatrix} \begin{pmatrix} a \\ b \end{pmatrix} = \begin{pmatrix} ca + sb \\ -sa + cb \end{pmatrix}$

为了使第二个分量为零，我们必须满足：
$-sa + cb = 0 \implies cb = sa$

结合约束条件 $c^2 + s^2 = 1$ 以及假设 $a, b$ 不全为零，我们可以解出 $c$ 和 $s$ 的值。设 $r = \sqrt{a^2 + b^2}$，这是一个正数。一组满足条件的解是 [@problem_id:2176469] [@problem_id:2176507]：

$c = \frac{a}{r} = \frac{a}{\sqrt{a^2+b^2}}$
$s = \frac{b}{r} = \frac{b}{\sqrt{a^2+b^2}}$

通过这个选择，我们不仅确保了第二个分量为零：
$v'_2 = -sa + cb = -\frac{b}{r}a + \frac{a}{r}b = 0$

而且，新的第一个分量变为：
$v'_1 = ca + sb = \frac{a}{r}a + \frac{b}{r}b = \frac{a^2+b^2}{r} = \frac{r^2}{r} = r$

因此，变换的结果是将向量 $\begin{pmatrix} a \\ b \end{pmatrix}$ 旋转为 $\begin{pmatrix} r \\ 0 \end{pmatrix}$，其中 $r = \sqrt{a^2+b^2}$。这个过程优雅地将两个分量的“能量”或范数集中到了一个分量上，同时保持了子向量的整体范数。

### 推广至[N维空间](@entry_id:152297)

吉文斯旋转的强大之处在于它可以轻松地从二维推广到任意[N维空间](@entry_id:152297)，并用于操作任意两个选定的分量，而保持其他所有分量不变。一个作用于第 $i$ 和第 $j$ 个分量（假设 $i  j$）的N维吉文斯旋转矩阵，记为 $G(i, j, c, s)$，是一个几乎与 $n \times n$ [单位矩阵](@entry_id:156724)完全相同的矩阵，仅在四处位置有别：

$G_{ii} = c$
$G_{jj} = c$
$G_{ij} = s$
$G_{ji} = -s$

所有其他的对角[线元](@entry_id:196833)素为1，非对角线元素为0。这种结构确保了当 $G(i, j, c, s)$ 左乘一个向量 $x$ 时，只有 $x_i$ 和 $x_j$ 分量会发生改变 [@problem_id:1365893]。

例如，假设我们要将一个4维向量 $x = [5, 3, 7, 4]^T$ 的第4个分量置零，利用其第2个分量。这意味着旋转发生在由[基向量](@entry_id:199546) $e_2$ 和 $e_4$ 张成的平面上。我们关注的分量是 $x_2=3$ 和 $x_4=4$ [@problem_id:2176492]。

根据之前的公式，我们计算 $c$ 和 $s$：
$r = \sqrt{x_2^2 + x_4^2} = \sqrt{3^2 + 4^2} = 5$
$c = \frac{x_2}{r} = \frac{3}{5}$
$s = \frac{x_4}{r} = \frac{4}{5}$

将这些值嵌入一个 $4 \times 4$ 的单位矩阵的第2和第4行/列，我们得到吉文斯矩阵 $G(2, 4, c, s)$：

$G = \begin{pmatrix}
1  0  0  0 \\
0  c  0  s \\
0  0  1  0 \\
0  -s  0  c
\end{pmatrix}
= \begin{pmatrix}
1  0  0  0 \\
0  \frac{3}{5}  0  \frac{4}{5} \\
0  0  1  0 \\
0  -\frac{4}{5}  0  \frac{3}{5}
\end{pmatrix}$

将此矩阵应用于原向量 $x$，我们得到新的向量 $y=Gx$：
$y_1 = x_1 = 5$
$y_2 = c x_2 + s x_4 = (\frac{3}{5})(3) + (\frac{4}{5})(4) = \frac{9+16}{5} = 5$
$y_3 = x_3 = 7$
$y_4 = -s x_2 + c x_4 = -(\frac{4}{5})(3) + (\frac{3}{5})(4) = \frac{-12+12}{5} = 0$

变换后的向量为 $y = [5, 5, 7, 0]^T$。正如预期，只有第2和第4个分量被修改，且第4个分量成功置零。

### [矩阵变换](@entry_id:156789)：行与列操作

当吉文斯旋转应用于矩阵时，其效果取决于它是从左侧相乘还是从右侧相乘。

**左乘：行操作**

当一个 $m \times m$ 的吉文斯矩阵 $G(i, j, c, s)$ 左乘一个 $m \times n$ 的矩阵 $A$ 时，即计算 $A' = GA$，其效果是只对 $A$ 的第 $i$ 行和第 $j$ 行进行操作。新的第 $i$ 行和第 $j$ 行是旧的第 $i$ 行和第 $j$ 行的线性组合 [@problem_id:2176471]：

$A'_{i,:} = c A_{i,:} + s A_{j,:}$
$A'_{j,:} = -s A_{i,:} + c A_{j,:}$

矩阵 $A$ 的所有其他行保持不变。这一性质是使用吉文斯旋转进行[QR分解](@entry_id:139154)的核心。通过一系列精心选择的吉文斯旋转，我们可以逐个将矩阵主对角线以下的元素置为零，最终得到一个上三角矩阵 $R$。

**右乘：列操作**

相应地，当一个 $n \times n$ 的吉文斯矩阵 $G(i, j, c, s)$ 右乘一个 $m \times n$ 的矩阵 $A$ 时，即计算 $A' = AG$，其效果是对 $A$ 的列进行操作。在这种情况下，只有第 $i$ 列和第 $j$ 列被修改，而所有其他列保持不变 [@problem_id:2176513]。新的列是旧[列的线性组合](@entry_id:150240)：

$A'_{:,i} = c A_{:,i} - s A_{:,j}$
$A'_{:,j} = s A_{:,i} + c A_{:,j}$

注意，这里的变换形式与行变换略有不同，这取决于 $G$ 矩阵中 $\pm s$ 的具体位置定义。如果 $G_{ij}=-s$ 且 $G_{ji}=s$，则列变换将是 $A'_{:,i} = c A_{:,i} + s A_{:,j}$ 和 $A'_{:,j} = -s A_{:,i} + c A_{:,j}$。重要的是理解右乘影响列，左乘影响行。例如，对于一个 $3 \times 4$ 矩阵 $A$，用 $G(2,4,c,s)$ 右乘，其中 $c=\frac{12}{13}, s=\frac{5}{13}$，新矩阵 $A'$ 的第2行第4列的元素 $A'_{2,4}$ 将会是：

$A'_{2,4} = s A_{2,2} + c A_{2,4}$

如果 $A_{2,2}=1.4$ 且 $A_{2,4}=4.7$，则 $A'_{2,4} = (\frac{5}{13})(1.4) + (\frac{12}{13})(4.7) \approx 4.877$。

### 高级性质与实现细节

**交换律**

在应用一系列吉文斯旋转时，操作的顺序可能至关重要。两个吉文斯旋转 $G_1 = G(i, j, \theta_1)$ 和 $G_2 = G(k, l, \theta_2)$ 是否可交换（即 $G_1 G_2 = G_2 G_1$）取决于它们作用的平面。设 $I = \{i, j\}$ 和 $K = \{k, l\}$ 为定义旋转平面的索引集。
- 如果旋转平面完全相同 ($I=K$)，则旋转是可交换的，因为二维旋转本身是可交换的。
- 如果旋转平面完全不相交 ($I \cap K = \emptyset$)，旋转也是可交换的，因为它们作用于互不相关的[子空间](@entry_id:150286)。
- 然而，如果旋转平面共享一个坐标轴（$|I \cap K| = 1$），那么这两个旋转通常是**不可交换**的 [@problem_id:2176470]。

这个性质对于设计高效且可并行的算法具有重要意义。在某些算法中，不相交的吉文斯旋转可以同时进行，从而大大提高计算速度。

**[数值稳定性](@entry_id:146550)与稳健实现**

尽管吉文斯旋转在理论上是数值稳定的，但在有限精度[浮点运算](@entry_id:749454)的实践中，计算参数 $c$ 和 $s$ 的标准公式 $c = a/r, s = b/r$（其中 $r = \sqrt{a^2+b^2}$）可能会遇到问题。如果 $a$ 或 $b$ 的值非常大，计算 $a^2$ 或 $b^2$ 可能会导致**上溢 (overflow)**；如果它们非常小，则可能导致**[下溢](@entry_id:635171) (underflow)**，损失精度。

考虑一个情景，其中 $v_a = 3.6 \times 10^{40}$ 和 $v_b = 4.8 \times 10^{40}$，而计算机的溢出阈值为 $1.0 \times 10^{80}$ [@problem_id:2176509]。直接计算 $v_a^2 = 1.296 \times 10^{81}$ 将会立即导致[上溢](@entry_id:172355)，使计算失败。

为了避免这种情况，我们可以采用一种更稳健的计算方法。其思想是先从 $a$ 和 $b$ 中提出较大者，从而处理一个比值，避免计算大数的平方。
假设 $|b| \le |a|$，我们可以重写 $r$：
$r = \sqrt{a^2+b^2} = |a|\sqrt{1 + (b/a)^2}$
令 $t = b/a$，则 $|t| \le 1$。参数 $c$ 和 $s$ 可以计算为：
$c = \frac{a}{r} = \frac{a}{|a|\sqrt{1+t^2}} = \frac{\text{sign}(a)}{\sqrt{1+t^2}}$
$s = \frac{b}{r} = \frac{b}{|a|\sqrt{1+t^2}} = \frac{t \cdot a}{|a|\sqrt{1+t^2}} = t \cdot c$

一个完整的稳健算法如下：
1. 如果 $b = 0$，则 $c=1, s=0$。
2. 如果 $a = 0$，则 $c=0, s=1$。
3. 如果 $|b|  |a|$，令 $t = a/b$，则 $s = \frac{\text{sign}(b)}{\sqrt{1+t^2}}$，$c = s \cdot t$。
4. 如果 $|a| \ge |b|$，令 $t = b/a$，则 $c = \frac{\text{sign}(a)}{\sqrt{1+t^2}}$，$s = c \cdot t$。

回到之前的例子 $v_a = 3.6 \times 10^{40}$ 和 $v_b = 4.8 \times 10^{40}$。这里 $|v_b|  |v_a|$，我们计算：
$t = v_a / v_b = (3.6 \times 10^{40}) / (4.8 \times 10^{40}) = 0.75$
$s = \frac{1}{\sqrt{1 + t^2}} = \frac{1}{\sqrt{1 + 0.75^2}} = \frac{1}{\sqrt{1.5625}} = \frac{1}{1.25} = 0.8$
$c = s \cdot t = 0.8 \cdot 0.75 = 0.6$

我们得到了精确的 $c=0.6$ 和 $s=0.8$，而整个计算过程中没有任何中间值接近溢出边界。这种稳健的实现对于编写可靠的科学计算软件至关重要。