{"hands_on_practices": [{"introduction": "理解和计算插值多项式的一个有效方法是逐点增量构建。本练习将引导你推导当向现有插值问题中添加一个新数据点时，如何递归地更新多项式。这个推导过程揭示了牛顿型插值多项式背后的核心结构和思想。", "problem": "设 $f:\\mathbb{R}\\to\\mathbb{R}$ 是一个函数，在 $n+1$ 个两两互异的节点 $x_{0},x_{1},\\dots,x_{n}$ 上进行采样，并令 $p_{n}(x)$ 表示次数至多为 $n$ 的唯一多项式，满足对于所有 $k\\in\\{0,1,\\dots,n\\}$ 都有 $p_{n}(x_{k})=f(x_{k})$。现增加一个新的、与之前节点都不同的节点 $x_{n+1}\\notin\\{x_{0},x_{1},\\dots,x_{n}\\}$ 及其采样值 $f(x_{n+1})$，且 $p_{n+1}(x)$ 表示在扩大的节点集 $\\{x_{0},x_{1},\\dots,x_{n},x_{n+1}\\}$ 上对 $f$ 进行插值的、次数至多为 $n+1$ 的唯一多项式。\n\n从多项式插值的核心定义（不同节点下的存在性和唯一性）以及代数中的基本事实（因式定理，即如果一个多项式在 $a$ 处有根，则 $(x-a)$ 整除该多项式）出发，推导一个简单的、显式的递推更新公式，该公式仅用 $p_{n}(x)$、节点 $x_{0},\\dots,x_{n},x_{n+1}$ 以及量 $f(x_{n+1})$ 和 $p_{n}(x_{n+1})$ 来表示 $p_{n+1}(x)$。\n\n你的最终答案必须是关于 $p_{n+1}(x)$ 的一个单一闭式解析表达式，用指定的量来书写。最终答案中不要包含任何推导过程或辅助定义。", "solution": "问题陈述经核实具有科学依据、提法恰当且客观。这是一个数值分析中的标准问题，涉及插值多项式的递推构造，通常会导出 Newton 形式。推导将基于给定的条件和基本的代数原理进行。\n\n设 $p_{n}(x)$ 是在 $n+1$ 个互异节点 $x_{0}, x_{1}, \\dots, x_{n}$ 上对函数 $f(x)$ 进行插值的、次数至多为 $n$ 的唯一多项式。这意味着对于 $k \\in \\{0, 1, \\dots, n\\}$，有 $p_{n}(x_{k}) = f(x_{k})$。\n设 $p_{n+1}(x)$ 是在 $n+2$ 个互异节点 $x_{0}, x_{1}, \\dots, x_{n}, x_{n+1}$ 上对 $f(x)$ 进行插值的、次数至多为 $n+1$ 的唯一多项式。这意味着对于 $k \\in \\{0, 1, \\dots, n+1\\}$，有 $p_{n+1}(x_{k}) = f(x_{k})$。\n\n我们的任务是找到一个用 $p_{n}(x)$ 表示 $p_{n+1}(x)$ 的表达式。考虑定义如下的差分多项式 $q(x)$：\n$$q(x) = p_{n+1}(x) - p_{n}(x)$$\n\n$p_{n+1}(x)$ 的次数至多为 $n+1$，$p_{n}(x)$ 的次数至多为 $n$。因此，它们的差 $q(x)$ 的次数至多为 $n+1$。\n\n让我们在原始插值节点 $x_{k}$（其中 $k \\in \\{0, 1, \\dots, n\\}$）处计算 $q(x)$ 的值。\n根据插值多项式的定义，我们有：\n$p_{n+1}(x_{k}) = f(x_{k})$ 对于 $k \\in \\{0, 1, \\dots, n\\}$\n$p_{n}(x_{k}) = f(x_{k})$ 对于 $k \\in \\{0, 1, \\dots, n\\}$\n\n因此，对于每个 $k \\in \\{0, 1, \\dots, n\\}$，$q(x_k)$ 的值为：\n$$q(x_{k}) = p_{n+1}(x_{k}) - p_{n}(x_{k}) = f(x_{k}) - f(x_{k}) = 0$$\n\n这表明多项式 $q(x)$ 有 $n+1$ 个不同的根：$x_{0}, x_{1}, \\dots, x_{n}$。\n根据代数中的因式定理，如果一个多项式在 $a$ 处有根，则 $(x-a)$ 必是该多项式的一个因式。由于 $q(x)$ 在 $n+1$ 个互异节点 $x_0, \\dots, x_n$ 处都有根，它必然能被相应因式的乘积整除。\n因此，$q(x)$ 可以写成以下形式：\n$$q(x) = C \\cdot (x-x_{0})(x-x_{1})\\cdots(x-x_{n})$$\n其中 $C$ 是一个常数。我们可以更紧凑地表示为：\n$$q(x) = C \\prod_{k=0}^{n} (x-x_{k})$$\n\n现在，我们可以将 $q(x)$ 的这种形式代回其定义中，以表示 $p_{n+1}(x)$：\n$$p_{n+1}(x) = p_{n}(x) + q(x) = p_{n}(x) + C \\prod_{k=0}^{n} (x-x_{k})$$\n\n为了确定常数 $C$，我们使用剩下的一个信息：$p_{n+1}(x)$ 在新节点 $x_{n+1}$ 处的插值条件。我们知道 $p_{n+1}(x_{n+1}) = f(x_{n+1})$。\n让我们在 $x = x_{n+1}$ 处计算 $p_{n+1}(x)$ 的表达式：\n$$p_{n+1}(x_{n+1}) = p_{n}(x_{n+1}) + C \\prod_{k=0}^{n} (x_{n+1}-x_{k})$$\n代入 $p_{n+1}(x_{n+1}) = f(x_{n+1})$，我们得到：\n$$f(x_{n+1}) = p_{n}(x_{n+1}) + C \\prod_{k=0}^{n} (x_{n+1}-x_{k})$$\n\n我们现在可以解出常数 $C$。整理方程得到：\n$$f(x_{n+1}) - p_{n}(x_{n+1}) = C \\prod_{k=0}^{n} (x_{n+1}-x_{k})$$\n由于节点 $x_{n+1}$ 与之前的所有节点 $x_{0}, \\dots, x_{n}$ 都不同，每一项 $(x_{n+1}-x_{k})$ 都不为零。因此，它们的乘积也不为零，我们可以用它来除，从而分离出 $C$：\n$$C = \\frac{f(x_{n+1}) - p_{n}(x_{n+1})}{\\prod_{k=0}^{n} (x_{n+1}-x_{k})}$$\n这个常数 $C$ 正是 $f$ 关于节点 $x_0, \\dots, x_{n+1}$ 的均差，记作 $f[x_{0}, \\dots, x_{n+1}]$。\n\n最后，我们将这个 $C$ 的表达式代回到我们的 $p_{n+1}(x)$ 递推公式中：\n$$p_{n+1}(x) = p_{n}(x) + \\left( \\frac{f(x_{n+1}) - p_{n}(x_{n+1})}{\\prod_{k=0}^{n} (x_{n+1}-x_{k})} \\right) \\prod_{k=0}^{n} (x-x_{k})$$\n这就是所求的插值多项式的简单、显式的递推更新公式。它仅用 $p_{n}(x)$、节点 $x_0, \\dots, x_{n+1}$、值 $f(x_{n+1})$ 以及前一个多项式在新节点的值 $p_{n}(x_{n+1})$ 来表示 $p_{n+1}(x)$。", "answer": "$$\n\\boxed{\np_{n+1}(x) = p_{n}(x) + \\frac{f(x_{n+1}) - p_{n}(x_{n+1})}{\\prod_{k=0}^{n} (x_{n+1}-x_{k})} \\prod_{k=0}^{n} (x-x_{k})\n}\n$$", "id": "3283141"}, {"introduction": "在推导出插值多项式的递归更新法则 [@problem_id:3283141] 之后，现在是时候将其付诸实践了。本练习要求你使用牛顿形式——这一递归过程的直接成果——为一个具体函数找到其插值多项式。通过分步计算均差并构建多项式，你将把抽象的理论与具体的计算紧密联系起来。", "problem": "考虑多项式插值问题：给定互不相同的节点 $x_{0}, x_{1}, \\dots, x_{n}$ 和函数数据 $f(x_{i})$，求一个次数至多为 $n$ 的多项式 $p$，使得对所有 $i$ 都有 $p(x_{i}) = f(x_{i})$。根据多项式的基本性质可知，如果两个次数至多为 $n$ 的多项式在 $n+1$ 个不同点上取值相同，那么这两个多项式是完全相同的。请您利用此框架来确定函数 $f(x) = \\cos(\\pi x)$ 的插值多项式。\n\n从均差的递归定义出发，不使用任何预先给出的封闭形式公式，为整数节点 $x = 0, 1, 2, 3$ 处的数据构造牛顿形式的插值多项式。然后，将您的结果展开并简化为带有精确系数的标准单项式基 $1, x, x^{2}, x^{3}$ 的形式。基于一般插值唯一性原理，简要论证您得到的多项式为何是这些数据上次数至多为 $3$ 的唯一插值多项式。\n\n将您的最终多项式明确地表示为一个关于 $x$ 的简化代数表达式。无需四舍五入；请给出精确的有理系数。", "solution": "该问题是有效的。这是一个关于多项式插值的数值分析中的适定问题，它基于已建立的数学原理，并包含了求得唯一解所需的所有信息。\n\n任务是求出函数 $f(x) = \\cos(\\pi x)$ 在互不相同的整数节点 $x_0 = 0$，$x_1 = 1$，$x_2 = 2$ 和 $x_3 = 3$ 处，次数至多为 $3$ 的唯一插值多项式 $p(x)$。我们将以其牛顿形式构造该多项式，然后将其简化为标准单项式基。\n\n首先，我们计算函数 $f(x)$ 在给定节点处的值：\n$f(x_0) = f(0) = \\cos(0 \\cdot \\pi) = \\cos(0) = 1$\n$f(x_1) = f(1) = \\cos(1 \\cdot \\pi) = \\cos(\\pi) = -1$\n$f(x_2) = f(2) = \\cos(2 \\cdot \\pi) = \\cos(2\\pi) = 1$\n$f(x_3) = f(3) = \\cos(3 \\cdot \\pi) = \\cos(3\\pi) = -1$\n\n对于 $n+1 = 4$ 个点，插值多项式 $p(x)$ 的牛顿形式由下式给出：\n$$p(x) = f[x_0] + f[x_0, x_1](x - x_0) + f[x_0, x_1, x_2](x - x_0)(x - x_1) + f[x_0, x_1, x_2, x_3](x - x_0)(x - x_1)(x - x_2)$$\n其中 $f[\\dots]$ 是均差。我们必须从零阶均差（即函数值本身）开始，递归地构造这些系数。\n\n零阶均差为：\n$f[x_0] = f(0) = 1$\n$f[x_1] = f(1) = -1$\n$f[x_2] = f(2) = 1$\n$f[x_3] = f(3) = -1$\n\n一阶均差计算如下：\n$f[x_0, x_1] = \\frac{f[x_1] - f[x_0]}{x_1 - x_0} = \\frac{-1 - 1}{1 - 0} = -2$\n$f[x_1, x_2] = \\frac{f[x_2] - f[x_1]}{x_2 - x_1} = \\frac{1 - (-1)}{2 - 1} = \\frac{2}{1} = 2$\n$f[x_2, x_3] = \\frac{f[x_3] - f[x_2]}{x_3 - x_2} = \\frac{-1 - 1}{3 - 2} = \\frac{-2}{1} = -2$\n\n二阶均差为：\n$f[x_0, x_1, x_2] = \\frac{f[x_1, x_2] - f[x_0, x_1]}{x_2 - x_0} = \\frac{2 - (-2)}{2 - 0} = \\frac{4}{2} = 2$\n$f[x_1, x_2, x_3] = \\frac{f[x_2, x_3] - f[x_1, x_2]}{x_3 - x_1} = \\frac{-2 - 2}{3 - 1} = \\frac{-4}{2} = -2$\n\n最后，三阶均差为：\n$f[x_0, x_1, x_2, x_3] = \\frac{f[x_1, x_2, x_3] - f[x_0, x_1, x_2]}{x_3 - x_0} = \\frac{-2 - 2}{3 - 0} = -\\frac{4}{3}$\n\n牛顿形式所需的系数是均差表的顶部对角线元素：$f[x_0]=1$，$f[x_0, x_1]=-2$，$f[x_0, x_1, x_2]=2$ 和 $f[x_0, x_1, x_2, x_3]=-\\frac{4}{3}$。\n\n将这些值和节点（$x_0=0, x_1=1, x_2=2$）代入牛顿多项式公式：\n$$p(x) = 1 + (-2)(x - 0) + 2(x - 0)(x - 1) + \\left(-\\frac{4}{3}\\right)(x - 0)(x - 1)(x - 2)$$\n$$p(x) = 1 - 2x + 2x(x - 1) - \\frac{4}{3}x(x - 1)(x - 2)$$\n\n现在，我们展开并简化此表达式，以获得标准单项式基 $\\{1, x, x^2, x^3\\}$ 形式的多项式。\n首先，展开二项式的乘积：\n$x(x - 1) = x^2 - x$\n$x(x - 1)(x - 2) = x(x^2 - 3x + 2) = x^3 - 3x^2 + 2x$\n\n将它们代回 $p(x)$ 的表达式中：\n$p(x) = 1 - 2x + 2(x^2 - x) - \\frac{4}{3}(x^3 - 3x^2 + 2x)$\n$p(x) = 1 - 2x + 2x^2 - 2x - \\frac{4}{3}x^3 + \\frac{12}{3}x^2 - \\frac{8}{3}x$\n$p(x) = 1 - 2x + 2x^2 - 2x - \\frac{4}{3}x^3 + 4x^2 - \\frac{8}{3}x$\n\n最后，按 $x$ 的幂次合并同类项：\n$x^3$ 项为：$-\\frac{4}{3}x^3$\n$x^2$ 项为：$2x^2 + 4x^2 = 6x^2$\n$x$ 项为：$-2x - 2x - \\frac{8}{3}x = -4x - \\frac{8}{3}x = \\left(-\\frac{12}{3} - \\frac{8}{3}\\right)x = -\\frac{20}{3}x$\n常数项为：$1$\n\n合并这些项，简化后的多项式为：\n$$p(x) = -\\frac{4}{3}x^3 + 6x^2 - \\frac{20}{3}x + 1$$\n\n为了证明该多项式的唯一性，我们引用问题中已陈述的多项式插值基本定理。我们构造的多项式 $p(x)$ 的次数为 $3$，即“至多为 $3$”。根据其构造，它在 $n+1=4$ 个不同点 $x_0=0, x_1=1, x_2=2, x_3=3$ 处满足插值条件 $p(x_i) = f(x_i)$。\n假设存在另一个次数也至多为 $3$ 的多项式，记为 $q(x)$，它满足相同的条件，即对 $i=0, 1, 2, 3$ 都有 $q(x_i) = f(x_i)$。那么，这两个多项式 $p(x)$ 和 $q(x)$ 在 $4$ 个不同点上的取值相同。根据“如果两个次数至多为 $n$ 的多项式在 $n+1$ 个不同点上取值相同，那么它们是完全相同的”这一原理，可得 $p(x)$ 和 $q(x)$ 必定是同一个多项式。因此，多项式 $p(x) = -\\frac{4}{3}x^3 + 6x^2 - \\frac{20}{3}x + 1$ 是给定数据上次数至多为 $3$ 的唯一插值多项式。", "answer": "$$\n\\boxed{-\\frac{4}{3}x^3 + 6x^2 - \\frac{20}{3}x + 1}\n$$", "id": "3283191"}, {"introduction": "插值多项式的唯一性定理，其关键前提是拥有足够数量的*互异*节点。本练习将挑战你去探索当这个核心条件不被满足时会发生什么。通过构造一个包含重复节点的具体反例，你将亲眼见证唯一性是如何失效的，并学会如何描述整个解集。", "problem": "考虑多项式插值问题：给定节点 $x_{0}, x_{1}, \\dots, x_{m}$（不要求互异）以及数据值 $y_{0}, y_{1}, \\dots, y_{m}$，寻找一个次数至多为 $k$ 的多项式 $p$，使得对所有 $i$ 都有 $p(x_{i}) = y_{i}$。请在实数域上进行讨论。\n\n1) 仅利用“一个次数至多为 $k$ 的非零实多项式至多有 $k$ 个不同的实根”这一事实，解释为什么当 $x_{0}, \\dots, x_{k}$ 两两互异时，对于任意给定的值 $y_{0}, \\dots, y_{k}$，至多存在一个次数至多为 $k$ 的多项式 $p$ 进行插值。然后论证为什么当某些节点重合时（即互异节点的数量小于或等于 $k$），即使节点的总数 $m+1$ 大于或等于 $k+2$，唯一性也可能不成立。\n\n2) 提供一个具体的反例，其中节点数 $n=3$，计入重数后总数为 $m+1 = n+1 = 4$，但限制在次数至多为 $n-1 = 2$ 的多项式范围内。取\n$$\nx_{0} = 0, \\quad x_{1} = 0, \\quad x_{2} = 0, \\quad x_{3} = 1\n$$\n并指定\n$$\ny_{0} = 1, \\quad y_{1} = 1, \\quad y_{2} = 1, \\quad y_{3} = 3\n$$\n证明插值问题 $p(0)=1$ 和 $p(1)=3$ 在 $\\deg p \\leq 2$ 的条件下有无穷多个解，并以闭合形式显式地构造所有这些解。你的构造应基于插值的定义和上述的根计数性质，不应援引任何现成的插值公式。将你的最终结果表示为通解插值多项式 $p(x)$ 的单个解析表达式。", "solution": "我们将多项式插值形式化如下。对于一个非负整数 $k$，令 $\\mathcal{P}_{k}$ 表示次数至多为 $k$ 的实多项式构成的向量空间。给定节点 $x_{0}, \\dots, x_{m}$ 和数据 $y_{0}, \\dots, y_{m}$，我们寻找 $p \\in \\mathcal{P}_{k}$ 使得对所有 $i$ 都有 $p(x_{i}) = y_{i}$。这是一个关于 $p$ 的系数的线性方程组，因为在固定点 $x_{i}$ 上的求值是 $\\mathcal{P}_{k}$ 上的一个线性泛函。\n\n我们使用的基本依据是这个经过充分检验的事实：一个次数至多为 $k$ 的非零实多项式 $q$ 至多有 $k$ 个不同的实根。等价地说，如果 $\\mathcal{P}_{k}$ 中的一个多项式在超过 $k$ 个不同的点上为零，那么它必定是零多项式。\n\n1) 假设 $x_{0}, \\dots, x_{k}$ 两两互异，且 $p_{1}, p_{2} \\in \\mathcal{P}_{k}$ 都满足 $p_{j}(x_{i}) = y_{i}$ 对 $i = 0, \\dots, k$ 成立。考虑 $r = p_{1} - p_{2} \\in \\mathcal{P}_{k}$。那么对于 $k+1$ 个不同的点 $x_{0}, \\dots, x_{k}$，有 $r(x_{i}) = 0$。根据根计数的事实，在 $\\mathcal{P}_{k}$ 中唯一具有 $k+1$ 个不同根的多项式是零多项式，因此 $r \\equiv 0$ 且 $p_{1} = p_{2}$。所以，当有 $k+1$ 个互异节点时，在 $\\mathcal{P}_{k}$ 中至多存在一个插值多项式；结合存在性（可通过线性代数或构造基来建立），这就得出了唯一性。\n\n如果某些节点重合，那么互异节点的数量 $r$ 可能小于或等于 $k$。在这种情况下，如果 $p_{0} \\in \\mathcal{P}_{k}$ 是在这些互异节点上匹配数据的任意一个特定插值多项式，那么任何形如\n$$\np(x) = p_{0}(x) + c \\prod_{j=1}^{r} (x - \\xi_{j})\n$$\n的多项式，其中 $\\{\\xi_{1}, \\dots, \\xi_{r}\\}$ 是互异的节点值，$c \\in \\mathbb{R}$ 是任意的，也位于 $\\mathcal{P}_{k}$ 中，并在每个 $\\xi_{j}$ 处与 $p_{0}$ 一致，因为该乘积在每个互异节点处为零。只要 $r \\leq k$，这个乘积的次数为 $r \\leq k$，所以 $p \\in \\mathcal{P}_{k}$。因此存在无穷多个插值多项式，这表明即使节点的总数 $m+1$ 超过 $k+1$，只要互异节点值的数量小于或等于 $k$，唯一性也可能不成立。\n\n2) 我们用 $n=3$ 来实例化这个反例，所以我们限制在 $\\mathcal{P}_{2}$，即次数至多为 2 的多项式中。我们给出 $n+1 = 4$ 个节点，但有重数：\n$$\nx_{0} = 0, \\quad x_{1} = 0, \\quad x_{2} = 0, \\quad x_{3} = 1\n$$\n指定的数据是\n$$\np(0) = y_{0} = 1, \\quad p(0) = y_{1} = 1, \\quad p(0) = y_{2} = 1, \\quad p(1) = y_{3} = 3\n$$\n因为在 $x=0$ 处的三个条件是相同的，所以有效的互异节点约束就简化为\n$$\np(0) = 1, \\quad p(1) = 3\n$$\n让我们先找一个特解 $p_{0} \\in \\mathcal{P}_{2}$。一个线性多项式就足够了：设\n$$\np_{0}(x) = 1 + 2x\n$$\n确实，$p_{0}(0) = 1$ 且 $p_{0}(1) = 3$。接下来，我们确定求值约束的零空间。一个多项式 $q \\in \\mathcal{P}_{2}$ 在两个互异节点 $0$ 和 $1$ 处都为零，当且仅当它是乘积 $(x-0)(x-1) = x(x-1)$ 的倍数。因此，所有解的集合是\n$$\np(x) = p_{0}(x) + c \\, x(x-1) = 1 + 2x + c \\, x(x-1),\n$$\n其中 $c \\in \\mathbb{R}$ 是任意的。每个这样的 $p$ 都满足 $p(0) = 1$ 和 $p(1) = 3$，因为 $x(x-1)$ 在 $x=0$ 和 $x=1$ 处为零。$\\mathcal{P}_{2}$ 中的每个解都必须是这种形式：如果 $p$ 是任意一个解，那么 $p - p_{0}$ 在这两个互异节点处为零，并且次数至多为 $2$，因此 $p - p_{0}$ 是 $x(x-1)$ 的一个常数倍。\n\n这显示了非唯一性（由 $c$ 参数化的无穷多个解），尽管有 $n+1$ 个节点，因为节点并非全都互异，并且互异节点的数量小于或等于次数界限 $2$。\n\n因此，整个解集可以用单个解析表达式以闭合形式给出\n$$\np(x) = 1 + 2x + c \\, x(x-1),\n$$\n其中 $c$ 是一个任意实数参数。", "answer": "$$\\boxed{1+2x+c\\,x(x-1)}$$", "id": "3283098"}]}