{"hands_on_practices": [{"introduction": "多项式插值误差公式是分析近似精度的核心工具。第一个练习将具体应用该公式，处理一个函数高阶导数为常数的特殊情况。这使我们能够精确计算插值误差，从而对误差项的结构建立起基础性的理解。[@problem_id:2169688]", "problem": "考虑函数 $f(x) = 3x^4 - 2x^2 + 5$。构造一个唯一的三次多项式，记为 $P_3(x)$，用于在不同的节点 $x_0 = -1$, $x_1 = 0$, $x_2 = 1$ 和 $x_3 = 2$ 处对函数 $f(x)$ 进行插值。在点 $x$ 处的插值误差定义为 $E(x) = f(x) - P_3(x)$。计算误差 $E(-0.5)$ 的精确值。\n\n请用最简精确分数形式表示您的答案。", "solution": "我们使用对于在不同节点 $x_{0},\\dots,x_{n}$ 的 $n$ 次插值的标准多项式插值误差公式：\n$$\nE(x)=f(x)-P_{n}(x)=\\frac{f^{(n+1)}(\\xi)}{(n+1)!}\\prod_{i=0}^{n}(x-x_{i}),\n$$\n其中 $\\xi$ 是 $\\{x_{0},\\dots,x_{n},x\\}$ 凸包中的某个值。这里 $n=3$ 且节点为 $x_{0}=-1$, $x_{1}=0$, $x_{2}=1$, $x_{3}=2$。\n\n给定 $f(x)=3x^{4}-2x^{2}+5$，计算其导数：\n$$\nf'(x)=12x^{3}-4x,\\quad f''(x)=36x^{2}-4,\\quad f^{(3)}(x)=72x,\\quad f^{(4)}(x)=72.\n$$\n由于 $f^{(4)}(x)$ 是常数，误差公式变得精确且不依赖于 $\\xi$：\n$$\nE(x)=\\frac{72}{4!}\\,(x+1)\\,x\\,(x-1)\\,(x-2).\n$$\n在 $x=-\\frac{1}{2}$ 处求值：\n$$\n(x+1)\\,x\\,(x-1)\\,(x-2)\\Big|_{x=-\\frac{1}{2}}=\\left(\\frac{1}{2}\\right)\\left(-\\frac{1}{2}\\right)\\left(-\\frac{3}{2}\\right)\\left(-\\frac{5}{2}\\right)=-\\frac{15}{16}.\n$$\n因此，\n$$\nE\\!\\left(-\\frac{1}{2}\\right)=\\frac{72}{24}\\left(-\\frac{15}{16}\\right)=3\\left(-\\frac{15}{16}\\right)=-\\frac{45}{16}.\n$$\n\n作为一致性检验，由于 $E(x)$ 是一个在四个节点处为零的 4 次多项式，且 $\\prod_{i=0}^{3}(x-x_{i})$ 是首项系数为 1 的 4 次多项式，所以 $E(x)$ 中 $x^{4}$ 的系数必须等于 $f(x)$ 的系数，即 $3$，这证实了 $E(x)=3\\prod_{i=0}^{3}(x-x_{i})$，并得出在 $x=-\\frac{1}{2}$ 处的相同值。", "answer": "$$\\boxed{-\\frac{45}{16}}$$", "id": "2169688"}, {"introduction": "在学会计算误差之后，我们来探究其行为特性。人们可能直观地认为插值误差 $|E_n(x)|$ 应小于函数值本身 $|f(x)|$，但事实并非总是如此。本练习将通过一个余弦函数的具体例子，构造一个误差大小超过函数本身大小的情景，揭示插值旨在匹配节点处的函数值，而非必须在其他地方保持在函数曲线的“下方”。[@problem_id:3225517]", "problem": "在多项式插值中，点 $x$ 处的插值误差定义为 $E_n(x) = f(x) - P_n(x)$，其中 $P_n(x)$ 是在 $n+1$ 个不同节点上对函数 $f(x)$ 进行插值的次数至多为 $n$ 的多项式。从插值的基本定义，即在所选节点 $\\{x_i\\}_{i=0}^n$ 处满足 $P_n(x_i) = f(x_i)$ 的要求出发，通过显式构造证明在某点可能出现 $|E_n(x)| > |f(x)|$ 的情况。\n\n使用节点 $x_0 = 0$、$x_1 = \\pi$、$x_2 = 2\\pi$（角度以弧度为单位），为函数 $f(x) = \\cos(x)$ 构造二次（$n=2$）插值多项式 $P_2(x)$。然后，计算在 $x = \\frac{\\pi}{2}$ 处的误差，并验证是否满足 $|E_2\\!\\left(\\frac{\\pi}{2}\\right)| > |f\\!\\left(\\frac{\\pi}{2}\\right)|$。\n\n提供 $|E_2\\!\\left(\\frac{\\pi}{2}\\right)|$ 的精确值作为您的最终答案。", "solution": "目标是为一个给定的函数和一组节点构造一个二次插值多项式，然后在一个特定点评估插值误差，以证明误差的绝对值可能超过函数本身的绝对值。\n\n待插值的函数是 $f(x) = \\cos(x)$。\n多项式的次数为 $n=2$，这意味着我们需要 $n+1=3$ 个插值节点。\n给定的节点是 $x_0 = 0$、$x_1 = \\pi$ 和 $x_2 = 2\\pi$。\n\n首先，我们必须在每个节点上计算函数 $f(x)$ 的值，以建立插值条件。\n$f(x_0) = f(0) = \\cos(0) = 1$\n$f(x_1) = f(\\pi) = \\cos(\\pi) = -1$\n$f(x_2) = f(2\\pi) = \\cos(2\\pi) = 1$\n\n设二次插值多项式为 $P_2(x) = ax^2 + bx + c$。我们需要找到系数 $a$、$b$ 和 $c$，使得该多项式通过点 $(0, 1)$、$(\\pi, -1)$ 和 $(2\\pi, 1)$。这给了我们一个包含三个线性方程的方程组：\n\n1. 在 $x_0 = 0$ 处：$P_2(0) = a(0)^2 + b(0) + c = f(0) = 1$。这立即得出 $c = 1$。\n2. 在 $x_1 = \\pi$ 处：$P_2(\\pi) = a\\pi^2 + b\\pi + c = f(\\pi) = -1$。代入 $c=1$，我们得到 $a\\pi^2 + b\\pi + 1 = -1$，化简为 $a\\pi^2 + b\\pi = -2$。\n3. 在 $x_2 = 2\\pi$ 处：$P_2(2\\pi) = a(2\\pi)^2 + b(2\\pi) + c = f(2\\pi) = 1$。代入 $c=1$，我们得到 $4a\\pi^2 + 2b\\pi + 1 = 1$，化简为 $4a\\pi^2 + 2b\\pi = 0$。两边除以 $2\\pi$（因为 $\\pi \\neq 0$）得到 $2a\\pi + b = 0$，即 $b = -2a\\pi$。\n\n现在我们有一个关于 $a$ 和 $b$ 的方程组：\n(i) $a\\pi^2 + b\\pi = -2$\n(ii) $b = -2a\\pi$\n\n将方程 (ii) 代入方程 (i)：\n$a\\pi^2 + (-2a\\pi)\\pi = -2$\n$a\\pi^2 - 2a\\pi^2 = -2$\n$-a\\pi^2 = -2$\n$a = \\frac{2}{\\pi^2}$\n\n现在将 $a$ 的值代回方程 (ii) 以求出 $b$：\n$b = -2 \\left(\\frac{2}{\\pi^2}\\right)\\pi = -\\frac{4\\pi}{\\pi^2} = -\\frac{4}{\\pi}$\n\n因此，系数为 $a = \\frac{2}{\\pi^2}$、$b = -\\frac{4}{\\pi}$ 和 $c=1$。二次插值多项式是：\n$P_2(x) = \\frac{2}{\\pi^2}x^2 - \\frac{4}{\\pi}x + 1$\n\n在点 $x$ 处的插值误差定义为 $E_n(x) = f(x) - P_n(x)$。对于本题，$E_2(x) = f(x) - P_2(x)$。我们需要计算在 $x = \\frac{\\pi}{2}$ 处的这个误差。\n\n首先，计算函数 $f(x)$ 在 $x = \\frac{\\pi}{2}$ 处的值：\n$f\\left(\\frac{\\pi}{2}\\right) = \\cos\\left(\\frac{\\pi}{2}\\right) = 0$\n\n接下来，计算多项式 $P_2(x)$ 在 $x = \\frac{\\pi}{2}$ 处的值：\n$P_2\\left(\\frac{\\pi}{2}\\right) = \\frac{2}{\\pi^2}\\left(\\frac{\\pi}{2}\\right)^2 - \\frac{4}{\\pi}\\left(\\frac{\\pi}{2}\\right) + 1$\n$P_2\\left(\\frac{\\pi}{2}\\right) = \\frac{2}{\\pi^2}\\left(\\frac{\\pi^2}{4}\\right) - \\frac{4\\pi}{2\\pi} + 1$\n$P_2\\left(\\frac{\\pi}{2}\\right) = \\frac{2\\pi^2}{4\\pi^2} - 2 + 1$\n$P_2\\left(\\frac{\\pi}{2}\\right) = \\frac{1}{2} - 1 = -\\frac{1}{2}$\n\n现在，计算误差 $E_2\\left(\\frac{\\pi}{2}\\right)$：\n$E_2\\left(\\frac{\\pi}{2}\\right) = f\\left(\\frac{\\pi}{2}\\right) - P_2\\left(\\frac{\\pi}{2}\\right) = 0 - \\left(-\\frac{1}{2}\\right) = \\frac{1}{2}$\n\n问题要求我们验证是否满足 $|E_2\\left(\\frac{\\pi}{2}\\right)| > |f\\left(\\frac{\\pi}{2}\\right)|$。\n$|E_2\\left(\\frac{\\pi}{2}\\right)| = \\left|\\frac{1}{2}\\right| = \\frac{1}{2}$\n$|f\\left(\\frac{\\pi}{2}\\right)| = |0| = 0$\n由于 $\\frac{1}{2} > 0$，该条件确实成立，这证明了插值误差的绝对值可以大于函数本身的绝对值。\n\n最后的任务是提供 $|E_2\\left(\\frac{\\pi}{2}\\right)|$ 的精确值。如上计算，该值为 $\\frac{1}{2}$。", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "3225517"}, {"introduction": "插值节点的选择对插值误差有决定性的影响。误差公式中的乘积项 $\\prod |x - x_i|$ 可以通过移动节点 $x_i$ 来控制。这个思想实验让我们扮演“破坏者”：如何选择节点，使得在特定点上的误差上界达到最大？通过找出最差的节点布局，我们将深刻体会到为何策略性地选择节点（例如使用切比雪夫节点）对于可靠和精确的插值至关重要。[@problem_id:3225439]", "problem": "设函数 $f(x) = \\sin(\\pi x)$ 定义在区间 $[-1, 1]$上，其中角度以弧度为单位。固定一个整数 $n \\geq 0$。对于 $[-1, 1]$ 中 $n+1$ 个任意不同插值节点 $x_0, x_1, \\dots, x_n$ 的任意选择，令 $p_n$ 表示在这些节点上对 $f$ 进行插值的次数至多为 $n$ 的唯一多项式。考虑点 $x^{\\star} = \\tfrac{1}{2}$。\n\n仅使用基本定义和关于多项式插值误差的公认结果，确定对于 $[-1,1]$ 中所有不同节点的选择，在 $x^{\\star}$ 点处 $f - p_n$ 的标准绝对先验误差上界的确界（supremum）。等价地，设计一种在 $[-1,1]$ 中放置插值节点的策略，通过使该先验界尽可能大来破坏在 $x^{\\star}$ 处的插值，并以 $n$ 和 $\\pi$ 的闭式表达式计算得到的上确界。\n\n请用一个关于 $n$ 和 $\\pi$ 的单一闭式解析表达式给出你的最终答案。无需进行数值取整。", "solution": "问题要求计算函数 $f(x) = \\sin(\\pi x)$ 在区间 $[-1, 1]$ 上进行多项式插值时，在特定点 $x^{\\star} = \\frac{1}{2}$ 处的标准先验误差上界的确界。插值使用区间 $[-1, 1]$ 中的 $n+1$ 个不同节点 $x_0, x_1, \\dots, x_n$。\n\n插值误差 $f(x) - p_n(x)$ 的标准绝对先验误差上界由以下公式给出：\n$$ |f(x) - p_n(x)| \\leq \\frac{M_{n+1}}{(n+1)!} \\left| \\prod_{i=0}^{n} (x - x_i) \\right| $$\n其中 $M_{n+1}$ 是 $f(x)$ 的 $(n+1)$ 阶导数绝对值在包含节点和点 $x$ 的区间上的确界。在本问题中，该区间被指定为 $[-1, 1]$，所以我们有：\n$$ M_{n+1} = \\sup_{t \\in [-1, 1]} |f^{(n+1)}(t)| $$\n任务是找到在点 $x = x^{\\star} = \\frac{1}{2}$ 处，对于所有可能的 $n+1$ 个不同节点 $x_i \\in [-1, 1]$ 的选择，该上界的确界。设此上确界为 $S$。\n$$ S = \\sup_{\\substack{x_0, \\dots, x_n \\in [-1, 1] \\\\ x_i \\neq x_j \\text{ for } i \\neq j}} \\left( \\frac{M_{n+1}}{(n+1)!} \\left| \\prod_{i=0}^{n} \\left(\\frac{1}{2} - x_i\\right) \\right| \\right) $$\n项 $\\frac{M_{n+1}}{(n+1)!}$ 与节点的选择无关。因此，我们可以写出：\n$$ S = \\frac{M_{n+1}}{(n+1)!} \\sup_{\\substack{x_0, \\dots, x_n \\in [-1, 1] \\\\ x_i \\neq x_j \\text{ for } i \\neq j}} \\left| \\prod_{i=0}^{n} \\left(\\frac{1}{2} - x_i\\right) \\right| $$\n我们分别分析这个表达式的两个组成部分。\n\n首先，我们确定函数 $f(x) = \\sin(\\pi x)$ 的 $M_{n+1}$。我们计算其逐次导数：\n$f^{(0)}(x) = \\sin(\\pi x)$\n$f^{(1)}(x) = \\pi \\cos(\\pi x)$\n$f^{(2)}(x) = -\\pi^2 \\sin(\\pi x)$\n$f^{(3)}(x) = -\\pi^3 \\cos(\\pi x)$\n$f^{(4)}(x) = \\pi^4 \\sin(\\pi x)$\n一般地，$(k)$ 阶导数 $f^{(k)}(x)$ 的形式为 $\\pm \\pi^k \\sin(\\pi x)$ 或 $\\pm \\pi^k \\cos(\\pi x)$。$\\sin(\\theta)$ 和 $\\cos(\\theta)$ 的最大绝对值为 $1$。因此，$(n+1)$ 阶导数的绝对值在任何区间（包括 $[-1, 1]$）上的确界是：\n$$ M_{n+1} = \\sup_{t \\in [-1, 1]} |f^{(n+1)}(t)| = \\pi^{n+1} $$\n所以 $S$ 表达式的第一部分是 $\\frac{\\pi^{n+1}}{(n+1)!}$。\n\n其次，我们需要确定与节点相关的部分，即节点多项式在 $x^{\\star} = \\frac{1}{2}$ 处求值的幅值的上确界：\n$$ \\sup_{\\substack{x_0, \\dots, x_n \\in [-1, 1] \\\\ x_i \\neq x_j \\text{ for } i \\neq j}} \\left| \\prod_{i=0}^{n} \\left(\\frac{1}{2} - x_i\\right) \\right| = \\sup_{\\substack{x_0, \\dots, x_n \\in [-1, 1] \\\\ x_i \\neq x_j \\text{ for } i \\neq j}} \\prod_{i=0}^{n} \\left|\\frac{1}{2} - x_i\\right| $$\n问题现在简化为找到一种在区间 $[-1, 1]$ 中放置不同节点 $x_0, \\dots, x_n$ 的策略，以最大化它们与点 $\\frac{1}{2}$ 的距离之积。\n\n对于任何单个节点 $x_i \\in [-1, 1]$，当 $x_i$ 位于区间 $[-1, 1]$ 的一个端点时，距离 $\\left|\\frac{1}{2} - x_i\\right|$ 最大。我们来检查这些端点：\n在 $x_i = 1$ 处，距离为 $\\left|\\frac{1}{2} - 1\\right| = \\left|-\\frac{1}{2}\\right| = \\frac{1}{2}$。\n在 $x_i = -1$ 处，距离为 $\\left|\\frac{1}{2} - (-1)\\right| = \\left|\\frac{3}{2}\\right| = \\frac{3}{2}$。\n任何单个节点的最大可能距离是 $\\frac{3}{2}$，在 $x_i = -1$ 处达到。\n\n为了最大化乘积 $\\prod_{i=0}^{n} \\left|\\frac{1}{2} - x_i\\right|$，我们应该选择每个 $x_i$ 以最大化其与 $\\frac{1}{2}$ 的个体距离。因此，理想情况下，我们会希望将所有 $n+1$ 个节点都放在点 $x = -1$ 处。然而，问题规定节点必须是不同的。\n\n设待最大化的量为 $P(x_0, \\dots, x_n) = \\prod_{i=0}^{n} |\\frac{1}{2} - x_i|$。定义域是 $[-1, 1]$ 中不同点的 $(n+1)$-元组集合。这是一个开集，最大值可能无法在其内部达到。因此，我们寻求其上确界。$P$ 在不同节点集合上的上确界与 $P$ 在该集合的闭包（即超立方体 $[-1, 1]^{n+1}$）上的最大值相同。在这个闭合有界集上，连续函数 $P$ 达到其最大值。正如我们发现的，当所有 $x_i$ 都选择为 $-1$ 时，达到这个最大值。最大值将是：\n$$ \\prod_{i=0}^{n} \\left|\\frac{1}{2} - (-1)\\right| = \\prod_{i=0}^{n} \\frac{3}{2} = \\left(\\frac{3}{2}\\right)^{n+1} $$\n尽管用不同的节点无法达到这个最大值，但它就是上确界。我们可以构造一个不同节点的序列，使其乘积趋近于这个值。例如，选择一个小的 $\\epsilon > 0$ 并将节点设置为 $x_i = -1 + i\\epsilon$（对于 $i = 0, 1, \\dots, n$）。只要 $n\\epsilon \\le 2$，所有节点都在 $[-1, 1]$ 中。当 $\\epsilon \\to 0^+$ 时，所有节点 $x_i$ 都趋近于 $-1$，且乘积 $\\prod_{i=0}^{n} |\\frac{1}{2} - x_i|$ 趋近于 $(\\frac{3}{2})^{n+1}$。\n因此，破坏策略是将 $n+1$ 个不同的节点无限地聚集在点 $x = -1$ 附近。\n\n与节点相关的项的上确界是：\n$$ \\sup_{\\substack{x_0, \\dots, x_n \\in [-1, 1] \\\\ x_i \\neq x_j}} \\prod_{i=0}^{n} \\left|\\frac{1}{2} - x_i\\right| = \\left(\\frac{3}{2}\\right)^{n+1} $$\n最后，我们结合这两个部分来求得总的上确界误差界 $S$：\n$$ S = \\frac{\\pi^{n+1}}{(n+1)!} \\cdot \\left(\\frac{3}{2}\\right)^{n+1} $$\n这个表达式可以简化为：\n$$ S = \\frac{3^{n+1} \\pi^{n+1}}{2^{n+1} (n+1)!} = \\frac{(3\\pi)^{n+1}}{2^{n+1}(n+1)!} $$\n这就是所求的关于 $n$ 和 $\\pi$ 的上确界的闭式表达式。", "answer": "$$\\boxed{\\frac{(3\\pi)^{n+1}}{2^{n+1}(n+1)!}}$$", "id": "3225439"}]}