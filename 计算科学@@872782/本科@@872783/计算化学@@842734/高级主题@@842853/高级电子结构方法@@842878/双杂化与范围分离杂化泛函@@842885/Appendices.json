{"hands_on_practices": [{"introduction": "双杂化泛函通过将一部分精确的 Hartree-Fock 交换和一部分来自 Møller-Plesset 微扰理论 (MP2) 的相关能混合到 Kohn-Sham 密度泛函理论 (DFT) 中，从而在计算化学领域取得了巨大成功。要真正理解这些高级方法，第一步是解构其能量构成。此练习 [@problem_id:2454314] 将引导您分解 B2PLYP 这种代表性双杂化泛函的总能量，让您亲手计算并验证各个组分——包括 Hartree-Fock 交换、GGA 交换、GGA 相关和 MP2 相关——是如何根据其特定的混合系数对总能量做出贡献的。", "problem": "一个闭壳层水分子在 Kohn–Sham 密度泛函理论 (DFT) 框架下，使用 B2PLYP 双杂化泛函进行处理。在原子单位下，总电子能量可以分解为 Kohn–Sham 基础能量项与一个交换相关混合项之和，该混合项结合了 Hartree–Fock (HF) 交换、广义梯度近似 (GGA) 交换、GGA 相关以及二阶 Møller–Plesset 微扰理论 (MP2) 相关。设 B2PLYP 混合系数为 $a_x = 0.53$（Hartree–Fock 交换的比例）和 $a_c = 0.27$（MP2 相关的比例）。对于一组给定的原始组分能量 $E_x^{\\mathrm{HF}}$、$E_x^{\\mathrm{GGA}}$、$E_c^{\\mathrm{GGA}}$ 和 $E_c^{\\mathrm{MP2}}$，计入总能量的贡献分别为 $a_x E_x^{\\mathrm{HF}}$、$\\left(1 - a_x\\right) E_x^{\\mathrm{GGA}}$、$\\left(1 - a_c\\right) E_c^{\\mathrm{GGA}}$ 和 $a_c E_c^{\\mathrm{MP2}}$。将剩余的 Kohn–Sham 能量定义为所有非交换相关项之和，即电子动能、电子-核吸引能、经典库仑（Hartree）能量以及核-核排斥能，使其等于总能量减去四个交换相关贡献项。\n\n您的任务是，为每个测试用例计算加和得到给定总电子能量的五个组成部分：标度化的 Hartree–Fock 交换贡献 $a_x E_x^{\\mathrm{HF}}$、标度化的广义梯度近似交换贡献 $\\left(1 - a_x\\right) E_x^{\\mathrm{GGA}}$、标度化的广义梯度近似相关贡献 $\\left(1 - a_c\\right) E_c^{\\mathrm{GGA}}$、标度化的二阶 Møller–Plesset 微扰理论相关贡献 $a_c E_c^{\\mathrm{MP2}}$，以及剩余的 Kohn–Sham 能量。使用以下关于剩余 Kohn–Sham 能量的精确定义：\n$$\nE_{\\mathrm{rest}} \\equiv E_{\\mathrm{tot}} - \\left[a_x E_x^{\\mathrm{HF}} + \\left(1 - a_x\\right) E_x^{\\mathrm{GGA}} + \\left(1 - a_c\\right) E_c^{\\mathrm{GGA}} + a_c E_c^{\\mathrm{MP2}}\\right].\n$$\n\n所有能量均以哈特里（Hartree, $\\left(\\mathrm{E_h}\\right)$）为单位给出和报告。将每个报告值以 $\\mathrm{E_h}$ 为单位表示，并四舍五入到 $6$ 位小数。\n\n测试集（每个元组以 $\\mathrm{E_h}$ 为单位提供 $\\left(E_{\\mathrm{tot}}, E_x^{\\mathrm{HF}}, E_x^{\\mathrm{GGA}}, E_c^{\\mathrm{GGA}}, E_c^{\\mathrm{MP2}}\\right)$）：\n- 用例 1：$\\left(-76.420000, -8.900000, -8.200000, -0.900000, -0.210000\\right)$。\n- 用例 2：$\\left(-76.280000, -8.500000, -7.900000, -0.700000, -0.050000\\right)$。\n- 用例 3：$\\left(-76.450000, -9.050000, -8.350000, -0.950000, -0.230000\\right)$。\n\n最终输出格式：您的程序应生成单行输出，其中包含所有用例的结果，格式为无空格的、以逗号分隔的列表之列表。每个内部列表按 $\\left[a_x E_x^{\\mathrm{HF}},\\left(1-a_x\\right) E_x^{\\mathrm{GGA}},\\left(1-a_c\\right) E_c^{\\mathrm{GGA}}, a_c E_c^{\\mathrm{MP2}}, E_{\\mathrm{rest}}\\right]$ 的顺序包含五个数字，每个数字均以 $\\mathrm{E_h}$ 为单位四舍五入到 $6$ 位小数。例如，形状必须是\n$$\n\\left[\\left[v_{11},v_{12},v_{13},v_{14},v_{15}\\right],\\left[v_{21},v_{22},v_{23},v_{24},v_{25}\\right],\\left[v_{31},v_{32},v_{33},v_{34},v_{35}\\right]\\right],\n$$\n并且该行中任何地方都不能有空格。", "solution": "问题陈述已经过严格验证，被认为是有效的。它在科学上是合理的，基于 Kohn–Sham 密度泛函理论的既定原则，并且在数学上是适定的。所有必需的数据和定义均已提供，从而可以得到唯一且可验证的解。因此，我们将进行完整的推导和计算。\n\n核心任务是将使用 B2PLYP 双杂化泛函计算的总电子能量 $E_{\\mathrm{tot}}$ 分解为其组成部分。B2PLYP 泛函是双杂化泛函的一个突出例子，它将一部分二阶 Møller–Plesset 微扰理论 (MP2) 相关纳入到交换相关能量表达式中。\n\nB2PLYP 泛函的总交换相关能量 $E_{\\mathrm{XC}}$ 定义为四个组分的线性组合：Hartree-Fock (HF) 精确交换 $E_x^{\\mathrm{HF}}$；交换的广义梯度近似 (GGA) $E_x^{\\mathrm{GGA}}$；相关的 GGA $E_c^{\\mathrm{GGA}}$；以及 MP2 相关 $E_c^{\\mathrm{MP2}}$。其公式由下式给出：\n$$\nE_{\\mathrm{XC}}^{\\mathrm{B2PLYP}} = a_x E_x^{\\mathrm{HF}} + (1 - a_x) E_x^{\\mathrm{GGA}} + (1 - a_c) E_c^{\\mathrm{GGA}} + a_c E_c^{\\mathrm{MP2}}\n$$\n其中 $a_x$ 和 $a_c$ 是经验确定的混合系数。问题提供了 B2PLYP 的标准值：\n$$\na_x = 0.53\n$$\n$$\na_c = 0.27\n$$\n由此，我们可以推导出互补系数：\n$$\n1 - a_x = 1 - 0.53 = 0.47\n$$\n$$\n1 - a_c = 1 - 0.27 = 0.73\n$$\n问题要求计算加和为总能量 $E_{\\mathrm{tot}}$ 的五个特定能量组分。前四个是标度化的交换相关贡献：\n1.  标度化的 HF 交换贡献：$E_1 = a_x E_x^{\\mathrm{HF}}$\n2.  标度化的 GGA 交换贡献：$E_2 = (1 - a_x) E_x^{\\mathrm{GGA}}$\n3.  标度化的 GGA 相关贡献：$E_3 = (1 - a_c) E_c^{\\mathrm{GGA}}$\n4.  标度化的 MP2 相关贡献：$E_4 = a_c E_c^{\\mathrm{MP2}}$\n\n第五个组分 $E_{\\mathrm{rest}}$ 代表总能量计算中的所有其他项。这些项包括电子动能、电子-核吸引能、经典库仑（Hartree）能量以及核-核排斥能。它通过从总能量中减去四个交换相关贡献之和来定义：\n$$\nE_{\\mathrm{rest}} = E_{\\mathrm{tot}} - (E_1 + E_2 + E_3 + E_4)\n$$\n我们现在将此过程应用于每个测试用例。让我们演示用例 1 的计算过程。给定的输入能量以哈特里（$\\mathrm{E_h}$）为单位，如下所示：\n$$\nE_{\\mathrm{tot}} = -76.420000, \\quad E_x^{\\mathrm{HF}} = -8.900000, \\quad E_x^{\\mathrm{GGA}} = -8.200000, \\quad E_c^{\\mathrm{GGA}} = -0.900000, \\quad E_c^{\\mathrm{MP2}} = -0.210000\n$$\n五个组分计算如下：\n1.  $E_1 = a_x E_x^{\\mathrm{HF}} = 0.53 \\times (-8.900000) = -4.717000 \\, \\mathrm{E_h}$\n2.  $E_2 = (1 - a_x) E_x^{\\mathrm{GGA}} = 0.47 \\times (-8.200000) = -3.854000 \\, \\mathrm{E_h}$\n3.  $E_3 = (1 - a_c) E_c^{\\mathrm{GGA}} = 0.73 \\times (-0.900000) = -0.657000 \\, \\mathrm{E_h}$\n4.  $E_4 = a_c E_c^{\\mathrm{MP2}} = 0.27 \\times (-0.210000) = -0.056700 \\, \\mathrm{E_h}$\n这些交换相关组分之和为：\n$$\nE_{\\mathrm{XC-sum}} = -4.717000 - 3.854000 - 0.657000 - 0.056700 = -9.284700 \\, \\mathrm{E_h}\n$$\n现在，我们计算剩余能量 $E_{\\mathrm{rest}}$：\n$$\nE_{\\mathrm{rest}} = E_{\\mathrm{tot}} - E_{\\mathrm{XC-sum}} = -76.420000 - (-9.284700) = -67.135300 \\, \\mathrm{E_h}\n$$\n用例 1 的五个结果值，四舍五入到 6 位小数，为：$(-4.717000, -3.854000, -0.657000, -0.056700, -67.135300)$。此相同过程被系统地应用于问题陈述中提供的所有其他测试用例。最终的程序化解决方案将实现此算法，并按照规定将生成的数值列表格式化为单个连续字符串。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the five constituent parts of the B2PLYP total energy for a set of test cases.\n    \"\"\"\n    # Define the B2PLYP mixing coefficients.\n    a_x = 0.53  # Fraction of Hartree-Fock exchange\n    a_c = 0.27  # Fraction of MP2 correlation\n\n    # Define the test cases from the problem statement.\n    # Each tuple contains (E_tot, E_x_HF, E_x_GGA, E_c_GGA, E_c_MP2) in Hartrees.\n    test_cases = [\n        (-76.420000, -8.900000, -8.200000, -0.900000, -0.210000),\n        (-76.280000, -8.500000, -7.900000, -0.700000, -0.050000),\n        (-76.450000, -9.050000, -8.350000, -0.950000, -0.230000),\n    ]\n\n    results = []\n    for case in test_cases:\n        E_tot, E_x_HF, E_x_GGA, E_c_GGA, E_c_MP2 = case\n\n        # Calculate the four scaled exchange-correlation contributions.\n        # 1. Scaled Hartree-Fock exchange\n        comp_HF_x = a_x * E_x_HF\n        # 2. Scaled GGA exchange\n        comp_GGA_x = (1 - a_x) * E_x_GGA\n        # 3. Scaled GGA correlation\n        comp_GGA_c = (1 - a_c) * E_c_GGA\n        # 4. Scaled MP2 correlation\n        comp_MP2_c = a_c * E_c_MP2\n\n        # Sum the exchange-correlation contributions.\n        e_xc_sum = comp_HF_x + comp_GGA_x + comp_GGA_c + comp_MP2_c\n\n        # 5. Calculate the remaining Kohn-Sham energy.\n        e_rest = E_tot - e_xc_sum\n\n        # Store the five components for the current case.\n        current_result = [comp_HF_x, comp_GGA_x, comp_GGA_c, comp_MP2_c, e_rest]\n        results.append(current_result)\n\n    # Format the final output string according to the strict problem specification:\n    # A list of lists, with no spaces, and each value rounded to 6 decimal places.\n    # The f-string format specifier \"{val:.6f}\" ensures fixed-point notation with 6 decimal places.\n    final_output_parts = []\n    for res_list in results:\n        inner_str = \"[\" + \",\".join([f\"{val:.6f}\" for val in res_list]) + \"]\"\n        final_output_parts.append(inner_str)\n    \n    final_output_string = \"[\" + \",\".join(final_output_parts) + \"]\"\n\n    # Final print statement in the exact required format.\n    print(final_output_string)\n\nsolve()\n```", "id": "2454314"}, {"introduction": "传统 DFT 泛函的一个主要缺陷是自相互作用误差，这导致对电离势 ($IP$) 等性质的预测不准确，因为 $- \\epsilon_{\\text{HOMO}}$ 与 $IP$ 的精确关系被破坏了。范围分离杂化 (RSH) 泛函通过在不同电子间距离上采用不同比例的精确交换，为解决此问题提供了优雅的方案。此练习 [@problem_id:2454313] 利用一个简化的物理模型，让您亲身体验如何通过“调节”范围分离参数 $\\omega$ 来系统地减小自相互作用误差，并观察从标准 GGA (PBE) 到全局杂化 (B3LYP) 再到调节的 RSH (LC-$\\omega$PBE) 泛函，其对电离势的预测能力如何得到显著提升。", "problem": "要求您使用两种能量差定义和三种交换相关泛函族，计算氩原子第一电离势的模型预测值。目标是使用一个最小的、基于第一性原理的分析模型来比较不同方法预测的电离势，该模型分离了自相互作用和范围分离的作用。所有能量必须以电子伏特表示，任何类频率参数必须以玻尔半径的倒数表示。最终输出必须是单行，包含一个由方括号括起来的、逗号分隔的结果列表。\n\n考虑一个用于氩原子最高占据 Kohn–Sham 轨道的单轨道模型。设最高占据轨道的实空间电子密度由一个归一化的球对称高斯函数近似\n$$\n\\rho(\\mathbf{r}) = \\left(\\frac{\\alpha}{\\pi}\\right)^{3/2} \\exp\\left(-\\alpha r^2\\right),\n$$\n其中 $\\alpha$ 是一个正参数，单位为玻尔半径平方的倒数。该单电子密度的库仑 (Hartree) 自相互作用能为\n$$\nJ(\\alpha) = \\iint \\frac{\\rho(\\mathbf{r}) \\rho(\\mathbf{r'})}{|\\mathbf{r}-\\mathbf{r'}|}\\, d\\mathbf{r}\\, d\\mathbf{r'} = \\sqrt{\\frac{2\\alpha}{\\pi}},\n$$\n以 Hartree 原子单位计。通过以下方式对库仑核进行范围分离分解：\n$$\n\\frac{1}{r} = \\frac{\\operatorname{erf}(\\omega r)}{r} + \\frac{\\operatorname{erfc}(\\omega r)}{r},\n$$\n其中 $\\omega$ 是范围分离参数，单位为玻尔半径的倒数，$\\operatorname{erf}$ 是误差函数，$\\operatorname{erfc}$ 是互补误差函数。在此模型中，对于具有 $100\\%$ 长程精确交换和 $0\\%$ 短程精确交换的长程校正杂化泛函，其未抵消的短程剩余自相互作用为\n$$\nJ_{\\mathrm{SR}}(\\alpha,\\omega) = J(\\alpha)\\, \\operatorname{erfc}\\!\\left(\\frac{\\omega}{\\sqrt{2\\alpha}}\\right),\n$$\n以 Hartree 原子单位计。\n\n假设氩的电离势为 $I_{\\mathrm{ref}} = 15.7596$ 电子伏特。在基于 Janak 定理的线性化分段线性模型中，由剩余自相互作用引起的曲率会影响两个电离势代理：\n- 对于没有精确交换的广义梯度近似 (PBE: Perdew–Burke–Ernzerhof)，剩余曲率为 $K = J(\\alpha)$。\n- 对于具有全局精确交换分数 $a_{\\mathrm{g}}$ 的全局杂化泛函 (B3LYP: Becke 3-parameter Lee–Yang–Parr)，剩余曲率为 $K = \\left(1 - a_{\\mathrm{g}}\\right) J(\\alpha)$。\n- 对于具有 $100\\%$ 长程精确交换和 $0\\%$ 短程精确交换的调谐长程校正泛函 (LC-$\\omega$PBE: Long-Range Corrected $\\omega$-PBE)，剩余曲率为 $K = J_{\\mathrm{SR}}(\\alpha,\\omega)$。\n\n令 Koopmans 电离势估计值为\n$$\nI_{K} = I_{\\mathrm{ref}} - K_{\\mathrm{eV}},\n$$\n以及 $\\Delta$-自洽场电离势估计值为\n$$\nI_{\\Delta} = I_{\\mathrm{ref}} - \\frac{K_{\\mathrm{eV}}}{2},\n$$\n其中 $K_{\\mathrm{eV}}$ 是剩余曲率 $K$ 通过因子 $1\\,\\mathrm{Hartree} = 27.211386245988\\,\\mathrm{eV}$ 从 Hartree 转换为电子伏特的值。\n\n使用以下参数值：\n- 氩最高占据轨道高斯宽度：$\\alpha = 0.6\\,\\text{Bohr}^{-2}$。\n- 参考电离势：$I_{\\mathrm{ref}} = 15.7596\\,\\mathrm{eV}$。\n- PBE：$a_{\\mathrm{g}} = 0$ 且 $\\omega = 0$。\n- B3LYP：$a_{\\mathrm{g}} = 0.20$ 且 $\\omega = 0$。\n- 调谐的 LC-$\\omega$PBE：$a_{\\mathrm{g}} = 0$，且 $\\omega$ 选择为满足 $|I_{\\mathrm{ref}} - I_{K}| \\le \\tau$ 的最小非负值，其中 $\\tau$ 是以电子伏特为单位的指定容差。因为 $I_{K} = I_{\\mathrm{ref}} - K_{\\mathrm{eV}}$，这个调谐条件等价于 $K_{\\mathrm{eV}} \\le \\tau$。\n\n您的程序必须为每个测试用例计算以下内容：以电子伏特为单位的 $\\Delta$-自洽场电离势 $I_{\\Delta}$，以电子伏特为单位的 Koopmans 电离势 $I_{K}$，以电子伏特为单位的剩余曲率 $K_{\\mathrm{eV}}$，以及该用例中使用的、以玻尔半径倒数为单位的 $\\omega$ 值。\n\n要实现的测试套件：\n1. PBE 用例：$\\alpha = 0.6\\,\\text{Bohr}^{-2}$，$a_{\\mathrm{g}} = 0$，$\\omega = 0\\,\\text{Bohr}^{-1}$。\n2. B3LYP 用例：$\\alpha = 0.6\\,\\text{Bohr}^{-2}$，$a_{\\mathrm{g}} = 0.20$，$\\omega = 0\\,\\text{Bohr}^{-1}$。\n3. 容差 $\\tau = 0.1\\,\\mathrm{eV}$ 的调谐 LC-$\\omega$PBE 用例：$\\alpha = 0.6\\,\\text{Bohr}^{-2}$，选择满足 $J_{\\mathrm{SR}}(\\alpha,\\omega)\\cdot 27.211386245988 \\le 0.1$ 的最小 $\\omega \\ge 0$。\n4. 容差 $\\tau = 0.01\\,\\mathrm{eV}$ 的调谐 LC-$\\omega$PBE 用例：$\\alpha = 0.6\\,\\text{Bohr}^{-2}$，选择满足 $J_{\\mathrm{SR}}(\\alpha,\\omega)\\cdot 27.211386245988 \\le 0.01$ 的最小 $\\omega \\ge 0$。\n\n您的程序应生成单行输出，其中包含一个由方括号括起来的、逗号分隔的结果列表。每个测试用例的结果本身应是一个形如 $[I_{\\Delta}, I_{K}, K_{\\mathrm{eV}}, \\omega]$ 的列表，使用上述指定单位，例如\n$[[I_{\\Delta}^{(1)}, I_{K}^{(1)}, K_{\\mathrm{eV}}^{(1)}, \\omega^{(1)}],[I_{\\Delta}^{(2)}, I_{K}^{(2)}, K_{\\mathrm{eV}}^{(2)}, \\omega^{(2)}],\\dots]$。", "solution": "问题陈述已经过评估，并被认为是有效的。它在科学上基于计算化学的原理，特别是密度泛函理论，并且在数学上是适定的。唯一解所需的所有必要参数和定义均已提供。我们开始进行求解。\n\n该问题要求基于一个简化的单轨道模型计算电离势。该模型的核心在于量化剩余的自相互作用误差，该误差表现为能量对电子数曲线中的伪曲率。这个由 $K$ 表示的曲率，会人为地降低预测的电离势。\n\n首先，我们根据所提供的参数确定基本量。轨道宽度参数为 $\\alpha = 0.6\\,\\text{Bohr}^{-2}$。高斯密度的库仑自相互作用能以 Hartree 原子单位给出：\n$$\nJ(\\alpha) = \\sqrt{\\frac{2\\alpha}{\\pi}} = \\sqrt{\\frac{2 \\times 0.6}{\\pi}} = \\sqrt{\\frac{1.2}{\\pi}} \\approx 0.61803399\\,\\mathrm{Hartree}\n$$\n从 Hartree 到电子伏特 ($eV$) 的转换因子是 $C_{Ha \\to eV} = 27.211386245988\\,\\mathrm{eV/Hartree}$。参考电离势为 $I_{\\mathrm{ref}} = 15.7596\\,\\mathrm{eV}$。\n\n剩余曲率 $K$ 与两个电离势代理之间的关系是：\nKoopmans 估计值为 $I_{K} = I_{\\mathrm{ref}} - K_{\\mathrm{eV}}$。\nDelta 自洽场 ($\\Delta$-SCF) 估计值为 $I_{\\Delta} = I_{\\mathrm{ref}} - \\frac{K_{\\mathrm{eV}}}{2}$。\n这里，$K_{\\mathrm{eV}} = K \\times C_{Ha \\to eV}$ 是以电子伏特为单位的曲率。\n\n我们现在将系统地分析四个测试用例中的每一个。\n\n**用例 1：PBE 泛函**\nPerdew–Burke–Ernzerhof (PBE) 泛函是一种广义梯度近似 (GGA)，其精确交换分数为零，因此 $a_{\\mathrm{g}} = 0$。问题指定 $\\omega=0$。对于 GGA，剩余自相互作用曲率是轨道与其自身的完全库仑自相互作用。\n$$\nK_{\\mathrm{PBE}} = J(\\alpha) \\approx 0.61803399\\,\\mathrm{Hartree}\n$$\n转换为电子伏特：\n$$\nK_{\\mathrm{eV}}^{(1)} = K_{\\mathrm{PBE}} \\times C_{Ha \\to eV} \\approx 0.61803399 \\times 27.211386245988 \\approx 16.817923\\,\\mathrm{eV}\n$$\n现在，我们计算电离势：\n$$\nI_{K}^{(1)} = I_{\\mathrm{ref}} - K_{\\mathrm{eV}}^{(1)} = 15.7596 - 16.817923 \\approx -1.058323\\,\\mathrm{eV}\n$$\n$$\nI_{\\Delta}^{(1)} = I_{\\mathrm{ref}} - \\frac{K_{\\mathrm{eV}}^{(1)}}{2} = 15.7596 - \\frac{16.817923}{2} \\approx 7.350638\\,\\mathrm{eV}\n$$\n范围分离参数的值给定为 $\\omega^{(1)} = 0\\,\\text{Bohr}^{-1}$。\n\n**用例 2：B3LYP 泛函**\nBecke 3-parameter Lee–Yang–Parr (B3LYP) 泛函是一种全局杂化泛函。一部分半局域交换被精确 (Hartree-Fock) 交换所取代。这个分数 $a_{\\mathrm{g}} = 0.20$，抵消了相应部分的自相互作用误差。问题指定 $\\omega=0$。\n剩余曲率为：\n$$\nK_{\\mathrm{B3LYP}} = (1 - a_{\\mathrm{g}}) J(\\alpha) = (1 - 0.20) J(\\alpha) = 0.8 \\times J(\\alpha) \\approx 0.49442719\\,\\mathrm{Hartree}\n$$\n以电子伏特计：\n$$\nK_{\\mathrm{eV}}^{(2)} = K_{\\mathrm{B3LYP}} \\times C_{Ha \\to eV} \\approx 0.49442719 \\times 27.211386245988 \\approx 13.454338\\,\\mathrm{eV}\n$$\n相应的电离势为：\n$$\nI_{K}^{(2)} = I_{\\mathrm{ref}} - K_{\\mathrm{eV}}^{(2)} = 15.7596 - 13.454338 \\approx 2.305262\\,\\mathrm{eV}\n$$\n$$\nI_{\\Delta}^{(2)} = I_{\\mathrm{ref}} - \\frac{K_{\\mathrm{eV}}^{(2)}}{2} = 15.7596 - \\frac{13.454338}{2} \\approx 9.032431\\,\\mathrm{eV}\n$$\n范围分离参数的值给定为 $\\omega^{(2)} = 0\\,\\text{Bohr}^{-1}$。\n\n**用例 3：调谐的 LC-$\\omega$PBE 泛函 ($\\tau = 0.1\\,\\mathrm{eV}$)**\n对于具有 $100\\%$ 长程精确交换的长程校正 (LC) 泛函，剩余自相互作用局限于电子-电子相互作用的短程部分。曲率由以下公式给出：\n$$\nK_{\\mathrm{LC}} = J_{\\mathrm{SR}}(\\alpha, \\omega) = J(\\alpha) \\operatorname{erfc}\\!\\left(\\frac{\\omega}{\\sqrt{2\\alpha}}\\right)\n$$\n参数 $\\omega$ 被“调谐”以满足条件 $|I_{\\mathrm{ref}} - I_{K}| \\le \\tau$，这等价于 $K_{\\mathrm{eV}} \\le \\tau$。为了找到满足此条件的最小非负 $\\omega$，我们将曲率设置为其最大允许值，$K_{\\mathrm{eV}}^{(3)} = \\tau = 0.1\\,\\mathrm{eV}$。\n在 $K_{\\mathrm{eV}}^{(3)}$ 固定的情况下，电离势可立即确定：\n$$\nI_{K}^{(3)} = I_{\\mathrm{ref}} - K_{\\mathrm{eV}}^{(3)} = 15.7596 - 0.1 = 15.6596\\,\\mathrm{eV}\n$$\n$$\nI_{\\Delta}^{(3)} = I_{\\mathrm{ref}} - \\frac{K_{\\mathrm{eV}}^{(3)}}{2} = 15.7596 - \\frac{0.1}{2} = 15.7096\\,\\mathrm{eV}\n$$\n为了找到 $\\omega^{(3)}$，我们求解调谐条件：\n$$\nK_{\\mathrm{LC}} \\times C_{Ha \\to eV} = J(\\alpha) \\operatorname{erfc}\\!\\left(\\frac{\\omega^{(3)}}{\\sqrt{2\\alpha}}\\right) \\times C_{Ha \\to eV} = 0.1\\,\\mathrm{eV}\n$$\n重新整理方程可得：\n$$\n\\operatorname{erfc}\\!\\left(\\frac{\\omega^{(3)}}{\\sqrt{2\\alpha}}\\right) = \\frac{0.1}{J(\\alpha) \\times C_{Ha \\to eV}} = \\frac{0.1}{K_{\\mathrm{eV}}^{(1)}} \\approx \\frac{0.1}{16.817923} \\approx 0.0059459\n$$\n我们使用其反函数 $\\mathrm{erfc}^{-1}$ 来求解互补误差函数的参数：\n$$\n\\frac{\\omega^{(3)}}{\\sqrt{2\\alpha}} = \\mathrm{erfc}^{-1}(0.0059459) \\approx 2.24056\n$$\n最后，我们求解 $\\omega^{(3)}$：\n$$\n\\omega^{(3)} = \\sqrt{2\\alpha} \\times 2.24056 = \\sqrt{1.2} \\times 2.24056 \\approx 1.095445 \\times 2.24056 \\approx 2.45447\\,\\text{Bohr}^{-1}\n$$\n\n**用例 4：调谐的 LC-$\\omega$PBE 泛函 ($\\tau = 0.01\\,\\mathrm{eV}$)**\n此用例与前一个类似，但容差更严格，为 $\\tau = 0.01\\,\\mathrm{eV}$。步骤是相同的。\n我们将曲率设置为其最大允许值，$K_{\\mathrm{eV}}^{(4)} = \\tau = 0.01\\,\\mathrm{eV}$。\n电离势为：\n$$\nI_{K}^{(4)} = I_{\\mathrm{ref}} - K_{\\mathrm{eV}}^{(4)} = 15.7596 - 0.01 = 15.7496\\,\\mathrm{eV}\n$$\n$$\nI_{\\Delta}^{(4)} = I_{\\mathrm{ref}} - \\frac{K_{\\mathrm{eV}}^{(4)}}{2} = 15.7596 - \\frac{0.01}{2} = 15.7546\\,\\mathrm{eV}\n$$\n为了找到 $\\omega^{(4)}$，我们求解调谐条件：\n$$\n\\operatorname{erfc}\\!\\left(\\frac{\\omega^{(4)}}{\\sqrt{2\\alpha}}\\right) = \\frac{0.01}{J(\\alpha) \\times C_{Ha \\to eV}} = \\frac{0.01}{K_{\\mathrm{eV}}^{(1)}} \\approx \\frac{0.01}{16.817923} \\approx 0.00059459\n$$\n求解参数：\n$$\n\\frac{\\omega^{(4)}}{\\sqrt{2\\alpha}} = \\mathrm{erfc}^{-1}(0.00059459) \\approx 2.75106\n$$\n最后，我们求解 $\\omega^{(4)}$：\n$$\n\\omega^{(4)} = \\sqrt{2\\alpha} \\times 2.75106 = \\sqrt{1.2} \\times 2.75106 \\approx 1.095445 \\times 2.75106 \\approx 3.01373\\,\\text{Bohr}^{-1}\n$$\n\n这些计算演示了不同的交换相关泛函如何处理自相互作用误差。纯 GGA (PBE) 表现出很大的误差，导致对电离势的严重低估（甚至对 $I_K$ 得到一个没有物理意义的负值）。全局杂化泛函 (B3LYP) 部分地校正了此误差。调谐的 LC 杂化泛函可以系统地消除最高占据轨道的此误差，使 Koopmans 估计值 $I_K$ 任意接近参考值，这就是最佳调谐的原理。", "answer": "```python\nimport numpy as np\nfrom scipy import special\n\ndef solve():\n    \"\"\"\n    Computes model predictions for the first ionization potential of argon\n    using different DFT functional models.\n    \"\"\"\n\n    # --- Constants and Givens ---\n    ALPHA = 0.6  # Gaussian width parameter, in Bohr^-2\n    I_REF = 15.7596  # Reference ionization potential, in eV\n    HARTREE_TO_EV = 27.211386245988  # Conversion factor\n\n    # --- Test Case Definitions ---\n    # (name, a_g, omega, tau)\n    # For PBE and B3LYP, omega is fixed and tau is not used.\n    # For LC-wPBE, tau is used to determine omega.\n    test_cases_params = [\n        {\"name\": \"PBE\", \"a_g\": 0.0, \"omega\": 0.0, \"tau\": None},\n        {\"name\": \"B3LYP\", \"a_g\": 0.20, \"omega\": 0.0, \"tau\": None},\n        {\"name\": \"LC-wPBE_tau_0.1\", \"a_g\": 0.0, \"omega\": None, \"tau\": 0.1},\n        {\"name\": \"LC-wPBE_tau_0.01\", \"a_g\": 0.0, \"omega\": None, \"tau\": 0.01},\n    ]\n\n    # --- Core Calculations ---\n    # Full Coulomb self-interaction energy in Hartree\n    J_alpha = np.sqrt(2 * ALPHA / np.pi)\n    \n    results = []\n\n    for params in test_cases_params:\n        K_ev = 0.0\n        omega = 0.0\n        \n        if params[\"name\"] in [\"PBE\", \"B3LYP\"]:\n            # For global hybrids and GGAs, K is a fraction of J(alpha)\n            K_hartree = (1 - params[\"a_g\"]) * J_alpha\n            K_ev = K_hartree * HARTREE_TO_EV\n            omega = params[\"omega\"]\n        \n        elif params[\"name\"].startswith(\"LC-wPBE\"):\n            # For tuned LC hybrids, K_ev is set by the tolerance tau\n            tau = params[\"tau\"]\n            K_ev = tau\n            \n            # The tuning condition is K_ev = tau, which is equivalent to\n            # J_SR(alpha, omega) * C = tau. We solve this for omega.\n            # J(alpha) * erfc(omega / sqrt(2*alpha)) * C = tau\n            # erfc(omega / sqrt(2*alpha)) = tau / (J(alpha) * C)\n            \n            arg_for_erfcinv = tau / (J_alpha * HARTREE_TO_EV)\n            \n            # Use inverse complementary error function to find the argument\n            erfc_arg = special.erfcinv(arg_for_erfcinv)\n            \n            # omega / sqrt(2*alpha) = erfc_arg\n            # omega = erfc_arg * sqrt(2*alpha)\n            omega = erfc_arg * np.sqrt(2 * ALPHA)\n\n        # Calculate ionization potentials from the residual curvature\n        I_K = I_REF - K_ev\n        I_Delta = I_REF - K_ev / 2.0\n\n        # Store the results for this case in the required format\n        results.append([I_Delta, I_K, K_ev, omega])\n\n    # Format the final output string as specified\n    # The requirement is a list of lists, i.e., [[...],[...]]\n    # str() on a list produces the desired format for each sublist.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "2454313"}, {"introduction": "在处理开壳层体系（如自由基）时，非限制性 Kohn-Sham (UKS) 方法常会遇到自旋污染的问题，即计算得到的自旋平方期望值 $\\langle \\hat{S}^2 \\rangle$ 会偏离其物理上的精确值。泛函中精确交换的比例对此有重要影响，通常更多的精确交换有助于减少自旋污染。此练习 [@problem_id:2454289] 通过一个简化的三电子体系模型，让您探究不同类型的泛函——从全局双杂化到范围分离杂化——如何通过其有效精确交换组分 $a_{\\text{eff}}$ 影响电子轨道的定域化，进而影响自旋纯度。通过这个实践，您可以直观地理解泛函的选择如何直接关系到波函数质量的关键指标。", "problem": "给定一个简约的第一性原理模型，用于在非限制性 Kohn-Sham (UKS) 理论框架下，分析双杂化泛函中精确交换的比例如何影响开壳层自由基阴离子的自旋平方算符的期望值。考虑一个三电子体系，其中在用于自旋-$\\alpha$ 的最小空间轨道基 $\\{\\phi_1, \\phi_2\\}$ 中有 $N_{\\alpha} = 2$ 个电子，在用于自旋-$\\beta$ 的单个占据空间轨道 $\\psi$ 中有 $N_{\\beta} = 1$ 个电子。自旋投影为 $S_z = \\frac{1}{2}$，纯双重态的自旋量子数为 $S = \\frac{1}{2}$。对于任意单个非限制性 Slater行列式，自旋平方期望值的精确恒等式为\n$$\n\\langle \\hat{S}^2 \\rangle = \\frac{3}{4} + N_{\\beta} - \\sum_{i=1}^{N_{\\alpha}} \\sum_{j=1}^{N_{\\beta}} \\left| \\langle \\phi_i^{\\alpha} \\mid \\psi^{\\beta} \\rangle \\right|^2,\n$$\n对于本例，该式可简化为\n$$\n\\langle \\hat{S}^2 \\rangle = \\frac{7}{4} - \\left( \\left| \\langle \\phi_1 \\mid \\psi \\rangle \\right|^2 + \\left| \\langle \\phi_2 \\mid \\psi \\rangle \\right|^2 \\right).\n$$\n假设对自旋-$\\beta$ 轨道采用以下具有物理动机的模型。定义一个与 $\\phi_1$ 和 $\\phi_2$ 都正交的规范正交辅助函数 $\\chi$。将 $\\psi$ 建模为在规范正交基 $\\{\\phi_1, \\chi\\}$ 中表示的 $2 \\times 2$ 对称矩阵的归一化最低能量本征向量\n$$\n\\mathbf{F}(a_{\\mathrm{eff}}) =\n\\begin{pmatrix}\n\\varepsilon_1  V_0 \\left( 1 - a_{\\mathrm{eff}} \\right) \\\\\nV_0 \\left( 1 - a_{\\mathrm{eff}} \\right)  \\varepsilon_{\\chi}\n\\end{pmatrix}\n$$\n且 $\\varepsilon_{\\chi}  \\varepsilon_1$。在此模型中，与 $\\phi_2$ 的重叠为零，即 $\\langle \\phi_2 \\mid \\psi \\rangle = 0$，而与 $\\phi_1$ 的重叠等于 $\\phi_1$ 在 $\\mathbf{F}(a_{\\mathrm{eff}})$ 的归一化最低本征向量中的系数 $c_1(a_{\\mathrm{eff}})$。因此，\n$$\n\\langle \\hat{S}^2 \\rangle = \\frac{7}{4} - \\left| c_1(a_{\\mathrm{eff}}) \\right|^2.\n$$\n有效精确交换分数 $a_{\\mathrm{eff}}$ 取决于所用的泛函：\n- 对于全局双杂化泛函，$a_{\\mathrm{eff}} = a_x$，其中 $a_x \\in [0,1]$ 是全局精确交换分数。\n- 对于范围分离杂化双杂化泛函，使用库仑算符划分来模拟加权平均值\n$$\na_{\\mathrm{eff}}(\\omega, a_{\\mathrm{SR}}, a_{\\mathrm{LR}}, R) = a_{\\mathrm{SR}} \\, \\mathrm{erfc}(\\omega R) + a_{\\mathrm{LR}} \\, \\mathrm{erf}(\\omega R),\n$$\n其中 $\\mathrm{erf}(\\cdot)$ 是误差函数，$\\mathrm{erfc}(\\cdot)$ 是互补误差函数，$\\omega \\ge 0$ 是范围分离参数，$a_{\\mathrm{SR}} \\in [0,1]$ 是短程精确交换分数，$a_{\\mathrm{LR}} \\in [0,1]$ 是长程精确交换分数，而 $R  0$ 是一个特征电子间距。本问题中的所有量均为无量纲量，你必须将所有数值输出报告为四舍五入到六位小数的实数。\n\n使用以下参数集\n$$\n\\varepsilon_1 = 0.0, \\quad \\Delta = \\varepsilon_{\\chi} - \\varepsilon_1 = 2.0, \\quad V_0 = 0.5\n$$\n除非另有说明。对于每种情况，确定 $\\mathbf{F}(a_{\\mathrm{eff}})$ 唯一的归一化最低本征向量，提取 $c_1(a_{\\mathrm{eff}})$，并使用上述恒等式计算 $\\langle \\hat{S}^2 \\rangle$。\n\n测试套件：\n1. 全局双杂化：$a_x = 0.00$, $\\Delta = 2.0$, $V_0 = 0.5$。\n2. 全局双杂化：$a_x = 0.50$, $\\Delta = 2.0$, $V_0 = 0.5$。\n3. 全局双杂化：$a_x = 1.00$, $\\Delta = 2.0$, $V_0 = 0.5$。\n4. 范围分离杂化双杂化：$a_{\\mathrm{SR}} = 0.20$, $a_{\\mathrm{LR}} = 1.00$, $\\omega = 0.30$, $R = 3.0$, $\\Delta = 2.0$, $V_0 = 0.5$。\n5. 范围分离杂化双杂化：$a_{\\mathrm{SR}} = 0.20$, $a_{\\mathrm{LR}} = 1.00$, $\\omega = 10.0$, $R = 3.0$, $\\Delta = 2.0$, $V_0 = 0.5$。\n6. 耦合的边缘情况：全局双杂化，$a_x = 0.00$, $\\Delta = 2.0$, $V_0 = 0.0$。\n\n要求的最终输出格式：\n你的程序应生成单行输出，其中包含与上述六个测试用例相对应的六个 $\\langle \\hat{S}^2 \\rangle$ 结果，按顺序排列，四舍五入至六位小数，并以逗号分隔列表的形式包含在方括号中，例如，「[x1,x2,x3,x4,x5,x6]」。不允许包含任何额外的字符或空格。", "solution": "问题陈述已经过严格验证，在计算化学的简化模型背景下，被确定为是合理、适定且具有科学依据的。它提出了一个清晰、可形式化的任务。\n\n核心目标是计算模型三电子自由基阴离子的自旋平方算符的期望值 $\\langle \\hat{S}^2 \\rangle$。该值可作为非限制性 Kohn-Sham (UKS) 计算中自旋污染的度量。必须对与不同密度泛函近似相对应的几组参数集执行计算。\n\n问题给出了给定体系（$N_{\\alpha}=2$, $N_{\\beta}=1$）的自旋平方期望值的恒等式为\n$$\n\\langle \\hat{S}^2 \\rangle = \\frac{7}{4} - \\left( \\left| \\langle \\phi_1 \\mid \\psi \\rangle \\right|^2 + \\left| \\langle \\phi_2 \\mid \\psi \\rangle \\right|^2 \\right)\n$$\n其中 $\\{\\phi_1, \\phi_2\\}$ 是自旋-$\\alpha$ 电子的空间轨道，$\\psi$ 是单个自旋-$\\beta$ 电子的空间轨道。该模型的一个关键简化是重叠 $\\langle \\phi_2 \\mid \\psi \\rangle$ 为零。这可将表达式简化为\n$$\n\\langle \\hat{S}^2 \\rangle = \\frac{7}{4} - \\left| c_1(a_{\\mathrm{eff}}) \\right|^2\n$$\n其中 $c_1(a_{\\mathrm{eff}}) = \\langle \\phi_1 \\mid \\psi \\rangle$ 是 $\\psi$ 展开式中 $\\phi_1$ 的系数。因此，任务简化为求该系数的模平方 $|c_1(a_{\\mathrm{eff}})|^2$。\n\n该模型将自旋-$\\beta$ 轨道 $\\psi$ 定义为在规范正交基 $\\{\\phi_1, \\chi\\}$ 中表示的 $2 \\times 2$ 对称矩阵 $\\mathbf{F}(a_{\\mathrm{eff}})$ 的最低能量归一化本征向量：\n$$\n\\mathbf{F}(a_{\\mathrm{eff}}) =\n\\begin{pmatrix}\n\\varepsilon_1  V_0 \\left( 1 - a_{\\mathrm{eff}} \\right) \\\\\nV_0 \\left( 1 - a_{\\mathrm{eff}} \\right)  \\varepsilon_{\\chi}\n\\end{pmatrix}\n$$\n这里，$a_{\\mathrm{eff}}$ 是一个取决于泛函类型的有效精确交换分数。令 $V_{\\mathrm{eff}} = V_0(1-a_{\\mathrm{eff}})$ 为非对角耦合项。问题指定了参数 $\\varepsilon_1 = 0$, $\\varepsilon_{\\chi} = \\Delta = 2$ 和 $V_0 = 0.5$。\n\n为了确定 $|c_1(a_{\\mathrm{eff}})|^2$，我们必须求解 $\\mathbf{F}(a_{\\mathrm{eff}})$ 的本征值问题。一个通用的 $2 \\times 2$ 对称矩阵 $\\begin{pmatrix} a  b \\\\ b  d \\end{pmatrix}$ 的本征值 $\\lambda$ 由 $\\lambda_{\\pm} = \\frac{a+d \\pm \\sqrt{(d-a)^2 + 4b^2}}{2}$ 给出。鉴于 $\\varepsilon_{\\chi}  \\varepsilon_1$，最低的本征值为\n$$\n\\lambda_{-} = \\frac{(\\varepsilon_1 + \\varepsilon_{\\chi}) - \\sqrt{(\\varepsilon_{\\chi} - \\varepsilon_1)^2 + 4V_{\\mathrm{eff}}^2}}{2}\n$$\n对应于 $\\lambda_{-}$ 的未归一化本征向量 $\\mathbf{v}_{-}$ 可以写成 $\\begin{pmatrix} V_{\\mathrm{eff}} \\\\ \\lambda_{-} - \\varepsilon_1 \\end{pmatrix}$。对该向量进行归一化，得到在基 $\\{\\phi_1, \\chi\\}$ 中的系数 $c_1$ 和 $c_2$。第一个系数的模平方为\n$$\n|c_1|^2 = \\frac{V_{\\mathrm{eff}}^2}{V_{\\mathrm{eff}}^2 + (\\lambda_{-} - \\varepsilon_1)^2}\n$$\n该公式在 $V_{\\mathrm{eff}} \\neq 0$ 时有效。\n\n当 $V_{\\mathrm{eff}} = 0$ 时会出现一种特殊情况，这种情况发生在 $a_{\\mathrm{eff}}=1$ 或 $V_0=0$ 时。此时，矩阵 $\\mathbf{F}$ 是对角的：\n$$\n\\mathbf{F} =\n\\begin{pmatrix}\n\\varepsilon_1  0 \\\\\n0  \\varepsilon_{\\chi}\n\\end{pmatrix}\n$$\n本征值为 $\\varepsilon_1$ 和 $\\varepsilon_{\\chi}$，对应的本征向量为 $\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ 和 $\\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$。由于问题指定 $\\varepsilon_{\\chi}  \\varepsilon_1$，能量最低的本征向量是 $\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。因此，$\\psi = \\phi_1$，这意味着 $c_1=1$ 且 $|c_1|^2=1$。这对应于一个纯双重态，其 $\\langle \\hat{S}^2 \\rangle = \\frac{7}{4} - 1 = \\frac{3}{4} = 0.75$。我们推导的 $|c_1|^2$ 的通用公式在 $V_{\\mathrm{eff}} \\to 0$ 的极限下正确地趋近于 1。\n\n每个测试用例的计算步骤如下：\n1.  确定 $a_{\\mathrm{eff}}$ 的值。对于全局杂化泛函，$a_{\\mathrm{eff}}=a_x$。对于范围分离杂化泛函，$a_{\\mathrm{eff}} = a_{\\mathrm{SR}} \\, \\mathrm{erfc}(\\omega R) + a_{\\mathrm{LR}} \\, \\mathrm{erf}(\\omega R)$。\n2.  计算有效耦合 $V_{\\mathrm{eff}} = V_0(1-a_{\\mathrm{eff}})$。\n3.  如果 $V_{\\mathrm{eff}}$ 在数值上为零，则设 $|c_1|^2 = 1$。\n4.  否则，计算最低本征值 $\\lambda_{-}$，然后使用推导出的公式计算 $|c_1|^2$。\n5.  最后，计算 $\\langle \\hat{S}^2 \\rangle = 1.75 - |c_1|^2$。\n\n下面的实现遵循此步骤来求解六个指定的测试用例。", "answer": "```python\nimport numpy as np\nfrom scipy.special import erf, erfc\n\ndef solve():\n    \"\"\"\n    Solves the problem for all test cases and prints the results in the required format.\n    \"\"\"\n    \n    # Test cases defined as a list of tuples:\n    # (type, a_x, a_SR, a_LR, omega, R, Delta, V0)\n    # None is used as a placeholder for parameters not relevant to a specific case.\n    test_cases = [\n        # Case 1: Global, a_x = 0.0\n        (\"global\", 0.00, None, None, None, None, 2.0, 0.5),\n        # Case 2: Global, a_x = 0.5\n        (\"global\", 0.50, None, None, None, None, 2.0, 0.5),\n        # Case 3: Global, a_x = 1.0 (decoupled)\n        (\"global\", 1.00, None, None, None, None, 2.0, 0.5),\n        # Case 4: Range-separated, standard parameters\n        (\"range-separated\", None, 0.20, 1.00, 0.30, 3.0, 2.0, 0.5),\n        # Case 5: Range-separated, large omega (limit of a_LR)\n        (\"range-separated\", None, 0.20, 1.00, 10.0, 3.0, 2.0, 0.5),\n        # Case 6: Edge case, V0 = 0 (decoupled)\n        (\"global\", 0.00, None, None, None, None, 2.0, 0.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = calculate_s_squared(case)\n        results.append(f\"{result:.6f}\")\n\n    print(f\"[{','.join(results)}]\")\n\ndef calculate_s_squared(case_params):\n    \"\"\"\n    Calculates the spin-squared expectation value for a single test case.\n    \"\"\"\n    functional_type, a_x, a_SR, a_LR, omega, R, delta, V0 = case_params\n    \n    # Model parameters from problem statement\n    e1 = 0.0\n    e_chi = e1 + delta\n    s2_exact_plus_n_beta = 1.75\n\n    # Step 1: Calculate the effective exact-exchange fraction a_eff\n    if functional_type == \"global\":\n        a_eff = a_x\n    elif functional_type == \"range-separated\":\n        a_eff = a_SR * erfc(omega * R) + a_LR * erf(omega * R)\n    else:\n        # This branch should not be reached with the given test cases.\n        raise ValueError(f\"Unknown functional type: {functional_type}\")\n\n    # Step 2: Calculate the effective coupling V_eff\n    V_eff = V0 * (1.0 - a_eff)\n\n    # Step 3: Calculate the squared coefficient |c1|^2\n    # Handle the special case where coupling is zero.\n    if np.isclose(V_eff, 0.0):\n        # In the uncoupled case (V_eff = 0), the matrix is diagonal.\n        # Since e_chi  e1, the lowest energy state is the pure phi_1 orbital.\n        # Therefore, psi = phi_1 and the coefficient c1 is 1.\n        c1_squared = 1.0\n    else:\n        # For the non-zero coupling case, solve the 2x2 eigenvalue problem.\n        # Matrix is F = [[e1, V_eff], [V_eff, e_chi]]\n        # The lowest eigenvalue is lambda_minus.\n        sqrt_term = np.sqrt((e_chi - e1)**2 + 4 * V_eff**2)\n        lambda_minus = (e1 + e_chi - sqrt_term) / 2.0\n        \n        # The squared coefficient of the first basis function in the lowest eigenvector is:\n        c1_squared = V_eff**2 / (V_eff**2 + (lambda_minus - e1)**2)\n\n    # Step 4: Calculate the spin-squared expectation value\n    s_squared_val = s2_exact_plus_n_beta - c1_squared\n    \n    return s_squared_val\n\nsolve()\n```", "id": "2454289"}]}