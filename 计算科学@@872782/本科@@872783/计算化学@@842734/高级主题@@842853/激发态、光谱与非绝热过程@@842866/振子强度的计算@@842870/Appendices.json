{"hands_on_practices": [{"introduction": "在模拟整个分子之前，理解跃迁性质如何在基本构件（即原子轨道）之间计算是至关重要的。这项练习将指导您完成两个高斯型轨道之间跃迁的振子强度的解析计算，从而阐明计算化学软件的数学基础，以及弥散函数在描述不同类型电子态时的作用。通过直接处理这些核心积分，您将对振子强度的来源获得更深刻的理解 ([@problem_id:2451550])。", "problem": "您将使用归一化的、同中心的、原始笛卡尔高斯型轨道（GTO）来模拟单电子跃迁的电偶极振子强度（以原子单位 a.u. 表示）。初始（基）态是归一化的s-型GTO，最终（激发）态是沿x轴取向的归一化的p-型GTO。s-型基函数定义为$\\phi_{s}(\\mathbf{r};\\alpha)=N_{s}\\exp(-\\alpha r^{2})$，p-型基函数定义为$\\phi_{p_{x}}(\\mathbf{r};\\beta)=N_{p}(x)\\exp(-\\beta r^{2})$，两者均以原点为中心，其中$r=\\|\\mathbf{r}\\|$、$\\alpha>0$和$\\beta>0$。归一化常数$N_{s}$和$N_{p}$分别由条件$\\int_{\\mathbb{R}^{3}}|\\phi_{s}|^{2}\\,d^{3}r=1$和$\\int_{\\mathbb{R}^{3}}|\\phi_{p_{x}}|^{2}\\,d^{3}r=1$确定。在电偶极近似和长度规范下，从基态$\\phi_{s}$到激发态$\\phi_{p_{x}}$的跃迁的振子强度由下式给出：\n$$\nf=\\frac{2}{3}\\,\\Delta E\\,\\left|\\langle \\phi_{s}|\\hat{\\mathbf{r}}|\\phi_{p_{x}}\\rangle\\right|^{2},\n$$\n其中$\\Delta E$是以Hartree为单位的跃迁能量，对于$\\phi_{p_{x}}$终态，偶极矩阵元简化为单个非零笛卡尔分量$\\mu_{x}=\\langle \\phi_{s}|x|\\phi_{p_{x}}\\rangle$。所有积分都在$\\mathbb{R}^{3}$上进行，所有距离都以Bohr为单位。振子强度$f$是无量纲的。您必须通过解析积分从第一性原理出发，计算归一化常数和偶极矩阵元，然后计算$f$。\n\n为研究在基组中包含弥散函数对里德堡跃迁与价跃迁的影响，请使用以下参数：\n- 基态s-型指数：$\\alpha=1.0$（单位$\\text{Bohr}^{-2}$）。\n- 价层p-型指数（紧凑）：$\\beta_{\\text{val}}=1.0$（单位$\\text{Bohr}^{-2}$）。\n- 弥散p-型指数：$\\beta_{\\text{diff}}=0.1$（单位$\\text{Bohr}^{-2}$）。\n- 极弥散p-型指数（边缘情况）：$\\beta_{\\text{vdiff}}=0.05$（单位$\\text{Bohr}^{-2}$）。\n- 价跃迁能量：$\\Delta E_{\\text{val}}=0.3$（单位Hartree）。\n- 里德堡跃迁能量：$\\Delta E_{\\text{ryd}}=0.15$（单位Hartree）。\n- 近阈值里德堡跃迁能量（边缘情况）：$\\Delta E_{\\text{thr}}=0.01$（单位Hartree）。\n\n计算以下五个测试用例的振子强度$f$，每个用例由一对$(\\Delta E,\\beta)$定义，其中$\\alpha=1.0$固定：\n1. 不含弥散函数的价跃迁：$(\\Delta E,\\beta)=\\left(0.3,\\,1.0\\right)$。\n2. 不含弥散函数的里德堡跃迁（仅使用紧凑基组）：$(\\Delta E,\\beta)=\\left(0.15,\\,1.0\\right)$。\n3. 含弥散函数的里德堡跃迁：$(\\Delta E,\\beta)=\\left(0.15,\\,0.1\\right)$。\n4. 含极弥散函数的里德堡跃迁（边缘情况）：$(\\Delta E,\\beta)=\\left(0.15,\\,0.05\\right)$。\n5. 近电离阈值且含弥散函数的里德堡跃迁（边缘情况）：$(\\Delta E,\\beta)=\\left(0.01,\\,0.1\\right)$。\n\n您的程序必须输出一行内容，其中包含这五个案例的振子强度，并严格按照此顺序，以逗号分隔的列表形式包含在方括号中，每个值四舍五入到六位小数。例如，输出格式必须为\n\"[v1,v2,v3,v4,v5]\"\n，其中$v_{k}$表示测试用例$k$的四舍五入后的振子强度。", "solution": "所提出的问题是计算量子化学中一个标准的、适定的练习。它具有科学依据，没有矛盾，并包含得出唯一解所需的所有信息。因此，我们将着手进行推导和计算。\n\n任务是计算基态s-型高斯型轨道（GTO）和激发态$p_x$-型GTO之间的电偶极跃迁的无量纲振子强度$f$。GTO由$\\phi_{s}(\\mathbf{r};\\alpha)=N_{s}\\exp(-\\alpha r^{2})$和$\\phi_{p_{x}}(\\mathbf{r};\\beta)=N_{p}(x)\\exp(-\\beta r^{2})$给出。所有量均采用原子单位（能量为Hartree，长度为Bohr）。\n\n长度规范下的振子强度由以下公式给出：\n$$\nf=\\frac{2}{3}\\,\\Delta E\\,\\left|\\langle \\phi_{s}|\\hat{\\mathbf{r}}|\\phi_{p_{x}}\\rangle\\right|^{2}\n$$\n其中$\\Delta E$是跃迁能量。偶极矩算符为$\\hat{\\mathbf{r}} = x\\hat{i} + y\\hat{j} + z\\hat{k}$。计算分三步进行：轨道归一化、跃迁偶极矩积分的求值，以及最后计算$f$。\n\n首先，我们从第一性原理确定归一化常数$N_s$和$N_p$。\n\ns-型轨道的归一化条件是$\\int_{\\mathbb{R}^{3}} |\\phi_s|^2 d^3r = 1$。代入$\\phi_s$的定义：\n$$\nN_s^2 \\int_{\\mathbb{R}^{3}} \\exp(-2\\alpha r^2) d^3r = 1\n$$\n该积分在笛卡尔坐标系中是可分离的，其中$r^2 = x^2+y^2+z^2$：\n$$\n\\int_{\\mathbb{R}^{3}} \\exp(-2\\alpha r^2) d^3r = \\left( \\int_{-\\infty}^{\\infty} e^{-2\\alpha x^2} dx \\right)^3\n$$\n使用标准高斯积分$\\int_{-\\infty}^{\\infty} e^{-ax^2} dx = \\sqrt{\\pi/a}$，其中$a=2\\alpha$，我们得到：\n$$\n\\int_{\\mathbb{R}^{3}} \\exp(-2\\alpha r^2) d^3r = \\left(\\sqrt{\\frac{\\pi}{2\\alpha}}\\right)^3 = \\left(\\frac{\\pi}{2\\alpha}\\right)^{3/2}\n$$\n因此，$N_s^2 \\left(\\frac{\\pi}{2\\alpha}\\right)^{3/2} = 1$，这给出了归一化常数：\n$$\nN_s = \\left(\\frac{2\\alpha}{\\pi}\\right)^{3/4}\n$$\n$p_x$-型轨道的归一化条件是$\\int_{\\mathbb{R}^{3}} |\\phi_{p_x}|^2 d^3r = 1$：\n$$\nN_p^2 \\int_{\\mathbb{R}^{3}} x^2 \\exp(-2\\beta r^2) d^3r = 1\n$$\n这个积分在笛卡尔坐标系中也是可分离的：\n$$\n\\int_{\\mathbb{R}^{3}} x^2 e^{-2\\beta r^2} d^3r = \\left(\\int_{-\\infty}^{\\infty} x^2 e^{-2\\beta x^2} dx\\right) \\left(\\int_{-\\infty}^{\\infty} e^{-2\\beta y^2} dy\\right) \\left(\\int_{-\\infty}^{\\infty} e^{-2\\beta z^2} dz\\right)\n$$\ny和z上的积分是$\\sqrt{\\pi/(2\\beta)}$。x上的积分形式为$\\int_{-\\infty}^{\\infty} x^2 e^{-ax^2} dx = \\frac{1}{2a}\\sqrt{\\frac{\\pi}{a}}$。当$a=2\\beta$时，该值为$\\frac{1}{4\\beta}\\sqrt{\\frac{\\pi}{2\\beta}}$。三个积分的乘积是：\n$$\n\\left(\\frac{1}{4\\beta}\\sqrt{\\frac{\\pi}{2\\beta}}\\right) \\left(\\sqrt{\\frac{\\pi}{2\\beta}}\\right) \\left(\\sqrt{\\frac{\\pi}{2\\beta}}\\right) = \\frac{1}{4\\beta}\\left(\\frac{\\pi}{2\\beta}\\right)^{3/2}\n$$\n所以，$N_p^2 \\frac{1}{4\\beta}\\left(\\frac{\\pi}{2\\beta}\\right)^{3/2} = 1$，这给出了归一化常数：\n$$\nN_p^2 = 4\\beta \\left(\\frac{2\\beta}{\\pi}\\right)^{3/2} \\implies N_p = \\left(\\frac{128\\beta^5}{\\pi^3}\\right)^{1/4}\n$$\n接下来，我们计算跃迁偶极矩矢量$\\langle \\phi_s | \\hat{\\mathbf{r}} | \\phi_{p_x} \\rangle$。由于对称性，该矢量的y和z分量为零。例如，y分量的被积函数$\\phi_s y \\phi_{p_x} = N_s N_p x y \\exp(-(\\alpha+\\beta)r^2)$是关于y的奇函数，其在整个空间上的积分为零。唯一非零的分量是x分量，$\\mu_x$：\n$$\n\\mu_x = \\langle \\phi_s | x | \\phi_{p_x} \\rangle = \\int_{\\mathbb{R}^{3}} \\phi_s(\\mathbf{r}) x \\phi_{p_x}(\\mathbf{r}) d^3r = N_s N_p \\int_{\\mathbb{R}^{3}} x^2 \\exp(-(\\alpha+\\beta)r^2) d^3r\n$$\n该积分的形式与$p_x$型轨道归一化中的积分相似，只需将$2\\beta$替换为$\\gamma = \\alpha+\\beta$。该积分的值为$\\frac{1}{2\\gamma}\\left(\\frac{\\pi}{\\gamma}\\right)^{3/2} = \\frac{1}{2(\\alpha+\\beta)}\\left(\\frac{\\pi}{\\alpha+\\beta}\\right)^{3/2}$。\n因此，跃迁偶极矩的模方$\\mu_x^2$是上述积分值与归一化常数乘积的平方：\n$$\n\\mu_x^2 = (N_s N_p)^2 \\left[ \\frac{1}{2(\\alpha+\\beta)}\\left(\\frac{\\pi}{\\alpha+\\beta}\\right)^{3/2} \\right]^2 = N_s^2 N_p^2 \\frac{\\pi^3}{4(\\alpha+\\beta)^5}\n$$\n代入$N_s^2$和$N_p^2$的表达式：\n$$\n\\mu_x^2 = \\left(\\frac{2\\alpha}{\\pi}\\right)^{3/2} \\left(4\\beta \\left(\\frac{2\\beta}{\\pi}\\right)^{3/2}\\right) \\frac{\\pi^3}{4(\\alpha+\\beta)^5}\n$$\n化简此表达式可得：\n$$\n\\mu_x^2 = \\frac{(2\\alpha)^{3/2} \\cdot 4\\beta \\cdot (2\\beta)^{3/2}}{\\pi^3} \\frac{\\pi^3}{4(\\alpha+\\beta)^5} = \\frac{2^{3/2}\\alpha^{3/2} \\cdot 4\\beta \\cdot 2^{3/2}\\beta^{3/2}}{4(\\alpha+\\beta)^5} = \\frac{8 \\alpha^{3/2} \\beta^{5/2}}{(\\alpha+\\beta)^5}\n$$\n现在，我们将此结果代入振子强度$f$的公式中，注意到$\\left|\\langle \\phi_{s}|\\hat{\\mathbf{r}}|\\phi_{p_{x}}\\rangle\\right|^{2} = \\mu_x^2$：\n$$\nf = \\frac{2}{3} \\Delta E \\mu_x^2 = \\frac{2}{3} \\Delta E \\left( \\frac{8 \\alpha^{3/2} \\beta^{5/2}}{(\\alpha+\\beta)^5} \\right) = \\frac{16}{3} \\Delta E \\frac{\\alpha^{3/2} \\beta^{5/2}}{(\\alpha+\\beta)^5}\n$$\n这是最终的解析表达式。对于所有测试用例，给定$\\alpha=1.0$。公式简化为：\n$$\nf = \\frac{16}{3} \\Delta E \\frac{\\beta^{5/2}}{(1.0+\\beta)^5}\n$$\n我们现在将此公式应用于指定的五个测试用例。\n\n用例 1：$(\\Delta E, \\beta) = (0.3, 1.0)$\n$f_1 = \\frac{16}{3} (0.3) \\frac{1.0^{5/2}}{(1.0+1.0)^5} = 1.6 \\frac{1}{32} = 0.05$。\n结果：$0.050000$\n\n用例 2：$(\\Delta E, \\beta) = (0.15, 1.0)$\n$f_2 = \\frac{16}{3} (0.15) \\frac{1.0^{5/2}}{(1.0+1.0)^5} = 0.8 \\frac{1}{32} = 0.025$。\n结果：$0.025000$\n\n用例 3：$(\\Delta E, \\beta) = (0.15, 0.1)$\n$f_3 = \\frac{16}{3} (0.15) \\frac{0.1^{5/2}}{(1.0+0.1)^5} = 0.8 \\frac{0.1^{2.5}}{1.1^5} \\approx 0.00157088$。\n结果：$0.001571$\n\n用例 4：$(\\Delta E, \\beta) = (0.15, 0.05)$\n$f_4 = \\frac{16}{3} (0.15) \\frac{0.05^{5/2}}{(1.0+0.05)^5} = 0.8 \\frac{0.05^{2.5}}{1.05^5} \\approx 0.00035041$。\n结果：$0.000350$\n\n用例 5：$(\\Delta E, \\beta) = (0.01, 0.1)$\n$f_5 = \\frac{16}{3} (0.01) \\frac{0.1^{5/2}}{(1.0+0.1)^5} \\approx 0.00010473$。\n结果：$0.000105$\n\n这些计算证明了空间弥散的基函数（小$\\beta$值）对于描述里德堡态的重要性。跃迁到类里德堡态的振子强度（用例3、4、5）显著小于类价态跃迁的振子强度（用例1），这反映了紧凑的基态和弥散的激发态之间空间重叠的减少。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates oscillator strengths for one-electron transitions between\n    s-type and p-type Gaussian orbitals based on a derived analytical formula.\n    \"\"\"\n    \n    # The ground state s-type GTO exponent is fixed.\n    alpha = 1.0\n\n    # Test cases are defined as tuples of (Delta_E, beta).\n    # Delta_E is the transition energy in Hartree.\n    # beta is the exponent of the final p-type GTO in Bohr^-2.\n    test_cases = [\n        # Case 1: Valence transition, compact basis\n        (0.3, 1.0),\n        # Case 2: Rydberg transition, compact basis\n        (0.15, 1.0),\n        # Case 3: Rydberg transition, diffuse basis\n        (0.15, 0.1),\n        # Case 4: Rydberg transition, very diffuse basis\n        (0.15, 0.05),\n        # Case 5: Near-threshold Rydberg transition, diffuse basis\n        (0.01, 0.1)\n    ]\n\n    results = []\n    for case in test_cases:\n        delta_E, beta = case\n        \n        # The analytical formula for the oscillator strength 'f' is:\n        # f = (16/3) * delta_E * (alpha^(3/2) * beta^(5/2)) / (alpha + beta)^5\n        # Since alpha is fixed at 1.0, the formula simplifies.\n        \n        numerator = (16.0 / 3.0) * delta_E * np.power(beta, 2.5)\n        denominator = np.power(alpha + beta, 5.0)\n        \n        f = numerator / denominator\n        \n        # Format the result to six decimal places as a string.\n        results.append(f\"{f:.6f}\")\n\n    # Final print statement in the exact required format: [v1,v2,v3,v4,v5]\n    print(f\"[{','.join(results)}]\")\n\n# Execute the main function.\nsolve()\n```", "id": "2451550"}, {"introduction": "线性多烯是理解共轭体系电子性质的经典教科书案例。本练习使用简洁的休克尔模型来探究一个基本问题：随着共轭链的增长，主要电子跃迁的强度如何变化？通过完成这项练习 ([@problem_id:2451614])，您将深入了解分子尺寸与光学性质之间的关系，这是材料科学和染料化学中的一个核心概念。", "problem": "考虑线性多烯系列$H-(CH=CH)_n-H$，它被建模为一个由$N$个碳$p_z$轨道组成的一维共轭链，其中$N=2n$且$n$为正整数。请使用以下第一性原理模型和定义。\n\n- 在标准正交原子轨道基中，使用单电子最近邻Hückel哈密顿量（紧束缚哈密顿量）对$\\pi$-电子体系进行建模。其中哈密顿矩阵$\\mathbf{H}$的矩阵元为$H_{ij}=\\alpha\\,\\delta_{ij}+\\beta\\,(\\delta_{i,j+1}+\\delta_{i,j-1})$，适用于格点$i,j\\in\\{1,\\dots,N\\}$。计算在原子单位（a.u.）下进行，其中基本电荷、电子质量、约化普朗克常数和玻尔半径均设为$1$。使用$\\alpha=0$和$\\beta=-1$（能量单位为哈特里）。\n- 将原子沿$x$轴共线排列，间距均匀，为$a=1$（单位为玻尔），并将链的中心置于原点。因此，对于格点索引$i\\in\\{1,\\dots,N\\}$，其位置为$x_i=a\\,(i-(N+1)/2)$。\n- 设归一化的单电子分子轨道$\\{\\psi_k\\}_{k=1}^N$为$\\mathbf{H}$的标准正交本征向量，其对应的本征值为$\\{E_k\\}_{k=1}^N$，按能量非递减顺序排列。对于具有$N$个电子（每个碳原子提供一个$\\pi$-电子）且每个空间轨道填充两个自旋相反电子的闭壳层基态，最高已占分子轨道（HOMO）的索引为$k_{\\mathrm{H}}=N/2$，最低未占分子轨道（LUMO）的索引为$k_{\\mathrm{L}}=N/2+1$。\n- 定义跃迁能$\\Delta E=E_{k_{\\mathrm{L}}}-E_{k_{\\mathrm{H}}}$（单位为哈特里），以及HOMO和LUMO之间沿$x$轴的长度规范下的跃迁偶极矩为$\\mu_x=\\langle \\psi_{k_{\\mathrm{L}}}|\\hat{x}|\\psi_{k_{\\mathrm{H}}}\\rangle=\\sum_{i=1}^{N} c_{i,k_{\\mathrm{L}}}\\,c_{i,k_{\\mathrm{H}}}\\,x_i$，其中$c_{i,k}$是轨道$k$中格点$i$的系数。在原子单位下，此单电子跃迁的振子强度为\n$$\nf=\\frac{2}{3}\\,\\Delta E\\,|\\mu_x|^2,\n$$\n它是无量纲的。\n\n任务：对于每个指定的链长，使用上述定义计算HOMO–LUMO跃迁的振子强度$f$。\n\n测试组：\n- 使用五个链长$n\\in\\{1,2,3,5,10\\}$，对应于$N=2n\\in\\{2,4,6,10,20\\}$。\n- 每个输出必须是一个浮点数，表示在上述模型下给定$n$的振子强度$f$。\n\n最终输出格式：\n- 您的程序必须生成单行输出，其中包含一个用方括号括起来的、逗号分隔的五个振子强度的列表，顺序与上面给出的$n$的顺序相同，每个值都四舍五入到恰好六位小数。例如，一个可接受的格式是$[0.123456,0.234567,0.345678,0.456789,0.567890]$。\n- 振子强度$f$是无量纲的，因此不需要物理单位。", "solution": "问题陈述已解析和验证。我们发现它具有科学依据、提法恰当且自洽。这是Hückel分子轨道理论应用中的一个标准练习，该理论是理论有机化学的基石。所提供的模型、定义和参数是内部一致的，并允许存在唯一解。因此，我们可以进行推导和计算。\n\n该系统是一个由$N$个格点组成的线性链，由一维最近邻紧束缚哈密顿量描述。在原子轨道基中，其矩阵元由$H_{ij}=\\alpha\\,\\delta_{ij}+\\beta\\,(\\delta_{i,j+1}+\\delta_{i,j-1})$给出。使用指定的参数$\\alpha=0$和$\\beta=-1$（以原子单位计），哈密顿矩阵$\\mathbf{H}$是一个实对称三对角矩阵：\n$$\n\\mathbf{H} =\n\\begin{pmatrix}\n0  & -1 & 0 & \\dots & 0 \\\\\n-1 & 0 & -1 & \\dots & 0 \\\\\n0 & -1 & 0 & \\dots & 0 \\\\\n\\vdots & \\vdots & \\vdots & \\ddots & \\vdots \\\\\n0 & 0 & 0 & \\dots & 0\n\\end{pmatrix}_{N \\times N}\n$$\n这是一个线性代数中的标准问题，其本征值和本征向量具有已知的解析解。\n\n非简并本征值$E_k$由下式给出：\n$$\nE_k = \\alpha + 2\\beta \\cos\\left(\\frac{k\\pi}{N+1}\\right)\n$$\n对于$\\alpha=0$和$\\beta=-1$，上式简化为：\n$$\nE_k = -2 \\cos\\left(\\frac{k\\pi}{N+1}\\right) \\quad \\text{for } k=1, 2, \\dots, N\n$$\n由于$\\cos(x)$在$x \\in [0, \\pi]$区间内是递减函数，因此能级$E_k$随量子数$k$非递减排列。\n\n代表分子轨道$\\psi_k$的归一化本征向量由其在原子轨道基$\\{\\phi_i\\}_{i=1}^N$中的系数$c_{i,k}$给出。第$k$个分子轨道中第$i$个原子轨道的系数是：\n$$\nc_{i,k} = \\sqrt{\\frac{2}{N+1}} \\sin\\left(\\frac{ik\\pi}{N+1}\\right) \\quad \\text{for } i,k=1, 2, \\dots, N\n$$\n\n问题考虑的是一个具有$N$个电子的闭壳层基态，其中$N=2n$是一个偶数。电子占据能量最低的$N/2$个轨道，每个轨道有两个电子。\n最高已占分子轨道（HOMO）对应的索引是$k_{\\mathrm{H}} = N/2$。\n最低未占分子轨道（LUMO）对应的索引是$k_{\\mathrm{L}} = N/2 + 1$。\n\nHOMO-LUMO跃迁能$\\Delta E$是它们能量的差值：\n$$\n\\Delta E = E_{k_{\\mathrm{L}}} - E_{k_{\\mathrm{H}}} = E_{N/2+1} - E_{N/2}\n$$\n代入$E_k$的表达式：\n$$\n\\Delta E = -2 \\cos\\left(\\frac{(N/2+1)\\pi}{N+1}\\right) - \\left(-2 \\cos\\left(\\frac{(N/2)\\pi}{N+1}\\right)\\right) = 2\\left[\\cos\\left(\\frac{N\\pi}{2(N+1)}\\right) - \\cos\\left(\\frac{(N+2)\\pi}{2(N+1)}\\right)\\right]\n$$\n使用三角恒等式$\\cos(A) - \\cos(B) = -2 \\sin\\left(\\frac{A+B}{2}\\right) \\sin\\left(\\frac{A-B}{2}\\right)$，我们发现：\n$$\n\\frac{A+B}{2} = \\frac{\\pi}{2(N+1)}\\left(\\frac{N}{2} + \\frac{N+2}{2}\\right) = \\frac{\\pi(N+1)}{2(N+1)} = \\frac{\\pi}{2}\n$$\n$$\n\\frac{A-B}{2} = \\frac{\\pi}{2(N+1)}\\left(\\frac{N}{2} - \\frac{N+2}{2}\\right) = \\frac{-\\pi}{2(N+1)}\n$$\n因此，\n$$\n\\Delta E = 2\\left[-2 \\sin\\left(\\frac{\\pi}{2}\\right) \\sin\\left(-\\frac{\\pi}{2(N+1)}\\right)\\right] = 4 \\sin\\left(\\frac{\\pi}{2(N+1)}\\right)\n$$\n这是一个关于HOMO-LUMO能隙的紧凑解析表达式。\n\n接下来，我们计算沿链轴的跃迁偶极矩$\\mu_x$。链的中心在原点，原子间距$a=1$。第$i$个原子的位置是$x_i = i - (N+1)/2$。\n$$\n\\mu_x = \\langle \\psi_{k_{\\mathrm{L}}} | \\hat{x} | \\psi_{k_{\\mathrm{H}}} \\rangle = \\sum_{i=1}^{N} c_{i,k_{\\mathrm{L}}} c_{i,k_{\\mathrm{H}}} x_i\n$$\n代入系数$c_{i,k}$和位置$x_i$的表达式：\n$$\n\\mu_x = \\sum_{i=1}^{N} \\left(\\sqrt{\\frac{2}{N+1}} \\sin\\left(\\frac{ik_{\\mathrm{L}}\\pi}{N+1}\\right)\\right) \\left(\\sqrt{\\frac{2}{N+1}} \\sin\\left(\\frac{ik_{\\mathrm{H}}\\pi}{N+1}\\right)\\right) \\left(i - \\frac{N+1}{2}\\right)\n$$\n$$\n\\mu_x = \\frac{2}{N+1} \\sum_{i=1}^{N} \\sin\\left(\\frac{i(N/2+1)\\pi}{N+1}\\right) \\sin\\left(\\frac{i(N/2)\\pi}{N+1}\\right) \\left(i - \\frac{N+1}{2}\\right)\n$$\n这个求和必须对每个$N$值进行计算。虽然存在闭合形式的解，但对于所需的这些不大的$N$值，直接进行数值求和是简单且精确的。\n\n最后，使用在原子单位下提供的公式计算无量纲振子强度$f$：\n$$\nf = \\frac{2}{3} \\Delta E |\\mu_x|^2\n$$\n由于分子轨道和位置都是实数，$\\mu_x$也是实数，因此$|\\mu_x|^2 = \\mu_x^2$。\n\n计算步骤是为每个指定的$n \\in \\{1, 2, 3, 5, 10\\}$值（对应于$N=2n \\in \\{2, 4, 6, 10, 20\\}$）实现这些解析公式，以求得振子强度$f$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the oscillator strength for the HOMO-LUMO transition in linear\n    polyenes H-(CH=CH)n-H using the Hückel model.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases_n = [1, 2, 3, 5, 10]\n\n    results = []\n    for n in test_cases_n:\n        # Number of carbon atoms/p_z orbitals.\n        N = 2 * n\n\n        # HOMO and LUMO quantum numbers (1-based index).\n        k_H = N // 2\n        k_L = N // 2 + 1\n\n        # 1. Calculate the transition energy Delta_E.\n        # The analytical formula is Delta_E = 4 * sin(pi / (2 * (N + 1))).\n        delta_E = 4.0 * np.sin(np.pi / (2.0 * (N + 1.0)))\n\n        # 2. Calculate the transition dipole moment mu_x.\n        # mu_x = sum_{i=1 to N} c_{i,k_L} * c_{i,k_H} * x_i\n        # c_{i,k} = sqrt(2/(N+1)) * sin(i*k*pi/(N+1))\n        # The normalization factor (sqrt(2/(N+1)))^2 is pulled out of the sum.\n        norm_factor_squared = 2.0 / (N + 1.0)\n        \n        mu_x_sum = 0.0\n        for i in range(1, N + 1):\n            # Position of site i, centered at the origin.\n            x_i = float(i) - (N + 1.0) / 2.0\n            \n            # Arguments for the sine functions.\n            arg_H = (float(i) * float(k_H) * np.pi) / (N + 1.0)\n            arg_L = (float(i) * float(k_L) * np.pi) / (N + 1.0)\n            \n            # Product of coefficients (without normalization) and position.\n            term = np.sin(arg_L) * np.sin(arg_H) * x_i\n            mu_x_sum += term\n            \n        mu_x = norm_factor_squared * mu_x_sum\n\n        # 3. Calculate the oscillator strength f.\n        # f = (2/3) * Delta_E * |mu_x|^2\n        f = (2.0 / 3.0) * delta_E * mu_x**2\n        results.append(f)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join([f'{res:.6f}' for res in results])}]\")\n\nsolve()\n```", "id": "2451614"}, {"introduction": "休克尔模型的应用范围不仅限于中性分子，还包括带电物质，它们是有机化学中的关键反应中间体。这项练习 ([@problem_id:2451592]) 要求您将该模型应用于具有相同碳骨架的碳负离子和碳正离子，并比较它们的光学响应。这种比较分析揭示了控制这些相关离子电子结构的微妙而重要的原理，例如在交替烃中存在的粒子-空穴对称性。", "problem": "你需要实现一个完整且可运行的程序，该程序为基于相同线性共轭碳骨架构建的碳负离子和碳正离子，模拟其最低偶极允许电子跃迁的振子强度。该模拟必须基于一个最小化的*Hückel*紧束缚描述，其中每个碳位点有一个$p_z$原子轨道、存在最近邻耦合，并采用长度规范下的独立粒子电偶极近似。你必须从基本原理出发来论证算法选择，而不是使用现成的公式。目标是为每个指定的碳骨架，计算相应碳负离子和碳正离子的最低偶极允许跃迁的振子强度，并输出阴离子的值与阳离子的值之比。\n\n你必须使用的基本原理：\n- 非相对论、含时微扰理论，包括长度规范下的电偶极相互作用，以及根据定态间跃迁概率定义的振子强度。\n- 一个用于描述$\\pi$-电子的单粒子独立电子模型，该模型由线性链上的*Hückel*哈密顿量描述，具有零微分重叠和均匀的最近邻耦合。\n- 从闭壳层基态出发的自旋匹配单重激发（即，单个已占轨道到虚轨道的激发的自旋匹配组合），以形成能量最低的偶极允许激发态。如果需要，请清楚解释在独立粒子图像中自旋如何影响跃迁偶极矩。\n- 沿着链方向的单电子位置算符，并对偶极积分采用*对角*原子轨道近似，从而使矩阵元简化为对所有位点的坐标加权和。使用链的几何中心作为原点，以避免无关紧要的原点偏移。\n\n需要实现的模型和数值规范：\n- 全程使用原子单位（能量单位为哈特里(Hartree)，长度单位为Bohr）。振子强度是无量纲的。\n- 考虑一个由$N$个碳位点组成的线性链，沿$x$轴排列，均匀间距为$a$（单位为Bohr）。位点坐标为 $x_i = \\left(i-\\frac{N+1}{2}\\right) a$，其中 $i \\in \\{1,\\dots,N\\}$；假设对所有$i$，都有$y_i=z_i=0$。\n- 在原子轨道基下，*Hückel*哈密顿量为：$H_{ii} = \\alpha$，$H_{ij} = \\beta$（如果$|i-j|=1$），其他情况$H_{ij}=0$。使用$\\alpha=0$和$\\beta=-0.2$（单位为哈特里）。\n- 假设每个碳贡献一个$\\pi$-电子。因此，对于一个有$N$个位点的骨架，碳负离子有$N+1$个$\\pi$-电子，碳正离子有$N-1$个$\\pi$-电子。限制$N$为奇数，以确保两者都是闭壳层结构（有$\\frac{N\\pm 1}{2}$个双占据轨道）。\n- 通过对角化具有零重叠（$S = I$）的哈密顿量来构建分子轨道。对单电子偶极积分使用对角近似，以便在分子轨道基下，沿$x$方向的已占轨道到虚轨道的跃迁偶极分量是所有位点的坐标加权和。\n- 枚举所有单个已占轨道到虚轨道的激发，计算它们的激发能，并找出偶极允许的（在数值容差范围内跃迁偶极矩非零）最低能量跃迁。对于该跃迁，计算闭壳层基态与相应的自旋匹配单激发态之间的振子强度。\n\n需要计算和报告的内容：\n- 对于下面测试套件中指定的每个骨架，分别计算碳正离子和碳负离子的最低允许跃迁的振子强度，然后报告该骨架的比值 $r = f_{\\text{anion}}/f_{\\text{cation}}$。\n- 你的程序必须为以下测试套件计算这些比值（每个案例都是一个独立的骨架）：\n  - 案例1：$N=3$，$a=2.6$ 玻尔。\n  - 案例2：$N=5$，$a=2.6$ 玻尔。\n  - 案例3：$N=7$，$a=2.6$ 玻尔。\n  - 案例4：$N=3$，$a=1.0$ 玻尔。\n  - 案例5：$N=3$，$a=4.0$ 玻尔。\n- 最终输出格式必须是一个单行，包含一个Python风格的列表，按顺序排列五个比值，每个比值都呈现为四舍五- 入到小数点后恰好六位的浮点数，且没有空格。例如，输出必须类似于 $[r_1,r_2,r_3,r_4,r_5]$，如 $[1.234000,2.000000,3.141593,0.500000,0.250000]$。\n\n注释和约束：\n- 振子强度是无量纲的；因此，它们不需要物理单位。当你使用任何长度或能量时，必须使用上文指定的原子单位。\n- 不使用角度。如果在任何地方需要表示百分比，请用小数或分数表示，但此处不需要百分比。\n- 你的程序必须是完整且可直接运行的，不得需要任何输入，也不得进行任何文件输入/输出。唯一的输出必须是上文所述的单行要求。", "solution": "所述问题是有效的。它提出了一个定义明确的计算任务，该任务基于量子化学的既定原理，特别是Hückel分子轨道理论和含时微扰理论。所有必需的物理和数值参数都已提供，模型近似已明确指定，并且问题没有科学上的不准确、矛盾或模糊之处。这是将基础理论应用于具体物理系统的一次严谨实践。\n\n我们的任务是计算由长度为$N$的线性共轭碳链衍生的碳负离子和碳正离子中，最低偶极允许电子跃迁的振子强度之比 $r = f_{\\text{anion}}/f_{\\text{cation}}$。按要求，分析从第一性原理出发。\n\n首先，我们使用Hückel分子轨道（HMO）模型描述电子结构。对于一个由$N$个碳原子组成的线性链，我们考虑每个位点$i$上的一个$p_z$原子轨道（AO），$|\\phi_i\\rangle$。在此AO基下，Hückel哈密顿矩阵$\\mathbf{H}$是在在位能为零（$\\alpha=0$）和均匀最近邻耦合参数$\\beta$的假设下构建的。因此，矩阵元为：\n$$ H_{ij} = \\begin{cases} 0 & \\text{if } i=j \\\\ \\beta & \\text{if } |i-j|=1 \\\\ 0 & \\text{otherwise} \\end{cases} $$\n在零重叠近似（$S_{ij} = \\delta_{ij}$）下，分子轨道（MO）$|\\psi_k\\rangle$及其对应的能量$\\epsilon_k$通过求解本征值问题$\\mathbf{H}\\mathbf{C} = \\mathbf{C}\\mathbf{E}$得到，其中$\\mathbf{E}$是MO能量$\\epsilon_k$的对角矩阵，$\\mathbf{C}$是MO系数$C_{ik}$的矩阵。第$k$个MO表示为AO的线性组合：$|\\psi_k\\rangle = \\sum_{i=1}^N C_{ik} |\\phi_i\\rangle$。对$\\mathbf{H}$进行数值对角化可提供这些能量和系数。\n\n根据构造原理，通过用可用的$\\pi$-电子填充MO来构建每个物种的电子基态。问题指定$N$为奇数，以确保碳正离子（有$N_e = N-1$个电子）和碳负离子（有$N_e = N+1$个电子）都是闭壳层物种。\n- 对于有$N-1$个电子的碳正离子，能量最低的$(N-1)/2$个MO是双占据的。因此，最高已占分子轨道（HOMO）是$|\\psi_k\\rangle$，其轨道指数为$k = (N-1)/2$；最低未占分子轨道（LUMO）是$|\\psi_{k+1}\\rangle$，其指数为$k+1 = (N+1)/2$。\n- 对于有$N+1$个电子的碳负离子，能量最低的$(N+1)/2$个MO是双占据的。HOMO是$|\\psi_k\\rangle$，其轨道指数为$k = (N+1)/2$；LUMO是$|\\psi_{k+1}\\rangle$，其指数为$k+1 = (N+3)/2$。\n（注意：此处，轨道指数$k$是在数学意义上使用的，$k=1, \\dots, N$。在实现中，这些将被映射到从零开始的数组索引）。\n\n对于从初态$|\\Psi_0\\rangle$到末态$|\\Psi_f\\rangle$的电偶极允许跃迁，其振子强度$f_{0 \\to f}$在原子单位下由以下公式给出：\n$$ f_{0 \\to f} = \\frac{2}{3} \\Delta E_{0f} |\\langle \\Psi_f | \\hat{\\mathbf{r}} | \\Psi_0 \\rangle|^2 $$\n其中$\\Delta E_{0f}$是激发能，$\\langle \\Psi_f | \\hat{\\mathbf{r}} | \\Psi_0 \\rangle$是跃迁偶极矩。对于从闭壳层基态$|\\Psi_0\\rangle$到自旋匹配的单重态单激发态$|{}^1\\Psi_i^a\\rangle$（由电子从MO $|\\psi_i\\rangle$激发到$|\\psi_a\\rangle$产生）的跃迁，其跃迁偶极矩由Slater-Condon规则给出。关于自旋的关键点是，偶极算符是自旋无关的，只允许在相同自旋多重度的态之间发生跃迁。从单重态基态出发，只允许跃迁到单重态激发态。到归一化的自旋匹配单重态$|{}^1\\Psi_i^a\\rangle = \\frac{1}{\\sqrt{2}}(|\\det(\\dots \\psi_i\\bar{\\psi}_a \\dots)\\rangle - |\\det(\\dots \\bar{\\psi}_i\\psi_a \\dots)\\rangle)$的矩阵元计算结果为$\\langle {}^1\\Psi_i^a | \\hat{\\mathbf{r}} | \\Psi_0 \\rangle = \\sqrt{2} \\langle \\psi_a | \\hat{\\mathbf{r}}_1 | \\psi_i \\rangle$，其中$\\hat{\\mathbf{r}}_1$是单电子位置算符。因子$\\sqrt{2}$解释了从单个行列式基矢形成单重态的两种等效方式。\n\n将此代入$f$的公式，并注意到我们的体系是沿$x$轴的一维体系，对于$i \\to a$跃迁的振子强度变为：\n$$ f_{i \\to a} = \\frac{2}{3} \\Delta E_{ia} \\left( |\\sqrt{2} \\langle \\psi_a | \\hat{x}_1 | \\psi_i \\rangle|^2 \\right) = \\frac{4}{3} \\Delta E_{ia} |\\mu_{x,ia}|^2 $$\n其中$\\mu_{x,ia} = \\langle \\psi_a | \\hat{x}_1 | \\psi_i \\rangle$是沿$x$方向的单电子跃迁偶极矩。在Hückel模型中，激发能是MO能量之差：$\\Delta E_{ia} = \\epsilon_a - \\epsilon_i$。\n\n为了计算$\\mu_{x,ia}$，我们使用题目提供的在AO基下的偶极矩阵元的对角近似，$\\langle \\phi_p | \\hat{x}_1 | \\phi_q \\rangle \\approx x_p \\delta_{pq}$，其中$x_p = (p - (N+1)/2)a$是位点$p$的坐标。这将积分简化为对原子位点的求和：\n$$ \\mu_{x,ia} = \\sum_{p,q=1}^N C_{qa}^* C_{pi} \\langle \\phi_q | \\hat{x}_1 | \\phi_p \\rangle \\approx \\sum_{p=1}^N C_{pa} C_{pi} x_p $$\n（假设系数$C_{pk}$为实数）。\n\n能量最低的激发是HOMO $\\to$ LUMO跃迁。对于具有反演对称性的线性链，MO具有确定的宇称。MO $|\\psi_k\\rangle$的宇称为$(-1)^{k-1}$。位置算符$\\hat{x}$具有奇宇称。只有当被积函数整体具有偶宇称时，跃迁偶极矩$\\mu_{x,ia}$才非零，这要求$|\\psi_i\\rangle$和$|\\psi_a\\rangle$的宇称不同（$g \\leftrightarrow u$）。对于阳离子和阴离子，HOMO和LUMO的指数都相差一，$k \\to k+1$，因此它们总是具有相反的宇称。因此，HOMO $\\to$ LUMO跃迁是偶极允许的，并且是我们必须考虑的能量最低的允许跃迁。\n\n对于像线性链这样的交替体系，Hückel模型的一个关键特性是粒子-空穴对称性。MO能量关于$\\alpha=0$对称。对于奇数$N$的链，在能量$\\epsilon=0$处存在一个非键轨道。阳离子的HOMO $\\to$ LUMO跃迁是从非键轨道正下方的轨道到非键轨道本身。阴离子的HOMO $\\to$ LUMO跃迁是从非键轨道到其正上方的轨道。由于对称的能谱，$\\epsilon_{k_{\\text{LUMO,cat}}} - \\epsilon_{k_{\\text{HOMO,cat}}} = \\epsilon_{k_{\\text{LUMO,an}}} - \\epsilon_{k_{\\text{HOMO,an}}}$。因此，$\\Delta E_{\\text{cation}} = \\Delta E_{\\text{anion}}$。\n\n这极大地简化了比值$r$：\n$$ r = \\frac{f_{\\text{anion}}}{f_{\\text{cation}}} = \\frac{\\frac{4}{3} \\Delta E_{\\text{anion}} |\\mu_{x,\\text{anion}}|^2}{\\frac{4}{3} \\Delta E_{\\text{cation}} |\\mu_{x,\\text{cation}}|^2} = \\frac{|\\mu_{x,\\text{anion}}|^2}{|\\mu_{x,\\text{cation}}|^2} $$\n此外，由于$x_p \\propto a$，跃迁矩$\\mu_x \\propto a$。跃迁矩的平方$\\mu_x^2 \\propto a^2$。因子$a^2$同时出现在分子和分母中并相互抵消。因此，比值$r$与$\\beta$和$a$均无关，仅取决于位点数$N$。\n\n所实现的算法是此分析的直接转换：\n1. 对于给定的$N$，构建$N \\times N$的Hückel哈密顿矩阵$\\mathbf{H}$。\n2. 对$\\mathbf{H}$进行数值对角化，以获得MO能量和系数矩阵$\\mathbf{C}$。\n3. 对于阳离子，确定HOMO和LUMO的指数，提取相应的MO系数向量，并计算$\\mu_{x,\\text{cation}} = \\sum_p C_{p, \\text{LUMO}} C_{p, \\text{HOMO}} x_p$。\n4. 对于阴离子，对$\\mu_{x,\\text{anion}}$执行类似的计算。\n5. 计算比值$r = (\\mu_{x,\\text{anion}} / \\mu_{x,\\text{cation}})^2$。由于能量差和键长`a`相互抵消，它们不需要在最终比值计算中使用，尽管它们是完整振子强度表达式的一部分。为保证概念清晰，该实现将在计算比值前先计算完整的振子强度。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of calculating the ratio of oscillator strengths for\n    carbanions and carbocations on linear conjugated carbon skeletons.\n    \"\"\"\n\n    def calculate_oscillator_strength_ratio(N, a, beta):\n        \"\"\"\n        Calculates the ratio f_anion / f_cation for a given skeleton.\n\n        Args:\n            N (int): The number of carbon sites in the linear chain.\n            a (float): The uniform spacing between sites in Bohr.\n            beta (float): The Hückel coupling parameter in Hartree.\n\n        Returns:\n            float: The ratio of oscillator strengths.\n        \"\"\"\n        # 1. Define system parameters\n        # Atom site indices p run from 1 to N, so Python indices run from 0 to N-1\n        site_indices = np.arange(1, N + 1)\n        # Atomic coordinates x_p, centered at the origin\n        x_coords = (site_indices - (N + 1) / 2.0) * a\n\n        # 2. Construct the Hückel Hamiltonian matrix\n        H = np.zeros((N, N))\n        for i in range(N - 1):\n            H[i, i + 1] = beta\n            H[i + 1, i] = beta\n        # Diagonal elements are alpha=0 by default\n\n        # 3. Solve the eigenvalue problem to get MO energies and coefficients\n        # np.linalg.eigh returns eigenvalues (energies) sorted in increasing order\n        # and corresponding eigenvectors (coefficients) as columns of C.\n        energies, C = np.linalg.eigh(H)\n\n        # 4. Calculation for the Carbocation (N-1 electrons)\n        # Number of occupied orbitals is (N-1)/2. Python index for HOMO is (N-1)/2 - 1.\n        homo_idx_cat = (N - 1) // 2 - 1\n        lumo_idx_cat = (N - 1) // 2\n        \n        # Get MO coefficients for HOMO and LUMO\n        Ci_cat = C[:, homo_idx_cat]\n        Ca_cat = C[:, lumo_idx_cat]\n\n        # Excitation energy\n        delta_E_cat = energies[lumo_idx_cat] - energies[homo_idx_cat]\n\n        # Transition dipole moment along x-axis\n        mu_x_cat = np.sum(Ci_cat * Ca_cat * x_coords)\n\n        # Oscillator strength\n        # f = (4/3) * dE * mu^2\n        f_cation = (4.0 / 3.0) * delta_E_cat * mu_x_cat**2\n\n        # 5. Calculation for the Carbanion (N+1 electrons)\n        # Number of occupied orbitals is (N+1)/2. Python index for HOMO is (N+1)/2 - 1.\n        homo_idx_an = (N + 1) // 2 - 1\n        lumo_idx_an = (N + 1) // 2\n        \n        # Get MO coefficients for HOMO and LUMO\n        Ci_an = C[:, homo_idx_an]\n        Ca_an = C[:, lumo_idx_an]\n        \n        # Excitation energy\n        delta_E_an = energies[lumo_idx_an] - energies[homo_idx_an]\n        \n        # Transition dipole moment\n        mu_x_an = np.sum(Ci_an * Ca_an * x_coords)\n        \n        # Oscillator strength\n        f_anion = (4.0 / 3.0) * delta_E_an * mu_x_an**2\n        \n        # 6. Compute and return the ratio\n        if f_cation == 0:\n            # Avoid division by zero, although it shouldn't happen for these systems\n            return np.nan\n        \n        ratio = f_anion / f_cation\n        return ratio\n\n    # Model parameters from the problem statement\n    beta = -0.2  # Hartree\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (3, 2.6),  # Case 1\n        (5, 2.6),  # Case 2\n        (7, 2.6),  # Case 3\n        (3, 1.0),  # Case 4\n        (3, 4.0),  # Case 5\n    ]\n\n    results = []\n    for N, a in test_cases:\n        ratio = calculate_oscillator_strength_ratio(N, a, beta)\n        # Format to exactly six decimal places as a string\n        results.append(f\"{ratio:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2451592"}]}