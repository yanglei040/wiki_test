{"hands_on_practices": [{"introduction": "本章节的第一个练习将深入探讨非绝热过程的数学核心。通过分析一个简化的但功能强大的$\\text{H}_3^+$阳离子模型，您将发现一个基本原理：并非所有的原子核运动都是平等的。本练习将引导您通过第一性原理推导，理解为何某些振动模式（耦合模式）能够诱导电子跃迁，而其他模式（调谐模式）则不能，这是一个植根于分子对称性的关键区别。[@problem_id:2453334]", "problem": "考虑点群为 $\\mathrm{D}_{3h}$ 的等边三角形构型下的三原子阳离子 H$_3^+$。在此构型附近，用线性振动耦合哈密顿量，在非绝热基 $\\{\\,|E_x\\rangle, |E_y\\rangle\\,\\}$ 中，模拟构成双重简并的 $\\mathrm{E}'$ 不可约表示的两个最低电子态：\n$$\n\\hat{H}_{\\mathrm{d}}(\\mathbf{q}) \\;=\\; \\left(E_0 + \\alpha\\, q_s\\right)\\,\\hat{I}\n\\;+\\;\n\\begin{pmatrix}\n\\dfrac{\\Delta}{2} & k\\,(q_x - i\\,q_y) \\\\\nk\\,(q_x + i\\,q_y) & -\\dfrac{\\Delta}{2}\n\\end{pmatrix},\n$$\n其中 $\\mathbf{q}=(q_x,q_y,q_s)$，$(q_x,q_y)$ 对是按照简并的 $\\mathrm{e}'$ 振动模式变换的简正坐标，$q_s$ 是全对称的 $\\mathrm{a}_1'$ 简正坐标，$\\hat{I}$ 是非绝热电子子空间上的单位算符，$E_0$ 是一个常数参考能量，$\\alpha$ 和 $k$ 是实数振动耦合常数，$\\Delta \\ge 0$ 是一个实参数。\n\n令绝热电子态 $\\{\\,|\\psi_+(\\mathbf{q})\\rangle,\\,|\\psi_-(\\mathbf{q})\\rangle\\,\\}$ 为 $\\hat{H}_{\\mathrm{d}}(\\mathbf{q})$ 的归一化本征态，其本征值分别为 $E_+(\\mathbf{q})$ 和 $E_-(\\mathbf{q})$。将沿着核坐标 $q_\\mu$ 的非对角非绝热导数耦合元定义为\n$$\nd_{+-}^{(\\mu)}(\\mathbf{q}) \\;=\\; \\langle \\psi_+(\\mathbf{q}) \\,|\\, \\partial/\\partial q_\\mu \\,|\\, \\psi_-(\\mathbf{q}) \\rangle.\n$$\n\n仅使用上述给定的信息和第一性原理推断，确定沿着全对称位移 $q_s$ 的非绝热导数耦合分量 $d_{+-}^{(s)}(\\mathbf{q})$ 的精确解析表达式，并用参数 $\\Delta$、$k$、$\\alpha$、$E_0$ 和坐标 $(q_x,q_y,q_s)$ 表示。将最终答案表示为单个闭合形式的表达式。不需要进行数值近似。不要包含任何单位。", "solution": "该问题要求确定沿着全对称坐标 $q_s$ 的非绝热导数耦合元 $d_{+-}^{(s)}(\\mathbf{q})$。该量定义为：\n$$\nd_{+-}^{(s)}(\\mathbf{q}) \\;=\\; \\langle \\psi_+(\\mathbf{q}) \\,|\\, \\frac{\\partial}{\\partial q_s} \\,|\\, \\psi_-(\\mathbf{q}) \\rangle\n$$\n其中 $|\\psi_+(\\mathbf{q})\\rangle$ 和 $|\\psi_-(\\mathbf{q})\\rangle$ 是所给定的非绝热哈密顿量 $\\hat{H}_{\\mathrm{d}}(\\mathbf{q})$ 的绝热电子本征态，分别对应于本征值 $E_+(\\mathbf{q})$ 和 $E_-(\\mathbf{q})$。\n\n严谨的分析必须从哈密顿算符的结构开始。给定的哈密顿量为：\n$$\n\\hat{H}_{\\mathrm{d}}(\\mathbf{q}) \\;=\\; \\left(E_0 + \\alpha\\, q_s\\right)\\,\\hat{I}\n\\;+\\;\n\\begin{pmatrix}\n\\dfrac{\\Delta}{2} & k\\,(q_x - i\\,q_y) \\\\\nk\\,(q_x + i\\,q_y) & -\\dfrac{\\Delta}{2}\n\\end{pmatrix}\n$$\n该算符可以分解为两个不同的项。第一项 $ (E_0 + \\alpha\\, q_s)\\,\\hat{I} $ 是一个标量算符，是 $2 \\times 2$ 单位算符 $\\hat{I}$ 的倍数。该项仅依赖于坐标 $q_s$。第二项是一个矩阵算符，它只依赖于坐标 $q_x$ 和 $q_y$。让我们将这第二项记为 $\\hat{V}(q_x, q_y)$：\n$$\n\\hat{V}(q_x, q_y) \\;=\\;\n\\begin{pmatrix}\n\\dfrac{\\Delta}{2} & k\\,(q_x - i\\,q_y) \\\\\nk\\,(q_x + i\\,q_y) & -\\dfrac{\\Delta}{2}\n\\end{pmatrix}\n$$\n完整的哈密顿量于是可以简洁地表示为如下的和：\n$$\n\\hat{H}_{\\mathrm{d}}(\\mathbf{q}) \\;=\\; \\left(E_0 + \\alpha\\, q_s\\right)\\,\\hat{I} \\;+\\; \\hat{V}(q_x, q_y)\n$$\n根据定义，绝热电子态 $|\\psi_\\pm(\\mathbf{q})\\rangle$ 是 $\\hat{H}_{\\mathrm{d}}(\\mathbf{q})$ 的本征矢量。线性算符的一个基本性质决定了 $\\hat{H}_{\\mathrm{d}}(\\mathbf{q})$ 的本征矢量与 $\\hat{V}(q_x, q_y)$ 的本征矢量相同。这是因为与单位算符成正比的项 $(E_0 + \\alpha q_s)\\hat{I}$ 与任何算符都对易，因此它只会将 $\\hat{V}(q_x, q_y)$ 的本征值平移一个常数量 $(E_0 + \\alpha q_s)$，而不会影响相应的本征矢量。\n具体来说，如果 $|\\phi\\rangle$ 是 $\\hat{V}(q_x, q_y)$ 的本征矢量，其本征值为 $\\lambda_V$，使得 $\\hat{V}(q_x, q_y) |\\phi\\rangle = \\lambda_V |\\phi\\rangle$，那么它在完整哈密顿量作用下的结果是：\n$$\n\\hat{H}_{\\mathrm{d}}(\\mathbf{q}) |\\phi\\rangle \\;=\\; \\left(E_0 + \\alpha\\, q_s\\right)\\hat{I}|\\phi\\rangle \\;+\\; \\hat{V}(q_x, q_y) |\\phi\\rangle \\;=\\; \\left(E_0 + \\alpha\\, q_s\\right) |\\phi\\rangle \\;+\\; \\lambda_V |\\phi\\rangle \\;=\\; \\left(E_0 + \\alpha\\, q_s + \\lambda_V \\right) |\\phi\\rangle\n$$\n这表明 $|\\phi\\rangle$ 也是 $\\hat{H}_{\\mathrm{d}}(\\mathbf{q})$ 的本征矢量。\n\n因此，绝热本征态 $|\\psi_\\pm(\\mathbf{q})\\rangle$ 仅由矩阵 $\\hat{V}(q_x, q_y)$ 的对角化决定。由于 $\\hat{V}(q_x, q_y)$ 的矩阵元仅仅是 $q_x$ 和 $q_y$ 的函数，它的本征矢量也必定仅仅是 $q_x$ 和 $q_y$ 的函数。因此，绝热态对坐标 $q_s$ 没有函数依赖性。我们可以理所当然地将 $|\\psi_\\pm(\\mathbf{q})\\rangle$ 更精确地写作 $|\\psi_\\pm(q_x, q_y)\\rangle$。\n\n有了这一关键的洞察，我们现在可以计算非绝热导数耦合 $d_{+-}^{(s)}(\\mathbf{q})$ 的表达式。我们将绝热态的正确函数依赖关系代入定义中：\n$$\nd_{+-}^{(s)}(\\mathbf{q}) \\;=\\; \\langle \\psi_+(q_x, q_y) \\,|\\, \\frac{\\partial}{\\partial q_s} \\,|\\, \\psi_-(q_x, q_y) \\rangle\n$$\n偏导数算符 $\\frac{\\partial}{\\partial q_s}$ 作用于右矢 $|\\psi_-(q_x, q_y)\\rangle$。正如我们已经确定的，这个矢量不依赖于变量 $q_s$，因此它对 $q_s$ 的偏导数恒等于零：\n$$\n\\frac{\\partial}{\\partial q_s} \\,|\\, \\psi_-(q_x, q_y) \\rangle \\;=\\; \\mathbf{0}\n$$\n其中 $\\mathbf{0}$ 代表电子希尔伯特空间中的零矢量。\n将此结果代回到耦合元的表达式中，得到最终答案：\n$$\nd_{+-}^{(s)}(\\mathbf{q}) \\;=\\; \\langle \\psi_+(q_x, q_y) \\,|\\, \\mathbf{0} \\rangle \\;=\\; 0\n$$\n这个结果是精确的，并且对于坐标空间中的所有点 $\\mathbf{q}$ 以及参数 $E_0$、$\\alpha$、$k$ 和 $\\Delta$ 的所有可能值都成立。其物理原因是，全对称坐标 $q_s$ 起到一个“调谐”模式的作用，它同等地平移两个势能面的能量，但不会在非绝热态之间引入任何耦合。因此，它不能在最终得到的绝热态之间引起任何非绝热耦合。", "answer": "$$\n\\boxed{0}\n$$", "id": "2453334"}, {"introduction": "从抽象模型转向一个真实的化学实例，这个练习聚焦于乙烯，它是理解光化学的基石分子。您将把势能面和锥形交叉点的抽象概念与具体的分子结构联系起来。通过比较乙烯在其基态、激发态以及锥形交叉点处的几何构型，您将培养出关于分子如何在不同电子态之间穿梭的关键化学直觉。[@problem_id:2453340]", "problem": "在光激发和内转换的情况下，乙烯可以围绕碳-碳双键发生扭转。设$\\phi$表示两个$\\ce{CH2}$局部$\\pi$体系之间的二面角（即围绕碳-碳键的扭转），其中$\\phi=0^\\circ$对应于平面构型，$\\phi=90^\\circ$对应于正交的$\\pi$体系。设$\\theta$表示碳原子上的锥化角，定义为偏离三角平面性的平面外角度，其中$\\theta=0^\\circ$表示一个平面的$\\ce{sp^2}$中心。定性地考虑乙烯沿扭转路径的基态最小值（$S_0$）、第一单重激发态最小值（$S_1$）以及连接$S_1$和$S_0$的最小能量锥形交叉点（MECI）的平衡几何构型。\n\n哪个选项最能比较这三种结构中$\\phi$和$\\theta$的特征值以及碳-碳键长的变化模式？\n\nA. $S_0$最小值：$\\phi\\approx 0^\\circ$, $\\theta\\approx 0^\\circ$，碳-碳键相对较短；$S_1$最小值：$\\phi\\approx 90^\\circ$, $\\theta\\approx 0^\\circ$，碳-碳键拉长；$S_1/S_0$ MECI：$\\phi\\approx 90^\\circ$，至少一个碳原子上有显著的$\\theta>0$，碳-碳键长与$S_1$最小值处相似或略短。\n\nB. $S_0$最小值：$\\phi\\approx 90^\\circ$, $\\theta\\approx 0^\\circ$；$S_1$最小值：$\\phi\\approx 0^\\circ$, $\\theta\\approx 0^\\circ$；$S_1/S_0$ MECI：平面构型，$\\phi\\approx 45^\\circ$且$\\theta\\approx 0^\\circ$。\n\nC. $S_0$最小值、$S_1$最小值和$S_1/S_0$ MECI均为平面构型，$\\phi\\approx 0^\\circ$且$\\theta\\approx 0^\\circ$，仅在碳-碳键长上有所不同。\n\nD. $S_0$最小值和$S_1$最小值均为平面构型，$\\phi\\approx 0^\\circ$且$\\theta\\approx 0^\\circ$；$S_1/S_0$ MECI出现在线性几何构型下，$\\phi\\approx 180^\\circ$且无锥化。\n\nE. $S_0$最小值：$\\phi\\approx 0^\\circ$, $\\theta\\approx 0^\\circ$；$S_1$最小值：$\\phi\\approx 90^\\circ$，两个碳原子上都有显著的锥化$\\theta>0$；$S_1/S_0$ MECI：$\\phi\\approx 90^\\circ$，两个碳原子上都$\\theta\\approx 0^\\circ$（无锥化）。", "solution": "首先将对问题陈述进行严格验证。\n\n### 步骤1：提取已知条件\n- **分子**：乙烯（$\\ce{C2H4}$）\n- **过程**：光激发和内转换后，围绕碳-碳双键的扭转。\n- **几何参数**：\n    - $\\phi$：两个$\\ce{CH2}$局部$\\pi$体系之间的二面角。$\\phi=0^\\circ$为平面；$\\phi=90^\\circ$为正交。\n    - $\\theta$：碳原子上的锥化角。$\\theta=0^\\circ$是一个平面的$\\ce{sp^2}$中心。\n- **关注的结构**：\n    1. 基态最小值（$S_0$）\n    2. 第一单重激发态最小值（$S_1$）\n    3. 连接$S_1$和$S_0$的最小能量锥形交叉点（MECI）。\n- **问题**：比较这三种结构中$\\phi$、$\\theta$的特征值以及碳-碳键长。\n\n### 步骤2：使用提取的已知条件进行验证\n该问题描述了乙烯光化学动力学的经典模型，这是计算化学和物理有机化学中的一个基石性课题。\n- **科学依据**：$S_0$和$S_1$势能面、扭转和锥化运动以及锥形交叉点的存在等概念，在科学文献中是基础且公认的。该描述在物理上和化学上都是合理的。\n- **问题明确**：该问题要求在势能面上的特定、有物理意义的点（两个最小值点和一个MECI点）上，对明确定义的几何参数进行定性比较。基于分子轨道理论和电子结构计算，存在唯一的定性解。术语$\\phi$和$\\theta$定义清晰。\n- **客观性**：语言是技术性的，没有主观性。\n\n### 步骤3：结论与行动\n问题陈述在科学上是合理的、问题明确、无歧义，并且与计算化学领域直接相关。因此，该问题是**有效的**。我将继续推导解决方案。\n\n### 推导\n\n分析基于最高已占分子轨道（HOMO，即$\\pi$成键轨道）和最低未占分子轨道（LUMO，即$\\pi^*$反键轨道）随扭转角$\\phi$变化的行为。\n\n1.  **基态最小值 ($S_0$)**：\n    在电子基态（$S_0$）下，电子构型为$(\\pi)^2$。为了最大化形成$\\pi$键的两个$p$轨道之间的重叠，分子必须是平面的。这对应于二面角$\\phi=0^\\circ$。在此构型中，碳原子是三角平面的，并且是$\\ce{sp^2}$杂化的，这意味着没有锥化。因此，$\\theta=0^\\circ$。同时存在$\\sigma$键和完整的$\\pi$键，形成了特征性的碳-碳双键，该键相对较短且较强。\n    $S_0$最小值总结：$\\phi \\approx 0^\\circ$，$\\theta \\approx 0^\\circ$，短C-C键。\n\n2.  **第一单重激发态最小值 ($S_1$)**：\n    光激发后，一个电子从$\\pi$轨道跃迁到$\\pi^*$轨道，形成电子构型为$(\\pi)^1(\\pi^*)^1$的$S_1$态。$\\pi^*$轨道是反键轨道。在初始的平面Franck-Condon几何构型（$\\phi=0^\\circ$）下，该电子构型导致净$\\pi$键级为零，显著削弱了C-C键。体系将通过弛豫来最小化其能量。\n    当分子围绕C-C键扭转（$\\phi$增加）时，$p$轨道之间的重叠减少。这会提高成键$\\pi$轨道的能量，并且关键地，会降低反键$\\pi^*$轨道的能量。当单占据的$\\pi^*$轨道上的稳定化效应最大时，$S_1$态的总能量达到最小值。这发生在$\\phi=90^\\circ$时，此时两个$p$轨道正交，$\\pi$和$\\pi^*$轨道变成简并的非键轨道，$\\pi$成键的概念消失。\n    在这个$S_1$最小值点，几何构型扭转了$\\phi=90^\\circ$。连接碳原子的键现在基本上是一个纯$\\sigma$键，导致其与$S_0$最小值相比显著拉长。在这种几何构型下，没有内在的电子原因导致$\\ce{CH2}$基团发生锥化；它们基本上保持平面。\n    $S_1$最小值总结：$\\phi \\approx 90^\\circ$，$\\theta \\approx 0^\\circ$，拉长的C-C键。\n\n3.  **最小能量锥形交叉点 ($S_1/S_0$ MECI)**：\n    锥形交叉（CI）是两个电子态之间的简并点。对于含有两个以上原子的分子，非交叉规则规定，具有相同自旋多重度的两个态不能交叉，除非几何构型提供了至少两个独立的坐标，沿着这两个坐标可以解除简并。这两个方向定义了“分支空间”。张成这个空间的矢量是梯度差矢量和非绝热耦合矢量。\n    在乙烯中，扭转的$\\phi=90^\\circ$几何构型使得$S_1$和$S_0$态的能量相近，但它们尚未简并。在$\\phi=90^\\circ$时，$S_0$态是一个双自由基单重态，而$S_1$态在某些坐标系下是两性离子态，但其性质随几何构型而变。为实现精确简并，需要一种额外的几何畸变来耦合这两个态。这种耦合坐标是一种不对称的锥化和摇摆运动。因此，MECI的几何构型特点是既有扭转（$\\phi \\approx 90^\\circ$），又在一个或两个碳原子上有显著的锥化（$\\theta > 0$）。这通常被称为“扭转-锥化”结构。MECI处的C-C键长仍具有单键特征，与$S_1$最小值处的键长非常相似，因为此时几何构型尚未弛豫到平面的、具有双键的$S_0$结构。\n\n    $S_1/S_0$ MECI总结：$\\phi \\approx 90^\\circ$，$\\theta > 0$，拉长的C-C键（与$S_1$最小值相似）。\n\n### 选项分析\n\n- **A. $S_0$最小值：$\\phi\\approx 0^\\circ$, $\\theta\\approx 0^\\circ$，碳-碳键相对较短；$S_1$最小值：$\\phi\\approx 90^\\circ$, $\\theta\\approx 0^\\circ$，碳-碳键拉长；$S_1/S_0$ MECI：$\\phi\\approx 90^\\circ$，至少一个碳原子上有显著的$\\theta>0$，碳-碳键长与$S_1$最小值处相似或略短。**\n  该陈述正确描述了具有双键的平面基态。它正确地将$S_1$最小值识别为扭转但基本上非锥化的构型，具有拉长的类单键。它正确地将MECI描述为扭转-锥化的结构，这是实现简并所必需的，其键长与$S_1$最小值相当。这一描述与已建立的理论完全一致。\n  **结论：正确。**\n\n- **B. $S_0$最小值：$\\phi\\approx 90^\\circ$, $\\theta\\approx 0^\\circ$；$S_1$最小值：$\\phi\\approx 0^\\circ$, $\\theta\\approx 0^\\circ$；$S_1/S_0$ MECI：平面构型，$\\phi\\approx 45^\\circ$且$\\theta\\approx 0^\\circ$。**\n  这从根本上是错误的。$S_0$最小值是平面的（$\\phi=0^\\circ$），而不是扭转的。$S_1$最小值是扭转的（$\\phi=90^\\circ$），而不是平面的。MECI是扭转和锥化的，而不是在$\\phi=45^\\circ$时的平面构型。\n  **结论：错误。**\n\n- **C. $S_0$最小值、$S_1$最小值和$S_1/S_0$ MECI均为平面构型，$\\phi\\approx 0^\\circ$且$\\theta\\approx 0^\\circ$，仅在碳-碳键长上有所不同。**\n  这是错误的。它完全忽略了扭转运动在$S_1$势能面上弛豫的关键作用，以及锥化在形成锥形交叉点中的关键作用。没有这些非平面畸变，光化学反应就不会像实际那样发生。\n  **结论：错误。**\n\n- **D. $S_0$最小值和$S_1$最小值均为平面构型，$\\phi\\approx 0^\\circ$且$\\theta\\approx 0^\\circ$；$S_1/S_0$ MECI出现在线性几何构型下，$\\phi\\approx 180^\\circ$且无锥化。**\n  这是错误的。$S_1$最小值不是平面的。乙烯的线性几何构型在能量上是不利的，与此过程无关。$\\phi=180^\\circ$在几何上与$\\phi=0^\\circ$相同。\n  **结论：错误。**\n\n- **E. $S_0$最小值：$\\phi\\approx 0^\\circ$, $\\theta\\approx 0^\\circ$；$S_1$最小值：$\\phi\\approx 90^\\circ$ with substantial pyramidalization $\\theta>0$ at both carbons; $S_1/S_0$ MECI: $\\phi\\approx 90^\\circ$ with $\\theta\\approx 0^\\circ$ at both carbons (no pyramidalization).**\n  这个选项错误地调换了锥化在$S_1$最小值和MECI中的作用。$S_1$最小值是扭转的但没有显著锥化（$\\theta \\approx 0^\\circ$）。MECI的存在*需要*锥化（$\\theta > 0$）。一个$\\phi=90^\\circ$且$\\theta=0^\\circ$的结构是$S_1$最小值，而不是MECI。\n  **结论：错误。**", "answer": "$$\\boxed{A}$$", "id": "2453340"}, {"introduction": "最后一个练习将从理论和概念过渡到直接的计算应用，这是现代化学的一项核心技能。您将实现一种广泛使用的数值方法，来定位一个模型系统的最小能量锥形交叉点（MECI）。这个动手编程练习填补了理论模型与实际研究之间的鸿沟，展示了化学家如何通过计算来精确定位那些主导超快光化学反应的几何“漏斗”。[@problem_id:2453357]", "problem": "考虑一个双态线性振动耦合模型，用于描述由两个质量加权简正坐标 $q_g$ 和 $q_h$（均为无量纲）张成的分支平面中的锥形交叉。透热哈密顿量 $H(q_g,q_h)$ 是一个 $2 \\times 2$ 的实对称矩阵，其矩阵元为\n$$\nH(q_g,q_h) = \\begin{pmatrix}\nV_{11}(q_g,q_h) & V_{12}(q_g,q_h) \\\\\nV_{12}(q_g,q_h) & V_{22}(q_g,q_h)\n\\end{pmatrix},\n$$\n其中透热势由下式给出\n$$\nV_{11}(q_g,q_h) = \\tfrac{1}{2}\\kappa_g q_g^2 + \\tfrac{1}{2}\\kappa_h q_h^2 + \\tfrac{\\Delta}{2} + k_g q_g + k_h q_h,\n$$\n$$\nV_{22}(q_g,q_h) = \\tfrac{1}{2}\\kappa_g q_g^2 + \\tfrac{1}{2}\\kappa_h q_h^2 - \\tfrac{\\Delta}{2} - k_g q_g - k_h q_h,\n$$\n$$\nV_{12}(q_g,q_h) = c_0 + c_g q_g + c_h q_h,\n$$\n所有能量单位均为电子伏特。绝热能量 $E_1(q_g,q_h)$ 和 $E_2(q_g,q_h)$（单位为电子伏特）被定义为 $H(q_g,q_h)$ 的排序后的本征值，满足 $E_1 \\le E_2$。当能隙 $G(q_g,q_h) = E_2 - E_1$ 为零时，出现锥形交叉。最小能量锥形交叉点（MECI）是交叉集上的一点，该点使平均绝热能量 $\\bar{E}(q_g,q_h) = \\tfrac{1}{2}(E_1 + E_2)$ 最小化，能量单位均为电子伏特。\n\n要求您实现一种数值罚函数法，通过最小化标量目标函数来定位 MECI\n$$\nF(q_g,q_h;\\mu) = \\bar{E}(q_g,q_h) + \\mu \\, \\big(E_2(q_g,q_h) - E_1(q_g,q_h)\\big)^2,\n$$\n其中 $\\mu \\ge 0$ 是一个罚权重。对于每个测试用例，您的程序必须从指定的初始猜测值 $(q_g^{(0)}, q_h^{(0)})$ 开始，对 $F$ 进行二维无约束数值最小化，并返回优化后的坐标 $(q_g^\\star, q_h^\\star)$、相应的优化平均能量 $\\bar{E}^\\star = \\bar{E}(q_g^\\star,q_h^\\star)$（单位为电子伏特）以及残余能隙 $G^\\star = E_2(q_g^\\star,q_h^\\star)$ $- E_1(q_g^\\star,q_h^\\star)$（单位为电子伏特）。\n\n您应依赖的基础理论：\n- Born–Oppenheimer 框架及其在简并点附近的破缺，其中绝热能量被定义为由核坐标参数化的电子哈密顿量的本征值。\n- 锥形交叉的概念，即绝热能隙 $G$ 为零的点，以及 MECI 作为此交叉集上的最低能量点。\n- 用于最小化标量目标函数的数值优化原理。\n\n请以通用方式实现该算法，并将其应用于以下科学上合理且自洽的测试套件。所有能量必须以电子伏特表示，所有坐标均为无量纲的质量加权简正坐标。不涉及角度。您的程序应在最终输出中将每个报告的浮点数量四舍五入到六位小数。\n\n使用以下两个参数集：\n\n- 参数集 A：$\\kappa_g = 1.0$, $\\kappa_h = 1.2$, $\\Delta = 0.05$, $k_g = 0.6$, $k_h = -0.2$, $c_0 = 0.02$, $c_g = 0.4$, $c_h = -0.3$。\n- 参数集 B：$\\kappa_g = 0.8$, $\\kappa_h = 1.1$, $\\Delta = -0.08$, $k_g = 0.5$, $k_h = 0.1$, $c_0 = 0.03$, $c_g = 0.2$, $c_h = 0.25$。\n\n测试套件（每个测试由 $(\\text{参数集}, \\mu, q_g^{(0)}, q_h^{(0)})$ 定义）：\n1. $(\\text{A}, 50.0, 0.0, 0.0)$\n2. $(\\text{A}, 1.0, 0.5, -0.5)$\n3. $(\\text{A}, 0.0, 0.0, 0.0)$\n4. $(\\text{B}, 100.0, 0.0, 0.0)$\n\n对于每个测试用例，输出列表 $[q_g^\\star, q_h^\\star, \\bar{E}^\\star, G^\\star]$，所有四个条目均四舍五入到六位小数。您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，每个测试用例的结果本身也是一个用方括号括起来的逗号分隔列表。例如，输出格式必须是\n\"[ [qg1,qh1,Eavg1,gap1],[qg2,qh2,Eavg2,gap2],... ]\" 但不含空格，即：\n\"[[qg1,qh1,Eavg1,gap1],[qg2,qh2,Eavg2,gap2],...]\"。", "solution": "特此确认问题陈述的有效性。该问题在计算化学的标准线性振动耦合（LVC）模型框架内具有科学依据，是适定、客观且内容完整的。所有提供的参数和条件在物理上和数学上都是一致的。我们可以开始求解。\n\n问题的核心是为一个由透热哈密顿矩阵 $H(q_g,q_h)$ 描述的双态系统寻找最小能量锥形交叉点（MECI）。MECI 是核坐标空间 $(q_g, q_h)$ 中的一个点，在该点上两个绝热电子态发生简并，$E_1 = E_2$，并且该点的能量在所有此类简并点中是最低的。\n\n首先，我们必须推导出目标函数中涉及的量的解析表达式。绝热能量 $E_1$ 和 $E_2$ 是 $2 \\times 2$ 实对称哈密顿矩阵的本征值：\n$$\nH(q_g,q_h) = \\begin{pmatrix}\nV_{11}(q_g,q_h) & V_{12}(q_g,q_h) \\\\\nV_{12}(q_g,q_h) & V_{22}(q_g,q_h)\n\\end{pmatrix}\n$$\n这种矩阵的本征值由标准公式给出：\n$$\nE_{1,2} = \\frac{V_{11} + V_{22}}{2} \\pm \\frac{1}{2}\\sqrt{(V_{11} - V_{22})^2 + 4V_{12}^2}\n$$\n根据定义，$E_1 \\le E_2$。因此，平均绝热能量 $\\bar{E}$ 和能隙 $G$ 分别为：\n$$\n\\bar{E}(q_g,q_h) = \\frac{E_1 + E_2}{2} = \\frac{V_{11} + V_{22}}{2}\n$$\n$$\nG(q_g,q_h) = E_2 - E_1 = \\sqrt{(V_{11} - V_{22})^2 + 4V_{12}^2}\n$$\n接下来，我们将问题陈述中提供的透热势的具体形式代入。\n对于平均能量 $\\bar{E}$：\n$$\nV_{11} + V_{22} = \\left(\\tfrac{1}{2}\\kappa_g q_g^2 + \\tfrac{1}{2}\\kappa_h q_h^2 + \\tfrac{\\Delta}{2} + k_g q_g + k_h q_h\\right) + \\left(\\tfrac{1}{2}\\kappa_g q_g^2 + \\tfrac{1}{2}\\kappa_h q_h^2 - \\tfrac{\\Delta}{2} - k_g q_g - k_h q_h\\right)\n$$\n$$\nV_{11} + V_{22} = \\kappa_g q_g^2 + \\kappa_h q_h^2\n$$\n因此，平均能量是一个简谐势：\n$$\n\\bar{E}(q_g,q_h) = \\frac{1}{2}(\\kappa_g q_g^2 + \\kappa_h q_h^2)\n$$\n对于能隙 $G$，我们需要对角项之差和非对角项：\n$$\nV_{11} - V_{22} = \\left(\\tfrac{\\Delta}{2} + k_g q_g + k_h q_h\\right) - \\left(-\\tfrac{\\Delta}{2} - k_g q_g - k_h q_h\\right) = \\Delta + 2k_g q_g + 2k_h q_h\n$$\n$$\nV_{12} = c_0 + c_g q_g + c_h q_h\n$$\n将这些代入能隙 $G$ 的表达式中，得到：\n$$\nG(q_g,q_h) = \\sqrt{(\\Delta + 2k_g q_g + 2k_h q_h)^2 + 4(c_0 + c_g q_g + c_h q_h)^2}\n$$\n该问题要求通过最小化一个罚函数 $F(q_g,q_h;\\mu)$ 来寻找 MECI：\n$$\nF(q_g,q_h;\\mu) = \\bar{E}(q_g,q_h) + \\mu \\, G(q_g,q_h)^2\n$$\n能隙的平方项 $G^2$ 用于创建一个平滑的目标函数，并惩罚任何偏离锥形交叉条件 $G=0$ 的情况。参数 $\\mu$ 是一个罚权重；较大的 $\\mu$ 会更严格地施加 $G=0$ 的约束。\n将我们推导出的 $\\bar{E}$ 和 $G$ 的表达式代入 $F$：\n$$\nF(q_g,q_h;\\mu) = \\left( \\tfrac{1}{2}\\kappa_g q_g^2 + \\tfrac{1}{2}\\kappa_h q_h^2 \\right) + \\mu \\left[ (\\Delta + 2k_g q_g + 2k_h q_h)^2 + 4(c_0 + c_g q_g + c_h q_h)^2 \\right]\n$$\n这个表达式是关于 $q_g$ 和 $q_h$ 的一个二次型。对于给定的正定谐波项（$\\kappa_g, \\kappa_h > 0$）和非负罚权重 $\\mu \\ge 0$，此函数是凸函数，并拥有唯一的全局最小值。任务是数值地找到这个最小值 $(q_g^\\star, q_h^\\star)$。\n\n算法步骤如下：\n1.  对于每个测试用例，定义具体的参数集 $(\\kappa_g, \\kappa_h, \\Delta, k_g, k_h, c_0, c_g, c_h, \\mu)$。\n2.  在代码中实现目标函数 $F(q_g,q_h;\\mu)$。该函数将坐标向量 $[q_g, q_h]$ 和参数作为输入。\n3.  使用标准的数值优化算法来寻找 $F$ 的最小值。Broyden–Fletcher–Goldfarb–Shanno (BFGS) 算法，可在 `scipy.optimize.minimize` 库函数中找到，是对此平滑函数进行无约束最小化的绝佳选择。\n4.  最小化过程从每个测试用例提供的初始猜测值 $(q_g^{(0)}, q_h^{(0)})$ 开始。\n5.  收敛后，优化器返回最优坐标 $(q_g^\\star, q_h^\\star)$。\n6.  使用这些优化坐标，计算最终感兴趣的量：\n    - 优化后的平均能量：$\\bar{E}^\\star = \\bar{E}(q_g^\\star, q_h^\\star) = \\tfrac{1}{2}\\kappa_g (q_g^\\star)^2 + \\tfrac{1}{2}\\kappa_h (q_h^\\star)^2$。\n    - 优化点处的残余能隙：$G^\\star = G(q_g^\\star, q_h^\\star) = \\sqrt{(\\Delta + 2k_g q_g^\\star + 2k_h q_h^\\star)^2 + 4(c_0 + c_g q_g^\\star + c_h q_h^\\star)^2}$。\n7.  每个测试用例的最终结果是列表 $[q_g^\\star, q_h^\\star, \\bar{E}^\\star, G^\\star]$，每个值都四舍五入到六位小数。\n\n考虑 $\\mu=0$ 的情况（测试用例 3）。目标函数变为 $F(q_g,q_h;0) = \\bar{E}(q_g,q_h) = \\tfrac{1}{2}\\kappa_g q_g^2 + \\tfrac{1}{2}\\kappa_h q_h^2$。该函数的最小值显然在 $(q_g,q_h) = (0,0)$。优化过程只是找到平均能量面的最小值，而忽略了锥形交叉条件。得到的能隙 $G^\\star$ 通常不为零。对于 $\\mu > 0$，优化器必须在最小化 $\\bar{E}$（这将解拉向原点）和最小化 $G$（这将解拉向交叉缝）之间取得平衡。较大的 $\\mu$ 值会产生一个更接近真实 MECI 的点，但代价是可能导致收敛速度变慢或出现数值刚度问题。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import minimize\n\ndef solve():\n    \"\"\"\n    Main function to solve the MECI optimization problem for the given test cases.\n    \"\"\"\n    # Define the parameter sets from the problem statement.\n    params_A = {\n        'kappa_g': 1.0, 'kappa_h': 1.2, 'Delta': 0.05,\n        'k_g': 0.6, 'k_h': -0.2, 'c_0': 0.02,\n        'c_g': 0.4, 'c_h': -0.3\n    }\n    params_B = {\n        'kappa_g': 0.8, 'kappa_h': 1.1, 'Delta': -0.08,\n        'k_g': 0.5, 'k_h': 0.1, 'c_0': 0.03,\n        'c_g': 0.2, 'c_h': 0.25\n    }\n\n    # Define the test cases from the problem statement.\n    # Each case is (parameter_set_dict, mu, q_g_initial, q_h_initial)\n    test_cases = [\n        (params_A, 50.0, 0.0, 0.0),\n        (params_A, 1.0, 0.5, -0.5),\n        (params_A, 0.0, 0.0, 0.0),\n        (params_B, 100.0, 0.0, 0.0),\n    ]\n\n    def objective_function(q, params, mu):\n        \"\"\"\n        Calculates the penalty function F(q_g, q_h; mu).\n        q: numpy array [q_g, q_h]\n        params: dictionary of model parameters\n        mu: penalty weight\n        \"\"\"\n        q_g, q_h = q\n        \n        # Unpack parameters\n        kappa_g = params['kappa_g']\n        kappa_h = params['kappa_h']\n        Delta = params['Delta']\n        k_g = params['k_g']\n        k_h = params['k_h']\n        c_0 = params['c_0']\n        c_g = params['c_g']\n        c_h = params['c_h']\n\n        # Calculate average energy E_bar\n        e_avg = 0.5 * kappa_g * q_g**2 + 0.5 * kappa_h * q_h**2\n        \n        # Calculate squared energy gap G^2\n        # G^2 = (V11 - V22)^2 + 4 * V12^2\n        v11_minus_v22 = Delta + 2 * k_g * q_g + 2 * k_h * q_h\n        v12 = c_0 + c_g * q_g + c_h * q_h\n        g_squared = v11_minus_v22**2 + 4 * v12**2\n        \n        # Return the penalty function value\n        return e_avg + mu * g_squared\n\n    results = []\n    for params, mu, qg0, qh0 in test_cases:\n        # Set initial guess\n        initial_guess = np.array([qg0, qh0])\n        \n        # Perform numerical minimization\n        opt_result = minimize(\n            objective_function,\n            initial_guess,\n            args=(params, mu),\n            method='BFGS'\n        )\n        \n        # Extract optimized coordinates\n        q_star = opt_result.x\n        qg_star, qh_star = q_star\n        \n        # Unpack parameters for final calculations\n        kappa_g = params['kappa_g']\n        kappa_h = params['kappa_h']\n        Delta = params['Delta']\n        k_g = params['k_g']\n        k_h = params['k_h']\n        c_0 = params['c_0']\n        c_g = params['c_g']\n        c_h = params['c_h']\n\n        # Calculate final quantities at the optimized point\n        e_avg_star = 0.5 * kappa_g * qg_star**2 + 0.5 * kappa_h * qh_star**2\n        \n        v11_minus_v22_star = Delta + 2 * k_g * qg_star + 2 * k_h * qh_star\n        v12_star = c_0 + c_g * qg_star + c_h * qh_star\n        g_star = np.sqrt(v11_minus_v22_star**2 + 4 * v12_star**2)\n        \n        # Append the results for this case\n        results.append([qg_star, qh_star, e_avg_star, g_star])\n\n    # Format the final output string as specified\n    output_str = '[' + ','.join([f'[{r[0]:.6f},{r[1]:.6f},{r[2]:.6f},{r[3]:.6f}]' for r in results]) + ']'\n    print(output_str)\n\nsolve()\n```", "id": "2453357"}]}