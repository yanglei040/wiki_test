{"hands_on_practices": [{"introduction": "我们从最基础的系统——双原子分子 $I_2$ ——开始。这个实践将抽象的势能面概念（通过莫尔斯势函数建模）与可观测的光谱量（振动波数和拉曼活性）直接联系起来。通过引入一个简化的模型，你将亲手计算标量相对论效应对这些光谱性质的影响，从而深入理解基础物理原理如何体现在计算结果中 [@problem_id:2462305]。", "problem": "您将编写一个完整的程序，模拟标量相对论效应对重同核双原子分子碘（表示为 $I_2$）的振动波数和拉曼活性的影响。该程序必须从 Born-Oppenheimer 势能曲线的 Morse 势表示中推导出谐振极限下的振动波数，并估计由 Morse 参数的标量相对论标度引起的改变量。它还必须使用线性极化率模型估计各向同性拉曼活性的相对变化。\n\n从以下基本定义和经过充分检验的事实开始：\n- 在谐振近似中，简正模式的角频率 $ \\omega $ 由 $ \\omega = \\sqrt{k / \\mu} $ 给出，其中 $ k = \\left. \\frac{d^2 V}{dr^2} \\right|_{r_e} $ 是势能 $ V(r) $ 在平衡键距 $ r_e $ 处的曲率，而 $ \\mu $ 是双原子分子的约化质量。\n- Morse 势为 $ V(r) = D_e \\left( 1 - e^{-a(r - r_e)} \\right)^2 $，其中 $ D_e $ 是势阱深度，$ a $ 是范围参数。\n- 以逆厘米为单位的光谱波数 $ \\tilde{\\nu} $ 通过 $ \\tilde{\\nu} = \\omega / (2 \\pi c) $ 与角频率相关，其中 $ c $ 是光速。如果 $ c $ 的单位是厘米/秒，则 $ \\tilde{\\nu} $ 的单位是 $\\mathrm{cm}^{-1}$。\n- 基频振动跃迁的各向同性拉曼活性与各向同性极化率 $ \\bar{\\alpha} $ 相对于简正坐标 $ Q $ 的导数的平方成正比，即 $ S \\propto \\left( \\frac{d \\bar{\\alpha}}{d Q} \\right)^2 $。对于具有单一伸缩坐标的双原子分子，线性极化率模型为 $ \\bar{\\alpha}(r) = \\alpha_0 + \\alpha_1 (r - r_e) $，质量加权简正坐标为 $ Q = \\sqrt{\\mu} (r - r_e) $。\n\n您的程序必须为每个测试用例实现以下步骤：\n1. 使用给定的非相对论 Morse 参数 $ D_e $（单位为电子伏特）和 $ a $（单位为逆埃）计算谐振波数 $ \\tilde{\\nu}_{\\mathrm{NR}} $（单位为 $\\mathrm{cm}^{-1}$）。您必须在需要时将所有量转换为国际单位制（SI），然后返回以 $\\mathrm{cm}^{-1}$ 为单位的波数。碘的质量使用 $ m_{\\mathrm{I}} = 126.90447 $ 统一原子质量单位，约化质量为 $ \\mu = m_{\\mathrm{I}} / 2 $。使用 $ 1 $ 统一原子质量单位 $ = 1.66053906660 \\times 10^{-27} \\ \\mathrm{kg} $，$ 1 $ 电子伏特 $ = 1.602176634 \\times 10^{-19} \\ \\mathrm{J} $，$ 1 \\ \\text{\\AA}^{-1} = 10^{10} \\ \\mathrm{m}^{-1} $，以及 $ c = 2.99792458 \\times 10^{10} \\ \\mathrm{cm} \\ \\mathrm{s}^{-1} $。\n2. 将标量相对论效应建模为对 Morse 参数的乘法分数变化：$ D_e \\mapsto D_e (1 + f_D) $ 和 $ a \\mapsto a (1 + f_a) $，其中 $ f_D $ 和 $ f_a $ 是给定的无量纲分数变化（例如 $ 0.03 $ 表示增加 $ 3 $ %）。计算相应的相对论校正波数 $ \\tilde{\\nu}_{\\mathrm{SR}} $（单位为 $\\mathrm{cm}^{-1}$）。\n3. 计算波数偏移 $ \\Delta \\tilde{\\nu} = \\tilde{\\nu}_{\\mathrm{SR}} - \\tilde{\\nu}_{\\mathrm{NR}} $（单位为 $\\mathrm{cm}^{-1}$）。\n4. 对于拉曼活性，假设各向同性极化率模型为 $ \\bar{\\alpha}(r) = \\alpha_0 + \\alpha_1 (r - r_e) $，其中给定的 $ \\alpha_1 $ 单位为立方埃每埃。设相对论变化为 $ \\alpha_1 \\mapsto \\alpha_1 (1 + f_\\alpha) $。使用简正坐标的定义，推导出 $ \\frac{d \\bar{\\alpha}}{d Q} = \\alpha_1 / \\sqrt{\\mu} $（不考虑公共单位转换因子）。报告标量相对论与非相对论各向同性拉曼活性的比率 $ R_S = \\frac{S_{\\mathrm{SR}}}{S_{\\mathrm{NR}}} $，作为一个无量纲小数。以十进制形式数值表示 $ R_S $，而非百分比。\n\n测试套件和每个案例所需的输入：\n- 案例 A（一般情况）：$ D_e = 1.54 $ 电子伏特，$ a = 1.50 $ 逆埃，$ f_D = 0.02 $，$ f_a = 0.03 $，$ \\alpha_1 = 1.00\\ \\text{\\AA}^3/\\text{\\AA} $，$ f_\\alpha = 0.05 $。\n- 案例 B（边界：无相对论变化）：$ D_e = 1.54 $ 电子伏特，$ a = 1.50 $ 逆埃，$ f_D = 0.00 $，$ f_a = 0.00 $，$ \\alpha_1 = 1.00\\ \\text{\\AA}^3/\\text{\\AA} $，$ f_\\alpha = 0.00 $。\n- 案例 C（更强的相对论响应和不同的基线）：$ D_e = 1.80 $ 电子伏特，$ a = 1.30 $ 逆埃，$ f_D = 0.05 $，$ f_a = 0.08 $，$ \\alpha_1 = 0.80\\ \\text{\\AA}^3/\\text{\\AA} $，$ f_\\alpha = 0.10 $。\n\n您的程序必须：\n- 为每个案例计算 $ \\Delta \\tilde{\\nu} $（单位为 $ \\mathrm{cm}^{-1} $）并四舍五入到六位小数。\n- 为每个案例计算拉曼活性比率 $ R_S $（作为无量纲小数）并四舍五入到六位小数。\n- 生成一行输出，其中包含一个以逗号分隔的子列表列表形式的结果，每个子列表包含一个测试用例的 $ [\\Delta \\tilde{\\nu}, R_S] $，所有内容都用方括号括起来。例如：$ [[x_1,y_1],[x_2,y_2],[x_3,y_3]] $，其中 $ x_i $ 和 $ y_i $ 是小数点后有六位数字的十进制数。\n\n科学真实性要求：\n- 将 $ I_2 $ 视为一个在最小值附近由 Morse 势描述的刚性双原子分子。\n- 假设标量相对论效应如指定的那样，对 $ D_e $ 和 $ a $ 起到小的乘法变化作用。\n- 所有常数和单位转换必须一致应用。\n\n不使用角度单位。所有需要单位的物理量必须按上述规定表示。最终输出是明确要求的单位或无量纲形式的浮点数。", "solution": "所述问题已经过验证，被认为是科学上合理的、问题定义清晰且客观的。它提出了一个基于既定物理模型和原理的理论光谱学中标准的（尽管是简化的）计算练习。所有必要的参数和常数都已提供，所需的计算在逻辑上是合理的，并能导出一个唯一的、可验证的解。因此，我们继续进行推导和计算实现。\n\n目标是计算标量相对论效应对 $I_2$ 分子的谐振动波数和各向同性拉曼活性的影响。这将通过对 Morse 势和线性极化率模型的参数应用缩放因子来完成。\n\n首先，我们从 Morse 势推导出谐振动波数的表达式，其形式如下：\n$$ V(r) = D_e \\left( 1 - e^{-a(r - r_e)} \\right)^2 $$\n其中 $D_e$ 是势阱深度，$a$ 是范围参数，$r_e$ 是平衡键距。\n\n谐振近似需要力常数 $k$，即势能对核间距 $r$ 的二阶导数，在平衡位置 $r_e$ 处求值。\n一阶导数为：\n$$ \\frac{dV}{dr} = D_e \\cdot 2 \\left( 1 - e^{-a(r - r_e)} \\right) \\cdot \\left( -e^{-a(r - r_e)} \\right) \\cdot (-a) = 2aD_e \\left( e^{-a(r - r_e)} - e^{-2a(r - r_e)} \\right) $$\n二阶导数为：\n$$ \\frac{d^2V}{dr^2} = 2aD_e \\left( -a e^{-a(r - r_e)} + 2a e^{-2a(r - r_e)} \\right) $$\n在 $r = r_e$ 处求值：\n$$ k = \\left. \\frac{d^2V}{dr^2} \\right|_{r=r_e} = 2a^2 D_e $$\n振动的角频率 $\\omega$ 由 $\\omega = \\sqrt{k / \\mu}$ 给出，其中 $\\mu$ 是分子的约化质量。代入 $k$ 的表达式：\n$$ \\omega = \\sqrt{\\frac{2a^2 D_e}{\\mu}} = a \\sqrt{\\frac{2D_e}{\\mu}} $$\n振动波数 $\\tilde{\\nu}$（单位 $\\mathrm{cm}^{-1}$）通过 $\\tilde{\\nu} = \\omega / (2 \\pi c)$ 与 $\\omega$ 相关，其中 $c$ 是光速，单位为 $\\mathrm{cm}\\cdot\\mathrm{s}^{-1}$。得到的波数表达式为：\n$$ \\tilde{\\nu} = \\frac{a}{2 \\pi c} \\sqrt{\\frac{2D_e}{\\mu}} $$\n对于此计算，所有量必须使用一致的单位制。我们将把给定的参数转换为 SI 单位以进行中间步骤：\n- $D_e$ 从电子伏特（$eV$）转换为焦耳（$J$）。\n- $a$ 从逆埃（$\\text{\\AA}^{-1}$）转换为逆米（$\\mathrm{m}^{-1}$）。\n- 碘的质量 $m_{\\mathrm{I}}$ 从统一原子质量单位（$u$）转换为千克（$kg$），由此可得出约化质量 $\\mu = m_{\\mathrm{I}}/2$。\n光速 $c$ 以 $\\mathrm{cm}\\cdot\\mathrm{s}^{-1}$ 为单位给出，这适合直接获得以 $\\mathrm{cm}^{-1}$ 为单位的最终波数。\n\n非相对论波数 $\\tilde{\\nu}_{\\mathrm{NR}}$ 使用基本参数 $D_e$ 和 $a$ 计算。标量相对论效应通过缩放这些参数来建模：\n$$ D_e' = D_e (1 + f_D) $$\n$$ a' = a (1 + f_a) $$\n然后使用 $D_e'$ 和 $a'$ 计算标量相对论波数 $\\tilde{\\nu}_{\\mathrm{SR}}$。从波数公式的结构，我们可以写出：\n$$ \\tilde{\\nu}_{\\mathrm{SR}} = \\frac{a(1+f_a)}{2 \\pi c} \\sqrt{\\frac{2D_e(1+f_D)}{\\mu}} = \\left( \\frac{a}{2 \\pi c} \\sqrt{\\frac{2D_e}{\\mu}} \\right) (1+f_a)\\sqrt{1+f_D} = \\tilde{\\nu}_{\\mathrm{NR}} (1+f_a)\\sqrt{1+f_D} $$\n所需的波数偏移为 $\\Delta \\tilde{\\nu} = \\tilde{\\nu}_{\\mathrm{SR}} - \\tilde{\\nu}_{\\mathrm{NR}}$。\n\n接下来，我们讨论各向同性拉曼活性 $S$。已知它与各向同性极化率 $\\bar{\\alpha}$ 相对于简正坐标 $Q$ 的导数的平方成正比：\n$$ S \\propto \\left( \\frac{d \\bar{\\alpha}}{d Q} \\right)^2 $$\n极化率被线性地建模为 $\\bar{\\alpha}(r) = \\alpha_0 + \\alpha_1 (r - r_e)$，简正坐标为 $Q = \\sqrt{\\mu} (r - r_e)$。我们可以通过注意到 $(r - r_e) = Q / \\sqrt{\\mu}$ 来将 $\\bar{\\alpha}$ 表示为 $Q$ 的函数。代入后得到：\n$$ \\bar{\\alpha}(Q) = \\alpha_0 + \\alpha_1 \\left( \\frac{Q}{\\sqrt{\\mu}} \\right) $$\n对 $Q$ 的导数是直接的：\n$$ \\frac{d \\bar{\\alpha}}{d Q} = \\frac{\\alpha_1}{\\sqrt{\\mu}} $$\n因此，拉曼活性与以下成正比：\n$$ S \\propto \\left(\\frac{\\alpha_1}{\\sqrt{\\mu}}\\right)^2 = \\frac{\\alpha_1^2}{\\mu} $$\n需要计算标量相对论活性 $S_{\\mathrm{SR}}$ 与非相对论活性 $S_{\\mathrm{NR}}$ 的比率。相对论效应通过将 $\\alpha_1$ 缩放为 $\\alpha_1' = \\alpha_1(1 + f_\\alpha)$ 来建模。约化质量 $\\mu$ 是一个核性质，不受电子相对论校正的影响。因此，我们有：\n$$ S_{\\mathrm{NR}} \\propto \\frac{\\alpha_1^2}{\\mu} \\quad \\text{and} \\quad S_{\\mathrm{SR}} \\propto \\frac{(\\alpha_1')^2}{\\mu} = \\frac{(\\alpha_1(1+f_\\alpha))^2}{\\mu} $$\n比率 $R_S$ 是：\n$$ R_S = \\frac{S_{\\mathrm{SR}}}{S_{\\mathrm{NR}}} = \\frac{\\alpha_1^2 (1+f_\\alpha)^2 / \\mu}{\\alpha_1^2 / \\mu} = (1+f_\\alpha)^2 $$\n这为拉曼活性的变化提供了一个直接的公式。\n\n计算过程将涉及为每个测试用例实现这些推导出的公式，正确执行单位转换，并按规定格式化输出。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes scalar relativistic effects on the vibrational wavenumber and Raman\n    activity of I2 based on a Morse potential and linear polarizability model.\n    \"\"\"\n\n    # --- Constants ---\n    # Mass of Iodine in unified atomic mass units (u)\n    M_I_U = 126.90447\n    # Conversion from u to kg\n    U_TO_KG = 1.66053906660e-27\n    # Conversion from electronvolt (eV) to Joules (J)\n    EV_TO_J = 1.602176634e-19\n    # Conversion from inverse Angstrom (A^-1) to inverse meter (m^-1)\n    INV_A_TO_INV_M = 1e10\n    # Speed of light in cm/s\n    C_CMS = 2.99792458e10\n\n    # Reduced mass of I2 molecule in kg\n    reduced_mass = (M_I_U / 2.0) * U_TO_KG\n\n    def calculate_wavenumber(De_eV, a_inv_A):\n        \"\"\"\n        Calculates the harmonic vibrational wavenumber from Morse parameters.\n\n        Args:\n            De_eV (float): Morse potential well depth in eV.\n            a_inv_A (float): Morse potential range parameter in A^-1.\n\n        Returns:\n            float: Vibrational wavenumber in cm^-1.\n        \"\"\"\n        # Convert parameters to SI units for angular frequency calculation\n        De_J = De_eV * EV_TO_J\n        a_inv_m = a_inv_A * INV_A_TO_INV_M\n        \n        # Angular frequency in rad/s: omega = a * sqrt(2*De / mu)\n        omega = a_inv_m * np.sqrt(2 * De_J / reduced_mass)\n        \n        # Wavenumber in cm^-1: nu_tilde = omega / (2 * pi * c)\n        wavenumber = omega / (2 * np.pi * C_CMS)\n        \n        return wavenumber\n\n    # Test cases: (De, a, fD, fa, alpha1, f_alpha)\n    test_cases = [\n        # Case A: General case\n        (1.54, 1.50, 0.02, 0.03, 1.00, 0.05),\n        # Case B: Boundary case (no relativistic effects)\n        (1.54, 1.50, 0.00, 0.00, 1.00, 0.00),\n        # Case C: Stronger relativistic response\n        (1.80, 1.30, 0.05, 0.08, 0.80, 0.10)\n    ]\n\n    results = []\n    for case in test_cases:\n        De, a, fD, fa, alpha1, f_alpha = case\n\n        # --- Wavenumber Calculation ---\n        # 1. Non-relativistic wavenumber\n        nu_NR = calculate_wavenumber(De, a)\n        \n        # 2. Relativistically corrected parameters\n        De_SR = De * (1 + fD)\n        a_SR = a * (1 + fa)\n        \n        # 3. Scalar relativistic wavenumber\n        nu_SR = calculate_wavenumber(De_SR, a_SR)\n        \n        # 4. Wavenumber shift\n        delta_nu = nu_SR - nu_NR\n        \n        # --- Raman Activity Ratio Calculation ---\n        # The ratio Rs simplifies to (1 + f_alpha)^2\n        Rs = (1 + f_alpha)**2\n        \n        # Store results rounded to six decimal places\n        results.append([round(delta_nu, 6), round(Rs, 6)])\n\n    # Format the final output string as [[x1,y1],[x2,y2],[x3,y3]]\n    output_str = \"[\" + \",\".join([f\"[{x:.6f},{y:.6f}]\" for x, y in results]) + \"]\"\n    print(output_str)\n\nsolve()\n```", "id": "2462305"}, {"introduction": "在掌握了单个振动的计算后，我们将更进一步，处理更真实的分子体系。本练习以1,2-二氯乙烷为例，它具有多种振动模式和构象异构体。你将学习如何通过组合单个模式的拉曼活性、应用光谱线型函数以及根据玻尔兹曼分布对不同构象进行加权，来构建一个完整的、随温度变化的拉曼光谱，这是连接理论计算和实验测量的重要一步 [@problem_id:2462310]。", "problem": "您将实现一个第一性原理模拟，该模拟计算并比较 1,2-二氯乙烷的两种构象异构体（反式和邻位）的相对拉曼光谱强度，并预测它们在指定温度下的相对布居数。您的程序必须是一个完整的、可运行的程序，它能从极化率导数张量推导出拉曼活性，使用具有物理动机的光谱线型，并应用玻尔兹曼统计计算布居数。\n\n从以下基本原理和经过充分检验的事实出发：\n- 拉曼散射的经典描述将感生偶极矩建模为 $\\boldsymbol{\\mu}_{\\mathrm{ind}} = \\boldsymbol{\\alpha} \\, \\mathbf{E}$，其中 $\\boldsymbol{\\alpha}$ 是分子极化率张量，$\\mathbf{E}$ 是入射电场。\n- 对于角频率为 $\\omega_k$ 的小振幅简正模 $Q_k$，振动运动对极化率的调制如下 $\\boldsymbol{\\alpha}(t) \\approx \\boldsymbol{\\alpha}_0 + \\left(\\frac{\\partial \\boldsymbol{\\alpha}}{\\partial Q_k}\\right)_0 Q_k \\cos(\\omega_k t)$。\n- 随时间变化的极化率会引起斯托克斯位移频率上的散射，其强度取决于在对所有分子取向进行转动平均后，极化率张量对简正坐标的导数。\n- 在绝对温度 $T$ 下，能量为 $E_i$、简并度为 $g_i$ 的构象异构体 $i$ 的平衡布居数遵循玻尔兹曼分布 $p_i \\propto g_i \\exp\\!\\left(-\\frac{E_i}{R T}\\right)$，其中 $R$ 是普适气体常数。\n- 谱线的标准模型是一个以振动模式波数 $\\tilde{\\nu}_k$ 为中心、半峰全宽（FWHM）为 $\\Gamma$（以波数表示）的高斯函数。\n\n基于这些原理，推导：\n1) 一个振动模式拉曼活性的取向平均表达式，用极化率导数张量 $\\left(\\frac{\\partial \\boldsymbol{\\alpha}}{\\partial Q_k}\\right)$ 的不变量（张量的各向同性部分和各向异性部分）来表示。将每个模式 $k$ 的最终活性表示为张量元 $\\alpha'_{xx}, \\alpha'_{yy}, \\alpha'_{zz}, \\alpha'_{xy}, \\alpha'_{xz}, \\alpha'_{yz}$ 的函数，其中 $\\alpha'_{ij} \\equiv \\left(\\frac{\\partial \\alpha_{ij}}{\\partial Q_k}\\right)$。\n2) 一个高斯线型 $L(\\tilde{\\nu}; \\tilde{\\nu}_k, \\Gamma)$，其在 $\\tilde{\\nu}=\\tilde{\\nu}_k$ 处的峰值为 $1$，半峰全宽为 $\\Gamma$，适用于将“谱棒”叠加成连续光谱。\n3) 归一化的玻尔兹曼布居数 $p_i(T) = \\dfrac{g_i \\exp\\!\\left(-\\dfrac{E_i}{R T}\\right)}{\\sum_j g_j \\exp\\!\\left(-\\dfrac{E_j}{R T}\\right)}$，使用单位为 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$ 的能量，单位为 $\\mathrm{K}$ 的温度，以及单位为 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$ 的 $R$。\n\n然后您将实现以下具体的模拟和比较。\n\n构象异构体数据：\n- 能量（相同理论水平下的相对电子能量）：\n  - 反式：$E_{\\mathrm{anti}} = 0.00\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$，简并度 $g_{\\mathrm{anti}} = 1$。\n  - 邻位：$E_{\\mathrm{gauche}} = 1.50\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$，简并度 $g_{\\mathrm{gauche}} = 2$。\n- 普适气体常数：$R = 8.314462618\\times 10^{-3}\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$。\n\n每个构象异构体的振动模式（波数单位为 $\\mathrm{cm}^{-1}$，对称极化率导数张量元 $\\alpha'_{ij}$ 的单位为任意一致单位）：\n\n反式构象异构体：\n- 模式 A1：$\\tilde{\\nu} = 210$；矩阵\n$$\n  \\begin{bmatrix}\n  0.30 & 0.02 & -0.01\\\\\n  0.02 & 0.20 & 0.00\\\\\n  -0.01 & 0.00 & 0.25\n  \\end{bmatrix}\n$$\n- 模式 A2：$\\tilde{\\nu} = 615$；矩阵\n$$\n  \\begin{bmatrix}\n  0.60 & 0.04 & 0.02\\\\\n  0.04 & 0.15 & -0.01\\\\\n  0.02 & -0.01 & 0.20\n  \\end{bmatrix}\n$$\n- 模式 A3：$\\tilde{\\nu} = 860$；矩阵\n$$\n  \\begin{bmatrix}\n  0.40 & 0.02 & 0.01\\\\\n  0.02 & 0.40 & -0.01\\\\\n  0.01 & -0.01 & 0.50\n  \\end{bmatrix}\n$$\n\n邻位构象异构体：\n- 模式 G1：$\\tilde{\\nu} = 180$；矩阵\n$$\n  \\begin{bmatrix}\n  0.25 & -0.01 & 0.03\\\\\n  -0.01 & 0.28 & 0.02\\\\\n  0.03 & 0.02 & 0.20\n  \\end{bmatrix}\n$$\n- 模式 G2：$\\tilde{\\nu} = 595$；矩阵\n$$\n  \\begin{bmatrix}\n  0.30 & 0.12 & 0.06\\\\\n  0.12 & 0.35 & -0.08\\\\\n  0.06 & -0.08 & 0.29\n  \\end{bmatrix}\n$$\n- 模式 G3：$\\tilde{\\nu} = 845$；矩阵\n$$\n  \\begin{bmatrix}\n  0.45 & 0.05 & 0.01\\\\\n  0.05 & 0.33 & -0.02\\\\\n  0.01 & -0.02 & 0.40\n  \\end{bmatrix}\n$$\n\n模拟任务：\n- 对每个构象异构体，根据您推导出的张量不变量计算每个模式的拉曼活性。\n- 构建模拟拉曼光谱，该光谱是各模式的布居数加权活性乘以以各模式波数为中心的高斯线型的总和：对于构象异构体 $i$，$I_i(\\tilde{\\nu}) = p_i(T) \\sum_k S_{i,k} \\, L(\\tilde{\\nu}; \\tilde{\\nu}_{i,k}, \\Gamma)$，其中 $S_{i,k}$ 是构象异构体 $i$ 的模式 $k$ 的拉曼活性。\n- 通过报告比率 $I_{\\mathrm{anti}}(600) / I_{\\mathrm{gauche}}(600)$，在单个探测波数 $\\tilde{\\nu}_{\\mathrm{probe}} = 600\\ \\mathrm{cm}^{-1}$ 处比较两个光谱。\n- 通过报告 $p_{\\mathrm{anti}}(T)$ 预测相对布居数。\n\n物理和数值单位：\n- 能量必须以 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$ 处理，温度以 $\\mathrm{K}$ 处理，波数以 $\\mathrm{cm}^{-1}$ 处理，半峰全宽以 $\\mathrm{cm}^{-1}$ 处理。\n- 报告的布居数是一个无量纲分数（以小数形式表示），强度比也是无量纲的。\n\n测试套件：\n使用以下三个测试用例，每个用例由温度 $T$ 和高斯半峰全宽 $\\Gamma$ 定义（二者均使用上述指定单位）：\n- 用例 1: $T = 298.15$，$\\Gamma = 12$。\n- 用例 2: $T = 150.00$，$\\Gamma = 12$。\n- 用例 3: $T = 500.00$，$\\Gamma = 25$。\n\n要求的最终输出格式：\n- 您的程序必须生成单行输出，其中包含所有测试用例的汇总结果，格式为一个扁平的、逗号分隔的列表，并用方括号括起来，顺序如下：\n  $[p_{\\mathrm{anti}}(T_1),\\, I_{\\mathrm{anti}}(600)/I_{\\mathrm{gauche}}(600)\\ \\text{at}\\ T_1,\\, p_{\\mathrm{anti}}(T_2),\\, I_{\\mathrm{anti}}(600)/I_{\\mathrm{gauche}}(600)\\ \\text{at}\\ T_2,\\, p_{\\mathrm{anti}}(T_3),\\, I_{\\mathrm{anti}}(600)/I_{\\mathrm{gauche}}(600)\\ \\text{at}\\ T_3]$。\n- 列表中的每个数字必须格式化为小数点后保留六位的小数。\n- 不应打印任何额外的文本或行。\n\n角度单位不适用于此问题。不得使用百分比；请以小数形式报告分数。", "solution": "问题陈述经审阅后被认定为有效。它提出了一个在计算光谱学领域中定义明确、有科学依据的问题，没有矛盾、歧义或事实错误。它提供了计算出唯一、可验证结果所需的所有必要物理常数、分子数据和模拟参数。因此，我们可以继续进行推导和求解。\n\n任务是模拟 $1,2$-二氯乙烷的*反式*和*邻位*构象异构体的拉曼光谱，并比较它们在不同温度下的相对贡献。这需要三个不同的理论部分：一个振动模式拉曼活性的表达式、一个用于模拟光谱线型的函数，以及一个用于构象异构体布居数的统计力学模型。\n\n首先，我们推导振动模式 $k$ 的拉曼活性 $S_k$ 的表达式。拉曼散射源于分子极化率张量 $\\boldsymbol{\\alpha}$ 受简正模 $Q_k$ 的核运动调制。散射光的强度取决于极化率导数张量 $\\boldsymbol{\\alpha}'_k = \\left(\\frac{\\partial \\boldsymbol{\\alpha}}{\\partial Q_k}\\right)_0$。对于处于液相中的分子，我们必须对所有可能的相对于入射电场的取向进行平均。这种取向平均得到一个用张量 $\\boldsymbol{\\alpha}'_k$ 的旋转不变量表示的活性表达式。\n\n张量 $\\boldsymbol{\\alpha}'_k$ 可以分解为一个各向同性部分和一个各向异性部分。两个基本不变量是平均极化率导数 $\\bar{\\alpha}'_k$ 和极化率导数各向异性 $\\gamma_k'^2$。\n\n平均极化率导数 $\\bar{\\alpha}_k'$ 是张量迹的三分之一：\n$$\n\\bar{\\alpha}_k' = \\frac{1}{3} \\mathrm{Tr}(\\boldsymbol{\\alpha}'_k) = \\frac{1}{3} (\\alpha'_{xx} + \\alpha'_{yy} + \\alpha'_{zz})\n$$\n其中 $\\alpha'_{ii}$ 是张量的对角元素。该不变量决定了偏振拉曼散射的强度。\n\n各向异性不变量 $\\gamma_k'^2$ 量化了偏离球对称的程度，由下式给出：\n$$\n\\gamma_k'^2 = \\frac{1}{2} \\left[ (\\alpha'_{xx} - \\alpha'_{yy})^2 + (\\alpha'_{yy} - \\alpha'_{zz})^2 + (\\alpha'_{zz} - \\alpha'_{xx})^2 + 6(\\alpha_{xy}'^2 + \\alpha_{xz}'^2 + \\alpha_{yz}'^2) \\right]\n$$\n这里我们利用了张量的对称性，即 $\\alpha'_{ij} = \\alpha'_{ji}$。该不变量与去偏振散射有关。\n\n对于非偏振入射光，总拉曼活性 $S_k$ 是这两个不变量平方的加权和。我们在此采用计算化学中使用的标准表达式：\n$$\nS_k = 45 (\\bar{\\alpha}_k')^2 + 7 \\gamma_k'^2\n$$\n该公式提供了一个表示模式 $k$ 内在拉曼强度的标量值，与分子取向无关。任何总体的比例常数都被省略，因为它们在计算强度比时会抵消。\n\n其次，我们构建线型函数。每个振动跃迁（表示为波数 $\\tilde{\\nu}_k$ 处的“谱棒”）被展宽成一个连续的谱带。为此指定了一个高斯函数。我们需要一个函数 $L(\\tilde{\\nu}; \\tilde{\\nu}_k, \\Gamma)$，其在 $\\tilde{\\nu} = \\tilde{\\nu}_k$ 处的峰值归一化为 $1$，并且半峰全宽（FWHM）为 $\\Gamma$。高斯函数的半峰全宽 $\\Gamma$ 和标准差 $\\sigma$ 之间的关系是 $\\Gamma = 2\\sqrt{2\\ln(2)} \\sigma$。整理后得到 $2\\sigma^2 = \\frac{\\Gamma^2}{4\\ln(2)}$。因此线型函数为：\n$$\nL(\\tilde{\\nu}; \\tilde{\\nu}_k, \\Gamma) = \\exp\\left(-\\frac{(\\tilde{\\nu} - \\tilde{\\nu}_k)^2}{2\\sigma^2}\\right) = \\exp\\left(-4 \\ln(2) \\frac{(\\tilde{\\nu} - \\tilde{\\nu}_k)^2}{\\Gamma^2}\\right)\n$$\n\n第三，我们使用玻尔兹曼统计确定两种构象异构体的相对布居数。在温度 $T$ 的热平衡下，找到一个分子处于能量为 $E_i$、简并度为 $g_i$ 的状态 $i$ 的概率 $p_i$ 与 $g_i \\exp(-E_i / RT)$ 成正比，其中 $R$ 是普适气体常数。对于我们的双构象异构体系统（*反式*和*邻位*），*反式*构象异构体的归一化布居数为：\n$$\np_{\\mathrm{anti}}(T) = \\frac{g_{\\mathrm{anti}} \\exp\\left(-\\frac{E_{\\mathrm{anti}}}{RT}\\right)}{g_{\\mathrm{anti}} \\exp\\left(-\\frac{E_{\\mathrm{anti}}}{RT}\\right) + g_{\\mathrm{gauche}} \\exp\\left(-\\frac{E_{\\mathrm{gauche}}}{RT}\\right)}\n$$\n使用给定的数据，$E_{\\mathrm{anti}} = 0.00\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$ 和 $g_{\\mathrm{anti}} = 1$，表达式简化为：\n$$\np_{\\mathrm{anti}}(T) = \\frac{1}{1 + g_{\\mathrm{gauche}} \\exp\\left(-\\frac{E_{\\mathrm{gauche}} - E_{\\mathrm{anti}}}{RT}\\right)} = \\frac{1}{1 + 2 \\exp\\left(-\\frac{1.50}{RT}\\right)}\n$$\n而*邻位*构象异构体的布居数是 $p_{\\mathrm{gauche}}(T) = 1 - p_{\\mathrm{anti}}(T)$。\n\n最后，我们构建总的模拟拉曼光谱。光谱是两种构象异构体贡献的总和，并按各自的布居数加权。对于给定的构象异构体 $i$，其在波数 $\\tilde{\\nu}$ 处的总强度贡献是其所有振动模式 $k$ 的总和：\n$$\nI_i(\\tilde{\\nu}) = p_i(T) \\sum_k S_{i,k} L(\\tilde{\\nu}; \\tilde{\\nu}_{i,k}, \\Gamma)\n$$\n其中 $S_{i,k}$ 是构象异构体 $i$ 的模式 $k$ 的拉曼活性。问题要求在特定探测波数 $\\tilde{\\nu}_{\\mathrm{probe}} = 600\\ \\mathrm{cm}^{-1}$ 处，每个构象异构体强度的比率。该比率为：\n$$\n\\frac{I_{\\mathrm{anti}}(\\tilde{\\nu}_{\\mathrm{probe}})}{I_{\\mathrm{gauche}}(\\tilde{\\nu}_{\\mathrm{probe}})} = \\frac{p_{\\mathrm{anti}}(T) \\sum_k S_{\\mathrm{anti},k} L(\\tilde{\\nu}_{\\mathrm{probe}}; \\tilde{\\nu}_{\\mathrm{anti},k}, \\Gamma)}{p_{\\mathrm{gauche}}(T) \\sum_k S_{\\mathrm{gauche},k} L(\\tilde{\\nu}_{\\mathrm{probe}}; \\tilde{\\nu}_{\\mathrm{gauche},k}, \\Gamma)}\n$$\n实现过程将遵循这些推导出的公式来处理给定的数据和测试用例。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and compares the relative Raman spectral intensity of the two\n    conformers of 1,2-dichloroethane (anti and gauche) and predicts their\n    relative populations at specified temperatures.\n    \"\"\"\n\n    # --- Givens and Constants ---\n    # Universal gas constant in kJ mol^-1 K^-1\n    R = 8.314462618e-3\n\n    # Conformer energy and degeneracy data\n    # Anti conformer\n    E_anti = 0.00  # kJ/mol\n    g_anti = 1.0\n    # Gauche conformer\n    E_gauche = 1.50  # kJ/mol\n    g_gauche = 2.0\n\n    # Probe wavenumber for intensity comparison\n    nu_probe = 600.0  # cm^-1\n\n    # Vibrational modes data for each conformer\n    # Format: (wavenumber [cm^-1], polarizability derivative tensor)\n    anti_modes = [\n        (210.0, np.array([[0.30, 0.02, -0.01], [0.02, 0.20, 0.00], [-0.01, 0.00, 0.25]])),\n        (615.0, np.array([[0.60, 0.04, 0.02], [0.04, 0.15, -0.01], [0.02, -0.01, 0.20]])),\n        (860.0, np.array([[0.40, 0.02, 0.01], [0.02, 0.40, -0.01], [0.01, -0.01, 0.50]]))\n    ]\n\n    gauche_modes = [\n        (180.0, np.array([[0.25, -0.01, 0.03], [-0.01, 0.28, 0.02], [0.03, 0.02, 0.20]])),\n        (595.0, np.array([[0.30, 0.12, 0.06], [0.12, 0.35, -0.08], [0.06, -0.08, 0.29]])),\n        (845.0, np.array([[0.45, 0.05, 0.01], [0.05, 0.33, -0.02], [0.01, -0.02, 0.40]]))\n    ]\n\n    # Test cases: (Temperature [K], FWHM [cm^-1])\n    test_cases = [\n        (298.15, 12.0),\n        (150.00, 12.0),\n        (500.00, 25.0),\n    ]\n\n    # --- Helper Functions based on Derived Formulae ---\n\n    def calculate_raman_activity(a_prime: np.ndarray) -> float:\n        \"\"\"\n        Calculates Raman activity from the polarizability derivative tensor.\n        S_k = 45 * (alpha_bar')^2 + 7 * (gamma')^2\n        \"\"\"\n        # Mean polarizability derivative (isotropic invariant)\n        alpha_bar_prime = (1.0 / 3.0) * np.trace(a_prime)\n\n        # Anisotropy invariant squared\n        # The tensor is symmetric, so a_prime[i, j] == a_prime[j, i]\n        ap_xx, ap_yy, ap_zz = a_prime[0, 0], a_prime[1, 1], a_prime[2, 2]\n        ap_xy, ap_xz, ap_yz = a_prime[0, 1], a_prime[0, 2], a_prime[1, 2]\n        \n        gamma_prime_sq = 0.5 * (\n            (ap_xx - ap_yy)**2 +\n            (ap_yy - ap_zz)**2 +\n            (ap_zz - ap_xx)**2 +\n            6 * (ap_xy**2 + ap_xz**2 + ap_yz**2)\n        )\n\n        return 45.0 * alpha_bar_prime**2 + 7.0 * gamma_prime_sq\n\n    def gaussian_lineshape(nu: float, nu_k: float, gamma: float) -> float:\n        \"\"\"\n        Calculates the value of a Gaussian lineshape function.\n        Peak is 1, FWHM is gamma.\n        \"\"\"\n        # Pre-compute constant factor to avoid recalculation\n        c = 4.0 * np.log(2.0)\n        return np.exp(-c * ((nu - nu_k) / gamma)**2)\n\n    def calculate_populations(T: float) -> tuple[float, float]:\n        \"\"\"\n        Calculates the Boltzmann populations for the anti and gauche conformers.\n        \"\"\"\n        # The energy of the anti conformer is the zero reference (E_anti = 0)\n        boltzmann_factor = np.exp(-(E_gauche - E_anti) / (R * T))\n        denominator = g_anti + g_gauche * boltzmann_factor\n        \n        p_anti = g_anti / denominator\n        p_gauche = (g_gauche * boltzmann_factor) / denominator\n        \n        return p_anti, p_gauche\n\n    # --- Main Simulation Loop ---\n    \n    results = []\n    for T, gamma in test_cases:\n        # 1. Calculate conformer populations at temperature T\n        p_anti, p_gauche = calculate_populations(T)\n\n        # 2. Calculate total intensity for the anti conformer\n        intensity_anti = 0.0\n        for nu_k, a_prime in anti_modes:\n            S_k = calculate_raman_activity(a_prime)\n            L_k = gaussian_lineshape(nu_probe, nu_k, gamma)\n            intensity_anti += S_k * L_k\n        \n        # 3. Calculate total intensity for the gauche conformer\n        intensity_gauche = 0.0\n        for nu_k, a_prime in gauche_modes:\n            S_k = calculate_raman_activity(a_prime)\n            L_k = gaussian_lineshape(nu_probe, nu_k, gamma)\n            intensity_gauche += S_k * L_k\n        \n        # 4. Calculate the final population-weighted intensity ratio\n        # I_total = p_anti * I_anti_sum + p_gauche * I_gauche_sum.\n        # Here we compare the two terms at nu_probe.\n        I_anti_at_probe = p_anti * intensity_anti\n        I_gauche_at_probe = p_gauche * intensity_gauche\n        \n        ratio = I_anti_at_probe / I_gauche_at_probe if I_gauche_at_probe != 0 else np.inf\n\n        # 5. Store results for this test case\n        results.append(p_anti)\n        results.append(ratio)\n\n    # --- Final Output ---\n    # Format the results to six decimal places and print in the required format.\n    print(f\"[{','.join(f'{x:.6f}' for x in results)}]\")\n\nsolve()\n```", "id": "2462310"}, {"introduction": "最后，我们将模拟技能应用于光谱学中的一个经典问题：同位素取代效应。通过计算并比较苯 ($C_6H_6$) 与其氘代物 ($C_6D_6$) 的拉曼光谱，你将能够量化同位素取代对振动频率和模式特征的影响。此练习引入了“氢参与率”这一概念，它揭示了同位素替换不仅改变频率，还可能改变振动模式本身的物理图像 [@problem_id:2462254]。", "problem": "考虑一个简化的、第一性原理的谐振子模型，用于研究苯的平面内振动拉曼响应，重点关注同位素取代如何改变振动频率和振动模式的特性。该分子被表示为一个由$6$个相同碳原子位点组成的环，每个碳原子与一个类氢同位素键合。每个位点提供一个碳原子的一维径向坐标$x_i$和一个相连的类氢原子的一维径向坐标$y_i$，其中$i \\in \\{0,1,2,3,4,5\\}$，并满足周期性边界条件$x_{i+6} \\equiv x_i$。将这$12$个坐标集合成一个列向量$q = (x_0,\\dots,x_5,y_0,\\dots,y_5)^{\\mathsf{T}}$。\n\n在谐振子近似下（采用国际单位制），势能为\n$$\nU(q) \\;=\\; \\frac{1}{2}\\sum_{i=0}^{5}\\Big[ k_{\\mathrm{CR}}\\,x_i^2 \\;+\\; k_{\\mathrm{CH}}\\,(x_i - y_i)^2 \\;+\\; k_{\\mathrm{CC}}\\,(x_i - x_{i+1})^2 \\Big],\n$$\n其中，$k_{\\mathrm{CH}}$是碳-氢键的弹簧常数，$k_{\\mathrm{CR}}$是一个碳径向锚定弹簧常数，代表碳骨架的恢复效应，$k_{\\mathrm{CC}}$是最近邻碳-碳耦合弹簧常数。质量矩阵是对角矩阵，每个$x_i$对应$m_{\\mathrm{C}}$，每个$y_i$对应一个依赖于同位素的$m_{\\mathrm{H}}$。令$M$表示该对角质量矩阵，$K$表示$U(q)$的海森矩阵。\n\n在谐振子近似下，振动简正模式的角频率由质量加权海森矩阵$M^{-1/2} K M^{-1/2}$的特征值$\\lambda_j$的正平方根给出，即$\\omega_j = \\sqrt{\\lambda_j}$。相应的光谱波数（以反厘米为单位）通过以下公式获得\n$$\n\\tilde{\\nu}_j \\;=\\; \\frac{\\omega_j}{2\\pi c},\n$$\n其中光速$c$以$\\mathrm{cm/s}$为单位。\n\n为了在此简化框架内模拟拉曼散射，将各向同性分子极化率对笛卡尔坐标$q$的导数定义为一个常数向量$p_u \\in \\mathbb{R}^{12}$，使得对于每个位点$i$，碳分量为$-\\beta$，类氢分量为$+\\beta$，即\n$$\n\\left(\\frac{\\partial \\alpha}{\\partial x_i}\\right) = -\\beta,\\qquad \\left(\\frac{\\partial \\alpha}{\\partial y_i}\\right) = +\\beta,\\qquad \\text{对所有 } i \\in \\{0,\\dots,5\\}.\n$$\n这个选择模拟了主要由沿每个碳-氢轴的键伸缩（$(y_i - x_i)$）主导的响应，已知这种响应对全对称拉曼活性有很强的贡献。\n\n对于一个对应于模式$j$的归一化的质量加权特征向量$e_j$（$M^{-1/2} K M^{-1/2}$的特征向量），拉曼活性代理指标$S_j$定义为\n$$\nS_j \\;\\propto\\; \\Big( p_u^{\\mathsf{T}}\\,M^{-1/2} e_j \\Big)^2,\n$$\n其中$M^{-1/2}$是对角矩阵，其元素为$1/\\sqrt{m_i}$。此表达式对应于各向同性极化率对质量加权简正坐标$Q_j$的导数的平方，在本模型中足以对相对活性进行排序。仅使用$S_j$的相对值来选择拉曼活性最强的模式。\n\n为量化同位素取代如何影响模式特性，对任意模式$j$定义氢参与比\n$$\nP_{H,j} \\;=\\; \\frac{\\sum_{i=0}^{5} u_{y_i,j}^2}{\\sum_{i=0}^{5} u_{x_i,j}^2 + \\sum_{i=0}^{5} u_{y_i,j}^2},\n$$\n其中$u_{x_i,j}$和$u_{y_i,j}$分别是模式$j$中碳和类氢坐标的物理位移分量（单位为米），通过$u_j = M^{-1/2} e_j$从质量加权特征向量获得。\n\n使用的常数和单位：\n- 统一原子质量单位 (u): $1\\,\\mathrm{u} = 1.66053906660\\times 10^{-27}\\,\\mathrm{kg}$。\n- 碳质量: $m_{\\mathrm{C}} = 12.011\\,\\mathrm{u}$。\n- 测试套件的氢同位素质量：\n  - 情况 $1$ (C$_6$H$_6$): $m_{\\mathrm{H}} = 1.00784\\,\\mathrm{u}$。\n  - 情况 $2$ (C$_6$D$_6$): $m_{\\mathrm{H}} = 2.01410\\,\\mathrm{u}$。\n  - 情况 $3$ (C$_6$T$_6$): $m_{\\mathrm{H}} = 3.01605\\,\\mathrm{u}$。\n- 弹簧常数: $k_{\\mathrm{CH}} = 500\\,\\mathrm{N/m}$， $k_{\\mathrm{CR}} = 100\\,\\mathrm{N/m}$， $k_{\\mathrm{CC}} = 50\\,\\mathrm{N/m}$。\n- 极化率导数大小: $\\beta = 1.0$，单位任意但保持一致（单位/米）。\n- 光速: $c = 2.99792458\\times 10^{10}\\,\\mathrm{cm/s}$。\n\n任务：\n对于上述三种质量情况，分别确定：\n- 单个拉曼活性最强的简正模式的波数$\\tilde{\\nu}_{\\star}$（单位为$\\mathrm{cm^{-1}}$），该模式定义为$S_j$最大的模式。\n- 该拉曼活性最强模式的氢参与比$P_{H,\\star}$。\n\n报告$\\tilde{\\nu}_{\\star}$（单位为$\\mathrm{cm^{-1}}$，四舍五入到一位小数）和$P_{H,\\star}$（小数形式，四舍五入到6位小数）。\n\n需要实现的测试套件：\n- 情况 $1$: $(m_{\\mathrm{H}} = 1.00784\\,\\mathrm{u})$。\n- 情况 $2$: $(m_{\\mathrm{H}} = 2.01410\\,\\mathrm{u})$。\n- 情况 $3$: $(m_{\\mathrm{H}} = 3.01605\\,\\mathrm{u})$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含按上述案例顺序汇总的六个结果，形式为用方括号括起来的逗号分隔列表：\n$[\\tilde{\\nu}_{\\star}^{(1)},P_{H,\\star}^{(1)},\\tilde{\\nu}_{\\star}^{(2)},P_{H,\\star}^{(2)},\\tilde{\\nu}_{\\star}^{(3)},P_{H,\\star}^{(3)}]$。", "solution": "该问题已经过验证，被认为是有效的。它具有科学依据，问题设定良好且客观，为获得唯一解提供了所有必要的数据和定义。该模型虽然是真实苯分子的简化，却是理论振动光谱学中一个标准且定义明确的问题。\n\n任务是确定在一个简化的苯及其同位素体 C$_6$H$_6$、C$_6$D$_6$ 和 C$_6$T$_6$ 模型中，拉曼活性最强的振动简正模式的波数 $\\tilde{\\nu}_{\\star}$ 和氢参与比 $P_{H,\\star}$。\n\n该系统有 $N=12$ 个自由度，由坐标向量 $q = (x_0, \\dots, x_5, y_0, \\dots, y_5)^{\\mathsf{T}}$ 描述。势能由以下公式给出\n$$ U(q) = \\frac{1}{2}\\sum_{i=0}^{5}\\Big[ k_{\\mathrm{CR}}\\,x_i^2 + k_{\\mathrm{CH}}\\,(x_i - y_i)^2 + k_{\\mathrm{CC}}\\,(x_i - x_{i+1})^2 \\Big] $$\n分析过程是通过求解广义特征值问题 $K u = \\lambda M u$ 来进行的，其中$K$是势能的海森矩阵，$M$是对角质量矩阵，$u$是位移特征向量。这等同于求解标准特征值问题 $H' e_j = \\lambda_j e_j$，其中 $H' = M^{-1/2} K M^{-1/2}$ 是质量加权海森矩阵，$e_j = M^{1/2} u_j$ 是质量加权特征向量。\n\n海森矩阵 $K_{kl} = \\frac{\\partial^2 U}{\\partial q_k \\partial q_l}$ 是一个 $12 \\times 12$ 的矩阵。它可以被划分为对应于碳（$x$）和氢（$y$）坐标的 $6 \\times 6$ 分块矩阵：\n$$ K = \\begin{pmatrix} K_{xx}  K_{xy} \\\\ K_{yx}  K_{yy} \\end{pmatrix} $$\n矩阵元素由势能函数导出：\n- $K_{x_i, x_j} = \\frac{\\partial^2 U}{\\partial x_i \\partial x_j}$: $(K_{xx})_{ii} = k_{\\mathrm{CR}} + k_{\\mathrm{CH}} + 2k_{\\mathrm{CC}}$，$(K_{xx})_{i,i\\pm 1} = -k_{\\mathrm{CC}}$（带有周期性边界），其他情况为$0$。这个子矩阵，我们称之为$A$，是一个循环矩阵。\n- $K_{y_i, y_j} = \\frac{\\partial^2 U}{\\partial y_i \\partial y_j}$: $(K_{yy})_{ij} = k_{\\mathrm{CH}} \\delta_{ij}$。因此 $K_{yy} = k_{\\mathrm{CH}} I_6$。\n- $K_{x_i, y_j} = \\frac{\\partial^2 U}{\\partial x_i \\partial y_j}$: $(K_{xy})_{ij} = -k_{\\mathrm{CH}} \\delta_{ij}$。因此 $K_{xy} = -k_{\\mathrm{CH}} I_6$。\n- $K_{yx} = K_{xy}^{\\mathsf{T}} = K_{xy}$。\n\n质量矩阵 $M$ 是对角矩阵，前$6$个元素等于$m_{\\mathrm{C}}$，后$6$个元素等于$m_{\\mathrm{H}}$。质量加权海森矩阵 $H' = M^{-1/2} K M^{-1/2}$ 则是\n$$ H' = \\begin{pmatrix} m_{\\mathrm{C}}^{-1} A  -k_{\\mathrm{CH}} (m_{\\mathrm{C}}m_{\\mathrm{H}})^{-1/2} I_6 \\\\ -k_{\\mathrm{CH}} (m_{\\mathrm{C}}m_{\\mathrm{H}})^{-1/2} I_6  k_{\\mathrm{CH}} m_{\\mathrm{H}}^{-1} I_6 \\end{pmatrix} $$\n\n由于分子的 $C_6$ 循环对称性，该问题可以大大简化。拉曼活性代理指标 $S_j$ 由 $S_j \\propto ( p_u^{\\mathsf{T}}\\,u_j )^2$ 给出，其中 $u_j = M^{-1/2} e_j$ 是物理位移向量，$p_u$ 是极化率导数向量。向量$p_u$的定义是，其所有碳坐标分量为$-\\beta$，所有类氢坐标分量为$+\\beta$。该向量属于$C_6$点群的全对称不可约表示（A型）。根据选择定则，仅当模式位移向量$u_j$也属于全对称表示时，内积$p_u^{\\mathsf{T}}\\,u_j$才非零。\n\n一个全对称模式必须对所有等效原子具有相同的位移。因此，对于这样的模式，$x_0 = x_1 = \\dots = x_5$ 且 $y_0 = y_1 = \\dots = y_5$。相应的质量加权特征向量 $e_j$ 将具有 $(e_{C,j}, \\dots, e_{C,j}, e_{H,j}, \\dots, e_{H,j})^{\\mathsf{T}}$ 的形式。\n$H'$ 对这样一个向量的作用显著简化。循环矩阵中对应于全对称模式的特征向量是 $(1, 1, 1, 1, 1, 1)^{\\mathsf{T}}$，特征值是矩阵任意一行的元素之和。对于子矩阵$A$，这个和是 $(k_{\\mathrm{CR}} + k_{\\mathrm{CH}} + 2k_{\\mathrm{CC}}) + (-k_{\\mathrm{CC}}) + (-k_{\\mathrm{CC}}) = k_{\\mathrm{CR}} + k_{\\mathrm{CH}}$。$k_{\\mathrm{CC}}$项消失了，因为在全对称振动中，所有的C-C距离保持不变。\n\n这将$12 \\times 12$的特征值问题简化为关于全对称模式振幅$(e_C, e_H)^{\\mathsf{T}}$的$2 \\times 2$问题：\n$$ H'_{\\mathrm{sym}} \\begin{pmatrix} e_C \\\\ e_H \\end{pmatrix} = \\lambda \\begin{pmatrix} e_C \\\\ e_H \\end{pmatrix}, \\quad \\text{其中} \\quad H'_{\\mathrm{sym}} = \\begin{pmatrix} (k_{\\mathrm{CR}}+k_{\\mathrm{CH}})/m_{\\mathrm{C}}  -k_{\\mathrm{CH}}/\\sqrt{m_{\\mathrm{C}}m_{\\mathrm{H}}} \\\\ -k_{\\mathrm{CH}}/\\sqrt{m_{\\mathrm{C}}m_{\\mathrm{H}}}  k_{\\mathrm{CH}}/m_{\\mathrm{H}} \\end{pmatrix} $$\n求解这个$2 \\times 2$系统得到两个特征值$\\lambda_1, \\lambda_2$和两个相应的归一化特征向量$(e_{C,1}, e_{H,1})^{\\mathsf{T}}$和$(e_{C,2}, e_{H,2})^{\\mathsf{T}}$。这是仅有的两个可能具有非零拉曼活性的模式。\n\n对于这两个模式中的每一个（$j=1,2$）：\n角频率是 $\\omega_j = \\sqrt{\\lambda_j}$，波数是 $\\tilde{\\nu}_j = \\frac{\\omega_j}{2\\pi c}$。\n物理位移振幅是 $u_{C,j} = e_{C,j}/\\sqrt{m_{\\mathrm{C}}}$ 和 $u_{H,j} = e_{H,j}/\\sqrt{m_{\\mathrm{H}}}$。\n考虑所有$6$个位点的拉曼活性代理指标是 $S_j = ( \\sum_{i=0}^5 [-\\beta u_{C,j} + \\beta u_{H,j}] )^2 = (6\\beta(u_{H,j}-u_{C,j}))^2$。\n氢参与比是 $P_{H,j} = \\frac{6 u_{H,j}^2}{6 u_{C,j}^2 + 6 u_{H,j}^2} = \\frac{u_{H,j}^2}{u_{C,j}^2 + u_{H,j}^2}$。\n\n每个同位素案例的算法如下：\n1. 定义常数并将质量从原子质量单位（$u$）转换为千克（$\\mathrm{kg}$）。\n2. 构建$2 \\times 2$矩阵$H'_{\\mathrm{sym}}$。\n3. 求解其两个特征值和特征向量。\n4. 对于得到的两个模式，分别计算$\\tilde{\\nu}_j$、$S_j$和$P_{H,j}$。\n5. 将$S_j$值最大的模式确定为拉曼活性最强的模式，用下标$\\star$表示。\n6. 按规定四舍五入后报告$\\tilde{\\nu}_{\\star}$和$P_{H,\\star}$。\n\n对给定的三种氢同位素质量重复此过程。最终结果汇总成一个列表。\n所有常数必须使用国际单位制（SI）以计算频率，最后转换为波数时，$c$的单位为$\\mathrm{cm/s}$。\n- $k_{\\mathrm{CR}} = 100\\,\\mathrm{N/m}$， $k_{\\mathrm{CH}} = 500\\,\\mathrm{N/m}$。\n- $m_{\\mathrm{C}} = 12.011 \\times 1.66053906660 \\times 10^{-27}\\,\\mathrm{kg}$。\n- $m_{\\mathrm{H}}$ 根据测试套件的案例而定。\n- $c = 2.99792458 \\times 10^{10}\\,\\mathrm{cm/s}$。\n- $\\beta = 1.0$。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the most Raman-active mode's wavenumber and hydrogen-participation\n    ratio for three benzene isotopologues based on a simplified harmonic model.\n    \"\"\"\n    \n    # Define physical constants\n    U_TO_KG = 1.66053906660e-27  # Unified atomic mass unit to kg\n    C_CMS = 2.99792458e10         # Speed of light in cm/s\n\n    # Define model parameters\n    K_CH = 500.0   # N/m\n    K_CR = 100.0   # N/m\n    BETA = 1.0     # Arbitrary units/m\n    N_SITES = 6    # Number of C-H sites\n\n    # Mass of Carbon\n    mC_u = 12.011\n    mC_kg = mC_u * U_TO_KG\n\n    # Test cases for hydrogen isotope masses\n    test_cases = [\n        1.00784,  # Case 1: Hydrogen (H)\n        2.01410,  # Case 2: Deuterium (D)\n        3.01605,  # Case 3: Tritium (T)\n    ]\n\n    results = []\n\n    for mH_u in test_cases:\n        mH_kg = mH_u * U_TO_KG\n\n        # Due to C6 symmetry, the Raman-active modes must be totally symmetric.\n        # This reduces the 12x12 eigenvalue problem to a 2x2 problem for the\n        # totally symmetric modes.\n\n        # Construct the 2x2 symmetric mass-weighted Hessian for the A-type modes.\n        # H_sym_prime = [[(k_CR+k_CH)/m_C, -k_CH/sqrt(m_C*m_H)],\n        #                [-k_CH/sqrt(m_C*m_H), k_CH/m_H]]\n        \n        H_sym_prime = np.zeros((2, 2))\n        H_sym_prime[0, 0] = (K_CR + K_CH) / mC_kg\n        H_sym_prime[1, 1] = K_CH / mH_kg\n        H_sym_prime[0, 1] = -K_CH / np.sqrt(mC_kg * mH_kg)\n        H_sym_prime[1, 0] = H_sym_prime[0, 1]\n\n        # Solve the 2x2 eigenvalue problem\n        # lambdas are eigenvalues (omega^2), e_vecs are normalized eigenvectors\n        lambdas, e_vecs = np.linalg.eigh(H_sym_prime)\n\n        mode_data = []\n        for j in range(2):\n            lambda_j = lambdas[j]\n            # Eigenvalues of a positive-semidefinite matrix should be non-negative\n            if lambda_j  0: lambda_j = 0\n            \n            omega_j = np.sqrt(lambda_j)\n            nu_tilde_j = omega_j / (2 * np.pi * C_CMS)\n            \n            e_vec = e_vecs[:, j]\n            e_C, e_H = e_vec[0], e_vec[1]\n            \n            # Calculate physical displacement amplitudes\n            u_C = e_C / np.sqrt(mC_kg)\n            u_H = e_H / np.sqrt(mH_kg)\n\n            # Calculate Raman activity proxy\n            # S_j is proportional to (d(alpha)/dQ_j)^2\n            # For a totally symmetric mode, this simplifies.\n            # Factor of N_SITES^2 comes from summing over all sites.\n            S_j = (N_SITES * BETA * (u_H - u_C))**2\n            \n            # Calculate Hydrogen-participation ratio\n            # Denominator is sum of squares of all displacement components.\n            # Simplified for totally symmetric mode.\n            den_P_H = u_C**2 + u_H**2\n            if den_P_H > 0:\n                P_H_j = (u_H**2) / den_P_H\n            else:\n                P_H_j = 0.0\n\n            mode_data.append({'nu_tilde': nu_tilde_j, 'S': S_j, 'P_H': P_H_j})\n\n        # Find the most Raman-active mode (largest S_j)\n        most_active_mode = max(mode_data, key=lambda x: x['S'])\n        \n        nu_star = most_active_mode['nu_tilde']\n        P_H_star = most_active_mode['P_H']\n\n        # Append results with specified rounding\n        results.append(round(nu_star, 1))\n        results.append(round(P_H_star, 6))\n\n    # Format the final output string\n    formatted_results = [f\"{val:.1f}\" if i % 2 == 0 else f\"{val:.6f}\" for i, val in enumerate(results)]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2462254"}]}