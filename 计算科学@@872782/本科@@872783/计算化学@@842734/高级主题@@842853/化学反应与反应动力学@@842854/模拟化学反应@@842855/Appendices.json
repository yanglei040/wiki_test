{"hands_on_practices": [{"introduction": "本练习专注于计算化学中的一项基石计算：确定反应的活化能。通过计算磷化氢（$PH_3$）的翻转能垒，您将学习如何将电子能量与零点振动能（ZPE）相结合，以获得具有物理意义的能垒高度。这项实践[@problem_id:2458040]对于理解理论预测如何与实验动力学相关联至关重要。", "problem": "您需要编写一个完整的、可运行的程序，该程序使用计算化学中物理上合理的近似方法，通过分解为电子能量差和零点振动能差来计算磷化氢的翻转能垒。\n\n基本和建模假设：\n- 在玻恩-奥本海默近似下，势能面由电子能量作为核坐标的函数定义。一个基元反应步骤的能垒高度是过渡态和反应物极小点在相同热力学条件下的能量差。\n- 在分子振动的谐振子近似中，每个振动简正模式表现为量子谐振子，其能级为 $E_v = \\left(v + \\tfrac{1}{2}\\right) h \\nu$。在零温下，具有振动频率 $\\{\\nu_i\\}$ 的驻点的零点振动能 (ZPVE) 为 $E_{\\mathrm{ZPE}} = \\tfrac{1}{2} \\sum_i h \\nu_i$。\n- 对于一阶鞍点（过渡态），恰好有一个简正模式是虚的（即，当表示为带符号的波数时 $\\nu  0$）。这个虚频对应于反应坐标，在计算 ZPVE 总和时必须排除。\n\n对于每组提供的参数集，您必须计算：\n1) 对能垒的电子贡献，\n2) 零点振动能的变化，\n3) 总能垒（前两者之和），所有值均以千焦耳/摩尔表示。\n\n使用的数学定义：\n- 令 $E_{\\mathrm{elec}}^{\\mathrm{min}}$ 和 $E_{\\mathrm{elec}}^{\\ddagger}$ 分别表示极小点和过渡态的电子能量（玻恩-奥本海默能量），单位为哈特里 (Hartree)。\n- 令 $\\{\\tilde{\\nu}_i^{\\mathrm{min}}\\}$ 和 $\\{\\tilde{\\nu}_i^{\\ddagger}\\}$ 分别表示极小点和过渡态的振动频率（波数），单位为 $\\mathrm{cm}^{-1}$。对于过渡态，恰好有一个波数可能为负（虚频）；在求 ZPVE 总和时，您必须忽略任何非正波数。\n- 使用含波数的谐振子 ZPVE 公式：$E_{\\mathrm{ZPE}} = \\tfrac{1}{2} \\sum_i h c \\tilde{\\nu}_i$，并通过阿伏伽德罗常数转换为每摩尔的量。使用下面定义的转换因子 $k_{\\mathrm{cm}}$ 来实现这一点。\n\n单位转换所需的常数：\n- 哈特里到千焦耳/摩尔：$k_{\\mathrm{H}} = 2625.499638 \\ \\mathrm{kJ \\ mol^{-1} \\ Hartree^{-1}}$。\n- 波数到千焦耳/摩尔：$k_{\\mathrm{cm}} = 0.011962662 \\ \\mathrm{kJ \\ mol^{-1} \\ cm}$。\n- 始终按 $E_{\\mathrm{ZPE}} = \\tfrac{1}{2} \\, k_{\\mathrm{cm}} \\sum_{\\tilde{\\nu}_i  0} \\tilde{\\nu}_i$ 计算 $E_{\\mathrm{ZPE}}$。\n\n计算量：\n- 电子能量差（对能垒的电子贡献）：\n$$\\Delta E_{\\mathrm{elec}} = \\left(E_{\\mathrm{elec}}^{\\ddagger} - E_{\\mathrm{elec}}^{\\mathrm{min}}\\right) \\, k_{\\mathrm{H}} \\ \\ (\\mathrm{kJ/mol}).$$\n- 零点振动能的变化：\n$$\\Delta E_{\\mathrm{ZPE}} = E_{\\mathrm{ZPE}}^{\\ddagger} - E_{\\mathrm{ZPE}}^{\\mathrm{min}} \\ \\ (\\mathrm{kJ/mol}).$$\n- 谐振子近似下零温时的总能垒：\n$$E^{\\ddagger} = \\Delta E_{\\mathrm{elec}} + \\Delta E_{\\mathrm{ZPE}} \\ \\ (\\mathrm{kJ/mol}).$$\n\n物理和数值单位：\n- 所有能量必须以 $\\mathrm{kJ/mol}$ 报告。\n- 频率以 $\\mathrm{cm}^{-1}$ 提供。\n- 电子能量以哈特里 (Hartree) 提供。\n\n测试套件：\n对于每个案例，给定 $\\left(E_{\\mathrm{elec}}^{\\mathrm{min}}, E_{\\mathrm{elec}}^{\\ddagger}, \\{\\tilde{\\nu}_i^{\\mathrm{min}}\\}, \\{\\tilde{\\nu}_i^{\\ddagger}\\}\\right)$：\n- 案例 A (磷化氢, $PH_3$)：\n  - $E_{\\mathrm{elec}}^{\\mathrm{min}} = -342.500000$\n  - $E_{\\mathrm{elec}}^{\\ddagger} = -342.446000$\n  - $\\{\\tilde{\\nu}_i^{\\mathrm{min}}\\} = [2321.0, 2335.0, 990.0, 1010.0, 1110.0, 1130.0]$\n  - $\\{\\tilde{\\nu}_i^{\\ddagger}\\} = [-700.0, 2200.0, 2210.0, 900.0, 950.0, 1000.0]$\n- 案例 B (边缘情况：电子能量差异小，ZPVE 增加较大)：\n  - $E_{\\mathrm{elec}}^{\\mathrm{min}} = -100.000000$\n  - $E_{\\mathrm{elec}}^{\\ddagger} = -99.999500$\n  - $\\{\\tilde{\\nu}_i^{\\mathrm{min}}\\} = [3000.0, 1500.0, 1400.0, 1000.0, 800.0, 600.0]$\n  - $\\{\\tilde{\\nu}_i^{\\ddagger}\\} = [-900.0, 3300.0, 1700.0, 1600.0, 1300.0, 1200.0]$\n- 案例 C (边缘情况：ZPVE 大幅减小)：\n  - $E_{\\mathrm{elec}}^{\\mathrm{min}} = -250.000000$\n  - $E_{\\mathrm{elec}}^{\\ddagger} = -249.980000$\n  - $\\{\\tilde{\\nu}_i^{\\mathrm{min}}\\} = [3200.0, 3100.0, 1500.0, 1400.0, 900.0, 800.0]$\n  - $\\{\\tilde{\\nu}_i^{\\ddagger}\\} = [-500.0, 2500.0, 1200.0, 1100.0, 700.0, 600.0]$\n- 案例 D (边界情况：存在接近零的非虚频模式，以及一个在 ZPVE 计算中需忽略的极小虚频)：\n  - $E_{\\mathrm{elec}}^{\\mathrm{min}} = -400.000000$\n  - $E_{\\mathrm{elec}}^{\\ddagger} = -399.995000$\n  - $\\{\\tilde{\\nu}_i^{\\mathrm{min}}\\} = [500.0, 600.0, 700.0, 800.0, 900.0, 1000.0]$\n  - $\\{\\tilde{\\nu}_i^{\\ddagger}\\} = [-5.0, 5.0, 600.0, 700.0, 800.0, 900.0]$\n\n编程任务：\n- 实现一个程序，对每个案例，使用上述定义计算 $E^{\\ddagger}$、$\\Delta E_{\\mathrm{elec}}$ 和 $\\Delta E_{\\mathrm{ZPE}}$（单位为 $\\mathrm{kJ/mol}$）。\n- 在计算 $E_{\\mathrm{ZPE}}^{\\ddagger}$ 和 $E_{\\mathrm{ZPE}}^{\\mathrm{min}}$ 的总和时，忽略任何非正波数。\n- 程序不得读取任何输入；它必须使用上面的测试套件作为内置数据。\n\n最终输出格式：\n- 生成单行输出，包含一个列表的列表。每个内部列表对应一个案例，且必须是 $[E^{\\ddagger}, \\Delta E_{\\mathrm{elec}}, \\Delta E_{\\mathrm{ZPE}}]$ 的形式，其中每个浮点数四舍五入到六位小数。\n- 输出必须按 A、B、C、D 的顺序包含所有案例，并打印为用方括号括起来的逗号分隔列表，不含任何额外文本。例如：$[[x_1,y_1,z_1],[x_2,y_2,z_2],\\dots]$。", "solution": "我们旨在利用电子结构理论和分子振动的核心原理，将磷化氢的翻转能垒分解为电子贡献和零点振动贡献进行求解。\n\n原理和公式：\n1) 玻恩-奥本海默近似：分子势能面由电子能量作为核坐标的函数给出。对于一个反应步骤，在零温下，极小点和过渡态之间的能垒是过渡态和极小点在相同条件下的能量差。将电子能量表示为 $E_{\\mathrm{elec}}^{\\mathrm{min}}$ 和 $E_{\\mathrm{elec}}^{\\ddagger}$（单位为哈特里）。对能垒的电子贡献（单位为 $\\mathrm{kJ/mol}$）为\n$$\\Delta E_{\\mathrm{elec}} = \\left(E_{\\mathrm{elec}}^{\\ddagger} - E_{\\mathrm{elec}}^{\\mathrm{min}}\\right) \\, k_{\\mathrm{H}},$$\n其中 $k_{\\mathrm{H}} = 2625.499638 \\ \\mathrm{kJ \\ mol^{-1} \\ Hartree^{-1}}$。\n\n2) 振动的谐振子近似：每个波数为 $\\tilde{\\nu}_i$（单位为 $\\mathrm{cm}^{-1}$）的简正模式的零点贡献为 $\\tfrac{1}{2} h \\nu_i$。使用 $\\nu_i = c \\tilde{\\nu}_i$ 并通过阿伏伽德罗常数转换为每摩尔的单位后，零点振动能 (ZPVE) 变为\n$$E_{\\mathrm{ZPE}} = \\frac{1}{2} \\sum_i h c \\tilde{\\nu}_i \\, N_{\\mathrm{A}} = \\frac{1}{2} \\, k_{\\mathrm{cm}} \\sum_i \\tilde{\\nu}_i,$$\n其中 $k_{\\mathrm{cm}} = 0.011962662 \\ \\mathrm{kJ \\ mol^{-1} \\ cm}$。对于过渡态，虚频模式对应于反应坐标，且不应对鞍点处的零点涨落做出贡献。因此，在为任一驻点计算 $E_{\\mathrm{ZPE}}$ 时，我们只包含严格为正的波数：\n$$E_{\\mathrm{ZPE}} = \\frac{1}{2} \\, k_{\\mathrm{cm}} \\sum_{\\tilde{\\nu}_i  0} \\tilde{\\nu}_i.$$\n从极小点到过渡态的 ZPVE 变化为\n$$\\Delta E_{\\mathrm{ZPE}} = E_{\\mathrm{ZPE}}^{\\ddagger} - E_{\\mathrm{ZPE}}^{\\mathrm{min}}.$$\n\n3) 在零温下的总能垒（谐振子、玻恩-奥本海默近似）是电子能量差和 ZPVE 变化的总和：\n$$E^{\\ddagger} = \\Delta E_{\\mathrm{elec}} + \\Delta E_{\\mathrm{ZPE}}.$$\n\n算法步骤：\n- 对每个案例，读取 $E_{\\mathrm{elec}}^{\\mathrm{min}}$ 和 $E_{\\mathrm{elec}}^{\\ddagger}$（单位：哈特里）以及两组波数（单位：$\\mathrm{cm}^{-1}$）。\n- 通过乘以 $k_{\\mathrm{H}}$ 计算 $\\Delta E_{\\mathrm{elec}}$。\n- 将严格为正的波数之和乘以 $k_{\\mathrm{cm}}$ 再取一半，从而计算 $E_{\\mathrm{ZPE}}^{\\mathrm{min}}$ 和 $E_{\\mathrm{ZPE}}^{\\ddagger}$。\n- 计算两者之差得到 $\\Delta E_{\\mathrm{ZPE}}$。\n- 求和得到 $E^{\\ddagger}$。\n- 将每个报告值四舍五入到六位小数，并按规定格式输出结果。\n\n案例 A ($PH_3$) 的手动验证：\n- 给定 $E_{\\mathrm{elec}}^{\\mathrm{min}} = -342.500000$ 和 $E_{\\mathrm{elec}}^{\\ddagger} = -342.446000$（哈特里），电子能量差为\n$$\\Delta E_{\\mathrm{elec}} = ( -342.446000 - (-342.500000)) \\times 2625.499638 = 0.054000 \\times 2625.499638 = 141.776980 \\ \\mathrm{kJ/mol}.$$\n- 极小点波数总和为 $2321.0 + 2335.0 + 990.0 + 1010.0 + 1110.0 + 1130.0 = 8896.0 \\ \\mathrm{cm}^{-1}$，因此\n$$E_{\\mathrm{ZPE}}^{\\mathrm{min}} = \\frac{1}{2} \\times 0.011962662 \\times 8896.0 = 53.209920576 \\ \\mathrm{kJ/mol}.$$\n- 过渡态波数（忽略虚频 $-700.0$）总和为 $2200.0 + 2210.0 + 900.0 + 950.0 + 1000.0 = 8260.0 \\ \\mathrm{cm}^{-1}$，因此\n$$E_{\\mathrm{ZPE}}^{\\ddagger} = \\frac{1}{2} \\times 0.011962662 \\times 8260.0 = 49.405794060 \\ \\mathrm{kJ/mol}.$$\n- 因此\n$$\\Delta E_{\\mathrm{ZPE}} = 49.405794060 - 53.209920576 = -3.804126516 \\ \\mathrm{kJ/mol},$$\n能垒为\n$$E^{\\ddagger} = 141.776980 + (-3.804126516) = 137.972853484 \\ \\mathrm{kJ/mol},$$\n四舍五入到六位小数为 $137.972854 \\ \\mathrm{kJ/mol}$。\n\n对其他案例应用相同的步骤可得：\n- 案例 B：\n  - $\\Delta E_{\\mathrm{elec}} = 1.312750 \\ \\mathrm{kJ/mol}$，\n  - $\\Delta E_{\\mathrm{ZPE}} = 4.785065 \\ \\mathrm{kJ/mol}$，\n  - $E^{\\ddagger} = 6.097815 \\ \\mathrm{kJ/mol}$。\n- 案例 C：\n  - $\\Delta E_{\\mathrm{elec}} = 52.509993 \\ \\mathrm{kJ/mol}$，\n  - $\\Delta E_{\\mathrm{ZPE}} = -28.710389 \\ \\mathrm{kJ/mol}$，\n  - $E^{\\ddagger} = 23.799604 \\ \\mathrm{kJ/mol}$。\n- 案例 D：\n  - $\\Delta E_{\\mathrm{elec}} = 13.127498 \\ \\mathrm{kJ/mol}$，\n  - $\\Delta E_{\\mathrm{ZPE}} = -8.942090 \\ \\mathrm{kJ/mol}$，\n  - $E^{\\ddagger} = 4.185408 \\ \\mathrm{kJ/mol}$。\n\n程序精确地实现了这些计算，并按照 A、B、C、D 的顺序，将结果打印为单行的列表之列表，且按要求保留六位小数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport math\n\nHARTREE_TO_KJMOL = 2625.499638\nCM_TO_KJMOL = 0.011962662  # hc*N_A expressed as kJ/mol per cm^-1\n\ndef zpe_kjmol(freqs_cm):\n    # Sum only strictly positive wavenumbers (ignore imaginary or zero)\n    positive_sum = sum(f for f in freqs_cm if f > 0.0)\n    return 0.5 * CM_TO_KJMOL * positive_sum\n\ndef barrier_decomposition(E_elec_min_h, E_elec_ts_h, freqs_min_cm, freqs_ts_cm):\n    delta_elec_kj = (E_elec_ts_h - E_elec_min_h) * HARTREE_TO_KJMOL\n    zpe_min = zpe_kjmol(freqs_min_cm)\n    zpe_ts = zpe_kjmol(freqs_ts_cm)\n    delta_zpe_kj = zpe_ts - zpe_min\n    barrier_kj = delta_elec_kj + delta_zpe_kj\n    return barrier_kj, delta_elec_kj, delta_zpe_kj\n\ndef format_results(results):\n    # results is a list of tuples (barrier, delta_elec, delta_zpe)\n    inner_lists = []\n    for b, de, dz in results:\n        inner = f\"[{b:.6f},{de:.6f},{dz:.6f}]\"\n        inner_lists.append(inner)\n    return \"[\" + \",\".join(inner_lists) + \"]\"\n\ndef solve():\n    test_cases = [\n        # Case A: PH3\n        {\n            \"E_min_h\": -342.500000,\n            \"E_ts_h\": -342.446000,\n            \"freqs_min_cm\": [2321.0, 2335.0, 990.0, 1010.0, 1110.0, 1130.0],\n            \"freqs_ts_cm\": [-700.0, 2200.0, 2210.0, 900.0, 950.0, 1000.0],\n        },\n        # Case B: small electronic difference, ZPVE increases\n        {\n            \"E_min_h\": -100.000000,\n            \"E_ts_h\": -99.999500,\n            \"freqs_min_cm\": [3000.0, 1500.0, 1400.0, 1000.0, 800.0, 600.0],\n            \"freqs_ts_cm\": [-900.0, 3300.0, 1700.0, 1600.0, 1300.0, 1200.0],\n        },\n        # Case C: substantial ZPVE decrease\n        {\n            \"E_min_h\": -250.000000,\n            \"E_ts_h\": -249.980000,\n            \"freqs_min_cm\": [3200.0, 3100.0, 1500.0, 1400.0, 900.0, 800.0],\n            \"freqs_ts_cm\": [-500.0, 2500.0, 1200.0, 1100.0, 700.0, 600.0],\n        },\n        # Case D: boundary with near-zero positive mode and tiny imaginary\n        {\n            \"E_min_h\": -400.000000,\n            \"E_ts_h\": -399.995000,\n            \"freqs_min_cm\": [500.0, 600.0, 700.0, 800.0, 900.0, 1000.0],\n            \"freqs_ts_cm\": [-5.0, 5.0, 600.0, 700.0, 800.0, 900.0],\n        },\n    ]\n\n    results = []\n    for case in test_cases:\n        b, de, dz = barrier_decomposition(\n            case[\"E_min_h\"],\n            case[\"E_ts_h\"],\n            case[\"freqs_min_cm\"],\n            case[\"freqs_ts_cm\"],\n        )\n        results.append((b, de, dz))\n\n    print(format_results(results))\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2458040"}, {"introduction": "反应机理可大致分为涉及稳定中间体的“分步”机理或一步完成的“协同”机理。本练习[@problem_id:2457998]使用一个解析势能面来探索不同运动之间的耦合如何决定反应路径。通过定位所有驻点，您将定量地判断一个模型化的螯合反应是分步进行还是协同进行，从而深刻理解反应坐标的本质。", "problem": "您将使用简化的双坐标势能面对铅离子被乙二胺四乙酸（EDTA）螯合的过程进行建模。每个坐标代表一个柔性供体臂朝向金属中心配位的进程。将此过程视为在由以下函数定义的二维势能面（PES）上发生：\n$$\nV(x_1,x_2) = a\\left[\\left(x_1^2 - 1\\right)^2 + \\left(x_2^2 - 1\\right)^2\\right] - b\\,x_1 x_2,\n$$\n其中，$x_1$ 和 $x_2$ 是两个配体臂的无量纲反应坐标，$a$ 和 $b$ 是单位为千焦耳/摩尔（kJ/mol）的正能量参数，$V$ 是势能，单位为 kJ/mol。假设 $x_i \\approx -1$ 对应于未配位的臂，$x_i \\approx +1$ 对应于已配位的臂。在此模型中，全局反应物极小值位于一个同号驻点，其中 $x_1$ 和 $x_2$ 均为负值；全局产物极小值是其对称对应点，其中两者均为正值。\n\n分类定义：\n- 中间体是 $V(x_1,x_2)$ 中除全局反应物和产物极小值之外的任何局部极小值。\n- 过渡态（TS）是 $V(x_1,x_2)$ 的任何一阶鞍点，即黑塞矩阵恰好有一个负特征值和一个正特征值的驻点。\n- 如果在反应物和产物之间至少存在一个中间体，则该机理称为分步机理；如果不存在这样的中间体，则称为协同机理。\n\n您的程序必须针对下面的测试套件中的每个参数集，从第一性原理出发完成以下所有操作：\n1. 根据上述数学定义应用于给定的 $V(x_1,x_2)$，定位并分类与反应相关的所有驻点（所有局部极小值和所有一阶鞍点）。\n2. 根据上述定义，确定反应机理是分步的还是协同的。\n3. 计算最小能垒高度 $\\Delta E^\\ddagger$，单位为 kJ/mol，定义为连接全局反应物和产物极小值的所有可行反应路径中，该路径上的最大能量减去全局反应物极小值能量的最小值。将 $\\Delta E^\\ddagger$ 以 kJ/mol 为单位表示，并四舍五入到六位小数。\n\n您必须将具有零黑塞特征值的驻点既不视为中间体也不视为过渡态。\n\n测试套件（每个案例是一对 (a,b)，单位为 kJ/mol）：\n- 案例1（一般弱耦合）：$(a,b) = (10,10)$。\n- 案例2（中等耦合）：$(a,b) = (10,30)$。\n- 案例3（强耦合）：$(a,b) = (10,60)$。\n- 案例4（中间体消失的边界条件）：$(a,b) = (10,20)$。\n\n每个案例的所需输出：\n- 一个列表 $[m, n_i, n_{ts}, \\Delta E^\\ddagger]$，其中 $m$ 是一个整数机理标志（$0$ 表示分步，$1$ 表示协同），$n_i$ 是中间体的整数数量，$n_{ts}$ 是过渡态的整数数量，$\\Delta E^\\ddagger$ 是一个以 kJ/mol 为单位的浮点数，四舍五入到六位小数。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含四个测试案例结果的逗号分隔列表，按顺序排列，并用方括号括起来。例如：[[m1,n1,ts1,barrier1],[m2,n2,ts2,barrier2],[m3,n3,ts3,barrier3],[m4,n4,ts4,barrier4]]。", "solution": "该问题是有效的，因为它提出了一个定义明确的化学过程数学模型，该模型基于势能面和反应坐标分析的原理。所有定义都是精确的，并且提供了所有必要的参数。该问题作为一个理论模型，是自洽的、一致的且在科学上是合理的。我们将从第一性原理出发进行求解。\n\n势能面由以下函数给出：\n$$\nV(x_1,x_2) = a\\left[\\left(x_1^2 - 1\\right)^2 + \\left(x_2^2 - 1\\right)^2\\right] - b\\,x_1 x_2\n$$\n其中 $a$ 和 $b$ 是正参数。\n\n**1. 定位驻点**\n驻点出现在势能梯度 $\\nabla V$ 为零的地方。梯度的分量为：\n$$\n\\frac{\\partial V}{\\partial x_1} = 4a x_1 (x_1^2 - 1) - b x_2 = 0\n$$\n$$\n\\frac{\\partial V}{\\partial x_2} = 4a x_2 (x_2^2 - 1) - b x_1 = 0\n$$\n这是一个由两个耦合三次方程组成的方程组。我们通过考虑基于坐标对称性的几种情况来解这个方程组。\n\n*   **情况 I：原点 $(0,0)$**\n    如果 $x_1=0$ 且 $x_2=0$，两个方程都满足，所以 $(0,0)$ 是一个驻点。\n\n*   **情况 II：对称点, $x_1 = x_2 = x$**\n    方程变为相同的形式：$4ax(x^2 - 1) - bx = 0$。这给出 $x[4a(x^2-1) - b] = 0$。\n    一个解是 $x=0$，这回到了原点。其他解来自 $4a(x^2-1) = b$，得出 $x^2 = 1 + \\frac{b}{4a}$。因为 $a,b  0$，这对 $x$ 总是有两个实根：\n    $$\n    x = \\pm\\sqrt{1 + \\frac{b}{4a}}\n    $$\n    这给出了两个对称的驻点：$(x,x)$ 和 $(-x,-x)$。根据问题陈述，它们分别对应于全局产物和反应物极小值。\n\n*   **情况 III：反对称点, $x_1 = -x_2 = x$**\n    第一个方程变为 $4ax(x^2 - 1) - b(-x) = 0$，得到 $x[4a(x^2-1) + b] = 0$。\n    一个解是 $x=0$（原点）。其他解来自 $4a(x^2-1) = -b$，得出 $x^2 = 1 - \\frac{b}{4a}$。\n    这些解只有在 $1 - \\frac{b}{4a} \\ge 0$ 或 $b \\le 4a$ 时才是实数。如果这个条件成立，我们有：\n    $$\n    x = \\pm\\sqrt{1 - \\frac{b}{4a}}\n    $$\n    这给出了两个反对称的驻点：$(x,-x)$ 和 $(-x,x)$。\n\n*   **情况 IV：非对称点, $x_1^2 \\ne x_2^2$**\n    通过将两个梯度方程相加和相减，我们得到两个条件：$(x_1+x_2)[b-4a(x_1^2-x_1x_2+x_2^2-1)]=0$ 和 $(x_1-x_2)[b+4a(x_1^2+x_1x_2+x_2^2-1)]=0$。对于非对称点（$x_1 \\ne \\pm x_2$），每个表达式中的第二个因子必须为零。解这个关于 $(x_1^2+x_2^2)$ 和 $x_1x_2$ 的线性方程组，得到：\n    $$\n    x_1^2 + x_2^2 = 1\n    $$\n    $$\n    x_1x_2 = -\\frac{b}{4a}\n    $$\n    如果可以找到 $x_1, x_2$ 的实数解，这些点就存在。由 $(x_1+x_2)^2 = x_1^2+x_2^2+2x_1x_2 = 1-b/(2a)$ 和 $(x_1-x_2)^2 = 1+b/(2a)$，实数解要求 $1-b/(2a) \\ge 0$，即 $b \\le 2a$。如果 $b  2a$，我们找到四个不同的非对称驻点。如果 $b=2a$，这些点与情况 III 中的反对称点合并。\n\n**2. 分类驻点**\n分类需要黑塞矩阵 $H$：\n$$\nH(x_1, x_2) = \\begin{pmatrix} 12ax_1^2 - 4a  -b \\\\ -b  12ax_2^2 - 4a \\end{pmatrix}\n$$\n驻点的性质由 $H$ 的特征值的符号决定。\n\n*   **在 $(0,0)$ 处**：$H(0,0) = \\begin{pmatrix} -4a  -b \\\\ -b  -4a \\end{pmatrix}$。特征值为 $\\lambda = -4a \\pm b$。\n    - 如果 $b  4a$，两个特征值都是负数（局部极大值）。\n    - 如果 $b  4a$，一个为正，一个为负（鞍点，TS）。\n    - 如果 $b=4a$，一个特征值为零（简并点）。\n\n*   **在对称点 $(x,x)$ 和 $(-x,-x)$ 处，其中 $x^2 = 1 + b/(4a)$**：\n    黑塞矩阵的对角元素为 $12a(1+b/(4a)) - 4a = 8a+3b$。特征值为 $\\lambda = (8a+3b) \\pm b$，得到 $\\lambda_1 = 8a+2b$ 和 $\\lambda_2 = 8a+4b$。两者始终为正。这些是反应物和产物的极小值。\n\n*   **在反对称点 $(x,-x)$ 和 $(-x,x)$ 处，其中 $x^2 = 1 - b/(4a)$（当 $b \\le 4a$ 时存在）**：\n    对角元素为 $12a(1-b/(4a)) - 4a = 8a-3b$。特征值为 $\\lambda = (8a-3b) \\pm b$，得到 $\\lambda_1 = 8a-4b = 4(2a-b)$ 和 $\\lambda_2 = 8a-2b = 2(4a-b)$。\n    - 对于 $b4a$，$\\lambda_2  0$。$\\lambda_1$ 的符号决定其性质。\n    - 如果 $b  2a$，$\\lambda_1  0$，所以两个特征值都为正（局部极小值，即中间体）。\n    - 如果 $b  2a$，$\\lambda_1  0$，所以一个为正，一个为负（鞍点，TS）。\n    - 如果 $b = 2a$，$\\lambda_1 = 0$（简并点）。\n\n*   **在非对称点处（当 $b  2a$ 时存在）**：\n    黑塞矩阵的行列式为 $\\det(H) = 8(b^2 - 4a^2)$。由于它们在 $b  2a$ 时存在，$b^2  4a^2$，因此 $\\det(H)  0$。负的行列式意味着特征值符号相反。这些点始终是鞍点（TS）。\n\n**3. 反应机理和能垒高度分析**\n机理和能垒取决于 $b$ 与 $a$ 的比值。\n\n*   **区域 1: $b  2a$**\n    - 驻点：反应物/产物极小值，2个中间体（反对称点），4个过渡态（非对称点），和1个局部极大值（原点）。\n    - 机理：分步（$m=0$），因为存在中间体。\n    - 数量：$n_i=2$, $n_{ts}=4$。\n    - 能垒：路径为 反应物 $\\to$ TS1 $\\to$ 中间体 $\\to$ TS2 $\\to$ 产物。最高点是非对称的过渡态。\n      $E_R = V(-\\sqrt{1+\\frac{b}{4a}}, -\\sqrt{1+\\frac{b}{4a}}) = -b - \\frac{b^2}{8a}$。\n      $E_{TS} = V_{\\text{asymm}} = a+\\frac{b^2}{8a}$。\n      $\\Delta E^\\ddagger = E_{TS} - E_R = (a+\\frac{b^2}{8a}) - (-b - \\frac{b^2}{8a}) = a+b+\\frac{b^2}{4a}$。\n\n*   **区域 2: $b = 2a$ (分岔)**\n    - 来自区域 1 的中间体和过渡态合并成两个简并点，根据问题的定义，它们既不是中间体也不是过渡态。\n    - 机理：协同（$m=1$），因为没有中间体。\n    - 数量：$n_i=0$, $n_{ts}=0$。\n    - 能垒：能垒高度是连续的。在 $b=2a$ 处使用任一侧的公式：\n      $\\Delta E^\\ddagger = a+(2a)+\\frac{(2a)^2}{4a} = 3a+a = 4a$。同样，使用 $b2a$ 的公式，$\\Delta E^\\ddagger=2b=2(2a)=4a$。\n\n*   **区域 3: $2a  b  4a$**\n    - 驻点：反应物/产物极小值，2个过渡态（反对称点），和1个局部极大值（原点）。没有中间体。\n    - 机理：协同（$m=1$）。\n    - 数量：$n_i=0$, $n_{ts}=2$。\n    - 能垒：路径为 反应物 $\\to$ TS $\\to$ 产物，通过一个反对称的过渡态。\n      $E_{TS} = V_{\\text{anti}} = b-\\frac{b^2}{8a}$。\n      $\\Delta E^\\ddagger = E_{TS} - E_R = (b-\\frac{b^2}{8a}) - (-b - \\frac{b^2}{8a}) = 2b$。\n\n*   **区域 4: $b = 4a$ (分岔)**\n    - 来自区域 3 的两个过渡态与原点合并成一个简并点。\n    - 机理：协同（$m=1$）。\n    - 数量：$n_i=0$, $n_{ts}=0$。\n    - 能垒：连续性给出 $\\Delta E^\\ddagger = 2b = 2(4a) = 8a$。\n\n*   **区域 5: $b  4a$**\n    - 驻点：反应物/产物极小值，1个过渡态（原点）。\n    - 机理：协同（$m=1$）。\n    - 数量：$n_i=0$, $n_{ts}=1$。\n    - 能垒：路径为 反应物 $\\to$ TS(原点) $\\to$ 产物。\n      $E_{TS} = V(0,0) = 2a$。\n      $\\Delta E^\\ddagger = E_{TS} - E_R = 2a - (-b - \\frac{b^2}{8a}) = 2a+b+\\frac{b^2}{8a}$。\n\n**4. 应用于测试案例**\n\n*   **案例 1: $(a,b) = (10,10)$**。这里 $b=10  2a=20$。这是区域 1。\n    $m=0$, $n_i=2$, $n_{ts}=4$。\n    $\\Delta E^\\ddagger = 10+10+\\frac{10^2}{4 \\cdot 10} = 20 + 2.5 = 22.5$。\n    结果: $[0, 2, 4, 22.500000]$。\n\n*   **案例 2: $(a,b) = (10,30)$**。这里 $2a=20  b=30  4a=40$。这是区域 3。\n    $m=1$, $n_i=0$, $n_{ts}=2$。\n    $\\Delta E^\\ddagger = 2 \\cdot 30 = 60$。\n    结果: $[1, 0, 2, 60.000000]$。\n\n*   **案例 3: $(a,b) = (10,60)$**。这里 $b=60  4a=40$。这是区域 5。\n    $m=1$, $n_i=0$, $n_{ts}=1$。\n    $\\Delta E^\\ddagger = 2 \\cdot 10 + 60 + \\frac{60^2}{8 \\cdot 10} = 20 + 60 + \\frac{3600}{80} = 80 + 45 = 125$。\n    结果: $[1, 0, 1, 125.000000]$。\n\n*   **案例 4: $(a,b) = (10,20)$**。这里 $b=20 = 2a$。这是区域 2。\n    $m=1$, $n_i=0$, $n_{ts}=0$。\n    $\\Delta E^\\ddagger = 4a = 4 \\cdot 10 = 40$。\n    结果: $[1, 0, 0, 40.000000]$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the chelation modeling problem for a given set of test cases.\n\n    The solution is based on an analytical derivation of the stationary points of the\n    potential energy surface and their classification using the Hessian matrix. The\n    character of the reaction mechanism (stepwise vs. concerted), the number of\n    intermediates and transition states, and the minimum energy barrier are determined\n    by the ratio of the parameters b and a.\n\n    The potential energy surface is V(x1, x2) = a[(x1^2-1)^2 + (x2^2-1)^2] - b*x1*x2.\n    The analysis reveals several regimes based on parameter values:\n    1. b  2a: Stepwise mechanism with 2 intermediates and 4 transition states.\n    2. b = 2a: A bifurcation point. Concerted mechanism, 0 intermediates, 0 TS.\n    3. 2a  b  4a: Concerted mechanism with 2 transition states.\n    4. b = 4a: A bifurcation point. Concerted mechanism, 0 intermediates, 0 TS.\n    5. b > 4a: Concerted mechanism with 1 transition state at the origin.\n\n    The barrier height Delta_E_ddagger is calculated using derived formulas for each regime.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (a, b) in kJ/mol\n        (10.0, 10.0),  # Case 1\n        (10.0, 30.0),  # Case 2\n        (10.0, 60.0),  # Case 3\n        (10.0, 20.0),  # Case 4\n    ]\n\n    results = []\n    for case in test_cases:\n        a, b = case\n        \n        m = 0          # mechanism flag (0=stepwise, 1=concerted)\n        n_i = 0        # number of intermediates\n        n_ts = 0       # number of transition states\n        delta_e = 0.0  # barrier height\n\n        # Use a small tolerance for floating point comparisons at boundaries.\n        tol = 1e-9\n\n        if b  2 * a - tol:\n            # Regime 1: Stepwise\n            m = 0\n            n_i = 2\n            n_ts = 4\n            delta_e = a + b + (b**2) / (4 * a)\n        elif abs(b - 2 * a) = tol:\n            # Regime 2: Bifurcation at b = 2a\n            m = 1\n            n_i = 0\n            n_ts = 0\n            delta_e = 4 * a\n        elif b > 2 * a + tol and b  4 * a - tol:\n            # Regime 3: Concerted\n            m = 1\n            n_i = 0\n            n_ts = 2\n            delta_e = 2 * b\n        elif abs(b - 4 * a) = tol:\n            # Regime 4: Bifurcation at b = 4a\n            m = 1\n            n_i = 0\n            n_ts = 0\n            delta_e = 8 * a\n        else: # b > 4 * a + tol\n            # Regime 5: Concerted\n            m = 1\n            n_i = 0\n            n_ts = 1\n            delta_e = 2 * a + b + (b**2) / (8 * a)\n\n        # Format the result list for the current case.\n        # Barrier height is rounded to six decimal places as requested.\n        result_case = [m, n_i, n_ts, round(delta_e, 6)]\n        results.append(result_case)\n\n    # Final print statement in the exact required format.\n    # Convert each inner list to its string representation and join them.\n    # The str() function on a list produces the desired '[...]' format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2457998"}, {"introduction": "模拟涉及自由基的反应带来了一个独特的挑战，即“自旋污染”，其中非限制性计算产生的波函数不是纯粹的自旋态。本练习[@problem_id:2458013]将指导您推导并应用一种投影方法来校正这种计算假象，并使用自旋平方算符的期望值 $\\langle \\hat{S}^2 \\rangle$ 作为指标。准确处理自旋对于获得开壳层体系可靠的能量和能垒至关重要。", "problem": "题目要求您量化并解释自旋污染对自由基加成过渡态计算势垒高度的影响。在此计算中，您需要使用非限制性方法，如非限制性Hartree–Fock (UHF) 或非限制性密度泛函理论 (UDFT)，并通过总自旋平方算符的期望值 $\\,\\langle \\hat{S}^2 \\rangle\\,$ 来衡量自旋污染。计算需在 Born–Oppenheimer 近似框架下进行，并忽略零点能和热效应等核运动校正。低自旋势能面为自旋量子数 $\\,S_{\\mathrm{LS}}=1/2\\,$ 的双重态，而造成污染的高自旋态为 $\\,S_{\\mathrm{HS}}=3/2\\,$ 的四重态。假设在每种几何构型下，破缺对称性的低自旋解是纯自旋低自旋本征态和高自旋本征态的线性组合，且该组合符合 $\\hat{S}^2$ 的本征值方程以及态混合的能量线性关系。\n\n仅从以下基本依据出发：\n- 总自旋算符满足 $\\,\\hat{S}^2 \\lvert S,M_S \\rangle = S(S+1)\\hbar^2 \\lvert S,M_S \\rangle\\,$，因此纯双重态的 $\\,\\langle \\hat{S}^2 \\rangle = S_{\\mathrm{LS}}(S_{\\mathrm{LS}}+1)=0.75\\,$，纯四重态的 $\\,\\langle \\hat{S}^2 \\rangle = S_{\\mathrm{HS}}(S_{\\mathrm{HS}}+1)=3.75\\,$。\n- 在双态线性混合模型中，任何线性算符（包括 $\\,\\hat{S}^2\\,$ 和电子哈密顿量）的期望值是其在各组分纯态上期望值的加权和。\n- 在 Born–Oppenheimer 近似下并忽略核校正，电子势垒高度定义为 $\\,\\Delta E = E_{\\mathrm{TS}} - E_{\\mathrm{R}}\\,$, 其中 $\\,E_{\\mathrm{TS}}\\,$ 和 $\\,E_{\\mathrm{R}}\\,$ 分别是过渡态和反应物在各自驻点上的电子能量。\n\n您的任务是：\n1. 仅使用上述基本依据，从第一性原理出发，推导一个表达式，用于从破缺对称性低自旋能量 $\\,E_{\\mathrm{BS}}\\,$、其自旋期望值 $\\,\\langle \\hat{S}^2 \\rangle_{\\mathrm{BS}}\\,$ 以及在相同几何构型下相应的纯高自旋能量 $\\,E_{\\mathrm{HS}}\\,$ 中恢复纯低自旋电子能量 $\\,E_{\\mathrm{LS}}\\,$。此推导假设仅存在低自旋态和高自旋态之间的混合。\n2. 使用您推导的表达式计算反应物和过渡态几何构型的自旋投影低自旋能量，然后计算自旋投影的势垒高度 $\\,\\Delta E_{\\mathrm{proj}}\\,$，并将其与直接从破缺对称性低自旋能量获得的未投影势垒高度 $\\,\\Delta E_{\\mathrm{uncorr}}\\,$ 进行比较。报告势垒高度的变化量 $\\,\\Delta\\Delta E = \\Delta E_{\\mathrm{proj}} - \\Delta E_{\\mathrm{uncorr}}\\,$。\n3. 使用转换因子 $\\,1\\,\\text{Hartree} = 2625.49962\\,\\text{kJ mol}^{-1}\\,$，将最终答案以千焦/摩尔（$\\,\\text{kJ mol}^{-1}\\,$）为单位表示。将报告的每个数值四舍五入到恰好三位小数。\n\n将您的推导过程实现为一个完整的、可运行的程序，该程序不接受任何输入，并处理以下测试套件。每个测试用例针对给定的几何构型类型（反应物 R 和过渡态 TS），提供了以 Hartree 为单位的破缺对称性低自旋能量 $\\,E_{\\mathrm{BS}}\\,$、以 Hartree 为单位的纯高自旋能量 $\\,E_{\\mathrm{HS}}\\,$，以及破缺对称性自旋期望值 $\\,\\langle \\hat{S}^2 \\rangle_{\\mathrm{BS}}\\,$。所有情况均使用 $\\,S_{\\mathrm{LS}}=1/2\\,$ 和 $\\,S_{\\mathrm{HS}}=3/2\\,$。\n\n测试套件（所有能量单位为 Hartree，所有 $\\,\\langle \\hat{S}^2 \\rangle\\,$ 均为无量纲）：\n- 情况 $\\,1\\,$（中等污染，在过渡态处更强）：\n  - 反应物：$\\,E_{\\mathrm{BS}}^{\\mathrm{R}} = -232.500000\\,$, $\\,E_{\\mathrm{HS}}^{\\mathrm{R}} = -232.470000\\,$, $\\,\\langle \\hat{S}^2 \\rangle_{\\mathrm{BS}}^{\\mathrm{R}} = 0.90\\,$。\n  - 过渡态：$\\,E_{\\mathrm{BS}}^{\\mathrm{TS}} = -232.460000\\,$, $\\,E_{\\mathrm{HS}}^{\\mathrm{TS}} = -232.410000\\,$, $\\,\\langle \\hat{S}^2 \\rangle_{\\mathrm{BS}}^{\\mathrm{TS}} = 1.20\\,$。\n- 情况 $\\,2\\,$（两种几何构型均无污染）：\n  - 反应物：$\\,E_{\\mathrm{BS}}^{\\mathrm{R}} = -152.345678\\,$, $\\,E_{\\mathrm{HS}}^{\\mathrm{R}} = -152.300000\\,$, $\\,\\langle \\hat{S}^2 \\rangle_{\\mathrm{BS}}^{\\mathrm{R}} = 0.75\\,$。\n  - 过渡态：$\\,E_{\\mathrm{BS}}^{\\mathrm{TS}} = -152.310000\\,$, $\\,E_{\\mathrm{HS}}^{\\mathrm{TS}} = -152.260000\\,$, $\\,\\langle \\hat{S}^2 \\rangle_{\\mathrm{BS}}^{\\mathrm{TS}} = 0.75\\,$。\n- 情况 $\\,3\\,$（过渡态处强污染，反应物处轻微污染）：\n  - 反应物：$\\,E_{\\mathrm{BS}}^{\\mathrm{R}} = -180.000000\\,$, $\\,E_{\\mathrm{HS}}^{\\mathrm{R}} = -179.970000\\,$, $\\,\\langle \\hat{S}^2 \\rangle_{\\mathrm{BS}}^{\\mathrm{R}} = 0.78\\,$。\n  - 过渡态：$\\,E_{\\mathrm{BS}}^{\\mathrm{TS}} = -179.960000\\,$, $\\,E_{\\mathrm{HS}}^{\\mathrm{TS}} = -179.880000\\,$, $\\,\\langle \\hat{S}^2 \\rangle_{\\mathrm{BS}}^{\\mathrm{TS}} = 1.45\\,$。\n- 情况 $\\,4\\,$（高自旋能量低于低自旋破缺对称性能量的边缘情况）：\n  - 反应物：$\\,E_{\\mathrm{BS}}^{\\mathrm{R}} = -120.000000\\,$, $\\,E_{\\mathrm{HS}}^{\\mathrm{R}} = -120.010000\\,$, $\\,\\langle \\hat{S}^2 \\rangle_{\\mathrm{BS}}^{\\mathrm{R}} = 1.10\\,$。\n  - 过渡态：$\\,E_{\\mathrm{BS}}^{\\mathrm{TS}} = -119.970000\\,$, $\\,E_{\\mathrm{HS}}^{\\mathrm{TS}} = -119.990000\\,$, $\\,\\langle \\hat{S}^2 \\rangle_{\\mathrm{BS}}^{\\mathrm{TS}} = 1.30\\,$。\n\n您的程序必须：\n- 根据任务 $\\,1\\,$ 推导并实现自旋投影表达式。\n- 对每种情况，以 $\\,\\text{kJ mol}^{-1}\\,$ 为单位计算 $\\,\\Delta\\Delta E\\,$，结果为浮点数并四舍五入到三位小数。\n- 生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，例如 $\\,\\big[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4\\big]\\,$，结果按情况 $\\,1\\,$ 到 $\\,4\\,$ 的顺序排列。列表中的每个元素必须是小数点后恰好有三位数字的十进制数。", "solution": "所提出的问题已经过验证，被认为是具有科学依据、提法恰当且内部一致的。它代表了一个应用简化模型来校正计算化学中已知人为误差（特别是非限制性计算中的自旋污染）的标准练习。所有必要的数据和物理常数均已提供。因此，我们可以着手进行推导和求解。\n\n问题要求我们推导并应用一个公式来校正电子能量中的自旋污染，并随后分析其对反应势垒高度的影响。该分析基于双态混合模型。\n\n**1. 自旋投影校正的推导**\n\n基本前提是，一个由波函数 $\\lvert \\Psi_{\\mathrm{BS}} \\rangle$ 描述的破缺对称性 (BS) 态，是纯低自旋 (LS) 态 $\\lvert \\Psi_{\\mathrm{LS}} \\rangle$ 和纯高自旋 (HS) 态 $\\lvert \\Psi_{\\mathrm{HS}} \\rangle$ 的混合。问题指出，对于任何线性算符，其在混合态上的期望值是其在各纯态上期望值的加权平均。\n\n设 $c_{\\mathrm{LS}}$ 和 $c_{\\mathrm{HS}}$ 为混合系数，且满足 $c_{\\mathrm{LS}} + c_{\\mathrm{HS}} = 1$。算符 $\\hat{A}$ 的期望值由下式给出：\n$$ \\langle \\hat{A} \\rangle_{\\mathrm{BS}} = c_{\\mathrm{LS}} \\langle \\hat{A} \\rangle_{\\mathrm{LS}} + c_{\\mathrm{HS}} \\langle \\hat{A} \\rangle_{\\mathrm{HS}} = (1 - c_{\\mathrm{HS}}) \\langle \\hat{A} \\rangle_{\\mathrm{LS}} + c_{\\mathrm{HS}} \\langle \\hat{A} \\rangle_{\\mathrm{HS}} $$\n\n我们首先将此模型应用于总自旋平方算符 $\\hat{S}^2$。对于纯自旋态，其期望值由 $\\langle \\hat{S}^2 \\rangle = S(S+1)$ 给出（在 $\\hbar=1$ 的原子单位制中）。\n对于低自旋双重态，$S_{\\mathrm{LS}} = 1/2$，所以 $\\langle \\hat{S}^2 \\rangle_{\\mathrm{LS}} = \\frac{1}{2}(\\frac{1}{2}+1) = \\frac{3}{4} = 0.75$。\n对于高自旋四重态，$S_{\\mathrm{HS}} = 3/2$，所以 $\\langle \\hat{S}^2 \\rangle_{\\mathrm{HS}} = \\frac{3}{2}(\\frac{3}{2}+1) = \\frac{15}{4} = 3.75$。\n\n$\\langle \\hat{S}^2 \\rangle$ 的混合方程为：\n$$ \\langle \\hat{S}^2 \\rangle_{\\mathrm{BS}} = (1 - c_{\\mathrm{HS}}) \\langle \\hat{S}^2 \\rangle_{\\mathrm{LS}} + c_{\\mathrm{HS}} \\langle \\hat{S}^2 \\rangle_{\\mathrm{HS}} $$\n我们可以由此解出高自旋混合系数 $c_{\\mathrm{HS}}$，该系数用于量化自旋污染的程度：\n$$ \\langle \\hat{S}^2 \\rangle_{\\mathrm{BS}} - \\langle \\hat{S}^2 \\rangle_{\\mathrm{LS}} = c_{\\mathrm{HS}} (\\langle \\hat{S}^2 \\rangle_{\\mathrm{HS}} - \\langle \\hat{S}^2 \\rangle_{\\mathrm{LS}}) $$\n$$ c_{\\mathrm{HS}} = \\frac{\\langle \\hat{S}^2 \\rangle_{\\mathrm{BS}} - \\langle \\hat{S}^2 \\rangle_{\\mathrm{LS}}}{\\langle \\hat{S}^2 \\rangle_{\\mathrm{HS}} - \\langle \\hat{S}^2 \\rangle_{\\mathrm{LS}}} $$\n\n接下来，我们将相同的线性混合模型应用于电子哈密顿算符 $\\hat{H}$。哈密顿量的期望值即为电子能量 $E = \\langle \\hat{H} \\rangle$。\n$$ E_{\\mathrm{BS}} = (1 - c_{\\mathrm{HS}}) E_{\\mathrm{LS}} + c_{\\mathrm{HS}} E_{\\mathrm{HS}} $$\n此处，$E_{\\mathrm{BS}}$ 是计算得到的破缺对称性能量，$E_{\\mathrm{LS}}$ 是我们期望得到的纯低自旋能量（我们将其记为 $E_{\\mathrm{proj}}$），$E_{\\mathrm{HS}}$ 是在相同几何构型下纯高自旋态的能量。\n\n我们的目标是求出 $E_{\\mathrm{LS}}$。我们对该方程进行重排：\n$$ E_{\\mathrm{BS}} - c_{\\mathrm{HS}} E_{\\mathrm{HS}} = (1 - c_{\\mathrm{HS}}) E_{\\mathrm{LS}} $$\n$$ E_{\\mathrm{LS}} = E_{\\mathrm{proj}} = \\frac{E_{\\mathrm{BS}} - c_{\\mathrm{HS}} E_{\\mathrm{HS}}}{1 - c_{\\mathrm{HS}}} $$\n只要我们拥有破缺对称性能量和 $\\langle \\hat{S}^2 \\rangle$ 值，以及造成污染的高自旋态的能量，这个表达式就能让我们“投影掉”自旋污染，并恢复纯低自旋能量。\n\n**2. 势垒高度校正的计算**\n\n未校正的电子势垒高度直接由破缺对称性能量计算得出：\n$$ \\Delta E_{\\mathrm{uncorr}} = E_{\\mathrm{BS}}^{\\mathrm{TS}} - E_{\\mathrm{BS}}^{\\mathrm{R}} $$\n自旋投影的势垒高度由投影后的能量计算得出：\n$$ \\Delta E_{\\mathrm{proj}} = E_{\\mathrm{proj}}^{\\mathrm{TS}} - E_{\\mathrm{proj}}^{\\mathrm{R}} $$\n我们需要求出由该校正引起的势垒高度变化：\n$$ \\Delta\\Delta E = \\Delta E_{\\mathrm{proj}} - \\Delta E_{\\mathrm{uncorr}} = (E_{\\mathrm{proj}}^{\\mathrm{TS}} - E_{\\mathrm{proj}}^{\\mathrm{R}}) - (E_{\\mathrm{BS}}^{\\mathrm{TS}} - E_{\\mathrm{BS}}^{\\mathrm{R}}) $$\n这可以重组为两种几何构型下能量校正值的差：\n$$ \\Delta\\Delta E = (E_{\\mathrm{proj}}^{\\mathrm{TS}} - E_{\\mathrm{BS}}^{\\mathrm{TS}}) - (E_{\\mathrm{proj}}^{\\mathrm{R}} - E_{\\mathrm{BS}}^{\\mathrm{R}}) = E_{\\mathrm{corr}}^{\\mathrm{TS}} - E_{\\mathrm{corr}}^{\\mathrm{R}} $$\n其中 $E_{\\mathrm{corr}} = E_{\\mathrm{proj}} - E_{\\mathrm{BS}}$ 是在给定几何构型下的能量校正值。为保证计算稳定性，推导一个 $E_{\\mathrm{corr}}$ 的直接表达式是很有用的：\n$$ E_{\\mathrm{corr}} = \\frac{E_{\\mathrm{BS}} - c_{\\mathrm{HS}} E_{\\mathrm{HS}}}{1 - c_{\\mathrm{HS}}} - E_{\\mathrm{BS}} = \\frac{E_{\\mathrm{BS}} - c_{\\mathrm{HS}} E_{\\mathrm{HS}} - E_{\\mathrm{BS}}(1 - c_{\\mathrm{HS}})}{1 - c_{\\mathrm{HS}}} = \\frac{c_{\\mathrm{HS}} (E_{\\mathrm{BS}} - E_{\\mathrm{HS}})}{1 - c_{\\mathrm{HS}}} $$\n代入 $c_{\\mathrm{HS}}$ 和 $1-c_{\\mathrm{HS}}$ 的表达式，可以得到一个避免中间计算混合系数的形式：\n$$ E_{\\mathrm{corr}} = \\frac{\\langle \\hat{S}^2 \\rangle_{\\mathrm{BS}} - \\langle \\hat{S}^2 \\rangle_{\\mathrm{LS}}}{\\langle \\hat{S}^2 \\rangle_{\\mathrm{HS}} - \\langle \\hat{S}^2 \\rangle_{\\mathrm{BS}}} (E_{\\mathrm{BS}} - E_{\\mathrm{HS}}) $$\n这个最终表达式是稳健的，将用于数值计算。\n\n**3. 数值应用**\n\n我们将推导出的公式应用于每个测试用例。所用常数如下：\n$\\langle \\hat{S}^2 \\rangle_{\\mathrm{LS}} = 0.75$\n$\\langle \\hat{S}^2 \\rangle_{\\mathrm{HS}} = 3.75$\n转换因子：$1\\,\\text{Hartree} = 2625.49962\\,\\text{kJ mol}^{-1}$\n\n情况 1:\n- 反应物：$E_{\\text{corr}}^{\\mathrm{R}} = \\frac{0.90 - 0.75}{3.75 - 0.90} (-232.500000 - (-232.470000)) = -0.0015789...$ Hartree。\n- 过渡态：$E_{\\text{corr}}^{\\mathrm{TS}} = \\frac{1.20 - 0.75}{3.75 - 1.20} (-232.460000 - (-232.410000)) = -0.0088235...$ Hartree。\n- $\\Delta\\Delta E = -0.0072446...$ Hartree $\\times 2625.49962 = -19.0191... \\approx -19.019\\,\\text{kJ mol}^{-1}$。\n\n情况 2:\n- 反应物：$\\langle \\hat{S}^2 \\rangle_{\\mathrm{BS}}^{\\mathrm{R}} = 0.75$。校正项的分子是 $0.75 - 0.75 = 0$。因此，$E_{\\text{corr}}^{\\mathrm{R}} = 0$。\n- 过渡态：$\\langle \\hat{S}^2 \\rangle_{\\mathrm{BS}}^{\\mathrm{TS}} = 0.75$。同理，$E_{\\text{corr}}^{\\mathrm{TS}} = 0$。\n- $\\Delta\\Delta E = 0 - 0 = 0\\,\\text{kJ mol}^{-1}$。\n\n情况 3:\n- 反应物：$E_{\\text{corr}}^{\\mathrm{R}} = \\frac{0.78 - 0.75}{3.75 - 0.78} (-180.000000 - (-179.970000)) = -0.0003030...$ Hartree。\n- 过渡态：$E_{\\text{corr}}^{\\mathrm{TS}} = \\frac{1.45 - 0.75}{3.75 - 1.45} (-179.960000 - (-179.880000)) = -0.0243478...$ Hartree。\n- $\\Delta\\Delta E = -0.0240448...$ Hartree $\\times 2625.49962 = -63.1293... \\approx -63.129\\,\\text{kJ mol}^{-1}$。\n\n情况 4:\n- 反应物：$E_{\\text{corr}}^{\\mathrm{R}} = \\frac{1.10 - 0.75}{3.75 - 1.10} (-120.000000 - (-120.010000)) = +0.0013207...$ Hartree。\n- 过渡态：$E_{\\text{corr}}^{\\mathrm{TS}} = \\frac{1.30 - 0.75}{3.75 - 1.30} (-119.970000 - (-119.990000)) = +0.0044898...$ Hartree。\n- $\\Delta\\Delta E = +0.0031690...$ Hartree $\\times 2625.49962 = +8.32009... \\approx +8.320\\,\\text{kJ mol}^{-1}$。\n\n结果表明，对于自由基反应，在过渡态几何构型处通常更大的自旋污染会人为地降低能量。投影校正恢复了一个更符合物理实际的能量，通常导致计算出的势垒高度降低（$\\Delta\\Delta E  0$）。然而，如果高自旋态的能量低于破缺对称性解的能量，该模型会预测一个正的能量校正，从而可能增加势垒高度。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the spin contamination problem for a given test suite.\n    \"\"\"\n    \n    # Define constants based on the problem statement.\n    S_LS = 0.5\n    S2_LS = S_LS * (S_LS + 1)  # 0.75\n\n    S_HS = 1.5\n    S2_HS = S_HS * (S_HS + 1)  # 3.75\n    \n    HARTREE_TO_KJ_MOL = 2625.49962\n\n    # Test suite data (all energies in Hartree, S^2 values are unitless).\n    # Format: (E_BS_R, E_HS_R, S2_BS_R, E_BS_TS, E_HS_TS, S2_BS_TS)\n    test_cases = [\n        # Case 1\n        (-232.500000, -232.470000, 0.90, -232.460000, -232.410000, 1.20),\n        # Case 2\n        (-152.345678, -152.300000, 0.75, -152.310000, -152.260000, 0.75),\n        # Case 3\n        (-180.000000, -179.970000, 0.78, -179.960000, -179.880000, 1.45),\n        # Case 4\n        (-120.000000, -120.010000, 1.10, -119.970000, -119.990000, 1.30),\n    ]\n\n    results = []\n\n    def calculate_energy_correction(e_bs, e_hs, s2_bs):\n        \"\"\"\n        Calculates the spin projection energy correction based on the derived formula:\n        E_corr = [(s2_bs - s2_ls) / (s2_hs - s2_bs)] * (e_bs - e_hs)\n        \"\"\"\n        # Check for the edge case of no spin contamination.\n        if abs(s2_bs - S2_LS)  1e-9:\n            return 0.0\n\n        # Denominator of the correction formula\n        denominator = S2_HS - s2_bs\n        if abs(denominator)  1e-9:\n            # Pathological case where the BS state is a pure HS state.\n            return 0.0\n\n        # Apply the derived formula\n        correction = (s2_bs - S2_LS) / denominator * (e_bs - e_hs)\n        return correction\n\n    for case in test_cases:\n        e_bs_r, e_hs_r, s2_bs_r, e_bs_ts, e_hs_ts, s2_bs_ts = case\n        \n        # Calculate energy correction for reactant and transition state\n        corr_r = calculate_energy_correction(e_bs_r, e_hs_r, s2_bs_r)\n        corr_ts = calculate_energy_correction(e_bs_ts, e_hs_ts, s2_bs_ts)\n        \n        # Calculate the change in barrier height\n        delta_delta_e_hartree = corr_ts - corr_r\n        delta_delta_e_kjmol = delta_delta_e_hartree * HARTREE_TO_KJ_MOL\n        \n        results.append(delta_delta_e_kjmol)\n\n    # Format the final output list of strings\n    formatted_results = [f\"{res:.3f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2458013"}]}