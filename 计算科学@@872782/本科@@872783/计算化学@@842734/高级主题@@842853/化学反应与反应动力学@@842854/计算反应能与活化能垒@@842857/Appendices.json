{"hands_on_practices": [{"introduction": "理论计算的核心成果是预测反应的能量变化，但这并非一步之遥。计算化学软件通常提供一系列能量分量，我们需要根据统计热力学原理将它们组装成具有物理意义的总能量，例如吉布斯自由能。这项练习将指导您完成这一基本的数据处理任务，即如何从电子能量、零点振动能 (ZPE)、热学校正和熵等原始输出中，计算出总的反应自由能和活化自由能 [@problem_id:2451417]。此外，本练习还通过比较隐式连续介质溶剂模型和显式溶剂团簇模型的结果，突显了计算模型选择对预测结果的重要影响。", "problem": "一个质子转移反应通过两种溶剂化方法进行建模：一种是水的隐式连续介质溶剂模型，另一种是包含六个水分子的显式簇模型。对于每种方法，沿反应坐标的三个驻点被表征：反应物 (R)、过渡态 (TS) 和产物 (P)。对于每个驻点，给出了以 Hartree 为单位的电子能量、零点能 (ZPE)、热焓校正和熵。对于隐式溶剂模型，还给出了溶剂化自由能。对于显式簇模型，根据其构造，溶剂化自由能为零，因为水分子被显式处理。使用吉布斯自由能的标准热力学定义，计算在温度 $T = 298.15\\,\\mathrm{K}$ 时每个驻点的总吉布斯自由能。使用 Hartree 到 $\\mathrm{kJ\\,mol^{-1}}$ 的转换因子 $1\\,\\mathrm{Hartree} = 2625.499638\\,\\mathrm{kJ\\,mol^{-1}}$。熵以 $\\mathrm{J\\,mol^{-1}\\,K^{-1}}$ 为单位提供，在计算以 $\\mathrm{kJ\\,mol^{-1}}$ 为单位的吉布斯自由能时，必须进行一致的单位转换。所有结果必须以 $\\mathrm{kJ\\,mol^{-1}}$ 表示。\n\n对于每种溶剂化方法和每个测试用例，计算反应吉布斯自由能 $\\Delta G_\\mathrm{rxn} = G_\\mathrm{P} - G_\\mathrm{R}$ 和活化吉布斯自由能 $\\Delta G^\\ddagger = G_\\mathrm{TS} - G_\\mathrm{R}$，其中 $G$ 表示在 $T = 298.15\\,\\mathrm{K}$ 时的总吉布斯自由能。然后计算显式和隐式模型之间活化能垒的差异，定义为 $\\Delta(\\Delta G^\\ddagger) = \\Delta G^\\ddagger_\\mathrm{explicit} - \\Delta G^\\ddagger_\\mathrm{implicit}$。所有输出均以 $\\mathrm{kJ\\,mol^{-1}}$ 为单位报告，并四舍五入到三位小数。\n\n测试套件（三个独立的参数集）。对于每个测试用例，为隐式模型和显式六水簇模型提供了以下数据。每个驻点条目是一个元组，形式为 $(E_\\mathrm{elec}\\ \\mathrm{[Hartree]},\\ \\mathrm{ZPE}\\ \\mathrm{[kJ\\,mol^{-1}]},\\ H_\\mathrm{thermal}\\ \\mathrm{[kJ\\,mol^{-1}]},\\ S\\ \\mathrm{[J\\,mol^{-1}\\,K^{-1}]},\\ G_\\mathrm{solv}\\ \\mathrm{[kJ\\,mol^{-1}]})$。对于显式簇，$G_\\mathrm{solv} = 0$。\n\n- 测试用例 1：\n  - 隐式（连续介质水）\n    - R: $(-400.125,\\ 50.0,\\ 8.0,\\ 220.0,\\ -25.0)$\n    - TS: $(-400.100,\\ 49.0,\\ 8.1,\\ 180.0,\\ -20.0)$\n    - P: $(-400.130,\\ 49.5,\\ 7.9,\\ 210.0,\\ -27.0)$\n  - 显式（含六个水分子的簇）\n    - R: $(-856.750,\\ 310.0,\\ 15.0,\\ 920.0,\\ 0.0)$\n    - TS: $(-856.725,\\ 308.0,\\ 15.1,\\ 880.0,\\ 0.0)$\n    - P: $(-856.760,\\ 309.5,\\ 14.8,\\ 900.0,\\ 0.0)$\n\n- 测试用例 2：\n  - 隐式（连续介质水）\n    - R: $(-500.000,\\ 60.0,\\ 7.0,\\ 200.0,\\ -30.0)$\n    - TS: $(-499.990,\\ 60.5,\\ 7.0,\\ 195.0,\\ -31.0)$\n    - P: $(-500.001,\\ 60.1,\\ 7.0,\\ 199.0,\\ -30.5)$\n  - 显式（含六个水分子的簇）\n    - R: $(-956.000,\\ 320.0,\\ 16.0,\\ 940.0,\\ 0.0)$\n    - TS: $(-955.990,\\ 321.0,\\ 16.0,\\ 938.0,\\ 0.0)$\n    - P: $(-956.0015,\\ 320.1,\\ 16.0,\\ 939.0,\\ 0.0)$\n\n- 测试用例 3：\n  - 隐式（连续介质水）\n    - R: $(-600.500,\\ 55.0,\\ 9.0,\\ 230.0,\\ -28.0)$\n    - TS: $(-600.480,\\ 55.5,\\ 9.1,\\ 240.0,\\ -35.0)$\n    - P: $(-600.498,\\ 55.2,\\ 9.0,\\ 228.0,\\ -27.0)$\n  - 显式（含六个水分子的簇）\n    - R: $(-1056.800,\\ 330.0,\\ 17.0,\\ 950.0,\\ 0.0)$\n    - TS: $(-1056.770,\\ 329.0,\\ 17.0,\\ 900.0,\\ 0.0)$\n    - P: $(-1056.805,\\ 330.1,\\ 17.0,\\ 948.0,\\ 0.0)$\n\n您的程序必须为每个测试用例计算列表 $[\\Delta G_\\mathrm{rxn}^\\mathrm{implicit},\\ \\Delta G^{\\ddagger,\\mathrm{implicit}},\\ \\Delta G_\\mathrm{rxn}^\\mathrm{explicit},\\ \\Delta G^{\\ddagger,\\mathrm{explicit}},\\ \\Delta(\\Delta G^\\ddagger)]$，所有值均以 $\\mathrm{kJ\\,mol^{-1}}$ 为单位，并四舍五入到三位小数。最终输出必须是单行，包含三个按测试用例划分的结果列表，无空格，并严格格式化为方括号括起来的逗号分隔列表。例如，一个有效的格式应为 $[[x_{11},x_{12},x_{13},x_{14},x_{15}],[x_{21},x_{22},x_{23},x_{24},x_{25}],[x_{31},x_{32},x_{33},x_{34},x_{35}]]$，其中每个 $x_{ij}$ 都是一个浮点数。", "solution": "问题陈述已经过严格验证，被认为是有效的。它在科学上基于计算化学和统计热力学的原理，给出了所有必要的定量数据和定义，问题阐述清晰，并且完全客观。我们现在开始解答。\n\n基本任务是为隐式和显式溶剂化模型计算每个指定驻点（反应物 R；过渡态 TS；产物 P）的总吉布斯自由能 $G$。溶液中的吉布斯自由能 $G_\\mathrm{sol}$ 由所提供的组分构成：电子能量 ($E_\\mathrm{elec}$)、零点能 (ZPE)、热焓校正 ($H_\\mathrm{thermal}$)、熵 ($S$) 和溶剂化自由能 ($G_\\mathrm{solv}$)。\n\n总吉布斯自由能由标准热力学关系 $G = H - TS$ 定义。在计算化学的输出背景下，给定温度 $T$ 下的总焓 $H$ 是电子能量、零点能和焓的热校正之和。因此，气相中的吉布斯自由能 $G_\\mathrm{gas}$ 由下式给出：\n$$G_\\mathrm{gas} = (E_\\mathrm{elec} + \\mathrm{ZPE} + H_\\mathrm{thermal}) - TS$$\n对于溶液中的系统，如用隐式溶剂模型处理，总吉布斯自由能 $G_\\mathrm{sol}$ 通过加上溶剂化自由能 $G_\\mathrm{solv}$ 获得：\n$$G_\\mathrm{sol} = G_\\mathrm{gas} + G_\\mathrm{solv} = (E_\\mathrm{elec} + \\mathrm{ZPE} + H_\\mathrm{thermal}) - TS + G_\\mathrm{solv}$$\n在显式溶剂模型的情况下，溶剂分子是量子力学计算的一部分，它们的能量贡献已经包含在 $E_\\mathrm{elec}$、ZPE、$H_\\mathrm{thermal}$ 和 $S$ 中。根据其构造，独立的溶剂化自由能项为零，$G_\\mathrm{solv} = 0$。\n\n一个关键步骤是确保单位一致。所提供的数据需要转换为一个通用单位，即 $\\mathrm{kJ\\,mol^{-1}}$。\n- $E_\\mathrm{elec}$ 以 Hartree 为单位，必须使用提供的转换因子进行转换：$1\\,\\mathrm{Hartree} = 2625.499638\\,\\mathrm{kJ\\,mol^{-1}}$。\n- ZPE、$H_\\mathrm{thermal}$ 和 $G_\\mathrm{solv}$ 已经以 $\\mathrm{kJ\\,mol^{-1}}$ 为单位。\n- 熵 $S$ 以 $\\mathrm{J\\,mol^{-1}\\,K^{-1}}$ 为单位给出。熵的贡献 $TS$ 必须通过除以 1000 转换为 $\\mathrm{kJ\\,mol^{-1}}$。给定温度为 $T = 298.15\\,\\mathrm{K}$。\n\n因此，以 $\\mathrm{kJ\\,mol^{-1}}$ 为单位的总吉布斯自由能 $G$ 的完整公式是：\n$$G\\,[\\mathrm{kJ\\,mol^{-1}}] = (E_\\mathrm{elec}\\,[\\mathrm{Hartree}] \\times 2625.499638) + \\mathrm{ZPE}\\,[\\mathrm{kJ\\,mol^{-1}}] + H_\\mathrm{thermal}\\,[\\mathrm{kJ\\,mol^{-1}}] - \\frac{T\\,[\\mathrm{K}] \\times S\\,[\\mathrm{J\\,mol^{-1}\\,K^{-1}}]}{1000} + G_\\mathrm{solv}\\,[\\mathrm{kJ\\,mol^{-1}}]$$\n\n有了每个驻点（$G_\\mathrm{R}$, $G_\\mathrm{TS}$, $G_\\mathrm{P}$）的绝对吉布斯自由能，我们就可以计算每个模型所需的相对能量：\n- 反应吉布斯自由能：$\\Delta G_\\mathrm{rxn} = G_\\mathrm{P} - G_\\mathrm{R}$\n- 活化吉布斯自由能：$\\Delta G^\\ddagger = G_\\mathrm{TS} - G_\\mathrm{R}$\n\n最后，我们计算两种模型之间活化能垒的差异：\n- $\\Delta(\\Delta G^\\ddagger) = \\Delta G^\\ddagger_\\mathrm{explicit} - \\Delta G^\\ddagger_\\mathrm{implicit}$\n\n让我们以测试用例 1 为例演示该过程。\n设转换因子为 $C = 2625.499638\\,\\mathrm{kJ\\,mol^{-1}\\,Hartree^{-1}}$，温度为 $T = 298.15\\,\\mathrm{K}$。\n\n对于隐式模型：\n- $G_\\mathrm{R}^\\mathrm{implicit} = (-400.125 \\times C) + 50.0 + 8.0 - \\frac{T \\times 220.0}{1000} - 25.0 = -1050510.670\\,\\mathrm{kJ\\,mol^{-1}}$\n- $G_\\mathrm{TS}^\\mathrm{implicit} = (-400.100 \\times C) + 49.0 + 8.1 - \\frac{T \\times 180.0}{1000} - 20.0 = -1050428.959\\,\\mathrm{kJ\\,mol^{-1}}$\n- $G_\\mathrm{P}^\\mathrm{implicit} = (-400.130 \\times C) + 49.5 + 7.9 - \\frac{T \\times 210.0}{1000} - 27.0 = -1050523.416\\,\\mathrm{kJ\\,mol^{-1}}$\n由此，我们得出：\n- $\\Delta G_\\mathrm{rxn}^\\mathrm{implicit} = G_\\mathrm{P}^\\mathrm{implicit} - G_\\mathrm{R}^\\mathrm{implicit} = -12.746\\,\\mathrm{kJ\\,mol^{-1}}$\n- $\\Delta G^{\\ddagger,\\mathrm{implicit}} = G_\\mathrm{TS}^\\mathrm{implicit} - G_\\mathrm{R}^\\mathrm{implicit} = 81.711\\,\\mathrm{kJ\\,mol^{-1}}$\n\n对于显式模型 ($G_\\mathrm{solv} = 0$)：\n- $G_\\mathrm{R}^\\mathrm{explicit} = (-856.750 \\times C) + 310.0 + 15.0 - \\frac{T \\times 920.0}{1000} + 0.0 = -2249488.997\\,\\mathrm{kJ\\,mol^{-1}}$\n- $G_\\mathrm{TS}^\\mathrm{explicit} = (-856.725 \\times C) + 308.0 + 15.1 - \\frac{T \\times 880.0}{1000} + 0.0 = -2249413.286\\,\\mathrm{kJ\\,mol^{-1}}$\n- $G_\\mathrm{P}^\\mathrm{explicit} = (-856.760 \\times C) + 309.5 + 14.8 - \\frac{T \\times 900.0}{1000} + 0.0 = -2249509.989\\,\\mathrm{kJ\\,mol^{-1}}$\n由此，我们得出：\n- $\\Delta G_\\mathrm{rxn}^\\mathrm{explicit} = G_\\mathrm{P}^\\mathrm{explicit} - G_\\mathrm{R}^\\mathrm{explicit} = -20.992\\,\\mathrm{kJ\\,mol^{-1}}$\n- $\\Delta G^{\\ddagger,\\mathrm{explicit}} = G_\\mathrm{TS}^\\mathrm{explicit} - G_\\mathrm{R}^\\mathrm{explicit} = 75.711\\,\\mathrm{kJ\\,mol^{-1}}$\n\n最后，活化能垒的差异是：\n- $\\Delta(\\Delta G^\\ddagger) = 75.711 - 81.711 = -6.000\\,\\mathrm{kJ\\,mol^{-1}}$\n\n计算得出的测试用例 1 的值列表，四舍五入到三位小数，为 $[-12.746, 81.711, -20.992, 75.711, -6.000]$。所有测试用例都采用同样严谨的程序，并在提供的代码中系统地实现，以确保准确性并生成最终结果。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    使用隐式和显式溶剂化模型计算质子转移反应的反应吉布斯自由能和活化吉布斯自由能。\n    \"\"\"\n    # Define constants\n    T = 298.15  # Temperature in Kelvin\n    HARTREE_TO_KJ_MOL = 2625.499638  # Conversion factor\n\n    # Test suite data: (E_elec [Hartree], ZPE [kJ/mol], H_thermal [kJ/mol], S [J/mol K], G_solv [kJ/mol])\n    test_cases = [\n        # Test case 1\n        {\n            \"implicit\": {\n                \"R\": (-400.125, 50.0, 8.0, 220.0, -25.0),\n                \"TS\": (-400.100, 49.0, 8.1, 180.0, -20.0),\n                \"P\": (-400.130, 49.5, 7.9, 210.0, -27.0),\n            },\n            \"explicit\": {\n                \"R\": (-856.750, 310.0, 15.0, 920.0, 0.0),\n                \"TS\": (-856.725, 308.0, 15.1, 880.0, 0.0),\n                \"P\": (-856.760, 309.5, 14.8, 900.0, 0.0),\n            },\n        },\n        # Test case 2\n        {\n            \"implicit\": {\n                \"R\": (-500.000, 60.0, 7.0, 200.0, -30.0),\n                \"TS\": (-499.990, 60.5, 7.0, 195.0, -31.0),\n                \"P\": (-500.001, 60.1, 7.0, 199.0, -30.5),\n            },\n            \"explicit\": {\n                \"R\": (-956.000, 320.0, 16.0, 940.0, 0.0),\n                \"TS\": (-955.990, 321.0, 16.0, 938.0, 0.0),\n                \"P\": (-956.0015, 320.1, 16.0, 939.0, 0.0),\n            },\n        },\n        # Test case 3\n        {\n            \"implicit\": {\n                \"R\": (-600.500, 55.0, 9.0, 230.0, -28.0),\n                \"TS\": (-600.480, 55.5, 9.1, 240.0, -35.0),\n                \"P\": (-600.498, 55.2, 9.0, 228.0, -27.0),\n            },\n            \"explicit\": {\n                \"R\": (-1056.800, 330.0, 17.0, 950.0, 0.0),\n                \"TS\": (-1056.770, 329.0, 17.0, 900.0, 0.0),\n                \"P\": (-1056.805, 330.1, 17.0, 948.0, 0.0),\n            },\n        },\n    ]\n\n    def calculate_gibbs_free_energy(params):\n        \"\"\"Calculates total Gibbs free energy for a stationary point.\"\"\"\n        e_elec, zpe, h_thermal, s, g_solv = params\n        g = (e_elec * HARTREE_TO_KJ_MOL) + zpe + h_thermal - (T * s / 1000.0) + g_solv\n        return g\n\n    all_results = []\n    for case in test_cases:\n        # Implicit model calculations\n        g_r_imp = calculate_gibbs_free_energy(case[\"implicit\"][\"R\"])\n        g_ts_imp = calculate_gibbs_free_energy(case[\"implicit\"][\"TS\"])\n        g_p_imp = calculate_gibbs_free_energy(case[\"implicit\"][\"P\"])\n\n        delta_g_rxn_imp = g_p_imp - g_r_imp\n        delta_g_act_imp = g_ts_imp - g_r_imp\n\n        # Explicit model calculations\n        g_r_exp = calculate_gibbs_free_energy(case[\"explicit\"][\"R\"])\n        g_ts_exp = calculate_gibbs_free_energy(case[\"explicit\"][\"TS\"])\n        g_p_exp = calculate_gibbs_free_energy(case[\"explicit\"][\"P\"])\n\n        delta_g_rxn_exp = g_p_exp - g_r_exp\n        delta_g_act_exp = g_ts_exp - g_r_exp\n        \n        # Difference in activation barriers\n        delta_delta_g_act = delta_g_act_exp - delta_g_act_imp\n\n        # Collect and round results for the current test case\n        case_results_raw = [\n            delta_g_rxn_imp,\n            delta_g_act_imp,\n            delta_g_rxn_exp,\n            delta_g_act_exp,\n            delta_delta_g_act,\n        ]\n        \n        # Round each value to 3 decimal places\n        case_results_rounded = [round(val, 3) for val in case_results_raw]\n        all_results.append(case_results_rounded)\n\n    # Format the final output string exactly as required (no spaces)\n    case_strings = []\n    for res_list in all_results:\n        # Convert each number to its string representation\n        # Using f-string for formatting to ensure 3 decimal places for all numbers including those ending in .0\n        num_strings = [f\"{val:.3f}\" for val in res_list]\n        case_strings.append(f\"[{','.join(num_strings)}]\")\n    \n    final_output_string = f\"[{','.join(case_strings)}]\"\n    \n    print(final_output_string)\n\nsolve()\n```", "id": "2451417"}, {"introduction": "一旦我们掌握了计算活化能的方法，就可以将其应用于解释和预测实验现象。动力学同位素效应 (KIE) 是一个强有力的工具，它通过比较含不同同位素的分子（例如 C-H vs C-D）的反应速率来揭示反应机理的细节。这项练习将向您展示如何运用过渡态理论和零点振动能 (ZPVE) 的概念，从理论上计算 KIE [@problem_id:2451445]。您将通过这个过程深刻理解，尽管同位素取代不改变电子势能面，但它通过影响 ZPVE 这一量子效应来显著改变反应速率，这是连接理论计算与实验观测的关键一步。", "problem": "一项计算化学任务要求使用过渡态理论 (TST)，通过比较零点振动能校正的活化能垒，来估算碳-氢键与碳-氘键断裂的动力学同位素效应。您必须实现一个完整、可运行的程序，该程序计算动力学同位素效应，即同位素体的速率常数之比。最终结果必须按指定格式打印。请使用以下假设和基本依据。\n\n假设与基本依据：\n- 使用过渡态理论 (TST)。基元步骤的速率常数由 $k = \\dfrac{k_{\\mathrm{B}} T}{h} \\exp\\!\\left(-\\dfrac{\\Delta G^{\\ddagger}}{R T}\\right)$ 建模，其中 $k_{\\mathrm{B}}$ 是玻尔兹曼常数，$h$ 是普朗克常数，$T$ 是绝对温度，$R$ 是气体常数，$\\Delta G^{\\ddagger}$ 是吉布斯活化自由能。\n- 忽略隧穿效应，并假设在针对特定键的比较中，$\\Delta G^{\\ddagger}$ 的熵和热焓贡献在不同同位素体之间基本抵消，因此 $\\Delta G^{\\ddagger} \\approx \\Delta E^{\\ddagger}_{\\mathrm{corr}}$，其中 $\\Delta E^{\\ddagger}_{\\mathrm{corr}}$ 是经过过渡态和反应物之间零点振动能 (ZPVE) 差异校正的电子活化能垒。\n- 对于波数为 $\\tilde{\\nu}$（单位 $\\mathrm{cm}^{-1}$）的单个简谐振动模式，每摩尔的零点振动能为 $E_{0} = \\dfrac{1}{2} N_{\\mathrm{A}} h c\\, \\tilde{\\nu}$，其中 $N_{\\mathrm{A}}$ 是阿伏伽德罗常数，$h$ 是普朗克常数，$c$ 是光速。此公式仅用于 C–H 和 C–D 伸缩振动模式，并假设在此比较中，其他模式在反应物和过渡态之间相互抵消。\n- 因此，对于同位素体 $X \\in \\{\\mathrm{H}, \\mathrm{D}\\}$，使用 $\\Delta E^{\\ddagger}_{\\mathrm{corr},X} = E^{\\ddagger}_{\\mathrm{el}} + \\left(\\dfrac{1}{2} N_{\\mathrm{A}} h c\\right)\\left(\\tilde{\\nu}_{\\mathrm{TS},X} - \\tilde{\\nu}_{\\mathrm{R},X}\\right)$，所有能量均以每摩尔为单位报告。将结果转换为 $\\mathrm{kJ\\,mol^{-1}}$。\n- 动力学同位素效应定义为 $\\mathrm{KIE} = \\dfrac{k_{\\mathrm{H}}}{k_{\\mathrm{D}}}$，这是一个无量纲量。\n\n使用的常数（在双精度范围内视为精确值）：\n- 普朗克常数 $h = 6.62607015 \\times 10^{-34}\\ \\mathrm{J\\,s}$。\n- 光速 $c = 2.99792458 \\times 10^{10}\\ \\mathrm{cm\\,s^{-1}}$。\n- 阿伏伽德罗常数 $N_{\\mathrm{A}} = 6.02214076 \\times 10^{23}\\ \\mathrm{mol^{-1}}$。\n- 玻尔兹曼常数 $k_{\\mathrm{B}} = 1.380649 \\times 10^{-23}\\ \\mathrm{J\\,K^{-1}}$。\n- 气体常数 $R = 8.31446261815324\\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$。\n\n实现要求：\n- 对于每个测试用例，根据所提供的目标伸缩振动模式的波数差计算零点振动能校正，获得以 $\\mathrm{kJ\\,mol^{-1}}$ 为单位的 ZPVE 校正活化能垒，计算在指定温度下 $\\mathrm{H}$ 和 $\\mathrm{D}$ 的 TST 速率常数，并输出比值 $\\mathrm{KIE} = k_{\\mathrm{H}}/k_{\\mathrm{D}}$ 作为浮点数。\n- 能量必须以 $\\mathrm{kJ\\,mol^{-1}}$ 处理，温度以 $\\mathrm{K}$ 处理，波数以 $\\mathrm{cm^{-1}}$ 处理。\n- 每个动力学同位素效应的答案应为一个无量纲浮点数，四舍五入到 $6$ 位小数。\n\n测试套件：\n对于每个元组，参数为 $(T,\\ E^{\\ddagger}_{\\mathrm{el}},\\ \\tilde{\\nu}_{\\mathrm{R,H}},\\ \\tilde{\\nu}_{\\mathrm{TS,H}},\\ \\tilde{\\nu}_{\\mathrm{R,D}},\\ \\tilde{\\nu}_{\\mathrm{TS,D}})$，其中 $T$ 的单位是 $\\mathrm{K}$，$E^{\\ddagger}_{\\mathrm{el}}$ 的单位是 $\\mathrm{kJ\\,mol^{-1}}$，所有 $\\tilde{\\nu}$ 的单位都是 $\\mathrm{cm^{-1}}$。\n- 情况 1：(298.15, 100.0, 3000, 1200, 2200, 850)\n- 情况 2：(200.00, 80.0, 2900, 1000, 2100, 730)\n- 情况 3（ZPVE 差异几乎抵消，KIE 接近 1）：(298.15, 50.0, 2900, 2890, 2060, 2053)\n- 情况 4（更高的电子能垒，更高的温度）：(600.00, 150.0, 3100, 800, 2250, 570)\n\n最终输出规格：\n- 您的程序应生成单行输出，其中包含四个测试用例的结果，结果为逗号分隔的列表，并用方括号括起来。例如，要求的格式是 $[\\mathrm{result1},\\mathrm{result2},\\mathrm{result3},\\mathrm{result4}]$，其中每个 $\\mathrm{result}$ 都四舍五入到6位小数，且不带单位。", "solution": "该问题要求计算 C–H/C–D 键断裂反应的动力学同位素效应 (KIE)。理论框架是过渡态理论 (TST)，并通过几个明确定义的近似进行了简化。KIE，表示为 $\\mathrm{KIE}$，是氢同位素体 ($k_{\\mathrm{H}}$) 与氘同位素体 ($k_{\\mathrm{D}}$) 的速率常数之比。\n\n首先，我们建立 KIE 的基本关系。根据 TST，涉及物种 $X$（其中 $X$ 是 $\\mathrm{H}$ 或 $\\mathrm{D}$）的基元反应的速率常数 $k_X$ 由下式给出：\n$$ k_X = \\frac{k_{\\mathrm{B}} T}{h} \\exp\\!\\left(-\\frac{\\Delta G^{\\ddagger}_X}{R T}\\right) $$\n这里，$k_{\\mathrm{B}}$ 是玻尔兹曼常数，$T$ 是绝对温度，$h$ 是普朗克常数，$R$ 是理想气体常数，$\\Delta G^{\\ddagger}_X$ 是物种 $X$ 的吉布斯活化自由能。\n\nKIE 定义为比值 $\\mathrm{KIE} = k_{\\mathrm{H}} / k_{\\mathrm{D}}$。代入 TST 的速率常数表达式可得：\n$$ \\mathrm{KIE} = \\frac{\\frac{k_{\\mathrm{B}} T}{h} \\exp\\!\\left(-\\frac{\\Delta G^{\\ddagger}_{\\mathrm{H}}}{R T}\\right)}{\\frac{k_{\\mathrm{B}} T}{h} \\exp\\!\\left(-\\frac{\\Delta G^{\\ddagger}_{\\mathrm{D}}}{R T}\\right)} $$\n指前因子 $\\frac{k_{\\mathrm{B}} T}{h}$ 对两种同位素体是相同的，因此相消，表达式简化为：\n$$ \\mathrm{KIE} = \\frac{\\exp\\!\\left(-\\frac{\\Delta G^{\\ddagger}_{\\mathrm{H}}}{R T}\\right)}{\\exp\\!\\left(-\\frac{\\Delta G^{\\ddagger}_{\\mathrm{D}}}{R T}\\right)} = \\exp\\!\\left(\\frac{\\Delta G^{\\ddagger}_{\\mathrm{D}} - \\Delta G^{\\ddagger}_{\\mathrm{H}}}{R T}\\right) $$\n问题陈述中要求用 ZPVE 校正的电子活化能垒 $\\Delta E^{\\ddagger}_{\\mathrm{corr},X}$ 来近似吉布斯活化自由能 $\\Delta G^{\\ddagger}_X$。这假设了熵和热焓对 $\\Delta G^{\\ddagger}_X$ 的贡献对于两种同位素体实际上是相同的，因此在求差时相互抵消。\n$$ \\mathrm{KIE} \\approx \\exp\\!\\left(\\frac{\\Delta E^{\\ddagger}_{\\mathrm{corr,D}} - \\Delta E^{\\ddagger}_{\\mathrm{corr,H}}}{R T}\\right) $$\nZPVE 校正的活化能垒定义为电子活化能垒 $E^{\\ddagger}_{\\mathrm{el}}$ 与从反应物 (R) 到过渡态 (TS) 的零点振动能变化量 ($\\Delta E_{0,X}$) 之和：\n$$ \\Delta E^{\\ddagger}_{\\mathrm{corr},X} = E^{\\ddagger}_{\\mathrm{el}} + \\Delta E_{0,X} = E^{\\ddagger}_{\\mathrm{el}} + (E_{0,\\mathrm{TS},X} - E_{0,\\mathrm{R},X}) $$\n在玻恩-奥本海默近似中，电子能量 $E^{\\ddagger}_{\\mathrm{el}}$ 与同位素取代无关。因此，当我们计算差值 $\\Delta E^{\\ddagger}_{\\mathrm{corr,D}} - \\Delta E^{\\ddagger}_{\\mathrm{corr,H}}$ 时，$E^{\\ddagger}_{\\mathrm{el}}$ 项会相消：\n$$ \\Delta E^{\\ddagger}_{\\mathrm{corr,D}} - \\Delta E^{\\ddagger}_{\\mathrm{corr,H}} = (E^{\\ddagger}_{\\mathrm{el}} + \\Delta E_{0,D}) - (E^{\\ddagger}_{\\mathrm{el}} + \\Delta E_{0,H}) = \\Delta E_{0,D} - \\Delta E_{0,H} $$\n问题指定使用谐振子模型来计算单一振动模式（波数为 $\\tilde{\\nu}$）的零点能。每摩尔的 ZPVE 为 $E_0 = \\frac{1}{2} N_{\\mathrm{A}} h c \\tilde{\\nu}$，其中 $N_{\\mathrm{A}}$ 是阿伏伽德罗常数，$c$ 是光速。\n将此应用于 ZPVE 的变化量 $\\Delta E_{0,X}$，我们得到：\n$$ \\Delta E_{0,X} = E_{0,\\mathrm{TS},X} - E_{0,\\mathrm{R},X} = \\frac{1}{2} N_{\\mathrm{A}} h c (\\tilde{\\nu}_{\\mathrm{TS},X} - \\tilde{\\nu}_{\\mathrm{R},X}) $$\n因此，同位素体之间的 ZPVE 变化量之差为：\n$$ \\Delta E_{0,D} - \\Delta E_{0,H} = \\frac{1}{2} N_{\\mathrm{A}} h c \\left[ (\\tilde{\\nu}_{\\mathrm{TS,D}} - \\tilde{\\nu}_{\\mathrm{R,D}}) - (\\tilde{\\nu}_{\\mathrm{TS,H}} - \\tilde{\\nu}_{\\mathrm{R,H}}) \\right] $$\n我们将这个能量差定义为 $\\Delta\\Delta E_0 = \\Delta E_{0,D} - \\Delta E_{0,H}$。KIE 的最终表达式为：\n$$ \\mathrm{KIE} = \\exp\\!\\left(\\frac{\\Delta\\Delta E_0}{R T}\\right) = \\exp\\!\\left( \\frac{ N_{\\mathrm{A}} h c }{2 R T} \\left[ (\\tilde{\\nu}_{\\mathrm{TS,D}} - \\tilde{\\nu}_{\\mathrm{R,D}}) - (\\tilde{\\nu}_{\\mathrm{TS,H}} - \\tilde{\\nu}_{\\mathrm{R,H}}) \\right] \\right) $$\n计算过程如下：\n$1$. 对于每个测试用例，获取输入参数：$T$、$\\tilde{\\nu}_{\\mathrm{R,H}}$、$\\tilde{\\nu}_{\\mathrm{TS,H}}$、$\\tilde{\\nu}_{\\mathrm{R,D}}$ 和 $\\tilde{\\nu}_{\\mathrm{TS,D}}$。注意，最终 KIE 的计算不需要电子能垒 $E^{\\ddagger}_{\\mathrm{el}}$。\n$2$. 计算每个同位素体的波数变化：$\\Delta\\tilde{\\nu}_{\\mathrm{H}} = \\tilde{\\nu}_{\\mathrm{TS,H}} - \\tilde{\\nu}_{\\mathrm{R,H}}$ 和 $\\Delta\\tilde{\\nu}_{\\mathrm{D}} = \\tilde{\\nu}_{\\mathrm{TS,D}} - \\tilde{\\nu}_{\\mathrm{R,D}}$。\n$3$. 计算这些变化量之间的差值：$\\Delta\\Delta\\tilde{\\nu} = \\Delta\\tilde{\\nu}_{\\mathrm{D}} - \\Delta\\tilde{\\nu}_{\\mathrm{H}}$。\n$4$. 使用表达式 $\\Delta\\Delta E_0 = \\frac{1}{2} N_{\\mathrm{A}} h c \\Delta\\Delta\\tilde{\\nu}$ 计算总能量差 $\\Delta\\Delta E_0$，单位为 $\\mathrm{J\\,mol^{-1}}$。常数 $h$ 和 $c$ 必须使用兼容的单位（$c$ 的单位为 $\\mathrm{cm\\,s^{-1}}$ 以匹配 $\\tilde{\\nu}$ 的单位 $\\mathrm{cm^{-1}}$）。\n$5$. 计算热能项 $R T$，单位为 $\\mathrm{J\\,mol^{-1}}$。\n$6$. 计算 KIE，公式为 $\\mathrm{KIE} = \\exp(\\Delta\\Delta E_0 / (R T))$。指数函数的参数必须是无量纲的。单位分析证实了这一点：$(\\mathrm{J\\,mol^{-1}}) / (\\mathrm{J\\,mol^{-1}\\,K^{-1}} \\cdot \\mathrm{K}) = 1$。\n$7$. 按要求将最终结果四舍五入到6位小数。\n该过程提供了一个直接而高效的算法，用于根据所提供的物理模型和近似计算 KIE。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the Kinetic Isotope Effect (KIE) for C-H/C-D bond cleavage\n    based on Transition State Theory and zero-point vibrational energy corrections.\n    \"\"\"\n\n    # --- Constants (treated as exact) ---\n    # Planck's constant in J·s\n    H_PLANCK = 6.62607015e-34\n    # Speed of light in cm·s⁻¹ (to match wavenumber units)\n    C_LIGHT = 2.99792458e10\n    # Avogadro's number in mol⁻¹\n    NA_AVOGADRO = 6.02214076e23\n    # Gas constant in J·mol⁻¹·K⁻¹\n    R_GAS = 8.31446261815324\n\n    # --- Test Suite ---\n    # Each tuple contains:\n    # (T [K], E_el [kJ/mol], nu_R_H [cm⁻¹], nu_TS_H [cm⁻¹], nu_R_D [cm⁻¹], nu_TS_D [cm⁻¹])\n    test_cases = [\n        (298.15, 100.0, 3000, 1200, 2200, 850),\n        (200.00, 80.0, 2900, 1000, 2100, 730),\n        (298.15, 50.0, 2900, 2890, 2060, 2053),\n        (600.00, 150.0, 3100, 800, 2250, 570),\n    ]\n\n    results = []\n    \n    # Pre-calculate the energy conversion factor for ZPVE in J·cm·mol⁻¹\n    # ZPVE_factor = 0.5 * N_A * h * c\n    # The total ZPVE difference is ZPVE_factor * delta_nu\n    zpve_factor = 0.5 * NA_AVOGADRO * H_PLANCK * C_LIGHT\n\n    for case in test_cases:\n        T_K, E_el_kJ_mol, nu_R_H, nu_TS_H, nu_R_D, nu_TS_D = case\n\n        # The KIE depends on the difference in ZPVE changes between the two isotopologues.\n        # KIE = exp( (delta_E_corr_D - delta_E_corr_H) / (R*T) )\n        # delta_E_corr_D - delta_E_corr_H simplifies to delta_E0_D - delta_E0_H\n        # where delta_E0_X = 0.5 * Na * h * c * (nu_TS_X - nu_R_X)\n\n        # 1. Calculate the change in wavenumber for H and D\n        delta_nu_H = nu_TS_H - nu_R_H\n        delta_nu_D = nu_TS_D - nu_R_D\n\n        # 2. Calculate the difference of these changes\n        delta_delta_nu = delta_nu_D - delta_nu_H\n\n        # 3. Calculate the corresponding energy difference in J/mol\n        # This is delta_E0_D - delta_E0_H\n        delta_delta_E0_J_mol = zpve_factor * delta_delta_nu\n\n        # 4. Calculate the thermal energy term RT in J/mol\n        RT_J_mol = R_GAS * T_K\n        \n        # 5. Calculate the KIE\n        # The electronic activation energy (E_el_kJ_mol) cancels out and is not needed.\n        if RT_J_mol == 0:\n            # Avoid division by zero, though T > 0 in all cases.\n            kie = np.inf\n        else:\n            exponent = delta_delta_E0_J_mol / RT_J_mol\n            kie = np.exp(exponent)\n            \n        # 6. Format the result to 6 decimal places\n        results.append(f\"{kie:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2451445"}, {"introduction": "真实的反应路径并非总是简单的单峰垒。计算化学研究常常会发现势能面上存在一些非常浅的“凹坑”，这暗示可能存在一个寿命极短的中间体。这项练习将引导您解决一个高级但非常实际的问题：如何判断这样一个反应在动力学上更接近于一步完成的协同反应，还是一个分步反应 [@problem_id:2451429]？通过运用过渡态理论和稳态近似，您将建立一个动力学模型，用以量化判断一个浅的中间体在特定温度下是否具有“动力学意义”，从而超越对势能面的静态观察，进入对反应机理的动态诠释。", "problem": "一位实验研究者声称某个反应是协同反应，但计算出的势能剖面显示存在一个非常浅的中间体。您必须通过基于过渡态理论 (TST) 和稳态近似的、有原则的动力学分析，从计算上论证哪种解释可能性更大。反应方案是一个包含可能中间体的两步序列：$R \\xrightarrow{k_1} I \\xrightarrow{k_2} P$，并伴随一个逆向步骤 $I \\xrightarrow{k_{-1}} R$。所有自由能均以吉布斯自由能给出，单位为 $\\mathrm{kJ\\,mol^{-1}}$，温度单位为 $\\mathrm{K}$。您的任务是编写一个程序，在以下模型下，对每个测试用例判断其势能剖面在动力学上表现得更像协同反应还是分步反应。\n\n使用以下基本原理：\n- 玻尔兹曼统计以及用于平衡布居数的吉布斯自由能关系。\n- 来自过渡态理论 (TST) 用于单分子反应速率常数的艾林方程 (Eyring equation)：$k = \\dfrac{k_B T}{h}\\exp\\!\\left(-\\dfrac{\\Delta G^{\\ddagger}}{R T}\\right)$，其中 $k_B$ 是玻尔兹曼常数，$h$ 是普朗克常数，$R$ 是摩尔气体常数，$T$ 是绝对温度，$\\Delta G^{\\ddagger}$ 是活化自由能。\n- 对于连续反应 $R \\rightleftharpoons I \\to P$ 中的中间体 $I$ 应用质量作用定律和稳态近似，可得到 $R \\to P$ 的表观一级速率常数为 $k_{\\mathrm{obs}} = \\dfrac{k_1\\,k_2}{k_{-1} + k_2}$。\n\n对于每个案例，您会得到一个元组 $(T, G_R, G_I, G_{\\mathrm{TS1}}, G_{\\mathrm{TS2}}, G_P)$，单位为 $(\\mathrm{K}, \\mathrm{kJ\\,mol^{-1}}, \\mathrm{kJ\\,mol^{-1}}, \\mathrm{kJ\\,mol^{-1}}, \\mathrm{kJ\\,mol^{-1}}, \\mathrm{kJ\\,mol^{-1}})$，其中 $G_R$ 是反应物的自由能，$G_I$ 是中间体的自由能，$G_{\\mathrm{TS1}}$ 是 $R \\to I$ 第一个过渡态的自由能，$G_{\\mathrm{TS2}}$ 是 $I \\to P$ 第二个过渡态的自由能，$G_P$ 是产物的自由能。假设在所关心的时间尺度上，从 $P$ 出发的逆向步骤可以忽略不计。\n\n对每个案例按以下步骤进行：\n1. 计算活化自由能：\n   - $\\Delta G_1^{\\ddagger} = G_{\\mathrm{TS1}} - G_R$，\n   - $\\Delta G_{-1}^{\\ddagger} = G_{\\mathrm{TS1}} - G_I$，\n   - $\\Delta G_2^{\\ddagger} = G_{\\mathrm{TS2}} - G_I$。\n2. 计算温度 $T$ 下的 TST 速率常数：\n   - $k_1 = \\dfrac{k_B T}{h}\\exp\\!\\left(-\\dfrac{\\Delta G_1^{\\ddagger}}{R T}\\right)$，\n   - $k_{-1} = \\dfrac{k_B T}{h}\\exp\\!\\left(-\\dfrac{\\Delta G_{-1}^{\\ddagger}}{R T}\\right)$，\n   - $k_2 = \\dfrac{k_B T}{h}\\exp\\!\\left(-\\dfrac{\\Delta G_2^{\\ddagger}}{R T}\\right)$。\n   使用单位为 $\\mathrm{J\\,K^{-1}}$ 的 $k_B$、单位为 $\\mathrm{J\\,s}$ 的 $h$、单位为 $\\mathrm{kJ\\,mol^{-1}\\,K^{-1}}$ 的 $R$，并确保所有吉布斯自由能的单位都是 $\\mathrm{kJ\\,mol^{-1}}$，从而使指数的参数无量纲。这样计算出的 $k$ 的单位为 $\\mathrm{s^{-1}}$。\n3. 对中间体 $I$ 使用稳态近似，计算 $R \\to P$ 的表观一级速率常数：\n   $$k_{\\mathrm{obs}} = \\frac{k_1\\,k_2}{k_{-1} + k_2}.$$\n4. 通过反演艾林方程，定义一个等效的单势垒活化自由能：\n   $$\\Delta G_{\\mathrm{eff}}^{\\ddagger} = - R T \\,\\ln\\!\\left(\\frac{k_{\\mathrm{obs}}\\,h}{k_B T}\\right).$$\n5. 定义相对于 $R$ 的路径上的几何最大势垒：\n   $$\\Delta G_{\\max}^{\\ddagger} = \\max\\!\\left(G_{\\mathrm{TS1}}, G_{\\mathrm{TS2}}\\right) - G_R.$$\n6. 定义相对于相邻较低鞍点的中间体势阱深度：\n   $$d = \\min\\!\\left(G_{\\mathrm{TS1}}, G_{\\mathrm{TS2}}\\right) - G_I.$$\n7. 使用以下由热可及性和动力学粗粒化所支持的标准来判断反应是类协同的还是类分步的：\n   - 标准 A (浅势阱)：$d \\le R T$。\n   - 标准 B (单势垒动力学)：$\\left|\\Delta G_{\\mathrm{eff}}^{\\ddagger} - \\Delta G_{\\max}^{\\ddagger}\\right| \\le R T$。\n   如果标准 A 和标准 B 都成立，则将该案例分类为类协同反应，并输出布尔值 true；否则，将其分类为类分步反应，并输出 false。\n\n使用的常数：\n- $k_B = 1.380649\\times 10^{-23}\\ \\mathrm{J\\,K^{-1}}$，\n- $h = 6.62607015\\times 10^{-34}\\ \\mathrm{J\\,s}$，\n- $R = 8.314462618\\times 10^{-3}\\ \\mathrm{kJ\\,mol^{-1}\\,K^{-1}}$。\n\n测试集（每个元组为 $(T, G_R, G_I, G_{\\mathrm{TS1}}, G_{\\mathrm{TS2}}, G_P)$，单位为 $(\\mathrm{K}, \\mathrm{kJ\\,mol^{-1}}, \\mathrm{kJ\\,mol^{-1}}, \\mathrm{kJ\\,mol^{-1}}, \\mathrm{kJ\\,mol^{-1}}, \\mathrm{kJ\\,mol^{-1}})$）：\n- 案例 1 (第一势垒占主导，中间体非常浅)：$(298.0,\\ 0.0,\\ 78.5,\\ 85.0,\\ 79.0,\\ -30.0)$。\n- 案例 2 (两个相当的势垒，中间体浅但动力学惩罚明显)：$(298.0,\\ 0.0,\\ 77.0,\\ 79.0,\\ 80.0,\\ -20.0)$。\n- 案例 3 (对温度敏感的浅势阱；在较低温度 $T$ 下势阱不浅)：$(298.0,\\ 0.0,\\ 78.0,\\ 85.0,\\ 80.5,\\ -25.0)$。\n- 案例 4 (能量与案例 3 相同，但更高的温度降低了相对势阱深度)：$(320.0,\\ 0.0,\\ 78.0,\\ 85.0,\\ 80.5,\\ -25.0)$。\n- 案例 5 (深中间体，明显的分步反应)：$(298.0,\\ 0.0,\\ 20.0,\\ 60.0,\\ 50.0,\\ -40.0)$。\n- 案例 6 (平坦的中间体，一个相邻势垒基本为零，粗粒化为单势垒)：$(298.0,\\ 0.0,\\ 80.0,\\ 85.0,\\ 80.0,\\ -10.0)$。\n\n您的程序必须根据上述规则为每个案例计算一个布尔分类，并生成一行输出，其中包含用方括号括起来的逗号分隔的结果列表，例如，“[true,false,true,...]”。布尔值请使用英文小写的“true”和“false”。不应打印任何其他文本。所有能量单位均为 $\\mathrm{kJ\\,mol^{-1}}$，输出的布尔值无单位。", "solution": "所提出的问题是计算化学动力学领域一个有效练习。它要求基于从过渡态理论 (TST) 和稳态近似推导的一组特定动力学标准，将反应剖面分类为“类协同”或“类分步”。所有必需的物理常数、数学公式和输入数据均已提供，问题具有科学依据，提法明确且客观。不存在矛盾或含糊之处。我现在将着手提供一个完整的解决方案。\n\n问题的核心是确定一个两步反应机理 $R \\rightleftharpoons I \\to P$ 在动力学上是否表现得像一个单步协同反应。这通过比较完整的稳态模型预测的动力学与简化的单势垒模型的动力学来评估。\n\n对于每个由自由能元组 $(T, G_R, G_I, G_{\\mathrm{TS1}}, G_{\\mathrm{TS2}}, G_P)$ 定义的测试用例，分析按以下步骤进行。\n\n**第 1 步：计算活化自由能**\n首先，我们计算每个基元步骤的吉布斯活化自由能 $\\Delta G^{\\ddagger}$。这些势垒是过渡态与前一个稳定点（反应物或中间体）之间的自由能差。能量单位为 $\\mathrm{kJ\\,mol^{-1}}$。\n- 正向步骤 $R \\to I$ 的势垒：\n$$ \\Delta G_1^{\\ddagger} = G_{\\mathrm{TS1}} - G_R $$\n- 逆向步骤 $I \\to R$ 的势垒：\n$$ \\Delta G_{-1}^{\\ddagger} = G_{\\mathrm{TS1}} - G_I $$\n- 第二个正向步骤 $I \\to P$ 的势垒：\n$$ \\Delta G_2^{\\ddagger} = G_{\\mathrm{TS2}} - G_I $$\n\n**第 2 步：计算 TST 速率常数**\n利用活化自由能，我们使用过渡态理论中的艾林方程计算每个基元步骤的单分子速率常数：\n$$ k = \\frac{k_B T}{h}\\exp\\!\\left(-\\frac{\\Delta G^{\\ddagger}}{R T}\\right) $$\n这里，$k_B$ 是玻尔兹曼常数 ($1.380649 \\times 10^{-23}\\ \\mathrm{J\\,K^{-1}}$)，$h$ 是普朗克常数 ($6.62607015 \\times 10^{-34}\\ \\mathrm{J\\,s}$)，$T$ 是开尔文绝对温度，$R$ 是摩尔气体常数 ($8.314462618 \\times 10^{-3}\\ \\mathrm{kJ\\,mol^{-1}\\,K^{-1}}$)。\n指数的参数 $-\\Delta G^{\\ddagger} / (R T)$ 是无量纲的，正如所要求的那样，因为 $\\Delta G^{\\ddagger}$ 和乘积 $R T$ 的单位都是 $\\mathrm{kJ\\,mol^{-1}}$。指前因子 $k_B T / h$ 正确地为速率常数 $k_1$、$k_{-1}$ 和 $k_2$ 提供了 $\\mathrm{s^{-1}}$ 的单位。\n\n**第 3 步：计算表观速率常数**\n对于连续反应 $R \\rightleftharpoons I \\to P$，我们假设中间体 $I$ 的浓度很小，并且在反应过程中没有显著变化（稳态近似）。这得出了用于 $R$ 转化为 $P$ 的表观一级速率常数 $k_{\\mathrm{obs}}$ 的表达式：\n$$ k_{\\mathrm{obs}} = \\frac{k_1 k_2}{k_{-1} + k_2} $$\n这个表达式捕捉了两步机理的完整动力学行为。项 $k_2 / (k_{-1} + k_2)$ 代表了中间体 $I$ 的分配，即继续生成产物 $P$ 与逆转回反应物 $R$ 的分数。\n\n**第 4 步：计算等效活化自由能**\n为了将两步动力学与等效的单步过程进行比较，我们定义一个等效活化自由能 $\\Delta G_{\\mathrm{eff}}^{\\ddagger}$。这是一个假设的单步反应在温度 $T$ 下需要具备的势垒，以表现出速率常数 $k_{\\mathrm{obs}}$。我们通过反演艾林方程来找到它：\n$$ \\Delta G_{\\mathrm{eff}}^{\\ddagger} = - R T \\,\\ln\\!\\left(\\frac{k_{\\mathrm{obs}}\\,h}{k_B T}\\right) $$\n得到的 $\\Delta G_{\\mathrm{eff}}^{\\ddagger}$ 单位为 $\\mathrm{kJ\\,mol^{-1}}$。\n\n**第 5 步：计算最大几何势垒**\n对于多步反应速率的一个简单近似是，假设它完全由整个反应坐标上相对于初始反应物的最高能垒决定。这个“几何”最大势垒定义为：\n$$ \\Delta G_{\\max}^{\\ddagger} = \\max\\!\\left(G_{\\mathrm{TS1}}, G_{\\mathrm{TS2}}\\right) - G_R $$\n\n**第 6 步：计算中间体势阱深度**\n中间体的稳定性是关键。一个处于浅势阱中的非常不稳定（高能量）的中间体可能有很短的寿命，从而模糊了步骤之间的区别。我们将势阱深度 $d$ 量化为中间体与两个相邻过渡态中*较低*那个的能量差，因为这代表了中间体逃逸的最小势垒：\n$$ d = \\min\\!\\left(G_{\\mathrm{TS1}}, G_{\\mathrm{TS2}}\\right) - G_I $$\n\n**第 7 步：对反应剖面进行分类**\n最终分类取决于两个标准，这两个标准都必须满足才能被指定为“类协同”。这些标准的阈值由可用热能 $R T$ 设定。\n\n- **标准 A (浅势阱)：** $d \\le R T$。\n如果势阱深度 $d$ 小于或等于热能 $R T$，则认为该中间体在动力学上不重要。它很容易因热涨落而减少布居，以至于不代表一个离散的、可捕获的物种。\n\n- **标准 B (单势垒动力学)：** $\\left|\\Delta G_{\\mathrm{eff}}^{\\ddagger} - \\Delta G_{\\max}^{\\ddagger}\\right| \\le R T$。\n该标准测试了真实的、动力学推导的等效势垒 $\\Delta G_{\\mathrm{eff}}^{\\ddagger}$ 是否接近于简单的、几何推导的最大势垒 $\\Delta G_{\\max}^{\\ddagger}$。如果它们的差异在热能 $R T$ 范围内，则认为系统的动力学可以很好地用单个决速势垒来近似。\n\n当且仅当标准 A 和标准 B 都满足时，反应剖面被分类为**类协同** (`true`)。否则，存在动力学上显著的中间体或与单势垒动力学有重大偏离，将导致分类为**类分步** (`false`)。\n\n构建一个程序来对问题陈述中提供的每个测试用例执行这一系列计算。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the computational chemistry problem for a suite of test cases.\n    \"\"\"\n    \n    # Define physical constants as per the problem statement.\n    K_B = 1.380649e-23  # Boltzmann constant in J/K\n    H = 6.62607015e-34   # Planck's constant in J*s\n    R = 8.314462618e-3  # Molar gas constant in kJ/(mol*K)\n\n    # Test suite: (T, G_R, G_I, G_TS1, G_TS2, G_P)\n    # Units: (K, kJ/mol, kJ/mol, kJ/mol, kJ/mol, kJ/mol)\n    test_cases = [\n        # Case 1 (dominant first barrier, very shallow intermediate)\n        (298.0, 0.0, 78.5, 85.0, 79.0, -30.0),\n        # Case 2 (two comparable barriers, shallow intermediate but kinetic penalty apparent)\n        (298.0, 0.0, 77.0, 79.0, 80.0, -20.0),\n        # Case 3 (temperature-sensitive shallow well; at lower T the well is not shallow)\n        (298.0, 0.0, 78.0, 85.0, 80.5, -25.0),\n        # Case 4 (same energies as Case 3 but higher temperature reduces the relative well depth)\n        (320.0, 0.0, 78.0, 85.0, 80.5, -25.0),\n        # Case 5 (deep intermediate, clearly stepwise)\n        (298.0, 0.0, 20.0, 60.0, 50.0, -40.0),\n        # Case 6 (flat intermediate with one adjacent barrier essentially zero)\n        (298.0, 0.0, 80.0, 85.0, 80.0, -10.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        T, G_R, G_I, G_TS1, G_TS2, G_P = case\n\n        # Thermal energy term\n        RT = R * T  # in kJ/mol\n\n        # Step 1: Compute activation free energies (in kJ/mol)\n        delta_G_1_ddagger = G_TS1 - G_R\n        delta_G_neg1_ddagger = G_TS1 - G_I\n        delta_G_2_ddagger = G_TS2 - G_I\n\n        # Step 2: Compute TST rate constants (in s^-1)\n        # Eyring equation pre-factor\n        prefactor = (K_B * T) / H\n        \n        # Rate constants\n        k1 = prefactor * np.exp(-delta_G_1_ddagger / RT)\n        k_neg1 = prefactor * np.exp(-delta_G_neg1_ddagger / RT)\n        k2 = prefactor * np.exp(-delta_G_2_ddagger / RT)\n\n        # Step 3: Compute the observed rate constant (in s^-1)\n        # Handle potential division by zero if both k_neg1 and k2 are zero, though unlikely\n        denominator = k_neg1 + k2\n        if denominator == 0:\n            k_obs = 0\n        else:\n            k_obs = (k1 * k2) / denominator\n            \n        # Step 4: Compute the effective activation free energy (in kJ/mol)\n        # Invert the Eyring equation. Handle k_obs=0 case to avoid log(0).\n        if k_obs == 0:\n            # An infinite barrier corresponds to a zero rate constant.\n            delta_G_eff_ddagger = np.inf\n        else:\n            delta_G_eff_ddagger = -RT * np.log(k_obs / prefactor)\n\n        # Step 5: Compute the maximum geometric barrier (in kJ/mol)\n        delta_G_max_ddagger = max(G_TS1, G_TS2) - G_R\n\n        # Step 6: Compute the intermediate well depth (in kJ/mol)\n        d = min(G_TS1, G_TS2) - G_I\n\n        # Step 7: Decide concerted-like versus stepwise-like\n        # Criterion A: Shallow well\n        criterion_A = (d = RT)\n\n        # Criterion B: Single-barrier kinetics\n        criterion_B = (np.abs(delta_G_eff_ddagger - delta_G_max_ddagger) = RT)\n        \n        # Final classification\n        is_concerted_like = criterion_A and criterion_B\n        results.append(str(is_concerted_like).lower())\n\n    # Print the final output in the required format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2451429"}]}