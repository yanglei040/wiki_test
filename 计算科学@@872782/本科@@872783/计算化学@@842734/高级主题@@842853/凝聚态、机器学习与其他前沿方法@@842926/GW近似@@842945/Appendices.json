{"hands_on_practices": [{"introduction": "为了掌握 GW 近似的核心，我们首先从一个最简化的模型入手。这个练习将引导你为一个双能级氢分子模型，解析地计算其 GW 自能。通过将抽象的公式应用于一个具体可解的系统，本次实践旨在揭示自能项是如何定量描述电子间关联效应的，为你后续理解更复杂的计算打下坚实基础。[@problem_id:1147581]", "problem": "考虑一个氢分子模型，它由一个最小基组描述，该基组包含两个分别以两个原子为中心的正交原子轨道 $|a\\rangle$ 和 $|b\\rangle$。无相互作用的电子结构由紧束缚哈密顿量描述：\n$$\nH_0 = \\begin{pmatrix} \\epsilon_0 & -t \\\\ -t & \\epsilon_0 \\end{pmatrix}\n$$\n在基 $\\{|a\\rangle, |b\\rangle\\}$下，其中 $\\epsilon_0$ 是在位能，$t > 0$ 是跃迁积分。该哈密顿量有两个本征态：能量为 $E_1$ 的成键（HOMO）态 $|\\phi_1\\rangle$ 和能量为 $E_2$ 的反键（LUMO）态 $|\\phi_2\\rangle$。\n\n我们感兴趣的是使用GW近似计算单粒子能量的多体修正。对于本征态 $|\\phi_n\\rangle$ 在其自身能量 $E_n$ 处的自能相关部分 $\\Sigma_c$，可以使用屏蔽相互作用的等离激元-极点模型进行计算。对于这个两能级系统，集体电子激发由一个频率为 $\\Omega_p$ 的单等离激元模式描述。自能由下式给出：\n$$\n\\Sigma_{c,nn}(E_n) = \\sum_{m \\in \\{1,2\\}} \\frac{|\\langle \\phi_n \\phi_m | v | \\phi_1 \\phi_2 \\rangle|^2}{\\Delta E_{nm}^{\\pm}}\n$$\n其中 $v$ 是裸库仑相互作用算符，分母在 $m$ 为占据态（HOMO）时为 $\\Delta E_{nm}^{+} = E_n - E_m + \\Omega_p$，在 $m$ 为未占据态（LUMO）时为 $\\Delta E_{nm}^{-} = E_n - E_m - \\Omega_p$。\n\n等离激元频率 $\\Omega_p$ 由电子-空穴相互作用决定，并由以下关系式给出：\n$$\n\\Omega_p^2 = (E_2 - E_1)^2 + 2(E_2 - E_1) K\n$$\n其中 $K$ 是库仑矩阵元 $K = \\langle \\phi_1 \\phi_2 | v | \\phi_1 \\phi_2 \\rangle$。设另一个相关的实值库仑矩阵元为 $J = \\langle \\phi_1 \\phi_1 | v | \\phi_1 \\phi_2 \\rangle$。\n\n您的任务是计算 HOMO 态在 HOMO 能量处的相关自能 $\\Sigma_{c,11}(E_1)$。请用参数 $t$、$K$ 和 $J$ 将您的答案表示为一个封闭形式的解析表达式。", "solution": "HOMO 态在能量 $E_1$ 处的相关自能由下式给出：\n\n$$\n\\Sigma_{c,11}(E_1) = \\sum_{m \\in \\{1,2\\}} \\frac{|\\langle \\phi_1 \\phi_m | v | \\phi_1 \\phi_2 \\rangle|^2}{\\Delta E_{1m}^{\\pm}}\n$$\n\n其中，当 $m$ 为占据态（HOMO，$m=1$）时，$\\Delta E_{1m}^{+} = E_1 - E_1 + \\Omega_p = \\Omega_p$；当 $m$ 为未占据态（LUMO，$m=2$）时，$\\Delta E_{1m}^{-} = E_1 - E_2 - \\Omega_p$。因此：\n\n$$\n\\Sigma_{c,11}(E_1) = \\frac{|\\langle \\phi_1 \\phi_1 | v | \\phi_1 \\phi_2 \\rangle|^2}{\\Omega_p} + \\frac{|\\langle \\phi_1 \\phi_2 | v | \\phi_1 \\phi_2 \\rangle|^2}{E_1 - E_2 - \\Omega_p}\n$$\n\n库仑矩阵元为 $J = \\langle \\phi_1 \\phi_1 | v | \\phi_1 \\phi_2 \\rangle$ 和 $K = \\langle \\phi_1 \\phi_2 | v | \\phi_1 \\phi_2 \\rangle$，均为实数，因此 $|\\langle \\phi_1 \\phi_1 | v | \\phi_1 \\phi_2 \\rangle|^2 = J^2$ 且 $|\\langle \\phi_1 \\phi_2 | v | \\phi_1 \\phi_2 \\rangle|^2 = K^2$。代入得：\n\n$$\n\\Sigma_{c,11}(E_1) = \\frac{J^2}{\\Omega_p} + \\frac{K^2}{E_1 - E_2 - \\Omega_p}\n$$\n\n能量差 $E_2 - E_1$ 可由无相互作用哈密顿量的本征值求得：$E_1 = \\epsilon_0 - t$ (HOMO) 和 $E_2 = \\epsilon_0 + t$ (LUMO)，所以：\n\n$$\nE_2 - E_1 = 2t\n$$\n\n因此：\n\n$$\nE_1 - E_2 = -2t\n$$\n\n代入得：\n\n$$\n\\Sigma_{c,11}(E_1) = \\frac{J^2}{\\Omega_p} + \\frac{K^2}{-2t - \\Omega_p} = \\frac{J^2}{\\Omega_p} - \\frac{K^2}{2t + \\Omega_p}\n$$\n\n等离激元频率 $\\Omega_p$ 由下式给出：\n\n$$\n\\Omega_p^2 = (E_2 - E_1)^2 + 2(E_2 - E_1)K = (2t)^2 + 2(2t)K = 4t^2 + 4tK\n$$\n\n解出 $\\Omega_p$：\n\n$$\n\\Omega_p = \\sqrt{4t^2 + 4tK} = 2\\sqrt{t^2 + tK} = 2\\sqrt{t(t + K)}\n$$\n\n代入自能表达式：\n\n$$\n\\Sigma_{c,11}(E_1) = \\frac{J^2}{2\\sqrt{t(t + K)}} - \\frac{K^2}{2t + 2\\sqrt{t(t + K)}}\n$$\n\n对第二项的分母进行因式分解：\n\n$$\n2t + 2\\sqrt{t(t + K)} = 2\\left(t + \\sqrt{t(t + K)}\\right)\n$$\n\n因此：\n\n$$\n\\Sigma_{c,11}(E_1) = \\frac{J^2}{2\\sqrt{t(t + K)}} - \\frac{K^2}{2\\left(t + \\sqrt{t(t + K)}\\right)}\n$$", "answer": "$$\n\\boxed{ \\dfrac{ J^{2} }{ 2 \\sqrt{ t \\left( t + K \\right) } } - \\dfrac{ K^{2} }{ 2 \\left( t + \\sqrt{ t \\left( t + K \\right) } \\right) } }\n$$", "id": "1147581"}, {"introduction": "理解了自能的计算方法后，我们必须探讨为何这一修正是如此关键。本练习呈现了一个计算材料科学研究中的常见情景：密度泛函理论（DFT）与 GW 近似对同一种材料给出了截然不同的电子属性预测（例如，金属 vs. 绝缘体）。通过分析这一问题，你将学会如何批判性地解读计算结果，并深刻理解 GW 近似在修正传统 DFT 泛函中普遍存在的“带隙问题”时所扮演的重要角色。[@problem_id:2464573]", "problem": "一种晶体材料在密度泛函理论 (DFT) 框架内，使用 Kohn–Sham (KS) 方案中的半局域交换关联泛函进行计算，结果发现该材料是金属性的，其 KS 能隙为 $\\Delta_{\\mathrm{KS}} = 0$。随后，在格林函数-屏蔽库仑 (GW) 近似下，以 DFT 结果为出发点进行了一次单次 (one-shot) $G_0W_0$ 计算，预测在费米能级处存在一个准粒子能隙 $\\Delta_{\\mathrm{QP}} > 0$。关于初始 DFT 描述的质量，哪种说法最能解释这一结果？\n\nA. 消失的 Kohn–Sham 能隙是半局域交换关联泛函的带隙问题的体现；GW 自能对此进行了修正，表明真实体系是绝缘的，并且 DFT 出发点在性质上对该材料进行了错误分类。\n\nB. 因为 Kohn–Sham 本征值原则上是精确的准粒子能量，任何差异都证明 GW 近似在这里是不符合物理的，而 DFT 的金属性结果是正确的。\n\nC. GW 能级上出现非零能隙的唯一可能是自旋对称性破缺；因此，初始的 DFT 描述必定忽略了磁性，而 GW 的结果反映了自旋有序。\n\nD. 金属性的 DFT 出发点导致了严重的屏蔽不足的相互作用，使得 GW 伪开了一个能隙；因此，DFT 的金属性结果是可靠的，而 GW 的能隙是一个数值赝象。\n\nE. 能隙的打开证明该体系是一个需要显式 Hubbard $U$ 的 Mott 绝缘体；对于简单的能带绝缘体，DFT 出发点是足够的，所以失败完全是由于缺少 $U$ 型物理。", "solution": "必须首先验证问题陈述的科学合理性和逻辑一致性。\n\n**步骤 1：提取已知条件**\n- 在密度泛函理论 (DFT) 框架内，使用 Kohn–Sham (KS) 方案中的半局域交换关联泛函对一种晶体材料进行了计算。\n- DFT 计算的结果是一个金属性态，其特征是 KS 能隙 $\\Delta_{\\mathrm{KS}} = 0$。\n- 随后，以 DFT 结果为出发点，进行了一次单次 (one-shot) $G_0W_0$ 计算。\n- $G_0W_0$ 计算预测在费米能级处存在一个准粒子能隙 $\\Delta_{\\mathrm{QP}} > 0$。\n- 问题要求对这一结果给出关于初始 DFT 描述质量的正确解释。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学依据**：所呈现的情景是计算固态物理和材料科学中一个经典且常见的情况。众所周知，半局域 DFT 泛函（如局域密度近似，LDA，或广义梯度近似，GGAs）存在“带隙问题”，这主要源于自相互作用误差以及近似交换关联势中缺少导数不连续性。这通常导致对带隙的严重低估，有时甚至对实验上已知的绝缘体或半导体预测出金属性态（$\\Delta_{\\mathrm{KS}} = 0$）。GW 近似是多体微扰理论中的一种方法，是计算准粒子能量并修正 DFT 在这方面缺陷的标准方法。以 DFT 为出发点的单次 $G_0W_0$ 方法是一种广泛使用的计算方案。因此，该问题牢固地建立在公认的科学原理和实践之上。\n- **适定性和客观性**：该问题是适定的。它描述了一个具体、明确的计算结果，并要求在公认的理论框架内对其进行物理解释。语言是客观和技术性的。\n\n**步骤 3：结论与行动**\n问题陈述在科学上是合理的、适定的，并且没有矛盾或含糊之处。它描述了计算材料科学中的一个标准情况。因此，该问题是**有效的**，可以推导出解决方案。\n\n**推导与选项分析**\n\n问题的核心在于 Kohn–Sham DFT 和 GW 近似所计算的物理量之间的根本差异。\n\n在 KS-DFT 框架中，KS 方程描述了一个虚拟的无相互作用电子体系，该体系通过构造与真实的相互作用电子体系具有相同的基态密度。KS 本征值 $\\epsilon_{n\\mathbf{k}}^{\\mathrm{KS}}$ 是这个辅助体系的本征值。它们通常不是相互作用体系中真实的电子增加/移除能量（准粒子能量）。最高占据态和最低未占据态 KS 本征值之差给出了 KS 能隙 $\\Delta_{\\mathrm{KS}}$。对于半局域泛函，由于固有的近似（最显著的是自相互作用误差），该能隙被系统性地低估。$\\Delta_{\\mathrm{KS}} = 0$ 的结果是一种常见的失败，表明对绝缘材料电子结构的定性描述有误。\n\nGW 近似提供了一种计算电子自能 $\\Sigma$ 的方法，该自能考虑了超出 DFT 平均场描述的多体效应。准粒子能量 $E_{n\\mathbf{k}}^{\\mathrm{QP}}$ 则是通过求解准粒子方程得到的，其一阶近似形式为：\n$$ E_{n\\mathbf{k}}^{\\mathrm{QP}} \\approx \\epsilon_{n\\mathbf{k}}^{\\mathrm{KS}} + Z_{n\\mathbf{k}} \\langle \\psi_{n\\mathbf{k}}^{\\mathrm{KS}} | \\Sigma(E_{n\\mathbf{k}}^{\\mathrm{QP}}) - V_{\\mathrm{xc}}^{\\mathrm{KS}} | \\psi_{n\\mathbf{k}}^{\\mathrm{KS}} \\rangle $$\n这里，$V_{\\mathrm{xc}}^{\\mathrm{KS}}$ 是 KS 交换关联势，$Z_{n\\mathbf{k}}$ 是准粒子重整化因子。$\\Sigma - V_{\\mathrm{xc}}^{\\mathrm{KS}}$ 项代表对 KS 本征值的修正。准粒子能隙为 $\\Delta_{\\mathrm{QP}} = \\min(E_{\\mathrm{unocc}}^{\\mathrm{QP}}) - \\max(E_{\\mathrm{occ}}^{\\mathrm{QP}})$。\n\n从金属性的 DFT 态（$\\Delta_{\\mathrm{KS}} = 0$）出发的单次 $G_0W_0$ 计算得到非零的准粒子能隙（$\\Delta_{\\mathrm{QP}} > 0$），这一事实是 DFT 带隙问题的标准标志。GW 计算修正了半局域 DFT 泛函对电子激发的糟糕描述，揭示了在 DFT 层次上被忽略的材料的绝缘性质。\n\n现在，我们评估每个选项。\n\n**A. 消失的 Kohn–Sham 能隙是半局域交换关联泛函的带隙问题的体现；GW 自能对此进行了修正，表明真实体系是绝缘的，并且 DFT 出发点在性质上对该材料进行了错误分类。**\n这种说法是对所述计算结果的精确和标准解释。半局域 DFT 未能预测出能隙即为“带隙问题”。GW 近似是标准的从头算修正方法。能隙的打开（$\\Delta_{\\mathrm{QP}} > 0$）意味着在这一更高层次的理论上，该体系被预测为绝缘体或半导体，因此最初的金属性 DFT 描述在性质上是错误的。\n**结论：正确。**\n\n**B. 因为 Kohn–Sham 本征值原则上是精确的准粒子能量，任何差异都证明 GW 近似在这里是不符合物理的，而 DFT 的金属性结果是正确的。**\n这个前提从根本上是错误的。Kohn–Sham 本征值是数学上的辅助量，原则上不等于准粒子能量，唯一的例外是在使用精确交换关联泛函时有限体系的最高占据态。整个电子结构多体微扰理论领域都建立在认识到 KS 本征值对于准粒子能带结构来说是一个不充分的近似这一基础上。因此，该选项基于对 DFT 的深刻误解。\n**结论：错误。**\n\n**C. GW 能级上出现非零能隙的唯一可能是自旋对称性破缺；因此，初始的 DFT 描述必定忽略了磁性，而 GW 的结果反映了自旋有序。**\n这种说法是错误的。GW 自能修正可以在非磁性、自旋非极化的体系中打开能隙。这种修正源于对电子关联和非局域交换效应的更精确处理，这些效应与自旋有序无关。虽然破坏自旋对称性（例如，在反铁磁体中）是打开能隙的一种机制，但它绝不是唯一的机制，也不是 GW 修正打开能隙的必要条件。许多简单的非磁性半导体，如硅或锗，都表现出这种行为（DFT 能隙被低估，由 GW 修正）。\n**结论：错误。**\n\n**D. 金属性的 DFT 出发点导致了严重的屏蔽不足的相互作用，使得 GW 伪开了一个能隙；因此，DFT 的金属性结果是可靠的，而 GW 的能隙是一个数值赝象。**\n这种说法曲解了屏蔽的物理原理。一个具有无能隙激发的金属性体系比绝缘体系对库仑相互作用提供*更强*的屏蔽。因此，从金属性的 DFT 出发点计算屏蔽相互作用 $W_0$ 会得到一个*过度屏蔽*的相互作用（相比于从自洽或绝缘出发点得到的结果）。一个被更强屏蔽（即更弱）的相互作用 $W_0$ 会导致更小的自能修正，从而导致更小的能隙。能隙在金属性出发点固有的过度屏蔽* সত্ত্বেও*仍然打开，这一事实有力地表明该能隙是一个真实的物理特征，而不是一个伪赝象。“屏蔽不足的相互作用”这一前提与实际情况恰恰相反。\n**结论：错误。**\n\n**E. 能隙的打开证明该体系是一个需要显式 Hubbard $U$ 的 Mott 绝缘体；对于简单的能带绝缘体，DFT 出发点是足够的，所以失败完全是由于缺少 $U$ 型物理。**\n这种说法提出了一个未经证实且过于具体的论断。半局域 DFT 的带隙问题是一个普遍现象，它既影响简单的能带绝缘体（如 Ge、GaAs），也影响像 Mott 绝缘体这样的强关联体系。事实证明，半局域 DFT 对于简单的能带绝缘体是*不*足够的，因为它系统性地低估了它们的能隙。因此，用 GW 方法打开一个能隙并不足以证明该体系是一个 Mott 绝缘体。这仅仅是任何被初始 DFT 计算描述不佳的绝缘体系的预期行为。断言失败*完全*是由于缺少 Hubbard $U$ 型物理是错误的。\n**结论：错误。**", "answer": "$$\\boxed{A}$$", "id": "2464573"}, {"introduction": "在前述概念理解的基础上，我们最后的实践将深入探讨 $G_0W_0$ 计算中的一个关键技术细节——“起点依赖性”。你将推导并编程实现一个简化模型，以量化初始 DFT 计算（例如，使用 LDA 或杂化泛函）的选择如何影响最终的 GW 带隙。这项编程练习将让你亲手体验和理解多体微扰理论计算的精妙之处，并让你对计算结果的可靠性有更深入的认识。[@problem_id:2464622]", "problem": "要求您形式化并实现一个基于原理的最小模型，用于描述格林函数乘以屏蔽库仑相互作用近似 ($G_0W_0$) 对氧化锌 (ZnO) 带隙的起始点依赖性。目标是从多体微扰理论和密度泛函理论 (DFT) 的基本定义出发，推导出一个简化的、可测试的准粒子带隙表达式，该表达式能明确体现起始点依赖性。然后，在一个可运行的程序中实现这个表达式，并用一个小型测试集对其进行评估。所有数值结果必须以电子伏特 (eV) 为单位。\n\n请从以下基本依据和假设出发，这些都是该领域中标准且经过充分检验的：\n\n- 无相互作用格林函数 $G_0$ 由密度泛函理论 (DFT) 的 Kohn–Sham 轨道和本征值构建。\n- 屏蔽库仑相互作用为 $W_0 = \\epsilon^{-1} v$，其中 $v$ 是裸库仑相互作用，$\\epsilon$ 是介电函数。\n- 在准粒子方程中，态 $i$ 的准粒子能量 $E_i$ 满足 $E_i = \\varepsilon_i + Z_i \\langle \\psi_i | \\Sigma(E_i) - V_{xc} | \\psi_i \\rangle$，其中 $\\varepsilon_i$ 和 $\\psi_i$ 分别是 Kohn–Sham 本征值和轨道，$V_{xc}$ 是 DFT 交换关联势，$\\Sigma(\\omega)$ 是自能，$Z_i$ 是重整化因子。\n- 考虑使用静态库仑洞加屏蔽交换 (COHSEX) 极限作为 $GW$ 的一种具有物理动机的简化：$\\Sigma \\approx \\Sigma_{\\mathrm{SEX}} + \\Sigma_{\\mathrm{COH}}$，其中 $\\Sigma_{\\mathrm{SEX}}$ 是屏蔽交换算符，$\\Sigma_{\\mathrm{COH}}$ 是库仑洞项。在一个最小二能级模型中采用对角近似：一个价带态 $v$ (占据) 和一个导带态 $c$ (未占据)。\n- 对屏蔽相互作用采用标量的、频率无关的屏蔽：$W_0 \\approx v/\\epsilon_{\\infty}$，其中 $\\epsilon_{\\infty}$ 是一个有效高频介电常数。假设在静态极限下，重整化因子 $Z_i \\approx 1$。\n- 使用一个基于物理动机的观察：在带隙差中，$v$ 和 $c$ 之间的对角库仑洞贡献近似抵消，而屏蔽交换对占据的价带态有贡献，但对未占据的导带态没有贡献。\n- 为了建模对 DFT 起始点的依赖性，假设杂化泛函的交换关联势 $V_{xc}$ 包含一部分比例为 $\\alpha$ 的裸 Fock 交换。将期望值分裂近似为 $\\langle \\psi_c | V_{xc} | \\psi_c \\rangle - \\langle \\psi_v | V_{xc} | \\psi_v \\rangle \\approx \\alpha K_x$，其中 $K_x$ 是针对价带态的有效裸交换积分尺度，且导带态的自交换可忽略不计。\n\n仅根据这些基本依据和假设，推导准粒子带隙 $E_g^{GW}$ 的一个显式表达式，该表达式用以下参数表示：\n- DFT 带隙 $E_g^{\\mathrm{DFT}}$，\n- 标量屏蔽 $\\epsilon_{\\infty}$，\n- 杂化混合参数 $\\alpha$（对于局域密度近似 (LDA) 和 Perdew–Burke–Ernzerhof (PBE) 广义梯度近似 (GGA)，$\\alpha = 0$，对于杂化泛函，$\\alpha$ 为非零值），\n- 以及有效裸交换尺度 $K_x$。\n\n然后，实现一个程序，用以下测试集计算所得表达式的值。所有能量和 $K_x$ 必须以 eV 为单位；$\\epsilon_{\\infty}$ 是无量纲的；$\\alpha$ 是无量纲的。程序输出结果以 eV 表示，并四舍五入到三位小数。\n\n测试集（每个用例是一个元组 $(E_g^{\\mathrm{DFT}}, \\alpha, \\epsilon_{\\infty}, K_x)$）：\n- 测试用例 A (ZnO, LDA 起始): $(0.80, 0.00, 3.50, 7.00)$\n- 测试用例 B (ZnO, PBE 起始): $(1.00, 0.00, 3.50, 7.00)$\n- 测试用例 C (ZnO, 含 $25\\%$ 精确交换的杂化泛函起始): $(3.00, 0.25, 3.50, 7.00)$\n- 测试用例 D (灵敏度检查，杂化泛函，稍强的屏蔽): $(3.00, 0.25, 3.00, 7.00)$\n- 测试用例 E (灵敏度检查，杂化泛函，稍弱的屏蔽): $(3.00, 0.25, 5.00, 7.00)$\n\n您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表（例如 $[x_1,x_2,x_3,x_4,x_5]$），其中 $x_i$ 是为用例 $i$ 计算出的 $G_0W_0$ 带隙（单位为 eV），四舍五入到三位小数。所有角度（如有）必须以弧度为单位。本问题不使用角度。确保每个值 $x_i$ 都是小数点后恰好有三位数字的浮点数字面量。", "solution": "问题陈述需经过验证。\n\n步骤1：提取已知条件。\n- 理论框架是多体微扰理论中的 $G_0W_0$ 近似，从密度泛函理论 (DFT) 出发。\n- 无相互作用格林函数 $G_0$ 由 Kohn–Sham (KS) 轨道和本征值构建。\n- 屏蔽库仑相互作用为 $W_0 = \\epsilon^{-1} v$，其中 $v$ 是裸库仑相互作用，$\\epsilon$ 是介电函数。\n- 态 $i$ 的准粒子 (QP) 能量 $E_i$ 由以下方程给出：$E_i = \\varepsilon_i + Z_i \\langle \\psi_i | \\Sigma(E_i) - V_{xc} | \\psi_i \\rangle$，其中 $\\varepsilon_i$ 和 $\\psi_i$ 是 KS 本征值和轨道，$V_{xc}$ 是 DFT 交换关联势，$\\Sigma(\\omega)$ 是自能，$Z_i$ 是重整化因子。\n- 提供了一系列简化近似：\n    1. 自能 $\\Sigma$ 取静态库仑洞加屏蔽交换 (COHSEX) 极限：$\\Sigma \\approx \\Sigma_{\\mathrm{SEX}} + \\Sigma_{\\mathrm{COH}}$。\n    2. 考虑一个最小二能级模型，包含一个占据的价带态 $v$ 和一个未占据的导带态 $c$。\n    3. 使用对角近似。\n    4. 屏蔽是标量的且与频率无关：$W_0 \\approx v/\\epsilon_{\\infty}$，其中 $\\epsilon_{\\infty}$ 是有效高频介电常数。\n    5. 重整化因子近似为 $Z_i \\approx 1$。\n    6. 在带隙差中，假定对角库仑洞贡献相互抵消：$\\langle \\Sigma_{\\mathrm{COH}} \\rangle_c \\approx \\langle \\Sigma_{\\mathrm{COH}} \\rangle_v$。\n    7. 屏蔽交换对占据态 $v$ 有贡献，但对未占据态 $c$ 可忽略不计。\n    8. 对 DFT 起始点的依赖性通过杂化泛函 $V_{xc}$ 中裸 Fock 交换的比例 $\\alpha$ 来建模。期望值分裂近似为 $\\langle \\psi_c | V_{xc} | \\psi_c \\rangle - \\langle \\psi_v | V_{xc} | \\psi_v \\rangle \\approx \\alpha K_x$，其中 $K_x$ 是一个有效裸交换积分尺度。\n- 目标是推导 QP 带隙 $E_g^{GW}$ 作为 DFT 带隙 $E_g^{\\mathrm{DFT}}$、屏蔽参数 $\\epsilon_{\\infty}$、杂化混合参数 $\\alpha$ 和交换尺度 $K_x$ 的函数表达式。\n- 提供了一套用于数值评估的参数测试集：\n    - 测试用例 A: $(E_g^{\\mathrm{DFT}}, \\alpha, \\epsilon_{\\infty}, K_x) = (0.80, 0.00, 3.50, 7.00)$\n    - 测试用例 B: $(E_g^{\\mathrm{DFT}}, \\alpha, \\epsilon_{\\infty}, K_x) = (1.00, 0.00, 3.50, 7.00)$\n    - 测试用例 C: $(E_g^{\\mathrm{DFT}}, \\alpha, \\epsilon_{\\infty}, K_x) = (3.00, 0.25, 3.50, 7.00)$\n    - 测试用例 D: $(E_g^{\\mathrm{DFT}}, \\alpha, \\epsilon_{\\infty}, K_x) = (3.00, 0.25, 3.00, 7.00)$\n    - 测试用例 E: $(E_g^{\\mathrm{DFT}}, \\alpha, \\epsilon_{\\infty}, K_x) = (3.00, 0.25, 5.00, 7.00)$\n\n步骤2：使用提取的已知条件进行验证。\n该问题具有科学依据，基于 DFT 和多体微扰理论 (MBPT) 的既定原理。所用的近似（静态 COHSEX，杂化泛函依赖性模型）是计算材料科学领域的标准且有详细文献记录的简化方法，用于推导物理图像清晰的模型。问题是良构的，提供了所有必要信息和明确的目标。语言客观而精确。为 ZnO 给出的参数在物理上是合理的。该问题不违反任何无效标准。\n\n步骤3：结论和行动。\n问题有效。将提供正式的推导和解答。\n\n准粒子带隙 $E_g^{GW}$ 的推导始于导带底 (态 $c$) 和价带顶 (态 $v$) 的基本准粒子方程。使用给定的近似 $Z_i \\approx 1$，准粒子能量 $E_c$ 和 $E_v$ 的方程为：\n$$\nE_c \\approx \\varepsilon_c + \\langle \\psi_c | \\Sigma - V_{xc} | \\psi_c \\rangle\n$$\n$$\nE_v \\approx \\varepsilon_v + \\langle \\psi_v | \\Sigma - V_{xc} | \\psi_v \\rangle\n$$\n此处，$\\varepsilon_c$ 和 $\\varepsilon_v$ 是 Kohn-Sham 本征值。准粒子带隙是差值 $E_g^{GW} = E_c - E_v$。两式相减可得：\n$$\nE_g^{GW} \\approx (\\varepsilon_c - \\varepsilon_v) + \\left( \\langle \\psi_c | \\Sigma | \\psi_c \\rangle - \\langle \\psi_v | \\Sigma | \\psi_v \\rangle \\right) - \\left( \\langle \\psi_c | V_{xc} | \\psi_c \\rangle - \\langle \\psi_v | V_{xc} | \\psi_v \\rangle \\right)\n$$\n第一项 $\\varepsilon_c - \\varepsilon_v$ 正是起始 DFT 计算得到的 Kohn-Sham 带隙，我们将其记为 $E_g^{\\mathrm{DFT}}$。方程变为：\n$$\nE_g^{GW} \\approx E_g^{\\mathrm{DFT}} + \\Delta\\Sigma - \\Delta V_{xc}\n$$\n其中 $\\Delta\\Sigma = \\langle \\psi_c | \\Sigma | \\psi_c \\rangle - \\langle \\psi_v | \\Sigma | \\psi_v \\rangle$ 且 $\\Delta V_{xc} = \\langle \\psi_c | V_{xc} | \\psi_c \\rangle - \\langle \\psi_v | V_{xc} | \\psi_v \\rangle$。现在我们必须使用给定的假设对这两项进行建模。\n\n首先，我们分析自能修正项 $\\Delta\\Sigma$。我们采用静态 COHSEX 近似，$\\Sigma \\approx \\Sigma_{\\mathrm{SEX}} + \\Sigma_{\\mathrm{COH}}$。\n$$\n\\Delta\\Sigma \\approx \\left( \\langle \\Sigma_{\\mathrm{SEX}} \\rangle_c - \\langle \\Sigma_{\\mathrm{SEX}} \\rangle_v \\right) + \\left( \\langle \\Sigma_{\\mathrm{COH}} \\rangle_c - \\langle \\Sigma_{\\mathrm{COH}} \\rangle_v \\right)\n$$\n根据问题陈述，假定库仑洞贡献近似抵消，因此 $\\langle \\Sigma_{\\mathrm{COH}} \\rangle_c - \\langle \\Sigma_{\\mathrm{COH}} \\rangle_v \\approx 0$。此外，假定对于未占据的导带态，屏蔽交换可以忽略不计，即 $\\langle \\Sigma_{\\mathrm{SEX}} \\rangle_c \\approx 0$。这将自能修正简化为：\n$$\n\\Delta\\Sigma \\approx - \\langle \\Sigma_{\\mathrm{SEX}} \\rangle_v\n$$\n在静态极限和标量屏蔽 $W_0 \\approx v/\\epsilon_{\\infty}$ 条件下，屏蔽交换算符 $\\Sigma_{\\mathrm{SEX}}$ 与裸 Fock 交换算符 $V_x^{\\mathrm{HF}}$ 的关系为 $\\Sigma_{\\mathrm{SEX}} \\approx V_x^{\\mathrm{HF}} / \\epsilon_{\\infty}$。裸 Fock 交换对于一个占据态 $\\psi_v$ 的期望值定义了有效交换积分尺度，$\\langle \\psi_v | V_x^{\\mathrm{HF}} | \\psi_v \\rangle \\approx -K_x$，其中 $K_x$ 是一个代表自交换能的正值。因此：\n$$\n\\langle \\Sigma_{\\mathrm{SEX}} \\rangle_v \\approx \\frac{1}{\\epsilon_{\\infty}} \\langle \\psi_v | V_x^{\\mathrm{HF}} | \\psi_v \\rangle \\approx -\\frac{K_x}{\\epsilon_{\\infty}}\n$$\n将此代回，我们得到对带隙修正的自能贡献：\n$$\n\\Delta\\Sigma \\approx - \\left( -\\frac{K_x}{\\epsilon_{\\infty}} \\right) = \\frac{K_x}{\\epsilon_{\\infty}}\n$$\n\n接下来，我们处理交换关联势项 $\\Delta V_{xc}$。问题为此项提供了一个直接模型以说明其对起始点的依赖性：\n$$\n\\Delta V_{xc} = \\langle \\psi_c | V_{xc} | \\psi_c \\rangle - \\langle \\psi_v | V_{xc} | \\psi_v \\rangle \\approx \\alpha K_x\n$$\n此近似正确地模拟了这样一个事实：当一部分比例为 $\\alpha$ 的 Fock 交换被引入 DFT 泛函时，主要会使占据的价带态 $\\psi_v$ 的能量加深一个与 $K_x$ 成正比的量，从而增大了态 $c$ 和 $v$ 的势期望值之间的差异。\n\n最后，将所有部分组合成 $E_g^{GW}$ 的表达式：\n$$\nE_g^{GW} \\approx E_g^{\\mathrm{DFT}} + \\Delta\\Sigma - \\Delta V_{xc}\n$$\n代入推导出的 $\\Delta\\Sigma$ 和 $\\Delta V_{xc}$ 的形式：\n$$\nE_g^{GW} \\approx E_g^{\\mathrm{DFT}} + \\frac{K_x}{\\epsilon_{\\infty}} - \\alpha K_x\n$$\n该表达式可以重新排列以突出修正项的结构：\n$$\nE_g^{GW} \\approx E_g^{\\mathrm{DFT}} + K_x \\left( \\frac{1}{\\epsilon_{\\infty}} - \\alpha \\right)\n$$\n这是最终简化的准粒子带隙表达式。它明确显示了 $G_0W_0$ 修正如何依赖于屏蔽环境 ($\\epsilon_{\\infty}$)，并减去了起始 DFT 计算中已经考虑的裸交换项 ($\\alpha K_x$)。现在将实现此公式并对给定的测试集进行评估。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the G0W0 band gap problem based on the derived simplified model.\n    \"\"\"\n\n    # Test suite from the problem statement.\n    # Each case is a tuple: (E_g_DFT, alpha, epsilon_infinity, K_x)\n    # All energy values (E_g_DFT, K_x) are in eV.\n    test_cases = [\n        # Case A (ZnO, LDA start)\n        (0.80, 0.00, 3.50, 7.00),\n        # Case B (ZnO, PBE start)\n        (1.00, 0.00, 3.50, 7.00),\n        # Case C (ZnO, hybrid start with 25% exact exchange)\n        (3.00, 0.25, 3.50, 7.00),\n        # Case D (sensitivity check, hybrid, slightly weaker screening)\n        (3.00, 0.25, 3.00, 7.00),\n        # Case E (sensitivity check, hybrid, somewhat stronger screening)\n        (3.00, 0.25, 5.00, 7.00),\n    ]\n\n    results = []\n    \n    # The derived formula for the G0W0 quasiparticle band gap is:\n    # E_g_GW = E_g_DFT + K_x * (1 / epsilon_infinity - alpha)\n    for case in test_cases:\n        E_g_dft, alpha, epsilon_infinity, K_x = case\n        \n        # Calculate the G0W0 correction term\n        correction = K_x * (1.0 / epsilon_infinity - alpha)\n        \n        # Calculate the final G0W0 band gap\n        E_g_gw = E_g_dft + correction\n        \n        # Format the result to three decimal places as a string literal\n        results.append(f\"{E_g_gw:.3f}\")\n\n    # Final print statement in the exact required format.\n    # Example: [2.800,3.000,3.250,3.583,2.650]\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2464622"}]}