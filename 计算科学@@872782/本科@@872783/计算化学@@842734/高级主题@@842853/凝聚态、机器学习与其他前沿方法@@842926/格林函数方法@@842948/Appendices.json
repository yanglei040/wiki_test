{"hands_on_practices": [{"introduction": "理论学习之后，最好的巩固方式就是动手实践。第一个练习将带领你应用格林函数方法中最核心的方程之一——戴森方程。通过为一个简单的双中心紧束缚模型计算准粒子能量，你将直接体验到相互作用（在此由一个假设的自能矩阵 $\\Sigma(\\omega)$ 建模）如何修正一个系统的基本电子能级。这个练习旨在夯实你对准粒子概念的理解，并熟练掌握通过求解格林函数极点来确定系统能谱的基本计算技能 [@problem_id:2456246]。", "problem": "考虑一个双位点紧束缚模型，其无相互作用哈密顿量为\n$$\nH_{0}=\\begin{pmatrix}\n\\varepsilon_{0}  -t \\\\\n-t  \\varepsilon_{0}\n\\end{pmatrix},\n$$\n其中两个在位能均为 $\\varepsilon_{0}=0.50~\\text{eV}$，跃迁参数为 $t=0.20~\\text{eV}$。推迟自能是对角的，且在两个位点上相同，具体为\n$$\n\\Sigma^{R}_{11}(\\omega)=a\\,\\omega+b,\\qquad \\Sigma^{R}_{22}(\\omega)=a\\,\\omega+b,\n$$\n其中 $a=0.10$（无量纲），$b=-0.05~\\text{eV}$。推迟单粒子格林函数 $G^{R}(\\omega)$ 由 Dyson 方程定义\n$$\n\\left[G^{R}(\\omega)\\right]^{-1}=\\omega I - H_{0}-\\Sigma^{R}(\\omega),\n$$\n准粒子能量定义为使 $G^{R}(\\omega)$ 具有极点的实频率 $\\omega$。\n\n使用这些定义，确定两个准粒子能量。以电子伏特表示最终能量，并将每个值四舍五入到四位有效数字。", "solution": "在尝试任何解答之前，将对所提出的问题进行验证。\n\n**步骤 1：提取已知条件**\n- 无相互作用哈密顿量：$H_{0}=\\begin{pmatrix} \\varepsilon_{0}  -t \\\\ -t  \\varepsilon_{0} \\end{pmatrix}$\n- 在位能：$\\varepsilon_{0}=0.50~\\text{eV}$\n- 跃迁参数：$t=0.20~\\text{eV}$\n- 推迟自能矩阵：$\\Sigma^{R}(\\omega)=\\begin{pmatrix} \\Sigma^{R}_{11}(\\omega)  0 \\\\ 0  \\Sigma^{R}_{22}(\\omega) \\end{pmatrix}$\n- 自能分量：$\\Sigma^{R}_{11}(\\omega)=a\\,\\omega+b$ 和 $\\Sigma^{R}_{22}(\\omega)=a\\,\\omega+b$\n- 参数 $a$：$a=0.10$（无量纲）\n- 参数 $b$：$b=-0.05~\\text{eV}$\n- Dyson 方程：$\\left[G^{R}(\\omega)\\right]^{-1}=\\omega I - H_{0}-\\Sigma^{R}(\\omega)$，其中 $I$ 是单位矩阵。\n- 准粒子能量的定义：使推迟单粒子格林函数 $G^{R}(\\omega)$ 具有极点的实频率 $\\omega$。\n\n**步骤 2：验证**\n该问题具有科学依据，因为它采用了格林函数和 Dyson 方程的标准形式来描述双位点紧束缚模型，这是固态物理和量子化学中的一个基本概念。自能被赋予了一个简单的频率线性形式，这是一个有效的一阶近似。该问题是适定的，提供了所有必要的参数和待计算量的明确定义。问题陈述客观，并使用了精确的术语。所有提供的参数在量纲上都是一致的。\n\n**步骤 3：结论**\n该问题被认为是有效的。将提供解答。\n\n准粒子能量定义为推迟格林函数 $G^{R}(\\omega)$ 的极点。矩阵函数的极点出现在使其逆矩阵 $\\left[G^{R}(\\omega)\\right]^{-1}$ 奇异的频率 $\\omega$ 处。如果一个矩阵的行列式为零，则该矩阵是奇异的。因此，我们必须找到方程 $\\det\\left(\\left[G^{R}(\\omega)\\right]^{-1}\\right)=0$ 的根。\n\n首先，我们使用 Dyson 方程构造格林函数逆矩阵：\n$$\n\\left[G^{R}(\\omega)\\right]^{-1}=\\omega I - H_{0}-\\Sigma^{R}(\\omega)\n$$\n代入给定的单位矩阵 $I$、哈密顿量 $H_0$ 和自能 $\\Sigma^R(\\omega)$：\n$$\n\\left[G^{R}(\\omega)\\right]^{-1} = \\omega \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} - \\begin{pmatrix} \\varepsilon_{0}  -t \\\\ -t  \\varepsilon_{0} \\end{pmatrix} - \\begin{pmatrix} a\\omega+b  0 \\\\ 0  a\\omega+b \\end{pmatrix}\n$$\n执行矩阵减法，我们得到：\n$$\n\\left[G^{R}(\\omega)\\right]^{-1} = \\begin{pmatrix} \\omega - \\varepsilon_{0} - (a\\omega+b)  t \\\\ t  \\omega - \\varepsilon_{0} - (a\\omega+b) \\end{pmatrix}\n$$\n我们可以通过合并含 $\\omega$ 的项来简化对角元素：\n$$\n\\left[G^{R}(\\omega)\\right]^{-1} = \\begin{pmatrix} (1-a)\\omega - \\varepsilon_{0} - b  t \\\\ t  (1-a)\\omega - \\varepsilon_{0} - b \\end{pmatrix}\n$$\n现在，我们计算这个矩阵的行列式，并令其为零。令 $Z(\\omega) = (1-a)\\omega - \\varepsilon_{0} - b$。极点的条件是：\n$$\n\\det \\begin{pmatrix} Z(\\omega)  t \\\\ t  Z(\\omega) \\end{pmatrix} = (Z(\\omega))^{2} - t^{2} = 0\n$$\n这个方程对 $Z(\\omega)$ 产生两个解：\n$$\nZ(\\omega) = t \\quad \\text{and} \\quad Z(\\omega) = -t\n$$\n我们对每种情况求解 $\\omega$，以找到两个准粒子能量，我们将其表示为 $\\omega_1$ 和 $\\omega_2$。\n\n情况 1：$Z(\\omega) = t$\n$$\n(1-a)\\omega_1 - \\varepsilon_{0} - b = t\n$$\n$$\n(1-a)\\omega_1 = \\varepsilon_{0} + t + b\n$$\n$$\n\\omega_1 = \\frac{\\varepsilon_{0} + t + b}{1-a}\n$$\n\n情况 2：$Z(\\omega) = -t$\n$$\n(1-a)\\omega_2 - \\varepsilon_{0} - b = -t\n$$\n$$\n(1-a)\\omega_2 = \\varepsilon_{0} - t + b\n$$\n$$\n\\omega_2 = \\frac{\\varepsilon_{0} - t + b}{1-a}\n$$\n这两个表达式给出了准粒子能量的通解。现在我们代入给定的数值：$\\varepsilon_{0}=0.50~\\text{eV}$，$t=0.20~\\text{eV}$，$a=0.10$ 和 $b=-0.05~\\text{eV}$。\n\n对于能量较高的根，我们将其与 $\\omega_1$ 关联：\n$$\n\\omega_1 = \\frac{0.50~\\text{eV} + 0.20~\\text{eV} + (-0.05~\\text{eV})}{1 - 0.10} = \\frac{0.65~\\text{eV}}{0.90} = \\frac{13}{18}~\\text{eV}\n$$\n对于能量较低的根，我们将其与 $\\omega_2$ 关联：\n$$\n\\omega_2 = \\frac{0.50~\\text{eV} - 0.20~\\text{eV} + (-0.05~\\text{eV})}{1 - 0.10} = \\frac{0.25~\\text{eV}}{0.90} = \\frac{5}{18}~\\text{eV}\n$$\n最后，我们计算数值，并按要求四舍五入到四位有效数字。\n$$\n\\omega_1 = \\frac{13}{18}~\\text{eV} \\approx 0.72222...~\\text{eV}\n$$\n$$\n\\omega_2 = \\frac{5}{18}~\\text{eV} \\approx 0.27777...~\\text{eV}\n$$\n四舍五入到四位有效数字得到：\n$$\n\\omega_1 \\approx 0.7222~\\text{eV}\n$$\n$$\n\\omega_2 \\approx 0.2778~\\text{eV}\n$$\n这就是该系统的两个准粒子能量。", "answer": "$$\n\\boxed{0.2778~\\text{eV}, 0.7222~\\text{eV}}\n$$", "id": "2456246"}, {"introduction": "在掌握了基本的计算方法后，下一个关键步骤是建立物理直觉。这个练习将引导你从抽象的数学符号走向具体的物理图像。通过分析当一个分子靠近金属表面时其格林函数极点的变化，你将探索一个复数自能 $\\Sigma^r(\\omega)$ 如何描述真实的物理过程 [@problem_id:2456214]。这项实践将揭示自能的实部和虚部如何分别对应能级移动和有限寿命，从而将一个稳定的分子轨道转变为一个具有能量展宽的共振态，这是理解开放量子系统和量子输运现象的基石。", "problem": "考虑一个孤立分子，在单粒子图像中，它由一个能量为 $\\,\\varepsilon_{0}\\,$ 的单轨道描述。其推迟格林函数 (RGF) $\\,G^{r}_{0}(\\omega)\\,$ 定义为时域推迟格林函数 $\\,G^{r}_{0}(t)=-i\\,\\theta(t)\\langle\\{c(t),c^{\\dagger}(0)\\}\\rangle\\,$ 的傅里叶变换，对于单个孤立能级，其标准形式为 $\\,G^{r}_{0}(\\omega)=\\big[\\omega-\\varepsilon_{0}+i\\,0^{+}\\big]^{-1}\\,$。现在将一个金属表面靠近该分子。与金属的耦合通过一个推迟自能 (SE) $\\,\\Sigma^{r}(\\omega)=\\Delta(\\omega)-i\\,\\Gamma(\\omega)/2\\,$ 来建模，其中 $\\,\\Delta(\\omega)\\,$ 和 $\\,\\Gamma(\\omega)\\ge 0\\,$ 是频率 $\\,\\omega\\,$ 的实值函数。那么，缀饰的分子推迟格林函数为\n$$\nG^{r}(\\omega)=\\Big[\\omega-\\varepsilon_{0}-\\Sigma^{r}(\\omega)\\Big]^{-1}.\n$$\n在复 $\\,\\omega\\,$ 平面中，当分子-金属耦合开启时，与分子能级相关的 $\\,G^{r}(\\omega)\\,$ 的极点会发生什么变化？\n\n选择唯一的最佳描述。\n\nA. 每个分立的极点通过获得一个负的虚部 $-\\Gamma/2$ 和一个实的位移 $\\,\\Delta\\,$，从实轴移动到复 $\\,\\omega\\,$ 平面的下半平面，产生一个具有有限寿命和宽度为 $\\,\\Gamma\\,$ 的洛伦兹展宽的共振。\n\nB. 极点严格地保持在实轴上，但其留数变为复数；观察到的展宽完全源于复数留数，而非极点位置的任何虚部。\n\nC. 每个分立的极点移动到复 $\\,\\omega\\,$ 平面的上半平面，反映了推迟响应在时间上的衰减。\n\nD. 与金属的耦合将单个分子极点分裂成两个关于 $\\,\\varepsilon_{0}\\,$ 对称的、不同的实极点，正如与连续谱的能级排斥所预期的那样。\n\nE. 金属连续谱的存在将分立的分子极点替换为实轴上的一个本性奇点，从而消除了 $\\,G^{r}(\\omega)\\,$ 中任何明确的共振特征。", "solution": "首先必须验证问题陈述的科学合理性和逻辑一致性。\n\n**步骤 1：提取已知条件**\n- 一个孤立分子有一个能量为 $\\varepsilon_{0}$ 的单轨道。\n- 孤立分子的推迟格林函数 (RGF) 是 $G^{r}_{0}(\\omega)=\\big[\\omega-\\varepsilon_{0}+i\\,0^{+}\\big]^{-1}$。\n- 时域 RGF 的定义为 $G^{r}_{0}(t)=-i\\,\\theta(t)\\langle\\{c(t),c^{\\dagger}(0)\\}\\rangle$。\n- 分子与金属表面耦合。\n- 该耦合由一个推迟自能 (SE) $\\Sigma^{r}(\\omega)=\\Delta(\\omega)-i\\,\\Gamma(\\omega)/2$ 描述。\n- $\\Delta(\\omega)$ 和 $\\Gamma(\\omega)$ 是频率 $\\omega$ 的实值函数。\n- 给出了一个物理约束：$\\Gamma(\\omega)\\ge 0$。\n- 缀饰的分子 RGF 由戴森方程给出：$G^{r}(\\omega)=\\Big[\\omega-\\varepsilon_{0}-\\Sigma^{r}(\\omega)\\Big]^{-1}$。\n- 问题是描述引入耦合后 $G^{r}(\\omega)$ 的极点会发生什么变化。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学基础**：该问题很好地植根于量子力学和多体理论的原理，特别是使用了格林函数形式。该模型描述了一个共振能级（或 Newns-Anderson 模型），这是理解化学吸附和量子输运的基石。裸格林函数、自能和戴森方程的形式都是标准的。\n- **适定性**：该问题是适定的。它要求找出给定函数 $G^{r}(\\omega)$ 的极点位置，这是一个数学上精确的问题。\n- **客观性与一致性**：术语是标准且客观的。所提供的信息是自洽的。约束条件 $\\Gamma(\\omega) \\ge 0$ 在物理上是正确的，因为它确保了分子态中的粒子数只能衰变到金属库中，从而维护了因果律。负的 $\\Gamma$ 将意味着非物理的放大。\n\n**步骤 3：结论与行动**\n问题陈述是有效的。这是凝聚态物理和计算化学中的一个标准的、适定的问题。我将继续进行推导和求解。\n\n**推导**\n\n缀饰格林函数 $G^{r}(\\omega)$ 的极点是使其逆为零的复数值 $\\omega$。从 $G^{r}(\\omega)$ 的表达式开始：\n$$\nG^{r}(\\omega)=\\Big[\\omega-\\varepsilon_{0}-\\Sigma^{r}(\\omega)\\Big]^{-1}\n$$\n我们代入给定的自能形式 $\\Sigma^{r}(\\omega)=\\Delta(\\omega)-i\\,\\Gamma(\\omega)/2$：\n$$\nG^{r}(\\omega)=\\Big[\\omega-\\varepsilon_{0}-\\left(\\Delta(\\omega)-i\\frac{\\Gamma(\\omega)}{2}\\right)\\Big]^{-1}\n$$\n整理分母得到：\n$$\nG^{r}(\\omega)=\\Big[\\omega - \\left(\\varepsilon_{0} + \\Delta(\\omega)\\right) + i\\frac{\\Gamma(\\omega)}{2}\\Big]^{-1}\n$$\n极点（我们用 $\\tilde{\\omega}_{p}$ 表示）是复方程的根：\n$$\n\\tilde{\\omega}_{p} - \\left(\\varepsilon_{0} + \\Delta(\\tilde{\\omega}_{p})\\right) + i\\frac{\\Gamma(\\tilde{\\omega}_{p})}{2} = 0\n$$\n在没有耦合的情况下，$\\Delta(\\omega)=0$ 且 $\\Gamma(\\omega)=0$。裸格林函数 $G^{r}_{0}(\\omega)=\\big[\\omega-\\varepsilon_{0}+i\\,0^{+}\\big]^{-1}$ 的极点位于 $\\omega_{p} = \\varepsilon_{0} - i\\,0^{+}$，这实际上是在能量为 $\\varepsilon_{0}$ 的实轴上（无穷小的虚部是为了保证因果律的数学手段）。\n\n当耦合开启时，函数 $\\Delta(\\omega)$ 和 $\\Gamma(\\omega)$ 变为非零。为了理解一般行为，我们可以分析极点方程。一个常见且具有物理洞察力的简化是宽带近似，即假设金属的态密度是宽泛且无特征的。在此极限下，在共振附近，$\\Delta(\\omega)$ 和 $\\Gamma(\\omega)$ 可以被视为常数 $\\Delta$ 和 $\\Gamma$。极点方程于是简化为：\n$$\n\\tilde{\\omega}_{p} - (\\varepsilon_{0} + \\Delta) + i\\frac{\\Gamma}{2} = 0\n$$\n求解极点位置 $\\tilde{\\omega}_{p}$：\n$$\n\\tilde{\\omega}_{p} = (\\varepsilon_{0} + \\Delta) - i\\frac{\\Gamma}{2}\n$$\n从这个结果中，我们可以推断出以下几点：\n1. 极点的实部从其原始值 $\\varepsilon_{0}$ 移动到一个新值 $\\tilde{\\varepsilon}_{0} = \\varepsilon_{0} + \\Delta$。量 $\\Delta$ 代表了由于与金属表面相互作用而引起的能级位移。\n2. 极点获得一个有限的负虚部，$\\text{Im}(\\tilde{\\omega}_{p}) = -\\Gamma/2$。由于已知 $\\Gamma(\\omega) \\ge 0$，该虚部是非正的。对于任何有限耦合，$\\Gamma0$，极点会离开实轴进入复 $\\omega$ 平面的下半平面。\n\n复数极点的物理意义是具有有限寿命的准粒子态。位于 $\\tilde{\\omega}_{p} = \\text{Re}(\\tilde{\\omega}_{p}) + i\\,\\text{Im}(\\tilde{\\omega}_{p})$ 的极点对应于态振幅的时间演化，其正比于 $e^{-i\\tilde{\\omega}_{p}t} = e^{-i\\text{Re}(\\tilde{\\omega}_{p})t} e^{\\text{Im}(\\tilde{\\omega}_{p})t}$。概率密度正比于 $|e^{-i\\tilde{\\omega}_{p}t}|^2 = e^{2\\,\\text{Im}(\\tilde{\\omega}_{p})t}$。对于衰变，指数必须为负，因此 $\\text{Im}(\\tilde{\\omega}_{p})  0$。我们的结果 $\\text{Im}(\\tilde{\\omega}_{p}) = -\\Gamma/2$ 与衰变态一致。该态的寿命 $\\tau$ 由 $\\tau = \\hbar/(-2\\text{Im}(\\tilde{\\omega}_p)) = \\hbar/\\Gamma$ 给出。\n\n此外，谱函数 $A(\\omega) = -\\frac{1}{\\pi}\\text{Im}[G^{r}(\\omega)]$ 呈现洛伦兹分布的形式：\n$$\nA(\\omega) = -\\frac{1}{\\pi}\\text{Im}\\left[\\frac{1}{\\omega - (\\varepsilon_{0}+\\Delta) + i\\Gamma/2}\\right] = \\frac{1}{\\pi}\\frac{\\Gamma/2}{(\\omega - (\\varepsilon_{0}+\\Delta))^2 + (\\Gamma/2)^2}\n$$\n这描述了一个以位移后的能量 $\\tilde{\\varepsilon}_{0} = \\varepsilon_{0}+\\Delta$ 为中心、半峰全宽 (FWHM) 等于 $\\Gamma$ 的共振。因此，孤立分子的尖锐的、类似 delta 函数的谱密度被展宽成一个洛伦兹共振。\n\n**逐项分析**\n\n- **A. 每个分立的极点通过获得一个负的虚部 $-\\Gamma/2$ 和一个实的位移 $\\,\\Delta\\,$，从实轴移动到复 $\\,\\omega\\,$ 平面的下半平面，产生一个具有有限寿命和宽度为 $\\,\\Gamma\\,$ 的洛伦兹展宽的共振。**\n该陈述与我们的推导完全一致。极点移动到 $\\tilde{\\omega}_{p} = (\\varepsilon_{0} + \\Delta) - i\\,\\Gamma/2$。这位于下半平面。虚部是 $-\\Gamma/2$，实位移是 $\\Delta$。这个复极点对应于一个具有有限寿命和宽度为 $\\Gamma$ 的洛伦兹谱函数的共振。\n**结论：正确。**\n\n- **B. 极点严格地保持在实轴上，但其留数变为复数；观察到的展宽完全源于复数留数，而非极点位置的任何虚部。**\n这在根本上是错误的。只要 $\\Gamma \\neq 0$，极点就会离开实轴。如果极点保持在实轴上，它将描述一个具有无限寿命的稳定态，这与轨道耦合到可以衰变进去的连续谱的物理情况相矛盾。展宽是有限寿命的直接结果，这在数学上由极点的非零虚部表示。\n**结论：错误。**\n\n- **C. 每个分立的极点移动到复 $\\,\\omega\\,$ 平面的上半平面，反映了推迟响应在时间上的衰减。**\n这是错误的。复 $\\omega$ 平面上半平面（$\\text{Im}(\\omega)0$）中的极点对应于一个在时间上指数增长（$e^{+\\gamma t}$）的不稳定状态，这对于一个无源系统违反了因果律和能量守恒。推迟格林函数的极点必须位于下半平面以描述物理衰变过程。\n**结论：错误。**\n\n- **D. 与金属的耦合将单个分子极点分裂成两个关于 $\\,\\varepsilon_{0}\\,$ 对称的、不同的实极点，正如与连续谱的能级排斥所预期的那样。**\n这描述的是两个分立态之间的相互作用，这会导致能量为实的成键和反键轨道。将单个分立态耦合到连续谱并不会引起这种分裂。相反，它会将单个能级展宽成一个共振，将其极点移动到复平面中。\n**结论：错误。**\n\n- **E. 金属连续谱的存在将分立的分子极点替换为实轴上的一个本性奇点，从而消除了 $\\,G^{r}(\\omega)\\,$ 中任何明确的共振特征。**\n这在两方面是错误的。首先，$G^{r}(\\omega)$ 的极点是单极点，而不是本性奇点。其次，耦合并不会消除明确的特征；它将 delta 函数特征转变为洛伦兹共振，这仍然是一个明确的特征，尽管被展宽了。\n**结论：错误。**", "answer": "$$\\boxed{A}$$", "id": "2456214"}, {"introduction": "最后的练习旨在将理论知识与计算实践融为一体。在这个任务中，你需要编写代码来数值求解一个自洽的戴森方程。通过一个自洽玻恩近似模型 $\\Sigma(\\omega) = U^2 G(\\omega)$，你将实现一个迭代过程，这正是许多高级计算方法的核心思想 [@problem_id:2456254]。这个练习不仅能加深你对戴森方程和自能的理解，更重要的是，它将理论方程转化为可执行的计算程序，为你搭建起从理论物理到计算化学的桥梁。", "problem": "考虑一个由实对称单电子哈密顿矩阵 $H_0$（单位为电子伏特，$\\mathrm{eV}$）描述的有限、无相互作用的参考态。对于实频率 $\\omega$（单位为 $\\mathrm{eV}$）和正无穷小展宽 $\\eta$（单位为 $\\mathrm{eV}$），无相互作用分解格林函数定义为\n$$\nG_0(\\omega) \\equiv \\left[(\\omega + i\\,\\eta) I - H_0 \\right]^{-1}.\n$$\n相互作用格林函数由矩阵戴森方程定义\n$$\nG(\\omega) \\equiv \\left[G_0(\\omega)^{-1} - \\Sigma(\\omega) \\right]^{-1},\n$$\n其中模型自能由自洽的类玻恩拟设给出\n$$\n\\Sigma(\\omega) \\equiv U^2\\, G(\\omega),\n$$\n此处 $U$（单位为 $\\mathrm{eV}$）是一个实标量相互作用参数。对于给定的 $\\omega$、$\\eta$、$H_0$ 和 $U$，任务是计算一个矩阵 $G(\\omega)$，使其在指定的残差容差范围内满足上述戴森方程和自能定义。定义残差矩阵\n$$\nR(G;\\omega) \\equiv G(\\omega)^{-1} - G_0(\\omega)^{-1} + U^2\\, G(\\omega),\n$$\n并要求解满足弗罗贝尼乌斯范数\n$$\n\\|R(G;\\omega)\\|_F \\le \\tau,\n$$\n其中 $\\tau$（单位为 $\\mathrm{eV}$）是给定的容差。频率 $\\omega$ 处的谱密度则定义为\n$$\nA(\\omega) \\equiv -\\frac{1}{\\pi}\\,\\mathrm{Im}\\,\\mathrm{Tr}\\, G(\\omega),\n$$\n其单位为 $\\mathrm{eV}^{-1}$。\n\n你必须编写一个完整的程序，对下方的每个测试用例，计算满足残差标准的矩阵 $G(\\omega)$，并输出相应的标量 $A(\\omega)$，单位为 $\\mathrm{eV}^{-1}$。每个报告值必须四舍五入到小数点后 $6$ 位。\n\n测试套件（所有能量单位均为 $\\mathrm{eV}$；容差单位均为 $\\mathrm{eV}$）：\n- 案例 $1$：$H_0 = \\mathrm{diag}([\\,0.0,\\,0.0\\,])$, $\\omega = 0.0$, $\\eta = 0.1$, $U = 0.0$, $\\tau = 1.0\\times 10^{-12}$。\n- 案例 $2$：$H_0 = \\mathrm{diag}([\\,0.0,\\,0.0\\,])$, $\\omega = 0.0$, $\\eta = 0.1$, $U = 0.5$, $\\tau = 1.0\\times 10^{-12}$。\n- 案例 $3$：$H_0 = \\mathrm{diag}([\\,0.15,\\,0.15,\\,0.15\\,])$, $\\omega = 0.15$, $\\eta = 0.05$, $U = 0.3$, $\\tau = 1.0\\times 10^{-12}$。\n- 案例 $4$：$H_0 = \\mathrm{diag}([\\,0.3,\\,0.3\\,])$, $\\omega = 0.3$, $\\eta = 0.2$, $U = 1.0$, $\\tau = 1.0\\times 10^{-12}$。\n\n最终输出格式：\n你的程序应产生单行输出，包含四个结果，以逗号分隔并用方括号括起来，每个条目四舍五入到小数点后 $6$ 位，单位为 $\\mathrm{eV}^{-1}$（例如, $[x_1,x_2,x_3,x_4]$）。", "solution": "该问题陈述已经过严格验证，并被确定为有效。它在科学上合理，数学上适定，并为计算化学中的一个可解问题提供了一个完整且明确的规范。该问题是格林函数方法的标准应用，具体来说是在玻恩近似下对戴森方程进行自洽求解。\n\n核心任务是为一个由相互作用格林函数 $G(\\omega)$ 描述的系统计算谱密度 $A(\\omega)$。这需要找到满足自洽条件的矩阵 $G(\\omega)$。该条件源于将自能的拟设 $\\Sigma(\\omega) = U^2 G(\\omega)$ 代入戴森方程 $G(\\omega) = [G_0(\\omega)^{-1} - \\Sigma(\\omega)]^{-1}$。\n\n将 $\\Sigma(\\omega)$ 代入戴森方程的逆 $G(\\omega)^{-1} = G_0(\\omega)^{-1} - \\Sigma(\\omega)$，我们得到需要为 $G(\\omega)$ 求解的基本非线性矩阵方程：\n$$\nG(\\omega)^{-1} = G_0(\\omega)^{-1} - U^2 G(\\omega)\n$$\n这个方程可以重排为矩阵二次方程的形式：\n$$\nU^2 G(\\omega)^2 - G_0(\\omega)^{-1} G(\\omega) + I = 0\n$$\n其中 $I$ 是单位矩阵。问题将无相互作用格林函数定义为 $G_0(\\omega) = [(\\omega + i\\eta)I - H_0]^{-1}$。因此其逆为 $G_0(\\omega)^{-1} = (\\omega + i\\eta)I - H_0$。\n\n一个关键的简化来自于哈密顿量 $H_0$ 的结构。对于所有指定的测试用例，$H_0$ 都是一个对角矩阵，$H_0 = \\mathrm{diag}(\\epsilon_1, \\epsilon_2, \\ldots, \\epsilon_N)$，其中 $\\epsilon_j$ 是无相互作用能级。因此，无相互作用格林函数的逆 $G_0(\\omega)^{-1}$ 也是对角的：\n$$\nG_0(\\omega)^{-1} = \\mathrm{diag}((\\omega + i\\eta) - \\epsilon_1, (\\omega + i\\eta) - \\epsilon_2, \\ldots, (\\omega + i\\eta) - \\epsilon_N)\n$$\n自洽方程只涉及对角矩阵（来自 $G_0(\\omega)^{-1}$）和 $G(\\omega)$ 的标量倍。这种结构意味着如果解 $G(\\omega)$ 是对角的，它将满足该方程。从一个对角猜测（例如 $G^{(0)}(\\omega) = G_0(\\omega)$）开始的自洽迭代，在每一步都保持这种对角结构。因此我们可以假定解 $G(\\omega)$ 是一个对角矩阵，$G(\\omega) = \\mathrm{diag}(g_{11}, g_{22}, \\ldots, g_{NN})$。\n\n在这个拟设下，非线性矩阵方程解耦为 $N$ 个独立的标量二次方程，每个对角元 $g_{jj}(\\omega)$ 对应一个：\n$$\ng_{jj}(\\omega)^{-1} = ((\\omega + i\\eta) - \\epsilon_j) - U^2 g_{jj}(\\omega)\n$$\n整理后得到：\n$$\nU^2 g_{jj}(\\omega)^2 - ((\\omega + i\\eta) - \\epsilon_j) g_{jj}(\\omega) + 1 = 0\n$$\n这是一个关于复变量 $g_{jj}(\\omega)$ 的标准二次方程。在 $U \\neq 0$ 的情况下，两个解由二次公式给出：\n$$\ng_{jj}(\\omega) = \\frac{((\\omega + i\\eta) - \\epsilon_j) \\pm \\sqrt{((\\omega + i\\eta) - \\epsilon_j)^2 - 4U^2}}{2U^2}\n$$\n物理上正确的解是通过要求它在 $U \\to 0$ 的极限下简化为无相互作用格林函数 $g_{0,jj}(\\omega) = [(\\omega + i\\eta) - \\epsilon_j]^{-1}$ 来选择的。对平方根项在小 $U$ 的情况下进行泰勒展开，表明必须选择负号。因此，唯一的物理可行解是：\n$$\ng_{jj}(\\omega) = \\frac{((\\omega + i\\eta) - \\epsilon_j) - \\sqrt{((\\omega + i\\eta) - \\epsilon_j)^2 - 4U^2}}{2U^2}\n$$\n对于 $U=0$ 的特殊情况，系统是无相互作用的，且 $G(\\omega) = G_0(\\omega)$。在这种情况下，对角元即为：\n$$\ng_{jj}(\\omega) = \\frac{1}{(\\omega + i\\eta) - \\epsilon_j}\n$$\n一旦相互作用格林函数的对角元 $g_{jj}(\\omega)$ 被计算出来，$G(\\omega)$ 的迹是它们的和：\n$$\n\\mathrm{Tr}\\,G(\\omega) = \\sum_{j=1}^{N} g_{jj}(\\omega)\n$$\n最后，谱密度根据其定义计算：\n$$\nA(\\omega) = -\\frac{1}{\\pi}\\,\\mathrm{Im}\\,\\mathrm{Tr}\\,G(\\omega) = -\\frac{1}{\\pi}\\,\\mathrm{Im}\\left[\\sum_{j=1}^{N} g_{jj}(\\omega)\\right]\n$$\n每个测试用例的算法如下：\n$1$. 提取参数：$H_0$ 的对角元 $\\epsilon_j$、频率 $\\omega$、展宽 $\\eta$ 和相互作用强度 $U$。\n$2$. 对于每个对角元 $g_{jj}(\\omega)$，根据 $U$ 是否为零使用相应的解析公式。注意，在所提供的测试用例中，对于给定的案例，所有的 $\\epsilon_j$ 都是简并的，这意味着所有的 $g_{jj}(\\omega)$都将是相同的。\n$3$. 将计算出的 $g_{jj}(\\omega)$求和以得到 $\\mathrm{Tr}\\,G(\\omega)$。\n$4$. 使用上述公式计算 $A(\\omega)$。然后将结果四舍五入到所需精度。此解析解能精确地满足残差容差 $\\tau$（在机器精度范围内）。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the spectral density A(omega) for a series of test cases\n    based on a self-consistent Born approximation for the Green's function.\n    \"\"\"\n\n    test_cases = [\n        # Case 1: H0 = diag([0.0, 0.0]), omega = 0.0, eta = 0.1, U = 0.0, tau = 1.0e-12\n        {'H0_diag': np.array([0.0, 0.0]), 'omega': 0.0, 'eta': 0.1, 'U': 0.0},\n        # Case 2: H0 = diag([0.0, 0.0]), omega = 0.0, eta = 0.1, U = 0.5, tau = 1.0e-12\n        {'H0_diag': np.array([0.0, 0.0]), 'omega': 0.0, 'eta': 0.1, 'U': 0.5},\n        # Case 3: H0 = diag([0.15, 0.15, 0.15]), omega = 0.15, eta = 0.05, U = 0.3, tau = 1.0e-12\n        {'H0_diag': np.array([0.15, 0.15, 0.15]), 'omega': 0.15, 'eta': 0.05, 'U': 0.3},\n        # Case 4: H0 = diag([0.3, 0.3]), omega = 0.3, eta = 0.2, U = 1.0, tau = 1.0e-12\n        {'H0_diag': np.array([0.3, 0.3]), 'omega': 0.3, 'eta': 0.2, 'U': 1.0},\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        H0_diag = case['H0_diag']\n        omega = case['omega']\n        eta = case['eta']\n        U = case['U']\n        \n        N = len(H0_diag)\n        z = complex(omega, eta)\n        \n        # Since H0 is degenerate in all test cases, we can compute g_jj once.\n        eps = H0_diag[0]\n        \n        if U == 0.0:\n            # Non-interacting case: G = G0\n            g_jj = 1.0 / (z - eps)\n        else:\n            # Interacting case: solve quadratic equation for g_jj\n            # U^2 * g_jj^2 - (z - eps) * g_jj + 1 = 0\n            # The physical root is chosen to recover the non-interacting limit.\n            z_minus_eps = z - eps\n            U2 = U**2\n            discriminant = np.sqrt(z_minus_eps**2 - 4.0 * U2)\n            g_jj = (z_minus_eps - discriminant) / (2.0 * U2)\n\n        # The trace is N * g_jj due to degeneracy.\n        trace_G = N * g_jj\n        \n        # Calculate the spectral density A(omega)\n        # A(omega) = -1/pi * Im[Tr(G(omega))]\n        spectral_density = -1.0 / np.pi * trace_G.imag\n        \n        results.append(spectral_density)\n\n    # Format the final output as a comma-separated list of strings,\n    # with each value rounded to 6 decimal places.\n    output_str = f\"[{','.join([f'{r:.6f}' for r in results])}]\"\n    print(output_str)\n\nsolve()\n```", "id": "2456254"}]}