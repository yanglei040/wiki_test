{"hands_on_practices": [{"introduction": "掌握平面波计算的第一步是理解如何为一个简单的完美晶体获得收敛的结果。本练习侧重于任何平面波计算中两个最关键的收敛参数：动能截断 ($E_{\\text{cut}}$) 和k点网格密度。通过计算一个模型硅晶体的带隙，并观察它如何随这些参数变化，您将对所有固态模拟中都至关重要的收敛过程获得实用而直观的理解。[@problem_id:2460283]", "problem": "要求您研究晶体硅的间接带隙相对于平面波动能截断和晶体动量采样网格密度的收敛性。为了在保持平面波基和布拉格散射的关键物理特性的同时确保计算易行性，请使用一个简化的三维近自由电子模型。该模型在简单立方布拉维晶格上施加余弦周期性势，通过布里渊区边界处的耦合来捕捉间接带隙。任务是实现一个完整的程序，在每个晶体动量点上构建平面波基下的单电子哈密顿量，对其进行对角化以获得最低的两个能带，并通过在所有采样的晶体动量点上计算第二能带的最小值与第一能带的最大值之差来估算间接带隙。所有能量必须以电子伏特为单位报告，所有长度必须以埃为单位报告。\n\n定义与模型：\n- 设晶格常数为 $a = 5.43\\,\\text{\\AA}$。倒易晶格原胞基矢为 $\\mathbf{b}_1 = \\frac{2\\pi}{a}\\hat{\\mathbf{x}}$，$\\mathbf{b}_2 = \\frac{2\\pi}{a}\\hat{\\mathbf{y}}$ 和 $\\mathbf{b}_3 = \\frac{2\\pi}{a}\\hat{\\mathbf{z}}$。第一布里渊区是立方体 $k_i \\in [-\\pi/a,\\pi/a)$，其中 $i \\in \\{x,y,z\\}$。\n- 电子动能为 $T(\\mathbf{q}) = \\frac{\\hbar^2 |\\mathbf{q}|^2}{2 m_e}$，其中 $\\frac{\\hbar^2}{2m_e} = 3.8099819442818976\\,\\text{eV}\\cdot\\text{\\AA}^2$。\n- 周期性势为 $V(\\mathbf{r}) = 2 V_c \\left[\\cos\\left(\\mathbf{b}_1 \\cdot \\mathbf{r}\\right) + \\cos\\left(\\mathbf{b}_2 \\cdot \\mathbf{r}\\right) + \\cos\\left(\\mathbf{b}_3 \\cdot \\mathbf{r}\\right)\\right]$，其傅里叶系数为 $V_{\\pm \\mathbf{b}_1} = V_{\\pm \\mathbf{b}_2} = V_{\\pm \\mathbf{b}_3} = V_c$，且所有其他傅里叶系数为零。使用 $V_c = -1.25\\,\\text{eV}$。$V(\\mathbf{r})$ 的单胞平均值为零。\n- 对于每个晶体动量 $\\mathbf{k}$，平面波基由一组态构成，这些态由整数三元组 $\\mathbf{n} = (n_x,n_y,n_z)$ 索引，其波矢 $\\mathbf{q}_{\\mathbf{n}}(\\mathbf{k}) = \\mathbf{k} + n_x \\mathbf{b}_1 + n_y \\mathbf{b}_2 + n_z \\mathbf{b}_3$ 满足动能截断条件 $T\\left(\\mathbf{q}_{\\mathbf{n}}(\\mathbf{k})\\right) \\le E_{\\text{cut}}$，其中 $E_{\\text{cut}}$ 是一个以电子伏特为单位的正参数。在此基下的哈密顿量矩阵元为\n$$\nH_{\\mathbf{n},\\mathbf{m}}(\\mathbf{k}) =\n\\begin{cases}\nT\\left(\\mathbf{q}_{\\mathbf{n}}(\\mathbf{k})\\right),  \\text{if } \\mathbf{n} = \\mathbf{m},\\\\\nV_c,  \\text{if } \\mathbf{n} - \\mathbf{m} \\in \\{\\pm(1,0,0), \\pm(0,1,0), \\pm(0,0,1)\\},\\\\\n0,  \\text{otherwise.}\n\\end{cases}\n$$\n\n晶体动量采样：\n- 对于一个整数 $N_k \\ge 1$，在第一布里渊区上以每个笛卡尔方向 $N_k$ 个点的均匀网格进行采样，采样点位于\n$$\nk_i(j) = -\\frac{\\pi}{a} + \\frac{2\\pi}{a}\\,\\frac{j}{N_k}, \\quad j \\in \\{0,1,\\dots,N_k-1\\}, \\quad i \\in \\{x,y,z\\}。\n$$\n这会产生 $N_k^3$ 个 $\\mathbf{k}$ 点需要评估。对于每一个这样的 $\\mathbf{k}$，使用由截断定义的基来构建 $H(\\mathbf{k})$。\n\n能带边和带隙：\n- 对于每个基组至少包含一个平面波的 $\\mathbf{k}$，令 $E_1(\\mathbf{k}) \\le E_2(\\mathbf{k}) \\le \\dots$ 为 $H(\\mathbf{k})$ 的升序排列的本征值。在至少存在一个本征值的 $\\mathbf{k}$ 点集合上，定义价带顶为 $E_v = \\max_{\\mathbf{k}} E_1(\\mathbf{k})$。在至少存在两个本征值的 $\\mathbf{k}$ 点集合上，定义导带底为 $E_c = \\min_{\\mathbf{k}} E_2(\\mathbf{k})$。估算的间接带隙为 $E_g = E_c - E_v$（单位为电子伏特）。如果没有 $\\mathbf{k}$ 点具有至少两个本征值，则 $E_g$ 是未定义的。\n\n测试组：\n计算以下参数对 $(E_{\\text{cut}}, N_k)$ 的 $E_g$（单位为电子伏特）：\n- 情况 1：$(6.0, 1)$。\n- 情况 2：$(6.0, 4)$。\n- 情况 3：$(8.0, 4)$。\n- 情况 4：$(12.0, 10)$。\n- 情况 5：$(20.0, 12)$。\n\n输出要求：\n- 您的程序必须产生单行输出，其中包含五个结果，格式为方括号内以逗号分隔的列表，例如 $[x_1,x_2,x_3,x_4,x_5]$，每个 $x_i$ 是对应情况下的 $E_g$ 的浮点值，四舍五入到6位小数。如果由于基组尺寸不足导致某个 $E_g$ 未定义，则针对该情况输出编程语言给出的非数值（not-a-number）的字符串表示，但不要更改列表的格式。", "solution": "问题陈述已经过严格验证，被认为是有效的。它在科学上是合理的，提法恰当，客观，并包含了得出唯一且可验证解所需的所有信息。它代表了计算凝聚态物理中一个标准的、尽管是简化了的问题，适合用来说明使用平面波基组计算电子能带结构的原理。我们现在开始解答。\n\n基本任务是求解周期性势中单电子的不含时薛定谔方程 $\\hat{H}\\psi(\\mathbf{r}) = E\\psi(\\mathbf{r})$，其中哈密顿量为 $\\hat{H} = \\hat{T} + \\hat{V} = -\\frac{\\hbar^2}{2m_e}\\nabla^2 + V(\\mathbf{r})$。对于任意正格矢 $\\mathbf{R}$，势的周期性 $V(\\mathbf{r}) = V(\\mathbf{r}+\\mathbf{R})$ 决定了本征态具有特定的结构。根据布洛赫定理，解可以写成 $\\psi_{\\mathbf{k}}(\\mathbf{r}) = e^{i\\mathbf{k}\\cdot\\mathbf{r}}u_{\\mathbf{k}}(\\mathbf{r})$ 的形式，其中 $\\mathbf{k}$ 是第一布里渊区中的晶体动量矢量，而 $u_{\\mathbf{k}}(\\mathbf{r})$ 是一个晶胞周期函数，满足 $u_{\\mathbf{k}}(\\mathbf{r}) = u_{\\mathbf{k}}(\\mathbf{r}+\\mathbf{R})$。\n\n鉴于 $u_{\\mathbf{k}}(\\mathbf{r})$ 是周期性的，它可以展开为关于倒格矢 $\\mathbf{G}$ 的傅里叶级数：$u_{\\mathbf{k}}(\\mathbf{r}) = \\sum_{\\mathbf{G}} c_{\\mathbf{k}}(\\mathbf{G}) e^{i\\mathbf{G}\\cdot\\mathbf{r}}$。将此代入波函数的布洛赫形式，得到平面波展开式：\n$$\n\\psi_{\\mathbf{k}}(\\mathbf{r}) = \\sum_{\\mathbf{G}} c_{\\mathbf{k}}(\\mathbf{G}) e^{i(\\mathbf{k}+\\mathbf{G})\\cdot\\mathbf{r}}\n$$\n将此展开式代入薛定谔方程，对于每个 $\\mathbf{k}$，方程都转化为一个关于系数 $c_{\\mathbf{k}}(\\mathbf{G})$ 的无限维矩阵本征值问题。在此平面波基 $|\\mathbf{k}+\\mathbf{G}\\rangle$ 下的哈密顿量矩阵元由 $H_{\\mathbf{G},\\mathbf{G}'}(\\mathbf{k}) = \\langle \\mathbf{k}+\\mathbf{G} | \\hat{H} | \\mathbf{k}+\\mathbf{G}' \\rangle$ 给出。\n\n动能算符 $\\hat{T}$ 在此基下是对角的：\n$$\n\\langle \\mathbf{k}+\\mathbf{G} | \\hat{T} | \\mathbf{k}+\\mathbf{G}' \\rangle = \\frac{\\hbar^2 |\\mathbf{k}+\\mathbf{G}|^2}{2m_e} \\delta_{\\mathbf{G},\\mathbf{G}'}\n$$\n势能算符 $\\hat{V}$ 的矩阵元由势的傅里叶系数 $V(\\mathbf{r}) = \\sum_{\\mathbf{G}} V_{\\mathbf{G}} e^{i\\mathbf{G}\\cdot\\mathbf{r}}$ 决定：\n$$\n\\langle \\mathbf{k}+\\mathbf{G} | \\hat{V} | \\mathbf{k}+\\mathbf{G}' \\rangle = V_{\\mathbf{G}-\\mathbf{G}'}\n$$\n结合这两部分，完整的哈密顿量矩阵元为：\n$$\nH_{\\mathbf{G},\\mathbf{G}'}(\\mathbf{k}) = \\frac{\\hbar^2 |\\mathbf{k}+\\mathbf{G}|^2}{2m_e} \\delta_{\\mathbf{G},\\mathbf{G}'} + V_{\\mathbf{G}-\\mathbf{G}'}\n$$\n问题指定了一个晶格常数为 $a = 5.43\\,\\text{\\AA}$ 的简单立方布拉维晶格。其倒易晶格也是简单立方的，基矢为 $\\mathbf{b}_1 = \\frac{2\\pi}{a}\\hat{\\mathbf{x}}$，$\\mathbf{b}_2 = \\frac{2\\pi}{a}\\hat{\\mathbf{y}}$ 和 $\\mathbf{b}_3 = \\frac{2\\pi}{a}\\hat{\\mathbf{z}}$。一个普遍的倒格矢是 $\\mathbf{G}_{\\mathbf{n}} = n_x \\mathbf{b}_1 + n_y \\mathbf{b}_2 + n_z \\mathbf{b}_3$，其中 $\\mathbf{n} = (n_x, n_y, n_z)$ 是一个整数矢量。\n\n周期性势为 $V(\\mathbf{r}) = 2 V_c \\left[\\cos\\left(\\mathbf{b}_1 \\cdot \\mathbf{r}\\right) + \\cos\\left(\\mathbf{b}_2 \\cdot \\mathbf{r}\\right) + \\cos\\left(\\mathbf{b}_3 \\cdot \\mathbf{r}\\right)\\right]$。利用欧拉公式 $\\cos(x) = (e^{ix}+e^{-ix})/2$，我们可以确定其非零傅里叶系数为：对于 $\\mathbf{G} \\in \\{\\pm\\mathbf{b}_1, \\pm\\mathbf{b}_2, \\pm\\mathbf{b}_3\\}$，$V_{\\mathbf{G}} = V_c$；对于所有其他 $\\mathbf{G} \\ne 0$，$V_{\\mathbf{G}} = 0$。平均势 $V_{\\mathbf{G}=0}$ 为零。这意味着势仅将一个平面波 $|\\mathbf{k}+\\mathbf{G}_{\\mathbf{n}}\\rangle$ 与另一个平面波 $|\\mathbf{k}+\\mathbf{G}_{\\mathbf{m}}\\rangle$ 耦合，条件是它们之间的差 $\\mathbf{G}_{\\mathbf{n}}-\\mathbf{G}_{\\mathbf{m}}$ 是六个最短的非零倒格矢之一。这对应于条件 $\\mathbf{n}-\\mathbf{m}$ 是 $\\pm(1,0,0)$、$\\pm(0,1,0)$ 或 $\\pm(0,0,1)$ 之一。\n\n在实际计算中，无限维的基必须被截断。这通过动能截断 $E_{\\text{cut}}$ 来实现。对于每个晶体动量 $\\mathbf{k}$，我们只将动能低于截断值的平面波 $|\\mathbf{k}+\\mathbf{G}_{\\mathbf{n}}\\rangle$ 包含在基组中：\n$$\nT(\\mathbf{k}+\\mathbf{G}_{\\mathbf{n}}) = \\frac{\\hbar^2 |\\mathbf{k}+\\mathbf{G}_{\\mathbf{n}}|^2}{2m_e} \\le E_{\\text{cut}}\n$$\n这会产生一个有限维且依赖于 $\\mathbf{k}$ 的哈密顿矩阵 $H(\\mathbf{k})$，其矩阵元与问题陈述中指定的完全一致。该矩阵的本征值 $E_1(\\mathbf{k}) \\le E_2(\\mathbf{k}) \\le \\dots$ 构成了电子能带结构。\n\n计算算法如下：\n1. 对于每组给定的参数 $(E_{\\text{cut}}, N_k)$，初始化计算。所需的物理常数为 $a = 5.43\\,\\text{\\AA}$，$\\frac{\\hbar^2}{2m_e} = 3.8099819442818976\\,\\text{eV}\\cdot\\text{\\AA}^2$ 和 $V_c = -1.25\\,\\text{eV}$。\n2. 根据规则 $k_i(j) = -\\frac{\\pi}{a} + \\frac{2\\pi}{a}\\,\\frac{j}{N_k}$（其中 $j=0, \\dots, N_k-1$）生成采样第一布里渊区的 $N_k^3$ 个晶体动量矢量 $\\mathbf{k}$ 的均匀网格。\n3. 对于网格中的每个 $\\mathbf{k}$ 矢量：\n    a. 确定满足动能截断条件的有限整数矢量 $\\mathbf{n} = (n_x, n_y, n_z)$ 集合。这通过搜索一个足够大的整数 $\\mathbf{n}$ 立方范围并保留满足 $T(\\mathbf{k}+\\mathbf{G}_{\\mathbf{n}}) \\le E_{\\text{cut}}$ 的那些矢量来完成。\n    b. 如果基组为空，则无法为此 $\\mathbf{k}$ 计算本征值。继续处理下一个 $\\mathbf{k}$。\n    c. 如果基组非空，构建尺寸为 $N_{basis} \\times N_{basis}$ 的哈密顿矩阵 $H(\\mathbf{k})$。对角元为 $H_{\\mathbf{n},\\mathbf{n}}(\\mathbf{k}) = T(\\mathbf{k}+\\mathbf{G}_{\\mathbf{n}})$。如果 $\\mathbf{n}-\\mathbf{m}$ 是六个笛卡尔方向之一的单位矢量，则非对角元 $H_{\\mathbf{n},\\mathbf{m}}(\\mathbf{k})$ 为 $V_c$，否则为 0。\n    d. 得到的矩阵是厄米矩阵。对其进行对角化以求得其实数本征值。本征值按升序排列：$E_1(\\mathbf{k}) \\le E_2(\\mathbf{k}) \\le \\dots \\le E_{N_{basis}}(\\mathbf{k})$。\n    e. 收集第一个本征值 $E_1(\\mathbf{k})$ 以及（如果存在）第二个本征值 $E_2(\\mathbf{k})$。\n4. 遍历所有 $\\mathbf{k}$ 点后，确定价带顶 $E_v = \\max_{\\mathbf{k}} E_1(\\mathbf{k})$，其中最大值是在所有产生至少一个本征值的 $\\mathbf{k}$ 点上取的。\n5. 类似地，确定导带底 $E_c = \\min_{\\mathbf{k}} E_2(\\mathbf{k})$，其中最小值是在所有产生至少两个本征值的 $\\mathbf{k}$ 点上取的。\n6. 如果无法确定 $E_c$（即，没有 $\\mathbf{k}$ 点产生尺寸为2或更大的基组），则带隙 $E_g$ 是未定义的。否则，计算间接带隙为 $E_g = E_c - E_v$。\n7. 对所有五个测试用例重复此过程，并以指定格式报告结果。这一系统化的过程确保了对所述问题得出一个正确且可复现的数值解。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the indirect band gap of a model crystal using a plane-wave basis.\n    \"\"\"\n    # Physical constants and model parameters\n    A_LATTICE = 5.43  # Lattice parameter in Angstroms\n    HBAR_SQ_2ME = 3.8099819442818976  # h-bar^2 / (2*m_e) in eV * Angstrom^2\n    V_C = -1.25  # Potential strength in eV\n\n    # Reciprocal lattice vector magnitude\n    B_SCALAR = 2 * np.pi / A_LATTICE\n\n    # Test cases: (E_cut in eV, N_k)\n    test_cases = [\n        (6.0, 1),\n        (6.0, 4),\n        (8.0, 4),\n        (12.0, 10),\n        (20.0, 12),\n    ]\n\n    results = []\n    for E_cut, N_k in test_cases:\n        e1_all_k = []\n        e2_all_k = []\n\n        # Generate k-point mesh\n        k_coords_1d = -np.pi / A_LATTICE + (2 * np.pi / A_LATTICE) * np.arange(N_k) / N_k\n        kx_grid, ky_grid, kz_grid = np.meshgrid(k_coords_1d, k_coords_1d, k_coords_1d, indexing='ij')\n        k_points = np.stack([kx_grid.ravel(), ky_grid.ravel(), kz_grid.ravel()], axis=-1)\n\n        # Determine search range for integer vectors n = (nx, ny, nz)\n        # Bounding box must account for k-vector shift.\n        # |k_i| = pi/a. We need C * (k_i + n_i*B)^2 = E_cut.\n        # |n_i*B| = sqrt(E_cut/C) + |k_i| = sqrt(E_cut/C) + pi/a\n        # |n_i| = (sqrt(E_cut/C) + pi/a) / B = a/(2pi) * sqrt(E_cut/C) + 1/2\n        n_lim = int(np.ceil((np.sqrt(E_cut / HBAR_SQ_2ME) + np.pi / A_LATTICE) / B_SCALAR))\n        n_range = np.arange(-n_lim, n_lim + 1)\n        nx_v, ny_v, nz_v = np.meshgrid(n_range, n_range, n_range, indexing='ij')\n        n_candidates = np.stack([nx_v.ravel(), ny_v.ravel(), nz_v.ravel()], axis=-1)\n\n        for k_vec in k_points:\n            # Generate basis set for the current k-point\n            G_vectors = n_candidates * B_SCALAR\n            q_vectors = k_vec + G_vectors\n            \n            kinetic_energies = HBAR_SQ_2ME * np.sum(q_vectors**2, axis=-1)\n            \n            basis_indices = np.where(kinetic_energies = E_cut)[0]\n            \n            if basis_indices.size == 0:\n                continue\n            \n            basis_n_vectors = n_candidates[basis_indices]\n            basis_ke = kinetic_energies[basis_indices]\n            N_basis = len(basis_n_vectors)\n            \n            # Construct Hamiltonian\n            H = np.diag(basis_ke)\n            \n            # Map n-vectors to matrix indices for efficient lookup\n            n_to_idx = {tuple(n): i for i, n in enumerate(basis_n_vectors)}\n            \n            # Off-diagonal elements\n            deltas = np.array([[1,0,0], [-1,0,0], [0,1,0], [0,-1,0], [0,0,1], [0,0,-1]])\n            for i, n_i in enumerate(basis_n_vectors):\n                for delta in deltas:\n                    n_j_tuple = tuple(n_i + delta)\n                    if n_j_tuple in n_to_idx:\n                        j = n_to_idx[n_j_tuple]\n                        # Only fill one triangle\n                        if i  j:\n                            H[i, j] = V_C\n                            H[j, i] = V_C\n\n            # Diagonalize and collect eigenvalues\n            if N_basis > 0:\n                # eigvalsh is efficient for Hermitian matrices and returns sorted eigenvalues\n                eigenvalues = np.linalg.eigvalsh(H)\n                e1_all_k.append(eigenvalues[0])\n                if N_basis >= 2:\n                    e2_all_k.append(eigenvalues[1])\n\n        # Calculate band gap for the current (E_cut, N_k) pair\n        if not e2_all_k:\n            Eg = np.nan\n        else:\n            E_v = np.max(e1_all_k)\n            E_c = np.min(e2_all_k)\n            Eg = E_c - E_v\n            \n        results.append(Eg)\n\n    # Format output as specified\n    formatted_results = []\n    for r in results:\n        if np.isnan(r):\n            formatted_results.append(\"nan\")\n        else:\n            formatted_results.append(f\"{r:.6f}\")\n\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2460283"}, {"introduction": "真实的材料很少是完美的。本练习将从理想晶体转向更现实的情景：模拟单个杂质，这是材料科学中的一项常见任务。我们将使用超胞近似方法，其中缺陷被放置在一个大的晶胞中，然后进行周期性重复。此练习将探讨超胞尺寸 ($L=Na$) 如何影响计算的性质，特别是杂质引起的能级移动，这是确保模拟缺陷表现得像孤立缺陷一样所必需的一步。[@problem_id:2460291]", "problem": "考虑一个使用周期性边界条件和平面波基组建模的一维晶体。一个原胞晶体的晶格常数为 $a$，主体势为 $V_{\\text{host}}(x)=V_c \\cos\\left(\\frac{2\\pi x}{a}\\right)$。通过添加一个位于 $x=0$ 中心的局域杂质势 $V_{\\text{imp}}(x)$，在长度为 $L=N a$ 的超胞内对单个替代式杂质进行建模，由于边界条件的存在，该杂质势以周期 $L$ 重复。杂质势由一个振幅为 $A$、宽度为 $\\sigma$ 的高斯函数给出，即 $V_{\\text{imp}}(x) = A \\sum_{m\\in\\mathbb{Z}} \\exp\\!\\left(-\\frac{(x-mL)^2}{\\sigma^2}\\right)$。因此，超胞中的总势为 $V(x)=V_{\\text{host}}(x)+V_{\\text{imp}}(x)$。\n\n在哈特里原子单位（长度单位为玻尔，能量单位为哈特里）中，考虑一个在超胞内受带有周期性边界条件的不含时薛定谔方程支配的单个无相互作用的电子，\n$$\n\\hat{H} \\psi(x) = E \\psi(x), \\quad \\hat{H} = -\\frac{1}{2}\\frac{\\mathrm{d}^2}{\\mathrm{d}x^2} + V(x), \\quad \\psi(x+L)=\\psi(x).\n$$\n将希尔伯特空间限制在伽马点（零晶体动量）的平面波上，并由动能截断 $E_{\\text{cut}}$ 进行截断。即，使用基函数 $\\phi_G(x) = \\frac{1}{\\sqrt{L}} e^{i G x}$，其中倒格矢 $G=\\frac{2\\pi n}{L}$，整数 $n$ 满足 $\\frac{1}{2}G^2 \\le E_{\\text{cut}}$。\n\n对于下面的每一组参数，计算使用总势 $V(x)$ 时 $\\hat{H}$ 的最低本征值 $E_{\\text{defect}}(N,E_{\\text{cut}})$，以及仅使用主体势 $V_{\\text{host}}(x)$ 时（即 $A=0$）$\\hat{H}$ 的最低本征值 $E_{\\text{host}}(N,E_{\\text{cut}})$。报告以哈特里为单位的杂质诱导的能量移动\n$$\n\\Delta E(N,E_{\\text{cut}}) = E_{\\text{defect}}(N,E_{\\text{cut}}) - E_{\\text{host}}(N,E_{\\text{cut}}),\n$$\n研究 $\\Delta E$ 随超胞尺寸 $N$ 的收敛性。\n\n所有量都必须以哈特里原子单位处理，所有报告的能量必须以哈特里为单位表示为十进制浮点数。\n\n使用以下参数值的测试套件，其中每个元组为 $(N,E_{\\text{cut}},a,V_c,A,\\sigma)$：\n\n- 案例 1：$(4, 20.0, 1.0, 0.5, -0.4, 0.15)$\n- 案例 2：$(8, 20.0, 1.0, 0.5, -0.4, 0.15)$\n- 案例 3：$(16, 20.0, 1.0, 0.5, -0.4, 0.15)$\n- 案例 4：$(6, 20.0, 1.0, 0.5, 0.0, 0.15)$\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的、以逗号分隔的结果列表，顺序与上述案例一致。例如，格式必须与 $[\\Delta E_1,\\Delta E_2,\\Delta E_3,\\Delta E_4]$ 完全一样，其中每个 $\\Delta E_i$ 是一个以哈特里为单位的浮点数。不得打印任何其他文本。", "solution": "所提出的问题是计算凝聚态物理中的一个标准练习，具体来说是应用平面波基组来求解含杂质的一维周期性体系的不含时薛定谔方程。该问题具有科学依据、是良定的，并且所有必要的参数都已提供。因此，可以构建一个解决方案。\n\n控制方程是在哈特里原子单位（$\\hbar = 1, m_e = 1, e=1, 4\\pi\\epsilon_0=1$）下的一维单电子薛定谔方程：\n$$\n\\hat{H} \\psi(x) = \\left( -\\frac{1}{2}\\frac{\\mathrm{d}^2}{\\mathrm{d}x^2} + V(x) \\right) \\psi(x) = E \\psi(x)\n$$\n计算在长度为 $L = N a$ 的超胞内进行，施加周期性边界条件 $\\psi(x+L)=\\psi(x)$。总势为 $V(x) = V_{\\text{host}}(x) + V_{\\text{imp}}(x)$。\n\n我们在平面波基组中展开波函数 $\\psi(x)$。由于问题指定在伽马点（晶体动量 $k=0$）进行计算，基函数是超胞的倒易晶格矢量：\n$$\n\\phi_G(x) = \\frac{1}{\\sqrt{L}} e^{i G x}, \\quad \\text{其中} \\quad G = \\frac{2\\pi n}{L} \\quad \\text{对于 } n \\in \\mathbb{Z}\n$$\n展开式为 $\\psi(x) = \\sum_{G} c_G \\phi_G(x)$。这将微分形式的薛定谔方程转换为在平面波系数 $\\{c_G\\}$ 基组下的矩阵本征值问题。哈密顿矩阵元为 $H_{G', G} = \\langle \\phi_{G'} | \\hat{H} | \\phi_G \\rangle$。\n\n希尔伯特空间由动能截断 $E_{\\text{cut}}$ 截断，这将基函数集合限制为动能满足 $\\frac{1}{2}G^2 \\le E_{\\text{cut}}$ 的那些函数。这意味着：\n$$\n\\frac{1}{2} \\left(\\frac{2\\pi n}{L}\\right)^2 \\le E_{\\text{cut}} \\implies |n| \\le \\frac{L}{\\pi}\\sqrt{\\frac{E_{\\text{cut}}}{2}}\n$$\n令 $n_{\\text{max}} = \\lfloor \\frac{L}{\\pi}\\sqrt{\\frac{E_{\\text{cut}}}{2}} \\rfloor$。基组将由整数索引 $n$ 从 $-n_{\\text{max}}$ 到 $n_{\\text{max}}$ 的平面波组成，从而得到大小为 $N_b = 2n_{\\text{max}}+1$ 的基组。\n\n哈密顿矩阵元 $H_{G', G}$ 是动能和势能矩阵元之和：\n$$\nH_{G', G} = \\langle \\phi_{G'} | -\\frac{1}{2}\\frac{\\mathrm{d}^2}{\\mathrm{d}x^2} | \\phi_G \\rangle + \\langle \\phi_{G'} | V(x) | \\phi_G \\rangle\n$$\n\n动能算符在平面波基组中是对角的：\n$$\nT_{G', G} = \\langle \\phi_{G'} | \\frac{1}{2}G^2 | \\phi_G \\rangle = \\frac{1}{2}G^2 \\delta_{G',G}\n$$\n在我们的整数索引网格上，这变为 $T_{n', n} = \\frac{1}{2}\\left(\\frac{2\\pi n}{L}\\right)^2 \\delta_{n',n}$。\n\n势能矩阵元由势的傅里叶变换给出：\n$$\nV_{G', G} = \\frac{1}{L} \\int_0^L e^{-iG'x} V(x) e^{iGx} dx = \\frac{1}{L} \\int_0^L V(x) e^{i(G-G')x} dx = V_{G'-G}\n$$\n其中 $V_{K}$ 是 $V(x)$ 对波矢 $K = G'-G$ 的傅里叶系数。由于总势是一个和，其傅里叶系数是其各部分系数的和：$V_{G'-G} = V_{\\text{host}, G'-G} + V_{\\text{imp}, G'-G}$。\n\n对于主体势 $V_{\\text{host}}(x)=V_c \\cos\\left(\\frac{2\\pi x}{a}\\right) = \\frac{V_c}{2}\\left( e^{i\\frac{2\\pi x}{a}} + e^{-i\\frac{2\\pi x}{a}} \\right)$，其傅里叶系数仅在波矢 $K = \\pm \\frac{2\\pi}{a}$ 时非零。矩阵元 $V_{\\text{host}, G'-G}$ 在 $G'-G = \\pm \\frac{2\\pi}{a}$ 时非零。用整数索引表示：\n$$\n\\frac{2\\pi n'}{L} - \\frac{2\\pi n}{L} = \\pm \\frac{2\\pi}{a} \\implies \\frac{n'-n}{Na} = \\pm \\frac{1}{a} \\implies n'-n = \\pm N\n$$\n因此，如果 $n'-n = \\pm N$，则 $V_{\\text{host}, n', n} = \\frac{V_c}{2}$，否则为 $0$。\n\n对于杂质势 $V_{\\text{imp}}(x) = A \\sum_{m\\in\\mathbb{Z}} \\exp\\!\\left(-\\frac{(x-mL)^2}{\\sigma^2}\\right)$，对波矢 $K$ 的傅里叶系数通过在一个周期内积分得到：\n$$\nV_{\\text{imp}, K} = \\frac{1}{L} \\int_{-\\infty}^{\\infty} A \\exp\\left(-\\frac{x^2}{\\sigma^2}\\right) e^{-iKx} dx = \\frac{A}{L} \\left( \\sigma\\sqrt{\\pi} \\exp\\left(-\\frac{K^2\\sigma^2}{4}\\right) \\right)\n$$\n这是通过认识到位移高斯函数之和是一个周期函数，并且其在一个周期内的傅里叶系数积分等于单个高斯函数的傅里叶变换而导出的。代入 $K=G'-G=\\frac{2\\pi(n'-n)}{L}$，杂质势矩阵元为：\n$$\nV_{\\text{imp}, n', n} = \\frac{A \\sigma\\sqrt{\\pi}}{L} \\exp\\left(-\\frac{1}{4}\\left(\\frac{2\\pi(n'-n)}{L}\\right)^2 \\sigma^2 \\right)\n$$\n由于势 $V_{\\text{host}}(x)$ 和 $V_{\\text{imp}}(x)$ 都是实偶函数，因此得到的哈密顿矩阵是实对称的。\n\n对于每个测试案例，算法按以下步骤进行：\n1. 通过计算 $n_{\\text{max}}$ 定义基组。\n2. 构建大小为 $(2n_{\\text{max}}+1) \\times (2n_{\\text{max}}+1)$ 的主体哈密顿矩阵 $H_{\\text{host}}$。其矩阵元为 $H_{\\text{host}, n', n} = T_{n', n} + V_{\\text{host}, n', n}$。\n3. 通过将杂质势矩阵加到主体哈密顿量上，构建缺陷哈密顿矩阵 $H_{\\text{defect}}$：$H_{\\text{defect}, n', n} = H_{\\text{host}, n', n} + V_{\\text{imp}, n', n}$。\n4. 数值对角化两个实对称矩阵以找到它们的本征值。每个体系的最低本征值 $E_{\\text{host}}$ 和 $E_{\\text{defect}}$ 是基态能量。\n5. 杂质诱导的能量移动为 $\\Delta E = E_{\\text{defect}} - E_{\\text{host}}$。对于案例 4，$A=0$，因此 $V_{\\text{imp}}=0$，所以 $\\Delta E$ 必须为 $0$。这可作为对该方法的验证。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main solver function to process test cases and print results.\n    \"\"\"\n    test_cases = [\n        (4, 20.0, 1.0, 0.5, -0.4, 0.15),\n        (8, 20.0, 1.0, 0.5, -0.4, 0.15),\n        (16, 20.0, 1.0, 0.5, -0.4, 0.15),\n        (6, 20.0, 1.0, 0.5, 0.0, 0.15),\n    ]\n\n    results = []\n    for case in test_cases:\n        N, E_cut, a, V_c, A, sigma = case\n        \n        # Calculate lowest eigenvalues for the defect and host systems.\n        E_defect = calculate_lowest_eigenvalue(N, E_cut, a, V_c, A, sigma)\n        E_host = calculate_lowest_eigenvalue(N, E_cut, a, V_c, 0.0, sigma)\n        \n        # Calculate the impurity-induced energy shift.\n        delta_E = E_defect - E_host\n        results.append(delta_E)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.12f}' for r in results)}]\")\n\ndef calculate_lowest_eigenvalue(N, E_cut, a, V_c, A, sigma):\n    \"\"\"\n    Calculates the lowest eigenvalue of the Hamiltonian for a given set of parameters.\n    The parameter A (impurity amplitude) determines whether it is a defect (A != 0)\n    or host (A = 0) calculation.\n    \"\"\"\n    # 1. Define the supercell and basis set parameters\n    L = N * a\n    \n    # Determine the range of integer indices n for the plane-wave basis\n    # based on the kinetic energy cutoff E_cut.\n    n_max = int(np.floor((L / np.pi) * np.sqrt(E_cut / 2.0)))\n    basis_size = 2 * n_max + 1\n    \n    # Array of integer indices for G vectors: n = -n_max, ..., n_max\n    n_indices = np.arange(-n_max, n_max + 1)\n\n    # 2. Construct the Hamiltonian matrix\n    H = np.zeros((basis_size, basis_size), dtype=float)\n\n    # 2a. Kinetic Energy Term (diagonal)\n    # G_n = 2*pi*n/L. T = 0.5 * G_n^2\n    G_vals = 2.0 * np.pi * n_indices / L\n    T_matrix_diag = 0.5 * G_vals**2\n    H += np.diag(T_matrix_diag)\n\n    # 2b. Host Potential Term (off-diagonal)\n    # V_host couples states n and n' where |n - n'| = N.\n    # In matrix indices (i,j), this means |i-j| = N.\n    if V_c != 0.0:\n        for i in range(basis_size):\n            if i + N  basis_size:\n                H[i, i + N] += V_c / 2.0\n                H[i + N, i] += V_c / 2.0\n\n    # 2c. Impurity Potential Term (dense matrix)\n    # This term is added only if the impurity amplitude A is non-zero.\n    if A != 0.0:\n        # Create a matrix of index differences (j - i) using broadcasting\n        # This corresponds to n' - n for matrix element H[j, i]\n        matrix_indices = np.arange(basis_size)\n        diff_n_matrix = matrix_indices[:, None] - matrix_indices[None, :]\n        \n        # K = G' - G = 2*pi*(n'-n)/L\n        K_matrix = 2.0 * np.pi * diff_n_matrix / L\n        \n        # V_imp(K) = (A * sigma * sqrt(pi) / L) * exp(-K^2 * sigma^2 / 4)\n        V_imp_matrix = (A * sigma * np.sqrt(np.pi) / L) * \\\n                       np.exp(-K_matrix**2 * sigma**2 / 4.0)\n        \n        H += V_imp_matrix\n\n    # 3. Diagonalize the Hamiltonian\n    # Since H is a real symmetric matrix, np.linalg.eigh is efficient\n    # and returns sorted eigenvalues.\n    eigenvalues = np.linalg.eigh(H)[0]\n    \n    # The lowest eigenvalue is the first element.\n    return eigenvalues[0]\n\nsolve()\n```", "id": "2460291"}, {"introduction": "到目前为止，我们已经关注了基组和模拟晶胞。最后的这个练习将深入探讨现代平面波计算的另一个核心组成部分：赝势。赝势通过使用更平滑、更弱的有效势来代替强而奇异的核心势和紧密束缚的核心电子，从而简化了计算。本练习介绍了“可移植性”的概念——即为一个化学环境创建的赝势在其他环境中表现良好的能力。我们将使用一个简化模型来量化赝势的“软度”如何影响基组要求及其在不同碳同素异形体中的一致性。[@problem_id:2460253]", "problem": "给定一个简化的、受第一性原理启发的模型，用于量化赝势的平滑半径如何在不同成键环境中影响平面波基组的完备性。考虑一个由单一平滑半径 $r_{c}$（单位为玻尔）表征的保范碳赝势。在动能截断值为 $E_{\\mathrm{cut}}$（单位为哈特里）的平面波基组中，仅包含波矢大小满足 $k \\leq k_{\\mathrm{cut}}$ 的平面波，其中在原子单位制下 $k_{\\mathrm{cut}} = \\sqrt{2 E_{\\mathrm{cut}}}$。假设一个代表性价赝轨道的球平均傅里叶空间概率密度可以建模为\n$$\nW(k) \\propto k^{2} \\exp\\!\\left(-\\alpha k^{2}\\right),\n$$\n其中 $\\alpha = \\sigma_{\\mathrm{eff}}^{2}$ 且 $\\sigma_{\\mathrm{eff}} = \\sqrt{\\sigma_{\\mathrm{env}}^{2} + r_{c}^{2}}$。此处，$\\sigma_{\\mathrm{env}}$ 是一个给定的、依赖于环境的特征实空间宽度（单位为玻尔），代表由成键决定的价轨道特征的空间范围。由于有限平面波截断而缺失的光谱权重分数定义为\n$$\nf_{\\mathrm{miss}}(k_{\\mathrm{cut}}, \\alpha) \\equiv \\frac{\\int_{k_{\\mathrm{cut}}}^{\\infty} k^{2} e^{-\\alpha k^{2}} \\, dk}{\\int_{0}^{\\infty} k^{2} e^{-\\alpha k^{2}} \\, dk},\n$$\n这是一个在区间 $[0,1]$ 内的无量纲数。对于三种成键环境，\n- diamond: $\\sigma_{\\mathrm{env}} = \\sigma_{\\mathrm{dia}} = $ $1.2$ bohr,\n- graphene: $\\sigma_{\\mathrm{env}} = \\sigma_{\\mathrm{gra}} = $ $1.8$ bohr,\n- buckminsterfullerene $\\mathrm{C}_{60}$: $\\sigma_{\\mathrm{env}} = \\sigma_{\\mathrm{c60}} = $ $2.2$ bohr,\n将给定配对 $(r_{c}, E_{\\mathrm{cut}})$ 的“可移植性色散”定义为\n$$\n\\Delta_{\\mathrm{tr}}(r_{c}, E_{\\mathrm{cut}}) \\equiv \\max\\!\\big\\{ f_{\\mathrm{miss}}^{(\\mathrm{dia})}, f_{\\mathrm{miss}}^{(\\mathrm{gra})}, f_{\\mathrm{miss}}^{(\\mathrm{c60})} \\big\\} - \\min\\!\\big\\{ f_{\\mathrm{miss}}^{(\\mathrm{dia})}, f_{\\mathrm{miss}}^{(\\mathrm{gra})}, f_{\\mathrm{miss}}^{(\\mathrm{c60})} \\big\\},\n$$\n其中 $f_{\\mathrm{miss}}^{(\\cdot)}$ 是使用相应的 $\\sigma_{\\mathrm{env}}$ 计算的。\n\n任务：编写一个程序，针对以下 $(r_{c}, E_{\\mathrm{cut}})$ 值的测试集（所有值均采用原子单位制：$r_{c}$ 单位为 bohr，$E_{\\mathrm{cut}}$ 单位为 Hartree），\n- 测试 1：$r_{c} = $ $1.3$, $E_{\\mathrm{cut}} = $ $15.0$,\n- 测试 2：$r_{c} = $ $0.8$, $E_{\\mathrm{cut}} = $ $8.0$,\n- 测试 3：$r_{c} = $ $1.8$, $E_{\\mathrm{cut}} = $ $8.0$,\n- 测试 4：$r_{c} = $ $1.3$, $E_{\\mathrm{cut}} = $ $4.0$,\n为每个测试计算 $\\Delta_{\\mathrm{tr}}(r_{c}, E_{\\mathrm{cut}})$。所有量都应以原子单位制处理；无需换算因子。要求的结果是无量纲的实数。你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[x_{1},x_{2},x_{3},x_{4}]$），其中 $x_{i}$ 是与上面列出的顺序相同的测试 $i$ 的 $\\Delta_{\\mathrm{tr}}$ 值。", "solution": "所述问题是有效的。它在科学上基于固态物理和计算化学的原理，特别是平面波密度泛函理论。该模型虽然经过简化，但使用了诸如动能截断值 $E_{\\mathrm{cut}}$、其与波矢截断值 $k_{\\mathrm{cut}}$ 的关系，以及赝势平滑对基组收敛性的影响等既有概念。该问题在数学上是适定的：所有参数和函数都有明确定义，约束条件一致，并且每个测试用例都存在唯一的数值解。目标清晰，无需主观解释。我们将着手推导解决方案。\n\n主要任务是计算可移植性色散 $\\Delta_{\\mathrm{tr}}(r_{c}, E_{\\mathrm{cut}})$，它由缺失的光谱权重分数 $f_{\\mathrm{miss}}(k_{\\mathrm{cut}}, \\alpha)$ 定义。$f_{\\mathrm{miss}}$ 的表达式是一个积分之比：\n$$\nf_{\\mathrm{miss}}(k_{\\mathrm{cut}}, \\alpha) = \\frac{\\int_{k_{\\mathrm{cut}}}^{\\infty} k^{2} e^{-\\alpha k^{2}} \\, dk}{\\int_{0}^{\\infty} k^{2} e^{-\\alpha k^{2}} \\, dk}\n$$\n其中 $\\alpha = \\sigma_{\\mathrm{eff}}^{2} = \\sigma_{\\mathrm{env}}^{2} + r_{c}^{2}$ 且 $k_{\\mathrm{cut}} = \\sqrt{2 E_{\\mathrm{cut}}}$。\n\n为了构建计算算法，我们必须首先找到 $f_{\\mathrm{miss}}$ 的解析闭式表达式。我们分别计算分母和分子的积分。\n\n分母是定积分 $I_{\\mathrm{total}} = \\int_{0}^{\\infty} k^{2} e^{-\\alpha k^{2}} dk$。这是一个标准形式的高斯积分。其值已知为：\n$$\nI_{\\mathrm{total}}(\\alpha) = \\frac{\\sqrt{\\pi}}{4\\alpha^{3/2}}\n$$\n\n分子是不完全积分 $I_{\\mathrm{num}} = \\int_{k_{\\mathrm{cut}}}^{\\infty} k^{2} e^{-\\alpha k^{2}} dk$。我们使用分部积分法 $\\int u \\, dv = uv - \\int v \\, du$ 来计算它。我们选择：\n- $u = k$\n- $dv = k e^{-\\alpha k^{2}} dk$\n\n由此，我们得到：\n- $du = dk$\n- $v = \\int k e^{-\\alpha k^{2}} dk = -\\frac{1}{2\\alpha} e^{-\\alpha k^{2}}$\n\n对定积分应用分部积分法，得到：\n$$\nI_{\\mathrm{num}}(k_{\\mathrm{cut}}, \\alpha) = \\left[ k \\left( -\\frac{1}{2\\alpha} e^{-\\alpha k^{2}} \\right) \\right]_{k_{\\mathrm{cut}}}^{\\infty} - \\int_{k_{\\mathrm{cut}}}^{\\infty} \\left( -\\frac{1}{2\\alpha} e^{-\\alpha k^{2}} \\right) dk\n$$\n第一项在上限 ($k \\to \\infty$) 处的值为 $0$，在下限处的值为 $-\\frac{k_{\\mathrm{cut}}}{2\\alpha}e^{-\\alpha k_{\\mathrm{cut}}^2}$。因此，方括号中的项为 $\\frac{k_{\\mathrm{cut}}}{2\\alpha}e^{-\\alpha k_{\\mathrm{cut}}^2}$。第二项是：\n$$\n\\frac{1}{2\\alpha} \\int_{k_{\\mathrm{cut}}}^{\\infty} e^{-\\alpha k^{2}} dk\n$$\n该积分与互补误差函数 $\\mathrm{erfc}(z) = \\frac{2}{\\sqrt{\\pi}} \\int_z^\\infty e^{-t^2} dt$ 相关。使用换元法 $t = k\\sqrt{\\alpha}$，因此 $dt = \\sqrt{\\alpha} dk$，我们有：\n$$\n\\int_{k_{\\mathrm{cut}}}^{\\infty} e^{-\\alpha k^{2}} dk = \\frac{1}{\\sqrt{\\alpha}} \\int_{k_{\\mathrm{cut}}\\sqrt{\\alpha}}^{\\infty} e^{-t^2} dt = \\frac{1}{\\sqrt{\\alpha}} \\frac{\\sqrt{\\pi}}{2} \\mathrm{erfc}(k_{\\mathrm{cut}}\\sqrt{\\alpha})\n$$\n合并各项，分子积分为：\n$$\nI_{\\mathrm{num}}(k_{\\mathrm{cut}}, \\alpha) = \\frac{k_{\\mathrm{cut}}}{2\\alpha}e^{-\\alpha k_{\\mathrm{cut}}^2} + \\frac{\\sqrt{\\pi}}{4\\alpha^{3/2}} \\mathrm{erfc}(k_{\\mathrm{cut}}\\sqrt{\\alpha})\n$$\n\n现在，我们计算比率 $f_{\\mathrm{miss}} = I_{\\mathrm{num}} / I_{\\mathrm{total}}$：\n$$\nf_{\\mathrm{miss}}(k_{\\mathrm{cut}}, \\alpha) = \\frac{\\frac{k_{\\mathrm{cut}}}{2\\alpha}e^{-\\alpha k_{\\mathrm{cut}}^2} + \\frac{\\sqrt{\\pi}}{4\\alpha^{3/2}} \\mathrm{erfc}(k_{\\mathrm{cut}}\\sqrt{\\alpha})}{\\frac{\\sqrt{\\pi}}{4\\alpha^{3/2}}}\n$$\n简化此表达式可得出 $f_{\\mathrm{miss}}$ 的最终解析公式：\n$$\nf_{\\mathrm{miss}}(k_{\\mathrm{cut}}, \\alpha) = \\frac{2 k_{\\mathrm{cut}}\\sqrt{\\alpha}}{\\sqrt{\\pi}} e^{-\\alpha k_{\\mathrm{cut}}^2} + \\mathrm{erfc}(k_{\\mathrm{cut}}\\sqrt{\\alpha})\n$$\n\n计算步骤如下：\n1. 对于每个由一对值 $(r_c, E_{\\mathrm{cut}})$ 指定的测试用例，首先计算波矢截断值 $k_{\\mathrm{cut}} = \\sqrt{2 E_{\\mathrm{cut}}}$。\n2. 对于由 $\\sigma_{\\mathrm{dia}} = 1.2$、$\\sigma_{\\mathrm{gra}} = 1.8$ 和 $\\sigma_{\\mathrm{c60}} = 2.2$ 分别表征的三种成键环境（diamond、graphene、C$_{60}$），执行以下步骤：\n   a. 计算参数 $\\alpha = \\sigma_{\\mathrm{env}}^2 + r_c^2$。\n   b. 使用推导出的解析公式计算当前环境的 $f_{\\mathrm{miss}}$。\n3. 这将产生一组三个值：$\\{f_{\\mathrm{miss}}^{(\\mathrm{dia})}, f_{\\mathrm{miss}}^{(\\mathrm{gra})}, f_{\\mathrm{miss}}^{(\\mathrm{c60})}\\}$。\n4. 根据这组值计算可移植性色散 $\\Delta_{\\mathrm{tr}} = \\max\\{f_{\\mathrm{miss}}\\} - \\min\\{f_{\\mathrm{miss}}\\}$。\n5. 对问题陈述中提供的所有四个测试用例重复此过程。\n\n理论推导到此结束。实现将是该算法的直接执行。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import erfc\n\ndef solve():\n    \"\"\"\n    Computes the transferability dispersion for a set of test cases based on a\n    simplified pseudopotential model.\n    \"\"\"\n\n    # Define the environment-dependent characteristic widths (in bohr)\n    sigma_envs = {\n        \"dia\": 1.2,\n        \"gra\": 1.8,\n        \"c60\": 2.2,\n    }\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple (r_c, E_cut) in atomic units.\n    test_cases = [\n        (1.3, 15.0),  # Test 1\n        (0.8, 8.0),   # Test 2\n        (1.8, 8.0),   # Test 3\n        (1.3, 4.0),   # Test 4\n    ]\n\n    results = []\n    \n    # Pre-calculate constant 2/sqrt(pi)\n    TWO_OVER_SQRT_PI = 2.0 / np.sqrt(np.pi)\n\n    def calculate_f_miss(k_cut, alpha):\n        \"\"\"\n        Calculates the fraction of missing spectral weight, f_miss.\n\n        Args:\n            k_cut (float): The plane-wave cutoff in reciprocal space (bohr^-1).\n            alpha (float): The model parameter alpha = sigma_eff^2 (bohr^2).\n\n        Returns:\n            float: The dimensionless value of f_miss.\n        \"\"\"\n        z = k_cut * np.sqrt(alpha)\n        term1 = TWO_OVER_SQRT_PI * z * np.exp(-z**2)\n        term2 = erfc(z)\n        return term1 + term2\n\n    # Process each test case\n    for r_c, E_cut in test_cases:\n        # 1. Calculate the wave vector cutoff\n        k_cut = np.sqrt(2.0 * E_cut)\n        \n        f_miss_values = []\n        \n        # 2. Iterate through each bonding environment\n        for sigma_env in sigma_envs.values():\n            # 2a. Compute the parameter alpha\n            alpha = sigma_env**2 + r_c**2\n            \n            # 2b. Calculate f_miss for the current environment\n            f_miss = calculate_f_miss(k_cut, alpha)\n            f_miss_values.append(f_miss)\n            \n        # 3. Calculate the transferability dispersion\n        delta_tr = np.max(f_miss_values) - np.min(f_miss_values)\n        results.append(delta_tr)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.10f}' for r in results)}]\")\n\nsolve()\n```", "id": "2460253"}]}