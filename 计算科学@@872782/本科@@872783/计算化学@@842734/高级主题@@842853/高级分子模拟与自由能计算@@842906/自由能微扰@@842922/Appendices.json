{"hands_on_practices": [{"introduction": "为了建立坚实的理论基础，我们的第一个实践将抽象的自由能微扰公式与经典物理学中的一个具体问题联系起来。我们将通过一个高度简化的假设情景——改变真空中球壳上的电荷——来验证FEP框架得出的结果与基本静电学原理相符。这个练习 [@problem_id:2455869] 对于建立我们对该方法的直观理解和信任至关重要，之后我们才能将其应用于更复杂的分子体系。", "problem": "一个固定的半径为 $a$ 的刚性、无限薄的单球壳被放置在绝对温度为 $T$ 的真空中（相对介电常数为 $1$）。该球壳带有总电荷 $q$，在球壳保持真空隔离且不存在其他自由度的同时，其电荷被准静态地改变为 $q + \\delta q$。假设经典电磁学和统计力学的正则系综适用，并且唯一的能量贡献来自于球壳产生的电磁场。\n\n仅使用第一性原理，确定与电荷从 $q$ 变为 $q + \\delta q$ 相关的精确亥姆霍兹自由能变化 $\\Delta G$。然后，在正则系综内，评估该系统的 $\\Delta G$ 的精确自由能微扰（FEP）表达式，并将其完全简化。将您的最终结果表示为以 $q$、$\\delta q$、$a$ 和 $\\varepsilon_{0}$ 表示的单一闭式解析表达式。能量以焦耳（J）为单位表示。不要进行数值计算。", "solution": "对问题陈述进行验证。\n\n**步骤 1：提取已知条件**\n-   系统：一个固定的半径为 $a$ 的刚性、无限薄的单球壳。\n-   初始状态电荷：$q$。\n-   最终状态电荷：$q + \\delta q$。\n-   过程：准静态电荷变化。\n-   环境：真空，相对介电常数 $1$。自由空间介电常数为 $\\varepsilon_{0}$。\n-   热力学条件：恒定绝对温度 $T$，正则系综。\n-   约束：球壳是孤立的，不存在其他自由度。\n-   能量模型：唯一的能量贡献来自电磁场。\n-   目标：使用两种方法求亥姆霍兹自由能变化（在问题中表示为 $\\Delta G$）：(1) 第一性原理和 (2) 自由能微扰（FEP）公式。最终结果应以 $q$、$\\delta q$、$a$ 和 $\\varepsilon_{0}$ 表示。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题具有科学依据，提法恰当，并且内部一致。它以一种不平凡但可解的方式结合了经典电磁学和统计力学的原理。“不存在其他自由度”这一约束是简化统计力学处理的关键信息，使问题变得易于处理。这意味着系统的能量仅是其电荷的函数，对于给定的电荷，系统只拥有一个微观状态。问题中使用 $\\Delta G$ 来表示亥姆霍兹自由能变化是不常规的；标准符号是 $A$ 或 $F$。然而，问题明确指出“亥姆霍兹自由能变化”，消除了歧义。我将使用标准符号 $\\Delta A$ 进行推导。\n\n**结论与行动**\n该问题被判定为**有效**。将提供完整解答。\n\n目标是计算当球壳上的电荷从 $q$ 变为 $q + \\delta q$ 时，亥姆霍兹自由能的变化 $\\Delta A$。将根据要求通过两种独立的推导方法来完成。\n\n**第 1 部分：从第一性原理计算亥姆霍兹自由能**\n\n亥姆霍兹自由能 $A$ 通过热力学关系 $A = U - TS$ 与内能 $U$ 和熵 $S$ 相关联。在统计力学的背景下，对于正则系综中的系统，熵由 Boltzmann 公式给出，$S = k_B \\ln(W)$，其中 $W$ 是对应于给定宏观状态的微观状态数。\n\n问题陈述中提到“不存在其他自由度”。这意味着对于球壳上给定的总电荷 $Q$，系统只有一个微观状态。因此，微观状态数为 $W=1$。系统的熵为 $S = k_B \\ln(1) = 0$。\n\n因此，亥姆霍兹自由能 $A$ 精确地等于系统的内能 $U$。\n$$A = U - T(0) = U$$\n内能 $U$ 被指定为仅由带电球壳电场中储存的静电势能构成。根据经典电磁学，半径为 $a$、总电荷为 $Q$ 的球壳的静电能 $U(Q)$ 由下式给出：\n$$U(Q) = \\frac{Q^2}{8\\pi\\varepsilon_{0}a}$$\n这个能量等同于准静态地将电荷 $Q$ 聚集到球壳上所做的功。\n\n系统的初始状态电荷为 $q$。其亥姆霍兹自由能为 $A_{\\text{initial}}$。\n$$A_{\\text{initial}} = U(q) = \\frac{q^2}{8\\pi\\varepsilon_{0}a}$$\n最终状态电荷为 $q + \\delta q$。其亥姆霍兹自由能为 $A_{\\text{final}}$。\n$$A_{\\text{final}} = U(q + \\delta q) = \\frac{(q + \\delta q)^2}{8\\pi\\varepsilon_{0}a}$$\n亥姆霍兹自由能的变化 $\\Delta A$ 是最终自由能与初始自由能之差。\n$$\\Delta A = A_{\\text{final}} - A_{\\text{initial}}$$\n$$\\Delta A = \\frac{(q + \\delta q)^2}{8\\pi\\varepsilon_{0}a} - \\frac{q^2}{8\\pi\\varepsilon_{0}a}$$\n提出公因式，我们得到：\n$$\\Delta A = \\frac{1}{8\\pi\\varepsilon_{0}a} \\left[ (q + \\delta q)^2 - q^2 \\right]$$\n展开平方项：\n$$\\Delta A = \\frac{1}{8\\pi\\varepsilon_{0}a} \\left[ (q^2 + 2q\\delta q + (\\delta q)^2) - q^2 \\right]$$\n简化括号内的表达式，得到该方法的最终结果：\n$$\\Delta A = \\frac{2q\\delta q + (\\delta q)^2}{8\\pi\\varepsilon_{0}a}$$\n\n**第 2 部分：从自由能微扰（FEP）公式计算亥姆霍兹自由能**\n\n自由能微扰（FEP）定理提供了一种计算两个状态之间自由能差异的正式方法，这两个状态是参考态（用下标 $0$ 表示）和目标态（用下标 $1$ 表示）。其公式为：\n$$\\Delta A = A_1 - A_0 = -k_B T \\ln \\left\\langle \\exp\\left(-\\frac{U_1 - U_0}{k_B T}\\right) \\right\\rangle_0$$\n这里，$\\beta = \\frac{1}{k_B T}$ 是逆温度，$U_0$ 和 $U_1$ 分别是参考态和目标态的势能，符号 $\\langle \\cdot \\rangle_0$ 表示对参考态 $0$ 的微观状态进行的正则系综平均。\n\n我们来定义我们的状态：\n-   参考态 $0$：球壳上的电荷为 $q$。系统能量为 $U_0 = U(q) = \\frac{q^2}{8\\pi\\varepsilon_{0}a}$。\n-   目标态 $1$：球壳上的电荷为 $q + \\delta q$。系统能量为 $U_1 = U(q + \\delta q) = \\frac{(q + \\delta q)^2}{8\\pi\\varepsilon_{0}a}$。\n\n能量差为 $\\Delta U = U_1 - U_0$。\n$$\\Delta U = \\frac{(q + \\delta q)^2 - q^2}{8\\pi\\varepsilon_{0}a} = \\frac{2q\\delta q + (\\delta q)^2}{8\\pi\\varepsilon_{0}a}$$\nFEP 公式中的系综平均定义为：\n$$\\left\\langle \\exp(-\\beta \\Delta U) \\right\\rangle_0 = \\sum_{i} P_i \\exp(-\\beta \\Delta U_i)$$\n其中求和遍及参考系统 $0$ 的所有微观状态 $i$，$P_i$ 是处于微观状态 $i$ 的概率。\n\n正如在第 1 部分中确定的，此问题的关键简化在于参考系统（带电荷 $q$）只有一个可能的微观状态。设这个单一状态的索引为 $i=1$。因此其概率为 $P_1 = 1$。能量差 $\\Delta U$ 不依赖于任何内部坐标（因为不存在），因此对于整个“系综”而言，它是一个恒定值。\n\n因此，系综平均简化为单项：\n$$\\left\\langle \\exp(-\\beta \\Delta U) \\right\\rangle_0 = (1) \\cdot \\exp(-\\beta \\Delta U) = \\exp(-\\beta \\Delta U)$$\n现在我们将这个简化的平均值代回 FEP 公式：\n$$\\Delta A = -k_B T \\ln \\left[ \\exp(-\\beta \\Delta U) \\right]$$\n利用属性 $\\ln(\\exp(x)) = x$：\n$$\\Delta A = -k_B T (-\\beta \\Delta U) = k_B T \\beta \\Delta U$$\n代入 $\\beta = \\frac{1}{k_B T}$：\n$$\\Delta A = k_B T \\left(\\frac{1}{k_B T}\\right) \\Delta U = \\Delta U$$\n这表明，对于只有一个微观状态（因此熵为零）的系统，FEP 公式正确地简化为亥姆霍兹自由能变化等于系统势能的变化这一论断。\n\n$$\\Delta A = U_1 - U_0 = \\frac{2q\\delta q + (\\delta q)^2}{8\\pi\\varepsilon_{0}a}$$\n这个结果与从第一性原理得到的结果相同，证实了物理模型的一致性。亥姆霍兹自由能变化的最终表达式为：\n$$\\Delta A = \\frac{2q\\delta q + (\\delta q)^2}{8\\pi\\varepsilon_{0}a}$$\n在国际单位制（SI）中，此表达式的单位是焦耳（J），符合能量的要求。这在量纲上是一致的，因为 $\\frac{\\text{电荷}^2}{\\text{介电常数} \\times \\text{长度}}$ 的单位是能量。", "answer": "$$\\boxed{\\frac{2q\\delta q + (\\delta q)^{2}}{8\\pi \\varepsilon_{0} a}}$$", "id": "2455869"}, {"introduction": "自由能微扰（FEP）最具影响力的应用之一是在药物设计领域，特别是用于计算不同分子与蛋白质的相对结合亲和力。本实践 [@problem_id:2455844] 采用一个简化但功能强大的解析模型来模拟这一过程。通过完成这个例子，您将学习如何构建热力学循环，并了解最终的自由能差异如何巧妙地结合了从系统配分函数中推导出的能量和熵的贡献。", "problem": "要求您计算两个配体，苯（配体A）和苯酚（配体B），与一个模型主客体空腔的相对结合自由能。此计算使用一个适用于自由能微扰（FEP）的、经典的、可解析处理的模型。相对结合自由能（RBFE）定义为两种配体结合自由能的差值，该差值可通过使用炼金术转换的热力学循环获得。考虑在绝对温度$T$下的正则系综，玻尔兹曼常数为$k_{\\mathrm{B}}$。在固定环境（结合或未结合）中，将配体A转换为配体B的炼金术自由能变化由以下正则定义给出\n$$\n\\Delta G_{A \\to B}^{(\\mathrm{env})} = -k_{\\mathrm{B}} T \\ln\\left(\\frac{Z_{B}^{(\\mathrm{env})}}{Z_{A}^{(\\mathrm{env})}}\\right),\n$$\n其中$Z_{X}^{(\\mathrm{env})}$是配体$X \\in \\{\\mathrm{A}, \\mathrm{B}\\}$在指定环境中的正则配分函数。相对结合自由能则为\n$$\n\\Delta \\Delta G_{\\mathrm{binding}} = \\Delta G_{A \\to B}^{(\\mathrm{bound})} - \\Delta G_{A \\to B}^{(\\mathrm{unbound})}.\n$$\n在此模型中，每种状态下的环境-配体势能是一个带有恒定能量偏移的各向同性的$D$维谐波势：\n$$\nU_{X}^{(\\mathrm{env})}(\\mathbf{x}) = c_{X}^{(\\mathrm{env})} + \\frac{1}{2} k_{X}^{(\\mathrm{env})} \\lVert \\mathbf{x} \\rVert^{2},\n$$\n其中$k_{X}^{(\\mathrm{env})}  0$是刚度，单位为千焦/摩尔/平方纳米，$c_{X}^{(\\mathrm{env})}$是恒定偏移，单位为千焦/摩尔，且$\\mathbf{x} \\in \\mathbb{R}^{D}$。根据定义，正则配分函数为\n$$\nZ_{X}^{(\\mathrm{env})} = \\int_{\\mathbb{R}^{D}} \\exp\\left[-\\beta \\, U_{X}^{(\\mathrm{env})}(\\mathbf{x})\\right] \\, d^{D}\\mathbf{x},\n$$\n其中逆温度$\\beta = 1/(k_{\\mathrm{B}} T)$。使用上述定义，推导$\\Delta \\Delta G_{\\mathrm{binding}}$关于$T$、$D$、$k_{\\mathrm{B}}$以及参数$\\{k_{X}^{(\\mathrm{env})}, c_{X}^{(\\mathrm{env})}\\}$的显式表达式，并对下面的测试套件进行数值评估。\n\n常数和单位：\n- 使用$k_{\\mathrm{B}} = 0.008314462618$千焦/摩尔/开尔文。\n- 所有刚度参数$k$的单位为千焦/摩尔/平方纳米。\n- 所有偏移量$c$的单位为千焦/摩尔。\n- 所有温度$T$的单位为开尔文。\n- 以千焦/摩尔为单位，将最终答案报告为十进制浮点数。\n\n测试套件（每个案例为$(T, D, k_{\\mathrm{b},A}, c_{\\mathrm{b},A}, k_{\\mathrm{b},B}, c_{\\mathrm{b},B}, k_{\\mathrm{u},A}, c_{\\mathrm{u},A}, k_{\\mathrm{u},B}, c_{\\mathrm{u},B})$，其中`b`表示结合态，`u`表示非结合态）：\n1. 案例1（理想情况）：$(298.15, 3, 200, -20, 250, -25, 50, 0, 60, -2)$\n2. 案例2（相等性检查）：$(298.15, 1, 100, -10, 100, -10, 100, 0, 100, 0)$\n3. 案例3（刚度主导的边缘情况）：$(310, 2, 1000, -20, 100, -20, 10, 0, 1000, 0)$\n4. 案例4（温度变化）：$(350, 3, 150, -18, 180, -21, 60, 0, 65, -1.5)$\n\n程序要求：\n- 对于每个案例，计算$\\Delta \\Delta G_{\\mathrm{binding}}$，其结果为一个单位为千焦/摩尔的浮点数。\n- 您的程序应生成单行输出，包含用方括号括起来的逗号分隔列表形式的结果，每个数字格式化为小数点后六位（例如，$[-1.234567,2.345678,0.000000, \\dots]$）。", "solution": "该问题定义明确，并基于统计力学的基本原理。它为自由能微扰计算提供了一个简化的、可解析求解的模型，这是计算化学中的一种标准技术。因此，该问题是有效的，我们继续推导解决方案。\n\n目标是计算相对结合自由能$\\Delta \\Delta G_{\\mathrm{binding}}$，该值由以下热力学循环定义：\n$$\n\\Delta \\Delta G_{\\mathrm{binding}} = \\Delta G_{A \\to B}^{(\\mathrm{bound})} - \\Delta G_{A \\to B}^{(\\mathrm{unbound})}\n$$\n每个炼金术自由能变化$\\Delta G_{A \\to B}^{(\\mathrm{env})}$由以下表达式给出：\n$$\n\\Delta G_{A \\to B}^{(\\mathrm{env})} = -k_{\\mathrm{B}} T \\ln\\left(\\frac{Z_{B}^{(\\mathrm{env})}}{Z_{A}^{(\\mathrm{env})}}\\right)\n$$\n其中$Z_{X}^{(\\mathrm{env})}$是配体$X$在给定环境（结合态或非结合态）中的正则配分函数。第一步是推导$Z_{X}^{(\\mathrm{env})}$的解析表达式。\n\n势能由下式给出：\n$$\nU_{X}^{(\\mathrm{env})}(\\mathbf{x}) = c_{X}^{(\\mathrm{env})} + \\frac{1}{2} k_{X}^{(\\mathrm{env})} \\lVert \\mathbf{x} \\rVert^{2}\n$$\n配分函数是玻尔兹曼因子在$\\mathbb{R}^{D}$中所有构型上的积分：\n$$\nZ_{X}^{(\\mathrm{env})} = \\int_{\\mathbb{R}^{D}} \\exp\\left[-\\beta \\, U_{X}^{(\\mathrm{env})}(\\mathbf{x})\\right] \\, d^{D}\\mathbf{x}\n$$\n其中$\\beta = 1/(k_{\\mathrm{B}} T)$。代入势能表达式：\n$$\nZ_{X}^{(\\mathrm{env})} = \\int_{\\mathbb{R}^{D}} \\exp\\left[-\\beta \\left( c_{X}^{(\\mathrm{env})} + \\frac{1}{2} k_{X}^{(\\mathrm{env})} \\lVert \\mathbf{x} \\rVert^{2} \\right)\\right] \\, d^{D}\\mathbf{x}\n$$\n和的指数是指数的乘积。涉及$c_{X}^{(\\mathrm{env})}$的项相对于积分变量$\\mathbf{x}$是常数，可以被提取出来：\n$$\nZ_{X}^{(\\mathrm{env})} = \\exp(-\\beta c_{X}^{(\\mathrm{env})}) \\int_{\\mathbb{R}^{D}} \\exp\\left(-\\frac{\\beta k_{X}^{(\\mathrm{env})}}{2} \\lVert \\mathbf{x} \\rVert^{2}\\right) \\, d^{D}\\mathbf{x}\n$$\n该积分为标准的$D$维高斯积分。通过写作$\\lVert \\mathbf{x} \\rVert^{2} = \\sum_{i=1}^{D} x_{i}^{2}$，多维积分可以分解为$D$个相同的一维积分的乘积：\n$$\n\\int_{\\mathbb{R}^{D}} \\exp\\left(-\\frac{\\beta k_{X}^{(\\mathrm{env})}}{2} \\sum_{i=1}^{D} x_{i}^{2}\\right) \\, d^{D}\\mathbf{x} = \\prod_{i=1}^{D} \\left[ \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\beta k_{X}^{(\\mathrm{env})}}{2} x_{i}^{2}\\right) \\, dx_{i} \\right]\n$$\n使用高斯积分的标准结果$\\int_{-\\infty}^{\\infty} e^{-ax^2} dx = \\sqrt{\\pi/a}$，其中$a = \\frac{\\beta k_{X}^{(\\mathrm{env})}}{2}$，每个一维积分的计算结果为：\n$$\n\\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{\\beta k_{X}^{(\\mathrm{env})}}{2} x_{i}^{2}\\right) \\, dx_{i} = \\sqrt{\\frac{2\\pi}{\\beta k_{X}^{(\\mathrm{env})}}}\n$$\n然后，$D$维积分是这个结果的$D$次方：\n$$\n\\left(\\sqrt{\\frac{2\\pi}{\\beta k_{X}^{(\\mathrm{env})}}}\\right)^{D} = \\left(\\frac{2\\pi}{\\beta k_{X}^{(\\mathrm{env})}}\\right)^{D/2}\n$$\n将其代回配分函数的表达式中，得到：\n$$\nZ_{X}^{(\\mathrm{env})} = \\exp(-\\beta c_{X}^{(\\mathrm{env})}) \\left(\\frac{2\\pi}{\\beta k_{X}^{(\\mathrm{env})}}\\right)^{D/2}\n$$\n现在，我们可以计算$\\Delta G_{A \\to B}^{(\\mathrm{env})}$所需的配分函数之比：\n$$\n\\frac{Z_{B}^{(\\mathrm{env})}}{Z_{A}^{(\\mathrm{env})}} = \\frac{\\exp(-\\beta c_{B}^{(\\mathrm{env})}) \\left(\\frac{2\\pi}{\\beta k_{B}^{(\\mathrm{env})}}\\right)^{D/2}}{\\exp(-\\beta c_{A}^{(\\mathrm{env})}) \\left(\\frac{2\\pi}{\\beta k_{A}^{(\\mathrm{env})}}\\right)^{D/2}}\n$$\n$(2\\pi/\\beta)^{D/2}$项相互抵消，剩下：\n$$\n\\frac{Z_{B}^{(\\mathrm{env})}}{Z_{A}^{(\\mathrm{env})}} = \\frac{\\exp(-\\beta c_{B}^{(\\mathrm{env})}) (k_{B}^{(\\mathrm{env})})^{-D/2}}{\\exp(-\\beta c_{A}^{(\\mathrm{env})}) (k_{A}^{(\\mathrm{env})})^{-D/2}} = \\exp\\left[-\\beta(c_{B}^{(\\mathrm{env})} - c_{A}^{(\\mathrm{env})})\\right] \\left(\\frac{k_{A}^{(\\mathrm{env})}}{k_{B}^{(\\mathrm{env})}}\\right)^{D/2}\n$$\n那么，炼金术自由能变化为：\n$$\n\\Delta G_{A \\to B}^{(\\mathrm{env})} = -k_{\\mathrm{B}} T \\ln \\left( \\exp\\left[-\\beta(c_{B}^{(\\mathrm{env})} - c_{A}^{(\\mathrm{env})})\\right] \\left(\\frac{k_{A}^{(\\mathrm{env}})}{k_{B}^{(\\mathrm{env}})}\\right)^{D/2} \\right)\n$$\n使用对数的性质$\\ln(ab) = \\ln(a) + \\ln(b)$和$\\ln(e^x) = x$，并回顾$k_{\\mathrm{B}} T \\beta = 1$：\n$$\n\\Delta G_{A \\to B}^{(\\mathrm{env})} = -k_{\\mathrm{B}} T \\left[ -\\beta(c_{B}^{(\\mathrm{env})} - c_{A}^{(\\mathrm{env})}) + \\frac{D}{2} \\ln\\left(\\frac{k_{A}^{(\\mathrm{env}})}{k_{B}^{(\\mathrm{env}})}\\right) \\right]\n$$\n$$\n\\Delta G_{A \\to B}^{(\\mathrm{env})} = (c_{B}^{(\\mathrm{env})} - c_{A}^{(\\mathrm{env})}) - \\frac{k_{\\mathrm{B}} T D}{2} \\ln\\left(\\frac{k_{A}^{(\\mathrm{env})}}{k_{B}^{(\\mathrm{env})}}\\right)\n$$\n使用$\\ln(1/x) = -\\ln(x)$，我们可以更对称地写成：\n$$\n\\Delta G_{A \\to B}^{(\\mathrm{env})} = (c_{B}^{(\\mathrm{env})} - c_{A}^{(\\mathrm{env})}) + \\frac{k_{\\mathrm{B}} T D}{2} \\ln\\left(\\frac{k_{B}^{(\\mathrm{env})}}{k_{A}^{(\\mathrm{env})}}\\right)\n$$\n这是单个环境中自由能变化的一般表达式。\n最后，我们通过从结合态的结果中减去非结合态的结果来计算相对结合自由能$\\Delta \\Delta G_{\\mathrm{binding}}$。令$\\Delta c^{(\\mathrm{env})} = c_{B}^{(\\mathrm{env})} - c_{A}^{(\\mathrm{env})}$。\n$$\n\\Delta G_{A \\to B}^{(\\mathrm{bound})} = \\Delta c^{(\\mathrm{bound})} + \\frac{k_{\\mathrm{B}} T D}{2} \\ln\\left(\\frac{k_{B}^{(\\mathrm{bound})}}{k_{A}^{(\\mathrm{bound})}}\\right)\n$$\n$$\n\\Delta G_{A \\to B}^{(\\mathrm{unbound})} = \\Delta c^{(\\mathrm{unbound})} + \\frac{k_{\\mathrm{B}} T D}{2} \\ln\\left(\\frac{k_{B}^{(\\mathrm{unbound})}}{k_{A}^{(\\mathrm{unbound})}}\\right)\n$$\n将两个表达式相减：\n$$\n\\Delta \\Delta G_{\\mathrm{binding}} = (\\Delta c^{(\\mathrm{bound})} - \\Delta c^{(\\mathrm{unbound})}) + \\frac{k_{\\mathrm{B}} T D}{2} \\left[ \\ln\\left(\\frac{k_{B}^{(\\mathrm{bound})}}{k_{A}^{(\\mathrm{bound})}}\\right) - \\ln\\left(\\frac{k_{B}^{(\\mathrm{unbound})}}{k_{A}^{(\\mathrm{unbound})}}\\right) \\right]\n$$\n代回$\\Delta c$的定义，并使用$\\ln(a) - \\ln(b) = \\ln(a/b)$合并对数项：\n$$\n\\Delta \\Delta G_{\\mathrm{binding}} = (c_{B}^{(\\mathrm{bound})} - c_{A}^{(\\mathrm{bound})} - c_{B}^{(\\mathrm{unbound})} + c_{A}^{(\\mathrm{unbound})}) + \\frac{k_{\\mathrm{B}} T D}{2} \\ln\\left( \\frac{ k_{B}^{(\\mathrm{bound})} k_{A}^{(\\mathrm{unbound})} }{ k_{A}^{(\\mathrm{bound})} k_{B}^{(\\mathrm{unbound})} } \\right)\n$$\n这是最终的解析公式。它将被实现以计算所提供测试用例的数值结果。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the relative binding free energy for a series of test cases\n    based on an analytical model of alchemical transformation.\n    \"\"\"\n    kB = 0.008314462618  # Boltzmann constant in kJ/(mol·K)\n\n    # Test cases: (T, D, k_bA, c_bA, k_bB, c_bB, k_uA, c_uA, k_uB, c_uB)\n    test_cases = [\n        (298.15, 3, 200, -20, 250, -25, 50, 0, 60, -2),\n        (298.15, 1, 100, -10, 100, -10, 100, 0, 100, 0),\n        (310, 2, 1000, -20, 100, -20, 10, 0, 1000, 0),\n        (350, 3, 150, -18, 180, -21, 60, 0, 65, -1.5)\n    ]\n\n    results = []\n    for case in test_cases:\n        T, D, k_bA, c_bA, k_bB, c_bB, k_uA, c_uA, k_uB, c_uB = case\n\n        # The analytical formula for the relative binding free energy is:\n        # ΔΔG = (c_bB - c_bA - c_uB + c_uA) + (k_B*T*D/2) * ln((k_bB*k_uA) / (k_bA*k_uB))\n        \n        # Contribution from the potential energy offsets\n        delta_c_term = (c_bB - c_bA) - (c_uB - c_uA)\n\n        # Contribution from the stiffness (entropy)\n        # We must protect against division by zero, although the problem states k > 0.\n        # Also, the argument of the logarithm must be positive.\n        k_ratio = (k_bB * k_uA) / (k_bA * k_uB)\n        \n        # The prefactor for the logarithmic term\n        log_prefactor = 0.5 * kB * T * D\n        \n        # Logarithmic term\n        log_term = log_prefactor * np.log(k_ratio)\n        \n        # Total relative binding free energy\n        ddG_binding = delta_c_term + log_term\n        \n        results.append(ddG_binding)\n\n    # Format the results to six decimal places and print\n    # in the specified comma-separated list format.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2455844"}, {"introduction": "与解析模型不同，真实的计算实验产生的结果带有固有的统计不确定性。因此，评估数据的可靠性和一致性是每位计算科学家的关键任务。这最后一个实践 [@problem_id:2455881] 展示了一个常见场景：您拥有多个相关的FEP计算结果，并且必须使用环路闭合检验来验证它们的热力学一致性。这是验证模拟结果的一项至关重要的技能。", "problem": "在自由能微扰（FEP）中，状态间的相对吉布斯自由能变化是通过分子模拟来估算的。对于三个炼金术突变 $A \\to B$、$B \\to C$ 和 $A \\to C$，假设您独立地获得了以下估计值（平均值和标准误），单位为 $\\mathrm{kcal\\,mol^{-1}}$：\n- $\\Delta G_{A \\to B} = 1.20 \\pm 0.30$\n- $\\Delta G_{B \\to C} = -0.80 \\pm 0.40$\n- $\\Delta G_{A \\to C} = 0.50 \\pm 0.35$\n\n选择一个选项，该选项为这组三态体系正确定义了一个置信度为 $95\\%$ 的统计上合理的循环闭合一致性检验，并正确评估了这些数据是否通过该检验。\n\nA. 将循环闭合残差定义为 $\\varepsilon = \\Delta G_{A \\to B} + \\Delta G_{B \\to C} - \\Delta G_{A \\to C}$，并假设估计是独立的，将不确定度定义为 $\\sigma_{\\varepsilon} = \\sqrt{\\sigma_{A \\to B}^{2} + \\sigma_{B \\to C}^{2} + \\sigma_{A \\to C}^{2}}$。如果 $\\lvert \\varepsilon \\rvert \\le 1.96\\, \\sigma_{\\varepsilon}$，则宣布循环一致；根据给定的数据，循环通过检验。\n\nB. 通过要求 $\\Delta G_{A \\to B} + \\Delta G_{B \\to C} + \\Delta G_{A \\to C} = 0$ 精确成立来强制执行热力学一致性；根据给定的数据，循环未通过检验。\n\nC. 将闭合残差定义为 $\\varepsilon = \\Delta G_{A \\to B} + \\Delta G_{B \\to C} - \\Delta G_{A \\to C}$，不确定度定义为 $\\sigma_{\\varepsilon} = \\sigma_{A \\to B} + \\sigma_{B \\to C} + \\sigma_{A \\to C}$。如果 $\\lvert \\varepsilon \\rvert \\le 1.96\\, \\sigma_{\\varepsilon}$，则宣布循环一致；根据给定的数据，循环通过检验。\n\nD. 将闭合残差定义为 $\\varepsilon = \\Delta G_{A \\to B} + \\Delta G_{B \\to C} + \\Delta G_{C \\to A}$，取 $\\Delta G_{C \\to A} = \\Delta G_{A \\to C}$，并将不确定度组合为 $\\sigma_{\\varepsilon} = \\sqrt{\\sigma_{A \\to B}^{2} + \\sigma_{B \\to C}^{2} + \\sigma_{A \\to C}^{2}}$。如果 $\\lvert \\varepsilon \\rvert \\le \\sigma_{\\varepsilon}$，则宣布循环一致；根据给定的数据，循环通过检验。\n\nE. 将闭合残差定义为 $\\varepsilon = \\Delta G_{A \\to C} - \\left(\\Delta G_{A \\to B} + \\Delta G_{B \\to C}\\right)$，其不确定度为平均值 $\\sigma_{\\varepsilon} = \\left(\\sigma_{A \\to B} + \\sigma_{B \\to C} + \\sigma_{A \\to C}\\right)/3$。如果 $\\lvert \\varepsilon \\rvert \\le 1.96\\, \\sigma_{\\varepsilon}$，则宣布一致；根据给定的数据，循环未通过检验。", "solution": "对问题陈述进行验证。\n\n**步骤1：提取已知信息**\n提供的信息如下：\n- 考虑一个涉及三个状态 $A$、$B$ 和 $C$ 的热力学循环。\n- 相对吉布斯自由能变化是通过独立的分子模拟估算的。\n- $\\Delta G_{A \\to B} = 1.20 \\pm 0.30 \\, \\mathrm{kcal\\,mol^{-1}}$ （平均值 $\\pm$ 标准误）。\n- $\\Delta G_{B \\to C} = -0.80 \\pm 0.40 \\, \\mathrm{kcal\\,mol^{-1}}$ （平均值 $\\pm$ 标准误）。\n- $\\Delta G_{A \\to C} = 0.50 \\pm 0.35 \\, \\mathrm{kcal\\,mol^{-1}}$ （平均值 $\\pm$ 标准误）。\n- 任务是确定一个置信度为 $95\\%$ 的统计上合理的循环闭合一致性检验，并用给定的数据对其进行评估。\n\n**步骤2：使用提取的已知信息进行验证**\n- **科学依据**：该问题基于吉布斯自由能是状态函数这一基本原理，这是热力学的一个基石。将统计误差分析（不确定性传播、置信区间）应用于计算化学结果（FEP模拟）是该领域的标准和严谨实践。所提供的数值在物理上是合理的。该问题在科学上是合理的。\n- **适定性**：该问题是适定的。它提供了所有必要的数据（独立测量的平均值和标准误）来构建循环闭合的统计检验。问题精确，并允许根据已建立的统计方法得出一个唯一的、可确定的答案。\n- **客观性**：该问题使用定量数据和已建立的科学术语客观地陈述。它没有歧义或主观论断。\n\n**步骤3：结论与行动**\n问题陈述是有效的。这是模拟数据统计分析中的一个标准练习。我将继续进行推导和评估。\n\n### 推导\n\n分析基于两个原理：一个来自热力学，一个来自统计学。\n\n**1. 热力学原理：**\n吉布斯自由能 $G$ 是一个状态函数。这意味着对于任何循环路径，自由能的净变化为零。对于循环 $A \\to B \\to C \\to A$，我们有：\n$$ \\Delta G_{\\text{cycle}} = \\Delta G_{A \\to B} + \\Delta G_{B \\to C} + \\Delta G_{C \\to A} = 0 $$\n此外，逆过程的自由能变化是正过程的负值：$\\Delta G_{C \\to A} = - \\Delta G_{A \\to C}$。 将此代入循环方程，得到理想循环闭合的条件：\n$$ \\Delta G_{A \\to B} + \\Delta G_{B \\to C} - \\Delta G_{A \\to C} = 0 $$\n这个方程定义了真实平均值应满足的理想关系。\n\n**2. 统计学原理：**\n所提供的值不是真实、精确的自由能，而是来自有限模拟的*估计值*，每个值都有相关的统计误差（平均值的标准误）。因此，我们必须检验观察到的与理想闭合的偏差是否具有统计显著性。\n\n我们将循环闭合残差 $\\varepsilon$ 定义为与期望值零的偏差：\n$$ \\varepsilon = \\Delta G_{A \\to B} + \\Delta G_{B \\to C} - \\Delta G_{A \\to C} $$\n使用给定的平均值，我们计算观察到的残差：\n$$ \\varepsilon = 1.20 \\, \\mathrm{kcal\\,mol^{-1}} + (-0.80 \\, \\mathrm{kcal\\,mol^{-1}}) - 0.50 \\, \\mathrm{kcal\\,mol^{-1}} = -0.10 \\, \\mathrm{kcal\\,mol^{-1}} $$\n问题陈述估计是“独立获得的”。对于一个量 $Y = c_1 X_1 + c_2 X_2 + c_3 X_3$，其中 $X_i$ 是方差为 $\\sigma_{X_i}^2$ 的独立随机变量， $Y$ 的方差为 $\\sigma_Y^2 = c_1^2 \\sigma_{X_1}^2 + c_2^2 \\sigma_{X_2}^2 + c_3^2 \\sigma_{X_3}^2$。在我们的例子中，$\\Delta G_{A \\to B}$、$\\Delta G_{B \\to C}$ 和 $\\Delta G_{A \\to C}$ 是自变量，系数分别为 $c_1=1$、$c_2=1$ 和 $c_3=-1$。因此，残差的方差 $\\sigma_{\\varepsilon}^2$ 为：\n$$ \\sigma_{\\varepsilon}^2 = (1)^2 \\sigma_{A \\to B}^2 + (1)^2 \\sigma_{B \\to C}^2 + (-1)^2 \\sigma_{A \\to C}^2 = \\sigma_{A \\to B}^2 + \\sigma_{B \\to C}^2 + \\sigma_{A \\to C}^2 $$\n残差的标准误 $\\sigma_{\\varepsilon}$ 是方差的平方根：\n$$ \\sigma_{\\varepsilon} = \\sqrt{\\sigma_{A \\to B}^2 + \\sigma_{B \\to C}^2 + \\sigma_{A \\to C}^2} $$\n代入给定的标准误：\n$$ \\sigma_{\\varepsilon} = \\sqrt{(0.30)^2 + (0.40)^2 + (0.35)^2} = \\sqrt{0.09 + 0.16 + 0.1225} = \\sqrt{0.3725} \\approx 0.6103 \\, \\mathrm{kcal\\,mol^{-1}} $$\n一个置信度为 $95\\%$ 的检验是检查理想值 $0$ 是否在我们估计的残差的 $95\\%$ 置信区间内。假设中心极限定理成立且误差近似服从正态分布，该区间为 $\\varepsilon \\pm 1.96 \\, \\sigma_{\\varepsilon}$。如果 $0$ 位于此区间内，则认为循环是一致的，这可以简化为以下条件：\n$$ \\lvert \\varepsilon \\rvert \\le 1.96 \\, \\sigma_{\\varepsilon} $$\n让我们用我们计算出的值来评估这个条件：\n- 左边： $\\lvert \\varepsilon \\rvert = \\lvert -0.10 \\rvert = 0.10$。\n- 右边： $1.96 \\, \\sigma_{\\varepsilon} \\approx 1.96 \\times 0.6103 \\approx 1.196$。\n\n条件是 $0.10 \\le 1.196$，这是成立的。在 $95\\%$ 的置信水平上，该循环是一致的；数据通过了检验。\n\n### 逐项分析\n\n**A. 将循环闭合残差定义为 $\\varepsilon = \\Delta G_{A \\to B} + \\Delta G_{B \\to C} - \\Delta G_{A \\to C}$，并假设估计是独立的，将不确定度定义为 $\\sigma_{\\varepsilon} = \\sqrt{\\sigma_{A \\to B}^{2} + \\sigma_{B \\to C}^{2} + \\sigma_{A \\to C}^{2}}$。如果 $\\lvert \\varepsilon \\rvert \\le 1.96\\, \\sigma_{\\varepsilon}$，则宣布循环一致；根据给定的数据，循环通过检验。**\n- 残差 $\\varepsilon$ 的定义基于热力学原理是正确的。\n- 不确定性传播（标准误 $\\sigma_{\\varepsilon}$）的公式对于独立变量的和是正确的。\n- 统计检验 $\\lvert \\varepsilon \\rvert \\le 1.96\\, \\sigma_{\\varepsilon}$ 是 $95\\%$ 置信度的正确标准。\n- 评估“循环通过检验”与我们的推导相符。\n- **结论：正确。**\n\n**B. 通过要求 $\\Delta G_{A \\to B} + \\Delta G_{B \\to C} + \\Delta G_{A \\to C} = 0$ 精确成立来强制执行热力学一致性；根据给定的数据，循环未通过检验。**\n- 公式 $\\Delta G_{A \\to B} + \\Delta G_{B \\to C} + \\Delta G_{A \\to C} = 0$ 在热力学上是不正确的；它应该是 $\\Delta G_{A \\to B} + \\Delta G_{B \\to C} - \\Delta G_{A \\to C} = 0$。\n- 更重要的是，要求统计估计值精确相等在逻辑上是根本错误的。它完全忽略了测量中固有的统计不确定性的本质。这是一个确定性检验，而不是统计检验。\n- **结论：不正确。**\n\n**C. 将闭合残差定义为 $\\varepsilon = \\Delta G_{A \\to B} + \\Delta G_{B \\to C} - \\Delta G_{A \\to C}$，不确定度定义为 $\\sigma_{\\varepsilon} = \\sigma_{A \\to B} + \\sigma_{B \\to C} + \\sigma_{A \\to C}$。如果 $\\lvert \\varepsilon \\rvert \\le 1.96\\, \\sigma_{\\varepsilon}$，则宣布循环一致；根据给定的数据，循环通过检验。**\n- 残差 $\\varepsilon$ 的定义是正确的。\n- 不确定度的公式 $\\sigma_{\\varepsilon} = \\sigma_{A \\to B} + \\sigma_{B \\to C} + \\sigma_{A \\to C}$ 是不正确的。标准误是按方相加的（即方差相加），而不是线性相加的。这严重违反了独立变量的误差传播规则。\n- **结论：不正确。**\n\n**D. 将闭合残差定义为 $\\varepsilon = \\Delta G_{A \\to B} + \\Delta G_{B \\to C} + \\Delta G_{C \\to A}$，取 $\\Delta G_{C \\to A} = \\Delta G_{A \\to C}$，并将不确定度组合为 $\\sigma_{\\varepsilon} = \\sqrt{\\sigma_{A \\to B}^{2} + \\sigma_{B \\to C}^{2} + \\sigma_{A \\to C}^{2}}$。如果 $\\lvert \\varepsilon \\rvert \\le \\sigma_{\\varepsilon}$，则宣布循环一致；根据给定的数据，循环通过检验。**\n- 残差的定义使用了假设 $\\Delta G_{C \\to A} = \\Delta G_{A \\to C}$，这在热力学上是不正确的。正确的关系是 $\\Delta G_{C \\to A} = - \\Delta G_{A \\to C}$。\n- 一致性检验 $\\lvert \\varepsilon \\rvert \\le \\sigma_{\\varepsilon}$ 对应于大约 $68\\%$ 的置信水平（一个标准差），而不是要求的 $95\\%$。\n- 该选项至少包含两个基本错误。\n- **结论：不正确。**\n\n**E. 将闭合残差定义为 $\\varepsilon = \\Delta G_{A \\to C} - \\left(\\Delta G_{A \\to B} + \\Delta G_{B \\to C}\\right)$，其不确定度为平均值 $\\sigma_{\\varepsilon} = \\left(\\sigma_{A \\to B} + \\sigma_{B \\to C} + \\sigma_{A \\to C}\\right)/3$。如果 $\\lvert \\varepsilon \\rvert \\le 1.96\\, \\sigma_{\\varepsilon}$，则宣布一致；根据给定的数据，循环未通过检验。**\n- 将不确定度定义为标准误的算术平均值在统计学上是毫无根据的。没有任何原理解释这种误差传播的组合规则。\n- 此外，即使使用这个错误的公式，“循环未通过检验”的评估也是一个计算错误。正如在推导中计算的，$\\lvert \\varepsilon \\rvert = 0.10$。使用错误的不确定度公式，$\\sigma_{\\varepsilon} = (0.30 + 0.40 + 0.35)/3 = 0.35$。那么 $1.96\\,\\sigma_{\\varepsilon} = 1.96 \\times 0.35 = 0.686$。由于 $0.10 \\le 0.686$，循环将通过此检验。该选项自相矛盾。\n- **结论：不正确。**", "answer": "$$\\boxed{A}$$", "id": "2455881"}]}