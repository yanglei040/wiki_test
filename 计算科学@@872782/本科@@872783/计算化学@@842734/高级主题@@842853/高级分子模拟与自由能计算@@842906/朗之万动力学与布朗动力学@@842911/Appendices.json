{"hands_on_practices": [{"introduction": "许多化学和生物过程，例如化学反应或蛋白质折叠，本质上都可以看作是系统在能量形貌上从一个稳定状态“逃逸”到另一个状态的罕见事件。本练习将通过一个简化的模型——一个粒子在双阱势中的运动——来模拟这一过程。你将亲手实现过阻尼朗之万动力学的数值积分，并计算粒子穿越势垒的平均首通时间（Mean First Passage Time, MFPT），从而直观地理解温度和势垒高度如何影响反应速率。[@problem_id:2457132]", "problem": "一个单粒子在四次势阱中经历等温过阻尼朗之万动力学，该势阱有一个势垒分隔两个极小值点。您需要计算粒子穿过位于原点的势垒顶部从左阱逃逸的平均首通时间（Mean First Passage Time, MFPT），并通过直接数值模拟探究其对势垒高度和温度的依赖性。\n\n基本物理基础。使用简化到过阻尼极限的牛顿第二定律以及涨落-耗散定理 (FDT)。在过阻尼情况下，位置过程 $x(t)$ 满足以下随机微分方程\n$$\n\\gamma \\,\\dot{x}(t) = -\\frac{dU}{dx}(x(t)) + \\sqrt{2\\,\\gamma\\,k_{\\mathrm{B}}\\,T}\\,\\xi(t),\n$$\n其中 $\\gamma$ 是摩擦系数，$U(x)$ 是势能，$k_{\\mathrm{B}}$ 是玻尔兹曼常数，$T$ 是绝对温度，$\\xi(t)$ 是零均值和 δ 相关的高斯白噪声。\n\n势能。设势能为\n$$\nU(x;H,L)= H\\left[\\left(\\frac{x}{L}\\right)^{4}-2\\left(\\frac{x}{L}\\right)^{2}\\right],\n$$\n其中势垒高度参数 $H>0$，长度尺度 $L>0$。该势在 $x=\\pm L$ 附近有极小值点，在 $x=0$ 处有势垒顶部。相对于阱极小值点的势垒高度恰好为 $H$，因为 $U(0)=0$ 且 $U(\\pm L)=-H$。\n\n逃逸事件。粒子从 $x(0)=-L$ 开始，逃逸事件定义为首次满足 $x(\\tau)\\ge 0$ 的时间 $\\tau$。平均首通时间 (MFPT) 是期望值 $\\mathbb{E}[\\tau]$。\n\n离散化。对过阻尼朗之万方程使用欧拉-丸山时间离散化方法，\n$$\nx_{n+1} = x_{n} + \\frac{\\Delta t}{\\gamma}\\,F(x_{n}) + \\sqrt{\\frac{2\\,k_{\\mathrm{B}}\\,T\\,\\Delta t}{\\gamma}}\\,\\eta_{n},\n$$\n其中 $F(x)=-\\frac{dU}{dx}(x)$ 是确定性力，$\\Delta t$ 是时间步长，$\\eta_{n}\\sim \\mathcal{N}(0,1)$ 是独立的标准正态随机变量。对于指定的势，力为\n$$\nF(x)= -\\frac{dU}{dx}(x)= -H\\left[\\frac{4x^{3}}{L^{4}}-\\frac{4x}{L^{2}}\\right] = \\frac{4H}{L^{2}}\\left(x-\\frac{x^{3}}{L^{2}}\\right).\n$$\n\n数值实验设计。对于每个参数集，从 $x_{0}=-L$ 开始模拟 $N$ 条独立轨迹，并以固定的 $\\Delta t$ 使其随时间演化，直到每条轨迹首次满足 $x\\ge 0$ 或达到最大时间 $t_{\\max}$。通过对已逃逸轨迹记录的首通时间取样本均值来估计 MFPT。如果没有轨迹在 $t_{\\max}$ 之前逃逸，则返回 $t_{\\max}$ 作为保守估计。\n\n物理参数和单位。所有测试案例均使用以下固定参数：\n- 玻尔兹曼常数 $k_{\\mathrm{B}} = 1.380\\,649\\times 10^{-23}\\ \\mathrm{J\\,K^{-1}}$。\n- 摩擦系数 $\\gamma = 1.0\\times 10^{-12}\\ \\mathrm{kg\\,s^{-1}}$。\n- 长度尺度 $L=1.0\\times 10^{-9}\\ \\mathrm{m}$。\n- 时间步长 $\\Delta t = 5.0\\times 10^{-14}\\ \\mathrm{s}$。\n- 轨迹数量 $N=64$。\n- 最大模拟时间 $t_{\\max}=1.0\\times 10^{-7}\\ \\mathrm{s}$。\n所有时间答案必须以秒 ($\\mathrm{s}$) 为单位表示。\n\n势垒高度规定。每个测试案例的势垒高度 $H$ 是相对于参考温度 $T_{\\mathrm{ref}}=300\\ \\mathrm{K}$ 下的热能指定的，即\n$$\nH = h\\,k_{\\mathrm{B}}\\,T_{\\mathrm{ref}},\n$$\n其中 $h$ 是每个测试案例提供的无量纲乘数。\n\n测试组。对以下参数集 $(h, T)$ 运行程序：\n- 案例 A (理想情况): $(h, T) = (2.0, 300.0\\ \\mathrm{K})$。\n- 案例 B (相同温度下更高的势垒): $(h, T) = (4.0, 300.0\\ \\mathrm{K})$。\n- 案例 C (与案例 B 势垒相同但温度更高): $(h, T) = (4.0, 600.0\\ \\mathrm{K})$。\n- 案例 D (小势垒边缘情况): $(h, T) = (0.5, 300.0\\ \\mathrm{K})$。\n\n计算内容。对于每个案例，使用所述模拟方法计算估计的 MFPT (单位为 $\\mathrm{s}$)，结果为浮点数。使用固定的随机种子，以保证结果可复现。\n\n最终输出格式。您的程序应生成单行输出，其中包含按 A, B, C, D 顺序排列的四个 MFPT 估计值，形式为用方括号括起来的逗号分隔列表（例如，“[tA,tB,tC,tD]”），其中每个条目都是以 $\\mathrm{s}$ 为单位的浮点数。", "solution": "我们从计算化学中适用于过阻尼随机动力学的第一性原理出发。牛顿第二定律指出，对于一维空间中质量为 $m$ 的粒子，\n$$\nm\\,\\ddot{x}(t)= -\\frac{dU}{dx}(x(t)) - \\gamma\\,\\dot{x}(t) + R(t),\n$$\n其中 $-\\frac{dU}{dx}$ 是来自势能 $U(x)$ 的确定性保守力，$-\\gamma \\dot{x}$ 是连续溶剂中的粘性阻力，$R(t)$ 是来自热涨落的随机力。在过阻尼极限下，与摩擦相比，惯性项 $m\\,\\ddot{x}(t)$ 可以忽略不计，从而得到\n$$\n\\gamma \\,\\dot{x}(t)= -\\frac{dU}{dx}(x(t)) + R(t).\n$$\n涨落-耗散定理 (FDT) 将随机力的统计特性与摩擦和温度联系起来，意味着 $R(t)$ 是一个零均值的高斯白噪声，其自相关函数为 $\\langle R(t)R(t')\\rangle = 2\\,\\gamma\\,k_{\\mathrm{B}}\\,T\\,\\delta(t-t')$。将 $R(t)$ 写成 $\\sqrt{2\\,\\gamma\\,k_{\\mathrm{B}}\\,T}\\,\\xi(t)$，其中 $\\xi(t)$ 是标准白噪声，便得到过阻尼朗之万随机微分方程\n$$\n\\gamma \\,\\dot{x}(t)= -\\frac{dU}{dx}(x(t)) + \\sqrt{2\\,\\gamma\\,k_{\\mathrm{B}}\\,T}\\,\\xi(t).\n$$\n\n为了数值模拟这个随机微分方程，我们使用欧拉-丸山方法，该方法以步长 $\\Delta t$ 对时间进行离散化，并根据以下规则更新位置\n$$\nx_{n+1} = x_{n} + \\frac{\\Delta t}{\\gamma}\\,F(x_{n}) + \\sqrt{\\frac{2\\,k_{\\mathrm{B}}\\,T\\,\\Delta t}{\\gamma}}\\,\\eta_{n},\n$$\n其中 $F(x)=-\\frac{dU}{dx}(x)$，$\\eta_{n}\\sim \\mathcal{N}(0,1)$ 是独立的标准正态变量。该积分器是通过在一个小时间区间上对随机微分方程进行积分，并将漂移项和扩散项近似到 $\\Delta t$ 的一阶而得到的。\n\n我们将势能定义为\n$$\nU(x;H,L)= H\\left[\\left(\\frac{x}{L}\\right)^{4}-2\\left(\\frac{x}{L}\\right)^{2}\\right],\n$$\n该势在 $x=\\pm L$ 处有极小值点，其值为 $U(\\pm L)=-H$，在 $x=0$ 处有势垒顶部，其值为 $U(0)=0$。因此，相对于阱底的势垒高度恰好为 $H$。确定性力是负梯度，\n$$\nF(x)=-\\frac{dU}{dx}(x) = -H\\left[\\frac{4x^{3}}{L^{4}}-\\frac{4x}{L^{2}}\\right] = \\frac{4H}{L^{2}}\\left(x-\\frac{x^{3}}{L^{2}}\\right).\n$$\n\n逃逸事件定义为从 $x(0)=-L$ 开始的轨迹首次达到 $x(\\tau)\\ge 0$ 的时间 $\\tau$。我们通过模拟 $N$ 条独立轨迹，并计算在设定的最大时间 $t_{\\max}$ 之前逃逸的那些轨迹的首通时间的样本均值，来估计平均首通时间 (MFPT) $\\mathbb{E}[\\tau]$。在 $N\\to\\infty$ 和 $\\Delta t\\to 0$ 的极限下，该估计量是无偏的。\n\n算法设计：\n1.  选择物理常数和参数：玻尔兹曼常数 $k_{\\mathrm{B}} = 1.380\\,649\\times 10^{-23}\\ \\mathrm{J\\,K^{-1}}$，摩擦系数 $\\gamma = 1.0\\times 10^{-12}\\ \\mathrm{kg\\,s^{-1}}$，长度尺度 $L=1.0\\times 10^{-9}\\ \\mathrm{m}$，时间步长 $\\Delta t = 5.0\\times 10^{-14}\\ \\mathrm{s}$，轨迹数量 $N=64$，以及最大模拟时间 $t_{\\max}=1.0\\times 10^{-7}\\ \\mathrm{s}$。这些值使得欧拉-丸山方法稳定，并产生计算上易于处理且对于粘性溶剂中纳米尺度系统具有科学合理性的逃逸时间。\n2.  对于每个测试案例，根据给定的无量纲乘数 $h$ 计算绝对势垒高度\n    $$\n    H = h\\,k_{\\mathrm{B}}\\,T_{\\mathrm{ref}},\\quad T_{\\mathrm{ref}}=300\\ \\mathrm{K},\n    $$\n    并在指定的温度 $T$ 下进行模拟。\n3.  在 $x_{0}=-L$ 和 $t=0$ 处初始化 $N$ 个粒子。对于所有尚未逃逸（即 $x<0$）的粒子，使用欧拉-丸山步骤更新其位置。每一步之后，为那些新满足 $x\\ge 0$ 的粒子记录当前时间；将它们标记为已逃逸，并从后续更新中排除。\n4.  继续此过程，直到所有粒子都逃逸或 $t\\ge t_{\\max}$。将已逃逸粒子的首通时间的算术平均值作为 MFPT。如果没有粒子逃逸，则返回 $t_{\\max}$。\n5.  使用固定的随机种子以确保结果的可复现性。\n\n基本原理和预期。Kramers 逃逸率理论预测，对于过阻尼动力学，近似的平均逃逸时间尺度关系为\n$$\n\\mathrm{MFPT}\\propto \\frac{\\gamma}{\\sqrt{U''(x_{\\mathrm{m}})\\lvert U''(x_{\\mathrm{b}})\\rvert}} \\exp\\!\\left(\\frac{H}{k_{\\mathrm{B}}T}\\right),\n$$\n其中 $x_{\\mathrm{m}}$ 是阱极小值点，$x_{\\mathrm{b}}$ 是势垒顶部。对于四次势，$U''(\\pm L)=\\frac{8H}{L^{2}}$ 且 $U''(0)=-\\frac{4H}{L^{2}}$，因此指前因子与 $\\gamma L^{2}/H$ 成正比，而主导的依赖关系是 $H/(k_{\\mathrm{B}}T)$ 的指数项。我们的测试组旨在定性验证：在固定 $T$ 时增加 $H$ 会增加 MFPT，而在固定 $H$ 时增加 $T$ 会减少 MFPT。\n\n数值输出。对于以下四个案例：\n- 案例 A: $(h, T) = (2.0, 300.0\\ \\mathrm{K})$。\n- 案例 B: $(h, T) = (4.0, 300.0\\ \\mathrm{K})$。\n- 案例 C: $(h, T) = (4.0, 600.0\\ \\mathrm{K})$。\n- 案例 D: $(h, T) = (0.5, 300.0\\ \\mathrm{K})$。\n计算 MFPT（单位为秒），并以 `[tA,tB,tC,tD]` 的格式单行输出。所有时间必须以 $\\mathrm{s}$ 为单位，且每个条目必须是浮点数。", "answer": "```python\nimport numpy as np\n\ndef simulate_mfpt(h_multiplier, T, rng, params):\n    \"\"\"\n    Simulate MFPT for overdamped Langevin dynamics in a quartic double-well potential.\n    h_multiplier: dimensionless barrier height multiplier relative to k_B*T_ref.\n    T: absolute temperature in K.\n    rng: numpy random Generator for reproducibility.\n    params: dict of physical and numerical parameters.\n    Returns: estimated MFPT (float, seconds).\n    \"\"\"\n    # Unpack parameters\n    kB = params[\"kB\"]             # J/K\n    T_ref = params[\"T_ref\"]       # K\n    gamma = params[\"gamma\"]       # kg/s\n    L = params[\"L\"]               # m\n    dt = params[\"dt\"]             # s\n    N = params[\"N\"]               # number of trajectories\n    t_max = params[\"t_max\"]       # s\n\n    # Potential barrier height H in Joules\n    H = h_multiplier * kB * T_ref\n\n    # Precompute constants\n    inv_L2 = 1.0 / (L * L)\n    inv_L4 = inv_L2 * inv_L2\n    sigma = np.sqrt(2.0 * kB * T * dt / gamma)\n\n    # Initialize positions and status\n    x = np.full(N, -L, dtype=np.float64)\n    escaped = np.zeros(N, dtype=bool)\n    t_escape = np.full(N, np.nan, dtype=np.float64)\n\n    # Time loop\n    t = 0.0\n    max_steps = int(np.ceil(t_max / dt))\n    for _ in range(max_steps):\n        # Identify active walkers\n        active_idx = np.where(~escaped)[0]\n        if active_idx.size == 0:\n            break\n\n        xa = x[active_idx]\n\n        # Compute deterministic force: F = -dU/dx = H*(4x/L^2 - 4 x^3 / L^4)\n        # Derived from U = H[(x/L)^4 - 2(x/L)^2]\n        dUdx = H * (4.0 * xa**3 * inv_L4 - 4.0 * xa * inv_L2)\n        F = -dUdx\n\n        # Stochastic increment\n        noise = sigma * rng.standard_normal(size=xa.shape)\n\n        # Update positions\n        xa_new = xa + (dt / gamma) * F + noise\n        x[active_idx] = xa_new\n\n        # Advance time\n        t += dt\n\n        # Check for escape: crossing x >= 0\n        crossed = xa_new >= 0.0\n        if np.any(crossed):\n            crossed_idx = active_idx[crossed]\n            escaped[crossed_idx] = True\n            # Record current time as first-passage time\n            t_escape[crossed_idx] = t\n\n    # Compute MFPT: mean over escaped walkers\n    escaped_times = t_escape[~np.isnan(t_escape)]\n    if escaped_times.size == 0:\n        # Fallback if none escaped: return t_max\n        return float(t_max)\n    else:\n        return float(np.mean(escaped_times))\n\n\ndef solve():\n    # Fixed physical and numerical parameters\n    params = {\n        \"kB\": 1.380649e-23,     # Boltzmann constant, J/K\n        \"T_ref\": 300.0,         # reference temperature, K\n        \"gamma\": 1.0e-12,       # friction coefficient, kg/s\n        \"L\": 1.0e-9,            # length scale, m\n        \"dt\": 5.0e-14,          # time step, s\n        \"N\": 64,                # number of trajectories\n        \"t_max\": 1.0e-7,        # maximum time, s\n    }\n\n    # Test cases: (h_multiplier, Temperature K)\n    test_cases = [\n        (2.0, 300.0),  # Case A\n        (4.0, 300.0),  # Case B\n        (4.0, 600.0),  # Case C\n        (0.5, 300.0),  # Case D\n    ]\n\n    # Use fixed seed for reproducibility; vary per case to diversify streams\n    base_seed = 123456\n    results = []\n    for i, (h, T) in enumerate(test_cases):\n        rng = np.random.default_rng(base_seed + i)\n        mfpt = simulate_mfpt(h, T, rng, params)\n        results.append(mfpt)\n\n    # Print results in required single-line format\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2457132"}, {"introduction": "真实的分子系统很少是孤立的单粒子。本练习将我们的模型从单个粒子扩展到一个由谐振子弹簧连接的双粒子系统，这是理解分子内部振动与整体扩散运动关系的第一步。你将需要运用第一性原理，将耦合的运动方程解耦为质心运动和相对坐标运动，并推导出质心的扩散系数和相对坐标的平衡方差。这个练习强调了如何从微观动力学方程中提炼出宏观可观测量，是连接理论与模拟的关键一环。[@problem_id:2457138]", "problem": "考虑一个一维系统，包含两个粒子，沉浸在绝对温度为 $T$ 的热浴中，并通过一个谐波弹簧相互作用。设粒子位置为 $x_1(t)$ 和 $x_2(t)$，速度为 $v_1(t)$ 和 $v_2(t)$，质量为 $m_1$ 和 $m_2$，摩擦系数为 $\\gamma_1$ 和 $\\gamma_2$，所有单位均采用国际单位制（SI）。相互作用势为 $U(r) = \\tfrac{1}{2} k r^2$，其中 $r = x_2 - x_1$，$k$ 为弹簧常数。欠阻尼朗之万方程为\n$$\nm_1 \\,\\frac{d v_1}{dt} = -\\gamma_1 \\, v_1 - \\frac{\\partial U}{\\partial x_1} + \\sqrt{2 k_{\\mathrm{B}} T \\,\\gamma_1}\\;\\xi_1(t), \\quad \\frac{d x_1}{dt} = v_1,\n$$\n$$\nm_2 \\,\\frac{d v_2}{dt} = -\\gamma_2 \\, v_2 - \\frac{\\partial U}{\\partial x_2} + \\sqrt{2 k_{\\mathrm{B}} T \\,\\gamma_2}\\;\\xi_2(t), \\quad \\frac{d x_2}{dt} = v_2,\n$$\n其中 $k_{\\mathrm{B}}$ 是玻尔兹曼常数，$\\xi_1(t)$ 和 $\\xi_2(t)$ 是独立的标准高斯白噪声，满足 $\\langle \\xi_i(t) \\rangle = 0$ 和 $\\langle \\xi_i(t)\\,\\xi_j(t') \\rangle = \\delta_{ij}\\,\\delta(t-t')$。定义质心坐标\n$$\nX(t) = \\frac{m_1 x_1(t) + m_2 x_2(t)}{m_1 + m_2},\n$$\n和相对坐标 $r(t) = x_2(t) - x_1(t)$。\n\n任务。根据第一性原理，确定：\n- 质心坐标 $X(t)$ 的闭式长时扩散系数 $D_X$，单位为 $\\mathrm{m^2/s}$，\n- 相对坐标 $r(t)$ 的平衡方差 $\\mathrm{Var}(r)$，单位为 $\\mathrm{m^2}$。\n\n所有输入和输出均使用国际单位制（SI）。玻尔兹曼常数取 $k_{\\mathrm{B}} = 1.380\\,649 \\times 10^{-23}\\ \\mathrm{J/K}$（根据定义为精确值）。您的程序必须为下面的测试套件中的每组参数计算 $D_X$ 和 $\\mathrm{Var}(r)$，并按规定格式生成结果。\n\n测试套件（每种情况为 $(m_1,\\ m_2,\\ \\gamma_1,\\ \\gamma_2,\\ k,\\ T)$）：\n- 情况 A：$m_1 = 1.0 \\times 10^{-26}\\ \\mathrm{kg}$，$m_2 = 2.0 \\times 10^{-26}\\ \\mathrm{kg}$，$\\gamma_1 = 8.0 \\times 10^{-12}\\ \\mathrm{kg/s}$，$\\gamma_2 = 1.2 \\times 10^{-11}\\ \\mathrm{kg/s}$，$k = 1.0 \\times 10^{-3}\\ \\mathrm{N/m}$，$T = 300\\ \\mathrm{K}$。\n- 情况 B：$m_1 = 5.0 \\times 10^{-26}\\ \\mathrm{kg}$，$m_2 = 5.0 \\times 10^{-26}\\ \\mathrm{kg}$，$\\gamma_1 = 1.0 \\times 10^{-11}\\ \\mathrm{kg/s}$，$\\gamma_2 = 1.0 \\times 10^{-11}\\ \\mathrm{kg/s}$，$k = 5.0 \\times 10^{-3}\\ \\mathrm{N/m}$，$T = 300\\ \\mathrm{K}$。\n- 情况 C：$m_1 = 1.0 \\times 10^{-25}\\ \\mathrm{kg}$，$m_2 = 3.0 \\times 10^{-26}\\ \\mathrm{kg}$，$\\gamma_1 = 1.0 \\times 10^{-9}\\ \\mathrm{kg/s}$，$\\gamma_2 = 2.0 \\times 10^{-9}\\ \\mathrm{kg/s}$，$k = 1.0 \\times 10^{-1}\\ \\mathrm{N/m}$，$T = 310\\ \\mathrm{K}$。\n- 情况 D：$m_1 = 2.0 \\times 10^{-26}\\ \\mathrm{kg}$，$m_2 = 8.0 \\times 10^{-27}\\ \\mathrm{kg}$，$\\gamma_1 = 5.0 \\times 10^{-12}\\ \\mathrm{kg/s}$，$\\gamma_2 = 2.0 \\times 10^{-11}\\ \\mathrm{kg/s}$，$k = 1.0 \\times 10^{-4}\\ \\mathrm{N/m}$，$T = 100\\ \\mathrm{K}$。\n\n要求的最终输出格式。您的程序应生成单行输出，包含一个长度为 4 的列表，其中每个元素是对应于测试用例 A、B、C、D 的一个双元素列表 $[D_X,\\ \\mathrm{Var}(r)]$。所有数字必须以科学记数法打印，小数点后精确到 10 位。例如，一个有效的输出格式为\n$$\n\\big[ [a_1,\\ b_1],\\ [a_2,\\ b_2],\\ [a_3,\\ b_3],\\ [a_4,\\ b_4] \\big],\n$$\n其中每个 $a_i$ 是 $D_X$（单位 $\\mathrm{m^2/s}$），每个 $b_i$ 是 $\\mathrm{Var}(r)$（单位 $\\mathrm{m^2}$），所有数字都使用指定的数值格式打印。", "solution": "问题陈述经过了严格的验证。\n\n**第 1 步：提取已知条件**\n\n该系统包含两个粒子，其位置为 $x_1(t)$ 和 $x_2(t)$，速度为 $v_1(t)$ 和 $v_2(t)$，质量为 $m_1$ 和 $m_2$，摩擦系数为 $\\gamma_1$ 和 $\\gamma_2$。系统处于绝对温度为 $T$ 的热浴中。所有单位均为国际单位制。\n\n相互作用势为 $U(r) = \\tfrac{1}{2} k r^2$，其中 $r = x_2 - x_1$。\n\n给出了欠阻尼朗之万运动方程：\n$$\nm_1 \\,\\frac{d v_1}{dt} = -\\gamma_1 \\, v_1 - \\frac{\\partial U}{\\partial x_1} + \\sqrt{2 k_{\\mathrm{B}} T \\,\\gamma_1}\\;\\xi_1(t), \\quad \\frac{d x_1}{dt} = v_1\n$$\n$$\nm_2 \\,\\frac{d v_2}{dt} = -\\gamma_2 \\, v_2 - \\frac{\\partial U}{\\partial x_2} + \\sqrt{2 k_{\\mathrm{B}} T \\,\\gamma_2}\\;\\xi_2(t), \\quad \\frac{d x_2}{dt} = v_2\n$$\n玻尔兹曼常数为 $k_{\\mathrm{B}} = 1.380\\,649 \\times 10^{-23}\\ \\mathrm{J/K}$。\n噪声项 $\\xi_1(t)$ 和 $\\xi_2(t)$ 是独立的标准高斯白噪声，满足 $\\langle \\xi_i(t) \\rangle = 0$ 和 $\\langle \\xi_i(t)\\,\\xi_j(t') \\rangle = \\delta_{ij}\\,\\delta(t-t')$。\n\n质心坐标定义为 $X(t) = \\frac{m_1 x_1(t) + m_2 x_2(t)}{m_1 + m_2}$。\n相对坐标定义为 $r(t) = x_2(t) - x_1(t)$。\n\n任务是确定质心的长时扩散系数 $D_X$ 和相对坐标的平衡方差 $\\mathrm{Var}(r)$。\n\n测试套件提供了四组参数 $(m_1,\\ m_2,\\ \\gamma_1,\\ \\gamma_2,\\ k,\\ T)$。\n\n**第 2 步：使用提取的已知条件进行验证**\n\n根据验证标准对问题进行分析。\n\n-   **科学基础**：该问题是统计力学中的一个经典练习，描述了两个谐波耦合粒子进行布朗运动。朗之万方程是该物理模型的正确且标准的理论框架。所有概念都是物理学和计算化学的基础。\n-   **适定性**：该问题要求两个具体、明确定义的物理量（$D_X$ 和 $\\mathrm{Var}(r)$），这些量可以从给定的运动方程和统计力学原理中推导出来。所有必要的参数和常数都已提供。存在唯一且有意义的解。\n-   **客观性**：问题以精确的数学和物理术语陈述，没有任何主观性或歧义。\n\n该问题被认为是科学合理、适定且客观的。它不违反任何无效标准。\n\n**第 3 步：结论与行动**\n\n问题是**有效的**。将从第一性原理推导求解。\n\n**质心扩散系数 $D_X$ 的推导**\n\n质心坐标由 $X = \\frac{m_1 x_1 + m_2 x_2}{M}$ 给出，其中 $M = m_1 + m_2$ 是总质量。质心速度为 $V = \\frac{dX}{dt} = \\frac{m_1 v_1 + m_2 v_2}{M}$。\n\n我们通过对总动量 $P = MV = m_1 v_1 + m_2 v_2$ 求时间导数来建立质心的运动方程。\n$$\n\\frac{dP}{dt} = m_1 \\frac{dv_1}{dt} + m_2 \\frac{dv_2}{dt}\n$$\n代入给定的朗之万方程：\n$$\n\\frac{dP}{dt} = \\left(-\\gamma_1 v_1 - \\frac{\\partial U}{\\partial x_1} + \\sqrt{2 k_{\\mathrm{B}} T \\gamma_1} \\xi_1(t)\\right) + \\left(-\\gamma_2 v_2 - \\frac{\\partial U}{\\partial x_2} + \\sqrt{2 k_{\\mathrm{B}} T \\gamma_2} \\xi_2(t)\\right)\n$$\n来自势能 $U(r) = \\frac{1}{2} k (x_2 - x_1)^2$ 的力项为：\n$$\n\\frac{\\partial U}{\\partial x_1} = k(x_2 - x_1) \\frac{\\partial (x_2 - x_1)}{\\partial x_1} = -k(x_2 - x_1) = -kr\n$$\n$$\n\\frac{\\partial U}{\\partial x_2} = k(x_2 - x_1) \\frac{\\partial (x_2 - x_1)}{\\partial x_2} = k(x_2 - x_1) = kr\n$$\n内力之和为 $-\\frac{\\partial U}{\\partial x_1} - \\frac{\\partial U}{\\partial x_2} = -(-kr) - (kr) = 0$。这是牛顿第三定律的结果；内力不能改变系统的总动量。\n\n总动量方程简化为：\n$$\n\\frac{dP}{dt} = -\\gamma_1 v_1 - \\gamma_2 v_2 + \\Xi(t)\n$$\n其中 $\\Xi(t) = \\sqrt{2 k_{\\mathrm{B}} T \\gamma_1} \\xi_1(t) + \\sqrt{2 k_{\\mathrm{B}} T \\gamma_2} \\xi_2(t)$ 是总随机力。\n\n长时扩散系数 $D_X$ 是系统在过阻尼极限下的一个性质，在该极限下，速度动力学被认为远快于位置动力学。在这种情况下，系统作为一个整体运动。以速度 $V$ 运动的复合体所受的总阻力是其各组分所受阻力之和，假设它们都以速度 $V$ 运动：$F_{\\text{drag}} = -\\gamma_1 V - \\gamma_2 V = -(\\gamma_1 + \\gamma_2)V$。这定义了质心的有效摩擦系数 $\\gamma_X = \\gamma_1 + \\gamma_2$。\n\n在这种长时极限下，质心的朗之万方程变为：\n$$\nM \\frac{dV}{dt} \\approx -\\gamma_X V + \\Xi(t)\n$$\n总随机力 $\\Xi(t)$ 必须满足与有效摩擦 $\\gamma_X$ 相关的涨落-耗散定理。我们来验证这一点。$\\Xi(t)$ 的自相关函数为：\n$$\n\\langle \\Xi(t) \\Xi(t') \\rangle = \\langle (\\sqrt{2 k_{\\mathrm{B}} T \\gamma_1} \\xi_1(t) + \\sqrt{2 k_{\\mathrm{B}} T \\gamma_2} \\xi_2(t)) (\\sqrt{2 k_{\\mathrm{B}} T \\gamma_1} \\xi_1(t') + \\sqrt{2 k_{\\mathrm{B}} T \\gamma_2} \\xi_2(t')) \\rangle\n$$\n利用噪声项的独立性 $\\langle \\xi_i(t) \\xi_j(t') \\rangle = \\delta_{ij} \\delta(t-t')$，交叉项消失：\n$$\n\\langle \\Xi(t) \\Xi(t') \\rangle = (2 k_{\\mathrm{B}} T \\gamma_1 \\langle \\xi_1(t) \\xi_1(t') \\rangle + 2 k_{\\mathrm{B}} T \\gamma_2 \\langle \\xi_2(t) \\xi_2(t') \\rangle)\n$$\n$$\n\\langle \\Xi(t) \\Xi(t') \\rangle = (2 k_{\\mathrm{B}} T \\gamma_1 + 2 k_{\\mathrm{B}} T \\gamma_2) \\delta(t-t') = 2 k_{\\mathrm{B}} T (\\gamma_1 + \\gamma_2) \\delta(t-t') = 2 k_{\\mathrm{B}} T \\gamma_X \\delta(t-t')\n$$\n这证实了总随机力的统计特性与有效摩擦系数 $\\gamma_X = \\gamma_1 + \\gamma_2$ 是一致的。\n\n长时扩散系数由爱因斯坦-斯摩鲁霍夫斯基关系式给出，该关系式将扩散与温度和摩擦联系起来：\n$$\nD_X = \\frac{k_{\\mathrm{B}} T}{\\gamma_X}\n$$\n因此，质心扩散系数的最终表达式为：\n$$\nD_X = \\frac{k_{\\mathrm{B}} T}{\\gamma_1 + \\gamma_2}\n$$\n此结果与质量 $m_1, m_2$ 和弹簧常数 $k$ 无关，因为这些参数只影响短时动力学和内部运动，而不影响系统作为一个整体的长时扩散行为。\n\n**相对坐标平衡方差 $\\mathrm{Var}(r)$ 的推导**\n\n问题要求相对坐标的平衡方差，$\\mathrm{Var}(r) = \\langle (r - \\langle r \\rangle)^2 \\rangle_{eq}$。系统在温度 $T$ 下处于热平衡状态。任何坐标 $q$ 的概率分布都由玻尔兹曼分布决定，$P(q) \\propto \\exp(-U(q)/(k_{\\mathrm{B}}T))$，其中 $U(q)$ 是与该坐标相关的势能。\n\n对于相对坐标 $r = x_2 - x_1$，势能为 $U(r) = \\frac{1}{2} k r^2$。$r$ 的平衡概率分布为：\n$$\nP_{eq}(r) = C \\exp\\left(-\\frac{U(r)}{k_{\\mathrm{B}}T}\\right) = C \\exp\\left(-\\frac{k r^2}{2 k_{\\mathrm{B}}T}\\right)\n$$\n其中 $C$ 是归一化常数。这是一个高斯分布。由于势能 $U(r)$ 关于 $r=0$ 对称，相对坐标在平衡时的平均值必须为零：$\\langle r \\rangle_{eq} = 0$。\n\n因此，方差等于均方位移：\n$$\n\\mathrm{Var}(r) = \\langle r^2 \\rangle_{eq}\n$$\n我们可以通过直接应用能量均分定理来找到 $\\langle r^2 \\rangle_{eq}$。势能 $U(r) = \\frac{1}{2} k r^2$ 是坐标 $r$ 的一个二次项。能量均分定理指出，在热平衡状态下，系统哈密顿量中每个二次自由度对平均总能量的贡献为 $\\frac{1}{2} k_{\\mathrm{B}} T$。\n因此，平均势能为：\n$$\n\\langle U(r) \\rangle_{eq} = \\left\\langle \\frac{1}{2} k r^2 \\right\\rangle_{eq} = \\frac{1}{2} k_{\\mathrm{B}} T\n$$\n由此，我们可以解出 $\\langle r^2 \\rangle_{eq}$：\n$$\n\\frac{1}{2} k \\langle r^2 \\rangle_{eq} = \\frac{1}{2} k_{\\mathrm{B}} T \\implies \\langle r^2 \\rangle_{eq} = \\frac{k_{\\mathrm{B}} T}{k}\n$$\n所以，相对坐标的平衡方差是：\n$$\n\\mathrm{Var}(r) = \\frac{k_{\\mathrm{B}} T}{k}\n$$\n此结果仅取决于温度 $T$ 和弹簧常数 $k$，因为这些是定义势能形貌和可用于探索它的热能的参数。质量和摩擦系数影响达到平衡所需的时间，但不影响平衡态本身的性质。\n\n**计算公式总结**\n1.  质心扩散系数：$D_X = \\frac{k_{\\mathrm{B}} T}{\\gamma_1 + \\gamma_2}$\n2.  相对坐标的平衡方差：$\\mathrm{Var}(r) = \\frac{k_{\\mathrm{B}} T}{k}$", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the center-of-mass diffusion coefficient and relative coordinate\n    variance for a two-particle system described by Langevin dynamics.\n    \"\"\"\n    # Define the Boltzmann constant in SI units (J/K)\n    k_B = 1.380649e-23\n\n    # Test Suite: each case is (m1, m2, gamma1, gamma2, k, T) in SI units.\n    test_cases = [\n        # Case A\n        (1.0e-26, 2.0e-26, 8.0e-12, 1.2e-11, 1.0e-3, 300.0),\n        # Case B\n        (5.0e-26, 5.0e-26, 1.0e-11, 1.0e-11, 5.0e-3, 300.0),\n        # Case C\n        (1.0e-25, 3.0e-26, 1.0e-9, 2.0e-9, 1.0e-1, 310.0),\n        # Case D\n        (2.0e-26, 8.0e-27, 5.0e-12, 2.0e-11, 1.0e-4, 100.0),\n    ]\n\n    all_results = []\n    for case in test_cases:\n        m1, m2, gamma1, gamma2, k, T = case\n\n        # Calculate the long-time diffusion coefficient of the center of mass, D_X.\n        # D_X = k_B * T / (gamma1 + gamma2)\n        # This follows from the Einstein-Smoluchowski relation for a composite particle\n        # with an effective friction coefficient gamma_X = gamma1 + gamma2.\n        d_x = k_B * T / (gamma1 + gamma2)\n\n        # Calculate the equilibrium variance of the relative coordinate, Var(r).\n        # Var(r) = k_B * T / k\n        # This follows from the equipartition theorem applied to the harmonic potential U(r).\n        var_r = k_B * T / k\n        \n        all_results.append([d_x, var_r])\n\n    # Format the output as a single line string as requested.\n    # Each number in scientific notation with 10 decimal places.\n    result_str = \", \".join([f\"[{res[0]:.10e}, {res[1]:.10e}]\" for res in all_results])\n    print(f\"[{result_str}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2457138"}, {"introduction": "数值模拟的准确性和稳定性在很大程度上取决于所选积分算法的优劣，尤其是在处理具有挑战性的系统时。本练习通过一个特殊的“尖点”势（$V(x) = k|x|$）来检验不同数值积分器的表现，该势的力在原点是不连续的。你将比较简单的欧拉-丸山法和更高级的辛几何分裂法在欠阻尼和过阻尼两种动力学模型下的表现，从而深刻体会到选择合适积分器对于保证模拟结果可靠性的重要性。[@problem_id:2457165]", "problem": "考虑一个在尖点势中进行一维空间运动的单粒子。设势函数定义为 $V(x)=k \\lvert x \\rvert$，其中 $k>0$ 是一个常数。力是负梯度（在尖点处解释为次梯度），此处取为 $F(x)=-\\frac{dV}{dx}=-k\\,\\mathrm{sign}(x)$，其中 $\\mathrm{sign}(0)=0$。计算完全在简化的无量纲单位下进行，粒子质量 $m=1$，玻尔兹曼常数 $k_{\\mathrm{B}}=1$。温度 $T$ 于是用与能量相同的单位表示。\n\n需要考虑两种随机动力学模型：\n\n- 欠阻尼朗之万动力学（含惯性项）：\n  $$dx_t=v_t\\,dt,$$\n  $$dv_t=\\left(-\\gamma\\,v_t+F(x_t)\\right)\\,dt+\\sqrt{2\\,\\gamma\\,T}\\,dW_t,$$\n  其中 $\\gamma>0$ 是摩擦系数，$W_t$ 是标准维纳过程。\n\n- 过阻尼布朗动力学（高摩擦极限）：\n  $$dx_t=\\mu\\,F(x_t)\\,dt+\\sqrt{2\\,D}\\,dW_t,$$\n  其中迁移率为 $\\mu=\\frac{1}{\\gamma}$，扩散系数为 $D=\\mu\\,T=\\frac{T}{\\gamma}$。\n\n对于此势函数，在热平衡状态下，其稳态位置分布是拉普拉斯分布，密度正比于 $\\exp\\!\\left(-\\frac{k\\lvert x\\rvert}{T}\\right)$。因此，精确的平衡平均绝对位置为\n$$\\mathbb{E}\\left[\\lvert X \\rvert\\right]=\\frac{T}{k}.$$\n\n模拟中使用的离散时间更新规则规定如下。设 $R_n$ 表示独立同分布的标准正态随机变量（均值为0，方差为1）。\n\n- 欠阻尼积分器 U1（速度的显式 Euler–Maruyama 方法，显式位置更新）：\n  $$v_{n+1}=v_n+\\Delta t\\left(-\\gamma\\,v_n+F(x_n)\\right)+\\sqrt{2\\,\\gamma\\,T}\\,\\sqrt{\\Delta t}\\,R_n,$$\n  $$x_{n+1}=x_n+\\Delta t\\,v_n.$$\n\n- 欠阻尼积分器 U2（一种对称的 Strang 分裂积分器，包含一个精确的 Ornstein–Uhlenbeck 恒温步骤；在文献中通常称为 BAOAB）：\n  定义 $a=\\exp(-\\gamma\\,\\Delta t)$ 和 $b=\\sqrt{T\\,(1-a^2)}$。然后在每个步骤执行以下序列：\n  1. 半步踢： $$v\\leftarrow v+\\frac{\\Delta t}{2}\\,F(x).$$\n  2. 半步漂移： $$x\\leftarrow x+\\frac{\\Delta t}{2}\\,v.$$\n  3. Ornstein–Uhlenbeck（恒温器）： $$v\\leftarrow a\\,v+b\\,R_n.$$\n  4. 半步漂移： $$x\\leftarrow x+\\frac{\\Delta t}{2}\\,v.$$\n  5. 半步踢： $$v\\leftarrow v+\\frac{\\Delta t}{2}\\,F(x).$$\n\n- 过阻尼积分器 O1（显式 Euler–Maruyama）：\n  $$x_{n+1}=x_n+\\mu\\,F(x_n)\\,\\Delta t+\\sqrt{2\\,D\\,\\Delta t}\\,R_n.$$\n\n- 过阻尼积分器 O2（漂移项使用隐式欧拉方法，对于尖点势存在闭式解更新）。设 $y=x_n+\\sqrt{2\\,D\\,\\Delta t}\\,R_n$ 且 $a=\\mu\\,k\\,\\Delta t$。然后更新\n  $$x_{n+1}=\\mathrm{sign}(y)\\,\\max\\!\\left(\\lvert y\\rvert-a,\\,0\\right).$$\n\n在所有模拟中，使用初始条件 $x_0=0$ 和 $v_0=0$（对于欠阻尼情况）、固定的时间步数 $N$，以及 $N_{\\mathrm{burn}}$ 步的“预烧”期（burn-in），这些步骤在计算平均值时被丢弃。使用固定的伪随机种子 $s$ 来初始化高斯随机变量 $R_n$ 的生成，以使结果可复现。在预烧期之后，计算绝对位置的时间平均值，\n$$\\overline{m}=\\frac{1}{N-N_{\\mathrm{burn}}}\\sum_{n=N_{\\mathrm{burn}}+1}^{N} \\lvert x_n\\rvert,$$\n并报告相对于精确值 $T/k$ 的绝对误差，\n$$\\varepsilon=\\left\\lvert \\overline{m}-\\frac{T}{k}\\right\\rvert.$$\n\n测试套件。对于以下每个参数集，运行相应的模拟，并以浮点数形式返回 $\\varepsilon$ 的值。\n\n- 测试 1（过阻尼，显式）：O1，参数为 $k=1$，$T=1$，$\\gamma=5$，$\\Delta t=0.05$，$N=200000$，$N_{\\mathrm{burn}}=20000$，$s=12345$。\n- 测试 2（过阻尼，隐式）：O2，参数为 $k=1$，$T=1$，$\\gamma=5$，$\\Delta t=0.05$，$N=200000$，$N_{\\mathrm{burn}}=20000$，$s=12345$。\n- 测试 3（欠阻尼，显式）：U1，参数为 $k=1$，$T=1$，$\\gamma=1$，$\\Delta t=0.001$，$N=200000$，$N_{\\mathrm{burn}}=20000$，$s=12345$。\n- 测试 4（欠阻尼，分裂法）：U2，参数为 $k=1$，$T=1$，$\\gamma=1$，$\\Delta t=0.01$，$N=200000$，$N_{\\mathrm{burn}}=20000$，$s=12345$。\n\n角度单位不适用。所有报告的量均为无量纲。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[\\varepsilon_1,\\varepsilon_2,\\varepsilon_3,\\varepsilon_4]$），结果的顺序与上述测试用例的顺序相同。", "solution": "所提出的问题是统计力学领域中一个定义明确的计算练习，具体涉及随机微分方程的数值积分。所有参数、初始条件和数值方案都得到了明确的规定。尖点势中粒子在朗之万或布朗动力学下的基础物理模型是科学合理的，并且提供的理论平衡期望值 $\\mathbb{E}\\left[\\lvert X \\rvert\\right]=\\frac{T}{k}$ 是正确的。因此，该问题是有效的，可以构建一个解。\n\n目标是使用四种不同的数值积分方案，模拟一个在一维空间中由势 $V(x)=k \\lvert x \\rvert$ 控制的单个粒子的轨迹。对于每种方案，我们必须在初始预烧期后计算时间平均绝对位置 $\\overline{m}$，并报告相对于精确解析结果的绝对误差 $\\varepsilon=\\left\\lvert \\overline{m}-\\frac{T}{k}\\right\\rvert$。粒子质量 $m$、玻尔兹曼常数 $k_{\\mathrm{B}}$ 和势常数 $k$ 在无量纲单位下均设为 $1$，温度为 $T=1$。因此，用于比较的精确值为 $\\mathbb{E}\\left[\\lvert X \\rvert\\right]=\\frac{1}{1}=1$。\n\n所有模拟都从初始状态 $x_0=0$ 开始，对于欠阻尼情况，还有 $v_0=0$。使用固定的伪随机种子 $s=12345$ 来初始化标准正态随机数 $R_n$ 的生成器，以确保所有测试的可复现性。总共执行 $N=200000$ 步，其中前 $N_{\\mathrm{burn}}=20000$ 步被丢弃，以使系统达到平衡。平均值在余下的 $N-N_{\\mathrm{burn}}=180000$ 步上计算。\n\n实现将包括四个不同的函数，每个函数对应一个测试用例。\n\n**测试 1：过阻尼 Euler–Maruyama 积分器 (O1)**\n该测试采用过阻尼布朗动力学方程：\n$$dx_t=\\mu\\,F(x_t)\\,dt+\\sqrt{2\\,D}\\,dW_t$$\n其中 $\\mu=1/\\gamma$ 且 $D=T/\\gamma$。最简单的数值离散化是显式 Euler–Maruyama 方案，由下式给出：\n$$x_{n+1}=x_n+\\mu\\,F(x_n)\\,\\Delta t+\\sqrt{2\\,D\\,\\Delta t}\\,R_n$$\n对于此测试，参数为 $k=1$，$T=1$，$\\gamma=5$，$\\Delta t=0.05$。这得出 $\\mu=1/5=0.2$ 和 $D=1/5=0.2$。力为 $F(x_n)=-k\\,\\mathrm{sign}(x_n)=-\\mathrm{sign}(x_n)$。模拟循环将直接实现此更新规则，执行 $N$ 步，并累加 $n > N_{\\mathrm{burn}}$ 时的 $\\lvert x_n \\rvert$。\n\n**测试 2：过阻尼分裂积分器 (O2)**\n该测试使用相同的过阻尼动力学，但采用更复杂的积分器。更新分两步执行：一个随机“踢”，然后是在动力学的确定性部分下的精确演化。\n1. 应用随机踢：$y=x_n+\\sqrt{2\\,D\\,\\Delta t}\\,R_n$。\n2. 应用确定性演化：方程 $\\dot{x} = \\mu F(x) = -\\mu k\\,\\mathrm{sign}(x)$ 从 $y$ 开始，对时间 $\\Delta t$ 进行精确求解。解为 $x(\\Delta t)=\\mathrm{sign}(y)\\,\\max(\\lvert y\\rvert-\\mu k\\,\\Delta t,\\,0)$。\n这给出了更新规则：\n$$x_{n+1}=\\mathrm{sign}(y)\\,\\max\\!\\left(\\lvert y\\rvert-a,\\,0\\right)$$\n其中 $a=\\mu\\,k\\,\\Delta t$。参数与测试 1 相同，从而可以直接比较积分器的精度。对于像尖点这样具有尖锐特征的势，此方法通常更稳定。\n\n**测试 3：欠阻尼 Euler–Maruyama 积分器 (U1)**\n该测试考虑包含惯性项的欠阻尼朗之万动力学：\n$$dx_t=v_t\\,dt$$\n$$dv_t=\\left(-\\gamma\\,v_t+F(x_t)\\right)\\,dt+\\sqrt{2\\,\\gamma\\,T}\\,dW_t$$\n积分器 (U1) 是一个简单的显式方案：\n$$v_{n+1}=v_n+\\Delta t\\left(-\\gamma\\,v_n+F(x_n)\\right)+\\sqrt{2\\,\\gamma\\,T}\\,\\sqrt{\\Delta t}\\,R_n$$\n$$x_{n+1}=x_n+\\Delta t\\,v_n$$\n请注意，位置是使用时间步开始时的速度 $v_n$ 来更新的。参数为 $k=1$，$T=1$，$\\gamma=1$，以及一个较小的时间步 $\\Delta t=0.001$，这是由于该显式方法的稳定性有限所必需的。\n\n**测试 4：欠阻尼分裂积分器 (U2 / BAOAB)**\n该测试使用一种更稳健的几何积分器，称为 BAOAB，它是朗之万算符的对称 Strang 分裂。动力学被分裂为三个部分：力作用下的确定性运动 (B)，确定性漂移 (A)，以及根据 Ornstein–Uhlenbeck 过程进行的随机速度更新 (O)。序列为 BAOAB：\n1. **B (力)：** 更新半个时间步的速度：$v\\leftarrow v+\\frac{\\Delta t}{2}\\,F(x)$。\n2. **A (漂移)：** 更新半个时间步的位置：$x\\leftarrow x+\\frac{\\Delta t}{2}\\,v$。\n3. **O (恒温器)：** 对整个时间步精确更新速度：$v\\leftarrow a\\,v+b\\,R_n$，其中 $a=\\exp(-\\gamma\\,\\Delta t)$，$b=\\sqrt{T\\,(1-a^2)}$。\n4. **A (漂移)：** 更新第二个半时间步的位置：$x\\leftarrow x+\\frac{\\Delta t}{2}\\,v$。\n5. **B (力)：** 更新第二个半时间步的速度：$v\\leftarrow v+\\frac{\\Delta t}{2}\\,F(x)$。\n这种对称分裂在保持平衡分布方面提供了更好的长期稳定性和准确性，与 U1 相比，允许使用更大的时间步 $\\Delta t=0.01$。\n\n对于每个测试，将执行模拟，计算平均绝对位置 $\\overline{m}$，并确定绝对误差 $\\varepsilon$。四个产生的误差值将被收集并按要求格式化。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef force(x: float, k: float) -> float:\n    \"\"\"Calculates the force F(x) = -k * sign(x).\"\"\"\n    return -k * np.sign(x)\n\ndef run_test1_o1(k: float, T: float, gamma: float, dt: float, N: int, N_burn: int, seed: int) -> float:\n    \"\"\"\n    Test 1: Overdamped, explicit Euler-Maruyama integrator (O1).\n    \"\"\"\n    x = 0.0\n    mu = 1.0 / gamma\n    D = T / gamma\n    stochastic_term_coeff = np.sqrt(2 * D * dt)\n    rng = np.random.default_rng(seed)\n    \n    total_abs_x = 0.0\n    \n    for n in range(N):\n        R_n = rng.standard_normal()\n        drift_term = mu * force(x, k) * dt\n        stochastic_term = stochastic_term_coeff * R_n\n        x = x + drift_term + stochastic_term\n        \n        if n >= N_burn:\n            total_abs_x += np.abs(x)\n            \n    m_bar = total_abs_x / (N - N_burn)\n    exact_m = T / k\n    error = np.abs(m_bar - exact_m)\n    return error\n\ndef run_test2_o2(k: float, T: float, gamma: float, dt: float, N: int, N_burn: int, seed: int) -> float:\n    \"\"\"\n    Test 2: Overdamped, implicit/splitting integrator (O2).\n    \"\"\"\n    x = 0.0\n    mu = 1.0 / gamma\n    D = T / gamma\n    stochastic_term_coeff = np.sqrt(2 * D * dt)\n    a_param = mu * k * dt\n    rng = np.random.default_rng(seed)\n    \n    total_abs_x = 0.0\n    \n    for n in range(N):\n        R_n = rng.standard_normal()\n        y = x + stochastic_term_coeff * R_n\n        x = np.sign(y) * max(np.abs(y) - a_param, 0.0)\n        \n        if n >= N_burn:\n            total_abs_x += np.abs(x)\n            \n    m_bar = total_abs_x / (N - N_burn)\n    exact_m = T / k\n    error = np.abs(m_bar - exact_m)\n    return error\n\ndef run_test3_u1(k: float, T: float, gamma: float, dt: float, N: int, N_burn: int, seed: int) -> float:\n    \"\"\"\n    Test 3: Underdamped, explicit Euler-Maruyama integrator (U1).\n    \"\"\"\n    x, v = 0.0, 0.0\n    stochastic_term_coeff = np.sqrt(2 * gamma * T * dt)\n    rng = np.random.default_rng(seed)\n    \n    total_abs_x = 0.0\n    \n    for n in range(N):\n        R_n = rng.standard_normal()\n        \n        v_new = v + dt * (-gamma * v + force(x, k)) + stochastic_term_coeff * R_n\n        x_new = x + dt * v\n        \n        x, v = x_new, v_new\n        \n        if n >= N_burn:\n            total_abs_x += np.abs(x)\n            \n    m_bar = total_abs_x / (N - N_burn)\n    exact_m = T / k\n    error = np.abs(m_bar - exact_m)\n    return error\n\ndef run_test4_u2(k: float, T: float, gamma: float, dt: float, N: int, N_burn: int, seed: int) -> float:\n    \"\"\"\n    Test 4: Underdamped, BAOAB splitting integrator (U2).\n    \"\"\"\n    x, v = 0.0, 0.0\n    a_param = np.exp(-gamma * dt)\n    b_param = np.sqrt(T * (1 - a_param**2))\n    dt_half = dt / 2.0\n    rng = np.random.default_rng(seed)\n    \n    total_abs_x = 0.0\n    \n    for n in range(N):\n        # 1. B (Half kick)\n        v = v + dt_half * force(x, k)\n        \n        # 2. A (Half drift)\n        x = x + dt_half * v\n        \n        # 3. O (Thermostat)\n        R_n = rng.standard_normal()\n        v = a_param * v + b_param * R_n\n        \n        # 4. A (Half drift)\n        x = x + dt_half * v\n        \n        # 5. B (Half kick)\n        v = v + dt_half * force(x, k)\n        \n        if n >= N_burn:\n            total_abs_x += np.abs(x)\n            \n    m_bar = total_abs_x / (N - N_burn)\n    exact_m = T / k\n    error = np.abs(m_bar - exact_m)\n    return error\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test 1: O1\n        {\"func\": run_test1_o1, \"params\": {'k': 1, 'T': 1, 'gamma': 5, 'dt': 0.05, 'N': 200000, 'N_burn': 20000, 'seed': 12345}},\n        # Test 2: O2\n        {\"func\": run_test2_o2, \"params\": {'k': 1, 'T': 1, 'gamma': 5, 'dt': 0.05, 'N': 200000, 'N_burn': 20000, 'seed': 12345}},\n        # Test 3: U1\n        {\"func\": run_test3_u1, \"params\": {'k': 1, 'T': 1, 'gamma': 1, 'dt': 0.001, 'N': 200000, 'N_burn': 20000, 'seed': 12345}},\n        # Test 4: U2\n        {\"func\": run_test4_u2, \"params\": {'k': 1, 'T': 1, 'gamma': 1, 'dt': 0.01, 'N': 200000, 'N_burn': 20000, 'seed': 12345}},\n    ]\n\n    results = []\n    for case in test_cases:\n        result = case[\"func\"](**case[\"params\"])\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "2457165"}]}