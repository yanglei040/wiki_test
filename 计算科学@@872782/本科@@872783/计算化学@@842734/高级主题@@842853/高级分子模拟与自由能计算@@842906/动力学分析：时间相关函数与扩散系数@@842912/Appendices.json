{"hands_on_practices": [{"introduction": "平衡态模拟的一个核心假设是平稳性，这意味着系统的时间相关函数仅依赖于时间差，而非绝对时间起点。这个性质导致了某些重要的对称性。本练习 [@problem_id:2454558] 是一个思想实验，旨在探索当你反向分析模拟轨迹时，速度自相关函数（VACF）和均方位移（MSD）会发生什么变化，从而加深你对平衡态相关函数时间对称性的理解。", "problem": "考虑一个简单液体在温度 $T$ 下的经典平衡分子动力学轨迹，该轨迹在等间隔时间 $t_n = n \\Delta t$（其中 $n = 0, 1, \\dots, N$，采样间隔 $\\Delta t  0$）进行采样。保存的文件包含粒子 $i = 1, \\dots, N_{\\mathrm{p}}$ 的位置 $\\mathbf{r}_i(t_n)$ 和速度 $\\mathbf{v}_i(t_n)$。将均方根位移 (MSD) 定义为延迟时间 $\\tau \\ge 0$ 的函数：\n$$\n\\mathrm{MSD}(\\tau) = \\left\\langle \\left\\lVert \\mathbf{r}_i(t_0+\\tau) - \\mathbf{r}_i(t_0) \\right\\rVert^2 \\right\\rangle_{i,t_0},\n$$\n以及速度自相关函数 (VACF) 定义为：\n$$\nC_v(\\tau) = \\left\\langle \\mathbf{v}_i(t_0) \\cdot \\mathbf{v}_i(t_0+\\tau) \\right\\rangle_{i,t_0},\n$$\n其中 $\\langle \\cdot \\rangle_{i,t_0}$ 表示对所有粒子和所有有效时间起点进行平均。扩散系数 $D$ 可以通过 Einstein 关系式计算：\n$$\nD = \\lim_{\\tau \\to \\infty} \\frac{\\mathrm{MSD}(\\tau)}{2 d \\tau},\n$$\n或者通过 Green–Kubo 关系式计算：\n$$\nD = \\int_0^{\\infty} C_v(\\tau)\\, \\mathrm{d}\\tau,\n$$\n其中 $d$ 是空间维度。\n\n假设严格按照时间倒序读取同一轨迹文件，即记录从 $t_N$ 向下处理到 $t_0$，而不改变每个保存时刻存储的 $\\mathbf{r}_i$ 和 $\\mathbf{v}_i$ 的数值。然后，将相同的算法应用于从倒序序列计算作为 $\\tau \\ge 0$ 的函数的 $\\mathrm{MSD}(\\tau)$ 和 $C_v(\\tau)$。\n\n哪个陈述最能描述按时间倒序读取文件如何影响计算出的 $\\mathrm{MSD}(\\tau)$、$C_v(\\tau)$ 以及最终的扩散系数 $D$？选择一项。\n\nA. 对于所有 $\\tau \\ge 0$，$\\mathrm{MSD}(\\tau)$ 和 $C_v(\\tau)$ 均保持不变，因此通过 Einstein 或 Green–Kubo 路径计算的 $D$ 也保持不变；物理上，这些时间相关可观测量在稳态平衡过程中仅依赖于时间差，并且在时间反演下是偶函数。\n\nB. $\\mathrm{MSD}(\\tau)$ 保持不变，但对于所有 $\\tau  0$，$C_v(\\tau)$ 的符号会改变，因此 Green–Kubo 扩散系数的符号会改变，而 Einstein 扩散系数保持不变。\n\nC. 当倒序读取时，$\\mathrm{MSD}(\\tau)$ 会随 $\\tau$ 减小，因为位移变为负值，而 $C_v(\\tau)$ 保持不变；因此，Einstein 扩散系数减小。\n\nD. $\\mathrm{MSD}(\\tau)$ 和 $C_v(\\tau)$ 都被时间反演，因此 $\\widetilde{\\mathrm{MSD}}(\\tau) = \\mathrm{MSD}(-\\tau)$ 并且 $\\widetilde{C}_v(\\tau) = C_v(-\\tau)$；因此，其长时间行为相对于正向时间计算在符号上有所不同，从而改变了 $D$。", "solution": "该问题要求分析在按时间倒序处理经典平衡分子动力学轨迹时，计算出的均方根位移 (MSD) 和速度自相关函数 (VACF) 会受到怎样的影响。这个问题的核心在于稳态系统中时间相关函数的性质。\n\n首先，让我们将问题设置形式化。原始轨迹包含粒子 $i=1, \\dots, N_{\\mathrm{p}}$ 在离散时间 $t_n = n \\Delta t$（其中 $n = 0, \\dots, N$）的数据点 $(\\mathbf{r}_i(t_n), \\mathbf{v}_i(t_n))$。系统处于热平衡状态，这意味着其底层的随机过程是稳态的。这意味着时间相关函数仅依赖于时间差（延迟时间 $\\tau$），而不依赖于绝对时间起点 $t_0$。\n\n问题指出轨迹文件是按倒序读取的。让我们定义一个新的“计算时间”变量 $t'$ 来表示读取的序列。当文件被倒序读取时，计算时间 $t'_n = n \\Delta t$ 处的数据对应于原始物理时间 $t_{N-n}$ 的数据。我们用波浪号表示这个倒序序列中的位置和速度：\n$$ \\tilde{\\mathbf{r}}_i(t'_n) = \\mathbf{r}_i(t_{N-n}) $$\n$$ \\tilde{\\mathbf{v}}_i(t'_n) = \\mathbf{v}_i(t_{N-n}) $$\n问题明确指出位置和速度向量的数值不被改变。这是关键的一点；这只是数据序列的颠倒，而不是物理上的时间反演操作（物理时间反演会涉及对速度取反）。\n\n我们被要求使用相同的算法对这个新的、用波浪号标记的数据序列计算 MSD 和 VACF。设延迟时间为 $\\tau = k \\Delta t \\ge 0$。\n\n**均方根位移 ($\\widetilde{\\mathrm{MSD}}$) 的分析**\n\n将 MSD 的标准定义应用于倒序序列：\n$$ \\widetilde{\\mathrm{MSD}}(\\tau) = \\left\\langle \\left\\lVert \\tilde{\\mathbf{r}}_i(t'_0+\\tau) - \\tilde{\\mathbf{r}}_i(t'_0) \\right\\rVert^2 \\right\\rangle_{i,t'_0} $$\n这里，$\\langle \\cdot \\rangle_{i,t'_0}$ 意味着对所有粒子 $i$ 和所有有效的计算时间起点 $t'_0$ 进行平均。设一个特定的时间起点为 $t'_n = n \\Delta t$。平均值内的表达式变为：\n$$ \\left\\lVert \\tilde{\\mathbf{r}}_i(t'_{n+k}) - \\tilde{\\mathbf{r}}_i(t'_n) \\right\\rVert^2 = \\left\\lVert \\mathbf{r}_i(t_{N-(n+k)}) - \\mathbf{r}_i(t_{N-n}) \\right\\rVert^2 $$\n让我们定义一个新的物理时间起点 $T_0 = t_{N-n} = (N-n)\\Delta t$。另一个时间点是 $t_{N-n-k} = (N-n-k)\\Delta t = T_0 - k\\Delta t = T_0 - \\tau$。因此，位移的平方是：\n$$ \\left\\lVert \\mathbf{r}_i(T_0-\\tau) - \\mathbf{r}_i(T_0) \\right\\rVert^2 = \\left\\lVert -(\\mathbf{r}_i(T_0) - \\mathbf{r}_i(T_0-\\tau)) \\right\\rVert^2 = \\left\\lVert \\mathbf{r}_i(T_0) - \\mathbf{r}_i(T_0-\\tau) \\right\\rVert^2 $$\n计算出的 $\\widetilde{\\mathrm{MSD}}(\\tau)$ 是该量对所有有效物理时间起点 $T_0$（这对应于对 $n$ 进行平均）的平均值。所以，\n$$ \\widetilde{\\mathrm{MSD}}(\\tau) = \\left\\langle \\left\\lVert \\mathbf{r}_i(t-\\tau) - \\mathbf{r}_i(t) \\right\\rVert^2 \\right\\rangle_{i,t} $$\n由于过程是稳态的，平均值与绝对时间无关。我们可以进行变量替换 $t' = t-\\tau$。对所有 $t$ 的平均等价于对所有 $t'$ 的平均。\n$$ \\widetilde{\\mathrm{MSD}}(\\tau) = \\left\\langle \\left\\lVert \\mathbf{r}_i(t') - \\mathbf{r}_i(t'+\\tau) \\right\\rVert^2 \\right\\rangle_{i,t'} = \\left\\langle \\left\\lVert -(\\mathbf{r}_i(t'+\\tau) - \\mathbf{r}_i(t')) \\right\\rVert^2 \\right\\rangle_{i,t'} $$\n由于平方欧几里得范数满足 $\\lVert -\\mathbf{x} \\rVert^2 = \\lVert \\mathbf{x} \\rVert^2$，我们得到：\n$$ \\widetilde{\\mathrm{MSD}}(\\tau) = \\left\\langle \\left\\lVert \\mathbf{r}_i(t'+\\tau) - \\mathbf{r}_i(t') \\right\\rVert^2 \\right\\rangle_{i,t'} = \\mathrm{MSD}(\\tau) $$\n因此，计算出的均方根位移保持不变。\n\n**速度自相关函数 ($\\widetilde{C}_v$) 的分析**\n\n类似地，VACF 是从倒序序列计算的：\n$$ \\widetilde{C}_v(\\tau) = \\left\\langle \\tilde{\\mathbf{v}}_i(t'_0) \\cdot \\tilde{\\mathbf{v}}_i(t'_0+\\tau) \\right\\rangle_{i,t'_0} $$\n对于一个特定的时间起点 $t'_n = n \\Delta t$，平均值内的项是：\n$$ \\tilde{\\mathbf{v}}_i(t'_n) \\cdot \\tilde{\\mathbf{v}}_i(t'_{n+k}) = \\mathbf{v}_i(t_{N-n}) \\cdot \\mathbf{v}_i(t_{N-(n+k)}) $$\n再次，设物理时间起点为 $T_0 = t_{N-n}$。那么第二个时间点是 $T_0 - \\tau$。该项为 $\\mathbf{v}_i(T_0) \\cdot \\mathbf{v}_i(T_0-\\tau)$。计算出的 $\\widetilde{C}_v(\\tau)$ 是这个量的平均值：\n$$ \\widetilde{C}_v(\\tau) = \\left\\langle \\mathbf{v}_i(t) \\cdot \\mathbf{v}_i(t-\\tau) \\right\\rangle_{i,t} $$\n根据定义，原始 VACF 对于负延迟时间 $-\\tau$ 的值为 $C_v(-\\tau) = \\langle \\mathbf{v}_i(t) \\cdot \\mathbf{v}_i(t-\\tau) \\rangle_{i,t}$。因此，倒序计算得出 $\\widetilde{C}_v(\\tau) = C_v(-\\tau)$。\n\n现在我们必须使用平衡系统中相关函数的一个基本性质。对于任何稳态过程：\n$$ C_v(\\tau) = \\langle \\mathbf{v}_i(t) \\cdot \\mathbf{v}_i(t+\\tau) \\rangle_{i,t} $$\n由于稳态性，我们可以将时间起点平移 $-\\tau$：\n$$ C_v(\\tau) = \\langle \\mathbf{v}_i(t-\\tau) \\cdot \\mathbf{v}_i(t) \\rangle_{i,t} $$\n由于标量积是可交换的（$\\mathbf{a} \\cdot \\mathbf{b} = \\mathbf{b} \\cdot \\mathbf{a}$），我们可以写成：\n$$ C_v(\\tau) = \\langle \\mathbf{v}_i(t) \\cdot \\mathbf{v}_i(t-\\tau) \\rangle_{i,t} $$\n这正是 $\\widetilde{C}_v(\\tau)$ 的表达式。因此，$\\widetilde{C}_v(\\tau) = C_v(\\tau)$。这也证明了 VACF 是延迟时间的偶函数，即 $C_v(\\tau) = C_v(-\\tau)$。\n\n**对扩散系数 ($D$) 的影响**\n\n由于 $\\mathrm{MSD}(\\tau)$ 和 $C_v(\\tau)$ 都不受时间倒序计算的影响：\n- Einstein 关系式 $D = \\lim_{\\tau \\to \\infty} \\frac{\\mathrm{MSD}(\\tau)}{2 d \\tau}$ 将得出相同的 $D$ 值，因为 $\\mathrm{MSD}(\\tau)$ 保持不变。\n- Green–Kubo 关系式 $D = \\int_0^{\\infty} C_v(\\tau)\\, \\mathrm{d}\\tau$ 也将得出相同的 $D$ 值，因为对于所有 $\\tau \\ge 0$，$C_v(\\tau)$ 保持不变。\n\n**选项评估**\n\nA. **对于所有 $\\tau \\ge 0$，$\\mathrm{MSD}(\\tau)$ 和 $C_v(\\tau)$ 均保持不变，因此通过 Einstein 或 Green–Kubo 路径计算的 $D$ 也保持不变；物理上，这些时间相关可观测量在稳态平衡过程中仅依赖于时间差，并且在时间反演下是偶函数。**\n这个陈述与我们的推导完全一致。两个函数确实都没有改变。因此，扩散系数 $D$ 也保持不变。所提供的物理理由是正确的：稳态性是关键，并且相关函数是延迟时间的偶函数（在此上下文中，“在时间反演下是偶函数”指的就是这个性质）。**正确**。\n\nB. **$\\mathrm{MSD}(\\tau)$ 保持不变，但对于所有 $\\tau  0$，$C_v(\\tau)$ 的符号会改变，因此 Green–Kubo 扩散系数的符号会改变，而 Einstein 扩散系数保持不变。**\n这是不正确的。我们已经证明 $\\widetilde{C}_v(\\tau) = C_v(\\tau)$，而不是 $-C_v(\\tau)$。符号改变会违反平衡相关函数的基本性质。**不正确**。\n\nC. **当倒序读取时，$\\mathrm{MSD}(\\tau)$ 会随 $\\tau$ 减小，因为位移变为负值，而 $C_v(\\tau)$ 保持不变；因此，Einstein 扩散系数减小。**\n这个陈述是无稽之谈。MSD 是范数平方的均值，必须是非负的。对于一个扩散系统，它是 $\\tau$ 的非减函数。“位移变为负值”在这种情况下是一个不精确且无意义的说法。**不正确**。\n\nD. **$\\mathrm{MSD}(\\tau)$ 和 $C_v(\\tau)$ 都被时间反演，因此 $\\widetilde{\\mathrm{MSD}}(\\tau) = \\mathrm{MSD}(-\\tau)$ 并且 $\\widetilde{C}_v(\\tau) = C_v(-\\tau)$；因此，其长时间行为相对于正向时间计算在符号上有所不同，从而改变了 $D$。**\n该陈述的第一部分在数学上是正确的：逆序计算确实计算了负延迟时间的相关函数。然而，得出的结论是错误的。它没有认识到对于平衡稳态过程，$\\mathrm{MSD}(\\tau)$ 和 $C_v(\\tau)$ 都是 $\\tau$ 的偶函数，意味着 $\\mathrm{MSD}(-\\tau) = \\mathrm{MSD}(\\tau)$ 和 $C_v(-\\tau) = C_v(\\tau)$。因此，长时间行为并*没有*不同，$D$ 也没有改变。该选项做出了一个正确的中间步骤，但得出了错误的最终结论。**不正确**。\n\n唯一完全正确的陈述是 A。", "answer": "$$\\boxed{A}$$", "id": "2454558"}, {"introduction": "在理想情况下，我们计算的是纯粹的热运动属性，但真实的模拟数据可能包含系统性的人为误差（artifacts）。一个常见的例子是由于初始化或控温器不当导致的系统质心漂移。本练习 [@problem_id:2454535] 将引导你分析这种未经修正的质心运动如何“污染”VACF和MSD的计算，并最终导致扩散系数的灾难性错误，这凸显了数据预处理和验证的重要性。", "problem": "一个简单流体的分子动力学 (MD) 轨迹是在周期性边界条件下，于温度 $T$ 下生成的。由于初始化错误，系统带有一个恒定的非零净线性动量，导致质心 (COM) 在整个运行过程中以均匀的漂移速度 $\\mathbf{v}_{\\mathrm{drift}}\\neq \\mathbf{0}$ 运动。一名学生在未移除质心运动的情况下分析该轨迹，计算了单粒子速度自相关函数 (VACF)，其定义为 $C_{vv}(t)=\\frac{1}{3N}\\sum_{i=1}^{N}\\langle \\mathbf{v}_{i}(t)\\cdot \\mathbf{v}_{i}(0)\\rangle$，并用两种标准方法估算了自扩散系数 $D$：(i) 通过 $C_{vv}(t)$ 的 Green-Kubo 时间积分，以及 (ii) 通过 Einstein 均方位移 (MSD) 关系 $D=\\lim_{t\\to\\infty}\\frac{1}{6t}\\langle\\lvert \\mathbf{r}_{i}(t)-\\mathbf{r}_{i}(0)\\rvert^{2}\\rangle$。当质心漂移未被移除时，下列哪项最能描述 VACF 在长时间的行为以及由每种方法计算出的 $D$ 值会发生什么？\n\nA. $C_{vv}(t)$ 像在平衡态中一样，当 $t\\to\\infty$ 时衰减至零；Green–Kubo 和 Einstein 对 $D$ 的估算均不受影响。\n\nB. 在长时间下，$C_{vv}(t)$ 趋于一个正常数 $\\lvert \\mathbf{v}_{\\mathrm{drift}}\\rvert^{2}$；Green–Kubo 时间积分发散，因此任何对 $D$ 的有限时间估算都随积分上限线性增长；Einstein 估算表现出一个含有 $t$ 的二次项的 MSD，导致 $\\langle\\lvert \\mathbf{r}_{i}(t)-\\mathbf{r}_{i}(0)\\rvert^{2}\\rangle/(6t)$ 无界增长（没有长时间平台），除非移除漂移。\n\nC. 由于漂移增强了流体动力学回流，$C_{vv}(t)$ 在长时间下变为负值；两种方法都相对于真实值低估了 $D$。\n\nD. $C_{vv}(t)$ 被一个常数向上平移，但 Green–Kubo 积分保持有限，因为平均速率是恒定的；Einstein 估算不受影响，因为它仅取决于位移，而非速度。", "solution": "首先对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n-   系统：一个简单流体的分子动力学 (MD) 轨迹。\n-   模拟条件：周期性边界条件，恒定温度 $T$。\n-   系统人为误差：一个恒定的非零净线性动量，导致一个均匀的质心 (COM) 漂移速度 $\\mathbf{v}_{\\mathrm{drift}}\\neq \\mathbf{0}$。\n-   分析程序：在未移除质心运动的情况下分析轨迹。\n-   量 1：单粒子速度自相关函数 (VACF)，定义为 $C_{vv}(t)=\\frac{1}{3N}\\sum_{i=1}^{N}\\langle \\mathbf{v}_{i}(t)\\cdot \\mathbf{v}_{i}(0)\\rangle$。\n-   量 2：通过 Green–Kubo 关系得到的自扩散系数 $D$，$D = \\int_0^\\infty C_{vv}(t) dt$。\n-   量 3：通过 Einstein 关系得到的自扩散系数 $D$，$D=\\lim_{t\\to\\infty}\\frac{1}{6t}\\langle\\lvert \\mathbf{r}_{i}(t)-\\mathbf{r}_{i}(0)\\rvert^{2}\\rangle$。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题陈述描述了计算化学和物理学中一个标准且现实的场景。在未正确初始化或控温的 MD 模拟中，净质心漂移是一个常见的人为误差。所描述的分析方法——VACF、Green-Kubo 和 Einstein 关系——是从轨迹计算输运系数的基本技术。所提供的定义是自洽且数学上清晰的，尽管归一化约定可能与某些教科书略有不同。该问题具有科学依据、提法明确且客观。它就一个具体的、定义明确的错误对标准分析指标的后果提出了一个清晰的问题。\n\n### 步骤 3：结论与行动\n该问题有效。我们将继续推导解答。\n\n### 基于原理的推导\n问题的核心是理解实验室参考系中的粒子速度 $\\mathbf{v}_i(t)$ 和位置 $\\mathbf{r}_i(t)$ 如何与它们在质心参考系中的对应量相关联，质心参考系是总动量为零且定义了真实扩散性质的参考系。\n\n令 $\\mathbf{v}'_i(t)$ 为粒子 $i$ 在质心参考系中的速度。那么实验室参考系中的速度由一个简单的伽利略变换给出：\n$$ \\mathbf{v}_i(t) = \\mathbf{v}'_i(t) + \\mathbf{v}_{\\mathrm{drift}} $$\n其中 $\\mathbf{v}_{\\mathrm{drift}}$ 是恒定的质心速度。速度 $\\mathbf{v}'_i(t)$ 代表粒子的热运动。根据质心参考系的定义，它们在所有粒子上的平均值为零：$\\frac{1}{N}\\sum_{i=1}^N \\mathbf{v}'_i(t) = \\mathbf{0}$。此外，对于在质心参考系中处于平衡态的系统，单个粒子热速度的系综平均值为零：$\\langle \\mathbf{v}'_i(t) \\rangle = \\mathbf{0}$。\n\n#### 速度自相关函数 ($C_{vv}(t)$) 的分析\n我们将 $\\mathbf{v}_i(t)$ 的表达式代入 $C_{vv}(t)$ 的定义中：\n$$ C_{vv}(t) = \\frac{1}{3N}\\sum_{i=1}^{N}\\langle (\\mathbf{v}'_{i}(t) + \\mathbf{v}_{\\mathrm{drift}})\\cdot (\\mathbf{v}'_{i}(0) + \\mathbf{v}_{\\mathrm{drift}})\\rangle $$\n展开点积并利用系综平均 $\\langle \\cdot \\rangle$ 的线性性质：\n$$ C_{vv}(t) = \\frac{1}{3N}\\sum_{i=1}^{N} \\left( \\langle \\mathbf{v}'_{i}(t) \\cdot \\mathbf{v}'_{i}(0) \\rangle + \\langle \\mathbf{v}'_{i}(t) \\cdot \\mathbf{v}_{\\mathrm{drift}} \\rangle + \\langle \\mathbf{v}_{\\mathrm{drift}} \\cdot \\mathbf{v}'_{i}(0) \\rangle + \\langle \\mathbf{v}_{\\mathrm{drift}} \\cdot \\mathbf{v}_{\\mathrm{drift}} \\rangle \\right) $$\n让我们分析求和中的四项：\n1.  $\\langle \\mathbf{v}'_{i}(t) \\cdot \\mathbf{v}'_{i}(0) \\rangle$：这是质心参考系中的 VACF。对于流体，热速度随时间去相关，因此当 $t \\to \\infty$ 时，该项趋于 $0$。\n2.  $\\langle \\mathbf{v}'_{i}(t) \\cdot \\mathbf{v}_{\\mathrm{drift}} \\rangle = \\langle \\mathbf{v}'_{i}(t) \\rangle \\cdot \\mathbf{v}_{\\mathrm{drift}} = \\mathbf{0} \\cdot \\mathbf{v}_{\\mathrm{drift}} = 0$，因为平均热速度为零。\n3.  $\\langle \\mathbf{v}_{\\mathrm{drift}} \\cdot \\mathbf{v}'_{i}(0) \\rangle = \\mathbf{v}_{\\mathrm{drift}} \\cdot \\langle \\mathbf{v}'_{i}(0) \\rangle = \\mathbf{v}_{\\mathrm{drift}} \\cdot \\mathbf{0} = 0$。\n4.  $\\langle \\mathbf{v}_{\\mathrm{drift}} \\cdot \\mathbf{v}_{\\mathrm{drift}} \\rangle = \\langle \\lvert \\mathbf{v}_{\\mathrm{drift}} \\rvert^2 \\rangle = \\lvert \\mathbf{v}_{\\mathrm{drift}} \\rvert^2$，因为 $\\mathbf{v}_{\\mathrm{drift}}$ 是一个常数。\n\n将这些代回 $C_{vv}(t)$ 的表达式中：\n$$ C_{vv}(t) = \\frac{1}{3N}\\sum_{i=1}^{N} \\langle \\mathbf{v}'_{i}(t) \\cdot \\mathbf{v}'_{i}(0) \\rangle + \\frac{1}{3N}\\sum_{i=1}^{N} \\lvert \\mathbf{v}_{\\mathrm{drift}} \\rvert^2 $$\n第一部分是真实的 VACF，$C'_{vv}(t)$。第二部分简化为 $\\frac{1}{3N} (N \\lvert \\mathbf{v}_{\\mathrm{drift}} \\rvert^2) = \\frac{1}{3} \\lvert \\mathbf{v}_{\\mathrm{drift}} \\rvert^2$。\n因此，测得的 VACF 是：\n$$ C_{vv}(t) = C'_{vv}(t) + \\frac{1}{3} \\lvert \\mathbf{v}_{\\mathrm{drift}} \\rvert^2 $$\n当 $t \\to \\infty$ 时，$C'_{vv}(t) \\to 0$。因此，测得的 VACF 趋于一个非零正常数：\n$$ \\lim_{t\\to\\infty} C_{vv}(t) = \\frac{1}{3} \\lvert \\mathbf{v}_{\\mathrm{drift}} \\rvert^2 $$\n\n#### Green-Kubo 对 $D$ 的估算分析\n扩散系数是通过对 $C_{vv}(t)$ 积分计算的。使用上述结果：\n$$ D_{\\mathrm{GK}} = \\int_0^\\infty C_{vv}(t) dt = \\int_0^\\infty \\left( C'_{vv}(t) + \\frac{1}{3} \\lvert \\mathbf{v}_{\\mathrm{drift}} \\rvert^2 \\right) dt $$\n$$ D_{\\mathrm{GK}} = \\int_0^\\infty C'_{vv}(t) dt + \\int_0^\\infty \\frac{1}{3} \\lvert \\mathbf{v}_{\\mathrm{drift}} \\rvert^2 dt $$\n第一个积分是真实的扩散系数 $D_{\\text{true}}$。第二个积分发散，因为被积函数是一个正常数：\n$$ \\int_0^\\infty \\frac{1}{3} \\lvert \\mathbf{v}_{\\mathrm{drift}} \\rvert^2 dt \\to \\infty $$\n在任何实际计算中，如果积分在有限时间 $t_{\\mathrm{max}}$ 处截断，对 $D$ 的估算将约为 $D_{\\text{true}} + \\frac{1}{3} \\lvert \\mathbf{v}_{\\mathrm{drift}} \\rvert^2 t_{\\mathrm{max}}$。这表明计算出的 $D$ 值将随积分时间线性增长且不收敛。\n\n#### Einstein 对 $D$ 的估算分析\n粒子 $i$ 从时间 $0$ 到 $t$ 的位移是 $\\Delta \\mathbf{r}_i(t) = \\mathbf{r}_i(t) - \\mathbf{r}_i(0)$。它可以通过对速度积分得到：\n$$ \\Delta \\mathbf{r}_i(t) = \\int_0^t \\mathbf{v}_i(\\tau) d\\tau = \\int_0^t (\\mathbf{v}'_i(\\tau) + \\mathbf{v}_{\\mathrm{drift}}) d\\tau = \\int_0^t \\mathbf{v}'_i(\\tau) d\\tau + \\int_0^t \\mathbf{v}_{\\mathrm{drift}} d\\tau $$\n这得到 $\\Delta \\mathbf{r}_i(t) = \\Delta \\mathbf{r}'_i(t) + t \\mathbf{v}_{\\mathrm{drift}}$，其中 $\\Delta \\mathbf{r}'_i(t)$ 是在质心参考系中的位移。\n现在我们计算均方位移 (MSD)：\n$$ \\langle \\lvert \\Delta \\mathbf{r}_i(t) \\rvert^2 \\rangle = \\langle \\lvert \\Delta \\mathbf{r}'_i(t) + t \\mathbf{v}_{\\mathrm{drift}} \\rvert^2 \\rangle = \\langle (\\Delta \\mathbf{r}'_i(t) + t \\mathbf{v}_{\\mathrm{drift}}) \\cdot (\\Delta \\mathbf{r}'_i(t) + t \\mathbf{v}_{\\mathrm{drift}}) \\rangle $$\n展开点积：\n$$ \\langle \\lvert \\Delta \\mathbf{r}'_i(t) \\rvert^2 + 2t (\\Delta \\mathbf{r}'_i(t) \\cdot \\mathbf{v}_{\\mathrm{drift}}) + t^2 \\lvert \\mathbf{v}_{\\mathrm{drift}} \\rvert^2 \\rangle $$\n$$ = \\langle \\lvert \\Delta \\mathbf{r}'_i(t) \\rvert^2 \\rangle + 2t \\langle \\Delta \\mathbf{r}'_i(t) \\rangle \\cdot \\mathbf{v}_{\\mathrm{drift}} + t^2 \\lvert \\mathbf{v}_{\\mathrm{drift}} \\rvert^2 $$\n第一项是真实的 MSD，对于长时间，$\\langle \\lvert \\Delta \\mathbf{r}'_i(t) \\rvert^2 \\rangle \\approx 6 D_{\\text{true}} t$。第二项消失，因为由于对称性，粒子在质心参考系中的平均位移为零，$\\langle \\Delta \\mathbf{r}'_i(t) \\rangle = \\mathbf{0}$。\n因此，对于大的 $t$，测得的 MSD 为：\n$$ \\mathrm{MSD}(t) = \\langle \\lvert \\Delta \\mathbf{r}_i(t) \\rvert^2 \\rangle \\approx 6 D_{\\text{true}} t + t^2 \\lvert \\mathbf{v}_{\\mathrm{drift}} \\rvert^2 $$\n漂移引入了一个随时间二次增长的项。\n对 $D$ 的 Einstein 计算为：\n$$ D_E = \\lim_{t\\to\\infty} \\frac{\\mathrm{MSD}(t)}{6t} = \\lim_{t\\to\\infty} \\frac{6 D_{\\text{true}} t + t^2 \\lvert \\mathbf{v}_{\\mathrm{drift}} \\rvert^2}{6t} $$\n$$ D_E = \\lim_{t\\to\\infty} \\left( D_{\\text{true}} + \\frac{t}{6} \\lvert \\mathbf{v}_{\\mathrm{drift}} \\rvert^2 \\right) $$\n由于 $\\mathbf{v}_{\\mathrm{drift}} \\neq \\mathbf{0}$，这个极限是发散的。计算出的量 $\\mathrm{MSD}(t)/(6t)$ 随时间线性增加，不会趋于一个恒定的 $D$ 值。\n\n### 逐项分析\n\nA. $C_{vv}(t)$ 像在平衡态中一样，当 $t\\to\\infty$ 时衰减至零；Green–Kubo 和 Einstein 对 $D$ 的估算均不受影响。\n这是不正确的。如推导所示，$C_{vv}(t)$ 衰减到一个正常数，而不是零。因此，Green-Kubo 和 Einstein 的估算都受到严重影响，导致发散。\n\nB. 在长时间下，$C_{vv}(t)$ 趋于一个正常数 $\\lvert \\mathbf{v}_{\\mathrm{drift}}\\rvert^{2}$；Green–Kubo 时间积分发散，因此任何对 $D$ 的有限时间估算都随积分上限线性增长；Einstein 估算表现出一个含有 $t$ 的二次项的 MSD，导致 $\\langle\\lvert \\mathbf{r}_{i}(t)-\\mathbf{r}_{i}(0)\\rvert^{2}\\rangle/(6t)$ 无界增长（没有长时间平台），除非移除漂移。\n这个选项提供了近乎完美的描述。\n-   $C_{vv}(t)$ 趋于一个正常数：正确。我的推导给出的常数是 $\\frac{1}{3}\\lvert \\mathbf{v}_{\\mathrm{drift}} \\rvert^2$，基于所提供的 $C_{vv}(t)$ 定义。如果 VACF 定义为 $\\frac{1}{N}\\sum_i \\langle \\mathbf{v}_i(t) \\cdot \\mathbf{v}_i(0) \\rangle$，则值 $\\lvert \\mathbf{v}_{\\mathrm{drift}} \\rvert^2$ 将是正确的。这是一个由于不同约定而产生的微小量化差异，但定性陈述是正确的。\n-   Green-Kubo 积分发散，有限时间估算线性增长：正确。这与推导相符。\n-   Einstein MSD 有一个 $t^2$ 项，其推导出的 $D$ 发散：正确。这也完全符合推导。\n此选项是对物理现象的最佳描述。\n\nC. 由于漂移增强了流体动力学回流，$C_{vv}(t)$ 在长时间下变为负值；两种方法都相对于真实值低估了 $D$。\n这是不正确的。在长时间下的主导效应是正的常数偏移，而不是流体动力学长时尾迹（其效应要弱得多，并且会叠加在偏移之上）。两种对 $D$ 的估算都是巨大的过高估计并且发散，而不是低估。\n\nD. $C_{vv}(t)$ 被一个常数向上平移，但 Green–Kubo 积分保持有限，因为平均速率是恒定的；Einstein 估算不受影响，因为它仅取决于位移，而非速度。\n这是不正确的。虽然 $C_{vv}(t)$ 被向上平移，但一个趋于非零常数的函数的积分是发散的，而不是有限的。“因为平均速率是恒定的”这个理由是不相关的。Einstein 估算也从根本上受到影响，因为恒定的速度漂移导致位移随时间线性增长，使得均方位移呈二次增长。\n\n基于此分析，选项 B 是唯一正确描述所有量的定性行为的选项。", "answer": "$$\\boxed{B}$$", "id": "2454535"}, {"introduction": "从分析现有数据到设计新的模拟，这是一个关键的飞跃。本练习 [@problem_id:2454578] 将理论（如Langevin方程和Green-Kubo关系）与实际的实验设计联系起来。你的任务是基于统计精度的要求，从第一性原理出发推导并计算出获得可靠扩散系数估计值所需的最短模拟时间，这是一个融合了物理、统计和编程的综合性实践。", "problem": "要求您使用基于动力学理论且有原理依据的统计分析，确定将单原子流体（液氩模型）的自扩散系数 $D$ 估计到指定相对统计误差内所需的最小总模拟时间。您的任务是编写一个完整、可运行的程序，该程序在下述具体、可测试的方案下实现此分析。\n\n您的推导应从牛顿第二定律和郎之万方程出发，结合时间相关函数的定义及其通过线性响应理论与输运系数的联系。具体来说，假设一个质量为 $m$ 的氩原子浸入在绝对温度为 $T$ 的热浴中，其速度 $\\mathbf{v}(t)$ 服从郎之万动力学\n$$\nm \\,\\frac{d\\mathbf{v}}{dt} = - m \\,\\gamma \\,\\mathbf{v}(t) + \\mathbf{R}(t),\n$$\n其中 $\\gamma$ 是摩擦系数，$\\mathbf{R}(t)$ 是满足涨落-耗散条件的零均值、高斯、delta相关的随机力。使用如下定义的时间相关函数\n$$\nC_{AB}(t) = \\langle A(0) B(t) \\rangle,\n$$\n以及由线性响应理论得出的输运系数与时间相关函数积分之间的关系。请勿在没有系统推导的情况下假定任何直接给出扩散系数的简便公式。\n\n使用以下方案定义 $D$ 的一个具体估计量：\n- 考虑时长为 $t_c$ 的数据块，并在每个数据块内使用位于 $t=0$ 的单一时间原点。\n- 对每个数据块，通过将来自该原点的速度自相关贡献积分到有限截止时间 $t_c$ 来近似扩散系数，并使用点积对三个笛卡尔分量进行平均。数据块估计量为\n$$\nD_{\\text{block}} = \\frac{1}{3}\\int_0^{t_c} \\mathbf{v}(0)\\cdot \\mathbf{v}(t)\\, dt,\n$$\n在您的推导中，此近似值是确定的。假设数据块是独立同分布的。$D_{\\text{block}}$ 的均值等于速度自相关函数在有限时间内的积分，其方差可从该过程已知的二阶统计量计算得出。\n\n在郎之万方程所蕴含的特定 Ornstein–Uhlenbeck 机制下，稳态速度自相关以单一特征时间 $\\tau_v$ 指数衰减。仅使用从上述基本原理出发的推导，确定以下各项的闭式表达式：\n1. 对于有限截止时间 $t_c$，$D_{\\text{block}}$ 的精确均值。\n2. 对于有限截止时间 $t_c$，$D_{\\text{block}}$ 的精确方差。\n\n然后，对于通过平均 $n$ 个独立数据块得到的 $D_{\\text{block}}$ 样本均值，给定一个目标相对标准误差 $\\epsilon$，\n$$\n\\frac{\\sqrt{\\mathrm{Var}(D_{\\text{block}})/n}}{\\mathbb{E}[D_{\\text{block}}]} \\le \\epsilon,\n$$\n解析求解所需的最小整数 $n$。将总模拟物理时间定义为 $T_{\\text{tot}} = n\\, t_c$，并报告此 $T_{\\text{tot}}$。\n\n为了符合液氩的科学特性，使用由涨落-耗散定理在温度 $T$ 下所蕴含的平衡条件，以及速度的麦克斯韦-玻尔兹曼稳态分布，其每个笛卡尔分量的方差为\n$$\n\\sigma_v^2 = \\frac{k_\\mathrm{B}\\, T}{m},\n$$\n其中 $k_\\mathrm{B}$ 是玻尔兹曼常数。使用上述框架，通过第一性原理推导，将 $\\gamma$ 与所需扩散系数 $D$ 联系起来（不要在没有推导的情况下假设任何简便关系）。\n\n需实现的数值方案：\n- 使用等于速度相关时间十倍的有限时间截止：$t_c = 10\\, \\tau_v$。\n- 将最终总时间 $T_{\\text{tot}}$以皮秒 (ps) 为单位表示，并四舍五入到两位小数。\n- 在国际单位制 (SI) 中使用 $k_\\mathrm{B} = 1.380649\\times 10^{-23}$，以及 $1\\,\\text{原子质量单位} = 1.66053906660\\times 10^{-27}\\,\\text{kg}$。\n\n测试套件：对于以下每个参数集 $(T, m, D)$，计算并报告以皮秒为单位的最小总模拟时间 $T_{\\text{tot}}$，该时间能保证上述定义的块估计量均值的相对标准误差不大于 $\\epsilon = 0.05$：\n- 情况1（接近其沸点的典型液氩）：$T = 87\\,\\text{K}$，$m = 39.948\\,\\text{amu}$，$D = 2.30\\times 10^{-9}\\,\\text{m}^2/\\text{s}$。\n- 情况2（粘度更高的情况）：$T = 87\\,\\text{K}$，$m = 39.948\\,\\text{amu}$，$D = 0.50\\times 10^{-9}\\,\\text{m}^2/\\text{s}$。\n- 情况3（粘度更低的情况）：$T = 87\\,\\text{K}$，$m = 39.948\\,\\text{amu}$，$D = 1.00\\times 10^{-8}\\,\\text{m}^2/\\text{s}$。\n\n此问题不涉及角度单位。存在物理单位；所有最终时间必须以皮秒表示。\n\n您的程序应生成单行输出，其中包含三个结果，形式为方括号括起来的逗号分隔列表。例如：“[t1,t2,t3]”。每个条目必须是浮点数，四舍五入到两位小数，以皮秒为单位，并按测试套件情况1到3的顺​​序排列。", "solution": "问题陈述在科学上是合理的、内容自洽且良构的。它提出了计算统计力学中一个标准但并非平凡的问题。我们将按要求从基本原理出发，给出一个完整的解决方案。\n\n分析始于质量为 $m$、温度为 $T$ 的粒子的郎之万方程：\n$$\nm \\frac{d\\mathbf{v}}{dt} = - m \\gamma \\mathbf{v}(t) + \\mathbf{R}(t)\n$$\n这里，$\\gamma$ 是摩擦系数，$\\mathbf{R}(t)$ 是一个高斯白噪声力，其均值为零 $\\langle \\mathbf{R}(t) \\rangle = \\mathbf{0}$，并具有 delta 相关性 $\\langle R_i(t) R_j(t') \\rangle = 2 \\Gamma \\delta_{ij} \\delta(t-t')$。涨落-耗散定理规定了关系 $\\Gamma = m \\gamma k_\\mathrm{B} T$，其中 $k_\\mathrm{B}$ 是玻尔兹曼常数。\n\n我们考虑速度的一个笛卡尔分量，例如 $v_x(t)$。其运动方程是一个一阶线性随机微分方程：\n$$\n\\frac{dv_x}{dt} + \\gamma v_x(t) = \\frac{R_x(t)}{m}\n$$\n从 $t=0$ 时的初始速度 $v_x(0)$ 出发，$v_x(t)$ 的形式解由下式给出：\n$$\nv_x(t) = v_x(0) e^{-\\gamma t} + \\int_0^t e^{-\\gamma(t-s)} \\frac{R_x(s)}{m} ds\n$$\n对于单个分量，速度自相关函数 (VACF) $C(t) = \\langle v_x(0) v_x(t) \\rangle$（$t \\ge 0$）可通过将解乘以 $v_x(0)$ 并取系综平均得到。在稳态下，$s0$ 时的噪声与 $t=0$ 时的速度不相关，即 $\\langle v_x(0) R_x(s) \\rangle = 0$。这得出：\n$$\nC(t) = \\langle v_x(0)^2 \\rangle e^{-\\gamma t}\n$$\n对于处于热平衡的经典系统，能量均分定理指出每个自由度的平均动能为 $\\frac{1}{2} k_\\mathrm{B} T$。因此，$\\frac{1}{2} m \\langle v_x^2 \\rangle = \\frac{1}{2} k_\\mathrm{B} T$，这给出了速度分量的稳态方差为 $\\langle v_x^2 \\rangle = \\sigma_v^2 = \\frac{k_\\mathrm{B} T}{m}$。\n因此，VACF 为：\n$$\nC(t) = \\frac{k_\\mathrm{B} T}{m} e^{-\\gamma |t|}\n$$\n问题陈述衰减由一个时间 $\\tau_v$ 表征，因此我们确定 $\\gamma = 1/\\tau_v$。单分量 VACF 为 $C(t) = \\frac{k_\\mathrm{B} T}{m} e^{-|t|/\\tau_v}$。\n\n自扩散系数 $D$ 由均方位移 (MSD) 的长时间极限定义：\n$$\nD = \\lim_{t\\to\\infty} \\frac{1}{6t} \\langle |\\mathbf{r}(t) - \\mathbf{r}(0)|^2 \\rangle\n$$\n位移是速度的积分：$\\mathbf{r}(t) - \\mathbf{r}(0) = \\int_0^t \\mathbf{v}(t') dt'$。MSD 为：\n$$\n\\langle |\\mathbf{r}(t) - \\mathbf{r}(0)|^2 \\rangle = \\int_0^t dt' \\int_0^t dt'' \\langle \\mathbf{v}(t') \\cdot \\mathbf{v}(t'') \\rangle\n$$\n对于一个稳态过程，相关性 $\\langle \\mathbf{v}(t') \\cdot \\mathbf{v}(t'') \\rangle$ 仅取决于时间差 $|t' - t''|$。令 $C_{vv}(s) = \\langle \\mathbf{v}(0) \\cdot \\mathbf{v}(s) \\rangle$。该二重积分可简化为 $2 \\int_0^t (t-s) C_{vv}(s) ds$。\n将此代入 $D$ 的定义中：\n$$\nD = \\lim_{t\\to\\infty} \\frac{1}{6t} \\left[ 2 \\int_0^t (t-s) C_{vv}(s) ds \\right] = \\frac{1}{3} \\int_0^\\infty C_{vv}(s) ds\n$$\n这是扩散系数的 Green-Kubo 关系。完整的 VACF 是 $C_{vv}(t) = \\langle \\mathbf{v}(0) \\cdot \\mathbf{v}(t) \\rangle = \\sum_{i=x,y,z} \\langle v_i(0)v_i(t) \\rangle = 3C(t)$，因为诸如 $\\langle v_x(0)v_y(t) \\rangle$ 的互相关为零。\n所以，$C_{vv}(t) = 3 \\frac{k_\\mathrm{B} T}{m} e^{-|t|/\\tau_v}$。\n对此积分可得扩散系数：\n$$\nD = \\frac{1}{3} \\int_0^\\infty 3 \\frac{k_\\mathrm{B} T}{m} e^{-t/\\tau_v} dt = \\frac{k_\\mathrm{B} T}{m} [-\\tau_v e^{-t/\\tau_v}]_0^\\infty = \\frac{k_\\mathrm{B} T}{m} \\tau_v\n$$\n这提供了一个从给定参数确定速度相关时间 $\\tau_v$ 的关键关系：$\\tau_v = \\frac{m D}{k_\\mathrm{B} T}$。\n\n接下来，我们分析为有限截止时间 $t_c$ 定义的数据块估计量 $D_{\\text{block}}$ 的统计性质：\n$$\nD_{\\text{block}} = \\frac{1}{3} \\int_0^{t_c} \\mathbf{v}(0) \\cdot \\mathbf{v}(t) dt\n$$\n该估计量的期望值为：\n$$\n\\mathbb{E}[D_{\\text{block}}] = \\frac{1}{3} \\int_0^{t_c} \\langle \\mathbf{v}(0) \\cdot \\mathbf{v}(t) \\rangle dt = \\frac{1}{3} \\int_0^{t_c} C_{vv}(t) dt = \\int_0^{t_c} \\frac{k_\\mathrm{B} T}{m} e^{-t/\\tau_v} dt\n$$\n使用 $D = \\frac{k_\\mathrm{B} T}{m} \\tau_v$，我们可以写出 $\\frac{k_\\mathrm{B} T}{m} = \\frac{D}{\\tau_v}$。\n$$\n\\mathbb{E}[D_{\\text{block}}] = \\frac{D}{\\tau_v} \\int_0^{t_c} e^{-t/\\tau_v} dt = \\frac{D}{\\tau_v} [-\\tau_v e^{-t/\\tau_v}]_0^{t_c} = D(1 - e^{-t_c/\\tau_v})\n$$\n方差为 $\\mathrm{Var}(D_{\\text{block}}) = \\mathbb{E}[D_{\\text{block}}^2] - (\\mathbb{E}[D_{\\text{block}}])^2$。\n$$\n\\mathbb{E}[D_{\\text{block}}^2] = \\frac{1}{9} \\int_0^{t_c} dt_1 \\int_0^{t_c} dt_2 \\langle (\\mathbf{v}(0) \\cdot \\mathbf{v}(t_1)) (\\mathbf{v}(0) \\cdot \\mathbf{v}(t_2)) \\rangle\n$$\n必须计算四点速度相关函数。令 $Y_i = \\int_0^{t_c} v_i(0)v_i(t) dt$。则 $D_{\\text{block}} = \\frac{1}{3}(Y_x+Y_y+Y_z)$。由于在郎之万模型中速度分量是独立的，泛函 $Y_i$ 是不相关的。因此，$\\mathrm{Var}(D_{\\text{block}}) = \\frac{1}{9}[\\mathrm{Var}(Y_x) + \\mathrm{Var}(Y_y) + \\mathrm{Var}(Y_z)] = \\frac{3}{9}\\mathrm{Var}(Y_x) = \\frac{1}{3}\\mathrm{Var}(Y_x)$。\n$Y_x$ 的方差为 $\\mathrm{Var}(Y_x) = \\int_0^{t_c} \\int_0^{t_c} \\mathrm{Cov}(v_x(0)v_x(t_1), v_x(0)v_x(t_2)) dt_1 dt_2$。\n对于零均值高斯过程，Isserlis' theorem 给出了乘积的协方差：$\\mathrm{Cov}(AB, CD) = \\langle AC \\rangle \\langle BD \\rangle + \\langle AD \\rangle \\langle BC \\rangle$。\n这里，$A=v_x(0), B=v_x(t_1), C=v_x(0), D=v_x(t_2)$。\n$$\n\\mathrm{Cov}(v_x(0)v_x(t_1), v_x(0)v_x(t_2)) = \\langle v_x(0)v_x(0) \\rangle \\langle v_x(t_1)v_x(t_2) \\rangle + \\langle v_x(0)v_x(t_2) \\rangle \\langle v_x(t_1)v_x(0) \\rangle\n$$\n使用 $C(t) = \\langle v_x(0)v_x(t) \\rangle$，这变为 $C(0)C(|t_1-t_2|) + C(t_1)C(t_2)$。\n因此，$\\mathrm{Var}(Y_x) = \\int_0^{t_c} \\int_0^{t_c} [C(0)C(|t_1-t_2|) + C(t_1)C(t_2)] dt_1 dt_2$。\n第二项是 $(\\int_0^{t_c} C(t) dt)^2$。第一项是 $C(0) \\int_0^{t_c} \\int_0^{t_c} C(|t_1-t_2|) dt_1 dt_2$。\n二重积分的计算结果为 $2 \\int_0^{t_c} (t_c-t) C(t) dt$。\n令 $x = t_c/\\tau_v$。我们有 $C(t) = (D/\\tau_v) e^{-t/\\tau_v}$ 且 $C(0) = D/\\tau_v$。\n积分 $\\int_0^{t_c} C(t) dt = D(1-e^{-x})$。\n积分 $2\\int_0^{t_c} (t_c-t)C(t)dt = 2(D/\\tau_v)\\int_0^{t_c} (t_c-t)e^{-t/\\tau_v} dt = 2D[t_c - \\tau_v(1-e^{-x})]$。\n合并 $\\mathrm{Var}(Y_x)$ 的所有项：\n$$\n\\mathrm{Var}(Y_x) = D^2(1-e^{-x})^2 + \\frac{D}{\\tau_v} \\cdot 2D[t_c - \\tau_v(1-e^{-x})] = D^2[(1-e^{-x})^2 + 2x - 2(1-e^{-x})]\n$$\n$$\n= D^2[1-2e^{-x}+e^{-2x} + 2x - 2 + 2e^{-x}] = D^2[2x-1+e^{-2x}]\n$$\n最终，$\\mathrm{Var}(D_{\\text{block}}) = \\frac{1}{3}\\mathrm{Var}(Y_x) = \\frac{D^2}{3}(2x-1+e^{-2x})$。\n\n问题要求 $n$ 个数据块均值的相对标准误差最多为 $\\epsilon$：\n$$\n\\frac{\\sqrt{\\mathrm{Var}(D_{\\text{block}})/n}}{\\mathbb{E}[D_{\\text{block}}]} \\le \\epsilon \\implies n \\ge \\frac{\\mathrm{Var}(D_{\\text{block}})}{\\epsilon^2 (\\mathbb{E}[D_{\\text{block}}])^2}\n$$\n所需的最小整数数据块数为 $n_{\\text{min}} = \\lceil n \\rceil$。\n代入我们推导出的表达式：\n$$\nn \\ge \\frac{1}{\\epsilon^2} \\frac{\\frac{D^2}{3}(2x-1+e^{-2x})}{(D(1-e^{-x}))^2} = \\frac{1}{3\\epsilon^2} \\frac{2x-1+e^{-2x}}{(1-e^{-x})^2}\n$$\n总模拟时间为 $T_{\\text{tot}} = n_{\\text{min}} \\cdot t_c$。\n数值方案指定 $t_c = 10 \\tau_v$，因此 $x=10$，且 $\\epsilon=0.05$。$n$ 的系数可以预先计算：\n$$\nn_{\\text{min}} = \\left\\lceil \\frac{1}{3(0.05)^2} \\frac{2(10)-1+e^{-20}}{(1-e^{-10})^2} \\right\\rceil = \\left\\lceil \\frac{1}{0.0075} \\frac{19+e^{-20}}{(1-e^{-10})^2} \\right\\rceil\n$$\n$e^{-10} \\approx 4.54 \\times 10^{-5}$ 很小，而 $e^{-20}$ 可以忽略不计。\n$n_{\\text{min}} = \\lceil 2533.564... \\rceil = 2534$。\n每种情况的总时间使用 $T_{\\text{tot}} = 25340 \\cdot \\frac{mD}{k_\\mathrm{B}T}$ 计算。\n\n每种情况的最终计算步骤：\n1.  将质量 $m$ 从 amu 转换为 kg：$m[\\text{kg}] = m[\\text{amu}] \\times 1.66053906660 \\times 10^{-27}$。\n2.  计算以秒为单位的 $\\tau_v$：$\\tau_v = \\frac{m D}{k_\\mathrm{B} T}$，使用 $k_\\mathrm{B} = 1.380649 \\times 10^{-23}$ SI 单位。\n3.  计算以秒为单位的总时间：$T_{\\text{tot}}[\\text{s}] = 25340 \\times \\tau_v$。\n4.  转换为皮秒并四舍五入到两位小数：$T_{\\text{tot}}[\\text{ps}] = T_{\\text{tot}}[\\text{s}] \\times 10^{12}$。\n此过程在提供的代码中实现。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the minimum total simulation time to estimate a diffusion coefficient\n    to within a prescribed relative statistical error, based on a Langevin model.\n    \"\"\"\n    \n    # Constants\n    K_B = 1.380649e-23  # Boltzmann constant in J/K\n    AMU_TO_KG = 1.66053906660e-27  # Conversion from amu to kg\n\n    # Test cases: (Temperature [K], Mass [amu], Diffusion Coefficient [m^2/s])\n    test_cases = [\n        (87, 39.948, 2.30e-9),   # Case 1: Typical liquid argon\n        (87, 39.948, 0.50e-9),   # Case 2: More viscous\n        (87, 39.948, 1.00e-8),   # Case 3: Less viscous\n    ]\n    \n    # Numerical protocol parameters\n    epsilon = 0.05  # Target relative standard error\n    x = 10  # Cutoff time in units of correlation time, t_c / tau_v\n    \n    # Derive the minimum number of blocks required.\n    # This number depends only on epsilon and x, not on the physical parameters.\n    # n_min = ceil( (1/epsilon**2) * Var(D_block) / E[D_block]**2 )\n    #\n    # Var(D_block) / E[D_block]**2 = (2*x - 1 + exp(-2*x)) / (3 * (1 - exp(-x))**2)\n    \n    n_factor_numerator = 2 * x - 1 + np.exp(-2 * x)\n    n_factor_denominator = 3 * (1 - np.exp(-x))**2\n    n_factor = n_factor_numerator / n_factor_denominator\n    \n    n_min_float = (1 / epsilon**2) * n_factor\n    n_min = int(np.ceil(n_min_float))\n\n    results = []\n    for T, m_amu, D in test_cases:\n        # 1. Convert mass to SI units (kg)\n        m_kg = m_amu * AMU_TO_KG\n        \n        # 2. Calculate the velocity correlation time tau_v from the derived relation\n        # D = (k_B * T / m) * tau_v\n        k_B_T = K_B * T\n        tau_v = (m_kg * D) / k_B_T  # in seconds\n        \n        # 3. Calculate the cutoff time for one block\n        t_c = x * tau_v  # in seconds\n        \n        # 4. Calculate the total simulation time required\n        T_tot_s = n_min * t_c  # in seconds\n        \n        # 5. Convert total time to picoseconds and round\n        T_tot_ps = T_tot_s * 1e12\n        results.append(round(T_tot_ps, 2))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2454578"}]}