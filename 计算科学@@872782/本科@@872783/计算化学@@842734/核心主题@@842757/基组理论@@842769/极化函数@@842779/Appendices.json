{"hands_on_practices": [{"introduction": "虽然极化函数能提高计算精度，但这种提升并非没有代价。本练习旨在让你具体、定量地理解这种权衡关系。通过一个简化的计算量级模型，你将估算在基组中添加(d,p)函数会如何显著增加几何优化等常见任务的CPU时间，这是任何实际计算研究中都必须考量的关键因素。[@problem_id:2460510]", "problem": "给定一个简化的第一性原理计算成本模型，用于比较使用两种基组 $6\\text{-}31\\mathrm{G}$ 和 $6\\text{-}31\\mathrm{G}(\\mathrm{d},\\mathrm{p})$ 对苯 $\\mathrm{C}_6\\mathrm{H}_6$ 进行几何优化所需的总中央处理器 (CPU) 时间。重点在于极化函数的作用，以及它们如何改变基函数的数量，从而改变计算量的标度关系。请使用以下定义和假设，并在不引入任何额外近似的情况下计算所要求的比率。\n\n关于基函数数量的假设：\n- 使用球谐函数。一个 $p$ 型函数有 $3$ 个角向分量，一个 $d$ 型函数有 $5$ 个角向分量。\n- 在 $6\\text{-}31\\mathrm{G}$ 基组中：\n  - 每个碳原子贡献 $9$ 个收缩基函数。\n  - 每个氢原子贡献 $2$ 个收缩基函数。\n- 添加极化函数形成 $6\\text{-}31\\mathrm{G}(\\mathrm{d},\\mathrm{p})$：\n  - 每个碳原子增加 $5$ 个 $d$ 型函数。\n  - 每个氢原子增加 $3$ 个 $p$ 型函数。\n- 苯有 $6$ 个碳原子和 $6$ 个氢原子。\n\n根据这些假设，总基函数数量为：\n- 对于 $6\\text{-}31\\mathrm{G}$：$N_{\\mathrm{G}} = 6 \\times 9 + 6 \\times 2$。\n- 对于 $6\\text{-}31\\mathrm{G}(\\mathrm{d},\\mathrm{p})$：$N_{\\mathrm{Gdp}} = 6 \\times (9 + 5) + 6 \\times (2 + 3)$。\n\n几何优化的计算成本模型：\n- 一次几何优化包含 $S$ 个步骤。\n- 每个步骤包括 $I$ 次自洽场 (SCF) 过程（Self-Consistent Field (SCF)）的迭代以收敛电子能量，外加一次解析能量梯度计算。\n- 一次 SCF 迭代的主要成本与 $N^{p_{\\mathrm{scf}}}$ 成正比，其中 $N$ 是总基函数数量，$p_{\\mathrm{scf}}$ 是给定的标度指数。\n- 一次梯度计算的主要成本与 $N^{p_{\\mathrm{grad}}}$ 成正比，其中 $p_{\\mathrm{grad}}$ 是给定的标度指数。\n- 相对于单次 SCF 迭代，梯度成本可以有不同的前置因子。设 $g$ 为在相同 $N$ 值下，以单次 SCF 迭代成本为单位的梯度成本的无量纲乘数。\n- 因此，在给定 $N$ 的情况下，一次完整优化的总成本与下式成正比\n  $$ T(N) = S \\left( I \\, N^{p_{\\mathrm{scf}}} + g \\, N^{p_{\\mathrm{grad}}} \\right). $$\n- 因为所有项都乘以一个单一的未知比例常数，所以在相同算法参数但不同 $N$ 值下，任意两个此类总成本的比率是良定义且无量纲的。\n\n任务：\n- 对于每个测试用例，计算无量纲比率\n  $$ R = \\frac{T\\!\\left(N_{\\mathrm{Gdp}}\\right)}{T\\!\\left(N_{\\mathrm{G}}\\right)} = \\frac{S \\left( I \\, N_{\\mathrm{Gdp}}^{p_{\\mathrm{scf}}} + g \\, N_{\\mathrm{Gdp}}^{p_{\\mathrm{grad}}} \\right)}{S \\left( I \\, N_{\\mathrm{G}}^{p_{\\mathrm{scf}}} + g \\, N_{\\mathrm{G}}^{p_{\\mathrm{grad}}} \\right)} = \\frac{I \\, N_{\\mathrm{Gdp}}^{p_{\\mathrm{scf}}} + g \\, N_{\\mathrm{Gdp}}^{p_{\\mathrm{grad}}}}{I \\, N_{\\mathrm{G}}^{p_{\\mathrm{scf}}} + g \\, N_{\\mathrm{G}}^{p_{\\mathrm{grad}}}}. $$\n- 将 $R$ 报告为精确到小数点后 $6$ 位的小数浮点数。\n\n测试组：\n- 使用以下参数的有序元组 $(p_{\\mathrm{scf}}, p_{\\mathrm{grad}}, S, I, g)$：\n  1. $(3, 3, 12, 10, 2)$\n  2. $(4, 3, 8, 15, 1)$\n  3. $(3, 4, 20, 8, 3)$\n  4. $(3, 3, 1, 1, 0)$\n  5. $(2.5, 3.5, 25, 25, 1.5)$\n\n要求的最终输出格式：\n- 您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表。例如，$[r_1,r_2,r_3,r_4,r_5]$，其中每个 $r_k$ 是测试用例 $k$ 的比率 $R$，四舍五入到小数点后恰好 $6$ 位。结果是无量纲浮点数。", "solution": "所提出的问题是计算化学中一个有效的练习，要求应用一个简化但概念上合理的成本模型，来估算当向基组中添加极化函数时计算量的增加。所有参数和定义均已提供，问题是自洽的，其科学基础是量子化学计算原理，并且在数学上是适定的。我们将着手解决。\n\n主要任务是计算使用 $6\\text{-}31\\mathrm{G}(\\mathrm{d},\\mathrm{p})$ 基组相对于 $6\\text{-}31\\mathrm{G}$ 基组对苯 $\\mathrm{C}_6\\mathrm{H}_6$ 进行几何优化的总计算时间比率 $R$。核心原理是计算成本与基函数数量 $N$ 成多项式标度关系。添加极化函数会增加 $N$，导致成本显著上升。\n\n首先，我们必须确定每个基组的总基函数数量。分子是苯，有 $6$ 个碳原子和 $6$ 个氢原子。\n\n对于 $6\\text{-}31\\mathrm{G}$ 基组：\n- 每个碳原子贡献 $9$ 个基函数。\n- 每个氢原子贡献 $2$ 个基函数。\n因此，总基函数数量 $N_{\\mathrm{G}}$ 为：\n$$ N_{\\mathrm{G}} = (6 \\text{ 个碳原子}) \\times (9 \\text{ 个函数/碳}) + (6 \\text{ 个氢原子}) \\times (2 \\text{ 个函数/氢}) = 54 + 12 = 66 $$\n\n对于 $6\\text{-}31\\mathrm{G}(\\mathrm{d},\\mathrm{p})$ 基组，我们添加极化函数：\n- 为 $6$ 个碳原子中的每一个添加一套 $5$ 个球谐 $d$ 型函数。\n- 为 $6$ 个氢原子中的每一个添加一套 $3$ 个球谐 $p$ 型函数。\n总基函数数量 $N_{\\mathrm{Gdp}}$ 为：\n$$ N_{\\mathrm{Gdp}} = 6 \\times (9 + 5) + 6 \\times (2 + 3) = 6 \\times 14 + 6 \\times 5 = 84 + 30 = 114 $$\n\n问题给出了几何优化的总成本为 $T(N) = S \\left( I \\, N^{p_{\\mathrm{scf}}} + g \\, N^{p_{\\mathrm{grad}}} \\right)$，其中 $S$ 是优化步骤数，$I$ 是每步的 SCF 迭代次数，$p_{\\mathrm{scf}}$ 和 $p_{\\mathrm{grad}}$ 是标度指数，$g$ 是梯度成本的前置因子。成本比率 $R$ 得到简化，因为公共因子 $S$ 被消去：\n$$ R = \\frac{T(N_{\\mathrm{Gdp}})}{T(N_{\\mathrm{G}})} = \\frac{I \\, N_{\\mathrm{Gdp}}^{p_{\\mathrm{scf}}} + g \\, N_{\\mathrm{Gdp}}^{p_{\\mathrm{grad}}}}{I \\, N_{\\mathrm{G}}^{p_{\\mathrm{scf}}} + g \\, N_{\\mathrm{G}}^{p_{\\mathrm{grad}}}} $$\n\n现在我们使用 $N_{\\mathrm{G}} = 66$ 和 $N_{\\mathrm{Gdp}} = 114$ 对每个测试用例计算这个比率。\n\n案例 1：$(p_{\\mathrm{scf}}, p_{\\mathrm{grad}}, S, I, g) = (3, 3, 12, 10, 2)$\n由于 $p_{\\mathrm{scf}} = p_{\\mathrm{grad}} = 3$，表达式简化为：\n$$ R_1 = \\frac{10 \\cdot 114^3 + 2 \\cdot 114^3}{10 \\cdot 66^3 + 2 \\cdot 66^3} = \\frac{(10 + 2) \\cdot 114^3}{(10 + 2) \\cdot 66^3} = \\left(\\frac{114}{66}\\right)^3 \\approx 5.15201173 \\approx 5.152012 $$\n\n案例 2：$(p_{\\mathrm{scf}}, p_{\\mathrm{grad}}, S, I, g) = (4, 3, 8, 15, 1)$\n$$ R_2 = \\frac{15 \\cdot 114^4 + 1 \\cdot 114^3}{15 \\cdot 66^4 + 1 \\cdot 66^3} = \\frac{15 \\cdot 168896016 + 1481544}{15 \\cdot 18974736 + 287496} = \\frac{2534921784}{284908536} \\approx 8.89730594 \\approx 8.897306 $$\n\n案例 3：$(p_{\\mathrm{scf}}, p_{\\mathrm{grad}}, S, I, g) = (3, 4, 20, 8, 3)$\n$$ R_3 = \\frac{8 \\cdot 114^3 + 3 \\cdot 114^4}{8 \\cdot 66^3 + 3 \\cdot 66^4} = \\frac{8 \\cdot 1481544 + 3 \\cdot 168896016}{8 \\cdot 287496 + 3 \\cdot 18974736} = \\frac{518540400}{59224176} \\approx 8.75567784 \\approx 8.755678 $$\n\n案例 4：$(p_{\\mathrm{scf}}, p_{\\mathrm{grad}}, S, I, g) = (3, 3, 1, 1, 0)$\n这里，$g=0$，因此梯度成本项为零。另请注意，$p_{\\mathrm{scf}}=p_{\\mathrm{grad}}$，尽管在 $g=0$ 时这无关紧要。\n$$ R_4 = \\frac{1 \\cdot 114^3 + 0 \\cdot 114^3}{1 \\cdot 66^3 + 0 \\cdot 66^3} = \\frac{114^3}{66^3} = \\left(\\frac{114}{66}\\right)^3 \\approx 5.15201173 \\approx 5.152012 $$\n这个结果与案例 1 相同，因为该比率仅取决于公共指数 $3$。\n\n案例 5：$(p_{\\mathrm{scf}}, p_{\\mathrm{grad}}, S, I, g) = (2.5, 3.5, 25, 25, 1.5)$\n指数是非整数，这在拟合经验标度数据时很常见。\n$$ R_5 = \\frac{25 \\cdot 114^{2.5} + 1.5 \\cdot 114^{3.5}}{25 \\cdot 66^{2.5} + 1.5 \\cdot 66^{3.5}} $$\n计算幂：\n$114^{2.5} \\approx 138763.33235$\n$114^{3.5} \\approx 15818960.038$\n$66^{2.5} \\approx 35386.43949$\n$66^{3.5} \\approx 2335492.206$\n代入这些值：\n$$ R_5 \\approx \\frac{25 \\cdot (138763.33235) + 1.5 \\cdot (15818960.038)}{25 \\cdot (35386.43949) + 1.5 \\cdot (2335492.206)} = \\frac{3469083.30875 + 23728440.057}{884660.98725 + 3503238.309} = \\frac{27197523.36575}{4387899.29625} \\approx 6.19830571 \\approx 6.198306 $$\n最终计算出的比率，四舍五入到小数点后六位，是根据所提供的模型系统地计算出来的。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the computational chemistry cost ratio problem.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each tuple is (p_scf, p_grad, S, I, g).\n    # S is not used in the final ratio formula but is kept for completeness.\n    test_cases = [\n        (3, 3, 12, 10, 2),\n        (4, 3, 8, 15, 1),\n        (3, 4, 20, 8, 3),\n        (3, 3, 1, 1, 0),\n        (2.5, 3.5, 25, 25, 1.5)\n    ]\n\n    # Calculate the number of basis functions for each basis set.\n    # Benzene C6H6: 6 Carbon atoms, 6 Hydrogen atoms.\n    \n    # For 6-31G:\n    # C: 9 functions, H: 2 functions\n    N_g = 6 * 9 + 6 * 2\n\n    # For 6-31G(d,p):\n    # C: 9 (base) + 5 (d-functions) = 14 functions\n    # H: 2 (base) + 3 (p-functions) = 5 functions\n    N_gdp = 6 * (9 + 5) + 6 * (2 + 3)\n\n    results = []\n    for case in test_cases:\n        p_scf, p_grad, _, I, g = case\n\n        # Numerator of the ratio R: T(N_gdp) part\n        # The S factor cancels out, so we calculate I * N^p_scf + g * N^p_grad\n        numerator = I * (N_gdp ** p_scf) + g * (N_gdp ** p_grad)\n\n        # Denominator of the ratio R: T(N_g) part\n        denominator = I * (N_g ** p_scf) + g * (N_g ** p_grad)\n\n        # Compute the ratio\n        if denominator == 0:\n            # This case should not happen with the given inputs, but it is good practice\n            # to handle potential division by zero.\n            ratio = float('inf')\n        else:\n            ratio = numerator / denominator\n\n        # Round the result to exactly 6 digits after the decimal point\n        # and format it as a string to preserve trailing zeros if any.\n        results.append(f\"{ratio:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2460510"}, {"introduction": "在了解了成本之后，我们将探究极化函数的根本优势：能量稳定化。本练习将引导你为水分子构建一个简单的量子模型，从而揭示极化函数改善结果的原理。通过应用变分原理，你可以直接观察到基组扩展所带来的能量降低，将抽象概念与可计算的能量变化联系起来。[@problem_id:2460489]", "problem": "您将构建一个简化的变分紧束缚模型，以研究添加单个极化函数如何改变水分子的近似基态电子能量。比较的内容是：在每个氢原子上添加一个 $p$ 型基函数（每个氢原子上一个，沿 O–H 键方向排列）与在氧原子上添加一个 $d$ 型基函数（一个类 $d_{z^2}$ 函数，沿分子角平分线排列）这两种情况。您的程序必须基于第一性原理，使用线性代数和 Rayleigh–Ritz 变分原理来实现以下内容。\n\n基本出发点：\n- Rayleigh–Ritz 变分原理指出，在任何子空间中，哈密顿矩阵 $H$ 的最低本征值是真实基态能量的一个上界，并且扩大基组（子空间）不会使变分能量增加。\n- 在具有标准正交基的原子轨道线性组合 (LCAO) 单电子紧束缚模型中，一个闭壳层体系的近似总电子能量计算公式为 $E_{\\mathrm{tot}} = 2 \\sum_{i=1}^{N_{\\mathrm{occ}}} \\varepsilon_i$，其中 $\\varepsilon_i$ 是 $H$ 的最低本征值，而 $N_{\\mathrm{occ}}$ 是已占据空间分子轨道的数量。\n\n几何结构与基组：\n- 考虑水分子，其键角为 $\\theta$（单位为度），两个相同的 O–H 键位于 $x$–$z$ 平面内。将氧原子置于原点。定义沿两个 O–H 键的单位矢量为 $\\mathbf{u}_1 = (\\sin(\\theta/2), 0, \\cos(\\theta/2))$ 和 $\\mathbf{u}_2 = (-\\sin(\\theta/2), 0, \\cos(\\theta/2))$。使用标准的笛卡尔基矢量 $\\mathbf{e}_x$、$\\mathbf{e}_y$ 和 $\\mathbf{e}_z$。\n- 最小基组由一个氧 $2s$ 轨道、一个氧 $2p_x$ 轨道、一个氧 $2p_y$ 轨道、一个氧 $2p_z$ 轨道以及每个氢原子上的一个氢 $1s$ 轨道组成。将其在位能分别表示为 $\\varepsilon_{\\mathrm{O}2s}$、$\\varepsilon_{\\mathrm{O}2p}$（三个氧 $2p$ 轨道共用）和 $\\varepsilon_{\\mathrm{H}1s}$。\n- 极化函数选项：\n  1. 氢 $p$ 轨道：在每个氢原子上添加一个 $p$ 型轨道，沿其 O–H 键方向排列（每个氢原子上一个）。其在位能为 $\\varepsilon_{\\mathrm{H}p}$。\n  2. 氧 $d$ 轨道：添加一个沿 $\\mathbf{e}_z$ 排列的类氧 $d_{z^2}$ 轨道，其在位能为 $\\varepsilon_{\\mathrm{O}d}$。\n\n哈密顿矩阵构建（标准正交基，无重叠矩阵）：\n- 对角元素为在位能。\n- 双中心非对角耦合项使用 Slater–Koster 型方向因子：\n  - 氧 $2s$ 和氢 $1s$ 之间：$V_{ss\\sigma}$，对两个 O–H 键相同。\n  - 氧 $2p_i$ 和氢 $1s$ 之间：$V_{sp\\sigma} \\, (\\mathbf{e}_i \\cdot \\mathbf{u}_k)$，其中 $i \\in \\{x,y,z\\}$ 且 $k \\in \\{1,2\\}$。\n  - 如果存在氢 $p$ 轨道，氧 $2s$ 与键 $k$ 上的氢 $p$ 轨道之间的耦合为 $V_{s p(\\mathrm{H}) \\sigma}$，氧 $2p_i$ 与键 $k$ 上的氢 $p$ 轨道之间的耦合为 $V_{pp\\sigma} \\, (\\mathbf{e}_i \\cdot \\mathbf{u}_k)$（氢 $p$ 轨道的轴与 $\\mathbf{u}_k$ 对齐）。\n  - 如果存在氧 $d_{z^2}$ 轨道，其与键 $k$ 上的氢 $1s$ 轨道的耦合为 $V_{sd\\sigma} \\, F_{sd}(\\mathbf{u}_k)$，其中 $F_{sd}(\\mathbf{u}_k)$ 是一个方向因子。使用四极矩因子 $F_{sd}(\\mathbf{u}_k) = \\frac{1}{2} \\left( 3 n_k^2 - 1 \\right)$，其中 $n_k = \\mathbf{u}_k \\cdot \\mathbf{e}_z = \\cos(\\theta/2)$。\n- 不包含其他非对角矩阵元素。根据构造，哈密顿矩阵是实对称的。\n\n电子计数与能量：\n- 在此模型中，水有 $8$ 个价电子，因此有 $N_{\\mathrm{occ}} = 4$ 个双占据轨道。对于给定的哈密顿矩阵 $H$，对其进行对角化以获得按升序排列的本征值 $\\{\\varepsilon_i\\}$，并计算总能量 $E_{\\mathrm{tot}} = 2 \\sum_{i=1}^{4} \\varepsilon_i$，单位为哈特里 (hartree)。\n- 设 $E_0$ 为使用最小基组（无极化函数）时的总能量，$E_{\\mathrm{H}p}$ 为添加氢 $p$ 轨道时的总能量，$E_{\\mathrm{O}d}$ 为添加氧 $d$ 轨道时的总能量。定义稳定化能为 $\\Delta E_{\\mathrm{H}p} = E_{\\mathrm{H}p} - E_0$ 和 $\\Delta E_{\\mathrm{O}d} = E_{\\mathrm{O}d} - E_0$（值越负表示稳定化效果越强）。\n\n您的任务：\n- 完全按照规定实现上述模型。角度以度为单位提供；如果您使用三角函数，请在内部将其转换为弧度。\n- 对于下面的每个测试用例，计算 $\\Delta E_{\\mathrm{H}p}$ 和 $\\Delta E_{\\mathrm{O}d}$（单位为哈特里），并判断哪种极化选项产生的稳定化效果在数值上更大。定义一个索引 $b$，如果氢 $p$ 轨道的稳定化效果更强（即 $\\Delta E_{\\mathrm{H}p}  \\Delta E_{\\mathrm{O}d}$），则 $b$ 为 $0$；如果氧 $d$ 轨道的稳定化效果更强（即 $\\Delta E_{\\mathrm{O}d}  \\Delta E_{\\mathrm{H}p}$），则 $b$ 为 $1$；如果二者在 $10^{-9}$ 的绝对容差内相等，则 $b$ 为 $2$。\n- 所有能量均以哈特里表示。最终输出必须是单行，包含每个测试用例结果的列表，其中每个结果都是 $[\\Delta E_{\\mathrm{H}p}, \\Delta E_{\\mathrm{O}d}, b]$ 形式的列表。在打印输出中，将每个浮点数能量四舍五入到 $6$ 位小数。\n\n测试套件（三个用例，所有能量单位为哈特里，$\\theta$ 单位为度）：\n- 用例 A（典型耦合）：$\\theta = 104.5$, $\\varepsilon_{\\mathrm{O}2s} = -1.20$, $\\varepsilon_{\\mathrm{O}2p} = -0.52$, $\\varepsilon_{\\mathrm{H}1s} = -0.50$, $V_{ss\\sigma} = -0.22$, $V_{sp\\sigma} = -0.30$, $V_{s p(\\mathrm{H}) \\sigma} = -0.25$, $V_{pp\\sigma} = -0.10$, $\\varepsilon_{\\mathrm{H}p} = -0.125$, $\\varepsilon_{\\mathrm{O}d} = 0.20$, $V_{sd\\sigma} = -0.12$.\n- 用例 B（高能极化轨道，效果弱）：与用例 A 相同，但 $\\varepsilon_{\\mathrm{H}p} = 1.00$ 且 $\\varepsilon_{\\mathrm{O}d} = 2.00$。\n- 用例 C（氢 $p$ 弱耦合，氧 $d$ 中等耦合）：与用例 A 相同，但 $V_{s p(\\mathrm{H}) \\sigma} = -0.05$, $V_{pp\\sigma} = -0.02$, $\\varepsilon_{\\mathrm{O}d} = 0.30$, 且 $V_{sd\\sigma} = -0.20$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含按 A、B、C 顺序排列的三个测试用例的结果，形式为逗号分隔的列表的列表，例如：$[[x_{A},y_{A},b_{A}],[x_{B},y_{B},b_{B}],[x_{C},y_{C},b_{C}]]$，其中每个 $x$ 和 $y$ 是四舍五入到 $6$ 位小数的浮点数，每个 $b$ 是一个整数。", "solution": "所述问题是量子化学中一个适定 (well-posed) 的练习。它在科学上基于原子轨道线性组合 (LCAO) 近似和 Rayleigh-Ritz 变分原理。所有必要的参数都已提供，目标清晰且形式明确。我们将进行推导和求解。\n\n**1. 基本原理**\n\n理论基础是 Rayleigh-Ritz 变分原理。该原理指出，对于一个给定的哈密顿算符为 $\\hat{H}$ 的量子体系，任何试探波函数 $\\Psi$ 的能量期望值都是真实基态能量 $E_{\\mathrm{gs}}$ 的一个上界：\n$$\n\\frac{\\langle\\Psi|\\hat{H}|\\Psi\\rangle}{\\langle\\Psi|\\Psi\\rangle} \\geq E_{\\mathrm{gs}}\n$$\n在 LCAO 方法中，分子轨道 (MOs) $\\psi_i$ 被近似为一组有限原子轨道 (AOs) $\\{\\phi_j\\}_{j=1}^{N}$ 的线性组合：\n$$\n\\psi_i = \\sum_{j=1}^{N} c_{ji} \\phi_j\n$$\n将变分原理应用于此基组，可将薛定谔方程转化为一个矩阵本征值问题。对于一个标准正交的原子轨道基组（$\\langle\\phi_j|\\phi_k\\rangle = \\delta_{jk}$），这是一个标准的本征值方程：\n$$\nH C = C \\mathcal{E}\n$$\n其中 $H$ 是哈密顿矩阵，其元素为 $H_{jk} = \\langle\\phi_j|\\hat{H}|\\phi_k\\rangle$，$C$ 是系数 $c_{ji}$ 构成的矩阵，$\\mathcal{E}$ 是分子轨道能量 $\\varepsilon_i$ 的对角矩阵。最低的本征值 $\\varepsilon_1$ 是体系中单个电子基态能量的变分近似。增加基函数（即增加 $N$）会扩大变分空间，这只会降低或保持计算出的本征值，从而提供对真实能量更好（或相等）的近似。\n\n对于一个有 $2N_{\\mathrm{occ}}$ 个电子的闭壳层体系，总电子能量通过对已占据分子轨道的能量求和来近似，并考虑双占据：\n$$\nE_{\\mathrm{tot}} = 2 \\sum_{i=1}^{N_{\\mathrm{occ}}} \\varepsilon_i\n$$\n在这个关于水的问题中，有 $8$ 个价电子，所以我们占据最低的 $N_{\\mathrm{occ}} = 4$ 个空间分子轨道。\n\n**2. 体系规格与基组**\n\n水分子被置于 $xz$ 平面内，氧原子位于原点 $(0, 0, 0)$。O-H 键矢量由 $\\mathbf{u}_1 = (\\sin(\\theta/2), 0, \\cos(\\theta/2))$ 和 $\\mathbf{u}_2 = (-\\sin(\\theta/2), 0, \\cos(\\theta/2))$ 给出，其中 $\\theta$ 是键角。我们将构建对应于三个不同基组的三个哈密顿矩阵。\n\n**基组 A：最小基组**\n该基组由 $N=6$ 个原子轨道组成：\n$$\n\\{ \\phi_{\\mathrm{O}2s}, \\phi_{\\mathrm{O}2p_x}, \\phi_{\\mathrm{O}2p_y}, \\phi_{\\mathrm{O}2p_z}, \\phi_{\\mathrm{H1}1s}, \\phi_{\\mathrm{H2}1s} \\}\n$$\n对应的哈密顿矩阵 $H_0$ 是一个 $6 \\times 6$ 矩阵。\n\n**基组 B：最小基组 + 氢 $p$ 极化轨道**\n该基组在每个氢原子上增加一个沿 O-H 键排列的 $p$ 型轨道。这使得原子轨道总数为 $N=8$：\n$$\n\\{ \\phi_{\\mathrm{O}2s}, \\dots, \\phi_{\\mathrm{H2}1s}, \\phi_{\\mathrm{H1}p}, \\phi_{\\mathrm{H2}p} \\}\n$$\n对应的哈密顿矩阵 $H_{\\mathrm{H}p}$ 是一个 $8 \\times 8$ 矩阵。\n\n**基组 C：最小基组 + 氧 $d$ 极化轨道**\n该基组在氧原子上增加一个沿 $z$ 轴排列的类 $d_{z^2}$ 轨道。这使得原子轨道总数为 $N=7$：\n$$\n\\{ \\phi_{\\mathrm{O}2s}, \\dots, \\phi_{\\mathrm{H2}1s}, \\phi_{\\mathrm{O}d_{z^2}} \\}\n$$\n对应的哈密顿矩阵 $H_{\\mathrm{O}d}$ 是一个 $7 \\times 7$ 矩阵。\n\n**3. 哈密顿矩阵构建**\n\n哈密顿矩阵元素 $H_{jk}$ 由在位能（对角项，$j=k$）和耦合项（非对角项，$j \\neq k$）给出。\n\n**对角元素（在位能）：**\n这些作为参数给出：\n$H_{ii} = \\varepsilon_{\\mathrm{O}2s}$ 对于 O $2s$ 轨道。\n$H_{ii} = \\varepsilon_{\\mathrm{O}2p}$ 对于所有三个 O $2p$ 轨道。\n$H_{ii} = \\varepsilon_{\\mathrm{H}1s}$ 对于两个 H $1s$ 轨道。\n$H_{ii} = \\varepsilon_{\\mathrm{H}p}$ 对于 H $p$ 极化轨道。\n$H_{ii} = \\varepsilon_{\\mathrm{O}d}$ 对于 O $d$ 极化轨道。\n\n**非对角元素（耦合项）：**\n非对角元素根据提供的类 Slater-Koster 规则构建。设基轨道按上述定义的顺序索引。设 $\\theta_r = \\theta \\cdot \\pi/180$ 为以弧度为单位的角度。\n\n**对于最小基组的哈密顿矩阵 $H_0$ ($6 \\times 6$)：**\n\\begin{itemize}\n    \\item $H_{0,4} = H_{0,5} = V_{ss\\sigma}$ （O $2s$ 与 H $1s$ 之间的耦合）\n    \\item $H_{1,4} = V_{sp\\sigma} (\\mathbf{e}_x \\cdot \\mathbf{u}_1) = V_{sp\\sigma} \\sin(\\theta_r/2)$\n    \\item $H_{1,5} = V_{sp\\sigma} (\\mathbf{e}_x \\cdot \\mathbf{u}_2) = -V_{sp\\sigma} \\sin(\\theta_r/2)$\n    \\item $H_{2,4} = H_{2,5} = V_{sp\\sigma} (\\mathbf{e}_y \\cdot \\mathbf{u}_{1,2}) = 0$\n    \\item $H_{3,4} = H_{3,5} = V_{sp\\sigma} (\\mathbf{e}_z \\cdot \\mathbf{u}_{1,2}) = V_{sp\\sigma} \\cos(\\theta_r/2)$\n\\end{itemize}\n所有其他非对角元素均为 $0$。矩阵是对称的，因此 $H_{ji} = H_{ij}$。\n\n**对于哈密顿矩阵 $H_{\\mathrm{H}p}$ ($8 \\times 8$)：**\n左上角的 $6 \\times 6$ 子矩阵与 $H_0$ 相同。涉及 H $p$ 轨道（索引为 $6, 7$）的新元素为：\n\\begin{itemize}\n    \\item $H_{0,6} = H_{0,7} = V_{s p(\\mathrm{H}) \\sigma}$ （O $2s$ 与 H $p$ 之间的耦合）\n    \\item $H_{1,6} = V_{pp\\sigma} (\\mathbf{e}_x \\cdot \\mathbf{u}_1) = V_{pp\\sigma} \\sin(\\theta_r/2)$\n    \\item $H_{1,7} = V_{pp\\sigma} (\\mathbf{e}_x \\cdot \\mathbf{u}_2) = -V_{pp\\sigma} \\sin(\\theta_r/2)$\n    \\item $H_{2,6} = H_{2,7} = 0$\n    \\item $H_{3,6} = H_{3,7} = V_{pp\\sigma} (\\mathbf{e}_z \\cdot \\mathbf{u}_{1,2}) = V_{pp\\sigma} \\cos(\\theta_r/2)$\n\\end{itemize}\n\n**对于哈密顿矩阵 $H_{\\mathrm{O}d}$ ($7 \\times 7$)：**\n左上角的 $6 \\times 6$ 子矩阵与 $H_0$ 相同。涉及 O $d_{z^2}$ 轨道（索引为 $6$）的新元素为：\n\\begin{itemize}\n    \\item 问题说明耦合仅存在于 O $d_{z^2}$ 和 H $1s$ 之间。\n    \\item 设 $n_k = \\mathbf{u}_k \\cdot \\mathbf{e}_z = \\cos(\\theta_r/2)$。方向因子为 $F_{sd} = \\frac{1}{2}(3n_k^2 - 1)$。该因子对两个氢原子是相同的。\n    \\item $H_{4,6} = V_{sd\\sigma} F_{sd}$ （H1 $1s$ 与 O $d_{z^2}$ 之间的耦合）\n    \\item $H_{5,6} = V_{sd\\sigma} F_{sd}$ （H2 $1s$ 与 O $d_{z^2}$ 之间的耦合）\n\\end{itemize}\n\n**4. 能量计算与比较**\n\n对于每个哈密顿矩阵（$H_0$、$H_{\\mathrm{H}p}$、$H_{\\mathrm{O}d}$），我们数值计算其按升序排列的本征值 $\\{\\varepsilon_i\\}$。然后总能量计算为 $E = 2 \\sum_{i=1}^{4} \\varepsilon_i$。这样我们就得到了 $E_0$、$E_{\\mathrm{H}p}$ 和 $E_{\\mathrm{O}d}$。\n\n由极化函数引起的稳定化能定义为：\n$$\n\\Delta E_{\\mathrm{H}p} = E_{\\mathrm{H}p} - E_0\n$$\n$$\n\\Delta E_{\\mathrm{O}d} = E_{\\mathrm{O}d} - E_0\n$$\n根据变分原理，$\\Delta E_{\\mathrm{H}p} \\le 0$ 且 $\\Delta E_{\\mathrm{O}d} \\le 0$。值越负表示稳定化效果越强。\n\n最后，我们通过比较 $\\Delta E_{\\mathrm{H}p}$ 和 $\\Delta E_{\\mathrm{O}d}$ 来确定哪一组极化函数更有效。索引 $b$ 的赋值规则如下：\n\\begin{itemize}\n    \\item 如果 $\\Delta E_{\\mathrm{H}p}  \\Delta E_{\\mathrm{O}d}$，则 $b=0$\n    \\item 如果 $\\Delta E_{\\mathrm{O}d}  \\Delta E_{\\mathrm{H}p}$，则 $b=1$\n    \\item 如果 $|\\Delta E_{\\mathrm{H}p} - \\Delta E_{\\mathrm{O}d}| \\leq 10^{-9}$，则 $b=2$\n\\end{itemize}\n\n此过程将应用于问题描述中指定的每个测试用例。该算法将使用 Python 和 NumPy 库进行线性代数运算来实现。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the tight-binding model for all test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A\n        {\n            \"theta\": 104.5, \"eps_O2s\": -1.20, \"eps_O2p\": -0.52, \"eps_H1s\": -0.50,\n            \"V_ss_sigma\": -0.22, \"V_sp_sigma\": -0.30, \"V_spH_sigma\": -0.25,\n            \"V_pp_sigma\": -0.10, \"eps_Hp\": -0.125, \"eps_Od\": 0.20, \"V_sd_sigma\": -0.12\n        },\n        # Case B\n        {\n            \"theta\": 104.5, \"eps_O2s\": -1.20, \"eps_O2p\": -0.52, \"eps_H1s\": -0.50,\n            \"V_ss_sigma\": -0.22, \"V_sp_sigma\": -0.30, \"V_spH_sigma\": -0.25,\n            \"V_pp_sigma\": -0.10, \"eps_Hp\": 1.00, \"eps_Od\": 2.00, \"V_sd_sigma\": -0.12\n        },\n        # Case C\n        {\n            \"theta\": 104.5, \"eps_O2s\": -1.20, \"eps_O2p\": -0.52, \"eps_H1s\": -0.50,\n            \"V_ss_sigma\": -0.22, \"V_sp_sigma\": -0.30, \"V_spH_sigma\": -0.05,\n            \"V_pp_sigma\": -0.02, \"eps_Hp\": -0.125, \"eps_Od\": 0.30, \"V_sd_sigma\": -0.20\n        },\n    ]\n\n    results_str = []\n    for params in test_cases:\n        delta_E_Hp, delta_E_Od, b = calculate_stabilizations(params)\n        res_str = f\"[{delta_E_Hp:.6f},{delta_E_Od:.6f},{b}]\"\n        results_str.append(res_str)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results_str)}]\")\n\ndef calculate_stabilizations(params):\n    \"\"\"\n    Calculates stabilization energies for a single set of parameters.\n    \"\"\"\n    # Unpack parameters\n    theta_deg = params[\"theta\"]\n    eps_O2s = params[\"eps_O2s\"]\n    eps_O2p = params[\"eps_O2p\"]\n    eps_H1s = params[\"eps_H1s\"]\n    V_ss_sigma = params[\"V_ss_sigma\"]\n    V_sp_sigma = params[\"V_sp_sigma\"]\n    V_spH_sigma = params[\"V_spH_sigma\"]\n    V_pp_sigma = params[\"V_pp_sigma\"]\n    eps_Hp = params[\"eps_Hp\"]\n    eps_Od = params[\"eps_Od\"]\n    V_sd_sigma = params[\"V_sd_sigma\"]\n\n    # Geometric factors\n    theta_rad = np.deg2rad(theta_deg)\n    sin_half_theta = np.sin(theta_rad / 2)\n    cos_half_theta = np.cos(theta_rad / 2)\n\n    # Number of occupied orbitals for H2O (8 valence electrons)\n    n_occ = 4\n    \n    # 1. Energy with minimal basis (E0)\n    # Basis: {O2s, O2px, O2py, O2pz, H1s, H2s}\n    H0 = np.zeros((6, 6))\n    H0[0, 0] = eps_O2s\n    H0[1, 1] = H0[2, 2] = H0[3, 3] = eps_O2p\n    H0[4, 4] = H0[5, 5] = eps_H1s\n\n    # O2s - H1s/H2s\n    H0[0, 4] = H0[4, 0] = V_ss_sigma\n    H0[0, 5] = H0[5, 0] = V_ss_sigma\n    # O2p - H1s/H2s\n    H0[1, 4] = H0[4, 1] = V_sp_sigma * sin_half_theta\n    H0[1, 5] = H0[5, 1] = V_sp_sigma * -sin_half_theta\n    H0[3, 4] = H0[4, 3] = V_sp_sigma * cos_half_theta\n    H0[3, 5] = H0[5, 3] = V_sp_sigma * cos_half_theta\n    # O2py has zero coupling due to symmetry\n    \n    eigvals0 = np.linalg.eigh(H0)[0]\n    E0 = 2 * np.sum(eigvals0[:n_occ])\n\n    # 2. Energy with H-p polarization (EHp)\n    # Basis: {O2s, O2px, O2py, O2pz, H1s, H2s, H1p, H2p}\n    HHp = np.zeros((8, 8))\n    HHp[:6, :6] = H0\n    HHp[6, 6] = HHp[7, 7] = eps_Hp\n\n    # O2s - H1p/H2p\n    HHp[0, 6] = HHp[6, 0] = V_spH_sigma\n    HHp[0, 7] = HHp[7, 0] = V_spH_sigma\n    # O2p - H1p/H2p\n    HHp[1, 6] = HHp[6, 1] = V_pp_sigma * sin_half_theta\n    HHp[1, 7] = HHp[7, 1] = V_pp_sigma * -sin_half_theta\n    HHp[3, 6] = HHp[6, 3] = V_pp_sigma * cos_half_theta\n    HHp[3, 7] = HHp[7, 3] = V_pp_sigma * cos_half_theta\n    \n    eigvals_Hp = np.linalg.eigh(HHp)[0]\n    EHp = 2 * np.sum(eigvals_Hp[:n_occ])\n    delta_E_Hp = EHp - E0\n\n    # 3. Energy with O-d polarization (EOd)\n    # Basis: {O2s, O2px, O2py, O2pz, H1s, H2s, Odz2}\n    HOd = np.zeros((7, 7))\n    HOd[:6, :6] = H0\n    HOd[6, 6] = eps_Od\n    \n    # Odz2 - H1s/H2s\n    nk = cos_half_theta\n    F_sd = 0.5 * (3 * nk**2 - 1)\n    HOd[4, 6] = HOd[6, 4] = V_sd_sigma * F_sd\n    HOd[5, 6] = HOd[6, 5] = V_sd_sigma * F_sd\n    \n    eigvals_Od = np.linalg.eigh(HOd)[0]\n    EOd = 2 * np.sum(eigvals_Od[:n_occ])\n    delta_E_Od = EOd - E0\n\n    # 4. Compare stabilizations\n    if np.abs(delta_E_Hp - delta_E_Od) = 1e-9:\n        b = 2\n    elif delta_E_Hp  delta_E_Od:\n        b = 0\n    else:\n        b = 1\n        \n    return delta_E_Hp, delta_E_Od, b\n\nsolve()\n```", "id": "2460489"}, {"introduction": "最后，我们将展示极化函数不仅关乎总能量，对于准确描述分子性质也至关重要。这个更深入的练习聚焦于一氧化碳($\\mathrm{CO}$)分子的偶极矩，这是一个对电荷分布极为敏感的物理量。你将通过扫描势能面来寻找碳原子上d函数的最佳指数，从而理解微调基组参数以获得物理意义正确结果的重要性。[@problem_id:2460492]", "problem": "要求您建立一个模型，模拟一氧化碳(CO)中碳原子上的单个笛卡尔$d$型高斯极化函数如何影响成键轨道的偶极矩，方法是扫描$d$函数的指数，并选择能产生最大电子偶极矩（以原子单位计）的指数。该模型必须完全由第一性原理定义，仅使用解析高斯积分，并且严格自洽。\n\n考虑一个沿$z$轴排列的双原子分子，其中碳原子核位于位置$\\mathbf{R}_{\\mathrm{C}} = (0,0,-R/2)$，氧原子核位于位置$\\mathbf{R}_{\\mathrm{O}} = (0,0,+R/2)$，其中$R$是核间距，单位为玻尔半径（原子单位）。令$Z_{\\mathrm{O}}$为氧的核电荷，仅用于定义碳位置处的静电场。\n\n基函数为非收缩、归一化的笛卡尔高斯型轨道(GTOs)。一个中心位于$\\mathbf{A}$、角动量指数为$(l,m,n)$、轨道指数为$\\alpha$的笛卡尔GTO定义为\n$$\n\\chi_{lmn}(\\mathbf{r};\\alpha,\\mathbf{A}) = N(l,m,n;\\alpha) \\,(x-A_x)^l (y-A_y)^m (z-A_z)^n \\, e^{-\\alpha |\\mathbf{r}-\\mathbf{A}|^2},\n$$\n其归一化常数为\n$$\nN(l,m,n;\\alpha) = \\left[ \\left(\\frac{2\\alpha}{\\pi}\\right)^{3/2} \\frac{(4\\alpha)^{l+m+n}}{(2l-1)!!\\,(2m-1)!!\\,(2n-1)!!} \\right]^{1/2},\n$$\n其中，按照惯例，$( -1 )!! = 1$ 且对于$k \\ge 1$，$(2k-1)!! = (2k-1)(2k-3)\\cdots 3 \\cdot 1$。\n\n使用以下三个基函数：\n- 类碳$2p_z$函数：$\\chi_{\\mathrm{C}p}(\\mathbf{r}) = \\chi_{001}(\\mathbf{r};\\zeta_{p\\mathrm{C}}, \\mathbf{R}_{\\mathrm{C}})$，\n- 类氧$2p_z$函数：$\\chi_{\\mathrm{O}p}(\\mathbf{r}) = \\chi_{001}(\\mathbf{r};\\zeta_{p\\mathrm{O}}, \\mathbf{R}_{\\mathrm{O}})$，\n- 类碳极化$d_{zz}$函数：$\\chi_{\\mathrm{C}d}(\\mathbf{r}) = \\chi_{002}(\\mathbf{r};\\zeta_{d}, \\mathbf{R}_{\\mathrm{C}})$，其中$\\zeta_d$是待扫描的可变指数。\n\n占据的成键分子轨道被限制在碳和氧上的两个类$p_z$函数内。其系数通过求解$2\\times 2$的广义本征值问题得到\n$$\n\\mathbf{H} \\,\\mathbf{c} = \\varepsilon \\,\\mathbf{S}\\,\\mathbf{c},\n$$\n其中重叠矩阵为\n$$\n\\mathbf{S} = \\begin{pmatrix}\n1  S_{CO} \\\\\nS_{CO}  1\n\\end{pmatrix}, \\quad S_{CO} = \\int \\chi_{\\mathrm{C}p}(\\mathbf{r}) \\,\\chi_{\\mathrm{O}p}(\\mathbf{r})\\, d^3\\mathbf{r},\n$$\n哈密顿矩阵由在位能和非对角相互作用指定，\n$$\n\\mathbf{H} = \\begin{pmatrix}\n\\alpha_{\\mathrm{C,eff}}(\\zeta_d)  H_{CO} \\\\\nH_{CO}  \\alpha_{\\mathrm{O}}\n\\end{pmatrix}, \\quad H_{CO} = K \\, S_{CO} \\, \\frac{\\alpha_{\\mathrm{C,eff}}(\\zeta_d)+\\alpha_{\\mathrm{O}}}{2},\n$$\n其中$K$是一个给定常数，$\\alpha_{\\mathrm{O}}$是给定的氧$2p$在位能（单位为哈特里）。碳的有效在位能考虑了在氧核产生的静电场中，$\\chi_{\\mathrm{C}p}$和$\\chi_{\\mathrm{C}d}$之间的二阶斯塔克混合：\n$$\n\\alpha_{\\mathrm{C,eff}}(\\zeta_d) = \\alpha_{\\mathrm{C}} - \\frac{|\\mathcal{F}_z|^2}{\\Delta \\varepsilon_{pd}} \\left| \\langle \\chi_{\\mathrm{C}p} \\,|\\, z \\,|\\, \\chi_{\\mathrm{C}d} \\rangle \\right|^2,\n$$\n其中$\\alpha_{\\mathrm{C}}$是未微扰的碳$2p$在位能（单位为哈特里），$\\Delta \\varepsilon_{pd}$是碳的类d能级和类p能级之间的一个正能隙（单位为哈特里），$\\mathcal{F}_z$是氧核在$\\mathbf{R}_{\\mathrm{C}}$处产生的电场的z分量，由下式给出\n$$\n\\mathcal{F}_z = \\frac{Z_{\\mathrm{O}}}{R^2},\n$$\n以及在同一中心的z算符矩阵元\n$$\n\\langle \\chi_{\\mathrm{C}p} \\,|\\, z \\,|\\, \\chi_{\\mathrm{C}d} \\rangle = \\int \\chi_{\\mathrm{C}p}(\\mathbf{r}) \\, z \\,\\chi_{\\mathrm{C}d}(\\mathbf{r}) \\, d^3\\mathbf{r}.\n$$\n\n您必须根据以上定义解析地计算所有需要的积分。具体来说：\n- 对于沿z轴、位于不同中心的两个笛卡尔$p_z$型GTO，其重叠积分$S_{CO}$必须精确计算。\n- 在$\\mathbf{R}_{\\mathrm{C}}$处，$\\chi_{001}$和$\\chi_{002}$之间的同中心z算符矩阵元必须精确计算。\n\n假设成键轨道是双占据的。给定与最低本征值关联的归一化本征矢量$\\mathbf{c} = (c_{\\mathrm{C}}, c_{\\mathrm{O}})^{\\top}$，为这个占据数为2的单占据分子轨道构建$2\\times 2$的密度矩阵：\n$$\n\\mathbf{P} = 2\\, \\mathbf{c}\\,\\mathbf{c}^{\\top}.\n$$\n使用Mulliken布居分析，碳和氧上的总布居数为\n$$\nq_{\\mathrm{C}} = \\sum_{\\nu\\in\\{\\mathrm{C},\\mathrm{O}\\}} P_{\\mathrm{C}\\nu} S_{\\mathrm{C}\\nu}, \\quad\nq_{\\mathrm{O}} = \\sum_{\\nu\\in\\{\\mathrm{C},\\mathrm{O}\\}} P_{\\mathrm{O}\\nu} S_{\\mathrm{O}\\nu},\n$$\n注意$S_{\\mathrm{CC}} = S_{\\mathrm{OO}}=1$且$S_{\\mathrm{CO}}=S_{\\mathrm{O}\\mathrm{C}}$。将沿键轴的模型电子偶极矩（以原子单位计）定义为\n$$\n\\mu_z = - q_{\\mathrm{C}} \\left(-\\frac{R}{2}\\right) - q_{\\mathrm{O}} \\left(\\frac{R}{2}\\right) = \\left(q_{\\mathrm{C}} - q_{\\mathrm{O}}\\right)\\frac{R}{2}.\n$$\n\n任务。对于下面的每个测试用例，扫描碳d型极化函数的一组指定的有限候选指数$\\zeta_d \\in \\mathcal{G}$，并计算得到的模型电子偶极矩的大小$|\\mu_z|$。报告$\\mathcal{G}$中使$|\\mu_z|$最大化的$\\zeta_d$值。如果出现精确相等的情况（在您的计算的实数相等范围内），请在相等的候选项中选择最小的$\\zeta_d$。\n\n物理常数和单位。全部使用原子单位。所有能量必须以哈特里为单位，距离以玻尔半径为单位，偶极矩以原子单位为单位。需要打印的最终答案是指数$\\zeta_d$（无单位数字）。\n\n参数值。对于所有测试用例，使用：\n- 碳$2p$指数 $\\zeta_{p\\mathrm{C}} = 1.6$，\n- 氧$2p$指数 $\\zeta_{p\\mathrm{O}} = 2.3$，\n- Wolfsberg–Helmholtz常数 $K = 1.75$，\n- 碳$2p$在位能 $\\alpha_{\\mathrm{C}} = -0.5$，\n- 氧$2p$在位能 $\\alpha_{\\mathrm{O}} = -0.8$，\n- 碳$p$–$d$能隙 $\\Delta \\varepsilon_{pd} = 1.0$，\n- 候选极化指数网格 $\\mathcal{G} = [0.3,\\,0.5,\\,0.8,\\,1.2,\\,1.6,\\,2.0,\\,3.0,\\,4.0,\\,6.0]$。\n\n测试套件。评估以下三个测试用例：\n1. 正常路径：$R = 2.132$, $Z_{\\mathrm{O}} = 8.0$。\n2. 更强场（更短键长）：$R = 1.800$, $Z_{\\mathrm{O}} = 8.0$。\n3. 边界情况（碳上无外部场）：$R = 2.132$, $Z_{\\mathrm{O}} = 0.0$。\n\n要求的最终输出格式。您的程序应生成单行输出，包含一个含有三个数字的列表，这三个数字分别对应上述三个测试用例的最优$\\zeta_d$，顺序与上文一致。该列表必须以方括号括起来的逗号分隔列表形式打印，每个数字格式化为十进制浮点值。例如：\"[x1,x2,x3]\"。", "solution": "该问题已经过验证，被认为是科学上合理的、提法恰当的、客观的且内部一致的。它提出了一个简化的但有效的模型，该模型植根于量子化学原理，特别是关于基组和分子性质的原理。所有必要的参数和清晰的计算过程都已提供。因此，将构建一个完整的解决方案。\n\n问题的核心在于解析地计算两个量子力学积分，并随后实现一个计算模型来确定最优的极化函数指数。\n\n**1. 积分的解析计算**\n\n我们必须首先推导重叠积分$S_{CO}$和偶极矩阵元$D_{pd} = \\langle \\chi_{\\mathrm{C}p} \\,|\\, z \\,|\\, \\chi_{\\mathrm{C}d} \\rangle$的解析表达式。\n\n**A. 笛卡尔高斯型轨道(GTO)的归一化**\n\n给定一个GTO $\\chi_{lmn}(\\mathbf{r};\\alpha,\\mathbf{A})$的归一化常数为：\n$$\nN(l,m,n;\\alpha) = \\left[ \\left(\\frac{2\\alpha}{\\pi}\\right)^{3/2} \\frac{(4\\alpha)^{l+m+n}}{(2l-1)!!\\,(2m-1)!!\\,(2n-1)!!} \\right]^{1/2}\n$$\n对于一个类$p_z$函数($\\chi_{001}$)，我们有$l=0, m=0, n=1$。双阶乘$( -1 )!!$和$(1)!!$均为$1$。\n$$\nN(0,0,1;\\alpha)^2 = \\left(\\frac{2\\alpha}{\\pi}\\right)^{3/2} (4\\alpha) = \\frac{8\\alpha^{3/2}}{\\pi^{3/2}} 4\\alpha = \\frac{32\\alpha^{5/2}}{\\pi^{3/2}} = \\frac{2^{5}\\alpha^{5/2}}{\\pi^{3/2}}\n$$\n$$\nN_p(\\alpha) \\equiv N(0,0,1;\\alpha) = \\frac{2^{5/2}\\alpha^{5/4}}{\\pi^{3/4}}\n$$\n对于一个类$d_{zz}$函数($\\chi_{002}$)，我们有$l=0, m=0, n=2$。双阶乘为$( -1 )!!=1$, $( -1 )!!=1$和$(3)!!=3$。\n$$\nN(0,0,2;\\alpha)^2 = \\left(\\frac{2\\alpha}{\\pi}\\right)^{3/2} \\frac{(4\\alpha)^2}{3} = \\frac{8\\alpha^{3/2}}{\\pi^{3/2}} \\frac{16\\alpha^2}{3} = \\frac{128\\alpha^{7/2}}{3\\pi^{3/2}} = \\frac{2^{7}\\alpha^{7/2}}{3\\pi^{3/2}}\n$$\n$$\nN_d(\\alpha) \\equiv N(0,0,2;\\alpha) = \\frac{2^{7/2}\\alpha^{7/4}}{\\sqrt{3}\\pi^{3/4}}\n$$\n\n**B. 重叠积分 $S_{CO}$**\n\n重叠积分是在中心位于$\\mathbf{A} = \\mathbf{R}_{\\mathrm{C}} = (0,0,-R/2)$、指数为$\\alpha_A = \\zeta_{p\\mathrm{C}}$的$\\chi_{\\mathrm{C}p}$和中心位于$\\mathbf{B} = \\mathbf{R}_{\\mathrm{O}} = (0,0,R/2)$、指数为$\\alpha_B = \\zeta_{p\\mathrm{O}}$的$\\chi_{\\mathrm{O}p}$之间计算。\n高斯乘积定理指出，两个高斯函数的乘积是第三个高斯函数，其中心位于$\\mathbf{P} = (\\alpha_A \\mathbf{A} + \\alpha_B \\mathbf{B})/p$，其中$p=\\alpha_A+\\alpha_B$。该积分为：\n$$\nS_{CO} = N_p(\\alpha_A) N_p(\\alpha_B) \\int (z-A_z)(z-B_z) e^{-\\alpha_A|\\mathbf{r}-\\mathbf{A}|^2} e^{-\\alpha_B|\\mathbf{r}-\\mathbf{B}|^2} d^3\\mathbf{r}\n$$\n未归一化的积分可以计算为：\n$$\nI_{ov} = K_{AB} \\int (z' + P_z - A_z)(z' + P_z - B_z) e^{-p|\\mathbf{r}'|^2} d^3\\mathbf{r}'\n$$\n其中$\\mathbf{r}' = \\mathbf{r}-\\mathbf{P}$，以及$K_{AB} = e^{-\\frac{\\alpha_A \\alpha_B}{p}|\\mathbf{A}-\\mathbf{B}|^2} = e^{-\\mu R^2}$，其中$\\mu = \\frac{\\alpha_A \\alpha_B}{p}$。\n该积分的计算结果为：\n$$\nI_{ov} = K_{AB} \\left(\\frac{\\pi}{p}\\right)^{3/2} \\left[ \\frac{1}{2p} + (P_z - A_z)(P_z - B_z) \\right]\n$$\n当$A_z = -R/2$且$B_z=R/2$时，我们得到$P_z - A_z = \\alpha_B R/p$和$P_z - B_z = -\\alpha_A R/p$。\n$$\nI_{ov} = e^{-\\mu R^2} \\left(\\frac{\\pi}{p}\\right)^{3/2} \\left( \\frac{1}{2p} - \\frac{\\alpha_A \\alpha_B R^2}{p^2} \\right) = e^{-\\mu R^2} \\left(\\frac{\\pi}{p}\\right)^{3/2} \\frac{1}{p} \\left(\\frac{1}{2} - \\mu R^2 \\right)\n$$\n乘以归一化常数$N_p(\\alpha_A) N_p(\\alpha_B) = \\frac{2^5 (\\alpha_A \\alpha_B)^{5/4}}{\\pi^{3/2}}$：\n$$\nS_{CO} = \\frac{2^5 (\\alpha_A \\alpha_B)^{5/4}}{\\pi^{3/2}} e^{-\\mu R^2} \\frac{\\pi^{3/2}}{p^{5/2}} \\left(\\frac{1}{2} - \\mu R^2 \\right)\n$$\n代入$\\alpha_A=\\zeta_{p\\mathrm{C}}$和$\\alpha_B=\\zeta_{p\\mathrm{O}}$，我们得到最终表达式：\n$$\nS_{CO} = 32 \\, (\\zeta_{p\\mathrm{C}}\\zeta_{p\\mathrm{O}})^{5/4} (\\zeta_{p\\mathrm{C}}+\\zeta_{p\\mathrm{O}})^{-5/2} e^{-\\mu R^2} \\left(\\frac{1}{2} - \\mu R^2 \\right)\n$$\n\n**C. 偶极矩阵元 $D_{pd}$**\n\n这是一个在$\\mathbf{R}_{\\mathrm{C}}$处的同中心积分，在$\\chi_{\\mathrm{C}p}(\\mathbf{r}) = \\chi_{001}(\\mathbf{r};\\zeta_p, \\mathbf{R}_{\\mathrm{C}})$和$\\chi_{\\mathrm{C}d}(\\mathbf{r}) = \\chi_{002}(\\mathbf{r};\\zeta_d, \\mathbf{R}_{\\mathrm{C}})$之间。令$\\zeta_p = \\zeta_{p\\mathrm{C}}$。\n$$\nD_{pd} = \\int \\chi_{\\mathrm{C}p}^*(\\mathbf{r}) \\, z \\, \\chi_{\\mathrm{C}d}(\\mathbf{r}) \\, d^3\\mathbf{r}\n$$\n将原点移动到$\\mathbf{R}_{\\mathrm{C}}$，使得$\\mathbf{r}'=\\mathbf{r}-\\mathbf{R}_{\\mathrm{C}}$，算符变为$z=z'+R_{\\mathrm{C},z}$。\n$$\nD_{pd} = \\langle \\chi_{001} | z'+R_{\\mathrm{C},z} | \\chi_{002} \\rangle = \\langle \\chi_{001} | z' | \\chi_{002} \\rangle + R_{\\mathrm{C},z} \\langle \\chi_{001} | \\chi_{002} \\rangle\n$$\n重叠积分$\\langle \\chi_{001} | \\chi_{002} \\rangle$包含一个形如$\\int (z')^3 e^{-pz'^2} dz'$的积分，由于奇对称性，该积分为零。因此，第二项消失。\n第一项是：\n$$\n\\langle \\chi_{001} | z' | \\chi_{002} \\rangle = N_p(\\zeta_p) N_d(\\zeta_d) \\int (z') (z') (z')^2 e^{-(\\zeta_p+\\zeta_d)r'^2} d^3\\mathbf{r}'\n$$\n令$p = \\zeta_p+\\zeta_d$。未归一化的积分是：\n$$\nI_{dip} = \\int z'^4 e^{-pr'^2} d^3\\mathbf{r}' = \\left(\\int e^{-px^2}dx\\right) \\left(\\int e^{-py^2}dy\\right) \\left(\\int z'^4 e^{-pz'^2}dz'\\right)\n$$\n使用标准高斯积分，其计算结果为$I_{dip} = \\sqrt{\\frac{\\pi}{p}} \\sqrt{\\frac{\\pi}{p}} \\frac{3}{4p^2}\\sqrt{\\frac{\\pi}{p}} = \\frac{3\\pi^{3/2}}{4p^{7/2}}$。\n乘以归一化常数$N_p(\\zeta_p) = \\frac{2^{5/2}\\zeta_p^{5/4}}{\\pi^{3/4}}$和$N_d(\\zeta_d) = \\frac{2^{7/2}\\zeta_d^{7/4}}{\\sqrt{3}\\pi^{3/4}}$：\n$$\nD_{pd} = \\left(\\frac{2^{5/2}\\zeta_p^{5/4}}{\\pi^{3/4}}\\right) \\left(\\frac{2^{7/2}\\zeta_d^{7/4}}{\\sqrt{3}\\pi^{3/4}}\\right) \\frac{3\\pi^{3/2}}{4p^{7/2}} = \\frac{2^6 \\zeta_p^{5/4}\\zeta_d^{7/4}}{\\sqrt{3}\\pi^{3/2}} \\frac{3\\pi^{3/2}}{4p^{7/2}}\n$$\n化简后得到最终结果：\n$$\nD_{pd} = \\frac{48}{\\sqrt{3}} \\frac{\\zeta_p^{5/4}\\zeta_d^{7/4}}{p^{7/2}} = 16\\sqrt{3} \\, \\zeta_{p\\mathrm{C}}^{5/4} \\zeta_d^{7/4} (\\zeta_{p\\mathrm{C}}+\\zeta_d)^{-7/2}\n$$\n\n**2. 计算步骤**\n\n对于每个测试用例$(R, Z_{\\mathrm{O}})$以及来自网格$\\mathcal{G}$的每个候选指数$\\zeta_d$：\n1.  使用上面推导的公式计算常数重叠积分$S_{CO}$。\n2.  计算偶极矩阵元$D_{pd}(\\zeta_d)$。\n3.  计算碳位置处的电场，$\\mathcal{F}_z = Z_{\\mathrm{O}}/R^2$。\n4.  确定碳的有效在位能：$\\alpha_{\\mathrm{C,eff}}(\\zeta_d) = \\alpha_{\\mathrm{C}} - |\\mathcal{F}_z|^2 |D_{pd}|^2 / \\Delta \\varepsilon_{pd}$。\n5.  构建$2 \\times 2$的重叠矩阵和哈密顿矩阵：\n    $$\n    \\mathbf{S} = \\begin{pmatrix} 1  S_{CO} \\\\ S_{CO}  1 \\end{pmatrix}, \\quad\n    \\mathbf{H}(\\zeta_d) = \\begin{pmatrix}\n    \\alpha_{\\mathrm{C,eff}}(\\zeta_d)  K S_{CO} \\frac{\\alpha_{\\mathrm{C,eff}}(\\zeta_d)+\\alpha_{\\mathrm{O}}}{2} \\\\\n    K S_{CO} \\frac{\\alpha_{\\mathrm{C,eff}}(\\zeta_d)+\\alpha_{\\mathrm{O}}}{2}  \\alpha_{\\mathrm{O}}\n    \\end{pmatrix}\n    $$\n6.  求解广义本征值问题$\\mathbf{H}\\mathbf{c}=\\varepsilon\\mathbf{S}\\mathbf{c}$。这将产生两个本征值和两个对应的本征矢量。\n7.  选择与最低本征值（成键轨道）关联的本征矢量$\\mathbf{c}=(c_{\\mathrm{C}}, c_{\\mathrm{O}})^T$。假设该矢量被归一化，使得$\\mathbf{c}^T \\mathbf{S} \\mathbf{c} = 1$。\n8.  计算双占据轨道的Mulliken布居数：\n    $$\n    q_{\\mathrm{C}} = 2(c_{\\mathrm{C}}^2 + c_{\\mathrm{C}} c_{\\mathrm{O}} S_{CO}), \\quad q_{\\mathrm{O}} = 2(c_{\\mathrm{O}}^2 + c_{\\mathrm{C}} c_{\\mathrm{O}} S_{CO})\n    $$\n9.  计算沿z轴的电子偶极矩：\n    $$\n    \\mu_z = (q_{\\mathrm{C}} - q_{\\mathrm{O}}) \\frac{R}{2} = (2c_{\\mathrm{C}}^2 - 2c_{\\mathrm{O}}^2)\\frac{R}{2} = (c_{\\mathrm{C}}^2 - c_{\\mathrm{O}}^2)R\n    $$\n10. 存储当前$\\zeta_d$对应的绝对值$|\\mu_z|$。\n在遍历所有$\\zeta_d \\in \\mathcal{G}$之后，选择产生最大$|\\mu_z|$的$\\zeta_d$值。如果多个$\\zeta_d$值导致了相同的最大$|\\mu_z|$（精确相等），则选择最小的$\\zeta_d$。对所有三个测试用例重复此过程。\n\n对于第三个测试用例，其中$Z_{\\mathrm{O}}=0$，电场$\\mathcal{F}_z$为零。因此，$\\alpha_{\\mathrm{C,eff}}$就是$\\alpha_{\\mathrm{C}}$，与$\\zeta_d$无关。哈密顿矩阵、得到的本征矢量以及偶极矩$\\mu_z$在整个$\\zeta_d$网格上都是恒定的。这为所有候选项创造了一个精确相等的情况。根据平局决胜规则，必须选择网格中最小的$\\zeta_d$，即$0.3$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import eigh\n\ndef solve():\n    \"\"\"\n    Solves the computational chemistry problem as specified.\n    This function scans the exponent of a polarization d-function on Carbon in CO\n    to find the exponent that maximizes the magnitude of the electronic dipole moment\n    within a simplified semi-empirical model.\n    \"\"\"\n    #\n    # --- Fixed Parameters and Constants (in atomic units) ---\n    #\n    zeta_pC = 1.6          # Carbon 2p exponent\n    zeta_pO = 2.3          # Oxygen 2p exponent\n    K = 1.75               # Wolfsberg–Helmholtz constant\n    alpha_C = -0.5         # Carbon 2p on-site energy (Hartree)\n    alpha_O = -0.8         # Oxygen 2p on-site energy (Hartree)\n    delta_eps_pd = 1.0     # Carbon p-d energy gap (Hartree)\n    zeta_d_grid = [0.3, 0.5, 0.8, 1.2, 1.6, 2.0, 3.0, 4.0, 6.0]\n\n    #\n    # --- Test Cases ---\n    #\n    test_cases = [\n        (2.132, 8.0),  # Case 1: Normal path\n        (1.800, 8.0),  # Case 2: Stronger field (shorter bond)\n        (2.132, 0.0),  # Case 3: Edge case (no external field)\n    ]\n\n    results = []\n\n    # --- Integral Helper Functions based on the analytical derivation ---\n    \n    def calculate_s_co(R, zpc, zpo):\n        p = zpc + zpo\n        mu = (zpc * zpo) / p\n        exp_term = np.exp(-mu * R**2)\n        term_in_paren = 0.5 - mu * R**2\n        prefactor = 32 * (zpc * zpo)**(5/4) * p**(-5/2)\n        return prefactor * exp_term * term_in_paren\n\n    def calculate_d_pd(zpc, zd):\n        p = zpc + zd\n        prefactor = 16 * np.sqrt(3)\n        return prefactor * zpc**(5/4) * zd**(7/4) * p**(-7/2)\n\n    for R, Z_O in test_cases:\n        \n        S_CO = calculate_s_co(R, zeta_pC, zeta_pO)\n        S_matrix = np.array([[1.0, S_CO], [S_CO, 1.0]])\n\n        best_zeta_d = -1.0\n        # Use a very small number to initialize to avoid issues with first comparison\n        max_mu_z_abs = -1.0 \n\n        for zeta_d in zeta_d_grid:\n            # Step 1: Calculate Stark mixing effect\n            F_z = Z_O / R**2 if R > 1e-9 else 0.0\n            D_pd = calculate_d_pd(zeta_pC, zeta_d)\n            \n            # Effective on-site energy for Carbon\n            alpha_C_eff = alpha_C - (F_z**2 * D_pd**2) / delta_eps_pd\n\n            # Step 2: Build Hamiltonian\n            H_CO = K * S_CO * (alpha_C_eff + alpha_O) / 2.0\n            H_matrix = np.array([[alpha_C_eff, H_CO], [H_CO, alpha_O]])\n            \n            # Step 3: Solve generalized eigenvalue problem\n            try:\n                eigenvalues, eigenvectors = eigh(H_matrix, S_matrix)\n            except np.linalg.LinAlgError:\n                # Should not happen with these parameters, but good practice\n                continue\n\n            # Select the eigenvector for the bonding orbital (lowest energy)\n            bonding_c = eigenvectors[:, 0]\n            \n            # Step 4: Calculate dipole moment\n            # The eigenvector from eigh is normalized such that c.T @ S @ c = 1\n            c_C, c_O = bonding_c[0], bonding_c[1]\n            mu_z = (c_C**2 - c_O**2) * R\n            mu_z_abs = abs(mu_z)\n            \n            # Step 5: Check if this is the best zeta_d\n            # The tie-breaking rule (select smallest zeta_d) is handled automatically\n            # by the strict inequality and the ordered grid search.\n            if mu_z_abs > max_mu_z_abs:\n                max_mu_z_abs = mu_z_abs\n                best_zeta_d = zeta_d\n        \n        results.append(float(best_zeta_d))\n        \n    print(f\"[{results[0]},{results[1]},{results[2]}]\")\n\nsolve()\n```", "id": "2460492"}]}