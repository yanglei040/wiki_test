{"hands_on_practices": [{"introduction": "在进行任何计算之前，至关重要的是要理解其底层设置。这个练习将挑战你为一个简单的离子配合物定义正确的抗衡校正计算步骤。它将检验你对“鬼原子”以及如何正确处理每个片段的电荷和电子等基本概念的掌握程度，这些都是获得有意义结果所必需的。[@problem_id:2464043]", "problem": "一个氦氢阳离子络合物 $HeH^+$ 被视为由 He 和 $H^+$ 片段组成的二聚体。您希望使用 Boys–Bernardi 抗衡校正 (CP) 方法来估计和校正基组叠加误差 (BSSE)。在这种方法中，每个片段（单体）在二聚体的几何构型下，使用完整的二聚体基组进行计算，方法是将另一个片段的基函数放置为鬼中心（即有基函数但没有电子和核电荷的中心）。氦片段有 $2$ 个电子，电荷为 $0$；而氢阳离子片段有 $0$ 个电子，电荷为 $+1$。在核位置为 $\\mathbf{R}_{\\mathrm{He}}$ 和 $\\mathbf{R}_{\\mathrm{H}}$ 的固定二聚体几何构型下，哪个选项正确地指定了对 $HeH^+$ 进行 CP 校正所需的两个单体计算？\n\nA. 在二聚体几何构型下进行两次单点计算：(i) 一个电荷为 $0$、有 $2$ 个电子的 He 单体，使用 He 和 H 中心上的基函数，其中 H 中心是一个鬼中心（存在基函数，但没有电子，也没有核电荷）；(ii) 一个电荷为 $+1$、有 $0$ 个电子的 $H^+$ 单体，使用 H 和 He 中心上的基函数，其中 He 中心是一个鬼中心。\n\nB. 进行孤立片段计算：(i) 在其孤立几何构型下，一个电荷为 $0$、有 $2$ 个电子的 He 原子，仅使用 He 基组；(ii) 在其孤立几何构型下，一个电荷为 $+1$、有 $0$ 个电子的 $H^+$ 离子，仅使用 H 基组；不包含任何鬼基函数。\n\nC. 对于 $H^+$ 单体，分配 $1$ 个电子以使 H 基组在 He 鬼中心存在的情况下被占据，然后减去该电子的能量以模拟有 $0$ 个电子的 $H^+$ 单体。\n\nD. 对于 He 单体，由于 $H^+$ 有 $0$ 个电子，因此排除 H 上的鬼函数；在二聚体几何构型下仅用 He 基组计算 He。对于 $H^+$ 单体，仅使用 H 基组，不包含 He 上的任何鬼函数。\n\nE. 在两次单体计算中都包含 He 和 $H^+$ 之间的片段间核-核排斥，以在对缺失片段使用鬼基函数的同时，保留完整的二聚体核骨架。", "solution": "首先将对问题陈述进行严格的验证。\n\n**步骤1：提取已知条件**\n-   体系：一个氦氢阳离子络合物，$HeH^+$。\n-   模型：该络合物被视为由 He 和 $H^+$ 两个片段组成的二聚体。\n-   目标：估计和校正基组叠加误差 (BSSE)。\n-   方法：Boys–Bernardi 抗衡校正 (CP) 方法。\n-   CP 方法描述：每个片段在二聚体几何构型下，使用完整的二聚体基组进行计算。这是通过将另一个片段的基函数放置为鬼中心来实现的，鬼中心被定义为具有基函数但没有电子也没有核电荷。\n-   片段属性：\n    -   氦 (He)：$2$ 个电子，电荷 $0$。\n    -   氢阳离子 ($H^+$)：$0$ 个电子，电荷 $+1$。\n-   几何构型：固定的二聚体几何构型，核位置表示为 $\\mathbf{R}_{\\mathrm{He}}$ 和 $\\mathbf{R}_{\\mathrm{H}}$。\n-   问题：确定哪个选项正确描述了 CP 校正所需的两个单体计算。\n\n**步骤2：验证问题陈述**\n该问题描述了计算化学中一个基本方法的标准应用，即针对基组叠加误差的抗衡校正。\n-   **科学依据：** $HeH^+$ 的存在、BSSE 的概念以及 Boys–Bernardi 抗衡校正方法都是量子化学中公认的核心概念。该方法的描述是准确的。分配给 He 和 $H^+$ 片段的属性是正确的。该问题在科学上是合理的。\n-   **问题的适定性：** 问题要求为一个特定的、明确定义的计算任务指出正确的程序步骤。所提供的信息是充分且自洽的，足以根据 CP 方法的定义确定唯一的正确答案。该问题是适定的。\n-   **客观性：** 语言技术性强、精确，没有任何主观或模棱两可的术语。\n\n**步骤3：结论与行动**\n问题陈述是**有效的**。这是一个关于标准科学程序正确实施的直接问题。我现在将着手解答。\n\n**推导正确步骤**\n基组叠加误差 (BSSE) 的产生是由于在分子复合物（“二聚体”）的计算中，一个片段（单体 A）的基函数被人为地用来改善另一个片段（单体 B）电子结构的描述，反之亦然。这导致了非物理性的能量降低和对相互作用能的高估。\n\nBoys–Bernardi 抗衡 (CP) 校正方法量化了这一误差。其核心思想是，计算每个单体的能量时，不是在孤立状态下，而是在其伙伴的基函数存在的情况下进行。这些伙伴基函数被称为“鬼轨道”。\n\n设二聚体为 $AB$。CP 校正的两个关键计算是：\n$1$. 使用二聚体的完整基组 $\\chi_A \\cup \\chi_B$ 计算的单体 $A$ 的能量。在此计算中，单体 $B$ 的原子核和电子被移除，但其位于原始位置的基函数被保留。这是在 $B$ 的鬼轨道存在下对 $A$ 的计算。\n$2$. 使用二聚体的完整基组 $\\chi_A \\cup \\chi_B$ 计算的单体 $B$ 的能量。在此，单体 $A$ 的原子核和电子被移除，但其基函数作为鬼轨道被保留。\n\n让我们将这个正式程序应用于 $HeH^+$ 体系，其中片段 A 是 He，片段 B 是 $H^+$。\n\n**单体计算1：He 片段**\n-   要计算的体系是氦原子，它由一个位于 $\\mathbf{R}_{\\mathrm{He}}$ 位置的 He 原子核（核电荷 $Z=+2$）和 $2$ 个电子组成。该体系的净电荷为 $0$。\n-   计算在固定的二聚体几何构型下进行。\n-   使用的基组必须是完整的二聚体基组，包括以 He 为中心的基函数 ($\\chi_{\\text{He}}$) 和以 H 为中心的基函数 ($\\chi_{\\text{H}}$)。\n-   为实现这一点，位于 $\\mathbf{R}_{\\mathrm{H}}$ 的中心被视为一个“鬼中心”。这意味着在 $\\mathbf{R}_{\\mathrm{H}}$ 处放置了基函数，但该中心没有核电荷，也没有与之相关的电子。\n\n**单体计算2：$H^+$ 片段**\n-   要计算的体系是氢阳离子，它由一个位于 $\\mathbf{R}_{\\mathrm{H}}$ 位置的 H 原子核（一个质子，核电荷 $Z=+1$）和 $0$ 个电子组成。该体系的净电荷为 $+1$。\n-   计算在固定的二聚体几何构型下进行。\n-   使用的基组必须是完整的二聚体基组，$\\chi_{\\text{He}} \\cup \\chi_{\\text{H}}$。\n-   为实现这一点，位于 $\\mathbf{R}_{\\mathrm{He}}$ 的中心被视为一个“鬼中心”。这意味着在 $\\mathbf{R}_{\\mathrm{He}}$ 处放置了基函数，但该中心没有核电荷，也没有与之相关的电子。\n-   请注意，对于一个有 $0$ 个电子的体系，其电子能量根据定义为 $0$。尽管如此，正式程序仍要求进行此设置。\n\n现在，我将根据这个正确的程序评估每个提供的选项。\n\n**逐项分析选项**\n\n**A. 在二聚体几何构型下进行两次单点计算：(i) 一个电荷为 $0$、有 $2$ 个电子的 He 单体，使用 He 和 H 中心上的基函数，其中 H 中心是一个鬼中心（存在基函数，但没有电子，也没有核电荷）；(ii) 一个电荷为 $+1$、有 $0$ 个电子的 $H^+$ 单体，使用 H 和 He 中心上的基函数，其中 He 中心是一个鬼中心。**\n此选项完全准确地描述了该程序。第 (i) 点正确指定了 He 片段的计算，第 (ii) 点正确指定了 $H^+$ 片段的计算。两次计算都在二聚体几何构型下进行，使用完整的二聚体基组，并正确定义了单体及其鬼伙伴的属性。\n**结论：正确。**\n\n**B. 进行孤立片段计算：(i) 在其孤立几何构型下，一个电荷为 $0$、有 $2$ 个电子的 He 原子，仅使用 He 基组；(ii) 在其孤立几何构型下，一个电荷为 $+1$、有 $0$ 个电子的 $H^+$ 离子，仅使用 H 基组；不包含任何鬼基函数。**\n此选项描述的是计算孤立、不相互作用的单体能量 $E_{\\text{He}}$ 和 $E_{\\text{H}^+}$。虽然这些值是计算最终相互作用能所必需的，但它们不是定义 BSSE 校正本身的 CP 单体计算。CP 方法的定义是包含鬼基函数，而此选项明确排除了这一点。\n**结论：不正确。**\n\n**C. 对于 $H^+$ 单体，分配 $1$ 个电子以使 H 基组在 He 鬼中心存在的情况下被占据，然后减去该电子的能量以模拟有 $0$ 个电子的 $H^+$ 单体。**\n这是一个无意义且物理上不正确的程序。不能简单地向一个体系中添加一个电子（将 $H^+$ 转化为中性 H 原子），然后“减去其能量”。多体系统的能量不是以这种方式可加的。CP 计算必须在实际的片段 $H^+$ 上进行，它有 $0$ 个电子。其电子能量自然为 $0$。\n**结论：不正确。**\n\n**D. 对于 He 单体，由于 $H^+$ 有 $0$ 个电子，因此排除 H 上的鬼函数；在二聚体几何构型下仅用 He 基组计算 He。对于 $H^+$ 单体，仅使用 H 基组，不包含 He 上的任何鬼函数。**\n这显示了对 BSSE 的根本性误解。误差源于额外基函数的可用性，而不是额外电子的存在。He 原子的电子可以并且将会利用 $H^+$ 片段的基函数（鬼轨道）来降低其能量，即使 $H^+$ 本身没有电子。对 He 进行 CP 计算的目的恰恰是量化这种能量降低。排除鬼函数否定了抗衡校正方法的全部意义。\n**结论：不正确。**\n\n**E. 在两次单体计算中都包含 He 和 $H^+$ 之间的片段间核-核排斥，以在对缺失片段使用鬼基函数的同时，保留完整的二聚体核骨架。**\n这是不正确的。量子化学计算得到的总能量是 $E_{total} = E_{electronic} + V_{NN}$，其中 $V_{NN}$ 是核-核排斥能。在一个 CP 单体计算中，例如，对于带有鬼 H 的 He，体系只包含一个原子核 (He)。鬼中心没有核电荷。因此，这次计算中的核-核排斥项 $V_{NN}$ 为 $0$。He 和 H 原子核之间的核排斥能 $V_{\\text{He-H}}$ 是完整二聚体的一个属性，只在计算总二聚体能量时考虑，而不包含在单个单体或 CP-单体能量中。\n**结论：不正确。**", "answer": "$$\\boxed{A}$$", "id": "2464043"}, {"introduction": "现在我们理解了基本设置，让我们来做一个经典的计算。本练习涉及计算水二聚体的基组叠加误差（BSSE），这是一个非共价相互作用的基准体系。通过使用不同质量的基组，你将定量地看到 BSSE 是如何作为不完备基组的产物而出现，以及它如何随着基组趋于完备而减小。[@problem_id:2464017]", "problem": "考虑一个处于平衡构型下的水分子氢键二聚体。对于每个基组，提供了二聚体及其单体的总电子能量（单位为Hartree）。单体的能量分别在其自身的基组中，以及在伙伴基函数作为鬼函数存在的情况下计算。由单体 $A$ 和 $B$ 组成的二聚体的基组叠加误差（BSSE）大小定义为\n\n$$\n\\text{BSSE}_{\\text{mag}} = \\big(E_A^{A} - E_A^{AB}\\big) + \\big(E_B^{B} - E_B^{AB}\\big),\n$$\n\n其中 $E_A^{A}$ 和 $E_B^{B}$ 是在各自基组中计算的单体能量，而 $E_A^{AB}$ 和 $E_B^{AB}$ 是在伙伴分子上放置鬼函数的完整二聚体基组中计算的单体能量。以下所有能量均针对平衡构型下的水二聚体。使用换算因子 $1$ Hartree $= 2625.49962$ kJ/mol。所有要求的结果以 kJ/mol 为单位表示，并四舍五入到三位小数。\n\n缩写定义：Slater-Type Orbital three-Gaussian (STO-3G)（斯莱特型轨道三高斯函数），split-valence 6-31G with polarization (6-31G*)（带极化函数的分裂价层6-31G基组），augmented correlation-consistent polarized valence triple-zeta (aug-cc-pVTZ)（增广相关一致性极化价层三泽塔基组）。\n\n测试集（每行列出 $(\\text{基组标签}; E_{AB}^{AB}; E_A^{A}; E_B^{B}; E_A^{AB}; E_B^{AB})$，所有能量单位为Hartree）：\n- $(\\text{STO-3G}; -149.944000; -74.962000; -74.962000; -74.968000; -74.968000)$\n- $(\\text{6-31G*}; -152.031000; -76.010000; -76.010000; -76.011500; -76.011500)$\n- $(\\text{aug-cc-pVTZ}; -152.120200; -76.056000; -76.056000; -76.056100; -76.056100)$\n\n任务：\n1. 对于测试集中的每个基组，使用上述定义和给定的换算因子计算 BSSE 大小 $\\text{BSSE}_{\\text{mag}}$（单位为 kJ/mol），并四舍五入到三位小数。\n2. 判断 BSSE 大小是否沿序列 $[\\text{STO-3G}, \\text{6-31G*}, \\text{aug-cc-pVTZ}]$ 严格递减。如果序列严格递减，则输出布尔值 $ \\text{True} $，否则输出 $ \\text{False} $。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，顺序为 $[\\text{BSSE}_{\\text{mag}}(\\text{STO-3G}), \\text{BSSE}_{\\text{mag}}(\\text{6-31G*}), \\text{BSSE}_{\\text{mag}}(\\text{aug-cc-pVTZ}), \\text{is\\_strictly\\_decreasing}]$。\n- 例如，输出必须形如 $[\\text{value}_1,\\text{value}_2,\\text{value}_3,\\text{boolean}]$，其中 $\\text{value}_i$ 是以 kJ/mol 为单位、四舍五入到三位小数的浮点数，最后一项是布尔值。", "solution": "所提出的问题是有效的。它在科学上基于计算量子化学的原理，问题设定良好，提供了所有必要的数据，并以客观、明确的语言表述。任务是使用三种不同的基组计算水二聚体的基组叠加误差（BSSE）并分析其趋势。\n\n基组叠加误差（BSSE）的概念是在计算复合物中分子（单体）间相互作用能时出现的一种人为效应。当使用有限（因此不完备）的基函数集来描述电子结构时，每个单体都可以“借用”其伙伴的基函数来降低自身的电子能量。在计算孤立单体的能量时，这种效应并不存在，因为孤立单体只能使用其自身的基函数。因此，复合物中单体的能量被人为地降低了，导致复合物的结合能被高估。由 Boys 和 Bernardi 发展的抗衡校正方法提供了一种估算该误差大小的标准程序。\n\nBSSE 的大小由所提供的公式定义：\n$$\n\\text{BSSE}_{\\text{mag}} = \\big(E_A^{A} - E_A^{AB}\\big) + \\big(E_B^{B} - E_B^{AB}\\big)\n$$\n此处，$E_A^{A}$ 和 $E_B^{B}$ 分别是单体 $A$ 和 $B$ 仅使用自身基函数计算出的能量。$E_A^{AB}$ 和 $E_B^{AB}$ 是在伙伴基函数（所谓的“鬼”函数）存在的情况下计算的相应单体的能量，这些鬼函数位于伙伴原子的位置上，但没有电子或原子核。这些能量之间的差异量化了因基组借用而产生的人为稳定化效应。问题提供了所有必要的能量值（单位为Hartree）以及一个换算因子 $1 \\text{ Hartree} = 2625.49962 \\text{ kJ/mol}$。\n\n计算按基组逐一进行。\n\n**1. STO-3G 基组**\n提供的能量为：\n$E_A^{A} = -74.962000$ Hartree\n$E_B^{B} = -74.962000$ Hartree\n$E_A^{AB} = -74.968000$ Hartree\n$E_B^{AB} = -74.968000$ Hartree\n\n首先，我们计算每个单体的能量降低值（单位为Hartree）：\n$$\n\\Delta E_A = E_A^{A} - E_A^{AB} = -74.962000 - (-74.968000) = 0.006000 \\text{ Hartree}\n$$\n$$\n\\Delta E_B = E_B^{B} - E_B^{AB} = -74.962000 - (-74.968000) = 0.006000 \\text{ Hartree}\n$$\n总的 BSSE 大小是这两项之和：\n$$\n\\text{BSSE}_{\\text{mag}}(\\text{STO-3G}) = \\Delta E_A + \\Delta E_B = 0.006000 + 0.006000 = 0.012000 \\text{ Hartree}\n$$\n转换为 kJ/mol：\n$$\n\\text{BSSE}_{\\text{mag}}(\\text{STO-3G}) = 0.012000 \\text{ Hartree} \\times 2625.49962 \\frac{\\text{kJ/mol}}{\\text{Hartree}} = 31.50599544 \\text{ kJ/mol}\n$$\n四舍五入到三位小数，结果是 $31.506$ kJ/mol。\n\n**2. 6-31G* 基组**\n提供的能量为：\n$E_A^{A} = -76.010000$ Hartree\n$E_B^{B} = -76.010000$ Hartree\n$E_A^{AB} = -76.011500$ Hartree\n$E_B^{AB} = -76.011500$ Hartree\n\n每个单体的能量降低值为：\n$$\n\\Delta E_A = E_A^{A} - E_A^{AB} = -76.010000 - (-76.011500) = 0.001500 \\text{ Hartree}\n$$\n$$\n\\Delta E_B = E_B^{B} - E_B^{AB} = -76.010000 - (-76.011500) = 0.001500 \\text{ Hartree}\n$$\n总的 BSSE 大小为：\n$$\n\\text{BSSE}_{\\text{mag}}(\\text{6-31G*}) = 0.001500 + 0.001500 = 0.003000 \\text{ Hartree}\n$$\n转换为 kJ/mol：\n$$\n\\text{BSSE}_{\\text{mag}}(\\text{6-31G*}) = 0.003000 \\text{ Hartree} \\times 2625.49962 \\frac{\\text{kJ/mol}}{\\text{Hartree}} = 7.87649886 \\text{ kJ/mol}\n$$\n四舍五入到三位小数，结果是 $7.876$ kJ/mol。\n\n**3. aug-cc-pVTZ 基组**\n提供的能量为：\n$E_A^{A} = -76.056000$ Hartree\n$E_B^{B} = -76.056000$ Hartree\n$E_A^{AB} = -76.056100$ Hartree\n$E_B^{AB} = -76.056100$ Hartree\n\n每个单体的能量降低值为：\n$$\n\\Delta E_A = E_A^{A} - E_A^{AB} = -76.056000 - (-76.056100) = 0.000100 \\text{ Hartree}\n$$\n$$\n\\Delta E_B = E_B^{B} - E_B^{AB} = -76.056000 - (-76.056100) = 0.000100 \\text{ Hartree}\n$$\n总的 BSSE 大小为：\n$$\n\\text{BSSE}_{\\text{mag}}(\\text{aug-cc-pVTZ}) = 0.000100 + 0.000100 = 0.000200 \\text{ Hartree}\n$$\n转换为 kJ/mol：\n$$\n\\text{BSSE}_{\\text{mag}}(\\text{aug-cc-pVTZ}) = 0.000200 \\text{ Hartree} \\times 2625.49962 \\frac{\\text{kJ/mol}}{\\text{Hartree}} = 0.525099924 \\text{ kJ/mol}\n$$\n四舍五入到三位小数，结果是 $0.525$ kJ/mol。\n\n**4. 趋势分析**\n第二个任务是判断 BSSE 大小是否沿基组序列 $[\\text{STO-3G}, \\text{6-31G*}, \\text{aug-cc-pVTZ}]$ 严格递减。这一趋势是理论上所预期的。更大、更完备的基组能够更好地描述孤立单体本身，从而减少从相邻单体借用基函数所获得的人为稳定化效应。STO-3G 是一个最小基组，6-31G* 是一个带极化函数的分裂价层基组，而 aug-cc-pVTZ 是一个增广了弥散函数的大型相关一致性基组。基组的质量沿此序列递增。\n\n让我们比较计算出的 BSSE 值：\n- $\\text{BSSE}_{\\text{mag}}(\\text{STO-3G}) = 31.506$ kJ/mol\n- $\\text{BSSE}_{\\text{mag}}(\\text{6-31G*}) = 7.876$ kJ/mol\n- $\\text{BSSE}_{\\text{mag}}(\\text{aug-cc-pVTZ}) = 0.525$ kJ/mol\n\n我们检查严格不等式：\n是否 $31.506 > 7.876$？是。\n是否 $7.876 > 0.525$？是。\n由于两个条件都满足，BSSE 大小序列是严格递减的。布尔值答案为 True。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of calculating Basis Set Superposition Error (BSSE)\n    for a water dimer with different basis sets and analyzing the trend.\n    \"\"\"\n\n    # Conversion factor from Hartree to kJ/mol\n    CONV_FACTOR = 2625.49962\n\n    # Test suite data: (basis_label, E_dimer, E_A_A, E_B_B, E_A_AB, E_B_AB)\n    # Energies are in Hartree.\n    test_cases = [\n        (\"STO-3G\", -149.944000, -74.962000, -74.962000, -74.968000, -74.968000),\n        (\"6-31G*\", -152.031000, -76.010000, -76.010000, -76.011500, -76.011500),\n        (\"aug-cc-pVTZ\", -152.120200, -76.056000, -76.056000, -76.056100, -76.056100),\n    ]\n\n    # List to store the unrounded BSSE values in kJ/mol for comparison\n    bsse_values_kj_mol = []\n\n    # --- Task 1: Calculate BSSE magnitude for each basis set ---\n    for case in test_cases:\n        # Unpack the tuple. The dimer energy and basis label are not needed for this calculation.\n        _label, _e_dimer, e_a_a, e_b_b, e_a_ab, e_b_ab = case\n        \n        # Calculate BSSE magnitude using the provided formula\n        # BSSE_mag = (E_A^A - E_A^AB) + (E_B^B - E_B^AB)\n        bsse_hartree = (e_a_a - e_a_ab) + (e_b_b - e_b_ab)\n        \n        # Convert the result from Hartree to kJ/mol\n        bsse_kj_mol = bsse_hartree * CONV_FACTOR\n        \n        # Store the result\n        bsse_values_kj_mol.append(bsse_kj_mol)\n\n    # --- Task 2: Determine if the BSSE magnitude is strictly decreasing ---\n    is_strictly_decreasing = (bsse_values_kj_mol[0] > bsse_values_kj_mol[1]) and \\\n                             (bsse_values_kj_mol[1] > bsse_values_kj_mol[2])\n\n    # --- Final Output Formatting ---\n    # Round the BSSE values to three decimal places for the output string\n    bsse_sto3g_str = f\"{bsse_values_kj_mol[0]:.3f}\"\n    bsse_631g_str = f\"{bsse_values_kj_mol[1]:.3f}\"\n    bsse_aug_cc_pvtz_str = f\"{bsse_values_kj_mol[2]:.3f}\"\n    \n    # Construct the final output string as specified\n    final_output = f\"[{bsse_sto3g_str},{bsse_631g_str},{bsse_aug_cc_pvtz_str},{is_strictly_decreasing}]\"\n    \n    # Print the final result to stdout\n    print(final_output)\n\n# Run the solver\nsolve()\n```", "id": "2464017"}, {"introduction": "抗衡校正方法最著名的应用是校正非共价相互作用，但其原理是普适的。这个进阶练习将该方法应用于 $\\mathrm{F}_2$ 分子中的共价键，将原子视为片段。这不仅会考验你计算 BSSE 的能力，还会让你计算经抗衡校正后的键解离能，这通常是我们寻求的具有物理意义的量。[@problem_id:2464024]", "problem": "考虑一个由两个相同原子通过共价键形成的双原子分子。在有限的单粒子基组中，当每个片段受益于以另一个片段为中心的基函数时，就会产生基组叠加误差（Basis Set Superposition Error, BSSE），这会人为地稳定复合体系。Boys–Bernardi 抗衡校正（Counterpoise, CP）方法通过在存在鬼函数的情况下评估片段能量来校正此误差。设在固定核间距下，二聚体的总电子能量表示为 $E_{AB}^{AB}$，在完整二聚体基组中使用鬼函数计算的单体能量表示为 $E_{A}^{AB}$ 和 $E_{B}^{AB}$，孤立单体的参考能量表示为 $E_{A}^{A}$ 和 $E_{B}^{B}$。所有能量均以哈特里（Hartree）为单位。对于相同原子间的共价键，将二聚体几何结构下的 BSSE 大小定义为\n$$\\mathrm{BSSE} = \\left(E_{A}^{A} - E_{A}^{AB}\\right) + \\left(E_{B}^{B} - E_{B}^{AB}\\right),$$\n并将经过 CP 校正的键解离能（电子能量，不含零点能）定义为\n$$D_{e}^{\\mathrm{CP}} = \\left(E_{A}^{AB} + E_{B}^{AB} - E_{AB}^{AB}\\right).$$\n使用转换因子 $1$ 哈特里 $= 2625.49962$ kJ/mol，将最终数值答案以 kJ/mol 表示。\n\n你的任务是编写一个程序，针对每个测试用例，计算氟二聚体 $\\mathrm{F}_2$（其中片段为氟原子）的 BSSE 大小和经过 CP 校正的键解离能。每个测试用例在相同的二聚体几何结构下提供一组一致的能量 $\\{E_{AB}^{AB}, E_{A}^{AB}, E_{B}^{AB}, E_{A}^{A}, E_{B}^{B}\\}$。每个测试用例需要输出两个以 kJ/mol 为单位的实数：BSSE 大小和 $D_{e}^{\\mathrm{CP}}$，每个数值都四舍五入到三位小数。\n\n测试套件（每个项目符号列出了一个哈特里单位的元组 $\\left(E_{AB}^{AB}, E_{A}^{AB}, E_{B}^{AB}, E_{A}^{A}, E_{B}^{B}\\right)$），对应三种基组质量：\n- 类最小基组情况：$\\left(-199.460000,\\,-99.710000,\\,-99.710000,\\,-99.700000,\\,-99.700000\\right)$。\n- 类双泽塔基组情况：$\\left(-199.526000,\\,-99.733000,\\,-99.733000,\\,-99.730000,\\,-99.730000\\right)$。\n- 类四泽塔基组情况：$\\left(-199.528000,\\,-99.735000,\\,-99.735000,\\,-99.735000,\\,-99.735000\\right)$。\n\n你的程序必须：\n- 将上述测试用例作为其内部数据。\n- 对每个测试用例，使用上述定义计算以 kJ/mol 为单位的 $\\mathrm{BSSE}$ 和 $D_{e}^{\\mathrm{CP}}$，其中所有以哈特里为单位的中间能量差均使用 $1$ 哈特里 $= 2625.49962$ kJ/mol 进行转换。\n- 将每个测试用例的两个输出值均四舍五入到三位小数。\n\n最终输出格式：\n- 生成单行输出，其中包含一个含三个元素的列表，每个元素对应一个测试用例。\n- 每个元素本身必须是一个双元素列表 $[\\mathrm{BSSE}, D_{e}^{\\mathrm{CP}}]$，单位为 kJ/mol，且每个值都四舍五入到三位小数。\n- 确切的文本结构必须类似于 $[[a,b],[c,d],[e,f]]$，其中 $a,b,c,d,e,f$ 被数值替换，且没有多余的空格。\n\n角度单位不适用。所有要求的输出都是以 kJ/mol 为单位的实数。不应打印任何其他量。", "solution": "问题陈述已经过分析并被确定为有效。它在科学上基于计算量子化学的原理，问题定义清晰，提供了所有必要的数据和定义，并以客观、明确的语言表述。该任务是直接应用基组叠加误差的抗衡校正标准公式。我们将继续进行求解。\n\n该问题要求为对应于氟二聚体 $\\mathrm{F}_2$ 的三个不同测试用例计算两个量：基组叠加误差（$\\mathrm{BSSE}$）的大小和经过抗衡校正的键解离能（$D_{e}^{\\mathrm{CP}}$）。\n\n首先，我们陈述所提供的基本方程。二聚体的总电子能量为 $E_{AB}^{AB}$。在其自身基组中计算的单体（例如原子 $A$）的能量为 $E_{A}^{A}$，而在完整的二聚体基组中（使用原子 $B$ 的鬼函数）计算的其能量为 $E_{A}^{AB}$。同样的表示法也适用于单体 $B$。所有能量均以哈特里为单位。\n\n基组叠加误差（$\\mathrm{BSSE}$）被定义为两个片段的人为稳定化能量之和。这种稳定化是由于每个片段“借用”了另一个片段的基函数而产生的，这是使用不完整、有限基组所造成的人为结果。其公式为：\n$$ \\mathrm{BSSE} = (E_{A}^{A} - E_{A}^{AB}) + (E_{B}^{B} - E_{B}^{AB}) $$\n根据变分原理，一个片段在更大的二聚体基组中的能量（$E_{A}^{AB}$）必须小于或等于其在自身较小基组中的能量（$E_{A}^{A}$），因此 $E_{A}^{A} - E_{A}^{AB} \\ge 0$。所以，$\\mathrm{BSSE}$ 是一个非负量，代表了这种人为稳定化的大小。\n\n经过 CP 校正的键解离能 $D_{e}^{\\mathrm{CP}}$，代表了将二聚体分离成其组成片段所需的能量，并对 BSSE 进行了校正。未校正的解离能是 $D_e = (E_A^A + E_B^B) - E_{AB}^{AB}$。CP 校正值是通过使用在完整二聚体基组中计算的片段能量得到的，这有效地抵消了误差，从而得出表达式：\n$$ D_{e}^{\\mathrm{CP}} = E_{A}^{AB} + E_{B}^{AB} - E_{AB}^{AB} $$\n$D_{e}^{\\mathrm{CP}}$ 的正值表示二聚体相对于解离成片段是稳定的。\n\n为了以要求的单位提供最终答案，使用提供的转换因子将以哈特里计算的结果转换为 kJ/mol：\n$$ 1 \\, \\text{Hartree} = 2625.49962 \\, \\text{kJ/mol} $$\n\n每个测试用例的计算步骤如下：\n1. 从输入元组 $(E_{AB}^{AB}, E_{A}^{AB}, E_{B}^{AB}, E_{A}^{A}, E_{B}^{B})$ 中分配五个能量值。\n2. 使用其定义计算以哈特里为单位的 $\\mathrm{BSSE}$。对于对称二聚体（$A=B$），这可以简化为 $\\mathrm{BSSE} = 2 \\times (E_{A}^{A} - E_{A}^{AB})$。\n3. 使用其定义计算以哈特里为单位的 $D_{e}^{\\mathrm{CP}}$。对于对称二聚体，这等于 $D_{e}^{\\mathrm{CP}} = 2 \\times E_{A}^{AB} - E_{AB}^{AB}$。\n4. 将两个结果都乘以转换因子 $2625.49962$，以获得它们以 kJ/mol 为单位的值。\n5. 按照输出要求，将得到的数值格式化为三位小数。\n\n作为一个明确的例子，让我们对第一个测试用例（类最小基组）进行计算：\n- 给定能量：$E_{AB}^{AB} = -199.460000$，$E_{A}^{AB} = E_{B}^{AB} = -99.710000$，$E_{A}^{A} = E_{B}^{B} = -99.700000$。所有单位均为哈特里。\n\n- $\\mathrm{BSSE}$ 的计算：\n$$ \\mathrm{BSSE} = (-99.700000 - (-99.710000)) + (-99.700000 - (-99.710000)) $$\n$$ \\mathrm{BSSE} = 0.010000 + 0.010000 = 0.020000 \\, \\text{哈特里} $$\n$$ \\mathrm{BSSE}_{\\text{kJ/mol}} = 0.020000 \\times 2625.49962 = 52.5099924 \\, \\text{kJ/mol} $$\n\n- $D_{e}^{\\mathrm{CP}}$ 的计算：\n$$ D_{e}^{\\mathrm{CP}} = (-99.710000 + -99.710000) - (-199.460000) $$\n$$ D_{e}^{\\mathrm{CP}} = -199.420000 + 199.460000 = 0.040000 \\, \\text{哈特里} $$\n$$ D_{e, \\text{kJ/mol}}^{\\mathrm{CP}} = 0.040000 \\times 2625.49962 = 105.0199848 \\, \\text{kJ/mol} $$\n\n- 四舍五入到三位小数后，此案例的最终值为 $\\mathrm{BSSE} = 52.510$ kJ/mol 和 $D_{e}^{\\mathrm{CP}} = 105.020$ kJ/mol。\n\n将此相同过程系统地应用于所有三个测试用例，以生成最终的结果列表。所提供的测试用例正确地表明，随着基组质量的提高（从最小基组到四泽塔基组），BSSE 的大小会减小，对于接近完备的基组，其值趋近于零。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the Basis Set Superposition Error (BSSE) and the counterpoise-corrected\n    bond dissociation energy (D_e^CP) for a series of test cases based on the \n    Boys-Bernardi counterpoise correction method.\n    \"\"\"\n\n    # Conversion factor from Hartree to kJ/mol.\n    # 1 Hartree = 2625.49962 kJ/mol.\n    HARTREE_TO_KJ_MOL = 2625.49962\n\n    # Define the test cases from the problem statement.\n    # Each tuple contains (E_AB^AB, E_A^AB, E_B^AB, E_A^A, E_B^B) in Hartree.\n    test_cases = [\n        # Minimal-basis-like case\n        (-199.460000, -99.710000, -99.710000, -99.700000, -99.700000),\n        # Double-zeta-like case\n        (-199.526000, -99.733000, -99.733000, -99.730000, -99.730000),\n        # Quadruple-zeta-like case\n        (-199.528000, -99.735000, -99.735000, -99.735000, -99.735000),\n    ]\n\n    all_results_pairs = []\n    for case in test_cases:\n        e_ab_ab, e_a_ab, e_b_ab, e_a_a, e_b_b = case\n\n        # Calculate BSSE in Hartree.\n        # BSSE = (E_A^A - E_A^AB) + (E_B^B - E_B^AB)\n        bsse_hartree = (e_a_a - e_a_ab) + (e_b_b - e_b_ab)\n\n        # Calculate CP-corrected dissociation energy in Hartree.\n        # D_e^CP = (E_A^AB + E_B^AB - E_AB^AB)\n        de_cp_hartree = (e_a_ab + e_b_ab - e_ab_ab)\n\n        # Convert results from Hartree to kJ/mol.\n        bsse_kj_mol = bsse_hartree * HARTREE_TO_KJ_MOL\n        de_cp_kj_mol = de_cp_hartree * HARTREE_TO_KJ_MOL\n\n        # The problem requires rounding to three decimal places. To ensure the\n        # output format is consistent (e.g., 0.000), we format the numbers as strings.\n        bsse_str = f\"{bsse_kj_mol:.3f}\"\n        de_cp_str = f\"{de_cp_kj_mol:.3f}\"\n        \n        # Build the string representation for a single test case pair, e.g., \"[52.510,105.020]\"\n        all_results_pairs.append(f\"[{bsse_str},{de_cp_str}]\")\n\n    # Final print statement in the exact required format: [[a,b],[c,d],[e,f]]\n    # Join the string representations of each pair and enclose in brackets.\n    print(f\"[{','.join(all_results_pairs)}]\")\n\nsolve()\n```", "id": "2464024"}]}