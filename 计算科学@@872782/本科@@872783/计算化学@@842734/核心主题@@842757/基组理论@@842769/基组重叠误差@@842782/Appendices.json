{"hands_on_practices": [{"introduction": "为了掌握基组叠加误差 (BSSE) 的核心概念，我们从一个最简单的双原子体系——质子与氦原子（$\\text{H}^+—\\text{He}$）的相互作用——开始。在这个思想实验中，由于质子没有电子，其自身的电子能量为零，这使得我们可以清晰地分离并观察到“鬼”轨道是如何通过提供额外的基函数来非物理性地降低氦原子能量的 [@problem_id:2450803]。这个练习为理解更复杂体系中的 BSSE 计算奠定了坚实的基础。", "problem": "您需要使用广义 Boys–Bernardi 对位校正法计算质子与氦原子（表示为 $\\text{H}^+—\\text{He}$）之间相互作用的基组叠加误差（Basis Set Superposition Error, BSSE）。令单体 $\\mathrm{A}$ 为 $\\mathrm{He}$，单体 $\\mathrm{B}$ 为 $\\text{H}^+$。将 BSSE 定义为标量：\n$$\n\\mathrm{BSSE} = \\left(E_{\\mathrm{A}}^{\\mathrm{A}} - E_{\\mathrm{A}}^{\\mathrm{AB}}\\right) + \\left(E_{\\mathrm{B}}^{\\mathrm{B}} - E_{\\mathrm{B}}^{\\mathrm{AB}}\\right),\n$$\n其中，$E_{\\mathrm{X}}^{\\mathrm{Y}}$ 表示在固定原子核的情况下，使用体系 $\\mathrm{Y}$ 的单电子基组计算得到的单体 $\\mathrm{X}$ 的电子能量。所有能量均以哈特里（Hartree）为单位，您的答案必须以哈特里为单位表示，并四舍五入到 $6$ 位小数。\n\n请使用以下参数集测试套件。每个测试用例是一个元组 $\\left(E_{\\text{He}}^{\\text{He}}, E_{\\text{He}}^{\\text{HeH}^+}, E_{\\text{H}^+}^{\\text{H}^+}, E_{\\text{H}^+}^{\\text{HeH}^+}\\right)$，所有四个条目均以哈特里为单位：\n\n- 测试用例 $1$：$\\left(-2.850000, -2.853200, 0.000000, 0.000000\\right)$。\n- 测试用例 $2$：$\\left(-2.861000, -2.861000, 0.000000, 0.000000\\right)$。\n- 测试用例 $3$：$\\left(-2.700000, -2.705500, 0.000000, 0.000000\\right)$。\n- 测试用例 $4$：$\\left(-2.900000, -2.899800, 0.000000, 0.000000\\right)$。\n\n您的程序必须根据上述定义为每个测试用例计算 BSSE。最终输出格式必须为单行，包含一个 Python 风格的列表，其中含有以哈特里为单位的结果，每个结果四舍五入到 $6$ 位小数，不含空格，例如 `[result_1,result_2,result_3,result_4]`。角度单位不适用，也不涉及百分比。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的、以逗号分隔的结果列表，例如 `[r_1,r_2,r_3,r_4]`。", "solution": "问题陈述已经过严格验证，被认为是科学合理的、定义明确且客观的。它提供了清晰的定义、所有必要的数值数据以及一个明确的目标。因此，该问题是有效的，并将提供解决方案。\n\n任务是计算相互作用复合物 $\\text{H}^+—\\text{He}$ 的基组叠加误差（BSSE）。问题将所涉及的物质定义为单体 $\\text{A} = \\text{He}$ 和单体 $\\text{B} = \\text{H}^+$。根据广义 Boys–Bernardi 对位校正方案，BSSE 的计算公式如下：\n$$\n\\mathrm{BSSE} = \\left(E_{\\mathrm{A}}^{\\mathrm{A}} - E_{\\mathrm{A}}^{\\mathrm{AB}}\\right) + \\left(E_{\\mathrm{B}}^{\\mathrm{B}} - E_{\\mathrm{B}}^{\\mathrm{AB}}\\right)\n$$\n此处，$E_{\\mathrm{X}}^{\\mathrm{Y}}$ 表示使用与体系 $\\mathrm{Y}$ 的几何结构相关联的基组计算得到的单体 $\\mathrm{X}$ 的电子能量。\n\n让我们分析该特定体系的各项：\n第一项 $\\left(E_{\\mathrm{A}}^{\\mathrm{A}} - E_{\\mathrm{A}}^{\\mathrm{AB}}\\right)$ 对应于单体 $\\mathrm{A}$，即氦原子 ($\\text{He}$)。\n- $E_{\\mathrm{A}}^{\\mathrm{A}} = E_{\\text{He}}^{\\text{He}}$ 是用其自身的基函数计算的孤立 $\\text{He}$ 原子的能量。\n- $E_{\\mathrm{A}}^{\\mathrm{AB}} = E_{\\text{He}}^{\\text{HeH}^+}$ 是在存在来自单体 $\\mathrm{B}$ ($\\text{H}^+$) 的“鬼”轨道的情况下计算的 $\\text{He}$ 原子的能量。此计算使用二聚体 ($\\text{HeH}^+$) 的完整基组，但仅包括 $\\text{He}$ 原子的原子核和电子。根据变分原理，扩展基组会人为地降低计算出的能量，因此通常情况下 $E_{\\text{He}}^{\\text{HeH}^+} \\le E_{\\text{He}}^{\\text{He}}$。因此，在大多数行为良好的情况下，差值 $(E_{\\text{He}}^{\\text{He}} - E_{\\text{He}}^{\\text{HeH}^+})$ 是非负的。\n\n第二项 $\\left(E_{\\mathrm{B}}^{\\mathrm{B}} - E_{\\mathrm{B}}^{\\mathrm{AB}}\\right)$ 对应于单体 $\\mathrm{B}$，即质子 ($\\text{H}^+$)。\n- 质子是一个没有电子的裸核。根据定义，无论用于假设性电子结构计算的基组如何，其电子能量恒为零。\n- 因此，$E_{\\mathrm{B}}^{\\mathrm{B}} = E_{\\text{H}^+}^{\\text{H}^+} = 0$ 哈特里。\n- 同样地，$E_{\\mathrm{B}}^{\\mathrm{AB}} = E_{\\text{H}^+}^{\\text{HeH}^+} = 0$ 哈特里。\n- 因此，对于该体系，BSSE 表达式中的第二项始终为零：$(0 - 0) = 0$。\n\n因此，BSSE 的计算简化为仅考虑来自氦原子的贡献：\n$$\n\\mathrm{BSSE} = E_{\\text{He}}^{\\text{He}} - E_{\\text{He}}^{\\text{HeH}^+}\n$$\n我们现在将此简化公式应用于每个给定的测试用例。所有能量均以哈特里为单位。\n\n测试用例 $1$：\n给定的能量为 $E_{\\text{He}}^{\\text{He}} = -2.850000$, $E_{\\text{He}}^{\\text{HeH}^+} = -2.853200$, $E_{\\text{H}^+}^{\\text{H}^+} = 0.000000$, and $E_{\\text{H}^+}^{\\text{HeH}^+} = 0.000000$。\n$$\n\\mathrm{BSSE}_{1} = (-2.850000) - (-2.853200) = 0.003200\n$$\n\n测试用例 $2$：\n给定的能量为 $E_{\\text{He}}^{\\text{He}} = -2.861000$, $E_{\\text{He}}^{\\text{HeH}^+} = -2.861000$, $E_{\\text{H}^+}^{\\text{H}^+} = 0.000000$, and $E_{\\text{H}^+}^{\\text{HeH}^+} = 0.000000$。\n$$\n\\mathrm{BSSE}_{2} = (-2.861000) - (-2.861000) = 0.000000\n$$\nBSSE 为零意味着 He 的单体基组足够完备，或者 $\\text{H}^+$ 的鬼轨道没有提供额外的变分灵活性。\n\n测试用例 $3$：\n给定的能量为 $E_{\\text{He}}^{\\text{He}} = -2.700000$, $E_{\\text{He}}^{\\text{HeH}^+} = -2.705500$, $E_{\\text{H}^+}^{\\text{H}^+} = 0.000000$, and $E_{\\text{H}^+}^{\\text{HeH}^+} = 0.000000$。\n$$\n\\mathrm{BSSE}_{3} = (-2.700000) - (-2.705500) = 0.005500\n$$\n\n测试用例 $4$：\n给定的能量为 $E_{\\text{He}}^{\\text{He}} = -2.900000$, $E_{\\text{He}}^{\\text{HeH}^+} = -2.899800$, $E_{\\text{H}^+}^{\\text{H}^+} = 0.000000$, and $E_{\\text{H}^+}^{\\text{HeH}^+} = 0.000000$。\n$$\n\\mathrm{BSSE}_{4} = (-2.900000) - (-2.899800) = -0.000200\n$$\n负的 BSSE 虽然不典型但可能出现。它表明使用鬼轨道计算的能量 $E_{\\text{He}}^{\\text{HeH}^+}$ 高于（负得更少）在单体基组中计算的能量 $E_{\\text{He}}^{\\text{He}}$。这在使用某些基组时可能发生，例如，如果添加鬼函数引入了量子化学软件的数值程序未能完美处理的近似线性相关性。然而，该计算仍然是定义的直接应用。\n\n最终结果，按要求四舍五入到 $6$ 位小数，分别为 $0.003200$、$0.000000$、$0.005500$ 和 $-0.000200$ 哈特里。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the Basis Set Superposition Error (BSSE) for the H+ -- He system\n    for a given suite of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple is (E_He^He, E_He^HeH+, E_H+^H+, E_H+^HeH+), all in Hartree.\n    test_cases = [\n        (-2.850000, -2.853200, 0.000000, 0.000000),\n        (-2.861000, -2.861000, 0.000000, 0.000000),\n        (-2.700000, -2.705500, 0.000000, 0.000000),\n        (-2.900000, -2.899800, 0.000000, 0.000000),\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack the energy values for the current test case.\n        # Monomer A is He, Monomer B is H+.\n        E_A_A, E_A_AB, E_B_B, E_B_AB = case\n\n        # The BSSE is defined as:\n        # BSSE = (E_A^A - E_A^AB) + (E_B^B - E_B^AB)\n        \n        # Contribution from monomer A (He)\n        bsse_contrib_A = E_A_A - E_A_AB\n        \n        # Contribution from monomer B (H+). Since H+ has no electrons, its\n        # electronic energy is always zero, so this term is zero.\n        bsse_contrib_B = E_B_B - E_B_AB\n        \n        # Total BSSE is the sum of contributions.\n        total_bsse = bsse_contrib_A + bsse_contrib_B\n        \n        # Format the result to 6 decimal places as required.\n        # Using f-string formatting ensures correct rounding and trailing zeros.\n        results.append(f\"{total_bsse:.6f}\")\n\n    # Final print statement in the exact required format: a single line with\n    # a comma-separated list of results enclosed in square brackets.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2450803"}, {"introduction": "在掌握了基本概念后，我们将 BSSE 的计算应用到一个化学中至关重要的真实体系：水二聚体。通过一个特意设计的、基组不平衡的场景（即一个水分子使用大型基组，而另一个使用最小基组），本练习将戏剧性地揭示 BSSE 如何严重扭曲计算出的相互作用能 [@problem_id:2450800]。你将亲手计算未经校正和经过反向校正 (Counterpoise-corrected) 后的相互作用能，并体会到该校正对于获得物理上可靠的结论是何等关键。", "problem": "你将分析一个有意设置为不平衡的氢键水二聚体中的基组叠加误差（BSSE）：一个单体使用大的弥散基组（增广相关一致性极化价四ζ基组），另一个使用最小基组（用三个高斯函数表示的斯莱特型轨道）。基组叠加误差（BSSE）的产生是由于复合物中的单体通过“借用”彼此的基函数而被人为地稳定化。反向（CP）校正通过在整个二聚体基组中评估每个单体来补偿这种效应，其中伙伴单体的原子核被替换为不相互作用的“鬼”中心，这些中心提供基函数但不提供电子或原子核。\n\n定义以下总电子能量，全部以原子能量单位哈特里（Hartree）表示，并将使用大基组的水分子记为单体A，使用最小基组的水分子记为单体B：\n- 在完整二聚体基组中的二聚体能量：$E_{AB}^{(AB)}$。\n- 单体在各自基组中的能量：$E_{A}^{(A)}$ 和 $E_{B}^{(B)}$。\n- 在完整二聚体基组中，伙伴单体仅作为鬼基函数存在时，各单体的能量：$E_{A}^{(AB)}$ 和 $E_{B}^{(AB)}$。\n\n对于每个测试用例，计算以下量，单位均为哈特里：\n1. 原始相互作用能 $\\Delta E_{\\text{raw}} = E_{AB}^{(AB)} - E_{A}^{(A)} - E_{B}^{(B)}$。\n2. BSSE的大小，表示为一个正量\n$$\n\\text{BSSE} = -\\Big[\\big(E_{A}^{(AB)} - E_{A}^{(A)}\\big) + \\big(E_{B}^{(AB)} - E_{B}^{(B)}\\big)\\Big].\n$$\n3. 经反向校正的相互作用能\n$$\n\\Delta E_{\\text{CP}} = E_{AB}^{(AB)} - E_{A}^{(AB)} - E_{B}^{(AB)}.\n$$\n4. 一个布尔标志，当且仅当 $\\Delta E_{\\text{CP}} > \\Delta E_{\\text{raw}}$ 时为真。\n\n所有能量均以哈特里表示，不进行单位转换。布尔值必须是语言原生的布尔常量。不涉及角度或百分比。\n\n使用以下测试套件，每行列出 $\\big(E_{AB}^{(AB)}, E_{A}^{(A)}, E_{B}^{(B)}, E_{A}^{(AB)}, E_{B}^{(AB)}\\big)$，单位为哈特里：\n- 测试 1（极端不平衡，最小基组单体强烈借用）：\n  $\\big(-152.0520,\\,-76.0570,\\,-75.9830,\\,-76.0600,\\,-76.0100\\big)$。\n- 测试 2（平衡参考，构造上无BSSE）：\n  $\\big(-152.0700,\\,-76.0500,\\,-76.0100,\\,-76.0500,\\,-76.0100\\big)$。\n- 测试 3（净BSSE很小，有轻微数值异常）：\n  $\\big(-152.0340,\\,-76.0400,\\,-75.9900,\\,-76.0398,\\,-75.9906\\big)$。\n- 测试 4（极端不平衡，BSSE超过原始吸引力）：\n  $\\big(-152.0180,\\,-76.0570,\\,-75.9500,\\,-76.0605,\\,-75.9800\\big)$。\n\n你的程序不应读取任何输入，并应按上述顺序为每个测试计算列表\n$[\\Delta E_{\\text{raw}},\\, \\text{BSSE},\\, \\Delta E_{\\text{CP}},\\, \\text{flag}]$。\n你的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表，其中每个元素是对应一个测试用例的列表，并按顺序排列。例如：\n[[x11,x12,x13,x14],[x21,x22,x23,x24],...]，其中 $x_{ij}$ 是上面定义的以哈特里为单位的量，布尔值是未加引号的语言原生布尔字面量。", "solution": "问题陈述已提交验证。该问题被认为是有效的。它具有科学依据，问题设定良好且客观。它提出了一个关于基组叠加误差（BSSE）的计算量子化学标准练习。所有提供的定义和数据都是自洽、一致且足以得出唯一解的。\n\n核心概念是基组叠加误差，这是一种在使用不完备的、以原子为中心的基组计算分子间相互作用能时出现的人为效应。根据变分原理，为一个系统计算出的基态能量是真实基态能量的一个上限。一个更灵活的基组（即拥有更多基函数的基组）能够更好地逼近真实的波函数，从而得到一个更低、更准确的能量。在分子复合物中，一个单体可以通过“借用”邻近单体的基函数来改善自身的描述，这是一种非物理效应，会导致人为的稳定化。由Boys和Bernardi提出的反向（CP）校正是修正此误差的标准方法。\n\n该问题为一个双单体系统A和B定义了五个能量分量：\n- $E_{AB}^{(AB)}$：二聚体 $AB$ 的总能量，其中所有原子都带有其基函数。\n- $E_{A}^{(A)}$ 和 $E_{B}^{(B)}$：孤立单体 $A$ 和 $B$ 的能量，每个都只用其自身的基组计算。\n- $E_{A}^{(AB)}$ 和 $E_{B}^{(AB)}$：单体 $A$ 和 $B$ 各自的能量，是在伙伴单体的基函数位于“鬼”原子（原子核和电子被移除）中心的情况下计算的。\n\n变分原理规定 $E_{A}^{(AB)} \\le E_{A}^{(A)}$ 和 $E_{B}^{(AB)} \\le E_{B}^{(B)}$，因为基组 $(AB)$ 是基组 $(A)$ 和 $(B)$ 各自的超集。增加更多基函数只会使能量降低或保持不变。测试用例 $3$ 呈现了一个微小的异常，其中 $E_{A}^{(AB)} = -76.0398 > E_{A}^{(A)} = -76.0400$。这是对变分原理的微小违反，可能是由于底层量子化学计算中使用的不同收敛阈值或积分格点所带来的无足轻重的数值噪音，这在实践中很常见。它并不使问题本身的逻辑失效。\n\n需要计算的量是：\n$1$. 原始相互作用能，$\\Delta E_{\\text{raw}} = E_{AB}^{(AB)} - E_{A}^{(A)} - E_{B}^{(B)}$。该量错误地将完全稳定化的二聚体与稳定化程度较低的孤立单体进行比较，因此高估了相互作用强度。\n\n$2$. 基组叠加误差，BSSE。问题将其定义为一个正的大小：\n$$\n\\text{BSSE} = -\\Big[\\big(E_{A}^{(AB)} - E_{A}^{(A)}\\big) + \\big(E_{B}^{(AB)} - E_{B}^{(B)}\\big)\\Big]\n$$\n这可以重写为 $\\text{BSSE} = (E_{A}^{(A)} - E_{A}^{(AB)}) + (E_{B}^{(B)} - E_{B}^{(AB)})$。每一项 $(E_{M}^{(M)} - E_{M}^{(MN)})$ 代表单体 $M$ 因借用单体 $N$ 的基函数而获得的稳定化能。根据变分原理，这些项是非负的，因此BSSE也是非负的。\n\n$3$. 反向校正后的相互作用能，$\\Delta E_{\\text{CP}} = E_{AB}^{(AB)} - E_{A}^{(AB)} - E_{B}^{(AB)}$。这代表了一个更具物理意义的相互作用能，因为碎片的能量是在与二聚体本身相同的基组（完整的二聚体基组）中计算的，从而抵消了人为的稳定化。\n\n这些量之间存在一个重要的关系。通过代入定义，可以轻易地证明：\n$$\n\\Delta E_{\\text{CP}} = \\Delta E_{\\text{raw}} + \\text{BSSE}\n$$\n$$\nE_{AB}^{(AB)} - E_{A}^{(AB)} - E_{B}^{(AB)} = \\big(E_{AB}^{(AB)} - E_{A}^{(A)} - E_{B}^{(B)}\\big) + \\big( (E_{A}^{(A)} - E_{A}^{(AB)}) + (E_{B}^{(B)} - E_{B}^{(AB)}) \\big)\n$$\n右侧的项相互抵消后得到左侧的表达式，从而证实了该恒等式。\n\n$4$. 布尔标志。该标志的条件是 $\\Delta E_{\\text{CP}} > \\Delta E_{\\text{raw}}$。利用上面推导的恒等式，这等价于 $\\Delta E_{\\text{raw}} + \\text{BSSE} > \\Delta E_{\\text{raw}}$，简化为 $\\text{BSSE} > 0$。因此，当且仅当存在非零的基组重叠误差时，该标志为真。对于任何不完备的基组，情况都是如此。在理想化的测试用例2中，BSSE通过构造被设为零，所以标志将为 `False`。对于所有其他情况，我们期望一个正的BSSE和一个 `True` 标志。\n\n算法过程是遍历每个测试用例，将给定的五个能量值代入四个公式中，并汇总结果。\n\n对于测试用例1 $\\big(E_{AB}^{(AB)}, E_{A}^{(A)}, E_{B}^{(B)}, E_{A}^{(AB)}, E_{B}^{(AB)}\\big) = \\big(-152.0520, -76.0570, -75.9830, -76.0600, -76.0100\\big)$:\n- $\\Delta E_{\\text{raw}} = -152.0520 - (-76.0570 - 75.9830) = -0.0120$ 哈特里。\n- $\\text{BSSE} = -[(-76.0600 - (-76.0570)) + (-76.0100 - (-75.9830))] = 0.0300$ 哈特里。\n- $\\Delta E_{\\text{CP}} = -152.0520 - (-76.0600 - 76.0100) = 0.0180$ 哈特里。\n- 标志：$0.0180 > -0.0120$ 为真。\n\n对所有测试用例重复此计算，如下面的程序所示。结果表明了CP校正的重要性；例如，在测试用例4中，一个看似有吸引力的相互作用（$\\Delta E_{\\text{raw}} = -0.0110$ 哈特里）在去除大的BSSE后，被揭示为排斥性的（$\\Delta E_{\\text{CP}} = 0.0225$ 哈特里）。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# No other libraries are needed for this problem.\n\ndef solve():\n    \"\"\"\n    Solves the Basis Set Superposition Error (BSSE) problem for a given suite of test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each tuple contains (E_AB^(AB), E_A^(A), E_B^(B), E_A^(AB), E_B^(AB)) in Hartree.\n    test_cases = [\n        # Test 1 (extreme imbalance, strong borrowing by the minimal-basis monomer)\n        (-152.0520, -76.0570, -75.9830, -76.0600, -76.0100),\n        # Test 2 (balanced reference, no BSSE by construction)\n        (-152.0700, -76.0500, -76.0100, -76.0500, -76.0100),\n        # Test 3 (small net BSSE with a slight numerical anomaly)\n        (-152.0340, -76.0400, -75.9900, -76.0398, -75.9906),\n        # Test 4 (extreme imbalance, BSSE overwhelms the raw attraction)\n        (-152.0180, -76.0570, -75.9500, -76.0605, -75.9800),\n    ]\n\n    all_results = []\n    for case in test_cases:\n        E_AB_AB, E_A_A, E_B_B, E_A_AB, E_B_AB = case\n\n        # 1. Compute the raw interaction energy, delta_E_raw\n        # delta_E_raw = E_AB^(AB) - E_A^(A) - E_B^(B)\n        delta_E_raw = E_AB_AB - (E_A_A + E_B_B)\n\n        # 2. Compute the BSSE magnitude\n        # BSSE = -[(E_A^(AB) - E_A^(A)) + (E_B^(AB) - E_B^(B))]\n        bsse = -((E_A_AB - E_A_A) + (E_B_AB - E_B_B))\n\n        # 3. Compute the Counterpoise-corrected interaction energy, delta_E_CP\n        # delta_E_CP = E_AB^(AB) - E_A^(AB) - E_B^(AB)\n        delta_E_cp = E_AB_AB - (E_A_AB + E_B_AB)\n\n        # As a verification, delta_E_CP should equal delta_E_raw + BSSE\n        # For floating point numbers, it's better to check for near equality,\n        # but the identity is exact and inputs are well-behaved here.\n        # assert np.isclose(delta_E_cp, delta_E_raw + bsse)\n\n        # 4. Compute the boolean flag\n        # flag = True if delta_E_CP > delta_E_raw\n        flag = delta_E_cp > delta_E_raw\n\n        # Append the list of results for this test case\n        # np.round is used to handle potential floating point inaccuracies from subtraction,\n        # ensuring clean output matching manual calculations.\n        # A precision of 6 decimal places is sufficient for these values.\n        result_list = [\n            np.round(delta_E_raw, 6),\n            np.round(bsse, 6),\n            np.round(delta_E_cp, 6),\n            flag\n        ]\n        all_results.append(result_list)\n\n    # Format the final output string exactly as specified.\n    # Each sublist is converted to a string, removing spaces.\n    # The list of these strings is joined by commas.\n    # The final result is enclosed in brackets.\n    sublist_strings = [f\"[{','.join(map(str, res))}]\" for res in all_results]\n    final_output = f\"[{','.join(sublist_strings)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output)\n\nsolve()\n```", "id": "2450800"}, {"introduction": "BSSE 的影响并不仅限于非共价键合的分子间相互作用，它同样会影响分子内的能量计算。本练习将探讨一个经典的应用：BSSE 如何影响乙烷的旋转能垒 [@problem_id:2450842]。通过将乙烷分子在重叠式和交叉式构象下都看作两个甲基自由基碎片的组合，你将计算并比较未校正和经过 BSSE 校正的构象能量差，从而理解 BSSE 如何因几何构型的不同而变化，并可能影响对分子稳定性排序的判断。", "problem": "考虑乙烷分子 $\\text{C}_2\\text{H}_6$ 分裂成两个甲基自由基 $\\text{CH}_3$ 和 $\\text{CH}_3$。令在所有原子上使用全基组计算得到的给定构象 $X \\in \\{\\text{重叠式}, \\text{交叉式}\\}$ 的总电子能量表示为 $E_{X}^{AB}$（单位为哈特里，$\\mathrm{E_h}$）。对于每个构象 $X$，令 $E_{A,X}^{A}$ 和 $E_{B,X}^{B}$ 为仅使用其自身片段基组计算的单体能量（$\\text{CH}_3$ 片段分别标记为 $A$ 和 $B$），并令 $E_{A,X}^{AB}$ 和 $E_{B,X}^{AB}$ 为在另一片段的基函数作为仅含基函数的“鬼原子”存在下计算的相应单体能量，所有计算均在构象 $X$ 的几何结构下进行，且单位均为哈特里，$\\mathrm{E_h}$。构象 $X$ 的基组重叠误差（BSSE）定义为\n$$\n\\mathrm{BSSE}_X = \\left(E_{A,X}^{AB} - E_{A,X}^{A}\\right) + \\left(E_{B,X}^{AB} - E_{B,X}^{B}\\right),\n$$\n经 BSSE 校正的总能量为\n$$\nE_{X}^{\\mathrm{corr}} = E_{X}^{AB} - \\mathrm{BSSE}_X.\n$$\n将未校正的构象能量差（重叠式减去交叉式）定义为\n$$\n\\Delta E_{\\mathrm{uncorr}} = E_{\\mathrm{eclipsed}}^{AB} - E_{\\mathrm{staggered}}^{AB},\n$$\n并将经 BSSE 校正的构象能量差定义为\n$$\n\\Delta E_{\\mathrm{corr}} = E_{\\mathrm{eclipsed}}^{\\mathrm{corr}} - E_{\\mathrm{staggered}}^{\\mathrm{corr}}.\n$$\n\n使用以下包含三种情况（3组不同的能量值）的测试套件，计算每种情况下的 $\\Delta E_{\\mathrm{uncorr}}$ 和 $\\Delta E_{\\mathrm{corr}}$。所有能量均以哈特里（$\\mathrm{E_h}$）为单位。\n\n测试套件：\n- 情况 $1$：\n  - $E_{\\mathrm{eclipsed}}^{AB} = -79.255000$, $E_{\\mathrm{staggered}}^{AB} = -79.256200$.\n  - $E_{A,\\mathrm{eclipsed}}^{A} = -39.700000$, $E_{B,\\mathrm{eclipsed}}^{B} = -39.700000$.\n  - $E_{A,\\mathrm{eclipsed}}^{AB} = -39.701000$, $E_{B,\\mathrm{eclipsed}}^{AB} = -39.701100$.\n  - $E_{A,\\mathrm{staggered}}^{A} = -39.700100$, $E_{B,\\mathrm{staggered}}^{B} = -39.700100$.\n  - $E_{A,\\mathrm{staggered}}^{AB} = -39.701000$, $E_{B,\\mathrm{staggered}}^{AB} = -39.701000$.\n- 情况 $2$：\n  - $E_{\\mathrm{eclipsed}}^{AB} = -79.250000$, $E_{\\mathrm{staggered}}^{AB} = -79.251000$.\n  - $E_{A,\\mathrm{eclipsed}}^{A} = -39.690000$, $E_{B,\\mathrm{eclipsed}}^{B} = -39.690000$.\n  - $E_{A,\\mathrm{eclipsed}}^{AB} = -39.690750$, $E_{B,\\mathrm{eclipsed}}^{AB} = -39.690750$.\n  - $E_{A,\\mathrm{staggered}}^{A} = -39.690500$, $E_{B,\\mathrm{staggered}}^{B} = -39.690500$.\n  - $E_{A,\\mathrm{staggered}}^{AB} = -39.691250$, $E_{B,\\mathrm{staggered}}^{AB} = -39.691250$.\n- 情况 $3$：\n  - $E_{\\mathrm{eclipsed}}^{AB} = -79.260000$, $E_{\\mathrm{staggered}}^{AB} = -79.260300$.\n  - $E_{A,\\mathrm{eclipsed}}^{A} = -39.695000$, $E_{B,\\mathrm{eclipsed}}^{B} = -39.695000$.\n  - $E_{A,\\mathrm{eclipsed}}^{AB} = -39.695500$, $E_{B,\\mathrm{eclipsed}}^{AB} = -39.695500$.\n  - $E_{A,\\mathrm{staggered}}^{A} = -39.695100$, $E_{B,\\mathrm{staggered}}^{B} = -39.695100$.\n  - $E_{A,\\mathrm{staggered}}^{AB} = -39.695850$, $E_{B,\\mathrm{staggered}}^{AB} = -39.695850$.\n\n要求：\n- 对于每种情况，计算以哈特里（$\\mathrm{E_h}$）为单位的 $\\Delta E_{\\mathrm{uncorr}}$ 和 $\\Delta E_{\\mathrm{corr}}$。\n- 将每个数值结果以哈特里（$\\mathrm{E_h}$）为单位表示，并四舍五入到小数点后 $6$ 位。\n- 您的程序应生成单行输出，其中包含一个列表的列表形式的结果，以单行 Python 风格的列表字面量形式打印，例如 `[[0.000000,0.000000],[0.000000,0.000000],[0.000000,0.000000]]`。", "solution": "所提出的问题是有效的。它在科学上基于计算化学的原理，特别是针对基组叠加误差（BSSE）的反向校正方法。所有定义都是标准的，所有必需的数据都已提供，并且问题是适定的、客观的且逻辑一致的。不存在矛盾或歧义。我们将着手推导解决方案。\n\n该问题要求针对三组不同的能量数据，计算乙烷的重叠式和交叉式构象之间未校正和经 BSSE 校正的构象能量差。问题的核心在于仔细应用所提供的公式。\n\n让我们为给定构象 $X \\in \\{\\text{重叠式}, \\text{交叉式}\\}$ 定义各种量。\n二聚体（乙烷）的总能量为 $E_X^{AB}$。\n单体 $A$（一个 $\\text{CH}_3$ 片段）在其自身基组中的能量为 $E_{A,X}^A$。\n单体 $B$（另一个 $\\text{CH}_3$ 片段）在其自身基组中的能量为 $E_{B,X}^B$。\n单体 $A$ 在片段 $A$ 和 $B$ 的组合基组中（其中 $B$ 的基函数是“鬼轨道”）的能量为 $E_{A,X}^{AB}$。\n单体 $B$ 在组合基组中的能量为 $E_{B,X}^{AB}$。\n\n根据定义，构象 $X$ 的基组重叠误差为：\n$$\n\\mathrm{BSSE}_X = \\left(E_{A,X}^{AB} - E_{A,X}^{A}\\right) + \\left(E_{B,X}^{AB} - E_{B,X}^{B}\\right)\n$$\n根据变分原理，使用更大基组（即包含来自另一片段的鬼轨道）计算的片段能量必须低于或等于仅使用其自身基组计算的能量。因此，$E_{A,X}^{AB} \\leq E_{A,X}^A$ 且 $E_{B,X}^{AB} \\leq E_{B,X}^B$，这意味着 $\\mathrm{BSSE}_X$ 是一个非正值。\n\n那么，构象 $X$ 经 BSSE 校正的总能量为：\n$$\nE_{X}^{\\mathrm{corr}} = E_{X}^{AB} - \\mathrm{BSSE}_X\n$$\n由于 $\\mathrm{BSSE}_X \\leq 0$，校正后的能量 $E_{X}^{\\mathrm{corr}}$ 大于或等于未校正的能量 $E_{X}^{AB}$。这正确地解释了由基组重叠引入的人为稳定化效应。\n\n未校正和校正后的构象能量差（重叠式减去交叉式）为：\n$$\n\\Delta E_{\\mathrm{uncorr}} = E_{\\mathrm{eclipsed}}^{AB} - E_{\\mathrm{staggered}}^{AB}\n$$\n$$\n\\Delta E_{\\mathrm{corr}} = E_{\\mathrm{eclipsed}}^{\\mathrm{corr}} - E_{\\mathrm{staggered}}^{\\mathrm{corr}} = (E_{\\mathrm{eclipsed}}^{AB} - \\mathrm{BSSE}_{\\mathrm{eclipsed}}) - (E_{\\mathrm{staggered}}^{AB} - \\mathrm{BSSE}_{\\mathrm{staggered}})\n$$\n我们现在将为每个测试用例计算这些量。所有能量的单位均为哈特里，$\\mathrm{E_h}$。\n\n情况 1：\n首先，我们计算未校正的能量差：\n$$\n\\Delta E_{\\mathrm{uncorr}}^{(1)} = E_{\\mathrm{eclipsed}}^{AB} - E_{\\mathrm{staggered}}^{AB} = -79.255000 - (-79.256200) = 0.001200\\ \\mathrm{E_h}\n$$\n接下来，我们确定每个构象的 BSSE。\n对于重叠式构象：\n$$\n\\mathrm{BSSE}_{\\mathrm{eclipsed}}^{(1)} = (E_{A,\\mathrm{eclipsed}}^{AB} - E_{A,\\mathrm{eclipsed}}^{A}) + (E_{B,\\mathrm{eclipsed}}^{AB} - E_{B,\\mathrm{eclipsed}}^{B})\n$$\n$$\n\\mathrm{BSSE}_{\\mathrm{eclipsed}}^{(1)} = (-39.701000 - (-39.700000)) + (-39.701100 - (-39.700000)) = -0.001000 - 0.001100 = -0.002100\\ \\mathrm{E_h}\n$$\n对于交叉式构象：\n$$\n\\mathrm{BSSE}_{\\mathrm{staggered}}^{(1)} = (E_{A,\\mathrm{staggered}}^{AB} - E_{A,\\mathrm{staggered}}^{A}) + (E_{B,\\mathrm{staggered}}^{AB} - E_{B,\\mathrm{staggered}}^{B})\n$$\n$$\n\\mathrm{BSSE}_{\\mathrm{staggered}}^{(1)} = (-39.701000 - (-39.700100)) + (-39.701000 - (-39.700100)) = -0.000900 - 0.000900 = -0.001800\\ \\mathrm{E_h}\n$$\n现在我们计算校正后的能量：\n$$\nE_{\\mathrm{eclipsed}}^{\\mathrm{corr},(1)} = E_{\\mathrm{eclipsed}}^{AB} - \\mathrm{BSSE}_{\\mathrm{eclipsed}}^{(1)} = -79.255000 - (-0.002100) = -79.252900\\ \\mathrm{E_h}\n$$\n$$\nE_{\\mathrm{staggered}}^{\\mathrm{corr},(1)} = E_{\\mathrm{staggered}}^{AB} - \\mathrm{BSSE}_{\\mathrm{staggered}}^{(1)} = -79.256200 - (-0.001800) = -79.254400\\ \\mathrm{E_h}\n$$\n最后，校正后的能量差为：\n$$\n\\Delta E_{\\mathrm{corr}}^{(1)} = E_{\\mathrm{eclipsed}}^{\\mathrm{corr},(1)} - E_{\\mathrm{staggered}}^{\\mathrm{corr},(1)} = -79.252900 - (-79.254400) = 0.001500\\ \\mathrm{E_h}\n$$\n对于情况 $1$，结果是 $\\Delta E_{\\mathrm{uncorr}}^{(1)} = 0.001200\\ \\mathrm{E_h}$ 和 $\\Delta E_{\\mathrm{corr}}^{(1)} = 0.001500\\ \\mathrm{E_h}$。\n\n情况 2：\n以同样的方式进行：\n$$\n\\Delta E_{\\mathrm{uncorr}}^{(2)} = E_{\\mathrm{eclipsed}}^{AB} - E_{\\mathrm{staggered}}^{AB} = -79.250000 - (-79.251000) = 0.001000\\ \\mathrm{E_h}\n$$\nBSSE 值为：\n$$\n\\mathrm{BSSE}_{\\mathrm{eclipsed}}^{(2)} = 2 \\times (-39.690750 - (-39.690000)) = 2 \\times (-0.000750) = -0.001500\\ \\mathrm{E_h}\n$$\n$$\n\\mathrm{BSSE}_{\\mathrm{staggered}}^{(2)} = 2 \\times (-39.691250 - (-39.690500)) = 2 \\times (-0.000750) = -0.001500\\ \\mathrm{E_h}\n$$\n在这种情况下，两种构象的 BSSE 是相同的。\n校正后的能量为：\n$$\nE_{\\mathrm{eclipsed}}^{\\mathrm{corr},(2)} = -79.250000 - (-0.001500) = -79.248500\\ \\mathrm{E_h}\n$$\n$$\nE_{\\mathrm{staggered}}^{\\mathrm{corr},(2)} = -79.251000 - (-0.001500) = -79.249500\\ \\mathrm{E_h}\n$$\n校正后的能量差为：\n$$\n\\Delta E_{\\mathrm{corr}}^{(2)} = -79.248500 - (-79.249500) = 0.001000\\ \\mathrm{E_h}\n$$\n对于情况 $2$，结果是 $\\Delta E_{\\mathrm{uncorr}}^{(2)} = 0.001000\\ \\mathrm{E_h}$ 和 $\\Delta E_{\\mathrm{corr}}^{(2)} = 0.001000\\ \\mathrm{E_h}$。校正不改变能量差。\n\n情况 3：\n最后，对于第三种情况：\n$$\n\\Delta E_{\\mathrm{uncorr}}^{(3)} = E_{\\mathrm{eclipsed}}^{AB} - E_{\\mathrm{staggered}}^{AB} = -79.260000 - (-79.260300) = 0.000300\\ \\mathrm{E_h}\n$$\nBSSE 值为：\n$$\n\\mathrm{BSSE}_{\\mathrm{eclipsed}}^{(3)} = 2 \\times (-39.695500 - (-39.695000)) = 2 \\times (-0.000500) = -0.001000\\ \\mathrm{E_h}\n$$\n$$\n\\mathrm{BSSE}_{\\mathrm{staggered}}^{(3)} = 2 \\times (-39.695850 - (-39.695100)) = 2 \\times (-0.000750) = -0.001500\\ \\mathrm{E_h}\n$$\n校正后的能量为：\n$$\nE_{\\mathrm{eclipsed}}^{\\mathrm{corr},(3)} = -79.260000 - (-0.001000) = -79.259000\\ \\mathrm{E_h}\n$$\n$$\nE_{\\mathrm{staggered}}^{\\mathrm{corr},(3)} = -79.260300 - (-0.001500) = -79.258800\\ \\mathrm{E_h}\n$$\n校正后的能量差为：\n$$\n\\Delta E_{\\mathrm{corr}}^{(3)} = -79.259000 - (-79.258800) = -0.000200\\ \\mathrm{E_h}\n$$\n对于情况 $3$，结果是 $\\Delta E_{\\mathrm{uncorr}}^{(3)} = 0.000300\\ \\mathrm{E_h}$ 和 $\\Delta E_{\\mathrm{corr}}^{(3)} = -0.000200\\ \\mathrm{E_h}$。这展示了一个 BSSE 校正至关重要的案例，因为它反转了能量差的符号，从而定性地改变了构象的能量排序。\n\n以下程序系统地实现了这些计算。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Basis Set Superposition Error problem for three test cases\n    of ethane conformations.\n    \"\"\"\n    \n    # Test cases defined as a list of dictionaries. Each dictionary contains\n    # all necessary energy values for a single case.\n    # All energies are in Hartree (Eh).\n    test_cases = [\n        # Case 1\n        {\n            \"E_ecl_AB\": -79.255000, \"E_stg_AB\": -79.256200,\n            \"E_A_ecl_A\": -39.700000, \"E_B_ecl_B\": -39.700000,\n            \"E_A_ecl_AB\": -39.701000, \"E_B_ecl_AB\": -39.701100,\n            \"E_A_stg_A\": -39.700100, \"E_B_stg_B\": -39.700100,\n            \"E_A_stg_AB\": -39.701000, \"E_B_stg_AB\": -39.701000,\n        },\n        # Case 2\n        {\n            \"E_ecl_AB\": -79.250000, \"E_stg_AB\": -79.251000,\n            \"E_A_ecl_A\": -39.690000, \"E_B_ecl_B\": -39.690000,\n            \"E_A_ecl_AB\": -39.690750, \"E_B_ecl_AB\": -39.690750,\n            \"E_A_stg_A\": -39.690500, \"E_B_stg_B\": -39.690500,\n            \"E_A_stg_AB\": -39.691250, \"E_B_stg_AB\": -39.691250,\n        },\n        # Case 3\n        {\n            \"E_ecl_AB\": -79.260000, \"E_stg_AB\": -79.260300,\n            \"E_A_ecl_A\": -39.695000, \"E_B_ecl_B\": -39.695000,\n            \"E_A_ecl_AB\": -39.695500, \"E_B_ecl_AB\": -39.695500,\n            \"E_A_stg_A\": -39.695100, \"E_B_stg_B\": -39.695100,\n            \"E_A_stg_AB\": -39.695850, \"E_B_stg_AB\": -39.695850,\n        },\n    ]\n\n    results = []\n    \n    for case_data in test_cases:\n        # Calculate uncorrected conformational energy difference\n        delta_e_uncorr = case_data[\"E_ecl_AB\"] - case_data[\"E_stg_AB\"]\n\n        # Calculate BSSE for the eclipsed conformation\n        bsse_ecl = (case_data[\"E_A_ecl_AB\"] - case_data[\"E_A_ecl_A\"]) + \\\n                   (case_data[\"E_B_ecl_AB\"] - case_data[\"E_B_ecl_B\"])\n\n        # Calculate BSSE for the staggered conformation\n        bsse_stg = (case_data[\"E_A_stg_AB\"] - case_data[\"E_A_stg_A\"]) + \\\n                   (case_data[\"E_B_stg_AB\"] - case_data[\"E_B_stg_B\"])\n\n        # Calculate BSSE-corrected energies for each conformation\n        e_ecl_corr = case_data[\"E_ecl_AB\"] - bsse_ecl\n        e_stg_corr = case_data[\"E_stg_AB\"] - bsse_stg\n\n        # Calculate BSSE-corrected conformational energy difference\n        delta_e_corr = e_ecl_corr - e_stg_corr\n        \n        results.append([delta_e_uncorr, delta_e_corr])\n\n    # Format the results into the required string format.\n    # Each number must be rounded to 6 decimal places with trailing zeros.\n    formatted_pairs = []\n    for uncorr, corr in results:\n        # Use f-string formatting to ensure 6 decimal places.\n        formatted_pairs.append(f\"[{uncorr:.6f},{corr:.6f}]\")\n    \n    # Join the formatted pairs into a single string representing a list of lists.\n    final_output_string = f\"[{','.join(formatted_pairs)}]\"\n    \n    print(final_output_string)\n\nsolve()\n```", "id": "2450842"}]}