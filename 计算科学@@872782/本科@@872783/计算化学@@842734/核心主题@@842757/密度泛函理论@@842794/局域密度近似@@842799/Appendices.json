{"hands_on_practices": [{"introduction": "局域密度近似（LDA）的理论基石是均匀电子气（UEG）模型。在深入研究完整的交换关联泛函之前，理解其基本构成部分——动能和交换能——至关重要。本练习 [@problem_id:2465152] 将指导你推导并计算均匀电子气的总能量，从而牢固掌握费米波矢（$k_F$）、维格纳-赛兹半径（$r_s$）以及它们如何与动能和交换能相关联等核心概念。", "problem": "钠可以为其每个原子的单个价电子建模为均匀电子气。考虑一个自旋非极化的均匀电子气，其处于钠的价电子密度下，其特征由 Wigner-Seitz 半径 $r_s = 3.93\\,a_0$ 描述，其中 $r_s$ 由 $(4/3)\\pi r_s^3 = 1/n$ 定义，$n$ 为电子数密度。在 Kohn-Sham 局域密度近似 (LDA) 内，忽略相关作用，并将电子视为仅受交换作用影响的无相互作用的平面波。从自由 Fermi 气体的第一性原理和均匀气体的 Hartree-Fock 交换作用出发，推导计算每个电子的总能量 $E/N$ 所需的表达式，该能量为每个电子的无相互作用动能与每个电子的交换能之和，然后在给定的 $r_s$ 值下计算该能量。在整个推导过程中使用 Hartree 原子单位（即 $\\hbar = m_e = e^2/(4\\pi \\varepsilon_0) = 1$ 且 $a_0 = 1$），并将最终数值结果使用 $1$ Hartree $= 27.2114$ eV 转换为电子伏特。以 eV 为单位表示您的最终答案，并四舍五入到四位有效数字。答案必须是一个实数。", "solution": "问题陈述已经过验证。其科学基础扎实，问题提法得当，且客观公正，是计算多体物理学中的一个标准练习。我们开始求解。\n\n任务是在 Hartree-Fock 近似下计算均匀电子气的每个电子的总能量 $E/N$。该能量是每个电子的无相互作用动能 $\\langle T \\rangle$ 与每个电子的交换能 $\\langle E_x \\rangle$ 之和。所有推导都将在 Hartree 原子单位中进行，其中 $\\hbar = 1$，$m_e = 1$，$e^2/(4\\pi \\varepsilon_0) = 1$，且长度单位为 Bohr 半径 $a_0 = 1$。\n\n首先，我们推导每个电子的动能。对于零温下的自由 Fermi 气体，电子在动量空间中占据一个半径为 $k_F$（Fermi 波矢）的球体。$n$（电子数密度）与 $k_F$ 之间的关系是通过对所有占据态求和来建立的，其中包括一个因子 $2$ 以考虑自旋简并：\n$$\nN = V n = 2 \\frac{V}{(2\\pi)^3} \\int_{|\\mathbf{k}| \\le k_F} d^3k = 2 \\frac{V}{(2\\pi)^3} \\left(\\frac{4}{3}\\pi k_F^3\\right) = \\frac{V}{3\\pi^2} k_F^3\n$$\n这给出了基本关系 $n = k_F^3/(3\\pi^2)$，从而得到 $k_F = (3\\pi^2 n)^{1/3}$。\n\n总动能 $T$ 是单粒子能量 $\\epsilon_k = k^2/2$（在原子单位下）在 Fermi 球上的积分：\n$$\nT = 2 \\frac{V}{(2\\pi)^3} \\int_{|\\mathbf{k}| \\le k_F} \\frac{k^2}{2} d^3k = \\frac{V}{\\pi^2} \\int_0^{k_F} \\frac{k^2}{2} (4\\pi k^2) dk = \\frac{V}{2\\pi^2} \\int_0^{k_F} k^4 dk = \\frac{V k_F^5}{10\\pi^2}\n$$\n每个电子的动能 $\\langle T \\rangle$ 是通过将总动能 $T$ 除以总电子数 $N$ 得到的：\n$$\n\\langle T \\rangle = \\frac{T}{N} = \\frac{V k_F^5 / (10\\pi^2)}{V k_F^3 / (3\\pi^2)} = \\frac{3}{10} k_F^2\n$$\n\n其次，我们陈述每个电子的交换能 $\\langle E_x \\rangle$ 的表达式。这是 Hartree-Fock 理论中关于均匀电子气的一个标准结果。在国际单位制（SI units）中，表达式为 $\\langle E_x \\rangle = - \\frac{3}{4} \\frac{e^2}{4\\pi\\varepsilon_0} \\frac{k_F}{\\pi}$。在 Hartree 原子单位中，这简化为：\n$$\n\\langle E_x \\rangle = - \\frac{3 k_F}{4\\pi}\n$$\n这个结果源于平面波轨道之间的交换积分，它解释了 Pauli 不相容原理对库仑相互作用的影响。\n\n每个电子的总能量是这两部分贡献的总和：\n$$\n\\frac{E}{N} = \\langle T \\rangle + \\langle E_x \\rangle = \\frac{3}{10} k_F^2 - \\frac{3}{4\\pi} k_F\n$$\n为了计算这个能量，我们将 $k_F$ 用 Wigner-Seitz 半径 $r_s$ 来表示。其定义为 $(4/3)\\pi r_s^3 = 1/n$。由于我们在 $a_0=1$ 的原子单位下工作，$r_s$ 是一个无量纲参数。密度为 $n = \\frac{3}{4\\pi r_s^3}$。\n将此代入 $k_F$ 的表达式中：\n$$\nk_F = (3\\pi^2 n)^{1/3} = \\left( 3\\pi^2 \\frac{3}{4\\pi r_s^3} \\right)^{1/3} = \\left( \\frac{9\\pi}{4} \\right)^{1/3} \\frac{1}{r_s}\n$$\n现在，我们将这个 $k_F$ 的表达式代回能量分量中：\n$$\n\\langle T \\rangle = \\frac{3}{10} \\left[ \\left( \\frac{9\\pi}{4} \\right)^{1/3} \\frac{1}{r_s} \\right]^2 = \\frac{3}{10} \\left( \\frac{9\\pi}{4} \\right)^{2/3} \\frac{1}{r_s^2}\n$$\n$$\n\\langle E_x \\rangle = - \\frac{3}{4\\pi} \\left[ \\left( \\frac{9\\pi}{4} \\right)^{1/3} \\frac{1}{r_s} \\right] = - \\frac{3}{4\\pi} \\left( \\frac{9\\pi}{4} \\right)^{1/3} \\frac{1}{r_s}\n$$\n因此，每个电子的总能量作为 $r_s$ 的函数为：\n$$\n\\frac{E}{N}(r_s) = \\left[ \\frac{3}{10} \\left( \\frac{9\\pi}{4} \\right)^{2/3} \\right] \\frac{1}{r_s^2} - \\left[ \\frac{3}{4\\pi} \\left( \\frac{9\\pi}{4} \\right)^{1/3} \\right] \\frac{1}{r_s}\n$$\n对于钠，给定 $r_s = 3.93$。我们现在对表达式进行数值计算。系数为：\n动能系数为 $C_T = \\frac{3}{10} (\\frac{9\\pi}{4})^{2/3} \\approx 1.104752$ Hartree。\n交换能系数为 $C_x = -\\frac{3}{4\\pi} (\\frac{9\\pi}{4})^{1/3} \\approx -0.458113$ Hartree。\n每个电子的总能量为：\n$$\n\\frac{E}{N} = \\frac{C_T}{r_s^2} + \\frac{C_x}{r_s} \\approx \\frac{1.104752}{(3.93)^2} - \\frac{0.458113}{3.93}\n$$\n$$\n\\frac{E}{N} \\approx \\frac{1.104752}{15.4449} - 0.116568 \\approx 0.071528 - 0.116568 = -0.045040 \\text{ Hartree}\n$$\n最后，我们使用给定的转换因子 $1$ Hartree $= 27.2114$ eV 将此结果转换为电子伏特 (eV)。\n$$\nE_{\\text{eV}} = (-0.045040 \\text{ Hartree}) \\times (27.2114 \\text{ eV/Hartree}) \\approx -1.22557 \\text{ eV}\n$$\n将结果四舍五入到四位有效数字，得到最终答案。", "answer": "$$\n\\boxed{-1.226}\n$$", "id": "2465152"}, {"introduction": "掌握了均匀电子气的动能和交换能后，下一步便是将同样源于均匀电子气模型的关联能包含进来，并构建一个可实际计算的完整 LDA 交换关联泛函。本练习 [@problem_id:2465146] 要求你将理论公式转化为实用代码，具体实现著名的 Perdew-Zunger 1981 (PZ81) 关联能参数化。这不仅能让你深入理解 LDA 的核心构成，还能锻炼将复杂物理模型程序化的关键计算科学技能。", "problem": "您需要用代码实现均匀电子气的局域密度近似（LDA）背后的核心数值逻辑。您的任务是使用密度泛函理论（DFT）中所用的局域密度近似（LDA），为一组给定的电子数密度计算每个电子的交换关联能。其目的是复刻一个电子表格的基本功能——即给定一列密度，返回一列 LDA 能量——但您必须产出一个可运行的程序来代替。\n\n从以下基本原理出发：\n- 均匀电子气是一个电子系统，其中的电子具有恒定的数密度（用 $\\rho$ 表示），在均匀的正电荷背景中运动，使得整个系统呈电中性。在原子单位制中，能量以哈特里（Hartree）计量，长度以玻尔（Bohr）计量。\n- 对于自旋非极化的均匀电子气，费米波矢 $k_{\\mathrm{F}}$ 和密度 $\\rho$ 满足关系 $k_{\\mathrm{F}}^{3} = 3 \\pi^{2} \\rho$。Wigner-Seitz 半径 $r_{s}$ 定义为 $\\frac{4}{3} \\pi r_{s}^{3} = \\frac{1}{\\rho}$，等价于 $r_{s} = \\left(\\frac{3}{4 \\pi \\rho}\\right)^{1/3}$。\n- 在均匀、自旋非极化的电子气中，每个电子的交换能可以通过填充平面波态直至 $k_{\\mathrm{F}}$ 并对该气体计算精确的 Fock 交换来获得。每个电子的关联能没有从第一性原理得到的闭合形式解，但可以通过与均匀气体的量子蒙特卡洛数据拟合的 Perdew–Zunger 1981 (PZ81) 参数化方案来精确表示。\n- 您必须使用自旋非极化的 Perdew-Zunger 1981 (PZ81) 关联参数化方案，其中高密度分支使用经过充分检验的常数 $A = 0.0311$，$B = -0.048$，$C = 0.0020$，$D = -0.0116$，低密度分支使用 $\\gamma = -0.1423$，$\\beta_{1} = 1.0529$，$\\beta_{2} = 0.3334$。不要假设任何其他数据或参数。\n\n您的程序必须：\n- 使用平面波费米气体模型以及 $k_{\\mathrm{F}}$ 和 $\\rho$ 之间的关系，推导并实现作为 $\\rho$ 函数的每个电子的交换能。然后将其完全用 $\\rho$ 表示。\n- 使用上面给出的常数，将 Perdew-Zunger 1981 每个电子的关联能 $e_{\\mathrm{c}}(r_{s})$ 实现为关于 $r_{s}$ 的分段函数。全过程使用原子单位制。\n- 结合交换能和关联能，计算总的 LDA 每个电子的交换关联能 $e_{\\mathrm{xc}}(\\rho) = e_{\\mathrm{x}}(\\rho) + e_{\\mathrm{c}}(r_{s}(\\rho))$。\n- 根据交换和关联贡献在零密度极限下的连续性，通过定义 $e_{\\mathrm{xc}}(0) = 0$ 来处理边界情况 $\\rho = 0$。\n\n物理单位：\n- 输入密度 $\\rho$ 以 $\\mathrm{bohr}^{-3}$ 为单位。\n- 输出的每个电子的能量必须以哈特里/电子为单位报告，并精确到小数点后 $12$ 位。\n\n角度单位不适用。\n\n测试套件：\n- 使用以下密度集作为输入：$[0.0, 1 \\times 10^{-8}, 0.01, 0.1, 0.238732414637843, 0.5, 5.0]$ （单位为 $\\mathrm{bohr}^{-3}$）。该集合涵盖：\n  - 严格的边界情况 $\\rho = 0.0$，\n  - 极端低密度情况 $\\rho = 1 \\times 10^{-8}$，\n  - 中等密度 $\\rho = 0.01$ 和 $\\rho = 0.1$，\n  - 切换点 $r_{s} = 1$，对应于 $\\rho = 3/(4\\pi) \\approx 0.238732414637843$，\n  - 高密度情况 $\\rho = 0.5$ 和 $\\rho = 5.0$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的结果与输入测试套件的顺序相同，每个数值都以哈特里/电子为单位，格式化为小数点后恰好 $12$ 位。例如，格式必须是 $[v_{1},v_{2},\\ldots,v_{n}]$，其中每个 $v_{i}$ 是一个小数后恰好有 $12$ 位的十进制字符串，并且没有附加文本。\n\n您的实现必须是完全自包含的，并且不得要求任何用户输入。", "solution": "我们通过结合基本关系式和一个经过充分检验的关联能参数化方案，来构建用于均匀、自旋非极化电子气的局域密度近似（LDA）交换关联能。我们使用原子单位制，其中能量单位为哈特里（Hartree），长度单位为玻尔（Bohr）。\n\n原理与推导：\n1. 从填充至费米波矢的均匀电子气开始。对于自旋非极化的均匀电子气，根据动量空间中平面波态的占据情况，一个基本结果将数密度 $\\rho$ 与费米波矢 $k_{\\mathrm{F}}$ 联系起来，如下所示：\n   $$ k_{\\mathrm{F}}^{3} = 3 \\pi^{2} \\rho. $$\n   Wigner–Seitz 半径 $r_{s}$ 是一个球体的半径，该球体平均包含一个电子：\n   $$ \\frac{4}{3} \\pi r_{s}^{3} = \\frac{1}{\\rho}, \\quad r_{s}(\\rho) = \\left(\\frac{3}{4 \\pi \\rho}\\right)^{1/3}. $$\n\n2. 每个电子的交换能。对于均匀电子气，交换能可以从对已填充的平面波费米海的 Hartree-Fock 计算中精确得知。每个电子的交换能可以表示为费米波矢的函数：\n   $$ e_{\\mathrm{x}} = -\\frac{3}{4\\pi} k_{\\mathrm{F}}. $$\n   使用 $k_{\\mathrm{F}} = (3 \\pi^{2} \\rho)^{1/3}$，我们得到完全用密度表示的每个电子的交换能：\n   $$ e_{\\mathrm{x}}(\\rho) = -\\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3} \\rho^{1/3}. $$\n   这个表达式是标准的，它源于对交换空穴的积分，或者等效地，源于对均匀平面波气体的精确 Fock 交换计算。\n\n3. 每个电子的关联能。均匀电子气的关联能没有闭合形式的解，但可以通过与精确的量子蒙特卡洛数据拟合的 Perdew-Zunger 1981 (PZ81) 参数化方案很好地表示。对于自旋非极化的情况，它是一个关于 $r_{s}$ 的分段函数，有两个分支：\n   - 高密度分支（小的 $r_{s}$，具体为 $r_{s}  1$）：\n     $$ e_{\\mathrm{c}}(r_{s}) = A \\ln r_{s} + B + C r_{s} \\ln r_{s} + D r_{s}, $$\n     其中 $A = 0.0311$，$B = -0.048$，$C = 0.0020$，$D = -0.0116$。\n   - 低密度分支（大的 $r_{s}$，具体为 $r_{s} \\ge 1$）：\n     $$ e_{\\mathrm{c}}(r_{s}) = \\frac{\\gamma}{1 + \\beta_{1} \\sqrt{r_{s}} + \\beta_{2} r_{s}}, $$\n     其中 $\\gamma = -0.1423$，$\\beta_{1} = 1.0529$，$\\beta_{2} = 0.3334$。\n   这两个分支在 $r_{s} = 1$ 处连续且可微地相遇。在原子单位制中，这些常数是无量纲的，得到的能量单位是哈特里/电子。分支的选择通过计算 $r_{s}(\\rho)$ 并检查 $r_{s}  1$ 还是 $r_{s} \\ge 1$ 来决定。\n\n4. 总的 LDA 每个电子的交换关联能。每个电子的 LDA 能量就是交换和关联贡献的总和：\n   $$ e_{\\mathrm{xc}}(\\rho) = e_{\\mathrm{x}}(\\rho) + e_{\\mathrm{c}}(r_{s}(\\rho)). $$\n\n5. 零密度下的边界行为。当 $\\rho \\to 0$ 时，我们有 $r_{s} \\to \\infty$。交换贡献满足 $e_{\\mathrm{x}}(\\rho) \\to 0$，因为它与 $\\rho^{1/3}$ 成比例。来自 PZ81 低密度分支的关联贡献在 $r_{s} \\to \\infty$ 时\n   $$ e_{\\mathrm{c}}(r_{s}) = \\frac{\\gamma}{1 + \\beta_{1} \\sqrt{r_{s}} + \\beta_{2} r_{s}} \\to 0 $$\n   趋于0。因此，定义\n   $$ e_{\\mathrm{xc}}(0) = 0 $$\n   是自洽且数值稳定的。\n\n算法设计：\n- 输入：一个固定的密度列表 $\\rho$，单位为 $\\mathrm{bohr}^{-3}$：$[0.0, 1 \\times 10^{-8}, 0.01, 0.1, 0.238732414637843, 0.5, 5.0]$。\n- 对于每个 $\\rho$：\n  1. 如果 $\\rho = 0$，则设置 $e_{\\mathrm{xc}} = 0$ 并继续。\n  2. 计算 $r_{s} = \\left(\\frac{3}{4 \\pi \\rho}\\right)^{1/3}$。\n  3. 计算 $e_{\\mathrm{x}}(\\rho) = -\\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3} \\rho^{1/3}$。\n  4. 使用与 $r_{s}$ 值对应的 PZ81 分支计算 $e_{\\mathrm{c}}(r_{s})$。\n  5. 形成 $e_{\\mathrm{xc}} = e_{\\mathrm{x}} + e_{\\mathrm{c}}$。\n- 输出格式：生成单行输出，其中包含一个用方括号括起来的、以逗号分隔的能量列表，单位为哈特里/电子，每个数值精确到小数点后 $12$ 位，并与输入顺序匹配。\n\n数值注意事项：\n- 在原子单位制中，除了 $\\rho$（单位为 $\\mathrm{bohr}^{-3}$）外，所有量都是无量纲的。根据构造，输出的能量单位为哈特里/电子。\n- 对数 $\\ln r_{s}$ 仅在 $r_{s}  1$ 的分支中使用，因此对于任何 $\\rho > 0$，都保证 $r_{s} > 0$。$\\rho = 0$ 的情况被明确处理，以避免在计算 $r_{s}(\\rho)$ 时出现除以零的错误。\n- 通过 $\\rho = 3/(4\\pi) \\approx 0.238732414637843$ 明确包含了切换点 $r_{s} = 1$，以测试分段定义的连续性。\n\n最终的程序将这些原理应用于提供的测试套件，并以要求的单行格式打印结果。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Execution environment: Python 3.12, numpy 1.23.5, scipy 1.11.4 (not used).\nimport numpy as np\n\ndef lda_exchange_per_electron(rho):\n    \"\"\"\n    Exchange energy per electron for a spin-unpolarized uniform electron gas\n    in atomic units (Hartree), as a function of density rho (bohr^-3).\n    e_x(rho) = -(3/4)*(3/pi)^(1/3) * rho^(1/3)\n    \"\"\"\n    if rho == 0.0:\n        return 0.0\n    return -0.75 * (3.0 / np.pi) ** (1.0 / 3.0) * (rho ** (1.0 / 3.0))\n\ndef rs_from_rho(rho):\n    \"\"\"\n    Wigner-Seitz radius r_s as a function of density rho (bohr^-3).\n    r_s = (3 / (4*pi*rho))^(1/3)\n    \"\"\"\n    return (3.0 / (4.0 * np.pi * rho)) ** (1.0 / 3.0)\n\ndef pz81_correlation_per_electron(rs):\n    \"\"\"\n    Perdew-Zunger 1981 correlation energy per electron (spin-unpolarized),\n    in atomic units (Hartree), as a function of r_s.\n    Piecewise:\n      For rs  1:  e_c = A*ln(rs) + B + C*rs*ln(rs) + D*rs\n      For rs >= 1: e_c = gamma / (1 + beta1*sqrt(rs) + beta2*rs)\n    \"\"\"\n    # Constants for unpolarized case\n    A = 0.0311\n    B = -0.048\n    C = 0.0020\n    D = -0.0116\n    gamma = -0.1423\n    beta1 = 1.0529\n    beta2 = 0.3334\n\n    if rs  1.0:\n        # Guard against any numerical issues at extremely small rs\n        # rs should be > 0 here; add a tiny epsilon if needed\n        rs_eff = max(rs, 1e-20)\n        lnrs = np.log(rs_eff)\n        return A * lnrs + B + C * rs_eff * lnrs + D * rs_eff\n    else:\n        return gamma / (1.0 + beta1 * np.sqrt(rs) + beta2 * rs)\n\ndef lda_xc_per_electron(rho):\n    \"\"\"\n    Total LDA exchange-correlation energy per electron for a spin-unpolarized UEG,\n    in atomic units (Hartree), from density rho (bohr^-3).\n    \"\"\"\n    if rho == 0.0:\n        return 0.0\n    ex = lda_exchange_per_electron(rho)\n    rs = rs_from_rho(rho)\n    ec = pz81_correlation_per_electron(rs)\n    return ex + ec\n\ndef solve():\n    # Define the test cases from the problem statement (densities in bohr^-3).\n    test_cases = [\n        0.0,\n        1e-8,\n        0.01,\n        0.1,\n        0.238732414637843,  # approximately 3/(4*pi), i.e., r_s = 1\n        0.5,\n        5.0,\n    ]\n\n    results = []\n    for rho in test_cases:\n        e_xc = lda_xc_per_electron(rho)\n        # Format to exactly 12 decimal places\n        results.append(f\"{e_xc:.12f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2465146"}, {"introduction": "理论模型的价值最终体现在其预测真实世界现象的能力上。本练习 [@problem_id:2465120] 将带你从理想化的均匀电子气模型转向一个实际的原子体系——氖原子，并尝试计算其电离能。通过分析为教学目的而设计的计算数据，你将比较两种估算电离能的方法，并由此揭示 LDA 的一个关键理论缺陷——自相互作用误差。这个练习旨在培养你批判性地解读计算结果的能力，理解近似密度泛函并非万能的“黑箱”。", "problem": "考虑在密度泛函理论 (DFT) 的 Kohn-Sham 框架下，使用局域密度近似 (LDA) 建模的氖原子。仅使用第一性原理事实作为基础：Hohenberg-Kohn 定理意味着存在一个基态能量泛函，而 Kohn-Sham 构造用一个能够再现精确基态密度的无相互作用参考体系来取代相互作用体系。电离势定义为基态移除能量差。Kohn-Sham 单粒子谱提供了与 Janak 定理（关于总能量对轨道占据数的导数）一致的已占轨道本征值。假设在真空中，氖原子为自旋非极化、闭壳层的非相对论性电子体系。\n\n任务：\n1) 对于每组提供的参数集，计算两个电离势的估计值，单位为电子伏特 (eV)：\n   a) 基于所提供的最高已占 Kohn-Sham 轨道 (HOMO) 本征值的估计值。Kohn-Sham 本征值按惯例报告，即束缚的已占轨道具有负能量；使用此符号约定从 HOMO 本征值构建移除能量的估计值。\n   b) 基态总能量差（通常称为 $\\Delta$ 自洽场方法）：电离势 $I_{\\Delta}$ 等于含有 $N-1$ 个电子的基态总能量与含有 $N$ 个电子的基态总能量之差。\n2) 对于每种情况，计算定义为 $\\Delta$ 自洽场值减去基于 HOMO 本征值的估计值之间的差异。\n3) 将每种情况下的三个输出均以 eV 为单位表示，并四舍五入到三位小数。\n4) 将所有情况的输出汇总为一个列表的列表，每种情况的顺序为 $[I_{\\text{HOMO}}, I_{\\Delta}, I_{\\Delta} - I_{\\text{HOMO}}]$，并打印一行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，$[[x_{1},y_{1},z_{1}],[x_{2},y_{2},z_{2}]]$）。\n\n使用以下参数集作为测试套件。每个元组给出 $(\\varepsilon_{\\text{HOMO}}, E(N), E(N-1))$，单位为 eV，其中 $\\varepsilon_{\\text{HOMO}}$ 是最高已占 Kohn-Sham 本征值，$E(\\cdot)$ 是基态总能量：\n- 情况 A（粗糙实空间网格）：$(\\,-10.8,\\, -3480.000,\\, -3458.600\\,)$\n- 情况 B（中等基组）：$(\\,-12.8,\\, -3483.600,\\, -3462.000\\,)$\n- 情况 C（精细基组）：$(\\,-13.5,\\, -3484.800,\\, -3463.200\\,)$\n- 情况 D（非常精细的基组）：$(\\,-13.9,\\, -3485.100,\\, -3463.500\\,)$\n\n使用的定义和约定：\n- 作为总能量差的电离势为 $I_{\\Delta} = E(N-1) - E(N)$，对于氖原子，$N = 10$；以 eV 为单位报告 $I_{\\Delta}$。\n- 基于 HOMO 的估计值是根据所提供的 $\\varepsilon_{\\text{HOMO}}$ 并使用所述的束缚已占轨道本征值的符号约定来构建的。\n- 将最终报告的数字四舍五入到三位小数，并以 eV 为单位报告能量。\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，每种情况按 $[I_{\\text{HOMO}}, I_{\\Delta}, I_{\\Delta}-I_{\\text{HOMO}}]$ 的顺序报告为一个三元素列表，并按 A–D 的顺序排列四种情况。", "solution": "该问题已经过验证，并被认定为有效。这是一个适定、有科学依据且客观的计算练习，其根源在于 Kohn-Sham 密度泛函理论 (DFT) 的基本原理。唯一解所需的所有数据和定义均已提供，且不存在内部矛盾或事实错误。\n\n任务是计算氖 ($Ne$) 原子的第一电离势 ($I$) 的两种不同估计值及其差异。氖原子有 $N=10$ 个电子。计算将针对四种不同的参数集进行，这些参数集代表了不同水平的计算精度（例如，基组质量或实空间网格密度）。所有能量均以电子伏特 ($eV$) 为单位给出。\n\n电离势的第一个估计值，记为 $I_{\\Delta}$，源自“delta 自洽场”（$\\Delta$SCF）方法。这是电离势定义最直接的应用，即从体系中移出一个电子所需的最小能量。它被计算为含有 $N-1$ 个电子的离子的基态总能量 $E(N-1)$ 与含有 $N$ 个电子的中性原子的基态总能量 $E(N)$ 之间的差值。\n$$I_{\\Delta} = E(N-1) - E(N)$$\n该方法通常被认为是可靠的，因为它允许电子轨道因一个电子被移出而发生弛豫，并且可以从近似交换关联泛函中的误差抵消中受益。\n\n第二个估计值，记为 $I_{\\text{HOMO}}$，基于最高已占分子轨道 (HOMO) 的能量。在 Kohn-Sham 框架内，Janak 定理指出，第 $i$ 个轨道的本征值 $\\varepsilon_i$ 等于总能量 $E$ 相对于该轨道占据数 $n_i$ 的偏导数。\n$$\\varepsilon_i = \\frac{\\partial E}{\\partial n_i}$$\n如果通过假设在电子移除后轨道保持冻结（即忽略轨道弛豫）来近似总能量差，则电离势可以近似为 HOMO 本征值 $\\varepsilon_{\\text{HOMO}}$ 的负值。问题中指定，束缚的已占轨道具有负能量本征值。因此，将一个电子从此类轨道移至真空能级（零能量）所需的能量为正。\n$$I_{\\text{HOMO}} = -\\varepsilon_{\\text{HOMO}}$$\n这个近似类似于 Hartree-Fock 理论中的 Koopmans 定理。然而，在像局域密度近似 (LDA) 这样的近似 DFT 泛函的背景下，这个估计值是众所周知不准确的，主要原因是泛函固有的自相互作用误差。这个误差导致电子感受到的势阱错误地变浅，从而使得 HOMO 本征值过高（负得不够），进而低估了真实的电离势。\n\n差异，定义为 $I_{\\Delta} - I_{\\text{HOMO}}$，量化了轨道弛豫（包含在 $I_{\\Delta}$ 中但不在 $I_{\\text{HOMO}}$ 中）的综合效应，以及两种方法之间自相互作用和其他泛函误差的差异。\n\n现在对每个提供的情况进行计算。所有结果均以 $eV$ 为单位报告，并四舍五入到三位小数。\n\n情况 A：参数 $(\\varepsilon_{\\text{HOMO}}, E(N), E(N-1)) = (-10.8, -3480.000, -3458.600)$\n- $I_{\\text{HOMO}} = -(-10.8) = 10.800$ eV\n- $I_{\\Delta} = E(N-1) - E(N) = -3458.600 - (-3480.000) = 21.400$ eV\n- 差异 = $I_{\\Delta} - I_{\\text{HOMO}} = 21.400 - 10.800 = 10.600$ eV\n- 结果：$[10.800, 21.400, 10.600]$\n\n情况 B：参数 $(\\varepsilon_{\\text{HOMO}}, E(N), E(N-1)) = (-12.8, -3483.600, -3462.000)$\n- $I_{\\text{HOMO}} = -(-12.8) = 12.800$ eV\n- $I_{\\Delta} = E(N-1) - E(N) = -3462.000 - (-3483.600) = 21.600$ eV\n- 差异 = $I_{\\Delta} - I_{\\text{HOMO}} = 21.600 - 12.800 = 8.800$ eV\n- 结果：$[12.800, 21.600, 8.800]$\n\n情况 C：参数 $(\\varepsilon_{\\text{HOMO}}, E(N), E(N-1)) = (-13.5, -3484.800, -3463.200)$\n- $I_{\\text{HOMO}} = -(-13.5) = 13.500$ eV\n- $I_{\\Delta} = E(N-1) - E(N) = -3463.200 - (-3484.800) = 21.600$ eV\n- 差异 = $I_{\\Delta} - I_{\\text{HOMO}} = 21.600 - 13.500 = 8.100$ eV\n- 结果：$[13.500, 21.600, 8.100]$\n\n情况 D：参数 $(\\varepsilon_{\\text{HOMO}}, E(N), E(N-1)) = (-13.9, -3485.100, -3463.500)$\n- $I_{\\text{HOMO}} = -(-13.9) = 13.900$ eV\n- $I_{\\Delta} = E(N-1) - E(N) = -3463.500 - (-3485.100) = 21.600$ eV\n- 差异 = $I_{\\Delta} - I_{\\text{HOMO}} = 21.600 - 13.900 = 7.700$ eV\n- 结果：$[13.900, 21.600, 7.700]$\n\n结果表明，随着计算参数的改善（由更低、变分更完备的总能量 $E(N)$ 表示），$\\Delta$SCF 电离势 $I_{\\Delta}$ 收敛到一个稳定值，约为 $21.600$ eV。基于 HOMO 的估计值 $I_{\\text{HOMO}}$ 也有所改善，但仍然显著低于更准确的 $\\Delta$SCF 值。这种巨大的差异是 LDA 及相关的局域或半局域泛函的典型特征。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes two estimates for the ionization potential of a Neon atom\n    using provided DFT-LDA data and calculates the discrepancy between them.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple contains: (epsilon_HOMO, E(N), E(N-1)) in eV.\n    test_cases = [\n        (-10.8, -3480.000, -3458.600),  # Case A\n        (-12.8, -3483.600, -3462.000),  # Case B\n        (-13.5, -3484.800, -3463.200),  # Case C\n        (-13.9, -3485.100, -3463.500),  # Case D\n    ]\n\n    all_results = []\n    for case in test_cases:\n        e_homo, e_n, e_n_minus_1 = case\n\n        # 1a) Compute the HOMO-based ionization potential estimate.\n        # I_HOMO = -epsilon_HOMO, as bound orbitals have negative eigenvalues.\n        i_homo = -e_homo\n\n        # 1b) Compute the Delta-SCF ionization potential estimate.\n        # I_Delta = E(N-1) - E(N).\n        i_delta = e_n_minus_1 - e_n\n\n        # 2) Compute the discrepancy.\n        discrepancy = i_delta - i_homo\n\n        # Store the three computed values for this case.\n        # The rounding and formatting to 3 decimal places is handled during output string generation.\n        all_results.append([i_homo, i_delta, discrepancy])\n\n    # 3)  4) Format the results into the required single-line string.\n    # Each case is a list [I_HOMO, I_Delta, Discrepancy], with values formatted to 3 decimal places.\n    case_strings = []\n    for res in all_results:\n        s_i_homo = f\"{res[0]:.3f}\"\n        s_i_delta = f\"{res[1]:.3f}\"\n        s_discrepancy = f\"{res[2]:.3f}\"\n        case_strings.append(f\"[{s_i_homo},{s_i_delta},{s_discrepancy}]\")\n    \n    # Aggregate all case strings into the final output format: [[...],[...],...]\n    final_output_string = f\"[{','.join(case_strings)}]\"\n\n    # Final print statement in the exact required format.\n    print(final_output_string)\n\nsolve()\n```", "id": "2465120"}]}