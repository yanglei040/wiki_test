{"hands_on_practices": [{"introduction": "一个精确的泛函对于单电子体系（如氢原子）必须是“无自相互作用”的，这意味着其交换能必须精确地抵消掉虚假的（非物理的）库仑自排斥能。然而，包括GGA在内的半局域泛函在这个关键测试上失败了。通过分析氢原子这个最简单的例子，我们将探讨GGA为何会产生自相互作用误差，以及这种误差在自旋极化和非自旋极化计算中表现出的不同形式 [@problem_id:2464520]。", "problem": "单个氢原子有一个电子。在科恩-沈（Kohn–Sham）密度泛函理论（DFT）中，总能量被分解为无相互作用动能、经典电子-电子排斥（哈特里项）、交换-相关项以及与外部势的相互作用。对于任何单电子体系，真实哈密顿量中精确的电子-电子相互作用能为零。自旋极化计算将自旋向上和自旋向下的密度分别作为 $n_{\\uparrow}(\\mathbf{r})$ 和 $n_{\\downarrow}(\\mathbf{r})$ 处理，而非自旋极化计算使用单一密度 $n(\\mathbf{r})$，该密度通常通过分数占据有效地分裂为 $n_{\\uparrow}=n_{\\downarrow}=n/2$ 以强制净磁化为零。考虑使用半局域的广义梯度近似（GGA）交换-相关泛函对氢原子进行自旋极化和非自旋极化两种计算。\n\n哪个陈述最好地解释了为什么两种 GGA 总能量不同，以及为什么其中至少有一种相对于精确结果是错误的？\n\nA. 在任何单电子密度的精确泛函中，交换-相关项必须完全抵消哈特里自相互作用，而与自旋极化无关，从而得到 $E_{\\mathrm{H}}+E_{\\mathrm{xc}}=0$。半局域 GGA 不满足此条件：当 $n_{\\uparrow}=n$ 和 $n_{\\downarrow}=0$ 时，它仅部分抵消自相互作用；而当 $n_{\\uparrow}=n_{\\downarrow}=n/2$ 时，存在一个由 $n_{\\uparrow}n_{\\downarrow}$ 产生的额外的异自旋库仑项，这是半局域交换无法抵消的。这种对单电子和分数自旋约束的违反，导致了自旋极化和非自旋极化 GGA 能量的差异，并且其中至少有一个偏离了精确的氢原子能量值。\n\nB. 差异的产生是因为自旋极化 GGA 包含了降低氢原子能量的自旋-轨道耦合，而非自旋极化计算忽略了自旋-轨道效应。\n\nC. 非自旋极化计算违反了氢原子的泡利不相容原理，因此它是不物理的，其科恩-沈方程没有有效解；任何能量差异仅仅反映了这种不一致性。\n\nD. 这种差异纯粹是数值上的：通过足够密集的实空间网格和严格的积分阈值，自旋极化和非自旋极化的氢原子 GGA 能量在构造上会变得相同。\n\nE. 在 GGA 中，只有当计算是自旋极化时，单电子密度的科恩-沈动能才变得精确；非自旋极化动能本质上是近似的，并且是能量差异的唯一来源。", "solution": "所给问题是计算量子化学领域一个有效且定义明确的问题。我将进行严谨的分析。\n\n该问题要求解释对氢原子进行自旋极化和非自旋极化广义梯度近似（GGA）计算所得能量的差异，以及为什么其中至少一个能量是错误的。\n\n首先，让我们在科恩-沈密度泛函理论（DFT）的框架内，为像氢原子这样的单电子体系建立精确条件。在外部势 $v_{ext}(\\mathbf{r})$ 中，一个相互作用电子体系的总能量由下式给出：\n$$E[n] = T[n] + V_{ee}[n] + \\int n(\\mathbf{r}) v_{ext}(\\mathbf{r}) d\\mathbf{r}$$\n其中 $T[n]$ 是相互作用电子的动能，$V_{ee}[n]$ 是电子-电子相互作用能。对于单电子体系，$V_{ee}[n]$ 精确为零。能量就是 $E = T_e + V_{ext}$，即电子动能与其在外部势（原子核）中势能的总和。\n\n在科恩-沈 DFT 中，总能量是用一个虚构的无相互作用体系来表示的，该体系与真实体系具有相同的基态密度 $n(\\mathbf{r})$：\n$$E_{KS}[n] = T_s[n] + E_{ext}[n] + J[n] + E_{xc}[n]$$\n这里，$T_s[n]$ 是无相互作用的科恩-沈电子的动能，$E_{ext}[n]$ 是与外部势的相互作用能，$J[n]$ 是经典的哈特里库仑排斥能，$E_{xc}[n]$ 是交换-相关能。\n\n对于单电子体系，精确的科恩-沈体系与真实体系完全相同。因此，无相互作用动能 $T_s[n]$ 等于真实的动能 $T_e$。要使总能量精确，其余项的总和必须为零：\n$$J[n] + E_{xc}[n] = 0$$\n哈特里能是电子密度与其自身的经典自排斥：\n$$J[n] = \\frac{1}{2} \\iint \\frac{n(\\mathbf{r})n(\\mathbf{r'})}{|\\mathbf{r}-\\mathbf{r'}|} d\\mathbf{r} d\\mathbf{r'}$$\n该项非零，代表了一种虚假的自相互作用。因此，对于任何单电子密度，精确的交换-相关泛函必须完全抵消这种自相互作用：\n$$E_{xc}^{\\text{exact}}[n] = -J[n]$$\n具体来说，对于单电子体系，相关能为零（$E_c^{\\text{exact}}[n]=0$），所以抵消必须完全来自交换部分：$E_x^{\\text{exact}}[n] = -J[n]$。未能满足此条件会导致自相互作用误差（SIE）。\n\n像 GGA 这样的近似泛函是“半局域”的，意味着在某点 $\\mathbf{r}$ 的能量密度仅依赖于该点的电子密度及其梯度，即 $E_{xc}^{\\text{GGA}}[n_{\\uparrow}, n_{\\downarrow}] = \\int \\epsilon_{xc}(n_{\\uparrow}, n_{\\downarrow}, \\nabla n_{\\uparrow}, \\nabla n_{\\downarrow}) d\\mathbf{r}$。这种局域性使其无法精确抵消非局域的哈特里自相互作用项 $J[n]$。\n\n现在，我们来分析所述的两种情况：\n\n1.  **自旋极化计算：** 对于氢原子（一个电子，按惯例为自旋向上），密度为 $n_{\\uparrow}(\\mathbf{r})=n(\\mathbf{r})$ 和 $n_{\\downarrow}(\\mathbf{r})=0$。总密度为 $n=n_{\\uparrow}$。虚假的相互作用能是 $J[n_{\\uparrow}]$。GGA 泛函提供了一个交换-相关能 $E_{xc}^{\\text{GGA}}[n_{\\uparrow}, 0]$。对于大多数常见的 GGA，对于完全自旋极化的体系，相关部分为零，$E_c^{\\text{GGA}}[n_{\\uparrow}, 0]=0$。交换部分 $E_x^{\\text{GGA}}[n_{\\uparrow}, 0]$ 仅部分抵消哈特里项 $J[n_{\\uparrow}]$。残余能量 $J[n_{\\uparrow}] + E_x^{\\text{GGA}}[n_{\\uparrow}, 0]$ 是单电子自相互作用误差（SIE），其值非零。这使得总能量不正确。\n\n2.  **非自旋极化计算：** 这种情况通过人为地将自旋密度设置为相等来模拟一个“无磁性”的氢原子：$n_{\\uparrow}(\\mathbf{r}) = n_{\\downarrow}(\\mathbf{r}) = n(\\mathbf{r})/2$。这描述了一个在每一点都有半个自旋向上电子和半个自旋向下电子的虚构状态。这是所谓分数自旋态的一个例子。需要被抵消的总相互作用能是总密度的哈特里能，$J[n] = J[n_{\\uparrow}+n_{\\downarrow}]$。该项可以分解为：\n    $$J[n] = J[n_{\\uparrow}] + J[n_{\\downarrow}] + \\iint \\frac{n_{\\uparrow}(\\mathbf{r})n_{\\downarrow}(\\mathbf{r'})}{|\\mathbf{r}-\\mathbf{r'}|} d\\mathbf{r} d\\mathbf{r'}$$\n    标准的半局域交换泛函 $E_x^{\\text{GGA}}[n_{\\uparrow}, n_{\\downarrow}]$ 被构建用于近似交换相互作用，而交换相互作用只发生在*相同*自旋的电子之间。因此，$E_x^{\\text{GGA}}$ 没有任何分量可以抵消虚假的异自旋库仑项 $\\iint \\frac{n_{\\uparrow}(\\mathbf{r})n_{\\downarrow}(\\mathbf{r'})}{|\\mathbf{r}-\\mathbf{r'}|} d\\mathbf{r} d\\mathbf{r'}$。此外，当 $n_{\\uparrow} \\ne 0$ 和 $n_{\\downarrow} \\ne 0$ 时，大多数 GGA 泛函会产生一个非零的、虚假的相关能 $E_c^{\\text{GGA}}[n_{\\uparrow}, n_{\\downarrow}]$，这对于单电子体系是根本错误的。这导致了一个非常大的误差，称为分数自旋误差，它是 SIE 的一种严重表现。\n\n由于在自旋极化（$n_{\\downarrow}=0$）和非自旋极化（$n_{\\uparrow}=n_{\\downarrow}$）情况下，SIE 的性质和大小不同，这两种计算得出了不同的总能量。由于两种泛函形式都不能满足精确条件 $J[n]+E_{xc}[n]=0$，因此两种能量相对于精确的氢原子能量都是不正确的。\n\n现在，我将评估每个选项。\n\nA. 在任何单电子密度的精确泛函中，交换-相关项必须完全抵消哈特里自相互作用，而与自旋极化无关，从而得到 $E_{\\mathrm{H}}+E_{\\mathrm{xc}}=0$。半局域 GGA 不满足此条件：当 $n_{\\uparrow}=n$ 和 $n_{\\downarrow}=0$ 时，它仅部分抵消自相互作用；而当 $n_{\\uparrow}=n_{\\downarrow}=n/2$ 时，存在一个由 $n_{\\uparrow}n_{\\downarrow}$ 产生的额外的异自旋库仑项，这是半局域交换无法抵消的。这种对单电子和分数自旋约束的违反，导致了自旋极化和非自旋极化 GGA 能量的差异，并且其中至少有一个偏离了精确的氢原子能量值。\n**结论：正确**。此陈述基于上述原则提供了精确而完整的解释。它正确地指出了精确条件（$E_H+E_{xc}=0$，其中 $E_H$ 是哈特里能），半局域 GGA 未能满足该条件，以及这种失败在整数自旋（自旋极化）和分数自旋（非自旋极化）情况下的不同表现方式。\n\nB. 差异的产生是因为自旋极化 GGA 包含了降低氢原子能量的自旋-轨道耦合，而非自旋极化计算忽略了自旋-轨道效应。\n**结论：错误**。标准的 GGA 泛函不考虑自旋-轨道耦合，这是一种相对论效应。这种效应必须另外引入到哈密顿量中。本问题中的能量差异是近似交换-相关泛函的一种非相对论性人为产物。\n\nC. 非自旋极化计算违反了氢原子的泡利不相容原理，因此它是不物理的，其科恩-沈方程没有有效解；任何能量差异仅仅反映了这种不一致性。\n**结论：错误**。$n_{\\uparrow}=n_{\\downarrow}=n/2$ 的设置对于单个电子确实是不物理的，但它并未正式违反泡利不相容原理。最重要的是，对于此设置的科恩-沈方程是良定义的，并且可以自洽求解以得到一个收敛的能量。问题在于该泛函对这个虚构状态给出的能量非常差，而不是解不存在。\n\nD. 这种差异纯粹是数值上的：通过足够密集的实空间网格和严格的积分阈值，自旋极化和非自旋极化的氢原子 GGA 能量在构造上会变得相同。\n**结论：错误**。这种差异对于 GGA 泛函的数学形式是根本性的。两种计算，一个在 $(n_{\\uparrow}=n, n_{\\downarrow}=0)$ 处求值，另一个在 $(n_{\\uparrow}=n/2, n_{\\downarrow}=n/2)$ 处求值，是在计算两个数学上不同的表达式。提高数值精度只会使结果更精确地收敛到两个不同的值。\n\nE. 在 GGA 中，只有当计算是自旋极化时，单电子密度的科恩-沈动能才变得精确；非自旋极化动能本质上是近似的，并且是能量差异的唯一来源。\n**结论：错误**。无相互作用动能 $T_s$ 是根据科恩-沈轨道计算的，而不是直接从动能的近似密度泛函计算得出的。主要误差在于势能项 $J[n] + E_{xc}[n]$。势能的这个误差导致了不正确的自洽密度，从而又引起了动能的次级误差。动能并非能量差异的唯一来源，甚至不是主要来源。", "answer": "$$\\boxed{A}$$", "id": "2464520"}, {"introduction": "GGA相对于LDA的改进，并非因为它在各方面都更“精确”，而是在于其交换和相关部分之间精妙的误差抵消。这个动手编程练习将让你通过数值方法来验证PBE泛函的这一核心设计原则。你将通过将PBE与一个更“朴素”的梯度展开进行比较，来亲眼见证这种误差抵消的“魔法”[@problem_id:2464514]。", "problem": "考虑在科恩-沈密度泛函理论 (DFT) 中使用的广义梯度近似 (GGA)，特别是 Perdew–Burke–Ernzerhof (PBE) 泛函。任务是，通过将 PBE 与一个基于梯度展开的参考系进行比较，来研究一族球对称、单参数电子密度的交换与相关之间的误差抵消。请使用原子单位，其中能量单位为哈特里（Hartree），长度单位为玻尔（Bohr）。\n\n您将研究一族模型化的、自旋非极化的、球对称的电子密度，该族密度由电子数 $N$（一个整数）和一个弥散参数 $a$（一个单位为玻尔分之一的正实数）参数化：\n$$\nn(r) \\;=\\; N \\,\\frac{a^3}{\\pi}\\, e^{-2 a r}, \\quad r \\ge 0.\n$$\n这些密度经过归一化，使得对于所有正数 $a$，都有 $\\int n(\\mathbf{r}) \\, d^3 r = N$。对于每种密度，您将使用以下两种方法计算总交换能和相关能：\n- 一种 PBE 类型的 GGA，在自旋非极化情况下满足标准的 PBE 约束。\n- 一种“二阶梯度展开”（GE2）参考系，它使用已知的交换和相关的小梯度系数。\n\n请基于以下基础定义和约束进行推导和实现：\n- 局域密度近似 (LDA) 的单位体积交换能密度由均匀电子气的表达式构建。使用标准的均匀电子气费米波矢定义 $k_F(n) = (3 \\pi^2 n)^{1/3}$，以及 GGA 设计中出现的约化梯度：\n  - 对于此 $n(r)$，密度梯度的模为 $|\\nabla n| = \\left|\\frac{dn}{dr}\\right|$，\n  - 交换的约化梯度为 $s = \\dfrac{|\\nabla n|}{2 k_F n}$，\n  - 用于相关的屏蔽波矢为 $k_s = \\sqrt{\\dfrac{4 k_F}{\\pi}}$，相关的约化梯度为 $t = \\dfrac{|\\nabla n|}{2 k_s n}$。\n- PBE 交换增强因子必须满足交换的精确小梯度极限，并在大梯度下饱和到一个有限值。小梯度极限恢复了系数为 $\\mu_{\\mathrm{GE}} = \\dfrac{10}{81}$ 的精确二阶梯度展开。用于交换的正则 PBE 常数是 $\\mu$ 和 $\\kappa$（均为无量纲），其中 $\\mu$ 大于 $\\mu_{\\mathrm{GE}}$，$\\kappa$ 设定饱和值。\n- PBE 相关必须在小梯度极限下恢复系数为 $\\beta_{\\mathrm{GE}}$ 的精确二阶梯度展开，并且必须遵守由常数 $\\gamma$ 表征的精确高密度对数约束；它通常通过一个解析内插法实现，该内插法依赖于一个取决于 $t$ 的对数和一个为恢复 LDA 极限而选择的密度依赖因子。\n- LDA 每粒子相关能 $\\varepsilon_c^{\\mathrm{LDA}}(n)$ 应取自一个著名的、对非极化情况下的均匀电子气数据进行的分段解析拟合。\n\n为给定的 $(N,a)$ 构建以下两个泛函：\n1) 一个 PBE 类型的 GGA 总交换相关能，\n$$\nE_{xc}^{\\mathrm{PBE}}[n] \\;=\\; \\int \\left(e_x^{\\mathrm{LDA}}(n)\\,F_x^{\\mathrm{PBE}}(s) + n\\,\\big(\\varepsilon_c^{\\mathrm{LDA}}(n) + H^{\\mathrm{PBE}}(n,t)\\big)\\right)\\, d^3 r,\n$$\n它在自旋非极化情况下满足上述描述的 PBE 交换和相关约束。\n2) 一个基于 GE2 的参考总交换相关能，\n$$\nE_{xc}^{\\mathrm{GE2}}[n] \\;=\\; \\int \\left(e_x^{\\mathrm{LDA}}(n)\\,\\big(1 + \\mu_{\\mathrm{GE}} s^2\\big) + n\\,\\varepsilon_c^{\\mathrm{LDA}}(n) + n\\,\\beta_{\\mathrm{GE}} t^2\\right)\\, d^3 r,\n$$\n它使用精确的二阶梯度系数 $\\mu_{\\mathrm{GE}}$（用于交换）和 $\\beta_{\\mathrm{GE}}$（用于相关）。\n\n定义 PBE 相对于 GE2 参考的交换误差和相关误差为\n$$\n\\Delta E_x \\;=\\; E_x^{\\mathrm{PBE}} - E_x^{\\mathrm{GE2}}, \\qquad\n\\Delta E_c \\;=\\; E_c^{\\mathrm{PBE}} - E_c^{\\mathrm{GE2}}.\n$$\n为量化抵消程度，请报告每种情况下的无量纲抵消比\n$$\nR \\;=\\; \\frac{\\big|\\Delta E_x + \\Delta E_c\\big|}{\\big|\\Delta E_x\\big| + \\big|\\Delta E_c\\big|}.\n$$\n$R \\ll 1$ 的值表示交换误差和相关误差之间有强烈的抵消。所有能量均以哈特里（原子单位）为单位，而 $R$ 是无量纲的。\n\n利用球对称性，数值计算三维中的径向积分，即：\n$$\n\\int f(\\mathbf{r}) \\, d^3 r \\;=\\; 4\\pi \\int_0^\\infty f(r)\\, r^2 \\, dr.\n$$\n选择一个足够长且足够密的径向网格，以将每个 $(N,a)$ 的能量收敛到至少三位小数。您不得使用任何用户输入；所有参数均在下方指定。\n\n使用自旋非极化情况下的正则 PBE 常数和 LDA 相关拟合中广泛使用的均匀电子气参数。实现您的程序，为以下每个测试用例（“测试套件”）计算 $R$：\n- 情况 1 (理想路径，中等弥散)：$(N,a) = (2, 0.50)$，\n- 情况 2 (更弥散，预期为强梯度区域)：$(N,a) = (2, 0.25)$，\n- 情况 3 (紧凑密度，预期为弱梯度区域)：$(N,a) = (2, 2.00)$，\n- 情况 4 (更高密度幅值，中等梯度)：$(N,a) = (10, 1.00)$。\n\n您的程序应生成单行输出，其中包含四种情况的抵消比，每个值四舍五入到三位小数，形式为用方括号括起来的逗号分隔列表（例如，$\\texttt{[0.137,0.021,0.402,0.189]}$）。不应打印任何其他文本。输出是无量纲的，因此没有单位。目标是确定所提供的哪个系统产生的 $R$ 最接近 $0$，这表明 PBE 的交换误差和相关误差各自都很大，但相对于 GE2 参考系几乎完全抵消。", "solution": "我们从科恩-沈密度泛函理论 (DFT) 的能量划分开始，重点关注交换相关贡献。在广义梯度近似 (GGA) 中，交换能和相关能密度依赖于局域密度 $n(\\mathbf{r})$ 及其通过约化梯度的梯度。我们全程使用原子单位。\n\n对于一个自旋非极化系统，均匀电子气的费米波矢为 $k_F(n) = (3 \\pi^2 n)^{1/3}$。所考虑的球形模型密度为\n$$\nn(r) \\;=\\; N \\,\\frac{a^3}{\\pi}\\, e^{-2 a r}, \\quad r \\ge 0,\n$$\n其中 $N$ 为整数，$a$ 为正实数。对于这些密度，球对称性意味着 $|\\nabla n| = \\left|\\frac{dn}{dr}\\right| = 2 a n(r)$。进入交换项的约化梯度为\n$$\ns(r) \\;=\\; \\frac{|\\nabla n|}{2 k_F n} \\;=\\; \\frac{a}{k_F(r)} \\;=\\; \\frac{a}{(3 \\pi^2 n(r))^{1/3}},\n$$\n用于相关的屏蔽波矢为 $k_s(r) = \\sqrt{\\tfrac{4 k_F(r)}{\\pi}}$，得到相关的约化梯度\n$$\nt(r) \\;=\\; \\frac{|\\nabla n|}{2 k_s n} \\;=\\; \\frac{a}{k_s(r)} \\;=\\; \\frac{a}{\\sqrt{4 (3 \\pi^2 n(r))^{1/3} / \\pi}}.\n$$\n\n局域密度近似 (LDA) 的单位体积交换能密度具有标准的均匀电子气形式\n$$\ne_x^{\\mathrm{LDA}}(n) \\;=\\; - C_x\\, n^{4/3}, \\quad C_x \\;=\\; \\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}.\n$$\n\n对于 PBE 类型的交换，我们需要一个增强因子 $F_x^{\\mathrm{PBE}}(s)$，它 (i) 在 $s \\to 0$ 时以系数 $\\mu_{\\mathrm{GE}} = \\tfrac{10}{81}$ 再现精确的二阶梯度展开，并且 (ii) 饱和到一个有限上界以间接遵守 Lieb–Oxford 界。满足这些约束的正则解析形式是\n$$\nF_x^{\\mathrm{PBE}}(s) \\;=\\; 1 + \\kappa - \\frac{\\kappa}{1 + \\frac{\\mu}{\\kappa} s^2},\n$$\n其中 $\\mu$ 和 $\\kappa$ 取自原始的 Perdew–Burke–Ernzerhof 构造。正则 PBE 常数为\n$$\n\\mu \\;=\\; 0.21951, \\qquad \\kappa \\;=\\; 0.804,\n$$\n而精确的小梯度参考系数保持为 $\\mu_{\\mathrm{GE}} = \\tfrac{10}{81}$。\n\n对于相关，将总相关能写为\n$$\nE_c[n] \\;=\\; \\int n(r)\\,\\varepsilon_c(n(r)) \\, d^3 r,\n$$\n其中 $\\varepsilon_c(n)$ 是每粒子的相关能。LDA 相关能 $\\varepsilon_c^{\\mathrm{LDA}}(n)$ 由一个广泛使用的对自 spin-非极化情况下的均匀电子气进行的分段解析拟合提供。一个标准的选择是与 Ceperley–Alder 数据拟合的 Perdew–Zunger 1981 (PZ81) 参数化。以 Wigner–Seitz 半径 $r_s(n) = \\left(\\tfrac{3}{4\\pi n}\\right)^{1/3}$ 表示，其非极化分支为\n$$\n\\varepsilon_c^{\\mathrm{LDA}}(r_s) \\;=\\;\n\\begin{cases}\nA \\ln r_s + B + C\\, r_s \\ln r_s + D\\, r_s,  r_s \\ge 1,\\\\\n\\gamma_0 + \\beta_1\\, r_s \\ln r_s + \\beta_2\\, r_s,  r_s  1,\n\\end{cases}\n$$\n其中常数为\n$$\nA = 0.0310907, \\quad B = -0.048, \\quad C = 0.0020, \\quad D = -0.0116,\\\\\n\\gamma_0 = -0.1423, \\quad \\beta_1 = 1.0529, \\quad \\beta_2 = 0.3334.\n$$\n\nPBE 相关在 LDA 的基础上增加了一个梯度修正项 $H^{\\mathrm{PBE}}(n,t)$，该修正项的选择是为了 (i) 在小梯度极限下以精确系数 $\\beta_{\\mathrm{GE}}$ 再现相关的精确二阶梯度展开，(ii) 强制执行精确的高密度对数行为（系数 $\\gamma$），以及 (iii) 避免在大梯度下出现非物理的发散。满足这些约束的正则 PBE 解析形式是\n$$\n\\varepsilon_c^{\\mathrm{PBE}}(n,t) \\;=\\; \\varepsilon_c^{\\mathrm{LDA}}(n) + H^{\\mathrm{PBE}}(n,t),\n$$\n其中\n$$\nH^{\\mathrm{PBE}}(n,t) \\;=\\; \\gamma \\,\\ln\\!\\left( 1 + \\frac{\\beta\\, t^2 / \\gamma}{1 + A(n)\\, t^2} \\right),\n$$\n这里的密度依赖因子 $A(n)$ 通过在均匀情况下恢复 LDA 极限和精确的二阶梯度展开来确定，\n$$\nA(n) \\;=\\; \\frac{\\beta/\\gamma}{\\exp\\!\\left(-\\varepsilon_c^{\\mathrm{LDA}}(n)/\\gamma\\right) - 1}.\n$$\n正则常数为\n$$\n\\beta_{\\mathrm{GE}} = \\beta = 0.066725, \\qquad \\gamma = 0.0310907.\n$$\n在小梯度极限 $t \\to 0$ 下，此构造确保 $H^{\\mathrm{PBE}}(n,t) \\sim \\beta\\, t^2$，从而再现了相关性的二阶梯度展开的精确系数 $\\beta_{\\mathrm{GE}}$。\n\n有了这些要素，我们可以为给定的 $(N,a)$ 写出 PBE 型 GGA 和 GE2 参考能量：\n- PBE 型 GGA\n$$\nE_x^{\\mathrm{PBE}}[n] \\;=\\; \\int e_x^{\\mathrm{LDA}}(n)\\, F_x^{\\mathrm{PBE}}(s)\\, d^3 r, \\qquad\nE_c^{\\mathrm{PBE}}[n] \\;=\\; \\int n \\left(\\varepsilon_c^{\\mathrm{LDA}}(n) + H^{\\mathrm{PBE}}(n,t)\\right) d^3 r.\n$$\n- GE2 参考\n$$\nE_x^{\\mathrm{GE2}}[n] \\;=\\; \\int e_x^{\\mathrm{LDA}}(n)\\, \\big(1 + \\mu_{\\mathrm{GE}} s^2\\big)\\, d^3 r, \\qquad\nE_c^{\\mathrm{GE2}}[n] \\;=\\; \\int \\left(n\\, \\varepsilon_c^{\\mathrm{LDA}}(n) + n\\, \\beta_{\\mathrm{GE}}\\, t^2\\right) d^3 r.\n$$\n\n数值计算使用球对称性将三维积分简化为一维，\n$$\n\\int f(\\mathbf{r})\\, d^3 r \\;=\\; 4 \\pi \\int_0^\\infty f(r)\\, r^2\\, dr,\n$$\n我们使用一个足够密集的径向网格 $r \\in [0, r_{\\max}]$ 来近似这个积分，其中 $r_{\\max}$ 选择得足够大（对于指数密度，一个实用的规则是 $r_{\\max} \\approx \\tfrac{40}{a}$，以确保 $n(r_{\\max})$ 小到可以忽略不计）。采用具有均匀间距的复合辛普森法则，将每个能量收敛到至少三位小数。\n\n对于每个测试用例，计算相对于 GE2 的交换和相关误差，\n$$\n\\Delta E_x \\;=\\; E_x^{\\mathrm{PBE}} - E_x^{\\mathrm{GE2}}, \\qquad\n\\Delta E_c \\;=\\; E_c^{\\mathrm{PBE}} - E_c^{\\mathrm{GE2}},\n$$\n并报告抵消比\n$$\nR \\;=\\; \\frac{\\left|\\Delta E_x + \\Delta E_c\\right|}{\\left|\\Delta E_x\\right| + \\left|\\Delta E_c\\right|}.\n$$\n根据设计，在约化梯度很小的区域，这两种方法在二阶上是一致的；在约化梯度很大的区域，PBE 交换增强因子会饱和（以满足精确约束），而 GE2 交换则继续随 $s$ 呈二次方增长，这使得 $E_x^{\\mathrm{PBE}}$ 的负值小于 $E_x^{\\mathrm{GE2}}$，因此 $\\Delta E_x$ 通常为正。相反，PBE 相关采用对数内插，导致其相对于二次方的 GE2 相关修正项增长较慢，这使得 $E_c^{\\mathrm{PBE}}$ 的负值大于 $E_c^{\\mathrm{GE2}}$，因此 $\\Delta E_c$ 通常为负。对于足够弥散的密度（在广阔的空间区域内有大的 $r_s$、大的 $s$ 和 $t$），这两个符号相反但数值很大的误差可以几乎抵消，从而得到 $R \\ll 1$。\n\n我们将此方法应用于指定的测试套件：\n- 情况 1：$(N,a) = (2, 0.50)$，\n- 情况 2：$(N,a) = (2, 0.25)$，\n- 情况 3：$(N,a) = (2, 2.00)$，\n- 情况 4：$(N,a) = (10, 1.00)$。\n\n每种情况的算法概述：\n1) 构建一个径向网格 $r \\in [0, r_{\\max}]$，其中 $r_{\\max} = \\tfrac{40}{a}$，并使用大量点以收敛积分。\n2) 计算 $n(r)$, $|\\nabla n(r)|$, $k_F(r)$, $k_s(r)$, $s(r)$ 和 $t(r)$。\n3) 计算 $e_x^{\\mathrm{LDA}}(n)$, $F_x^{\\mathrm{PBE}}(s)$，并组合成 $e_x^{\\mathrm{PBE}}$ 和 $e_x^{\\mathrm{GE2}}$。\n4) 根据 PZ81 拟合计算 $\\varepsilon_c^{\\mathrm{LDA}}(n)$，使用正则 PBE 公式构建 $H^{\\mathrm{PBE}}(n,t)$，并组合 PBE 和 GE2 的相关能密度。\n5) 使用 $4\\pi r^2$ 雅可比行列式进行径向积分，以获得 $E_x^{\\mathrm{PBE}}$, $E_x^{\\mathrm{GE2}}$, $E_c^{\\mathrm{PBE}}$ 和 $E_c^{\\mathrm{GE2}}$。\n6) 计算 $\\Delta E_x$, $\\Delta E_c$ 和 $R$，并将 $R$ 四舍五入到三位小数。\n\n最后，生成单行输出，包含四个 $R$ 值，形式为用方括号括起来的逗号分隔列表，顺序与上面列出的情况一致。由于 $R$ 是无量纲的，所以输出没有单位。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\n# Constants for atomic units and functionals\nPI = np.pi\n\n# LDA exchange constant C_x\nC_x = 0.75 * (3.0 / PI) ** (1.0 / 3.0)  # (3/4)*(3/pi)^(1/3)\n\n# PBE exchange constants\nMU_PBE = 0.21951\nKAPPA_PBE = 0.804\n\n# Exact second-order gradient expansion coefficient for exchange\nMU_GE = 10.0 / 81.0\n\n# PBE correlation constants (and GE2 correlation coefficient)\nBETA_GE = 0.066725  # equals beta in PBE\nGAMMA = 0.0310907   # high-density limit constant\n\n# PZ81 (Perdew-Zunger 1981) LDA correlation constants (unpolarized)\nA_c = 0.0310907\nB_c = -0.048\nC_c = 0.0020\nD_c = -0.0116\ngamma0 = -0.1423\nbeta1 = 1.0529\nbeta2 = 0.3334\n\ndef lda_corr_eps_pz81(rs: np.ndarray) - np.ndarray:\n    \"\"\"\n    Perdew-Zunger 1981 LDA correlation per particle (unpolarized), piecewise in rs.\n    rs is the Wigner-Seitz radius array.\n    \"\"\"\n    rs = np.asarray(rs)\n    eps = np.empty_like(rs, dtype=float)\n    # Branch rs  1\n    mask_small = rs  1.0\n    rs_small = rs[mask_small]\n    # Avoid log(0) though rs_small > 0 in practice\n    eps[mask_small] = gamma0 + beta1 * rs_small * np.log(rs_small) + beta2 * rs_small\n\n    # Branch rs >= 1\n    mask_large = ~mask_small\n    rs_large = rs[mask_large]\n    eps[mask_large] = A_c * np.log(rs_large) + B_c + C_c * rs_large * np.log(rs_large) + D_c * rs_large\n    return eps\n\ndef pbe_corr_H(n: np.ndarray, t: np.ndarray) - np.ndarray:\n    \"\"\"\n    PBE correlation gradient correction H(n, t) per particle, spin unpolarized.\n    Uses canonical PBE formula with density-dependent A(n).\n    \"\"\"\n    # Compute LDA correlation per particle\n    rs = (3.0 / (4.0 * PI * np.maximum(n, 1e-300))) ** (1.0 / 3.0)\n    eps_c_lda = lda_corr_eps_pz81(rs)  # per particle\n\n    # A(n) factor with numerically stable handling near exp(x)-1 ~ 0\n    x = -eps_c_lda / GAMMA\n    # Use expm1 for numerical stability: exp(x) - 1\n    denom = np.expm1(x)\n    # Where denom is extremely small, fall back to series 1/(x + x^2/2)\n    small = np.abs(denom)  1e-12\n    A = np.empty_like(denom)\n    A[~small] = (BETA_GE / GAMMA) / denom[~small]\n    # Series expansion for small x: exp(x)-1 ~ x + x^2/2\n    xs = x[small]\n    series = xs + 0.5 * xs * xs\n    # avoid zero\n    series = np.where(np.abs(series)  1e-20, np.sign(series) * 1e-20, series)\n    A[small] = (BETA_GE / GAMMA) / series\n\n    # H per particle\n    num = (BETA_GE * t * t) / GAMMA\n    den = 1.0 + A * t * t\n    arg = 1.0 + num / den\n    # Ensure positivity of log argument\n    arg = np.maximum(arg, 1e-300)\n    H = GAMMA * np.log(arg)\n    return H\n\ndef pbe_exchange_enhancement(s: np.ndarray) - np.ndarray:\n    \"\"\"\n    PBE exchange enhancement factor F_x(s) = 1 + kappa - kappa / (1 + mu s^2 / kappa)\n    \"\"\"\n    return 1.0 + KAPPA_PBE - KAPPA_PBE / (1.0 + (MU_PBE / KAPPA_PBE) * s * s)\n\ndef radial_grid(a: float, num_points: int = 40000) - np.ndarray:\n    \"\"\"\n    Build a uniform radial grid [0, rmax] with rmax = 40/a.\n    \"\"\"\n    rmax = 40.0 / a\n    return np.linspace(0.0, rmax, num_points)\n\ndef simpson_integrate(y: np.ndarray, x: np.ndarray) - float:\n    \"\"\"\n    Composite Simpson's rule for uniform grid.\n    Requires odd number of points; if even, drop last point to make it odd.\n    \"\"\"\n    n = y.size\n    if n % 2 == 0:\n        # drop last point\n        y = y[:-1]\n        x = x[:-1]\n        n -= 1\n    h = (x[-1] - x[0]) / (n - 1)\n    S = y[0] + y[-1] + 4.0 * np.sum(y[1:-1:2]) + 2.0 * np.sum(y[2:-2:2])\n    return S * h / 3.0\n\ndef compute_R_for_case(N: int, a: float, grid_points: int = 40000) - float:\n    \"\"\"\n    Compute the cancellation ratio R for a given (N, a).\n    \"\"\"\n    # Radial grid\n    r = radial_grid(a, grid_points)\n    # Density and gradient\n    n = N * (a ** 3) / PI * np.exp(-2.0 * a * r)\n    dn_dr = -2.0 * a * n\n    abs_grad_n = np.abs(dn_dr)  # = 2 a n\n\n    # Fermi wave vector, screening wave vector\n    kF = (3.0 * PI ** 2 * np.maximum(n, 1e-300)) ** (1.0 / 3.0)\n    ks = np.sqrt(4.0 * kF / PI)\n\n    # Reduced gradients\n    s = abs_grad_n / (2.0 * kF * np.maximum(n, 1e-300))\n    t = abs_grad_n / (2.0 * ks * np.maximum(n, 1e-300))\n\n    # LDA exchange energy density per volume\n    e_x_lda = -C_x * n ** (4.0 / 3.0)\n\n    # PBE exchange energy density per volume\n    Fx_pbe = pbe_exchange_enhancement(s)\n    e_x_pbe = e_x_lda * Fx_pbe\n\n    # GE2 exchange energy density per volume\n    Fx_ge2 = 1.0 + MU_GE * s * s\n    e_x_ge2 = e_x_lda * Fx_ge2\n\n    # LDA correlation per particle and per volume\n    rs = (3.0 / (4.0 * PI * np.maximum(n, 1e-300))) ** (1.0 / 3.0)\n    eps_c_lda = lda_corr_eps_pz81(rs)\n    e_c_lda = n * eps_c_lda\n\n    # PBE correlation per volume: n * (eps_c_lda + H)\n    H_pbe = pbe_corr_H(n, t)\n    e_c_pbe = n * (eps_c_lda + H_pbe)\n\n    # GE2 correlation per volume: n*eps_c_lda + n*beta*t^2\n    e_c_ge2 = e_c_lda + n * (BETA_GE * t * t)\n\n    # Radial integration with spherical Jacobian\n    jac = 4.0 * PI * r * r\n    Ex_pbe = simpson_integrate(e_x_pbe * jac, r)\n    Ex_ge2 = simpson_integrate(e_x_ge2 * jac, r)\n    Ec_pbe = simpson_integrate(e_c_pbe * jac, r)\n    Ec_ge2 = simpson_integrate(e_c_ge2 * jac, r)\n\n    dEx = Ex_pbe - Ex_ge2\n    dEc = Ec_pbe - Ec_ge2\n    denom = abs(dEx) + abs(dEc)\n    if denom == 0.0:\n        R = 0.0\n    else:\n        R = abs(dEx + dEc) / denom\n    return R\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each test case is a tuple (N, a)\n    test_cases = [\n        (2, 0.50),  # Case 1\n        (2, 0.25),  # Case 2\n        (2, 2.00),  # Case 3\n        (10, 1.00), # Case 4\n    ]\n\n    results = []\n    for (N, a) in test_cases:\n        R = compute_R_for_case(N, a, grid_points=40001)  # odd grid size for Simpson\n        # Round to three decimals\n        results.append(f\"{R:.3f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2464514"}, {"introduction": "尽管GGA通过误差抵消实现了巨大成功，但其固有的半局域性带来了一个无法逃避的限制：无法描述长程的非局域电子相关效应。我们将分析两个遥远氦原子这一经典案例，来理解为何GGA无法捕捉对化学至关重要的范德华（色散）相互作用。这项练习揭示了所有半局域泛函的“阿喀琉斯之踵”[@problem_id:2464544]。", "problem": "在Kohn–Sham密度泛函理论 (KS-DFT) 中，广义梯度近似 (GGA) 内的交换相关能半局域地依赖于电子密度及其梯度。考虑一个由$2$个氦原子（标记为$A$和$B$）组成的体系，其原子核之间的中心距 $R$ 足够大，以至于电子密度 $n_A(\\mathbf{r})$ 和 $n_B(\\mathbf{r})$ 只有指数级微小的重叠。将总密度表示为 $n(\\mathbf{r}) = n_A(\\mathbf{r}) + n_B(\\mathbf{r})$。定义在间距 $R$ 处的交换相关相互作用贡献为\n$$\n\\Delta E_{\\mathrm{xc}}(R) \\equiv E_{\\mathrm{xc}}[n_A + n_B] - E_{\\mathrm{xc}}[n_A] - E_{\\mathrm{xc}}[n_B] .\n$$\n根据多体理论和长程微扰理论，对于大间距 $R$ 下的中性、闭壳层片段，其精确的相互作用能主要由一个色散（范德华）项主导，该项以 $-C_6 R^{-6}$ 的形式衰减，其中 $C_6  0$。然而，在实践中，GGA对于这种情况常常预测出一种虚假的相互作用行为。\n\n哪个陈述从第一性原理出发，最好地解释了GGA预测的 $\\Delta E_{\\mathrm{xc}}(R)$ 的渐进行为，以及两个远距离氦原子之间虚假相互作用能的根源？\n\nA. 因为GGA对于 $n(\\mathbf{r})$ 和 $\\nabla n(\\mathbf{r})$ 是半局域的，当 $n_A(\\mathbf{r})$ 和 $n_B(\\mathbf{r})$ 的空间重叠可忽略不计时，每个点的交换相关被积函数实际上只依赖于单个片段。这使得 $E_{\\mathrm{xc}}[n_A + n_B] \\approx E_{\\mathrm{xc}}[n_A] + E_{\\mathrm{xc}}[n_B]$（在相差指数级小的 $R$ 项的范围内成立），因此 $\\Delta E_{\\mathrm{xc}}(R) \\approx 0$，并且物理上的 $-C_6 R^{-6}$ 吸引作用被遗漏了。\n\nB. GGA包含精确的长程交换，因此仅从交换作用就能恢复正确的 $-C_6 R^{-6}$ 渐进吸引。\n\nC. 虚假的相互作用是由KS动能算符中动能相关能的双重计算引起的，这在大 $R$ 时产生了一个非物理的 $+C_3 R^{-3}$ 吸引。\n\nD. GGA中的自相互作用误差通过密度尾部产生了正确的非局域相关，从而得到一个与二阶微扰理论相同的 $-C_6 R^{-6}$ 相互作用。\n\nE. 该误差的产生是因为GGA不满足尺寸一致性，因此当 $R \\to \\infty$ 时，$\\Delta E_{\\mathrm{xc}}(R)$ 趋近于一个非零常数。", "solution": "在尝试解答之前，对问题陈述进行验证。\n\n**第一步：提取已知条件**\n- **体系**：$2$个氦原子，标记为$A$和$B$。\n- **间距**：中心距 $R$ “足够大”。\n- **电子密度**：单个电子密度 $n_A(\\mathbf{r})$ 和 $n_B(\\mathbf{r})$ “只有指数级微小的重叠”。\n- **总密度**：$n(\\mathbf{r}) = n_A(\\mathbf{r}) + n_B(\\mathbf{r})$。\n- **相互作用能定义**：交换相关相互作用贡献定义为 $\\Delta E_{\\mathrm{xc}}(R) \\equiv E_{\\mathrm{xc}}[n_A + n_B] - E_{\\mathrm{xc}}[n_A] - E_{\\mathrm{xc}}[n_B]$。\n- **理论背景**：交换相关能 $E_{\\mathrm{xc}}$ 在Kohn-Sham密度泛函理论 (KS-DFT) 的广义梯度近似 (GGA) 内进行评估。\n- **精确的渐进行为**：对于大间距 $R$ 下的中性、闭壳层片段，精确的相互作用能由色散（范德华）项主导，以 $-C_6 R^{-6}$ 形式衰减，其中 $C_6  0$。\n- **核心问题**：解释由GGA预测的 $\\Delta E_{\\mathrm{xc}}(R)$ 的渐进行为，以及由此产生的“虚假相互作用”的根源。\n\n**第二步：使用提取的已知条件进行验证**\n该问题定义明确且科学上合理。\n- **科学上成立**：该问题涉及半局域密度泛函（如LDA和GGA）在描述长程电子相关，特别是色散相互作用方面的一个众所周知的基本局限性。两个远距离氦原子的体系是用于说明这种失败的一个典型例子。将精确相互作用描述为 $-C_6 R^{-6}$ 势是正确的。\n- **问题陈述清晰**：该问题要求对一个计算模型（GGA）的特定行为给出物理和数学上的解释，对此存在一个标准的、明确的解释。\n- **客观**：语言技术性强、精确，且无主观内容。\n\n**第三步：结论与行动**\n问题陈述是**有效的**。将推导解答。\n\n**推导**\n\n广义梯度近似 (GGA) 的交换相关能由一个全空间积分定义：\n$$\nE_{\\mathrm{xc}}^{\\mathrm{GGA}}[n] = \\int e_{\\mathrm{xc}}^{\\mathrm{GGA}}(n(\\mathbf{r}), |\\nabla n(\\mathbf{r})|) \\, d^3\\mathbf{r}\n$$\n该泛函的关键性质是其**半局域**性。在某一点 $\\mathbf{r}$ 的被积函数 $e_{\\mathrm{xc}}^{\\mathrm{GGA}}$ 只依赖于*该同一点* $\\mathbf{r}$ 的电子密度 $n$ 及其梯度 $\\nabla n$。它不包含关于远处点密度的信息。\n\n我们被要求分析大间距 $R$ 处的相互作用能：\n$$\n\\Delta E_{\\mathrm{xc}}(R) = E_{\\mathrm{xc}}[n_A + n_B] - E_{\\mathrm{xc}}[n_A] - E_{\\mathrm{xc}}[n_B]\n$$\n代入GGA的形式：\n$$\n\\Delta E_{\\mathrm{xc}}^{\\mathrm{GGA}}(R) = \\int e_{\\mathrm{xc}}^{\\mathrm{GGA}}(n_A + n_B, |\\nabla(n_A + n_B)|) \\, d^3\\mathbf{r} - \\int e_{\\mathrm{xc}}^{\\mathrm{GGA}}(n_A, |\\nabla n_A|) \\, d^3\\mathbf{r} - \\int e_{\\mathrm{xc}}^{\\mathrm{GGA}}(n_B, |\\nabla n_B|) \\, d^3\\mathbf{r}\n$$\n\n在大间距 $R$ 处，电子密度 $n_A(\\mathbf{r})$ 和 $n_B(\\mathbf{r})$ 在空间上是分离的。空间 $\\mathbb{R}^3$ 可以划分为一个由原子A主导的区域（其中 $n_A$ 是有限的，而 $n_B$ 是指数级小的），一个由原子B主导的区域（其中 $n_B$ 是有限的，而 $n_A$ 是指数级小的），以及它们之间一个可忽略的区域。\n\n让我们分析组合体系的积分 $E_{\\mathrm{xc}}[n_A + n_B]$：\n$$\nE_{\\mathrm{xc}}^{\\mathrm{GGA}}[n_A + n_B] = \\int e_{\\mathrm{xc}}^{\\mathrm{GGA}}(n_A(\\mathbf{r}) + n_B(\\mathbf{r}), |\\nabla n_A(\\mathbf{r}) + \\nabla n_B(\\mathbf{r})|) \\, d^3\\mathbf{r}\n$$\n在 $n_A(\\mathbf{r})$ 显著的区域，$n_B(\\mathbf{r})$ 及其梯度是指数级小的。因此，我们有以下近似：\n$n_A(\\mathbf{r}) + n_B(\\mathbf{r}) \\approx n_A(\\mathbf{r})$\n$|\\nabla n_A(\\mathbf{r}) + \\nabla n_B(\\mathbf{r})| \\approx |\\nabla n_A(\\mathbf{r})|$\n类似地，在 $n_B(\\mathbf{r})$ 显著的区域，我们有：\n$n_A(\\mathbf{r}) + n_B(\\mathbf{r}) \\approx n_B(\\mathbf{r})$\n$|\\nabla n_A(\\mathbf{r}) + \\nabla n_B(\\mathbf{r})| \\approx |\\nabla n_B(\\mathbf{r})|$\n\n因为密度的重叠是指数级小的，我们可以将总和的积分近似为在非重叠区域上的积分之和：\n$$\nE_{\\mathrm{xc}}^{\\mathrm{GGA}}[n_A + n_B] \\approx \\int_{\\text{region A}} e_{\\mathrm{xc}}^{\\mathrm{GGA}}(n_A, |\\nabla n_A|) \\, d^3\\mathbf{r} + \\int_{\\text{region B}} e_{\\mathrm{xc}}^{\\mathrm{GGA}}(n_B, |\\nabla n_B|) \\, d^3\\mathbf{r}\n$$\n由于 $n_A$ 在A区域外基本为零，而 $n_B$ 在B区域外基本为零，这等价于：\n$$\nE_{\\mathrm{xc}}^{\\mathrm{GGA}}[n_A + n_B] \\approx E_{\\mathrm{xc}}^{\\mathrm{GGA}}[n_A] + E_{\\mathrm{xc}}^{\\mathrm{GGA}}[n_B] + \\mathcal{O}(e^{-\\alpha R})\n$$\n由微小但有限的重叠产生的修正项随距离 $R$ 指数衰减。\n\n因此，GGA内的相互作用能为：\n$$\n\\Delta E_{\\mathrm{xc}}^{\\mathrm{GGA}}(R) \\approx (E_{\\mathrm{xc}}^{\\mathrm{GGA}}[n_A] + E_{\\mathrm{xc}}^{\\mathrm{GGA}}[n_B]) - E_{\\mathrm{xc}}^{\\mathrm{GGA}}[n_A] - E_{\\mathrmc}}^{\\mathrm{GGA}}[n_B] \\approx 0\n$$\n更精确地说，当 $R \\to \\infty$ 时，$\\Delta E_{\\mathrm{xc}}^{\\mathrm{GGA}}(R)$ 指数衰减至零。这是该泛函半局域性质的直接结果。GGA泛函无法“看到”原子A上的瞬时偶极涨落与原子B上的感生偶极之间的相关性，这是一种非局域效应。正确的物理相互作用，即色散能，以幂律 $-C_6 R^{-6}$ 形式衰减。GGA未能捕捉到这一点，预测在长距离下相互作用能几乎为零。这与其说是一个“虚假”的相互作用，不如说是一个*缺失*的相互作用。\n\n**逐项分析**\n\nA. 因为GGA对于 $n(\\mathbf{r})$ 和 $\\nabla n(\\mathbf{r})$ 是半局域的，当 $n_A(\\mathbf{r})$ 和 $n_B(\\mathbf{r})$ 的空间重叠可忽略不计时，每个点的交换相关被积函数实际上只依赖于单个片段。这使得 $E_{\\mathrm{xc}}[n_A + n_B] \\approx E_{\\mathrm{xc}}[n_A] + E_{\\mathrm{xc}}[n_B]$（在相差指数级小的 $R$ 项的范围内成立），因此 $\\Delta E_{\\mathrm{xc}}(R) \\approx 0$，并且物理上的 $-C_6 R^{-6}$ 吸引作用被遗漏了。\n- **结论：正确。** 该陈述准确地抓住了问题的本质。它正确地指出了GGA的半局域性是根本原因。其结果，即对于非重叠密度，$E_{\\mathrm{xc}}[n_A+n_B]$ 分解为片段能量之和，也被正确陈述。这直接导致了相互作用能是指数衰减而非幂律衰减，意味着范德华吸引被遗漏了。\n\nB. GGA包含精确的长程交换，因此仅从交换作用就能恢复正确的 $-C_6 R^{-6}$ 渐进吸引。\n- **结论：不正确。** 这个陈述在根本上是错误的。首先，GGA交换泛函不能重现精确交换势的正确 $-1/r$ 渐进衰减；它们通常是指数衰减的。其次，$-C_6R^{-6}$ 相互作用是电子*相关*而非交换的结果。它源于两个片段上电子分布的相关涨落。\n\nC. 虚假的相互作用是由KS动能算符中动能相关能的双重计算引起的，这在大 $R$ 时产生了一个非物理的 $+C_3 R^{-3}$ 吸引。\n- **结论：不正确。** Kohn-Sham动能算符 $T_s$ 描述了一个虚构的无相互作用体系的动能。根据定义，它不包含任何相关。相关能的动能部分 $T_c = T - T_s$ 被吸收到相关能泛函 $E_c$ 的定义中。在KS算符中没有双重计算。此外，一个与 $+C_3 R^{-3}$ 成正比的项将是排斥的，这与它是吸引的说法相矛盾。\n\nD. GGA中的自相互作用误差通过密度尾部产生了正确的非局域相关，从而得到一个与二阶微扰理论相同的 $-C_6 R^{-6}$ 相互作用。\n- **结论：不正确。** 自相互作用误差 (SIE) 是GGA泛函的一个众所周知的缺陷，而不是一个可以纠正其他问题的功能。SIE导致对阴离子的描述过于弥散，以及对中性原子的交换相关势和密度尾部的衰减描述不正确（过快）。它不会产生非局域相关；实际上，它的效应加剧了描述色散的失败。这个陈述所声称的与事实完全相反。\n\nE. 该误差的产生是因为GGA不满足尺寸一致性，因此当 $R \\to \\infty$ 时，$\\Delta E_{\\mathrm{xc}}(R)$ 趋近于一个非零常数。\n- **结论：不正确。** 大多数常见的GGA泛函*是*满足尺寸一致性的。尺寸一致性要求，对于两个无限分离、无相互作用的片段A和B，总能量是单个能量的总和：$E(A+B) = E(A) + E(B)$。对于交换相关部分，这意味着 $\\lim_{R\\to\\infty} E_{\\mathrm{xc}}[n_A+n_B] = E_{\\mathrm{xc}}[n_A] + E_{\\mathrm{xc}}[n_B]$。这也就意味着 $\\lim_{R\\to\\infty} \\Delta E_{\\mathrm{xc}}(R) = 0$。问题不在于极限是一个非零常数，而在于其趋近于零的方式是指数衰减，而不是正确的幂律衰减。", "answer": "$$\\boxed{A}$$", "id": "2464544"}]}