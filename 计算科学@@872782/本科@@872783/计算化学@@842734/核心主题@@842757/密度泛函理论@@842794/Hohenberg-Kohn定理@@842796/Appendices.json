{"hands_on_practices": [{"introduction": "Hohenberg-Kohn 第二定理，即变分原理，是密度泛函理论的基石之一。它指出，任何合理的试探电子密度所计算出的能量都不能低于真实的基态能量。本练习 [@problem_id:209514] 将通过一个具体的可解模型——一维无限深势阱中的双电子体系——来动手验证这一原理，让你亲身体会试探密度与真实能量之间的关系。", "problem": "第二个Hohenberg-Kohn定理为电子密度建立了一个变分原理。该定理指出，对于一个具有外势 $v(\\mathbf{r})$ 的 $N$ 电子体系，其真实的基态能量 $E_{gs}$ 是真实基态密度 $n_{gs}(\\mathbf{r})$ 的唯一泛函，记作 $E[n_{gs}]$。对于任何一个 $N$-可表示（即，来自一个反对称的 $N$ 电子波函数）且不等于 $n_{gs}(\\mathbf{r})$ 的试探密度 $n_{trial}(\\mathbf{r})$，该泛函所得的能量严格大于基态能量：$E[n_{trial}] > E_{gs}$。\n\n总能量泛函由 $E[n] = F[n] + \\int n(\\mathbf{r}) v(\\mathbf{r}) d\\mathbf{r}$ 给出，其中 $F[n]$ 是一个普适的密度泛函，包含了动能和电子-电子相互作用能。对于无相互作用体系，电子-电子相互作用为零，普适泛函就是无相互作用动能泛函 $T_s[n]$。\n\n对于自旋单重态的双电子体系这一特殊情况，其在一维空间中的无相互作用动能泛函是精确已知的，由 von Weizsäcker 泛函给出：\n$$T_s[n] = \\frac{\\hbar^2}{8m} \\int \\frac{[n'(x)]^2}{n(x)} dx$$\n其中 $m$ 是电子质量，$\\hbar$ 是约化普朗克常数。\n\n考虑一个质量为 $m$ 的双无相互作用电子体系，被限制在长度为 $L$ 的一维无限深势阱中。外势为 $v(x) = 0$（当 $x \\in (0, L)$）以及 $v(x) = \\infty$（其他情况）。\n\n对于这个体系，一个简单的、行为良好的、在边界处正确地变为零的试探密度由以下多项式形式给出：\n$$n_{trial}(x) = A x^2 (L-x)^2$$\n（当 $x \\in (0, L)$）以及 $n_{trial}(x)=0$（其他情况）。这里，$A$ 是一个归一化常数。\n\n你的任务是量化用此试探密度计算的能量与真实基态能量的偏差。计算差值 $\\Delta E = E[n_{trial}] - E_{gs}$。", "solution": "1. 归一化常数 $A$：\n$$\\int_{0}^{L}A x^{2}(L-x)^{2}dx=2.$$  \n计算\n$$\\int_{0}^{L}x^{2}(L-x)^{2}dx\n=L^{5}\\left(\\frac{1}{3}-\\frac{1}{2}+\\frac{1}{5}\\right)\n=\\frac{L^{5}}{30},$$ \n所以\n$$A \\frac{L^{5}}{30}=2\n\\implies\nA=\\frac{60}{L^{5}}.$$\n\n2. Von Weizsäcker 动能：\n$$T_{s}[n]\n=\\frac{\\hbar^{2}}{8m}\\int_{0}^{L}\\frac{[n'(x)]^{2}}{n(x)}dx.$$\n这里 $n=A f^{2}$，其中 $f=x(L-x)$，所以 $n'=2A f f'=2A f(L-2x)$。\n因此\n$$\\frac{[n']^{2}}{n}\n=\\frac{4A^{2}f^{2}(L-2x)^{2}}{A f^{2}}\n=4A(L-2x)^{2},$$\n以及\n$$T_{s}[n]\n=\\frac{\\hbar^{2}}{8m} 4A\\int_{0}^{L}(L-2x)^{2}dx\n=\\frac{\\hbar^{2}A}{2m} \\int_{0}^{L}(L-2x)^{2}dx.$$\n计算\n$$\\int_{0}^{L}(L-2x)^{2}dx\n=L^{3}\\left(\\frac{4}{3}-2+1\\right)\n=\\frac{L^{3}}{3},$$\n所以\n$$T_{s}[n]\n=\\frac{\\hbar^{2}A}{2m} \\frac{L^{3}}{3}\n=\\frac{\\hbar^{2}}{6m} A L^{3}\n=\\frac{\\hbar^{2}}{6m} \\frac{60}{L^{5}} L^{3}\n=\\frac{10 \\hbar^{2}}{m L^{2}}.$$\n\n3. 一维盒子中两个无相互作用电子的真实基态能量：\n$$E_{gs}\n=2 \\frac{\\hbar^{2}\\pi^{2}}{2mL^{2}}\n=\\frac{\\hbar^{2}\\pi^{2}}{mL^{2}}.$$\n\n4. 能量差：\n$$\\Delta E\n=E[n_{trial}]-E_{gs}\n=\\frac{10 \\hbar^{2}}{mL^{2}}\n-\\frac{\\hbar^{2}\\pi^{2}}{mL^{2}}\n=\\frac{(10-\\pi^{2})\\hbar^{2}}{mL^{2}}.$$", "answer": "$$\\boxed{\\frac{(10-\\pi^{2})\\,\\hbar^{2}}{mL^{2}}}$$", "id": "209514"}, {"introduction": "Hohenberg-Kohn 第一定理揭示了一个深刻的对应关系：系统的基态电子密度唯一地决定了其外部势场（相差一个常数）。这个练习 [@problem_id:209541] 将颠覆我们通常求解薛定谔方程的思路，不从势场求解密度，而是反其道而行之。我们将从一个给定的高斯型基态密度出发，反向推导出产生该密度所需要的势场形式，从而加深对密度-势场唯一映射关系的理解。", "problem": "根据密度泛函理论的Hohenberg-Kohn第一定理，一个多电子体系的基态电子密度 $n_0(\\mathbf{r})$ 在相差一个加性常数的情况下唯一确定了外势 $v(\\mathbf{r})$。该原理使得求解“逆”问题成为可能，即寻找能产生已知基态密度的势场。\n\n考虑一个简单的一维系统，其中包含一个质量为 $m$ 的粒子，在一个未知的外势 $v(x)$ 中运动。该粒子是非相对论性的，并处于其基态。基态波函数 $\\psi_0(x)$ 和能量 $E_0$ 的定态薛定谔方程为：\n$$\n-\\frac{\\hbar^2}{2m} \\frac{d^2 \\psi_0(x)}{dx^2} + v(x) \\psi_0(x) = E_0 \\psi_0(x)\n$$\n基态密度由 $n_0(x) = |\\psi_0(x)|^2$ 给出。\n\n假设该系统的基态密度已被确定为归一化的高斯函数：\n$$\nn_0(x) = \\left(\\frac{\\alpha}{\\pi}\\right)^{1/2} e^{-\\alpha x^2}\n$$\n其中 $\\alpha$ 是一个正常数，其量纲为长度的-2次方。\n\n你的任务是求出产生此基态密度的外势 $v(x)$。为确保解的唯一性，势场应被定义为其最小值为零。请用 $m$、$\\hbar$、$\\alpha$ 和 $x$ 表示你的答案。", "solution": "1. 定态薛定谔方程为\n$$\n-\\frac{\\hbar^2}{2m}\\frac{d^2\\psi_0(x)}{dx^2}+v(x)\\,\\psi_0(x)=E_0\\,\\psi_0(x)\\,.\n$$\n2. 基态密度为 $n_0(x)=|\\psi_0(x)|^2$，因此我们选择实的、正的波函数\n$$\n\\psi_0(x)=\\biggl(\\frac{\\alpha}{\\pi}\\biggr)^{1/4}e^{-\\frac{\\alpha x^2}{2}}.\n$$\n3. 计算导数：\n$$\n\\frac{d\\psi_0}{dx}=-\\alpha x\\,\\psi_0,\\qquad\n\\frac{d^2\\psi_0}{dx^2}=(\\alpha^2x^2-\\alpha)\\,\\psi_0,\n$$\n因此\n$$\n\\frac{\\psi_0''(x)}{\\psi_0(x)}=\\alpha^2x^2-\\alpha.\n$$\n4. 代入除以 $\\psi_0$ 后的薛定谔方程：\n$$\n-\\frac{\\hbar^2}{2m}(\\alpha^2x^2-\\alpha)+v(x)=E_0\n\\implies\nv(x)=E_0+\\frac{\\hbar^2}{2m}(\\alpha^2x^2-\\alpha).\n$$\n5. 强制要求 $\\min_x v(x)=0$。最小值出现在 $x=0$ 处，因此\n$$\n0=v(0)=E_0-\\frac{\\hbar^2\\alpha}{2m}\n\\implies\nE_0=\\frac{\\hbar^2\\alpha}{2m}.\n$$\n6. 将 $E_0$ 代回 $v(x)$：\n$$\nv(x)=\\frac{\\hbar^2\\alpha}{2m}+\\frac{\\hbar^2}{2m}(\\alpha^2x^2-\\alpha)\n=\\frac{\\hbar^2\\alpha^2}{2m}\\,x^2.\n$$", "answer": "$$\\boxed{\\frac{\\hbar^2\\alpha^2}{2m}x^2}$$", "id": "209541"}, {"introduction": "理论的严谨性往往体现在其应用的前提条件上，Hohenberg-Kohn 定理也不例外。变分原理的一个关键前提是，所用的试探密度必须是物理上有效的（即“N可表示的”），这意味着它可以由某个反对称的N电子波函数产生。这个思想实验 [@problem_id:1407256] 将呈现一个看似违反变分原理的悖论情景，旨在引导你思考并理解为何“N可表示性”这一物理约束至关重要。", "problem": "一名本科生正在探究密度泛函理论 (DFT) 的基础。他们决定在最简单的体系上测试 Hohenberg-Kohn (HK) 变分原理：一个单一的、非相对论性的氢原子。\n\n在原子单位下，氢原子的外势由 $v_{ext}(\\vec{r}) = -1/r$ 给出。已知的精确基态能量为 $E_0 = -0.5$ Hartrees。对于单电子体系，总能量可以表示为电子密度 $n(\\vec{r})$ 的精确泛函：\n$$E[n] = T_s[n] + \\int v_{ext}(\\vec{r}) n(\\vec{r}) d^3\\vec{r}$$\n其中 $T_s[n]$ 是密度为 $n(\\vec{r})$ 的单个无相互作用电子的动能泛函。\n\n该学生使用两种不同的试探电子密度 $n_A(\\vec{r})$ 和 $n_B(\\vec{r})$ 进行了两次计算。\n1.  使用试探密度 $n_A(\\vec{r})$，计算得到的能量为 $E[n_A] = -0.46$ Hartrees。\n2.  使用试探密度 $n_B(\\vec{r})$，计算得到的能量为 $E[n_B] = -0.53$ Hartrees。\n\n第二个结果 $E[n_B]  E_0$ 似乎直接违反了第二 Hohenberg-Kohn 定理（变分原理），该定理指出任何有效的试探密度所产生的能量必须大于或等于真实的基态能量。假设动能泛函 $T_s[n]$ 被精确计算，并且所有数值积分都无误，那么这个悖论性结果最根本的理论原因是什么？\n\nA. Hohenberg-Kohn 定理是为多电子体系推导的，并且已知在像氢原子这样的单电子体系特例中会失效。\n\nB. DFT 中的变分原理本身只是一个近似，并不能保证能量的下界。\n\nC. 这个结果必定是由于使用了近似的动能泛函 $T_s[n]$，因为即使对于单电子，该泛函的精确形式也是未知的。\n\nD. 试探密度 $n_B(\\vec{r})$ 对于单电子体系来说不是一个物理上有效的密度（即它不是“N-可表示的”），因此违反了变分原理应用的一个关键前提条件。\n\nE. 计算 B 发现了比先前已知的更稳定的氢原子电子态，表明 $E_0 = -0.5$ Hartrees 不是真正的基态。", "solution": "我们从 Levy-Lieb 约束搜索形式的精确 Hohenberg-Kohn 变分表述开始。对于给定的外势 $v(\\vec r)$ 和粒子数 $N$，定义普适泛函\n$$\nF[n] = \\min_{\\Psi \\to n} \\langle \\Psi | \\hat T + \\hat V_{ee} | \\Psi \\rangle,\n$$\n其中最小化是针对所有能产生密度 $n(\\vec r)$ 的反对称 $N$-电子波函数 $\\Psi$。对于任何 $N$-可表示的密度 $n$（即，来自至少一个这样的 $\\Psi$），DFT 能量泛函为\n$$\nE_{v}[n] = F[n] + \\int v(\\vec r) \\, n(\\vec r) \\, d^{3}\\vec r.\n$$\n设 $\\Psi_{n}$ 是一个在 $F[n]$ 定义中达到（或任意接近）最小值的波函数。那么\n$$\nE_{v}[n] = \\langle \\Psi_{n} | \\hat T + \\hat V_{ee} | \\Psi_{n} \\rangle + \\int v \\, n\n= \\langle \\Psi_{n} | \\hat T + \\hat V_{ee} + \\hat V | \\Psi_{n} \\rangle \\ge E_{0},\n$$\n其中 $E_{0}$ 是精确的基态能量，不等式遵循 Rayleigh-Ritz 原理。因此，对于每个 $N$-可表示的密度 $n$，我们有\n$$\nE_{v}[n] \\ge E_{0}.\n$$\n\n对于单电子体系，$\\hat V_{ee} = 0$ 且\n$$\nF[n] = T_{s}[n] = \\min_{\\psi \\to n} \\langle \\psi | \\hat T | \\psi \\rangle = T_{W}[n],\n$$\n其中精确的 Weizsäcker 泛函为\n$$\nT_{W}[n] = \\frac{1}{8} \\int \\frac{|\\nabla n(\\vec r)|^{2}}{n(\\vec r)} \\, d^{3}\\vec r,\n$$\n前提是 $n$ 是 $N$-可表示的且足够正则，以至于 $\\sqrt{n} \\in H^{1}(\\mathbb{R}^{3})$（确保有限的动能）。因此，对于任何物理上有效的单电子密度 $n$，\n$$\nE[n] = T_{s}[n] + \\int v_{ext}(\\vec r) \\, n(\\vec r) \\, d^{3}\\vec r \\ge E_{0}.\n$$\n\n在问题中，得到 $E[n_{B}]  E_{0}$ 的前提是假设 $T_{s}[n]$ 被精确计算且积分是精确的。上面的不等式表明，对于任何 $N$-可表示的单电子密度，这样的结果都不可能发生。因此，唯一剩下的逻辑可能性是 $n_{B}$ 不是一个物理上可接受的单电子密度（不满足 $N$-可表示性，或者等效地，对于通过约束搜索得到的 HK 变分界，它位于 $F[n]$ 的定义域之外）。典型的违规情况包括缺乏非负性、未正确归一化到 $N=1$，或者正则性不足，导致不存在动能有限且满足 $|\\psi|^{2} = n_{B}$ 的波函数 $\\psi$。\n\n评估各个选项：\n- A 是错误的：HK 定理适用于任何 $N$，并且对于 $N=1$ 的情况，泛函是精确已知的。\n- B 是错误的：DFT 变分原理对于其定义域上的约束搜索泛函是严格成立的。\n- C 是错误的：对于 $N=1$，$T_{s}[n]$ 精确等于 $T_{W}[n]$。\n- D 是正确的：悖论的产生是因为 $n_{B}$ 不是 $N$-可表示的，从而使变分界无效。\n- E 是错误的：氢原子的 $E_{0}$ 是精确已知的，不可能被一个物理上有效的密度所超越而得到更低的能量。\n\n因此，根本的理论原因是试探密度 $n_{B}$ 不是 $N$-可表示的。", "answer": "$$\\boxed{D}$$", "id": "1407256"}]}