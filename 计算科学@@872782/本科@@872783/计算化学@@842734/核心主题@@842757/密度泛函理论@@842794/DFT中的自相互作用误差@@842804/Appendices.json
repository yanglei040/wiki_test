{"hands_on_practices": [{"introduction": "要真正掌握自相互作用误差（SIE），最直接的方法莫过于亲手计算它。下面这个练习将引导我们处理一个假设性的单电子体系，其电子密度由一个简单的数学函数（高斯函数）描述。通过为这个体系推导非物理的库仑自相互作用能的解析表达式，我们不仅可以锻炼我们的数学物理技能，还能具体地量化出这个本应被精确泛函完全消除的误差项。这个练习让我们从最根本的层面理解 SIE 的来源。[@problem_id:2462002]", "problem": "在密度泛函理论 (DFT) 的背景下，自相互作用误差的产生是因为对于一个单电子体系，经典的静电（哈特里）能量错误地包含了电子与其自身的相互作用，而精确的交换相关泛函本应抵消掉这一项。在哈特里原子单位制中，电荷密度之间的库仑相互作用由 $1/|\\mathbf{r}-\\mathbf{r}'|$ 给出，密度 $\\rho(\\mathbf{r})$ 的哈特里能量定义为\n$$\nE_{\\mathrm{H}}[\\rho] \\equiv \\frac{1}{2}\\iint \\frac{\\rho(\\mathbf{r})\\,\\rho(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}\\,d^3\\mathbf{r}\\,d^3\\mathbf{r}'.\n$$\n考虑一个假设的单电子体系，其球对称的高斯试探密度（未归一化）由下式给出\n$$\n\\tilde{\\rho}(\\mathbf{r}) = \\exp\\!\\left(-\\alpha r^2\\right),\n$$\n其中 $\\alpha>0$ 且 $r = |\\mathbf{r}|$。首先，通过确定归一化常数 $C$ 使得 $\\rho(\\mathbf{r}) = C\\,\\exp\\!\\left(-\\alpha r^2\\right)$，来满足单电子归一化条件 $\\int \\rho(\\mathbf{r})\\,d^3\\mathbf{r} = 1$。然后，使用上面 $E_{\\mathrm{H}}[\\rho]$ 的定义，推导这个单电子高斯密度的虚假库仑自相互作用能的闭式解析表达式，该表达式是 $\\alpha$ 的函数。\n\n将你的最终答案表示为以哈特里为单位的单一简化解析表达式。无需进行数值近似或舍入。", "solution": "本题要求计算一个单电子体系的静电自相互作用能，即哈特里能量 $E_{\\mathrm{H}}$，该体系的电荷密度由一个球对称高斯函数建模。过程包括两个步骤：首先，对给定的密度分布进行归一化；其次，计算哈特里能量的六维积分。\n\n首先，我们必须确定密度 $\\rho(\\mathbf{r}) = C \\exp(-\\alpha r^2)$ (其中 $r=|\\mathbf{r}|$) 的归一化常数 $C$。单电子体系的归一化条件要求密度在全空间上的积分等于 $1$。我们在球坐标系 $(r, \\theta, \\phi)$ 中进行计算，其体积元为 $d^3\\mathbf{r} = r^2\\sin\\theta\\,dr\\,d\\theta\\,d\\phi$。\n\n$$\n\\int \\rho(\\mathbf{r})\\,d^3\\mathbf{r} = 1\n$$\n$$\nC \\int_0^{2\\pi} d\\phi \\int_0^\\pi \\sin\\theta\\,d\\theta \\int_0^\\infty \\exp(-\\alpha r^2)\\,r^2\\,dr = 1\n$$\n\n角度部分的积分分别得出 $2\\pi$ 和 $2$，总的立体角为 $4\\pi$。\n\n$$\nC \\cdot 4\\pi \\int_0^\\infty r^2 \\exp(-\\alpha r^2) \\,dr = 1\n$$\n\n剩下的径向积分是一个标准的高斯积分。我们可以使用已知公式 $\\int_0^\\infty x^{2n} \\exp(-ax^2)\\,dx = \\frac{(2n-1)!!}{2^{n+1}} \\sqrt{\\frac{\\pi}{a^{2n+1}}}$ 来计算它。在我们的例子中，$n=1$ 且 $a=\\alpha$。双阶乘 $(2(1)-1)!! = 1!! = 1$。\n\n$$\n\\int_0^\\infty r^2 \\exp(-\\alpha r^2) \\,dr = \\frac{1!!}{2^{1+1}} \\sqrt{\\frac{\\pi}{\\alpha^{2(1)+1}}} = \\frac{1}{4} \\sqrt{\\frac{\\pi}{\\alpha^3}} = \\frac{\\sqrt{\\pi}}{4\\alpha^{3/2}}\n$$\n\n将此结果代回归一化方程：\n\n$$\nC \\cdot 4\\pi \\left( \\frac{\\sqrt{\\pi}}{4\\alpha^{3/2}} \\right) = C \\frac{\\pi^{3/2}}{\\alpha^{3/2}} = C \\left(\\frac{\\pi}{\\alpha}\\right)^{3/2} = 1\n$$\n\n解出归一化常数 $C$ 可得：\n\n$$\nC = \\left(\\frac{\\alpha}{\\pi}\\right)^{3/2}\n$$\n\n因此，归一化的单电子密度为：\n\n$$\n\\rho(r) = \\left(\\frac{\\alpha}{\\pi}\\right)^{3/2} \\exp(-\\alpha r^2)\n$$\n\n接下来，我们计算哈特里能量 $E_{\\mathrm{H}}[\\rho]$，对于这个单电子体系，它代表了虚假的自相互作用能。\n$$\nE_{\\mathrm{H}}[\\rho] = \\frac{1}{2}\\iint \\frac{\\rho(\\mathbf{r})\\,\\rho(\\mathbf{r}')}{|\\mathbf{r}-\\mathbf{r}'|}\\,d^3\\mathbf{r}\\,d^3\\mathbf{r}'\n$$\n计算这个六维积分的一种有效方法是利用傅里叶变换。令 $\\rho(\\mathbf{k})$ 为 $\\rho(\\mathbf{r})$ 的傅里叶变换，根据库仑积分的傅里叶变换性质，我们有：\n$$\nE_{\\mathrm{H}}[\\rho] = \\frac{1}{2} \\frac{1}{(2\\pi)^3} \\int \\frac{4\\pi}{k^2} |\\rho(\\mathbf{k})|^2 \\,d^3\\mathbf{k} = \\frac{2\\pi}{(2\\pi)^3} \\int \\frac{|\\rho(\\mathbf{k})|^2}{k^2} \\,d^3\\mathbf{k}\n$$\n我们首先需要计算高斯函数 $\\rho(\\mathbf{r}) = C \\exp(-\\alpha r^2)$ 的三维傅里叶变换：\n$$\n\\rho(\\mathbf{k}) = \\int \\rho(\\mathbf{r}) e^{-i\\mathbf{k}\\cdot\\mathbf{r}} \\,d^3\\mathbf{r} = C \\int \\exp(-\\alpha r^2) e^{-i\\mathbf{k}\\cdot\\mathbf{r}} \\,d^3\\mathbf{r}\n$$\n这是一个标准的高斯积分傅里叶变换结果，其形式为：\n$$\n\\rho(\\mathbf{k}) = C \\left(\\frac{\\pi}{\\alpha}\\right)^{3/2} \\exp\\left(-\\frac{k^2}{4\\alpha}\\right)\n$$\n代入我们之前求得的归一化常数 $C = (\\alpha/\\pi)^{3/2}$：\n$$\n\\rho(\\mathbf{k}) = \\left(\\frac{\\alpha}{\\pi}\\right)^{3/2} \\left(\\frac{\\pi}{\\alpha}\\right)^{3/2} \\exp\\left(-\\frac{k^2}{4\\alpha}\\right) = \\exp\\left(-\\frac{k^2}{4\\alpha}\\right)\n$$\n现在，我们将 $\\rho(\\mathbf{k})$ 代入哈特里能量的表达式中。由于 $\\rho(\\mathbf{k})$ 只依赖于 $k = |\\mathbf{k}|$，我们可以使用球坐标对 $\\mathbf{k}$ 空间进行积分 ($d^3\\mathbf{k} = 4\\pi k^2 dk$)：\n$$\nE_{\\mathrm{H}}[\\rho] = \\frac{2\\pi}{(2\\pi)^3} \\int_0^\\infty \\frac{\\left[\\exp\\left(-\\frac{k^2}{4\\alpha}\\right)\\right]^2}{k^2} (4\\pi k^2) \\,dk\n$$\n$$\nE_{\\mathrm{H}}[\\rho] = \\frac{8\\pi^2}{(2\\pi)^3} \\int_0^\\infty \\exp\\left(-\\frac{k^2}{2\\alpha}\\right) \\,dk = \\frac{1}{\\pi} \\int_0^\\infty \\exp\\left(-\\frac{k^2}{2\\alpha}\\right) \\,dk\n$$\n这是一个标准的高斯半积分，其值为 $\\int_0^\\infty \\exp(-ax^2)\\,dx = \\frac{1}{2}\\sqrt{\\frac{\\pi}{a}}$。在这里，$a = 1/(2\\alpha)$。\n$$\n\\int_0^\\infty \\exp\\left(-\\frac{k^2}{2\\alpha}\\right) \\,dk = \\frac{1}{2}\\sqrt{\\frac{\\pi}{1/(2\\alpha)}} = \\frac{1}{2}\\sqrt{2\\pi\\alpha}\n$$\n将这个结果代回能量表达式：\n$$\nE_{\\mathrm{H}}[\\rho] = \\frac{1}{\\pi} \\left( \\frac{1}{2}\\sqrt{2\\pi\\alpha} \\right) = \\frac{\\sqrt{2\\pi\\alpha}}{2\\pi} = \\sqrt{\\frac{2\\pi\\alpha}{4\\pi^2}} = \\sqrt{\\frac{\\alpha}{2\\pi}}\n$$\n因此，该单电子高斯密度的虚假库仑自相互作用能为：\n$$\nE_{\\mathrm{H}} = \\sqrt{\\frac{\\alpha}{2\\pi}}\n$$", "answer": "$$\n\\boxed{\\sqrt{\\frac{\\alpha}{2\\pi}}}\n$$", "id": "2462002"}, {"introduction": "自相互作用误差最臭名昭著的后果之一是它导致的“离域误差”，这种误差会错误地偏好电子电荷弥散分布（导致分数电荷），而不是物理上更真实的局域化整数电荷状态。这个实践练习将复杂的物理问题抽象为一个计算实验。通过编写一个简单的程序，你将亲眼见证 SIE 如何引入能量对分数占据数的非物理凸性，并最终导致对电荷分布的定性错误预测。[@problem_id:2461989]", "problem": "要求您形式化并实现一个最小的、自洽的计算实验，以证明密度泛函理论（DFT）中的自相互作用误差（SIE）如何人为地偏好对称混合价二聚体中的电荷离域，这类似于混合价配合物（如 $\\left[\\mathrm{Fe_2(OH)_3}\\right]^+$）中的额外电子。您的实验应基于以下纯数学模型，该模型抽象了将一个过剩电子放置在双中心系统上的能量学。\n\n- 设 $f \\in [0,1]$ 为过剩电子在中心 $1$ 上的分数（因此中心 $2$ 上有 $1-f$）。\n- 设 $\\beta$（单位为 $\\mathrm{eV}$）量化一种中心能量不对称性，该不对称性使电子线性地偏向一个中心：总能量通过 $\\beta f$ 线性地依赖于 $f$。\n- 设 $k \\ge 0$（单位为 $\\mathrm{eV}$）量化一个凸曲率，该曲率模拟了由 SIE 引入的对分段线性的偏离。正的 $k$ 会降低相对于边界 $f=0$ 和 $f=1$ 而言，在 $f=\\tfrac{1}{2}$ 附近的分数占据的能量。\n\n定义两个作为 $f$ 函数的能量模型：\n\n- 一个受 SIE 影响的模型：\n$$\nE_{\\mathrm{SIE}}(f;\\beta,k) \\,=\\, E_0 \\,+\\, \\beta f \\,+\\, k\\left(f-\\tfrac{1}{2}\\right)^2,\n$$\n其中 $E_0$ 是一个常数参考能量，不影响对 $f$ 的最小化结果。\n- 一个精确的（分段线性）参考模型，没有凸性偏离：\n$$\nE_{\\mathrm{exact}}(f;\\beta) \\,=\\, E_0 \\,+\\, \\beta f.\n$$\n\n您的任务是编写一个完整的程序，对于每个指定的 $(\\beta,k)$ 对，计算以下量：\n\n1. 最小化占据分数 $f_{\\mathrm{SIE}} \\in [0,1]$，它在 $0 \\le f \\le 1$ 的约束下最小化 $E_{\\mathrm{SIE}}(f;\\beta,k)$。\n2. 最小化占据分数 $f_{\\mathrm{exact}} \\in \\{0,1\\}$，它在 $0 \\le f \\le 1$ 的范围内最小化 $E_{\\mathrm{exact}}(f;\\beta)$。如果 $\\beta > 0$，选择 $f_{\\mathrm{exact}}=0$。如果 $\\beta  0$，选择 $f_{\\mathrm{exact}}=1$。如果 $\\beta = 0$，按照约定选择 $f_{\\mathrm{exact}}=0$。\n3. 一个布尔指示符 $D$，当且仅当 SIE 模型预测出严格的分数最小值，即 $0  f_{\\mathrm{SIE}}  1$，而精确模型预测出整数最小值，即 $f_{\\mathrm{exact}} \\in \\{0,1\\}$ 时，$D$ 为 $\\mathrm{True}$。否则 $D=\\mathrm{False}$。\n\n数值和单位要求：\n\n- 所有的 $\\beta$ 和 $k$ 都以 $\\mathrm{eV}$ 为单位给出。占据分数 $f_{\\mathrm{SIE}}$ 和 $f_{\\mathrm{exact}}$ 是无量纲的。\n- 程序必须报告四舍五入到 $6$ 位小数的 $f_{\\mathrm{SIE}}$ 和 $f_{\\mathrm{exact}}$。\n\n测试组：\n\n- 使用以下四个测试用例，每个用例指定为 $(\\beta, k)$（单位为 $\\mathrm{eV}$）：\n    - 用例 $1$：$(\\beta,k) = (\\,0.02,\\,0.40\\,)$。\n    - 用例 $2$：$(\\beta,k) = (\\,-0.03,\\,0.40\\,)$。\n    - 用例 $3$：$(\\beta,k) = (\\,0.45,\\,0.40\\,)$。\n    - 用例 $4$：$(\\beta,k) = (\\,0.00,\\,0.25\\,)$。\n\n最终输出格式：\n\n- 您的程序应生成单行输出，其中包含所有四个测试用例的结果，形式为用方括号括起来的逗号分隔列表。每个测试用例贡献一个包含三个项目的列表 $[f_{\\mathrm{SIE}}, f_{\\mathrm{exact}}, D]$。因此，最终输出应为单行形式：\n$[ [f_{\\mathrm{SIE},1},f_{\\mathrm{exact},1},D_1],[f_{\\mathrm{SIE},2},f_{\\mathrm{exact},2},D_2],[f_{\\mathrm{SIE},3},f_{\\mathrm{exact},3},D_3],[f_{\\mathrm{SIE},4},f_{\\mathrm{exact},4},D_4] ]$\n其中所有的 $f$ 都四舍五入到 $6$ 位小数，而 $D$ 为 $\\mathrm{True}$ 或 $\\mathrm{False}$。", "solution": "所提出的问题是约束优化中的一个有效练习，并且是展示密度泛函理论中自相互作用误差（SIE）的一个正确的教学模型。受 SIE 影响的能量模型 $E_{\\mathrm{SIE}}$ 和精确能量模型 $E_{\\mathrm{exact}}$ 都有明确的定义，该任务是微积分和分析的直接应用。我们将继续推导所需的量。\n\n该问题要求我们在电子占据分数 $f \\in [0,1]$ 的定义域上找到两个能量函数的最小化子。\n\n**1. 精确能量 $E_{\\mathrm{exact}}(f;\\beta)$ 的最小化**\n\n精确能量模型由以下线性函数给出：\n$$\nE_{\\mathrm{exact}}(f;\\beta) = E_0 + \\beta f\n$$\n最小化在紧区间 $f \\in [0,1]$ 上进行。线性函数在区间上的最小值必然出现在其边界之一。\n\n- 如果 $\\beta > 0$，函数 $E_{\\mathrm{exact}}(f)$ 随 $f$ 严格递增。因此，在 $f$ 的最小可能值处达到最小值，即 $f=0$。\n- 如果 $\\beta  0$，函数 $E_{\\mathrm{exact}}(f)$ 随 $f$ 严格递减。因此，在 $f$ 的最大可能值处达到最小值，即 $f=1$。\n- 如果 $\\beta = 0$，函数是常数，$E_{\\mathrm{exact}}(f) = E_0$，任何 $f \\in [0,1]$ 都是一个最小化子。问题陈述在这种情况下指定了一个约定，即选择 $f=0$。\n\n因此，最小化占据分数 $f_{\\mathrm{exact}}$ 按如下方式确定：\n$$\nf_{\\mathrm{exact}} =\n\\begin{cases}\n1  \\text{if } \\beta  0 \\\\\n0  \\text{if } \\beta \\ge 0\n\\end{cases}\n$$\n根据这个定义，$f_{\\mathrm{exact}}$ 始终是一个整数，不是 $0$ 就是 $1$，表示电荷完全定域在两个中心之一上。\n\n**2. 受 SIE 影响的能量 $E_{\\mathrm{SIE}}(f;\\beta,k)$ 的最小化**\n\n受 SIE 影响的能量模型是 $f$ 的二次函数：\n$$\nE_{\\mathrm{SIE}}(f;\\beta,k) = E_0 + \\beta f + k\\left(f-\\tfrac{1}{2}\\right)^2\n$$\n给定参数 $k \\ge 0$。最小化同样在 $f \\in [0,1]$ 上进行。\n\n为了找到最小值，我们首先通过将关于 $f$ 的一阶导数设为零来找到无约束极值。\n$$\n\\frac{dE_{\\mathrm{SIE}}}{df} = \\beta + 2k\\left(f-\\tfrac{1}{2}\\right) = 0\n$$\n解出 $f$，我们得到无约束最小化子，记为 $f_{unc}$。如果 $k > 0$：\n$$\nf_{unc} = \\tfrac{1}{2} - \\frac{\\beta}{2k}\n$$\n二阶导数 $\\frac{d^2E_{\\mathrm{SIE}}}{df^2} = 2k$ 是非负的（因为 $k \\ge 0$），这证实了 $f_{unc}$ 对应一个最小值。\n\n约束最小值 $f_{\\mathrm{SIE}}$ 必须位于区间 $[0,1]$ 内。由于 $E_{\\mathrm{SIE}}$ 是一个凸抛物线（对于 $k>0$），区间 $[0,1]$ 上的最小值由 $f_{unc}$ 相对于该区间的位置决定：\n- 如果 $f_{unc}$ 落在区间内，即 $0 \\le f_{unc} \\le 1$，则 $f_{\\mathrm{SIE}} = f_{unc}$。\n- 如果 $f_{unc}  0$，函数在 $[0,1]$ 上单调递增，所以最小值在 $f_{\\mathrm{SIE}} = 0$ 处。\n- 如果 $f_{unc} > 1$，函数在 $[0,1]$ 上单调递减，所以最小值在 $f_{\\mathrm{SIE}} = 1$ 处。\n\n这等同于将 $f_{unc}$ 的值裁剪到区间 $[0,1]$。\n\n条件 $0 \\le f_{unc} \\le 1$ 可以用 $\\beta$ 和 $k$ 来表示：\n$$\n0 \\le \\tfrac{1}{2} - \\frac{\\beta}{2k} \\le 1 \\implies -\\tfrac{1}{2} \\le -\\frac{\\beta}{2k} \\le \\tfrac{1}{2} \\implies -k \\le \\beta \\le k \\implies |\\beta| \\le k\n$$\n因此，对于 $k>0$，解为：\n$$\nf_{\\mathrm{SIE}} =\n\\begin{cases}\n1  \\text{if } \\beta  -k \\\\\n\\tfrac{1}{2} - \\frac{\\beta}{2k}  \\text{if } |\\beta| \\le k \\\\\n0  \\text{if } \\beta > k\n\\end{cases}\n$$\n如果 $k=0$，模型简化为 $E_{\\mathrm{SIE}}(f;\\beta,0) = E_{\\mathrm{exact}}(f;\\beta)$，因此 $f_{\\mathrm{SIE}}$ 遵循与 $f_{\\mathrm{exact}}$ 相同的规则。\n\n**3. 指示符 $D$ 的确定**\n\n布尔指示符 $D$ 定义为当且仅当 SIE 模型预测出严格的分数最小值（$0  f_{\\mathrm{SIE}}  1$）而精确模型预测出整数最小值（$f_{\\mathrm{exact}} \\in \\{0,1\\}$）时为 $\\mathrm{True}$。如前所述，$f_{\\mathrm{exact}}$ 始终是整数。因此，$D$ 为 $\\mathrm{True}$ 的条件简化为当且仅当 $0  f_{\\mathrm{SIE}}  1$。\n\n从对 $f_{\\mathrm{SIE}}$ 的分析可知，当且仅当无约束最小值 $f_{unc}$ 严格位于区间 $(0,1)$ 内时，才会出现严格的分数值。这对应于条件 $|\\beta|  k$ 且 $k>0$。如果 $|\\beta| \\ge k$ 或 $k=0$，$f_{\\mathrm{SIE}}$ 将为 $0$ 或 $1$，使得 $D$ 等于 $\\mathrm{False}$。\n\n**算法摘要**\n\n对于每对给定的参数 $(\\beta, k)$：\n1.  根据 $\\beta$ 的符号计算 $f_{\\mathrm{exact}}$。\n2.  计算 $f_{\\mathrm{SIE}}$。如果 $k>0$，计算 $f_{unc} = 0.5 - \\beta/(2k)$ 并将该值裁剪到 $[0,1]$ 区间。如果 $k=0$，则设置 $f_{\\mathrm{SIE}}=f_{\\mathrm{exact}}$。\n3.  如果 $k>0$ 且 $|\\beta|  k$，则设置 $D=\\mathrm{True}$；否则设置 $D=\\mathrm{False}$。\n4.  将 $f_{\\mathrm{SIE}}$ 和 $f_{\\mathrm{exact}}$ 四舍五入到六位小数。\n5.  格式化输出。\n\n我们将这个算法应用于给定的测试用例。\n\n- **用例 1：$(\\beta, k) = (0.02, 0.40)$**\n  - $f_{\\mathrm{exact}}$: 因为 $\\beta=0.02 > 0$，所以 $f_{\\mathrm{exact}} = 0$。\n  - $f_{\\mathrm{SIE}}$: $k=0.40 > 0$ 且 $|\\beta|=0.02  k=0.40$。$f_{unc} = 0.5 - 0.02 / (2 \\times 0.40) = 0.5 - 0.025 = 0.475$。因为 $0  0.475  1$，所以 $f_{\\mathrm{SIE}} = 0.475$。\n  - $D$: 因为 $0  f_{\\mathrm{SIE}}  1$，所以 $D=\\mathrm{True}$。\n  - 结果：$[0.475000, 0.000000, True]$\n\n- **用例 2：$(\\beta, k) = (-0.03, 0.40)$**\n  - $f_{\\mathrm{exact}}$: 因为 $\\beta=-0.03  0$，所以 $f_{\\mathrm{exact}} = 1$。\n  - $f_{\\mathrm{SIE}}$: $k=0.40 > 0$ 且 $|\\beta|=0.03  k=0.40$。$f_{unc} = 0.5 - (-0.03) / (2 \\times 0.40) = 0.5 + 0.0375 = 0.5375$。因为 $0  0.5375  1$，所以 $f_{\\mathrm{SIE}} = 0.5375$。\n  - $D$: 因为 $0  f_{\\mathrm{SIE}}  1$，所以 $D=\\mathrm{True}$。\n  - 结果：$[0.537500, 1.000000, True]$\n\n- **用例 3：$(\\beta, k) = (0.45, 0.40)$**\n  - $f_{\\mathrm{exact}}$: 因为 $\\beta=0.45 > 0$，所以 $f_{\\mathrm{exact}} = 0$。\n  - $f_{\\mathrm{SIE}}$: $k=0.40 > 0$ 但 $|\\beta|=0.45 > k=0.40$。$f_{unc} = 0.5 - 0.45 / (2 \\times 0.40) = 0.5 - 0.5625 = -0.0625$。因为 $f_{unc}  0$，所以 $f_{\\mathrm{SIE}} = 0$。\n  - $D$: 因为 $f_{\\mathrm{SIE}}$ 不是分数，所以 $D=\\mathrm{False}$。\n  - 结果：$[0.000000, 0.000000, False]$\n\n- **用例 4：$(\\beta, k) = (0.00, 0.25)$**\n  - $f_{\\mathrm{exact}}$: 因为 $\\beta=0$，所以根据约定 $f_{\\mathrm{exact}} = 0$。\n  - $f_{\\mathrm{SIE}}$: $k=0.25 > 0$ 且 $|\\beta|=0.00  k=0.25$。$f_{unc} = 0.5 - 0 / (2 \\times 0.25) = 0.5$。因为 $0  0.5  1$，所以 $f_{\\mathrm{SIE}} = 0.5$。\n  - $D$: 因为 $0  f_{\\mathrm{SIE}}  1$，所以 $D=\\mathrm{True}$。\n  - 结果：$[0.500000, 0.000000, True]$\n\n这些结果与所提供的 Python 脚本的输出相匹配，证实了该解决方案是正确的。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates properties of a two-site charge model to demonstrate\n    self-interaction error in DFT.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple (beta, k) in eV.\n    test_cases = [\n        (0.02, 0.40),\n        (-0.03, 0.40),\n        (0.45, 0.40),\n        (0.00, 0.25),\n    ]\n\n    processed_results = []\n    for beta, k in test_cases:\n        # 1. Calculate f_exact, the minimizer for the exact (piecewise-linear) model.\n        # This represents the charge-localized solution.\n        if beta > 0:\n            f_exact = 0.0\n        elif beta  0:\n            f_exact = 1.0\n        else:  # beta == 0\n            # By convention specified in the problem\n            f_exact = 0.0\n\n        # 2. Calculate f_SIE, the minimizer for the SIE-affected model.\n        # This models how SIE can spuriously stabilize delocalized states.\n        f_sie = 0.0  # Initialize\n        # The parameter k must be non-negative.\n        if k > 0:\n            # The unconstrained minimum of the quadratic energy function.\n            f_unc = 0.5 - beta / (2.0 * k)\n            # The minimum over the interval [0, 1] is the clipped value.\n            f_sie = np.clip(f_unc, 0.0, 1.0)\n        elif k == 0:\n            # If k=0, the SIE model is identical to the exact model.\n            f_sie = f_exact\n        else:\n            # k  0 is not allowed by the problem statement (k >= 0).\n            # This case is included for robustness.\n            # The function would be concave, minimizer is always at a boundary.\n            if beta > 0:\n                f_sie = 0.0\n            else:\n                f_sie = 1.0\n\n        # 3. Calculate the boolean indicator D.\n        # D is True iff the SIE model predicts a strictly fractional charge\n        # (0  f_SIE  1), which indicates artificial delocalization.\n        # This occurs precisely when the unconstrained minimum is inside the\n        # (0, 1) interval, which corresponds to |beta|  k for k > 0.\n        # This analytical condition is robust against floating-point inaccuracies.\n        D = (k > 0) and (abs(beta)  k)\n\n        # Append the formatted result string for the current test case.\n        # The f-string format specifier ':.6f' ensures 6 decimal places.\n        processed_results.append(\n            f\"[{f_sie:.6f},{f_exact:.6f},{D}]\"\n        )\n\n    # Final print statement in the exact required format.\n    # The list of result strings is joined by commas and enclosed in brackets.\n    print(f\"[{','.join(processed_results)}]\")\n\nsolve()\n```", "id": "2461989"}, {"introduction": "在理论模型和实际计算之间架起桥梁至关重要。在实践中，自相互作用误差会以可观测到的差异形式出现，例如在密度泛函理论中，基于轨道能的“库普曼斯定理”的失效。这个练习模拟了一个常见的计算化学场景：通过轨道能量计算出的电离能与更可靠的 $\\Delta$SCF 方法得到的结果不一致。你的任务是运用你对 SIE 的理解来诊断这种差异的根本原因，从而锻炼你解读计算结果并识别近似泛函局限性的能力。[@problem_id:2461991]", "problem": "一名学生在 Kohn–Sham 密度泛函理论 (KS-DFT) 框架内，使用半局域广义梯度近似 (GGA) 计算氩的第一垂直电离能。在固定的中性原子几何结构下获得了两个值：Delta 自洽场 ($\\Delta$SCF) 差值 $I_{\\Delta} = E(\\mathrm{Ar}^+) - E(\\mathrm{Ar})$，以及中性原子的最高占据 Kohn–Sham 轨道本征值的负值 $I_{\\epsilon} = -\\epsilon_{\\mathrm{HOMO}}(\\mathrm{Ar})$。该学生发现 $I_{\\epsilon}  I_{\\Delta}$。假设为自旋限制、充分收敛的基态，基组误差可忽略，且无相对论或振动效应。\n\n哪个选项最能解释这种差异并提出减少差异的改进方法？\n\nA. 近似的半局域泛函存在自相互作用误差 (SIE)，这使得 $E(N)$ 在整数之间是凸函数，并导致交换相关势的渐进行为衰减过快。这将 $\\epsilon_{\\mathrm{HOMO}}$ 向上推高（使其负值更小），因此 $I_{\\epsilon}$ 低估了电离能，而 $I_{\\Delta}$ 受益于部分误差抵消。使用自相互作用校正的或范围分离的杂化泛函将减少这种差异。\n\nB. 这种差异源于氩中的强静态相关；需要多参考方法来描述 $\\mathrm{Ar}$，而 Hartree–Fock 会使 $I_{\\epsilon}$ 恶化，因为它增加了静态相关。\n\nC. 即使对于精确泛函，Kohn–Sham 本征值也没有物理意义，因此 $-\\epsilon_{\\mathrm{HOMO}}$ 不应等于电离能；任何密度泛函都无法解决这个问题。\n\nD. 误差的出现是因为 $I_{\\Delta}$ 中忽略了轨道弛豫，而 $I_{\\epsilon}$ 中包含了轨道弛豫；因此 $I_{\\Delta}$ 系统性地过小。使用符合 Koopmans 定理的 Hartree–Fock 方法将使 $-\\epsilon_{\\mathrm{HOMO}}$ 变得精确。\n\nE. 对于任何局域或半局域泛函，Janak 定理精确地保证了 $-\\epsilon_{\\mathrm{HOMO}} = E(N-1)-E(N)$，因此这种差异必定是数值噪音。", "solution": "该问题要求解释一个现象：在密度泛函理论 (DFT) 中使用半局域 GGA 泛函时，根据最高占据分子轨道 (HOMO) 本征值的负值计算出的氩的电离能 $I_{\\epsilon} = -\\epsilon_{\\mathrm{HOMO}}(\\mathrm{Ar})$，小于根据总能量差计算出的电离能 $I_{\\Delta} = E(\\mathrm{Ar}^+) - E(\\mathrm{Ar})$。\n\n首先，让我们分析这两个量作为真实第一电离能 $I$ 的近似的理论基础。\n\nKohn-Sham DFT 中的总能量 $E$ 是电子密度 $\\rho$ 的泛函，而电子密度又是由 Kohn-Sham 轨道 $\\{\\phi_i\\}$ 构建的。一个 $N$ 电子系统的总能量是 $E[N]$。$\\Delta$SCF 方法将电离能计算为 $(N-1)$ 电子系统和 $N$ 电子系统的总能量之间的有限差分：\n$$I_{\\Delta} = E(N-1) - E(N)$$\n在这个具体问题中，$N$ 对应于中性氩原子 $\\mathrm{Ar}$，而 $N-1$ 对应于其阳离子 $\\mathrm{Ar}^+$。能量 $E(\\mathrm{Ar})$ 和 $E(\\mathrm{Ar}^+)$ 是通过两个独立的、完全自洽的计算获得的。这个过程明确地考虑了在移除一个电子时电子结构的弛豫（即轨道和密度的变化）。\n\n第二个量 $I_{\\epsilon}$ 是基于最高占据 Kohn-Sham 轨道的能量 $\\epsilon_{\\mathrm{HOMO}}$。轨道本征值和能量导数之间的关系由 Janak 定理给出：\n$$ \\epsilon_{i} = \\frac{\\partial E}{\\partial n_{i}} $$\n其中 $n_i$ 是第 $i$ 个 Kohn-Sham 轨道的占据数。对于 HOMO，这便是 $\\epsilon_{\\mathrm{HOMO}} = \\frac{\\partial E}{\\partial n_{\\mathrm{HOMO}}}$。\n\n对于*精确*密度泛函，可以证明总能量 $E$ 作为电子数 $N$ 的函数，必须是一系列连接整数 $N$ 值的点的直线段。此性质被称为分段线性。对于具有此性质的函数，两个整数之间的导数是常数，等于连接它们的线段的斜率。因此，对于精确泛函：\n$$ \\epsilon_{\\mathrm{HOMO}}^{\\text{exact}} = \\frac{\\partial E_{\\text{exact}}}{\\partial n_{\\mathrm{HOMO}}} \\bigg|_{N} = E_{\\text{exact}}(N-1) - E_{\\text{exact}}(N) = -I^{\\text{exact}} $$\n这就是 DFT 的电离势定理。它指出，对于精确泛函，HOMO 本征值的负值恰好等于第一电离能。\n\n然而，该问题指定使用半局域 GGA 泛函。这类近似泛函（包括 LDA 和 GGA）存在**自相互作用误差 (SIE)**。一个电子会错误地与其自身的密度相互作用，因为近似的交换泛函未能完全抵消经典库仑（Hartree）能量中虚假的自相互作用部分。SIE 的一个主要后果是能量泛函偏离了分段线性。对于近似泛函，能量 $E(N)$ 作为连续粒子数 $N$ 的函数，是虚假地**凸函数**。\n\n对于一个凸函数，其在一点的导数（切线斜率）小于从该点到左边整数点的弦的斜率。用数学语言表述，对于整数 $N_{int}$：\n$$ \\frac{dE}{dN}\\bigg|_{N=N_{int}^-}  \\frac{E(N_{int}) - E(N_{int}-1)}{(N_{int}) - (N_{int}-1)} $$\n将此应用于我们的问题，将 $\\epsilon_{\\mathrm{HOMO}}$ 等同于左导数，将 $-I_{\\Delta}$ 等同于有限差分，我们得到：\n$$ \\epsilon_{\\mathrm{HOMO}} = \\frac{\\partial E}{\\partial N} \\bigg|_{N^-}  E(N) - E(N-1) = -I_{\\Delta} $$\n两边乘以 $-1$ 会反转不等号：\n$$ -\\epsilon_{\\mathrm{HOMO}} > I_{\\Delta} $$\n这与学生的发现 ($I_{\\epsilon}  I_{\\Delta}$) 相反。让我们更仔细地审视凸性的定义和 Janak 定理的应用。正确的分析如下：由于 SIE，能量 $E(N_f)$ 对分数电子数 $N_f$ 的曲线是凸的（向下弯曲）。根据凸函数的性质，在点 $N$ 处的切线斜率 $\\left. \\frac{\\partial E}{\\partial N_f} \\right|_{N_f \\to N^-}$ 小于连接点 $(N-1, E(N-1))$ 和 $(N, E(N))$ 的弦的斜率，即 $E(N) - E(N-1)$。\n因此， $\\epsilon_{\\mathrm{HOMO}} = \\left. \\frac{\\partial E}{\\partial N_f} \\right|_{N^-}  E(N) - E(N-1) = -I_{\\Delta}$。\n两边乘以 $-1$ 可得：\n$$ -\\epsilon_{\\mathrm{HOMO}} > I_{\\Delta} $$\n这仍然与观察结果相悖。让我们重新思考一下。\n\n正确的凸性论证是 $E(N_f)$ 向下弯曲，即 $\\frac{\\partial^2 E}{\\partial N_f^2} > 0$。根据中值定理，连接 $(N-1, E(N-1))$ 和 $(N, E(N))$ 的弦的斜率 $E(N) - E(N-1)$ 等于区间 $(N-1, N)$ 中某一点 $c$ 的导数 $\\frac{\\partial E}{\\partial N_f} \\vert_{c}$。由于导数是单调递增的，所以 $\\frac{\\partial E}{\\partial N_f} \\vert_{N-1}  E(N) - E(N-1)  \\frac{\\partial E}{\\partial N_f} \\vert_{N}$。\n根据 Janak 定理，$\\epsilon_{\\mathrm{HOMO}} = \\frac{\\partial E}{\\partial N_f} \\vert_N$ (更准确地说是左导数)。因此，$\\epsilon_{\\mathrm{HOMO}} > E(N) - E(N-1) = -I_{\\Delta}$。\n两边取负号，得到 $-\\epsilon_{\\mathrm{HOMO}}  I_{\\Delta}$，即 $I_{\\epsilon}  I_{\\Delta}$。这与学生的观察结果一致。\n\nSIE 的另一个后果是，相应的交换相关势 $v_{xc}(\\mathbf{r})$ 在大距离处（$|\\mathbf{r}| \\to \\infty$）衰减过快。精确势应以 $-1/r$ 的形式衰减，但对于 GGA 泛函，它是指数衰减的。这意味着远离原子核的势阱太浅，所以最外层的电子（在 HOMO 中）束缚得不够紧。因此，其能量本征值 $\\epsilon_{\\mathrm{HOMO}}$ 被向上推高，成为一个负值更小的值。因此，$I_{\\epsilon} = -\\epsilon_{\\mathrm{HOMO}}$ 低估了真实的电离能。\n\n$\\Delta$SCF 计算 $I_{\\Delta} = E(\\mathrm{Ar}^+) - E(\\mathrm{Ar})$ 在两个总能量计算中都包含 SIE。然而，在取差值时，这种误差有显著的抵消，这就是为什么 $I_{\\Delta}$ 通常比 $I_{\\epsilon}$ 是对真实电离能好得多的近似。\n\n为了修正这一点，必须使用能减轻 SIE 的泛函。\n- **自相互作用校正 (SIC)** 方法逐个轨道地明确减去自相互作用能。\n- **杂化泛函** 混合了一定比例的精确 Hartree-Fock 交换，根据定义，Hartree-Fock 交换没有自相互作用。这部分地校正了凸性误差。\n- **范围分离杂化 (RSH) 泛函** 是一种更高级的杂化形式。它们在长程使用 100% 的精确交换，这正确地恢复了交换势的 $-1/r$ 渐进行为。这极大地提高了 $\\epsilon_{\\mathrm{HOMO}}$ 作为电离能估计的质量，使 $I_{\\epsilon}$ 更接近 $I_{\\Delta}$ 和实验值。\n\n现在，我们评估给出的选项：\n\n**A. 近似的半局域泛函存在自相互作用误差 (SIE)，这使得 $E(N)$ 在整数之间是凸函数，并导致交换相关势的渐进行为衰减过快。这将 $\\epsilon_{\\mathrm{HOMO}}$ 向上推高（使其负值更小），因此 $I_{\\epsilon}$ 低估了电离能，而 $I_{\\Delta}$ 受益于部分误差抵消。使用自相互作用校正的或范围分离的杂化泛函将减少这种差异。**\n这一陈述是对问题的完整且正确的诊断。它正确地指出了 SIE 是原因，正确地描述了其主要后果（$E(N)$ 的凸性、不正确的势衰减），正确地将这些与观察到的不等式 ($I_{\\epsilon}  I_{\\Delta}$) 联系起来，并正确地给出了标准的、有效的补救措施。\n结论：**正确**。\n\n**B. 这种差异源于氩中的强静态相关；需要多参考方法来描述 $\\mathrm{Ar}$，而 Hartree–Fock 会使 $I_{\\epsilon}$ 恶化，因为它增加了静态相关。**\n这一陈述是不正确的。氩是一个闭壳层稀有气体原子，具有大的 HOMO-LUMO 能隙。它是以动态相关为主的系统的典型例子，对于这类系统，单参考方法非常适用。所描述的问题是近似泛函的失败，而不是氩原子电子结构需要多参考处理的特性。Hartree-Fock 缺乏动态相关；将其与“增加静态相关”联系起来是混淆不清的。\n结论：**不正确**。\n\n**C. 即使对于精确泛函，Kohn–Sham 本征值也没有物理意义，因此 $-\\epsilon_{\\mathrm{HOMO}}$ 不应等于电离能；任何密度泛函都无法解决这个问题。**\n这一陈述根本上是错误的。电离势定理证明，对于精确泛函，$-\\epsilon_{\\mathrm{HOMO}}$ 精确等于第一电离能。问题在于近似泛函。更好地逼近精确泛函的泛函（例如范围分离杂化泛函）确实在很大程度上“解决”了这个问题，使 $-\\epsilon_{\\mathrm{HOMO}}$ 成为电离能的更精确近似。\n结论：**不正确**。\n\n**D. 误差的出现是因为 $I_{\\Delta}$ 中忽略了轨道弛豫，而 $I_{\\epsilon}$ 中包含了轨道弛豫；因此 $I_{\\Delta}$ 系统性地过小。使用符合 Koopmans 定理的 Hartree–Fock 方法将使 $-\\epsilon_{\\mathrm{HOMO}}$ 变得精确。**\n这一陈述颠倒了轨道弛豫的作用。$\\Delta$SCF 方法 $I_{\\Delta} = E(N-1) - E(N)$ 完全包含了轨道弛豫，因为 $(N-1)$ 电子系统是经过变分优化的。相比之下，将 $I_{\\epsilon} = -\\epsilon_{\\mathrm{HOMO}}$ 解释为电离能（类似于 Koopmans 定理）则隐含地使用了 $N$ 电子系统的“冻结”轨道，因此*忽略*了轨道弛豫。此外，Hartree-Fock 计算得到的 $-\\epsilon_{\\mathrm{HOMO}}$ 也不是精确的电离能；它是 Koopmans 定理下的一个近似，该定理系统性地忽略了电子相关和轨道弛豫。\n结论：**不正确**。\n\n**E. 对于任何局域或半局域泛函，Janak 定理精确地保证了 $-\\epsilon_{\\mathrm{HOMO}} = E(N-1)-E(N)$，因此这种差异必定是数值噪音。**\n这是对 Janak 定理的误解。该定理将本征值与能量对占据数的*导数* ($\\epsilon_i = \\partial E / \\partial n_i$) 联系起来，而不是与*有限差分* ($E(N-1) - E(N)$) 联系起来。这两个量仅当能量函数是线性的情况下才相等，而由于 SIE，近似泛函的情况并非如此。这种差异是泛函的系统误差，而不是数值噪音。\n结论：**不正确**。\n\n基于此分析，选项 A 是唯一提供科学上合理且完整解释的选项。", "answer": "$$\\boxed{A}$$", "id": "2461991"}]}