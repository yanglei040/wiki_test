{"hands_on_practices": [{"introduction": "理解多极矩始于其定义。本练习为一个最简单但最重要的非偶极系统——线性四极子——提供了一个基础的、亲自动手的计算。通过直接应用无迹四极矩张量的公式，并对电势进行泰勒展开 [@problem_id:2770895]，您将在抽象的张量表示与其产生的物理远场电势之间建立起坚实的联系。", "problem": "在纳米尺度的表面-探针相互作用中，一个对局域、电中性、镜像对称电荷分布的常见理想化模型是与表面法线对齐的线性四极子。考虑三个点电荷，它们被限制在 $z$ 轴上，分别位于位置 $z=-a$、$z=0$ 和 $z=+a$ 处，电荷量分别为 $+q$、$-2q$ 和 $+q$。原点位于 $z=0$ 处。在表面与界面科学中，这种排列近似了某些针尖-样品配置的主导静电多极矩。\n\n使用无迹笛卡尔四极张量的定义\n$$\nQ_{ij} \\equiv \\sum_{\\alpha} q_{\\alpha} \\left( 3 x_{\\alpha i} x_{\\alpha j} - r_{\\alpha}^{2} \\delta_{ij} \\right),\n$$\n其中求和遍历由 $\\alpha$ 索引的点电荷，其位置为 $\\boldsymbol{r}_{\\alpha}=(x_{\\alpha},y_{\\alpha},z_{\\alpha})$，$\\delta_{ij}$ 是克罗内克 delta 符号。请完成以下操作：\n\n1. 计算该电荷分布下 $Q_{ij}$ 的所有非零分量。\n\n2. 从库仑势出发\n$$\n\\Phi(\\boldsymbol{r}) = \\frac{1}{4 \\pi \\varepsilon_{0}} \\sum_{\\alpha} \\frac{q_{\\alpha}}{|\\boldsymbol{r}-\\boldsymbol{r}_{\\alpha}|},\n$$\n在渐近区域 $|z| \\gg a$ 中，对精确的轴上势 $\\Phi(0,0,z)$ 进行系统性的多极展开，以确定主导的非零项。将主导的轴上势表示为 $z$、$q$、$a$ 和 $\\varepsilon_{0}$ 的函数。\n\n答案规格：\n- 提供主导轴上势 $\\Phi(z)$ 的单个闭合形式解析表达式作为最终答案，该表达式在 $|z| \\gg a$ 时有效。\n- 最终答案中不要包含中间结果。\n- 以伏特为单位表示最终的电势。\n- 无需四舍五入；提供一个精确的符号表达式。", "solution": "我们从给定的三个点电荷开始，它们分别位于 $\\boldsymbol{r}_{1}=(0,0,-a)$（电荷量 $+q$）、$\\boldsymbol{r}_{2}=(0,0,0)$（电荷量 $-2q$）和 $\\boldsymbol{r}_{3}=(0,0,+a)$（电荷量 $+q$）。净电荷为\n$$\n\\sum_{\\alpha} q_{\\alpha} = q-2q+q = 0,\n$$\n因此单极矩为零。偶极矩 $\\boldsymbol{p}=\\sum_{\\alpha} q_{\\alpha} \\boldsymbol{r}_{\\alpha}$ 也因对称性而为零，因为在 $z=\\pm a$ 处的贡献相互抵消，且中心电荷位于原点：\n$$\n\\boldsymbol{p} = q(0,0,-a) + (-2q)(0,0,0) + q(0,0,a) = \\boldsymbol{0}.\n$$\n因此，远场多极展开中的主导非零项是四极项。\n\n第 $1$ 部分：计算 $Q_{ij}$。使用定义\n$$\nQ_{ij} = \\sum_{\\alpha} q_{\\alpha} \\left( 3 x_{\\alpha i} x_{\\alpha j} - r_{\\alpha}^{2} \\delta_{ij} \\right),\n$$\n我们注意到所有电荷都位于 $z$ 轴上，因此对于每个电荷 $\\alpha$，我们有 $x_{\\alpha}=0$，$y_{\\alpha}=0$，以及 $z_{\\alpha} \\in \\{-a,0,a\\}$，且 $r_{\\alpha}^{2} = z_{\\alpha}^{2}$。因此：\n- 对于 $i=j=x$，\n$$\nQ_{xx} = \\sum_{\\alpha} q_{\\alpha} \\left( 3 x_{\\alpha}^{2} - r_{\\alpha}^{2} \\right) = \\sum_{\\alpha} q_{\\alpha} \\left( 0 - z_{\\alpha}^{2} \\right) = - \\sum_{\\alpha} q_{\\alpha} z_{\\alpha}^{2}.\n$$\n- 对于 $i=j=y$，\n$$\nQ_{yy} = \\sum_{\\alpha} q_{\\alpha} \\left( 3 y_{\\alpha}^{2} - r_{\\alpha}^{2} \\right) = \\sum_{\\alpha} q_{\\alpha} \\left( 0 - z_{\\alpha}^{2} \\right) = - \\sum_{\\alpha} q_{\\alpha} z_{\\alpha}^{2}.\n$$\n- 对于 $i=j=z$，\n$$\nQ_{zz} = \\sum_{\\alpha} q_{\\alpha} \\left( 3 z_{\\alpha}^{2} - r_{\\alpha}^{2} \\right) = \\sum_{\\alpha} q_{\\alpha} \\left( 3 z_{\\alpha}^{2} - z_{\\alpha}^{2} \\right) = \\sum_{\\alpha} q_{\\alpha} \\left( 2 z_{\\alpha}^{2} \\right) = 2 \\sum_{\\alpha} q_{\\alpha} z_{\\alpha}^{2}.\n$$\n- 对于 $i \\neq j$，每一项都包含一个因子 $x_{\\alpha i} x_{\\alpha j}$，其中至少有一个 $x_{\\alpha}$ 或 $y_{\\alpha}$，这些都为零，因此当 $i \\neq j$ 时 $Q_{ij}=0$。\n\n现在计算 $\\sum_{\\alpha} q_{\\alpha} z_{\\alpha}^{2}$：\n$$\n\\sum_{\\alpha} q_{\\alpha} z_{\\alpha}^{2} = q a^{2} + (-2q) \\cdot 0^{2} + q a^{2} = 2 q a^{2}.\n$$\n因此，\n$$\nQ_{xx} = - 2 q a^{2}, \\quad Q_{yy} = - 2 q a^{2}, \\quad Q_{zz} = 2 \\times (2 q a^{2}) = 4 q a^{2},\n$$\n且当 $i \\neq j$ 时 $Q_{ij}=0$。作为检验，该张量是无迹的：$Q_{xx}+Q_{yy}+Q_{zz} = -2 q a^{2} - 2 q a^{2} + 4 q a^{2} = 0$。\n\n第 $2$ 部分：主导轴上势。在 $(0,0,z)$ 处的精确轴上势为\n$$\n\\Phi(0,0,z) = \\frac{1}{4 \\pi \\varepsilon_{0}} \\left( \\frac{q}{|z+a|} - \\frac{2q}{|z|} + \\frac{q}{|z-a|} \\right).\n$$\n在渐近区域 $|z| \\gg a$ 中，我们可以将各项按 $a/z$ 的幂次展开。为了明确起见并避免级数中绝对值的复杂性，我们考虑 $za0$；我们得到的渐近形式将仅通过 $z^{3}$ 依赖于 $|z|$，因此对 $|z| \\gg a$ 均有效：\n$$\n\\frac{1}{z \\pm a} = \\frac{1}{z} \\frac{1}{1 \\pm a/z} = \\frac{1}{z} \\left( 1 \\mp \\frac{a}{z} + \\left( \\frac{a}{z} \\right)^{2} \\mp \\left( \\frac{a}{z} \\right)^{3} + \\cdots \\right).\n$$\n因此，\n\\begin{align*}\n\\frac{q}{z+a} - \\frac{2q}{z} + \\frac{q}{z-a}\n= \\frac{q}{z} \\left[ \\left( 1 - \\frac{a}{z} + \\left( \\frac{a}{z} \\right)^{2} - \\left( \\frac{a}{z} \\right)^{3} + \\cdots \\right) - 2 + \\left( 1 + \\frac{a}{z} + \\left( \\frac{a}{z} \\right)^{2} + \\left( \\frac{a}{z} \\right)^{3} + \\cdots \\right) \\right] \\\\\n= \\frac{q}{z} \\left[ (1-2+1) + \\left( -\\frac{a}{z} + \\frac{a}{z} \\right) + \\left( \\frac{a^{2}}{z^{2}} + \\frac{a^{2}}{z^{2}} \\right) + \\left( - \\frac{a^{3}}{z^{3}} + \\frac{a^{3}}{z^{3}} \\right) + \\cdots \\right] \\\\\n= \\frac{q}{z} \\left[ 0 + 0 + \\frac{2 a^{2}}{z^{2}} + 0 + \\cdots \\right] \\\\\n= \\frac{2 q a^{2}}{z^{3}} + \\mathcal{O}\\!\\left( \\frac{a^{4}}{z^{5}} \\right).\n\\end{align*}\n因此，远场轴上势的主导非零项是\n$$\n\\Phi(z) \\sim \\frac{1}{4 \\pi \\varepsilon_{0}} \\cdot \\frac{2 q a^{2}}{z^{3}} = \\frac{q a^{2}}{2 \\pi \\varepsilon_{0} z^{3}} \\quad \\text{for} \\quad |z| \\gg a.\n$$\n这个结果与上面求得的四极张量是一致的。使用与此处所用无迹笛卡尔定义相关的标准四极矩对远场势的贡献，\n$$\n\\Phi(\\boldsymbol{r}) = \\frac{1}{8 \\pi \\varepsilon_{0}} \\frac{Q_{ij} n_{i} n_{j}}{r^{3}} + \\cdots,\n$$\n其中 $\\boldsymbol{n}=\\boldsymbol{r}/r$，在 $z$ 轴上，我们有 $n_{z}=1$ 和 $n_{x}=n_{y}=0$，因此 $Q_{ij} n_{i} n_{j} = Q_{zz} = 4 q a^{2}$，得到\n$$\n\\Phi(z) \\sim \\frac{1}{8 \\pi \\varepsilon_{0}} \\frac{4 q a^{2}}{z^{3}} = \\frac{q a^{2}}{2 \\pi \\varepsilon_{0} z^{3}},\n$$\n与直接级数展开的结果一致。\n\n因此，远场中的主导轴上势是解析表达式\n$$\n\\Phi(z) = \\frac{q a^{2}}{2 \\pi \\varepsilon_{0} z^{3}} \\quad \\text{for} \\quad |z| \\gg a,\n$$\n当 $q$ 的单位是库仑，$a$ 和 $z$ 的单位是米，$\\varepsilon_{0}$ 的单位是法拉每米时，该表达式的单位是伏特。", "answer": "$$\\boxed{\\frac{q a^{2}}{2 \\pi \\varepsilon_{0} z^{3}}}$$", "id": "2770895"}, {"introduction": "虽然解析模型具有启发性，但真实世界的分子需要计算方法来处理。本练习将指导您为一个对称的平面分子——三氟化硼 ($\\text{BF}_3$)——实现四极矩张量的计算 [@problem_id:2455134]。您不仅将计算该张量，还将探索其基本性质，如其本征值及其在旋转下的不变性，从而深入了解分子对称性如何决定其静电特性。", "problem": "考虑平面分子三氟化硼 ($\\text{BF}_3$) 的点电荷模型。设硼原子核位于原点，三个氟原子核排列在 $xy$ 平面内，与原点的距离均为 $R$，相对于 $x$ 轴正方向的极角分别为 $0$、$\\frac{2\\pi}{3}$ 和 $\\frac{4\\pi}{3}$。为硼分配 $+1.0$ 元电荷的部分电荷，为每个氟分配 $-\\frac{1}{3}$ 元电荷的部分电荷，以使总电荷为零。位置以埃为单位，电荷以元电荷为单位。此处，静电四极矩张量的笛卡尔分量定义为无迹张量\n$$\nQ_{ij} \\;=\\; \\sum_{a=1}^{N} q_a \\left( 3\\, r_{a,i}\\, r_{a,j} \\;-\\; r_a^2\\, \\delta_{ij} \\right),\n$$\n其中 $q_a$ 是位置 $a$ 的电荷，$\\mathbf{r}_a = (r_{a,x}, r_{a,y}, r_{a,z})$ 是其相对于原点的位置矢量，$r_a^2 = r_{a,x}^2 + r_{a,y}^2 + r_{a,z}^2$，$\\delta_{ij}$ 是克罗内克 δ。四极矩张量的主轴和特征值被定义为对称矩阵 $Q$ 的特征矢量和特征值。\n\n定义旋转矩阵\n$$\nR(\\alpha,\\beta,\\gamma) \\;=\\; R_z(\\gamma)\\, R_y(\\beta)\\, R_x(\\alpha),\n$$\n其中\n$$\nR_x(\\alpha)=\\begin{pmatrix}100\\\\0\\cos\\alpha-\\sin\\alpha\\\\0\\sin\\alpha\\cos\\alpha\\end{pmatrix},\\quad\nR_y(\\beta)=\\begin{pmatrix}\\cos\\beta0\\sin\\beta\\\\010\\\\-\\sin\\beta0\\cos\\beta\\end{pmatrix},\\quad\nR_z(\\gamma)=\\begin{pmatrix}\\cos\\gamma-\\sin\\gamma0\\\\\\sin\\gamma\\cos\\gamma0\\\\001\\end{pmatrix},\n$$\n并在指定时将其应用于所有位置矢量以获得旋转后的几何构型。所有角度均以弧度为单位。\n\n对于以下四个测试用例中的每一个，使用上述定义从第一性原理计算四极矩张量 $Q$，并确定其特征值。对于每个用例，按升序报告三个特征值（实数）。以“元电荷乘以埃的平方”为单位表示特征值。打印每个特征值时，四舍五入到小数点后六位。不要打印单位。\n\n测试组：\n- 用例1（一般平面几何构型）：$R = 1.30$；无旋转。\n- 用例2（旋转下的不变性）：$R = 1.30$；应用旋转 $R(\\alpha,\\beta,\\gamma)$，其中 $\\alpha = 0.7$，$\\beta = 1.1$，$\\gamma = 2.0$。\n- 用例3（随距离的缩放）：$R = 2.00$；无旋转。\n- 用例4（边界/简并情况）：$R = 0.00$；无旋转。\n\n您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表。列表中的每个条目是对应一个用例的三个排序后特征值的列表，并按上述用例的顺序排列。例如，输出格式必须为\n$[\\,[e_{1,1},e_{1,2},e_{1,3}],[e_{2,1},e_{2,2},e_{2,3}],[e_{3,1},e_{3,2},e_{3,3}],[e_{4,1},e_{4,2},e_{4,3}]\\,]$,\n其中每个 $e_{k,j}$ 均写为四舍五入到小数点后六位的小数。", "solution": "我们从无迹笛卡尔四极矩张量的定义开始，\n$$\nQ_{ij} \\;=\\; \\sum_{a=1}^{N} q_a \\left( 3\\, r_{a,i}\\, r_{a,j} \\;-\\; r_a^2\\, \\delta_{ij} \\right).\n$$\n对于处于指定平面几何构型的 $\\text{BF}_3$，将电荷为 $q_\\mathrm{B} = +1.0$ 的硼置于 $\\mathbf{r}_\\mathrm{B} = (0,0,0)$，三个氟原子置于\n$$\n\\mathbf{r}_{\\mathrm{F},1} = \\bigl(R,\\,0,\\,0\\bigr),\\quad\n\\mathbf{r}_{\\mathrm{F},2} = \\bigl(R\\cos\\tfrac{2\\pi}{3},\\,R\\sin\\tfrac{2\\pi}{3},\\,0\\bigr) = \\bigl(-\\tfrac{R}{2},\\,\\tfrac{\\sqrt{3}R}{2},\\,0\\bigr),\\quad\n\\mathbf{r}_{\\mathrm{F},3} = \\bigl(R\\cos\\tfrac{4\\pi}{3},\\,R\\sin\\tfrac{4\\pi}{3},\\,0\\bigr) = \\bigl(-\\tfrac{R}{2},\\,-\\tfrac{\\sqrt{3}R}{2},\\,0\\bigr),\n$$\n每个氟原子的电荷为 $q_\\mathrm{F} = -\\tfrac{1}{3}$。因为 $\\mathbf{r}_\\mathrm{B} = \\mathbf{0}$，所以对于所有分量 $i,j$，硼对 $Q_{ij}$ 的贡献为零。因此，整个四极矩张量都源于三个氟的电荷。\n\n对于 $xy$ 平面内极角为 $\\theta$、半径为 $R$ 的单个氟原子，其位置为 $\\mathbf{r} = (R\\cos\\theta, R\\sin\\theta, 0)$，其贡献为\n$$\nq_\\mathrm{F}\\begin{pmatrix}\n3R^2\\cos^2\\theta - R^2   3R^2\\cos\\theta\\sin\\theta   0\\\\\n3R^2\\cos\\theta\\sin\\theta   3R^2\\sin^2\\theta - R^2   0\\\\\n0   0   -R^2\n\\end{pmatrix}.\n$$\n对 $\\theta \\in \\{0, \\tfrac{2\\pi}{3}, \\tfrac{4\\pi}{3}\\}$ 求和，得出\n$$\n\\sum_{\\mathrm{F}} \\left( 3\\cos^2\\theta - 1 \\right) = \\tfrac{3}{2},\\qquad\n\\sum_{\\mathrm{F}} \\left( 3\\sin^2\\theta - 1 \\right) = \\tfrac{3}{2},\\qquad\n\\sum_{\\mathrm{F}} \\left( 3\\cos\\theta\\sin\\theta \\right) = 0,\\qquad\n\\sum_{\\mathrm{F}} \\left( -1 \\right) = -3.\n$$\n因此，\n$$\nQ \\;=\\; q_\\mathrm{F} R^2 \\,\\mathrm{diag}\\!\\left(\\tfrac{3}{2},\\,\\tfrac{3}{2},\\,-3\\right)\n\\;=\\; \\left(-\\tfrac{1}{3}\\right) R^2 \\,\\mathrm{diag}\\!\\left(\\tfrac{3}{2},\\,\\tfrac{3}{2},\\,-3\\right)\n\\;=\\; \\mathrm{diag}\\!\\left(-\\tfrac{1}{2}R^2,\\,-\\tfrac{1}{2}R^2,\\,R^2\\right).\n$$\n在分子坐标系中，该张量已经是对角化的，其中 $z$ 轴垂直于分子平面。因此其特征值为\n$$\n\\lambda_1 \\;=\\; -\\tfrac{1}{2}R^2,\\quad \\lambda_2 \\;=\\; -\\tfrac{1}{2}R^2,\\quad \\lambda_3 \\;=\\; R^2,\n$$\n单位为元电荷乘以埃的平方。正如无迹张量定义所预期的，$\\lambda_1 + \\lambda_2 + \\lambda_3 = 0$。主轴是笛卡尔坐标轴，其中 $z$ 轴垂直于该平面，$x,y$ 轴位于平面内；平面内特征值是简并的。\n\n通过任何正交矩阵 $R(\\alpha,\\beta,\\gamma)$ 对整个电荷构型进行旋转，会使 $Q$ 映射为 $R Q R^\\top$。由于正交矩阵的相似变换保持特征值不变，因此在任何刚性旋转下，特征值都保持不变，尽管特征矢量（主轴）会相应地旋转。\n\n对于指定的测试用例：\n- 用例1：$R = 1.30 \\implies R^2 = 1.69$。按升序排列的特征值为 $[-0.845000,\\,-0.845000,\\,1.690000]$（四舍五入到六位小数后）。\n- 用例2：同样的 $R = 1.30$，但旋转了 $\\alpha = 0.7$，$\\beta = 1.1$，$\\gamma = 2.0$。特征值保持为 $[-0.845000,\\,-0.845000,\\,1.690000]$。\n- 用例3：$R = 2.00 \\implies R^2 = 4.00$。特征值为 $[-2.000000,\\,-2.000000,\\,4.000000]$。\n- 用例4：$R = 0.00 \\implies R^2 = 0.00$。所有特征值均为 $[0.000000,\\,0.000000,\\,0.000000]$。\n\n一个算法实现，如果它能构建坐标、应用任何指定的旋转 $R(\\alpha,\\beta,\\gamma)$、通过定义中的求和来组装 $Q$，并计算和排序特征值，那么它将重现这些结果。最终输出必须是单行文本，包含一个嵌套列表，其中按顺序包含每个用例的三个四舍五入后的特征值。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef rotation_matrix(alpha, beta, gamma):\n    \"\"\"\n    Construct R = Rz(gamma) * Ry(beta) * Rx(alpha)\n    Angles in radians.\n    \"\"\"\n    ca, sa = np.cos(alpha), np.sin(alpha)\n    cb, sb = np.cos(beta), np.sin(beta)\n    cg, sg = np.cos(gamma), np.sin(gamma)\n\n    Rx = np.array([[1.0, 0.0, 0.0],\n                   [0.0,  ca, -sa],\n                   [0.0,  sa,  ca]])\n    Ry = np.array([[ cb, 0.0,  sb],\n                   [0.0, 1.0, 0.0],\n                   [-sb, 0.0,  cb]])\n    Rz = np.array([[ cg, -sg, 0.0],\n                   [ sg,  cg, 0.0],\n                   [0.0, 0.0, 1.0]])\n    return Rz @ Ry @ Rx\n\ndef bf3_geometry(R):\n    \"\"\"\n    Construct BF3 positions for given bond length R (in angstrom).\n    B at origin, three F in xy-plane at angles 0, 120, 240 degrees.\n    Returns positions (N,3) and charges (N,).\n    \"\"\"\n    # Boron at origin\n    pos = [np.array([0.0, 0.0, 0.0])]\n    charges = [1.0]  # elementary charge\n\n    # Fluorine positions\n    angles = [0.0, 2.0*np.pi/3.0, 4.0*np.pi/3.0]\n    for th in angles:\n        x = R * np.cos(th)\n        y = R * np.sin(th)\n        z = 0.0\n        pos.append(np.array([x, y, z]))\n        charges.append(-1.0/3.0)  # each F\n    return np.vstack(pos), np.array(charges)\n\ndef quadrupole_tensor(positions, charges):\n    \"\"\"\n    Compute traceless Cartesian quadrupole tensor:\n    Q_ij = sum_a q_a (3 r_i r_j - r^2 delta_ij)\n    positions: (N,3), charges: (N,)\n    Returns Q (3,3)\n    \"\"\"\n    Q = np.zeros((3,3), dtype=float)\n    for r, q in zip(positions, charges):\n        r2 = float(np.dot(r, r))\n        rrT = np.outer(r, r)\n        Q += q * (3.0 * rrT - r2 * np.eye(3))\n    # Symmetrize to minimize numerical asymmetry\n    Q = 0.5 * (Q + Q.T)\n    return Q\n\ndef eigenvalues_sorted(Q):\n    \"\"\"\n    Compute sorted eigenvalues (ascending) of symmetric tensor Q.\n    \"\"\"\n    vals = np.linalg.eigvalsh(Q)\n    vals.sort()\n    return vals\n\ndef format_triplet(vals):\n    \"\"\"\n    Format three floats to exactly six decimals, no spaces.\n    \"\"\"\n    return \"[\" + \",\".join(f\"{v:.6f}\" for v in vals) + \"]\"\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (R, rotation_angles) where rotation_angles is None or (alpha,beta,gamma)\n    test_cases = [\n        (1.30, None),               # Case 1\n        (1.30, (0.7, 1.1, 2.0)),    # Case 2\n        (2.00, None),               # Case 3\n        (0.00, None),               # Case 4\n    ]\n\n    results_str = []\n    for R, eulers in test_cases:\n        pos, q = bf3_geometry(R)\n        if eulers is not None:\n            alpha, beta, gamma = eulers\n            Rmat = rotation_matrix(alpha, beta, gamma)\n            pos = (Rmat @ pos.T).T  # rotate each position vector\n        Q = quadrupole_tensor(pos, q)\n        eigs = eigenvalues_sorted(Q)\n        results_str.append(format_triplet(eigs))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results_str)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2455134"}, {"introduction": "多极展开在化学中的主要应用是高效地模拟分子间相互作用。本练习通过计算水二聚体的相互作用能，将理论付诸实践检验 [@problem_id:2455086]。至关重要的是，您将比较截断的多极展开能量与精确的库仑相互作用能，从而直接揭示该展开在电荷分布重叠的短距离下的局限性。这种比较对于理解多极模型的强大功能及其潜在缺陷至关重要。", "problem": "您将实现一个完整的程序，用于比较刚性水二聚体在短分离距离下，其静电相互作用能的截断多极展开与相同构型的参考相互作用能。比较必须在固定的分子内几何结构和一组定义如下的分子间构型下进行。水单体被建模为三个点电荷，使用以下刚性几何结构和参数。\n\n单个水单体在其局部坐标系中的几何结构和电荷：\n- 将氧原子置于原点，其笛卡尔坐标为 $\\left(0,0,0\\right)$，单位为埃（ångström）。\n- 将两个氢原子置于 $x$-$z$ 平面内，关于 $z$ 轴对称，键长为 $d_{\\mathrm{OH}} = 0.9572$ 埃，内角为 $\\angle\\text{HOH} = 104.52$ 度。因此，氢原子的坐标为\n$$\n\\mathbf{r}_{\\mathrm{H1}} = \\left( d_{\\mathrm{OH}}\\sin\\left(\\tfrac{\\theta}{2}\\right),\\, 0,\\, d_{\\mathrm{OH}}\\cos\\left(\\tfrac{\\theta}{2}\\right) \\right),\\quad\n\\mathbf{r}_{\\mathrm{H2}} = \\left( -d_{\\mathrm{OH}}\\sin\\left(\\tfrac{\\theta}{2}\\right),\\, 0,\\, d_{\\mathrm{OH}}\\cos\\left(\\tfrac{\\theta}{2}\\right) \\right),\n$$\n其中 $\\theta = 104.52$ 度。\n- 分别为氧和氢位点分配部分电荷（以基本电荷为单位）$q_{\\mathrm{O}} = -0.834$、$q_{\\mathrm{H1}} = +0.417$ 和 $q_{\\mathrm{H2}} = +0.417$。\n\n按如下方式构建水二聚体：\n- 单体 $\\mathrm{A}$ 按上述局部坐标系放置，其氧原子位于全局坐标系原点。\n- 单体 $\\mathrm{B}$ 是将相同的局部坐标系几何结构绕全局 $y$ 轴旋转一个角度 $\\beta$（单位为度），然后将其氧原子平移到点 $\\left(0,0,R\\right)$ 得到的，其中 $R$ 是氧-氧间距（单位为埃）。该旋转是主动旋转，并遵循关于 $y$ 轴的右手定则。\n\n定义单体 $\\mathrm{A}$ 和 $\\mathrm{B}$ 之间的分子间静电相互作用能如下：\n- 参考能量 $E_{\\mathrm{exact}}(R,\\beta)$ 是所有单体间电荷对之间的精确库仑对相互作用能，\n$$\nE_{\\mathrm{exact}}(R,\\beta) \\;=\\; N_{\\mathrm{A}}\\,k_{\\mathrm{e}}\\,e^2 \\sum_{a\\in \\mathrm{A}} \\sum_{b\\in \\mathrm{B}} \\frac{q_a\\,q_b}{\\left\\lVert \\mathbf{R} + \\mathbf{r}_b - \\mathbf{r}_a \\right\\rVert},\n$$\n其中 $\\mathbf{R}=\\left(0,0,R\\right)$ 是从 $\\mathrm{A}$ 的氧原子到 $\\mathrm{B}$ 的氧原子的向量，$\\mathbf{r}_a$ 和 $\\mathbf{r}_b$ 分别是电荷 $a$ 和 $b$ 相对于其各自单体氧原子的位置向量（单位为米），$k_{\\mathrm{e}} = 8.9875517923 \\times 10^9\\ \\text{N}\\cdot\\text{m}^2/\\text{C}^2$ 是库仑常数，$e = 1.602176634 \\times 10^{-19}\\ \\text{C}$ 是基本电荷，而 $N_{\\mathrm{A}} = 6.02214076 \\times 10^{23}\\ \\text{mol}^{-1}$ 是阿伏伽德罗常数。必须使用 $1\\ \\text{Å} = 1.0 \\times 10^{-10}\\ \\text{m}$ 将距离从埃转换为米。所得能量在乘以 $N_{\\mathrm{A}}$ 后，需除以 $10^{3}$，以千焦/摩尔为单位返回。\n- 截断至二阶的多极展开能量 $E_{\\mathrm{exp2}}(R,\\beta)$ 的定义是：将双重求和中的每个核 $1/\\left\\lVert \\mathbf{R} + \\mathbf{r}_b - \\mathbf{r}_a \\right\\rVert$ 替换为其在 $\\mathbf{R}$ 处关于位移 $\\boldsymbol{\\Delta}_{ab}=\\mathbf{r}_b-\\mathbf{r}_a$ 的泰勒展开，展开至并包括所有二次项，即用 $\\boldsymbol{\\Delta}_{ab}$ 分量中包含所有 $0$、$1$ 和 $2$ 阶项且与库仑核的泰勒级数匹配的唯一多项式来替换。使用与 $E_{\\mathrm{exact}}(R,\\beta)$ 相同的物理常数和单位转换，并以千焦/摩尔为单位返回能量。\n\n对于下面提供的每个测试用例 $(R,\\beta)$，计算有符号差值\n$$\n\\Delta E(R,\\beta) \\;=\\; E_{\\mathrm{exp2}}(R,\\beta) \\;-\\; E_{\\mathrm{exact}}(R,\\beta),\n$$\n单位为千焦/摩尔。\n\n在 $\\beta$ 的输入规范中，角度必须以度为单位处理，并在任何内部三角计算中转换为弧度。为几何结构和 $R$ 提供的所有距离都以埃为单位，并且必须转换为米才能在库仑定律中使用。所有最终能量均以千焦/摩尔表示。\n\n待评估的构型 $(R,\\beta)$ 测试套件：\n1. $(R, \\beta) = (2.4, 0)$,\n2. $(R, \\beta) = (3.0, 0)$,\n3. $(R, \\beta) = (5.0, 0)$,\n4. $(R, \\beta) = (20.0, 0)$,\n5. $(R, \\beta) = (3.0, 90)$,\n6. $(R, \\beta) = (3.0, 180)$,\n7. $(R, \\beta) = (2.2, 0)$.\n\n您的程序必须生成单行输出，其中包含测试套件的 $\\Delta E(R,\\beta)$ 值，形式为一个逗号分隔的浮点数列表，四舍五入到六位小数，并用方括号括起来，即形式为\n$$\n\\left[\\delta_1,\\delta_2,\\ldots,\\delta_7\\right],\n$$\n其中 $\\delta_i$ 对应于上述第 $i$ 个测试用例。不应打印任何其他文本。", "solution": "用户希望计算水二聚体在几种构型下，精确静电相互作用能与二阶多极展开能量之间的差值。\n\n### 步骤1：问题验证\n\n**1.1. 提取已知条件**\n\n*   **水单体几何结构：**\n    *   氧原子 `O` 位于 $\\left(0,0,0\\right)$ Å。\n    *   氢原子 `H1`、`H2` 位于 $x$-$z$ 平面。\n    *   键长 $d_{\\mathrm{OH}} = 0.9572$ Å。\n    *   键角 $\\angle\\text{HOH} = \\theta = 104.52^\\circ$。\n    *   氢原子坐标：$\\mathbf{r}_{\\mathrm{H1}} = \\left( d_{\\mathrm{OH}}\\sin\\left(\\tfrac{\\theta}{2}\\right),\\, 0,\\, d_{\\mathrm{OH}}\\cos\\left(\\tfrac{\\theta}{2}\\right) \\right)$, $\\mathbf{r}_{\\mathrm{H2}} = \\left( -d_{\\mathrm{OH}}\\sin\\left(\\tfrac{\\theta}{2}\\right),\\, 0,\\, d_{\\mathrm{OH}}\\cos\\left(\\tfrac{\\theta}{2}\\right) \\right)$。\n*   **水单体电荷：**\n    *   $q_{\\mathrm{O}} = -0.834\\,e$。\n    *   $q_{\\mathrm{H}} = +0.417\\,e$。\n*   **水二聚体构建：**\n    *   单体 A：氧原子位于全局坐标系原点。\n    *   单体 B：绕全局 $y$ 轴旋转一个角度 $\\beta$，然后其氧原子平移至 $\\mathbf{R} = \\left(0,0,R\\right)$。\n*   **相互作用能，精确值 ($E_{\\mathrm{exact}}$)：**\n    *   $E_{\\mathrm{exact}}(R,\\beta) = N_{\\mathrm{A}}\\,k_{\\mathrm{e}}\\,e^2 \\sum_{a\\in \\mathrm{A}} \\sum_{b\\in \\mathrm{B}} \\frac{q_a\\,q_b}{\\left\\lVert \\mathbf{R} + \\mathbf{r}_b - \\mathbf{r}_a \\right\\rVert}$。\n    *   `a` 和 `b` 分别是单体 `A` 和 `B` 中的原子。\n    *   $\\mathbf{r}_a$ 和 $\\mathbf{r}_b$ 是相对于各自单体氧原子的局部坐标。请注意，对于单体 B，$\\mathbf{r}_b$ 在用于全局坐标系之前必须进行旋转。\n*   **相互作用能，展开值 ($E_{\\mathrm{exp2}}$)：**\n    *   与 $E_{\\mathrm{exact}}$ 相同，但核 $1/\\left\\lVert \\mathbf{R} + \\mathbf{r}_b - \\mathbf{r}_a \\right\\rVert$ 被其关于 $\\boldsymbol{\\Delta}_{ab}=\\mathbf{r}_b-\\mathbf{r}_a$ 的二阶泰勒展开式所替代。\n*   **物理常数：**\n    *   $k_{\\mathrm{e}} = 8.9875517923 \\times 10^9\\ \\text{N}\\cdot\\text{m}^2/\\text{C}^2$。\n    *   $e = 1.602176634 \\times 10^{-19}\\ \\text{C}$。\n    *   $N_{\\mathrm{A}} = 6.02214076 \\times 10^{23}\\ \\text{mol}^{-1}$。\n*   **单位转换：**\n    *   $1\\ \\text{Å} = 1.0 \\times 10^{-10}\\ \\text{m}$。\n    *   最终能量必须以 $\\text{kJ/mol}$ 为单位。\n*   **任务：**\n    *   计算 $\\Delta E(R,\\beta) = E_{\\mathrm{exp2}}(R,\\beta) - E_{\\mathrm{exact}}(R,\\beta)$。\n*   **测试用例 $(R, \\beta)$：**\n    1.  $(2.4\\ \\text{Å}, 0^\\circ)$\n    2.  $(3.0\\ \\text{Å}, 0^\\circ)$\n    3.  $(5.0\\ \\text{Å}, 0^\\circ)$\n    4.  $(20.0\\ \\text{Å}, 0^\\circ)$\n    5.  $(3.0\\ \\text{Å}, 90^\\circ)$\n    6.  $(3.0\\ \\text{Å}, 180^\\circ)$\n    7.  $(2.2\\ \\text{Å}, 0^\\circ)$\n\n**1.2. 验证结论**\n\n该问题在计算上和科学上都是明确定义的。\n*   **科学依据：**该问题使用静电学的基本原理（库仑定律）和标准的数学技术（泰勒展开）来模拟分子间相互作用。这是计算化学中的一个常见练习。\n*   **定义完善：**所有必要的几何参数、电荷、物理常数和公式都已提供。任务明确。对于每个输入 $(R, \\beta)$，存在唯一的数值解。\n*   **客观性：**问题以精确、定量的术语陈述，没有主观性或模糊性。\n\n该问题不违反任何指定的无效标准。这是一个有效、可解的问题。\n\n### 步骤2：求解设计\n\n**2.1. 原理与策略**\n问题的核心是计算水二聚体的两种形式的静电相互作用能，并求出它们的差值。两种能量都是对来自两个单体的 $3 \\times 3=9$ 对相互作用点电荷的求和。所有计算将使用国际单位制（SI）进行，以确保与给定的物理常数一致，并最终转换为 $\\text{kJ/mol}$。\n\n**2.2. 几何设置**\n首先，我们为给定的构型 $(R, \\beta)$ 建立系统的几何结构。\n1.  **单体 A：**原子（O, H1, H2）的局部坐标根据给定的键长 $d_{\\mathrm{OH}}$ 和角度 $\\theta$ 计算得出。由于单体 A 的氧原子位于全局坐标系原点，这些局部坐标也是其全局坐标。\n2.  **单体 B：**局部坐标与单体 A 的相同。为了找到单体 B 中原子的全局坐标，每个局部坐标向量 $\\mathbf{r}'_b$ 首先绕全局 y 轴旋转一个角度 $\\beta$，然后通过向量 $\\mathbf{R} = (0, 0, R)$ 平移。一个向量 $\\mathbf{v} = (v_x, v_y, v_z)$ 绕 y 轴主动旋转一个角度 $\\beta$ 产生一个新的向量 $\\mathbf{v}'$：\n    $$\n    \\begin{pmatrix} v'_x \\\\ v'_y \\\\ v'_z \\end{pmatrix} =\n    \\begin{pmatrix} \\cos\\beta   0   \\sin\\beta \\\\ 0   1   0 \\\\ -\\sin\\beta   0   \\cos\\beta \\end{pmatrix}\n    \\begin{pmatrix} v_x \\\\ v_y \\\\ v_z \\end{pmatrix}\n    $$\n    原子 $b \\in B$ 的最终全局位置是 $\\mathbf{p}_b = \\mathbf{Rot_y}(\\beta)\\mathbf{r}'_b + \\mathbf{R}$。\n\n**2.3. 能量计算**\n对于每一对原子 $(a \\in A, b \\in B)$，我们计算其对 $E_{\\mathrm{exact}}$ 和 $E_{\\mathrm{exp2}}$ 的贡献。\n\n*   **精确能量 ($E_{\\mathrm{exact}}$)：**\n    原子 a 和原子 b 之间的向量是 $\\mathbf{d}_{ab} = \\mathbf{p}_b - \\mathbf{p}_a$。这对原子对相互作用能的贡献与 $1/\\lVert\\mathbf{d}_{ab}\\rVert$ 成正比。\n    总能量为：\n    $$ E_{\\mathrm{exact}} = C \\sum_{a \\in A} \\sum_{b \\in B} \\frac{q_a q_b}{\\lVert \\mathbf{p}_b - \\mathbf{p}_a \\rVert} $$\n    其中 $C = N_{\\mathrm{A}}\\,k_{\\mathrm{e}}\\,e^2$ 是一个预因子，而 $q_a, q_b$ 是以 $e$ 为单位的部分电荷。对于数值计算，所有位置都必须以米为单位。\n\n*   **展开能量 ($E_{\\mathrm{exp2}}$)：**\n    我们需要核 $f(\\boldsymbol{\\Delta}) = 1/\\lVert\\mathbf{R}+\\boldsymbol{\\Delta}\\rVert$ 在 $\\boldsymbol{\\Delta}=\\mathbf{0}$ 附近的二阶泰勒展开。位移向量为 $\\boldsymbol{\\Delta}_{ab} = \\mathbf{Rot_y}(\\beta)\\mathbf{r}'_b - \\mathbf{r}'_a$。注意 $\\mathbf{r}'_a$ 是原子 a 的局部坐标。\n    泰勒展开为 $f(\\boldsymbol{\\Delta}) \\approx f(\\mathbf{0}) + \\nabla f(\\mathbf{0}) \\cdot \\boldsymbol{\\Delta} + \\frac{1}{2} \\boldsymbol{\\Delta}^\\mathrm{T} \\mathbf{H}(\\mathbf{0}) \\boldsymbol{\\Delta}$，其中 $\\mathbf{H}$ 是海森矩阵。\n    给定 $\\mathbf{R} = (0, 0, R)$，展开式计算为：\n    $$ \\frac{1}{\\lVert\\mathbf{R}+\\boldsymbol{\\Delta}\\rVert} \\approx \\frac{1}{R} - \\frac{\\Delta_z}{R^2} + \\frac{2\\Delta_z^2 - \\Delta_x^2 - \\Delta_y^2}{2R^3} $$\n    其中 $\\Delta_x, \\Delta_y, \\Delta_z$ 是 $\\boldsymbol{\\Delta}_{ab}$ 的分量。\n    总展开能量为：\n    $$ E_{\\mathrm{exp2}} = C \\sum_{a \\in A} \\sum_{b \\in B} q_a q_b \\left( \\frac{1}{R} - \\frac{\\Delta_z}{R^2} + \\frac{2\\Delta_z^2 - \\Delta_x^2 - \\Delta_y^2}{2R^3} \\right) $$\n\n**2.4. 单位与预因子**\n能量表达式 $E = N_{\\mathrm{A}} k_{\\mathrm{e}} e^2 \\sum (q_a q_b / d)$ 要求距离 $d$ 以米为单位，以产生以焦耳/摩尔为单位的能量。\n最终能量要求以千焦/摩尔为单位。因此，我们为所有长度均采用国际单位制（米）的计算定义一个单一的能量预因子：\n$$\n\\text{Prefactor} = N_{\\mathrm{A}} \\cdot k_{\\mathrm{e}} \\cdot e^2 \\cdot 10^{-3} \\quad [\\mathrm{kJ \\cdot m \\cdot mol^{-1}}]\n$$\n这个预因子乘以一个单位为 $\\mathrm{m}^{-1}$ 的总和时，将得到以 $\\text{kJ/mol}$ 为单位的能量。\n\n**2.5. 算法**\n1.  定义所有物理常数和单位转换因子。\n2.  计算恒定的能量预因子。\n3.  预先计算水单体原子以米为单位的局部坐标。\n4.  对于每个测试用例 $(R, \\beta)$：\n    a. 将 $R$ 从埃转换为米。将 $\\beta$ 从度转换为弧度。\n    b. 生成 $\\beta$ 的旋转矩阵。\n    c. 初始化用于 $E_{\\mathrm{exact}}$ 和 $E_{\\mathrm{exp2}}$ 中求和的累加器变量。\n    d. 遍历 9 个分子间原子对 $(a, b)$ 中的每一个：\n        i.   确定以米为单位的全局位置 $\\mathbf{p}_a$ 和 $\\mathbf{p}_b$。\n        ii.  计算精确距离 $\\lVert\\mathbf{p}_b - \\mathbf{p}_a\\rVert$ 并将项 $q_a q_b / \\lVert\\mathbf{p}_b - \\mathbf{p}_a\\rVert$ 添加到精确能量总和中。\n        iii. 确定以米为单位的位移向量 $\\boldsymbol{\\Delta}_{ab}$。\n        iv.  使用 $\\boldsymbol{\\Delta}_{ab}$ 和 $R$ 的分量计算二阶展开核的值。\n        v.   将项 $q_a q_b \\times (\\text{kernel value})$ 添加到展开能量总和中。\n    e. 将两个总和都乘以能量预因子，以得到以 $\\text{kJ/mol}$ 为单位的 $E_{\\mathrm{exact}}$ 和 $E_{\\mathrm{exp2}}$。\n    f. 计算差值 $\\Delta E = E_{\\mathrm{exp2}} - E_{\\mathrm{exact}}$ 并存储它。\n5.  将存储的 $\\Delta E$ 值列表格式化为所需的输出字符串。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the difference between a truncated multipole expansion and the exact\n    electrostatic interaction energy for a water dimer.\n    \"\"\"\n    # --- Givens and Constants ---\n    \n    # Physical Constants\n    K_E = 8.9875517923e9  # Coulomb's constant in N m^2 C^-2\n    E_CHARGE = 1.602176634e-19  # Elementary charge in C\n    N_A = 6.02214076e23  # Avogadro's number in mol^-1\n\n    # Unit Conversions\n    ANGSTROM_TO_METER = 1.0e-10\n    JOULE_MOL_TO_KJ_MOL = 1.0e-3\n    \n    # Energy Prefactor: Converts a sum in units of m^-1 to kJ/mol\n    # Units: (N m^2 C^-2) * C^2 * mol^-1 * (kJ/J) -> kJ m mol^-1\n    ENERGY_PREFACTOR_SI = K_E * E_CHARGE**2 * N_A * JOULE_MOL_TO_KJ_MOL\n    \n    # Test cases: (R in Å, beta in degrees)\n    test_cases = [\n        (2.4, 0.0),\n        (3.0, 0.0),\n        (5.0, 0.0),\n        (20.0, 0.0),\n        (3.0, 90.0),\n        (3.0, 180.0),\n        (2.2, 0.0),\n    ]\n\n    # --- Helper Functions ---\n    \n    def get_monomer_data():\n        \"\"\"\n        Returns local coordinates (in meters) and charges (in units of e)\n        for a water monomer.\n        \"\"\"\n        D_OH_A = 0.9572  # Bond length in Å\n        THETA_HOH_DEG = 104.52  # Bond angle in degrees\n        \n        theta_rad = np.deg2rad(THETA_HOH_DEG)\n        \n        # Local coordinates in Å\n        r_O_A = np.array([0.0, 0.0, 0.0])\n        r_H1_A = np.array([\n            D_OH_A * np.sin(theta_rad / 2),\n            0.0,\n            D_OH_A * np.cos(theta_rad / 2)\n        ])\n        r_H2_A = np.array([\n            -D_OH_A * np.sin(theta_rad / 2),\n            0.0,\n            D_OH_A * np.cos(theta_rad / 2)\n        ])\n        \n        coords_A = np.array([r_O_A, r_H1_A, r_H2_A])\n        coords_m = coords_A * ANGSTROM_TO_METER\n        \n        # Charges in units of elementary charge e\n        charges_e = np.array([-0.834, 0.417, 0.417])\n        \n        return coords_m, charges_e\n\n    def get_rotation_matrix_y(beta_deg):\n        \"\"\"\n        Returns the active rotation matrix for rotation around the y-axis.\n        \"\"\"\n        beta_rad = np.deg2rad(beta_deg)\n        c, s = np.cos(beta_rad), np.sin(beta_rad)\n        return np.array([\n            [c, 0.0, s],\n            [0.0, 1.0, 0.0],\n            [-s, 0.0, c]\n        ])\n\n    def calculate_delta_e(R_A, beta_deg, coords_local_m, charges):\n        \"\"\"\n        Calculates the difference between E_exp2 and E_exact for a given configuration.\n        R_A is in Ångströms, beta_deg is in degrees.\n        All internal calculations are in SI units.\n        \"\"\"\n        R_m = R_A * ANGSTROM_TO_METER\n\n        rot_mat = get_rotation_matrix_y(beta_deg)\n        R_vec_m = np.array([0.0, 0.0, R_m])\n\n        # Global coordinates in meters\n        coords_A_global_m = coords_local_m\n        coords_B_global_m = (rot_mat @ coords_local_m.T).T + R_vec_m\n\n        sum_exact_SI = 0.0  # Sum over q_a*q_b / d_ab, units m^-1\n        sum_exp2_SI = 0.0   # Sum over q_a*q_b * kernel, units m^-1\n        \n        num_atoms = len(charges)\n        for i in range(num_atoms):  # Atom a in Monomer A\n            r_a_m = coords_A_global_m[i]\n            q_a = charges[i]\n            for j in range(num_atoms):  # Atom b in Monomer B\n                r_b_global_m = coords_B_global_m[j]\n                q_b = charges[j]\n\n                # --- Exact Energy Calculation ---\n                d_vec_ab_m = r_b_global_m - r_a_m\n                dist_ab_m = np.linalg.norm(d_vec_ab_m)\n                sum_exact_SI += (q_a * q_b) / dist_ab_m\n\n                # --- Expanded Energy Calculation ---\n                # Displacement vector Delta_ab (in meters)\n                r_b_rot_m = rot_mat @ coords_local_m[j]\n                Delta_ab_m = r_b_rot_m - r_a_m\n                \n                dx, dy, dz = Delta_ab_m[0], Delta_ab_m[1], Delta_ab_m[2]\n                \n                # Taylor expansion of 1/|R+Delta| in SI units\n                term0 = 1.0 / R_m\n                term1 = -dz / (R_m**2)\n                term2 = (2*dz**2 - dx**2 - dy**2) / (2 * R_m**3)\n                \n                kernel_exp = term0 + term1 + term2\n                sum_exp2_SI += q_a * q_b * kernel_exp\n\n        # Apply prefactor to get final energies in kJ/mol\n        E_exact_kJ_mol = ENERGY_PREFACTOR_SI * sum_exact_SI\n        E_exp2_kJ_mol = ENERGY_PREFACTOR_SI * sum_exp2_SI\n        \n        delta_E = E_exp2_kJ_mol - E_exact_kJ_mol\n        return delta_E\n\n    # --- Main Calculation Loop ---\n    \n    results = []\n    # Pre-calculate monomer data once\n    monomer_coords_m, monomer_charges = get_monomer_data()\n    \n    for R, beta in test_cases:\n        delta_E = calculate_delta_e(R, beta, monomer_coords_m, monomer_charges)\n        results.append(delta_E)\n\n    # --- Format and Print Output ---\n    \n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n\n```", "id": "2455086"}]}