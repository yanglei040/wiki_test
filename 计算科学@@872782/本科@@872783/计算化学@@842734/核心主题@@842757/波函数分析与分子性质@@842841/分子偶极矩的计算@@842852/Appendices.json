{"hands_on_practices": [{"introduction": "要真正理解量子化学软件包的内部工作原理，从头开始构建一个简化的模型是无价的练习。这个实践将指导你为一个水分子实现一个半经验的偶极矩计算。通过这个过程，你将亲手处理从基组、积分到哈密顿矩阵和求解本征问题等核心步骤，从而揭示像基组选择这样的决策是如何直接影响计算结果的 [@problem_id:2451307]。", "problem": "您需要编写一个完整、可运行的程序，该程序使用原子轨道线性组合 (LCAO) 紧束缚模型和数值积分，为五个模拟基组灵活性递增的高斯宽度参数集计算水分子的永久偶极矩大小。目标是研究其数值向已知气相实验偶极矩的收敛趋势，且不调用任何外部量子化学软件。程序必须输出一行，包含两个列表：第一个列表包含每个参数集计算出的偶极矩大小，第二个列表包含相对于实验值的绝对误差，所有值均以德拜 (Debye) 为单位，并四舍五入到三位小数。\n\n使用以下科学标准定义和建模假设作为基础：\n\n- 在 Born–Oppenheimer (BO) 近似下，中性分子的电子偶极矩定义为\n$$\n\\boldsymbol{\\mu} = \\sum_{A} Z_{A} \\mathbf{R}_{A} - \\int \\rho_{e}(\\mathbf{r})\\,\\mathbf{r}\\,d^3\\mathbf{r},\n$$\n其中 $Z_{A}$ 和 $\\mathbf{R}_{A}$ 分别是原子核 A 的电荷和位置，$\\rho_{e}(\\mathbf{r})$ 是电子密度。对于闭壳层体系，\n$$\n\\rho_{e}(\\mathbf{r}) = 2 \\sum_{a \\in \\text{occ}} \\left| \\psi_{a}(\\mathbf{r}) \\right|^{2}.\n$$\n- 在原子轨道线性组合 (LCAO) 近似中，每个分子轨道展开为\n$$\n\\psi_{a}(\\mathbf{r}) = \\sum_{i=1}^{N} C_{ia}\\,\\phi_{i}(\\mathbf{r}),\n$$\n其中 $\\phi_{i}(\\mathbf{r})$ 是以原子为中心的归一化笛卡尔高斯基元。在氧原子上使用一个 $2s$ 和三个 $2p$ ($p_x,p_y,p_z$) 函数，在每个氢原子上使用一个 $1s$ 函数，总共有 $N=6$ 个基函数。每个位于中心 $\\mathbf{R}_{A}$ 的基元具有以下形式\n- s 型：$\\phi_{s}(\\mathbf{r}) = N_{s}\\,\\exp\\!\\left(-\\alpha\\left\\|\\mathbf{r}-\\mathbf{R}_{A}\\right\\|^{2}\\right)$,\n- p_x 型：$\\phi_{p_x}(\\mathbf{r}) = N_{p}\\,(x-X_{A})\\,\\exp\\!\\left(-\\alpha\\left\\|\\mathbf{r}-\\mathbf{R}_{A}\\right\\|^{2}\\right)$,\n对于 $p_y$ 和 $p_z$ 有类似的定义。归一化常数为\n$$\nN_{s} = \\left(\\frac{2\\alpha}{\\pi}\\right)^{3/4}, \\quad\nN_{p} = \\left(\\frac{128\\,\\alpha^{5}}{\\pi^{3}}\\right)^{1/4}.\n$$\n- 通过求解广义本征值问题来确定占据分子轨道\n$$\n\\mathbf{H}\\,\\mathbf{C} = \\mathbf{S}\\,\\mathbf{C}\\,\\boldsymbol{\\varepsilon},\n$$\n其中 $\\mathbf{S}_{ij}=\\int \\phi_{i}(\\mathbf{r})\\phi_{j}(\\mathbf{r})\\,d^{3}\\mathbf{r}$ 是重叠矩阵，$\\mathbf{H}$ 是通过 Wolfsberg–Helmholtz (WH) 方法近似的单电子哈密顿量：\n$$\nH_{ii} = \\varepsilon_{i}, \\quad\nH_{ij} = K\\,S_{ij}\\,\\frac{\\varepsilon_{i}+\\varepsilon_{j}}{2} \\quad (i\\neq j),\n$$\n其中 $K$ 是一个无量纲常数。使用 $K=1.75$ 以及对角轨道能量 $\\varepsilon_{\\text{O}\\,2s}=-32.3\\,\\text{eV}$，$\\varepsilon_{\\text{O}\\,2p}=-14.8\\,\\text{eV}$ 和 $\\varepsilon_{\\text{H}\\,1s}=-13.6\\,\\text{eV}$。将 $8$ 个电子（四个双占据轨道）填充到能量最低的分子轨道中，这对应于氧的价态为 $6$，两个氢的价态各为 $1$。氧的有效核电荷使用 $Z_{\\text{O,eff}}=6$（氧的核电荷为 $8$ 减去隐含的 $1s$ 核心层中的 $2$ 个电子），每个氢的有效核电荷使用 $Z_{\\text{H}}=1$，这样总有效核电荷等于总电子数，从而确保在价层模型中体系整体呈电中性。\n- 在一个包围分子的规则三维网格上，通过数值求积计算所有必需的积分。对于任何具有体积元 $\\Delta V$ 的网格点 $\\mathbf{r}_{g}$，近似为\n$$\nS_{ij} \\approx \\sum_{g} \\phi_{i}(\\mathbf{r}_{g})\\,\\phi_{j}(\\mathbf{r}_{g})\\,\\Delta V,\n\\quad\nD^{(k)}_{ij} \\approx \\sum_{g} \\phi_{i}(\\mathbf{r}_{g})\\,r^{(k)}_{g}\\,\\phi_{j}(\\mathbf{r}_{g})\\,\\Delta V,\n$$\n其中 $k\\in\\{x,y,z\\}$，$D^{(k)}$ 是位置算符的偶极积分。电子偶极分量为\n$$\n\\mu^{(k)}_{\\text{el}} = - \\sum_{i,j} P_{ij}\\,D^{(k)}_{ij},\n$$\n其中密度矩阵 $\\mathbf{P} = 2\\,\\mathbf{C}_{\\text{occ}}\\mathbf{C}_{\\text{occ}}^{\\top}$。核偶极矩为 $\\boldsymbol{\\mu}_{\\text{nuc}} = \\sum_{A} Z_{A}\\,\\mathbf{R}_{A}$。总偶极矩为 $\\boldsymbol{\\mu}=\\boldsymbol{\\mu}_{\\text{nuc}}+\\boldsymbol{\\mu}_{\\text{el}}$。计算其大小 $\\|\\boldsymbol{\\mu}\\|$，并使用 $1\\,e\\cdot\\text{\\AA} = 4.803204712\\,\\text{Debye}$ 将其表示为德拜单位。\n\n几何结构和单位：\n- 使用水分子几何结构，其中 O 位于原点，分子位于 $x$-$z$ 平面内。O–H 键长为 $r_{\\text{OH}}=0.9572\\,\\text{\\AA}$，H–O–H 键角为 $\\theta=104.52$ 度。将氢原子置于\n$$\n\\mathbf{R}_{\\text{H1}} = (r_{\\text{OH}}\\sin(\\theta/2),\\,0,\\,r_{\\text{OH}}\\cos(\\theta/2)), \\quad\n\\mathbf{R}_{\\text{H2}} = (-r_{\\text{OH}}\\sin(\\theta/2),\\,0,\\,r_{\\text{OH}}\\cos(\\theta/2)).\n$$\n- 用于积分的所有空间坐标必须以埃 ($\\text{\\AA}$) 为单位，最终的偶极矩大小必须以德拜 (Debye) 为单位报告，并四舍五入到三位小数。角度以度为单位。\n\n数值网格：\n- 在每个笛卡尔方向上使用一个范围从 $-4.0\\,\\text{\\AA}$ 到 $+4.0\\,\\text{\\AA}$ 的均匀立方网格，其间距的选择应能将此区间均匀划分为一个足够精细的网格，以保证数值稳定性和重叠矩阵的正定性。程序应在所有计算中使用相同的网格。\n\n测试套件（五个参数集）：\n- 对于以下五种情况，将高斯指数（单位为 $\\text{\\AA}^{-2}$）设置为\n1. 集合 A (紧凑的, 类最小基组): $\\alpha_{\\text{O},2s}=2.00$, $\\alpha_{\\text{O},2p}=1.60$, $\\alpha_{\\text{H},1s}=1.30$.\n2. 集合 B: $\\alpha_{\\text{O},2s}=1.60$, $\\alpha_{\\text{O},2p}=1.20$, $\\alpha_{\\text{H},1s}=1.00$.\n3. 集合 C: $\\alpha_{\\text{O},2s}=1.20$, $\\alpha_{\\text{O},2p}=0.90$, $\\alpha_{\\text{H},1s}=0.80$.\n4. 集合 D: $\\alpha_{\\text{O},2s}=0.90$, $\\alpha_{\\text{O},2p}=0.70$, $\\alpha_{\\text{H},1s}=0.60$.\n5. 集合 E (弥散的, 类增广基组): $\\alpha_{\\text{O},2s}=0.70$, $\\alpha_{\\text{O},2p}=0.55$, $\\alpha_{\\text{H},1s}=0.45$.\n\n参考值：\n- 使用气相实验偶极矩大小 $\\mu_{\\text{exp}}=1.855$ 德拜。\n\n您的程序必须：\n- 实现上述 LCAO 紧束缚模型和数值积分，为五个参数集中的每一个计算以德拜为单位的 $\\|\\boldsymbol{\\mu}\\|$。\n- 对每种情况，计算以德拜为单位的绝对误差 $|\\|\\boldsymbol{\\mu}\\| - \\mu_{\\text{exp}}|$。\n- 生成单行输出，其中包含两个列表：第一个列表是五个以德拜为单位的偶极矩大小，第二个列表是五个以德拜为单位的绝对误差。两个列表都必须包含在一个外部列表中，并显示为\n$$\n[\\,[\\mu_{A},\\mu_{B},\\mu_{C},\\mu_{D},\\mu_{E}],\\,[e_{A},e_{B},e_{C},e_{D},e_{E}]\\,],\n$$\n其中每个数字都四舍五入到三位小数。\n\n约束条件：\n- 代码必须完全自包含，无需用户输入，并且必须遵守指定的执行环境。\n- 计算必须按所述方式执行；不允许对目标偶极矩结果进行硬编码或使用黑盒量子化学软件包。", "solution": "所述问题经过严格验证。\n\n**第 1 步：提取已知条件**\n\n*   **偶极矩定义 (Born-Oppenheimer):** $\\boldsymbol{\\mu} = \\sum_{A} Z_{A} \\mathbf{R}_{A} - \\int \\rho_{e}(\\mathbf{r})\\,\\mathbf{r}\\,d^3\\mathbf{r}$\n*   **电子密度:** $\\rho_{e}(\\mathbf{r}) = 2 \\sum_{a \\in \\text{occ}} \\left| \\psi_{a}(\\mathbf{r}) \\right|^{2}$\n*   **LCAO 展开:** $\\psi_{a}(\\mathbf{r}) = \\sum_{i=1}^{N} C_{ia}\\,\\phi_{i}(\\mathbf{r})$\n*   **基组 ($N=6$):** O: 一个 $2s$, 三个 $2p$ ($p_x, p_y, p_z$); 每个 H: 一个 $1s$。\n*   **高斯基元形式:** $\\phi_{s}(\\mathbf{r}) = N_{s}\\,\\exp\\!\\left(-\\alpha\\left\\|\\mathbf{r}-\\mathbf{R}_{A}\\right\\|^{2}\\right)$, $\\phi_{p_x}(\\mathbf{r}) = N_{p}\\,(x-X_{A})\\,\\exp\\!\\left(-\\alpha\\left\\|\\mathbf{r}-\\mathbf{R}_{A}\\right\\|^{2}\\right)$。\n*   **归一化常数:** $N_{s} = \\left(\\frac{2\\alpha}{\\pi}\\right)^{3/4}$, $N_{p} = \\left(\\frac{128\\,\\alpha^{5}}{\\pi^{3}}\\right)^{1/4}$。\n*   **久期方程:** $\\mathbf{H}\\,\\mathbf{C} = \\mathbf{S}\\,\\mathbf{C}\\,\\boldsymbol{\\varepsilon}$, 其中 $\\mathbf{S}_{ij}=\\int \\phi_{i}(\\mathbf{r})\\phi_{j}(\\mathbf{r})\\,d^{3}\\mathbf{r}$。\n*   **Wolfsberg-Helmholtz 哈密顿量:** $H_{ii} = \\varepsilon_{i}$, $H_{ij} = K\\,S_{ij}\\,\\frac{\\varepsilon_{i}+\\varepsilon_{j}}{2}$ 对于 $i\\neq j$。\n*   **参数:** $K=1.75$, $\\varepsilon_{\\text{O}\\,2s}=-32.3\\,\\text{eV}$, $\\varepsilon_{\\text{O}\\,2p}=-14.8\\,\\text{eV}$, $\\varepsilon_{\\text{H}\\,1s}=-13.6\\,\\text{eV}$。\n*   **电子构型:** $8$ 个价电子，填充 $4$ 个能量最低的分子轨道。\n*   **有效核电荷:** $Z_{\\text{O,eff}}=6$, $Z_{\\text{H}}=1$。\n*   **数值积分:** $S_{ij} \\approx \\sum_{g} \\phi_{i}(\\mathbf{r}_{g})\\,\\phi_{j}(\\mathbf{r}_{g})\\,\\Delta V$, $D^{(k)}_{ij} \\approx \\sum_{g} \\phi_{i}(\\mathbf{r}_{g})\\,r^{(k)}_{g}\\,\\phi_{j}(\\mathbf{r}_{g})\\,\\Delta V$。\n*   **电子偶极矩:** $\\mu^{(k)}_{\\text{el}} = - \\sum_{i,j} P_{ij}\\,D^{(k)}_{ij}$ 其中 $\\mathbf{P} = 2\\,\\mathbf{C}_{\\text{occ}}\\mathbf{C}_{\\text{occ}}^{\\top}$。\n*   **核偶极矩:** $\\boldsymbol{\\mu}_{\\text{nuc}} = \\sum_{A} Z_{A}\\,\\mathbf{R}_{A}$。\n*   **转换因子:** $1\\,e\\cdot\\text{\\AA} = 4.803204712\\,\\text{Debye}$。\n*   **几何结构:** O 位于 $(0,0,0)$; $r_{\\text{OH}}=0.9572\\,\\text{\\AA}$; H-O-H 键角 $\\theta=104.52^\\circ$。分子在 $xz$ 平面。位置 $\\mathbf{R}_{\\text{H1}} = (r_{\\text{OH}}\\sin(\\theta/2),\\,0,\\,r_{\\text{OH}}\\cos(\\theta/2))$, $\\mathbf{R}_{\\text{H2}} = (-r_{\\text{OH}}\\sin(\\theta/2),\\,0,\\,r_{\\text{OH}}\\cos(\\theta/2))$。\n*   **数值网格:** 均匀立方体，每个维度范围从 $[-4.0, +4.0]\\,\\text{\\AA}$。\n*   **测试集 ($\\alpha$ 单位为 $\\text{\\AA}^{-2}$):**\n    1.  A: $\\alpha_{\\text{O},2s}=2.00$, $\\alpha_{\\text{O},2p}=1.60$, $\\alpha_{\\text{H},1s}=1.30$.\n    2.  B: $\\alpha_{\\text{O},2s}=1.60$, $\\alpha_{\\text{O},2p}=1.20$, $\\alpha_{\\text{H},1s}=1.00$.\n    3.  C: $\\alpha_{\\text{O},2s}=1.20$, $\\alpha_{\\text{O},2p}=0.90$, $\\alpha_{\\text{H},1s}=0.80$.\n    4.  D: $\\alpha_{\\text{O},2s}=0.90$, $\\alpha_{\\text{O},2p}=0.70$, $\\alpha_{\\text{H},1s}=0.60$.\n    5.  E: $\\alpha_{\\text{O},2s}=0.70$, $\\alpha_{\\text{O},2p}=0.55$, $\\alpha_{\\text{H},1s}=0.45$.\n*   **参考值:** $\\mu_{\\text{exp}}=1.855$ 德拜。\n*   **输出格式:** `[[mu_A,...,mu_E],[e_A,...,e_E]]` 四舍五入到三位小数。\n\n**第 2 步：使用提取的已知条件进行验证**\n\n该问题具有科学依据，采用了计算化学中一个标准的（尽管是简化的）LCAO 模型。它是一个适定的问题，提供了所有必要的物理参数、数学公式和几何数据，以便为每个指定的测试用例得出确定的数值结果。对“合理精细的网格”的要求是数值分析中的一个标准指令，而不是一个缺陷，它只是将选择足够网格分辨率的任务交给了实现者。该问题是客观的，没有矛盾。价电子数（$8$）与有效核电荷总和（$6+1+1=8$）正确匹配，确保了模型体系是电中性的。\n\n**第 3 步：结论与行动**\n\n该问题是 **有效的**。将构建一个解决方案。\n\n**解题步骤**\n\n分子偶极矩的计算从第一性原理出发，并根据指定的近似进行调整。其基础是 Born-Oppenheimer 近似，该近似分离了原子核和电子的运动。总偶极矩 $\\boldsymbol{\\mu}$ 是核贡献 $\\boldsymbol{\\mu}_{\\text{nuc}}$ 和电子贡献 $\\boldsymbol{\\mu}_{\\text{el}}$ 的总和。\n\n**1. 分子几何结构和基组**\n水分子按规定放置在笛卡尔坐标系中。氧原子位于原点 $\\mathbf{R}_{\\text{O}} = (0,0,0)\\,\\text{\\AA}$。给定 $r_{\\text{OH}}=0.9572\\,\\text{\\AA}$ 和 $\\theta=104.52^\\circ$，氢原子的坐标计算如下：\n$\\theta/2 = 52.26^\\circ$。\n$$ \\mathbf{R}_{\\text{H1}} = (0.9572 \\sin(52.26^\\circ), 0, 0.9572 \\cos(52.26^\\circ)) \\approx (0.7569, 0, 0.5859)\\,\\text{\\AA} $$\n$$ \\mathbf{R}_{\\text{H2}} = (-0.9572 \\sin(52.26^\\circ), 0, 0.9572 \\cos(52.26^\\circ)) \\approx (-0.7569, 0, 0.5859)\\,\\text{\\AA} $$\n最小价基组由 $N=6$ 个原子轨道 (AOs) 组成：\n\\begin{itemize}\n    \\item $\\phi_0$: O $2s$，中心在 $\\mathbf{R}_{\\text{O}}$\n    \\item $\\phi_1$: O $2p_x$，中心在 $\\mathbf{R}_{\\text{O}}$\n    \\item $\\phi_2$: O $2p_y$，中心在 $\\mathbf{R}_{\\text{O}}$\n    \\item $\\phi_3$: O $2p_z$，中心在 $\\mathbf{R}_{\\text{O}}$\n    \\item $\\phi_4$: H1 $1s$，中心在 $\\mathbf{R}_{\\text{H1}}$\n    \\item $\\phi_5$: H2 $1s$，中心在 $\\mathbf{R}_{\\text{H2}}$\n\\end{itemize}\n每个原子轨道都是一个归一化的笛卡尔高斯函数，其具体指数 $\\alpha$ 由参数集 A 到 E 给出。\n\n**2. 数值积分网格**\n所有积分都采用数值方法计算。在每个维度上，在 $[-4.0, +4.0]\\,\\text{\\AA}$ 的区域上构建一个均匀的立方网格。选择每个轴 101 个点的分辨率以确保数值稳定性和合理的精度。这得出的网格间距为 $\\Delta x = 8.0 / (101-1) = 0.08\\,\\text{\\AA}$，体积元为 $\\Delta V = (\\Delta x)^3 = 0.000512\\,\\text{\\AA}^3$。\n\n**3. 矩阵构建**\n分子轨道 $\\psi_a$ 通过求解广义本征值问题 $\\mathbf{H}\\,\\mathbf{C} = \\mathbf{S}\\,\\mathbf{C}\\,\\boldsymbol{\\varepsilon}$ 来确定。必须首先构建矩阵 $\\mathbf{S}$ 和 $\\mathbf{H}$。\n\n重叠矩阵元 $S_{ij}$ 通过对所有网格点 $\\mathbf{r}_g$ 求和来计算：\n$$ S_{ij} = \\int \\phi_i^*(\\mathbf{r}) \\phi_j(\\mathbf{r})\\,d^3\\mathbf{r} \\approx \\sum_{g} \\phi_i(\\mathbf{r}_g) \\phi_j(\\mathbf{r}_g) \\Delta V $$\n\n哈密顿矩阵 $\\mathbf{H}$ 使用 Wolfsberg-Helmholtz 近似构建。对角元素是原子轨道的电离势：\n$$ H_{ii} = \\varepsilon_{i} $$\n其中 $\\varepsilon_i \\in \\{\\varepsilon_{\\text{O}\\,2s}, \\varepsilon_{\\text{O}\\,2p}, \\varepsilon_{\\text{H}\\,1s}\\}$ 对应于原子轨道 $\\phi_i$。非对角元素与重叠积分成正比：\n$$ H_{ij} = K\\,S_{ij}\\,\\frac{\\varepsilon_{i}+\\varepsilon_{j}}{2} \\quad (i\\neq j) $$\n其中 $K=1.75$。\n\n**4. 求解久期方程并构建密度矩阵**\n使用标准的数值线性代数例程求解广义本征值问题，得到 MO 能量 $\\varepsilon_a$ 和 MO 系数矩阵 $\\mathbf{C}$（其中列是本征向量）。水分子有 $6$（来自 O）+ $1$（来自 H1）+ $1$（来自 H2）= $8$ 个价电子。这些电子双占据能量最低的 4 个分子轨道。通过取 $\\mathbf{C}$ 的前 4 列来形成矩阵 $\\mathbf{C}_{\\text{occ}}$。然后按如下方式计算单电子密度矩阵 $\\mathbf{P}$：\n$$ \\mathbf{P} = 2\\,\\mathbf{C}_{\\text{occ}}\\mathbf{C}_{\\text{occ}}^{\\top} $$\n\n**5. 偶极矩计算**\n总偶极矩 $\\boldsymbol{\\mu}$ 是核部分和电子部分的总和。\n\n核贡献 $\\boldsymbol{\\mu}_{\\text{nuc}}$ 是对位于位置 $\\mathbf{R}_A$ 的有效核电荷 $Z_A$ 的求和：\n$$ \\boldsymbol{\\mu}_{\\text{nuc}} = \\sum_{A} Z_A \\mathbf{R}_A = Z_{\\text{O,eff}}\\mathbf{R}_{\\text{O}} + Z_{\\text{H}}\\mathbf{R}_{\\text{H1}} + Z_{\\text{H}}\\mathbf{R}_{\\text{H2}} $$\n给定 $Z_{\\text{O,eff}}=6$，$Z_{\\text{H}}=1$ 和 $\\mathbf{R}_{\\text{O}}=(0,0,0)$，并利用氢原子位置的对称性，唯一非零的分量是：\n$$ \\mu_{\\text{nuc},z} = 1 \\cdot (r_{\\text{OH}}\\cos(\\theta/2)) + 1 \\cdot (r_{\\text{OH}}\\cos(\\theta/2)) = 2 r_{\\text{OH}}\\cos(\\theta/2) $$\n单位是基本电荷 ($e$) 乘以埃 ($\\text{\\AA}$)。\n\n电子贡献 $\\boldsymbol{\\mu}_{\\text{el}}$ 是根据密度矩阵 $\\mathbf{P}$ 和每个笛卡尔分量 $k \\in \\{x, y, z\\}$ 的偶极积分矩阵 $\\mathbf{D}^{(k)}$ 计算得出的。偶极积分矩阵在网格上计算：\n$$ D^{(k)}_{ij} = \\int \\phi_i(\\mathbf{r}) r^{(k)} \\phi_j(\\mathbf{r})\\,d^3\\mathbf{r} \\approx \\sum_{g} \\phi_i(\\mathbf{r}_g) r^{(k)}_g \\phi_j(\\mathbf{r}_g) \\Delta V $$\n于是，电子偶极分量为：\n$$ \\mu^{(k)}_{\\text{el}} = - \\sum_{i,j} P_{ij} D^{(k)}_{ij} = -\\text{Tr}(\\mathbf{P} \\mathbf{D}^{(k)}) $$\n由于分子对称性 ($C_{2v}$)，总偶极矩向量 $\\boldsymbol{\\mu} = \\boldsymbol{\\mu}_{\\text{nuc}} + \\boldsymbol{\\mu}_{\\text{el}}$ 预计会沿 $z$ 轴方向，因此 $\\mu_x$ 和 $\\mu_y$ 应为零。\n\n最后，计算总偶极矩的大小并转换为德拜：\n$$ \\|\\boldsymbol{\\mu}\\| = \\sqrt{\\mu_x^2 + \\mu_y^2 + \\mu_z^2} $$\n$$ \\|\\boldsymbol{\\mu}\\|_{\\text{Debye}} = \\|\\boldsymbol{\\mu}\\|_{e\\cdot\\text{\\AA}} \\times 4.803204712 $$\n然后为每个参数集计算相对于实验值 $\\mu_{\\text{exp}}=1.855$ 德拜的绝对误差。对五组高斯指数中的每一组重复整个过程。减小指数（从 A 到 E）会使基函数更加弥散，这通常会改善对电荷分布和偶极矩等性质的描述。因此，预计会观察到误差减小的趋势。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import linalg\n\ndef solve():\n    \"\"\"\n    Computes the dipole moment of a water molecule using a semi-empirical\n    LCAO model for five different basis set parameter sets.\n    \"\"\"\n\n    # --- 1. Constants and Parameters ---\n    K_WH = 1.75  # Wolfsberg-Helmholtz constant\n    E_O_2S = -32.3  # eV\n    E_O_2P = -14.8  # eV\n    E_H_1S = -13.6  # eV\n    Z_O_eff = 6.0  # Effective nuclear charge for Oxygen\n    Z_H = 1.0     # Nuclear charge for Hydrogen\n    N_ELECTRONS = 8\n    MU_EXP_DEBYE = 1.855  # Experimental dipole moment in Debye\n    E_A_TO_DEBYE = 4.803204712\n\n    # --- 2. Geometry Setup ---\n    r_OH = 0.9572  # Angstrom\n    theta_HOH_deg = 104.52\n    theta_rad = np.deg2rad(theta_HOH_deg)\n\n    R_O = np.array([0.0, 0.0, 0.0])\n    R_H1 = np.array([r_OH * np.sin(theta_rad / 2.0), 0.0, r_OH * np.cos(theta_rad / 2.0)])\n    R_H2 = np.array([-r_OH * np.sin(theta_rad / 2.0), 0.0, r_OH * np.cos(theta_rad / 2.0)])\n    \n    atom_coords = [R_O, R_H1, R_H2]\n    atom_charges = [Z_O_eff, Z_H, Z_H]\n\n    # --- 3. Basis Set Definition ---\n    # Order: 0:O(2s), 1:O(2px), 2:O(2py), 3:O(2pz), 4:H1(1s), 5:H2(1s)\n    basis_info = [\n        {'type': 's',  'atom_idx': 0, 'energy': E_O_2S},\n        {'type': 'px', 'atom_idx': 0, 'energy': E_O_2P},\n        {'type': 'py', 'atom_idx': 0, 'energy': E_O_2P},\n        {'type': 'pz', 'atom_idx': 0, 'energy': E_O_2P},\n        {'type': 's',  'atom_idx': 1, 'energy': E_H_1S},\n        {'type': 's',  'atom_idx': 2, 'energy': E_H_1S},\n    ]\n    N_BASIS = len(basis_info)\n    H_diag = np.array([b['energy'] for b in basis_info])\n\n    # --- 4. Test Cases ---\n    test_cases = [\n        {'name': 'A', 'alpha_O_2s': 2.00, 'alpha_O_2p': 1.60, 'alpha_H_1s': 1.30},\n        {'name': 'B', 'alpha_O_2s': 1.60, 'alpha_O_2p': 1.20, 'alpha_H_1s': 1.00},\n        {'name': 'C', 'alpha_O_2s': 1.20, 'alpha_O_2p': 0.90, 'alpha_H_1s': 0.80},\n        {'name': 'D', 'alpha_O_2s': 0.90, 'alpha_O_2p': 0.70, 'alpha_H_1s': 0.60},\n        {'name': 'E', 'alpha_O_2s': 0.70, 'alpha_O_2p': 0.55, 'alpha_H_1s': 0.45},\n    ]\n\n    # --- 5. Numerical Grid Setup ---\n    N_GRID_PTS = 101\n    GRID_MIN, GRID_MAX = -4.0, 4.0\n    grid_coords_1d = np.linspace(GRID_MIN, GRID_MAX, N_GRID_PTS)\n    dx = grid_coords_1d[1] - grid_coords_1d[0]\n    dV = dx**3\n\n    x, y, z = np.meshgrid(grid_coords_1d, grid_coords_1d, grid_coords_1d, indexing='ij')\n    grid = np.vstack([x.ravel(), y.ravel(), z.ravel()]).T\n\n    # --- 6. Main Calculation Loop ---\n    dipole_magnitudes = []\n    absolute_errors = []\n\n    for case in test_cases:\n        # Assign alpha values for the current case\n        alphas = [\n            case['alpha_O_2s'],\n            case['alpha_O_2p'], case['alpha_O_2p'], case['alpha_O_2p'],\n            case['alpha_H_1s'],\n            case['alpha_H_1s'],\n        ]\n\n        # Evaluate all basis functions on the grid\n        phi_grid = np.zeros((grid.shape[0], N_BASIS))\n        for i in range(N_BASIS):\n            info = basis_info[i]\n            alpha = alphas[i]\n            center = atom_coords[info['atom_idx']]\n            \n            r_minus_RA = grid - center\n            r_sq = np.sum(r_minus_RA**2, axis=1)\n            gauss_part = np.exp(-alpha * r_sq)\n\n            if info['type'] == 's':\n                norm = (2 * alpha / np.pi)**0.75\n                phi_grid[:, i] = norm * gauss_part\n            else: # p-type\n                norm = (128 * alpha**5 / np.pi**3)**0.25\n                if info['type'] == 'px':\n                    phi_grid[:, i] = norm * r_minus_RA[:, 0] * gauss_part\n                elif info['type'] == 'py':\n                    phi_grid[:, i] = norm * r_minus_RA[:, 1] * gauss_part\n                elif info['type'] == 'pz':\n                    phi_grid[:, i] = norm * r_minus_RA[:, 2] * gauss_part\n\n        # Compute Overlap (S) and Dipole (D) matrices\n        S = phi_grid.T @ phi_grid * dV\n        Dx = phi_grid.T @ (grid[:, 0, np.newaxis] * phi_grid) * dV\n        Dy = phi_grid.T @ (grid[:, 1, np.newaxis] * phi_grid) * dV\n        Dz = phi_grid.T @ (grid[:, 2, np.newaxis] * phi_grid) * dV\n\n        # Compute Hamiltonian matrix (H)\n        H = np.diag(H_diag)\n        H_off_diag = 0.5 * K_WH * S * (H_diag[:, np.newaxis] + H_diag)\n        H = H + (H_off_diag - np.diag(np.diag(H_off_diag)))\n\n        # Solve generalized eigenvalue problem: HC = SCe\n        energies, C = linalg.eigh(H, S)\n        \n        # Form density matrix from occupied orbitals\n        C_occ = C[:, :N_ELECTRONS // 2]\n        P = 2.0 * (C_occ @ C_occ.T)\n\n        # Compute electronic dipole moment\n        mu_el_x = -np.trace(P @ Dx)\n        mu_el_y = -np.trace(P @ Dy)\n        mu_el_z = -np.trace(P @ Dz)\n        mu_el = np.array([mu_el_x, mu_el_y, mu_el_z])\n\n        # Compute nuclear dipole moment\n        mu_nuc = np.zeros(3)\n        for i in range(len(atom_coords)):\n            mu_nuc += atom_charges[i] * atom_coords[i]\n\n        # Total dipole moment\n        mu_total = mu_nuc + mu_el  # in e*A\n        mu_mag_eA = np.linalg.norm(mu_total)\n        mu_mag_debye = mu_mag_eA * E_A_TO_DEBYE\n\n        # Store results\n        dipole_magnitudes.append(mu_mag_debye)\n        absolute_errors.append(abs(mu_mag_debye - MU_EXP_DEBYE))\n\n    # --- 7. Final Output ---\n    formatted_dms = [f\"{dm:.3f}\" for dm in dipole_magnitudes]\n    formatted_errs = [f\"{err:.3f}\" for err in absolute_errors]\n    \n    print(f\"[[{','.join(formatted_dms)}],[{','.join(formatted_errs)}]]\")\n\nsolve()\n\n```", "id": "2451307"}, {"introduction": "并非所有化学问题都需要完整的量子力学计算才能获得有价值的见解。这个实践探讨了一种基于化学直觉的强大概念模型——电负性和化学硬度——来预测电荷转移和偶极矩。通过应用电负性均衡原理，你将为一系列双原子分子（包括一氧化碳$CO$这个经典的反直觉案例）估算电荷分布，从而快速洞察化学键的极性 [@problem_id:2451497]。", "problem": "您需要编写一个完整、可运行的程序，使用一种基于物理基础、受第一性原理启发的电荷均衡模型，计算三种气相、线性双原子物质沿键轴方向的永久电偶极矩。该模型将每个原子视为一个其能量与净电荷呈二次关系的位点，并将双原子分子视为电中性。偶极矩必须根据其定义，即总电荷分布的一阶矩进行计算。\n\n请遵循以下模型和约定。\n\n- 偶极矩矢量由电荷分布的一阶矩定义：对于一组离散的点电荷，沿键轴的分量由 $\\,\\mu_z = \\sum_i q_i z_i\\,$ 给出，其中 $\\,q_i\\,$ 是以基本电荷为单位的位点电荷，$\\,z_i\\,$ 是沿 $\\,z\\,$ 轴的位点位置，单位为埃（ångström）。\n- 每个双原子分子 $\\,\\mathrm{A}-\\mathrm{B}\\,$ 沿 $\\,z\\,$ 轴排列，原子 $\\,\\mathrm{A}\\,$ 位于 $\\,z=0\\,$，原子 $\\,\\mathrm{B}\\,$ 位于 $\\,z=R\\,$，其中 $\\,R\\,$ 是核间距，单位为埃。分子整体呈电中性，因此 $\\,q_{\\mathrm{A}} + q_{\\mathrm{B}} = 0\\,$。\n- 对于一个净电荷为 $\\,q_i\\,$ 的原子 $\\,i \\in \\{\\mathrm{A},\\mathrm{B}\\}\\,$，其位点能量为 $\\,E_i(q_i) = \\chi_i q_i + \\tfrac{1}{2}\\,\\eta_i q_i^2\\,$，其中 $\\,\\chi_i\\,$ 是以电子伏特 (eV) 为单位的Mulliken电负性，$\\,\\eta_i\\,$ 是以电子伏特为单位的绝对硬度。双原子分子的总能量为 $\\,E(q_{\\mathrm{A}},q_{\\mathrm{B}}) = E_{\\mathrm{A}}(q_{\\mathrm{A}}) + E_{\\mathrm{B}}(q_{\\mathrm{B}})\\,$。原子间的库仑耦合被忽略。平衡电荷满足电中性约束并使 $\\,E\\,$ 最小化。\n- 沿键轴的永久电偶极矩分量为 $\\,\\mu_z = q_{\\mathrm{B}}\\,R\\,$，单位是 $\\,\\mathrm{e\\cdot\\AA}\\,$，必须将其转换为德拜（Debye）。使用转换因子 $\\,1\\,\\mathrm{e\\cdot\\AA} = 4.80320471257\\,\\mathrm{D}\\,$。报告 $\\,\\mu_z\\,$ 的带符号值，单位为德拜，其中正值对应于原子 $\\,\\mathrm{B}\\,$ 带净正电荷。\n\n使用以下原子参数，每个参数由电离能 $\\,I\\,$ 和电子亲和能 $\\,A\\,$ 给出，单位为电子伏特。对于每种元素 $\\,X\\,$，计算 $\\,\\chi_X = \\tfrac{1}{2}(I_X + A_X)\\,$ 和 $\\,\\eta_X = I_X - A_X\\,$。\n\n- 碳 $\\,(\\mathrm{C})$: $\\,I_{\\mathrm{C}} = 11.2603\\,$, $\\,A_{\\mathrm{C}} = 1.2621\\,$.\n- 氮 $\\,(\\mathrm{N})$: $\\,I_{\\mathrm{N}} = 14.5341\\,$, $\\,A_{\\mathrm{N}} = -0.0700\\,$.\n- 氧 $\\,(\\mathrm{O})$: $\\,I_{\\mathrm{O}} = 13.6181\\,$, $\\,A_{\\mathrm{O}} = 1.4611\\,$.\n\n测试套件（每种情况指定原子标签和键长）：\n\n- 情况 $\\,1\\,$：氰基自由基 $\\,\\cdot\\mathrm{CN}\\,$（开壳层），作为中性双原子分子 $\\,\\mathrm{C}-\\mathrm{N}\\,$ 处理，其中 $\\,\\mathrm{A}=\\mathrm{C}\\,$, $\\,\\mathrm{B}=\\mathrm{N}\\,$, $\\,R = 1.171\\,$ 埃。\n- 情况 $\\,2\\,$：氮气 $\\,\\mathrm{N}_2\\,$，其中 $\\,\\mathrm{A}=\\mathrm{N}\\,$, $\\,\\mathrm{B}=\\mathrm{N}\\,$, $\\,R = 1.098\\,$ 埃。\n- 情况 $\\,3\\,$：一氧化碳 $\\,\\mathrm{CO}\\,$，其中 $\\,\\mathrm{A}=\\mathrm{C}\\,$, $\\,\\mathrm{B}=\\mathrm{O}\\,$, $\\,R = 1.128\\,$ 埃。\n\n您的程序必须对每种情况，确定在 $\\,q_{\\mathrm{A}} + q_{\\mathrm{B}} = 0\\,$ 约束下使 $\\,E(q_{\\mathrm{A}},q_{\\mathrm{B}})\\,$ 最小化的电荷分布 $\\,q_{\\mathrm{A}}\\,$ 和 $\\,q_{\\mathrm{B}}\\,$，然后计算偶极矩分量 $\\,\\mu_z\\,$，单位为德拜。将每个结果表示为德拜，四舍五入到三位小数。\n\n最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，按测试套件情况 $\\,1\\,$ 到 $\\,3\\,$ 的顺序列出结果。例如，$\\,\\big[\\mu_1,\\mu_2,\\mu_3\\big]\\,$，其中每个 $\\,\\mu_k\\,$ 是一个四舍五入到三位小数的浮点数，单位为德拜。", "solution": "问题陈述已经过严格审查，并被确定为有效。在一个简化的电荷均衡模型的框架内，它在科学上是合理的，在数学上是适定的，并为获得唯一解提供了所有必要的信息。该任务是指定物理和数学原理的直接应用。我们现在开始求解。\n\n该问题要求使用电荷均衡模型计算三种双原子物质的永久电偶极矩。该模型的基础是电负性均衡原理，即分子中原子间的电荷会发生流动，直到达到能量最低的状态，这对应于整个体系中化学势的均一化。\n\n孤立原子 $i$ 的能量近似为其净电荷 $q_i$ 的二次函数：\n$$E_i(q_i) = \\chi_i q_i + \\frac{1}{2} \\eta_i q_i^2$$\n其中 $\\chi_i$ 是Mulliken电负性，$\\eta_i$ 是绝对硬度。双原子分子 $\\mathrm{A}-\\mathrm{B}$ 的总电子能量是其组成原子能量的总和，如题目所指定，忽略原子间的库仑相互作用：\n$$E(q_{\\mathrm{A}}, q_{\\mathrm{B}}) = E_{\\mathrm{A}}(q_{\\mathrm{A}}) + E_{\\mathrm{B}}(q_{\\mathrm{B}}) = \\left(\\chi_{\\mathrm{A}} q_{\\mathrm{A}} + \\frac{1}{2} \\eta_{\\mathrm{A}} q_{\\mathrm{A}}^2\\right) + \\left(\\chi_{\\mathrm{B}} q_{\\mathrm{B}} + \\frac{1}{2} \\eta_{\\mathrm{B}} q_{\\mathrm{B}}^2\\right)$$\n该体系受制于整体电中性约束：\n$$q_{\\mathrm{A}} + q_{\\mathrm{B}} = 0 \\implies q_{\\mathrm{A}} = -q_{\\mathrm{B}}$$\n为了找到平衡电荷分布，我们相对于转移的电荷量，最小化总能量 $E$。让我们将转移的电荷定义为 $q = q_{\\mathrm{B}}$，这意味着 $q_{\\mathrm{A}} = -q$。将此代入能量表达式，得到一个单变量 $q$ 的函数：\n$$E(q) = \\left(\\chi_{\\mathrm{A}} (-q) + \\frac{1}{2} \\eta_{\\mathrm{A}} (-q)^2\\right) + \\left(\\chi_{\\mathrm{B}} q + \\frac{1}{2} \\eta_{\\mathrm{B}} q^2\\right)$$\n$$E(q) = (\\chi_{\\mathrm{B}} - \\chi_{\\mathrm{A}})q + \\frac{1}{2}(\\eta_{\\mathrm{A}} + \\eta_{\\mathrm{B}})q^2$$\n这是一个关于 $q$ 的二次函数。为求最小值，我们将关于 $q$ 的一阶导数设为零：\n$$\\frac{dE}{dq} = \\chi_{\\mathrm{B}} - \\chi_{\\mathrm{A}} + (\\eta_{\\mathrm{A}} + \\eta_{\\mathrm{B}})q = 0$$\n求解平衡电荷 $q = q_{\\mathrm{B}}$ 可得：\n$$q_{\\mathrm{B}} = \\frac{\\chi_{\\mathrm{A}} - \\chi_{\\mathrm{B}}}{\\eta_{\\mathrm{A}} + \\eta_{\\mathrm{B}}}$$\n二阶导数 $\\frac{d^2E}{dq^2} = \\eta_{\\mathrm{A}} + \\eta_{\\mathrm{B}}$ 为正，因为对于所有相关原子，硬度 $\\eta_i = I_i - A_i$ 均为正值，这证实了该解对应于能量的最小值。\n\n首先，我们根据给定的电离能（$I$）和电子亲和能（$A$），计算所需的原子参数 $\\chi_X = \\frac{1}{2}(I_X + A_X)$ 和 $\\eta_X = I_X - A_X$，所有单位均为电子伏特（$\\mathrm{eV}$）：\n对于碳（$\\mathrm{C}$），$I_{\\mathrm{C}} = 11.2603\\,\\mathrm{eV}$ 且 $A_{\\mathrm{C}} = 1.2621\\,\\mathrm{eV}$：\n$$\\chi_{\\mathrm{C}} = \\frac{1}{2}(11.2603 + 1.2621) = 6.2612\\,\\mathrm{eV}$$\n$$\\eta_{\\mathrm{C}} = 11.2603 - 1.2621 = 9.9982\\,\\mathrm{eV}$$\n对于氮（$\\mathrm{N}$），$I_{\\mathrm{N}} = 14.5341\\,\\mathrm{eV}$ 且 $A_{\\mathrm{N}} = -0.0700\\,\\mathrm{eV}$：\n$$\\chi_{\\mathrm{N}} = \\frac{1}{2}(14.5341 - 0.0700) = 7.23205\\,\\mathrm{eV}$$\n$$\\eta_{\\mathrm{N}} = 14.5341 - (-0.0700) = 14.6041\\,\\mathrm{eV}$$\n对于氧（$\\mathrm{O}$），$I_{\\mathrm{O}} = 13.6181\\,\\mathrm{eV}$ 且 $A_{\\mathrm{O}} = 1.4611\\,\\mathrm{eV}$：\n$$\\chi_{\\mathrm{O}} = \\frac{1}{2}(13.6181 + 1.4611) = 7.5396\\,\\mathrm{eV}$$\n$$\\eta_{\\mathrm{O}} = 13.6181 - 1.4611 = 12.1570\\,\\mathrm{eV}$$\n\n现在，我们计算每个测试用例的偶极矩。沿键轴的偶极矩分量是 $\\mu_z = q_{\\mathrm{A}}z_{\\mathrm{A}} + q_{\\mathrm{B}}z_{\\mathrm{B}}$。当原子 $\\mathrm{A}$ 在 $z=0$ 而原子 $\\mathrm{B}$ 在 $z=R$ 时，该式简化为 $\\mu_z = q_{\\mathrm{B}}R$。以 $\\mathrm{e\\cdot\\AA}$ 为单位的结果使用转换因子 $1\\,\\mathrm{e\\cdot\\AA} = 4.80320471257\\,\\mathrm{D}$ 转换为德拜（$\\mathrm{D}$）。\n\n**情况 1：氰基自由基（$\\mathrm{C}-\\mathrm{N}$）**\n$\\mathrm{A}=\\mathrm{C}$，$\\mathrm{B}=\\mathrm{N}$，$R = 1.171\\,\\mathrm{\\AA}$。\n$$q_{\\mathrm{N}} = \\frac{\\chi_{\\mathrm{C}} - \\chi_{\\mathrm{N}}}{\\eta_{\\mathrm{C}} + \\eta_{\\mathrm{N}}} = \\frac{6.2612 - 7.23205}{9.9982 + 14.6041} = \\frac{-0.97085}{24.6023} \\approx -0.039461\\,e$$\n$$\\mu_z = q_{\\mathrm{N}} R = (-0.039461\\,e) \\times (1.171\\,\\mathrm{\\AA}) \\approx -0.046209\\,\\mathrm{e\\cdot\\AA}$$\n$$\\mu_z \\approx -0.046209 \\times 4.80320471257\\,\\mathrm{D} \\approx -0.22195\\,\\mathrm{D}$$\n四舍五入到三位小数，$\\mu_z = -0.222\\,\\mathrm{D}$。\n\n**情况 2：氮气（$\\mathrm{N}_2$）**\n$\\mathrm{A}=\\mathrm{N}$，$\\mathrm{B}=\\mathrm{N}$，$R = 1.098\\,\\mathrm{\\AA}$。\n对于同核双原子分子，$\\chi_{\\mathrm{A}} = \\chi_{\\mathrm{B}}$，所以分子 $\\chi_{\\mathrm{A}} - \\chi_{\\mathrm{B}} = 0$。\n$$q_{\\mathrm{N}} = \\frac{\\chi_{\\mathrm{N}} - \\chi_{\\mathrm{N}}}{\\eta_{\\mathrm{N}} + \\eta_{\\mathrm{N}}} = 0$$\n因此，没有电荷转移，偶极矩为零。\n$$\\mu_z = 0.000\\,\\mathrm{D}$$\n\n**情况 3：一氧化碳（$\\mathrm{C}-\\mathrm{O}$）**\n$\\mathrm{A}=\\mathrm{C}$，$\\mathrm{B}=\\mathrm{O}$，$R = 1.128\\,\\mathrm{\\AA}$。\n$$q_{\\mathrm{O}} = \\frac{\\chi_{\\mathrm{C}} - \\chi_{\\mathrm{O}}}{\\eta_{\\mathrm{C}} + \\eta_{\\mathrm{O}}} = \\frac{6.2612 - 7.5396}{9.9982 + 12.1570} = \\frac{-1.2784}{22.1552} \\approx -0.057702\\,e$$\n$$\\mu_z = q_{\\mathrm{O}} R = (-0.057702\\,e) \\times (1.128\\,\\mathrm{\\AA}) \\approx -0.065087\\,\\mathrm{e\\cdot\\AA}$$\n$$\\mu_z \\approx -0.065087 \\times 4.80320471257\\,\\mathrm{D} \\approx -0.31262\\,\\mathrm{D}$$\n四舍五入到三位小数，$\\mu_z = -0.313\\,\\mathrm{D}$。\n\n值得注意的是，对于一氧化碳，这个简单的模型预测了一个小的偶极矩，其负极端在氧原子上，这与基于朴素电负性论证的预期相符。实验上，$\\mathrm{CO}$ 的偶极矩非常小（$0.112\\,\\mathrm{D}$），并且与直觉相反，负极在碳原子上。这种差异凸显了所用模型的局限性，该模型忽略了诸如轨道杂化和电荷分布（尤其是孤对电子）的空间延展等关键因素。然而，本计算正确地实现了所给定的模型。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the permanent electric dipole moment for three diatomic species\n    using a first-principles-inspired charge equilibration model.\n    \"\"\"\n\n    # Atomic parameters: Ionization Energy (I) and Electron Affinity (A) in eV.\n    atomic_params = {\n        'C': {'I': 11.2603, 'A': 1.2621},\n        'N': {'I': 14.5341, 'A': -0.0700},\n        'O': {'I': 13.6181, 'A': 1.4611},\n    }\n\n    # Test cases: (Atom A, Atom B, Bond length R in Angstrom)\n    test_cases = [\n        ('C', 'N', 1.171),  # Case 1: CN radical\n        ('N', 'N', 1.098),  # Case 2: N2\n        ('C', 'O', 1.128),  # Case 3: CO\n    ]\n\n    # Conversion factor from e.Angstrom to Debye\n    E_ANGSTROM_TO_DEBYE = 4.80320471257\n\n    results = []\n\n    # Pre-calculate model parameters chi (electronegativity) and eta (hardness)\n    model_params = {}\n    for symbol, params in atomic_params.items():\n        I = params['I']\n        A = params['A']\n        chi = 0.5 * (I + A)\n        eta = I - A\n        model_params[symbol] = {'chi': chi, 'eta': eta}\n\n    for case in test_cases:\n        atom_A_symbol, atom_B_symbol, R = case\n\n        # Get parameters for atom A and atom B\n        params_A = model_params[atom_A_symbol]\n        params_B = model_params[atom_B_symbol]\n\n        chi_A, eta_A = params_A['chi'], params_A['eta']\n        chi_B, eta_B = params_B['chi'], params_B['eta']\n\n        # Calculate equilibrium charge on atom B (in units of elementary charge e)\n        # q_B = (chi_A - chi_B) / (eta_A + eta_B)\n        # A check to prevent division by zero, although not expected here\n        # as hardness (eta) is positive.\n        denominator = eta_A + eta_B\n        if denominator == 0:\n            # This case applies for homonuclear diatomics if chi values are identical.\n            # Charge transfer is zero.\n            q_B = 0.0\n        else:\n            q_B = (chi_A - chi_B) / denominator\n\n        # Calculate dipole moment along the bond axis (in e.Angstrom)\n        # mu_z = q_B * R\n        mu_z_eA = q_B * R\n\n        # Convert dipole moment to Debye\n        mu_z_debye = mu_z_eA * E_ANGSTROM_TO_DEBYE\n\n        # The problem asks for the result rounded to three decimal places.\n        # We use a formatted string to ensure this.\n        results.append(f\"{mu_z_debye:.3f}\")\n\n    # Print the final output in the required format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2451497"}, {"introduction": "真实世界的化学样品由大量分子组成，这些分子以不同的构象存在，并且不断运动。这个关于正丁烷的练习将演示如何将单分子的能量计算与统计力学相结合，来预测物质的宏观性质。你将计算不同构象异构体的能量和偶极矩，并利用玻尔兹曼分布来预测样品的表观偶极矩是如何随温度变化的，从而架起连接微观分子世界与宏观可观测属性的桥梁 [@problem_id:2451507]。", "problem": "一个由四个碳位点组成的中性分子被用来近似正丁烷（$n$-butane）的构象性质。考虑了两种构象异构体：反式（anti）构象异构体，其中心 $\\mathrm{C}-\\mathrm{C}$ 键的二面角 $\\phi_{\\text{anti}} = 180^{\\circ}$；以及邻位（gauche）构象异构体，其二面角 $\\phi_{\\text{gauche}} = 60^{\\circ}$。对于这两种构象异构体，四个碳原子核的位置由内坐标构建如下。\n\n设碳-碳键长为 $r_{\\mathrm{CC}}$（单位为 $\\mathrm{\\AA}$），碳-碳-碳键角为 $\\theta$（单位为度）。在笛卡尔空间中定义前三个碳原子的位置为\n- $\\mathbf{r}_1 = (0,0,0)$,\n- $\\mathbf{r}_2 = (r_{\\mathrm{CC}},0,0)$,\n- $\\mathbf{r}_3 = \\mathbf{r}_2 + \\mathbf{d}_{23}$，其中 $\\mathbf{d}_{23} = \\left(r_{\\mathrm{CC}}\\cos(\\pi - \\theta_{\\mathrm{rad}}),\\; r_{\\mathrm{CC}}\\sin(\\pi - \\theta_{\\mathrm{rad}}),\\; 0\\right)$,\n\n其中 $\\theta_{\\mathrm{rad}}$ 是 $\\theta$ 转换为弧度的值。第四个碳原子的位置 $\\mathbf{r}_4$ 是根据相对于 $(\\mathbf{r}_1,\\mathbf{r}_2,\\mathbf{r}_3)$ 的内坐标 $(r_{\\mathrm{CC}}, \\theta, \\phi)$ 构建的，公式如下：\n$$\n\\begin{aligned}\n\\mathbf{e}_1 = \\frac{\\mathbf{r}_2 - \\mathbf{r}_3}{\\lVert \\mathbf{r}_2 - \\mathbf{r}_3 \\rVert},\\quad\n\\mathbf{e}_2^{\\prime} = \\frac{\\mathbf{r}_1 - \\mathbf{r}_2}{\\lVert \\mathbf{r}_1 - \\mathbf{r}_2 \\rVert},\\quad\n\\mathbf{n} = \\frac{\\mathbf{e}_2^{\\prime} \\times \\mathbf{e}_1}{\\lVert \\mathbf{e}_2^{\\prime} \\times \\mathbf{e}_1 \\rVert},\\quad\n\\mathbf{e}_2 = \\mathbf{n} \\times \\mathbf{e}_1, \\\\\n\\theta_{\\mathrm{rad}} = \\theta \\times \\frac{\\pi}{180},\\quad \\phi_{\\mathrm{rad}} = \\phi \\times \\frac{\\pi}{180}, \\\\\n\\mathbf{r}_4 = \\mathbf{r}_3 + r_{\\mathrm{CC}}\\left(-\\cos\\theta_{\\mathrm{rad}}\\,\\mathbf{e}_1 + \\sin\\theta_{\\mathrm{rad}} \\left(\\cos\\phi_{\\mathrm{rad}}\\,\\mathbf{e}_2 + \\sin\\phi_{\\mathrm{rad}}\\,\\mathbf{n}\\right)\\right).\n\\end{aligned}\n$$\n\n使用位于碳位点上的四个点电荷来近似每个构象异构体的永久电偶极矩 $\\boldsymbol{\\mu}$。部分电荷（以基本电荷 $e$ 为单位）为 $\\left[q_1,q_2,q_3,q_4\\right] = \\left[+\\delta,-\\delta,-\\delta,+\\delta\\right]$，因此净电荷为零。偶极矩矢量为\n$$\n\\boldsymbol{\\mu} = \\sum_{i=1}^{4} q_i\\,\\mathbf{r}_i,\n$$\n单位为 $e\\cdot\\mathrm{\\AA}$。其以德拜（Debye）为单位的大小由下式给出\n$$\n\\mu\\,(\\mathrm{D}) = \\lVert \\boldsymbol{\\mu} \\rVert \\times \\left(4.80320427\\,\\frac{\\mathrm{D}}{e\\cdot\\mathrm{\\AA}}\\right).\n$$\n\n构象能量作为二面角 $\\phi$（单位为弧度）的函数，由截断的傅里叶扭转势建模：\n$$\nE(\\phi) = V_1 \\cos\\phi + V_2 \\cos(2\\phi) + V_3 \\cos(3\\phi),\n$$\n其中 $V_1$、$V_2$ 和 $V_3$ 的单位为 $\\mathrm{kcal}\\,\\mathrm{mol}^{-1}$。使用 $1\\,\\mathrm{kcal}\\,\\mathrm{mol}^{-1} = 4.184\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$ 将能量转换为 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$。\n\n令 $E_{\\text{anti}} = E(\\phi_{\\text{anti}})$ 和 $E_{\\text{gauche}} = E(\\phi_{\\text{gauche}})$。需要报告的能量差为\n$$\n\\Delta E = E_{\\text{gauche}} - E_{\\text{anti}}\n$$\n单位为 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$。\n\n假设在绝对温度 $T$（单位为开尔文）下存在一个热力学系综，其中仅包含反式构象异构体和两个简并的邻位构象异构体（$\\phi = +60^{\\circ}$ 和 $\\phi = -60^{\\circ}$）。简并度分别为 $g_{\\text{anti}} = 1$ 和 $g_{\\text{gauche}} = 2$。使用理想气体常数 $R = 8.314462618\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$ 和单位为 $\\mathrm{J}\\,\\mathrm{mol}^{-1}$ 的能量，定义玻尔兹曼概率：\n$$\np_{\\text{anti}}(T) = \\frac{g_{\\text{anti}}\\,e^{-E_{\\text{anti}}/(RT)}}{g_{\\text{anti}}\\,e^{-E_{\\text{anti}}/(RT)} + g_{\\text{gauche}}\\,e^{-E_{\\text{gauche}}/(RT)}},\\quad\np_{\\text{gauche}}(T) = \\frac{g_{\\text{gauche}}\\,e^{-E_{\\text{gauche}}/(RT)}}{g_{\\text{anti}}\\,e^{-E_{\\text{anti}}/(RT)} + g_{\\text{gauche}}\\,e^{-E_{\\text{gauche}}/(RT)}}.\n$$\n\n样本的表观偶极矩大小在此定义为均方根偶极矩，\n$$\n\\mu_{\\mathrm{rms}}(T) = \\sqrt{p_{\\text{anti}}(T)\\,\\mu_{\\text{anti}}^2 + p_{\\text{gauche}}(T)\\,\\mu_{\\text{gauche}}^2},\n$$\n单位为德拜。角度在指定时必须使用度；在需要时转换为弧度。能量必须以 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$ 报告，偶极矩大小以德拜（D）报告，温度以开尔文报告。\n\n测试组。对于下面的每个参数集，计算：\n- 能量差 $\\Delta E$，单位 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$，\n- 偶极矩大小 $\\mu_{\\text{anti}}$ 和 $\\mu_{\\text{gauche}}$，单位德拜，\n- 表观偶极矩大小 $\\mu_{\\mathrm{rms}}(200\\,\\mathrm{K})$ 和 $\\mu_{\\mathrm{rms}}(500\\,\\mathrm{K})$，单位德拜。\n\n参数集：\n1) $\\delta = 0.10$, $r_{\\mathrm{CC}} = 1.540\\,\\mathrm{\\AA}$, $\\theta = 112.0^{\\circ}$, $V_1 = 0.0$, $V_2 = -0.4$, $V_3 = 0.6$ (所有 $V_i$ 单位均为 $\\mathrm{kcal}\\,\\mathrm{mol}^{-1}$)。\n2) $\\delta = 0.00$, $r_{\\mathrm{CC}} = 1.540\\,\\mathrm{\\AA}$, $\\theta = 112.0^{\\circ}$, $V_1 = 0.0$, $V_2 = -0.4$, $V_3 = 0.6$ (所有 $V_i$ 单位均为 $\\mathrm{kcal}\\,\\mathrm{mol}^{-1}$)。\n3) $\\delta = 0.20$, $r_{\\mathrm{CC}} = 1.540\\,\\mathrm{\\AA}$, $\\theta = 110.0^{\\circ}$, $V_1 = 0.0$, $V_2 = -0.2$, $V_3 = 0.4$ (所有 $V_i$ 单位均为 $\\mathrm{kcal}\\,\\mathrm{mol}^{-1}$)。\n\n最终输出格式。您的程序应生成单行输出，其中包含一个由三个五元列表组成的逗号分隔列表，每个列表对应一个参数集，每个集合中元素的顺序必须完全如下：\n$$\n[\\Delta E,\\ \\mu_{\\text{anti}},\\ \\mu_{\\text{gauche}},\\ \\mu_{\\mathrm{rms}}(200\\,\\mathrm{K}),\\ \\mu_{\\mathrm{rms}}(500\\,\\mathrm{K})].\n$$\n对于整个测试组，打印单行：\n$$\n\\big[ [\\cdot,\\cdot,\\cdot,\\cdot,\\cdot],\\ [\\cdot,\\cdot,\\cdot,\\cdot,\\cdot],\\ [\\cdot,\\cdot,\\cdot,\\cdot,\\cdot] \\big].\n$$\n所有浮点数必须使用上述指定的单位表示。", "solution": "该任务要求从内坐标构建构象异构体的几何结构，从点电荷计算构象异构体的偶极矩，从扭转势评估构象异构体的能量，然后根据玻尔兹曼统计预测与温度相关的表观偶极矩大小。\n\n几何结构构建。放置 $\\mathbf{r}_1 = (0,0,0)$ 和 $\\mathbf{r}_2 = (r_{\\mathrm{CC}},0,0)$。第三个碳原子 $\\mathbf{r}_3$ 位于由前两个原子定义的 $xy$ 平面内，相对于 $\\mathrm{C}_1-\\mathrm{C}_2-\\mathrm{C}_3$ 角的键角为 $\\theta$。使用 $\\theta_{\\mathrm{rad}} = \\theta \\pi/180$，\n$$\n\\mathbf{d}_{23} = \\left(r_{\\mathrm{CC}}\\cos(\\pi - \\theta_{\\mathrm{rad}}),\\ r_{\\mathrm{CC}}\\sin(\\pi - \\theta_{\\mathrm{rad}}),\\ 0\\right) = \\left(-r_{\\mathrm{CC}}\\cos\\theta_{\\mathrm{rad}},\\ r_{\\mathrm{CC}}\\sin\\theta_{\\mathrm{rad}},\\ 0\\right).\n$$\n那么 $\\mathbf{r}_3 = \\mathbf{r}_2 + \\mathbf{d}_{23}$。第四个碳原子位置 $\\mathbf{r}_4$ 是通过标准的内坐标到笛卡尔坐标映射构建的。定义沿键方向的单位矢量和平面法线：\n$$\n\\mathbf{e}_1 = \\frac{\\mathbf{r}_2 - \\mathbf{r}_3}{\\lVert \\mathbf{r}_2 - \\mathbf{r}_3 \\rVert},\\quad\n\\mathbf{e}_2^{\\prime} = \\frac{\\mathbf{r}_1 - \\mathbf{r}_2}{\\lVert \\mathbf{r}_1 - \\mathbf{r}_2 \\rVert},\\quad\n\\mathbf{n} = \\frac{\\mathbf{e}_2^{\\prime} \\times \\mathbf{e}_1}{\\lVert \\mathbf{e}_2^{\\prime} \\times \\mathbf{e}_1 \\rVert},\\quad\n\\mathbf{e}_2 = \\mathbf{n} \\times \\mathbf{e}_1.\n$$\n对于给定的键长 $r_{\\mathrm{CC}}$、键角 $\\theta$ 和二面角 $\\phi$，其中两个角度都转换为弧度，其位置为\n$$\n\\mathbf{r}_4 = \\mathbf{r}_3 + r_{\\mathrm{CC}}\\left(-\\cos\\theta_{\\mathrm{rad}}\\,\\mathbf{e}_1 + \\sin\\theta_{\\mathrm{rad}} \\left(\\cos\\phi_{\\mathrm{rad}}\\,\\mathbf{e}_2 + \\sin\\phi_{\\mathrm{rad}}\\,\\mathbf{n}\\right)\\right).\n$$\n选择 $\\phi_{\\text{anti}} = \\pi$ 和 $\\phi_{\\text{gauche}} = \\pi/3$ 分别得到平面的反式构象和扭斜的邻位构象几何结构。\n\n偶极矩。使用部分电荷 $\\left[q_1,q_2,q_3,q_4\\right] = \\left[+\\delta,-\\delta,-\\delta,+\\delta\\right]$（以基本电荷为单位），分子偶极矩矢量（单位为 $e\\cdot\\mathrm{\\AA}$）为\n$$\n\\boldsymbol{\\mu} = \\sum_{i=1}^{4} q_i\\,\\mathbf{r}_i.\n$$\n因为总电荷为零，所以 $\\boldsymbol{\\mu}$ 与原点的选择无关。以德拜为单位的大小为\n$$\n\\mu\\,(\\mathrm{D}) = \\lVert \\boldsymbol{\\mu} \\rVert \\times 4.80320427.\n$$\n对于反式构象异构体，当其几何结构由相等的键长和键角构建时，在内侧键的中点处存在一个反演中心，电荷分布在反演操作下保持不变，导致 $\\boldsymbol{\\mu} \\approx \\mathbf{0}$。邻位构象异构体缺少反演对称性，会产生一个非零的 $\\mu$，其大小随 $\\delta$ 的增加而增加，并取决于几何结构。\n\n构象异构体能量与能量差。扭转势定义为\n$$\nE(\\phi) = V_1 \\cos\\phi + V_2 \\cos(2\\phi) + V_3 \\cos(3\\phi),\n$$\n其中 $V_i$ 的单位为 $\\mathrm{kcal}\\,\\mathrm{mol}^{-1}$。计算在 $\\phi_{\\text{anti}}$ 和 $\\phi_{\\text{gauche}}$ 处的能量，通过乘以 $4.184$ 转换为 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$，并报告其能量差\n$$\n\\Delta E = E_{\\text{gauche}} - E_{\\text{anti}}\n$$\n单位为 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$。所选参数产生 $E_{\\text{anti}}  E_{\\text{gauche}}$，这是一种典型的类似烷烃的反式构象异构体的稳定化效应。\n\n热力学布居与表观偶极矩。在温度 $T$ 下，使用简并度 $g_{\\text{anti}}=1$ 和 $g_{\\text{gauche}}=2$ 来表示两个等价的邻位状态，这些状态的配分函数是\n$$\nZ = g_{\\text{anti}}\\,e^{-E_{\\text{anti}}/(RT)} + g_{\\text{gauche}}\\,e^{-E_{\\text{gauche}}/(RT)},\n$$\n其概率为\n$$\np_{\\text{anti}} = \\frac{g_{\\text{anti}}\\,e^{-E_{\\text{anti}}/(RT)}}{Z},\\quad\np_{\\text{gauche}} = \\frac{g_{\\text{gauche}}\\,e^{-E_{\\text{gauche}}/(RT)}}{Z}.\n$$\n因为系综是各向同性的，矢量平均偶极矩为零，与方向平均可观测量相关的表观大小是均方根偶极矩\n$$\n\\mu_{\\mathrm{rms}}(T) = \\sqrt{p_{\\text{anti}}(T)\\,\\mu_{\\text{anti}}^2 + p_{\\text{gauche}}(T)\\,\\mu_{\\text{gauche}}^2}.\n$$\n\n算法实现。对于每个测试用例：构建 $\\mathbf{r}_1,\\mathbf{r}_2,\\mathbf{r}_3$ 然后为 $\\phi_{\\text{anti}}$ 和 $\\phi_{\\text{gauche}}$ 构建 $\\mathbf{r}_4$；根据电荷和位置计算 $\\mu_{\\text{anti}}$ 和 $\\mu_{\\text{gauche}}$；评估 $E_{\\text{anti}}$ 和 $E_{\\text{gauche}}$，转换为 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$，并计算 $\\Delta E$；在 $T=200\\,\\mathrm{K}$ 和 $T=500\\,\\mathrm{K}$ 时使用 $R=8.314462618\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$ 和转换为 $\\mathrm{J}\\,\\mathrm{mol}^{-1}$ 的能量计算 $p_{\\text{anti}}(T)$ 和 $p_{\\text{gauche}}(T)$；最后在两个温度下计算 $\\mu_{\\mathrm{rms}}(T)$。为每个测试用例报告五元组 $[\\Delta E,\\ \\mu_{\\text{anti}},\\ \\mu_{\\text{gauche}},\\ \\mu_{\\mathrm{rms}}(200\\,\\mathrm{K}),\\ \\mu_{\\mathrm{rms}}(500\\,\\mathrm{K})]$，使用指定单位，并将它们聚合成单行列表。", "answer": "```python\nimport numpy as np\n\n# Constants\nDEBYE_PER_E_ANG = 4.80320427  # 1 e*Angstrom = 4.80320427 Debye\nKCAL_TO_KJ = 4.184            # 1 kcal/mol = 4.184 kJ/mol\nR_J_PER_MOLK = 8.314462618    # Gas constant in J/(mol*K)\n\ndef deg2rad(deg: float) - float:\n    return deg * np.pi / 180.0\n\ndef unit(v: np.ndarray) - np.ndarray:\n    n = np.linalg.norm(v)\n    if n == 0.0:\n        return v\n    return v / n\n\ndef build_initial_three(r_cc: float, theta_deg: float):\n    # r1 at origin, r2 on x-axis, r3 in xy-plane\n    r1 = np.array([0.0, 0.0, 0.0])\n    r2 = np.array([r_cc, 0.0, 0.0])\n    theta = deg2rad(theta_deg)\n    d23 = np.array([r_cc * np.cos(np.pi - theta), r_cc * np.sin(np.pi - theta), 0.0])\n    r3 = r2 + d23\n    return r1, r2, r3\n\ndef place_fourth(r1: np.ndarray, r2: np.ndarray, r3: np.ndarray,\n                 r_cc: float, theta_deg: float, dihedral_deg: float) - np.ndarray:\n    theta = deg2rad(theta_deg)\n    phi = deg2rad(dihedral_deg)\n    e1 = unit(r2 - r3)\n    e2p = unit(r1 - r2)\n    n = unit(np.cross(e2p, e1))\n    # Handle potential collinearity by adjusting n if needed\n    if np.linalg.norm(n) == 0.0:\n        # In rare degenerate cases, pick an arbitrary perpendicular\n        # Choose a vector not parallel to e1\n        tmp = np.array([1.0, 0.0, 0.0])\n        if abs(np.dot(e1, tmp))  0.99:\n            tmp = np.array([0.0, 1.0, 0.0])\n        n = unit(np.cross(tmp, e1))\n    e2 = np.cross(n, e1)\n    r4 = r3 + r_cc * (-np.cos(theta) * e1 + np.sin(theta) * (np.cos(phi) * e2 + np.sin(phi) * n))\n    return r4\n\ndef dipole_magnitude_debye(positions: np.ndarray, charges_e: np.ndarray) - float:\n    # positions: (N,3), charges: (N,)\n    mu_vec_eA = (charges_e[:, None] * positions).sum(axis=0)\n    mu_mag_debye = np.linalg.norm(mu_vec_eA) * DEBYE_PER_E_ANG\n    return mu_mag_debye\n\ndef torsion_energy_kj_per_mol(phi_deg: float, V1_kcal: float, V2_kcal: float, V3_kcal: float) - float:\n    phi = deg2rad(phi_deg)\n    E_kcal = V1_kcal * np.cos(phi) + V2_kcal * np.cos(2.0 * phi) + V3_kcal * np.cos(3.0 * phi)\n    return E_kcal * KCAL_TO_KJ\n\ndef boltzmann_populations(E_anti_kJ: float, E_gauche_kJ: float, T: float):\n    # Include degeneracy: g_anti=1, g_gauche=2\n    g_anti = 1.0\n    g_gauche = 2.0\n    # Convert energies to J/mol\n    Ea = E_anti_kJ * 1000.0\n    Eg = E_gauche_kJ * 1000.0\n    beta = 1.0 / (R_J_PER_MOLK * T)\n    wa = g_anti * np.exp(-beta * Ea)\n    wg = g_gauche * np.exp(-beta * Eg)\n    Z = wa + wg\n    pa = wa / Z\n    pg = wg / Z\n    return pa, pg\n\ndef compute_case(delta_e: float, r_cc: float, theta_deg: float, V1: float, V2: float, V3: float):\n    # Build coordinates for anti and gauche\n    r1, r2, r3 = build_initial_three(r_cc, theta_deg)\n    r4_anti = place_fourth(r1, r2, r3, r_cc, theta_deg, 180.0)\n    r4_gauche = place_fourth(r1, r2, r3, r_cc, theta_deg, 60.0)\n    # Charges on carbons\n    charges = np.array([+delta_e, -delta_e, -delta_e, +delta_e])\n    # Positions arrays\n    pos_anti = np.vstack([r1, r2, r3, r4_anti])\n    pos_gauche = np.vstack([r1, r2, r3, r4_gauche])\n    # Dipoles\n    mu_anti = dipole_magnitude_debye(pos_anti, charges)\n    mu_gauche = dipole_magnitude_debye(pos_gauche, charges)\n    # Energies\n    E_anti_kJ = torsion_energy_kj_per_mol(180.0, V1, V2, V3)\n    E_gauche_kJ = torsion_energy_kj_per_mol(60.0, V1, V2, V3)\n    deltaE_kJ = E_gauche_kJ - E_anti_kJ\n    # Apparent dipoles at 200 K and 500 K\n    results = []\n    for T in (200.0, 500.0):\n        p_anti, p_gauche = boltzmann_populations(E_anti_kJ, E_gauche_kJ, T)\n        mu_rms = np.sqrt(p_anti * (mu_anti ** 2) + p_gauche * (mu_gauche ** 2))\n        results.append(mu_rms)\n    mu_rms_200, mu_rms_500 = results\n    return [deltaE_kJ, mu_anti, mu_gauche, mu_rms_200, mu_rms_500]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each tuple: (delta, r_cc, theta_deg, V1, V2, V3)\n    test_cases = [\n        (0.10, 1.540, 112.0, 0.0, -0.4, 0.6),\n        (0.00, 1.540, 112.0, 0.0, -0.4, 0.6),\n        (0.20, 1.540, 110.0, 0.0, -0.2, 0.4),\n    ]\n\n    results = []\n    for case in test_cases:\n        delta, r_cc, theta_deg, V1, V2, V3 = case\n        res = compute_case(delta, r_cc, theta_deg, V1, V2, V3)\n        # Format to a reasonable number of decimals for readability\n        res_fmt = [float(f\"{x:.6f}\") for x in res]\n        results.append(res_fmt)\n\n    # Final print statement in the exact required format.\n    print(f\"{results}\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2451507"}]}