{"hands_on_practices": [{"introduction": "要想真正掌握任何计算方法，理解其数学基础至关重要。本练习将指导您从第一性原理出发，为一个简单的双原子分子推导 Mulliken 原子电荷。通过这个代数过程，您将清楚地看到 Mulliken 分析是如何划分总电子密度并处理关键的重叠布居的 [@problem_id:2449473]。", "problem": "考虑一个双原子分子 $A\\!-\\!B$，它在一个由两个实的、归一化但非正交的基函数 $\\,\\phi_{A}\\,$ 和 $\\,\\phi_{B}\\,$ 组成的最小原子轨道基组中表示，这两个基函数分别以原子核 $A$ 和 $B$ 为中心。设重叠积分为 $S_{AA}=S_{BB}=1$ 和 $S_{AB}=S_{BA}$，其中 $0  S_{AB}  1$。密度矩阵 $P$ 是实的、对称的。从这些信息中，以原子核电荷 $Z_{A}, Z_{B}$ 和密度矩阵与重叠矩阵的元素为变量，推导出一对马利肯原子电荷 $(q_{A}, q_{B})$ 的表达式。用有序对的形式给出你的最终答案。", "solution": "该问题陈述已经过验证，具有科学依据，表述清晰且客观。它代表了计算化学理论中的一个标准练习。\n\n马利肯原子电荷的推导始于非正交基组中单粒子密度矩阵 $P$、重叠矩阵 $S$ 和总电子数 $N$ 之间的基本关系。总电子数由密度矩阵和重叠矩阵乘积的迹给出：\n$$ N = \\mathrm{Tr}(PS) = \\sum_{\\mu, \\nu} P_{\\mu \\nu} S_{\\nu \\mu} $$\n在给定的由两个原子轨道 $\\phi_{A}$ 和 $\\phi_{B}$ 组成的最小基组中，密度矩阵 $P$ 和重叠矩阵 $S$ 是 $2 \\times 2$ 的矩阵。问题陈述指出 $P$ 是实的、对称的，且基函数是归一化的。这些矩阵具体如下：\n$$ P = \\begin{pmatrix} P_{AA}  P_{AB} \\\\ P_{BA}  P_{BB} \\end{pmatrix} = \\begin{pmatrix} P_{AA}  P_{AB} \\\\ P_{AB}  P_{BB} \\end{pmatrix} $$\n$$ S = \\begin{pmatrix} S_{AA}  S_{AB} \\\\ S_{BA}  S_{BB} \\end{pmatrix} = \\begin{pmatrix} 1  S_{AB} \\\\ S_{AB}  1 \\end{pmatrix} $$\n总电子数 $N$ 可以通过展开求和来计算：\n$$ N = \\sum_{\\mu, \\nu=\\{A,B\\}} P_{\\mu \\nu} S_{\\nu \\mu} = P_{AA}S_{AA} + P_{AB}S_{BA} + P_{BA}S_{AB} + P_{BB}S_{BB} $$\n代入给定值 $S_{AA}=S_{BB}=1$ 以及对称性 $P_{BA}=P_{AB}$ 和 $S_{BA}=S_{AB}$：\n$$ N = P_{AA}(1) + P_{AB}S_{AB} + P_{AB}S_{AB} + P_{BB}(1) = P_{AA} + P_{BB} + 2P_{AB}S_{AB} $$\n马利肯布居分析将总电子数 $N$ 分配给构成原子。原子 $k$ 上的总电子布居 $N_k$ 定义为对以该原子为中心的所有原子轨道 $\\phi_{\\mu}$ 的布居数求和。形式上，这等价于对布居矩阵 $PS$ 中对应于以原子 $k$ 为中心的基函数的行元素求和：\n$$ N_k = \\sum_{\\mu \\in k} \\sum_{\\nu} P_{\\mu \\nu} S_{\\nu \\mu} $$\n对于最小基组中的双原子分子 $A-B$，原子 $A$ 仅与基函数 $\\phi_A$ 相关联，因此求和 $\\sum_{\\mu \\in A}$ 只包含 $\\mu = A$ 这一项。原子 $A$ 上的总电子布居，记为 $N_A$，是：\n$$ N_A = \\sum_{\\nu=\\{A,B\\}} P_{A \\nu} S_{\\nu A} = P_{AA}S_{AA} + P_{AB}S_{BA} $$\n代入已知值 $S_{AA}=1$ 和 $S_{BA}=S_{AB}$：\n$$ N_A = P_{AA}(1) + P_{AB}S_{AB} = P_{AA} + P_{AB}S_{AB} $$\n类似地，对于仅与 $\\phi_B$ 相关联的原子 $B$，其总电子布居 $N_B$ 是：\n$$ N_B = \\sum_{\\nu=\\{A,B\\}} P_{B \\nu} S_{\\nu B} = P_{BA}S_{AB} + P_{BB}S_{BB} $$\n代入已知值 $P_{BA}=P_{AB}$ 和 $S_{BB}=1$：\n$$ N_B = P_{AB}S_{AB} + P_{BB}(1) = P_{BB} + P_{AB}S_{AB} $$\n作为一致性检查，总原子布居之和必须恢复为总电子数：\n$$ N_A + N_B = (P_{AA} + P_{AB}S_{AB}) + (P_{BB} + P_{AB}S_{AB}) = P_{AA} + P_{BB} + 2P_{AB}S_{AB} = N $$\n该分配是一致的。原子 $k$ 上的马利肯原子电荷 $q_k$ 定义为其核电荷 $Z_k$ 与其总电子布居 $N_k$ 之差：\n$$ q_k = Z_k - N_k $$\n将此定义应用于原子 $A$：\n$$ q_A = Z_A - N_A = Z_A - (P_{AA} + P_{AB}S_{AB}) $$\n$$ q_A = Z_A - P_{AA} - P_{AB}S_{AB} $$\n对于原子 $B$：\n$$ q_B = Z_B - N_B = Z_B - (P_{BB} + P_{AB}S_{AB}) $$\n$$ q_B = Z_B - P_{BB} - P_{AB}S_{AB} $$\n这些就是马利肯原子电荷的闭合形式表达式。最终答案是有序对 $(q_A, q_B)$。", "answer": "$$\n\\boxed{\\begin{pmatrix} Z_A - P_{AA} - P_{AB}S_{AB}  Z_B - P_{BB} - P_{AB}S_{AB} \\end{pmatrix}}\n$$", "id": "2449473"}, {"introduction": "虽然 Mulliken 分析很直观，但其结果对基组的选择可能高度敏感。Löwdin 布居分析通过首先将原子轨道变换为一组正交轨道，提供了一种更稳健的替代方案。本练习将从符号推导转向具体的数值计算，您将计算 Löwdin 电荷，并亲身体验对称正交化过程 [@problem_id:2449509]。", "problem": "考虑一个包含两个电子的异核双原子阳离子，该阳离子在一个由两个原子中心原子轨道 (AO) $\\{\\chi_{A}, \\chi_{B}\\}$（每个原子上一个）构成的最小基组中进行描述。原子标记为 $A$ 和 $B$，其核电荷分别为 $Z_{A}$ 和 $Z_{B}$。自旋求和的单粒子密度由一个单一的双占据分子轨道 (MO) 构建。原子轨道 (AO) 重叠矩阵为\n$$\nS \\;=\\; \\begin{pmatrix}\n1  0.2 \\\\\n0.2  1\n\\end{pmatrix}.\n$$\n设已占据分子轨道 (MO) 的未归一化 AO 系数向量为\n$$\nv \\;=\\; \\begin{pmatrix} 0.9 \\\\ 0.3 \\end{pmatrix},\n$$\n并令 $c \\,=\\, k\\,v$ 为归一化的 AO 系数向量，满足 $c^{\\mathsf T} S\\, c \\,=\\, 1$，其中 $k$ 为一个待定的标量。那么自旋求和的 AO 密度矩阵为 $P \\,=\\, 2\\, c\\, c^{\\mathsf T}$。\n\n使用对称正交化 (Löwdin) 方案，正交化变换由矩阵 $S^{-1/2}$ 定义，其中 $S^{\\pm 1/2}$ 表示正定矩阵的平方根及其逆。Löwdin 总原子布居数是 $S^{1/2} P S^{1/2}$ 的对角元素，也就是说，对于与 AO 顺序一致的原子标记，\n$$\n\\text{GP}_{A} \\,=\\, \\big(S^{1/2} P S^{1/2}\\big)_{11}, \\qquad\n\\text{GP}_{B} \\,=\\, \\big(S^{1/2} P S^{1/2}\\big)_{22}.\n$$\nLöwdin 原子电荷定义为\n$$\nq_{A} \\,=\\, Z_{A} \\;-\\; \\text{GP}_{A}, \\qquad\nq_{B} \\,=\\, Z_{B} \\;-\\; \\text{GP}_{B}.\n$$\n\n对于一个特定的体系，取 $Z_{A} \\,=\\, 2$ 和 $Z_{B} \\,=\\, 1$（因此，在基组中有两个电子时，总电荷为 $+1$）。从 $S$ 开始计算 $S^{-1/2}$，然后得到 $S^{1/2}$，并遵循上述定义，计算 Löwdin 原子电荷 $q_{A}$ 和 $q_{B}$。将最终答案以单行矩阵 $\\big(q_{A}\\;\\; q_{B}\\big)$ 的形式给出，并将结果四舍五入到四位有效数字。无需单位。", "solution": "问题陈述构成了计算量子化学中一个关于 Löwdin 布居分析的适定练习。所有提供的数据和定义在科学上都是合理的、一致的，并且足以推导出唯一的解。因此，我将继续进行计算。\n\n目标是计算一个双电子异核双原子阳离子的 Löwdin 原子电荷 $q_{A}$ 和 $q_{B}$。所提供的定义为：\n$$q_{A} = Z_{A} - \\text{GP}_{A}$$\n$$q_{B} = Z_{B} - \\text{GP}_{B}$$\n其中 $Z_{A} = 2$ 和 $Z_{B} = 1$ 是核电荷，$\\text{GP}_{A}$ 和 $\\text{GP}_{B}$ 是 Löwdin 总原子布居数。布居数是经过 Löwdin 变换的密度矩阵 $P' = S^{1/2} P S^{1/2}$ 的对角元素。\n\n计算按系统步骤进行。\n\n首先，未归一化的分子轨道 (MO) 系数向量 $v$ 必须被归一化。归一化条件是 $c^{\\mathsf T} S c = 1$，其中 $c = k v$ 是归一化的系数向量，$S$ 是原子轨道 (AO) 重叠矩阵。\n给定 $v = \\begin{pmatrix} 0.9 \\\\ 0.3 \\end{pmatrix}$ 和 $S = \\begin{pmatrix} 1  0.2 \\\\ 0.2  1 \\end{pmatrix}$，我们计算归一化因子 $k$。\n标量积为：\n$$v^{\\mathsf T} S v = \\begin{pmatrix} 0.9  0.3 \\end{pmatrix} \\begin{pmatrix} 1  0.2 \\\\ 0.2  1 \\end{pmatrix} \\begin{pmatrix} 0.9 \\\\ 0.3 \\end{pmatrix} = \\begin{pmatrix} 0.9  0.3 \\end{pmatrix} \\begin{pmatrix} 1 \\cdot 0.9 + 0.2 \\cdot 0.3 \\\\ 0.2 \\cdot 0.9 + 1 \\cdot 0.3 \\end{pmatrix} = \\begin{pmatrix} 0.9  0.3 \\end{pmatrix} \\begin{pmatrix} 0.96 \\\\ 0.48 \\end{pmatrix}$$\n$$v^{\\mathsf T} S v = 0.9 \\cdot 0.96 + 0.3 \\cdot 0.48 = 0.864 + 0.144 = 1.008$$\n归一化常数 $k$ 由 $k = (v^{\\mathsf T} S v)^{-1/2} = (1.008)^{-1/2}$ 给出。\n归一化的 MO 系数向量为 $c = (1.008)^{-1/2} v$。\n\n第二步，我们构建自旋求和的 AO 密度矩阵 $P$。对于单个双占据 MO，$P = 2 c c^{\\mathsf T}$。\n$$P = 2 \\left( (1.008)^{-1/2} v \\right) \\left( (1.008)^{-1/2} v^{\\mathsf T} \\right) = \\frac{2}{1.008} v v^{\\mathsf T}$$\n$$P = \\frac{2}{1.008} \\begin{pmatrix} 0.9 \\\\ 0.3 \\end{pmatrix} \\begin{pmatrix} 0.9  0.3 \\end{pmatrix} = \\frac{2}{1.008} \\begin{pmatrix} 0.81  0.27 \\\\ 0.27  0.09 \\end{pmatrix}$$\n\n第三步，我们必须求出矩阵 $S^{1/2}$。问题指定先求 $S^{-1/2}$。这需要对 $S$ 进行对角化。对于一个形如 $\\begin{pmatrix} 1  s \\\\ s  1 \\end{pmatrix}$ 的通用 $2 \\times 2$ 矩阵，其特征值为 $\\lambda_{1,2} = 1 \\pm s$。对于 $S$，当 $s=0.2$ 时，特征值为 $\\lambda_{1} = 1.2$ 和 $\\lambda_{2} = 0.8$。相应的归一化特征向量为 $u_{1} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$ 和 $u_{2} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$。\n特征向量矩阵为 $U = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1  1 \\\\ 1  -1 \\end{pmatrix}$。\n$S$ 的谱分解为 $S = U D U^{\\mathsf T}$，其中 $D = \\text{diag}(1.2, 0.8)$。\n对于任意幂 $f$，矩阵 $S^{f}$ 由 $S^{f} = U D^{f} U^{\\mathsf T}$ 给出。\n按照说明，$S^{-1/2} = U D^{-1/2} U^{\\mathsf T}$，其中 $D^{-1/2} = \\text{diag}(1/\\sqrt{1.2}, 1/\\sqrt{0.8})$。\n矩阵 $S^{1/2}$ 是 $S^{-1/2}$ 的逆，或者等价地，可以直接计算为 $S^{1/2} = U D^{1/2} U^{\\mathsf T}$，其中 $D^{1/2} = \\text{diag}(\\sqrt{1.2}, \\sqrt{0.8})$。\n$$S^{1/2} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1  1 \\\\ 1  -1 \\end{pmatrix} \\begin{pmatrix} \\sqrt{1.2}  0 \\\\ 0  \\sqrt{0.8} \\end{pmatrix} \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1  1 \\\\ 1  -1 \\end{pmatrix} = \\frac{1}{2} \\begin{pmatrix} \\sqrt{1.2}+\\sqrt{0.8}  \\sqrt{1.2}-\\sqrt{0.8} \\\\ \\sqrt{1.2}-\\sqrt{0.8}  \\sqrt{1.2}+\\sqrt{0.8} \\end{pmatrix}$$\n让我们定义 $A = \\frac{1}{2}(\\sqrt{1.2}+\\sqrt{0.8})$ 和 $B = \\frac{1}{2}(\\sqrt{1.2}-\\sqrt{0.8})$。那么 $S^{1/2} = \\begin{pmatrix} A  B \\\\ B  A \\end{pmatrix}$。\n\n第四步，我们计算 Löwdin 总原子布居数，它们是 $P' = S^{1/2} P S^{1/2}$ 的对角元素。\n$$\\text{GP}_{A} = (S^{1/2} P S^{1/2})_{11} = \\begin{pmatrix} A  B \\end{pmatrix} P \\begin{pmatrix} A \\\\ B \\end{pmatrix}$$\n$$\\text{GP}_{B} = (S^{1/2} P S^{1/2})_{22} = \\begin{pmatrix} B  A \\end{pmatrix} P \\begin{pmatrix} B \\\\ A \\end{pmatrix}$$\n代入 $P$ 的表达式：\n$$\\text{GP}_{A} = \\frac{2}{1.008} \\begin{pmatrix} A  B \\end{pmatrix} \\begin{pmatrix} 0.81  0.27 \\\\ 0.27  0.09 \\end{pmatrix} \\begin{pmatrix} A \\\\ B \\end{pmatrix} = \\frac{2}{1.008} (0.81 A^2 + 0.54 AB + 0.09 B^2)$$\n我们计算必要的组成部分：\n$$A^2 = \\frac{1}{4}(1.2 + 0.8 + 2\\sqrt{1.2 \\cdot 0.8}) = \\frac{1}{2}(1 + \\sqrt{0.96})$$\n$$B^2 = \\frac{1}{4}(1.2 + 0.8 - 2\\sqrt{1.2 \\cdot 0.8}) = \\frac{1}{2}(1 - \\sqrt{0.96})$$\n$$AB = \\frac{1}{4}(1.2 - 0.8) = \\frac{0.4}{4} = 0.1$$\n将这些代入 $\\text{GP}_{A}$ 的表达式中：\n$$0.81 A^2 + 0.54 AB + 0.09 B^2 = 0.81 \\cdot \\frac{1}{2}(1+\\sqrt{0.96}) + 0.54(0.1) + 0.09 \\cdot \\frac{1}{2}(1-\\sqrt{0.96})$$\n$$= 0.405(1+\\sqrt{0.96}) + 0.054 + 0.045(1-\\sqrt{0.96})$$\n$$= 0.405 + 0.405\\sqrt{0.96} + 0.054 + 0.045 - 0.045\\sqrt{0.96}$$\n$$= 0.504 + 0.36\\sqrt{0.96}$$\n所以，$\\text{GP}_{A} = \\frac{2}{1.008} (0.504 + 0.36\\sqrt{0.96}) = \\frac{1}{0.504} (0.504 + 0.36\\sqrt{0.96}) = 1 + \\frac{0.36}{0.504}\\sqrt{0.96} = 1 + \\frac{5}{7}\\sqrt{0.96}$。\n通过直接计算，可得 $\\text{GP}_{B} = 1 - \\frac{5}{7}\\sqrt{0.96}$。\n\n第五步，我们计算布居数的数值，然后计算电荷。\n使用 $\\sqrt{0.96} \\approx 0.9797959$：\n$$\\frac{5}{7}\\sqrt{0.96} \\approx \\frac{5}{7} \\cdot 0.9797959 \\approx 0.6998542$$\n$$\\text{GP}_{A} \\approx 1 + 0.6998542 = 1.6998542$$\n$$\\text{GP}_{B} \\approx 1 - 0.6998542 = 0.3001458$$\n布居数之和为 $\\text{GP}_{A} + \\text{GP}_{B} = 2$，这正确地等于电子总数。\n\n最后，计算 Löwdin 原子电荷：\n$$q_{A} = Z_{A} - \\text{GP}_{A} = 2 - (1 + \\frac{5}{7}\\sqrt{0.96}) = 1 - \\frac{5}{7}\\sqrt{0.96} \\approx 1 - 0.6998542 = 0.3001458$$\n$$q_{B} = Z_{B} - \\text{GP}_{B} = 1 - (1 - \\frac{5}{7}\\sqrt{0.96}) = \\frac{5}{7}\\sqrt{0.96} \\approx 0.6998542$$\n总电荷为 $q_{A} + q_{B} = 1$，这与该体系是电荷为 $+1$ 的阳离子相符。\n\n将结果四舍五入到四位有效数字：\n$$q_{A} \\approx 0.3001$$\n$$q_{B} \\approx 0.6999$$\n最终答案以行矩阵的形式呈现。", "answer": "$$\\boxed{\\begin{pmatrix} 0.3001  0.6999 \\end{pmatrix}}$$", "id": "2449509"}, {"introduction": "我们已经学习了 Mulliken 和 Löwdin 电荷背后的理论；现在让我们对它们进行一次实践检验。这个计算实验要求您模拟每种电荷类型如何响应分子几何的微小变化。通过编写这个模拟程序，您将对为何 Löwdin 电荷在分析化学趋势时通常被认为更稳定可靠，有一个切实的理解 [@problem_id:2449471]。", "problem": "您必须编写一个完整的程序，该程序针对一个包含两个电子的异核双原子分子的最小双中心双原子轨道（AO）模型，量化计算出的原子电荷对核间距微小变化的敏感度。请使用以下基于物理的设置。\n\n定义与模型：\n- 设两个原子轨道（AO）分别以原子 $A$ 和 $B$ 为中心，每个轨道由一个归一化的斯莱特型1s函数描述，具有相同的斯莱特指数 $z$（单位为波尔半径的倒数）。核间距为 $R$（单位为波尔）。\n- AO重叠矩阵为 $S(R) \\in \\mathbb{R}^{2 \\times 2}$，其定义为\n  $$S(R) = \\begin{bmatrix} 1  s(R) \\\\ s(R)  1 \\end{bmatrix}, \\quad s(R) = e^{-z R} \\left( 1 + z R + \\frac{(z R)^2}{3} \\right).$$\n- 单电子哈密顿矩阵 $H(R) \\in \\mathbb{R}^{2 \\times 2}$（单位为哈特里）定义为\n  $$H(R) = \\begin{bmatrix} \\varepsilon_A  h_{AB}(R) \\\\ h_{AB}(R)  \\varepsilon_B \\end{bmatrix}, \\quad h_{AB}(R) = K \\, s(R) \\, \\frac{\\varepsilon_A + \\varepsilon_B}{2},$$\n  其中 $K$ 是一个无量纲常数。\n- 分子轨道（MO）系数 $C(R) \\in \\mathbb{R}^{2 \\times 2}$ 通过求解广义本征值问题得到\n  $$H(R) \\, C(R) = S(R) \\, C(R) \\, E(R),$$\n  其中 $E(R)$ 为对角矩阵，并满足 $S$-正交归一化约束 $C(R)^\\top S(R) C(R) = I$。将两个电子填充到能量最低的分子轨道中（闭壳层）。则AO密度矩阵为\n  $$P(R) = 2 \\, c_\\text{occ}(R) \\, c_\\text{occ}(R)^\\top,$$\n  其中 $c_\\text{occ}(R)$ 是 $C(R)$ 中已占据的分子轨道列向量。\n- Mulliken总原子布居定义为\n  $$g_\\mu^{\\mathrm{M}}(R) = \\sum_{\\nu=1}^{2} P_{\\mu\\nu}(R) \\, S_{\\nu\\mu}(R), \\quad \\mu \\in \\{1,2\\},$$\n  其中 $\\mu=1$ 对应原子 $A$，$\\mu=2$ 对应原子 $B$。Mulliken原子电荷为\n  $$q_A^{\\mathrm{M}}(R) = Z_A - g_1^{\\mathrm{M}}(R), \\quad q_B^{\\mathrm{M}}(R) = Z_B - g_2^{\\mathrm{M}}(R).$$\n- Löwdin对称正交化由正定矩阵平方根 $S(R)^{1/2}$ 定义，Löwdin总布居由以下矩阵的对角线元素得到\n  $$\\widetilde{P}(R) = S(R)^{1/2} \\, P(R) \\, S(R)^{1/2},$$\n  以及Löwdin电荷\n  $$q_A^{\\mathrm{L}}(R) = Z_A - \\widetilde{P}_{11}(R), \\quad q_B^{\\mathrm{L}}(R) = Z_B - \\widetilde{P}_{22}(R).$$\n\n参数：\n- 使用 $z = 1.24$（波尔半径的倒数），$\\varepsilon_A = -0.50$（哈特里），$\\varepsilon_B = -0.70$（哈特里），$K = 1.75$（无量纲），$Z_A = 1$，以及 $Z_B = 1$。\n- 所有距离 $R$ 的单位必须是波尔，所有能量的单位必须是哈特里。\n\n任务：\n- 对于下面的每个测试用例，包含一对核间距 $(R_1, R_2)$，计算在Mulliken分析下原子 $A$ 电荷的绝对变化量 $\\Delta^{\\mathrm{M}}_A = \\lvert q_A^{\\mathrm{M}}(R_2) - q_A^{\\mathrm{M}}(R_1) \\rvert$，以及在Löwdin分析下电荷的绝对变化量 $\\Delta^{\\mathrm{L}}_A = \\lvert q_A^{\\mathrm{L}}(R_2) - q_A^{\\mathrm{L}}(R_1) \\rvert$。对于每个用例，返回一个布尔值，指示是否满足 $\\Delta^{\\mathrm{L}}_A \\le \\Delta^{\\mathrm{M}}_A$。\n- 精确按照上述定义实现所有必需的线性代数运算。\n\n测试套件（每个项目都是一个探测不同区域的独立测试用例）：\n1. $(R_1, R_2) = (1.40, 1.45)$ 波尔。\n2. $(R_1, R_2) = (0.80, 0.82)$ 波尔。\n3. $(R_1, R_2) = (3.00, 3.10)$ 波尔。\n4. $(R_1, R_2) = (1.20, 1.21)$ 波尔。\n\n要求的最终输出格式：\n- 您的程序必须生成单行输出，其中包含四个测试用例的结果，格式为一个用方括号括起来的、逗号分隔的Python风格布尔值列表。例如，该行必须看起来像\n  $$[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4].$$\n不得打印任何其他文本。答案是无单位的布尔值；无需四舍五入。", "solution": "该问题陈述具有科学依据、良定、客观且自洽。它描述了一个基于量子化学既定原理的双原子分子的最小但标准的分子轨道模型。哈密顿量、重叠矩阵、密度矩阵以及Mulliken和Löwdin布居分析方法的定义都是正确和标准的。提供的参数在物理上是合理的。因此，该问题是有效的，可以推导出唯一的解。\n\n目标是量化和比较Mulliken和Löwdin原子电荷在原子 $A$ 上对核间距 $R$ 微小变化的敏感度。这是通过计算在给定距离变化 $\\Delta R = R_2 - R_1$ 下，两种不同电荷划分方案的电荷绝对变化量来完成的。任务的核心是实现一个函数，该函数能在特定距离 $R$ 下为一组给定参数计算电荷。对于每个测试用例，将分别对 $R_1$ 和 $R_2$ 调用此函数。\n\n在单个核间距 $R$ 处计算电荷的步骤如下：\n\n1.  **定义常数**：给出模型的物理参数：斯莱特指数 $z = 1.24$，原子轨道能量 $\\varepsilon_A = -0.50$ 哈特里和 $\\varepsilon_B = -0.70$ 哈特里，相互作用常数 $K = 1.75$，以及核电荷 $Z_A = 1$ 和 $Z_B = 1$。\n\n2.  **构造矩阵**：必须构造重叠矩阵 $S(R)$ 和单电子哈密顿矩阵 $H(R)$。\n    - 首先，使用提供的公式计算两个原子轨道之间的重叠积分 $s(R)$：\n      $$s(R) = e^{-z R} \\left( 1 + z R + \\frac{(z R)^2}{3} \\right)$$\n    - 然后，$2 \\times 2$ 的重叠矩阵 $S(R)$ 由下式给出：\n      $$S(R) = \\begin{bmatrix} 1  s(R) \\\\ s(R)  1 \\end{bmatrix}$$\n    - 哈密顿量的非对角元素 $h_{AB}(R)$ 计算如下：\n      $$h_{AB}(R) = K \\, s(R) \\, \\frac{\\varepsilon_A + \\varepsilon_B}{2}$$\n    - 然后，$2 \\times 2$ 的哈密顿矩阵 $H(R)$ 为：\n      $$H(R) = \\begin{bmatrix} \\varepsilon_A  h_{AB}(R) \\\\ h_{AB}(R)  \\varepsilon_B \\end{bmatrix}$$\n\n3.  **求解广义本征值问题**：通过求解Roothaan-Hall方程的广义本征值形式，找到分子轨道（MO）系数矩阵 $C(R)$ 和轨道能量矩阵 $E(R)$：\n    $$H(R) \\, C(R) = S(R) \\, C(R) \\, E(R)$$\n    该问题产生两个本征值 $E_1$ 和 $E_2$，它们是两个分子轨道的能量，以及它们对应的本征向量 $c_1$ 和 $c_2$。系统包含两个电子，根据构造原理（Aufbau principle），它们占据能量最低的分子轨道。设此轨道能量为 $E_\\text{occ}(R) = \\min(E_1, E_2)$，其关联的本征向量为 $c_\\text{occ}(R)$。此本征向量经过归一化，满足 $c_\\text{occ}(R)^\\top S(R) c_\\text{occ}(R) = 1$。\n\n4.  **构造密度矩阵**：在原子轨道基下的单电子密度矩阵 $P(R)$ 是根据已占据的分子轨道系数构造的：\n    $$P(R) = 2 \\, c_\\text{occ}(R) \\, c_\\text{occ}(R)^\\top$$\n    因子 $2$ 表示单个已占据分子轨道中的两个电子（闭壳层构型）。\n\n5.  **计算Mulliken电荷**：Mulliken总原子布居 $g_\\mu^{\\mathrm{M}}$ 是矩阵乘积 $P(R)S(R)$ 的对角元素。原子 $A$ 上的布居（对应于索引 $\\mu=1$）是：\n    $$g_A^{\\mathrm{M}}(R) = [P(R)S(R)]_{11}$$\n    则原子 $A$ 上的Mulliken电荷为：\n    $$q_A^{\\mathrm{M}}(R) = Z_A - g_A^{\\mathrm{M}}(R)$$\n\n6.  **计算Löwdin电荷**：Löwdin方法首先需要对原子轨道基进行对称正交化。这是通过使用重叠矩阵的矩阵平方根 $S(R)^{1/2}$ 来实现的。对于给定的 $S(R)$ 的 $2 \\times 2$ 结构，其平方根可以解析地求出。设 $a = \\frac{1}{2}(\\sqrt{1+s(R)} + \\sqrt{1-s(R)})$ 和 $b = \\frac{1}{2}(\\sqrt{1+s(R)} - \\sqrt{1-s(R)})$。则：\n    $$S(R)^{1/2} = \\begin{bmatrix} a  b \\\\ b  a \\end{bmatrix}$$\n    然后将密度矩阵转换到Löwdin基下：\n    $$\\widetilde{P}(R) = S(R)^{1/2} \\, P(R) \\, S(R)^{1/2}$$\n    原子 $A$ 上的Löwdin总原子布居是这个转换后密度矩阵的相应对角元素：\n    $$g_A^{\\mathrm{L}}(R) = \\widetilde{P}_{11}(R)$$\n    原子 $A$ 上的Löwdin电荷为：\n    $$q_A^{\\mathrm{L}}(R) = Z_A - g_A^{\\mathrm{L}}(R)$$\n\n7.  **比较电荷敏感度**：对于每个测试用例 $(R_1, R_2)$，上述过程执行两次，一次针对 $R_1$，一次针对 $R_2$，以获得 $\\{q_A^{\\mathrm{M}}(R_1), q_A^{\\mathrm{L}}(R_1)\\}$ 和 $\\{q_A^{\\mathrm{M}}(R_2), q_A^{\\mathrm{L}}(R_2)\\}$。然后计算绝对变化量：\n    $$\\Delta^{\\mathrm{M}}_A = \\lvert q_A^{\\mathrm{M}}(R_2) - q_A^{\\mathrm{M}}(R_1) \\rvert$$\n    $$\\Delta^{\\mathrm{L}}_A = \\lvert q_A^{\\mathrm{L}}(R_2) - q_A^{\\mathrm{L}}(R_1) \\rvert$$\n    最后，对布尔条件 $\\Delta^{\\mathrm{L}}_A \\le \\Delta^{\\mathrm{M}}_A$ 进行求值。对所有测试用例重复此整个过程，并收集所得的布尔值。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import eigh\n\ndef calculate_charges_at_r(R, z, eps_A, eps_B, K, Z_A):\n    \"\"\"\n    Calculates Mulliken and Löwdin charges on atom A for a given distance R.\n    \"\"\"\n    # Step 2: Construct Matrices\n    zR = z * R\n    s_R = np.exp(-zR) * (1 + zR + (zR)**2 / 3)\n\n    S = np.array([[1.0, s_R],\n                  [s_R, 1.0]])\n\n    h_AB = K * s_R * (eps_A + eps_B) / 2.0\n    H = np.array([[eps_A, h_AB],\n                  [h_AB, eps_B]])\n\n    # Step 3: Solve the Generalized Eigenvalue Problem\n    # eigh returns eigenvalues in ascending order and corresponding eigenvectors\n    # The first eigenvector corresponds to the lowest energy MO.\n    eigenvalues, eigenvectors = eigh(H, S)\n    c_occ = eigenvectors[:, 0].reshape(2, 1)\n\n    # Step 4: Construct the Density Matrix\n    P = 2 * (c_occ @ c_occ.T)\n\n    # Step 5: Calculate Mulliken Charge\n    PS = P @ S\n    g_A_M = PS[0, 0]\n    q_A_M = Z_A - g_A_M\n\n    # Step 6: Calculate Löwdin Charge\n    # Analytically compute S^(1/2) for a 2x2 symmetric matrix\n    sqrt_1_plus_s = np.sqrt(1 + s_R)\n    sqrt_1_minus_s = np.sqrt(1 - s_R)\n    a = 0.5 * (sqrt_1_plus_s + sqrt_1_minus_s)\n    b = 0.5 * (sqrt_1_plus_s - sqrt_1_minus_s)\n    S_sqrt = np.array([[a, b], [b, a]])\n\n    P_tilde = S_sqrt @ P @ S_sqrt\n    g_A_L = P_tilde[0, 0]\n    q_A_L = Z_A - g_A_L\n\n    return q_A_M, q_A_L\n\ndef solve():\n    # Define parameters from the problem statement.\n    z = 1.24        # inverse bohr\n    eps_A = -0.50   # Hartree\n    eps_B = -0.70   # Hartree\n    K = 1.75        # dimensionless\n    Z_A = 1.0       # atomic number for A\n    Z_B = 1.0       # atomic number for B (model parameter)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (1.40, 1.45),\n        (0.80, 0.82),\n        (3.00, 3.10),\n        (1.20, 1.21),\n    ]\n\n    results = []\n    for R1, R2 in test_cases:\n        # Calculate charges at R1\n        q_A_M_R1, q_A_L_R1 = calculate_charges_at_r(R1, z, eps_A, eps_B, K, Z_A)\n\n        # Calculate charges at R2\n        q_A_M_R2, q_A_L_R2 = calculate_charges_at_r(R2, z, eps_A, eps_B, K, Z_A)\n\n        # Compute absolute changes\n        delta_M_A = abs(q_A_M_R2 - q_A_M_R1)\n        delta_L_A = abs(q_A_L_R2 - q_A_L_R1)\n\n        # Compare sensitivities and store the boolean result\n        results.append(delta_L_A = delta_M_A)\n\n    # Final print statement in the exact required format.\n    # The boolean values are capitalized in f-string formatting, so map to str.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2449471"}]}