## 引言
在化学领域，将分子中[连续分布](@entry_id:264735)的电子云归属于独立的原子，从而获得一个直观的“[原子电荷](@entry_id:204820)”图像，是理解化学键极性、分子反应性和[分子间相互作用](@entry_id:263767)的关键。然而，[原子电荷](@entry_id:204820)并非一个可以直接测量的物理量，而是通过理论模型从[量子化学](@entry_id:140193)计算结果中“划分”出来的。不同的划分方法，如广为人知的Mulliken和Löwdin分析，可能得出截然不同的结论，这给化学家在解释计算结果时带来了挑战和困惑。本文旨在系统性地解决这一问题。

通过本文的学习，您将深入探索[原子电荷](@entry_id:204820)布居分析的核心。在第一章“原理和机制”中，我们将剖析Mulliken和Löwdin这两种基础方法的数学框架，揭示它们各自的优缺点。接着，在第二章“应用与[交叉](@entry_id:147634)学科联系”中，我们将展示这些理论工具如何应用于阐明真实的化学问题，并与其他科学领域如[材料科学](@entry_id:152226)和数据科学产生联系。最后，通过第三章“动手实践”中的计算练习，您将把理论知识转化为实践技能。

现在，让我们从布居分析最基本的原理出发，踏上将抽象电子密度转化为具体化学概念的旅程。

## 原理和机制

在[分子量子力学](@entry_id:203843)中，电子的[分布](@entry_id:182848)由一个连续的、遍布整个分[子空间](@entry_id:150286)的电子密度函数 $\rho(\mathbf{r})$ 来描述。然而，化学家们常常希望将这种连续的[分布](@entry_id:182848)与一个离散的、基于原子的图像联系起来，从而得到诸如“某个原子携带多少[电荷](@entry_id:275494)”这样直观且有用的化学概念。[原子电荷](@entry_id:204820)布居分析正是实现这一目标的一套数学方法，它试图将分子的总电子数划分给构成它的各个原子。本章将深入探讨两种最基础也最具[代表性](@entry_id:204613)的布居分析方法——Mulliken分析和Löwdin分析——的原理、机制及其内在的局限性。

### 电子布居的划分：从连续密度到[原子电荷](@entry_id:204820)

在基于[原子轨道线性组合](@entry_id:151829)（LCAO）的[自洽场](@entry_id:136549)（SCF）方法中，电子结构的信息被编码在两个关键的矩阵中：**密度矩阵** $P$ 和**[重叠矩阵](@entry_id:268881)** $S$。这些矩阵均构建在选定的[原子轨道](@entry_id:140819)（AO）[基组](@entry_id:160309) $\{\chi_{\mu}\}$ 之上。

[密度矩阵](@entry_id:139892) $P$ 的元素 $P_{\mu\nu}$ 反映了[基函数](@entry_id:170178) $\chi_{\mu}$ 和 $\chi_{\nu}$ 之间的电子密度[分布](@entry_id:182848)。[重叠矩阵](@entry_id:268881) $S$ 的元素 $S_{\mu\nu} = \langle \chi_{\mu} \mid \chi_{\nu} \rangle$ 则量化了这些通常非正交的[基函数](@entry_id:170178)在空间上的重叠程度。一个基本而重要的关系是，分子的总电子数 $N$ 可以通过这两个矩阵的乘积的迹（trace）来计算：

$N = \mathrm{Tr}(PS) = \sum_{\mu} \sum_{\nu} P_{\mu\nu} S_{\nu\mu}$

这个方程是所有基于[基组](@entry_id:160309)的布居分析方法的出发点。它表明，总电子数这个“大饼”已经被表示为一系列与[基函数](@entry_id:170178)对 $(\chi_{\mu}, \chi_{\nu})$ 相关的项的总和。布居分析的核心任务，便是制定一套规则，将这个总和中的每一项合理地分配给分子中的各个原子。

### [Mulliken布居分析](@entry_id:164573)：一种直观的均分方案

[Mulliken布居分析](@entry_id:164573)由Robert S. Mulliken提出，是历史上最早也是最简单的[划分方案](@entry_id:635750)之一。其核心思想非常直观：将总电子数表达式 $N = \sum_{\mu,\nu} P_{\mu\nu} S_{\nu\mu}$ 中的每一项进行归属。

我们可以将总和分为两种情况：
1.  **净布居 (Net Population)**：当 $\mu = \nu$ 时，项为 $P_{\mu\mu}S_{\mu\mu}$。对于归一化的[基函数](@entry_id:170178)，$S_{\mu\mu}=1$，因此该项就是 $P_{\mu\mu}$。这部分电子被认为完全属于[基函数](@entry_id:170178) $\chi_{\mu}$ 所在的原子。
2.  **[重叠布居](@entry_id:276854) (Overlap Population)**：当 $\mu \neq \nu$ 时，项的总和为 $\sum_{\mu \neq \nu} P_{\mu\nu} S_{\nu\mu}$。对于实函数，$P_{\mu\nu}=P_{\nu\mu}$ 且 $S_{\mu\nu}=S_{\nu\mu}$，因此通常将与一对[基函数](@entry_id:170178) $(\chi_{\mu}, \chi_{\nu})$ 相关的电子布居写为 $2P_{\mu\nu}S_{\mu\nu}$。这部分电子处于两个[基函数](@entry_id:170178)的重叠区域，属于“共享”部分。

Mulliken方案对共享的[重叠布居](@entry_id:276854)采取了最民主的分配方式：**在两个相关的原子中心之间平均分配**。也就是说，对于[重叠布居](@entry_id:276854) $2P_{\mu\nu}S_{\mu\nu}$，[基函数](@entry_id:170178) $\chi_{\mu}$ 和 $\chi_{\nu}$ 各自获得一半，即 $P_{\mu\nu}S_{\mu\nu}$。

因此，一个[基函数](@entry_id:170178) $\chi_{\mu}$ 的**总布居 (gross population)** 被定义为它的净布居加上它从所有其他[重叠布居](@entry_id:276854)中分得的一半。数学上，这恰好等于矩阵乘积 $(PS)$ 的对角元：

$q_{\mu}^{\text{Mulliken}} = (PS)_{\mu\mu} = \sum_{\nu} P_{\mu\nu} S_{\nu\mu}$

一个原子 $A$ 的**Mulliken总原子布居 (gross atomic population)** $N_A$ 就是其上所有[基函数](@entry_id:170178)总布居之和：

$N_A = \sum_{\mu \in A} q_{\mu}^{\text{Mulliken}} = \sum_{\mu \in A} (PS)_{\mu\mu}$

最后，原子 $A$ 的**[Mulliken电荷](@entry_id:269216)** $q_A$ 就由其核[电荷](@entry_id:275494) $Z_A$ 减去总原子布居得到：$q_A = Z_A - N_A$。

我们可以通过一个简单的双原子体系来理解这一过程 [@problem_id:2449498]。假设原子A和B上各有一个[基函数](@entry_id:170178) $\chi_1$ 和 $\chi_2$。给定[重叠矩阵](@entry_id:268881) $S = \begin{pmatrix} 1.00  0.25 \\ 0.25  1.00 \end{pmatrix}$ 和密度矩阵 $P = \begin{pmatrix} 0.80  0.80 \\ 0.80  0.80 \end{pmatrix}$。首先计算矩阵乘积 $PS$：

$PS = \begin{pmatrix} 0.80  0.80 \\ 0.80  0.80 \end{pmatrix} \begin{pmatrix} 1.00  0.25 \\ 0.25  1.00 \end{pmatrix} = \begin{pmatrix} 1.00  1.00 \\ 1.00  1.00 \end{pmatrix}$

根据定义，原子A和B的总原子布居分别为：
$N_A = (PS)_{11} = 1.00$
$N_B = (PS)_{22} = 1.00$

总电子数为 $\mathrm{Tr}(PS) = 1.00 + 1.00 = 2.00$。这个结果的背后正是Mulliken的均分思想。体系的净布居为 $P_{11}=0.80$ 和 $P_{22}=0.80$，而[重叠布居](@entry_id:276854)为 $2P_{12}S_{12} = 2(0.80)(0.25) = 0.40$。Mulliken分析将这 $0.40$ 的共享电子在A和B之间平分，每个原子获得 $0.20$。因此，A的总布居是其净布居加上分得的一半，即 $N_A = P_{11} + P_{12}S_{12} = 0.80 + (0.80)(0.25) = 1.00$。这个看似简单的均分原则，就如同将一项合作成果的功劳在两位合作者之间完全平分，而不考虑各自贡献的实际差异。这种绝对的平均主义，正是Mulliken分析的核心，也为其后续的问题埋下了伏笔 [@problem_id:2449498]。

### Mulliken分析的局限性与病态行为

尽管Mulliken分析因其简单和直观而被广泛使用，但它的“均分”假设在物理上是相当随意的，并会导致一系列严重的问题，使其结果在很多情况下变得不可靠甚至毫无意义。

#### 对[基组](@entry_id:160309)的极端敏感性

[Mulliken电荷](@entry_id:269216)最臭名昭著的缺陷是其对基[组选择](@entry_id:175784)的极端敏感性，尤其是在使用包含**[弥散函数](@entry_id:267705) (diffuse functions)** 的大[基组](@entry_id:160309)时 [@problem_id:2449459]。[弥散函数](@entry_id:267705)是一种高斯指数很小、空间分布非常广阔的[基函数](@entry_id:170178)。

考虑一个场景：我们在氟分子 $\text{F}_2$ 的计算中加入[弥散函数](@entry_id:267705) [@problem_id:2449452]。一个氟原子上的弥散函数可能会延伸很远，与另一个氟原子上的紧凑价层函数产生显著的重叠。尽管这个重叠区域的电子密度绝大部分都集中在第二个氟原子附近，Mulliken分析仍会“盲目地”将这部分[重叠布居](@entry_id:276854)的一半错误地分配给第一个氟原子。这种不合理的“密度转移”会导致计算出的原子布居严重偏离物理现实。例如，在$\text{F}_2$（每个F有9个电子）的计算中，可能会得到一个F原子的Mulliken布居大于10（甚至远大于10）的荒谬结果，这意味着另一个F原子的布居将小于8 [@problem_id:2449452]。这显然是方法论上的人为产物，而非真实的物理电荷转移。

这种敏感性也导致了[Mulliken电荷](@entry_id:269216)不具备**[旋转不变性](@entry_id:137644)**的缺陷。如果使用固定于[全局坐标系](@entry_id:171029)的笛卡尔[基函数](@entry_id:170178)（如 $p_x, p_y, p_z$），当分子旋转时，原子间的[重叠积分](@entry_id:175831) $S_{\mu\nu}$ 会发生改变，从而导致计算出的[Mulliken电荷](@entry_id:269216)也随之改变，这与物理现实相悖 [@problem_id:2449462]。

#### [数值不稳定性](@entry_id:137058)与非物理值

弥散函数的引入常常会导致[基组](@entry_id:160309)的**近线性相关**问题，即某些[基函数](@entry_id:170178)可以被其他[基函数](@entry_id:170178)的[线性组合](@entry_id:154743)近似表示。这使得[重叠矩阵](@entry_id:268881) $S$ 变得**病态 (ill-conditioned)**，其[行列式](@entry_id:142978)值接近于零，并拥有非常小的[本征值](@entry_id:154894)。这种数值上的不稳定性会传递到SCF计算的收敛过程和最终的[密度矩阵](@entry_id:139892) $P$ 中，微小的数值噪声就可能导致[Mulliken电荷](@entry_id:269216)的巨大波动 [@problem_id:2449459]。

更深层次的问题在于Mulliken布居的数学构造。单个原子轨道的Mulliken布居 $q_{\mu}^{\text{Mulliken}} = (PS)_{\mu\mu}$ 是一个非[厄米矩阵](@entry_id:155147) $PS$ 的对角元。[厄米矩阵](@entry_id:155147)的对角元受其[本征值](@entry_id:154894)的约束，但非厄米矩阵的对角元则没有这样的限制。因此，即使体系的电子态是物理的，$(PS)_{\mu\mu}$ 的值也完全可能超出物理上有意义的范围，即单个自旋轨道布居数0到1（总布居数0到2）的范围。在实践中，Mulliken分析经常会产生小于0或大于2的[轨道](@entry_id:137151)布居数，这是其方法论存在根本缺陷的直接体现 [@problem_id:2449508]。

### Löwdin布居分析：基于[正交化](@entry_id:149208)的稳健方法

为了克服Mulliken分析的种种弊病，Per-Olov Löwdin提出了一种更为稳健的替代方案。Löwdin分析的核心思想是：**不要在混乱的[非正交基组](@entry_id:190211)中直接划分电子，而是先将[基组](@entry_id:160309)变换到一个“干净”的正交归一[基组](@entry_id:160309)中，再进行划分。**

在正交归一[基组](@entry_id:160309)中，[重叠矩阵](@entry_id:268881)为单位矩阵 $I$，因此[重叠布居](@entry_id:276854)项消失了。一个[轨道](@entry_id:137151)上的电子布居就是其密度矩阵的对角元，不存在如何划分共享区域的问题。

实现这一目标的关键步骤是**[对称正交化](@entry_id:167626) (symmetric orthogonalization)**。给定非正交的AO[基组](@entry_id:160309) $\{\chi_{\mu}\}$ 和其[重叠矩阵](@entry_id:268881) $S$，我们可以通过矩阵 $S^{-1/2}$ 将其变换为一个新的正交归一[基组](@entry_id:160309) $\{\tilde{\chi}_{\mu}\}$：

$|\tilde{\chi}\rangle = |\chi\rangle S^{-1/2}$

其中 $S^{-1/2}$ 是 $S$ 的逆平方根矩阵。这个变换具有非常优良的性质。首先，它产生的正交基组是在最小二乘意义上与原始AO[基组](@entry_id:160309)“最接近”的唯一[基组](@entry_id:160309) [@problem_id:2449466] [@problem_id:2449488]。其次，与依赖于函数顺序的[格拉姆-施密特正交化](@entry_id:143035)不同，[对称正交化](@entry_id:167626)平等地对待所有[基函数](@entry_id:170178)，并能保持体系原有的对称性 [@problem_id:2449466]。

在变换到新的正交基组后，[密度矩阵](@entry_id:139892)也需要进行相应的变换，以保持物理的电子密度不变。新的密度矩阵 $\tilde{P}$ 为：

$\tilde{P} = S^{1/2} P S^{1/2}$

在这个[正交基](@entry_id:264024)组中，原子A的**Löwdin总原子布居** $N_A$ 被简单地定义为属于该原子的新[基函数](@entry_id:170178)所对应的[密度矩阵](@entry_id:139892)对角元之和：

$N_A^{\text{Löwdin}} = \sum_{\mu \in A} \tilde{P}_{\mu\mu} = \sum_{\mu \in A} (S^{1/2} P S^{1/2})_{\mu\mu}$

Löwdin[电荷](@entry_id:275494) $q_A$ 同样由 $Z_A - N_A^{\text{Löwdin}}$ 给出。

那么，为何Löwdin分析能避免Mulliken分析的那些病态行为呢？

1.  **保证物理范围**：Löwdin布居 $N_{\mu}^{\text{Löwdin}} = \tilde{P}_{\mu\mu}$ 是厄米矩阵 $\tilde{P}$ 的对角元。$\tilde{P}$ 的[本征值](@entry_id:154894)是自然[轨道](@entry_id:137151)的占据数，对于任何物理态，其值必须在 $[0, 2]$ 区间内（对于[自旋求和](@entry_id:162099)的[密度矩阵](@entry_id:139892)）。根据线性代数的基本定理，[厄米矩阵](@entry_id:155147)的对角元被其最大和最小[本征值](@entry_id:154894)所限定。因此，Löwdin[轨道](@entry_id:137151)布居数天然地被约束在物理合理的 $[0, 2]$ 区间内，从根本上杜绝了非物理值的出现 [@problem_id:2449508]。

2.  **降低[基组依赖性](@entry_id:197523)**：[对称正交化](@entry_id:167626)变换 $S^{-1/2}$ 涉及整个[重叠矩阵](@entry_id:268881) $S$，它将每个原始AO“混合”成新的正交AO。这意味着每个Löwdin布居数都包含了来自整个分子基组的信息。当[基组](@entry_id:160309)中存在近[线性相关](@entry_id:185830)时（例如，加入弥散函数），Mulliken分析会因为局部的、任意的均分而崩溃。而Löwdin分析通过全局的、系统的正交化过程，使得布居数更多地依赖于原子周围函数所张成的**[子空间](@entry_id:150286)**的整体性质，而不是[基组](@entry_id:160309)中个别函数的病态行为。这使得Löwdin[电荷](@entry_id:275494)对[基组](@entry_id:160309)的扩展和改变表现出更强的稳健性 [@problem_id:2449474] [@problem_id:2449488]。

值得注意的是，Löwdin方法也依赖于[重叠矩阵](@entry_id:268881) $S$ 的良好性质。如果[基组](@entry_id:160309)是严格[线性相关](@entry_id:185830)的，$\det(S)=0$，那么 $S$ 不可逆，$S^{-1/2}$ 在整个空间上是未定义的。这意味着[基组](@entry_id:160309)中存在冗余。在实践中，这种情况通过在由 $S$ 的非零[本征值](@entry_id:154894)所张成的非冗余[子空间](@entry_id:150286)中进行“[伪逆](@entry_id:140762)”计算来处理，即移除冗余的[基函数](@entry_id:170178)组合 [@problem_id:2449514]。

### 结论：选择与批判性思维

通过对比Mulliken和Löwdin分析，我们可以看到从一个简单的划分思想演进到一个数学上更严谨、物理上更合理的框架的过程。Mulliken分析因其简单而具有一定的教学价值，但在科研实践中，其结果的不可靠性使得它必须被谨慎使用，甚至常常需要被避免。Löwdin分析通过[对称正交化](@entry_id:167626)的巧妙设计，克服了Mulliken分析的主要缺陷，提供了更稳定、更具物理意义的[原子电荷](@entry_id:204820)。

然而，我们必须怀有批判性思维，认识到一个重要事实：**任何基于[轨道空间](@entry_id:148658)划分的布居分析方法，包括Löwdin分析，其结果都不是物理可观测量**。Löwdin[电荷](@entry_id:275494)虽然通常比[Mulliken电荷](@entry_id:269216)对[基组](@entry_id:160309)不那么敏感，但它们仍然依赖于所选择的[基组](@entry_id:160309)。因此，诸如“Löwdin[电荷](@entry_id:275494)是分子的固有属性，而[Mulliken电荷](@entry_id:269216)是分子和[基组](@entry_id:160309)的共同属性”这样的说法是具有误导性的 [@problem_id:2449512]。更准确的描述是，两者都是依赖于[基组](@entry_id:160309)的模型量，但Löwdin模型由于其更优越的数学构造，通常能更稳健地反映潜在的电子结构。

在实际应用中，[原子电荷](@entry_id:204820)的最佳选择取决于研究的具体问题。除了Mulliken和Löwdin，还发展出了许多其他更复杂的方案，如基于[静电势拟合](@entry_id:748919)的[电荷](@entry_id:275494)、Bader的“分子中的原子”（QTAIM）理论等，它们各自基于不同的物理图像和数学原理。理解像Mulliken和Löwdin这样的基础方法的原理和局限性，是学习和评判所有这些计算化学工具的关键第一步。