{"hands_on_practices": [{"introduction": "原子部分电荷是化学中的一个基本概念，但如何赋值并非总是显而易见的。本练习将介绍电荷均衡（Charge Equilibration, QEq）模型，这是一种通过最小化静电能量泛函来计算电荷的、有物理基础的方法。在此练习中 [@problem_id:2454820]，你将模拟磷酸根离子逐步质子化的过程，追踪每个原子上电荷的重新分布，以及这种变化如何改变分子的静电势。这将让你亲身体验电荷、结构和静电学之间的相互作用。", "problem": "您将编写一个完整的程序，模拟一个磷酸盐物种从磷酸根（$PO_4^{3-}$）逐步质子化为磷酸（$H_3PO_4$）时，其部分原子电荷和静电势 (ESP) 如何变化。计算必须在一个最简单的、自洽的、基于物理的模型中进行。该模型通过最小化一个能量泛函，将电荷分布与静电学联系起来，该泛函根据原子特定参数对电荷转移进行惩罚，并包含成对的库仑相互作用。所有计算都必须以原子单位进行，其中基本电荷为 $e = 1$，约化普朗克常数为 $\\hbar = 1$，电子质量为 $m_e = 1$，玻尔半径为 $a_0 = 1$，库仑常数为 $1 / (4 \\pi \\varepsilon_0) = 1$。在此单位系统中，静电势以哈特里每基本电荷为单位。\n\n模型假设和定义如下。\n\n- 位置与几何结构：\n  - 将一个磷原子置于原点，位置为 $\\mathbf{R}_{\\mathrm{P}} = (0,0,0)$。\n  - 将四个氧原子放置在磷原子周围一个正四面体的顶点上，磷-氧距离为 $d_{\\mathrm{PO}} = 2.90\\,a_0$。从磷到氧的四个单位向量是：\n    - $\\mathbf{u}_1 = \\frac{1}{\\sqrt{3}}(1,1,1)$，\n    - $\\mathbf{u}_2 = \\frac{1}{\\sqrt{3}}(1,-1,-1)$，\n    - $\\mathbf{u}_3 = \\frac{1}{\\sqrt{3}}(-1,1,-1)$，\n    - $\\mathbf{u}_4 = \\frac{1}{\\sqrt{3}}(-1,-1,1)$。\n    氧原子的位置是 $\\mathbf{R}_{\\mathrm{O}k} = d_{\\mathrm{PO}} \\,\\mathbf{u}_k$，其中 $k \\in \\{1,2,3,4\\}$。\n  - 质子（如果存在）沿着 $\\mathrm{P}\\!-\\!\\mathrm{O}$ 键的方向与氧结合，氧-氢距离为 $d_{\\mathrm{OH}} = 1.84\\,a_0$。对于一个位于 $\\mathbf{R}_{\\mathrm{O}k}$ 且键方向为 $\\mathbf{u}_k$ 的氧原子，其氢原子的位置是 $\\mathbf{R}_{\\mathrm{H}k} = \\mathbf{R}_{\\mathrm{O}k} + d_{\\mathrm{OH}}\\,\\mathbf{u}_k$。\n\n- 逐步质子化状态和总净电荷 $Q_{\\text{tot}}$：\n  - 状态 $s = 0$: $PO_4^{3-}$，无氢原子；$Q_{\\text{tot}} = -3$。\n  - 状态 $s = 1$: $HPO_4^{2-}$，一个氢原子在 $\\mathrm{O}1$ 上；$Q_{\\text{tot}} = -2$。\n  - 状态 $s = 2$: $H_2PO_4^{-}$，氢原子分别在 $\\mathrm{O}1$ 和 $\\mathrm{O}2$ 上；$Q_{\\text{tot}} = -1$。\n  - 状态 $s = 3$: $H_3PO_4$，氢原子分别在 $\\mathrm{O}1$、$\\mathrm{O}2$ 和 $\\mathrm{O}3$ 上；$Q_{\\text{tot}} = 0$。\n\n- 电荷分布模型：\n  - 为每个原子 $i$（磷、氧以及任何存在的氢）分配一个部分电荷 $q_i$。\n  - 总电荷受约束 $\\sum_i q_i = Q_{\\text{tot}}$。\n  - 关于 $\\{q_i\\}$ 需要最小化的能量泛函是\n    $$E(\\{q_i\\}) = \\sum_i \\left( \\chi_i \\, q_i + \\tfrac{1}{2}\\,\\eta_i\\, q_i^2 \\right) + \\tfrac{1}{2} \\sum_{i \\neq j} \\frac{q_i\\,q_j}{\\lVert \\mathbf{R}_i - \\mathbf{R}_j \\rVert},$$\n    其中 $\\chi_i$ 是特定于元素的类电负性参数（单位为哈特里），$\\eta_i$ 是特定于元素的硬度参数（单位为哈特里），距离单位为 $a_0$。\n  - 对每种元素使用以下参数：\n    - 磷 (P): $\\chi_{\\mathrm{P}} = 0.202$, $\\eta_{\\mathrm{P}} = 0.50$。\n    - 氧 (O): $\\chi_{\\mathrm{O}} = 0.273$, $\\eta_{\\mathrm{O}} = 0.80$。\n    - 氢 (H): $\\chi_{\\mathrm{H}} = 0.265$, $\\eta_{\\mathrm{H}} = 1.10$。\n  - 在点 $\\mathbf{r}$ 处的静电势 (ESP) 定义为\n    $$V(\\mathbf{r}) = \\sum_i \\frac{q_i}{\\lVert \\mathbf{r} - \\mathbf{R}_i \\rVert}。$$\n\n您的任务是：\n- 对于每个质子化状态 $s \\in \\{0,1,2,3\\}$，构建相应的几何结构，在电荷约束下最小化 $E(\\{q_i\\})$ 以获得部分电荷 $\\{q_i\\}$，然后在指定的探测点上计算静电势 (ESP)。\n\n为每个状态计算 $V(\\mathbf{r})$ 的探测点：\n- $\\mathbf{r}_{\\text{far}} = (0,0,100)\\,a_0$，\n- $\\mathbf{r}_{u_1} = 3.5\\,\\mathbf{u}_1\\,a_0$，\n- $\\mathbf{r}_{x} = (3.5,0,0)\\,a_0$。\n\n每个状态 $s$ 的要求输出：\n- 磷原子上的部分电荷 $q_{\\mathrm{P}}$，以基本电荷 $e$ 为单位。\n- 未质子化的氧原子上的平均部分电荷（即，在该状态下未连接氢原子的 $\\mathrm{O}k$ 的平均值）。对于状态 $s = 0$，这是所有四个氧原子的平均值；对于状态 $s = 3$，这仅指 $\\mathrm{O}4$。\n- 静电势 $V(\\mathbf{r}_{\\text{far}})$、$V(\\mathbf{r}_{u_1})$ 和 $V(\\mathbf{r}_{x})$，以原子单位（哈特里每 $e$）表示。\n\n所有量都必须以原子单位计算和表示。答案必须四舍五入到 $6$ 位小数。\n\n测试套件：\n- 程序必须为每个状态 $s \\in \\{0,1,2,3\\}$ 按以下顺序计算上面列出的五个输出：\n  - 对于 $s = 0$（无氢原子，$Q_{\\text{tot}} = -3$）：$q_{\\mathrm{P}}$，$\\{\\mathrm{O}1,\\mathrm{O}2,\\mathrm{O}3,\\mathrm{O}4\\}$ 上氧原子的平均电荷，$V(\\mathbf{r}_{\\text{far}})$，$V(\\mathbf{r}_{u_1})$，$V(\\mathbf{r}_{x})$。\n  - 对于 $s = 1$（氢原子在 $\\mathrm{O}1$ 上，$Q_{\\text{tot}} = -2$）：$q_{\\mathrm{P}}$，$\\{\\mathrm{O}2,\\mathrm{O}3,\\mathrm{O}4\\}$ 上氧原子的平均电荷，$V(\\mathbf{r}_{\\text{far}})$，$V(\\mathbf{r}_{u_1})$，$V(\\mathbf{r}_{x})$。\n  - 对于 $s = 2$（氢原子在 $\\mathrm{O}1$ 和 $\\mathrm{O}2$ 上，$Q_{\\text{tot}} = -1$）：$q_{\\mathrm{P}}$，$\\{\\mathrm{O}3,\\mathrm{O}4\\}$ 上氧原子的平均电荷，$V(\\mathbf{r}_{\\text{far}})$，$V(\\mathbf{r}_{u_1})$，$V(\\mathbf{r}_{x})$。\n  - 对于 $s = 3$（氢原子在 $\\mathrm{O}1$、$\\mathrm{O}2$ 和 $\\mathrm{O}3$ 上，$Q_{\\text{tot}} = 0$）：$q_{\\mathrm{P}}$，$\\{\\mathrm{O}4\\}$ 上氧原子的平均电荷，$V(\\mathbf{r}_{\\text{far}})$，$V(\\mathbf{r}_{u_1})$，$V(\\mathbf{r}_{x})$。\n\n最终输出格式：\n- 您的程序应生成一行输出，其中包含所有 $20$ 个数字（每个状态五个），以逗号分隔的列表形式包含在方括号中，并严格按照上述顺序排列；例如，$[\\text{result}_1,\\text{result}_2,\\dots,\\text{result}_{20}]$。", "solution": "该问题陈述经过严格评估，被认为是有效的。它具有科学依据、问题适定、客观且内容自洽，提出了一个基于已确立的电负性均衡原理的、在计算化学领域中可解的问题。因此，我们将着手提供一个完整的、论证充分的解决方案。\n\n问题的核心是在总电荷 $Q_{\\text{tot}}$ 的约束下，通过最小化一个特定的能量泛函 $E(\\{q_i\\})$ 来确定分子的平衡部分原子电荷 $\\{q_i\\}$。这是一类称为电荷均衡 (QEq) 方法中的标准途径。能量泛函给出如下：\n$$E(\\{q_i\\}) = \\sum_i \\left( \\chi_i \\, q_i + \\tfrac{1}{2}\\,\\eta_i\\, q_i^2 \\right) + \\tfrac{1}{2} \\sum_{i \\neq j} \\frac{q_i\\,q_j}{\\lVert \\mathbf{R}_i - \\mathbf{R}_j \\rVert}$$\n这里，$q_i$ 是位于位置 $\\mathbf{R}_i$ 的原子 $i$ 上的部分电荷。参数 $\\chi_i$ 和 $\\eta_i$ 分别是原子 $i$ 的电负性和化学硬度，它们量化了偏离中性电荷状态的能量代价。最后一项代表所有原子点电荷对之间的经典库仑势能。所有量均按规定以原子单位表示。\n\n$E(\\{q_i\\})$ 的最小化受总电荷守恒的约束：\n$$ \\sum_i q_i = Q_{\\text{tot}} $$\n这个约束优化问题可以通过拉格朗日乘子法优雅地解决。我们定义一个拉格朗日函数 $\\mathcal{L}(\\{q_i\\}, \\lambda)$：\n$$ \\mathcal{L}(\\{q_i\\}, \\lambda) = E(\\{q_i\\}) - \\lambda \\left( \\sum_i q_i - Q_{\\text{tot}} \\right) $$\n其中 $\\lambda$ 是拉格朗日乘子。在最小值处，$\\mathcal{L}$ 对所有变量 $\\{q_i\\}$ 和 $\\lambda$ 的偏导数必须为零。对 $\\lambda$ 的导数仅恢复约束方程。对特定电荷 $q_k$ 的导数是：\n$$ \\frac{\\partial \\mathcal{L}}{\\partial q_k} = \\frac{\\partial E}{\\partial q_k} - \\lambda = 0 $$\n能量 $E$ 对 $q_k$ 的偏导数是分子中原子 $k$ 的化学势，可以被识别为其有效电负性：\n$$ \\frac{\\partial E}{\\partial q_k} = \\chi_k + \\eta_k q_k + \\sum_{j \\neq k} \\frac{q_j}{\\lVert \\mathbf{R}_k - \\mathbf{R}_j \\rVert} $$\n将此值对所有原子 $k$ 设为等于拉格朗日乘子 $\\lambda$，便得到电负性均衡原理：分子中每个原子的有效电负性变得等于一个公共值 $\\lambda$。这给出了一个关于 $N$ 个原子的 $N$ 个线性方程组：\n$$ \\chi_k + \\eta_k q_k + \\sum_{j \\neq k} \\frac{q_j}{R_{kj}} = \\lambda, \\quad \\text{for } k=1, \\dots, N $$\n其中 $R_{kj} = \\lVert \\mathbf{R}_k - \\mathbf{R}_j \\rVert$。\n\n这 $N$ 个方程与单个约束方程一起，构成了一个包含 $N+1$ 个未知数（即 $N$ 个电荷 $\\{q_k\\}$ 和乘子 $\\lambda$）的完备的 $N+1$ 个线性方程组。我们可以将此系统表示为矩阵形式：\n$$\n\\begin{pmatrix}\n\\eta_1  1/R_{12}  \\cdots  1/R_{1N}  -1 \\\\\n1/R_{21}  \\eta_2  \\cdots  1/R_{2N}  -1 \\\\\n\\vdots  \\vdots  \\ddots  \\vdots  \\vdots \\\\\n1/R_{N1}  1/R_{N2}  \\cdots  \\eta_N  -1 \\\\\n1  1  \\cdots  1  0\n\\end{pmatrix}\n\\begin{pmatrix}\nq_1 \\\\\nq_2 \\\\\n\\vdots \\\\\nq_N \\\\\n\\lambda\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n-\\chi_1 \\\\\n-\\chi_2 \\\\\n\\vdots \\\\\n-\\chi_N \\\\\nQ_{\\text{tot}}\n\\end{pmatrix}\n$$\n这是一个标准的线性系统 $M\\mathbf{x} = \\mathbf{b}$，可以很容易地进行数值求解。\n\n对于每个指定的质子化状态 $s \\in \\{0, 1, 2, 3\\}$，计算步骤如下：\n1.  **系统构建**：对于给定状态 $s$，确定构成该分子的原子集合（$PO_4^{3-}$、$HPO_4^{2-}$、$H_2PO_4^{-}$或 $H_3PO_4$）。相应地确定原子总数 $N$ 和总电荷 $Q_{\\text{tot}}$。根据提供的四面体几何结构和键长 $d_{\\mathrm{PO}}=2.90\\,a_0$ 及 $d_{\\mathrm{OH}}=1.84\\,a_0$ 计算每个原子 $i$ 的笛卡尔坐标 $\\mathbf{R}_i$。为每个原子分配相应的参数 $\\chi_i$ 和 $\\eta_i$。\n\n2.  **矩阵构建**：构建 $(N+1) \\times (N+1)$ 矩阵 $M$ 和 $(N+1)$ 维向量 $\\mathbf{b}$。用硬度值 $\\eta_i$、原子间距离的倒数 $1/R_{ij}$ 和 1 来填充矩阵 $M$ 的元素，如上面的矩阵方程所示。用负的电负性参数 $-\\chi_i$ 和总电荷 $Q_{\\text{tot}}$ 来填充向量 $\\mathbf{b}$。\n\n3.  **求解电荷**：求解线性系统 $M\\mathbf{x} = \\mathbf{b}$ 以得到向量 $\\mathbf{x}$，其前 $N$ 个分量即为平衡部分电荷 $\\{q_i\\}$。\n\n4.  **可观测量计算**：一旦知道了电荷 $\\{q_i\\}$，就可以计算所需的输出：\n    *   磷原子上的部分电荷 $q_{\\mathrm{P}}$。\n    *   未与氢原子成键的氧原子的平均部分电荷。\n    *   在三个指定的探测点（$\\mathbf{r}_{\\text{far}}$、$\\mathbf{r}_{u_1}$、$\\mathbf{r}_{x}$）处的静电势 (ESP) $V(\\mathbf{r})$，使用其定义：\n        $$ V(\\mathbf{r}) = \\sum_i \\frac{q_i}{\\lVert \\mathbf{r} - \\mathbf{R}_i \\rVert} $$\n对四个质子化状态中的每一个重复此过程，以生成全部二十个所需值。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of finding partial charges and ESP for the phosphate species\n    at different protonation states using a charge equilibration model.\n    \"\"\"\n\n    # --- Define constants and parameters in atomic units ---\n    D_PO = 2.90  # a_0\n    D_OH = 1.84  # a_0\n\n    PARAMS = {\n        'P': {'chi': 0.202, 'eta': 0.50},\n        'O': {'chi': 0.273, 'eta': 0.80},\n        'H': {'chi': 0.265, 'eta': 1.10},\n    }\n\n    # --- Define geometry ---\n    U = {\n        1: np.array([1, 1, 1]) / np.sqrt(3),\n        2: np.array([1, -1, -1]) / np.sqrt(3),\n        3: np.array([-1, 1, -1]) / np.sqrt(3),\n        4: np.array([-1, -1, 1]) / np.sqrt(3),\n    }\n\n    R_P = np.array([0.0, 0.0, 0.0])\n    R_O = {k: D_PO * u for k, u in U.items()}\n\n    # --- Define probe points ---\n    PROBE_POINTS = {\n        'far': np.array([0.0, 0.0, 100.0]),\n        'u1': 3.5 * U[1],\n        'x': np.array([3.5, 0.0, 0.0]),\n    }\n\n    all_results = []\n\n    # --- Loop over each protonation state s = 0, 1, 2, 3 ---\n    for s in range(4):\n        q_tot = -3.0 + s\n        \n        # 1. Construct atom list for the current state\n        atoms = []\n        # Phosphorus atom\n        atoms.append({'label': 'P', 'pos': R_P})\n        # Oxygen atoms\n        for k in range(1, 5):\n            atoms.append({'label': f'O{k}', 'pos': R_O[k]})\n        # Hydrogen atoms\n        for k in range(1, s + 1):\n            r_hk = R_O[k] + D_OH * U[k]\n            atoms.append({'label': f'H{k}', 'pos': r_hk})\n\n        num_atoms = len(atoms)\n\n        # 2. Build parameter vectors and distance matrix\n        chi_vec = np.array([PARAMS[atom['label'][0]]['chi'] for atom in atoms])\n        eta_vec = np.array([PARAMS[atom['label'][0]]['eta'] for atom in atoms])\n        \n        dist_matrix = np.zeros((num_atoms, num_atoms))\n        for i in range(num_atoms):\n            for j in range(i + 1, num_atoms):\n                dist = np.linalg.norm(atoms[i]['pos'] - atoms[j]['pos'])\n                dist_matrix[i, j] = dist\n                dist_matrix[j, i] = dist\n\n        # 3. Construct the linear system M*x = b\n        M = np.zeros((num_atoms + 1, num_atoms + 1))\n        b = np.zeros(num_atoms + 1)\n        \n        # Populate A matrix part (interaction matrix)\n        for i in range(num_atoms):\n            M[i, i] = eta_vec[i]\n            for j in range(num_atoms):\n                if i != j:\n                    M[i, j] = 1.0 / dist_matrix[i, j]\n\n        # Populate other parts of M\n        M[:num_atoms, num_atoms] = -1.0  # -1 column for lambda\n        M[num_atoms, :num_atoms] = 1.0   # 1 row for sum(q_i) constraint\n        \n        # Populate b vector\n        b[:num_atoms] = -chi_vec\n        b[num_atoms] = q_tot\n        \n        # 4. Solve for charges\n        solution = np.linalg.solve(M, b)\n        charges = solution[:num_atoms]\n        \n        atom_charges = {atoms[i]['label']: charges[i] for i in range(num_atoms)}\n\n        # 5. Calculate required outputs\n        \n        # q_P\n        q_p = atom_charges['P']\n\n        # Average charge of unprotonated oxygens\n        unprot_o_labels = [f'O{k}' for k in range(s + 1, 5)]\n        if not unprot_o_labels: # s=4 case not in this problem, but good practice\n            # for s=3, the unprotonated list is ['O4']\n            if s==3:\n                unprot_o_labels = ['O4']\n            else:\n                 avg_q_o = 0.0 # Or handle as error\n        \n        # Correctly handle unprotonated oxygens for all states\n        unprot_o_indices = []\n        if s == 0: unprot_o_indices = [1, 2, 3, 4] # O1, O2, O3, O4\n        if s == 1: unprot_o_indices = [2, 3, 4] # O2, O3, O4\n        if s == 2: unprot_o_indices = [3, 4] # O3, O4\n        if s == 3: unprot_o_indices = [4] # O4\n\n        unprot_o_charges = [atom_charges[f'O{k}'] for k in unprot_o_indices]\n        avg_q_o = np.mean(unprot_o_charges) if unprot_o_charges else 0.0\n        \n        # ESP at probe points\n        esp_values = []\n        positions = np.array([atom['pos'] for atom in atoms])\n        for probe_name in ['far', 'u1', 'x']:\n            probe_pos = PROBE_POINTS[probe_name]\n            # dists shape: (num_atoms,)\n            dists = np.linalg.norm(positions - probe_pos, axis=1)\n            # ESP calculation\n            esp = np.sum(charges / dists)\n            esp_values.append(esp)\n        v_far, v_u1, v_x = esp_values\n\n        all_results.extend([q_p, avg_q_o, v_far, v_u1, v_x])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join([f'{r:.6f}' for r in all_results])}]\")\n\nsolve()\n```", "id": "2454820"}, {"introduction": "掌握了电荷分布，我们就可以预测分子的静电势（Electrostatic Potential, ESP），这是决定其与其他分子相互作用的关键。本练习 [@problem_id:2454844] 将一个取代芳环简化为点电荷体系，以探究取代基如何改变静电势。你将发现一个关键原理：由于对称性，环上方特殊点的电势仅取决于转移的总电荷量，而与其具体排布无关。这个实践展示了基本的静电学原理如何能提供深刻的化学见解。", "problem": "您需要仅使用真空中的经典静电学第一性原理，来模拟苯环中心上方由于被给电子基（EDG）或吸电子基（EWG）取代而引起的静电势（ESP）变化。将取代基效应表示为环与取代基之间的电荷转移对：从取代基向环转移 $\\Delta n$ 个电子（该值可为负），从而使电荷守恒。设环接收总电荷 $q_{\\text{ring}} = -\\Delta n\\,e$，该电荷通过指定的权重向量 $\\mathbf{w} = (w_0,\\dots,w_5)$（其中 $\\sum_{i=0}^{5} w_i = 1$）分布在六个环碳原子上。设取代基携带相反的点电荷 $q_{\\text{sub}} = +\\Delta n\\,e$，位于环平面内，沿 ipso 碳原子向外的径向方向上。使用以下几何结构和常量。\n\n- 几何结构：\n  - 苯环位于 $xy$ 平面内，中心在原点，$z$ 轴垂直于该平面。六个碳原子的位置在一个半径为 $R$ 的正六边形上，极角为 $\\theta_i = i\\pi/3$，$i \\in \\{0,1,2,3,4,5\\}$，即位于 $\\mathbf{r}_i = (R\\cos\\theta_i, R\\sin\\theta_i, 0)$。\n  - ipso 位置在 $\\theta_0 = 0$ 处，即 $(R,0,0)$。\n  - 取代基点电荷位于 $\\mathbf{r}_{\\text{sub}} = (R + d_{\\text{sub}}, 0, 0)$。\n  - ESP 评估点位于环中心上方，坐标为 $\\mathbf{r}_P = (0,0,h)$。\n- 常量和参数：\n  - 基本电荷 $e = 1.602176634\\times 10^{-19}\\,\\text{C}$。\n  - 真空介电常数 $\\varepsilon_0 = 8.8541878128\\times 10^{-12}\\,\\text{F}\\,\\text{m}^{-1}$。\n  - 库仑常数 $k = \\dfrac{1}{4\\pi \\varepsilon_0}$。\n  - 环半径 $R = 1.397\\times 10^{-10}\\,\\text{m}$。\n  - 取代基位移 $d_{\\text{sub}} = 1.400\\times 10^{-10}\\,\\text{m}$。\n\n使用真空中点电荷的静电势定义：对于位于位置 $\\mathbf{r}_j$ 的点电荷 $q_j$，在 $\\mathbf{r}_P$ 点的电势为\n$$\nV(\\mathbf{r}_P) = k \\sum_j \\frac{q_j}{\\lVert \\mathbf{r}_P - \\mathbf{r}_j \\rVert}.\n$$\n在此模型中，源电荷是位于 $\\mathbf{r}_i$ 的六个环点电荷 $q_i = q_{\\text{ring}}\\,w_i$ 和位于 $\\mathbf{r}_{\\text{sub}}$ 的取代基点电荷 $q_{\\text{sub}}$。给电子基对应于 $\\Delta n > 0$，吸电子基对应于 $\\Delta n  0$。总电势是所有七个源电荷贡献的代数和。最终的 ESP 值以伏特表示。\n\n为以下测试套件计算 $V(\\mathbf{r}_P)$。每个案例指定了 $(\\Delta n, h, \\mathbf{w})$。高度 $h$ 以埃（$\\text{\\AA}$）为单位给出，计算时必须转换为米。权重 $\\mathbf{w}$ 是无量纲的，且满足 $\\sum_i w_i = 1$。\n\n- 测试 1 (给电子基，均匀重分布)：$\\Delta n = 0.20$, $h = 3.0\\,\\text{\\AA}$, $\\mathbf{w} = \\left(\\dfrac{1}{6}, \\dfrac{1}{6}, \\dfrac{1}{6}, \\dfrac{1}{6}, \\dfrac{1}{6}, \\dfrac{1}{6}\\right)$。\n- 测试 2 (吸电子基，均匀重分布)：$\\Delta n = -0.20$, $h = 3.0\\,\\text{\\AA}$, $\\mathbf{w} = \\left(\\dfrac{1}{6}, \\dfrac{1}{6}, \\dfrac{1}{6}, \\dfrac{1}{6}, \\dfrac{1}{6}, \\dfrac{1}{6}\\right)$。\n- 测试 3 (给电子基，对位定域重分布)：$\\Delta n = 0.20$, $h = 0.0\\,\\text{\\AA}$, $\\mathbf{w} = \\left(0, 0, 0, 1, 0, 0\\right)$。\n- 测试 4 (无净转移，参考)：$\\Delta n = 0.00$, $h = 3.0\\,\\text{\\AA}$, $\\mathbf{w} = \\left(\\dfrac{1}{6}, \\dfrac{1}{6}, \\dfrac{1}{6}, \\dfrac{1}{6}, \\dfrac{1}{6}, \\dfrac{1}{6}\\right)$。\n- 测试 5 (弱给电子基，远场)：$\\Delta n = 0.05$, $h = 10.0\\,\\text{\\AA}$, $\\mathbf{w} = \\left(\\dfrac{1}{6}, \\dfrac{1}{6}, \\dfrac{1}{6}, \\dfrac{1}{6}, \\dfrac{1}{6}, \\dfrac{1}{6}\\right)$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，例如 $[\\text{result}_1,\\text{result}_2,\\dots]$。每个结果必须是 $\\mathbf{r}_P$ 点的 ESP（单位为伏特），并四舍五入到六位小数。", "solution": "该问题要求计算在取代苯环中心上方的指定点 $\\mathbf{r}_P$ 处的静电势（ESP），记为 $V$。该模型基于真空中的经典静电学，其中取代基效应由一个包含七个点电荷的系统表示。\n\n解决此问题的基本原理是库仑定律，用于计算由位于位置 $\\mathbf{r}_j$ 的离散点电荷集 $q_j$ 产生的静电势。在点 $\\mathbf{r}_P$ 的电势由每个电荷产生的电势的代数和给出：\n$$\nV(\\mathbf{r}_P) = k \\sum_j \\frac{q_j}{\\lVert \\mathbf{r}_P - \\mathbf{r}_j \\rVert}\n$$\n其中 $k = \\frac{1}{4\\pi\\varepsilon_0}$ 是库仑常数，$\\lVert \\cdot \\rVert$ 表示欧几里得距离。\n\n该系统由七个点电荷组成：\n1.  六个电荷，$q_i$，$i \\in \\{0, 1, \\dots, 5\\}$，代表苯环上的电荷分布。它们位于半径为 $R$ 的六边形上的位置 $\\mathbf{r}_i = (R\\cos(i\\pi/3), R\\sin(i\\pi/3), 0)$。每个碳原子上的电荷为 $q_i = q_{\\text{ring}} w_i = (-\\Delta n\\,e) w_i$，其中 $\\Delta n$ 是转移的电子数，$e$ 是基本电荷，$\\mathbf{w}=(w_0, \\dots, w_5)$ 是满足 $\\sum_{i=0}^{5} w_i = 1$ 的权重向量。\n2.  一个电荷，$q_{\\text{sub}}$，代表取代基。这是一个点电荷 $q_{\\text{sub}} = +\\Delta n\\,e$，位于 $\\mathbf{r}_{\\text{sub}} = (R+d_{\\text{sub}}, 0, 0)$。\n\n在评估点 $\\mathbf{r}_P = (0,0,h)$ 的总 ESP 是环电荷的电势贡献 $V_{\\text{ring}}(\\mathbf{r}_P)$ 和取代基电荷的电势贡献 $V_{\\text{sub}}(\\mathbf{r}_P)$ 之和。\n$$\nV(\\mathbf{r}_P) = V_{\\text{ring}}(\\mathbf{r}_P) + V_{\\text{sub}}(\\mathbf{r}_P)\n$$\n\n首先，我们计算取代基电荷 $q_{\\text{sub}}$ 在 $\\mathbf{r}_{\\text{sub}}$ 处产生的电势。$\\mathbf{r}_P$ 和 $\\mathbf{r}_{\\text{sub}}$ 之间的距离是：\n$$\n\\lVert \\mathbf{r}_P - \\mathbf{r}_{\\text{sub}} \\rVert = \\lVert (0,0,h) - (R+d_{\\text{sub}}, 0, 0) \\rVert = \\sqrt{(R+d_{\\text{sub}})^2 + 0^2 + h^2} = \\sqrt{(R+d_{\\text{sub}})^2 + h^2}\n$$\n因此，来自取代基的电势是：\n$$\nV_{\\text{sub}}(\\mathbf{r}_P) = k \\frac{q_{\\text{sub}}}{\\lVert \\mathbf{r}_P - \\mathbf{r}_{\\text{sub}} \\rVert} = k \\frac{+\\Delta n\\,e}{\\sqrt{(R+d_{\\text{sub}})^2 + h^2}}\n$$\n\n接下来，我们计算来自六个环电荷 $q_i$ 的电势。该电势是这些电荷贡献的总和：\n$$\nV_{\\text{ring}}(\\mathbf{r}_P) = k \\sum_{i=0}^{5} \\frac{q_i}{\\lVert \\mathbf{r}_P - \\mathbf{r}_i \\rVert} = k \\sum_{i=0}^{5} \\frac{(-\\Delta n\\,e) w_i}{\\lVert \\mathbf{r}_P - \\mathbf{r}_i \\rVert}\n$$\n这个问题的一个关键方面是其高度对称性。评估点 $\\mathbf{r}_P = (0,0,h)$ 位于六边形环的主对称轴上。因此，从 $\\mathbf{r}_P$ 到任意一个位于 $\\mathbf{r}_i$ 的碳原子的距离都是相同的。让我们计算这个距离：\n$$\n\\lVert \\mathbf{r}_P - \\mathbf{r}_i \\rVert = \\lVert (0,0,h) - (R\\cos(i\\pi/3), R\\sin(i\\pi/3), 0) \\rVert = \\sqrt{(-R\\cos(i\\pi/3))^2 + (-R\\sin(i\\pi/3))^2 + h^2}\n$$\n$$\n\\lVert \\mathbf{r}_P - \\mathbf{r}_i \\rVert = \\sqrt{R^2(\\cos^2(i\\pi/3) + \\sin^2(i\\pi/3)) + h^2} = \\sqrt{R^2+h^2}\n$$\n这个距离与索引 $i$ 无关。这对任何 $h$ 值都成立，包括 $h=0$ 的情况，此时距离就简化为 $R$。\n将这个恒定的距离代回到 $V_{\\text{ring}}(\\mathbf{r}_P)$ 的表达式中：\n$$\nV_{\\text{ring}}(\\mathbf{r}_P) = k \\sum_{i=0}^{5} \\frac{(-\\Delta n\\,e) w_i}{\\sqrt{R^2+h^2}} = \\frac{-k \\Delta n\\,e}{\\sqrt{R^2+h^2}} \\sum_{i=0}^{5} w_i\n$$\n考虑到权重之和为 1 的约束条件，即 $\\sum_{i=0}^{5} w_i = 1$，表达式简化为：\n$$\nV_{\\text{ring}}(\\mathbf{r}_P) = \\frac{-k \\Delta n\\,e}{\\sqrt{R^2+h^2}}\n$$\n这个结果表明，对于中心轴上的评估点，来自环电荷分布的电势仅取决于环上的总电荷 $q_{\\text{ring}}$，而与电荷在碳原子间的具体分布无关。因此，只要权重向量 $\\mathbf{w}$ 是归一化的，其具体形式与最终计算无关。\n\n总电势 $V(\\mathbf{r}_P)$ 是两个贡献之和：\n$$\nV(\\mathbf{r}_P) = k \\frac{\\Delta n\\,e}{\\sqrt{(R+d_{\\text{sub}})^2 + h^2}} + \\frac{-k \\Delta n\\,e}{\\sqrt{R^2+h^2}}\n$$\n提取公因式，我们得到 ESP 的最终解析表达式：\n$$\nV(\\mathbf{r}_P) = k \\Delta n\\,e \\left( \\frac{1}{\\sqrt{(R+d_{\\text{sub}})^2 + h^2}} - \\frac{1}{\\sqrt{R^2+h^2}} \\right)\n$$\n这个单一公式对问题中指定的所有测试案例都有效。计算过程是通过代入给定的 $R$、$d_{\\text{sub}}$、$e$、$\\varepsilon_0$ 的值，以及特定案例的参数 $\\Delta n$ 和 $h$ 来进行的。请注意，以埃（$\\text{\\AA}$）为单位的 $h$ 值必须转换为米（$1\\,\\text{\\AA} = 10^{-10}\\,\\text{m}$），以与其他国际单位制（SI）单位保持一致。\n\n对于给电子基（EDG），$\\Delta n > 0$，环变得更负，并且由于取代基离中心轴比环更远，括号中的项为负，导致 $V  0$。对于吸电子基（EWG），$\\Delta n  0$，环变得更正，且 $V > 0$。这与化学直觉相符。如果 $\\Delta n = 0$，则没有电荷转移，电势 $V$ 被正确地计算为 0。程序实现将把这个推导出的公式应用于每个测试案例。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the electrostatic potential (ESP) for several test cases\n    based on a simplified model of a substituted benzene ring.\n    \"\"\"\n    # Define physical constants\n    E = 1.602176634e-19  # Elementary charge in C\n    EPSILON_0 = 8.8541878128e-12  # Vacuum permittivity in F/m\n    K = 1 / (4 * np.pi * EPSILON_0)  # Coulomb constant in N m^2 C^-2\n    \n    # Define geometric constants\n    R = 1.397e-10  # Ring radius in meters\n    D_SUB = 1.400e-10  # Substituent displacement in meters\n    \n    # Define test cases from the problem statement\n    # Each case is a tuple: (delta_n, h_angstrom, weights_vector)\n    test_cases = [\n        (0.20, 3.0, (1/6, 1/6, 1/6, 1/6, 1/6, 1/6)),\n        (-0.20, 3.0, (1/6, 1/6, 1/6, 1/6, 1/6, 1/6)),\n        (0.20, 0.0, (0, 0, 0, 1, 0, 0)),\n        (0.00, 3.0, (1/6, 1/6, 1/6, 1/6, 1/6, 1/6)),\n        (0.05, 10.0, (1/6, 1/6, 1/6, 1/6, 1/6, 1/6)),\n    ]\n\n    def calculate_esp(delta_n, h_meters):\n        \"\"\"\n        Calculates the ESP in volts based on the derived formula.\n        \n        Args:\n            delta_n (float): The number of electrons transferred.\n            h_meters (float): The height above the ring center in meters.\n        \n        Returns:\n            float: The calculated electrostatic potential in volts.\n        \"\"\"\n        if delta_n == 0.0:\n            return 0.0\n            \n        # Due to the symmetry of the evaluation point on the central axis,\n        # the specific weights of charge distribution on the ring are irrelevant\n        # as long as they sum to 1. The potential depends only on the total ring charge.\n        \n        # Distance from evaluation point to the substituent\n        dist_sub = np.sqrt((R + D_SUB)**2 + h_meters**2)\n        \n        # Distance from evaluation point to any of the ring carbons\n        dist_ring = np.sqrt(R**2 + h_meters**2)\n        \n        # The main derived formula for the potential\n        potential = K * delta_n * E * (1 / dist_sub - 1 / dist_ring)\n        \n        return potential\n\n    results = []\n    for case in test_cases:\n        delta_n_val, h_angstrom_val, _ = case\n        \n        # Convert height from Ångströms to meters\n        h_meters_val = h_angstrom_val * 1e-10\n        \n        # Calculate the result for the current case\n        result = calculate_esp(delta_n_val, h_meters_val)\n        results.append(result)\n\n    # Format the results to six decimal places as requested\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2454844"}, {"introduction": "除了离散的部分电荷，连续的电子密度场 $\\rho(\\mathbf{r})$ 本身蕴含着更丰富的化学信息。分子中的原子量子理论（Quantum Theory of Atoms in Molecules, QTAIM）提供了一个严谨的数学框架来提取这些信息。本练习 [@problem_id:2454845] 将引导你在由范德华力结合的氦二聚体中寻找一个键临界点（Bond Critical Point, BCP），这是化学键理论中的一个经典例子。通过这个解析练习，你将学习 BCP 的精确拓扑定义，并了解它如何应用于即使是非常弱的相互作用中。", "problem": "您将为一个由氦原子组成的同核双原子范德华斯对建模，其电子密度及其拓扑结构。原子间距为 $R$（以原子单位，即玻尔，计）。在玻恩-奥本海默近似下，用一个具有有效核电荷 $Z_{\\mathrm{eff}}$ 的类氢 $1s$ 轨道来近似每个氦原子，并使用前分子近似，其中总电子密度 $\\rho(\\mathbf{r})$ 是以两个固定原子核为中心的球形原子密度之和。使用标准的类氢 $1s$ 轨道 $\\psi_{1s}^{Z}(\\mathbf{r})$ 和氦的双电子 $1s$ 壳层的定义 $\\rho(\\mathbf{r}) = 2 \\lvert \\psi_{1s}^{Z}(\\mathbf{r}) \\rvert^2$。将原子核置于 $x$ 轴上的 $\\mathbf{R}_A = (-R/2, 0, 0)$ 和 $\\mathbf{R}_B = (R/2, 0, 0)$ 处，这样中点就位于 $\\mathbf{r}_m = (0,0,0)$。所有计算完全采用原子单位，其中玻尔半径为 $a_0 = 1$。\n\n根据分子中原子的量子理论 (QTAIM)，键临界点 (Bond Critical Point) 是指这样一个点 $\\mathbf{r}_c$：其梯度 $\\nabla \\rho(\\mathbf{r}_c) = \\mathbf{0}$，且其二阶导数的黑塞矩阵 $H(\\mathbf{r}_c)$ 恰好有两个负特征值和一个正特征值（一个 $(3,-1)$ 临界点）。拉普拉斯算符为 $\\nabla^2 \\rho(\\mathbf{r}) = \\mathrm{tr}\\, H(\\mathbf{r})$。\n\n您的任务是编写一个完整的程序，对于下方的每个测试用例，使用第一性原理和核心定义完成以下所有操作：\n\n- 使用具有有效电荷 $Z_{\\mathrm{eff}}$ 的类氢 $1s$ 形式，为两个氦原子构建前分子电子密度 $\\rho(\\mathbf{r})$。\n- 利用对称性和严格的微积分定义，通过计算 $\\nabla \\rho(\\mathbf{r}_m)$ 并检查其是否在严格的数值容差内为零，来评估中点 $\\mathbf{r}_m$ 是否为临界点。\n- 计算黑塞矩阵 $H(\\mathbf{r}_m)$ 及其特征值，并通过验证恰好有两个负特征值和一个正特征值，来确定中点是否为键临界点。\n- 报告电子密度 $\\rho(\\mathbf{r}_m)$（单位为 bohr$^{-3}$）、拉普拉斯值 $\\nabla^2 \\rho(\\mathbf{r}_m)$（单位为 bohr$^{-5}$）、一个指示中点是否为键临界点的布尔值，以及特征值符号整数 $s$。$s$ 定义为三个特征值符号之和，符号约定为：若 $x > \\tau$，则 $\\mathrm{sign}(x) = +1$；若 $x  -\\tau$，则 $\\mathrm{sign}(x) = -1$；否则 $\\mathrm{sign}(x) = 0$，其中 $\\tau$ 是一个小的正容差。\n\n您的推理和代码中所有的数学符号和数字都应与上述定义一致。不涉及角度。所有长度以玻尔 (bohr) 表示，电子密度以 bohr$^{-3}$ 表示，拉普拉斯值以 bohr$^{-5}$ 表示。\n\n测试集。对于下面的每一对 $(Z_{\\mathrm{eff}}, R)$，请按要求在中点 $\\mathbf{r}_m$ 处进行评估：\n\n- 情况 1：$Z_{\\mathrm{eff}} = 1.6875$，$R = 3.0$。\n- 情况 2：$Z_{\\mathrm{eff}} = 1.6875$，$R = 1.0$。\n- 情况 3：$Z_{\\mathrm{eff}} = 1.0$，$R = 2.1$。\n- 情况 4：$Z_{\\mathrm{eff}} = 2.0$，$R = 0.9$。\n- 情况 5：$Z_{\\mathrm{eff}} = 1.6875$，$R = 20.0$。\n\n最终输出格式。您的程序应生成单行输出，其中包含五个测试用例的结果。结果是一个用方括号括起来的逗号分隔列表，每个用例的结果本身是一个包含四项的列表，顺序为 $[\\rho(\\mathbf{r}_m), \\nabla^2 \\rho(\\mathbf{r}_m), \\text{is\\_BCP}, s]$。对于数值，请使用科学记数法打印，并精确到六位有效数字。例如，一个有效的最终行可能如下所示\n\"[[1.234000e-02,5.678000e-04,True,-1],[...],[...],[...],[...]]\"。", "solution": "所呈现的问题陈述是计算化学领域中一个定义明确且具有科学依据的练习，具体涉及分子中原子的量子理论 (QTAIM)。它要求对一个简单模型系统的电子密度拓扑进行分析。该问题是自洽的，其前提在事实上是合理的，并且没有会妨碍唯一解的歧义。因此，我将进行严谨的推导和求解。\n\n该问题要求分析两个相距为 $R$ 的氦原子的前分子电子密度 $\\rho(\\mathbf{r})$。原子核位于原子单位下的 $\\mathbf{R}_A = (-R/2, 0, 0)$ 和 $\\mathbf{R}_B = (R/2, 0, 0)$。总密度是各个原子密度的叠加：\n$$\n\\rho(\\mathbf{r}) = \\rho_A(\\mathbf{r}) + \\rho_B(\\mathbf{r})\n$$\n每个氦原子都由一个具有有效核电荷 $Z_{\\mathrm{eff}}$（我们将其表示为 $Z$）的类氢 $1s$ 轨道建模。以原点为中心的归一化类氢 $1s$ 轨道为：\n$$\n\\psi_{1s}^{Z}(\\mathbf{r}) = \\frac{Z^{3/2}}{\\sqrt{\\pi}} e^{-Z|\\mathbf{r}|}\n$$\n因此，一个在 $1s$ 壳层中有两个电子的氦原子的电子密度为：\n$$\n\\rho_{\\text{atom}}(\\mathbf{r}) = 2 |\\psi_{1s}^{Z}(\\mathbf{r})|^2 = 2 \\left( \\frac{Z^{3/2}}{\\sqrt{\\pi}} e^{-Z|\\mathbf{r}|} \\right)^2 = \\frac{2Z^3}{\\pi} e^{-2Z|\\mathbf{r}|}\n$$\n对于我们系统中的两个原子，从一点 $\\mathbf{r}=(x,y,z)$ 到原子核的距离为 $r_A = |\\mathbf{r} - \\mathbf{R}_A|$ 和 $r_B = |\\mathbf{r} - \\mathbf{R}_B|$。总前分子密度为：\n$$\n\\rho(\\mathbf{r}) = \\frac{2Z^3}{\\pi} \\left( e^{-2Zr_A} + e^{-2Zr_B} \\right)\n$$\n我们的任务是分析原子核连线中点 $\\mathbf{r}_m = (0,0,0)$ 处的密度性质。\n\n步骤 1：中点处的电子密度 $\\rho(\\mathbf{r}_m)$\n在中点 $\\mathbf{r}_m=(0,0,0)$ 处，到两个原子核的距离相等：\n$$\nr_A(\\mathbf{r}_m) = |\\mathbf{r}_m - \\mathbf{R}_A| = |(0,0,0) - (-R/2, 0, 0)| = R/2\n$$\n$$\nr_B(\\mathbf{r}_m) = |\\mathbf{r}_m - \\mathbf{R}_B| = |(0,0,0) - (R/2, 0, 0)| = R/2\n$$\n将这些值代入密度表达式：\n$$\n\\rho(\\mathbf{r}_m) = \\frac{2Z^3}{\\pi} \\left( e^{-2Z(R/2)} + e^{-2Z(R/2)} \\right) = \\frac{2Z^3}{\\pi} \\left( 2 e^{-ZR} \\right)\n$$\n$$\n\\rho(\\mathbf{r}_m) = \\frac{4Z^3}{\\pi} e^{-ZR}\n$$\n单位为 bohr$^{-3}$，符合要求。\n\n步骤 2：中点处的密度梯度 $\\nabla \\rho(\\mathbf{r}_m)$\n临界点 $\\mathbf{r}_c$ 由条件 $\\nabla \\rho(\\mathbf{r}_c) = \\mathbf{0}$ 定义。我们必须计算 $\\rho(\\mathbf{r})$ 的梯度并在 $\\mathbf{r}_m$ 处求值。\n令 $C = 2Z^3 / \\pi$。梯度为：\n$$\n\\nabla \\rho(\\mathbf{r}) = C \\nabla \\left( e^{-2Zr_A} + e^{-2Zr_B} \\right) = -2ZC \\left( e^{-2Zr_A} \\nabla r_A + e^{-2Zr_B} \\nabla r_B \\right)\n$$\n使用 $\\nabla r_A = \\frac{\\mathbf{r} - \\mathbf{R}_A}{r_A}$ 和 $\\nabla r_B = \\frac{\\mathbf{r} - \\mathbf{R}_B}{r_B}$：\n$$\n\\nabla \\rho(\\mathbf{r}) = -2ZC \\left( e^{-2Zr_A} \\frac{\\mathbf{r} - \\mathbf{R}_A}{r_A} + e^{-2Zr_B} \\frac{\\mathbf{r} - \\mathbf{R}_B}{r_B} \\right)\n$$\n在中点 $\\mathbf{r}_m = (0,0,0)$ 处，我们有 $r_A = r_B = R/2$。同时，$\\mathbf{r}_m - \\mathbf{R}_A = (R/2, 0, 0)$ 和 $\\mathbf{r}_m - \\mathbf{R}_B = (-R/2, 0, 0)$。\n$$\n\\nabla \\rho(\\mathbf{r}_m) = -2ZC e^{-ZR} \\left( \\frac{(R/2, 0, 0)}{R/2} + \\frac{(-R/2, 0, 0)}{R/2} \\right)\n$$\n$$\n\\nabla \\rho(\\mathbf{r}_m) = -2ZC e^{-ZR} \\left( (1,0,0) + (-1,0,0) \\right) = -2ZC e^{-ZR} (0,0,0) = \\mathbf{0}\n$$\n由于系统的对称性，中点处的梯度在解析上为零。因此，对于任何 $Z>0$ 和 $R>0$，$\\mathbf{r}_m$ 都是一个临界点。\n\n步骤 3：黑塞矩阵、特征值和 BCP 分类\n为对临界点进行分类，我们必须计算黑塞矩阵 $H_{ij}(\\mathbf{r}_m) = \\frac{\\partial^2 \\rho}{\\partial x_i \\partial x_j}|_{\\mathbf{r}_m}$ 并求出其特征值。黑塞矩阵是可加的：$H(\\rho) = H(\\rho_A) + H(\\rho_B)$。\n对于单个球对称密度贡献 $f(r) = \\frac{2Z^3}{\\pi}e^{-2Zr}$，在相对于其中心的点 $\\mathbf{v}$ 处的黑塞矩阵元素由下式给出：\n$$\nH_{ij}(f) = \\left(\\frac{f'' - f'/r}{r^2}\\right) v_i v_j + \\frac{f'}{r} \\delta_{ij}\n$$\n其中 $f'(r) = -2Z f(r)$ 且 $f''(r) = 4Z^2 f(r)$。\n对于原子 A，求值点为 $\\mathbf{v}_A = \\mathbf{r}_m - \\mathbf{R}_A = (R/2, 0, 0)$，因此 $r_A = R/2$。由于与 $x$ 轴对齐，原子 A 在 $\\mathbf{r}_m$ 处的黑塞矩阵将是对角的。纵向曲率（沿 $x$ 轴）为 $f''(r_A)$，两个横向曲率（沿 $y, z$ 轴）为 $f'(r_A)/r_A$。\n$$\n\\frac{\\partial^2 \\rho_A}{\\partial x^2}\\bigg|_{\\mathbf{r}_m} = f''(R/2) = 4Z^2 \\left( \\frac{2Z^3}{\\pi} e^{-ZR} \\right) = \\frac{8Z^5}{\\pi} e^{-ZR}\n$$\n$$\n\\frac{\\partial^2 \\rho_A}{\\partial y^2}\\bigg|_{\\mathbf{r}_m} = \\frac{\\partial^2 \\rho_A}{\\partial z^2}\\bigg|_{\\mathbf{r}_m} = \\frac{f'(R/2)}{R/2} = \\frac{-2Z f(R/2)}{R/2} = - \\frac{4Z}{R} \\left( \\frac{2Z^3}{\\pi} e^{-ZR} \\right) = - \\frac{8Z^4}{\\pi R} e^{-ZR}\n$$\n根据对称性，原子 B 在 $\\mathbf{r}_m$ 处的黑塞矩阵是相同的。总黑塞矩阵 $H(\\mathbf{r}_m)$ 是单个原子黑塞矩阵的两倍：\n$$\nH(\\mathbf{r}_m) = H(\\rho_A)|_{\\mathbf{r}_m} + H(\\rho_B)|_{\\mathbf{r}_m} = 2 H(\\rho_A)|_{\\mathbf{r}_m}\n$$\n特征值即为对角线元素：\n$$\n\\lambda_1 = \\frac{\\partial^2 \\rho}{\\partial x^2}\\bigg|_{\\mathbf{r}_m} = 2 \\frac{\\partial^2 \\rho_A}{\\partial x^2}\\bigg|_{\\mathbf{r}_m} = \\frac{16Z^5}{\\pi} e^{-ZR}\n$$\n$$\n\\lambda_2 = \\frac{\\partial^2 \\rho}{\\partial y^2}\\bigg|_{\\mathbf{r}_m} = 2 \\frac{\\partial^2 \\rho_A}{\\partial y^2}\\bigg|_{\\mathbf{r}_m} = -\\frac{16Z^4}{\\pi R} e^{-ZR}\n$$\n$$\n\\lambda_3 = \\frac{\\partial^2 \\rho}{\\partial z^2}\\bigg|_{\\mathbf{r}_m} = \\lambda_2\n$$\n对于任何正的 $Z$ 和 $R$，都有 $\\lambda_1 > 0$ 且 $\\lambda_2 = \\lambda_3  0$。黑塞矩阵有一个正特征值和两个负特征值。这对应于一个 $(3, -1)$ 临界点，根据定义，它是一个键临界点 (BCP)。因此，对于所有测试用例，中点都是一个 BCP。变量 `is_BCP` 始终为 `True`。\n\n特征值符号整数 $s$ 是特征值符号的总和。使用一个小的正容差 $\\tau > 0$，我们有 $\\mathrm{sign}(\\lambda_1)=+1$ 和 $\\mathrm{sign}(\\lambda_2)=\\mathrm{sign}(\\lambda_3)=-1$。\n$$\ns = (+1) + (-1) + (-1) = -1\n$$\n这对所有测试用例都是一个常数。\n\n步骤 4：密度的拉普拉斯算符 $\\nabla^2 \\rho(\\mathbf{r}_m)$\n拉普拉斯算符是黑塞矩阵的迹，$\\nabla^2 \\rho(\\mathbf{r}_m) = \\mathrm{tr}(H(\\mathbf{r}_m)) = \\lambda_1 + \\lambda_2 + \\lambda_3$。\n$$\n\\nabla^2 \\rho(\\mathbf{r}_m) = \\frac{16Z^5}{\\pi} e^{-ZR} - \\frac{16Z^4}{\\pi R} e^{-ZR} - \\frac{16Z^4}{\\pi R} e^{-ZR}\n$$\n$$\n\\nabla^2 \\rho(\\mathbf{r}_m) = \\frac{16Z^4}{\\pi} e^{-ZR} \\left( Z - \\frac{2}{R} \\right)\n$$\n单位为 bohr$^{-5}$，符合要求。\n\n用于实现的公式摘要：\n- 电子密度: $\\rho(\\mathbf{r}_m) = \\frac{4Z^3}{\\pi} e^{-ZR}$\n- 拉普拉斯值: $\\nabla^2 \\rho(\\mathbf{r}_m) = \\frac{16Z^4}{\\pi} e^{-ZR} \\left( Z - \\frac{2}{R} \\right)$\n- BCP 状态: 始终为 `True`。\n- 特征值符号整数 $s$: 始终为 $-1$。\n\n将实现这些公式来计算每个测试用例所需的值。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes electron density properties at the midpoint between two helium atoms.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple (Z_eff, R).\n    test_cases = [\n        (1.6875, 3.0),\n        (1.6875, 1.0),\n        (1.0, 2.1),\n        (2.0, 0.9),\n        (1.6875, 20.0),\n    ]\n\n    results = []\n    for Z_eff, R in test_cases:\n        # Based on the analytical derivation presented in the solution, for the\n        # promolecular model of two 1s orbitals, the midpoint is always a\n        # Bond Critical Point (BCP). This is because the Hessian matrix has\n        # one positive and two negative eigenvalues for any Z_eff  0 and R  0.\n        # The eigenvalues are:\n        # lambda_1 = (16 * Z_eff^5 / pi) * exp(-Z_eff * R)  0\n        # lambda_2 = lambda_3 = -(16 * Z_eff^4 / (pi * R)) * exp(-Z_eff * R)  0\n        #\n        # Therefore, 'is_BCP' is always True.\n        # The signature integer s is the sum of the signs of the eigenvalues:\n        # s = sign(lambda_1) + sign(lambda_2) + sign(lambda_3) = 1 + (-1) + (-1) = -1.\n        is_bcp = True\n        s = -1\n\n        # Calculate the electron density rho at the midpoint r_m.\n        # Formula: rho(r_m) = (4 * Z_eff^3 / pi) * exp(-Z_eff * R)\n        rho_midpoint = (4 * Z_eff**3 / np.pi) * np.exp(-Z_eff * R)\n\n        # Calculate the Laplacian of the electron density at the midpoint.\n        # Formula: laplacian(r_m) = (16 * Z_eff^4 / pi) * exp(-Z_eff * R) * (Z_eff - 2/R)\n        laplacian_midpoint = (16 * Z_eff**4 / np.pi) * np.exp(-Z_eff * R) * (Z_eff - 2.0 / R)\n\n        # Format the results for the current test case.\n        # The format string {:.6e} provides scientific notation with 1 digit\n        # before the decimal point and 6 digits after, as shown in the problem's example output.\n        case_result = (\n            f\"[{rho_midpoint:.6e},\"\n            f\"{laplacian_midpoint:.6e},\"\n            f\"{is_bcp},\"\n            f\"{s}]\"\n        )\n        results.append(case_result)\n\n    # Final print statement in the exact required format.\n    # The output is a single line: a list of lists.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2454845"}]}