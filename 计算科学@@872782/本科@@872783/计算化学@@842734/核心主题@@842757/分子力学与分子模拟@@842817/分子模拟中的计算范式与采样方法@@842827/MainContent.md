## 引言
分子模拟作为连接微观原子世界与宏观物质性质的“计算显微镜”，为我们在原子尺度上理解和预测物质行为提供了前所未有的能力。然而，如何从有限的计算轨迹中可靠地提取宏观热力学性质，并克服自然界中普遍存在的巨大时间尺度鸿沟，是该领域面临的核心挑战。本文旨在系统性地梳理应对这些挑战的计算[范式](@entry_id:161181)与[采样方法](@entry_id:141232)，为读者构建一幅从理论基础到前沿应用的完整图景。

在接下来的内容中，我们将分三部分深入探索。第一章“原理与机制”将揭示[分子动力学模拟](@entry_id:160737)的理论基石——[遍历性假设](@entry_id:147104)，并详细剖析实现稳定、高效模拟所必需的核心算法，包括[运动方程](@entry_id:170720)积分、[长程力](@entry_id:181779)处理以及温度和压强的控制。第二章“应用与跨学科连接”将通过丰富的案例，展示这些方法如何在化学、生物学、[材料科学](@entry_id:152226)乃至计算机科学和机器学习等领域解决实际问题，凸显其思想的普适性。最后，第三章“动手实践”将通过一系列思考题，帮助读者巩固对关键概念的理解。通过本次学习，你将掌握[分子模拟](@entry_id:182701)的核心技术，并学会如何应用它们来研究稀有事件、计算自由能，以及从更广阔的视角看待采样与[优化问题](@entry_id:266749)。

## 原理与机制

在上一章引言中，我们了解了[分子模拟](@entry_id:182701)作为连接微观原子行为与宏观[材料性质](@entry_id:146723)的“计算显微镜”的巨大潜力。现在，我们将深入探讨支撑这一强大工具的核心原理与具体机制。本章将阐明[分子动力学](@entry_id:147283)（MD）模拟的基石——[遍历性假设](@entry_id:147104)，并剖析实现这一理想状态所面临的实际挑战与解决方案。我们将从动力学轨迹的生成，到恒温恒压等[统计系综](@entry_id:149738)的控制，再到如何克服模拟中最根本的时间尺度限制，系统地构建一幅[分子模拟](@entry_id:182701)世界的全景图。

### [遍历性假设](@entry_id:147104)：连接动力学与[统计力](@entry_id:194984)学的桥梁

[分子动力学模拟](@entry_id:160737)的核心目标是计算系统的宏观[热力学性质](@entry_id:146047)，如能量、压强或自由能。在[统计力](@entry_id:194984)学中，这些性质被定义为在某个[统计系综](@entry_id:149738)（如[微正则系综](@entry_id:141513)或[正则系综](@entry_id:142391)）中对所有可能微观状态的**系综平均**（ensemble average）。然而，模拟只能生成系统在相空间中随[时间演化](@entry_id:153943)的一条或几条**轨迹**（trajectory）。我们实际计算的是物理量沿着这条长轨迹的**[时间平均](@entry_id:267915)**（time average）。那么，我们凭什么相信一个时间平均值能够等同于一个系综平均值呢？

这个问题的答案构成了整个分子模拟领域的理论基石——**[遍历性假设](@entry_id:147104)**（ergodic hypothesis）。该假设指出，对于一个处于平衡态的系统，只要时间足够长，单条轨迹将最终遍历相空间中所有能量允许的区域。因此，对这条无限长轨迹求[时间平均](@entry_id:267915)，其结果等同于对整个系综求平均。

更严谨地说，遍历性是确保[时间平均](@entry_id:267915)收敛于系综平均的充分条件。例如，对于一个在总能量 $E$ 恒定的微正则系综（NVE）中演化的系统，如果其[哈密顿动力学](@entry_id:156273)相对于微[正则测度](@entry_id:186011)（$\rho_{\mu c}(x) \propto \delta(H(x)-E)$）是遍历的，那么对于几乎所有的[初始条件](@entry_id:152863)，任何可积观测量 $A$ 的时间平均值都将等于其系综平均值 [@problem_id:2771917]：
$$
\lim_{T\to\infty}\frac{1}{T}\int_{0}^{T} A(x(t))\,\mathrm{d}t \;=\; \int_{\Gamma} A(x)\,\rho_{\mu c}(x)\,\mathrm{d}x
$$
类似地，对于通过[恒温器](@entry_id:169186)（如[Langevin动力学](@entry_id:142305)或[Nosé-Hoover恒温器](@entry_id:142221)）模拟的正则系综（NVT），如果动力学相对于唯一的、不变的正则[分布](@entry_id:182848)（$\rho_{\mathrm{can}}(x) \propto \exp(-\beta H(x))$）是遍历的，那么时间平均也将收敛于正确的[正则系综](@entry_id:142391)平均 [@problem_id:2771917]。

[遍历性假设](@entry_id:147104)的成立是[分子模拟](@entry_id:182701)成功的关键。然而，在两种情况下，这一假设可能会失效：

1.  **系统的内在非遍历性**：某些系统的动力学本身就是非遍历的。一个经典的例子是纯[谐振子](@entry_id:155622)系统。考虑一个由谐振子构成的[环状聚合物](@entry_id:147762)，其[哈密顿量](@entry_id:172864)为二次型 [@problem_id:2453002]。这样的系统可以通过[正交变换](@entry_id:155650)（如[傅里叶变换](@entry_id:142120)）分解为一系列相互独立的**简正模式**（normal modes）。每个[简正模](@entry_id:139640)式的能量都是独立的运动常数。这意味着，如果初始状态只激发了某个特定的低频模式，能量将永远不会传递到其他模式中去。系统的轨迹被限制在相空间的一个极小[子集](@entry_id:261956)上，永远无法探索整个[等能面](@entry_id:262911)。因此，[时间平均](@entry_id:267915)将严重偏离系综平均，基于时间平均的**[均分定理](@entry_id:136972)**（equipartition theorem）也会在此失效。[均分定理](@entry_id:136972)预测平衡态下每个二次型自由度的平均能量应均等，但在这个非遍历的轨迹中，能量将永远固着在最初被激发的模式里。

2.  **实际的非遍历性**：对于复杂的系统，如蛋白质折叠，即使其动力学在理论上是遍历的，但在有限的模拟时间内，系统可能因为巨大的能垒而被困在某个[势阱](@entry_id:151413)中。这种情况下，模拟轨迹只在相空间的一个小区域内探索，无法跨越能垒到达其他重要区域。这被称为**采样不充分**或**实际非遍历性**。此时，[时间平均](@entry_id:267915)只反映了局部区域的性质，而非整个系综的性质。

一个在实践中常见的非遍历性伪迹是所谓的“**飞行的冰块**”（flying ice cube）现象 [@problem_id:2453010]。在一个孤立的[NVE系综](@entry_id:141513)中，系统的总线动量 $\mathbf{P}$ 是一个严格的[守恒量](@entry_id:150267)。如果在模拟开始前，系统的[质心速度](@entry_id:175479)不为零（即 $\mathbf{P} \neq \mathbf{0}$），那么在整个NV[E模](@entry_id:160271)拟过程中，这个非零的[总动量](@entry_id:173071)将保持不变。这意味着一部分动能 $K_\mathrm{COM}=|\mathbf{P}|^{2}/(2M)$ 将被永久地锁定在系统的整体[平动](@entry_id:187700)中，而不能参与到内部自由度的热运动中。结果是，系统的内部动能（决定温度）会低于预期，而整个系统则像一个整体在模拟盒子中“飞行”。这标志着系统“平衡”准备阶段的严重失败，因为它未能将系统置于我们通常关心的宏观静止（$\mathbf{P} = \mathbf{0}$）的[平衡态](@entry_id:168134)，导致模拟采样的是一个具有额外[运动约束](@entry_id:168736)的非遍历[子空间](@entry_id:150286)。

因此，确保模拟的有效性不仅需要一个能够正确演化系统的积分器，还需要精心的系统准备和对系统动力学性质的深刻理解，以保证我们能够在模拟的时间尺度内实现充分的相空间采样。

### [分子动力学](@entry_id:147283)的实践：构建模拟器

生成一条有效的动力学轨迹，需要在数值上精确地求解[牛顿运动方程](@entry_id:165068)，并高效地处理粒子间的相互作用力。

#### 运动方程的积分与[时间尺度问题](@entry_id:178673)

MD模拟的核心是逐步积分[牛顿第二定律](@entry_id:274217) $m \ddot{\mathbf{r}} = -\nabla U(\mathbf{r})$。在众多[数值积分](@entry_id:136578)算法中，**[Verlet算法](@entry_id:150873)**及其变体（如速度[Verlet算法](@entry_id:150873)）因其[时间可逆性](@entry_id:274492)、辛性和优异的长期[能量守恒](@entry_id:140514)性而备受青睐。

然而，任何[数值积分](@entry_id:136578)方案的稳定性和准确性都受限于其**时间步长**（timestep） $\Delta t$ 的选择。为了稳定地积分，$\Delta t$ 必须显著小于系统中运动最快模式的周期。在典型的生物分子系统中，最快的运动是涉及最轻原子——氢——的[共价键](@entry_id:141465)的伸缩[振动](@entry_id:267781)，其周期约为10飞秒（$10 \times 10^{-15}\,\mathrm{s}$）。这迫使我们将 $\Delta t$ 限制在1-2飞秒左右。

这个微小的时间步长带来了严峻的**[时间尺度问题](@entry_id:178673)**（timescale problem）。即使采用2飞秒的步长，模拟1秒钟的物理过程也需要 $1\,\mathrm{s} / (2 \times 10^{-15}\,\mathrm{s}) = 5 \times 10^{14}$ 个积分步骤，这在计算上是遥不可及的 [@problem_id:2453043]。

为了缓解这个问题，一个非常普遍的技巧是使用**约束算法**（constraint algorithms），如**SHAKE**或**RATTLE** [@problem_id:2453064]。这些算法的作用是“冻结”系统中那些最硬、频率最高的键（通常是所有涉及氢原子的键）。其原理是通过引入**[拉格朗日乘子](@entry_id:142696)**（Lagrange multipliers）来施加[约束力](@entry_id:170052)，在每个积分步骤后将原子位置（以及速度，对于RATTLE）投影回满足[键长](@entry_id:144592)约束的[流形](@entry_id:153038)上。通过消除这些最高频的[振动](@entry_id:267781)模式，系统中最快的运动周期变长了（例如，变为键角弯曲的周期，约20-50飞秒），这使得我们可以安全地使用更大的时间步长（通常是2飞秒，相比于1飞秒是两倍的提升），从而在相同的计算成本下将模拟的总时长延长一倍。

#### 处理长程相互作用

分子间的相互作用力可以分为短程（如[范德华力](@entry_id:145564)）和长程（如静电相互作用）。在[周期性边界条件](@entry_id:147809)下处理长程相互作用是一个巨大的挑战，因为每个粒子都会与无限个周期性镜像粒子发生作用。简单地截断静电相互作用会引入严重的物理伪迹。

处理这个问题的标准方法是**Ewald求和**（Ewald summation）。其巧妙之处在于将一个缓慢收敛的[长程相互作用](@entry_id:140725)和分解为一个在实空间中快速收敛的短程[部分和](@entry_id:162077)一个在[倒易空间](@entry_id:754151)（或称傅里叶空间）中同样快速收敛的部分。

传统的Ewald方法虽然精确，但其计算成本很高。特别是[倒易空间](@entry_id:754151)部分的计算，需要对所有 $N$ 个粒子和 $K$ 个[倒易晶格矢量](@entry_id:263351)进行求和。在固定精度的要求下，所需的倒易矢量数量 $K$ 与系统体积成正比，即 $K \propto N$。这导致倒易空间部分的计算量按 $O(N^2)$ 缩放，使其成为大尺度模拟的瓶颈 [@problem_id:2453053]。

为了克服这一瓶颈，现代模拟广泛采用**粒子-网格Ewald**（[Particle-Mesh Ewald](@entry_id:140744), PME）方法。PME的核心思想是用一个高效的网格计算来替代昂贵的倒易空间直接求和。其步骤是：(1) 将粒子[电荷](@entry_id:275494)分配到三维网格上；(2) 使用**快速傅里叶变换**（Fast Fourier Transform, FFT）将网格上的电荷密度变换到[倒易空间](@entry_id:754151)；(3) 在倒易空间中进行简单的乘法运算求解[泊松方程](@entry_id:143763)；(4) 使用逆FFT将解变换回[实空间](@entry_id:754128)网格；(5) 将网格上的力插值回粒子位置。其中，计算成本最高的是FFT步骤，其复杂度为 $O(M \log M)$，其中 $M$ 是网格点数。在保持精度不变的情况下，$M$ 通常与粒子数 $N$ 成正比，因此[PME方法](@entry_id:147594)的总计算成本为 $O(N \log N)$ [@problem_id:2453053]。从 $O(N^2)$ 到 $O(N \log N)$ 的改进是革命性的，它使得对包含数十万甚至数百万个原子的大型带电系统进行模拟成为可能。

### [统计系综](@entry_id:149738)：控制温度与压强

大多数现实世界的实验是在恒定的温度和压强下进行的，而不是在孤立的恒定能量条件下。因此，我们需要特殊的算法——**恒温器**（thermostats）和**恒压器**（barostats）——来模拟[正则系综](@entry_id:142391)（NVT）和[等温等压系综](@entry_id:143530)（NPT）。

#### 恒温器：维持恒定温度

在模拟中，温度由系统的动能定义（通过均分定理）。恒温器的作用是允许系统与一个虚拟的“热浴”[交换能](@entry_id:137069)量，从而维持平均动能在一个与目标温度相对应的值。

一种非常优雅和理论上严谨的恒温方法是**[Nosé-Hoover恒温器](@entry_id:142221)**。它属于**扩展拉格朗日**方法，通过向系统引入一个额外的动力学变量 $\zeta$（及其“质量”或惯性参数 $Q$）来实现。这个变量 $\zeta$ 充当一个时间依赖的摩擦系数，根据系统瞬时动能 $K$ 与目标动能 $K_0 = \frac{g}{2}k_BT$ （$g$ 为自由度数）的偏差进行[反馈调节](@entry_id:140522) [@problem_id:2453041]。
$$
\dot{\zeta}=\frac{K-K_0}{Q}
$$
这里的参数 $Q$ 至关重要。它代表了[恒温器](@entry_id:169186)变量的“惯性”。通过对该方程进行线性化分析可以发现，$\zeta$ 的响应行为类似于一个谐振子，其[振荡](@entry_id:267781)的[特征时间尺度](@entry_id:276738) $\tau \sim \sqrt{Q/(g k_B T)}$ [@problem_id:2453041]。如果 $Q$ 太小，[恒温器](@entry_id:169186)反应过快，会导致系统温度剧烈[振荡](@entry_id:267781)，甚至使积分方程变得“刚性”，难以求解；如果 $Q$ 太大，[恒温器](@entry_id:169186)反应迟钝，系统[温度控制](@entry_id:177439)不佳，模拟行为会趋向于[NVE系综](@entry_id:141513)。正确选择 $Q$ 值是实现平稳而有效的[温度控制](@entry_id:177439)的关键。

然而，[Nosé-Hoover恒温器](@entry_id:142221)并非万能。作为一个纯粹的确定性方法，它的遍历性依赖于系统本身的混沌特性。对于规则的、非混沌的系统，如单个谐振子，[Nosé-Hoover恒温器](@entry_id:142221)会失效 [@problem_id:2453003]。在这种情况下，整个扩展系统（物理系统+[恒温器](@entry_id:169186)变量）的动力学仍然是规则的，轨迹会被限制在扩展相空间中的[不变环面](@entry_id:194783)上，无法遍历整个[正则系综](@entry_id:142391)。

与确定性[恒温器](@entry_id:169186)相对的是**[随机恒温器](@entry_id:755473)**，如**[Langevin动力学](@entry_id:142305)**。它通过在[运动方程](@entry_id:170720)中加入一个摩擦项（耗散）和一个随机力项（涨落）来模拟与溶剂分子的碰撞。根据涨落-耗散定理，只要这两项的强度满足特定关系，系统就能正确地采样正则系综。[Langevin动力学](@entry_id:142305)的随机性可以有效地破坏系统的任何内在规则性（如[简正模](@entry_id:139640)式的[能量守恒](@entry_id:140514)），从而保证遍历性，即使对于像谐振子这样的简单系统也同样有效 [@problem_id:2453002]。

#### [恒压器](@entry_id:200779)：维持恒定压强

在[NPT系综](@entry_id:143530)中，模拟盒子的体积和形状可以变化，以维持系统内部压强与外部设定压强相等。**[恒压器](@entry_id:200779)**就是实现这一功能的算法。

与恒温器类似，恒压器也有不同的设计哲学。**[Berendsen恒压器](@entry_id:138403)**是一种**弱耦合**方法 [@problem_id:2453031]。它以一种简单直接的方式工作：在每个时间步，根据瞬时压强与目标压强的差值，对模拟盒子的体积进行微小的缩放。这种方法非常高效，能够迅速地将系统的平均压强和密度调节到目标值，因此非常适合在模拟的**平衡（equilibration）**阶段使用。然而，[Berendsen恒压器](@entry_id:138403)的一个严重缺陷是它不能生成正确的[NPT系综](@entry_id:143530)。它会人为地抑制系统体积和压强的自然涨落。由于许多重要的热力学性质（如[压缩系数](@entry_id:272630)）正是通过这些涨落来计算的，因此该方法不适用于收集平衡数据的**生产（production）**阶段。

相比之下，**[Parrinello-Rahman恒压器](@entry_id:138473)**是一种基于**扩展拉格朗日**的严谨方法 [@problem_id:2453031]。它将模拟盒子的九个矩阵分量（三个边长向量）视为动力学变量，赋予它们虚拟的“质量”和动能，并让它们根据[牛顿运动方程](@entry_id:165068)演化。这种方法不仅能够正确地采样[NPT系综](@entry_id:143530)，再现正确的[体积涨落](@entry_id:141521)，而且还允许模拟盒子的**各向异性**形变（即改变盒子的角度和边长比例）。这一特性对于模拟晶体固体至关重要，因为晶体的[相变](@entry_id:147324)（如从立方相到正交相）往往伴随着[晶格](@entry_id:196752)对称性的改变，这正是通过盒子的各向异性形变来实现的。因此，[Parrinello-Rahman恒压器](@entry_id:138473)是研究固体性质和[相变](@entry_id:147324)的生产阶段模拟的标准选择。

Berendsen与Parrinello-Rahman的对比，再次凸显了[分子模拟](@entry_id:182701)中的一个核心主题：一个算法能够使系统弛豫到正确的**平均值**，并不等同于它能够正确地采样整个[热力学](@entry_id:141121)**[分布](@entry_id:182848)**。

### 稀有事件问题与高级[采样方法](@entry_id:141232)

我们已经看到，由于积分步长的限制，标准MD模拟的时间尺度通常被限制在微秒（$10^{-6}\,\mathrm{s}$）级别。但这并非唯一，甚至不是最根本的障碍。许多重要的化学和生物过程，如[化学反应](@entry_id:146973)、[蛋白质折叠](@entry_id:136349)或药物分子与靶点的结合/解离，其发生的时间尺度可能在毫秒、秒甚至更长。

这些过程之所以缓慢，并非因为其动力学本身缓慢，而是因为它们是**稀有事件**（rare events）。在系统的**自由能形貌**（free energy landscape）上，这些过程对应于从一个稳定的自由能最低点（代表反应物）跨越一个很高的**[自由能垒](@entry_id:203446)**（$\Delta F^{\ddagger}$，代表过渡态）到达另一个最低点（代表产物）。根据过渡态理论，事件发生的平均等待时间 $\tau$ 与能垒高度成指数关系：$\tau \sim \tau_{0}\,\exp(\beta \Delta F^{\ddagger})$ [@problem_id:2453043]。如果能垒高度是热能 $k_B T$ 的数倍，等待时间将变得异常漫长。标准MD模拟就像一个盲目的探索者，大部[分时](@entry_id:274419)间里系统只会在[势阱](@entry_id:151413)底部[振动](@entry_id:267781)，只有通过一次偶然的、剧烈的热涨落才可能翻越能垒。在有限的模拟时间内，观察到这样的小概率事件几乎是不可能的。

为了解决这个**采样问题**，研究人员发展了各种**增强采样**（enhanced sampling）方法。这些方法的共同核心思想是：不再被动地等待，而是主动地修改模拟过程，以加速对稀有事件的采样。一个主要的策略是修改系统的[势能函数](@entry_id:200753)，引入一个**偏置势**（bias potential）$V_{\mathrm{bias}}(\mathbf{r})$，使得新的[势能](@entry_id:748988)变为 $U_{\mathrm{bias}}(\mathbf{r}) = U(\mathbf{r}) + V_{\mathrm{bias}}(\mathbf{r})$。这个偏置势被设计用来“填平”或降低沿着某个特定**[集体变量](@entry_id:165625)**（collective variable，如原子间距离或二面角）的[自由能垒](@entry_id:203446)。

在偏置势的作用下，系统可以轻易地跨越能垒，从而在短时间内充分采样反应物、过渡态和产物区域。然而，这样得到的轨迹是基于一个非物理的、被偏置的[概率分布](@entry_id:146404) $P_{\mathrm{bias}}(\mathbf{r}) \propto \exp(-\beta U_{\mathrm{bias}}(\mathbf{r}))$。为了从这些偏置的采样中恢复原始（无偏置）[正则系综](@entry_id:142391)下的[热力学性质](@entry_id:146047)，必须进行**重加权**（reweighting）。任何观测量 $A$ 的真实系综平均值可以通过对偏置轨迹中的构象进行加权平均来计算，其权重因子为 $w(\mathbf{r}) = \exp(\beta V_{\mathrm{bias}}(\mathbf{r}))$ [@problem_id:2453043]。这种“先偏置、后修正”的[范式](@entry_id:161181)是[伞形采样](@entry_id:169754)（Umbrella Sampling）、[元动力学](@entry_id:176772)（Metadynamics）等一系列强大增强[采样方法](@entry_id:141232)的基础。

#### 计算自由能差

增强采样的目标之一是定量地描绘自由能形貌，即计算不同状态间的自由能差 $\Delta G$。**[炼金术计算](@entry_id:176497)**（alchemical calculation）是实现这一目标的一[类核](@entry_id:178267)心技术。其思想是定义一个混合势能函数 $U(\mathbf{x};\lambda)$，通过一个[耦合参数](@entry_id:747983) $\lambda$ 从0到1的变化，将系统从初始状态A（$U_A = U(\lambda=0)$）平滑地转变为最终状态B（$U_B = U(\lambda=1)$）。自由能差 $\Delta G = G_B - G_A$ 则通过对这条“炼金术路径”上的性质进行计算得到。

两种最基础的[自由能计算](@entry_id:164492)方法是**[热力学积分](@entry_id:156321)**（Thermodynamic Integration, TI）和**[自由能微扰](@entry_id:165589)**（Free Energy Perturbation, FEP）[@problem_id:2453017]。

-   **[热力学积分](@entry_id:156321) (TI)** 的基本公式是：
    $$
    \Delta G = \int_0^1 \left\langle \frac{\partial U(\mathbf{x};\lambda)}{\partial\lambda} \right\rangle_\lambda d\lambda
    $$
    这个公式的物理意义是，自由能的变化等于沿着炼金术路径推动系统所做的“功”的累积。$\langle \partial U / \partial \lambda \rangle_\lambda$ 是在给定 $\lambda$ 值下对“[广义力](@entry_id:169699)”进行的系综平均。在实践中，这意味着我们需要在多个离散的中间 $\lambda$ 值（窗口）下进行独立的模拟，计算每个窗口的[平均力](@entry_id:170826)，然后对这些力进行数值积分，得到总的自由能差。

-   **[自由能微扰](@entry_id:165589) (FEP)** 的基本公式（[Zwanzig方程](@entry_id:176184)）是：
    $$
    \Delta G = -k_{\mathrm{B}} T \ln \left\langle \exp\left[-\beta\left(U_B(\mathbf{x})-U_A(\mathbf{x})\right)\right]\right\rangle_A
    $$
    这个公式直接关联了两个状态的自由能差。它表明，我们可以通过在状态A中进行模拟，并计算[势能](@entry_id:748988)差 $\Delta U = U_B - U_A$ 的[指数平均](@entry_id:749182)值，来得到 $\Delta G$。FEP的致命弱点在于，只有当状态A和状态B的[相空间分布](@entry_id:151304)有显著**重叠**时，这个[指数平均](@entry_id:749182)才能可靠地收敛。如果两个状态相差太大，来自状态A的采样将很少访问对状态B重要的构象，导致计算结果极不稳定。因此，在实践中，FEP也常常被分阶段地应用于一系列重叠良好的中间状态（窗口）。

尽管在实际操作中，TI和FEP都常采用多窗口策略，但它们的根本区别在于其核心公式 [@problem_id:2453017]：TI通过**积分[平均力](@entry_id:170826)**来计算自由能，而FEP通过**[指数平均](@entry_id:749182)能量差**来计算。理解这些基本原理是设计和执行精确[自由能计算](@entry_id:164492)的关键。