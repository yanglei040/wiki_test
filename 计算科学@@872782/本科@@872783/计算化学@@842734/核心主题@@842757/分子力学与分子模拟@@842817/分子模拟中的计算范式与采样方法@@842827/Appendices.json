{"hands_on_practices": [{"introduction": "对于初学者来说，一个常见的困惑是在孤立（NVE）系统中温度的行为。本练习旨在挑战你思考统计力学中的基本定义。通过分析一个总能量守恒但温度剧烈波动的模拟，你将学会区分运动守恒量和统计属性，这是正确解读模拟结果的关键洞察 [@problem_id:2453071]。", "problem": "一名学生在恒定粒子数、体积、能量（NVE）系综（也称为微正则系综）中对一个孤立分子进行经典的分子动力学（MD）模拟。积分器在数值容差范围内保持总能量守恒，且随时间没有可辨别的漂移，但由瞬时动能计算得出的、由代码报告的瞬时温度，在一个稳定的长时间平均值附近剧烈波动。哪个陈述最能描述这个结果在物理上和统计上是否正确，以及为什么？\n\nA. 正确：在微正则系综中，只有总能量是运动常数；瞬时动能 $K(t)$ 与势能 $U(t)$ 相互交换，使得 $E = K(t) + U(t)$ 保持恒定。由于动能温度是通过能量均分从 $K(t)$ 定义的，因此它会波动。对于具有有限数量二次自由度 $f$ 的系统，当 $f$ 很小时，相对涨落很大，并大致按 $1/\\sqrt{f}$ 的规律减小。\n\nB. 错误：根据NVE系综的定义，总能量和温度都必须保持严格恒定；大的温度涨落意味着积分器不稳定或不准确。\n\nC. 错误：通过消除质心（COM）运动可以消除温度涨落；如果涨落持续存在，则应归咎于配置错误的恒温器。\n\nD. 正确：只有当系统与热浴耦合时，才预期出现大的温度涨落；对于一个真正孤立的NVE系统，动能温度必须是恒定的，因此观察到的行为表明存在隐藏的恒温调节。", "solution": "从经典力学和统计力学的基本原理出发。在恒定粒子数、体积、能量（NVE）系综中，一个孤立系统的经典MD轨迹中，哈密顿动力学使总能量守恒，\n$$\nE = K(t) + U(t),\n$$\n使得\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = 0.\n$$\n然而，动能 $K(t)$ 和势能 $U(t)$ 都不是单独守恒的；它们不断地相互交换，以使其总和保持不变。在经典MD中，通常报告的“瞬时温度”是通过能量均分定理从瞬时动能定义的，即\n$$\nT_{\\mathrm{inst}}(t) = \\frac{2\\,K(t)}{f\\,k_{\\mathrm{B}}},\n$$\n其中 $f$ 是二次自由度的数量，$k_{\\mathrm{B}}$ 是 Boltzmann 常数。因为即使在总能量完全守恒的情况下，$K(t)$ 也会随时间波动，所以 $T_{\\mathrm{inst}}(t)$ 同样会波动。\n\n热力学温度本质上是一个系综属性。在微正则系综中，它通过熵 $S$ 定义为\n$$\n\\frac{1}{T} = \\left(\\frac{\\partial S}{\\partial E}\\right)_{N,V}.\n$$\n在实践中，对于一个遍历系统，在足够长的NVE轨迹上对 $T_{\\mathrm{inst}}(t)$ 的时间平均值被用作热力学温度的估计量。对于具有有限自由度 $f$ 的有限系统， $K(t)$ 以及因此 $T_{\\mathrm{inst}}(t)$ 的涨落是预期的，并且当 $f$ 较小时可能很大。在正则系综中，可以证明相对方差遵循\n$$\n\\frac{\\mathrm{Var}\\left(T_{\\mathrm{inst}}\\right)}{\\langle T_{\\mathrm{inst}}\\rangle^{2}} \\approx \\frac{2}{f},\n$$\n因此相对标准差的变化规律类似于 $1/\\sqrt{f}$。对于大的 $f$，微正则系综中 $K$ 的涨落具有密切相关的标度关系，而对于小的孤立分子（小的 $f$），即使总能量完全守恒，瞬时温度通常也表现出“剧烈”的涨落。因此，对于NVE系综中的小系统，这种行为在物理上和统计上都是正确的。\n\n评估每个选项：\n\nA. 该选项正确地指出，在微正则系综中只有总能量 $E$ 是守恒的，而 $K(t)$ 以及因此 $T_{\\mathrm{inst}}(t)$ 会涨落。它还正确地陈述了相对涨落幅度对自由度数 $f$ 的依赖关系，即大致按 $1/\\sqrt{f}$ 减小。结论：正确。\n\nB. 该选项错误地声称温度是NVE系综中的一个运动常数。微正则系综的定义固定了 $E$ （以及 $N$，$V$），而不是从 $K(t)$ 定义的瞬时动能温度。如果 $E$ 是守恒的，那么 $T_{\\mathrm{inst}}(t)$ 的大涨落并不意味着积分器不稳定；对于小的 $f$，这种涨落是预期的。结论：错误。\n\nC. 消除质心（COM）运动会消除整体平移，但不会抑制导致 $T_{\\mathrm{inst}}(t)$ 涨落的 $K(t)$ 和 $U(t)$ 之间的内部交换。此外，提及恒温器是无关紧要的，因为根据构造，NVE系综没有恒温器；没有恒温器的温度涨落是预期的。结论：错误。\n\nD. 该选项颠倒了物理情况。与热浴耦合（恒定粒子数、体积、温度，即NVT系综）会约束平均温度但仍允许涨落；NVE系综中的隔离并不会迫使动能温度保持恒定。相对于一个微小的孤立系统，隐藏的恒温调节会倾向于减少而不是增加涨落。结论：错误。\n\n因此，所观察到的行为——在一个小的孤立系统中，总能量完全守恒而瞬时温度剧烈波动——在物理上和统计上都是正确的，正如选项A所表述的那样。", "answer": "$$\\boxed{A}$$", "id": "2453071"}, {"introduction": "理论上，NVE系综下的模拟应该完美地保持能量守恒。然而在实践中，数值误差可能导致非物理性的能量漂移。本问题呈现了一个涉及截断势函数的常见场景，并要求你诊断能量不守恒的根本原因。解决这个问题将加深你对力场数学属性（如其连续性）如何直接影响模拟动力学稳定性和准确性的理解 [@problem_id:2453046]。", "problem": "一个包含 $N$ 个相同粒子的系统，在微正则（NVE）系综中，使用速度-Verlet积分器和固定的时间步长 $\\Delta t$ 进行经典分子动力学（MD）模拟。相互作用是成对的，由一个截断并势移的Lennard-Jones势给出。具体来说，基本势是\n$$\nV_{\\mathrm{LJ}}(r) = 4\\varepsilon\\left[\\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^6\\right],\n$$\n且所实现的相互作用是\n$$\nV_{\\mathrm{ps}}(r) =\n\\begin{cases}\nV_{\\mathrm{LJ}}(r) - V_{\\mathrm{LJ}}(r_c),  r \\le r_c \\\\\n0,  r > r_c\n\\end{cases}\n$$\n其力在截断半径内计算为 $-\\mathrm{d}V_{\\mathrm{ps}}/\\mathrm{d}r$，在截断半径外设为 $0$。该模拟使用周期性边界条件，并且不使用恒温器。尽管选择的 $\\Delta t$ 足够小以解析最快的振动，但总能量 $E(t)$ 在长时间内表现出系统性漂移，而不是在有界涨落范围内保持恒定。\n\n从所实现的势 $V(r)$ 的角度来看，以下哪种诊断最能解释观测到的能量漂移的最可能原因？\n\nA. 截断在 $r=r_c$ 处导致力 $-\\mathrm{d}V/\\mathrm{d}r$ 出现跳跃不连续性，因此穿越 $r_c$ 的粒子对会因未解析的力跳跃而产生积分误差，这些误差累积起来形成漂移。\n\nB. 势函数没有进行移动以满足 $V(r_c) = 0$，因此 $V(r)$ 在 $r=r_c$ 处有一个有限的跳跃，并且当粒子对穿越 $r_c$ 时能量会不连续地改变。\n\nC. $V_{\\mathrm{LJ}}(r)$ 的短程排斥壁太硬，即使有平滑的截断，任何辛Verlet型积分器对硬势都会在 $E(t)$ 中产生长期漂移。\n\nD. 在微正则模拟中，忽略对 $r > r_c$ 的能量进行解析长程尾部校正，会导致 $E(t)$ 随时间产生系统性漂移。", "solution": "必须首先验证问题陈述的科学合理性和一致性。\n\n步骤1：提取已知条件\n- 系统：一个包含 $N$ 个相同粒子的系统。\n- 模拟方法：在微正则（$NVE$）系综中进行经典分子动力学（MD）模拟。\n- 积分器：使用固定时间步长 $\\Delta t$ 的速度-Verlet积分器。\n- 时间步长条件：$\\Delta t$ 足够小以解析最快的振动。\n- 基本势：$V_{\\mathrm{LJ}}(r) = 4\\varepsilon\\left[\\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^6\\right]$。\n- 实现的势：$V_{\\mathrm{ps}}(r) = \\begin{cases} V_{\\mathrm{LJ}}(r) - V_{\\mathrm{LJ}}(r_c),  r \\le r_c \\\\ 0,  r > r_c \\end{cases}$。\n- 力的计算：当 $r \\le r_c$ 时，力计算为 $-\\mathrm{d}V_{\\mathrm{ps}}/\\mathrm{d}r$；当 $r > r_c$ 时，力设为 $0$。\n- 边界条件：使用周期性边界条件。\n- 恒温器：不使用恒温器。\n- 观察现象：总能量 $E(t)$ 在长时间内表现出系统性漂移。\n- 问题：与势 $V(r)$ 相关的、观测到的能量漂移的最可能原因是什么？\n\n步骤2：验证\n该问题描述了分子模拟中的一个标准场景。微正则系综、速度-Verlet积分器、Lennard-Jones势以及势截断方案等，都是计算物理和计算化学中的基本概念。在特定条件下，能量漂移的观察是一种众所周知的数值假象。该问题具有科学依据，提法明确且客观。它包含了足够的信息来从给定选项中确定最可能的原因。没有违反任何科学原理，设置是现实的，问题陈述是精确的。\n\n步骤3：结论\n问题陈述是有效的。我将继续推导解答。\n\n正确答案的推导\n在$NVE$系综中的经典MD模拟中，系统的总能量 $E(t) = K(t) + U(t)$（动能和势能之和）必须是一个守恒量。诸如速度-Verlet算法之类的数值积分方案是对真实动力学的近似。对于像速度-Verlet这样的时间可逆和辛积分器，当应用于一个具有时间无关、保守且足够平滑的哈密顿量的系统时，总能量不应表现出系统性漂移。相反，它应该在一个恒定的平均值周围表现出有界涨落。观测到的 $E(t)$ 的系统性漂移表明其中一个条件被违反了。\n\n问题的根源必须追溯到所实现的势 $V_{\\mathrm{ps}}(r)$ 及其对应的力 $F(r) = -\\mathrm{d}V_{\\mathrm{ps}}(r)/\\mathrm{d}r$ 的性质。\n\n让我们分析在截断半径 $r_c$ 处的势和力。\n\n1.  **势 $V_{\\mathrm{ps}}(r)$ 的连续性**：\n    对于 $r \\le r_c$，势定义为 $V_{\\mathrm{ps}}(r) = V_{\\mathrm{LJ}}(r) - V_{\\mathrm{LJ}}(r_c)$。在截断处，即 $r=r_c$ 时，此表达式得出 $V_{\\mathrm{ps}}(r_c) = V_{\\mathrm{LJ}}(r_c) - V_{\\mathrm{LJ}}(r_c) = 0$。\n    对于 $r > r_c$，势定义为 $V_{\\mathrm{ps}}(r) = 0$。\n    由于势的值从 $r_c$ 的两侧都趋近于 $0$，所以势函数 $V_{\\mathrm{ps}}(r)$ 处处连续。这就是“势移”项 $-V_{\\mathrm{LJ}}(r_c)$ 的目的。\n\n2.  **力 $F(r)$ 的连续性**：\n    力是势的负梯度。\n    对于 $r \\le r_c$，力为 $F(r) = -\\frac{\\mathrm{d}}{\\mathrm{d}r} \\left( V_{\\mathrm{LJ}}(r) - V_{\\mathrm{LJ}}(r_c) \\right) = -\\frac{\\mathrm{d}V_{\\mathrm{LJ}}(r)}{\\mathrm{d}r}$，因为 $V_{\\mathrm{LJ}}(r_c)$ 是一个常数。\n    Lennard-Jones势的导数是：\n    $$ \\frac{\\mathrm{d}V_{\\mathrm{LJ}}(r)}{\\mathrm{d}r} = 4\\varepsilon \\left( -12 \\frac{\\sigma^{12}}{r^{13}} + 6 \\frac{\\sigma^6}{r^7} \\right) = \\frac{24\\varepsilon}{r} \\left( -\\frac{2\\sigma^{12}}{r^{12}} + \\frac{\\sigma^6}{r^6} \\right) $$\n    对于 $r > r_c$，力被明确设置为 $F(r) = 0$。\n\n    让我们在边界 $r=r_c$ 处计算力的大小。\n    当 $r$ 从下方趋近于 $r_c$ 时，力的极限是：\n    $$ F(r \\to r_c^-) = -\\frac{\\mathrm{d}V_{\\mathrm{LJ}}(r)}{\\mathrm{d}r}\\bigg|_{r=r_c} = -\\frac{24\\varepsilon}{r_c} \\left( -\\frac{2\\sigma^{12}}{r_c^{12}} + \\frac{\\sigma^6}{r_c^6} \\right) $$\n    当 $r$ 从上方趋近于 $r_c$ 时，力的极限是：\n    $$ F(r \\to r_c^+) = 0 $$\n    一般来说，$\\frac{\\mathrm{d}V_{\\mathrm{LJ}}}{\\mathrm{d}r}$ 在 $r=r_c$ 处不为零。它仅在势能最小值处 $r_m = 2^{1/6}\\sigma$ 为零，而这不是一个合理的截断半径选择。因此，$F(r \\to r_c^-) \\neq F(r \\to r_c^+)$。力场在 $r=r_c$ 处存在跳跃不连续性。\n\n速度-Verlet算法的推导及其辛性的证明，都依赖于势函数是平滑的（至少二阶可微，因此力是连续可微的）这一假设。力 $F(r)$ 的不连续性违反了这一条件。当一对粒子穿越截断距离 $r_c$ 时，积分器必须处理一个瞬时的力变化，但它并非为此设计的。这会导致在该步的运动方程积分中产生一个吣误差。由于在模拟中粒子对会系统地穿越截断边界，这些微小的、有方向性的误差会随时间累积，导致总能量出现系统性漂移，而非有界振荡。\n\n选项评估\nA. 截断在 $r=r_c$ 处导致力 $-\\mathrm{d}V/\\mathrm{d}r$ 出现跳跃不连续性，因此穿越 $r_c$ 的粒子对会因未解析的力跳跃而产生积分误差，这些误差累积起来形成漂移。\n这个陈述与我们的推导完全一致。所实现的势本身是连续的，但在截断处产生了不连续的力。这种不连续性破坏了Verlet积分方案的辛性，导致误差累积，表现为系统性的能量漂移。这是对于使用简单截断势时能量漂移的典型解释。\n**结论：正确。**\n\nB. 势函数没有进行移动以满足 $V(r_c) = 0$，因此 $V(r)$ 在 $r=r_c$ 处有一个有限的跳跃，并且当粒子对穿越 $r_c$ 时能量会不连续地改变。\n这个陈述在事实上是错误的。问题明确描述了一个势移形式：$V_{\\mathrm{ps}}(r) = V_{\\mathrm{LJ}}(r) - V_{\\mathrm{LJ}}(r_c)$ for $r \\le r_c$。如上所述，这种特定构造确保了势 $V_{\\mathrm{ps}}(r)$ 在 $r = r_c$ 处是连续的，且 $V_{\\mathrm{ps}}(r_c) = 0$。一个不连续的势会导致无穷大的力和灾难性的能量不守恒，这比单纯的漂移是更严重的问题。\n**结论：错误。**\n\nC. $V_{\\mathrm{LJ}}(r)$ 的短程排斥壁太硬，即使有平滑的截断，任何辛Verlet型积分器对硬势都会在 $E(t)$ 中产生长期漂移。\n这个陈述具有误导性。虽然硬势（即具有大二阶导数的势）需要非常小的时间步长 $\\Delta t$ 才能进行稳定和准确的积分，但问题陈述中提到 $\\Delta t$ 的选择是合适的（“足够小以解析最快的振动”）。对于任何平滑的势，无论其是否为硬势，一个具有足够小时间步长的辛积分器都将在有界涨落内保持能量守恒，而不会出现长期（系统性）的漂移。刚度会影响这些涨落的幅度，但不会引起漂移。漂移的原因是辛性的丧失，而这里辛性的丧失是由于势的不平滑（不连续的力），而不是其刚度。\n**结论：错误。**\n\nD. 在微正则模拟中，忽略对 $r > r_c$ 的能量进行解析长程尾部校正，会导致 $E(t)$ 随时间产生系统性漂移。\n长程尾部校正是对能量和压力等可观测量进行的常数调整，用以解释截断半径以外的相互作用。对能量而言，此校正是一个常数值，通常假设 $r > r_c$ 时径向分布函数是均匀的来计算。这个校正影响所报告的总能量的绝对值，但它不影响模拟的动力学过程，因为力是从截断势 $V_{\\mathrm{ps}}(r)$ 推导出来的。积分器应该守恒的量是模拟系统的哈密顿量，$E(t) = K(t) + U_{\\mathrm{ps}}(t)$。添加一个常数不会改变其时间导数；因此，忽略一个常数校正不会引入随时间的漂移。\n**结论：错误。**", "answer": "$$\\boxed{A}$$", "id": "2453046"}, {"introduction": "一个模拟系统可能根据快速弛豫的指标（如温度）看似已“平衡”，而缓慢的构象自由度却仍未得到充分采样。本练习通过在正则（NVT）系综中考察一个被困在亚稳态的系统，探讨了遍历性这一关键概念。理解这一情景将教会你为何简单的诊断指标可能具有误导性，并强调了动能平衡与构象平衡之间的本质区别，这是高级模拟分析的基石 [@problem_id:2453013]。", "problem": "一个包含 $N=50$ 个粒子的团簇的经典分子动力学（MD）模拟，在设定目标温度为 $T=300\\,\\mathrm{K}$ 的恒温器下运行。哈密顿量可分离为动能项和势能项，即 $H(\\mathbf{p},\\mathbf{q})=K(\\mathbf{p})+U(\\mathbf{q})$，并且运动方程的积分时间步长足够小，以确保数值稳定性。在一段长度为 $10\\,\\mathrm{ns}$ 的轨迹上，系统始终被局限在单个亚稳态盆地中，该盆地与其他盆地被巨大的自由能垒隔开。通过瞬时动能和活性自由度数定义的动能温度可观测量，其运行时均值与目标温度 $T$ 的偏差在 $1\\%$ 以内。\n\n从正则系综的第一性原理、遍历性（在长时间极限下时间平均等于系综平均）的定义以及经典力学中动能和势能的可分离性出发，论证即使当模拟是非遍历的（即陷入一个盆地时），时间平均动能温度如何能够与目标温度匹配，以及为什么动能温度与 $T$ 的一致性是对正确采样的一种误导性诊断。\n\n哪些陈述正确地解释了这如何成为可能，以及为什么仅依赖动能温度会误判采样质量？选择所有适用的选项。\n\nA. 在具有可分离哈密顿量 $H(\\mathbf{p},\\mathbf{q})=K(\\mathbf{p})+U(\\mathbf{q})$ 的正则系综中，联合分布可因子分解，因此恒温器可以强制实现正确的 Maxwell–Boltzmann 动量边缘分布，从而使 $\\langle K\\rangle$ 与 $T$ 一致，即使坐标分布被限制在一个盆地内；因此，在构型采样有偏的同时，时间平均动能温度可以与 $T$ 匹配。\n\nB. 匹配目标温度保证了所有系综平均都是正确的，因为无论是否具有遍历性，时间平均都等于系综平均。\n\nC. 动能温度主要取决于快速的速度涨落，并且对慢集体坐标中的罕见越垒事件基本不敏感；因此，当慢模式未被采样时，它仍可能看起来是正确的，这使其成为构型采样的一个不可靠的指标。\n\nD. 非遍历性必然导致动能温度在长时间内偏离设定点，因此观察到时间平均动能温度与 $T$ 匹配意味着系统是遍历的。\n\nE. 考虑约束条件会减少自由度数，一旦这个计数正确，温度将总是与 $T$ 匹配，这也意味着坐标分布是正确的。", "solution": "首先将验证问题陈述的科学合理性和完整性。\n\n### 步骤 1：提取已知条件\n\n-   模拟类型：经典分子动力学（MD）\n-   粒子数：$N=50$\n-   恒温器目标温度：$T=300\\,\\mathrm{K}$\n-   哈密顿量：可分离，$H(\\mathbf{p},\\mathbf{q})=K(\\mathbf{p})+U(\\mathbf{q})$\n-   积分时间步长：足够小以确保数值稳定性。\n-   轨迹长度：$10\\,\\mathrm{ns}$\n-   系统动力学：系统被局限在单个亚稳态盆地中，该盆地与其他盆地被巨大的自由能垒隔开。\n-   观察结果：动能温度可观测量的运行时均值与目标温度 $T$ 的偏差在 $1\\%$ 以内。\n-   动能温度的定义：由瞬时动能和活性自由度数导出。\n-   任务：解释尽管模拟是非遍历的，时间平均动能温度如何能与目标温度 $T$ 匹配，以及为什么这种一致性是对正确采样的一种误导性诊断。\n\n### 步骤 2：使用提取的已知条件进行验证\n\n-   **科学基础**：该问题描述了计算统计力学中的一个典型场景。可分离的哈密顿量是经典力学中的标准形式。系统被困在亚稳态盆地的概念是 MD 中的一个核心挑战，被称为采样问题。恒温器、正则系综以及动能采样和构型采样之间的区别都是基本且公认的原理。该问题在科学上是合理的。\n-   **适定性**：问题是明确的。它要求对 MD 模拟中的一个常见观察现象给出机理上的解释，并需要根据这一解释评估所提供的陈述。整个设置是自洽的，并允许基于统计力学原理得出明确的答案。\n-   **客观性**：问题以精确、客观和技术性的语言陈述。没有主观或基于观点的内容。\n\n### 步骤 3：结论与行动\n\n问题陈述是有效的。它具有科学基础，是适定的和客观的。可以从第一性原理推导出严谨的解。\n\n### 从第一性原理推导\n\n在正则（NVT）系综中，相空间 $(\\mathbf{q}, \\mathbf{p})$ 中状态的平衡概率分布由玻尔兹曼分布给出：\n$$\n\\rho(\\mathbf{q}, \\mathbf{p}) = \\frac{1}{Z} e^{-\\beta H(\\mathbf{q}, \\mathbf{p})}\n$$\n其中 $\\beta = (k_B T)^{-1}$，$k_B$ 是玻尔兹曼常数，$T$ 是热力学温度，$Z$ 是正则配分函数。\n\n问题陈述哈密顿量是可分离的：$H(\\mathbf{p},\\mathbf{q}) = K(\\mathbf{p}) + U(\\mathbf{q})$。这会带来一个深刻的后果。概率分布可以因子分解为动量 $\\mathbf{p}$ 和坐标 $\\mathbf{q}$ 的独立分布：\n$$\n\\rho(\\mathbf{q}, \\mathbf{p}) = \\frac{1}{Z_p Z_q} e^{-\\beta K(\\mathbf{p})} e^{-\\beta U(\\mathbf{q})} = \\rho_p(\\mathbf{p}) \\rho_q(\\mathbf{q})\n$$\n其中 $\\rho_p(\\mathbf{p}) = Z_p^{-1} \\exp(-\\beta K(\\mathbf{p}))$ 是动量的边缘概率分布，而 $\\rho_q(\\mathbf{q}) = Z_q^{-1} \\exp(-\\beta U(\\mathbf{q}))$ 是坐标的边缘概率分布。关键的洞见是，对于可分离的哈密顿量，在正则系综中动量和坐标是统计独立的。\n\n与 MD 模拟耦合的恒温器主要通过修改动量 $\\mathbf{p}$ 的运动方程来确保其分布能正确地对 $\\rho_p(\\mathbf{p})$进行采样。这就是 Maxwell-Boltzmann 分布。动能 $K(\\mathbf{p})$ 的系综平均值则完全由该动量分布确定：\n$$\n\\langle K \\rangle_{ens} = \\int K(\\mathbf{p}) \\rho_p(\\mathbf{p}) d\\mathbf{p}\n$$\n根据在此适用的能量均分定理，动能中的每个二次项对该平均值贡献 $\\frac{1}{2} k_B T$。如果存在 $N_{dof}$ 个动能自由度，则：\n$$\n\\langle K \\rangle_{ens} = \\frac{N_{dof}}{2} k_B T\n$$\n瞬时动能温度定义为 $T_{kin}(t) = \\frac{2 K(\\mathbf{p}(t))}{N_{dof} k_B}$。一个正常工作的恒温器确保这个量的时间平均值 $\\langle T_{kin} \\rangle_{time}$ 收敛到目标温度 $T$。这种平衡发生在非常快的时间尺度上，这是分子振动和碰撞的特征（飞秒到皮秒）。\n\n现在考虑构型部分。遍历性假设指出，对于足够长的轨迹，一个可观测量的时均值等于其系综平均值。在这个问题中，明确指出模拟在 $10\\,\\mathrm{ns}$ 的时间尺度上是非遍历的，因为它被困在单个亚稳态盆地中。这意味着轨迹只探索了构型空间 $\\mathbf{q}$ 的一个子集。因此，任何构型可观测量 $A(\\mathbf{q})$ 的时均值将只反映在该单个盆地上的平均，而不是在所有可及构型上的完整玻尔兹曼加权平均。\n$$\n\\langle A(\\mathbf{q}) \\rangle_{time} \\approx \\langle A(\\mathbf{q}) \\rangle_{basin} \\neq \\langle A(\\mathbf{q}) \\rangle_{ens}\n$$\n因为在系综中 $\\mathbf{p}$ 和 $\\mathbf{q}$ 的动力学是统计上解耦的，并且因为恒温器能高效地作用于快速的动量自由度，所以完全可能出现 $\\langle K \\rangle_{time} \\approx \\langle K \\rangle_{ens}$（因此 $\\langle T_{kin} \\rangle_{time} \\approx T$），而同时 $\\langle U \\rangle_{time} \\neq \\langle U \\rangle_{ens}$ 并且构型空间的采样是严重有偏的。\n\n因此，动能温度与目标值 $T$ 的一致性是对恒温器性能和动能自由度平衡情况的检验，但它不提供关于构型势能面采样的任何信息。将其作为整体模拟质量或“平衡”的唯一指标是一个常见但严重的错误，因为负责构象变化和化学过程的慢自由度可能完全未被采样。\n\n### 逐项分析\n\n**A. 在具有可分离哈密顿量 $H(\\mathbf{p},\\mathbf{q})=K(\\mathbf{p})+U(\\mathbf{q})$ 的正则系综中，联合分布可因子分解，因此恒温器可以强制实现正确的 Maxwell–Boltzmann 动量边缘分布，从而使 $\\langle K\\rangle$ 与 $T$ 一致，即使坐标分布被限制在一个盆地内；因此，在构型采样有偏的同时，时间平均动能温度可以与 $T$ 匹配。**\n该陈述是对上述统计力学原理的精确总结。它正确地指出了哈密顿量的可分离性以及由此导致的概率分布因子分解是其根本原因。它正确解释了恒温器作用于动量分布，而这独立于（可能很差的）构型采样。这解释了该现象*如何*可能发生，以及*为什么*动能温度是一种误导性诊断。\n**结论：正确**\n\n**B. 匹配目标温度保证了所有系综平均都是正确的，因为无论是否具有遍历性，时间平均都等于系综平均。**\n该陈述根本上是错误的。时间平均和系综平均的等价性是遍历性的定义。对于一个非遍历系统，这种等价性不成立。问题明确描述了一个非遍历的采样情况。因此，该陈述与统计力学的原理直接矛盾。\n**结论：不正确**\n\n**C. 动能温度主要取决于快速的速度涨落，并且对慢集体坐标中的罕见越垒事件基本不敏感；因此，当慢模式未被采样时，它仍可能看起来是正确的，这使其成为构型采样的一个不可靠的指标。**\n该陈述提供了一个基于动力学和时间尺度的解释，它与 A 中的统计力学论证是互补的。动量 $\\mathbf{p}$（以及速度）在非常快的时间尺度上（$\\sim 10^{-15} - 10^{-12}\\,\\mathrm{s}$）涨落。恒温器可以快速平衡这些涨落。越垒事件涉及坐标 $\\mathbf{q}$ 的慢速集体运动，这些运动发生在长得多的时间尺度上（$\\sim 10^{-9}\\,\\mathrm{s}$ 或更长）。一个 $10\\,\\mathrm{ns}$ 的模拟足以对快速的动能涨落进行平均，从而得到一个正确的 $\\langle T_{kin} \\rangle_{time}$，但可能远远不足以观察到罕见的构型事件。这正确地指出了时间尺度分离是造成误导性诊断的原因。\n**结论：正确**\n\n**D. 非遍历性必然导致动能温度在长时间内偏离设定点，因此观察到时间平均动能温度与 $T$ 匹配意味着系统是遍历的。**\n该陈述是不正确的。如上所述，构型空间中的非遍历性不会阻止恒温器将动能温度维持在目标值。恒温器的正常功能正是为了防止这种漂移。因此，观察到动能温度与目标 $T$ 匹配绝对不意味着在完整相空间中具有遍历性。该陈述提出了与正确物理图像完全相反的观点。\n**结论：不正确**\n\n**E. 考虑约束条件会减少自由度数，一旦这个计数正确，温度将总是与 $T$ 匹配，这也意味着坐标分布是正确的。**\n该陈述是有缺陷的。虽然从 $K$ 计算 $T_{kin}$ 时必须使用正确的自由度数 $N_{dof}$ 是事实，但这仅仅是一个正确计算的问题。它并不能保证温度会与 $T$ 匹配；那是恒温器的作用。其最终结论，即这意味着坐标分布是正确的，是一个不合逻辑的推论，并且基于对选项 A 和 C 的分析，它根本上是错误的。\n**结论：不正确**", "answer": "$$\\boxed{AC}$$", "id": "2453013"}]}