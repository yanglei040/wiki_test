{"hands_on_practices": [{"introduction": "力场中的参数并非随意设定的数值，而是经过精心优化以匹配真实的物理性质。本练习将展示参数化过程中的一个基本方面：如何通过拟合原子局部电荷来重现实验测得的分子多极矩，在此特指二氧化碳（$CO_2$）的四极矩。通过这个练习，你将把抽象的理论与具体、可用的模型联系起来。[@problem_id:2452401]", "problem": "在固定电荷力场中，例如 Assisted Model Building with Energy Refinement (AMBER)、Chemistry at Harvard Macromolecular Mechanics (CHARMM)、Optimized Potentials for Liquid Simulations (OPLS) 和 Groningen Molecular Simulation (GROMOS)，通常选择原子部分电荷来重现低阶分子多极矩。考虑一个沿 $z$ 轴排列的线性二氧化碳分子，其碳原子位于原点，两个氧原子位于 $z=\\pm \\ell$ 的位置，其中 $\\ell = 1.160\\,\\text{\\AA}$。使用三个点电荷对该分子进行建模：一个位于 $z=0$ 的碳电荷 $q_{C}$ 和两个位于 $z=\\pm \\ell$ 的相同氧电荷 $q_{O}$。施加整体电中性约束。\n\n使用点电荷的无迹电四极矩张量定义，\n$$Q_{\\alpha\\beta}=\\sum_{i} q_{i}\\left(3 r_{i,\\alpha} r_{i,\\beta} - r_{i}^{2}\\delta_{\\alpha\\beta}\\right),$$\n以及二氧化碳的实验轴向分量，\n$$Q_{zz} = -4.30\\,\\text{D}\\cdot\\text{\\AA},$$\n来确定能重现此构型下 $Q_{zz}$ 值的氧和碳的部分电荷 $q_{O}$ 和 $q_{C}$。\n\n以基本电荷 $e$ 为单位表示 $q_{O}$ 和 $q_{C}$。使用以下常数：\n- $1\\,\\text{Debye} = 3.33564\\times 10^{-30}\\,\\text{C}\\cdot\\text{m}$，\n- $1\\,\\text{\\AA} = 1.0\\times 10^{-10}\\,\\text{m}$，\n- $e = 1.602176634\\times 10^{-19}\\,\\text{C}$。\n\n将每个部分电荷四舍五入到四位有效数字。以 $e$ 为单位，将最终答案表示为行矩阵 $\\big(q_{O}\\ \\ q_{C}\\big)$。", "solution": "该问题陈述被评估为具有科学依据、问题明确、客观且自洽。它提出了一个计算化学中的标准问题：参数化原子部分电荷以重现实验已知的静电性质。所有需要的数据和定义都已提供，并且没有发现矛盾或歧义。因此，该问题是有效的，并将提供解答。\n\n目标是确定二氧化碳线性模型的原子部分电荷 $q_C$ 和 $q_O$。碳原子位于原点 ($z=0$)，两个氧原子位于 $z=+\\ell$ 和 $z=-\\ell$，其中 $\\ell = 1.160\\,\\text{\\AA}$。\n\n第一个约束条件是分子必须不带净电荷（整体电中性）。电荷总和必须为零：\n$$q_C + q_O + q_O = 0$$\n可简化为：\n$$q_C + 2q_O = 0 \\quad \\implies \\quad q_C = -2q_O$$\n\n第二个约束条件是模型必须重现无迹电四极矩张量的实验轴向分量，$Q_{zz} = -4.30\\,\\text{D}\\cdot\\text{\\AA}$。问题中给出了该张量的定义：\n$$Q_{\\alpha\\beta}=\\sum_{i} q_{i}\\left(3 r_{i,\\alpha} r_{i,\\beta} - r_{i}^{2}\\delta_{\\alpha\\beta}\\right)$$\n对于 $zz$ 分量，$\\alpha=z$ 且 $\\beta=z$，因此 $\\delta_{\\alpha\\beta} = \\delta_{zz} = 1$。表达式变为：\n$$Q_{zz} = \\sum_{i} q_{i}\\left(3 z_i^2 - r_i^2\\right)$$\n其中 $z_i$ 是电荷 $q_i$ 的 $z$ 坐标，$r_i$ 是其到原点的距离。\n\n我们现在对模型中三个点电荷的贡献求和：\n1. 碳原子 (C)：位于原点，其位置矢量为 $\\vec{r}_C = (0, 0, 0)$。因此，$z_C=0$ 且 $r_C^2 = 0$。它对 $Q_{zz}$ 的贡献是 $q_C(3 \\cdot 0^2 - 0^2) = 0$。\n2. 第一个氧原子 ($O_1$)：位于 $z=+\\ell$，其位置矢量为 $\\vec{r}_{O1} = (0, 0, \\ell)$。因此，$z_{O1}=\\ell$ 且 $r_{O1}^2 = \\ell^2$。其贡献为 $q_O(3\\ell^2 - \\ell^2) = 2q_O\\ell^2$。\n3. 第二个氧原子 ($O_2$)：位于 $z=-\\ell$，其位置矢量为 $\\vec{r}_{O2} = (0, 0, -\\ell)$。因此，$z_{O2}=-\\ell$ 且 $r_{O2}^2 = \\ell^2$。其贡献为 $q_O(3(-\\ell)^2 - \\ell^2) = q_O(3\\ell^2 - \\ell^2) = 2q_O\\ell^2$。\n\n总的 $Q_{zz}$ 是这些贡献的总和：\n$$Q_{zz} = 0 + 2q_O\\ell^2 + 2q_O\\ell^2 = 4q_O\\ell^2$$\n从这个表达式中，我们可以解出氧电荷 $q_O$：\n$$q_O = \\frac{Q_{zz}}{4\\ell^2}$$\n\n现在，我们进行数值计算。给定值为 $Q_{zz} = -4.30\\,\\text{D}\\cdot\\text{\\AA}$ 和 $\\ell = 1.160\\,\\text{\\AA}$。为确保量纲一致性，我们将所有量转换为国际单位制（SI）单位。\n常数如下：\n$1\\,\\text{D} = 3.33564 \\times 10^{-30}\\,\\text{C}\\cdot\\text{m}$\n$1\\,\\text{\\AA} = 1.0 \\times 10^{-10}\\,\\text{m}$\n$e = 1.602176634 \\times 10^{-19}\\,\\text{C}$\n\n首先，将 $Q_{zz}$ 转换为 $\\text{C}\\cdot\\text{m}^2$：\n$$Q_{zz} = -4.30 \\, (\\text{D}\\cdot\\text{\\AA}) = -4.30 \\times (3.33564 \\times 10^{-30}\\,\\text{C}\\cdot\\text{m}) \\times (1.0 \\times 10^{-10}\\,\\text{m})$$\n$$Q_{zz} = -1.4343252 \\times 10^{-39}\\,\\text{C}\\cdot\\text{m}^2$$\n接着，将 $\\ell$ 转换为米：\n$$\\ell = 1.160\\,\\text{\\AA} = 1.160 \\times 10^{-10}\\,\\text{m}$$\n现在，我们可以计算以库仑为单位的 $q_O$：\n$$q_O = \\frac{-1.4343252 \\times 10^{-39}\\,\\text{C}\\cdot\\text{m}^2}{4 \\times (1.160 \\times 10^{-10}\\,\\text{m})^2} = \\frac{-1.4343252 \\times 10^{-39}}{4 \\times 1.3456 \\times 10^{-20}}\\,\\text{C}$$\n$$q_O = \\frac{-1.4343252 \\times 10^{-39}}{5.3824 \\times 10^{-20}}\\,\\text{C} \\approx -2.66490 \\times 10^{-20}\\,\\text{C}$$\n问题要求以基本电荷 $e$ 为单位表示电荷。我们将 $q_O$ 除以 $e$：\n$$\\frac{q_O}{e} = \\frac{-2.66490 \\times 10^{-20}\\,\\text{C}}{1.602176634 \\times 10^{-19}\\,\\text{C}/e} = -0.166331\\dots$$\n四舍五入到四位有效数字，得到：\n$$q_O \\approx -0.1663\\,e$$\n使用电中性条件，我们求出碳原子上的电荷 $q_C$：\n$$q_C = -2q_O$$\n以 $e$ 为单位：\n$$\\frac{q_C}{e} = -2\\left(\\frac{q_O}{e}\\right) = -2 \\times (-0.166331\\dots) = 0.332662\\dots$$\n四舍五入到四位有效数字，得到：\n$$q_C \\approx 0.3327\\,e$$\n在指定模型下，重现给定四极矩的部分电荷为 $q_O = -0.1663\\,e$ 和 $q_C = 0.3327\\,e$。", "answer": "$$\\boxed{\\begin{pmatrix} -0.1663 & 0.3327 \\end{pmatrix}}$$", "id": "2452401"}, {"introduction": "参数确定后，下一步就是运用完整的势能函数来研究化学问题。本练习要求你应用几种主流力场（AMBER、CHARMM、GROMOS）的简化模型，来分析立体化学中的一个经典问题——异头效应。通过计算不同构象间的能量差，你将亲身体会到不同参数集如何得出不同的物理预测，并练习组合运用各项能量。[@problem_id:2452387]", "problem": "你需要构建并评估一个最小的、经典分子力学模型，用于研究吡喃葡萄糖环异头碳中心的异头碳偏好。目标是比较模拟 Assisted Model Building with Energy Refinement (AMBER)、Chemistry at Harvard Macromolecular Mechanics (CHARMM) 和 Groningen Molecular Simulation (GROMOS) 的三种参数化方案，并计算赤道式和轴向式异头物构象之间的能量差，以评估哪种参数化方案预测赤道式或轴向式构型具有更低的能量。整个工作应在一个简化的、对相加势的框架内进行，该势仅包含一个关于异头键的二面角扭转项和三对非键合对，这三对非键合对代表了环外取代基与环环境之间的主要局部接触。\n\n仅使用以下基本依据和假设：\n\n- 经典力学和势能描述：对于一个固定的几何构型，两种构象的相对稳定性由它们的势能决定。将轴向和赤道二面角构象分别表示为 $\\phi_{\\mathrm{ax}}$ 和 $\\phi_{\\mathrm{eq}}$。\n- 总势能是单个二面角扭转项与取代基位点 $X$ 和三个环位点 $R_1$、$R_2$ 和 $R_3$ 之间的对非键合项之和。二面角扭转由一个周期性为 $n$、相位为 $\\delta$ 的单余弦傅里叶项表示。每对的非键合相互作用是 Lennard–Jones $12$–$6$ 项和库仑项之和。\n- 对于给定的一对，其参数为 $(\\varepsilon_{ij},\\sigma_{ij})$，在间距 $r$ 处的 Lennard–Jones 对相互作用使用标准的 $12$–$6$ 形式。在间距 $r$ 处，部分电荷 $q_i$ 和 $q_j$ 之间的库仑相互作用使用适合于能量单位为千焦耳每摩尔、距离单位为纳米的库仑常数 $k_c$。\n\n你必须计算能量差\n$$\n\\Delta E \\equiv E_{\\mathrm{eq}} - E_{\\mathrm{ax}}\n$$\n单位为千焦耳每摩尔，适用于以下每种参数化方案，使用以下固定的几何构型和常数：\n\n- 库仑常数：$k_c = 138.935458$ $\\mathrm{kJ\\ mol^{-1}\\ nm\\ e^{-2}}$。\n- 二面角（所有角度均以度表示；在计算三角函数时，将度转换为弧度）：$\\phi_{\\mathrm{ax}} = 60^\\circ$，$\\phi_{\\mathrm{eq}} = 180^\\circ$。\n- 对于每个非键合对 $(X,R_k)$，分别使用对应于轴向和赤道构象的两个固定中心间距离。距离单位为纳米。这三对及其距离是：\n    - 对 $1$ $(X,R_1)$：$r_{\\mathrm{ax}} = 0.33$ $\\mathrm{nm}$，$r_{\\mathrm{eq}} = 0.38$ $\\mathrm{nm}$。\n    - 对 $2$ $(X,R_2)$：$r_{\\mathrm{ax}} = 0.40$ $\\mathrm{nm}$，$r_{\\mathrm{eq}} = 0.35$ $\\mathrm{nm}$。\n    - 对 $3$ $(X,R_3)$：$r_{\\mathrm{ax}} = 0.36$ $\\mathrm{nm}$，$r_{\\mathrm{eq}} = 0.39$ $\\mathrm{nm}$。\n\n所使用的势能分量如下：\n\n- 对于振幅为 $V$、周期性为 $n$、相位为 $\\delta$（以度为单位）和二面角为 $\\phi$（以度为单位）的单个项的二面角扭转：\n  $$\n  U_{\\mathrm{tor}}(\\phi;V,n,\\delta) = \\frac{V}{2}[1 + \\cos(n\\phi - \\delta)].\n  $$\n- 对于参数为 $(\\varepsilon_{ij},\\sigma_{ij})$、距离为 $r$ 的一对 $(i,j)$ 的 Lennard–Jones 相互作用：\n  $$\n  U_{\\mathrm{LJ}}(r;\\varepsilon_{ij},\\sigma_{ij}) = 4\\,\\varepsilon_{ij}\\left[\\left(\\frac{\\sigma_{ij}}{r}\\right)^{12} - \\left(\\frac{\\sigma_{ij}}{r}\\right)^{6}\\right].\n  $$\n- 对于距离为 $r$、电荷为 $(q_i,q_j)$ 的一对 $(i,j)$ 的库仑相互作用：\n  $$\n  U_{\\mathrm{C}}(r;q_i,q_j) = k_c\\frac{q_i q_j}{r}.\n  $$\n\n对于下面每个类似力场的参数化方案，通过将 $\\phi_{\\mathrm{ax}}$ 或 $\\phi_{\\mathrm{eq}}$ 处的扭转项与相应轴向或赤道距离处的三个对非键合项（每个项都是 Lennard–Jones 和库仑项的和）相加，来评估 $E_{\\mathrm{ax}}$ 和 $E_{\\mathrm{eq}}$。然后计算 $\\Delta E$，单位为 $\\mathrm{kJ\\ mol^{-1}}$。\n\n为以下六个测试案例提供结果。在所有案例中，角度以度为单位，距离以纳米为单位，能量以千焦耳每摩尔为单位，电荷以基本电荷单位为单位。当一个值被声明为零时，将其视为精确为零。\n\n- 测试案例 $1$ (AMBER-like: Assisted Model Building with Energy Refinement):\n  - 二面角：$V = 1.2$, $n = 1$, $\\delta = 0^\\circ$。\n  - 电荷：$q_X = -0.18$, $q_{R_1} = +0.06$, $q_{R_2} = -0.10$, $q_{R_3} = +0.05$。\n  - Lennard–Jones 对参数：\n    - 对 $1$：$\\varepsilon_{XR_1} = 0.30$, $\\sigma_{XR_1} = 0.32$。\n    - 对 $2$：$\\varepsilon_{XR_2} = 0.50$, $\\sigma_{XR_2} = 0.30$。\n    - 对 $3$：$\\varepsilon_{XR_3} = 0.20$, $\\sigma_{XR_3} = 0.33$。\n\n- 测试案例 $2$ (CHARMM-like: Chemistry at Harvard Macromolecular Mechanics):\n  - 二面角：$V = 1.5$, $n = 1$, $\\delta = 0^\\circ$。\n  - 电荷：$q_X = -0.20$, $q_{R_1} = +0.07$, $q_{R_2} = -0.12$, $q_{R_3} = +0.06$。\n  - Lennard–Jones 对参数：\n    - 对 $1$：$\\varepsilon_{XR_1} = 0.28$, $\\sigma_{XR_1} = 0.32$。\n    - 对 $2$：$\\varepsilon_{XR_2} = 0.45$, $\\sigma_{XR_2} = 0.29$。\n    - 对 $3$：$\\varepsilon_{XR_3} = 0.22$, $\\sigma_{XR_3} = 0.33$。\n\n- 测试案例 $3$ (GROMOS-like: Groningen Molecular Simulation):\n  - 二面角：$V = 0.9$, $n = 1$, $\\delta = 0^\\circ$。\n  - 电荷：$q_X = -0.16$, $q_{R_1} = +0.05$, $q_{R_2} = -0.09$, $q_{R_3} = +0.04$。\n  - Lennard–Jones 对参数：\n    - 对 $1$：$\\varepsilon_{XR_1} = 0.25$, $\\sigma_{XR_1} = 0.32$。\n    - 对 $2$：$\\varepsilon_{XR_2} = 0.55$, $\\sigma_{XR_2} = 0.31$。\n    - 对 $3$：$\\varepsilon_{XR_3} = 0.18$, $\\sigma_{XR_3} = 0.34$。\n\n- 测试案例 $4$ (AMBER-like，静电作用被抑制):\n  - 与测试案例 $1$ 相同，但将所有电荷设置为 $0.0$。\n\n- 测试案例 $5$ (AMBER-like，范德华力被抑制):\n  - 与测试案例 $1$ 相同，但将所有 $\\varepsilon_{XR_k}$ 设置为 $0.0$。\n\n- 测试案例 $6$ (AMBER-like，扭转作用被抑制):\n  - 与测试案例 $1$ 相同，但将 $V$ 设置为 $0.0$。\n\n您的程序必须为每个测试案例计算 $\\Delta E$，并生成一行输出，其中包含六个结果，形式为一个用方括号括起来的逗号分隔列表。每个数字必须四舍五入到恰好三位小数。例如，输出格式必须类似于\n$[x_1,x_2,x_3,x_4,x_5,x_6]$\n其中每个 $x_i$ 是一个十进制浮点数，单位为 $\\mathrm{kJ\\ mol^{-1}}$，小数点后有三位数字。角度必须按给定的度数处理，并在计算余弦时在内部转换为弧度。距离必须按给定的纳米单位处理。能量必须按要求以千焦耳每摩尔报告。", "solution": "该问题陈述经验证具有科学依据、提法得当、客观且完整。它描述了分子力学原理在一个合法的（尽管是简化的）立体化学问题中的标准应用。不存在矛盾或歧义。直接求解是可能的，并将提供解答。\n\n基本任务是计算一个模型系统中赤道式和轴向式构象异构体之间的势能差 $\\Delta E$。相对稳定性由势能决定，能量越低对应于越稳定的构象。待计算的量是 $\\Delta E \\equiv E_{\\mathrm{eq}} - E_{\\mathrm{ax}}$，其中 $E_{\\mathrm{eq}}$ 和 $E_{\\mathrm{ax}}$ 分别是赤道式和轴向式构象的总势能。负的 $\\Delta E$ 表示赤道式构象更稳定，而正的 $\\Delta E$ 表示轴向式构象更稳定。\n\n给定构象的总势能 $E$ 定义为单个二面角扭转项 $U_{\\mathrm{tor}}$ 和三个非键合相互作用项之和。每个非键合项是 Lennard-Jones 势 $U_{\\mathrm{LJ}}$ 和库仑势 $U_{\\mathrm{C}}$ 之和。因此，一个构象的总能量为：\n$$\nE = U_{\\mathrm{tor}} + \\sum_{k=1}^{3} \\left( U_{\\mathrm{LJ},k} + U_{\\mathrm{C},k} \\right)\n$$\n这些能量分量的具体函数形式已在问题中提供。\n\n二面角扭转能由傅里叶级数的单个项给出：\n$$\nU_{\\mathrm{tor}}(\\phi;V,n,\\delta) = \\frac{V}{2}[1 + \\cos(n\\phi - \\delta)]\n$$\n此处，$V$ 是势垒高度，$n$ 是周期性，$\\phi$ 是二面角，$\\delta$ 是相移。角度 $\\phi$ 和 $\\delta$ 以度为单位提供，在计算余弦函数时必须转换为弧度。\n\n取代基 $X$ 和环位点 $R_k$ 之间距离为 $r$ 的每对 $k$ 的非键合相互作用是 Lennard-Jones 项和库仑项之和：\n$$\nU_{\\mathrm{nonbonded},k}(r) = U_{\\mathrm{LJ}}(r;\\varepsilon_{k},\\sigma_{k}) + U_{\\mathrm{C}}(r;q_X,q_{R_k})\n$$\nLennard-Jones $12$-$6$ 势定义为：\n$$\nU_{\\mathrm{LJ}}(r;\\varepsilon_{ij},\\sigma_{ij}) = 4\\,\\varepsilon_{ij}\\left[\\left(\\frac{\\sigma_{ij}}{r}\\right)^{12} - \\left(\\frac{\\sigma_{ij}}{r}\\right)^{6}\\right]\n$$\n其中 $\\varepsilon_{ij}$ 是势阱深度，$\\sigma_{ij}$ 是粒子间势为零时的有限距离。\n\n库仑势或静电势为：\n$$\nU_{\\mathrm{C}}(r;q_i,q_j) = k_c\\frac{q_i q_j}{r}\n$$\n其中 $q_i$ 和 $q_j$ 是部分电荷，$r$ 是分离距离，$k_c$ 是库仑常数，给定为 $k_c = 138.935458$ $\\mathrm{kJ\\ mol^{-1}\\ nm\\ e^{-2}}$。\n\n为了求能量差 $\\Delta E$，我们使用它们各自的几何参数计算轴向和赤道构象的能量，然后相减。轴向构象的二面角为 $\\phi_{\\mathrm{ax}} = 60^\\circ$，非键合距离为 $r_{k,\\mathrm{ax}}$（对于 $k=1,2,3$）。赤道构象的二面角为 $\\phi_{\\mathrm{eq}} = 180^\\circ$，非键合距离为 $r_{k,\\mathrm{eq}}$。\n\n轴向构象的能量为：\n$$\nE_{\\mathrm{ax}} = U_{\\mathrm{tor}}(\\phi_{\\mathrm{ax}}) + \\sum_{k=1}^{3} \\left( U_{\\mathrm{LJ}}(r_{k,\\mathrm{ax}}) + U_{\\mathrm{C}}(r_{k,\\mathrm{ax}}) \\right)\n$$\n赤道构象的能量为：\n$$\nE_{\\mathrm{eq}} = U_{\\mathrm{tor}}(\\phi_{\\mathrm{eq}}) + \\sum_{k=1}^{3} \\left( U_{\\mathrm{LJ}}(r_{k,\\mathrm{eq}}) + U_{\\mathrm{C}}(r_{k,\\mathrm{eq}}) \\right)\n$$\n因此，所求的能量差为：\n$$\n\\Delta E = E_{\\mathrm{eq}} - E_{\\mathrm{ax}} = \\left( U_{\\mathrm{tor}}(\\phi_{\\mathrm{eq}}) - U_{\\mathrm{tor}}(\\phi_{\\mathrm{ax}}) \\right) + \\sum_{k=1}^{3} \\left( \\left( U_{\\mathrm{LJ}}(r_{k,\\mathrm{eq}}) - U_{\\mathrm{LJ}}(r_{k,\\mathrm{ax}}) \\right) + \\left( U_{\\mathrm{C}}(r_{k,\\mathrm{eq}}) - U_{\\mathrm{C}}(r_{k,\\mathrm{ax}}) \\right) \\right)\n$$\n这个表达式可以写成每个能量分量差值的和：\n$$\n\\Delta E = \\Delta U_{\\mathrm{tor}} + \\sum_{k=1}^{3} (\\Delta U_{\\mathrm{LJ},k} + \\Delta U_{\\mathrm{C},k})\n$$\n其中：\n$$\n\\Delta U_{\\mathrm{tor}} = \\frac{V}{2} \\left[ \\cos(n\\phi_{\\mathrm{eq}} - \\delta) - \\cos(n\\phi_{\\mathrm{ax}} - \\delta) \\right]\n$$\n$$\n\\Delta U_{\\mathrm{LJ},k} = 4\\varepsilon_k \\left[ \\left( \\left(\\frac{\\sigma_k}{r_{k,\\mathrm{eq}}}\\right)^{12} - \\left(\\frac{\\sigma_k}{r_{k,\\mathrm{eq}}}\\right)^{6} \\right) - \\left( \\left(\\frac{\\sigma_k}{r_{k,\\mathrm{ax}}}\\right)^{12} - \\left(\\frac{\\sigma_k}{r_{k,\\mathrm{ax}}}\\right)^{6} \\right) \\right]\n$$\n$$\n\\Delta U_{\\mathrm{C},k} = k_c q_X q_{R_k} \\left( \\frac{1}{r_{k,\\mathrm{eq}}} - \\frac{1}{r_{k,\\mathrm{ax}}} \\right)\n$$\n计算过程是通过将六个指定测试案例中的每一个的参数集代入这些方程来进行。固定的几何参数是：\n- 二面角：$\\phi_{\\mathrm{ax}} = 60^\\circ$, $\\phi_{\\mathrm{eq}} = 180^\\circ$。\n- 非键合距离（轴向，赤道），单位为 nm：\n    - 对 $1$：($0.33$, $0.38$)\n    - 对 $2$：($0.40$, $0.35$)\n    - 对 $3$：($0.36$, $0.39$)\n该实现将计算每个案例的总 $\\Delta E$ 并按要求格式化结果。", "answer": "$$\\boxed{[-2.951, -3.116, 2.766, -1.751, -1.200, -1.751]}$$", "id": "2452387"}, {"introduction": "计算化学中的一项关键技能不仅是成功运行模拟，更重要的是在模拟失败时进行诊断。本练习模拟了一个常见的灾难性故障——模拟“爆炸”——并要求你设计一套逻辑严谨、系统化的工作流程，以精确定位力场能量项中导致不稳定的根源。这个练习将带你从计算转向方法论，学习在分子动力学背景下进行科学调试的原则。[@problem_id:2452415]", "problem": "你正在使用一种常见的生物分子力场，如AMBER (Assisted Model Building with Energy Refinement)、CHARMM (Chemistry at HARvard Macromolecular Mechanics)、OPLS (Optimized Potentials for Liquid Simulations) 或 GROMOS (GROningen MOlecular Simulation)，对一个小的有机溶质在显式水模型中进行分子动力学（MD）模拟，并采用了周期性边界条件。该力场的势能是常见的键合项和非键合项之和：\n$$\nE(\\mathbf{r}) \\;=\\; E_{\\mathrm{bond}} \\;+\\; E_{\\mathrm{angle}} \\;+\\; E_{\\mathrm{dihedral}} \\;+\\; E_{\\mathrm{LJ}} \\;+\\; E_{\\mathrm{Coul}},\n$$\n其中 $E_{\\mathrm{LJ}}$ 是 Lennard-Jones 项，$E_{\\mathrm{Coul}}$ 是库仑静电项。在开始生产阶段后，模拟在短时间内“爆炸”：势能飙升至极大的正值，原子坐标变得不符合物理规律。\n\n你希望设计一个有原则的调试工作流程，能够将这种不稳定性追溯到势能中的某个特定能量项，以便修正参数化或设置中的错误（例如，错误的组合规则、不正确的 $1$–$4$ 缩放、糟糕的初始几何构型，或缺失的键合参数）。以下哪种工作流程最适合从第一性原理出发，分离出有问题的项？\n\nA. 将积分时间步长减少到 $0.1\\,\\mathrm{fs}$，并与恒温器和恒压器强耦合，以防止系统升温。如果模拟不再爆炸，则断定不稳定性是由于时间步长过大所致，并继续使用这些阻尼设置。\n\nB. 将当前力场（例如 OPLS）替换为另一个不同的力场（例如 CHARMM），而不改变其他任何设置。如果模拟变得稳定，则断定原始力场不正确，并采用新力场。\n\nC. 进行能量最小化以消除空间位阻冲突，然后进行一系列短时的、受约束的单点或少步运行。在这些运行中，你将逐步引入能量项的子集以构建完整的势能：首先是 $E_{\\mathrm{bond}} + E_{\\mathrm{angle}}$，然后添加 $E_{\\mathrm{dihedral}}$，接着按照所选力场的规定添加经过缩放的 $1$–$4$ 分子内非键相互作用，然后使用正确的交叉相互作用组合规则添加 $E_{\\mathrm{LJ}}$，最后使用预期的长程作用处理方法（例如，Particle Mesh Ewald (PME)）添加 $E_{\\mathrm{Coul}}$。在每个阶段，记录各项能量并监测原子间距 $r_{ij}$。找出能量或力开始发散的第一个阶段，并检查相应的参数（例如，平衡值、力常数、部分电荷、$\\sigma/\\epsilon$ 和 $1$–$4$ 缩放）以定位有问题的项。\n\nD. 将非键截断半径增加到一个非常大的值，禁用所有排除项，并关闭所有键合项，以便只剩下非键相互作用。如果系统仍然爆炸，则断定非键项是罪魁祸首，并将所有部分电荷减少 $10$ 倍以稳定运行。\n\nE. 对所有重原子施加强位置限制，并进行最速下降法最小化，直到梯度范数低于一个小阈值。然后计算一次总能量和总力。如果总力范数很小，则断定系统是稳定的；如果很大，则断定是积分器出了问题。没有必要分解为 $E_{\\mathrm{bond}}$、$E_{\\mathrm{angle}}$、$E_{\\mathrm{dihedral}}$、$E_{\\mathrm{LJ}}$ 或 $E_{\\mathrm{Coul}}$。", "solution": "该问题描述了分子动力学（MD）模拟领域中一个常见且关键的问题：数值不稳定性，通常被称为模拟“爆炸”。其特征是势能快速、发散性地增加，并产生不符合物理规律的原子坐标。任务是确定最合适的、有原则的调试工作流程，以分离出导致这种不稳定性的特定能量项。\n\n问题陈述科学合理且表述清晰。势能函数\n$$\nE(\\mathbf{r}) \\;=\\; E_{\\mathrm{bond}} \\;+\\; E_{\\mathrm{angle}} \\;+\\; E_{\\mathrm{dihedral}} \\;+\\; E_{\\mathrm{LJ}} \\;+\\; E_{\\mathrm{Coul}}\n$$\n是像 AMBER、CHARMM、OPLS 和 GROMOS 这类常见生物分子力场的标准表示。由于参数化错误（例如，不正确的 $1$–$4$ 缩放、缺失参数）或设置错误（例如，带有空间位阻冲突的不良初始几何构型）导致模拟失败的情景非常现实。目标是找到一种系统性的诊断方法，这是计算科学中的一项基本技能。该问题是有效的。\n\n一个有原则的调试工作流程必须是系统性的和隔离性的。它应该从最简单的可能稳定状态开始，并逐步增加复杂性，在每一步检查是否出现故障。目标不仅仅是抑制不稳定性，而是要确定其在物理模型——势能函数——中的根本原因。\n\n让我们评估每种提议的工作流程。\n\n**A. 将积分时间步长减少到 $0.1\\,\\mathrm{fs}$，并与恒温器和恒压器强耦合，以防止系统升温。如果模拟不再爆炸，则断定不稳定性是由于时间步长过大所致，并继续使用这些阻尼设置。**\n\n这种方法是有缺陷的。它治标不治本。虽然非常小的时间步长（标准通常为 $1$–$2\\,\\mathrm{fs}$）和强的温度/压力耦合可以抑制高频运动并抑制数值不稳定性，但它们并不能纠正势能函数或初始几何构型中的根本错误。如果势能包含奇点（例如，来自不正确的 Lennard-Jones 参数，其中排斥墙缺失）或对某些构型产生过大的力，这种方法只是掩盖了问题。由此产生的模拟，即使没有崩溃，也可能是在对一个完全不符合物理规律的状态进行采样，并且在科学上是无效的。断定时间步长是唯一原因是过早且可能不正确的诊断。目标是修正力场设置，而不是为了让模拟运行而削弱其动力学过程。\n\n**结论：** 错误。\n\n**B. 将当前力场（例如 OPLS）替换为另一个不同的力场（例如 CHARMM），而不改变其他任何设置。如果模拟变得稳定，则断定原始力场不正确，并采用新力场。**\n\n这是一种不科学的“散弹枪式”调试方法。它未能提供任何关于原始模拟为何失败的见解。模拟爆炸最可能的原因不是像 OPLS 这样广泛使用的力场存在根本性缺陷，而是用户在应用它时出现错误（例如，拓扑文件中的错误、溶质缺失参数或不正确的准备脚本）。如果更换力场恰好奏效，很可能是因为新力场的设置过程被偶然正确执行，或者因为其参数文件对于给定的分子更完整。断定“原始力场不正确”是一种严重的过度简化，不能构成恰当的诊断。有原则的调查要求理解所选模型内的具体失败原因。\n\n**结论：** 错误。\n\n**C. 进行能量最小化以消除空间位阻冲突，然后进行一系列短时的、受约束的单点或少步运行。在这些运行中，你将逐步引入能量项的子集以构建完整的势能：首先是 $E_{\\mathrm{bond}} + E_{\\mathrm{angle}}$，然后添加 $E_{\\mathrm{dihedral}}$，接着按照所选力场的规定添加经过缩放的 $1$–$4$ 分子内非键相互作用，然后使用正确的交叉相互作用组合规则添加 $E_{\\mathrm{LJ}}$，最后使用预期的长程作用处理方法（例如，Particle Mesh Ewald (PME)）添加 $E_{\\mathrm{Coul}}$。在每个阶段，记录各项能量并监测原子间距 $r_{ij}$。找出能量或力开始发散的第一个阶段，并检查相应的参数（例如，平衡值、力常数、部分电荷、$\\sigma/\\epsilon$ 和 $1$–$4$ 缩放）以定位有问题的项。**\n\n这个工作流程是诊断此类问题的正确且标准的专业程序。它系统、逻辑清晰，并且专为隔离问题而设计。\n$1$. **能量最小化：** 这是解决初始结构中高能空间位阻冲突的正确第一步，这些冲突是模拟爆炸的常见原因。\n$2$. **增量构建：** 依次添加能量项（首先是键合项，然后是二面角项，最后是非键合项）是一种经典的分而治之策略。它允许人们精确定位势能的哪个组成部分引入了不稳定性。所提议的顺序是合乎逻辑的，从局部的共价相互作用过渡到更复杂和范围更长的相互作用。\n$3$. **监测：** 在每个阶段检查能量和力可以提供明确的信号。如果系统在使用第 $1$ 到第 $N-1$ 项时是稳定的，但在添加第 $N$ 项后爆炸，那么第 $N$ 项就是问题的根源。\n$4$. **检查：** 一旦确定了有问题的项，就可以对相关参数进行有针对性的调查，这正是调试过程的最终目标。这个工作流程直接导向错误的根本原因。\n\n**结论：** 正确。\n\n**D. 将非键截断半径增加到一个非常大的值，禁用所有排除项，并关闭所有键合项，以便只剩下非键相互作用。如果系统仍然爆炸，则断定非键项是罪魁祸首，并将所有部分电荷减少 $10$ 倍以稳定运行。**\n\n这个工作流程是荒谬且具有物理破坏性的。\n$1$. **关闭键合项：** 这会使分子解体。它不再是对预期系统的模拟。\n$2$. **禁用所有排除项：** 力场的参数化是基于一个假设，即由一个键（$1$–$2$ 对）和两个键（$1$–$3$ 对）分隔的原子之间的相互作用在非键计算中被排除。禁用这些排除项将在邻近原子之间引入巨大的排斥力和静电力，这必然会立即导致爆炸。这一行为表明了对力场构建方式的基本误解。\n$3$. **任意减少电荷：** 这不是诊断；这是对物理模型的随意修改，毫无道理。问题可能出在 Lennard-Jones 参数上，而不是电荷上。此步骤无法确定具体错误。\n\n**结论：** 错误。\n\n**E. 对所有重原子施加强位置限制，并进行最速下降法最小化，直到梯度范数低于一个小阈值。然后计算一次总能量和总力。如果总力范数很小，则断定系统是稳定的；如果很大，则断定是积分器出了问题。**\n\n这个工作流程基于有缺陷的逻辑。对一个经过最小化和约束的结构进行单次静态力计算不足以评估动态稳定性。系统可能在该特定构型下是稳定的，但一旦原子在实际的 MD 运行中开始移动，就可能变得不稳定。最关键的错误在于其结论：“如果[力]很大，则断定是积分器出了问题。” 力是根据势能的梯度计算出来的，$F = -\\nabla E$。积分器（例如 Verlet 算法）只是使用这些力来更新位置。一个极大的力指向势能函数 $E$（即力场参数或几何构型）存在问题，而不是指向标准且经过充分验证的积分算法。最后，“没有必要分解……”的说法与有原则的诊断目标背道而驰，诊断的目的恰恰是分解问题以找到其根源。\n\n**结论：** 错误。", "answer": "$$\\boxed{C}$$", "id": "2452415"}]}