{"hands_on_practices": [{"introduction": "力场中的参数（如原子局部电荷）并非凭空而来，而是通过精细的调校过程确定的，旨在重现实验可测量的宏观性质。本练习 [@problem_id:2456417] 将带你亲身体验这一核心过程。你将通过一个简化的甲醇模型，学习如何调整羟基氢的局部电荷，使其预测的蒸发热与实验值完美匹配，从而深入理解微观参数与宏观现象之间的联系。", "problem": "给定一个简化的、有物理基础的甲醇模型，其中只有羟基的氢和氧携带大小相等、符号相反的部分电荷。设羟基氢携带的部分电荷为 $+q$（以基本电荷 $e$ 为单位），氧携带的部分电荷为 $-q$。甲基基团呈电中性。该液体预测的摩尔汽化热，记为 $\\Delta H_{\\mathrm{vap}}^{\\mathrm{pred}}(q)$，其模型为\n$$\n\\Delta H_{\\mathrm{vap}}^{\\mathrm{pred}}(q) \\;=\\; E_{\\mathrm{ne}} \\;+\\; \\frac{s\\,z\\,k_e}{r_{\\mathrm{HB}}}\\,q^2 \\;+\\; R\\,T,\n$$\n其中 $E_{\\mathrm{ne}}$ 是基准非静电内聚贡献（每摩尔），$s$ 是一个无量纲的屏蔽因子，考虑了取向平均和局域屏蔽效应，$z$ 是每个分子的平均氢键配位数，$k_e$ 是以力场单位表示的库仑常数，$r_{\\mathrm{HB}}$ 是特征氧-氢氢键距离，$R$ 是摩尔气体常数，$T$ 是绝对温度。所有能量单位为 $\\mathrm{kJ\\,mol^{-1}}$，距离单位为 $\\mathrm{nm}$，温度单位为 $\\mathrm{K}$，电荷单位为 $e$。使用常数 $k_e = 138.935456\\ \\mathrm{kJ\\,mol^{-1}\\,nm\\,e^{-2}}$ 和 $R = 8.314462618\\times 10^{-3}\\ \\mathrm{kJ\\,mol^{-1}\\,K^{-1}}$。对于下面的每个测试用例，令 $\\Delta H_{\\mathrm{vap}}^{\\mathrm{exp}}$ 表示目标实验摩尔汽化热。\n\n你的任务是：对于每个测试用例，计算非负的羟基氢部分电荷 $q_{\\mathrm{opt}}$（以 $e$ 为单位），使得模型预测与实验值之间的平方误差最小，即最小化\n$$\n\\left(\\Delta H_{\\mathrm{vap}}^{\\mathrm{pred}}(q) - \\Delta H_{\\mathrm{vap}}^{\\mathrm{exp}}\\right)^2\n$$\n约束条件为 $q \\ge 0$。以 $e$ 为单位，将每个 $q_{\\mathrm{opt}}$ 报告为十进制数，并四舍五入到四位小数。\n\n测试集（每个项目按必须处理的顺序列出 $(T,\\ \\Delta H_{\\mathrm{vap}}^{\\mathrm{exp}},\\ r_{\\mathrm{HB}},\\ z,\\ s,\\ E_{\\mathrm{ne}})$）：\n- 案例1（标称甲醇条件）：$(298.15\\ \\mathrm{K},\\ 35.3\\ \\mathrm{kJ\\,mol^{-1}},\\ 0.19\\ \\mathrm{nm},\\ 1.7,\\ 0.05,\\ 20.0\\ \\mathrm{kJ\\,mol^{-1}})$。\n- 案例2（基准值超过目标值；边界行为）：$(298.15\\ \\mathrm{K},\\ 35.3\\ \\mathrm{kJ\\,mol^{-1}},\\ 0.19\\ \\mathrm{nm},\\ 1.7,\\ 0.05,\\ 33.0\\ \\mathrm{kJ\\,mol^{-1}})$。\n- 案例3（温度升高，目标值降低）：$(350.0\\ \\mathrm{K},\\ 31.0\\ \\mathrm{kJ\\,mol^{-1}},\\ 0.19\\ \\mathrm{nm},\\ 1.7,\\ 0.05,\\ 20.0\\ \\mathrm{kJ\\,mol^{-1}})$。\n- 案例4（有效屏蔽减弱）：$(298.15\\ \\mathrm{K},\\ 35.3\\ \\mathrm{kJ\\,mol^{-1}},\\ 0.19\\ \\mathrm{nm},\\ 1.7,\\ 0.02,\\ 20.0\\ \\mathrm{kJ\\,mol^{-1}})$。\n\n最终输出格式：你的程序应产生单行输出，包含四个最优电荷，以逗号分隔并用方括号括起，顺序与测试集相同，例如 $[q_1,q_2,q_3,q_4]$，每个 $q_i$ 四舍五入到四位小数，并以 $e$ 为单位表示。", "solution": "首先对问题进行严格验证。\n\n**第一步：提取已知信息**\n- 预测的甲醇摩尔汽化热模型如下：\n$$\n\\Delta H_{\\mathrm{vap}}^{\\mathrm{pred}}(q) \\;=\\; E_{\\mathrm{ne}} \\;+\\; \\frac{s\\,z\\,k_e}{r_{\\mathrm{HB}}}\\,q^2 \\;+\\; R\\,T\n$$\n其中，$q$ 是羟基氢的部分电荷（单位为 $e$），$E_{\\mathrm{ne}}$ 是非静电内聚能，$s$ 是屏蔽因子，$z$ 是配位数，$k_e$ 是库仑常数，$r_{\\mathrm{HB}}$ 是氢键距离，$R$ 是摩尔气体常数，$T$ 是温度。\n- 常数：\n  - $k_e = 138.935456\\ \\mathrm{kJ\\,mol^{-1}\\,nm\\,e^{-2}}$\n  - $R = 8.314462618\\times 10^{-3}\\ \\mathrm{kJ\\,mol^{-1}\\,K^{-1}}$\n- 目标是找到非负电荷 $q_{\\mathrm{opt}} \\ge 0$，以最小化平方误差：\n$$\nL(q) = \\left(\\Delta H_{\\mathrm{vap}}^{\\mathrm{pred}}(q) - \\Delta H_{\\mathrm{vap}}^{\\mathrm{exp}}\\right)^2\n$$\n其中 $\\Delta H_{\\mathrm{vap}}^{\\mathrm{exp}}$ 是实验摩尔汽化热。\n- 提供了四个测试用例，每个用例指定了一组参数 $(T,\\ \\Delta H_{\\mathrm{vap}}^{\\mathrm{exp}},\\ r_{\\mathrm{HB}},\\ z,\\ s,\\ E_{\\mathrm{ne}})$。\n\n**第二步：使用提取的已知信息进行验证**\n- **科学依据：**该模型是对极性液体中内聚能的一种物理上合理但简化的表示。它将能量分解为非静电的 Lennard-Jones 型贡献（$E_{\\mathrm{ne}}$）、成对静电项（$q^2$ 项）和汽化时的压强-体积功项（$RT$）。此类模型是发展经典分子力学力场的基础。常数和参数值处于凝聚相甲醇的实际范围内。问题在科学上和事实上都是合理的。\n- **适定性：**目标是在 $q \\ge 0$ 的约束下最小化函数 $L(q)$。该函数是关于 $q$ 的简单多项式，确保存在一个明确定义的最小值。该问题在数学结构上保证有唯一且稳定的解。\n- **客观性：**问题陈述使用了精确、客观、正式的科学语言，没有歧义或主观论断。\n\n**第三步：结论与行动**\n- 问题是有效的。它具有科学依据、适定性和客观性。将制定解决方案。\n\n**求解推导**\n任务是找到 $q \\ge 0$ 的值，以最小化平方误差函数：\n$$\nL(q) = \\left( \\left( E_{\\mathrm{ne}} \\;+\\; R\\,T \\;+\\; \\frac{s\\,z\\,k_e}{r_{\\mathrm{HB}}}\\,q^2 \\right) - \\Delta H_{\\mathrm{vap}}^{\\mathrm{exp}} \\right)^2\n$$\n为了简化表达式，我们定义两个辅助量。令汽化焓的基准非静电贡献为：\n$$\nH_{\\mathrm{base}} = E_{\\mathrm{ne}} + R\\,T\n$$\n并令静电项的系数为：\n$$\nC_{\\mathrm{elec}} = \\frac{s\\,z\\,k_e}{r_{\\mathrm{HB}}}\n$$\n参数 $s$、$z$、$k_e$ 和 $r_{\\mathrm{HB}}$ 都被指定为正的物理量，因此 $C_{\\mathrm{elec}}  0$。目标函数现在可以写成：\n$$\nL(q) = \\left( H_{\\mathrm{base}} + C_{\\mathrm{elec}}\\,q^2 - \\Delta H_{\\mathrm{vap}}^{\\mathrm{exp}} \\right)^2\n$$\n我们寻求在 $q \\ge 0$ 的条件下最小化 $L(q)$。由于 $L(q)$ 是一个平方量，其最小值为 $0$。当且仅当括号内的项为零时，才能达到这个最小值，前提是在 $q$ 的允许域内存在解。因此，我们将该项设为零，然后解出 $q$：\n$$\nH_{\\mathrm{base}} + C_{\\mathrm{elec}}\\,q^2 - \\Delta H_{\\mathrm{vap}}^{\\mathrm{exp}} = 0\n$$\n$$\nC_{\\mathrm{elec}}\\,q^2 = \\Delta H_{\\mathrm{vap}}^{\\mathrm{exp}} - H_{\\mathrm{base}}\n$$\n$$\nq^2 = \\frac{\\Delta H_{\\mathrm{vap}}^{\\mathrm{exp}} - H_{\\mathrm{base}}}{C_{\\mathrm{elec}}}\n$$\n我们来分析分子 $\\Delta E = \\Delta H_{\\mathrm{vap}}^{\\mathrm{exp}} - H_{\\mathrm{base}}$。\n\n情况1：静电相互作用有助于匹配实验值。\n如果 $\\Delta H_{\\mathrm{vap}}^{\\mathrm{exp}} \\ge H_{\\mathrm{base}}$，则 $\\Delta E \\ge 0$。关于 $q^2$ 的方程右侧为非负数。我们可以求得 $q$ 的实数解：\n$$\nq = \\pm\\sqrt{\\frac{\\Delta H_{\\mathrm{vap}}^{\\mathrm{exp}} - H_{\\mathrm{base}}}{C_{\\mathrm{elec}}}}\n$$\n考虑到约束条件 $q \\ge 0$，最优电荷是主平方根：\n$$\nq_{\\mathrm{opt}} = \\sqrt{\\frac{\\Delta H_{\\mathrm{vap}}^{\\mathrm{exp}} - (E_{\\mathrm{ne}} + R\\,T)}{s\\,z\\,k_e / r_{\\mathrm{HB}}}}\n$$\n\n情况2：基准模型已经超过实验值。\n如果 $\\Delta H_{\\mathrm{vap}}^{\\mathrm{exp}}  H_{\\mathrm{base}}$，则 $\\Delta E  0$。关于 $q^2$ 的方程右侧为负数，因此没有实数 $q$ 能使误差为零。在这种情况下，括号内的项 $C_{\\mathrm{elec}}\\,q^2 - (-\\Delta E)$ 对任何实数 $q$ 始终为正，因为 $C_{\\mathrm{elec}}  0$ 且 $-\\Delta E  0$。为了最小化平方误差 $L(q) = (C_{\\mathrm{elec}}\\,q^2 - (-\\Delta E))^2$，我们必须最小化 $C_{\\mathrm{elec}}\\,q^2$ 的值。在约束条件 $q \\ge 0$ 下，项 $C_{\\mathrm{elec}}\\,q^2$ 是关于 $q$ 的单调递增函数。其最小值在定义域的下边界处取得，即 $q=0$。因此，对于这种情况：\n$$\nq_{\\mathrm{opt}} = 0\n$$\n这个结果在物理上是合理的：如果非静电模型已经高估了内聚能，那么在此模型中始终为正的静电贡献必须设为零，以实现最佳拟合。\n\n综合两种情况，最优电荷 $q_{\\mathrm{opt}}$ 可以紧凑地表示为：\n$$\nq_{\\mathrm{opt}} = \\sqrt{\\max\\left(0, \\frac{\\Delta H_{\\mathrm{vap}}^{\\mathrm{exp}} - E_{\\mathrm{ne}} - R\\,T}{s\\,z\\,k_e / r_{\\mathrm{HB}}}\\right)}\n$$\n将实施此公式来为指定的四个测试用例求解 $q_{\\mathrm{opt}}$。每个案例的结果将四舍五入到四位小数。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the optimal partial charge q that minimizes the squared error\n    between a simple model for the heat of vaporization of methanol and its\n    experimental value.\n    \"\"\"\n    \n    # Define physical constants from the problem statement.\n    # k_e: Coulomb constant in kJ mol^-1 nm e^-2\n    k_e = 138.935456\n    # R: Molar gas constant in kJ mol^-1 K^-1\n    R = 8.314462618e-3\n\n    # Test suite cases: (T, delta_H_vap_exp, r_HB, z, s, E_ne)\n    # T in K, delta_H_vap_exp in kJ/mol, r_HB in nm, z dimensionless,\n    # s dimensionless, E_ne in kJ/mol.\n    test_cases = [\n        # Case 1: Nominal methanol conditions\n        (298.15, 35.3, 0.19, 1.7, 0.05, 20.0),\n        # Case 2: Baseline exceeds target; boundary behavior\n        (298.15, 35.3, 0.19, 1.7, 0.05, 33.0),\n        # Case 3: Elevated temperature with lower target\n        (350.0, 31.0, 0.19, 1.7, 0.05, 20.0),\n        # Case 4: Weaker effective screening\n        (298.15, 35.3, 0.19, 1.7, 0.02, 20.0),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # Unpack parameters for the current case\n        T, delta_H_vap_exp, r_HB, z, s, E_ne = case\n\n        # Calculate the numerator for the q^2 expression:\n        # delta_H_vap_exp - (E_ne + R*T)\n        numerator = delta_H_vap_exp - E_ne - R * T\n        \n        q_opt = 0.0\n        # If the numerator is non-negative, a non-zero charge can improve the model.\n        if numerator >= 0:\n            # Calculate the denominator (electrostatic coefficient)\n            # C_elec = (s * z * k_e) / r_HB\n            denominator = (s * z * k_e) / r_HB\n            \n            # The problem parameters ensure denominator is positive.\n            q_squared = numerator / denominator\n            q_opt = np.sqrt(q_squared)\n        # If the numerator is negative, the non-electrostatic part of the model\n        # already exceeds the target value. The best fit is achieved by setting\n        # the electrostatic contribution to zero, i.e., q_opt = 0.\n\n        results.append(q_opt)\n\n    # Format results to four decimal places as strings\n    formatted_results = [f\"{res:.4f}\" for res in results]\n\n    # Print the final output in the required format: [q1,q2,q3,q4]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2456417"}, {"introduction": "在分子世界中，氢键并非静止不变，而是在皮秒（$10^{-12}$秒）级别的时间尺度上不断地形成和断裂。本练习 [@problem_id:2456451] 旨在让你掌握量化这一动态过程的关键工具——氢键寿命自相关函数。通过一个简化的双态模型，你将计算并比较水在不同温度下的氢键动力学，直观地感受温度如何影响这些生命活动中至关重要的相互作用的稳定性。", "problem": "给定一个液态水中特定供体和受体之间单个氢键（H-bond）的简化双态模型，该模型表示为一个具有“成键”和“断键”两种状态的连续时间马尔可夫链（CTMC）。指示变量定义为 $h(t) \\in \\{0,1\\}$，其中当氢键对成键时 $h(t) = 1$，否则 $h(t) = 0$。该过程假设在平衡时处于稳态。从“成键”状态转变为“断键”状态的断裂速率为 $k_{\\mathrm{b}}(T)$，从“断键”状态转变为“成键”状态的形成速率为 $k_{\\mathrm{f}}(T)$，两者均遵循阿伦尼乌斯型温度依赖性：\n$$\nk_{\\mathrm{b}}(T) = A_{\\mathrm{b}}\\exp\\!\\left(-\\frac{E_{\\mathrm{b}}}{R\\,T}\\right), \\quad\nk_{\\mathrm{f}}(T) = A_{\\mathrm{f}}\\exp\\!\\left(-\\frac{E_{\\mathrm{f}}}{R\\,T}\\right),\n$$\n其中 $R$ 是普适气体常数。氢键寿命自相关函数以归一化形式定义为：\n$$\nC(t) = \\frac{\\langle h(0)h(t)\\rangle - \\langle h \\rangle^2}{\\langle h^2 \\rangle - \\langle h \\rangle^2},\n$$\n其中系综平均是在稳态过程中计算的。\n\n使用以下适用于经典力场描述下液态水的、有物理依据的参数：\n- 普适气体常数 $R = 8.314462618 \\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$。\n- 断裂尝试频率 $A_{\\mathrm{b}} = 2.0 \\times 10^{12} \\ \\mathrm{s^{-1}}$。\n- 形成尝试频率 $A_{\\mathrm{f}} = 1.0 \\times 10^{12} \\ \\mathrm{s^{-1}}$。\n- 断裂活化能 $E_{\\mathrm{b}} = 1.10 \\times 10^{4} \\ \\mathrm{J\\,mol^{-1}}$。\n- 形成活化能 $E_{\\mathrm{f}} = 4.00 \\times 10^{3} \\ \\mathrm{J\\,mol^{-1}}$。\n\n计算在温度 $T = 273 \\ \\mathrm{K}$ 和 $T = 373 \\ \\mathrm{K}$ 下，以下以皮秒表示的时间点 $t = [0, 1, 2, 5, 10]$ 对应的归一化自相关值 $C(t)$。您的程序内部必须以秒为单位处理时间；请使用 $1 \\ \\mathrm{ps} = 10^{-12} \\ \\mathrm{s}$ 将输入时间从皮秒转换为秒。所需的输出是每个时间和温度下 $C(t)$ 的无量纲值，四舍五入到六位小数。\n\n测试套件：\n- 温度 $T = 273 \\ \\mathrm{K}$，时间 $t = [0, 1, 2, 5, 10] \\ \\mathrm{ps}$。\n- 温度 $T = 373 \\ \\mathrm{K}$，时间 $t = [0, 1, 2, 5, 10] \\ \\mathrm{ps}$。\n\n您的程序应生成单行输出，其中包含与上述测试套件相对应的结果，格式为逗号分隔的嵌套列表。例如，必须严格按照以下格式打印一行：\n\"[ [C_273(t0),C_273(t1),C_273(t2),C_273(t3),C_273(t4)], [C_373(t0),C_373(t1),C_373(t2),C_373(t3),C_373(t4)] ]\"\n每个条目都四舍五入到六位小数，并以十进制数（无单位）表示。不要包含任何其他文本。本问题不涉及角度。所有带物理单位的量都必须按上述规定处理。最终答案必须是无量纲的浮点数。", "solution": "所述问题具有科学依据，提法明确且客观。它描述了物理化学和统计力学中使用的标准双态动力学模型，并提供了所有必要的参数和定义。任务是计算氢键寿命自相关函数。我将继续进行求解。\n\n该系统是一个具有两个状态的连续时间马尔可夫链，我们将其标记为状态 $0$（“断键”）和状态 $1$（“成键”）。指示变量 $h(t)$ 定义为：如果系统处于状态 $1$，则 $h(t)=1$；如果处于状态 $0$，则 $h(t)=0$。从 $0 \\to 1$ 的跃迁速率为 $k_{\\mathrm{f}}$，从 $1 \\to 0$ 的跃迁速率为 $k_{\\mathrm{b}}$。此过程的跃迁速率矩阵 $Q$ 为：\n$$\nQ = \\begin{pmatrix} -k_{\\mathrm{f}}  k_{\\mathrm{f}} \\\\ k_{\\mathrm{b}}  -k_{\\mathrm{b}} \\end{pmatrix}\n$$\n假设该过程是稳态的。稳态概率 $\\pi_0 = P(h=0)$ 和 $\\pi_1 = P(h=1)$ 可通过求解主方程的稳态条件得到，这导出了细致平衡方程 $k_{\\mathrm{f}} \\pi_0 = k_{\\mathrm{b}} \\pi_1$。结合归一化条件 $\\pi_0 + \\pi_1 = 1$，我们得到稳态概率：\n$$\n\\pi_0 = \\frac{k_{\\mathrm{b}}}{k_{\\mathrm{f}} + k_{\\mathrm{b}}}, \\quad \\pi_1 = \\frac{k_{\\mathrm{f}}}{k_{\\mathrm{f}} + k_{\\mathrm{b}}}\n$$\n问题要求计算归一化自相关函数：\n$$\nC(t) = \\frac{\\langle h(0)h(t)\\rangle - \\langle h \\rangle^2}{\\langle h^2 \\rangle - \\langle h \\rangle^2}\n$$\n首先，我们计算指示变量 $h$ 在稳态分布下的矩。由于 $h$ 是一个取值为 $0$ 或 $1$ 的伯努利变量，其矩的计算很简单：\n$$\n\\langle h \\rangle = (0)\\pi_0 + (1)\\pi_1 = \\pi_1\n$$\n$$\n\\langle h^2 \\rangle = (0)^2\\pi_0 + (1)^2\\pi_1 = \\pi_1\n$$\n$C(t)$ 的分母是 $h$ 的方差：\n$$\n\\langle h^2 \\rangle - \\langle h \\rangle^2 = \\pi_1 - \\pi_1^2 = \\pi_1(1-\\pi_1) = \\pi_1\\pi_0\n$$\n接下来，我们计算分子中的时间相关项 $\\langle h(0)h(t)\\rangle$。根据系综平均的定义：\n$$\n\\langle h(0)h(t)\\rangle = \\sum_{i,j \\in \\{0,1\\}} (i \\cdot j) P\\big(h(0)=i, h(t)=j\\big)\n$$\n乘积 $i \\cdot j$ 仅在 $i=1$ 且 $j=1$ 时非零。因此：\n$$\n\\langle h(0)h(t)\\rangle = (1 \\cdot 1) P\\big(h(0)=1, h(t)=1\\big) = P\\big(h(0)=1\\big) P\\big(h(t)=1 | h(0)=1\\big)\n$$\n这里，$P\\big(h(0)=1\\big)$ 是稳态概率 $\\pi_1$，$P\\big(h(t)=1 | h(0)=1\\big)$ 是在 $t=0$ 时系统处于状态 $1$ 的条件下，在时间 $t$ 处于状态 $1$ 的条件概率。我们将这个跃迁概率记为 $P_{11}(t)$。因此，$\\langle h(0)h(t)\\rangle = \\pi_1 P_{11}(t)$。\n\n为了求得 $P_{11}(t)$，我们求解从 $p_1(0)=1$ 开始、处于状态 $1$ 的概率 $p_1(\\tau)$ 的主方程：\n$$\n\\frac{dp_1(\\tau)}{d\\tau} = k_{\\mathrm{f}} p_0(\\tau) - k_{\\mathrm{b}} p_1(\\tau)\n$$\n使用 $p_0(\\tau) = 1 - p_1(\\tau)$，方程变为：\n$$\n\\frac{dp_1(\\tau)}{d\\tau} = k_{\\mathrm{f}}(1 - p_1(\\tau)) - k_{\\mathrm{b}} p_1(\\tau) = k_{\\mathrm{f}} - (k_{\\mathrm{f}} + k_{\\mathrm{b}})p_1(\\tau)\n$$\n这是一个线性一阶常微分方程。在初始条件 $p_1(0) = 1$ 下的解为：\n$$\nP_{11}(t) \\equiv p_1(t) = \\frac{k_{\\mathrm{f}}}{k_{\\mathrm{f}}+k_{\\mathrm{b}}} + \\left(1 - \\frac{k_{\\mathrm{f}}}{k_{\\mathrm{f}}+k_{\\mathrm{b}}}\\right) e^{-(k_{\\mathrm{f}}+k_{\\mathrm{b}})t}\n$$\n代入 $\\pi_0$ 和 $\\pi_1$ 的表达式：\n$$\nP_{11}(t) = \\pi_1 + \\pi_0 e^{-(k_{\\mathrm{f}}+k_{\\mathrm{b}})t}\n$$\n现在我们可以表示 $C(t)$ 的分子：\n$$\n\\langle h(0)h(t)\\rangle - \\langle h \\rangle^2 = \\pi_1 P_{11}(t) - \\pi_1^2 = \\pi_1 \\left( \\pi_1 + \\pi_0 e^{-(k_{\\mathrm{f}}+k_{\\mathrm{b}})t} \\right) - \\pi_1^2 = \\pi_1\\pi_0 e^{-(k_{\\mathrm{f}}+k_{\\mathrm{b}})t}\n$$\n最后，组合得到 $C(t)$：\n$$\nC(t) = \\frac{\\pi_1\\pi_0 e^{-(k_{\\mathrm{f}}+k_{\\mathrm{b}})t}}{\\pi_1\\pi_0} = e^{-(k_{\\mathrm{f}}+k_{\\mathrm{b}})t}\n$$\n这个简洁的结果表明，归一化自相关函数呈指数衰减，其速率等于正向和逆向反应速率之和。\n\n计算步骤如下：\n1. 对于给定的温度 $T$，使用提供的阿伦尼乌斯方程计算速率常数 $k_{\\mathrm{b}}(T)$ 和 $k_{\\mathrm{f}}(T)$：\n   $$\n   k_{\\mathrm{b}}(T) = A_{\\mathrm{b}}\\exp\\!\\left(-\\frac{E_{\\mathrm{b}}}{R\\,T}\\right), \\quad\n   k_{\\mathrm{f}}(T) = A_{\\mathrm{f}}\\exp\\!\\left(-\\frac{E_{\\mathrm{f}}}{R\\,T}\\right)\n   $$\n2. 计算总弛豫速率 $k_{\\mathrm{tot}}(T) = k_{\\mathrm{b}}(T) + k_{\\mathrm{f}}(T)$。\n3. 对于每个指定的时间 $t$（从皮秒转换为秒，$1 \\ \\mathrm{ps} = 10^{-12} \\ \\mathrm{s}$），计算自相关值 $C(t) = \\exp(-k_{\\mathrm{tot}}(T) \\cdot t)$。\n4. 对所有指定的温度和时间重复以上步骤。提供的常数为：\n- $R = 8.314462618 \\ \\mathrm{J\\,mol^{-1}\\,K^{-1}}$。\n- $A_{\\mathrm{b}} = 2.0 \\times 10^{12} \\ \\mathrm{s^{-1}}$。\n- $A_{\\mathrm{f}} = 1.0 \\times 10^{12} \\ \\mathrm{s^{-1}}$。\n- $E_{\\mathrm{b}} = 1.10 \\times 10^{4} \\ \\mathrm{J\\,mol^{-1}}$。\n- $E_{\\mathrm{f}} = 4.00 \\times 10^{3} \\ \\mathrm{J\\,mol^{-1}}$。\n将实施此程序以生成所需的数值结果。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of calculating the hydrogen bond lifetime autocorrelation function\n    for a two-state model at different temperatures and times.\n    \"\"\"\n\n    # Physical constants and model parameters\n    R = 8.314462618  # Universal gas constant in J mol^-1 K^-1\n    A_b = 2.0e12  # Breaking attempt frequency in s^-1\n    A_f = 1.0e12  # Formation attempt frequency in s^-1\n    E_b = 1.10e4  # Breaking activation energy in J mol^-1\n    E_f = 4.00e3  # Formation activation energy in J mol^-1\n    \n    # Conversion factor from picoseconds to seconds\n    PS_TO_S = 1e-12\n\n    # Test suite definition\n    test_cases = [\n        {'T': 273.0, 'times_ps': [0.0, 1.0, 2.0, 5.0, 10.0]},\n        {'T': 373.0, 'times_ps': [0.0, 1.0, 2.0, 5.0, 10.0]}\n    ]\n\n    # This list will hold the lists of results for each temperature\n    all_results = []\n\n    for case in test_cases:\n        T = case['T']\n        times_ps = case['times_ps']\n        \n        # Calculate Arrhenius rates for the given temperature\n        # k(T) = A * exp(-E / (R * T))\n        k_b = A_b * np.exp(-E_b / (R * T))\n        k_f = A_f * np.exp(-E_f / (R * T))\n        \n        # The decay rate of the autocorrelation function is the sum of the rates\n        k_tot = k_b + k_f\n        \n        # This list will hold results for the current temperature\n        temp_results = []\n        for t_ps in times_ps:\n            # Convert time from picoseconds to seconds\n            t_s = t_ps * PS_TO_S\n            \n            # Calculate the normalized autocorrelation function C(t) = exp(-k_tot * t)\n            c_t = np.exp(-k_tot * t_s)\n            \n            # Append the result to the list for the current temperature\n            temp_results.append(c_t)\n            \n        all_results.append(temp_results)\n\n    # Format the output string precisely as required: a nested list of lists\n    # represented as a string, with values rounded to six decimal places,\n    # and no spaces around commas.\n    # e.g., \"[[val1,val2,...],[val3,val4,...]]\"\n    \n    # outer_parts will hold the string representations of the inner lists\n    outer_parts = []\n    for inner_list in all_results:\n        # inner_parts will hold the formatted string representation of each number\n        inner_parts = [f\"{val:.6f}\" for val in inner_list]\n        \n        # Join the numbers with commas and enclose in brackets\n        # e.g., \"[1.000000,0.829100,...]\"\n        outer_parts.append(f\"[{','.join(inner_parts)}]\")\n\n    # Join the string representations of inner lists with a comma\n    # and enclose in brackets for the final nested list string.\n    # e.g., \"[[...],[...]]\"\n    final_output_string = f\"[{','.join(outer_parts)}]\"\n    \n    print(final_output_string)\n\nsolve()\n\n```", "id": "2456451"}, {"introduction": "将理论应用于实际是计算化学的魅力所在，尤其是在药物设计领域。本练习 [@problem_id:2456497] 模拟了一个真实的药物研发场景，你需要根据分子动力学模拟得到的数据，为几种候选药物分子构建一个氢键“评分函数”。通过综合评估氢键的几何构型、静电强度和存在时间，你将学会如何定量比较不同分子与靶点蛋白的结合能力，这是合理药物设计中的关键一步。", "problem": "一个制药团队对三种与同一蛋白质口袋结合的候选药物（标记为 $L1$、$L2$ 和 $L3$）进行了一次简短的分子动力学 (MD) 模拟。对于每个配体，模拟揭示了其与蛋白质之间存在两个持久的氢键。每种候选药物的时间平均氢键可观测量列于下方。每个氢键的报告包括平均氢-受体距离 $r$（纳米）、供体-氢-受体角度 $\\theta$（度）、氢键占有率 $f$（氢键存在的帧数所占的比例），以及氢供体原子 $q_H$ 和受体原子 $q_A$ 上的部分电荷（以基本电荷单位计）。蛋白质内部使用相对介电常数 $\\varepsilon_r$ 进行建模。测量得到以下数据：\n- 所有候选药物的通用常数：$\\varepsilon_r = 4.0$，理想氢-受体距离 $r_0 = 0.19 \\ \\mathrm{nm}$，理想角度 $\\theta_0 = 180^\\circ$，距离谐波常数 $k_r = 150 \\ \\mathrm{kJ \\ mol^{-1} \\ nm^{-2}}$，角度谐波常数 $k_\\theta = 0.02 \\ \\mathrm{kJ \\ mol^{-1} \\ deg^{-2}}$。使用分子力学库仑前置因子 $k_e = 138.94 \\ \\mathrm{kJ \\ mol^{-1} \\ nm \\ e^{-2}}$。\n- $L1$:\n  - 氢键 1：$f = 0.75$, $r = 0.195 \\ \\mathrm{nm}$, $\\theta = 170^\\circ$, $q_H = +0.30 \\ e$, $q_A = -0.50 \\ e$。\n  - 氢键 2：$f = 0.40$, $r = 0.220 \\ \\mathrm{nm}$, $\\theta = 155^\\circ$, $q_H = +0.25 \\ e$, $q_A = -0.45 \\ e$。\n- $L2$:\n  - 氢键 1：$f = 0.60$, $r = 0.185 \\ \\mathrm{nm}$, $\\theta = 177^\\circ$, $q_H = +0.33 \\ e$, $q_A = -0.50 \\ e$。\n  - 氢键 2：$f = 0.50$, $r = 0.240 \\ \\mathrm{nm}$, $\\theta = 150^\\circ$, $q_H = +0.20 \\ e$, $q_A = -0.40 \\ e$。\n- $L3$:\n  - 氢键 1：$f = 0.90$, $r = 0.205 \\ \\mathrm{nm}$, $\\theta = 165^\\circ$, $q_H = +0.28 \\ e$, $q_A = -0.48 \\ e$。\n  - 氢键 2：$f = 0.20$, $r = 0.180 \\ \\mathrm{nm}$, $\\theta = 180^\\circ$, $q_H = +0.35 \\ e$, $q_A = -0.55 \\ e$。\n\n根据适用于经典力场的首要原则，构建一个氢键评分，用于近似氢键对结合的时间平均能量贡献，并用它来根据预测的亲和力对候选药物进行排序。仅使用以下基本要素：\n- 静电学：在介电常数为 $\\varepsilon_r$ 的介质中，相距为 $r$ 的两个点电荷 $q_1$ 和 $q_2$ 之间的库仑相互作用由 $E_\\text{Coul} = \\dfrac{k_e}{\\varepsilon_r}\\dfrac{q_1 q_2}{r}$ 给出，其中 $k_e$ 如上所述。\n- 几何依赖性：在理想几何构型附近，偏离所产生的能量惩罚可以很好地用偏离理想值的位移的二次（谐波）项来近似。使用提供的理想值 $r_0$ 和 $\\theta_0$ 以及给定的谐波常数来量化距离和角度的能量惩罚。\n- 时间平均：将每个氢键的时间平均贡献近似为占有率 $f$ 乘以在时间平均几何构型下评估的能量估算值。\n\n假设氢键的贡献是可加的，并且在其他条件相同的情况下，更负的总分对应于更强的净氢键贡献和更高的亲和力。基于以上假设和数据，哪个候选药物的总氢键评分最有利（最负）？\n\nA. $L1$\n\nB. $L2$\n\nC. $L3$\n\nD. 在给定模型中它们无法区分（平局）", "solution": "我们首先对问题陈述进行严格验证。该练习描述了一种使用简化的分子力学模型对蛋白质-配体氢键进行评分的方法。在尝试任何解答之前，需要对给定的数据、定义和约束条件进行初步审查，以确立其科学和逻辑上的完整性。\n\n问题提供了以下内容：\n- 三个配体，$L1$、$L2$ 和 $L3$，每个配体形成两个氢键。\n- 每个氢键的时间平均几何参数：氢-受体距离 $r$ 和供体-氢-受体角度 $\\theta$。\n- 每个氢键的占有率 $f$。\n- 氢和受体原子的部分电荷 $q_H$ 和 $q_A$。\n- 一组通用常数：相对介电常数 $\\varepsilon_r = 4.0$，理想几何参数 $r_0 = 0.19 \\ \\mathrm{nm}$ 和 $\\theta_0 = 180^\\circ$，距离的谐波力常数 $k_r = 150 \\ \\mathrm{kJ \\ mol^{-1} \\ nm^{-2}}$ 和角度的谐波力常数 $k_\\theta = 0.02 \\ \\mathrm{kJ \\ mol^{-1} \\ deg^{-2}}$，以及库仑前置因子 $k_e = 138.94 \\ \\mathrm{kJ \\ mol^{-1} \\ nm \\ e^{-2}}$。\n- 一个明确的构建评分函数的方案，该函数基于静电学的库仑定律和几何惩罚的谐波势，并由占有率加权。\n- 一个找出总分最负（最有利）的配体的指令。\n\n问题的提法具有科学依据。使用一个简化的、可加的、包含静电项和谐波项的能量函数，是分子力学力场中的标准近似方法。物理常数、电荷和几何参数的值都在此类系统的实际范围内。这个问题提法恰当；它提供了所有必要的信息和一个清晰、明确的目标。它没有违反任何物理或化学的基本原理，也没有包含内部矛盾。因此，该问题被认为是**有效的**。我们可以开始进行推导。\n\n该问题要求为每个配体构建一个氢键评分 $S$。对于一个给定的配体，其总分 $S_{\\text{total}}$ 是其两个独立氢键评分的总和。\n$$S_{\\text{total}} = S_{\\text{bond},1} + S_{\\text{bond},2}$$\n\n根据问题陈述，单个氢键的评分 $S_{\\text{bond}}$ 是其占有率 $f$ 与在时间平均几何构型下计算的能量 $E_{\\text{bond}}$ 的乘积。\n$$S_{\\text{bond}} = f \\cdot E_{\\text{bond}}$$\n\n能量 $E_{\\text{bond}}$ 由静电贡献和几何惩罚项组成。\n$$E_{\\text{bond}} = E_{\\text{Coul}} + E_{r} + E_{\\theta}$$\n\n各个能量项定义如下：\n1.  氢和受体点电荷之间的静电能量（$E_{\\text{Coul}}$）：\n    $$E_{\\text{Coul}} = \\frac{k_e}{\\varepsilon_r}\\frac{q_H q_A}{r}$$\n2.  键长 $r$ 偏离理想距离 $r_0$ 的谐波惩罚：\n    $$E_r = k_r (r - r_0)^2$$\n3.  键角 $\\theta$ 偏离理想角度 $\\theta_0$ 的谐波惩罚：\n    $$E_\\theta = k_\\theta (\\theta - \\theta_0)^2$$\n\n综合这些，单个氢键的评分为：\n$$S_{\\text{bond}} = f \\left[ \\frac{k_e}{\\varepsilon_r}\\frac{q_H q_A}{r} + k_r (r - r_0)^2 + k_\\theta (\\theta - \\theta_0)^2 \\right]$$\n\n现在我们使用所提供的数据，将此公式应用于每个配体的每个氢键。单位将是 $\\mathrm{kJ \\ mol^{-1}}$。\n库仑项的常数前置因子是 $\\frac{k_e}{\\varepsilon_r} = \\frac{138.94}{4.0} = 34.735 \\ \\mathrm{kJ \\ mol^{-1} \\ nm \\ e^{-2}}$。\n\n**候选药物 $L1$**\n- 氢键 1：$f=0.75$, $r=0.195 \\ \\mathrm{nm}$, $\\theta=170^\\circ$, $q_H=0.30 \\ e$, $q_A=-0.50 \\ e$。\n  $S_1 = 0.75 \\left[ 34.735 \\frac{(0.30)(-0.50)}{0.195} + 150(0.195 - 0.19)^2 + 0.02(170 - 180)^2 \\right]$\n  $S_1 = 0.75 \\left[ -26.7192 + 150(0.005)^2 + 0.02(-10)^2 \\right]$\n  $S_1 = 0.75 \\left[ -26.7192 + 0.00375 + 2.0 \\right] = 0.75(-24.7155) \\approx -18.537 \\ \\mathrm{kJ \\ mol^{-1}}$\n- 氢键 2：$f=0.40$, $r=0.220 \\ \\mathrm{nm}$, $\\theta=155^\\circ$, $q_H=0.25 \\ e$, $q_A=-0.45 \\ e$。\n  $S_2 = 0.40 \\left[ 34.735 \\frac{(0.25)(-0.45)}{0.220} + 150(0.220 - 0.19)^2 + 0.02(155 - 180)^2 \\right]$\n  $S_2 = 0.40 \\left[ -17.7472 + 150(0.03)^2 + 0.02(-25)^2 \\right]$\n  $S_2 = 0.40 \\left[ -17.7472 + 0.135 + 12.5 \\right] = 0.40(-5.1122) \\approx -2.045 \\ \\mathrm{kJ \\ mol^{-1}}$\n- $L1$ 的总分：$S_{L1} = -18.537 - 2.045 = -20.582 \\ \\mathrm{kJ \\ mol^{-1}}$。\n\n**候选药物 $L2$**\n- 氢键 1：$f=0.60$, $r=0.185 \\ \\mathrm{nm}$, $\\theta=177^\\circ$, $q_H=0.33 \\ e$, $q_A=-0.50 \\ e$。\n  $S_1 = 0.60 \\left[ 34.735 \\frac{(0.33)(-0.50)}{0.185} + 150(0.185 - 0.19)^2 + 0.02(177 - 180)^2 \\right]$\n  $S_1 = 0.60 \\left[ -30.9850 + 150(-0.005)^2 + 0.02(-3)^2 \\right]$\n  $S_1 = 0.60 \\left[ -30.9850 + 0.00375 + 0.18 \\right] = 0.60(-30.80125) \\approx -18.481 \\ \\mathrm{kJ \\ mol^{-1}}$\n- 氢键 2：$f=0.50$, $r=0.240 \\ \\mathrm{nm}$, $\\theta=150^\\circ$, $q_H=0.20 \\ e$, $q_A=-0.40 \\ e$。\n  $S_2 = 0.50 \\left[ 34.735 \\frac{(0.20)(-0.40)}{0.240} + 150(0.240 - 0.19)^2 + 0.02(150 - 180)^2 \\right]$\n  $S_2 = 0.50 \\left[ -11.5783 + 150(0.05)^2 + 0.02(-30)^2 \\right]$\n  $S_2 = 0.50 \\left[ -11.5783 + 0.375 + 18.0 \\right] = 0.50(6.7967) \\approx +3.398 \\ \\mathrm{kJ \\ mol^{-1}}$\n- $L2$ 的总分：$S_{L2} = -18.481 + 3.398 = -15.083 \\ \\mathrm{kJ \\ mol^{-1}}$。\n\n**候选药物 $L3$**\n- 氢键 1：$f=0.90$, $r=0.205 \\ \\mathrm{nm}$, $\\theta=165^\\circ$, $q_H=0.28 \\ e$, $q_A=-0.48 \\ e$。\n  $S_1 = 0.90 \\left[ 34.735 \\frac{(0.28)(-0.48)}{0.205} + 150(0.205 - 0.19)^2 + 0.02(165 - 180)^2 \\right]$\n  $S_1 = 0.90 \\left[ -22.7592 + 150(0.015)^2 + 0.02(-15)^2 \\right]$\n  $S_1 = 0.90 \\left[ -22.7592 + 0.03375 + 4.5 \\right] = 0.90(-18.22545) \\approx -16.403 \\ \\mathrm{kJ \\ mol^{-1}}$\n- 氢键 2：$f=0.20$, $r=0.180 \\ \\mathrm{nm}$, $\\theta=180^\\circ$, $q_H=0.35 \\ e$, $q_A=-0.55 \\ e$。\n  $S_2 = 0.20 \\left[ 34.735 \\frac{(0.35)(-0.55)}{0.180} + 150(0.180 - 0.19)^2 + 0.02(180 - 180)^2 \\right]$\n  $S_2 = 0.20 \\left[ -37.1618 + 150(-0.01)^2 + 0.02(0)^2 \\right]$\n  $S_2 = 0.20 \\left[ -37.1618 + 0.015 + 0 \\right] = 0.20(-37.1468) \\approx -7.429 \\ \\mathrm{kJ \\ mol^{-1}}$\n- $L3$ 的总分：$S_{L3} = -16.403 - 7.429 = -23.832 \\ \\mathrm{kJ \\ mol^{-1}}$。\n\n总分总结：\n$S_{L1} = -20.582 \\ \\mathrm{kJ \\ mol^{-1}}$\n$S_{L2} = -15.083 \\ \\mathrm{kJ \\ mol^{-1}}$\n$S_{L3} = -23.832 \\ \\mathrm{kJ \\ mol^{-1}}$\n\n更负的分数表示更强的净氢键贡献。比较总分，我们得到的有利顺序为：$S_{L3}  S_{L1}  S_{L2}$。因此，配体 $L3$ 的分数最有利。\n\n现在我们评估所提供的选项。\n\nA. $L1$：计算得出 $L1$ 的评分为 $S_{L1} = -20.582 \\ \\mathrm{kJ \\ mol^{-1}}$。虽然这是一个有利的分数，但它没有 $L3$ 的分数（$-23.832 \\ \\mathrm{kJ \\ mol^{-1}}$）那么负。因此，$L1$ 不是分数最有利的候选药物。**不正确**。\n\nB. $L2$：计算得出 $L2$ 的评分为 $S_{L2} = -15.083 \\ \\mathrm{kJ \\ mol^{-1}}$。这是三个候选药物中负值最小，因此最不利的分数。这主要是由于第二个氢键，它具有很大的几何惩罚，并导致一个净的正（去稳定）贡献。**不正确**。\n\nC. $L3$：计算得出 $L3$ 的评分为 $S_{L3} = -23.832 \\ \\mathrm{kJ \\ mol^{-1}}$。这是三个候选药物中最负的分数，表明根据指定模型预测的氢键相互作用最强。**正确**。\n\nD. 在给定模型中它们无法区分（平局）：计算出的分数明显不同：$-20.582$、$-15.083$ 和 $-23.832 \\ \\mathrm{kJ \\ mol^{-1}}$。在这种模型的背景下，这些差异是显著的。不存在平局。因此，这个说法是错误的。**不正确**。\n\n分析明确地指出，$L3$ 是具有最有利氢键评分的候选药物。", "answer": "$$\\boxed{C}$$", "id": "2456497"}]}