{"hands_on_practices": [{"introduction": "理论与实践的结合始于最简单的模型。本练习将引导你对一个双原子分子进行坐标变换，从笛卡尔坐标系转换到质心坐标和相对坐标系[@problem_id:2452024]。这个基本推导将清晰地展示动能如何分解为分子的整体平动能和内部运动能，并自然地引出“折合质量”$\\mu$这一核心概念。", "problem": "考虑一个双原子分子，它由两个质量分别为 $m_1$ 和 $m_2$ 的原子组成，其笛卡尔坐标位置为 $\\mathbf{r}_1, \\mathbf{r}_2 \\in \\mathbb{R}^3$。令总质量为 $M = m_1 + m_2$。通过基本关系 $\\mathbf{R}_{\\mathrm{cm}} = (m_1 \\mathbf{r}_1 + m_2 \\mathbf{r}_2)/M$ 和 $\\mathbf{r} = \\mathbf{r}_2 - \\mathbf{r}_1$ 定义质心 (COM) 位置矢量 $\\mathbf{R}_{\\mathrm{cm}}$ 和相对位置矢量 $\\mathbf{r}$。在笛卡尔坐标系中，经典动能为 $T = \\tfrac{1}{2} m_1 |\\dot{\\mathbf{r}}_1|^2 + \\tfrac{1}{2} m_2 |\\dot{\\mathbf{r}}_2|^2$。\n\n仅使用这些定义和 $T$ 的表达式，在三维空间中完成以下任务：\n1. 推导从笛卡尔坐标 $(\\mathbf{r}_1, \\mathbf{r}_2)$ 到坐标 $(\\mathbf{R}_{\\mathrm{cm}}, \\mathbf{r})$ 的线性变换及其逆变换。\n2. 计算从 $(\\mathbf{r}_1, \\mathbf{r}_2)$ 到 $(\\mathbf{R}_{\\mathrm{cm}}, \\mathbf{r})$ 变换的雅可比行列式 $J$ 的绝对值。\n3. 用 $\\dot{\\mathbf{R}}_{\\mathrm{cm}}$ 和 $\\dot{\\mathbf{r}}$ 改写 $T$，并由此确定与核间距 $R = |\\mathbf{r}|$ 相关的有效质量。解释这如何与双原子内坐标表示 (Z-matrix) 相关联（其中唯一的内坐标是键长 $R$），并说明相应的键伸缩的质量加权内坐标。\n\n您最终报告的量必须是雅可比行列式 $J$。将 $J$ 表示为一个无量纲数。无需四舍五入，最终答案中不包含单位。", "solution": "在尝试任何解答之前，需要对问题陈述进行验证。\n\n步骤1：提取已知条件\n- 两个质量分别为 $m_1$ 和 $m_2$ 的原子。\n- 笛卡尔坐标位置矢量 $\\mathbf{r}_1, \\mathbf{r}_2 \\in \\mathbb{R}^3$。\n- 总质量: $M = m_1 + m_2$。\n- 质心位置矢量: $\\mathbf{R}_{\\mathrm{cm}} = (m_1 \\mathbf{r}_1 + m_2 \\mathbf{r}_2)/M$。\n- 相对位置矢量: $\\mathbf{r} = \\mathbf{r}_2 - \\mathbf{r}_1$。\n- 笛卡尔坐标系中的经典动能: $T = \\tfrac{1}{2} m_1 |\\dot{\\mathbf{r}}_1|^2 + \\tfrac{1}{2} m_2 |\\dot{\\mathbf{r}}_2|^2$。\n- 任务：\n  1. 推导从笛卡尔坐标 $(\\mathbf{r}_1, \\mathbf{r}_2)$ 到坐标 $(\\mathbf{R}_{\\mathrm{cm}}, \\mathbf{r})$ 的线性变换及其逆变换。\n  2. 计算从 $(\\mathbf{r}_1, \\mathbf{r}_2)$ 到 $(\\mathbf{R}_{\\mathrm{cm}}, \\mathbf{r})$ 变换的雅可比行列式 $J$ 的绝对值。\n  3. 用 $\\dot{\\mathbf{R}}_{\\mathrm{cm}}$ 和 $\\dot{\\mathbf{r}}$ 改写 $T$，确定核间距 $R = |\\mathbf{r}|$ 的有效质量，将其与 Z-matrix 联系起来，并说明键伸缩的质量加权内坐标。\n- 最终报告量：雅可比行列式 $J$。\n\n步骤2：使用提取的已知条件进行验证\n该问题具有科学依据，是良构且客观的。这是经典力学和计算化学中的一个标准练习，基于坐标变换和二体问题的基本原理。所有定义都是标准和精确的。问题是自洽的，没有矛盾、歧义或事实错误。它与指定主题直接相关。满足一个有效问题的所有标准。\n\n步骤3：结论与行动\n该问题被认为是**有效的**。将提供解答。\n\n该问题要求基于所提供的定义对几个量进行系统推导。我们将按顺序处理每个部分。\n\n第1部分：变换及其逆变换\n从笛卡尔坐标 $(\\mathbf{r}_1, \\mathbf{r}_2)$ 到质心和相对坐标 $(\\mathbf{R}_{\\mathrm{cm}}, \\mathbf{r})$ 的变换由以下线性矢量方程组给出：\n$$ \\mathbf{R}_{\\mathrm{cm}} = \\frac{m_1}{M} \\mathbf{r}_1 + \\frac{m_2}{M} \\mathbf{r}_2 $$\n$$ \\mathbf{r} = -\\mathbf{r}_1 + \\mathbf{r}_2 $$\n为了求逆变换，我们必须解此方程组得到 $\\mathbf{r}_1$ 和 $\\mathbf{r}_2$。从第二个方程，我们将 $\\mathbf{r}_2$ 用 $\\mathbf{r}_1$ 和 $\\mathbf{r}$ 表示：\n$$ \\mathbf{r}_2 = \\mathbf{r}_1 + \\mathbf{r} $$\n将此代入 $\\mathbf{R}_{\\mathrm{cm}}$ 的第一个方程：\n$$ \\mathbf{R}_{\\mathrm{cm}} = \\frac{m_1 \\mathbf{r}_1 + m_2 (\\mathbf{r}_1 + \\mathbf{r})}{M} = \\frac{(m_1 + m_2) \\mathbf{r}_1 + m_2 \\mathbf{r}}{M} = \\frac{M \\mathbf{r}_1 + m_2 \\mathbf{r}}{M} = \\mathbf{r}_1 + \\frac{m_2}{M} \\mathbf{r} $$\n解出 $\\mathbf{r}_1$ 可得：\n$$ \\mathbf{r}_1 = \\mathbf{R}_{\\mathrm{cm}} - \\frac{m_2}{M} \\mathbf{r} $$\n现在，将 $\\mathbf{r}_1$ 的这个表达式代回 $\\mathbf{r}_2$ 的方程中：\n$$ \\mathbf{r}_2 = \\left(\\mathbf{R}_{\\mathrm{cm}} - \\frac{m_2}{M} \\mathbf{r}\\right) + \\mathbf{r} = \\mathbf{R}_{\\mathrm{cm}} + \\left(1 - \\frac{m_2}{M}\\right) \\mathbf{r} = \\mathbf{R}_{\\mathrm{cm}} + \\left(\\frac{M - m_2}{M}\\right) \\mathbf{r} $$\n因为 $M = m_1 + m_2$，所以有 $M - m_2 = m_1$。因此，\n$$ \\mathbf{r}_2 = \\mathbf{R}_{\\mathrm{cm}} + \\frac{m_1}{M} \\mathbf{r} $$\n所以逆变换为：\n$$ \\mathbf{r}_1 = \\mathbf{R}_{\\mathrm{cm}} - \\frac{m_2}{m_1+m_2} \\mathbf{r} $$\n$$ \\mathbf{r}_2 = \\mathbf{R}_{\\mathrm{cm}} + \\frac{m_1}{m_1+m_2} \\mathbf{r} $$\n\n第2部分：雅可比行列式\n该变换是在构成 $(\\mathbf{r}_1, \\mathbf{r}_2)$ 的6个标量坐标集 $(x_1, y_1, z_1, x_2, y_2, z_2)$ 与构成 $(\\mathbf{R}_{\\mathrm{cm}}, \\mathbf{r})$ 的坐标集 $(X_{\\mathrm{cm}}, Y_{\\mathrm{cm}}, Z_{\\mathrm{cm}}, x, y, z)$ 之间进行的。雅可比矩阵 $\\mathbf{J}$ 由偏导数矩阵 $\\frac{\\partial(\\mathbf{R}_{\\mathrm{cm}}, \\mathbf{r})}{\\partial(\\mathbf{r}_1, \\mathbf{r}_2)}$ 给出。由于线性变换是按分量进行的，我们可以用 $3 \\times 3$ 的分块矩阵来分析它。雅可比矩阵为：\n$$ \\mathbf{J} = \\begin{pmatrix} \\frac{\\partial \\mathbf{R}_{\\mathrm{cm}}}{\\partial \\mathbf{r}_1}  \\frac{\\partial \\mathbf{R}_{\\mathrm{cm}}}{\\partial \\mathbf{r}_2} \\\\ \\frac{\\partial \\mathbf{r}}{\\partial \\mathbf{r}_1}  \\frac{\\partial \\mathbf{r}}{\\partial \\mathbf{r}_2} \\end{pmatrix} $$\n根据正变换的定义方程：\n$$ \\frac{\\partial \\mathbf{R}_{\\mathrm{cm}}}{\\partial \\mathbf{r}_1} = \\frac{m_1}{M} \\mathbf{I}_3 \\quad , \\quad \\frac{\\partial \\mathbf{R}_{\\mathrm{cm}}}{\\partial \\mathbf{r}_2} = \\frac{m_2}{M} \\mathbf{I}_3 $$\n$$ \\frac{\\partial \\mathbf{r}}{\\partial \\mathbf{r}_1} = -\\mathbf{I}_3 \\quad , \\quad \\frac{\\partial \\mathbf{r}}{\\partial \\mathbf{r}_2} = \\mathbf{I}_3 $$\n其中 $\\mathbf{I}_3$ 是 $3 \\times 3$ 的单位矩阵。这个 $6 \\times 6$ 的雅可比矩阵是：\n$$ \\mathbf{J} = \\begin{pmatrix} \\frac{m_1}{M} \\mathbf{I}_3  \\frac{m_2}{M} \\mathbf{I}_3 \\\\ -\\mathbf{I}_3  \\mathbf{I}_3 \\end{pmatrix} $$\n计算逆变换的雅可比行列式 $\\mathbf{J}^{-1} = \\frac{\\partial(\\mathbf{r}_1, \\mathbf{r}_2)}{\\partial(\\mathbf{R}_{\\mathrm{cm}}, \\mathbf{r})}$ 会更简单，然后使用恒等式 $\\det(\\mathbf{J}) = (\\det(\\mathbf{J}^{-1}))^{-1}$。根据逆变换方程：\n$$ \\frac{\\partial \\mathbf{r}_1}{\\partial \\mathbf{R}_{\\mathrm{cm}}} = \\mathbf{I}_3 \\quad , \\quad \\frac{\\partial \\mathbf{r}_1}{\\partial \\mathbf{r}} = -\\frac{m_2}{M} \\mathbf{I}_3 $$\n$$ \\frac{\\partial \\mathbf{r}_2}{\\partial \\mathbf{R}_{\\mathrm{cm}}} = \\mathbf{I}_3 \\quad , \\quad \\frac{\\partial \\mathbf{r}_2}{\\partial \\mathbf{r}} = \\frac{m_1}{M} \\mathbf{I}_3 $$\n所以逆变换的雅可比矩阵是：\n$$ \\mathbf{J}^{-1} = \\begin{pmatrix} \\mathbf{I}_3  -\\frac{m_2}{M} \\mathbf{I}_3 \\\\ \\mathbf{I}_3  \\frac{m_1}{M} \\mathbf{I}_3 \\end{pmatrix} $$\n使用分块矩阵的行列式公式 $\\det \\begin{pmatrix} A  B \\\\ C  D \\end{pmatrix} = \\det(A) \\det(D - CA^{-1}B)$，其中 $A = \\mathbf{I}_3, B = -\\frac{m_2}{M} \\mathbf{I}_3, C = \\mathbf{I}_3, D = \\frac{m_1}{M} \\mathbf{I}_3$：\n$$ \\det(\\mathbf{J}^{-1}) = \\det(\\mathbf{I}_3) \\det\\left(\\frac{m_1}{M} \\mathbf{I}_3 - (\\mathbf{I}_3)(\\mathbf{I}_3)^{-1}(-\\frac{m_2}{M}\\mathbf{I}_3)\\right) $$\n$$ \\det(\\mathbf{J}^{-1}) = 1 \\cdot \\det\\left(\\frac{m_1}{M} \\mathbf{I}_3 + \\frac{m_2}{M}\\mathbf{I}_3\\right) = \\det\\left(\\frac{m_1+m_2}{M}\\mathbf{I}_3\\right) = \\det\\left(\\frac{M}{M}\\mathbf{I}_3\\right) = \\det(\\mathbf{I}_3) = 1 $$\n逆变换的雅可比行列式为 $1$。因此，正变换的雅可比行列式为 $J = \\det(\\mathbf{J}) = (\\det(\\mathbf{J}^{-1}))^{-1} = 1^{-1} = 1$。其绝对值为 $|J|=1$。\n\n第3部分：动能、折合质量和质量加权坐标\n为了用新坐标表示动能 $T$，我们将逆变换关系对时间求导：\n$$ \\dot{\\mathbf{r}}_1 = \\dot{\\mathbf{R}}_{\\mathrm{cm}} - \\frac{m_2}{M} \\dot{\\mathbf{r}} $$\n$$ \\dot{\\mathbf{r}}_2 = \\dot{\\mathbf{R}}_{\\mathrm{cm}} + \\frac{m_1}{M} \\dot{\\mathbf{r}} $$\n将这些代入 $T$ 的表达式中：\n$$ T = \\frac{1}{2} m_1 \\left| \\dot{\\mathbf{R}}_{\\mathrm{cm}} - \\frac{m_2}{M} \\dot{\\mathbf{r}} \\right|^2 + \\frac{1}{2} m_2 \\left| \\dot{\\mathbf{R}}_{\\mathrm{cm}} + \\frac{m_1}{M} \\dot{\\mathbf{r}} \\right|^2 $$\n展开范数的平方（点积）：\n$$ T = \\frac{1}{2} m_1 \\left( |\\dot{\\mathbf{R}}_{\\mathrm{cm}}|^2 - 2\\frac{m_2}{M}(\\dot{\\mathbf{R}}_{\\mathrm{cm}} \\cdot \\dot{\\mathbf{r}}) + \\frac{m_2^2}{M^2}|\\dot{\\mathbf{r}}|^2 \\right) + \\frac{1}{2} m_2 \\left( |\\dot{\\mathbf{R}}_{\\mathrm{cm}}|^2 + 2\\frac{m_1}{M}(\\dot{\\mathbf{R}}_{\\mathrm{cm}} \\cdot \\dot{\\mathbf{r}}) + \\frac{m_1^2}{M^2}|\\dot{\\mathbf{r}}|^2 \\right) $$\n按速度类型对各项进行分组：\n$|\\dot{\\mathbf{R}}_{\\mathrm{cm}}|^2$ 的项是 $\\frac{1}{2}(m_1+m_2)|\\dot{\\mathbf{R}}_{\\mathrm{cm}}|^2 = \\frac{1}{2}M|\\dot{\\mathbf{R}}_{\\mathrm{cm}}|^2$。\n$(\\dot{\\mathbf{R}}_{\\mathrm{cm}} \\cdot \\dot{\\mathbf{r}})$ 的交叉项是 $\\frac{1}{2}\\left(-2\\frac{m_1m_2}{M} + 2\\frac{m_2m_1}{M}\\right)(\\dot{\\mathbf{R}}_{\\mathrm{cm}} \\cdot \\dot{\\mathbf{r}}) = 0$。\n$|\\dot{\\mathbf{r}}|^2$ 的项是 $\\frac{1}{2} \\left( m_1 \\frac{m_2^2}{M^2} + m_2 \\frac{m_1^2}{M^2} \\right) |\\dot{\\mathbf{r}}|^2 = \\frac{1}{2} \\frac{m_1m_2(m_2+m_1)}{M^2} |\\dot{\\mathbf{r}}|^2 = \\frac{1}{2} \\frac{m_1m_2 M}{M^2} |\\dot{\\mathbf{r}}|^2 = \\frac{1}{2} \\frac{m_1m_2}{M} |\\dot{\\mathbf{r}}|^2$。\n我们定义折合质量 $\\mu$ 为 $\\mu = \\frac{m_1m_2}{m_1+m_2} = \\frac{m_1m_2}{M}$。\n动能分离成两个独立的项：\n$$ T = \\frac{1}{2}M|\\dot{\\mathbf{R}}_{\\mathrm{cm}}|^2 + \\frac{1}{2}\\mu|\\dot{\\mathbf{r}}|^2 $$\n第一项是整个分子作为位于质心的质量为 $M$ 的质点的平动动能。第二项是由相对矢量 $\\mathbf{r}$ 描述的内部运动的动能。与此内部运动相关的质量是折合质量 $\\mu$。因此，$\\mu$ 是与核间距 $R=|\\mathbf{r}|$ 相关运动的有效质量。\n\n对于双原子分子，Z-matrix 用单一坐标即键长 $R_{12}$ 来描述其内禀几何。这恰好是我们相对矢量 $\\mathbf{r}$ 的大小 $R=|\\mathbf{r}|$。动能表达式表明，具有有效质量 $\\mu$ 的内部运动与整体平动在动力学上是解耦的。\n\n构造质量加权坐标是为了简化振动的动能表达式。对于一组普适的内坐标 $S_k$，振动动能为 $2T_{vib} = \\dot{\\mathbf{S}}^T \\mathbf{G}^{-1} \\dot{\\mathbf{S}}$。对于单一的伸缩坐标 $S_1 = R$，相应的 Wilson G-矩阵元是 $G_{11} = \\frac{1}{m_1} + \\frac{1}{m_2} = \\frac{m_1+m_2}{m_1m_2} = \\frac{1}{\\mu}$。振动动能是 $T_{vib} = \\frac{1}{2} G_{11}^{-1} (\\dot{S}_1)^2 = \\frac{1}{2}\\mu \\dot{R}^2$。定义质量加权内坐标 $\\mathcal{S}_{stretch}$，使得动能具有形式 $T_{vib} = \\frac{1}{2}\\dot{\\mathcal{S}}_{stretch}^2$。比较这两种形式，我们看到 $\\dot{\\mathcal{S}}_{stretch}^2 = \\mu \\dot{R}^2$，这意味着 $\\mathcal{S}_{stretch} = \\sqrt{\\mu}R$。\n相应的键伸缩的质量加权内坐标是 $\\sqrt{\\mu}R$。\n\n问题要求报告雅可比行列式 $J$。\n$$ J=1 $$", "answer": "$$\n\\boxed{1}\n$$", "id": "2452024"}, {"introduction": "理解不同坐标系的本质意味着要认识到它们所包含和舍弃的信息。本练习通过一个思想实验，探讨在分子动力学模拟中只记录内坐标会带来什么后果[@problem_id:2452012]。通过辨析哪些信息是不可恢复的，你将能更深刻地理解内坐标是如何精确描述分子构象，同时又是如何完全忽略分子的整体平动和转动状态的。", "problem": "你正在对一个由 $N$ 个原子组成的孤立非线性分子在真空中进行分子动力学 (MD) 模拟。在每个保存的时间点 $t_k$，你没有保存完整的笛卡尔坐标 $\\{\\mathbf{r}_i(t_k)\\}_{i=1}^N$，而是只记录了一套完整的内坐标（Z-矩阵坐标）：足以定义分子形状的所有键长 $r$、键角 $\\theta$ 和二面角 $\\phi$。你没有存储任何全局参考信息，如原点、实验室参考系的基准或任何参考原子的位置。你还精确地知道原子质量 $\\{m_i\\}_{i=1}^N$。仅基于这条内坐标轨迹，关于系统轨迹的下列哪些信息是根本无法恢复的（即不能唯一地重构），即使通过任意的后处理也无法实现？\n\nA. 内几何参数 $r(t)$、$\\theta(t)$ 和 $\\phi(t)$ 的时间序列。\n\nB. 质心位置 $\\mathbf{R}_{\\mathrm{COM}}(t)$ 在实验室参考系中的时间依赖性。\n\nC. 分子在实验室参考系中整体旋转取向的时间依赖性（例如，其主惯性轴的方向 $\\{\\hat{\\mathbf{e}}_i(t)\\}$）。\n\nD. 在每个保存的时间点 $t$，所有成对原子间距离 $d_{ij}(t)$ 的集合。\n\nE. 当力场仅依赖于原子间距离和内几何结构（例如，键合项加上作为 $d_{ij}$ 函数的非键合项），且没有外场时，孤立分子的势能 $U(t)$ 作为时间的函数。\n\n选择所有适用的选项。", "solution": "首先对问题陈述进行验证。\n\n**步骤 1：提取已知条件**\n- **系统**：一个由 $N$ 个原子组成的孤立非线性分子，处于真空中。\n- **模拟**：分子动力学 (MD)。\n- **记录数据**：在每个时间步 $t_k$，记录了一套完整的内坐标（Z-矩阵坐标）：定义分子形状的所有键长 $r$、键角 $\\theta$ 和二面角 $\\phi$。\n- **排除的数据**：完整的笛卡尔坐标 $\\{\\mathbf{r}_i(t_k)\\}_{i=1}^N$ 以及任何全局参考系信息（原点、基准、参考原子位置）。\n- **已知数据**：原子质量 $\\{m_i\\}_{i=1}^N$。\n- **问题**：确定哪些信息从给定的轨迹数据中是根本无法恢复的。\n- **势能条件**：势能 $U(t)$ 仅依赖于原子间距离和内几何结构，且不存在外场。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学依据**：该问题在经典力学和计算化学的原理框架内被正确地提出，涉及标准坐标系（笛卡尔坐标系、内坐标系）及其性质。概念是合理的。\n- **适定性**：该问题是适定的。它清楚地定义了可用信息（一套完整的内坐标和质量），并询问哪些信息不能被唯一地重构。基于坐标变换的数学性质，存在一个确定的解。\n- **客观性**：语言精确且技术性强，没有主观性。\n\n**步骤 3：结论与行动**\n问题陈述是有效的。它在科学上是合理的，自洽的，且没有歧义。将推导求解。\n\n**推导**\n\n一个 $N$ 原子分子有 $3N$ 个笛卡尔自由度，可以用实验室参考系中的原子位置向量集合 $\\{\\mathbf{r}_i \\in \\mathbb{R}^3\\}_{i=1}^N$ 来表示。对于一个非线性分子，这 $3N$ 个自由度可以分解为：\n1.  3 个平动自由度，描述质心的运动。\n2.  3 个转动自由度，描述分子在空间中的整体取向。\n3.  $3N-6$ 个内（或振动）自由度，描述分子的形状（原子的相对位置）。\n\n内坐标，例如由键长 ($r$)、键角 ($\\theta$) 和二面角 ($\\phi$) 组成的Z-矩阵，是一套 $3N-6$ 个参数，旨在精确描述内自由度。根据其数学构造，它们对于整个分子的刚性平移和旋转是不变的。\n\n问题陈述我们已知每个时间步 $t_k$ 的这套完整的 $3N-6$ 个内坐标。我们还知道原子质量 $\\{m_i\\}_{i=1}^N$。问题明确指出，没有存储任何关于实验室参考系的信息。这意味着对应于 3 个平动和 3 个转动自由度的信息已被丢弃。我们必须确定所列属性中哪些依赖于这些被丢弃的信息。\n\n**逐项分析**\n\n**A. 内几何参数 $r(t)$、$\\theta(t)$ 和 $\\phi(t)$ 的时间序列。**\n问题陈述明确说明，“你只记录了一套完整的内坐标（Z-矩阵坐标）：所有键长 $r$、键角 $\\theta$ 和二面角 $\\phi$”。这意味着这些参数的时间序列正是所给定的数据。因此，这些信息不仅是可恢复的，它就是原始数据。\n结论：**不正确**。\n\n**B. 质心位置 $\\mathbf{R}_{\\mathrm{COM}}(t)$ 在实验室参考系中的时间依赖性。**\n质心位置由实验室参考系中的绝对笛卡尔坐标定义：\n$$ \\mathbf{R}_{\\mathrm{COM}}(t) = \\frac{\\sum_{i=1}^N m_i \\mathbf{r}_i(t)}{\\sum_{i=1}^N m_i} $$\n这个量描述了分子的整体平动。根据定义，内坐标在任何平移 $\\mathbf{r}_i(t) \\to \\mathbf{r}_i(t) + \\mathbf{T}(t)$ 下都是不变的。由于所提供的数据中没有信息来固定分子在空间中的位置，因此从根本上不可能确定 $\\mathbf{R}_{\\mathrm{COM}}(t)$。任何质心轨迹都与给定的内坐标数据相符。因此，此信息是不可恢复的。\n结论：**正确**。\n\n**C. 分子在实验室参考系中整体旋转取向的时间依赖性（例如，其主惯性轴的方向 $\\{\\hat{\\mathbf{e}}_i(t)\\}$）。**\n整体旋转取向描述了分子在实验室参考系中的朝向。与平动类似，内坐标在刚性旋转下是不变的。从内坐标可以构建分子的形状，并计算相对于分子体固定坐标系的属性（例如该坐标系中的惯性张量），但无法确定此体固定坐标系相对于外部实验室参考系的方向。此信息对应于已被丢弃的 3 个转动自由度。因此，整体旋转取向是不可恢复的。\n结论：**正确**。\n\n**D. 在每个保存的时间点 $t$，所有成对原子间距离 $d_{ij}(t)$ 的集合。**\n一套完整的 $3N-6$ 个内坐标唯一地定义了分子的几何形状。从这些内坐标出发，可以通过算法为所有原子构建一组相对笛卡尔坐标，例如，将第一个原子置于原点，第二个原子置于一个轴上，第三个原子置于一个平面上。一旦在给定的时间 $t$ 知道了这些相对原子位置 $\\{\\mathbf{r}_i^{\\text{rel}}\\}$，任何成对原子间距离都可以计算为 $d_{ij}(t) = ||\\mathbf{r}_i^{\\text{rel}}(t) - \\mathbf{r}_j^{\\text{rel}}(t)||$。由于距离是标量，它们对于相对坐标系原点和方向的选择是不变的。因此，所有原子间距离都可以从内坐标中唯一地重构。\n结论：**不正确**。\n\n**E. 当力场仅依赖于原子间距离和内几何结构（例如，键合项加上作为 $d_{ij}$ 函数的非键合项），且没有外场时，孤立分子的势能 $U(t)$ 作为时间的函数。**\n问题陈述指出，势能 $U(t)$ 是内几何结构（键长、键角、二面角）和原子间距离 $d_{ij}$ 的函数。正如在选项 A 和 D 的分析中所确立的：\n- 内坐标 ($r, \\theta, \\phi$) 是直接给出的。\n- 原子间距离 ($d_{ij}$) 可以从内坐标中唯一地重构。\n由于势能仅依赖于给定的或者可以从给定数据中唯一计算出的量，因此势能 $U(t)$ 本身可以在每个时间步 $t_k$ 被唯一计算出来。因此，此信息是可恢复的。\n结论：**不正确**。\n\n总之，根本无法恢复的信息是与分子在实验室参考系中的整体平动和转动有关的信息。这些正是选项 B 和 C 中描述的量。", "answer": "$$\\boxed{BC}$$", "id": "2452012"}, {"introduction": "理论知识的最终价值在于指导实际计算。本练习将理论与计算实践中的一个常见难题联系起来：几何优化过程中的数值不稳定性[@problem_id:2452028]。你将分析一个不佳的Z矩阵定义（例如，在近乎线性的原子链上定义二面角）是如何导致变换矩阵病态，从而引发优化算法收敛缓慢甚至失败的。理解这一点对于构建稳健的分子模型和成功执行计算任务至关重要。", "problem": "在计算化学中，几何优化通常使用通过Z-矩阵定义的内坐标。在Z-矩阵中，除了最初的几个原子外，每个原子的位置都是通过指定其与第一个锚定原子的键长、与第二个锚定原子的键角以及与第三个锚定原子的二面角来确定的。考虑一个简单的原子链 $A$–$B$–$C$–$D$，在初始结构中，角度 $\\angle ABC$ 为 $179.5^\\circ$，原子 $A$、$B$ 和 $C$ 近似共线。考虑两种用于定位原子 $D$ 的Z-矩阵定义：\n- Z-定义 $\\mathcal{Z}_1$：原子 $D$ 通过其与 $C$ 的键、其在 $C$ 点的键角（即 $\\angle DCB$）以及由平面 $(A,B,C)$ 和 $(B,C,D)$ 构成的二面角来定义。\n- Z-定义 $\\mathcal{Z}_2$：原子 $D$ 通过其与 $C$ 的键、其在 $C$ 点的键角（即 $\\angle DCB$）以及由平面 $(X,C,B)$ 和 $(C,B,D)$ 构成的二面角来定义，其中 $X$ 是一个不在 $A$–$B$–$C$ 线上的非共线原子（例如， $B$ 上的一个取代基，确保没有近似线性）。\n\n假设一个标准的准牛顿几何优化，该优化使用通过坐标变换从笛卡尔量转换得到的内坐标梯度和Hessian矩阵，并可选择性地使用质量加权笛卡尔坐标 $\\mathbf{x}_m = M^{1/2}\\mathbf{x}$，其中 $M$ 是对角质量矩阵。基本假设如下：\n- 内坐标是笛卡尔坐标的函数，$q_i = q_i(\\mathbf{x})$，并且几何更新可以在内坐标空间中进行；空间之间的变换依赖于导数 $\\partial q_i/\\partial x_{a\\alpha}$，这些导数共同构成一个变换矩阵。\n- 扭转角的导数涉及归一化的平面法向量；当定义平面的三个原子变得近似共线时，定义这些法向量的叉乘的模将变得非常小。\n\n下列哪项陈述正确描述了Z-矩阵中不当的锚定原子选择如何导致几何优化中的数值不稳定性和收敛缓慢？\n\nA. 如果一个二面角是使用一个近似线性的内角（例如，$\\angle ABC \\approx 180^\\circ$）来定义的，那么平面法向量的归一化会在内坐标到笛卡尔坐标的导数中引入与 $1/\\sin\\theta$ 成正比的因子，使变换成为病态的；这可能导致微小的内坐标步长对应于不成比例的巨大笛卡尔位移（反之亦然），从而破坏线性搜索或信赖域步长的稳定性，并减慢收敛速度。\n\nB. 选择锚定原子以最小化内坐标的总数总是能提高数值稳定性，即使这会强制使用近似共线的三原子组来定义角度和二面角。\n\nC. 使用质量加权笛卡尔坐标 $\\mathbf{x}_m = M^{1/2}\\mathbf{x}$ 可以消除因锚定原子选择不当而引起的不稳定性，因为它能正则化坐标变换并消除几何奇异点。\n\nD. 选择近似共线或共面的锚定原子会降低内坐标变换的秩或有效秩，恶化内坐标Hessian矩阵和梯度变换的条件数，从而减慢准牛顿法的收敛速度。\n\nE. 不当的锚定原子选择可能导致名义上的局部内坐标产生长程耦合（例如，沿着近似共线的路径），使得改变一个二面角会拖动许多原子；信赖域或线性搜索的保护机制会因此强制采用非常小的步长以防止几何结构“崩溃”，即使在笛卡尔梯度适中的情况下也会导致收敛缓慢。\n\n选择所有适用项。", "solution": "首先必须验证问题陈述的科学合理性、清晰性和完整性。\n\n**步骤1：提取已知信息**\n- **系统**：一个原子链 $A$–$B$–$C$–$D$。\n- **初始几何构型**：角度 $\\angle ABC$ 为 $179.5^\\circ$，表明原子 $A$、$B$ 和 $C$ 近似共线。\n- **原子 $D$ 的Z-矩阵定义**：\n    - $\\mathcal{Z}_1$：与 $C$ 的键，角 $\\angle DCB$，基于平面 $(A,B,C)$ 和 $(B,C,D)$ 的二面角。\n    - $\\mathcal{Z}_2$：与 $C$ 的键，角 $\\angle DCB$，基于平面 $(X,C,B)$ 和 $(C,B,D)$ 的二面角，其中 $X$ 是一个合适的外部原子。\n- **方法论**：在内坐标中进行准牛顿几何优化。梯度和Hessian矩阵从笛卡尔空间转换而来。\n- **坐标系**：笛卡尔坐标（$\\mathbf{x}$）、内坐标（$q_i$）和质量加权笛卡尔坐标（$\\mathbf{x}_m = M^{1/2}\\mathbf{x}$）。\n- **关键原理**：\n    1. 内坐标是笛卡尔坐标的函数：$q_i = q_i(\\mathbf{x})$。\n    2. 坐标系之间的变换依赖于导数矩阵 $\\partial q_i/\\partial x_{a\\alpha}$（Wilson B-矩阵）。\n    3. 二面角的导数涉及归一化的平面法向量。\n    4. 用于定义平面的原子近似共线会导致平面法向量的叉乘的模很小。\n- **问题**：识别哪些陈述正确描述了不当的锚定原子选择（如 $\\mathcal{Z}_1$ 中）如何导致数值不稳定性和收敛缓慢。\n\n**步骤2：使用提取的信息进行验证**\n- **科学依据**：该问题基于计算化学的基本且公认的原理，特别是分子几何优化和坐标变换的理论。由不当定义的内坐标（例如，涉及近似线性原子的二面角）引起的数值不稳定性问题是该领域的经典且关键的课题。所提供的信息在事实上是正确且科学合理的。\n- **良定性**：该问题提供了一个清晰的场景，并要求基于此场景评估几个陈述。该场景是具体的，旨在探究一个已知的计算问题。可以从既定理论中确定一组唯一的正确和不正确的陈述。\n- **客观性**：该问题以精确、技术性的语言表述，没有主观性或歧义。\n\n**步骤3：结论与行动**\n该问题科学合理、良定且客观。这是一个有效的问题。我将继续提供详细的解决方案。\n\n---\n\n核心问题在于二面角的定义及其相对于笛卡尔坐标的导数计算。对于原子序列 $1-2-3-4$，二面角 $\\tau$ 是包含原子 $(1,2,3)$ 的平面与包含原子 $(2,3,4)$ 的平面之间的夹角。设原子的位置向量为 $\\mathbf{r}_1, \\mathbf{r}_2, \\mathbf{r}_3, \\mathbf{r}_4$。\n\n第一个平面的法向量是 $\\mathbf{n}_{123} = (\\mathbf{r}_2 - \\mathbf{r}_1) \\times (\\mathbf{r}_3 - \\mathbf{r}_2)$。其模为 $|\\mathbf{n}_{123}| = |\\mathbf{r}_2 - \\mathbf{r}_1||\\mathbf{r}_3 - \\mathbf{r}_2|\\sin(\\theta_{123})$，其中 $\\theta_{123}$ 是角度 $\\angle 123$。\n\n在本问题中，Z-定义 $\\mathcal{Z}_1$ 使用原子 $A, B, C$ 来定义原子 $D$ 的二面角。相关角度为 $\\theta_{ABC} = \\angle ABC \\approx 180^\\circ$。因此，$\\sin(\\theta_{ABC}) \\approx 0$，这意味着平面 $(A,B,C)$ 的法向量几乎是一个零向量。从几何上看，由三个近似共线的点定义的平面是病态定义的。原子位置的任何无穷小变化都可能导致其方向发生剧烈波动。\n\n从笛卡尔坐标 $\\mathbf{x}$ 到内坐标 $\\mathbf{q}$ 的变换由Wilson B-矩阵控制，其元素为 $B_{ik} = \\partial q_i / \\partial x_k$。二面角相对于笛卡尔坐标的导数包含与定义平面的法向量的模成反比的项。对于 $\\mathcal{Z}_1$ 中的二面角，这意味着其导数将包含与 $1/|\\mathbf{n}_{ABC}| \\propto 1/\\sin(\\theta_{ABC})$ 成正比的项。当 $\\theta_{ABC} \\to 180^\\circ$ 时，这些导数项会发散。\n\n这会导致一个病态的B-矩阵。在优化过程中，通常在内坐标中计算一个步长 $\\Delta\\mathbf{q}$，然后将其转换为笛卡尔坐标中的步长 $\\Delta\\mathbf{x}$。这种逆变换涉及B-矩阵的广义逆。一个病态的B-矩阵使得这种变换在数值上不稳定，从而导致选项中描述的问题。\n\n**逐项分析**\n\n**A. 如果一个二面角是使用一个近似线性的内角（例如，$\\angle ABC \\approx 180^\\circ$）来定义的，那么平面法向量的归一化会在内坐标到笛卡尔坐标的导数中引入与 $1/\\sin\\theta$ 成正比的因子，使变换成为病态的；这可能导致微小的内坐标步长对应于不成比例的巨大笛卡尔位移（反之亦然），从而破坏线性搜索或信赖域步长的稳定性，并减慢收敛速度。**\n该陈述精确而准确地描述了其潜在的数学问题。二面角相对于笛卡尔坐标的导数中的因子 $1/|\\mathbf{n}_{ABC}|$ 确实与 $1/\\sin(\\angle ABC)$ 成正比。当 $\\angle ABC \\to 180^\\circ$ 时，这个因子发散，导致B-矩阵的某些元素变得极大。这使得变换矩阵成为病态的，意味着其求逆（或伪逆）在数值上是不稳定的。一个病态的映射可能导致在内坐标空间中提出的一个小的、行为良好的优化步长，在笛卡尔空间中变成一个巨大的、不符合物理实际的步长。使用线性搜索或信赖域的优化算法会检测到由这样一步引起的巨大能量增加，并被迫采取极小的步长，从而导致收敛非常缓慢。该陈述是正确的。\n**A的结论：正确。**\n\n**B. 选择锚定原子以最小化内坐标的总数总是能提高数值稳定性，即使这会强制使用近似共线的三原子组来定义角度和二面角。**\n这个陈述根本上是错误的。对于一个包含 $N$ 个原子的非线性分子，内坐标的数量固定为 $3N-6$。对于线性分子，则是 $3N-5$。Z-矩阵中锚定原子的选择不会改变这个数量；它只定义了这些坐标代表什么（即哪些键、角和二面角）。选择锚定原子时的主要目标是确保坐标系的数值稳定性。强制使用近似共线的三原子组是导致数值不稳定的一个典型*错误*选择。良好的实践要求应尽力*避免*此类定义，例如通过使用虚原子或如定义 $\\mathcal{Z}_2$ 所暗示的那样，明智地选择非局域的锚定原子。该陈述的主张与事实恰恰相反。\n**B的结论：不正确。**\n\n**C. 使用质量加权笛卡尔坐标 $\\mathbf{x}_m = M^{1/2}\\mathbf{x}$ 可以消除因锚定原子选择不当而引起的不稳定性，因为它能正则化坐标变换并消除几何奇异点。**\n质量加权坐标通过将每个笛卡尔坐标分量乘以相应原子质量的平方根来进行变换。内坐标 $q_i$ 是几何构型（即笛卡尔坐标 $\\mathbf{x}$）的函数，而不是质量的函数。所讨论的奇异性纯粹是几何问题：用三个共线点定义一个平面是失败的，无论这些点上附加了什么质量。在数学上，导数 $\\partial q_i / \\partial x_k$ 因几何原因而发散。在质量加权坐标中的导数通过链式法则相关联：$\\partial q_i / \\partial x_{m,k} = (\\partial q_i / \\partial x_k) \\cdot m_k^{-1/2}$。这种乘以一个常数因子 $m_k^{-1/2}$ 的缩放操作并不能消除 $\\partial q_i / \\partial x_k$ 的发散。不稳定性依然存在。质量加权对于动力学和振动分析很有用，但它不能修复内坐标定义中的奇异点。\n**C的结论：不正确。**\n\n**D. 选择近似共线或共面的锚定原子会降低内坐标变换的秩或有效秩，恶化内坐标Hessian矩阵和梯度变换的条件数，从而减慢准牛顿法的收敛速度。**\n该陈述从线性代数的角度提供了正确的分析。B-矩阵将笛卡尔坐标的变化映射到内坐标的变化。当一个二面角由于近似共线而定义不良时，B-矩阵中相应的行在数值上会出现问题（元素值非常大）。这意味着该内坐标与其他坐标并非良好独立，或者其定义不稳定。这导致对变换至关重要的矩阵乘积 $\\mathbf{G} = \\mathbf{B}\\mathbf{B}^T$ 变得近似奇异。一个近似奇异的矩阵有一个或多个非常小的特征值，这意味着它有非常高的条件数（最大与最小特征值之比），并且其有效秩降低了。准牛顿法所需的梯度和Hessian矩阵的变换依赖于 $\\mathbf{G}$ 的逆。$\\mathbf{G}$ 的高条件数使其逆矩阵在数值上不稳定，这会破坏计算出的优化步长 $\\Delta\\mathbf{q}$ 并减慢收敛。该陈述是对该问题的一个正确且深刻的描述。\n**D的结论：正确。**\n\n**E. 不当的锚定原子选择可能导致名义上的局部内坐标产生长程耦合（例如，沿着近似共线的路径），使得改变一个二面角会拖动许多原子；信赖域或线性搜索的保护机制会因此强制采用非常小的步长以防止几何结构“崩溃”，即使在笛卡尔梯度适中的情况下也会导致收敛缓慢。**\n该陈述准确地描述了数值不稳定性的物理表现。在一个行为良好的Z-矩阵中，改变单个内坐标（如键长或键角）会导致分子几何构型的局部变化。然而，在像 $\\mathcal{Z}_1$ 这样的不良锚定原子选择下，一个定义不良的二面角 $\\tau_{ABCD}$ 的微小变化可能导致原子 $D$ 围绕 $B-C$ 轴发生非常大的旋转。如果其他原子是相对于 $D$ 定义的（例如，在原子链 $A-B-C-D-E-\\dots$ 中），$D$ 的这种大范围运动将拖动所有后续原子。这在名义上局部的内坐标与许多可能距离很远的原子的位置之间，创建了一种强烈的、人为的耦合。试图在该内坐标上迈出一小步的优化算法，将在笛卡尔几何构型中产生一个巨大的、高能量的畸变。算法的保护机制（信赖域半径或线性搜索）将正确地将此步识别为灾难性的，并将步长减小到一个极小的值。这导致朝向最小值的进展极其缓慢，即使原子上的力（即梯度）不是特别大。\n**E的结论：正确。**", "answer": "$$\\boxed{ADE}$$", "id": "2452028"}]}