{"hands_on_practices": [{"introduction": "在分析分子运动时，首要任务是正确计算其振动模式的数量。这个练习将应用非线性分子的标准公式，这是一项基本技能，可以帮助您掌握计算振动自由度的基础知识。我们将以$H_3^+$离子为例，这是一个简单但非平凡的系统，可以清晰地展示这一原理[@problem_id:2458109]。", "problem": "考虑三原子离子 $H_3^+$，其稳定构型为一个位于平面内的等边三角形，在三维空间中自由运动。对于一个由 $N$ 个点状原子核组成、位于三维空间中的分子，其构型可由 $3N$ 个独立的笛卡尔坐标来指定。振动自由度被定义为改变分子形状的独立内部坐标的数量，不包括对应于整个分子作为刚体的整体平动和整体转动的变化。请确定 $H_3^+$ 在其稳定的等边三角形构型下的振动自由度数量。请以整数形式给出最终答案。", "solution": "该问题陈述已经过严格验证，被认为是科学上合理、定义明确且客观的。它基于分子物理学和化学的既定原理，包含了所有必要信息，并且没有矛盾或含糊之处。因此，我将着手解答。\n\n问题要求解三原子离子 $H_3^+$ 的振动自由度数量。对于一个由 $N$ 个原子（视为质点）组成、位于三维空间中的分子，其总自由度数为 $3N$。这是因为每个原子的位置可以由三个独立的笛卡尔坐标（$x$、$y$、$z$）来描述。\n\n对于 $H_3^+$ 离子，原子数 $N=3$。因此，总自由度数为：\n$$N_{\\text{total}} = 3N = 3 \\times 3 = 9$$\n\n这些总自由度可以分为分子整体的三种运动类型：平动、转动和振动。\n$$N_{\\text{total}} = N_{\\text{trans}} + N_{\\text{rot}} + N_{\\text{vib}}$$\n\n平动自由度数 $N_{\\text{trans}}$ 对应于分子质心的运动。在三维空间中，总是有 $3$ 个独立的平动方向（例如，沿 $x$、$y$ 和 $z$ 轴）。因此：\n$$N_{\\text{trans}} = 3$$\n\n转动自由度数 $N_{\\text{rot}}$ 取决于分子的几何构型。\n- 对于**线性**分子，所有原子都位于一条直线上。绕此轴的转动不会改变原子核的位置，且对应的转动惯量实际上为零。因此，只有 $2$ 个转动自由度，对应于绕垂直于核间轴的两条轴的转动。\n- 对于**非线性**分子，原子不全在一条直线上。分子绕三个相互垂直的主轴具有非零的转动惯量。因此，有 $3$ 个转动自由度。\n\n问题陈述 $H_3^+$ 的稳定构型是等边三角形。等边三角形是三个原子的一种平面但非线性的排列。因此，$H_3^+$ 离子是一个非线性分子。转动自由度数为：\n$$N_{\\text{rot}} = 3$$\n\n振动自由度数 $N_{\\text{vib}}$ 代表原子之间改变分子形状（键长和键角）的内部相对运动。这个数量是在扣除平动和转动的刚体运动后剩余的部分。我们可以通过重新排列此划分方程来计算它：\n$$N_{\\text{vib}} = N_{\\text{total}} - N_{\\text{trans}} - N_{\\text{rot}}$$\n\n代入非线性分子的数值：\n$$N_{\\text{vib}} = 3N - 3 - 3 = 3N - 6$$\n\n现在，我们将此公式应用于 $H_3^+$ 离子，其中 $N=3$：\n$$N_{\\text{vib}} = 3(3) - 6 = 9 - 6 = 3$$\n\n因此，$H_3^+$ 离子拥有 $3$ 个振动自由度。这些自由度对应于对称伸缩（一种呼吸模式）和一对简并的非对称伸缩和弯曲模式。", "answer": "$$\\boxed{3}$$", "id": "2458109"}, {"introduction": "虽然计算自由度的公式（如$3N-6$或$3N-5$）看似简单，但它们背后隐藏着有趣的物理现象。本练习探讨了像二氧化碳（$\\mathrm{CO_2}$）这样的线性分子，其振动模式总数似乎超出了我们直观定义的内部坐标（两个键长和一个键角）的数量。解决这个难题将引导我们理解简并振动这一至关重要的概念，这对于光谱学和分子动力学的深入研究至关重要[@problem_id:2458083]。", "problem": "线性三原子分子，二氧化碳 $\\mathrm{CO_2}$，在其平衡几何构型中，有 $N=3$ 个原子共线排列，键角为 $\\theta_{\\mathrm{OCO}}=180^\\circ$。对于一个有 $N$ 个原子的线性分子，其振动简正模式的数量为 $3N-5$，因此 $\\mathrm{CO_2}$ 具有 $4$ 种振动模式。在标准的价键内坐标描述中，可以定义 $3$ 个内坐标：两个键长 $r_{\\mathrm{CO}}$（每个 $\\mathrm{C{-}O}$ 键各一个）和键角 $\\theta_{\\mathrm{OCO}}$。除了这 $3$ 个内坐标之外，第四种振动模式对应于何种物理运动？\n\nA. 在用于定义 $\\theta_{\\mathrm{OCO}}$ 的平面的正交平面上的第二个独立的弯曲运动；双重简并弯曲的另一个分量。\n\nB. 对应于绕分子轴扭转的扭转振动。\n\nC. 整个分子沿其分子轴的刚性平移。\n\nD. 整个分子绕其分子轴的刚性旋转。\n\nE. 第二个对称伸缩，其中两个 $\\mathrm{C-O}$ 键的长度同相变化，且独立于第一个对称伸缩。", "solution": "必须首先验证问题陈述的科学性和逻辑完整性。\n\n### 步骤 1：提取已知条件\n- 分子是二氧化碳，$\\mathrm{CO_2}$。\n- 它是一个有 $N=3$ 个原子的线性三原子分子。\n- 平衡键角为 $\\theta_{\\mathrm{OCO}}=180^\\circ$。\n- 线性分子的振动简正模式数量被陈述为 $3N-5$。\n- 对于 $\\mathrm{CO_2}$，这导致 $3(3)-5 = 4$ 种振动模式。\n- 定义了一组 $3$ 个内坐标：两个键长 $r_{\\mathrm{CO}}$（每个 $\\mathrm{C{-}O}$ 键各一个）和键角 $\\theta_{\\mathrm{OCO}}$。\n- 问题询问的是第四种振动模式对应的物理运动，而这组 $3$ 个内坐标并未包含它。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据科学合理性、适定性和客观性的标准对问题陈述进行评估。\n\n- **科学依据**：陈述在事实上是正确的。$\\mathrm{CO_2}$ 是一个线性三原子分子。线性分子的振动模式数量公式 $3N-5$ 是分子振动理论的一个基本结果。计算得出 $\\mathrm{CO_2}$ 有 $4$ 种模式是正确的。将键长和键角确定为标准内坐标也是正确的。\n- **适定性**：这个问题是适定的。它指出了简单内坐标数量（$3$）与总振动模式数量（$4$）之间的差异，并要求给出物理解释。这是分子光谱学中一个标准的、非平凡的问题。\n- **客观性**：语言精确，没有主观或含糊的术语。\n\n### 步骤 3：结论和行动\n问题陈述是有效的。它科学合理、适定且客观。因此，可以继续进行完整的推导和分析。\n\n### 解答推导\n\n一个由 $N$ 个原子组成的分子总共有 $3N$ 个自由度，对应于在空间中指定每个原子位置所需的 $3$ 个笛卡尔坐标。对于 $\\mathrm{CO_2}$，$N=3$，总共有 $3 \\times 3 = 9$ 个自由度。\n\n这些自由度被划分为整个分子的平移、旋转和振动运动。\n1.  **平移运动**：分子质心的运动。这占用了 $3$ 个自由度，对应于沿三个相互正交的轴（例如，$x, y, z$）的平移。\n2.  **旋转运动**：分子绕其质心的旋转。对于非线性分子，有 $3$ 个旋转自由度。然而，对于像 $\\mathrm{CO_2}$ 这样的线性分子，原子位于单根轴上。绕此轴的旋转不会改变任何原子核的位置，因此（在理想情况下）转动惯量为零。因此，这种运动不被视为分子旋转。一个线性分子只有 $2$ 个旋转自由度，对应于绕垂直于分子轴的两个轴的端对端旋转。\n3.  **振动运动**：剩余的自由度必须对应于内振动，其中原子相互之间相对运动，而质心保持固定且分子不旋转。因此，振动自由度（或简正模式）的数量为：\n    $$ N_{\\text{vib}} = 3N - (\\text{平移}) - (\\text{旋转}) $$\n    对于线性分子，这等于：\n    $$ N_{\\text{vib}} = 3N - 3 - 2 = 3N-5 $$\n    正如问题中正确陈述的，对于 $\\mathrm{CO_2}$ ($N=3$)，这得出 $N_{\\text{vib}} = 3(3) - 5 = 4$ 种振动模式。\n\n现在，必须分析这些模式与内坐标之间的关系。问题提供了一组 $3$ 个简单的价键内坐标：两个键长（$r_1$ 和 $r_2$）和一个键角（$\\theta_{\\mathrm{OCO}}$）。\n\n- **伸缩模式**：两个键长坐标 $r_1$ 和 $r_2$ 可以组合形成两种独立的振动简正模式：\n    - 对称伸缩（$\\nu_1$），其中两个键同相伸长和缩短。\n    - 反对称伸缩（$\\nu_3$），其中一个键伸长时另一个键缩短。\n    因此，这两个伸缩坐标占据了四个振动模式中的两个。\n\n- **弯曲模式**：键角坐标 $\\theta_{\\mathrm{OCO}}$ 描述了分子偏离其线性构型的弯曲。这个角度从 $180^\\circ$ 发生变化代表一种弯曲振动。然而，这种弯曲运动可以发生在包含分子轴的任何平面内。让我们将分子轴定义为 $z$ 轴。分子可以在 $xz$ 平面内弯曲。这个运动可以用一个坐标描述，构成一种振动模式。关键是，分子也可以在与 $xz$ 平面正交的 $yz$ 平面内弯曲。这第二个弯曲运动独立于第一个。由于线性分子的轴对称性，这两种弯曲运动在能量上是等价的。它们具有相同的振动频率，被称为**双重简并**。\n\n这组 $3$ 个简单的内坐标 ($r_1, r_2, \\theta_{\\mathrm{OCO}}$) 不足以描述完整的 $4$ 维振动运动空间。角度 $\\theta_{\\mathrm{OCO}}$ 描述了弯曲的幅度，但它没有区分 $xz$ 平面内的弯曲和 $yz$ 平面内的弯曲。为了完全指定弯曲，需要两个坐标，对应于原子位移垂直于分子轴的两个正交分量。这两个坐标产生了两种简并的弯曲模式。\n\n因此，$\\mathrm{CO_2}$ 的四种振动模式是对称伸缩、反对称伸缩和一对简并的弯曲模式。从三个指定的价键坐标的简单计数中“丢失”的“第四”种模式，是简并弯曲振动的第二个正交分量。\n\n### 逐项分析\n\n**A. 在用于定义 $\\theta_{\\mathrm{OCO}}$ 的平面的正交平面上的第二个独立的弯曲运动；双重简并弯曲的另一个分量。**\n这个陈述是完全正确的。线性分子中的弯曲振动是双重简并的，对应于两个能量相同的正交运动。单个键角 $\\theta_{\\mathrm{OCO}}$ 的标准定义只捕捉了其中一个，或者更准确地说，是它们的组合振幅。第二个独立模式是弯曲的另一个正交分量。这就解释了第四种振动模式。\n**结论：正确。**\n\n**B. 对应于绕分子轴扭转的扭转振动。**\n扭转涉及原子团绕化学键的相对旋转。在像 $\\mathrm{CO_2}$ 这样的线性分子中，所有原子都位于核间轴上。没有离轴的原子可以相互扭转。“扭转”分子绕其轴线并不会改变原子核的相对位置，因此不是一种振动。这在根本上是错误的。\n**结论：错误。**\n\n**C. 整个分子沿其分子轴的刚性平移。**\n这描述的是一个平移自由度，而不是振动自由度。振动是*内部*运动，而平移是移动整个分子的质心。这已经在 $3N-5$ 个振动模式之外单独计算过了。\n**结论：错误。**\n\n**D. 整个分子绕其分子轴的刚性旋转。**\n这描述的是一个旋转自由度。如前所述，对于线性分子，绕核间轴的旋转不是一个有效的分子旋转，因为它不会使原子核移位。在分子运动的标准模型中，这个自由度不存在。\n**结论：错误。**\n\n**E. 第二个对称伸缩，其中两个 C-O 键的长度同相变化，且独立于第一个对称伸缩。**\n对称伸缩是一个单一的、非简并的简正模式。根据定义，简正模式是原子的一种独立的、同步的运动。不可能有两个独立的对称伸缩模式。两个键伸缩坐标产生一个对称伸缩和一个反对称伸缩，仅此而已。这个陈述在术语上是自相矛盾的。\n**结论：错误。**", "answer": "$$\\boxed{A}$$", "id": "2458083"}, {"introduction": "本练习旨在连接理论与计算实践。在计算化学中，为了方便和高效，我们经常使用内坐标（如Z-矩阵）来定义分子结构，但实际的量子化学或分子力学计算最终需要笛卡尔坐标。这个编程任务将指导您完成一个基础但核心的算法：将水分子的Z-矩阵表示转换为其明确的笛卡尔坐标。通过亲手实现这个转换过程，您将把抽象的坐标定义概念转化为具体的计算技能[@problem_id:2458138]。", "problem": "编写一个完整的程序，根据一个固定的参考系约定，将一个水分子简单的内坐标规范（Z-矩阵）转换为笛卡尔坐标。该分子由三个原子组成：一个氧原子和两个氢原子。程序必须实现以下精确的数学规范，并为一组测试用例生成数值坐标。\n\n为消除全局旋转和平移自由度所采用的参考系约定：将原子 $1$ 放置在笛卡尔空间的原点 $(0,0,0)$，将原子 $2$ 放置在正 $x$ 轴上，其与原子 $1$ 的距离等于其键长，并将原子 $3$ 放置在 $xy$ 平面中，其 $y$ 坐标为非负值，以满足指定的内键角。角度应以度为单位进行解释。距离必须以埃（Ångström）为单位进行解释，最终坐标也必须以埃为单位表示。\n\n此处使用的水分子标准三原子形式的 Z-矩阵格式如下：\n- 第 $1$ 行：原子 $1$ 的标签（无参考）。\n- 第 $2$ 行：原子 $2$ 的标签，后跟参考原子的整数索引（必须为 $1$），再后跟以埃为单位的实数键长 $r_{12}$。\n- 第 $3$ 行：原子 $3$ 的标签，后跟键长参考原子的整数索引（必须为 $1$），再后跟以埃为单位的实数键长 $r_{13}$，然后是定义角度的原子的整数索引（必须为 $2$），最后是以度为单位的实数键角 $\\theta$。该角的顶点在原子 $1$ 处，即 $\\theta$ 是矢量 $\\overrightarrow{1\\to 2}$ 和 $\\overrightarrow{1\\to 3}$ 之间的夹角。\n\n在这些约定下，设笛卡尔坐标为 $\\mathbf{R}_1=(0,0,0)$, $\\mathbf{R}_2=(r_{12},0,0)$ 以及 $\\mathbf{R}_3=(x_3,y_3,0)$，其中\n$$\nx_3 = r_{13}\\cos\\left(\\theta\\frac{\\pi}{180}\\right),\\quad\ny_3 = r_{13}\\sin\\left(\\theta\\frac{\\pi}{180}\\right),\\quad\nz_3 = 0.\n$$\n所有角度都必须以度为单位进行解释，并使用因子 $\\pi/180$ 转换为弧度。\n\n你的程序必须将以下四个 Z-矩阵用例作为其测试套件进行硬编码。对于每个用例，使用上述规范计算所有三个原子的笛卡尔坐标。距离以埃为单位，角度以度为单位：\n\n- 用例 A（典型的水分子几何构型）：$r_{12}=0.9572$, $r_{13}=0.9572$, $\\theta=104.5$。\n- 用例 B（不对称键长，更大角度）：$r_{12}=1.0$, $r_{13}=0.9$, $\\theta=120.0$。\n- 用例 C（线性排列边界）：$r_{12}=1.0$, $r_{13}=1.5$, $\\theta=180.0$。\n- 用例 D（近乎折叠的角度边界）：$r_{12}=0.5$, $r_{13}=0.5$, $\\theta=0.0$。\n\n本问题中每个 Z-矩阵的输入格式由标准三原子模板固定，并且必须对应于：\n- 第 $1$ 行：O\n- 第 $2$ 行：H $1$ $r_{12}$\n- 第 $3$ 行：H $1$ $r_{13}$ $2$ $\\theta$\n\n你的程序必须：\n- 使用上述约定来确定每个用例的唯一笛卡尔坐标。\n- 所有坐标均以埃为单位表示。\n- 将每个笛卡尔分量四舍五入到 $6$ 位小数。\n- 对于每个用例，按顺序 $[x_1,y_1,z_1,x_2,y_2,z_2,x_3,y_3,z_3]$ 返回一个包含 $9$ 个实数的列表。\n\n最终输出格式：你的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表形式的结果，每个元素是按用例 A、B、C、D 的顺序排列的 $9$ 个四舍五入的笛卡尔分量列表。例如，打印的行应具有以下形式\n$[[x_1,y_1,z_1,x_2,y_2,z_2,x_3,y_3,z_3],[\\dots],[\\dots],[\\dots]]$\n所有数值条目均显示为十进制字面量。\n\n没有用户输入。程序必须仅包含并使用上面给出的四个 Z-矩阵作为其测试套件，并在执行时产生所需的单行输出。", "solution": "该问题已经过验证，被认为是一项有效且定义明确的科学任务。它要求实现一个标准的坐标转换算法，使用一个精确定义的参考系，将三原子分子的内坐标（Z-矩阵坐标）转换为笛卡尔坐标。所提供的数学公式和测试用例是一致且科学合理的。\n\n其核心原理是将由内坐标（键长和键角）指定的分子几何结构，转换为每个原子的一组笛卡尔坐标 $(x, y, z)$。这是计算化学和分子模拟中的一个基本操作。因为一个具有 $N$ 个原子的非线性分子有 $3N-6$ 个内自由度，所以在 $3N$ 维笛卡尔空间中的完整描述需要移除对应于全局平移和旋转的 $6$ 个自由度。该问题为此提供了一个特定的约定。\n\n设原子索引为 $1$ (氧)，$2$ (氢)，和 $3$ (氢)。它们的笛卡尔坐标矢量为 $\\mathbf{R}_1$、$\\mathbf{R}_2$ 和 $\\mathbf{R}_3$。内坐标是键长 $r_{12}$（原子 $1$ 和 $2$ 之间的距离）和 $r_{13}$（原子 $1$ 和 $3$ 之间的距离），以及键角 $\\theta = \\angle(2-1-3)$。\n\n转换算法通过根据指定的参考系约定依次放置原子来进行：\n\n$1$. 原子 $1$ 被放置在笛卡尔系的原点。这固定了它的三个平移自由度。\n$$\n\\mathbf{R}_1 = (x_1, y_1, z_1) = (0, 0, 0)\n$$\n\n$2$. 原子 $2$ 被放置在正 $x$ 轴上。这固定了两个旋转自由度。它与原子 $1$ 的距离是键长 $r_{12}$。\n$$\n\\mathbf{R}_2 = (x_2, y_2, z_2) = (r_{12}, 0, 0)\n$$\n\n$3$. 原子 $3$ 被放置在 $xy$ 平面中，其 $y$ 分量为非负值。这固定了最后一个旋转自由度。它的位置由它与原子 $1$ 的距离 $r_{13}$ 以及它与矢量 $\\overrightarrow{1\\to 2}$ 所成的角度 $\\theta$ 决定。在此坐标系中，矢量 $\\overrightarrow{1\\to 2}$ 与 $x$ 轴对齐。使用 $xy$ 平面中的极坐标，可以导出原子 $3$ 的坐标。角度 $\\theta$ 必须从度转换为弧度才能用于三角函数，使用转换因子 $\\frac{\\pi}{180}$。\n$\\mathbf{R}_3$ 的坐标分量是：\n$$\nx_3 = r_{13} \\cos\\left(\\theta \\frac{\\pi}{180}\\right)\n$$\n$$\ny_3 = r_{13} \\sin\\left(\\theta \\frac{\\pi}{180}\\right)\n$$\n$$\nz_3 = 0\n$$\n对于非负 $y$ 分量的条件 $y_3 \\ge 0$ 是满足的，因为物理分子的键角 $\\theta$ 在 $[0, 180]$ 度的范围内，在此范围内正弦函数是非负的。\n\n计算过程是对提供的四个测试用例中的每一个应用这些公式。对于每个用例，参数集 $\\{r_{12}, r_{13}, \\theta\\}$ 用于计算九个笛卡尔分量 $(x_1, y_1, z_1, x_2, y_2, z_2, x_3, y_3, z_3)$。每个分量必须四舍五入到 $6$ 位小数。然后将得到的九个坐标的列表收集到一个最终列表中以供输出。最终答案中的程序直接实现了这一规范。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes Cartesian coordinates for four water molecule Z-matrix cases.\n    \"\"\"\n    # The problem defines four test cases with internal coordinates.\n    # Each case is a tuple: (r_12, r_13, theta_degrees)\n    # Distances are in Ångström, angles are in degrees.\n    test_cases = [\n        # Case A: typical water geometry\n        (0.9572, 0.9572, 104.5),\n        # Case B: asymmetric bonds, wider angle\n        (1.0, 0.9, 120.0),\n        # Case C: linear arrangement boundary\n        (1.0, 1.5, 180.0),\n        # Case D: nearly collapsed angle boundary\n        (0.5, 0.5, 0.0),\n    ]\n\n    results = []\n    for r12, r13, theta_deg in test_cases:\n        # Atom 1 (O) is at the origin (0, 0, 0).\n        r1_coords = [0.0, 0.0, 0.0]\n\n        # Atom 2 (H) is on the positive x-axis at a distance r12.\n        r2_coords = [r12, 0.0, 0.0]\n\n        # Atom 3 (H) is in the xy-plane.\n        # Convert angle from degrees to radians for trigonometric functions.\n        theta_rad = np.deg2rad(theta_deg)\n        \n        # Calculate coordinates for Atom 3 using polar-to-Cartesian conversion.\n        x3 = r13 * np.cos(theta_rad)\n        y3 = r13 * np.sin(theta_rad)\n        z3 = 0.0\n        r3_coords = [x3, y3, z3]\n\n        # Combine coordinates into a single list of 9 elements.\n        all_coords = r1_coords + r2_coords + r3_coords\n\n        # Round each component to 6 decimal places as required.\n        rounded_coords = [round(c, 6) for c in all_coords]\n        \n        results.append(rounded_coords)\n\n    # The final output must be a single-line string representing a list of lists.\n    # The template 'f\"[{','.join(map(str, results))}]\"' correctly formats this.\n    # For example, if results is [[1.0, 2.0], [3.0, 4.0]],\n    # map(str, results) yields '[1.0, 2.0]' and '[3.0, 4.0]'.\n    # ','.join(...) yields '[1.0, 2.0],[3.0, 4.0]'.\n    # The f-string adds the outer brackets, giving '[[1.0, 2.0],[3.0, 4.0]]'.\n    # This precisely matches the required output format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2458138"}]}