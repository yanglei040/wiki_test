{"hands_on_practices": [{"introduction": "理解多电子系统的第一步是确定其所有可能的量子态。这个练习将带你进行一次基础的组合学计算，以确定一个简单模型系统（4个电子在4个轨道中）可以形成多少个总自旋为零（单重态）的组态态函数。通过这个练习，你将掌握一种利用具有确定自旋投影（$M_S$）的子空间来计算特定自旋$S$的态数量的基本方法[@problem_id:2453183]。", "problem": "考虑一个非相对论、不显含自旋的电子体系，该体系由分布在4个不同空间轨道上的4个电子组成。每个空间轨道可以容纳两个自旋轨道（一个自旋投影为 $m_s=+\\tfrac{1}{2}$，另一个为 $m_s=-\\tfrac{1}{2}$），并以通常的方式由这些自旋轨道构建斯莱特行列式。忽略所有的空间点群对称性和任何轨道能量的考虑；在由所有符合泡利原理的斯莱特行列式所张成的全组态相互作用空间中进行计算。此处，一个组态态函数（CSF）被定义为总自旋平方算符 $\\hat{S}^2$ 和自旋投影算符 $\\hat{S}_z$ 的一个自旋适配的、线性无关的本征函数，它具有一个明确的总自旋量子数 $S$。\n\n确定可以从此空间中构成的、总自旋为 $S=0$ 的线性无关的CSF的总数。请以单个整数形式给出答案，无需四舍五入。", "solution": "所述问题是有效的。这是一个量子化学领域中定义明确的枚举问题，其基础是多电子量子力学和群论的基本原理。我们将开始推导。\n\n该体系包含 $N=4$ 个电子，待置于 $K=4$ 个不同的空间轨道中。每个空间轨道可以容纳两个自旋相反的电子，这意味着我们总共有 $2K=8$ 个可用的自旋轨道。全组态相互作用（FCI）空间是由所有可能的斯莱特行列式张成的向量空间，这些斯莱特行列式是通过将 $N=4$ 个电子按照泡利不相容原理分布在 $2K=8$ 个自旋轨道上形成的。该空间的维数是 $\\binom{2K}{N} = \\binom{8}{4} = 70$。\n\n组态态函数（CSF）是总自旋平方算符 $\\hat{S}^2$ 和自旋投影算符 $\\hat{S}_z$ 的本征函数。我们的任务是找出总自旋量子数 $S=0$（单重态）的线性无关CSF的数量。设此数量为 $f(N, K, S)$。我们要求解 $f(4, 4, 0)$。\n\n一种确定 $f(N, K, S)$ 的强大而直接的方法是基于对 $\\hat{S}_z$ 算符的特定本征值 $M_S$ 所对应的子空间维数的分析。FCI空间的基通常选择为所有斯莱特行列式的集合。虽然斯莱特行列式总是 $\\hat{S}_z$ 的本征函数，但它通常不是 $\\hat{S}^2$ 的本征函数。\n\n对于一个给定的斯莱特行列式，$\\hat{S}_z$ 的本征值为 $M_S = \\frac{1}{2}(N_\\alpha - N_\\beta)$，其中 $N_\\alpha$ 是自旋向上的电子数，$N_\\beta$ 是自旋向下的电子数。电子总数为 $N = N_\\alpha + N_\\beta$。\n\n一个自旋为 $S$ 的CSF是 $|M_S| \\le S$ 的斯莱特行列式的线性组合。具有给定 $M_S$ 值的所有状态所构成的空间，我们称其维数为 $\\dim(M_S)$，是由所有 $S \\ge |M_S|$ 的CSF张成的。即，\n$$\n\\dim(M_S) = \\sum_{S=|M_S|}^{N/2} f(N, K, S)\n$$\n由此，我们可以通过减法推导出特定自旋 $S$ 的CSF数量：\n$$\nf(N, K, S) = \\dim(M_S=S) - \\dim(M_S=S+1)\n$$\n我们将此公式应用于 $N=4$, $K=4$, 和 $S=0$ 的情况。\n$$\nf(4, 4, 0) = \\dim(M_S=0) - \\dim(M_S=1)\n$$\n首先，我们计算 $\\dim(M_S=0)$。条件 $M_S=0$ 意味着 $N_\\alpha - N_\\beta = 0$。由于 $N_\\alpha + N_\\beta = 4$，我们必须有 $N_\\alpha=2$ 和 $N_\\beta=2$。从可用的 $K$ 个轨道中为自旋向上的电子选择 $N_\\alpha$ 个空间轨道的方式数是 $\\binom{K}{N_\\alpha}$。类似地，为自旋向下的电子选择 $N_\\beta$ 个空间轨道的方式数是 $\\binom{K}{N_\\beta}$。具有 $M_S=0$ 的斯莱特行列式总数是这两个量的乘积。\n$$\n\\dim(M_S=0) = \\binom{K}{N_\\alpha} \\binom{K}{N_\\beta} = \\binom{4}{2} \\binom{4}{2}\n$$\n二项式系数 $\\binom{4}{2}$ 计算如下：\n$$\n\\binom{4}{2} = \\frac{4!}{2!(4-2)!} = \\frac{4 \\times 3}{2 \\times 1} = 6\n$$\n因此，$M_S=0$ 子空间的维数是：\n$$\n\\dim(M_S=0) = 6 \\times 6 = 36\n$$\n接下来，我们计算 $\\dim(M_S=1)$。条件 $M_S=1$ 意味着 $N_\\alpha - N_\\beta = 2(1) = 2$。又因为 $N_\\alpha + N_\\beta = 4$，解这个联立方程组得到 $2N_\\alpha = 6$，所以 $N_\\alpha=3$ 且 $N_\\beta=1$。那么，具有 $M_S=1$ 的行列式数量是：\n$$\n\\dim(M_S=1) = \\binom{K}{N_\\alpha} \\binom{K}{N_\\beta} = \\binom{4}{3} \\binom{4}{1}\n$$\n二项式系数为：\n$$\n\\binom{4}{3} = \\frac{4!}{3!(4-3)!} = 4\n$$\n$$\n\\binom{4}{1} = \\frac{4!}{1!(4-1)!} = 4\n$$\n因此，$M_S=1$ 子空间的维数是：\n$$\n\\dim(M_S=1) = 4 \\times 4 = 16\n$$\n最后，我们计算单重态CSF的数量 $f(4, 4, 0)$：\n$$\nf(4, 4, 0) = \\dim(M_S=0) - \\dim(M_S=1) = 36 - 16 = 20\n$$\n因此，对于一个4电子、4空间轨道的体系，存在20个总自旋 $S=0$ 的线性无关的CSF。这个结果可以通过其他方法进行验证，例如直接应用酉群 $U(K)$ 的不可约表示维数的Weyl公式，该方法会得出相同的结果，从而证实了此推导的正确性。", "answer": "$$\\boxed{20}$$", "id": "2453183"}, {"introduction": "在实际的量子化学计算中，我们经常使用近似波函数，而这些波函数不一定是纯自旋态。这个练习将理论与实践联系起来，通过计算非限制性波函数中的“自旋污染”来量化波函数对纯自旋态的偏离。你将推导并应用$\\langle \\hat{S}^2 \\rangle$算符的期望值公式，从而理解为何组态态函数（作为纯自旋本征态）是精确处理开壳层体系的关键[@problem_id:2453176]。", "problem": "考虑一个处于最小 $\\pi$ 体系描述下的烯丙基自由基，其具有三个通过简单类休克爾模型得到的正交归一分子轨道 $\\{\\psi_{1}, \\psi_{2}, \\psi_{3}\\}$。真实的基态是双重态，因此目标总自旋量子数为 $S=\\tfrac{1}{2}$。一个非限制性单行列式波函数由两个被占据的 $\\alpha$ 自旋空间轨道和一个被占据的 $\\beta$ 自旋空间轨道构成。设被占据的轨道为\n- $\\phi_{1}^{\\alpha}=\\psi_{1}$,\n- $\\phi_{2}^{\\alpha}=\\psi_{2}$,\n- $\\phi_{1}^{\\beta}=\\sqrt{0.90}\\,\\psi_{1}+\\sqrt{0.05}\\,\\psi_{2}+\\sqrt{0.05}\\,\\psi_{3}$,\n其中所有列出的空间轨道都是归一化的，并且 $\\{\\psi_{1},\\psi_{2},\\psi_{3}\\}$ 是正交归一的。一般来说，非限制性行列式不是自旋本征函数，因此可以展开为自旋匹配的组态态函数 (CSFs)，这些函数是总自旋算符的本征函数。\n\n从自旋算符 $\\hat{S}_{z}$、$\\hat{S}_{+}$、$\\hat{S}_{-}$ 的定义和波函数的 Slater 行列式结构出发，推导一个用被占据的 $\\alpha$ 和 $\\beta$ 自旋空间轨道之间的交叠表示的普遍非限制性单行列式的期望值 $\\langle \\hat{S}^{2} \\rangle$ 的表达式，并用它来计算上面定义的非限制性行列式的自旋污染 $\\langle \\hat{S}^{2} \\rangle - S(S+1)$。请用精确分数表示你的最终答案。", "solution": "该问题要求为普遍的非限制性单行列式波函数推导总自旋平方算符期望值 $\\langle \\hat{S}^2 \\rangle$ 的通用表达式，然后将其应用于一个具体案例以计算自旋污染。\n\n首先，对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- 体系：烯丙基自由基，最小 $\\pi$ 体系。\n- 基组：三个正交归一的分子轨道 $\\{\\psi_1, \\psi_2, \\psi_3\\}$。\n- 目标态自旋：$S = \\frac{1}{2}$ (双重态)。\n- 波函数形式：非限制性单行列式。\n- 被占据的 $\\alpha$ 自旋空间轨道：$\\phi_1^\\alpha = \\psi_1$, $\\phi_2^\\alpha = \\psi_2$。$\\alpha$ 电子数，$N_\\alpha = 2$。\n- 被占据的 $\\beta$ 自旋空间轨道：$\\phi_1^\\beta = \\sqrt{0.90}\\,\\psi_1 + \\sqrt{0.05}\\,\\psi_2 + \\sqrt{0.05}\\,\\psi_3$。$\\beta$ 电子数，$N_\\beta = 1$。\n- 正交归一性条件：$\\langle \\psi_i | \\psi_j \\rangle = \\delta_{ij}$。被占据的 $\\alpha$ 和 $\\beta$ 空间轨道集内部是正交归一的，即 $\\langle \\phi_i^\\alpha | \\phi_j^\\alpha \\rangle = \\delta_{ij}$ 和 $\\langle \\phi_i^\\beta | \\phi_j^\\beta \\rangle = \\delta_{ij}$。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据：** 该问题使用了量子化学的基本概念，包括非限制性波函数、Slater 行列式、自旋算符和自旋污染。这些是计算化学中的标准课题。该设定在科学上是合理的。\n- **适定性：** 该问题提供了所有必要的信息。轨道被明确定义，任务是直接计算一个明确定义的物理量。存在唯一解。$\\phi_1^\\beta$ 的归一化为 $(\\sqrt{0.90})^2 + (\\sqrt{0.05})^2 + (\\sqrt{0.05})^2 = 0.90 + 0.05 + 0.05 = 1.00$，证实了其有效性。\n- **客观性：** 该问题以精确、客观的语言陈述。\n\n**步骤3：结论与行动**\n该问题有效。将提供一个完整的、有理有据的解答。\n\n**$\\langle \\hat{S}^2 \\rangle$ 表达式的推导**\n\n总自旋平方算符 $\\hat{S}^2$ 可以用自旋升降算符 $\\hat{S}_+$ 和 $\\hat{S}_-$ 以及总自旋算符的 $z$ 分量 $\\hat{S}_z$ 表示为：\n$$ \\hat{S}^2 = \\hat{S}_+ \\hat{S}_- + \\hat{S}_z^2 - \\hat{S}_z $$\n单个 Slater 行列式，例如非限制性 Hartree-Fock (UHF) 波函数 $|\\Psi\\rangle$，总是 $\\hat{S}_z$ 的本征函数。其本征值 $M_S$ 由下式给出：\n$$ \\hat{S}_z |\\Psi\\rangle = \\frac{1}{2}(N_\\alpha - N_\\beta) |\\Psi\\rangle = M_S |\\Psi\\rangle $$\n因此，对于一个归一化的行列式 $|\\Psi\\rangle$，期望值 $\\langle \\hat{S}^2 \\rangle$ 为：\n$$ \\langle \\hat{S}^2 \\rangle = \\langle\\Psi| \\hat{S}_+ \\hat{S}_- + \\hat{S}_z^2 - \\hat{S}_z |\\Psi\\rangle = \\langle\\Psi| \\hat{S}_+ \\hat{S}_- |\\Psi\\rangle + M_S^2 - M_S $$\n由于 $\\hat{S}_+$ 是 $\\hat{S}_-$ 的伴随算符，我们可以写出 $\\langle\\Psi| \\hat{S}_+ \\hat{S}_- |\\Psi\\rangle = \\langle \\hat{S}_- \\Psi| \\hat{S}_- \\Psi \\rangle$。\n\n算符 $\\hat{S}_- = \\sum_{k=1}^N \\hat{s}_{k-}$ 作用于 $N$ 电子波函数，其方式是对每个电子上的单电子自旋下降算符的作用求和。$\\hat{s}_-$ 会湮灭一个 $\\beta$ 自旋电子，并将一个 $\\alpha$ 自旋电子转换为一个 $\\beta$ 自旋电子。\n设被占据的自旋轨道集为 $\\{\\chi_p\\}_{p=1}^N = \\{\\phi_i^\\alpha \\alpha\\}_{i=1}^{N_\\alpha} \\cup \\{\\phi_j^\\beta \\beta\\}_{j=1}^{N_\\beta}$。Slater 行列式为 $|\\Psi\\rangle = \\mathcal{A}(\\chi_1 \\dots \\chi_N)$。用 $\\hat{S}_-$ 作用于 $|\\Psi\\rangle$ 会产生 $N_\\alpha$ 个行列式的和，其中每一项都有一个 $\\alpha$ 自旋轨道 $\\phi_i^\\alpha \\alpha$被替换为一个 $\\beta$ 自旋轨道 $\\phi_i^\\alpha \\beta$：\n$$ \\hat{S}_- |\\Psi\\rangle = \\sum_{i=1}^{N_\\alpha} |\\Psi(i \\to \\bar{i})\\rangle $$\n其中 $|\\Psi(i \\to \\bar{i})\\rangle$ 表示 $\\phi_i^\\alpha\\alpha$ 已被 $\\phi_i^\\alpha\\beta$ 替换的行列式。\n\n期望值变为：\n$$ \\langle \\hat{S}_+ \\hat{S}_- \\rangle = \\left\\langle \\sum_{i=1}^{N_\\alpha} \\Psi(i \\to \\bar{i}) \\Big| \\sum_{j=1}^{N_\\alpha} \\Psi(j \\to \\bar{j}) \\right\\rangle = \\sum_{i=1}^{N_\\alpha} \\sum_{j=1}^{N_\\alpha} \\langle \\Psi(i \\to \\bar{i}) | \\Psi(j \\to \\bar{j}) \\rangle $$\n交叠 $\\langle \\Psi(i \\to \\bar{i}) | \\Psi(j \\to \\bar{j}) \\rangle$ 是构成这两个波函数的自旋轨道的交叠矩阵的行列式。\n$|\\Psi(i \\to \\bar{i})\\rangle$ 的自旋轨道集包含 $\\{\\phi_k^\\alpha\\alpha\\}_{k \\neq i}$ 和 $\\{\\phi_l^\\beta\\beta\\}_l \\cup \\{\\phi_i^\\alpha\\beta\\}$。由于 $\\alpha$ 自旋轨道的空间部分相互正交 ($\\langle \\phi_k^\\alpha | \\phi_m^\\alpha \\rangle = \\delta_{km}$)，对于 $i \\neq j$，交叠 $\\langle \\Psi(i \\to \\bar{i}) | \\Psi(j \\to \\bar{j}) \\rangle$ 为零。这是因为 $|\\Psi(i \\to \\bar{i})\\rangle$ 中的 $\\alpha$ 空间轨道集缺少 $\\phi_i^\\alpha$，而 $|\\Psi(j \\to \\bar{j})\\rangle$ 中的集合缺少 $\\phi_j^\\alpha$，导致交叠行列式中出现零。\n\n因此，我们只需要考虑 $i=j$ 的对角项：\n$$ \\langle \\hat{S}_+ \\hat{S}_- \\rangle = \\sum_{i=1}^{N_\\alpha} \\langle \\Psi(i \\to \\bar{i}) | \\Psi(i \\to \\bar{i}) \\rangle $$\n$|\\Psi(i \\to \\bar{i})\\rangle$ 的范数由其组分自旋轨道的交叠矩阵的行列式给出。这个集合是 $\\{\\phi_k^\\alpha\\alpha\\}_{k \\neq i} \\cup \\{\\phi_j^\\beta\\beta\\}_{j=1}^{N_\\beta} \\cup \\{\\phi_i^\\alpha\\beta\\}$。$\\alpha$ 块内的自旋轨道是正交的。复杂性来自于 $\\beta$ 块，它现在包含 $N_\\beta+1$ 个轨道：$\\{\\phi_j^\\beta\\}_{j=1}^{N_\\beta}$ 和 $\\phi_i^\\alpha$。这个 $(N_\\beta+1) \\times (N_\\beta+1)$ 空间交叠矩阵的行列式是 $1 - \\sum_{j=1}^{N_\\beta} |\\langle \\phi_i^\\alpha | \\phi_j^\\beta \\rangle|^2$。因此：\n$$ \\langle \\Psi(i \\to \\bar{i}) | \\Psi(i \\to \\bar{i}) \\rangle = 1 - \\sum_{j=1}^{N_\\beta} |\\langle \\phi_i^\\alpha | \\phi_j^\\beta \\rangle|^2 $$\n对所有 $i$ 求和：\n$$ \\langle \\hat{S}_+ \\hat{S}_- \\rangle = \\sum_{i=1}^{N_\\alpha} \\left( 1 - \\sum_{j=1}^{N_\\beta} |\\langle \\phi_i^\\alpha | \\phi_j^\\beta \\rangle|^2 \\right) = N_\\alpha - \\sum_{i=1}^{N_\\alpha} \\sum_{j=1}^{N_\\beta} |\\langle \\phi_i^\\alpha | \\phi_j^\\beta \\rangle|^2 $$\n将此代回 $\\langle \\hat{S}^2 \\rangle$ 的表达式中：\n$$ \\langle \\hat{S}^2 \\rangle = (M_S^2 - M_S) + N_\\alpha - \\sum_{i=1}^{N_\\alpha} \\sum_{j=1}^{N_\\beta} |\\langle \\phi_i^\\alpha | \\phi_j^\\beta \\rangle|^2 $$\n使用恒等式 $M_S^2-M_S+N_\\alpha = M_S(M_S+1)+N_\\beta$，我们得到常用形式：\n$$ \\langle \\hat{S}^2 \\rangle = M_S(M_S+1) + N_\\beta - \\sum_{i=1}^{N_\\alpha} \\sum_{j=1}^{N_\\beta} |\\langle \\phi_i^\\alpha | \\phi_j^\\beta \\rangle|^2 $$\n自旋污染是此期望值与纯自旋态的值 $S(S+1)$ 的偏差。对于一个旨在成为给定多重度下最低能量态的态，有 $S = M_S$。因此，自旋污染为：\n$$ \\langle \\hat{S}^2 \\rangle - S(S+1) = \\langle \\hat{S}^2 \\rangle - M_S(M_S+1) = N_\\beta - \\sum_{i=1}^{N_\\alpha} \\sum_{j=1}^{N_\\beta} |\\langle \\phi_i^\\alpha | \\phi_j^\\beta \\rangle|^2 $$\n\n**对烯丙基自由基的计算**\n\n对于给定的问题：\n- $N_\\alpha = 2$, $N_\\beta = 1$。\n- 目标自旋态是双重态，$S = \\frac{1}{2}$，所以理想值为 $S(S+1) = \\frac{1}{2}(\\frac{1}{2}+1) = \\frac{3}{4}$。\n- 该波函数具有 $M_S = \\frac{1}{2}(2-1) = \\frac{1}{2}$，这与目标态一致。\n- 被占据的 $\\alpha$ 轨道：$\\phi_1^\\alpha = \\psi_1$, $\\phi_2^\\alpha = \\psi_2$。\n- 被占据的 $\\beta$ 轨道：$\\phi_1^\\beta = \\sqrt{0.90}\\,\\psi_1 + \\sqrt{0.05}\\,\\psi_2 + \\sqrt{0.05}\\,\\psi_3$。\n\n我们需要计算交叠平方和 $\\sum_{i=1}^2 \\sum_{j=1}^1 |\\langle \\phi_i^\\alpha | \\phi_j^\\beta \\rangle|^2$。\n该和有两项：\n$1$. 对于 $i=1, j=1$:\n$$ \\langle \\phi_1^\\alpha | \\phi_1^\\beta \\rangle = \\langle \\psi_1 | (\\sqrt{0.90}\\,\\psi_1 + \\sqrt{0.05}\\,\\psi_2 + \\sqrt{0.05}\\,\\psi_3) \\rangle $$\n利用 $\\{\\psi_k\\}$ 的正交归一性，$\\langle \\psi_i | \\psi_j \\rangle = \\delta_{ij}$：\n$$ \\langle \\phi_1^\\alpha | \\phi_1^\\beta \\rangle = \\sqrt{0.90}\\langle\\psi_1|\\psi_1\\rangle + \\sqrt{0.05}\\langle\\psi_1|\\psi_2\\rangle + \\sqrt{0.05}\\langle\\psi_1|\\psi_3\\rangle = \\sqrt{0.90} $$\n$$ |\\langle \\phi_1^\\alpha | \\phi_1^\\beta \\rangle|^2 = 0.90 = \\frac{9}{10} $$\n$2$. 对于 $i=2, j=1$:\n$$ \\langle \\phi_2^\\alpha | \\phi_1^\\beta \\rangle = \\langle \\psi_2 | (\\sqrt{0.90}\\,\\psi_1 + \\sqrt{0.05}\\,\\psi_2 + \\sqrt{0.05}\\,\\psi_3) \\rangle $$\n$$ \\langle \\phi_2^\\alpha | \\phi_1^\\beta \\rangle = \\sqrt{0.90}\\langle\\psi_2|\\psi_1\\rangle + \\sqrt{0.05}\\langle\\psi_2|\\psi_2\\rangle + \\sqrt{0.05}\\langle\\psi_2|\\psi_3\\rangle = \\sqrt{0.05} $$\n$$ |\\langle \\phi_2^\\alpha | \\phi_1^\\beta \\rangle|^2 = 0.05 = \\frac{5}{100} = \\frac{1}{20} $$\n\n总和是：\n$$ \\sum_{i=1}^2 |\\langle \\phi_i^\\alpha | \\phi_1^\\beta \\rangle|^2 = \\frac{9}{10} + \\frac{1}{20} = \\frac{18}{20} + \\frac{1}{20} = \\frac{19}{20} $$\n那么自旋污染为：\n$$ \\langle \\hat{S}^2 \\rangle - S(S+1) = N_\\beta - \\sum_{i,j} |\\langle \\phi_i^\\alpha | \\phi_j^\\beta \\rangle|^2 = 1 - \\frac{19}{20} = \\frac{1}{20} $$\n期望值为 $\\langle \\hat{S}^2 \\rangle = S(S+1) + \\frac{1}{20} = \\frac{3}{4} + \\frac{1}{20} = \\frac{15}{20} + \\frac{1}{20} = \\frac{16}{20} = \\frac{4}{5} = 0.80$。污染本身就是这个差值，$\\frac{1}{20}$。", "answer": "$$\\boxed{\\frac{1}{20}}$$", "id": "2453176"}, {"introduction": "这个练习是最终的动手挑战：从头开始构建组态态函数。你将编写一个程序，在斯莱特行列式基组中构建$\\hat{S}^2$算符的矩阵表示，并通过对角化该矩阵来获得其本征态——即CSFs。这个过程不仅能让你亲眼见证自旋适配的过程，还能通过计算得到的本征值来验证态的自旋纯度，从而深刻理解CSF的构造性定义[@problem_id:2453214]。", "problem": "给定一个有限的空间轨道集和固定数量的电子。一个组态态函数（CSF）被定义为总自旋平方算符 $S^2$ 和自旋投影算符 $S_z$ 的自旋匹配、正交归一的本征函数。在二次量子化中，自旋算符为\n$$\nS_+ = \\sum_{p=0}^{M-1} a^\\dagger_{p\\alpha}\\,a_{p\\beta},\\quad\nS_- = \\sum_{p=0}^{M-1} a^\\dagger_{p\\beta}\\,a_{p\\alpha},\\quad\nS_z = \\frac{1}{2}\\sum_{p=0}^{M-1}\\left(n_{p\\alpha}-n_{p\\beta}\\right),\n$$\n以及\n$$\nS^2 = S_z^2 + S_z + S_- S_+,\n$$\n其中 $M$ 是空间轨道的数量，$a^\\dagger_{p\\sigma}$ 和 $a_{p\\sigma}$ 分别是自旋轨道 $(p,\\sigma)$ 的费米子产生和湮灭算符，$n_{p\\sigma}=a^\\dagger_{p\\sigma}a_{p\\sigma}$ 是粒子数算符。每个 CSF 必须是 $S^2$ 的本征函数，其本征值为 $S(S+1)$（对于某个总自旋 $S$），并且同时是 $S_z$ 的本征函数，其本征值为 $M_s$。与 CSF 相关联的自旋多重度是 $2S+1$。混合自旋多重度意味着构建并非 $S^2$ 本征函数（即非纯自旋态）的斯莱特行列式的线性组合，这是不正确的。\n\n你的任务是编写一个程序，对于每个指定的场景，构建一个完整的 $M_s$ 分辨的斯莱特行列式基组。该基组包含 $N$ 个电子分布在 $M$ 个空间轨道上（每个空间轨道支持两个自旋轨道，$\\alpha$ 和 $\\beta$）。然后，在该基组中构建 $S^2$ 的矩阵表示，对其进行对角化，并根据其自旋多重度 $2S+1$ 对所得的本征态进行分类。你还必须通过检查每个本征值是否在数值容差范围内等于某个半整数或整数 $S$ 的 $S(S+1)$，来验证每个本征态是否对应一个明确定义的 $S$。如果成立，则不存在多重度混合。\n\n对于每个测试用例，你必须输出一个形式为 $[n_{\\mathrm{CSF}}, \\mathrm{multiplicities}, \\mathrm{is\\_pure}]$ 的结果，其中：\n- $n_{\\mathrm{CSF}}$ 是在所选 $M_s$ 分区中获得的 CSF 的整数数量（等于 $M_s$ 分辨的行列式基组的维度），\n- $\\mathrm{multiplicities}$ 是一个整数列表，给出每个 CSF 的 $2S+1$ 值，按非递减顺序排序，\n- $\\mathrm{is\\_pure}$ 是一个布尔值，当且仅当每个本征值在严格的数值容差内等于某个允许的 $S$ 的 $S(S+1)$ 时为 $\\mathrm{True}$，否则为 $\\mathrm{False}$。\n\n不涉及角度；不涉及物理单位。所有量都是无量纲的。\n\n使用以下包含五个场景的测试套件，每个场景以 $(M, N, M_s)$ 的形式给出，其中 $M$ 是空间轨道的数量，$N$ 是电子的数量，$M_s$ 是自旋投影本征值。$M_s$ 的值是有理数：\n1. $(M,N,M_s)=(\\,2,\\,2,\\,0\\,)$\n2. $(M,N,M_s)=(\\,3,\\,3,\\,\\tfrac{3}{2}\\,)$\n3. $(M,N,M_s)=(\\,1,\\,2,\\,0\\,)$\n4. $(M,N,M_s)=(\\,2,\\,3,\\,\\tfrac{1}{2}\\,)$\n5. $(M,N,M_s)=(\\,2,\\,2,\\,1\\,)$\n\n你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔的结果列表。第 $k$ 个元素必须是第 $k$ 个测试用例的结果列表，不含任何空白字符。例如，整体格式必须是\n\"[result1,result2,result3,result4,result5]\"\n其中每个 \"result$k$\" 本身是一个形如 \"[n_CSF,[m_1,m_2,...],is_pure]\" 的列表，不含空格。\n\n每个测试用例所需的输出必须是确定性的和可数值复现的。最终输出仅为列表和布尔值；不应打印其他文本。", "solution": "所述问题具有科学依据，是客观且定义明确的。它构成了计算量子化学中的一个标准练习：通过在斯莱特行列式基组中对角化总自旋平方算符 $S^2$ 来构建组态态函数（CSFs）。一个完整的解决方案需要三个主要阶段：生成合适的多电子基组，构建 $S^2$ 算符的矩阵表示，最后进行数值对角化并分析得到的本征态。\n\n首先，我们必须为一个具有 $M$ 个空间轨道、$N$ 个电子以及固定的自旋投影算符 $S_z$ 本征值 $M_s$ 的系统构建斯莱特行列式基组。一个斯莱特行列式由其所占据的自旋轨道集合唯一确定。任何行列式的 $S_z$ 本征值由 $M_s = \\frac{1}{2}(N_\\alpha - N_\\beta)$ 给出，其中 $N_\\alpha$ 和 $N_\\beta$ 分别是自旋为 $\\alpha$ 和 $\\beta$ 的电子数。结合总电子数 $N = N_\\alpha + N_\\beta$，我们可以唯一确定所需的 $\\alpha$ 和 $\\beta$ 电子数：\n$$ N_\\alpha = \\frac{N + 2M_s}{2} $$\n$$ N_\\beta = \\frac{N - 2M_s}{2} $$\n为了使一个有效的基组存在，$N_\\alpha$ 和 $N_\\beta$ 必须是非负整数。此外，给定自旋的电子数不能超过可用空间轨道的数量，因此我们需要满足 $0 \\le N_\\alpha \\le M$ 和 $0 \\le N_\\beta \\le M$。如果这些条件不满足，则基组为空。否则，基组由所有通过为 $\\alpha$ 电子选择 $N_\\alpha$ 个空间轨道和为 $\\beta$ 电子选择 $N_\\beta$ 个空间轨道而形成的斯莱特行列式组成。这类行列式的总数，即我们的组态相互作用空间的维度，是 $\\binom{M}{N_\\alpha} \\binom{M}{N_\\beta}$。每个行列式可以由一对位掩码表示，一个用于占据的 $\\alpha$ 轨道，另一个用于占据的 $\\beta$ 轨道。\n\n其次，我们在这个行列式基组中构建 $S^2$ 算符的矩阵表示。问题提供了恒等式 $S^2 = S_z^2 + S_z + S_- S_+$。由于我们工作在一个基组中，其中每个函数都是 $S_z$ 的本征函数，本征值为 $M_s$，因此 $S_z^2 + S_z$ 项对矩阵的对角线贡献一个常数值 $M_s^2 + M_s$。有趣的部分是 $S_- S_+$ 项。我们必须确定其矩阵元 $\\langle \\Phi_i | S_- S_+ | \\Phi_j \\rangle$，其中 $|\\Phi_i\\rangle$ 和 $|\\Phi_j\\rangle$ 是我们基组中的两个行列式。\n\n对角矩阵元通过计算 $\\langle \\Phi_i | S_- S_+ | \\Phi_i \\rangle$ 来找到。在二次量子化中使用自旋算符的定义，可以证明该项为：\n$$ \\langle \\Phi_i | S_- S_+ | \\Phi_i \\rangle = \\sum_{p,q} \\langle \\Phi_i | a^\\dagger_{q\\beta}a_{q\\alpha} a^\\dagger_{p\\alpha}a_{p\\beta} | \\Phi_i \\rangle $$\n这个表达式仅在 $p=q$ 时非零。计算结果为 $\\sum_p \\langle \\Phi_i | n_{p\\beta}(1 - n_{p\\alpha}) | \\Phi_i \\rangle$，这计算了行列式 $|\\Phi_i\\rangle$ 中被一个 $\\beta$ 电子单占据的空间轨道数。设这个数为 $N_{u\\beta}^{(i)}$。因此，$S^2$ 矩阵的完整对角元为：\n$$ H_{ii} = \\langle \\Phi_i | S^2 | \\Phi_i \\rangle = M_s(M_s+1) + N_{u\\beta}^{(i)} $$\n\n非对角矩阵元 $H_{ij} = \\langle \\Phi_i | S^2 | \\Phi_j \\rangle$（对于 $i \\neq j$）仅对于 $S_- S_+$ 部分非零。该算符连接了因特定双电子过程而不同的行列式。对算符 $S_-S_+$ 的分析表明，它仅当行列式 $|\\Phi_j\\rangle$ 可以通过交换 $|\\Phi_i\\rangle$ 中两个不同单占据轨道上两个电子的自旋得到时，才连接 $|\\Phi_i\\rangle$ 和 $|\\Phi_j\\rangle$。也就是说，如果 $|\\Phi_i\\rangle$ 在空间轨道 $p$ 上有一个 $\\alpha$ 电子，在空间轨道 $q$ 上有一个 $\\beta$ 电子（且这些轨道中没有其他电子），而 $|\\Phi_j\\rangle$ 除了在 $p$ 上有一个 $\\beta$ 电子和在 $q$ 上有一个 $\\alpha$ 电子外，其他都与之相同，那么就存在一个非零矩阵元。这个矩阵元 $\\langle \\Phi_j | S_-S_+ | \\Phi_i \\rangle$ 的值被严格地确定为 $-1$。因此：\n$$ H_{ij} = -1 \\quad \\text{if } |\\Phi_j\\rangle \\text{ is a single spin-exchange of } |\\Phi_i\\rangle $$\n对于所有其他 $|\\Phi_i\\rangle$ 和 $|\\Phi_j\\rangle$ 不同的情况，$H_{ij} = 0$。得到的 $S^2$ 矩阵是实对称的。\n\n第三，我们对 $S^2$ 矩阵进行对角化。其本征值 $\\lambda_k$ 必须对应于某个总自旋量子数 $S$ 的 $S(S+1)$ 值。我们可以为每个本征值求解 $S$：\n$$ S_k = \\frac{-1 + \\sqrt{1 + 4\\lambda_k}}{2} $$\n我们取正根，因为 $S \\ge 0$。如果每个计算出的 $S_k$ 在严格的数值容差内是整数或半整数，则该问题被认为是`spin-pure`（纯自旋态）。这等价于检查 $2S_k$ 是否为整数。对于每个有效的 $S_k$，我们计算自旋多重度 $2S_k+1$。\n\n每个测试用例的最终输出是一个列表，其中包含行列式总数 $n_{\\mathrm{CSF}}$（矩阵的维度）、计算出的自旋多重度的排序列表，以及一个指示所有态是否为纯自旋态的布尔值。", "answer": "```python\nimport numpy as np\nfrom itertools import combinations\nimport math\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for the given test suite.\n    \"\"\"\n    test_cases = [\n        (2, 2, 0.0),\n        (3, 3, 1.5),\n        (1, 2, 0.0),\n        (2, 3, 0.5),\n        (2, 2, 1.0)\n    ]\n\n    results = []\n    for M, N, Ms in test_cases:\n        # Step 1: Determine N_alpha and N_beta\n        # N_alpha + N_beta = N\n        # (N_alpha - N_beta) / 2 = Ms\n        n_alpha_float = (N + 2 * Ms) / 2\n        n_beta_float = (N - 2 * Ms) / 2\n\n        # Check for validity: must be non-negative integers and within orbital limits\n        if (n_alpha_float  0 or n_beta_float  0 or\n            n_alpha_float != int(n_alpha_float) or\n            n_beta_float != int(n_beta_float)):\n            results.append(\"[0,[],True]\")\n            continue\n            \n        N_alpha = int(n_alpha_float)\n        N_beta = int(n_beta_float)\n\n        if N_alpha > M or N_beta > M:\n            results.append(\"[0,[],True]\")\n            continue\n\n        # Step 2: Generate the determinant basis\n        alpha_configs = list(combinations(range(M), N_alpha))\n        beta_configs = list(combinations(range(M), N_beta))\n        \n        basis_dets = []\n        for ac in alpha_configs:\n            for bc in beta_configs:\n                alpha_mask = sum(1  i for i in ac)\n                beta_mask = sum(1  i for i in bc)\n                basis_dets.append((alpha_mask, beta_mask))\n        \n        n_csf = len(basis_dets)\n        if n_csf == 0:\n            results.append(\"[0,[],True]\")\n            continue\n\n        det_to_index = {det: i for i, det in enumerate(basis_dets)}\n\n        # Step 3: Construct the S^2 matrix\n        s2_matrix = np.zeros((n_csf, n_csf))\n\n        for i, (alpha_mask_i, beta_mask_i) in enumerate(basis_dets):\n            # Diagonal elements: H_ii = Ms*(Ms+1) + N_u_beta\n            singly_beta_mask = beta_mask_i  ~alpha_mask_i\n            num_singly_beta = bin(singly_beta_mask).count('1')\n            s2_matrix[i, i] = Ms * (Ms + 1) + num_singly_beta\n\n            # Off-diagonal elements: H_ij = -1 for spin exchange\n            singly_alpha_mask = alpha_mask_i  ~beta_mask_i\n            singly_alpha_orbs = [k for k in range(M) if (singly_alpha_mask >> k)  1]\n            singly_beta_orbs = [k for k in range(M) if (singly_beta_mask >> k)  1]\n\n            for p in singly_alpha_orbs:\n                for q in singly_beta_orbs:\n                    # Create new determinant by swapping spins on p and q\n                    # p: alpha -> beta; q: beta -> alpha\n                    alpha_mask_j = (alpha_mask_i ^ (1  p)) | (1  q)\n                    beta_mask_j = (beta_mask_i ^ (1  q)) | (1  p)\n                    \n                    det_j = (alpha_mask_j, beta_mask_j)\n                    if det_j in det_to_index:\n                        j = det_to_index[det_j]\n                        if i  j: # Fill upper triangle to avoid double work\n                           s2_matrix[i, j] = -1.0\n                           s2_matrix[j, i] = -1.0\n        \n        # Step 4: Diagonalize and analyze eigenvalues\n        if n_csf > 0:\n            eigenvalues = np.linalg.eigvalsh(s2_matrix)\n        else:\n            eigenvalues = np.array([])\n        \n        # Check for negative eigenvalues due to numerical noise and clip\n        eigenvalues = np.clip(eigenvalues, 0, None)\n        \n        s_values = (-1 + np.sqrt(1 + 4 * eigenvalues)) / 2\n\n        # Check for spin purity\n        is_pure = np.all(np.isclose(2 * s_values, np.round(2 * s_values), atol=1e-9))\n        \n        multiplicities = np.round(2 * s_values + 1).astype(int).tolist()\n        multiplicities.sort()\n        \n        # Format result string without whitespace\n        mult_str = f\"[{','.join(map(str, multiplicities))}]\"\n        bool_str = str(is_pure)\n        result_str = f\"[{n_csf},{mult_str},{bool_str}]\"\n        results.append(result_str)\n\n    # Final print statement in the exact required format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n\n```", "id": "2453214"}]}