{"hands_on_practices": [{"introduction": "要理解全组态相互作用（FCI）的重要性，我们首先必须掌握电子相关能的概念。本练习提供了一个基础计算，将相关能定义为精确的FCI能量与近似的Hartree-Fock能量之差，这是评估量子化学方法准确性的一个关键指标。", "problem": "一位计算化学家正在使用特定的原子轨道基组研究一个四电子原子的电子结构。第一步是使用 Hartree-Fock (HF) 方法进行计算，这是一种以平均场方式模拟电子-电子排斥的近似方法。该计算得出的基态能量为 -39.727 哈特里。\n\n为了得到更准确的基准，该化学家接着使用相同的基组进行了全组态相互作用 (Full CI) 计算。Full CI 方法考虑了所有可能的电子组态，并在所选基组内为系统提供了精确的非相对论电子能量。这个更详尽的计算得出的基态能量为 -39.845 哈特里。\n\n计算该基组为此原子捕获的相关能。以哈特里为单位表示您的答案，并四舍五入至三位有效数字。", "solution": "在固定基组内，相关能定义为该基组中的精确非相对论电子能量与 Hartree-Fock 平均场能量之间的差值。使用 Full CI 作为基组内的精确参考，即\n$$\nE_{\\text{corr}} = E_{\\text{FCI}} - E_{\\text{HF}}.\n$$\n已知 $E_{\\text{HF}} = -39.727$ 哈特里且 $E_{\\text{FCI}} = -39.845$ 哈特里，\n$$\nE_{\\text{corr}} = (-39.845) - (-39.727) = -39.845 + 39.727 = -0.118 \\text{ 哈特里}.\n$$\n四舍五入到三位有效数字，相关能为 $-0.118$ 哈特里。", "answer": "$$\\boxed{-0.118}$$", "id": "1978313"}, {"introduction": "尽管FCI在给定基组下提供了精确解，但其应用却因巨大的计算成本而受到严重限制。本练习将让您通过计算一个简单体系的电子组态（Slater行列式）数量，亲身体验“维度灾难”。这个组合问题揭示了为何FCI仅适用于最小的分子体系。", "problem": "考虑一个由$N$个不可区分电子组成的系统的非相对论、自旋无关的电子哈密顿量，该哈密顿量在一组正交归一的空间轨道上展开。在全组态相互作用（FCI）计算中，多电子基取为所有不同的Slater行列式，这些行列式由自旋轨道构成，而自旋轨道是通过将每个空间轨道与一个$\\alpha$或$\\beta$自旋函数配对得到的。\n\n给定一个系统，其中包含$N=4$个电子和$M=8$个正交归一的空间轨道。假设每个空间轨道对每种自旋最多只能容纳一个电子，这符合Pauli不相容原理，并且Slater行列式由自旋轨道以常规方式构建。\n\n将注意力限制在总自旋投影量子数$M_s=0$的子空间上，该子空间对应于单重态自旋流形（$S=0$）。在这个$M_s=0$的分区内，确定可以为FCI展开构建出的不同Slater行列式的总数。\n\n以精确整数形式给出答案，不带单位。", "solution": "该问题要求计算在一个由$N=4$个电子分布在$M=8$个空间轨道中的系统中，满足总自旋投影$M_s=0$约束条件的唯一Slater行列式的数量。\n\n一个自旋轨道是一个空间轨道$\\phi_i$与一个自旋函数（$\\alpha$（自旋向上）或$\\beta$（自旋向下））的乘积。对于$M=8$个空间轨道，共有$2M=16$个可用的自旋轨道。通过从这16个自旋轨道中选择$N=4$个不同的自旋轨道来构建一个Slater行列式。\n\n总自旋投影量子数$M_s$是各个电子自旋投影量子数$m_s$的总和。处于$\\alpha$自旋态的电子其$m_s = +\\frac{1}{2}$，而处于$\\beta$自旋态的电子其$m_s = -\\frac{1}{2}$。设$N_\\alpha$为自旋为$\\alpha$的电子数，$N_\\beta$为自旋为$\\beta$的电子数。总自旋投影由下式给出：\n$$M_s = N_\\alpha \\left(+\\frac{1}{2}\\right) + N_\\beta \\left(-\\frac{1}{2}\\right) = \\frac{1}{2}(N_\\alpha - N_\\beta)$$\n电子总数为$N=N_\\alpha+N_\\beta=4$。问题指定了约束条件$M_s = 0$，这意味着：\n$$\\frac{1}{2}(N_\\alpha - N_\\beta) = 0 \\implies N_\\alpha = N_\\beta$$\n解这个二元一次方程组：\n\\begin{cases}\nN_\\alpha + N_\\beta = 4 \\\\\nN_\\alpha - N_\\beta = 0\n\\end{cases}\n可得$2N_\\alpha = 4$，因此$N_\\alpha=2$，相应地$N_\\beta=2$。\n因此，对于$M_s=0$子空间中的任何有效Slater行列式，必须恰好有两个自旋为$\\alpha$的电子和两个自旋为$\\beta$的电子。\n\n问题现在简化为一个组合计算。我们必须确定将$N_\\alpha=2$个α电子和$N_\\beta=2$个β电子独立地放入可用轨道中的方式数量。\n对于α电子，我们必须从$M=8$个可用空间轨道中选择$N_\\alpha=2$个不同的空间轨道。实现这一点的方式数量由二项式系数$\\binom{M}{N_\\alpha}$给出。\n$$ \\text{α电子的组合方式数} = \\binom{8}{2} $$\n对于β电子，我们同样需要从相同的$M=8$个可用空间轨道中选择$N_\\beta=2$个不同的空间轨道。实现这一点的方式数量由$\\binom{M}{N_\\beta}$给出。\n$$ \\text{β电子的组合方式数} = \\binom{8}{2} $$\n由于为α电子选择空间轨道与为β电子选择空间轨道是相互独立的，因此不同Slater行列式（组态）的总数是这两个数的乘积。\n$$ \\text{行列式总数} = \\binom{8}{2} \\times \\binom{8}{2} $$\n现在我们计算二项式系数的值：\n$$ \\binom{8}{2} = \\frac{8!}{2!(8-2)!} = \\frac{8!}{2!6!} = \\frac{8 \\times 7}{2 \\times 1} = 28 $$\n因此，不同Slater行列式的总数为：\n$$ \\text{总数} = 28 \\times 28 = 784 $$\n这就是指定系统在$M_s=0$子空间中FCI矩阵的大小。", "answer": "$$\n\\boxed{784}\n$$", "id": "2455906"}, {"introduction": "除了获得更精确的能量，FCI得到的相关波函数还为我们深入理解化学键和电子结构的本质提供了独特的视角。这个进阶练习探讨了自然轨道及其占据数的概念，它们由FCI波函数推导而来。通过分析这些占据数如何偏离Hartree-Fock图像中简单的整数（2或0），我们可以量化电子相关的效应。", "problem": "考虑一个铍原子的最小基组模型，该模型共有 $N=4$ 个电子，占据 $M=4$ 个正交归一的空间轨道 $\\{\\phi_1,\\phi_2,\\phi_3,\\phi_4\\}$。多电子波函数由闭壳层斯莱特行列式的归一化线性组合给出，每个行列式对应于两个被双占据（每个自旋的电子各一个）的空间轨道。设自旋求和的单粒子约化密度矩阵 $\\gamma$ 定义为\n$$\n\\gamma_{pq}=\\langle \\Psi \\lvert \\sum_{\\sigma \\in \\{\\alpha,\\beta\\}} \\hat{a}^{\\dagger}_{p\\sigma} \\hat{a}_{q\\sigma} \\rvert \\Psi \\rangle,\n$$\n其中 $\\hat{a}^{\\dagger}_{p\\sigma}$ 和 $\\hat{a}_{q\\sigma}$ 分别是具有自旋 $\\sigma$ 的空间轨道 $p$ 和 $q$ 的费米子产生和湮灭算符，而 $\\rvert \\Psi \\rangle$ 是给定的归一化波函数。自然轨道占据数是 $\\gamma$ 的本征值，位于区间 $[0,2]$ 内，其总和为 $N=4$。\n\n对于下方的每个测试用例，波函数由一个闭壳层行列式列表和实数系数指定。每个行列式由无序对 $\\{i,j\\}$ 表示，其中 $1 \\le i  j \\le M$，表示在该行列式中轨道 $\\phi_i$ 和 $\\phi_j$ 是双占据的。波函数为\n$$\n\\rvert \\Psi \\rangle \\;=\\; \\sum_{k=1}^{K} c_k \\,\\rvert D_k \\rangle,\n$$\n其中 $\\sum_{k=1}^{K} c_k^2 = 1$，且每个 $\\rvert D_k \\rangle$ 都是一个闭壳层行列式。\n\n你的任务：\n- 对于每个测试用例，根据给定的 $\\rvert \\Psi \\rangle$ 构建如上定义的自旋求和的单粒子约化密度矩阵 $\\gamma$。\n- 计算作为 $\\gamma$ 本征值的自然轨道占据数。\n- 将占据数按非递增顺序排序。\n- 报告排序后的占据数，四舍五入到 $6$ 位小数。\n\n不涉及物理单位。不出现角度。输出必须是数值。\n\n测试套件：\n- 测试用例 1（单行列式闭壳层）：\n  - $M=4$，行列式：$\\{1,2\\}$，系数为 $c_1=1$。\n- 测试用例 2（对取代行列式的关联叠加）：\n  - $M=4$，行列式与系数：\n    - $\\{1,2\\}$，系数为 $c_1=\\sqrt{\\tfrac{7}{10}}$，\n    - $\\{1,3\\}$，系数为 $c_2=\\sqrt{\\tfrac{2}{10}}$，\n    - $\\{2,4\\}$，系数为 $c_3=\\sqrt{\\tfrac{1}{10}}$。\n- 测试用例 3（两个行列式之间最大离域的边缘情况）：\n  - $M=4$，行列式与系数：\n    - $\\{1,2\\}$，系数为 $c_1=\\tfrac{1}{\\sqrt{2}}$，\n    - $\\{3,4\\}$，系数为 $c_2=\\tfrac{1}{\\sqrt{2}}$。\n\n最终输出格式：\n- 你的程序应生成单行输出，包含一个由方括号括起来的逗号分隔列表，其中每个项目是对应一个测试用例的、经过四舍五入和排序的自然轨道占据数列表。例如，输出格式必须为\n$[ [x_{1,1},x_{1,2},x_{1,3},x_{1,4}], [x_{2,1},x_{2,2},x_{2,3},x_{2,4}], [x_{3,1},x_{3,2},x_{3,3},x_{3,4}] ]$\n无额外文本。", "solution": "### 解决方案\n目标是计算自然轨道占据数，即自旋求和的单粒子约化密度矩阵 $\\gamma$ 的本征值。该矩阵的矩阵元由以下表达式给出：\n$$ \\gamma_{pq} = \\langle \\Psi \\lvert \\hat{E}_{pq} \\rvert \\Psi \\rangle $$\n其中 $\\hat{E}_{pq} = \\sum_{\\sigma \\in \\{\\alpha,\\beta\\}} \\hat{a}^{\\dagger}_{p\\sigma} \\hat{a}_{q\\sigma}$ 是从轨道 $q$ 到 $p$ 的单电子激发算符。波函数 $\\rvert \\Psi \\rangle$ 是闭壳层行列式的线性组合：\n$$ \\rvert \\Psi \\rangle = \\sum_{k=1}^{K} c_k \\rvert D_k \\rangle $$\n将其代入 $\\gamma_{pq}$ 的表达式中，得到：\n$$ \\gamma_{pq} = \\left\\langle \\sum_k c_k \\rvert D_k \\rangle \\left\\lvert \\hat{E}_{pq} \\right\\rvert \\sum_l c_l \\rvert D_l \\rangle \\right\\rangle = \\sum_{k,l} c_k c_l \\langle D_k \\lvert \\hat{E}_{pq} \\rvert D_l \\rangle $$\n根据斯莱特-康登规则，单体算符 $\\hat{E}_{pq}$ 只能连接相差最多一个自旋轨道的行列式。然而，在本问题中，所有行列式 $\\rvert D_k \\rangle$ 和 $\\rvert D_l \\rangle$ 都是闭壳层类型。任何两个不同的闭壳层行列式至少相差一个双占据轨道，即相差两个电子。因此，单体算符在两个不同闭壳层行列式之间的矩阵元严格为零：$\\langle D_k \\lvert \\hat{E}_{pq} \\rvert D_l \\rangle = 0$ 对于 $k \\neq l$。\n\n这一观察极大地简化了 $\\gamma_{pq}$ 的表达式，因为只有 $k=l$ 的项在求和中保留下来：\n$$ \\gamma_{pq} = \\sum_k c_k^2 \\langle D_k \\lvert \\hat{E}_{pq} \\rvert D_k \\rangle $$\n对于剩下的期望值：如果 $p \\neq q$，$\\langle D_k \\lvert \\hat{E}_{pq} \\rvert D_k \\rangle = 0$。如果 $p=q$，$\\hat{E}_{pp}$ 是轨道 $\\phi_p$ 的粒子数算符，其期望值为轨道 $\\phi_p$ 在 $\\rvert D_k \\rangle$ 中的占据数，即当 $\\phi_p$ 被占据时为2，否则为0。\n\n因此，$\\gamma$ 矩阵在空间轨道基底下是对角的，其对角元（即自然轨道占据数 $n_p$）为：\n$$ n_p = \\gamma_{pp} = 2 \\sum_{k \\text{ s.t. } p \\in O_k} c_k^2 $$\n其中求和遍及所有包含双占据轨道 $\\phi_p$ 的行列式 $\\rvert D_k \\rangle$。\n\n**测试用例 1：** $\\rvert\\Psi\\rangle = 1.0 \\cdot \\rvert D_{\\{1,2\\}} \\rangle$\n- $c_1^2=1.0$。行列式涉及轨道 $\\{1,2\\}$。\n- $n_1 = 2 \\times 1.0 = 2.0$\n- $n_2 = 2 \\times 1.0 = 2.0$\n- $n_3 = 0.0$\n- $n_4 = 0.0$\n- 排序后的占据数：$[2.000000, 2.000000, 0.000000, 0.000000]$。\n\n**测试用例 2：** $\\rvert\\Psi\\rangle = \\sqrt{0.7} \\rvert D_{\\{1,2\\}} \\rangle + \\sqrt{0.2} \\rvert D_{\\{1,3\\}} \\rangle + \\sqrt{0.1} \\rvert D_{\\{2,4\\}} \\rangle$\n- $c_1^2=0.7$ 对应 $\\{1,2\\}$；$c_2^2=0.2$ 对应 $\\{1,3\\}$；$c_3^2=0.1$ 对应 $\\{2,4\\}$。\n- $n_1 = 2 \\times (c_1^2 + c_2^2) = 2 \\times (0.7 + 0.2) = 1.8$\n- $n_2 = 2 \\times (c_1^2 + c_3^2) = 2 \\times (0.7 + 0.1) = 1.6$\n- $n_3 = 2 \\times c_2^2 = 2 \\times 0.2 = 0.4$\n- $n_4 = 2 \\times c_3^2 = 2 \\times 0.1 = 0.2$\n- 排序后的占据数：$[1.800000, 1.600000, 0.400000, 0.200000]$。\n\n**测试用例 3：** $\\rvert\\Psi\\rangle = \\frac{1}{\\sqrt{2}} \\rvert D_{\\{1,2\\}} \\rangle + \\frac{1}{\\sqrt{2}} \\rvert D_{\\{3,4\\}} \\rangle$\n- $c_1^2=0.5$ 对应 $\\{1,2\\}$；$c_2^2=0.5$ 对应 $\\{3,4\\}$。\n- $n_1 = 2 \\times c_1^2 = 2 \\times 0.5 = 1.0$\n- $n_2 = 2 \\times c_1^2 = 2 \\times 0.5 = 1.0$\n- $n_3 = 2 \\times c_2^2 = 2 \\times 0.5 = 1.0$\n- $n_4 = 2 \\times c_2^2 = 2 \\times 0.5 = 1.0$\n- 排序后的占据数：$[1.000000, 1.000000, 1.000000, 1.000000]$。", "answer": "[[2.000000, 2.000000, 0.000000, 0.000000], [1.800000, 1.600000, 0.400000, 0.200000], [1.000000, 1.000000, 1.000000, 1.000000]]", "id": "2455920"}]}