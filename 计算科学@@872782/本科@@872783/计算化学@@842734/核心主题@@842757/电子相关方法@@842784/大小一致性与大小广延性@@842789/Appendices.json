{"hands_on_practices": [{"introduction": "理论是基础，但实践是检验其真伪的唯一标准。让我们从一个基本练习开始：用数值方法直接检验尺寸一致性的定义。这个练习的核心原则很简单——两个不相互作用的系统的总能量，应该等于它们各自能量的总和。我们将利用一些常见量子化学方法（如Hartree-Fock、CCSD、MP2和CISD）计算得到的模拟数据，通过编写一个简单的程序来检验哪些方法在给定的容差$|E_{\\text{dimer}} - 2 E_{\\text{mono}}| \\le \\tau$下满足尺寸一致性。这项练习将帮助你牢固掌握尺寸一致性的基本概念和量化标准。", "problem": "使用两个在大的单电子基组中并于 Born–Oppenheimer 近似下处理的、充分分离的氦原子，构建一个用于电子结构方法的尺寸一致性的程序化定量测试。其基本依据是无相互作用子系统能量的可加性：当总哈密顿量分解为直和时，能量是相加的。形式上，设子系统的哈密顿量为 $H_A$ 和 $H_B$，作用于不相交的希尔伯特空间，在大间距 $R$ 下子系统间的相互作用可忽略不计。复合哈密顿量为 $H = H_A \\oplus H_B$，因此当子系统无相互作用时，基态能量满足 $E(A + B) = E(A) + E(B)$。尺寸一致性是一种性质，即当 $A$ 和 $B$ 不相互作用时，一个方法返回 $E_{\\text{method}}(A + B) = E_{\\text{method}}(A) + E_{\\text{method}}(B)$。对于两个相同的原子，在足够大的原子间距 $R$ 下，这简化为 $E_{\\text{method}}(\\text{He}\\cdot\\text{He}) = 2 E_{\\text{method}}(\\text{He})$。\n\n基于此，设计一个数值化的通过/不通过（pass/fail）测试来检验尺寸一致性，定义如下。对于给定的方法、间距 $R$（单位为玻尔）、在相同理论水平和基组下计算的单体能量 $E_{\\text{mono}}$（单位为哈特里）和二聚体能量 $E_{\\text{dimer}}$（单位为哈特里），以及一个容差 $\\tau$（单位为哈特里），该方法当且仅当满足以下条件时通过检验：\n$$\n\\left| E_{\\text{dimer}} - 2 E_{\\text{mono}} \\right| \\le \\tau.\n$$\n所有能量单位必须是哈特里，$R$ 必须足够大以使相互作用可忽略不计。\n\n实现一个程序，给定以下测试套件，输出一个布尔值列表，指明在每种情况下该方法在指定容差内是否具有尺寸一致性。提供原子间距 $R$ 是为了科学上的完整性，但它不直接进入数值判据（它为无相互作用的假设提供了依据）。\n\n使用以下测试套件，旨在探究在大基组下（其中基组重叠误差可以忽略不计）的各种情况：\n- 情况1 (Hartree–Fock)：$R = 30.0$ 玻尔, $E_{\\text{mono}} = -2.861679995$ 哈特里, $E_{\\text{dimer}} = -5.723356990$ 哈特里, $\\tau = 1\\times 10^{-5}$ 哈特里。\n- 情况2 (Coupled Cluster with Singles and Doubles)：$R = 50.0$ 玻尔, $E_{\\text{mono}} = -2.902786500$ 哈特里, $E_{\\text{dimer}} = -5.805572990$ 哈特里, $\\tau = 1\\times 10^{-5}$ 哈特里。\n- 情况3 (Second-Order Møller–Plesset Perturbation Theory)：$R = 40.0$ 玻尔, $E_{\\text{mono}} = -2.902350000$ 哈特里, $E_{\\text{dimer}} = -5.804698000$ 哈特里, $\\tau = 1\\times 10^{-5}$ 哈特里。\n- 情况4 (Configuration Interaction with Singles and Doubles)：$R = 30.0$ 玻尔, $E_{\\text{mono}} = -2.902500000$ 哈特里, $E_{\\text{dimer}} = -5.804800000$ 哈特里, $\\tau = 1\\times 10^{-5}$ 哈特里。\n- 情况5 (边界情况)：$R = 35.0$ 玻尔, $E_{\\text{mono}} = -2.900000000$ 哈特里, $E_{\\text{dimer}} = -5.800010000$ 哈特里, $\\tau = 1\\times 10^{-5}$ 哈特里。\n\n您的程序必须：\n- 对于每种情况，计算绝对偏差 $\\left| E_{\\text{dimer}} - 2 E_{\\text{mono}} \\right|$ 并与 $\\tau$ 比较。\n- 对每种情况返回一个布尔值：如果不等式成立则为 $\\,\\text{True}$，否则为 $\\,\\text{False}$。\n\n最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的、逗号分隔的结果列表（例如，\"[True,False,True,True,False]\"）。", "solution": "所述问题在科学上是合理的、内容自洽且定义明确。它为尺寸一致性这一基本的量子化学性质定义了一个正确且定量的测试。所提供的数据是符合实际的，并用于阐释几种标准电子结构方法的已知行为。我们将进行分析。\n\n尺寸一致性的概念是任何可靠的量子化学方法的关键要求。它规定，一个由两个无相互作用的子系统 $A$ 和 $B$ 组成的系统的能量，必须等于各个子系统能量的总和。如果总哈密顿量 $H$ 可以写成子系统哈密顿量的直和，即 $H = H_A \\oplus H_B$，那么总能量必须是可加的：$E(A + B) = E(A) + E(B)$。\n\n该问题指定了一个包含两个相同的、充分分离的氦原子的场景，其中相互作用能可忽略不计。在这种情况下，尺寸一致性判据得以简化。设 $E_{\\text{mono}}$ 为单个氦原子的能量，$E_{\\text{dimer}}$ 为在大分离距离 $R$ 下双原子系统（“二聚体”）的能量。一个尺寸一致的方法必须满足关系式 $E_{\\text{dimer}} = 2 E_{\\text{mono}}$。\n\n该问题基于一个容差 $\\tau$ 定义了一个用于尺寸一致性的数值测试。如果与严格可加性的绝对偏差在此容差范围内，则认为该方法是尺寸一致的：\n$$\n\\left| E_{\\text{dimer}} - 2 E_{\\text{mono}} \\right| \\le \\tau\n$$\n我们将尺寸一致性误差定义为 $\\Delta E_{\\text{SC}} = E_{\\text{dimer}} - 2 E_{\\text{mono}}$。因此，该测试就是检查是否 $|\\Delta E_{\\text{SC}}| \\le \\tau$。\n\n我们现在评估所提供的五个测试案例。\n\n情况1：Hartree–Fock (HF)\n给定：$E_{\\text{mono}} = -2.861679995$ 哈特里, $E_{\\text{dimer}} = -5.723356990$ 哈特里, 以及 $\\tau = 1 \\times 10^{-5}$ 哈特里。\n尺寸一致性误差为：\n$$\n\\Delta E_{\\text{SC}} = -5.723356990 - 2 \\times (-2.861679995) = -5.723356990 + 5.723359990 = 0.000003000 \\text{ 哈特里}\n$$\n我们检验该条件：\n$$\n|\\Delta E_{\\text{SC}}| = |0.000003000| = 3.0 \\times 10^{-6} \\le 1 \\times 10^{-5}\n$$\n条件满足。结果是 $\\text{True}$。这是预料之中的，因为 Hartree-Fock 方法是尺寸一致的。\n\n情况2：单双激发耦合簇理论 (Coupled Cluster with Singles and Doubles, CCSD)\n给定：$E_{\\text{mono}} = -2.902786500$ 哈特里, $E_{\\text{dimer}} = -5.805572990$ 哈特里, 以及 $\\tau = 1 \\times 10^{-5}$ 哈特里。\n尺寸一致性误差为：\n$$\n\\Delta E_{\\text{SC}} = -5.805572990 - 2 \\times (-2.902786500) = -5.805572990 + 5.805573000 = 0.000000010 \\text{ 哈特里}\n$$\n我们检验该条件：\n$$\n|\\Delta E_{\\text{SC}}| = |0.000000010| = 1.0 \\times 10^{-8} \\le 1 \\times 10^{-5}\n$$\n条件满足。结果是 $\\text{True}$。这是预料之中的，因为所有标准的耦合簇方法都是尺寸一致的。\n\n情况3：二阶 Møller–Plesset 微扰理论 (MP2)\n给定：$E_{\\text{mono}} = -2.902350000$ 哈特里, $E_{\\text{dimer}} = -5.804698000$ 哈特里, 以及 $\\tau = 1 \\times 10^{-5}$ 哈特里。\n尺寸一致性误差为：\n$$\n\\Delta E_{\\text{SC}} = -5.804698000 - 2 \\times (-2.902350000) = -5.804698000 + 5.804700000 = 0.000002000 \\text{ 哈特里}\n$$\n我们检验该条件：\n$$\n|\\Delta E_{\\text{SC}}| = |0.000002000| = 2.0 \\times 10^{-6} \\le 1 \\times 10^{-5}\n$$\n条件满足。结果是 $\\text{True}$。这是预料之中的，因为任意有限阶的 Møller–Plesset 微扰理论都是尺寸一致的。\n\n情况4：单双激发组态相互作用 (Configuration Interaction with Singles and Doubles, CISD)\n给定：$E_{\\text{mono}} = -2.902500000$ 哈特里, $E_{\\text{dimer}} = -5.804800000$ 哈特里, 以及 $\\tau = 1 \\times 10^{-5}$ 哈特里。\n尺寸一致性误差为：\n$$\n\\Delta E_{\\text{SC}} = -5.804800000 - 2 \\times (-2.902500000) = -5.804800000 + 5.805000000 = 0.000200000 \\text{ 哈特里}\n$$\n我们检验该条件：\n$$\n|\\Delta E_{\\text{SC}}| = |0.000200000| = 2.0 \\times 10^{-4} \\le 1 \\times 10^{-5}\n$$\n条件不满足，因为 $2.0 \\times 10^{-4} > 1 \\times 10^{-5}$。结果是 $\\text{False}$。这是截断的组态相互作用方法失败的典型例子。对于二聚体，每个单体上的单激发产物（例如，$c_{i \\to a}^\\dagger c_{k \\to c}^\\dagger |\\Phi_0\\rangle$）表现为双激发，但也存在四激发（例如，每个单体上的双激发产物），而这些四激发被排除在 CISD 波函数拟设之外。这种不平衡导致了尺寸一致性的缺失。\n\n情况5：边界情况\n给定：$E_{\\text{mono}} = -2.900000000$ 哈特里, $E_{\\text{dimer}} = -5.800010000$ 哈特里, 以及 $\\tau = 1 \\times 10^{-5}$ 哈特里。\n尺寸一致性误差为：\n$$\n\\Delta E_{\\text{SC}} = -5.800010000 - 2 \\times (-2.900000000) = -5.800010000 + 5.800000000 = -0.000010000 \\text{ 哈特里}\n$$\n我们检验该条件，注意这里使用的是小于等于：\n$$\n|\\Delta E_{\\text{SC}}| = |-0.000010000| = 1.0 \\times 10^{-5} \\le 1 \\times 10^{-5}\n$$\n条件满足，因为绝对偏差恰好等于容差。结果是 $\\text{True}$。\n\n总而言之，结果是：HF($\\text{True}$), CCSD($\\text{True}$), MP2($\\text{True}$), CISD($\\text{False}$), Boundary($\\text{True}$)。程序实现将把这一逻辑代码化。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\n# No external libraries are necessary for this calculation.\n\ndef solve():\n    \"\"\"\n    Performs a quantitative test of size consistency for several electronic\n    structure methods based on provided energy data.\n    \"\"\"\n    # The test suite provides data for five cases. Each tuple contains:\n    # (Method Name, R, E_mono, E_dimer, tolerance)\n    # R (separation in bohr) is provided for context but not used in the calculation.\n    test_cases = [\n        # Case 1 (Hartree–Fock)\n        (\"HF\", 30.0, -2.861679995, -5.723356990, 1e-5),\n        # Case 2 (Coupled Cluster with Singles and Doubles)\n        (\"CCSD\", 50.0, -2.902786500, -5.805572990, 1e-5),\n        # Case 3 (Second-Order Møller–Plesset Perturbation Theory)\n        (\"MP2\", 40.0, -2.902350000, -5.804698000, 1e-5),\n        # Case 4 (Configuration Interaction with Singles and Doubles)\n        (\"CISD\", 30.0, -2.902500000, -5.804800000, 1e-5),\n        # Case 5 (Boundary case)\n        (\"Boundary\", 35.0, -2.900000000, -5.800010000, 1e-5),\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack the tuple for clarity. The method name and R are not needed for the check.\n        _, _, e_mono, e_dimer, tau = case\n\n        # Calculate the absolute deviation from size consistency.\n        # The condition is |E_dimer - 2 * E_mono| = tau.\n        deviation = abs(e_dimer - 2.0 * e_mono)\n\n        # The method passes the test if the deviation is within the tolerance.\n        # The comparison is inclusive (=).\n        passes_test = deviation = tau\n        results.append(passes_test)\n\n    # The final output must be a single string: a comma-separated list of\n    # booleans enclosed in square brackets.\n    # The map(str, ...) function correctly converts True to \"True\" and False to \"False\".\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2805734"}, {"introduction": "在真实的计算中，情况往往更为复杂。当我们把两个分子放在一起时，即便它们相距很远，有限基组的使用也会引入一种名为“基组叠加误差”（BSSE）的计算赝象。这个练习设计了一个巧妙的“玩具模型”，旨在帮助你清晰地区分方法的内在尺寸不一致性误差与BSSE。通过实践Boys–Bernardi反向校正法（counterpoise correction），你将学会如何剥离BSSE，从而精确地分离并观察到尺寸不一致性误差本身，这是进行高精度相互作用能计算的一项关键技能。", "problem": "要求您构建一个精确、自洽的计算实验，为氦二聚体在数学上分离双激发组态相互作用 (CID) 的尺寸一致性误差与基组重叠误差 (BSSE)。目标是实现一个简化的、但有原理支持的玩具模型，该模型能够捕捉这两种误差的数学结构，并使用 Boys–Bernardi 平衡校正来消除 BSSE，从而揭示残留的尺寸一致性误差。所有能量单位必须为 Hartree，距离单位必须为 ångström。\n\n背景与模型假设：\n- 在多电子方法中，如果两个无相互作用子系统的总能量等于它们各自能量之和，则该方法称为尺寸一致的。像双激发组态相互作用 (CID) 这类非尺寸一致的方法违反了此性质。\n- 基组重叠误差 (BSSE) 的产生是由于在有限基组中，两个片段可以通过“借用”彼此的基函数来虚假地降低其能量。Boys–Bernardi 平衡校正通过在二聚体基组中（使用鬼函数）评估单体能量来估计并减去这种虚假的稳定化效应。\n\n您必须实现以下物理上合理的玩具模型，该模型定量地编码了这些定义：\n\n1) 单体相关模型：\n- 令单体基组质量参数为 $q \\in \\mathbb{R}_{0}$。真实单体相关能建模为\n$$\nC_{\\mathrm{true}}(q) \\;=\\; -C_{\\infty}\\,\\frac{q}{q+q_{0}},\n$$\n其中 $C_{\\infty} = 0.042$ Hartree， $q_{0} = 1.0$。\n- CID 单体相关能被建模为真实相关能的一个恒定比例：\n$$\nC_{\\mathrm{CID}}(q) \\;=\\; s_{\\mathrm{CID}}\\,C_{\\mathrm{true}}(q),\n$$\n其中 $s_{\\mathrm{CID}} = 0.9$。\n- 氦的 Hartree–Fock 参考能量被视为一个常数\n$$\nE_{\\mathrm{ref}} = -2.8617 \\;\\text{Hartree}.\n$$\n因此，CID 水平上的孤立单体能量为\n$$\nE_{\\mathrm{mono}}^{\\mathrm{iso}}(q) \\;=\\; E_{\\mathrm{ref}} + C_{\\mathrm{CID}}(q).\n$$\n\n2) 无真实相互作用的二聚体能量模型：\n- 为了分离误差，我们将真实相互作用势设为恒等于零，因此对相互作用能的唯一贡献是方法引入的赝象（尺寸不一致性和 BSSE）。\n\n3) CID 的尺寸一致性误差（交叉项）：\n- 对于两个具有基组质量 $q_A$ 和 $q_B$ 的无相互作用单体，CID 二聚体获得一个虚假的交叉项，该项与单体相关能的乘积成比例：\n$$\n\\Delta_{\\mathrm{SCE}}(q_A,q_B) \\;=\\; \\gamma \\,\\frac{C_{\\mathrm{CID}}(q_A)\\,C_{\\mathrm{CID}}(q_B)}{C_{\\mathrm{scale}}},\n$$\n其中 $\\gamma = 0.02$，$C_{\\mathrm{scale}} = 0.05$ Hartree。此项与分离距离无关，反映了 CID 缺乏尺寸广延性。\n\n4) 基组重叠误差 (BSSE)：\n- 令原子间距为 $R$（单位为 ångström）。定义一个类重叠衰减函数\n$$\nS(R) = e^{-kR}, \\quad k = 1.2 \\;\\text{å}^{-1}.\n$$\n- 单体的 BSSE 稳定化（当使用伙伴的鬼基组时）建模为\n$$\n\\Delta_{\\mathrm{BSSE}}^{A}(R,q_A) \\;=\\; -\\beta \\,S(R)\\,\\frac{1}{1+q_A}, \\qquad\n\\Delta_{\\mathrm{BSSE}}^{B}(R,q_B) \\;=\\; -\\beta \\,S(R)\\,\\frac{1}{1+q_B},\n$$\n其中 $\\beta = 0.02$ Hartree。总的二聚体 BSSE 是各单体贡献之和：\n$$\n\\Delta_{\\mathrm{BSSE}}^{\\mathrm{dimer}}(R,q_A,q_B) \\;=\\; \\Delta_{\\mathrm{BSSE}}^{A}(R,q_A) + \\Delta_{\\mathrm{BSSE}}^{B}(R,q_B).\n$$\n\n5) 需要计算的能量：\n- 未校正的二聚体能量（无平衡校正），忽略任何真实相互作用：\n$$\nE^{\\mathrm{uncorr}}_{\\mathrm{dimer}}(R,q_A,q_B)\n= \\big[E_{\\mathrm{ref}} + C_{\\mathrm{CID}}(q_A)\\big]\n  + \\big[E_{\\mathrm{ref}} + C_{\\mathrm{CID}}(q_B)\\big]\n  + \\Delta_{\\mathrm{SCE}}(q_A,q_B)\n  + \\Delta_{\\mathrm{BSSE}}^{\\mathrm{dimer}}(R,q_A,q_B).\n$$\n- 二聚体基组中的单体能量（平衡校正项）：\n$$\nE^{\\ast}_A(R,q_A) = E_{\\mathrm{ref}} + C_{\\mathrm{CID}}(q_A) + \\Delta_{\\mathrm{BSSE}}^{A}(R,q_A), \\quad\nE^{\\ast}_B(R,q_B) = E_{\\mathrm{ref}} + C_{\\mathrm{CID}}(q_B) + \\Delta_{\\mathrm{BSSE}}^{B}(R,q_B).\n$$\n\n6) 相互作用能：\n- 未校正的相互作用能：\n$$\n\\Delta E_{\\mathrm{int}}^{\\mathrm{uncorr}}(R,q_A,q_B) \\;=\\;\nE^{\\mathrm{uncorr}}_{\\mathrm{dimer}}(R,q_A,q_B) \\;-\\; \\big[E_{\\mathrm{mono}}^{\\mathrm{iso}}(q_A) + E_{\\mathrm{mono}}^{\\mathrm{iso}}(q_B)\\big].\n$$\n- 平衡校正后的相互作用能：\n$$\n\\Delta E_{\\mathrm{int}}^{\\mathrm{CP}}(R,q_A,q_B) \\;=\\;\nE^{\\mathrm{uncorr}}_{\\mathrm{dimer}}(R,q_A,q_B) \\;-\\; \\big[E^{\\ast}_A(R,q_A) + E^{\\ast}_B(R,q_B)\\big].\n$$\n\n目标量：\n- 证明平衡校正后的相互作用能分离出了尺寸一致性误差：\n$$\n\\Delta E_{\\mathrm{int}}^{\\mathrm{CP}}(R,q_A,q_B) \\;=\\; \\Delta_{\\mathrm{SCE}}(q_A,q_B).\n$$\n您的程序应为每个测试用例计算此分离出的尺寸一致性误差，并仅输出这些值。\n\n要求：\n- 严格按照上述规定实现模型。\n- 能量必须以 Hartree 为单位，并四舍五入到六位小数。\n- 距离必须使用 ångström 作为单位。\n\n测试套件：\n为以下五个参数集 $(R, q_A, q_B)$ 提供结果：\n- 案例 $1$：$R = 1.0$ ångström, $q_A = 1.0$, $q_B = 1.0$。\n- 案例 $2$：$R = 3.0$ ångström, $q_A = 1.0$, $q_B = 1.0$。\n- 案例 $3$：$R = 10.0$ ångström, $q_A = 1.0$, $q_B = 1.0$。\n- 案例 $4$：$R = 3.0$ ångström, $q_A = 0.5$, $q_B = 2.0$。\n- 案例 $5$：$R = 3.0$ ångström, $q_A = 5.0$, $q_B = 5.0$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含五个案例的分离出的尺寸一致性误差，表示为一个由方括号括起来的、逗号分隔的六位小数浮点数列表，例如，“[0.000000,0.000000,0.000000,0.000000,0.000000]”。", "solution": "问题陈述已经过严格验证。这是一个良构的、自洽的、且科学上合理的教学练习。它提出了一个简化的、但有原理支持的“玩具模型”，用于在量子化学中演示尺寸一致性误差 (SCE) 和基组重叠误差 (BSSE) 的不同数学性质，并说明 Boys-Bernardi 平衡 (CP) 校正的功能。所有定义、常数和函数形式都已明确无误地给出。因此，该问题被认为是有效的，并将提供解决方案。\n\n目标是证明在该模型中，经过平衡校正的相互作用能 $\\Delta E_{\\mathrm{int}}^{\\mathrm{CP}}$ 通过消除基组重叠误差，从而正确地分离出尺寸一致性误差 $\\Delta_{\\mathrm{SCE}}$。我们将首先通过代数方法证明这一点，然后为指定的测试用例计算这个分离出的误差的值。\n\n平衡校正后的相互作用能定义为：\n$$\n\\Delta E_{\\mathrm{int}}^{\\mathrm{CP}}(R,q_A,q_B) \\;=\\; E^{\\mathrm{uncorr}}_{\\mathrm{dimer}}(R,q_A,q_B) \\;-\\; \\big[E^{\\ast}_A(R,q_A) + E^{\\ast}_B(R,q_B)\\big]\n$$\n我们将右侧各项的给定表达式代入。未校正的二聚体能量为：\n$$\nE^{\\mathrm{uncorr}}_{\\mathrm{dimer}}(R,q_A,q_B) = \\big[E_{\\mathrm{ref}} + C_{\\mathrm{CID}}(q_A)\\big] + \\big[E_{\\mathrm{ref}} + C_{\\mathrm{CID}}(q_B)\\big] + \\Delta_{\\mathrm{SCE}}(q_A,q_B) + \\Delta_{\\mathrm{BSSE}}^{\\mathrm{dimer}}(R,q_A,q_B)\n$$\n在二聚体基组中计算的单体能量之和（平衡校正项）为：\n$$\nE^{\\ast}_A(R,q_A) + E^{\\ast}_B(R,q_B) = \\big[E_{\\mathrm{ref}} + C_{\\mathrm{CID}}(q_A) + \\Delta_{\\mathrm{BSSE}}^{A}(R,q_A)\\big] + \\big[E_{\\mathrm{ref}} + C_{\\mathrm{CID}}(q_B) + \\Delta_{\\mathrm{BSSE}}^{B}(R,q_B)\\big]\n$$\n根据定义，总的二聚体 BSSE 是各单体 BSSE 贡献之和：$\\Delta_{\\mathrm{BSSE}}^{\\mathrm{dimer}}(R,q_A,q_B) = \\Delta_{\\mathrm{BSSE}}^{A}(R,q_A) + \\Delta_{\\mathrm{BSSE}}^{B}(R,q_B)$。因此，经过平衡校正的单体能量之和可以重写为：\n$$\nE^{\\ast}_A(R,q_A) + E^{\\ast}_B(R,q_B) = \\big[E_{\\mathrm{ref}} + C_{\\mathrm{CID}}(q_A)\\big] + \\big[E_{\\mathrm{ref}} + C_{\\mathrm{CID}}(q_B)\\big] + \\Delta_{\\mathrm{BSSE}}^{\\mathrm{dimer}}(R,q_A,q_B)\n$$\n现在，我们将这些展开形式代回到 $\\Delta E_{\\mathrm{int}}^{\\mathrm{CP}}$ 的表达式中：\n$$\n\\Delta E_{\\mathrm{int}}^{\\mathrm{CP}} = \\Big( \\big[E_{\\mathrm{ref}} + C_{\\mathrm{CID}}(q_A)\\big] + \\big[E_{\\mathrm{ref}} + C_{\\mathrm{CID}}(q_B)\\big] + \\Delta_{\\mathrm{SCE}}(q_A,q_B) + \\Delta_{\\mathrm{BSSE}}^{\\mathrm{dimer}} \\Big) - \\Big( \\big[E_{\\mathrm{ref}} + C_{\\mathrm{CID}}(q_A)\\big] + \\big[E_{\\mathrm{ref}} + C_{\\mathrm{CID}}(q_B)\\big] + \\Delta_{\\mathrm{BSSE}}^{\\mathrm{dimer}} \\Big)\n$$\n相减后，除尺寸一致性误差项外，所有项都相互抵消。与参考能量、单体相关能以及基组重叠误差相关的项，都通过平衡校正方案被完美地移除了，这正是此模型的设计初衷。最终剩下：\n$$\n\\Delta E_{\\mathrm{int}}^{\\mathrm{CP}}(R,q_A,q_B) \\;=\\; \\Delta_{\\mathrm{SCE}}(q_A,q_B)\n$$\n这个代数证明证实了该程序能正确地分离出尺寸一致性误差。同样显而易见的是，这个分离出的误差 $\\Delta_{\\mathrm{SCE}}$ 与原子间距 $R$ 无关，这是无相互作用片段的尺寸一致性误差的一个基本特征。\n\n计算任务简化为为五个给定的测试用例计算 $\\Delta_{\\mathrm{SCE}}(q_A, q_B)$。公式为：\n$$\n\\Delta_{\\mathrm{SCE}}(q_A,q_B) \\;=\\; \\gamma \\,\\frac{C_{\\mathrm{CID}}(q_A)\\,C_{\\mathrm{CID}}(q_B)}{C_{\\mathrm{scale}}}\n$$\n其中 $C_{\\mathrm{CID}}(q)$ 本身由下式给出：\n$$\nC_{\\mathrm{CID}}(q) \\;=\\; s_{\\mathrm{CID}}\\,C_{\\mathrm{true}}(q) \\;=\\; s_{\\mathrm{CID}}\\,\\left(-C_{\\infty}\\,\\frac{q}{q+q_{0}}\\right)\n$$\n代入常数 $C_{\\infty} = 0.042$，$q_{0} = 1.0$，$s_{\\mathrm{CID}} = 0.9$，$\\gamma = 0.02$ 和 $C_{\\mathrm{scale}} = 0.05$，我们将为每个参数集 $(R, q_A, q_B)$ 计算这个量。\n\n案例 1：$(R=1.0, q_A=1.0, q_B=1.0)$\n$C_{\\mathrm{CID}}(1.0) = 0.9 \\left(-0.042 \\times \\frac{1.0}{1.0+1.0}\\right) = -0.0189$\n$\\Delta_{\\mathrm{SCE}}(1.0, 1.0) = 0.02 \\times \\frac{(-0.0189)^2}{0.05} = 0.000142884$\n\n案例 2：$(R=3.0, q_A=1.0, q_B=1.0)$\n结果与案例 1 相同，因为 $\\Delta_{\\mathrm{SCE}}$ 与 $R$ 无关。\n$\\Delta_{\\mathrm{SCE}}(1.0, 1.0) = 0.000142884$\n\n案例 3：$(R=10.0, q_A=1.0, q_B=1.0)$\n结果与案例 1 相同。\n$\\Delta_{\\mathrm{SCE}}(1.0, 1.0) = 0.000142884$\n\n案例 4：$(R=3.0, q_A=0.5, q_B=2.0)$\n$C_{\\mathrm{CID}}(0.5) = 0.9 \\left(-0.042 \\times \\frac{0.5}{0.5+1.0}\\right) = -0.0126$\n$C_{\\mathrm{CID}}(2.0) = 0.9 \\left(-0.042 \\times \\frac{2.0}{2.0+1.0}\\right) = -0.0252$\n$\\Delta_{\\mathrm{SCE}}(0.5, 2.0) = 0.02 \\times \\frac{(-0.0126) \\times (-0.0252)}{0.05} = 0.000127008$\n\n案例 5：$(R=3.0, q_A=5.0, q_B=5.0)$\n$C_{\\mathrm{CID}}(5.0) = 0.9 \\left(-0.042 \\times \\frac{5.0}{5.0+1.0}\\right) = -0.0315$\n$\\Delta_{\\mathrm{SCE}}(5.0, 5.0) = 0.02 \\times \\frac{(-0.0315)^2}{0.05} = 0.0003969$\n\n最终值四舍五入到六位小数后为：\n- 案例 1、2、3：$0.000143$\n- 案例 4：$0.000127$\n- 案例 5：$0.000397$\n\n以下程序将实现这些计算。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the isolated size-consistency error (SCE) for a toy model of a\n    helium dimer, based on the problem specification.\n    \"\"\"\n\n    # Define the constants from the problem statement.\n    C_inf = 0.042     # Hartree\n    q0 = 1.0          # dimensionless\n    s_CID = 0.9       # dimensionless\n    E_ref = -2.8617   # Hartree\n    gamma = 0.02      # dimensionless\n    C_scale = 0.05    # Hartree\n    k = 1.2           # 1/angstrom\n    beta = 0.02       # Hartree\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple (R, q_A, q_B)\n    test_cases = [\n        (1.0, 1.0, 1.0),  # Case 1\n        (3.0, 1.0, 1.0),  # Case 2\n        (10.0, 1.0, 1.0), # Case 3\n        (3.0, 0.5, 2.0),  # Case 4\n        (3.0, 5.0, 5.0),  # Case 5\n    ]\n\n    results = []\n\n    def compute_c_cid(q):\n        \"\"\"\n        Computes the CID monomer correlation energy C_CID(q).\n        \n        Args:\n            q (float): The monomer basis quality parameter.\n        \n        Returns:\n            float: The CID correlation energy in Hartree.\n        \"\"\"\n        c_true = -C_inf * (q / (q + q0))\n        c_cid = s_CID * c_true\n        return c_cid\n\n    def compute_delta_sce(q_A, q_B):\n        \"\"\"\n        Computes the size-consistency error Δ_SCE(q_A, q_B).\n        \n        Args:\n            q_A (float): Basis quality parameter for monomer A.\n            q_B (float): Basis quality parameter for monomer B.\n            \n        Returns:\n            float: The size-consistency error in Hartree.\n        \"\"\"\n        c_cid_A = compute_c_cid(q_A)\n        c_cid_B = compute_c_cid(q_B)\n        delta_sce = gamma * (c_cid_A * c_cid_B) / C_scale\n        return delta_sce\n\n    for case in test_cases:\n        # The problem requires computing the isolated size-consistency error,\n        # which has been proven algebraically to be Δ_SCE(q_A, q_B).\n        # This quantity is independent of the separation R.\n        _R, q_A, q_B = case\n        \n        isolated_error = compute_delta_sce(q_A, q_B)\n        \n        # Round the result to six decimal places.\n        results.append(f\"{isolated_error:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2462360"}, {"introduction": "理解了尺寸一致性的定义和计算细节后，这项压轴练习将揭示我们为何如此重视这一性质。我们将模拟一个在材料科学中常见且重要的问题：通过计算小尺寸低聚物（oligomers）的性质，来外推预测无限长聚合物的带隙。这个练习将生动地展示，一个尺寸不一致的方法（如此处的CISD模型）将如何导致对宏观体系性质的错误预测，从而突显出尺寸一致性在连接微观计算与宏观性质预测中的关键作用。", "problem": "您需要编写一个完整、可运行的程序，在一个受控的合成环境中，演示尺寸一致性（size consistency）和尺寸广延性（size extensivity）如何影响沿一系列低聚物的强度性质（此处为带隙）的外推。其教育目标是将尺寸一致性和尺寸广延性的定义与一个可通过数学方法检验的外推任务联系起来，并量化尺寸不一致方法对推断的无限聚合物极限带隙所造成的后果。\n\n基本基础。使用以下标准定义和经过充分检验的事实作为起点：\n- 尺寸一致性：对于两个不相互作用的子系统 $A$ 和 $B$，一个尺寸一致的方法对于每个电子态都满足 $E(A+B)=E(A)+E(B)$。\n- 尺寸广延性：对于一个子系统的 $N$ 个相同且不相互作用的副本，像总相关能这样的广延量会随 $N$ 线性增长。\n- 对于长度为 $N$ 的准一维共轭低聚物，许多强度光谱性质（例如最低单重态激发能，通俗地称为带隙）会趋近于一个 $N\\to\\infty$ 的极限，其有限尺寸校正项会以 $N$ 的负幂次形式消失。这启发我们将真实带隙对 $N$ 的依赖性建模为一个关于 $1/N$ 的平滑函数。\n\n场景。考虑一个具有 $N$ 个共轭双键的多烯低聚物序列。设物理上正确（尺寸一致）的带隙序列由一个关于 $1/N$ 的平滑展开式表示：\n$$\nE_{\\mathrm{g,true}}(N)=E_{\\infty}+\\frac{a}{N}+\\frac{b}{N^{2}},\n$$\n其中 $E_{\\infty}$（单位：电子伏特）、$a$（单位：电子伏特）和 $b$（单位：电子伏特）是对于给定化学系列的常数。对于本测试而言，假定一种尺寸一致且尺寸广延的电子结构方法，如单双激发耦合簇理论（CCSD），能够在主导阶上恢复这种函数依赖关系。\n\n现在，引入一个与单双激发组态相互作用（CISD）相关的尺寸不一致性的通用模型：当基态和激发态的总能量各自包含一个在态之间不能严格抵消的非加和性相关误差时，预测的带隙会继承一个不随 $N$ 消失的残余偏差。为了在性质层面捕捉这种效应，让 CISD 预测的带隙遵循以下公式：\n$$\nE_{\\mathrm{g,CISD}}(N)=E_{\\mathrm{g,true}}(N)+\\delta_{0}+\\frac{\\delta_{1}}{N},\n$$\n其中 $\\delta_{0}$（单位：电子伏特）是一个由于尺寸不一致性而产生的、依赖于状态的残余非加和性偏移，在 $N\\to\\infty$ 时依然存在；$\\delta_{1}$（单位：电子伏特）则捕捉了次级的、依赖于状态的有限尺寸不匹配。\n\n您的任务。对于下方的每个测试用例：\n1. 通过对所提供的 $N$ 值设置 $E_{\\mathrm{g,CCSD}}(N)=E_{\\mathrm{g,true}}(N)$，生成合成的 CCSD 一致序列 $E_{\\mathrm{g,CCSD}}(N)$。\n2. 使用给定的 $\\delta_{0}$ 和 $\\delta_{1}$，为相同的 $N$ 值生成合成的 CISD 不一致序列 $E_{\\mathrm{g,CISD}}(N)$。\n3. 对每个序列分别使用形式为\n$$\nE_{\\mathrm{g}}(N)\\approx c_{0}+c_{1}\\left(\\frac{1}{N}\\right)+c_{2}\\left(\\frac{1}{N^{2}}\\right),\n$$\n的线性最小二乘拟合来估计无限聚合物极限，并报告拟合的截距 $c_{0}$ 作为外推的 $E_{\\infty}$（单位：电子伏特）。\n4. 对于每种方法（类 CCSD 和类 CISD）和每个测试用例，计算估计的 $E_{\\infty}$ 与测试用例中提供的真实 $E_{\\infty}$ 之间的绝对误差（单位：电子伏特）。\n\n数值和单位要求：\n- 所有带隙和误差必须以电子伏特（eV）表示。\n- 您的程序必须将每个报告的浮点输出四舍五入到六位小数。\n\n测试套件。使用以下参数集。每个测试用例是一个元组，包含：$N$ 值的列表；真实的 $E_{\\infty}$；用于 $E_{\\mathrm{g,true}}(N)$ 的系数 $a$ 和 $b$；以及 CISD 偏差参数 $\\delta_{0}$ 和 $\\delta_{1}$。所有能量单位均为电子伏特，$N$ 是无单位的。\n- 测试 1（通用理想路径）：$([4,6,8,12,16],\\,2.0,\\,6.0,\\,1.5,\\,0.2,\\,0.1)$\n- 测试 2（无尺寸不一致性）：$([4,8,12,20,40],\\,1.5,\\,4.0,\\,0.5,\\,0.0,\\,0.0)$\n- 测试 3（边界情况：最少拟合点）：$([5,10,20],\\,3.0,\\,3.0,\\,0.0,\\,-0.15,\\,0.0)$\n- 测试 4（强曲率和次级 CISD 不匹配）：$([6,7,8,12,24],\\,1.0,\\,10.0,\\,5.0,\\,0.05,\\,-0.2)$\n- 测试 5（大 $N$ 主导）：$([10,20,40,80,160],\\,0.8,\\,2.4,\\,0.4,\\,0.3,\\,0.0)$\n\n输出规格：\n- 对于每个测试用例，按此顺序将四个浮点数追加到结果列表中：类 CCSD 的外推 $E_{\\infty}$ 估计值、类 CISD 的外推 $E_{\\infty}$ 估计值、类 CCSD 估计值的绝对误差以及类 CISD 估计值的绝对误差。所有值必须以电子伏特为单位，每个值都四舍五入到六位小数。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果。例如，输出格式必须类似于\n\"[x11,x12,x13,x14,x21,x22,x23,x24,...]\"\n不含额外的空格或文本。\n\n您的实现必须是自包含的，无需用户输入，并遵守指定的执行环境。", "solution": "所提出的问题是计算科学中的一个有效练习。它具有科学依据，定义明确且客观。它正确地使用了简化但物理意义明确的模型来构建一个数值实验，以演示量子化学中的一个基本概念：尺寸一致性对于通过从小体系外推获得大体系正确性质的至关重要性。我们现在将着手解决此问题。\n\n核心任务是量化当使用尺寸不一致的理论方法时，将强度性质（电子带隙 $E_g$）外推至无限聚合物极限（$N \\to \\infty$）所引入的误差。我们获得了由“真实”或尺寸一致的方法（如 CCSD）和尺寸不一致的方法（如 CISD）计算的长度为 $N$ 的低聚物带隙模型。\n\n真实的带隙由以下函数形式给出：\n$$\nE_{\\mathrm{g,true}}(N) = E_{\\infty} + \\frac{a}{N} + \\frac{b}{N^2}\n$$\n这里，$E_{\\infty}$ 是无限聚合物的真实带隙，而带有系数 $a$ 和 $b$ 的项代表了随 $N$ 增大而消失的有限尺寸校正。这种形式对于准一维系统具有物理动机。为解决此问题，假定像 CCSD 这样的尺寸一致方法能够完美地再现此行为。因此，我们设定：\n$$\nE_{\\mathrm{g,CCSD}}(N) = E_{\\mathrm{g,true}}(N)\n$$\n\n像 CISD 这样的尺寸不一致方法会引入一个不能随系统尺寸正确缩放的误差。这通过在真实能量上添加一个偏差项来建模：\n$$\nE_{\\mathrm{g,CISD}}(N) = E_{\\mathrm{g,true}}(N) + \\delta_{0} + \\frac{\\delta_{1}}{N}\n$$\n项 $\\delta_0$ 代表一个非加和性的、依赖于状态的误差，即使对于无限大系统（$N \\to \\infty$）也依然存在。这是尺寸不一致性影响强度性质的数学特征。项 $\\delta_1/N$ 是一个次级的、依赖于尺寸的误差。代入 $E_{\\mathrm{g,true}}(N)$ 的表达式，我们可以将 CISD 模型重写为：\n$$\nE_{\\mathrm{g,CISD}}(N) = (E_{\\infty} + \\delta_0) + \\frac{a + \\delta_1}{N} + \\frac{b}{N^2}\n$$\n\n估计无限极限带隙 $E_{\\infty}$ 的过程是，对一组计算出的数据点 $(N_i, E_{\\mathrm{g}}(N_i))$ 使用以下模型进行线性最小二乘拟合：\n$$\nE_{\\mathrm{g}}(N) \\approx c_0 + c_1 \\left(\\frac{1}{N}\\right) + c_2 \\left(\\frac{1}{N^2}\\right)\n$$\n外推的带隙是拟合的截距 $c_0$。这是一个标准的多元线性回归问题。我们寻求找到系数向量 $\\mathbf{c} = [c_0, c_1, c_2]^T$，以最小化方程组 $\\mathbf{A}\\mathbf{c} \\approx \\mathbf{y}$ 的残差平方和，其中：\n- $\\mathbf{y}$ 是计算出的带隙向量，$[E_{\\mathrm{g}}(N_1), E_{\\mathrm{g}}(N_2), \\dots]^T$。\n- $\\mathbf{A}$ 是设计矩阵，其中第 $i$ 行为 $[1, 1/N_i, 1/N_i^2]$。\n\n系数向量 $\\mathbf{c}$ 的最小二乘解由 $\\mathbf{c} = (\\mathbf{A}^T\\mathbf{A})^{-1}\\mathbf{A}^T\\mathbf{y}$ 给出。我们将使用 `numpy.linalg.lstsq` 函数来计算这个解。\n\n对于尺寸一致的 CCSD 数据，生成的点 $(1/N_i, E_{\\mathrm{g,CCSD}}(N_i))$ 完全位于拟合模型所定义的曲线上。因此，最小二乘拟合将是完美的（在机器精度范围内），得到的外推截距为 $c_0 = E_{\\infty}$。因此，误差 $|c_0 - E_{\\infty}|$ 应该实际上为零。\n\n对于尺寸不一致的 CISD 数据，生成的点位于由 $(E_{\\infty} + \\delta_0) + (a + \\delta_1)/N + b/N^2$ 定义的曲线上。当我们用模型 $c_0 + c_1/N + c_2/N^2$ 拟合这些数据时，最小二乘法过程将找到一个截距 $c_0 \\approx E_{\\infty} + \\delta_0$。因此，外推的带隙是系统性地不正确的，误差 $|c_0 - E_{\\infty}|$ 将约等于 $|\\delta_0|$。这直接证明了尺寸不一致性如何阻碍对宏观极限的准确外推。\n\n该算法对每个测试用例按以下步骤进行：\n$1$. 对于给定的 $N$ 值集合和参数（$E_{\\infty}, a, b, \\delta_0, \\delta_1$），构建设计矩阵 $\\mathbf{A}$，其列分别为 $N^0$、$N^{-1}$ 和 $N^{-2}$。\n$2$. 使用 $E_{\\mathrm{g,CCSD}}(N)$ 公式生成“数据”向量 $\\mathbf{y}_{\\mathrm{CCSD}}$。\n$3$. 使用最小二乘法求解 $\\mathbf{A}\\mathbf{c}_{\\mathrm{CCSD}} \\approx \\mathbf{y}_{\\mathrm{CCSD}}$ 以得到 $\\mathbf{c}_{\\mathrm{CCSD}}$。第一个元素是外推带隙 $c_{0,\\mathrm{CCSD}}$。\n$4$. 计算绝对误差 $|c_{0,\\mathrm{CCSD}} - E_{\\infty}|$。\n$5$. 使用 $E_{\\mathrm{g,CISD}}(N)$ 公式生成“数据”向量 $\\mathbf{y}_{\\mathrm{CISD}}$。\n$6$. 求解 $\\mathbf{A}\\mathbf{c}_{\\mathrm{CISD}} \\approx \\mathbf{y}_{\\mathrm{CISD}}$ 以得到 $\\mathbf{c}_{\\mathrm{CISD}}$。第一个元素是外推带隙 $c_{0,\\mathrm{CISD}}$。\n$7$. 计算绝对误差 $|c_{0,\\mathrm{CISD}} - E_{\\infty}|$。\n$8$. 收集并报告这四个值，四舍五入到指定的精度。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Demonstrates the effect of size consistency on extrapolating oligomer\n    properties by simulating band gap calculations and performing a\n    least-squares fit to the infinite-polymer limit.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple contains:\n    # (list of N values, E_inf_true, a, b, delta_0, delta_1)\n    test_cases = [\n        # Test 1 (general happy path)\n        ([4, 6, 8, 12, 16], 2.0, 6.0, 1.5, 0.2, 0.1),\n        # Test 2 (no size inconsistency)\n        ([4, 8, 12, 20, 40], 1.5, 4.0, 0.5, 0.0, 0.0),\n        # Test 3 (boundary: minimal fit points)\n        ([5, 10, 20], 3.0, 3.0, 0.0, -0.15, 0.0),\n        # Test 4 (strong curvature and subleading CISD mismatch)\n        ([6, 7, 8, 12, 24], 1.0, 10.0, 5.0, 0.05, -0.2),\n        # Test 5 (large-N dominance)\n        ([10, 20, 40, 80, 160], 0.8, 2.4, 0.4, 0.3, 0.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        Ns_list, E_inf_true, a, b, delta_0, delta_1 = case\n        \n        # Convert list of N values to a numpy array for vectorization\n        Ns = np.array(Ns_list, dtype=float)\n        \n        # Prepare the variables for the linear least-squares fit\n        inv_N = 1.0 / Ns\n        inv_N2 = inv_N**2\n        \n        # Construct the design matrix A for the model E_g = c0 + c1*(1/N) + c2*(1/N^2)\n        # The columns are N^0, N^-1, N^-2\n        A = np.vstack([np.ones_like(Ns), inv_N, inv_N2]).T\n        \n        # --- 1. CCSD-like (size-consistent) method ---\n        \n        # Generate the synthetic band gap data\n        # E_g_ccsd is identical to E_g_true in this model\n        E_g_ccsd = E_inf_true + a * inv_N + b * inv_N2\n        \n        # Perform the linear least-squares fit: A * c = E_g_ccsd\n        # lstsq returns the solution vector (c), residuals, rank, and singular values\n        c_ccsd, _, _, _ = np.linalg.lstsq(A, E_g_ccsd, rcond=None)\n        \n        # The extrapolated infinite-polymer band gap is the intercept c0\n        extrapolated_E_inf_ccsd = c_ccsd[0]\n        \n        # Calculate the absolute error\n        error_ccsd = np.abs(extrapolated_E_inf_ccsd - E_inf_true)\n        \n        # --- 2. CISD-like (size-inconsistent) method ---\n        \n        # Generate the synthetic band gap data with the inconsistency bias\n        E_g_cisd = E_g_ccsd + delta_0 + delta_1 * inv_N\n        \n        # Perform the linear least-squares fit for the CISD data\n        c_cisd, _, _, _ = np.linalg.lstsq(A, E_g_cisd, rcond=None)\n        \n        # The extrapolated infinite-polymer band gap is the intercept c0\n        extrapolated_E_inf_cisd = c_cisd[0]\n        \n        # Calculate the absolute error\n        error_cisd = np.abs(extrapolated_E_inf_cisd - E_inf_true)\n        \n        # --- 3. Store results ---\n        \n        # Append the four required values for this test case\n        results.extend([\n            extrapolated_E_inf_ccsd,\n            extrapolated_E_inf_cisd,\n            error_ccsd,\n            error_cisd\n        ])\n\n    # Final print statement in the exact required format.\n    # Each float is rounded to six decimal places.\n    formatted_results = [f\"{val:.6f}\" for val in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2462334"}]}