{"hands_on_practices": [{"introduction": "掌握正则系综始于理解其核心数学引擎：配分函数。这个练习将引导你完成一个简单、可解的“玩具模型”的统计力学基本步骤。通过为一个由分子转子组成的小型系统手动计算配分函数，然后推导其内能 $U$ 和热容 $C_V$，你将具体地理解宏观热力学性质是如何从单个粒子的量子态中涌现出来的。[@problem_id:2463790]", "problem": "考虑一个由 $2 \\times 2$ 个吸附位点（总共四个位点）组成的简化的二维方格晶格，该晶格处于绝对温度为 $T$ 的正则系综（粒子数、体积和温度恒定；NVT）中。每个位点上有一个独立的、无相互作用的分子转子，它可以处于两种构象状态之一：\n\n- 能量为 $0$ 的基态，具有双重取向简并度。\n- 能量为 $\\varepsilon \\gt 0$ 的激发态，简并度为1。\n\n不同位点之间没有相互作用，且晶格体积是固定的。令 $k_B$ 表示玻尔兹曼常数。仅使用正则系综的第一性原理，计算这个四位点晶格的正则配分函数 $Q(T)$，然后推导出内能 $U(T)$ 和定容热容 $C_V(T)$。请以闭合形式给出所有表达式。\n\n答案报告要求：仅报告 $C_V(T)$ 的最终闭合形式解析表达式作为你的最终答案，用 $k_B$、$\\varepsilon$ 和 $T$ 表示。在最终报告的表达式中不要包含单位。不要进行四舍五入或近似计算。", "solution": "所述问题在科学上是合理的、提法得当的、客观的且自洽的。它是在统计力学中将正则系综应用于离散系统的一个标准练习。所有必要的参数都已给出，不存在矛盾或模糊之处。因此，我将开始解答。\n\n该系统由位于固定晶格上的 $N=4$ 个独立的、无相互作用的、可分辨的分子转子组成。这样一个系统的总配分函数 $Q(T)$ 是单粒子配分函数 $q(T)$ 的乘积：\n$$Q(T) = [q(T)]^N$$\n这里，$N=4$。\n\n第一步是计算单粒子配分函数 $q(T)$。单个转子的配分函数是其所有可用状态的总和，由玻尔兹曼因子 $\\exp(-E_i / (k_B T))$ 加权，其中 $E_i$ 是状态 $i$ 的能量，$g_i$ 是其简并度。\n$$q(T) = \\sum_{i} g_i \\exp\\left(-\\frac{E_i}{k_B T}\\right)$$\n问题给出了每个转子的两个能级：\n1.  基态：能量 $E_0 = 0$，简并度 $g_0 = 2$。\n2.  激发态：能量 $E_1 = \\varepsilon$，简并度 $g_1 = 1$。\n\n将这些值代入 $q(T)$ 的表达式中：\n$$q(T) = g_0 \\exp\\left(-\\frac{E_0}{k_B T}\\right) + g_1 \\exp\\left(-\\frac{E_1}{k_B T}\\right)$$\n$$q(T) = 2 \\cdot \\exp\\left(-\\frac{0}{k_B T}\\right) + 1 \\cdot \\exp\\left(-\\frac{\\varepsilon}{k_B T}\\right)$$\n$$q(T) = 2 \\cdot 1 + \\exp\\left(-\\frac{\\varepsilon}{k_B T}\\right) = 2 + \\exp\\left(-\\frac{\\varepsilon}{k_B T}\\right)$$\n\n现在，我们可以写出 $N=4$ 个转子的总正则配分函数：\n$$Q(T) = [q(T)]^4 = \\left(2 + \\exp\\left(-\\frac{\\varepsilon}{k_B T}\\right)\\right)^4$$\n\n下一步是推导系统的内能 $U(T)$。在正则系综中，内能通过以下公式与配分函数相关：\n$$U(T) = k_B T^2 \\frac{\\partial \\ln Q(T)}{\\partial T}$$\n我们先求 $\\ln Q(T)$：\n$$\\ln Q(T) = \\ln\\left[\\left(2 + \\exp\\left(-\\frac{\\varepsilon}{k_B T}\\right)\\right)^4\\right] = 4 \\ln\\left(2 + \\exp\\left(-\\frac{\\varepsilon}{k_B T}\\right)\\right)$$\n为了简化微分，使用变量 $\\beta = \\frac{1}{k_B T}$ 会很方便。内能的表达式变为 $U(\\beta) = -\\frac{\\partial \\ln Q(\\beta)}{\\partial \\beta}$。\n$$\\ln Q(\\beta) = 4 \\ln\\left(2 + \\exp(-\\varepsilon\\beta)\\right)$$\n对 $\\beta$ 求导：\n$$U(\\beta) = -\\frac{\\partial}{\\partial \\beta} \\left[4 \\ln\\left(2 + \\exp(-\\varepsilon\\beta)\\right)\\right]$$\n$$U(\\beta) = -4 \\cdot \\frac{1}{2 + \\exp(-\\varepsilon\\beta)} \\cdot \\frac{\\partial}{\\partial \\beta}\\left(2 + \\exp(-\\varepsilon\\beta)\\right)$$\n$$U(\\beta) = -4 \\cdot \\frac{1}{2 + \\exp(-\\varepsilon\\beta)} \\cdot \\left(-\\varepsilon \\exp(-\\varepsilon\\beta)\\right)$$\n$$U(\\beta) = \\frac{4\\varepsilon \\exp(-\\varepsilon\\beta)}{2 + \\exp(-\\varepsilon\\beta)}$$\n将 $\\beta = \\frac{1}{k_B T}$ 代回，我们得到内能作为温度的函数：\n$$U(T) = \\frac{4\\varepsilon \\exp\\left(-\\frac{\\varepsilon}{k_B T}\\right)}{2 + \\exp\\left(-\\frac{\\varepsilon}{k_B T}\\right)}$$\n\n最后，我们推导定容热容 $C_V(T)$。它被定义为内能对温度在恒定体积下的偏导数：\n$$C_V(T) = \\left(\\frac{\\partial U}{\\partial T}\\right)_V$$\n同样，使用 $\\beta$ 更为直接。其关系为 $C_V = \\frac{\\partial U}{\\partial T} = \\frac{\\partial U}{\\partial \\beta} \\frac{\\partial \\beta}{\\partial T}$。由于 $\\beta = \\frac{1}{k_B T}$，我们有 $\\frac{\\partial \\beta}{\\partial T} = -\\frac{1}{k_B T^2}$。\n因此，$C_V = -\\frac{1}{k_B T^2} \\frac{\\partial U}{\\partial \\beta}$。我们必须对 $U(\\beta)$ 关于 $\\beta$ 求导：\n$$\\frac{\\partial U}{\\partial \\beta} = \\frac{\\partial}{\\partial \\beta} \\left(\\frac{4\\varepsilon \\exp(-\\varepsilon\\beta)}{2 + \\exp(-\\varepsilon\\beta)}\\right)$$\n使用除法求导法则 $\\frac{d}{dx}\\left(\\frac{f}{g}\\right) = \\frac{f'g-fg'}{g^2}$，其中 $f(\\beta) = 4\\varepsilon \\exp(-\\varepsilon\\beta)$ 且 $g(\\beta) = 2 + \\exp(-\\varepsilon\\beta)$：\n$$f'(\\beta) = -4\\varepsilon^2 \\exp(-\\varepsilon\\beta)$$\n$$g'(\\beta) = -\\varepsilon \\exp(-\\varepsilon\\beta)$$\n$$\\frac{\\partial U}{\\partial \\beta} = \\frac{(-4\\varepsilon^2 \\exp(-\\varepsilon\\beta))(2 + \\exp(-\\varepsilon\\beta)) - (4\\varepsilon \\exp(-\\varepsilon\\beta))(-\\varepsilon \\exp(-\\varepsilon\\beta))}{(2 + \\exp(-\\varepsilon\\beta))^2}$$\n展开分子：\n$$\\frac{\\partial U}{\\partial \\beta} = \\frac{-8\\varepsilon^2 \\exp(-\\varepsilon\\beta) - 4\\varepsilon^2 \\exp(-2\\varepsilon\\beta) + 4\\varepsilon^2 \\exp(-2\\varepsilon\\beta)}{(2 + \\exp(-\\varepsilon\\beta))^2}$$\n$$\\frac{\\partial U}{\\partial \\beta} = \\frac{-8\\varepsilon^2 \\exp(-\\varepsilon\\beta)}{(2 + \\exp(-\\varepsilon\\beta))^2}$$\n现在，我们将其代回 $C_V$ 的表达式中：\n$$C_V(T) = -\\frac{1}{k_B T^2} \\left(\\frac{-8\\varepsilon^2 \\exp(-\\varepsilon\\beta)}{(2 + \\exp(-\\varepsilon\\beta))^2}\\right)$$\n$$C_V(T) = \\frac{8\\varepsilon^2}{k_B T^2} \\frac{\\exp(-\\varepsilon\\beta)}{(2 + \\exp(-\\varepsilon\\beta))^2}$$\n将 $\\beta$ 替换为 $\\frac{1}{k_B T}$，得到定容热容的最终表达式：\n$$C_V(T) = \\frac{8\\varepsilon^2}{k_B T^2} \\frac{\\exp\\left(-\\frac{\\varepsilon}{k_B T}\\right)}{\\left(2 + \\exp\\left(-\\frac{\\varepsilon}{k_B T}\\right)\\right)^2}$$\n为了记法上的偏好，可以对该表达式进行重排，例如：\n$$C_V(T) = 8 k_B \\left(\\frac{\\varepsilon}{k_B T}\\right)^2 \\frac{\\exp\\left(-\\frac{\\varepsilon}{k_B T}\\right)}{\\left(2 + \\exp\\left(-\\frac{\\varepsilon}{k_B T}\\right)\\right)^2}$$\n第一个推导出的形式是充分且完整的。", "answer": "$$\\boxed{\\frac{8 \\varepsilon^{2}}{k_B T^{2}} \\frac{\\exp\\left(-\\frac{\\varepsilon}{k_B T}\\right)}{\\left(2 + \\exp\\left(-\\frac{\\varepsilon}{k_B T}\\right)\\right)^{2}}}$$", "id": "2463790"}, {"introduction": "理论概念在代码中得以实现时才真正变得生动。这个动手编程问题挑战你将正则系综的原理应用于生物分子模拟中的一个经典问题：丙氨酸二肽的构象偏好。你将从头开始构建一个模型，对扭转角空间进行离散化，计算玻尔兹曼权重，并最终确定关键构象盆地的布居数，从而在势能面和可实验观测的平衡之间建立直接联系。[@problem_id:2463736]", "problem": "要求您为投影到拉马钱德兰扭转角上的丙氨酸二肽构象平衡构建一个完全指定的正则系综模型，并计算在真空与类水条件下两个盆地（alpha 和 beta）的正则盆地布居。您必须实现一个完整的、可运行的程序，该程序评估扭转角上的离散正则（粒子数恒定，体积恒定，温度恒定）系综，并报告盆地概率。所有数学定义均在下方提供；您必须完全按照规定使用它们，并以指定的单位表示任何物理量。\n\n模型设置。考虑在二维环面 $[-180^{\\circ},180^{\\circ}) \\times [-180^{\\circ},180^{\\circ})$ 上定义的扭转角 $\\phi$ 和 $\\psi$。将以千焦/摩尔为单位的基础势能面 $V_{\\text{base}}(\\phi,\\psi)$ 定义为\n$$\nV_{\\text{base}}(\\phi,\\psi) = V_a \\left[1 - \\cos\\!\\left(3(\\phi+60^{\\circ})\\right)\\right] + V_b \\left[1 - \\cos\\!\\left(3(\\psi+45^{\\circ})\\right)\\right] + V_c \\left[1 + \\cos\\!\\left(\\phi - \\psi\\right)\\right],\n$$\n其中所有三角函数参数均以度为单位，而 $V_a$、$V_b$、$V_c$ 是以千焦/摩尔为单位的常数。\n\n通过环面高斯项将溶剂效应建模为对 alpha 盆地的局部稳定化和对 beta 盆地的局部惩罚。设 alpha 盆地中心为 $(\\phi_\\alpha,\\psi_\\alpha) = (-60^{\\circ},-45^{\\circ})$，beta 盆地中心为 $(\\phi_\\beta,\\psi_\\beta) = (-135^{\\circ},135^{\\circ})$。将 $(\\phi,\\psi)$ 和 $(\\phi_0,\\psi_0)$ 之间的环面距离平方定义为\n$$\nd^2_{\\mathbb{T}^2}((\\phi,\\psi),(\\phi_0,\\psi_0)) = \\Delta(\\phi,\\phi_0)^2 + \\Delta(\\psi,\\psi_0)^2,\n$$\n其中以度为单位的环绕角差 $\\Delta(\\theta,\\theta_0)$ 由下式给出\n$$\n\\Delta(\\theta,\\theta_0) = \\operatorname{wrap}_{(-180^{\\circ},180^{\\circ}]}\\!\\left(\\theta - \\theta_0\\right), \\quad \\text{where } \\operatorname{wrap}_{(-180^{\\circ},180^{\\circ}]}\\!(x) = x - 360^{\\circ}\\,\\left\\lfloor \\frac{x + 180^{\\circ}}{360^{\\circ}} \\right\\rfloor.\n$$\n设 $\\sigma$ 为以度为单位的宽度，$s_\\alpha$ 为 alpha 盆地的稳定化振幅（单位：千焦/摩尔），$s_\\beta$ 为 beta 盆地的惩罚振幅（单位：千焦/摩尔）。溶剂贡献为\n$$\nV_{\\text{solv}}(\\phi,\\psi) = - s_\\alpha \\exp\\!\\left(-\\frac{d^2_{\\mathbb{T}^2}((\\phi,\\psi),(\\phi_\\alpha,\\psi_\\alpha))}{2\\sigma^2}\\right) + s_\\beta \\exp\\!\\left(-\\frac{d^2_{\\mathbb{T}^2}((\\phi,\\psi),(\\phi_\\beta,\\psi_\\beta))}{2\\sigma^2}\\right).\n$$\n总势为 $V(\\phi,\\psi) = V_{\\text{base}}(\\phi,\\psi) + V_{\\text{solv}}(\\phi,\\psi)$，单位为千焦/摩尔。\n\n正则系综。对于给定的绝对温度 $T$（单位：开尔文）和玻尔兹曼常数 $k_{\\mathrm{B}} = 0.008314462618\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$，定义 $\\beta = 1/(k_{\\mathrm{B}} T)$。在 $(\\phi,\\psi)$ 处的正则权重为 $w(\\phi,\\psi) = \\exp(-\\beta V(\\phi,\\psi))$。\n\n离散化。在 $[-180^{\\circ},180^{\\circ})$ 范围内，对每个维度使用间距为 $\\Delta = 2^{\\circ}$ 的均匀角度网格。离散配分函数为\n$$\nZ = \\sum_{\\phi}\\sum_{\\psi} \\exp\\!\\left(-\\beta V(\\phi,\\psi)\\right),\n$$\n其中求和遍及所有网格点，概率通过用 $Z$ 进行归一化来定义。设 alpha 盆地窗口为围绕 $(\\phi_\\alpha,\\psi_\\alpha)$ 的环面矩形，其在每个角度维度上的半宽为 $w = 30^{\\circ}$，即满足 $|\\Delta(\\phi,\\phi_\\alpha)| \\le w$ 和 $|\\Delta(\\psi,\\psi_\\alpha)| \\le w$ 的 $(\\phi,\\psi)$ 集合。类似地，围绕 $(\\phi_\\beta,\\psi_\\beta)$ 定义具有相同半宽 $w$ 的 beta 盆地窗口。需要报告的正则概率为\n$$\nP_\\alpha = \\frac{1}{Z}\\sum_{(\\phi,\\psi)\\in \\text{alpha window}} \\exp\\!\\left(-\\beta V(\\phi,\\psi)\\right), \\quad\nP_\\beta = \\frac{1}{Z}\\sum_{(\\phi,\\psi)\\in \\text{beta window}} \\exp\\!\\left(-\\beta V(\\phi,\\psi)\\right).\n$$\n将概率报告为无量纲十进制数。\n\n常数。请完全按照给定值使用 $V_a = 4\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$、$V_b = 3\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$、$V_c = 1\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$、$\\sigma = 25^{\\circ}$、$w = 30^{\\circ}$ 和 $\\Delta = 2^{\\circ}$。\n\n测试套件。您的程序必须评估以下四个参数集，每个参数集指定为 $(T,\\ s_\\alpha,\\ s_\\beta)$:\n- 情况 1（真空，中等温度）：$(T=\\ 300,\\ s_\\alpha=\\ 0,\\ s_\\beta=\\ 0)$，其中 $T$ 的单位为开尔文，$s_\\alpha,s_\\beta$ 的单位为千焦/摩尔。\n- 情况 2（类水，中等温度）：$(T=\\ 300,\\ s_\\alpha=\\ 5,\\ s_\\beta=\\ 2)$。\n- 情况 3（类水，高温）：$(T=\\ 600,\\ s_\\alpha=\\ 5,\\ s_\\beta=\\ 2)$。\n- 情况 4（真空，低温）：$(T=\\ 100,\\ s_\\alpha=\\ 0,\\ s_\\beta=\\ 0)$。\n\n所需输出。对于每个测试用例，计算并返回一个双元素列表 $[P_\\alpha, P_\\beta]$，其中两个条目均四舍五入到恰好六位小数。按相同顺序将四个用例的结果汇总到一个列表中。您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，其中每个元素本身就是一个双元素列表，例如 \"[[0.123456,0.234567],[...],...]\"，不含任何额外文本。\n\n角度单位要求。模型中的所有角度均以度为单位。所有三角函数都应按上文定义，将其参数解释为度。\n\n物理单位。能量单位必须是千焦/摩尔，温度单位是开尔文，玻尔兹曼常数单位是千焦/摩尔/开尔文。将最终概率表示为四舍五入到六位小数的无量纲十进制数。", "solution": "我们被要求在指定的势能函数下，计算丙氨酸二肽扭转角在正则（粒子数恒定，体积恒定，温度恒定）系综中的正则概率，包括在真空和有类溶剂扰动两种情况。正则系综赋予与玻尔兹曼因子 $\\exp(-\\beta V)$ 成正比的权重，其中 $\\beta = 1/(k_{\\mathrm{B}} T)$，$V$ 是势能。\n\n首先，我们将扭转角域形式化为二维环面 $[-180^{\\circ},180^{\\circ}) \\times [-180^{\\circ},180^{\\circ})$，并对 $\\phi$ 和 $\\psi$ 使用间距为 $\\Delta = 2^{\\circ}$ 的均匀离散网格。这种离散化将配分函数和概率表示为有限和，确保了数值评估的明确性以及在不同实现之间的一致性。\n\n基础势能定义为\n$$\nV_{\\text{base}}(\\phi,\\psi) = V_a \\left[1 - \\cos\\!\\left(3(\\phi+60^{\\circ})\\right)\\right] + V_b \\left[1 - \\cos\\!\\left(3(\\psi+45^{\\circ})\\right)\\right] + V_c \\left[1 + \\cos\\!\\left(\\phi - \\psi\\right)\\right],\n$$\n其中 $V_a = 4\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$、$V_b = 3\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$ 且 $V_c = 1\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$。三角函数接受以度为单位的参数；在数值计算上，调用标准库函数时可以将度转换为弧度，但从数学上讲，定义是固定的。\n\n溶剂扰动通过稳定或去稳定特定区域的环面高斯项进行建模：\n$$\nV_{\\text{solv}}(\\phi,\\psi) = - s_\\alpha \\exp\\!\\left(-\\frac{d^2_{\\mathbb{T}^2}((\\phi,\\psi),(\\phi_\\alpha,\\psi_\\alpha))}{2\\sigma^2}\\right) + s_\\beta \\exp\\!\\left(-\\frac{d^2_{\\mathbb{T}^2}((\\phi,\\psi),(\\phi_\\beta,\\psi_\\beta))}{2\\sigma^2}\\right),\n$$\n其中 $(\\phi_\\alpha,\\psi_\\alpha) = (-60^{\\circ},-45^{\\circ})$、$(\\phi_\\beta,\\psi_\\beta) = (-135^{\\circ},135^{\\circ})$ 且 $\\sigma = 25^{\\circ}$。环面距离平方为\n$$\nd^2_{\\mathbb{T}^2}((\\phi,\\psi),(\\phi_0,\\psi_0)) = \\Delta(\\phi,\\phi_0)^2 + \\Delta(\\psi,\\psi_0)^2,\n$$\n其中环绕差 $\\Delta(\\theta,\\theta_0)$ 产生圆上的最小角差：\n$$\n\\Delta(\\theta,\\theta_0) = \\operatorname{wrap}_{(-180^{\\circ},180^{\\circ}]}\\!\\left(\\theta - \\theta_0\\right), \\quad \\operatorname{wrap}_{(-180^{\\circ},180^{\\circ}]}\\!(x) = x - 360^{\\circ}\\,\\left\\lfloor \\frac{x + 180^{\\circ}}{360^{\\circ}} \\right\\rfloor.\n$$\n总势为 $V = V_{\\text{base}} + V_{\\text{solv}}$。\n\n对于给定的绝对温度 $T$ 和玻尔兹曼常数 $k_{\\mathrm{B}} = 0.008314462618\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$，我们计算 $\\beta = 1/(k_{\\mathrm{B}} T)$。每个网格点上的正则权重为 $w = \\exp(-\\beta V)$。离散配分函数为\n$$\nZ = \\sum_{\\phi}\\sum_{\\psi} w(\\phi,\\psi),\n$$\n且在网格点子集 $\\Omega$ 上的任意正则概率为\n$$\nP(\\Omega) = \\frac{1}{Z}\\sum_{(\\phi,\\psi)\\in \\Omega} w(\\phi,\\psi).\n$$\n\n我们将 alpha 窗口定义为以 $(-60^{\\circ},-45^{\\circ})$ 为中心、在每个维度上半宽为 $w = 30^{\\circ}$ 的环面矩形：\n$$\n\\Omega_\\alpha = \\left\\{(\\phi,\\psi) : |\\Delta(\\phi,-60^{\\circ})| \\le 30^{\\circ},\\ |\\Delta(\\psi,-45^{\\circ})| \\le 30^{\\circ}\\right\\}.\n$$\nbeta 窗口类似地围绕 $(-135^{\\circ},135^{\\circ})$ 定义：\n$$\n\\Omega_\\beta = \\left\\{(\\phi,\\psi) : |\\Delta(\\phi,-135^{\\circ})| \\le 30^{\\circ},\\ |\\Delta(\\psi,135^{\\circ})| \\le 30^{\\circ}\\right\\}.\n$$\n期望的输出是 $P_\\alpha = P(\\Omega_\\alpha)$ 和 $P_\\beta = P(\\Omega_\\beta)$。\n\n然后，我们为指定的测试套件评估这些概率：\n- 情况 1：$(T=\\ 300,\\ s_\\alpha=\\ 0,\\ s_\\beta=\\ 0)$ 代表中等温度下的真空，此时只有 $V_{\\text{base}}$ 决定分布形态。\n- 情况 2：$(T=\\ 300,\\ s_\\alpha=\\ 5,\\ s_\\beta=\\ 2)$ 代表中等温度下的类水条件，此时相对于真空，alpha 区域被稳定化，beta 区域被惩罚。\n- 情况 3：$(T=\\ 600,\\ s_\\alpha=\\ 5,\\ s_\\beta=\\ 2)$ 代表更高温度，这会减小能量差异的影响，并倾向于使分布扁平化，从而降低盆地之间的对比度。\n- 情况 4：$(T=\\ 100,\\ s_\\alpha=\\ 0,\\ s_\\beta=\\ 0)$ 代表低温下的真空，这会强调 $V_{\\text{base}}$ 的极小值点，并使盆地布居更加尖锐。\n\n在算法上，我们枚举网格点，计算 $V(\\phi,\\psi)$ 和 $w(\\phi,\\psi)$，构成 $Z$，通过环绕角差为 $\\Omega_\\alpha$ 和 $\\Omega_\\beta$ 构建指示掩码，并通过求和与归一化计算 $P_\\alpha$ 和 $P_\\beta$。结果必须四舍五入到六位小数，并按顺序为每个用例返回。定性地看，在固定温度下，引入类溶剂稳定化（$s_\\alpha > 0$ 和 $s_\\beta > 0$）会增加 $P_\\alpha$ 并减少 $P_\\beta$；而提高 $T$ 会增加熵混合，并使两个盆地概率趋向于反映窗口相对几何尺寸而非能量偏好的值。在低温 $T$下，$P_\\alpha$ 和 $P_\\beta$ 反映了 $V_{\\text{base}}$ 的能量极小值结构，对比更鲜明。\n\n最终程序精确实现这些定义，并打印单行内容，该行包含一个由四个双元素列表组成的列表，每个列表为 $[P_\\alpha, P_\\beta]$，四舍五入到六位小数，并按测试套件指定的顺序排列。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef wrap_deg(x):\n    \"\"\"\n    Wrap angle(s) in degrees to the interval (-180, 180].\n    This returns a value such that boundaries are consistent on the torus.\n    \"\"\"\n    return x - 360.0 * np.floor((x + 180.0) / 360.0)\n\ndef torus_delta(a, b):\n    \"\"\"\n    Minimal wrapped difference between angles a and b (in degrees).\n    Works with numpy arrays or scalars.\n    \"\"\"\n    return np.abs(wrap_deg(a - b))\n\ndef build_potential(phi_deg, psi_deg, Va, Vb, Vc, s_alpha, s_beta, sigma_deg):\n    \"\"\"\n    Construct the total potential V(phi, psi) in kJ/mol on the 2D grid of angles (in degrees).\n    Trigonometric functions interpret arguments in degrees as per the problem statement.\n    \"\"\"\n    # Base torsional terms: convert degree arguments to radians for numpy trig.\n    # Using identities: cos(deg) -> cos(np.deg2rad(deg_argument))\n    term_phi = np.cos(np.deg2rad(3.0 * (phi_deg + 60.0)))\n    term_psi = np.cos(np.deg2rad(3.0 * (psi_deg + 45.0)))\n    term_cross = np.cos(np.deg2rad(phi_deg - psi_deg))\n    V_base = Va * (1.0 - term_phi) + Vb * (1.0 - term_psi) + Vc * (1.0 + term_cross)\n\n    # Solvent-like Gaussian stabilization/penalty on the torus\n    phi_alpha, psi_alpha = -60.0, -45.0\n    phi_beta, psi_beta = -135.0, 135.0\n    dphi_alpha = torus_delta(phi_deg, phi_alpha)\n    dpsi_alpha = torus_delta(psi_deg, psi_alpha)\n    d2_alpha = dphi_alpha**2 + dpsi_alpha**2\n\n    dphi_beta = torus_delta(phi_deg, phi_beta)\n    dpsi_beta = torus_delta(psi_deg, psi_beta)\n    d2_beta = dphi_beta**2 + dpsi_beta**2\n\n    # Gaussian terms\n    ga_alpha = np.exp(-d2_alpha / (2.0 * sigma_deg**2))\n    ga_beta = np.exp(-d2_beta / (2.0 * sigma_deg**2))\n    V_solv = -s_alpha * ga_alpha + s_beta * ga_beta\n\n    return V_base + V_solv\n\ndef basin_masks(phi_deg, psi_deg, w_half_deg):\n    \"\"\"\n    Construct boolean masks for alpha and beta rectangular windows on the torus.\n    \"\"\"\n    phi_alpha, psi_alpha = -60.0, -45.0\n    phi_beta, psi_beta = -135.0, 135.0\n    alpha_mask = (torus_delta(phi_deg, phi_alpha) = w_half_deg)  (torus_delta(psi_deg, psi_alpha) = w_half_deg)\n    beta_mask = (torus_delta(phi_deg, phi_beta) = w_half_deg)  (torus_delta(psi_deg, psi_beta) = w_half_deg)\n    return alpha_mask, beta_mask\n\ndef compute_probabilities(T, s_alpha, s_beta):\n    \"\"\"\n    Compute (P_alpha, P_beta) for given temperature T (K) and solvent parameters s_alpha, s_beta (kJ/mol).\n    \"\"\"\n    # Constants\n    kB = 0.008314462618  # kJ/mol/K\n    Va = 4.0  # kJ/mol\n    Vb = 3.0  # kJ/mol\n    Vc = 1.0  # kJ/mol\n    sigma_deg = 25.0  # degrees\n    w_half_deg = 30.0  # degrees\n    delta = 2.0  # degrees grid spacing\n\n    # Grid\n    angles = np.arange(-180.0, 180.0, delta)  # [-180, 180) degrees\n    phi_grid, psi_grid = np.meshgrid(angles, angles, indexing='ij')\n\n    # Potential and Boltzmann weights\n    V = build_potential(phi_grid, psi_grid, Va, Vb, Vc, s_alpha, s_beta, sigma_deg)\n    beta = 1.0 / (kB * T)\n    # For numerical stability, shift by min(V) before exponentiation; cancels in normalization\n    V_shift = V - np.min(V)\n    weights = np.exp(-beta * V_shift)\n\n    Z = np.sum(weights)\n\n    # Basin masks\n    alpha_mask, beta_mask = basin_masks(phi_grid, psi_grid, w_half_deg)\n\n    P_alpha = float(np.sum(weights[alpha_mask]) / Z)\n    P_beta = float(np.sum(weights[beta_mask]) / Z)\n    return P_alpha, P_beta\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (T in K, s_alpha in kJ/mol, s_beta in kJ/mol)\n    test_cases = [\n        (300.0, 0.0, 0.0),  # Case 1: vacuum, moderate T\n        (300.0, 5.0, 2.0),  # Case 2: water-like, moderate T\n        (600.0, 5.0, 2.0),  # Case 3: water-like, high T\n        (100.0, 0.0, 0.0),  # Case 4: vacuum, low T\n    ]\n\n    results = []\n    for T, s_alpha, s_beta in test_cases:\n        p_alpha, p_beta = compute_probabilities(T, s_alpha, s_beta)\n        # Round to exactly six decimal places per requirements\n        results.append([f\"{p_alpha:.6f}\", f\"{p_beta:.6f}\"])\n\n    # Final print statement in the exact required format: a single line\n    # Convert the inner strings to produce numeric-looking output without quotes\n    # Build the string manually to avoid quotes\n    out_elems = []\n    for pair in results:\n        out_elems.append(f\"[{pair[0]},{pair[1]}]\")\n    print(f\"[{','.join(out_elems)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2463736"}, {"introduction": "运行模拟很容易，但确保其物理有效性却很难。这个问题探讨了分子动力学模拟中一个常见的陷阱，即控温器的选择会极大地改变模拟结果。通过分析一个蛋白质折叠过快的场景，你将认识到，正确地对正则系综进行抽样不仅需要复现平均温度，还需要复现其自然的涨落——这个精妙之处对系统的动力学有着深远的影响。[@problem_id:2463805]", "problem": "您正在使用耦合时间常数为 $\\tau_{T}$ 的 Berendsen 控温器，在固定的粒子数、体积和温度下（正则系综，也称为 $NVT$ 系综），对显式水中的一个小蛋白进行分子动力学（MD）模拟。目标温度为 $T_{0}$。平均瞬时温度等于 $T_{0}$，但蛋白质折叠的速度显著快于实验预期以及先前使用其他控温方案报道的模拟结果。您还观察到，瞬时动能的直方图看起来比一个处于温度 $T_{0}$ 的系统所预期的要窄。哪个选项最好地提出了针对此伪影的一个物理上一致的机制，以及在 $NVT$ 框架内对该机制的一个具体测试？\n\nA) 机制：Berendsen 控温器确定性地将速度重新标度至趋近 $T_{0}$，抑制了正则分布所要求的平衡动能涨落，从而在实践中违反了细致平衡。这种偏差减少了势垒的再穿越，并人为地加速了净折叠过程。测试：将 Berendsen 控温器替换为一个已知能够采样正则分布的控温器（例如，Nosé–Hoover 链或随机速度重标度），在相同的 $T_{0}$ 下进行模拟，并验证动能分布与正则预测相匹配，且折叠时间增加；此外，改变 $\\tau_{T}$ 以检查折叠速率是否强烈依赖于耦合强度。\n\nB) 机制：Berendsen 控温器通过过度阻尼水分子来增加溶剂的有效粘度，而更高的粘度通过增强向蛋白质的动量传递来驱动更快的构象转变。测试：减小 $\\tau_{T}$ 以进行更强的过度阻尼，并确认折叠变得更快。\n\nC) 机制：Berendsen 控温器诱发“飞行冰块”效应，将能量从低频集体运动转移到高频内部模式，加热蛋白质的键振动，从而促进势垒穿越和快速折叠。测试：监测模式分辨的温度，并确认高频模式比低频模式更热。\n\nD) 机制：因为 Berendsen 控温器在每一步都精确地强制执行能量均分，所以它生成一个能够最大化势垒穿越效率的精确正则分布。测试：确认瞬时温度在 $T_{0}$ 处呈尖锐峰值，随时间变化基本没有涨落。", "solution": "对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- 模拟方法：分子动力学 (MD)\n- 系统：显式水中的一个小蛋白。\n- 系综：正则系综，指定为恒定的粒子数 ($N$)、体积 ($V$) 和温度 ($T$)。\n- 控温器：Berendsen 控温器，耦合时间常数为 $\\tau_{T}$。\n- 目标温度：$T_{0}$。\n- 观察1：平均瞬时温度等于 $T_{0}$。\n- 观察2：蛋白质折叠速率显著快于实验值以及使用其他控温器模拟得到的速率。\n- 观察3：瞬时动能的直方图比温度为 $T_{0}$ 的正则系综的理论预期更窄。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据充分：** 该问题牢固地建立在统计力学和计算分子动力学的原理之上。Berendsen 控温器的伪影，特别是它无法生成严格的正则分布及其对系统动力学的影响，是该领域一个有充分文献记载的标准课题。所有概念都是科学上合理的。\n- **提法恰当：** 问题提供了一组清晰的观察结果，并要求提出一个物理上一致的机制及相应的实验测试。信息足以从给定选项中确定最恰当的解释。\n- **客观性：** 问题使用计算化学领域常见的精确、客观的语言陈述。没有主观性或模糊性。\n\n**步骤3：结论与行动**\n问题陈述是有效的。它科学合理、提法恰当且客观。将推导解答。\n\n**原理推导**\n正则（$NVT$）系综描述了一个与恒定温度 $T$ 的巨大热浴进行热接触的系统。系统的总能量不守恒，而是在一个平均值附近涨落。对于一个具有 $N_{df}$ 个自由度的系统，瞬时动能 $E_k$ 通过能量均分定理与瞬时温度 $T(t)$ 相关联：\n$$ E_k(t) = \\frac{1}{2} N_{df} k_B T(t) $$\n其中 $k_B$ 是玻尔兹曼常数。在一个真正的正则系综中，$E_k$（以及 $T(t)$）表现出涨落。$E_k$ 的概率分布遵循伽马分布（或其特例卡方分布），且其方差非零。对于一个没有约束的 $N$ 粒子系统，$N_{df} = 3N$，动能的方差为：\n$$ \\langle (\\delta E_k)^2 \\rangle = \\frac{3N}{2} (k_B T_0)^2 $$\n动能直方图“比预期更窄”的观察结果意味着其方差小于正则值：$\\langle (\\delta E_k)^2 \\rangle_{sim}  \\frac{3N}{2} (k_B T_0)^2$。这直接表明所使用的控温器没有正确地对正则系综进行采样。\n\nBerendsen 控温器的工作原理是，在每个时间步长 $\\Delta t$ 重新标度所有粒子的速度，以温和地引导系统温度趋向目标温度 $T_{0}$。标度因子 $\\lambda$ 为：\n$$ \\lambda = \\sqrt{1 + \\frac{\\Delta t}{\\tau_T} \\left( \\frac{T_0}{T(t)} - 1 \\right)} $$\n这是一个确定性的一阶动力学耦合。它不对应任何物理热浴，并且已知会违反细致平衡原理。因此，它抑制了自然的动能涨落，产生一个过窄的分布。这正是观察3中描述的伪影。\n\n这种非正则行为对动力学的影响（观察2）是一个已知的伪影。通过确定性地阻尼涨落，控温器会干扰势垒穿越的自然过程。当系统穿过高能过渡态时，其动能通常较低。一个合适的控温器会提供随机的能量交换，从而允许系统有再穿越势垒的可能性。Berendsen 控温器通过持续地将动能推回平均值，可以阻止这些再穿越事件，导致越过能量势垒的单向流动，以及像蛋白质折叠这类动力学过程的人为加速。\n\n那些为生成正则系综而严格推导出的控温器，例如 Nosé–Hoover 控温器（及其为改善遍历性的链式变体）或像 Andersen、Langevin 或随机速度重标度 (SVR) 这样的随机方法，确实能产生正确的动能涨落，因此预期会产生更符合物理现实的动力学速率。\n\n**逐项分析**\n\nA) 机制：Berendsen 控温器确定性地将速度重新标度至趋近 $T_{0}$，抑制了正则分布所要求的平衡动能涨落，从而在实践中违反了细致平衡。这种偏差减少了势垒的再穿越，并人为地加速了净折叠过程。测试：将 Berendsen 控温器替换为一个已知能够采样正则分布的控温器（例如，Nosé–Hoover 链或随机速度重标度），在相同的 $T_{0}$ 下进行模拟，并验证动能分布与正则预测相匹配，且折叠时间增加；此外，改变 $\\tau_{T}$ 以检查折叠速率是否强烈依赖于耦合强度。\n- 分析：该选项完全准确地描述了 Berendsen 控温器的主要缺陷：它不生成真正的正则系综，因为它抑制了动能涨落。这与观察3（“更窄的”直方图）一致。所提出的通过减少势垒再穿越来加速折叠的联系，是对此动力学伪影公认的物理解释，与观察2一致。提出的测试是验证该假设的黄金标准。用一个严格的控温器（如 Nosé–Hoover 或 SVR）替换，应该能恢复正则涨落并校正折叠动力学。此外，伪影的量级应取决于耦合强度 $\\tau_{T}$，因此改变这个参数提供了一个决定性的二次检验。\n- 结论：**正确**。\n\nB) 机制：Berendsen 控温器通过过度阻尼水分子来增加溶剂的有效粘度，而更高的粘度通过增强向蛋白质的动量传递来驱动更快的构象转变。测试：减小 $\\tau_{T}$ 以进行更强的过度阻尼，并确认折叠变得更快。\n- 分析：该机制的第二部分在物理上是不合理的。蛋白质折叠是一个涉及大规模类扩散运动的过程。根据高摩擦极限下的反应速率理论（例如，Kramers 理论），这类过程的速率与介质的粘度成*反比*。更高的粘度会阻碍运动并*减慢*折叠，而不是加速它。这与观察2相矛盾。\n- 结论：**错误**。\n\nC) 机制：Berendsen 控温器诱发“飞行冰块”效应，将能量从低频集体运动转移到高频内部模式，加热蛋白质的键振动，从而促进势垒穿越和快速折叠。测试：监测模式分辨的温度，并确认高频模式比低频模式更热。\n- 分析：“飞行冰块”效应是一个与能量均分失效相关的真实伪影，其中能量被系统地从平动模式中抽走。虽然 Berendsen 控温器容易受此影响，但它并不是对*总*动能分布过窄这一主要观察结果的最直接解释。“飞行冰块”效应是能量在模式间*分布*的问题，而问题明确指出*总*动能的涨落被抑制了。虽然相关，但A中的机制更为根本，并直接解释了所有观察结果。快速折叠更直接地由涨落的普遍抑制来解释，而不是特别地由“飞行冰块”伪影的非能量均分来解释。\n- 结论：**错误**。\n\nD) 机制：因为 Berendsen 控温器在每一步都精确地强制执行能量均分，所以它生成一个能够最大化势垒穿越效率的精确正则分布。测试：确认瞬时温度在 $T_{0}$ 处呈尖锐峰值，随时间变化基本没有涨落。\n- 分析：这个陈述包含多个事实错误。Berendsen 控温器并*不*强制执行能量均分；事实上，它可能导致严重的违反（如“飞行冰块”效应）。最重要的是，它*不*生成正则分布，正是*因为*它抑制了涨落，而涨落是该系综的一个内在特征。测试描述了涨落的抑制，但机制声称这会产生一个“精确的正则分布”，这直接与统计力学的原理相矛盾。\n- 结论：**错误**。", "answer": "$$\\boxed{A}$$", "id": "2463805"}]}