{"hands_on_practices": [{"introduction": "理论上完美的算法在面对动态变化的工作负载时可能会表现不佳。这个练习模拟了“最不经常使用”（LFU）算法的一个经典缺陷——“冷启动偏见”，即算法无法快速适应新出现的热点页面。通过分析这种失效模式并推导出一个基于指数老化机制的修复条件，你将更深入地理解自适应算法在真实场景中的动态行为与挑战。[@problem_id:3629731]", "problem": "考虑一个内存系统，它有 $N$ 个页框和 $P$ 个不同的虚拟页面，其中 $P \\geq N+1$。操作系统使用一种基于计数的页面置换策略：最不经常使用 (LFU)。为了减轻 LFU 众所周知的冷启动偏差，该实现对访问计数应用了指数老化。具体来说，每个页面 $i$ 维护一个老化计数 $c_i(t)$，在两次访问之间，该计数遵循 $ \\frac{d c_i(t)}{dt} = -\\lambda c_i(t)$；在时间 $t$ 访问页面 $i$ 时，计数器更新为 $c_i(t^{+}) = c_i(t^{-}) + 1$，其中 $\\lambda  0$ 是一个固定的衰减率。在时间 $t$ 发生页面错误时，该策略会淘汰当前 $c_i(t^{-})$ 最小的驻留页面（任意打破平局）。\n\n你需要设计并分析一个参数化的引用字符串，该字符串能暴露 LFU 在突发访问下的冷启动偏差，然后确定一个关于突发长度的定量条件，以在指数老化下减轻这种偏差。\n\n构建以下工作负载。存在一个固定的集合 $\\mathcal{H} = \\{H_1,\\dots,H_{N-1}\\}$，包含 $N-1$ 个“现任热门”页面。在时间 $t=0$ 之前，对这些页面的访问构成了独立的平稳泊松过程 (stationary Poisson processes)，其共同速率为每单位时间 $\\mu$ 次访问。因此，在 $t=0$ 之前，系统已达到稳态，并且 $\\mathcal{H}$ 中的所有页面都已驻留。在时间 $t=0$ 时，一个新的页面 $X$ 开始被以重复周期的形式引用。每个周期包括：\n- 对 $X$ 的 $b$ 次连续引用构成的突发，其到达间隔恒定为 $\\tau_b$，紧密相连，因此突发持续时间为 $b\\,\\tau_b$，紧接着\n- 对一个“干扰”页面 $Y$ 的单次引用，该页面不在 $\\mathcal{H}$ 中，并且在被引用前不是驻留页面，因此在引用 $Y$ 时会强制进行页面置换。\n\n假设 $P$ 足够大，以确保在每个周期中，$Y$ 在被引用时都不是驻留页面。同时，假设突发期间存在时间尺度分离，使得老化在突发内部可以忽略不计，即 $\\lambda\\,b\\,\\tau_b \\ll 1$；并且对 $\\mathcal{H}$ 中页面的访问保持其稳态行为，因此它们的老化计数可以用其稳态期望值来处理。\n\n任务：\n- 仅使用上述核心定义和关于泊松过程 (Poisson processes) 的标准随机事实，首先论证在非老化 LFU（即极限情况 $\\lambda \\to 0^{+}$）下，对于任何固定的有限 $b$，一旦系统预热，页面 $X$ 在每个周期结束时对 $Y$ 的后续引用中都将成为被淘汰的受害者，这导致 $X$ 在不同周期中反复出现页面错误（$X$ 的操作性颠簸 (operational thrashing)）。\n- 对于具有固定 $\\lambda  0$ 的指数老化，推导出一个最小整数突发长度 $b_{\\min}$ 的显式封闭形式表达式（作为 $\\mu$ 和 $\\lambda$ 的函数），使得在一次 $X$ 的突发访问之后、紧接着的 $Y$ 引用之前，$X$ 不会成为被淘汰的受害者。等价地，$b_{\\min}$ 是能确保 $X$ 在突发后的老化计数超过 $\\mathcal{H}$ 中任何现任热门页面在稳态下的计数的最小整数 $b$，从而在这种突发模式下减轻 LFU 对 $X$ 的冷启动偏差。\n\n你的最终答案必须是 $b_{\\min}$ 关于 $\\mu$ 和 $\\lambda$ 的单个解析表达式。不需要进行数值计算，最终表达式中也不应包含单位。", "solution": "该问题是有效的。这是一个在操作系统性能分析领域中定义明确、有科学依据的问题，使用了随机过程的标准模型。所提供的假设是明确且充分的，足以推导出一个唯一的解。\n\n问题要求分两部分回答：首先，论证一个新页面在非老化的最不经常使用 (LFU) 策略下发生颠簸的原因；其次，推导在带指数老化的 LFU 下防止这种颠簸的最小突发大小 $b_{\\min}$。\n\n### 第一部分：非老化 LFU 的分析 ($\\lambda \\to 0^{+}$)\n\n在衰减率 $\\lambda \\to 0^{+}$ 的极限情况下，计数更新方程中的老化项 $\\frac{d c_i(t)}{dt} = -\\lambda c_i(t)$ 变为零。这意味着访问计数 $c_i(t)$ 是非递减的；它们只在访问时增加，从不衰减。这就是纯粹的 LFU 算法。\n\n问题陈述，在时间 $t=0$ 之前，系统已达到稳态，其中集合 $\\mathcal{H}$ 中的 $N-1$ 个现任热门页面已驻留。在纯 LFU 系统中，“稳态”意味着这些页面已被访问了很长时间。它们的访问计数，$c_{H_j}$（对于 $H_j \\in \\mathcal{H}$），将在这段漫长的历史中累积，会变得非常大，其值与它们的访问率 $\\mu$ 和经过的时间的乘积成正比。\n\n在时间 $t=0$ 时，引入了一个新页面 $X$。其初始计数为 $c_X = 0$。在第一个周期中，它被访问 $b$ 次。由于计数不会衰减，其在突发访问后的计数变为 $c_X = b$。\n\n在突发访问之后，对一个非驻留页面 $Y$ 的引用会触发页面错误，并迫使操作系统从驻留页面集合 $\\mathcal{H} \\cup \\{X\\}$ 中选择一个受害页面进行淘汰。LFU 策略规定淘汰访问计数最低的页面。\n\n需要比较的计数是：\n- 页面 $X$ 的计数：$c_X = b$。\n- 现任热门页面的计数：$c_{H_j}$（对于 $H_j \\in \\mathcal{H}$）。\n\n对于任何有限的突发长度 $b$，页面 $X$ 的计数与 $\\mathcal{H}$ 中现任页面经过历史累积的非常大的计数相比将是微不足道的。也就是说，$c_X \\ll c_{H_j}$ 对于所有 $j \\in \\{1, \\dots, N-1\\}$。因此，页面 $X$ 将被选为淘汰的受害者。\n\n这个过程在每个周期中重复。当下一个周期开始时，对页面 $X$ 的第一次引用会引发页面错误。页面 $X$ 被调入内存，其计数在突发期间增加到 $b$，然后在引用页面 $Y$ 时立即再次被淘汰。这种页面不断地被调入调出内存而无法取得进展的现象，被称为颠簸 (thrashing)。纯 LFU 的冷启动偏差——即由于新页面的计数从零开始，无法与具有悠久历史的现任页面竞争，从而无法识别新近流行的页面——被这个工作负载完美地暴露出来。\n\n### 第二部分：带指数老化的 LFU 的 $b_{\\min}$ 推导 ($\\lambda  0$)\n\n当衰减率 $\\lambda  0$ 不为零时，所有页面的计数会持续衰减。这种“遗忘”机制可以防止旧页面的计数无限增长，从而让新页面在被足够频繁访问时有机会建立驻留。问题要求找到最小的整数突发长度 $b$，使得页面 $X$ 不成为被淘汰的受害者。这要求 $X$ 在其初始突发后的计数超过现任热门页面的稳态计数。问题指明，热门页面的稳态计数可以用其期望值来处理。\n\n因此，页面 $X$ 能够幸免于淘汰的条件是：\n$$c_X^{\\text{after burst}}  E[c_H]$$\n其中 $c_X^{\\text{after burst}}$ 是页面 $X$ 在其突发访问刚结束后的计数，而 $E[c_H]$ 是一个现任热门页面 $H \\in \\mathcal{H}$ 的稳态期望计数。\n\n**第 1 步：计算稳态期望计数 $E[c_H]$**\n\n对于一个页面 $H \\in \\mathcal{H}$，其访问构成一个速率为 $\\mu$ 的平稳泊松过程 (stationary Poisson process)。计数 $c_H(t)$ 以速率 $\\lambda$ 指数衰减，并在每次访问时增加 1。我们需要找到在做出淘汰决策前一刻的计数的期望值。问题指出，淘汰是基于 $c_i(t^{-})$。我们可以对每次访问前的计数演变进行建模。\n设 $c'_k$ 为页面 $H$ 在其第 $k$ 次访问（发生在时间 $t_k$）之前的计数。这次访问后的计数是 $c'_k+1$。\n这个计数随后会衰减，直到在时间 $t_{k+1}$ 的下一次访问。在第 $(k+1)$ 次访问之前的计数是：\n$$c'_{k+1} = (c'_k + 1) e^{-\\lambda (t_{k+1}-t_k)}$$\n设 $\\Delta t_k = t_{k+1}-t_k$ 为到达间隔时间。由于到达遵循速率为 $\\mu$ 的泊松过程 (Poisson process)，到达间隔时间 $\\Delta t_k$ 是独立同分布的指数随机变量，其概率密度函数为 $f(\\tau) = \\mu e^{-\\mu \\tau}$（对于 $\\tau \\ge 0$）。\n\n在稳态下，期望计数是恒定的，所以 $E[c'_{k+1}] = E[c'_k] = E[c_H]$。对递推关系式取期望：\n$$E[c'_{k+1}] = E[(c'_k + 1) e^{-\\lambda \\Delta t_k}]$$\n由于在时间 $t_k$ 的计数 $c'_k$ 与未来的到达间隔时间 $\\Delta t_k$ 是独立的：\n$$E[c_H] = E[c'_k + 1] E[e^{-\\lambda \\Delta t_k}] = (E[c_H] + 1) E[e^{-\\lambda \\Delta t_k}]$$\n我们必须计算指数项的期望：\n$$E[e^{-\\lambda \\Delta t_k}] = \\int_0^\\infty e^{-\\lambda \\tau} (\\mu e^{-\\mu \\tau}) d\\tau = \\mu \\int_0^\\infty e^{-(\\lambda+\\mu)\\tau} d\\tau = \\mu \\left[ \\frac{-1}{\\lambda+\\mu} e^{-(\\lambda+\\mu)\\tau} \\right]_0^\\infty = \\mu \\left( 0 - \\frac{-1}{\\lambda+\\mu} \\right) = \\frac{\\mu}{\\lambda+\\mu}$$\n将此结果代回 $E[c_H]$ 的方程中：\n$$E[c_H] = (E[c_H] + 1) \\frac{\\mu}{\\lambda+\\mu}$$\n$$E[c_H](\\lambda+\\mu) = (E[c_H] + 1)\\mu$$\n$$E[c_H]\\lambda + E[c_H]\\mu = E[c_H]\\mu + \\mu$$\n$$E[c_H]\\lambda = \\mu$$\n$$E[c_H] = \\frac{\\mu}{\\lambda}$$\n这就是一个热门页面的稳态期望计数。PASTA（泊松到达看到时间平均，Poisson Arrivals See Time Averages）属性意味着，在一次到达之前的这个期望计数也就是时间平均的期望计数。我们将使用这个值作为需要超越的基准。\n\n**第 2 步：计算页面 $X$ 在其突发访问后的计数**\n\n页面 $X$ 是新的，所以其计数从 $c_X=0$ 开始。它经历了一次包含 $b$ 次引用的突发访问。问题陈述假设在突发期间老化可以忽略不计 ($\\lambda b \\tau_b \\ll 1$)。这意味着我们可以忽略在短暂的突发持续时间内的指数衰减。每次访问的计数更新规则是 $c_X(t^+) = c_X(t^-) + 1$。从 0 开始，经过 $b$ 次这样的更新后，页面 $X$ 的计数将是：\n$$c_X^{\\text{after burst}} = b$$\n\n**第 3 步：确定最小突发长度 $b_{\\min}$**\n\n为避免成为被淘汰的受害者，页面 $X$ 的计数必须严格大于现任热门页面的期望计数。\n$$c_X^{\\text{after burst}}  E[c_H]$$\n$$b  \\frac{\\mu}{\\lambda}$$\n由于突发长度 $b$ 必须是整数，满足此严格不等式的最小整数 $b$ 值比右侧值的向下取整大一。\n$$b_{\\min} = \\left\\lfloor \\frac{\\mu}{\\lambda} \\right\\rfloor + 1$$\n这就是新近流行的页面 $X$ 为克服 LFU 的冷启动偏差并在内存系统中建立驻留所需的最小整数突发长度。", "answer": "$$\\boxed{\\left\\lfloor \\frac{\\mu}{\\lambda} \\right\\rfloor + 1}$$", "id": "3629731"}, {"introduction": "将抽象算法转化为实际系统时，我们必须考虑实现层面的约束。本练习探讨了一个普遍存在的工程问题：用于存储页面访问频率的计数器精度有限。你将量化因简单截断取整（truncation）导致的性能下降，并分析“随机取整”（stochastic rounding）这一更精妙的技术如何能够有效减少量化偏差，从而恢复算法的性能。[@problem_id:3629750]", "problem": "一个虚拟内存系统使用最不经常使用 (LFU) 页面置换算法，其频率估计是在最近 $W$ 次引用的滑动窗口上计算的。请求遵循独立引用模型 (IRM)：每次引用时，页面 $P_i$ 以固定的概率 $p_i$ 被独立请求，并且该序列随时间独立同分布。缓存持有 $K=2$ 个页面，且恰好有 3 个页面 $\\{P_1,P_2,P_3\\}$，其请求概率分别为 $p_1 = 0.51$，$p_2 = 0.25$ 和 $p_3 = 0.24$。LFU 频率估计中的平局通过均匀随机的方式打破。\n\nLFU 实现为每个页面 $P_i$ 存储一个使用 $b$ 位精度的量化归一化频率估计值 $\\hat{f}_i$。具体来说，设真实归一化频率为 $f_i$（窗口内的经验计数除以 $W$）。量化器具有均匀的步长 $\\Delta = \\frac{1}{2^{b}-1}$，并将 $f_i$ 映射到 $\\hat{f}_i = \\Delta \\left\\lfloor \\frac{f_i}{\\Delta} \\right\\rfloor$（确定性截断）。您可以假设 $W$ 很大，因此在稳态下 $f_i \\approx p_i$。\n\n1) 从 IRM 定义和 LFU 策略出发，仅使用给定的 $p_i$ 和 $K$，推导出在完美精度下（无量化）的稳态缺失率。\n\n2) 使用在 $b=4$ 位的确定性截断下的量化估计值 $\\hat{f}_i$，通过直接从量化排名和所述的平局打破规则进行推理，推导出期望缺失率。\n\n3) 为了减少量化偏差，考虑随机舍入：如果 $f \\in [k\\Delta,(k+1)\\Delta)$，则以概率 $\\theta = \\frac{f - k\\Delta}{\\Delta}$ 舍入到 $(k+1)\\Delta$，并以概率 $1-\\theta$ 舍入到 $k\\Delta$，页面之间独立进行。使用相同的稳态近似 $f_i \\approx p_i$，推导出在此随机舍入方案下的期望缺失率。\n\n4) 在 $R = 10{,}000$ 次引用的范围内，计算随机舍入相比确定性截断所实现的期望缺失次数的减少量，即确定性截断下的期望缺失次数减去随机舍入下的期望缺失次数。请以单个实数形式提供最终答案。无需四舍五入，答案中不应包含任何单位。", "solution": "该问题要求分析在不同频率估计方案下，最不经常使用 (LFU) 页面置换算法。这个问题定义明确，具有科学依据，并为获得唯一解提供了所有必要数据。我们将按顺序解决问题的四个部分。\n\n系统有一个大小为 $K=2$ 的缓存，并且有三个页面 $\\{P_1, P_2, P_3\\}$，它们的访问概率分别为 $p_1 = 0.51$，$p_2 = 0.25$ 和 $p_3 = 0.24$。引用流遵循独立引用模型 (IRM)，因此每次访问都是独立的。我们使用稳态近似，即在一个大窗口上测得的频率 $f_i$ 约等于真实概率 $p_i$，即 $f_i \\approx p_i$。当请求的页面不在缓存中时，会发生页面错误或缺失。缺失率是此类事件发生的概率。\n\n**1) 完美精度下的稳态缺失率**\n\n在完美精度下，LFU 算法根据页面的真实访问概率 $p_i$ 对页面进行排序。大小为 $K=2$ 的缓存将持有概率最高的两个页面。给定的概率为 $p_1 = 0.51$，$p_2 = 0.25$ 和 $p_3 = 0.24$。因此，排名为 $p_1  p_2  p_3$。\n\nLFU 缓存将包含页面 $\\{P_1, P_2\\}$。当且仅当请求的页面不在此集合中时，才会发生缺失。唯一不在缓存中的页面是 $P_3$。请求 $P_3$ 的概率是 $p_3$。\n因此，完美精度下的稳态缺失率 $M_{ideal}$ 为：\n$$\nM_{ideal} = p_3 = 0.24\n$$\n\n**2) 确定性截断下的期望缺失率**\n\n对于此部分，频率估计使用 $b=4$ 位进行量化。量化步长 $\\Delta$ 为：\n$$\n\\Delta = \\frac{1}{2^b - 1} = \\frac{1}{2^4 - 1} = \\frac{1}{15}\n$$\n确定性截断规则将真实频率 $f_i$ 映射到其量化估计值 $\\hat{f}_i$ 如下：\n$$\n\\hat{f}_i = \\Delta \\left\\lfloor \\frac{f_i}{\\Delta} \\right\\rfloor\n$$\n使用近似 $f_i \\approx p_i$，我们计算每个页面的量化估计值 $\\hat{p}_i$：\n对于 $P_1$：$p_1 = 0.51$。量化步数为 $\\lfloor \\frac{p_1}{\\Delta} \\rfloor = \\lfloor 0.51 \\times 15 \\rfloor = \\lfloor 7.65 \\rfloor = 7$。\n所以，$\\hat{p}_1 = 7 \\Delta = \\frac{7}{15}$。\n\n对于 $P_2$：$p_2 = 0.25$。量化步数为 $\\lfloor \\frac{p_2}{\\Delta} \\rfloor = \\lfloor 0.25 \\times 15 \\rfloor = \\lfloor 3.75 \\rfloor = 3$。\n所以，$\\hat{p}_2 = 3 \\Delta = \\frac{3}{15}$。\n\n对于 $P_3$：$p_3 = 0.24$。量化步数为 $\\lfloor \\frac{p_3}{\\Delta} \\rfloor = \\lfloor 0.24 \\times 15 \\rfloor = \\lfloor 3.6 \\rfloor = 3$。\n所以，$\\hat{p}_3 = 3 \\Delta = \\frac{3}{15}$。\n\n基于这些量化估计的页面排名是 $\\hat{p}_1  \\hat{p}_2 = \\hat{p}_3$。页面 $P_1$ 具有最高排名，将位于缓存中。第二个缓存槽位在 $P_2$ 和 $P_3$ 之间存在平局。问题陈述，平局通过均匀随机的方式打破。这意味着第二个槽位将以 $0.5$ 的概率被 $P_2$ 占据，并以 $0.5$ 的概率被 $P_3$ 占据。\n\n这导致在稳态下有两种可能的缓存状态：\n-   状态 $C_A = \\{P_1, P_2\\}$，以 $0.5$ 的概率发生。此状态下的缺失率为 $p_3 = 0.24$。\n-   状态 $C_B = \\{P_1, P_3\\}$，以 $0.5$ 的概率发生。此状态下的缺失率为 $p_2 = 0.25$。\n\n确定性截断下的期望缺失率 $M_{trunc}$ 是这些状态下缺失率的加权平均值：\n$$\nM_{trunc} = 0.5 \\times p_3 + 0.5 \\times p_2 = \\frac{1}{2}(p_2 + p_3) = \\frac{1}{2}(0.25 + 0.24) = \\frac{0.49}{2} = 0.245\n$$\n\n**3) 随机舍入下的期望缺失率**\n\n引入随机舍入以减轻截断带来的偏差。对于一个值 $f \\in [k\\Delta, (k+1)\\Delta)$，它以概率 $\\theta = \\frac{f - k\\Delta}{\\Delta}$ 向上舍入到 $(k+1)\\Delta$，并以概率 $1-\\theta$ 向下舍入到 $k\\Delta$。令 $\\tilde{p}_i$ 表示 $p_i$ 的随机舍入估计值。\n\n对于 $P_1$ ($p_1 = 0.51$)：$p_1$ 位于区间 $[7\\Delta, 8\\Delta)$。\n向上舍入到 $8\\Delta = 8/15$ 的概率为 $\\theta_1 = \\frac{0.51 - 7/15}{1/15} = 15 \\times 0.51 - 7 = 7.65 - 7 = 0.65$。\n$\\tilde{p}_1$ 以 $0.65$ 的概率为 $8/15$，以 $1-0.65 = 0.35$ 的概率为 $7/15$。无论哪种情况，$\\tilde{p}_1$ 都至少为 $7/15$。\n\n对于 $P_2$ ($p_2 = 0.25$)：$p_2$ 位于区间 $[3\\Delta, 4\\Delta)$。\n向上舍入到 $4\\Delta = 4/15$ 的概率为 $\\theta_2 = \\frac{0.25 - 3/15}{1/15} = 15 \\times 0.25 - 3 = 3.75 - 3 = 0.75$。\n$\\tilde{p}_2$ 以 $0.75$ 的概率为 $4/15$，以 $1-0.75 = 0.25$ 的概率为 $3/15$。\n\n对于 $P_3$ ($p_3 = 0.24$)：$p_3$ 位于区间 $[3\\Delta, 4\\Delta)$。\n向上舍入到 $4\\Delta = 4/15$ 的概率为 $\\theta_3 = \\frac{0.24 - 3/15}{1/15} = 15 \\times 0.24 - 3 = 3.6 - 3 = 0.6$。\n$\\tilde{p}_3$ 以 $0.6$ 的概率为 $4/15$，以 $1-0.6 = 0.4$ 的概率为 $3/15$。\n\n$\\tilde{p}_2$ 和 $\\tilde{p}_3$ 的最大可能值为 $4/15$，而 $\\tilde{p}_1$ 的最小可能值为 $7/15$。因此，$\\tilde{p}_1$ 始终是排名最高的估计值，而 $P_1$ 始终在缓存中。第二个缓存槽位的竞争在 $P_2$ 和 $P_3$ 之间展开。$P_2$ 和 $P_3$ 的舍入结果是独立的。我们分析 $\\tilde{p}_2$ 和 $\\tilde{p}_3$ 的可能排名：\n\n-   $\\tilde{p}_2  \\tilde{p}_3$：这种情况仅在 $\\tilde{p}_2=4/15$ 且 $\\tilde{p}_3=3/15$ 时发生。\n    其概率为 $P(\\tilde{p}_2=4/15) \\times P(\\tilde{p}_3=3/15) = 0.75 \\times 0.4 = 0.3$。\n    在这种情况下，缓存包含 $\\{P_1, P_2\\}$，缺失率为 $p_3 = 0.24$。\n\n-   $\\tilde{p}_3  \\tilde{p}_2$：这种情况仅在 $\\tilde{p}_3=4/15$ 且 $\\tilde{p}_2=3/15$ 时发生。\n    其概率为 $P(\\tilde{p}_3=4/15) \\times P(\\tilde{p}_2=3/15) = 0.6 \\times 0.25 = 0.15$。\n    在这种情况下，缓存包含 $\\{P_1, P_3\\}$，缺失率为 $p_2 = 0.25$。\n\n-   $\\tilde{p}_2 = \\tilde{p}_3$：如果两者都为 $4/15$ 或都为 $3/15$，则发生这种情况。\n    -   $P(\\tilde{p}_2=4/15 \\text{ 且 } \\tilde{p}_3=4/15) = 0.75 \\times 0.6 = 0.45$。\n    -   $P(\\tilde{p}_2=3/15 \\text{ 且 } \\tilde{p}_3=3/15) = 0.25 \\times 0.4 = 0.10$。\n    平局的总概率为 $0.45 + 0.10 = 0.55$。\n    在平局的情况下，第二个槽位以各 $0.5$ 的概率分配给 $P_2$ 或 $P_3$。平局期间的期望缺失率为 $\\frac{1}{2}p_2 + \\frac{1}{2}p_3 = 0.245$。\n\n随机舍入下的总期望缺失率 $M_{stoch}$ 是这些结果的期望之和：\n$$\nM_{stoch} = (0.3 \\times p_3) + (0.15 \\times p_2) + (0.55 \\times (\\frac{p_2+p_3}{2}))\n$$\n$$\nM_{stoch} = 0.3 \\times 0.24 + 0.15 \\times 0.25 + 0.55 \\times 0.245\n$$\n$$\nM_{stoch} = 0.072 + 0.0375 + 0.13475 = 0.24425\n$$\n或者，我们可以计算 $P_2$ 在缓存中的总概率（因此 $P_3$ 不在）。如果 $P_2$ 直接获胜或在平局中获胜，就会发生这种情况。\n$P(P_2 \\text{ 在缓存中}) = P(\\tilde{p}_2  \\tilde{p}_3) + 0.5 \\times P(\\tilde{p}_2 = \\tilde{p}_3) = 0.3 + 0.5 \\times 0.55 = 0.3 + 0.275 = 0.575$。\n$P_3$ 在缓存中的概率是 $1 - 0.575 = 0.425$。\n期望缺失率为：\n$$\nM_{stoch} = P(P_2 \\text{ 在缓存中}) \\times p_3 + P(P_3 \\text{ 在缓存中}) \\times p_2\n$$\n$$\nM_{stoch} = 0.575 \\times 0.24 + 0.425 \\times 0.25 = 0.138 + 0.10625 = 0.24425\n$$\n\n**4) 期望缺失次数的减少量**\n\n在 $R = 10{,}000$ 次引用的范围内，我们可以计算两种量化方案的期望缺失次数。\n使用确定性截断的期望缺失次数：\n$$\nN_{trunc} = R \\times M_{trunc} = 10{,}000 \\times 0.245 = 2450\n$$\n使用随机舍入的期望缺失次数：\n$$\nN_{stoch} = R \\times M_{stoch} = 10{,}000 \\times 0.24425 = 2442.5\n$$\n随机舍入相比确定性截断所实现的期望缺失次数的减少量是两者之差：\n$$\n\\text{减少量} = N_{trunc} - N_{stoch} = 2450 - 2442.5 = 7.5\n$$\n这个正值证实了，在这种情况下，随机舍入通过更好地保持真实概率的相对顺序，提供了优于确定性截断的性能改进。", "answer": "$$\\boxed{7.5}$$", "id": "3629750"}]}