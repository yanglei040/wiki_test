{"hands_on_practices": [{"introduction": "首先，我们必须巩固对彩票调度和步进调度的基本区别的理解。这个练习 [@problem_id:3630099] 要求你评估两种算法的核心机制，重点关注概率性保证与确定性分配之间的对比。通过这个练习，你将明白为什么步进调度常被描述为彩票调度的一种去随机化版本。", "problem": "在一个单处理器机器上，操作系统必须在一组可运行的进程之间分配中央处理器（CPU）时间。考虑$3$个计算密集型进程$P_1$、$P_2$和$P_3$，它们持续可运行，并消耗持续时间为$q$（$q$固定）的相同长度的时间量程。每个进程$i$被分配一个非负整数的票数$t_i$，总票数为$T=\\sum_i t_i$。调度器支持两种方案：\n\n- 彩票调度：在每次调度时，它从$\\{1,\\dots,T\\}$范围内均匀随机地抽取一张中奖彩票，并让拥有该中奖彩票的进程运行一个时间量程$q$。\n- 步进调度：每个进程$i$维护一个通行值$p_i$（初始为$p_i=0$）和一个步幅$S_i$（每个进程一个正常数）。在每次调度时，调度器选择通行值最小的进程，然后将其通行值增加其步幅，即$p_i \\leftarrow p_i + S_i$。平局情况通过一致的规则解决，例如通过最小的进程标识符。\n\n基本事实和定义如下：比例份额调度的目标是使进程$i$在长期内获得的CPU时间份额等于$t_i/T$；单次彩票抽奖的概率为进程$i$在该次抽奖中被选中的机会是$t_i/T$；内核中倾向于使用整数算术以避免浮点运算，长期公平性通过比较一个进程收到的累积时间量程数与其目标$t_i/T$乘以已经过的时间量程数来评估。\n\n在这些基础上，要求步进调度在可运行进程集静态、时间量程持续时间$q$固定、以及票数$\\{t_i\\}$固定的假设下，实现无随机性的确定性比例共享。设$L$是实现者选择的一个固定正整数，用于实现整数算术并作为公共缩放因子。推导步幅$S_i$以$t_i$和$L$表示的形式，以确定性地实现比例份额目标，并论证确定性如何受$L$的缩放和动态到达的影响。为具体起见，考虑票数分配$t_1=7$，$t_2=5$，$t_3=2$，以及实现选择$L=70$。\n\n下列哪些陈述是正确的？选择所有适用的选项。\n\nA. 在步进调度中，为了使拥有较大$t_i$的进程在最小通行值规则下更频繁地运行，步幅必须与票数成反比；在固定的初始$p_i=0$、静态可运行集和固定的$q$条件下，选择与$1/t_i$成比例并带有一个整数缩放因子$L$的$S_i$会产生一个确定性的调度顺序。\n\nB. 在彩票调度中，为随机数生成器（RNG）设定种子会固定选择序列，并且该序列与步进调度为相同票数分配$\\{t_i\\}$所产生的序列相同。\n\nC. 将所有步幅乘以一个公共正常数$c$不会改变最小通行值调度顺序；因此增加$L$只会重新缩放通行值，而不会影响选择顺序的确定性。\n\nD. 当一个拥有$t_4>0$张票的新进程$P_4$在时间$t$（以时间量程为单位）到达，并以适当的步幅和初始化的$p_4=0$插入到步进调度中时，现有进程$\\{P_1,P_2,P_3\\}$的绝对调度时间不受此到达事件的影响。\n\nE. 在彩票调度中，经过$n$个时间量程后，进程$i$收到的时间量程数是一个均值为$n\\cdot t_i/T$且方差非零的二项随机变量；在步进调度中，在相同的静态假设下，进程$i$收到的时间量程数对于每个有限的$n$都恰好是$n\\cdot t_i/T$。", "solution": "问题陈述描述并对比了两种比例份额CPU调度算法：彩票调度和步进调度。问题的核心是推导步进调度的操作原理以实现确定性的比例共享，然后基于两种算法的属性评估几个陈述。\n\n首先，我将验证问题陈述的有效性。\n**第一步：提取已知条件**\n-   进程：$P_1$，$P_2$，$P_3$，计算密集型，持续可运行。\n-   时间量程：持续时间$q$，固定。\n-   票数：进程$i$的非负整数$t_i$。总票数$T=\\sum_i t_i$。\n-   彩票调度：每次调度时，从$\\{1, \\dots, T\\}$中均匀随机抽取一张票。票的拥有者运行一个时间量程。\n-   步进调度：每个进程$i$有一个通行值$p_i$（初始为$p_i=0$）和一个步幅$S_i$（正常数）。调度器选择$p_i$最小的进程，并更新其通行值$p_i \\leftarrow p_i + S_i$。平局由最小的进程标识符解决。\n-   目标：比例份额，即进程$i$长期获得的CPU时间份额等于$t_i/T$。\n-   实现细节：使用一个固定的正整数$L$进行整数运算。\n-   示例数据：$t_1=7$，$t_2=5$，$t_3=2$。$L=70$。\n\n**第二步：使用提取的已知条件进行验证**\n问题陈述在科学上是合理的，描述了操作系统文献中的标准计算机科学概念（特别是 Waldspurger 和 Weihl 的工作）。算法定义明确，术语（票数、步幅、通行值）是标准的。问题提法得当，提供了初始条件（$p_i=0$）、平局解决规则和明确的目标。它自成一体，没有矛盾或歧义。数值示例是一致的，用于说明原理。\n\n**结论**：问题有效。我将继续进行推导和评估。\n\n**推导与分析**\n\n步进调度的目标是确保在总共调度了$N$个时间量程后，进程$i$收到的时间量程数（我们称之为$c_i(N)$）与其票数分配$t_i$成正比。\n$$ \\frac{c_i(N)}{N} \\approx \\frac{t_i}{T} $$\n在步进调度中，给定初始条件$p_i=0$，一个被调度了$c_i$次的进程$i$的通行值为$p_i = c_i \\cdot S_i$。调度器总是选择当前通行值最小的进程。这个机制使得所有活动进程的通行值彼此接近。在很长一段时间内，对于任意两个进程$i$和$j$，它们的通行值将约等于，$p_i \\approx p_j$。\n$$ c_i \\cdot S_i \\approx c_j \\cdot S_j $$\n这意味着：\n$$ \\frac{c_i}{c_j} \\approx \\frac{S_j}{S_i} $$\n为了实现比例共享，我们要求收到的时间量程之比等于票数之比：\n$$ \\frac{c_i}{c_j} = \\frac{t_i}{t_j} $$\n比较这两个表达式，我们必须有：\n$$ \\frac{t_i}{t_j} = \\frac{S_j}{S_i} \\implies t_i S_i = t_j S_j $$\n这表明乘积$t_i S_i$对于所有进程必须是一个常数。设这个常数为$L$。\n$$ t_i S_i = L \\implies S_i = \\frac{L}{t_i} $$\n因此，进程$i$的步幅$S_i$必须与其票数$t_i$成反比。常数$L$是一个大数，选择它是为了确保步幅$S_i$可以表示为整数，例如，通过选择$L$作为所有$t_i$的最小公倍数。\n\n对于给定的例子：$t_1=7, t_2=5, t_3=2$。$T=14$。当$L=70$时：\n$S_1 = 70/7 = 10$\n$S_2 = 70/5 = 14$\n$S_3 = 70/2 = 35$\n\n拥有更多票数（例如，$P_1$）的进程具有较小的步幅，导致其通行值增加得更慢，因此根据最小通行值规则被更频繁地选中。该算法是确定性的：给定初始状态，进程选择的序列是固定的。\n\n**逐项分析**\n\n**A. 在步进调度中，为了使拥有较大$t_i$的进程在最小通行值规则下更频繁地运行，步幅必须与票数成反比；在固定的初始$p_i=0$、静态可运行集和固定的$q$条件下，选择与$1/t_i$成比例并带有一个整数缩放因子$L$的$S_i$会产生一个确定性的调度顺序。**\n\n这个陈述包含两部分。\n1.  “……步幅必须与票数成反比……”：如上所述，为了让拥有较大$t_i$的进程更频繁地运行，其通行值必须增长得更慢。由于每次运行时通行值增加步幅$S_i$，因此对于较大的$t_i$，$S_i$必须更小。我们的推导得出$S_i = L/t_i$，证实了这种反比关系。\n2.  “……会产生一个确定性的调度顺序……”：步进调度算法本身是确定性的。它的规则——选择最小通行值，增加通行值，一致地解决平局——不涉及任何随机性。给定一个固定的进程集、固定的步幅和固定的初始通行值，整个调度序列是唯一确定的。\n陈述的两个部分都是正确的。\n\n结论：**正确**。\n\n**B. 在彩票调度中，为随机数生成器（RNG）设定种子会固定选择序列，并且该序列与步进调度为相同票数分配$\\{t_i\\}$所产生的序列相同。**\n\n为伪随机数生成器（PRNG）设定种子确实会产生一个固定的、确定性的数字序列。这将固定彩票调度的选择序列。然而，这个序列本质上是一个由概率$p_i = t_i/T$支配的随机过程的样本路径。彩票调度内部没有机制能确保在短时间内实现低差异分配。相比之下，步进调度是一种确定性算法，专门设计用于在每一步都最小化已接收和目标CPU份额之间的误差。这两种算法在类型上是不同的。例如，一个PRNG序列可能会连续多次选择同一个进程，这在步进调度中是极不可能的（因为其通行值会变得很大）。它们产生的序列是不同的。\n\n结论：**不正确**。\n\n**C. 将所有步幅乘以一个公共正常数$c$不会改变最小通行值调度顺序；因此增加$L$只会重新缩放通行值，而不会影响选择顺序的确定性。**\n\n设原始步幅为$S_i$，通行值为$p_i$。设新步幅为$S'_i = c \\cdot S_i$，对于某个常数$c>0$，新通行值为$p'_i$。假设调度序列直到某个步骤$k$都是相同的。那么每个进程$i$运行的次数$c_i$在两个系统中是相同的。通行值为$p_i = c_i S_i$和$p'_i = c_i S'_i = c_i(c S_i) = c (c_i S_i) = c \\cdot p_i$。所以，新的通行值集合只是旧的通行值集合按因子$c$缩放。调度器选择通行值最小的进程$j$。如果对于所有$i$都有$p_j \\le p_i$，那么因为$c>0$，所以$c \\cdot p_j \\le c \\cdot p_i$也成立，这意味着对于所有$i$都有$p'_j \\le p'_i$。同一个进程$j$被选中。如果出现平局，$p_j = p_k$，则意味着$p'_j = c p_j = c p_k = p'_k$，所以会发生相同的平局，并由相同的平局解决规则处理。因此，调度序列保持不变。将$L$增加到$L'$等同于选择一个缩放因子$c = L'/L$。新的步幅是$S'_i = L'/t_i = (L'/L) \\cdot (L/t_i) = c \\cdot S_i$。这与刚才分析的情景完全匹配。调度顺序不受影响。\n\n结论：**正确**。\n\n**D. 当一个拥有$t_4>0$张票的新进程$P_4$在时间$t$（以时间量程为单位）到达，并以适当的步幅和初始化的$p_4=0$插入到步进调度中时，现有进程$\\{P_1,P_2,P_3\\}$的绝对调度时间不受此到达事件的影响。**\n\n当$P_4$在时间$t$到达时，它被添加到可运行进程集中，其$p_4=0$。假设系统已经至少运行了一个时间量程，所有现有进程$\\{P_1, P_2, P_3\\}$的通行值都将大于$0$。因此，$P_4$将拥有唯一的最小通行值。根据调度规则，$P_4$将在下一个可用的时间量程（即时间$t$）被调度。这将取代原定在时间$t$运行的任何一个进程$\\{P_1, P_2, P_3\\}$。这种变化会传播下去，因为通行值和未来的顺序现在都不同了。例如，如果$P_1$原定于时间$t$运行，$P_2$原定于时间$t+1$运行，那么$P_4$的到来可能导致$P_4$在$t$运行，从而将$P_1$的下一次运行推迟到更晚的时间。因此，现有进程的绝对调度时间会受到影响。\n\n结论：**不正确**。\n\n**E. 在彩票调度中，经过$n$个时间量程后，进程$i$收到的时间量程数是一个均值为$n\\cdot t_i/T$且方差非零的二项随机变量；在步进调度中，在相同的静态假设下，进程$i$收到的时间量程数对于每个有限的$n$都恰好是$n\\cdot t_i/T$。**\n\n该陈述的第一部分是对彩票调度的准确描述。在每个时间量程选择一个进程是一个独立的伯努利试验，成功概率为$p = t_i/T$。$n$次此类试验的总和是一个二项随机变量$B(n, p)$，其均值为$np = n \\cdot t_i/T$，方差为$np(1-p) = n(t_i/T)(1-t_i/T)$，当$0  < t_i  < T$时，方差非零。\n陈述的第二部分声称，对于步进调度，时间量程数$c_i(n)$对于*每个*有限的$n$都*恰好*等于其目标份额$n \\cdot t_i/T$。这是错误的。时间量程数$c_i(n)$必须是一个整数，而目标份额$n \\cdot t_i/T$通常是一个非整数的有理数。例如，如果$t_1=7, T=14$，对于$n=1$，目标是$1 \\cdot 7/14 = 0.5$。实际收到的时间量程将是$1$（如果$P_1$被选中）或$0$（如果未被选中）。两者都不等于$0.5$。虽然步进调度非常精确，并确保$|c_i(n) - n \\cdot t_i/T| < 1$，但它并不保证对所有的$n$都完全相等。\n\n结论：**不正确**。", "answer": "$$\\boxed{AC}$$", "id": "3630099"}, {"introduction": "理论上的公平性取决于其实际实现，而一个关键挑战是精确的 CPU 时间核算。在真实系统中，硬件中断等事件可能会“窃取”进程的时间，本练习 [@problem_id:3655175] 将探讨如何补偿这种不精确性。你将计算一个进程的步进值所需进行的必要修正，这是在面对系统级事件时维持公平性的关键一步。", "problem": "一个单处理器操作系统 (OS) 使用彩票调度 (lottery scheduling) 来在三个计算密集型进程之间分配中央处理器 (CPU)。为了确定性地近似彩票调度的长期比例公平性，该操作系统还维护步进调度 (stride-scheduling) 记账：每个进程 $i$ 有一个固定的步进值 $s_i$ 和一个通行值 $\\mathrm{pass}_i$；调度器选择具有最小 $\\mathrm{pass}_i$ 的进程下次运行，并且在一次运行后，根据其*实际*获得的CPU时间来增加其 $\\mathrm{pass}_i$。彩票分配如下：进程 $A$ 有 $50$ 张彩票，进程 $B$ 有 $30$ 张彩票，进程 $C$ 有 $20$ 张彩票。步进基数是 $L = 10{,}000$，因此一个拥有 $T$ 张彩票的进程的步进值是 $s = L/T$。时间量程是 $q = 10\\,\\mathrm{ms}$。\n\n在一个调度回合中，彩票抽奖选中了进程 $A$，它被分派执行。然而，在 $A$ 的时间片期间，一个设备中断抵达，并由内核处理了 $h = 0.6\\,\\mathrm{ms}$。操作系统的当前运行时记账错误地向进程 $A$ 收取了整个时钟时间量程 $q$ 的费用，尽管在这段时间的一部分里 CPU 执行了内核中断代码，并且没有推进 $A$ 自己的计算。你可以假设中断处理程序不是代表进程 $A$ 的地址空间执行的，并且为了公平性目的，不应计为授予 $A$ 的 CPU 时间。\n\n仅使用以下核心定义：(i) 彩票调度旨在实现比例公平，使得进程 $i$ 长期获得的 CPU 时间与其彩票数成比例，以及 (ii) 步进调度通过将进程的通行值按授予的 CPU 时间相对于其步进值的比例增加来确定性地实现这一点，请确定在此调度回合后是否需要补偿以维持公平性，并计算必须立即应用于进程 $A$ 的通行值的确切修正值 $\\Delta \\mathrm{pass}$，以维持比例公平性。如果通行值应减少该数量（即先前应用的增量过大），则将 $\\Delta \\mathrm{pass}$ 定义为正数；如果不需要补偿，则定义为零。\n\n请以通行值为单位，给出一个等于 $\\Delta \\mathrm{pass}$ 的实数作为最终答案。无需四舍五入。", "solution": "首先验证问题陈述的正确性和可解性。\n\n**步骤1：提取给定信息**\n- 进程数量：$3$ (命名为 $A$, $B$, $C$）。\n- 调度环境：使用彩票调度和步进调度的单处理器操作系统。\n- 彩票分配：进程 $A$ 有 $T_A = 50$ 张彩票，进程 $B$ 有 $T_B = 30$ 张彩票，进程 $C$ 有 $T_C = 20$ 张彩票。\n- 步进基数：$L = 10,000$。\n- 步进公式：对于拥有 $T_i$ 张彩票的进程 $i$，$s_i = L/T_i$。\n- 时间量程：$q = 10\\,\\mathrm{ms}$。\n- 调度事件：进程 $A$ 被分派。\n- 中断时间：在 $A$ 的时间片内，一个中断被处理了 $h = 0.6\\,\\mathrm{ms}$。\n- 记账错误：进程 $A$ 被错误地收取了完整量程 $q$ 的费用。\n- 公平性条件：为公平目的授予进程的时间不包括内核处理非直接代表该进程的中断所花费的时间。\n- 目标：计算应用于进程 $A$ 通行值的修正值 $\\Delta \\mathrm{pass}$。\n- $\\Delta \\mathrm{pass}$ 的定义：$\\Delta \\mathrm{pass} > 0$ 表示通行值的减少，对应于被应用的超额增量。\n\n**步骤2：使用提取的给定信息进行验证**\n该问题在操作系统和 CPU 调度算法领域内定义明确。彩票调度及其确定性对应物——步进调度，是标准课题。在时间片期间发生中断以及随后需要正确进行 CPU 时间记账的情景，是操作系统实现中的一个实际且现实的考虑。所有必要的参数（$T_A$, $L$, $q$, $h$）都已提供，并且目标陈述清晰。定义和关系在内部是一致的，并基于已建立的计算机科学原理。该问题在科学上是合理的、提法得当且客观的。\n\n**步骤3：结论与行动**\n问题有效。将提供一个有理有据的解决方案。\n\n**解题推导**\n步进调度的核心原则是实现长期比例公平，即分配给一个进程的 CPU 时间与其彩票分配成正比。这是通过让每个进程 $i$ 维护一个通行值 $\\mathrm{pass}_i$ 来实现的。调度器总是选择具有最小通行值的进程来运行。一个进程运行后，其通行值会增加以反映其消耗的资源，从而在一段时间内降低其调度优先级。\n\n步进值 $s_i$ 是一个进程在消耗了一个完整的标准资源单位（通常是一个时间量程 $q$）后，其通行值增加的量。步进值与进程的彩票数 $T_i$ 成反比，由公式 $s_i = L/T_i$ 定义，其中 $L$ 是一个大常数（步进基数）。这种反比关系确保了拥有更多彩票（期望份额更高）的进程具有更小的步进值，导致其通行值增长得更慢，从而更频繁地被调度。\n\n对于进程 $A$，其彩票数为 $T_A = 50$，步进基数为 $L = 10,000$。因此，其步进值 $s_A$ 为：\n$$s_A = \\frac{L}{T_A} = \\frac{10,000}{50} = 200$$\n\n问题陈述指出，通行值的增量应反映进程*实际获得*的 CPU 时间。这意味着增量与收到的有用 CPU 时间成正比。$s_A$ 的标准增量对应于接收一个完整量程 $q$ 的有用 CPU 时间。\n\n在给定场景中，进程 $A$ 被分派了一个 $q = 10\\,\\mathrm{ms}$ 的时间量程。然而，在此期间，CPU 被一个中断处理程序占用了 $h = 0.6\\,\\mathrm{ms}$。这段时间不计入进程 $A$ 的计算。因此，进程 $A$ 实际获得的有用 CPU 时间是：\n$$t_{\\text{actual}} = q - h = 10\\,\\mathrm{ms} - 0.6\\,\\mathrm{ms} = 9.4\\,\\mathrm{ms}$$\n\n对进程 $A$ 通行值的正确增量 $\\Delta \\mathrm{pass}_{\\text{correct}}$，应与此实际时间成正比。如果一个完整量程 $q$ 产生 $s_A$ 的增量，那么 $t_{\\text{actual}}$ 的时间应产生如下增量：\n$$\\Delta \\mathrm{pass}_{\\text{correct}} = s_A \\times \\frac{t_{\\text{actual}}}{q} = s_A \\times \\frac{q - h}{q}$$\n\n然而，操作系统的记账机制出了错，向进程 $A$ 收取了整个时钟时间量程 $q$ 的费用。这导致了一个不正确的增量 $\\Delta \\mathrm{pass}_{\\text{incorrect}}$，其值等于完整的步进值：\n$$\\Delta \\mathrm{pass}_{\\text{incorrect}} = s_A$$\n\n问题要求的是补偿值 $\\Delta \\mathrm{pass}$，即应用的增量超过正确增量的部分。这个值必须从进程 $A$ 的当前通行值中减去，以恢复公平性。\n$$\\Delta \\mathrm{pass} = \\Delta \\mathrm{pass}_{\\text{incorrect}} - \\Delta \\mathrm{pass}_{\\text{correct}}$$\n\n代入不正确和正确的增量表达式：\n$$\\Delta \\mathrm{pass} = s_A - \\left(s_A \\times \\frac{q - h}{q}\\right)$$\n\n提取公因子 $s_A$：\n$$\\Delta \\mathrm{pass} = s_A \\left(1 - \\frac{q - h}{q}\\right) = s_A \\left(\\frac{q - (q - h)}{q}\\right) = s_A \\left(\\frac{h}{q}\\right)$$\n\n这个结果很直观：通行值的超额计费，是与中断处理程序所占量程比例相对应的步进值部分。\n\n现在，我们将给定的数值代入此表达式：\n- $s_A = 200$\n- $h = 0.6\\,\\mathrm{ms}$\n- $q = 10\\,\\mathrm{ms}$\n\n$$\\Delta \\mathrm{pass} = 200 \\times \\left(\\frac{0.6}{10}\\right) = 200 \\times 0.06 = 12$$\n\n因此，为了补偿不正确的记账，进程 $A$ 的通行值必须减少 $12$。根据问题的定义，这对应于 $\\Delta \\mathrm{pass} = 12$。", "answer": "$$\\boxed{12}$$", "id": "3655175"}, {"introduction": "除了正确性之外，任何系统组件的一个关键方面是其性能开销。这个练习 [@problem_id:3655174] 将我们的焦点转移到做出调度决策的算法成本上，比较一个简单的彩票调度器和一个使用堆数据结构的更复杂的步幅调度器。通过对其成本进行建模，你将确定一个算法变得比另一个更高效的临界点，从而突显出简单性与可扩展性之间的经典权衡。", "problem": "一个操作系统内核团队正在评估两种用于在单个中央处理器（CPU）上选择下一个可运行进程的调度器的单次决策开销：彩票调度和步进调度。该团队将一次调度决策的成本建模为源于算法结构特性和机器测得微操作的基本成本之和，以纳秒表示。以下测量和假设成立：\n\n- 彩票调度使用的伪随机抽取成本为 $c_{\\text{draw}} = 20$ 纳秒。\n- 在调度器内执行的任何单次整数比较（例如，通行值比较或累计彩票数比较）成本为 $c_{\\text{cmp}} = 10$ 纳秒。\n- 彩票调度通过从总彩票数中均匀抽取一个彩票索引，并对进程的累计彩票边界进行朴素的线性扫描来确定获胜者。假设彩票均匀分布在 $n$ 个可运行进程中，因此预期的扫描长度为 $\\frac{n+1}{2}$ 次比较。除了比较和抽取，彩票调度每次决策还会产生一个固定的常数开销 $c_{\\text{lot0}} = 85$ 纳秒（例如，函数调用设置和无比较的数组访问）。\n- 步进调度维护一个以通行值为键的二叉最小堆，以选择具有最小通行值的进程。一次调度决策包括选择根节点，更新其通行值，并将其重新插入。将堆重新插入过程中的比较次数建模为每个堆层级进行 $2$ 次比较，对于 $n$ 个可运行进程，平均情况下堆的高度为 $\\log_{2}(n)$。除了比较，步进调度每次决策还会产生一个固定的常数开销 $c_{\\text{stride0}} = 300$ 纳秒（例如，指针调整和非比较的簿记工作）。\n\n从这些基本要素和结构特性出发，推导出彩票调度和步进调度的预期单次决策开销 $T_{\\text{lot}}(n)$ 和 $T_{\\text{stride}}(n)$ 的表达式，两者均以纳秒为单位，并作为 $n$ 的函数。然后，确定最小的整数可运行进程数 $n^{\\star}$，使得彩票调度的预期开销严格超过步进调度的预期开销，即对于所有 $n \\geq n^{\\star}$，都有 $T_{\\text{lot}}(n) > T_{\\text{stride}}(n)$。将 $n^{\\star}$ 报告为单个整数。最终结果无需四舍五入。所有中间时间均以纳秒表示。", "solution": "题目要求推导彩票调度和步进调度的成本函数，并确定前者成本高于后者的交叉点。\n\n首先，我们必须验证问题陈述。\n已知条件如下：\n- 伪随机抽取的成本，$c_{\\text{draw}} = 20$ 纳秒。\n- 单次整数比较的成本，$c_{\\text{cmp}} = 10$ 纳秒。\n- 彩票调度的固定开销，$c_{\\text{lot0}} = 85$ 纳秒。\n- 步进调度的固定开销，$c_{\\text{stride0}} = 300$ 纳秒。\n- 可运行进程的数量为 $n$。\n- 彩票调度模型：\n  - 每次决策进行一次抽取。\n  - 预期的比较次数为 $\\frac{n+1}{2}$。\n- 步进调度模型：\n  - 使用一个高度为 $\\log_2(n)$ 的二叉最小堆。\n  - 堆重新插入的比较次数为 $2 \\log_2(n)$。\n\n该问题具有科学依据，因为它使用了简化但标准的真实世界调度算法模型和性能分析技术。问题定义明确，提供了构建成本函数和求解所需值的所有必要常数和关系。语言客观而精确。问题没有指定的缺陷，因此被认为是有效的。\n\n我们接下来推导单次决策开销函数 $T_{\\text{lot}}(n)$ 和 $T_{\\text{stride}}(n)$。\n\n对于彩票调度，每次决策的总预期开销 $T_{\\text{lot}}(n)$ 是固定开销、一次伪随机抽取的成本以及线性扫描期间执行的比较的预期成本之和。\n比较的预期成本是预期比较次数与每次比较成本的乘积。\n$$T_{\\text{lot}}(n) = c_{\\text{lot0}} + c_{\\text{draw}} + \\left( \\frac{n+1}{2} \\right) c_{\\text{cmp}}$$\n代入以纳秒为单位的给定值：\n$$T_{\\text{lot}}(n) = 85 + 20 + \\left( \\frac{n+1}{2} \\right) (10)$$\n$$T_{\\text{lot}}(n) = 105 + 5(n+1)$$\n$$T_{\\text{lot}}(n) = 105 + 5n + 5$$\n$$T_{\\text{lot}}(n) = 5n + 110$$\n\n对于步进调度，每次决策的总开销 $T_{\\text{stride}}(n)$ 是其固定开销与堆更新期间比较成本之和。\n比较的成本是比较次数与每次比较成本的乘积。\n$$T_{\\text{stride}}(n) = c_{\\text{stride0}} + (2 \\log_{2}(n)) c_{\\text{cmp}}$$\n代入以纳秒为单位的给定值：\n$$T_{\\text{stride}}(n) = 300 + (2 \\log_{2}(n)) (10)$$\n$$T_{\\text{stride}}(n) = 300 + 20 \\log_{2}(n)$$\n\n接下来，我们必须找到最小的整数进程数 $n^{\\star}$，使得彩票调度的开销严格超过步进调度的开销。我们需要求解不等式 $T_{\\text{lot}}(n) > T_{\\text{stride}}(n)$，找到满足该不等式并且对于所有更大的整数也继续满足该不等式的最小整数 $n$。\n$$5n + 110 > 300 + 20 \\log_{2}(n)$$\n为了简化，我们可以重新排列各项：\n$$5n - 190 > 20 \\log_{2}(n)$$\n两边除以 $5$：\n$$n - 38 > 4 \\log_{2}(n)$$\n\n这是一个超越不等式，无法使用标准代数方法求解 $n$。我们必须对 $n$ 的整数值进行计算，以找到转折点。\n让我们定义一个函数 $h(n) = (n - 38) - (4 \\log_{2}(n))$。我们正在寻找使 $h(n) > 0$ 的最小整数 $n$。左边是 $n$ 的线性函数，而右边是对数函数。线性函数最终将比对数函数增长得更快。为了证实这一点，我们可以考察 $h(n)$ 相对于连续变量 $n$ 的导数：$h'(n) = 1 - \\frac{4}{n \\ln(2)}$。当 $n > \\frac{4}{\\ln(2)} \\approx 5.77$ 时，该导数为正。因此，对于整数 $n \\geq 6$，$h(n)$ 函数是单调递增的。这保证了我们一旦找到满足不等式的最小 $n$，所有后续的整数也将满足它。\n\n我们可以测试 $n$ 的整数值。我们预计交叉点会大于 $38$，因为当 $n \\leq 38$ 时，$n-38$ 这一项是非正的。\n让我们测试 $n = 61$：\n$$61 - 38 > 4 \\log_{2}(61)$$\n$$23 > 4 \\log_{2}(61)$$\n我们知道 $\\log_{2}(64) = 6$ 且 $\\log_{2}(32) = 5$。所以 $\\log_2(61)$ 略小于 $6$。一个更精确的值是 $\\log_2(61) \\approx 5.9307$。\n$$23 > 4 \\times 5.9307$$\n$$23 > 23.7228$$\n这个不等式是错误的。因此，对于 $n=61$，步进调度的成本仍然小于或等于彩票调度。\n\n现在，让我们测试 $n = 62$：\n$$62 - 38 > 4 \\log_{2}(62)$$\n$$24 > 4 \\log_{2}(62)$$\n一个更精确的值是 $\\log_2(62) \\approx 5.9542$。\n$$24 > 4 \\times 5.9542$$\n$$24 > 23.8168$$\n这个不等式是正确的。\n\n由于不等式在 $n=61$ 时为假，在 $n=62$ 时为真，并且差函数 $h(n)$ 在此范围内是单调递增的，因此使得彩票调度开销严格大于步进调度开销的最小整数进程数是 $n^{\\star} = 62$。对于所有 $n \\geq 62$，条件 $T_{\\text{lot}}(n) > T_{\\text{stride}}(n)$ 都将成立。", "answer": "$$\\boxed{62}$$", "id": "3655174"}]}