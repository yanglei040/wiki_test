## 引言
在现代科学与工程计算的广阔领域中，求解形如 $A x = b$ 的大规模[线性方程组](@entry_id:148943)是一个无处不在的核心挑战。无论是模拟天气变化的复杂模型，还是设计下一代飞行器的结构分析，其背后都隐藏着需要高效求解的巨型线性系统。当问题规模变得庞大时，传统的直接求解方法（如[LU分解](@entry_id:144767)）因其高昂的计算和存储成本而变得不切实际。这使得迭代法，特别是[克雷洛夫子空间方法](@entry_id:144111)，成为不可或缺的关键技术。然而，面对诸如[共轭梯度法](@entry_id:143436)（CG）、[广义最小残差法](@entry_id:139566)（GMRES）等众多算法，初学者往往会感到困惑：它们背后的统一思想是什么？各自的优劣何在？又该如何为特定问题选择最合适的方法？

本文旨在系统性地解答这些问题，为读者构建一个关于[克雷洛夫子空间方法](@entry_id:144111)的清晰知识框架。我们将通过三个循序渐进的章节，带领读者从理论走向实践：

- **第一章：原理与机制** 将深入剖析克雷洛夫方法的核心思想——投影。我们将详细阐述[共轭梯度法](@entry_id:143436)（CG）为何在[对称正定系统](@entry_id:172662)中表现卓越，并对比[广义最小残差法](@entry_id:139566)（GMRES）与双[共轭梯度](@entry_id:145712)稳定法（[BiCGSTAB](@entry_id:143406)）在处理非对称问题时，如何在效率与稳健性之间做出不同的权衡。

- **第二章：应用与跨学科联系** 将展示这些方法在计算物理、工程仿真、计算机图形学乃至[量子化学](@entry_id:140193)等不同领域的强大威力。我们将探讨它们如何与[牛顿法](@entry_id:140116)结合形成强大的[非线性求解器](@entry_id:177708)，并被推广应用于求解特征值问题和[矩阵函数](@entry_id:180392)计算。

- **第三章：动手实践** 将通过一系列精心设计的编程练习，让读者亲手实现和分析克雷洛夫方法的关键组成部分，从而将理论知识转化为解决实际问题的能力。

通过阅读本文，你将不仅理解克雷洛夫方法的“如何做”，更能掌握其“为什么”的深层逻辑，为你未来解决复杂的计算问题打下坚实的基础。

## 原理与机制

在上一章中，我们介绍了[求解大型线性系统](@entry_id:145591) $A x = b$ 的重要性，并简要提及了[迭代法](@entry_id:194857)，特别是克雷洛夫子空间法的主导地位。本章将深入探讨这些方法背后的核心原理与关键机制。我们将系统地剖析它们为何有效，各自的[适用范围](@entry_id:636189)，以及在效率和稳健性之间存在的根本性权衡。

### 核心思想：在克雷洛夫子空间上的投影

所有[克雷洛夫子空间方法](@entry_id:144111)都建立在一个共同的、优雅的基础之上：将一个巨大的、难以处理的 $n$ 维求解问题，转化为一系列在低维[子空间](@entry_id:150286)上的、易于求解的投影问题。这个特殊的[子空间](@entry_id:150286)被称为 **[克雷洛夫子空间](@entry_id:751067)** (Krylov subspace)。

给定一个初始猜测解 $x_0$，其初始残差为 $r_0 = b - A x_0$。由矩阵 $A$ 和向量 $r_0$ 生成的 $k$ 阶[克雷洛夫子空间](@entry_id:751067) $\mathcal{K}_k(A, r_0)$ 定义为：
$$
\mathcal{K}_k(A, r_0) = \text{span}\{r_0, A r_0, A^2 r_0, \dots, A^{k-1} r_0\}
$$
这个[子空间](@entry_id:150286)仅通过矩阵与向量的重复相乘（即矩阵 $A$ 的幂次作用于初始残差 $r_0$）来构建，巧妙地捕捉了关于矩阵 $A$ 及其对残差影响的局部信息。克雷洛夫方法的核心思想是在第 $k$ 次迭代时，从一个扩展的仿射**搜索空间** (search space) $x_0 + \mathcal{K}_k(A, r_0)$ 中寻找一个更好的近似解 $x_k$。

这意味着从 $x_0$ 到 $x_k$ 的修正量 $(x_k - x_0)$ 必须是克雷洛夫[基向量](@entry_id:199546)的[线性组合](@entry_id:154743)。例如，第二次迭代的解 $x_2$ 满足 $(x_2 - x_0) \in \mathcal{K}_2(A, r_0)$，也就是说，存在标量 $\gamma_0$ 和 $\gamma_1$ 使得 $x_2 - x_0 = \gamma_0 r_0 + \gamma_1 A r_0$ [@problem_id:2211044]。

那么，如何在这个[子空间](@entry_id:150286)中“选择”最佳的 $x_k$ 呢？这取决于我们施加的**投影条件** (projection condition)。这个条件通常要求第 $k$ 步的残差 $r_k = b - A x_k$ 与一个特定的**测试空间** (test space) $\mathcal{T}_k$ 正交。根据测试空间的选择，我们主要有两种投影方式：

1.  **伽辽金 (Galerkin) 条件**：要求残差 $r_k$ 与其所在的搜索空间 $\mathcal{K}_k(A, r_0)$ 正交，即 $\mathcal{T}_k = \mathcal{K}_k(A, r_0)$。数学上表示为 $r_k \perp \mathcal{K}_k(A, r_0)$。

2.  **[彼得罗夫-伽辽金](@entry_id:174072) ([Petrov-Galerkin](@entry_id:174072)) 条件**：要求残差 $r_k$ 与一个不同于搜索空间的测试空间 $\mathcal{T}_k$ 正交，即 $\mathcal{T}_k \neq \mathcal{K}_k(A, r_0)$。一个重要的例子是要求 $r_k \perp A\mathcal{K}_k(A, r_0)$。

这些条件为我们在不断扩大的克雷洛夫子空间中确定一系列近似解提供了数学框架。不同的克雷洛夫方法，其本质区别就在于它们如何定义这个投影条件，以及如何高效地实现它。

值得注意的是，[克雷洛夫子空间](@entry_id:751067)本身具有一个重要的性质：$A \mathcal{K}_k(A, r_0) \subseteq \mathcal{K}_{k+1}(A, r_0)$。这意味着当我们将矩阵 $A$ 应用于[子空间](@entry_id:150286)中的任何向量时，结果会落在更高一阶的[克雷洛夫子空间](@entry_id:751067)中。当且仅当[子空间](@entry_id:150286)变为 **$A$-不变** ($A$-invariant) 时，即 $A \mathcal{K}_k(A, r_0) \subseteq \mathcal{K}_k(A, r_0)$，克雷洛夫序列的维度将不再增长。这种情况发生在 $k$ 达到或超过 $A$ 关于 $r_0$ 的最小多项式的次数时。当这种情况发生时，解 $x_* = A^{-1}b$ 就包含在当前的搜索空间中，迭代方法能够在精确算术下找到精确解 [@problem_id:2570980]。这解释了为何所有克雷洛夫方法在理论上至多 $n$ 步收敛，因为 $\mathbb{R}^n$ 本身是一个 $A$-不变子空间。

### [对称正定系统](@entry_id:172662)的方法：[共轭梯度法](@entry_id:143436) (CG)

当线性系统的[系数矩阵](@entry_id:151473) $A$ 是**对称正定** (Symmetric Positive Definite, SPD) 的，例如在求解泊松方程等[椭圆偏微分方程](@entry_id:178258)的[有限元离散化](@entry_id:193156)中遇到的[刚度矩阵](@entry_id:178659) [@problem_id:2570884]，[共轭梯度法](@entry_id:143436) (Conjugate Gradient, CG) 是无可争议的首选方法。

#### CG 的最优性

CG 方法的卓越之处在于它不仅仅是一个[伽辽金投影](@entry_id:145611)。对于 SPD 矩阵，CG 在每一步迭代中找到的近似解 $x_k$，是整个仿射搜索空间 $x_0 + \mathcal{K}_k(A, r_0)$ 中唯一能最小化**$A$-范数误差**的解。误差向量定义为 $e_k = x_* - x_k$（其中 $x_*=A^{-1}b$ 是真实解），其 $A$-范数定义为 $\|e_k\|_A = \sqrt{e_k^\top A e_k}$。由于 $A$ 是 SPD 矩阵，这一定义了一个有效的范数，并且最小化此[范数等价](@entry_id:137561)于最小化二次[能量泛函](@entry_id:170311) $f(x) = \frac{1}{2} x^\top A x - b^\top x$。

这个最优性属性是 CG 方法的基石。而这一[最优性条件](@entry_id:634091)——最小化 $A$-范数误差——在数学上恰好等价于[伽辽金条件](@entry_id:173975)，即残差 $r_k$ 与[克雷洛夫子空间](@entry_id:751067) $\mathcal{K}_k(A, r_0)$ 在标准欧几里得[内积](@entry_id:158127)下正交 [@problem_id:2570980]。

#### 短递推关系的关键作用

CG 方法的惊人效率源于其计算过程中的一个“魔法”：**短递推关系** (short-term recurrence)。对于 SPD 矩阵，[伽辽金条件](@entry_id:173975)不仅成立，还引出了一系列深刻的性质：
- 残差序列是相互正交的：$r_i^\top r_j = 0$ 对所有 $i \neq j$。
- 搜索方向序列是 $A$-共轭（或称 $A$-正交）的：$p_i^\top A p_j = 0$ 对所有 $i \neq j$。

这两个正交性/共轭性使得计算新的残差 $r_{k+1}$ 和新的搜索方向 $p_{k+1}$ 时，仅需要前一步（或最多前两步）的信息。例如，新的搜索方向可以通过 $p_{k+1} = r_{k+1} + \beta_k p_k$ 简单地获得。这种只依赖于最近几步迭代的结构，就是所谓的短递推。

这正是 CG 方法与后来我们将看到的通用方法（如 GMRES）的根本区别。由于短递推关系，CG 在每次迭代中只需要存储少数几个向量（如解、残差、搜索方向），并且计算量是固定的，与迭代次数无关。这使得 CG 的内存占用极低，[计算效率](@entry_id:270255)极高 [@problem_id:2570884] [@problem_id:2214809]。这个性质完全依赖于矩阵 $A$ 的对称性。

#### CG 与非最优方法的比较

为了更深刻地理解 CG 的“最优性”，我们可以将其与一个结构相似但非最优的方法——**[重球法](@entry_id:637899) (Heavy Ball method)**——进行对比。[重球法](@entry_id:637899)也采用一个简单的双步[递推公式](@entry_id:149465)来更新解：
$$
x_{k+1} = x_k + \alpha r_k + \beta (x_k - x_{k-1})
$$
其中，步长 $\alpha$ 和动量项系数 $\beta$ 是基于对矩阵 $A$ 谱范围（最大和[最小特征值](@entry_id:177333)）的估计而预先设定的常数。

相比之下，CG 方法中的相应系数（例如步长 $\alpha_k$）是在每次迭代中**自适应地** (adaptively) 计算的，以确保满足上述的 $A$-范数[误差最小化](@entry_id:163081)。这种自[适应能力](@entry_id:194789)使 CG 能够为每个特定的问题“量身定制”其收敛路径。在实践中，这意味着 CG 的收敛速度通常远快于[重球法](@entry_id:637899)，尤其是在[矩阵条件数](@entry_id:142689)较差或[谱估计](@entry_id:262779)不准确时。例如，对于一个条件数为 $10^4$ 的[对角矩阵](@entry_id:637782)，CG 的[收敛速度](@entry_id:636873)可以比[重球法](@entry_id:637899)快一个[数量级](@entry_id:264888)以上。即使在理想情况下（如矩阵为单位矩阵的倍数），CG 也能在一步之内精确收敛，而[重球法](@entry_id:637899)（若[谱估计](@entry_id:262779)精确）也同样如此，但这揭示了 CG 的内在最优性 [@problem_id:2407651]。

### 通用非对称系统的方法

当矩阵 $A$ 非对称时，例如在模拟包含[对流](@entry_id:141806)项的物理过程（如[热输运](@entry_id:198424)或[流体力学](@entry_id:136788)）时 [@problem_id:2570884]，情况变得复杂。

#### CG 方法的失效

CG 的优雅结构在[非对称矩阵](@entry_id:153254)面前会彻底崩溃。根本原因在于，$A$ 不再能定义一个有效的[内积](@entry_id:158127)（即 $x^\top A y \neq y^\top A x$），$A$-共轭性失去了其作为“正交性”的几何意义。因此，保证短递推关系的[代数结构](@entry_id:137052)不复存在，标准的 CG 算法会失败或无法收敛 [@problem_id:2214809]。

面对这一挑战，研究者们开辟了两条截然不同的道路来设计适用于非对称系统的克雷洛夫方法：一条是牺牲效率以换取稳健性（长递推），另一条是牺牲部分稳健性来维持高效率（短递推）。

#### 长递推方法：[广义最小残差法](@entry_id:139566) (GMRES)

[广义最小残差法](@entry_id:139566) (Generalized Minimal Residual, GMRES) 是长递推方法的典范，也是求解通用[非对称线性系统](@entry_id:164317)的“黄金标准”之一。

##### GMRES 的核心思想：最小化残差

GMRES 采取了与 CG 不同的[最优性准则](@entry_id:178183)。在每一步 $k$，GMRES 在仿射搜索空间 $x_0 + \mathcal{K}_k(A, r_0)$ 中寻找近似解 $x_k$，使其对应的残差 $r_k$ 的**欧几里得范数**（或 [2-范数](@entry_id:636114)）$\|r_k\|_2$ 达到最小。即：
$$
\|r_k\|_2 = \|b - A x_k\|_2 = \min_{z \in x_0 + \mathcal{K}_k(A, r_0)} \|b - A z\|_2
$$
这个最小化残差的性质是 GMRES 的定义性特征。这个[优化问题](@entry_id:266749)等价于一个[彼得罗夫-伽辽金](@entry_id:174072)条件：$r_k \perp A\mathcal{K}_k(A, r_0)$ [@problem_id:2570980]。

##### 单调收敛性与阿诺德过程

由于[克雷洛夫子空间](@entry_id:751067)是嵌套的（$\mathcal{K}_k \subset \mathcal{K}_{k+1}$），搜索空间随迭代次数 $k$ 的增加而不断扩大。在一个不断增大的集合上最小化同一个函数，其最小值必然是单调不增的。因此，GMRES 的[残差范数](@entry_id:754273)序列 $\|r_k\|_2$ 保证了**单调不增**的收敛行为：$\|r_{k+1}\|_2 \le \|r_k\|_2$。这使得 GMRES 的收敛曲线通常非常平滑和可预测 [@problem_id:2208904]。

为了实现每一步的[残差最小化](@entry_id:754272)，GMRES 必须为克雷洛夫子空间 $\mathcal{K}_k(A, r_0)$ 构建一个**[标准正交基](@entry_id:147779)**。这个任务由**阿诺德过程** (Arnoldi process) 完成。阿诺德过程是一个**长递推关系**：在计算第 $k$ 个[基向量](@entry_id:199546)时，需要将 $A v_{k-1}$ 与*所有*前面 $k-1$ 个已生成的[基向量](@entry_id:199546)进行正交化处理。

##### 成本与稳定性的权衡

这种长递推结构是 GMRES 的核心权衡所在。一方面，通过显式地维护一个[标准正交基](@entry_id:147779)，GMRES 获得了极高的**[数值稳定性](@entry_id:146550)**。[基向量](@entry_id:199546)之间的正交性在[有限精度算术](@entry_id:142321)中得到了很好的保持，这使得算法非常稳健可靠 [@problem_id:2407634]。

另一方面，代价是高昂的。在第 $k$ 次迭[代时](@entry_id:173412)，GMRES 必须存储所有 $k$ 个[基向量](@entry_id:199546)，并且正交化过程的计算量也与 $k$ 成正比。因此，其内存和计算成本随迭代次数线性增长。对于需要大量迭代才能收敛的问题，这很快会变得不切实际。为了解决这个问题，实用的 GMRES 算法通常采用**重启策略**：执行固定步数 $m$ 的迭代，然后用得到的解作为新的初始猜测，重新开始新一轮的 $m$ 步迭代。这种方法被称为 GMRES($m$) [@problem_id:2570884]。

##### GMRES 与[多项式逼近](@entry_id:137391)

GMRES 的收敛行为与[多项式逼近理论](@entry_id:753571)有着深刻的联系。可以证明，第 $k$ 步的残差可以表示为 $r_k = p_k(A) r_0$，其中 $p_k$ 是一个次数不超过 $k$ 且满足 $p_k(0)=1$ 的多项式。GMRES 的最小化性质意味着它找到了在所有这类多项式中，使得 $\|p_k(A)r_0\|_2$ 最小的那个 $p_k$ [@problem_id:2407621]。

这个结果引出了对 GMRES [收敛速度](@entry_id:636873)的理论界：
- 如果矩阵 $A$ 是**[正规矩阵](@entry_id:185943)** (normal matrix)，即 $A^* A = A A^*$（对称、反对称和酉矩阵都是其特例），[收敛速度](@entry_id:636873)可以由一个在 $A$ 的谱 $\Lambda(A)$ 上关于函数 $f(z)=1/z$ 的最佳[多项式逼近](@entry_id:137391)问题来界定。具体来说，相对残差可以被如下方式约束：
$$
\frac{\|r_k\|_2}{\|r_0\|_2} \le \min_{p \in \Pi_k, p(0)=1} \max_{\lambda \in \Lambda(A)} |p(\lambda)|
$$
- 如果矩阵 $A$ 仅仅是可[对角化](@entry_id:147016)的 ($A=VDV^{-1}$)，这个界会变得更弱，并额外依赖于[特征向量](@entry_id:151813)矩阵 $V$ 的条件数 $\kappa_2(V)$：
$$
\frac{\|r_k\|_2}{\|r_0\|_2} \le \kappa_2(V) \min_{p \in \Pi_k, p(0)=1} \max_{\lambda \in \Lambda(A)} |p(\lambda)|
$$
这说明，对于[非正规矩阵](@entry_id:752668)，仅仅知道其[特征值分布](@entry_id:194746)不足以预测收敛行为；[特征向量](@entry_id:151813)的[非正交性](@entry_id:192553)（由 $\kappa_2(V)$ 度量）可能会极大地减缓收敛速度 [@problem_id:2407621]。

#### 短递推方法：双[共轭梯度](@entry_id:145712)类方法

与 GMRES 走上不同道路的是一系列旨在保留 CG 低成本优势的短递推方法。这类方法中最基础的是**[双共轭梯度法](@entry_id:746788) (BiCG)**。

##### [双共轭梯度法](@entry_id:746788) (BiCG) 的思想：[双正交性](@entry_id:746831)

BiCG 的核心思想是，既然无法在单一序列中维持正交性，那就引入一个与原系统 $Ax=b$ 配对的“影子”系统 $A^\top \tilde{x} = \tilde{b}$。然后，算法不再强制要求残差序列 $\{r_k\}$ 自身正交，而是强制主序列 $\{r_k\}$ 与影子残差序列 $\{\tilde{r}_k\}$ 之间满足**[双正交性](@entry_id:746831)** (bi-orthogonality)：$r_i^\top \tilde{r}_j = 0$ 对 $i \neq j$。类似地，搜索方向也满足**双共轭性** (bi-conjugacy)：$\tilde{p}_i^\top A p_j = 0$ 对 $i \neq j$。

这个巧妙的代数构造，用成对的 primal-shadow 条件替代了对称性，重新获得了派生短递推关系所需的结构。因此，BiCG 的迭代步长等参数可以通过主序列和影[子序列](@entry_id:147702)向量的[内积](@entry_id:158127)来计算（例如 $\alpha_k = (\tilde{r}_k^\top r_k) / (\tilde{p}_k^\top A p_k)$），从而维持了每次迭代的低计算成本和固定内存占用 [@problem_id:2432755]。

##### BiCGSTAB：稳定化的 BiCG

然而，BiCG 的收敛过程通常非常不稳定，[残差范数](@entry_id:754273)可能剧烈[振荡](@entry_id:267781)，并且算法容易因除以接近零的数值而“崩溃”。为了解决这些问题，**[稳定双共轭梯度法](@entry_id:634145) (BiCGSTAB)** 被提了出来。[BiCGSTAB](@entry_id:143406) 是一种[混合方法](@entry_id:163463)，它将 BiCG 的每一步与一个局部的一维最小化步骤（类似于 GMRES(1)）相结合，旨在平滑 BiCG 产生的[振荡](@entry_id:267781)，从而获得更稳定的收敛行为。

##### 不[稳定收敛](@entry_id:199422)性：短递推的代价

尽管 BiCGSTAB 及其变体极大地改善了 BiCG 的稳定性，但它们仍然继承了短递推方法的根本性弱点。
- **非单调收敛**：与 GMRES 不同，[BiCGSTAB](@entry_id:143406) 并不保证在每一步都最小化[残差范数](@entry_id:754273)。它只是满足一个[彼得罗夫-伽辽金](@entry_id:174072)条件，并进行局部稳定化。因此，其[残差范数](@entry_id:754273) $\|r_k\|_2$ 不是单调递减的，在收敛过程中可能会出现暂时的上升。这种不规则的收敛行为是这类方法的一个显著特征 [@problem_id:2208904]。
- **数值不稳定性**：短递推关系在[有限精度算术](@entry_id:142321)中无法抵抗舍入误差的累积。它们没有机制来修正与“遥远”的旧[基向量](@entry_id:199546)之间逐渐丧失的[双正交性](@entry_id:746831)。这种正交性的丧失是数值不稳定性的主要来源，可能导致收敛停滞甚至失败。相比之下，GMRES 通过其长递推中的显式正交化，主动地控制了舍入误差的传播 [@problem_id:2407634]。

最终，GMRES 与 BiCGSTAB 之间的选择，是一个典型的在**效率与稳健性之间的权衡**。GMRES 更稳健、收敛更平滑，但成本更高；BiCGSTAB 效率更高、内存占用更低，但收敛行为不规则且鲁棒性较差。

### 克雷洛夫方法家族概览

我们可以将讨论过的主流方法总结如下，以应对来自不同应用场景的矩阵 [@problem_id:2570884]：

- **[共轭梯度法](@entry_id:143436) (CG)**：
    - **适用矩阵**：[对称正定](@entry_id:145886) (SPD)。
    - **核心性质**：最小化 $A$-范数误差；短递推，成本低且固定。
    - **典型应用**：Poisson 方程的有限元离散。

- **[最小残差法](@entry_id:752003) ([MINRES](@entry_id:752003))**：
    - **适用矩阵**：对称，可不定。
    - **核心性质**：最小化欧几里得[残差范数](@entry_id:754273)；短递推，成本低且固定。
    - **典型应用**：Stokes 方程（[鞍点问题](@entry_id:174221)）的 KKT 系统。

- **[广义最小残差法](@entry_id:139566) (GMRES)**：
    - **适用矩阵**：通用非奇异方阵。
    - **核心性质**：最小化欧几里得[残差范数](@entry_id:754273)；长递推，成本随迭代增长；单调收敛。
    - **典型应用**：[对流](@entry_id:141806)占优的输运方程（非对称）。

- **[稳定双共轭梯度法](@entry_id:634145) ([BiCGSTAB](@entry_id:143406))**：
    - **适用矩阵**：通用非奇异方阵。
    - **核心性质**：基于[彼得罗夫-伽辽金](@entry_id:174072)条件；短递推，成本低且固定；收敛不规则。
    - **典型应用**：作为 GMRES 的高效替代方案，尤其是在内存受限时。

每次迭代的主要计算成本对于所有这些方法通常都是一次矩阵-向量乘积。它们的区别在于向量更新（`saxpy`）和[内积](@entry_id:158127)计算的数量。对于 CG、[MINRES](@entry_id:752003) 和 BiCGSTAB，由于短递推，这些操作的数量是固定的。而对于 GMRES，这些操作的数量随迭代次数线性增长 [@problem_id:2570884]。

### 预处理的力量

对于病态（ill-conditioned）的线性系统，即使是最好的克雷洛夫方法也可能收敛缓慢。**预处理** (preconditioning) 是一种通过将原系统 $Ax=b$ 变换为一个具有更好谱性质的等价系统来加速收敛的关键技术。一个好的预处理器 $M$ 应该近似于 $A$，并且系统 $M y = z$ 应该很容易求解。

我们通常求解变换后的系统，例如**[左预处理](@entry_id:165660)**系统 $M^{-1} A x = M^{-1} b$。

#### 对称[预处理](@entry_id:141204)与谱等价性

当为 SPD 系统使用 CG 方法时，一个关键的要求是保持系统的[对称正定](@entry_id:145886)性。然而，如果 $A$ 和预处理器 $M$ 都是 SPD 的，[左预处理](@entry_id:165660)后的矩阵 $M^{-1}A$ 通常**不是对称的**，这会破坏 CG 的基础。

解决方案是考虑一个理论上等价的**对称预处理**系统，其算子为 $\tilde{A} = M^{-1/2} A M^{-1/2}$，其中 $M^{1/2}$ 是 $M$ 的唯一 SPD 平方根。可以证明，这个新的算子 $\tilde{A}$ 确实是 SPD 的。

这里有一个至关重要且深刻的结论：非对称的[左预处理](@entry_id:165660)算子 $M^{-1}A$ 与对称的算子 $\tilde{A} = M^{-1/2} A M^{-1/2}$ 是**[相似矩阵](@entry_id:155833)** (similar matrices)。具体来说，$M^{-1}A = (M^{1/2})^{-1} \tilde{A} (M^{1/2})$。线性代数的一个基本定理告诉我们，[相似矩阵](@entry_id:155833)拥有完全相同的[特征值](@entry_id:154894)和[代数重数](@entry_id:154240)。

这意味着，尽管实际算法（[预处理共轭梯度法](@entry_id:753674), PCG）操作的是非[对称算子](@entry_id:272489) $M^{-1}A$ 的变体，但其收敛行为（主要由[特征值分布](@entry_id:194746)决定）可以完全通过分析等价的、性质良好的[对称算子](@entry_id:272489) $\tilde{A}$ 来理解。例如，我们可以断定，当 $A$ 和 $M$ 均为 SPD 时，[预处理](@entry_id:141204)后的算子 $M^{-1}A$ 的所有[特征值](@entry_id:154894)都是实数且为正 [@problem_id:2407675]。需要注意的是，虽然[特征值](@entry_id:154894)相同，但它们的[特征向量](@entry_id:151813)通常是不同的。

这个谱等价性原理是理解[预处理](@entry_id:141204) CG 方法的理论基石。对于其他方法，[预处理](@entry_id:141204)的目标也类似。例如，为 [MINRES](@entry_id:752003) 选择[预处理器](@entry_id:753679)时，通常也要求 $M$ 是 SPD 的，以保证预处理后的算子在某个[内积](@entry_id:158127)下仍然是对称的，从而保留短递推结构 [@problem_id:2570884]。对于 GMRES，预处理的目标更为宽泛，即让预处理后算子 $M^{-1}A$ 的[特征值](@entry_id:154894)（或更广义的[伪谱](@entry_id:138878)）尽可能地远离原点并聚集在一起。