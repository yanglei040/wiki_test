{"hands_on_practices": [{"introduction": "应用线方法的第一步是正确地将偏微分方程及其边界条件转化为常微分方程组。本练习将通过一个在 Robin 边界条件下的边界节点，让你推导其对应的常微分方程，从而为这一过程提供基础性实践。掌握这项技能对于精确模拟边界起着关键作用的物理现象（如传热问题）至关重要 [@problem_id:2444675]。", "problem": "考虑一维热传导偏微分方程 (PDE) $u_{t}(x,t) = \\kappa\\,u_{xx}(x,t)$，其定义在空间区间 $x \\in [0,L]$ 上，热扩散系数 $\\kappa  0$。在左边界 $x=0$ 处，热通量由罗宾边界条件 $u_{x}(0,t) + a\\,u(0,t) = b$ 控制，其中 $a \\ge 0$ 且 $b$ 为常数。在右边界 $x=L$ 处，假设为狄利克雷条件 $u(L,t)=0$；在接下来的推导中将不需要用到右边界条件。您将使用直线法 (Method of Lines, MOL) 对空间进行离散化，该方法通过仅在空间上进行离散化，将偏微分方程转化为一个常微分方程组 (ODEs)。\n\n设空间网格是均匀的，有 $M+1$ 个节点 $x_{j} = j h$（$j=0,1,\\dots,M$），间距为 $h = L/M$。定义半离散未知数 $u_{j}(t) \\approx u(x_{j},t)$。对于内部点，使用二阶中心差分来近似二阶导数。在边界节点 $j=0$ 处，使用相同的三点二阶中心差分格式来近似 $u_{xx}(0,t)$，这会引入一个虚拟值 $u_{-1}(t)$。为消去 $u_{-1}(t)$ 并用 $u_{0}(t)$ 和 $u_{1}(t)$ 表示，使用对 $u_{x}(0,t)$ 的二阶中心近似来施加罗宾边界条件。\n\n仅使用这些标准的二阶有限差分近似和控制偏微分方程，推导出闭式表达式 $F(u_{0},u_{1};a,b,h,\\kappa)$，使得边界节点的半离散常微分方程为 $u_{0}'(t) = F(u_{0},u_{1};a,b,h,\\kappa)$。请以 $F(u_{0},u_{1};a,b,h,\\kappa)$ 的单个解析表达式形式提供您的最终结果。无需进行数值计算。", "solution": "该问题陈述已经过验证，被认为是有效的。它提出了一个计算工程领域内适定的、有科学依据的问题，要求使用直线法推导边界节点上的半离散常微分方程 (ODE)。所有必要组成部分——控制偏微分方程 (PDE)、边界条件以及指定的数值近似格式——均已提供且相互一致。我们现在开始进行形式推导。\n\n控制偏微分方程为一维热方程：\n$$\nu_{t}(x,t) = \\kappa\\,u_{xx}(x,t)\n$$\n其中 $u_{t} = \\frac{\\partial u}{\\partial t}$ 且 $u_{xx} = \\frac{\\partial^2 u}{\\partial x^2}$。我们的任务是求出在边界点 $x=0$ 处半离散近似 $u_{0}(t) \\approx u(0,t)$ 的常微分方程。应用直线法，我们在空间节点 $x_0 = 0$ 处计算该偏微分方程：\n$$\n\\frac{d u_0}{d t}(t) = \\kappa \\, u_{xx}(0,t)\n$$\n问题指定对空间二阶导数 $u_{xx}$ 使用二阶中心差分近似。在节点 $x_0$ 处，该格式涉及点 $x_{-1} = -h$、$x_0 = 0$ 和 $x_1 = h$：\n$$\nu_{xx}(0,t) \\approx \\frac{u(x_1,t) - 2u(x_0,t) + u(x_{-1},t)}{h^2} = \\frac{u_1(t) - 2u_0(t) + u_{-1}(t)}{h^2}\n$$\n在这里，$u_{-1}(t) \\approx u(-h,t)$ 是一个虚构的“鬼点”值，因为点 $x_{-1}$ 位于物理域 $[0,L]$ 之外。将此近似代入 $u_0(t)$ 的常微分方程，得到：\n$$\n\\frac{d u_0}{d t}(t) = \\frac{\\kappa}{h^2} \\left[ u_1(t) - 2u_0(t) + u_{-1}(t) \\right]\n$$\n该方程尚未封闭，因为它依赖于未知的鬼点值 $u_{-1}(t)$。为消去此项，我们必须使用在 $x=0$ 处指定的罗宾边界条件：\n$$\nu_{x}(0,t) + a\\,u(0,t) = b\n$$\n问题要求用二阶中心差分来近似空间导数 $u_{x}(0,t)$。该近似涉及点 $x_{-1}$ 和 $x_1$：\n$$\nu_{x}(0,t) \\approx \\frac{u(x_1,t) - u(x_{-1},t)}{2h} = \\frac{u_1(t) - u_{-1}(t)}{2h}\n$$\n将此近似代入边界条件，得到一个离散代数关系：\n$$\n\\frac{u_1(t) - u_{-1}(t)}{2h} + a\\,u_0(t) = b\n$$\n我们现在对此方程求解鬼点值 $u_{-1}(t)$，用物理值 $u_0(t)$ 和 $u_1(t)$ 来表示。\n$$\nu_1(t) - u_{-1}(t) = 2h \\left( b - a\\,u_0(t) \\right)\n$$\n$$\nu_{-1}(t) = u_1(t) - 2h \\left( b - a\\,u_0(t) \\right) = u_1(t) - 2hb + 2ha\\,u_0(t)\n$$\n现在我们得到了一个 $u_{-1}(t)$ 的表达式，可以将其代回 $u_0(t)$ 的半离散常微分方程中。这样做可以消去鬼点，并使边界处的系统封闭。\n$$\n\\frac{d u_0}{d t}(t) = \\frac{\\kappa}{h^2} \\left[ u_1(t) - 2u_0(t) + \\left( u_1(t) - 2hb + 2ha\\,u_0(t) \\right) \\right]\n$$\n下一步是合并和化简右侧的各项。\n$$\n\\frac{d u_0}{d t}(t) = \\frac{\\kappa}{h^2} \\left[ (u_1(t) + u_1(t)) + (-2u_0(t) + 2ha\\,u_0(t)) - 2hb \\right]\n$$\n$$\n\\frac{d u_0}{d t}(t) = \\frac{\\kappa}{h^2} \\left[ 2u_1(t) + (2ha - 2)u_0(t) - 2hb \\right]\n$$\n提出公因子 $2$，得到边界节点 $u_0(t)$ 的常微分方程的最终形式：\n$$\n\\frac{d u_0}{d t}(t) = \\frac{2\\kappa}{h^2} \\left[ u_1(t) + (ha - 1)u_0(t) - hb \\right]\n$$\n问题要求函数 $F(u_{0},u_{1};a,b,h,\\kappa)$ 满足 $u_{0}'(t) = F(u_{0},u_{1};a,b,h,\\kappa)$。通过直接比较，我们确定函数 $F$ 为所推导方程的右侧。在半离散格式中，对时间的依赖性是隐式理解的，因此我们用变量 $u_0$ 和 $u_1$ 来写出该函数。\n$$\nF(u_{0},u_{1};a,b,h,\\kappa) = \\frac{2\\kappa}{h^2} \\left[ u_1 + (ha - 1)u_0 - hb \\right]\n$$\n此表达式即为所要求的在左边界处解的时间导数的闭式表达式。", "answer": "$$\n\\boxed{\\frac{2\\kappa}{h^2}\\left(u_1 + (ha-1)u_0 - hb\\right)}\n$$", "id": "2444675"}, {"introduction": "一个稳健的数值格式应尽可能地复现原始偏微分方程的基本物理定律，例如质量或能量守恒。本练习将通过分析几种不同空间离散格式下守恒量的行为，深入探讨离散守恒这一关键概念。通过这种分析，你将更深刻地理解是什么使数值方法具有“守恒性”，以及为何该性质对模拟的长期准确性如此重要 [@problem_id:2444736]。", "problem": "考虑线性平流偏微分方程 (PDE) $u_{t} + a\\,u_{x} = 0$，其中平流速度为常数 $a \\neq 0$，定义在一维周期性域 $[0,L]$ 上。设 $N \\geq 3$ 为一个整数，$\\Delta x = L/N$，并定义网格点 $x_{j} = j\\,\\Delta x$，其中 $j=0,1,\\dots,N-1$。对于所有 $j$ 和 $t \\geq 0$，索引具有周期性 $u_{j+N}(t) = u_{j}(t)$。假设所有量都是无量纲的。\n\n使用线法，用 $u_{j}(t)$ 来近似 $u(x_{j},t)$，并考虑以下三种对 $u_{x}$ 的空间半离散化方法：\n\n1.  二阶中心差分（非守恒形式）：对每个 $j$，\n    $${\\frac{d u_{j}}{dt}} = -\\,a\\,\\frac{u_{j+1} - u_{j-1}}{2\\,\\Delta x}.$$\n\n2.  针对 $a0$ 的一阶迎风格式，写成守恒通量差分形式，其数值通量为 $F_{j+\\frac{1}{2}} = a\\,u_{j}$：对每个 $j$，\n    $${\\frac{d u_{j}}{dt}} = -\\,\\frac{F_{j+\\frac{1}{2}} - F_{j-\\frac{1}{2}}}{\\Delta x} = -\\,\\frac{a\\,u_{j} - a\\,u_{j-1}}{\\Delta x}.$$\n\n3.  Lax–Friedrichs 通量差分形式，其参数为 $\\lambda  0$，数值通量为 $F_{j+\\frac{1}{2}} = \\frac{a}{2}\\left(u_{j} + u_{j+1}\\right) - \\frac{\\lambda}{2}\\left(u_{j+1} - u_{j}\\right)$：对每个 $j$，\n    $${\\frac{d u_{j}}{dt}} = -\\,\\frac{F_{j+\\frac{1}{2}} - F_{j-\\frac{1}{2}}}{\\Delta x}.$$\n\n定义离散总量（离散质量）\n$$M_{h}(t) = \\Delta x \\sum_{j=0}^{N-1} u_{j}(t).$$\n\n计算上述三种半离散化方法在所述周期性网格上所蕴含的 $\\frac{d}{dt} M_{h}(t)$ 的精确表达式，并将其共同值表述为单个精确量。你的最终答案必须是单个实数或单个闭式解析表达式，不带单位。无需四舍五入。", "solution": "该问题要求计算离散总量（或质量）$M_{h}(t)$ 的时间导数，这是针对一维周期性域上线性平流方程 $u_{t} + a\\,u_{x} = 0$ 的三种不同半离散化方法。\n\n离散总量定义为：\n$$M_{h}(t) = \\Delta x \\sum_{j=0}^{N-1} u_{j}(t)$$\n其时间导数通过在求和号下求导得到，因为求和是有限的且 $\\Delta x$ 是一个常数：\n$$\\frac{d M_{h}}{dt} = \\frac{d}{dt} \\left( \\Delta x \\sum_{j=0}^{N-1} u_{j}(t) \\right) = \\Delta x \\sum_{j=0}^{N-1} \\frac{d u_{j}}{dt}$$\n我们必须对给定的三种半离散格式中的每一种来计算这个表达式，并利用周期性边界条件 $u_{j+N}(t) = u_{j}(t)$，其中 $j$ 为任意整数。这种周期性意味着任何依赖于解 $u_j$ 的网格函数 $Q_j$ 也是周期为 $N$ 的函数，即 $Q_{j+N} = Q_j$。对于网格上的求和，一个直接的推论是，对于任意整数平移 $k$，求和保持不变：\n$$\\sum_{j=0}^{N-1} u_{j+k} = \\sum_{j=0}^{N-1} u_{j}$$\n这是因为索引集 $\\{k, k+1, \\dots, k+N-1\\}$ 模 $N$ 与集合 $\\{0, 1, \\dots, N-1\\}$ 相同，所以求和只是对相同项的重新排序。\n\n情况1：二阶中心差分\n半离散化由下式给出：\n$$\\frac{d u_{j}}{dt} = -a \\frac{u_{j+1} - u_{j-1}}{2\\,\\Delta x}$$\n将此代入 $\\frac{d M_{h}}{dt}$ 的表达式中：\n$$\\frac{d M_{h}}{dt} = \\Delta x \\sum_{j=0}^{N-1} \\left( -a \\frac{u_{j+1} - u_{j-1}}{2\\,\\Delta x} \\right) = -\\frac{a}{2} \\sum_{j=0}^{N-1} (u_{j+1} - u_{j-1})$$\n我们可以将求和分为两部分：\n$$\\frac{d M_{h}}{dt} = -\\frac{a}{2} \\left( \\sum_{j=0}^{N-1} u_{j+1} - \\sum_{j=0}^{N-1} u_{j-1} \\right)$$\n利用上述周期性网格上的求和性质，我们有：\n$$\\sum_{j=0}^{N-1} u_{j+1} = \\sum_{j=0}^{N-1} u_{j} \\quad \\text{和} \\quad \\sum_{j=0}^{N-1} u_{j-1} = \\sum_{j=0}^{N-1} u_{j}$$\n因此，这两个和相等，它们的差为零。\n$$\\frac{d M_{h}}{dt} = -\\frac{a}{2} \\left( \\sum_{j=0}^{N-1} u_{j} - \\sum_{j=0}^{N-1} u_{j} \\right) = -\\frac{a}{2} \\times 0 = 0$$\n\n情况2：一阶迎风格式（对于 $a0$）\n半离散化以守恒形式给出：\n$$\\frac{d u_{j}}{dt} = -\\frac{F_{j+\\frac{1}{2}} - F_{j-\\frac{1}{2}}}{\\Delta x} = -\\frac{a\\,u_{j} - a\\,u_{j-1}}{\\Delta x}$$\n其中数值通量被确定为 $F_{j+\\frac{1}{2}} = a\\,u_{j}$。让我们不依赖通量记法，直接验证其守恒性质。\n$$\\frac{d M_{h}}{dt} = \\Delta x \\sum_{j=0}^{N-1} \\left( -\\frac{a\\,u_{j} - a\\,u_{j-1}}{\\Delta x} \\right) = -a \\sum_{j=0}^{N-1} (u_{j} - u_{j-1})$$\n将求和拆分：\n$$\\frac{d M_{h}}{dt} = -a \\left( \\sum_{j=0}^{N-1} u_{j} - \\sum_{j=0}^{N-1} u_{j-1} \\right)$$\n与第一种情况一样，网格的周期性意味着 $\\sum_{j=0}^{N-1} u_{j-1} = \\sum_{j=0}^{N-1} u_{j}$。\n$$\\frac{d M_{h}}{dt} = -a \\left( \\sum_{j=0}^{N-1} u_{j} - \\sum_{j=0}^{N-1} u_{j} \\right) = -a \\times 0 = 0$$\n\n情况3：Lax–Friedrichs 通量差分形式\n半离散化明确地以守恒形式给出：\n$$\\frac{d u_{j}}{dt} = -\\frac{F_{j+\\frac{1}{2}} - F_{j-\\frac{1}{2}}}{\\Delta x}$$\n其数值通量为 $F_{j+\\frac{1}{2}} = \\frac{a}{2}\\left(u_{j} + u_{j+1}\\right) - \\frac{\\lambda}{2}\\left(u_{j+1} - u_{j}\\right)$。\n对于任何这种形式的格式，总质量的变化率是：\n$$\\frac{d M_{h}}{dt} = \\Delta x \\sum_{j=0}^{N-1} \\left( -\\frac{F_{j+\\frac{1}{2}} - F_{j-\\frac{1}{2}}}{\\Delta x} \\right) = -\\sum_{j=0}^{N-1} (F_{j+\\frac{1}{2}} - F_{j-\\frac{1}{2}})$$\n这是一个在周期性域上的伸缩求和。让我们定义一个辅助网格函数 $G_j = F_{j-\\frac{1}{2}}$。求和变为 $-\\sum_{j=0}^{N-1} (G_{j+1} - G_j)$。求和结果为：\n$$\\sum_{j=0}^{N-1} (G_{j+1} - G_j) = (G_1 - G_0) + (G_2 - G_1) + \\dots + (G_N - G_{N-1}) = G_N - G_0$$\n将 $G_j$ 的定义代回：\n$$\\frac{d M_{h}}{dt} = -(G_N - G_0) = -(F_{N-\\frac{1}{2}} - F_{-\\frac{1}{2}})$$\n数值通量 $F_{j+\\frac{1}{2}}$ 是 $u_j$ 和 $u_{j+1}$ 的函数，即 $F_{j+\\frac{1}{2}} = F(u_j, u_{j+1})$。由于解的周期性 $u_{j+N}=u_j$，数值通量在其索引上也必须是周期性的，即 $F_{j+N+\\frac{1}{2}} = F(u_{j+N}, u_{j+N+1}) = F(u_j, u_{j+1}) = F_{j+\\frac{1}{2}}$。\n我们应用此周期性性质来关联 $F_{N-\\frac{1}{2}}$ 和 $F_{-\\frac{1}{2}}$。在周期性关系中令 $j = -1$ 可得 $F_{-1+N+\\frac{1}{2}} = F_{-1+\\frac{1}{2}}$，化简为 $F_{N-\\frac{1}{2}} = F_{-\\frac{1}{2}}$。\n因此，差值为零：\n$$\\frac{d M_{h}}{dt} = -(F_{N-\\frac{1}{2}} - F_{N-\\frac{1}{2}}) = 0$$\n\n总之，对于周期性域上的所有三种半离散格式，离散总质量的时间导数都精确为零。这表明所有三种格式在离散意义下都是守恒的，模仿了原始偏微分方程 $\\frac{d}{dt}\\int_0^L u \\, dx = 0$ 的守恒性质。$\\frac{d}{dt} M_{h}(t)$ 的共同值是 $0$。", "answer": "$$\\boxed{0}$$", "id": "2444736"}, {"introduction": "尽管线方法将偏微分方程简化为常微分方程组，但空间离散格式的选择可能对最终时间积分的稳定性产生深远影响。这个编程练习通过比较中心差分格式和迎风格式在对流主导问题中的表现，为这一原理提供了实践性的展示。你将亲手实现并观察到迎风格式的数值耗散如何防止中心格式中可能出现的非物理振荡和不稳定性 [@problem_id:2444647]。", "problem": "考虑具有周期性边界条件的一维线性平流-扩散偏微分方程 (PDE)，\n$$\n\\frac{\\partial u}{\\partial t}(x,t) + a \\,\\frac{\\partial u}{\\partial x}(x,t) = \\nu \\,\\frac{\\partial^2 u}{\\partial x^2}(x,t), \\quad x \\in [0,1], \\quad t \\in [0,T],\n$$\n空间周期性为 $u(0,t) = u(1,t)$（对于所有 $t \\in [0,T]$），初始条件为\n$$\nu(x,0) = \\sin(2\\pi x) + 0.1 \\sin(16\\pi x).\n$$\n设空间网格是均匀的，有 $N$ 个点，间距为 $\\Delta x = 1/N$，并采用周期性索引。在网格值 $u_j(t) \\approx u(x_j,t)$（其中 $x_j = j \\,\\Delta x$）上定义两个半离散空间算子：\n- 使用二阶中心差分的中心平流和二阶导数扩散，\n$$\n\\left.\\frac{\\mathrm{d}u_j}{\\mathrm{d}t}\\right|_{\\text{centered}} = -a \\,\\frac{u_{j+1} - u_{j-1}}{2\\Delta x} + \\nu \\,\\frac{u_{j+1} - 2u_j + u_{j-1}}{\\Delta x^2}.\n$$\n- 使用迎风平流（与 $a$ 的符号一致的一阶迎风格式）和二阶导数扩散，\n$$\n\\left.\\frac{\\mathrm{d}u_j}{\\mathrm{d}t}\\right|_{\\text{upwind}} =\n\\begin{cases}\n-a \\,\\frac{u_j - u_{j-1}}{\\Delta x} + \\nu \\,\\frac{u_{j+1} - 2u_j + u_{j-1}}{\\Delta x^2},  a \\ge 0 \\\\[6pt]\n-a \\,\\frac{u_{j+1} - u_j}{\\Delta x} + \\nu \\,\\frac{u_{j+1} - 2u_j + u_{j-1}}{\\Delta x^2},  a  0\n\\end{cases}\n$$\n使用时间步长为 $\\Delta t$ 的显式前向欧拉法在时间上推进，直到最终时间 $T$。对于每次模拟，将时间层 $n$ 的离散 $L^2$ 范数定义为\n$$\n\\|u^n\\|_2 = \\left( \\Delta x \\sum_{j=0}^{N-1} \\left(u_j^n\\right)^2 \\right)^{1/2}.\n$$\n如果所有时间步中的最大范数满足\n$$\n\\max_{0 \\le n \\le N_t} \\|u^n\\|_2 \\le G_{\\max} \\,\\|u^0\\|_2,\n$$\n则声明该次运行为“稳定的”，否则为“不稳定的”，其中 $G_{\\max} = 5$ 是固定的，$N_t$ 是达到 $T$ 所需的时间步数。时间步长 $\\Delta t$ 由无量纲因子 $C_{\\mathrm{adv}}$ 和 $C_{\\mathrm{diff}}$ 决定的平流和扩散界限的最小值选取，如下所示：\n$$\n\\Delta t =\n\\min\\!\\left(\n\\begin{array}{l}\nC_{\\mathrm{adv}} \\,\\frac{\\Delta x}{|a|} \\quad \\text{if } |a|0, \\text{ otherwise } +\\infty, \\\\[6pt]\nC_{\\mathrm{diff}} \\,\\frac{\\Delta x^2}{2\\nu} \\quad \\text{if } \\nu0, \\text{ otherwise } +\\infty\n\\end{array}\n\\right).\n$$\n如果 $|a|=0$ 和 $\\nu=0$ 同时成立，则测试中不考虑这种情况。\n\n您的任务是实现上述定义，并针对下面的每个测试用例，确定中心格式和迎风格式在根据给定参数计算出的相同 $\\Delta t$ 下是否稳定。该区域是无量纲的，输出中不需要物理单位。\n\n使用以下测试套件，其中每个案例指定了 $(a,\\nu,N,C_{\\mathrm{adv}},C_{\\mathrm{diff}},T)$：\n- 测试 $1$：$(a,\\nu,N,C_{\\mathrm{adv}},C_{\\mathrm{diff}},T) = (\\,1.0,\\,0.001,\\,200,\\,0.5,\\,0.4,\\,0.5\\,)$。\n- 测试 $2$：$(a,\\nu,N,C_{\\mathrm{adv}},C_{\\mathrm{diff}},T) = (\\,20.0,\\,0.0001,\\,400,\\,0.8,\\,0.2,\\,0.2\\,)$。\n- 测试 $3$：$(a,\\nu,N,C_{\\mathrm{adv}},C_{\\mathrm{diff}},T) = (\\,0.0,\\,0.01,\\,100,\\,0.5,\\,0.4,\\,0.5\\,)$。\n- 测试 $4$：$(a,\\nu,N,C_{\\mathrm{adv}},C_{\\mathrm{diff}},T) = (\\,1.0,\\,0.0,\\,200,\\,0.99,\\,0.0,\\,0.5\\,)$。\n\n您的程序必须：\n- 在每个测试用例中，中心格式和迎风格式必须使用相同的 $\\Delta t$，该 $\\Delta t$ 需严格按照上述定义计算。\n- 积分到指定的最终时间 $T$（如果 $T$ 不能被 $\\Delta t$ 整除，则取 $N_t = \\lceil T/\\Delta t \\rceil$ 并使用均匀的时间步长 $T/N_t$）。\n- 对于每个测试，根据 $G_{\\max} = 5$ 的准则，按 $\\big[$中心格式稳定性, 迎风格式稳定性$\\big]$ 的顺序返回两个布尔值。\n\n最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。按测试顺序连接四个测试的结果，将布尔值平铺成一个列表。例如，输出格式应如下所示\n$$\n[\\text{c}_1,\\text{u}_1,\\text{c}_2,\\text{u}_2,\\text{c}_3,\\text{u}_3,\\text{c}_4,\\text{u}_4],\n$$\n其中 $\\text{c}_k$ 和 $\\text{u}_k$ 分别是测试 $k$ 中中心格式和迎风格式的布尔稳定性结果。", "solution": "所提出的问题已经过验证，并被认定是有效的。它具有科学依据，是适定的、客观的，并包含所有必要信息以获得唯一的、可验证的解。因此，我们可以着手进行解的推导和实现。\n\n该问题要求解在域 $x \\in [0,1]$ 上具有周期性边界条件的一维线性平流-扩散方程的数值解，\n$$\n\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = \\nu \\frac{\\partial^2 u}{\\partial x^2},\n$$\n该解将使用直线法 (Method of Lines, MOL) 获得，其中首先对空间导数进行离散化，将偏微分方程 (PDE) 转化为一个耦合常微分方程组 (ODEs)。然后该方程组在时间上进行积分。\n\n首先，我们定义离散空间网格。区域 $[0,1]$ 被离散化为 $N$ 个长度为 $\\Delta x = 1/N$ 的均匀段。网格点为 $x_j = j\\Delta x$，其中 $j = 0, 1, \\dots, N-1$。此网格上的解由一个向量 $\\vec{u}(t)$ 表示，其第 $j$ 个分量为 $u_j(t) \\approx u(x_j, t)$。周期性边界条件意味着对于任何整数 $j$，都有 $u_{j+N} = u_j$。\n\n直线法将偏微分方程转化为 $\\frac{d\\vec{u}}{dt} = \\mathbf{L}\\vec{u}$ 的形式，其中 $\\mathbf{L}$ 是一个表示离散化空间算子的矩阵。我们被要求评估平流项 $\\frac{\\partial u}{\\partial x}$ 的两种不同离散化方法，而扩散项 $\\frac{\\partial^2 u}{\\partial x^2}$ 则统一使用标准的二阶中心差分进行离散化。\n\n二阶导数的二阶中心差分近似为：\n$$\n\\left.\\frac{\\partial^2 u}{\\partial x^2}\\right|_{x_j} \\approx \\frac{u_{j+1} - 2u_j + u_{j-1}}{\\Delta x^2}.\n$$\n该算子应用于两种格式。\n\n格式1：中心平流\n平流项使用二阶中心差分进行近似：\n$$\n\\left.\\frac{\\partial u}{\\partial x}\\right|_{x_j} \\approx \\frac{u_{j+1} - u_{j-1}}{2\\Delta x}.\n$$\n结合这些，中心格式的半离散系统为：\n$$\n\\frac{d u_j}{d t} = -a \\left(\\frac{u_{j+1} - u_{j-1}}{2\\Delta x}\\right) + \\nu \\left(\\frac{u_{j+1} - 2u_j + u_{j-1}}{\\Delta x^2}\\right).\n$$\n\n格式2：迎风平流\n平流项使用一阶迎风差分进行近似，其模板取决于平流速度 $a$ 的符号。做出此选择是为了引入能够增强稳定性的数值耗散。\n如果 $a \\ge 0$，使用后向差分：\n$$\n\\left.\\frac{\\partial u}{\\partial x}\\right|_{x_j} \\approx \\frac{u_j - u_{j-1}}{\\Delta x}.\n$$\n如果 $a  0$，使用前向差分：\n$$\n\\left.\\frac{\\partial u}{\\partial x}\\right|_{x_j} \\approx \\frac{u_{j+1} - u_j}{\\Delta x}.\n$$\n因此，迎风格式对应的半离散系统为：\n$$\n\\frac{d u_j}{d t} =\n\\begin{cases}\n-a \\left(\\frac{u_j - u_{j-1}}{\\Delta x}\\right) + \\nu \\left(\\frac{u_{j+1} - 2u_j + u_{j-1}}{\\Delta x^2}\\right),  a \\ge 0 \\\\\n-a \\left(\\frac{u_{j+1} - u_j}{\\Delta x}\\right) + \\nu \\left(\\frac{u_{j+1} - 2u_j + u_{j-1}}{\\Delta x^2}\\right),  a  0\n\\end{cases}\n$$\n\n对于时间积分，指定了显式前向欧拉法。给定时间 $t_n$ 的解向量 $\\vec{u}^n$，下一个时间步 $t_{n+1} = t_n + \\Delta t$ 的解计算如下：\n$$\n\\vec{u}^{n+1} = \\vec{u}^n + \\Delta t \\cdot \\frac{d\\vec{u}}{dt}\\bigg|_{\\vec{u}=\\vec{u}^n}.\n$$\n时间步长 $\\Delta t$ 必须仔细选择以确保数值稳定性。前向欧拉法只是条件稳定的。该问题提供了一个基于平流和扩散的 Courant-Friedrichs-Lewy (CFL) 条件计算初步时间步长 $\\Delta t_{cfl}$ 的特定公式：\n$$\n\\Delta t_{cfl} = \\min\\left( C_{\\mathrm{adv}} \\frac{\\Delta x}{|a|}, \\; C_{\\mathrm{diff}} \\frac{\\Delta x^2}{2\\nu} \\right).\n$$\n如果分母（$|a|$ 或 $\\nu$）为零，则相应项被视为无穷大。为确保模拟在时间 $T$ 精确结束，步数固定为 $N_t = \\lceil T/\\Delta t_{cfl} \\rceil$，并使用一个统一的实际时间步长 $\\Delta t = T/N_t$ 进行积分。这确保了 $\\Delta t \\le \\Delta t_{cfl}$，从而保持了稳定性约束。\n\n每次模拟运行的稳定性都进行定量评估。如果在整个模拟过程中观察到的最大离散 $L^2$ 范数不超过初始范数的特定倍数，则该次运行被声明为“稳定的”。时间步 $n$ 的离散 $L^2$ 范数为：\n$$\n\\|u^n\\|_2 = \\left( \\Delta x \\sum_{j=0}^{N-1} (u_j^n)^2 \\right)^{1/2}.\n$$\n稳定性判据为：\n$$\n\\max_{0 \\le n \\le N_t} \\|u^n\\|_2 \\le G_{\\max} \\|u^0\\|_2,\n$$\n其中增长因子给定为 $G_{\\max} = 5$。初始条件由 $u(x,0) = \\sin(2\\pi x) + 0.1 \\sin(16\\pi x)$ 给出，在网格上对其求值以提供初始向量 $\\vec{u}^0$。\n\n每个测试用例的算法流程如下：\n1.  设置参数 $(a, \\nu, N, C_{\\mathrm{adv}}, C_{\\mathrm{diff}}, T)$。\n2.  计算网格间距 $\\Delta x = 1/N$ 并创建网格点 $x_j$。\n3.  通过计算 $u(x_j, 0)$ 生成初始条件向量 $\\vec{u}^0$。\n4.  计算初始范数 $\\|u^0\\|_2$ 和稳定性阈值 $G_{\\max} \\|u^0\\|_2$。\n5.  计算 $\\Delta t_{cfl}$ 然后计算实际时间步长 $\\Delta t = T/\\lceil T/\\Delta t_{cfl} \\rceil$。\n6.  对于每种格式（中心和迎风）：\n    a. 初始化解向量 $\\vec{u} = \\vec{u}^0$ 并设置 $\\text{max\\_norm} = \\|u^0\\|_2$。\n    b. 循环 $N_t$ 次：\n        i.   使用适当的有限差分公式计算右端向量 $\\frac{d\\vec{u}}{dt}$。\n        ii.  使用前向欧拉步更新解：$\\vec{u} \\leftarrow \\vec{u} + \\Delta t \\frac{d\\vec{u}}{dt}$。\n        iii. 计算当前范数 $\\|\\vec{u}\\|_2$ 并在必要时更新 $\\text{max\\_norm}$。如果解变为非有限值，$\\text{max\\_norm}$ 变为无穷大。\n    c. 将最终的 $\\text{max\\_norm}$ 与阈值比较以确定稳定性（真/假）。\n7.  收集两种格式的布尔稳定性结果，并将其附加到全局列表中。\n\n这个流程将为所有提供的测试用例实现，最终的布尔结果列表将按规定格式化。使用向量化操作，特别是周期性移位，可以高效地在周期性网格上实现有限差分。", "answer": "```python\nimport numpy as np\nimport math\n\ndef get_rhs_calculator(a, nu, N, scheme):\n    \"\"\"\n    Returns a function that computes the right-hand side of the semi-discretized PDE.\n    This corresponds to the spatial operator applied to the solution vector u.\n    \"\"\"\n    dx = 1.0 / N\n    d2udx2_term_func = lambda u: (np.roll(u, -1) - 2 * u + np.roll(u, 1)) / (dx**2)\n\n    if scheme == 'centered':\n        def rhs_centered(u):\n            dudx_adv = (np.roll(u, -1) - np.roll(u, 1)) / (2 * dx)\n            return -a * dudx_adv + nu * d2udx2_term_func(u)\n        return rhs_centered\n    elif scheme == 'upwind':\n        def rhs_upwind(u):\n            if a = 0:\n                dudx_adv = (u - np.roll(u, 1)) / dx\n            else:  # a  0\n                dudx_adv = (np.roll(u, -1) - u) / dx\n            return -a * dudx_adv + nu * d2udx2_term_func(u)\n        return rhs_upwind\n    else:\n        raise ValueError(\"Unknown scheme type\")\n\ndef check_stability(params, scheme, G_max):\n    \"\"\"\n    Runs a single simulation for a given test case and scheme, then reports its stability.\n    \"\"\"\n    a, nu, N, C_adv, C_diff, T = params\n\n    # 1. Grid and Initial Condition\n    dx = 1.0 / N\n    x = np.arange(N, dtype=float) / N\n    u = np.sin(2 * np.pi * x) + 0.1 * np.sin(16 * np.pi * x)\n\n    # 2. Initial norm and stability threshold\n    norm_initial = np.sqrt(dx * np.sum(u**2))\n    if norm_initial == 0:\n        return True  # Trivial case: zero initial condition is always stable\n    max_norm = norm_initial\n\n    # 3. Time step calculation\n    dt_adv = C_adv * dx / abs(a) if abs(a)  0 else float('inf')\n    dt_diff = C_diff * dx**2 / (2 * nu) if nu  0 else float('inf')\n    dt_cfl = min(dt_adv, dt_diff)\n\n    if T == 0:\n        return True\n    if dt_cfl == float('inf'): # Corresponds to a=0 and nu=0 case, u(x,t) is constant.\n      return True\n\n    num_steps = math.ceil(T / dt_cfl)\n    dt = T / num_steps\n    \n    # 4. Get the appropriate RHS function for the scheme\n    rhs_calculator = get_rhs_calculator(a, nu, N, scheme)\n\n    # 5. Time integration loop\n    for _ in range(num_steps):\n        u = u + dt * rhs_calculator(u)\n        \n        current_norm = np.sqrt(dx * np.sum(u**2))\n        \n        if np.isnan(current_norm) or np.isinf(current_norm):\n            max_norm = float('inf')\n            break\n            \n        if current_norm  max_norm:\n            max_norm = current_norm\n            \n    # 6. Check stability criterion\n    return max_norm = G_max * norm_initial\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the results.\n    \"\"\"\n    test_cases = [\n        # (a,      nu,       N,   C_adv, C_diff, T)\n        (1.0,    0.001,    200, 0.5,   0.4,    0.5),\n        (20.0,   0.0001,   400, 0.8,   0.2,    0.2),\n        (0.0,    0.01,     100, 0.5,   0.4,    0.5),\n        (1.0,    0.0,      200, 0.99,  0.0,    0.5),\n    ]\n\n    G_max = 5.0\n    results = []\n\n    for i, case in enumerate(test_cases):\n        is_stable_cen = check_stability(case, 'centered', G_max)\n        is_stable_upw = check_stability(case, 'upwind', G_max)\n        results.extend([is_stable_cen, is_stable_upw])\n\n    # Final print statement in the exact required format.\n    # str(True) -> 'True', str(False) -> 'False'\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2444647"}]}