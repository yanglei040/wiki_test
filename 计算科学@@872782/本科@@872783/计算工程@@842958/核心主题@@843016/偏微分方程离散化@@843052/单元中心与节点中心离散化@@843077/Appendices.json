{"hands_on_practices": [{"introduction": "守恒律是物理学和数值方法中的一个核心概念，尤其对于有限体积法至关重要。本练习将通过模拟一个量子波包的演化，来实践如何量化一个理论上守恒的量（总概率）在数值计算中的微小偏差。通过对比单元中心格式和节点中心格式，我们将探索初始条件在不同网格上的离散化方式如何影响数值守恒性。[@problem_id:2376114]", "problem": "您需要模拟一个在周期性域上的高斯波包的自由一维含时薛定谔方程，并针对两种空间离散化布局（顶点中心网格和单元中心网格）量化离散总概率的守恒性。控制偏微分方程 (PDE) 为\n$$\n\\mathrm{i}\\,\\frac{\\partial \\psi}{\\partial t}(x,t) \\;=\\; -\\frac{1}{2}\\,\\frac{\\partial^2 \\psi}{\\partial x^2}(x,t),\n\\quad x \\in [0,L], \\quad t \\ge 0,\n$$\n在长度为 $L$ 的区间上具有周期性边界条件。未知复值波函数为 $\\psi(x,t)$。初始条件是一个带有平面波载波的高斯波包，\n$$\n\\psi(x,0) \\;=\\; \\mathcal{A}\\,\\exp\\!\\left(-\\frac{(x-x_0)^2}{4\\,\\sigma^2}\\right)\\,\\exp\\!\\left(\\mathrm{i}\\,k_0\\,x\\right),\n$$\n其中 $\\sigma$ 是高斯包络的标准差，$k_0$ 是载波波数，$x_0$ 是初始中心，而 $\\mathcal{A}$ 是一个归一化常数，其选择使得连续总概率等于 1，即\n$$\n\\int_{0}^{L}|\\psi(x,0)|^2\\,dx \\;=\\; 1.\n$$\n您将在 $[0,L)$ 上使用两种均匀空间布局：\n- 一个顶点中心网格，包含 $N$ 个顶点，其位置为 $x_j = j\\,\\Delta x$，$j=0,1,\\dots,N-1$，其中 $\\Delta x = L/N$。\n- 一个单元中心网格，包含 $N$ 个单元中心，其位置为 $x_{j+\\frac{1}{2}} = \\left(j+\\frac{1}{2}\\right)\\Delta x$，$j=0,1,\\dots,N-1$。\n\n在每种布局中，对空间进行均匀离散化，并在最终时间范围 $T_f = (\\Delta t)\\times n_{\\text{steps}}$ 内，使用周期性边界条件将半离散系统随时间向前演化。在每种布局上，将离散总概率定义为\n$$\n\\mathcal{P}(t) \\;=\\; \\Delta x \\sum_{j=0}^{N-1} \\left|\\psi_j(t)\\right|^2,\n$$\n其中 $\\psi_j(t)$ 表示所选布局的网格点上的离散波函数值。对初始条件进行离散归一化，使得在每种布局上 $\\mathcal{P}(0)=1$。在时间演化到 $t=T_f$ 后，计算与单位总概率的相对偏差\n$$\nE \\;=\\; \\left|\\mathcal{P}(T_f) - 1\\right|.\n$$\n\n对于下方的每个测试用例，计算两个值：\n- $E_{\\mathrm{v}}$：使用顶点中心网格得到的 $E$ 值，\n- $E_{\\mathrm{c}}$：使用单元中心网格得到的 $E$ 值。\n\n所有量均为无量纲；不要使用物理单位。\n\n使用以下测试套件，其中每个用例由 $(L, N, \\Delta t, n_{\\text{steps}}, \\sigma, k_0, x_0)$ 指定：\n1. 用例 1：$(20,\\;200,\\;0.005,\\;400,\\;1.0,\\;4.0,\\;5.0)$。\n2. 用例 2：$(20,\\;40,\\;0.005,\\;400,\\;1.0,\\;4.0,\\;5.0)$。\n3. 用例 3：$(20,\\;8,\\;0.0025,\\;200,\\;1.0,\\;3.0,\\;20/3)$。\n4. 用例 4：$(20,\\;128,\\;0.005,\\;400,\\;1.2,\\;0.0,\\;10.0)$。\n\n您的程序必须：\n- 对每个用例，构建两种空间布局，初始化波包并进行离散归一化，使得每种布局的 $\\mathcal{P}(0)=1$，演化到 $T_f$，计算 $E_{\\mathrm{v}}$ 和 $E_{\\mathrm{c}}$，并按顺序收集这些值。\n- 生成单行输出，其中包含一个长度为 8 的扁平列表，条目为\n$$\n\\left[E_{\\mathrm{v}}^{(1)}, E_{\\mathrm{c}}^{(1)}, E_{\\mathrm{v}}^{(2)}, E_{\\mathrm{c}}^{(2)}, E_{\\mathrm{v}}^{(3)}, E_{\\mathrm{c}}^{(3)}, E_{\\mathrm{v}}^{(4)}, E_{\\mathrm{c}}^{(4)}\\right].\n$$\n\n最终输出格式要求：打印的单行必须是一个用方括号括起来的逗号分隔列表，其中每个浮点数都以科学记数法格式化，小数点后恰好有 6 位数字（例如，$1.234567\\mathrm{e}{-08}$）。不得打印任何其他文本或行。", "solution": "所提出的问题是计算量子力学中一个适定且科学上合理的练习。它要求对周期性域上由高斯波包表示的自由粒子的一维含时薛定谔方程进行数值求解。核心任务是为两种不同的均匀空间离散化方案（顶点中心网格和单元中心网格）量化总概率的数值守恒性。该问题是自洽的，为其解决提供了所有必要的参数和定义。\n\n控制偏微分方程为：\n$$\n\\mathrm{i}\\,\\frac{\\partial \\psi}{\\partial t}(x,t) \\;=\\; -\\frac{1}{2}\\,\\frac{\\partial^2 \\psi}{\\partial x^2}(x,t) \\equiv \\hat{H}\\psi(x,t)\n$$\n其中 $\\hat{H} = -\\frac{1}{2}\\frac{\\partial^2}{\\partial x^2}$ 是哈密顿算符。在量子力学中，封闭系统的演化是幺正的，这在数学上意味着总概率 $\\mathcal{P}(t) = \\int |\\psi(x,t)|^2\\,dx$ 是一个守恒量。目标是研究这一基本性质在数值离散化下是如何保持的。\n\n求解方法首先对空间域进行半离散化，然后对得到的常微分方程组 (ODEs) 进行时间积分。\n\n首先，对空间导数进行离散化。在间距为 $\\Delta x$ 的均匀网格上，对拉普拉斯算符 $\\frac{\\partial^2}{\\partial x^2}$ 采用二阶中心差分格式。对于离散波函数 $\\psi_j(t) = \\psi(x_j, t)$，其近似为：\n$$\n\\frac{\\partial^2 \\psi}{\\partial x^2}\\bigg|_{x_j} \\;\\approx\\; \\frac{\\psi_{j+1}(t) - 2\\psi_j(t) + \\psi_{j-1}(t)}{(\\Delta x)^2}\n$$\n这将偏微分方程转换为一个关于离散波函数值向量 $\\vec{\\psi}(t)$ 的耦合一阶常微分方程组：\n$$\n\\mathrm{i}\\,\\frac{d\\vec{\\psi}}{dt} \\;=\\; \\hat{H}_{\\text{FD}}\\vec{\\psi}\n$$\n这里，$\\hat{H}_{\\text{FD}}$ 是哈密顿量的有限差分矩阵表示。由于周期性边界条件，该矩阵是一个实对称循环矩阵。实对称矩阵是厄米矩阵。此性质至关重要，因为由厄米哈密顿量控制的系统，在精确的时间演化下，应保持离散 L2 范数 $\\|\\vec{\\psi}(t)\\|^2 = \\sum_j |\\psi_j(t)|^2$ 守恒。因此，定义为 $\\mathcal{P}(t) = \\Delta x \\sum_{j=0}^{N-1} |\\psi_j(t)|^2$ 的离散总概率也应守恒。这对顶点中心网格 ($x_j = j\\Delta x$) 和单元中心网格 ($x_{j+\\frac{1}{2}} = (j+\\frac{1}{2})\\Delta x$) 都成立，因为在这两种情况下，周期性连接都会产生一个厄米算符。\n\n接下来，必须选择一种对半离散系统进行时间积分的方法。尽管像 Crank-Nicolson 格式或谱传播子这样的幺正积分器会将离散范数守恒保持在机器精度范围内，但它们会掩盖问题要求我们量化的数值效应。一个更有启发性的方法是使用一种标准的、高阶但非幺正的积分器。经典的四阶龙格-库塔 (RK4) 方法是实现此目的的绝佳选择。对于一个常微分方程组 $\\frac{d\\vec{\\psi}}{dt} = \\vec{f}(t, \\vec{\\psi})$，RK4 的一个步长由下式给出：\n$$\n\\vec{\\psi}_{n+1} = \\vec{\\psi}_n + \\frac{1}{6}(\\vec{k}_1 + 2\\vec{k}_2 + 2\\vec{k}_3 + \\vec{k}_4)\n$$\n其中\n$$\n\\begin{aligned}\n\\vec{k}_1 = \\Delta t \\cdot \\vec{f}(t_n, \\vec{\\psi}_n) \\\\\n\\vec{k}_2 = \\Delta t \\cdot \\vec{f}(t_n + \\Delta t/2, \\vec{\\psi}_n + \\vec{k}_1/2) \\\\\n\\vec{k}_3 = \\Delta t \\cdot \\vec{f}(t_n + \\Delta t/2, \\vec{\\psi}_n + \\vec{k}_2/2) \\\\\n\\vec{k}_4 = \\Delta t \\cdot \\vec{f}(t_n + \\Delta t, \\vec{\\psi}_n + \\vec{k}_3)\n\\end{aligned}\n$$\n对于我们的系统，$\\vec{f}(t, \\vec{\\psi}) = -\\mathrm{i}\\hat{H}_{\\text{FD}}\\vec{\\psi}$。RK4 方法的单步放大算子不是幺正的。因此，它不能完美地保持范数，离散概率 $\\mathcal{P}(t)$ 会从其初始值 1 开始漂移。这种漂移的大小 $E = |\\mathcal{P}(T_f) - 1|$ 就是我们必须计算的量。\n\n总体算法如下：\n对于每个测试用例和两种网格布局（顶点中心和单元中心）中的每一种：\n1.  在域 $[0, L)$ 上定义网格点 $x_j$，共有 $N$ 个点，间距为 $\\Delta x = L/N$。\n2.  在这些网格点上计算初始波函数 $\\psi(x,0) = \\mathcal{A}\\,\\exp(-\\frac{(x-x_0)^2}{4\\,\\sigma^2})\\,\\exp(\\mathrm{i}\\,k_0\\,x)$ 的值，以获得初始状态向量 $\\vec{\\psi}(0)$。\n3.  对此状态向量进行归一化。首先，计算初始离散概率 $\\mathcal{P}_{\\text{raw}} = \\Delta x \\sum_{j=0}^{N-1} |\\psi_j(0)|^2$。然后，将向量重新缩放为 $\\vec{\\psi}_{\\text{norm}}(0) = \\vec{\\psi}(0) / \\sqrt{\\mathcal{P}_{\\text{raw}}}$。这确保了初始归一化概率恰好为 1。\n4.  使用 RK4 算法将系统从 $t=0$ 演化到 $t=T_f = n_{\\text{steps}}\\Delta t$。哈密顿量的作用 $\\hat{H}_{\\text{FD}}\\vec{\\psi}$ 在每一步都通过高效计算得出，无需显式构造矩阵，而是使用数组滚动操作来实现周期性中心差分模板。\n5.  在最终时间 $T_f$，计算最终离散概率 $\\mathcal{P}(T_f) = \\Delta x \\sum_{j=0}^{N-1} |\\psi_j(T_f)|^2$。\n6.  计算最终误差 $E = |\\mathcal{P}(T_f) - 1|$。该值作为顶点中心网格的 $E_{\\mathrm{v}}$ 和单元中心网格的 $E_{\\mathrm{c}}$ 进行存储。\n\n对所有指定的测试用例重复此过程，并将得到的误差值收集并格式化为单个列表。$E_{\\mathrm{v}}$ 和 $E_{\\mathrm{c}}$ 之间的差异源于对连续波函数的不同初始采样，这导致了不同的初始离散状态。这些不同的状态随后在非幺正 RK4 时间步进过程中经历略有不同的误差累积路径。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the time-dependent Schrödinger equation for a Gaussian wave packet\n    on a periodic domain using two different spatial discretizations and\n    quantifies the conservation of total probability.\n    \"\"\"\n    \n    # Test cases: (L, N, dt, n_steps, sigma, k0, x0)\n    test_cases = [\n        (20.0, 200, 0.005, 400, 1.0, 4.0, 5.0),\n        (20.0, 40, 0.005, 400, 1.0, 4.0, 5.0),\n        (20.0, 8, 0.0025, 200, 1.0, 3.0, 20.0/3.0),\n        (20.0, 128, 0.005, 400, 1.2, 0.0, 10.0),\n    ]\n\n    results = []\n\n    for L, N, dt, n_steps, sigma, k0, x0 in test_cases:\n        dx = L / N\n\n        for grid_type in ['vertex', 'cell']:\n            # 1. Grid Construction\n            if grid_type == 'vertex':\n                # Vertex-centered grid: x_j = j*dx\n                x = np.arange(N) * dx\n            else:  # cell-centered\n                # Cell-centered grid: x_{j+1/2} = (j+0.5)*dx\n                x = (np.arange(N) + 0.5) * dx\n            \n            # 2. Initial Condition\n            # The complex-valued Gaussian wave packet\n            psi_initial = np.exp(-(x - x0)**2 / (4 * sigma**2)) * np.exp(1j * k0 * x)\n            psi = psi_initial.astype(np.complex128)\n\n            # 3. Normalization\n            # Ensure the initial discrete probability is 1\n            prob_initial = dx * np.sum(np.abs(psi)**2)\n            psi /= np.sqrt(prob_initial)\n\n            def dpsi_dt(psi_vec, dx_val):\n                \"\"\"\n                Computes the time derivative of the wave function vector psi_vec,\n                which is -i * H * psi_vec.\n                The Hamiltonian H = -1/2 * d^2/dx^2 is approximated with\n                a central finite difference scheme on a periodic domain.\n                \"\"\"\n                # Second derivative using central differences with periodic BCs\n                # np.roll provides an efficient way to handle periodic boundaries.\n                d2psi_dx2 = (np.roll(psi_vec, -1) - 2 * psi_vec + np.roll(psi_vec, 1)) / dx_val**2\n                \n                # Action of the Hamiltonian operator H on psi\n                H_psi = -0.5 * d2psi_dx2\n                \n                # From Schrödinger eq: i*d(psi)/dt = H*psi => d(psi)/dt = -i*H*psi\n                return -1j * H_psi\n\n            # 4. Time Evolution using 4th-order Runge-Kutta (RK4)\n            for _ in range(n_steps):\n                k1 = dt * dpsi_dt(psi, dx)\n                k2 = dt * dpsi_dt(psi + 0.5 * k1, dx)\n                k3 = dt * dpsi_dt(psi + 0.5 * k2, dx)\n                k4 = dt * dpsi_dt(psi + k3, dx)\n                psi += (k1 + 2*k2 + 2*k3 + k4) / 6.0\n                \n            # 5. Final Probability and Error Calculation\n            prob_final = dx * np.sum(np.abs(psi)**2)\n            error = np.abs(prob_final - 1.0)\n            results.append(error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.6e}' for r in results)}]\")\n\nsolve()\n```", "id": "2376114"}, {"introduction": "当物理问题（如各向异性）与非理想网格（如非正交网格）相结合时，数值格式的精度面临严峻考验。本练习旨在揭示一个经典的难点：简单的单元中心二点通量格式在处理非正交网格上的各向异性扩散问题时会产生显著的“交叉扩散”误差。通过与能够精确重构梯度的节点中心格式进行对比，你将亲身体会到不同离散策略在处理复杂几何与物理耦合问题时的准确性差异。[@problem_id:2376138]", "problem": "考虑由 Fick 定律给出的二维稳态各向异性扩散通量，其中扩散通量矢量由基本本构关系 $\\,\\mathbf{q} = -\\mathbf{K}\\,\\nabla u\\,$ 定义，其中 $\\,\\mathbf{K}\\,$ 是一个对称正定张量。对于一个外向单位法向量为 $\\,\\mathbf{n}\\,$、长度为 $\\,L\\,$ 的控制体面，穿过该面的精确积分扩散通量是面积分 $\\,\\Phi = \\int_{\\text{face}} \\mathbf{q}\\cdot\\mathbf{n}\\, \\mathrm{d}S\\,$，对于线性场 $\\,u(\\mathbf{x})\\,$ 和平直面，该积分可简化为 $\\,\\Phi = -L\\,\\mathbf{n}\\cdot \\mathbf{K}\\,\\nabla u\\,$。我们将比较非正交网格上的两种有限体积离散化方法，并量化它们对交叉扩散项的处理。这两种方案是：单元中心的两点通量近似和顶点中心的线性重构近似。\n\n我们关注通过映射 $\\,\\mathcal{M}:\\ (\\xi,\\eta)\\mapsto (x,y)\\,$（定义为 $\\,x=\\xi + s\\,\\eta\\,$ 和 $\\,y=\\eta\\,$，其中 $\\,s\\,$ 是倾斜参数）获得的倾斜平行四边形网格中的一个内面。考虑计算域直线 $\\,\\xi=0\\,$ 在 $\\,\\eta\\in[-\\tfrac{1}{2},\\tfrac{1}{2}]\\,$ 上的像所对应的面。两个相邻的单元中心是 $\\,(\\xi,\\eta)=(-\\tfrac{1}{2},0)\\,$ 和 $\\,(\\tfrac{1}{2},0)\\,$ 的像。对于此配置，精确的面长度矢量等于 $\\,\\mathbf{A}_f = L\\,\\mathbf{n} = (1,-s)\\,$，因此，对于具有恒定梯度 $\\,\\nabla u=\\mathbf{g}\\,$ 的线性场，精确的积分通量为\n$$\n\\Phi_{\\text{exact}} \\;=\\; -\\,\\mathbf{A}_f \\cdot \\big(\\mathbf{K}\\,\\mathbf{g}\\big) \\;=\\; -\\,(1,-s)\\cdot\\big(\\mathbf{K}\\,\\mathbf{g}\\big).\n$$\n我们将比较同一面的以下两种离散化方法：\n\n- 单元中心的两点通量近似 (CC-TPFA)：通过梯度在连接两个单元中心线上的投影来近似梯度。设 $\\,\\mathbf{d}\\,$ 是从左单元中心到右单元中心的矢量。对于我们的配置，$\\,\\mathbf{d}=(1,0)\\,$ 且其单位方向为 $\\,\\hat{\\mathbf{d}}=(1,0)\\,$。两点梯度近似为 $\\,\\nabla u \\approx (\\mathbf{g}\\cdot \\hat{\\mathbf{d}})\\,\\hat{\\mathbf{d}}\\,$，相应的积分通量近似为\n$$\n\\Phi_{\\text{CC}} \\;=\\; -\\,\\mathbf{A}_f \\cdot \\Big(\\mathbf{K}\\,\\big[(\\mathbf{g}\\cdot \\hat{\\mathbf{d}})\\,\\hat{\\mathbf{d}}\\big]\\Big).\n$$\n当 $\\,\\mathbf{K}\\,$ 是各向异性或当 $\\,\\mathbf{g}\\,$ 有一个不与 $\\,\\hat{\\mathbf{d}}\\,$ 对齐的重要分量时，该近似忽略了 $\\,\\nabla u\\,$ 相对于 $\\,\\hat{\\mathbf{d}}\\,$ 的切向分量，因此忽略了由非正交性引起的交叉扩散。\n\n- 顶点中心的线性重构 (VC-LR)：通过拟合一个平面 $\\,u(x,y)=\\alpha + a\\,x + b\\,y\\,$，从面附近三个不共线的网格顶点的值重构完整梯度，从而得到一个估计值 $\\,\\widehat{\\nabla u}=(a,b)^\\top\\,$。对于线性场，这种重构是精确的。相应的积分通量近似为\n$$\n\\Phi_{\\text{VC}} \\;=\\; -\\,\\mathbf{A}_f \\cdot \\big(\\mathbf{K}\\,\\widehat{\\nabla u}\\big).\n$$\n\n假设一个线性人造解 $\\,u(x,y) = a\\,x + b\\,y + c\\,$，其梯度为常数 $\\,\\mathbf{g}=(a,b)^\\top\\,$。假设一个对称各向异性张量\n$$\n\\mathbf{K} \\;=\\; \\begin{bmatrix} k_{xx}  k_{xy} \\\\ k_{xy}  k_{yy}\\end{bmatrix},\n$$\n其中 $\\,k_{xx}>0\\,$，$\\,k_{yy}>0\\,$，且 $\\,k_{xx}\\,k_{yy} - k_{xy}^2 > 0\\,$。对于顶点中心的重构，使用通过映射 $\\,\\mathcal{M}\\,$ 从计算坐标 $\\,(\\xi,\\eta)\\in\\{(0,-\\tfrac{1}{2}),(0,\\tfrac{1}{2}),(\\,1,0)\\}\\,$ 获得的三个物理空间顶点，即，面两端的两个顶点和右侧的一个顶点，以形成一个非退化三角形。\n\n您的任务是实现一个程序，为下面的每个测试用例计算以下两个绝对通量误差：\n$$\nE_{\\text{CC}} \\;=\\; \\big|\\Phi_{\\text{CC}} - \\Phi_{\\text{exact}}\\big|\\,,\\qquad\nE_{\\text{VC}} \\;=\\; \\big|\\Phi_{\\text{VC}} - \\Phi_{\\text{exact}}\\big|.\n$$\n将所有测试用例的结果以单行、逗号分隔的扁平列表形式报告，并用方括号括起来，顺序为 $[E_{\\text{CC}}^{(1)},E_{\\text{VC}}^{(1)},E_{\\text{CC}}^{(2)},E_{\\text{VC}}^{(2)},\\dots]$。\n\n本问题中没有物理单位；所有量纲均为无量纲。不使用角度。\n\n测试套件参数如下，其中每个案例指定了倾斜度 $\\,s\\,$、张量分量 $\\,k_{xx},k_{yy},k_{xy}\\,$ 以及梯度分量 $\\,a,b\\,$：\n\n- 案例 $\\,1\\,$ (理想情况，中等倾斜度，对角各向异性，混合梯度)：$\\,s=0.3\\,$, $\\,k_{xx}=2.0\\,$, $\\,k_{yy}=1.0\\,$, $\\,k_{xy}=0.0\\,$, $\\,a=1.0\\,$, $\\,b=-0.5\\,$.\n- 案例 $\\,2\\,$ (边缘情况，强倾斜度，对角各向异性，相等分量)：$\\,s=0.9\\,$, $\\,k_{xx}=2.0\\,$, $\\,k_{yy}=1.0\\,$, $\\,k_{xy}=0.0\\,$, $\\,a=1.0\\,$, $\\,b=1.0\\,$.\n- 案例 $\\,3\\,$ (边缘情况，强各向异性，对角，梯度由切向分量主导)：$\\,s=0.5\\,$, $\\,k_{xx}=10.0\\,$, $\\,k_{yy}=1.0\\,$, $\\,k_{xy}=0.0\\,$, $\\,a=0.2\\,$, $\\,b=2.0\\,$.\n- 案例 $\\,4\\,$ (边界条件替代，正交网格)：$\\,s=0.0\\,$, $\\,k_{xx}=2.0\\,$, $\\,k_{yy}=1.0\\,$, $\\,k_{xy}=0.0\\,$, $\\,a=1.0\\,$, $\\,b=0.5\\,$.\n- 案例 $\\,5\\,$ (边缘情况，存在非对角各向异性)：$\\,s=0.4\\,$, $\\,k_{xx}=1.0\\,$, $\\,k_{yy}=2.0\\,$, $\\,k_{xy}=0.5\\,$, $\\,a=1.0\\,$, $\\,b=1.0\\,$.\n\n需要遵守的实现细节：\n\n- 使用精确的面长度矢量 $\\,\\mathbf{A}_f=(1,-s)\\,$、单元中心矢量 $\\,\\mathbf{d}=(1,0)\\,$ 及其单位矢量 $\\,\\hat{\\mathbf{d}}=(1,0)\\,$，以及上面给出的顶点集。在 $\\,u(x,y)\\,$ 中使用 $\\,c=0\\,$。\n- 直接从 $\\,\\mathbf{A}_f\\,$、$\\,\\mathbf{K}\\,$ 和 $\\,\\mathbf{g}\\,$ 计算 $\\,\\Phi_{\\text{exact}}\\,$。\n- 对于 CC-TPFA，使用 $\\,\\nabla u \\approx (\\mathbf{g}\\cdot \\hat{\\mathbf{d}})\\,\\hat{\\mathbf{d}}\\,$。\n- 对于 VC-LR，通过对顶点数据进行平面最小二乘拟合来重构 $\\,\\widehat{\\nabla u}\\,$；对于三个不共线的点和一个线性场，这是精确的。\n- 您的程序应生成单行输出，其中包含按上述顺序排列、用方括号括起来的逗号分隔列表形式的结果，例如 $\\,\\big[ E_{\\text{CC}}^{(1)},E_{\\text{VC}}^{(1)},E_{\\text{CC}}^{(2)},E_{\\text{VC}}^{(2)},\\dots\\big]\\,$。\n\n所有测试用例所需的最终输出均为浮点数。请确保数值稳定性并使用标准的双精度算术。不允许外部输入，也不需要用户交互。程序必须是自包含且确定性的。", "solution": "问题陈述已经过评估并被确定为有效。它在科学上基于连续介质力学和偏微分方程数值方法的原理。该问题是适定的、客观的，并为获得唯一解提供了完整且一致的定义和数据集。因此，我们可以进行推导和计算。\n\n该问题要求针对一个稳态各向异性扩散问题，比较两种有限体积通量近似与精确通量。分析是在线性标量场的假设下，针对倾斜网格的单个面进行的。\n\n首先，我们确定所提供的数学实体。\n扩散张量是一个对称正定矩阵 $\\mathbf{K}$：\n$$\n\\mathbf{K} = \\begin{bmatrix} k_{xx}  k_{xy} \\\\ k_{xy}  k_{yy}\\end{bmatrix}\n$$\n标量场 $u(x,y)$ 是线性的，由 $u(x,y) = a\\,x + b\\,y + c$ 给出，其梯度矢量 $\\mathbf{g}$ 为常数：\n$$\n\\mathbf{g} = \\nabla u = \\begin{bmatrix} a \\\\ b \\end{bmatrix}\n$$\n所考虑的控制体面由其面长度矢量 $\\mathbf{A}_f$ 来表征，该矢量结合了面长度 $L$ 和外向单位法向量 $\\mathbf{n}$，即 $\\mathbf{A}_f = L\\mathbf{n}$。对于指定的几何形状，该矢量给出为：\n$$\n\\mathbf{A}_f = \\begin{bmatrix} 1 \\\\ -s \\end{bmatrix}\n$$\n其中 $s$ 是网格倾斜参数。\n\n分析的关键在于计算三个积分通量：$\\Phi_{\\text{exact}}$、$\\Phi_{\\text{CC}}$ 和 $\\Phi_{\\text{VC}}$。\n\n1.  **精确积分通量 ($\\Phi_{\\text{exact}}$)**\n\n    对于线性场，穿过平直面的精确积分通量由公式 $\\Phi = -L\\,\\mathbf{n}\\cdot \\mathbf{K}\\,\\nabla u$ 给出，使用面长度矢量 $\\mathbf{A}_f$ 和恒定梯度 $\\mathbf{g}$ 可将其重写为：\n    $$\n    \\Phi_{\\text{exact}} = -\\mathbf{A}_f \\cdot (\\mathbf{K}\\,\\mathbf{g})\n    $$\n    代入分量，我们得到：\n    $$\n    \\mathbf{K}\\,\\mathbf{g} = \\begin{bmatrix} k_{xx}  k_{xy} \\\\ k_{xy}  k_{yy}\\end{bmatrix} \\begin{bmatrix} a \\\\ b \\end{bmatrix} = \\begin{bmatrix} k_{xx}a + k_{xy}b \\\\ k_{xy}a + k_{yy}b \\end{bmatrix}\n    $$\n    点积则为：\n    $$\n    \\mathbf{A}_f \\cdot (\\mathbf{K}\\,\\mathbf{g}) = \\begin{bmatrix} 1 \\\\ -s \\end{bmatrix} \\cdot \\begin{bmatrix} k_{xx}a + k_{xy}b \\\\ k_{xy}a + k_{yy}b \\end{bmatrix} = (k_{xx}a + k_{xy}b) - s(k_{xy}a + k_{yy}b)\n    $$\n    因此，精确通量为：\n    $$\n    \\Phi_{\\text{exact}} = - \\big( k_{xx}a + k_{xy}b - s\\,k_{xy}a - s\\,k_{yy}b \\big)\n    $$\n\n2.  **单元中心的两点通量近似 ($\\Phi_{\\text{CC}}$)**\n\n    这种近似 (CC-TPFA) 通过只考虑梯度在连接两个相邻单元中心线上的投影来简化梯度。连接这些中心的矢量是 $\\mathbf{d}=(1,0)$，其单位矢量为 $\\hat{\\mathbf{d}}=(1,0)$。近似梯度 $\\mathbf{g}_{\\text{CC}}$ 为：\n    $$\n    \\mathbf{g}_{\\text{CC}} = (\\mathbf{g} \\cdot \\hat{\\mathbf{d}})\\,\\hat{\\mathbf{d}}\n    $$\n    分量计算：\n    $$\n    \\mathbf{g} \\cdot \\hat{\\mathbf{d}} = \\begin{bmatrix} a \\\\ b \\end{bmatrix} \\cdot \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} = a\n    $$\n    所以，近似梯度为：\n    $$\n    \\mathbf{g}_{\\text{CC}} = a \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} a \\\\ 0 \\end{bmatrix}\n    $$\n    通量则近似为：\n    $$\n    \\Phi_{\\text{CC}} = -\\mathbf{A}_f \\cdot (\\mathbf{K}\\,\\mathbf{g}_{\\text{CC}})\n    $$\n    我们计算项 $\\mathbf{K}\\,\\mathbf{g}_{\\text{CC}}$：\n    $$\n    \\mathbf{K}\\,\\mathbf{g}_{\\text{CC}} = \\begin{bmatrix} k_{xx}  k_{xy} \\\\ k_{xy}  k_{yy}\\end{bmatrix} \\begin{bmatrix} a \\\\ 0 \\end{bmatrix} = \\begin{bmatrix} k_{xx}a \\\\ k_{xy}a \\end{bmatrix}\n    $$\n    最终的通量表达式为：\n    $$\n    \\Phi_{\\text{CC}} = -\\begin{bmatrix} 1 \\\\ -s \\end{bmatrix} \\cdot \\begin{bmatrix} k_{xx}a \\\\ k_{xy}a \\end{bmatrix} = -(k_{xx}a - s\\,k_{xy}a)\n    $$\n\n3.  **顶点中心的线性重构通量 ($\\Phi_{\\text{VC}}$)**\n\n    该方法通过将线性函数拟合到三个不共线顶点的标量值来重构梯度 $\\widehat{\\nabla u}$。问题陈述断言，对于线性场 $u(x,y)$，这种重构是精确的。这是有限元和有限体积方法中的一个标准结果。因此，重构梯度 $\\widehat{\\nabla u}$ 与真实梯度 $\\mathbf{g}$ 相同：\n    $$\n    \\widehat{\\nabla u} = \\mathbf{g}\n    $$\n    因此，通量近似为：\n    $$\n    \\Phi_{\\text{VC}} = -\\mathbf{A}_f \\cdot (\\mathbf{K}\\,\\widehat{\\nabla u}) = -\\mathbf{A}_f \\cdot (\\mathbf{K}\\,\\mathbf{g}) = \\Phi_{\\text{exact}}\n    $$\n\n4.  **绝对通量误差 ($E_{\\text{CC}}$ 和 $E_{\\text{VC}}$)**\n\n    误差定义为近似通量与精确通量之间的绝对差值。\n\n    对于顶点中心方案，在问题的条件下，误差恒为零：\n    $$\n    E_{\\text{VC}} = |\\Phi_{\\text{VC}} - \\Phi_{\\text{exact}}| = |\\Phi_{\\text{exact}} - \\Phi_{\\text{exact}}| = 0\n    $$\n\n    对于单元中心方案，误差为：\n    $$\n    E_{\\text{CC}} = |\\Phi_{\\text{CC}} - \\Phi_{\\text{exact}}| = \\left| -\\left(k_{xx}a - s\\,k_{xy}a\\right) - \\left[- \\left( k_{xx}a + k_{xy}b - s\\,k_{xy}a - s\\,k_{yy}b \\right)\\right] \\right|\n    $$\n    $$\n    E_{\\text{CC}} = \\left| -k_{xx}a + s\\,k_{xy}a + k_{xx}a + k_{xy}b - s\\,k_{xy}a - s\\,k_{yy}b \\right|\n    $$\n    通过消去项来简化表达式，得到：\n    $$\n    E_{\\text{CC}} = |k_{xy}b - s\\,k_{yy}b| = |b(k_{xy} - s\\,k_{yy})|\n    $$\n    这个误差项被称为交叉扩散误差，它源于该方法未能考虑由垂直于单元中心矢量的梯度部分驱动的通量分量，尤其是在网格非正交（$s \\neq 0$）或张量非对角（$k_{xy} \\neq 0$）时。\n\n现在，我们将这些公式应用于给定的测试用例。\n\n**案例 1：** $s=0.3$, $k_{xx}=2.0$, $k_{yy}=1.0$, $k_{xy}=0.0$, $a=1.0$, $b=-0.5$.\n$$\nE_{\\text{CC}} = |-0.5 \\times (0.0 - 0.3 \\times 1.0)| = |-0.5 \\times -0.3| = |0.15| = 0.15\n$$\n$$\nE_{\\text{VC}} = 0.0\n$$\n\n**案例 2：** $s=0.9$, $k_{xx}=2.0$, $k_{yy}=1.0$, $k_{xy}=0.0$, $a=1.0$, $b=1.0$.\n$$\nE_{\\text{CC}} = |1.0 \\times (0.0 - 0.9 \\times 1.0)| = |1.0 \\times -0.9| = |-0.9| = 0.9\n$$\n$$\nE_{\\text{VC}} = 0.0\n$$\n\n**案例 3：** $s=0.5$, $k_{xx}=10.0$, $k_{yy}=1.0$, $k_{xy}=0.0$, $a=0.2$, $b=2.0$.\n$$\nE_{\\text{CC}} = |2.0 \\times (0.0 - 0.5 \\times 1.0)| = |2.0 \\times -0.5| = |-1.0| = 1.0\n$$\n$$\nE_{\\text{VC}} = 0.0\n$$\n\n**案例 4：** $s=0.0$, $k_{xx}=2.0$, $k_{yy}=1.0$, $k_{xy}=0.0$, $a=1.0$, $b=0.5$.\n$$\nE_{\\text{CC}} = |0.5 \\times (0.0 - 0.0 \\times 1.0)| = |0.5 \\times 0.0| = 0.0\n$$\n$$\nE_{\\text{VC}} = 0.0\n$$\nCC-TPFA 的误差为零，因为网格是正交的（$s=0$）且张量是对角的（$k_{xy}=0$）。\n\n**案例 5：** $s=0.4$, $k_{xx}=1.0$, $k_{yy}=2.0$, $k_{xy}=0.5$, $a=1.0$, $b=1.0$.\n$$\nE_{\\text{CC}} = |1.0 \\times (0.5 - 0.4 \\times 2.0)| = |1.0 \\times (0.5 - 0.8)| = |-0.3| = 0.3\n$$\n$$\nE_{\\text{VC}} = 0.0\n$$\n\n最终结果已按要求收集和格式化。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes absolute flux errors for CC-TPFA and VC-LR discretization schemes\n    for a steady anisotropic diffusion problem on a skewed mesh.\n    \"\"\"\n    test_cases = [\n        # Case 1: (s, k_xx, k_yy, k_xy, a, b)\n        (0.3, 2.0, 1.0, 0.0, 1.0, -0.5),\n        # Case 2:\n        (0.9, 2.0, 1.0, 0.0, 1.0, 1.0),\n        # Case 3:\n        (0.5, 10.0, 1.0, 0.0, 0.2, 2.0),\n        # Case 4:\n        (0.0, 2.0, 1.0, 0.0, 1.0, 0.5),\n        # Case 5:\n        (0.4, 1.0, 2.0, 0.5, 1.0, 1.0),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        s, k_xx, k_yy, k_xy, a, b = case\n\n        # Define the mathematical entities as numpy arrays\n        # Diffusion tensor K\n        K = np.array([[k_xx, k_xy], [k_xy, k_yy]])\n        \n        # Exact gradient vector g\n        g = np.array([a, b])\n        \n        # Face-length vector A_f\n        A_f = np.array([1.0, -s])\n        \n        # Unit vector along the line connecting cell centers\n        d_hat = np.array([1.0, 0.0])\n\n        # 1. Exact Integrated Flux (Phi_exact)\n        # Phi_exact = - A_f . (K * g)\n        Kg = K @ g\n        phi_exact = -np.dot(A_f, Kg)\n\n        # 2. Cell-Centered Two-Point Flux Approximation (Phi_CC)\n        # Gradient approximation: g_cc = (g . d_hat) * d_hat\n        g_cc = np.dot(g, d_hat) * d_hat\n        # Phi_CC = - A_f . (K * g_cc)\n        Kg_cc = K @ g_cc\n        phi_cc = -np.dot(A_f, Kg_cc)\n\n        # 3. Vertex-Centered Linear Reconstruction Flux (Phi_VC)\n        # For a linear field, the reconstruction is exact, so the reconstructed\n        # gradient is identical to the true gradient g.\n        g_vc = g\n        # As a result, Phi_VC is identical to Phi_exact.\n        Kg_vc = K @ g_vc\n        phi_vc = -np.dot(A_f, Kg_vc)\n\n        # 4. Compute Absolute Flux Errors\n        E_cc = np.abs(phi_cc - phi_exact)\n        E_vc = np.abs(phi_vc - phi_exact)\n        \n        # As a sanity check, E_vc should be very close to zero.\n        # Use a small tolerance for floating point arithmetic.\n        if E_vc  1e-15:\n            E_vc = 0.0\n\n        results.extend([E_cc, E_vc])\n\n    # Format the final output string\n    # Using 'g' format specifier for clean output of floats.\n    print(f\"[{','.join(f'{r:.15g}' for r in results)}]\")\n\nsolve()\n```", "id": "2376138"}, {"introduction": "在实际工程模拟中，为了在关键区域提高计算精度，我们常常使用网格局部加密技术，但这会产生“悬挂节点”（hanging nodes），给数值计算带来挑战。本练习模拟了这样一个非协调网格界面，并展示了基于通量平衡的单元中心格式如何自然地保持其局部守恒性。与之相对，节点中心格式则需要引入额外的约束条件来处理悬挂节点，通过本练习你可以深入理解这两种方法在处理复杂网格拓扑时的根本区别。[@problem_id:2376143]", "problem": "考虑由二阶椭圆方程 $-\\nabla \\cdot \\left( k \\nabla u \\right) = 0$ 描述的稳态扩散，其中具有恒定的各向同性传导系数 $k0$。关注二维中的一个局部非协调界面，其中左侧一个宽度为 $h_c$ 的粗矩形单元与右侧两个宽度均为 $h_f$ 且垂直堆叠的细矩形单元相接。假设 $h_c = 2 h_f$。该界面是位于 $x=0$ 处、范围为 $y \\in [-h_f, h_f]$ 的垂直线段。粗单元中心位于 $(-h_c/2, 0)$，两个细单元中心分别位于 $(h_f/2, h_f/2)$ 和 $(h_f/2, -h_f/2)$。考虑一个制造的线性场 $u(x,y) = a x + b y + c$ 和恒定的 $k$。\n\n任务 A（通过通量平衡的单元中心格式，有限体积法 (FVM)）：在每个子面上使用两点通量近似，对从粗单元到两个细单元的通量进行建模。对于一个长度为 $A = h_f$、由法向距离为 $d = (h_c/2) + (h_f/2)$ 的单元中心共享的子面，其传输系数为 $T = k A / d$。从粗单元中心到细单元中心的通量为 $F = -T \\left( u_{\\text{fine}} - u_{\\text{coarse}} \\right)$。为上方的细单元定义 $F_{0 \\to 1}$，为下方的细单元定义 $F_{0 \\to 2}$，并计算总数值通量 $F_{\\text{cc}} = F_{0 \\to 1} + F_{0 \\to 2}$。通过整个非协调界面段的精确积分通量为\n$$\nF_{\\text{exact}} = \\int_{-h_f}^{h_f} \\left(-k \\frac{\\partial u}{\\partial x} \\right) \\, dy = -2 k a h_f.\n$$\n定义单元中心绝对误差 $E_{\\mathrm{cc}} = \\left| F_{\\text{cc}} - F_{\\text{exact}} \\right|$。\n\n任务 B（朴素的顶点中心格式）：在使用围绕顶点的控制体的顶点中心离散化中，非协调界面在 $(0,0)$ 处引入了一个悬挂节点，该点不是粗单元的顶点。如果忽略此悬挂节点而不添加任何约束，则归属于粗单元顶点的通量仅覆盖两端部分，而遗漏了长度为 $h_f$ 的中心部分。在线性场 $u(x,y) = a x + b y + c$ 和恒定 $k$ 的条件下，沿界面的法向通量密度是均匀的，等于 $-k a$，因此缺失的通量贡献为 $-k a \\cdot h_f$。定义朴素顶点中心绝对不平衡量为 $E_{\\mathrm{vn}} = \\left| -k a \\cdot h_f \\right|$。\n\n任务 C（修正的顶点中心格式，带悬挂节点约束）：顶点中心方法中的一个标准修正是对悬挂节点施加线性约束，例如 $u_{\\text{hang}} = \\frac{1}{2} \\left( u_{\\text{top}} + u_{\\text{bottom}} \\right)$，并将中心段的通量一致地重新分配给相邻顶点。在给定的线性场下，此修正恢复了跨界面的正确积分通量归属。对于此线性场和配置，定义修正的顶点中心残差 $E_{\\mathrm{vm}} = 0$。\n\n使用以下参数化进行测试。在所有情况下，取 $b = 0.7$ 和 $c = -0.2$。对于每个测试用例，计算并返回如上所述的三元组 $\\left(E_{\\mathrm{cc}}, E_{\\mathrm{vn}}, E_{\\mathrm{vm}}\\right)$。\n\n测试套件（每个用例是一个元组 $(h_f, k, a)$）：\n- 用例 1：$(1.0, 1.0, 1.5)$。\n- 用例 2：$(0.5, 3.0, -2.0)$。\n- 用例 3：$(2.0, 0.7, 0.0)$。\n- 用例 4：$(10^{-3}, 5.0, 4.0)$。\n\n要实现的计算细节：\n- 使用 $h_c = 2 h_f$，面长 $A = h_f$，中心到中心的法向距离 $d = \\frac{h_c}{2} + \\frac{h_f}{2} = \\frac{3}{2} h_f$，传输系数 $T = \\frac{k A}{d}$。\n- 使用单元中心坐标 $x_0 = -\\frac{h_c}{2}$，$y_0 = 0$，$x_1 = \\frac{h_f}{2}$，$y_1 = \\frac{h_f}{2}$，以及 $x_2 = \\frac{h_f}{2}$，$y_2 = -\\frac{h_f}{2}$。在这些中心点评估 $u$ 并如上所述构成 $F_{0 \\to 1}$ 和 $F_{0 \\to 2}$。\n- 计算 $F_{\\text{exact}} = -2 k a h_f$，然后计算 $E_{\\mathrm{cc}} = \\left| F_{0 \\to 1} + F_{0 \\to 2} - F_{\\text{exact}} \\right|$。\n- 计算 $E_{\\mathrm{vn}} = \\left| -k a \\cdot h_f \\right|$。\n- 设置 $E_{\\mathrm{vm}} = 0$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含结果，形式为用方括号括起来的逗号分隔列表。该列表应按给定顺序将各测试用例的结果平铺展开，即 $[E_{\\mathrm{cc}}^{(1)}, E_{\\mathrm{vn}}^{(1)}, E_{\\mathrm{vm}}^{(1)}, E_{\\mathrm{cc}}^{(2)}, E_{\\mathrm{vn}}^{(2)}, E_{\\mathrm{vm}}^{(2)}, \\dots]$。每个条目必须是一个浮点数。", "solution": "在尝试任何解决方案之前，需对问题陈述进行验证。\n\n步骤 1：提取给定条件\n- 控制方程：$-\\nabla \\cdot \\left( k \\nabla u \\right) = 0$，用于稳态扩散。\n- 传导系数：$k$ 是一个正的、恒定的、各向同性的标量。\n- 制造解：$u(x,y) = a x + b y + c$。\n- 几何结构：左侧一个粗矩形单元，宽度 $h_c$。右侧两个细矩形单元，每个宽度 $h_f$。\n- 几何约束：$h_c = 2 h_f$。\n- 界面：位于 $x=0$ 的垂直线，从 $y = -h_f$ 到 $y = h_f$。\n- 单元中心：\n    - 粗单元 $C_0$：$(-h_c/2, 0) = (-h_f, 0)$。\n    - 上方细单元 $C_1$：$(h_f/2, h_f/2)$。\n    - 下方细单元 $C_2$：$(h_f/2, -h_f/2)$。\n- 任务 A（单元中心法）：\n    - 两点通量近似：$F = -T \\left( u_{\\text{fine}} - u_{\\text{coarse}} \\right)$。\n    - 子面长度：$A = h_f$。\n    - 中心到中心的法向距离：$d = (h_c/2) + (h_f/2) = (3/2)h_f$。\n    - 传输系数：$T = k A / d$。\n    - 数值通量：$F_{0 \\to 1}$ 和 $F_{0 \\to 2}$。\n    - 总数值通量：$F_{\\text{cc}} = F_{0 \\to 1} + F_{0 \\to 2}$。\n    - 精确积分通量：$F_{\\text{exact}} = \\int_{-h_f}^{h_f} \\left(-k \\frac{\\partial u}{\\partial x} \\right) \\, dy = -2 k a h_f$。\n    - 单元中心绝对误差：$E_{\\mathrm{cc}} = \\left| F_{\\text{cc}} - F_{\\text{exact}} \\right|$。\n- 任务 B（朴素顶点中心法）：\n    - 朴素顶点中心绝对不平衡量：$E_{\\mathrm{vn}} = \\left| -k a \\cdot h_f \\right|$。\n- 任务 C（修正顶点中心法）：\n    - 修正的顶点中心残差：$E_{\\mathrm{vm}} = 0$。\n- 所有测试用例的参数：$b = 0.7$，$c = -0.2$。\n- 测试用例 $(h_f, k, a)$：\n    1. $(1.0, 1.0, 1.5)$\n    2. $(0.5, 3.0, -2.0)$\n    3. $(2.0, 0.7, 0.0)$\n    4. $(10^{-3}, 5.0, 4.0)$\n\n步骤 2：使用提取的给定条件进行验证\n该问题具有科学依据，涉及基本椭圆偏微分方程的标准离散化方法（有限体积法）。问题是适定的，提供了一套清晰的待执行计算。语言客观、精确，使用了计算工程领域的既定术语。所有必要的参数和公式均已提供，且没有内部矛盾。该设置代表了数值网格生成中的常见情景（非协调网格加密），并且使用制造解进行代码验证是一种标准技术。该问题是有效的。\n\n步骤 3：结论与行动\n该问题是有效的。将提供一个完整的解决方案。\n\n目标是为几组参数计算误差三元组 $\\left(E_{\\mathrm{cc}}, E_{\\mathrm{vn}}, E_{\\mathrm{vm}}\\right)$。\n\n首先，我们推导单元中心误差 $E_{\\mathrm{cc}}$ 的一般表达式。\n给定的制造解为 $u(x,y) = a x + b y + c$。我们在三个单元中心处评估该解：\n- 粗单元中心 $C_0$ 位于 $(x_0, y_0) = (-h_f, 0)$：\n$$u_0 = u(-h_f, 0) = a(-h_f) + b(0) + c = -a h_f + c$$\n- 上方细单元中心 $C_1$ 位于 $(x_1, y_1) = (h_f/2, h_f/2)$：\n$$u_1 = u(h_f/2, h_f/2) = a(h_f/2) + b(h_f/2) + c = \\frac{a h_f}{2} + \\frac{b h_f}{2} + c$$\n- 下方细单元中心 $C_2$ 位于 $(x_2, y_2) = (h_f/2, -h_f/2)$：\n$$u_2 = u(h_f/2, -h_f/2) = a(h_f/2) + b(-h_f/2) + c = \\frac{a h_f}{2} - \\frac{b h_f}{2} + c$$\n\n传输系数 $T$ 定义为 $T = \\frac{k A}{d}$。子面面积（二维中为长度）$A=h_f$，中心到中心距离 $d = \\frac{h_c}{2} + \\frac{h_f}{2} = \\frac{2 h_f}{2} + \\frac{h_f}{2} = \\frac{3}{2} h_f$，我们得到：\n$$T = \\frac{k h_f}{\\frac{3}{2} h_f} = \\frac{2k}{3}$$\n\n现在，我们计算从粗单元 $C_0$ 到细单元 $C_1$ 和 $C_2$ 的数值通量。\n到上方细单元的通量为 $F_{0 \\to 1} = -T(u_1 - u_0)$：\n$$F_{0 \\to 1} = -\\frac{2k}{3} \\left[ \\left(\\frac{a h_f}{2} + \\frac{b h_f}{2} + c\\right) - (-a h_f + c) \\right]$$\n$$F_{0 \\to 1} = -\\frac{2k}{3} \\left[ \\frac{3a h_f}{2} + \\frac{b h_f}{2} \\right] = -k \\left( a h_f + \\frac{b h_f}{3} \\right)$$\n到下方细单元的通量为 $F_{0 \\to 2} = -T(u_2 - u_0)$：\n$$F_{0 \\to 2} = -\\frac{2k}{3} \\left[ \\left(\\frac{a h_f}{2} - \\frac{b h_f}{2} + c\\right) - (-a h_f + c) \\right]$$\n$$F_{0 \\to 2} = -\\frac{2k}{3} \\left[ \\frac{3a h_f}{2} - \\frac{b h_f}{2} \\right] = -k \\left( a h_f - \\frac{b h_f}{3} \\right)$$\n\n穿过界面的总单元中心数值通量 $F_{\\text{cc}}$ 是两者的和：\n$$F_{\\text{cc}} = F_{0 \\to 1} + F_{0 \\to 2} = -k \\left( a h_f + \\frac{b h_f}{3} \\right) - k \\left( a h_f - \\frac{b h_f}{3} \\right)$$\n$$F_{\\text{cc}} = -k a h_f - \\frac{k b h_f}{3} - k a h_f + \\frac{k b h_f}{3} = -2 k a h_f$$\n\n精确积分通量由 $F_{\\text{exact}} = -2 k a h_f$ 给出。\n单元中心绝对误差 $E_{\\mathrm{cc}}$ 为：\n$$E_{\\mathrm{cc}} = |F_{\\text{cc}} - F_{\\text{exact}}| = |(-2 k a h_f) - (-2 k a h_f)| = 0$$\n这展示了一个关键特性：对于线性场，在这种对称的非协调界面上的两点通量近似是精确的。由于场的 $y$ 分量（$b$ 项）在上方和下方子界面上产生的离散化误差完美抵消。因此，对于所有测试用例，$E_{\\mathrm{cc}} = 0$。\n\n接下来，我们处理顶点中心量。\n对于朴素的顶点中心格式，不平衡量直接给出：\n$$E_{\\mathrm{vn}} = \\left| -k a h_f \\right| = \\left|k a h_f\\right|$$\n此项代表通过界面中心部分的通量，该部分在通量仅归属于主粗网格顶点而忽略悬挂节点时未被计算。\n\n对于修正的顶点中心格式，问题陈述指出该修正恢复了线性场的正确通量。因此，对于此测试，残差/误差根据定义为零：\n$$E_{\\mathrm{vm}} = 0$$\n\n现在我们将这些通用公式应用于每个测试用例。注意参数 $b=0.7$ 和 $c=-0.2$ 不会出现在最终的误差表达式中。\n\n用例 1：$(h_f, k, a) = (1.0, 1.0, 1.5)$\n- $E_{\\mathrm{cc}} = 0$\n- $E_{\\mathrm{vn}} = |1.0 \\times 1.5 \\times 1.0| = 1.5$\n- $E_{\\mathrm{vm}} = 0$\n三元组：$(0.0, 1.5, 0.0)$\n\n用例 2：$(h_f, k, a) = (0.5, 3.0, -2.0)$\n- $E_{\\mathrm{cc}} = 0$\n- $E_{\\mathrm{vn}} = |3.0 \\times (-2.0) \\times 0.5| = |-3.0| = 3.0$\n- $E_{\\mathrm{vm}} = 0$\n三元组：$(0.0, 3.0, 0.0)$\n\n用例 3：$(h_f, k, a) = (2.0, 0.7, 0.0)$\n- $E_{\\mathrm{cc}} = 0$\n- $E_{\\mathrm{vn}} = |0.7 \\times 0.0 \\times 2.0| = 0.0$\n- $E_{\\mathrm{vm}} = 0$\n三元组：$(0.0, 0.0, 0.0)$\n\n用例 4：$(h_f, k, a) = (10^{-3}, 5.0, 4.0)$\n- $E_{\\mathrm{cc}} = 0$\n- $E_{\\mathrm{vn}} = |5.0 \\times 4.0 \\times 10^{-3}| = |20.0 \\times 10^{-3}| = 0.02$\n- $E_{\\mathrm{vm}} = 0$\n三元组：$(0.0, 0.02, 0.0)$\n\n这些结果将被编译成一个单独的列表作为最终输出。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes error metrics for cell-centered and vertex-centered schemes\n    on a nonconforming grid interface for a steady diffusion problem.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple (hf, k, a).\n    # Parameters b=0.7 and c=-0.2 are constant across tests but do not\n    # affect the final error calculations as shown in the derivation.\n    test_cases = [\n        (1.0, 1.0, 1.5),      # Case 1\n        (0.5, 3.0, -2.0),     # Case 2\n        (2.0, 0.7, 0.0),      # Case 3\n        (1.0e-3, 5.0, 4.0),   # Case 4\n    ]\n\n    results = []\n    for case in test_cases:\n        hf, k, a = case\n\n        # Task A: Cell-centered scheme (FVM)\n        # As derived in the solution, for a linear field u(x,y) = ax + by + c,\n        # the two-point flux approximation on this symmetric nonconforming interface\n        # is exact. The total numerical flux F_cc equals the exact flux F_exact.\n        # F_cc = -2*k*a*hf\n        # F_exact = -2*k*a*hf\n        # Therefore, E_cc = |F_cc - F_exact| = 0\n        E_cc = 0.0\n\n        # Task B: Naive vertex-centered scheme\n        # The imbalance is due to the flux through the unhandled central segment\n        # of the interface of length hf. The flux density is -k * du/dx = -k * a.\n        # The missing flux is (-k * a) * hf.\n        # The absolute imbalance is E_vn = |-k * a * hf|.\n        E_vn = abs(-k * a * hf)\n\n        # Task C: Modified vertex-centered scheme\n        # The problem states that with a hanging node constraint for a linear field,\n        # the method correctly accounts for the flux. The resulting residual or\n        # error is defined to be zero.\n        E_vm = 0.0\n\n        results.extend([E_cc, E_vn, E_vm])\n\n    # Final print statement in the exact required format.\n    # The list is flattened across test cases.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2376143"}]}