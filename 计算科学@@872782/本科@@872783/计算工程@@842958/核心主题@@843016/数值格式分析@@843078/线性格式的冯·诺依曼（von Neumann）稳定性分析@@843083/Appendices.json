{"hands_on_practices": [{"introduction": "一个数值方法的稳定性不仅仅是数学上的巧合，它往往反映了其所求解问题的物理本质。第一个练习将探讨这种联系，我们将同一个简单的时间显式中心差分格式（FTCS）应用于两个截然不同的问题：标准热传导方程和不适定的“反向”热传导方程。通过分析两种情况下的放大因子，您将亲眼看到为何一个适用于前者的格式在后者上会灾难性地失败，从而学习到关于数值方法和物理模型之间相互作用的关键一课。[@problem_id:2450098]", "problem": "考虑一个定义在周期性区域上的一维偏微分方程 (PDE) $u_t=\\pm u_{xx}$，它在均匀网格 $x_j=j\\,\\Delta x$ 和 $t^n=n\\,\\Delta t$ 上离散化，其中 $j$ 和 $n$ 为整数。定义无量纲参数 $r=\\Delta t/\\Delta x^2$。应用于每种符号选择的前向时间中心空间 (FTCS) 格式产生以下两层显式更新：\n- 对于 $u_t=+u_{xx}$：$u_j^{n+1}=u_j^n+r\\left(u_{j+1}^n-2u_j^n+u_{j-1}^n\\right)$。\n- 对于 $u_t=-u_{xx}$：$u_j^{n+1}=u_j^n-r\\left(u_{j+1}^n-2u_j^n+u_{j-1}^n\\right)$。\n\n对于周期性边界条件下的这个线性格式，使用傅里叶模式放大因子的概念，哪个选项正确解释了为何同一个离散模板对于 $u_t=+u_{xx}$ (在 $r$ 的某个范围内) 是稳定的，而对于任何正数 $r$ 的 $u_t=-u_{xx}$ 都是不稳定的？\n\nA. 对于 $u_t=+u_{xx}$，放大因子为 $G(\\theta)=1-4r\\sin^2(\\theta/2)$，因此对于所有的 $\\theta$，当且仅当 $0\\le r\\le 1/2$ 时 $|G(\\theta)|\\le 1$。对于 $u_t=-u_{xx}$，放大因子为 $G(\\theta)=1+4r\\sin^2(\\theta/2)$，当 $r0$ 时，对于任何非零模式，该因子满足 $G(\\theta)1$，因此该格式不稳定。\n\nB. 对于 $u_t=+u_{xx}$，放大因子为 $G(\\theta)=1+4r\\sin^2(\\theta/2)$，因此对于非零模式它超过 $1$ 且不稳定；对于 $u_t=-u_{xx}$，放大因子为 $G(\\theta)=1-4r\\sin^2(\\theta/2)$，因此当 $0\\le r\\le 1/2$ 时是稳定的。\n\nC. 两种符号选择的放大因子相同，但 $u_t=+u_{xx}$ 的局部截断误差小于 $u_t=-u_{xx}$ 的局部截断误差，这解释了前者的稳定性与后者的不稳定性。\n\nD. 该格式对两种符号选择都是无条件稳定的，因为中心空间差分产生纯虚的傅里叶符号，所以对于所有 $r0$ 和所有 $\\theta$，都有 $|G(\\theta)|\\le 1$。", "solution": "对问题陈述进行验证。\n\n**步骤 1：提取已知条件**\n- 偏微分方程 (PDE)：$u_t = +u_{xx}$ 和 $u_t = -u_{xx}$。\n- 区域：一维，周期性。\n- 离散化：均匀网格 $x_j=j\\,\\Delta x$ 和 $t^n=n\\,\\Delta t$，其中 $j$ 和 $n$ 为整数。\n- 无量纲参数：$r=\\Delta t/\\Delta x^2$。\n- 针对 $u_t = +u_{xx}$ 的 FTCS 格式：$u_j^{n+1}=u_j^n+r\\left(u_{j+1}^n-2u_j^n+u_{j-1}^n\\right)$。\n- 针对 $u_t = -u_{xx}$ 的 FTCS 格式：$u_j^{n+1}=u_j^n-r\\left(u_{j+1}^n-2u_j^n+u_{j-1}^n\\right)$。\n- 问题：使用傅里叶模式放大因子解释为什么该格式对于 $u_t = +u_{xx}$ 可以是稳定的，而对于 $u_t = -u_{xx}$ 是不稳定的。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学依据**：该问题涉及前向时间中心空间 (FTCS) 有限差分格式的稳定性分析，这是偏微分方程数值分析中的一个基本课题。所涉及的偏微分方程是热传导方程 ($u_t = u_{xx}$)，它将信息随时间向前传播；以及反向热传导方程 ($u_t = -u_{xx}$)，众所周知它对于初值问题是不适定的。分析数值格式如何反映其所对应的偏微分方程的适定性是一项关键且标准的科学探究。\n- **适定性**：该问题提供了执行冯·诺依曼稳定性分析所需的所有信息。问题很具体，要求基于放大因子进行解释，并且可以推导出唯一的技术上正确的答案。\n- **客观性**：语言是客观和技术性的，没有主观或含糊的术语。\n\n**步骤 3：结论与行动**\n问题陈述有效。它在科学上是合理的、适定的、客观的且自洽的。我将继续进行求解。\n\n在周期性区域上具有常系数的线性有限差分格式的稳定性由冯·诺依曼稳定性分析确定。我们考虑数值解的单个傅里葉模式，其形式为 $u_j^n = \\hat{u}^n(k) e^{ikx_j}$，其中 $k$ 是波数。代入 $x_j = j \\Delta x$，这变为 $u_j^n = \\hat{u}^n e^{ij\\theta}$，其中 $\\theta = k\\Delta x$ 是每个网格单元的无量纲波数或相位角。模式振幅的演化由 $\\hat{u}^{n+1} = G(\\theta)\\hat{u}^n$ 给出，其中 $G(\\theta)$ 是放大因子。对于一个稳定的格式，必须对所有 $\\theta \\in [-\\pi, \\pi]$ 的值都满足 $|G(\\theta)| \\le 1$。\n\n**情况 1：热传导方程，$u_t = +u_{xx}$**\n离散格式为 $u_j^{n+1} = u_j^n + r(u_{j+1}^n - 2u_j^n + u_{j-1}^n)$。\n将傅里叶模式 $u_j^n = \\hat{u}^n e^{ij\\theta}$ 代入格式中：\n$G(\\theta) \\hat{u}^n e^{ij\\theta} = \\hat{u}^n e^{ij\\theta} + r \\left( \\hat{u}^n e^{i(j+1)\\theta} - 2\\hat{u}^n e^{ij\\theta} + \\hat{u}^n e^{i(j-1)\\theta} \\right)$。\n两边同除以公共的非零因子 $\\hat{u}^n e^{ij\\theta}$，得到放大因子：\n$G(\\theta) = 1 + r \\left( e^{i\\theta} - 2 + e^{-i\\theta} \\right)$。\n使用恒等式 $e^{i\\theta} + e^{-i\\theta} = 2\\cos\\theta$，可以简化为：\n$G(\\theta) = 1 + r(2\\cos\\theta - 2) = 1 + 2r(\\cos\\theta - 1)$。\n使用半角恒等式 $\\cos\\theta - 1 = -2\\sin^2(\\theta/2)$：\n$G(\\theta) = 1 - 4r\\sin^2(\\theta/2)$。\n\n为保证稳定性，我们需要 $|G(\\theta)| \\le 1$。\n由于 $r  0$ 且 $\\sin^2(\\theta/2) \\ge 0$，项 $4r\\sin^2(\\theta/2)$ 是非负的。\n因此，$G(\\theta) = 1 - (\\text{一个非负量}) \\le 1$。这个条件总是满足的。\n稳定性要求的第二部分是 $G(\\theta) \\ge -1$：\n$1 - 4r\\sin^2(\\theta/2) \\ge -1$\n$2 \\ge 4r\\sin^2(\\theta/2)$\n$r\\sin^2(\\theta/2) \\le 1/2$。\n这个不等式必须对所有 $\\theta$ 成立。$\\sin^2(\\theta/2)$ 的最大值是 $1$，这发生在振荡最剧烈的模式 $\\theta = \\pm \\pi$ 处。因此，条件变为：\n$r \\le 1/2$。\n该格式对于 $0  r \\le 1/2$ 是条件稳定的。\n\n**情况 2：反向热传导方程，$u_t = -u_{xx}$**\n离散格式为 $u_j^{n+1} = u_j^n - r(u_{j+1}^n - 2u_j^n + u_{j-1}^n)$。\n按照相同的步骤，我们代入傅里叶模式：\n$G(\\theta) \\hat{u}^n e^{ij\\theta} = \\hat{u}^n e^{ij\\theta} - r \\left( \\hat{u}^n e^{i(j+1)\\theta} - 2\\hat{u}^n e^{ij\\theta} + \\hat{u}^n e^{i(j-1)\\theta} \\right)$。\n两边同除以 $\\hat{u}^n e^{ij\\theta}$：\n$G(\\theta) = 1 - r \\left( e^{i\\theta} - 2 + e^{-i\\theta} \\right)$\n$G(\\theta) = 1 - 2r(\\cos\\theta - 1)$\n$G(\\theta) = 1 + 4r\\sin^2(\\theta/2)$。\n\n为保证稳定性，我们需要 $|G(\\theta)| \\le 1$。\n给定 $r  0$。对于任何非零模式，即 $\\theta \\ne 0$，我们有 $\\sin^2(\\theta/2)  0$。\n这意味着 $4r\\sin^2(\\theta/2)  0$。\n因此，$G(\\theta) = 1 + (\\text{一个正量})  1$。\n由于对于任何空间变化的模式都有 $|G(\\theta)|  1$，任何小的扰动都会随时间呈指数级放大。该格式对于任何 $r  0$ 都是无条件不稳定的。\n这正确地反映了连续反向热传导方程的不适定性。\n\n现在，我们评估所提供的选项。\n\n**A.** 对于 $u_t=+u_{xx}$，放大因子为 $G(\\theta)=1-4r\\sin^2(\\theta/2)$，因此对于所有的 $\\theta$，当且仅当 $0\\le r\\le 1/2$ 时 $|G(\\theta)|\\le 1$。对于 $u_t=-u_{xx}$，放大因子为 $G(\\theta)=1+4r\\sin^2(\\theta/2)$，当 $r0$ 时，对于任何非零模式，该因子满足 $G(\\theta)1$，因此该格式不稳定。\n此陈述与上面进行的推导完全匹配。两个放大因子的表达式都是正确的，并且得出的稳定性条件也是正确的。\n**结论：正确。**\n\n**B.** 对于 $u_t=+u_{xx}$，放大因子为 $G(\\theta)=1+4r\\sin^2(\\theta/2)$，因此对于非零模式它超过 $1$ 且不稳定；对于 $u_t=-u_{xx}$，放大因子为 $G(\\theta)=1-4r\\sin^2(\\theta/2)$，因此当 $0\\le r\\le 1/2$ 时是稳定的。\n此选项错误地交换了两个偏微分方程的放大因子和稳定性结论。热传导方程 ($u_t=+u_{xx}$) 被赋予了反向热传导方程的放大因子，反之亦然。\n**结论：不正确。**\n\n**C.** 两种符号选择的放大因子相同，但 $u_t=+u_{xx}$ 的局部截断误差小于 $u_t=-u_{xx}$ 的局部截断误差，这解释了前者的稳定性与后者的不稳定性。\n如推导所示，$u_t=+u_{xx}$ 的放大因子是 $1-4r\\sin^2(\\theta/2)$ 而 $u_t=-u_{xx}$ 的放大因子是 $1+4r\\sin^2(\\theta/2)$。它们不相同。该选项的前提在事实上是错误的。稳定性是由放大因子决定的，而不是通过比较截断误差。\n**结论：不正确。**\n\n**D.** 该格式对两种符号选择都是无条件稳定的，因为中心空间差分产生纯虚的傅里叶符号，所以对于所有 $r0$ 和所有 $\\theta$，都有 $|G(\\theta)|\\le 1$。\n此选项提出了几个错误的论断。首先，该格式并非对两种情况都无条件稳定；一个是条件稳定的，另一个是无条件不稳定的。其次，二阶中心差分算子 $\\frac{1}{\\Delta x^2}(u_{j+1}-2u_j+u_{j-1})$ 的傅里叶符号是 $\\frac{-4}{\\Delta x^2}\\sin^2(\\theta/2)$，它是纯实数且非正，而不是纯虚数。纯虚数符号产生于对一阶导数的中心差分近似。\n**结论：不正确。**", "answer": "$$\\boxed{A}$$", "id": "2450098"}, {"introduction": "一些格式具有固定的稳定性属性，而另一些则提供了更大的灵活性。本练习将介绍功能强大的$\\theta$-格式，这是一个通用框架，它包含了显式前向欧拉法和隐式后向欧拉法作为特例。您的任务是确定加权参数$\\theta$如何影响热传导方程格式的稳定性，并找出实现无条件稳定性的条件。这项实践对于理解如何设计和选择在各种仿真参数下都稳健高效的数值方法至关重要。[@problem_id:2450103]", "problem": "考虑周期性域上的热传导方程 $u_{t}=\\kappa u_{xx}$，其空间网格间距为 $\\Delta x$，时间步长为 $\\Delta t$，其中 $\\kappa0$ 是热扩散系数。定义中心二阶差分算子 $\\delta_{xx}u_{j}^{n}=\\left(u_{j+1}^{n}-2u_{j}^{n}+u_{j-1}^{n}\\right)/\\Delta x^{2}$，并考虑由下式给出的$\\theta$-格式（前向欧拉法和后向欧拉法的加权平均）：\n$$(u_{j}^{n+1}-u_{j}^{n})/\\Delta t=\\kappa\\left[\\theta\\,\\delta_{xx}u_{j}^{n+1}+(1-\\theta)\\,\\delta_{xx}u_{j}^{n}\\right],$$\n其中权重参数为 $\\theta\\in\\mathbb{R}$。使用冯·诺依曼稳定性分析（傅里叶模态分析），采用模态 $u_{j}^{n}=\\hat{u}\\,G^{n}\\exp(i j \\xi)$，其中 $\\xi\\in[-\\pi,\\pi]$ 是以弧度为单位的无量纲波数，且 $i^{2}=-1$。请推导放大因子 $G(\\xi,\\theta,\\kappa,\\Delta t,\\Delta x)$，并确定对于哪些 $\\theta$ 值，该格式是无条件稳定的，即对于所有 $\\xi\\in[-\\pi,\\pi]$ 和所有比率 $r=\\kappa\\,\\Delta t/\\Delta x^{2}\\ge 0$ 都满足 $|G|\\leq 1$。\n\n将保证无条件稳定性的 $\\theta$ 的最小值作为你的最终答案。将答案表示为单个最简有理数。最终答案无需四舍五入，也无需单位。", "solution": "问题陈述是连贯的、有科学依据的且适定的。我们开始进行推导。\n\n给定的热传导方程的$\\theta$-格式为：\n$$ \\frac{u_{j}^{n+1}-u_{j}^{n}}{\\Delta t}=\\kappa\\left[\\theta\\,\\delta_{xx}u_{j}^{n+1}+(1-\\theta)\\,\\delta_{xx}u_{j}^{n}\\right] $$\n其中 $\\delta_{xx}$ 是中心二阶差分算子。代入 $\\delta_{xx}$ 的定义得到：\n$$ \\frac{u_{j}^{n+1}-u_{j}^{n}}{\\Delta t} = \\frac{\\kappa}{\\Delta x^{2}} \\left[ \\theta \\left( u_{j+1}^{n+1} - 2u_{j}^{n+1} + u_{j-1}^{n+1} \\right) + (1-\\theta) \\left( u_{j+1}^{n} - 2u_{j}^{n} + u_{j-1}^{n} \\right) \\right] $$\n为了进行冯·诺依曼稳定性分析，我们引入傅里叶模态试探解 $u_{j}^{n} = G^{n} \\exp(i j \\xi)$，其中 $G$ 是放大因子，$n$ 是时间索引，$j$ 是空间索引，$\\xi$ 是无量纲波数，且 $i^{2}=-1$。我们省略了常数振幅 $\\hat{u}$，因为它会被消去。\n\n将此试探解代入格式中，涉及以下关系式：\n$u_{j}^{n+1} = G u_{j}^{n}$\n$u_{j\\pm 1}^{n} = \\exp(\\pm i \\xi) u_{j}^{n}$\n$u_{j\\pm 1}^{n+1} = G \\exp(\\pm i \\xi) u_{j}^{n}$\n\n将这些代入离散方程中：\n$$ \\frac{G u_{j}^{n} - u_{j}^{n}}{\\Delta t} = \\frac{\\kappa}{\\Delta x^{2}} \\left[ \\theta G \\left( e^{i\\xi} - 2 + e^{-i\\xi} \\right)u_{j}^{n} + (1-\\theta) \\left( e^{i\\xi} - 2 + e^{-i\\xi} \\right)u_{j}^{n} \\right] $$\n假设存在非平凡解，我们可以两边同除以 $u_{j}^{n}$：\n$$ \\frac{G - 1}{\\Delta t} = \\frac{\\kappa}{\\Delta x^{2}} \\left[ \\theta G ( e^{i\\xi} + e^{-i\\xi} - 2 ) + (1-\\theta) ( e^{i\\xi} + e^{-i\\xi} - 2 ) \\right] $$\n使用恒等式 $e^{i\\xi} + e^{-i\\xi} = 2\\cos(\\xi)$，括号中的项变为 $2\\cos(\\xi) - 2 = -2(1-\\cos(\\xi))$。再使用半角恒等式 $1-\\cos(\\xi) = 2\\sin^{2}(\\xi/2)$，此项等于 $-4\\sin^{2}(\\xi/2)$。\n关于 $G$ 的方程变为：\n$$ \\frac{G-1}{\\Delta t} = \\frac{\\kappa}{\\Delta x^{2}} \\left( -4\\sin^{2}(\\xi/2) \\right) \\left[ \\theta G + (1-\\theta) \\right] $$\n令 $r = \\kappa \\Delta t / \\Delta x^{2}$ 为扩散数。\n$$ G - 1 = -4r \\sin^{2}(\\xi/2) \\left[ \\theta G + 1 - \\theta \\right] $$\n我们现在必须解出放大因子 $G$：\n$$ G - 1 = -4r\\theta G \\sin^{2}(\\xi/2) - 4r(1-\\theta)\\sin^{2}(\\xi/2) $$\n$$ G \\left( 1 + 4r\\theta \\sin^{2}(\\xi/2) \\right) = 1 - 4r(1-\\theta)\\sin^{2}(\\xi/2) $$\n$$ G = \\frac{1 - 4r(1-\\theta)\\sin^{2}(\\xi/2)}{1 + 4r\\theta\\sin^{2}(\\xi/2)} $$\n为实现无条件稳定，放大因子的模必须对所有 $r \\ge 0$ 和所有波数 $\\xi \\in [-\\pi, \\pi]$ 满足 $|G| \\le 1$。令 $S = 4r\\sin^{2}(\\xi/2)$。由于 $r \\ge 0$ 且 $\\sin^{2}(\\xi/2) \\ge 0$，$S$ 的取值范围是 $[0, \\infty)$。$G$ 的表达式变为：\n$$ G = \\frac{1 - (1-\\theta)S}{1 + \\theta S} $$\n稳定性条件为 $|G| \\leq 1$，这等价于：\n$$ |1 - (1-\\theta)S| \\leq |1 + \\theta S| $$\n我们必须对所有 $S \\ge 0$ 分析此不等式。注意，如果分母 $1 + \\theta S$ 对某个 $S  0$ 变为零，则该格式是无定义的且不稳定的。这在 $\\theta  0$ 时发生。如果 $\\theta  0$，令 $\\theta = -\\beta$ 其中 $\\beta > 0$。分母为 $1 - \\beta S$。当 $S = 1/\\beta$ 时，分母为零。因此，为了无条件稳定，我们必须有 $\\theta \\ge 0$。\n\n假设 $\\theta \\ge 0$，分母 $1 + \\theta S$ 恒为正（当 $S=0$ 时为 $1$，当 $S>0$ 时大于 $1$）。因此我们可以两边同乘以它：\n$$ - (1 + \\theta S) \\leq 1 - (1-\\theta)S \\leq 1 + \\theta S $$\n这个复合不等式包含两个部分。\n\n首先，右侧的不等式：\n$$ 1 - (1-\\theta)S \\leq 1 + \\theta S $$\n$$ -(1-\\theta)S \\leq \\theta S $$\n$$ -S + \\theta S \\leq \\theta S $$\n$$ -S \\leq 0 $$\n由于我们定义了 $S = 4r\\sin^{2}(\\xi/2) \\ge 0$，这个不等式对任何 $\\theta$ 都恒成立。\n\n其次，左侧的不等式：\n$$ -(1 + \\theta S) \\leq 1 - (1-\\theta)S $$\n$$ -1 - \\theta S \\leq 1 - S + \\theta S $$\n$$ 0 \\leq 2 - S + 2\\theta S $$\n$$ 0 \\leq 2 + (2\\theta - 1)S $$\n这个不等式必须对所有 $S \\in [0, \\infty)$ 成立。\n如果 $S$ 的系数是非负的，即 $2\\theta - 1 \\ge 0$，那么对于所有 $S \\ge 0$，项 $(2\\theta - 1)S$ 也是非负的。不等式 $2 + (\\text{非负量}) \\ge 0$ 恒为真。因此，如果 $2\\theta - 1 \\ge 0$，即 $\\theta \\ge 1/2$，则该格式是无条件稳定的。\n\n如果 $S$ 的系数是负的，即 $2\\theta - 1  0$（或 $\\theta  1/2$），不等式变为 $ (1-2\\theta)S \\le 2 $，或 $S \\le \\frac{2}{1-2\\theta}$。这对 $S = 4r\\sin^{2}(\\xi/2)$ 施加了一个条件，意味着稳定性是有条件的，取决于 $r$。这违反了无条件稳定性的要求。\n\n因此，无条件稳定性的条件是 $\\theta \\ge 1/2$。题目要求的是保证无条件稳定性的 $\\theta$ 的最小值。这个最小值恰好是当 $S$ 的系数变为非负时的值。\n\n$\\theta$ 的最小值为 $1/2$。", "answer": "$$\n\\boxed{\\frac{1}{2}}\n$$", "id": "2450103"}, {"introduction": "在现代计算科学中，空间和时间离散化通常使用“线方法”（Method of Lines）进行分开分析。最后的这项练习将让您体验这种前沿技术，要求您确定当中心差分格式与四阶龙格-库塔时间积分器耦合时，求解对流方程的稳定性极限。您将学习如何分析空间算子的特征值，并确保它们落在时间步进方法的稳定域内，这是开发和使用复杂仿真软件的一项关键技能。[@problem_id:2450031]", "problem": "考虑在一长度为 $L$ 的周期性域上定义的一维线性平流方程 $u_{t} + c\\,u_{x} = 0$，该方程在一个均匀网格 $x_{j} = j\\,\\Delta x$（其中 $j \\in \\{0,1,\\dots,N-1\\}$ 且 $\\Delta x = L/N$）上进行离散化。空间导数 $u_{x}$ 通过二阶中心有限差分 $(u_{j+1} - u_{j-1})/(2\\,\\Delta x)$ 进行近似，得到如下半离散系统：\n$$\n\\frac{d u_{j}}{d t} = -\\,c\\,\\frac{u_{j+1} - u_{j-1}}{2\\,\\Delta x}.\n$$\n所得半离散系统 $\\frac{d\\mathbf{u}}{dt} = \\mathbf{A}\\,\\mathbf{u}$ 的时间积分采用经典的四阶龙格-库塔方法，并使用恒定的时间步长 $\\Delta t$。定义库朗数 $\\sigma = |c|\\,\\Delta t / \\Delta x$。\n\n假设周期性边界条件和线性条件成立，因此 von Neumann 分析适用，请确定使全离散方法对所有空间傅里叶模态都线性稳定的最大库朗数 $\\sigma$ 值。请用精确的解析表达式给出最终答案。无需四舍五入，也无需报告单位。", "solution": "所述问题是有效的。这是一个在偏微分方程数值分析领域中提法恰当、有科学依据的问题。任务是通过将空间离散化的 von Neumann 分析与时间积分方法的稳定区域相结合，来确定全离散格式的稳定性极限。\n\n该过程包括三个主要步骤。首先，我们分析空间离散化以找到算子的谱。其次，我们确定四阶龙格-库塔方法在虚轴上的稳定区域。最后，我们结合这些结果来找到最大允许的库朗数。\n\n步骤 $1$：半离散系统分析。\n半离散系统由下式给出：\n$$\n\\frac{d u_{j}}{d t} = -c\\,\\frac{u_{j+1} - u_{j-1}}{2\\,\\Delta x}.\n$$\n我们应用 von Neumann ansatz，考虑一个形式为 $u_j(t) = \\hat{u}_k(t) \\exp(i k x_j)$ 的单一傅里叶模态解，其中 $k$ 是波数，$x_j = j \\Delta x$。将此代入方程，我们得到：\n$$\n\\frac{d \\hat{u}_k}{d t} \\exp(i k j \\Delta x) = -c\\,\\frac{\\hat{u}_k \\exp(i k (j+1) \\Delta x) - \\hat{u}_k \\exp(i k (j-1) \\Delta x)}{2\\,\\Delta x}.\n$$\n除以公因子 $\\hat{u}_k \\exp(i k j \\Delta x)$，得到一个关于振幅 $\\hat{u}_k(t)$ 的常微分方程：\n$$\n\\frac{d \\hat{u}_k}{d t} = - \\frac{c}{2\\,\\Delta x} (\\exp(i k \\Delta x) - \\exp(-i k \\Delta x)) \\hat{u}_k.\n$$\n使用恒等式 $\\sin(\\theta) = \\frac{\\exp(i\\theta) - \\exp(-i\\theta)}{2i}$，我们简化该表达式：\n$$\n\\frac{d \\hat{u}_k}{d t} = - \\frac{c}{2\\,\\Delta x} (2i \\sin(k \\Delta x)) \\hat{u}_k = \\left( -i \\frac{c}{\\Delta x} \\sin(k \\Delta x) \\right) \\hat{u}_k.\n$$\n这是一个形如 $\\frac{d\\hat{u}_k}{dt} = \\lambda_k \\hat{u}_k$ 的常微分方程，其中 $\\lambda_k$ 是空间离散化算子的特征值。因此，\n$$\n\\lambda_k = -i \\frac{c}{\\Delta x} \\sin(k \\Delta x).\n$$\n对于时间积分，相关量是 $z_k = \\lambda_k \\Delta t$：\n$$\nz_k = \\lambda_k \\Delta t = -i \\frac{c \\Delta t}{\\Delta x} \\sin(k \\Delta x).\n$$\n使用库朗数的定义 $\\sigma = |c|\\,\\Delta t / \\Delta x$，并注意到 $c$ 的符号可以被 $\\sin(k \\Delta x)$ 在其整个范围内的符号所吸收（因为 $\\sin(\\theta)=-\\sin(-\\theta)$），我们可以将所有可能的 $z_k$ 集合写为由其最大模确定。项 $k\\Delta x$ 是无量纲波数，其有效范围覆盖区间 $[-\\pi, \\pi]$。因此，$\\sin(k\\Delta x)$ 的取值范围是 $-1$ 到 $1$。所有可能的 $z_k$ 值的集合是虚轴上从 $-i\\sigma$ 到 $i\\sigma$ 的线段。\n\n步骤 $2$：四阶龙格-库塔方法的稳定性。\n将经典的四阶龙格-库塔（RK$4$）方法应用于测试方程 $y' = \\lambda y$，得到递推关系 $y^{n+1} = g(\\lambda \\Delta t) y^n$，其中 $g(z)$ 是稳定函数（或放大因子）。对于 RK$4$，该函数由 $\\exp(z)$ 的泰勒级数的前五项给出：\n$$\ng(z) = 1 + z + \\frac{z^2}{2!} + \\frac{z^3}{3!} + \\frac{z^4}{4!} = 1 + z + \\frac{z^2}{2} + \\frac{z^3}{6} + \\frac{z^4}{24}.\n$$\n如果放大因子的模小于或等于 1，即 $|g(z)| \\le 1$，则该格式是稳定的。从步骤 1 可知，对于我们的问题，$z$ 是纯虚数，因此我们设 $z = iy$，其中 $y$ 是一个实数。我们需要找到使得 $|g(iy)| \\le 1$ 成立的 $y$ 的范围。\n将 $z=iy$ 代入 $g(z)$：\n$$\ng(iy) = 1 + iy + \\frac{(iy)^2}{2} + \\frac{(iy)^3}{6} + \\frac{(iy)^4}{24} = 1 + iy - \\frac{y^2}{2} - i\\frac{y^3}{6} + \\frac{y^4}{24}.\n$$\n分离实部和虚部：\n$$\ng(iy) = \\left(1 - \\frac{y^2}{2} + \\frac{y^4}{24}\\right) + i \\left(y - \\frac{y^3}{6}\\right).\n$$\n稳定性条件是 $|g(iy)|^2 \\le 1^2 = 1$：\n$$\n\\left(1 - \\frac{y^2}{2} + \\frac{y^4}{24}\\right)^2 + \\left(y - \\frac{y^3}{6}\\right)^2 \\le 1.\n$$\n展开各项并化简：\n$$\n\\left(1 - y^2 + \\frac{y^4}{3} + \\frac{y^8}{576}\\right) - \\frac{y^6}{72} + \\left(y^2 - \\frac{y^4}{3} + \\frac{y^6}{36}\\right) \\le 1.\n$$\n$$\n1 + \\left(\\frac{1}{36} - \\frac{1}{72}\\right)y^6 + \\frac{y^8}{576} \\le 1.\n$$\n$$\n1 - \\frac{y^6}{72} + \\frac{y^8}{576} \\le 1.\n$$\n这可以简化为：\n$$\n\\frac{y^8}{576} - \\frac{y^6}{72} \\le 0.\n$$\n对于 $y \\ne 0$，我们可以除以 $y^6$（它是一个正数）：\n$$\n\\frac{y^2}{576} - \\frac{1}{72} \\le 0 \\implies \\frac{y^2}{576} \\le \\frac{1}{72}.\n$$\n解出 $y^2$：\n$$\ny^2 \\le \\frac{576}{72} = 8.\n$$\n这意味着 $|y| \\le \\sqrt{8} = 2\\sqrt{2}$。因此，RK$4$ 方法沿虚轴的稳定区间是 $[-i 2\\sqrt{2}, i 2\\sqrt{2}]$。\n\n步骤 $3$：确定库朗数的稳定性极限。\n为了使全离散格式对所有傅里叶模态都稳定，值集合 $\\{z_k = \\lambda_k \\Delta t\\}$ 必须完全位于 RK$4$ 方法的稳定区域内。如步骤 1 所确定的，这个集合是虚轴上的线段 $[-i\\sigma, i\\sigma]$。\n因此，稳定性条件是：\n$$\n[-i\\sigma, i\\sigma] \\subseteq [-i 2\\sqrt{2}, i 2\\sqrt{2}].\n$$\n这要求 $\\sigma \\le 2\\sqrt{2}$。使该方法稳定的最大库朗数 $\\sigma$ 值是此不等式的上界。", "answer": "$$\n\\boxed{2\\sqrt{2}}\n$$", "id": "2450031"}]}