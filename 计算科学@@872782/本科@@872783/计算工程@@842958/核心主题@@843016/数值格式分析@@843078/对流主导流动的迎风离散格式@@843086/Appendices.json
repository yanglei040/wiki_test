{"hands_on_practices": [{"introduction": "在使用显式迎风格式时，一个至关重要的问题是：在模拟变得不稳定并“爆炸”之前，我们能取多大的时间步长？本练习将通过冯·诺依曼稳定性分析（von Neumann stability analysis）这一基本工具来回答此问题。通过分析一个对流-反应问题 [@problem_id:2449011]，您将发现最大稳定时间步长不仅取决于对流项（经典的 CFL 条件），还与其他项（如这里的反应汇项）的处理方式有关，从而对数值稳定性建立更全面的认识。", "problem": "考虑由偏微分方程 $$u_t + a\\,u_x = -\\epsilon\\,u,$$ 定义的一维线性对流-反应初值问题，其中 $u=u(x,t)$ 是无量纲量，$a$ 是一个常数平流速度，$\\epsilon \\ge 0$ 是一个常数反应（汇）系数。假设一个空间间距为 $\\Delta x$ 的均匀空间网格，和一个时间步长为 $\\Delta t$ 的显式前向欧拉时间离散格式。对流项采用根据 $a$ 的符号选择的一阶迎风空间离散格式（如果 $a \\ge 0$ 则为左侧迎风，如果 $a  0$ 则为右侧迎风），并显式处理汇项。所有量均为无量纲，因此不需要物理单位。\n\n您的任务是：\n- 从守恒律的解释、常微分方程的前向欧拉法定义以及空间平流的一阶迎风有限差分定义出发，推导网格点索引为 $i$、时间层级为 $n$ 的网格值 $u_i^n$ 的单步更新公式。然后，通过代入单模 ansatz $u_i^n = G^n \\exp(\\mathrm{i} k x_i)$，进行傅里叶（冯·诺依曼）稳定性分析，并推导放大因子 $G(k)$ 作为波数 $k$ 的函数。\n- 根据放大因子，确定线性稳定的充分必要条件，即 $\\max_k |G(k)| \\le 1$，并用无量纲参数 $r = \\epsilon\\,\\Delta t$ 和 $\\sigma = |a|\\,\\Delta t / \\Delta x$ 来表示。证明极端波数 $k = 0$ 和 $k = \\pi/\\Delta x$ 控制着边界，并得到最大稳定时间步长 $\\Delta t_{\\max}$ 作为 $a$、$\\epsilon$ 和 $\\Delta x$ 的函数的显式公式。\n- 定性解释分布汇（通过 $\\epsilon$）如何与迎风格式相互作用，从而改变允许的 Courant–Friedrichs–Lewy (CFL) 条件。\n\n程序规范：\n- 实现一个程序，对于下面列出的每个测试用例，计算您通过冯·诺依曼分析得出的、针对所述时间上显式前向欧拉和空间上一阶迎风格式的最大线性稳定时间步长 $\\Delta t_{\\max}$。\n- 使用以下参数三元组 $(a,\\epsilon,\\Delta x)$ 的测试套件：\n    - 测试 1：$(a,\\epsilon,\\Delta x) = (1.0, 0.5, 0.01)$。\n    - 测试 2：$(a,\\epsilon,\\Delta x) = (2.0, 0.0, 0.05)$。\n    - 测试 3：$(a,\\epsilon,\\Delta x) = (0.0, 4.0, 0.01)$。\n    - 测试 4：$(a,\\epsilon,\\Delta x) = (-3.0, 1.0, 0.02)$。\n    - 测试 5：$(a,\\epsilon,\\Delta x) = (0.75, 1.5, 0.10)$。\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，“[0.1, 0.2, 0.3]”）。输出列表必须按顺序包含测试 1 到 5 的五个 $\\Delta t_{\\max}$ 浮点数值。\n\n答案类型：\n- 每个测试用例的结果必须是浮点数。将五个结果按上述规定汇总为单个列表，打印在单行上。", "solution": "在尝试任何解决方案之前，需对问题陈述进行验证。\n\n### 步骤 1：提取给定信息\n- **偏微分方程 (PDE)**：$u_t + a\\,u_x = -\\epsilon\\,u$\n- **变量与常数**：$u=u(x,t)$ 是无量纲因变量，$a$ 是常数平流速度，$\\epsilon \\ge 0$ 是常数反应（汇）系数。\n- **离散化参数**：$\\Delta x$ 是均匀空间网格间距，$\\Delta t$ 是时间步长。\n- **数值格式**：\n    - **时间积分**：显式前向欧拉法。\n    - **空间离散**：对流项 $a\\,u_x$ 采用一阶迎风格式。迎风方向取决于 $a$ 的符号。\n    - **源项处理**：汇项 $-\\epsilon\\,u$ 采用显式处理。\n- **分析任务**：进行冯·诺依曼稳定性分析，求出放大因子 $G(k)$ 和稳定性条件 $\\max_k |G(k)| \\le 1$。\n- **推导任务**：根据稳定性条件，推导最大稳定时间步长 $\\Delta t_{\\max}$ 作为 $a$、$\\epsilon$ 和 $\\Delta x$ 的函数。\n- **定性任务**：解释汇项和迎风离散格式对稳定性条件的相互作用。\n\n### 步骤 2：使用提取的给定信息进行验证\n- **科学依据**：该问题基于一维线性对流-反应方程，这是输运现象中的一个基本模型。所指定的数值方法（前向欧拉法、一阶迎风法）和分析技术（冯·诺依曼稳定性分析）是计算工程和数值分析中的标准且严格定义的主题。该问题在科学和数学上是合理的。\n- **适定的**：问题陈述清晰。PDE、数值格式和目标都得到了明确的定义。其结构能够导出一个唯一且有意义的解。\n- **客观的**：问题以精确、客观的数学语言陈述。它不含主观论断或非科学内容。\n\n### 步骤 3：结论与行动\n该问题有效。这是一个关于偏微分方程数值方法的标准、适定的问题。将提供完整的解答。\n\n### 推导与分析\n\n控制偏微分方程为：\n$$\nu_t + a\\,u_x = -\\epsilon\\,u\n$$\n对于网格点 $i$，这可以重排为一个关于时间的常微分方程 (ODE) 的半离散形式：\n$$\n\\frac{d u_i}{d t} = -a (u_x)_i - \\epsilon u_i\n$$\n应用显式前向欧拉法进行时间积分，我们得到：\n$$\n\\frac{u_i^{n+1} - u_i^n}{\\Delta t} = -a (u_x)_i^n - \\epsilon u_i^n\n$$\n其中上标 $n$ 表示时间层级 $t^n = n\\,\\Delta t$。单步更新公式为：\n$$\nu_i^{n+1} = u_i^n - a\\,\\Delta t\\,(u_x)_i^n - \\epsilon\\,\\Delta t\\,u_i^n\n$$\n接下来，我们使用一阶迎风格式对空间导数 $(u_x)_i^n$ 进行离散化，这取决于平流速度 $a$ 的符号。\n\n**情况 1：平流速度 $a \\ge 0$**\n迎风方向是向左（逆流），所以我们使用后向差分：\n$$\n(u_x)_i^n \\approx \\frac{u_i^n - u_{i-1}^n}{\\Delta x}\n$$\n将此代入更新公式，得到：\n$$\nu_i^{n+1} = u_i^n - a\\,\\Delta t\\,\\left(\\frac{u_i^n - u_{i-1}^n}{\\Delta x}\\right) - \\epsilon\\,\\Delta t\\,u_i^n\n$$\n我们定义无量纲参数：库朗数 $\\sigma = \\frac{|a|\\,\\Delta t}{\\Delta x}$ 和反应数 $r = \\epsilon\\,\\Delta t$。由于 $a \\ge 0$，所以 $|a|=a$。方程变为：\n$$\nu_i^{n+1} = u_i^n - \\sigma(u_i^n - u_{i-1}^n) - r\\,u_i^n = (1 - \\sigma - r)u_i^n + \\sigma u_{i-1}^n\n$$\n\n**情况 2：平流速度 $a  0$**\n迎风方向是向右，所以我们使用前向差分：\n$$\n(u_x)_i^n \\approx \\frac{u_{i+1}^n - u_i^n}{\\Delta x}\n$$\n将此代入更新公式：\n$$\nu_i^{n+1} = u_i^n - a\\,\\Delta t\\,\\left(\\frac{u_{i+1}^n - u_i^n}{\\Delta x}\\right) - \\epsilon\\,\\Delta t\\,u_i^n\n$$\n由于 $\\sigma = \\frac{|a|\\,\\Delta t}{\\Delta x} = \\frac{-a\\,\\Delta t}{\\Delta x}$，我们有 $a\\,\\Delta t = -\\sigma\\,\\Delta x$。方程变为：\n$$\nu_i^{n+1} = u_i^n - (-\\sigma\\,\\Delta x)\\,\\left(\\frac{u_{i+1}^n - u_i^n}{\\Delta x}\\right) - r\\,u_i^n = u_i^n + \\sigma(u_{i+1}^n - u_i^n) - r\\,u_i^n\n$$\n$$\nu_i^{n+1} = (1 - \\sigma - r)u_i^n + \\sigma u_{i+1}^n\n$$\n\n**傅里叶（冯·诺依曼）稳定性分析**\n我们假设一个形式为 $u_i^n = G^n e^{\\mathrm{i} k x_i}$ 的单傅里叶模解，其中 $x_i = i\\,\\Delta x$，$k$ 是波数，$\\mathrm{i} = \\sqrt{-1}$，$G(k)$ 是每个时间步长的复放大因子。\n\n对于 $a \\ge 0$：\n$$\nG^{n+1} e^{\\mathrm{i} k i \\Delta x} = (1 - \\sigma - r)G^n e^{\\mathrm{i} k i \\Delta x} + \\sigma G^n e^{\\mathrm{i} k (i-1) \\Delta x}\n$$\n两边同除以 $G^n e^{\\mathrm{i} k i \\Delta x}$，得到放大因子 $G$：\n$$\nG = (1 - \\sigma - r) + \\sigma e^{-\\mathrm{i} k \\Delta x}\n$$\n对于 $a  0$：\n$$\nG^{n+1} e^{\\mathrm{i} k i \\Delta x} = (1 - \\sigma - r)G^n e^{\\mathrm{i} k i \\Delta x} + \\sigma G^n e^{\\mathrm{i} k (i+1) \\Delta x}\n$$\n两边同除以 $G^n e^{\\mathrm{i} k i \\Delta x}$，得到：\n$$\nG = (1 - \\sigma - r) + \\sigma e^{\\mathrm{i} k \\Delta x}\n$$\n令 $\\theta = k\\,\\Delta x$ 为无量纲波数。$G$ 的模的平方决定了稳定性。对于两种情况， $|G|^2$ 具有相同的形式：\n$$\n|G(\\theta)|^2 = |(1 - \\sigma - r) + \\sigma(\\cos\\theta \\mp \\mathrm{i}\\sin\\theta)|^2 = \\left( (1 - \\sigma - r) + \\sigma\\cos\\theta \\right)^2 + (\\mp\\sigma\\sin\\theta)^2\n$$\n$$\n|G(\\theta)|^2 = (1 - \\sigma - r)^2 + 2\\sigma(1 - \\sigma - r)\\cos\\theta + \\sigma^2\\cos^2\\theta + \\sigma^2\\sin^2\\theta\n$$\n$$\n|G(\\theta)|^2 = (1 - \\sigma - r)^2 + \\sigma^2 + 2\\sigma(1 - \\sigma - r)\\cos\\theta\n$$\n该格式是线性稳定的，当且仅当对于所有 $\\theta \\in [-\\pi, \\pi]$，有 $|G(\\theta)| \\le 1$。这等价于 $|G(\\theta)|^2 \\le 1$。$|G(\\theta)|^2$ 的表达式是 $\\cos\\theta$ 的线性函数。其极值出现在 $\\cos\\theta$ 的取值范围的边界处，即 $\\cos\\theta = 1$（对应 $\\theta = 0, k=0$）和 $\\cos\\theta = -1$（对应 $\\theta = \\pi, k=\\pi/\\Delta x$）。\n\n1.  **在 $\\theta = 0$ ($k=0$) 处：** $\\cos\\theta = 1$。\n    $$\n    |G(0)|^2 = (1 - \\sigma - r)^2 + \\sigma^2 + 2\\sigma(1 - \\sigma - r) = [(1 - \\sigma - r) + \\sigma]^2 = (1 - r)^2\n    $$\n    稳定性条件 $|G(0)|^2 \\le 1$ 意味着 $(1-r)^2 \\le 1$，即 $-1 \\le 1-r \\le 1$。\n    由于 $r = \\epsilon\\,\\Delta t \\ge 0$，不等式 $1-r \\le 1$ 总是成立的。另一个不等式 $-1 \\le 1-r$ 给出 $r \\le 2$。\n\n2.  **在 $\\theta = \\pi$ ($k=\\pi/\\Delta x$) 处：** $\\cos\\theta = -1$。\n    $$\n    |G(\\pi)|^2 = (1 - \\sigma - r)^2 + \\sigma^2 - 2\\sigma(1 - \\sigma - r) = [(1 - \\sigma - r) - \\sigma]^2 = (1 - 2\\sigma - r)^2\n    $$\n    稳定性条件 $|G(\\pi)|^2 \\le 1$ 意味着 $(1 - 2\\sigma - r)^2 \\le 1$，即 $-1 \\le 1 - 2\\sigma - r \\le 1$。\n    右侧不等式 $1 - 2\\sigma - r \\le 1$ 给出 $-2\\sigma - r \\le 0$，即 $2\\sigma + r \\ge 0$。由于 $\\sigma \\ge 0$ 且 $r \\ge 0$，这个条件总是满足的。\n    左侧不等式 $-1 \\le 1 - 2\\sigma - r$ 给出 $2\\sigma + r \\le 2$。\n\n**组合稳定性条件与最大时间步长**\n如果两个条件 $r \\le 2$ 和 $2\\sigma + r \\le 2$ 都满足，则该格式是稳定的。由于 $\\sigma \\ge 0$，第二个条件 $2\\sigma + r \\le 2$ 意味着 $r \\le 2 - 2\\sigma \\le 2$。因此，$2\\sigma + r \\le 2$ 是稳定性的唯一充分必要条件。\n\n我们代入 $\\sigma$ 和 $r$ 的定义：\n$$\n2 \\left(\\frac{|a|\\,\\Delta t}{\\Delta x}\\right) + \\epsilon\\,\\Delta t \\le 2\n$$\n提出 $\\Delta t$：\n$$\n\\Delta t \\left( \\frac{2|a|}{\\Delta x} + \\epsilon \\right) \\le 2\n$$\n由此，我们推导出最大稳定时间步长 $\\Delta t_{\\max}$：\n$$\n\\Delta t_{\\max} = \\frac{2}{\\frac{2|a|}{\\Delta x} + \\epsilon}\n$$\n这个公式适用于所有情况，包括 $a=0$ 或 $\\epsilon=0$ 的情况。\n- 如果 $\\epsilon=0$（纯平流），$\\Delta t_{\\max} = \\frac{2}{2|a|/\\Delta x} = \\frac{\\Delta x}{|a|}$，这对应于经典的 CFL 条件 $\\sigma \\le 1$。\n- 如果 $a=0$（纯反应），$\\Delta t_{\\max} = \\frac{2}{\\epsilon}$，这是前向欧拉法作用于 ODE $u'=-\\epsilon u$ 的稳定性极限，对应于 $r \\le 2$。\n\n**稳定性相互作用的定性解释**\n稳定性条件可以重写为 $\\sigma + r/2 \\le 1$。\n- 项 $\\sigma = |a|\\Delta t/\\Delta x$ 代表了对流项的显式迎风离散格式带来的稳定性要求。仅考虑此项时，稳定性要求 $\\sigma \\le 1$。\n- 项 $r/2 = \\epsilon \\Delta t / 2$ 代表了反应项的显式处理带来的稳定性要求。仅考虑此项时，稳定性要求 $r \\le 2$。\n\n组合条件 $\\sigma + r/2 \\le 1$ 表明，这两种现象对时间步长的限制是相加的。虽然汇项 $-\\epsilon u$ 在物理上是耗散的，会衰减解，但其通过前向欧拉法的*显式*数值处理引入了其自身对时间步长的约束。对于具有负实特征值的问题（刚性或耗散系统），前向欧拉法只是条件稳定的。稳定性的总“需求”，由库朗数和反应数的一半之和表示，不能超过 1。因此，存在一个显式处理的汇项（$\\epsilon  0$）会使得总的时间步长限制比纯平流的 CFL 条件*更严格*。时间步长必须足够小，以便在所选显式时间积分格式的限制内，同时稳定地解析平流和反应动力学。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the maximum linearly stable time step for a 1D convection-reaction\n    equation discretized with forward-Euler in time and first-order upwind in space.\n    \"\"\"\n    \n    # Test cases defined as tuples of (a, epsilon, delta_x)\n    test_cases = [\n        (1.0, 0.5, 0.01),   # Test 1\n        (2.0, 0.0, 0.05),   # Test 2\n        (0.0, 4.0, 0.01),   # Test 3\n        (-3.0, 1.0, 0.02),  # Test 4\n        (0.75, 1.5, 0.10)   # Test 5\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        a, epsilon, delta_x = case\n        \n        # The stability analysis yields the formula for the maximum stable time step:\n        # dt_max = 2 / (2*|a|/dx + epsilon)\n        \n        # Denominator of the formula\n        denominator = (2.0 * abs(a) / delta_x) + epsilon\n        \n        # Calculate the maximum stable time step.\n        # This formula correctly handles the edge cases where a=0 or epsilon=0.\n        # If the denominator is zero (a=0 and epsilon=0), the PDE is u_t = 0,\n        # which is unconditionally stable. The time step would be infinite,\n        # but this case is not in the test suite.\n        if denominator == 0.0:\n            # This case corresponds to a=0 and epsilon=0.\n            # The scheme is unconditionally stable for u_t = 0.\n            # Representing this as infinity.\n            dt_max = float('inf')\n        else:\n            dt_max = 2.0 / denominator\n            \n        results.append(dt_max)\n\n    # Format the output as a comma-separated list of floating-point numbers\n    # enclosed in square brackets.\n    output_str = f\"[{','.join(map(str, results))}]\"\n    \n    print(output_str)\n\nsolve()\n```", "id": "2449011"}, {"introduction": "在真实世界的应用中，流速很少是恒定的，它可能在空间上变化，甚至改变方向。迎风格式如何应对这种情况？本练习 [@problem_id:2448947] 的核心是为一个速度场在空间上变化的线性守恒律，实现一个稳健的有限体积迎风格式。关键在于，您需要在每个单元交界面上，根据当地的流动方向来独立地决定“迎风”侧，这是开发能够处理复杂流场（如回流区）的通用计算程序的关键一步。", "problem": "考虑一维周期域上的线性守恒律\n$$ u_t + \\partial_x\\!\\big(a(x)\\,u\\big) = 0 \\quad \\text{for } x \\in [0,1], \\; t \\ge 0, $$\n其波速为\n$$ a(x) = 2\\,(x - \\tfrac{1}{2}). $$\n该区域被划分为一个由 $N$ 个控制体（单元）组成的均匀网格，并采用周期性边界条件。设单元中心为\n$$ x_i = \\frac{i + \\tfrac{1}{2}}{N}, \\quad i = 0,1,\\dots,N-1, $$\n单元面为\n$$ x_{i+\\tfrac{1}{2}} = \\frac{i+1}{N}, \\quad i = 0,1,\\dots,N-1, $$\n其中周期性索引按模 $N$ 理解。设单元宽度为 $\\Delta x = \\tfrac{1}{N}$，并从时间层 $n$ 到 $n+1$ 应用大小为 $\\Delta t$ 的单个时间步。\n\n定义一阶显式守恒有限体积更新格式\n$$ u_i^{n+1} = u_i^n - \\frac{\\Delta t}{\\Delta x}\\,\\big(F_{i+\\tfrac{1}{2}}^n - F_{i-\\tfrac{1}{2}}^n\\big), $$\n其中，在面 $x_{i+\\tfrac{1}{2}}$ 处的数值通量为\n$$ F_{i+\\tfrac{1}{2}}^n = \\begin{cases} a(x_{i+\\tfrac{1}{2}})\\,u_i^n,  \\text{if } a(x_{i+\\tfrac{1}{2}}) \\ge 0 \\\\ a(x_{i+\\tfrac{1}{2}})\\,u_{i+1}^n,  \\text{if } a(x_{i+\\tfrac{1}{2}})  0 \\end{cases} $$\n在区域边界处具有周期性环绕。该模板根据每个面上 $a(x)$ 的符号进行局部迎风处理，由于 $a(x)$ 的符号在区域内会改变，因此迎风方向也会改变。\n\n对于下面的所有测试用例，通过在单元中心对初始条件进行逐点采样来初始化 $u_i^0$，即\n$$ u_i^0 = u_0(x_i). $$\n所有量都是无量纲的；不涉及物理单位。\n\n实现上述单步更新，并为以下四个测试用例中的每一个计算所要求的标量值。您的程序必须生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，按测试用例1到4的顺序排列，例如 $[r_1,r_2,r_3,r_4]$，其中每个 $r_k$ 是一个十进制数。\n\n测试套件：\n\n- 测试用例 1（$a(x)$ 符号变化和平滑数据的一般情况）：\n  - $N = 20$，$\\Delta t = 0.02$。\n  - $u_0(x) = \\sin(2\\pi x) + 1$。\n  - 输出 $u_{10}^{1}$ 的值（即，经过一个时间步后，单元索引 $i = 10$ 中的更新值）。\n\n- 测试用例 2（界面处波速为零且守恒的情况）：\n  - $N = 16$，$\\Delta t = 0.01$。\n  - $u_0(x) = x$。\n  - 输出在面 $x_{i+\\tfrac{1}{2}} = \\tfrac{1}{2}$ （即 $a(x)=0$ 的界面）处的数值通量绝对值 $|F_{i+\\tfrac{1}{2}}^0|$。\n\n- 测试用例 3（零时间步长的边界情况）：\n  - $N = 10$，$\\Delta t = 0$。\n  - $u_0(x) = \\sqrt{x\\,(1-x)}$。\n  - 输出最大绝对变化量 $\\max_i |u_i^{1} - u_i^{0}|$。\n\n- 测试用例 4（跨区域迎风方向反转的周期性环绕）：\n  - $N = 4$，$\\Delta t = 0.2$。\n  - 对于 $x \\in [\\tfrac{3}{4},1]$，$u_0(x) = 2$，其他情况 $u_0(x) = 0$。\n  - 输出 $u_{0}^{1}$ 的值（即，经过一个时间步后，单元索引 $i = 0$ 中的更新值）。\n\n最终输出格式：\n\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如 $[r_1,r_2,r_3,r_4]$），其中每个 $r_k$ 是相应测试用例所要求的标量结果。", "solution": "所提出的问题是计算工程学中一个适定的练习，具体涉及使用一阶有限体积法对线性守恒律进行数值求解。该问题在科学上是合理的，规范是完整的，并且不包含任何矛盾。每个测试用例都存在唯一的解。我们将继续进行分析。\n\n控制方程是由下式给出的线性守恒律\n$$ u_t + \\partial_x(a(x)u) = 0, $$\n在周期性区域 $x \\in [0,1]$ 上。波速不是恒定的：$a(x) = 2(x - \\tfrac{1}{2})$。该方程描述了量 $u$ 以在空间上线性变化的速度进行的输运（平流）。速度在区域中心 $x=0.5$ 处为零，对于 $x  0.5$ 为负，对于 $x > 0.5$ 为正。这意味着量 $u$ 从中心被输运到边界，由于周期性边界条件，它在那里重新进入区域。\n\n所采用的数值方法是有限体积格式。该方法基于守恒律在每个控制体（单元）$C_i = [x_{i-\\tfrac{1}{2}}, x_{i+\\tfrac{1}{2}}]$ 上的积分形式。单元中 $u$ 的平均值的变化由穿过其边界的净通量来平衡：\n$$ \\frac{d}{dt} \\int_{x_{i-\\tfrac{1}{2}}}^{x_{i+\\tfrac{1}{2}}} u(x,t) dx + \\big(a(x_{i+\\tfrac{1}{2}})u(x_{i+\\tfrac{1}{2}},t) - a(x_{i-\\tfrac{1}{2}})u(x_{i-\\tfrac{1}{2}},t)\\big) = 0. $$\n通过近似单元平均值 $u_i(t) \\approx \\frac{1}{\\Delta x} \\int_{C_i} u(x,t) dx$ 并使用显式欧拉步在时间上进行离散化，得到守恒更新公式：\n$$ u_i^{n+1} = u_i^n - \\frac{\\Delta t}{\\Delta x} \\big(F_{i+\\tfrac{1}{2}}^n - F_{i-\\tfrac{1}{2}}^n\\big). $$\n这里，$u_i^n$ 是在时间 $t_n$ 时单元 $i$ 中 $u$ 的单元平均值的近似，$\\Delta x = 1/N$ 是单元宽度，$F_{i+\\tfrac{1}{2}}^n$ 是在单元面 $x_{i+\\tfrac{1}{2}}$ 处近似物理通量 $a(x)u$ 的数值通量。\n\n数值通量被指定为一阶迎风通量：\n$$ F_{i+\\tfrac{1}{2}}^n = \\begin{cases} a(x_{i+\\tfrac{1}{2}})\\,u_i^n,  \\text{if } a(x_{i+\\tfrac{1}{2}}) \\ge 0 \\\\ a(x_{i+\\tfrac{1}{2}})\\,u_{i+1}^n,  \\text{if } a(x_{i+\\tfrac{1}{2}})  0 \\end{cases} $$\n迎风原理规定，界面处的通量由信息来源的“迎风”单元的状态决定。如果单元 $i$ 和单元 $i+1$ 之间的面上波速 $a(x_{i+\\tfrac{1}{2}})$ 为正，则流动方向为从左到右，因此通量取决于单元 $i$ 中的状态。如果波速为负，则流动方向为从右到左，通量取决于单元 $i+1$ 中的状态。这对于对流主导问题的数值格式的稳定性至关重要。\n\n我们现在系统地处理每个测试用例。\n\n**测试用例 1**\n\n参数：$N = 20$，$\\Delta t = 0.02$，初始条件 $u_0(x) = \\sin(2\\pi x) + 1$。我们被要求求解 $u_{10}^{1}$。\n\n首先，我们建立离散网格。单元宽度为 $\\Delta x = 1/20 = 0.05$。单元中心为 $x_i = (i+0.5)/20$，其中 $i=0, \\dots, 19$。单元面为 $x_{i+1/2} = (i+1)/20$。单元 $i=10$ 的时间步更新为\n$$ u_{10}^{1} = u_{10}^{0} - \\frac{\\Delta t}{\\Delta x} \\big( F_{10+\\tfrac{1}{2}}^{0} - F_{10-\\tfrac{1}{2}}^{0} \\big). $$\n初始值为 $u_{10}^0 = u_0(x_{10}) = u_0((10+0.5)/20) = u_0(0.525) = \\sin(2\\pi \\times 0.525) + 1 = \\sin(1.05\\pi) + 1$。\n比率 $\\Delta t / \\Delta x = 0.02 / 0.05 = 0.4$。\n\n我们必须计算单元 $10$ 边界上的通量，即 $x_{9+\\tfrac{1}{2}}$ 和 $x_{10+\\tfrac{1}{2}}$。\n面 $x_{10+\\tfrac{1}{2}} = x_{10.5} = (10+1)/20 = 0.55$。这里的波速是 $a(0.55) = 2(0.55 - 0.5) = 0.1$。由于 $a(x_{10.5})  0$，迎风方向来自单元 $10$。因此，通量是 $F_{10.5}^0 = a(x_{10.5}) u_{10}^0 = 0.1 \\times u_{10}^0$。\n面 $x_{9+\\tfrac{1}{2}} = x_{9.5} = (9+1)/20 = 0.5$。这里的波速是 $a(0.5) = 2(0.5 - 0.5) = 0$。通量的条件是 $a \\ge 0$，该条件满足。迎风方向来自单元 $9$。因此，$F_{9.5}^0 = a(x_{9.5}) u_{9}^0 = 0 \\times u_{9}^0 = 0$。\n\n将通量代入更新方程：\n$$ u_{10}^{1} = u_{10}^{0} - 0.4 \\big( (0.1 \\times u_{10}^0) - 0 \\big) = u_{10}^{0} - 0.04 u_{10}^{0} = 0.96 u_{10}^{0}. $$\n最后，我们计算数值：\n$$ u_{10}^{1} = 0.96 \\times (\\sin(1.05\\pi) + 1) \\approx 0.96 \\times (-0.156434465 + 1) \\approx 0.809822913. $$\n\n**测试用例 2**\n\n参数：$N = 16$，$\\Delta t = 0.01$，初始条件 $u_0(x) = x$。我们需要计算在面 $x_{i+\\tfrac{1}{2}} = 1/2$ 处的通量绝对值 $|F_{i+\\tfrac{1}{2}}^0|$。\n\n首先，确定面索引 $i$。$x_{i+\\tfrac{1}{2}} = (i+1)/N = (i+1)/16 = 1/2$。这得到 $i+1=8$，所以 $i=7$。我们需要计算 $|F_{7+\\tfrac{1}{2}}^0|$。\n这个面是 $x_{7.5} = 0.5$。该面上的波速是 $a(0.5) = 2(0.5 - 0.5) = 0$。\n根据通量定义，如果 $a(x_{i+\\tfrac{1}{2}}) \\ge 0$，通量为 $F_{i+\\tfrac{1}{2}}^n = a(x_{i+\\tfrac{1}{2}}) u_i^n$。此处，$a(x_{7.5}) = 0$，所以条件满足。左边的单元是 $i=7$。\n通量是 $F_{7.5}^0 = a(x_{7.5}) u_7^0 = 0 \\times u_7^0 = 0$。\n$u_7^0$ 的值是无关紧要的。通量为零，因为界面处的输运速度为零。\n所要求的值是 $|F_{7.5}^0| = |0| = 0$。\n\n**测试用例 3**\n\n参数：$N = 10$，$\\Delta t = 0$，初始条件 $u_0(x) = \\sqrt{x(1-x)}$。输出是最大絕對變化量 $\\max_i |u_i^1 - u_i^0|$。\n\n有限体积更新公式为 $u_i^1 = u_i^0 - \\frac{\\Delta t}{\\Delta x}(F_{i+\\tfrac{1}{2}}^0 - F_{i-\\tfrac{1}{2}}^0)$。\n给定 $\\Delta t = 0$，无论通量值如何，更新项都为零：\n$$ u_i^1 = u_i^0 - \\frac{0}{\\Delta x}(\\dots) = u_i^0. $$\n因此，对于所有 $i=0, \\dots, N-1$，$u_i^1 = u_i^0$。所有单元的变化量都恒为零。\n最大绝对变化量是 $\\max_i |u_i^1 - u_i^0| = \\max_i |u_i^0 - u_i^0| = \\max_i(0) = 0$。\n\n**测试用例 4**\n\n参数：$N = 4$，$\\Delta t = 0.2$，初始条件为 $x \\in [3/4, 1]$ 时 $u_0(x) = 2$，否则 $u_0(x) = 0$。我们需要求解 $u_0^1$。\n\n首先，建立离散初始条件。$\\Delta x = 1/4 = 0.25$。\n单元中心为 $x_0 = 0.125$, $x_1 = 0.375$, $x_2 = 0.625$, $x_3 = 0.875$。\n在这些中心点上计算 $u_0(x)$：\n$u_0^0 = u_0(0.125) = 0$。\n$u_1^0 = u_0(0.375) = 0$。\n$u_2^0 = u_0(0.625) = 0$。\n$u_3^0 = u_0(0.875) = 2$ (因为 $0.75 \\le 0.875 \\le 1$)。\n初始状态向量为 $u^0 = [0, 0, 0, 2]$。\n\n单元 $i=0$ 的更新公式为\n$$ u_0^1 = u_0^0 - \\frac{\\Delta t}{\\Delta x} \\big( F_{0+\\tfrac{1}{2}}^0 - F_{0-\\tfrac{1}{2}}^0 \\big). $$\n对于周期性索引，面 $x_{0-\\tfrac{1}{2}}$ 与 $x_{3+\\tfrac{1}{2}}$ 相同。因此我们需要通量 $F_{0.5}^0$ 和 $F_{3.5}^0$。\n比率 $\\Delta t / \\Delta x = 0.2 / 0.25 = 0.8$。\n\n我们计算所需的通量：\n面 $x_{0.5} = (0+1)/4 = 0.25$。波速是 $a(0.25) = 2(0.25-0.5) = -0.5$。由于 $a  0$，流动从右到左，所以通量取决于单元 $i+1=1$ 中的状态。\n$F_{0.5}^0 = a(x_{0.5}) u_1^0 = -0.5 \\times 0 = 0$。\n面 $x_{3.5} = (3+1)/4 = 1.0$。波速是 $a(1.0) = 2(1.0-0.5) = 1.0$。由于 $a  0$，流动从左到右，所以通量取决于单元 $i=3$ 中的状态。\n$F_{3.5}^0 = a(x_{3.5}) u_3^0 = 1.0 \\times 2 = 2$。\n\n现在，将这些代入 $u_0^1$ 的更新公式：\n$$ u_0^1 = u_0^0 - 0.8 \\big( F_{0.5}^0 - F_{3.5}^0 \\big) = 0 - 0.8 \\big( 0 - 2 \\big) = -0.8(-2) = 1.6. $$\n结果是 $u_0^1 = 1.6$。这在物理上是一致的：单元3中的高值向右平流（索引增加），环绕周期性区域进入单元0。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef a_wave_speed(x):\n    \"\"\"Calculates the wave speed a(x) = 2*(x - 0.5).\"\"\"\n    return 2.0 * (x - 0.5)\n\ndef perform_single_step(N, dt, u0):\n    \"\"\"\n    Performs a single time step of the first-order upwind finite volume method.\n    Returns the updated solution array u1 and the array of fluxes F.\n    \"\"\"\n    if N == 0:\n        return np.array([]), np.array([])\n        \n    dx = 1.0 / N\n    \n    # Locations of cell faces (interfaces)\n    x_faces = (np.arange(N) + 1.0) / N\n    \n    # Wave speed at each face\n    a_at_faces = a_wave_speed(x_faces)\n    \n    # Calculate numerical fluxes F_{i+1/2} (indexed by i)\n    fluxes = np.zeros(N)\n    for i in range(N):\n        if a_at_faces[i] = 0:\n            # Flow is rightward, use value from cell i\n            fluxes[i] = a_at_faces[i] * u0[i]\n        else:\n            # Flow is leftward, use value from cell i+1 (with periodic wrap-around)\n            fluxes[i] = a_at_faces[i] * u0[(i + 1) % N]\n            \n    # Update solution u_i for all cells\n    u1 = np.zeros(N)\n    # The term dt/dx can be zero, which is a valid case\n    cfl_factor = dt / dx if dx  0 else 0.0\n    \n    for i in range(N):\n        F_right = fluxes[i]\n        F_left = fluxes[(i - 1 + N) % N]  # Periodic wrap-around for left flux\n        u1[i] = u0[i] - cfl_factor * (F_right - F_left)\n        \n    return u1, fluxes\n\ndef solve():\n    \"\"\"\n    Solves the four test cases specified in the problem statement and prints the results.\n    \"\"\"\n    test_cases = [\n        # Test Case 1\n        {'N': 20, 'dt': 0.02, 'u0_func': lambda x: np.sin(2 * np.pi * x) + 1, 'output_req': ('u_val', 10)},\n        # Test Case 2\n        {'N': 16, 'dt': 0.01, 'u0_func': lambda x: x, 'output_req': ('flux_abs', 7)},\n        # Test Case 3\n        {'N': 10, 'dt': 0.0, 'u0_func': lambda x: np.sqrt(x * (1 - x)) if x * (1-x) = 0 else 0, 'output_req': ('max_abs_change',)},\n        # Test Case 4\n        {'N': 4, 'dt': 0.2, 'u0_func': lambda x: 2.0 if (x = 0.75 and x = 1.0) else 0.0, 'output_req': ('u_val', 0)},\n    ]\n\n    results = []\n\n    for case in test_cases:\n        N = case['N']\n        dt = case['dt']\n        u0_func = case['u0_func']\n        output_req = case['output_req']\n        \n        # Initialize u0 by sampling at cell centers\n        x_centers = (np.arange(N) + 0.5) / N if N > 0 else np.array([])\n        u0 = np.array([u0_func(xc) for xc in x_centers])\n\n        # Perform one time step\n        u1, fluxes = perform_single_step(N, dt, u0)\n        \n        # Extract the requested result\n        req_type = output_req[0]\n        if req_type == 'u_val':\n            index = output_req[1]\n            results.append(u1[index])\n        elif req_type == 'flux_abs':\n            index = output_req[1]\n            results.append(np.abs(fluxes[index]))\n        elif req_type == 'max_abs_change':\n            if N > 0:\n                results.append(np.max(np.abs(u1 - u0)))\n            else:\n                results.append(0.0)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2448947"}, {"introduction": "一阶迎风格式虽然稳定，但会引入非物理的“数值扩散”（numerical diffusion），导致解的过度模糊。我们如何量化这种效应？这个富有启发性的练习 [@problem_id:2449005] 将此问题构建为一个逆问题。通过分析一个尖锐阶跃在数值模拟中被“抹平”的轮廓，您将反推出该格式等效的数值扩散系数 $\\mu_{\\text{num}}$，这是其修正方程（modified equation）中的关键误差项。这项实践将理论概念与可测量的结果联系起来，让您对数值方法的内在缺陷与权衡有更深刻的理解。", "problem": "考虑一个标量场的一维线性平流，它在实线上由方程 $u_t + a\\,u_x = 0$ 控制，其中 $a  0$ 为常数。初始条件为黎曼阶跃形式：当 $x  x_0$ 时，$u(x,0) = u_L$；当 $x  x_0$ 时，$u(x,0) = u_R$。一个未知但稳定的迎风有限差分格式被用于在均匀网格上计算最终时刻 $T$ 的数值解。网格间距为 $\\Delta x$，时间步长为 $\\Delta t$，Courant–Friedrichs–Lewy (CFL) 数为 $\\nu = a\\,\\Delta t / \\Delta x$。您仅被告知以下信息：该格式的主阶修正方程可以很好地由常系数平流-扩散方程 $u_t + a\\,u_x = \\mu_{\\text{num}}\\,u_{xx}$ 建模，其中数值扩散系数 $\\mu_{\\text{num}} \\ge 0$ 未知。并且，在时刻 $T$ 报告的数值输出已被移至协动参考系，使得坐标 $\\xi = x - (x_0 + a\\,T)$ 将平流移动的间断名义上置于 $\\xi = 0$ 处。\n\n将观测到的剖面的 $10$–$90$ 厚度 $\\delta_{10\\text{–}90}$ 定义为 $u$ 分别达到 $u = u_R + 0.1\\,(u_L - u_R)$ 和 $u = u_R + 0.9\\,(u_L - u_R)$ 这两个水平时所对应的两个 $\\xi$ 位置之差。假设观测窗口足够大，以至于边界效应可以忽略不计。在这些假设下，为下面每个独立的测试配置估算 $\\mu_{\\text{num}}$ 的值。\n\n所有量均为无量纲；无需物理单位。\n\n测试套件（每项为一个独立案例）：\n- 案例 A（一般情况）：$a = 1$，$\\Delta x = 0.01$，$\\Delta t = 0.005$，$\\nu = 0.5$，$T = 0.2$，$u_L = 1$，$u_R = 0$，测得 $\\delta_{10\\text{–}90} = 0.08105244$。\n- 案例 B（弥散最小的边界情况）：$a = 1$，$\\Delta x = 0.01$，$\\Delta t = 0.01$，$\\nu = 1$，$T = 0.2$，$u_L = 1$，$u_R = 0$，测得 $\\delta_{10\\text{–}90} = 0$。\n- 案例 C（更强的弥散）：$a = 1$，$\\Delta x = 0.01$，$\\Delta t = 0.002$，$\\nu = 0.2$，$T = 0.1$，$u_L = 1$，$u_R = 0$，测得 $\\delta_{10\\text{–}90} = 0.07249550416$。\n\n您的程序必须为每个案例计算出与给定数据和假设一致的 $\\mu_{\\text{num}}$ 的单个标量估计值，并按指定格式汇总这三个结果。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含三个估计值，以逗号分隔列表的形式置于方括号内（例如，$[result1,result2,result3]$），顺序为案例 A、案例 B、案例 C。", "solution": "首先对问题陈述进行严格的验证过程。\n\n**步骤 1：提取已知条件**\n- 控制偏微分方程 (PDE): $u_t + a\\,u_x = 0$\n- 初始条件：黎曼阶跃，$x  x_0$ 时 $u(x,0) = u_L$，$x > x_0$ 时 $u(x,0) = u_R$。\n- 平流速度：$a  0$，常数。\n- 数值格式：一个未指定的稳定迎风有限差分格式。\n- 离散化参数：网格间距 $\\Delta x$，时间步长 $\\Delta t$，Courant–Friedrichs–Lewy (CFL) 数 $\\nu = a\\,\\Delta t / \\Delta x$。\n- 主阶修正方程：$u_t + a\\,u_x = \\mu_{\\text{num}}\\,u_{xx}$，其中数值扩散系数 $\\mu_{\\text{num}} \\ge 0$。\n- 最终时间：$T$。\n- 协动坐标：$\\xi = x - (x_0 + a\\,T)$。\n- 剖面厚度定义：$\\delta_{10\\text{–}90}$ 是 $u = u_R + 0.1\\,(u_L - u_R)$ 和 $u = u_R + 0.9\\,(u_L - u_R)$ 对应的 $\\xi$ 坐标之差。\n- 测试案例 A：$a = 1$，$\\Delta x = 0.01$，$\\Delta t = 0.005$，$\\nu = 0.5$，$T = 0.2$，$u_L = 1$，$u_R = 0$，测得 $\\delta_{10\\text{–}90} = 0.08105244$。\n- 测试案例 B：$a = 1$，$\\Delta x = 0.01$，$\\Delta t = 0.01$，$\\nu = 1$，$T = 0.2$，$u_L = 1$，$u_R = 0$，测得 $\\delta_{10\\text{–}90} = 0$。\n- 测试案例 C：$a = 1$，$\\Delta x = 0.01$，$\\Delta t = 0.002$，$\\nu = 0.2$，$T = 0.1$，$u_L = 1$，$u_R = 0$，测得 $\\delta_{10\\text{–}90} = 0.07249550416$。\n\n**步骤 2：验证提取的已知条件**\n该问题具有科学依据，因为它基于修正方程这一标准概念，用于分析双曲守恒律数值格式的耗散误差。对于一阶迎风格式，平流-扩散方程是正确的主阶模型。该问题是适定的、客观的且自洽的，提供了推导所测剖面厚度与未知数值扩散系数之间关系所需的所有信息。为每个测试案例提供的数据是内部一致的，例如，对于案例 A，$a\\,\\Delta t / \\Delta x = 1 \\times 0.005 / 0.01 = 0.5$，与给定的 $\\nu = 0.5$ 相符。该问题没有可识别的缺陷。\n\n**步骤 3：结论与行动**\n问题有效。将基于第一性原理推导求解方案。\n\n基本原理是，在时刻 $T$ 观测到的数值解，可以用带有指定阶跃初始条件的修正平流-扩散方程 $u_t + a\\,u_x = \\mu_{\\text{num}}\\,u_{xx}$ 的解析解来近似。我们将推导这个解析解，用它来表示厚度 $\\delta_{10\\text{–}90}$作为 $\\mu_{\\text{num}}$ 和 $T$ 的函数，然后反转这个关系以求得 $\\mu_{\\text{num}}$。\n\n首先，我们将偏微分方程转换到协动参考系 $\\eta = x - a t$ 中。空间和时间导数转换为 $\\partial/\\partial x \\to \\partial/\\partial \\eta$ 和 $\\partial/\\partial t \\to \\partial/\\partial t - a\\,\\partial/\\partial \\eta$。将这些代入修正方程得到：\n$$\n(\\frac{\\partial u}{\\partial t} - a\\frac{\\partial u}{\\partial \\eta}) + a(\\frac{\\partial u}{\\partial \\eta}) = \\mu_{\\text{num}}\\frac{\\partial^2 u}{\\partial \\eta^2}\n$$\n这可以简化为移动参考系中的标准一维熱（或扩散）方程：\n$$\n\\frac{\\partial u}{\\partial t} = \\mu_{\\text{num}}\\frac{\\partial^2 u}{\\partial \\eta^2}\n$$\n初始条件 $x  x_0$ 时 $u(x,0) = u_L$，$x > x_0$ 时 $u(x,0) = u_R$，在一个平移的参考系 $\\eta' = x - x_0 - at$ 中，变为在 $\\eta'=0$ 处的一个阶跃：$\\eta'  0$ 时 $u(\\eta',0) = u_L$，$\\eta' > 0$ 时 $u(\\eta',0) = u_R$。对于此类初始数据，热方程的著名解由互补误差函数 $\\text{erfc}(z)$ 给出：\n$$\nu(\\eta', t) = u_R + \\frac{u_L - u_R}{2} \\text{erfc}\\left(\\frac{\\eta'}{\\sqrt{4 \\mu_{\\text{num}} t}}\\right)\n$$\n问题指定了在坐标 $\\xi = x - (x_0 + aT)$ 中的最终观测。在最终时刻 $t=T$，坐标 $\\eta'$ 为 $\\eta' = x - x_0 - aT$，这与 $\\xi$ 相同。因此，时刻 $T$ 的解剖面为：\n$$\nu(\\xi, T) = u_R + \\frac{u_L - u_R}{2} \\text{erfc}\\left(\\frac{\\xi}{\\sqrt{4 \\mu_{\\text{num}} T}}\\right)\n$$\n接下来，我们使用 $\\delta_{10\\text{–}90}$ 的定义。我们必须找到分别对应于解值 $u = u_R + 0.9\\,(u_L - u_R)$ 和 $u = u_R + 0.1\\,(u_L - u_R)$ 的位置 $\\xi_{90}$ 和 $\\xi_{10}$。\n对于 $90\\%$ 水平（在 $\\xi_{90}$ 处）：\n$$\nu_R + 0.9(u_L - u_R) = u_R + \\frac{u_L - u_R}{2} \\text{erfc}\\left(\\frac{\\xi_{90}}{\\sqrt{4 \\mu_{\\text{num}} T}}\\right)\n$$\n$$\n0.9 = \\frac{1}{2} \\text{erfc}(z_{90}) \\implies \\text{erfc}(z_{90}) = 1.8 \\implies 1 - \\text{erf}(z_{90}) = 1.8 \\implies \\text{erf}(z_{90}) = -0.8\n$$\n其中 $z_{90} = \\xi_{90} / \\sqrt{4 \\mu_{\\text{num}} T}$。因此，$z_{90} = \\text{erf}^{-1}(-0.8) = -\\text{erf}^{-1}(0.8)$。\n\n对于 $10\\%$ 水平（在 $\\xi_{10}$ 处）：\n$$\nu_R + 0.1(u_L - u_R) = u_R + \\frac{u_L - u_R}{2} \\text{erfc}\\left(\\frac{\\xi_{10}}{\\sqrt{4 \\mu_{\\text{num}} T}}\\right)\n$$\n$$\n0.1 = \\frac{1}{2} \\text{erfc}(z_{10}) \\implies \\text{erfc}(z_{10}) = 0.2 \\implies 1 - \\text{erf}(z_{10}) = 0.2 \\implies \\text{erf}(z_{10}) = 0.8\n$$\n其中 $z_{10} = \\xi_{10} / \\sqrt{4 \\mu_{\\text{num}} T}$。因此，$z_{10} = \\text{erf}^{-1}(0.8)$。\n\n由此，我们找到以下位置：\n$$\n\\xi_{90} = \\sqrt{4 \\mu_{\\text{num}} T} \\cdot z_{90} = -\\sqrt{4 \\mu_{\\text{num}} T} \\cdot \\text{erf}^{-1}(0.8)\n$$\n$$\n\\xi_{10} = \\sqrt{4 \\mu_{\\text{num}} T} \\cdot z_{10} = \\sqrt{4 \\mu_{\\text{num}} T} \\cdot \\text{erf}^{-1}(0.8)\n$$\n由于 $u_L  u_R$，解剖面随 $\\xi$ 增加而减小，所以 $\\xi_{10}  \\xi_{90}$。厚度 $\\delta_{10\\text{–}90}$ 定义为这些位置之差：\n$$\n\\delta_{10\\text{–}90} = \\xi_{10} - \\xi_{90} = 2 \\sqrt{4 \\mu_{\\text{num}} T} \\cdot \\text{erf}^{-1}(0.8) = 4 \\sqrt{\\mu_{\\text{num}} T} \\cdot \\text{erf}^{-1}(0.8)\n$$\n我们现在反转这个表达式来求解 $\\mu_{\\text{num}}$：\n$$\n\\sqrt{\\mu_{\\text{num}}} = \\frac{\\delta_{10\\text{–}90}}{4 \\sqrt{T} \\cdot \\text{erf}^{-1}(0.8)}\n$$\n$$\n\\mu_{\\text{num}} = \\left( \\frac{\\delta_{10\\text{–}90}}{4 \\sqrt{T} \\cdot \\text{erf}^{-1}(0.8)} \\right)^2 = \\frac{\\delta_{10\\text{–}90}^2}{16 \\cdot T \\cdot (\\text{erf}^{-1}(0.8))^2}\n$$\n这就是估算 $\\mu_{\\text{num}}$ 的最终公式。此公式将应用于每个测试案例。\n对于案例 B，$\\delta_{10\\text{–}90} = 0$，这直接得出 $\\mu_{\\text{num}} = 0$。这在物理上是正确的，因为对于一阶迎风格式，CFL 数 $\\nu=1$ 会导致精确平流，数值扩散为零。\n对于案例 A 和 C，我们将提供的 $\\delta_{10\\text{–}90}$ 和 $T$ 的值代入推导出的公式。常数 $\\text{erf}^{-1}(0.8)$ 是一个已知的数值。\n计算过程如下：\n- 令 $C = \\text{erf}^{-1}(0.8) \\approx 0.9061938$。\n- 案例 A: $\\mu_{\\text{num,A}} = \\frac{(0.08105244)^2}{16 \\cdot 0.2 \\cdot C^2} = 0.0025$。\n- 案例 B: $\\mu_{\\text{num,B}} = \\frac{0^2}{16 \\cdot 0.2 \\cdot C^2} = 0$。\n- 案例 C: $\\mu_{\\text{num,C}} = \\frac{(0.07249550416)^2}{16 \\cdot 0.1 \\cdot C^2} = 0.004$。\n这些值构成了问题的解。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import erfinv\n\ndef solve():\n    \"\"\"\n    Computes the numerical diffusivity mu_num for each test case based on the \n    analytical solution to the advection-diffusion equation.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (measured_delta_10_90, final_time_T)\n    test_cases = [\n        (0.08105244, 0.2),       # Case A\n        (0.0, 0.2),              # Case B\n        (0.07249550416, 0.1)     # Case C\n    ]\n\n    results = []\n\n    # Pre-calculate the constant C_erf = erf_inv(0.8)\n    # This value is derived from the definition of the 10-90 thickness.\n    try:\n        C_erf = erfinv(0.8)\n    except NameError:\n        # Fallback in case scipy is not available, though problem spec guarantees it.\n        # This constant is approximately 0.9061938024368232.\n        # This fallback is for robustness and not expected to be used.\n        C_erf = 0.9061938024368232\n\n    # The formula for mu_num is derived from the analytical solution:\n    # delta = 4 * sqrt(mu_num * T) * C_erf\n    # mu_num = delta^2 / (16 * T * C_erf^2)\n\n    for delta, T in test_cases:\n        # Handle the special case where delta is zero, corresponding to no numerical\n        # diffusion (e.g., when CFL=1 for first-order upwind).\n        # This also avoids any potential floating point inaccuracies.\n        if delta == 0.0:\n            mu_num = 0.0\n        else:\n            # Apply the derived formula to estimate the numerical diffusivity.\n            mu_num = delta**2 / (16 * T * C_erf**2)\n        \n        results.append(mu_num)\n\n    # The problem asks for the results as a comma-separated list in brackets.\n    # The default string conversion for floats is sufficient here.\n    # Example: [0.0025, 0.0, 0.004]\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2449005"}]}