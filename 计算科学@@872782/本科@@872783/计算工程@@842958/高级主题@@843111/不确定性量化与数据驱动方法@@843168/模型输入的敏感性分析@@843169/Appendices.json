{"hands_on_practices": [{"introduction": "首先，我们将通过解析方法计算一个简单可加模型的 Sobol' 指数。这个基础练习展示了在没有交互效应的系统中，模型输出的总方差如何被完美地分解为各个输入的主效应贡献之和，从而清晰地揭示一阶和全阶指数的定义。通过这个练习 [@problem_id:2434889]，你将掌握应用基于方差的灵敏度定义的核心计算技能。", "problem": "考虑由函数 $f(x_1, x_2) = \\sin(x_1) + \\cos(x_2)$ 定义的模型输出，其中输入参数 $x_1$ 和 $x_2$ 是独立的随机变量，均在区间 $[0, 2\\pi]$ 上服从均匀分布（角度以弧度为单位）。使用基于方差的 Sobol' 灵敏度指数定义，确定一阶指数 $S_1$ 和 $S_2$、二阶交互作用指数 $S_{12}$ 以及全效应指数 $S_{T_1}$ 和 $S_{T_2}$。提供精确值。\n\n将最终答案以单行矩阵的形式报告，顺序为 $(S_1, S_2, S_{12}, S_{T_1}, S_{T_2})$。无需四舍五入，最终答案中不包含单位。", "solution": "该问题是有效的。这是一个在灵敏度分析领域中提法得当、具有科学依据的问题。所有必要的信息都已提供，目标也已明确陈述。我们开始求解。\n\n该问题要求计算模型输出 $Y = f(x_1, x_2) = \\sin(x_1) + \\cos(x_2)$ 的 Sobol' 灵敏度指数，其中输入 $x_1$ 和 $x_2$ 是在区间 $[0, 2\\pi]$ 上服从均匀分布的独立随机变量。$x_1$ 和 $x_2$ 的概率密度函数 (PDF) 均为 $p(x) = \\frac{1}{2\\pi}$，其中 $x \\in [0, 2\\pi]$。\n\n输入 $x_i$ 的 Sobol' 一阶灵敏度指数 $S_i$ 定义为由 $x_i$ 的主效应贡献的总方差 $V(Y)$ 的一部分：\n$$S_i = \\frac{V(E[Y | x_i])}{V(Y)}$$\n全效应指数 $S_{T_i}$ 是涉及 $x_i$ 的所有效应（主效应和所有交互作用）的总和。它可以计算为：\n$$S_{T_i} = \\frac{E[V(Y | X_{\\sim i})]}{V(Y)} = 1 - \\frac{V(E[Y | X_{\\sim i}])}{V(Y)}$$\n其中 $X_{\\sim i}$ 表示除 $x_i$ 外的所有输入变量的集合。交互作用指数 $S_{ij}$ 衡量了由 $x_i$ 和 $x_j$ 之间的交互作用产生但未被其一阶效应所解释的方差。\n\n首先，我们计算输出的总方差 $V(Y)$。\n$$V(Y) = V[\\sin(x_1) + \\cos(x_2)]$$\n由于 $x_1$ 和 $x_2$ 是独立的，和的方差等于方差的和：\n$$V(Y) = V[\\sin(x_1)] + V[\\cos(x_2)]$$\n为了计算这些方差，我们需要期望值 $E[\\sin(x_1)]$、$E[\\sin^2(x_1)]$、$E[\\cos(x_2)]$ 和 $E[\\cos^2(x_2)]$。\n\n$\\sin(x_1)$ 的期望值为：\n$$E[\\sin(x_1)] = \\int_0^{2\\pi} \\sin(x_1) p(x_1) dx_1 = \\frac{1}{2\\pi} \\int_0^{2\\pi} \\sin(x_1) dx_1 = \\frac{1}{2\\pi} [-\\cos(x_1)]_0^{2\\pi} = \\frac{1}{2\\pi} (-\\cos(2\\pi) + \\cos(0)) = \\frac{1}{2\\pi}(-1 + 1) = 0$$\n$\\sin^2(x_1)$ 的期望值为：\n$$E[\\sin^2(x_1)] = \\frac{1}{2\\pi} \\int_0^{2\\pi} \\sin^2(x_1) dx_1 = \\frac{1}{2\\pi} \\int_0^{2\\pi} \\frac{1 - \\cos(2x_1)}{2} dx_1 = \\frac{1}{4\\pi} \\left[x_1 - \\frac{\\sin(2x_1)}{2}\\right]_0^{2\\pi} = \\frac{1}{4\\pi} (2\\pi) = \\frac{1}{2}$$\n因此，$\\sin(x_1)$ 的方差为：\n$$V[\\sin(x_1)] = E[\\sin^2(x_1)] - (E[\\sin(x_1)])^2 = \\frac{1}{2} - 0^2 = \\frac{1}{2}$$\n根据对称性，对于 $\\cos(x_2)$：\n$$E[\\cos(x_2)] = \\frac{1}{2\\pi} \\int_0^{2\\pi} \\cos(x_2) dx_2 = \\frac{1}{2\\pi} [\\sin(x_2)]_0^{2\\pi} = 0$$\n$$E[\\cos^2(x_2)] = \\frac{1}{2\\pi} \\int_0^{2\\pi} \\cos^2(x_2) dx_2 = \\frac{1}{2\\pi} \\int_0^{2\\pi} \\frac{1 + \\cos(2x_2)}{2} dx_2 = \\frac{1}{4\\pi} \\left[x_2 + \\frac{\\sin(2x_2)}{2}\\right]_0^{2\\pi} = \\frac{1}{4\\pi}(2\\pi) = \\frac{1}{2}$$\n$\\cos(x_2)$ 的方差为：\n$$V[\\cos(x_2)] = E[\\cos^2(x_2)] - (E[\\cos(x_2)])^2 = \\frac{1}{2} - 0^2 = \\frac{1}{2}$$\n输出的总方差为：\n$$V(Y) = V[\\sin(x_1)] + V[\\cos(x_2)] = \\frac{1}{2} + \\frac{1}{2} = 1$$\n\n现在，我们计算一阶指数 $S_1$ 和 $S_2$。\n对于 $S_1$，我们需要 $V(E[Y | x_1])$。条件期望是：\n$$E[Y | x_1] = E[\\sin(x_1) + \\cos(x_2) | x_1] = \\sin(x_1) + E[\\cos(x_2)] = \\sin(x_1) + 0 = \\sin(x_1)$$\n这个条件期望的方差是：\n$$V(E[Y | x_1]) = V[\\sin(x_1)] = \\frac{1}{2}$$\n所以，$x_1$ 的一阶指数是：\n$$S_1 = \\frac{V(E[Y | x_1])}{V(Y)} = \\frac{1/2}{1} = \\frac{1}{2}$$\n对于 $S_2$，根据对称性：\n$$E[Y | x_2] = E[\\sin(x_1) + \\cos(x_2) | x_2] = E[\\sin(x_1)] + \\cos(x_2) = 0 + \\cos(x_2) = \\cos(x_2)$$\n$$V(E[Y | x_2]) = V[\\cos(x_2)] = \\frac{1}{2}$$\n$x_2$ 的一阶指数是：\n$$S_2 = \\frac{V(E[Y | x_2])}{V(Y)} = \\frac{1/2}{1} = \\frac{1}{2}$$\n\n接下来，我们确定二阶交互作用指数 $S_{12}$。模型函数 $f(x_1, x_2) = \\sin(x_1) + \\cos(x_2)$ 是纯可加的，意味着它是单变量函数的和。对于这类模型，变量之间没有交互作用。这可以从 Sobol' 分解 $f = f_0 + f_1 + f_2 + f_{12}$ 中看出，其中 $f_0 = E[Y]=0$，$f_1(x_1) = E[Y|x_1]-f_0 = \\sin(x_1)$，且 $f_2(x_2) = E[Y|x_2]-f_0 = \\cos(x_2)$。交互作用项 $f_{12}$ 定义为 $f_{12} = f - f_0 - f_1 - f_2 = (\\sin(x_1) + \\cos(x_2)) - 0 - \\sin(x_1) - \\cos(x_2) = 0$。\n因此，交互作用项的方差 $V_{12} = V[f_{12}]$ 为 $0$。\n$$S_{12} = \\frac{V_{12}}{V(Y)} = \\frac{0}{1} = 0$$\n我们可以通过方差分解来验证这一点：$V(Y) = V_1 + V_2 + V_{12}$。两边同除以 $V(Y)$ 得到 $1 = S_1 + S_2 + S_{12}$。由于 $S_1 = \\frac{1}{2}$ 和 $S_2 = \\frac{1}{2}$，我们确认 $1 = \\frac{1}{2} + \\frac{1}{2} + S_{12}$，这意味着 $S_{12} = 0$。\n\n最后，我们计算全效应指数 $S_{T_1}$ 和 $S_{T_2}$。全效应指数 $S_{T_i}$ 是 $x_i$ 的主效应与所有涉及 $x_i$ 的交互作用效应之和。\n对于 $x_1$：\n$$S_{T_1} = S_1 + S_{12} = \\frac{1}{2} + 0 = \\frac{1}{2}$$\n对于 $x_2$：\n$$S_{T_2} = S_2 + S_{12} = \\frac{1}{2} + 0 = \\frac{1}{2}$$\n这是可加模型的一个普遍性质：由于不存在交互作用，输入的总效应指数等于其一阶指数，即 $S_{T_i} = S_i$。\n\n计算出的 Sobol' 指数为：\n$S_1 = \\frac{1}{2}$\n$S_2 = \\frac{1}{2}$\n$S_{12} = 0$\n$S_{T_1} = \\frac{1}{2}$\n$S_{T_2} = \\frac{1}{2}$\n\n最终答案应以单行矩阵的形式报告，顺序为 $(S_1, S_2, S_{12}, S_{T_1}, S_{T_2})$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{2}  \\frac{1}{2}  0  \\frac{1}{2}  \\frac{1}{2}\n\\end{pmatrix}\n}\n$$", "id": "2434889"}, {"introduction": "并非所有模型都是其组成部分的简单加和。下一个练习将探讨一个输出方差完全源于输入之间交互作用的情景。你将发现，一个输入的一阶指数可以为零（表明其自身没有独立影响），但由于其与其他输入的交互作用，它对模型仍然至关重要，这一点会通过其全阶指数揭示出来 [@problem_id:2434812]。这个练习彰显了全局灵敏度分析在揭示简单方法可能忽略的复杂关系方面的强大能力。", "problem": "考虑一个确定性模型，该模型有两个独立的实值输入 $X_1$ 和 $X_2$，每个输入都服从 $\\mathrm{Uniform}(0,1)$ 分布。标量输出定义为\n$$\nY \\;=\\; \\bigl(X_1 - \\tfrac{1}{2}\\bigr)\\,\\bigl(X_2 - \\tfrac{1}{2}\\bigr).\n$$\n对于输入 $X_i$，一阶 Sobol' 指数定义为\n$$\nS_i \\;=\\; \\frac{\\mathrm{Var}\\!\\bigl(\\mathbb{E}[Y \\mid X_i]\\bigr)}{\\mathrm{Var}(Y)},\n$$\n而全阶 Sobol' 指数定义为\n$$\nS_{Ti} \\;=\\; \\frac{\\mathbb{E}\\!\\bigl[\\mathrm{Var}(Y \\mid X_{\\sim i})\\bigr]}{\\mathrm{Var}(Y)},\n$$\n其中 $\\mathbb{E}[\\cdot]$ 表示期望，$\\mathrm{Var}(\\cdot)$ 表示方差，$X_{\\sim i}$ 表示除 $X_i$ 以外的所有输入的集合。\n\n仅使用这些定义和给定的分布，确定输入 $X_1$ 的全阶 Sobol' 指数 $S_{T1}$ 的精确值，并验证一阶指数 $S_1$ 等于 $0$。提供 $S_{T1}$ 的精确值（无四舍五入）作为最终答案。Sobol' 指数是无量纲的，无需报告单位。", "solution": "对问题陈述进行验证。\n**已知条件：**\n1.  模型：$Y = (X_1 - \\tfrac{1}{2})(X_2 - \\tfrac{1}{2})$。\n2.  输入：$X_1, X_2$ 是独立的实值输入。\n3.  分布：$X_1 \\sim \\mathrm{Uniform}(0,1)$ 且 $X_2 \\sim \\mathrm{Uniform}(0,1)$。\n4.  一阶 Sobol' 指数：$S_i = \\frac{\\mathrm{Var}(\\mathbb{E}[Y \\mid X_i])}{\\mathrm{Var}(Y)}$。\n5.  全阶 Sobol' 指数：$S_{Ti} = \\frac{\\mathbb{E}[\\mathrm{Var}(Y \\mid X_{\\sim i})]}{\\mathrm{Var}(Y)}$。\n6.  $X_{\\sim i}$ 表示除 $X_i$ 外的所有输入。\n\n**验证：**\n该问题具有科学依据，是 Sobol' 敏感性分析中的一个标准练习。该问题是适定的，所有必要的数学对象和分布都有清晰明确的定义。问题是客观的，不包含任何事实上的不健全、不完整或矛盾之处。其前提在数学和统计学上都是合理的。因此，该问题被视为有效，并将提供解答。\n\n求解过程首先计算输出的总方差 $\\mathrm{Var}(Y)$，它作为两个指数的分母。随后，我们将计算 $S_1$ 和 $S_{T1}$ 的分子，并验证所述条件。\n\n首先，我们确定输入随机变量的属性。对于输入 $X_i \\sim \\mathrm{Uniform}(0,1)$，其期望为：\n$$\n\\mathbb{E}[X_i] = \\int_0^1 x \\, dx = \\frac{1}{2}\n$$\n方差由 $\\mathrm{Var}(X_i) = \\mathbb{E}[X_i^2] - (\\mathbb{E}[X_i])^2$ 给出。我们计算二阶矩：\n$$\n\\mathbb{E}[X_i^2] = \\int_0^1 x^2 \\, dx = \\frac{1}{3}\n$$\n因此，方差为：\n$$\n\\mathrm{Var}(X_i) = \\frac{1}{3} - \\left(\\frac{1}{2}\\right)^2 = \\frac{1}{3} - \\frac{1}{4} = \\frac{1}{12}\n$$\n使用中心化变量会很方便。令 $Z_i = X_i - \\frac{1}{2}$。$Z_i$ 的属性如下：\n$$\n\\mathbb{E}[Z_i] = \\mathbb{E}\\left[X_i - \\frac{1}{2}\\right] = \\mathbb{E}[X_i] - \\frac{1}{2} = \\frac{1}{2} - \\frac{1}{2} = 0\n$$\n$$\n\\mathrm{Var}(Z_i) = \\mathrm{Var}\\left(X_i - \\frac{1}{2}\\right) = \\mathrm{Var}(X_i) = \\frac{1}{12}\n$$\n现在模型可以写成 $Y = Z_1 Z_2$。\n\n现在，我们计算总方差 $\\mathrm{Var}(Y)$。\n$Y$ 的期望是：\n$$\n\\mathbb{E}[Y] = \\mathbb{E}[Z_1 Z_2]\n$$\n由于 $X_1$ 和 $X_2$ 是独立的，因此 $Z_1$ 和 $Z_2$ 也是独立的。所以：\n$$\n\\mathbb{E}[Y] = \\mathbb{E}[Z_1]\\mathbb{E}[Z_2] = (0)(0) = 0\n$$\n$Y$ 的方差是 $\\mathrm{Var}(Y) = \\mathbb{E}[Y^2] - (\\mathbb{E}[Y])^2$。我们计算 $\\mathbb{E}[Y^2]$：\n$$\n\\mathbb{E}[Y^2] = \\mathbb{E}[(Z_1 Z_2)^2] = \\mathbb{E}[Z_1^2 Z_2^2]\n$$\n根据独立性，$\\mathbb{E}[Z_1^2 Z_2^2] = \\mathbb{E}[Z_1^2]\\mathbb{E}[Z_2^2]$。\n根据方差的定义，$\\mathrm{Var}(Z_i) = \\mathbb{E}[Z_i^2] - (\\mathbb{E}[Z_i])^2$。因为 $\\mathbb{E}[Z_i] = 0$，我们有 $\\mathbb{E}[Z_i^2] = \\mathrm{Var}(Z_i) = \\frac{1}{12}$。\n所以，\n$$\n\\mathbb{E}[Y^2] = \\left(\\frac{1}{12}\\right)\\left(\\frac{1}{12}\\right) = \\frac{1}{144}\n$$\n输出的总方差为：\n$$\n\\mathrm{Var}(Y) = \\frac{1}{144} - (0)^2 = \\frac{1}{144}\n$$\n接下来，我们验证一阶指数 $S_1$ 为 $0$。分子是 $\\mathrm{Var}(\\mathbb{E}[Y \\mid X_1])$。我们计算条件期望：\n$$\n\\mathbb{E}[Y \\mid X_1] = \\mathbb{E}\\left[\\left(X_1 - \\frac{1}{2}\\right)\\left(X_2 - \\frac{1}{2}\\right) \\mid X_1\\right]\n$$\n给定 $X_1$，项 $(X_1 - \\frac{1}{2})$ 是一个常数。\n$$\n\\mathbb{E}[Y \\mid X_1] = \\left(X_1 - \\frac{1}{2}\\right) \\mathbb{E}\\left[\\left(X_2 - \\frac{1}{2}\\right) \\mid X_1\\right]\n$$\n由于 $X_1$ 和 $X_2$ 的独立性，以 $X_1$ 为条件对 $X_2$ 的函数的期望没有影响。\n$$\n\\mathbb{E}\\left[\\left(X_2 - \\frac{1}{2}\\right) \\mid X_1\\right] = \\mathbb{E}\\left[X_2 - \\frac{1}{2}\\right] = \\mathbb{E}[X_2] - \\frac{1}{2} = 0\n$$\n因此，条件期望为：\n$$\n\\mathbb{E}[Y \\mid X_1] = \\left(X_1 - \\frac{1}{2}\\right) \\cdot 0 = 0\n$$\n常数的方差为零，所以 $\\mathrm{Var}(\\mathbb{E}[Y \\mid X_1]) = \\mathrm{Var}(0) = 0$。\n$X_1$ 的一阶指数是：\n$$\nS_1 = \\frac{\\mathrm{Var}(\\mathbb{E}[Y \\mid X_1])}{\\mathrm{Var}(Y)} = \\frac{0}{1/144} = 0\n$$\n这验证了给定条件。\n\n最后，我们确定全阶指数 $S_{T1}$。分子是 $\\mathbb{E}[\\mathrm{Var}(Y \\mid X_{\\sim 1})]$。对于这个双输入模型，$X_{\\sim 1}$ 就是输入 $X_2$。我们必须计算 $\\mathbb{E}[\\mathrm{Var}(Y \\mid X_2)]$。首先，我们求条件方差：\n$$\n\\mathrm{Var}(Y \\mid X_2) = \\mathrm{Var}\\left(\\left(X_1 - \\frac{1}{2}\\right)\\left(X_2 - \\frac{1}{2}\\right) \\mid X_2\\right)\n$$\n在以 $X_2$ 为条件的背景下，项 $(X_2 - \\frac{1}{2})$ 被视为一个常数因子。使用属性 $\\mathrm{Var}(aU) = a^2\\mathrm{Var}(U)$：\n$$\n\\mathrm{Var}(Y \\mid X_2) = \\left(X_2 - \\frac{1}{2}\\right)^2 \\mathrm{Var}\\left(\\left(X_1 - \\frac{1}{2}\\right) \\mid X_2\\right)\n$$\n根据独立性，$\\mathrm{Var}((X_1 - \\frac{1}{2}) \\mid X_2) = \\mathrm{Var}(X_1 - \\frac{1}{2}) = \\mathrm{Var}(X_1) = \\frac{1}{12}$。\n所以，条件方差是：\n$$\n\\mathrm{Var}(Y \\mid X_2) = \\frac{1}{12}\\left(X_2 - \\frac{1}{2}\\right)^2\n$$\n现在，我们对该量关于 $X_2$ 的分布求期望：\n$$\n\\mathbb{E}[\\mathrm{Var}(Y \\mid X_2)] = \\mathbb{E}\\left[\\frac{1}{12}\\left(X_2 - \\frac{1}{2}\\right)^2\\right] = \\frac{1}{12}\\mathbb{E}\\left[\\left(X_2 - \\frac{1}{2}\\right)^2\\right]\n$$\n项 $\\mathbb{E}[(X_2 - \\frac{1}{2})^2]$ 根据定义是 $X_2$ 的二阶中心矩，也就是 $X_2$ 的方差，因为 $\\mathbb{E}[X_2] = \\frac{1}{2}$。\n$$\n\\mathbb{E}\\left[\\left(X_2 - \\frac{1}{2}\\right)^2\\right] = \\mathrm{Var}(X_2) = \\frac{1}{12}\n$$\n因此，全阶指数的分子是：\n$$\n\\mathbb{E}[\\mathrm{Var}(Y \\mid X_2)] = \\frac{1}{12} \\cdot \\frac{1}{12} = \\frac{1}{144}\n$$\n最后，全阶指数 $S_{T1}$ 是：\n$$\nS_{T1} = \\frac{\\mathbb{E}[\\mathrm{Var}(Y \\mid X_{\\sim 1})]}{\\mathrm{Var}(Y)} = \\frac{1/144}{1/144} = 1\n$$\n$S_{T1} = 1$ 的结果表示输出 $Y$ 的所有方差都可归因于输入 $X_1$ 的直接效应（为零）及其交互作用。在这个特定模型中，方差纯粹源于 $X_1$ 和 $X_2$ 之间的交互作用。", "answer": "$$\\boxed{1}$$", "id": "2434812"}, {"introduction": "现在，让我们从解析练习转向一个实际的计算问题。我们将分析一个简化的工程模型——一座桥梁对随时间变化的载荷的响应，其中载荷历史被视为一个函数型输入。这个练习 [@problem_id:2434842] 要求你在代码中实现一阶 Sobol' 指数的计算公式，从而将抽象的理论与它在计算工程中对动力系统的应用联系起来。", "problem": "实现一个完整的程序，用于计算由时间离散化的函数式输入驱动的线性时不变模型输出的一阶基于方差的灵敏度指数。该模型代表一个被建模为单自由度（SDOF）振子的简支桥的单模态近似。在最终时间 $T$ 的模型输出是挠度响应，其被写为载荷时程的线性泛函。\n\n模型定义：\n- 设时间区间为 $[0,T]$，其中 $T0$。\n- 设 $N\\ge 2$ 为等间距时间样本的数量，时间步长为 $\\Delta t = T/(N-1)$，节点为 $t_i = i\\,\\Delta t$，其中 $i\\in\\{0,1,\\dots,N-1\\}$。\n- 设随机输入向量为 $U=(U_0,\\dots,U_{N-1})$，其分量相互独立，且给定 $\\mathbb{E}[U_i]=0$ 和 $\\operatorname{Var}(U_i)=\\sigma_i^2$。\n- 模型输出为\n$$\nY \\;=\\; \\sum_{i=0}^{N-1} h\\!\\left(T-t_i\\right)\\,U_i\\,\\Delta t,\n$$\n其中权重函数 $h$ 是单自由度单位脉冲响应\n$$\nh(\\tau) \\;=\\; \\frac{\\beta}{\\omega_d}\\, e^{-\\zeta\\,\\omega_n\\,\\tau}\\,\\sin\\!\\left(\\omega_d\\,\\tau\\right), \\quad \\tau\\ge 0,\n$$\n参数为 $\\omega_n0$（无阻尼固有频率），$0\\le \\zeta1$（阻尼比），$\\omega_d=\\omega_n\\sqrt{1-\\zeta^2}$（有阻尼固有频率），以及增益 $\\beta0$。$\\sin(\\cdot)$ 函数中使用的所有角度均以弧度为单位。\n\n任务：\n- 对于每组给定的参数集，计算在 $U$ 的分量相互独立的假设下，$Y$ 相对于分量 $(U_0,\\dots,U_{N-1})$ 的一阶基于方差的灵敏度指数向量 $S=(S_0,\\dots,S_{N-1})$。分量 $i$ 的一阶指数定义为\n$$\nS_i \\;=\\; \\frac{\\operatorname{Var}\\!\\left(\\mathbb{E}[\\,Y \\mid U_i\\,]\\right)}{\\operatorname{Var}(Y)}.\n$$\n\n测试套件：\n您的程序必须为以下四组参数集中的每一组计算 $S$。在每个项目中，元组列出了 $(T,N,\\omega_n,\\zeta,\\beta,\\{\\sigma_i^2\\}_{i=0}^{N-1})$。\n\n- 情况 $1$：$(T,N,\\omega_n,\\zeta,\\beta,\\{\\sigma_i^2\\}) = (\\,5.0,\\,5,\\,2.0,\\,0.1,\\,1.0,\\,[\\,1.0,\\,1.0,\\,1.0,\\,1.0,\\,1.0\\,]\\,)$。\n- 情况 $2$：$(T,N,\\omega_n,\\zeta,\\beta,\\{\\sigma_i^2\\}) = (\\,\\pi,\\,5,\\,1.0,\\,0.0,\\,1.0,\\,[\\,1.0,\\,1.0,\\,1.0,\\,1.0,\\,1.0\\,]\\,)$。\n- 情况 $3$：$(T,N,\\omega_n,\\zeta,\\beta,\\{\\sigma_i^2\\}) = (\\,4.0,\\,4,\\,1.5,\\,0.2,\\,1.0,\\,[\\,1.0,\\,0.0,\\,2.0,\\,0.0\\,]\\,)$。\n- 情况 $4$：$(T,N,\\omega_n,\\zeta,\\beta,\\{\\sigma_i^2\\}) = (\\,2.0,\\,6,\\,3.0,\\,0.05,\\,1.0,\\,[\\,0.5,\\,1.5,\\,0.2,\\,2.5,\\,1.0,\\,0.3\\,]\\,)$。\n\n答案规格：\n- 对于每种情况，返回列表 $[S_0,S_1,\\dots,S_{N-1}]$。\n- 您的程序应生成单行输出，其中包含结果，格式为由逗号分隔的列表的列表，并用方括号括起来，例如 $[\\,[\\cdot],\\,[\\cdot],\\,[\\cdot],\\,[\\cdot]\\,]$。\n- 每个 $S_i$ 必须以实数（浮点数）形式输出。输出中不需要物理单位。如上所述，角度以弧度为单位。", "solution": "此问题需要进行验证。\n\n步骤1：提取已知条件\n- 时间区间：$[0,T]$，其中 $T0$。\n- 时间离散化：$N\\ge 2$ 个样本，时间步长 $\\Delta t = T/(N-1)$，节点 $t_i = i\\,\\Delta t$，$i\\in\\{0,1,\\dots,N-1\\}$。\n- 随机输入：$U=(U_0,\\dots,U_{N-1})$，其分量 $U_i$ 相互独立，且 $\\mathbb{E}[U_i]=0$ 和 $\\operatorname{Var}(U_i)=\\sigma_i^2$。\n- 模型输出：$Y \\;=\\; \\sum_{i=0}^{N-1} h\\!\\left(T-t_i\\right)\\,U_i\\,\\Delta t$。\n- 权重函数（单位脉冲响应）：$h(\\tau) \\;=\\; \\frac{\\beta}{\\omega_d}\\, e^{-\\zeta\\,\\omega_n\\,\\tau}\\,\\sin\\!\\left(\\omega_d\\,\\tau\\right)$，其中 $\\tau\\ge 0$。\n- 函数参数：$\\omega_n0$，$0\\le \\zeta  1$，$\\omega_d=\\omega_n\\sqrt{1-\\zeta^2}$，$\\beta0$。\n- 任务：计算一阶基于方差的灵敏度指数向量 $S=(S_0,\\dots,S_{N-1})$，其中 $S_i \\;=\\; \\frac{\\operatorname{Var}\\!\\left(\\mathbb{E}[\\,Y \\mid U_i\\,]\\right)}{\\operatorname{Var}(Y)}$。\n- 测试数据：提供了四个不同的参数集。\n\n步骤2：验证\n- 该问题具有科学依据。它描述了一个标准的线性单自由度（SDOF）振子的灵敏度分析，这是物理学和工程学中的一个基本模型。基于方差的灵敏度分析方法（Sobol' 指数）是一种成熟且严谨的数学技术。\n- 该问题是适定的。所有必需的参数、函数形式和输入的统计特性都已定义。对参数的约束（$T0$，$N\\ge 2$，$\\omega_n0$，$0\\le \\zeta  1$）确保了物理模型的良定义，并避免了诸如除以零之类的奇点。对于每个给定的参数集，存在一个唯一的、稳定的灵敏度指数解。\n- 该问题是客观和形式化的。它使用精确的数学语言陈述，没有歧义或主观因素。\n\n步骤3：结论\n该问题是有效的。将提供一个合理的解决方案。\n\n模型输出 $Y$ 是随机输入变量 $U_i$ 的线性组合。我们可以将其写为：\n$$\nY = \\sum_{j=0}^{N-1} c_j U_j\n$$\n其中系数 $c_j$ 是确定性的，并由下式给出：\n$$\nc_j = h(T-t_j)\\,\\Delta t\n$$\n任务是为每个输入 $U_i$ 计算一阶灵敏度指数 $S_i$，其定义为：\n$$\nS_i = \\frac{\\operatorname{Var}(\\mathbb{E}[Y \\mid U_i])}{\\operatorname{Var}(Y)}\n$$\n我们必须首先计算输出的总方差 $\\operatorname{Var}(Y)$ 和偏方差 $\\operatorname{Var}(\\mathbb{E}[Y \\mid U_i])$。\n\n1. 总方差 $\\operatorname{Var}(Y)$ 的计算：\n输入变量 $U_j$ 是相互独立的。因此，$Y$ 的求和式中的项 $c_j U_j$ 也是相互独立的。独立随机变量之和的方差等于它们方差的和。\n$$\n\\operatorname{Var}(Y) = \\operatorname{Var}\\left(\\sum_{j=0}^{N-1} c_j U_j\\right) = \\sum_{j=0}^{N-1} \\operatorname{Var}(c_j U_j)\n$$\n对于常数 $a$ 和随机变量 $X$，使用属性 $\\operatorname{Var}(aX) = a^2\\operatorname{Var}(X)$，我们有：\n$$\n\\operatorname{Var}(c_j U_j) = c_j^2 \\operatorname{Var}(U_j) = c_j^2 \\sigma_j^2\n$$\n因此，总方差为：\n$$\n\\operatorname{Var}(Y) = \\sum_{j=0}^{N-1} c_j^2 \\sigma_j^2\n$$\n\n2. 偏方差 $\\operatorname{Var}(\\mathbb{E}[Y \\mid U_i])$ 的计算：\n首先，我们求条件期望 $\\mathbb{E}[Y \\mid U_i]$。根据期望的线性性质：\n$$\n\\mathbb{E}[Y \\mid U_i] = \\mathbb{E}\\left[\\sum_{j=0}^{N-1} c_j U_j \\;\\Bigg|\\; U_i\\right] = \\sum_{j=0}^{N-1} \\mathbb{E}[c_j U_j \\mid U_i]\n$$\n我们将求和式分为索引 $j=i$ 和所有索引 $j \\neq i$ 的情况：\n$$\n\\mathbb{E}[Y \\mid U_i] = \\mathbb{E}[c_i U_i \\mid U_i] + \\sum_{j \\neq i} \\mathbb{E}[c_j U_j \\mid U_i]\n$$\n对于项 $j=i$，$U_i$ 是已知的，所以 $\\mathbb{E}[c_i U_i \\mid U_i] = c_i U_i$。\n对于任何项 $j \\neq i$，$U_j$ 与 $U_i$ 独立。因此，以 $U_i$为条件不影响 $U_j$ 的期望。\n$$\n\\mathbb{E}[c_j U_j \\mid U_i] = c_j \\mathbb{E}[U_j]\n$$\n因为给定对于所有 $j$ 都有 $\\mathbb{E}[U_j] = 0$，所以此项为零。\n结合这些结果，条件期望简化为：\n$$\n\\mathbb{E}[Y \\mid U_i] = c_i U_i\n$$\n现在我们计算这个表达式的方差：\n$$\n\\operatorname{Var}(\\mathbb{E}[Y \\mid U_i]) = \\operatorname{Var}(c_i U_i) = c_i^2 \\operatorname{Var}(U_i) = c_i^2 \\sigma_i^2\n$$\n\n3. 灵敏度指数 $S_i$ 的公式：\n将总方差和偏方差的表达式代入 $S_i$ 的定义中：\n$$\nS_i = \\frac{c_i^2 \\sigma_i^2}{\\sum_{j=0}^{N-1} c_j^2 \\sigma_j^2}\n$$\n现在，我们代入 $c_j = h(T-t_j)\\Delta t$：\n$$\nS_i = \\frac{\\left(h(T-t_i)\\Delta t\\right)^2 \\sigma_i^2}{\\sum_{j=0}^{N-1} \\left(h(T-t_j)\\Delta t\\right)^2 \\sigma_j^2}\n$$\n因子 $(\\Delta t)^2$ 同时出现在分子和分母求和的每一项中，因此可以消去。这一消去显著简化了 $S_i$ 的表达式，消除了对 $\\Delta t$ 的依赖：\n$$\nS_i = \\frac{h(T-t_i)^2 \\sigma_i^2}{\\sum_{j=0}^{N-1} h(T-t_j)^2 \\sigma_j^2}\n$$\n这是用于计算的最终公式。如果分母中的总方差为零（这意味着输出 $Y$ 是一个常数），则分子中的所有偏方差也必须为零。在这种特殊情况下，输出对所有输入都不敏感，并且所有 $S_i$ 都定义为 $0$。\n\n算法如下：\n对于每组给定的参数集 $(T,N,\\omega_n,\\zeta,\\beta,\\{\\sigma_i^2\\})$：\n1.  计算时间点 $t_i = i \\frac{T}{N-1}$，其中 $i=0,\\dots,N-1$。\n2.  计算脉冲响应函数的参数：$\\tau_i = T - t_i$。\n3.  计算有阻尼固有频率 $\\omega_d = \\omega_n\\sqrt{1-\\zeta^2}$。\n4.  评估每个 $\\tau_i$ 的脉冲响应函数 $h_i = h(\\tau_i)$。\n5.  计算分子项（与偏方差成正比），$D_i = h_i^2 \\sigma_i^2$。\n6.  计算分母（与总方差成正比），$D = \\sum_{j=0}^{N-1} D_j$。\n7.  如果 $D=0$，则所有 $S_i$ 均为 $0$。否则，计算每个灵敏度指数为 $S_i = D_i / D$。\n8.  收集当前情况下的结果列表 $[S_0, \\dots, S_{N-1}]$。\n对所有四个测试用例重复此过程。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes first-order variance-based sensitivity indices for a linear SDOF model.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (5.0, 5, 2.0, 0.1, 1.0, [1.0, 1.0, 1.0, 1.0, 1.0]),\n        (np.pi, 5, 1.0, 0.0, 1.0, [1.0, 1.0, 1.0, 1.0, 1.0]),\n        (4.0, 4, 1.5, 0.2, 1.0, [1.0, 0.0, 2.0, 0.0]),\n        (2.0, 6, 3.0, 0.05, 1.0, [0.5, 1.5, 0.2, 2.5, 1.0, 0.3]),\n    ]\n\n    all_results = []\n    for case in test_cases:\n        T, N, wn, zeta, beta, sigma_sq_list = case\n        \n        # Convert list to numpy array for vectorized operations\n        sigma_sq = np.array(sigma_sq_list)\n\n        # 1. Calculate time points and arguments for h(tau)\n        # Time nodes t_i from 0 to T\n        t = np.linspace(0, T, N)\n        # Arguments for h are tau_i = T - t_i. This is equivalent to time-reversing\n        # the linspace from T to 0.\n        tau = np.linspace(T, 0, N)\n\n        # 2. Calculate derived physical parameters\n        # Damped natural frequency, wd\n        if zeta  1:\n            wd = wn * np.sqrt(1 - zeta**2)\n        else: # zeta == 1, critical damping case (though problem states zeta  1)\n            wd = 0\n            \n        # 3. Evaluate the impulse response function h(tau)\n        # h(tau) = (beta / wd) * exp(-zeta * wn * tau) * sin(wd * tau)\n        # For the case wd=0 (zeta=1), lim_{wd->0} sin(wd*tau)/wd = tau.\n        # Given zeta=0 for case 2, wd = wn.\n        if wd != 0:\n            h_coeffs = (beta / wd) * np.exp(-zeta * wn * tau) * np.sin(wd * tau)\n        else:\n            # Although the problem states zeta  1, let's handle the edge case for robustness.\n            # In Case 2, zeta=0, so wd=wn, not 0. This branch won't be hit with given data.\n            h_coeffs = beta * tau * np.exp(-wn * tau)\n\n        # 4. Calculate terms proportional to partial variances\n        # D_i = h(T-t_i)^2 * sigma_i^2\n        partial_vars = h_coeffs**2 * sigma_sq\n\n        # 5. Calculate term proportional to total variance\n        # D = sum(D_j)\n        total_var = np.sum(partial_vars)\n\n        # 6. Compute sensitivity indices S_i = D_i / D\n        if total_var == 0:\n            # If total variance is zero, output is constant, so it is insensitive to all inputs.\n            s_indices = np.zeros(N)\n        else:\n            s_indices = partial_vars / total_var\n\n        all_results.append(s_indices.tolist())\n\n    # Final print statement in the exact required format.\n    # The format is a string representation of a list of lists.\n    # map(str, ...) converts each inner list to its string form, e.g., '[0.1, 0.2]'.\n    # ','.join(...) joins these strings with commas.\n    # The outer f\"[{...}]\" wraps the result in brackets.\n    # e.g., \"[[0.1, 0.2],[0.3, 0.4]]\"\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```", "id": "2434842"}]}