{"hands_on_practices": [{"introduction": "多项式混沌展开（PCE）的一个主要优点是能够高效地计算模型输出的统计特性。本练习将演示如何直接从一个动态系统的PCE系数中计算随时间变化的方差，从而避免成本高昂的蒙特卡罗模拟。掌握这项技术是利用PCE进行不确定性分析的基础。[@problem_id:2448415]", "problem": "考虑一个标量随机输入 $\\,\\xi\\,$，其分布为 $\\xi \\sim \\mathrm{Uniform}(-1,1)$，并令 $\\{\\psi_{k}(\\xi)\\}_{k=0}^{\\infty}$ 表示关于 $\\,\\xi\\,$ 的概率测度的正交多项式基，其中 $\\psi_{0}(\\xi)=1$ 且对于所有非负整数 $\\,i,j\\,$，有 $\\mathbb{E}[\\psi_{i}(\\xi)\\,\\psi_{j}(\\xi)]=\\delta_{ij}$。一个随时间变化的模型输出 $\\,Y(t,\\xi)\\,$ 具有以下总阶为 $\\,3\\,$ 的截断多项式混沌展开 (PCE)：\n$$\nY(t,\\xi)=a_{0}(t)\\,\\psi_{0}(\\xi)+a_{1}(t)\\,\\psi_{1}(\\xi)+a_{2}(t)\\,\\psi_{2}(\\xi)+a_{3}(t)\\,\\psi_{3}(\\xi),\n$$\n其随时间变化的确定性系数为\n$$\na_{0}(t)=1+\\exp(-t),\\quad a_{1}(t)=t\\,\\exp\\!\\left(-\\frac{t}{2}\\right),\\quad a_{2}(t)=\\sin(t),\\quad a_{3}(t)=\\exp(-t)\\,\\cos(t).\n$$\n此处 $\\,t \\ge 0\\,$ 是时间，且所有三角函数的参数均以弧度为单位。计算随时间变化的方差 $\\,\\mathrm{Var}[Y(t)]\\,$，作为 $\\,t\\,$ 的闭式函数。将您的最终结果表示为关于 $\\,t\\,$ 的单个解析表达式。无需四舍五入。", "solution": "根据方差的定义，$\\mathrm{Var}[X] = \\mathbb{E}[X^2] - (\\mathbb{E}[X])^2$。我们将此定义应用于给定时间 $t$ 的随机过程 $Y(t, \\xi)$。\n\n首先，计算 $Y(t, \\xi)$ 的期望（均值）。利用期望算子 $\\mathbb{E}[\\cdot]$ 的线性以及基函数的正交性：\n$$ \\mathbb{E}[Y(t, \\xi)] = \\mathbb{E}\\left[ \\sum_{k=0}^{3} a_k(t) \\psi_k(\\xi) \\right] = \\sum_{k=0}^{3} a_k(t) \\mathbb{E}[\\psi_k(\\xi)] $$\n由于基是标准正交的且 $\\psi_0(\\xi)=1$，我们有 $\\mathbb{E}[\\psi_k(\\xi)] = \\mathbb{E}[\\psi_k(\\xi)\\psi_0(\\xi)] = \\delta_{k0}$。因此，只有 $k=0$ 的项非零：\n$$ \\mathbb{E}[Y(t, \\xi)] = a_0(t) \\cdot 1 + a_1(t) \\cdot 0 + a_2(t) \\cdot 0 + a_3(t) \\cdot 0 = a_0(t) $$\n过程的均值等于零阶 PCE 系数。\n\n接下来，计算二阶矩 $\\mathbb{E}[Y(t, \\xi)^2]$。\n$$ Y(t, \\xi)^2 = \\left( \\sum_{i=0}^{3} a_i(t) \\psi_i(\\xi) \\right) \\left( \\sum_{j=0}^{3} a_j(t) \\psi_j(\\xi) \\right) = \\sum_{i=0}^{3} \\sum_{j=0}^{3} a_i(t) a_j(t) \\psi_i(\\xi) \\psi_j(\\xi) $$\n取期望，并利用基函数的标准正交性 $\\mathbb{E}[\\psi_i(\\xi) \\psi_j(\\xi)] = \\delta_{ij}$：\n$$ \\mathbb{E}[Y(t, \\xi)^2] = \\sum_{i=0}^{3} \\sum_{j=0}^{3} a_i(t) a_j(t) \\mathbb{E}[\\psi_i(\\xi) \\psi_j(\\xi)] = \\sum_{i=0}^{3} \\sum_{j=0}^{3} a_i(t) a_j(t) \\delta_{ij} $$\n克罗内克 delta 将双重求和简化为单个求和（当 $i=j$ 时项非零）：\n$$ \\mathbb{E}[Y(t, \\xi)^2] = \\sum_{k=0}^{3} a_k(t)^2 = a_0(t)^2 + a_1(t)^2 + a_2(t)^2 + a_3(t)^2 $$\n这被称为 PCE 的帕塞瓦尔定理。\n\n最后，计算方差 $\\mathrm{Var}[Y(t)]$：\n$$ \\mathrm{Var}[Y(t)] = \\mathbb{E}[Y(t, \\xi)^2] - (\\mathbb{E}[Y(t, \\xi)])^2 = (a_0(t)^2 + a_1(t)^2 + a_2(t)^2 + a_3(t)^2) - (a_0(t))^2 $$\n$$ \\mathrm{Var}[Y(t)] = a_1(t)^2 + a_2(t)^2 + a_3(t)^2 = \\sum_{k=1}^{3} a_k(t)^2 $$\nPCE 的方差是所有高阶（$k \\ge 1$）系数的平方和。\n\n代入系数 $a_1(t)$、$a_2(t)$ 和 $a_3(t)$ 的函数形式：\n- $a_1(t)^2 = \\left(t\\,\\exp(-\\frac{t}{2})\\right)^2 = t^2 \\exp(-t)$\n- $a_2(t)^2 = \\sin^2(t)$\n- $a_3(t)^2 = \\left(\\exp(-t)\\,\\cos(t)\\right)^2 = \\exp(-2t)\\cos^2(t)$\n\n组合这些项，得到方差随时间 $t$ 变化的最终表达式：\n$$ \\mathrm{Var}[Y(t)] = t^2 \\exp(-t) + \\sin^2(t) + \\exp(-2t)\\cos^2(t) $$", "answer": "$$\n\\boxed{t^{2}\\exp(-t) + \\sin^{2}(t) + \\exp(-2t)\\cos^{2}(t)}\n$$", "id": "2448415"}, {"introduction": "理解对模型输出的数学运算如何影响其多项式混沌展开，是构建更复杂不确定性模型的关键。本练习探讨了PCE的线性性质，展示了一个对目标量的简单仿射变换如何转化为对其PCE系数的直接代数操作。这个练习将加深你对PCE作为函数基表示这一概念的理解。[@problem_id:2448490]", "problem": "一个具有单一参数不确定性来源的标量计算模型输出由多项式混沌展开 (PCE) 表示。设输入随机变量为 $\\,\\xi\\,$，服从标准正态分布 $\\,\\mathcal{N}(0,1)\\,$。考虑与高斯测度相关的正交基，该基由概率论学家的 Hermite 多项式构成，其前四个基函数为\n$$\\Phi_{0}(\\xi) = 1,\\quad \\Phi_{1}(\\xi) = \\xi,\\quad \\Phi_{2}(\\xi) = \\frac{\\xi^{2}-1}{\\sqrt{2}},\\quad \\Phi_{3}(\\xi) = \\frac{\\xi^{3}-3\\xi}{\\sqrt{6}},$$\n满足 $\\,\\mathbb{E}[\\Phi_{i}(\\xi)\\,\\Phi_{j}(\\xi)] = \\delta_{ij}\\,$。假设模型输出 $\\,Y(\\xi)\\,$ 接受一个截至总阶数 $\\,3\\,$ 的截断 PCE，\n$$Y(\\xi) \\;=\\; 3\\,\\Phi_{0}(\\xi)\\;-\\;\\frac{1}{2}\\,\\Phi_{1}(\\xi)\\;+\\;\\sqrt{2}\\,\\Phi_{2}(\\xi)\\;-\\;2\\,\\Phi_{3}(\\xi).$$\n定义仿射变换后的输出 $\\,Z(\\xi) = a\\,Y(\\xi) + b\\,$，其中 $\\,a=-4\\,$ 和 $\\,b=5\\,$ 是确定性的无量纲常数。在同一基 $\\,\\{\\Phi_{k}(\\xi)\\}_{k=0}^{3}\\,$ 下，确定 $\\,Z(\\xi)\\,$ 的 PCE。请将您的最终答案表示为关于 $\\,\\Phi_{0}(\\xi),\\Phi_{1}(\\xi),\\Phi_{2}(\\xi),\\Phi_{3}(\\xi)\\,$ 的单一闭式解析表达式。请勿对答案进行四舍五入。", "solution": "我们的目标是找到 $Z(\\xi)$ 在基 $\\{\\Phi_k(\\xi)\\}_{k=0}^{3}$ 上的多项式混沌展开 (PCE) 表示。\n我们从 $Z(\\xi)$ 的定义开始：\n$$Z(\\xi) = a\\,Y(\\xi) + b$$\n将已知的 $Y(\\xi)$ 的 PCE 表达式代入：\n$$Y(\\xi) \\;=\\; 3\\,\\Phi_{0}(\\xi)\\;-\\;\\frac{1}{2}\\,\\Phi_{1}(\\xi)\\;+\\;\\sqrt{2}\\,\\Phi_{2}(\\xi)\\;-\\;2\\,\\Phi_{3}(\\xi)$$\n得到：\n$$Z(\\xi) = a \\left( 3\\,\\Phi_{0}(\\xi)\\;-\\;\\frac{1}{2}\\,\\Phi_{1}(\\xi)\\;+\\;\\sqrt{2}\\,\\Phi_{2}(\\xi)\\;-\\;2\\,\\Phi_{3}(\\xi) \\right) + b$$\n分配常数 $a$ 到括号内的每一项：\n$$Z(\\xi) = 3a\\,\\Phi_{0}(\\xi)\\;-\\;\\frac{a}{2}\\,\\Phi_{1}(\\xi)\\;+\\;a\\sqrt{2}\\,\\Phi_{2}(\\xi)\\;-\\;2a\\,\\Phi_{3}(\\xi) + b$$\n为了将 $Z(\\xi)$ 完全表示为基函数的线性组合，我们需要用基来表示常数项 $b$。根据定义，第一个基函数是 $\\Phi_{0}(\\xi) = 1$，因此我们可以将 $b$ 写为 $b \\cdot 1 = b\\,\\Phi_{0}(\\xi)$。\n\n将此代回 $Z(\\xi)$ 的表达式中：\n$$Z(\\xi) = 3a\\,\\Phi_{0}(\\xi)\\;-\\;\\frac{a}{2}\\,\\Phi_{1}(\\xi)\\;+\\;a\\sqrt{2}\\,\\Phi_{2}(\\xi)\\;-\\;2a\\,\\Phi_{3}(\\xi) + b\\,\\Phi_{0}(\\xi)$$\n现在，合并 $\\Phi_{0}(\\xi)$ 的系数：\n$$Z(\\xi) = (3a+b)\\,\\Phi_{0}(\\xi)\\;-\\;\\frac{a}{2}\\,\\Phi_{1}(\\xi)\\;+\\;a\\sqrt{2}\\,\\Phi_{2}(\\xi)\\;-\\;2a\\,\\Phi_{3}(\\xi)$$\n这就是 $Z(\\xi)$ 的 PCE 形式。其系数 $z_k$ 为：\n- $z_0 = 3a+b$\n- $z_1 = -\\frac{a}{2}$\n- $z_2 = a\\sqrt{2}$\n- $z_3 = -2a$\n\n最后，代入给定的常数值 $a=-4$ 和 $b=5$：\n- $z_0 = 3(-4) + 5 = -12 + 5 = -7$\n- $z_1 = -\\frac{(-4)}{2} = \\frac{4}{2} = 2$\n- $z_2 = (-4)\\sqrt{2} = -4\\sqrt{2}$\n- $z_3 = -2(-4) = 8$\n\n因此，$Z(\\xi)$ 的最终 PCE 表达式为：\n$$Z(\\xi) \\;=\\; -7\\,\\Phi_{0}(\\xi) \\;+\\; 2\\,\\Phi_{1}(\\xi) \\;-\\; 4\\sqrt{2}\\,\\Phi_{2}(\\xi) \\;+\\; 8\\,\\Phi_{3}(\\xi)$$", "answer": "$$\n\\boxed{-7\\,\\Phi_{0}(\\xi) + 2\\,\\Phi_{1}(\\xi) - 4\\sqrt{2}\\,\\Phi_{2}(\\xi) + 8\\,\\Phi_{3}(\\xi)}\n$$", "id": "2448490"}, {"introduction": "除了计算基本统计量，PCE还为全局敏感性分析（GSA）提供了一个强大的框架，用于量化输入不确定性对输出方差的贡献。在这个高级练习中，你将使用著名的Ishigami函数的PCE代理模型来计算Sobol'指数，并将其与精确的解析解进行比较。这突显了PCE在识别复杂模型中最具影响力的参数方面的强大能力。[@problem_id:2448434]", "problem": "考虑 Ishigami 函数，其为独立输入随机变量 $x_1$、$x_2$ 和 $x_3$ 的函数，每个变量都在区间 $\\left[-\\pi,\\pi\\right]$ 上均匀分布，定义如下：\n$$\nf(x_1,x_2,x_3) \\;=\\; \\sin(x_1) \\;+\\; a\\,\\sin^2(x_2) \\;+\\; b\\,x_3^4\\,\\sin(x_1),\n$$\n其中 $a$ 和 $b$ 是固定的实数参数，所有角度均以弧度为单位。令 $S_i$ 表示输入 $x_i$ 的一阶 Sobol' 指数，$S_{ij}$ 表示描述输入 $x_i$ 和 $x_j$ 之间交互作用的二阶 Sobol' 指数。请从第一性原理出发，推导方差分解以及 Sobol' 指数 $S_1$、$S_2$、$S_3$、$S_{12}$、$S_{13}$ 和 $S_{23}$ 作为 $a$、$b$ 和 $\\pi$ 的函数的解析公式。然后，对于下面测试套件中的每个参数集，在给定独立均匀输入的正确正交多项式基下，构建 $f$ 的三阶多项式混沌展开 (Polynomial Chaos Expansion, PCE)，使用该截断的 PCE 计算相应的基于 PCE 的 Sobol' 指数 $S_1$、$S_2$、$S_3$、$S_{12}$、$S_{13}$ 和 $S_{23}$，并将它们与解析指数进行比较。\n\n您的程序必须实现以下参数值 $(a,b)$ 的测试套件：\n- 测试 $1$：$(a,b) = (7,\\,0.1)$，\n- 测试 $2$：$(a,b) = (7,\\,0)$，\n- 测试 $3$：$(a,b) = (0,\\,0.1)$，\n- 测试 $4$：$(a,b) = (0,\\,0)$。\n\n对于每个测试，计算基于 PCE 的指数和解析指数在集合 $\\{S_1,S_2,S_3,S_{12},S_{13},S_{23}\\}$ 上的绝对差，并返回该测试的最大绝对差，结果为一个实数。\n\n您的程序应生成单行输出，其中包含测试 1 到 4 的结果，格式为方括号括起来的逗号分隔列表（例如 $[r_1,r_2,r_3,r_4]$），其中每个 $r_i$ 是测试 $i$ 的最大绝对差，表示为浮点数。不允许有其他输出。", "solution": "该问题的解决方案分为三个部分：首先，从第一性原理推导 Ishigami 函数的解析 Sobol' 指数；其次，概述如何通过构建三阶多项式混沌展开 (PCE) 来近似这些指数；最后，通过执行 Python 代码来完成数值计算和比较。\n\n### 第 1 部分：解析 Sobol' 指数推导\n\n为了计算 Sobol' 指数，我们首先对函数 $f(x_1, x_2, x_3)$ 进行 ANOVA (Analysis of Variance) 或 Hoeffding-Sobol' 分解。输入变量 $x_i$ 是独立同分布的，$x_i \\sim U[-\\pi, \\pi]$，其概率密度函数为 $p(x) = 1/(2\\pi)$。\n\n首先，计算所需函数的期望：\n- $E[\\sin(x)] = 0$\n- $E[\\sin^2(x)] = \\frac{1}{2\\pi} \\int_{-\\pi}^{\\pi} \\sin^2(x) dx = \\frac{1}{2}$\n- $E[x^4] = \\frac{1}{2\\pi} \\int_{-\\pi}^{\\pi} x^4 dx = \\frac{\\pi^4}{5}$\n- $E[x^8] = \\frac{\\pi^8}{9}$\n\nANOVA 分解将 $f$ 表示为维度递增的项之和：\n$$f(x_1, x_2, x_3) = f_0 + \\sum_{i=1}^3 f_i(x_i) + \\sum_{1 \\le i  j \\le 3} f_{ij}(x_i, x_j) + f_{123}(x_1, x_2, x_3)$$\n\n各项计算如下：\n- **均值 ($f_0$)：**\n$f_0 = E[f] = E[\\sin(x_1) + a\\sin^2(x_2) + bx_3^4\\sin(x_1)] = E[\\sin(x_1)] + aE[\\sin^2(x_2)] + bE[x_3^4]E[\\sin(x_1)] = \\frac{a}{2}$。\n\n- **一阶项 ($f_i$)：** $f_i(x_i) = E[f | x_i] - f_0$。\n$f_1(x_1) = (E[f|x_1] - f_0) = (1 + b\\frac{\\pi^4}{5})\\sin(x_1)$。\n$f_2(x_2) = (E[f|x_2] - f_0) = a(\\sin^2(x_2) - \\frac{1}{2})$。\n$f_3(x_3) = (E[f|x_3] - f_0) = 0$。\n\n- **二阶项 ($f_{ij}$)：** $f_{ij}(x_i, x_j) = E[f | x_i, x_j] - f_i(x_i) - f_j(x_j) - f_0$。\n$f_{12}(x_1,x_2) = 0$。\n$f_{13}(x_1,x_3) = b(x_3^4 - \\frac{\\pi^4}{5})\\sin(x_1)$。\n$f_{23}(x_2,x_3) = 0$。\n\n所有更高阶的项均为零。\n\n偏方差 $D_u = \\text{Var}[f_u]$ 计算如下：\n$D_1 = \\text{Var}[f_1] = (1 + b\\frac{\\pi^4}{5})^2 \\text{Var}[\\sin(x_1)] = \\frac{1}{2}(1 + b\\frac{\\pi^4}{5})^2$。\n$D_2 = \\text{Var}[f_2] = a^2 \\text{Var}[\\sin^2(x_2)] = a^2(E[\\sin^4(x_2)] - (E[\\sin^2(x_2)])^2) = \\frac{a^2}{8}$。\n$D_3 = 0$。\n$D_{12} = 0$。\n$D_{13} = \\text{Var}[f_{13}] = b^2 \\text{Var}[\\sin(x_1)] \\text{Var}[x_3^4] = b^2 (\\frac{1}{2}) (E[x_3^8] - (E[x_3^4])^2) = \\frac{8b^2\\pi^8}{225}$。\n$D_{23} = 0$。\n\n总方差 $D = \\text{Var}[f]$ 是所有偏方差之和：\n$D = D_1 + D_2 + D_{13} = \\frac{a^2}{8} + \\frac{b^2\\pi^8}{18} + \\frac{b\\pi^4}{5} + \\frac{1}{2}$。\n\nSobol' 指数由 $S_u = D_u/D$ 给出，因此：\n$S_1 = D_1/D$, $S_2 = D_2/D$, $S_3=0$, $S_{12}=0$, $S_{13}=D_{13}/D$, $S_{23}=0$。\n\n### 第 2 部分：基于 PCE 的 Sobol' 指数计算\n\n我们使用三阶 ($p=3$) PCE 来近似 Ishigami 函数。首先将输入 $x_i \\in [-\\pi, \\pi]$ 映射到标准均匀变量 $\\zeta_i \\sim U[-1, 1]$ 上，即 $x_i = \\pi\\zeta_i$。相应的正交基由归一化的 Legendre 多项式 $\\{\\Phi_\\alpha(\\zeta)\\}$ 构成。\n\n$f$ 的 PCE 形式为：\n$$f(x(\\zeta)) \\approx \\sum_{|\\alpha| \\le 3} c_\\alpha \\Phi_\\alpha(\\zeta)$$\n其中系数 $c_\\alpha$ 通过谱投影积分计算：\n$$c_\\alpha = E[f(x(\\zeta)) \\Phi_\\alpha(\\zeta)]$$\n\n基于 PCE 的偏方差可从系数的平方和中得到：\n$D_1^{PCE} = \\sum_{\\alpha:\\text{supp}(\\alpha)=\\{1\\}} c_\\alpha^2$\n$D_2^{PCE} = \\sum_{\\alpha:\\text{supp}(\\alpha)=\\{2\\}} c_\\alpha^2$\n$D_{13}^{PCE} = \\sum_{\\alpha:\\text{supp}(\\alpha)=\\{1,3\\}} c_\\alpha^2$\nPCE 近似的总方差为 $D^{PCE} = \\sum_{\\alpha \\ne 0} c_\\alpha^2 = D_1^{PCE} + D_2^{PCE} + D_{13}^{PCE}$ (因为其他偏方差为零)。\n基于 PCE 的 Sobol' 指数则为 $S_u^{PCE} = D_u^{PCE} / D^{PCE}$。\n\n### 第 3 部分：数值实现与比较\n\n对于每个测试用例 $(a,b)$，我们将执行以下步骤：\n1.  使用上述解析公式计算精确的 Sobol' 指数。\n2.  使用数值积分（在提供的 Python 代码中通过 `scipy.integrate.quad` 实现）计算相关的 PCE 系数。\n3.  使用这些系数计算基于 PCE 的 Sobol' 指数。\n4.  计算两组指数 $\\{S_1, S_2, S_3, S_{12}, S_{13}, S_{23}\\}$ 之间的最大绝对差。\n\n最终答案由提供的 Python 脚本生成，该脚本实现了这些计算。", "answer": "```python\nimport numpy as np\nfrom scipy.integrate import quad\nfrom scipy.special import legendre\n\ndef get_pce_coefficients(a, b):\n    \"\"\"\n    Computes the required PCE coefficients c_alpha for the Ishigami function\n    using numerical quadrature. The expansion is of total order 3.\n    \"\"\"\n    pi = np.pi\n\n    # Define the functions of single variables to be projected onto the Legendre basis\n    g1 = lambda z: np.sin(pi * z)\n    g2 = lambda z: np.sin(pi * z)**2\n    g3 = lambda z: z**4\n\n    # Standard Legendre polynomials from scipy.special\n    leg_1 = legendre(1)\n    leg_2 = legendre(2)\n    leg_3 = legendre(3)\n\n    def compute_projection(g, k, leg_poly):\n        \"\"\"\n        Computes E[g(zeta) * P_k(zeta)], where P_k are orthonormal Legendre polynomials.\n        E[h] = integral(h(z) * 1/2 dz) from -1 to 1.\n        P_k(z) = sqrt(2k+1) * leg_k(z).\n        \"\"\"\n        integrand = lambda z: g(z) * leg_poly(z)\n        integral_val, _ = quad(integrand, -1, 1)\n        # The projection E[g * P_k] is (sqrt(2k+1)/2) * integral(g * leg_k dz)\n        return np.sqrt(2 * k + 1) / 2.0 * integral_val\n\n    # Calculate the required projection components I(g, k)\n    I_g1_k1 = compute_projection(g1, 1, leg_1)\n    I_g1_k3 = compute_projection(g1, 3, leg_3)\n    I_g2_k2 = compute_projection(g2, 2, leg_2)\n    I_g3_k2 = compute_projection(g3, 2, leg_2)\n    \n    # E[zeta^4] for zeta ~ U[-1,1] is 1/5\n    E_zeta4 = 1.0 / 5.0\n    \n    # Assemble the non-zero coefficients based on analytical derivation\n    # c_100 and c_300 come from the sin(x1) term (with interaction)\n    c100 = I_g1_k1 * (1 + b * pi**4 * E_zeta4)\n    c300 = I_g1_k3 * (1 + b * pi**4 * E_zeta4)\n    # c_020 comes from the a*sin^2(x2) term\n    c020 = a * I_g2_k2\n    # c_102 comes from the interaction term b*x3^4*sin(x1)\n    c102 = b * pi**4 * I_g1_k1 * I_g3_k2\n    \n    return c100, c300, c020, c102\n\ndef analytical_sobol(a, b):\n    \"\"\"\n    Computes the analytical Sobol' indices for the Ishigami function\n    with parameters a and b.\n    \"\"\"\n    pi = np.pi\n    pi4 = pi**4\n    pi8 = pi**8\n\n    # Total Variance D = Var[f]\n    D = (a**2 / 8.0) + (b**2 * pi8 / 18.0) + (b * pi4 / 5.0) + 0.5\n\n    if D == 0:\n        return {'S1': 0.0, 'S2': 0.0, 'S3': 0.0, 'S12': 0.0, 'S13': 0.0, 'S23': 0.0}\n\n    # Partial Variances\n    D1 = 0.5 * (1 + b * pi4 / 5.0)**2\n    D2 = a**2 / 8.0\n    D13 = 8.0 * b**2 * pi8 / 225.0\n\n    return {\n        'S1': D1 / D, 'S2': D2 / D, 'S3': 0.0,\n        'S12': 0.0, 'S13': D13 / D, 'S23': 0.0\n    }\n\ndef pce_sobol(a, b):\n    \"\"\"\n    Computes the Sobol' indices based on a 3rd-order PCE.\n    \"\"\"\n    c100, c300, c020, c102 = get_pce_coefficients(a, b)\n\n    # PCE-based partial variances\n    D1_pce = c100**2 + c300**2\n    D2_pce = c020**2\n    D13_pce = c102**2\n    \n    # Total variance from the truncated PCE\n    D_pce = D1_pce + D2_pce + D13_pce\n\n    if D_pce == 0:\n       return {'S1': 0.0, 'S2': 0.0, 'S3': 0.0, 'S12': 0.0, 'S13': 0.0, 'S23': 0.0}\n\n    return {\n        'S1': D1_pce / D_pce, 'S2': D2_pce / D_pce, 'S3': 0.0,\n        'S12': 0.0, 'S13': D13_pce / D_pce, 'S23': 0.0\n    }\n\ndef solve():\n    \"\"\"\n    Main function to execute the validation for the given test suite.\n    \"\"\"\n    test_cases = [\n        (7.0, 0.1),\n        (7.0, 0.0),\n        (0.0, 0.1),\n        (0.0, 0.0)\n    ]\n\n    results = []\n    \n    index_keys = ['S1', 'S2', 'S3', 'S12', 'S13', 'S23']\n\n    for a, b in test_cases:\n        analytical_indices = analytical_sobol(a, b)\n        pce_indices = pce_sobol(a, b)\n        \n        abs_diffs = [\n            np.abs(analytical_indices[key] - pce_indices[key]) for key in index_keys\n        ]\n        \n        max_abs_diff = max(abs_diffs)\n        results.append(max_abs_diff)\n        \n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2448434"}]}