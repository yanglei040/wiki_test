{"hands_on_practices": [{"introduction": "稳态与非稳态流动是流体动力学中的核心概念，一个常见的误区是将稳态雷诺平均纳维-斯托克斯（RANS）模型应用于本质上非稳态的流动。本练习以经典的圆柱绕流为案例，要求您确定一个精确的临界点（即临界雷诺数 $Re_{\\text{crit}}$），在该点之后，由于周期性的涡脱落现象，稳态模型在物理上变得不再有效。这项实践有助于您建立关于如何选择正确建模方法的基础直觉 [@problem_id:2447854]。", "problem": "您需要编写一个完整、可运行的程序，用于确定稳态雷诺平均纳维-斯托克斯 (RANS) 模型在何种条件下因周期性涡旋脱落的发生而对绕圆柱流动问题变得物理上无效，并计算在给定几何形状和流体下的相应最小自由来流速度。整个推导过程必须基于第一性原理和广为接受的事实。\n\n从不可压缩纳维-斯托克斯方程及其无量纲化出发，定义雷诺数。设 $U_\\infty$ 为自由来流速度（单位：$\\mathrm{m/s}$），$D$ 为圆柱直径（单位：$\\mathrm{m}$），$\\nu$ 为运动粘度（单位：$\\mathrm{m^2/s}$）。雷诺数的定义为 $Re = U_\\infty D / \\nu$。一个公认的实验和计算事实是，在无界均匀流中，二维圆柱尾流会在一个临界雷诺数（无量纲）下经历超临界霍普夫分岔，高于该雷诺数时，会形成冯·卡门涡街，瞬时流场变为时间周期性的。在该流态下，雷诺平均方程的严格稳态解无法代表真实的瞬时动力学过程，因此求解得到时间无关场的一个稳态 RANS 模型对于捕捉物理上的非稳态性是无效的。此时，必须采用非稳态方法，如非稳态雷诺平均纳维-斯托克斯 (URANS)、大涡模拟 (LES) 或直接数值模拟 (DNS)。\n\n您的任务是：\n- 使用上述基础理论和公认的无界圆柱后周期性涡旋脱落起始的临界雷诺数（无量纲），确定稳态 RANS 模型因涡旋脱落而失效的最小雷诺数 $Re_\\text{crit}$。\n- 对于下述每个测试案例，计算产生 $Re = Re_\\text{crit}$ 的最小自由来流速度 $U_{\\infty,\\min}$（单位：$\\mathrm{m/s}$）。使用精确关系式 $U_{\\infty,\\min} = Re_\\text{crit} \\, \\nu / D$。\n- 将每个 $U_{\\infty,\\min}$ 以 $\\mathrm{m/s}$ 为单位表示，并四舍五入到六位小数。\n- 您的程序必须输出一行，包含一个用方括号括起来的逗号分隔列表。该列表必须以 $Re_\\text{crit}$ 作为第一项（表示为浮点数），其后是四个测试案例的四个 $U_{\\infty,\\min}$ 值，每个值都四舍五入到六位小数，并按下述顺序排列。\n\n测试套件（每个测试案例提供 $(D,\\nu)$）：\n1. 案例 A（标称空气流过小圆柱）：$D = 0.05\\,\\mathrm{m}$，$\\nu = 1.5\\times 10^{-5}\\,\\mathrm{m^2/s}$。\n2. 案例 B（淡水流过中等尺寸圆柱）：$D = 0.10\\,\\mathrm{m}$，$\\nu = 1.0\\times 10^{-6}\\,\\mathrm{m^2/s}$。\n3. 案例 C（微流体力学中的粘性油）：$D = 1.0\\times 10^{-3}\\,\\mathrm{m}$，$\\nu = 1.0\\times 10^{-4}\\,\\mathrm{m^2/s}$。\n4. 案例 D（空气流过细纤维）：$D = 1.0\\times 10^{-4}\\,\\mathrm{m}$，$\\nu = 1.5\\times 10^{-5}\\,\\mathrm{m^2/s}$。\n\n最终输出格式：\n- 一行列表：$[Re_\\text{crit}, U_{\\infty,\\min}^{(A)}, U_{\\infty,\\min}^{(B)}, U_{\\infty,\\min}^{(C)}, U_{\\infty,\\min}^{(D)}]$，其中所有条目均为浮点数。四个速度值必须以 $\\mathrm{m/s}$ 为单位，并四舍五入到六位小数。\n\n您的程序必须是自包含的，且不需要任何输入。它必须实现上述逻辑，并仅打印指定格式的列表行。", "solution": "我们从流体力学和计算工程中的第一性原理和经过充分检验的事实出发。\n\n1. 控制方程和无量纲化。对于速度 $\\mathbf{u}(\\mathbf{x},t)$ 和压力 $p(\\mathbf{x},t)$，密度为 $\\rho$，运动粘度为 $\\nu$ 的不可压缩纳维-斯托克斯方程为\n$$\n\\frac{\\partial \\mathbf{u}}{\\partial t} + \\left(\\mathbf{u}\\cdot\\nabla\\right)\\mathbf{u} = -\\frac{1}{\\rho}\\nabla p + \\nu \\nabla^2 \\mathbf{u}, \\quad \\nabla\\cdot \\mathbf{u} = 0.\n$$\n引入特征速度 $U_\\infty$（自由来流速度）和特征长度 $D$（圆柱直径），定义无量纲变量为 $\\tilde{\\mathbf{u}}=\\mathbf{u}/U_\\infty$, $\\tilde{\\mathbf{x}}=\\mathbf{x}/D$ 和 $\\tilde{t}=t U_\\infty / D$。代入后可得到无量纲形式\n$$\n\\frac{\\partial \\tilde{\\mathbf{u}}}{\\partial \\tilde{t}} + \\left(\\tilde{\\mathbf{u}}\\cdot\\tilde{\\nabla}\\right)\\tilde{\\mathbf{u}} = -\\tilde{\\nabla} \\tilde{p} + \\frac{1}{Re} \\tilde{\\nabla}^2 \\tilde{\\mathbf{u}}, \\quad \\tilde{\\nabla}\\cdot \\tilde{\\mathbf{u}} = 0,\n$$\n其中雷诺数为\n$$\nRe = \\frac{U_\\infty D}{\\nu}.\n$$\n这个无量纲数控制着惯性力与粘性力的相对重要性。\n\n2. 涡旋脱落的判据。对于无界均匀流中的圆柱，二维稳态基本流在临界雷诺数下通过超临界霍普夫分岔失去稳定性。这是一个被实验和直接数值模拟广泛验证的结果。将该临界值记为 $Re_\\text{crit}$。当 $Re  Re_\\text{crit}$ 时，稳态解是稳定的，流动保持稳态；当 $Re > Re_\\text{crit}$ 时，出现时间周期性的冯·卡门涡街。\n\n3. 对稳态雷诺平均纳维-斯托克斯 (RANS) 的影响。一个稳态 RANS 模型，当求解得到时间无关的场时，无法捕捉因全局振荡模态而本质上非稳态的流动的物理特性。因此，严格稳态 RANS 解在表征瞬时行为方面变得物理上无效的最小雷诺数恰好是分岔阈值 $Re_\\text{crit}$。\n\n4. 确定 $Re_\\text{crit}$ 和最小速度。临界值 $Re_\\text{crit}$ 是一个公认的基准值，约等于\n$$\nRe_\\text{crit} \\approx 47.\n$$\n给定任意圆柱直径 $D$ 和运动粘度 $\\nu$，达到此阈值的最小自由来流速度可通过求解 $Re_\\text{crit} = U_{\\infty,\\min} D / \\nu$ 得到 $U_{\\infty,\\min}$：\n$$\nU_{\\infty,\\min} = \\frac{Re_\\text{crit}\\, \\nu}{D}.\n$$\n\n5. 应用于测试套件。对每个案例，计算 $U_{\\infty,\\min}$ 并以 $\\mathrm{m/s}$ 为单位四舍五入到六位小数。\n\n- 案例 A：$D = 0.05\\,\\mathrm{m}$，$\\nu = 1.5\\times 10^{-5}\\,\\mathrm{m^2/s}$。\n计算\n$$\nU_{\\infty,\\min}^{(A)} = \\frac{47 \\times 1.5\\times 10^{-5}}{0.05} = 47 \\times 3.0\\times 10^{-4} = 1.41\\times 10^{-2}\\,\\mathrm{m/s} = 0.0141\\,\\mathrm{m/s}.\n$$\n四舍五入后：$0.014100\\,\\mathrm{m/s}$。\n\n- 案例 B：$D = 0.10\\,\\mathrm{m}$，$\\nu = 1.0\\times 10^{-6}\\,\\mathrm{m^2/s}$。\n计算\n$$\nU_{\\infty,\\min}^{(B)} = \\frac{47 \\times 1.0\\times 10^{-6}}{0.10} = 4.7\\times 10^{-4}\\,\\mathrm{m/s} = 0.00047\\,\\mathrm{m/s}.\n$$\n四舍五入后：$0.000470\\,\\mathrm{m/s}$。\n\n- 案例 C：$D = 1.0\\times 10^{-3}\\,\\mathrm{m}$，$\\nu = 1.0\\times 10^{-4}\\,\\mathrm{m^2/s}$。\n计算\n$$\nU_{\\infty,\\min}^{(C)} = \\frac{47 \\times 1.0\\times 10^{-4}}{1.0\\times 10^{-3}} = 47 \\times 0.1 = 4.7\\,\\mathrm{m/s}.\n$$\n四舍五入后：$4.700000\\,\\mathrm{m/s}$。\n\n- 案例 D：$D = 1.0\\times 10^{-4}\\,\\mathrm{m}$，$\\nu = 1.5\\times 10^{-5}\\,\\mathrm{m^2/s}$。\n计算\n$$\nU_{\\infty,\\min}^{(D)} = \\frac{47 \\times 1.5\\times 10^{-5}}{1.0\\times 10^{-4}} = 47 \\times 0.15 = 7.05\\,\\mathrm{m/s}.\n$$\n四舍五入后：$7.050000\\,\\mathrm{m/s}$。\n\n6. 最终要求输出。程序必须打印一行列表\n$$\n[Re_\\text{crit}, U_{\\infty,\\min}^{(A)}, U_{\\infty,\\min}^{(B)}, U_{\\infty,\\min}^{(C)}, U_{\\infty,\\min}^{(D)}],\n$$\n所有条目均为浮点数，四个速度值四舍五入到六位小数。使用 $Re_\\text{crit} = 47$ 和计算出的值，预期的数值输出为\n$$\n[47.000000, 0.014100, 0.000470, 4.700000, 7.050000].\n$$\n\n算法设计：\n- 将 $Re_\\text{crit}$ 存储为常量。\n- 对于每个测试案例 $(D,\\nu)$，计算 $U_{\\infty,\\min} = Re_\\text{crit}\\, \\nu / D$。\n- 将输出格式化为单个列表字符串，每个条目保留六位小数。为保持一致性，第一项 $Re_\\text{crit}$ 也格式化为六位小数。\n- 仅打印指定行。\n\n该方法将雷诺数的基本定义与经过充分验证的圆柱尾流不稳定性临界阈值相结合，从而统一了稳态 RANS、非稳态 RANS (URANS)、大涡模拟 (LES) 和直接数值模拟 (DNS) 之间的模型选择。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    # Critical Reynolds number for onset of vortex shedding behind an unconfined circular cylinder\n    Re_crit = 47.0\n\n    # Test cases: (D in m, nu in m^2/s)\n    test_cases = [\n        (0.05, 1.5e-5),    # Case A: air over small cylinder\n        (0.10, 1.0e-6),    # Case B: water over medium cylinder\n        (1.0e-3, 1.0e-4),  # Case C: viscous oil in micro-hydrodynamics\n        (1.0e-4, 1.5e-5),  # Case D: air over thin fiber\n    ]\n\n    results = [Re_crit]\n    for D, nu in test_cases:\n        U_min = Re_crit * nu / D  # m/s\n        results.append(U_min)\n\n    # Format all entries with six decimal places\n    formatted = \"[\" + \",\".join(f\"{x:.6f}\" for x in results) + \"]\"\n    print(formatted)\n\nsolve()\n```", "id": "2447854"}, {"introduction": "在了解了何时使用RANS模型之后，下一步是理解其内在的局限性。大多数商用RANS模型都基于Boussinesq涡粘假设，但在复杂流动中，这一假设存在根本性缺陷。这项分析练习将挑战您扮演计算流体力学（CFD）分析师的角色，将Boussinesq模型的预测与弯曲管道流动的“地面真实”（ground truth）直接数值模拟（DNS）数据进行比较，从而明确指出该模型在结构上无法捕捉哪些物理现象 [@problem_id:2447865]。", "problem": "考虑在具有圆形横截面的缓弯环形管中，一个统计定常、充分发展的湍流。引入一个正交曲线坐标系，其单位矢量分别与管道中心线的流向、局部曲率平面内的壁面法向以及垂直于该平面的副法线方向对齐；这些方向分别表示为$s$、$n$和$b$。直接数值模拟(DNS)数据表明，在$n$–$b$横截面中存在平均二次环流，并报告在核心区域的一个代表点，平均应变率张量$S_{ij}$具有非零分量$S_{sn}$和$S_{sb}$，这与平均流向速度在横流方向上的梯度相关，而在该位置$S_{nb}=0$。在同一位置，DNS的雷诺应力张量$R_{ij}=\\langle u_i' u_j'\\rangle$表现为$R_{sn}\\neq 0$、$R_{sb}\\neq 0$、$R_{nb}\\neq 0$，且法向应力不相等，即$R_{ss}\\neq R_{nn}\\neq R_{bb}$。\n\n一个基于Boussinesq涡粘性假设的雷诺平均纳维-斯托克斯(RANS)模型将雷诺应力偏量部分表示为通过单个标量湍流粘度与平均应变率成比例，并假设法向应力部分是各向同性的。\n\n无论湍流粘度的值是多少，在那个位置，这样一个基于Boussinesq的模型必然无法预测DNS观测到的雷诺应力分量的哪个子集（在将其预测为恒等于零或强制其相等的意义上）？\n\nA. 横流剪切分量$R_{nb}$和所有法向应力差（即$R_{ss}-R_{nn}$和$R_{ss}-R_{bb}$）\n\nB. 仅流向-横流剪切分量$R_{sn}$和$R_{sb}$\n\nC. 所有非对角分量$R_{sn}$、$R_{sb}$和$R_{nb}$\n\nD. 没有；通过适当的标量涡粘度，该模型可以再现$R_{nb}\\neq 0$和$R_{ss}\\neq R_{nn}\\neq R_{bb}$", "solution": "在尝试任何解答之前，需要对问题陈述进行验证。\n\n### 步骤1：提取已知条件\n-   **流动几何与状态**：在具有圆形横截面的缓弯环形管中，统计定常、充分发展的湍流。\n-   **坐标系**：一个正交曲线坐标系（$s$, $n$, $b$），其中$s$是流向，$n$是曲率平面内的壁面法向，$b$是副法线方向。\n-   **直接数值模拟(DNS)数据**：在核心区域的一个代表点：\n    -   平均应变率张量分量：$S_{sn} \\neq 0$, $S_{sb} \\neq 0$, $S_{nb} = 0$。\n    -   雷诺应力张量$R_{ij} = \\langle u_i' u_j' \\rangle$分量：$R_{sn} \\neq 0$, $R_{sb} \\neq 0$, $R_{nb} \\neq 0$，且法向应力不相等，即$R_{ss} \\neq R_{nn} \\neq R_{bb}$。\n-   **雷诺平均纳维-斯托克斯(RANS)模型**：\n    -   该模型基于Boussinesq涡粘性假设。\n    -   雷诺应力偏量部分通过单个标量湍流粘度$\\nu_t$与平均应变率成比例。\n    -   该模型“假设法向应力部分是各向同性的”。\n\n### 步骤2：使用提取的已知条件进行验证\n-   **科学依据**：该问题描述了弯管中的湍流，这是流体力学中的一个典型问题，其中被称为Dean涡的二次流是公认的现象。使用DNS结果作为基准以及评估基于Boussinesq的RANS模型是计算流体力学和湍流理论中的标准做法。DNS提供的数据，如雷诺应力各向异性的存在和特定的非零剪切应力，与此类流动的已知物理原理一致。该问题在科学上是合理的。\n-   **适定性与客观性**：问题陈述清晰，定义和数据明确。问题要求对模型的内在结构与观测到的物理数据进行特定的定性比较，这会导出一个唯一的结论。语言客观且专业。问题是适定的。\n-   **一致性与完整性**：所提供的信息是充分且内部一致的。分析所需的必要数据没有缺失。\n\n### 步骤3：结论与行动\n问题陈述有效。将推导解答。\n\n### 解答推导\n雷诺平均纳维-斯托克斯(RANS)方程需要一个雷诺应力张量$R_{ij} = \\langle u_i' u_j' \\rangle$的模型来实现封闭。问题指定了一个基于Boussinesq涡粘性假设的模型。该假设的一般形式通过一个标量涡粘度$\\nu_t$将雷诺应力张量$R_{ij}$与平均应变率张量$S_{ij} = \\frac{1}{2}(\\partial U_i / \\partial x_j + \\partial U_j / \\partial x_i)$联系起来。\n\n雷诺应力张量被建模为：\n$$ R_{ij}^{\\text{model}} = \\frac{2}{3} k \\delta_{ij} - 2 \\nu_t S_{ij} $$\n其中$k = \\frac{1}{2} R_{ll} = \\frac{1}{2}\\langle u_l' u_l' \\rangle$是湍动能，$\\delta_{ij}$是克罗内克δ函数。项$\\frac{2}{3} k \\delta_{ij}$表示雷诺应力的各向同性部分，而$-2 \\nu_t S_{ij}$表示建模的偏量部分。\n\n我们现在利用指定位置的DNS数据中的已知条件，分析该模型对法向应力和剪切应力的预测。\n\n**法向应力分析**\n问题指出，RANS模型“假设法向应力部分是各向同性的”。这是一个关键陈述。它意味着该模型根据其构造，强制所有法向应力相等。\n$$ R_{ss}^{\\text{model}} = R_{nn}^{\\text{model}} = R_{bb}^{\\text{model}} $$\n这是基础涡粘性模型的一个已知的基本局限。根据这个假设，可以得出法向应力之间的差恒等于零：\n$$ R_{ss}^{\\text{model}} - R_{nn}^{\\text{model}} = 0 $$\n$$ R_{ss}^{\\text{model}} - R_{bb}^{\\text{model}} = 0 $$\n然而，代表流动物理现实的DNS数据报告称法向应力是不相等的：$R_{ss} \\neq R_{nn} \\neq R_{bb}$。这意味着实际的法向应力差是非零的。\n因此，如上所述，基于Boussinesq的模型，由于其自身结构，必然无法预测法向应力各向异性（即法向应力之间的非零差异）的存在。它错误地将它们预测为零。\n\n**剪切应力分析**\n对于非对角分量（$i \\neq j$），克罗内克δ函数$\\delta_{ij}$为零，Boussinesq模型简化为：\n$$ R_{ij}^{\\text{model}} = -2 \\nu_t S_{ij} \\quad (\\text{for } i \\neq j) $$\n该模型假设了一个线性的代数关系，其中雷诺剪切应力与平均剪切应变率直接且局部成正比。我们将此应用于问题中给出的分量。\n\n1.  **流向-横流分量（$R_{sn}$和$R_{sb}$）**：\n    DNS数据显示$S_{sn} \\neq 0$和$S_{sb} \\neq 0$。在湍流中，涡粘度$\\nu_t$是非零的。因此，模型预测：\n    $$ R_{sn}^{\\text{model}} = -2 \\nu_t S_{sn} \\neq 0 $$\n    $$ R_{sb}^{\\text{model}} = -2 \\nu_t S_{sb} \\neq 0 $$\n    DNS数据也显示$R_{sn} \\neq 0$和$R_{sb} \\neq 0$。在这方面，该模型定性上正确地预测了这些剪切应力是非零的。虽然定量的准确性是另一个问题，但该模型在预测一个非零量为零值这一意义上并未必然失败。\n\n2.  **横流剪切分量（$R_{nb}$）**：\n    在指定位置的DNS数据表明，相应的平均应变率分量为零：$S_{nb} = 0$。\n    将此代入模型方程得到：\n    $$ R_{nb}^{\\text{model}} = -2 \\nu_t S_{nb} = -2 \\nu_t (0) = 0 $$\n    模型的预测是，如果$S_{nb}$为零，则$R_{nb}$必须为零，无论$\\nu_t$的值是多少。然而，DNS数据明确指出，在同一位置，$R_{nb} \\neq 0$。\n    这揭示了Boussinesq假设的一个根本性失败。它无法在一个平均剪切应变率为零的平面上再现非零的雷诺剪切应力。这种雷诺应力张量主轴与平均应变率张量主轴不重合的现象，在具有曲率或旋转的复杂流动中很常见。\n\n**推导结论**\n如上所述，基于Boussinesq的RANS模型在给定位置表现出两个必然的失败：\n1.  它无法预测横流剪切分量$R_{nb}$，将其预测为恒等于零，而实际上它不为零。\n2.  它无法预测法向应力差（各向异性），假设它们为零，而实际上它们不为零。\n\n### 选项评估\n\n-   **A. 横流剪切分量$R_{nb}$和所有法向应力差（即$R_{ss}-R_{nn}$和$R_{ss}-R_{bb}$）**\n    该陈述准确地指出了通过分析Boussinesq模型的结构并与提供的DNS数据进行比较得出的两个根本性失败。模型错误地预测$R_{nb}=0$，并且它假设法向应力是各向同性的，从而也错误地将其差异预测为零。此陈述**正确**。\n\n-   **B. 仅流向-横流剪切分量$R_{sn}$和$R_{sb}$**\n    此陈述不正确。模型预测$R_{sn}$和$R_{sb}$为非零值，因为相应的平均应变率$S_{sn}$和$S_{sb}$不为零。从定性上看，这不代表一个必然的失败。此陈述**不正确**。\n\n-   **C. 所有非对角分量$R_{sn}$、$R_{sb}$和$R_{nb}$**\n    此陈述不正确，因为如选项B的解释，模型在预测$R_{sn}$和$R_{sb}$的存在方面并未必然失败。在此位置的剪切应力中，失败是特定于$R_{nb}$的。此陈述**不正确**。\n\n-   **D. 没有；通过适当的标量涡粘度，该模型可以再现$R_{nb}\\neq 0$和$R_{ss}\\neq R_{nn}\\neq R_{bb}$**\n    此陈述根本不正确。预测$R_{nb}^{\\text{model}}=0$是$S_{nb}=0$的直接结果，且与$\\nu_t$的值无关。此外，各向同性法向应力的假设是所述模型的结构性方面，不能通过调整$\\nu_t$来改变。因此，该模型在构造上无法再现这些特征。此陈述**不正确**。", "answer": "$$\\boxed{A}$$", "id": "2447865"}, {"introduction": "现在我们将目光转向大涡模拟（LES）。在LES中，我们只解析大尺度涡结构，而必须对小尺度的耗散涡进行建模。这种能量耗散可以来自一个明确的亚格子尺度（SGS）模型，也可以在无意中由数值格式本身引入（通常称为隐式LES或ILES）。本编程练习将对这种“隐式”的数值耗散与“显式”的SGS模型进行直接的定量比较，揭示了执行欠解析模拟时的一个关键概念 [@problem_id:2447860]。", "problem": "要求您在一维、周期性、欠解析的设置下，量化和比较由一阶迎风格式的隐式数值扩散和由显式 Smagorinsky 亚格子尺度模型引起的瞬时动能耗散。完全在一维周期域中进行计算，并使用下文所述的定义。所有角度均应以弧度为单位。所有涉及物理量的输出必须以国际单位制 (SI) 报告。\n\n考虑一个标量场 $u(x,t)$，它作为在周期域 $x \\in [0,L)$（其中 $L0$）上演化的速度分量的替代。设均匀网格有 $N$ 个点，间距为 $\\Delta x = L/N$，并采用周期性索引。定义节点位置为 $x_i = i\\,\\Delta x$，其中 $i \\in \\{0,1,\\dots,N-1\\}$，初始场为\n$$\nu_i = u(x_i,0) = U_0 \\,\\sin\\!\\left(\\frac{2\\pi m}{L}\\,x_i\\right),\n$$\n其中 $U_00$ 是振幅，$m \\in \\mathbb{Z}^+$ 是域中的波长数。均匀平流速度 $a \\ge 0$ 是恒定的。Smagorinsky 常数 $C_s0$ 是无量纲的，滤波宽度取为 $\\Delta=\\Delta x$。\n\n将单位质量单位长度的离散动能定义为\n$$\nE = \\frac{1}{2L}\\sum_{i=0}^{N-1} u_i^2\\,\\Delta x,\n$$\n并将单位质量单位长度的瞬时动能耗散率定义为\n$$\nD = -\\frac{\\mathrm{d}E}{\\mathrm{d}t}.\n$$\n\n您必须在同一网格上，使用周期性索引，为以下两种半离散模型计算 $t=0$ 时的 $D$：\n\n1) 一阶迎风平流（恒定速度 $a \\ge 0$）：\n$$\n\\frac{\\mathrm{d}u_i}{\\mathrm{d}t} = -\\,a\\,\\frac{u_i - u_{i-1}}{\\Delta x}.\n$$\n\n2) 带有显式 Smagorinsky 亚格子尺度黏性的中心平流：\n$$\n\\frac{\\mathrm{d}u_i}{\\mathrm{d}t} = -\\,a\\,\\frac{u_{i+1}-u_{i-1}}{2\\,\\Delta x} \\;+\\; \\left[\\frac{\\partial}{\\partial x}\\left(\\nu_{t}\\,\\frac{\\partial u}{\\partial x}\\right)\\right]_i,\n$$\n其中离散梯度为\n$$\n\\left(\\frac{\\partial u}{\\partial x}\\right)_i \\equiv g_i = \\frac{u_{i+1}-u_{i-1}}{2\\,\\Delta x},\n$$\nSmagorinsky 涡黏性为\n$$\n\\nu_{t,i} = \\left(C_s\\,\\Delta x\\right)^2\\,|g_i|,\n$$\n黏性通量的离散散度使用中心差分\n$$\n\\left[\\frac{\\partial}{\\partial x}\\left(\\nu_{t}\\,\\frac{\\partial u}{\\partial x}\\right)\\right]_i = \\frac{(\\nu_t g)_{i+1} - (\\nu_t g)_{i-1}}{2\\,\\Delta x}.\n$$\n\n对每个模型，通过半离散的右端项直接计算 $t=0$ 时的 $D$：\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = \\frac{1}{L}\\sum_{i=0}^{N-1} u_i \\left(\\frac{\\mathrm{d}u_i}{\\mathrm{d}t}\\right)\\Delta x,\n$$\n然后计算 $D=-\\mathrm{d}E/\\mathrm{d}t$。为每个测试用例报告以下内容：\n- 迎风模型的 $D_{\\text{up}}$，单位为 $\\mathrm{m}^2/\\mathrm{s}^3$，四舍五入到六位小数。\n- Smagorinsky 模型的 $D_{\\text{sgs}}$，单位为 $\\mathrm{m}^2/\\mathrm{s}^3$，四舍五入到六位小数。\n- 无量纲比率 $R = D_{\\text{up}}/D_{\\text{sgs}}$，四舍五入到六位小数。\n\n使用以下测试套件，其设计旨在探究一个典型情况、一个更严重的欠解析情况以及一个零平流速度的边界情况：\n- 情况 A (一般欠解析)：$L = 2\\pi\\,\\mathrm{m}$, $N=16$, $m=3$, $U_0 = 1.0\\,\\mathrm{m/s}$, $a=1.0\\,\\mathrm{m/s}$, $C_s=0.17$。\n- 情况 B (更严重的欠解析)：$L = 2\\pi\\,\\mathrm{m}$, $N=12$, $m=3$, $U_0 = 1.0\\,\\mathrm{m/s}$, $a=1.0\\,\\mathrm{m/s}$, $C_s=0.17$。\n- 情况 C (隐式耗散的边界情况)：$L = 2\\pi\\,\\mathrm{m}$, $N=16$, $m=3$, $U_0 = 1.0\\,\\mathrm{m/s}$, $a=0.0\\,\\mathrm{m/s}$, $C_s=0.17$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，其中每个元素是按 $\\left[D_{\\text{up}},D_{\\text{sgs}},R\\right]$ 顺序排列的测试用例三元素列表。例如：\n\"[ [D_up_A,D_sgs_A,R_A], [D_up_B,D_sgs_B,R_B], [D_up_C,D_sgs_C,R_C] ]\"\n所有 $D_{\\text{up}}$ 和 $D_{\\text{sgs}}$ 值必须以 $\\mathrm{m}^2/\\mathrm{s}^3$ 为单位，$R$ 必须是无量纲的。每个数值都必须四舍五入到六位小数，并表示为十进制数。", "solution": "所述问题是有效的。它在科学上基于计算流体动力学的原理，特别是数值格式分析和湍流模型。这是一个适定问题，为获得唯一解提供了所有必要的参数和方程。语言是客观的，要求是明确的。我们将继续进行完整的解答。\n\n目标是量化和比较在一维平流问题中，两个不同半离散模型在时间 $t=0$ 时的瞬时动能耗散率。分析在由 $N$ 个均匀间隔点离散化的周期域 $x \\in [0, L)$ 上进行。\n\n首先，我们建立基本定义。单位质量单位长度的离散动能由下式给出：\n$$\nE = \\frac{1}{2L}\\sum_{i=0}^{N-1} u_i^2\\,\\Delta x\n$$\n其中 $u_i$ 是网格点 $i$ 处的标量场，$\\Delta x = L/N$。单位质量单位长度的瞬时动能耗散率 $D$ 定义为 $E$ 的负时间导数：\n$$\nD = -\\frac{\\mathrm{d}E}{\\mathrm{d}t}\n$$\n通过对 $E$ 的表达式应用时间导数，我们基于 $u_i$ 的半离散演化方程得到其变化率的公式：\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}t} = \\frac{\\mathrm{d}}{\\mathrm{d}t}\\left(\\frac{1}{2L}\\sum_{i=0}^{N-1} u_i^2\\,\\Delta x\\right) = \\frac{\\Delta x}{2L}\\sum_{i=0}^{N-1} 2u_i\\frac{\\mathrm{d}u_i}{\\mathrm{d}t} = \\frac{1}{N}\\sum_{i=0}^{N-1} u_i\\frac{\\mathrm{d}u_i}{\\mathrm{d}t}\n$$\n因此，待计算的耗散率为：\n$$\nD = -\\frac{1}{N}\\sum_{i=0}^{N-1} u_i \\left(\\frac{\\mathrm{d}u_i}{\\mathrm{d}t}\\right)_i\n$$\n初始条件为单个正弦模态：\n$$\nu_i(0) = U_0 \\,\\sin\\!\\left(\\frac{2\\pi m}{L}\\,x_i\\right)\n$$\n我们现在将分别分析每个模型。\n\n**模型 1：一阶迎风平流**\n\n对于具有恒定平流速度 $a \\ge 0$ 的一阶迎风格式，其半离散方程为：\n$$\n\\frac{\\mathrm{d}u_i}{\\mathrm{d}t} = -a\\,\\frac{u_i - u_{i-1}}{\\Delta x}\n$$\n将此代入耗散率的表达式，我们得到迎风格式的耗散 $D_{\\text{up}}$：\n$$\nD_{\\text{up}} = -\\frac{1}{N}\\sum_{i=0}^{N-1} u_i \\left( -a\\,\\frac{u_i - u_{i-1}}{\\Delta x} \\right) = \\frac{a}{N\\Delta x}\\sum_{i=0}^{N-1} u_i(u_i - u_{i-1})\n$$\n使用 $\\Delta x = L/N$，该式简化为：\n$$\nD_{\\text{up}} = \\frac{a}{L}\\sum_{i=0}^{N-1} (u_i^2 - u_i u_{i-1})\n$$\n该公式表明，耗散是空间离散化的直接结果，并与平流速度 $a$ 成正比。这是一阶迎风格式所固有的众所周知的数值扩散。\n\n**模型 2：带有显式 Smagorinsky 亚格子尺度 (SGS) 模型的中心平流**\n\n该半离散方程将用于平流的二阶中心差分与一个显式 SGS 黏性项结合起来：\n$$\n\\frac{\\mathrm{d}u_i}{\\mathrm{d}t} = \\underbrace{-\\,a\\,\\frac{u_{i+1}-u_{i-1}}{2\\,\\Delta x}}_{\\text{Advection}} \\;+\\; \\underbrace{\\frac{(\\nu_t g)_{i+1} - (\\nu_t g)_{i-1}}{2\\,\\Delta x}}_{\\text{SGS Diffusion}}\n$$\n其中 $g_i = (u_{i+1}-u_{i-1})/(2\\Delta x)$ 是离散梯度，$\\nu_{t,i} = (C_s \\Delta x)^2 |g_i|$ 是 Smagorinsky 涡黏性。总耗散 $D_{\\text{sgs}}$ 是右端两项贡献之和。\n\n来自中心平流项的贡献为：\n$$\nD_{\\text{adv}} = -\\frac{1}{N}\\sum_{i=0}^{N-1} u_i \\left( -a\\,\\frac{u_{i+1}-u_{i-1}}{2\\,\\Delta x} \\right) = \\frac{a}{2N\\Delta x}\\sum_{i=0}^{N-1} u_i(u_{i+1}-u_{i-1})\n$$\n由于周期性，通过离散分部求和，该求和项为零：\n$$\n\\sum_{i=0}^{N-1} u_i(u_{i+1}-u_{i-1}) = \\sum_{i=0}^{N-1} u_i u_{i+1} - \\sum_{i=0}^{N-1} u_i u_{i-1}\n$$\n通过对第二个和式重新索引为 $j=i-1$（并利用周期性），它变为 $\\sum_{j=0}^{N-1} u_{j+1} u_j$。这两个和式完全相同并相互抵消，证明了中心差分平流格式对于总动能是非耗散的。\n\n因此，该模型中的耗散完全来自于显式 SGS 项。\n$$\nD_{\\text{sgs}} = -\\frac{1}{N}\\sum_{i=0}^{N-1} u_i \\left( \\frac{(\\nu_t g)_{i+1} - (\\nu_t g)_{i-1}}{2\\,\\Delta x} \\right)\n$$\n对此表达式应用分部求和：\n$$\nD_{\\text{sgs}} = -\\frac{1}{2N\\Delta x} \\sum_i u_i ((\\nu_t g)_{i+1} - (\\nu_t g)_{i-1}) = \\frac{1}{2N\\Delta x} \\sum_i (u_{i+1}-u_{i-1}) (\\nu_t g)_i\n$$\n认识到 $g_i = (u_{i+1}-u_{i-1})/(2\\Delta x)$，我们得到一个简化的、正定的公式：\n$$\nD_{\\text{sgs}} = \\frac{1}{N}\\sum_{i=0}^{N-1} g_i (\\nu_t g)_i = \\frac{1}{N}\\sum_{i=0}^{N-1} \\nu_{t,i} g_i^2\n$$\n代入 $\\nu_{t,i}$ 的定义：\n$$\nD_{\\text{sgs}} = \\frac{1}{N}\\sum_{i=0}^{N-1} (C_s\\Delta x)^2|g_i| \\cdot g_i^2 = \\frac{(C_s\\Delta x)^2}{N}\\sum_{i=0}^{N-1} |g_i|^3\n$$\n这在物理上表示动能从解析尺度上被移除并转移到亚格子尺度的速率，而这正是 SGS 模型的目标。\n\n**计算步骤**\n\n对每个测试用例，我们将执行以下步骤：\n1. 使用给定参数 $L, N, m, U_0$ 初始化网格 $x_i$ 和 $t=0$ 时的场 $u_i$。\n2. 使用公式 $D_{\\text{up}} = \\frac{a}{L}\\sum_{i=0}^{N-1} (u_i^2 - u_i u_{i-1})$ 计算 $D_{\\text{up}}$。对于周期性边界，$u_{-1}$ 取为 $u_{N-1}$。\n3. 计算离散梯度 $g_i = (u_{i+1}-u_{i-1})/(2\\Delta x)$，其中 $u_{N}$ 是 $u_0$，$u_{-1}$ 是 $u_{N-1}$。\n4. 使用公式 $D_{\\text{sgs}} = \\frac{(C_s\\Delta x)^2}{N}\\sum_{i=0}^{N-1} |g_i|^3$ 计算 $D_{\\text{sgs}}$。\n5. 计算比率 $R = D_{\\text{up}}/D_{\\text{sgs}}$。对于情况 C，其中 $a=0$，$D_{\\text{up}}$ 将为零，导致 $R=0$。\n6. 按要求将所有数值结果四舍五入到六位小数。为提高效率，将使用数值数组进行实现。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the instantaneous kinetic energy dissipation rate for two numerical schemes\n    for a one-dimensional advection problem on a periodic domain.\n    \"\"\"\n\n    test_cases = [\n        # Case A: General under-resolved case\n        {'L': 2 * np.pi, 'N': 16, 'm': 3, 'U0': 1.0, 'a': 1.0, 'Cs': 0.17},\n        # Case B: More severe under-resolution\n        {'L': 2 * np.pi, 'N': 12, 'm': 3, 'U0': 1.0, 'a': 1.0, 'Cs': 0.17},\n        # Case C: Edge case with zero advection speed\n        {'L': 2 * np.pi, 'N': 16, 'm': 3, 'U0': 1.0, 'a': 0.0, 'Cs': 0.17},\n    ]\n\n    results = []\n    for params in test_cases:\n        # Extract parameters for the current test case\n        L = params['L']\n        N = params['N']\n        m = params['m']\n        U0 = params['U0']\n        a = params['a']\n        Cs = params['Cs']\n\n        # 1. Set up grid and initial condition\n        dx = L / N\n        # x_i = i * dx\n        x = np.arange(N) * dx\n        # Initial field u(x,0)\n        # Using the fact that L=2*pi simplifies the argument of sin\n        u = U0 * np.sin(m * x)\n\n        # 2. Compute dissipation for the first-order upwind scheme (D_up)\n        # u_{i-1} using periodic boundary condition\n        u_im1 = np.roll(u, 1)\n        # D_up = (a/L) * sum(u_i^2 - u_i * u_{i-1})\n        sum_term_up = np.sum(u**2 - u * u_im1)\n        D_up = a / L * sum_term_up\n\n        # 3. Compute dissipation for the Smagorinsky SGS model (D_sgs)\n        # u_{i+1} and u_{i-1} using periodic boundary conditions\n        u_ip1 = np.roll(u, -1)\n        # Gradient g_i = (u_{i+1} - u_{i-1}) / (2*dx)\n        g = (u_ip1 - u_im1) / (2 * dx)\n        # D_sgs = ((Cs*dx)^2 / N) * sum(|g_i|^3)\n        sum_term_sgs = np.sum(np.abs(g)**3)\n        D_sgs = ((Cs * dx)**2 / N) * sum_term_sgs\n        \n        # 4. Compute the ratio R = D_up / D_sgs\n        # This handles the case where D_sgs could be zero, although not expected here.\n        # For Case C, a=0 implies D_up=0, so R=0.\n        if D_sgs != 0:\n            R = D_up / D_sgs\n        elif D_up == 0:\n            R = 0.0\n        else:\n            R = np.inf # Should not occur in these test cases\n\n        # 5. Round results to six decimal places\n        D_up_rounded = round(D_up, 6)\n        D_sgs_rounded = round(D_sgs, 6)\n        R_rounded = round(R, 6)\n\n        results.append([D_up_rounded, D_sgs_rounded, R_rounded])\n\n    # Format the final output string exactly as specified in the problem,\n    # including spaces as shown in the example.\n    print(str(results).replace(\"'\", \"\"))\n\nsolve()\n```", "id": "2447860"}]}