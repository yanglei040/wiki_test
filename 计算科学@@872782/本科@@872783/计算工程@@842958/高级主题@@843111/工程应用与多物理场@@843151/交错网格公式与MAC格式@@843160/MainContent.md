## 引言
在计算科学与工程领域，尤其是在模拟流体运动时，如何准确而稳定地求解控制方程是一个永恒的挑战。交错网格公式（Staggered-grid Formulations），特别是经典的标记-单元法（Marker-and-Cell, MAC scheme），是应对这一挑战的基石性技术之一。它的出现并非偶然，而是为了解决一个困扰早期计算流体动力学研究者的根本性难题：当速度和压力等变量被简单地定义在网格的相同位置时（即[同位网格](@entry_id:175200)），数值解往往会受到非物理性[振荡](@entry_id:267781)的污染，导致计算失败。

本文旨在系统性地剖析交错网格的精髓。我们将深入探讨为何需要这种看似复杂的变量布局，它如何从根本上保证了压力与速度场的稳定耦合，以及它如何构成了一套强大而优雅的离散化框架。通过本文的学习，读者将不仅掌握其理论基础，还将领略其思想的深远影响。文章将分为三个核心部分：

在 **“原理与机制”** 一章中，我们将从第一性原理出发，对比[同位网格](@entry_id:175200)与交错网格的差异，详细推导其核心的离散算子，并阐述用于强制[不可压缩性](@entry_id:274914)的[投影法](@entry_id:144836)。

接着，在 **“应用与跨学科联系”** 一章中，我们将跳出传统[流体力学](@entry_id:136788)的范畴，探索交错网格思想如何在地球科学、[固体力学](@entry_id:164042)、[流行病学](@entry_id:141409)乃至机器学习等多个学科中焕发光彩，揭示其作为一种普适守恒律建模工具的本质。

最后，在 **“动手实践”** 部分，我们将提供一系列精心设计的编程与分析练习，帮助读者将理论知识转化为解决实际问题的能力。

## 原理与机制

本章在前一章介绍的基础上，深入探讨[交错网格](@entry_id:147661)公式和MAC格式的数学原理与实现机制。我们将从根本上剖析为何需要[交错网格](@entry_id:147661)，详细阐述其离散算子的构造，并讨论在实践中如何利用这些工具求解[不可压缩流体](@entry_id:181066)问题。最后，我们将触及一些更高级的主题，包括离散守恒律和该方法在非结构网格上的推广。

### [压力-速度耦合](@entry_id:155962)问题：为何选择[交错网格](@entry_id:147661)？

在数值求解不[可压缩Navier-Stokes](@entry_id:747591)方程时，一个核心的挑战在于如何处理速度 $\mathbf{u}$ 和压力 $p$ 之间的耦合关系。压力作为一个拉格朗日乘子，其作用是通过其梯度 $\nabla p$ 来调整速度场，以满足无散（即不可压缩）约束 $\nabla \cdot \mathbf{u} = 0$。[数值格式](@entry_id:752822)能否稳定、准确地再现这种耦合，是其成败的关键。

一个最直观的[离散化方法](@entry_id:272547)是采用**[同位网格](@entry_id:175200)**（**collocated grid**），即将所有变量（如二维情况下的 $u, v, p$）都存储在同一个网格位置，通常是[控制体](@entry_id:143882)的中心。然而，这种看似简单的方法隐藏着一个致命的缺陷。让我们考虑一个简化模型来揭示这个问题。在一个均匀的笛卡尔网格上，我们可以使用[中心差分](@entry_id:173198)来近似[压力梯度](@entry_id:274112)和[速度散度](@entry_id:264117)。例如，在[同位网格](@entry_id:175200)中，单元 $(i,j)$ 中心的速度可由压力梯度驱动：

$u_{i,j} = -\frac{p_{i+1,j} - p_{i-1,j}}{2\Delta x}, \quad v_{i,j} = -\frac{p_{i,j+1} - p_{i,j-1}}{2\Delta y}$

为了计算单元 $(i,j)$ 的散度，我们需要[控制体](@entry_id:143882)边界上的速度值。通过对相邻单元中心的速度值进行算术平均，可以得到面上的速度：

$u_{i+\frac{1}{2},j} = \frac{1}{2}(u_{i,j} + u_{i+1,j})$

然后，单元中心的离散散度可以表示为：

$(\nabla_h \cdot \mathbf{u})_{i,j} = \frac{u_{i+\frac{1}{2},j} - u_{i-\frac{1}{2},j}}{\Delta x} + \frac{v_{i,j+\frac{1}{2}} - v_{i,j-\frac{1}{2}}}{\Delta y}$

将速度和压力之间的关系代入，经过一系列推导，我们可以得到压[力场](@entry_id:147325) $p$ 与其产生的速度场的散度 $(\nabla_h \cdot \mathbf{u})$ 之间的有效离散关系。以 $\Delta x = \Delta y = 1$ 为例，该关系呈现为一个广模板的[拉普拉斯算子](@entry_id:146319) [@problem_id:2438376]：

$(\nabla_h \cdot \mathbf{u})_{i,j}^{c} = -\frac{1}{4}\left[(p_{i+2,j} - 2p_{i,j} + p_{i-2,j}) + (p_{i,j+2} - 2p_{i,j} + p_{i,j-2})\right]$

这个算子的模板连接了当前点 $(i,j)$ 与其距离为2的邻居点。这种结构意味着该算子无法“看见”相邻网格点之间的压力变化。特别是对于一种高频的、非物理的**棋盘状压[力场](@entry_id:147325)**（**checkerboard pressure mode**），例如 $p_{i,j} = (-1)^{i+j}$，我们有 $p_{i\pm 2, j} = p_{i,j}$ 和 $p_{i, j\pm 2} = p_{i,j}$。代入上述公式，我们得到 $(\nabla_h \cdot \mathbf{u})_{i,j}^{c} = 0$。这意味着一个剧烈[振荡](@entry_id:267781)的、完全非物理的压[力场](@entry_id:147325)可以在离散系统中存在，而不会产生任何[速度散度](@entry_id:264117)。数值求解器因此无法察觉和抑制这种模式，导致压力解的严重污染。这一现象被称为**[压力-速度解耦](@entry_id:167545)**（**pressure-velocity decoupling**）。

为了克服这一根本性缺陷，Harlow和Welch于1965年提出了**标记-单元法**（**Marker-and-Cell (MAC) method**），其核心是一种**[交错网格](@entry_id:147661)**（**staggered grid**）布局。在MAC格式中，不同的变量被存储在控制体不同的位置上：
*   **压力 $p$** 存储在[控制体](@entry_id:143882)的**中心** $(i,j)$。
*   **水平速度分量 $u$** 存储在**垂直面**的中心 $(i\pm\frac{1}{2}, j)$。
*   **垂直速度分量 $v$** 存储在**水平面**的中心 $(i, j\pm\frac{1}{2})$。

在这种布局下，驱动面速度的[压力梯度](@entry_id:274112)可以直接由相邻的中心压力值计算，无需插值：

$u_{i+\frac{1}{2},j} = -\frac{p_{i+1,j} - p_{i,j}}{\Delta x}, \quad v_{i,j+\frac{1}{2}} = -\frac{p_{i,j+1} - p_{i,j}}{\Delta y}$

单元中心的散度定义保持不变，但现在它直接使用了存储在面上的速度值。将压[力-速度关系](@entry_id:151449)代入，我们得到了一个新的、紧凑的[离散拉普拉斯算子](@entry_id:634690) [@problem_id:2438376]：

$(\nabla_h \cdot \mathbf{u})_{i,j}^{m} = -\left( \frac{p_{i+1,j} - 2p_{i,j} + p_{i-1,j}}{(\Delta x)^2} + \frac{p_{i,j+1} - 2p_{i,j} + p_{i,j-1}}{(\Delta y)^2} \right)$

这是一个标准的[五点拉普拉斯模板](@entry_id:749433)，它紧密地耦合了相邻的压力值。现在，如果我们用棋盘状压[力场](@entry_id:147325) $p_{i,j} = (-1)^{i+j}$ 来检验这个算子，我们会发现 $p_{i\pm 1, j} = -p_{i,j}$ 和 $p_{i, j\pm 1} = -p_{i,j}$。代入后得到 $(\nabla_h \cdot \mathbf{u})_{i,j}^{m} = -\frac{1}{h^2}(-p_{i,j} - p_{i,j} - p_{i,j} - p_{i,j} - 4(-p_{i,j})) = \frac{8p_{i,j}}{h^2} \neq 0$（以$\Delta x = \Delta y = h$为例）。这表明MAC格式能够正确地识别出这种非物理的压力[振荡](@entry_id:267781)并产生一个巨大的散度，从而在求解过程中将其抑制。

这种稳定性在更广泛的有限[元理论](@entry_id:638043)中可以通过**Ladyzhenskaya–Babuška–Brezzi (LBB) 条件**（或**[inf-sup条件](@entry_id:746626)**）来解释。这个条件为混合方法的稳定性提供了数学保证。[交错网格](@entry_id:147661)的安排，在有限元框架下，等价于使用满足[LBB条件](@entry_id:746626)的单元对（例如，最低阶的[Raviart-Thomas单元](@entry_id:165227)$RT_0$和分片常数单元$P_0$），从而保证了压力解的稳定性。相比之下，简单的[同位网格](@entry_id:175200)格式（如$Q_1$-$Q_1$单元）违反了[LBB条件](@entry_id:746626)，因而本质上是不稳定的 [@problem_id:2378395]。

### MAC格式的离散算子

MAC格式的优越性根植于其离散算子的精巧构造。让我们在笛卡尔网格上正式定义这些核心算子。

#### 离散[散度算子](@entry_id:265975)

**离散[散度算子](@entry_id:265975) $D$** 将面心的[速度场](@entry_id:271461)映射到体心的[标量场](@entry_id:151443)。其定义源于[散度定理](@entry_id:143110)在单个[控制体](@entry_id:143882) $\Omega_i = [x_{i-\frac{1}{2}}, x_{i+\frac{1}{2}}]$ 上的应用：

$\int_{\Omega_i} \nabla \cdot \mathbf{u} \,dV \approx (\nabla_h \cdot \mathbf{u})_i \Delta V_i = \oint_{\partial \Omega_i} \mathbf{u} \cdot \mathbf{n} \,dA$

在一维情况下，这简化为 $(\nabla_h \cdot u)_i \Delta x_i = u_{i+\frac{1}{2}} - u_{i-\frac{1}{2}}$。因此，体心散度的二阶精确近似为：

$(\nabla_h \cdot u)_i \approx \frac{u_{i+\frac{1}{2}} - u_{i-\frac{1}{2}}}{\Delta x_i}$

这个公式即使在**[非均匀网格](@entry_id:752607)**（$\Delta x_i$ 可变）上也自然成立，并保持了[二阶精度](@entry_id:137876)，这体现了有限体积法的优势 [@problem_id:2438354]。在二维情况下，该算子为：

$(\nabla_h \cdot \mathbf{u})_{i,j} = \frac{u_{i+\frac{1}{2},j} - u_{i-\frac{1}{2},j}}{\Delta x} + \frac{v_{i,j+\frac{1}{2}} - v_{i,j-\frac{1}{2}}}{\Delta y}$

#### [离散梯度](@entry_id:171970)算子

**[离散梯度](@entry_id:171970)算子 $G$** 将体心的压[力场](@entry_id:147325)映射到面心的矢量场（压力梯度）。在均匀网格上，其定义非常直观，就是相邻体心压力值的中心差分：

$(G p)_{i+\frac{1}{2},j} = \frac{p_{i+1,j} - p_{i,j}}{\Delta x}$

可以观察到，离散[散度算子](@entry_id:265975) $D$ 和[梯度算子](@entry_id:275922) $G$ 在离散意义上是负共轭关系（$D = -G^T$），这反映了[连续算子](@entry_id:143297)之间的关系，并对[数值稳定性](@entry_id:146550)至关重要。

然而，在**[非均匀网格](@entry_id:752607)**上，为了保持二阶精度，[梯度算子](@entry_id:275922)的构造需要更加谨慎。简单地用相邻压力差除以中心距 $\frac{\Delta x_i+\Delta x_{i+1}}{2}$ 仅为[一阶精度](@entry_id:749410)。为了达到二阶精度，我们需要使用一个更宽的模板，例如通过包含 $p_{i-1}, p_i, p_{i+1}$ 的二次[多项式插值](@entry_id:145762)来计算面 $x_{i+\frac{1}{2}}$ 上的梯度。这会得到一个依赖于 $\Delta x_{i-1}, \Delta x_i, \Delta x_{i+1}$ 的更复杂的表达式 [@problem_id:2438354]。这说明，在[非均匀网格](@entry_id:752607)上保持精度需要对算子进行更细致的设计。

#### [离散拉普拉斯算子](@entry_id:634690)

将梯度和[散度算子](@entry_id:265975)复合，我们便自然地得到了作用于压[力场](@entry_id:147325)的**[离散拉普拉斯算子](@entry_id:634690) $L = DG$**。对于均匀网格，这个算子就是我们之前看到的标准[五点模板](@entry_id:174268)，它是求解[压力泊松方程](@entry_id:137996)的核心。

### [不可压缩性](@entry_id:274914)的强制执行：[投影法](@entry_id:144836)

在时间相关的模拟中，我们如何利用MAC格式的算子来确保速度场在每一步都满足不可压缩约束呢？一个广泛使用的方法是**分数步法**（**fractional-step method**），或称**[投影法](@entry_id:144836)**（**projection method**）。该方法将一个时间步分为两个阶段：

1.  **预测步 (Prediction)**：首先，计算一个中间速度场 $\mathbf{u}^*$。这一步包含了[对流](@entry_id:141806)、[扩散](@entry_id:141445)和[源项](@entry_id:269111)（如重力）的影响，但暂时忽略了[压力梯度](@entry_id:274112)项。例如，一个简单显式的预测步可以是：
    $\frac{\mathbf{u}^* - \mathbf{u}^n}{\Delta t} = -(\mathbf{u}^n \cdot \nabla_h)\mathbf{u}^n + \nu \nabla_h^2 \mathbf{u}^n + \mathbf{f}$
    由于[对流](@entry_id:141806)项的[非线性](@entry_id:637147)和[离散化误差](@entry_id:748522)，即使 $\mathbf{u}^n$ 是无散的，预测得到的[速度场](@entry_id:271461) $\mathbf{u}^*$ 通常也不是无散的，即 $\nabla_h \cdot \mathbf{u}^* \neq 0$。

2.  **投影步 (Projection/Correction)**：接下来，将 $\mathbf{u}^*$ 投影到无散[函数空间](@entry_id:143478)，得到最终的[速度场](@entry_id:271461) $\mathbf{u}^{n+1}$。根据[Helmholtz分解](@entry_id:181767)定理，任何矢量场都可以分解为一个无散[部分和](@entry_id:162077)一个无旋部分（梯度场）。投影步正是要从 $\mathbf{u}^*$ 中减去一个梯度场，使其变为无散的：
    $\mathbf{u}^{n+1} = \mathbf{u}^* - \Delta t \, G p^{n+1}$
    我们要求最终的速度场是无散的，即 $D \mathbf{u}^{n+1} = 0$。将上式代入，得到：
    $D(\mathbf{u}^* - \Delta t \, G p^{n+1}) = 0 \implies DG p^{n+1} = \frac{D \mathbf{u}^*}{\Delta t}$
    这就是**[压力泊松方程](@entry_id:137996)**（**Pressure Poisson Equation**, PPE），其中 $L p^{n+1} = \frac{D \mathbf{u}^*}{\Delta t}$。求解这个[椭圆方程](@entry_id:169190)得到压[力场](@entry_id:147325) $p^{n+1}$，然后用它来校正速度，得到最终的、满足离散不可压缩约束的[速度场](@entry_id:271461) $\mathbf{u}^{n+1}$。

投影步的重要性不言而喻。假如在某个时间步中跳过这一步，直接令 $\mathbf{u}^{n+1} = \mathbf{u}^*$，那么得到的[速度场](@entry_id:271461)将包含非零的散度。在物理上，$\nabla \cdot \mathbf{u} > 0$ 的区域如同一个**源**（**source**），流体在此处凭空产生并膨胀；而 $\nabla \cdot \mathbf{u} < 0$ 的区域如同一个**汇**（**sink**），流体在此处消失并压缩。在[流线](@entry_id:266815)图或[粒子追踪](@entry_id:190741)的可视化中，这将表现为[流线](@entry_id:266815)从某些点发散或汇集到某些点，这对于不可压缩流体是完全错误的物理行为 [@problem_id:2438352]。因此，压力和投影步的唯一作用就是消除这些虚假的源和汇，确保质量守恒。

### 实践中的关键环节

#### 边界条件的处理

边界条件的正确实施是任何数值模拟成功的关键，对于[交错网格](@entry_id:147661)也不例外。通常，这需要引入**虚拟单元**（**ghost cells**）来辅助计算边界附近的导数和插值。让我们以一个固壁无滑移边界为例（例如在 $x=0$ 处），其速度条件为 $u=0, v=0$ [@problem_id:2438328]。

*   **法向速度 ($u$)**：在MAC网格中，法向速度分量（这里是$u$）恰好位于边界上（例如，$u_{1/2,j}$ 位于 $x=0$）。因此，狄利克雷边界条件可以直接强制施加：$u_{1/2,j} = 0$。

*   **切向速度 ($v$)**：切向速度分量（这里是$v$）的节点位于单元内部，与边界错开半个网格（例如，$v_{1, j+1/2}$ 位于 $x=\Delta x/2$）。为了在边界 $x=0$ 上施加 $v=0$ 条件，我们引入一列虚拟单元 $v_{0, j+1/2}$。通过在边界上使用中心平均，我们可以得到[二阶精度](@entry_id:137876)的近似：
    $v(0, y) \approx \frac{v_{0, j+1/2} + v_{1, j+1/2}}{2} = 0 \implies v_{0, j+1/2} = -v_{1, j+1/2}$

*   **压力 ($p$)**：对于压力，物理边界条件通常不是直接给定的。它源于边界上的[动量方程](@entry_id:197225)。对于固壁边界，[动量方程](@entry_id:197225)的法向分量给出压力的[诺伊曼边界条件](@entry_id:142124)：$\frac{\partial p}{\partial n} = 0$。在 $x=0$ 处即为 $\frac{\partial p}{\partial x} = 0$。为了用[二阶中心差分](@entry_id:170774)实现这一点，我们使用虚拟压力节点 $p_{0,j}$ 和第一个内部节点 $p_{1,j}$：
    $\frac{\partial p}{\partial x} \bigg|_{x=0} \approx \frac{p_{1,j} - p_{0,j}}{\Delta x} = 0 \implies p_{0,j} = p_{1,j}$

这些虚拟单元的设定规则确保了边界条件在整个计算域内以一致且足够精确的方式被满足。

#### [源项](@entry_id:269111)的处理

[动量方程](@entry_id:197225)中的力（[源项](@entry_id:269111)），如重力或外部施加的点力，也必须在交错网格上被恰当地离散化。根据有限体积法的精神，动量方程是在每个速度分量各自的控制容积上进行积分的。这意味着，任何作用在流体上的力，其分量应该被施加在对应速度分量的位置上。例如，一个均匀的[体力](@entry_id:174230) $\rho \mathbf{g}$，其 $x$ 分量 $\rho g_x$ 应该作为[源项](@entry_id:269111)加入到 $u$-[动量方程](@entry_id:197225)中，因此它被评估在 $u$-速度的位置；$y$ 分量 $\rho g_y$ 则作用于 $v$-动量方程 [@problem_id:2438345]。对于像 $\mathbf{F}_0 \delta(\mathbf{x}-\mathbf{x}_0)$ 这样的集中点力，直接将其施加在单个节点上会引起严重的[数值振荡](@entry_id:163720)。正确的做法是使用一个光滑的、紧支的**正则化$\delta$函数**，将这个点力[分布](@entry_id:182848)到其周围的几个速度节点上，同时保证总的力和力矩得以守恒。

#### [压力泊松方程](@entry_id:137996)的求解

求解[压力泊松方程](@entry_id:137996) $Lp=f$ 是[投影法](@entry_id:144836)中最耗时的部分。这个[线性系统](@entry_id:147850)具有一些特殊的性质。由于压力始终以其梯度形式出现在控制方程中，因此压[力场](@entry_id:147325)可以相差一个任意常数而不改变物理结果。这意味着，如果 $p$ 是一个解，那么 $p+C$ 也是一个解。在离散层面，这意味着[离散梯度](@entry_id:171970)算子 $G$ 会将一个常数向量（所有分量相同）映射为[零向量](@entry_id:156189)。因此，[离散拉普拉斯算子](@entry_id:634690) $L=DG$ 也是奇异的，其核（null space）由常数[向量张成](@entry_id:152883)，[矩阵的秩](@entry_id:155507)亏为1 [@problem_id:2438338]。

一个奇异的[线性系统](@entry_id:147850)要么无解，要么有无穷多解。对于[压力泊松方程](@entry_id:137996)，如果满足相容性条件（即[源项](@entry_id:269111) $f$ 的总和为零，这在离散上通常是成立的），则它有无穷多解。为了得到一个唯一的解，必须施加一个额外的约束来**固定规范**（**gauge fixing**）。常见的方法有：
*   **钉住一个点的压力**：将计算域中某一个单元的压力值固定为零，例如 $p_{ref}=0$。
*   **施加零均值约束**：要求整个压[力场](@entry_id:147325)的平均值为零，即 $\sum_i p_i = 0$。

这些方法都能移除解的任意性，使线性系统变得非奇异，从而可以被标准求解器求解。如果不加约束而直接使用某些[迭代法](@entry_id:194857)（如[共轭梯度法](@entry_id:143436)），其收敛到的解将依赖于初始猜测，这在实践中应予以避免 [@problem_id:2438338]。

### 高级主题与进一步的思考

#### 离散守恒律

除了保证无散性，一个优秀的[数值格式](@entry_id:752822)还应尽可能地保持原物理系统所具有的其他守恒律，例如动量和[能量守恒](@entry_id:140514)。对于无粘、无外力的[不可压缩流](@entry_id:140301)，总动能应该是守恒的。然而，在离散格式中，这并非自动满足。

动能的变化率取决于[对流](@entry_id:141806)项 $\nabla \cdot (\mathbf{u} \otimes \mathbf{u})$ 的离散方式。可以证明，要使离散[对流](@entry_id:141806)项不产生或消耗动能，相应的离散算子必须是**斜对称的**（**skew-symmetric**）。这意味着，对于任何离散[速度场](@entry_id:271461) $\mathbf{U}$，[内积](@entry_id:158127) $\langle \mathbf{U}, C(\mathbf{U}) \rangle$ 必须为零，其中 $C$ 是离散[对流](@entry_id:141806)算子。通过精心构造[中心差分](@entry_id:173198)和线性插值格式，可以设计出满足此条件的[二阶精度](@entry_id:137876)、[能量守恒](@entry_id:140514)的[对流](@entry_id:141806)项离散格式。相比之下，[迎风格式](@entry_id:756374)（upwind schemes）为了增强稳定性而引入了数值耗散，因此它们天生就是耗散能量的，而非守恒的 [@problem_id:2438327]。对于需要精确捕捉[能量串级](@entry_id:153717)过程的[湍流模拟](@entry_id:187401)等应用，构造[能量守恒](@entry_id:140514)的格式至关重要。

#### [无散场](@entry_id:260932)的结构

从更抽象的代数拓扑角度看，离散算子 $D$ 和 $G$ 及其性质揭示了离散流场的深刻结构。在一个二维周期性区域上，所有满足 $D\mathbf{u}=0$ 的离散无散[速度场](@entry_id:271461)构成的空间（即 $D$ 的核空间 $\mathcal{N}(D)$），其维度可以被精确确定。利用离散的[Hodge分解](@entry_id:160332)理论，可以证明这个空间的维度为 $N_x N_y + 1$ [@problem_id:2438312]。这个空间主要由两部分构成：
1.  可以由一个定义在网格顶点上的离散流函数 $\psi$ 通过离散[旋度算子](@entry_id:184984)生成的速度场。这部分空间的维度是 $N_x N_y - 1$。
2.  离散的**调和场**（harmonic fields），它们既无散也无旋。在[二维环面](@entry_id:265991)上（周期性区域），存在两个这样的场，分别对应于沿 $x$ 方向和 $y$ 方向的均匀流动。

这一结论为我们提供了关于离散解空间完备性的深刻理解。

#### 超越笛卡尔网格：非结构MAC格式

MAC格式的巨大成功自然引出了一个问题：我们能否将其思想推广到几何形状更复杂的**非结构网格**（如三角形或四面体网格）上？答案是肯定的，但这带来了新的挑战。

一个直接的推广是在三角形（或四面体）的中心存储压力，在每条边（或每个面）上定义一个法向速度自由度。这种安排天然地保证了**局域[质量守恒](@entry_id:204015)**，因为每个单元的散度就是其边界上法向通量的总和 [@problem_id:2438291]。然而，[梯度算子](@entry_id:275922)的构造变得棘手。一个简单的、基于相邻单元中心压力差的梯度近似，在网格非正交（即单元中心连线不垂直于共享边）时，会引入显著的误差，破坏格式的一致性和稳定性。

为了解决这个问题，研究者们发展了更先进的方法，如**模拟[有限差分](@entry_id:167874)**（**mimetic finite difference**）和**离散[外微分](@entry_id:161900)**（**discrete exterior calculus**）。这些方法的核心思想是在一个**[对偶网格](@entry_id:748700)**（**dual mesh**）上构造算子。例如，在Delaunay三角剖分及其对偶的Voronoi图上，由于原始边与对偶边正交，可以构建出天然满足负共轭关系的离散散度和[梯度算子](@entry_id:275922)对。这保证了[LBB条件](@entry_id:746626)的满足和格式的稳定性，从而成功地将交错网格的优良特性推广到了复杂的几何区域 [@problem_id:2438291]。这为现代计算流体动力学软件处理复杂外形流动问题铺平了道路。