## 引言
求解[对称矩阵的特征值](@entry_id:152966)问题是计算科学、物理学和工程学中的一个基石性任务。从揭示量子系统的能级到分析复杂结构的[振动](@entry_id:267781)模式，再到从高维数据中提取关键信息，[特征值](@entry_id:154894)和[特征向量](@entry_id:151813)提供了理解和简化复杂系统的强大数学语言。然而，对于大多数矩阵而言，特征值问题无法通过解析方法求解，这便催生了对高效、稳定的[数值算法](@entry_id:752770)的迫切需求。[雅可比旋转法](@entry_id:145350)正是这样一种经典且直观的迭代方法，它通过一种优雅的几何思想——一系列简单的平面旋转——来逐步将[矩阵对角化](@entry_id:138930)。

本文旨在全面解析[雅可比](@entry_id:264467)旋转方法。在“原理与机制”一章中，我们将深入其算法核心，从基本的平面旋转出发，探讨其收敛性保证和数值实现中的关键细节。接着，在“应用与交叉学科联系”一章中，我们将跨越学科界限，展示该方法如何在经典力学、[量子化学](@entry_id:140193)、数据科学等领域解决实际问题。最后，通过“动手实践”部分，您将有机会亲手实现并应用该算法，将理论知识转化为实践能力。通过本次学习，您将不仅掌握一种重要的数值方法，更能深刻体会到抽象数学工具在解决现实世界问题中的强大威力。

## 原理与机制

本章深入探讨雅可比旋转方法求解[对称矩阵特征值](@entry_id:151909)问题的核心原理和算法机制。我们将从其基本构建单元——平面旋转——出发，系统地分析其几何意义、收敛性质、数值实现中的关键细节以及算法性能。

### 核心机制：通过平面旋转实现对角化

[对称矩阵的特征值](@entry_id:152966)问题旨在找到一个正交矩阵 $V$ 和一个对角矩阵 $\Lambda$，使得一个给定的[实对称矩阵](@entry_id:192806) $A$ 可以被对角化为 $A = V \Lambda V^\top$。[雅可比方法](@entry_id:270947)通过一系列迭代的、简单的正交相似变换来逼近这一分解。

该方法的核心工具是**平面旋转**（或称 **Givens 旋转**）。一次平面旋转是在 $\mathbb{R}^n$ 空间中一个由两个[标准基向量](@entry_id:152417) $\mathbf{e}_p$ 和 $\mathbf{e}_q$ 张成的二维坐标平面内的旋转。该变换由一个正交矩阵 $G_{pq}(\theta)$ 表示，它在 $(p, q)$ [子空间](@entry_id:150286)中表现为标准旋转，而在该[子空间](@entry_id:150286)的[正交补](@entry_id:149922)上表现为[恒等变换](@entry_id:264671)。对于一个 $n \times n$ 矩阵，$G_{pq}(\theta)$ 除了以下四个元素外，其余元素与单位矩阵相同：
$G_{pp} = \cos\theta = c$
$G_{qq} = \cos\theta = c$
$G_{pq} = \sin\theta = s$
$G_{qp} = -\sin\theta = -s$

其中 $p  q$。[雅可比方法](@entry_id:270947)的目标是精心选择旋转角 $\theta$，使得在相似变换 $A' = G_{pq}(\theta)^\top A G_{pq}(\theta)$ 之后，新的非对角元素 $A'_{pq}$ 被**置零**（annihilated）。

让我们来推导这个关键的计算过程。由于 $G_{pq}$ 仅在行和列 $p, q$ 上非平凡，该相似变换也仅影响 $A$ 的第 $p, q$ 行和第 $p, q$ 列。变换后的 $(p, q)$ 子矩阵为：
$$
\begin{pmatrix} A'_{pp}  A'_{pq} \\ A'_{qp}  A'_{qq} \end{pmatrix} =
\begin{pmatrix} c  -s \\ s  c \end{pmatrix}^\top
\begin{pmatrix} A_{pp}  A_{pq} \\ A_{pq}  A_{qq} \end{pmatrix}
\begin{pmatrix} c  s \\ -s  c \end{pmatrix}
$$
展开计算新的非对角元素 $A'_{pq}$：
$$
A'_{pq} = (c^2 - s^2) A_{pq} - cs(A_{pp} - A_{qq})
$$
利用二[倍角公式](@entry_id:173961) $\cos(2\theta) = c^2 - s^2$ 和 $\sin(2\theta) = 2cs$，上式变为：
$$
A'_{pq} = A_{pq} \cos(2\theta) - \frac{1}{2} (A_{pp} - A_{qq}) \sin(2\theta)
$$
为了使 $A'_{pq} = 0$，我们得到：
$$
\frac{\sin(2\theta)}{\cos(2\theta)} = \tan(2\theta) = \frac{2 A_{pq}}{A_{pp} - A_{qq}}
$$
这个方程定义了实现一次置零操作所需的旋转角 $\theta$ [@problem_id:2405305] [@problem_id:2405313]。正是通过重复应用这种基本的置零步骤，[雅可比方法](@entry_id:270947)逐步将矩阵 $A$ 转化为[对角形式](@entry_id:264850)。

### 几何诠释与收敛性

从几何上看，每一次雅可比旋转都是在由**[标准基向量](@entry_id:152417)** $\mathbf{e}_p$ 和 $\mathbf{e}_q$ 张成的坐标平面内的一次[基变换](@entry_id:189626)，其目的不是旋转到由[特征向量](@entry_id:151813)张成的[子空间](@entry_id:150286)——这通常是未知的。该方法的目标正是通过一系列这样的简单旋转，逐步将标准基对齐到最终的[特征向量基](@entry_id:163721) [@problem_id:2405307]。

一个完整的**扫描**（sweep）是指对所有非对角元素对 $(p, q)$（其中 $p  q$）各执行一次旋转操作。如果将一次扫描中的所有[旋转矩阵](@entry_id:140302) $G_1, G_2, \dots, G_m$（其中 $m = n(n-1)/2$）相乘得到 $U = G_1 G_2 \cdots G_m$，那么经过一次完整扫描后的矩阵 $A^{(1)}$ 可以表示为一次单一的、更复杂的正交相似变换 $A^{(1)} = U^\top A U$ [@problem_id:2405307]。

然而，[雅可比方法](@entry_id:270947)必须是迭代的，一次扫描通常不足以将矩阵完全对角化。其根本原因在于，后续的旋转会“破坏”先前旋转所创造的零。例如，一次旨在置零 $A_{pq}$ 的旋转会改变第 $p$ 行和第 $q$ 行的所有元素。紧接着，如果对 $(q, r)$ 进行旋转，新的 $A'_{pr}$ 将是旧 $A_{pr}$ 和 $A_{qr}$ 的[线性组合](@entry_id:154743)，这几乎必然会使之前被置零的 $A_{pq}$ (通过行 $p$ 和列 $p$ 的更新)重新变为非零值 [@problem_id:2405307]。

尽管存在这种“破坏”效应，该方法总体上是收敛的。收敛性的关键在于衡量矩阵非对角化程度的量——所有非对角元素平方和，记为 $S(A) = \sum_{i \neq j} A_{ij}^2$。由于[正交变换](@entry_id:155650)保持矩阵的[弗罗贝尼乌斯范数](@entry_id:143384)（Frobenius norm）$\|A\|_F^2 = \sum_{i,j} A_{ij}^2$ 不变，我们有：
$$
\|A'\|_F^2 = \|A\|_F^2 \implies \sum_{i} (A'_{ii})^2 + S(A') = \sum_{i} (A_{ii})^2 + S(A)
$$
一次旋转仅改变对角元素 $A_{pp}$ 和 $A_{qq}$。通过计算可以证明 $(A'_{pp})^2 + (A'_{qq})^2 = A_{pp}^2 + A_{qq}^2 + 2A_{pq}^2$ (因为 $A'_{pq}=0$ )。代入上式，我们得到一个至关重要的结果：
$$
S(A') = S(A) - 2A_{pq}^2
$$
只要被选作目标的 $A_{pq}$ 不为零，每次旋转都会严格减小非对角元素的平方和 $S(A)$ [@problem_id:2918163]。这个单调递减且有下界（为零）的性质保证了，在无限次迭代后，$S(A^{(k)}) \to 0$，即矩阵序列 $A^{(k)}$ 收敛于一个对角矩阵 $\Lambda$。与此同时，累积的[旋转矩阵](@entry_id:140302) $V^{(k)} = G_1 G_2 \cdots G_k$ 收敛于一个[正交矩阵](@entry_id:169220) $V$，其列向量正是初始矩阵 $A$ 的[正交特征向量](@entry_id:155522)。这构成了对谱定理 $A=V\Lambda V^\top$ 的一个[构造性证明](@entry_id:157587) [@problem_id:2405307] [@problem_id:2405358]。值得强调的是，对于任意[实对称矩阵](@entry_id:192806)，只要采用合适的轴对选择策略（如循环扫描），[雅可比方法的收敛性](@entry_id:147471)是有保证的，即使矩阵存在重根或[退化特征值](@entry_id:187316) [@problem_id:2918163]。

### 数值实现与稳定性考量

将理论算法转化为可靠的计算机程序，需要细致处理[有限精度算术](@entry_id:142321)带来的挑战。

#### 旋转角的选择

由 $\tan(2\theta)$ 定义的旋转角存在模糊性：如果 $\theta_0$ 是一个解，那么 $\theta_0 + \pi/2$ 也是一个解。这两个解对应于两个不同的旋转。在数值实践中，我们总是选择[绝对值](@entry_id:147688)较小的那个解，即满足 $|\theta| \le \pi/4$ 的解。这个选择并非为了更快地减小非对角范数——事实上，两种角度选择对 $S(A)$ 的单步缩减量 $2A_{pq}^2$ 是完全相同的 [@problem_id:2405305]。

选择小角度的真正原因在于**[数值稳定性](@entry_id:146550)**。当 $|\theta| \le \pi/4$ 时，我们有 $|\tan\theta| \le 1$ 和 $|\sin\theta| \le |\cos\theta|$。这意味着旋转矩阵 $G_{pq}(\theta)$ 更“接近”[单位矩阵](@entry_id:156724)。在更新矩阵 $A$ 的其他元素时（例如，$A'_{ik} = c A_{ik} - s A_{jk}$），较小的 $\sin\theta$ 和 $\tan\theta$ 值可以避免放大已有元素 $A_{jk}$ 中可能存在的[舍入误差](@entry_id:162651)，从而使变换过程更加“温和”，减少[误差累积](@entry_id:137710) [@problem_id:2405305]。

#### 旋转参数的稳定计算

直接计算 $\theta$ 不仅低效，而且数值上不稳定。通常我们转而计算 $t = \tan\theta$。令 $\tau = (A_{qq} - A_{pp}) / (2A_{pq})$，则 $t$ 满足[二次方程](@entry_id:163234) $t^2 + 2\tau t - 1 = 0$。此方程的两个根乘积为 $-1$，其中一个根的[绝对值](@entry_id:147688)小于等于 1，正好对应我们想要的 $|\theta| \le \pi/4$。

然而，使用标准[求根](@entry_id:140351)公式 $t = -\tau \pm \sqrt{1+\tau^2}$ 计算这个小根时，如果 $|\tau|$ 非常大，就会出现两个几乎相等的巨大数相减的情况，导致**灾难性抵消**（catastrophic cancellation），严重损失相对精度。为了避免这种情况，我们使用一个等价但数值上稳定的公式来计算小根 $t$ [@problem_id:2405305]：
$$
t = \frac{\operatorname{sign}(\tau)}{|\tau| + \sqrt{1 + \tau^2}}
$$
其中 $\operatorname{sign}(0)$ 取为 $1$。

#### [浮点数](@entry_id:173316)病态问题

即使采用了稳定的参数计算公式，极端[数值范围](@entry_id:752817)的输入仍然可能导致算法失败。考虑一个矩阵，其对角元素 $A_{pp}$ 和 $A_{qq}$ 的量级极大，例如 $10^{308}$，而非对角元 $A_{pq}$ 很小 [@problem_id:2405301]。在这种情况下，计算 $\tau$ 会得到一个[绝对值](@entry_id:147688)极大的数。接着，在计算 $t$ 的分母时，中间项 $\tau^2$ 可能会超出计算机浮点数（如 [IEEE 754](@entry_id:138908) [双精度](@entry_id:636927)）所能表示的最大范围，导致**[上溢](@entry_id:172355)**（overflow），其结果被记为无穷大 (`Inf`)。随后的计算 $t = 1/(\tau + \text{Inf})$ 将得出 $t=0$，进而 $s=0, c=1$。这意味着计算出的[旋转矩阵](@entry_id:140302)实际上是[单位矩阵](@entry_id:156724)，变换 $A' = G^\top A G$ 不会改变 $A$ 的任何值，算法就此停滞，无法收敛 [@problem_id:2405301]。这深刻地揭示了理论上的收敛保证与实际有限精度计算之间的鸿沟，也凸显了现代数值库（如 [LAPACK](@entry_id:751137)）中复杂而稳健的实现技术的重要性。

在整个迭代过程中，由于每次变换都是正交相似变换 $A' = G^\top A G$，如果初始矩阵 $A$ 是对称的，那么所有后续的矩阵 $A^{(k)}$ 也将保持对称性。同样，如果 $A$ 是实矩阵，且旋转角 $\theta$ 是实数，那么所有中间矩阵都将保持为实矩阵。累积的[变换矩阵](@entry_id:151616) $Q^{(k)}$ 作为正交矩阵的乘积，始终保持正交性 [@problem_id:2918163]。

### 算法变体与性能分析

#### 轴对选择策略（Pivoting Strategy）

如何选择在每一步要置零的非对角元素 $(p,q)$，是决定算法具体行为和效率的关键。

*   **经典/贪心策略**：在每一步，搜索整个矩阵，找到[绝对值](@entry_id:147688)最大的非对角元素 $|A_{pq}|$ 进行置零。这个策略保证了在单步中 $S(A)$ 的下降量 $2A_{pq}^2$ 是最大的，通常收敛最快。[@problem_id:2405313]

*   **循环策略**：不进行搜索，而是按照一个预先固定的顺序遍历所有非对角元对。常见的有**[行主序](@entry_id:634801)**（row-wise）和**[列主序](@entry_id:637645)**（column-wise）扫描。这种策略避免了每步 $O(n^2)$ 的搜索开销，实现简单。[@problem_id:2405341]

在精确算术下，不同的扫描顺序最终会得到相同的[特征值](@entry_id:154894)集合。但在浮点运算中，由于运算顺序的改变，累积的[舍入误差](@entry_id:162651)会有微小差异，导致最终得到的[特征值](@entry_id:154894)可能存在微小偏差。对于精心设计的数值问题，这种偏差通常在[机器精度](@entry_id:756332)范围内，不会影响结果的正确性 [@problem_id:2405341]。

#### 收敛速度

对于采用循环策略的[雅可比方法](@entry_id:270947)，当矩阵的[特征值](@entry_id:154894)互不相同时（即谱是简单的），其最终收敛速度是**二次**的。这意味着在接近收敛时，每完成一次完整的扫描，非对角元素的范数大约会变为原先的平方，即 $\operatorname{off}(A^{(\text{k+1-sweep})}) = \mathcal{O}(\operatorname{off}(A^{(\text{k-sweep})})^2)$ [@problem_id:2918163]。这是一种非常快的收敛速度，意味着有效数字的数量在每次扫描后大约翻倍。然而，当矩阵存在簇状[分布](@entry_id:182848)或[重根](@entry_id:151486)的[特征值](@entry_id:154894)时（例如著名的[威尔金森矩阵](@entry_id:635108) `Wilkinson matrix`），收敛速度会显著下降 [@problem_id:2405362]。

#### 计算成本

*   **单次旋转成本**：对于一个 $n \times n$ 的稠密矩阵，一次[雅可比](@entry_id:264467)旋转需要更新第 $p$ 和第 $q$ 两行两列，涉及的元素数量为 $O(n)$。因此，单次旋转的计算成本（[浮点运算次数](@entry_id:749457)）为 $O(n)$。

*   **eigenvector 更新成本**：如果需要计算[特征向量](@entry_id:151813)，累积[变换矩阵](@entry_id:151616) $V$ 也需要更新：$V' = V G$。这仅涉及更新 $V$ 的第 $p$ 和第 $q$ 列，其成本同样是 $O(n)$。精确分析表明，更新 $A$ 的相关部分的成本为 $6(n-2)$ 次[浮点运算](@entry_id:749454)，而更新 $V$ 的成本为 $6n$ 次。两者的比值为 $n/(n-2)$ [@problem_id:2405291]。对于大矩阵 $n$，这两个成本几乎相等。

*   **总成本**：一次完整的扫描包含 $O(n^2)$ 次旋转，因此一次扫描的总成本是 $O(n^3)$。由于通常需要一个小的常数次（例如 5-10 次）扫描即可达到收敛，[雅可比方法](@entry_id:270947)的总计算复杂度为 $O(n^3)$。

#### 关于对角元素排序的误区

一个常见的误解是，[雅可比方法](@entry_id:270947)是否会将最终的对角元素（即[特征值](@entry_id:154894)）按特定顺序[排列](@entry_id:136432)。事实上，标准的雅可比算法并**不保证**将[特征值](@entry_id:154894)按升序或降序[排列](@entry_id:136432)。