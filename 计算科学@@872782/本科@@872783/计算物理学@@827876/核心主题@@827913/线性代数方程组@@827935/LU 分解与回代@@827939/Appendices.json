{"hands_on_practices": [{"introduction": "掌握 LU 分解的第一步是亲手推导一个具体矩阵的分解形式。本练习选取了二维旋转矩阵，这是一个在物理学和图形学中无处不在的基本工具。通过为这个具体且有物理意义的矩阵推导其解析的 LU 分解形式 [@problem_id:2409827]，你不仅能熟悉分解的代数步骤，还能将抽象的线性代数概念与一个具体的几何变换联系起来。", "problem": "在计算物理学中，平面中的线性变换通常用矩阵表示，而矩阵的分解有助于高效的数值求解器。考虑一个绕原点旋转角度为 $\\theta$（单位为弧度）的二维旋转，它由 $2 \\times 2$ 矩阵表示\n$$\nR(\\theta) = \\begin{pmatrix}\n\\cos\\theta & -\\sin\\theta \\\\\n\\sin\\theta & \\cos\\theta\n\\end{pmatrix}.\n$$\n确定 $R(\\theta)$ 的下三角-上三角 (LU) 分解（LU代表下三角-上三角分解），约定下三角因子 $L$ 的对角线元素全为1，且不使用行交换。假设 $\\cos\\theta \\neq 0$，因此不需要进行行交换。将 $R(\\theta)$ 表示为 $R(\\theta) = L U$ 的形式，其中 $L$ 是单位下三角矩阵，$U$ 是上三角矩阵，并以 $\\theta$ 的函数形式给出矩阵 $L(\\theta)$ 和 $U(\\theta)$ 的闭式表达式。\n\n答案格式要求：请以一个单独的解析表达式给出最终答案，该表达式为一个行矩阵，其两个元素分别为矩阵 $L(\\theta)$ 和 $U(\\theta)$。无需取整，也不涉及单位。", "solution": "必须首先对问题陈述进行严格验证。\n\n步骤1：提取已知条件。\n问题提供了以下信息：\n- 一个表示二维旋转角度为 $\\theta$ 的 $2 \\times 2$ 矩阵：$R(\\theta) = \\begin{pmatrix} \\cos\\theta & -\\sin\\theta \\\\ \\sin\\theta & \\cos\\theta \\end{pmatrix}$。\n- 任务是求 $R(\\theta)$ 的下三角-上三角 (LU) 分解。\n- 分解必须遵循 $R(\\theta) = L U$ 的形式，其中 $L$ 是一个单位下三角矩阵（对角线元素为1），$U$ 是一个上三角矩阵。\n- 做出了一个明确的假设：$\\cos\\theta \\neq 0$，这保证了不需要进行行交换。\n- 要求的输出是矩阵 $L(\\theta)$ 和 $U(\\theta)$ 的闭式表达式。\n\n步骤2：使用提取的已知条件进行验证。\n- **科学依据**：该问题基于线性代数的基本概念，特别是LU分解及其在旋转矩阵上的应用，这是计算物理学和工程学中的一个标准课题。这些概念在数学上和科学上都是合理的。\n- **适定性**：该问题是适定的。它指明了要分解的矩阵、分解的精确形式（单位下三角矩阵 $L$），并提供了一个必要条件（$\\cos\\theta \\neq 0$）来保证作为无主元LU分解基础的标准高斯消元过程不会失败。这确保了 $L$ 和 $U$ 的唯一解存在。\n- **客观性**：该问题使用精确、客观的数学语言陈述，没有任何歧义或主观看法。\n\n结论：该问题有效。它是线性代数中一个标准的、定义明确的练习题。我将继续进行求解。\n\n目标是找到一个单位下三角矩阵 $L$ 和一个上三角矩阵 $U$，使得 $R(\\theta) = L U$。鉴于 $R(\\theta)$ 是一个 $2 \\times 2$ 矩阵，矩阵 $L$ 和 $U$ 也将是 $2 \\times 2$ 矩阵。它们的一般形式是：\n$$\nL = \\begin{pmatrix} 1 & 0 \\\\ l_{21} & 1 \\end{pmatrix}\n\\quad \\text{和} \\quad\nU = \\begin{pmatrix} u_{11} & u_{12} \\\\ 0 & u_{22} \\end{pmatrix}\n$$\n这里，$l_{21}$、$u_{11}$、$u_{12}$ 和 $u_{22}$ 是我们必须确定为 $\\theta$ 的函数的未知元素。\n\n分解方程为：\n$$\nR(\\theta) = \\begin{pmatrix} \\cos\\theta & -\\sin\\theta \\\\ \\sin\\theta & \\cos\\theta \\end{pmatrix} = L U = \\begin{pmatrix} 1 & 0 \\\\ l_{21} & 1 \\end{pmatrix} \\begin{pmatrix} u_{11} & u_{12} \\\\ 0 & u_{22} \\end{pmatrix}\n$$\n对等式右侧执行矩阵乘法，得到：\n$$\n\\begin{pmatrix} 1 & 0 \\\\ l_{21} & 1 \\end{pmatrix} \\begin{pmatrix} u_{11} & u_{12} \\\\ 0 & u_{22} \\end{pmatrix} = \\begin{pmatrix} 1 \\cdot u_{11} + 0 \\cdot 0 & 1 \\cdot u_{12} + 0 \\cdot u_{22} \\\\ l_{21} \\cdot u_{11} + 1 \\cdot 0 & l_{21} \\cdot u_{12} + 1 \\cdot u_{22} \\end{pmatrix} = \\begin{pmatrix} u_{11} & u_{12} \\\\ l_{21} u_{11} & l_{21} u_{12} + u_{22} \\end{pmatrix}\n$$\n通过令 $R(\\theta)$ 和得到的 $LU$ 乘积的对应元素相等，我们得到一个方程组：\n$$\n\\begin{pmatrix} \\cos\\theta & -\\sin\\theta \\\\ \\sin\\theta & \\cos\\theta \\end{pmatrix} = \\begin{pmatrix} u_{11} & u_{12} \\\\ l_{21} u_{11} & l_{21} u_{12} + u_{22} \\end{pmatrix}\n$$\n我们可以依次求解未知数。从第一行得到：\n1.  $u_{11} = \\cos\\theta$\n2.  $u_{12} = -\\sin\\theta$\n\n从第二行得到：\n3.  $l_{21} u_{11} = \\sin\\theta$。代入 $u_{11}$ 的表达式，我们得到 $l_{21} \\cos\\theta = \\sin\\theta$。因为题目说明 $\\cos\\theta \\neq 0$，我们可以两边同除以 $\\cos\\theta$ 来求得 $l_{21}$：\n    $$\n    l_{21} = \\frac{\\sin\\theta}{\\cos\\theta} = \\tan\\theta\n    $$\n4.  $l_{21} u_{12} + u_{22} = \\cos\\theta$。我们代入已知的 $l_{21}$ 和 $u_{12}$ 的值：\n    $$\n    (\\tan\\theta)(-\\sin\\theta) + u_{22} = \\cos\\theta\n    $$\n    求解 $u_{22}$：\n    $$\n    u_{22} = \\cos\\theta + \\tan\\theta \\sin\\theta = \\cos\\theta + \\frac{\\sin\\theta}{\\cos\\theta} \\sin\\theta = \\frac{\\cos^2\\theta + \\sin^2\\theta}{\\cos\\theta}\n    $$\n    使用基本三角恒等式 $\\cos^2\\theta + \\sin^2\\theta = 1$，上式可简化为：\n    $$\n    u_{22} = \\frac{1}{\\cos\\theta} = \\sec\\theta\n    $$\n找到了所有未知元素后，我们可以构建矩阵 $L(\\theta)$ 和 $U(\\theta)$：\n$$\nL(\\theta) = \\begin{pmatrix} 1 & 0 \\\\ \\tan\\theta & 1 \\end{pmatrix}\n$$\n$$\nU(\\theta) = \\begin{pmatrix} \\cos\\theta & -\\sin\\theta \\\\ 0 & \\sec\\theta \\end{pmatrix}\n$$\n这些就是旋转矩阵 $R(\\theta)$ 的单位下三角因子和上三角因子，对所有满足 $\\cos\\theta \\neq 0$ 的 $\\theta$ 均有效。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\begin{pmatrix} 1 & 0 \\\\ \\tan\\theta & 1 \\end{pmatrix} & \\begin{pmatrix} \\cos\\theta & -\\sin\\theta \\\\ 0 & \\sec\\theta \\end{pmatrix} \\end{pmatrix}}\n$$", "id": "2409827"}, {"introduction": "在掌握了基本的分解方法后，我们可以进一步探究矩阵的特殊性质如何反映在其 LU 因子上。许多物理问题，特别是源于自伴算子的系统，都由对称矩阵描述。这个练习 [@problem_id:2409852] 让你从一个已知的下三角因子 $L$ 出发，反向构造一个对称矩阵 $A$，从而揭示对称性对 $L$ 和 $U$ 因子施加的深刻约束。", "problem": "在一维自伴边值问题的有限差分方法离散化中，所得到的系统矩阵是对称的。假设 Doolittle 分解的某个中间步骤提供了一个单位下三角矩阵\n$$\nL=\\begin{pmatrix}\n1 & 0 & 0\\\\\n2 & 1 & 0\\\\\n-1 & 3 & 1\n\\end{pmatrix}.\n$$\n构建一个非平凡的对称矩阵 $A$，使得 $A=LU$，其中 $U$ 是一个对角线元素为正的上三角矩阵，并且额外要求 $U$ 的对角线元素按顺序分别为 $4$，$5$ 和 $6$。矩阵 $A$ 的 $(2,3)$ 元素是什么？请以精确值形式给出答案，不要四舍五入。", "solution": "对所述问题进行验证。\n\n**步骤1：提取已知条件**\n- 系统矩阵 $A$ 是对称的，即 $A = A^T$.\n- 矩阵 $A$ 有一个 Doolittle 分解 $A = LU$.\n- 下三角矩阵 $L$ 如下所示：\n$$\nL=\\begin{pmatrix}\n1 & 0 & 0\\\\\n2 & 1 & 0\\\\\n-1 & 3 & 1\n\\end{pmatrix}\n$$\n- 矩阵 $U$ 是一个对角线元素为正的上三角矩阵。\n- 矩阵 $U$ 的对角线元素为 $u_{11} = 4$, $u_{22} = 5$, 和 $u_{33} = 6$.\n- 任务是求矩阵 $A$ 的元素 $a_{23}$ 的值。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题在数学上和科学上是合理的。这是一个定义明确的线性代数问题，具体涉及矩阵分解。对称矩阵产生于自伴算子的有限差分离散化这一前提，在计算物理学中是标准的。已知条件是自洽且一致的。这些约束条件足以确定矩阵 $A$ 的唯一解，并进而确定其元素 $a_{23}$。该问题不是不适定的、不完整的，也不是基于错误的前提。\n\n**结论**\n问题有效。我们开始求解。\n\n问题要求从一个对称矩阵 $A$ 的 Doolittle 分解 $A=LU$ 来构建它，其中 $L$ 是一个给定的单位下三角矩阵，而 $U$ 是一个指定了对角线元素的上三角矩阵。\n\n矩阵 $A$ 的基本性质是它是对称的，即 $A = A^T$。代入分解式 $A=LU$，我们得到条件：\n$$\nLU = (LU)^T = U^T L^T\n$$\n其中 $L^T$ 和 $U^T$ 分别是 $L$ 和 $U$ 的转置矩阵。\n\n给定的矩阵 $L$ 为：\n$$\nL=\\begin{pmatrix}\n1 & 0 & 0\\\\\n2 & 1 & 0\\\\\n-1 & 3 & 1\n\\end{pmatrix}\n$$\n矩阵 $U$ 是一个指定了对角线元素的上三角矩阵。设其未知的非对角线元素为 $u_{12}$, $u_{13}$, 和 $u_{23}$。\n$$\nU=\\begin{pmatrix}\n4 & u_{12} & u_{13}\\\\\n0 & 5 & u_{23}\\\\\n0 & 0 & 6\n\\end{pmatrix}\n$$\n我们可以通过执行矩阵乘法 $A = LU$ 来构建矩阵 $A$。\n$$\nA = \\begin{pmatrix}\n1 & 0 & 0\\\\\n2 & 1 & 0\\\\\n-1 & 3 & 1\n\\end{pmatrix}\n\\begin{pmatrix}\n4 & u_{12} & u_{13}\\\\\n0 & 5 & u_{23}\\\\\n0 & 0 & 6\n\\end{pmatrix}\n$$\n执行乘法，我们得到 $A$ 的元素。\n$$\na_{11} = (1)(4) + (0)(0) + (0)(0) = 4\n$$\n$$\na_{12} = (1)(u_{12}) + (0)(5) + (0)(0) = u_{12}\n$$\n$$\na_{13} = (1)(u_{13}) + (0)(u_{23}) + (0)(6) = u_{13}\n$$\n$$\na_{21} = (2)(4) + (1)(0) + (0)(0) = 8\n$$\n$$\na_{22} = (2)(u_{12}) + (1)(5) + (0)(0) = 2u_{12} + 5\n$$\n$$\na_{23} = (2)(u_{13}) + (1)(u_{23}) + (0)(6) = 2u_{13} + u_{23}\n$$\n$$\na_{31} = (-1)(4) + (3)(0) + (1)(0) = -4\n$$\n$$\na_{32} = (-1)(u_{12}) + (3)(5) + (1)(0) = -u_{12} + 15\n$$\n$$\na_{33} = (-1)(u_{13}) + (3)(u_{23}) + (1)(6) = -u_{13} + 3u_{23} + 6\n$$\n因此，矩阵 $A$ 是：\n$$\nA = \\begin{pmatrix}\n4 & u_{12} & u_{13} \\\\\n8 & 2u_{12} + 5 & 2u_{13} + u_{23} \\\\\n-4 & -u_{12} + 15 & -u_{13} + 3u_{23} + 6\n\\end{pmatrix}\n$$\n现在，我们施加对称条件 $A = A^T$，这意味着对所有的 $i, j$ 都有 $a_{ij} = a_{ji}$。\n比较非对角线元素：\n1.  从 $a_{21} = a_{12}$，我们有 $8 = u_{12}$。\n2.  从 $a_{31} = a_{13}$，我们有 $-4 = u_{13}$。\n3.  从 $a_{32} = a_{23}$，我们有 $-u_{12} + 15 = 2u_{13} + u_{23}$。\n\n我们已经确定了 $u_{12}$ 和 $u_{13}$ 的唯一值。我们将这些值代入第三个方程来求 $u_{23}$。\n$$\n-(8) + 15 = 2(-4) + u_{23}\n$$\n$$\n7 = -8 + u_{23}\n$$\n$$\nu_{23} = 7 + 8 = 15\n$$\n现在 $U$ 的未知元素已完全确定：$u_{12} = 8$, $u_{13} = -4$, 和 $u_{23} = 15$。\n问题要求矩阵 $A$ 的元素 $a_{23}$。从我们对乘积 $LU$ 的计算中，我们有：\n$$\na_{23} = 2u_{13} + u_{23}\n$$\n代入我们求得的 $u_{13}$ 和 $u_{23}$ 的值：\n$$\na_{23} = 2(-4) + 15 = -8 + 15 = 7\n$$\n为了验证，我们也可以计算 $a_{32}$：\n$$\na_{32} = -u_{12} + 15 = -(8) + 15 = 7\n$$\n由于 $a_{23} = a_{32} = 7$，我们的计算与 $A$ 的对称性是一致的。所求的元素是 $7$。", "answer": "$$\n\\boxed{7}\n$$", "id": "2409852"}, {"introduction": "从理想的数学世界迈向实际的计算机运算，我们必须面对浮点数算术带来的挑战，其中最核心的问题之一就是数值稳定性。这个综合性练习 [@problem_id:2409891] 引导你分析并编程验证，在回代求解过程中，一个很小的对角元素（主元）会如何急剧放大舍入误差。完成这个练习将让你深刻理解为什么像主元选择这样的技术在数值计算中至关重要，这也是区分计算科学新手与专家的关键一步。", "problem": "考虑在浮点运算中使用回代法求解 $L U$ 分解（其中 $L$ 表示单位下三角矩阵，$U$ 表示上三角矩阵）后出现的线性系统 $U x = y$。采用标准浮点模型：每次基本运算满足 $\\operatorname{fl}(a \\,\\circ\\, b) = (a \\,\\circ\\, b) (1 + \\delta)$，其中 $|\\delta| \\le u$，$u$ 为单位舍入。假设基数 $\\beta = 2$，精度 $p = 53$（因此 $u = 2^{-53}$）。回代法通过从 $i = n$ 向下迭代至 $i = 1$，使用递推公式 $x_i = \\left(y_i - \\sum_{j=i+1}^{n} U_{ij} x_j\\right) / U_{ii}$ 从 $U x = y$ 计算 $x$。你将分析当 $|U_{nn}|$ 非常小时，右端最后一项 $y_n$ 中的浮点扰动是如何被放大的。\n\n任务：\n1) 仅从浮点模型和回代法的定义出发，推导回代法计算出的最后一个分量 $\\widehat{x}_n$ 的绝对误差的界。设真实（精确算术）值为 $x_n^{\\star} = y_n / U_{nn}$，但可用的右端项受到加性扰动，变为 $y_n + \\varepsilon$，其中未知的 $\\varepsilon$ 满足 $|\\varepsilon| \\le \\eta$，且减法和除法在浮点运算中执行。你的界必须用 $|U_{nn}|$, $|y_n|$, $u$, 和 $\\eta$ 表示，并且不得假设任何超出模型所暗示的相消。重点关注 $i = n$ 的单步回代过程。\n2) 将你的界具体化到以下情况：$x^{\\star} = \\mathbf{1}$（全为1），$U$ 是上三角矩阵，其最后一行除了 $U_{nn} = \\alpha > 0$ 外均为零，且 $y = U x^{\\star}$。假设在计算 $x_n$ 之前，一个大小恰好为 $u$ 的绝对扰动被加到 $y_n$ 上（并且所有其他运算都在浮点运算中执行）。定义放大因子 $A(\\alpha) = \\dfrac{|\\widehat{x}_n - 1|}{u}$。使用你的界，预测当 $u$ 很小时 $A(\\alpha)$ 作为 $\\alpha$ 的函数。\n3) 实现一个完整的、可运行的程序，对于每个测试 $(n,\\alpha)$，构建一个 $n \\times n$ 的上三角矩阵 $U$，其中 $U_{ii} = 1$（对于 $i = 1, \\dots, n-1$），$U_{nn} = \\alpha$，$U_{ij} = 1/2$（对于 $1 \\le i  j  n-1$），且 $U_{n,j} = 0$（对于 $j = 1, \\dots, n-1$）。令 $x^{\\star} = \\mathbf{1}$ 且 $y = U x^{\\star}$。在双精度下执行标准回代法计算 $\\widehat{x}$，但在为计算最后一个分量而进行除法之前，通过将 $y_n$ 替换为 $y_n + u$ 来注入一个大小恰好为 $u$ 的绝对扰动。对于每个测试，报告量 $R(\\alpha) = \\alpha \\cdot \\dfrac{|\\widehat{x}_n - 1|}{u}$。第2项中的分析预测，当 $u$ 很小时 $R(\\alpha) \\approx 1$。\n4) 使用以下 $(n,\\alpha)$ 对的测试套件来测试典型、小和极小的最后一个主元，包括一个边界尺度的情况：\n- $(n,\\alpha) = (6, 1)$\n- $(n,\\alpha) = (6, 2^{-10})$\n- $(n,\\alpha) = (6, 2^{-40})$\n- $(n,\\alpha) = (6, 2^{-53})$\n- $(n,\\alpha) = (6, 2^{-100})$\n- $(n,\\alpha) = (6, 2^{-300})$\n你的程序必须输出一行，其中包含测试套件的 $R(\\alpha)$ 值，格式为方括号括起来的逗号分隔列表，例如 $[r_1,r_2,\\dots,r_6]$，其中每个 $r_k$ 是一个浮点数。\n\n注：\n- 不涉及物理单位。\n- 不使用角度。\n- 最终输出格式必须是如上所述的、由方括号括起来的逗号分隔列表的一行。", "solution": "我们在标准浮点模型下分析最后一个方程的单步回代过程。精确的最后一个方程是 $U_{nn} x_n^{\\star} = y_n$。在回代法中，计算出的最后一个分量使用公式\n$$\nx_n = \\frac{y_n - \\sum_{j=n+1}^{n} U_{nj} x_j}{U_{nn}} = \\frac{y_n}{U_{nn}},\n$$\n因为不存在 $j > n$ 的项。假设可用的右端项受到加性扰动，变为 $y_n + \\varepsilon$ 且 $|\\varepsilon| \\le \\eta$，并应用浮点减法和除法来计算 $\\widehat{x}_n$。\n\n在浮点模型 $\\operatorname{fl}(a \\,\\circ\\, b) = (a \\,\\circ\\, b) (1 + \\delta)$ 且 $|\\delta| \\le u$ 下，并将注意力集中在最后一步，我们得到最后一个方程的计算序列：\n- 由于求和项为零，减法简化为空操作；然而，为了符合模型，我们在形成中间值时仍然允许一次舍入。令中间值为\n$$\n\\widehat{y}_n = \\operatorname{fl}(y_n + \\varepsilon) = (y_n + \\varepsilon) (1 + \\delta_1), \\quad |\\delta_1| \\le u.\n$$\n- 除法在浮点运算中执行：\n$$\n\\widehat{x}_n = \\operatorname{fl}\\left( \\frac{\\widehat{y}_n}{U_{nn}} \\right) = \\left( \\frac{\\widehat{y}_n}{U_{nn}} \\right) (1 + \\delta_2), \\quad |\\delta_2| \\le u.\n$$\n结合这两个步骤可得\n$$\n\\widehat{x}_n = \\left( \\frac{y_n + \\varepsilon}{U_{nn}} \\right) (1 + \\delta_1)(1 + \\delta_2).\n$$\n令 $x_n^{\\star} = \\dfrac{y_n}{U_{nn}}$ 表示精确值。那么\n$$\n\\widehat{x}_n - x_n^{\\star} = \\frac{y_n + \\varepsilon}{U_{nn}} (1 + \\delta_1)(1 + \\delta_2) - \\frac{y_n}{U_{nn}}.\n$$\n重写并加上再减去 $\\dfrac{y_n}{U_{nn}} (1 + \\delta_1)(1 + \\delta_2)$ 可得\n$$\n\\widehat{x}_n - x_n^{\\star} = \\frac{\\varepsilon}{U_{nn}} (1 + \\delta_1)(1 + \\delta_2) + \\frac{y_n}{U_{nn}} \\left[ (1 + \\delta_1)(1 + \\delta_2) - 1 \\right].\n$$\n对于小的 $u$，使用 $|(1 + \\delta_1)(1 + \\delta_2)| \\le (1+u)^2 \\le 1 + 3u$ 和 $|(1 + \\delta_1)(1 + \\delta_2) - 1| \\le |\\delta_1| + |\\delta_2| + |\\delta_1 \\delta_2| \\le 2u + u^2 \\le 3u$，我们得到界\n$$\n|\\widehat{x}_n - x_n^{\\star}| \\le \\frac{|\\varepsilon|}{|U_{nn}|} (1 + 3u) + \\frac{|y_n|}{|U_{nn}|} \\cdot 3u.\n$$\n忽略 $u^2$ 及更高阶的项（这在 $u \\ll 1$ 的条件下对于高等本科生分析是合适的），一个简洁的界是\n$$\n|\\widehat{x}_n - x_n^{\\star}| \\le \\frac{|\\varepsilon|}{|U_{nn}|} + C \\, u \\, \\frac{|y_n|}{|U_{nn}|},\n$$\n其中 $C$ 是一个不大的常数，例如 $C=3$。这证明了 $y_n$ 中的一个绝对扰动 $|\\varepsilon|$ 在绝对误差中被放大了约 $1/|U_{nn}|$ 倍，同时还有来自两次浮点运算的一个与 $u \\, |y_n|/|U_{nn}|$ 成比例的额外小贡献。\n\n我们现在将情况具体化为 $x^{\\star} = \\mathbf{1}$，$U$ 是上三角矩阵，其最后一行除了 $U_{nn} = \\alpha > 0$ 外均为零，且 $y = U x^{\\star}$。对于最后一行，在精确算术下，$y_n = \\alpha$ 且 $x_n^{\\star} = 1$。如果在计算 $x_n$ 之前，将一个大小恰好为 $u$ 的绝对扰动注入到 $y_n$ 中，我们有 $|\\varepsilon| = u$ 且 $|y_n| = \\alpha$。误差界变为\n$$\n|\\widehat{x}_n - 1| \\le \\frac{u}{\\alpha} + C \\, u \\, \\frac{\\alpha}{\\alpha} = \\frac{u}{\\alpha} + C u.\n$$\n对于小的 $\\alpha$，主导项是 $u/\\alpha$，并且放大因子\n$$\nA(\\alpha) = \\frac{|\\widehat{x}_n - 1|}{u}\n$$\n满足\n$$\nA(\\alpha) \\approx \\frac{1}{\\alpha} \\quad \\text{对于小的 } \\alpha,\n$$\n其中 $C$ 是来自减法和除法舍入的一个低阶加法项。因此，预计对于很大范围的 $\\alpha$ 值，只要 $u$ 很小，缩放后的量\n$$\nR(\\alpha) = \\alpha \\cdot \\frac{|\\widehat{x}_n - 1|}{u}\n$$\n就满足 $R(\\alpha) \\approx 1$。\n\n程序的算法设计：\n- 对于每个测试 $(n,\\alpha)$，构建上三角矩阵 $U$，其中 $U_{ii} = 1$（对于 $i = 1, \\dots, n-1$），$U_{nn} = \\alpha$，$U_{ij} = 1/2$（对于 $1 \\le i  j  n-1$），且 $U_{n,j} = 0$（对于 $j = 1, \\dots, n-1$）。令 $x^{\\star} = \\mathbf{1}$ 且 $y = U x^{\\star}$。\n- 用双精度实现回代法。在计算最后一个分量时，在除以 $U_{nn}$ 之前，立即向 $y_n$ 添加一个绝对扰动 $u$。\n- 为每个测试记录 $R(\\alpha) = \\alpha \\cdot \\dfrac{|\\widehat{x}_n - 1|}{u}$。根据分析，这些值在整个测试套件中都应接近 1，这说明绝对误差放大因子约为 $1/\\alpha$，而缩放后的度量 $R(\\alpha)$ 接近于 1。\n- 将列表 $[R(\\alpha_1), R(\\alpha_2), \\dots]$ 作为单个用方括号括起来的逗号分隔列表输出。\n\n这种方法将观察到的放大效应直接建立在浮点模型的基础上，并隔离了小的 $U_{nn}$ 对回代步骤的影响。", "answer": "```python\nimport numpy as np\n\ndef solve_and_report():\n    \"\"\"\n    Runs the numerical experiment described in the problem and prints the results.\n    \"\"\"\n    # Machine epsilon for double precision\n    u = 2**-53\n    \n    test_suite = [\n        (6, 1.0),\n        (6, 2**-10),\n        (6, 2**-40),\n        (6, 2**-53),\n        (6, 2**-100),\n        (6, 2**-300)\n    ]\n    results = []\n\n    for n, alpha in test_suite:\n        # Step 1: Build the n x n upper triangular matrix U\n        U = np.zeros((n, n), dtype=float)\n        # Set diagonal elements\n        for i in range(n - 1):\n            U[i, i] = 1.0\n        U[n - 1, n - 1] = alpha\n        # Set upper triangular elements as per the problem description\n        for i in range(n - 1):\n            for j in range(i + 1, n - 1):\n                U[i, j] = 0.5\n        # The last row's off-diagonal elements are already 0 from np.zeros\n\n        # Step 2: Define the exact solution x_star and compute the right-hand side y\n        x_star = np.ones(n, dtype=float)\n        y = U @ x_star\n        \n        # Step 3: Inject a perturbation of size u into the last element of y\n        y_perturbed = np.copy(y)\n        y_perturbed[n - 1] += u\n        \n        # Step 4: Perform back substitution to solve U * x_hat = y_perturbed\n        x_hat = np.zeros(n, dtype=float)\n        for i in range(n - 1, -1, -1):\n            # Sum of U[i, j] * x_hat[j] for j from i+1 to n-1\n            s = np.dot(U[i, i + 1:], x_hat[i + 1:])\n            x_hat[i] = (y_perturbed[i] - s) / U[i, i]\n            \n        # Step 5: Calculate R(alpha) and append to results\n        x_n_hat = x_hat[n-1]\n        # The true value x_n_star is 1.0\n        R_alpha = alpha * (abs(x_n_hat - 1.0) / u)\n        results.append(R_alpha)\n\n    # Print the final list of results as a single formatted string\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve_and_report()\n```", "id": "2409891"}]}