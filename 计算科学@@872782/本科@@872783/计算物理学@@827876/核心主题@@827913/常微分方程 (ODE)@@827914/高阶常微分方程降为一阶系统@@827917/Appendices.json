{"hands_on_practices": [{"introduction": "将高阶常微分方程（ODE）转化为一阶系统是数值求解的第一步。本练习将通过一个来自结构力学的经典例子——欧拉-伯努利梁方程，来帮助你掌握这种变换的纯粹数学过程。你的任务是定义一个合适的状态向量，并将一个四阶空间微分方程重写为一个一阶向量微分方程，从而为数值积分做好准备 [@problem_id:2433647]。", "problem": "一根长度为 $L$ 的细长直欧拉-伯努利梁，其杨氏模量 $E$ 和截面二次矩 $I$ 均为常数。梁在 $x=0$ 处被固支（横向位移和转角均为零），在 $x=L$ 处为自由端。忽略惯性、剪切变形和转动惯量，因此在每个固定的时间 $t$，横向挠度 $w(x,t)$ 满足以下四阶空间常微分方程（ODE）：\n$$\nE I \\,\\frac{d^{4} w}{d x^{4}}(x,t) \\;=\\; q(x,t),\n$$\n其中 $q(x,t)$ 是单位长度上施加的横向载荷。一个随时间变化的集中力 $P(t)$ 施加在自由端 $x=L$ 处，其模型为狄拉克δ分布 $q(x,t) = P(t)\\,\\delta(x-L)$。\n\n将 $t$ 视为参数，通过引入一个最小状态向量 $y(x,t) \\in \\mathbb{R}^{4}$，将上述关于 $x$ 的四阶常微分方程降阶为一个关于 $x$ 的一阶系统，并将该系统写成显式状态空间形式：\n$$\n\\frac{d y}{d x}(x,t) \\;=\\; f\\!\\big(x,t,y(x,t)\\big),\n$$\n其中 $f$ 仅用 $x$、$t$、$y$、$E$、$I$、$P(t)$ 和 $\\delta(x-L)$ 表示。将您的最终答案表示为 $f(x,t,y)$ 的单个向量值解析表达式。\n\n你的最终答案必须是单个闭式解析表达式。不包含单位。不要近似或取整。", "solution": "该问题要求将一个关于空间变量 $x$ 的四阶常微分方程（ODE）降阶为一个一阶常微分方程组。时间变量 $t$ 被视为参数。欧拉-伯努利梁的横向挠度 $w(x,t)$ 的控制方程如下：\n$$ E I \\,\\frac{d^{4} w}{d x^{4}}(x,t) \\;=\\; q(x,t) $$\n施加的载荷 $q(x,t)$ 是在自由端 $x=L$ 处的一个随时间变化的集中力 $P(t)$，使用狄拉克δ分布进行建模：\n$$ q(x,t) = P(t)\\,\\delta(x-L) $$\n将载荷表达式代入控制方程，得到：\n$$ E I \\,\\frac{d^{4} w}{d x^{4}}(x,t) = P(t)\\,\\delta(x-L) $$\n为了便于降阶，我们首先分离出最高阶导数：\n$$ \\frac{d^{4} w}{d x^{4}}(x,t) = \\frac{P(t)}{E I} \\delta(x-L) $$\n任务是将这个单一的四阶常微分方程转换为一个包含四个一阶常微分方程的系统。我们引入一个状态向量 $y(x,t) \\in \\mathbb{R}^{4}$。对于 $y(x,t)$ 的分量，一个标准且具有物理意义的选择是包含挠度 $w$ 及其前三阶空间导数。设状态向量的分量为 $y_1(x,t)$、$y_2(x,t)$、$y_3(x,t)$ 和 $y_4(x,t)$，定义如下：\n$$ y_1(x,t) = w(x,t) $$\n$$ y_2(x,t) = \\frac{dw}{dx}(x,t) $$\n$$ y_3(x,t) = \\frac{d^2w}{dx^2}(x,t) $$\n$$ y_4(x,t) = \\frac{d^3w}{dx^3}(x,t) $$\n这个定义将状态变量与物理量联系起来：$y_1$ 是挠度，$y_2$ 是斜率（转角），$y_3$ 与弯矩成正比（$M(x,t) = E I y_3(x,t)$），$y_4$ 与剪力成正比（$V(x,t) = E I y_4(x,t)$）。\n\n目标是在状态空间表示 $\\frac{dy}{dx} = f(x,t,y)$ 中找到函数 $f(x,t,y)$。这需要将每个状态变量的导数 $\\frac{dy_i}{dx}$ 用 $x$、$t$ 和状态变量 $y_j$ 来表示。\n\n我们对状态向量 $y$ 的每个分量关于 $x$ 求导：\n\n1.  对于第一个分量 $y_1$：\n    $$ \\frac{dy_1}{dx} = \\frac{d}{dx} \\big( w(x,t) \\big) = \\frac{dw}{dx}(x,t) $$\n    根据我们对 $y_2$ 的定义，这正是 $y_2(x,t)$。因此，\n    $$ \\frac{dy_1}{dx} = y_2 $$\n\n2.  对于第二个分量 $y_2$：\n    $$ \\frac{dy_2}{dx} = \\frac{d}{dx} \\big( y_2(x,t) \\big) = \\frac{d}{dx} \\left( \\frac{dw}{dx}(x,t) \\right) = \\frac{d^2w}{dx^2}(x,t) $$\n    根据定义，这正是 $y_3(x,t)$。因此，\n    $$ \\frac{dy_2}{dx} = y_3 $$\n\n3.  对于第三个分量 $y_3$：\n    $$ \\frac{dy_3}{dx} = \\frac{d}{dx} \\big( y_3(x,t) \\big) = \\frac{d}{dx} \\left( \\frac{d^2w}{dx^2}(x,t) \\right) = \\frac{d^3w}{dx^3}(x,t) $$\n    根据定义，这正是 $y_4(x,t)$。因此，\n    $$ \\frac{dy_3}{dx} = y_4 $$\n\n4.  对于第四个分量 $y_4$：\n    $$ \\frac{dy_4}{dx} = \\frac{d}{dx} \\big( y_4(x,t) \\big) = \\frac{d}{dx} \\left( \\frac{d^3w}{dx^3}(x,t) \\right) = \\frac{d^4w}{dx^4}(x,t) $$\n    四阶导数的表达式由原始控制方程给出。代入该表达式，我们得到：\n    $$ \\frac{dy_4}{dx} = \\frac{P(t)}{E I} \\delta(x-L) $$\n\n这四个方程构成了一阶系统。我们可以将它们写成向量形式：\n$$ \\frac{d}{dx} y(x,t) = \\frac{d}{dx} \\begin{pmatrix} y_1(x,t) \\\\ y_2(x,t) \\\\ y_3(x,t) \\\\ y_4(x,t) \\end{pmatrix} = \\begin{pmatrix} y_2(x,t) \\\\ y_3(x,t) \\\\ y_4(x,t) \\\\ \\frac{P(t)}{E I} \\delta(x-L) \\end{pmatrix} $$\n该系统的形式为 $\\frac{dy}{dx} = f(x,t,y)$。通过将推导出的系统与此形式进行比较，我们可以确定向量值函数 $f(x,t,y)$ 就是等号右侧的项。函数 $f$ 依赖于 $y$ 的分量，并且由于项 $\\frac{P(t)}{E I}\\delta(x-L)$ 的存在，它也是 $x$ 和 $t$ 的显式函数。\n\n因此，$f(x,t,y)$ 的显式表达式为：\n$$ f(x,t,y) = \\begin{pmatrix} y_2 \\\\ y_3 \\\\ y_4 \\\\ \\frac{P(t)}{E I} \\delta(x-L) \\end{pmatrix} $$\n此表达式满足题目说明的所有要求。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\ny_2 \\\\\ny_3 \\\\\ny_4 \\\\\n\\frac{P(t)}{E I} \\delta(x-L)\n\\end{pmatrix}\n}\n$$", "id": "2433647"}, {"introduction": "成功地将一个高阶ODE降阶只是解决方案的一部分，特别是在处理具有奇异点的方程时。本练习以原子物理学中的托马斯-费米方程为例，该方程在原点处存在奇异性。你不仅需要将其简化为一阶系统，还需要通过分析解在原点附近的局部行为来确定一个关键系数，这是启动数值求解器（如打靶法）所必需的分析步骤 [@problem_id:2433655]。", "problem": "考虑原子中径向屏蔽函数的 Thomas–Fermi 常微分方程 (ODE)，\n$$\ny''(x) \\;=\\; x^{-1/2}\\,y(x)^{3/2}\\,, \\quad x>0,\n$$\n其服从以下两点边值条件\n$$\ny(0)\\,=\\,1,\\qquad y(x)\\,\\to\\,0\\ \\text{as}\\ x\\to\\infty,\n$$\n并假设物理相关的解满足 $y(x)>0$ 且在 $x>0$ 上单调递减。\n\n(a) 通过引入适当的因变量，将此二阶 ODE 降阶为一阶系统。\n\n(b) 为在小的 $x>0$ 处初始化数值方法，在 $x=0$ 处施加正则性条件（$y$ 和 $y'$ 的有限性），并确定局部展开式中的首项系数 $a$：\n$$\ny(x)\\;=\\;1\\;+\\;a\\,x^{3/2}\\;+\\;o\\!\\left(x^{3/2}\\right)\\quad\\text{as}\\quad x\\to 0^{+}.\n$$\n请给出 $a$ 的精确数值。不需要单位。你的最终答案必须是一个实数。", "solution": "首先应对问题进行严格验证。\n\n步骤 1：提取已知条件。\n问题提供了以下信息：\n- 该常微分方程 (ODE) 是 Thomas–Fermi 方程：\n$$\ny''(x) \\;=\\; x^{-1/2}\\,y(x)^{3/2}\\,,\\quad x > 0\n$$\n- 边值条件是：\n$$\ny(0)\\,=\\,1,\\qquad y(x)\\,\\to\\,0\\ \\text{as}\\ x\\to\\infty\n$$\n- 假设解具有以下性质：$y(x)>0$ 且在 $x>0$ 上单调递减。\n- (a) 部分要求将二阶 ODE 降阶为一阶系统。\n- (b) 部分假设在 $x=0$ 附近有局部展开式：\n$$\ny(x)\\;=\\;1\\;+\\;a\\,x^{3/2}\\;+\\;o\\!\\left(x^{3/2}\\right)\\quad\\text{as}\\quad x\\to 0^{+}\n$$\n并要求确定系数 $a$。\n\n步骤 2：使用提取的已知条件进行验证。\n- **科学依据**：Thomas–Fermi 方程是量子力学中原子半经典模型的基石。所给出的方程及其边值条件是标准的，并且在事实上是正确的。该问题具有科学合理性。\n- **适定性**：该问题是一个适定的边值问题。(a) 部分是常微分方程理论中的标准技术。(b) 部分探讨了解在方程奇点附近的局部行为，这是数学物理中的标准分析。物理相关解的存在性和唯一性是公认的。该问题是适定的。\n- **客观性**：问题以精确的数学语言表述，没有任何主观或模棱两可的陈述。\n- **完备性与一致性**：提供了所有必要信息（ODE、边值条件和级数形式）。内部没有矛盾。\n- **与主题的相关性**：该问题直接涉及将高阶 ODE 降阶为一阶系统以及为数值初始化分析局部行为，这些都是计算物理学中的基本概念。\n\n步骤 3：结论与行动。\n该问题有效。将提供完整解答。\n\n**(a) 部分：降阶为一阶系统**\n\n一个二阶常微分方程可以转换为一个包含两个一阶方程的系统。我们引入一个具有两个分量的状态向量 $\\mathbf{u}(x)$。定义其分量如下：\n$$\nu_1(x) = y(x)\n$$\n$$\nu_2(x) = y'(x)\n$$\n目标是找到这些新变量的导数 $u_1'(x)$ 和 $u_2'(x)$ 关于 $x$、$u_1(x)$ 和 $u_2(x)$ 的表达式。\n\n根据定义，第一个分量的导数是：\n$$\nu_1'(x) = \\frac{d}{dx}y(x) = y'(x) = u_2(x)\n$$\n第二个分量的导数由原始的 Thomas–Fermi 方程得到：\n$$\nu_2'(x) = \\frac{d}{dx}y'(x) = y''(x)\n$$\n代入给定 ODE 中 $y''(x)$ 的表达式：\n$$\ny''(x) = x^{-1/2} y(x)^{3/2}\n$$\n我们将 $y(x)$ 替换为 $u_1(x)$ 得到：\n$$\nu_2'(x) = x^{-1/2} u_1(x)^{3/2}\n$$\n因此，该二阶 ODE 等价于以下由两个耦合的一阶 ODE 组成的系统：\n$$\n\\begin{cases}\n    u_1'(x) = u_2(x) \\\\\n    u_2'(x) = x^{-1/2} u_1(x)^{3/2}\n\\end{cases}\n$$\n在向量表示法中，如果我们定义 $\\mathbf{u}(x) = \\begin{pmatrix} u_1(x) \\\\ u_2(x) \\end{pmatrix}$，该系统可写作 $\\mathbf{u}'(x) = \\mathbf{f}(x, \\mathbf{u}(x))$，其中：\n$$\n\\mathbf{f}(x, \\mathbf{u}) = \\begin{pmatrix} u_2 \\\\ x^{-1/2} u_1^{3/2} \\end{pmatrix}\n$$\n\n**(b) 部分：确定系数 $a$**\n\n我们被要求求出解 $y(x)$ 在 $x=0$ 附近的展开式中的系数 $a$：\n$$\ny(x) = 1 + a x^{3/2} + o(x^{3/2})\n$$\n这个展开式必须在极限 $x \\to 0^{+}$ 下满足 Thomas–Fermi 方程 $y''(x) = x^{-1/2} y(x)^{3/2}$。\n\n首先，我们计算给定 $y(x)$ 展开式的一阶和二阶导数。\n一阶导数是：\n$$\ny'(x) = \\frac{d}{dx} \\left( 1 + a x^{3/2} + o(x^{3/2}) \\right) = a \\frac{3}{2} x^{1/2} + o(x^{1/2})\n$$\n二阶导数是：\n$$\ny''(x) = \\frac{d}{dx} \\left( a \\frac{3}{2} x^{1/2} + o(x^{1/2}) \\right) = a \\frac{3}{2} \\cdot \\frac{1}{2} x^{-1/2} + o(x^{-1/2}) = \\frac{3a}{4} x^{-1/2} + o(x^{-1/2})\n$$\n因此，当 $x \\to 0^{+}$ 时，ODE 左侧 (LHS) 的首项是 $\\frac{3a}{4} x^{-1/2}$。\n\n接下来，我们分析 ODE 的右侧 (RHS)，即 $x^{-1/2} y(x)^{3/2}$。\n我们代入 $y(x)$ 的展开式：\n$$\n\\text{RHS} = x^{-1/2} \\left( 1 + a x^{3/2} + o(x^{3/2}) \\right)^{3/2}\n$$\n对于小的 $z$ 值，二项式展开给出 $(1+z)^\\alpha \\approx 1 + \\alpha z$。在我们的例子中，$z = a x^{3/2} + o(x^{3/2})$ 且 $\\alpha = 3/2$。当 $x \\to 0^{+}$ 时，$z \\to 0$。因此，我们可以展开括号中的项：\n$$\n\\left( 1 + a x^{3/2} + o(x^{3/2}) \\right)^{3/2} = 1 + \\frac{3}{2} \\left( a x^{3/2} + o(x^{3/2}) \\right) + \\dots = 1 + \\frac{3a}{2} x^{3/2} + o(x^{3/2})\n$$\n然而，这个细节对于找到首项并非必要。由于边值条件 $y(0)=1$，当 $x \\to 0^{+}$ 时，$y(x)$ 的主要行为就是 $y(x) \\to 1$。\n所以，RHS 的主要行为是：\n$$\n\\text{RHS} = x^{-1/2} y(x)^{3/2} \\approx x^{-1/2} \\cdot (1)^{3/2} = x^{-1/2}\n$$\n一个更严谨的展开视角证实了这一点：\n$$\nx^{-1/2} \\left( 1 + \\frac{3a}{2} x^{3/2} + o(x^{3/2}) \\right) = x^{-1/2} + \\frac{3a}{2} x + o(x)\n$$\n当 $x \\to 0^{+}$ 时，RHS 的首项是 $x^{-1/2}$。\n\n为了满足 ODE，LHS 和 RHS 的首项必须相等。我们令 $x^{-1/2}$ 项的系数相等：\n$$\n\\frac{3a}{4} = 1\n$$\n求解系数 $a$：\n$$\na = \\frac{4}{3}\n$$\n这个值确保了级数展开式在原点附近与微分方程一致。这种形式的解也满足边值条件 $y(0)=1$ 和正则性条件 $y'(0)=0$。", "answer": "$$\\boxed{\\frac{4}{3}}$$", "id": "2433655"}, {"introduction": "现在，我们将所有技能融会贯通，从头到尾解决一个完整的计算物理问题。本练习探讨了亚伯拉罕-洛伦兹力模型，该模型描述了电子的辐射反作用力，并产生了一个三阶ODE。这个问题不仅要求你进行降阶，还要求你处理一个微妙的物理约束——消除非物理性的“失控解”，并为此设计和实施一个巧妙的数值策略来求解这个本质上的边值问题 [@problem_id:2433622]。", "problem": "考虑一个非相对论性的点电子，在没有磁场的情况下，沿着一维空间在给定的外部电场 $E(t)$ 中运动。该电子的电荷为 $q=-e$，质量为 $m=m_e$。Abraham–Lorentz 辐射反作用模型指出，净力等于外力与一个与加速度时间导数成正比的辐射反作用项之和。从牛顿第二定律和辐射反作用模型出发，位置 $x(t)$ 的控制方程是一个关于时间的三阶常微分方程，涉及 $x(t)$、$\\dot{x}(t)$、$\\ddot{x}(t)$ 和 $\\dddot{x}(t)$。您的任务是：\n\n- 通过引入适当的状态变量，推导一个与该三阶方程等效的一阶常微分方程组。清晰地标识出状态变量、它们的物理意义，以及它们的一阶时间导数如何用彼此和外部电场表示。\n- 解释并采用一个有物理动机的边界条件，以消除发散（指数增长）解，并说明它如何改变问题的适定性。\n- 基于此一阶系统，实现一个稳健的数值策略，以计算几种给定外部电场下的最终位置 $x(T)$。您的实现必须是一个完整的、可运行的程序，无需用户输入，能够对所需系统进行数值积分，并按下文描述的精确格式打印所要求的结果。\n\n使用的基本定律和常数：\n- 牛顿第二定律：$m\\,\\ddot{x}(t)=F_{\\text{net}}(t)$。\n- 外部电力：$F_{\\text{ext}}(t)=q\\,E(t)$。\n- Abraham–Lorentz 辐射反作用模型：$F_{\\text{rr}}(t)=m\\,\\tau\\,\\dot{a}(t)$，其中 $a(t)=\\ddot{x}(t)$，$\\tau$ 是一个常数，由下式给出\n$$\n\\tau=\\frac{2\\,e^2}{3\\,4\\pi\\,\\varepsilon_0\\,m\\,c^3}.\n$$\n- 在您的代码中要以数值方式使用的国际单位制（SI）物理常数：\n    - 基本电荷 $e=1.602176634\\times 10^{-19}$ 库仑。\n    - 电子质量 $m_e=9.1093837015\\times 10^{-31}$ 千克。\n    - 真空介电常数 $\\varepsilon_0=8.8541878128\\times 10^{-12}$ 法拉每米。\n    - 光速 $c=299792458$ 米每秒。\n\n初始和边界条件：\n- 使用 $x(0)=0$ 米和 $\\dot{x}(0)=0$ 米每秒。\n- 施加物理上可接受的非发散条件，即当 $t\\to +\\infty$ 时，$a(t)\\to 0$。对于实际计算，在一个足够大的有限时间 $T$（此时 $E(t)$ 可忽略不计）处强制 $a(T)=0$。\n\n数值策略要求：\n- 为了获得一个尊重非发散条件的稳定且准确的计算结果，请将三阶方程简化为关于变量 $x(t)$、$v(t)=\\dot{x}(t)$ 和 $a(t)=\\ddot{x}(t)$ 的一阶系统。然后，利用 $a(t)$ 的方程是线性的且对时间是一阶的这一事实，在给定 $E(t)$ 和 $a(T)=0$ 的条件下，计算在 $[0,T]$ 上的 $a(t)$。接下来，利用 $v(t)$ 和 $x(t)$ 由 $a(t)$ 定义的关系，计算它们在 $[0,T]$ 上的值。您可以使用任何与上述物理要求一致的、科学上合理的离散化和常微分方程积分方法。\n- 不使用角度；无需指定角度单位。\n- 所有报告的位置必须以米为单位表示。\n\n测试套件：\n您的程序必须为以下三种外部电场中的每一种计算 $x(T)$。在每种情况下，根据上述常数定义特征 Abraham–Lorentz 时间 $\\tau$，并用它来构建电场和最终时间 $T$。令 $U=\\frac{T}{\\tau}$ 表示无量纲的最终时间。\n\n1. 高斯脉冲（理想平滑脉冲）：\n   - 电场：$E(t)=E_0\\exp\\!\\left(-\\dfrac{(t-t_c)^2}{2\\,\\sigma^2}\\right)$。\n   - 参数：$E_0=1.0\\times 10^6$ 伏特每米，$t_c=10\\,\\tau$，$\\sigma=3\\,\\tau$，$U=40$，所以 $T=U\\,\\tau$。\n\n2. 阻尼正弦波（带衰减的振荡驱动）：\n   - 电场：$E(t)=E_0\\,\\sin(\\omega t)\\,\\exp\\!\\left(-\\dfrac{t}{T_{\\text{env}}}\\right)$。\n   - 参数：$E_0=1.0\\times 10^6$ 伏特每米，$\\omega=\\dfrac{0.2}{\\tau}$ 弧度每秒，$T_{\\text{env}}=15\\,\\tau$，$U=60$，所以 $T=U\\,\\tau$。\n\n3. 零场（边界情况）：\n   - 电场：对于所有 $t$，$E(t)=0$。\n   - 参数：$U=10$，所以 $T=U\\,\\tau$。\n\n最终输出格式：\n- 您的程序应产生单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，即 $[x_1,x_2,x_3]$，其中 $x_k$ 是测试用例 $k$ 的最终位置 $x(T)$（以米为单位），表示为使用标准字符串格式的浮点十进制数（打印输出中不含单位）。", "solution": "问题陈述已经过分析并被认为是有效的。这是一个计算物理学中的适定问题，基于经典电动力学中已确立但简化的原理。其表述是自洽的、客观的，并为在规定的物理边界条件下获得唯一解提供了所有必要信息。我现在将继续进行推导和数值解的构建。\n\n非相对论性电子的运动由牛顿第二定律控制，其中净力是外部电场力与 Abraham-Lorentz 辐射反作用力之和。方程为：\n$$\nm\\,\\ddot{x}(t) = F_{\\text{net}}(t) = F_{\\text{ext}}(t) + F_{\\text{rr}}(t)\n$$\n这里，$m$ 是电子质量，$x(t)$ 是其位置，$F_{\\text{ext}}(t) = q\\,E(t)$ 是来自电场 $E(t)$ 的外力，电荷为 $q=-e$，而 $F_{\\text{rr}}(t) = m\\,\\tau\\,\\dot{a}(t)$ 是辐射反作用力。量 $a(t) = \\ddot{x}(t)$ 是加速度，$\\tau = \\frac{2\\,e^2}{3\\,4\\pi\\,\\varepsilon_0\\,m\\,c^3}$ 是辐射反作用的特征时间常数。代入这些表达式得到控制方程：\n$$\nm\\,\\ddot{x}(t) = q\\,E(t) + m\\,\\tau\\,\\dddot{x}(t)\n$$\n这是一个关于位置 $x(t)$ 的三阶线性常微分方程。通常将其写成最高阶导数在等式一边的形式：\n$$\n\\dddot{x}(t) - \\frac{1}{\\tau}\\ddot{x}(t) = \\frac{q}{m\\,\\tau}E(t)\n$$\n\n为了数值求解此方程，我们将其简化为一个一阶微分方程组。我们引入一个状态向量 $\\mathbf{y}(t)$，其分量是具有物理意义的位置、速度和加速度。设状态变量为：\n- $y_1(t) = x(t)$: 位置\n- $y_2(t) = v(t) = \\dot{x}(t)$: 速度\n- $y_3(t) = a(t) = \\ddot{x}(t)$: 加速度\n\n然后，这些状态变量的一阶时间导数用状态变量本身和外部强迫函数 $E(t)$ 来表示。前两个是定义：\n$$\n\\dot{y}_1(t) = \\dot{x}(t) = v(t) = y_2(t)\n$$\n$$\n\\dot{y}_2(t) = \\dot{v}(t) = a(t) = y_3(t)\n$$\n第三个方程是通过将状态变量代入控制三阶常微分方程得到的：\n$$\n\\dot{y}_3(t) = \\dot{a}(t) = \\dddot{x}(t) = \\frac{1}{\\tau}\\ddot{x}(t) + \\frac{q}{m\\,\\tau}E(t) = \\frac{1}{\\tau}y_3(t) + \\frac{q}{m\\,\\tau}E(t)\n$$\n因此，等效的一阶系统是：\n$$\n\\frac{d}{dt}\n\\begin{pmatrix}\ny_1 \\\\\ny_2 \\\\\ny_3\n\\end{pmatrix}\n=\n\\begin{pmatrix}\ny_2 \\\\\ny_3 \\\\\n\\frac{1}{\\tau}y_3 + \\frac{q}{m\\,\\tau}E(t)\n\\end{pmatrix}\n$$\n\n加速度的方程 $\\dot{a}(t) - \\frac{1}{\\tau}a(t) = \\frac{q}{m\\,\\tau}E(t)$，其齐次部分 $\\dot{a}_h(t) - \\frac{1}{\\tau}a_h(t) = 0$ 的解是 $a_h(t) = C\\,e^{t/\\tau}$，其中 $C$ 是某个常数。这个解随时间指数增长，被称为“发散”解。这种行为是不符合物理现实的；在没有持续增长的外力的情况下，电子的加速度不应无限增长。问题陈述正确地要求采用一个物理条件来消除这种非物理行为，即当 $t \\to \\infty$ 时 $a(t) \\to 0$。这个条件迫使常数 $C$ 为零，从而从无限多个数学解中选出唯一符合物理的解。对于在有限区间 $[0, T]$ 上的数值计算，其中 $T$ 的选择使得当 $t \\ge T$ 时 $E(t)$ 可忽略不计，此条件被施加为 $a(T)=0$。\n\n两个初始条件 $x(0)=0$ 和 $\\dot{x}(0)=0$ 与最终边界条件 $a(T)=0$ 的组合，使得该问题成为一个边值问题，而非简单的初值问题。数值策略必须尊重这种结构。问题是解耦的。$a(t)$ 的方程可以首先独立于 $x(t)$ 和 $v(t)$ 求解，因为它不依赖于它们。我们必须求解带有终值条件的 $a(t)$ 的线性一阶方程。对此的标准技术是时间反演。令 $s = T-t$，这意味着 $t=T-s$ 且 $\\frac{d}{dt} = -\\frac{d}{ds}$。$a(t(s))$ 的常微分方程变为：\n$$\n-\\frac{da}{ds} = \\frac{1}{\\tau}a(s) + \\frac{q}{m\\,\\tau}E(T-s)\n$$\n整理后得到一个关于 $a(s)$ 的标准初值问题：\n$$\n\\frac{da}{ds} = -\\frac{1}{\\tau}a(s) - \\frac{q}{m\\,\\tau}E(T-s)\n$$\n边界条件 $a(t=T)=0$ 变成一个初始条件 $a(s=0)=0$。这个方程可以使用标准的数值求解器（如 Runge-Kutta 方法）从 $s=0$ 到 $s=T$ 进行稳健的正向积分。结果是在区间 $[0, T]$ 上的函数 $a(s)$。将得到的值数组反转，就得到了在区间 $[0, T]$ 上的解 $a(t)$。\n\n一旦在离散时间网格上数值确定了加速度 $a(t)$，就可以通过逐次积分并使用初始条件 $v(0)=0$ 和 $x(0)=0$ 来获得速度 $v(t)$ 和位置 $x(t)$：\n$$\nv(t) = v(0) + \\int_0^t a(t') dt' = \\int_0^t a(t') dt'\n$$\n$$\nx(t) = x(0) + \\int_0^t v(t') dt' = \\int_0^t v(t') dt'\n$$\n这些积分是数值执行的。例如，累积梯形法是合适的。最终位置 $x(T)$ 是在对 $x(t)$ 进行数值积分时获得的最后一个值。这样就完成了数值解的设计。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp, cumulative_trapezoid\n\ndef solve():\n    \"\"\"\n    Solves the Abraham-Lorentz equation of motion for an electron for three test cases\n    and prints the final positions.\n    \"\"\"\n    # Physical constants in SI units\n    E_CHARGE = 1.602176634e-19  # Elementary charge in Coulombs\n    M_ELECTRON = 9.1093837015e-31 # Electron mass in Kilograms\n    EPSILON_0 = 8.8541878128e-12  # Vacuum permittivity in Farads/meter\n    C_LIGHT = 299792458.0         # Speed of light in meters/second\n\n    # Derived constants\n    Q = -E_CHARGE\n    M = M_ELECTRON\n    # Abraham-Lorentz characteristic time\n    TAU = (2 * E_CHARGE**2) / (3 * 4 * np.pi * EPSILON_0 * M * C_LIGHT**3)\n    # Pre-calculated coefficient for the ODE\n    Q_OVER_M_TAU = Q / (M * TAU)\n\n    def compute_final_position(E_func, T, num_points):\n        \"\"\"\n        Computes the final position x(T) for a given electric field and duration.\n\n        Args:\n            E_func (callable): A function E(t) for the external electric field.\n            T (float): The final time for the simulation.\n            num_points (int): The number of points for the time grid.\n\n        Returns:\n            float: The final position x(T) in meters.\n        \"\"\"\n        # Set up a uniform time grid for the simulation.\n        t_grid = np.linspace(0.0, T, num_points)\n\n        # Define the ODE for a(s) where s = T - t.\n        # This transforms the final value problem into an initial value problem.\n        # da/ds = -a/tau - (q/(m*tau)) * E(T-s)\n        def a_ode(s, a_vec):\n            a = a_vec[0]\n            return [-a / TAU - Q_OVER_M_TAU * E_func(T - s)]\n\n        # The time-reversed variable s runs from 0 to T. We ask the solver\n        # to evaluate the solution on a grid for s that corresponds to our t_grid.\n        s_eval = np.linspace(0.0, T, num_points)\n\n        # Solve the IVP for a(s) from s=0 to s=T with initial condition a(s=0)=0.\n        # We use RK45, a standard adaptive Runge-Kutta method.\n        sol = solve_ivp(a_ode, [0.0, T], [0.0], method='RK45', t_eval=s_eval)\n        \n        a_s = sol.y[0]\n        \n        # The solution a(t) is a(s) reversed in time.\n        a_t = a_s[::-1]\n        \n        # Integrate a(t) to get v(t) with v(0)=0.\n        # cumulative_trapezoid produces an array one element shorter than the input.\n        # By setting initial=0, it prepends a 0 and returns an array of the same size.\n        v_t = cumulative_trapezoid(a_t, t_grid, initial=0.0)\n        \n        # Integrate v(t) to get x(t) with x(0)=0.\n        x_t = cumulative_trapezoid(v_t, t_grid, initial=0.0)\n        \n        # The final position is the last element of the integrated array.\n        return x_t[-1]\n\n    # Test Case 1: Gaussian pulse\n    E0_1 = 1.0e6\n    tc_1 = 10.0 * TAU\n    sigma_1 = 3.0 * TAU\n    U_1 = 40.0\n    T_1 = U_1 * TAU\n    def E1(t):\n        return E0_1 * np.exp(-((t - tc_1)**2) / (2.0 * sigma_1**2))\n    \n    # Test Case 2: Damped sinusoid\n    E0_2 = 1.0e6\n    omega_2 = 0.2 / TAU\n    T_env_2 = 15.0 * TAU\n    U_2 = 60.0\n    T_2 = U_2 * TAU\n    def E2(t):\n        # Piecewise definition to handle large arguments in exp for t0 from E(T-s)\n        if t  0:\n            return 0.0\n        return E0_2 * np.sin(omega_2 * t) * np.exp(-t / T_env_2)\n\n    # Test Case 3: Zero field\n    U_3 = 10.0\n    T_3 = U_3 * TAU\n    def E3(t):\n        return 0.0\n\n    # Number of points for each simulation.\n    # A higher density of points is used to ensure accuracy,\n    # chosen proportional to the dimensionless simulation time U.\n    points_per_tau = 2000\n    num_points_1 = int(U_1 * points_per_tau) + 1\n    num_points_2 = int(U_2 * points_per_tau) + 1\n    num_points_3 = int(U_3 * points_per_tau) + 1\n        \n    test_cases = [\n        (E1, T_1, num_points_1),\n        (E2, T_2, num_points_2),\n        (E3, T_3, num_points_3),\n    ]\n\n    results = []\n    for case in test_cases:\n        E_func, T, n_pts = case\n        x_final = compute_final_position(E_func, T, n_pts)\n        results.append(x_final)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2433622"}]}