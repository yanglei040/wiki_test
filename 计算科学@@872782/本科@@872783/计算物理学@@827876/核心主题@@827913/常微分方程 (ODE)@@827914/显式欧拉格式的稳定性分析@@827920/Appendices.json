{"hands_on_practices": [{"introduction": "理论是指导，但实践中的后果才最令人警醒。当我们不经意间越过稳定性的门槛时，会发生什么？这个练习将通过一个简单的化学反应模型，讲述一个鲜明而具有警示性的故事。它将向我们展示，步长的微小错误选择如何导致完全不符合物理现实的荒谬结果，从而突显出稳定性分析在科学计算中的重要性。[@problem_id:2205446]", "problem": "一位科学家正在对一个简单的一级反应中的化学反应物浓度 $C(t)$ 进行建模。该反应物浓度的变化率与浓度本身成正比，遵循以下微分方程：\n$$\n\\frac{dC}{dt} = -k C(t)\n$$\n速率常数给定为 $k = 50.0 \\text{ s}^{-1}$，时间 $t=0$ 时的初始浓度为 $C(0) = 100.0 \\text{ mol/L}$。\n\n为了预测未来时间的浓度，该科学家采用了一种使用固定时间步长 $h$ 的数值方法。该方法根据显式欧拉更新法则，使用前一个时间步 $t_n = nh$ 的值来近似时间 $t_{n+1} = (n+1)h$ 时的浓度：\n$$\nC_{n+1} = C_n + h \\left( \\frac{dC}{dt} \\right)_{t=t_n}\n$$\n该科学家决定使用 $h = 0.0410 \\text{ s}$ 的时间步长。计算此方法在三个时间步后预测的浓度 $C_3$ 的数值。用 mol/L 表示你的答案，并四舍五入到三位有效数字。", "solution": "我们给定了一阶线性常微分方程 $\\frac{dC}{dt}=-kC(t)$ 和显式欧拉更新\n$$\nC_{n+1}=C_{n}+h\\left(\\frac{dC}{dt}\\right)_{t=t_{n}}=C_{n}+h(-kC_{n})=(1-kh)C_{n}.\n$$\n通过递推，这得到\n$$\nC_{n}=C_{0}(1-kh)^{n}.\n$$\n当 $C_{0}=100.0$，$k=50.0\\,\\text{s}^{-1}$ 和 $h=0.0410\\,\\text{s}$ 时，无量纲乘积为\n$$\nkh=(50.0)(0.0410)=2.05,\\quad 1-kh=1-2.05=-1.05.\n$$\n因此，在三个步骤后，\n$$\nC_{3}=100.0\\,(-1.05)^{3}.\n$$\n计算幂次：\n$$\n(-1.05)^{2}=1.1025,\\quad (-1.05)^{3}=1.1025\\times(-1.05)=-1.157625,\n$$\n所以\n$$\nC_{3}=100.0\\times(-1.157625)=-115.7625.\n$$\n四舍五入到三位有效数字得到 $-1.16\\times 10^{2}$，即 $-116$。注意，显式欧拉因子满足 $|1-kh|=1.051$，表明对于这个步长是不稳定的，这解释了非物理的符号变化。", "answer": "$$\\boxed{-116}$$", "id": "2205446"}, {"introduction": "既然我们已经认识到不稳定的严重后果，那么在处理更复杂的系统时，稳定性又会如何限制我们的选择呢？这个练习将我们带入“刚性”（stiffness）问题的核心。在刚性系统中，不同组成部分的演化速度天差地别。通过比较求解一个刚性系统与一个非刚性系统所需的计算量，本练习将定量地揭示稳定性约束对显式方法带来的巨大计算成本。[@problem_id:2438035]", "problem": "一个显式单步法被用于在时间区间 $[0, T]$（其中 $T = 10$）上模拟形如 $\\dot{\\mathbf{y}} = A \\mathbf{y}$ 的线性时不变常微分方程（ODE）。该方法为具有恒定时间步长 $h$ 的显式欧拉格式，并且每一步都恰好需要一次对右端函数 $f(\\mathbf{y}) = A \\mathbf{y}$ 的求值。\n\n考虑两个系统：\n- 一个刚性系统 $\\dot{\\mathbf{y}} = A_{s}\\mathbf{y}$，其中 $A_{s} = \\mathrm{diag}(-1200, -3)$。\n- 一个非刚性系统 $\\dot{\\mathbf{y}} = A_{n}\\mathbf{y}$，其中 $A_{n} = \\mathrm{diag}(-1, -0.2)$。\n\n对于每个系统，您需要选择一个最大的恒定步长 $h$，以保证系统所有特征模态的线性绝对稳定性，即当显式欧拉方法应用于沿特征向量分解得到的每个标量特征模态时，在精确解衰减的情况下，数值解的幅值不会增长。\n\n请仅从以下几点出发：\n- 显式欧拉更新的定义，\n- 作为矩阵 $A$ 特征向量方向上的局部模型的线性测试方程 $\\dot{y} = \\lambda y$，\n- 以及对于衰减模态，每步的数值放大率在幅值上不超过1的要求，\n\n推导出每个系统的最大稳定步长，确定从 $t = 0$ 推进到 $t = T$ 所需的相应步数 $N$（每步计一次函数求值），然后计算比率 $R = N_{\\text{stiff}}/N_{\\text{nonstiff}}$。\n\n请以一个未经四舍五入的精确数值形式给出 $R$。", "solution": "首先验证问题。\n\n**步骤1：提取已知条件**\n- 常微分方程（ODE）的形式为 $\\dot{\\mathbf{y}} = A \\mathbf{y}$。\n- 时间区间为 $[0, T]$，其中 $T = 10$。\n- 数值方法为具有恒定时间步长 $h$ 的显式欧拉格式。\n- 每一步使用一次右端函数的求值。\n- 刚性系统由矩阵 $A_{s} = \\mathrm{diag}(-1200, -3)$ 描述。\n- 非刚性系统由矩阵 $A_{n} = \\mathrm{diag}(-1, -0.2)$ 描述。\n- 稳定性要求是对于衰减模态，数值解的幅值不增长。\n- 任务是为每个系统推导最大稳定步长 $h$，求出相应的步数（$N_{\\text{stiff}}$ 和 $N_{\\text{nonstiff}}$），并计算比率 $R = N_{\\text{stiff}}/N_{\\text{nonstiff}}$。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据：** 该问题是常微分方程数值分析中的一个标准练习，基于刚性、数值稳定性和显式欧拉法等基本概念。\n- **适定性：** 提供了所有必要信息。目标陈述清晰，且可以获得唯一解。\n- **客观性：** 问题陈述使用了精确、客观和标准的科学术语。\n\n**步骤3：结论与行动**\n该问题是科学有效的、适定的和客观的。将推导解答。\n\n根据要求，解答过程首先从基本原理出发，推导显式欧拉法的稳定性条件。\n\n显式欧拉法使用以下更新公式将常微分方程 $\\dot{\\mathbf{y}} = \\mathbf{f}(t, \\mathbf{y})$ 的解从时间 $t_k$ 推进到 $t_{k+1} = t_k + h$：\n$$ \\mathbf{y}_{k+1} = \\mathbf{y}_k + h \\mathbf{f}(t_k, \\mathbf{y}_k) $$\n对于给定的线性时不变系统 $\\dot{\\mathbf{y}} = A \\mathbf{y}$，更新规则变为：\n$$ \\mathbf{y}_{k+1} = \\mathbf{y}_k + h A \\mathbf{y}_k = (I + hA) \\mathbf{y}_k $$\n其中 $I$ 是单位矩阵。\n\n该方法的稳定性通过将其应用于标量测试方程 $\\dot{y} = \\lambda y$（其中 $\\lambda \\in \\mathbb{C}$）来分析。此方程可作为沿矩阵 $A$ 的每个特征向量方向上的行为模型。$A$ 的特征值 $\\lambda$ 决定了系统的动力学行为。对于本问题，矩阵 $A_s$ 和 $A_n$ 是对角矩阵，因此其对角线元素就是特征值。所有特征值均为实数且为负，这对应于精确解 $y(t) = y_0 \\exp(\\lambda t)$ 中的衰减模态。\n\n将显式欧拉法应用于该测试方程，得到：\n$$ y_{k+1} = y_k + h (\\lambda y_k) = (1 + h\\lambda) y_k $$\n项 $G(z) = 1 + z$（其中 $z = h\\lambda$）是放大因子或稳定性函数。为使数值解保持稳定（幅值不增长），该放大因子的幅值必须不大于1：\n$$ |G(h\\lambda)| \\leq 1 \\implies |1 + h\\lambda| \\leq 1 $$\n该不等式定义了显式欧拉法的绝对稳定域。\n\n对于所讨论的系统，特征值 $\\lambda$ 是实数且为负。设 $\\lambda  0$。稳定性条件为：\n$$ |1 + h\\lambda| \\leq 1 $$\n由于 $h  0$ 且 $\\lambda  0$，量 $h\\lambda$ 是一个负实数。该不等式可以写为：\n$$ -1 \\leq 1 + h\\lambda \\leq 1 $$\n各部分都减去 $1$ 可得：\n$$ -2 \\leq h\\lambda \\leq 0 $$\n右侧不等式 $h\\lambda \\leq 0$ 总是成立的，因为 $h0$ 且 $\\lambda0$。起控制作用的条件是左侧不等式：\n$$ -2 \\leq h\\lambda $$\n除以 $\\lambda$（$\\lambda$ 为负，因此不等号反向）：\n$$ h \\leq \\frac{-2}{\\lambda} $$\n由于 $\\lambda$ 是负数，$-\\lambda = |\\lambda|$。因此，对步长的条件是：\n$$ h \\leq \\frac{2}{|\\lambda|} $$\n对于一个方程组，此条件必须对矩阵 $A$ 的所有特征值 $\\lambda_i$ 都成立。为确保所有模态的稳定性，时间步长 $h$ 必须受限于具有最大幅值的特征值，该特征值对应于衰减最快（也是数值计算上最具挑战性）的分量：\n$$ h \\leq \\min_{i} \\left( \\frac{2}{|\\lambda_i|} \\right) = \\frac{2}{\\max_{i} |\\lambda_i|} $$\n因此，保证稳定性的最大恒定步长 $h_{\\text{max}}$ 为：\n$$ h_{\\text{max}} = \\frac{2}{\\max_{i} |\\lambda_i|} $$\n\n现在我们将此结果应用于两个指定的系统。\n\n**对于刚性系统：**\n矩阵为 $A_{s} = \\mathrm{diag}(-1200, -3)$。特征值为 $\\lambda_1 = -1200$ 和 $\\lambda_2 = -3$。\n特征值的最大幅值为：\n$$ \\max(|\\lambda_1|, |\\lambda_2|) = \\max(1200, 3) = 1200 $$\n刚性系统的最大稳定步长 $h_s$ 为：\n$$ h_s = \\frac{2}{1200} = \\frac{1}{600} $$\n\n**对于非刚性系统：**\n矩阵为 $A_{n} = \\mathrm{diag}(-1, -0.2)$。特征值为 $\\lambda_1 = -1$ 和 $\\lambda_2 = -0.2$。\n特征值的最大幅值为：\n$$ \\max(|\\lambda_1|, |\\lambda_2|) = \\max(1, 0.2) = 1 $$\n非刚性系统的最大稳定步长 $h_n$ 为：\n$$ h_n = \\frac{2}{1} = 2 $$\n\n接下来，我们确定在长度为 $T=10$ 的时间区间上进行模拟所需的步数 $N$。步数由 $N = T/h$ 给出。\n\n对于刚性系统，步数 $N_{\\text{stiff}}$ 为：\n$$ N_{\\text{stiff}} = \\frac{T}{h_s} = \\frac{10}{1/600} = 10 \\times 600 = 6000 $$\n\n对于非刚性系统，步数 $N_{\\text{nonstiff}}$ 为：\n$$ N_{\\text{nonstiff}} = \\frac{T}{h_n} = \\frac{10}{2} = 5 $$\n\n最后，我们计算比率 $R = N_{\\text{stiff}}/N_{\\text{nonstiff}}$。\n$$ R = \\frac{N_{\\text{stiff}}}{N_{\\text{nonstiff}}} = \\frac{6000}{5} = 1200 $$\n这个比率代表了在使用受稳定性限制的时间步长的显式方法时，由于刚性问题所产生的计算成本惩罚。步长必须被大幅减小以解析最快的时间尺度（来自 $\\lambda = -1200$），尽管该解分量几乎是瞬时衰减的，而对应于 $\\lambda = -3$ 的分量演化得慢得多。", "answer": "$$\n\\boxed{1200}\n$$", "id": "2438035"}, {"introduction": "线性系统是理想的，但真实世界大多是非线性的。我们如何分析非线性动力学的稳定性呢？本练习将通过著名的逻辑斯蒂（logistic）人口增长模型，介绍一种强大的技术——在平衡点（不动点）附近进行线性化分析。它揭示了一个深刻的观点：稳定性可能不是一个全局属性，而是依赖于系统在状态空间中所处的位置，这为我们处理更真实的模型提供了关键的洞察。[@problem_id:2441585]", "problem": "考虑逻辑斯谛常微分方程 (ODE) $ \\dot{y} = r\\,y\\left(1 - \\frac{y}{K}\\right) $，其中常数 $ r  0 $ 和 $ K  0 $。设 $ h  0 $ 为一个固定的时间步长，并应用显式欧拉法得到离散更新式 $ y_{n+1} = y_n + h\\,r\\,y_n\\left(1 - \\frac{y_n}{K}\\right) $。对于每个连续不动点 $ y^{*} \\in \\{0, K\\} $，确定使得显式欧拉离散化在 $ y^{*} $ 的一个邻域内是线性稳定的最大步长 $ h $。将您的最终答案以有序对 $ \\left(h_{0,\\max},\\,h_{K,\\max}\\right) $ 的形式，作为 $ r $ 的函数的闭式表达式给出。请给出精确表达式。", "solution": "逻辑斯谛常微分方程 $ \\dot{y} = r\\,y\\left(1 - \\frac{y}{K}\\right) $ 在 $ y = 0 $ 和 $ y = K $ 处有不动点，因为将任一值代入方程右侧均得到 $ 0 $。步长为 $ h  0 $ 的显式欧拉法产生离散映射\n$$\ny_{n+1} \\;=\\; y_n + h\\,f(y_n)\n\\quad\\text{其中}\\quad\nf(y) \\;=\\; r\\,y\\left(1 - \\frac{y}{K}\\right).\n$$\n为评估离散动力学系统在不动点 $ y^{*} $ 附近的线性稳定性，考虑一个由 $ y_n = y^{*} + \\varepsilon_n $ 定义的扰动 $ \\varepsilon_n $，其中 $ |\\varepsilon_n| $ 很小。对该映射进行一阶泰勒展开得到\n$$\ny_{n+1} \\;=\\; y^{*} + \\varepsilon_n + h\\,f(y^{*} + \\varepsilon_n)\n\\;\\approx\\;\ny^{*} + \\varepsilon_n + h\\left(f(y^{*}) + f'(y^{*})\\,\\varepsilon_n\\right).\n$$\n在不动点处有 $ f(y^{*}) = 0 $，因此扰动演化为\n$$\n\\varepsilon_{n+1} \\;\\approx\\; \\left(1 + h\\,f'(y^{*})\\right)\\varepsilon_n.\n$$\n因此，线性放大因子为 $ g(y^{*},h) = 1 + h\\,f'(y^{*}) $。离散动力学系统在 $ y^{*} $ 附近是线性稳定的，当且仅当 $|g(y^{*},h)|  1$。\n\n计算导数\n$$\nf'(y) \\;=\\; r\\left(1 - \\frac{2y}{K}\\right).\n$$\n在每个不动点处求值：\n- 在 $ y^{*} = 0 $ 处，$ f'(0) = r $。\n- 在 $ y^{*} = K $ 处，$ f'(K) = -r $。\n\n因此，放大因子为\n$$\ng(0,h) = 1 + h r,\n\\qquad\ng(K,h) = 1 - h r.\n$$\n在每种情况下施加线性稳定性条件 $|g(y^{*},h)|  1$：\n\n1. 在 $ y^{*} = 0 $ 附近：\n$$\n|1 + h r|  1.\n$$\n对于 $ r  0 $ 和 $ h  0 $，我们有 $ 1 + h r  1 $，所以该不等式不能被满足。因此，不存在任何正的步长可以产生线性稳定性。将最大允许值解释为满足严格不等式的 $ h \\ge 0 $ 的上确界，我们得到 $ h_{0,\\max} = 0 $。\n\n2. 在 $ y^{*} = K $ 附近：\n$$\n|1 - h r|  1\n\\;\\;\\Longleftrightarrow\\;\\;\n-1  1 - h r  1\n\\;\\;\\Longleftrightarrow\\;\\;\n0  h r  2.\n$$\n当 $ r  0 $ 时，这给出 $0  h  \\frac{2}{r}$。在同样的上确界意义下，最大稳定步长是 $ h_{K,\\max} = \\frac{2}{r} $。\n\n综合两个结果，最大线性稳定步长的有序对是\n$$\n\\left(h_{0,\\max},\\,h_{K,\\max}\\right) \\;=\\; \\left(0,\\,\\frac{2}{r}\\right).\n$$", "answer": "$$\\boxed{\\left(0, \\frac{2}{r}\\right)}$$", "id": "2441585"}]}