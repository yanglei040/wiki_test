{"hands_on_practices": [{"introduction": "我们从一个基础的物理情景开始，以建立关于边界条件如何决定系统行为的直观理解。这个练习探讨了一根一维杆中的稳态温度分布，其两端保持恒定温度 [@problem_id:946]。这是一个经典的教科书式问题，它清晰地展示了狄利克雷（Dirichlet）边界条件如何唯一地确定一个物理系统的最终平衡状态，并为我们后续更复杂的分析奠定了基础。", "problem": "考虑一根长度为 $L$ 的一维均匀杆。杆内的温度分布，记为 $u(x, t)$，其中 $x$ 是沿杆的位置（$0 \\le x \\le L$），$t$ 是时间，由一维热传导方程决定：\n$$\n\\frac{\\partial u}{\\partial t} = \\alpha \\frac{\\partial^2 u}{\\partial x^2}\n$$\n这里，$\\alpha$ 是材料的热扩散系数，一个正常数。\n\n我们关心的是稳态温度分布，即经过足够长的时间后，温度不再随时间变化的温度剖面 $u(x)$。这意味着 $\\frac{\\partial u}{\\partial t} = 0$。\n\n杆的两端保持在固定的恒定温度。这被称为狄利克雷边界条件：\n1. 在 $x=0$ 处，温度为 $u(0) = T_0$。\n2. 在 $x=L$ 处，温度为 $u(L) = T_1$。\n\n从热传导方程出发，推导沿杆的稳态温度分布 $u(x)$ 的表达式，该表达式是位置 $x$、长度 $L$ 以及边界温度 $T_0$ 和 $T_1$ 的函数。", "solution": "在稳态条件下，我们有 $\\frac{\\partial u}{\\partial t} = 0$，因此热传导方程简化为 $\\alpha \\frac{d^2u}{dx^2} = 0$。由于 $\\alpha \\neq 0$，这意味着 $\\frac{d^2u}{dx^2} = 0$。\n对该方程关于 $x$ 积分一次，得到 $\\frac{du}{dx} = A$，其中 $A$ 是一个常数。\n再次积分得到通解：$u(x) = Ax + B$，其中 $B$ 也是一个常数。\n我们应用狄利克雷边界条件来确定 $A$ 和 $B$：\n1.  在 $x=0$ 处，$u(0) = T_0$，所以 $A(0) + B = T_0 \\implies B = T_0$。\n2.  在 $x=L$ 处，$u(L) = T_1$，所以 $AL + B = T_1$。代入 $B = T_0$，我们有 $AL + T_0 = T_1$，这给出 $A = \\frac{T_1 - T_0}{L}$。\n将 $A$ 和 $B$ 的值代入通解，得到稳态温度分布：\n$$u(x) = T_0 + \\frac{(T_1 - T_0)x}{L}$$", "answer": "$$\\boxed{T_0 + \\frac{(T_1 - T_0)x}{L}}$$", "id": "946"}, {"introduction": "在掌握了基本应用之后，我们现在转向一个概念性的挑战，以深化我们的理解。这个练习不要求复杂的计算，而是考验我们的物理洞察力和数学推理能力 [@problem_id:2386501]。通过分析一个常见的编程错误——无意中交换了狄利克雷和诺伊曼（Neumann）边界条件——我们将揭示这两种条件在物理意义和数学后果上的深刻差异，例如它们如何影响守恒定律、瞬态行为和解的对称性。", "problem": "对于区间 $x \\in [0,L]$ 上的一个标量场 $u(x,t)$，其一维 (1D) 扩散过程由偏微分方程 (PDE) 描述，其中扩散系数 $D>0$ 为常数：\n$$\n\\frac{\\partial u}{\\partial t} = D\\,\\frac{\\partial^2 u}{\\partial x^2}, \\quad x \\in (0,L), \\; t>0,\n$$\n初始条件为 $u(x,0)=u_0(x)$。预期的边界条件是在左边界施加狄利克雷条件（固定值），在右边界施加诺伊曼条件（无通量）：\n$$\nu(0,t)=u_L \\;\\; \\text{for all } t\\ge 0, \\qquad \\frac{\\partial u}{\\partial x}(L,t)=0 \\;\\; \\text{for all } t\\ge 0,\n$$\n其中 $u_L$ 是一个常数。在一次实现中，这些边界条件被错误地交换，代之以施加：\n$$\n\\frac{\\partial u}{\\partial x}(0,t)=0 \\;\\; \\text{for all } t\\ge 0, \\qquad u(L,t)=u_L \\;\\; \\text{for all } t\\ge 0.\n$$\n假设 $u_0(x)$ 和 $u_L$ 是有界的实数值，并将 $u$ 解释为浓度，因此非负性在物理上很重要。\n\n关于此交换造成的后果，下列陈述中哪些是正确的？选择所有适用项。\n\nA. 如果 $u_L$ 不随时间变化，那么在预期问题和交换后的问题中，唯一的稳态解都是 $u(x)\\equiv u_L$。因此，一个只检查最终稳态解 $u(x)$ 的测试无法检测到此交换。\n\nB. 定义总质量 $M(t)=\\int_0^L u(x,t)\\,dx$。在预期问题中，有 $M'(t) = -D\\,\\frac{\\partial u}{\\partial x}(0,t)$，而在交换后的问题中，有 $M'(t) = D\\,\\frac{\\partial u}{\\partial x}(L,t)$。因此，在交换后的实现中，任何与环境的质量交换都发生在错误的边界上。\n\nC. 交换狄利克雷和诺伊曼边界条件必然会违反极值原理，因此即使对所有 $x$ 都有 $u_0(x)\\ge 0$ 且 $u_L\\ge 0$，交换后的模拟通常也会在中间时刻产生负的 $u$ 值。\n\nD. 如果在两次运行中都使用相同的非对称初始条件 $u_0(x)$（关于 $x=L/2$ 不对称），那么预期边界条件运行和交换边界条件运行所产生的时间依赖解通常会有所不同，且这种差异无法通过简单的空间反射 $x\\mapsto L-x$ 获得。\n\nE. 对于混合狄利克雷-诺伊曼边界条件，空间算子 $-D\\,\\frac{d^2}{dx^2}$ 的谱在交换狄利克雷与诺伊曼边界的位置后保持不变；因此，在预期问题和交换后的问题中，瞬态衰减率是相同的，尽管空间模态形状是镜像的。", "solution": "#### 选项分析\n\n**选项 A 评估**\n稳态解 $u(x)$ 满足 $\\frac{\\partial u}{\\partial t} = 0$，这使得偏微分方程简化为常微分方程 $D\\,\\frac{d^2 u}{dx^2} = 0$。由于 $D>0$，这意味着 $\\frac{d^2 u}{dx^2} = 0$。其通解是线性函数 $u(x) = C_1 x + C_2$。\n\n1.  **预期问题**：边界条件为 $u(0) = u_L$ 和 $\\frac{du}{dx}(L) = 0$。\n    -   由 $u(0) = u_L$ 可得 $C_2 = u_L$。\n    -   由 $\\frac{du}{dx}(L) = C_1 = 0$ 可得 $C_1 = 0$。\n    -   唯一的稳态解是 $u(x) = u_L$。\n\n2.  **交换后的问题**：边界条件为 $\\frac{du}{dx}(0) = 0$ 和 $u(L) = u_L$。\n    -   由 $\\frac{du}{dx}(0) = C_1 = 0$ 可得 $C_1 = 0$。\n    -   由 $u(L) = u_L$ 可得 $C_1 \\cdot L + C_2 = u_L \\implies C_2 = u_L$。\n    -   唯一的稳态解同样是 $u(x) = u_L$。\n\n由于两个问题都收敛到相同的稳态解，一个只检查最终状态的测试将无法检测到这个错误。\n**结论**：选项 A 的陈述是**正确的**。\n\n**选项 B 评估**\n总质量为 $M(t) = \\int_0^L u(x,t)\\,dx$。其变化率是：\n$$\n\\frac{dM}{dt} = \\int_0^L \\frac{\\partial u}{\\partial t}\\,dx = \\int_0^L D\\,\\frac{\\partial^2 u}{\\partial x^2}\\,dx = D \\left[ \\frac{\\partial u}{\\partial x} \\right]_0^L = D \\left( \\frac{\\partial u}{\\partial x}(L,t) - \\frac{\\partial u}{\\partial x}(0,t) \\right)\n$$\n1.  **预期问题**：边界条件为 $u(0,t) = u_L$ 和 $\\frac{\\partial u}{\\partial x}(L,t) = 0$。代入得：\n    $$ \\frac{dM}{dt} = D \\left( 0 - \\frac{\\partial u}{\\partial x}(0,t) \\right) = -D\\,\\frac{\\partial u}{\\partial x}(0,t) $$\n    质量交换发生在 $x=0$ 处。\n\n2.  **交换后的问题**：边界条件为 $\\frac{\\partial u}{\\partial x}(0,t) = 0$ 和 $u(L,t) = u_L$。代入得：\n    $$ \\frac{dM}{dt} = D \\left( \\frac{\\partial u}{\\partial x}(L,t) - 0 \\right) = D\\,\\frac{\\partial u}{\\partial x}(L,t) $$\n    质量交换发生在 $x=L$ 处。\n\n该陈述准确地描述了 $M'(t)$ 的表达式，并正确地指出质量交换发生在错误的边界上。\n**结论**：选项 B 的陈述是**正确的**。\n\n**选项 C 评估**\n热/扩散方程遵循极值原理。对于交换后的问题，解的最小值将在初始时刻（$t=0$）或在施加狄利克雷条件的边界（$x=L$）上达到。设 $m = \\min\\left( \\inf_{x\\in[0,L]} u_0(x), u_L \\right)$。极小值原理保证对所有 $x$ 和 $t$，$u(x,t) \\ge m$。如果初始条件和边界值都是非负的（$u_0(x) \\ge 0, u_L \\ge 0$），那么 $m \\ge 0$，因此解 $u(x,t)$ 将始终保持非负。交换边界条件不会违反此基本性质。\n**结论**：选项 C 的陈述是**不正确的**。\n\n**选项 D 评估**\n令 $u_I(x,t)$ 为预期问题的解，$u_S(x,t)$ 为交换后问题的解。定义一个新函数 $v(x,t) = u_I(L-x, t)$。函数 $v(x,t)$ 满足相同的偏微分方程。我们检查其边界条件：\n-   在 $x=0$ 处：$\\frac{\\partial v}{\\partial x}(0,t) = -\\frac{\\partial u_I}{\\partial x}(L,t) = 0$。\n-   在 $x=L$ 处：$v(L,t) = u_I(0,t) = u_L$。\n这些正是交换后的边界条件。然而，$v(x,t)$ 的初始条件是 $v(x,0) = u_I(L-x,0) = u_0(L-x)$。\n交换后问题的解 $u_S(x,t)$ 的初始条件是 $u_0(x)$。由于问题假设 $u_0(x)$ 是非对称的，即 $u_0(x) \\not\\equiv u_0(L-x)$，因此 $v(x,t)$ 和 $u_S(x,t)$ 的初始条件不同。根据解的唯一性，一般情况下 $u_S(x,t) \\neq v(x,t)$，即 $u_S(x,t) \\neq u_I(L-x,t)$。这意味着交换后问题的解不仅仅是预期问题解的空间反射。\n**结论**：选项 D 的陈述是**正确的**。\n\n**选项 E 评估**\n瞬态行为由空间算子 $\\mathcal{L} = -D \\frac{d^2}{dx^2}$ 在相应的齐次边界条件下的特征值 $\\lambda$ 决定。\n\n1.  **预期问题**：特征值问题为 $-D \\phi''(x) = \\lambda \\phi(x)$，边界条件为 $\\phi(0) = 0, \\phi'(L) = 0$。\n    -   解的形式为 $\\phi(x) \\propto \\sin(kx)$，其中 $k^2 = \\lambda/D$。\n    -   $\\phi'(L) = 0 \\implies \\cos(kL)=0 \\implies k_n L = \\frac{(2n-1)\\pi}{2}$ for $n=1,2,\\dots$。\n    -   特征值为 $\\lambda_n = D \\left(\\frac{(2n-1)\\pi}{2L}\\right)^2$。\n\n2.  **交换后的问题**：特征值问题为 $-D \\phi''(x) = \\lambda \\phi(x)$，边界条件为 $\\phi'(0) = 0, \\phi(L) = 0$。\n    -   解的形式为 $\\phi(x) \\propto \\cos(kx)$。\n    -   $\\phi(L)=0 \\implies \\cos(kL)=0 \\implies k_n L = \\frac{(2n-1)\\pi}{2}$ for $n=1,2,\\dots$。\n    -   特征值 $\\lambda_n = D \\left(\\frac{(2n-1)\\pi}{2L}\\right)^2$。\n\n两个问题的特征值集合（谱）是完全相同的，因此瞬态衰减率也相同。特征函数（模态形状）分别是 $\\sin$ 和 $\\cos$ 函数族，它们是彼此的空间反射（可能相差一个符号），例如 $\\sin\\left(\\frac{\\pi(L-x)}{2L}\\right) = \\cos\\left(\\frac{\\pi x}{2L}\\right)$。\n**结论**：选项 E 的陈述是**正确的**。", "answer": "$$\\boxed{ABDE}$$", "id": "2386501"}, {"introduction": "最后，我们将理论知识应用于一个更真实、更具挑战性的计算物理问题中。这个练习模拟了一个T形管中的声学共振，这是一个在工程和应用物理学中常见的情景 [@problem_id:2386432]。我们需要正确地在一个复杂的几何结构（T形连接管）上施加混合边界条件——一个开放的管口（狄利克雷条件）和两个封闭的管口（诺伊曼条件），并使用强大的有限元方法来预测系统的物理行为，从而将物理直觉与计算实践紧密结合起来。", "problem": "考虑一个由三个在单个连接点汇合的直管分支组成的T形管内，空气中的小振幅一维线性声学问题。设声压表示为 $p(x,t)$，沿分支的空间坐标为 $x$，声速为 $c$。忽略粘性和热损失，并假设平面波近似成立（即管径与关注的波长相比足够小）。在每个分支上，控制方程为一维波动方程 $p_{tt} = c^2 p_{xx}$。在主管的开口端，施加狄利克雷边界条件 $p = 0$。在两个支管的闭合端，施加诺伊曼边界条件 $p_x = 0$。在连接点处，施加所有分支间的压力连续性条件和体积速度守恒条件。在一维情况下，后者简化为基尔霍夫条件，即向外的体积速度通量之和为零：$\\sum_{i=1}^3 A_i \\, p_x^{(i)}(0,t) = 0$，其中 $A_i$ 是分支 $i$ 的横截面积，$x=0$ 是每个分支的连接点坐标，且 $x$ 沿该分支向外增加。\n\n通过寻找分离变量解 $p(x,t) = \\Re\\{ \\phi(x) e^{\\mathrm{i}\\omega t} \\}$ 来建立时谐特征值问题，其中 $\\omega$ 是角频率，$\\phi(x)$ 是复值空间模态振型。证明在每个分支上，空间分量满足亥姆霍兹方程 $-\\phi''(x) = k^2 \\phi(x)$（其中 $k = \\omega/c$），以及上述边界条件和连接点条件：$\\phi$ 连续且 $\\sum_{i=1}^3 A_i \\, \\phi_x^{(i)}(0) = 0$。\n\n从一维波动方程的基本原理出发，通过分部积分推导网络上的有限元弱形式。在每个分支上使用连续分段线性形函数，组装全局刚度矩阵 $K$ 和质量矩阵 $M$，从而得到离散广义特征问题 $K \\mathbf{u} = \\lambda M \\mathbf{u}$，其中 $\\lambda = \\omega^2/c^2$。将主管开口端的狄利克雷边界条件作为本质约束施加。支管闭合端的诺伊曼边界条件是自然边界条件，无需显式修改。连接点的连续性通过让所有入射分支共享连接点节点来强制实现；基尔霍夫通量条件则通过组装按横截面积加权的单元贡献来隐式实现。\n\n实现一个程序，该程序：\n- 为一个由三个在单点汇合的分支组成的T形管构建全局有限元矩阵 $K$ 和 $M$，其中各分支具有特定的长度和横截面积，并为每个分支使用 $n$ 个均匀线性单元。\n- 求解广义对称特征问题 $K \\mathbf{u} = \\lambda M \\mathbf{u}$，并计算最小正特征频率 $f_1 = \\omega_1/(2\\pi)$（单位：赫兹），其中 $\\omega_1 = c \\sqrt{\\lambda_1}$。\n- 使用以米/秒为单位的声速 $c$。\n- 报告频率，单位为赫兹，并四舍五入到两位小数。\n\n使用以下测试套件。在所有情况下，主管是在其自由端（开口端）具有狄利克雷边界条件的分支，两个支管具有诺伊曼边界条件（闭合端）。所有长度单位为米，所有面积单位为平方米，$c$ 的单位为米/秒。对于每种情况，还需指定每个分支的均匀线性单元数量。\n\n- A情况（对称支管，相等面积；理想路径）：\n  - $c = 343$\n  - 主管长度 $L_s = 0.60$，支管1长度 $L_1 = 0.40$，支管2长度 $L_2 = 0.40$\n  - 主管面积 $A_s = 2.0\\times 10^{-4}$，支管1面积 $A_1 = 2.0\\times 10^{-4}$，支管2面积 $A_2 = 2.0\\times 10^{-4}$\n  - 单元数：主管 $n_s = 120$，支管1 $n_1 = 80$，支管2 $n_2 = 80$\n\n- B情况（非对称支管长度；几何边界情况）：\n  - $c = 343$\n  - $L_s = 0.60$, $L_1 = 0.20$, $L_2 = 0.80$\n  - $A_s = 2.0\\times 10^{-4}$, $A_1 = 2.0\\times 10^{-4}$, $A_2 = 2.0\\times 10^{-4}$\n  - $n_s = 120$, $n_1 = 40$, $n_2 = 160$\n\n- C情况（对称支管长度；不等面积；连接点加权边界情况）：\n  - $c = 343$\n  - $L_s = 0.60$, $L_1 = 0.40$, $L_2 = 0.40$\n  - $A_s = 2.0\\times 10^{-4}$, $A_1 = 1.0\\times 10^{-4}$, $A_2 = 4.0\\times 10^{-4}$\n  - $n_s = 120$, $n_1 = 80$, $n_2 = 80$\n\n你的程序必须为每种情况计算基频 $f_1$（单位：赫兹），结果为一个四舍五入到两位小数的浮点数。最终输出格式必须是单行，包含一个用方括号括起来的逗号分隔列表，顺序为 [A情况结果, B情况结果, C情况结果]，例如 \"[$f_A$,$f_B$,$f_C$]\"。不应打印任何额外文本。所有输出都必须以赫兹为单位。", "solution": "所提出的问题是计算声学中的一个标准特征值问题，需要通过有限元方法进行建模和求解。在进行求解之前，有必要进行严格的验证。\n\n**问题验证**\n\n1.  **已知条件提取**：\n    *   控制方程：一维波动方程，$p_{tt} = c^2 p_{xx}$。\n    *   区域：一个由三个在连接点汇合的分支组成的T形管网络。\n    *   边界条件（BCs）：主管开口端为狄利克雷边界条件 $p=0$；两个支管闭合端为诺伊曼边界条件 $p_x=0$。\n    *   连接点条件：压力连续，$\\phi$ 在连接点处连续；体积速度通量的Kirchhoff定律，$\\sum_{i=1}^3 A_i \\, p_x^{(i)}(0,t) = 0$，其中 $x=0$ 在连接点处。\n    *   假设解的形式：$p(x,t) = \\Re\\{ \\phi(x) e^{\\mathrm{i}\\omega t} \\}$。\n    *   推导出的空间问题：亥姆霍兹方程 $-\\phi''(x) = k^2 \\phi(x)$，其中 $k = \\omega/c$，并服从于给定的关于 $\\phi(x)$ 的边界条件和连接点条件。\n    *   数值方法：使用连续分段线性形函数的有限元方法（FEM），建立离散广义特征问题 $K \\mathbf{u} = \\lambda M \\mathbf{u}$，其中 $\\lambda = \\omega^2/c^2$。\n    *   任务：为三个特定的测试用例计算最小正特征频率 $f_1 = \\omega_1/(2\\pi) = c\\sqrt{\\lambda_1}/(2\\pi)$。\n    *   测试用例：提供了声速 $c$、分支长度 $L_i$、横截面积 $A_i$ 以及每个分支的单元数 $n_i$ 的具体值。\n\n2.  **验证检查**：\n    *   **科学依据**：该问题根本上基于线性波动方程，这是小振幅声学的标准模型。边界条件和连接点原理（Kirchhoff定律）在声学中是公认的。使用有限元方法求解由此产生的亥姆霍兹特征值问题是计算物理学中的一种标准且稳健的技术。该问题在科学上是合理的。\n    *   **适定性**：该问题是求解一个具有指定边界条件的二阶微分算子的特征值。这构成了一个网络图上的Sturm-Liouville类型问题，这类问题是适定的，并拥有离散的实特征值谱。对最小正特征频率的要求是明确的。\n    *   **客观性**：问题以精确、客观和定量的语言陈述。所有必要的物理和离散化参数均已提供。\n    *   **完整性和一致性**：问题是自洽的。它提供了进行数值求解所需的所有数据。设置中没有矛盾之处。\n    *   **其他缺陷**：该问题并非不切实际、不适定、无法验证或无法形式化。该设置是将有限元方法应用于网络域的一个经典教科书示例。\n\n3.  **结论**：问题有效。可以构建一个合理的解决方案。\n\n**有限元公式推导**\n\n分析始于时谐波动方程，即亥姆霍兹方程，该方程定义在T形管网络的每个分支 $i$ 上。为了正确地考虑连接点处的物理守恒定律，我们考虑方程的面积加权形式：\n$$\n-A_i \\phi_i''(x) = k^2 A_i \\phi_i(x) \\quad \\text{for } x \\in (0, L_i)\n$$\n其中 $\\phi_i(x)$ 是分支 $i$ 上的空间压力模态，$A_i$ 是其横截面积，$L_i$ 是其长度，$k^2 = \\lambda = \\omega^2/c^2$ 是待求的特征值。\n\n为了推导弱形式，我们将方程乘以一个任意检验函数 $v(x)$（该函数遵守与 $\\phi$ 相同的连续性和本质边界条件），并在整个域 $\\Omega = \\bigcup_i [0, L_i]$ 上积分：\n$$\n\\sum_{i=1}^3 \\int_{0}^{L_i} -A_i \\phi_i''(x) v(x) \\, dx = \\lambda \\sum_{i=1}^3 \\int_{0}^{L_i} A_i \\phi_i(x) v(x) \\, dx\n$$\n对每个分支的左侧项应用分部积分，得到：\n$$\n\\int_{0}^{L_i} -A_i \\phi_i'' v \\, dx = \\left[-A_i \\phi_i' v\\right]_0^{L_i} + \\int_{0}^{L_i} A_i \\phi_i' v' \\, dx\n$$\n对所有三个分支（主管 $s$、支管1、支管2）求和，完整的方程变为：\n$$\n\\sum_{i=s,1,2} \\int_{0}^{L_i} A_i \\phi_i' v' \\, dx + \\sum_{i=s,1,2} \\left[-A_i \\phi_i' v\\right]_0^{L_i} = \\lambda \\sum_{i=s,1,2} \\int_{0}^{L_i} A_i \\phi_i v \\, dx\n$$\n在外部端点（$x=L_i$）和内部连接点（$x=0$）处分析边界项：\n*   在主管的开口端（$x=L_s$），我们有狄利克雷条件 $\\phi_s(L_s)=0$。这是一个本质边界条件，意味着它必须被施加在解空间上。我们通过要求检验函数在该点也为零，即 $v(L_s)=0$，来强制执行此条件。因此，在 $x=L_s$ 处的边界项为零。\n*   在支管的闭合端（$x=L_1, x=L_2$），我们有诺伊曼条件 $\\phi_1'(L_1)=0$ 和 $\\phi_2'(L_2)=0$。这些是自然边界条件。边界项 $-A_1 \\phi_1'(L_1) v(L_1)$ 和 $-A_2 \\phi_2'(L_2) v(L_2)$ 由于这些条件而自动为零，对检验函数 $v$ 没有任何约束。\n*   在连接点（$x=0$），边界项之和为 $\\sum_{i=s,1,2} A_i \\phi_i'(0) v_i(0)$。根据压力连续性，$\\phi_s(0)=\\phi_1(0)=\\phi_2(0)$，这个性质也施加于检验函数 $v$，因此 $v_s(0)=v_1(0)=v_2(0) \\equiv v(0)$。和变为 $v(0) \\sum_{i} A_i \\phi_i'(0)$。Kirchhoff条件要求净体积速度通量为零，这可以转化为 $\\sum_{i} A_i \\phi_i'(0) = 0$。这也是一个自然边界条件，它迫使连接点边界项之和为零。\n\n在所有边界项都被消除后，弱形式为：找到 $\\phi$（满足 $\\phi_s(L_s)=0$），使得对于所有容许的检验函数 $v$（满足 $v(L_s)=0$）：\n$$\n\\underbrace{\\sum_{i=s,1,2} \\int_{0}^{L_i} A_i \\phi' v' \\, dx}_{a(\\phi, v)} = \\lambda \\underbrace{\\sum_{i=s,1,2} \\int_{0}^{L_i} A_i \\phi v \\, dx}_{b(\\phi, v)}\n$$\n这是一个变分形式 $a(\\phi,v) = \\lambda b(\\phi,v)$，它引出了广义矩阵特征值问题。\n\n为了离散化，我们在每个分支 $i$ 的包含 $n_i$ 个单元的网格上使用连续分段线性基函数（帽函数）$N_j(x)$。我们将解近似为 $\\phi_h(x) = \\sum_{j} u_j N_j(x)$，其中 $u_j$ 是节点上的未知压力值。使用Galerkin方法，其中检验函数选自相同的基，即 $v_h(x) = N_i(x)$，我们得到矩阵系统 $K \\mathbf{u} = \\lambda M \\mathbf{u}$，其矩阵元素为：\n$$\nK_{ij} = a(N_j, N_i) \\quad \\text{and} \\quad M_{ij} = b(N_j, N_i)\n$$\n对于一个长度为 $h$、面积为 $A$ 的单个线性单元，其局部单元刚度矩阵 $k^e$ 和质量矩阵 $m^e$ 计算如下：\n$$\nk^e = \\frac{A}{h} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix}, \\quad m^e = \\frac{Ah}{6} \\begin{pmatrix} 2  1 \\\\ 1  2 \\end{pmatrix}\n$$\n全局矩阵 $K$ 和 $M$ 是通过将所有单元的贡献求和组装而成的，这些贡献被正确地映射到全局自由度上。连接点处的连续性通过为连接点分配一个单一的全局节点索引来物理上强制实现，三个分支的第一个单元都连接到该节点。Kirchhoff条件所要求的面积加权 $A_i$ 通过其在单元矩阵公式中的存在而自然地被包含进来。\n\n最后，通过从全局矩阵 $K$ 和 $M$ 中消去与主管末端节点对应的行和列，来施加本质狄利克雷条件 $\\phi_s(L_s)=0$。求解得到的简化系统以获得最小特征值 $\\lambda_1$。然后，基本固有频率计算为 $f_1 = \\frac{c}{2\\pi}\\sqrt{\\lambda_1}$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import linalg\n\ndef solve():\n    \"\"\"\n    Main function to define test cases and compute results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A: Symmetric arms, equal areas\n        {\n            \"c\": 343, \"Ls\": 0.60, \"L1\": 0.40, \"L2\": 0.40,\n            \"As\": 2.0e-4, \"A1\": 2.0e-4, \"A2\": 2.0e-4,\n            \"ns\": 120, \"n1\": 80, \"n2\": 80\n        },\n        # Case B: Asymmetric arm lengths\n        {\n            \"c\": 343, \"Ls\": 0.60, \"L1\": 0.20, \"L2\": 0.80,\n            \"As\": 2.0e-4, \"A1\": 2.0e-4, \"A2\": 2.0e-4,\n            \"ns\": 120, \"n1\": 40, \"n2\": 160\n        },\n        # Case C: Symmetric arm lengths, unequal areas\n        {\n            \"c\": 343, \"Ls\": 0.60, \"L1\": 0.40, \"L2\": 0.40,\n            \"As\": 2.0e-4, \"A1\": 1.0e-4, \"A2\": 4.0e-4,\n            \"ns\": 120, \"n1\": 80, \"n2\": 80\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        f1 = solve_fem_acoustics(**case)\n        results.append(f\"{f1:.2f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\ndef assemble(K, M, i, j, A, h):\n    \"\"\"\n    Assembles a 1D linear element's stiffness and mass matrices into global matrices.\n    \n    Args:\n        K (np.ndarray): Global stiffness matrix.\n        M (np.ndarray): Global mass matrix.\n        i (int): Global index of the first node.\n        j (int): Global index of the second node.\n        A (float): Cross-sectional area of the element's branch.\n        h (float): Length of the element.\n    \"\"\"\n    ke = (A / h) * np.array([[1, -1], [-1, 1]])\n    me = (A * h / 6) * np.array([[2, 1], [1, 2]])\n    \n    indices = np.ix_([i, j], [i, j])\n    K[indices] += ke\n    M[indices] += me\n\ndef solve_fem_acoustics(c, Ls, L1, L2, As, A1, A2, ns, n1, n2):\n    \"\"\"\n    Constructs and solves the FEM eigenproblem for a T-tube.\n\n    Returns:\n        float: The fundamental frequency f1 in Hertz.\n    \"\"\"\n    # Total number of nodes = junction (1) + stem nodes + arm1 nodes + arm2 nodes\n    num_nodes = 1 + ns + n1 + n2\n    \n    # Initialize global stiffness (K) and mass (M) matrices\n    K = np.zeros((num_nodes, num_nodes))\n    M = np.zeros((num_nodes, num_nodes))\n\n    # Node indexing\n    # Node 0: Junction\n    # Nodes 1 to ns: Stem\n    # Nodes ns+1 to ns+n1: Arm 1\n    # Nodes ns+n1+1 to ns+n1+n2: Arm 2\n    \n    # Assemble Stem Branch\n    hs = Ls / ns\n    # First element: junction to first stem node\n    assemble(K, M, 0, 1, As, hs)\n    # Remaining elements along the stem\n    for i in range(1, ns):\n        assemble(K, M, i, i + 1, As, hs)\n\n    # Assemble Arm 1 Branch\n    h1 = L1 / n1\n    # First element: junction to first arm1 node\n    assemble(K, M, 0, ns + 1, A1, h1)\n    # Remaining elements along arm 1\n    for i in range(1, n1):\n        assemble(K, M, ns + i, ns + i + 1, A1, h1)\n        \n    # Assemble Arm 2 Branch\n    h2 = L2 / n2\n    # First element: junction to first arm2 node\n    assemble(K, M, 0, ns + n1 + 1, A2, h2)\n    # Remaining elements along arm 2\n    for i in range(1, n2):\n        assemble(K, M, ns + n1 + i, ns + n1 + i + 1, A2, h2)\n\n    # Impose Dirichlet boundary condition at the end of the stem (node ns)\n    # This is done by removing the corresponding row and column.\n    dirichlet_node_idx = ns\n    \n    free_dofs = np.delete(np.arange(num_nodes), dirichlet_node_idx)\n    \n    K_red = K[np.ix_(free_dofs, free_dofs)]\n    M_red = M[np.ix_(free_dofs, free_dofs)]\n    \n    # Solve the generalized eigenvalue problem K*u = lambda*M*u\n    # scipy.linalg.eigh returns eigenvalues in ascending order.\n    eigenvalues, _ = linalg.eigh(K_red, M_red)\n    \n    # We need the smallest positive eigenvalue. A true zero mode is eliminated by the Dirichlet BC.\n    # We search for the first eigenvalue greater than a small tolerance to avoid numerical noise.\n    lambda_1 = 0.0\n    for val in eigenvalues:\n        if val > 1e-9:\n            lambda_1 = val\n            break\n\n    # Calculate the fundamental frequency f1\n    # lambda = (omega/c)^2 => omega = c * sqrt(lambda)\n    # f = omega / (2*pi)\n    omega_1 = c * np.sqrt(lambda_1)\n    f1 = omega_1 / (2 * np.pi)\n    \n    return f1\n\nif __name__ == \"__main__\":\n    solve()\n\n```", "id": "2386432"}]}