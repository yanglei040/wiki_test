{"hands_on_practices": [{"introduction": "冯·诺依曼稳定性分析不仅是检验数值格式是否稳定的判据，更是一个用以控制数值行为的强大设计工具。本练习将演示如何通过选择一个特定的模拟参数 $\\mu$，来精确地消除网格所能分辨的最高频率误差。掌握如何利用放大因子来控制数值耗散，是设计具有理想特性的数值格式的关键一步。[@problem_id:2225599]", "problem": "一位数值分析家正在研究一个用于求解一维输运过程的有限差分格式。该格式的稳定性通过将数值误差分解为其傅里叶模态进行分析。放大因子 $G$ 决定了波数为 $k$ 的单个傅里叶模态的振幅如何从一个时间步演化到下一个时间步，其表达式为：\n$$ G = 1 - 2\\mu (1 - \\cos(k \\Delta x)) $$\n此处，$\\Delta x$ 是空间网格间距，$\\mu$ 是一个无量纲参数，它取决于时间步长、网格间距以及所模拟系统的物理性质。\n\n该分析家特别关注高频误差，特别是波长恰好为 $2\\Delta x$ 的误差分量，因为它代表了网格所能分辨的最振荡的误差。目标是选择模拟参数 $\\mu$，使得这个特定的误差分量在仅一个时间步后就被完全消除。\n\n确定实现此目标所需的 $\\mu$ 的精确值。请用小数值表示你的答案。", "solution": "我们分析波长为 $\\lambda = 2\\Delta x$ 的傅里叶模态。对于一个傅里叶模态，波长和波数之间的关系是 $k = \\frac{2\\pi}{\\lambda}$，因此\n$$\nk\\Delta x = \\frac{2\\pi}{\\lambda}\\Delta x = \\frac{2\\pi}{2\\Delta x}\\Delta x = \\pi.\n$$\n将 $k\\Delta x = \\pi$ 代入放大因子表达式中，\n$$\nG = 1 - 2\\mu\\left(1 - \\cos(k\\Delta x)\\right) = 1 - 2\\mu\\left(1 - \\cos(\\pi)\\right).\n$$\n使用 $\\cos(\\pi) = -1$，\n$$\nG = 1 - 2\\mu\\left(1 - (-1)\\right) = 1 - 2\\mu \\cdot 2 = 1 - 4\\mu.\n$$\n为了在一个时间步后消除此误差分量，其放大因子必须为零，所以我们令 $G = 0$：\n$$\n1 - 4\\mu = 0 \\quad \\Rightarrow \\quad \\mu = \\frac{1}{4}.\n$$\n表示为小数，即为 $0.25$。", "answer": "$$\\boxed{0.25}$$", "id": "2225599"}, {"introduction": "接下来，我们将运用相同的数值格式（FTCS）来求解热传导方程，并借此探讨一个更细致的稳定性概念。标准的稳定性条件仅要求误差不随时间增长，但这并不总能保证解的物理真实性。本练习将区分标准的冯·诺依曼稳定性条件（$|G| \\le 1$）与一个更严格的、旨在防止非物理振荡的条件（$G \\ge 0$），突显出即使是“稳定”的格式也可能产生需要我们警惕和控制的数值伪影。[@problem_id:2225566]", "problem": "在计算流体力学中，一维热方程 $\\frac{\\partial u}{\\partial t} = \\alpha \\frac{\\partial^2 u}{\\partial x^2}$ 通常采用数值方法求解。其中最简单的方法之一是前向时间中心差分 (Forward-Time Central-Space, FTCS) 格式。使用时间步长为 $\\Delta t$、空间步长为 $\\Delta x$ 的网格，FTCS 格式将热方程离散化为：\n\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} = \\alpha \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{(\\Delta x)^2}\n$$\n\n此处，$u_j^n$ 表示在空间位置 $j \\Delta x$ 和时间步 $n \\Delta t$ 处的温度 $u$，$\\alpha$ 是热扩散系数。\n\n通过将形如 $u_j^n = G^n e^{i k j \\Delta x}$ 的傅里叶模代入离散方程，可以进行 von Neumann 稳定性分析。在这里，$G$ 是放大因子，$k$ 是波数，$i = \\sqrt{-1}$。$G$ 的行为决定了数值格式的稳定性。\n\n定义网格傅里叶数 (mesh Fourier number) 为 $\\mu = \\frac{\\alpha \\Delta t}{(\\Delta x)^2}$。放大因子 $G$ 可以表示为 $\\mu$ 和无量纲量 $\\theta = k \\Delta x$ 的函数。为了使数值解在某些情况下具有物理上的合理性，理想的情况是放大过程不引入虚假的振荡。如果放大因子 $G$ 对所有可能的波数都保证是实数且非负，就可以实现这一点。\n\n确定网格傅里叶数 $\\mu$ 必须满足的最严格条件，以确保放大因子 $G$ 对于所有可能的 $\\theta$ 值都是实数且非负的。\n\nA. $\\mu \\le \\frac{1}{\\sqrt{2}}$\n\nB. $\\mu \\le \\frac{1}{2}$\n\nC. $\\mu \\le \\frac{1}{4}$\n\nD. $\\mu \\le 1$", "solution": "问题要求找出网格傅里叶数 $\\mu$ 需要满足的条件，以确保前向时间中心差分 (FTCS) 格式的放大因子 $G$ 对所有波数都是实数且非负的。\n\n首先，我们必须推导放大因子 $G$ 的表达式。我们从 FTCS 离散方程开始：\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} = \\alpha \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{(\\Delta x)^2}\n$$\n\n我们引入网格傅里叶数 $\\mu = \\frac{\\alpha \\Delta t}{(\\Delta x)^2}$ 来简化方程：\n$$\nu_j^{n+1} - u_j^n = \\mu (u_{j+1}^n - 2u_j^n + u_{j-1}^n)\n$$\n$$\nu_j^{n+1} = u_j^n + \\mu (u_{j+1}^n - 2u_j^n + u_{j-1}^n)\n$$\n\n现在，我们将傅里叶模解 $u_j^n = G^n e^{i k j \\Delta x}$ 代入该方程。各项变为：\n- $u_j^{n+1} = G^{n+1} e^{i k j \\Delta x}$\n- $u_j^n = G^n e^{i k j \\Delta x}$\n- $u_{j+1}^n = G^n e^{i k (j+1) \\Delta x} = G^n e^{i k j \\Delta x} e^{i k \\Delta x}$\n- $u_{j-1}^n = G^n e^{i k (j-1) \\Delta x} = G^n e^{i k j \\Delta x} e^{-i k \\Delta x}$\n\n将这些代入整理后的 FTCS 方程得到：\n$$\nG^{n+1} e^{i k j \\Delta x} = G^n e^{i k j \\Delta x} + \\mu (G^n e^{i k j \\Delta x} e^{i k \\Delta x} - 2 G^n e^{i k j \\Delta x} + G^n e^{i k j \\Delta x} e^{-i k \\Delta x})\n$$\n\n我们可以将整个方程除以公因子 $G^n e^{i k j \\Delta x}$（假设其不为零）：\n$$\nG = 1 + \\mu (e^{i k \\Delta x} - 2 + e^{-i k \\Delta x})\n$$\n\n令 $\\theta = k \\Delta x$。$G$ 的表达式变为：\n$$\nG = 1 + \\mu (e^{i\\theta} + e^{-i\\theta} - 2)\n$$\n\n使用 Euler 恒等式 $e^{i\\theta} + e^{-i\\theta} = 2\\cos(\\theta)$，我们可以简化 $G$：\n$$\nG = 1 + \\mu (2\\cos(\\theta) - 2)\n$$\n$$\nG = 1 - 2\\mu(1 - \\cos(\\theta))\n$$\n由于 $\\mu$ 和 $\\cos(\\theta)$ 都是实数，放大因子 $G$ 始终是实数。因此，我们只需要找到使 $G$ 为非负的条件，即 $G \\ge 0$。\n\n条件是：\n$$\n1 - 2\\mu(1 - \\cos(\\theta)) \\ge 0\n$$\n\n这个不等式必须对所有可能的 $\\theta$ 值都成立。为了找到对 $\\mu$ 最严格的条件，我们需要找到 $G$ 相对于 $\\theta$ 的最小值，并确保该最小值是非负的。\n\n项 $(1 - \\cos(\\theta))$ 的取值范围是从 $0$（当 $\\theta = 0, \\pm 2\\pi, \\dots$ 时）到 $2$（当 $\\theta = \\pm \\pi, \\pm 3\\pi, \\dots$ 时）。\n函数 $G(\\theta) = 1 - 2\\mu(1 - \\cos(\\theta))$ 将在被减去的项 $2\\mu(1 - \\cos(\\theta))$ 达到最大值时取得其最小值。假设 $\\mu  0$，这发生在 $(1 - \\cos(\\theta))$ 达到其最大值时。\n\n$(1 - \\cos(\\theta))$ 的最大值是 $2$。这发生在 $\\cos(\\theta) = -1$ 时，即在 $\\theta = \\pm\\pi$ 时。\n\n将此最大值代入 $G$ 的表达式，得到 $G$ 的最小值：\n$$\nG_{min} = 1 - 2\\mu(2) = 1 - 4\\mu\n$$\n\n为了使 $G$ 对所有 $\\theta$ 都为非负，其最小值必须是非负的：\n$$\nG_{min} \\ge 0\n$$\n$$\n1 - 4\\mu \\ge 0\n$$\n\n求解 $\\mu$：\n$$\n1 \\ge 4\\mu\n$$\n$$\n\\mu \\le \\frac{1}{4}\n$$\n\n因此，确保 $G \\ge 0$ 对所有波数成立的对 $\\mu$ 最严格的条件是 $\\mu \\le 1/4$。这对应于选项 C。\n\n值得注意的是，FTCS 格式的标准 von Neumann 稳定性条件是 $|G| \\le 1$，这导致 $\\mu \\le 1/2$。这是一个较不严格的条件，它允许 $G$ 变为负值（低至-1），这会在解中引入非物理的振荡，即使振幅没有增长。本问题明确要求的是非负性条件，这是一个更严格的条件。", "answer": "$$\\boxed{C}$$", "id": "2225566"}, {"introduction": "最后，我们将注意力从扩散问题转向对流问题，以理解稳定性如何与问题的内在物理特性（尤其是信息传播方向）紧密相连。本练习将考察为顺应波传播方向而设计的迎风格式。我们将研究当数值模板与物理信息流向不匹配时所产生的灾难性后果——无条件不稳定性，这是计算流体动力学中一个至关重要的教训。[@problem_id:2450096]", "problem": "考虑线性平流方程 $u_t + c\\,u_x = 0$，其中波速 $c$ 为常数，空间网格为均匀网格 $x_j = j\\,\\Delta x$，时间层级为 $t^n = n\\,\\Delta t$，且 $\\Delta x  0$ 和 $\\Delta t  0$。定义 Courant 数 $\\nu = c\\,\\Delta t/\\Delta x$。假设使用显式单步迎风格式，其空间模板是为 $c0$ 的情况选择的，即\n$$\nu_j^{n+1} = u_j^n - \\nu(u_j^n - u_{j-1}^n)\n$$\n现在假设波速 $c$ 变为负值，但上述数值更新方法保持不变（即，模板未根据 $c$ 的新符号进行调整）。关于这个固定模板方法的线性稳定性随 $\\nu$ 变化的描述，哪个陈述是最佳的？\n\nA. 只要 $\\Delta t$ 满足 Courant-Friedrichs-Lewy (CFL) 条件 $0 \\le \\nu \\le 1$，该方法就保持稳定。\n\nB. 只要 $|\\nu| \\le 1$，该方法就稳定。\n\nC. 该方法变为无条件不稳定：对于任何 $\\Delta t  0$，都存在一个傅里叶模式，其放大因子的模大于1。\n\nD. 由于平流是无耗散的，该方法对所有傅里叶模式都保持中性稳定，即 $|G|=1$。\n\nE. 如果 $\\nu \\le 0$ 且 $|\\nu| \\le 1/2$，该方法是稳定的。", "solution": "我们使用线性常系数格式和傅里叶模式的假设，从第一性原理分析稳定性。考虑单个傅里叶模式 $u_j^n = \\hat{u}^n \\, e^{\\mathrm{i} j \\theta}$，其中 $\\theta \\in [-\\pi,\\pi]$ 是无量纲波数。将此代入更新公式\n$$\nu_j^{n+1} = u_j^n - \\nu(u_j^n - u_{j-1}^n)\n$$\n得到由 $\\hat{u}^{n+1} = G(\\theta)\\,\\hat{u}^n$ 定义的放大因子 $G(\\theta)$。因为 $u_{j-1}^n = \\hat{u}^n e^{\\mathrm{i}(j-1)\\theta} = e^{-\\mathrm{i}\\theta} u_j^n$，我们得到\n$$\nG(\\theta) = 1 - \\nu(1 - e^{-\\mathrm{i}\\theta})\n$$\n线性稳定性要求 $\\sup_{\\theta} |G(\\theta)| \\le 1$。所写的格式是针对 $c>0$ 的迎风选择，已知在 $0 \\le \\nu \\le 1$ 的条件下是稳定的。这里我们关心的是在保持相同模板的情况下 $c0$ 的情形，因此 $\\nu0$。令 $\\nu = -\\mu$，其中 $\\mu>0$。于是\n$$\nG(\\theta) = 1 + \\mu(1 - e^{-\\mathrm{i}\\theta}) = (1+\\mu) - \\mu e^{-\\mathrm{i}\\theta}\n$$\n计算模的平方：\n\\begin{align*}\n|G(\\theta)|^2\n= \\Big[(1+\\mu) - \\mu\\cos\\theta\\Big]^2 + \\Big[\\mu\\sin\\theta\\Big]^2 \\\\\n= (1+\\mu)^2 - 2\\mu(1+\\mu)\\cos\\theta + \\mu^2\\cos^2\\theta + \\mu^2\\sin^2\\theta \\\\\n= (1+\\mu)^2 - 2\\mu(1+\\mu)\\cos\\theta + \\mu^2 \\\\\n= 1 + 2\\mu + 2\\mu^2 - 2\\mu(1+\\mu)\\cos\\theta\n\\end{align*}\n因为 $\\cos\\theta$ 的系数是负的，所以 $|G(\\theta)|^2$ 在 $\\cos\\theta = -1$（即 $\\theta = \\pi$）时取得最大值，得到\n$$\n\\max_{\\theta} |G(\\theta)|^2 = 1 + 2\\mu + 2\\mu^2 + 2\\mu(1+\\mu) = 1 + 4\\mu + 4\\mu^2 = (1 + 2\\mu)^2\n$$\n因此\n$$\n\\max_{\\theta} |G(\\theta)| = 1 + 2\\mu > 1 \\quad \\text{for all } \\mu>0\n$$\n因此，一旦 $c0$（于是 $\\nu0$）且 $\\Delta t>0$，就存在一个傅里叶模式（特别是频率最高的模式 $\\theta=\\pi$）其模会增长。因此，当 $c$ 的符号为负但模板未作调整时，该固定模板方法是无条件不稳定的。\n\n逐项分析：\n\nA. 该选项声称在 $0 \\le \\nu \\le 1$ 下稳定。当 $c0$ 时，我们有 $\\nu0$，因此除非 $\\Delta t=0$，否则该条件无法满足。更重要的是，对于任何 $\\nu0$，我们刚刚证明了存在一个增长模式。结论：不正确。\n\nB. 该选项声称在 $|\\nu| \\le 1$ 时稳定。取 $\\nu=-\\mu$，其中任何 $\\mu \\in (0,1]$，我们发现 $\\max_{\\theta} |G(\\theta)| = 1 + 2\\mu > 1$，因此即使 $|\\nu|\\le 1$，该格式也是不稳定的。结论：不正确。\n\nC. 该选项陈述了对于未调整的模板是无条件不稳定的：对于任何 $\\Delta t0$，都存在一个傅里叶模式其 $|G|1$。我们的分析表明，对于所有 $\\mu>0$（等价于所有 $\\nu0$ 且 $\\Delta t0$），$\\max_{\\theta} |G(\\theta)| = 1 + 2\\mu  1$。结论：正确。\n\nD. 该选项断言中性稳定（$|G|=1$），理由是连续平流方程是无耗散的。然而，使用不匹配（顺风）模板的离散格式是反扩散的，并且对于某些模式会产生 $|G|1$。结论：不正确。\n\nE. 该选项提出在 $\\nu \\le 0$ 且 $|\\nu|\\le 1/2$ 时有条件稳定。设置 $\\mu = |\\nu| \\in (0,1/2]$ 仍然得出 $\\max_{\\theta} |G(\\theta)| = 1+2\\mu  1$。结论：不正确。", "answer": "$$\\boxed{C}$$", "id": "2450096"}]}