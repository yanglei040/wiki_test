## 引言
在物理学和工程学的广阔天地中，从[静电场](@entry_id:268546)的[分布](@entry_id:182848)到材料内部的[稳态温度](@entry_id:136775)场，许多系统的平衡状态都由一类被称为椭圆型[偏微分方程](@entry_id:141332)的数学模型所描述。然而，直接求解这些方程往往非常困难。通过[有限差分](@entry_id:167874)等数值方法，我们可以将连续的[微分](@entry_id:158718)问题转化为一个大型的线性代数方程组。问题的核心随之转变为：如何高效且准确地求解这个通常包含数百万甚至更多未知数的[方程组](@entry_id:193238)？

本文聚焦于解决这一挑战的一类经典而强大的数值技术——松弛法。这些迭代方法通过从一个初始猜测解出发，逐步“松弛”或逼近真实解，为处理[大规模科学计算](@entry_id:155172)问题提供了优雅且高效的途径。本文将带领您系统地探索松弛法的世界，旨在构建一个从理论到实践的完整知识体系。

- 在“**原理与机制**”一章中，我们将深入剖析松弛法的数学基础，理解其为何在处理[大型稀疏系统](@entry_id:177266)时优于直接法，并从[频域](@entry_id:160070)视角揭示其作为误差“平滑器”的本质。我们将详细介绍[Jacobi法](@entry_id:147508)、[Gauss-Seidel法](@entry_id:145727)和[SOR法](@entry_id:142488)等基本与高级格式，并讨论初始猜测和停止判据等实际执行中的关键问题。

- 接着，在“**应用与跨学科连接**”一章中，我们将跨越学科的边界，展示松弛法如何在电磁学、热传导、生物物理、医学成像乃至计算机图形学和经济学等领域大放异彩。这些案例将彰显松弛法思想的普适性及其解决现实问题的强大能力。

- 最后，在“**动手实践**”部分，我们为您精心设计了一系列编程练习。您将有机会亲手实现并应用所学的方法，从在不同[坐标系](@entry_id:156346)下求解[泊松方程](@entry_id:143763)，到挑战更复杂的高阶方程，从而将理论知识转化为真正的计算技能。

通过本次学习，您不仅将掌握一种关键的数值计算方法，更将获得一种通过迭代逼近来探索复杂系统平衡态的计算思维。现在，让我们一同开始这段探索之旅。

## 原理与机制

在引言章节中，我们已经明确，椭圆型[偏微分方程](@entry_id:141332)在描述物理学和工程学中的各类[稳态](@entry_id:182458)问题中扮演着核心角色。当采用[有限差分法](@entry_id:147158)或有限元法等数值技术对这些方程进行离散化时，我们通常会得到一个大型的线性代数方程组，其形式为 $A\mathbf{u} = \mathbf{b}$。本章将深入探讨求解此类方程组的松弛法（Relaxation Methods）的内在原理与关键机制。我们将从离散系统的特性出发，阐明为何[迭代法](@entry_id:194857)是必要的，进而剖析松弛法作为误差“平滑器”的本质，并系统地介绍各种基本与高级的松弛格式，最后讨论实际执行中的重要考量。

### 离散[椭圆问题](@entry_id:146817)的本质

椭圆型[偏微分方程](@entry_id:141332)的典型特征是其解的全局依赖性，即区域内任何一点的解都受到整个边界条件的影响。这与描述演化过程的抛物线型和[双曲型方程](@entry_id:145657)形成鲜明对比，后者需要[初始条件](@entry_id:152863)来确定其时间演化路径 [@problem_id:2543126]。以二维[泊松方程](@entry_id:143763) $-\nabla^2 u = f$ 为例，当我们在一个矩形区域上使用均匀网格和标准的五点[中心差分格式](@entry_id:747203)进行离散化时，对于每一个内部网格点 $(i,j)$，我们都会得到一个代数方程：

$$
\frac{4u_{i,j} - u_{i-1,j} - u_{i+1,j} - u_{i,j-1} - u_{i,j+1}}{h^2} = f_{i,j}
$$

其中 $h$ 是网格间距，$u_{i,j}$ 是在点 $(x_i, y_j)$ 处的未知解的近似值。将所有内部点的方程收集起来，就构成了一个大型线性方程组 $A\mathbf{u} = \mathbf{b}$。

这个由离散化产生的矩阵 $A$ 具有几个显著的特性：

1.  **大规模性**：如果网格在每个维度上有 $N$ 个内部点，那么未知数的总数 $n=N^2$。对于一个相对粗糙的 $100 \times 100$ 网格，我们就需要求解一个包含 $10,000$ 个未知数的[方程组](@entry_id:193238)。在实际应用中，$N$ 常常更大，导致 $n$ 达到数百万甚至更多。

2.  **[稀疏性](@entry_id:136793)**：每个方程只涉及一个点及其四个近邻。因此，在 $n \times n$ 的矩阵 $A$ 中，每一行只有少数几个（此例中为5个）非零元素。绝大部分元素都为零。

3.  **结构性**：如果对网格点采用字典序（lexicographic ordering）进行编号，矩阵 $A$ 会呈现出一种带状结构（banded structure）。它是一个[对角占优](@entry_id:748380)的[块三对角矩阵](@entry_id:177984) [@problem_id:2433988, 2442121, 2433997]。

4.  **[对称正定](@entry_id:145886)性 (SPD)**：对于泊松方程这类[自伴算子](@entry_id:152188)，离散化后得到的矩阵 $A$ 通常是**对称正定**的。这一性质对于保证[解的存在唯一性](@entry_id:177406)以及许多迭代方法的收敛性至关重要。

### 迭代法的优势

面对这样的[大型稀疏线性系统](@entry_id:137968)，我们有两种主要的求解策略：直接法和[迭代法](@entry_id:194857)。

**直接法**，如高斯消去法或[LU分解](@entry_id:144767)，通过一系列确定的代数运算来求得精确解（在不考虑[舍入误差](@entry_id:162651)的情况下）。然而，对于离散[椭圆问题](@entry_id:146817)产生的[大型稀疏矩阵](@entry_id:144372)，直接法面临严重的挑战。在消去过程中，即使原始矩阵 $A$ 非常稀疏，其L和U因子也可能出现大量的非零元素，这种现象称为**填充（fill-in）**。对于一个二维 $N \times N$ 网格问题，采用自然带状存储的[LU分解](@entry_id:144767)，其内存需求和计算时间的[标度律](@entry_id:139947)（scaling law）会变得令人望而却步 [@problem_id:2433988]。

具体来说，在[字典序](@entry_id:143032)下，矩阵的半带宽 $w$ 约为 $N$。
*   **内存复杂度**：存储L和U因子需要大约 $\mathcal{O}(n \cdot w) = \mathcal{O}(N^2 \cdot N) = \mathcal{O}(N^3)$ 的空间。若以未知数总数 $n=N^2$ 为基准，则内存需求为 $\mathcal{O}(n^{3/2})$。
*   **时间复杂度**：分解过程的计算量约为 $\mathcal{O}(n \cdot w^2) = \mathcal{O}(N^2 \cdot N^2) = \mathcal{O}(N^4)$。以 $n$ 为基准，时间复杂度为 $\mathcal{O}(n^2)$。

当 $N$ 增大时，$\mathcal{O}(n^{3/2})$ 的内存和 $\mathcal{O}(n^2)$ 的计算时间会迅速变得不可行。

相比之下，**迭代法**（或称松弛法）从一个初始猜测解 $\mathbf{u}^{(0)}$ 开始，通过一个简单的迭代过程 $\mathbf{u}^{(k+1)} = G \mathbf{u}^{(k)} + \mathbf{c}$ 来逐步逼近真实解。这类方法的主要优势在于：

*   **内存效率**：许多迭代法（如Jacobi或SOR）可以实现为“无矩阵”形式，即不需要显式存储矩阵 $A$，每次迭代只需根据离散格式（如[五点模板](@entry_id:174268)）直接计算。因此，内存主要用于存储解向量 $\mathbf{u}$ 和右端项 $\mathbf{b}$，其需求为 $\mathcal{O}(n)$。
*   **计算效率**：虽然迭代次数依赖于问题本身和[收敛判据](@entry_id:158093)，但对于许多问题，迭代法的总计算时间优于直接法。例如，对于带有最优参数的连续过松弛法（SOR），总计算时间复杂度约为 $\mathcal{O}(N^3) = \mathcal{O}(n^{3/2})$ [@problem_id:2433988]。

对于大规模问题，$\mathcal{O}(n)$ 的内存和 $\mathcal{O}(n^{3/2})$ 的时间复杂度远优于直接法的 $\mathcal{O}(n^{3/2})$ 和 $\mathcal{O}(n^2)$。这使得[迭代法](@entry_id:194857)成为求解大型离散[椭圆问题](@entry_id:146817)的首选方案。

### 松弛法的原理：[频域](@entry_id:160070)视角

为何[迭代法](@entry_id:194857)被称为“松弛法”？其核心机制是什么？理解这一点的关键在于从[频域](@entry_id:160070)视角分析误差的演化。经典松弛法的一个普遍特性是它们作为**平滑器（smoother）** 的作用 [@problem_id:2188664]。

设 $\mathbf{u}^\star$ 是方程 $A\mathbf{u}^\star = \mathbf{b}$ 的精确解。在第 $k$ 次迭[代时](@entry_id:173412)，误差为 $\mathbf{e}^{(k)} = \mathbf{u}^{(k)} - \mathbf{u}^\star$。对于一个线性[定常迭代法](@entry_id:144014) $\mathbf{u}^{(k+1)} = G \mathbf{u}^{(k)} + \mathbf{c}$，误差的演化遵循 $\mathbf{e}^{(k+1)} = G \mathbf{e}^{(k)}$。因此，[迭代法的收敛性](@entry_id:273433)由[迭代矩阵](@entry_id:637346) $G$ 的谱半径 $\rho(G)$ 决定，即其模最大的[特征值](@entry_id:154894)。

为了更深入地理解，我们可以将误差向量 $\mathbf{e}^{(k)}$ 分解到[迭代矩阵](@entry_id:637346) $G$ 的[特征向量基](@entry_id:163721)上。对于离散泊松问题，这些[特征向量](@entry_id:151813)恰好是网格上的离散正弦函数，对应着不同的空间频率。
*   **高频误差分量**：对应于在相邻网格点间快速[振荡](@entry_id:267781)的[特征向量](@entry_id:151813)。
*   **低频误差分量**：对应于在整个网格上平缓变化的[特征向量](@entry_id:151813)。

经典松弛法（如Jacobi或Gauss-Seidel）的[迭代矩阵](@entry_id:637346) $G$ 的[特征值](@entry_id:154894)具有一个显著特点：对于高频误差模式，其对应的[特征值](@entry_id:154894)的模长远小于1；而对于低频误差模式，其[特征值](@entry_id:154894)的模长非常接近1。

以[Jacobi法](@entry_id:147508)为例，其[迭代矩阵](@entry_id:637346) $G_J = I - D^{-1}A$ 的[特征值](@entry_id:154894) $\mu$ 与原矩阵 $A$ 的[特征值](@entry_id:154894) $\lambda_A$ 的关系为 $\mu = 1 - \lambda_A / d_{ii}$ (其中 $d_{ii}$ 是 $A$ 的对角元素)。对于[离散拉普拉斯算子](@entry_id:634690)，低频模式对应小的 $\lambda_A$，因此 $\mu$ 接近1。[高频模式](@entry_id:750297)对应大的 $\lambda_A$，因此 $\mu$ 的[绝对值](@entry_id:147688)较小。

这意味着：
1.  松弛法能非常有效地**衰减高频误差**。经过几次迭代后，解中的[振荡](@entry_id:267781)或“尖锐”部分会被迅速“磨平”，使得误差变得光滑。
2.  松弛法在**衰减低频误差**方面效率极低。一旦误差变得光滑，其主要由低频分量构成，这些分量在后续迭代中几乎不会减小。

这就是为何在实践中常常观察到，松弛法在最初几次迭代中收敛很快（消除高频误差），但随后[收敛速度](@entry_id:636873)急剧下降的原因。误差看起来很“光滑”，但其幅值却迟迟不降为零。这一特性是松弛法的根本局限，但也正是多重网格法（Multigrid Method）等更高级算法利用的出发点：在细网格上用松弛法平滑误差，然后将光滑的误差限制到粗网格上去求解，因为在粗网格上，原来的低频误差显得相对“高频”，从而可以被再次有效平滑 [@problem_id:2188664]。

### 基本松弛格式

#### Jacobi 法

[Jacobi法](@entry_id:147508)是最简单的松弛格式。其思想是将离散方程中第 $i$ 个未知数 $u_i$ 分离出来，等式右侧所有其他未知数均使用上一次迭代 $k$ 的值。对于五点格式，其更新规则为：
$$
u_{i,j}^{(k+1)} = \frac{1}{4} \left( u_{i-1,j}^{(k)} + u_{i+1,j}^{(k)} + u_{i,j-1}^{(k)} + u_{i,j+1}^{(k)} + h^2 f_{i,j} \right)
$$
在矩阵形式中，若 $A = D - L - U$（$D$为对角部分，$L$为严格下三角部分，$U$为严格上三角部分），则[Jacobi法](@entry_id:147508)的[迭代矩阵](@entry_id:637346)为 $G_J = D^{-1}(L+U)$。该方法的一个优点是所有未知数的更新可以完全并行计算。

#### 加权 Jacobi 法 (Weighted Jacobi Method)

为了加速[Jacobi法](@entry_id:147508)的收敛，可以引入一个权重参数 $\alpha$，构成加权[Jacobi法](@entry_id:147508) [@problem_id:2433991]：
$$
\mathbf{u}^{(k+1)} = (1-\alpha)\mathbf{u}^{(k)} + \alpha \mathbf{u}_{J}^{(k+1)}
$$
其中 $\mathbf{u}_{J}^{(k+1)}$ 是标准的[Jacobi迭代](@entry_id:139235)结果。其[迭代矩阵](@entry_id:637346)为 $G_{\alpha} = (1-\alpha)I + \alpha G_{J}$。$G_{\alpha}$ 的[特征值](@entry_id:154894) $\lambda$ 与 $G_{J}$ 的[特征值](@entry_id:154894) $\mu$ 的关系为 $\lambda = 1-\alpha+\alpha\mu$。通过最小化[谱半径](@entry_id:138984) $\rho(G_{\alpha}) = \max_{\mu} |1-\alpha(1-\mu)|$，可以导出最优的权重 $\alpha^{\star}$。若 $G_J$ 的[特征值](@entry_id:154894)谱为 $[\mu_{\min}, \mu_{\max}]$，则最优权重及其对应的最优[谱半径](@entry_id:138984)为：
$$
\alpha^{\star} = \frac{2}{2 - (\mu_{\min} + \mu_{\max})}, \quad \rho(G_{\alpha^{\star}}) = \frac{\mu_{\max} - \mu_{\min}}{2 - (\mu_{\min} + \mu_{\max})}
$$
对于离散泊松问题，[Jacobi矩阵](@entry_id:178326)的谱是关于[原点对称](@entry_id:172995)的，即 $\mu_{\min} = -\mu_{\max}$，此时 $\alpha^{\star}=1$，表明标准[Jacobi法](@entry_id:147508)已是最优的，无法通过简单的加权改进。然而，对于谱不对称的矩阵，选择合适的 $\alpha$ 可以显著提升[收敛速度](@entry_id:636873)。

#### Gauss-Seidel 法

[Gauss-Seidel法](@entry_id:145727)是对[Jacobi法](@entry_id:147508)的一个简单而有效的改进。在更新第 $i$ 个未知数时，它会立即使用在**同一次迭代**中已经计算出的新值。例如，在按字典序更新时，计算 $u_{i,j}^{(k+1)}$ 会用到 $u_{i-1,j}^{(k+1)}$ 和 $u_{i,j-1}^{(k+1)}$ 的值（如果它们已经被更新）。
$$
u_{i,j}^{(k+1)} = \frac{1}{4} \left( u_{i-1,j}^{(k+1)} + u_{i+1,j}^{(k)} + u_{i,j-1}^{(k+1)} + u_{i,j+1}^{(k)} + h^2 f_{i,j} \right)
$$
其[迭代矩阵](@entry_id:637346)为 $G_{GS} = (D-L)^{-1}U$。对于离散泊松问题这类SPD矩阵，[Gauss-Seidel法](@entry_id:145727)的收敛速度通常是[Jacobi法](@entry_id:147508)的两倍。但其缺点是[更新过程](@entry_id:273573)具有内在的顺序依赖性，不利于并行化。

#### 连续过松弛法 (Successive Over-Relaxation, SOR)

SOR可以看作是[Gauss-Seidel法](@entry_id:145727)的外推加速。它首先计算出Gauss-Seidel的更新量，然后乘以一个松弛因子 $\omega$ 再应用到当前解上。
$$
\mathbf{u}^{(k+1)} = (1-\omega)\mathbf{u}^{(k)} + \omega \mathbf{u}_{GS}^{(k+1)}
$$
其中 $\mathbf{u}_{GS}^{(k+1)}$ 是[Gauss-Seidel迭代](@entry_id:136271)的结果。参数 $\omega$ 的取值范围是 $(0, 2)$。
*   当 $\omega=1$ 时，SOR退化为[Gauss-Seidel法](@entry_id:145727)。
*   当 $0  \omega  1$ 时，称为[欠松弛](@entry_id:756302)（under-relaxation），通常用于改善非对角占优系统的收敛性。
*   当 $1  \omega  2$ 时，称为过松弛（over-relaxation），用于加速收敛。

SOR方法的成功极度依赖于 $\omega$ 的选择。存在一个最优值 $\omega_{opt}$ 可以最大化[收敛速度](@entry_id:636873)。这个最优值的选择与矩阵 $A$ 的谱特性密切相关，特别是与其条件数 $\kappa(A)$ 相关。对于一个[条件数](@entry_id:145150)很大（即病态）的系统，例如在非常精细的网格上离散得到的系统，SOR的[收敛率](@entry_id:146534)对 $\omega$ 的选择会异常敏感。最优的 $\omega$ 值会非常接近2，并且能够提供近乎最优[收敛率](@entry_id:146534)的 $\omega$ 的取值范围会变得非常狭窄。因此，对于[病态问题](@entry_id:137067)，精确地调节 $\omega$ 参数变得至关重要 [@problem_id:2441071]。

### 高级格式与实施策略

#### 未知数的排序与[并行化](@entry_id:753104)

Gauss-Seidel和SOR方法的顺序依赖性是其并行化的主要障碍。通过改变未知数的更新顺序，可以打破这种依赖。**[红黑排序](@entry_id:147172)（Red-Black Ordering）** 就是一种经典的策略 [@problem_id:2442121]。

我们将网格点像棋盘一样染成红色和黑色：如果网格点索引 $(i,j)$ 的和 $i+j$ 是偶数，则为红点；如果是奇数，则为黑点。根据五点格式，一个红点的所有邻居都是黑点，反之亦然。这样，一轮红黑Gauss-Seidel或SOR迭代可以分为两个阶段：
1.  **更新所有红点**：由于红点的更新只依赖于黑点的值，因此所有红点可以完全独立、并行地进行更新。
2.  **更新所有黑点**：在所有红点更新完毕后，黑点的更新只依赖于新的红点值，因此所有黑点也可以并行更新。

这种策略有效地将问题[解耦](@entry_id:637294)，非常适合在[并行计算](@entry_id:139241)机上高效实现。

#### 块松弛法 (Block Relaxation Methods)

点松弛法（如上述方法）一次只更新一个未知数。块松弛法则是一次性更新一组（一个“块”）未知数。一个重要的例子是**逐行[Gauss-Seidel法](@entry_id:145727)（Line-by-line Gauss-Seidel）** [@problem_id:2433997]。

在这种方法中，一次迭代会遍历网格的每一行（例如从下到上）。在处理第 $i$ 行时，我们会同时求解该行上所有内部点的未知数。这相当于求解一个三对角[线性方程组](@entry_id:148943)，其右端项包含了来自相邻行（第 $i-1$ 和 $i+1$ 行）以及左右边界的值。根据Gauss-Seidel的思想，在求解第 $i$ 行时，我们会使用已经更新过的第 $i-1$ 行的新值和尚未更新的第 $i+1$ 行的旧值。

每个[三对角系统](@entry_id:635799)虽然需要一个小型[直接求解器](@entry_id:152789)（如Thomas算法）来求解，但这种方法有几个优点：
*   它隐式地处理了一行内所有未知数的强耦合关系。
*   对于具有各向异性（例如，一个方向的[扩散](@entry_id:141445)系数远大于另一个方向）的问题，如果沿强耦合方向进行块松弛，收敛速度会比点松弛法快得多。

### 实际执行中的考量

在将松弛法付诸实践时，还有两个关键问题需要解决：如何开始迭代，以及何时停止迭代。

#### 初始猜测

迭代过程始于一个初始猜测 $\mathbf{u}^{(0)}$。一个自然且常见的选择是零向量，$\mathbf{u}^{(0)} = \mathbf{0}$。另一个选择可以是随机向量。初始猜测的选择是否会影响收敛所需的迭代次数？[@problem_id:2433995]

答案是：它会影响**总迭代次数**，但不会影响**渐进[收敛率](@entry_id:146534)**。渐进[收敛率](@entry_id:146534)由[迭代矩阵](@entry_id:637346)的谱半径 $\rho(G)$ 唯一确定，与初始猜测无关。然而，收敛到给定容差所需的迭代次数取决于初始残差 $\mathbf{r}^{(0)} = \mathbf{b} - A\mathbf{u}^{(0)}$ 在[迭代矩阵](@entry_id:637346)[特征向量](@entry_id:151813)上的[分布](@entry_id:182848)。

*   如果初始残差主要由**高频（快速衰减）模式**组成，收敛会很快。
*   如果初始残差主要由**低频（缓慢衰减）模式**组成，收敛会很慢。

对于许多物理问题，右端项 $f$（即向量 $\mathbf{b}$）是光滑的，主要包含低频分量。若选择 $\mathbf{u}^{(0)} = \mathbf{0}$，则初始残差 $\mathbf{r}^{(0)} = \mathbf{b}$ 也富含低频分量，这通常对应于收敛较慢的情况。而一个随机的初始猜测 $\mathbf{u}^{(0)}$ 产生的初始残差 $\mathbf{r}^{(0)} = \mathbf{b} - A\mathbf{u}^{(0)}$ 可能包含更丰富的频率成分，其中高频部分会被迅速消除，有时会带来初始阶段的快速收敛。

然而，没有任何一种选择是普适最优的。如果 $\mathbf{b}$ 恰好由快速衰减模式构成，那么零初始猜测将是最佳选择。因此，在没有[先验信息](@entry_id:753750)的情况下，[零向量](@entry_id:156189)是一个简单、确定且可复现的选择。

#### 停止判据

迭代过程必须在一个合适的时机终止。这通过**停止判据（stopping criterion）** 来实现，通常基于残差 $\mathbf{r}^{(k)} = \mathbf{b} - A\mathbf{u}^{(k)}$ 的大小或者解的变化量 $\mathbf{u}^{(k+1)} - \mathbf{u}^{(k)}$ 的大小。

##### 1. 基于[残差范数](@entry_id:754273)的判据

一个可靠的判据是当残差的某个范数小于预设的容差 $\tau$ 时停止。残差直接衡量了当前解 $\mathbf{u}^{(k)}$ 在多大程度上满足原始方程。范数的选择会影响判据的性质 [@problem_id:2433983]。

对于一个 $M$ 维[残差向量](@entry_id:165091) $\mathbf{r}^{(k)}$，常用的范数有：
*   **$L_\infty$ 范数 ([最大范数](@entry_id:268962))**: $\|\mathbf{r}^{(k)}\|_\infty = \max_i |r_i^{(k)}|$。该判据 $\|\mathbf{r}^{(k)}\|_\infty \le \tau_\infty$ 保证了**每一个**离散方程都以不低于 $\tau_\infty$ 的精度得到满足。它控制的是局部最差情况。
*   **$L_2$ 范数 (欧几里得范数)**: $\|\mathbf{r}^{(k)}\|_2 = \sqrt{\sum_i |r_i^{(k)}|^2}$。该判据 $\|\mathbf{r}^{(k)}\|_2 \le \tau_2$ 控制的是残差的[均方根](@entry_id:263605)大小，衡量的是整体误差。
*   **$L_1$ 范数**: $\|\mathbf{r}^{(k)}\|_1 = \sum_i |r_i^{(k)}|$。该判据 $\|\mathbf{r}^{(k)}\|_1 \le \tau_1$ 控制的是残差[绝对值](@entry_id:147688)的总和。

这些范数之间存在不等关系：$\|\mathbf{r}\|_\infty \le \|\mathbf{r}\|_2 \le \|\mathbf{r}\|_1$。这意味着，如果使用相同的数值容差 $\tau$，则 $L_1$ 判据最严格（最难满足），$L_\infty$ 判据最宽松（最容易满足）。因此，$L_\infty$ 判据通常会导致最少的迭代次数 [@problem_id:2433983]。

此外，为了使容差的意义不随网格疏密而改变，应使用**网格无关的容差**。例如，要控制每个分量的平均残差大小，容差应按如下方式缩放：$\tau_\infty \propto 1$，$\tau_2 \propto \sqrt{M}$，$\tau_1 \propto M$ [@problem_id:2433983]。

##### 2. 解的变化量 vs. 残差

另一个常见的判据是基于两次连续迭代解的变化量，例如 $\max_i |u_i^{(k+1)} - u_i^{(k)}| \le \delta$。这个判据直观地表示解已经“稳定”。然而，它可能具有误导性 [@problem_id:2433941]。

解的变化量和残差是相关的。例如，对于加权[Jacobi法](@entry_id:147508)，我们有 $\mathbf{u}^{(k+1)} - \mathbf{u}^{(k)} = \omega D^{-1} \mathbf{r}^{(k)}$。因此，判据 $\max_i |u_i^{(k+1)} - u_i^{(k)}|$ 实际上是在控制 $\omega (D^{-1} \mathbf{r}^{(k)})$ 的[最大范数](@entry_id:268962)。

考虑一个例子：对于[五点模板](@entry_id:174268)的泊松问题，[对角矩阵](@entry_id:637782) $D=4I$，使用加权[Jacobi法](@entry_id:147508)并取 $\omega=2/3$，容差 $\delta=10^{-6}$。解变化量判据变为 $\|\frac{2/3}{4}\mathbf{r}^{(k)}\|_\infty \le 10^{-6}$，即 $\|\mathbf{r}^{(k)}\|_\infty \le 6 \times 10^{-6}$。如果另一个研究者使用残差判据 $\|\mathbf{r}^{(k)}\|_2 \le \epsilon$ 并取 $\epsilon=10^{-6}$，由于 $\|\mathbf{r}^{(k)}\|_\infty \le \|\mathbf{r}^{(k)}\|_2$，满足残差判据必然满足解变化量判据。但在一个 $64 \times 64$ 的网格上（$n=4096$），满足解变化量判据时，残差的 $L_2$ 范数可能高达 $\sqrt{n}\|\mathbf{r}^{(k)}\|_\infty \approx 64 \times (6 \times 10^{-6}) = 3.84 \times 10^{-4}$，远未达到 $10^{-6}$ 的残差要求。

在这个例子中，解变化量判据远比残差判据宽松，会导致过[早停](@entry_id:633908)止迭代，得到的解精度不足。虽然情况可能反过来，但这个例子说明了两种判据可能导致截然不同的结果。通常，基于残差的判据被认为是更可靠的，因为它直接度量了[线性方程组](@entry_id:148943)被满足的程度。