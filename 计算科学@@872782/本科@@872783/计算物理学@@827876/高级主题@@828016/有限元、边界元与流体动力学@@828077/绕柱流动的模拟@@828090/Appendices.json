{"hands_on_practices": [{"introduction": "在开始任何复杂的计算流体动力学（CFD）模拟之前，建立对我们数值方法准确性的信心至关重要。本练习 [@problem_id:2438894] 旨在通过一个理想化的势流模型来教授验证与确认（V extrapolation），您将学习如何量化离散误差并验证您代码的收敛阶数，这是任何严谨的计算科学家都必须掌握的基本技能。", "problem": "您需要为一个绕圆柱体的无粘、不可压缩流动的仿真设计一个收敛性测试和理查森外推研究。该仿真使用一个势流代理，以一种可控、可验证的方式分离空间和时间离散化误差。\n\n基本原理：\n- 对于无粘、不可压缩、无旋的流动，速度是标量势 $\\phi$ 的梯度，满足拉普拉斯方程 $\\nabla^2 \\phi = 0$。非定常伯努利方程指出，压力场满足 $p = -\\rho\\left(\\frac{\\partial \\phi}{\\partial t} + \\frac{1}{2}\\lvert \\nabla \\phi \\rvert^2\\right) + C(t)$，其中 $\\rho$ 是密度，$C(t)$ 是一个随时间变化的常数。\n- 对于速度为 $U(t)$ 的均匀势流绕过一个以原点为中心、半径为 $a$ 的圆柱体，其精确解给出的表面势为 $\\phi(a,\\theta,t) = 2 a U(t) \\cos\\theta$，表面切向速度为 $v_t(a,\\theta,t) = -2 U(t) \\sin\\theta$，其中 $\\theta$ 是从正 $x$ 轴测量的极角。\n- 一个均匀加速的远场流需要一个背景压力梯度来加速流体，其主导项为 $p_\\infty(x,t) = p_{\\mathrm{ref}} - \\rho\\left(x\\,\\frac{dU}{dt} + \\frac{1}{2} U(t)^2\\right)$，从而满足未受扰动的欧拉方程 $\\rho \\frac{dU}{dt} = -\\frac{\\partial p_\\infty}{\\partial x}$。由圆柱体存在引起的流体动力是通过在表面上仅对扰动压力 $p' = p - p_\\infty$ 与向外法线进行积分得到的。\n- 对于此势流问题，在时间 $t$ 时 $x$ 方向上的精确扰动力为 $F_x^{\\mathrm{true}}(t) = \\rho \\pi a^2 \\frac{dU}{dt}$。\n\n仿真模型和数值近似：\n- 通过一个正 M 边形来离散化圆形圆柱体的边界，其顶点位于极角 $\\theta_j = \\frac{2\\pi j}{M}$（对于 $j = 0,1,\\dots,M-1$），映射到点 $(x_j,y_j) = \\left(a\\cos\\theta_j, a\\sin\\theta_j\\right)$。连续顶点之间的每条直线段都是一个面元。对于面元 $j$，定义其中心点 $\\mathbf{c}_j$、弦长 $L_j$、沿弦的单位切向量 $\\hat{\\mathbf{t}}_j$，以及作为指向外部的弦法线的向外单位法向量 $\\hat{\\mathbf{n}}_j$（您可以通过检查与 $\\mathbf{c}_j$ 的点积来确定向外方向）。\n- 使用中点角度 $\\theta_j^{\\mathrm{mid}} = \\arctan2(c_{j,y}, c_{j,x})$ 来评估几何中点处的解析表面量。通过在所有面元上使用复合中点法则来近似表面积分，每个面元的权重为 $L_j$。\n- 在每个面元中点和时间 $t$，通过一个 $\\mathcal{O}(\\Delta t)$ 阶的后向有限差分来近似非定常势的时间导数：\n$$\\left.\\frac{\\partial \\phi}{\\partial t}\\right|_{j,t} \\approx \\frac{\\phi(a,\\theta_j^{\\mathrm{mid}},t) - \\phi(a,\\theta_j^{\\mathrm{mid}},t-\\Delta t)}{\\Delta t},$$\n其中 $\\phi(a,\\theta,t) = 2 a U(t)\\cos\\theta$。使用 $v_t(a,\\theta,t) = -2 U(t)\\sin\\theta$ 来评估表面上的 $\\lvert \\nabla \\phi \\rvert^2$ 为 $v_t^2$。\n- 面元中点处的未受扰动背景压力为\n$$p_\\infty(\\mathbf{c}_j,t) \\approx -\\rho\\left( x_j^{\\mathrm{mid}} \\frac{U(t) - U(t-\\Delta t)}{\\Delta t} + \\frac{1}{2}U(t)^2 \\right),$$\n其中 $x_j^{\\mathrm{mid}}$ 是 $\\mathbf{c}_j$ 的 $x$ 坐标。总压力近似为\n$$p_j(t) \\approx -\\rho\\left( \\frac{\\phi(a,\\theta_j^{\\mathrm{mid}},t) - \\phi(a,\\theta_j^{\\mathrm{mid}},t-\\Delta t)}{\\Delta t} + \\frac{1}{2} v_t(a,\\theta_j^{\\mathrm{mid}},t)^2 \\right),$$\n扰动压力为 $p'_j(t) = p_j(t) - p_\\infty(\\mathbf{c}_j,t)$。则近似力为\n$$F_x^{\\mathrm{num}}(M,\\Delta t; t) \\approx -\\sum_{j=0}^{M-1} p'_j(t)\\, \\hat{n}_{j,x}\\, L_j.$$\n\n收敛性研究与理查森外推：\n- 对于一系列具有加密比 $r$ 的三个离散化（即，对于一个适当的分辨率度量 $h$，$h_1/h_2 = h_2/h_3 = r$），如果主导截断误差的行为像 $C h^p$，则观测阶 $p$ 可以通过广义理查森公式估算\n$$p \\approx \\frac{\\ln\\left|\\frac{Q_{h_1} - Q_{h_2}}{Q_{h_2} - Q_{h_3}}\\right|}{\\ln r},$$\n其中 $Q_{h_k}$ 是在分辨率 $h_k$ 下的数值近似值。向 $h \\to 0$ 的外推估计为\n$$Q_{\\mathrm{ext}} \\approx Q_{h_3} + \\frac{Q_{h_3} - Q_{h_2}}{r^p - 1}.$$\n\n物理参数和单位：\n- 使用 $\\rho = 1\\,\\mathrm{kg/m^3}$，$a = 0.5\\,\\mathrm{m}$，以及随时间变化的自由来流速度 $U(t) = U_0 + U_1 \\sin(\\omega t)$，其中 $U_0 = 1\\,\\mathrm{m/s}$，$U_1 = 0.2\\,\\mathrm{m/s}$，$\\omega = 2\\pi\\,\\mathrm{rad/s}$。在 $t^\\star = 0.30\\,\\mathrm{s}$ 时评估所有力。力以 $\\mathrm{N}$ 表示。\n- 在 $t^\\star$ 时的精确扰动力为 $F_x^{\\mathrm{true}}(t^\\star) = \\rho \\pi a^2 \\frac{dU}{dt}\\big\\rvert_{t^\\star}$，其中 $\\frac{dU}{dt} = U_1 \\omega \\cos(\\omega t)$。\n\n任务：\n- 实现上述离散化，以计算给定 $M$ 和 $\\Delta t$ 下的 $F_x^{\\mathrm{num}}(M,\\Delta t; t^\\star)$。\n- 对于以下三个收敛性研究中的每一个，使用理查森估计器计算三网格观测阶 $p$。所有三组均使用比率 $r = 2$。\n  1. 空间加密，时间离散化误差有效固定：$\\Delta t = 10^{-6}\\,\\mathrm{s}$ 且 $M \\in \\{24,48,96\\}$。\n  2. 时间加密，空间误差有效可忽略：$M = 4096$ 且 $\\Delta t \\in \\{5\\times 10^{-3}\\,\\mathrm{s}, 2.5\\times 10^{-3}\\,\\mathrm{s}, 1.25\\times 10^{-3}\\,\\mathrm{s}\\}$。\n  3. 耦合加密，设计使空间和时间主导误差具有相同的阶数：选择 $M \\in \\{32,64,128\\}$ 且 $\\Delta t = c/M^2$，其中 $c = 2.0\\times 10^{-2}\\,\\mathrm{sm^2}$（即，当 $M$ 无单位时，$\\Delta t$ 的单位为 $\\mathrm{s}$）。对这三个层级使用这些配对的 $(M,\\Delta t)$ 值。\n\n要求：\n- 您的程序必须实现上述内容，并为每个研究使用理查森估计器从 $t^\\star$ 时的三个 $F_x^{\\mathrm{num}}$ 值计算观测阶 $p$。\n- 全程使用国际单位制，并将最终结果表示为无量纲的观测阶。\n- 测试套件：上面指定的三个研究构成了测试套件。它们涵盖了一个标准的空间情况、一个时间情况以及一个误差贡献阶数匹配的耦合加密情况。\n- 最终输出格式：您的程序应生成一行输出，其中包含三个观测阶，形式为用方括号括起来的逗号分隔列表，四舍五入到三位小数，顺序为 [spatial_p, temporal_p, coupled_p]。例如，一个有效的输出格式是“[2.000,1.000,2.000]”。", "solution": "该问题已提交进行分析。它涉及对一个非定常势流中圆柱体上流体动力的数值近似进行收敛性研究。在尝试任何求解之前，必须根据科学和逻辑的基本原则对问题陈述进行严格验证。\n\n**第 1 步：提取已知条件**\n\n以下已知条件逐字从问题陈述中提取：\n- **控制方程**：速度势 $\\phi$ 满足拉普拉斯方程 $\\nabla^2 \\phi = 0$。非定常伯努利方程：$p = -\\rho\\left(\\frac{\\partial \\phi}{\\partial t} + \\frac{1}{2}\\lvert \\nabla \\phi \\rvert^2\\right) + C(t)$。\n- **精确解析解**：对于半径为 $a$ 的圆柱体在均匀流 $U(t)$ 中，表面势为 $\\phi(a,\\theta,t) = 2 a U(t) \\cos\\theta$，表面切向速度为 $v_t(a,\\theta,t) = -2 U(t) \\sin\\theta$。\n- **背景场和扰动场**：背景压力为 $p_\\infty(x,t) = p_{\\mathrm{ref}} - \\rho\\left(x\\,\\frac{dU}{dt} + \\frac{1}{2} U(t)^2\\right)$。扰动压力为 $p' = p - p_\\infty$。精确扰动力为 $F_x^{\\mathrm{true}}(t) = \\rho \\pi a^2 \\frac{dU}{dt}$。\n- **数值离散化**：\n    - 圆柱体边界是一个正 M 边形，其顶点为 $(x_j,y_j) = \\left(a\\cos\\theta_j, a\\sin\\theta_j\\right)$，其中 $\\theta_j = 2\\pi j/M$，$j = 0, \\dots, M-1$。\n    - 面元 $j$ 的属性：中点 $\\mathbf{c}_j$，长度 $L_j$，向外法线 $\\hat{\\mathbf{n}}_j$。\n    - 使用中点角度 $\\theta_j^{\\mathrm{mid}} = \\arctan2(c_{j,y}, c_{j,x})$ 评估表面量。\n    - 通过权重为 $L_j$ 的复合中点法则进行积分。\n- **数值近似**：\n    - 时间导数：后向有限差分，$\\left.\\frac{\\partial \\phi}{\\partial t}\\right|_{j,t} \\approx \\frac{\\phi(a,\\theta_j^{\\mathrm{mid}},t) - \\phi(a,\\theta_j^{\\mathrm{mid}},t-\\Delta t)}{\\Delta t}$，其中 $\\phi(a,\\theta,t) = 2 a U(t)\\cos\\theta$。\n    - 表面动能：$\\lvert \\nabla \\phi \\rvert^2 = v_t^2$，其中 $v_t(a,\\theta,t) = -2 U(t)\\sin\\theta$。\n    - 背景压力：$p_\\infty(\\mathbf{c}_j,t) \\approx -\\rho\\left( x_j^{\\mathrm{mid}} \\frac{U(t) - U(t-\\Delta t)}{\\Delta t} + \\frac{1}{2}U(t)^2 \\right)$。\n    - 总压力：$p_j(t) \\approx -\\rho\\left( \\frac{\\phi(a,\\theta_j^{\\mathrm{mid}},t) - \\phi(a,\\theta_j^{\\mathrm{mid}},t-\\Delta t)}{\\Delta t} + \\frac{1}{2} v_t(a,\\theta_j^{\\mathrm{mid}},t)^2 \\right)$。\n    - 扰动压力：$p'_j(t) = p_j(t) - p_\\infty(\\mathbf{c}_j,t)$。\n    - 数值力：$F_x^{\\mathrm{num}}(M,\\Delta t; t) \\approx -\\sum_{j=0}^{M-1} p'_j(t)\\, \\hat{n}_{j,x}\\, L_j$。\n- **收敛性分析**：\n    - 加密比 $r$。\n    - 观测阶：$p \\approx \\frac{\\ln\\left|\\frac{Q_{h_1} - Q_{h_2}}{Q_{h_2} - Q_{h_3}}\\right|}{\\ln r}$。\n- **物理参数**：$\\rho = 1\\,\\mathrm{kg/m^3}$，$a = 0.5\\,\\mathrm{m}$，$U(t) = U_0 + U_1 \\sin(\\omega t)$，其中 $U_0 = 1\\,\\mathrm{m/s}$，$U_1 = 0.2\\,\\mathrm{m/s}$，$\\omega = 2\\pi\\,\\mathrm{rad/s}$。评估时间 $t^\\star = 0.30\\,\\mathrm{s}$。\n- **任务**：对三个加密比为 $r=2$ 的收敛性研究计算观测阶 $p$：\n    1. 空间：$\\Delta t = 10^{-6}\\,\\mathrm{s}$，$M \\in \\{24, 48, 96\\}$。\n    2. 时间：$M = 4096$，$\\Delta t \\in \\{5\\times 10^{-3}, 2.5\\times 10^{-3}, 1.25\\times 10^{-3}\\}\\,\\mathrm{s}$。\n    3. 耦合：$M \\in \\{32, 64, 128\\}$，其中 $\\Delta t = c/M^2$ 且 $c = 2.0\\times 10^{-2}\\,\\mathrm{s}$。\n\n**第 2 步：问题陈述的验证**\n\n对问题的合理性进行评估。\n- **科学依据**：该问题基于势流的经典理论，这是流体动力学中用于无粘、不可压缩和无旋条件的有效基本模型。势、压力和力的方程都是规范的。数值近似方法（面元法几何、有限差分、中点法则）是计算物理学中的标准技术。该问题在科学上是合理的。\n- **适定性与一致性**：问题提供了一套完整的方程、参数和数值程序。目标明确定义：为三个不同的加密研究计算收敛的观测阶。定义是明确的；例如，确定向外法向量的方法已指定。常数 $c$ 的单位中一个微小的歧义立即得到了澄清。该问题是自洽、一致且适定的。\n- **客观性**：问题以精确、客观和技术的语言陈述。它不含主观断言或观点。\n\n**第 3 步：结论与行动**\n\n问题陈述是**有效的**。它代表了一个将数值分析应用于物理系统的、格式良好的练习。现在将根据问题中概述的第一性原理来开发解决方案。\n\n---\n\n**求解过程开发**\n\n该解决方案需要实现一个函数来计算数值力 $F_x^{\\mathrm{num}}(M, \\Delta t; t^\\star)$，以及一个辅助函数来使用理查森方法计算收敛的观测阶。\n\n**1. 几何离散化**\n圆柱体表面被离散化为 $M$ 个直面元。对于一个内接于半径为 $a$ 的圆的正 M 边形：\n- 顶点为 $\\mathbf{v}_j = (a \\cos(2\\pi j / M), a \\sin(2\\pi j / M))$，其中 $j = 0, \\dots, M-1$。\n- 第 $j$ 个面元连接 $\\mathbf{v}_j$ 和 $\\mathbf{v}_{j+1}$（索引 $(j+1)$ 对 $M$ 取模）。\n- 面元中点为 $\\mathbf{c}_j = (\\mathbf{v}_j + \\mathbf{v}_{j+1}) / 2$。其坐标为：\n  $$x_j^{\\mathrm{mid}} = a \\cos(\\pi/M)\\cos(2\\pi j/M + \\pi/M)$$\n  $$y_j^{\\mathrm{mid}} = a \\cos(\\pi/M)\\sin(2\\pi j/M + \\pi/M)$$\n- 中点向量的角度为 $\\theta_j^{\\mathrm{mid}} = \\arctan2(y_j^{\\mathrm{mid}}, x_j^{\\mathrm{mid}}) = (2\\pi j + \\pi)/M$。\n- 每个面元的长度是恒定的：$L_j = L = \\lvert \\mathbf{v}_{j+1} - \\mathbf{v}_j \\rvert = 2a \\sin(\\pi/M)$。\n- 面元的向外单位法向量 $\\hat{\\mathbf{n}}_j$ 垂直于面元的弦。对于此几何形状，它与穿过该面元所对弧段中点的圆的半径对齐。因此，$\\hat{\\mathbf{n}}_j = (\\cos\\theta_j^{\\mathrm{mid}}, \\sin\\theta_j^{\\mathrm{mid}})$，其 x 分量为 $\\hat{n}_{j,x} = \\cos\\theta_j^{\\mathrm{mid}}$。\n\n**2. 压力与力的计算**\n数值力是所有面元上的总和：$F_x^{\\mathrm{num}} = -\\sum_{j=0}^{M-1} p'_j(t^\\star)\\, \\hat{n}_{j,x}\\, L$。\n扰动压力 $p'_j(t^\\star)$ 是配置点处的总压力与该处背景压力之差：$p'_j = p_j - p_{\\infty,j}$。\n\n设 $t = t^\\star$ 且 $t_p = t - \\Delta t$。自由来流速度时间导数的数值近似为 $\\frac{\\Delta U}{\\Delta t} = \\frac{U(t) - U(t_p)}{\\Delta t}$。压力的表达式为：\n- 总压力：$p_j(t) = -\\rho\\left( \\frac{\\phi(t) - \\phi(t_p)}{\\Delta t} + \\frac{1}{2} v_t(t)^2 \\right)$。使用 $\\phi(a,\\theta,t) = 2aU(t)\\cos\\theta$：\n   $$p_j(t) = -\\rho\\left( 2a\\cos\\theta_j^{\\mathrm{mid}} \\frac{\\Delta U}{\\Delta t} + \\frac{1}{2} \\left(-2U(t)\\sin\\theta_j^{\\mathrm{mid}}\\right)^2 \\right)$$\n- 背景压力：$p_{\\infty,j}(t) = -\\rho\\left( x_j^{\\mathrm{mid}} \\frac{\\Delta U}{\\Delta t} + \\frac{1}{2}U(t)^2 \\right)$。\n\n将这些结合起来得到面元 $j$ 上的扰动压力：\n$$p'_j(t) = p_j(t) - p_{\\infty,j}(t) = \\rho\\left[ \\left(x_j^{\\mathrm{mid}} - 2a\\cos\\theta_j^{\\mathrm{mid}}\\right)\\frac{\\Delta U}{\\Delta t} + \\frac{1}{2}U(t)^2 - 2U(t)^2\\sin^2\\theta_j^{\\mathrm{mid}} \\right]$$\n\n然后通过对每个面元的贡献求和来计算总力：\n$$F_x^{\\mathrm{num}}(M,\\Delta t; t) = -L \\sum_{j=0}^{M-1} p'_j(t) \\cos(\\theta_j^{\\mathrm{mid}})$$\n\n**3. 收敛性分析**\n理论误差来源是空间离散化，其主导误差项为 $\\mathcal{O}(M^{-2})$，和时间离散化，其主导误差项为 $\\mathcal{O}(\\Delta t)$。\n- **研究 1 (空间)**：当 $\\Delta t = 10^{-6}\\,\\mathrm{s}$ 时，时间误差可以忽略不计。收敛应由空间误差主导，因此我们预期 $p \\approx 2$。加密参数为 $h \\sim 1/M$。\n- **研究 2 (时间)**：当 $M = 4096$ 时，空间误差可以忽略不计。收敛应由后向差分的时间误差主导，因此我们预期 $p \\approx 1$。加密参数为 $h \\sim \\Delta t$。\n- **研究 3 (耦合)**：当 $\\Delta t = c/M^2$ 时，总误差为 $E \\approx C_s M^{-2} + C_t \\Delta t = C_s M^{-2} + C_t c M^{-2} = (C_s+C_t c)M^{-2}$。误差与 $M^{-2}$ 成比例，因此我们预期 $p \\approx 2$。\n\n收敛的观测阶 $p$ 是根据分辨率为 $h_1, h_2, h_3$（满足 $h_1/h_2 = h_2/h_3 = r$）的三个数值结果 $Q_1, Q_2, Q_3$ 计算得出的。公式为：\n$$p = \\frac{\\ln\\left|\\frac{Q_1 - Q_2}{Q_2 - Q_3}\\right|}{\\ln r}$$\n对于所有研究，加密比均为 $r=2$。量 $Q_k$ 是每个离散化水平下计算出的力 $F_x^{\\mathrm{num}}$。\n\n实现将遵循此逻辑。一个主函数将计算给定 $(M, \\Delta t)$ 下的力。该函数将在三个研究的每个离散化水平上被调用。然后，得到的力值将用于计算收敛的观测阶。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to run the convergence studies and print the results.\n    \"\"\"\n    # Physical parameters\n    rho = 1.0  # kg/m^3\n    a = 0.5   # m\n    U0 = 1.0  # m/s\n    U1 = 0.2  # m/s\n    omega = 2.0 * np.pi  # rad/s\n    t_star = 0.30  # s\n\n    # Freestream velocity function\n    def U(t):\n        return U0 + U1 * np.sin(omega * t)\n\n    def compute_force(M, dt):\n        \"\"\"\n        Computes the numerical force F_x^num for given M and dt at t_star.\n        \"\"\"\n        t = t_star\n        t_prev = t - dt\n\n        U_t = U(t)\n        U_t_prev = U(t_prev)\n        dUdt_num = (U_t - U_t_prev) / dt\n\n        # --- Geometric Discretization (Vectorized) ---\n        j = np.arange(M)\n        \n        # Midpoint angles of the panels\n        theta_mid = (2 * np.pi * j + np.pi) / M\n        \n        # Panel length (constant for all panels)\n        L = 2 * a * np.sin(np.pi / M)\n        \n        # x-component of panel midpoint coordinates\n        x_mid = a * np.cos(np.pi / M) * np.cos(theta_mid)\n        \n        # x-component of outward unit normal vectors\n        n_x = np.cos(theta_mid)\n\n        # --- Pressure and Force Calculation (Vectorized) ---\n        \n        # Disturbance pressure term from acceleration potential\n        # (x_j^mid - 2*a*cos(theta_j^mid)) * (dU/dt)\n        term1 = (x_mid - 2 * a * np.cos(theta_mid)) * dUdt_num\n        \n        # Disturbance pressure term from velocity squared\n        # 1/2*U(t)^2 - 2*U(t)^2*sin^2(theta_j^mid)\n        term2 = 0.5 * U_t**2 - 2 * U_t**2 * np.sin(theta_mid)**2\n        \n        # Disturbance pressure on each panel\n        p_prime = rho * (term1 + term2)\n        \n        # Numerical force by summing contributions (composite midpoint rule)\n        # F_x = - sum( p'_j * n_{j,x} * L_j )\n        force = -np.sum(p_prime * n_x) * L\n        \n        return force\n\n    def richardson_p(Q1, Q2, Q3, r):\n        \"\"\"\n        Calculates the observed order of convergence p.\n        Q1, Q2, Q3 are results from coarse, medium, fine resolutions.\n        \"\"\"\n        # To avoid division by zero or log of non-positive if convergence is perfect\n        # or non-monotonic.\n        diff_ratio_arg = (Q1 - Q2) / (Q2 - Q3)\n        if diff_ratio_arg = 0:\n            return np.nan # Indicates non-standard convergence\n            \n        return np.log(diff_ratio_arg) / np.log(r)\n\n    results = []\n    \n    # --- Study 1: Spatial Refinement ---\n    dt_spatial = 1e-6\n    M_spatial = [24, 48, 96]\n    r_spatial = 2.0\n    \n    forces_spatial = [compute_force(M, dt_spatial) for M in M_spatial]\n    p_spatial = richardson_p(forces_spatial[0], forces_spatial[1], forces_spatial[2], r_spatial)\n    results.append(p_spatial)\n\n    # --- Study 2: Temporal Refinement ---\n    M_temporal = 4096\n    dt_temporal = [5.0e-3, 2.5e-3, 1.25e-3]\n    r_temporal = 2.0\n\n    forces_temporal = [compute_force(M_temporal, dt) for dt in dt_temporal]\n    p_temporal = richardson_p(forces_temporal[0], forces_temporal[1], forces_temporal[2], r_temporal)\n    results.append(p_temporal)\n\n    # --- Study 3: Coupled Refinement ---\n    c_coupled = 2.0e-2\n    M_coupled = [32, 64, 128]\n    dt_coupled = [c_coupled / (M**2) for M in M_coupled]\n    r_coupled = 2.0\n\n    forces_coupled = [compute_force(M, dt) for M, dt in zip(M_coupled, dt_coupled)]\n    p_coupled = richardson_p(forces_coupled[0], forces_coupled[1], forces_coupled[2], r_coupled)\n    results.append(p_coupled)\n\n    # Format the final output string\n    formatted_results = [f\"{res:.3f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\n\nsolve()\n```", "id": "2438894"}, {"introduction": "在掌握了数值准确性的基础后，我们可以应用物理模型来预测有趣的真实世界现象。本练习 [@problem_id:2438930] 深入探讨了圆柱绕流的核心物理——涡旋脱落，并将其与风鸣琴（Aeolian harp）发声的迷人现象联系起来。您将使用一个基于雷诺数（$Re$）和斯特劳哈尔数（$St$）的经验模型，来预测不同直径圆柱产生的音调，并探索这些音调如何组合成音乐中的和弦。", "problem": "一个密度为 $\\rho$、动力粘度为 $\\mu$ 的二维不可压缩牛顿流体，以均匀的自由来流速度 $U_{\\infty}$ 流过一组刚性圆柱体。这些圆柱体的直径为 $D$，其轴线垂直于流向。控制方程为不可压缩的纳维-斯托克斯方程，\n$$\n\\rho\\left(\\frac{\\partial \\mathbf{u}}{\\partial t} + \\mathbf{u}\\cdot\\nabla \\mathbf{u}\\right) = -\\nabla p + \\mu \\nabla^2 \\mathbf{u}, \n\\quad \\nabla\\cdot \\mathbf{u} = 0,\n$$\n其中 $\\mathbf{u}$ 是速度场，$p$ 是压力场。对于绕圆柱体的横流，当雷诺数超过由下式定义的临界值时，\n$$\nRe = \\frac{\\rho U_{\\infty} D}{\\mu},\n$$\n会发生自持的周期性涡脱落，其基频 $f$ 与无量纲斯特劳哈尔数 $St$ 的关系如下：\n$$\nSt = \\frac{f D}{U_{\\infty}}.\n$$\n假设涡脱落行为和斯特劳哈尔数作为雷诺数的函数，其分段定义如下：\n- 如果 $Re \\le 47$，则不发生持续的周期性脱落，基频定义为 $f = 0$。\n- 如果 $47  Re  2 \\times 10^5$，使用以下关联式：\n$$\nSt(Re) = 0.198\\left(1 - \\frac{19.7}{Re}\\right),\n$$\n并约定 $St \\ge 0$。\n- 如果 $Re \\ge 2 \\times 10^5$，则取 $St = 0.2$。\n\n对于同一自由来流中的一组 $N$ 个直径为 $\\{D_i\\}_{i=1}^{N}$ 的平行圆柱体，通过将上述模型独立应用于每个圆柱体，定义其预测的音调集 $\\{f_i\\}_{i=1}^{N}$。设 $f_{\\min}$ 为 $\\{f_i\\}$ 中严格为正的最小元素。在十二平均律中，半音偏移定义为：\n$$\ns_i = 12 \\log_2\\left(\\frac{f_i}{f_{\\min}}\\right),\n$$\n对于每个严格为正的 $f_i$，并设最近的整数半音偏移为 $n_i = \\mathrm{round}(s_i)$。对于每个严格为正的 $f_i$，其绝对失谐度（以音分为单位）定义为：\n$$\n\\Delta_i = 100\\,\\left|s_i - n_i\\right|.\n$$\n当一组恰好有 $3$ 个严格为正的频率时，如果其整数偏移的多重集 $\\{n_i\\}$ 等于 $\\{0,4,7\\}$，并且所有绝对失谐度都满足 $\\Delta_i \\le \\Delta_{\\max}$，则称其构成一个大三和弦；如果多重集等于 $\\{0,3,7\\}$，并且所有 $\\Delta_i \\le \\Delta_{\\max}$，则称其构成一个小三和弦。此处的容差固定为 $\\Delta_{\\max} = 25$ 音分。根据定义，如果严格为正的频率少于 $3$ 个，则两个条件均不满足。\n\n实现一个程序，对每个给定的测试用例，计算预测的频率 $\\{f_i\\}$，将它们按升序排序，根据上述定义判断它们是否构成大三和弦和/或小三和弦，并报告相对于其最近的整数半音偏移，在所有严格为正的频率中取到的最大绝对失谐度 $\\max_i \\Delta_i$。每个频率以 s⁻¹（赫兹）为单位表示，并四舍五入到三位小数。最大绝对失谐度以音分为单位表示，并四舍五入到一位小数。如果严格为正的频率少于 $3$ 个，则将两个三和弦布尔值都报告为 false，并将最大绝对失谐度报告为 $0.0$。\n\n使用以下物理参数（除非另有明确说明，否则在所有测试中保持不变）：\n- 空气密度 $\\rho = 1.225$ kg/m³，\n- 空气动力粘度 $\\mu = 1.81 \\times 10^{-5}$ Pa·s。\n\n测试套件（每个测试用例提供自由来流速度 $U_{\\infty}$（单位 m/s）和圆柱体直径（单位 $\\mathrm{m}$））：\n- 案例 $1$（理想路径，设计接近大三和弦）：$U_{\\infty} = 8.0$，直径 $\\{D_i\\} = [0.002354,\\, 0.003564,\\, 0.002818]$。\n- 案例 $2$（理想路径，设计接近小三和弦）：$U_{\\infty} = 8.0$，直径 $\\{D_i\\} = [0.003564,\\, 0.002991,\\, 0.002354]$。\n- 案例 $3$（亚临界，无脱落）：$U_{\\infty} = 0.5$，直径 $\\{D_i\\} = [5.0 \\times 10^{-5},\\, 6.0 \\times 10^{-5},\\, 5.5 \\times 10^{-5}]$。\n- 案例 $4$（超临界 $Re$ 分支）：$U_{\\infty} = 20.0$，直径 $\\{D_i\\} = [0.40,\\, 0.35,\\, 0.45]$。\n- 案例 $5$（接近临界值混合）：$U_{\\infty} = 2.0$，直径 $\\{D_i\\} = [3.0 \\times 10^{-4},\\, 3.5 \\times 10^{-4},\\, 4.0 \\times 10^{-4}]$。\n\n最终输出格式：你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。每个测试用例的结果本身必须是以下形式的列表：\n$$\n[\\;f_1,\\, f_2,\\, f_3,\\, \\mathrm{is\\_major},\\, \\mathrm{is\\_minor},\\, \\Delta_{\\max}\\;],\n$$\n其中 $f_1 \\le f_2 \\le f_3$ 是以 s⁻¹ 为单位的排序后的预测频率（四舍五入到三位小数），$\\mathrm{is\\_major}$ 和 $\\mathrm{is\\_minor}$ 是布尔值，$\\Delta_{\\max}$ 是以音分为单位的最大绝对失谐度（四舍五入到一位小数）。单行输出必须按顺序汇总所有测试用例，格式如下：\n$$\n[\\,[\\cdots],\\,[\\cdots],\\,[\\cdots],\\,[\\cdots],\\,[\\cdots]\\,].\n$$", "solution": "用户寻求一个计算模型的实现，该模型用于预测一组圆柱体在均匀横流中的涡脱落频率，并随后确定这些频率是否构成大三和弦或小三和弦。该问题定义明确，并以流体动力学和声学原理为科学基础。解决方案是通过系统地实现所提供的物理-经验模型和数学定义来开发的。\n\n过程始于流动的基本参数：流体密度 $\\rho$、动力粘度 $\\mu$ 和自由来流速度 $U_{\\infty}$。对于每个直径为 $D_i$ 的圆柱体，我们首先通过计算无量纲雷诺数 $Re_i$ 来确定流态的性质：\n$$\nRe_i = \\frac{\\rho U_{\\infty} D_i}{\\mu}\n$$\n雷诺数代表惯性力与粘性力之比，并主导不同流动行为之间的过渡。该问题提供了一个基于 $Re_i$ 的涡脱落现象的分段模型。\n\n从圆柱体表面脱落的涡流以频率 $f_i$ 周期性地发生。该频率由另一个无量纲量——斯特劳哈尔数 $St_i$ 来表征，其定义为：\n$$\nSt_i = \\frac{f_i D_i}{U_{\\infty}}\n$$\n问题给出了 $St_i$ 作为 $Re_i$ 函数的经验关联式，我们将其应用于每个圆柱体：\n1.  当 $Re_i \\le 47$ 时，流动是稳定和定常的（在时间平均的意义上），不发生周期性涡脱落。因此，脱落频率定义为 $f_i = 0$。\n2.  当 $47  Re_i  2 \\times 10^5$ 时，流动处于亚临界区，其特征是规则、周期性的卡门涡街。斯特劳哈尔数由以下经验公式给出：\n    $$\n    St_i(Re_i) = 0.198\\left(1 - \\frac{19.7}{Re_i}\\right)\n    $$\n3.  当 $Re_i \\ge 2 \\times 10^5$ 时，流动进入超临界区，此时尾流更加混乱，但仍可识别出一个主导的脱落频率。该模型通过假设一个恒定的斯特劳哈尔数 $St_i = 0.2$ 来简化此情况。\n\n对于每个圆柱体 $i$，一旦根据其对应的 $Re_i$ 确定了斯特劳哈尔数 $St_i$，就可以通过重新排列 $St_i$ 的定义来计算物理脱落频率 $f_i$：\n$$\nf_i = \\frac{St_i U_{\\infty}}{D_i}\n$$\n此过程产生一组预测的音调频率 $\\{f_i\\}$。\n\n问题的第二部分涉及到一个与音乐理论的创造性类比。对计算出的频率集进行谐波关系分析。这需要将频率比转换为音程。我们只考虑严格为正的频率 $\\{f_i | f_i > 0\\}$。如果存在的此类频率少于三个，则分析终止，并且根据定义，该频率集被认为是不和谐的。\n\n如果有三个或更多个正频率，我们首先确定最低的正频率 $f_{\\min}$。该频率作为我们潜在和弦的基音或根音。任何其他正频率 $f_i$ 与 $f_{\\min}$ 之间的音程，使用以下公式以半音为单位进行量化：\n$$\ns_i = 12 \\log_2\\left(\\frac{f_i}{f_{\\min}}\\right)\n$$\n该公式源于十二平均律体系，其中一个八度（频率比为 $2$）被分成 $12$ 个对数上相等的步长（半音）。\n\n为了将这些可能非整数的半音值映射到音阶上，我们找到最近的整数半音，$n_i = \\mathrm{round}(s_i)$。音准的质量通过绝对失谐度 $\\Delta_i$ 来衡量，单位为音分（其中 $1$ 音分是 $1/100$ 半音）：\n$$\n\\Delta_i = 100 \\left|s_i - n_i\\right|\n$$\n当一组恰好有三个正频率时，如果它们的整数半音偏移多重集 $\\{n_i\\}$ 与目标模式匹配，并且它们的失谐度在给定容差 $\\Delta_{\\max} = 25$ 音分之内，则判断其构成一个特定的三和弦。具体来说：\n-   **大三和弦** 对应于整数半音多重集 $\\{0, 4, 7\\}$。与 $f_{\\min}$ 对应的频率将始终产生 $0$ 的偏移。\n-   **小三和弦** 对应于整数半音多重集 $\\{0, 3, 7\\}$。\n\n因此，对于每个测试用例，算法按以下步骤进行：\n1.  对每个圆柱体直径 $D_i$，计算 $Re_i$。\n2.  根据 $Re_i$，使用分段模型确定 $St_i$。\n3.  计算频率 $f_i = St_i U_{\\infty} / D_i$。\n4.  收集所有频率并按升序排序。\n5.  分离出严格为正的频率。\n6.  如果正频率的数量不等于三，则将该集合归类为既不是大三和弦也不是小三和弦，并将最大失谐度设置为 $0.0$。\n7.  如果恰好有三个正频率，则计算它们相对于最低正频率 $f_{\\min}$ 的半音偏移 $s_i$、最近的整数偏移 $n_i$ 和失谐度 $\\Delta_i$。\n8.  检查整数偏移的多重集 $\\{n_i\\}$ 是否与 $\\{0, 4, 7\\}$（大三和弦）或 $\\{0, 3, 7\\}$（小三和弦）匹配。\n9.  验证最大失谐度 $\\max_i \\Delta_i$ 不超过 $25$ 音分的容差。\n10. 报告排序后的频率、大/小三和弦识别的布尔结果以及最大失谐度，数值结果按规定进行四舍五入。\n\n这种结构化的、基于原理的方法确保了解决方案的正确性和稳健性，并忠实地实现了所提供的规范。", "answer": "```python\nimport numpy as np\nimport math\n\n# Per the problem statement, Scipy is allowed but not strictly necessary for this implementation.\n\ndef solve():\n    \"\"\"\n    Main solver function that processes all test cases and prints the final output.\n    \"\"\"\n    # Physical constants (constant across all tests)\n    rho = 1.225  # Air density in kg/m^3\n    mu = 1.81e-5  # Air dynamic viscosity in Pa.s\n    delta_max_tolerance = 25.0 # Max detuning tolerance in cents\n\n    # Test suite from the problem statement\n    test_cases = [\n        # Case 1: happy path, designed near a major triad\n        {'U_inf': 8.0, 'diameters': [0.002354, 0.003564, 0.002818]},\n        # Case 2: happy path, designed near a minor triad\n        {'U_inf': 8.0, 'diameters': [0.003564, 0.002991, 0.002354]},\n        # Case 3: sub-threshold, no shedding\n        {'U_inf': 0.5, 'diameters': [5.0e-5, 6.0e-5, 5.5e-5]},\n        # Case 4: supercritical Re branch\n        {'U_inf': 20.0, 'diameters': [0.40, 0.35, 0.45]},\n        # Case 5: near threshold mix\n        {'U_inf': 2.0, 'diameters': [3.0e-4, 3.5e-4, 4.0e-4]},\n    ]\n\n    all_results = []\n    for case in test_cases:\n        U_inf = case['U_inf']\n        diameters = case['diameters']\n        \n        frequencies = []\n        rho_mu_ratio = rho / mu\n\n        for D in diameters:\n            # Calculate Reynolds number\n            Re = rho_mu_ratio * U_inf * D\n            \n            # Calculate Strouhal number based on the piecewise model\n            St = 0.0\n            if Re > 47.0:\n                if Re  2e5:\n                    St = 0.198 * (1 - 19.7 / Re)\n                else: # Re >= 2e5\n                    St = 0.2\n            \n            # Calculate frequency\n            # If D is zero, this would cause a division error, but problem context implies D > 0.\n            # If St is zero, f will be zero.\n            f = St * U_inf / D if D != 0 else 0.0\n            frequencies.append(f)\n        \n        # Sort frequencies in ascending order\n        frequencies.sort()\n        \n        # Isolate strictly positive frequencies for musical analysis\n        positive_f = [f for f in frequencies if f > 0]\n        \n        is_major = False\n        is_minor = False\n        max_detuning = 0.0\n        \n        # Triad analysis is only performed for exactly 3 positive frequencies\n        if len(positive_f) == 3:\n            f_min = positive_f[0] # Frequencies are already sorted\n            \n            semitones = []\n            detunings = []\n            integer_offsets = []\n\n            for f_i in positive_f:\n                # Calculate semitone offset\n                s_i = 12.0 * np.log2(f_i / f_min)\n                semitones.append(s_i)\n                \n                # Calculate nearest integer offset\n                n_i = round(s_i)\n                integer_offsets.append(n_i)\n                \n                # Calculate absolute detuning in cents\n                delta_i = 100.0 * abs(s_i - n_i)\n                detunings.append(delta_i)\n\n            max_detuning = max(detunings)\n\n            # Check if all detunings are within tolerance\n            if max_detuning = delta_max_tolerance:\n                # Check for major/minor triad. Use set for order-agnostic comparison.\n                # The sorting of integer_offsets is necessary to match the definition {0, k, 7}\n                sorted_n_offsets = sorted(integer_offsets)\n                major_triad_offsets = [0, 4, 7]\n                minor_triad_offsets = [0, 3, 7]\n\n                if sorted_n_offsets == major_triad_offsets:\n                    is_major = True\n                if sorted_n_offsets == minor_triad_offsets:\n                    is_minor = True\n        \n        # Format results for output\n        rounded_frequencies = [round(f, 3) for f in frequencies]\n        rounded_max_detuning = round(max_detuning, 1)\n\n        result_for_case = [\n            *rounded_frequencies,\n            is_major,\n            is_minor,\n            rounded_max_detuning\n        ]\n        all_results.append(result_for_case)\n\n    # Print the final aggregated results in the specified single-line format.\n    # The str() representation of a list includes spaces, which matches the problem's format hint.\n    print(f\"[{','.join(map(str, all_results))}]\")\n\nsolve()\n```", "id": "2438930"}, {"introduction": "从单个圆柱的涡旋脱落，我们进一步探索更复杂的系统：多个物体之间的流体动力学相互作用。本练习 [@problem_id:2438941] 引入了一个强大的概念——降阶模型，您将使用耦合的 Stuart-Landau 振子来模拟两个并排圆柱尾流之间的相互作用。您的任务是实现这个模型，并找出一个能够产生稳定反相涡街（“二元涡街”）的特定几何构型，从而体验如何用简化的数学模型来研究和预测复杂的物理锁定现象。", "problem": "要求您为均匀自由来流中绕流并排双圆柱的非定常、不可压缩流动构建并分析一个最小化的、自洽的降阶模型，以便通过算法确定是否存在一种能产生“二元涡街”（反相涡脱落）的构型。物理背景为：在速度为 $U$ 的均匀自由来流中，放置两个直径分别为 $D_1$ 和 $D_2$ 的无限长圆柱，其中心由横向中心距 $T$ 分隔。圆柱的轴线相互平行，自由来流垂直于连接它们中心的直线。请使用以下原理和建模假设，推导出一个可计算的准则，并对间距进行数值搜索。\n\n基本原理和建模：\n- 从不可压缩 Navier–Stokes 方程出发，并基于以下观察：当雷诺数 (Re) 超过一个阈值时，单个圆柱的尾流会经历超临界 Hopf 分岔，形成一个饱和的周期性极限环。用一个 Stuart–Landau 振子来表示每个尾流的主导复振幅，然后对两个振子进行弱耦合、弱非线性的相位约化。这将得到一个关于相位差 $\\theta(t) \\equiv \\phi_2(t) - \\phi_1(t)$ 的单一常微分方程 (ODE)，其形式为\n$$\n\\frac{d\\theta}{dt} \\;=\\; \\Delta \\omega \\;-\\; 2\\,K(T/D_{\\mathrm{ref}}, \\overline{\\mathrm{Re}})\\,\\sin\\theta,\n$$\n其中 $\\Delta \\omega \\equiv \\omega_2 - \\omega_1$ 是脱落自然角频率之差，$K$ 是一个量纲为角频率的流体动力学耦合系数，$D_{\\mathrm{ref}}$ 是一个参考直径，$\\overline{\\mathrm{Re}}$ 是这对圆柱的代表性雷诺数。在这个约化方程中，稳定不动点满足\n$$\n\\sin\\theta^\\star \\;=\\; \\frac{\\Delta \\omega}{2\\,K},\n$$\n条件是锁相条件\n$$\n\\left|\\Delta \\omega\\right| \\;\\le\\; 2\\,\\left|K\\right|\n$$\n成立。当 $K  0$ 且上述不等式得到满足时，在 $\\theta^\\star = \\pi$ 附近存在一个稳定平衡点。我们将二元涡街定义为反相锁定状态 $\\theta^\\star \\approx \\pi$。\n\n- 使用标准的无量纲 Strouhal 数 $\\mathrm{St} \\equiv f D / U$ 以及以下经验支持的关联式：\n$$\n\\mathrm{St}(\\mathrm{Re}) \\;=\\; \\max\\!\\left(0,\\; 0.212 \\;-\\; \\frac{4.5}{\\mathrm{Re}}\\right)\n$$\n适用于 $\\mathrm{Re} \\ge 50$ 的情况，而当 $\\mathrm{Re}  50$ 时无周期性脱落。对于圆柱 $j \\in \\{1,2\\}$，其角频率为：\n$$\n\\omega_j \\;=\\; 2\\pi\\,\\mathrm{St}(\\mathrm{Re}_j)\\,\\frac{U}{D_j},\n$$\n其中 $\\mathrm{Re}_j \\equiv \\dfrac{U D_j}{\\nu}$，$\\nu$ 为运动粘度。\n\n- 使用以下形式的唯象流体动力学耦合模型：\n$$\nK\\!\\left(\\frac{T}{D_{\\mathrm{ref}}}, \\overline{\\mathrm{Re}}\\right) \\;=\\; \\kappa\\,\\overline{\\omega}\\,\\exp\\!\\Big(-\\alpha\\big(\\tfrac{T}{D_{\\mathrm{ref}}}-1\\big)\\Big)\\,\\Bigg(\\frac{\\tfrac{T}{D_{\\mathrm{ref}}}}{T_c(\\overline{\\mathrm{Re}})} - 1\\Bigg),\n$$\n其中 $\\overline{\\omega} \\equiv (\\omega_1 + \\omega_2)/2$， $D_{\\mathrm{ref}} \\equiv (D_1 + D_2)/2$， $\\overline{\\mathrm{Re}} \\equiv (\\mathrm{Re}_1 + \\mathrm{Re}_2)/2$，以及\n$$\nT_c(\\overline{\\mathrm{Re}}) \\;=\\; 1.2 \\;+\\; 0.3\\,\\tanh\\!\\left(\\frac{\\overline{\\mathrm{Re}} - 100}{300}\\right).\n$$\n该模型包含了耦合强度随间距增大而呈指数衰减，以及在临界间距 $T_c$ 处发生符号变化的特性。选择无量纲常数 $\\kappa = 0.2$ 和 $\\alpha = 1.5$。角度以弧度为单位。\n\n二元涡街检测规则：\n- 对于给定的 $(U,\\nu,D_1,D_2)$ 和一个试验间距比 $\\tau \\equiv T/D_{\\mathrm{ref}}$，当且仅当以下所有条件都成立时，才存在二元涡街：\n    1. $\\mathrm{Re}_1 \\ge 50$ 且 $\\mathrm{Re}_2 \\ge 50$，\n    2. $K(\\tau,\\overline{\\mathrm{Re}})  0$，\n    3. $\\left|\\Delta \\omega\\right| \\le 2\\,\\left|K(\\tau,\\overline{\\mathrm{Re}})\\right|$。\n- 如果满足以上条件，则反相平衡点存在且稳定，其平衡相位差 $\\theta^\\star$ 位于反相分支上。\n\n计算任务：\n- 实现一个程序，对每个测试用例，在间距比\n$$\n\\tau \\in [1.05,\\,3.00]\n$$\n的均匀网格上以\n$$\n\\Delta \\tau \\;=\\; 0.01,\n$$\n的增量进行搜索，并返回根据上述规则产生二元涡街的最小 $\\tau$ 值。如果在搜索范围内不存在这样的 $\\tau$，则返回哨兵值 $-1.000$。\n\n- 使用以下测试套件。所有物理量必须以国际单位制 (SI) 解释：速度 $U$ 单位为 m/s，直径 $D_1, D_2$ 单位为 m，运动粘度 $\\nu$ 单位为 m$^2$/s。角度以弧度为单位。\n    1. 案例 A (基准相同圆柱): $U = 1.0$ m/s, $\\nu = 1.5\\times 10^{-5}$ m$^2$/s, $D_1 = 0.010$ m, $D_2 = 0.010$ m。\n    2. 案例 B (直径不匹配): $U = 1.0$ m/s, $\\nu = 1.5\\times 10^{-5}$ m$^2$/s, $D_1 = 0.010$ m, $D_2 = 0.013$ m。\n    3. 案例 C (速度降低，相同圆柱): $U = 0.5$ m/s, $\\nu = 1.5\\times 10^{-5}$ m$^2$/s, $D_1 = 0.010$ m, $D_2 = 0.010$ m。\n    4. 案例 D (低于脱落阈值): $U = 0.05$ m/s, $\\nu = 1.5\\times 10^{-5}$ m$^2$/s, $D_1 = 0.004$ m, $D_2 = 0.004$ m。\n\n要求的最终输出格式：\n- 您的程序应产生单行输出，其中包含四个测试用例的结果，格式为方括号内的逗号分隔列表，每个数字四舍五入到三位小数，例如：\n$$\n[\\tau_A,\\tau_B,\\tau_C,\\tau_D],\n$$\n其中每个 $\\tau$ 要么是该案例中产生二元涡街的最小间距比 $\\tau$（四舍五入到三位小数），要么是在搜索区间内未找到时的哨兵值 $-1.000$。间距比是无量纲的，因此没有单位。", "solution": "问题陈述已经过分析并被认为是有效的。这是一个独立的、有科学依据的计算物理建模练习，问题是适定且客观的。任务是基于所提供的绕流双圆柱的降阶模型，实现一个数值搜索，以找到支持反相涡脱落状态的最小间距。以下内容描述了所需计算算法的系统推导过程。\n\n问题的核心在于满足“二元涡街”存在的三个特定条件，这对应于耦合振子模型中的一个稳定的、反相锁定状态。对于给定的物理参数集合 $(U, \\nu, D_1, D_2)$，我们的目标是在区间 $[1.05, 3.00]$ 内找到满足这些条件的最小无量纲间距比 $\\tau \\equiv T/D_{\\mathrm{ref}}$。\n\n针对单个测试用例的算法流程如下：\n\n**第1步：初始参数计算和预计算**\n\n首先，我们计算不依赖于间距比 $\\tau$ 的物理参数。给定自由来流速度 $U$、运动粘度 $\\nu$ 以及圆柱直径 $D_1$ 和 $D_2$：\n\n每个圆柱 $j \\in \\{1,2\\}$ 的雷诺数计算如下：\n$$\n\\mathrm{Re}_j = \\frac{U D_j}{\\nu}\n$$\n二元涡街存在的第一个条件是两个圆柱都必须处于周期性脱落状态。该条件由以下准则给出：\n$$\n\\mathrm{Re}_1 \\ge 50 \\quad \\text{和} \\quad \\mathrm{Re}_2 \\ge 50\n$$\n如果不满足此条件，则至少有一个圆柱不会发生稳定的涡脱落，这使得耦合分析变得没有意义。在这种情况下，搜索将终止，并返回哨兵值 $-1.000$。\n\n**第2步：自然频率计算**\n\n如果雷诺数满足条件，我们继续计算自然脱落频率。每个圆柱的 Strouhal 数 $\\mathrm{St}$ 使用提供的经验关联式确定：\n$$\n\\mathrm{St}(\\mathrm{Re}_j) = \\max\\left(0, 0.212 - \\frac{4.5}{\\mathrm{Re}_j}\\right)\n$$\n那么每个圆柱的自然脱落角频率 $\\omega_j$ 为：\n$$\n\\omega_j = 2\\pi \\cdot \\mathrm{St}(\\mathrm{Re}_j) \\cdot \\frac{U}{D_j}\n$$\n由此，我们计算自然频率之差 $\\Delta\\omega$，这是锁相条件的一个关键参数：\n$$\n\\Delta\\omega = \\omega_2 - \\omega_1\n$$\n\n**第3步：模型参考参数计算**\n\n耦合振子模型使用了几个参考量和平均量，接下来进行计算：\n- 参考直径: $D_{\\mathrm{ref}} = (D_1 + D_2) / 2$\n- 平均雷诺数: $\\overline{\\mathrm{Re}} = (\\mathrm{Re}_1 + \\mathrm{Re}_2) / 2$\n- 平均角频率: $\\overline{\\omega} = (\\omega_1 + \\omega_2) / 2$\n\n流体动力学耦合系数 $K$ 的模型依赖于一个临界间距比 $T_c$，而 $T_c$ 本身是平均雷诺数的函数：\n$$\nT_c(\\overline{\\mathrm{Re}}) = 1.2 + 0.3 \\cdot \\tanh\\left(\\frac{\\overline{\\mathrm{Re}} - 100}{300}\\right)\n$$\n这些量对每个测试用例只计算一次，因为它们不依赖于搜索变量 $\\tau$。\n\n**第4步：在间距比网格上进行数值搜索**\n\n任务的核心是在一个离散的间距比 $\\tau$ 网格上进行数值搜索。搜索域被指定为 $\\tau \\in [1.05, 3.00]$，增量为 $\\Delta\\tau = 0.01$。这定义了一个点网格 $\\tau_i = 1.05 + i \\cdot 0.01$，其中 $i=0, 1, \\dots, 195$。我们按升序遍历这些 $\\tau$ 值。对于每个 $\\tau$，我们检查二元涡街存在的其余两个条件。\n\n**第5步：评估每个试验间距的条件**\n\n对于每个试验值 $\\tau$，我们必须评估耦合系数 $K$ 并检查最后两个条件。耦合系数由下式给出：\n$$\nK(\\tau, \\overline{\\mathrm{Re}}) = \\kappa \\cdot \\overline{\\omega} \\cdot \\exp\\left(-\\alpha(\\tau-1)\\right) \\cdot \\left(\\frac{\\tau}{T_c(\\overline{\\mathrm{Re}})} - 1\\right)\n$$\n其中模型常数给定为 $\\kappa = 0.2$ 和 $\\alpha = 1.5$。\n\n计算出 $K$ 后，我们检查第二个和第三个条件：\n1.  **条件2（负耦合）：** 反相状态要求负耦合。\n    $$\n    K(\\tau, \\overline{\\mathrm{Re}})  0\n    $$\n2.  **条件3（锁相）：** 频率差必须足够小，以便被耦合强度所克服。\n    $$\n    |\\Delta\\omega| \\le 2 |K(\\tau, \\overline{\\mathrm{Re}})|\n    $$\n\n如果对于给定的 $\\tau$，除了初始的雷诺数检查外，这两个条件也都满足，那么我们就找到了一个能产生二元涡街的间距。因为搜索是从网格中最小的 $\\tau$ 值开始的，所以第一个满足所有条件的 $\\tau$ 值就是问题陈述所要求的最小值。算法随后返回此值并终止当前测试用例的搜索。\n\n如果遍历整个 $\\tau$ 值网格后，没有找到任何满足所有三个条件的值，则意味着在指定的搜索范围内不存在这样的构型。在这种情况下，算法返回哨兵值 $-1.000$。\n\n这个完整、分步的过程提供了一个确定性算法，用于为每个测试用例找到所需的间距比，该算法将在最终程序中实现。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the binary vortex street problem for a suite of test cases.\n    \"\"\"\n\n    test_cases = [\n        # Case A: U, nu, D1, D2\n        (1.0, 1.5e-5, 0.010, 0.010),\n        # Case B\n        (1.0, 1.5e-5, 0.010, 0.013),\n        # Case C\n        (0.5, 1.5e-5, 0.010, 0.010),\n        # Case D\n        (0.05, 1.5e-5, 0.004, 0.004)\n    ]\n\n    results = []\n    for case in test_cases:\n        result = find_minimal_spacing(*case)\n        results.append(f\"{result:.3f}\")\n\n    print(f\"[{','.join(results)}]\")\n\ndef find_minimal_spacing(U, nu, D1, D2):\n    \"\"\"\n    For a given set of physical parameters, finds the smallest spacing ratio tau\n    that produces a binary vortex street.\n    \n    Args:\n        U (float): Free-stream speed in m/s.\n        nu (float): Kinematic viscosity in m^2/s.\n        D1 (float): Diameter of cylinder 1 in m.\n        D2 (float): Diameter of cylinder 2 in m.\n\n    Returns:\n        float: The smallest spacing ratio tau, or -1.0 if none is found.\n    \"\"\"\n    # Model constants\n    KAPPA = 0.2\n    ALPHA = 1.5\n\n    # --- Step 1: Initial Parameter Calculation ---\n    Re1 = U * D1 / nu\n    Re2 = U * D2 / nu\n\n    # Check shedding condition (Condition 1)\n    if Re1  50 or Re2  50:\n        return -1.0\n\n    # --- Step 2: Calculation of Natural Frequencies ---\n    def strouhal(Re):\n        return max(0.0, 0.212 - 4.5 / Re)\n\n    St1 = strouhal(Re1)\n    St2 = strouhal(Re2)\n    \n    # Handle the case where diameter could be zero, though not in test cases\n    omega1 = 2 * np.pi * St1 * U / D1 if D1 > 0 else 0\n    omega2 = 2 * np.pi * St2 * U / D2 if D2 > 0 else 0\n    \n    delta_omega = omega2 - omega1\n\n    # --- Step 3: Calculation of Model Reference Parameters ---\n    D_ref = (D1 + D2) / 2.0\n    Re_bar = (Re1 + Re2) / 2.0\n    omega_bar = (omega1 + omega2) / 2.0\n\n    def critical_spacing_ratio(Re_bar_val):\n        return 1.2 + 0.3 * np.tanh((Re_bar_val - 100.0) / 300.0)\n\n    Tc = critical_spacing_ratio(Re_bar)\n\n    # --- Step 4: Numerical Search over the Spacing Ratio Grid ---\n    # Search grid for tau from 1.05 to 3.00 with step 0.01\n    num_points = round((3.00 - 1.05) / 0.01) + 1\n    tau_grid = np.linspace(1.05, 3.00, num_points)\n\n    for tau in tau_grid:\n        # --- Step 5: Evaluation of Conditions for each Trial Spacing ---\n        \n        # Calculate coupling coefficient K\n        K = (KAPPA * omega_bar * np.exp(-ALPHA * (tau - 1.0)) * \n             ((tau / Tc) - 1.0))\n\n        # Check Condition 2 (Negative Coupling)\n        if K >= 0:\n            continue\n\n        # Check Condition 3 (Phase-Locking)\n        if np.abs(delta_omega) = 2 * np.abs(K):\n            # All conditions met, this is the minimal tau\n            return tau\n\n    # If loop completes, no suitable tau was found\n    return -1.0\n\nsolve()\n\n```", "id": "2438941"}]}