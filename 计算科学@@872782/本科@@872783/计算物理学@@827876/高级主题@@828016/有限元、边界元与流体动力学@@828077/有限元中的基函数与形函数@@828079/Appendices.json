{"hands_on_practices": [{"introduction": "在有限元方法中，最核心的思想之一是将复杂问题分解为在简单子域（单元）上的简单问题。这个练习将带你回到最开始的地方：为一维线性单元构建近似解。通过推导线性形函数，你将亲手实践如何利用节点值来插值单元内部的物理场，这是理解整个有限元框架的基石。[@problem_id:2172650]", "problem": "在有限元法 (FEM) 中，一个连续的域被离散成更小、更简单的子域，称为有限元。考虑一个一维物理问题，例如沿细均匀杆的热传递。该杆被建模为一条线段，并被划分为若干个线性有限元。\n\n我们关注连接两个节点（节点 $i$ 和节点 $i+1$）的单个通用线性单元。这些节点分别位于空间坐标 $x_i$ 和 $x_{i+1}$ 处。这些节点上未知场变量（例如，温度）的值由 $u_i$ 和 $u_{i+1}$ 表示。\n\n在该单元内，对于满足 $x_i \\leq x \\leq x_{i+1}$ 的任意坐标 $x$，场变量由线性插值函数 $u_h(x)$ 来近似。该函数被构造为基函数（也称为形函数）和节点值的线性组合。\n\n确定该单元内近似解 $u_h(x)$ 的表达式。您的最终答案应使用变量 $x$、节点坐标 $x_i$ 和 $x_{i+1}$ 以及节点值 $u_i$ 和 $u_{i+1}$ 来表示。", "solution": "我们考虑在区间 $[x_{i},x_{i+1}]$ 上的单个线性有限元，其在 $x_{i}$ 处的节点值为 $u_{i}$，在 $x_{i+1}$ 处的节点值为 $u_{i+1}$。在针对线性元的标准伽辽金有限元近似中，单元内的场表示为节点值和相应线性形函数的线性组合：\n$$\nu_{h}(x)=N_{i}(x)\\,u_{i}+N_{i+1}(x)\\,u_{i+1}.\n$$\n对于一个双节点线性元，其形函数是区间 $[x_{i},x_{i+1}]$ 上的一阶拉格朗日多项式，由插值（克罗内克-德尔塔）条件唯一确定：\n$$\nN_{i}(x_{i})=1,\\quad N_{i}(x_{i+1})=0,\\quad N_{i+1}(x_{i})=0,\\quad N_{i+1}(x_{i+1})=1.\n$$\n满足这些条件的线性多项式是\n$$\nN_{i}(x)=\\frac{x_{i+1}-x}{x_{i+1}-x_{i}},\\qquad N_{i+1}(x)=\\frac{x-x_{i}}{x_{i+1}-x_{i}}.\n$$\n将这些代入近似式，得到单元内的显式插值公式：\n$$\nu_{h}(x)=\\frac{x_{i+1}-x}{x_{i+1}-x_{i}}\\,u_{i}+\\frac{x-x_{i}}{x_{i+1}-x_{i}}\\,u_{i+1},\n$$\n这满足了所要求的 $u_{h}(x_{i})=u_{i}$ 和 $u_{h}(x_{i+1})=u_{i+1}$。", "answer": "$$\\boxed{\\frac{x_{i+1}-x}{x_{i+1}-x_{i}}\\,u_{i}+\\frac{x-x_{i}}{x_{i+1}-x_{i}}\\,u_{i+1}}$$", "id": "2172650"}, {"introduction": "从一维到二维，从线性到高次，单元的几何形状变得更加复杂，其有效性也愈发关键。这个练习通过一个思想实验——故意移动一个二次三角形单元的节点——来探索“坏”单元的数学后果。通过计算等参映射的雅可比行列式，你将揭示几何畸变如何导致非物理性的单元“翻转”，并理解为何保证单元质量对有限元分析至关重要。[@problem_id:2375611]", "problem": "考虑在有限元法 (FEM) 中使用的等参二次三角形单元。设参考（母）三角形在自然坐标 $(\\xi,\\eta)$ 中定义为 $\\xi \\ge 0$, $\\eta \\ge 0$, 且 $\\xi + \\eta \\le 1$。设相关的面积（重心）坐标为 $L_{1} = 1 - \\xi - \\eta$, $L_{2} = \\xi$, 且 $L_{3} = \\eta$。物理单元的顶点节点位于 $(x_{1},y_{1}) = (0,0)$, $(x_{2},y_{2}) = (1,0)$, 和 $(x_{3},y_{3}) = (0,1)$。边中节点为边 $1$–$2$ 上的 $(x_{4},y_{4}) = \\left(\\frac{1}{2},0\\right)$，边 $3$–$1$ 上的 $(x_{6},y_{6}) = \\left(0,\\frac{1}{2}\\right)$，而节点 $5$（名义上位于边 $2$–$3$ 上）被有意移动到 $(x_{5},y_{5}) = \\left(0,\\frac{1}{5}\\right)$。使用由 6 节点二次三角形的面积坐标构建的标准二次形函数，建立等参映射 $(x(\\xi,\\eta),y(\\xi,\\eta)) = \\sum_{i=1}^{6} N_{i}(\\xi,\\eta) (x_{i},y_{i})$，计算在形心 $(\\xi,\\eta) = \\left(\\frac{1}{3},\\frac{1}{3}\\right)$ 处的雅可比矩阵 $\\partial(x,y)/\\partial(\\xi,\\eta)$，并求出该点处的行列式 $J$。报告 $J$ 的精确值（不要四舍五入）。然后，用一句话陈述在此单元构型下 $J$ 的符号的物理意义。你的最终数值答案应为 $J$ 的值。", "solution": "该问题要求计算一个 6 节点二次三角形单元在特定点上的等参映射的雅可比行列式。物理坐标 $(x,y)$ 通过以下关系从参考坐标 $(\\xi,\\eta)$ 映射而来：\n$$\nx(\\xi,\\eta) = \\sum_{i=1}^{6} N_{i}(\\xi,\\eta) x_{i}\n$$\n$$\ny(\\xi,\\eta) = \\sum_{i=1}^{6} N_{i}(\\xi,\\eta) y_{i}\n$$\n其中 $(x_i, y_i)$ 是物理域中的节点坐标，而 $N_i$ 是在参考域中定义的二次形函数。\n\n一个 6 节点二次三角形的形函数用面积坐标 $L_1$, $L_2$, 和 $L_3$ 表示。对于顶点节点 ($i=1,2,3$)，形函数为：\n$$\nN_1 = L_1(2L_1 - 1)\n$$\n$$\nN_2 = L_2(2L_2 - 1)\n$$\n$$\nN_3 = L_3(2L_3 - 1)\n$$\n对于分别位于边 $1$-$2$, $2$-$3$, 和 $3$-$1$ 上的边中节点 ($i=4,5,6$)，形函数为：\n$$\nN_4 = 4L_1L_2\n$$\n$$\nN_5 = 4L_2L_3\n$$\n$$\nN_6 = 4L_3L_1\n$$\n面积坐标与自然坐标 $(\\xi, \\eta)$ 的关系如下：\n$L_1 = 1 - \\xi - \\eta$, $L_2 = \\xi$, and $L_3 = \\eta$.\n将这些代入形函数的表达式，得到：\n$N_1 = (1 - \\xi - \\eta)(1 - 2\\xi - 2\\eta)$\n$N_2 = \\xi(2\\xi - 1)$\n$N_3 = \\eta(2\\eta - 1)$\n$N_4 = 4\\xi(1 - \\xi - \\eta)$\n$N_5 = 4\\xi\\eta$\n$N_6 = 4\\eta(1 - \\xi - \\eta)$\n\n物理域中给定的节点坐标是：\n$(x_{1},y_{1}) = (0,0)$\n$(x_{2},y_{2}) = (1,0)$\n$(x_{3},y_{3}) = (0,1)$\n$(x_{4},y_{4}) = (\\frac{1}{2},0)$\n$(x_{5},y_{5}) = (0,\\frac{1}{5})$\n$(x_{6},y_{6}) = (0,\\frac{1}{2})$\n\n我们通过将形函数与相应的 $x$ 坐标的乘积求和，来构建 $x(\\xi,\\eta)$ 的映射：\n$$\nx(\\xi,\\eta) = N_1(0) + N_2(1) + N_3(0) + N_4\\left(\\frac{1}{2}\\right) + N_5(0) + N_6(0)\n$$\n$$\nx(\\xi,\\eta) = N_2 + \\frac{1}{2}N_4 = \\xi(2\\xi - 1) + \\frac{1}{2} \\cdot 4\\xi(1 - \\xi - \\eta) = 2\\xi^2 - \\xi + 2\\xi(1 - \\xi - \\eta)\n$$\n$$\nx(\\xi,\\eta) = 2\\xi^2 - \\xi + 2\\xi - 2\\xi^2 - 2\\xi\\eta = \\xi - 2\\xi\\eta\n$$\n类似地，对于 $y(\\xi,\\eta)$：\n$$\ny(\\xi,\\eta) = N_1(0) + N_2(0) + N_3(1) + N_4(0) + N_5\\left(\\frac{1}{5}\\right) + N_6\\left(\\frac{1}{2}\\right)\n$$\n$$\ny(\\xi,\\eta) = N_3 + \\frac{1}{5}N_5 + \\frac{1}{2}N_6 = \\eta(2\\eta - 1) + \\frac{1}{5}(4\\xi\\eta) + \\frac{1}{2}(4\\eta(1 - \\xi - \\eta))\n$$\n$$\ny(\\xi,\\eta) = 2\\eta^2 - \\eta + \\frac{4}{5}\\xi\\eta + 2\\eta(1 - \\xi - \\eta) = 2\\eta^2 - \\eta + \\frac{4}{5}\\xi\\eta + 2\\eta - 2\\xi\\eta - 2\\eta^2\n$$\n$$\ny(\\xi,\\eta) = \\eta + \\left(\\frac{4}{5} - 2\\right)\\xi\\eta = \\eta - \\frac{6}{5}\\xi\\eta\n$$\n因此，等参映射为：\n$x(\\xi,\\eta) = \\xi(1 - 2\\eta)$\n$y(\\xi,\\eta) = \\eta\\left(1 - \\frac{6}{5}\\xi\\right)$\n\n变换的雅可比矩阵 $\\mathbf{J}$ 定义为：\n$$\n\\mathbf{J} = \\frac{\\partial(x,y)}{\\partial(\\xi,\\eta)} = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix}\n$$\n我们计算偏导数：\n$\\frac{\\partial x}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi}(\\xi - 2\\xi\\eta) = 1 - 2\\eta$\n$\\frac{\\partial x}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta}(\\xi - 2\\xi\\eta) = -2\\xi$\n$\\frac{\\partial y}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi}(\\eta - \\frac{6}{5}\\xi\\eta) = -\\frac{6}{5}\\eta$\n$\\frac{\\partial y}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta}(\\eta - \\frac{6}{5}\\xi\\eta) = 1 - \\frac{6}{5}\\xi$\n雅可比矩阵为：\n$$\n\\mathbf{J}(\\xi,\\eta) = \\begin{pmatrix} 1 - 2\\eta & -2\\xi \\\\ -\\frac{6}{5}\\eta & 1 - \\frac{6}{5}\\xi \\end{pmatrix}\n$$\n我们必须在参考三角形的形心处，即 $(\\xi, \\eta) = (\\frac{1}{3}, \\frac{1}{3})$ 处，计算该矩阵。\n代入这些值：\n$\\frac{\\partial x}{\\partial \\xi} \\bigg|_{(\\frac{1}{3},\\frac{1}{3})} = 1 - 2\\left(\\frac{1}{3}\\right) = \\frac{1}{3}$\n$\\frac{\\partial x}{\\partial \\eta} \\bigg|_{(\\frac{1}{3},\\frac{1}{3})} = -2\\left(\\frac{1}{3}\\right) = -\\frac{2}{3}$\n$\\frac{\\partial y}{\\partial \\xi} \\bigg|_{(\\frac{1}{3},\\frac{1}{3})} = -\\frac{6}{5}\\left(\\frac{1}{3}\\right) = -\\frac{2}{5}$\n$\\frac{\\partial y}{\\partial \\eta} \\bigg|_{(\\frac{1}{3},\\frac{1}{3})} = 1 - \\frac{6}{5}\\left(\\frac{1}{3}\\right) = 1 - \\frac{2}{5} = \\frac{3}{5}$\n在形心处的雅可比矩阵为：\n$$\n\\mathbf{J}\\left(\\frac{1}{3},\\frac{1}{3}\\right) = \\begin{pmatrix} \\frac{1}{3} & -\\frac{2}{3} \\\\ -\\frac{2}{5} & \\frac{3}{5} \\end{pmatrix}\n$$\n该矩阵的行列式 $J$ 为：\n$$\nJ = \\det(\\mathbf{J}) = \\left(\\frac{1}{3}\\right)\\left(\\frac{3}{5}\\right) - \\left(-\\frac{2}{3}\\right)\\left(-\\frac{2}{5}\\right) = \\frac{3}{15} - \\frac{4}{15} = -\\frac{1}{15}\n$$\n在形心处的雅可比行列式的值为 $-\\frac{1}{15}$。\n\n雅可比行列式 $J$ 的符号的物理意义关系到映射的局部有效性；$J$ 的负号表示从参考坐标到物理坐标的等参映射不是一一对应的，并且在该点局部地反转了单元的几何形状。", "answer": "$$ \\boxed{-\\frac{1}{15}} $$", "id": "2375611"}, {"introduction": "虽然多项式是有限元方法中最常用的基函数，但伽辽金法的思想远比这更为通用。本练习将挑战常规，采用一组三角函数作为基函数来求解一维热传导方程。你会发现，当选择的基函数恰好是问题微分算子的特征函数时，离散后的线性系统会惊人地简化，从而深刻揭示出选择合适基函数对求解效率和精度的巨大影响。[@problem_id:2375674]", "problem": "考虑在开区间 $\\left(0,L\\right)$ 上具有齐次狄利克雷边界条件的一维热扩散问题。令 $u(x,t)$ 满足\n$$\n\\frac{\\partial u}{\\partial t}(x,t) = \\alpha \\,\\frac{\\partial^2 u}{\\partial x^2}(x,t), \\quad x \\in (0,L), \\ t \\ge 0,\n$$\n边界条件为对所有 $t \\ge 0$ 有 $u(0,t)=0$ 和 $u(L,t)=0$，以及在 $x \\in (0,L)$ 上给定的初始条件 $u(x,0)=f(x)$。所有量均为无量纲。\n\n令 $\\{\\phi_n(x)\\}_{n=1}^N$ 表示基函数 $\\phi_n(x)=\\sin\\!\\left(\\frac{n\\pi x}{L}\\right)$，这些基函数满足边界条件。在由 $\\{\\phi_n\\}_{n=1}^N$ 张成的子空间中使用伽辽金近似 (Galerkin approximation) 将解表示为\n$$\nu_N(x,t) = \\sum_{n=1}^{N} b_n(t)\\,\\phi_n(x).\n$$\n对于下面的每个测试用例，使用前 $N$ 个基函数，计算在指定的空间点 $x_\\star$ 和时间 $t$ 处的标量值 $u_N(x_\\star,t)$。所有计算和输出都是无量纲的；不使用物理单位。角度以弧度为单位。\n\n测试组：\n- 案例 1 (一般多模态初始数据)：$L=1$，$\\alpha=\\tfrac{1}{2}$，$N=10$，$t=\\dfrac{2\\ln 2}{\\pi^2}$，$x_\\star=0.3$，以及 $f(x)=3\\sin(\\pi x)+\\tfrac{1}{2}\\sin(2\\pi x)-1.2\\sin(5\\pi x)$。\n- 案例 2 (时间边界检查)：$L=1$，$\\alpha=\\tfrac{1}{2}$，$N=10$，$t=0$，$x_\\star=0.3$，以及 $f(x)=3\\sin(\\pi x)+\\tfrac{1}{2}\\sin(2\\pi x)-1.2\\sin(5\\pi x)$。\n- 案例 3 (不同的域长度和扩散系数)：$L=2$，$\\alpha=\\tfrac{1}{4}$，$N=20$，$t=\\dfrac{16\\ln 2}{\\pi^2}$，$x_\\star=0.5$，以及 $f(x)=\\sin\\!\\left(\\dfrac{\\pi x}{L}\\right)$。\n- 案例 4 (单一高阶模态)：$L=1$，$\\alpha=1$，$N=50$，$t=\\dfrac{\\ln 10}{9\\pi^2}$，$x_\\star=0.7$，以及 $f(x)=\\sin(3\\pi x)$。\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，顺序与上述案例相同。例如，输出格式必须严格为\n\"[result1,result2,result3,result4]\"\n其中每个结果都是一个浮点数。", "solution": "所呈现的问题是一个标准的一维热方程初边值问题，这是数学物理学的基石之一。我们被要求使用伽辽金方法 (Galerkin method) 和一组特定的基函数来找到一个近似解。\n\n问题陈述如下：\n$$\n\\frac{\\partial u}{\\partial t} = \\alpha \\frac{\\partial^2 u}{\\partial x^2}, \\quad x \\in (0, L), \\ t \\ge 0\n$$\n边界条件为 $u(0,t) = 0$，$u(L,t) = 0$，初始条件为 $u(x,0) = f(x)$。\n\n伽辽金 (Galerkin) 过程首先假设一个近似解 $u_N(x,t)$，该解是一组基函数 $\\{\\phi_n(x)\\}_{n=1}^N$ 的有限线性组合，其系数 $\\{b_n(t)\\}_{n=1}^N$ 随时间变化：\n$$\nu_N(x,t) = \\sum_{n=1}^{N} b_n(t) \\phi_n(x)\n$$\n基函数给定为 $\\phi_n(x) = \\sin\\left(\\frac{n\\pi x}{L}\\right)$。这些函数是经过审慎选择的，因为它们固有地满足齐次狄利克雷边界条件，即对所有整数 $n \\ge 1$，有 $\\phi_n(0) = \\sin(0) = 0$ 和 $\\phi_n(L) = \\sin(n\\pi) = 0$。\n\n伽辽金方法 (Galerkin method) 的核心是要求偏微分方程的残差 $R(x,t) = \\frac{\\partial u_N}{\\partial t} - \\alpha \\frac{\\partial^2 u_N}{\\partial x^2}$ 与所选子空间中的每个基函数正交。这通过内积来表达，对于 $(0,L)$ 上的实值函数，内积是它们乘积在定义域上的积分：\n$$\n\\int_0^L R(x,t) \\phi_m(x) \\,dx = 0, \\quad \\text{for } m = 1, 2, \\ldots, N\n$$\n将近似解 $u_N$ 代入残差，得到：\n$$\nR(x,t) = \\sum_{n=1}^{N} \\frac{db_n}{dt}(t) \\phi_n(x) - \\alpha \\sum_{n=1}^{N} b_n(t) \\frac{d^2\\phi_n}{dx^2}(x)\n$$\n我们的基函数的一个关键性质是，对于给定的边界条件，它们是空间算子 $\\frac{d^2}{dx^2}$ 的特征函数：\n$$\n\\frac{d^2\\phi_n}{dx^2} = \\frac{d^2}{dx^2}\\sin\\left(\\frac{n\\pi x}{L}\\right) = -\\left(\\frac{n\\pi}{L}\\right)^2 \\sin\\left(\\frac{n\\pi x}{L}\\right) = -\\lambda_n \\phi_n(x)\n$$\n其中 $\\lambda_n = \\left(\\frac{n\\pi}{L}\\right)^2$ 是特征值。\n\n将此代入正交性条件，得到：\n$$\n\\int_0^L \\left( \\sum_{n=1}^{N} \\left[ \\frac{db_n}{dt}(t) + \\alpha \\lambda_n b_n(t) \\right] \\phi_n(x) \\right) \\phi_m(x) \\,dx = 0\n$$\n根据积分的线性性质，我们可以写出：\n$$\n\\sum_{n=1}^{N} \\left[ \\frac{db_n}{dt}(t) + \\alpha \\lambda_n b_n(t) \\right] \\int_0^L \\phi_n(x) \\phi_m(x) \\,dx = 0\n$$\n正弦基函数在区间 $(0,L)$ 上是正交的：\n$$\n\\int_0^L \\sin\\left(\\frac{n\\pi x}{L}\\right) \\sin\\left(\\frac{m\\pi x}{L}\\right) \\,dx = \\frac{L}{2}\\delta_{nm}\n$$\n其中 $\\delta_{nm}$ 是克罗内克 δ (Kronecker delta)。由于这种正交性，求和会坍缩，因为只有 $n=m$ 的项会保留下来。这将 $N$ 个积分方程组简化为一个解耦的 $N$ 个常微分方程 (ODE) 组：\n$$\n\\left[ \\frac{db_m}{dt}(t) + \\alpha \\lambda_m b_m(t) \\right] \\left(\\frac{L}{2}\\right) = 0\n$$\n由于 $\\frac{L}{2} \\neq 0$，对于每个 $m=1, \\ldots, N$，我们有：\n$$\n\\frac{db_m}{dt}(t) = -\\alpha \\lambda_m b_m(t) = -\\alpha \\left(\\frac{m\\pi}{L}\\right)^2 b_m(t)\n$$\n这是一个一阶线性齐次常微分方程，其解为：\n$$\nb_m(t) = b_m(0) \\exp\\left(-\\alpha \\left(\\frac{m\\pi}{L}\\right)^2 t\\right)\n$$\n初始系数 $b_m(0)$ 是通过将初始条件 $f(x)$ 投影到基上确定的。在 $t=0$ 时，我们有 $u_N(x,0) = \\sum_{n=1}^N b_n(0) \\phi_n(x)$。我们令其等于 $f(x)$，并再次利用正交性：\n$$\n\\int_0^L f(x) \\phi_m(x) \\,dx = \\int_0^L \\left(\\sum_{n=1}^N b_n(0) \\phi_n(x)\\right) \\phi_m(x) \\,dx = b_m(0) \\frac{L}{2}\n$$\n这给出了初始系数的公式：\n$$\nb_m(0) = \\frac{2}{L} \\int_0^L f(x) \\phi_m(x) \\,dx\n$$\n在这个特定问题中，对于每个测试用例，初始函数 $f(x)$ 已经以基函数的有限线性组合形式给出：$f(x) = \\sum_{k} c_k \\phi_k(x)$。根据正交性，系数 $b_m(0)$ 就是 $f(x)$ 给定展开式中的系数 $c_m$，即 $b_m(0) = c_m$。如果 $f(x)$ 的展开式中不存在某个模态 $m$，则其系数 $c_m$ 为零。这就避免了显式积分的需要。参数 $N$ 作为基函数数量的上限，但由于所有测试用例中的活动模态都远小于 $N$，因此不会发生初始数据的截断。\n\n因此，在点 $(x_\\star, t)$ 处的最终解为：\n$$\nu_N(x_\\star, t) = \\sum_{n=1}^{N} b_n(0) \\exp\\left(-\\alpha \\left(\\frac{n\\pi}{L}\\right)^2 t\\right) \\sin\\left(\\frac{n\\pi x_\\star}{L}\\right)\n$$\n其中 $b_n(0)$ 直接从 $f(x)$ 的表达式中读取。\n\n我们现在将此应用于每个测试用例。\n\n案例 1：$L=1$，$\\alpha=0.5$，$N=10$，$t=\\frac{2\\ln 2}{\\pi^2}$，$x_\\star=0.3$。\n$f(x) = 3\\sin(\\pi x) + 0.5\\sin(2\\pi x) - 1.2\\sin(5\\pi x)$。\n非零初始系数为 $b_1(0)=3$，$b_2(0)=0.5$，$b_5(0)=-1.2$。\n随时间演化的系数为：\n$b_1(t) = 3 \\exp(-0.5(\\pi)^2\\frac{2\\ln 2}{\\pi^2}) = 3 \\exp(-\\ln 2) = 1.5$。\n$b_2(t) = 0.5 \\exp(-0.5(2\\pi)^2\\frac{2\\ln 2}{\\pi^2}) = 0.5 \\exp(-4\\ln 2) = 0.5 \\cdot 2^{-4} = \\frac{1}{32}$。\n$b_5(t) = -1.2 \\exp(-0.5(5\\pi)^2\\frac{2\\ln 2}{\\pi^2}) = -1.2 \\exp(-25\\ln 2) = -1.2 \\cdot 2^{-25}$。\n解为：\n$u_{10}(0.3, t) = 1.5\\sin(0.3\\pi) + \\frac{1}{32}\\sin(0.6\\pi) - 1.2 \\cdot 2^{-25}\\sin(1.5\\pi)$。由于 $\\sin(1.5\\pi)=-1$，这变为 $1.5\\sin(0.3\\pi) + \\frac{1}{32}\\sin(0.6\\pi) + 1.2 \\cdot 2^{-25}$。\n\n案例 2：$L=1$，$\\alpha=0.5$，$N=10$，$t=0$，$x_\\star=0.3$。\n$f(x) = 3\\sin(\\pi x) + 0.5\\sin(2\\pi x) - 1.2\\sin(5\\pi x)$。\n在 $t=0$ 时，解就是初始条件本身在 $x_\\star$ 处的值。\n$u_{10}(0.3, 0) = f(0.3) = 3\\sin(0.3\\pi) + 0.5\\sin(0.6\\pi) - 1.2\\sin(1.5\\pi) = 3\\sin(0.3\\pi) + 0.5\\sin(0.6\\pi) + 1.2$。\n\n案例 3：$L=2$，$\\alpha=0.25$，$N=20$，$t=\\frac{16\\ln 2}{\\pi^2}$，$x_\\star=0.5$。\n$f(x) = \\sin(\\frac{\\pi x}{2})$。唯一的非零系数是 $b_1(0)=1$。\n随时间演化的系数为：\n$b_1(t) = 1 \\cdot \\exp(-0.25(\\frac{\\pi}{2})^2\\frac{16\\ln 2}{\\pi^2}) = \\exp(-\\frac{1}{16}\\pi^2\\frac{16\\ln 2}{\\pi^2}) = \\exp(-\\ln 2) = 0.5$。\n解为：\n$u_{20}(0.5, t) = 0.5 \\sin(\\frac{\\pi \\cdot 0.5}{2}) = 0.5\\sin(\\frac{\\pi}{4}) = 0.5\\frac{\\sqrt{2}}{2} = \\frac{\\sqrt{2}}{4}$。\n\n案例 4：$L=1$，$\\alpha=1$，$N=50$，$t=\\frac{\\ln 10}{9\\pi^2}$，$x_\\star=0.7$。\n$f(x) = \\sin(3\\pi x)$。唯一的非零系数是 $b_3(0)=1$。\n随时间演化的系数为：\n$b_3(t) = 1 \\cdot \\exp(-1(3\\pi)^2\\frac{\\ln 10}{9\\pi^2}) = \\exp(-9\\pi^2\\frac{\\ln 10}{9\\pi^2}) = \\exp(-\\ln 10) = 0.1$。\n解为：\n$u_{50}(0.7, t) = 0.1\\sin(3\\pi \\cdot 0.7) = 0.1\\sin(2.1\\pi) = 0.1\\sin(0.1\\pi)$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the 1D heat equation using a Galerkin approximation for several test cases.\n    \"\"\"\n\n    # The test cases are structured as tuples:\n    # (L, alpha, t, x_star, initial_coeffs)\n    # where initial_coeffs is a dictionary {mode_n: coefficient_c_n}.\n    test_cases = [\n        (1.0, 0.5, 2 * np.log(2) / np.pi**2, 0.3, {1: 3.0, 2: 0.5, 5: -1.2}),\n        (1.0, 0.5, 0.0, 0.3, {1: 3.0, 2: 0.5, 5: -1.2}),\n        (2.0, 0.25, 16 * np.log(2) / np.pi**2, 0.5, {1: 1.0}),\n        (1.0, 1.0, np.log(10) / (9 * np.pi**2), 0.7, {3: 1.0}),\n    ]\n\n    results = []\n    for case in test_cases:\n        L, alpha, t, x_star, initial_coeffs = case\n        \n        # The approximate solution u_N(x,t) is a sum over modes.\n        u_N = 0.0\n        \n        # Iterate through the modes present in the initial condition.\n        # For modes not specified in initial_coeffs, the coefficient is 0.\n        for n, b_n_0 in initial_coeffs.items():\n            # Calculate the time-dependent coefficient b_n(t)\n            # b_n(t) = b_n(0) * exp(-alpha * (n*pi/L)^2 * t)\n            lambda_n = (n * np.pi / L)**2\n            decay_factor = np.exp(-alpha * lambda_n * t)\n            b_n_t = b_n_0 * decay_factor\n            \n            # Calculate the basis function value phi_n(x_star)\n            # phi_n(x) = sin(n*pi*x/L)\n            phi_n_x_star = np.sin(n * np.pi * x_star / L)\n            \n            # Add the contribution of this mode to the total solution\n            u_N += b_n_t * phi_n_x_star\n            \n        results.append(u_N)\n\n    # Format the final output as a comma-separated list in brackets.\n    # The problem asks for floating-point numbers.\n    print(f\"[{','.join(f'{r:.16f}' for r in results)}]\")\n\nsolve()\n```", "id": "2375674"}]}