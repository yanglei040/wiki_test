{"hands_on_practices": [{"introduction": "有限元法的基础在于对系统进行逐个单元的分析。第一个练习将重点推导单元的特征矩阵，特别是用于动态分析的一致质量矩阵。通过在一个简单的一维单元上对形函数的乘积进行积分，你将对质量等物理属性如何在单元层面分布有一个具体的理解 [@problem_id:2172585]。", "problem": "在结构的振动有限元分析中，单元的惯性由一个质量矩阵表示。考虑一个用于模拟均匀杆段的一维双节点线性单元。该单元的长度为 $h_e$，质量密度为常数 $\\rho$，横截面积为均匀的 $A$。\n\n定义一个局部坐标系，使得该单元占据域 $x \\in [0, h_e]$，其中节点1位于 $x=0$，节点2位于 $x=h_e$。单元内的轴向位移场由节点位移通过线性函数 $N_1(x) = 1 - \\frac{x}{h_e}$ 和 $N_2(x) = \\frac{x}{h_e}$ 插值得到。\n\n$2 \\times 2$ 单元质量矩阵 $\\mathbf{M}$ 的各项 $M_{ij}$（其中 $i, j \\in \\{1, 2\\}$）由以下沿单元长度的积分确定：\n$$\nM_{ij} = \\int_{0}^{h_e} \\rho A N_i(x) N_j(x) dx\n$$\n计算单元质量矩阵 $\\mathbf{M}$。您的答案应该是一个用 $\\rho$、$A$ 和 $h_e$ 表示的 $2 \\times 2$ 矩阵。", "solution": "我们使用一维单元的一致质量矩阵定义：\n$$\nM_{ij}=\\int_{0}^{h_{e}}\\rho A\\,N_{i}(x)N_{j}(x)\\,dx,\\quad i,j\\in\\{1,2\\},\n$$\n其中线性形函数为 $N_{1}(x)=1-\\frac{x}{h_{e}}$ 和 $N_{2}(x)=\\frac{x}{h_{e}}$，定义在 $x\\in[0,h_{e}]$上。\n\n计算每一项：\n对于 $M_{11}$，\n$$\nM_{11}=\\int_{0}^{h_{e}}\\rho A\\left(1-\\frac{x}{h_{e}}\\right)^{2}dx\n=\\rho A\\int_{0}^{h_{e}}\\left(1-\\frac{2x}{h_{e}}+\\frac{x^{2}}{h_{e}^{2}}\\right)dx.\n$$\n逐项积分，\n$$\nM_{11}=\\rho A\\left[x-\\frac{x^{2}}{h_{e}}+\\frac{x^{3}}{3h_{e}^{2}}\\right]_{0}^{h_{e}}\n=\\rho A\\left(h_{e}-h_{e}+\\frac{h_{e}}{3}\\right)\n=\\rho A\\frac{h_{e}}{3}.\n$$\n\n对于 $M_{12}$，\n$$\nM_{12}=\\int_{0}^{h_{e}}\\rho A\\left(1-\\frac{x}{h_{e}}\\right)\\left(\\frac{x}{h_{e}}\\right)dx\n=\\rho A\\int_{0}^{h_{e}}\\left(\\frac{x}{h_{e}}-\\frac{x^{2}}{h_{e}^{2}}\\right)dx.\n$$\n积分得，\n$$\nM_{12}=\\rho A\\left[\\frac{x^{2}}{2h_{e}}-\\frac{x^{3}}{3h_{e}^{2}}\\right]_{0}^{h_{e}}\n=\\rho A\\left(\\frac{h_{e}}{2}-\\frac{h_{e}}{3}\\right)\n=\\rho A\\frac{h_{e}}{6}.\n$$\n\n根据对称性，$M_{21}=M_{12}=\\rho A\\frac{h_{e}}{6}$，类似地\n$$\nM_{22}=\\int_{0}^{h_{e}}\\rho A\\left(\\frac{x}{h_{e}}\\right)^{2}dx\n=\\rho A\\int_{0}^{h_{e}}\\frac{x^{2}}{h_{e}^{2}}dx\n=\\rho A\\frac{1}{h_{e}^{2}}\\left[\\frac{x^{3}}{3}\\right]_{0}^{h_{e}}\n=\\rho A\\frac{h_{e}}{3}.\n$$\n\n组合各项得到\n$$\n\\mathbf{M}=\n\\begin{pmatrix}\n\\rho A\\frac{h_{e}}{3} & \\rho A\\frac{h_{e}}{6} \\\\\n\\rho A\\frac{h_{e}}{6} & \\rho A\\frac{h_{e}}{3}\n\\end{pmatrix}\n=\\frac{\\rho A h_{e}}{6}\n\\begin{pmatrix}\n2 & 1 \\\\\n1 & 2\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\frac{\\rho A h_{e}}{6}\\begin{pmatrix}2 & 1 \\\\ 1 & 2\\end{pmatrix}}$$", "id": "2172585"}, {"introduction": "在计算出单个单元矩阵之后，有限元法的下一个关键步骤是将它们组装成一个代表整个结构的全局系统矩阵。这个练习将挑战你为一个节点编号故意打乱的小型网格执行这一组装过程 [@problem_id:2393853]。成功完成此任务表明你真正理解了从局部单元自由度到全局系统的映射关系，这是任何有限元求解器的核心。", "problem": "考虑一个稳态一维热传导问题，研究对象是一根具有恒定热导率 $k$ 和恒定横截面积 $A$ 的直棱柱杆。杆内没有内部热源。该杆使用标准伽辽金有限元法和线性拉格朗日形函数进行离散化，划分为 4 个单元和 5 个全局节点。全局节点标识符及其沿杆的位置如下：\n- 节点 $42$：$x=0.00 \\ \\mathrm{m}$\n- 节点 $7$：$x=0.35 \\ \\mathrm{m}$\n- 节点 $13$：$x=0.50 \\ \\mathrm{m}$\n- 节点 $5$：$x=0.90 \\ \\mathrm{m}$\n- 节点 $21$：$x=1.20 \\ \\mathrm{m}$\n\n单元连接关系被有意打乱，由以下双节点单元列表（(第一节点, 第二节点)）给出：\n- 单元 $17$：$(42,7)$\n- 单元 $100$：$(13,7)$\n- 单元 $9$：$(13,5)$\n- 单元 $23$：$(21,5)$\n\n组装无约束系统（即施加任何边界条件之前）的全局刚度矩阵。全局刚度矩阵的行和列需按照节点标识符序列 $(5, \\ 42, \\ 13, \\ 21, \\ 7)$ 排列。\n\n材料和几何属性如下：\n- 热导率 $k = 180 \\ \\mathrm{W \\, m^{-1} \\, K^{-1}}$\n- 横截面积 $A = 2.0 \\times 10^{-3} \\ \\mathrm{m^{2}}$\n\n与全局节点标识符 $13$ 相关联的、已组装的全局刚度矩阵的对角线元素的值是多少？答案以 $\\mathrm{W \\, K^{-1}}$ 为单位，并四舍五入到 4 位有效数字。", "solution": "对于无内部热源、具有恒定热导率 $k$ 和恒定横截面积 $A$ 的直棱柱杆中的稳态一维热传导问题，其控制微分方程为\n$$\n-\\frac{\\mathrm{d}}{\\mathrm{d}x}\\!\\left(k A \\, \\frac{\\mathrm{d}T}{\\mathrm{d}x}\\right) \\,=\\, 0.\n$$\n对于长度为 $L_{e}$ 的双节点单元，使用标准伽辽金有限元法和线性拉格朗日形函数可得到单元刚度矩阵\n$$\n\\mathbf{K}^{(e)} \\,=\\, \\int_{0}^{L_{e}} k A \\, \\left(\\frac{\\mathrm{d}\\mathbf{N}}{\\mathrm{d}x}\\right)^{\\!\\top} \\left(\\frac{\\mathrm{d}\\mathbf{N}}{\\mathrm{d}x}\\right) \\, \\mathrm{d}x,\n$$\n其中 $\\mathbf{N} = \\begin{bmatrix} N_{1} & N_{2} \\end{bmatrix}$ 是线性形函数。对于线性双节点单元，其导数在单元上是常数，$\\frac{\\mathrm{d}N_{1}}{\\mathrm{d}x} = -\\frac{1}{L_{e}}$ 和 $\\frac{\\mathrm{d}N_{2}}{\\mathrm{d}x} = \\frac{1}{L_{e}}$，因此\n$$\n\\mathbf{K}^{(e)} \\,=\\, k A \\int_{0}^{L_{e}} \n\\begin{bmatrix}\n\\frac{1}{L_{e}^{2}} & -\\frac{1}{L_{e}^{2}} \\\\\n-\\frac{1}{L_{e}^{2}} & \\frac{1}{L_{e}^{2}}\n\\end{bmatrix}\n\\mathrm{d}x\n\\,=\\, \\frac{k A}{L_{e}} \\begin{bmatrix} 1 & -1 \\\\ -1 & 1 \\end{bmatrix}.\n$$\n\n因此，每个单元对其两个节点的对角线元素贡献 $\\frac{k A}{L_{e}}$，并对相应的非对角线耦合项贡献 $-\\frac{k A}{L_{e}}$。与特定全局节点相关联的全局刚度矩阵的对角线元素，是所有连接到该节点的单元的对角线贡献之和。\n\n我们首先根据给定的节点坐标计算单元长度：\n- 单元 $17$ 连接位于 $x=0.00 \\ \\mathrm{m}$ 和 $x=0.35 \\ \\mathrm{m}$ 的节点 $(42, 7)$，因此 $L_{17} = |0.35 - 0.00| = 0.35 \\ \\mathrm{m}$。\n- 单元 $100$ 连接位于 $x=0.50 \\ \\mathrm{m}$ 和 $x=0.35 \\ \\mathrm{m}$ 的节点 $(13, 7)$，因此 $L_{100} = |0.50 - 0.35| = 0.15 \\ \\mathrm{m}$。\n- 单元 $9$ 连接位于 $x=0.50 \\ \\mathrm{m}$ 和 $x=0.90 \\ \\mathrm{m}$ 的节点 $(13, 5)$，因此 $L_{9} = |0.90 - 0.50| = 0.40 \\ \\mathrm{m}$。\n- 单元 $23$ 连接位于 $x=1.20 \\ \\mathrm{m}$ 和 $x=0.90 \\ \\mathrm{m}$ 的节点 $(21, 5)$，因此 $L_{23} = |1.20 - 0.90| = 0.30 \\ \\mathrm{m}$。\n\n全局节点 $13$ 连接到单元 $100$ 和单元 $9$。因此，与节点 $13$ 相关联的全局刚度矩阵的对角线元素为\n$$\nK_{(13,13)} \\,=\\, \\frac{k A}{L_{100}} \\,+\\, \\frac{k A}{L_{9}}.\n$$\n\n代入给定的材料和几何属性 $k = 180 \\ \\mathrm{W \\, m^{-1} \\, K^{-1}}$ 和 $A = 2.0 \\times 10^{-3} \\ \\mathrm{m^{2}}$：\n$$\nk A \\,=\\, 180 \\times \\left(2.0 \\times 10^{-3}\\right) \\,=\\, 0.36 \\ \\mathrm{W \\, K^{-1}}.\n$$\n因此，\n$$\nK_{(13,13)} \\,=\\, 0.36 \\left(\\frac{1}{0.15} + \\frac{1}{0.40}\\right) \\ \\mathrm{W \\, K^{-1}}.\n$$\n计算长度的倒数：\n$$\n\\frac{1}{0.15} \\,=\\, \\frac{100}{15} \\,=\\, \\frac{20}{3} \\,=\\, 6.\\overline{6}, \n\\qquad\n\\frac{1}{0.40} \\,=\\, \\frac{10}{4} \\,=\\, \\frac{5}{2} \\,=\\, 2.5.\n$$\n因此，\n$$\nK_{(13,13)} \\,=\\, 0.36 \\left( \\frac{20}{3} + \\frac{5}{2} \\right) \\ \\mathrm{W \\, K^{-1}}\n\\,=\\, 0.36 \\left( \\frac{40}{6} + \\frac{15}{6} \\right) \\ \\mathrm{W \\, K^{-1}}\n\\,=\\, 0.36 \\left( \\frac{55}{6} \\right) \\ \\mathrm{W \\, K^{-1}}.\n$$\n进行乘法运算：\n$$\n0.36 \\left( \\frac{55}{6} \\right)\n\\,=\\, \\frac{0.36 \\times 55}{6}\n\\,=\\, 0.06 \\times 55\n\\,=\\, 3.3.\n$$\n\n因此，与全局节点 $13$ 相关联的对角线元素为\n$$\nK_{(13,13)} \\,=\\, 3.3 \\ \\mathrm{W \\, K^{-1}}.\n$$\n按要求四舍五入到 4 位有效数字，得到 $3.300 \\ \\mathrm{W \\, K^{-1}}$。", "answer": "$$\\boxed{3.300}$$", "id": "2393853"}, {"introduction": "为了模拟复杂几何形状，有限元法使用一种称为等参映射的强大技术，它将一个简单的“父”单元转换为物理域中的扭曲形状。然而，如果单元扭曲得太厉害（例如凹形），这种映射可能会失效。这个进阶练习让你亲手计算一个“回旋镖”形状单元的映射失效点，从而让你对网格质量和单元凸性为何对有效模拟至关重要获得切实的认识 [@problem_id:2393848]。", "problem": "一个四节点双线性等参四边形单元将参考正方形 $\\{(\\xi,\\eta)\\,|\\, -1 \\le \\xi \\le 1,\\,-1 \\le \\eta \\le 1\\}$（节点顺序为 $1:(-1,-1)$、$2:(1,-1)$、$3:(1,1)$、$4:(-1,1)$）映射到一个物理四边形上，其节点坐标为 $P_1=\\left(0,0\\right)$、$P_2=\\left(2,0\\right)$、$P_3=\\left(\\frac{1}{2},\\frac{1}{5}\\right)$ 和 $P_4=\\left(0,1\\right)$。该物理四边形是凹四边形。请从第一性原理出发，完成以下任务：\n- 推导等参映射 $(x(\\xi,\\eta), y(\\xi,\\eta))$。\n- 计算此映射的雅可比行列式 $\\det J(\\xi,\\eta)$。\n- 等参映射在 $\\det J(\\xi,\\eta)=0$ 处失效。沿着参考空间的中线 $\\eta=0$，确定 $\\det J(\\xi,0)=0$ 时的精确参数坐标 $\\xi^{\\star}$。\n\n答案规格：\n- 最终答案只提供 $\\xi^{\\star}$ 的数值。\n- 将最终答案表示为精确分数（无单位）。不要四舍五入。", "solution": "等参映射使用与插值场变量相同的形函数，将物理域中的坐标 $(x, y)$ 与参考域中的坐标 $(\\xi, \\eta)$ 关联起来。对于四节点双线性单元，该映射由以下公式给出：\n$$ x(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) x_i $$\n$$ y(\\xi, \\eta) = \\sum_{i=1}^{4} N_i(\\xi, \\eta) y_i $$\n其中 $(x_i, y_i)$ 是物理域中第 $i$ 个节点的坐标，$N_i(\\xi, \\eta)$ 是双线性形函数。\n\n节点位于 $(\\pm 1, \\pm 1)$ 的四节点单元的形函数为：\n$$ N_1(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1-\\eta) $$\n$$ N_2(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta) $$\n$$ N_3(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta) $$\n$$ N_4(\\xi, \\eta) = \\frac{1}{4}(1-\\xi)(1+\\eta) $$\n物理域中给定的节点坐标为 $P_1(x_1, y_1) = (0,0)$、$P_2(x_2, y_2) = (2,0)$、$P_3(x_3, y_3) = (\\frac{1}{2},\\frac{1}{5})$ 和 $P_4(x_4, y_4) = (0,1)$。\n\n首先，我们推导 $x(\\xi, \\eta)$ 的表达式：\n$$ x(\\xi, \\eta) = N_1(\\xi, \\eta) \\cdot 0 + N_2(\\xi, \\eta) \\cdot 2 + N_3(\\xi, \\eta) \\cdot \\frac{1}{2} + N_4(\\xi, \\eta) \\cdot 0 $$\n$$ x(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1-\\eta) \\cdot 2 + \\frac{1}{4}(1+\\xi)(1+\\eta) \\cdot \\frac{1}{2} $$\n$$ x(\\xi, \\eta) = \\frac{1}{4}(1+\\xi) \\left[ 2(1-\\eta) + \\frac{1}{2}(1+\\eta) \\right] $$\n$$ x(\\xi, \\eta) = \\frac{1}{4}(1+\\xi) \\left[ 2 - 2\\eta + \\frac{1}{2} + \\frac{1}{2}\\eta \\right] = \\frac{1}{4}(1+\\xi) \\left[ \\frac{5}{2} - \\frac{3}{2}\\eta \\right] $$\n$$ x(\\xi, \\eta) = \\frac{1}{8}(1+\\xi)(5-3\\eta) $$\n接下来，我们推导 $y(\\xi, \\eta)$ 的表达式：\n$$ y(\\xi, \\eta) = N_1(\\xi, \\eta) \\cdot 0 + N_2(\\xi, \\eta) \\cdot 0 + N_3(\\xi, \\eta) \\cdot \\frac{1}{5} + N_4(\\xi, \\eta) \\cdot 1 $$\n$$ y(\\xi, \\eta) = \\frac{1}{4}(1+\\xi)(1+\\eta) \\cdot \\frac{1}{5} + \\frac{1}{4}(1-\\xi)(1+\\eta) \\cdot 1 $$\n$$ y(\\xi, \\eta) = \\frac{1}{4}(1+\\eta) \\left[ \\frac{1}{5}(1+\\xi) + (1-\\xi) \\right] $$\n$$ y(\\xi, \\eta) = \\frac{1}{4}(1+\\eta) \\left[ \\frac{1}{5} + \\frac{1}{5}\\xi + 1 - \\xi \\right] = \\frac{1}{4}(1+\\eta) \\left[ \\frac{6}{5} - \\frac{4}{5}\\xi \\right] $$\n$$ y(\\xi, \\eta) = \\frac{1}{10}(1+\\eta)(3-2\\xi) $$\n变换的雅可比矩阵定义为 $J_{ij} = \\frac{\\partial x_i}{\\partial \\xi_j}$，其中 $(x_1, x_2) = (x, y)$ 且 $(\\xi_1, \\xi_2) = (\\xi, \\eta)$：\n$$ J(\\xi, \\eta) = \\begin{pmatrix} \\frac{\\partial x}{\\partial \\xi} & \\frac{\\partial x}{\\partial \\eta} \\\\ \\frac{\\partial y}{\\partial \\xi} & \\frac{\\partial y}{\\partial \\eta} \\end{pmatrix} $$\n我们从映射函数计算必要的偏导数：\n$$ \\frac{\\partial x}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi} \\left[ \\frac{1}{8}(1+\\xi)(5-3\\eta) \\right] = \\frac{1}{8}(5-3\\eta) $$\n$$ \\frac{\\partial x}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta} \\left[ \\frac{1}{8}(1+\\xi)(5-3\\eta) \\right] = -\\frac{3}{8}(1+\\xi) $$\n$$ \\frac{\\partial y}{\\partial \\xi} = \\frac{\\partial}{\\partial \\xi} \\left[ \\frac{1}{10}(3-2\\xi)(1+\\eta) \\right] = -\\frac{2}{10}(1+\\eta) = -\\frac{1}{5}(1+\\eta) $$\n$$ \\frac{\\partial y}{\\partial \\eta} = \\frac{\\partial}{\\partial \\eta} \\left[ \\frac{1}{10}(3-2\\xi)(1+\\eta) \\right] = \\frac{1}{10}(3-2\\xi) $$\n雅可比行列式为：\n$$ \\det J(\\xi, \\eta) = \\left( \\frac{\\partial x}{\\partial \\xi} \\right) \\left( \\frac{\\partial y}{\\partial \\eta} \\right) - \\left( \\frac{\\partial x}{\\partial \\eta} \\right) \\left( \\frac{\\partial y}{\\partial \\xi} \\right) $$\n$$ \\det J(\\xi, \\eta) = \\left( \\frac{1}{8}(5-3\\eta) \\right) \\left( \\frac{1}{10}(3-2\\xi) \\right) - \\left( -\\frac{3}{8}(1+\\xi) \\right) \\left( -\\frac{1}{5}(1+\\eta) \\right) $$\n$$ \\det J(\\xi, \\eta) = \\frac{1}{80}(5-3\\eta)(3-2\\xi) - \\frac{3}{40}(1+\\xi)(1+\\eta) $$\n为了简化，我们找到公分母 $80$：\n$$ \\det J(\\xi, \\eta) = \\frac{1}{80} \\left[ (5-3\\eta)(3-2\\xi) - 6(1+\\xi)(1+\\eta) \\right] $$\n$$ \\det J(\\xi, \\eta) = \\frac{1}{80} \\left[ (15 - 10\\xi - 9\\eta + 6\\xi\\eta) - (6 + 6\\xi + 6\\eta + 6\\xi\\eta) \\right] $$\n$$ \\det J(\\xi, \\eta) = \\frac{1}{80} [ 15 - 10\\xi - 9\\eta + 6\\xi\\eta - 6 - 6\\xi - 6\\eta - 6\\xi\\eta ] $$\n合并同类项得到雅可比行列式的最终表达式：\n$$ \\det J(\\xi, \\eta) = \\frac{1}{80} [ (15-6) + (-10-6)\\xi + (-9-6)\\eta + (6-6)\\xi\\eta ] $$\n$$ \\det J(\\xi, \\eta) = \\frac{1}{80} (9 - 16\\xi - 15\\eta) $$\n问题要求找到在参考空间中线 $\\eta=0$ 上雅可比行列式为零的特定坐标 $\\xi^{\\star}$。我们将 $\\eta=0$ 代入行列式表达式中：\n$$ \\det J(\\xi, 0) = \\frac{1}{80} (9 - 16\\xi - 15(0)) = \\frac{1}{80} (9 - 16\\xi) $$\n我们令该表达式为零，以找到映射失效的点：\n$$ \\frac{1}{80} (9 - 16\\xi) = 0 $$\n$$ 9 - 16\\xi = 0 $$\n$$ 16\\xi = 9 $$\n$$ \\xi^{\\star} = \\frac{9}{16} $$\n该值 $\\xi^{\\star} = \\frac{9}{16}$ 位于区间 $[-1, 1]$ 内，证实了映射在参考单元域内部变为奇异，这与凹物理单元的预期相符。", "answer": "$$\\boxed{\\frac{9}{16}}$$", "id": "2393848"}]}