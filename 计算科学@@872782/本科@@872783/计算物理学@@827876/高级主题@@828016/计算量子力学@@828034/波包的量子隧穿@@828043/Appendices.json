{"hands_on_practices": [{"introduction": "要真正理解量子隧穿，我们必须超越纯粹的理论，亲手模拟这一过程。这个实践练习将指导你通过数值求解含时薛定谔方程，来可视化一个波包与势垒的相互作用。你将学习通过对概率流密度进行积分来计算隧穿概率，这是一种直接反映概率在空间中流动的基础方法，对于掌握量子动力学的核心至关重要。[@problem_id:2460912]", "problem": "一维量子粒子在原子单位（其中 $\\hbar = 1$ 和 $m = 1$）下根据含时薛定谔方程演化。一个归一化的高斯波包初始时位于位置 $x_0$，空间宽度为 $\\sigma$，平均波数为 $k_0$，从左侧入射到一个高度为 $V_0$、宽度为 $a$、中心在 $x_B = 0$ 的矩形势垒。隧穿（透射）概率可以定义为在所有时间内，穿过位于势垒右侧的固定探测位置 $x_\\text{probe}$ 的总概率通量，这符合概率守恒。实现一个数值求解器来传播波包，计算探测点处的瞬时概率流密度，并对透射通量进行积分，以获得每个测试用例的透射概率。\n\n使用的基本原理和定义：\n- 含时薛定谔方程为\n$$\n\\mathrm{i}\\,\\frac{\\partial}{\\partial t}\\,\\psi(x,t) \\;=\\; \\left[-\\frac{1}{2}\\frac{\\partial^2}{\\partial x^2} + V(x)\\right]\\psi(x,t).\n$$\n- 概率密度为 $\\rho(x,t) = |\\psi(x,t)|^2$。连续性方程为\n$$\n\\frac{\\partial \\rho(x,t)}{\\partial t} + \\frac{\\partial J(x,t)}{\\partial x} = 0,\n$$\n其中概率流密度为\n$$\nJ(x,t) \\;=\\; \\Im\\!\\left(\\psi^*(x,t)\\,\\frac{\\partial \\psi(x,t)}{\\partial x}\\right).\n$$\n- 矩形势垒为\n$$\nV(x) \\;=\\; \\begin{cases}\nV_0,  |x - x_B| \\le \\dfrac{a}{2},\\\\\n0,  \\text{otherwise}.\n\\end{cases}\n$$\n- 初始高斯波包为\n$$\n\\psi(x,0) \\;=\\; \\left(\\frac{1}{2\\pi \\sigma^2}\\right)^{1/4}\\exp\\!\\left(-\\frac{(x-x_0)^2}{4\\sigma^2}\\right)\\exp(\\mathrm{i}k_0 x),\n$$\n必须在所选网格上进行数值归一化，以确保 $\\int |\\psi(x,0)|^2 \\,\\mathrm{d}x = 1$。\n\n数值要求：\n- 使用一个与含时薛定谔方程一致的稳定算法，在有限空间域中传播 $\\psi(x,t)$；例如，基于快速傅里叶变换（FFT, Fast Fourier Transform）的时间分裂谱方法是可以接受的，但任何遵循上述方程且能达到相当精度的算法都是允许的。\n- 为防止模拟边界产生非物理反射，请使用以复吸收层实现的吸收边界。一个方便的选择是在左右边缘附近为势能添加一个纯虚数部分 $-\\,\\mathrm{i}\\,W(x)$，其中 $W(x) \\ge 0$ 是平滑的，并在内部区域消失。\n- 在每个时间步长，计算固定探测位置 $x_\\text{probe}$ 处的瞬时概率流密度。为近似 $\\partial \\psi/\\partial x$，您可以使用空间步长为 $\\Delta x$ 的中心有限差分。\n- 将探测器处的透射通量定义为正向贡献 $J_+(x_\\text{probe},t) = \\max(J(x_\\text{probe},t),0)$，并通过时间积分来近似透射概率：\n$$\nT \\;\\approx\\; \\int_{0}^{T_\\text{end}} J_+(x_\\text{probe},t)\\,\\mathrm{d}t,\n$$\n其中 $T_\\text{end}$ 足够大，以确保透射波包已通过探测器且残余贡献可以忽略不计。\n\n所有测试用例共用的模拟参数：\n- 空间域 $[x_\\text{min},x_\\text{max}] = [-100,100]$。\n- 网格点数 $N = 2048$（均匀间距）。\n- 时间步长 $\\Delta t = 0.05$。\n- 总传播时间 $T_\\text{end} = 160$。\n- 在两个域边缘附近的吸收层宽度 $x_\\text{cap} = 20$，强度参数 $\\eta = 0.02$，且具有二次剖面 $W(x)$；即，在吸收区域中 $W(x) = \\eta\\,s(x)^2$，其中 $s(x)$ 在宽度 $x_\\text{cap}$ 上从 $0$ 斜坡上升到 $1$。\n- 势垒中心 $x_B = 0$，探测器位置 $x_\\text{probe} = a/2 + 10$（相对于势垒宽度固定），初始波包中心 $x_0 = -60$，以及波包宽度 $\\sigma = 1.5$。\n\n测试套件：\n- 案例 1：$k_0 = 1.5$, $V_0 = 2.0$, $a = 4.0$。\n- 案例 2：$k_0 = 0.8$, $V_0 = 2.5$, $a = 6.0$。\n- 案例 3：$k_0 = 2.5$, $V_0 = 1.0$, $a = 4.0$。\n\n答案规范：\n- 对于每个案例，使用上述通量积分方法计算透射概率 $T$。每个 $T$ 都是无量纲的，在数值误差范围内必须位于 $[0,1]$ 区间内。报告每个结果，四舍五入到六位小数。\n- 您的程序必须生成一行输出，其中包含三个结果，格式为方括号内以逗号分隔的列表，例如 `[0.123456,0.000789,0.876543]`。\n- 无需外部输入，所有量均采用原子单位。确保报告的值按规定四舍五入到六位小数。", "solution": "问题陈述已经过验证，被认为是科学上合理、适定且完整的。它描述了计算量子动力学中的一个标准练习，基于量子力学的基本原理。数值解所需的所有参数均已提供，且定义一致。我们可以开始求解了。\n\n问题的核心是求解给定初始态和势下的一维含时薛定谔方程 (TDSE)。在原子单位（$\\hbar=1$，$m=1$）下，TDSE 为：\n$$ \\mathrm{i}\\,\\frac{\\partial}{\\partial t}\\,\\psi(x,t) \\;=\\; \\hat{H}\\psi(x,t) \\;=\\; \\left[-\\frac{1}{2}\\frac{\\partial^2}{\\partial x^2} + V_{\\text{eff}}(x)\\right]\\psi(x,t) $$\n$t=0$ 时的初始态是一个归一化的高斯波包。有效势 $V_{\\text{eff}}(x)$ 包括实矩形势垒 $V(x)$ 和一个位于网格边界处的虚数复吸收势 (CAP) $- \\mathrm{i}W(x)$，以防止非物理反射。\n\n为了在时间上传播波函数 $\\psi(x,t)$，我们采用时间分裂谱方法。该方法非常适用于此问题，因为它准确、稳定且计算效率高。在一个小时间步长 $\\Delta t$ 上的形式解涉及到时间演化算符 $\\hat{U}(\\Delta t) = \\exp(-\\mathrm{i}\\hat{H}\\Delta t)$。由于动能算符 $\\hat{T} = -\\frac{1}{2}\\frac{\\partial^2}{\\partial x^2}$ 和势能算符 $\\hat{V}_{\\text{eff}} = V_{\\text{eff}}(x)$ 不对易，我们使用二阶 Strang 分裂分解来近似演化算符：\n$$ \\hat{U}(\\Delta t) \\approx e^{-\\mathrm{i}\\hat{V}_{\\text{eff}}\\Delta t/2} e^{-\\mathrm{i}\\hat{T}\\Delta t} e^{-\\mathrm{i}\\hat{V}_{\\text{eff}}\\Delta t/2} $$\n该近似的误差阶数为 $\\mathcal{O}(\\Delta t^3)$，为指定的参数提供了足够的精度。从时间 $t$ 到 $t+\\Delta t$ 的传播分三步执行：\n$1$. 在势 $\\hat{V}_{\\text{eff}}$ 下演化半步。在位置表象中，这是一个简单的乘法：$\\psi'(x) = e^{-\\mathrm{i}V_{\\text{eff}}(x)\\Delta t/2} \\psi(x,t)$。\n$2$. 在动能算符 $\\hat{T}$ 下演化一整步。此操作在位置空间中计算复杂，但在动量空间中则很简单，其中 $\\hat{T}$ 是一个简单的乘法算符 $\\hat{T}_k = k^2/2$。我们使用快速傅里叶变换 (FFT) 在不同表象之间切换。波函数被变换到动量空间（$\\tilde{\\psi}'(k) = \\mathcal{F}[\\psi'(x)]$），乘以动能演化因子（$e^{-\\mathrm{i}k^2\\Delta t/2}$），然后变换回位置空间（$\\psi''(x) = \\mathcal{F}^{-1}[e^{-\\mathrm{i}k^2\\Delta t/2}\\tilde{\\psi}'(k)]$）。\n$3$. 在势下进行第二个半步演化：$\\psi(x, t+\\Delta t) = e^{-\\mathrm{i}V_{\\text{eff}}(x)\\Delta t/2} \\psi''(x)$。\n\n这个三步循环从 $t=0$ 重复到 $t=T_{\\text{end}}$。\n\n模拟域被离散化为一个包含 $N=2048$ 个点的均匀空间网格，覆盖区间 $[x_{\\text{min}}, x_{\\text{max}}] = [-100, 100]$，间距为 $\\Delta x = (x_{\\text{max}}-x_{\\text{min}})/N$。相应的动量空间（波数）网格 $k$ 是使用与 FFT 算法一致的 `fftfreq` 工具构建的。\n\n初始波包由下式给出：\n$$ \\psi(x,0) \\;=\\; C \\exp\\!\\left(-\\frac{(x-x_0)^2}{4\\sigma^2}\\right)\\exp(\\mathrm{i}k_0 x) $$\n其中 $C = (2\\pi \\sigma^2)^{-1/4}$。关键的是，对于离散网格上的数值工作，该函数必须重新归一化，以确保总概率 $\\int |\\psi(x,0)|^2 dx$（近似为和 $\\sum_j |\\psi(x_j,0)|^2 \\Delta x$）精确为 $1$。\n\n总有效势为 $V_{\\text{eff}}(x) = V(x) - \\mathrm{i}W(x)$。\n矩形势垒为：\n$$ V(x) \\;=\\; \\begin{cases} V_0,  |x| \\le a/2 \\\\ 0,  \\text{otherwise} \\end{cases} $$\n复吸收势 $W(x)$ 的构建使其仅在边界附近非零，宽度为 $x_{\\text{cap}}=20$。根据规定，$W(x) = \\eta s(x)^2$ 且 $\\eta=0.02$，其中 $s(x)$ 是一个在吸收区域起始处从 0 线性增加到网格边界处为 1 的函数。例如，在右边界上对于 $x \\in [x_{\\text{max}}-x_{\\text{cap}}, x_{\\text{max}}]$，$s(x) = \\frac{x-(x_{\\text{max}}-x_{\\text{cap}})}{x_{\\text{cap}}}$。这个虚势能平滑地吸收出射波函数，防止伪反射。\n\n透射概率 $T$ 是通过对经过探测器的概率流密度通量进行积分来确定的。概率流密度为：\n$$ J(x,t) \\;=\\; \\Im\\!\\left(\\psi^*(x,t)\\,\\frac{\\partial \\psi(x,t)}{\\partial x}\\right) $$\n在数值上，探测位置 $x_{\\text{probe}}$ 处的空间导数使用网格上的中心有限差分来近似：\n$$ \\frac{\\partial \\psi(x_j,t)}{\\partial x} \\approx \\frac{\\psi(x_{j+1},t) - \\psi(x_{j-1},t)}{2\\Delta x} $$\n其中 $x_j$ 是最接近 $x_{\\text{probe}}$ 的网格点。透射概率 $T$ 是在探测位置 $x_{\\text{probe}} = a/2 + 10$ 处正向电流的时间积分：\n$$ T \\;\\approx\\; \\sum_{n=0}^{N_t-1} \\max(J(x_{\\text{probe}}, t_n), 0) \\cdot \\Delta t $$\n其中 $t_n = n\\Delta t$ 且 $N_t = T_{\\text{end}}/\\Delta t$。此求和在整个模拟时间内执行。\n\n算法的流程是首先初始化网格、势和归一化波包。然后，时间演化循环将波函数向前传播。在每一步中，计算探测器处的电流密度，并将其正贡献加到积分的透射概率中。对指定的三个测试案例中的每一个都重复此过程。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom numpy.fft import fft, ifft, fftfreq\n\ndef run_simulation(k0, V0, a):\n    \"\"\"\n    Runs a single quantum wave packet simulation for a given set of parameters.\n\n    Args:\n        k0 (float): Initial mean wavenumber of the wave packet.\n        V0 (float): Height of the potential barrier.\n        a (float): Width of the potential barrier.\n\n    Returns:\n        float: The computed transmission probability.\n    \"\"\"\n    # 1. Simulation parameters common to all cases\n    x_min, x_max = -100.0, 100.0\n    N = 2048\n    dt = 0.05\n    t_end = 160.0\n    num_steps = int(t_end / dt)\n    x_cap = 20.0\n    eta = 0.02\n    x0 = -60.0\n    sigma = 1.5\n    \n    # 2. Setup spatial and momentum grids\n    x = np.linspace(x_min, x_max, N, endpoint=False)\n    dx = x[1] - x[0]\n    \n    k_freq = fftfreq(N, d=dx)\n    k = 2 * np.pi * k_freq\n    \n    # 3. Initial wave packet\n    psi0_unnorm = (1 / (2 * np.pi * sigma**2))**(1/4) * \\\n                  np.exp(-(x - x0)**2 / (4 * sigma**2)) * \\\n                  np.exp(1j * k0 * x)\n    \n    # Numerical normalization on the discrete grid\n    norm_const = np.sqrt(np.sum(np.abs(psi0_unnorm)**2) * dx)\n    psi = psi0_unnorm / norm_const\n    \n    # 4. Define the potential\n    # Real part: Rectangular barrier\n    x_B = 0.0\n    V_real = np.zeros_like(x)\n    V_real[np.abs(x - x_B) = a / 2] = V0\n    \n    # Imaginary part: Complex Absorbing Potential (CAP)\n    W = np.zeros_like(x)\n    \n    # Right boundary absorber\n    mask_right = x = (x_max - x_cap)\n    if np.any(mask_right):\n        s_right = (x[mask_right] - (x_max - x_cap)) / x_cap\n        W[mask_right] = eta * s_right**2\n        \n    # Left boundary absorber\n    mask_left = x = (x_min + x_cap)\n    if np.any(mask_left):\n        s_left = ((x_min + x_cap) - x[mask_left]) / x_cap\n        W[mask_left] = eta * s_left**2\n    \n    V_eff = V_real - 1j * W\n    \n    # 5. Define time-evolution operators for split-step method\n    exp_V = np.exp(-0.5j * V_eff * dt)\n    exp_T = np.exp(-0.5j * k**2 * dt)\n    \n    # 6. Setup probe for transmission calculation\n    x_probe = a / 2 + 10.0\n    probe_idx = np.argmin(np.abs(x - x_probe))\n    \n    total_transmission = 0.0\n    \n    # 7. Time-evolution loop\n    for _ in range(num_steps):\n        # Strang splitting propagation step\n        psi = exp_V * psi\n        psi_k = fft(psi)\n        psi_k = exp_T * psi_k\n        psi = ifft(psi_k)\n        psi = exp_V * psi\n        \n        # Calculate probability current density at the probe location\n        # Using a centered finite difference for the derivative\n        dpsi_dx_probe = (psi[probe_idx + 1] - psi[probe_idx - 1]) / (2 * dx)\n        current_density_probe = np.imag(np.conj(psi[probe_idx]) * dpsi_dx_probe)\n        \n        # Integrate the positive-directed flux over time\n        total_transmission += max(0, current_density_probe) * dt\n        \n    return total_transmission\n\ndef solve():\n    \"\"\"\n    Main solver function that orchestrates the simulation for all test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (1.5, 2.0, 4.0),  # Case 1\n        (0.8, 2.5, 6.0),  # Case 2\n        (2.5, 1.0, 4.0),  # Case 3\n    ]\n\n    results = []\n    for case in test_cases:\n        k0, V0, a = case\n        transmission = run_simulation(k0=k0, V0=V0, a=a)\n        results.append(f\"{transmission:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2460912"}, {"introduction": "在确定了隧穿的*概率*之后，一个很自然的问题随之而来：粒子在势垒区域*停留*了多长时间？这个练习引入了“驻留时间”的概念，它是量化粒子与势垒相互作用持续时间的一个关键物理量。通过在前一个模拟的基础上进行扩展，你将计算这个时间，从而能够更深入地洞察隧穿过程中的时间动力学特性。[@problem_id:2432546]", "problem": "考虑一个质量为 $m$ 的非相对论粒子在势 $V(x)$ 中运动，其波函数为 $\\psi(x,t)$，满足一维含时薛定谔方程 (TDSE)：\n$$\n\\mathrm{i}\\hbar\\,\\frac{\\partial \\psi}{\\partial t} \\;=\\; \\left(-\\frac{\\hbar^2}{2m}\\frac{\\partial^2}{\\partial x^2} + V(x)\\right)\\psi(x,t),\n$$\n其中，标准的概率密度 $\\rho(x,t)=|\\psi(x,t)|^2$ 和概率流密度 $J(x,t)$ 通过连续性方程关联：\n$$\n\\frac{\\partial \\rho}{\\partial t} + \\frac{\\partial J}{\\partial x} = 0.\n$$\n一个广泛用于衡量粒子穿越某个空间区域的定量指标是驻留时间，其定义为波包在该区域内的概率的时间积分。对于一个矩形势垒区域 $[x_a,x_b]$，驻留时间为：\n$$\n\\tau_D \\;=\\; \\int_{0}^{T} \\left(\\int_{x_a}^{x_b} |\\psi(x,t)|^2\\,dx\\right) dt,\n$$\n其中 $T$ 是一个足够大的最终时刻，以确保波包与势垒的相互作用在数值计算域内已经完成。\n\n任务。从 TDSE 和连续性方程这两个唯一的基本输入出发，推导一种计算方法，用于评估入射到矩形势垒上的高斯波包的驻留时间 $\\tau_D$。使用与 TDSE 一致的幺正时间演化方案，并通过数值方法实现开放边界，以防止模拟区域边缘的伪反射污染动力学过程。你需要将该算法实现为一个完整、可运行的计算机程序，该程序能够：\n- 建立一个空间网格，初始化一个具有指定平均动能的归一化高斯波包，并使其随时间演化，穿过一个矩形势垒。\n- 通过黎曼和数值计算驻留时间：\n$$\n\\tau_D \\approx \\sum_{n=0}^{N_t-1} \\left(\\sum_{i \\in \\mathcal{B}} |\\psi(x_i, t_n)|^2\\,\\Delta x\\right)\\Delta t,\n$$\n其中 $\\mathcal{B}$ 是满足 $x_i \\in [x_a,x_b]$ 的网格点索引集合，$\\Delta x$ 是网格间距，$\\Delta t$ 是时间步长， $N_t$ 是总时间 $T=N_t\\Delta t$ 内的时间步数。\n\n物理和数值设置。使用以下具有物理意义且自洽的参数和单位。所有输出必须以秒为单位表示。如果涉及角度，应以弧度处理。\n- 粒子质量 $m = 9.1093837015\\times 10^{-31}\\ \\mathrm{kg}$ (电子质量)，约化普朗克常数 $\\hbar = 1.054571817\\times 10^{-34}\\ \\mathrm{J\\,s}$，电子伏特 $1\\ \\mathrm{eV} = 1.602176634\\times 10^{-19}\\ \\mathrm{J}$。空间单位：$1\\ \\mathrm{nm}=10^{-9}\\ \\mathrm{m}$。\n- 空间域长度 $L_x = 400.0\\ \\mathrm{nm}$，用 $N_x = 2048$ 个等距点离散化；网格间距 $\\Delta x = L_x/N_x$。内部使用周期性空间变换，但通过在每个边界最外侧 $40.0\\ \\mathrm{nm}$ 范围内设置一个平滑变化的复数吸收势来抑制边缘反射。\n- 时间步长 $\\Delta t = 2.0\\times 10^{-16}\\ \\mathrm{s}$，步数 $N_t=6000$ (因此 $T=N_t\\Delta t$)。\n- 初始高斯波包中心位于 $x_0=80.0\\ \\mathrm{nm}$，包络宽度 $\\sigma_x=10.0\\ \\mathrm{nm}$，平均动能 $E_0=0.5\\ \\mathrm{eV}$。选择初始相位，使波包以平均波数 $k_0=\\sqrt{2mE_0}/\\hbar$ 沿 $+x$ 方向传播。\n- 矩形势垒中心位于 $x_c=200.0\\ \\mathrm{nm}$，高度为 $V_0$，宽度为 $w$，即当 $x\\in[x_c-w/2,\\, x_c+w/2]$ 时 $V(x)=V_0$，其他位置 $V(x)=0$。驻留时间区域 $[x_a,x_b]$ 与势垒区间完全相同。\n\n传播方法约束。以动能和势能演化算符的对称 Trotter 乘积形式，实现一个二阶精度的幺正时间步进器。在实践中，这可以通过使用快速傅里叶变换 (FFT; Fast Fourier Transform) 的动量空间分裂算符法来实现。\n\n测试套件。您的程序必须计算并返回以下四种情况下的驻留时间 $\\tau_D$（以秒为单位），这些情况共同探究了自由穿越、垒下减速、隧穿以及势垒宽度依赖性等现象：\n- 情况 A (自由区域参考)：$V_0=0.0\\ \\mathrm{eV}$，$w=40.0\\ \\mathrm{nm}$。\n- 情况 B (垒上传播)：$V_0=0.2\\ \\mathrm{eV}$，$w=40.0\\ \\mathrm{nm}$。\n- 情况 C (隧穿)：$V_0=0.8\\ \\mathrm{eV}$，$w=40.0\\ \\mathrm{nm}$。\n- 情况 D (隧穿，宽度增加)：$V_0=0.8\\ \\mathrm{eV}$，$w=80.0\\ \\mathrm{nm}$。\n\n最终输出规范。您的程序应生成单行输出，其中包含四个驻留时间，格式为用方括号括起来的逗号分隔列表，采用科学记数法，且恰好有六位有效数字，例如\n\"[1.234560e-12,2.345670e-12,3.456780e-12,4.567890e-12]\"。\n所有四个数字都必须以秒为单位，并按照上面定义的 A、B、C、D 顺序排列。不应打印任何其他文本。", "solution": "我们从质量为 $m$ 的粒子的一维含时薛定谔方程 (TDSE) 开始：\n$$\n\\mathrm{i}\\hbar\\,\\frac{\\partial \\psi(x,t)}{\\partial t} \\;=\\; \\left(-\\frac{\\hbar^2}{2m}\\frac{\\partial^2}{\\partial x^2} + V(x)\\right)\\psi(x,t).\n$$\nTDSE 意味着概率密度 $\\rho(x,t)=|\\psi(x,t)|^2$ 遵循连续性方程：\n$$\n\\frac{\\partial \\rho}{\\partial t} + \\frac{\\partial J}{\\partial x} = 0,\n$$\n其中流密度为 $J(x,t) = \\frac{\\hbar}{m}\\,\\mathrm{Im}\\left(\\psi^*(x,t)\\,\\partial_x \\psi(x,t)\\right)$。将连续性方程在一个固定的空间区间 $[x_a,x_b]$ 上积分，得到：\n$$\n\\frac{d}{dt}\\int_{x_a}^{x_b}\\rho(x,t)\\,dx = J(x_a,t)-J(x_b,t).\n$$\n将此式从 $t=0$ 积分到 $t=T$ 得到：\n$$\n\\int_{0}^{T}\\left(J(x_a,t)-J(x_b,t)\\right)dt = \\int_{x_a}^{x_b}\\rho(x,0)\\,dx - \\int_{x_a}^{x_b}\\rho(x,T)\\,dx.\n$$\n如果 $T$ 足够大，使得波包已经与势垒相互作用并离开了区域 $[x_a,x_b]$，同时仍很好地包含在数值计算域内，那么 $\\int_{x_a}^{x_b}\\rho(x,T)\\,dx\\approx 0$，并且通量积分等于该区域内的初始概率（如果波包从区域外开始，该初始概率通常也可忽略不计）。与这种通量平衡无关，一个直接且可操作的波包驻留时间定义是：\n$$\n\\tau_D \\;=\\; \\int_0^T \\left(\\int_{x_a}^{x_b} |\\psi(x,t)|^2\\,dx\\right) dt,\n$$\n即区域内概率的时间积分。该量具有时间的量纲，并且对于有限的 $T$ 和可忽略的晚期拖尾，其值为有限。\n\n为了计算 $\\tau_D$，我们需要准确而高效地演化 $\\psi(x,t)$。哈密顿算符可以分离为动能和势能部分，$\\hat{H}=\\hat{T}+\\hat{V}$，其中 $\\hat{T}=-\\frac{\\hbar^2}{2m}\\partial_x^2$ 且 $\\hat{V}=V(x)$。在一个小时间步长 $\\Delta t$ 内，形式上的时间演化算符为 $\\hat{U}(\\Delta t)=\\exp\\left(-\\frac{\\mathrm{i}}{\\hbar}\\hat{H}\\Delta t\\right)$。对称 Trotter 分解提供了一个二阶精度且幺正的近似：\n$$\n\\hat{U}(\\Delta t) \\;\\approx\\; e^{-\\frac{\\mathrm{i}}{\\hbar}\\hat{V}\\frac{\\Delta t}{2}}\\;e^{-\\frac{\\mathrm{i}}{\\hbar}\\hat{T}\\Delta t}\\;e^{-\\frac{\\mathrm{i}}{\\hbar}\\hat{V}\\frac{\\Delta t}{2}} \\;+\\; \\mathcal{O}(\\Delta t^3).\n$$\n在坐标表象中，$e^{-\\frac{\\mathrm{i}}{\\hbar}\\hat{V}\\frac{\\Delta t}{2}}$ 是对角的，将 $\\psi(x)$ 乘以 $e^{-\\frac{\\mathrm{i}}{\\hbar}V(x)\\frac{\\Delta t}{2}}$。在动量表象中，$e^{-\\frac{\\mathrm{i}}{\\hbar}\\hat{T}\\Delta t}$ 是对角的，将 $\\tilde{\\psi}(k)$ 乘以 $e^{-\\frac{\\mathrm{i}}{\\hbar}\\frac{\\hbar^2 k^2}{2m}\\Delta t}=e^{-\\mathrm{i}\\frac{\\hbar k^2}{2m}\\Delta t}$。因此，分裂算符法的步骤如下：\n- 在坐标空间中乘以半步势能相位因子。\n- 通过快速傅里叶变换 (FFT; Fast Fourier Transform) 转换到动量空间。\n- 在动量空间中乘以动能相位因子。\n- 通过逆 FFT 变换回到坐标空间。\n- 再次乘以半步势能相位因子。\n\n必须抑制边界反射以模拟开放系统，并防止波包被人为地重新引入势垒区域。一种标准方法是添加一个局域在计算域边缘的纯虚吸收势 $W(x)$，从而得到有效势 $V_{\\text{eff}}(x)=V(x)+W(x)$，其中 $W(x)\\le 0$ 是虚数，并从内部的 0 平滑地过渡到边界处的负虚数值。这种方法可以衰减出射的波分量，而不会显著干扰内部的动力学。\n\n离散化。我们将空间域 $[0,L_x]$ 离散为 $N_x$ 个点，间距为 $\\Delta x=L_x/N_x$，并使用离散 FFT 实现谱导数。动量网格由 $k_j = \\frac{2\\pi}{L_x}\\times$整数频率定义，与 FFT 的排序一致。$\\tau_D$ 的时间积分通过黎曼和近似为：\n$$\n\\tau_D \\approx \\sum_{n=0}^{N_t-1}\\left(\\sum_{i\\,:\\,x_i\\in[x_a,x_b]} |\\psi(x_i,t_n)|^2\\,\\Delta x\\right)\\Delta t.\n$$\n这与基本定义一致，并且当 $\\Delta x,\\Delta t\\to 0$ 时收敛。\n\n初始化。初始高斯波包为：\n$$\n\\psi(x,0) = \\left(\\frac{1}{2\\pi\\sigma_x^2}\\right)^{1/4}\\exp\\left(-\\frac{(x-x_0)^2}{4\\sigma_x^2} + \\mathrm{i}k_0(x-x_0)\\right),\n$$\n其中 $k_0=\\sqrt{2mE_0}/\\hbar$。波包在离散网格上进行数值归一化，以确保 $\\int |\\psi(x,0)|^2 dx=1$。\n\n针对每个测试案例 $(V_0,w)$ 的算法摘要：\n1. 构建矩形势垒：在 $[x_c-w/2,x_c+w/2]$ 上 $V(x)=V_0$，其他位置为零。\n2. 构建复数吸收势：在 $[0,x_L]$ 和 $[L_x-x_L,L_x]$ 上构建一个宽度为 $x_L$ 且具有指定强度的平滑多项式斜坡形式的复数吸收势 $W(x)$，然后设置 $V_{\\text{eff}}(x)=V(x)+W(x)$。\n3. 预先计算动能相位因子 $e^{-\\mathrm{i}\\frac{\\hbar k^2}{2m}\\Delta t}$ 和坐标空间中的半步势能因子 $e^{-\\frac{\\mathrm{i}}{\\hbar}V_{\\text{eff}}(x)\\frac{\\Delta t}{2}}$。\n4. 初始化 $\\psi(x,0)$ 并进行归一化。\n5. 对于 $n=0,\\dots,N_t-1$：\n   - 应用分裂算符步骤将 $\\psi$ 演化 $\\Delta t$。\n   - 通过 $\\tau_D\\mathrel{+}=P_{\\mathcal{B}}(t_n)\\Delta t$ 将势垒区域的概率 $P_{\\mathcal{B}}(t_n)=\\sum_{x_i\\in[x_a,x_b]}|\\psi(x_i,t_n)|^2\\Delta x$ 累加到 $\\tau_D$ 中。\n6. 返回 $\\tau_D$。\n\n参数选择。当 $L_x=400.0\\,\\mathrm{nm}$，$N_x=2048$，$\\Delta t=2.0\\times 10^{-16}\\,\\mathrm{s}$，$N_t=6000$，$x_0=80.0\\,\\mathrm{nm}$，$\\sigma_x=10.0\\,\\mathrm{nm}$，$E_0=0.5\\,\\mathrm{eV}$，且势垒中心 $x_c=200.0\\,\\mathrm{nm}$ 时，波包在远小于总时间 $T=N_t\\Delta t$ 内到达并穿过势垒，而边缘的吸收区域（每侧宽度 $40.0\\,\\mathrm{nm}$）可防止因 FFT 内在周期性导致的环绕效应。吸收势的强度被选择为使得 $\\exp\\left(-\\mathrm{Im}[W]\\Delta t/\\hbar\\right)$ 在边缘附近提供强烈的衰减，而在内部区域则可忽略不计。\n\n测试套件的定性预期：\n- 情况 A ($V_0=0.0\\,\\mathrm{eV}$，$w=40.0\\,\\mathrm{nm}$)：$\\tau_D$ 近似于波包概率穿过一个宽度为 $w$ 的窗口所需的自由穿越时间，大约为 $w/v_g$，其中群速度为 $v_g=\\hbar k_0/m$，该近似忽略了波包展宽效应。\n- 情况 B ($V_0=0.2\\,\\mathrm{eV}", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef gaussian_wavepacket(x, x0, sigma, k0):\n    \"\"\"Unnormalized Gaussian wave packet centered at x0 with spatial width sigma and mean wave number k0.\"\"\"\n    return np.exp(-((x - x0) ** 2) / (4.0 * sigma ** 2) + 1j * k0 * (x - x0)) / ((2.0 * np.pi * sigma ** 2) ** 0.25)\n\ndef complex_absorbing_potential(x, Lx, width, strength_J, power=2):\n    \"\"\"\n    Construct a smooth complex absorbing potential W(x) that is purely imaginary and negative, localized within\n    [0, width] and [Lx - width, Lx]. The profile ramps as (s/width)^power where s is distance into the absorber.\n    strength_J sets the maximum |Im(W)| at the boundary in Joules.\n    \"\"\"\n    W = np.zeros_like(x, dtype=np.complex128)\n    # Left absorber\n    mask_left = x = width\n    s_left = width - x[mask_left]  # distance from inner edge of absorber\n    profile_left = (s_left / width) ** power\n    W[mask_left] += -1j * strength_J * profile_left\n    # Right absorber\n    mask_right = x  (Lx - width)\n    s_right = x[mask_right] - (Lx - width)  # distance into right absorber\n    profile_right = (s_right / width) ** power\n    W[mask_right] += -1j * strength_J * profile_right\n    return W\n\ndef simulate_dwell_time(V0_eV, width_nm, constants, numerics):\n    \"\"\"\n    Simulate the dwell time for a Gaussian wave packet encountering a rectangular barrier.\n    V0_eV: barrier height in eV\n    width_nm: barrier width in nm\n    constants: dict with physical constants and conversions\n    numerics: dict with numerical parameters\n    Returns dwell time tau_D in seconds (float).\n    \"\"\"\n    # Unpack constants\n    m = constants[\"m\"]\n    hbar = constants[\"hbar\"]\n    eV_to_J = constants[\"eV_to_J\"]\n    nm_to_m = constants[\"nm_to_m\"]\n\n    # Unpack numerics\n    Lx_nm = numerics[\"Lx_nm\"]\n    Nx = numerics[\"Nx\"]\n    dt = numerics[\"dt\"]\n    Nt = numerics[\"Nt\"]\n    x0_nm = numerics[\"x0_nm\"]\n    sigma_nm = numerics[\"sigma_nm\"]\n    E0_eV = numerics[\"E0_eV\"]\n    xc_nm = numerics[\"xc_nm\"]\n    absorber_width_nm = numerics[\"absorber_width_nm\"]\n    absorber_strength_eV = numerics[\"absorber_strength_eV\"]\n    absorber_power = numerics[\"absorber_power\"]\n\n    # Convert to SI units\n    Lx = Lx_nm * nm_to_m\n    x0 = x0_nm * nm_to_m\n    sigma = sigma_nm * nm_to_m\n    xc = xc_nm * nm_to_m\n    width = width_nm * nm_to_m\n    absorber_width = absorber_width_nm * nm_to_m\n    V0 = V0_eV * eV_to_J\n    E0 = E0_eV * eV_to_J\n    absorber_strength_J = absorber_strength_eV * eV_to_J\n\n    # Spatial grid\n    dx = Lx / Nx\n    x = np.linspace(0.0, Lx, Nx, endpoint=False)  # grid points\n\n    # Momentum grid (FFT frequencies)\n    k = 2.0 * np.pi * np.fft.fftfreq(Nx, d=dx)\n\n    # Initial wave number from kinetic energy\n    k0 = np.sqrt(2.0 * m * E0) / hbar\n\n    # Initialize wavefunction and normalize\n    psi = gaussian_wavepacket(x, x0, sigma, k0)\n    norm = np.sqrt(np.sum(np.abs(psi) ** 2) * dx)\n    psi /= norm\n\n    # Build rectangular barrier potential V(x)\n    xa = xc - 0.5 * width\n    xb = xc + 0.5 * width\n    V = np.zeros_like(x)\n    if width > 0:\n        mask_barrier = (x = xa)  (x = xb)\n        V[mask_barrier] = V0\n\n    # Complex absorbing potential at edges\n    W = complex_absorbing_potential(x, Lx, absorber_width, absorber_strength_J, power=absorber_power)\n\n    # Effective potential and split-operator factors\n    Veff = V + W\n    expV_half = np.exp(-1j * Veff * (dt / (2.0 * hbar)))\n    expK = np.exp(-1j * (hbar * k ** 2) * (dt / (2.0 * m)))\n\n    # Barrier-region indices for dwell time\n    in_region = (x = xa)  (x = xb)\n    # If width is zero, dwell time is trivially zero; allow code to handle gracefully (no indices in region)\n    region_dx = dx\n\n    # Time propagation loop with dwell-time accumulation\n    tau_D = 0.0\n    for _ in range(Nt):\n        # Half potential step\n        psi *= expV_half\n        # Kinetic step via FFT\n        psi_k = np.fft.fft(psi)\n        psi_k *= expK\n        psi = np.fft.ifft(psi_k)\n        # Half potential step\n        psi *= expV_half\n        # Accumulate probability in barrier region\n        if np.any(in_region):\n            P_region = np.sum(np.abs(psi[in_region]) ** 2) * region_dx\n        else:\n            P_region = 0.0\n        tau_D += P_region * dt\n\n    # Return dwell time in seconds\n    return float(np.real_if_close(tau_D))\n\ndef solve():\n    # Physical constants\n    constants = {\n        \"m\": 9.1093837015e-31,            # kg (electron mass)\n        \"hbar\": 1.054571817e-34,          # J*s\n        \"eV_to_J\": 1.602176634e-19,       # J per eV\n        \"nm_to_m\": 1e-9,                  # meters per nm\n    }\n\n    # Numerical parameters\n    numerics = {\n        \"Lx_nm\": 400.0,                  # domain length in nm\n        \"Nx\": 2048,                      # number of spatial grid points\n        \"dt\": 2.0e-16,                   # time step in s\n        \"Nt\": 6000,                      # number of time steps\n        \"x0_nm\": 80.0,                   # initial packet center in nm\n        \"sigma_nm\": 10.0,                # spatial width in nm\n        \"E0_eV\": 0.5,                    # mean kinetic energy in eV\n        \"xc_nm\": 200.0,                  # barrier center in nm\n        \"absorber_width_nm\": 40.0,       # absorber width in nm (each side)\n        \"absorber_strength_eV\": 0.2,     # maximum imaginary strength at boundary (eV)\n        \"absorber_power\": 2,             # polynomial power of absorber ramp\n    }\n\n    # Define the test cases (V0 in eV, width in nm)\n    test_cases = [\n        (0.0, 40.0),   # Case A: free region (V0=0), width=40 nm\n        (0.2, 40.0),   # Case B: above-barrier propagation\n        (0.8, 40.0),   # Case C: tunneling\n        (0.8, 80.0),   # Case D: tunneling with increased width\n    ]\n\n    # Precompute k-dependent quantities that are independent of the barrier would require expK,\n    # but expK depends only on numerics and constants; it is created inside simulate_dwell_time.\n    # We run simulations sequentially.\n    results = []\n    for V0_eV, w_nm in test_cases:\n        tau = simulate_dwell_time(V0_eV, w_nm, constants, numerics)\n        results.append(tau)\n\n    # Format results: scientific notation with exactly six significant digits\n    formatted = \"[\" + \",\".join(f\"{val:.6e}\" for val in results) + \"]\"\n    print(formatted)\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2432546"}, {"introduction": "计算物理学常常为同一个问题提供多种求解途径，每种途径都有其独特的优势。最后的这个实践练习将为你展示一种巧妙的替代方法，即利用复吸收势 (CAPs) 来计算隧穿概率。在这种方法中，你将不再需要监测空间中某个特定点的通量，而是通过测量在模拟区域边界被吸收的总概率来推算出波包的透射与反射份额，这为验证计算结果提供了一种稳健且自洽的手段。[@problem_id:2440902]", "problem": "考虑哈特里原子单位制下的一维含时薛定谔方程（在该单位制中，约化普朗克常数设为 $1$，电子质量设为 $1$，基本电荷设为 $1$，玻尔半径为长度单位）：\n$$\ni\\,\\partial_t \\psi(x,t) \\;=\\; \\left[-\\frac{1}{2}\\,\\partial_{xx} \\;+\\; V(x)\\right] \\psi(x,t).\n$$\n一个初始位于位置 $x_0$、平均波数为 $k_0$ 的高斯波包向位于 $x=0$ 中心的矩形势垒发射。初始状态为\n$$\n\\psi(x,0) \\;=\\; \\frac{1}{(\\pi \\sigma^2)^{1/4}} \\exp\\!\\left(-\\frac{(x-x_0)^2}{2\\sigma^2}\\right)\\, \\exp(i\\,k_0 x),\n$$\n在连续极限下归一化为1。矩形势垒为\n$$\nV(x) \\;=\\; \\begin{cases}\nV_0,  |x| \\le a/2, \\\\\n0,  \\text{其他情况}.\n\\end{cases}\n$$\n为了在周期性傅里叶离散化中防止计算边界产生非物理反射，添加一个复吸收势 (complex absorbing potential, CAP) $-i\\,W(x)$，其中 $W(x)\\ge 0$ 是一个平滑函数，仅在靠近左右区域边缘的边界层中非零。此时，控制方程变为\n$$\ni\\,\\partial_t \\psi(x,t) \\;=\\; \\left[-\\frac{1}{2}\\,\\partial_{xx} \\;+\\; V(x) \\;-\\; i\\,W(x)\\right] \\psi(x,t).\n$$\n\n你的任务是为此问题推导并实现一个分裂步傅里叶（Strang 分裂）格式，然后用它来估计波包穿过势垒的量子透射概率。该估计必须基于存在 CAP 时的概率守恒。具体来说，当哈密顿量包含 $-i\\,W(x)$ 时，概率密度 $\\rho=\\lvert\\psi\\rvert^2$ 遵循\n$$\n\\frac{d}{dt} \\int \\rho(x,t)\\,dx \\;=\\; -2 \\int W(x)\\,\\rho(x,t)\\,dx,\n$$\n因此，直到时间 $T$ 的总吸收概率为\n$$\n\\mathcal{A}(T) \\;=\\; 2\\int_0^T \\!\\! dt \\int W(x)\\,\\lvert \\psi(x,t)\\rvert^2\\,dx.\n$$\n设 $W(x)$ 分解为左、右分量 $W(x)=W_\\text{L}(x)+W_\\text{R}(x)$，它们分别仅在左、右区域边界附近有支撑。定义右吸收概率\n$$\n\\mathcal{A}_\\text{R}(T) \\;=\\; 2\\int_0^T \\!\\! dt \\int W_\\text{R}(x)\\,\\lvert \\psi(x,t)\\rvert^2\\,dx,\n$$\n类似地，通过将 $W_\\text{R}$ 替换为 $W_\\text{L}$ 来定义左吸收概率 $\\mathcal{A}_\\text{L}(T)$。对于足够大的最终时间 $T$ 和足够有效的吸收，透射概率可以估计为\n$$\n\\mathcal{T} \\;\\approx\\; \\frac{\\mathcal{A}_\\text{R}(T)}{\\mathcal{A}_\\text{L}(T)+\\mathcal{A}_\\text{R}(T)}.\n$$\n\n通过分裂由动能算符 $T = -\\frac{1}{2}\\partial_{xx}$（在傅里叶空间中应用）和复势 $U(x)=V(x)-iW(x)$（在实空间中应用）生成的时间演化算符，推导单个时间步长 $\\Delta t$ 的二阶精度 Strang 分裂格式。使用离散傅里叶变换以谱方法表示导数：如果 $\\widehat{\\psi}(k,t)$ 是周期域上 $\\psi(x,t)$ 的傅里叶变换，那么 $\\partial_{xx}\\psi$ 对应于在 $k$ 空间中乘以 $-k^2$。解释为什么这会为每个时间步带来一个高效的算法。\n\n在哈特里原子单位制中实现以下数值设置：\n- 空间域长度 $L = 60$（玻尔半径），周期性，用 $N = 1024$ 个等距点离散化，因此 $\\Delta x = L/N$。\n- 时间步长 $\\Delta t = 0.02$（原子时间单位）和总模拟时间 $T_\\text{final} = 60$（原子时间单位）。\n- 复吸收势由区域两端宽度为 $w_\\text{cap} = 8$、强度参数为 $\\eta = 1.0$ 的二次斜坡定义：\n  - 对于右侧层，$W_\\text{R}(x) = \\eta\\, s^2$，其中 $s = \\max\\{0, (x - (L/2 - w_\\text{cap}))/w_\\text{cap}\\}$。\n  - 对于左侧层，$W_\\text{L}(x) = \\eta\\, s^2$，其中 $s = \\max\\{0, ((-L/2 + w_\\text{cap}) - x)/w_\\text{cap}\\}$。\n- 势垒中心在 $x=0$，如上定义。\n- 初始波包参数：$x_0 = -15$，$\\sigma = 1.5$。\n\n在你的时间积分器中，使用中间步状态通过以下方式近似每个时间步的吸收概率\n$$\n\\Delta \\mathcal{A}_\\text{R} \\approx 2\\,\\Delta t \\int W_\\text{R}(x)\\,\\lvert \\psi(x,t+\\Delta t/2)\\rvert^2\\,dx,\\quad\n\\Delta \\mathcal{A}_\\text{L} \\approx 2\\,\\Delta t \\int W_\\text{L}(x)\\,\\lvert \\psi(x,t+\\Delta t/2)\\rvert^2\\,dx,\n$$\n并在所有步骤中累积这些值以获得 $\\mathcal{A}_\\text{R}(T_\\text{final})$ 和 $\\mathcal{A}_\\text{L}(T_\\text{final})$。\n\n测试套件。为以下测试用例列表运行你的程序，每个用例由 $(V_0, a, k_0)$ 指定，其中 $V_0$ 的单位是哈特里，$a$ 的单位是玻尔半径，$k_0$ 的单位是反玻尔半径：\n- 案例 1：$(V_0, a, k_0) = (1.0, 5.0, 1.0)$。\n- 案例 2：$(V_0, a, k_0) = (0.5, 5.0, 1.0)$。\n- 案例 3：$(V_0, a, k_0) = (0.0, 0.0, 1.0)$。\n- 案例 4：$(V_0, a, k_0) = (0.2, 10.0, 1.5)$。\n\n要求的最终输出。你的程序必须生成单行文本，其中包含四个案例的透射概率，形式为用方括号括起来的逗号分隔列表，每个值四舍五入到四位小数，并表示为无量纲的十进制数。例如，输出格式必须严格符合 `[0.1234,0.5678,0.9012,0.3456]` 的形式。不应打印任何其他文本。如有角度，必须以弧度为单位进行解释。输出不需要额外的单位，因为概率是无量纲的。", "solution": "所提供的问题陈述是计算量子力学中一个适定且科学上合理的问题。它要求使用含时薛定谔方程模拟波包从势垒散射的过程。所有参数和方法都已明确定义，物理模型是标准的。因此，该问题是有效的，我将着手解决它。\n\n控制方程是带复势的一维含时薛定谔方程，在哈特里原子单位制中表示为：\n$$\ni\\,\\partial_t \\psi(x,t) \\;=\\; \\hat{H}\\psi(x,t) \\;=\\; \\left[-\\frac{1}{2}\\,\\partial_{xx} \\;+\\; V(x) \\;-\\; i\\,W(x)\\right] \\psi(x,t)\n$$\n在这里，哈密顿量 $\\hat{H}$ 被分裂为动能算符 $\\hat{T} = -\\frac{1}{2}\\partial_{xx}$ 和一个复势算符 $\\hat{U}(x) = V(x) - iW(x)$，其中 $\\hat{U}$ 在位置基中是一个简单的乘法算符。包含复吸收势 (CAP) $-iW(x)$ 是为了在计算区域的边界吸收波函数，以防止在周期性设置中出现非物理反射。\n\n该方程在一个时间步长 $\\Delta t$ 内演化的形式解是 $\\psi(t+\\Delta t) = e^{-i\\hat{H}\\Delta t}\\psi(t)$。由于动能算符和势算符不对易，即 $[\\hat{T}, \\hat{U}] \\neq 0$，指数函数必须进行近似。我们采用二阶 Strang 分裂格式（也称为对称 Trotter-Suzuki 分解），其形式如下：\n$$\ne^{-i(\\hat{T}+\\hat{U})\\Delta t} \\;=\\; e^{-i\\hat{U}\\frac{\\Delta t}{2}} e^{-i\\hat{T}\\Delta t} e^{-i\\hat{U}\\frac{\\Delta t}{2}} \\;+\\; \\mathcal{O}(\\Delta t^3)\n$$\n该分解提供了一个将波函数 $\\psi(x,t)$ 从时间 $t$ 演化到 $t+\\Delta t$ 的方案，每步误差为 $\\mathcal{O}(\\Delta t^3)$ 阶，导致全局误差为 $\\mathcal{O}(\\Delta t^2)$ 阶。单个时间步的演化是通过一系列三个更简单的操作来执行的：\n\n1.  **势能半步：** 在势 $\\hat{U}$ 下演化 $\\Delta t/2$ 的时长。由于 $\\hat{U}$ 在位置空间中是一个乘法算符，此步骤实现为逐点相乘：\n    $$\n    \\psi'(x,t) \\;=\\; e^{-i\\hat{U}(x)\\frac{\\Delta t}{2}} \\psi(x,t)\n    $$\n\n2.  **动能全步：** 在动能算符 $\\hat{T}$ 下演化 $\\Delta t$ 的时长。算符 $\\hat{T} = -\\frac{1}{2}\\partial_{xx}$ 在位置空间中是一个微分算符，这使得其直接应用变得复杂。然而，在傅里叶（波数）空间中，算符 $\\partial_{xx}$ 对应于乘以 $(ik)^2 = -k^2$。因此，动能演化算符对应于乘以 $e^{-i(k^2/2)\\Delta t}$。此步骤使用快速傅里叶变换 (FFT) 算法高效实现：\n    a. 将波函数变换到傅里叶空间：$\\hat{\\psi}'(k,t) = \\mathcal{F}\\{\\psi'(x,t)\\}$。\n    b. 应用动能演化算符：$\\hat{\\psi}''(k,t) = e^{-i\\frac{k^2}{2}\\Delta t} \\hat{\\psi}'(k,t)$。\n    c. 变换回位置空间：$\\psi''(x,t) = \\mathcal{F}^{-1}\\{\\hat{\\psi}''(k,t)\\}$。\n    这种分裂步傅里叶方法的效率源于 FFT，它将此步骤的计算复杂度从 $\\mathcal{O}(N^2)$ 降低到 $\\mathcal{O}(N \\log N)$（对于大小为 $N$ 的网格）。\n\n3.  **势能半步：** 再次在势 $\\hat{U}$ 下演化 $\\Delta t/2$ 的时长：\n    $$\n    \\psi(x,t+\\Delta t) \\;=\\; e^{-i\\hat{U}(x)\\frac{\\Delta t}{2}} \\psi''(x,t)\n    $$\n\n这个三步过程构成了一个时间步的算法。为了模拟到最终时间 $T_\\text{final}$，此过程需要迭代 $N_t = T_\\text{final}/\\Delta t$ 次。\n\n透射概率 $\\mathcal{T}$ 通过计算右侧 CAP 吸收的总概率 $\\mathcal{A}_\\text{R}(T)$ 和左侧 CAP 吸收的总概率 $\\mathcal{A}_\\text{L}(T)$ 来估计。直到时间 $T$，右侧 CAP 中吸收的总概率由以下积分给出：\n$$\n\\mathcal{A}_\\text{R}(T) \\;=\\; 2\\int_0^T \\!\\! dt \\int W_\\text{R}(x)\\,\\lvert \\psi(x,t)\\rvert^2\\,dx\n$$\n我们对这个积分进行数值近似。时间积分使用中点法则进行近似，这与 Strang 分裂的二阶精度相符。对于从 $t$ 到 $t+\\Delta t$ 的每个时间步，我们使用‘中间步’波函数，我们将其确定为完成动能全步之后的状态 $\\psi''(x,t)$。因此，一个时间步内吸收概率的变化为：\n$$\n\\Delta \\mathcal{A}_\\text{R} \\approx 2\\,\\Delta t \\int W_\\text{R}(x)\\,\\lvert \\psi''(x,t)\\rvert^2\\,dx\n$$\n空间积分通过对离散网格点 $x_j$（间距为 $\\Delta x = L/N$）求和来近似：\n$$\n\\int W_\\text{R}(x)\\,\\lvert \\psi''(x,t)\\rvert^2\\,dx \\;\\approx\\; \\Delta x \\sum_{j=0}^{N-1} W_\\text{R}(x_j)\\,\\lvert \\psi''(x_j,t)\\rvert^2\n$$\n通过在所有时间步上对这些贡献 $\\Delta \\mathcal{A}_\\text{R}$ 和 $\\Delta \\mathcal{A}_\\text{L}$ 求和，可以找到总吸收概率 $\\mathcal{A}_\\text{R}(T_\\text{final})$ 和 $\\mathcal{A}_\\text{L}(T_\\text{final})$。最后，透射概率计算为以下比率：\n$$\n\\mathcal{T} \\;\\approx\\; \\frac{\\mathcal{A}_\\text{R}(T_\\text{final})}{\\mathcal{A}_\\text{L}(T_\\text{final})+\\mathcal{A}_\\text{R}(T_\\text{final})}\n$$\n该比率衡量了散射波包向右传播的部分。\n\n实现过程将首先设置空间网格和相应的波数网格。然后，对于每个测试用例，定义初始状态和势函数（$V(x)$, $W_L(x)$, $W_R(x)$）。预先计算势能步和动能步的指数算符。然后，模拟进行时间循环，应用分裂步算法并在每一步累积吸收的概率。最后，计算并存储透射概率。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the 1D time-dependent Schrödinger equation for wave packet scattering\n    using a split-step Fourier method and calculates the transmission probability.\n    \"\"\"\n\n    # --- Numerical and Physical Parameters ---\n    # Spatial domain\n    L = 60.0  # Length of the domain (Bohr radii)\n    N = 1024  # Number of grid points\n    \n    # Time domain\n    dt = 0.02  # Time step (atomic time units)\n    T_final = 60.0  # Total simulation time (atomic time units)\n    \n    # Complex Absorbing Potential (CAP) parameters\n    w_cap = 8.0  # Width of the CAP layers (Bohr radii)\n    eta = 1.0  # Strength of the CAP\n\n    # Initial wave packet parameters\n    x0 = -15.0  # Initial position (Bohr radii)\n    sigma = 1.5  # Initial width (Bohr radii)\n\n    # --- Grid Setup ---\n    x = np.linspace(-L / 2, L / 2, N, endpoint=False)\n    dx = L / N\n    k = 2 * np.pi * np.fft.fftfreq(N, d=dx)\n\n    # --- Define Test Cases ---\n    test_cases = [\n        # (V0, a, k0)\n        (1.0, 5.0, 1.0),\n        (0.5, 5.0, 1.0),\n        (0.0, 0.0, 1.0),\n        (0.2, 10.0, 1.5),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        V0, a, k0 = case\n\n        # --- Define Potentials and Initial State ---\n        # Rectangular potential barrier V(x)\n        V = np.zeros(N)\n        V[np.abs(x) = a / 2] = V0\n\n        # Complex absorbing potential W(x) = W_L(x) + W_R(x)\n        W_L = np.zeros(N)\n        W_R = np.zeros(N)\n\n        x_L_end = -L / 2 + w_cap\n        x_R_start = L / 2 - w_cap\n\n        s_L = np.maximum(0, (x_L_end - x) / w_cap)\n        W_L = eta * s_L**2\n\n        s_R = np.maximum(0, (x - x_R_start) / w_cap)\n        W_R = eta * s_R**2\n\n        W = W_L + W_R\n        \n        # Total complex potential U(x)\n        U = V - 1j * W\n\n        # Initial wave packet psi(x, 0)\n        norm_factor = (np.pi * sigma**2)**(-0.25)\n        psi = norm_factor * np.exp(-(x - x0)**2 / (2 * sigma**2)) * np.exp(1j * k0 * x)\n        \n        # --- Pre-calculate Evolution Operators ---\n        exp_U_half = np.exp(-1j * U * dt / 2)\n        exp_T_full = np.exp(-1j * (k**2 / 2) * dt)\n\n        # --- Time Evolution Loop ---\n        num_steps = int(T_final / dt)\n        A_L, A_R = 0.0, 0.0\n\n        for _ in range(num_steps):\n            # First half potential step\n            psi = exp_U_half * psi\n\n            # Full kinetic step in Fourier space\n            psi_k = np.fft.fft(psi)\n            psi_k_evolved = exp_T_full * psi_k\n            psi_mid = np.fft.ifft(psi_k_evolved)\n\n            # Accumulate absorbed probability from the mid-step state\n            rho_mid = np.abs(psi_mid)**2\n            \n            A_R_step = 2 * dt * np.sum(W_R * rho_mid) * dx\n            A_L_step = 2 * dt * np.sum(W_L * rho_mid) * dx\n            A_R += A_R_step\n            A_L += A_L_step\n\n            # Second half potential step\n            psi = exp_U_half * psi_mid\n\n        # --- Calculate Transmission Probability ---\n        total_absorbed = A_L + A_R\n        if total_absorbed  1e-12: # Avoid division by zero\n            T_prob = A_R / total_absorbed\n        else:\n            T_prob = 0.0\n\n        results.append(f\"{T_prob:.4f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2440902"}]}