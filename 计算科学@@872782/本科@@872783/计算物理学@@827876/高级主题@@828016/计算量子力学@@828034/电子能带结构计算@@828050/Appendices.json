{"hands_on_practices": [{"introduction": "在进行任何能带结构计算之前，我们必须首先掌握倒易空间的概念，它是晶体中电子的“动量空间”。这个练习将帮助你掌握一项基本技能：将实空间晶格矢量转换为倒易空间矢量。我们以大名鼎鼎的石墨烯为具体实例，为后续更复杂的计算打下坚实的几何基础。[@problem_id:1774232]", "problem": "一位固态物理学家正在开发一个计算模型，以研究石墨烯的电子能带结构。石墨烯是一种由排列成六角晶格的碳原子组成的二维材料。一个关键的初始步骤是建立倒易晶格的几何结构，因为涉及电子波函数的计算依赖于在k空间（动量空间）中的分析。\n\n该物理学家定义了一个笛卡尔坐标系 $(\\hat{i}, \\hat{j})$，并使用以下原胞基矢来描述实空间布拉菲晶格，其中 $a$ 是恒定的碳-碳键长：\n$$\n\\vec{a}_1 = \\frac{a}{2}(3\\hat{i} + \\sqrt{3}\\hat{j})\n$$\n$$\n\\vec{a}_2 = \\frac{a}{2}(3\\hat{i} - \\sqrt{3}\\hat{j})\n$$\n倒易晶格原胞基矢，记作 $\\vec{b}_1$ 和 $\\vec{b}_2$，由基本关系 $\\vec{a}_i \\cdot \\vec{b}_j = 2\\pi \\delta_{ij}$ 定义，其中 $i, j \\in \\{1, 2\\}$ 且 $\\delta_{ij}$ 是克罗内克δ函数。\n\n你的任务是确定这些倒易晶格原胞基矢的笛卡尔分量。将这些矢量表示为 $\\vec{b}_1 = b_{1x}\\hat{i} + b_{1y}\\hat{j}$ 和 $\\vec{b}_2 = b_{2x}\\hat{i} + b_{2y}\\hat{j}$。请以键长 $a$ 的符号表达式形式，找出这四个分量（$b_{1x}, b_{1y}, b_{2x}, b_{2y}$）。", "solution": "问题要求我们找出与给定的实空间原胞基矢 $\\vec{a}_1$ 和 $\\vec{a}_2$ 相对应的倒易晶格原胞基矢 $\\vec{b}_1$ 和 $\\vec{b}_2$。它们之间的关系由 $\\vec{a}_i \\cdot \\vec{b}_j = 2\\pi \\delta_{ij}$ 给出。\n\n让我们将这些矢量以分量形式写出：\n$\\vec{a}_1 = \\left( \\frac{3a}{2}, \\frac{\\sqrt{3}a}{2} \\right)$\n$\\vec{a}_2 = \\left( \\frac{3a}{2}, -\\frac{\\sqrt{3}a}{2} \\right)$\n以及未知的倒易矢量：\n$\\vec{b}_1 = (b_{1x}, b_{1y})$\n$\\vec{b}_2 = (b_{2x}, b_{2y})$\n\n定义关系给出了一个包含四个方程的方程组：\n1. $\\vec{a}_1 \\cdot \\vec{b}_1 = 2\\pi$\n2. $\\vec{a}_1 \\cdot \\vec{b}_2 = 0$\n3. $\\vec{a}_2 \\cdot \\vec{b}_1 = 0$\n4. $\\vec{a}_2 \\cdot \\vec{b}_2 = 2\\pi$\n\n首先，我们使用方程(1)和(3)求解 $\\vec{b}_1$ 的分量。\n方程(3)为 $\\vec{a}_2 \\cdot \\vec{b}_1 = 0$：\n$$\n\\left( \\frac{3a}{2} \\right) b_{1x} + \\left( -\\frac{\\sqrt{3}a}{2} \\right) b_{1y} = 0\n$$\n$$\n\\frac{3a}{2} b_{1x} = \\frac{\\sqrt{3}a}{2} b_{1y}\n$$\n$$\n3 b_{1x} = \\sqrt{3} b_{1y} \\implies b_{1y} = \\sqrt{3} b_{1x}\n$$\n现在我们将此结果代入方程(1)，$\\vec{a}_1 \\cdot \\vec{b}_1 = 2\\pi$：\n$$\n\\left( \\frac{3a}{2} \\right) b_{1x} + \\left( \\frac{\\sqrt{3}a}{2} \\right) b_{1y} = 2\\pi\n$$\n代入 $b_{1y} = \\sqrt{3} b_{1x}$：\n$$\n\\frac{3a}{2} b_{1x} + \\frac{\\sqrt{3}a}{2} (\\sqrt{3} b_{1x}) = 2\\pi\n$$\n$$\n\\frac{3a}{2} b_{1x} + \\frac{3a}{2} b_{1x} = 2\\pi\n$$\n$$\n3a b_{1x} = 2\\pi \\implies b_{1x} = \\frac{2\\pi}{3a}\n$$\n现在求 $b_{1y}$：\n$$\nb_{1y} = \\sqrt{3} b_{1x} = \\sqrt{3} \\left( \\frac{2\\pi}{3a} \\right) = \\frac{2\\sqrt{3}\\pi}{3a}\n$$\n所以，第一个倒易晶格矢量是 $\\vec{b}_1 = \\frac{2\\pi}{3a} \\hat{i} + \\frac{2\\sqrt{3}\\pi}{3a} \\hat{j}$。\n\n接下来，我们使用方程(2)和(4)求解 $\\vec{b}_2$ 的分量。\n方程(2)为 $\\vec{a}_1 \\cdot \\vec{b}_2 = 0$：\n$$\n\\left( \\frac{3a}{2} \\right) b_{2x} + \\left( \\frac{\\sqrt{3}a}{2} \\right) b_{2y} = 0\n$$\n$$\n\\frac{3a}{2} b_{2x} = -\\frac{\\sqrt{3}a}{2} b_{2y}\n$$\n$$\n3 b_{2x} = -\\sqrt{3} b_{2y} \\implies b_{2y} = -\\sqrt{3} b_{2x}\n$$\n现在我们将此结果代入方程(4)，$\\vec{a}_2 \\cdot \\vec{b}_2 = 2\\pi$：\n$$\n\\left( \\frac{3a}{2} \\right) b_{2x} + \\left( -\\frac{\\sqrt{3}a}{2} \\right) b_{2y} = 2\\pi\n$$\n代入 $b_{2y} = -\\sqrt{3} b_{2x}$：\n$$\n\\frac{3a}{2} b_{2x} - \\frac{\\sqrt{3}a}{2} (-\\sqrt{3} b_{2x}) = 2\\pi\n$$\n$$\n\\frac{3a}{2} b_{2x} + \\frac{3a}{2} b_{2x} = 2\\pi\n$$\n$$\n3a b_{2x} = 2\\pi \\implies b_{2x} = \\frac{2\\pi}{3a}\n$$\n现在求 $b_{2y}$：\n$$\nb_{2y} = -\\sqrt{3} b_{2x} = -\\sqrt{3} \\left( \\frac{2\\pi}{3a} \\right) = -\\frac{2\\sqrt{3}\\pi}{3a}\n$$\n所以，第二个倒易晶格矢量是 $\\vec{b}_2 = \\frac{2\\pi}{3a} \\hat{i} - \\frac{2\\sqrt{3}\\pi}{3a} \\hat{j}$。\n\n这四个分量是：\n$b_{1x} = \\frac{2\\pi}{3a}$\n$b_{1y} = \\frac{2\\sqrt{3}\\pi}{3a}$\n$b_{2x} = \\frac{2\\pi}{3a}$\n$b_{2y} = -\\frac{2\\sqrt{3}\\pi}{3a}$", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{2\\pi}{3a} & \\frac{2\\sqrt{3}\\pi}{3a} & \\frac{2\\pi}{3a} & -\\frac{2\\sqrt{3}\\pi}{3a} \\end{pmatrix}}$$", "id": "1774232"}, {"introduction": "在上一个练习的基础上，我们现在可以构建一个简洁而强大的模型——紧束缚模型，来计算石墨烯的能带。这项实践将探索石墨烯迷人的电子特性，展示其独特的晶格结构如何产生“狄拉克锥”，以及破坏晶格对称性又如何打开能带隙——这是材料工程中的一个核心概念。[@problem_id:2387847]", "problem": "要求您实现一个石墨烯的最近邻紧束缚（TB）模型，并量化不等在位能如何通过打破子晶格对称性在狄拉克点处打开带隙。在具有三角布拉维晶格的二维蜂窝晶格上，使用双原子基矢。设最近邻距离为无量纲值 $1$，以此定义长度单位。在倒易空间中进行计算，使得相位 $e^{i \\mathbf{k} \\cdot \\boldsymbol{\\delta}_j}$ 中的角度以弧度为单位。所有能量必须以电子伏特（eV）表示。\n\n蜂窝晶格由具有原胞矢量\n$$\n\\mathbf{a}_1 = (\\sqrt{3}, \\, 0), \\quad \\mathbf{a}_2 = \\left(\\frac{\\sqrt{3}}{2}, \\, \\frac{3}{2}\\right).\n$$\n的三角布拉维晶格构成。\n连接子晶格 $A$ 到子晶格 $B$ 的三个最近邻矢量为\n$$\n\\boldsymbol{\\delta}_1 = (0, \\, 1), \\quad \\boldsymbol{\\delta}_2 = \\left(\\frac{\\sqrt{3}}{2}, \\, -\\frac{1}{2}\\right), \\quad \\boldsymbol{\\delta}_3 = \\left(-\\frac{\\sqrt{3}}{2}, \\, -\\frac{1}{2}\\right).\n$$\n设 $\\mathbf{b}_1$ 和 $\\mathbf{b}_2$ 为倒格矢，由 $\\mathbf{a}_i \\cdot \\mathbf{b}_j = 2\\pi \\delta_{ij}$ 定义。定义狄拉克点\n$$\n\\mathbf{K} = \\frac{1}{3}\\left(\\mathbf{b}_1 + 2 \\mathbf{b}_2\\right).\n$$\n\n在最近邻紧束缚哈密顿量中，设子晶格 $A$ 和 $B$ 上的在位能分别为 $E_A$ 和 $E_B$，最近邻跃迁能量为 $t$，则对于波矢 $\\mathbf{k}$ 的布洛赫哈密顿量是 $2\\times 2$ 的厄米矩阵\n$$\nH(\\mathbf{k}) = \\begin{pmatrix}\nE_A & -t \\, f(\\mathbf{k}) \\\\\n-t \\, f^*(\\mathbf{k}) & E_B\n\\end{pmatrix},\n$$\n其中\n$$\nf(\\mathbf{k}) = \\sum_{j=1}^{3} e^{i \\mathbf{k}\\cdot \\boldsymbol{\\delta}_j}.\n$$\n\n对于每组参数，计算作为 $H(\\mathbf{k})$ 的本征值 $E_{-}(\\mathbf{k}) \\le E_{+}(\\mathbf{k})$ 的两个能带，并评估在狄拉克点 $\\mathbf{K}$ 处的直接带隙，\n$$\n\\Delta_{\\mathbf{K}} = E_{+}(\\mathbf{K}) - E_{-}(\\mathbf{K}),\n$$\n以电子伏特（eV）表示。$\\mathbf{k}\\cdot\\boldsymbol{\\delta}_j$ 的角度单位必须是弧度。您的程序必须为以下参数集 $(t, E_A, E_B)$ 测试套件输出 $\\Delta_{\\mathbf{K}}$ 的值，所有量均以电子伏特为单位：\n- $(2.7, \\, 0.0, \\, 0.0)$,\n- $(2.7, \\, 0.1, \\, -0.1)$,\n- $(1.0, \\, 0.25, \\, 0.0)$,\n- $(0.0, \\, 0.3, \\, -0.3)$,\n- $(3.0, \\, 0.4, \\, 0.4)$.\n\n最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个带隙值都四舍五入到 $6$ 位小数（以 eV 为单位）。例如，格式必须为\n$$\n[\\Delta_{\\mathbf{K}}^{(1)},\\Delta_{\\mathbf{K}}^{(2)},\\ldots,\\Delta_{\\mathbf{K}}^{(5)}]\n$$\n每个 $\\Delta_{\\mathbf{K}}^{(i)}$ 都精确显示到小数点后 $6$ 位。", "solution": "问题陈述已经过验证，被认为是科学上正确、提法恰当且内容完备的。它提出了一个计算固态物理中的标准问题。我们将着手提供一个完整的解答。\n\n目标是计算由最近邻紧束缚模型描述的类石墨烯蜂窝晶格在狄拉克点 $\\mathbf{K}$ 处的直接带隙 $\\Delta_{\\mathbf{K}}$。该带隙定义为布洛赫哈密顿量 $H(\\mathbf{k})$ 在 $\\mathbf{k}=\\mathbf{K}$ 处求得的两个能量本征值之差。\n\n所提供的布洛赫哈密顿量是一个 $2\\times 2$ 矩阵：\n$$\nH(\\mathbf{k}) = \\begin{pmatrix}\nE_A & -t \\, f(\\mathbf{k}) \\\\\n-t \\, f^*(\\mathbf{k}) & E_B\n\\end{pmatrix}\n$$\n其中 $E_A$ 和 $E_B$ 是两个子晶格的在位能，$t$ 是最近邻跃迁能量，而 $f(\\mathbf{k}) = \\sum_{j=1}^{3} e^{i \\mathbf{k}\\cdot \\boldsymbol{\\delta}_j}$ 是涉及三个最近邻矢量 $\\boldsymbol{\\delta}_j$ 的几何结构因子。\n\n能量本征值 $E(\\mathbf{k})$ 通过求解特征方程 $\\det(H(\\mathbf{k}) - E I) = 0$ 得到：\n$$\n(E_A - E)(E_B - E) - |-t f(\\mathbf{k})|^2 = 0\n$$\n$$\nE^2 - (E_A + E_B)E + E_A E_B - t^2|f(\\mathbf{k})|^2 = 0\n$$\n能带 $E_{\\pm}(\\mathbf{k})$ 的解由二次公式给出：\n$$\nE_{\\pm}(\\mathbf{k}) = \\frac{E_A + E_B}{2} \\pm \\sqrt{\\left(\\frac{E_A - E_B}{2}\\right)^2 + t^2 |f(\\mathbf{k})|^2}\n$$\n在波矢 $\\mathbf{k}$ 处的直接带隙是这两个能带之差：\n$$\n\\Delta_{\\mathbf{k}} = E_{+}(\\mathbf{k}) - E_{-}(\\mathbf{k}) = 2\\sqrt{\\left(\\frac{E_A - E_B}{2}\\right)^2 + t^2 |f(\\mathbf{k})|^2} = \\sqrt{(E_A - E_B)^2 + 4t^2 |f(\\mathbf{k})|^2}\n$$\n为了评估在狄拉克点 $\\mathbf{K}$ 处的带隙，我们必须首先确定 $\\mathbf{K}$ 的坐标。问题定义了 $\\mathbf{K} = \\frac{1}{3}(\\mathbf{b}_1 + 2 \\mathbf{b}_2)$，其中 $\\mathbf{b}_1$ 和 $\\mathbf{b}_2$ 是对应于原胞格矢 $\\mathbf{a}_1 = (\\sqrt{3}, 0)$ 和 $\\mathbf{a}_2 = (\\frac{\\sqrt{3}}{2}, \\frac{3}{2})$ 的倒格矢。倒格矢由关系 $\\mathbf{a}_i \\cdot \\mathbf{b}_j = 2\\pi \\delta_{ij}$ 定义。\n\n实空间原胞的面积是 $A = |\\mathbf{a}_1 \\times \\mathbf{a}_2| = \\sqrt{3} \\cdot \\frac{3}{2} - 0 \\cdot \\frac{\\sqrt{3}}{2} = \\frac{3\\sqrt{3}}{2}$。然后计算倒格矢如下：\n$$\n\\mathbf{b}_1 = \\frac{2\\pi}{A} (a_{2y}, -a_{2x}) = \\frac{2\\pi}{3\\sqrt{3}/2} \\left(\\frac{3}{2}, -\\frac{\\sqrt{3}}{2}\\right) = \\left(\\frac{2\\pi}{\\sqrt{3}}, -\\frac{2\\pi}{3}\\right)\n$$\n$$\n\\mathbf{b}_2 = \\frac{2\\pi}{A} (-a_{1y}, a_{1x}) = \\frac{2\\pi}{3\\sqrt{3}/2} (0, \\sqrt{3}) = \\left(0, \\frac{4\\pi}{3}\\right)\n$$\n使用这些，我们找到狄拉克点 $\\mathbf{K}$ 的坐标：\n$$\n\\mathbf{K} = \\frac{1}{3}(\\mathbf{b}_1 + 2\\mathbf{b}_2) = \\frac{1}{3}\\left[\\left(\\frac{2\\pi}{\\sqrt{3}}, -\\frac{2\\pi}{3}\\right) + 2\\left(0, \\frac{4\\pi}{3}\\right)\\right] = \\frac{1}{3}\\left(\\frac{2\\pi}{\\sqrt{3}}, \\frac{6\\pi}{3}\\right) = \\left(\\frac{2\\pi}{3\\sqrt{3}}, \\frac{2\\pi}{3}\\right)\n$$\n下一步是评估结构因子 $f(\\mathbf{K})$。这需要计算 $\\mathbf{K}$ 与给定的最近邻矢量 $\\boldsymbol{\\delta}_1 = (0, 1)$、$\\boldsymbol{\\delta}_2 = (\\frac{\\sqrt{3}}{2}, -\\frac{1}{2})$ 和 $\\boldsymbol{\\delta}_3 = (-\\frac{\\sqrt{3}}{2}, -\\frac{1}{2})$ 的点积 $\\mathbf{K} \\cdot \\boldsymbol{\\delta}_j$：\n$$\n\\mathbf{K} \\cdot \\boldsymbol{\\delta}_1 = \\left(\\frac{2\\pi}{3\\sqrt{3}}, \\frac{2\\pi}{3}\\right) \\cdot (0, 1) = \\frac{2\\pi}{3}\n$$\n$$\n\\mathbf{K} \\cdot \\boldsymbol{\\delta}_2 = \\left(\\frac{2\\pi}{3\\sqrt{3}}, \\frac{2\\pi}{3}\\right) \\cdot \\left(\\frac{\\sqrt{3}}{2}, -\\frac{1}{2}\\right) = \\frac{2\\pi}{3\\sqrt{3}}\\frac{\\sqrt{3}}{2} - \\frac{2\\pi}{3}\\frac{1}{2} = \\frac{\\pi}{3} - \\frac{\\pi}{3} = 0\n$$\n$$\n\\mathbf{K} \\cdot \\boldsymbol{\\delta}_3 = \\left(\\frac{2\\pi}{3\\sqrt{3}}, \\frac{2\\pi}{3}\\right) \\cdot \\left(-\\frac{\\sqrt{3}}{2}, -\\frac{1}{2}\\right) = -\\frac{2\\pi}{3\\sqrt{3}}\\frac{\\sqrt{3}}{2} - \\frac{2\\pi}{3}\\frac{1}{2} = -\\frac{\\pi}{3} - \\frac{\\pi}{3} = -\\frac{2\\pi}{3}\n$$\n现在，我们计算 $f(\\mathbf{K})$：\n$$\nf(\\mathbf{K}) = e^{i (\\mathbf{K} \\cdot \\boldsymbol{\\delta}_1)} + e^{i (\\mathbf{K} \\cdot \\boldsymbol{\\delta}_2)} + e^{i (\\mathbf{K} \\cdot \\boldsymbol{\\delta}_3)} = e^{i 2\\pi/3} + e^{i 0} + e^{-i 2\\pi/3}\n$$\n使用欧拉公式，$e^{i\\theta} = \\cos\\theta + i\\sin\\theta$：\n$$\nf(\\mathbf{K}) = \\left(\\cos\\frac{2\\pi}{3} + i\\sin\\frac{2\\pi}{3}\\right) + 1 + \\left(\\cos\\frac{-2\\pi}{3} + i\\sin\\frac{-2\\pi}{3}\\right)\n$$\n$$\nf(\\mathbf{K}) = \\left(-\\frac{1}{2} + i\\frac{\\sqrt{3}}{2}\\right) + 1 + \\left(-\\frac{1}{2} - i\\frac{\\sqrt{3}}{2}\\right) = \\left(-\\frac{1}{2} + 1 - \\frac{1}{2}\\right) + i\\left(\\frac{\\sqrt{3}}{2} - \\frac{\\sqrt{3}}{2}\\right) = 0\n$$\n结构因子 $f(\\mathbf{K}) = 0$ 的消失是石墨烯中狄拉克点的定义性特征。将此结果代入带隙的通用公式：\n$$\n\\Delta_{\\mathbf{K}} = \\sqrt{(E_A - E_B)^2 + 4t^2 |f(\\mathbf{K})|^2} = \\sqrt{(E_A - E_B)^2 + 4t^2|0|^2} = \\sqrt{(E_A - E_B)^2}\n$$\n$$\n\\Delta_{\\mathbf{K}} = |E_A - E_B|\n$$\n这表明在狄拉克点处的带隙恰好是两个子晶格在位能之差的绝对值。该带隙与跃迁参数 $t$ 无关。如果子晶格对称性得以保持（$E_A = E_B$），则带隙为零，这与本征石墨烯的预期相符。\n\n现在我们将这个简单的公式应用于给定的参数集，其中所有能量都以 eV 为单位。\n\n1.  $(t=2.7, E_A=0.0, E_B=0.0)$: $\\Delta_{\\mathbf{K}} = |0.0 - 0.0| = 0.0$ eV。\n2.  $(t=2.7, E_A=0.1, E_B=-0.1)$: $\\Delta_{\\mathbf{K}} = |0.1 - (-0.1)| = 0.2$ eV。\n3.  $(t=1.0, E_A=0.25, E_B=0.0)$: $\\Delta_{\\mathbf{K}} = |0.25 - 0.0| = 0.25$ eV。\n4.  $(t=0.0, E_A=0.3, E_B=-0.3)$: $\\Delta_{\\mathbf{K}} = |0.3 - (-0.3)| = 0.6$ eV。\n5.  $(t=3.0, E_A=0.4, E_B=0.4)$: $\\Delta_{\\mathbf{K}} = |0.4 - 0.4| = 0.0$ eV。\n\n以下程序将实现完整的计算，作为此推导的数值验证，并生成最终结果。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the tight-binding band gap of graphene at the Dirac point K\n    for several sets of parameters.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple (t, E_A, E_B) in electronvolts (eV).\n    test_cases = [\n        (2.7, 0.0, 0.0),\n        (2.7, 0.1, -0.1),\n        (1.0, 0.25, 0.0),\n        (0.0, 0.3, -0.3),\n        (3.0, 0.4, 0.4),\n    ]\n\n    results = []\n\n    # Define lattice vectors as per the problem statement.\n    # The nearest-neighbor distance is set to 1 (dimensionless).\n    # Primitive Bravais lattice vectors.\n    a1 = np.array([np.sqrt(3), 0.0])\n    a2 = np.array([np.sqrt(3) / 2.0, 3.0 / 2.0])\n\n    # Nearest-neighbor vectors from sublattice A to B.\n    delta1 = np.array([0.0, 1.0])\n    delta2 = np.array([np.sqrt(3) / 2.0, -1.0 / 2.0])\n    delta3 = np.array([-np.sqrt(3) / 2.0, -1.0 / 2.0])\n    deltas = [delta1, delta2, delta3]\n\n    # Calculate reciprocal lattice vectors b1, b2 from a1, a2.\n    # The relation is a_i . b_j = 2*pi*delta_ij.\n    # For 2D, b1 = 2*pi/A * (a2y, -a2x) and b2 = 2*pi/A * (-a1y, a1x),\n    # where A = a1x*a2y - a1y*a2x is the unit cell area.\n    unit_cell_area = a1[0] * a2[1] - a1[1] * a2[0]\n    b1 = (2 * np.pi / unit_cell_area) * np.array([a2[1], -a2[0]])\n    b2 = (2 * np.pi / unit_cell_area) * np.array([-a1[1], a1[0]])\n\n    # Define the Dirac point K in the Brillouin zone.\n    K_point = (1.0 / 3.0) * (b1 + 2.0 * b2)\n\n    for case in test_cases:\n        t, E_A, E_B = case\n\n        # Although the analytical result is simply |E_A - E_B|, we perform the full\n        # numerical calculation to rigorously implement the model as requested.\n        \n        # 1. Calculate the structure factor f(k) at k = K.\n        # f(K) = sum_{j=1 to 3} exp(i * K . delta_j)\n        f_K = np.sum([np.exp(1j * np.dot(K_point, d)) for d in deltas])\n        \n        # Due to the properties of the graphene lattice, f(K) should be zero.\n        # Numerically, it will be a complex number very close to zero.\n\n        # 2. Construct the 2x2 Bloch Hamiltonian H(K).\n        H_K = np.array([\n            [E_A, -t * f_K],\n            [-t * np.conj(f_K), E_B]\n        ], dtype=complex)\n\n        # 3. Calculate the eigenvalues of the Hermitian matrix H(K).\n        # np.linalg.eigvalsh is used for Hermitian matrices and returns sorted real eigenvalues.\n        eigenvalues = np.linalg.eigvalsh(H_K)\n        \n        # 4. The band gap is the difference between the two eigenvalues.\n        E_minus, E_plus = eigenvalues[0], eigenvalues[1]\n        band_gap = E_plus - E_minus\n        \n        results.append(band_gap)\n\n    # Final print statement in the exact required format.\n    # Each result is formatted to 6 decimal places.\n    print(f\"[{','.join([f'{r:.6f}' for r in results])}]\")\n\nsolve()\n```", "id": "2387847"}, {"introduction": "本章的最后一个练习将聚焦于最终目标：诠释计算结果。一张能带结构图包含了丰富的信息。这项实践要求你编写一个程序，能够自动将材料分类为金属、直接带隙半导体或间接带隙半导体，从而将抽象的图表转化为具体的材料属性。[@problem_id:2387881]", "problem": "给定离散的电子能带结构数据，包括沿高对称性路径的能量值，其为一维晶体动量坐标 $k$ 的函数。令 $E_n(k_i)$ 表示能带 $n$ 在采样动量点 $k_i$ 处的能量，令 $E_F$ 表示费米能。所有能量均以电子伏特 (eV) 为单位，所有 $k$ 值均为无量纲。目标是根据第一性原理，为每个测试用例确定材料是金属、直接带隙半导体还是间接带隙半导体。\n\n将使用的定义：\n1. 如果费米能级存在状态，即存在 $n,i$ 使得 $|E_n(k_i) - E_F| \\le \\tau$，则材料为金属性；或者，如果存在一个位于连续采样动量点 $[k_i,k_{i+1}]$ 之间的区间和一条能带 $n$，使得 $E_n(k_i) - E_F$ 和 $E_n(k_{i+1}) - E_F$ 的符号相反（表示在样本之间穿过 $E_F$），则材料也为金属性。\n2. 如果根据上述标准，材料不具金属性，则定义价带顶和导带底为\n   $$E_v^{\\max} = \\max\\{E_n(k_i) \\mid E_n(k_i) < E_F\\}, \\quad E_c^{\\min} = \\min\\{E_n(k_i) \\mid E_n(k_i) > E_F\\}.$$\n   基本带隙为\n   $$\\Delta = E_c^{\\min} - E_v^{\\max}.$$\n   如果 $\\Delta \\le \\tau$，则分类为金属性。否则，确定出现 $E_v^{\\max}$ 和 $E_c^{\\min}$ 的动量点 $k_v$ 和 $k_c$。如果 $|k_v - k_c| \\le \\delta_k$，则该材料是直接带隙半导体；否则，为间接带隙半导体。\n\n使用以下数值容差：能量容差 $\\tau = 10^{-6}\\,\\mathrm{eV}$ 和动量容差 $\\delta_k = 10^{-12}$ (无量纲)。\n\n您的程序必须使用整数编码映射 $0 \\to$ 金属，$1 \\to$ 直接带隙半导体，$2 \\to$ 间接带隙半导体来对以下四个测试用例进行分类。最终输出必须是无单位的整数编码。\n\n测试套件（所有能量以电子伏特 (eV) 为单位，所有 $k$ 值无量纲）：\n- 所有情况的通用动量网格：$k = [0, 0.5, 1.0]$。\n- 所有情况的费米能：$E_F = 0$。\n\n情况 1 (因样本间穿越而成为金属)：\n- 能带数：$2$。\n- 能量：\n  - 能带 $1$：$[-1.0, 0.5, 1.2]$。\n  - 能带 $2$：$[2.0, 2.1, 2.2]$。\n\n情况 2 (直接带隙半导体)：\n- 能带数：$2$。\n- 能量：\n  - 能带 $1$ (类价带)：$[-2.0, -1.0, -1.5]$。\n  - 能带 $2$ (类导带)：$[1.5, 1.0, 2.0]$。\n\n情况 3 (间接带隙半导体)：\n- 能带数：$2$。\n- 能量：\n  - 能带 $1$ (类价带)：$[-0.5, -0.2, -0.4]$。\n  - 能带 $2$ (类导带)：$[0.6, 0.9, 0.5]$。\n\n情况 4 (因在 $E_F$ 处零带隙接触而成为金属)：\n- 能带数：$2$。\n- 能量：\n  - 能带 $1$：$[-1.0, 0.0, -0.2]$。\n  - 能带 $2$：$[0.3, 0.0, 0.4]$。\n\n要求的最终输出格式：\n您的程序应生成一行输出，其中包含按情况 1 到 4 排序的结果，形式为用方括号括起来的逗号分隔列表。例如，有效格式为 $[c_1,c_2,c_3,c_4]$，其中每个 $c_j$ 是情况 $j$ 的整数编码。", "solution": "所提出的问题是，基于电子能带结构 $E_n(k_i)$ 的离散表示，将材料分类为金属、直接带隙半导体或间接带隙半导体。该问题定义明确，具有科学依据，并为分类提供了清晰、明确的算法流程。这是计算凝聚态物理学中的一个标准练习。我们将着手对解法进行形式化推导。\n\n每个案例的输入是一组 $N_{bands}$ 条能带，每条能带在 $N_k$ 个动量点 $k_i$ 上采样。设能带 $n$ 在动量 $k_i$ 处的能量为 $E_{n,i}$。给定的费米能为 $E_F$，能量容差为 $\\tau$，动量容差为 $\\delta_k$。\n\n分类通过问题陈述中定义的一系列检查来进行。\n\n首先，我们必须确定材料是否为金属性。如果满足以下两个条件中至少一个，则材料被分类为金属。\n\n条件 1：费米能级存在电子态。如果对于任何能带 $n$ 和动量点 $k_i$，能量 $E_{n,i}$ 在费米能 $E_F$ 的一个很小的容差 $\\tau$ 范围内，这种情况就会发生。在数学上，这个条件是：\n$$ \\exists (n, i) \\text{ such that } |E_{n,i} - E_F| \\le \\tau $$\n对于计算实现，这涉及遍历所有给定的能量值并检查此不等式。\n\n条件 2：某条能带在两个连续的采样动量点之间穿过费米能级。对于给定的能带 $n$，通过观察量 $E - E_F$ 在相邻点 $k_i$ 和 $k_{i+1}$ 之间符号的变化来检测。这意味着在该区间内必定存在一个根。条件是：\n$$ \\exists (n, i) \\text{ such that } (E_{n,i} - E_F) \\cdot (E_{n,i+1} - E_F) < 0 $$\n如果条件 1 或条件 2 任一被满足，则该材料被分类为金属，对应整数编码 $0$，并且对该情况的分析结束。\n\n如果上述金属性条件均不满足，则该材料暂时为非金属性，我们继续分析其带隙。我们必须首先识别所有低于费米能的能态（价带态）和所有高于费米能的能态（导带态）。\n\n令所有采样的能量-动量对的集合为 $\\mathcal{S} = \\{(E_{n,i}, k_i)\\}$。我们定义价带态集合 $\\mathcal{S}_v$ 和导带态集合 $\\mathcal{S}_c$ 如下：\n$$ \\mathcal{S}_v = \\{ (E, k) \\in \\mathcal{S} \\mid E < E_F \\} $$\n$$ \\mathcal{S}_c = \\{ (E, k) \\in \\mathcal{S} \\mid E > E_F \\} $$\n假设对于任何非金属性情况，$\\mathcal{S}_v$ 和 $\\mathcal{S}_c$ 均非空。\n\n根据这些集合，我们确定价带顶 ($E_v^{\\max}$) 和导带底 ($E_c^{\\min}$):\n$$ E_v^{\\max} = \\max \\{ E \\mid (E, k) \\in \\mathcal{S}_v \\} $$\n$$ E_c^{\\min} = \\min \\{ E \\mid (E, k) \\in \\mathcal{S}_c \\} $$\n令 $k_v$ 为找到最大值 $E_v^{\\max}$ 时的动量，令 $k_c$ 为最小值 $E_c^{\\min}$ 时的动量。如果这些极值出现在多个动量点，任选其中一个点进行分析即可。\n\n然后，基本带隙计算为 $\\Delta = E_c^{\\min} - E_v^{\\max}$。\n\n执行最后的金属性检查。如果带隙为零或可忽略不计 ($\\Delta \\le \\tau$)，则该材料被分类为金属（或半金属），并赋予编码 $0$。这处理了价带和导带在单点接触的情况，如果接触点不恰好在 $E_F$ 处，初始检查可能无法捕获这种零带隙条件。\n\n如果 $\\Delta > \\tau$，则该材料是半导体。直接带隙和间接带隙的区别取决于价带顶和导带底在动量空间中的位置。\n- 如果在数值容差 $\\delta_k$ 内，动量 $k_v$ 和 $k_c$ 相同，则材料具有直接带隙。条件是 $|k_v - k_c| \\le \\delta_k$。在这种情况下，材料被分类为直接带隙半导体，编码为 $1$。\n- 如果动量 $k_v$ 和 $k_c$ 不同，使得 $|k_v - k_c| > \\delta_k$，则材料具有间接带隙。它被分类为间接带隙半导体，编码为 $2$。\n\n至此，整个分类逻辑完成。我们将此算法应用于提供的四个测试用例。\n\n通用参数为 $k = [0, 0.5, 1.0]$, $E_F = 0\\,\\mathrm{eV}$, $\\tau = 10^{-6}\\,\\mathrm{eV}$ 和 $\\delta_k = 10^{-12}$。\n\n情况 1：$E_1 = [-1.0, 0.5, 1.2]$, $E_2 = [2.0, 2.1, 2.2]$。\n对于能带 1，在 $k_1=0$ 和 $k_2=0.5$ 之间，能量为 $E_{1,1}=-1.0\\,\\mathrm{eV}$ 和 $E_{1,2}=0.5\\,\\mathrm{eV}$。由于 $(E_{1,1}-E_F)(E_{1,2}-E_F) = (-1.0)(0.5) = -0.5 < 0$，发生费米能级穿越。该材料是金属。编码：$0$。\n\n情况 2：$E_1 = [-2.0, -1.0, -1.5]$, $E_2 = [1.5, 1.0, 2.0]$。\n在 $E_F$ 处没有态，也没有发生穿越。它为非金属性。\n$E_v^{\\max} = \\max\\{-2.0, -1.0, -1.5\\} = -1.0\\,\\mathrm{eV}$ 位于 $k_v=0.5$。\n$E_c^{\\min} = \\min\\{1.5, 1.0, 2.0\\} = 1.0\\,\\mathrm{eV}$ 位于 $k_c=0.5$。\n带隙为 $\\Delta = 1.0 - (-1.0) = 2.0\\,\\mathrm{eV}$。由于 $\\Delta > \\tau$，它是一种半导体。\n比较动量：$|k_v - k_c| = |0.5 - 0.5| = 0 \\le \\delta_k$。它是一种直接带隙半导体。编码：$1$。\n\n情况 3：$E_1 = [-0.5, -0.2, -0.4]$, $E_2 = [0.6, 0.9, 0.5]$。\n在 $E_F$ 处没有态，也没有发生穿越。它为非金属性。\n$E_v^{\\max} = \\max\\{-0.5, -0.2, -0.4\\} = -0.2\\,\\mathrm{eV}$ 位于 $k_v=0.5$。\n$E_c^{\\min} = \\min\\{0.6, 0.9, 0.5\\} = 0.5\\,\\mathrm{eV}$ 位于 $k_c=1.0$。\n带隙为 $\\Delta = 0.5 - (-0.2) = 0.7\\,\\mathrm{eV}$。由于 $\\Delta > \\tau$，它是一种半导体。\n比较动量：$|k_v - k_c| = |0.5 - 1.0| = 0.5 > \\delta_k$。它是一种间接带隙半导体。编码：$2$。\n\n情况 4：$E_1 = [-1.0, 0.0, -0.2]$, $E_2 = [0.3, 0.0, 0.4]$。\n在 $k_2 = 0.5$ 处，两个能带的能量均为 $0.0\\,\\mathrm{eV}$。\n对于能带 1，在 $k_2=0.5$ 处， $|E_{1,2} - E_F| = |0.0 - 0.0| = 0 \\le \\tau$。满足金属性条件。该材料是金属。编码：$0$。\n\n最终的分类编码序列为 $[0, 1, 2, 0]$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef classify_material(k_grid, bands, E_F, tau, delta_k):\n    \"\"\"\n    Classifies a material as metal (0), direct-gap semiconductor (1),\n    or indirect-gap semiconductor (2) based on band structure data.\n\n    Args:\n        k_grid (list or np.ndarray): 1D array of momentum points.\n        bands (list of lists or np.ndarray): A list where each element is a\n                                             list of energies for one band.\n        E_F (float): The Fermi energy.\n        tau (float): Energy tolerance for metallic classification.\n        delta_k (float): Momentum tolerance for direct gap classification.\n\n    Returns:\n        int: Classification code (0, 1, or 2).\n    \"\"\"\n    \n    # Metallic Check 1: State at the Fermi level\n    for band_energies in bands:\n        for energy in band_energies:\n            if abs(energy - E_F) = tau:\n                return 0 # Metal\n\n    # Metallic Check 2: Band crossing the Fermi level between samples\n    for band_energies in bands:\n        for i in range(len(band_energies) - 1):\n            e1 = band_energies[i]\n            e2 = band_energies[i+1]\n            if (e1 - E_F) * (e2 - E_F)  0:\n                return 0 # Metal\n\n    # If not metallic, proceed to semiconductor/semimetal analysis\n    valence_states = []\n    conduction_states = []\n\n    for band_energies in bands:\n        for i, energy in enumerate(band_energies):\n            k = k_grid[i]\n            if energy  E_F:\n                valence_states.append((energy, k))\n            elif energy > E_F:\n                conduction_states.append((energy, k))\n\n    # Pathological case: no states below or above Ef\n    if not valence_states or not conduction_states:\n        # This case is not expected based on the problem description,\n        # but robust code should handle it. Let's assume it implies\n        # a large-gap insulator or a metal where all bands are filled/empty,\n        # which isn't physically typical. Depending on conventions, this\n        # could be an error or a specific classification.\n        # For this problem, we assume this will not happen.\n        # We can treat it as an indirect semiconductor (infinite gap).\n        return 2\n\n    # Find valence-band maximum (VBM)\n    vbm_idx = np.argmax([s[0] for s in valence_states])\n    Ev_max, k_v = valence_states[vbm_idx]\n\n    # Find conduction-band minimum (CBM)\n    cbm_idx = np.argmin([s[0] for s in conduction_states])\n    Ec_min, k_c = conduction_states[cbm_idx]\n\n    # Calculate the band gap\n    band_gap = Ec_min - Ev_max\n\n    # Semimetal/Zero-gap check\n    if band_gap = tau:\n        return 0 # Metal (semimetal)\n\n    # Direct vs. Indirect Gap\n    if abs(k_v - k_c) = delta_k:\n        return 1 # Direct-gap semiconductor\n    else:\n        return 2 # Indirect-gap semiconductor\n\ndef solve():\n    \"\"\"\n    Runs the classification for all test cases provided in the problem.\n    \"\"\"\n    \n    # Common parameters\n    k_grid = np.array([0.0, 0.5, 1.0])\n    E_F = 0.0\n    tau = 1e-6\n    delta_k = 1e-12\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1 (metal via crossing)\n        {\n            \"bands\": [\n                [-1.0, 0.5, 1.2],\n                [2.0, 2.1, 2.2]\n            ]\n        },\n        # Case 2 (direct-gap semiconductor)\n        {\n            \"bands\": [\n                [-2.0, -1.0, -1.5],\n                [1.5, 1.0, 2.0]\n            ]\n        },\n        # Case 3 (indirect-gap semiconductor)\n        {\n            \"bands\": [\n                [-0.5, -0.2, -0.4],\n                [0.6, 0.9, 0.5]\n            ]\n        },\n        # Case 4 (metal via touching at EF)\n        {\n            \"bands\": [\n                [-1.0, 0.0, -0.2],\n                [0.3, 0.0, 0.4]\n            ]\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        bands_data = np.array(case[\"bands\"])\n        result = classify_material(k_grid, bands_data, E_F, tau, delta_k)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "2387881"}]}