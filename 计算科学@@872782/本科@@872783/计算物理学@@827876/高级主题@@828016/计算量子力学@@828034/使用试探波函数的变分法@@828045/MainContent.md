## 引言
量子力学的薛定谔方程精确地描述了微观世界的规律，然而，除了少数理想化系统，对绝大多数真实物理系统（如[多电子原子](@entry_id:157716)、分子和固体）的薛定谔方程进行精确求解几乎是不可能的。这一挑战催生了各种强大的近似方法，其中，**使用[试探波函数](@entry_id:142892)的[变分法](@entry_id:163656)**（Variational Method with Trial Wavefunctions）无疑是最为重要和应用最广泛的工具之一。它巧妙地将求解复杂的[微分](@entry_id:158718)[本征值问题](@entry_id:142153)，转化为一个更加直观和易于操作的[函数最小化](@entry_id:138381)问题，为我们探索复杂量子世界打开了一扇大门。

本文旨在为读者提供一个关于[变分法](@entry_id:163656)的全面而深入的理解。我们将系统地揭示[变分法](@entry_id:163656)如何帮助我们近似计算系统的基态能量和[波函数](@entry_id:147440)，并理解其背后的深刻物理意义。读者将通过本文学习到：

1.  **原理与机制**：深入理解变分法的核心——[瑞利-里兹变分原理](@entry_id:185834)，学习如何构建和优化包含变分参数的试探波函数，并探讨[线性变分法](@entry_id:150058)、对称性应用以及评估[波函数](@entry_id:147440)质量的多种工具。
2.  **应用与跨学科联系**：探索变分法在[量子化学](@entry_id:140193)、凝聚态物理、核物理等前沿领域的广泛应用，理解它如何成为解释分子成键、电子关联、[范德华力](@entry_id:145564)等关键概念的理论基石。
3.  **动手实践**：通过一系列精心设计的计算练习，将理论知识付诸实践，亲手运用变分法解决具体的量子力学问题。

本文将首先从第一章“原理与机制”开始，为您奠定坚实的理论基础，详细阐述变分法的工作原理和基本技术。

## 原理与机制

量子力学的核心挑战之一是求解[定态](@entry_id:137260)薛定谔方程 $\hat{H}\psi = E\psi$，这是一个复杂的本征值问题。除了少数理想化的模型（如氢原子、[谐振子](@entry_id:155622)）外，绝大多数真实物理系统的薛定谔方程都无法精确求解。[变分法](@entry_id:163656)（Variational Method）为我们提供了一个强大而灵活的框架，用以近似求解这些复杂系统的基态能量和[波函数](@entry_id:147440)。其核心思想是将求解[本征值问题](@entry_id:142153)转化为一个更易于处理的最小化问题。

### [瑞利-里兹变分原理](@entry_id:185834)

变分法的理论基石是**[瑞利-里兹变分原理](@entry_id:185834)**（Rayleigh-Ritz Variational Principle）。该原理指出：对于一个由[哈密顿量](@entry_id:172864) $\hat{H}$ 描述的量子系统，其真实的基态能量为 $E_0$。对于任意一个归一化的、行为良好的**试探波函数**（trial wavefunction） $\psi$，其[哈密顿量](@entry_id:172864)的[期望值](@entry_id:153208)总不小于真实的[基态能量](@entry_id:263704)。数学上表示为：

$$
\mathcal{E}[\psi] = \frac{\langle \psi | \hat{H} | \psi \rangle}{\langle \psi | \psi \rangle} \ge E_0
$$

其中，等号仅在试探波函数 $\psi$ 恰好是真实的[基态](@entry_id:150928)[波函数](@entry_id:147440) $\psi_0$ 时成立。分母中的 $\langle \psi | \psi \rangle$ 确保了该表达式对于未归一化的[波函数](@entry_id:147440)同样适用。这个[期望值](@entry_id:153208) $\mathcal{E}[\psi]$ 被称为**[瑞利商](@entry_id:137794)**（Rayleigh quotient）。

该原理的意义是革命性的：它为我们提供了一个评估任意猜测[波函数](@entry_id:147440)质量的标准，并保证我们的能量估计值总是一个**上限**。我们永远不会低估真实的基态能量。更重要的是，它将[求解微分方程](@entry_id:137471)的问题转化为了一个[函数最小化](@entry_id:138381)的问题。

实际应用中，我们通常会构建一个包含一个或多个**变分参数**（variational parameters） $\boldsymbol{\alpha} = (\alpha_1, \alpha_2, \dots)$ 的[试探波函数](@entry_id:142892)族 $\psi(\boldsymbol{\alpha})$。接着，我们遵循一个系统性的步骤：

1.  根据物理直觉，选择一个合理的、在数学上易于处理的试探波函数族 $\psi(\boldsymbol{\alpha})$。
2.  计算能量泛函 $E(\boldsymbol{\alpha}) = \mathcal{E}[\psi(\boldsymbol{\alpha})]$，即[哈密顿量](@entry_id:172864)的[期望值](@entry_id:153208)作为变分参数的函数。
3.  通过求解方程 $\frac{\partial E(\boldsymbol{\alpha})}{\partial \alpha_i} = 0$ 来最小化能量泛函 $E(\boldsymbol{\alpha})$，找到最优的参数值 $\boldsymbol{\alpha}_{opt}$。
4.  将最优参数代回能量泛函，得到该[试探函数](@entry_id:756165)族所能给出的最佳基态能量近似值 $E_{min} = E(\boldsymbol{\alpha}_{opt})$。根据[变分原理](@entry_id:198028)，我们有 $E_{min} \ge E_0$。

试探波函数族越灵活、越能接近真实[波函数](@entry_id:147440)的形态，我们得到的能量上限就越接近真实值。

### [原子基态](@entry_id:194487)的典型应用

让我们通过几个典型的原子系统来具体理解变分法的应用过程。

#### 氢原子的高斯函数近似

氢原子是少数可以精确求解的量子系统之一，其[基态能量](@entry_id:263704)为 $E_{\mathrm{exact}} = -\frac{\mu e^{4}}{2(4\pi \varepsilon_{0})^{2}\hbar^{2}}$。这为我们提供了一个绝佳的测试平台来检验[变分法](@entry_id:163656)的有效性。尽管我们知道其精确解，但我们可以假装不知，并使用一个不同的函数形式来近似它。

考虑使用一个球对称的[高斯函数](@entry_id:261394)作为试探波函数 [@problem_id:2432935]：
$$
\psi(r; \alpha) = C \exp(-\alpha r^2)
$$
其中 $\alpha$ 是一个正的变分参数，它控制了[波函数](@entry_id:147440)在空间中的延展程度。选择高斯函数是因为它在数学上处理非常方便，并且形态上（在原点处有峰值并向外衰减）与真实的1s轨道有几分相似。

按照变分法的步骤，我们首先对[波函数](@entry_id:147440)进行归一化，然后计算[哈密顿量](@entry_id:172864) $\hat{H} = -\frac{\hbar^2}{2\mu}\nabla^2 - \frac{e^2}{4\pi\varepsilon_0 r}$ 的[期望值](@entry_id:153208)。这包括动能[期望值](@entry_id:153208) $\langle T \rangle$ 和[势能](@entry_id:748988)[期望值](@entry_id:153208) $\langle V \rangle$：
$$
\langle T \rangle = \frac{3\hbar^2 \alpha}{2\mu}
$$
$$
\langle V \rangle = -\frac{e^2}{2\pi\varepsilon_0}\sqrt{\frac{2\alpha}{\pi}}
$$
总[能量泛函](@entry_id:170311)为 $E(\alpha) = \langle T \rangle + \langle V \rangle = \frac{3\hbar^2 \alpha}{2\mu} - \frac{e^2}{2\pi\varepsilon_0} \sqrt{\frac{2\alpha}{\pi}}$。通过对 $\alpha$ 求导并令其为零，我们找到最优参数 $\alpha_{opt}$。将 $\alpha_{opt}$ 代回，我们得到的最小变分能量为：
$$
E_{var,min} = -\frac{4\mu e^4}{3\pi(4\pi\varepsilon_0)^2\hbar^2}
$$
将这个结果与精确解进行比较，我们发现 $E_{var,min} = \frac{8}{3\pi} E_{exact} \approx 0.85 E_{exact}$。由于能量是负值，这意味着 $E_{var,min} > E_{exact}$，这完全符合[变分原理](@entry_id:198028)。尽管我们的高斯[试探函数](@entry_id:756165)在形态上与真实的指数衰减[波函数](@entry_id:147440)有本质区别（特别是在原点处的行为和长程衰减行为），我们仍然得到了一个距离真实能量仅有约15%偏差的估计值，这展示了[变分法](@entry_id:163656)的稳健性。

#### 氦原子与[有效核电荷](@entry_id:756832)

氦原子（$Z=2$）是多电子体系中最简单的例子。其[哈密顿量](@entry_id:172864)（在[原子单位](@entry_id:166762)下）包含两个电子的动能、它们与[原子核](@entry_id:167902)的吸引势，以及一个关键的、使问题无法精确求解的项——电子间[排斥势](@entry_id:185622) $\frac{1}{r_{12}}$。
$$
\hat{H} = \left(-\frac{1}{2}\nabla_1^2 - \frac{Z}{r_1}\right) + \left(-\frac{1}{2}\nabla_2^2 - \frac{Z}{r_2}\right) + \frac{1}{r_{12}}
$$
一个简单而富有洞察力的[试探波函数](@entry_id:142892)是两个电子占据各自的1s[类氢原子轨道](@entry_id:186975)的乘积，但我们将[轨道](@entry_id:137151)中的核[电荷](@entry_id:275494) $Z$ 替换为一个变分参数 $\zeta$，即**[有效核电荷](@entry_id:756832)**（effective nuclear charge）[@problem_id:1406635] [@problem_id:1189146]。
$$
\Psi_{trial}(\mathbf{r}_1, \mathbf{r}_2; \zeta) = \phi_{1s}(\mathbf{r}_1; \zeta)\phi_{1s}(\mathbf{r}_2; \zeta) \quad \text{with} \quad \phi_{1s}(\mathbf{r}; \zeta) = \left(\frac{\zeta^3}{\pi}\right)^{1/2} e^{-\zeta r}
$$
使用 $\zeta$ 作为变分参数的物理直觉是，每个电子都会被另一个电子部分地**屏蔽**（screen），从而感受到的不再是完整的 $+2e$ 核[电荷](@entry_id:275494)。$\zeta$ 的最优值应该在1和2之间。

计算得到的[能量泛函](@entry_id:170311)为：
$$
E(\zeta) = \zeta^2 - 2Z\zeta + \frac{5}{8}\zeta
$$
该表达式包含两电子的动能（$\zeta^2$），两电子与核的吸引能（$-2Z\zeta$），以及两电子间的平均排斥能（$\frac{5}{8}\zeta$）。对 $\zeta$ 求导并令其为零，我们得到最优的有效核电荷 $\zeta_{opt} = Z - \frac{5}{16}$。对于[氦原子](@entry_id:150244)（$Z=2$），$\zeta_{opt} = 27/16 \approx 1.69$，这完美地证实了我们的物理直觉：电子感受到的[有效核电荷](@entry_id:756832)确实小于2。

将 $\zeta_{opt}$ 代回，我们得到的变分能量为 $E_{var} = -(Z - 5/16)^2$。这个结果显著优于不考虑屏蔽效应的近似（例如，[一阶微扰理论](@entry_id:153242)）。事实上，[一阶微扰理论](@entry_id:153242)的能量估计值等价于在上述[能量泛函](@entry_id:170311)中简单地取 $\zeta=Z$，而不进行优化 [@problem_id:1406635]。[变分法](@entry_id:163656)通过引入并优化物理上合理的参数，系统性地改进了[波函数](@entry_id:147440)和能量的估计，确保我们能在给定的函数形式内找到最佳的近似。

### [线性变分法](@entry_id:150058)与[子空间](@entry_id:150286)[对角化](@entry_id:147016)

一种更系统、更强大的[变分法](@entry_id:163656)是**[线性变分法](@entry_id:150058)**（Linear Variational Method）。其思想是将[试探波函数](@entry_id:142892)展开为一组预先选定的**[基函数](@entry_id:170178)**（basis functions） $\{\phi_i\}$ 的线性组合：
$$
\psi_{trial} = \sum_{i=1}^{N} c_i \phi_i
$$
在这里，变分参数是[线性组合](@entry_id:154743)系数 $\{c_i\}$。我们将[瑞利商](@entry_id:137794)对每个 $c_i$ 进行最小化，这最终导出一个矩阵[本征值方程](@entry_id:192306)，称为**[广义久期方程](@entry_id:271871)**（generalized secular equation）：
$$
(\mathbf{H} - E\mathbf{S})\mathbf{c} = 0
$$
其中 $\mathbf{c}$ 是系数构成的列向量，而 $\mathbf{H}$ 和 $\mathbf{S}$ 分别是[哈密顿量](@entry_id:172864)矩阵和交叠矩阵，其[矩阵元](@entry_id:186505)定义为 $H_{ij} = \langle \phi_i | \hat{H} | \phi_j \rangle$ 和 $S_{ij} = \langle \phi_i | \phi_j \rangle$。

这个方程有非零解的条件是[久期行列式](@entry_id:274608) $\det(\mathbf{H} - E\mathbf{S})=0$。求解这个[行列式](@entry_id:142978)会得到 $N$ 个实数能量值 $E_k$。根据**[瑞利-里兹定理](@entry_id:194531)**，其中最低的能量值 $E_-$ 是基态能量 $E_0$ 的一个[上界](@entry_id:274738)，即 $E_- \ge E_0$ [@problem_id:1416060]。这本质上是因为我们的最小化是在由[基函数](@entry_id:170178) $\{\phi_i\}$ 张成的希尔伯特[子空间](@entry_id:150286)中进行的，而[子空间](@entry_id:150286)中的最小值必然不会低于在整个[希尔伯特空间](@entry_id:261193)中的全局最小值。

更一般地，**[Hylleraas-Undheim-MacDonald定理](@entry_id:202609)**保证，这些[能量本征值](@entry_id:144381) $E_1 \le E_2 \le \dots \le E_N$ 分别为真实的前 $N$ 个能级 $E_0, E_1, \dots, E_{N-1}$ 提供了上界，即 $E_k \ge E_{k-1}^{exact}$。

[线性变分法](@entry_id:150058)是现代[计算化学](@entry_id:143039)和物理的基石。例如，在**[Hartree-Fock方法](@entry_id:138063)**中，人们寻求在由单个[斯莱特行列式](@entry_id:139034)构成的函数空间中使[能量最小化](@entry_id:147698)。这个[非线性](@entry_id:637147)[变分问题](@entry_id:756445)通常通过一个迭代过程（[自洽场方法](@entry_id:184373)）求解，该过程在每一步都涉及到求解一个（线性）矩阵[本征值方程](@entry_id:192306)，以找到构成[行列式](@entry_id:142978)的最佳单[电子轨道](@entry_id:157718) [@problem_id:2921375]。

### 对称性、正交性与[激发态](@entry_id:261453)

变分原理最直接的应用是寻找[基态](@entry_id:150928)。然而，通过引入**正交性约束**（orthogonality constraint），我们也可以用它来估计[激发态](@entry_id:261453)的能量。对于第一[激发态](@entry_id:261453)，其原理是：如果一个[试探波函数](@entry_id:142892) $\psi_{trial}$ 与真实的[基态](@entry_id:150928)[波函数](@entry_id:147440) $\psi_0$ 正交（即 $\langle \psi_0 | \psi_{trial} \rangle = 0$），那么它的[能量期望值](@entry_id:174035)将是第一[激发态](@entry_id:261453)能量 $E_1$ 的一个上界：
$$
\frac{\langle \psi_{trial} | \hat{H} | \psi_{trial} \rangle}{\langle \psi_{trial} | \psi_{trial} \rangle} \ge E_1
$$
这个原理可以推广到更高的[激发态](@entry_id:261453)。然而，一个实际的困难是我们通常并不知道精确的低能级本征函数。

**对称性**为此提供了一个优雅的解决方案。如果系统的[哈密顿量](@entry_id:172864)具有某种对称性（例如，对于像[谐振子](@entry_id:155622)这样的[对称势](@entry_id:148561)，$V(x) = V(-x)$），那么它的[本征函数](@entry_id:154705)也具有确定的对称性（例如，确定的宇称——偶性或奇性）。[谐振子](@entry_id:155622)的[基态](@entry_id:150928)[波函数](@entry_id:147440)是偶函数。因此，任何奇函数都自动与[基态](@entry_id:150928)[波函数](@entry_id:147440)正交。

我们可以利用这一点来估计第一[激发态](@entry_id:261453)的能量。例如，对于一维谐振子，如果我们故意选择一个具有[奇宇称](@entry_id:147965)的[试探波函数](@entry_id:142892)族，如 $\psi_{\alpha}(x) = x \exp(-\alpha x^2)$ [@problem_id:2448877]，我们知道它正交于偶函数形式的[基态](@entry_id:150928)。因此，通过最小化 $E(\alpha) = \langle \psi_{\alpha} | \hat{H} | \psi_{\alpha} \rangle / \langle \psi_{\alpha} | \psi_{\alpha} \rangle$ 得到的结果将是第一[激发态](@entry_id:261453)能量 $E_1$ 的[上界](@entry_id:274738)。

对于这个特定的例子，计算表明，最小化后的能量恰好是 $E_{min} = \frac{3}{2}\hbar\omega$，这正是谐振子第一[激发态](@entry_id:261453)的精确能量。这是因为我们的[试探函数](@entry_id:756165)族恰好包含了真实的[本征函数](@entry_id:154705)。这个例子有力地说明，通过利用对称性来选择试探波函数，变分法可以有效地应用于[激发态](@entry_id:261453)的研究。如果在[激发态计算](@entry_id:749156)中，我们恰好知道精确的[基态](@entry_id:150928)[波函数](@entry_id:147440) $\psi_0$，我们也可以直接在试探波函数中施加正交性约束 $\langle \psi_0 | \psi_t \rangle = 0$ 来简化计算 [@problem_id:2448910]。

### 评估试探波函数的质量

变分能量的数值本身是衡量[试探波函数](@entry_id:142892)质量的一个指标——能量越低，通常意味着[波函数](@entry_id:147440)越好。然而，还有一些更精细的工具可以帮助我们评估[试探波函数](@entry_id:142892)的优劣。

#### 函数形式的选择

[试探波函数](@entry_id:142892)的函数形式至关重要。不同的函数形式，即使都包含变分参数，也可能得到不同质量的近似。考虑一个粒子在 $V(x)=|x|$ 势中的运动，这是一个可以检验不同函数形式的有趣模型。我们可以分别使用[高斯函数](@entry_id:261394)族 $\psi_G(x) \propto \exp(-\alpha x^2)$ 和[三角函数](@entry_id:178918)族 $\psi_T(x) \propto (1-b|x|)$（在有限区间内）来进行变分计算 [@problem_id:2448859]。对两者分别进行能量最小化后，我们会发现其中一个函数族（在此例中是[三角函数](@entry_id:178918)族）给出了更低的能量[上界](@entry_id:274738)。这说明，选择一个能更好地模仿真实[波函数](@entry_id:147440)形态的函数族，对于获得高精度的结果是至关重要的。

#### 局域能量与[尖点条件](@entry_id:190416)

一个更深入的诊断工具是**局域能量**（local energy），其定义为：
$$
E_L(\mathbf{r}) = \frac{\hat{H}\psi(\mathbf{r})}{\psi(\mathbf{r})}
$$
对于一个真实的[哈密顿量](@entry_id:172864)本征函数，其局域能量在空间中处处为常数，且等于其本征能量。而对于一个近似的试探波函数，局域能量通常会随空间位置变化。局域能量在空间中的起伏大小，可以作为衡量[试探波函数](@entry_id:142892)在“局部”有多好的一个指标。

特别地，在势能发散的点（例如，[库仑势](@entry_id:154276)中粒子位置与力心重合处），局域能量的行为揭示了波[函数的根](@entry_id:169486)本性质。例如，在氦原子中，当一个电子接近[原子核](@entry_id:167902)时（$r_1 \to 0$），势能项 $-Z/r_1$ 会发散。为了使总能量（以及局域能量）保持有限，动能项 $-\frac{1}{2}\nabla_1^2 \psi / \psi$ 必须也发散，并且恰好抵消[势能](@entry_id:748988)的发散。这要求[波函数](@entry_id:147440)在 $r_1=0$ 处必须有一个“[尖点](@entry_id:636792)”（cusp），其一阶导数不连续。

如果一个试探波函数不满足这个**[尖点条件](@entry_id:190416)**（cusp condition），它的局域能量就会在这些点发散。例如，前面提到的用于氦原子计算的高斯型试探波函数 $\psi_T = \exp(-\alpha(r_1^2+r_2^2))$ 在原点是光滑的（没有[尖点](@entry_id:636792)）。计算其局域能量可以发现，当 $r_1 \to 0$ 时，$E_L$ 会像 $-Z/r_1$ 一样发散到负无穷 [@problem_id:2448920]。这是一个明确的信号，表明该试探波函数的函数形式在根本上是有缺陷的。

#### [能量方差](@entry_id:156656)

衡量试探波函数质量的另一个定量指标是**[能量方差](@entry_id:156656)**（energy variance）：
$$
\sigma_H^2 = \langle (\hat{H} - \langle H \rangle)^2 \rangle = \langle \hat{H}^2 \rangle - \langle \hat{H} \rangle^2
$$
[能量方差](@entry_id:156656)衡量了当[哈密顿量](@entry_id:172864)作用于态 $\psi$ 时，所得到的结果偏离其平均值 $\langle H \rangle$ 的程度。根据[量子力学基本假设](@entry_id:155183)，如果一个态是[哈密顿量](@entry_id:172864)的[本征态](@entry_id:149904)，那么对其进行能量测量将唯一确定地得到对应的[本征值](@entry_id:154894)。这意味着[能量方差](@entry_id:156656)为零。因此，一个理想的[试探波函数](@entry_id:142892)应使其[能量方差](@entry_id:156656)为零。对于近似的[波函数](@entry_id:147440)，[方差](@entry_id:200758)越小，说明它“越接近”一个真实的本征态。

我们可以将最小化[能量方差](@entry_id:156656)作为变分优化的另一个目标，这被称为“[方差](@entry_id:200758)最小化”原理。以一维谐振子和高斯试探波函数 $\psi_b(x) \propto \exp(-bx^2/2)$ 为例 [@problem_id:2448869]，我们可以计算出[能量方差](@entry_id:156656)是参数 $b$ 的一个函数：
$$
\sigma_H^2 = \frac{(\hbar^2 b^2 - m^2\omega^2)^2}{8m^2b^2}
$$
这个表达式非常富有启发性。[方差](@entry_id:200758)显然是非负的，并且仅当分子为零时才等于零，即 $\hbar^2 b^2 = m^2\omega^2$，或 $b=m\omega/\hbar$。这个 $b$ 值恰恰是使高斯[试探波函数](@entry_id:142892)变为谐振子精确[基态](@entry_id:150928)本征函数的值。因此，通过最小化[能量方差](@entry_id:156656)（使其为零），我们不仅找到了最佳的[波函数](@entry_id:147440)，还直接恢复了精确解。在更一般的情况下，即使我们无法将[方差](@entry_id:200758)降至零，一个更小的[方差](@entry_id:200758)也通常对应着一个更准确的能量估计值。