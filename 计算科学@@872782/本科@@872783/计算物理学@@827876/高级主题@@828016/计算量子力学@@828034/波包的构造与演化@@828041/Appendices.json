{"hands_on_practices": [{"introduction": "波包在自由空间中的演化并不仅仅是单调地散开。实际上，其初始状态的相位结构能够决定它在散开之前是会先聚焦成一个更窄的波包，还是会立即开始弥散。这个练习 [@problem_id:2450147] 将通过解析方法，带你深入探索这种被称为“啁啾”(chirping)的现象，揭示波包在位置空间和动量空间分布之间的深刻联系。", "problem": "考虑一个一维、自由、非相对论的量子粒子，在使用普朗克约化常数和质量均为1的单位制下（即$\\hbar=1$和$m=1$）。状态$\\psi(x,t)$遵循自由粒子的含时薛定谔方程$i \\,\\partial \\psi / \\partial t = -\\tfrac{1}{2}\\,\\partial^2 \\psi / \\partial x^2$。在时间$t=0$时，归一化的波函数是一个具有二次相位的 高斯波包（啁啾高斯波包），由$\\psi(x,0) = A\\,\\exp\\!\\left(-a x^2\\right)\\exp\\!\\left(i b x^2\\right)$给出，其中$a0$和$b$是实数参数，$A$是归一化常数，其选择使得$\\int_{-\\infty}^{\\infty} |\\psi(x,0)|^2\\,dx = 1$。定义空间标准差$\\sigma_x(t)$为$\\sigma_x(t) = \\sqrt{\\langle x^2 \\rangle_t - \\langle x \\rangle_t^2}$，其中$\\langle \\cdot \\rangle_t$表示在时间$t$的量子期望值。对于这个初始条件，平均位置和平均动量均为零，因此对所有$t$都有$\\langle x \\rangle_t = 0$，所以$\\sigma_x(t) = \\sqrt{\\langle x^2 \\rangle_t}$。仅考虑时间正向演化，即$t \\ge 0$，确定$\\sigma_x(t)$达到其最小值的时间$t_\\mathrm{focus}$、相应的最小宽度$\\sigma_x(t_\\mathrm{focus})$，以及是否存在真正的正向时间自聚焦现象，该现象定义为存在某个$t0$使得$\\sigma_x(t)  \\sigma_x(0)$。使用以下参数对$(a,b)$的测试集，其中每个参数对都满足$a0$和$b$为实数：$(a,b)=(1,-1)$、$(a,b)=(1,0)$、$(a,b)=(\\tfrac{1}{2},-2)$、$(a,b)=(2,3)$、$(a,b)=(\\tfrac{1}{4},-\\tfrac{1}{2})$。对于每个测试用例，计算三个输出：聚焦时间$t_\\mathrm{focus}$、聚焦宽度$\\sigma_x(t_\\mathrm{focus})$，以及一个聚焦标志，如果发生正向时间自聚焦则为$1$，否则为$0$。所有报告的量都是无单位的。报告$t_\\mathrm{focus}$和$\\sigma_x(t_\\mathrm{focus})$时，四舍五入到六位小数，并将聚焦标志报告为整数$0$或$1$。你的程序应生成单行输出，其中包含结果，格式为逗号分隔的列表的列表，顺序与测试集相同，每个内部列表的格式为$[t_\\mathrm{focus},\\sigma_x(t_\\mathrm{focus}),\\mathrm{flag}]$，例如$[[t_1,\\sigma_1,f_1],[t_2,\\sigma_2,f_2],\\dots]$。", "solution": "问题陈述经确认为具有科学依据、提法恰当、客观且自洽。它描述了量子力学中的一个标准问题——高斯波包的时间演化——并且没有任何逻辑或事实上的不一致之处。所有必要的参数和定义均已提供。因此，我将进行完整的解析求解。\n\n该系统描述了一个质量为$m=1$的一维自由粒子，其运动由$\\hbar=1$的含时薛定谔方程（TDSE）决定：\n$$ i \\frac{\\partial \\psi(x,t)}{\\partial t} = -\\frac{1}{2} \\frac{\\partial^2 \\psi(x,t)}{\\partial x^2} $$\n在$t=0$时的初始状态是一个啁啾高斯波包：\n$$ \\psi(x,0) = A \\exp(-ax^2) \\exp(ibx^2) = A \\exp(-(a-ib)x^2) $$\n其中$a0$和$b$是实数参数，$A$是归一化常数。这个初始状态是一个具有复参数$\\gamma_0 = a-ib$的高斯函数。条件$a=\\Re(\\gamma_0)0$确保了波函数是可归一化的。\n\n自由粒子TDSE的一个关键性质是，初始的高斯波包在任何时候都保持为高斯形式。因此，我们可以为随时间演化的波函数提出以下形式的拟设：\n$$ \\psi(x,t) = A(t) \\exp(-\\gamma(t) x^2) $$\n其中$\\gamma(t)$是一个含时的复参数，$A(t)$是一个含时的归一化因子。将此拟设代入TDSE，通过令$x^2$的各次幂系数相等，可以得到两个常微分方程，一个用于$\\gamma(t)$，一个用于$A(t)$：\n$$ i \\frac{d\\gamma}{dt} = 2\\gamma(t)^2 $$\n这是一个关于$\\gamma(t)$的可分离一阶微分方程。我们在初始条件$\\gamma(0) = \\gamma_0 = a-ib$下求解它：\n$$ \\int_{\\gamma_0}^{\\gamma(t)} \\frac{d\\gamma'}{\\gamma'^2} = \\int_0^t -2i dt' \\implies \\left[-\\frac{1}{\\gamma'}\\right]_{\\gamma_0}^{\\gamma(t)} = -2it $$\n$$ -\\frac{1}{\\gamma(t)} + \\frac{1}{\\gamma_0} = -2it \\implies \\frac{1}{\\gamma(t)} = \\frac{1}{\\gamma_0} + 2it $$\n求解$\\gamma(t)$：\n$$ \\gamma(t) = \\frac{1}{1/\\gamma_0 + 2it} = \\frac{\\gamma_0}{1 + 2it\\gamma_0} $$\n代入$\\gamma_0=a-ib$：\n$$ \\gamma(t) = \\frac{a-ib}{1 + 2it(a-ib)} = \\frac{a-ib}{(1+2bt) + i(2at)} $$\n概率密度由$|\\psi(x,t)|^2 = |A(t)|^2 \\exp(-2\\Re(\\gamma(t))x^2)$给出。这是一个关于$x$的高斯分布。空间标准差$\\sigma_x(t)$与$\\gamma(t)$的实部有关。对于一个与$\\exp(-C x^2)$成正比的概率密度，其方差为$\\sigma_x^2 = 1/(2C)$。在我们的情况中，$C = 2\\Re(\\gamma(t))$，所以$\\sigma_x(t)^2 = 1/(4\\Re(\\gamma(t)))$。\n\n我们计算$\\gamma(t)$的实部：\n$$ \\Re(\\gamma(t)) = \\Re\\left(\\frac{a-ib}{(1+2bt) + i(2at)}\\right) = \\Re\\left(\\frac{(a-ib)((1+2bt) - i(2at))}{(1+2bt)^2 + (2at)^2}\\right) $$\n$$ \\Re(\\gamma(t)) = \\frac{a(1+2bt) - b(2at)}{(1+2bt)^2 + 4a^2t^2} = \\frac{a}{(1+2bt)^2 + 4a^2t^2} $$\n因此，宽度平方$\\sigma_x(t)^2$为：\n$$ \\sigma_x(t)^2 = \\frac{1}{4\\Re(\\gamma(t))} = \\frac{(1+2bt)^2 + 4a^2t^2}{4a} $$\n为了找到在$t \\ge 0$时$\\sigma_x(t)$最小化的时间$t_\\mathrm{focus}$，我们最小化$\\sigma_x(t)^2$。设$F(t) = \\sigma_x(t)^2$。我们展开$F(t)$的表达式：\n$$ F(t) = \\frac{1+4bt+4b^2t^2+4a^2t^2}{4a} = \\frac{1}{a}\\left(\\frac{1}{4} + bt + (a^2+b^2)t^2\\right) $$\n这是一个关于$t$的二次函数，表示一条抛物线。其最小值出现在导数为零的地方：\n$$ \\frac{dF}{dt} = \\frac{1}{a}(b + 2(a^2+b^2)t) = 0 $$\n$$ t = -\\frac{b}{2(a^2+b^2)} $$\n我们称这个时间为$t_\\mathrm{min}$。由于我们仅限于时间正向演化，$t \\ge 0$，我们必须考虑$t_\\mathrm{min}$的符号：\n\n情况1：$b  0$。\n$t_\\mathrm{min}  0$。抛物线的最小值出现在负时间。对于$t \\ge 0$，$F(t)$函数是严格单调递增的。因此，在$t \\ge 0$上的最小值在$t=0$处取到。\n$t_\\mathrm{focus} = 0$。\n最小宽度是初始宽度，$\\sigma_x(0) = \\sqrt{F(0)} = \\sqrt{\\frac{1}{4a}} = \\frac{1}{2\\sqrt{a}}$。\n\n情况2：$b = 0$。\n$t_\\mathrm{min} = 0$。最小值出现在$t=0$处。\n$t_\\mathrm{focus} = 0$。\n最小宽度是$\\sigma_x(0) = \\frac{1}{2\\sqrt{a}}$。\n\n情况3：$b  0$。\n$t_\\mathrm{min}  0$。最小值出现在正时间，因此是物理上可及的。\n$t_\\mathrm{focus} = -\\frac{b}{2(a^2+b^2)}$。\n为了找到最小宽度$\\sigma_x(t_\\mathrm{focus})$，我们将$t_\\mathrm{focus}$代回$F(t)$：\n$$ \\sigma_x(t_\\mathrm{focus})^2 = \\frac{1}{4a}\\left[1 - \\frac{2b^2}{a^2+b^2} + \\frac{4(a^2+b^2)b^2}{4(a^2+b^2)^2}\\right] = \\frac{1}{4a}\\left[1 - \\frac{b^2}{a^2+b^2}\\right] = \\frac{1}{4a}\\left[\\frac{a^2}{a^2+b^2}\\right] = \\frac{a}{4(a^2+b^2)} $$\n$$ \\sigma_x(t_\\mathrm{focus}) = \\sqrt{\\frac{a}{4(a^2+b^2)}} = \\frac{1}{2}\\sqrt{\\frac{a}{a^2+b^2}} $$\n\n最后，我们确定聚焦标志。如果存在某个$t  0$使得$\\sigma_x(t)  \\sigma_x(0)$，则发生真正的自聚焦。这等价于宽度在初始时刻减小，即$\\frac{dF}{dt}|_{t=0}  0$。\n$$ \\frac{dF}{dt}|_{t=0} = \\frac{b}{a} $$\n由于$a0$，符号由$b$决定。\n- 如果$b  0$，则$\\frac{dF}{dt}|_{t=0}  0$，所以宽度在初始时刻减小。发生聚焦。标志 = $1$。\n- 如果$b \\ge 0$，则$\\frac{dF}{dt}|_{t=0} \\ge 0$，所以宽度在$t=0$时是静止的或增加的。对于$t0$，宽度总是大于或等于初始宽度。不发生聚焦。标志 = $0$。\n\n现在将这些推导出的公式应用于所提供的测试用例。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the quantum wave packet focusing problem for a given set of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (1.0, -1.0),\n        (1.0, 0.0),\n        (0.5, -2.0),\n        (2.0, 3.0),\n        (0.25, -0.5)\n    ]\n\n    results = []\n    for a, b in test_cases:\n        # According to the derived analytical solution:\n        # The time evolution of the squared width is a parabola in t:\n        # sigma_x(t)^2 = (1/a) * (1/4 + b*t + (a^2+b^2)*t^2)\n        # The minimum of this parabola occurs at t_min = -b / (2*(a^2+b^2)).\n        # We need to find the minimum for t = 0.\n\n        if b  0:\n            # The global minimum occurs at a positive time t_focus  0.\n            # This corresponds to self-focusing.\n            t_focus = -b / (2 * (a**2 + b**2))\n            # The minimum width is sigma_x(t_focus) = 0.5 * sqrt(a / (a^2+b^2)).\n            sigma_focus = 0.5 * np.sqrt(a / (a**2 + b**2))\n            focusing_flag = 1\n        else:  # b = 0\n            # The global minimum is at t_min = 0. For t = 0, the width is\n            # monotonically increasing (or constant at t=0 if b=0).\n            # The minimum in the domain t = 0 is at t_focus = 0.\n            t_focus = 0.0\n            # The width is the initial width, sigma_x(0) = 1 / (2*sqrt(a)).\n            sigma_focus = 0.5 / np.sqrt(a)\n            focusing_flag = 0\n\n        # Format the results as required.\n        # Round floats to six decimal places.\n        # The flag is already an integer.\n        results.append(\n            f\"[{t_focus:.6f},{sigma_focus:.6f},{focusing_flag}]\"\n        )\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2450147"}, {"introduction": "在理解了自由演化之后，我们自然地转向研究相互作用。现实世界中的量子现象，如电子隧穿，都涉及粒子与势垒的相互作用。这个实践 [@problem_id:2450186] 将引导你从解析解转向数值模拟，亲手实现强大的分步傅里叶方法来求解含时薛定谔方程。你将模拟一个高斯波包从一个狄拉克 $\\delta$ 势垒上散射的过程，并将计算出的数值透射概率与经典的解析结果进行比较。", "problem": "考虑一个质量为 $m$ 的粒子在标量势 $V(x)$ 中运动的一维含时薛定谔方程，\n$$\ni \\hbar \\,\\frac{\\partial \\psi(x,t)}{\\partial t} \\;=\\; \\left[-\\frac{\\hbar^2}{2m}\\frac{\\partial^2}{\\partial x^2} \\;+\\; V(x)\\right]\\psi(x,t),\n$$\n遵循自然单位制约定，其中 $\\hbar = 1$ 且 $m = 1$，因此方程简化为\n$$\ni \\,\\frac{\\partial \\psi(x,t)}{\\partial t} \\;=\\; \\left[-\\frac{1}{2}\\frac{\\partial^2}{\\partial x^2} \\;+\\; V(x)\\right]\\psi(x,t).\n$$\n设势为一个位于 $x_0$ 的狄拉克 $\\delta$ 势垒，由 $V(x) = \\alpha \\,\\delta(x - x_0)$ 给出。时刻 $t=0$ 的初始态是一个归一化的高斯波包\n$$\n\\psi(x,0) \\;=\\; \\mathcal{N}\\,\\exp\\!\\left[-\\frac{(x-x_c)^2}{2\\sigma_x^2}\\right]\\exp\\!\\left[i\\,k_0\\,(x-x_c)\\right],\n$$\n其中心位置为 $x_c$，空间宽度为 $\\sigma_x$，平均波数为 $k_0$，其中 $\\mathcal{N}$ 是确保 $\\int_{-\\infty}^{\\infty} |\\psi(x,0)|^2\\,dx = 1$ 的归一化常数。在此单位制下，波数为 $k$ 的平面波入射到狄拉克 $\\delta$ 势上，其解析透射系数为\n$$\nT_{\\text{analytic}}(k,\\alpha) \\;=\\; \\frac{k^2}{k^2 + \\alpha^2}.\n$$\n\n你的任务是编写一个完整的、可运行的程序，对 $\\psi(x,t)$ 进行有限时间的数值演化，并估计从势垒散射后的透射概率，然后将其与几个测试案例的 $T_{\\text{analytic}}(k_0,\\alpha)$ 进行比较。\n\n为确保明确的评估，仿真要求和约定如下：\n- 使用长度为 $L = 200$ 的空间域，覆盖区间 $[-L/2, L/2)$，包含 $N = 1024$ 个均匀间隔的格点，因此网格间距为 $\\Delta x = L/N$。在此区间上使用周期性边界条件。\n- 将势垒置于 $x_0 = 0$。通过格点上的离散势 $V_j$ 对狄拉克 $\\delta$ 函数进行数值表示，该离散势满足积分约束 $\\sum_{j=0}^{N-1} V_j\\,\\Delta x = \\alpha$，且其支撑集局域在最接近 $x_0$ 的格点上。这确保了在离散化模型中势垒的积分强度是正确的。\n- 使用恒定的时间步长 $\\Delta t = 0.01$，将波函数演化至最终时刻 $t_f = 30$。\n- 使用初始波包参数 $x_c = -30$ 和 $\\sigma_x = 2.0$（无量纲单位）。\n- 演化到时刻 $t_f$ 后，按如下方式估计透射概率\n$$\nT_{\\text{num}} \\;=\\; \\int_{xx_{\\text{cut}}} |\\psi(x,t_f)|^2\\,dx,\n$$\n其中截断位置为 $x_{\\text{cut}} = 10$。在离散模型中，将该积分解释为间距为 $\\Delta x$ 的黎曼和。\n\n测试套件：\n- 案例 1：$(\\alpha, k_0) = (0.5, 3.0)$。\n- 案例 2：$(\\alpha, k_0) = (5.0, 2.0)$。\n- 案例 3：$(\\alpha, k_0) = (0.0, 2.5)$。\n- 案例 4：$(\\alpha, k_0) = (2.0, 1.5)$。\n\n对每个案例，计算绝对误差\n$$\n\\varepsilon \\;=\\; \\left|T_{\\text{num}} - T_{\\text{analytic}}(k_0,\\alpha)\\right|.\n$$\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含所有四个案例的结果，形式为一个由方括号括起来的、逗号分隔的浮点绝对误差列表，例如 $[e_1,e_2,e_3,e_4]$，其中每个 $e_j$ 是上述定义的相应案例的 $\\varepsilon$ 值。在上面定义的自然单位制约定下，所有量均为无量纲。", "solution": "问题陈述经过严格验证，确认有效。它提出了一个适定、有科学依据的计算量子力学问题，没有矛盾或歧义。数值模拟所需的所有必要参数和条件均已提供。因此，我们可以着手求解。\n\n任务是模拟一个一维高斯波包与狄拉克 $\\delta$ 势垒相互作用的时间演化，该过程由薛定谔方程控制。我们将数值计算透射概率，并将其与解析近似值进行比较。由于分裂步傅里叶方法适用于给定的哈密顿量结构和边界条件，因此选择该算法进行时间演化。\n\n该求解过程通过以下结构化步骤实现：\n\n1.  **无界域的离散化**。问题设定在无限域上，但为了计算必须将其限制在有限范围内。我们在区间 $x \\in [-L/2, L/2)$ 上建立一个足够大的一维空间网格，其长度 $L=200.0$，包含 $N=1024$ 个均匀间隔的点。这种区域选择确保了波包在模拟时间 $t_f=30.0$ 内不会与边界相互作用。施加周期性边界条件，这对于基于傅里叶的方法是很自然的。网格间距为 $\\Delta x = L/N$。格点的坐标为 $x_j = -L/2 + j\\Delta x$，其中 $j = 0, 1, \\ldots, N-1$。傅里叶空间中动能算子所需的相应波数网格由一组离散波数 $k_n$ 给出，可以使用 `numpy.fft.fftfreq` 高效计算。其关系为 $k = 2\\pi F$，其中 $F$ 是该函数返回的频率。\n\n2.  **初始态构建**。时刻 $t=0$ 的初始波函数是一个高斯波包，由复值函数描述：\n    $$\n    \\psi(x,0) \\;=\\; \\mathcal{N}\\,\\exp\\!\\left[-\\frac{(x-x_c)^2}{2\\sigma_x^2}\\right]\\exp\\!\\left[i\\,k_0\\,(x-x_c)\\right]\n    $$\n    问题指定了初始中心位置 $x_c=-30.0$、空间宽度 $\\sigma_x=2.0$，并为每个测试案例提供了平均波数 $k_0$。归一化常数 $\\mathcal{N}$ 确保总概率为1，即 $\\int_{-\\infty}^{\\infty} |\\psi(x,0)|^2\\,dx = 1$。其解析值为 $\\mathcal{N} = (\\pi\\sigma_x^2)^{-1/4}$。我们使用这些参数在空间网格上构建一个表示 $\\psi(x_j, 0)$ 的复值数组。\n\n3.  **势的表示**。势是一个位于 $x_0=0$ 的狄拉克 $\\delta$ 势垒，即 $V(x) = \\alpha \\,\\delta(x - x_0)$。在我们的离散模型中，这个理想化的势被一个仅在最接近 $x_0=0$ 的单个格点 $x_{j_0}$ 处非零的势所近似。对于我们的对称网格，该点为 $x_{N/2} = 0$。为保持 $\\delta$ 函数的积分强度，我们强制执行条件 $\\sum_{j=0}^{N-1} V_j\\,\\Delta x = \\alpha$。这意味着势数组 $V_j$ 在除索引 $j_0=N/2$ 之外的所有位置均为零，在该索引处其值为 $V_{j_0} = \\alpha / \\Delta x$。\n\n4.  **时间演化算法：分裂步傅里叶方法**。我们求解的是含时薛定谔方程 $i \\frac{\\partial \\psi}{\\partial t} = \\hat{H}\\psi$，其中哈密顿量为 $\\hat{H} = \\hat{T} + \\hat{V}$。动能算子为 $\\hat{T} = -\\frac{1}{2}\\frac{\\partial^2}{\\partial x^2}$，势能算子为 $\\hat{V} = V(x)$。由于 $\\hat{T}$ 和 $\\hat{V}$ 不对易，形式解 $\\psi(t+\\Delta t) = e^{-i\\hat{H}\\Delta t}\\psi(t)$ 需要对矩阵指数进行近似。我们使用二阶精度的斯特朗分裂格式（一种对称的特罗特-铃木分解）：\n    $$\n    e^{-i(\\hat{T}+\\hat{V})\\Delta t} \\approx e^{-i\\hat{V}\\Delta t/2} e^{-i\\hat{T}\\Delta t} e^{-i\\hat{V}\\Delta t/2}\n    $$\n    将波函数演化一个时间步长 $\\Delta t$ 的算法如下：\n    a. 在势算子作用下演化半个时间步长，$\\Delta t/2$。在位置空间中，这是一个简单的乘法：$\\psi'(x) = e^{-iV(x)\\Delta t/2}\\psi(x)$。\n    b. 在动能算子作用下演化一个完整的时间步长，$\\Delta t$。这在动量空间中最高效，因为在动量空间中 $\\hat{T}$ 是一个简单的乘法算子。动量空间中的算子为 $\\hat{T}_k = k^2/2$。过程如下：\n        i. 使用快速傅里叶变换（FFT）将波函数变换到动量空间：$\\tilde{\\psi}'(k) = \\mathcal{F}\\{\\psi'(x)\\}$。\n        ii. 乘以动能演化因子：$\\tilde{\\psi}''(k) = e^{-i(k^2/2)\\Delta t}\\tilde{\\psi}'(k)$。\n        iii. 使用逆傅里叶变换（inverse FFT）将其变换回位置空间：$\\psi''(x) = \\mathcal{F}^{-1}\\{\\tilde{\\psi}''(k)\\}$。\n    c. 再次在势算子作用下演化第二个半时间步长，$\\Delta t/2$：$\\psi(x,t+\\Delta t) = e^{-iV(x)\\Delta t/2}\\psi''(x)$。\n    这整个序列保持波函数的范数（幺正性）并且是无条件稳定的。我们重复此过程 $N_t = t_f/\\Delta t = 30.0 / 0.01 = 3000$ 步，以达到最终时间 $t_f=30.0$。\n\n5.  **透射概率的计算**。演化到 $t=t_f$ 后，系统的最终状态由波函数 $\\psi(x, t_f)$ 给出。透射概率 $T_{\\text{num}}$ 定义为在截断点 $x_{\\text{cut}}=10.0$ 右侧区域找到粒子的概率。这通过对该区域上的概率密度 $|\\psi(x, t_f)|^2$ 进行积分来计算。该积分在离散网格上通过黎曼和近似：\n    $$\n    T_{\\text{num}} \\;=\\; \\sum_{j \\text{ s.t. } x_j  x_{\\text{cut}}} |\\psi(x_j, t_f)|^2 \\Delta x\n    $$\n\n6.  **误差计算**。对于由一对参数 $(\\alpha, k_0)$ 定义的每个测试案例，将数值计算出的透射率 $T_{\\text{num}}$ 与波数为 $k_0$ 的平面波入射到相同 $\\delta$ 势上的解析透射系数进行比较：\n    $$\n    T_{\\text{analytic}}(k_0,\\alpha) \\;=\\; \\frac{k_0^2}{k_0^2 + \\alpha^2}\n    $$\n    计算绝对误差 $\\varepsilon = |T_{\\text{num}} - T_{\\text{analytic}}(k_0,\\alpha)|$。这个误差量化了波包行为与理想化平面波模型的偏差，以及任何数值不精确性。最终输出是针对四个指定测试案例的这些误差的列表。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the time-dependent Schrödinger equation for a Gaussian wave packet\n    colliding with a Dirac delta potential. It computes the numerical transmission\n    probability and compares it to the analytical formula for several test cases.\n    \"\"\"\n    \n    # Simulation parameters\n    L = 200.0\n    N = 1024\n    dx = L / N\n    x = np.linspace(-L / 2, L / 2, N, endpoint=False)\n    k = 2 * np.pi * np.fft.fftfreq(N, d=dx)\n\n    tf = 30.0\n    dt = 0.01\n    n_steps = int(tf / dt)\n\n    # Initial wave packet parameters\n    xc = -30.0\n    sigma_x = 2.0\n\n    # Cutoff position for transmission calculation\n    x_cut = 10.0\n\n    # Test cases: (alpha, k0)\n    test_cases = [\n        (0.5, 3.0),\n        (5.0, 2.0),\n        (0.0, 2.5),\n        (2.0, 1.5)\n    ]\n\n    results = []\n\n    for alpha, k0 in test_cases:\n        # Step 1: Construct the initial wave function at t=0\n        # Normalization constant for the Gaussian packet\n        norm_const = (1 / (np.pi * sigma_x**2))**0.25\n        # The wave packet in position space\n        psi = norm_const * np.exp(-(x - xc)**2 / (2 * sigma_x**2)) * np.exp(1j * k0 * (x - xc))\n        \n        # In a discrete simulation, it's robust to re-normalize numerically.\n        initial_norm = np.sqrt(np.sum(np.abs(psi)**2) * dx)\n        psi = psi / initial_norm\n\n        # Step 2: Define the potential V(x)\n        V = np.zeros(N)\n        # Approximate the Dirac delta function at x=0\n        # The grid point x=0 is at index N/2 for our setup\n        if alpha != 0.0:\n            x0_idx = N // 2\n            V[x0_idx] = alpha / dx\n\n        # Step 3: Define the evolution operators for the split-step method\n        # Evolution under potential V for a half time step\n        exp_V_half = np.exp(-1j * V * dt / 2.0)\n        # Evolution under kinetic energy T for a full time step\n        exp_T = np.exp(-1j * (k**2 / 2.0) * dt)\n        \n        # Step 4: Time evolution loop using the split-step Fourier method\n        for _ in range(n_steps):\n            # First half-step in potential space\n            psi = exp_V_half * psi\n            \n            # Full step in momentum space\n            psi_k = np.fft.fft(psi)\n            psi_k = exp_T * psi_k\n            psi = np.fft.ifft(psi_k)\n            \n            # Second half-step in potential space\n            psi = exp_V_half * psi\n\n        # Step 5: Calculate numerical transmission probability\n        # Probability density at final time tf\n        prob_density = np.abs(psi)**2\n        # Create a boolean mask for the region x  x_cut\n        transmission_mask = x  x_cut\n        # Compute the transmitted probability via Riemann sum\n        T_num = np.sum(prob_density[transmission_mask]) * dx\n        \n        # Step 6: Calculate analytical transmission coefficient\n        T_analytic = k0**2 / (k0**2 + alpha**2)\n        \n        # Step 7: Compute the absolute error\n        error = np.abs(T_num - T_analytic)\n        results.append(error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2450186"}, {"introduction": "继研究了自由和散射的波包之后，我们现在将目光投向被束缚的量子系统。当一个粒子被限制在如无限深方势阱这样的势阱中时，其能量是量子化的。这个练习 [@problem_id:2450192] 揭示了这种能量量子化带来的一个惊人后果：波包在演化足够长的时间后，会周期性地重新组合成其初始形态，这一现象被称为“量子复苏”。通过这项解析实践，你将推导出复苏时间，并理解一个系统的基本属性如何决定其长期的动力学行为。", "problem": "一个质量为 $m$ 的非相对论性粒子被限制在宽度为 $L$ 的一维无限深方势阱中，区间为 $x \\in [0,L]$。其定态由 $\\psi_n(x) = \\sqrt{\\frac{2}{L}} \\sin\\!\\left(\\frac{n \\pi x}{L}\\right)$ 给出（其中整数 $n \\geq 1$），对应的能量为 $E_n = \\frac{n^2 \\pi^2 \\hbar^2}{2 m L^2}$。考虑在 $t=0$ 时刻，一个初始归一化波包被构建为这些定态的叠加：\n$$\n\\Psi(x,0) = \\sum_{n=1}^{\\infty} c_n \\, \\psi_n(x),\n$$\n其中复系数 $c_n$ 的选择满足 $c_n \\propto \\exp\\!\\left(-\\frac{(n-n_0)^2}{2 \\sigma_n^2}\\right) e^{i \\phi_n}$，对于某个实中心量子数 $n_0 \\gg 1$、谱宽 $\\sigma_n  0$ 以及任意实相位 $\\phi_n$。其时间演化为 $\\Psi(x,t) = \\sum_{n=1}^{\\infty} c_n \\, e^{-i E_n t/\\hbar} \\, \\psi_n(x)$。定义首次完全量子复现时间 $T_{\\mathrm{rev}}$ 为满足 $\\Psi(x,t) = e^{i \\theta} \\Psi(x,0)$ 的最小正时间 $t$，其中该等式对所有 $x \\in [0,L]$ 和某个实全局相位 $\\theta$ 成立。\n\n您的任务是，对于每个指定的测试用例，仅根据势阱宽度 $L$ 和粒子质量 $m$ 计算首次完全量子复现时间 $T_{\\mathrm{rev}}$，并以秒为单位报告结果。在国际单位制（SI）中，使用约化普朗克常数 $\\hbar = 1.054\\,571\\,817 \\times 10^{-34}\\,\\mathrm{J\\,s}$。将所有最终答案以秒为单位表示，并采用科学记数法格式，小数点后精确到十二位。\n\n测试套件（每个测试用例是在国际单位制下的一对 $(m,L)$）：\n- 案例 1：$m = 9.109\\,383\\,7015 \\times 10^{-31}\\,\\mathrm{kg}$，$L = 1.0 \\times 10^{-9}\\,\\mathrm{m}$。\n- 案例 2：$m = 1.672\\,621\\,923\\,69 \\times 10^{-27}\\,\\mathrm{kg}$，$L = 1.0 \\times 10^{-9}\\,\\mathrm{m}$。\n- 案例 3：$m = 9.109\\,383\\,7015 \\times 10^{-31}\\,\\mathrm{kg}$，$L = 5.0 \\times 10^{-10}\\,\\mathrm{m}$。\n- 案例 4：$m = 9.109\\,383\\,7015 \\times 10^{-31}\\,\\mathrm{kg}$，$L = 5.0 \\times 10^{-8}\\,\\mathrm{m}$。\n- 案例 5：$m = 9.109\\,383\\,7015 \\times 10^{-31}\\,\\mathrm{kg}$，$L = 1.0 \\times 10^{-11}\\,\\mathrm{m}$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含案例1到案例5的五个复现时间列表，顺序与所列相同，以秒为单位，采用科学记数法格式，小数点后精确到十二位，作为一个用方括号括起来的逗号分隔列表。例如，带有占位符值的输出行将如下所示\n$[1.234000000000e-05,2.345000000000e-04,3.456000000000e-03,4.567000000000e-02,5.678000000000e-01]$。", "solution": "提交分析的问题陈述被认为是有效的。它具有科学依据、问题明确、客观、自洽且一致。该问题描述了量子力学中的一个典型系统——限制在一维无限深方势阱中的非相对论性粒子——并要求计算完全量子复现时间，这是一个定义明确且被广泛理解的现象。所提供的数据和常数对于计算是充分且物理上适当的。\n\n目标是推导宽度为 $L$ 的一维无限深方势阱中波包的首次完全量子复现时间 $T_{\\mathrm{rev}}$ 的表达式。\n\n系统在任意时刻 $t$ 的状态由定态 $\\psi_n(x)$ 的叠加给出：\n$$\n\\Psi(x,t) = \\sum_{n=1}^{\\infty} c_n \\, e^{-i E_n t/\\hbar} \\, \\psi_n(x)\n$$\n其中 $E_n$ 是能量本征值。对于区间 $x \\in [0,L]$ 上宽度为 $L$ 的无限深方势阱，这些能量由下式给出：\n$$\nE_n = \\frac{n^2 \\pi^2 \\hbar^2}{2 m L^2}\n$$\n方便地，可以将其表示为 $E_n = n^2 E_1$，其中 $E_1 = \\frac{\\pi^2 \\hbar^2}{2 m L^2}$ 是基态能量。整数 $n$ 必须大于或等于1。\n\n完全量子复现发生在最小正时间 $t = T_{\\mathrm{rev}}$，此时波函数回到其初始状态，最多相差一个全局相位因子 $e^{i\\theta}$。该条件可以正式表述为：\n$$\n\\Psi(x, T_{\\mathrm{rev}}) = e^{i\\theta} \\Psi(x,0)\n$$\n对于某个实常数 $\\theta$。代入 $T_{\\mathrm{rev}}$ 和 $t=0$ 时刻的波函数表达式：\n$$\n\\sum_{n=1}^{\\infty} c_n \\, e^{-i E_n T_{\\mathrm{rev}}/\\hbar} \\, \\psi_n(x) = e^{i\\theta} \\sum_{n=1}^{\\infty} c_n \\, \\psi_n(x)\n$$\n由于定态 $\\psi_n(x)$ 构成一个标准正交基，我们可以令每个分量 $n$ 的系数相等。这对于叠加中存在的每个状态 $n$（即 $c_n \\neq 0$ 的状态）都必须成立：\n$$\nc_n \\, e^{-i E_n T_{\\mathrm{rev}}/\\hbar} = e^{i\\theta} c_n\n$$\n对于一个非平凡波包，至少有两个系数 $c_n$ 不为零。对于这些系数，我们可以除以 $c_n$ 得到：\n$$\ne^{-i E_n T_{\\mathrm{rev}}/\\hbar} = e^{i\\theta}\n$$\n这个条件意味着，对于叠加中的每一个 $n$，时间演化因子的相位都必须等于一个单一的、共同的值。这可以表示为：\n$$\n\\frac{E_n T_{\\mathrm{rev}}}{\\hbar} = 2\\pi k_n - \\theta\n$$\n其中 $k_n$ 是一个可以依赖于 $n$ 的整数。\n\n代入能量本征值 $E_n = n^2 E_1$：\n$$\nn^2 \\frac{E_1 T_{\\mathrm{rev}}}{\\hbar} = 2\\pi k_n - \\theta\n$$\n为了使该条件对所有相关的 $n$ 值成立，任意两个状态之间的相位差必须是 $2\\pi$ 的整数倍。让我们考虑相对于基态（$n=1$）的相位差：\n$$\n\\left( n^2 \\frac{E_1 T_{\\mathrm{rev}}}{\\hbar} \\right) - \\left( 1^2 \\frac{E_1 T_{\\mathrm{rev}}}{\\hbar} \\right) = (2\\pi k_n - \\theta) - (2\\pi k_1 - \\theta)\n$$\n化简后得到：\n$$\n(n^2 - 1) \\frac{E_1 T_{\\mathrm{rev}}}{\\hbar} = 2\\pi (k_n - k_1)\n$$\n对于完全复现，这必须对叠加中所有可能的整数 $n  1$ 都成立。问题陈述指明了一个以大量子数 $n_0$ 为中心的波包，这意味着一个宽泛的能谱。因此，该条件必须对许多整数成立。我们定义一个无量纲量 $F = \\frac{E_1 T_{\\mathrm{rev}}}{2\\pi \\hbar}$。条件变为对于所有相关的 $n \\geq 2$，$(n^2 - 1)F$ 必须是整数。\n\n为了对所有整数 $n$ 都满足此条件，$F$ 必须被恰当地选择。对于 $n=2$，我们要求 $(2^2-1)F = 3F$ 为整数。对于 $n=3$，我们要求 $(3^2-1)F = 8F$ 为整数。由于 $3$ 和 $8$ 的最大公约数为 $1$，要使 $3F$ 和 $8F$ 均为整数，$F$ 本身必须是整数。\n\n最小正复现时间 $T_{\\mathrm{rev}}$ 对应于 $F$ 的最小正整数值，即 $F=1$。\n$$\n\\frac{E_1 T_{\\mathrm{rev}}}{2\\pi \\hbar} = 1\n$$\n求解 $T_{\\mathrm{rev}}$：\n$$\nT_{\\mathrm{rev}} = \\frac{2\\pi \\hbar}{E_1}\n$$\n现在，我们代入基态能量 $E_1$ 的表达式：\n$$\nT_{\\mathrm{rev}} = \\frac{2\\pi \\hbar}{\\frac{\\pi^2 \\hbar^2}{2 m L^2}} = \\frac{2\\pi \\hbar (2 m L^2)}{\\pi^2 \\hbar^2}\n$$\n这化简为首次完全量子复现时间的最终表达式：\n$$\nT_{\\mathrm{rev}} = \\frac{4 m L^2}{\\pi \\hbar}\n$$\n如此问题中所述，此公式仅依赖于粒子质量 $m$、势阱宽度 $L$ 和基本常数 $\\hbar$。波包的具体形状（即 $c_n$ 的值）不影响完全复现时间。该表达式将用于数值计算。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the first full quantum revival time for a particle in a 1D\n    infinite square well for several test cases.\n    \"\"\"\n    # The reduced Planck constant in SI units (Joule-seconds).\n    hbar = 1.054571817e-34\n\n    # Test suite: each tuple contains (mass in kg, well width in m).\n    test_cases = [\n        # Case 1: Electron in a 1 nm well\n        (9.1093837015e-31, 1.0e-9),\n        # Case 2: Proton in a 1 nm well\n        (1.67262192369e-27, 1.0e-9),\n        # Case 3: Electron in a 0.5 nm well\n        (9.1093837015e-31, 5.0e-10),\n        # Case 4: Electron in a 50 nm well\n        (9.1093837015e-31, 5.0e-8),\n        # Case 5: Electron in a 0.01 nm well\n        (9.1093837015e-31, 1.0e-11),\n    ]\n\n    results = []\n    for m, L in test_cases:\n        # The formula for the full quantum revival time is T_rev = (4 * m * L^2) / (pi * hbar).\n        t_rev = (4 * m * L**2) / (np.pi * hbar)\n        results.append(t_rev)\n\n    # Format the results into a string as per the problem specification.\n    # Each result is in scientific notation with exactly twelve decimal places.\n    formatted_results = [f\"{res:.12e}\" for res in results]\n    \n    # Print the final output in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n\n```", "id": "2450192"}]}