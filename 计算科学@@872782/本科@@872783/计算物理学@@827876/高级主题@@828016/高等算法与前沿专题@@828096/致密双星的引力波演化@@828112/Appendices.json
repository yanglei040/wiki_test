{"hands_on_practices": [{"introduction": "旋进是双星系统生命周期中最长的阶段，精确模拟其演化，尤其是累积的引力波相位，对于引力波的探测至关重要。本练习将指导你从能量平衡原理出发，推导出描述旋进过程的核心微分方程。更重要的是，你将学习如何通过分析数值误差来评估模拟的可靠性，这是所有计算科学领域的一项基本技能 [@problem_id:2399139]。", "problem": "考虑一个等质量的致密双星系统，其在圆轨道上运行并辐射引力波（GW）。您将使用四极近似、牛顿轨道动力学和能量平衡来模拟其旋进过程，并研究累积的 GW 相位数值误差如何随固定时间步长的增加而增长。您的程序必须实现一个固定步长积分器来演化该系统，将相位与使用更小步长计算的高精度参考值进行比较，并报告绝对相位误差作为步长的函数。\n\n物理设定与基本依据：\n- 设成员质量为 $m_1 = m_2 = 1.4 \\, M_\\odot$，其中 $M_\\odot$ 是太阳质量。\n- 使用国际单位制（SI）中的标准常数：$G = 6.67430 \\times 10^{-11} \\ \\mathrm{m^3 \\, kg^{-1} \\, s^{-2}}$，$c = 2.99792458 \\times 10^{8} \\ \\mathrm{m \\, s^{-1}}$，以及 $M_\\odot = 1.98847 \\times 10^{30} \\ \\mathrm{kg}$。\n- 假设为圆轨道和牛顿引力，其中开普勒定律将轨道频率 $f_{\\mathrm{orb}}$ 与间距 $r$ 相关联：$(2\\pi f_{\\mathrm{orb}})^2 r^3 = G (m_1 + m_2)$。\n- 双星系统的引力束缚能为 $E = - \\dfrac{G m_1 m_2}{2 r}$。\n- 圆轨道双星系统的主导阶引力波光度（功率）为 $P_{\\mathrm{GW}} = \\dfrac{32}{5} \\dfrac{G^4}{c^5} \\dfrac{m_1^2 m_2^2 (m_1 + m_2)}{r^5}$。\n- 引力波频率是轨道频率的两倍，$f(t) = 2 f_{\\mathrm{orb}}(t)$，且 GW 相位满足 $\\dfrac{d\\phi}{dt} = 2\\pi f(t)$。\n\n任务：\n1. 严格从上述关系和能量平衡定律 $\\dfrac{dE}{dt} = - P_{\\mathrm{GW}}$ 出发，推导出一个关于 $\\dfrac{df}{dt}$ 的显式演化方程，该方程仅用啁啾质量和瞬时 GW 频率 $f(t)$ 表示。不得未经推导就假设或引用任何现成结果。\n2. 实现一个使用经典四阶龙格－库塔（RK4）方法的固定步长常微分方程（ODE）求解器，以积分耦合系统 $(\\phi(t), f(t))$：\n   - 初始条件：$f(0) = f_0$ 和 $\\phi(0) = 0$，其中 $f_0 = 30 \\ \\mathrm{Hz}$。\n   - 积分至终止时间 $T_{\\mathrm{end}} = 40 \\ \\mathrm{s}$。\n   - 角度单位必须是弧度，频率单位是 $\\mathrm{Hz}$，时间单位是 $\\mathrm{s}$，质量单位是 $\\mathrm{kg}$。\n3. 使用一个非常小的固定步长 $\\Delta t_{\\mathrm{ref}} = 10^{-3} \\ \\mathrm{s}$ 和相同的积分方案，计算在 $t = T_{\\mathrm{end}}$ 时的高精度参考相位 $\\phi_{\\mathrm{ref}}$。\n4. 对于每个给定的步长 $\\Delta t$，计算在 $t = T_{\\mathrm{end}}$ 时的绝对相位误差 $|\\phi_{\\Delta t} - \\phi_{\\mathrm{ref}}|$，其中 $\\phi_{\\Delta t}$ 是使用步长 $\\Delta t$ 获得的相位。\n5. 您的实现必须在数值上是自洽的：如果 $T_{\\mathrm{end}}$ 不是 $\\Delta t$ 的整数倍，则最后一个 RK4 步骤必须使用剩余的时间，以确保相位在 $t = T_{\\mathrm{end}}$ 时被精确计算。\n\n测试组：\n- 使用以下固定步长 $\\Delta t$ (单位为秒)：$[0.5, 0.25, 0.1, 0.05, 0.025]$。\n- 对于上述每个 $\\Delta t$，输出在 $t = T_{\\mathrm{end}}$ 时的绝对相位误差，结果为浮点数（单位为弧度），四舍五入至六位小数。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表（例如，“[x1,x2,x3,x4,x5]”）。具体来说，按照与上述五个 $\\Delta t$ 值相同的顺序，打印包含这五个四舍五入后的绝对相位误差的列表。", "solution": "所述问题在科学上是合理的、适定的和客观的。它描述了计算天体物理学中的一个标准问题：使用后牛顿近似模拟致密双星系统的旋进阶段。所有物理定律、常数和初始条件都已给出，构成了一个完整且一致的初值问题。该任务涉及推导控制微分方程和分析积分方案的数值误差，是计算物理学中的一项基础练习。因此，该问题是有效的，并将提供解决方案。\n\n解决方案分三个阶段进行。首先，我们推导引力波频率的演化方程。其次，我们描述数值积分方案。第三，我们概述用于计算相位演化及其数值误差的实现方法。\n\n**1. 频率演化方程的推导**\n\n目标是推导出一个以引力波频率 $f$ 和系统的啁啾质量 $\\mathcal{M}_c$ 表示的 $\\frac{df}{dt}$ 表达式。我们从给定的物理关系开始。\n\n能量平衡定律指出，双星轨道能量 $E$ 的变化率等于以引力波形式辐射出去的功率 $P_{\\mathrm{GW}}$ 的负值：\n$$\n\\frac{dE}{dt} = -P_{\\mathrm{GW}}\n$$\n为求出 $\\frac{df}{dt}$，我们使用链式法则：$\\frac{df}{dt} = \\frac{df}{dr} \\frac{dr}{dt}$。首先需要找到 $\\frac{dr}{dt}$。从能量平衡方程出发：\n$$\n\\frac{dE}{dr}\\frac{dr}{dt} = -P_{\\mathrm{GW}}\n$$\n对能量 $E = - \\frac{G m_1 m_2}{2 r}$ 求导，得到 $\\frac{dE}{dr} = \\frac{G m_1 m_2}{2 r^2}$。代入以上方程：\n$$\n\\left(\\frac{G m_1 m_2}{2 r^2}\\right)\\frac{dr}{dt} = - \\frac{32}{5} \\frac{G^4}{c^5} \\frac{m_1^2 m_2^2 (m_1 + m_2)}{r^5}\n$$\n求解 $\\frac{dr}{dt}$ 得：\n$$\n\\frac{dr}{dt} = - \\frac{64}{5} \\frac{G^3 m_1 m_2 (m_1+m_2)}{c^5 r^3}\n$$\n接下来，我们需要将引力波频率 $f$ 和轨道间距 $r$ 联系起来。根据开普勒第三定律和 $f=2f_{\\mathrm{orb}}$，我们有：\n$$\n(\\pi f)^2 r^3 = G M \\implies r = (GM)^{1/3} (\\pi f)^{-2/3}\n$$\n对上式关于时间 $t$ 求导，得到 $\\frac{dr}{dt}$ 和 $\\frac{df}{dt}$ 之间的关系：\n$$\n\\frac{dr}{dt} = (GM)^{1/3} \\pi^{-2/3} \\left(-\\frac{2}{3} f^{-5/3}\\right) \\frac{df}{dt}\n$$\n现在我们有两个 $\\frac{dr}{dt}$ 的表达式，令它们相等：\n$$\n(GM)^{1/3} \\pi^{-2/3} \\left(-\\frac{2}{3} f^{-5/3}\\right) \\frac{df}{dt} = - \\frac{64}{5} \\frac{G^3 \\mu M^2}{c^5} \\left((GM)^{1/3} (\\pi f)^{-2/3}\\right)^{-3}\n$$\n$$\n(GM)^{1/3} \\pi^{-2/3} \\left(-\\frac{2}{3} f^{-5/3}\\right) \\frac{df}{dt} = - \\frac{64}{5} \\frac{G^3 \\mu M^2}{c^5} (GM)^{-1} (\\pi f)^2\n$$\n求解 $\\frac{df}{dt}$：\n$$\n\\frac{df}{dt} = \\frac{64}{5} \\frac{G^2 \\mu M}{c^5} (\\pi f)^2 \\cdot \\frac{3}{2} (GM)^{-1/3} \\pi^{2/3} f^{5/3} = \\frac{96}{5} \\frac{G^{5/3} \\mu M^{2/3}}{c^5} \\pi^{8/3} f^{11/3}\n$$\n最后，引入啁啾质量 $\\mathcal{M}_c = \\mu^{3/5} M^{2/5}$。我们可以看到质量项 $\\mu M^{2/3}$ 正好等于 $\\mathcal{M}_c^{5/3}$。代入后得到最终的演化方程：\n$$\n\\frac{df}{dt} = \\frac{96}{5 c^5} (G\\mathcal{M}_c)^{5/3} \\pi^{8/3} f^{11/3}\n$$\n这个表达式是正确、标准的结果，并且是严格从问题给定的关系推导出来的。\n\n**2. 数值方法与方程组**\n\n双星系统的演化由一对关于状态向量 $\\mathbf{y}(t) = [\\phi(t), f(t)]^T$ 的耦合一阶常微分方程（ODE）描述。\n$$\n\\dfrac{d\\mathbf{y}}{dt} = \\begin{pmatrix} d\\phi/dt \\\\ df/dt \\end{pmatrix} = \\mathbf{F}(f) = \\begin{pmatrix} 2\\pi f \\\\ \\mathcal{K} f^{11/3} \\end{pmatrix}\n$$\n其中 $\\mathcal{K} = \\dfrac{96}{5 c^5} (G\\mathcal{M}_c)^{5/3} \\pi^{8/3}$ 是一个常数。该系统是自治的，因为导数仅依赖于状态变量，而不显式地依赖于时间 $t$。初始条件为 $\\mathbf{y}(0) = [0, f_0]^T$。\n\n为了数值求解该系统，我们采用经典的四阶龙格－库塔（RK4）方法。给定在时间 $t_n$ 的状态 $\\mathbf{y}_n$，在时间 $t_{n+1} = t_n + \\Delta t$ 的状态 $\\mathbf{y}_{n+1}$ 计算如下：\n$$\n\\begin{align*}\n\\mathbf{k}_1 &= \\mathbf{F}(\\mathbf{y}_n) \\\\\n\\mathbf{k}_2 &= \\mathbf{F}(\\mathbf{y}_n + \\frac{\\Delta t}{2} \\mathbf{k}_1) \\\\\n\\mathbf{k}_3 &= \\mathbf{F}(\\mathbf{y}_n + \\frac{\\Delta t}{2} \\mathbf{k}_2) \\\\\n\\mathbf{k}_4 &= \\mathbf{F}(\\mathbf{y}_n + \\Delta t \\, \\mathbf{k}_3) \\\\\n\\mathbf{y}_{n+1} &= \\mathbf{y}_n + \\frac{\\Delta t}{6} (\\mathbf{k}_1 + 2\\mathbf{k}_2 + 2\\mathbf{k}_3 + \\mathbf{k}_4)\n\\end{align*}\n请注意，对于我们的系统，导数仅取决于 $f$，而不取决于 $\\phi$。\n\n**3. 实现策略**\n\n实现遵循一个清晰的流程以满足问题的要求。\n1.  **常数和参数**：所有物理常数（$G, c, M_\\odot$）和问题参数（$m_1, m_2, f_0, T_{\\mathrm{end}}$）均以 SI 单位定义。啁啾质量 $\\mathcal{M}_c$ 从 $m_1$ 和 $m_2$ 计算得出，并且预先计算用于 $df/dt$ 方程的常数因子 $\\mathcal{K}$。\n2.  **ODE 求解器**：一个函数实现 RK4 积分循环。它接受初始条件和步长 $\\Delta t$ 作为输入。循环从 $t=0$ 运行到 $t=T_{\\mathrm{end}}$。根据规定，为确保积分在 $T_{\\mathrm{end}}$ 处精确终止，最后一个步长使用 `h = min(Δt, T_end - t)` 进行调整。\n3.  **参考解**：通过使用一个非常小的时间步长 $\\Delta t_{\\mathrm{ref}} = 10^{-3} \\ \\mathrm{s}$ 运行积分器，计算出高精度的参考相位 $\\phi_{\\mathrm{ref}}$。\n4.  **误差计算**：程序遍历指定的测试步长 $\\Delta t$ 列表。对于每个 $\\Delta t$，它运行积分器以找到最终相位 $\\phi_{\\Delta t}$。然后计算绝对误差为 $|\\phi_{\\Delta t} - \\phi_{\\mathrm{ref}}|$。\n5.  **输出**：将计算出的误差收集到一个列表中，四舍五入到六位小数，并以指定格式打印。RK4 方法已知其全局截断误差为 $O((\\Delta t)^4)$ 阶。我们预期计算出的相位误差也将相应地缩放。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the gravitational wave inspiral problem, calculates phase errors\n    for different step sizes, and prints the results.\n    \"\"\"\n    # Physical constants in SI units\n    G = 6.67430e-11  # m^3 kg^-1 s^-2\n    c = 2.99792458e8   # m s^-1\n    M_SUN = 1.98847e30 # kg\n\n    # Problem parameters\n    m1_msun = 1.4\n    m2_msun = 1.4\n    f0 = 30.0  # Hz\n    T_end = 40.0 # s\n    phi0 = 0.0 # rad\n\n    # Test suite and reference step size\n    dt_steps = [0.5, 0.25, 0.1, 0.05, 0.025] # s\n    dt_ref = 1e-3 # s\n\n    # --- Derived physical quantities ---\n    m1 = m1_msun * M_SUN\n    m2 = m2_msun * M_SUN\n    \n    # The chirp mass M_chirp = (m1*m2)^(3/5) / (m1+m2)^(1/5)\n    mu = m1 * m2 / (m1 + m2)\n    M = m1 + m2\n    chirp_mass = (mu**3 * M**2)**(1/5)\n\n\n    # Pre-calculate the constant factor in the df/dt equation\n    # df/dt = K * f^(11/3)\n    K_FACTOR = (96.0 / 5.0) * (np.pi**(8.0/3.0) / c**5) * ((G * chirp_mass)**(5.0/3.0))\n\n    def derivatives(y):\n        \"\"\"\n        Computes the derivatives [d(phi)/dt, df/dt] for the ODE system.\n        y is a numpy array [phi, f].\n        \"\"\"\n        phi, f = y\n        dphi_dt = 2.0 * np.pi * f\n        df_dt = K_FACTOR * f**(11.0 / 3.0)\n        return np.array([dphi_dt, df_dt])\n\n    def integrate_inspiral(f_initial, phi_initial, t_final, dt):\n        \"\"\"\n        Integrates the ODE system using the RK4 method.\n        \n        Args:\n            f_initial (float): Initial GW frequency in Hz.\n            phi_initial (float): Initial GW phase in radians.\n            t_final (float): Final integration time in seconds.\n            dt (float): Fixed time step for integration.\n\n        Returns:\n            float: The final accumulated GW phase in radians.\n        \"\"\"\n        t = 0.0\n        y = np.array([phi_initial, f_initial], dtype=np.float64)\n\n        while t  t_final:\n            # Ensure the last step ends exactly at t_final\n            h = min(dt, t_final - t)\n            \n            if h = 0: break\n\n            # Classical 4th-order Runge-Kutta step\n            k1 = derivatives(y)\n            k2 = derivatives(y + 0.5 * h * k1)\n            k3 = derivatives(y + 0.5 * h * k2)\n            k4 = derivatives(y + h * k3)\n            \n            y += (h / 6.0) * (k1 + 2.0 * k2 + 2.0 * k3 + k4)\n            t += h\n            \n        return y[0] # Return the final phase phi\n\n    # 1. Compute the high-accuracy reference phase\n    phi_ref = integrate_inspiral(f0, phi0, T_end, dt_ref)\n\n    # 2. Compute phase for each step size and calculate error\n    errors = []\n    for dt in dt_steps:\n        phi_dt = integrate_inspiral(f0, phi0, T_end, dt)\n        error = abs(phi_dt - phi_ref)\n        errors.append(round(error, 6))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, errors))}]\")\n\n\nsolve()\n```", "id": "2399139"}, {"introduction": "在掌握了如何精确模拟轨道演化之后，下一步自然是生成远处探测器能够实际观测到的引力波信号。广义相对论的四极矩公式将双星系统时变的质量分布（即其轨道运动）与所发射的引力波应变 $h(t)$ 联系起来。通过这个练习，你将亲手构建从轨道动力学到可观测波形的完整模拟链路，并数值验证一个基本预测：引力波的频率是轨道频率的两倍 [@problem_id:2399179]。", "problem": "一个圆形的、不自旋的致密双星系统可以在牛顿极限和引力辐射的主导阶四极矩近似下进行建模。从第一性原理出发，你将构建一个数值实验，该实验为准圆旋进过程生成引力波应变，提取其瞬时频率，并将其与轨道频率进行比较，以验证其倍频特性。目标是在数值上验证引力波频率在整个演化过程中（在数值容差范围内）始终是轨道频率的两倍，且在构建过程中不预先假设此关系。\n\n使用的基本原理：\n- 点质量的牛顿双体动力学：一个由分量质量 $m_1$ 和 $m_2$ 组成的双星系统，总质量为 $M = m_1 + m_2$，约化质量为 $\\mu = \\dfrac{m_1 m_2}{M}$。对于瞬时分离距离为 $a(t)$ 的圆形轨道，其轨道角频率为 $\\omega(t) = \\sqrt{\\dfrac{G M}{a(t)^3}}$，轨道相位的演化遵循 $\\dfrac{d\\phi}{dt} = \\omega(t)$。\n- 圆形旋进的能量平衡（彼得斯公式）在主导四极矩阶下：由于引力波的发射，双星轨道根据以下公式收缩：\n$$\n\\frac{da}{dt} = - \\frac{64}{5} \\frac{G^3}{c^5} \\frac{\\mu M^2}{a^3}.\n$$\n- 远场中的四极辐射与横向无迹（TT）规范：无迹质量四极矩张量为：\n$$\nI_{ij}(t) = \\sum_A m_A \\left(x_A^i x_A^j - \\frac{1}{3}\\delta_{ij}\\, \\mathbf{x}_A^2\\right),\n$$\n在质心坐标系下，该张量简化为 $I_{ij}(t) = \\mu \\left(r_i r_j - \\dfrac{1}{3}\\delta_{ij} r^2\\right)$，其中 $\\mathbf{r} = \\mathbf{x}_1 - \\mathbf{x}_2$。在光度距离 $D$ 处，TT规范下的引力波度规微扰为：\n$$\nh_{ij}^{\\mathrm{TT}}(t) = \\frac{2 G}{c^4 D} \\frac{d^2 I_{ij}^{\\mathrm{TT}}(t)}{dt^2}.\n$$\n对于沿单位视线方向 $\\hat{\\mathbf{n}}$ 的观测者，定义正交归一的偏振基矢量 $\\hat{\\mathbf{p}}$ 和 $\\hat{\\mathbf{q}}$，使得 $\\{\\hat{\\mathbf{p}}, \\hat{\\mathbf{q}}, \\hat{\\mathbf{n}}\\}$ 构成右手系，且满足 $\\hat{\\mathbf{p}} \\cdot \\hat{\\mathbf{n}} = 0$ 和 $\\hat{\\mathbf{q}} \\cdot \\hat{\\mathbf{n}} = 0$。然后，通过投影到 $e_+^{ij} = p^i p^j - q^i q^j$ 上来获得加号偏振：\n$$\nh_{+}(t) = \\frac{2 G}{c^4 D}\\, e_+^{ij}\\, \\frac{d^2 I_{ij}(t)}{dt^2}.\n$$\n\n任务：\n- 实现一个程序，该程序：\n  1. 使用固定的时间步长 $\\Delta t$ 和均匀时间网格上的四阶龙格－库塔方法，通过积分耦合系统\n     $$\n     \\frac{d\\phi}{dt} = \\sqrt{\\frac{G M}{a^3}},\\quad\n     \\frac{da}{dt} = - \\frac{64}{5} \\frac{G^3}{c^5} \\frac{\\mu M^2}{a^3}\n     $$\n     来演化双星的准圆旋进过程。\n  2. 在质心坐标系中，根据相对位置 $\\mathbf{r}(t) = a(t)[\\cos\\phi(t), \\sin\\phi(t), 0]$ 构建无迹质量四极矩 $I_{ij}(t)$。\n  3. 在均匀网格上，使用中心有限差分格式数值计算二阶时间导数 $\\frac{d^2 I_{ij}}{dt^2}$。\n  4. 通过相对于轨道角动量（$z$轴）的倾角 $\\iota$ 和方位角 $0$ 来定义观测者方向，即 $\\hat{\\mathbf{n}} = (\\sin\\iota, 0, \\cos\\iota)$，并使用 $\\hat{\\mathbf{p}} = (\\cos\\iota, 0, -\\sin\\iota)$ 和 $\\hat{\\mathbf{q}} = (0, 1, 0)$ 构建 $e_+^{ij}$。\n  5. 通过将 $e_+^{ij}$ 与 $\\frac{d^2 I_{ij}}{dt^2}$ 进行缩并，并乘以因子 $\\frac{2G}{c^4 D}$，来构成 $h_{+}(t)$。\n  6. 通过希尔伯特变换计算解析信号，对其相位 $\\psi(t)$ 进行解缠，然后求导，从 $h_{+}(t)$ 中提取瞬时引力波频率 $f_{\\mathrm{GW}}(t)$：$f_{\\mathrm{GW}}(t) = \\frac{1}{2\\pi} \\frac{d\\psi}{dt}$。\n  7. 在相同的时间网格上（与二阶导数格式对齐）计算轨道频率 $f_{\\mathrm{orb}}(t) = \\dfrac{1}{2\\pi} \\sqrt{\\dfrac{G M}{a(t)^3}}$。\n  8. 构成比率 $R(t) = \\dfrac{f_{\\mathrm{GW}}(t)}{f_{\\mathrm{orb}}(t)}$，并为每个测试用例报告一个总结性数值，该数值等于 $R(t)$ 在时间序列中心部分的中位数（舍弃最初和最后 $0.1$ 比例的样本，以避免微分和希尔伯特变换的边界效应）。为进一步提高稳健性，排除解析信号包络振幅 $A(t)$ 满足 $A(t)  \\alpha A_{\\max}$（其中 $\\alpha = 0.05$）的数据点。\n\n数值细节和单位：\n- 所有物理量均使用国际单位制（SI）：质量单位为千克，分离距离单位为米，时间单位为秒，角度单位为弧度，距离单位为米。\n- 对于每个测试用例，将均匀样本数设置为 $N = 8192$，并选择时间步长为 $\\Delta t = \\dfrac{1}{256 f_{\\mathrm{orb},0}}$，其中 $f_{\\mathrm{orb},0}$ 是根据初始分离距离 $a_0$ 计算的初始轨道频率。\n- 最终答案是无单位的浮点数（无量纲比率）。\n\n测试套件：\n- 用例1：$m_1 = 1.4\\,M_\\odot$，$m_2 = 1.4\\,M_\\odot$，$a_0 = 5.0\\times 10^7\\,\\mathrm{m}$，$\\iota = 0.0\\,\\mathrm{rad}$，$D = 1.0\\times 10^{23}\\,\\mathrm{m}$。\n- 用例2：$m_1 = 30\\,M_\\odot$，$m_2 = 10\\,M_\\odot$，$a_0 = 2.0\\times 10^8\\,\\mathrm{m}$，$\\iota = \\pi/3\\,\\mathrm{rad}$，$D = 1.0\\times 10^{23}\\,\\mathrm{m}$。\n- 用例3：$m_1 = 1.4\\,M_\\odot$，$m_2 = 10\\,M_\\odot$，$a_0 = 1.0\\times 10^8\\,\\mathrm{m}$，$\\iota = \\pi/2\\,\\mathrm{rad}$，$D = 1.0\\times 10^{23}\\,\\mathrm{m}$。\n\n所需输出：\n- 你的程序应生成一行输出，其中包含三个测试用例的结果，格式为一个由方括号括起来的逗号分隔的浮点数列表，例如，`\"[r_1,r_2,r_3]\"`，其中每个 $r_i$ 是相应测试用例的 $R(t)$ 的中位数。浮点数请以标准十进制表示法报告。预期值应接近整数 $2$。\n\n角度单位：\n- 所有角度必须以弧度为单位。\n\n物理单位说明：\n- 所有量都应以国际单位制计算，最终输出为无量纲。\n\n不应读取任何用户输入；所有参数必须在代码中完全按照上述规定定义。", "solution": "该问题陈述经过了严格验证，并被认定是有效的。它在科学上基于牛顿力学原理以及由广义相对论描述的致密双星系统引力辐射的主导阶近似。该问题是适定的，为获得唯一且有意义的解提供了完整且一致的微分方程组、数值参数和程序步骤。此任务构成了计算天体物理学中的一个标准数值实验。\n\n问题的核心是数值验证一个理论预测：双星系统发射的引力波频率是其轨道频率的两倍。这将通过从第一性原理出发构建解来实现，而无需先验地假设这一关系。\n\n双星系统的演化由两个耦合的一阶常微分方程（ODE）建模。第一个方程描述了由轨道角频率 $\\omega(t)$ 驱动的轨道相位 $\\phi(t)$ 的变化：\n$$\n\\frac{d\\phi}{dt} = \\omega(t) = \\sqrt{\\frac{G M}{a(t)^3}}\n$$\n其中 $G$ 是引力常数，$M = m_1 + m_2$ 是双星的总质量，$a(t)$ 是瞬时轨道分离距离。第二个常微分方程描述了由于引力波发射导致的轨道分离距离的衰减。在主导（四极矩）阶，这由彼得斯公式给出：\n$$\n\\frac{da}{dt} = - \\frac{64}{5} \\frac{G^3}{c^5} \\frac{\\mu M^2}{a^3}\n$$\n其中 $\\mu = \\frac{m_1 m_2}{M}$ 是约化质量，$c$ 是光速。这个常微分方程组定义了一个准圆旋进过程。我们使用固定时间步长 $\\Delta t$ 的四阶龙格－库塔（RK4）方法对该系统进行数值积分，以获得轨道状态的时间序列 $(a(t), \\phi(t))$。\n\n从轨道轨迹出发，我们构建引力波波形。在轨道平面（$z=0$）中的相对位置矢量为 $\\mathbf{r}(t) = (a(t)\\cos\\phi(t), a(t)\\sin\\phi(t), 0)$。在此阶数下，引力辐射的源是随时间变化的质量四极矩。在质心坐标系中，无迹质量四极矩张量由下式给出：\n$$\nI_{ij}(t) = \\mu \\left( r_i(t) r_j(t) - \\frac{1}{3}\\delta_{ij} r(t)^2 \\right)\n$$\n其中 $r_i$ 是 $\\mathbf{r}$ 的分量，且 $r^2 = a^2$。在横向无迹（TT）规范中，引力波应变张量与四极矩张量的二阶时间导数成正比。对于位于光度距离 $D$ 处的观测者，应变为：\n$$\nh_{ij}^{\\mathrm{TT}}(t) = \\frac{2 G}{c^4 D} \\frac{d^2 I_{ij}^{\\mathrm{TT}}(t)}{dt^2}\n$$\n我们使用二阶中心有限差分格式从时间序列 $I_{ij}(t)$ 中数值计算二阶时间导数 $\\ddot{I}_{ij}(t)$：\n$$\n\\frac{d^2 f(t)}{dt^2} \\approx \\frac{f(t+\\Delta t) - 2f(t) + f(t-\\Delta t)}{(\\Delta t)^2}\n$$\n可观测的波形取决于观测者的视线方向 $\\hat{\\mathbf{n}}$ 和所选的偏振基 $\\{\\hat{\\mathbf{p}}, \\hat{\\mathbf{q}}\\}$。问题指定了 $\\hat{\\mathbf n} = (\\sin\\iota, 0, \\cos\\iota)$，$\\hat{\\mathbf p} = (\\cos\\iota, 0, -\\sin\\iota)$ 和 $\\hat{\\mathbf q} = (0, 1, 0)$，其中 $\\iota$ 是倾角。加号偏振应变 $h_+(t)$ 是通过将 $\\ddot{I}_{ij}(t)$ 投影到偏振张量 $e_+^{ij} = p^i p^j - q^i q^j$ 上获得的：\n$$\nh_{+}(t) = \\frac{2 G}{c^4 D} e_+^{ij} \\ddot{I}_{ij}(t)\n$$\n\n为了从合成的波形 $h_+(t)$ 中提取瞬时引力波频率 $f_{\\mathrm{GW}}(t)$，我们采用解析信号的概念。解析信号 $z(t)$ 是一个复数时间序列，其实部是原始信号，虚部是原始信号的希尔伯特变换 $\\mathcal{H}[h_+](t)$：\n$$\nz(t) = h_+(t) + i \\mathcal{H}[h_+](t) = A(t) e^{i\\psi(t)}\n$$\n波的瞬时相位是 $\\psi(t)$，它通过求取 $z(t)$ 的辐角并使用解缠算法使其连续而获得。瞬时角频率则是该相位的时间导数，$\\omega_{\\mathrm{GW}}(t) = d\\psi(t)/dt$，我们使用另一个中心有限差分格式进行数值计算。所需频率为 $f_{\\mathrm{GW}}(t) = \\omega_{\\mathrm{GW}}(t) / (2\\pi)$。\n\n最后，我们进行验证。我们直接从演化出的分离距离 $a(t)$ 计算理论轨道频率：\n$$\nf_{\\mathrm{orb}}(t) = \\frac{1}{2\\pi} \\sqrt{\\frac{G M}{a(t)^3}}\n$$\n然后在一个公共的时间网格上计算比率 $R(t) = f_{\\mathrm{GW}}(t) / f_{\\mathrm{orb}}(t)$。为确保结果的稳健性，我们舍弃最初和最后 $10\\%$ 的样本，以减轻数值微分和希尔伯特变换带来的边界效应。此外，我们应用振幅过滤器，排除波形包络 $A(t)$ 小于其最大值 $5\\%$ 的数据点，因为低振幅区域的相位可能确定得不准确。对每个测试用例，报告最终过滤后的比率值的中位数。该中位数预期会非常接近 $2$。", "answer": "```python\nimport numpy as np\nfrom scipy import signal\nfrom scipy.constants import G, c\n\ndef solve():\n    \"\"\"\n    Solves the gravitational wave evolution problem for three test cases.\n    \"\"\"\n    \n    # Physical constants\n    M_SOLAR = 1.98847e30  # Solar mass in kg\n\n    # Numerical parameters\n    N_SAMPLES = 8192\n    SAMPLING_FACTOR = 256.0\n    \n    # Test cases\n    test_cases = [\n        {\n            \"m1_solar\": 1.4, \"m2_solar\": 1.4, \"a0\": 5.0e7,\n            \"iota\": 0.0, \"D\": 1.0e23,\n        },\n        {\n            \"m1_solar\": 30.0, \"m2_solar\": 10.0, \"a0\": 2.0e8,\n            \"iota\": np.pi / 3, \"D\": 1.0e23,\n        },\n        {\n            \"m1_solar\": 1.4, \"m2_solar\": 10.0, \"a0\": 1.0e8,\n            \"iota\": np.pi / 2, \"D\": 1.0e23,\n        },\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        # Unpack parameters and convert to SI units\n        m1 = case[\"m1_solar\"] * M_SOLAR\n        m2 = case[\"m2_solar\"] * M_SOLAR\n        a0 = case[\"a0\"]\n        iota = case[\"iota\"]\n        dist = case[\"D\"]\n\n        # Derived masses\n        M = m1 + m2\n        mu = (m1 * m2) / M\n\n        # Initial conditions and time grid\n        f_orb_0 = (1 / (2 * np.pi)) * np.sqrt(G * M / a0**3)\n        dt = 1 / (SAMPLING_FACTOR * f_orb_0)\n        time_grid = np.linspace(0, (N_SAMPLES - 1) * dt, N_SAMPLES)\n\n        # Arrays to store evolution\n        a_t = np.zeros(N_SAMPLES)\n        phi_t = np.zeros(N_SAMPLES)\n        a_t[0] = a0\n        phi_t[0] = 0.0\n\n        # ODE system coefficients\n        Ca = (64/5) * (G**3 / c**5) * mu * M**2\n        Cphi = np.sqrt(G * M)\n\n        # ODE functions\n        def f_a(a_val):\n            return -Ca * a_val**-3\n\n        def f_phi(a_val):\n            return Cphi * a_val**-1.5\n\n        # RK4 integration\n        for i in range(N_SAMPLES - 1):\n            a_i, phi_i = a_t[i], phi_t[i]\n            \n            k1a = f_a(a_i)\n            k1phi = f_phi(a_i)\n\n            k2a = f_a(a_i + 0.5 * dt * k1a)\n            k2phi = f_phi(a_i + 0.5 * dt * k1a)\n\n            k3a = f_a(a_i + 0.5 * dt * k2a)\n            k3phi = f_phi(a_i + 0.5 * dt * k2a)\n            \n            k4a = f_a(a_i + dt * k3a)\n            k4phi = f_phi(a_i + dt * k3a)\n\n            a_t[i+1] = a_i + (dt/6.0) * (k1a + 2*k2a + 2*k3a + k4a)\n            phi_t[i+1] = phi_i + (dt/6.0) * (k1phi + 2*k2phi + 2*k3phi + k4phi)\n\n        # Construct Quadrupole Tensor I_ij\n        x = a_t * np.cos(phi_t)\n        y = a_t * np.sin(phi_t)\n        r_sq = a_t**2\n        \n        I11 = mu * (x**2 - r_sq / 3.0)\n        I22 = mu * (y**2 - r_sq / 3.0)\n        I33 = mu * (-r_sq / 3.0)\n        I12 = mu * x * y\n        \n        # Second time derivative via finite difference\n        # Stencil: (f[t+dt] - 2f[t] + f[t-dt]) / dt^2\n        # This reduces array length by 2\n        ddot_I11 = (I11[2:] - 2 * I11[1:-1] + I11[:-2]) / dt**2\n        ddot_I22 = (I22[2:] - 2 * I22[1:-1] + I22[:-2]) / dt**2\n        ddot_I33 = (I33[2:] - 2 * I33[1:-1] + I33[:-2]) / dt**2\n\n        # Polarization tensor e_plus_ij\n        cos_i, sin_i = np.cos(iota), np.sin(iota)\n        e_plus = np.zeros((3, 3))\n        e_plus[0, 0] = cos_i**2\n        e_plus[1, 1] = -1.0\n        e_plus[2, 2] = sin_i**2\n        \n        # Construct h_plus(t)\n        h_plus_t = (2 * G / (c**4 * dist)) * (\n            e_plus[0, 0] * ddot_I11 +\n            e_plus[1, 1] * ddot_I22 +\n            e_plus[2, 2] * ddot_I33\n        )\n\n        # Extract instantaneous frequency f_GW\n        analytic_signal = signal.hilbert(h_plus_t)\n        amplitude_gw = np.abs(analytic_signal)\n        phase_gw = np.unwrap(np.angle(analytic_signal))\n        \n        # Differentiate phase via finite difference: (psi[t+dt]-psi[t-dt])/(2*dt)\n        # This reduces array length by 2\n        omega_gw_t = (phase_gw[2:] - phase_gw[:-2]) / (2 * dt)\n        f_gw_t = omega_gw_t / (2 * np.pi)\n\n        # Align orbital frequency array\n        # f_gw_t corresponds to original time grid [2:-2]\n        a_t_aligned = a_t[2:-2]\n        f_orb_t = (1 / (2 * np.pi)) * np.sqrt(G * M / a_t_aligned**3)\n        \n        # Form ratio R(t)\n        ratio_t = f_gw_t / f_orb_t\n        \n        # Process the ratio: trim boundaries and filter by amplitude\n        num_pts = len(ratio_t)\n        start_idx = int(0.1 * num_pts)\n        end_idx = num_pts - start_idx\n        \n        ratio_slice = ratio_t[start_idx:end_idx]\n        \n        # Align amplitude for filtering\n        amplitude_aligned = np.abs(signal.hilbert(h_plus_t[start_idx+1:end_idx+1]))\n        amplitude_max = np.max(np.abs(analytic_signal))\n        \n        # Apply amplitude filter\n        if amplitude_max > 0:\n            mask = amplitude_aligned >= 0.05 * amplitude_max\n            if np.any(mask):\n                filtered_ratio = ratio_slice[mask]\n            else: # If all points are filtered out, use the unfiltered median\n                filtered_ratio = ratio_slice\n        else: # Handle case of zero amplitude\n             filtered_ratio = ratio_slice\n\n        if len(filtered_ratio) > 0:\n            median_ratio = np.median(filtered_ratio)\n        else:\n            median_ratio = np.nan\n            \n        results.append(median_ratio)\n        \n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2399179"}, {"introduction": "当两个致密天体接近最终并合时，简单的旋进模型便会失效，系统将进入快速的坠落阶段。在这个强引力场区域，天体的运动不再遵循牛顿定律，而是由弯曲时空中的测地线方程所描述。这项高级练习将引导你模拟这种强引力场效应，并通过比较坠落阶段与旋进阶段的引力波峰值振幅，让你深入理解致密双星并合不同阶段的主导物理过程 [@problem_id:2399173]。", "problem": "你必须编写一个完整的、可运行的程序，模拟两种情景下的引力波辐射：(a) 一个检验质量最终坠入史瓦西黑洞的过程，以及 (b) 一个由辐射反作用驱动的、在最内稳定圆轨道处终止的准圆形旋进过程。对于每个测试案例，你的程序必须计算一个标量诊断值：坠落阶段引力波应变峰值振幅与旋进结束时峰值振幅之比。最终输出必须为一行，包含所有测试案例的比值，形式为方括号内的逗号分隔列表，例如 $[R_1,R_2,R_3]$。每个比值必须是四舍五入到六位小数的浮点数，并且是无量纲的。\n\n仅从以下基本原理和核心定义出发，并在实现之前自行推导所需的工作关系：\n\n- 几何单位制下检验粒子在史瓦西时空中的运动：赤道测地线由单位静质量守恒能量 $E$ 和单位静质量守恒角动量 $L$ 表征。固有时导数 $d t / d \\tau$ 和 $d \\phi / d \\tau$ 与 $E$ 和 $L$ 相关。径向运动遵循一维有效势方程。使用最内稳定圆轨道上的临界稳定圆轨道参数作为坠落的初始条件。\n- 牛顿极限下准圆形旋进过程中的能量平衡：轨道间距的时间演化遵循 $dE/dt = -\\mathcal{P}$，其中 $E$ 是轨道结合能，$\\mathcal{P}$ 是四极矩近似下的领头阶引力波功率。对极端质量比下的准圆形双星使用领头阶辐射反作用，并在最内稳定圆轨道半径处终止旋进。\n- 在轨道平面内运动的点质量的引力辐射四极矩公式：领头阶远场横向无迹应变振幅与质量四极矩的二阶时间导数成正比。对于准圆形构型，主导模式的应变振幅包络与 $r^2 \\Omega^2 / D$ 成正比（附带适当的基本常数），其中 $r$ 是轨道间距，$\\Omega$ 是轨道角频率，$D$ 是到源的光度距离。你可以假设双星系统是正向面对观测者，以定义单个振幅包络。\n\n实现要求：\n\n1. 程序中仅使用以下以国际单位制 (SI) 表示的常数和单位：引力常数 $G = 6.67430\\times 10^{-11}\\,\\mathrm{m^3\\,kg^{-1}\\,s^{-2}}$，光速 $c = 2.99792458\\times 10^{8}\\,\\mathrm{m\\,s^{-1}}$，太阳质量 $M_{\\odot} = 1.98847\\times 10^{30}\\,\\mathrm{kg}$，以及秒差距 $\\mathrm{pc} = 3.085677581491367\\times 10^{16}\\,\\mathrm{m}$。使用 $1\\,\\mathrm{Mpc} = 10^{6}\\,\\mathrm{pc}$ 和 $1\\,\\mathrm{Gpc} = 10^{9}\\,\\mathrm{pc}$。所有输入必须在内部转换为 SI 单位。引力波应变振幅是无量纲的。\n2. 旋进模型：从初始圆形轨道间距 $r_0$ 开始演化，直至史瓦西黑洞的最内稳定圆轨道半径 $r_{\\mathrm{ISCO}}$。你必须从牛顿结合能和圆形极端质量比双星的领头阶四极辐射功率推导出关于 $dr/dt$ 的领头阶常微分方程。你必须推导出主导模式应变振幅包络作为 $r$ 和 $\\Omega$ 的函数公式，然后确定在旋进阶段达到的峰值振幅。\n3. 坠落模型：将小天体视为在史瓦西黑洞赤道类时测地线上运动的检验质量，其初始位置在最内稳定圆轨道内侧，运动常数等于临界稳定圆轨道的常数。推导固有时方程，并将其转换为坐标时演化，以获得 $dr/dt$ 和 $d\\phi/dt$。从初始半径 $r(0) = r_{\\mathrm{ISCO}}(1-\\epsilon)$（其中 $\\epsilon$ 是一个小的无量纲扰动）开始积分测地线方程，朝向视界方向，直到一个严格大于事件视界的选定截止半径。利用瞬时轨道运动计算作为时间函数的领头阶主导模式应变振幅包络，并记录坠落阶段的最大值。所有角度必须以弧度表示。\n4. 数值细节：你必须使用一个稳定的显式常微分方程求解器，在坐标时下对坠落测地线进行积分，并设置一个事件或停止条件，当半径达到指定的截止值时停止积分。选择一个小的正数 $\\epsilon$ 以确保径向运动向内开始。选择合理的求解器容差，以确保精确捕捉峰值振幅。\n5. 测试套件。你的程序必须精确评估以下三个测试案例：\n   - 案例 1：$M = 10\\,M_{\\odot}$，$\\mu = 1.0\\,M_{\\odot}$，$D = 100\\,\\mathrm{Mpc}$，旋进初始半径 $r_0 = 10\\,r_g$，其中 $r_g = GM/c^2$。\n   - 案例 2：$M = 30\\,M_{\\odot}$，$\\mu = 1.4\\,M_{\\odot}$，$D = 400\\,\\mathrm{Mpc}$，旋进初始半径 $r_0 = 12\\,r_g$。\n   - 案例 3：$M = 10^{6}\\,M_{\\odot}$，$\\mu = 10\\,M_{\\odot}$，$D = 1\\,\\mathrm{Gpc}$，旋进初始半径 $r_0 = 8\\,r_g$。\n6. 输出：对于每个案例，计算比值 $R = h^{\\mathrm{plunge}}_{\\max} / h^{\\mathrm{insp}}_{\\max}$，其中 $h^{\\mathrm{plunge}}_{\\max}$ 是坠落积分期间主导模式应变振幅包络的最大值，$h^{\\mathrm{insp}}_{\\max}$ 是在旋进阶段结束时达到的峰值包络振幅。将最终结果报告为一行，包含一个列表 $[R_1,R_2,R_3]$，其中每个 $R_i$ 四舍五入到六位小数。这些比值是无量纲的，因此输出中不需要单位。\n\n科学真实性约束和简化：\n\n- 假设质量比足够小，使得检验质量测地线对于坠落模型有效，并且领头阶四极矩公式和牛顿结合能对于直至最内稳定圆轨道的旋进模型有效。\n- 使用史瓦西黑洞的最内稳定圆轨道半径 $r_{\\mathrm{ISCO}} = 6GM/c^2$，以及临界稳定圆轨道对应的运动常数。\n- 对于主导模式应变振幅，假设为正向面对方位并使用领头阶四极矩近似。你必须在推导中明确陈述并实现几何单位制下的演化与国际单位制 (SI) 应变振幅之间的映射关系。\n\n你的程序应产生一行输出，其中包含用方括号括起来的逗号分隔的结果列表（例如，$[0.997123,1.004321,0.999876]$）。", "solution": "该问题要求计算两种不同天体物理情景下的引力波应变峰值振幅之比 $R = h^{\\mathrm{plunge}}_{\\max} / h^{\\mathrm{insp}}_{\\max}$：准圆形旋进和最终坠入史瓦西黑洞。解法必须从基本原理推导得出，然后针对一组给定的测试案例进行数值实现。\n\n该问题经确认具有科学依据、问题明确且客观。它基于广义相对论和引力波理论的既定原理。所有必要的参数和物理模型都已指定，从而可以得到唯一的、可计算的解。我们着手进行推导和求解。\n\n我们将在几何单位制中进行计算，其中 $G=c=1$，中心黑洞质量 $M$ 设定了尺度，因此质量、长度和时间都表示为 $M$ 的无量纲倍数。一个量 $Q$ 从国际单位制 (SI) 到几何单位制的转换公式为：$Q_{\\mathrm{geom}} = Q_{\\mathrm{SI}} / (G^a M_{\\mathrm{SI}}^b c^d)$，其中指数 $a,b,d$ 需取适当值。\n\n**1. 旋进模型与峰值应变振幅**\n\n旋进过程被建模为一系列由引力波辐射驱动的准圆形牛顿轨道。峰值应变振幅出现在该过程的最后阶段，即最内稳定圆轨道 (ISCO) 处。\n\n对于一个轨道间距为 $r$ 的正向面对、准圆形双星系统，其应变振幅可以从四极矩公式推导得出。质量四极矩张量 $I_{ij}$ 的二阶时间导数给出了应变。对于质量为 $M$ 和 $\\mu$（$\\mu \\ll M$）的双星系统，约化质量为 $\\mu_{\\text{red}} = M\\mu/(M+\\mu) \\approx \\mu$。加号偏振应变 $h_+$ 的振幅为：\n$$\nh_{\\text{amp}}(r) = \\frac{4G}{c^4 D} \\mu_{\\text{red}} r^2 \\Omega^2 \\approx \\frac{4G\\mu}{c^4 D} r^2 \\Omega^2\n$$\n其中 $D$ 是光度距离，$r$ 是轨道间距，$\\Omega$ 是轨道角频率。使用圆形轨道的开普勒第三定律，$\\Omega^2 = G(M+\\mu)/r^3 \\approx GM/r^3$：\n$$\nh_{\\text{amp}}(r) \\approx \\frac{4G\\mu}{c^4 D} r^2 \\left(\\frac{GM}{r^3}\\right) = \\frac{4G^2 M\\mu}{c^4 D r}\n$$\n这个公式是无量纲的，符合要求。旋进阶段在史瓦西 ISCO 半径 $r_{\\mathrm{ISCO}} = 6GM/c^2$ 处终止。由于 $h_{\\text{amp}}(r) \\propto 1/r$，振幅在最小半径 $r_{\\mathrm{ISCO}}$ 处达到最大值：\n$$\nh^{\\mathrm{insp}}_{\\max} = h_{\\text{amp}}(r_{\\mathrm{ISCO}}) = \\frac{4G^2 M\\mu}{c^4 D (6GM/c^2)} = \\frac{4G\\mu c^2}{6c^4 D} = \\frac{2G\\mu}{3c^2 D}\n$$\n值得注意的是，在此近似下，旋进阶段的峰值应变振幅与中心天体质量 $M$ 无关。\n\n**2. 坠落模型与峰值应变振幅**\n\n坠落过程被建模为一个检验质量（$\\mu$）在中心质量 $M$ 的史瓦西时空中沿类时测地线运动。其运动由单位静质量守恒能量 $\\hat{E}$ 和单位静质量守恒角动量 $\\hat{L}$ 决定。对于从 ISCO 开始的坠落，我们使用在 $r_{\\mathrm{ISCO}} = 6M$ （在 $M=1$ 的几何单位制中）处的临界稳定圆轨道的比能量和比角动量：\n$$\n\\hat{E}_{\\mathrm{ISCO}} = \\frac{2\\sqrt{2}}{3} \\quad, \\quad \\hat{L}_{\\mathrm{ISCO}} = \\sqrt{12}M = 2\\sqrt{3}M\n$$\n在无量纲几何单位制（$M=1$）中，我们使用 $\\hat{E} = 2\\sqrt{2}/3$ 和 $\\hat{L} = 2\\sqrt{3}$。以坐标时 $t$ 表示的运动方程由测地线方程 $dt/d\\tau = \\hat{E}/(1 - 2M/r)$ 和 $d\\phi/d\\tau = \\hat{L}/r^2$ 结合径向方程 $g_{\\alpha\\beta}u^\\alpha u^\\beta = -c^2$ 推导得出。这得到：\n$$\n\\frac{dr}{dt} = \\frac{dr/d\\tau}{dt/d\\tau} = -\\frac{1-2M/r}{\\hat{E}}\\sqrt{\\hat{E}^2 - \\left(1-\\frac{2M}{r}\\right)\\left(1+\\frac{\\hat{L}^2}{r^2}\\right)}\n$$\n$$\n\\Omega(t) = \\frac{d\\phi}{dt} = \\frac{d\\phi/d\\tau}{dt/d\\tau} = \\frac{\\hat{L}(1-2M/r)}{\\hat{E}r^2}\n$$\n我们对 $dr/dt$ 方程进行数值积分，从 $r(0) = r_{\\mathrm{ISCO}}(1-\\epsilon)$ 开始，其中 $\\epsilon > 0$ 是一个小数。\n\n坠落过程中的瞬时应变振幅由相同的基于四极矩的公式给出，其中 $r$ 和 $\\Omega$ 现在是来自测地线解的时间 $t$ 的函数：\n$$\nh_{\\text{amp}}(t) = \\frac{4G\\mu}{c^4 D} r(t)^2 \\Omega(t)^2\n$$\n为使此公式实用，我们使用 $r$ 和 $\\Omega$ 的几何单位（无量纲，$M=1$）值。从几何单位制到国际单位制 (SI) 的转换（$r_{\\mathrm{SI}} = r_{\\mathrm{geom}} \\frac{GM}{c^2}$, $\\Omega_{\\mathrm{SI}} = \\Omega_{\\mathrm{geom}} \\frac{c^3}{GM}$）给出：\n$$\nh_{\\text{amp}}(t) = \\frac{4G\\mu}{c^4 D} \\left(r_{\\mathrm{geom}}(t)\\frac{GM}{c^2}\\right)^2 \\left(\\Omega_{\\mathrm{geom}}(t)\\frac{c^3}{GM}\\right)^2 = \\frac{4G\\mu}{D c^2} r_{\\mathrm{geom}}(t)^2 \\Omega_{\\mathrm{geom}}(t)^2\n$$\n代入 $\\Omega_{\\mathrm{geom}}(t) = \\frac{\\hat{L}_{\\mathrm{geom}}(1-2/r_{\\mathrm{geom}}(t))}{\\hat{E}_{\\mathrm{geom}}r_{\\mathrm{geom}}(t)^2}$ 的表达式：\n$$\nh_{\\text{amp}}(t) = \\frac{4G\\mu}{D c^2} r_{\\mathrm{geom}}^2 \\left(\\frac{\\hat{L}_{\\mathrm{geom}}(1-2/r_{\\mathrm{geom}})}{\\hat{E}_{\\mathrm{geom}}r_{\\mathrm{geom}}^2}\\right)^2 = \\frac{4G\\mu}{D c^2} \\frac{\\hat{L}_{\\mathrm{geom}}^2}{\\hat{E}_{\\mathrm{geom}}^2} \\frac{(1-2/r_{\\mathrm{geom}}(t))^2}{r_{\\mathrm{geom}}(t)^2}\n$$\n使用 ISCO 的值，常数之比为 $\\hat{L}_{\\mathrm{geom}}^2 / \\hat{E}_{\\mathrm{geom}}^2 = (2\\sqrt{3})^2 / (2\\sqrt{2}/3)^2 = 12 / (8/9) = 27/2$。\n$$\nh_{\\text{amp}}(t) = \\frac{4G\\mu}{D c^2} \\left(\\frac{27}{2}\\right) \\frac{(1-2/r_{\\mathrm{geom}}(t))^2}{r_{\\mathrm{geom}}(t)^2} = \\frac{54G\\mu}{D c^2} \\frac{(r_{\\mathrm{geom}}(t)-2)^2}{r_{\\mathrm{geom}}(t)^4}\n$$\n为找到坠落阶段的峰值振幅，我们必须找到函数 $f(r) = (r-2)^2/r^4$ 在 $r \\in [2, 6]$ 上的最大值。其导数为 $f'(r) = 2(r-2)(4-r)/r^5$。临界点是 $r=2$ 和 $r=4$。当粒子的半径从 $r_{ISCO}=6$ 减小时，函数 $f(r)$ 增加，直到在 $r=4$ 处达到最大值，然后随着 $r \\to 2$ 减小趋于零。\n因此，坠落过程中的最大应变振幅恰好发生在粒子通过半径 $r=4M$ 时。\n$$\nh^{\\mathrm{plunge}}_{\\max} = \\frac{54G\\mu}{D c^2} f(r=4) = \\frac{54G\\mu}{D c^2} \\frac{(4-2)^2}{4^4} = \\frac{54G\\mu}{D c^2} \\frac{4}{256} = \\frac{54G\\mu}{64Dc^2} = \\frac{27G\\mu}{32Dc^2}\n$$\n\n**3. 峰值振幅之比**\n\n现在我们可以解析地计算比值 $R$。\n$$\nR = \\frac{h^{\\mathrm{plunge}}_{\\max}}{h^{\\mathrm{insp}}_{\\max}} = \\frac{27G\\mu / (32Dc^2)}{2G\\mu / (3Dc^2)} = \\frac{27/32}{2/3} = \\frac{27}{32} \\cdot \\frac{3}{2} = \\frac{81}{64}\n$$\n比值 $R$ 是一个常数，与黑洞质量 $M$、小天体质量 $\\mu$ 和距离 $D$ 无关。其精确值为 $1.265625$。数值实现应对所有测试案例重现此常数。\n\n**4. 计算策略**\n\n程序将实现上述物理过程。对于每个测试案例：\n1.  定义国际单位制 (SI) 参数（$M, \\mu, D$）。\n2.  使用其解析公式计算峰值旋进振幅 $h^{\\mathrm{insp}}_{\\max}$。\n3.  使用 `scipy.integrate.solve_ivp` 在几何单位制 ($M=1$) 中对 $dr/dt$ 的常微分方程 (ODE) 进行数值积分来模拟坠落过程。积分从 $r(0) = 6(1-10^{-6})$ 开始，在 $r_{\\mathrm{cut}} = 2.1$ 处停止，该位置远在 $r=4$ 的应变峰值之后。\n4.  在积分过程中，每一步都计算瞬时应变振幅 $h_{\\text{amp}}(t)$。观测到的最大值被存储为 $h^{\\mathrm{plunge}}_{\\max}$。\n5.  计算并存储比值 $R = h^{\\mathrm{plunge}}_{\\max} / h^{\\mathrm{insp}}_{\\max}$。\n6.  打印最终的比值列表，每个值都四舍五入到六位小数。\n\n这个过程通过显式数值模拟验证了我们的解析推导。", "answer": "```python\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\ndef solve():\n    \"\"\"\n    Solves the gravitational wave problem for the given test cases.\n    \"\"\"\n\n    # Physical Constants in SI units\n    G = 6.67430e-11  # m^3 kg^-1 s^-2\n    c = 2.99792458e8   # m s^-1\n    M_sol = 1.98847e30 # kg\n    pc = 3.085677581491367e16 # m\n    Mpc = 1e6 * pc\n    Gpc = 1e9 * pc\n\n    # Test cases: (M in M_sol, mu in M_sol, D in distance units, r0 in r_g)\n    # The initial inspiral radius r0 is not needed for the peak amplitude calculation.\n    test_cases = [\n        (10.0, 1.0, 100.0 * Mpc, 10.0),\n        (30.0, 1.4, 400.0 * Mpc, 12.0),\n        (1e6, 10.0, 1.0 * Gpc, 8.0)\n    ]\n\n    results = []\n\n    for M_solar, mu_solar, D_si, r0_rg in test_cases:\n        # Convert inputs to SI units\n        M_si = M_solar * M_sol\n        mu_si = mu_solar * M_sol\n        \n        # 1. Calculate peak inspiral amplitude (analytical)\n        # h_insp_max = (2 * G * mu) / (3 * c^2 * D)\n        h_insp_max = (2 * G * mu_si) / (3 * c**2 * D_si)\n\n        # 2. Setup and run plunge simulation in geometric units (G=c=M=1)\n        \n        # Constants of motion for a particle at the ISCO of a Schwarzschild BH\n        E_hat = 2 * np.sqrt(2) / 3  # Dimensionless specific energy\n        L_hat = 2 * np.sqrt(3)      # Dimensionless specific angular momentum (L/M)\n\n        # ODE for radial motion dr/dt in geometric units (M=1)\n        def radial_ode(t, y):\n            r = y[0]\n            if r = 2.0:\n                return [0.0]\n            \n            # The term inside the square root is E_hat^2 - V_eff(r)\n            V_eff_term = (1 - 2/r) * (1 + L_hat**2 / r**2)\n            sqrt_term = E_hat**2 - V_eff_term\n            \n            # If sqrt_term is negative due to numerical error near start, handle it.\n            if sqrt_term  0:\n                sqrt_term = 0\n\n            dr_dt = -(1 - 2/r) / E_hat * np.sqrt(sqrt_term)\n            return [dr_dt]\n\n        # Initial and final conditions for the plunge simulation\n        r_initial_geom = 6.0 * (1 - 1e-6) # Start just inside the ISCO (r=6M)\n        r_cutoff_geom = 2.1                 # Stop integration well inside r=4M peak\n\n        # Event function to stop integration at the cutoff radius\n        def stop_event(t, y):\n            return y[0] - r_cutoff_geom\n        stop_event.terminal = True\n        stop_event.direction = -1\n\n        # Time span for integration. End time is a guess; event will stop it.\n        t_span = [0, 400] \n        y0 = [r_initial_geom]\n\n        # Solve ODE\n        sol = solve_ivp(\n            radial_ode,\n            t_span,\n            y0,\n            method='RK45',\n            events=stop_event,\n            dense_output=True,\n            atol=1e-9, \n            rtol=1e-9\n        )\n\n        # 3. Find the peak plunge amplitude from the numerical solution\n        \n        # Evaluate solution on a fine time grid to find the peak strain\n        t_eval = np.linspace(sol.t[0], sol.t[-1], 2000)\n        r_values_geom = sol.sol(t_eval)[0]\n\n        # Strain amplitude during plunge depends on r_geom(t)\n        # The function whose maximum we seek is f(r) = (r-2)^2 / r^4\n        f_r = (r_values_geom - 2)**2 / r_values_geom**4\n        max_f_r = np.max(f_r)\n\n        # Calculate peak plunge amplitude using the numerically found max\n        h_plunge_max = (54 * G * mu_si) / (D_si * c**2) * max_f_r\n\n        # 4. Compute and store the ratio\n        ratio = h_plunge_max / h_insp_max\n        results.append(round(ratio, 6))\n\n    # Final output format: a single line with a comma-separated list\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```", "id": "2399173"}]}