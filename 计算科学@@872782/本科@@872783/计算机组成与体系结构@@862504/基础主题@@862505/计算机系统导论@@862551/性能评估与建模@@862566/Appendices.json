{"hands_on_practices": [{"introduction": "Amdahl 定律是评估系统优化的基本工具，它揭示了对系统某一部分进行改进时，整体性能提升所受到的限制。本练习将 Amdahl 定律应用于一个具体的场景——提升分支预测器的精度，旨在引导您学习如何量化一项特定硬件增强所能带来的实际收益。通过这个实践，您将掌握把一个工程问题转化为数学模型，并利用核心性能定律进行分析的关键技能 [@problem_id:3664724]。", "problem": "一个流水线中央处理器（CPU）执行一个基准测试工作负载，硬件性能监视器或周期精确模拟的周期核算报告显示，基准执行时间中有比例为 $f$ 的部分是由分支预测错误引起的停顿所导致的。基准分支预测准确率为 $p$，这意味着基准错误预测率为 $1-p$。一次预测器升级将准确率提高到 $p+\\Delta p$，其中 $0  p  1$, $0  \\Delta p \\leq 1-p$ 且 $0  f  1$。在这些假设下，推导出关于 $p$、$\\Delta p$ 和 $f$ 的总体程序加速比 $S$ 的一个闭式解析表达式。", "solution": "在进行求解之前，对问题陈述进行验证。\n\n### 第1步：提取已知条件\n- $f$：基准执行时间中由分支预测错误引起的停顿所占的比例。\n- $p$：基准分支预测准确率。\n- $p+\\Delta p$：升级后的分支预测准确率。\n- 约束条件：$0  p  1$，$0  \\Delta p \\leq 1-p$，$0  f  1$。\n- 假设1：每次分支预测错误的惩罚是恒定的。\n- 假设2：条件分支指令的比例保持不变。\n- 假设3：所有其他执行时间来源均不受影响。\n- 假设4：由分支引起的停顿时间与错误预测率成线性关系。\n- 目标：推导总体加速比 $S$ 关于 $p$、$\\Delta p$ 和 $f$ 的闭式解析表达式。\n\n### 第2步：使用提取的已知条件进行验证\n该问题具有科学依据，属于计算机体系结构性能分析的标准领域。它使用了诸如执行时间、停顿、分支预测准确率和加速比等明确定义的概念。所提供的假设是创建易于处理的分析模型的典型假设。该问题是适定问题，提供了足够的信息和约束来推导出一个唯一的、有意义的解。其语言客观而精确。该问题不违反任何无效性标准。例如，假设4（停顿时间与错误预测率成线性关系）是假设1（每次预测错误的惩罚恒定）和假设2（分支指令比例恒定）的直接推论，因为总停顿时间是分支数量、错误预测率和每次预测错误的惩罚三者的乘积。由于分支数量和惩罚是恒定的，所以停顿时间与错误预测率成正比。\n\n### 第3步：结论与行动\n问题被判定为 **有效**。将推导解答。\n\n设 $T_{base}$ 是工作负载在基准系统上的总执行时间。我们可以将此时间分解为两个部分：由分支预测错误引起的停顿时间 $T_{stall, base}$，以及用于所有其他活动的时间 $T_{other}$。\n$$T_{base} = T_{stall, base} + T_{other}$$\n根据问题陈述，这些停顿所占基准执行时间的比例为 $f$。\n$$T_{stall, base} = f \\cdot T_{base}$$\n因此，所有其他活动的时间为：\n$$T_{other} = T_{base} - T_{stall, base} = T_{base} - f \\cdot T_{base} = (1-f) \\cdot T_{base}$$\n现在，考虑带有升级版分支预测器的系统。设新的总执行时间为 $T_{new}$。问题陈述指出，所有其他执行时间的来源均不受影响，这意味着 $T_{other}$ 部分保持不变。新的执行时间是新的停顿时间 $T_{stall, new}$ 与 $T_{other}$ 之和。\n$$T_{new} = T_{stall, new} + T_{other}$$\n问题陈述指出，由分支引起的停顿时间与错误预测率成线性关系。设 $m_{base}$ 为基准错误预测率，$m_{new}$ 为新的错误预测率。\n基准预测准确率为 $p$，所以基准错误预测率为：\n$$m_{base} = 1 - p$$\n升级后的预测准确率为 $p + \\Delta p$，所以新的错误预测率为：\n$$m_{new} = 1 - (p + \\Delta p) = 1 - p - \\Delta p$$\n线性关系意味着停顿时间之比等于其对应的错误预测率之比：\n$$\\frac{T_{stall, new}}{T_{stall, base}} = \\frac{m_{new}}{m_{base}} = \\frac{1 - p - \\Delta p}{1 - p}$$\n我们可以用基准停顿时间来表示新的停顿时间 $T_{stall, new}$：\n$$T_{stall, new} = T_{stall, base} \\cdot \\left(\\frac{1 - p - \\Delta p}{1 - p}\\right)$$\n代入 $T_{stall, base} = f \\cdot T_{base}$：\n$$T_{stall, new} = (f \\cdot T_{base}) \\cdot \\left(\\frac{1 - p - \\Delta p}{1 - p}\\right)$$\n现在我们可以写出新的总执行时间 $T_{new}$ 的表达式：\n$$T_{new} = T_{stall, new} + T_{other} = (f \\cdot T_{base}) \\left(\\frac{1 - p - \\Delta p}{1 - p}\\right) + (1-f) \\cdot T_{base}$$\n提取公因式 $T_{base}$：\n$$T_{new} = T_{base} \\left[ f \\left(\\frac{1 - p - \\Delta p}{1 - p}\\right) + (1-f) \\right]$$\n总体加速比 $S$ 定义为基准执行时间与新执行时间之比：\n$$S = \\frac{T_{base}}{T_{new}}$$\n代入 $T_{new}$ 的表达式：\n$$S = \\frac{T_{base}}{T_{base} \\left[ f \\left(\\frac{1 - p - \\Delta p}{1 - p}\\right) + (1-f) \\right]} = \\frac{1}{f \\left(\\frac{1 - p - \\Delta p}{1 - p}\\right) + (1-f)}$$\n为简化此表达式，我们为分母中的各项找到一个公分母：\n$$S = \\frac{1}{\\frac{f(1 - p - \\Delta p) + (1-f)(1 - p)}{1 - p}}$$\n$$S = \\frac{1 - p}{f(1 - p - \\Delta p) + (1-f)(1 - p)}$$\n展开分母中的项：\n$$f(1 - p - \\Delta p) + (1-f)(1 - p) = (f - fp - f\\Delta p) + (1 - p - f + fp)$$\n项 $f$ 和 $-f$ 消掉了，$-fp$ 和 $fp$ 也一样：\n$$f - fp - f\\Delta p + 1 - p - f + fp = 1 - p - f\\Delta p$$\n将这个简化后的表达式代回 $S$ 的方程：\n$$S = \\frac{1 - p}{1 - p - f\\Delta p}$$\n这个结果与阿姆达尔定律（Amdahl's Law）一致，该定律指出加速比由 $S = \\frac{1}{(1-f_{enh}) + \\frac{f_{enh}}{S_{enh}}}$ 给出。在这里，被优化的时间比例是停顿时间，所以 $f_{enh} = f$。被优化部分（停顿）的加速比是 $S_{enh} = \\frac{T_{stall, base}}{T_{stall, new}} = \\frac{1-p}{1-p-\\Delta p}$。将这些代入阿姆达尔定律的公式，可以得到与上面推导出的相同的中间表达式，从而证实了结果。总体加速比 $S$ 的最终表达式为其最简形式。", "answer": "$$\n\\boxed{\\frac{1-p}{1-p-f\\Delta p}}\n$$", "id": "3664724"}, {"introduction": "性能建模不仅用于分析现有系统，更在设计新系统中发挥着关键作用，尤其是在面对相互制约的设计决策时。处理器流水线深度的选择便是一个典型的权衡问题：更深的流水线可以提高时钟频率，但同时也会增加分支预测失败等事件的惩罚周期。本练习 [@problem_id:3664684] 将通过建立一个参数化模型，指导您如何运用数学方法来平衡这些得失，从而找到最大化处理器吞吐量的最佳流水线深度，亲身体验架构师在设计阶段的核心决策过程。", "problem": "一位处理器设计师正在研究流水线深度 $D$ 如何影响一个运行分支密集型工作负载的单发射顺序执行核心的执行吞吐率。针对该工作负载，测量或假设了以下参数：\n\n- 忽略控制冒险的基础每指令周期数 (CPI) 为 $C_{0} = 1.0$。\n- 动态分支指令的比例为 $r_{b} = 0.20$ 分支/指令。\n- 分支预测错误的概率为 $p_{m} = 0.10$ /分支。\n- 以周期为单位的分支预测错误惩罚与流水线深度成正比，建模为 $P_{\\mathrm{br}}(D) = \\beta D$，其中 $\\beta = 1.0$ 周期/级。\n- 时钟周期 $T_{\\mathrm{clk}}(D)$ 通过将总组合逻辑延迟均匀分配到各个阶段，并加上由锁存器和时钟分配引起的固定的每级开销来建模：$T_{\\mathrm{clk}}(D) = t_{\\mathrm{ov}} + \\frac{t_{\\mathrm{comb}}}{D}$，其中 $t_{\\mathrm{ov}} = 200\\,\\mathrm{ps}$ 且 $t_{\\mathrm{comb}} = 3500\\,\\mathrm{ps}$。\n\n使用以下基本性能模型：\n\n- 每周期指令数 (IPC) 与 CPI 通过 $IPC(D) = \\frac{1}{CPI(D)}$ 关联。\n- 考虑控制冒险的平均 CPI 为 $CPI(D) = C_{0} + r_{b} p_{m} P_{\\mathrm{br}}(D)$。\n- 每秒指令数为 $IPS(D) = \\frac{IPC(D)}{T_{\\mathrm{clk}}(D)}$。\n\n将 $D$ 视为一个正实数变量。在给定模型下，推导使 $IPS(D)$ 最大化的 $D$ 的参数化表达式，并根据指定的工作负载参数计算其值。报告最优的实数值流水线深度 $D$（无量纲）。将你的答案四舍五入到三位有效数字。", "solution": "用户要求找出使处理器性能（以每秒指令数 $IPS$ 衡量）最大化的最优流水线深度 $D$。题目提供了一组关于性能指标如何依赖于 $D$ 的模型。\n\n首先，我们必须使用给定的关系式来构建目标函数 $IPS(D)$。\n平均每指令周期数 $CPI(D)$ 建模为基础 CPI $C_0$ 与分支预测错误惩罚项之和：\n$$CPI(D) = C_{0} + r_{b} p_{m} P_{\\mathrm{br}}(D)$$\n分支预测错误惩罚 $P_{\\mathrm{br}}(D)$ 与流水线深度 $D$ 成正比：\n$$P_{\\mathrm{br}}(D) = \\beta D$$\n将此代入 $CPI$ 方程得到：\n$$CPI(D) = C_{0} + r_{b} p_{m} \\beta D$$\n每周期指令数 $IPC(D)$ 是 $CPI(D)$ 的倒数：\n$$IPC(D) = \\frac{1}{CPI(D)} = \\frac{1}{C_{0} + r_{b} p_{m} \\beta D}$$\n时钟周期 $T_{\\mathrm{clk}}(D)$ 也是流水线深度的函数：\n$$T_{\\mathrm{clk}}(D) = t_{\\mathrm{ov}} + \\frac{t_{\\mathrm{comb}}}{D}$$\n最后，以每秒指令数计量的性能 $IPS(D)$ 由 $IPC(D)$ 与时钟周期 $T_{\\mathrm{clk}}(D)$ 的比值给出：\n$$IPS(D) = \\frac{IPC(D)}{T_{\\mathrm{clk}}(D)} = \\frac{\\frac{1}{C_{0} + r_{b} p_{m} \\beta D}}{t_{\\mathrm{ov}} + \\frac{t_{\\mathrm{comb}}}{D}}$$\n这可以写成：\n$$IPS(D) = \\frac{1}{(C_{0} + r_{b} p_{m} \\beta D) (t_{\\mathrm{ov}} + \\frac{t_{\\mathrm{comb}}}{D})}$$\n为了最大化 $IPS(D)$，我们必须最小化其分母，我们将其定义为函数 $f(D)$。题目指定 $D$ 应被视为一个正实数变量。\n$$f(D) = (C_{0} + r_{b} p_{m} \\beta D) \\left(t_{\\mathrm{ov}} + \\frac{t_{\\mathrm{comb}}}{D}\\right)$$\n展开此表达式，我们得到：\n$$f(D) = C_{0}t_{\\mathrm{ov}} + C_{0}\\frac{t_{\\mathrm{comb}}}{D} + (r_{b} p_{m} \\beta D)t_{\\mathrm{ov}} + (r_{b} p_{m} \\beta D)\\frac{t_{\\mathrm{comb}}}{D}$$\n$$f(D) = C_{0}t_{\\mathrm{ov}} + \\frac{C_{0}t_{\\mathrm{comb}}}{D} + r_{b} p_{m} \\beta t_{\\mathrm{ov}} D + r_{b} p_{m} \\beta t_{\\mathrm{comb}}$$\n为了找到使 $f(D)$ 最小化的 $D$ 值，我们对 $f(D)$ 关于 $D$ 求导并令其为零。首先，我们根据各项对 $D$ 的依赖关系重新排列它们：\n$$f(D) = (r_{b} p_{m} \\beta t_{\\mathrm{ov}})D + (C_{0}t_{\\mathrm{comb}})D^{-1} + (C_{0}t_{\\mathrm{ov}} + r_{b} p_{m} \\beta t_{\\mathrm{comb}})$$\n关于 $D$ 的导数是：\n$$\\frac{df}{dD} = r_{b} p_{m} \\beta t_{\\mathrm{ov}} - C_{0}t_{\\mathrm{comb}}D^{-2} = r_{b} p_{m} \\beta t_{\\mathrm{ov}} - \\frac{C_{0}t_{\\mathrm{comb}}}{D^2}$$\n令导数为零以找到临界点：\n$$r_{b} p_{m} \\beta t_{\\mathrm{ov}} - \\frac{C_{0}t_{\\mathrm{comb}}}{D^2} = 0$$\n$$r_{b} p_{m} \\beta t_{\\mathrm{ov}} = \\frac{C_{0}t_{\\mathrm{comb}}}{D^2}$$\n解出 $D^2$：\n$$D^2 = \\frac{C_{0}t_{\\mathrm{comb}}}{r_{b} p_{m} \\beta t_{\\mathrm{ov}}}$$\n由于 $D$ 必须为正，我们取正平方根来找到最优流水线深度 $D_{\\mathrm{opt}}$：\n$$D_{\\mathrm{opt}} = \\sqrt{\\frac{C_{0}t_{\\mathrm{comb}}}{r_{b} p_{m} \\beta t_{\\mathrm{ov}}}}$$\n为了确认这是一个最小值，我们计算二阶导数：\n$$\\frac{d^2f}{dD^2} = \\frac{d}{dD}\\left(r_{b} p_{m} \\beta t_{\\mathrm{ov}} - C_{0}t_{\\mathrm{comb}}D^{-2}\\right) = 2C_{0}t_{\\mathrm{comb}}D^{-3} = \\frac{2C_{0}t_{\\mathrm{comb}}}{D^3}$$\n由于所有参数 $C_{0}$、$t_{\\mathrm{comb}}$ 都为正，且 $D > 0$，二阶导数为正。这证实了找到的临界点对应于 $f(D)$ 的一个局部最小值，因而也是 $IPS(D)$ 的一个局部最大值。由于这是 $D > 0$ 范围内唯一的临界点，因此它也是全局最优解。\n\n现在，我们代入给定的数值：\n$C_{0} = 1.0$ (无量纲)\n$r_{b} = 0.20$ (无量纲)\n$p_{m} = 0.10$ (无量纲)\n$\\beta = 1.0$ (周期/级)\n$t_{\\mathrm{ov}} = 200\\,\\mathrm{ps}$\n$t_{\\mathrm{comb}} = 3500\\,\\mathrm{ps}$\n\n$$D_{\\mathrm{opt}} = \\sqrt{\\frac{(1.0)(3500\\,\\mathrm{ps})}{(0.20)(0.10)(1.0)(200\\,\\mathrm{ps})}}$$\n分子和分母中的皮秒 ($ps$) 单位相互抵消，最终得到 $D$ 所需的无量纲量。\n$$D_{\\mathrm{opt}} = \\sqrt{\\frac{3500}{(0.02)(200)}} = \\sqrt{\\frac{3500}{4}}$$\n$$D_{\\mathrm{opt}} = \\sqrt{875}$$\n计算数值：\n$$D_{\\mathrm{opt}} \\approx 29.5803989...$$\n题目要求将结果四舍五入到三位有效数字。\n$$D_{\\mathrm{opt}} \\approx 29.6$$", "answer": "$$\\boxed{29.6}$$", "id": "3664684"}, {"introduction": "卓越的性能并非仅来自硬件的精妙设计，软件层面的数据组织方式同样至关重要，它直接影响着硬件（尤其是内存系统）效率的发挥。本练习 [@problem_id:3664714] 聚焦于数据布局对缓存性能的影响，通过对比“结构数组”(AoS)与“数组结构”(SoA)这两种常见模式，您将学会如何从第一性原理出发，分析空间局部性并量化其对缓存命中率和有效带宽利用率的影响。掌握这种分析能力，是编写高性能计算代码的必备技能。", "problem": "您正在评估两种数据布局对一个在记录数组上执行的流式、向量化循环的内存系统影响。每条记录有四个双精度浮点数类型的字段（每个字段为 $8$ 字节），分别命名为 $a$、$b$、$c$ 和 $d$。计算核心执行标量归约 $S = \\sum_{i=0}^{N-1} \\left(\\alpha \\cdot a_i + \\beta \\cdot b_i\\right)$，对于每条记录 $i$，仅访问字段 $a$ 和 $b$，$N$ 足够大以忽略预热效应。该循环被编译为使用单指令多数据（SIMD）向量化，向量长度为 $VL = 4$ 个双精度浮点数，但您必须从第一性原理出发对内存行为进行建模，而不是依赖任何关于指令语义的隐藏假设。\n\n考虑两种数据布局：\n- 结构体数组 (AoS)：记录以 $[a_0,b_0,c_0,d_0][a_1,b_1,c_1,d_1]\\ldots$ 的形式连续存储，因此每条记录的大小为 $32$ 字节，对齐后，一个 $64$ 字节的缓存行可以容纳 $2$ 条记录。\n- 数组结构 (SoA)：四个独立的数组分别存储字段 $a[\\,]$、$b[\\,]$、$c[\\,]$ 和 $d[\\,]$，每个数组在内存中是连续的。\n\n假设具有以下体系结构和工作负载属性：\n- 一级（L1）数据缓存行大小为 $64$ 字节。\n- 数组和 AoS 块的起始地址都与 $64$ 字节边界对齐。\n- 工作集很大且是流式的，因此您可以将所有未命中都视为强制性未命中，并忽略容量、冲突和一致性效应。\n- 忽略转译后备缓冲器（TLB）效应和指令提取效应；仅对数据内存行为进行建模。\n- 向量化机制可能会对 AoS 使用收集（gather）操作，但您应该严格根据内存布局和访问模式来计算数据流量和缓存行填充，而不是根据微体系结构的指令选择。\n- 每次 L1 未命中都会从下一级缓存获取一整个 $64$ 字节的缓存行。\n\n使用以下基于核心性能建模的定义：\n- 循环请求的标量数据项总数等于读取的 $a$ 和 $b$ 字段值的数量，即 $2N$ 个项，每个大小为 $8$ 字节。\n- 此处的 L1 未命中率定义为 L1 数据缓存行填充次数除以循环请求的标量数据项数量（即，每个请求的 $8$ 字节字段值的未命中次数）。\n- 有效带宽利用率定义为计算所需的有用有效载荷字节数与因这些加载操作而传输到 L1 的总字节数之比。\n\n在这些假设下，哪个选项正确地说明了 AoS 和 SoA 布局的稳态 L1 未命中率和有效带宽利用率？\n\nA. AoS: 未命中率 $25\\%$，带宽利用率 $50\\%$；SoA: 未命中率 $12.5\\%$，带宽利用率 $100\\%$。\n\nB. AoS: 未命中率 $12.5\\%$，带宽利用率 $100\\%$；SoA: 未命中率 $25\\%$，带宽利用率 $50\\%$。\n\nC. AoS: 未命中率 $12.5\\%$，带宽利用率 $100\\%$；SoA: 未命中率 $12.5\\%$，带宽利用率 $100\\%$。\n\nD. AoS: 未命中率 $25\\%$，带宽利用率 $25\\%$；SoA: 未命中率 $12.5\\%$，带宽利用率 $50\\%$。", "solution": "我们从空间局部性、缓存行和强制性未命中的核心定义出发。L1 未命中率是缓存行填充次数除以请求的标量字段值的数量，有效带宽利用率是有用有效载荷除以因这些填充而带入 L1 的总字节数。\n\n通用事实和参数：\n- 每个请求的字段值为 $8$ 字节。\n- 循环总共请求 $2N$ 个标量字段值（$N$ 条记录中的每条记录的 $a_i$ 和 $b_i$），共计 $16N$ 字节的有用数据。\n- 缓存行大小为 $64$ 字节。\n- 所有数据都是 $64$ 字节对齐的，且 $N$ 很大，因此边界效应可以忽略不计，并且如果布局允许，每个缓存行最终都会将其包含的数据贡献给某个请求。\n\n数组结构 (SoA):\n- $a[\\,]$ 数组连续存储双精度浮点数。一个 $64$ 字节的缓存行可以容纳 $64/8 = 8$ 个 $a$ 的元素。\n- $b[\\,]$ 数组类似地每 $64$ 字节行容纳 $8$ 个元素。\n- 对于 $N$ 个元素，假设完美对齐和流式访问，除了顺序消耗外没有跨迭代的重用，为 $a$ 获取的不同缓存行数量为 $N/8$，为 $b$ 获取的为 $N/8$。\n- 因此，请求的数据所需的 L1 缓存行填充总数为 $(N/8) + (N/8) = N/4$。\n- 标量字段请求的总数为 $2N$，所以 L1 未命中率为\n$$\n\\text{miss rate}_{\\text{SoA}} = \\frac{(N/4)}{2N} = \\frac{1}{8} = 12.5\\% \\, .\n$$\n- 由于这些未命中而传输到 L1 的总字节数为 $(N/4)$ 行 $\\times 64$ 字节/行 $= 16N$ 字节。\n- 有用有效载荷字节数为 $2N \\times 8 = 16N$ 字节（仅使用 $a$ 和 $b$）。\n- 因此，有效带宽利用率为\n$$\n\\text{util}_{\\text{SoA}} = \\frac{16N}{16N} = 1.0 = 100\\% \\, .\n$$\n这反映了，对于连续数组和流式访问，为 $a$ 或 $b$ 获取的每个缓存行都被循环完全消耗。\n\n结构体数组 (AoS):\n- 每条记录为 $32$ 字节（$4$ 个双精度浮点数）。对齐后，一个 $64$ 字节的行可以容纳 $64/32 = 2$ 条记录。\n- $N$ 条记录的数组足迹为 $32N$ 字节，对应于在流式遍历中接触到的 $(32N)/64 = N/2$ 个不同的缓存行。\n- 为了访问每个 $i$ 的 $a_i$ 和 $b_i$，循环必须获取跨越 AoS 块的缓存行；这些行上的字段 $c$ 和 $d$ 不被计算使用，因此它们的字节不计为有用数据。\n- 因此，L1 缓存行填充总数为 $N/2$。\n- 标量字段请求的总数为 $2N$，所以 L1 未命中率为\n$$\n\\text{miss rate}_{\\text{AoS}} = \\frac{(N/2)}{2N} = \\frac{1}{4} = 25\\% \\, .\n$$\n- 由于这些未命中而传输到 L1 的总字节数为 $(N/2)$ 行 $\\times 64$ 字节/行 $= 32N$ 字节。\n- 有用有效载荷字节数仍为 $16N$ 字节（仅使用 $a$ 和 $b$）。\n- 因此，有效带宽利用率为\n$$\n\\text{util}_{\\text{AoS}} = \\frac{16N}{32N} = \\frac{1}{2} = 50\\% \\, .\n$$\n这捕捉到了由于在 AoS 布局中将未使用的字段 $c$ 和 $d$ 与所需字段交错存储而导致的过量获取（overfetch）。\n\n向量化的作用：\n- SIMD 向量长度为 $VL = 4$ 个双精度浮点数。对于 SoA，每个向量加载触及 $32$ 个连续字节；两个这样的向量可以放入一个 $64$ 字节的行中，从而得到与上述标量推理相同的稳态行数。\n- 对于 AoS，对字段 $a$ 和 $b$ 的向量化访问在连续记录之间表现出 $32$ 字节的步幅。尽管这可能需要收集（gather）操作，但带入 L1 的不同缓存行的总数由 AoS 的空间打包方式决定，并且仍然是 $N/2$，如前所述。因此，在所述假设下，计算出的未命中率和利用率不受向量化的影响。\n\n逐项分析：\n- 选项 A 指出 AoS 未命中率为 $25\\%$，利用率为 $50\\%$；SoA 未命中率为 $12.5\\%$，利用率为 $100\\%$。这些与上面的推导相符。结论：正确。\n- 选项 B 交换了 AoS 和 SoA 的结果，与空间局部性分析相矛盾。结论：不正确。\n- 选项 C 声称两种布局都实现了 $12.5\\%$ 的未命中率和 $100\\%$ 的利用率，这忽略了 AoS 中为未使用字段获取的浪费字节以及所需的更多缓存行。结论：不正确。\n- 选项 D 给出 AoS 未命中率为 $25\\%$（这与推导相符），但声称 AoS 利用率为 $25\\%$，SoA 利用率为 $50\\%$，这两者都与上面的字节核算不一致。结论：不正确。\n\n因此，正确选项是 A。", "answer": "$$\\boxed{A}$$", "id": "3664714"}]}