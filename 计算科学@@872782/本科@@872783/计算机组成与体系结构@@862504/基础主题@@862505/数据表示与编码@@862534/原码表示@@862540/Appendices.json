{"hands_on_practices": [{"introduction": "这个首个练习旨在检验你对基础知识的理解。在我们探索算术或系统设计的复杂性之前，我们必须熟练掌握符号数值表示法的基本语言：将一个我们熟悉的十进制数转换为其二进制形式。这个练习 [@problem_id:1960344] 不仅巩固了核心定义——一个专用的符号位加上一个数值位——而且突显了它与更常见的二进制补码系统在结构上的差异。", "problem": "在数字系统中，负数可以用多种方式表示。两种常见的格式是符号-数值表示法和二进制补码表示法。考虑一个需要执行算术运算的简单4位处理器。为了验证其逻辑，您的任务是找出十进制数 $-7$ 的正确二进制表示。\n\n十进制数 $-7$ 的4位符号-数值表示和4位二进制补码表示分别是什么？\n\nA. 符号-数值: `1001`，二进制补码: `1111`\n\nB. 符号-数值: `0111`，二进制补码: `1001`\n\nC. 符号-数值: `1111`，二进制补码: `1000`\n\nD. 符号-数值: `1111`，二进制补码: `1001`\n\nE. 符号-数值: `1001`，二进制补码: `1001`", "solution": "我们寻求十进制值 $-7$ 在两种方案下的4位编码。\n\n符号-数值表示法：在4位中，最高有效位是符号位 $s$，其余三位编码数值的大小。对于负数，$s=1$。$|-7|$ 的大小为 $7$，其3位二进制为 $111_2$。因此，4位符号-数值编码是 $1\\,111$，即 $1111_2$。\n\n二进制补码表示法：要获得 $-7$ 的4位二进制补码，从 $+7$ 的4位二进制表示 $0111_2$ 开始。将所有位取反得到 $1000_2$，然后加 $1$：\n$$\n1000_2+0001_2=1001_2\n$$\n使用二进制补码的权值进行快速检查，可以确认 $1001_2$ 在4位中表示 $-7$，因为\n$$\n1001_2 = -2^3 + 0\\cdot 2^2 + 0\\cdot 2^1 + 1\\cdot 2^0 = -8 + 1 = -7.\n$$\n因此，符号-数值表示为 $1111$，二进制补码表示为 $1001$，这对应于选项D。", "answer": "$$\\boxed{D}$$", "id": "1960344"}, {"introduction": "在掌握了基本转换之后，下一个练习 [@problem_id:1960341] 将让你扮演系统设计师的角色。数字工程中的一个核心任务是确定满足规格所需的最小资源，在这里，这涉及到计算表示给定整数范围所需的必要位宽。这个问题展示了符号数值表示法的结构如何直接影响实际的硬件决策，将抽象的数制概念与具体的设计限制联系起来。", "problem": "一个工程师团队正在为一个物理实验设计一个简单的数字数据采集系统。该系统需要记录一个特定的物理量，该物理量可以围绕一个零点在其正负方向上波动。这些值的范围是从 -63 到 +63 的整数（包含两端）。工程师们决定使用符号-数值表示法将这些值存储在一个二进制寄存器中。\n\n在符号-数值数制中，最高有效位 (MSB)，即最左边的位，用作符号位。符号位为 0 表示正数或零，而符号位为 1 表示负数。寄存器中的其余位用于表示该数的数值大小，其形式为一个标准的无符号二进制整数。\n\n假定该寄存器必须能够表示从 -63 到 +63 的每一个整数值，那么该寄存器所需的最少总位数是多少？", "solution": "设该寄存器使用一位符号位和 $m$ 位数值位。在符号-数值表示法中，数值字段是一个无符号二进制整数，其范围是从 $0$到 $2^{m}-1$。为了表示所有需要的绝对值 $|x| \\in \\{0,1,\\dots,63\\}$，数值部分必须满足\n$$2^{m}-1 \\ge 63.$$\n这等价于\n$$2^{m} \\ge 64,$$\n因此，最小整数 $m$ 为\n$$m = \\lceil \\log_{2}(64) \\rceil = 6.$$\n包括一位符号位在内，所需的总位数为\n$$1 + m = 1 + 6 = 7.$$", "answer": "$$\\boxed{7}$$", "id": "1960341"}, {"introduction": "这最后一个练习是一个综合性的挑战，它将我们学到的关于符号数值表示法的所有概念融合到一个功能完整的算法中。与二进制补码不同，符号数值表示法中的算术运算需要对符号和数值进行小心的、分离的处理，而这个除法问题 [@problem_id:3676522] 正是这一现实的体现。通过从第一性原理出发构建一个除法程序，你将需要处理符号确定（使用异或操作判断奇偶性）和数值计算（使用标准无符号除法）的逻辑分离，以及处理如除以零和双零表示（$+0$ 和 $-0$）的规范化等关键边界情况。", "problem": "您需要实现一个适用于硬件级推理的、基于定宽符号-数值表示法的整数除法程序。设字长为 $w = 8$ 位，其中位 $b_{7}$ 是符号位，位 $b_{6}\\dots b_{0}$ 编码数值。\n\n一个字按如下方式编码一个数学上的整数 $v$：如果数值 $m$ 为零，则该字可以编码为 $+0$ 或 $-0$（两者都必须被视为同一个数学上的零）；否则，其值为 $v = (-1)^{s} \\cdot m$，其中 $s \\in \\{0,1\\}$ 是符号位，$m \\in \\{1,2,\\dots,127\\}$ 是数值。字值本身是一个在 $\\{0,1,\\dots,255\\}$ 范围内的无符号整数，其二进制形式与符号-数值布局相匹配。\n\n从符号-数值表示法的定义以及非负整数长除法的基本存在性和唯一性属性（即对于任何非负整数 $a$ 和 $b \\neq 0$，存在唯一的整数 $q$ 和 $r$，使得 $a = qb + r$ 且 $0 \\le r < b$）出发，仅使用以下原则来推导并实现一个针对符号-数值操作数的除法算法：\n- 使用经典长除法对数值进行运算，以确定商和余数的数值。\n- 确保当除数非零时，带符号的结果 $(q,r)$ 满足恒等式 $x = y \\cdot q + r$，且 $|r| < |y|$，其中 $|\\cdot|$ 表示数值，$x$ 和 $y$ 是输入字所表示的数学整数。\n- 根据操作数符号的负号奇偶性来确定商的符号（即，当且仅当操作数符号相同时，商为正）。\n- 为余数符号选择一个一致且合理的约定，使得上述恒等式在向零截断的情况下成立。\n- 将输入中的 $+0$ 和 $-0$ 都视为数值为零。在所有输出中，将零规范化，使得零结果的符号位被清零为 $0$。\n- 明确定义除以零时的行为：当除数的数值为零时，产生一个指定的错误指示符，并为商和余数选择与您的约定一致的确定性输出字。\n\n您的实现必须：\n- 不接受任何输入，而是使用 $w = 8$ 位运行一个固定的符号-数值字对测试套件。\n- 对于每个测试用例，产生三个无符号整数：编码后的商字、编码后的余数字，以及一个错误标志，其中 $0$ 表示“无错误”，$1$ 表示“除以零”。\n- 将所有测试用例的结果汇总到单行输出中，该输出包含一个用方括号括起来的逗号分隔列表，顺序为 $[q_{1},r_{1},e_{1},q_{2},r_{2},e_{2},\\dots]$，其中 $q_{i}$ 和 $r_{i}$ 是编码后的结果字，$e_{i} \\in \\{0,1\\}$ 是错误标志。\n\n使用以下测试套件。每个操作数都以其 $8$ 位符号-数值编码字给出，并解释为 $\\{0,\\dots,255\\}$ 范围内的无符号整数：\n- 测试 1：被除数 $x = 25$，除数 $y = 6$。\n- 测试 2：被除数 $x = 153$，除数 $y = 6$。（这编码了 $-25$ 除以 $+6$。）\n- 测试 3：被除数 $x = 153$，除数 $y = 134$。（这编码了 $-25$ 除以 $-6$。）\n- 测试 4：被除数 $x = 5$，除数 $y = 7$。\n- 测试 5：被除数 $x = 133$，除数 $y = 7$。（这编码了 $-5$ 除以 $+7$。）\n- 测试 6：被除数 $x = 0$，除数 $y = 135$。（这编码了 $+0$ 除以 $-7$。）\n- 测试 7：被除数 $x = 128$，除数 $y = 7$。（这编码了 $-0$ 除以 $+7$。）\n- 测试 8：被除数 $x = 13$，除数 $y = 0$。（除以零。）\n- 测试 9：被除数 $x = 141$，除数 $y = 128$。（这编码了 $-13$ 除以 $-0$；除以零。）\n- 测试 10：被除数 $x = 152$，除数 $y = 6$。（这编码了 $-24$ 除以 $+6$。）\n\n您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果，顺序与测试套件完全一致且不含空格，例如 [$q_{1},r_{1},e_{1},\\dots,q_{10},r_{10},e_{10}$]。", "solution": "问题陈述被认为是有效的，因为它科学地基于计算机算术原理，定义明确且具有充分和一致的约束，并以客观、正式的语言表述。因此，我们可以着手提出解决方案。\n\n任务是为 $w=8$ 位的符号-数值数推导并实现一个整数除法算法。推导过程必须遵守一系列指定的基本原则。\n\n**1. 符号-数值表示法的形式化**\n\n一个8位字是一个无符号整数 $W \\in \\{0, 1, \\dots, 255\\}$，它表示一个数学上的整数 $v$。最高有效位 $b_7$ 是符号位 $s$。其余的7个位 $b_6 \\dots b_0$ 表示数值 $m$。\n符号位 $s$ 通过 $s = \\lfloor W / 2^7 \\rfloor = (W \\gg 7)$ 提取。\n数值 $m$ 通过 $m = W \\pmod{2^7} = W & (2^7-1)$ 提取，其中按位与掩码在十六进制中为 $0x7F$，等同于十进制值 $127$。\n数学整数值 $v$ 由 $v = (-1)^s \\cdot m$ 给出。\n根据此定义，数值 $m=0$ 可以由两个字表示：$W=0$（$s=0$时，表示 $+0$）和 $W=128$（$s=1$时，表示 $-0$）。两者都被视为数学整数 $0$。数值的范围可以是 $m \\in \\{0, 1, \\dots, 127\\}$。\n\n**2. 除法算法的推导**\n\n设被除数和除数由数学整数 $x$ 和 $y$ 表示，它们分别被编码为字 $W_x$ 和 $W_y$。我们的目标是找到商 $q$ 和余数 $r$，使得基本除法恒等式 $x = y \\cdot q + r$ 成立，并满足约束 $|r| < |y|$。除法必须向零截断。\n\n**2.1. 处理除以零的情况**\n\n当且仅当除数 $y$ 的数值 $m_y$ 为零时，$y$ 才为零。这种情况发生在字 $W_y$ 为 $0$（$+0$）或 $128$（$-0$）时。在这种情况下，除法是未定义的。问题要求设置错误标志 $e=1$，并为商和余数生成确定性的输出字。一个标准且合乎逻辑的选择是为两者输出规范化的零。因此，如果 $m_y=0$，结果是：\n- 错误标志 $e = 1$。\n- 商字 $W_q = 0$。\n- 余数字 $W_r = 0$。\n\n**2.2. 数值除法**\n\n对于非零除数（$m_y \\neq 0$），核心运算基于非负整数的欧几里得除法定理。我们对数值 $m_x$ 和 $m_y$ 进行运算。该定理保证了唯一的非负整数 $m_q$（商的数值）和 $m_r$（余数的数值）的存在，使得：\n$$m_x = m_y \\cdot m_q + m_r \\quad \\text{with} \\quad 0 \\le m_r < m_y$$\n这些可以通过标准整数除法计算得出：\n- $m_q = \\lfloor m_x / m_y \\rfloor$\n- $m_r = m_x \\pmod{m_y}$\n\n**2.3. 确定商的符号**\n\n问题规定，当且仅当操作数符号相同时，商为正。这对应于对符号位进行异或（XOR）操作。设 $s_x$ 和 $s_y$ 分别为被除数和除数的符号位。商的符号位 $s_q$ 为：\n$$s_q = s_x \\oplus s_y$$\n商的数学值是 $q = (-1)^{s_q} \\cdot m_q$。这个定义对应于向零截断。例如，如果在实数算术中 $x/y = -4.16$，向零截断得到 $q=-4$。\n\n**2.4. 确定余数的符号**\n\n余数的符号 $s_r$ 必须被选择以满足除法恒等式 $x = y \\cdot q + r$。对 $r$ 进行移项，我们得到：\n$$r = x - y \\cdot q$$\n代入符号-数值的定义：\n- $x = (-1)^{s_x} m_x$\n- $y = (-1)^{s_y} m_y$\n- $q = (-1)^{s_q} m_q = (-1)^{s_x \\oplus s_y} m_q$\n\n乘积 $y \\cdot q$ 是：\n$$y \\cdot q = ((-1)^{s_y} m_y) \\cdot ((-1)^{s_x \\oplus s_y} m_q) = (-1)^{s_y + (s_x \\oplus s_y)} (m_y \\cdot m_q)$$\n指数 $s_y + (s_x \\oplus s_y)$ 可以简化为一个与 $s_x$ 具有相同奇偶性的表达式。例如，如果 $s_y=0$，指数为 $s_x$。如果 $s_y=1$，指数为 $1 + (s_x \\oplus 1)$。如果 $s_x=0$，这得到 $1+1=2$（偶数）。如果 $s_x=1$，这得到 $1+0=1$（奇数）。在所有情况下，都有 $(-1)^{s_y + (s_x \\oplus s_y)} = (-1)^{s_x}$。\n因此，$y \\cdot q = (-1)^{s_x} (m_y \\cdot m_q)$。\n\n现在，我们将其代回 $r$ 的方程中：\n$$r = (-1)^{s_x} m_x - (-1)^{s_x} (m_y \\cdot m_q)$$\n$$r = (-1)^{s_x} (m_x - m_y \\cdot m_q)$$\n从数值除法中，我们知道 $m_r = m_x - m_y \\cdot m_q$。因此：\n$$r = (-1)^{s_x} m_r$$\n这证明了余数的符号必须与被除数的符号相同（$s_r = s_x$）。这个约定确保了对于向零截断的除法，恒等式成立，并且也保留了所需的属性 $|r| < |y|$，因为 $m_r < m_y$。\n\n**3. 算法总结与编码**\n\n完整的算法如下：\n1.  将输入 $W_x, W_y$ 解码为符号（$s_x, s_y$）和数值（$m_x, m_y$）。\n2.  如果 $m_y = 0$，设置 $e=1, W_q=0, W_r=0$，并终止。\n3.  如果 $m_y \\neq 0$，设置 $e=0$。\n4.  计算 $m_q = \\lfloor m_x / m_y \\rfloor$ 和 $m_r = m_x \\pmod{m_y}$。\n5.  确定符号：$s_q = s_x \\oplus s_y$ 和 $s_r = s_x$。\n6.  编码商：如果 $m_q=0$，$W_q=0$（规范化的零）。否则，$W_q = (s_q \\ll 7) | m_q$。\n7.  编码余数：如果 $m_r=0$，$W_r=0$（规范化的零）。否则，$W_r = (s_r \\ll 7) | m_r$。\n\n此过程应用于每个测试用例。例如，对于测试 2（$W_x=153$，$W_y=6$）：\n- $x$: $s_x=1, m_x=25$ (值为 $-25$)\n- $y$: $s_y=0, m_y=6$ (值为 $+6$)\n- $e=0$。\n- $m_q = \\lfloor 25/6 \\rfloor = 4$。$m_r = 25 \\pmod 6 = 1$。\n- $s_q = 1 \\oplus 0 = 1$。$s_r = 1$。\n- $q$: 值为 $-4$。$W_q = (1 \\ll 7) | 4 = 128 | 4 = 132$。\n- $r$: 值为 $-1$。$W_r = (1 \\ll 7) | 1 = 128 | 1 = 129$。\n- 结果: $(132, 129, 0)$。\n\n此逻辑针对完整的测试套件实现。", "answer": "```\n[4,1,0,132,129,0,4,129,0,0,5,0,0,133,0,0,0,0,0,0,0,0,0,1,0,0,1,132,0,0]\n```", "id": "3676522"}]}