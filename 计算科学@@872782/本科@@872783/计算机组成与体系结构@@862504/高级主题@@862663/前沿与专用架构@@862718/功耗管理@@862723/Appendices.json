{"hands_on_practices": [{"introduction": "这个问题将我们的重点转移到一种系统级的优化技术：动态电压与频率调节 (Dynamic Voltage and Frequency Scaling, DVFS)。你的任务是通过在一系列处理器工作点之间进行策略性选择，在满足特定截止时间的前提下，最小化完成一项计算任务所需的总能耗。这个练习揭示了能量优化调度的核心原则，即如何在满足性能约束的前提下，通过在尽可能低的电压和频率下运行来换取显著的能耗降低([@problem_id:3667039])。", "problem": "一个单发射顺序执行核（in-order core）支持动态电压和频率缩放（DVFS），具有三个离散的工作点。DVFS 状态如下：\n- $\\left(V_{1}, f_{1}\\right) = \\left(0.7\\,\\text{V},\\,1.2\\,\\text{GHz}\\right)$，\n- $\\left(V_{2}, f_{2}\\right) = \\left(0.9\\,\\text{V},\\,1.8\\,\\text{GHz}\\right)$，\n- $\\left(V_{3}, f_{3}\\right) = \\left(1.1\\,\\text{V},\\,2.4\\,\\text{GHz}\\right)$。\n\n假设动态功耗由 $P_{\\text{dyn}}(V,f) = C_{\\text{eff}} V^{2} f$ 建模，其中有效开关电容 $C_{\\text{eff}} = 1.5 \\times 10^{-9}\\,\\text{F}$，漏电功耗由 $P_{\\text{leak}}(V) = k_{\\text{leak}} V$ 建模，其中 $k_{\\text{leak}} = 0.4\\,\\text{W/V}$。一个任务需要 $W = 3.0 \\times 10^{9}$ 个时钟周期，并且必须在 $D = 1.6\\,\\text{s}$ 的截止时间内完成。电压和频率的转换是瞬时完成的，产生的开销可以忽略不计。处理器必须在整个区间 $\\left[0, D\\right]$ 内持续主动执行任务，不能有空闲间隙；也就是说，它不能提前完成任务然后在截止时间前进入空闲状态。\n\n在区间 $\\left[0, D\\right]$ 内，您可以在三个 DVFS 状态之间任意进行时间共享。设 $t_{i}$ 表示在 $\\left[0, D\\right]$ 期间处于状态 $i$ 的总时间，且 $t_{i} \\ge 0$。可行性约束条件为 $\\sum_{i=1}^{3} t_{i} = D$ 和 $\\sum_{i=1}^{3} f_{i} t_{i} = W$。总能耗为\n$$\nE \\;=\\; \\int_{0}^{D} P(t)\\,dt \\;=\\; \\sum_{i=1}^{3} \\Big(P_{\\text{dyn}}(V_{i}, f_{i}) + P_{\\text{leak}}(V_{i})\\Big)\\, t_{i}.\n$$\n\n从给定的功耗模型和约束条件出发，确定在所有可行调度方案中可实现的最小能耗。最终能耗以焦耳（Joules）为单位表示，并将答案四舍五入至四位有效数字。", "solution": "首先验证问题，以确保其科学上成立、定义明确且客观。\n\n**步骤1：提取已知条件**\n- DVFS 状态 1： $(V_{1}, f_{1}) = (0.7\\,\\text{V},\\,1.2\\,\\text{GHz})$\n- DVFS 状态 2： $(V_{2}, f_{2}) = (0.9\\,\\text{V},\\,1.8\\,\\text{GHz})$\n- DVFS 状态 3： $(V_{3}, f_{3}) = (1.1\\,\\text{V},\\,2.4\\,\\text{GHz})$\n- 动态功耗模型： $P_{\\text{dyn}}(V,f) = C_{\\text{eff}} V^{2} f$\n- 有效开关电容： $C_{\\text{eff}} = 1.5 \\times 10^{-9}\\,\\text{F}$\n- 漏电功耗模型： $P_{\\text{leak}}(V) = k_{\\text{leak}} V$\n- 漏电系数： $k_{\\text{leak}} = 0.4\\,\\text{W/V}$\n- 工作负载： $W = 3.0 \\times 10^{9}$ 个时钟周期\n- 截止时间： $D = 1.6\\,\\text{s}$\n- 在状态 i 的时间： $t_{i}$，且 $t_{i} \\ge 0$\n- 约束条件： $\\sum_{i=1}^{3} t_{i} = D$ 和 $\\sum_{i=1}^{3} f_{i} t_{i} = W$\n- 能耗表达式： $E = \\sum_{i=1}^{3} \\Big(P_{\\text{dyn}}(V_{i}, f_{i}) + P_{\\text{leak}}(V_{i})\\Big)\\, t_{i}$\n\n**步骤2：验证**\n该问题是一个定义明确的约束优化问题。功耗模型是计算机体系结构中使用的标准简化表示。对于一个学术问题，所提供的值在物理上是合理的。约束条件是线性的，目标函数对于优化变量 $t_i$ 也是线性的。所需的平均频率为 $f_{\\text{avg}} = W/D = (3.0 \\times 10^9)/(1.6) = 1.875 \\times 10^9\\,\\text{Hz} = 1.875\\,\\text{GHz}$。由于此频率介于可用频率 $f_1=1.2\\,\\text{GHz}$ 和 $f_3=2.4\\,\\text{GHz}$ 之间，因此存在可行解。该问题是自洽的、科学上成立且定义明确的。\n\n**步骤3：结论**\n问题有效。\n\n**求解过程**\n目标是最小化总能耗 $E$，它是每个状态所用时间 $t_i$ 的线性函数：\n$$\nE(t_1, t_2, t_3) = P_1 t_1 + P_2 t_2 + P_3 t_3\n$$\n其中 $P_i$ 是状态 $i$ 的总功耗。最小化受以下线性约束条件的限制：\n$$\n\\begin{cases}\nt_1 + t_2 + t_3 = D \\\\\nf_1 t_1 + f_2 t_2 + f_3 t_3 = W \\\\\nt_1, t_2, t_3 \\ge 0\n\\end{cases}\n$$\n这个公式构成了一个线性规划问题。可行域是两个平面与非负卦限的交集，它形成一个线段。一个在紧凸集（例如线段）上的线性函数，其最小值在极点（线段的端点）处取得。可行线段的端点对应于其中一个 $t_i$ 变量为零的解。因此，最优解将涉及最多在两个 DVFS 状态之间进行时间共享。\n\n首先，我们使用公式 $P_i = C_{\\text{eff}} V_i^2 f_i + k_{\\text{leak}} V_i$ 计算每个状态 $i \\in \\{1, 2, 3\\}$ 的总功耗 $P_i$。\n对于状态 1： $(V_1, f_1) = (0.7\\,\\text{V}, 1.2\\,\\text{GHz})$\n$$P_1 = (1.5 \\times 10^{-9}\\,\\text{F}) (0.7\\,\\text{V})^2 (1.2 \\times 10^9\\,\\text{Hz}) + (0.4\\,\\text{W/V})(0.7\\,\\text{V})$$\n$$P_1 = (1.5 \\times 0.49 \\times 1.2)\\,\\text{W} + 0.28\\,\\text{W} = 0.882\\,\\text{W} + 0.28\\,\\text{W} = 1.162\\,\\text{W}$$\n\n对于状态 2： $(V_2, f_2) = (0.9\\,\\text{V}, 1.8\\,\\text{GHz})$\n$$P_2 = (1.5 \\times 10^{-9}\\,\\text{F}) (0.9\\,\\text{V})^2 (1.8 \\times 10^9\\,\\text{Hz}) + (0.4\\,\\text{W/V})(0.9\\,\\text{V})$$\n$$P_2 = (1.5 \\times 0.81 \\times 1.8)\\,\\text{W} + 0.36\\,\\text{W} = 2.187\\,\\text{W} + 0.36\\,\\text{W} = 2.547\\,\\text{W}$$\n\n对于状态 3： $(V_3, f_3) = (1.1\\,\\text{V}, 2.4\\,\\text{GHz})$\n$$P_3 = (1.5 \\times 10^{-9}\\,\\text{F}) (1.1\\,\\text{V})^2 (2.4 \\times 10^9\\,\\text{Hz}) + (0.4\\,\\text{W/V})(1.1\\,\\text{V})$$\n$$P_3 = (1.5 \\times 1.21 \\times 2.4)\\,\\text{W} + 0.44\\,\\text{W} = 4.356\\,\\text{W} + 0.44\\,\\text{W} = 4.796\\,\\text{W}$$\n\n我们在频率-功耗平面上得到三个工作点： $(1.2\\,\\text{GHz}, 1.162\\,\\text{W})$，$(1.8\\,\\text{GHz}, 2.547\\,\\text{W})$ 和 $(2.4\\,\\text{GHz}, 4.796\\,\\text{W})$。\n\n能耗最优调度原则指出，对于目标平均频率 $f_{\\text{avg}}$，应在位于所有工作点集合的下凸包上且满足 $f_i \\le f_{\\text{avg}} \\le f_j$ 的两个工作点 $(f_i, P_i)$ 和 $(f_j, P_j)$ 之间进行时间共享。\n为了确定下凸包，我们检查状态 2 的点 $(f_2, P_2)$ 是否位于连接状态 1 和状态 3 的线段下方。\n在频率 $f_2$ 处，连接 $(f_1, P_1)$ 和 $(f_3, P_3)$ 的直线上的功耗为：\n$$ P_{\\text{line}}(f_2) = P_1 + \\frac{P_3 - P_1}{f_3 - f_1}(f_2 - f_1) $$\n$$ P_{\\text{line}}(1.8) = 1.162 + \\frac{4.796 - 1.162}{2.4 - 1.2}(1.8 - 1.2) = 1.162 + \\frac{3.634}{1.2}(0.6) = 1.162 + 1.817 = 2.979\\,\\text{W} $$\n由于 $P_2 = 2.547\\,\\text{W}$ 小于 $P_{\\text{line}}(1.8) = 2.979\\,\\text{W}$，点 $(f_2, P_2)$ 位于该线段下方。因此，下凸包由连接状态 1 到状态 2，以及状态 2 到状态 3 的线段构成。\n\n所需的平均频率为 $f_{\\text{avg}} = W/D = (3.0 \\times 10^9) / 1.6 = 1.875\\,\\text{GHz}$。\n由于 $f_2 = 1.8\\,\\text{GHz}  f_{\\text{avg}}  f_3 = 2.4\\,\\text{GHz}$，能耗最优策略是仅在状态 2 和状态 3 之间进行时间共享。这意味着我们设置 $t_1=0$。\n\n约束条件简化为关于 $t_2$ 和 $t_3$ 的两个方程组：\n$$ t_2 + t_3 = 1.6 $$\n$$ (1.8 \\times 10^9) t_2 + (2.4 \\times 10^9) t_3 = 3.0 \\times 10^9 $$\n将第二个方程除以 $10^9$ 得：\n$$ 1.8 t_2 + 2.4 t_3 = 3.0 $$\n根据第一个方程，有 $t_3 = 1.6 - t_2$。将其代入第二个方程：\n$$ 1.8 t_2 + 2.4(1.6 - t_2) = 3.0 $$\n$$ 1.8 t_2 + 3.84 - 2.4 t_2 = 3.0 $$\n$$ -0.6 t_2 = 3.0 - 3.84 $$\n$$ -0.6 t_2 = -0.84 $$\n$$ t_2 = \\frac{0.84}{0.6} = 1.4\\,\\text{s} $$\n那么，在状态 3 的时间为：\n$$ t_3 = 1.6 - t_2 = 1.6 - 1.4 = 0.2\\,\\text{s} $$\n时间为 $t_1=0\\,\\text{s}$，$t_2=1.4\\,\\text{s}$ 和 $t_3=0.2\\,\\text{s}$，均为非负值。\n\n最后，我们使用这些最优时间计算最小总能耗：\n$$ E_{\\text{min}} = P_1 t_1 + P_2 t_2 + P_3 t_3 $$\n$$ E_{\\text{min}} = (1.162\\,\\text{W})(0\\,\\text{s}) + (2.547\\,\\text{W})(1.4\\,\\text{s}) + (4.796\\,\\text{W})(0.2\\,\\text{s}) $$\n$$ E_{\\text{min}} = 0 + 3.5658 + 0.9592 $$\n$$ E_{\\text{min}} = 4.525\\,\\text{J} $$\n问题要求答案四舍五入至四位有效数字。计算出的值 $4.525$ 已经有四位有效数字。", "answer": "$$\n\\boxed{4.525}\n$$", "id": "3667039"}, {"introduction": "现实世界的设计充满了权衡。本练习将让你扮演硬件设计者的角色，比较两种不同的时钟门控策略：细粒度（每个寄存器）与粗粒度（每个功能单元）。你需要为每种方法仔细建模并计算净功耗节省，不仅要考虑空闲组件节省的功耗，还要考虑控制逻辑本身带来的开销。这项实践强调了最优功耗管理策略是如何依赖于对工作负载活动和实现复杂度的详细分析的([@problem_id:3667037])。", "problem": "一个流水线整数核包含一个带有 $16$ 个架构寄存器的寄存器文件和一个两级算术逻辑单元 (ALU) 流水线。您需要比较两种用于动态功耗管理的互斥时钟门控策略：(i) 寄存器级门控（每个寄存器一个集成时钟门控 (ICG) 单元）和 (ii) 功能单元级门控（一个ICG单元门控ALU流水线触发器）。假设基准操作没有门控。您必须计算在混合工作负载下采用这两种策略之一所能节省的预期净动态功耗，然后选择更优的策略。\n\n使用以下工程模型、参数和工作负载描述。所有未给出的值都应视为未知数，不得假定。\n\n- 电源电压为 $1.0\\,\\text{V}$，时钟频率为 $1.2 \\times 10^{9}\\,\\text{Hz}$。\n- 寄存器文件由 $16$ 个寄存器组成。每个寄存器的有效时钟引脚电容（即，由本地时钟在叶节点为该寄存器存储元件驱动的电容）为每个寄存器 $0.15\\,\\text{pF}$。\n- ALU流水线的总时钟引脚电容（即，由ALU流水线本地时钟驱动的总电容）为 $3.6\\,\\text{pF}$。\n- 忽略由于时钟门控引起的ALU内部数据路径开关的任何变化；也就是说，将ALU激活时的内部数据路径开关视为不受门控影响，并在计算相对于基准的功耗节省时忽略它。\n- ICG单元：任何ICG的使能输入电容为 $0.001\\,\\text{pF}$。每个寄存器级ICG的时钟输入电容为 $0.005\\,\\text{pF}$，单个ALU级ICG的时钟输入电容为 $0.02\\,\\text{pF}$。无论使能状态如何，ICG的时钟输入都接收全局时钟，而ICG的使能输入在门控域激活时（ALU级）或特定寄存器被写入时（寄存器级）是一个单周期脉冲。\n- 工作负载模型：在任何周期内，有概率 $p$ 会有一条ALU指令写入一个目标寄存器；有概率 $1-p$ 没有ALU指令，也没有寄存器被写入。当ALU指令发生时，其目标寄存器在 $16$ 个寄存器中均匀分布。该工作负载由三种平稳活动模式组成，它们在长时间窗口内以指定的概率出现：模式 $\\mathcal{A}$，$p=0.25$（出现概率为 $0.5$），模式 $\\mathcal{B}$，$p=0.60$（出现概率为 $0.3$），以及模式 $\\mathcal{C}$，$p=0.10$（出现概率为 $0.2$）。\n\n控制复杂性和开销建模的工程假设：\n- 基准（无门控）：所有 $16$ 个寄存器时钟引脚和所有ALU流水线时钟引脚在每个周期都接收到开关时钟。\n- 寄存器级门控：在有ALU指令的周期中，只有一个寄存器的时钟被使能；在没有ALU指令的周期中，没有寄存器的时钟被使能。有 $16$ 个独立的使能信号（每个寄存器一个）。每个寄存器级ICG的时钟输入在每个周期都由全局时钟驱动。每个寄存器级的使能信号是一个单周期脉冲，其发生率等于该寄存器在给定周期内被选为目标寄存器的概率。\n- ALU级门控：在有ALU指令的周期中，ALU流水线时钟被使能；在没有ALU指令的周期中，它被禁用。有 $1$ 个使能信号（ALU活动译码）。ALU级ICG的时钟输入在每个周期都由全局时钟驱动。ALU级的使能信号是一个单周期脉冲，其发生率等于该周期包含ALU指令的概率。\n\n您必须执行以下任务，从动态功耗与开关活动、电容、电源电压和频率之间公认的定义开始：\n- 对于给定的活动分数 $p$，推导在寄存器级门控下相对于基准节省的净动态功耗，需考虑寄存器时钟引脚开关的减少以及由 $16$ 个ICG（包括其时钟输入和使能输入）带来的额外动态开销。\n- 对于给定的活动分数 $p$，推导在ALU级门控下相对于基准节省的净动态功耗，需考虑ALU流水线时钟引脚开关的减少以及由ALU ICG（包括其时钟输入和使能输入）带来的额外动态开销。\n- 使用三种活动模式及其概率，计算在混合工作负载下每种门控策略的预期净动态功耗节省，并选择更优的策略。\n- 为完整起见，为每种策略量化一个简单的控制复杂度指标：独立使能信号的数量以及由ICG引入的总附加时钟输入电容。您无需在最终数值答案中报告此指标。\n\n仅报告两种门控策略中更优策略所节省的预期净动态功耗，以 $\\text{mW}$ 为单位。将您的答案四舍五入到四位有效数字。", "solution": "分析始于CMOS电路动态功耗的基本方程，由下式给出：\n$$ P_{dyn} = \\alpha C V_{dd}^2 f $$\n其中 $\\alpha$ 是活动因子（每个时钟周期发生开关事件的概率），$C$ 是开关电容，$V_{dd}$ 是电源电压，$f$ 是时钟频率。问题要求计算净动态功耗节省，即门控一个组件所减少的功耗减去时钟门控控制逻辑（集成时钟门控单元，或ICG）所消耗的额外功耗。\n\n给定的参数如下：\n- 电源电压 $V_{dd} = 1.0\\,\\text{V}$\n- 时钟频率 $f = 1.2 \\times 10^{9}\\,\\text{Hz}$\n- 寄存器数量 $N_{reg} = 16$\n- 每个寄存器的时钟引脚电容 $C_{reg\\_clk} = 0.15\\,\\text{pF} = 0.15 \\times 10^{-12}\\,\\text{F}$\n- ALU流水线总时钟引脚电容 $C_{ALU\\_clk} = 3.6\\,\\text{pF} = 3.6 \\times 10^{-12}\\,\\text{F}$\n- ICG使能输入电容 $C_{en} = 0.001\\,\\text{pF} = 0.001 \\times 10^{-12}\\,\\text{F}$\n- 寄存器级ICG时钟输入电容 $C_{ICG\\_reg\\_in} = 0.005\\,\\text{pF} = 0.005 \\times 10^{-12}\\,\\text{F}$\n- ALU级ICG时钟输入电容 $C_{ICG\\_ALU\\_in} = 0.02\\,\\text{pF} = 0.02 \\times 10^{-12}\\,\\text{F}$\n- 在一个给定周期内有ALU指令的概率由 $p$ 表示。\n\n所有功耗计算的公共因子 $V_{dd}^2 f$ 为：\n$$ V_{dd}^2 f = (1.0\\,\\text{V})^2 \\times (1.2 \\times 10^9\\,\\text{Hz}) = 1.2 \\times 10^9\\,\\text{V}^2\\cdot\\text{Hz} $$\n\n### 策略 (i): 寄存器级门控\n\n在此策略中， $N_{reg} = 16$ 个寄存器中的每一个都由其自身的ICG进行门控。\n\n**功耗降低：**\n在基准情况下（无门控），所有 $16$ 个寄存器时钟引脚在每个周期都发生开关。总开关电容为 $N_{reg} C_{reg\\_clk}$。寄存器文件时钟输入的基准功耗为：\n$$ P_{base, RF} = (N_{reg} C_{reg\\_clk}) V_{dd}^2 f $$\n采用门控后，寄存器的时钟仅当其作为指令的目标时才被使能。由于目标寄存器是均匀分布的，每个寄存器 $i$ 的活动因子为 $\\alpha_i = p / N_{reg}$。门控后寄存器时钟引脚的总功耗是每个寄存器功耗的总和：\n$$ P_{gated, RF} = \\sum_{i=1}^{N_{reg}} \\left( \\frac{p}{N_{reg}} C_{reg\\_clk} V_{dd}^2 f \\right) = N_{reg} \\left( \\frac{p}{N_{reg}} C_{reg\\_clk} V_{dd}^2 f \\right) = p C_{reg\\_clk} V_{dd}^2 f $$\n寄存器时钟引脚上的功耗降低是基准功耗与门控后功耗之差：\n$$ \\Delta P_{RF,saved} = P_{base, RF} - P_{gated, RF} = (N_{reg} C_{reg\\_clk} - p C_{reg\\_clk}) V_{dd}^2 f = (16-p) C_{reg\\_clk} V_{dd}^2 f $$\n\n**开销功耗：**\n开销来自 $N_{reg} = 16$ 个ICG。\n1.  **ICG时钟输入：** 所有 $16$ 个ICG的时钟输入始终由全局时钟驱动，因此它们的活动因子为 $\\alpha=1$。这些输入产生的总开销功耗为：\n    $$ P_{overhead, clk} = (N_{reg} C_{ICG\\_reg\\_in}) V_{dd}^2 f $$\n2.  **ICG使能输入：** 有 $16$ 个使能信号。在每个有ALU指令的周期（概率为 $p$），恰好有一个使能信号产生脉冲。特定使能信号 $i$ 的活动因子为 $p/N_{reg}$。所有 $16$ 个使能输入端的总功耗为：\n    $$ P_{overhead, en} = \\sum_{i=1}^{N_{reg}} \\left( \\frac{p}{N_{reg}} C_{en} V_{dd}^2 f \\right) = p C_{en} V_{dd}^2 f $$\n总开销功耗为 $P_{overhead, reg} = P_{overhead, clk} + P_{overhead, en}$。\n\n**净功耗节省（寄存器级）：**\n净功耗节省是功耗降低减去开销：\n$$ \\Delta P_{saved, reg}(p) = \\Delta P_{RF,saved} - P_{overhead, reg} $$\n$$ \\Delta P_{saved, reg}(p) = (16 C_{reg\\_clk} - p C_{reg\\_clk}) V_{dd}^2 f - (16 C_{ICG\\_reg\\_in} V_{dd}^2 f + p C_{en} V_{dd}^2 f) $$\n$$ \\Delta P_{saved, reg}(p) = \\left[ (16 C_{reg\\_clk} - 16 C_{ICG\\_reg\\_in}) - p(C_{reg\\_clk} + C_{en}) \\right] V_{dd}^2 f $$\n\n### 策略 (ii): ALU级门控\n\n在此策略中，单个ICG对整个ALU流水线的时钟进行门控。\n\n**功耗降低：**\n被门控的组件是ALU流水线的时钟输入，其总电容为 $C_{ALU\\_clk}$。在基准情况下，它在每个周期都发生开关（$\\alpha=1$）。采用门控后，它仅在有ALU指令时才发生开关，因此活动因子为 $p$。功耗降低为：\n$$ \\Delta P_{ALU,saved} = (1-p) C_{ALU\\_clk} V_{dd}^2 f $$\n\n**开销功耗：**\n开销来自单个ICG。\n1.  **ICG时钟输入：** 时钟输入始终是活动的（$\\alpha=1$）。\n    $$ P_{overhead, clk} = C_{ICG\\_ALU\\_in} V_{dd}^2 f $$\n2.  **ICG使能输入：** 当ALU指令发生时（概率为 $p$），使能信号产生脉冲。\n    $$ P_{overhead, en} = p C_{en} V_{dd}^2 f $$\n总开销功耗为 $P_{overhead, ALU} = P_{overhead, clk} + P_{overhead, en}$。\n\n**净功耗节省（ALU级）：**\n$$ \\Delta P_{saved, ALU}(p) = \\Delta P_{ALU,saved} - P_{overhead, ALU} $$\n$$ \\Delta P_{saved, ALU}(p) = (1-p) C_{ALU\\_clk} V_{dd}^2 f - (C_{ICG\\_ALU\\_in} V_{dd}^2 f + p C_{en} V_{dd}^2 f) $$\n$$ \\Delta P_{saved, ALU}(p) = \\left[ (C_{ALU\\_clk} - C_{ICG\\_ALU\\_in}) - p(C_{ALU\\_clk} + C_{en}) \\right] V_{dd}^2 f $$\n\n### 混合工作负载下的预期功耗节省\n\n工作负载由三种模式（$\\mathcal{A}$、$\\mathcal{B}$、$\\mathcal{C}$）组成，其活动分数分别为 $p_A=0.25$、$p_B=0.60$、$p_C=0.10$，对应的出现概率为 $P(\\mathcal{A})=0.5$、$P(\\mathcal{B})=0.3$、$P(\\mathcal{C})=0.2$。预期活动因子 $E[p]$ 是加权平均值：\n$$ E[p] = p_A P(\\mathcal{A}) + p_B P(\\mathcal{B}) + p_C P(\\mathcal{C}) $$\n$$ E[p] = (0.25)(0.5) + (0.60)(0.3) + (0.10)(0.2) = 0.125 + 0.180 + 0.020 = 0.325 $$\n由于净功耗节省函数 $\\Delta P_{saved, reg}(p)$ 和 $\\Delta P_{saved, ALU}(p)$ 都是关于 $p$ 的线性函数，因此可以通过在 $p = E[p]$ 处求值来找到每种策略的预期功耗节省。\n\n**寄存器级门控的预期节省：**\n我们在推导出的公式中使用 $p = E[p] = 0.325$。总开关电容减少项为：\n$$ \\Delta C_{reg} = (16 C_{reg\\_clk} - 16 C_{ICG\\_reg\\_in}) - E[p](C_{reg\\_clk} + C_{en}) $$\n$$ \\Delta C_{reg} = (16 \\times 0.15 - 16 \\times 0.005) - 0.325 \\times (0.15 + 0.001) $$\n$$ \\Delta C_{reg} = (2.4 - 0.08) - 0.325 \\times 0.151 = 2.32 - 0.049075 = 2.270925\\,\\text{pF} $$\n预期的净功耗节省为：\n$$ E[\\Delta P_{saved, reg}] = (2.270925 \\times 10^{-12}\\,\\text{F}) \\times (1.2 \\times 10^9\\,\\text{V}^2\\cdot\\text{Hz}) $$\n$$ E[\\Delta P_{saved, reg}] = 2.72511 \\times 10^{-3}\\,\\text{W} = 2.72511\\,\\text{mW} $$\n\n**ALU级门控的预期节省：**\n我们在推导出的公式中使用 $p = E[p] = 0.325$。总开关电容减少项为：\n$$ \\Delta C_{ALU} = (C_{ALU\\_clk} - C_{ICG\\_ALU\\_in}) - E[p](C_{ALU\\_clk} + C_{en}) $$\n$$ \\Delta C_{ALU} = (3.6 - 0.02) - 0.325 \\times (3.6 + 0.001) $$\n$$ \\Delta C_{ALU} = 3.58 - 0.325 \\times 3.601 = 3.58 - 1.170325 = 2.409675\\,\\text{pF} $$\n预期的净功耗节省为：\n$$ E[\\Delta P_{saved, ALU}] = (2.409675 \\times 10^{-12}\\,\\text{F}) \\times (1.2 \\times 10^9\\,\\text{V}^2\\cdot\\text{Hz}) $$\n$$ E[\\Delta P_{saved, ALU}] = 2.89161 \\times 10^{-3}\\,\\text{W} = 2.89161\\,\\text{mW} $$\n\n### 比较与选择\n\n比较预期的净功耗节省：\n- 寄存器级门控：$E[\\Delta P_{saved, reg}] \\approx 2.725\\,\\text{mW}$\n- ALU级门控：$E[\\Delta P_{saved, ALU}] \\approx 2.892\\,\\text{mW}$\n\n由于 $2.892\\,\\text{mW} > 2.725\\,\\text{mW}$，ALU级门控策略更优，因为它提供了更大的净功耗节省。问题要求给出更优策略的节省量，并四舍五入到四位有效数字。\n$2.89161\\,\\text{mW} \\approx 2.892\\,\\text{mW}$。\n\n### 控制复杂度指标\n\n为完整起见，我们量化每种策略的控制复杂度。\n- **寄存器级门控：** 此策略需要 $N_{reg} = 16$ 个独立的使能信号。由ICG引入的总附加时钟输入电容为 $16 \\times C_{ICG\\_reg\\_in} = 16 \\times 0.005\\,\\text{pF} = 0.08\\,\\text{pF}$。\n- **ALU级门控：** 此策略仅需要 $1$ 个使能信号。总附加时钟输入电容为 $1 \\times C_{ICG\\_ALU\\_in} = 0.02\\,\\text{pF}$。\n对于此特定问题，ALU级门控方案不仅在功耗上更高效，而且从控制和时钟负载的角度来看也显著更简单。\n\n最终答案是更优策略（即ALU级门控）所节省的净动态功耗。", "answer": "$$\\boxed{2.892}$$", "id": "3667037"}]}