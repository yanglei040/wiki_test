{"hands_on_practices": [{"introduction": "皮尔逊相关系数是衡量依赖关系的常用工具，但它仅能捕捉线性关系。本练习将探讨一个典型案例：两个变量完全相关，但它们的相关系数却为零。这个思想实验旨在揭示传统相关性度量的局限性，并强调为何我们需要像copula这样更强大的工具来描述复杂的非单调依赖结构。[@problem_id:1353856]", "problem": "一个随机变量 $X$ 服从区间 $[-1, 1]$ 上的连续均匀分布。第二个随机变量 $Y$ 由关系式 $Y = X^2$ 定义。你的任务是分析 $X$ 和 $Y$ 之间的依赖关系。\n\n1. 计算 Pearson 相关系数 $\\rho(X, Y)$。\n2. 变量 $X$ 和 $Y$ 是完全依赖的，但它们的 Pearson 相关系数可能无法完全捕捉这种关系。完整的依赖结构由它们的 copula 描述。确定以下哪个描述最好地刻画了连接 $X$ 和 $Y$ 的 copula。\n\nA. 该 copula 表示完全正单调依赖，其支撑集在单位正方形的主对角线上。\n\nB. 该 copula 表示完全负单调依赖，其支撑集在单位正方形的反对角线上。\n\nC. 该 copula 是独立 copula，其概率质量均匀分布在整个单位正方形上。\n\nD. 该 copula 表示非单调依赖，其支撑集集中在单位正方形内的一条 V 形曲线上。\n\n请以数对形式提供你的答案，该数对由相关系数的数值和正确选项对应的字母组成。", "solution": "设 $X$ 在 $[-1,1]$ 上均匀分布，因此其密度为 $f_{X}(x)=\\frac{1}{2}$，对于 $x\\in[-1,1]$。定义 $Y=X^{2}$。Pearson 相关系数为 $\\rho(X,Y)=\\frac{\\operatorname{Cov}(X,Y)}{\\sqrt{\\operatorname{Var}(X)\\operatorname{Var}(Y)}}$。\n\n首先计算必要的矩。由于 $X$ 关于 $0$ 对称，\n$$\n\\mathbb{E}[X]=\\int_{-1}^{1}x\\cdot\\frac{1}{2}\\,dx=\\frac{1}{2}\\left[\\frac{x^{2}}{2}\\right]_{-1}^{1}=0.\n$$\n另外，\n$$\n\\mathbb{E}[X^{2}]=\\int_{-1}^{1}x^{2}\\cdot\\frac{1}{2}\\,dx=\\frac{1}{2}\\left[\\frac{x^{3}}{3}\\right]_{-1}^{1}=\\frac{1}{2}\\left(\\frac{1}{3}-\\left(-\\frac{1}{3}\\right)\\right)=\\frac{1}{3},\n$$\n所以 $\\mathbb{E}[Y]=\\mathbb{E}[X^{2}]=\\frac{1}{3}$。接下来，\n$$\n\\mathbb{E}[X^{3}]=\\int_{-1}^{1}x^{3}\\cdot\\frac{1}{2}\\,dx=\\frac{1}{2}\\left[\\frac{x^{4}}{4}\\right]_{-1}^{1}=\\frac{1}{2}\\left(\\frac{1}{4}-\\frac{1}{4}\\right)=0,\n$$\n因此 $\\mathbb{E}[XY]=\\mathbb{E}[X^{3}]=0$。所以，\n$$\n\\operatorname{Cov}(X,Y)=\\mathbb{E}[XY]-\\mathbb{E}[X]\\mathbb{E}[Y]=0-0\\cdot\\frac{1}{3}=0.\n$$\n为了完整起见，计算方差以确认分母为正。我们有\n$$\n\\operatorname{Var}(X)=\\mathbb{E}[X^{2}]-(\\mathbb{E}[X])^{2}=\\frac{1}{3},\n$$\n并且\n$$\n\\mathbb{E}[Y^{2}]=\\mathbb{E}[X^{4}]=\\int_{-1}^{1}x^{4}\\cdot\\frac{1}{2}\\,dx=\\frac{1}{2}\\left[\\frac{x^{5}}{5}\\right]_{-1}^{1}=\\frac{1}{2}\\left(\\frac{1}{5}-\\left(-\\frac{1}{5}\\right)\\right)=\\frac{1}{5},\n$$\n所以\n$$\n\\operatorname{Var}(Y)=\\mathbb{E}[Y^{2}]-(\\mathbb{E}[Y])^{2}=\\frac{1}{5}-\\left(\\frac{1}{3}\\right)^{2}=\\frac{1}{5}-\\frac{1}{9}=\\frac{4}{45}>0.\n$$\n因此，\n$$\n\\rho(X,Y)=\\frac{0}{\\sqrt{\\frac{1}{3}\\cdot\\frac{4}{45}}}=0.\n$$\n\n尽管 $Y$ 是 $X$ 的一个确定性函数，并且它们是完全依赖的，但这种依赖关系在 $[-1,1]$ 上是非单调的，所以 Pearson 相关系数为零。为了确定 copula，我们考虑概率积分变换 $U=F_{X}(X)$ 和 $V=F_{Y}(Y)$。对于 $x\\in[-1,1]$，\n$$\nF_{X}(x)=\\frac{x+1}{2},\\quad\\text{所以}\\quad U=\\frac{X+1}{2}.\n$$\n对于 $y\\in[0,1]$，\n$$\nF_{Y}(y)=\\mathbb{P}(X^{2}\\le y)=\\mathbb{P}(-\\sqrt{y}\\le X\\le \\sqrt{y})=\\int_{-\\sqrt{y}}^{\\sqrt{y}}\\frac{1}{2}\\,dx=\\sqrt{y},\n$$\n因此\n$$\nV=F_{Y}(Y)=\\sqrt{Y}=\\sqrt{X^{2}}=|X|.\n$$\n用 $U$ 表示 $X$ 得到 $X=2U-1$，所以这两个均匀分布变量之间的关系是\n$$\nV=|2U-1|.\n$$\n因此，该 copula 是奇异的，其支撑集集中在单位正方形内的 V 形曲线 $v=|2u-1|$ 上。这是一种非单调依赖，并对应于选项 D。", "answer": "$$\\boxed{\\begin{pmatrix} 0  D \\end{pmatrix}}$$", "id": "1353856"}, {"introduction": "将copula应用于真实数据的基石，是将不同变量转换到统一的尺度——单位方格 $[0, 1] \\times [0, 1]$ 上。本练习将带你亲手实践这一关键步骤，通过排序将原始数据转换为“伪观测值”。这个过程将变量的边缘分布信息剥离，从而让我们能专注于分析其纯粹的依赖结构。[@problem_id:1353883]", "problem": "一位金融分析师正在研究两支科技股“Innovate Inc.”（股票X）和“Quantum Corp.”（股票Y）每日收盘价之间的依赖关系。该分析师收集了连续六个交易日的价格，如下所示：\n\n- 第1天：（股票X：102美元，股票Y：55美元）\n- 第2天：（股票X：105美元，股票Y：53美元）\n- 第3天：（股票X：101美元，股票Y：58美元）\n- 第4天：（股票X：108美元，股票Y：60美元）\n- 第5天：（股票X：105美元，股票Y：59美元）\n- 第6天：（股票X：104美元，股票Y：55美元）\n\n为了准备数据以进行非参数依赖性分析，分析师必须将这些原始数据转换为一组“归一化秩坐标”。这个变换将原始的二元观测值 $(X_i, Y_i)$ 映射到单位正方形 $[0, 1] \\times [0, 1]$ 上的新坐标集 $(u_i, v_i)$。\n\n对于一个大小为 $n$ 的数据集，变换规则如下：对于集合 $\\{X_1, \\dots, X_n\\}$ 中的每个观测值 $X_i$，其变换后的坐标是 $u_i = \\frac{R(X_i)}{n+1}$，其中 $R(X_i)$ 是将集合按升序排列时 $X_i$ 的秩（从最小值的1到最大值的 $n$）。同样的规则也适用于 $Y$ 的观测值。如果出现数值相同的情况（即结），则分配给每个相同数值的秩是它们本应占据的秩的平均值。\n\n使用此程序，确定与第1天数据相对应的归一化秩坐标 $(u_1, v_1)$。请用一对精确分数表示你的答案。", "solution": "我们有 $n=6$ 个观测值。归一化秩变换定义为\n$$\nu_{i}=\\frac{R(X_{i})}{n+1}, \\qquad v_{i}=\\frac{R(Y_{i})}{n+1},\n$$\n其中 $R(\\cdot)$ 是升序排列的秩，对于相同的值，秩为其所占位置秩的平均值。\n\n对于 $X$：多重集为 $\\{102,105,101,108,105,104\\}$。升序排列为：$101,102,104,105,105,108$。相同的值 $105$ 占据了第4和第5个位置，因此每个值的秩为 $(4+5)/2=9/2$。因此，对于第1天的 $X_{1}=102$，$R(X_{1})$ 是 $2$。所以，\n$$\nu_{1}=\\frac{R(X_{1})}{7}=\\frac{2}{7}.\n$$\n\n对于 $Y$：多重集为 $\\{55,53,58,60,59,55\\}$。升序排列为：$53,55,55,58,59,60$。相同的值 $55$ 占据了第2和第3个位置，因此每个值的秩为 $(2+3)/2=5/2$。因此，对于第1天的 $Y_{1}=55$，$R(Y_{1})$ 是 $5/2$。所以，\n$$\nv_{1}=\\frac{R(Y_{1})}{7}=\\frac{5/2}{7}=\\frac{5}{14}.\n$$\n\n因此，第1天的归一化秩坐标为 $\\left(\\frac{2}{7},\\frac{5}{14}\\right)$。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{2}{7}  \\frac{5}{14}\\end{pmatrix}}$$", "id": "1353883"}, {"introduction": "依赖关系并非千篇一律；某些关系在极端事件中表现得尤为强烈。本练习要求你通过分析数据集的“尾部依赖性”来选择合适的copula模型。这是一项在风险建模（如金融危机或洪水）中至关重要的技能，因为在这些情境下，分布尾部的行为才是我们最关心的。[@problem_id:1353897]", "problem": "一位水文学家正在分析两条邻近河流（A河和B河）日流量之间的依赖关系。他们收集了一个庞大的成对测量数据集。作为copula建模中的一个标准程序，他们将每条河流流量的经验边际分布转换为标准的均匀随机变量，记为 $U_A$ 和 $U_B$。\n\n在检查转换后的数据对 $(U_A, U_B)$ 的散点图时，这位水文学家观察到依赖结构中存在明显的不对称性。具体来说，数据点在单位正方形的右上角（即当 $U_A$ 和 $U_B$ 都接近1时）显示出显著的聚集，这表明同时发生的大洪水事件是强相关的。相比之下，在左下角（即当 $U_A$ 和 $U_B$ 都接近0时）几乎没有聚集，这表明两条河流的极端低流量（干旱）时期的关联性不那么强。\n\n这位水文学家决定使用单参数的阿基米德copula来对这种依赖关系进行建模，并将选择范围缩小到两种常见的模型：Clayton copula和Gumbel copula。\n\n根据所描述的数据特征，以下哪个陈述正确地指出了更合适的copula及其适用原因？\n\nA. Clayton copula，因为它专门用于模拟联合分布上尾的强依赖性。\n\nB. Clayton copula，因为它专门用于模拟联合分布下尾的强依赖性。\n\nC. Gumbel copula，因为它专门用于模拟联合分布上尾的强依赖性。\n\nD. Gumbel copula，因为它专门用于模拟联合分布下尾的强依赖性。\n\nE. Clayton或Gumbel copula都同样合适，因为在相同的整体相关水平下，它们的尾部依赖性是相同的。", "solution": "这位水文学家已将流量转换为标准均匀变量 $U_{A}$ 和 $U_{B}$，并观察到当两个变量都接近 $1$ 时（右上角）有强聚集，而当两个变量都接近 $0$ 时（左下角）聚集非常弱。用copula的术语来说，这表明存在强的上尾依赖和弱的（近似为零）下尾依赖。\n\n尾部依赖性由以下系数来量化\n$$\n\\lambda_{U}=\\lim_{u\\to 1^{-}} \\mathbb{P}\\left(U_{B}>u \\mid U_{A}>u\\right)=\\lim_{u\\to 1^{-}} \\frac{1-2u+C(u,u)}{1-u},\n$$\n$$\n\\lambda_{L}=\\lim_{u\\to 0^{+}} \\mathbb{P}\\left(U_{B}\\leq u \\mid U_{A}\\leq u\\right)=\\lim_{u\\to 0^{+}} \\frac{C(u,u)}{u},\n$$\n其中 $C$ 是copula。\n\n对于候选的单参数阿基米德copula：\n- Clayton copula（参数 $\\theta>0$）具有下尾依赖性，但没有上尾依赖性：\n$$\n\\lambda_{L}=2^{-1/\\theta}>0,\\quad \\lambda_{U}=0.\n$$\n- Gumbel copula（参数 $\\theta\\geq 1$）具有上尾依赖性，但没有下尾依赖性：\n$$\n\\lambda_{U}=2-2^{1/\\theta}>0\\ \\text{for}\\ \\theta>1,\\quad \\lambda_{L}=0.\n$$\n\n由于数据显示出强的上尾依赖和弱的下尾依赖，因此合适的选择是Gumbel copula，其定义特征与观察到的不对称性相匹配。因此，正确的陈述是Gumbel copula是合适的，因为它旨在模拟上尾的强依赖性。", "answer": "$$\\boxed{C}$$", "id": "1353897"}]}