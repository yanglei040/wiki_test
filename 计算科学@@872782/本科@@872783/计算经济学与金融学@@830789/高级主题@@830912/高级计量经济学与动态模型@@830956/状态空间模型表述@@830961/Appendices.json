{"hands_on_practices": [{"introduction": "将理论经济模型转化为可供实证分析的状态空间形式，是计算经济学中的一项基本功。本练习将以一个标准的真实商业周期（RBC）模型为例，指导你如何将其线性化的动态解表示为一个状态空间系统。通过这个练习，你将亲手实践如何将宏观经济理论与时间序列分析方法相结合，为使用卡尔曼滤波等工具进行模型估计和分析奠定基础。[@problem_id:2433394]", "problem": "考虑一个标准的真实商业周期（RBC）模型，其中包含一个单一的外生技术过程。令 $z_t$ 表示技术对其稳态的对数偏差，该过程为一个平稳的一阶自回归过程。假设RBC模型的均衡条件已在确定性稳态附近进行了对数线性化，并求解出了将下一期资本和当前产出与当前状态变量联系起来的策略和度量关系。具体而言，设技术的运动规律由下式给出\n$$\nz_{t+1} = \\rho\\, z_t + \\sigma\\, \\varepsilon_{t+1},\n$$\n其中 $\\varepsilon_{t}$ 是独立同分布的，服从 $\\varepsilon_t \\sim \\mathcal{N}(0,1)$，并且线性化后的策略和产出关系为\n$$\nk_{t+1} = \\phi_k\\, k_t + \\phi_z\\, z_t, \\quad y_t = \\psi_k\\, k_t + \\psi_z\\, z_t,\n$$\n其中 $k_t$ 是资本对稳态的对数偏差，$y_t$ 是产出对稳态的对数偏差。假设所有变量都是协方差平稳的，并且参数满足唯一平稳解所需的稳定性条件。\n\n1. 从这些定义出发，构建一个以状态向量 $x_t = \\begin{pmatrix} k_t \\\\ z_t \\end{pmatrix}$ 和度量变量 $y_t$ 构成的最小线性高斯状态空间模型。请用 $\\phi_k$, $\\phi_z$, $\\rho$, $\\sigma$, $\\psi_k$ 和 $\\psi_z$ 明确写出状态转移矩阵、冲击加载矩阵和度量矩阵。\n\n2. 使用状态空间表示，通过求解关于 $x_t$ 的平稳状态协方差矩阵的离散时间李亚普诺夫方程，推导出 $y_t$ 的无条件方差关于模型参数的显式表达式。\n\n3. 对于参数值 $\\phi_k = 0.85$, $\\phi_z = 0.10$, $\\rho = 0.90$, $\\sigma = 0.02$, $\\psi_k = 0.30$ 和 $\\psi_z = 1.00$，数值计算 $y_t$ 的无条件方差。将你的答案四舍五入到四位有效数字。最终答案以纯数字形式表示（无单位）。", "solution": "问题陈述已经过解析和验证。这是一个计算宏观经济学中的标准、适定问题，没有科学或逻辑上的不一致。所有必需的定义和参数均已提供。我们可以直接进行求解。\n\n该问题需要分三部分解答：首先，构建线性状态空间模型；其次，推导度量变量的无条件方差；第三，对给定的一组参数，对该方差进行数值计算。\n\n第1部分：状态空间模型的构建\n\n线性高斯状态空间模型由一个状态转移方程和一个度量方程表示。\n状态转移方程的一般形式为 $x_{t+1} = A x_t + B w_{t+1}$，其中 $x_t$ 是状态向量，$A$ 是状态转移矩阵，$w_{t+1}$ 是均值为零、协方差矩阵为单位矩阵的独立同分布冲击向量，$B$ 是冲击加载矩阵。\n度量方程的一般形式为 $y_t = C x_t + D w_t$，其中 $y_t$ 是观测变量向量，$C$ 是度量矩阵。在本问题中，度量方程中没有同期冲击，因此 $D$ 是一个零矩阵。\n\n状态向量给定为 $x_t = \\begin{pmatrix} k_t \\\\ z_t \\end{pmatrix}$。冲击是一个标量，$w_{t+1} = \\varepsilon_{t+1}$，其中 $\\varepsilon_{t+1} \\sim \\mathcal{N}(0,1)$。\n\n我们通过组合给定的状态变量 $k_t$ 和 $z_t$ 的运动规律来构建状态转移方程：\n资本 $k_{t+1}$ 的运动规律给定为 $k_{t+1} = \\phi_k k_t + \\phi_z z_t$。\n技术 $z_{t+1}$ 的运动规律给定为 $z_{t+1} = \\rho z_t + \\sigma \\varepsilon_{t+1}$。\n\n我们可以将这两个方程写成矩阵形式：\n$$\n\\begin{pmatrix} k_{t+1} \\\\ z_{t+1} \\end{pmatrix} = \\begin{pmatrix} \\phi_k  \\phi_z \\\\ 0  \\rho \\end{pmatrix} \\begin{pmatrix} k_t \\\\ z_t \\end{pmatrix} + \\begin{pmatrix} 0 \\\\ \\sigma \\end{pmatrix} \\varepsilon_{t+1}\n$$\n由此，我们确定状态转移矩阵 $A$ 和冲击加载矩阵 $B$：\n$$\nA = \\begin{pmatrix} \\phi_k  \\phi_z \\\\ 0  \\rho \\end{pmatrix}, \\quad B = \\begin{pmatrix} 0 \\\\ \\sigma \\end{pmatrix}\n$$\n度量方程由产出表达式 $y_t = \\psi_k k_t + \\psi_z z_t$ 给出。其矩阵形式为：\n$$\ny_t = \\begin{pmatrix} \\psi_k  \\psi_z \\end{pmatrix} \\begin{pmatrix} k_t \\\\ z_t \\end{pmatrix}\n$$\n由此，我们确定度量矩阵 $C$：\n$$\nC = \\begin{pmatrix} \\psi_k  \\psi_z \\end{pmatrix}\n$$\n这样就完成了最小线性高斯状态空间模型的构建。\n\n第2部分：$y_t$ 的无条件方差推导\n\n$y_t$ 的无条件方差由状态向量的无条件协方差矩阵 $\\Gamma_x = \\mathbb{E}[x_t x_t']$ 推导得出。由于变量是与稳态的对数偏差，它们的无条件均值为零，因此 $\\Gamma_x$ 就是协方差矩阵。模型假定为平稳的，所以 $\\Gamma_x$ 不随时间变化。\n\n平稳状态协方差矩阵 $\\Gamma_x$ 是离散时间李亞普諾夫方程的解：\n$$\n\\Gamma_x = A \\Gamma_x A' + B Q B'\n$$\n其中 $Q = \\mathbb{E}[w_{t+1} w_{t+1}'] = \\mathbb{E}[\\varepsilon_{t+1}^2] = 1$。方程简化为 $\\Gamma_x = A \\Gamma_x A' + B B'$。\n\n设 $\\Gamma_x = \\begin{pmatrix} \\gamma_{kk}  \\gamma_{kz} \\\\ \\gamma_{zk}  \\gamma_{zz} \\end{pmatrix}$，其中 $\\gamma_{ij} = \\text{Cov}(i_t, j_t)$。根据对称性，$\\gamma_{kz} = \\gamma_{zk}$。我们有：\n$$\nB B' = \\begin{pmatrix} 0 \\\\ \\sigma \\end{pmatrix} \\begin{pmatrix} 0  \\sigma \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ 0  \\sigma^2 \\end{pmatrix}\n$$\n$$\nA \\Gamma_x A' = \\begin{pmatrix} \\phi_k  \\phi_z \\\\ 0  \\rho \\end{pmatrix} \\begin{pmatrix} \\gamma_{kk}  \\gamma_{kz} \\\\ \\gamma_{kz}  \\gamma_{zz} \\end{pmatrix} \\begin{pmatrix} \\phi_k  0 \\\\ \\phi_z  \\rho \\end{pmatrix} = \\begin{pmatrix} \\phi_k^2\\gamma_{kk} + 2\\phi_k\\phi_z\\gamma_{kz} + \\phi_z^2\\gamma_{zz}  \\rho(\\phi_k\\gamma_{kz} + \\phi_z\\gamma_{zz}) \\\\ \\rho(\\phi_k\\gamma_{kz} + \\phi_z\\gamma_{zz})  \\rho^2\\gamma_{zz} \\end{pmatrix}\n$$\n将这些代入李亚普诺夫方程，得到一个关于 $\\Gamma_x$ 的三个未知元素的方程组：\n1.  从 $(2,2)$ 元素得到：$\\gamma_{zz} = \\rho^2\\gamma_{zz} + \\sigma^2 \\implies \\gamma_{zz}(1-\\rho^2) = \\sigma^2$。这给出：\n    $$\n    \\gamma_{zz} = \\frac{\\sigma^2}{1-\\rho^2}\n    $$\n    这是一个平稳AR(1)过程的众所周知方差。\n2.  从 $(1,2)$ 元素得到：$\\gamma_{kz} = \\rho(\\phi_k\\gamma_{kz} + \\phi_z\\gamma_{zz}) \\implies \\gamma_{kz}(1-\\rho\\phi_k) = \\rho\\phi_z\\gamma_{zz}$。这给出：\n    $$\n    \\gamma_{kz} = \\frac{\\rho\\phi_z}{1-\\rho\\phi_k}\\gamma_{zz} = \\frac{\\rho\\phi_z\\sigma^2}{(1-\\rho\\phi_k)(1-\\rho^2)}\n    $$\n3.  从 $(1,1)$ 元素得到：$\\gamma_{kk} = \\phi_k^2\\gamma_{kk} + 2\\phi_k\\phi_z\\gamma_{kz} + \\phi_z^2\\gamma_{zz} \\implies \\gamma_{kk}(1-\\phi_k^2) = 2\\phi_k\\phi_z\\gamma_{kz} + \\phi_z^2\\gamma_{zz}$。这给出：\n    $$\n    \\gamma_{kk} = \\frac{2\\phi_k\\phi_z\\gamma_{kz} + \\phi_z^2\\gamma_{zz}}{1-\\phi_k^2}\n    $$\n$y_t$ 的无条件方差由 $\\text{Var}(y_t) = \\mathbb{E}[y_t^2] = \\mathbb{E}[(C x_t)(C x_t)'] = C \\mathbb{E}[x_t x_t'] C' = C \\Gamma_x C'$ 给出。\n$$\n\\text{Var}(y_t) = \\begin{pmatrix} \\psi_k  \\psi_z \\end{pmatrix} \\begin{pmatrix} \\gamma_{kk}  \\gamma_{kz} \\\\ \\gamma_{kz}  \\gamma_{zz} \\end{pmatrix} \\begin{pmatrix} \\psi_k \\\\ \\psi_z \\end{pmatrix} = \\psi_k^2\\gamma_{kk} + 2\\psi_k\\psi_z\\gamma_{kz} + \\psi_z^2\\gamma_{zz}\n$$\n这就是 $y_t$ 的无条件方差关于模型参数和状态协方差矩阵元素的显式表达式，而状态协方差矩阵的元素本身也已用基本模型参数表示。\n\n第3部分：数值计算\n\n给定的参数值为：$\\phi_k = 0.85$, $\\phi_z = 0.10$, $\\rho = 0.90$, $\\sigma = 0.02$, $\\psi_k = 0.30$ 和 $\\psi_z = 1.00$。我们接下来计算 $\\Gamma_x$ 的分量，然后计算 $\\text{Var}(y_t)$。\n\n1.  计算 $\\gamma_{zz}$：\n    $$\n    \\gamma_{zz} = \\frac{(0.02)^2}{1 - (0.90)^2} = \\frac{0.0004}{1 - 0.81} = \\frac{0.0004}{0.19} \\approx 0.00210526\n    $$\n2.  计算 $\\gamma_{kz}$：\n    $$\n    \\gamma_{kz} = \\frac{(0.90)(0.10)}{1 - (0.90)(0.85)} \\gamma_{zz} = \\frac{0.09}{1 - 0.765} \\gamma_{zz} = \\frac{0.09}{0.235} \\gamma_{zz} \\approx 0.3829787 \\times 0.00210526 \\approx 0.00080608\n    $$\n3.  计算 $\\gamma_{kk}$：\n    $$\n    \\gamma_{kk} = \\frac{2(0.85)(0.10)\\gamma_{kz} + (0.10)^2\\gamma_{zz}}{1 - (0.85)^2} = \\frac{0.17\\gamma_{kz} + 0.01\\gamma_{zz}}{1 - 0.7225} = \\frac{0.17\\gamma_{kz} + 0.01\\gamma_{zz}}{0.2775}\n    $$\n    代入中间值：\n    $$\n    \\gamma_{kk} \\approx \\frac{0.17(0.00080608) + 0.01(0.00210526)}{0.2775} = \\frac{0.00013703 + 0.00002105}{0.2775} = \\frac{0.00015808}{0.2775} \\approx 0.00056968\n    $$\n4.  计算 $\\text{Var}(y_t)$：\n    $$\n    \\text{Var}(y_t) = \\psi_k^2\\gamma_{kk} + 2\\psi_k\\psi_z\\gamma_{kz} + \\psi_z^2\\gamma_{zz}\n    $$\n    $$\n    = (0.30)^2\\gamma_{kk} + 2(0.30)(1.00)\\gamma_{kz} + (1.00)^2\\gamma_{zz}\n    $$\n    $$\n    = 0.09\\gamma_{kk} + 0.6\\gamma_{kz} + \\gamma_{zz}\n    $$\n    代入计算出的方差和协方差项：\n    $$\n    \\text{Var}(y_t) \\approx 0.09(0.00056968) + 0.6(0.00080608) + 0.00210526\n    $$\n    $$\n    \\approx 0.00005127 + 0.00048365 + 0.00210526 = 0.00264018\n    $$\n将最终结果四舍五入到四位有效数字，得到 $0.002640$。", "answer": "$$\n\\boxed{0.002640}\n$$", "id": "2433394"}, {"introduction": "在金融领域，许多时间序列（如股票价格）都是非平稳的，这给建模带来了挑战。本练习将探讨一种常见情况：当多个非平稳序列存在长期均衡关系（即协整）时，如何使用向量误差修正模型（VECM）来刻画它们的动态。你将学习如何将VECM转化为状态空间形式，这对于理解状态空间框架如何优雅地处理变量间的长期约束至关重要。[@problem_id:2433369]", "problem": "考虑两个对数股票价格 $p_{1,t}$ 和 $p_{2,t}$，它们是一阶单整的，并且以协整向量 $\\beta = \\begin{pmatrix}1 \\\\ -1\\end{pmatrix}$ 协整。令 $p_{t} = \\begin{pmatrix}p_{1,t} \\\\ p_{2,t}\\end{pmatrix}$，并假设它们的联合动态遵循一个向量误差修正模型 (VECM)，具体为\n$$\n\\Delta p_{t} = \\alpha\\, \\beta^{\\prime} p_{t-1} + \\varepsilon_{t},\n$$\n其中 $\\alpha = \\begin{pmatrix} a \\\\ b \\end{pmatrix}$，$a \\in \\mathbb{R}$ 且 $b \\in \\mathbb{R}$，而 $\\varepsilon_{t} = \\begin{pmatrix}\\varepsilon_{1,t} \\\\ \\varepsilon_{2,t}\\end{pmatrix}$ 是一个具有有限二阶矩的零均值、序列不相关的新息过程。定义协整关系为 $c_{t} = \\beta^{\\prime} p_{t} = p_{1,t} - p_{2,t}$。\n\n构建一个线性时不变状态空间表示，其状态向量为 $x_{t} = \\begin{pmatrix} p_{1,t} \\\\ p_{2,t} \\\\ c_{t} \\end{pmatrix}$，并带有一个返回价格向量且无测量噪声的观测方程。具体来说，写出状态转移矩阵 $F$、将 $\\varepsilon_{t}$ 映射到状态的输入（冲击载荷）矩阵 $G$，以及观测矩阵 $H$，使得\n$$\nx_{t} = F x_{t-1} + G \\varepsilon_{t}, \\quad y_{t} = H x_{t}, \\quad y_{t} = p_{t}.\n$$\n\n然后，计算状态转移矩阵 $F$ 的行列式，作为 $a$ 和 $b$ 的函数。请以单一闭式解析表达式的形式提供最终答案。不要四舍五入。", "solution": "此问题要求为给定的向量误差修正模型 (VECM) 构建一个线性时不变状态空间表示，并随后计算状态转移矩阵的行列式。\n\n首先，我们必须验证问题陈述的有效性。\n已知条件：\n1.  对数股票价格 $p_{1,t}$ 和 $p_{2,t}$，构成向量 $p_{t} = \\begin{pmatrix}p_{1,t} \\\\ p_{2,t}\\end{pmatrix}$。\n2.  价格是一阶单整 I($1$) 且协整的。\n3.  协整向量为 $\\beta = \\begin{pmatrix}1 \\\\ -1\\end{pmatrix}$。\n4.  动态由 VECM 描述：$\\Delta p_{t} = \\alpha\\, \\beta^{\\prime} p_{t-1} + \\varepsilon_{t}$，其中 $\\Delta p_t = p_t - p_{t-1}$。\n5.  调整向量为 $\\alpha = \\begin{pmatrix} a \\\\ b \\end{pmatrix}$，$a, b \\in \\mathbb{R}$。\n6.  $\\varepsilon_{t} = \\begin{pmatrix}\\varepsilon_{1,t} \\\\ \\varepsilon_{2,t}\\end{pmatrix}$ 是一个零均值、序列不相关的新息过程。\n7.  协整关系为 $c_{t} = \\beta^{\\prime} p_{t} = p_{1,t} - p_{2,t}$。\n8.  状态向量定义为 $x_{t} = \\begin{pmatrix} p_{1,t} \\\\ p_{2,t} \\\\ c_{t} \\end{pmatrix}$。\n9.  状态空间模型形式为 $x_{t} = F x_{t-1} + G \\varepsilon_{t}$ 和 $y_{t} = H x_{t}$。\n10. 输出为 $y_{t} = p_{t}$，无测量噪声。\n\n该问题具有科学依据，提法得当且客观。它基于标准的计量经济模型 (VECM) 及其状态空间形式的表示，提供了一个完整且一致的设定。状态向量的定义包含一个冗余状态（$c_t$ 是 $p_{1,t}$ 和 $p_{2,t}$ 的线性组合），但这是一个有效的建模选择，并不会引入矛盾。因此，该问题是有效的，可以推导出解。\n\n任务是找出矩阵 $F$、$G$、$H$，然后计算 $\\det(F)$。\n\n我们首先将状态向量 $x_t$ 的每个分量的动态表示为 $x_{t-1}$ 的分量和新息 $\\varepsilon_t$ 的函数。VECM 方程是起点：\n$$ p_t - p_{t-1} = \\alpha \\beta' p_{t-1} + \\varepsilon_t $$\n项 $\\beta' p_{t-1}$ 正是滞后的协整关系 $c_{t-1}$：\n$$ \\beta' p_{t-1} = \\begin{pmatrix} 1  -1 \\end{pmatrix} \\begin{pmatrix} p_{1,t-1} \\\\ p_{2,t-1} \\end{pmatrix} = p_{1,t-1} - p_{2,t-1} = c_{t-1} $$\n将此代入 VECM 得：\n$$ p_t - p_{t-1} = \\alpha c_{t-1} + \\varepsilon_t $$\n$$ p_t = p_{t-1} + \\alpha c_{t-1} + \\varepsilon_t $$\n让我们用单个价格分量来写出这个式子：\n$$ \\begin{pmatrix} p_{1,t} \\\\ p_{2,t} \\end{pmatrix} = \\begin{pmatrix} p_{1,t-1} \\\\ p_{2,t-1} \\end{pmatrix} + \\begin{pmatrix} a \\\\ b \\end{pmatrix} c_{t-1} + \\begin{pmatrix} \\varepsilon_{1,t} \\\\ \\varepsilon_{2,t} \\end{pmatrix} $$\n这就得出了我们状态空间模型的前两个标量方程：\n$$ p_{1,t} = p_{1,t-1} + a c_{t-1} + \\varepsilon_{1,t} $$\n$$ p_{2,t} = p_{2,t-1} + b c_{t-1} + \\varepsilon_{2,t} $$\n\n接下来，我们推导第三个状态变量 $c_t$ 的动态方程。根据定义，$c_t = p_{1,t} - p_{2,t}$。我们代入刚才找到的 $p_{1,t}$ 和 $p_{2,t}$ 的表达式：\n$$ c_t = (p_{1,t-1} + a c_{t-1} + \\varepsilon_{1,t}) - (p_{2,t-1} + b c_{t-1} + \\varepsilon_{2,t}) $$\n按滞后变量和新息对各项进行分组：\n$$ c_t = (p_{1,t-1} - p_{2,t-1}) + (a - b)c_{t-1} + (\\varepsilon_{1,t} - \\varepsilon_{2,t}) $$\n注意到 $p_{1,t-1} - p_{2,t-1} = c_{t-1}$，我们简化该表达式：\n$$ c_t = c_{t-1} + (a-b)c_{t-1} + (\\varepsilon_{1,t} - \\varepsilon_{2,t}) $$\n$$ c_t = (1 + a - b)c_{t-1} + \\varepsilon_{1,t} - \\varepsilon_{2,t} $$\n\n我们现在得到了所需的三个动态方程。我们可以将它们组合成状态转移方程 $x_t = F x_{t-1} + G \\varepsilon_t$：\n$$\n\\begin{pmatrix} p_{1,t} \\\\ p_{2,t} \\\\ c_t \\end{pmatrix}\n=\n\\begin{pmatrix}\n1 \\cdot p_{1,t-1} + 0 \\cdot p_{2,t-1} + a \\cdot c_{t-1} \\\\\n0 \\cdot p_{1,t-1} + 1 \\cdot p_{2,t-1} + b \\cdot c_{t-1} \\\\\n0 \\cdot p_{1,t-1} + 0 \\cdot p_{2,t-1} + (1+a-b) \\cdot c_{t-1}\n\\end{pmatrix}\n+\n\\begin{pmatrix}\n1 \\cdot \\varepsilon_{1,t} + 0 \\cdot \\varepsilon_{2,t} \\\\\n0 \\cdot \\varepsilon_{1,t} + 1 \\cdot \\varepsilon_{2,t} \\\\\n1 \\cdot \\varepsilon_{1,t} - 1 \\cdot \\varepsilon_{2,t}\n\\end{pmatrix}\n$$\n这可以写成矩阵形式：\n$$\n\\begin{pmatrix} p_{1,t} \\\\ p_{2,t} \\\\ c_t \\end{pmatrix} =\n\\begin{pmatrix} 1  0  a \\\\ 0  1  b \\\\ 0  0  1+a-b \\end{pmatrix}\n\\begin{pmatrix} p_{1,t-1} \\\\ p_{2,t-1} \\\\ c_{t-1} \\end{pmatrix} +\n\\begin{pmatrix} 1  0 \\\\ 0  1 \\\\ 1  -1 \\end{pmatrix}\n\\begin{pmatrix} \\varepsilon_{1,t} \\\\ \\varepsilon_{2,t} \\end{pmatrix}\n$$\n由此，我们确定状态转移矩阵 $F$ 和输入矩阵 $G$：\n$$ F = \\begin{pmatrix} 1  0  a \\\\ 0  1  b \\\\ 0  0  1+a-b \\end{pmatrix}, \\quad G = \\begin{pmatrix} 1  0 \\\\ 0  1 \\\\ 1  -1 \\end{pmatrix} $$\n对于观测方程 $y_t = H x_t$，我们有 $y_t = p_t = \\begin{pmatrix} p_{1,t} \\\\ p_{2,t} \\end{pmatrix}$。我们需要一个矩阵 $H$ 使得：\n$$ \\begin{pmatrix} p_{1,t} \\\\ p_{2,t} \\end{pmatrix} = H \\begin{pmatrix} p_{1,t} \\\\ p_{2,t} \\\\ c_t \\end{pmatrix} $$\n选择状态向量前两个分量的矩阵是：\n$$ H = \\begin{pmatrix} 1  0  0 \\\\ 0  1  0 \\end{pmatrix} $$\n问题要求计算状态转移矩阵 $F$ 的行列式。矩阵 $F$ 是一个上三角矩阵。任何三角矩阵的行列式都是其对角线元素的乘积。\n$$ \\det(F) = (1) \\cdot (1) \\cdot (1 + a - b) $$\n$$ \\det(F) = 1 + a - b $$\n这就是所要求的 $F$ 的行列式作为 $a$ 和 $b$ 的函数的闭式解析表达式。", "answer": "$$\\boxed{1 + a - b}$$", "id": "2433369"}]}