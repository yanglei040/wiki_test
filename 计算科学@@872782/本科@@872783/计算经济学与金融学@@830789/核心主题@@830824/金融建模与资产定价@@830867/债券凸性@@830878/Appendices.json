{"hands_on_practices": [{"introduction": "要真正掌握凸性的概念，没有什么比从第一性原理推导它更有效了。我们将从一个理想化的金融工具——永续债券（或称“统一公债”）开始，这种债券永远支付固定的票息。通过为这种债券推导凸性 [@problem_id:2376948]，我们可以在没有到期日复杂性的情况下，以最纯粹的形式揭示收益率和价格之间的二阶关系。", "problem": "考虑一种永续债券（也称为统一公债），它在每年年末永久支付金额为 $C$ 的固定息票。假设一个固定的年化到期收益率 $y$（按年复利），以小数形式表示（例如，$5\\%$ 表示为 $0.05$），并假设 $y>0$。令现值 $P(y)$ 根据基本现值原理定义为折现现金流的无穷级数和：\n$$\nP(y) \\equiv \\sum_{t=1}^{\\infty} \\frac{C}{(1+y)^{t}}.\n$$\n将相对于收益率的价格凸性定义为\n$$\n\\mathcal{C}(y) \\equiv \\frac{1}{P(y)} \\frac{d^{2} P(y)}{d y^{2}}.\n$$\n仅基于上述定义，推导 $\\mathcal{C}(y)$ 仅作为 $y$ 的函数的封闭形式表达式。然后，使用您推导的表达式，定性地讨论当 $y>0$ 时 $\\mathcal{C}(y)$ 的行为，并陈述其在 $y \\to 0^{+}$ 时的极限。您可以绘制一张您选择的区间 $y \\in (0, \\bar{y}]$ 上的 $\\mathcal{C}(y)$ 图像来支持您的讨论，但只有解析表达式将作为您的最终答案报告。\n\n答案规格：\n- 以仅包含 $y$ 的单个封闭形式解析表达式提供您的最终答案。\n- 无需四舍五入。\n- 最终答案中不包含任何单位。", "solution": "首先将对问题陈述进行严格的验证过程。\n\n步骤 1：提取已知条件\n- 一种永续债券在每年年末支付金额为 $C$ 的固定息票。\n- 到期收益率为固定的年化利率 $y$，且 $y > 0$。\n- 现值定义为无穷级数：\n$$\nP(y) \\equiv \\sum_{t=1}^{\\infty} \\frac{C}{(1+y)^{t}}\n$$\n- 相对于收益率的价格凸性定义为：\n$$\n\\mathcal{C}(y) \\equiv \\frac{1}{P(y)} \\frac{d^{2} P(y)}{d y^{2}}\n$$\n- 任务是推导 $\\mathcal{C}(y)$ 仅作为 $y$ 的函数的封闭形式表达式，并讨论其定性行为，包括其在 $y \\to 0^{+}$ 时的极限。\n\n步骤 2：验证\n该问题具有科学依据，因为它使用了金融数学中关于永续年金现值和债券凸性的标准、基本定义。这是一个适定的问题，提供了所有必要的定义和约束条件（$y>0$），以得出 $\\mathcal{C}(y)$ 的唯一且有意义的解。该问题是客观的，以清晰、明确的数学形式陈述。它不违反任何指定的无效标准。因此，该问题被视为有效。\n\n步骤 3：结论与行动\n问题有效。将推导解答。\n\n推导过程如下。首先，我们必须找到现值 $P(y)$ 的封闭形式表达式。所提供的 $P(y)$ 定义是一个几何级数：\n$$\nP(y) = \\sum_{t=1}^{\\infty} \\frac{C}{(1+y)^{t}} = C \\sum_{t=1}^{\\infty} \\left(\\frac{1}{1+y}\\right)^{t}\n$$\n这是一个首项为 $a = \\frac{1}{1+y}$、公比为 $r = \\frac{1}{1+y}$ 的几何级数。由于问题陈述 $y > 0$，因此 $1+y > 1$，所以 $0 < \\frac{1}{1+y} < 1$。因为公比的绝对值小于 $1$，所以级数收敛。无穷几何级数的和由 $\\frac{a}{1-r}$ 给出。\n应用此公式，我们得到：\n$$\n\\sum_{t=1}^{\\infty} \\left(\\frac{1}{1+y}\\right)^{t} = \\frac{\\frac{1}{1+y}}{1 - \\frac{1}{1+y}} = \\frac{\\frac{1}{1+y}}{\\frac{(1+y)-1}{1+y}} = \\frac{\\frac{1}{1+y}}{\\frac{y}{1+y}} = \\frac{1}{y}\n$$\n将此结果代入 $P(y)$ 的表达式，得到永续年金现值的封闭形式表达式：\n$$\nP(y) = C \\left(\\frac{1}{y}\\right) = \\frac{C}{y}\n$$\n接下来，我们必须计算 $P(y)$ 对 $y$ 的二阶导数。首先，我们求一阶导数 $\\frac{d P(y)}{d y}$：\n$$\n\\frac{d P(y)}{d y} = \\frac{d}{dy}\\left(C y^{-1}\\right) = C(-1)y^{-2} = -\\frac{C}{y^{2}}\n$$\n现在，我们再次求导以得到 $\\frac{d^{2} P(y)}{d y^{2}}$：\n$$\n\\frac{d^{2} P(y)}{d y^{2}} = \\frac{d}{dy}\\left(-\\frac{C}{y^{2}}\\right) = \\frac{d}{dy}\\left(-C y^{-2}\\right) = -C(-2)y^{-3} = \\frac{2C}{y^{3}}\n$$\n我们现在将 $P(y)$ 和 $\\frac{d^{2} P(y)}{d y^{2}}$ 的表达式代入凸性 $\\mathcal{C}(y)$ 的定义中：\n$$\n\\mathcal{C}(y) = \\frac{1}{P(y)} \\frac{d^{2} P(y)}{d y^{2}} = \\frac{1}{\\frac{C}{y}} \\left(\\frac{2C}{y^{3}}\\right)\n$$\n简化此表达式，我们观察到息票金额 $C$ 被消掉了，这正如预期，因为凸性是与现金流结构和收益率相关的内在属性，而不是与息票的大小相关：\n$$\n\\mathcal{C}(y) = \\frac{y}{C} \\cdot \\frac{2C}{y^{3}} = \\frac{2y}{y^{3}} = \\frac{2}{y^{2}}\n$$\n这就是所求的永续债券凸性作为收益率 $y$ 函数的封闭形式表达式。\n\n对于定性讨论，我们分析当 $y > 0$ 时函数 $\\mathcal{C}(y) = \\frac{2}{y^{2}}$ 的行为。\n1.  由于 $y > 0$，项 $y^{2}$ 严格为正。因此，$\\mathcal{C}(y) = \\frac{2}{y^{2}}$ 始终为正。这与常规债券（如这种永续债券）具有正凸性的事实相符，意味着其价格-收益率曲线是凸向原点的。\n2.  随着收益率 $y$ 的增加，分母 $y^{2}$ 增加，导致 $\\mathcal{C}(y)$ 的值减小。这种反比关系表明，债券的凸性在较高收益率水平下减弱。随着 $y$ 的增长，价格-收益率曲线变得更平坦，或曲率更小。\n3.  我们被要求求出当 $y \\to 0^{+}$ 时 $\\mathcal{C}(y)$ 的极限。\n$$\n\\lim_{y \\to 0^{+}} \\mathcal{C}(y) = \\lim_{y \\to 0^{+}} \\frac{2}{y^{2}}\n$$\n当 $y$ 从正方向趋近于 $0$ 时，$y^{2}$ 也从正方向趋近于 $0$。因此，该分数无界增长。\n$$\n\\lim_{y \\to 0^{+}} \\frac{2}{y^{2}} = +\\infty\n$$\n这一结果意味着，对于非常低的收益率，债券表现出极高的凸性。价格-收益率关系变得高度非线性，仅基于久期（一阶导数）的价格近似变得非常不准确。由凸性捕捉的二阶效应在这种情况下占主导地位。", "answer": "$$\n\\boxed{\\frac{2}{y^2}}\n$$", "id": "2376948"}, {"introduction": "在了解了永续债券的理论基础后，我们现在转向具有固定到期日的更现实的债券。一个关键的问题是：债券的现金流结构如何影响其凸性？这个练习将通过比较零息债券和附息债券 [@problem_id:2376960]，直观地展示现金流的时间分布是决定债券价格对收益率变化敏感性的关键因素。", "problem": "一种无违约风险、按年计息的零息债券，面值为 $1$，期限为 $T = 5$ 年，其定价基于 $y = 5\\%$ 的统一年度到期收益率（YTM）。将债券相对于年度YTM的凸性定义为 $C(y) \\equiv \\dfrac{1}{P(y)} \\dfrac{d^{2}P(y)}{dy^{2}}$，其中 $P(y)$ 是债券价格作为 $y$ 的函数。再考虑一种无违约风险、每年付息的附息债券，其面值同样为 $1$，期限同样为 $T = 5$ 年，年票面利率为 $5\\%$，也基于相同的统一年度到期收益率 $y = 5\\%$ 进行定价。\n\n哪个选项正确报告了零息债券在 $y = 5\\%$ 时的凸性（四舍五入到两位小数），并提供了正确的解释，说明为什么其凸性高于同期限的附息债券？\n\nA. $27.21$；因为零息债券的所有现金流都发生在最终日期 $t = T$，曲率权重 $t(t+1)$ 完全作用于最大的 $t$ 值；而票息支付将权重转移到更早、更小的 $t$ 值，从而在给定价格下降低了附息债券的凸性。\n\nB. $23.94$；因为较早的票息支付对利率产生了更高的敏感性，所以附息债券的凸性超过了零息债券。\n\nC. $27.21$；因为零息债券的久期低于其他方面相同的附息债券，所以其凸性必须更高。\n\nD. $30.00$；因为零息债券的凸性等于 $T(T+1)$，与收益率水平无关。", "solution": "首先必须验证问题陈述的科学性和逻辑完整性。\n\n**步骤1：提取已知条件**\n\n- **债券1（零息债券）：**\n  - 类型：无违约风险、按年计息的零息债券。\n  - 面值：$F = 1$。\n  - 期限：$T = 5$ 年。\n  - 到期收益率（YTM）：统一年度利率，$y = 5\\% = 0.05$。\n\n- **债券2（附息债券）：**\n  - 类型：无违约风险、每年付息的附息债券。\n  - 面值：$F = 1$。\n  - 期限：$T = 5$ 年。\n  - 年票面利率：$c = 5\\% = 0.05$。\n  - 到期收益率（YTM）：统一年度利率，$y = 5\\% = 0.05$。\n\n- **凸性的定义：**\n  - $C(y) \\equiv \\dfrac{1}{P(y)} \\dfrac{d^{2}P(y)}{dy^{2}}$，其中 $P(y)$ 是债券价格作为年度YTM $y$ 的函数。\n\n**步骤2：使用提取的已知条件进行验证**\n\n对问题进行严格验证。\n1.  **科学依据：** 债券定价、到期收益率（YTM）和债券凸性的概念是金融数学中基础且公认的原则。其定义和关系都是标准的。该问题在科学上是合理的。\n2.  **问题定义明确：** 问题提供了所有必要的参数（$F$, $T$, $y$, $c$）和凸性的精确定义，足以计算出零息债券的唯一数值答案，并与附息债券进行定性比较。\n3.  **客观性：** 问题以客观、定量的术语陈述，没有主观或含糊不清的语言。\n4.  **完整且一致：** 所提供的信息是充分的，没有内部矛盾。“按年计息的零息债券”一词被理解为YTM是按年复利计算的，这与“年度YTM”的上下文是一致的。\n\n**步骤3：结论与行动**\n\n问题陈述有效。可以推导出严谨的解法。\n\n**解题推导**\n\n首先，我们计算零息债券的凸性。面值为 $F=1$、期限为 $T=5$ 的零息债券的价格 $P(y)$ 由其在到期时的单一现金流的现值给出：\n$$P(y) = \\dfrac{1}{(1+y)^T} = (1+y)^{-T}$$\n给定 $T=5$，价格函数为：\n$$P(y) = (1+y)^{-5}$$\n\n为了求凸性，我们必须计算价格函数相对于收益率 $y$ 的一阶和二阶导数。\n一阶导数为：\n$$\\dfrac{dP(y)}{dy} = -5(1+y)^{-6}$$\n二阶导数为：\n$$\\dfrac{d^{2}P(y)}{dy^{2}} = (-5)(-6)(1+y)^{-7} = 30(1+y)^{-7}$$\n\n使用给定的凸性定义，$C(y) = \\dfrac{1}{P(y)} \\dfrac{d^{2}P(y)}{dy^{2}}$：\n$$C(y) = \\dfrac{1}{(1+y)^{-5}} \\left[ 30(1+y)^{-7} \\right] = 30(1+y)^{-2}$$\n或者，对于零息债券，凸性的一般公式为：\n$$C(y) = \\dfrac{T(T+1)}{(1+y)^2}$$\n代入 $T=5$：\n$$C(y) = \\dfrac{5(5+1)}{(1+y)^2} = \\dfrac{30}{(1+y)^2}$$\n这证实了我们推导的表达式。现在我们在给定的收益率 $y = 0.05$ 下计算其值：\n$$C(0.05) = \\dfrac{30}{(1+0.05)^2} = \\dfrac{30}{(1.05)^2} = \\dfrac{30}{1.1025} \\approx 27.21088...$$\n四舍五入到两位小数，零息债券的凸性为 $27.21$。\n\n接下来，我们必须解释为什么这个凸性高于附息债券的凸性。一般债券的价格是其现金流 $CF_t$ 的现值之和：\n$$P(y) = \\sum_{t=1}^{T} \\dfrac{CF_t}{(1+y)^t}$$\n二阶导数为：\n$$\\dfrac{d^2P(y)}{dy^2} = \\sum_{t=1}^{T} CF_t \\cdot t(t+1)(1+y)^{-(t+2)}$$\n那么凸性为：\n$$C(y) = \\dfrac{1}{P(y)} \\sum_{t=1}^{T} \\dfrac{CF_t \\cdot t(t+1)}{(1+y)^{t+2}} = \\dfrac{1}{(1+y)^2} \\sum_{t=1}^{T} \\left[ \\dfrac{CF_t / (1+y)^t}{P(y)} \\right] t(t+1)$$\n令 $w_t = \\dfrac{PV(CF_t)}{P(y)}$ 为时间 $t$ 的现金流相对于总价格的权重。这些权重之和为1，即 $\\sum w_t = 1$。凸性表达式变成一个加权平均值：\n$$C(y) = \\dfrac{1}{(1+y)^2} \\sum_{t=1}^{T} w_t \\cdot t(t+1)$$\n对于零息债券，仅在 $t=T=5$ 时有一次现金流。因此，$w_5=1$ 且所有其他权重 $w_{t5}=0$。求和简化为单项：\n$$C_{zero}(y) = \\dfrac{1}{(1+y)^2} \\cdot [1 \\cdot T(T+1)] = \\dfrac{T(T+1)}{(1+y)^2} = \\dfrac{30}{(1+y)^2}$$\n对于附息债券，在时间 $t=1, 2, 3, 4, 5$ 都有现金流。因此，$w_1, w_2, w_3, w_4, w_5$ 均为正数。其凸性为：\n$$C_{coupon}(y) = \\dfrac{1}{(1+y)^2} \\left[ w_1(1\\cdot2) + w_2(2\\cdot3) + w_3(3\\cdot4) + w_4(4\\cdot5) + w_5(5\\cdot6) \\right]$$\n这是对 $t=1,...,5$ 的项 $t(t+1)$ 的加权平均。由于权重 $w_{t5}$ 是正数，平均值 $\\sum w_t \\cdot t(t+1)$ 必须严格小于最大可能值 $T(T+1) = 30$。票息支付将权重转移到较早的时间 $t$，在这些时间点，“曲率贡献”项 $t(t+1)$ 较小（例如，$1 \\cdot 2 = 2$, $2 \\cdot 3 = 6$），而最终项在 $t=5$ 时为最大值（$5 \\cdot 6 = 30$）。因此，附息债券的整体凸性较低。\n$$C_{coupon}(y)  C_{zero}(y)$$\n\n**逐项分析**\n\n- **选项 A：**\n  - **数值：** $27.21$。这是**正确的**。\n  - **解释：** 该理由指出，零息债券的现金流完全发生在 $t=T$ 时，此时“曲率权重”$t(t+1)$ 最大。相比之下，附息债券的现金流分布在更早的时间 $t$，其对应的 $t(t+1)$ 值较小，从而降低了加权平均值和总凸性。这一逻辑与我们的推导完全一致。\n  - **结论：** **正确**。\n\n- **选项 B：**\n  - **数值：** $23.94$。这是**不正确的**。\n  - **解释：** 声称“较早的票息支付对利率产生了更高的敏感性”在凸性的背景下具有误导性。虽然久期（一阶敏感性）很复杂，但凸性（二阶敏感性）明确地被较早的现金流所降低。此外，附息债券凸性更高的结论在事实上是错误的。\n  - **结论：** **不正确**。\n\n- **选项 C：**\n  - **数值：** $27.21$。这是**正确的**。\n  - **解释：** 该推理基于“零息债券的久期低于其他方面相同的附息债券”这一前提。这个前提是错误的。零息债券的Macaulay久期恰好等于其期限 $T=5$。而附息债券支付中间票息，因此其Macaulay久期（现金流的加权平均时间）总是严格小于其期限 $T$。因此，对于给定的期限，零息债券具有*最高*的可能久期，而不是最低的。该推理存在根本性缺陷。\n  - **结论：** **不正确**。\n\n- **选项 D：**\n  - **数值：** $30.00$。这是**不正确的**。我们的计算结果约为 $27.21$。\n  - **解释：** 声称零息债券的凸性等于 $T(T+1)$ 是错误的。它应该等于 $\\dfrac{T(T+1)}{(1+y)^2}$。给出的公式错误地省略了分母 $(1+y)^2$，从而错误地断言其与收益率水平无关。\n  - **结论：** **不正确**。\n\n只有选项A同时提供了正确的数值和科学的解释。", "answer": "$$\\boxed{A}$$", "id": "2376960"}, {"introduction": "理论推导和概念比较为我们打下了坚实的基础，但在实际的金融分析中，我们通常需要处理给定市场价格的债券。这个实践练习 [@problem_id:2376917] 将引导你构建一个数值求解器，用于计算任何给定债券的到期收益率（YTM），并在此过程中计算其久期和凸性。这是一项连接理论与实践的核心计算金融技能，让你能够从市场数据中提取关键的风险指标。", "problem": "实现一个独立的程序，为给定测试套件中的每只债券计算其名义年化到期收益率。该收益率是一个唯一的实数 $y$（以小数而非百分比表示），它使得所有承诺现金流的现值等于观察到的全价。一只债券的名义年票息率为 $c$，面值为 $F$，每年支付 $f$ 次利息，到期时间为 $T$ 年（因此总付息期数为 $N = fT$ 且 $N$ 为整数），其现值 $P(y)$ 由以下基本的货币时间价值恒等式定义：\n$$\nP(y) \\equiv \\sum_{t=1}^{N} \\frac{\\mathrm{CF}_t}{(1 + y/f)^{t}},\n$$\n其中，对于 $t \\in \\{1,\\dots,N-1\\}$，有 $\\mathrm{CF}_t = F \\cdot c/f$；对于 $t=N$，有 $\\mathrm{CF}_N = F \\cdot c/f + F$。假设付息日之间的时间间隔相等，无违约风险，且报价为全价（无应计利息）。所有输入均为确定性的。\n\n您的程序必须为每个测试用例找到求解 $P(y) = P_{\\text{mkt}}$ 的唯一 $y$，并在其求根过程的每次迭代中，评估债券相对于 $y$ 的瞬时价格敏感度，即：\n- 修正久期 $D_{\\text{mod}}(y)$，定义为 $D_{\\text{mod}}(y) \\equiv -\\frac{1}{P(y)} \\frac{\\mathrm{d}P}{\\mathrm{d}y}(y)$，以年为单位报告。\n- 修正凸性 $C_{\\text{mod}}(y)$，定义为 $C_{\\text{mod}}(y) \\equiv \\frac{1}{P(y)} \\frac{\\mathrm{d}^2 P}{\\mathrm{d}y^2}(y)$，当 $y$ 以小数单位表示时，报告为纯数。\n\n您的数值求根过程必须使用基本原理：从现值的定义出发，直接根据该定义计算关于 $y$ 的导数，并迭代直至收敛。如果 $y$ 的绝对变化量低于 $10^{-12}$ 或绝对现值误差 $\\lvert P(y) - P_{\\text{mkt}} \\rvert$ 低于 $10^{-12}$，则宣布收敛。每个测试用例最多使用 $100$ 次迭代，并报告每个测试用例最终收敛的 $y$、$D_{\\text{mod}}(y)$ 和 $C_{\\text{mod}}(y)$。所有收益率和利率必须以小数表示，不得使用百分号。\n\n测试套件：\n对于下方的每个元组 $(F,c,f,T,P_{\\text{mkt}})$，求解 $y$ 并报告在收敛的 $y$ 值下相关的 $D_{\\text{mod}}(y)$ 和 $C_{\\text{mod}}(y)$。\n1. $F=100$, $c=0.05$, $f=2$, $T=5$, $P_{\\text{mkt}}=102$。\n2. $F=100$, $c=0$, $f=1$, $T=3$, $P_{\\text{mkt}}=85$。\n3. $F=100$, $c=0.12$, $f=2$, $T=10$, $P_{\\text{mkt}}=140$。\n4. $F=100$, $c=0.06$, $f=2$, $T=0.5$, $P_{\\text{mkt}}=101.5$。\n5. $F=100$, $c=0.08$, $f=4$, $T=7$, $P_{\\text{mkt}}=95$。\n\n最终输出格式：\n您的程序应生成单行输出，包含一个由方括号括起来的逗号分隔列表。对于每个测试用例 $i \\in \\{1,2,3,4,5\\}$，按此确切顺序附加三个浮点数：收敛的收益率 $y_i$、修正久期 $D_{\\text{mod},i}$ 和修正凸性 $C_{\\text{mod},i}$。每个数字必须四舍五入到恰好 $10$ 位小数。因此，最终输出在一个扁平列表中包含 $15$ 个数字：\n$[y_1,D_{\\text{mod},1},C_{\\text{mod},1},y_2,D_{\\text{mod},2},C_{\\text{mod},2},y_3,D_{\\text{mod},3},C_{\\text{mod},3},y_4,D_{\\text{mod},4},C_{\\text{mod},4},y_5,D_{\\text{mod},5},C_{\\text{mod},5}]$。", "solution": "问题陈述已经过严格验证，并被确定为有效。它在科学上基于量化金融的基本原理，在数学上是适定的，并且其规定具有足够、明确的细节，以允许唯一且有意义的解。该问题要求计算债券的到期收益率及其相关的价格敏感度，这是计算金融中一个标准且必要的任务。\n\n核心任务是找到名义年化到期收益率，记为 $y$，它是方程 $g(y) = 0$ 的唯一实数根，其中 $g(y) = P(y) - P_{\\text{mkt}}$。函数 $P(y)$ 表示债券作为收益率函数的理论价格（现值），而 $P_{\\text{mkt}}$ 是其给定的市场价格。价格函数定义为：\n$$\nP(y) = \\sum_{t=1}^{N} \\frac{\\mathrm{CF}_t}{(1 + y/f)^{t}}\n$$\n在这里，$f$ 是付息频率，$T$ 是以年为单位的到期时间，$N=fT$ 是总付息期数，$\\mathrm{CF}_t$ 是第 $t$ 期末的现金流。对于 $t \\in \\{1, \\dots, N-1\\}$ 期间，现金流是每期的票息支付，$\\mathrm{CF}_t = F \\cdot c/f$，其中 $F$ 是面值，$c$ 是名义年票息率。对于最后一期 $t=N$，现金流包括最后一笔票息和本金偿还，$\\mathrm{CF}_N = F \\cdot c/f + F$。\n\n为了求解 $y$，我们将实现牛顿-拉夫逊方法，这是一种强大的求根算法，当初始猜测值足够接近根时，以其快速的二次收敛而闻名。该方法的迭代公式为：\n$$\ny_{k+1} = y_k - \\frac{g(y_k)}{g'(y_k)} = y_k - \\frac{P(y_k) - P_{\\text{mkt}}}{\\frac{\\mathrm{d}P}{\\mathrm{d}y}(y_k)}\n$$\n这需要价格函数相对于收益率的一阶导数 $\\frac{\\mathrm{d}P}{\\mathrm{d}y}$。该问题还要求计算价格凸性，这涉及到二阶导数 $\\frac{\\mathrm{d}^2P}{\\mathrm{d}y^2}$。我们使用链式法则直接从 $P(y)$ 的定义推导出这些导数。\n\n价格函数的一阶导数为：\n$$\n\\frac{\\mathrm{d}P}{\\mathrm{d}y}(y) = \\frac{\\mathrm{d}}{\\mathrm{d}y} \\sum_{t=1}^{N} \\mathrm{CF}_t (1 + y/f)^{-t} = \\sum_{t=1}^{N} \\mathrm{CF}_t \\left[ -t (1 + y/f)^{-t-1} \\cdot \\frac{1}{f} \\right] \\\\\n\\frac{\\mathrm{d}P}{\\mathrm{d}y}(y) = -\\frac{1}{f} \\sum_{t=1}^{N} \\frac{t \\cdot \\mathrm{CF}_t}{(1 + y/f)^{t+1}}\n$$\n对于任何具有非负现金流的债券，该导数都严格为负，这证实了价格函数 $P(y)$ 随收益率 $y$ 单调递减。\n\n二阶导数通过对 $\\frac{\\mathrm{d}P}{\\mathrm{d}y}$ 关于 $y$ 求导得到：\n$$\n\\frac{\\mathrm{d}^2P}{\\mathrm{d}y^2}(y) = \\frac{\\mathrm{d}}{\\mathrm{d}y} \\left( -\\frac{1}{f} \\sum_{t=1}^{N} t \\cdot \\mathrm{CF}_t (1 + y/f)^{-t-1} \\right) = -\\frac{1}{f} \\sum_{t=1}^{N} t \\cdot \\mathrm{CF}_t \\left[ -(t+1) (1 + y/f)^{-t-2} \\cdot \\frac{1}{f} \\right] \\\\\n\\frac{\\mathrm{d}^2P}{\\mathrm{d}y^2}(y) = \\frac{1}{f^2} \\sum_{t=1}^{N} \\frac{t(t+1) \\mathrm{CF}_t}{(1 + y/f)^{t+2}}\n$$\n该导数严格为正，表明价格-收益率关系是凸的。\n\n算法流程如下：\n1. 对于每个测试用例，根据参数 $F$、$c$、$f$ 和 $T$ 构建现金流向量 $\\mathrm{CF}$。\n2. 将收益率的初始猜测值 $y_0$ 设置为票息率 $c$，这是一个合理的起点，因为对于以面值交易的债券，其收益率会收敛到票息率。\n3. 执行牛顿-拉夫逊迭代，最多进行 $100$ 步。在每一步 $k$，从 $y_k$、$P(y_k)$ 和 $\\frac{\\mathrm{d}P}{\\mathrm{d}y}(y_k)$ 计算 $y_{k+1}$。\n4. 当收益率的绝对变化量 $|y_{k+1} - y_k|$ 小于 $10^{-12}$，或定价误差 $|P(y_{k+1}) - P_{\\text{mkt}}|$ 小于 $10^{-12}$ 时，判定为收敛。\n5. 在收敛到最终收益率 $y$ 后，计算所需的风险指标。修正久期 $D_{\\text{mod}}$ 和修正凸性 $C_{\\text{mod}}$ 定义为：\n$$\nD_{\\text{mod}}(y) \\equiv -\\frac{1}{P(y)} \\frac{\\mathrm{d}P}{\\mathrm{d}y}(y)\n$$\n$$\nC_{\\text{mod}}(y) \\equiv \\frac{1}{P(y)} \\frac{\\mathrm{d}^2P}{\\mathrm{d}y^2}(y)\n$$\n在这些公式中，$P(y)$ 是在收敛收益率 $y$ 下计算的理论价格，如问题所述。在收敛时，$P(y)$ 在功能上等同于 $P_{\\text{mkt}}$。\n\n该实现利用 `numpy` 对 $P(y)$ 及其导数中涉及的求和进行高效的向量化计算。该过程应用于所提供套件中的每个测试用例，以获得指定的结果。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve for yield, duration, and convexity for a suite of bonds.\n    \"\"\"\n    # Test Suite: Tuples of (F, c, f, T, P_mkt)\n    # F: Face Value\n    # c: Annual coupon rate (decimal)\n    # f: Coupon frequency per year\n    # T: Maturity in years\n    # P_mkt: Market price (full price)\n    test_cases = [\n        (100.0, 0.05, 2.0, 5.0, 102.0),\n        (100.0, 0.0, 1.0, 3.0, 85.0),\n        (100.0, 0.12, 2.0, 10.0, 140.0),\n        (100.0, 0.06, 2.0, 0.5, 101.5),\n        (100.0, 0.08, 4.0, 7.0, 95.0),\n    ]\n\n    results = []\n    for case in test_cases:\n        y, d_mod, c_mod = solve_for_bond(*case)\n        results.append(f\"{y:.10f}\")\n        results.append(f\"{d_mod:.10f}\")\n        results.append(f\"{c_mod:.10f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\ndef solve_for_bond(F, c, f, T, P_mkt):\n    \"\"\"\n    Calculates yield, modified duration, and modified convexity for a single bond.\n    \n    Uses the Newton-Raphson method to find the yield to maturity.\n    \"\"\"\n    # Derived parameters\n    N = int(f * T)\n    C_periodic = F * c / f\n\n    # Cash flow vector (1-based index logic from problem)\n    cf = np.full(N, C_periodic)\n    if N  0:\n        cf[-1] += F\n    \n    # Time periods vector (t=1, 2, ..., N)\n    t = np.arange(1, N + 1)\n\n    # --- Helper functions for P(y) and its derivatives ---\n    def price(y):\n        if y == -f:\n            return np.inf  # Avoid domain error\n        discount_factors = (1 + y / f) ** -t\n        return np.sum(cf * discount_factors)\n\n    def price_prime(y):\n        if y == -f:\n            return -np.inf\n        terms = t * cf * (1 + y / f) ** (-t - 1)\n        return -np.sum(terms) / f\n\n    def price_double_prime(y):\n        if y == -f:\n            return np.inf\n        terms = t * (t + 1) * cf * (1 + y / f) ** (-t - 2)\n        return np.sum(terms) / (f**2)\n\n    # --- Newton-Raphson Root-finding ---\n    y_k = c  # Initial guess\n    if y_k == -f: # Safety check for pathological initial guess\n        y_k = 0.0\n\n    max_iter = 100\n    conv_tol_y = 1e-12\n    conv_tol_p = 1e-12\n\n    for _ in range(max_iter):\n        y_prev = y_k\n        \n        p = price(y_k)\n        p_prime = price_prime(y_k)\n\n        # Newton's step\n        if abs(p_prime)  1e-15:\n            # Derivative is too small; Newton's method may become unstable.\n            # This should not occur for standard bonds.\n            break\n        \n        y_k = y_k - (p - P_mkt) / p_prime\n        \n        # Check for convergence\n        if abs(y_k - y_prev)  conv_tol_y or abs(price(y_k) - P_mkt)  conv_tol_p:\n            break\n\n    # --- Final calculations at converged yield ---\n    y_final = y_k\n    p_final = price(y_final)\n    p_prime_final = price_prime(y_final)\n    p_double_prime_final = price_double_prime(y_final)\n\n    # Modified Duration and Convexity as per problem definitions\n    if abs(p_final)  1e-15: # Avoid division by zero\n        D_mod = np.nan\n        C_mod = np.nan\n    else:\n        D_mod = -p_prime_final / p_final\n        C_mod = p_double_prime_final / p_final\n        \n    return y_final, D_mod, C_mod\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2376917"}]}