{"hands_on_practices": [{"introduction": "单纯形法的核心在于其迭代过程，即从一个基本可行解系统地移动到另一个更好的解，直到找到最优解。这个迭代的核心步骤就是“轴心变换”（pivot operation）。通过这个练习，你将亲手执行一次完整的轴心变换，这是理解单纯形法算法机制的基础。[@problem_id:2221017]", "problem": "一家市场分析公司正在使用线性规划来确定客户广告预算的最优分配。目标是最大化客户覆盖率。决策变量是 $x_1$（在社交媒体上购买的广告单元数）和 $x_2$（在搜索引擎上购买的广告单元数）。该问题已被构建为一个标准的最大化问题，其初始单纯形表如下所示。变量 $s_1$ 和 $s_2$ 是松弛变量，分别代表未使用的预算和员工工时。变量 $Z$ 代表需要最大化的总客户覆盖率。\n\n表的行对应于目标函数 $Z$ 以及以 $s_1$ 和 $s_2$ 为基变量的两个约束条件。列对应于变量 $Z, x_1, x_2, s_1, s_2$ 和右侧（RHS）值。\n\n初始单纯形表为：\n$$\n\\begin{array}{c|cccccc}\n\\text{基变量} & Z & x_1 & x_2 & s_1 & s_2 & \\text{RHS} \\\\\n\\hline\nZ & 1 & -5 & -4 & 0 & 0 & 0 \\\\\ns_1 & 0 & 10 & 8 & 1 & 0 & 80 \\\\\ns_2 & 0 & 2 & 3 & 0 & 1 & 24 \\\\\n\\end{array}\n$$\n\n根据标准的最大化单纯形算法，执行恰好一次完整的轴心操作。确定 Z 行中 $x_2$ 的系数、Z 行中 $s_1$ 的系数以及目标函数 $Z$ 的新值（Z 行的右侧值）的更新值。\n\n你的答案应是一组按指定顺序排列在行矩阵中的三个数值：（$x_2$ 的系数，$s_1$ 的系数，$Z$ 的值）。", "solution": "我们应用标准单纯形最大化问题的轴心法则。\n\n1) 确定进基变量：在 Z 行中，决策变量中负得最多的系数是 $x_{1}$ 的 $-5$，因此 $x_{1}$ 进基。\n\n2) 对 $x_{1}$ 列进行最小比值测试以选择出基变量：\n$$\n\\frac{80}{10}=8 \\quad \\text{对于 } s_{1}, \\qquad \\frac{24}{2}=12 \\quad \\text{对于 } s_{2}.\n$$\n最小比值为 $8$，因此 $s_{1}$ 出基。轴心元素是 $s_{1}$ 行和 $x_{1}$ 列中的 $10$。\n\n3) 进行轴心操作，使轴心元素变为 1，并从其他行中消去 $x_{1}$。\n\n通过除以 $10$ 来归一化轴心行（$s_{1}$ 行）：\n$$\ns_{1}\\text{-行}: \\quad [0,\\;10,\\;8,\\;1,\\;0\\;|\\;80] \\;\\to\\; [0,\\;1,\\;\\tfrac{4}{5},\\;\\tfrac{1}{10},\\;0\\;|\\;8].\n$$\n\n通过将新的 $s_{1}$ 行的 $5$ 倍加到 Z 行，从 Z 行中消去 $x_{1}$：\n$$\nZ\\text{-行}: \\quad [1,\\;-5,\\;-4,\\;0,\\;0\\;|\\;0] + 5\\cdot[0,\\;1,\\;\\tfrac{4}{5},\\;\\tfrac{1}{10},\\;0\\;|\\;8]\n= [1,\\;0,\\;0,\\;\\tfrac{1}{2},\\;0\\;|\\;40].\n$$\n\n（从 $s_{2}$ 行中消去 $x_{1}$ 是完整轴心操作的一部分，但对于求 Z 行的系数来说不是必需的。）\n\n因此，在这次单次轴心操作后，Z 行中 $x_{2}$ 的系数是 $0$，Z 行中 $s_{1}$ 的系数是 $\\tfrac{1}{2}$，新的目标函数值 $Z$（Z 行的右侧值）是 $40$。", "answer": "$$\\boxed{\\begin{pmatrix}0 & \\frac{1}{2} & 40\\end{pmatrix}}$$", "id": "2221017"}, {"introduction": "找到最优解只是第一步；在现实世界的经济和金融决策中，我们更关心的是当外部条件变化时，这个最优解会如何响应。本练习将引导你探索当资源（约束条件的右侧项）发生变化时，最优目标值会如何改变，并借此深入理解对偶变量或“影子价格”（shadow prices）的强大经济含义。[@problem_id:2443904]", "problem": "一位投资组合经理将资本分配于两种金融工具，以最大化预期年度净回报。决策变量为 $x_{1}$ 和 $x_{2}$，分别表示分配给工具 $1$ 和工具 $2$ 的资本，以统一的货币单位计量。该经理求解以下线性规划 (LP) 问题：\n\n最大化 $z = 5 x_{1} + 4 x_{2}$\n\n约束条件为\n$x_{1} + x_{2} \\leq 7$,\n$2 x_{1} + x_{2} \\leq 11$,\n$x_{1} \\geq 0$, $x_{2} \\geq 0$.\n\n此线性规划问题已被求解。最优基变量为 $x_{1}$ 和 $x_{2}$，最优解为 $x_{1}^{\\star} = 4$， $x_{2}^{\\star} = 3$，最优目标值为 $z^{\\star} = 32$。第一个和第二个约束的关联对偶变量（影子价格）分别为 $y_{1}^{\\star} = 3$ 和 $y_{2}^{\\star} = 1$。紧约束的基矩阵为 $B = \\begin{pmatrix} 1 & 1 \\\\ 2 & 1 \\end{pmatrix}$，其逆矩阵为 $B^{-1} = \\begin{pmatrix} -1 & 1 \\\\ 2 & -1 \\end{pmatrix}$。\n\n现在，假设预算约束的右侧 (RHS) 从 $7$ 增加到 $8$，而所有其他数据保持不变。\n\n使用灵敏度分析和提供的解信息，确定目标函数的新最优值。将您的答案四舍五入到四位有效数字。", "solution": "该问题要求在线性规划 (LP) 的一个约束条件的右侧 (RHS) 发生变化后，求目标函数的新最优值。这是一个灵敏度分析中的标准问题。\n\n首先，我们将给定的信息形式化。原始 LP 问题是：\n最大化 $z = c^T x$\n约束条件为 $Ax \\leq b$ 和 $x \\geq 0$，\n其中 $c = \\begin{pmatrix} 5 \\\\ 4 \\end{pmatrix}$，$x = \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix}$，$A = \\begin{pmatrix} 1 & 1 \\\\ 2 & 1 \\end{pmatrix}$，以及 $b = \\begin{pmatrix} 7 \\\\ 11 \\end{pmatrix}$。\n\n初始最优解为 $x^{\\star} = \\begin{pmatrix} 4 \\\\ 3 \\end{pmatrix}$，最优目标值为 $z^{\\star} = 32$。基变量是 $x_1$ 和 $x_2$。这意味着在最优点，两个不等式约束都是紧约束。基矩阵 $B$ 由 $A$ 中对应于基变量的列组成。在这种情况下，$B = A = \\begin{pmatrix} 1 & 1 \\\\ 2 & 1 \\end{pmatrix}$。给出的逆矩阵是 $B^{-1} = \\begin{pmatrix} -1 & 1 \\\\ 2 & -1 \\end{pmatrix}$。\n\n对偶变量（影子价格）为 $y^{\\star} = \\begin{pmatrix} y_1^{\\star} \\\\ y_2^{\\star} \\end{pmatrix} = \\begin{pmatrix} 3 \\\\ 1 \\end{pmatrix}$。\n\n问题陈述第一个约束的 RHS 从 $7$ 增加到 $8$。这对应于 RHS 向量 $b$ 的变化。原始 RHS 向量是 $b = \\begin{pmatrix} 7 \\\\ 11 \\end{pmatrix}$。新的 RHS 向量是 $b_{new} = \\begin{pmatrix} 8 \\\\ 11 \\end{pmatrix}$。RHS 向量的变化是 $\\Delta b = b_{new} - b = \\begin{pmatrix} 8 - 7 \\\\ 11 - 11 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。\n\nRHS 变化的灵敏度分析基本原理指出，对于 RHS 向量的变化 $\\Delta b$，新的最优目标值 $z_{new}^{\\star}$ 由 $z_{new}^{\\star} = z^{\\star} + (y^{\\star})^T \\Delta b$ 给出，前提是变化 $\\Delta b$ 足够小，使得当前基保持最优。\n\n基保持最优的条件是新的基解 $x_{B, new}$ 必须保持可行（即非负）。新的基解计算如下：\n$$x_{B, new} = B^{-1} b_{new}$$\n我们必须验证 $x_{B, new} \\geq 0$。让我们进行这个计算。\n$$x_{B, new} = \\begin{pmatrix} x_{1, new} \\\\ x_{2, new} \\end{pmatrix} = \\begin{pmatrix} -1 & 1 \\\\ 2 & -1 \\end{pmatrix} \\begin{pmatrix} 8 \\\\ 11 \\end{pmatrix}$$\n$$= \\begin{pmatrix} (-1)(8) + (1)(11) \\\\ (2)(8) + (-1)(11) \\end{pmatrix} = \\begin{pmatrix} -8 + 11 \\\\ 16 - 11 \\end{pmatrix} = \\begin{pmatrix} 3 \\\\ 5 \\end{pmatrix}$$\n由于 $x_{1, new} = 3 \\geq 0$ 和 $x_{2, new} = 5 \\geq 0$，新的基解是可行的。因此，当前基保持最优，紧约束集不变。\n\n现在我们可以放心地使用影子价格来确定新的目标值。目标值的变化是 $\\Delta z^{\\star} = (y^{\\star})^T \\Delta b$。\n$$\\Delta z^{\\star} = \\begin{pmatrix} 3 & 1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = (3)(1) + (1)(0) = 3$$\n新的最优目标值为：\n$$z_{new}^{\\star} = z^{\\star} + \\Delta z^{\\star} = 32 + 3 = 35$$\n\n作为验证，我们可以使用新的最优解 $x_{new}^{\\star} = \\begin{pmatrix} 3 \\\\ 5 \\end{pmatrix}$ 来计算目标值：\n$$z_{new}^{\\star} = c^T x_{new}^{\\star} = \\begin{pmatrix} 5 & 4 \\end{pmatrix} \\begin{pmatrix} 3 \\\\ 5 \\end{pmatrix} = (5)(3) + (4)(5) = 15 + 20 = 35$$\n结果是一致的。新的最优值恰好是 $35$。\n\n题目要求答案保留四位有效数字。数字 $35$ 可以写成 $3.500 \\times 10^1$。为了用四位有效数字表示，我们写作 $35.00$。", "answer": "$$\\boxed{35.00}$$", "id": "2443904"}, {"introduction": "继续我们对“假设”情景的分析，本练习将探讨另一种常见的不确定性：目标函数系数（如产品利润或投资回报）的变化。通过确定一个非基本变量的成本系数在多大范围内变化而最优基保持不变，你将学会评估现有最优策略在市场价格波动面前的稳健性。这对于制定经得起市场考验的商业或投资策略至关重要。[@problem_id:2443936]", "problem": "一家公司选择 $x_1$、$x_2$ 和 $x_3$ 的生产组合，以在资源约束下最大化总贡献。考虑以下线性规划问题\n$\n\\text{maximize } z \\;=\\; 40\\,x_1 \\;+\\; 30\\,x_2 \\;+\\; c_3\\,x_3\n$\n约束条件为\n$\n\\begin{aligned}\n2\\,x_1 \\;+\\; 1\\,x_2 \\;+\\; 1\\,x_3 \\le 40,\\\\\n1\\,x_1 \\;+\\; 2\\,x_2 \\;+\\; 3\\,x_3 \\le 60,\\\\\nx_1,\\;x_2,\\;x_3 \\ge 0.\n\\end{aligned}\n$\n引入松弛变量 $s_1$ 和 $s_2$ 将约束条件写成标准形式，并令 $a_1$、$a_2$ 和 $a_3$ 分别表示与 $x_1$、$x_2$ 和 $x_3$ 相关联的约束矩阵的列向量。假设单纯形法已产生一个最优基本可行解，其基由决策变量 $x_1$ 和 $x_2$ 组成，基矩阵为 $B=[a_1\\;a_2]$，其逆矩阵为\n$\nB^{-1}\n=\\frac{1}{3}\\begin{pmatrix}2 & -1\\\\ -1 & 2\\end{pmatrix}.\n$\n右侧向量为 $b=(40,\\,60)^{\\top}$，基成本向量为 $c_B=(40,\\,30)^{\\top}$，对应于 $x_3$ 的非基列向量为 $a_3=(1,\\,3)^{\\top}$。系数 $c_1=40$ 和 $c_2=30$ 是固定的，而 $c_3$ 允许变化。\n\n当只有 $c_3$ 变化而所有其他数据保持不变时，确定使当前基保持最优的 $c_3$ 的上确界。请以精确值形式给出答案，不要四舍五入。", "solution": "该问题要求确定成本系数 $c_3$ 的上确界，在该上确界范围内，一个给定的线性规划基本可行解保持最优。这是一个灵敏度分析中的标准问题，特别是目标函数系数变化的分析。\n\n给定的线性规划问题是：\n$$\n\\text{maximize } z \\;=\\; 40\\,x_1 \\;+\\; 30\\,x_2 \\;+\\; c_3\\,x_3\n$$\n约束条件为：\n$$\n\\begin{aligned}\n2\\,x_1 \\;+\\; 1\\,x_2 \\;+\\; 1\\,x_3 \\le 40 \\\\\n1\\,x_1 \\;+\\; 2\\,x_2 \\;+\\; 3\\,x_3 \\le 60 \\\\\nx_1,\\;x_2,\\;x_3 \\ge 0.\n\\end{aligned}\n$$\n引入松弛变量 $s_1 \\ge 0$ 和 $s_2 \\ge 0$，我们将不等式约束转换成标准形式的等式：\n$$\n\\begin{aligned}\n2\\,x_1 \\;+\\; 1\\,x_2 \\;+\\; 1\\,x_3 \\;+\\; s_1 = 40 \\\\\n1\\,x_1 \\;+\\; 2\\,x_2 \\;+\\; 3\\,x_3 \\;+\\; s_2 = 60\n\\end{aligned}\n$$\n松弛变量的目标函数系数为零，因此 $z = 40\\,x_1 + 30\\,x_2 + c_3\\,x_3 + 0\\,s_1 + 0\\,s_2$。\n\n我们已知已经找到了一个最优基本可行解，其基变量为 $x_B = (x_1, x_2)^{\\top}$，非基变量为 $x_N = (x_3, s_1, s_2)^{\\top}$。\n对于一个最大化问题，一个基是最优的当且仅当每个非基变量 $x_j$ 的检验数 $\\bar{c}_j$ 小于或等于零（$\\bar{c}_j \\le 0$）。检验数定义为 $\\bar{c}_j = c_j - z_j$，其中 $z_j = c_B^{\\top} B^{-1} a_j$。因此，最优性条件是 $c_j - c_B^{\\top} B^{-1} a_j \\le 0$。\n\n给定的数据是：\n基成本向量：$c_B = \\begin{pmatrix} c_1 \\\\ c_2 \\end{pmatrix} = \\begin{pmatrix} 40 \\\\ 30 \\end{pmatrix}$。\n基矩阵由对应于 $x_1$ 和 $x_2$ 的列向量构成：$B = \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix}$。\n基矩阵的逆矩阵：$B^{-1} = \\frac{1}{3}\\begin{pmatrix} 2 & -1 \\\\ -1 & 2 \\end{pmatrix}$。\n对应于非基变量的列向量是：$a_3 = \\begin{pmatrix} 1 \\\\ 3 \\end{pmatrix}$，$a_{s_1} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ 和 $a_{s_2} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$。\n非基变量的成本是 $c_3$（变量）、$c_{s_1}=0$ 和 $c_{s_2}=0$。\n\n首先，我们计算单纯形乘子（或对偶变量）向量，$y^{\\top} = c_B^{\\top} B^{-1}$：\n$$\ny^{\\top} = \\begin{pmatrix} 40 & 30 \\end{pmatrix} \\frac{1}{3}\\begin{pmatrix} 2 & -1 \\\\ -1 & 2 \\end{pmatrix}\n$$\n$$\ny^{\\top} = \\frac{1}{3} \\begin{pmatrix} 40(2) + 30(-1) & 40(-1) + 30(2) \\end{pmatrix}\n$$\n$$\ny^{\\top} = \\frac{1}{3} \\begin{pmatrix} 80 - 30 & -40 + 60 \\end{pmatrix} = \\frac{1}{3} \\begin{pmatrix} 50 & 20 \\end{pmatrix} = \\begin{pmatrix} \\frac{50}{3} & \\frac{20}{3} \\end{pmatrix}\n$$\n现在我们将最优性条件 $\\bar{c}_j = c_j - y^{\\top}a_j \\le 0$ 应用于每个非基变量。\n\n对于非基变量 $s_1$：\n其成本为 $c_{s_1} = 0$。其列向量为 $a_{s_1} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。\n$$\n\\bar{c}_{s_1} = c_{s_1} - y^{\\top}a_{s_1} = 0 - \\begin{pmatrix} \\frac{50}{3} & \\frac{20}{3} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = -\\frac{50}{3}\n$$\n由于 $-\\frac{50}{3} \\le 0$，对于 $s_1$ 的最优性条件得到满足。此条件与 $c_3$ 无关。\n\n对于非基变量 $s_2$：\n其成本为 $c_{s_2} = 0$。其列向量为 $a_{s_2} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$。\n$$\n\\bar{c}_{s_2} = c_{s_2} - y^{\\top}a_{s_2} = 0 - \\begin{pmatrix} \\frac{50}{3} & \\frac{20}{3} \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = -\\frac{20}{3}\n$$\n由于 $-\\frac{20}{3} \\le 0$，对于 $s_2$ 的最优性条件得到满足。此条件也与 $c_3$ 无关。\n\n对于非基变量 $x_3$：\n其成本为 $c_3$。其列向量为 $a_3 = \\begin{pmatrix} 1 \\\\ 3 \\end{pmatrix}$。\n最优性条件是 $\\bar{c}_3 = c_3 - y^{\\top}a_3 \\le 0$。\n我们必须计算 $y^{\\top}a_3$：\n$$\ny^{\\top}a_3 = \\begin{pmatrix} \\frac{50}{3} & \\frac{20}{3} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 3 \\end{pmatrix} = \\frac{50}{3}(1) + \\frac{20}{3}(3) = \\frac{50}{3} + \\frac{60}{3} = \\frac{110}{3}\n$$\n将此值代入最优性条件，我们得到：\n$$\nc_3 - \\frac{110}{3} \\le 0\n$$\n化简为：\n$$\nc_3 \\le \\frac{110}{3}\n$$\n这个不等式定义了使当前基保持最优的 $c_3$ 的取值范围。所有这些值的集合是区间 $(-\\infty, \\frac{110}{3}]$。问题要求这个集合的上确界。这个区间的上确界，即最小上界，是包含端点的值。\n\n因此，使当前基保持最优的 $c_3$ 的上确界是 $\\frac{110}{3}$。如果 $c_3$ 超过此值，检验数 $\\bar{c}_3$ 将变为正数，这表明当前解不再是最优的，并且可以通过将 $x_3$ 引入基来改进目标函数值。", "answer": "$$\\boxed{\\frac{110}{3}}$$", "id": "2443936"}]}