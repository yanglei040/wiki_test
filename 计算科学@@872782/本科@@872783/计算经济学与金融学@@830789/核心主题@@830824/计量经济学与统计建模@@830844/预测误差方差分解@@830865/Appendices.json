{"hands_on_practices": [{"introduction": "预测误差方差分解（FEVD）是理解向量自回归（VAR）模型中各变量间动态相互影响的关键工具。本练习将通过一个简单的双变量VAR(1)模型，解析基于Cholesky分解的FEVD的一个核心特性：其结果依赖于变量的排序。通过亲手推导一步预测误差的方差分解，你将从数学上揭示为何冲击的溢出效应不一定是对称的 [@problem_id:2394591]。", "problem": "考虑一个稳定的二元一阶向量自回归（VAR(1)）模型，记为\n$$\n\\mathbf{y}_{t} = A \\mathbf{y}_{t-1} + \\mathbf{u}_{t},\n$$\n其中 $\\mathbf{y}_{t} = \\begin{pmatrix} y_{1,t} \\\\ y_{2,t} \\end{pmatrix}$，$A$ 是一个 $2 \\times 2$ 的系数矩阵，其特征值严格位于单位圆内，扰动项 $\\mathbf{u}_{t}$ 的均值为零，且具有正定的协方差矩阵\n$$\n\\Sigma_{u} = \\begin{pmatrix} 1 & \\rho \\\\ \\rho & 1 \\end{pmatrix},\n$$\n其中 $\\rho \\in (-1,1)$。设正交化冲击由 $\\Sigma_{u}$ 在排序 $(y_{1}, y_{2})$ 下的 Cholesky 分解定义：即，设 $P$ 为下三角矩阵，满足 $P P^{\\top} = \\Sigma_{u}$，并定义 $\\mathbf{u}_{t} = P \\boldsymbol{\\varepsilon}_{t}$，其中 $\\boldsymbol{\\varepsilon}_{t}$ 的协方差为单位矩阵。使用预测期为 $1$ 的正交化预测误差方差分解（FEVD），计算差值\n$$\n\\Delta(\\rho) \\equiv \\theta_{1 \\leftarrow 2}(1) - \\theta_{2 \\leftarrow 1}(1),\n$$\n其中 $\\theta_{i \\leftarrow j}(1)$ 表示 $y_{i,t+1}$ 的一步预测误差方差中可归因于正交化冲击 $j$ 的份额。\n\n请用关于 $\\rho$ 的单个简化解析表达式给出最终答案。无需四舍五入。", "solution": "首先将根据所需标准对问题进行验证。\n\n步骤 1：提取已知条件\n问题提供了以下信息：\n- 一个稳定的二元一阶向量自回归（VAR(1)）模型：$\\mathbf{y}_{t} = A \\mathbf{y}_{t-1} + \\mathbf{u}_{t}$。\n- 变量向量为 $\\mathbf{y}_{t} = \\begin{pmatrix} y_{1,t} \\\\ y_{2,t} \\end{pmatrix}$。\n- 系数矩阵 $A$ 是一个 $2 \\times 2$ 矩阵，其特征值严格位于单位圆内。\n- 扰动向量 $\\mathbf{u}_{t}$ 的均值为零。\n- 扰动项的协方差矩阵为 $\\Sigma_{u} = \\begin{pmatrix} 1 & \\rho \\\\ \\rho & 1 \\end{pmatrix}$，其中 $\\rho \\in (-1,1)$。\n- 正交化冲击 $\\boldsymbol{\\varepsilon}_{t}$ 通过 $\\Sigma_{u}$ 的 Cholesky 分解定义，使得 $\\mathbf{u}_{t} = P \\boldsymbol{\\varepsilon}_{t}$，其中 $P$ 是满足 $P P^{\\top} = \\Sigma_{u}$ 的下三角矩阵，且 $\\boldsymbol{\\varepsilon}_{t}$ 的协方差是单位矩阵。该分解基于排序 $(y_{1}, y_{2})$。\n- 需要计算的量是 $\\Delta(\\rho) \\equiv \\theta_{1 \\leftarrow 2}(1) - \\theta_{2 \\leftarrow 1}(1)$。\n- $\\theta_{i \\leftarrow j}(1)$ 是 $y_{i,t+1}$ 的一步预测误差方差中可归因于正交化冲击 $j$ 的份额。\n\n步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据。它描述了一个标准的 VAR(1) 模型，这是计算经济学和金融学中的一个基本工具。所有组成部分——稳定性条件、正定协方差矩阵、用于正交化的 Cholesky 分解以及预测误差方差分解（FEVD）——都是时间序列分析中的标准概念。条件 $\\rho \\in (-1,1)$ 确保了 $\\Sigma_u$ 是正定的，因为其行列式为 $1-\\rho^2 > 0$ 且其对角元素为正。该问题是适定的，提供了计算所要求数量的所有必要信息。语言客观而精确。关于矩阵 $A$ 及其稳定性的信息对于完整的模型定义是必要的，但对于在预测期 $h=1$ 时的具体计算则不是必需的；这不构成缺陷。该问题是自洽、一致且科学有效的。\n\n步骤 3：结论与行动\n问题有效。将提供完整解答。\n\n在给定时间 $t$ 的信息条件下，$\\mathbf{y}_{t+1}$ 的一步预测为 $E[\\mathbf{y}_{t+1} | \\mathcal{F}_{t}] = A \\mathbf{y}_{t}$。相应的预测误差是：\n$$\n\\mathbf{e}_{t+1|t} = \\mathbf{y}_{t+1} - E[\\mathbf{y}_{t+1} | \\mathcal{F}_{t}] = (A \\mathbf{y}_{t} + \\mathbf{u}_{t+1}) - A \\mathbf{y}_{t} = \\mathbf{u}_{t+1}\n$$\n因此，一步预测误差的协方差矩阵就是扰动项的协方差矩阵 $\\Sigma_u$。\n$$\n\\text{MSE}(1) = E[\\mathbf{e}_{t+1|t} \\mathbf{e}_{t+1|t}^{\\top}] = E[\\mathbf{u}_{t+1} \\mathbf{u}_{t+1}^{\\top}] = \\Sigma_u = \\begin{pmatrix} 1 & \\rho \\\\ \\rho & 1 \\end{pmatrix}\n$$\n变量 $y_{i,t+1}$ 的一步预测误差方差是 $\\text{MSE}(1)$ 的第 $i$ 个对角元素。\n$$\n\\text{Var}(e_{1,t+1|t}) = (\\Sigma_u)_{11} = 1\n$$\n$$\n\\text{Var}(e_{2,t+1|t}) = (\\Sigma_u)_{22} = 1\n$$\n预测误差方差分解（FEVD）将此预测误差方差的一部分归因于一组正交化冲击 $\\boldsymbol{\\varepsilon}_{t}$。这些冲击是通过关系式 $\\mathbf{u}_{t} = P \\boldsymbol{\\varepsilon}_{t}$ 从简化形式的冲击 $\\mathbf{u}_{t}$ 推导出来的，其中 $\\boldsymbol{\\varepsilon}_{t}$ 的协方差矩阵为单位矩阵，而 $P$ 是 $\\Sigma_u$ 的 Cholesky 因子。给定排序 $(y_1, y_2)$，$P$ 是一个下三角矩阵。\n设 $P = \\begin{pmatrix} p_{11} & 0 \\\\ p_{21} & p_{22} \\end{pmatrix}$。条件 $P P^{\\top} = \\Sigma_u$ 给出：\n$$\n\\begin{pmatrix} p_{11} & 0 \\\\ p_{21} & p_{22} \\end{pmatrix} \\begin{pmatrix} p_{11} & p_{21} \\\\ 0 & p_{22} \\end{pmatrix} = \\begin{pmatrix} p_{11}^{2} & p_{11}p_{21} \\\\ p_{11}p_{21} & p_{21}^{2} + p_{22}^{2} \\end{pmatrix} = \\begin{pmatrix} 1 & \\rho \\\\ \\rho & 1 \\end{pmatrix}\n$$\n通过相等元素，我们求解 $p_{ij}$：\n1. $p_{11}^{2} = 1 \\implies p_{11} = 1$（按照惯例，对角元素为正）。\n2. $p_{11}p_{21} = \\rho \\implies (1)p_{21} = \\rho \\implies p_{21} = \\rho$。\n3. $p_{21}^{2} + p_{22}^{2} = 1 \\implies \\rho^{2} + p_{22}^{2} = 1 \\implies p_{22} = \\sqrt{1 - \\rho^{2}}$（因为 $\\rho \\in (-1,1)$，所以 $1-\\rho^2 > 0$）。\n\n因此，Cholesky 因子为：\n$$\nP = \\begin{pmatrix} 1 & 0 \\\\ \\rho & \\sqrt{1 - \\rho^{2}} \\end{pmatrix}\n$$\n一步预测误差可以用正交冲击 $\\boldsymbol{\\varepsilon}_{t+1} = \\begin{pmatrix} \\varepsilon_{1,t+1} \\\\ \\varepsilon_{2,t+1} \\end{pmatrix}$ 表示：\n$$\n\\mathbf{e}_{t+1|t} = \\mathbf{u}_{t+1} = P \\boldsymbol{\\varepsilon}_{t+1}\n$$\n预测误差的分量为：\n$$\ne_{1,t+1|t} = u_{1,t+1} = p_{11}\\varepsilon_{1,t+1} + p_{12}\\varepsilon_{2,t+1} = (1)\\varepsilon_{1,t+1} + (0)\\varepsilon_{2,t+1} = \\varepsilon_{1,t+1}\n$$\n$$\ne_{2,t+1|t} = u_{2,t+1} = p_{21}\\varepsilon_{1,t+1} + p_{22}\\varepsilon_{2,t+1} = \\rho\\varepsilon_{1,t+1} + \\sqrt{1-\\rho^{2}}\\varepsilon_{2,t+1}\n$$\n由冲击 $j$ 引起、可归因于 $y_{i,t+1}$ 的一步预测误差方差的份额，记为 $\\theta_{i \\leftarrow j}(1)$，是来自冲击 $\\varepsilon_{j,t+1}$ 的 $\\text{Var}(e_{i,t+1|t})$ 的一部分。由于 $\\text{Var}(\\boldsymbol{\\varepsilon}_{t+1})=I$，这些冲击不相关且方差为单位值。\n\n对于 $y_{1,t+1}$，预测误差为 $e_{1,t+1|t} = \\varepsilon_{1,t+1}$。其方差为 $\\text{Var}(\\varepsilon_{1,t+1}) = 1$。来自冲击 $\\varepsilon_{1,t+1}$ 的贡献为 $1$，而来自冲击 $\\varepsilon_{2,t+1}$ 的贡献为 $0$。\n因此，可归因于冲击 $2$ 的方差份额为：\n$$\n\\theta_{1 \\leftarrow 2}(1) = \\frac{0}{1} = 0\n$$\n\n对于 $y_{2,t+1}$，预测误差为 $e_{2,t+1|t} = \\rho\\varepsilon_{1,t+1} + \\sqrt{1-\\rho^{2}}\\varepsilon_{2,t+1}$。其方差为：\n$$\n\\text{Var}(e_{2,t+1|t}) = \\text{Var}(\\rho\\varepsilon_{1,t+1} + \\sqrt{1-\\rho^{2}}\\varepsilon_{2,t+1}) = \\rho^{2}\\text{Var}(\\varepsilon_{1,t+1}) + (1-\\rho^{2})\\text{Var}(\\varepsilon_{2,t+1}) = \\rho^{2}(1) + (1-\\rho^{2})(1) = 1\n$$\n可归因于冲击 $\\varepsilon_{1,t+1}$ 的方差分量是 $\\rho^{2}\\text{Var}(\\varepsilon_{1,t+1}) = \\rho^{2}$。\n可归因于冲击 $1$ 的方差份额是：\n$$\n\\theta_{2 \\leftarrow 1}(1) = \\frac{\\rho^{2}}{\\text{Var}(e_{2,t+1|t})} = \\frac{\\rho^{2}}{1} = \\rho^{2}\n$$\n\n最后，我们计算所需的差值 $\\Delta(\\rho)$：\n$$\n\\Delta(\\rho) = \\theta_{1 \\leftarrow 2}(1) - \\theta_{2 \\leftarrow 1}(1) = 0 - \\rho^{2} = -\\rho^{2}\n$$\n结果仅取决于同期相关性 $\\rho$ 和为 Cholesky 分解选择的排序，并且与系统动态矩阵 $A$ 无关。", "answer": "$$\n\\boxed{-\\rho^{2}}\n$$", "id": "2394591"}, {"introduction": "理论的理解最终需要通过实践来巩固，对于FEVD而言，这意味着要能将其计算过程转化为代码。本练习将指导你从零开始，编写一个能够计算任意$p$阶向量自回归（VAR($p$)）模型FEVD的通用函数。这个过程不仅能加深你对移动平均表示、Cholesky分解以及方差贡献累加等核心步骤的理解，还将为你提供一个未来进行实证研究的强大工具 [@problem_id:2394623]。", "problem": "给定一个 $n$ 维向量 $\\mathbf{y}_t$ 的 $p$ 阶向量自回归（VAR($p$)）模型定义，该模型具有零均值、协方差平稳的动态特性：\n$$\n\\mathbf{y}_t = \\sum_{i=1}^{p} A_i \\mathbf{y}_{t-i} + \\boldsymbol{\\epsilon}_t,\\quad \\mathbb{E}[\\boldsymbol{\\epsilon}_t]=\\mathbf{0},\\quad \\mathbb{E}[\\boldsymbol{\\epsilon}_t \\boldsymbol{\\epsilon}_t^\\top] = \\Sigma_{\\epsilon},\n$$\n其中 $A_i \\in \\mathbb{R}^{n\\times n}$ 且 $\\Sigma_{\\epsilon} \\in \\mathbb{R}^{n\\times n}$ 是对称正定矩阵。定义其移动平均表示为 $\\mathbf{y}_t = \\sum_{h=0}^{\\infty} \\Psi_h \\boldsymbol{\\epsilon}_{t-h}$，其中 $\\Psi_0 = I_n$。令 $P$ 为唯一的、对角线元素严格为正的下三角矩阵，满足 $P P^\\top = \\Sigma_{\\epsilon}$（在给定变量排序下，冲击协方差矩阵的下三角因子）。对于有限的预测期 $H \\in \\mathbb{N}$，正交化的预测误差方差分解（FEVD）矩阵 $D(H) \\in \\mathbb{R}^{n\\times n}$ 对由 $j \\in \\{1,\\dots,n\\}$ 索引的变量和由 $k \\in \\{1,\\dots,n\\}$ 索引的结构性冲击，其元素定义为以下比率：\n$$\nD_{j k}(H) \\equiv \\frac{\\sum_{h=0}^{H-1} \\left( e_j^\\top \\Psi_h P e_k \\right)^2}{\\sum_{h=0}^{H-1} e_j^\\top \\Psi_h \\Sigma_{\\epsilon} \\Psi_h^\\top e_j},\n$$\n其中 $e_j$ 是 $\\mathbb{R}^n$ 中的第 $j$ 个标准基向量。根据构造，对于每个 $j$，行 $D_{j\\cdot}(H)$ 的和为 1。所有计算都应在实数算术中进行。\n\n实现一个完整的程序，对下面的每个测试用例，计算如上定义的 FEVD 矩阵 $D(H)$，并以行主序将其元素展平后返回。输出中的每个标量必须四舍五入到 $6$ 位小数。\n\n最终输出格式要求：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。此顶层列表的每个元素对应一个测试用例，并且本身必须是一个列表，其中包含该案例的、按行主序展平的 FEVD 条目。例如，要求的整体格式为 $\\big[$case$1$,$\\,$case$2$,$\\,$\\dots\\big]$，其中每个案例都是一个列表，如 $\\big[$value$1$,$\\,$\\dots\\big]$。\n\n测试套件：\n- 测试用例 $1$ ($n=2$, $p=1$, $H=8$):\n  - 系数：\n    $$\n    A_1 = \\begin{bmatrix}\n    0.5 & 0.2 \\\\\n    0.1 & 0.4\n    \\end{bmatrix}.\n    $$\n  - 冲击协方差：\n    $$\n    \\Sigma_{\\epsilon} = \\begin{bmatrix}\n    1.0 & 0.3 \\\\\n    0.3 & 0.5\n    \\end{bmatrix}.\n    $$\n- 测试用例 $2$ ($n=2$, $p=1$, $H=1$) (单位冲击的边界情况)：\n  - 系数：\n    $$\n    A_1 = \\begin{bmatrix}\n    0.3 & 0.0 \\\\\n    0.0 & 0.2\n    \\end{bmatrix}.\n    $$\n  - 冲击协方差：\n    $$\n    \\Sigma_{\\epsilon} = \\begin{bmatrix}\n    1.0 & 0.0 \\\\\n    0.0 & 1.0\n    \\end{bmatrix}.\n    $$\n- 测试用例 $3$ ($n=3$, $p=2$, $H=6$) (更高阶和维度)：\n  - 系数：\n    $$\n    A_1 = \\begin{bmatrix}\n    0.4 & 0.1 & 0.0 \\\\\n    0.0 & 0.3 & 0.2 \\\\\n    0.0 & 0.0 & 0.2\n    \\end{bmatrix},\\quad\n    A_2 = \\begin{bmatrix}\n    -0.1 & 0.0 & 0.0 \\\\\n    0.0 & 0.1 & 0.0 \\\\\n    0.0 & 0.0 & 0.05\n    \\end{bmatrix}.\n    $$\n  - 通过其下三角因子 $P$ 指定的冲击协方差：\n    $$\n    P = \\begin{bmatrix}\n    0.9 & 0.0 & 0.0 \\\\\n    0.1 & 0.7 & 0.0 \\\\\n    0.0 & 0.1 & 0.8\n    \\end{bmatrix},\\quad\n    \\Sigma_{\\epsilon} = P P^\\top = \\begin{bmatrix}\n    0.81 & 0.09 & 0.0 \\\\\n    0.09 & 0.50 & 0.07 \\\\\n    0.0 & 0.07 & 0.65\n    \\end{bmatrix}.\n    $$\n\n您的程序必须：\n- 对于每个测试用例，根据上述定义，使用给定的排序（这决定了 Cholesky 因子 $P$），计算 FEVD 矩阵 $D(H)$。\n- 将 $D(H)$ 按行主序展平为一个长度为 $n \\cdot n$ 的列表，并将每个条目四舍五入到 $6$ 位小数。\n- 生成单行输出，其中包含一个顶层列表，每个测试用例一个元素，每个元素是该案例的展平列表，格式严格为 $\\big[$case$1$,$\\,$case$2$,$\\,$case$3\\big]$（除了列表语法固有的空格外，不需要或不允许其他空格）。", "solution": "问题陈述已经过验证，并被确定为有效。它是在时间序列计量经济学既定领域内一个适定问题。它具有科学依据，是客观的，并为获得唯一解提供了所有必要信息。因此，我们可以着手推导和实现解决方案。\n\n任务是为一个给定的 $n$ 维、零均值、协方差平稳的 $p$ 阶向量自回归模型（VAR($p$)）计算预测误差方差分解（FEVD）矩阵，记为 $D(H)$。该模型指定为：\n$$ \\mathbf{y}_t = \\sum_{i=1}^{p} A_i \\mathbf{y}_{t-i} + \\boldsymbol{\\epsilon}_t $$\n其中 $\\mathbf{y}_t \\in \\mathbb{R}^n$ 是时间 $t$ 的变量向量，$A_i \\in \\mathbb{R}^{n \\times n}$ 是系数矩阵，而 $\\boldsymbol{\\epsilon}_t$ 是一个白噪声过程，其均值为 $\\mathbb{E}[\\boldsymbol{\\epsilon}_t]=\\mathbf{0}$，协方差矩阵为 $\\mathbb{E}[\\boldsymbol{\\epsilon}_t \\boldsymbol{\\epsilon}_t^\\top] = \\Sigma_{\\epsilon}$。协方差矩阵 $\\Sigma_{\\epsilon}$ 是对称正定的。\n\n解决方案需要将 VAR($p$) 过程表示为其移动平均（MA）形式：\n$$ \\mathbf{y}_t = \\sum_{h=0}^{\\infty} \\Psi_h \\boldsymbol{\\epsilon}_{t-h} $$\n其中矩阵 $\\Psi_h \\in \\mathbb{R}^{n \\times n}$ 是脉冲响应函数系数。这些系数通过将 MA 形式代入 VAR 方程，并匹配 $\\boldsymbol{\\epsilon}_t$ 的每个滞后项的系数来递归确定。对于作为列向量的变量，递归关系为 $\\Psi_0 = I_n$ 且对于 $h > 0$ 有 $\\Psi_h = \\sum_{i=1}^{p} A_i \\Psi_{h-i}$。这个递归关系允许我们计算任何所需预测期 $h$ 的 $\\Psi_h$。对于本问题，我们需要计算 $h \\in \\{0, 1, \\dots, H-1\\}$ 的 $\\Psi_h$。\n\nFEVD 基于正交化冲击。如 $\\Sigma_{\\epsilon}$ 所描述，冲击 $\\boldsymbol{\\epsilon}_t$ 是同期相关的。为了将预测误差方差归因于特定的、不相关的潜在结构性冲击，我们对协方差矩阵进行 Cholesky 分解。令 $P$ 为唯一的、对角线元素严格为正的下三角矩阵，使得 $P P^\\top = \\Sigma_{\\epsilon}$。这种分解意味着 $\\mathbf{y}_t$ 中变量的特定排序。可以定义一个正交冲击向量 $\\mathbf{u}_t$ 为 $\\mathbf{u}_t = P^{-1} \\boldsymbol{\\epsilon}_t$，使得 $\\mathbb{E}[\\mathbf{u}_t \\mathbf{u}_t^\\top] = I_n$。然后，MA 表示可以写成这些结构性冲击的形式：$\\mathbf{y}_t = \\sum_{h=0}^{\\infty} (\\Psi_h P) \\mathbf{u}_{t-h}$。项 $\\Psi_h P$ 表示 $\\mathbf{y}_t$ 对正交化冲击的响应。\n\nFEVD 矩阵 $D(H)$ 对每个变量 $j \\in \\{1, \\dots, n\\}$ 和结构性冲击 $k \\in \\{1, \\dots, n\\}$ 按元素定义为：\n$$ D_{j k}(H) \\equiv \\frac{\\sum_{h=0}^{H-1} \\left( e_j^\\top \\Psi_h P e_k \\right)^2}{\\sum_{h=0}^{H-1} e_j^\\top \\Psi_h \\Sigma_{\\epsilon} \\Psi_h^\\top e_j} $$\n这里，$e_j$ 是第 $j$ 个标准基向量。\n\n我们来分析这个公式的组成部分。\n项 $e_j^\\top \\Psi_h P e_k$ 分离出矩阵乘积 $\\Psi_h P$ 的第 $(j,k)$ 个元素。该元素表示在 $h$ 个时期后，变量 $j$ 对结构性冲击 $k$ 中一个标准差冲击的脉冲响应。分子 $\\sum_{h=0}^{H-1} (e_j^\\top \\Psi_h P e_k)^2$ 是变量 $j$ 的预测误差方差中可归因于结构性冲击 $k$ 的部分，从时期 $0$ 累积到 $H-1$。\n\n分母 $\\sum_{h=0}^{H-1} e_j^\\top \\Psi_h \\Sigma_{\\epsilon} \\Psi_h^\\top e_j$ 是变量 $j$ 在相同时期内的总预测误差方差。这可以通过观察总的 $H$ 步预测误差为 $\\mathbf{y}_{t+H} - \\mathbb{E}_t[\\mathbf{y}_{t+H}] = \\sum_{h=0}^{H-1} \\Psi_h \\boldsymbol{\\epsilon}_{t+H-h}$ 来理解。该误差的协方差矩阵是 $\\sum_{h=0}^{H-1} \\Psi_h \\Sigma_{\\epsilon} \\Psi_h^\\top$。此预测误差的第 $j$ 个分量的方差是此协方差矩阵的第 $(j,j)$ 个元素。由于 $\\sum_{k=1}^n (e_j^\\top \\Psi_h P e_k)^2 = e_j^\\top \\Psi_h P (\\sum_k e_k e_k^\\top) P^\\top \\Psi_h^\\top e_j = e_j^\\top \\Psi_h P P^\\top \\Psi_h^\\top e_j = e_j^\\top \\Psi_h \\Sigma_{\\epsilon} \\Psi_h^\\top e_j$，所有冲击 $k$ 的分子之和等于分母。因此，对于任何变量 $j$，FEVD 矩阵的相应行之和为 1：$\\sum_{k=1}^n D_{jk}(H) = 1$。\n\n计算 $D(H)$ 的算法如下：\n$1$. 给定 VAR 系数 $\\{A_1, \\dots, A_p\\}$、冲击协方差矩阵 $\\Sigma_{\\epsilon}$（或其 Cholesky 因子 $P$）以及预测期 $H$。确定维度 $n$。如果未提供 $P$，则通过对 $\\Sigma_{\\epsilon}$ 进行 Cholesky 分解来计算它。如果提供了 $P$，则计算 $\\Sigma_{\\epsilon} = P P^\\top$。\n$2$. 创建一个列表或数组来存储 MA 系数矩阵 $\\Psi_h$，其中 $h=0, \\dots, H-1$。\n$3$. 初始化 $\\Psi_0 = I_n$。\n$4$. 对 $h=1, \\dots, H-1$ 迭代计算 $\\Psi_h = \\sum_{i=1}^{p} A_i \\Psi_{h-i}$，并存储每个结果。\n$5$. 初始化一个用于分子的 $n \\times n$ 矩阵 `Num`，以及一个用于分母的 $n$ 维向量 `Den`。\n$6$. 对于从 $0$ 到 $H-1$ 的每个时期 $h$:\n    a. 计算对正交冲击的脉冲响应，$\\Theta_h = \\Psi_h P$。\n    b. 更新分子矩阵：`Num` += $\\Theta_h \\circ \\Theta_h$（逐元素平方）。\n    c. 计算此期的方差贡献，$V_h = \\Psi_h \\Sigma_{\\epsilon} \\Psi_h^\\top$。\n    d. 更新分母向量：`Den` += $\\text{diag}(V_h)$。\n$7$. 通过逐元素除法计算最终的 FEVD 矩阵 $D(H)$：$D_{jk}(H) = \\text{Num}_{jk} / \\text{Den}_j$。\n$8$. 按行主序将矩阵 $D(H)$ 展平为向量，并按要求将每个条目四舍五入到 $6$ 位小数。\n\n此过程将为问题陈述中提供的每个测试用例实现。", "answer": "```python\nimport numpy as np\n\ndef compute_fevd(A_mats, S_mat, H, is_P):\n    \"\"\"\n    Computes the Forecast Error Variance Decomposition (FEVD) matrix.\n\n    Args:\n        A_mats (list of np.ndarray): List of VAR coefficient matrices [A_1, ..., A_p].\n        S_mat (np.ndarray): The shock covariance matrix Sigma_e or its Cholesky factor P.\n        H (int): The forecast horizon.\n        is_P (bool): True if S_mat is P, False if it is Sigma_e.\n\n    Returns:\n        np.ndarray: The flattened and rounded FEVD matrix D(H).\n    \"\"\"\n    if not A_mats:\n        n = S_mat.shape[0]\n        p = 0\n    else:\n        n, _ = A_mats[0].shape\n        p = len(A_mats)\n\n    if is_P:\n        P = S_mat\n        Sigma_e = P @ P.T\n    else:\n        # The problem statement guarantees Sigma_e is symmetric positive definite.\n        # np.linalg.cholesky returns a lower-triangular matrix.\n        P = np.linalg.cholesky(S_mat)\n        Sigma_e = S_mat\n\n    # Steps 2-4: Compute Psi_h matrices\n    psi_mats = [np.zeros((n, n)) for _ in range(H)]\n    if H > 0:\n        psi_mats[0] = np.identity(n)\n\n    for h in range(1, H):\n        new_psi = np.zeros((n, n))\n        for i in range(1, p + 1):\n            if h - i >= 0:\n                # A_i is at index (i-1) in A_mats\n                new_psi += A_mats[i-1] @ psi_mats[h - i]\n        psi_mats[h] = new_psi\n\n    # Step 5  6: Compute numerators and denominators\n    # Denominators: sum_{h=0..H-1} diag(Psi_h * Sigma_e * Psi_h.T) for each variable\n    # Numerators: sum_{h=0..H-1} ( (Psi_h * P)[j,k] )^2 for each (j,k)\n    \n    numerators = np.zeros((n, n))\n    denominators = np.zeros(n)\n\n    for h in range(H):\n        psi_h = psi_mats[h]\n        \n        # Numerator contribution from horizon h\n        theta_h = psi_h @ P\n        numerators += theta_h**2\n        \n        # Denominator contribution from horizon h\n        var_h = psi_h @ Sigma_e @ psi_h.T\n        denominators += np.diag(var_h)\n\n    # Avoid division by zero, though mathematically not possible for H>=1\n    # given Sigma_e is positive definite.\n    # The diagonal elements of Sigma_e are positive, so for h=0, psi_0=I,\n    # the denominator term is diag(Sigma_e) > 0.\n    denominators[denominators == 0] = 1e-12 # A small number to prevent errors\n\n    # Step 7: Assemble the FEVD matrix D(H)\n    D_H = numerators / denominators[:, np.newaxis]\n\n    # Step 8: Flatten and round\n    return np.round(D_H.flatten(), 6)\n\n\ndef solve():\n    \"\"\"\n    Solves the problem for all provided test cases and prints the result.\n    \"\"\"\n    # Test case 1: n=2, p=1, H=8\n    A1_c1 = np.array([[0.5, 0.2], [0.1, 0.4]])\n    Sigma_e_c1 = np.array([[1.0, 0.3], [0.3, 0.5]])\n    case1 = (\n        [A1_c1],\n        Sigma_e_c1,\n        8,\n        False # Is not P\n    )\n\n    # Test case 2: n=2, p=1, H=1\n    A1_c2 = np.array([[0.3, 0.0], [0.0, 0.2]])\n    Sigma_e_c2 = np.array([[1.0, 0.0], [0.0, 1.0]])\n    case2 = (\n        [A1_c2],\n        Sigma_e_c2,\n        1,\n        False # Is not P\n    )\n\n    # Test case 3: n=3, p=2, H=6\n    A1_c3 = np.array([[0.4, 0.1, 0.0], [0.0, 0.3, 0.2], [0.0, 0.0, 0.2]])\n    A2_c3 = np.array([[-0.1, 0.0, 0.0], [0.0, 0.1, 0.0], [0.0, 0.0, 0.05]])\n    P_c3 = np.array([[0.9, 0.0, 0.0], [0.1, 0.7, 0.0], [0.0, 0.1, 0.8]])\n    case3 = (\n        [A1_c3, A2_c3],\n        P_c3,\n        6,\n        True # Is P\n    )\n\n    test_cases = [case1, case2, case3]\n    results = []\n    \n    for case in test_cases:\n        A_mats, S_mat, H, is_P = case\n        result = compute_fevd(A_mats, S_mat, H, is_P)\n        results.append(result)\n\n    # Format the output string as per requirements\n    formatted_results = []\n    for res_array in results:\n        # Use .6f format specifier to ensure 6 decimal places are printed\n        str_list = [f\"{x:.6f}\" for x in res_array]\n        formatted_results.append(f\"[{','.join(str_list)}]\")\n    \n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2394623"}, {"introduction": "在经济和金融分析中，选择正确的模型至关重要，而FEVD可以帮助我们评估模型设定不当所带来的后果。本练习将探讨一个协整系统中的常见问题：使用水平VAR模型与使用正确的向量误差修正模型（VECM）进行分析的差异。你将应用之前构建的计算工具，比较两种模型得出的FEVD结果，从而量化因忽略协整关系和短期动态而导致的分析偏差 [@problem_id:2394618]。", "problem": "考虑一个二元时间序列 $\\{y_t\\}_{t \\ge 0}$，其中 $y_t \\in \\mathbb{R}^2$，由一个2阶向量误差修正模型（VECM）生成：\n$$\n\\Delta y_t \\;=\\; \\Pi \\, y_{t-1} \\;+\\; \\Gamma_1 \\, \\Delta y_{t-1} \\;+\\; \\varepsilon_t,\n$$\n其中 $\\Pi = \\alpha \\beta^{\\top}$ 的秩为1（协整秩为1），$\\Gamma_1 \\in \\mathbb{R}^{2 \\times 2}$ 捕捉短期动态，$\\varepsilon_t \\in \\mathbb{R}^2$ 是一个简化式创新，满足 $\\mathbb{E}[\\varepsilon_t] = 0$ 和 $\\mathbb{E}[\\varepsilon_t \\varepsilon_t^{\\top}] = \\Sigma \\succ 0$。令 $I$ 表示 $2 \\times 2$ 的单位矩阵。上述VECM在水平值上观测等价于一个2阶向量自回归（VAR）模型：\n$$\ny_t \\;=\\; A_1 \\, y_{t-1} \\;+\\; A_2 \\, y_{t-2} \\;+\\; u_t,\n$$\n其中 $A_1 = I + \\Pi + \\Gamma_1$，$A_2 = -\\Gamma_1$，且 $u_t = \\varepsilon_t$。\n\n一个常用但可能设定错误的替代模型是针对相同协整变量的1阶水平VAR模型，该模型忽略了短期动态：\n$$\ny_t \\;=\\; A^{\\mathrm{L}}_1 \\, y_{t-1} \\;+\\; \\tilde{u}_t, \\quad \\text{with} \\quad A^{\\mathrm{L}}_1 \\;=\\; I + \\Pi, \\quad \\tilde{u}_t = \\varepsilon_t.\n$$\n\n对于任意具有系数矩阵 $\\{A_j\\}_{j=1}^p$ 的线性VAR($p$)模型，定义其相对于简化式创新 $\\{u_t\\}$ 的移动平均（MA）表示为\n$$\ny_t \\;=\\; \\sum_{i=0}^{\\infty} \\Psi_i \\, u_{t-i},\n$$\n其中 $\\Psi_0 = I$，并且对于所有 $i \\ge 1$，\n$$\n\\Psi_i \\;=\\; \\sum_{j=1}^{\\min\\{p,i\\}} A_j \\Psi_{i-j}.\n$$\n令 $P$ 为 $\\Sigma$ 的下三角Cholesky因子，使得 $\\Sigma = P P^{\\top}$，并定义正交化的脉冲响应系数 $\\Theta_i = \\Psi_i P$。对于任意期 $h \\in \\mathbb{N}$，分量 $m \\in \\{1,2\\}$ 的h步预测误差方差为\n$$\nS_m(h) \\;=\\; \\sum_{i=0}^{h-1} \\sum_{k=1}^{2} \\left([\\Theta_i]_{m,k}\\right)^2,\n$$\n并且在h期，分量 $m$ 的预测误差方差分解（FEVD）中可归因于正交冲击 $k$ 的部分是\n$$\n\\mathrm{FEVD}_{m,k}(h) \\;=\\; \\frac{\\sum_{i=0}^{h-1} \\left([\\Theta_i]_{m,k}\\right)^2}{S_m(h)}.\n$$\n\n你的任务是比较在固定的有限期 $h$ 下，从以下两个模型获得的FEVD矩阵：\n- 正确设定的2阶VECM（等价于其系数为 $A_1 = I + \\Pi + \\Gamma_1$ 和 $A_2 = -\\Gamma_1$ 的VAR($2$)水平值形式），以及\n- 由 $A^{\\mathrm{L}}_1 = I + \\Pi$ 定义的设定错误的1阶水平VAR模型。\n\n在两个模型中，对Cholesky分解使用相同的简化式创新协方差 $\\Sigma$ 和相同的变量排序 $(y_{1,t}, y_{2,t})$。对于每个参数集，计算在指定期 $h$ 的两个FEVD矩阵，并报告一个定义如下的单独实数\n$$\n\\Delta \\;=\\; \\max_{m \\in \\{1,2\\}, \\, k \\in \\{1,2\\}} \\left| \\mathrm{FEVD}^{\\mathrm{L}}_{m,k}(h) \\;-\\; \\mathrm{FEVD}^{\\mathrm{VECM}}_{m,k}(h) \\right|,\n$$\n其中 $\\mathrm{FEVD}^{\\mathrm{L}}$ 和 $\\mathrm{FEVD}^{\\mathrm{VECM}}$ 分别表示来自1阶水平VAR模型和正确设定的VECM($2$)的FEVD。\n\n测试集：\n为以下三个参数集提供解，每个参数集包含 $(\\alpha, \\beta, \\Gamma_1, \\Sigma, h)$：\n\n- 案例A（具有短期动态的一般协整）：\n  - $\\alpha = \\begin{bmatrix} -0.3 \\\\ 0.2 \\end{bmatrix}$，$\\beta = \\begin{bmatrix} 1 \\\\ -1 \\end{bmatrix}$，\n  - $\\Gamma_1 = \\begin{bmatrix} 0.4  -0.1 \\\\ 0.05  0.2 \\end{bmatrix}$，\n  - $\\Sigma = \\begin{bmatrix} 1.0  0.5 \\\\ 0.5  1.5 \\end{bmatrix}$，\n  - $h = 10$。\n\n- 案例B（短期动态缺失的边界情况，意味着水平值模型相等）：\n  - $\\alpha = \\begin{bmatrix} -0.4 \\\\ 0.3 \\end{bmatrix}$，$\\beta = \\begin{bmatrix} 1 \\\\ -1.2 \\end{bmatrix}$，\n  - $\\Gamma_1 = \\begin{bmatrix} 0.0  0.0 \\\\ 0.0  0.0 \\end{bmatrix}$，\n  - $\\Sigma = \\begin{bmatrix} 1.0  0.3 \\\\ 0.3  0.8 \\end{bmatrix}$，\n  - $h = 12$。\n\n- 案例C（具有非平凡短期动态的更强调整）：\n  - $\\alpha = \\begin{bmatrix} -0.6 \\\\ 0.45 \\end{bmatrix}$，$\\beta = \\begin{bmatrix} 1 \\\\ -0.8 \\end{bmatrix}$，\n  - $\\Gamma_1 = \\begin{bmatrix} 0.3  -0.12 \\\\ 0.08  0.22 \\end{bmatrix}$，\n  - $\\Sigma = \\begin{bmatrix} 0.7  0.4 \\\\ 0.4  1.2 \\end{bmatrix}$，\n  - $h = 16$。\n\n最终输出格式：\n你的程序应产生单行输出，其中包含一个由方括号括起来的逗号分隔列表，列表中的三个实数 $\\Delta$ 按顺序分别对应案例A、B和C。每个实数必须四舍五入到恰好6位小数。例如：\"[0.123456,0.000000,0.042000]\"。", "solution": "该问题要求对一个二元系统 $y_t \\in \\mathbb{R}^2$ 的两个不同时间序列模型所导出的预测误差方差分解（FEVD）进行定量比较。第一个模型是真实的数据生成过程，一个2阶向量误差修正模型，它等价于一个2阶水平向量自回归（VAR）模型。第二个模型是一个设定错误的1阶水平VAR模型，它省略了短期动态项。我们的目标是计算对于给定的参数集，由这两个模型产生的FEVD矩阵之间的最大绝对差异。\n\n问题陈述被验证为科学上合理、适定、客观和完整的。它提供了得出唯一且可验证解所需的所有必要定义、方程和数据。我们现在将详细说明正式的步骤。\n\n首先，我们必须根据给定的参数 $(\\alpha, \\beta, \\Gamma_1)$ 为两个模型构建系数矩阵。系统维度为 $k=2$。\n\n正确设定的模型是一个VECM($2$)，可以写成一个水平VAR($2$)模型：\n$$\ny_t \\;=\\; A_1 \\, y_{t-1} \\;+\\; A_2 \\, y_{t-2} \\;+\\; u_t\n$$\n其中系数矩阵定义为：\n$$\nA_1 \\;=\\; I_2 + \\Pi + \\Gamma_1\n$$\n$$\nA_2 \\;=\\; -\\Gamma_1\n$$\n其中 $I_2$ 是 $2 \\times 2$ 的单位矩阵，$\\Pi = \\alpha \\beta^{\\top}$。创新项 $u_t$ 等于VECM的创新项 $\\varepsilon_t$。\n\n设定错误的模型是一个水平VAR($1$)模型，用上标'L'表示：\n$$\ny_t \\;=\\; A^{\\mathrm{L}}_1 \\, y_{t-1} \\;+\\; \\tilde{u}_t\n$$\n其中系数矩阵为：\n$$\nA^{\\mathrm{L}}_1 \\;=\\; I_2 + \\Pi\n$$\n这个模型错误地假设 $\\Gamma_1 = \\mathbf{0}$，意味着没有短期动态。创新项 $\\tilde{u}_t$ 被假定为 $\\varepsilon_t$。\n\n分析的核心在于每个模型的移动平均（MA）表示。对于一个通用的VAR($p$)模型，MA系数矩阵 $\\Psi_i$ 是递归计算的。我们需要计算到 $h-1$ 期的这些矩阵。\n递归公式由下式给出：\n$$\n\\Psi_0 = I_2\n$$\n$$\n\\Psi_i = \\sum_{j=1}^{p} A_j \\Psi_{i-j}, \\quad \\text{for } i \\ge 1\n$$\n对于VAR($2$)模型（$p=2$），递归公式为：\n$$\n\\Psi_i^{\\mathrm{VECM}} = A_1 \\Psi_{i-1}^{\\mathrm{VECM}} + A_2 \\Psi_{i-2}^{\\mathrm{VECM}}, \\quad \\text{for } i \\ge 2\n$$\n初始条件为 $\\Psi_0^{\\mathrm{VECM}} = I_2$ 和 $\\Psi_1^{\\mathrm{VECM}} = A_1$。\n\n对于设定错误的VAR($1$)模型（$p=1$），递归公式简化为：\n$$\n\\Psi_i^{\\mathrm{L}} = A^{\\mathrm{L}}_1 \\Psi_{i-1}^{\\mathrm{L}} = (A^{\\mathrm{L}}_1)^i, \\quad \\text{for } i \\ge 1\n$$\n其中 $\\Psi_0^{\\mathrm{L}} = I_2$。\n\n为了考虑创新项 $\\varepsilon_t$ 中的同期相关性，我们使用协方差矩阵 $\\Sigma$ 的Cholesky分解来将冲击正交化。我们找到一个下三角矩阵 $P$ 使得 $\\Sigma = P P^{\\top}$。那么正交化的脉冲响应系数矩阵为：\n$$\n\\Theta_i = \\Psi_i P, \\quad \\text{for } i = 0, \\dots, h-1\n$$\n这个计算是分别为每个模型执行的，分别使用 $\\Psi_i^{\\mathrm{VECM}}$ 和 $\\Psi_i^{\\mathrm{L}}$。矩阵 $P$ 对两者是相同的，因为它们共享相同的创新协方差 $\\Sigma$。\n\n预测误差方差分解 $\\mathrm{FEVD}_{m,k}(h)$ 衡量了变量 $m$ 的 $h$ 步预测误差方差中可归因于第 $k$ 个正交化冲击的比例。对于变量 $m \\in \\{1, 2\\}$ 和冲击 $k \\in \\{1, 2\\}$，在 $h$ 期的FEVD为：\n$$\n\\mathrm{FEVD}_{m,k}(h) \\;=\\; \\frac{\\sum_{i=0}^{h-1} \\left([\\Theta_i]_{m-1,k-1}\\right)^2}{\\sum_{j=1}^{2} \\sum_{i=0}^{h-1} \\left([\\Theta_i]_{m-1,j-1}\\right)^2}\n$$\n注意，为了矩阵实现，索引被调整为从0开始。对于每个模型，这些计算会产生一个 $2 \\times 2$ 的FEVD矩阵。\n\n最后，我们通过计算 $\\Delta$ 来量化两个模型之间的差异：\n$$\n\\Delta \\;=\\; \\max_{m \\in \\{1,2\\}, \\, k \\in \\{1,2\\}} \\left| \\mathrm{FEVD}^{\\mathrm{L}}_{m,k}(h) \\;-\\; \\mathrm{FEVD}^{\\mathrm{VECM}}_{m,k}(h) \\right|\n$$\n这是来自设定错误的VAR($1$)模型的FEVD矩阵与来自正确设定的VECM($2$)模型的FEVD矩阵之间的逐元素绝对差的最大值。\n\n对于案例B，短期动态矩阵 $\\Gamma_1$ 是零矩阵。这意味着 $A_2 = \\mathbf{0}$ 并且 $A_1 = I_2 + \\Pi = A_1^{\\mathrm{L}}$。因此，VAR($2$)模型的设定简化为VAR($1$)的设定。两个模型的MA系数 $\\Psi_i$ 将完全相同，从而导致相同的FEVD。因此，对于案例B，$\\Delta$ 理论上应为 $0$，这可以作为我们计算过程的一个对照检查。\n\n要实现的算法如下：\n1. 对于每个参数集 $(\\alpha, \\beta, \\Gamma_1, \\Sigma, h)$：\n2. 为VECM($2$)和VAR($1$)模型构建VAR系数矩阵。\n3. 定义一个计算FEVD矩阵的函数，该函数以VAR系数矩阵、$\\Sigma$ 和 $h$ 作为输入。此函数将：\n    a. 迭代计算直到 $h-1$ 期的MA响应矩阵 $\\Psi_i$。\n    b. 计算 $\\Sigma$ 的Cholesky因子 $P$。\n    c. 计算正交化响应 $\\Theta_i = \\Psi_i P$。\n    d. 在整个期内对 $\\Theta_i$ 的平方元素求和，以获得FEVD的分子。\n    e. 进行归一化以获得最终的FEVD矩阵。\n4. 对两个模型调用此函数，以获得 $\\mathrm{FEVD}^{\\mathrm{VECM}}$ 和 $\\mathrm{FEVD}^{\\mathrm{L}}$。\n5. 计算两个FEVD矩阵之间绝对差的最大值作为 $\\Delta$。\n6. 存储并格式化三个案例的结果。", "answer": "```python\nimport numpy as np\n\ndef compute_fevd(A_coeffs, Sigma, h):\n    \"\"\"\n    Computes the Forecast Error Variance Decomposition (FEVD) for a VAR(p) model.\n\n    Args:\n        A_coeffs (list of np.ndarray): List of VAR coefficient matrices [A_1, ..., A_p].\n        Sigma (np.ndarray): Covariance matrix of the innovations.\n        h (int): Forecast horizon.\n\n    Returns:\n        np.ndarray: A KxK matrix of FEVD values.\n    \"\"\"\n    K = Sigma.shape[0]\n    p = len(A_coeffs)\n    I_k = np.identity(K)\n\n    # Step 1: Compute MA (Psi) coefficients using pre-multiplication\n    Psi = [np.zeros((K, K)) for _ in range(h)]\n    if h > 0:\n      Psi[0] = I_k\n      \n    for i in range(1, h):\n        new_psi = np.zeros((K, K))\n        for j in range(1, p + 1):\n            if i - j >= 0:\n                new_psi += A_coeffs[j - 1] @ Psi[i - j]\n        Psi[i] = new_psi\n\n    # Step 2: Orthogonalize impulse responses\n    P = np.linalg.cholesky(Sigma)\n    Theta = [psi @ P for psi in Psi]\n\n    # Step 3: Compute FEVD\n    # Sum of squared orthogonalized impulse responses\n    # numerator_matrix[m, k] = sum_{i=0 to h-1} (Theta_i[m, k])^2\n    Theta_sq = [th**2 for th in Theta]\n    numerator_matrix = np.sum(Theta_sq, axis=0)\n\n    # Total forecast error variance for each variable\n    # S_m = sum_{k=1 to K} numerator_matrix[m, k]\n    S_m = np.sum(numerator_matrix, axis=1)\n\n    # FEVD[m, k] = numerator_matrix[m, k] / S_m[m]\n    # Use broadcasting to divide each row by the corresponding element in S_m\n    fevd_matrix = numerator_matrix / S_m[:, np.newaxis]\n\n    return fevd_matrix\n\ndef solve():\n    \"\"\"\n    Solves the problem for the three given test cases.\n    \"\"\"\n    test_cases = [\n        # Case A\n        {\n            \"alpha\": np.array([[-0.3], [0.2]]),\n            \"beta\": np.array([[1], [-1]]),\n            \"Gamma1\": np.array([[0.4, -0.1], [0.05, 0.2]]),\n            \"Sigma\": np.array([[1.0, 0.5], [0.5, 1.5]]),\n            \"h\": 10,\n        },\n        # Case B\n        {\n            \"alpha\": np.array([[-0.4], [0.3]]),\n            \"beta\": np.array([[1], [-1.2]]),\n            \"Gamma1\": np.array([[0.0, 0.0], [0.0, 0.0]]),\n            \"Sigma\": np.array([[1.0, 0.3], [0.3, 0.8]]),\n            \"h\": 12,\n        },\n        # Case C\n        {\n            \"alpha\": np.array([[-0.6], [0.45]]),\n            \"beta\": np.array([[1], [-0.8]]),\n            \"Gamma1\": np.array([[0.3, -0.12], [0.08, 0.22]]),\n            \"Sigma\": np.array([[0.7, 0.4], [0.4, 1.2]]),\n            \"h\": 16,\n        },\n    ]\n\n    results = []\n    \n    I_2 = np.identity(2)\n\n    for case in test_cases:\n        alpha = case[\"alpha\"]\n        beta = case[\"beta\"]\n        Gamma1 = case[\"Gamma1\"]\n        Sigma = case[\"Sigma\"]\n        h = case[\"h\"]\n        \n        Pi = alpha @ beta.T\n\n        # Model 1: Correctly specified VECM(2) as VAR(2)\n        A1_vecm = I_2 + Pi + Gamma1\n        A2_vecm = -Gamma1\n        fevd_vecm = compute_fevd([A1_vecm, A2_vecm], Sigma, h)\n\n        # Model 2: Misspecified VAR(1) in levels\n        A1_l = I_2 + Pi\n        fevd_l = compute_fevd([A1_l], Sigma, h)\n\n        # Calculate the maximum absolute difference\n        delta = np.max(np.abs(fevd_l - fevd_vecm))\n        results.append(delta)\n\n    # Final print statement in the exact required format.\n    # [0.098481,0.000000,0.134267]\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2394618"}]}