{"hands_on_practices": [{"introduction": "在深入复杂的计算之前，掌握脉冲响应函数 (Impulse Response Functions, IRF) 的解析基础至关重要。第一个练习 [@problem_id:2400804] 将指导你为一个标准的二阶自回归 ($AR(2)$) 过程推导出其脉冲响应函数的闭合形式表达式。通过这个过程，你将揭示模型特征根与响应动态形状（无论是平滑衰减还是振荡）之间的根本联系。", "problem": "考虑一个用于计算经济学和金融学中概括对冲击的动态响应的单变量、协方差平稳的2阶自回归过程（简记为AR(2)）：\n$$\ny_{t} = \\phi_{1} y_{t-1} + \\phi_{2} y_{t-2} + \\epsilon_{t},\n$$\n其中 $\\{\\epsilon_{t}\\}$ 是一个均值为零、方差有限且序列不相关的创新序列，$\\phi_{1}$ 和 $\\phi_{2}$ 是保证该过程协方差平稳的实数参数。定义脉冲响应函数 (IRF) $\\{\\psi_{h}\\}_{h \\ge 0}$ 为当系统在冲击前处于静止状态时（即 $y_{-1}=y_{-2}=0$ 且 $\\epsilon_{0}=1$, 对所有 $t \\ne 0$ 有 $\\epsilon_{t}=0$）对时间 $t=0$ 发生的一次性单位创新的响应序列 $y_{h}$。设 $r_{1}$ 和 $r_{2}$ 表示特征方程\n$$\nr^{2} - \\phi_{1} r - \\phi_{2} = 0\n$$\n的两个不相等的实根。推导IRF系数 $\\psi_{h}$ 对任意整数期界 $h \\ge 0$ 的一个用 $r_{1}$、$r_{2}$ 和 $h$ 表示的闭式表达式。用文字简要说明IRF的定性形状如何取决于 $r_{1}$ 和 $r_{2}$ 的符号和大小。你的最终答案必须是 $\\psi_{h}$ 的一个用 $r_{1}$、$r_{2}$ 和 $h$ 表示的单一解析表达式。无需进行数值近似。", "solution": "题目陈述经过验证。\n\n步骤1：提取已知条件。\n- 模型是一个单变量、协方差平稳的2阶自回归过程，AR(2)：$y_{t} = \\phi_{1} y_{t-1} + \\phi_{2} y_{t-2} + \\epsilon_{t}$。\n- 创新项 $\\{\\epsilon_{t}\\}$ 是一个均值为零、方差有限且序列不相关的随机变量序列。\n- 参数 $\\phi_{1}$ 和 $\\phi_{2}$ 是确保协方差平稳性的实常数。\n- 脉冲响应函数 (IRF)，$\\{\\psi_{h}\\}_{h \\ge 0}$，定义为对 $t=0$ 时刻的一次性单位冲击的响应序列 $y_{h}$。\n- IRF的初始条件是 $y_{-1}=0$ 和 $y_{-2}=0$。\n- 冲击被指定为 $\\epsilon_{0}=1$ 且对所有整数 $t \\ne 0$ 有 $\\epsilon_{t}=0$。\n- 特征方程是 $r^{2} - \\phi_{1} r - \\phi_{2} = 0$。\n- 特征方程的根 $r_1$ 和 $r_2$ 被指定为实数且不相等。\n\n步骤2：使用提取的已知条件进行验证。\n- 该问题具有**科学依据**。它涉及时间序列分析和计量经济学中的一个基本概念——AR(2)过程的脉冲响应函数。这是该领域的标准课题。\n- 该问题是**适定的**。它提供了推导唯一、有意义解所需的所有必要信息（模型、初始条件、冲击设定以及特征根的性质）。\n- 该问题是**客观的**。其语言精确，没有主观或模糊的术语。\n- 该问题内部一致且完整。协方差平稳性的假设意味着特征根 $r_1, r_2$ 必须位于单位圆内，即 $|r_1|1$ 和 $|r_2|1$，这确保了IRF收敛到零。这是一个非爆炸性系统的标准且必要条件。\n\n步骤3：结论与行动。\n问题有效。下面将给出解的严格推导。\n\n脉冲响应函数系数，记为 $\\psi_{h}$，定义为系统变量 $y_t$ 在时间 $t=h$ 时对时间 $t=0$ 的单位冲击的响应，且系统在冲击前处于静止状态。形式上，$\\psi_{h} \\equiv y_{h}$，给定 $t0$ 时 $y_t=0$，$\\epsilon_0=1$，以及 $t \\ne 0$ 时 $\\epsilon_t=0$。\n\n将这些条件代入AR(2)方程，得到IRF系数的动态路径：\n$$\n\\psi_{h} = \\phi_{1} \\psi_{h-1} + \\phi_{2} \\psi_{h-2} \\quad \\text{for } h \\ge 2\n$$\n这是一个齐次二阶线性差分方程。与此差分方程相关的特征方程在问题陈述中给出为：\n$$\nr^{2} - \\phi_{1} r - \\phi_{2} = 0\n$$\n问题指定该方程的根 $r_1$ 和 $r_2$ 是实数且不相等。因此，$\\psi_h$ 的通解形式为：\n$$\n\\psi_{h} = c_{1} r_{1}^{h} + c_{2} r_{2}^{h}\n$$\n其中 $c_1$ 和 $c_2$ 是待定常数，将根据脉冲响应序列的初始条件确定。\n\n我们必须求出IRF的前两个值，$\\psi_0$ 和 $\\psi_1$。\n对于 $h=0$：\n$$\n\\psi_{0} = y_{0} = \\phi_{1} y_{-1} + \\phi_{2} y_{-2} + \\epsilon_{0} = \\phi_{1}(0) + \\phi_{2}(0) + 1 = 1\n$$\n对于 $h=1$：\n$$\n\\psi_{1} = y_{1} = \\phi_{1} y_{0} + \\phi_{2} y_{-1} + \\epsilon_{1} = \\phi_{1} \\psi_{0} + \\phi_{2}(0) + 0 = \\phi_{1}(1) = \\phi_{1}\n$$\n因此，差分方程的初始条件是 $\\psi_0 = 1$ 和 $\\psi_1 = \\phi_1$。\n\n现在我们用这些条件来求解 $c_1$ 和 $c_2$：\n对于 $h=0$：$\\psi_{0} = c_{1} r_{1}^{0} + c_{2} r_{2}^{0} \\implies c_{1} + c_{2} = 1$。\n对于 $h=1$：$\\psi_{1} = c_{1} r_{1}^{1} + c_{2} r_{2}^{1} \\implies c_{1} r_{1} + c_{2} r_{2} = \\phi_{1}$。\n\n这是一个关于两个变量 $c_1$ 和 $c_2$ 的二元线性方程组。由第一个方程得 $c_2 = 1 - c_1$。将其代入第二个方程：\n$$\nc_{1} r_{1} + (1 - c_{1}) r_{2} = \\phi_{1}\n$$\n$$\nc_{1} (r_{1} - r_{2}) = \\phi_{1} - r_{2}\n$$\n$$\nc_{1} = \\frac{\\phi_{1} - r_{2}}{r_{1} - r_{2}}\n$$\n对于 $c_2$：\n$$\nc_{2} = 1 - c_{1} = 1 - \\frac{\\phi_{1} - r_{2}}{r_{1} - r_{2}} = \\frac{(r_{1} - r_{2}) - (\\phi_{1} - r_{2})}{r_{1} - r_{2}} = \\frac{r_{1} - \\phi_{1}}{r_{1} - r_{2}}\n$$\n为简化这些表达式，我们使用二次特征方程 $r^2 - \\phi_1 r - \\phi_2 = 0$ 的韦达定理。两根之和为 $r_1 + r_2 = \\phi_1$。将 $\\phi_1 = r_1 + r_2$ 代入 $c_1$ 和 $c_2$ 的表达式中：\n$$\nc_{1} = \\frac{(r_{1} + r_{2}) - r_{2}}{r_{1} - r_{2}} = \\frac{r_{1}}{r_{1} - r_{2}}\n$$\n$$\nc_{2} = \\frac{r_{1} - (r_{1} + r_{2})}{r_{1} - r_{2}} = \\frac{-r_{2}}{r_{1} - r_{2}}\n$$\n现在，将这些系数代回 $\\psi_h$ 的通解中：\n$$\n\\psi_{h} = \\left( \\frac{r_{1}}{r_{1} - r_{2}} \\right) r_{1}^{h} + \\left( \\frac{-r_{2}}{r_{1} - r_{2}} \\right) r_{2}^{h}\n$$\n合并各项，得到IRF系数 $\\psi_h$ 对任意整数期界 $h \\ge 0$ 的最终闭式表达式：\n$$\n\\psi_{h} = \\frac{r_{1}^{h+1} - r_{2}^{h+1}}{r_{1} - r_{2}}\n$$\n该表达式可被看作是比内公式的一个变体，比内公式是斐波那契数列的一个特例。\n\n关于IRF的定性形状：过程的协方差平稳性要求特征多项式的根位于单位圆内。由于根 $r_1, r_2$ 是实数，这意味着 $-1  r_{1,2}  1$。此条件确保 $\\lim_{h \\to \\infty} \\psi_h = 0$，意味着冲击的影响是暂时的。衰减的形状取决于根的符号。\n1.  如果两个根都是正数（$0  r_2  r_1  1$），则IRF系数 $\\psi_h$ 总是正数，并单调衰减至零。冲击具有持续但递减的正向效应。\n2.  如果根的符号相反（例如 $-1  r_2  0  r_1  1$），项 $r_2^h$ 的符号会交替变化。因此，IRF在衰减至零的过程中会表现出振荡。响应最初可能增加或减少，并可能多次穿过零轴。\n3.  如果两个根都是负数（$-1  r_2  r_1  0$），$r_1^h$ 和 $r_2^h$ 的符号都会交替变化。IRF将从 $\\psi_0=1$ 开始，在 $\\psi_1 = r_1+r_2  0$ 时变为负数，在 $\\psi_2 = r_1^2 + r_1 r_2 + r_2^2 > 0$ 时变为正数，依此类推。这会产生一种向零的显著振荡衰减。", "answer": "$$\n\\boxed{\\frac{r_{1}^{h+1} - r_{2}^{h+1}}{r_{1} - r_{2}}}\n$$", "id": "2400804"}, {"introduction": "虽然解析解能提供深刻的洞见，但大多数现实世界模型过于复杂，难以求得解析解，这使得数值方法变得不可或缺。这个练习 [@problem_id:2373828] 将带你从理论走向计算实践，要求你通过递归方式为一个三阶自回归 ($AR(3)$) 模型生成脉冲响应函数。这种迭代模拟是现代计量经济学中计算任何线性模型IRF的主力算法。", "problem": "给定一个由下式定义的 $3$ 阶单变量自回归 (AR) 模型：\n$$\ny_t \\;=\\; \\phi_1\\,y_{t-1} \\;+\\; \\phi_2\\,y_{t-2} \\;+\\; \\phi_3\\,y_{t-3} \\;+\\; \\varepsilon_t,\n$$\n其中 $\\{\\varepsilon_t\\}$ 是一个零均值和有限方差的白噪声序列。考虑在时间 $t=0$ 时的一次性单位脉冲，即 $\\varepsilon_0 = 1$ 且对于所有 $t \\neq 0$ 都有 $\\varepsilon_t = 0$，并施加零初始条件 $y_{-1} = y_{-2} = y_{-3} = 0$。脉冲响应函数 (IRF) 是序列 $\\{\\psi_h\\}_{h=0}^H$，其中 $\\psi_h$ 是在这些条件下，系统在时期 $h$ 对时间 $0$ 的脉冲的响应。对于下面测试套件中的每组参数，请数值化地构建直至指定有限时期 $H$ 的脉冲响应函数。尽管可视化是标准分析的一部分，但对于本任务，您必须提供数值化的 IRF 值；您可能进行的任何绘图都不是所要求输出的一部分。\n\n测试套件：\n- 情况 A (稳定，单调)：$\\phi_1 = 0.7$，$\\phi_2 = -0.14$，$\\phi_3 = 0.008$，$H = 10$。\n- 情况 B (稳定，振荡)：$\\phi_1 = 1.1$，$\\phi_2 = -0.88$，$\\phi_3 = 0.192$，$H = 12$。\n- 情况 C (高持续性，$1$ 阶 AR 特例)：$\\phi_1 = 0.98$，$\\phi_2 = 0.0$，$\\phi_3 = 0.0$，$H = 10$。\n\n要求：\n- 对于每种情况，仅使用模型定义、给定的冲击和初始条件来计算 IRF 向量 $\\left[\\psi_0,\\psi_1,\\dots,\\psi_H\\right]$。\n- 将每个实数四舍五入到恰好 $6$ 位小数。\n- 最终输出格式：您的程序必须生成单行文本，其中包含一个顶级列表，该列表包含三个列表（每个情况一个），并且没有任何空格。内部列表的长度必须为 $H+1$，并按时期 $h=0,1,\\dots,H$ 的顺序排列。例如，一个包含三个列表的输出应如下所示：`[[\\cdot,\\cdot],[\\cdot],[\\cdot]]`，数字和列表之间用逗号分隔，没有空格，每个数字打印时小数点后恰好有 $6$ 位数字。\n\n您的程序必须按此确切顺序为以下三种测试情况实现上述要求：情况 A、情况 B、情况 C。唯一可接受的输出是包含指定嵌套列表的单行文本；请勿输出任何其他文本或字符。", "solution": "问题陈述已经过验证，并被认定为有效。它在科学上基于线性时间序列模型理论，特别是自回归 (AR) 过程。该问题定义明确，提供了所有必要的参数、初始条件和明确的目标。给定测试用例的参数对应于稳定的 AR 过程，确保了有意义的、衰减的脉冲响应。语言客观而精确。因此，我将继续提供完整的解决方案。\n\n该问题要求对一个记为 AR($3$) 的 $3$ 阶单变量自回归模型进行脉冲响应函数 (IRF) 的数值计算。该模型由以下方程指定：\n$$\ny_t = \\phi_1 y_{t-1} + \\phi_2 y_{t-2} + \\phi_3 y_{t-3} + \\varepsilon_t\n$$\n其中 $\\{\\varepsilon_t\\}$ 是一个白噪声过程，其均值为零，$E[\\varepsilon_t] = 0$，且方差有限。\n\nIRF，用序列 $\\{\\psi_h\\}_{h=0}^\\infty$ 表示，描述了在假设系统在冲击前处于均衡状态（零）的情况下，过程 $\\{y_t\\}$ 对时间 $t=0$ 的单次冲击的演变。指定的条件是：\n1.  时间 $t=0$ 时的单位脉冲：$\\varepsilon_0 = 1$ 且对于所有 $t \\neq 0$ 都有 $\\varepsilon_t=0$。\n2.  零初始条件：对于所有 $t  0$ 都有 $y_t = 0$。特别地，$y_{-1} = y_{-2} = y_{-3} = 0$。\n\n在这些特定条件下，IRF 系数 $\\psi_h$ 就是过程 $y_h$ 的值，即对于 $h \\ge 0$ 有 $\\psi_h \\equiv y_h$。我们可以递归地计算这些值。\n\n对于时期 $h=0$：\n$$\n\\psi_0 = y_0 = \\phi_1 y_{-1} + \\phi_2 y_{-2} + \\phi_3 y_{-3} + \\varepsilon_0\n$$\n代入初始条件和脉冲值：\n$$\n\\psi_0 = \\phi_1(0) + \\phi_2(0) + \\phi_3(0) + 1 = 1\n$$\n单位冲击对过程的瞬时影响恒为 1。\n\n对于任何时期 $h > 0$：\n$$\n\\psi_h = y_h = \\phi_1 y_{h-1} + \\phi_2 y_{h-2} + \\phi_3 y_{h-3} + \\varepsilon_h\n$$\n由于当 $h > 0$ 时 $\\varepsilon_h=0$ 且当 $k \\ge 0$ 时 $y_k=\\psi_k$：\n$$\n\\psi_h = \\phi_1 \\psi_{h-1} + \\phi_2 \\psi_{h-2} + \\phi_3 \\psi_{h-3}\n$$\n这是一个关于 IRF 系数（当 $h \\ge 1$ 时）的线性齐次递推关系。此递推的初始值源自样本前历史和初始冲击 $\\psi_0$。我们可以正式定义当 $k  0$ 时 $\\psi_k = 0$。这使得计算可以统一进行。\n\n让我们明确地计算前几项：\n-   $\\psi_0 = 1$\n-   $\\psi_1 = \\phi_1 \\psi_0 + \\phi_2 \\psi_{-1} + \\phi_3 \\psi_{-2} = \\phi_1 (1) + \\phi_2(0) + \\phi_3(0) = \\phi_1$\n-   $\\psi_2 = \\phi_1 \\psi_1 + \\phi_2 \\psi_0 + \\phi_3 \\psi_{-1} = \\phi_1(\\phi_1) + \\phi_2(1) + \\phi_3(0) = \\phi_1^2 + \\phi_2$\n-   $\\psi_3 = \\phi_1 \\psi_2 + \\phi_2 \\psi_1 + \\phi_3 \\psi_0 = \\phi_1(\\phi_1^2+\\phi_2) + \\phi_2(\\phi_1) + \\phi_3(1) = \\phi_1^3 + 2\\phi_1\\phi_2 + \\phi_3$\n-   对于 $h \\ge 3$，递推仅使用先前计算过的正指数 $\\psi$ 项：$\\psi_h = \\phi_1 \\psi_{h-1} + \\phi_2 \\psi_{h-2} + \\phi_3 \\psi_{h-3}$。\n\n数值算法是这种递归计算的直接实现。对于一个 AR($p$) 模型（此处 $p=3$），我们需要维持过程最后 $p$ 个值的历史记录来计算下一个值。我们可以使用一个大小为 $H+1+p$ 的数组（例如 `y_ext`）来存储从时间 $t=-p$ 到 $t=H$ 的过程的完整历史。\n\n每个测试用例的算法如下：\n1.  定义参数 $\\boldsymbol{\\phi} = [\\phi_1, \\phi_2, \\phi_3]$ 和时期 $H$。过程的阶数为 $p=3$。\n2.  初始化一个大小为 $H+1+p$ 的数值数组 `y_ext`，所有元素设置为零。这自动满足了零初始条件 $y_{-1}=y_{-2}=y_{-3}=0$，它们对应于 `y_ext` 的索引 $p-1, p-2, \\dots, 0$。\n3.  从时间 $t=0$ 迭代到 $H$。值 $y_t$ 将存储在 `y_ext` 的索引 $t+p$ 处。\n4.  在每次迭代 $t$ 中：\n    a.  定义冲击 $\\varepsilon_t$。如果 $t=0$，则为 $1$，否则为 $0$。\n    b.  使用 AR($3$) 公式计算 $y_t$。这涉及到参数向量 $\\boldsymbol{\\phi}$ 与过程最后 $p$ 个值的向量 $[y_{t-1}, y_{t-2}, y_{t-3}]$ 之间的点积。这些过去的值从 `y_ext` 数组中检索。\n    c.  将冲击 $\\varepsilon_t$ 加到结果上。\n    d.  将计算出的 $y_t$ 存储在 `y_ext` 的索引 $t+p$ 处。\n5.  循环完成后，IRF 序列 $\\{\\psi_0, \\psi_1, \\dots, \\psi_H\\}$ 对应于值 $\\{y_0, y_1, \\dots, y_H\\}$，这些值存储在 `y_ext` 中从索引 $p$ 到 $p+H$ 的位置。\n6.  按照要求，将最终的数值格式化为 $6$ 位小数。\n此过程应用于问题陈述中提供的三个测试用例中的每一个。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_irf(phis, H):\n    \"\"\"\n    Computes the Impulse Response Function (IRF) for an AR model.\n\n    Args:\n        phis (np.ndarray): Array of AR coefficients [phi_1, phi_2, ...].\n        H (int): The horizon for the IRF calculation (computes up to psi_H).\n\n    Returns:\n        np.ndarray: The IRF sequence [psi_0, psi_1, ..., psi_H].\n    \"\"\"\n    p = len(phis)\n    # Extended history array to hold pre-sample values (y_{-p} to y_{-1})\n    # and the IRF values (y_0 to y_H).\n    # Indices 0 to p-1 hold y_{-p} to y_{-1}.\n    # Indices p to p+H hold y_0 to y_H.\n    y_ext = np.zeros(H + 1 + p)\n\n    # The initial conditions y_t=0 for t0 are satisfied by np.zeros.\n\n    # Iterate from t=0 to H to compute the IRF.\n    for t in range(H + 1):\n        idx = t + p\n        \n        # Unit impulse at t=0.\n        epsilon = 1.0 if t == 0 else 0.0\n        \n        # The vector of past y values: [y_{t-1}, y_{t-2}, ..., y_{t-p}]\n        # These correspond to y_ext[idx-1], y_ext[idx-2], ..., y_ext[idx-p].\n        # The slice y_ext[t:t+p] gets y_{t-p},...,y_{t-1}. We reverse it for dot product.\n        past_y = y_ext[t:t+p][::-1]\n\n        # Compute y_t = sum(phi_i * y_{t-i}) + epsilon_t\n        y_ext[idx] = np.dot(phis, past_y) + epsilon\n\n    # The IRF is the sequence y_0, ..., y_H, which is stored from index p.\n    return y_ext[p:]\n\ndef solve():\n    \"\"\"\n    Solves the problem for the given test cases and prints the result\n    in the specified format.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A (stable, monotone)\n        {'phis': [0.7, -0.14, 0.008], 'H': 10},\n        # Case B (stable, oscillatory)\n        {'phis': [1.1, -0.88, 0.192], 'H': 12},\n        # Case C (high persistence, AR(1) special case)\n        {'phis': [0.98, 0.0, 0.0], 'H': 10},\n    ]\n\n    all_results_str = []\n    \n    for case in test_cases:\n        phis_list = case['phis']\n        # Pad with zeros if fewer than 3 phis are given (as in Case C)\n        # to maintain a consistent AR(3) structure.\n        while len(phis_list)  3:\n            phis_list.append(0.0)\n\n        phis = np.array(phis_list)\n        H = case['H']\n        \n        irf_values = compute_irf(phis, H)\n        \n        # Format the numbers to exactly 6 decimal places.\n        formatted_irf = [\"{:.6f}\".format(v) for v in irf_values]\n        # Create the string for a single case's list, e.g., \"[num1,num2,...]\"\n        case_result_str = \"[\" + \",\".join(formatted_irf) + \"]\"\n        all_results_str.append(case_result_str)\n        \n    # Join the results of all cases into a single list string, e.g., \"[[...],[...]]\"\n    # The requirement is no spaces anywhere.\n    final_output = \"[\" + \",\".join(all_results_str) + \"]\"\n\n    # Final print statement in the exact required format.\n    print(final_output)\n\nsolve()\n```", "id": "2373828"}, {"introduction": "现在，我们从单变量模型进阶到更符合现实的多变量系统，这是现代宏观经济分析的基石。这个练习 [@problem_id:2400780] 引入了结构识别的概念，即利用经济理论来区分不同类型的冲击，例如供给冲击与需求冲击。你将计算并比较累积脉冲响应，这项技术直接反映了经济学家如何使用这些模型来回答现实世界中的政策与研究问题。", "problem": "考虑一个在计算经济学和金融学中用于研究脉冲响应函数 (IRF) 的二元线性时不变离散时间结构系统：\n$$\n\\mathbf{x}_t = A \\mathbf{x}_{t-1} + B \\mathbf{e}_t,\n$$\n其中 $\\mathbf{x}_t \\in \\mathbb{R}^2$ 堆叠了变量 $\\mathbf{x}_t = \\begin{bmatrix} p^c_t \\\\ \\pi_t \\end{bmatrix}$，其中 $p^c_t$ 表示商品价格通胀，$\\pi_t$ 表示总体通胀。结构性冲击 $\\mathbf{e}_t \\in \\mathbb{R}^2$ 满足 $\\mathbb{E}[\\mathbf{e}_t] = \\mathbf{0}$ 和 $\\mathbb{E}[\\mathbf{e}_t \\mathbf{e}_t'] = I_2$。$2 \\times 2$ 矩阵 $A$ 和 $B$ 不随时间变化。结构识别如下：第一个冲击是供给侧冲击，第二个冲击是需求侧冲击，通过对商品价格的影响来识别，并带有符号约束，即 $B$ 矩阵第一列的第一个元素为负（供给侧冲击在发生时使 $p^c_t$ 下降），$B$ 矩阵第二列的第一个元素为正（需求侧冲击在发生时使 $p^c_t$ 上升）。\n\n对于在时间 $t=0$ 发生的一次性的 $j \\in \\{1,2\\}$ 型单位结构性冲击，$\\mathbf{x}_{h}$ 在 $h \\in \\{0,1,2,\\ldots\\}$ 期的脉冲响应函数 (IRF) 定义为\n$$\n\\mathrm{IRF}_j(h) = A^h \\mathbf{b}_j,\n$$\n其中 $\\mathbf{b}_j$ 是 $B$ 的第 $j$ 列。在 $h$ 期，通胀对冲击 $j$ 的脉冲响应函数是 $\\mathrm{IRF}_j(h)$ 的第二个分量，即 $\\left[\\mathrm{IRF}_j(h)\\right]_2$。\n\n对于下面的每个参数集，将需求侧冲击在 $h = 0,1,\\ldots,H$ 各期的累积通胀响应定义为\n$$\nC^{\\text{dem}} = \\sum_{h=0}^{H} \\left[\\mathrm{IRF}_2(h)\\right]_2,\n$$\n并将供给侧冲击的累积通胀响应定义为\n$$\nC^{\\text{sup}} = \\sum_{h=0}^{H} \\left[\\mathrm{IRF}_1(h)\\right]_2.\n$$\n计算比较标量\n$$\n\\Delta = C^{\\text{dem}} - C^{\\text{sup}}.\n$$\n\n你的任务是编写一个完整程序，为下列每个参数集计算作为实数的 $\\Delta$。不涉及物理单位。\n\n测试套件（每个案例指定 $A$、$B$ 和 $H$）：\n1. 案例 1:\n   $$\n   A = \\begin{bmatrix} 0.6  0.0 \\\\ 0.2  0.5 \\end{bmatrix}, \\quad\n   B = \\begin{bmatrix} -0.5  0.6 \\\\ 0.1  0.3 \\end{bmatrix}, \\quad\n   H = 20.\n   $$\n2. 案例 2:\n   $$\n   A = \\begin{bmatrix} 0.9  0.0 \\\\ 0.1  0.95 \\end{bmatrix}, \\quad\n   B = \\begin{bmatrix} -0.2  0.2 \\\\ 0.05  0.25 \\end{bmatrix}, \\quad\n   H = 40.\n   $$\n3. 案例 3（$A$ 中存在重复特征值的边界条件）：\n   $$\n   A = \\begin{bmatrix} 0.8  0.0 \\\\ 0.3  0.8 \\end{bmatrix}, \\quad\n   B = \\begin{bmatrix} -0.3  0.3 \\\\ 0.02  0.15 \\end{bmatrix}, \\quad\n   H = 30.\n   $$\n4. 案例 4:\n   $$\n   A = \\begin{bmatrix} 0.2  0.0 \\\\ 0.5  0.3 \\end{bmatrix}, \\quad\n   B = \\begin{bmatrix} -0.1  0.1 \\\\ 0.0  0.1 \\end{bmatrix}, \\quad\n   H = 10.\n   $$\n\n你的程序必须为每个案例计算 $\\Delta$，并生成单行输出，其中包含四个结果，按案例顺序列出，形式为方括号括起来的逗号分隔浮点数列表。每个浮点数表示为小数点后六位。例如，包含四个结果的输出应如下所示\n$$\n[\\delta_1,\\delta_2,\\delta_3,\\delta_4],\n$$\n其中每个 $\\delta_i$ 表示为案例 $i$ 计算出的 $\\Delta$ 值，保留小数点后六位。", "solution": "所述问题定义严谨、自成体系，并且与应用于计算计量经济学的线性系统理论原理一致。未检测到不一致或谬误之处。因此，我们可以进行形式化求解。\n\n该问题要求计算一个标量 $\\Delta$，它表示总体通胀（$\\pi_t$）对需求侧冲击和供给侧冲击的累积脉冲响应之差。系统动态由以下线性模型决定：\n$$\n\\mathbf{x}_t = A \\mathbf{x}_{t-1} + B \\mathbf{e}_t\n$$\n其中 $\\mathbf{x}_t = \\begin{bmatrix} p^c_t \\\\ \\pi_t \\end{bmatrix}$。\n\n脉冲响应函数 $\\mathrm{IRF}_j(h)$ 衡量了在时间 $t=0$ 发生的一次 $j \\in \\{1, 2\\}$ 型单位结构性冲击对 $h$ 期状态向量 $\\mathbf{x}_h$ 的影响。它由以下公式给出：\n$$\n\\mathrm{IRF}_j(h) = A^h \\mathbf{b}_j\n$$\n其中 $\\mathbf{b}_j$ 是矩阵 $B$ 的第 $j$ 列。冲击 $j=1$ 对应供给侧冲击，冲击 $j=2$ 对应需求侧冲击。\n\n我们关心的是第二个变量，即总体通胀 $\\pi_t$ 的响应。为了从向量 $\\mathrm{IRF}_j(h)$ 中提取这个分量，我们使用标准基向量 $\\mathbf{e}_2' = \\begin{bmatrix} 0  1 \\end{bmatrix}$。在 $h$ 期，通胀对冲击 $j$ 的响应为：\n$$\n[\\mathrm{IRF}_j(h)]_2 = \\mathbf{e}_2' \\mathrm{IRF}_j(h) = \\mathbf{e}_2' A^h \\mathbf{b}_j\n$$\n\n问题定义了在 $h=0, 1, \\ldots, H$ 各期上的累积通胀响应。对需求侧冲击（$j=2$）的累积响应为：\n$$\nC^{\\text{dem}} = \\sum_{h=0}^{H} [\\mathrm{IRF}_2(h)]_2 = \\sum_{h=0}^{H} \\mathbf{e}_2' A^h \\mathbf{b}_2\n$$\n对供给侧冲击（$j=1$）的累积响应为：\n$$\nC^{\\text{sup}} = \\sum_{h=0}^{H} [\\mathrm{IRF}_1(h)]_2 = \\sum_{h=0}^{H} \\mathbf{e}_2' A^h \\mathbf{b}_1\n$$\n\n根据矩阵运算的线性性质，我们可以从求和中提出常数项：\n$$\nC^{\\text{dem}} = \\mathbf{e}_2' \\left( \\sum_{h=0}^{H} A^h \\right) \\mathbf{b}_2\n$$\n$$\nC^{\\text{sup}} = \\mathbf{e}_2' \\left( \\sum_{h=0}^{H} A^h \\right) \\mathbf{b}_1\n$$\n\n目标量为 $\\Delta = C^{\\text{dem}} - C^{\\text{sup}}$。代入上面的表达式：\n$$\n\\Delta = \\mathbf{e}_2' \\left( \\sum_{h=0}^{H} A^h \\right) \\mathbf{b}_2 - \\mathbf{e}_2' \\left( \\sum_{h=0}^{H} A^h \\right) \\mathbf{b}_1\n$$\n再次提取公因子得到一个更紧凑的表达式：\n$$\n\\Delta = \\mathbf{e}_2' \\left( \\sum_{h=0}^{H} A^h \\right) (\\mathbf{b}_2 - \\mathbf{b}_1)\n$$\n这是我们计算的基本方程。\n\n项 $\\sum_{h=0}^{H} A^h$ 是一个有限矩阵几何级数。直接的迭代求和在计算上是有效的，但效率低下。一种更优雅且在数值上更优的方法是使用几何级数和的闭式解。设 $S_H = \\sum_{h=0}^{H} A^h = I + A + A^2 + \\dots + A^H$。那么我们有 $(I - A)S_H = (I - A)(I + A + \\dots + A^H) = I - A^{H+1}$。\n如果矩阵 $(I - A)$ 是可逆的，我们可以写成：\n$$\nS_H = (I - A^{H+1}) (I - A)^{-1}\n$$\n如果 $1$ 不是 $A$ 的特征值，则 $(I - A)$ 的可逆性得到保证。对于给定的经济系统，稳定性要求 $A$ 的所有特征值都位于单位圆内，这意味着它们的模严格小于 $1$。对所提供的矩阵 $A$ 的检查证实，所有测试案例都满足此条件。因此，使用此闭式表达式是合理且正确的。\n\n因此，$\\Delta$ 的最终计算公式为：\n$$\n\\Delta = \\mathbf{e}_2' \\left[ (I - A^{H+1}) (I - A)^{-1} \\right] (\\mathbf{b}_2 - \\mathbf{b}_1)\n$$\n\n每个测试案例的算法如下：\n$1$. 给定矩阵 $A \\in \\mathbb{R}^{2 \\times 2}$、$B \\in \\mathbb{R}^{2 \\times 2}$ 和整数期数 $H$。\n$2$. 从 $B$ 中提取列向量 $\\mathbf{b}_1$ 和 $\\mathbf{b}_2$。\n$3$. 计算差向量 $\\mathbf{b}_{\\text{diff}} = \\mathbf{b}_2 - \\mathbf{b}_1$。\n$4$. 计算矩阵幂 $A^{H+1}$。\n$5$. 计算逆矩阵 $(I - A)^{-1}$，其中 $I$ 是 $2 \\times 2$ 的单位矩阵。\n$6$. 计算矩阵和 $S_H = (I - A^{H+1}) (I - A)^{-1}$。\n$7$. 计算结果向量 $\\mathbf{v} = S_H \\mathbf{b}_{\\text{diff}}$。\n$8$. 标量 $\\Delta$ 是向量 $\\mathbf{v}$ 的第二个元素，即 $\\Delta = [\\mathbf{v}]_2$。\n\n此过程是稳健的，并将为所有指定的测试案例实施。数值精度将通过标准浮点运算处理，最终输出将按要求格式化为六位小数。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the comparison scalar Delta for each test case according to the problem definition.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"A\": np.array([[0.6, 0.0], [0.2, 0.5]]),\n            \"B\": np.array([[-0.5, 0.6], [0.1, 0.3]]),\n            \"H\": 20,\n        },\n        {\n            \"A\": np.array([[0.9, 0.0], [0.1, 0.95]]),\n            \"B\": np.array([[-0.2, 0.2], [0.05, 0.25]]),\n            \"H\": 40,\n        },\n        {\n            \"A\": np.array([[0.8, 0.0], [0.3, 0.8]]),\n            \"B\": np.array([[-0.3, 0.3], [0.02, 0.15]]),\n            \"H\": 30,\n        },\n        {\n            \"A\": np.array([[0.2, 0.0], [0.5, 0.3]]),\n            \"B\": np.array([[-0.1, 0.1], [0.0, 0.1]]),\n            \"H\": 10,\n        },\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        A = case[\"A\"]\n        B = case[\"B\"]\n        H = case[\"H\"]\n\n        # The dimension of the system, n=2.\n        n = A.shape[0]\n        I = np.identity(n)\n\n        # Extract columns of B, corresponding to supply (b1) and demand (b2) shocks.\n        b1 = B[:, 0]\n        b2 = B[:, 1]\n        \n        # Compute the difference vector b_diff = b2 - b1.\n        b_diff = b2 - b1\n\n        # The core calculation is based on the formula:\n        # Delta = e2' * [sum_{h=0 to H} A^h] * (b2 - b1)\n        # where the sum is a finite geometric series of matrices.\n        # sum_{h=0 to H} A^h = (I - A^(H+1)) * (I - A)^(-1)\n\n        # Compute A^(H+1)\n        A_pow_H1 = np.linalg.matrix_power(A, H + 1)\n\n        # Compute (I - A)^(-1)\n        I_minus_A_inv = np.linalg.inv(I - A)\n\n        # Compute the matrix sum S_H\n        S_H = (I - A_pow_H1) @ I_minus_A_inv\n\n        # Compute the cumulative response vector\n        cumulative_response_vector = S_H @ b_diff\n\n        # The scalar Delta is the second component of the response vector (inflation response).\n        delta = cumulative_response_vector[1]\n\n        results.append(delta)\n\n    # Format the final output as a comma-separated list of floats with six decimal places, enclosed in brackets.\n    output_str = f\"[{','.join(f'{r:.6f}' for r in results)}]\"\n    \n    # Final print statement in the exact required format.\n    print(output_str)\n\nsolve()\n```", "id": "2400780"}]}