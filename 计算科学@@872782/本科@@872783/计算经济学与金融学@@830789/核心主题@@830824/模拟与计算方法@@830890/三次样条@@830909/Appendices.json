{"hands_on_practices": [{"introduction": "构建三次样条的关键在于确定每个节点上的二阶导数，记为 $M_i$。本练习将让你集中实践这一过程中的基础步骤。你将为一个内部节点建立并求解其二阶导数的线性方程，这是构建任何三次样条所需的核心技能。", "problem": "函数 $S(x)$ 是一个对一组数据点进行插值的自然三次样条。根据定义，三次样条是一个由三次多项式组成的分段函数，且其本身、一阶导数和二阶导数均连续。“自然”三次样条具有一个额外的性质，即其二阶导数在插值区间的两个端点处为零。\n\n考虑一个自然三次样条 $S(x)$，它经过以下三个数据点：$(x_0, y_0) = (0, 0)$、$(x_1, y_1) = (1, 1)$ 和 $(x_2, y_2) = (2, 0)$。\n\n计算该样条在 $x=1$ 处的二阶导数值，记为 $S''(1)$。", "solution": "令 $x_{0}=0$、$x_{1}=1$、$x_{2}=2$ 且 $y_{0}=0$、$y_{1}=1$、$y_{2}=0$。对于自然三次样条，其节点处的二阶导数 $M_{i}=S''(x_{i})$ 满足 $M_{0}=0$ 和 $M_{2}=0$，且内部方程为\n$$\nh_{i-1}M_{i-1}+2(h_{i-1}+h_{i})M_{i}+h_{i}M_{i+1}\n=6\\left(\\frac{y_{i+1}-y_{i}}{h_{i}}-\\frac{y_{i}-y_{i-1}}{h_{i-1}}\\right),\n$$\n对于 $i=1,\\ldots,n-1$，其中 $h_{i}=x_{i+1}-x_{i}$。这里 $h_{0}=x_{1}-x_{0}=1$ 且 $h_{1}=x_{2}-x_{1}=1$，在 $i=1$ 处有一个唯一的内部方程：\n$$\n1\\cdot M_{0}+2(1+1)M_{1}+1\\cdot M_{2}\n=6\\left(\\frac{y_{2}-y_{1}}{1}-\\frac{y_{1}-y_{0}}{1}\\right).\n$$\n代入 $M_{0}=0$、$M_{2}=0$、$y_{2}-y_{1}=0-1=-1$ 和 $y_{1}-y_{0}=1-0=1$ 可得\n$$\n4M_{1}=6(-1-1)=6(-2)=-12,\n$$\n因此\n$$\nM_{1}=-3.\n$$\n所以 $S''(1)=M_{1}=-3$。", "answer": "$$\\boxed{-3}$$", "id": "2164958"}, {"introduction": "虽然三次样条比简单方法的计算更复杂，但其优势在实践中显而易见。本练习要求你对同一组数据点，比较分段线性插值与自然三次样条插值的结果 [@problem_id:2164958]。这种直接对比将突显出样条方法所产生的更光滑、更符合物理直觉的曲线。", "problem": "一位工程师正在为一根细柔性杆的形状建模，该杆被约束以穿过二维笛卡尔平面中的三个点：$P_0=(-1, 1)$、$P_1=(0, 0)$ 和 $P_2=(1, 1)$。提出了两种简单的模型，用于估计杆在其他水平位置 $x$ 处的垂直位置 $y$。\n\n模型A是分段线性插值，它用直线段连接指定的点。\n模型B是自然三次样条，它通过匹配内部点的一阶和二阶导数来确保曲线光滑，并且在端点处的二阶导数为零。\n\n计算由模型A和模型B预测的杆在 $x=0.5$ 处的垂直位置。设这些值分别为 $y_A$ 和 $y_B$。将您的答案表示为一对精确分数 $(y_A, y_B)$。", "solution": "我们将节点标记为 $x_{0}=-1$、$x_{1}=0$、$x_{2}=1$，对应的数值为 $y_{0}=1$、$y_{1}=0$、$y_{2}=1$。\n\n模型A（分段线性插值）：对于 $x \\in [x_{1},x_{2}]$，通过 $(0,0)$ 和 $(1,1)$ 的直线的斜率为\n$$\nm=\\frac{y_{2}-y_{1}}{x_{2}-x_{1}}=\\frac{1-0}{1-0}=1,\n$$\n所以插值函数是\n$$\ny(x)=y_{1}+m(x-x_{1})=0+1\\cdot(x-0)=x.\n$$\n在 $x=\\frac{1}{2}$ 处求值得\n$$\ny_{A}=y\\!\\left(\\frac{1}{2}\\right)=\\frac{1}{2}.\n$$\n\n模型B（自然三次样条）：设 $M_{i}=S''(x_{i})$。自然边界条件给出 $M_{0}=0$ 和 $M_{2}=0$。当 $h_{0}=x_{1}-x_{0}=1$ 且 $h_{1}=x_{2}-x_{1}=1$ 时，在内部节点 $i=1$ 处的三次样条方程组为\n$$\nh_{0}M_{0}+2(h_{0}+h_{1})M_{1}+h_{1}M_{2}=6\\left(\\frac{y_{2}-y_{1}}{h_{1}}-\\frac{y_{1}-y_{0}}{h_{0}}\\right).\n$$\n代入数值，\n$$\n1\\cdot 0+2(1+1)M_{1}+1\\cdot 0=6\\left(\\frac{1-0}{1}-\\frac{0-1}{1}\\right)=6(1-(-1))=12,\n$$\n所以\n$$\n4M_{1}=12 \\quad \\Rightarrow \\quad M_{1}=3.\n$$\n在区间 $[x_{1},x_{2}]=[0,1]$ 上，样条函数为\n$$\nS(x)=\\frac{M_{1}}{6h_{1}}(x_{2}-x)^{3}+\\frac{M_{2}}{6h_{1}}(x-x_{1})^{3}+\\left(y_{1}-\\frac{M_{1}h_{1}^{2}}{6}\\right)\\frac{x_{2}-x}{h_{1}}+\\left(y_{2}-\\frac{M_{2}h_{1}^{2}}{6}\\right)\\frac{x-x_{1}}{h_{1}}.\n$$\n当 $h_{1}=1$，$M_{1}=3$，$M_{2}=0$，$y_{1}=0$ 和 $y_{2}=1$ 时，上式简化为\n$$\nS(x)=\\frac{3}{6}(1-x)^{3}+0+\\left(0-\\frac{3}{6}\\right)(1-x)+\\left(1-0\\right)x\n=\\frac{1}{2}(1-x)^{3}-\\frac{1}{2}(1-x)+x.\n$$\n展开并合并同类项，\n$$\nS(x)=\\frac{1}{2}-\\frac{3}{2}x+\\frac{3}{2}x^{2}-\\frac{1}{2}x^{3}-\\frac{1}{2}+\\frac{1}{2}x+x\n=\\frac{3}{2}x^{2}-\\frac{1}{2}x^{3}.\n$$\n在 $x=\\frac{1}{2}$ 处求值得\n$$\ny_{B}=S\\!\\left(\\frac{1}{2}\\right)=\\frac{3}{2}\\left(\\frac{1}{2}\\right)^{2}-\\frac{1}{2}\\left(\\frac{1}{2}\\right)^{3}\n=\\frac{3}{2}\\cdot\\frac{1}{4}-\\frac{1}{2}\\cdot\\frac{1}{8}\n=\\frac{3}{8}-\\frac{1}{16}\n=\\frac{5}{16}.\n$$\n\n因此，所求的数对是 $\\left(\\frac{1}{2},\\frac{5}{16}\\right)$。", "answer": "$$\\boxed{(\\frac{1}{2}, \\frac{5}{16})}$$", "id": "2164998"}, {"introduction": "三次样条的数学要求，特别是其 $C^2$ 连续性，并非任意设定，它们具有至关重要的实际意义。本练习旨在探讨在金融背景下，当这些标准未能满足时会产生何种后果。通过检验一个缺乏一阶导数连续性的收益率曲线模型，你将发现为什么光滑性对于推导经济上合理的远期利率曲线至关重要。", "problem": "您正在使用一个分段三次函数来拟合连续复利零息收益率的期限结构，该函数旨在作为期限域 $[0,2]$（单位：年）上的三次样条，并在 $t=1$ 处有一个单一节点。考虑以下候选函数 $S:[0,2]\\to \\mathbb{R}$，其定义为\n$$\nS(t)=\n\\begin{cases}\nt^3,  t\\in[0,1],\\\\\nt^3 + (t-1),  t\\in(1,2].\n\\end{cases}\n$$\n将 $y(t)\\equiv S(t)$ 解释为期限 $t0$ 的连续复利零利率（年化）。与 $y(t)$ 相关的贴现函数 $D(t)$ 定义为\n$$\nD(t) \\equiv \\exp\\!\\Big(-\\int_0^t f(u)\\,du\\Big),\n$$\n其中 $f(t)$ 是瞬时远期利率，而连续复利零利率定义为\n$$\ny(t) \\equiv -\\frac{1}{t}\\ln D(t), \\quad t0.\n$$\n哪个选项正确地描述了 $S(t)$ 在节点处的光滑性，以及根据上述定义由 $y(t)$ 构建的隐含瞬时远期利率曲线 $f(t)$ 的经济含义？\n\nA. $S(t)$ 在 $t=1$ 处是 $C^0$ 连续但非 $C^1$ 连续的。隐含的 $f(t)$ 在 $t=1$ 处有一个跳跃间断点，其幅度等于 $y(t)$ 在 $t=1$ 处的单侧导数跳跃，此处为一个大小为 $1$ 的向上跳跃，这意味着在没有已知离散事件的情况下，边际贴现率在 $t=1$ 处出现了一个突然的、经济上不合理的尖峰。\n\nB. $S(t)$ 在 $t=1$ 处是 $C^1$ 连续但非 $C^2$ 连续的。隐含的 $f(t)$ 在 $t=1$ 处是连续的，但存在一个拐点，因此边际贴现率没有突然变化。\n\nC. $S(t)$ 在 $t=1$ 处不满足 $C^0$ 连续性，因此 $D(t)$ 在 $t=1$ 处不连续，违反了无套利条件，且 $f(t)$ 在 $t=1$ 处没有良好定义。\n\nD. $S(t)$ 在 $t=1$ 处是 $C^0$ 连续但非 $C^1$ 连续的。然而，由于 $y(t)$ 通过一个积分映射到 $D(t)$，隐含的 $f(t)$ 在 $t=1$ 处保持连续；$y(t)$ 中的任何拐点都会被平滑掉，对 $f(t)$ 的不连续性没有影响。\n\nE. $S(t)$ 在 $t=1$ 处是 $C^0$ 连续但非 $C^1$ 连续的。隐含的 $f(t)$ 在 $t=1$ 处包含一个狄拉克δ函数贡献，但没有跳跃；积分关系将非光滑性推为一个脉冲而非 $f(t)$ 中的阶跃。", "solution": "在尝试任何解答之前，必须首先验证问题陈述的科学性和逻辑一致性。\n\n问题提供了以下定义和函数：\n零息收益率期限结构的候选函数 $S(t)$ 定义在域 $t \\in [0,2]$ 上，在 $t=1$ 处有一个节点：\n$$\nS(t)=\n\\begin{cases}\nS_1(t) = t^3,  t\\in[0,1],\\\\\nS_2(t) = t^3 + (t-1),  t\\in(1,2].\n\\end{cases}\n$$\n连续复利零利率与此函数等同：$y(t) \\equiv S(t)$。\n贴现函数 $D(t)$ 由瞬时远期利率 $f(t)$ 定义：\n$$\nD(t) \\equiv \\exp\\!\\Big(-\\int_0^t f(u)\\,du\\Big)\n$$\n零利率 $y(t)$ 与贴现函数 $D(t)$ 的关系为：\n$$\ny(t) \\equiv -\\frac{1}{t}\\ln D(t), \\quad t0.\n$$\n问题要求描述 $S(t)$ 在节点 $t=1$ 处的光滑性，以及由 $y(t)$ 构建的隐含瞬时远期利率曲线 $f(t)$ 的经济含义。\n\n所提供的定义在利率理论中是标准的。根据 $y(t)$ 的定义，我们可以写出 $\\ln D(t) = -t \\cdot y(t)$。将其代入 $D(t)$ 的定义并取对数，得到 $-t \\cdot y(t) = -\\int_0^t f(u) du$，即 $t \\cdot y(t) = \\int_0^t f(u) du$。\n为了从零利率 $y(t)$ 求出瞬时远期利率 $f(t)$，我们使用微积分基本定理对该关系式关于 $t$ 求导：\n$$\n\\frac{d}{dt} [t \\cdot y(t)] = f(t)\n$$\n使用乘积法则，得到基本关系：\n$$\nf(t) = y(t) + t \\cdot y'(t)\n$$\n该问题定义明确，陈述客观，并且在标准金融数学中有科学依据。函数 $S(t)$ 是一个简单的分段多项式，适合进行形式化分析。$S(t)$ 产生的收益率大小（例如，$S(1) = 1$ 或 $100\\%$）对于真实世界的经济体来说并不典型，但这并不影响问题的数学结构，该问题是分析函数性质的形式化练习。问题是有效的。\n\n我们开始求解。\n\n首先，我们分析 $S(t)$ 在节点 $t=1$ 处的光滑性。\n函数定义为 $S(t) = y(t)$。\n对于 $t \\in [0,1]$，$S_1(t) = t^3$。\n对于 $t \\in (1,2]$，$S_2(t) = t^3 + t - 1$。\n\n我们评估函数的连续性，即 $C^0$ 连续性。我们计算在 $t=1$ 处的左极限和右极限：\n$$\n\\lim_{t \\to 1^-} S(t) = \\lim_{t \\to 1^-} t^3 = 1^3 = 1\n$$\n$$\n\\lim_{t \\to 1^+} S(t) = \\lim_{t \\to 1^+} (t^3 + t - 1) = 1^3 + 1 - 1 = 1\n$$\n节点处的值为 $S(1) = 1^3 = 1$。由于左极限、右极限和函数值都等于 $1$，函数 $S(t)$ 在 $t=1$ 处是连续的。它是 $C^0$ 连续的。\n\n接下来，我们评估一阶导数的连续性，即 $C^1$ 连续性。我们首先求出 $S(t)$ 各分段的导数：\n对于 $t \\in [0,1)$，$S'(t) = S_1'(t) = \\frac{d}{dt}(t^3) = 3t^2$。\n对于 $t \\in (1,2]$，$S'(t) = S_2'(t) = \\frac{d}{dt}(t^3 + t - 1) = 3t^2 + 1$。\n\n现在，我们计算导数在 $t=1$ 处的左极限和右极限：\n$$\nS'(1^-) = \\lim_{t \\to 1^-} S'(t) = \\lim_{t \\to 1^-} 3t^2 = 3(1)^2 = 3\n$$\n$$\nS'(1^+) = \\lim_{t \\to 1^+} S'(t) = \\lim_{t \\to 1^+} (3t^2 + 1) = 3(1)^2 + 1 = 4\n$$\n由于 $S'(1^-) \\neq S'(1^+)$，一阶导数 $S'(t)$ 在 $t=1$ 处是不连续的。因此，函数 $S(t)$ 在 $t=1$ 处不是 $C^1$ 连续的。\n总而言之，$S(t)$ 在 $t=1$ 处是 $C^0$ 连续但非 $C^1$ 连续的。\n\n其次，我们分析隐含的瞬时远期利率曲线 $f(t)$。\n根据关系式 $f(t) = \\frac{d}{dt}[t \\cdot y(t)]$，我们分段计算 $f(t)$。\n对于 $t \\in [0,1)$：$y(t) = t^3$。乘积为 $t \\cdot y(t) = t^4$。\n则 $f(t) = \\frac{d}{dt}(t^4) = 4t^3$。\n\n对于 $t \\in (1,2]$：$y(t) = t^3 + t - 1$。乘积为 $t \\cdot y(t) = t(t^3 + t - 1) = t^4 + t^2 - t$。\n则 $f(t) = \\frac{d}{dt}(t^4 + t^2 - t) = 4t^3 + 2t - 1$。\n\n因此，瞬时远期利率由以下分段函数给出：\n$$\nf(t)=\n\\begin{cases}\n4t^3,  t\\in[0,1),\\\\\n4t^3 + 2t - 1,  t\\in(1,2].\n\\end{cases}\n$$\n我们检验 $f(t)$ 在 $t=1$ 处的连续性：\n$$\n\\lim_{t \\to 1^-} f(t) = \\lim_{t \\to 1^-} 4t^3 = 4(1)^3 = 4\n$$\n$$\n\\lim_{t \\to 1^+} f(t) = \\lim_{t \\to 1^+} (4t^3 + 2t - 1) = 4(1)^3 + 2(1) - 1 = 4 + 2 - 1 = 5\n$$\n由于极限不相等，$f(t)$ 在 $t=1$ 处有一个跳跃间断点。跳跃的幅度为 $\\Delta f |_1 = \\lim_{t \\to 1^+} f(t) - \\lim_{t \\to 1^-} f(t) = 5 - 4 = 1$。这是一个向上跳跃。\n\n让我们将这个跳跃与 $y(t)$ 的性质联系起来。\n$f(t)$ 在节点 $t_k$ 处的跳跃由 $f(t_k^+) - f(t_k^-)$ 给出。\n使用 $f(t) = y(t) + t y'(t)$：\n$\\lim_{t \\to t_k^+} f(t) = \\lim_{t \\to t_k^+} (y(t) + t y'(t)) = y(t_k) + t_k y'(t_k^+)$ 因为 $y(t)$ 是连续的。\n$\\lim_{t \\to t_k^-} f(t) = \\lim_{t \\to t_k^-} (y(t) + t y'(t)) = y(t_k) + t_k y'(t_k^-)$。\n跳跃为 $ (y(t_k) + t_k y'(t_k^+)) - (y(t_k) + t_k y'(t_k^-)) = t_k (y'(t_k^+) - y'(t_k^-))$。\n$y'(t_k^+) - y'(t_k^-)$ 这一项是收益率曲线 $y(t)$ 的导数在节点处的跳跃。\n在我们的问题中，$t_k=1$。$y'(t)$ 的跳跃是 $y'(1^+) - y'(1^-) = 4-3=1$。\n因此 $f(t)$ 的跳跃是 $1 \\cdot (4-3) = 1$。这与我们的直接计算相符。\n\n其经济含义是，代表在未来时间 $t$ 借贷的边际利率的瞬时远期利率，经历了一个突然的、离散的跳跃。在一个没有特定期限的重大经济事件或公告预定的正常运作市场中，这种特征被认为是高度人为且在经济上不合理的。这表明收益率曲线模型的选择存在缺陷。\n\n现在我们评估每个选项。\n\nA. $S(t)$ 在 $t=1$ 处是 $C^0$ 连续但非 $C^1$ 连续的。隐含的 $f(t)$ 在 $t=1$ 处有一个跳跃间断点，其幅度等于 $y(t)$ 在 $t=1$ 处的单侧导数跳跃，此处为一个大小为 $1$ 的向上跳跃，这意味着在没有已知离散事件的情况下，边际贴现率在 $t=1$ 处出现了一个突然的、经济上不合理的尖峰。\n- “$S(t)$ 在 $t=1$ 处是 $C^0$ 连续但非 $C^1$ 连续的。” 正确，如推导所示。\n- “隐含的 $f(t)$ 在 $t=1$ 处有一个跳跃间断点。” 正确。\n- “其幅度等于 $y(t)$ 在 $t=1$ 处的单侧导数跳跃。” 正确。$f(t)$ 的跳跃是 $1$。$y'(t)$ 的跳跃是 $y'(1^+) - y'(1^-) = 4-3=1$。幅度相等是因为节点在 $t=1$。\n- “此处为一个大小为 $1$ 的向上跳跃。” 正确，我们计算出跳跃为 $5-4=1$。\n- “这意味着在没有已知离散事件的情况下，边际贴现率...出现一个突然的、经济上不合理的尖峰...”。正确，这是标准的经济解释。\n这个陈述完全正确。\n\nB. $S(t)$ 在 $t=1$ 处是 $C^1$ 连续但非 $C^2$ 连续的。隐含的 $f(t)$ 在 $t=1$ 处是连续的，但存在一个拐点，因此边际贴现率没有突然变化。\n- “$S(t)$ 在 $t=1$ 处是 $C^1$ 连续但非 $C^2$ 连续的。” 不正确。我们证明了 $S(t)$ 不是 $C^1$ 连续的。\n\nC. $S(t)$ 在 $t=1$ 处不满足 $C^0$ 连续性，因此 $D(t)$ 在 $t=1$ 处不连续，违反了无套利条件，且 $f(t)$ 在 $t=1$ 处没有良好定义。\n- “$S(t)$ 在 $t=1$ 处不满足 $C^0$ 连续性。” 不正确。我们证明了 $S(t)$ 是 $C^0$ 连续的。\n\nD. $S(t)$ 在 $t=1$ 处是 $C^0$ 连续但非 $C^1$ 连续的。然而，由于 $y(t)$ 通过一个积分映射到 $D(t)$，隐含的 $f(t)$ 在 $t=1$ 处保持连续；$y(t)$ 中的任何拐点都会被平滑掉，对 $f(t)$ 的不连续性没有影响。\n- “$S(t)$ 在 $t=1$ 处是 $C^0$ 连续但非 $C^1$ 连续的。” 正确。\n- “由于 $y(t)$ 通过一个积分映射到 $D(t)$，隐含的 $f(t)$ 保持连续”。前提混乱，结论错误。从 $y(t)$ 到 $f(t)$ 的映射是通过微分，$f(t) = \\frac{d}{dt}[t \\cdot y(t)]$，而不是积分。微分不会平滑函数；它通常会使函数变得更不光滑。我们明确地证明了 $f(t)$ 是不连续的。不正确。\n\nE. $S(t)$ 在 $t=1$ 处是 $C^0$ 连续但非 $C^1$ 连续的。隐含的 $f(t)$ 在 $t=1$ 处包含一个狄拉克δ函数贡献，但没有跳跃；积分关系将非光滑性推为一个脉冲而非 $f(t)$ 中的阶跃。\n- “$S(t)$ 在 $t=1$ 处是 $C^0$ 连续但非 $C^1$ 连续的。” 正确。\n- “隐含的 $f(t)$ 在 $t=1$ 处包含一个狄拉克δ函数贡献。” 不正确。如果被微分的函数 $t \\cdot y(t)$ 有一个跳跃间断点，那么 $f(t)$ 中才会出现狄拉克δ函数贡献。在这里，$t \\cdot y(t)$ 是连续的，但有一个拐点（不可微点）。它的导数有一个跳跃间断点，而不是狄拉克δ函数。\n- “但没有跳跃”。不正确。我们证明了它有跳跃。\n\n基于这一严谨的分析，只有选项 A 是正确的。", "answer": "$$\\boxed{A}$$", "id": "2386597"}]}