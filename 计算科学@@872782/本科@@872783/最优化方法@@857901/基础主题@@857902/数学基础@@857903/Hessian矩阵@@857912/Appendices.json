{"hands_on_practices": [{"introduction": "掌握Hessian矩阵的第一步是直接计算。本练习 [@problem_id:1643768] 提供了一个物理学中常见的二次型势能函数，要求你计算其Hessian矩阵。通过这个练习，你将熟悉根据定义计算二阶偏导数并将其排列成矩阵的基本流程，直观地理解Hessian矩阵如何捕捉函数（在此例中为能量曲面）的局部曲率。", "problem": "在固态物理学中，晶格中原子由于与其近邻的相互作用而产生的势能，通常可以近似为其偏离稳定平衡位置的位移的二次函数。这种近似对于小幅振荡是有效的，并且是理解声子和固体热学性质的基础。\n\n考虑一个简化的二维模型，其中单个粒子的平衡位置在原点 $(0,0)$。当该粒子发生一个微小位移矢量 $\\mathbf{r} = (x, y)$ 时，其势能 $U$ 由以下函数描述：\n$$U(x, y) = \\alpha x^2 + \\beta y^2 + \\gamma xy$$\n此处，$\\alpha$、$\\beta$ 和 $\\gamma$ 是实值常数，它们表征了由周围晶体结构产生的势阱的各向异性。\n\n平衡点处势能面的局部曲率由Hessian矩阵描述。该矩阵对于分析平衡的稳定性以及确定围绕平衡点的小幅振荡的频率至关重要。\n\n您的任务是计算势能函数 $U(x, y)$ 在平衡点 $(0,0)$ 处的Hessian矩阵，记为 $H_U$。请用常数 $\\alpha$、$\\beta$ 和 $\\gamma$ 来表示矩阵的元素。", "solution": "我们使用标量场 $U(x,y)$ 的Hessian矩阵的定义：\n$$\nH_{U}(x,y)=\\begin{pmatrix}\n\\frac{\\partial^{2}U}{\\partial x^{2}}  \\frac{\\partial^{2}U}{\\partial x \\partial y} \\\\\n\\frac{\\partial^{2}U}{\\partial y \\partial x}  \\frac{\\partial^{2}U}{\\partial y^{2}}\n\\end{pmatrix}.\n$$\n给定 $U(x,y)=\\alpha x^{2}+\\beta y^{2}+\\gamma x y$，计算其一阶导数：\n$$\n\\frac{\\partial U}{\\partial x}=2\\alpha x+\\gamma y,\\qquad \\frac{\\partial U}{\\partial y}=2\\beta y+\\gamma x.\n$$\n然后，二阶导数为：\n$$\n\\frac{\\partial^{2}U}{\\partial x^{2}}=2\\alpha,\\qquad \\frac{\\partial^{2}U}{\\partial y^{2}}=2\\beta,\\qquad \\frac{\\partial^{2}U}{\\partial x \\partial y}=\\frac{\\partial^{2}U}{\\partial y \\partial x}=\\gamma.\n$$\n因此，Hessian矩阵在 $(x,y)$ 上是常数，在 $(0,0)$ 点处其值为\n$$\nH_{U}(0,0)=\\begin{pmatrix}2\\alpha  \\gamma \\\\ \\gamma  2\\beta\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}2\\alpha  \\gamma \\\\ \\gamma  2\\beta\\end{pmatrix}}$$", "id": "1643768"}, {"introduction": "Hessian矩阵与梯度向量场之间存在着深刻的联系：Hessian矩阵是梯度场的雅可比矩阵。本练习 [@problem_id:1643797] 直接给出了一个函数的梯度，要求你由此出发计算Hessian矩阵。这个过程不仅能巩固你的偏导数计算技巧，还能加深你对多变量微积分中基本概念之间相互关联的理解。", "problem": "设 $f: \\mathbb{R}^3 \\to \\mathbb{R}$ 是一个二阶连续可微的标量函数。该函数的梯度 $\\nabla f$ 已知为如下给出的向量场：\n$$\n\\nabla f(x, y, z) = \\left( y\\cos(x) + \\exp(z), \\sin(x) - z\\sin(y), \\cos(y) + x\\exp(z) \\right)\n$$\n你的任务是计算函数 $f$ 的Hessian矩阵（记作 $H_f$）在点 $P = (0, \\frac{\\pi}{2}, 0)$ 处的值。", "solution": "我们已知 $\\nabla f(x,y,z) = \\left(f_{x}, f_{y}, f_{z}\\right) = \\left(y\\cos(x) + \\exp(z), \\sin(x) - z\\sin(y), \\cos(y) + x\\exp(z)\\right)$。Hessian矩阵 $H_{f}$ 由所有二阶偏导数组成：\n$$\nH_{f}(x,y,z)=\\begin{pmatrix}\nf_{xx}  f_{xy}  f_{xz}\\\\\nf_{yx}  f_{yy}  f_{yz}\\\\\nf_{zx}  f_{zy}  f_{zz}\n\\end{pmatrix}.\n$$\n通过对梯度的分量求导来计算每个二阶偏导数：\n- 由 $f_{x}=y\\cos(x)+\\exp(z)$：\n$$\nf_{xx}=\\frac{\\partial}{\\partial x}(y\\cos(x)+\\exp(z))=-y\\sin(x),\\quad\nf_{xy}=\\frac{\\partial}{\\partial y}(y\\cos(x)+\\exp(z))=\\cos(x),\\quad\nf_{xz}=\\frac{\\partial}{\\partial z}(y\\cos(x)+\\exp(z))=\\exp(z).\n$$\n- 由 $f_{y}=\\sin(x)-z\\sin(y)$：\n$$\nf_{yx}=\\frac{\\partial}{\\partial x}(\\sin(x)-z\\sin(y))=\\cos(x),\\quad\nf_{yy}=\\frac{\\partial}{\\partial y}(\\sin(x)-z\\sin(y))=-z\\cos(y),\\quad\nf_{yz}=\\frac{\\partial}{\\partial z}(\\sin(x)-z\\sin(y))=-\\sin(y).\n$$\n- 由 $f_{z}=\\cos(y)+x\\exp(z)$：\n$$\nf_{zx}=\\frac{\\partial}{\\partial x}(\\cos(y)+x\\exp(z))=\\exp(z),\\quad\nf_{zy}=\\frac{\\partial}{\\partial y}(\\cos(y)+x\\exp(z))=-\\sin(y),\\quad\nf_{zz}=\\frac{\\partial}{\\partial z}(\\cos(y)+x\\exp(z))=x\\exp(z).\n$$\n因此，对于一般的 $(x,y,z)$，\n$$\nH_{f}(x,y,z)=\\begin{pmatrix}\n- y\\sin(x)  \\cos(x)  \\exp(z)\\\\\n\\cos(x)  - z\\cos(y)  - \\sin(y)\\\\\n\\exp(z)  - \\sin(y)  x\\exp(z)\n\\end{pmatrix}.\n$$\n在点 $P=(0,\\frac{\\pi}{2},0)$ 处求值，使用 $\\sin(0)=0$，$\\cos(0)=1$，$\\sin\\!\\left(\\frac{\\pi}{2}\\right)=1$，$\\cos\\!\\left(\\frac{\\pi}{2}\\right)=0$ 和 $\\exp(0)=1$：\n$$\nH_{f}(0,\\tfrac{\\pi}{2},0)=\\begin{pmatrix}\n- \\tfrac{\\pi}{2}\\cdot 0  1  1\\\\\n1  - 0 \\cdot 0  -1\\\\\n1  -1  0 \\cdot 1\n\\end{pmatrix}\n=\\begin{pmatrix}\n0  1  1\\\\\n1  0  -1\\\\\n1  -1  0\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}0  1  1 \\\\ 1  0  -1 \\\\ 1  -1  0\\end{pmatrix}}$$", "id": "1643797"}, {"introduction": "计算Hessian矩阵本身只是手段，其真正的威力在于分析函数的局部几何性质，尤其是在优化问题中判断临界点的类型。本练习 [@problem_id:3136114] 将引导你对一个经典的马鞍点函数进行全面分析，从计算Hessian矩阵的特征值和特征向量，到解释它们如何决定局部曲率，并最终确定一个有效的“逃逸方向”。这个综合性问题是理解Hessian矩阵在现代优化算法中核心作用的关键。", "problem": "考虑由 $f(x,y)=x^{2}-y^{2}$ 定义的函数 $f:\\mathbb{R}^{2}\\to\\mathbb{R}$。仅使用多元微积分中梯度和Hessian矩阵的核心定义，以及无约束优化中曲率方向的二阶特征，完成以下任务：\n\n1) 通过求解使得梯度 $\\nabla f(x,y)$ 为零向量的 $(x,y)$，确定 $f$ 的临界点。\n\n2) 由二阶偏导数构建 $f$ 的Hessian矩阵 $H(x,y)$，并在第1部分中找到的临界点处对其求值。\n\n3) 计算在临界点处Hessian矩阵的特征值和一组对应的标准正交特征向量。解释特征值的符号和特征向量的方向如何将 $f$ 的局部几何形状表征为鞍形。\n\n4) 根据Hessian矩阵所指示的负曲率，在临界点确定一个单位长度的逃逸方向，该方向使 $f$ 在二阶上局部减小。为保证唯一性，选择与最负特征值相关联的、其第二个分量为非负的单位特征向量。\n\n仅提供第4部分所要求的单位逃逸方向向量作为最终答案，使用 `pmatrix` 环境写成行向量形式。无需进行数值舍入。", "solution": "用户提供了一个在多元微积分和优化理论中提法明确的问题。任务是使用梯度和Hessian矩阵分析函数 $f(x,y) = x^2 - y^2$ 在其临界点处的局部几何形状。该问题具有科学依据、自成体系且客观。我们将按要求分步进行解答。\n\n所考虑的函数为 $f:\\mathbb{R}^{2} \\to \\mathbb{R}$，定义为 $f(x,y) = x^{2} - y^{2}$。\n\n1) 首先，我们确定 $f$ 的临界点。临界点 $(x,y)$ 是指梯度 $\\nabla f(x,y)$ 为零向量的点。梯度是一阶偏导数的向量：\n$$\n\\nabla f(x,y) = \\begin{pmatrix} \\frac{\\partial f}{\\partial x} \\\\ \\frac{\\partial f}{\\partial y} \\end{pmatrix}\n$$\n我们计算 $f(x,y) = x^{2} - y^{2}$ 的偏导数：\n$$\n\\frac{\\partial f}{\\partial x} = \\frac{\\partial}{\\partial x}(x^{2} - y^{2}) = 2x\n$$\n$$\n\\frac{\\partial f}{\\partial y} = \\frac{\\partial}{\\partial y}(x^{2} - y^{2}) = -2y\n$$\n因此，梯度为：\n$$\n\\nabla f(x,y) = \\begin{pmatrix} 2x \\\\ -2y \\end{pmatrix}\n$$\n为找到临界点，我们将梯度设为零向量 $\\mathbf{0} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$：\n$$\n\\begin{pmatrix} 2x \\\\ -2y \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n这得到一个由两个线性方程组成的方程组：\n$2x = 0 \\implies x = 0$\n$-2y = 0 \\implies y = 0$\n唯一解是 $(x,y) = (0,0)$。因此，函数 $f$ 在原点 $(0,0)$ 有一个唯一的临界点。\n\n2) 接下来，我们构建Hessian矩阵 $H(x,y)$。Hessian矩阵是二阶偏导数的矩阵：\n$$\nH(x,y) = \\begin{pmatrix} \\frac{\\partial^2 f}{\\partial x^2}  \\frac{\\partial^2 f}{\\partial x \\partial y} \\\\ \\frac{\\partial^2 f}{\\partial y \\partial x}  \\frac{\\partial^2 f}{\\partial y^2} \\end{pmatrix}\n$$\n我们计算所需的二阶偏导数：\n$$\n\\frac{\\partial^2 f}{\\partial x^2} = \\frac{\\partial}{\\partial x}(2x) = 2\n$$\n$$\n\\frac{\\partial^2 f}{\\partial y^2} = \\frac{\\partial}{\\partial y}(-2y) = -2\n$$\n$$\n\\frac{\\partial^2 f}{\\partial x \\partial y} = \\frac{\\partial}{\\partial x}(-2y) = 0\n$$\n由于 $f$ 是一个多项式，其二阶偏导数是连续的，根据Clairaut定理，混合偏导数相等：$\\frac{\\partial^2 f}{\\partial y \\partial x} = \\frac{\\partial^2 f}{\\partial x \\partial y} = 0$。\n因此，Hessian矩阵为：\n$$\nH(x,y) = \\begin{pmatrix} 2  0 \\\\ 0  -2 \\end{pmatrix}\n$$\n对于所有 $(x,y) \\in \\mathbb{R}^{2}$，Hessian矩阵是常数。在临界点 $(0,0)$ 处对其求值得到：\n$$\nH(0,0) = \\begin{pmatrix} 2  0 \\\\ 0  -2 \\end{pmatrix}\n$$\n\n3) 现在，我们计算Hessian矩阵 $H = H(0,0)$ 的特征值和特征向量。由于 $H$ 是一个对角矩阵，其特征值即为其对角线上的元素。\n特征值为 $\\lambda_1 = 2$ 和 $\\lambda_2 = -2$。\n\n为了找到对应的特征向量，我们对每个特征值 $\\lambda$ 求解方程 $(H - \\lambda I)v = \\mathbf{0}$。\n对于 $\\lambda_1 = 2$：\n$$\n(H - 2I)v = \\left( \\begin{pmatrix} 2  0 \\\\ 0  -2 \\end{pmatrix} - \\begin{pmatrix} 2  0 \\\\ 0  2 \\end{pmatrix} \\right) \\begin{pmatrix} v_x \\\\ v_y \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ 0  -4 \\end{pmatrix} \\begin{pmatrix} v_x \\\\ v_y \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n该方程简化为 $-4v_y = 0$，这意味着 $v_y = 0$。分量 $v_x$ 不受约束。一个对应的特征向量形式为 $\\begin{pmatrix} c \\\\ 0 \\end{pmatrix}$，其中 $c \\ne 0$。一个单位特征向量是 $v_1 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。\n\n对于 $\\lambda_2 = -2$：\n$$\n(H - (-2)I)v = \\left( \\begin{pmatrix} 2  0 \\\\ 0  -2 \\end{pmatrix} - \\begin{pmatrix} -2  0 \\\\ 0  -2 \\end{pmatrix} \\right) \\begin{pmatrix} v_x \\\\ v_y \\end{pmatrix} = \\begin{pmatrix} 4  0 \\\\ 0  0 \\end{pmatrix} \\begin{pmatrix} v_x \\\\ v_y \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n该方程简化为 $4v_x = 0$，这意味着 $v_x = 0$。分量 $v_y$ 不受约束。一个对应的特征向量形式为 $\\begin{pmatrix} 0 \\\\ c \\end{pmatrix}$，其中 $c \\ne 0$。一个单位特征向量是 $v_2 = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$。\n\n一组标准正交特征向量是 $\\{v_1, v_2\\} = \\left\\{ \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} \\right\\}$。\n\n特征值的符号表征了局部几何形状。$f$ 在临界点 $x_c = (0,0)$ 附近对一个小位移 $d$ 的二阶泰勒展开式为 $f(x_c + d) \\approx f(x_c) + \\nabla f(x_c)^T d + \\frac{1}{2} d^T H(x_c) d$。由于 $\\nabla f(x_c) = \\mathbf{0}$，函数值的变化为 $\\Delta f \\approx \\frac{1}{2} d^T H d$。项 $d^T H d$ 代表局部曲率。\n- 正特征值 $\\lambda_1 = 2$ 对应于特征向量 $v_1 = (1,0)$，该向量与 $x$ 轴对齐。这表明在 $x$ 方向上具有正曲率。沿 $x$ 轴离开原点会导致 $f$ 增加，如截面 $f(x,0) = x^2$ 所示。\n- 负特征值 $\\lambda_2 = -2$ 对应于特征向量 $v_2 = (0,1)$，该向量与 $y$ 轴对齐。这表明在 $y$ 方向上具有负曲率。沿 $y$ 轴离开原点会导致 $f$ 减小，如截面 $f(0,y) = -y^2$ 所示。\n存在符号相反的特征值（一个正，一个负）是鞍点的明确二阶条件。Hessian矩阵是不定的，临界点 $(0,0)$ 是一个严格鞍点。\n\n4) 逃逸方向是一个使函数局部减小的方向 $d$。这要求二次型 $d^T H d$ 为负。最快下降方向对应于与最负特征值相关联的特征向量。\n最负的，也是唯一的负特征值是 $\\lambda_2 = -2$。与此特征值相关联的特征空间由向量 $\\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$ 张成。此特征空间中的单位特征向量是 $\\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$ 和 $\\begin{pmatrix} 0 \\\\ -1 \\end{pmatrix}$。\n问题指定了一个唯一的选择：“选择与最负特征值相关联的、其第二个分量为非负的单位特征向量。”\n比较这两个候选向量：\n- 对于向量 $\\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$，第二个分量是 $1$，为非负数。\n- 对于向量 $\\begin{pmatrix} 0 \\\\ -1 \\end{pmatrix}$，第二个分量是 $-1$，为负数。\n因此，所要求的逃逸方向是 $d = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$。\n\n最终答案是这个单位向量，写成行矩阵的形式。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n0  1\n\\end{pmatrix}\n}\n$$", "id": "3136114"}]}