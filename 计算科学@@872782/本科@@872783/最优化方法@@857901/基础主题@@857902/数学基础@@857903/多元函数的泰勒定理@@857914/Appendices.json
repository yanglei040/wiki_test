{"hands_on_practices": [{"introduction": "掌握多变量泰勒定理的第一步是能够熟练地计算泰勒多项式。这个练习将指导你完成一个具体函数的二阶泰勒展开，这是利用泰勒定理进行局部近似、分析和优化的基本功。通过这个直接的计算 [@problem_id:24079]，你将熟悉评估函数值和各阶偏导数以构建近似模型的过程。", "problem": "一个二次可微函数 $f(x, y)$ 在点 $(a, b)$ 处的二阶泰勒多项式提供了该函数在该点附近的二次近似。其公式为：\n$$\nT_2(x, y) = f(a, b) + \\frac{\\partial f}{\\partial x}(a, b)(x - a) + \\frac{\\partial f}{\\partial y}(a, b)(y - b) + \\frac{1}{2!}\\left(\\frac{\\partial^2 f}{\\partial x^2}(a, b)(x - a)^2 + 2\\frac{\\partial^2 f}{\\partial x \\partial y}(a, b)(x - a)(y - b) + \\frac{\\partial^2 f}{\\partial y^2}(a, b)(y - b)^2\\right)\n$$\n考虑函数 $f(x, y) = \\frac{x}{y+1}$。求此函数在原点 $(a, b) = (0, 0)$ 处的二阶泰勒多项式。", "solution": "本题要求函数 $f(x, y) = \\frac{x}{y+1}$ 在点 $(a, b) = (0, 0)$ 处的二阶泰勒多项式。\n\n在点 $(a, b)$ 处的二阶泰勒多项式的一般公式为：\n$$\nT_2(x, y) = f(a, b) + f_x(a, b)(x-a) + f_y(a, b)(y-b) + \\frac{1}{2} \\left[ f_{xx}(a, b)(x-a)^2 + 2f_{xy}(a, b)(x-a)(y-b) + f_{yy}(a, b)(y-b)^2 \\right]\n$$\n其中下标表示偏微分（例如，$f_x = \\frac{\\partial f}{\\partial x}$ 和 $f_{xy} = \\frac{\\partial^2 f}{\\partial y \\partial x}$）。\n\n由于我们以原点 $(a, b) = (0, 0)$ 为中心展开多项式，公式简化为：\n$$\nT_2(x, y) = f(0, 0) + f_x(0, 0)x + f_y(0, 0)y + \\frac{1}{2} \\left[ f_{xx}(0, 0)x^2 + 2f_{xy}(0, 0)xy + f_{yy}(0, 0)y^2 \\right]\n$$\n\n我们必须计算函数值及其直到二阶的偏导数，然后在点 $(0, 0)$ 处求值。\n\n**第一步：在 (0, 0) 处计算函数值。**\n$$\nf(x, y) = \\frac{x}{y+1}\n$$\n$$\nf(0, 0) = \\frac{0}{0+1} = 0\n$$\n\n**第二步：计算一阶偏导数并在 (0, 0) 处求值。**\n$$\nf_x(x, y) = \\frac{\\partial}{\\partial x}\\left(\\frac{x}{y+1}\\right) = \\frac{1}{y+1}\n$$\n$$\nf_x(0, 0) = \\frac{1}{0+1} = 1\n$$\n$$\nf_y(x, y) = \\frac{\\partial}{\\partial y}\\left(x(y+1)^{-1}\\right) = x(-1)(y+1)^{-2} = -\\frac{x}{(y+1)^2}\n$$\n$$\nf_y(0, 0) = -\\frac{0}{(0+1)^2} = 0\n$$\n\n**第三步：计算二阶偏导数并在 (0, 0) 处求值。**\n$$\nf_{xx}(x, y) = \\frac{\\partial}{\\partial x}(f_x) = \\frac{\\partial}{\\partial x}\\left(\\frac{1}{y+1}\\right) = 0\n$$\n$$\nf_{xx}(0, 0) = 0\n$$\n$$\nf_{xy}(x, y) = \\frac{\\partial}{\\partial y}(f_x) = \\frac{\\partial}{\\partial y}\\left((y+1)^{-1}\\right) = -1(y+1)^{-2} = -\\frac{1}{(y+1)^2}\n$$\n$$\nf_{xy}(0, 0) = -\\frac{1}{(0+1)^2} = -1\n$$\n$$\nf_{yy}(x, y) = \\frac{\\partial}{\\partial y}(f_y) = \\frac{\\partial}{\\partial y}\\left(-\\frac{x}{(y+1)^2}\\right) = -x \\frac{\\partial}{\\partial y}\\left((y+1)^{-2}\\right) = -x(-2)(y+1)^{-3} = \\frac{2x}{(y+1)^3}\n$$\n$$\nf_{yy}(0, 0) = \\frac{2(0)}{(0+1)^3} = 0\n$$\n\n**第四步：将这些值代入泰勒多项式公式。**\n$$\nT_2(x, y) = f(0, 0) + f_x(0, 0)x + f_y(0, 0)y + \\frac{1}{2} \\left[ f_{xx}(0, 0)x^2 + 2f_{xy}(0, 0)xy + f_{yy}(0, 0)y^2 \\right]\n$$\n$$\nT_2(x, y) = 0 + (1)x + (0)y + \\frac{1}{2} \\left[ (0)x^2 + 2(-1)xy + (0)y^2 \\right]\n$$\n$$\nT_2(x, y) = x + \\frac{1}{2} (-2xy)\n$$\n$$\nT_2(x, y) = x - xy\n$$\n函数 $f(x, y) = \\frac{x}{y+1}$ 在原点处的二阶泰勒多项式为 $x - xy$。", "answer": "$$\\boxed{x - xy}$$", "id": "24079"}, {"introduction": "当二阶导数信息不足以判断一个驻点的性质时，泰勒定理的高阶项就变得至关重要。这个练习 [@problem_id:3191338] 探讨了一个二阶导数检验失效的退化驻点，展示了如何利用三阶项来揭示其真实的几何形态（鞍点）。更进一步，它启发我们如何利用高阶信息来设计更智能的优化算法步骤，这对于解决传统方法失效的难题至关重要。", "problem": "考虑由 $f(x,y)=x^{3}+3\\,x\\,y^{2}$ 定义的函数 $f:\\mathbb{R}^{2}\\to\\mathbb{R}$。令 $x^{\\star}=(0,0)$。\n\n任务：\n- 验证 $x^{\\star}$ 是一个驻点，且 $f$ 在 $x^{\\star}$ 处的 Hessian 矩阵是零矩阵，而 $x^{\\star}$ 处的某些三阶偏导数非零。\n- 使用以 $x^{\\star}$ 为中心的多元函数泰勒定理，对驻点 $x^{\\star}$ 进行分类。\n- 借鉴信赖域方法的思想，通过在球体 $\\{s\\in\\mathbb{R}^{2}:\\|s\\|_{2}=r\\}$（其中给定 $r>0$）上最小化以 $x^{\\star}$ 为中心的 $f$ 的三阶泰勒模型，来设计一个“三次感知”的优化步。在所有极小值点中，选择 $y>0$ 的那一个。以单个行向量的形式给出显式优化步 $s^{\\star}(r)$。\n\n你的最终答案必须是仅用 $r$ 表示的 $s^{\\star}(r)$ 的显式表达式，写成一个行矩阵。无需四舍五入。", "solution": "问题要求我们分析函数 $f(x,y)=x^{3}+3\\,x\\,y^{2}$ 在点 $x^{\\star}=(0,0)$ 处的性质，对该驻点进行分类，然后通过在半径为 $r$ 的球面上最小化 $f$ 的三阶泰勒模型来找到一个最优步长 $s^{\\star}(r)$。\n\n首先，我们验证 $x^{\\star}=(0,0)$ 是一个驻点，并且其 Hessian 矩阵是零矩阵。我们计算 $f$ 的梯度，记为 $\\nabla f$。其偏导数为：\n$$\n\\frac{\\partial f}{\\partial x} = 3x^{2}+3y^{2}\n$$\n$$\n\\frac{\\partial f}{\\partial y} = 6xy\n$$\n梯度为 $\\nabla f(x,y) = \\begin{pmatrix} 3x^{2}+3y^{2} \\\\ 6xy \\end{pmatrix}$。\n在 $x^{\\star}=(0,0)$ 处求值，我们得到：\n$$\n\\nabla f(0,0) = \\begin{pmatrix} 3(0)^{2}+3(0)^{2} \\\\ 6(0)(0) \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n由于在 $x^{\\star}=(0,0)$ 处的梯度是零向量，所以 $x^{\\star}$ 是 $f$ 的一个驻点。\n\n接下来，我们计算 $f$ 的 Hessian 矩阵，记为 $\\nabla^{2}f$。其二阶偏导数为：\n$$\n\\frac{\\partial^{2} f}{\\partial x^{2}} = \\frac{\\partial}{\\partial x}(3x^{2}+3y^{2}) = 6x\n$$\n$$\n\\frac{\\partial^{2} f}{\\partial y^{2}} = \\frac{\\partial}{\\partial y}(6xy) = 6x\n$$\n$$\n\\frac{\\partial^{2} f}{\\partial x \\partial y} = \\frac{\\partial}{\\partial y}(3x^{2}+3y^{2}) = 6y\n$$\nHessian 矩阵为 $\\nabla^{2}f(x,y) = \\begin{pmatrix} 6x  6y \\\\ 6y  6x \\end{pmatrix}$。\n在 $x^{\\star}=(0,0)$ 处求值：\n$$\n\\nabla^{2}f(0,0) = \\begin{pmatrix} 6(0)  6(0) \\\\ 6(0)  6(0) \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ 0  0 \\end{pmatrix}\n$$\n这证实了 $f$ 在 $x^{\\star}$ 处的 Hessian 矩阵是零矩阵。二阶导数检验无法对该驻点进行分类。\n\n我们现在计算在 $x^{\\star}=(0,0)$ 处的三阶偏导数：\n$$\n\\frac{\\partial^{3} f}{\\partial x^{3}} = 6 \\implies \\frac{\\partial^{3} f}{\\partial x^{3}}(0,0) = 6\n$$\n$$\n\\frac{\\partial^{3} f}{\\partial y^{3}} = 0 \\implies \\frac{\\partial^{3} f}{\\partial y^{3}}(0,0) = 0\n$$\n$$\n\\frac{\\partial^{3} f}{\\partial x^{2} \\partial y} = 0 \\implies \\frac{\\partial^{3} f}{\\partial x^{2} \\partial y}(0,0) = 0\n$$\n$$\n\\frac{\\partial^{3} f}{\\partial x \\partial y^{2}} = 6 \\implies \\frac{\\partial^{3} f}{\\partial x \\partial y^{2}}(0,0) = 6\n$$\n我们看到 $x^{\\star}$ 处的某些三阶偏导数确实非零。\n\n为了对驻点进行分类，我们使用 $f$ 在 $x^{\\star}=(0,0)$ 附近的泰勒展开。对于向量 $s=(s_x, s_y)$，其展开式为：\n$f(s_x, s_y) = f(0,0) + \\nabla f(0,0)^{T}s + \\frac{1}{2}s^{T}\\nabla^{2}f(0,0)s + \\dots$\n由于 $f(0,0)=0$, $\\nabla f(0,0)=0$ 且 $\\nabla^{2}f(0,0)=0$，最低阶的非零项是三阶项。函数 $f(x,y)=x^3+3xy^2$ 是一个3次齐次多项式。其关于原点的泰勒展开就是函数本身。\n因此，在原点附近，$f$ 的性态由 $f(x,y) = x^3 + 3xy^2 = x(x^2 + 3y^2)$ 给出。\n在 $(0,0)$ 的任意小邻域内：\n- 如果我们选择一个 $x > 0$ 的点，那么 $x^2+3y^2 > 0$（除非 $(x,y)=(0,0)$），所以 $f(x,y) > 0$。\n- 如果我们选择一个 $x  0$ 的点，那么 $f(x,y)  0$。\n由于 $f(0,0)=0$ 并且函数在 $(0,0)$ 的任何邻域内都取正值和负值，因此点 $x^{\\star}=(0,0)$ 是一个鞍点（具体来说，是一个退化鞍点或高阶鞍点）。\n\n最后，我们通过在球体 $\\{s\\in\\mathbb{R}^{2}:\\|s\\|_{2}=r\\}$ 上最小化以 $x^{\\star}$ 为中心的 $f$ 的三阶泰勒模型来设计“三次感知”优化步。设 $s = (s_x, s_y)$。三阶泰勒模型 $m(s)$ 为：\n$$\nm(s) = f(0,0) + \\nabla f(0,0)^{T}s + \\frac{1}{2}s^{T}\\nabla^{2}f(0,0)s + \\frac{1}{3!}\\sum_{i,j,k=1}^{2} \\frac{\\partial^3 f(0,0)}{\\partial x_i \\partial x_j \\partial x_k}s_i s_j s_k\n$$\n如前所述，前三项为零，三阶展开与函数本身一致。因此我们要最小化 $m(s_x, s_y) = s_x^3 + 3s_x s_y^2$，约束条件为 $s_x^2 + s_y^2 = r^2$，其中 $r>0$。\n\n我们可以使用极坐标来参数化约束条件：$s_x = r\\cos\\theta$ 和 $s_y = r\\sin\\theta$，其中 $\\theta \\in [0, 2\\pi)$。将其代入目标函数，得到一个关于 $\\theta$ 的函数：\n$$\nh(\\theta) = (r\\cos\\theta)^{3} + 3(r\\cos\\theta)(r\\sin\\theta)^{2}\n$$\n$$\nh(\\theta) = r^{3}\\cos^{3}\\theta + 3r^{3}\\cos\\theta\\sin^{2}\\theta = r^{3}\\cos\\theta(\\cos^{2}\\theta + 3\\sin^{2}\\theta)\n$$\n使用恒等式 $\\cos^{2}\\theta = 1 - \\sin^{2}\\theta$：\n$$\nh(\\theta) = r^{3}\\cos\\theta(1 - \\sin^{2}\\theta + 3\\sin^{2}\\theta) = r^{3}\\cos\\theta(1 + 2\\sin^{2}\\theta)\n$$\n为了找到最小值，我们计算关于 $\\theta$ 的导数并令其为零：\n$$\n\\frac{dh}{d\\theta} = r^{3}[(-\\sin\\theta)(1+2\\sin^{2}\\theta) + (\\cos\\theta)(4\\sin\\theta\\cos\\theta)]\n$$\n$$\n\\frac{dh}{d\\theta} = r^{3}[-\\sin\\theta - 2\\sin^{3}\\theta + 4\\sin\\theta\\cos^{2}\\theta] = r^{3}\\sin\\theta[-1 - 2\\sin^{2}\\theta + 4\\cos^{2}\\theta]\n$$\n令 $\\frac{dh}{d\\theta}=0$（且由于 $r>0$），我们有两种情况：\n情况 1：$\\sin\\theta = 0$。这意味着 $\\theta=0$ 或 $\\theta=\\pi$。\n- 若 $\\theta=0$，$h(0)=r^{3}\\cos(0)(1+0) = r^{3}$。\n- 若 $\\theta=\\pi$，$h(\\pi)=r^{3}\\cos(\\pi)(1+0) = -r^{3}$。\n\n情况 2：$-1 - 2\\sin^{2}\\theta + 4\\cos^{2}\\theta = 0$。使用 $\\cos^{2}\\theta = 1-\\sin^{2}\\theta$：\n$$\n-1 - 2\\sin^{2}\\theta + 4(1-\\sin^{2}\\theta) = 0 \\implies 3 - 6\\sin^{2}\\theta = 0 \\implies \\sin^{2}\\theta = \\frac{1}{2}\n$$\n这也意味着 $\\cos^{2}\\theta = 1 - \\frac{1}{2} = \\frac{1}{2}$。目标函数的值为 $h(\\theta) = r^{3}\\cos\\theta(1 + 2(\\frac{1}{2})) = 2r^{3}\\cos\\theta$。\n- 若 $\\cos\\theta = \\sqrt{\\frac{1}{2}} = \\frac{1}{\\sqrt{2}}$，则 $h(\\theta) = 2r^{3}(\\frac{1}{\\sqrt{2}}) = \\sqrt{2}r^{3}$。\n- 若 $\\cos\\theta = -\\sqrt{\\frac{1}{2}} = -\\frac{1}{\\sqrt{2}}$，则 $h(\\theta) = 2r^{3}(-\\frac{1}{\\sqrt{2}}) = -\\sqrt{2}r^{3}$。\n\n比较所有值 $\\{r^3, -r^3, \\sqrt{2}r^3, -\\sqrt{2}r^3\\}$，最小值为 $-\\sqrt{2}r^{3}$。这发生在 $\\cos\\theta = -1/\\sqrt{2}$ 和 $\\sin^2\\theta = 1/2$ 时。可能的角度为 $\\theta = \\frac{3\\pi}{4}$ 和 $\\theta = \\frac{5\\pi}{4}$。\n对应的极小值点 $s=(s_x,s_y)$ 是：\n1. 对于 $\\theta = \\frac{3\\pi}{4}$：$s_x = r\\cos(\\frac{3\\pi}{4}) = -\\frac{r}{\\sqrt{2}}$，$s_y = r\\sin(\\frac{3\\pi}{4}) = \\frac{r}{\\sqrt{2}}$。极小值点是 $(-\\frac{r}{\\sqrt{2}}, \\frac{r}{\\sqrt{2}})$。\n2. 对于 $\\theta = \\frac{5\\pi}{4}$：$s_x = r\\cos(\\frac{5\\pi}{4}) = -\\frac{r}{\\sqrt{2}}$，$s_y = r\\sin(\\frac{5\\pi}{4}) = -\\frac{r}{\\sqrt{2}}$。极小值点是 $(-\\frac{r}{\\sqrt{2}}, -\\frac{r}{\\sqrt{2}})$。\n\n问题要求选择 $y > 0$ 的极小值点，这对应于 $s_y > 0$。这是第一种情况。\n因此，显式优化步为 $s^{\\star}(r) = (-\\frac{r}{\\sqrt{2}}, \\frac{r}{\\sqrt{2}})$。分母有理化后得到 $s^{\\star}(r) = (-\\frac{\\sqrt{2}}{2}r, \\frac{\\sqrt{2}}{2}r)$。\n我们将其表示为行矩阵。\n$$\ns^{\\star}(r) = \\begin{pmatrix} -\\frac{\\sqrt{2}}{2}r  \\frac{\\sqrt{2}}{2}r \\end{pmatrix}\n$$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n-\\frac{\\sqrt{2}}{2}r  \\frac{\\sqrt{2}}{2}r\n\\end{pmatrix}\n}\n$$", "id": "3191338"}, {"introduction": "在现代优化算法中，泰勒定理不仅用于构建近似模型，还用于量化该模型的误差，从而指导算法的稳健设计。这个练习 [@problem_id:3191337] 要求你推导泰勒展开的余项的一个界，并用它来确定信赖域方法的关键超参数——信赖域半径。这个过程深刻地揭示了函数局部几何（通过高阶导数体现）与优化算法步长选择之间的内在联系。", "problem": "考虑函数 $f:\\mathbb{R}^{n}\\to\\mathbb{R}$，其定义为 $f(x)=\\|x\\|^{2}+\\alpha \\sin\\!\\big(\\beta\\,u^{\\top}x\\big)$，其中 $\\alpha>0$ 和 $\\beta>0$ 是固定的标量，而 $u\\in\\mathbb{R}^{n}$ 是满足 $\\|u\\|=1$ 的固定单位向量。令 $m_{2}(s)$ 表示函数 $f$ 在中心点 $x=0$ 处关于步长 $s\\in\\mathbb{R}^{n}$ 的二阶 Taylor 模型，这是优化中信赖域 (TR) 方法所使用的二次模型。请使用多元函数的 Taylor 定理，并仅依据基本定义和熟知事实，通过计算函数 $f$ 在球 $\\{s\\in\\mathbb{R}^{n}:\\|s\\|\\leq \\Delta\\}$ 上其 Hessian 矩阵的 Lipschitz 常数，推导出一个对于该球内所有步长 $s$ 都一致成立的二阶泰勒展开的余项 $R_{2}(s)$ 的界。然后，对于一个给定的容差 $\\tau>0$（用于衡量 Taylor 余项可接受的最大量级），确定最大的信赖域半径 $\\Delta=\\Delta(\\alpha,\\beta,\\tau)$，使得对于所有满足 $\\|s\\|\\leq \\Delta$ 的步长 $s$，都有 $|R_{2}(s)|\\leq\\tau$。请将你的最终答案表示为关于 $\\alpha$、$\\beta$ 和 $\\tau$ 的单个闭式解析表达式。无需进行数值近似或四舍五入。", "solution": "该问题是有效的。这是一个在多元微积分和数值优化领域的良态问题，基于标准的定义和定理。所有必要信息均已提供，且目标陈述清晰。我们开始求解。\n\n问题要求我们为函数 $f:\\mathbb{R}^{n}\\to\\mathbb{R}$（定义为 $f(x)=\\|x\\|^{2}+\\alpha \\sin(\\beta u^{\\top}x)$，其中 $\\alpha>0, \\beta>0$ 且 $u\\in\\mathbb{R}^{n}$ 是满足 $\\|u\\|=1$ 的单位向量）找到最大的信赖域半径 $\\Delta$。条件是，对于给定的容差 $\\tau>0$，在中心点 $x=0$ 附近的二阶泰勒展开的余项 $R_{2}(s)$ 必须对信赖域内的所有步长 $s$（即 $\\|s\\|\\leq \\Delta$）满足 $|R_{2}(s)| \\leq \\tau$。\n\n根据具有连续三阶导数的函数的 Taylor 定理，函数 $f$ 在点 $x_c$ 附近的展开式为：\n$$f(x_c+s) = f(x_c) + \\nabla f(x_c)^{\\top}s + \\frac{1}{2}s^{\\top}\\nabla^{2}f(x_c)s + R_{2}(s)$$\n其中 $s$ 是步长向量，$\\nabla f$ 是梯度，$\\nabla^{2}f$ 是 Hessian 矩阵。项 $m_2(s) = f(x_c) + \\nabla f(x_c)^{\\top}s + \\frac{1}{2}s^{\\top}\\nabla^{2}f(x_c)s$ 是 $f$ 在 $x_c$ 附近的二阶 Taylor 模型。余项 $R_{2}(s)$ 的阶为 $O(\\|s\\|^{3})$。\n\n优化理论中的一个标准结果为此余项提供了一个界。如果 Hessian 矩阵 $\\nabla^2 f(x)$ 在一个包含 $x_c$ 和 $x_c+s$ 的凸集上是 Lipschitz 连续的，常数为 $L_H$，即对于集合中所有的 $y,z$ 都有 $\\|\\nabla^{2}f(y) - \\nabla^{2}f(z)\\| \\leq L_H\\|y-z\\|$ 成立，那么余项的界为：\n$$|R_{2}(s)| = |f(x_c+s) - m_2(s)| \\leq \\frac{L_H}{6}\\|s\\|^{3}$$\nLipschitz 常数 $L_H$ 可取为三阶导数张量范数的上确界，即 $L_H = \\sup_x \\|\\nabla^3 f(x)\\|$。\n\n我们的展开以 $x_c=0$ 为中心。首先，我们计算 $f(x) = x^{\\top}x + \\alpha \\sin(\\beta u^{\\top}x)$ 的必要导数。\n\n$f(x)$ 的梯度为：\n$$\\nabla f(x) = \\frac{\\partial}{\\partial x} \\left(x^{\\top}x + \\alpha \\sin(\\beta u^{\\top}x)\\right) = 2x + \\alpha \\cos(\\beta u^{\\top}x) (\\beta u) = 2x + \\alpha\\beta\\cos(\\beta u^{\\top}x)u$$\n\n$f(x)$ 的 Hessian 矩阵是二阶偏导数矩阵：\n$$\\nabla^{2}f(x) = \\frac{\\partial}{\\partial x^{\\top}} \\left(2x + \\alpha\\beta\\cos(\\beta u^{\\top}x)u\\right) = 2I + \\alpha\\beta(-\\sin(\\beta u^{\\top}x) (\\beta u^{\\top}))u = 2I - \\alpha\\beta^{2}\\sin(\\beta u^{\\top}x)uu^{\\top}$$\n其中 $I$ 是 $n\\times n$ 单位矩阵，$uu^{\\top}$ 是一个 $n\\times n$ 矩阵。\n\n为了求出 Hessian 矩阵的 Lipschitz 常数，我们计算 $f(x)$ 的三阶导数。这是一个三阶张量，其分量为 $\\frac{\\partial^3 f(x)}{\\partial x_i \\partial x_j \\partial x_k}$。对 Hessian 矩阵求导：\n$$\\frac{\\partial}{\\partial x_k}\\left(\\nabla^{2}f(x)\\right)_{ij} = \\frac{\\partial}{\\partial x_k}\\left(2\\delta_{ij} - \\alpha\\beta^{2}\\sin(\\beta u^{\\top}x)u_{i}u_{j}\\right) = -\\alpha\\beta^{2}\\cos(\\beta u^{\\top}x)(\\beta u_{k})u_{i}u_{j} = -\\alpha\\beta^{3}\\cos(\\beta u^{\\top}x)u_{i}u_{j}u_{k}$$\n三阶导数张量作用于三个向量 $v_1, v_2, v_3 \\in \\mathbb{R}^n$ 的结果是：\n$$D^{3}f(x)[v_1,v_2,v_3] = \\sum_{i,j,k=1}^{n} \\frac{\\partial^3 f(x)}{\\partial x_i \\partial x_j \\partial x_k} (v_1)_i (v_2)_j (v_3)_k = -\\alpha\\beta^{3}\\cos(\\beta u^{\\top}x)\\sum_{i,j,k=1}^{n} u_{i}u_{j}u_{k}(v_1)_i (v_2)_j (v_3)_k$$\n这可以化简为：\n$$D^{3}f(x)[v_1,v_2,v_3] = -\\alpha\\beta^{3}\\cos(\\beta u^{\\top}x)(u^{\\top}v_1)(u^{\\top}v_2)(u^{\\top}v_3)$$\n\n该张量在点 $x$ 处的范数定义为 $\\|\\nabla^3 f(x)\\| = \\sup_{\\|v_1\\|=\\|v_2\\|=\\|v_3\\|=1} |D^{3}f(x)[v_1,v_2,v_3]|$。\n$$\\|\\nabla^3 f(x)\\| = \\sup_{\\|v_1\\|=\\|v_2\\|=\\|v_3\\|=1} |-\\alpha\\beta^{3}\\cos(\\beta u^{\\top}x)(u^{\\top}v_1)(u^{\\top}v_2)(u^{\\top}v_3)|$$\n因为 $\\alpha>0$ 和 $\\beta>0$：\n$$\\|\\nabla^3 f(x)\\| = \\alpha\\beta^{3}|\\cos(\\beta u^{\\top}x)| \\sup_{\\|v_1\\|=\\|v_2\\|=\\|v_3\\|=1} |(u^{\\top}v_1)(u^{\\top}v_2)(u^{\\top}v_3)|$$\n根据 Cauchy-Schwarz 不等式， $|u^{\\top}v| \\leq \\|u\\|\\|v\\|$。由于 $\\|u\\|=1$ 且我们取 $\\|v\\|=1$，我们有 $|u^{\\top}v| \\leq 1$。当 $v_1, v_2, v_3$ 都选择为 $u$ 或 $-u$ 时达到上确界，此时 $|u^{\\top}v|=1$。因此，上确界为 1。\n$$\\|\\nabla^3 f(x)\\| = \\alpha\\beta^{3}|\\cos(\\beta u^{\\top}x)|$$\n\n问题要求一个在球 $\\|s\\|\\leq \\Delta$ 内对所有步长 $s$ 一致成立的界。余项界使用了一个在以 $x=0$ 为中心、半径为 $\\Delta$ 的球（即集合 $\\{x \\in \\mathbb{R}^n : \\|x\\| \\leq \\Delta\\}$）上有效的 Hessian 矩阵的 Lipschitz 常数 $L_H$。\n$$L_H = \\sup_{\\|x\\|\\leq\\Delta} \\|\\nabla^3 f(x)\\| = \\sup_{\\|x\\|\\leq\\Delta} \\alpha\\beta^{3}|\\cos(\\beta u^{\\top}x)|$$\n$|\\cos(z)|$ 的最大值为 1，当 $z$ 是 $\\pi$ 的整数倍时取到。对于任何 $\\Delta > 0$，当 $\\|x\\|\\le\\Delta$ 时，自变量 $\\beta u^{\\top}x$ 的取值范围是 $[-\\beta \\Delta, \\beta \\Delta]$。这个区间总是包含 0，且 $\\cos(0)=1$。因此：\n$$\\sup_{\\|x\\|\\leq\\Delta} |\\cos(\\beta u^{\\top}x)| = 1$$\n所以，Hessian 矩阵的 Lipschitz 常数为 $L_H = \\alpha\\beta^{3}$。\n\n有了这个常数，对于任何步长 $s$，余项 $R_{2}(s)$ 的界为：\n$$|R_{2}(s)| \\leq \\frac{L_H}{6}\\|s\\|^{3} = \\frac{\\alpha\\beta^{3}}{6}\\|s\\|^{3}$$\n\n我们需要找到最大的半径 $\\Delta$，使得对于所有满足 $\\|s\\| \\leq \\Delta$ 的步长 $s$，都有 $|R_{2}(s)| \\leq \\tau$。这要求 $|R_2(s)|$ 的上界在该区域内不超过 $\\tau$。\n$$\\frac{\\alpha\\beta^{3}}{6}\\|s\\|^{3} \\leq \\tau \\quad \\forall s \\text{ such that } \\|s\\|\\leq\\Delta$$\n左侧是 $\\|s\\|$ 的单调递增函数。因此，如果该条件对于 $\\|s\\|$ 的最大值（即 $\\Delta$）成立，那么它就成立。\n$$\\frac{\\alpha\\beta^{3}}{6}\\Delta^{3} \\leq \\tau$$\n为了找到满足此不等式的最大 $\\Delta$，我们解相应的等式：\n$$\\frac{\\alpha\\beta^{3}}{6}\\Delta^{3} = \\tau$$\n$$\\Delta^{3} = \\frac{6\\tau}{\\alpha\\beta^{3}}$$\n求解 $\\Delta$，我们得到信赖域可能的最大半径：\n$$\\Delta = \\left(\\frac{6\\tau}{\\alpha\\beta^{3}}\\right)^{\\frac{1}{3}}$$\n这就提供了所要求的、用给定参数 $\\alpha$、$\\beta$ 和 $\\tau$ 表示的 $\\Delta$ 的闭式解析表达式。", "answer": "$$ \\boxed{\\left(\\frac{6\\tau}{\\alpha\\beta^{3}}\\right)^{\\frac{1}{3}}} $$", "id": "3191337"}]}