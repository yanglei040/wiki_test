{"hands_on_practices": [{"introduction": "这个练习将引导你分析一个看似简单但极具启发性的函数 $f(x)=\\|x\\|^{4}$。通过从头推导其梯度和Hessian矩阵，你将学会如何确定一个具有特定对称性（旋转不变性）的Hessian矩阵的完整特征谱，并揭示其与牛顿法在退化最小值点附近行为的深刻联系 [@problem_id:3124793]。这个实践是理解Hessian矩阵如何决定核心优化算法步长的绝佳起点。", "problem": "考虑由 $f(x)=\\|x\\|^{4}$ 定义的函数 $f:\\mathbb{R}^{n}\\to\\mathbb{R}$，其中 $\\|\\cdot\\|$ 表示欧几里得范数。从 $\\mathbb{R}^{n}$ 上光滑标量场的梯度和Hessian矩阵的核心定义出发，推导任意 $x$ 的 $\\nabla f(x)$ 和 $\\nabla^{2} f(x)$。对于任意 $x\\neq 0$，确定 $\\nabla^{2} f(x)$ 的完整特征值-特征向量结构，方法是找出 $\\nabla^{2} f(x)$ 在哪些方向上的作用等同于单位矩阵的标量倍数，并解释为何其谱仅取决于 $\\|x\\|$ 而非 $x$ 的方向（旋转下的各向同性）。然后，利用无约束最小化中牛顿步的定义线性系统，即点 $x$ 处的牛顿步 $p(x)$ 满足 $\\nabla^{2} f(x)\\,p(x)=-\\nabla f(x)$，求解 $x\\neq 0$ 时 $p(x)$ 的闭式解，并讨论在原点 $x=0$ 处Hessian矩阵奇异的背景下，当 $\\|x\\|\\to 0$ 时 $p(x)$ 的行为。将你的最终答案表示为 $p(x)$ 作为 $x$ 的函数的单个闭式解析表达式。无需四舍五入，且不涉及物理单位。", "solution": "该问题要求对函数 $f(x) = \\|x\\|^{4}$ 在 $\\mathbb{R}^{n}$ 上进行完整分析，包括其梯度、Hessian矩阵、Hessian矩阵的谱特性以及相关的无约束最小化牛顿步。\n\n首先，我们验证问题陈述。\n**第一步：提取已知条件**\n- 函数：$f(x)=\\|x\\|^{4}$，对于 $f:\\mathbb{R}^{n}\\to\\mathbb{R}$，其中 $\\|\\cdot\\|$ 是欧几里得范数。\n- 任务1：推导梯度 $\\nabla f(x)$ 和Hessian矩阵 $\\nabla^{2} f(x)$。\n- 任务2：对于任意 $x\\neq 0$，确定 $\\nabla^{2} f(x)$ 的完整特征值-特征向量结构。\n- 任务3：解释 $\\nabla^{2} f(x)$ 的谱在旋转下的各向同性。\n- 任务4：求解牛顿步方程 $\\nabla^{2} f(x)\\,p(x)=-\\nabla f(x)$，得到 $x\\neq 0$ 时牛顿步 $p(x)$ 的闭式解。\n- 任务5：在原点 $x=0$ 处Hessian矩阵奇异的背景下，讨论当 $\\|x\\|\\to 0$ 时 $p(x)$ 的行为。\n- 最终答案：$p(x)$ 作为 $x$ 的函数的单个闭式解析表达式。\n\n**第二步：使用提取的已知条件进行验证**\n该问题在数学上是良定义的且自洽的。函数 $f(x)$ 是多元微积分和最优化理论中的一个标准例子。所使用的所有概念——梯度、Hessian矩阵、特征值、特征向量和牛顿法——都是这些领域的基础。该问题具有科学依据，是客观的，并且不包含任何矛盾或缺失信息。它是指定领域内一个标准、可形式化的问题。\n\n**第三步：结论与行动**\n问题是有效的。我们继续求解。\n\n**梯度 $\\nabla f(x)$ 的推导**\n\n函数由 $f(x) = \\|x\\|^{4}$ 给出，其中 $x \\in \\mathbb{R}^{n}$。我们可以用向量 $x$ 的分量 $x_i$ 来表示它，即 $f(x) = \\left( \\sum_{i=1}^{n} x_i^{2} \\right)^{2}$。欧几里得范数的平方是 $\\|x\\|^{2} = x^{T}x$。因此，$f(x) = (x^{T}x)^{2}$。\n\n梯度 $\\nabla f(x)$ 是一个向量，其第 $k$ 个分量是偏导数 $\\frac{\\partial f}{\\partial x_k}$。我们使用链式法则：\n$$\n(\\nabla f(x))_k = \\frac{\\partial f}{\\partial x_k} = \\frac{\\partial}{\\partial x_k} \\left( \\left( \\sum_{i=1}^{n} x_i^{2} \\right)^{2} \\right)\n$$\n$$\n= 2 \\left( \\sum_{i=1}^{n} x_i^{2} \\right) \\cdot \\frac{\\partial}{\\partial x_k} \\left( \\sum_{i=1}^{n} x_i^{2} \\right)\n$$\n和的导数是 $\\frac{\\partial}{\\partial x_k} \\left( \\sum_{i=1}^{n} x_i^{2} \\right) = 2x_k$。\n将其代回，我们得到：\n$$\n\\frac{\\partial f}{\\partial x_k} = 2 \\|x\\|^{2} \\cdot (2x_k) = 4\\|x\\|^{2} x_k\n$$\n以向量形式表示，这意味着梯度为：\n$$\n\\nabla f(x) = 4\\|x\\|^{2} x\n$$\n\n**Hessian矩阵 $\\nabla^{2} f(x)$ 的推导**\n\nHessian矩阵 $\\nabla^{2} f(x)$ 的元素为 $(\\nabla^{2} f(x))_{jk} = \\frac{\\partial^{2} f}{\\partial x_j \\partial x_k}$。我们将梯度的第 $k$ 个分量对 $x_j$ 求导：\n$$\n\\frac{\\partial^{2} f}{\\partial x_j \\partial x_k} = \\frac{\\partial}{\\partial x_j} \\left( 4\\|x\\|^{2} x_k \\right) = \\frac{\\partial}{\\partial x_j} \\left[ 4 \\left( \\sum_{i=1}^{n} x_i^{2} \\right) x_k \\right]\n$$\n使用乘法求导法则：\n$$\n\\frac{\\partial^{2} f}{\\partial x_j \\partial x_k} = 4x_k \\frac{\\partial}{\\partial x_j} \\left( \\sum_{i=1}^{n} x_i^{2} \\right) + 4 \\left( \\sum_{i=1}^{n} x_i^{2} \\right) \\frac{\\partial x_k}{\\partial x_j}\n$$\n各项求值结果为：\n- $\\frac{\\partial}{\\partial x_j} \\left( \\sum_{i=1}^{n} x_i^{2} \\right) = 2x_j$\n- $\\frac{\\partial x_k}{\\partial x_j} = \\delta_{jk}$ (克罗内克δ)\n\n将这些代入，我们得到Hessian矩阵的元素：\n$$\n(\\nabla^{2} f(x))_{jk} = 4x_k(2x_j) + 4\\|x\\|^{2}\\delta_{jk} = 8x_j x_k + 4\\|x\\|^{2}\\delta_{jk}\n$$\n在矩阵表示法中，项 $x_j x_k$ 对应于外积矩阵 $xx^{T}$，项 $\\delta_{jk}$ 对应于单位矩阵 $I$。因此，Hessian矩阵为：\n$$\n\\nabla^{2} f(x) = 8xx^{T} + 4\\|x\\|^{2} I\n$$\n\n**$x \\neq 0$ 时 $\\nabla^{2} f(x)$ 的特征值和特征向量结构**\n\nHessian矩阵为 $\\nabla^{2} f(x) = 8xx^{T} + 4\\|x\\|^{2} I$。为了找到特征值和特征向量，我们考虑向量 $v \\in \\mathbb{R}^{n}$ 的两种情况。\n\n情况1：$v$ 与 $x$ 平行。\n设 $v = \\alpha x$，其中 $\\alpha \\neq 0$ 为某个标量。不失一般性，我们可以直接测试向量 $x$ 本身。\n$$\n(\\nabla^{2} f(x)) x = (8xx^{T} + 4\\|x\\|^{2} I)x = 8x(x^{T}x) + 4\\|x\\|^{2}(Ix) = 8x\\|x\\|^{2} + 4\\|x\\|^{2}x = 12\\|x\\|^{2}x\n$$\n这表明 $x$ 是 $\\nabla^{2} f(x)$ 的一个特征向量，对应的特征值为 $\\lambda_1 = 12\\|x\\|^{2}$。该特征值对应的特征空间是由 $x$ 张成的一维子空间，即 $\\text{span}\\{x\\}$。\n\n情况2：$v$ 与 $x$ 正交。\n设 $v$ 是任意满足 $x^{T}v = 0$ 的非零向量。\n$$\n(\\nabla^{2} f(x)) v = (8xx^{T} + 4\\|x\\|^{2} I)v = 8x(x^{T}v) + 4\\|x\\|^{2}(Iv) = 8x(0) + 4\\|x\\|^{2}v = 4\\|x\\|^{2}v\n$$\n这表明任何与 $x$ 正交的向量 $v$ 都是 $\\nabla^{2} f(x)$ 的特征向量，对应的特征值为 $\\lambda_2 = 4\\|x\\|^{2}$。与 $x$ 正交的向量空间（$\\text{span}\\{x\\}$ 的正交补）维度为 $n-1$。因此，$\\lambda_2 = 4\\|x\\|^{2}$ 是一个重数为 $n-1$ 的特征值。\n\n总之，对于 $x \\neq 0$，Hessian矩阵 $\\nabla^{2} f(x)$ 有两个不同的特征值：\n- $\\lambda_1 = 12\\|x\\|^{2}$，重数为1，其特征空间为 $\\text{span}\\{x\\}$。\n- $\\lambda_2 = 4\\|x\\|^{2}$，重数为 $n-1$，其特征空间为 $\\{v \\in \\mathbb{R}^{n} \\mid x^{T}v=0\\}$。\n\n**特征值谱的各向同性**\n\n特征值 $\\lambda_1 = 12\\|x\\|^{2}$ 和 $\\lambda_2 = 4\\|x\\|^{2}$ 仅取决于标量 $\\|x\\|$，即 $x$ 的欧几里得范数。它们不依赖于向量 $x$ 的方向。因此，对于任意两个具有相同范数（$\\|x\\|=\\|y\\|$）的向量 $x$ 和 $y$，$\\nabla^{2} f(x)$ 的谱将与 $\\nabla^{2} f(y)$ 的谱完全相同。\n更形式化地，考虑一个旋转，它由一个正交矩阵 $R$ 表示（满足 $R^T R = I$ 且 $\\det(R)=1$）。向量 $Rx$ 是 $x$ 旋转后的版本，且 $\\|Rx\\|^{2} = (Rx)^{T}(Rx) = x^{T}R^{T}Rx = x^{T}Ix = \\|x\\|^{2}$。在旋转后的点 $Rx$ 处的Hessian矩阵为：\n$$\n\\nabla^{2} f(Rx) = 8(Rx)(Rx)^{T} + 4\\|Rx\\|^{2}I = 8Rxx^{T}R^{T} + 4\\|x\\|^{2}RR^{T} = R(8xx^{T} + 4\\|x\\|^{2}I)R^{T}\n$$\n所以，$\\nabla^{2} f(Rx) = R(\\nabla^{2} f(x))R^{T}$。这表明在 $Rx$ 处的Hessian矩阵通过一个相似变换与在 $x$ 处的Hessian矩阵相关。由于相似变换保持特征值不变，$\\nabla^{2} f(x)$ 的谱在 $x$ 的旋转下是不变的。这种各向同性是原始函数 $f(x) = \\|x\\|^{4}$ 旋转不变性的直接结果，因为 $f(Rx) = \\|Rx\\|^{4} = \\|x\\|^{4} = f(x)$。\n\n**求解牛顿步 $p(x)$**\n\n牛顿步 $p(x)$ 由线性系统 $\\nabla^{2} f(x) p(x) = -\\nabla f(x)$ 定义。对于 $x \\neq 0$，梯度和Hessian矩阵均非零。Hessian矩阵的特征值（$12\\|x\\|^{2}$ 和 $4\\|x\\|^{2}$）是严格正的，因此Hessian矩阵是正定的，从而可逆。这保证了 $p(x)$ 有唯一解。\n代入梯度和Hessian矩阵的表达式：\n$$\n(8xx^{T} + 4\\|x\\|^{2} I) p(x) = -4\\|x\\|^{2} x\n$$\n鉴于右侧是 $x$ 的一个倍数，我们可以假设一个形式为 $p(x) = c x$ 的解，其中 $c$ 是某个标量。将此拟设代入方程：\n$$\n(8xx^{T} + 4\\|x\\|^{2} I) (cx) = -4\\|x\\|^{2} x\n$$\n$$\nc(8xx^{T}x + 4\\|x\\|^{2}Ix) = -4\\|x\\|^{2} x\n$$\n$$\nc(8x\\|x\\|^{2} + 4\\|x\\|^{2}x) = -4\\|x\\|^{2} x\n$$\n$$\nc(12\\|x\\|^{2}x) = -4\\|x\\|^{2} x\n$$\n$$\n12c\\|x\\|^{2}x = -4\\|x\\|^{2}x\n$$\n由于该方程对任意 $x \\neq 0$ 都必须成立，我们可以令标量系数相等：\n$$\n12c\\|x\\|^{2} = -4\\|x\\|^{2}\n$$\n由于 $x \\neq 0$，我们有 $\\|x\\|^{2} \\neq 0$，所以可以两边同除以它来求 $c$：\n$$\n12c = -4 \\implies c = -\\frac{4}{12} = -\\frac{1}{3}\n$$\n因此，牛顿步为：\n$$\np(x) = -\\frac{1}{3}x\n$$\n\n**当 $\\|x\\| \\to 0$ 时的行为以及在原点的奇异Hessian矩阵**\n\n我们来考察原点 $x=0$ 处的情况。\n在原点的梯度为 $\\nabla f(0) = 4\\|0\\|^{2}(0) = 0$。\n在原点的Hessian矩阵为 $\\nabla^{2} f(0) = 8(0)(0)^{T} + 4\\|0\\|^{2}I = 0$，即零矩阵。\n零矩阵是奇异的（其所有特征值均为0）。\n在 $x=0$ 处的牛顿步方程变为：\n$$\n\\nabla^{2} f(0) p(0) = -\\nabla f(0) \\implies 0 \\cdot p(0) = 0\n$$\n此方程对任意向量 $p(0) \\in \\mathbb{R}^{n}$ 都成立，意味着牛顿步在原点没有唯一定义。\n然而，如果我们考虑当 $x$ 趋近于 $0$ 时牛顿步的极限：\n$$\n\\lim_{x \\to 0} p(x) = \\lim_{x \\to 0} \\left(-\\frac{1}{3}x\\right) = 0\n$$\n该极限存在且为零向量。因此，虽然牛顿步在奇异点 $x=0$ 处形式上是不确定的，但可以通过连续性来定义。在最优化背景下，这意味着对于任意接近最小值点 $0$ 的点 $x_k$，下一个迭代点将是 $x_{k+1} = x_k + p(x_k) = x_k - \\frac{1}{3}x_k = \\frac{2}{3}x_k$。这表明以 $\\frac{2}{3}$ 的速率线性收敛到最小值点，这比牛顿法在最小值点Hessian矩阵非奇异的函数上所期望的二次收敛要慢。这种减速是由于函数 $f(x)=\\|x\\|^4$ 在其最小值点附近的平坦性，其特征是奇异（零）的Hessian矩阵。\n\n问题要求给出 $p(x)$ 作为 $x$ 的函数的单个闭式解析表达式。这就是为 $x \\neq 0$ 推导出的结果，该结果在 $x=0$ 处也是连续的。", "answer": "$$\n\\boxed{-\\frac{1}{3}x}\n$$", "id": "3124793"}, {"introduction": "在掌握了单点曲率分析后，下一个挑战是理解函数曲率如何在整个定义域内变化。这个练习将带你探索一个包含参数的四次函数，通过计算其Hessian矩阵的行列式，你将能够精确地找出曲率特性发生质变（例如，从凸变为鞍形）的边界线 [@problem_id:3124817]。这项技能对于在复杂优化问题中建立几何直觉至关重要。", "problem": "考虑一个二阶连续可微的标量场 $f(x,y)=x^{4}-y^{4}+\\alpha x^{2}y^{2}$，其中参数 $\\alpha0$。函数 $f$ 在点 $(x,y)$ 处的Hessian矩阵定义为二阶偏导数构成的 $2\\times 2$ 矩阵。Hessian矩阵的特征值和特征向量刻画了沿主方向的局部二次曲率。在二维情况下，曲率的定性变化（例如，在Hessian矩阵为定、不定或奇异的区域之间的过渡）发生在Hessian矩阵的一个特征值消失的轨迹上，这标志着特征值符号发生变化的边界。仅使用核心定义，确定直线 $y=mx$ 的斜率平方 $m^{2}$ 的解析表达式，沿着这些直线，Hessian矩阵的一个特征值变为零（不包括退化的原点）。你的最终答案必须是只含 $\\alpha$ 的单个封闭形式表达式。无需四舍五入，且不涉及物理单位。", "solution": "函数 $f(x,y)$ 的Hessian矩阵 $H(x,y)$ 定义为\n$$\nH(x,y)=\\begin{pmatrix}\n\\frac{\\partial^{2}f}{\\partial x^{2}}  \\frac{\\partial^{2}f}{\\partial x \\partial y}\\\\[4pt]\n\\frac{\\partial^{2}f}{\\partial y \\partial x}  \\frac{\\partial^{2}f}{\\partial y^{2}}\n\\end{pmatrix}.\n$$\n对于给定的函数 $f(x,y)=x^{4}-y^{4}+\\alpha x^{2}y^{2}$，我们从基本原理计算其二阶导数：\n- 一阶导数为 $\\frac{\\partial f}{\\partial x}=4x^{3}+2\\alpha xy^{2}$ 和 $\\frac{\\partial f}{\\partial y}=-4y^{3}+2\\alpha x^{2}y$。\n- 二阶导数为\n$$\n\\frac{\\partial^{2}f}{\\partial x^{2}}=12x^{2}+2\\alpha y^{2},\\quad\n\\frac{\\partial^{2}f}{\\partial y^{2}}=-12y^{2}+2\\alpha x^{2},\\quad\n\\frac{\\partial^{2}f}{\\partial x\\partial y}=\\frac{\\partial^{2}f}{\\partial y\\partial x}=4\\alpha xy.\n$$\n因此，\n$$\nH(x,y)=\\begin{pmatrix}\n12x^{2}+2\\alpha y^{2}  4\\alpha xy\\\\[4pt]\n4\\alpha xy  -12y^{2}+2\\alpha x^{2}\n\\end{pmatrix}.\n$$\n在二维情况下，Hessian矩阵特征值符号模式的改变发生在其中一个特征值变为零的点集上。对于一个 $2\\times 2$ 的对称矩阵，特征值的乘积等于其行列式，因此，当且仅当Hessian矩阵的行列式为零时，会出现零特征值。所以，一个特征值为零的轨迹由 $\\det(H(x,y))=0$ 给出。\n\n我们计算 $\\det(H)$：\n\\begin{align*}\n\\det(H)\n=(12x^{2}+2\\alpha y^{2})(-12y^{2}+2\\alpha x^{2})-(4\\alpha xy)^{2}\\\\\n=-144x^{2}y^{2}+24\\alpha x^{4}-24\\alpha y^{4}+4\\alpha^{2}x^{2}y^{2}-16\\alpha^{2}x^{2}y^{2}\\\\\n=24\\alpha x^{4}-24\\alpha y^{4}-144x^{2}y^{2}-12\\alpha^{2}x^{2}y^{2}.\n\\end{align*}\n引入比率 $t=\\frac{y^{2}}{x^{2}}$ (当 $x\\neq 0$ 时有效) 后，提出因子 $12x^{4}$，得到\n$$\n\\frac{\\det(H)}{12x^{4}}=2\\alpha-2\\alpha t^{2}-12t-\\alpha^{2}t.\n$$\n令 $\\det(H)=0$ 得到关于 $t$ 的二次方程：\n$$\n2\\alpha t^{2}+(12+\\alpha^{2})t-2\\alpha=0.\n$$\n使用二次公式求解 $t$，\n\\begin{align*}\nt\n=\\frac{-(12+\\alpha^{2})\\pm\\sqrt{(12+\\alpha^{2})^{2}+16\\alpha^{2}}}{4\\alpha}\\\\\n=\\frac{-(12+\\alpha^{2})\\pm\\sqrt{\\alpha^{4}+40\\alpha^{2}+144}}{4\\alpha}.\n\\end{align*}\n由于 $t=\\frac{y^{2}}{x^{2}}\\geq 0$ 且 $\\alpha0$，相关的分支是平方根前带加号的那个，因为\n$$\n\\sqrt{\\alpha^{4}+40\\alpha^{2}+144}(12+\\alpha^{2}),\n$$\n使得分子为正，因此 $t\\geq 0$。带减号的分支会得到一个负的分子，从而得到一个负的 $t$，这对于 $\\frac{y^{2}}{x^{2}}$ 是不可接受的。\n\n因此，沿着直线 $y=\\pm\\sqrt{t}\\,x$ 且\n$$\nt=\\frac{-\\left(12+\\alpha^{2}\\right)+\\sqrt{\\alpha^{4}+40\\alpha^{2}+144}}{4\\alpha},\n$$\nHessian矩阵有一个零特征值，并且这些射线构成了Hessian矩阵特征值改变符号的鞍线边界。为了验证这些确实是曲率发生转变的主方向，可以观察到，沿着 $y=sx$（其中 $s=\\pm\\sqrt{t}$），Hessian矩阵与 $x^{2}$ 乘以一个常系数对称矩阵成比例，并且它的核（对应零特征值的特征向量）在每条射线上方向恒定。具体来说，在射线上将 $H(x,y)$ 写成 $x^{2}M(s)$，零特征向量 $v$ 满足 $M(s)v=0$，其分量之比 $v_{2}/v_{1}$ 由下式给出\n$$\n\\frac{v_{2}}{v_{1}}=-\\frac{12+2\\alpha s^{2}}{4\\alpha s}=-\\left(\\frac{3}{\\alpha s}+\\frac{s}{2}\\right),\n$$\n该比值仅依赖于 $s$，因此沿着射线保持不变，这证实了零曲率主方向是沿着鞍线边界的直线场。根据要求，表征特征值消失位置的关键封闭形式量是上述的 $m^{2}=t$。", "answer": "$$\\boxed{\\frac{-\\left(12+\\alpha^{2}\\right)+\\sqrt{\\alpha^{4}+40\\alpha^{2}+144}}{4\\alpha}}$$", "id": "3124817"}, {"introduction": "理论的最终目的是指导实践。在这个压轴练习中，你将把对Hessian特征值的理解应用于设计一个更稳健的优化算法 [@problem_id:3124776]。你将亲手实现一个“谱截断牛顿法”，通过编程解决一个标准牛顿法难以处理的“平坦山脊”问题，直观感受Hessian谱分析在现代计算科学中的实际威力。", "problem": "考虑使用牛顿类方法对一个二次连续可微函数 $f : \\mathbb{R}^n \\to \\mathbb{R}$ 进行无约束最小化。经典牛顿法通过最小化 $f$ 在当前迭代点周围的局部二阶泰勒近似来选择更新方向。在存在曲率非常小的方向（“平坦山脊”）时，海森矩阵可能具有接近于零的特征值，这使得纯牛顿步不稳定或无效。\n\n您的任务是设计并实现一种谱截断牛顿法，该方法在每次迭代时，将海森矩阵分解为其特征值和特征向量，并跳过沿特征值低于用户指定阈值 $\\tau$ 的特征向量的更新。然后，分析该方法在一个具有平坦山脊的函数上的收敛行为。\n\n您应使用的基本原理：\n- 梯度 $\\nabla f(\\mathbf{x})$ 和海森矩阵 $\\nabla^2 f(\\mathbf{x})$ 由一阶和二阶导数定义，牛顿方向是使 $f$ 在当前点的二阶泰勒模型最小化的方向。\n- 对于对称矩阵 $\\mathbf{H}$，谱（特征）分解得出 $\\mathbf{H} = \\mathbf{Q} \\mathbf{\\Lambda} \\mathbf{Q}^\\top$，其中 $\\mathbf{Q}$ 是标准正交矩阵，$\\mathbf{\\Lambda}$ 是对角矩阵，其对角线元素是特征值，任何向量都可以投影到该特征基上。\n\n特定于问题的设置：\n- 在 $\\mathbb{R}^2$ 中处理目标函数\n$$\nf(x_1, x_2) = (x_1 - 1)^2 + x_2^4,\n$$\n该函数在 $x_2 = 0$ 附近的 $x_2$ 轴上有一个平坦的山脊。唯一的全局最小值点位于 $(x_1^\\star, x_2^\\star) = (1, 0)$。\n- 在每次迭代 $(x_1, x_2)$ 时，构建海森矩阵，计算其特征值和特征向量，并构造一个仅使用与大于或等于阈值 $\\tau  0$ 的特征值相关联的分量的更新方向。直观地说，沿曲率足够大的方向使用完整的牛顿步，并跳过曲率低于 $\\tau$ 的山脊方向的更新。\n- 更新时使用单位步长。当更新步长的欧几里得范数小于容差 $\\varepsilon_{\\text{step}}$ 或达到最大迭代次数 $N_{\\max}$ 时，终止迭代。此问题中没有物理单位；所有量均为无量纲实数。\n\n测试套件：\n在以下 $5$ 个测试用例上运行您的方法，每个用例由 $(x_1^{(0)}, x_2^{(0)}, \\tau)$ 指定，其中 $N_{\\max} = 100$ 且 $\\varepsilon_{\\text{step}} = 10^{-15}$：\n- 测试 $1$：$(0.0, 1.0, 10^{-12})$\n- 测试 $2$：$(0.0, 1.0, 0.05)$\n- 测试 $3$：$(0.0, 0.1, 0.5)$\n- 测试 $4$：$(10.0, 0.2, 3.0)$\n- 测试 $5$：$(-5.0, 0.0, 0.01)$\n\n对于每个测试用例，在终止后，计算最终迭代点 $(x_1^{(f)}, x_2^{(f)})$ 到 $(1, 0)$ 的欧几里得距离，即\n$$\nd = \\sqrt{(x_1^{(f)} - 1)^2 + (x_2^{(f)} - 0)^2}.\n$$\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，$[d_1,d_2,d_3,d_4,d_5]$），其中 $d_i$ 是测试 $i$ 的距离。每个 $d_i$ 必须是一个实数（浮点数）。不应打印任何附加文本。", "solution": "用户提供的问题被评估为有效。这是一个数值优化领域中定义明确的问题，基于已建立的数学原理。问题陈述是自包含的，提供了所有必要的数据和条件。目标明确，要求的输出也很具体。\n\n该问题要求实现并分析一种谱截断牛顿法，用于最小化函数 $f(x_1, x_2) = (x_1 - 1)^2 + x_2^4$。该函数的特点是在最小值点附近的 $x_2$ 轴上有一个“平坦山脊”，这可能对标准优化算法构成挑战。所提出的方法根据局部曲率调整更新步长，该曲率编码在海森矩阵的特征值中。\n\n首先，我们构建必要的数学组件。要最小化的函数是 $f : \\mathbb{R}^2 \\to \\mathbb{R}$，由\n$$\nf(x_1, x_2) = (x_1 - 1)^2 + x_2^4\n$$\n给出。唯一的全局最小值点在 $\\mathbf{x}^\\star = (1, 0)$，此时 $f(1, 0) = 0$。\n\n$f$ 的梯度，记为 $\\nabla f(\\mathbf{x})$，是其一阶偏导数的向量：\n$$\n\\nabla f(\\mathbf{x}) = \\begin{pmatrix} \\frac{\\partial f}{\\partial x_1} \\\\ \\frac{\\partial f}{\\partial x_2} \\end{pmatrix} = \\begin{pmatrix} 2(x_1 - 1) \\\\ 4x_2^3 \\end{pmatrix}\n$$\n\n$f$ 的海森矩阵，记为 $\\nabla^2 f(\\mathbf{x})$ 或 $\\mathbf{H}(\\mathbf{x})$，是其二阶偏导数的矩阵：\n$$\n\\mathbf{H}(\\mathbf{x}) = \\begin{pmatrix} \\frac{\\partial^2 f}{\\partial x_1^2}  \\frac{\\partial^2 f}{\\partial x_1 \\partial x_2} \\\\ \\frac{\\partial^2 f}{\\partial x_2 \\partial x_1}  \\frac{\\partial^2 f}{\\partial x_2^2} \\end{pmatrix} = \\begin{pmatrix} 2  0 \\\\ 0  12x_2^2 \\end{pmatrix}\n$$\n对于任何点 $\\mathbf{x} = (x_1, x_2)$，海森矩阵都是一个对角矩阵。这极大地简化了谱分析。对角矩阵的特征值是其对角线上的元素，而标准基向量是相应的特征向量。\n特征值为：\n$$\n\\lambda_1 = 2\n$$\n$$\n\\lambda_2 = 12x_2^2\n$$\n相应的标准正交特征向量为：\n$$\n\\mathbf{q}_1 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} \\quad \\text{和} \\quad \\mathbf{q}_2 = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\n$$\n特征值 $\\lambda_1 = 2$ 是恒定的，表示在 $x_1$ 方向上具有恒定的正曲率。特征值 $\\lambda_2 = 12x_2^2$ 取决于 $x_2$。当 $x_2$ 趋近于 $0$ 时，$\\lambda_2$ 也趋近于 $0$，表明 $x_2$ 方向的曲率变得极小。这对应于问题中提到的“平坦山脊”。\n\n经典牛顿法在迭代点 $\\mathbf{x}_k$ 的更新方向 $\\mathbf{p}_k$ 是通过求解线性系统 $\\mathbf{H}(\\mathbf{x}_k) \\mathbf{p}_k = -\\nabla f(\\mathbf{x}_k)$ 得到的。解为 $\\mathbf{p}_k = -\\mathbf{H}(\\mathbf{x}_k)^{-1} \\nabla f(\\mathbf{x}_k)$。使用谱分解 $\\mathbf{H} = \\mathbf{Q} \\mathbf{\\Lambda} \\mathbf{Q}^\\top$，更新方向可以表示为来自每个特征向量方向的贡献之和：\n$$\n\\mathbf{p}_k = - \\sum_{i=1}^{2} \\frac{\\mathbf{q}_i^\\top \\nabla f(\\mathbf{x}_k)}{\\lambda_i} \\mathbf{q}_i\n$$\n此公式表明，沿每个特征向量 $\\mathbf{q}_i$ 的更新量由特征值 $\\lambda_i$ 的倒数进行缩放。如果一个特征值接近于零，这个缩放因子会变得非常大，可能导致不稳定且过大的更新步长。\n\n谱截断牛顿法通过忽略与小于给定阈值 $\\tau  0$ 的特征值相关联的更新分量来解决此问题。修改后的更新方向（我们仍称之为 $\\mathbf{p}_k$）构造如下：\n$$\n\\mathbf{p}_k = - \\sum_{i \\text{ s.t. } \\lambda_i \\ge \\tau} \\frac{\\mathbf{q}_i^\\top \\nabla f(\\mathbf{x}_k)}{\\lambda_i} \\mathbf{q}_i\n$$\n让我们为我们的问题推导 $\\mathbf{p}_k$ 的具体分量。设 $\\mathbf{x}_k = (x_{1,k}, x_{2,k})$。\n梯度为 $\\mathbf{g}_k = \\nabla f(\\mathbf{x}_k) = \\begin{pmatrix} 2(x_{1,k} - 1) \\\\ 4x_{2,k}^3 \\end{pmatrix}$。\n梯度在特征向量上的投影为：\n$$\n\\mathbf{q}_1^\\top \\mathbf{g}_k = \\begin{pmatrix} 1  0 \\end{pmatrix} \\begin{pmatrix} 2(x_{1,k} - 1) \\\\ 4x_{2,k}^3 \\end{pmatrix} = 2(x_{1,k} - 1)\n$$\n$$\n\\mathbf{q}_2^\\top \\mathbf{g}_k = \\begin{pmatrix} 0  1 \\end{pmatrix} \\begin{pmatrix} 2(x_{1,k} - 1) \\\\ 4x_{2,k}^3 \\end{pmatrix} = 4x_{2,k}^3\n$$\n然后通过检查每个分量的条件 $\\lambda_i \\ge \\tau$ 来构造更新方向 $\\mathbf{p}_k = \\begin{pmatrix} p_{1,k} \\\\ p_{2,k} \\end{pmatrix}$。\n\n对于第一个分量（沿 $\\mathbf{q}_1 = [1, 0]^\\top$）：\n特征值为 $\\lambda_1 = 2$。如果 $2 \\ge \\tau$，则更新分量为 $p_{1,k} = -\\frac{2(x_{1,k}-1)}{2} = -(x_{1,k} - 1)$。如果 $2  \\tau$，则跳过此分量，因此 $p_{1,k} = 0$。\n\n对于第二个分量（沿 $\\mathbf{q}_2 = [0, 1]^\\top$）：\n特征值为 $\\lambda_2 = 12x_{2,k}^2$。如果 $12x_{2,k}^2 \\ge \\tau$，并假设 $x_{2,k} \\neq 0$，则更新分量为 $p_{2,k} = -\\frac{4x_{2,k}^3}{12x_{2,k}^2} = -\\frac{x_{2,k}}{3}$。如果 $x_{2,k} = 0$，则 $\\lambda_2=0$，并且由于 $\\tau0$，条件 $0 \\ge \\tau$ 为假，从而正确地得到 $p_{2,k}=0$。$x_{2,k}=0$ 的情况无需特殊处理。如果 $12x_{2,k}^2  \\tau$，则跳过此分量，因此 $p_{2,k} = 0$。\n\n迭代算法如下：\n1. 初始化 $\\mathbf{x}_0 = (x_1^{(0)}, x_2^{(0)})$。\n2. 对于 $k=0, 1, \\dots, N_{\\max}-1$：\n   a. 设 $\\mathbf{x}_k = (x_{1,k}, x_{2,k})$。\n   b. 计算更新方向分量：\n      $p_{1,k} = \\begin{cases} -(x_{1,k}-1)  \\text{如果 } 2 \\ge \\tau \\\\ 0  \\text{如果 } 2  \\tau \\end{cases}$\n      $p_{2,k} = \\begin{cases} -x_{2,k}/3  \\text{如果 } 12x_{2,k}^2 \\ge \\tau \\\\ 0  \\text{如果 } 12x_{2,k}^2  \\tau \\end{cases}$\n   c. 构造更新向量 $\\mathbf{p}_k = \\begin{pmatrix} p_{1,k} \\\\ p_{2,k} \\end{pmatrix}$。\n   d. 检查终止条件：如果欧几里得范数 $\\|\\mathbf{p}_k\\|_2  \\varepsilon_{\\text{step}}$，则终止循环。\n   e. 使用单位步长更新迭代点：$\\mathbf{x}_{k+1} = \\mathbf{x}_k + \\mathbf{p}_k$。\n3. 设最终迭代点为 $\\mathbf{x}^{(f)}$。\n4. 计算到真正最小值点 $\\mathbf{x}^\\star = (1, 0)$ 的最终距离：$d = \\|\\mathbf{x}^{(f)} - \\mathbf{x}^\\star\\|_2 = \\sqrt{(x_1^{(f)} - 1)^2 + (x_2^{(f)})^2}$。\n\n此算法针对指定的五个测试用例中的每一个进行实现。$\\tau$ 的选择对收敛性有关键影响。如果 $\\tau$ 太大，可能会过早地停止某些方向的更新，导致算法停滞在远离最优点的地方。如果 $\\tau$ 太小，算法的行为会像标准牛顿法，虽然对于这个特定问题可能收敛得很好，但在具有不定海森矩阵的更复杂场景中可能会不稳定。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\n#\n# Execution Environment:\n# language: Python\n# version: 3.12\n# libraries:\n#   - name: numpy\n#     version: 1.23.5\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Implements and runs the spectral-truncated Newton method for a set of\n    test cases to minimize f(x1, x2) = (x1 - 1)^2 + x2^4.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (initial_x1, initial_x2, threshold_tau)\n    test_cases = [\n        (0.0, 1.0, 10**-12),\n        (0.0, 1.0, 0.05),\n        (0.0, 0.1, 0.5),\n        (10.0, 0.2, 3.0),\n        (-5.0, 0.0, 0.01),\n    ]\n\n    # Constants for the optimization algorithm\n    N_max = 100\n    eps_step = 1e-15\n    x_star = np.array([1.0, 0.0])\n\n    results = []\n    for case in test_cases:\n        x1_0, x2_0, tau = case\n        x = np.array([x1_0, x2_0], dtype=float)\n\n        for _ in range(N_max):\n            x1, x2 = x[0], x[1]\n            \n            # The Hessian is diagonal: H = [[2, 0], [0, 12*x2^2]].\n            # Eigenvalues are the diagonal entries.\n            lambda1 = 2.0\n            lambda2 = 12.0 * x2**2\n            \n            # Initialize update direction vector p\n            p = np.zeros(2)\n\n            # Component 1 (along eigenvector q1 = [1, 0])\n            # The full Newton step component would be -(x1 - 1).\n            # We apply this step only if the eigenvalue is not too small.\n            if lambda1 = tau:\n                p[0] = -(x1 - 1)\n            \n            # Component 2 (along eigenvector q2 = [0, 1])\n            # The full Newton step component would be -x2 / 3.\n            # We apply this step only if the eigenvalue is not too small.\n            # The check `lambda2 = tau` also handles the x2=0 case, as\n            # lambda2 would be 0, and tau is specified to be  0.\n            if lambda2 = tau:\n                p[1] = -x2 / 3.0\n            \n            # Check for termination based on the norm of the update step\n            step_norm = np.linalg.norm(p)\n            if step_norm  eps_step:\n                break\n\n            # Update the iterate with a unit step size\n            x = x + p\n\n        # After the loop terminates (by convergence or max iterations),\n        # calculate the Euclidean distance to the global minimum.\n        final_distance = np.linalg.norm(x - x_star)\n        results.append(final_distance)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{d:.12f}' for d in results)}]\")\n\nsolve()\n\n```", "id": "3124776"}]}