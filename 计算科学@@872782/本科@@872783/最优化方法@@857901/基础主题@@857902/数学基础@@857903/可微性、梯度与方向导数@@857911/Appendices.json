{"hands_on_practices": [{"introduction": "我们将从一个平滑但增长迅速的函数开始。这个练习将检验你在多变量情境下应用链式法则的能力。更重要的是，它揭示了优化中的一个实际问题——“梯度爆炸”，并介绍了一种常见的修正方法：基于二阶模型的步长阻尼[@problem_id:3120161]。", "problem": "考虑函数 $f:\\mathbb{R}^{n}\\to\\mathbb{R}$，其定义为 $f(x)=\\exp\\!\\big(\\|x\\|_{2}^{2}\\big)$，其中 $\\|x\\|_{2}$ 表示欧几里得范数（二范数）。在多元微积分的标准定义下进行计算：梯度 $\\nabla f(x)$ 是对每个方向 $u\\in\\mathbb{R}^{n}$ 满足 $D_{u}f(x)=\\nabla f(x)\\cdot u$ 的唯一向量，其中 $D_{u}f(x)$ 是 $f$ 在点 $x$ 处沿方向 $u$ 的方向导数；海森矩阵 $\\nabla^{2}f(x)$ 是二阶偏导数矩阵。在整个问题中，假设 $x\\neq 0$。\n\n1. 从梯度的定义和链式法则出发，推导给定函数 $f(x)$ 的梯度 $\\nabla f(x)$。\n\n2. 将梯度范数 $\\|\\nabla f(x)\\|_{2}$ 表示为仅关于 $r=\\|x\\|_{2}$ 的函数，并基于此表达式简要解释为什么当 $r$ 增大时，梯度范数会变得很大。\n\n3. 在优化方法中，一个常见的步长阻尼策略是沿单位下降方向移动，而不是原始梯度方向。设 $u(x)=-\\nabla f(x)/\\|\\nabla f(x)\\|_{2}$ 为在点 $x$ 处的单位负梯度方向。考虑一维函数 $g(\\alpha)=f\\big(x+\\alpha\\,u(x)\\big)$，其中 $\\alpha\\in\\mathbb{R}$ 是一个标量步长。使用 $g(\\alpha)$ 在 $\\alpha=0$ 处的二阶泰勒展开，推导使二次模型 $g(0)+g^{\\prime}(0)\\,\\alpha+\\tfrac{1}{2}g^{\\prime\\prime}(0)\\,\\alpha^{2}$ 最小化的值 $\\alpha^{\\star}$，并将 $\\alpha^{\\star}$ 仅用 $r=\\|x\\|_{2}$ 符号化地表示出来。\n\n将 $\\alpha^{\\star}$ 的单一表达式作为最终答案。无需四舍五入。", "solution": "该问题经验证是自洽的、有科学依据且定义明确的。函数 $f(x) = \\exp(\\|x\\|_2^2)$ 对所有 $x \\in \\mathbb{R}^n$ 都是无限可微的。条件 $x \\neq 0$ 确保了梯度非零，因此单位方向 $u(x)$ 是良定义的。解题过程按顺序回答这三个部分。\n\n设 $r = \\|x\\|_2 = \\sqrt{\\sum_{i=1}^n x_i^2}$。该函数可以写成 $f(x) = \\exp(r^2)$。\n\n### 1. 推导梯度 $\\nabla f(x)$\n\n为求 $f(x) = \\exp(\\|x\\|_2^2)$ 的梯度，我们应用链式法则。设外层函数为 $g(y) = \\exp(y)$，内层函数为 $h(x) = \\|x\\|_2^2 = \\sum_{i=1}^n x_i^2$。则 $f(x) = g(h(x))$。梯度的链式法则表明 $\\nabla f(x) = g'(h(x)) \\nabla h(x)$。\n\n首先，我们计算外层函数 $g(y)$ 的导数：\n$$\ng'(y) = \\frac{d}{dy}(\\exp(y)) = \\exp(y)\n$$\n在 $y=h(x)$ 处求值，得到 $g'(h(x)) = \\exp(h(x)) = \\exp(\\|x\\|_2^2)$。\n\n接着，我们计算内层函数 $h(x)$ 的梯度：\n$$\nh(x) = x_1^2 + x_2^2 + \\dots + x_n^2\n$$\n关于第 $i$ 个分量 $x_i$ 的偏导数是：\n$$\n\\frac{\\partial h}{\\partial x_i} = \\frac{\\partial}{\\partial x_i} \\left(\\sum_{j=1}^n x_j^2\\right) = 2x_i\n$$\n梯度 $\\nabla h(x)$ 是这些偏导数组成的向量：\n$$\n\\nabla h(x) = \\begin{pmatrix} 2x_1 \\\\ 2x_2 \\\\ \\vdots \\\\ 2x_n \\end{pmatrix} = 2x\n$$\n综合这些结果， $f(x)$ 的梯度是：\n$$\n\\nabla f(x) = g'(h(x)) \\nabla h(x) = \\exp(\\|x\\|_2^2) \\cdot (2x) = 2\\exp(\\|x\\|_2^2)x\n$$\n\n### 2. 梯度范数 $\\|\\nabla f(x)\\|_2$\n\n使用上面推导出的梯度表达式，我们计算其欧几里得范数。\n$$\n\\nabla f(x) = 2\\exp(\\|x\\|_2^2)x\n$$\n项 $2\\exp(\\|x\\|_2^2)$ 是一个正标量。对于任意标量 $c \\in \\mathbb{R}$ 和向量 $v \\in \\mathbb{R}^n$，我们有 $\\|cv\\|_2 = |c|\\|v\\|_2$。\n$$\n\\|\\nabla f(x)\\|_2 = \\|2\\exp(\\|x\\|_2^2)x\\|_2 = 2\\exp(\\|x\\|_2^2)\\|x\\|_2\n$$\n代入 $r = \\|x\\|_2$，梯度范数的表达式变为：\n$$\n\\|\\nabla f(x)\\|_2 = 2r\\exp(r^2)\n$$\n该表达式说明了为什么当 $r = \\|x\\|_2$ 增大时，梯度范数会变得很大。项 $\\exp(r^2)$ 随 $r$ 超指数增长。当 $r \\to \\infty$ 时，这一项起主导作用，导致梯度的大小急剧增加。\n\n### 3. 推导最优步长 $\\alpha^\\star$\n\n我们需要找到使 $g(\\alpha) = f(x+\\alpha u(x))$ 在 $\\alpha=0$ 附近的二阶泰勒展开式最小化的值 $\\alpha^\\star$。二次模型为：\n$$\nq(\\alpha) = g(0) + g'(0)\\alpha + \\frac{1}{2}g''(0)\\alpha^2\n$$\n为了找到最小值点，我们将 $q(\\alpha)$ 对 $\\alpha$ 的导数设为零：\n$$\nq'(\\alpha) = g'(0) + g''(0)\\alpha = 0 \\implies \\alpha^\\star = -\\frac{g'(0)}{g''(0)}\n$$\n我们必须计算 $g'(0)$ 和 $g''(0)$。\n\n一阶导数 $g'(\\alpha)$ 可以通过方向导数的链式法则求得：\n$$\ng'(\\alpha) = \\frac{d}{d\\alpha}f(x+\\alpha u) = \\nabla f(x+\\alpha u) \\cdot u\n$$\n在 $\\alpha=0$ 处求值：\n$$\ng'(0) = \\nabla f(x) \\cdot u\n$$\n方向 $u = u(x)$ 是单位负梯度方向：\n$$\nu = -\\frac{\\nabla f(x)}{\\|\\nabla f(x)\\|_2}\n$$\n将此代入 $g'(0)$ 的表达式中：\n$$\ng'(0) = \\nabla f(x) \\cdot \\left(-\\frac{\\nabla f(x)}{\\|\\nabla f(x)\\|_2}\\right) = -\\frac{\\|\\nabla f(x)\\|_2^2}{\\|\\nabla f(x)\\|_2} = -\\|\\nabla f(x)\\|_2\n$$\n根据第2部分，$\\|\\nabla f(x)\\|_2 = 2r\\exp(r^2)$，所以：\n$$\ng'(0) = -2r\\exp(r^2)\n$$\n二阶导数 $g''(\\alpha)$ 是二阶方向导数：\n$$\ng''(\\alpha) = \\frac{d}{d\\alpha}\\left(\\nabla f(x+\\alpha u) \\cdot u\\right) = u^T \\nabla^2 f(x+\\alpha u) u\n$$\n在 $\\alpha=0$ 处求值：\n$$\ng''(0) = u^T \\nabla^2 f(x) u\n$$\n我们需要海森矩阵 $\\nabla^2 f(x)$。海森矩阵的第 $(i,j)$ 个元素是 $(\\nabla^2 f(x))_{ij} = \\frac{\\partial}{\\partial x_i}(\\nabla f(x))_j$。\n$$\n(\\nabla f(x))_j = 2x_j\\exp(\\|x\\|_2^2)\n$$\n使用乘法法则求导：\n$$\n\\frac{\\partial}{\\partial x_i} \\big(2x_j\\exp(\\|x\\|_2^2)\\big) = 2x_j\\frac{\\partial}{\\partial x_i}\\exp(\\|x\\|_2^2) + 2\\exp(\\|x\\|_2^2)\\frac{\\partial x_j}{\\partial x_i}\n$$\n$$\n= 2x_j\\exp(\\|x\\|_2^2)(2x_i) + 2\\exp(\\|x\\|_2^2)\\delta_{ij} = 2\\exp(\\|x\\|_2^2)(2x_i x_j + \\delta_{ij})\n$$\n其中 $\\delta_{ij}$ 是克罗内克δ。海森矩阵是 $\\nabla^2 f(x) = 2\\exp(\\|x\\|_2^2)(2xx^T + I)$，其中 $I$ 是单位矩阵。\n\n现在我们计算 $g''(0)$。方向 $u$ 可以简化为：\n$$\nu = -\\frac{2\\exp(\\|x\\|_2^2)x}{2\\exp(\\|x\\|_2^2)\\|x\\|_2} = -\\frac{x}{\\|x\\|_2} = -\\frac{x}{r}\n$$\n代入 $g''(0) = u^T \\nabla^2 f(x) u$ 中：\n$$\ng''(0) = \\left(-\\frac{x^T}{r}\\right) \\left[2\\exp(r^2)(2xx^T+I)\\right] \\left(-\\frac{x}{r}\\right)\n$$\n$$\n= \\frac{2\\exp(r^2)}{r^2} \\left[ x^T(2xx^T+I)x \\right] = \\frac{2\\exp(r^2)}{r^2} \\left[ 2(x^T x)(x^T x) + x^T x \\right]\n$$\n因为 $x^T x = \\|x\\|_2^2 = r^2$：\n$$\ng''(0) = \\frac{2\\exp(r^2)}{r^2} \\left[ 2(r^2)(r^2) + r^2 \\right] = \\frac{2\\exp(r^2)}{r^2} \\left[ 2r^4 + r^2 \\right]\n$$\n从括号中提出 $r^2$（因为 $r > 0$）：\n$$\ng''(0) = \\frac{2\\exp(r^2)r^2(2r^2+1)}{r^2} = 2\\exp(r^2)(2r^2+1)\n$$\n最后，我们计算 $\\alpha^\\star$：\n$$\n\\alpha^\\star = -\\frac{g'(0)}{g''(0)} = -\\frac{-2r\\exp(r^2)}{2\\exp(r^2)(2r^2+1)}\n$$\n项 $2\\exp(r^2)$ 被消掉，得到 $\\alpha^\\star$ 仅用 $r$ 表示的最终表达式：\n$$\n\\alpha^\\star = \\frac{r}{2r^2+1}\n$$", "answer": "$$\\boxed{\\frac{r}{2r^{2}+1}}$$", "id": "3120161"}, {"introduction": "现在，让我们转向优化与统计学中最基本的问题之一：线性最小二乘法。这个练习将向你展示，梯度不仅仅是一个导数向量，它还携带了深刻的几何信息。通过分析梯度与问题矩阵的奇异向量之间的关系，你将深入理解为什么梯度下降法在处理病态问题时会遇到困难[@problem_id:3120177]。", "problem": "考虑一个具有满列秩的矩阵 $A \\in \\mathbb{R}^{m \\times n}$ 和一个观测向量 $b \\in \\mathbb{R}^{m}$。定义目标函数 $f:\\mathbb{R}^{n} \\to \\mathbb{R}$ 为 $f(x) = \\|A x - b\\|_{2}^{2}$。设 $A$ 的奇异值分解 (SVD, singular value decomposition) 为 $A = U \\Sigma V^{\\top}$，其中 $U \\in \\mathbb{R}^{m \\times m}$ 和 $V \\in \\mathbb{R}^{n \\times n}$ 是正交矩阵，$\\Sigma \\in \\mathbb{R}^{m \\times n}$ 是对角矩阵，其对角元素为严格为正的 $\\sigma_{1} \\geq \\sigma_{2} \\geq \\cdots \\geq \\sigma_{n}  0$。将右奇异向量（$V$ 的列）记为 $v_{i} \\in \\mathbb{R}^{n}$，将左奇异向量（$U$ 的列）记为 $u_{i} \\in \\mathbb{R}^{m}$。设 $x_{0} \\in \\mathbb{R}^{n}$ 为一个当前迭代点，并定义残差 $r = A x_{0} - b$。设 $c = U^{\\top} r \\in \\mathbb{R}^{m}$，因此对于 $i = 1, \\dots, m$ 有 $c_{i} = u_{i}^{\\top} r$。假设 $A$ 是病态的，即 $\\sigma_{1} / \\sigma_{n}$ 很大。\n\n1) 从方向导数的定义出发，\n$$\nD_{v} f(x_{0}) = \\lim_{t \\to 0} \\frac{f(x_{0} + t v) - f(x_{0})}{t},\n$$\n为每个 $i \\in \\{1, \\dots, n\\}$ 推导出 $D_{v_{i}} f(x_{0})$ 的一个公式，用 $\\sigma_{i}$ 和 $c_{i}$ 表示。\n\n2) 仅使用正交性质和向量微积分的基本法则，推导在 $x_{0}$ 处的最速下降方向（即方向 $- \\nabla f(x_{0})$）与一个固定的右奇异向量 $v_{k}$（对于 $k \\in \\{1, \\dots, n\\}$）之间夹角的余弦值。用 $\\{\\sigma_{j}\\}_{j=1}^{n}$ 和 $\\{c_{j}\\}_{j=1}^{n}$ 表示你的结果。\n\n3) 根据你在第2部分得到的表达式，简要解释病态性（即 $\\sigma_{j}$ 的值变化范围很大）如何影响初始梯度下降轨迹与哪些右奇异向量 $v_{k}$ 的对齐程度最强，假设对于所有 $j$ 都有 $c_{j} \\neq 0$。\n\n作为你的最终答案，报告你在第2部分得到的余弦值的闭式表达式，该表达式是关于 $k$、$\\{\\sigma_{j}\\}_{j=1}^{n}$ 和 $\\{c_{j}\\}_{j=1}^{n}$ 的函数。无需进行数值计算。", "solution": "该问题陈述已经过严格验证，被认为是自洽的、数学上合理的和良定的。它是在线性最小二乘的优化算法分析中的一个标准练习。我们可以开始解答。\n\n该问题要求对目标函数 $f(x) = \\|A x - b\\|_{2}^{2}$ 进行三个相关的推导，其中 $A \\in \\mathbb{R}^{m \\times n}$ 的奇异值分解为 $A = U \\Sigma V^{\\top}$。\n\n首先，我们推导函数 $f$ 在点 $x_{0}$ 处沿右奇异向量 $v_{i}$ 方向的方向导数公式。方向导数 $D_{v_{i}} f(x_{0})$ 定义为：\n$$\nD_{v_{i}} f(x_{0}) = \\lim_{t \\to 0} \\frac{f(x_{0} + t v_{i}) - f(x_{0})}{t}\n$$\n我们从展开项 $f(x_{0} + t v_{i})$ 开始：\n$$\nf(x_{0} + t v_{i}) = \\|A(x_{0} + t v_{i}) - b\\|_{2}^{2} = \\|(A x_{0} - b) + t A v_{i}\\|_{2}^{2}\n$$\n使用残差的定义 $r = A x_{0} - b$，我们有：\n$$\nf(x_{0} + t v_{i}) = \\|r + t A v_{i}\\|_{2}^{2}\n$$\n展开L2范数的平方，这等价于向量与自身的点积：\n$$\n\\|r + t A v_{i}\\|_{2}^{2} = (r + t A v_{i})^{\\top}(r + t A v_{i}) = r^{\\top}r + 2t r^{\\top}(A v_{i}) + t^{2} (A v_{i})^{\\top}(A v_{i})\n$$\n这可以用范数表示为：\n$$\nf(x_{0} + t v_{i}) = \\|r\\|_{2}^{2} + 2t r^{\\top}(A v_{i}) + t^{2} \\|A v_{i}\\|_{2}^{2}\n$$\n已知 $f(x_{0}) = \\|A x_{0} - b\\|_{2}^{2} = \\|r\\|_{2}^{2}$，我们可以构造差商：\n$$\n\\frac{f(x_{0} + t v_{i}) - f(x_{0})}{t} = \\frac{(\\|r\\|_{2}^{2} + 2t r^{\\top}(A v_{i}) + t^{2} \\|A v_{i}\\|_{2}^{2}) - \\|r\\|_{2}^{2}}{t} = 2 r^{\\top}(A v_{i}) + t \\|A v_{i}\\|_{2}^{2}\n$$\n当 $t \\to 0$ 时取极限：\n$$\nD_{v_{i}} f(x_{0}) = \\lim_{t \\to 0} (2 r^{\\top}(A v_{i}) + t \\|A v_{i}\\|_{2}^{2}) = 2 r^{\\top}(A v_{i})\n$$\n为了用所要求的项来表示这个结果，我们使用 $A$ 的SVD。从 $A = U \\Sigma V^{\\top}$，我们可以写出 $A V = U \\Sigma$。由于 $V$ 的列是右奇异向量 $v_{j}$，该矩阵方程的第 $i$ 列给出 $A v_{i} = \\sigma_{i} u_{i}$，其中 $u_{i}$ 是第 $i$ 个左奇异向量（$U$ 的第 $i$ 列），$\\sigma_{i}$ 是对应的奇异值。\n将此代入我们的方向导数表达式中：\n$$\nD_{v_{i}} f(x_{0}) = 2 r^{\\top}(\\sigma_{i} u_{i}) = 2 \\sigma_{i} (r^{\\top} u_{i})\n$$\n根据定义，向量 $c = U^{\\top} r$ 的分量 $c_{i}$ 是 $c_{i} = u_{i}^{\\top} r$。由于点积是对称的（$u_{i}^{\\top} r = r^{\\top} u_{i}$），我们得到第一部分的最终表达式：\n$$\nD_{v_{i}} f(x_{0}) = 2 \\sigma_{i} c_{i}\n$$\n\n其次，我们推导在 $x_{0}$ 处的最速下降方向 $d = - \\nabla f(x_{0})$ 与右奇异向量 $v_{k}$ 之间夹角的余弦值。两个非零向量 $p$ 和 $q$ 之间夹角 $\\theta_{k}$ 的余弦值由 $\\cos(\\theta_{k}) = \\frac{p^{\\top}q}{\\|p\\|_{2}\\|q\\|_{2}}$ 给出。在这里，$p = d = -\\nabla f(x_{0})$ 且 $q = v_{k}$。\n\n首先，我们求 $f(x) = \\|Ax - b\\|_{2}^{2} = (Ax-b)^{\\top}(Ax-b)$ 的梯度。\n$$\nf(x) = (x^{\\top}A^{\\top} - b^{\\top})(Ax-b) = x^{\\top}A^{\\top}Ax - 2b^{\\top}Ax + b^{\\top}b\n$$\n这个二次型关于 $x$ 的梯度是：\n$$\n\\nabla f(x) = 2 A^{\\top} A x - 2 A^{\\top} b = 2 A^{\\top} (A x - b)\n$$\n在点 $x_{0}$ 处，使用残差 $r=Ax_0-b$：\n$$\n\\nabla f(x_{0}) = 2 A^{\\top} r\n$$\n最速下降方向是 $d = - \\nabla f(x_{0}) = -2 A^{\\top} r$。\n\n现在我们计算余弦公式的各项。分子是点积 $d^{\\top}v_{k}$：\n$$\nd^{\\top}v_{k} = (-2 A^{\\top} r)^{\\top}v_{k} = -2 r^{\\top} A v_{k}\n$$\n使用关系式 $A v_{k} = \\sigma_{k} u_{k}$ 和定义 $c_{k} = u_{k}^{\\top} r$：\n$$\nd^{\\top}v_{k} = -2 r^{\\top} (\\sigma_{k} u_{k}) = -2 \\sigma_{k} (r^{\\top} u_{k}) = -2 \\sigma_{k} c_{k}\n$$\n分母涉及向量的范数。向量 $v_{k}$ 是正交矩阵 $V$ 的一列，因此它是一个单位向量：$\\|v_{k}\\|_{2} = 1$。最速下降方向的范数是：\n$$\n\\|d\\|_{2} = \\|-2 A^{\\top} r\\|_{2} = 2 \\|A^{\\top} r\\|_{2}\n$$\n我们必须用 $\\{\\sigma_{j}\\}$ 和 $\\{c_{j}\\}$ 来表示 $\\|A^{\\top} r\\|_{2}$。我们使用 $A^{\\top}$ 的SVD，即 $A^{\\top} = (U \\Sigma V^{\\top})^{\\top} = V \\Sigma^{\\top} U^{\\top}$。\n$$\nA^{\\top}r = V \\Sigma^{\\top} (U^{\\top}r) = V \\Sigma^{\\top} c\n$$\n由于 $V$ 是一个正交矩阵，它保持L2范数不变，所以 $\\|A^{\\top}r\\|_{2} = \\|V \\Sigma^{\\top} c\\|_{2} = \\|\\Sigma^{\\top} c\\|_{2}$。\n矩阵 $\\Sigma^{\\top}$ 是一个 $n \\times m$ 的对角矩阵，其对角线上的元素为 $\\sigma_{1}, \\dots, \\sigma_{n}$。向量 $c = U^{\\top}r \\in \\mathbb{R}^{m}$ 的分量为 $c_{j}$。乘积 $\\Sigma^{\\top}c$ 是 $\\mathbb{R}^{n}$ 中的一个向量，其分量为 $(\\sigma_{j} c_{j})$，其中 $j = 1, \\dots, n$。\n$$\n\\Sigma^{\\top} c = \\begin{pmatrix} \\sigma_{1} c_{1} \\\\ \\sigma_{2} c_{2} \\\\ \\vdots \\\\ \\sigma_{n} c_{n} \\end{pmatrix}\n$$\n因此，范数为：\n$$\n\\|A^{\\top} r\\|_{2} = \\|\\Sigma^{\\top} c\\|_{2} = \\sqrt{\\sum_{j=1}^{n} (\\sigma_{j} c_{j})^{2}}\n$$\n将所有部分代入余弦公式：\n$$\n\\cos(\\theta_{k}) = \\frac{d^{\\top}v_{k}}{\\|d\\|_{2} \\|v_{k}\\|_{2}} = \\frac{-2 \\sigma_{k} c_{k}}{(2 \\sqrt{\\sum_{j=1}^{n} \\sigma_{j}^{2} c_{j}^{2}})(1)} = \\frac{-\\sigma_{k} c_{k}}{\\sqrt{\\sum_{j=1}^{n} \\sigma_{j}^{2} c_{j}^{2}}}\n$$\n这就是所要求的表达式。\n\n第三，我们解释病态性如何影响初始梯度下降轨迹与右奇异向量 $v_{k}$ 的对齐。对齐程度由 $|\\cos(\\theta_{k})|$ 衡量。为简单起见，我们考虑余弦的平方：\n$$\n\\cos^{2}(\\theta_{k}) = \\frac{\\sigma_{k}^{2} c_{k}^{2}}{\\sum_{j=1}^{n} \\sigma_{j}^{2} c_{j}^{2}}\n$$\n此表达式代表了梯度在 $v_k$ 方向的分量的相对强度。病态性意味着奇异值在很大范围内变化，即 $\\sigma_{1} \\gg \\sigma_{n}$。假设分量 $c_{j} = u_{j}^{\\top} r$ 非零且量级相当，那么分母中的和 $\\sum_{j=1}^{n} \\sigma_{j}^{2} c_{j}^{2}$ 将被与最大奇异值对应的项压倒性地主导。\n例如，项 $\\sigma_{1}^{2} c_{1}^{2}$ 将远大于 $\\sigma_{n}^{2} c_{n}^{2}$。\n因此，对于与大奇异值 $\\sigma_{k}$（例如 $k=1$）相关联的奇异向量 $v_{k}$，分子 $\\sigma_{k}^{2} c_{k}^{2}$ 将会很大，使得 $\\cos^{2}(\\theta_{k})$ 接近于1。最速下降方向 $-\\nabla f(x_{0})$ 因此与 $v_{k}$ 强对齐。\n相反地，对于与小奇异值 $\\sigma_{k}$（例如 $k=n$）相关联的奇异向量 $v_{k}$，分子 $\\sigma_{k}^{2} c_{k}^{2}$ 与分母相比将非常小，使得 $\\cos^{2}(\\theta_{k})$ 接近于0。最速下降方向与这些奇异向量几乎正交。\n因此，梯度下降的初始轨迹（沿着 $-\\nabla f(x_{0})$）主要与对应于最大奇异值的右奇异向量对齐。这导致在这些方向上的误差分量得到快速的初始减少，但对于与小奇异值相关的误差分量，进展极其缓慢，这就是梯度下降法在病态问题上收敛缓慢的典型特征。", "answer": "$$\n\\boxed{\\frac{-\\sigma_{k} c_{k}}{\\sqrt{\\sum_{j=1}^{n} \\sigma_{j}^{2} c_{j}^{2}}}}\n$$", "id": "3120177"}, {"introduction": "现实世界中的问题往往不是完美平滑的。最后一个练习将挑战你分析一个带有“扭结”或非平滑边界的函数。通过直接运用可微性和方向导数的定义，你将探究该函数在边界处是否真的不可微，这个练习突出了在处理非平滑函数时，严谨分析比简单直觉更为重要[@problem_id:3120157]。", "problem": "考虑由 $f(x)=\\max\\{0, \\|x\\|-1\\}^{2}$ 定义的函数 $f:\\mathbb{R}^{n}\\to\\mathbb{R}$，其中 $\\|x\\|$ 表示欧几里得范数。请仅使用多元微积分和优化方法的核心定义：在点 $x_{0}$ 处的可微性意味着存在一个线性映射 $L$，使得当 $h\\to 0$ 时，$f(x_{0}+h)=f(x_{0})+L(h)+o(\\|h\\|)$；梯度 $\\nabla f(x)$ 是通过 $L(h)=\\nabla f(x)^{\\top}h$ 表示 $L$ 的唯一向量；$f$ 在 $x$ 点沿方向 $d$ 的方向导数为 $D f(x;d)=\\lim_{t\\to 0}\\frac{f(x+td)-f(x)}{t}$（当此极限存在时）。从这些定义和经过验证的公式（包括链式法则和欧几里得范数在所有 $x\\neq 0$ 处的的可微性）出发，研究 $f$ 在满足 $\\|x\\|=1$ 的边界点处的可微性，并推导单位球内部（$\\|x\\|1$）和单位球外部（$\\|x\\|>1$）的梯度表达式。然后，计算在 $\\|x_{0}\\|=1$ 的任意边界点 $x_{0}$ 处，沿任意方向 $d\\in\\mathbb{R}^{n}$ 的方向导数。请按以下顺序提供您的最终结果：(i) 当 $\\|x\\|1$ 时的梯度，(ii) 当 $\\|x\\|>1$ 时的梯度，(iii) 在 $\\|x\\|=1$ 的边界点处沿任意方向 $d$ 的方向导数。最终答案必须是精确的解析表达式；不要进行任何数值舍入。", "solution": "在尝试给出解答之前，首先对问题进行验证。\n\n### 步骤 1：提取已知条件\n- 函数定义：$f:\\mathbb{R}^{n}\\to\\mathbb{R}$ 由 $f(x)=\\max\\{0, \\|x\\|-1\\}^{2}$ 给出。\n- 符号：$\\|x\\|$ 表示向量 $x \\in \\mathbb{R}^n$ 的欧几里得范数。\n- 核心定义：\n    - 在 $x_{0}$ 处的可微性：存在一个线性映射 $L$，使得当 $h\\to 0$ 时，$f(x_{0}+h)=f(x_{0})+L(h)+o(\\|h\\|)$。\n    - 梯度 $\\nabla f(x)$：通过内积 $L(h)=\\nabla f(x)^{\\top}h$ 表示 $L$ 的唯一向量。\n    - 方向导数：$D f(x;d)=\\lim_{t\\to 0}\\frac{f(x+td)-f(x)}{t}$，当此极限存在时。\n- 假定知识：链式法则和欧几里得范数对于所有 $x \\neq 0$ 的可微性。\n- 任务：\n    1. 研究 $f$ 在 $\\|x\\|=1$ 的边界点处的可微性。\n    2. 推导当 $\\|x\\|1$ 时的梯度。\n    3. 推导当 $\\|x\\|>1$ 时的梯度。\n    4. 计算在 $\\|x_0\\|=1$ 的点 $x_0$ 处，沿任意方向 $d\\in\\mathbb{R}^{n}$ 的方向导数。\n\n### 步骤 2：使用提取的已知条件进行验证\n- **科学依据：** 该问题是多元微积分和非光滑优化中的一个标准练习。函数 $f(x)$ 是标准函数（范数、减法、最大值、平方）的良定义复合。不存在科学或事实上的不健全之处。\n- **良态性：** 问题陈述清晰，要求在明确定义的条件下求出特定的数学对象（梯度和方向导数）。存在唯一解。\n- **客观性：** 语言正式且无歧义。所有术语均为数学标准术语。\n- **完备性与一致性：** 问题是自洽的。提供的定义和假定知识足以解决该问题。没有内部矛盾。\n- **未发现其他缺陷。** 该问题不依赖于隐喻，与指定主题相关，并非微不足道，并且在数学上是可验证的。\n\n### 步骤 3：结论与行动\n该问题有效。将提供完整的解答。\n\n### 解答推导\n函数为 $f(x) = \\max\\{0, \\|x\\|-1\\}^2$。我们在 $\\mathbb{R}^n$ 的三个不同区域分析该函数。\n\n**第 (i) 部分：当 $\\|x\\|  1$ 时的梯度**\n\n对于开单位球内的任意 $x$，即 $\\|x\\|  1$，项 $\\|x\\|-1$ 为负。根据最大值函数的定义，$\\max\\{0, \\|x\\|-1\\} = 0$。\n因此，对于所有满足 $\\|x\\|  1$ 的 $x$，函数简化为：\n$$f(x) = 0^2 = 0$$\n函数 $f(x)$ 在开集 $\\{x \\in \\mathbb{R}^n \\mid \\|x\\|  1\\}$ 上为常数。常数函数的导数是零映射，其对应的梯度是零向量。\n因此，对于 $\\|x\\|  1$，梯度为：\n$$\\nabla f(x) = 0$$\n\n**第 (ii) 部分：当 $\\|x\\| > 1$ 时的梯度**\n\n对于闭单位球外的任意 $x$，即 $\\|x\\| > 1$，项 $\\|x\\|-1$ 为正。根据最大值函数的定义，$\\max\\{0, \\|x\\|-1\\} = \\|x\\|-1$。\n因此，对于所有满足 $\\|x\\| > 1$ 的 $x$，函数简化为：\n$$f(x) = (\\|x\\|-1)^2$$\n该函数是一个复合函数 $f(x) = g(h(x))$，其中 $g(u) = u^2$ 且 $h(x) = \\|x\\|-1$。这两个函数在各自的定义域内都是可微的（对于 $h(x)$，我们要求 $x \\neq 0$，由于 $\\|x\\| > 1$，此条件满足）。我们应用梯度的链式法则：$\\nabla f(x) = g'(h(x)) \\nabla h(x)$。\n\n$g(u)$ 的导数是 $g'(u) = 2u$。在 $h(x)$ 处求值，得到 $g'(h(x)) = 2(\\|x\\|-1)$。\n$h(x)$ 的梯度是 $\\nabla h(x) = \\nabla(\\|x\\|-1) = \\nabla(\\|x\\|)$。欧几里得范数的梯度是一个标准结果：对于 $x \\neq 0$，$\\nabla(\\|x\\|) = \\frac{x}{\\|x\\|}$。\n\n结合这些结果，对于 $\\|x\\| > 1$，$f(x)$ 的梯度是：\n$$\\nabla f(x) = 2(\\|x\\|-1) \\frac{x}{\\|x\\|}$$\n这也可以写成 $\\nabla f(x) = 2\\left(1 - \\frac{1}{\\|x\\|}\\right)x$。\n\n**第 (iii) 部分：$\\|x_0\\|=1$ 时的可微性与方向导数**\n\n设 $x_0$ 是单位球边界上的一个点，因此 $\\|x_0\\|=1$。在该点，$f(x_0) = \\max\\{0, \\|x_0\\|-1\\}^2 = \\max\\{0, 1-1\\}^2 = 0$。\n\n首先，我们研究可微性。如果一个函数的所有偏导数在某点的一个邻域内存在且连续，则该函数在该点可微。\n从第 (i) 和 (ii) 部分可知，梯度是分段定义的：\n$$ \\nabla f(x) = \\begin{cases} 0  \\text{if } \\|x\\|  1 \\\\ 2\\left(1 - \\frac{1}{\\|x\\|}\\right)x  \\text{if } \\|x\\| > 1 \\end{cases} $$\n我们来检查当 $x \\to x_0$（其中 $\\|x_0\\|=1$）时梯度的极限。\n从内部区域（$\\|x\\|  1$）：$\\lim_{x\\to x_0, \\|x\\|1} \\nabla f(x) = \\lim_{x\\to x_0, \\|x\\|1} 0 = 0$。\n从外部区域（$\\|x\\| > 1$）：$\\lim_{x\\to x_0, \\|x\\|>1} \\nabla f(x) = \\lim_{x\\to x_0, \\|x\\|>1} 2\\left(1 - \\frac{1}{\\|x\\|}\\right)x = 2\\left(1 - \\frac{1}{\\|x_0\\|}\\right)x_0 = 2\\left(1-\\frac{1}{1}\\right)x_0 = 0$。\n由于从两侧的极限都一致且等于零向量，我们可以定义 $\\nabla f(x_0) = 0$。由此得到的梯度函数 $\\nabla f(x)$ 对所有 $x \\neq 0$ 都是连续的。偏导数的连续性意味着函数 $f$ 对所有 $x \\neq 0$ 是连续可微的（$C^1$）。这包括了边界 $\\|x_0\\|=1$ 上的所有点 $x_0$。因此，$f$ 在这些点是可微的，其梯度为 $\\nabla f(x_0) = 0$。\n\n现在，我们计算任意方向 $d \\in \\mathbb{R}^n$ 的方向导数 $D f(x_0; d)$。由于 $f$ 在 $x_0$ 处可微，方向导数由梯度与方向向量的点积给出：\n$$D f(x_0; d) = (\\nabla f(x_0))^{\\top}d$$\n代入我们求得的梯度 $\\nabla f(x_0) = 0$：\n$$D f(x_0; d) = 0^{\\top}d = 0$$\n这对任何方向 $d \\in \\mathbb{R}^n$ 都成立。\n\n作为验证，我们可以直接根据极限定义来计算：\n$D f(x_0; d) = \\lim_{t\\to 0} \\frac{f(x_0+td) - f(x_0)}{t} = \\lim_{t\\to 0} \\frac{\\max\\{0, \\|x_0+td\\|-1\\}^2}{t}$。\n我们使用展开式 $\\|x_0+td\\| = \\sqrt{\\|x_0\\|^2 + 2t(x_0^\\top d) + t^2\\|d\\|^2} = \\sqrt{1 + 2t(x_0^\\top d) + t^2\\|d\\|^2}$。\n对于小的 $u$，使用泰勒展开式 $\\sqrt{1+u} = 1 + \\frac{1}{2}u + O(u^2)$，我们有：\n$\\|x_0+td\\| = 1 + \\frac{1}{2}(2t(x_0^\\top d) + t^2\\|d\\|^2) + O(t^2) = 1 + t(x_0^\\top d) + O(t^2)$。\n所以，$\\|x_0+td\\|-1 = t(x_0^\\top d) + O(t^2)$。\n极限变为：\n$D f(x_0; d) = \\lim_{t\\to 0} \\frac{\\max\\{0, t(x_0^\\top d) + O(t^2)\\}^2}{t}$。\n分子是 $O(t^2)$ 阶的，因为 $\\max\\{0, \\dots\\}^2$ 要么是 $0$，要么是 $(t(x_0^\\top d) + O(t^2))^2 = O(t^2)$。\n因此，极限内的表达式为 $\\frac{O(t^2)}{t} = O(t)$。\n当 $t \\to 0$ 时，$O(t) \\to 0$。这证实了方向导数为 $0$。\n\n最终结果是：\n(i) 对于 $\\|x\\|  1$，$\\nabla f(x) = 0$。\n(ii) 对于 $\\|x\\| > 1$，$\\nabla f(x) = 2(\\|x\\|-1)\\frac{x}{\\|x\\|}$。\n(iii) 在 $\\|x_0\\|=1$ 处，对于任意方向 $d$，$D f(x_0; d) = 0$。", "answer": "$$\n\\boxed{\n\\begin{aligned}\n \\text{(i) 当 } \\|x\\|  1 \\text{ 时: } \\nabla f(x) = 0 \\\\\n \\text{(ii) 当 } \\|x\\| > 1 \\text{ 时: } \\nabla f(x) = 2(\\|x\\|-1)\\frac{x}{\\|x\\|} \\\\\n \\text{(iii) 当 } \\|x_0\\| = 1 \\text{ 时: } D f(x_0; d) = 0\n\\end{aligned}\n}\n$$", "id": "3120157"}]}