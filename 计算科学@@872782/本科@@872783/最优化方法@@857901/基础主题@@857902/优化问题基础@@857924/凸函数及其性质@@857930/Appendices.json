{"hands_on_practices": [{"introduction": "理解凸性的第一步是掌握其清晰的几何解释。本练习通过分析函数 $f(x) = 1/x$（一个经典的凸函数例子）来生动地展示这一几何特性。您不仅需要确认其凸性，还需要通过计算函数曲线与其割线之间的最大垂直距离来量化这种凸性，从而对凸性的含义建立更深刻的直觉。[@problem_id:2163733]", "problem": "研究函数 $g(x) = \\frac{1}{x}$ (其中 $x  0$) 的性质。考虑一条连接函数 $g(x)$ 图像上两个不同点的线段，该线段称为割线。设这两个点为 $(a, g(a))$ 和 $(b, g(b))$，其中常数 $a$ 和 $b$ 是满足 $0  a  b$ 的正实数。对于区间 $[a, b]$ 中的任意 $x$，割线位于函数 $g(x)$ 图像的上方或与其重合。设 $h(x)$ 表示在横坐标 $x$ 处，割线与 $g(x)$ 图像之间的垂直距离。求出 $h(x)$ 在区间 $[a,b]$ 上的最大可能值。\n\n将答案表示为以参数 $a$ 和 $b$ 表示的单一闭式解析表达式。", "solution": "设 $g(x) = \\frac{1}{x}$，且固定 $0  a  b$。连接点 $(a, g(a))$ 和 $(b, g(b))$ 的割线方程 $L(x)$ 为：\n$$ L(x) = g(a) + \\frac{g(b)-g(a)}{b-a}(x-a) = \\frac{1}{a} + \\frac{\\frac{1}{b}-\\frac{1}{a}}{b-a}(x-a) = \\frac{1}{a} - \\frac{1}{ab}(x-a) $$\n垂直距离函数 $h(x)$ 是割线与函数图像的高度差，由 $h(x) = L(x) - g(x)$ 给出。由于 $g(x)$ 是凸函数，因此 $h(x) \\ge 0$。\n$$ h(x) = \\left( \\frac{1}{a} - \\frac{x-a}{ab} \\right) - \\frac{1}{x} = \\frac{1}{a} + \\frac{1}{b} - \\frac{x}{ab} - \\frac{1}{x} $$\n为找到最大值，我们对 $h(x)$ 求导并令其为零：\n$$ h'(x) = \\frac{d}{dx} \\left( \\frac{1}{a} + \\frac{1}{b} - \\frac{x}{ab} - \\frac{1}{x} \\right) = -\\frac{1}{ab} + \\frac{1}{x^2} $$\n令 $h'(x) = 0$：\n$$ \\frac{1}{x^2} = \\frac{1}{ab} \\implies x^2 = ab \\implies x_0 = \\sqrt{ab} $$\n由于 $0  a  b$，我们有 $a = \\sqrt{a^2}  \\sqrt{ab}  \\sqrt{b^2} = b$，所以临界点 $x_0 = \\sqrt{ab}$ 在区间 $(a, b)$ 内。\n二阶导数为 $h''(x) = -\\frac{2}{x^3}$。因为 $x > 0$，所以 $h''(x)  0$，这证实了 $x_0$ 是一个局部最大值点。由于它是区间内唯一的临界点，它就是全局最大值点。\n将 $x_0 = \\sqrt{ab}$ 代入 $h(x)$ 以求得最大值：\n$$ h(\\sqrt{ab}) = \\frac{1}{a} + \\frac{1}{b} - \\frac{\\sqrt{ab}}{ab} - \\frac{1}{\\sqrt{ab}} = \\frac{1}{a} + \\frac{1}{b} - \\frac{1}{\\sqrt{ab}} - \\frac{1}{\\sqrt{ab}} = \\frac{1}{a} - \\frac{2}{\\sqrt{ab}} + \\frac{1}{b} $$\n这个表达式可以被重写为一个完全平方：\n$$ h(\\sqrt{ab}) = \\left(\\frac{1}{\\sqrt{a}}\\right)^2 - 2\\left(\\frac{1}{\\sqrt{a}}\\right)\\left(\\frac{1}{\\sqrt{b}}\\right) + \\left(\\frac{1}{\\sqrt{b}}\\right)^2 = \\left(\\frac{1}{\\sqrt{a}} - \\frac{1}{\\sqrt{b}}\\right)^2 $$\n将其通分，得到：\n$$ \\left(\\frac{\\sqrt{b} - \\sqrt{a}}{\\sqrt{ab}}\\right)^2 = \\frac{(\\sqrt{b}-\\sqrt{a})^2}{ab} $$\n因此，最大垂直距离为 $\\frac{(\\sqrt{b}-\\sqrt{a})^2}{ab}$。", "answer": "$$\\boxed{\\frac{\\left(\\sqrt{b}-\\sqrt{a}\\right)^{2}}{ab}}$$", "id": "2163733"}, {"introduction": "尽管“碗形”的直觉在一维情况下很有效，但在更高维度上我们需要更严谨的工具。本实践问题将凸性的概念扩展到二元函数，并引入 Hessian 矩阵作为判断凸性的关键测试。通过确定一个模型势能函数是凸函数所需满足的条件，您将获得处理多元优化问题所必需的分析方法的实践经验。[@problem_id:2163677]", "problem": "在某些物理系统的设计中，势能函数必须是凸函数，以确保系统具有唯一的稳定平衡点。一个具有相互作用的双粒子系统的简化模型由一个势能函数 $V(x_1, x_2)$ 描述，其中 $x_1$ 和 $x_2$ 代表两个粒子的位置。该函数在整个平面 $\\mathbb{R}^2$ 上定义为：\n$$V(x_1, x_2) = x_1^2 + c x_1 x_2 + x_2^2$$\n在这个模型中，$c$ 是一个实值耦合常数，它决定了粒子间相互作用的强度和性质。为了使系统稳定，即拥有唯一的全局能量最小值，势能函数 $V(x_1, x_2)$ 必须是凸的。\n\n确定使势能函数 $V(x_1, x_2)$ 成为凸函数的所有耦合常数 $c$ 的取值集合。从以下选项中选择正确的一项。\n\nA. 对于所有实数 $c$。\n\nB. 仅当 $c=0$ 时。\n\nC. 区间 $-1 \\le c \\le 1$。\n\nD. 区间 $-2 \\le c \\le 2$。\n\nE. 区间 $c \\ge 0$。", "solution": "一个二阶可微的多元函数在其定义域上是凸函数的充要条件是，其 Hessian 矩阵在该定义域的所有点上都是半正定的。给定的势能函数为 $V(x_1, x_2) = x_1^2 + c x_1 x_2 + x_2^2$。该函数是一个多项式，因此在 $\\mathbb{R}^2$ 上处处无限可微。\n\n首先，我们通过求一阶偏导数来计算函数 $V(x_1, x_2)$ 的梯度：\n$$ \\frac{\\partial V}{\\partial x_1} = 2x_1 + c x_2 $$\n$$ \\frac{\\partial V}{\\partial x_2} = c x_1 + 2x_2 $$\n\n接下来，我们计算由二阶偏导数组成的 Hessian 矩阵，记为 $H$：\n$$ \\frac{\\partial^2 V}{\\partial x_1^2} = \\frac{\\partial}{\\partial x_1}(2x_1 + c x_2) = 2 $$\n$$ \\frac{\\partial^2 V}{\\partial x_2^2} = \\frac{\\partial}{\\partial x_2}(c x_1 + 2x_2) = 2 $$\n$$ \\frac{\\partial^2 V}{\\partial x_1 \\partial x_2} = \\frac{\\partial}{\\partial x_1}(c x_1 + 2x_2) = c $$\n根据关于混合偏导数相等的克莱罗定理（Clairaut's theorem），我们也有 $\\frac{\\partial^2 V}{\\partial x_2 \\partial x_1} = c$。\n\n因此，Hessian 矩阵 $H$ 为：\n$$ H = \\begin{pmatrix} \\frac{\\partial^2 V}{\\partial x_1^2}  \\frac{\\partial^2 V}{\\partial x_1 \\partial x_2} \\\\ \\frac{\\partial^2 V}{\\partial x_2 \\partial x_1}  \\frac{\\partial^2 V}{\\partial x_2^2} \\end{pmatrix} = \\begin{pmatrix} 2  c \\\\ c  2 \\end{pmatrix} $$\n注意，Hessian 矩阵是常数矩阵，不依赖于点 $(x_1, x_2)$。\n\n要使函数 $V(x_1, x_2)$ 为凸函数，Hessian 矩阵 $H$ 必须是半正定的。一个对称矩阵是半正定的，当且仅当它的所有顺序主子式都是非负的。\n这个 $2 \\times 2$ 矩阵 $H$ 的顺序主子式是：\n1.  第一个顺序主子式 $M_1$，即左上角的元素：$M_1 = 2$。\n2.  第二个顺序主子式 $M_2$，即矩阵的行列式：$M_2 = \\det(H)$。\n\n我们必须检查这些子式为非负的条件。\n第一个条件是 $M_1 \\ge 0$。在我们的例子中，$M_1 = 2$，所以 $2 \\ge 0$，这个条件总是成立的。\n\n第二个条件是 $M_2 \\ge 0$。我们计算 $H$ 的行列式：\n$$ \\det(H) = (2)(2) - (c)(c) = 4 - c^2 $$\n因此条件 $M_2 \\ge 0$ 变为：\n$$ 4 - c^2 \\ge 0 $$\n整理不等式，我们得到：\n$$ 4 \\ge c^2 $$\n这等价于 $|c| \\le 2$，可以写成区间形式：\n$$ -2 \\le c \\le 2 $$\n\n由于半正定的两个条件都必须满足，我们得出函数 $V(x_1, x_2)$ 是凸函数的充要条件是 $c$ 位于区间 $[-2, 2]$ 内。\n\n将此结果与给定选项进行比较：\nA. 对于所有实数 $c$。（错误）\nB. 仅当 $c=0$ 时。（错误，这只是有效范围中的一个点）\nC. 区间 $-1 \\le c \\le 1$。（错误，这是完整范围的一个子集）\nD. 区间 $-2 \\le c \\le 2$。（正确）\nE. 区间 $c \\ge 0$。（错误）\n\n因此，正确选项是 D。", "answer": "$$\\boxed{D}$$", "id": "2163677"}, {"introduction": "除了简单地识别凸函数，我们还可以对其进行变换以揭示更深层次的结构特性。Fenchel 共轭是凸分析中一个强大的工具，它构成了优化对偶理论的基石。在本练习中，您将计算一个基本二次函数的共轭函数，这是一项关键的计算，它为您理解更高级的主题（如对偶问题及其与原始问题的关系）搭建了桥梁。[@problem_id:2163745]", "problem": "设 $x$ 和 $y$ 是 $\\mathbb{R}^n$ 中的向量。考虑一个强凸二次函数 $f: \\mathbb{R}^n \\to \\mathbb{R}$，定义为 $f(x) = \\frac{1}{2}x^T A x$，其中 $A$ 是一个固定的 $n \\times n$ 对称正定矩阵。\n\n函数 $f(x)$ 的 Fenchel 共轭，记作 $f^*(y)$，由以下优化问题定义：\n$$ f^*(y) = \\sup_{x \\in \\mathbb{R}^n} \\left( y^T x - f(x) \\right) $$\n其中 $\\sup_{x \\in \\mathbb{R}^n}$ 表示表达式在定义域 $\\mathbb{R}^n$ 中所有向量 $x$ 上的上确界（或最小上界）。\n\n求 $f^*(y)$ 的闭式解析表达式。你的最终表达式应该用向量 $y$ 和矩阵 $A$ 表示。", "solution": "为了找到 Fenchel 共轭 $f^*(y)$，我们需要针对固定的 $y$ 求解关于 $x$ 的最大化问题。我们将上确界内的目标函数定义为 $g(x)$：\n$$ g(x) = y^T x - f(x) = y^T x - \\frac{1}{2}x^T A x $$\n我们想要找到 $\\sup_{x \\in \\mathbb{R}^n} g(x)$。\n\n函数 $f(x) = \\frac{1}{2}x^T A x$ 是一个凸函数，因为它的 Hessian 矩阵是 $\\nabla^2 f(x) = A$，根据定义，这是一个正定矩阵。因此，函数 $-f(x)$ 是一个凹函数。函数 $g(x)$ 是一个线性函数 ($y^T x$) 和一个凹函数 ($-f(x)$) 的和，这使得 $g(x)$ 成为一个凹函数。\n\n对于定义在 $\\mathbb{R}^n$ 上的可微凹函数，其上确界（也是其最大值）出现在其关于 $x$ 的梯度为零向量的点。让我们计算 $g(x)$ 的梯度：\n$$ \\nabla_x g(x) = \\nabla_x \\left( y^T x - \\frac{1}{2}x^T A x \\right) $$\n使用标准的矩阵微积分恒等式，我们有 $\\nabla_x(y^T x) = y$。对于二次项，由于 $A$ 是对称的，梯度 $\\nabla_x(x^T A x) = 2Ax$。因此，$\\nabla_x(\\frac{1}{2}x^T A x) = Ax$。\n结合这些结果，$g(x)$ 的梯度是：\n$$ \\nabla_x g(x) = y - Ax $$\n为了找到最大化 $g(x)$ 的点 $x^*$，我们将梯度设为零：\n$$ y - Ax^* = 0 $$\n$$ Ax^* = y $$\n由于矩阵 $A$ 是正定的，它是可逆的。我们可以通过乘以 $A$ 的逆矩阵（记作 $A^{-1}$）来求解 $x^*$：\n$$ x^* = A^{-1}y $$\n这是最大化 $g(x)$ 的唯一 $x$ 值。上确界的值，即 $f^*(y)$，可以通过将这个最优的 $x^*$ 代回到 $g(x)$ 的表达式中得到：\n$$ f^*(y) = g(x^*) = y^T x^* - \\frac{1}{2}(x^*)^T A x^* $$\n现在，我们将 $x^* = A^{-1}y$ 代入这个方程：\n$$ f^*(y) = y^T (A^{-1}y) - \\frac{1}{2}(A^{-1}y)^T A (A^{-1}y) $$\n让我们简化第二项。使用转置属性 $(BC)^T = C^TB^T$，我们得到：\n$$ (A^{-1}y)^T = y^T(A^{-1})^T $$\n由于 $A$ 是对称矩阵，其逆矩阵 $A^{-1}$ 也是对称的。因此，$(A^{-1})^T = A^{-1}$。第二项变为：\n$$ \\frac{1}{2} y^T (A^{-1})^T A (A^{-1}y) = \\frac{1}{2} y^T A^{-1} A A^{-1} y $$\n由于 $A^{-1}A = I$，其中 $I$ 是单位矩阵，这可以简化为：\n$$ \\frac{1}{2} y^T A^{-1} I y = \\frac{1}{2} y^T A^{-1} y $$\n现在，我们可以将此代回到 $f^*(y)$ 的表达式中：\n$$ f^*(y) = y^T A^{-1} y - \\frac{1}{2} y^T A^{-1} y $$\n合并这些项，我们得到 Fenchel 共轭的最终表达式：\n$$ f^*(y) = \\frac{1}{2} y^T A^{-1} y $$", "answer": "$$\\boxed{\\frac{1}{2} y^{T} A^{-1} y}$$", "id": "2163745"}]}