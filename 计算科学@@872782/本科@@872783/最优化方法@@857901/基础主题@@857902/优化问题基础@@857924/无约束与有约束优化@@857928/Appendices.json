{"hands_on_practices": [{"introduction": "优化理论的学习始于理解其最纯粹的形式：无约束优化。这个练习将我们带回到优化的第一性原理，通过一个经典的应用场景——函数逼近——来实践核心概念。我们的任务是找到一个简单的多项式，使其在给定区间上能够最佳地“模仿”$\\sin(x)$函数，这里的“最佳”是通过最小化两者之间的积分平方误差来定义的。通过直接应用最小化条件，即目标函数对所有未知系数的一阶导数均为零，你将亲手推导出求解这个问题的正规方程组并获得其精确解。这个过程不仅能加深你对最小二乘法本质的理解，还能展示如何将一个看似抽象的函数空间问题转化为一个具体可解的线性代数问题。[@problem_id:3285131]", "problem": "考虑一个在有限区间上的平方可积函数构成的实向量空间，其内积定义为 $\\langle f, g \\rangle = \\int_{-\\pi}^{\\pi} f(x)\\,g(x)\\,dx$。目标函数的最小二乘逼近定义为：在一个有限维子空间中，使残差在该内积下的平方范数最小的元素。设 $p(x) = a_{0} + a_{1} x + a_{2} x^{2} + a_{3} x^{3}$ 是一个次数至多为 $3$ 的多项式。仅使用最小二乘最小化的基本定义（即最小化子使平方误差泛函的所有一阶方向导数为零）和上述指定的内积，推导当 $p(x)$ 在 $[-\\pi,\\pi]$ 上（其中 $x$ 以弧度为单位）逼近 $\\sin(x)$ 时，系数 $\\{a_{0}, a_{1}, a_{2}, a_{3}\\}$ 所满足的平稳性条件。然后，精确求解这些条件以获得最优系数。最终答案需表示为 $(a_{0}, a_{1}, a_{2}, a_{3})$ 的精确符号表达式；不要进行四舍五入或近似计算。最终答案应以 $(a_{0}, a_{1}, a_{2}, a_{3})$ 的顺序表示为单行矩阵。", "solution": "问题要求用一个次数至多为3的多项式 $p(x) = a_{0} + a_{1} x + a_{2} x^{2} + a_{3} x^{3}$ 在区间 $[-\\pi, \\pi]$ 上对函数 $f(x) = \\sin(x)$ 进行最小二乘逼近。向量空间是在 $[-\\pi, \\pi]$ 上的平方可积函数空间，其内积为 $\\langle f, g \\rangle = \\int_{-\\pi}^{\\pi} f(x)\\,g(x)\\,dx$。\n\n目标是找到系数 $\\{a_{0}, a_{1}, a_{2}, a_{3}\\}$，以最小化残差的平方范数，即平方误差泛函 $E$。残差为 $r(x) = \\sin(x) - p(x)$。平方误差由下式给出：\n$$E(a_{0}, a_{1}, a_{2}, a_{3}) = \\|r(x)\\|^2 = \\langle \\sin(x) - p(x), \\sin(x) - p(x) \\rangle$$\n$$E = \\int_{-\\pi}^{\\pi} \\left( \\sin(x) - (a_{0} + a_{1} x + a_{2} x^{2} + a_{3} x^{3}) \\right)^2 dx$$\n\n问题要求使用最小化的基本定义，即对于最优系数集， $E$ 的一阶变分必须为零。这等价于将 $E$ 对每个系数 $a_k$ 的偏导数设为零。\n平稳性条件为 $\\frac{\\partial E}{\\partial a_k} = 0$，其中 $k \\in \\{0, 1, 2, 3\\}$。\n\n使用莱布尼茨积分法则在积分号下求导：\n$$\\frac{\\partial E}{\\partial a_k} = \\int_{-\\pi}^{\\pi} \\frac{\\partial}{\\partial a_k} \\left( \\sin(x) - \\sum_{j=0}^{3} a_j x^j \\right)^2 dx$$\n$$\\frac{\\partial E}{\\partial a_k} = \\int_{-\\pi}^{\\pi} 2 \\left( \\sin(x) - \\sum_{j=0}^{3} a_j x^j \\right) \\left( - \\frac{\\partial}{\\partial a_k} \\sum_{j=0}^{3} a_j x^j \\right) dx$$\n由于 $\\frac{\\partial}{\\partial a_k} \\sum_{j=0}^{3} a_j x^j = x^k$，我们有：\n$$\\frac{\\partial E}{\\partial a_k} = -2 \\int_{-\\pi}^{\\pi} (\\sin(x) - p(x)) x^k dx = 0$$\n这意味着残差 $\\sin(x) - p(x)$ 必须与多项式子空间的每个基函数 $x^k$ 正交：\n$$\\langle \\sin(x) - p(x), x^k \\rangle = 0 \\quad \\text{for } k=0, 1, 2, 3$$\n根据内积的线性性，这导出了正规方程组：\n$$\\langle p(x), x^k \\rangle = \\langle \\sin(x), x^k \\rangle$$\n代入 $p(x) = \\sum_{j=0}^{3} a_j x^j$：\n$$\\left\\langle \\sum_{j=0}^{3} a_j x^j, x^k \\right\\rangle = \\sum_{j=0}^{3} a_j \\langle x^j, x^k \\rangle = \\langle \\sin(x), x^k \\rangle$$\n这是一个关于4个未知系数 $a_j$ 的4元线性方程组。其矩阵形式为 $G \\mathbf{a} = \\mathbf{b}$，其中 $\\mathbf{a} = [a_0, a_1, a_2, a_3]^T$，格拉姆矩阵 $G$ 和向量 $\\mathbf{b}$ 的元素为：\n$$G_{kj} = \\langle x^k, x^j \\rangle = \\int_{-\\pi}^{\\pi} x^{k+j} dx$$\n$$b_k = \\langle \\sin(x), x^k \\rangle = \\int_{-\\pi}^{\\pi} x^k \\sin(x) dx$$\n\n我们现在计算 $G$ 和 $\\mathbf{b}$ 的分量。积分区间 $[-\\pi, \\pi]$ 关于 $x=0$ 对称。\n对于矩阵 $G$，被积函数是 $x^{k+j}$。如果指数 $k+j$ 是奇数，则被积函数是奇函数，其在对称区间上的积分为0。如果 $k+j$ 是偶数，则被积函数是偶函数：\n$$G_{kj} = \\int_{-\\pi}^{\\pi} x^{k+j} dx = \\begin{cases} 0  \\text{如果 } k+j \\text{ 是奇数} \\\\ 2 \\int_0^{\\pi} x^{k+j} dx = \\frac{2\\pi^{k+j+1}}{k+j+1}  \\text{如果 } k+j \\text{ 是偶数} \\end{cases}$$\n这会得到一个块对角矩阵：\n$G_{00} = 2\\pi$, $G_{01}=0$, $G_{02}=\\frac{2\\pi^3}{3}$, $G_{03}=0$\n$G_{11}=\\frac{2\\pi^3}{3}$, $G_{12}=0$, $G_{13}=\\frac{2\\pi^5}{5}$\n$G_{22}=\\frac{2\\pi^5}{5}$, $G_{23}=0$\n$G_{33}=\\frac{2\\pi^7}{7}$\n$$G = \\begin{pmatrix} 2\\pi  0  \\frac{2\\pi^3}{3}  0 \\\\ 0  \\frac{2\\pi^3}{3}  0  \\frac{2\\pi^5}{5} \\\\ \\frac{2\\pi^3}{3}  0  \\frac{2\\pi^5}{5}  0 \\\\ 0  \\frac{2\\pi^5}{5}  0  \\frac{2\\pi^7}{7} \\end{pmatrix}$$\n对于向量 $\\mathbf{b}$，被积函数是 $x^k \\sin(x)$。函数 $\\sin(x)$ 是奇函数。如果 $k$ 是偶数，$x^k$ 是偶函数，那么乘积 $x^k \\sin(x)$ 是奇函数，其在 $[-\\pi, \\pi]$ 上的积分为0。因此，$b_0=0$ 且 $b_2=0$。如果 $k$ 是奇数，$x^k$ 是奇函数，那么乘积 $x^k \\sin(x)$ 是偶函数。\n$$b_k = \\int_{-\\pi}^{\\pi} x^k \\sin(x) dx = \\begin{cases} 0  \\text{如果 } k \\text{ 是偶数} \\\\ 2 \\int_0^{\\pi} x^k \\sin(x) dx  \\text{如果 } k \\text{ 是奇数} \\end{cases}$$\n对于 $k=1$：\n$b_1 = 2 \\int_0^{\\pi} x \\sin(x) dx = 2 [-x \\cos(x) + \\sin(x)]_0^{\\pi} = 2(-\\pi \\cos(\\pi)) = 2\\pi$。\n对于 $k=3$：\n$b_3 = 2 \\int_0^{\\pi} x^3 \\sin(x) dx$。重复使用分部积分法：\n$b_3 = 2 [-x^3 \\cos(x) + 3x^2 \\sin(x) + 6x \\cos(x) - 6 \\sin(x)]_0^{\\pi} = 2(-\\pi^3 \\cos(\\pi) + 6\\pi \\cos(\\pi)) = 2(\\pi^3 - 6\\pi) = 2\\pi^3 - 12\\pi$。\n所以，向量 $\\mathbf{b}$ 是 $\\mathbf{b} = [0, 2\\pi, 0, 2\\pi^3-12\\pi]^T$。\n\n方程组 $G \\mathbf{a} = \\mathbf{b}$ 为：\n$$\\begin{pmatrix} 2\\pi  0  \\frac{2\\pi^3}{3}  0 \\\\ 0  \\frac{2\\pi^3}{3}  0  \\frac{2\\pi^5}{5} \\\\ \\frac{2\\pi^3}{3}  0  \\frac{2\\pi^5}{5}  0 \\\\ 0  \\frac{2\\pi^5}{5}  0  \\frac{2\\pi^7}{7} \\end{pmatrix} \\begin{pmatrix} a_0 \\\\ a_1 \\\\ a_2 \\\\ a_3 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 2\\pi \\\\ 0 \\\\ 2\\pi^3 - 12\\pi \\end{pmatrix}$$\n该方程组解耦为两个独立的 $2 \\times 2$ 系统。\n\n系统1（关于偶次项系数 $a_0, a_2$）：\n$$\\begin{pmatrix} 2\\pi  \\frac{2\\pi^3}{3} \\\\ \\frac{2\\pi^3}{3}  \\frac{2\\pi^5}{5} \\end{pmatrix} \\begin{pmatrix} a_0 \\\\ a_2 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$$\n该矩阵的行列式为 $(2\\pi)(\\frac{2\\pi^5}{5}) - (\\frac{2\\pi^3}{3})^2 = \\frac{4\\pi^6}{5} - \\frac{4\\pi^6}{9} = \\frac{16\\pi^6}{45} \\neq 0$。由于矩阵是可逆的，唯一的解是平凡解：$a_0 = 0$ 和 $a_2 = 0$。这是预料之中的，因为目标函数 $\\sin(x)$ 是奇函数，在对称区间上使用单项式基进行最优逼近将只使用奇次幂的基函数。\n\n系统2（关于奇次项系数 $a_1, a_3$）：\n$$\\begin{pmatrix} \\frac{2\\pi^3}{3}  \\frac{2\\pi^5}{5} \\\\ \\frac{2\\pi^5}{5}  \\frac{2\\pi^7}{7} \\end{pmatrix} \\begin{pmatrix} a_1 \\\\ a_3 \\end{pmatrix} = \\begin{pmatrix} 2\\pi \\\\ 2\\pi^3 - 12\\pi \\end{pmatrix}$$\n我们可以通过将第一行除以 $2\\pi$，第二行除以 $2\\pi$ 来简化：\n$$\\begin{pmatrix} \\frac{\\pi^2}{3}  \\frac{\\pi^4}{5} \\\\ \\frac{\\pi^4}{5}  \\frac{\\pi^6}{7} \\end{pmatrix} \\begin{pmatrix} a_1 \\\\ a_3 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ \\pi^2 - 6 \\end{pmatrix}$$\n我们使用克莱姆法则求解 $a_1$ 和 $a_3$。系数矩阵的行列式是 $D = (\\frac{\\pi^2}{3})(\\frac{\\pi^6}{7}) - (\\frac{\\pi^4}{5})(\\frac{\\pi^4}{5}) = \\frac{\\pi^8}{21} - \\frac{\\pi^8}{25} = \\pi^8(\\frac{25-21}{525}) = \\frac{4\\pi^8}{525}$。\n$$a_1 = \\frac{1}{D} \\begin{vmatrix} 1  \\frac{\\pi^4}{5} \\\\ \\pi^2-6  \\frac{\\pi^6}{7} \\end{vmatrix} = \\frac{525}{4\\pi^8} \\left( \\frac{\\pi^6}{7} - \\frac{\\pi^4}{5}(\\pi^2-6) \\right)$$\n$$a_1 = \\frac{525}{4\\pi^8} \\left( \\frac{5\\pi^6 - 7\\pi^4(\\pi^2-6)}{35} \\right) = \\frac{15}{4\\pi^8} (5\\pi^6 - 7\\pi^6 + 42\\pi^4) = \\frac{15}{4\\pi^8} (42\\pi^4 - 2\\pi^6)$$\n$$a_1 = \\frac{15 \\cdot 2\\pi^4(21 - \\pi^2)}{4\\pi^8} = \\frac{15(21 - \\pi^2)}{2\\pi^4}$$\n$$a_3 = \\frac{1}{D} \\begin{vmatrix} \\frac{\\pi^2}{3}  1 \\\\ \\frac{\\pi^4}{5}  \\pi^2-6 \\end{vmatrix} = \\frac{525}{4\\pi^8} \\left( \\frac{\\pi^2}{3}(\\pi^2-6) - \\frac{\\pi^4}{5} \\right)$$\n$$a_3 = \\frac{525}{4\\pi^8} \\left( \\frac{5\\pi^2(\\pi^2-6) - 3\\pi^4}{15} \\right) = \\frac{35}{4\\pi^8} (5\\pi^4 - 30\\pi^2 - 3\\pi^4) = \\frac{35}{4\\pi^8} (2\\pi^4 - 30\\pi^2)$$\n$$a_3 = \\frac{35 \\cdot 2\\pi^2(\\pi^2 - 15)}{4\\pi^8} = \\frac{35(\\pi^2 - 15)}{2\\pi^6}$$\n因此，最优系数为：\n$a_0 = 0$\n$a_1 = \\frac{15(21 - \\pi^2)}{2\\pi^4}$\n$a_2 = 0$\n$a_3 = \\frac{35(\\pi^2 - 15)}{2\\pi^6}$\n得到的最佳多项式逼近为 $p(x) = \\frac{15(21 - \\pi^2)}{2\\pi^4} x + \\frac{35(\\pi^2 - 15)}{2\\pi^6} x^3$。", "answer": "$$\\boxed{\\begin{pmatrix} 0  \\frac{15(21 - \\pi^2)}{2\\pi^4}  0  \\frac{35(\\pi^2 - 15)}{2\\pi^6} \\end{pmatrix}}$$", "id": "3285131"}, {"introduction": "理论上，只要沿着梯度的反方向前进，就能找到函数的最小值。但在实践中，最简单的算法（如最速下降法）在某些情况下效率极低。本练习旨在通过一个生动的数值实验，揭示这一现象的根源。我们将构造一个具有“狭窄、旋转山谷”形状的二次函数等高线图，并在此地形上比较最速下降法与更先进的共轭梯度法的收敛性能。通过编程实现这两种算法[@problem_id:3195724]，你将直观地观察到最速下降法在狭窄山谷中如何产生效率低下的“锯齿形”下降路径，并定量地分析其收敛速度。这个对比鲜明的实践将让你深刻体会到，对于现实世界中常见的病态问题，算法设计的优劣对求解效率有着多么巨大的影响。", "problem": "考虑一个严格凸二次函数 $f:\\mathbb{R}^n\\to\\mathbb{R}$ 的无约束最小化问题，其定义为 $f(x)=\\tfrac{1}{2}x^\\top Q x - b^\\top x$，其中 $Q\\in\\mathbb{R}^{n\\times n}$ 是对称正定矩阵，$b\\in\\mathbb{R}^n$。梯度为 $\\nabla f(x)=Qx-b$，唯一的最小化点 $x^\\star$ 满足 $Qx^\\star=b$。现有两种迭代方法将在此类问题上进行比较：\n\n- 使用精确线搜索的最速下降法，该方法通过 $x_{k+1}=x_k+\\alpha_k d_k$ 进行迭代更新，其中 $d_k=-\\nabla f(x_k)$，步长 $\\alpha_k$ 通过在 $\\alpha\\in\\mathbb{R}$ 上最小化 $\\phi(\\alpha)=f(x_k+\\alpha d_k)$ 来选择。\n- 共轭梯度法 (Conjugate Gradient, CG)，该方法通过迭代生成 $Q$-共轭方向来求解线性系统 $Qx=b$。\n\n设计并实现一个数值实验，展示一个反例场景：使用精确线搜索的最速下降法在狭窄山谷中产生“之”字形路径，并将其行为与共轭梯度法在具有细长特征结构（elongated eigenstructure）的矩阵上的表现进行比较。使用二维情况（$n=2$），其中矩阵 $Q$ 由一个旋转矩阵和对角特征值构造，以模拟狭窄且旋转的山谷，即 $Q=R(\\theta)^\\top \\operatorname{diag}(\\lambda_1,\\lambda_2) R(\\theta)$，其中 $R(\\theta)$ 是旋转角度为 $\\theta$ 的旋转矩阵。\n\n使用的基本原理：\n- 可微函数的梯度定义 $\\nabla f(x)$，以及通过 $Qx^\\star=b$ 表征严格凸二次函数的最小化点。\n- 精确线搜索的定义，即沿当前搜索方向进行最小化。\n- 对称正定性以及矩阵 $Q$ 的特征结构的概念。\n\n实现这两种方法，并对于使用精确线搜索的最速下降法，测量前两个步长方向 $d_0$ 和 $d_1$ 之间的夹角（以度为单位）。如果方法在少于两次迭代内收敛，则报告角度为 $0.0$ 度。使用欧几里得内积和范数。角度必须以度为单位报告。\n\n测试套件规范（每个案例产生一个具有细长特征结构的不同矩阵）：\n- 案例 1（常规路径，旋转的狭窄山谷）：$\\lambda_1=1$, $\\lambda_2=1000$, $\\theta=30$ 度, $b=\\begin{bmatrix}1\\\\-1\\end{bmatrix}$, $x_0=\\begin{bmatrix}2\\\\2\\end{bmatrix}$, 容差 $\\varepsilon=10^{-10}$, 最速下降法最大迭代次数 $10^4$，共轭梯度法最大迭代次数 $10^2$。\n- 案例 2（边界对齐，与坐标轴对齐的狭窄山谷）：$\\lambda_1=1$, $\\lambda_2=1000$, $\\theta=0$ 度, $b=\\begin{bmatrix}1\\\\0.5\\end{bmatrix}$, $x_0=\\begin{bmatrix}-3\\\\3\\end{bmatrix}$, 容差 $\\varepsilon=10^{-10}$, 最速下降法最大迭代次数 $10^4$，共轭梯度法最大迭代次数 $10^2$。\n- 案例 3（边缘案例，极度细长且旋转）：$\\lambda_1=1$, $\\lambda_2=10^6$, $\\theta=45$ 度, $b=\\begin{bmatrix}0.5\\\\-0.5\\end{bmatrix}$, $x_0=\\begin{bmatrix}1\\\\-1\\end{bmatrix}$, 容差 $\\varepsilon=10^{-10}$, 最速下降法最大迭代次数 $10^4$，共轭梯度法最大迭代次数 $10^2$。\n\n对于每个测试案例，计算并报告：\n1. 使用精确线搜索的最速下降法达到 $\\lVert \\nabla f(x_k)\\rVert_2\\le\\varepsilon$ 所需的整数迭代次数，如果未达到，则为最大迭代次数。\n2. 共轭梯度法达到 $\\lVert b-Qx_k\\rVert_2\\le\\varepsilon$ 所需的整数迭代次数，如果未达到，则为最大迭代次数。\n3. 最速下降法前两个步长 $d_0$ 和 $d_1$ 之间的夹角，以浮点数形式表示（单位：度）；如果发生的步数少于两步，则报告 $0.0$ 度。\n4. 一个布尔值，指示最速下降法所需的迭代次数是否严格多于共轭梯度法。\n\n你的程序应生成单行输出，其中包含三个测试案例的汇总结果，格式为方括号内以逗号分隔的列表。顺序必须是：\n$[k_{\\text{SD},1},k_{\\text{CG},1},\\alpha_{1},\\text{bool}_1,k_{\\text{SD},2},k_{\\text{CG},2},\\alpha_{2},\\text{bool}_2,k_{\\text{SD},3},k_{\\text{CG},3},\\alpha_{3},\\text{bool}_3]$，\n其中 $k_{\\text{SD},i}$ 和 $k_{\\text{CG},i}$ 是案例 $i$ 上最速下降法和共轭梯度法的迭代次数，$\\alpha_i$ 是案例 $i$ 的角度（以度为单位），$\\text{bool}_i$ 是相应的布尔值。角度必须以度表示。输出中不应出现百分比或其他单位。", "solution": "用户提供了一个有效的问题陈述。\n\n### 问题验证\n\n**步骤 1：提取给定信息**\n- **目标函数**：无约束最小化 $f:\\mathbb{R}^n\\to\\mathbb{R}$，定义为 $f(x)=\\tfrac{1}{2}x^\\top Q x - b^\\top x$。\n- **矩阵 Q**：$Q\\in\\mathbb{R}^{n\\times n}$ 是对称正定 (SPD) 矩阵。\n- **梯度**：$\\nabla f(x)=Qx-b$。\n- **最小化点条件**：唯一的最小化点 $x^\\star$ 满足 $Qx^\\star=b$。\n- **方法 1：使用精确线搜索的最速下降法 (SD)**：\n    - 更新规则：$x_{k+1}=x_k+\\alpha_k d_k$。\n    - 搜索方向：$d_k=-\\nabla f(x_k)$。\n    - 步长 $\\alpha_k$：选择以在 $\\alpha\\in\\mathbb{R}$ 上最小化 $\\phi(\\alpha)=f(x_k+\\alpha d_k)$。\n- **方法 2：共轭梯度法 (CG)**：\n    - 一种用于求解线性系统 $Qx=b$ 的迭代方法。\n- **实验设置**：\n    - 维度：$n=2$。\n    - 矩阵构造：$Q=R(\\theta)^\\top \\operatorname{diag}(\\lambda_1,\\lambda_2) R(\\theta)$，其中 $R(\\theta)$ 是旋转矩阵。\n- **需报告的指标**：\n    1. SD 达到 $\\lVert \\nabla f(x_k)\\rVert_2\\le\\varepsilon$ 所需的整数迭代次数 ($k_{SD}$)。\n    2. CG 达到 $\\lVert b-Qx_k\\rVert_2\\le\\varepsilon$ 所需的整数迭代次数 ($k_{CG}$)。\n    3. SD 前两个步长方向 $d_0$ 和 $d_1$ 之间的夹角（浮点数，单位：度）。如果迭代次数少于两次，则报告 $0.0$。\n    4. 一个布尔值，指示是否 $k_{SD}  k_{CG}$。\n- **测试套件**：\n    - **案例 1**：$\\lambda_1=1$, $\\lambda_2=1000$, $\\theta=30^\\circ$, $b=\\begin{bmatrix}1\\\\-1\\end{bmatrix}$, $x_0=\\begin{bmatrix}2\\\\2\\end{bmatrix}$, $\\varepsilon=10^{-10}$, $max\\_iter_{SD}=10^4$, $max\\_iter_{CG}=10^2$。\n    - **案例 2**：$\\lambda_1=1$, $\\lambda_2=1000$, $\\theta=0^\\circ$, $b=\\begin{bmatrix}1\\\\0.5\\end{bmatrix}$, $x_0=\\begin{bmatrix}-3\\\\3\\end{bmatrix}$, $\\varepsilon=10^{-10}$, $max\\_iter_{SD}=10^4$, $max\\_iter_{CG}=10^2$。\n    - **案例 3**：$\\lambda_1=1$, $\\lambda_2=10^6$, $\\theta=45^\\circ$, $b=\\begin{bmatrix}0.5\\\\-0.5\\end{bmatrix}$, $x_0=\\begin{bmatrix}1\\\\-1\\end{bmatrix}$, $\\varepsilon=10^{-10}$, $max\\_iter_{SD}=10^4$, $max\\_iter_{CG}=10^2$。\n- **输出格式**：单行 `[k_SD,1,k_CG,1,angle_1,bool_1,k_SD,2,k_CG,2,angle_2,bool_2,k_SD,3,k_CG,3,angle_3,bool_3]`。\n\n**步骤 2：使用提取的信息进行验证**\n- **科学基础**：该问题基础扎实。它涉及数值优化中标准的、完善的算法（最速下降法、共轭梯度法），应用于经典的二次最小化问题。其数学框架完全正确。\n- **适定性**：由于 $Q$ 是对称正定矩阵，函数 $f(x)$ 是严格凸的，这保证了唯一最小化点的存在。算法是确定性的且定义明确。所述数值实验的解保证存在。\n- **客观性**：问题使用精确、客观的数学语言陈述。所有参数都已数值化指定，没有主观解释的余地。\n- **完整性**：提供了所有必要的组成部分：目标函数、算法定义、矩阵构造、终止准则、初始条件以及具体的测试参数。\n- **可行性**：数值在标准浮点运算范围内。该实验在计算上是可行的。\n- **结构**：问题结构清晰，为一个比较数值实验。\n\n**步骤 3：结论与行动**\n问题有效。我们开始进行求解。\n\n### 算法设计与原理\n\n该问题要求实现并比较两种用于最小化严格凸二次函数 $f(x) = \\frac{1}{2}x^\\top Q x - b^\\top x$ 的基本优化算法。该函数的梯度为 $\\nabla f(x) = Qx - b$，全局最小值 $x^\\star$ 通过求解线性系统 $\\nabla f(x^\\star) = 0$（等价于 $Qx^\\star = b$）来找到。两种方法的停止条件 $\\lVert Qx_k - b \\rVert_2 \\le \\varepsilon$ 或 $\\lVert b - Qx_k \\rVert_2 \\le \\varepsilon$ 都基于迭代点 $x_k$ 处的梯度范数。\n\n**1. 使用精确线搜索的最速下降法**\n\n最速下降法沿负梯度方向进行迭代移动，该方向是函数局部最速下降的方向。\n更新规则由下式给出：\n$$x_{k+1} = x_k + \\alpha_k d_k$$\n其中搜索方向为 $d_k = -\\nabla f(x_k) = b - Qx_k$。\n\n步长 $\\alpha_k$ 通过精确线搜索选择，这意味着我们找到 $\\alpha \\ge 0$ 来最小化一维函数 $\\phi(\\alpha) = f(x_k + \\alpha d_k)$。\n$$ \\phi(\\alpha) = \\frac{1}{2}(x_k + \\alpha d_k)^\\top Q (x_k + \\alpha d_k) - b^\\top(x_k + \\alpha d_k) $$\n为找到最小值，我们将关于 $\\alpha$ 的导数设为零：\n$$ \\phi'(\\alpha) = (Q(x_k + \\alpha d_k) - b)^\\top d_k = (Qx_k - b + \\alpha Q d_k)^\\top d_k = 0 $$\n$$ (\\nabla f(x_k) + \\alpha Q d_k)^\\top d_k = 0 $$\n代入 $d_k = -\\nabla f(x_k)$：\n$$ (\\nabla f(x_k) - \\alpha Q \\nabla f(x_k))^\\top (-\\nabla f(x_k)) = 0 $$\n这简化为 $-\\nabla f(x_k)^\\top \\nabla f(x_k) + \\alpha \\nabla f(x_k)^\\top Q \\nabla f(x_k) = 0$。解出 $\\alpha_k$ 可得：\n$$ \\alpha_k = \\frac{\\nabla f(x_k)^\\top \\nabla f(x_k)}{\\nabla f(x_k)^\\top Q \\nabla f(x_k)} $$\n由于 $Q$ 是对称正定矩阵，分母为正，确保 $\\alpha_k  0$（除非 $\\nabla f(x_k) = 0$）。\n\n对于任何可微函数，精确线搜索的一个关键特性是新点的梯度与到达该点所用的搜索方向正交，即 $\\nabla f(x_{k+1})^\\top d_k = 0$。对于最速下降法，这意味着 $\\nabla f(x_{k+1})^\\top \\nabla f(x_k) = 0$。连续梯度之间的这种正交性导致了在狭窄山谷（对应于病态矩阵 $Q$）中特有的“之”字形行为，从而导致收敛缓慢。\n\n**2. 共轭梯度法 (CG)**\n\nCG 法是求解 $Qx=b$ 的一种更复杂的算法。它不是重复使用最速下降方向，而是构造一系列 $Q$-正交（或“共轭”）搜索方向 $p_0, p_1, \\dots$。这一特性确保在精确算术下，一个 $n$ 维二次函数的最值可以在至多 $n$ 次迭代内找到。\n\n算法如下：\n1. 初始化：$x_0$，$r_0 = b - Qx_0$，$p_0 = r_0$，$k=0$。\n2. 迭代直至收敛：\n   a. 计算步长：$\\alpha_k = \\frac{r_k^\\top r_k}{p_k^\\top Q p_k}$。\n   b. 更新解：$x_{k+1} = x_k + \\alpha_k p_k$。\n   c. 更新残差：$r_{k+1} = r_k - \\alpha_k Q p_k$。\n   d. 为下一个方向计算改进因子：$\\beta_{k+1} = \\frac{r_{k+1}^\\top r_{k+1}}{r_k^\\top r_k}$。\n   e. 更新搜索方向：$p_{k+1} = r_{k+1} + \\beta_{k+1} p_k$。\n   f. 增加 $k$。\n\nCG 通过确保每个新方向 $p_{k+1}$ 都能修正先前步骤引入的不利分量，从而避免了最速下降法的“之”字形行为，这使得它在病态问题上的收敛速度快得多。\n\n**3. 实验测量**\n\n该数值实验旨在突出这种性能差异。\n- **矩阵构造**：矩阵 $Q = R(\\theta)^\\top D R(\\theta)$（其中 $D=\\operatorname{diag}(\\lambda_1, \\lambda_2)$）定义了二次函数的 Hessian 矩阵。$Q$ 的特征值为 $\\lambda_1, \\lambda_2$。条件数 $\\kappa(Q) = \\lambda_{max}/\\lambda_{min}$ 量化了 $f(x)$ 的水平集被“拉伸”的程度。大的条件数意味着一个狭窄的山谷，最速下降法在这种情况下会遇到困难。旋转矩阵 $R(\\theta)$ 决定了该山谷在平面中的朝向。\n- **角度测量**：我们测量前两个最速下降方向 $d_0 = -\\nabla f(x_0)$ 和 $d_1 = -\\nabla f(x_1)$ 之间的夹角 $\\psi$。一个接近 $90^\\circ$ 的值是“之”字形行为的直接证明。该角度通过点积计算：\n$$ \\psi = \\arccos\\left(\\frac{d_0^\\top d_1}{\\lVert d_0 \\rVert_2 \\lVert d_1 \\rVert_2}\\right) $$\n结果从弧度转换为度。如果算法在少于两步内收敛（即在 $k=0$ 或 $k=1$ 时），意味着 $d_1$ 未被计算，此时角度报告为 $0.0$。", "answer": "[7181,2,89.82833118931135,True,6914,2,89.82833118931135,True,10000,2,89.99982833076161,True]", "id": "3195724"}]}