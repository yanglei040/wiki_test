{"hands_on_practices": [{"introduction": "形状约束回归是一种强大的统计工具，它将诸如单调性或凸性等先验知识融入模型中。本练习将挑战您如何将这些抽象的形状属性转化为锥规划框架下的具体线性约束。通过这个过程，您将练习数学建模的基本技能，学习如何将定性假设表达为精确且可解的优化问题。[@problem_id:3111059]", "problem": "考虑 $n$ 个等间距设计点 $x_1, x_2, \\dots, x_n$ 及其观测响应 $y_1, y_2, \\dots, y_n$。如果一个拟合序列 $f_1, f_2, \\dots, f_n$ 的一阶前向差分 $d_i := f_{i+1} - f_i$ 对所有 $i$ 都满足 $d_i \\ge 0$，则称该序列为单调不减的；如果其二阶前向差分 $\\Delta^2 f_i := f_{i+2} - 2 f_{i+1} + f_i$ 对所有有定义的 $i$ 都满足 $\\Delta^2 f_i \\ge 0$，则称该序列为离散凸的。这些是基于均匀间隔输入的差分算子所定义的单调性和凸性的离散模拟。\n\n您将构建形态约束回归模型，并使用成熟的锥优化原语来分析平滑度的权衡。具体来说：\n\n- 线性规划 (LP) 可以使用辅助变量来模拟绝对值损失和绝对值平滑度惩罚项，并且可以通过对差分施加线性不等式来强制实现单调性/凸性。\n\n- 二阶锥规划 (SOCP) 可以使用二阶锥约束来模拟欧几里得范数损失和欧几里得范数平滑度惩罚项，同时通过对差分施加同样的线性不等式来强制实现单调性/凸性。\n\n基于差分构建这两个模型，然后显式求解一个小的 LP 实例。\n\n1. 仅使用上述单调性和离散凸性的定义以及通过非负辅助变量对绝对值进行标准分解的方法，将以下形态约束回归问题表示为一个基于差分变量的线性规划：\n   最小化目标函数\n   $$\\sum_{i=1}^{n} |f_i - y_i| + \\mu \\sum_{i=1}^{n-2} |\\Delta^2 f_i|$$\n   约束条件为序列 $f_1, \\dots, f_n$ 满足单调不减和离散凸约束。您的公式必须用一阶差分 $d_i := f_{i+1} - f_i$ 和用于线性化绝对值的非负辅助变量来表示。\n\n2. 使用欧几里得范数的定义和范数不等式的标准二阶锥表示，表达一个类似的二阶锥规划 (SOCP) 问题，该问题在满足单调不减和离散凸的序列 $f_1, \\dots, f_n$ 上最小化\n   $$\\|f - y\\|_2 + \\mu \\left\\| \\Delta^2 f \\right\\|_2$$\n   ，其中 $\\Delta^2 f$ 汇集了二阶前向差分。您的 SOCP 必须引入标量变量来为这些范数设定界限，并且必须通过对差分的线性不等式来强制实现单调性和凸性。\n\n3. 考虑您在第1部分中构建的 LP，设 $n = 3$，等间距点为 $x_1 = 0, x_2 = 1, x_3 = 2$，观测响应为 $y_1 = 0, y_2 = 2, y_3 = 1$。对于任意平滑权重 $\\mu \\ge 0$，精确求解此 LP，并报告在 $x_3$ 处的最优拟合值，即 $f_3$。如果需要舍入，请说明您的精确结果；不要进行四舍五入。\n\n您的最终答案必须是针对指定实例的 $f_3$ 的单一值，以精确数的形式写出。", "solution": "用户提供了一个关于使用锥优化进行形态约束回归的三部分问题。我将首先验证问题陈述，然后依次解决每个部分。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n-   **定义：**\n    -   $n$ 个等间距设计点 $x_1, \\dots, x_n$ 及其观测响应 $y_1, \\dots, y_n$。\n    -   拟合序列 $f_1, \\dots, f_n$。\n    -   一阶前向差分：$d_i := f_{i+1} - f_i$，对于 $i=1, \\dots, n-1$。\n    -   二阶前向差分：$\\Delta^2 f_i := f_{i+2} - 2f_{i+1} + f_i$，对于 $i=1, \\dots, n-2$。\n    -   单调不减：对所有 $i$，有 $d_i \\ge 0$。\n    -   离散凸：对所有 $i$，有 $\\Delta^2 f_i \\ge 0$。\n-   **第1部分任务 (LP 构建)：**\n    -   最小化目标：$\\sum_{i=1}^{n} |f_i - y_i| + \\mu \\sum_{i=1}^{n-2} |\\Delta^2 f_i|$。\n    -   约束条件：单调不减和离散凸约束。\n    -   构建要求：必须是基于差分变量 $d_i$ 和用于处理绝对值的非负辅助变量的线性规划 (LP)。\n-   **第2部分任务 (SOCP 构建)：**\n    -   最小化目标：$\\|f - y\\|_2 + \\mu \\| \\Delta^2 f \\|_2$。\n    -   约束条件：单调不减和离散凸约束。\n    -   构建要求：必须是使用标量变量来限定范数的二阶锥规划 (SOCP)。\n-   **第3部分任务 (求解 LP 实例)：**\n    -   求解第1部分中针对特定情况的 LP：\n    -   $n=3$。\n    -   $x_1=0, x_2=1, x_3=2$。\n    -   $y_1=0, y_2=2, y_3=1$。\n    -   平滑权重 $\\mu \\ge 0$。\n    -   要求输出：$f_3$ 的最优值。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题在科学上和数学上都是合理的。这是一个凸优化领域的适定问题，将标准技术（LP 和 SOCP）应用于统计学中的一个常见问题（形态约束回归）。定义精确且标准。问题是自洽的，提供了求解所需的所有必要信息。不存在事实错误、歧义或矛盾。\n\n**步骤3：结论与行动**\n问题有效。我将进行详细解答。\n\n### 第1部分：线性规划 (LP) 构建\n\n目标是将给定的优化问题构建为一个线性规划。优化变量将是序列的第一个值 $f_1$ 和一阶差分 $d_i = f_{i+1} - f_i$（对于 $i=1, \\dots, n-1$）。\n\n基于这些变量，我们可以表示出拟合值 $f_i$ 和二阶差分 $\\Delta^2 f_i$：\n-   $f_1$ 是一个基本变量。\n-   $f_i = f_1 + \\sum_{k=1}^{i-1} d_k$，对于 $i=2, \\dots, n$。\n-   $\\Delta^2 f_i = (f_{i+2} - f_{i+1}) - (f_{i+1} - f_i) = d_{i+1} - d_i$，对于 $i=1, \\dots, n-2$。\n\n目标函数包含绝对值，必须进行线性化。我们引入非负辅助变量：\n-   $u_i$ 用来表示 $|f_i - y_i|$（对于 $i=1, \\dots, n$）。在目标函数中，项 $|z|$ 被一个变量 $w$ 替代，并受约束 $w \\ge z$ 和 $w \\ge -z$ 的限制。\n-   $v_i$ 用来表示 $|\\Delta^2 f_i|$（对于 $i=1, \\dots, n-2$）。\n\n形态约束用差分变量表示为：\n-   单调性：$d_i \\ge 0$，对于 $i=1, \\dots, n-1$。\n-   凸性：$\\Delta^2 f_i = d_{i+1} - d_i \\ge 0$，对于 $i=1, \\dots, n-2$。\n\n完整的 LP 构建如下：\n\n**变量：**\n-   $f_1 \\in \\mathbb{R}$\n-   $d_i \\in \\mathbb{R}$，对于 $i=1, \\dots, n-1$\n-   $u_i \\in \\mathbb{R}$，对于 $i=1, \\dots, n$\n-   $v_i \\in \\mathbb{R}$，对于 $i=1, \\dots, n-2$\n\n**目标：**\n最小化 $ \\sum_{i=1}^{n} u_i + \\mu \\sum_{i=1}^{n-2} v_i $\n\n**约束：**\n1.  **损失线性化：**\n    -   $u_1 \\ge f_1 - y_1$\n    -   $u_1 \\ge -(f_1 - y_1)$\n    -   对于 $i = 2, \\dots, n$：\n        -   $u_i \\ge \\left(f_1 + \\sum_{k=1}^{i-1} d_k\\right) - y_i$\n        -   $u_i \\ge -\\left(f_1 + \\sum_{k=1}^{i-1} d_k\\right) + y_i$\n2.  **惩罚项线性化：** 对于 $i=1, \\dots, n-2$：\n    -   $v_i \\ge d_{i+1} - d_i$\n    -   $v_i \\ge -(d_{i+1} - d_i)$\n3.  **单调性：** 对于 $i=1, \\dots, n-1$：\n    -   $d_i \\ge 0$\n4.  **凸性：** 对于 $i=1, \\dots, n-2$：\n    -   $d_{i+1} - d_i \\ge 0$\n5.  **辅助变量的非负性：**\n    -   $u_i \\ge 0$，对于 $i=1, \\dots, n$\n    -   $v_i \\ge 0$，对于 $i=1, \\dots, n-2$\n    (注意：这些约束已由线性化约束所蕴含，但在 LP 中标准做法是明确陈述它们)。\n\n### 第2部分：二阶锥规划 (SOCP) 构建\n\n目标函数 $\\|f-y\\|_2 + \\mu \\|\\Delta^2 f\\|_2$ 涉及欧几里得范数。我们引入两个标量辅助变量 $t_1$ 和 $t_2$ 来为这些范数设定界限。问题等价于最小化 $t_1 + \\mu t_2$，约束条件为 $\\|f-y\\|_2 \\le t_1$ 和 $\\|\\Delta^2 f\\|_2 \\le t_2$。这些不等式是二阶锥约束。\n\n使用与第1部分相同的基本变量 $f_1$ 和 $d_i$。\n\n**变量：**\n-   $f_1 \\in \\mathbb{R}$\n-   $d_i \\in \\mathbb{R}$，对于 $i=1, \\dots, n-1$\n-   $t_1, t_2 \\in \\mathbb{R}$\n\n**目标：**\n最小化 $ t_1 + \\mu t_2 $\n\n**约束：**\n1.  **损失范数约束 (SOC)：**\n    -   令向量 $z_f = f-y$。其分量为：\n        -   $z_{f,1} = f_1 - y_1$\n        -   $z_{f,i} = \\left(f_1 + \\sum_{k=1}^{i-1} d_k\\right) - y_i$，对于 $i=2, \\dots, n$。\n    -   约束为 $\\|z_f\\|_2 \\le t_1$，这是对向量 $(t_1, z_f^T)$ 的标准二阶锥约束。\n\n2.  **惩罚范数约束 (SOC)：**\n    -   令向量 $z_d = \\Delta^2 f$。其分量为：\n        -   $z_{d,i} = d_{i+1} - d_i$，对于 $i=1, \\dots, n-2$。\n    -   约束为 $\\|z_d\\|_2 \\le t_2$，这是对向量 $(t_2, z_d^T)$ 的标准二阶锥约束。\n\n3.  **单调性 (线性)：** 对于 $i=1, \\dots, n-1$：\n    -   $d_i \\ge 0$\n\n4.  **凸性 (线性)：** 对于 $i=1, \\dots, n-2$：\n    -   $d_{i+1} - d_i \\ge 0$\n\n### 第3部分：求解 LP 实例\n\n给定 $n=3, y_1=0, y_2=2, y_3=1$ 以及 $\\mu \\ge 0$。任务是找到最优的 $f_3$。\n\n对于 $n=3$，决策变量为 $f_1, d_1, d_2$。\n-   $f_1 = f_1$\n-   $f_2 = f_1 + d_1$\n-   $f_3 = f_1 + d_1 + d_2$\n\n约束条件为：\n-   单调性：$d_1 \\ge 0$, $d_2 \\ge 0$。\n-   凸性：对于 $i=1$ 有一个约束：$\\Delta^2 f_1 = d_2 - d_1 \\ge 0$。\n结合这些可得 $d_2 \\ge d_1 \\ge 0$。\n\n凸性约束 $d_2 - d_1 \\ge 0$ 意味着二阶差分总是非负的。因此， $|\\Delta^2 f_1| = |d_2 - d_1| = d_2 - d_1$。第1部分的目标函数得以简化。我们不需要变量 $v_i$。问题变为：\n最小化 $|f_1 - y_1| + |f_2 - y_2| + |f_3 - y_3| + \\mu (d_2 - d_1)$。\n代入 $f_i$ 的表达式和给定的 $y_i$：\n最小化 $J(f_1, d_1, d_2) = |f_1 - 0| + |f_1 + d_1 - 2| + |f_1 + d_1 + d_2 - 1| + \\mu(d_2 - d_1)$，约束条件为 $d_2 \\ge d_1 \\ge 0$。\n\n这是一个凸优化问题。对于固定的 $d_1, d_2$，目标函数是关于 $f_1$ 的绝对值之和：\n$\\min_{f_1} \\left( |f_1 - 0| + |f_1 - (2 - d_1)| + |f_1 - (1 - d_1 - d_2)| \\right)$\n$\\min_x \\sum_k |x-p_k|$ 的解是点集 $\\{p_k\\}$ 的中位数。这里，这些点是 $p_A=1 - d_1 - d_2$，$p_B=0$ 和 $p_C=2-d_1$。\n最优的 $f_1$ 是 $\\text{median}\\{1-d_1-d_2, 0, 2-d_1\\}$。\n由于 $d_2 \\ge 0$，我们有 $p_C - p_A = (2-d_1)-(1-d_1-d_2) = 1+d_2 \\ge 1$，所以 $p_C > p_A$。我们根据这些点相对于 $0$ 的排序来分析三种情况。\n\n情况1：$1 - d_1 - d_2 \\ge 0 \\implies d_1+d_2 \\le 1$。\n顺序为 $p_C > p_A \\ge p_B=0$。中位数是 $p_A$。最优 $f_1 = 1-d_1-d_2$。\n绝对值之和变为 $(p_C-p_B) = (2-d_1)-0 = 2-d_1$。\n目标函数变为 $J = 2-d_1 + \\mu(d_2-d_1) = 2 - d_1(1+\\mu) + \\mu d_2$。\n我们在由 $d_2 \\ge d_1 \\ge 0$ 和 $d_1+d_2 \\le 1$ 定义的区域上最小化这个线性函数。这是一个顶点为 $(0,0), (0,1), (1/2,1/2)$ 的三角形。线性函数在多胞体上的最小值出现在顶点处。\n-   在 $(0,0)$ 处：$J=2$。\n-   在 $(0,1)$ 处：$J=2+\\mu$。\n-   在 $(1/2,1/2)$ 处：$J=2-(1/2)(1+\\mu)+\\mu/2 = 2-1/2 = 3/2$。\n该区域内的最小值为 $3/2$，在 $(d_1, d_2) = (1/2, 1/2)$ 处取得。\n\n情况2：$2 - d_1 \\le 0 \\implies d_1 \\ge 2$。\n顺序为 $p_B=0 \\ge p_C > p_A$。中位数是 $p_C$。最优 $f_1 = 2-d_1$。\n绝对值之和变为 $(p_B-p_A) = 0-(1-d_1-d_2) = d_1+d_2-1$。\n目标函数为 $J = d_1+d_2-1 + \\mu(d_2-d_1) = d_1(1-\\mu) + d_2(1+\\mu)-1$。\n我们在区域 $d_2 \\ge d_1 \\ge 2$ 上进行最小化。对于任何 $\\mu \\ge 0$，$d_1, d_2$ 的系数使得最小值在角点 $(2,2)$ 处取得。\n在 $(2,2)$ 处，$J = 2(1-\\mu) + 2(1+\\mu)-1 = 2-2\\mu+2+2\\mu-1=3$。\n\n情况3：$1 - d_1 - d_2  0  2-d_1$。这对应于 $d_1+d_2 > 1$ 和 $d_1  2$。\n顺序为 $p_C > p_B=0 > p_A$。中位数是 $p_B=0$。最优 $f_1=0$。\n绝对值之和为 $(p_C-p_A)=(2-d_1)-(1-d_1-d_2) = 1+d_2$。\n目标函数为 $J = 1+d_2 + \\mu(d_2-d_1) = 1 + d_2(1+\\mu) - \\mu d_1$。\n我们在区域 $d_2 \\ge d_1 \\ge 0$, $d_1+d_2>1$, $d_12$ 上进行最小化。$J$ 关于 $(d_1, d_2)$ 的梯度是 $(-\\mu, 1+\\mu)$。对于 $\\mu>0$，该向量指向 $d_1$ 增加和 $d_2$ 减少的方向。这将我们引向边界 $d_2=d_1$。\n在这条线上，$J=1+d_1(1+\\mu)-\\mu d_1 = 1+d_1$。区域是 $d_1 \\in (1/2, 2)$，因此当 $d_1 \\to 1/2$ 时，趋近于下确界，得到 $J \\to 1+1/2=3/2$。\n如果 $\\mu=0$，$J=1+d_2$。为了最小化，我们需要最小的 $d_2$，这在点 $(1/2,1/2)$ 处趋近，得到 $J \\to 1+1/2=3/2$。\n\n比较所有情况下的最小值（$3/2$、$3$ 和 $3/2$），目标函数的全局最小值为 $3/2$。这个最小值在点 $(d_1, d_2)=(1/2, 1/2)$ 处达到，这对任何 $\\mu \\ge 0$ 都有效。\n\n在这个最优点，我们确定 $f_1$ 的值。点 $(d_1,d_2)=(1/2,1/2)$ 位于情况1和情况3的边界上（$d_1+d_2=1$）。\n使用情况1的规则：$f_1 = 1 - d_1 - d_2 = 1 - 1/2 - 1/2 = 0$。\n使用情况3的规则：$f_1=0$。\n两者一致。最优值为 $f_1=0$。\n\n我们现在可以找到最优拟合序列：\n-   $f_1 = 0$\n-   $f_2 = f_1 + d_1 = 0 + 1/2 = 1/2$\n-   $f_3 = f_1 + d_1 + d_2 = 0 + 1/2 + 1/2 = 1$\n\n问题要求 $f_3$ 的最优值。", "answer": "$$\n\\boxed{1}\n$$", "id": "3111059"}, {"introduction": "处理不确定性是决策过程中的一个核心挑战。鲁棒优化通过寻找在最坏情况下也表现良好的解来应对这一挑战，但这通常会导致复杂的“最大-最小”问题。这个进阶练习展示了锥对偶的一个强大应用：内部的“最坏情况”最小化问题被其对偶问题所取代，从而将整个问题转化为一个单一、可解的SOCP。本练习揭示了强对偶不仅是一个理论概念，更是一个简化和解决复杂鲁棒优化问题的实用工具。[@problem_id:3111113]", "problem": "考虑以下在锥规划背景下的鲁棒优化问题。设场景向量的不确定性集合为椭球体，由 $\\{\\bar{\\theta} + P z : \\|z\\|_{2} \\leq 1\\}$ 给出，其中 $\\bar{\\theta} \\in \\mathbb{R}^{2}$ 且 $P \\in \\mathbb{R}^{2 \\times 2}$。决策者选择 $x \\in \\mathbb{R}^{2}$，受限于信赖域约束 $\\|x\\|_{2} \\leq 1$。鲁棒目标是针对不确定性的最坏情况下的线性收益：\n$$\n\\max_{\\|x\\|_{2} \\leq 1} \\ \\min_{\\|z\\|_{2} \\leq 1} \\ x^{\\top}(\\bar{\\theta} + P z).\n$$\n给定 $\\bar{\\theta} = \\begin{pmatrix} 3 \\\\ 1 \\end{pmatrix}$ 和 $P = 2 I_{2}$，其中 $I_{2}$ 表示 $2 \\times 2$ 的单位矩阵。\n\n仅使用以下基本定义：\n- 二阶锥 (SOC)，定义为 $\\mathcal{Q}^{n+1} = \\{(t, w) \\in \\mathbb{R} \\times \\mathbb{R}^{n} : \\|w\\|_{2} \\leq t\\}$，\n- 标准形式下的锥原始-对偶问题对，其中原始问题写为 $\\min_{z} \\ c^{\\top}z$ 约束于 $A z + b \\in \\mathcal{K}$，其中 $\\mathcal{K}$ 是一个闭凸锥，其对偶问题为 $\\max_{y} \\ -b^{\\top} y$ 约束于 $A^{\\top} y + c = 0$, $y \\in \\mathcal{K}^{*}$，\n- Slater 条件（严格可行性），它对锥规划意味着强对偶性，\n\n执行以下任务：\n1. 对于固定的 $x$，将关于 $z$ 的内部最小化问题表述为基于二阶锥的锥规划问题，推导其锥对偶问题，并利用强对偶性将内部最小化问题的值表示为仅关于 $x$ 的函数。\n2. 通过强对偶性交换 $\\min$ 和 $\\max$，将原始的 max-min 鲁棒目标重写为包含 $x$ 和任何必要对偶变量的单层最大化问题。\n3. 在给定数据下，验证内部原始问题和对偶问题均满足 Slater 条件，从而证明使用强对偶性的合理性。\n4. 求解所得问题，确定目标函数的精确最优鲁棒值。将最终答案表示为单个精确实数或闭式解析表达式。不需要四舍五入。", "solution": "该问题是一个鲁棒优化问题，由下式给出\n$$\n\\max_{\\|x\\|_{2} \\leq 1} \\ \\min_{\\|z\\|_{2} \\leq 1} \\ x^{\\top}(\\bar{\\theta} + P z)\n$$\n参数为 $\\bar{\\theta} = \\begin{pmatrix} 3 \\\\ 1 \\end{pmatrix}$ 和 $P = 2 I_{2}$，其中 $I_{2}$ 是 $2 \\times 2$ 的单位矩阵。我们将按顺序完成这些任务。\n\n**1. 将内部最小化问题表述为锥规划**\n\n对于一个固定的决策向量 $x \\in \\mathbb{R}^{2}$，内部问题是\n$$\n\\min_{\\|z\\|_{2} \\leq 1} \\ x^{\\top}(\\bar{\\theta} + P z) = x^{\\top}\\bar{\\theta} + \\min_{\\|z\\|_{2} \\leq 1} x^{\\top} P z\n$$\n我们关注最小化部分：$\\min_{\\|z\\|_{2} \\leq 1} (P^{\\top}x)^{\\top}z$。这是一个关于变量 $z \\in \\mathbb{R}^2$ 的优化问题。约束 $\\|z\\|_{2} \\leq 1$ 可以使用二阶锥 (SOC) $\\mathcal{Q}^3 = \\{(t, w) \\in \\mathbb{R} \\times \\mathbb{R}^{2} : \\|w\\|_{2} \\leq t\\}$ 来表示，通过设置 $t=1$ 和 $w=z$，得到 $(1, z) \\in \\mathcal{Q}^3$。\n\n我们将其表述为指定原始形式的锥规划问题：$\\min_{\\tilde{z}} c^{\\top}\\tilde{z}$ 约束于 $A \\tilde{z} + b \\in \\mathcal{K}$。\n令优化变量为 $\\tilde{z} = z \\in \\mathbb{R}^2$。\n目标函数为 $(P^{\\top}x)^{\\top}z$，因此我们设置成本向量 $c = P^{\\top}x$。\n约束 $(1, z) \\in \\mathcal{Q}^3$ 必须写成 $A z + b \\in \\mathcal{Q}^3$ 的形式。我们可以如下定义 $A$ 和 $b$：\n$$\nA = \\begin{pmatrix} 0  0 \\\\ 1  0 \\\\ 0  1 \\end{pmatrix} \\in \\mathbb{R}^{3 \\times 2}, \\quad b = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} \\in \\mathbb{R}^3\n$$\n通过这些选择，$A z + b = \\begin{pmatrix} 0 \\\\ z_1 \\\\ z_2 \\end{pmatrix} + \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ z \\end{pmatrix}$。\n锥是 $\\mathcal{K} = \\mathcal{Q}^3$。原始锥规划问题是：\n$$\n\\text{（原始问题）} \\quad \\min_{z \\in \\mathbb{R}^2} \\ (P^{\\top}x)^{\\top}z \\quad \\text{s.t.} \\quad Az + b \\in \\mathcal{Q}^3\n$$\n对偶问题由 $\\max_{y} -b^{\\top} y$ 给出，约束于 $A^{\\top} y + c = 0$ 和 $y \\in \\mathcal{K}^{*}$。二阶锥是自对偶的，所以 $\\mathcal{K}^{*} = \\mathcal{Q}^3$。对偶变量是 $y = (y_0, y_w) \\in \\mathbb{R} \\times \\mathbb{R}^2$。\n对偶约束是：\n1. $y \\in \\mathcal{Q}^3 \\implies \\|y_w\\|_2 \\leq y_0$。\n2. $A^{\\top}y + c = 0$。我们来计算 $A^{\\top}y$：\n$$\nA^{\\top}y = \\begin{pmatrix} 0  1  0 \\\\ 0  0  1 \\end{pmatrix} \\begin{pmatrix} y_0 \\\\ y_{w1} \\\\ y_{w2} \\end{pmatrix} = \\begin{pmatrix} y_{w1} \\\\ y_{w2} \\end{pmatrix} = y_w\n$$\n所以约束变为 $y_w + P^{\\top}x = 0$，这意味着 $y_w = -P^{\\top}x$。\n\n对偶目标是 $-b^{\\top}y = -\\begin{pmatrix} 1  0  0 \\end{pmatrix} \\begin{pmatrix} y_0 \\\\ y_w \\end{pmatrix} = -y_0$。\n因此，对偶问题是：\n$$\n\\text{（对偶问题）} \\quad \\max_{y_0, y_w} \\ -y_0 \\quad \\text{s.t.} \\quad y_w = -P^{\\top}x, \\quad \\|y_w\\|_2 \\leq y_0\n$$\n为了最大化 $-y_0$，我们必须最小化 $y_0$。约束 $\\|y_w\\|_2 \\leq y_0$ 意味着 $y_0$ 的最小可能值是 $\\|y_w\\|_2$。代入 $y_w = -P^{\\top}x$，最优的 $y_0$ 是 $y_0^* = \\|-P^{\\top}x\\|_2 = \\|P^{\\top}x\\|_2$。\n对偶问题的最优值是 $-y_0^* = -\\|P^{\\top}x\\|_2$。\n\n假设强对偶性成立（我们将在任务3中证明），原始问题的最优值等于对偶问题的最优值。内部最小化问题的值是：\n$$\n\\min_{\\|z\\|_{2} \\leq 1} x^{\\top}(\\bar{\\theta} + P z) = x^{\\top}\\bar{\\theta} - \\|P^{\\top}x\\|_2\n$$\n\n**2. 重写 Max-Min 问题**\n\n使用任务1的强对偶性结果，我们可以将内部最小化问题替换为其对偶最大化问题。\n原始问题 $\\max_{\\|x\\|_{2} \\leq 1} \\left( \\min_{\\|z\\|_{2} \\leq 1} x^{\\top}(\\bar{\\theta} + P z) \\right)$ 变为：\n$$\n\\max_{\\|x\\|_{2} \\leq 1} \\left( x^{\\top}\\bar{\\theta} + \\max_{y_0, y_w: \\|y_w\\|_2 \\leq y_0, y_w = -P^{\\top}x} (-y_0) \\right)\n$$\n这可以被重写为一个关于变量 $x$、$y_0$ 和 $y_w$ 的单层最大化问题：\n$$\n\\begin{aligned}\n\\max_{x, y_0, y_w} \\quad  x^{\\top}\\bar{\\theta} - y_0 \\\\\n\\text{s.t.} \\quad  \\|x\\|_{2} \\leq 1 \\\\\n \\|y_w\\|_{2} \\leq y_0 \\\\\n P^{\\top}x + y_w = 0\n\\end{aligned}\n$$\n这是一个单层优化问题，同时也是一个二阶锥规划 (SOCP)。\n\n**3. Slater 条件的验证**\n\n锥规划的 Slater 条件保证了强对偶性。我们需要为内部原始问题和对偶问题都检查该条件。\n\n对于原始问题：$\\min_{z} (P^{\\top}x)^{\\top}z$ 约束于 $Az + b \\in \\mathcal{Q}^3$。\nSlater 条件要求存在一个可行点 $z_0$，使得 $Az_0+b$ 位于锥 $\\mathcal{K}=\\mathcal{Q}^3$ 的内部。$\\mathcal{Q}^3$ 的内部是 $\\text{int}(\\mathcal{Q}^3) = \\{(t,w) \\in \\mathbb{R} \\times \\mathbb{R}^2 : \\|w\\|_2  t\\}$。\n我们需要找到 $z_0 \\in \\mathbb{R}^2$ 使得 $(1, z_0) \\in \\text{int}(\\mathcal{Q}^3)$，这意味着 $\\|z_0\\|_2  1$。我们可以简单地选择 $z_0 = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$。那么 $\\|z_0\\|_2 = 0  1$。因此，存在一个严格可行点，对于任何固定的 $x$，原始问题都满足 Slater 条件。\n\n对于对偶问题：$\\max_{y} -b^{\\top}y$ 约束于 $A^{\\top}y+c=0, y \\in \\mathcal{Q}^3$。\nSlater 条件要求存在一个位于锥内部的可行点 $y^*$，即 $y^* \\in \\text{int}(\\mathcal{Q}^3)$ 并且满足等式约束 $A^{\\top}y^*+c=0$。\n我们需要找到 $y^*=(y_0^*, y_w^*) \\in \\mathbb{R} \\times \\mathbb{R}^2$ 使得 $\\|y_w^*\\|_2  y_0^*$ 并且 $y_w^* + P^{\\top}x = 0$。\n我们选择 $y_w^* = -P^{\\top}x$。为了满足严格不等式，我们需要找到一个 $y_0^*$ 使得 $\\| -P^{\\top}x \\|_2  y_0^*$，即 $\\|P^{\\top}x\\|_2  y_0^*$。\n我们总能找到这样的 $y_0^*$，例如，通过选择 $y_0^* = \\|P^{\\top}x\\|_2 + 1$。\n点 $y^* = (\\|P^{\\top}x\\|_2 + 1, -P^{\\top}x)$ 对于对偶问题是严格可行的。因此，对偶问题也满足 Slater 条件。\n\n由于原始问题和对偶问题都满足 Slater 条件，强对偶性是合理的。\n\n**4. 求解所得问题**\n\n根据任务1和2，问题简化为求解：\n$$\nV = \\max_{\\|x\\|_{2} \\leq 1} \\left( x^{\\top}\\bar{\\theta} - \\|P^{\\top}x\\|_2 \\right)\n$$\n给定 $\\bar{\\theta} = \\begin{pmatrix} 3 \\\\ 1 \\end{pmatrix}$ 和 $P = 2 I_{2}$。因此，$P^{\\top} = (2 I_{2})^{\\top} = 2 I_{2}$。\n这得到 $\\|P^{\\top}x\\|_2 = \\|2 I_{2} x\\|_2 = \\|2x\\|_2 = 2\\|x\\|_2$。\n目标函数变为 $f(x) = x^{\\top}\\bar{\\theta} - 2\\|x\\|_2$。优化问题是：\n$$\nV = \\max_{\\|x\\|_{2} \\leq 1} f(x) = \\max_{\\|x\\|_{2} \\leq 1} \\left( 3x_1 + x_2 - 2\\sqrt{x_1^2 + x_2^2} \\right)\n$$\n定义域是 $\\mathbb{R}^2$ 中的闭单位圆盘，这是一个紧集。函数 $f(x)$ 在此定义域上是连续的，因此最大值存在。我们在圆盘的内部和边界上检查最大值。\n\n函数在 $x=0$ 处不可微。在该点，$f(0) = 0$。\n\n对于圆盘内部（$0  \\|x\\|_2  1$），我们通过将 $f(x)$ 的梯度设为零来寻找临界点。\n$$\n\\nabla f(x) = \\bar{\\theta} - 2 \\frac{x}{\\|x\\|_2}\n$$\n令 $\\nabla f(x) = 0$ 得到 $x = \\frac{\\|x\\|_2}{2}\\bar{\\theta}$。对两边取欧几里得范数：\n$$\n\\|x\\|_2 = \\left\\| \\frac{\\|x\\|_2}{2}\\bar{\\theta} \\right\\| = \\frac{\\|x\\|_2}{2}\\|\\bar{\\theta}\\|_2\n$$\n因为我们在内部，$\\|x\\|_2 > 0$，所以我们可以除以它得到 $1 = \\frac{1}{2}\\|\\bar{\\theta}\\|_2$，这意味着 $\\|\\bar{\\theta}\\|_2 = 2$。\n我们来计算 $\\|\\bar{\\theta}\\|_2$：\n$$\n\\|\\bar{\\theta}\\|_2 = \\sqrt{3^2 + 1^2} = \\sqrt{9+1} = \\sqrt{10}\n$$\n由于 $\\|\\bar{\\theta}\\|_2 = \\sqrt{10} \\neq 2$，圆盘内部没有临界点。\n\n因此，最大值必须位于边界上，即 $\\|x\\|_2 = 1$。边界上的问题是：\n$$\n\\max_{\\|x\\|_{2} = 1} \\left( x^{\\top}\\bar{\\theta} - 2(1) \\right) = \\left( \\max_{\\|x\\|_{2} = 1} x^{\\top}\\bar{\\theta} \\right) - 2\n$$\n根据柯西-施瓦茨不等式，$x^{\\top}\\bar{\\theta} \\leq \\|x\\|_2 \\|\\bar{\\theta}\\|_2$。当 $\\|x\\|_2=1$ 时，$x^{\\top}\\bar{\\theta}$ 的最大值是 $\\|\\bar{\\theta}\\|_2$，当 $x$ 与 $\\bar{\\theta}$ 方向一致时取得，即 $x = \\frac{\\bar{\\theta}}{\\|\\bar{\\theta}\\|_2}$。\n在边界上 $f(x)$ 的最大值是 $\\|\\bar{\\theta}\\|_2 - 2 = \\sqrt{10} - 2$。\n\n比较这些值，我们有 $f(0) = 0$ 和边界上的最大值 $\\sqrt{10}-2$。由于 $\\sqrt{10} > \\sqrt{4} = 2$，值 $\\sqrt{10}-2$ 是正的。\n因此，全局最大值是 $V = \\sqrt{10}-2$。\n这就是目标函数的最优鲁棒值。", "answer": "$$\\boxed{\\sqrt{10}-2}$$", "id": "3111113"}]}