{"hands_on_practices": [{"introduction": "许多工程和科学问题涉及像绝对值这样的不可微函数，这些函数难以用标准方法处理。本练习展示了互补建模的威力，它能将这类问题转化为结构化的线性互补问题（LCP）。通过完成这一转换，您将掌握一项核心的优化建模技能，并了解如何利用所得 LCP 的性质来分析原始问题的可解性 [@problem_id:3109507]。", "problem": "考虑$\\mathbb{R}^n$中的绝对值方程（AVE）$A x + |B x| = c$，其中 $A \\in \\mathbb{R}^{n \\times n}$ 是非奇异矩阵，$B \\in \\mathbb{R}^{n \\times n}$，$c \\in \\mathbb{R}^n$。线性互补问题（LCP）定义如下：给定 $M \\in \\mathbb{R}^{m \\times m}$ 和 $q \\in \\mathbb{R}^m$，找到 $w, z \\in \\mathbb{R}^m$ 使得 $w = M z + q$，$w \\ge 0$，$z \\ge 0$，$w^\\top z = 0$，其中不等式是逐分量解释的。从这些定义出发，在不使用任何预先推导的变换公式的情况下，完成以下任务：\n\n1) 仅使用基本操作和定义，引入用于表示 $|B x|$ 的辅助非负变量，并证明该AVE可以被重构为一个仅含一个非负变量向量的LCP。用 $A$、$B$ 和 $c$ 明确表示LCP的数据 $(M, q)$，并清楚说明为证明此重构的合理性而对 $A$ 和 $B$ 使用的所有条件。\n\n2) 将你的重构方法应用于以下具体实例：\n$$\nA = \\begin{pmatrix} 3  1 \\\\ 0  2 \\end{pmatrix},\\quad\nB = \\begin{pmatrix} 1  0 \\\\ 1  1 \\end{pmatrix},\\quad\nc = \\begin{pmatrix} 2 \\\\ 3 \\end{pmatrix}.\n$$\n计算相应的 $(M, q)$，精确求解所得的LCP，恢复AVE的唯一解 $x$，最后以精确形式报告标量 $s = x_1 + 2 x_2$。\n\n3) 根据你所构造的 $M$ 及相关矩阵的性质，简要解释该AVE何时有唯一解，以及如何使用LCP算法来计算它。至少说出一种算法的名称，并解释AVE到LCP的重构如何使其能够被应用。\n\n你最终报告的量必须是第2部分得到的单个标量 $s = x_1 + 2 x_2$ 的精确形式（无舍入）。", "solution": "该问题陈述在形式上是合理的、自洽的，并且基于优化理论和线性代数的既定原则。它提出了一个适定的数学任务。我们将着手解决。\n\n问题分为三个部分。我们将按顺序处理。\n\n第一部分：将绝对值方程（AVE）重构为线性互补问题（LCP）。\n\n给定绝对值方程（AVE）：\n$$A x + |B x| = c$$\n其中 $A, B \\in \\mathbb{R}^{n \\times n}$，$c \\in \\mathbb{R}^n$，$x \\in \\mathbb{R}^n$。假设 $A$ 是非奇异的。向量的绝对值是逐分量计算的。\n\n同时给定线性互补问题（LCP）的定义：找到 $w, z \\in \\mathbb{R}^m$ 使得\n$$w = M z + q, \\quad w \\ge 0, \\quad z \\ge 0, \\quad w^\\top z = 0$$\n对于给定的 $M \\in \\mathbb{R}^{m \\times m}$ 和 $q \\in \\mathbb{R}^m$。\n\n要将AVE重构为LCP，我们必须处理非线性项 $|Bx|$。令 $y = Bx$。我们需要使用适合LCP的变量来表示 $|y|$。对于任意标量 $y_i$，其绝对值 $|y_i|$ 可以通过一个互补关系来定义。考虑恒等式 $|y_i| = y_i + 2\\max(0, -y_i)$。令 $z_i = \\max(0, -y_i)$。根据定义，$z_i \\ge 0$。\n如果 $y_i \\ge 0$，则 $z_i = 0$，恒等式给出 $|y_i| = y_i$。\n如果 $y_i  0$，则 $z_i = -y_i > 0$，恒等式给出 $|y_i| = y_i + 2(-y_i) = -y_i$。\n这是正确的。\n条件 $z_i = \\max(0, -y_i)$ 可以用互补性来表示。令 $w_i = y_i + z_i$。\n如果 $y_i \\ge 0$，则 $z_i=0$，所以 $w_i = y_i \\ge 0$ 且 $w_i z_i = y_i \\cdot 0 = 0$。\n如果 $y_i  0$，则 $z_i=-y_i$，所以 $w_i = y_i + (-y_i) = 0$ 且 $w_i z_i = 0 \\cdot (-y_i) = 0$。\n在两种情况下，我们都有 $z_i \\ge 0$，$w_i \\ge 0$，以及 $w_i z_i = 0$。\n因此，对于一个向量 $y$，我们可以写作 $|y| = y + 2z$，并满足条件 $z \\ge 0$，$w = y+z \\ge 0$，以及 $w^\\top z = 0$。\n\n我们将此应用于AVE。令 $y = Bx$。AVE变为：\n$$A x + (Bx + 2z) = c$$\n其中 $z \\in \\mathbb{R}^n$ 是一个辅助变量向量，与 $w = Bx+z$ 一起满足LCP条件。\n合并含 $x$ 的项，我们得到：\n$$(A+B)x + 2z = c$$\n为了求解 $x$，我们必须假设矩阵 $(A+B)$ 是非奇异的。这是此重构的一个关键条件。在此假设下，我们有：\n$$x = (A+B)^{-1}(c - 2z)$$\n现在，我们必须用 $z$ 来表示松弛变量 $w$，以获得LCP形式。\n$$w = Bx + z$$\n代入 $x$ 的表达式：\n$$w = B\\left((A+B)^{-1}(c - 2z)\\right) + z$$\n$$w = B(A+B)^{-1}c - 2B(A+B)^{-1}z + I z$$\n$$w = \\left(I - 2B(A+B)^{-1}\\right)z + B(A+B)^{-1}c$$\n这正是LCP的形式 $w = Mz+q$，其中变量向量是 $z \\in \\mathbb{R}^n$，LCP数据 $(M, q)$ 由以下公式给出：\n$$M = I - 2B(A+B)^{-1} \\in \\mathbb{R}^{n \\times n}$$\n$$q = B(A+B)^{-1}c \\in \\mathbb{R}^{n}$$\nLCP问题是找到满足 $w = Mz+q$，$z \\ge 0$，$w \\ge 0$ 和 $w^\\top z = 0$ 的 $z \\in \\mathbb{R}^n$。一旦找到这样的 $z$，原始AVE的解 $x$ 就可以通过 $x = (A+B)^{-1}(c - 2z)$ 来恢复。\n用于证明此重构合理性的关键条件是矩阵 $(A+B)$ 必须是非奇异的。\n\n第二部分：应用于一个具体实例。\n\n我们给定的数据为：\n$$A = \\begin{pmatrix} 3  1 \\\\ 0  2 \\end{pmatrix}, \\quad B = \\begin{pmatrix} 1  0 \\\\ 1  1 \\end{pmatrix}, \\quad c = \\begin{pmatrix} 2 \\\\ 3 \\end{pmatrix}$$\n首先，我们检查重构的条件。我们计算 $A+B$：\n$$A+B = \\begin{pmatrix} 3  1 \\\\ 0  2 \\end{pmatrix} + \\begin{pmatrix} 1  0 \\\\ 1  1 \\end{pmatrix} = \\begin{pmatrix} 4  1 \\\\ 1  3 \\end{pmatrix}$$\n行列式为 $\\det(A+B) = 4 \\cdot 3 - 1 \\cdot 1 = 11$，非零。因此，$(A+B)$ 是非奇异的，该重构是有效的。\n接下来，我们计算 $(A+B)$ 的逆矩阵：\n$$(A+B)^{-1} = \\frac{1}{11}\\begin{pmatrix} 3  -1 \\\\ -1  4 \\end{pmatrix}$$\n现在我们计算LCP矩阵 $M$ 和向量 $q$：\n$$q = B(A+B)^{-1}c = \\begin{pmatrix} 1  0 \\\\ 1  1 \\end{pmatrix} \\frac{1}{11}\\begin{pmatrix} 3  -1 \\\\ -1  4 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ 3 \\end{pmatrix}$$\n$$q = \\frac{1}{11} \\begin{pmatrix} 1  0 \\\\ 1  1 \\end{pmatrix} \\begin{pmatrix} 3(2) - 1(3) \\\\ -1(2) + 4(3) \\end{pmatrix} = \\frac{1}{11} \\begin{pmatrix} 1  0 \\\\ 1  1 \\end{pmatrix} \\begin{pmatrix} 3 \\\\ 10 \\end{pmatrix} = \\frac{1}{11}\\begin{pmatrix} 3 \\\\ 13 \\end{pmatrix}$$\n\n$$M = I - 2B(A+B)^{-1} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} - 2 \\begin{pmatrix} 1  0 \\\\ 1  1 \\end{pmatrix} \\frac{1}{11}\\begin{pmatrix} 3  -1 \\\\ -1  4 \\end{pmatrix}$$\n$$M = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} - \\frac{2}{11} \\begin{pmatrix} 1(3)+0(-1)  1(-1)+0(4) \\\\ 1(3)+1(-1)  1(-1)+1(4) \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} - \\frac{2}{11} \\begin{pmatrix} 3  -1 \\\\ 2  3 \\end{pmatrix}$$\n$$M = \\begin{pmatrix} 1 - 6/11  2/11 \\\\ -4/11  1 - 6/11 \\end{pmatrix} = \\frac{1}{11}\\begin{pmatrix} 5  2 \\\\ -4  5 \\end{pmatrix}$$\nLCP问题是找到 $z=\\begin{pmatrix} z_1 \\\\ z_2 \\end{pmatrix} \\ge 0$ 使得 $w = Mz+q \\ge 0$ 且 $w^\\top z = 0$。我们通过考虑四种可能的基变量组合来求解此问题：\n1.  $z_1=0, z_2=0$：这意味着 $w = q = \\frac{1}{11}\\begin{pmatrix} 3 \\\\ 13 \\end{pmatrix}$。由于 $w_1 = 3/11 \\ge 0$ 且 $w_2 = 13/11 \\ge 0$，这是一个LCP的有效解。所以，$z = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$ 是一个解。\n2.  $w_1=0, z_2=0$：$w=Mz+q$ 的第一个方程变为 $0 = \\frac{1}{11}(5z_1 + 3)$，这给出 $z_1 = -3/5$。这违反了 $z_1 \\ge 0$。因此在这种情况下无解。\n3.  $z_1=0, w_2=0$：第二个方程变为 $0 = \\frac{1}{11}(5z_2 + 13)$，这给出 $z_2 = -13/5$。这违反了 $z_2 \\ge 0$。因此在这种情况下无解。\n4.  $w_1=0, w_2=0$：这需要解 $Mz = -q$。$\\frac{1}{11}\\begin{pmatrix} 5  2 \\\\ -4  5 \\end{pmatrix}z = -\\frac{1}{11}\\begin{pmatrix} 3 \\\\ 13 \\end{pmatrix}$。该系统为 $\\begin{cases} 5z_1 + 2z_2 = -3 \\\\ -4z_1 + 5z_2 = -13 \\end{cases}$。解此系统得到 $z_1 = 1/3$ 和 $z_2 = -7/3$。这违反了 $z_2 \\ge 0$。因此在这种情况下无解。\n\nLCP的唯一解是 $z = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$。\n现在我们恢复AVE的唯一解 $x$：\n$$x = (A+B)^{-1}(c - 2z) = (A+B)^{-1}c$$\n我们在计算 $q$ 的过程中已经计算过这个向量：\n$$x = \\frac{1}{11}\\begin{pmatrix} 3 \\\\ 10 \\end{pmatrix}$$\n所以，$x_1 = 3/11$ 和 $x_2 = 10/11$。\n最后，我们计算标量 $s$：\n$$s = x_1 + 2x_2 = \\frac{3}{11} + 2\\left(\\frac{10}{11}\\right) = \\frac{3+20}{11} = \\frac{23}{11}$$\n\n第三部分：解的唯一性及算法考量。\n\n该重构在AVE的解与LCP $(M, q)$ 的解之间建立了一一对应关系，前提是 $(A+B)$ 是非奇异的。因此，AVE有唯一解当且仅当LCP有唯一解。\n\n对于任意向量 $q$，LCP $(M, q)$ 有唯一解的一个充分条件是矩阵 $M$ 是一个P-矩阵。一个矩阵是P-矩阵，如果它的所有主子式都为正。对于我们在第二部分中的具体情况，矩阵 $M = \\frac{1}{11}\\begin{pmatrix} 5  2 \\\\ -4  5 \\end{pmatrix}$ 的主子式为：\n- 1阶：$M_{11} = 5/11 > 0$ 和 $M_{22} = 5/11 > 0$。\n- 2阶：$\\det(M) = (\\frac{1}{11})^2(5 \\cdot 5 - 2(-4)) = \\frac{33}{121} = \\frac{3}{11} > 0$。\n由于所有主子式均为正，$M$ 是一个P-矩阵，这保证了LCP有唯一解，因此对于这个具体实例的AVE也有唯一解。一般而言，如果从AVE数据构造的矩阵 $M=I-2B(A+B)^{-1}$ 是一个P-矩阵，那么该AVE有唯一解。\n\nAVE到LCP的重构对于计算目的是至关重要的。原始问题 $Ax+|Bx|=c$ 涉及一个非线性且不可微的函数（绝对值），这使得用标准的用于线性或平滑系统的数值方法难以求解。LCP虽然也是一个专门的问题，但它拥有已被广泛研究的丰富数学结构。这种结构允许开发专门的、有限步的算法。\n\n解决LCP的最著名算法之一是Lemke算法，也称为互补枢轴算法。该算法作用于线性系统 $w=Mz+q$，并系统地在一系列基之间进行枢轴变换（类似于线性规划的单纯形法），以寻求满足互补条件 $w^\\top z=0$。该重构为Lemke算法提供了必要的输入 $(M,q)$。当矩阵 $M$ 是一个P-矩阵时，Lemke算法保证能在有限步内找到LCP的唯一解。因此，该重构使得应用强大且经过验证的算法来解决一类非线性方程成为可能。", "answer": "$$\\boxed{\\frac{23}{11}}$$", "id": "3109507"}, {"introduction": "现实世界中的优化问题常常包含混合条件：一些变量必须是非负的，而另一些则不受限制。这些被称为混合互补问题（MCPs）。本练习将教您一种标准技术，通过将自由变量拆分为其正部和负部，从而将 MCP 转换为标准的 NCP。这项练习不仅能扩展您的建模工具箱，还会引入分析问题雅可比矩阵稀疏性这一重要的实践概念，这是影响大规模求解器效率的关键因素 [@problem_id:3109533]。", "problem": "考虑混合互补问题 (Mixed Complementarity Problem, MCP)：寻找一个向量 $x \\in \\mathbb{R}^{n}$，对于给定的仿射映射 $F(x) = M x + q$，该向量满足以下按索引区分的条件：\n- 对于索引 $i \\in I_{+}$：$0 \\le x_{i} \\perp F_{i}(x) \\ge 0$，\n- 对于索引 $j \\in S$：$x_{j}$ 的符号不受限制，且 $F_{j}(x) = 0$，\n其中 $S = \\{1,2,\\dots,m\\}$ 表示 $m$ 个混合符号（自由）变量的集合，$I_{+} = \\{m+1,m+2,\\dots,n\\}$ 表示非负变量的集合，且 $1 \\le m \\le n-1$。\n\n假设 $F$ 由一个严格三对角矩阵定义\n$$\nM = \\begin{bmatrix}\n\\alpha  \\beta  0  \\cdots  0 \\\\\n\\beta  \\alpha  \\beta  \\ddots  \\vdots \\\\\n0  \\beta  \\alpha  \\ddots  0 \\\\\n\\vdots  \\ddots  \\ddots  \\ddots  \\beta \\\\\n0  \\cdots  0  \\beta  \\alpha\n\\end{bmatrix} \\in \\mathbb{R}^{n \\times n},\n$$\n其中 $\\alpha \\neq 0$ 且 $\\beta \\neq 0$，而 $q \\in \\mathbb{R}^{n}$ 是任意的。\n\n任务：\n1) 通过对混合符号分量 $x_{j}$ 进行拆分 $x_{j} = x_{j}^{+} - x_{j}^{-}$（其中对于所有 $j \\in S$，都有 $x_{j}^{+} \\ge 0$ 和 $x_{j}^{-} \\ge 0$）来构建一个标准的非线性互补问题 (Nonlinear Complementarity Problem, NCP)。写出最终的互补条件，其形式为 $0 \\le z \\perp G(z) \\ge 0$，且该形式只使用非负变量和非负函数值。\n\n2) 令 $W$ 表示变换后的 NCP 映射 $G(z)$ 关于新变量 $z$ 的雅可比矩阵。仅考虑非零模式来处理稀疏性（即，将 $\\alpha$ 和 $\\beta$ 视作非零常数，它们占据的所有位置都计为非零元），从第一性原理出发，论证为何 $W$ 的稀疏模式与 $z$ 无关，然后计算 $W$ 的非零元总数的精确值，作为 $n$ 和 $m$ 的函数，假设 $1 \\le m \\le n-1$ 且 $n \\ge 3$。\n\n以 $n$ 和 $m$ 的单个封闭形式表达式给出最终答案。无需四舍五入。", "solution": "给定的问题是一个混合互补问题 (MCP)，其定义为：对于一个给定的仿射映射 $F(x) = M x + q$，寻找一个向量 $x \\in \\mathbb{R}^{n}$，使其满足一组基于索引划分的条件。我们的任务是首先将这个 MCP 重构为一个标准的非线性互补问题 (NCP)，然后分析所得 NCP 映射的雅可比矩阵的稀疏性。\n\n### 任务 1：NCP 公式化\n\n原始的 MCP 问题在于寻找一个 $x \\in \\mathbb{R}^{n}$ 使得：\n1. 对于索引 $j \\in S = \\{1, 2, \\dots, m\\}$：$x_{j}$ 的符号不受限制（一个自由变量）且 $F_{j}(x) = 0$。\n2. 对于索引 $i \\in I_{+} = \\{m+1, m+2, \\dots, n\\}$：$0 \\le x_{i} \\perp F_{i}(x) \\ge 0$。\n\n为了构建一个只涉及非负约束的 NCP，我们必须处理 $j \\in S$ 的自由变量 $x_j$。方法是，将每个自由变量拆分为两个非负变量的差：\n$$x_{j} = x_{j}^{+} - x_{j}^{-},\\quad \\text{其中 } x_{j}^{+} \\ge 0 \\text{ 且 } x_{j}^{-} \\ge 0 \\text{ 对于 } j \\in S。$$\n对于 $i \\in I_+$ 的变量 $x_i$ 已经是非负的，不需要拆分。\n\n我们定义一个新的维度为 $(n+m)$ 的变量向量 $z$，它由这些新的非负部分和原始的非负变量组成。我们将 $z$ 分块为 $z = (z_S^+, z_S^-, z_{I_+})^T$，其中：\n- $z_S^+ = (x_1^+, \\dots, x_m^+)^T \\in \\mathbb{R}^m$\n- $z_S^- = (x_1^-, \\dots, x_m^-)^T \\in \\mathbb{R}^m$\n- $z_{I_+} = (x_{m+1}, \\dots, x_n)^T \\in \\mathbb{R}^{n-m}$\n\n根据构造，$z$ 的所有分量都是非负的，即 $z \\ge 0$。原始向量 $x$ 可以表示为 $z$ 的线性变换。我们将 $x$ 分块为 $x_S = (x_1, \\dots, x_m)^T$ 和 $x_{I_+} = (x_{m+1}, \\dots, x_n)^T$。那么：\n$$x_S = z_S^+ - z_S^-$$\n$$x_{I_+} = z_{I_+}$$\n\n现在，我们将 MCP 条件转换为涉及 $z$ 的 NCP 条件。\n自由变量 $x_j$ 的条件是 $F_j(x)=0$。这一个等式等价于两个不等式 $F_j(x) \\ge 0$ 和 $-F_j(x) \\ge 0$。标准的重构方法将这两个不等式与新的非负变量 $x_j^+$ 和 $x_j^-$ 配对：\n$$0 \\le x_{j}^{+} \\perp F_{j}(x) \\ge 0$$\n$$0 \\le x_{j}^{-} \\perp -F_{j}(x) \\ge 0$$\n这些条件共同意味着 $F_j(x)=0$，因为我们必须同时有 $F_j(x) \\ge 0$ 和 $-F_j(x) \\ge 0$。\n\n对于 $i \\in I_+$ 的非负变量 $x_i$ 的条件形式保持不变：\n$$0 \\le x_i \\perp F_i(x) \\ge 0$$\n\n我们为 NCP 定义新的映射 $G(z)$。我们将 $G(z)$ 与 $z$ 进行共形分块：$G(z) = (G_{S+}(z), G_{S-}(z), G_{I+}(z))^T$。令 $F_S(x) = (F_1(x), \\dots, F_m(x))^T$ 和 $F_{I_+}(x) = (F_{m+1}(x), \\dots, F_n(x))^T$。新映射定义如下：\n- $G_{S+}(z) = F_S(x(z))$\n- $G_{S-}(z) = -F_S(x(z))$\n- $G_{I+}(z) = F_{I_+}(x(z))$\n\n由此产生的问题是一个标准的（在此情况下是仿射的）互补问题：寻找 $z \\in \\mathbb{R}^{n+m}$ 使得\n$$0 \\le z \\perp G(z) \\ge 0。$$\n这等价于条件 $z \\ge 0$，$G(z) \\ge 0$ 和 $z^T G(z) = 0$。\n\n### 任务 2：雅可比矩阵稀疏性分析\n\n首先，我们论证为何雅可比矩阵 $W = \\nabla G(z)$ 的稀疏模式与 $z$ 无关。\n原始映射是仿射的：$F(x) = Mx + q$。\n向量 $x$ 是 $z$ 的线性函数，可以写成 $x = Pz$，其中 $P$ 是一个适当的 $n \\times (n+m)$ 矩阵。\n因此，在 $x(z)$ 处求值的映射 $F$ 是 $z$ 的一个仿射函数：\n$$F(x(z)) = M(Pz) + q = (MP)z + q。$$\n新映射 $G(z)$ 是通过选择、取反和堆叠 $F(x(z))$ 的分量来构造的。这是对 $F(x(z))$ 的一个线性操作。仿射函数的线性变换仍然是仿射函数。因此，我们可以将 $G(z)$ 写成 $G(z) = Wz + r$ 的形式，其中 $W \\in \\mathbb{R}^{(n+m) \\times (n+m)}$ 是一个常数矩阵，$r \\in \\mathbb{R}^{n+m}$ 是一个常数向量。\n$G(z)$ 关于 $z$ 的雅可比矩阵是 $\\nabla G(z) = W$。由于 $W$ 是一个常数矩阵，其结构，包括其稀疏模式（非零元的位置），是固定的且与变量 $z$ 无关。\n\n接下来，我们计算 $W$ 的非零元总数。我们首先确定 $W$ 的分块结构。将 $M$ 分块为\n$$ M = \\begin{pmatrix} M_{SS}  M_{SI_+} \\\\ M_{I_+S}  M_{I_+I_+} \\end{pmatrix}, $$\n其中 $M_{SS} \\in \\mathbb{R}^{m \\times m}$，$M_{SI_+} \\in \\mathbb{R}^{m \\times (n-m)}$，$M_{I_+S} \\in \\mathbb{R}^{(n-m) \\times m}$ 以及 $M_{I_+I_+} \\in \\mathbb{R}^{(n-m) \\times (n-m)}$。\n\n雅可比矩阵 $W$ 通过计算 $G(z)$ 关于 $z = (z_S^+, z_S^-, z_{I_+})^T$ 各分量的偏导数得到。 $W$ 的分块结构是：\n$$ W = \\begin{pmatrix}\n\\frac{\\partial G_{S+}}{\\partial z_S^+}  \\frac{\\partial G_{S+}}{\\partial z_S^-}  \\frac{\\partial G_{S+}}{\\partial z_{I_+}} \\\\\n\\frac{\\partial G_{S-}}{\\partial z_S^+}  \\frac{\\partial G_{S-}}{\\partial z_S^-}  \\frac{\\partial G_{S-}}{\\partial z_{I_+}} \\\\\n\\frac{\\partial G_{I_+}}{\\partial z_S^+}  \\frac{\\partial G_{I_+}}{\\partial z_S^-}  \\frac{\\partial G_{I_+}}{\\partial z_{I_+}}\n\\end{pmatrix} $$\n利用 $G$、$F$ 的定义以及 $x$ 和 $z$ 之间的关系，我们求出各个子块：\n$G_{S+}(z) = M_{SS}(z_S^+ - z_S^-) + M_{SI_+}z_{I_+} + q_S \\implies \\frac{\\partial G_{S+}}{\\partial z_S^+} = M_{SS}, \\frac{\\partial G_{S+}}{\\partial z_S^-} = -M_{SS}, \\frac{\\partial G_{S+}}{\\partial z_{I_+}} = M_{SI_+}$\n$G_{S-}(z) = -G_{S+}(z) \\implies \\frac{\\partial G_{S-}}{\\partial z_S^+} = -M_{SS}, \\frac{\\partial G_{S-}}{\\partial z_S^-} = M_{SS}, \\frac{\\partial G_{S-}}{\\partial z_{I_+}} = -M_{SI_+}$\n$G_{I_+}(z) = M_{I_+S}(z_S^+ - z_S^-) + M_{I_+I_+}z_{I_+} + q_{I_+} \\implies \\frac{\\partial G_{I_+}}{\\partial z_S^+} = M_{I_+S}, \\frac{\\partial G_{I_+}}{\\partial z_S^-} = -M_{I_+S}, \\frac{\\partial G_{I_+}}{\\partial z_{I_+}} = M_{I_+I_+}$\n因此，雅可比矩阵为：\n$$ W = \\begin{pmatrix} M_{SS}  -M_{SS}  M_{SI_+} \\\\ -M_{SS}  M_{SS}  -M_{SI_+} \\\\ M_{I_+S}  -M_{I_+S}  M_{I_+I_+} \\end{pmatrix} $$\n非零元的数量 $NNZ(W)$ 是其各分块中非零元数量的总和。由于 $NNZ(A) = NNZ(-A)$，\n$$ NNZ(W) = 4 \\cdot NNZ(M_{SS}) + 2 \\cdot NNZ(M_{SI_+}) + 2 \\cdot NNZ(M_{I_+S}) + NNZ(M_{I_+I_+})。 $$\n现在我们求出给定的严格三对角矩阵 $M$ 的每个分块的非零元数量 (NNZ)。\n1. $M_{SS}$ 是 $M$ 的 $m \\times m$ 主子矩阵。它是一个三对角矩阵，有 $m$ 个对角元和 $2(m-1)$ 个非对角元（对于 $m>1$）。对于 $m=1$，它有 $1$ 个元素。通常情况下，$NNZ(M_{SS}) = m + 2(m-1) = 3m-2$。\n2. $M_{I_+I_+}$ 是 $M$ 对应于索引 $I_+$ 的 $(n-m) \\times (n-m)$ 主子矩阵。它也是三对角的。$NNZ(M_{I_+I_+}) = 3(n-m)-2 = 3n-3m-2$。\n3. $M_{SI_+}$ 是非对角的 $m \\times (n-m)$ 分块。由于 $M$ 是三对角的，唯一的非零元只能出现在 $|i-j|=1$ 的位置。这里，$i \\in \\{1, \\dots, m\\}$ 且 $j \\in \\{m+1, \\dots, n\\}$。唯一满足条件的对是 $(i,j)=(m, m+1)$。因此，$M_{m,m+1}=\\beta$ 是唯一的非零元。$NNZ(M_{SI_+}) = 1$。\n4. $M_{I_+S}$ 是非对角的 $(n-m) \\times m$ 分块。类似地，唯一的非零元是 $M_{m+1,m}=\\beta$。$NNZ(M_{I_+S}) = 1$。\n\n将这些计数代入 $NNZ(W)$ 的公式中：\n$$ NNZ(W) = 4(3m-2) + 2(1) + 2(1) + (3n-3m-2) $$\n$$ NNZ(W) = 12m - 8 + 2 + 2 + 3n - 3m - 2 $$\n$$ NNZ(W) = (12m - 3m) + 3n + (-8 + 4 - 2) $$\n$$ NNZ(W) = 9m + 3n - 6 $$\n这个封闭形式表达式给出了雅可比矩阵 $W$ 中非零元的精确总数。", "answer": "$$\\boxed{9m+3n-6}$$", "id": "3109533"}, {"introduction": "一旦一个问题被表述为 LCP，我们该如何求解它？如果没有解存在，又会发生什么？本练习让您亲身体验经典的 LCP 求解方法——Lemke 算法，重点关注其如何检测问题的不可行性。通过分析算法在“次射线”上终止的情况，您将更深入地理解 LCP 可行集几何性质与枢轴算法运行机制之间的联系 [@problem_id:3109485]。", "problem": "给定一个由矩阵 $M \\in \\mathbb{R}^{2 \\times 2}$ 和向量 $q \\in \\mathbb{R}^{2}$ 定义的线性互补问题 (LCP) 的小实例，以及用于 Lemke 算法的一个严格正覆盖向量 $d \\in \\mathbb{R}^{2}_{++}$ 和一个人工变量 $z_{0}$。考虑\n$$\nM \\;=\\; \\begin{pmatrix} 0  -1 \\\\ 1  0 \\end{pmatrix}, \n\\quad\nq \\;=\\; \\begin{pmatrix} -1 \\\\ 0 \\end{pmatrix},\n\\quad\nd \\;=\\; \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}.\n$$\nLCP 旨在寻找 $z \\in \\mathbb{R}^{2}$ 和 $w \\in \\mathbb{R}^{2}$ 使得\n$$\nz \\;\\ge\\; 0,\\quad w \\;=\\; q + M z \\;\\ge\\; 0, \\quad \\text{and} \\quad z^{\\top} w \\;=\\; 0.\n$$\nLemke 算法应用于增广系统\n$$\nw \\;=\\; q + M z + z_{0} d, \n\\quad z \\;\\ge\\; 0, \\quad w \\;\\ge\\; 0, \\quad z_{0} \\;\\ge\\; 0, \n\\quad \\text{and} \\quad z_{i} w_{i} \\;=\\; 0 \\;\\; \\text{for} \\; i \\in \\{1,2\\}.\n$$\n\n任务：\n1. 使用线性互补问题 (LCP) 的定义和线性不等式的择一定理（作为一个经过充分检验的基础事实），直接验证给定的 $M$ 和 $q$ 的原始 LCP 是否有解。通过在 $z \\;\\ge\\; 0$ 条件下检查 $w \\;=\\; q + M z$ 的可行性，从第一性原理出发证明你的结论。\n2. 使用覆盖向量 $d$，确定 Lemke 算法从 $z \\;=\\; 0$ 和 $w \\;=\\; q + z_{0} d \\;\\ge\\; 0$ 的人工解开始进行标准初始化时的最小人工变量水平 $z_{0}^{\\ast}$。\n3. 将 Lemke 算法的次射线理论（一个经过充分检验的事实：如果存在一个非零的 $r \\;\\ge\\; 0$ 且满足 $M r \\;\\ge\\; 0$ 和 $q^{\\top} r  0$，则 LCP 无解，且 Lemke 路径必定在一条次射线上终止）应用于此实例。给出一个满足 $r \\;\\ge\\; 0$ 和 $M r \\;\\ge\\; 0$ 的显式非零向量 $r$，计算 $q^{\\top} r$，并解释为什么这会迫使 Lemke 算法产生一条射线而不是一个解。\n4. 令 $\\Delta z$ 表示在 $z_{0} \\;=\\; 0$ 时增广系统中次射线方向的 $z$ 分量。计算标量比率\n$$\n\\rho \\;=\\; \\frac{\\Delta z_{2}}{\\Delta z_{1}}.\n$$\n\n将你的最终答案以单个实数形式给出。无需四舍五入。", "solution": "用户提供的问题陈述已经过验证，是自洽、一致且科学上合理的。这是一个数学优化领域内的良定问题，具体涉及线性互补问题 (LCP) 和 Lemke 算法。解答所需的所有数据和定义均已提供。我们开始进行详细解答。\n\n该问题由矩阵 $M$、向量 $q$ 和覆盖向量 $d$ 定义：\n$$\nM = \\begin{pmatrix} 0  -1 \\\\ 1  0 \\end{pmatrix}, \\quad q = \\begin{pmatrix} -1 \\\\ 0 \\end{pmatrix}, \\quad d = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}.\n$$\nLCP 是找到满足 $z \\ge 0, w = q + Mz \\ge 0, z^{\\top}w = 0$ 的 $z, w \\in \\mathbb{R}^2$。\n\n**1. LCP 解的存在性验证**\n\nLCP 的解必须至少满足可行性条件 $z \\ge 0$ 和 $w = q + Mz \\ge 0$。令 $z = \\begin{pmatrix} z_1 \\\\ z_2 \\end{pmatrix}$。条件 $z \\ge 0$ 意味着 $z_1 \\ge 0$ 且 $z_2 \\ge 0$。\n\n条件 $w \\ge 0$ 表示为：\n$$\nw = \\begin{pmatrix} w_1 \\\\ w_2 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ 0 \\end{pmatrix} + \\begin{pmatrix} 0  -1 \\\\ 1  0 \\end{pmatrix} \\begin{pmatrix} z_1 \\\\ z_2 \\end{pmatrix} = \\begin{pmatrix} -1 - z_2 \\\\ z_1 \\end{pmatrix} \\ge \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}.\n$$\n这得到两个分量不等式：\n1.  $w_1 = -1 - z_2 \\ge 0$，这意味着 $z_2 \\le -1$。\n2.  $w_2 = z_1 \\ge 0$。\n\n问题要求 $z \\ge 0$，这意味着 $z_2 \\ge 0$。然而，$w$ 的可行性要求 $z_2 \\le -1$。这两个条件，$z_2 \\ge 0$ 和 $z_2 \\le -1$，是相互排斥的。没有实数 $z_2$ 能同时满足两者。因此，可行解集 $\\{z \\in \\mathbb{R}^2 \\mid z \\ge 0, q+Mz \\ge 0\\}$ 是空集。由于不存在可行解，该 LCP 无解。\n\n正如题目建议，我们可以使用择一定理（具体地，一种形式的 Farkas 引理）来证实这一点。系统 $Mz \\ge -q, z \\ge 0$ 不可行，当且仅当存在一个向量 $y \\ge 0$ 使得 $M^{\\top}y \\le 0$ 和 $(-q)^{\\top}y > 0$。\n我们来寻找这样一个向量 $y = \\begin{pmatrix} y_1 \\\\ y_2 \\end{pmatrix} \\ge 0$。\n条件 $M^{\\top}y \\le 0$ 为：\n$$\nM^{\\top}y = \\begin{pmatrix} 0  1 \\\\ -1  0 \\end{pmatrix} \\begin{pmatrix} y_1 \\\\ y_2 \\end{pmatrix} = \\begin{pmatrix} y_2 \\\\ -y_1 \\end{pmatrix} \\le \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}.\n$$\n这得到 $y_2 \\le 0$ 和 $-y_1 \\le 0$ (即 $y_1 \\ge 0$）。\n条件 $(-q)^{\\top}y > 0$ 为：\n$$\n(-q)^{\\top}y = - \\begin{pmatrix} -1  0 \\end{pmatrix} \\begin{pmatrix} y_1 \\\\ y_2 \\end{pmatrix} = y_1 > 0.\n$$\n我们需要找到满足 $y_1 \\ge 0, y_2 \\ge 0$ (来自 $y \\ge 0$)， $y_1 \\ge 0, y_2 \\le 0$ (来自 $M^{\\top}y \\le 0$)，以及 $y_1 > 0$ (来自 $(-q)^{\\top}y > 0$) 的 $y_1, y_2$。\n结合这些条件，我们得到 $y_1 > 0$ 且 $y_2 = 0$。一个有效的选择是 $y = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。该向量满足所有条件：$y \\ge 0$，$M^{\\top}y = \\begin{pmatrix} 0 \\\\ -1 \\end{pmatrix} \\le 0$，以及 $(-q)^{\\top}y = 1 > 0$。这样一个 $y$ 的存在证实了原始 LCP 是不可行的。\n\n**2. 最小人工变量水平 $z_0^{\\ast}$**\n\nLemke 算法从 $z=0$ 的人工解开始。增广系统为 $w = q + Mz + z_0 d$。在初始化时，我们设置 $z=0$ 并找到最小的 $z_0 \\ge 0$ 使得 $w = q + z_0 d \\ge 0$。\n代入给定的向量 $q$ 和 $d$：\n$$\n\\begin{pmatrix} -1 \\\\ 0 \\end{pmatrix} + z_0 \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} \\ge \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n$$\n\\begin{pmatrix} -1 + z_0 \\\\ z_0 \\end{pmatrix} \\ge \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n这导致以下不等式：\n1.  $-1 + z_0 \\ge 0 \\implies z_0 \\ge 1$。\n2.  $z_0 \\ge 0$。\n要同时满足两者，我们必须有 $z_0 \\ge 1$。因此，$z_0$ 的最小值为 $z_0^{\\ast} = 1$。\n\n**3. 次射线理论的应用**\n\n该理论指出，如果存在一个非零向量 $r \\ge 0$ 使得 $Mr \\ge 0$ 且 $q^{\\top}r  0$，则 LCP 无解，且 Lemke 算法在一条次射线上终止。\n令 $r = \\begin{pmatrix} r_1 \\\\ r_2 \\end{pmatrix}$。条件是：\n1.  $r \\ge 0 \\implies r_1 \\ge 0, r_2 \\ge 0$。并且，$r \\ne 0$。\n2.  $Mr \\ge 0$:\n    $$\n    Mr = \\begin{pmatrix} 0  -1 \\\\ 1  0 \\end{pmatrix} \\begin{pmatrix} r_1 \\\\ r_2 \\end{pmatrix} = \\begin{pmatrix} -r_2 \\\\ r_1 \\end{pmatrix} \\ge \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}.\n    $$\n    这意味着 $-r_2 \\ge 0$ (所以 $r_2 \\le 0$) 且 $r_1 \\ge 0$。\n3.  $q^{\\top}r  0$:\n    $$\n    q^{\\top}r = \\begin{pmatrix} -1  0 \\end{pmatrix} \\begin{pmatrix} r_1 \\\\ r_2 \\end{pmatrix} = -r_1  0.\n    $$\n    这意味着 $r_1 > 0$。\n\n结合关于 $r$ 的条件：从 $r_2 \\ge 0$ 和 $r_2 \\le 0$ 可得 $r_2 = 0$。从 $r_1 > 0$ 和 $r \\ne 0$ 可知，任何形式为 $r = \\begin{pmatrix} r_1 \\\\ 0 \\end{pmatrix}$ 且 $r_1 > 0$ 的向量都满足条件。\n我们通过选择 $r_1 = 1$ 来给出一个显式向量。所以，$r = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。\n我们来验证这个 $r$ 的条件：\n-   $r = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} \\ge 0$ 且非零。\n-   $Mr = \\begin{pmatrix} 0  -1 \\\\ 1  0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} \\ge 0$。\n-   $q^{\\top}r = \\begin{pmatrix} -1  0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = -1  0$。\n所有条件都得到满足。这样一个向量 $r$ 的存在证明了 LCP 无解，并迫使 Lemke 算法在一条次射线上终止，这条次射线是增广系统在 $z_0=0$ 时的可行域的一个无界方向。\n\n**4. 比率 $\\rho$ 的计算**\n\n次射线对应于变量空间 $(z, w)$ 中的一个非零方向 $(\\Delta z, \\Delta w)$，使得从射线上的某点出发，可以沿此方向无限移动，同时保持可行性 ($z \\ge 0, w \\ge 0$) 和互补性。对于次射线，$z_0=0$。方向向量 $(\\Delta z, \\Delta w)$ 必须满足以下齐次系统：\n1.  $\\Delta w = M \\Delta z$\n2.  $\\Delta z \\ge 0, \\Delta w \\ge 0$，且 $\\Delta z \\ne 0$ (因为射线在 $z$ 空间中)。\n3.  方向本身必须是互补的：对于 $i \\in \\{1,2\\}$，有 $\\Delta z_i \\Delta w_i = 0$。\n\n令 $\\Delta z = \\begin{pmatrix} \\Delta z_1 \\\\ \\Delta z_2 \\end{pmatrix}$。从 $\\Delta w = M \\Delta z$ 可得：\n$$\n\\Delta w = \\begin{pmatrix} \\Delta w_1 \\\\ \\Delta w_2 \\end{pmatrix} = \\begin{pmatrix} 0  -1 \\\\ 1  0 \\end{pmatrix} \\begin{pmatrix} \\Delta z_1 \\\\ \\Delta z_2 \\end{pmatrix} = \\begin{pmatrix} -\\Delta z_2 \\\\ \\Delta z_1 \\end{pmatrix}.\n$$\n非负性条件 $\\Delta z \\ge 0$ 和 $\\Delta w \\ge 0$ 要求：\n-   $\\Delta z_1 \\ge 0$\n-   $\\Delta z_2 \\ge 0$\n-   $\\Delta w_1 = -\\Delta z_2 \\ge 0 \\implies \\Delta z_2 \\le 0$\n-   $\\Delta w_2 = \\Delta z_1 \\ge 0$\n\n从 $\\Delta z_2 \\ge 0$ 和 $\\Delta z_2 \\le 0$，我们必须有 $\\Delta z_2 = 0$。\n由于 $\\Delta z \\ne 0$，我们必须有 $\\Delta z_1 > 0$。\n因此，$z$ 变量中射线的方向是任何与 $\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ 成比例的向量。我们设 $\\Delta z = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。\n那么 $\\Delta z_1 = 1$ 且 $\\Delta z_2 = 0$。对应的 $\\Delta w$ 是 $\\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$。我们来验证互补性条件 $\\Delta z_i \\Delta w_i = 0$：\n-   对于 $i=1$：$\\Delta z_1 \\Delta w_1 = 1 \\cdot 0 = 0$。\n-   对于 $i=2$：$\\Delta z_2 \\Delta w_2 = 0 \\cdot 1 = 0$。\n条件得到满足。射线方向的 $z$ 分量是 $\\Delta z = \\begin{pmatrix} k \\\\ 0 \\end{pmatrix}$，其中 $k>0$。\n问题要求计算比率 $\\rho = \\frac{\\Delta z_2}{\\Delta z_1}$。使用任何这样的方向向量，我们得到：\n$$\n\\rho = \\frac{0}{k} = 0.\n$$\n该比率的值与正常数缩放因子 $k$ 无关。\n最终答案是 $0$。", "answer": "$$\n\\boxed{0}\n$$", "id": "3109485"}]}