{"hands_on_practices": [{"introduction": "本章节的第一个练习旨在建立关于成本结构、可行解与最优性之间关系的直观理解。通过研究一个所有运输成本都相同的特殊案例，我们将揭示运输问题目标函数的一个基本属性。这个练习将帮助你理解，在某些条件下，任何满足供需约束的方案都可能是最优的，从而清晰地掌握最优性的核心概念 [@problem_id:3138308]。", "problem": "考虑一个有 $m=3$ 个出发地和 $n=4$ 个目的地的平衡运输问题。设供应量为 $S_{1}=20$, $S_{2}=30$, $S_{3}=25$，需求量为 $D_{1}=15$, $D_{2}=25$, $D_{3}=20$, $D_{4}=15$。所有出发地-目的地对的单位运输成本是恒定的，对于每一个 $i \\in \\{1,2,3\\}$ 和 $j \\in \\{1,2,3,4\\}$，都有 $c_{ij}=5$。任务是使用三种标准启发式方法——西北角法 (NWCM)、最小成本法 (LCM) 和 Vogel 近似法 (VAM)——构建初始基本可行解，然后确定最优总运输成本。\n\n为消除歧义，请遵循以下确定性的破同规则：\n- 对于西北角法，按常规方式从左上角开始。\n- 对于最小成本法，当多个单元格具有相同的最低 $c_{ij}$ 时，选择剩余需求量最大的目的地；如果仍然平局，选择索引最小的出发地，然后选择索引最小的目的地。将最大可行运量分配给所选单元格，更新供应量和需求量，并重复此过程直到所有需求都得到满足。\n- 对于 Vogel 近似法，照常计算行和列的罚数。当罚数在零处（或其他情况）出现平局时，选择剩余总量（行对应供应量，列对应需求量）最大的那一行（或列）；如果仍然平局，选择索引最小的一行（或列）。在所选行（或列）内，选择 $c_{ij}$ 最低的单元格；如果单元格平局，选择允许最大分配量的那个；如果仍然平局，选择索引最小的那个。将最大可行运量分配给该单元格并更新。\n\n仅从运输问题的基本定义——其线性目标和流量守恒约束——出发，严格论证在给定的成本结构下，每种启发式方法得到的初始基本可行解是否为最优解，并计算任何最优基本可行解所能达到的最小总运输成本。\n\n以美元表示最终成本，并以单个实数形式给出答案。无需四舍五入。", "solution": "问题陈述是有效的。这是一个定义明确的平衡运输问题，提供了所有必要的数据。破同规则确保了启发式方法的确定性应用。我们可以开始求解。\n\n运输问题被定义为一个线性规划问题，旨在最小化将货物从 $m$ 个出发地运送到 $n$ 个目的地的总成本。设 $x_{ij}$ 是从出发地 $i$ 运往目的地 $j$ 的货物数量。需要最小化的目标函数是总运输成本 $Z$，由下式给出：\n$$Z = \\sum_{i=1}^{m} \\sum_{j=1}^{n} c_{ij} x_{ij}$$\n其中 $c_{ij}$ 是从出发地 $i$ 运往目的地 $j$ 的单位成本。\n\n约束条件确保不超出供应能力并满足需求：\n1.  供应约束：$\\sum_{j=1}^{n} x_{ij} = S_i$，对于每个出发地 $i \\in \\{1, 2, \\dots, m\\}$。\n2.  需求约束：$\\sum_{i=1}^{m} x_{ij} = D_j$，对于每个目的地 $j \\in \\{1, 2, \\dots, n\\}$。\n3.  非负性：$x_{ij} \\geq 0$，对于所有的 $i, j$。\n\n在这个具体问题中，我们有 $m=3$ 个出发地和 $n=4$ 个目的地。\n供应量为 $S_1=20$, $S_2=30$, 和 $S_3=25$。总供应量为 $T_S = 20 + 30 + 25 = 75$。\n需求量为 $D_1=15$, $D_2=25$, $D_3=20$, 和 $D_4=15$。总需求量为 $T_D = 15 + 25 + 20 + 15 = 75$。\n由于 $T_S = T_D$，该问题是平衡的。令 $T = T_S = T_D = 75$。\n\n这个问题的关键特征是，所有出发地-目的地对的单位运输成本 $c_{ij}$ 是一个常数：$c_{ij} = 5$，对于所有的 $i, j$。\n我们将这个常数成本（记为 $c=5$）代入目标函数：\n$$Z = \\sum_{i=1}^{3} \\sum_{j=1}^{4} c x_{ij} = c \\left( \\sum_{i=1}^{3} \\sum_{j=1}^{4} x_{ij} \\right)$$\n对于任何满足供应和需求约束的可行解 $\\{x_{ij}\\}$，总运输量可以通过对所有供应约束或所有需求约束求和来计算。对供应约束求和：\n$$\\sum_{i=1}^{3} \\left( \\sum_{j=1}^{4} x_{ij} \\right) = \\sum_{i=1}^{3} S_i = T_S = 75$$\n因此，对于任何可行解，总分配量 $\\sum_{i,j} x_{ij}$ 是恒定的，等于总供应量（和总需求量）$T$。\n\n将此结果代回目标函数 $Z$：\n$$Z = c \\cdot T$$\n这证明了总运输成本 $Z$ 与具体的分配方案 $\\{x_{ij}\\}$无关，只要 $\\{x_{ij}\\}$ 构成一个可行解。对于每一个可能的可行解，成本都是恒定的。\n因此，每一个可行解都是最优解。\n\n我们现在可以计算这个最小（也是唯一可能）的总成本：\n$$Z_{opt} = c \\cdot T = 5 \\cdot 75 = 375$$\n\n问题要求使用西北角法 (NWCM)、最小成本法 (LCM) 和 Vogel 近似法 (VAM) 构建初始基本可行解 (BFS) 并论证其最优性。基本可行解是一种特殊类型的可行解。由于每个可行解都是最优的，因此由这些标准启发式方法生成的任何 BFS 也必须是最优的。\n\n为了具体地证明这一结论，我们根据指定的规则为每种方法构建 BFS，并验证其成本。\n\n1.  **西北角法 (NWCM)：**\n    遵循从左上角单元格 $(1,1)$ 开始的标准程序，得到的分配方案是：\n    $x_{11} = 15$, $x_{12} = 5$, $x_{22} = 20$, $x_{23} = 10$, $x_{33} = 10$, $x_{34} = 15$。所有其他 $x_{ij} = 0$。\n    总成本是：\n    $Z_{NWCM} = 5(15) + 5(5) + 5(20) + 5(10) + 5(10) + 5(15) = 5(15+5+20+10+10+15) = 5(75) = 375$。\n    正如预测的那样，这个成本就是最优成本。\n\n2.  **最小成本法 (LCM)：**\n    由于所有 $c_{ij}=5$，单元格的选择完全由破同规则决定。应用这些规则，得到的分配方案是：\n    $x_{12} = 20$, $x_{21} = 10$, $x_{23} = 20$, $x_{31} = 5$, $x_{32} = 5$, $x_{34} = 15$。所有其他 $x_{ij} = 0$。\n    总成本是：\n    $Z_{LCM} = 5(20) + 5(10) + 5(20) + 5(5) + 5(5) + 5(15) = 5(20+10+20+5+5+15) = 5(75) = 375$。\n    这个解也是最优的。\n\n3.  **Vogel 近似法 (VAM)：**\n    行和列的罚数（两个最小成本之差）均为 $5-5=0$。选择再次由破同规则决定。得到的分配方案是：\n    $x_{11} = 15$, $x_{14} = 5$, $x_{22} = 25$, $x_{24} = 5$, $x_{33} = 20$, $x_{34} = 5$。所有其他 $x_{ij} = 0$。\n    总成本是：\n    $Z_{VAM} = 5(15) + 5(5) + 5(25) + 5(5) + 5(20) + 5(5) = 5(15+5+25+5+20+5) = 5(75) = 375$。\n    这个解也是最优的。\n\n总之，特殊的成本结构（$c_{ij}$ 是常数）使得分配策略的选择与总成本无关。任何能够产生可行解的方法都将得到相同且最优的总成本。每种启发式方法解的最优性的严格论证，不在于启发式方法本身的机制，而在于该特定问题目标函数的基本性质。最小总运输成本由常数单位成本与待运货物总量的乘积唯一确定。\n\n最小总运输成本为 $Z_{opt} = 375$。", "answer": "$$\\boxed{375}$$", "id": "3138308"}, {"introduction": "在掌握了最优性的基本概念后，我们进入一个更贴近现实的场景。这个练习将展示，选择不同的初始解启发式算法，甚至是其中微小的平局打破规则，都会显著影响找到最优解的效率。通过本练习，你将体会到选择一个“更智能”的起点对于减少后续迭代计算工作的实际价值 [@problem_id:3138291]。", "problem": "一家公司将一种可分商品从 $3$ 个工厂运往 $3$ 个市场，总供给与总需求平衡。设成本矩阵为\n$$\nC \\;=\\; \\begin{pmatrix}\n7  & 2 & 8 \\\\\n2 & 2 & 9 \\\\\n2 & 2 & 9\n\\end{pmatrix},\n$$\n工厂供给量为 $\\big(s_1,s_2,s_3\\big) = (20,30,25)$，市场需求量为 $\\big(d_1,d_2,d_3\\big) = (15,25,35)$。注意，在第 $1$ 列和第 $2$ 列中有几个条目是相同的。考虑通过最小成本法构建初始基本可行解 (BFS)，然后使用改进分配法对其进行改进的任务。\n\n您必须执行以下操作，并遵守指定的破同规则。\n\n- 初始BFS构建规则：使用最小成本法。当多个单元格共享相同的当前最小成本时，严格按照所述应用破同策略：\n  - 策略 $A$：选择行索引 $i$ 最小的单元格，然后选择列索引 $j$ 最小的单元格。\n  - 策略 $B$：选择行索引 $i$ 最大的单元格，然后选择列索引 $j$ 最小的单元格。\n\n- 改进规则：从每个初始BFS（分别从策略 $A$ 和策略 $B$ 得出）开始，迭代应用改进分配法，直到达到最优。在每次迭代中：\n  - 选择具有最负检验数的单元格作为入基单元格。如果出现平局，选择行索引最小，然后列索引最小的单元格。\n  - 使用当前的基单元格，构建通过入基单元格的唯一闭合交替回路，并通过保持可行性的最大步长来调整分配量。\n  - 如果在负号位置上有多个基变量同时达到零，则通过从基中移除这些平局变量中行索引最小，然后列索引最小的单元格来打破平局。\n\n根据线性规划和运输模型的网络流最优性基本原理，确定从每个初始BFS开始，改进分配法所需的改进迭代次数。设 $N_A$ 为从策略 $A$ 的初始BFS开始的迭代次数，$N_B$ 为从策略 $B$ 的初始BFS开始的迭代次数。\n\n计算量 $N_A - N_B$。将您的最终答案以单个实数形式提供。不需要四舍五入。", "solution": "这是一个标准的平衡运输问题，一种特定类型的线性规划问题。目标是找到从使用两种不同破同策略的最小成本法生成的两个不同初始基本可行解 (BFS) 开始，通过改进分配法 (MODI法) 达到最优解所需的改进迭代次数。\n\n该问题由以下内容定义：\n- 工厂（产地）集合 $I = \\{1, 2, 3\\}$。\n- 市场（销地）集合 $J = \\{1, 2, 3\\}$。\n- 供给向量 $s = (s_1, s_2, s_3) = (20, 30, 25)$。\n- 需求向量 $d = (d_1, d_2, d_3) = (15, 25, 35)$。\n- 成本矩阵 $C = (c_{ij})$，由下式给出：\n$$\nC = \\begin{pmatrix}\n7 & 2 & 8 \\\\\n2 & 2 & 9 \\\\\n2 & 2 & 9\n\\end{pmatrix}\n$$\n该问题是平衡的，因为总供给等于总需求：$\\sum s_i = 20+30+25 = 75$ 且 $\\sum d_j = 15+25+35 = 75$。一个BFS将有 $m+n-1 = 3+3-1=5$ 个基变量。\n\n我们将分别分析这两种策略。\n\n**第一部分：策略 A**\n最小成本法的破同规则是选择行索引 $i$ 最小，然后列索引 $j$ 最小的单元格。\n\n**步骤 1.1：使用最小成本法（策略 A）构建初始基本可行解 (BFS)**\n\n1.  矩阵中的最小成本是 $c=2$，出现在单元格 $(1,2), (2,1), (2,2), (3,1), (3,2)$ 中。根据策略 A，我们选择 $i$ 最小，然后 $j$ 最小的单元格。优先顺序是 $(1,2)$，然后是 $(2,1)$，以此类推。\n    我们选择单元格 $(1,2)$。分配量为 $x_{12} = \\min(s_1, d_2) = \\min(20, 25) = 20$。\n    工厂 1 的供给耗尽 ($s_1 \\to 0$)。市场 2 的需求变为 $d_2 \\to 25-20=5$。\n\n2.  剩余未耗尽成本的行是第 2 行和第 3 行。最小成本仍然是 $2$，位于单元格 $(2,1), (2,2), (3,1), (3,2)$。策略 A 选择 $(2,1)$。\n    分配量为 $x_{21} = \\min(s_2, d_1) = \\min(30, 15) = 15$。\n    市场 1 的需求耗尽 ($d_1 \\to 0$)。工厂 2 的供给变为 $s_2 \\to 30-15=15$。\n\n3.  剩余的市场是 2 和 3。最小成本为 2，位于单元格 $(2,2)$ 和 $(3,2)$。策略 A 选择 $(2,2)$。\n    分配量为 $x_{22} = \\min(s_2, d_2) = \\min(15, 5) = 5$。\n    市场 2 的需求耗尽 ($d_2 \\to 0$)。工厂 2 的供给变为 $s_2 \\to 15-5=10$。\n\n4.  唯一剩余的市场是 3，需求为 $d_3=35$。剩余的供给为 $s_2=10$ 和 $s_3=25$。我们必须满足需求。\n    分配量为 $x_{23} = s_2 = 10$。市场 3 的需求变为 $d_3 \\to 35-10=25$。\n    分配量为 $x_{33} = s_3 = 25$。市场 3 的需求耗尽。\n\n策略 A 的初始 BFS，记为 $X_A$，是：\n$$\nX_A = \\begin{pmatrix}\n0 & 20 & 0 \\\\\n15 & 5 & 10 \\\\\n0 & 0 & 25\n\\end{pmatrix}\n$$\n基变量集合为 $B_A = \\{(1,2), (2,1), (2,2), (2,3), (3,3)\\}$。\n总成本为 $20(2) + 15(2) + 5(2) + 10(9) + 25(9) = 40+30+10+90+225 = 395$。\n\n**步骤 1.2：使用 MODI 法改进 BFS**\n\n**迭代 1 ($N_A=1$):**\n- 我们为当前基 $B_A$ 计算对偶变量 $u_i$ 和 $v_j$。设 $u_1=0$。\n- 对于 $(i,j) \\in B_A$，有 $u_i + v_j = c_{ij}$：\n    - $(1,2): u_1 + v_2 = c_{12} = 2 \\implies 0 + v_2 = 2 \\implies v_2 = 2$。\n    - $(2,2): u_2 + v_2 = c_{22} = 2 \\implies u_2 + 2 = 2 \\implies u_2 = 0$。\n    - $(2,1): u_2 + v_1 = c_{21} = 2 \\implies 0 + v_1 = 2 \\implies v_1 = 2$。\n    - $(2,3): u_2 + v_3 = c_{23} = 9 \\implies 0 + v_3 = 9 \\implies v_3 = 9$。\n    - $(3,3): u_3 + v_3 = c_{33} = 9 \\implies u_3 + 9 = 9 \\implies u_3 = 0$。\n- 对偶变量：$u = (0,0,0)$ 和 $v = (2,2,9)$。\n- 为非基变量计算检验数 $\\bar{c}_{ij} = c_{ij} - u_i - v_j$：\n    - $\\bar{c}_{11} = 7 - 0 - 2 = 5$。\n    - $\\bar{c}_{13} = 8 - 0 - 9 = -1$。\n    - $\\bar{c}_{31} = 2 - 0 - 2 = 0$。\n    - $\\bar{c}_{32} = 2 - 0 - 2 = 0$。\n- 最负的检验数是 $\\bar{c}_{13} = -1$。因此，$x_{13}$ 是入基变量。\n- 为了找到出基变量，我们构建回路：$+x_{13} - x_{23} + x_{22} - x_{12}$。\n- 负号位置的分配量为 $x_{23}=10$ 和 $x_{12}=20$。调整量为 $\\theta = \\min(10, 20) = 10$。\n- 变量 $x_{23}$ 变为 $10-10=0$ 并出基。\n- 新的分配量为：\n    - $x_{12} = 20 - 10 = 10$。\n    - $x_{13} = 0 + 10 = 10$。\n    - $x_{22} = 5 + 10 = 15$。\n新的 BFS，$X'_A$，是：\n$$\nX'_A = \\begin{pmatrix}\n0 & 10 & 10 \\\\\n15 & 15 & 0 \\\\\n0 & 0 & 25\n\\end{pmatrix}\n$$\n新的基是 $B'_A = \\{(1,2), (1,3), (2,1), (2,2), (3,3)\\}$。\n\n**迭代 2 ($N_A=2$):**\n- 我们为 $B'_A$ 重新计算对偶变量。设 $u_1=0$。\n    - $(1,2): u_1 + v_2 = c_{12} = 2 \\implies v_2 = 2$。\n    - $(1,3): u_1 + v_3 = c_{13} = 8 \\implies v_3 = 8$。\n    - $(2,2): u_2 + v_2 = c_{22} = 2 \\implies u_2+2=2 \\implies u_2=0$。\n    - $(2,1): u_2 + v_1 = c_{21} = 2 \\implies 0+v_1=2 \\implies v_1=2$。\n    - $(3,3): u_3 + v_3 = c_{33} = 9 \\implies u_3+8=9 \\implies u_3=1$。\n- 对偶变量：$u=(0,0,1)$ 和 $v=(2,2,8)$。\n- 非基变量的检验数：\n    - $\\bar{c}_{11} = 7 - 0 - 2 = 5$。\n    - $\\bar{c}_{23} = 9 - 0 - 8 = 1$。\n    - $\\bar{c}_{31} = 2 - 1 - 2 = -1$。\n    - $\\bar{c}_{32} = 2 - 1 - 2 = -1$。\n- 最负检验数出现平局。破同规则（最小的 $i$，然后最小的 $j$）选择 $x_{31}$ 作为入基变量。\n- 回路是：$+x_{31} - x_{21} + x_{22} - x_{12} + x_{13} - x_{33}$。\n- 负号位置的分配量为 $x_{21}=15$, $x_{12}=10$, $x_{33}=25$。调整量为 $\\theta = \\min(15, 10, 25) = 10$。\n- 变量 $x_{12}$ 变为 $10-10=0$ 并出基。\n- 新的分配量为：\n    - $x_{31} = 0+10 = 10$。\n    - $x_{21} = 15-10 = 5$。\n    - $x_{22} = 15+10 = 25$。\n    - $x_{13} = 10+10 = 20$。\n    - $x_{33} = 25-10 = 15$。\n新的 BFS，$X''_A$，是：\n$$\nX''_A = \\begin{pmatrix}\n0 & 0 & 20 \\\\\n5 & 25 & 0 \\\\\n10 & 0 & 15\n\\end{pmatrix}\n$$\n新的基是 $B''_A = \\{(1,3), (2,1), (2,2), (3,1), (3,3)\\}$。\n\n**最优性检验：**\n- 为 $B''_A$ 重新计算对偶变量。设 $u_2=0$。\n    - $(2,1): u_2 + v_1 = 2 \\implies v_1=2$。\n    - $(2,2): u_2 + v_2 = 2 \\implies v_2=2$。\n    - $(3,1): u_3 + v_1 = 2 \\implies u_3+2=2 \\implies u_3=0$。\n    - $(3,3): u_3 + v_3 = 9 \\implies 0+v_3=9 \\implies v_3=9$。\n    - $(1,3): u_1 + v_3 = 8 \\implies u_1+9=8 \\implies u_1=-1$。\n- 对偶变量：$u=(-1,0,0)$ 和 $v=(2,2,9)$。\n- 检验数：\n    - $\\bar{c}_{11} = 7 - (-1) - 2 = 6 \\ge 0$。\n    - $\\bar{c}_{12} = 2 - (-1) - 2 = 1 \\ge 0$。\n    - $\\bar{c}_{23} = 9 - 0 - 9 = 0 \\ge 0$。\n    - $\\bar{c}_{32} = 2 - 0 - 2 = 0 \\ge 0$。\n- 所有检验数都是非负的。该解是最优解。\n- 策略 A 的迭代次数为 $N_A = 2$。\n\n**第二部分：策略 B**\n最小成本法的破同规则是选择行索引 $i$ 最大，然后列索引 $j$ 最小的单元格。\n\n**步骤 2.1：使用最小成本法（策略 B）构建初始基本可行解 (BFS)**\n\n1.  最小成本是 $2$。单元格为 $(1,2), (2,1), (2,2), (3,1), (3,2)$。策略 B（最大的 $i$，然后最小的 $j$）给出的优先顺序为 $(3,1), (3,2), (2,1), (2,2), (1,2)$。\n    我们选择单元格 $(3,1)$。$x_{31} = \\min(s_3, d_1) = \\min(25, 15) = 15$。\n    $d_1 \\to 0$（耗尽）。$s_3 \\to 25-15=10$。\n\n2.  最小成本是 $2$。剩余单元格为 $(1,2), (2,2), (3,2)$。策略 B 选择 $(3,2)$。\n    $x_{32} = \\min(s_3, d_2) = \\min(10, 25) = 10$。\n    $s_3 \\to 0$（耗尽）。$d_2 \\to 25-10=15$。\n\n3.  最小成本是 $2$。剩余单元格为 $(1,2), (2,2)$。策略 B 选择 $(2,2)$。\n    $x_{22} = \\min(s_2, d_2) = \\min(30, 15) = 15$。\n    $d_2 \\to 0$（耗尽）。$s_2 \\to 30-15=15$。\n\n4.  剩余的市场是 3，需求为 $d_3 = 35$，由 $s_1=20$ 和 $s_2=15$ 供给。成本为 $c_{13}=8$ 和 $c_{23}=9$。最小成本法选择成本最小的单元格，即 $(1,3)$。\n    $x_{13} = \\min(s_1, d_3) = \\min(20, 35) = 20$。\n    $s_1 \\to 0$（耗尽）。$d_3 \\to 35-20=15$。\n\n5.  最后的分配必须是 $x_{23} = 15$ 以满足剩余的供给 $s_2=15$ 和需求 $d_3=15$。\n\n策略 B 的初始 BFS，记为 $X_B$，是：\n$$\nX_B = \\begin{pmatrix}\n0 & 0 & 20 \\\\\n0 & 15 & 15 \\\\\n15 & 10 & 0\n\\end{pmatrix}\n$$\n基变量集合为 $B_B = \\{(1,3), (2,2), (2,3), (3,1), (3,2)\\}$。\n总成本为 $20(8) + 15(2) + 15(9) + 15(2) + 10(2) = 160+30+135+30+20 = 375$。\n\n**步骤 2.2：使用 MODI 法改进 BFS**\n\n**最优性检验：**\n- 我们为 $B_B$ 计算对偶变量。设 $u_3=0$。\n    - $(3,1): u_3 + v_1 = c_{31} = 2 \\implies v_1 = 2$。\n    - $(3,2): u_3 + v_2 = c_{32} = 2 \\implies v_2 = 2$。\n    - $(2,2): u_2 + v_2 = c_{22} = 2 \\implies u_2+2=2 \\implies u_2=0$。\n    - $(2,3): u_2 + v_3 = c_{23} = 9 \\implies 0+v_3=9 \\implies v_3=9$。\n    - $(1,3): u_1 + v_3 = c_{13} = 8 \\implies u_1+9=8 \\implies u_1=-1$。\n- 对偶变量：$u=(-1,0,0)$ 和 $v=(2,2,9)$。\n- 非基变量的检验数：\n    - $\\bar{c}_{11} = 7 - (-1) - 2 = 6 \\ge 0$。\n    - $\\bar{c}_{12} = 2 - (-1) - 2 = 1 \\ge 0$。\n    - $\\bar{c}_{21} = 2 - 0 - 2 = 0 \\ge 0$。\n    - $\\bar{c}_{33} = 9 - 0 - 9 = 0 \\ge 0$。\n- 所有检验数都是非负的。因此，由策略 B 生成的初始 BFS $X_B$ 已经是一个最优解。\n- 策略 B 的迭代次数为 $N_B = 0$。\n\n**最终计算**\n策略 A 的迭代次数为 $N_A = 2$。\n策略 B 的迭代次数为 $N_B = 0$。\n所求的量为 $N_A - N_B = 2 - 0 = 2$。", "answer": "$$\n\\boxed{2}\n$$", "id": "3138291"}, {"introduction": "最后一个练习将带你深入探索最优性背后的理论基础。通过分析具有特殊“蒙日 (Monge)”性质的成本矩阵，我们将揭示为何像西北角法这样简单的启发式算法有时竟能直接得到最优解。本练习引入了对偶可行性和灵敏度分析等强大工具，它们不仅能用来证明解的最优性，还能帮助我们理解当问题参数改变时，最优解能保持稳定的范围 [@problem_id:3138339]。", "problem": "考虑一个平衡运输问题，有 $m=3$ 个产地和 $n=3$ 个销地。供应向量为 $\\mathbf{s}=(s_{1},s_{2},s_{3})=(20,30,25)$，需求向量为 $\\mathbf{d}=(d_{1},d_{2},d_{3})=(10,35,30)$，因此总供应等于总需求，均为 $75$。成本矩阵是以下参数族的一个成员\n$$\nc_{i,j}(\\gamma)=a_{i}+b_{j}+\\gamma\\, i j,\\quad i\\in\\{1,2,3\\},\\ j\\in\\{1,2,3\\},\n$$\n其中向量 $\\mathbf{a}=(a_{1},a_{2},a_{3})=(7,8,9)$ 和 $\\mathbf{b}=(b_{1},b_{2},b_{3})=(4,6,8)$ 为固定值，$\\gamma \\le 0$ 为一个标量参数。\n\n- 仅使用蒙日不等式和标准的线性规划最优性概念（如对偶可行性和互补松弛性），首先验证对于任何 $\\gamma \\le 0$，该成本矩阵都是蒙日矩阵，并解释为什么由西北角法则产生的西北角基本可行解是该运输问题的最优解。\n\n- 当 $\\gamma=-1$ 时，为给定的供应量和需求量显式地构造西北角基本可行解。然后，保持所有其他成本不变，通过将位置 $(1,3)$ 的单个非基项减少一个量 $\\delta\\ge 0$ 来对其进行扰动，即定义扰动后的成本 $c'_{1,3}=c_{1,3}-\\delta$，而对于所有 $(i,j)\\neq(1,3)$，都有 $c'_{i,j}=c_{i,j}$。\n\n使用与未扰动实例的西北角基本可行解相关的对偶可行性和判别数，确定在扰动后，西北角基本可行解仍保持最优的最大 $\\delta$ 值。你的最终答案必须是一个实数。不要四舍五入你的答案；以精确值报告，不带单位。", "solution": "我们分两部分解决这个问题。\n\n**第一部分：蒙日性质与西北角法则的最优性**\n\n一个成本矩阵 $C=(c_{ij})$ 被称为蒙日矩阵，如果对于所有 $1 \\le i  k \\le m$ 和 $1 \\le j  l \\le n$，它都满足蒙日不等式：\n$$c_{ij} + c_{kl} \\le c_{il} + c_{kj}$$\n我们将给定的成本函数 $c_{ij}(\\gamma)=a_{i}+b_{j}+\\gamma ij$ 代入该不等式：\n$$(a_i + b_j + \\gamma ij) + (a_k + b_l + \\gamma kl) \\le (a_i + b_l + \\gamma il) + (a_k + b_j + \\gamma kj)$$\n消去两边的 $a_i, a_k, b_j, b_l$ 项，我们得到：\n$$\\gamma ij + \\gamma kl \\le \\gamma il + \\gamma kj$$\n$$\\gamma(ij + kl - il - kj) \\le 0$$\n将表达式分解因式：\n$$\\gamma(i(j-l) - k(j-l)) \\le 0$$\n$$\\gamma(i-k)(j-l) \\le 0$$\n根据蒙日不等式的定义，我们有 $i  k$ 和 $j  l$。这意味着 $(i-k)$ 是负数，$(j-l)$ 也是负数。因此，它们的乘积 $(i-k)(j-l)$ 是正数。\n为了使不等式 $\\gamma \\cdot (\\text{正数}) \\le 0$ 成立，参数 $\\gamma$ 必须满足 $\\gamma \\le 0$。\n因此，当且仅当 $\\gamma \\le 0$ 时，该成本矩阵是蒙日矩阵。\n\n运筹学中的一个经典定理指出，如果运输问题的成本矩阵是蒙日矩阵，那么由西北角法则（一种贪心算法）生成的基可行解就是最优解。由于问题设定 $\\gamma \\le 0$，成本矩阵是蒙日的，因此西北角解是最优的。\n\n**第二部分：灵敏度分析**\n\n现在，我们设置 $\\gamma = -1$。这个值满足 $\\gamma \\le 0$ 的条件。\n1.  **计算成本矩阵 $C$**：\n    $c_{ij} = a_i + b_j - ij$。使用 $\\mathbf{a}=(7,8,9)$ 和 $\\mathbf{b}=(4,6,8)$：\n    $$C = \\begin{pmatrix} 7+4-1  7+6-2  7+8-3 \\\\ 8+4-2  8+6-4  8+8-6 \\\\ 9+4-3  9+6-6  9+8-9 \\end{pmatrix} = \\begin{pmatrix} 10  11  12 \\\\ 10  10  10 \\\\ 10  9  8 \\end{pmatrix}$$\n\n2.  **构造西北角基本可行解 (NWC-BFS)**：\n    给定供应量 $\\mathbf{s}=(20,30,25)$ 和需求量 $\\mathbf{d}=(10,35,30)$。\n    - $x_{11} = \\min(20, 10) = 10$。\n    - $x_{12} = \\min(20-10, 35) = 10$。\n    - $x_{22} = \\min(30, 35-10) = 25$。\n    - $x_{23} = \\min(30-25, 30) = 5$。\n    - $x_{33} = \\min(25, 30-5) = 25$。\n    基变量为 $B = \\{(1,1), (1,2), (2,2), (2,3), (3,3)\\}$。\n\n3.  **计算对偶变量和检验数**：\n    我们求解对偶变量 $u_i, v_j$ 使得对于所有基变量 $(i,j) \\in B$，有 $u_i + v_j = c_{ij}$。设 $u_1=0$。\n    - $(1,1) \\in B: u_1+v_1=c_{11} \\implies 0+v_1=10 \\implies v_1=10$。\n    - $(1,2) \\in B: u_1+v_2=c_{12} \\implies 0+v_2=11 \\implies v_2=11$。\n    - $(2,2) \\in B: u_2+v_2=c_{22} \\implies u_2+11=10 \\implies u_2=-1$。\n    - $(2,3) \\in B: u_2+v_3=c_{23} \\implies -1+v_3=10 \\implies v_3=11$。\n    - $(3,3) \\in B: u_3+v_3=c_{33} \\implies u_3+11=8 \\implies u_3=-3$。\n    对偶变量为 $u=(0,-1,-3)$，$v=(10,11,11)$。\n    检验数（或称判别数）$\\bar{c}_{ij} = c_{ij} - u_i - v_j$ 用于非基变量。我们特别关注 $(1,3)$：\n    $\\bar{c}_{13} = c_{13} - u_1 - v_3 = 12 - 0 - 11 = 1$。\n    由于所有检验数（可以计算其他非基变量的检验数，它们也都是非负的）均 $\\ge 0$，该解是最优的。\n\n4.  **确定最大扰动 $\\delta$**：\n    成本 $c_{13}$ 被扰动为 $c'_{13} = c_{13} - \\delta = 12 - \\delta$。\n    由于只有非基变量的成本被改变，对偶变量 $u_i, v_j$ 保持不变。新的检验数 $\\bar{c}'_{13}$ 为：\n    $$\\bar{c}'_{13} = c'_{13} - u_1 - v_3 = (12 - \\delta) - 0 - 11 = 1 - \\delta$$\n    为了使当前的西北角解保持最优，所有检验数必须为非负。因此，我们需要 $\\bar{c}'_{13} \\ge 0$。\n    $$1 - \\delta \\ge 0 \\implies \\delta \\le 1$$\n    因此，$\\delta$ 的最大值为 $1$。", "answer": "$$\\boxed{1}$$", "id": "3138339"}]}