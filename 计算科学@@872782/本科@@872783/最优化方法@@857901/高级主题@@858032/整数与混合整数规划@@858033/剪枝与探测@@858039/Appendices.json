{"hands_on_practices": [{"introduction": "在分支定界法中，一个分支决策（即固定一个变量的值）可能会立即产生逻辑上的连锁反应。这个练习将向您展示，如何通过一个简单的“不相容约束”，在固定一个变量后，直接确定另一个变量的取值。这使得我们甚至在探索之前，就能有效地剪除搜索树的一个分支。[@problem_id:3128341]", "problem": "考虑以下带有一个不相容约束的0-1背包问题。现有 $5$ 个物品，每个物品有其利润 $p_i$ 和重量 $w_i$，以及一个背包容量 $C$。决策变量 $x_i \\in \\{0,1\\}$ 表示是否选择物品 $i$。数据如下：\n$$\nC = 10, \\quad (p_1, p_2, p_3, p_4, p_5) = (8, 12, 7, 14, 6), \\quad (w_1, w_2, w_3, w_4, w_5) = (4, 5, 3, 7, 2).\n$$\n优化模型为\n$$\n\\max \\ \\sum_{i=1}^{5} p_i x_i \\quad \\text{subject to} \\quad \\sum_{i=1}^{5} w_i x_i \\le C, \\quad x_i \\in \\{0,1\\} \\ \\text{for all} \\ i,\n$$\n以及不相容约束\n$$\nx_2 + x_3 \\le 1.\n$$\n一个分支定界（BB）算法使用线性规划（LP）松弛（即将 $x_i \\in \\{0,1\\}$ 替换为 $0 \\le x_i \\le 1$）来计算节点界限。在根节点，对 $x_2$ 进行分支，并考虑 $x_2 = 1$ 的子节点。在此节点，利用LP松弛中的不相容约束，推导 $x_3$ 必须满足的收紧变量界，并解释为什么设置 $x_3 = 1$ 的直接子分支会被剪枝（fathomed）而无需进一步探索。\n\n报告在 $x_2 = 1$ 的节点上 $x_3$ 的收紧上界，作为一个实数。无需四舍五入。", "solution": "该问题要求分析应用于一个带有额外不相容约束的0-1背包问题的分支定界（BB）算法中的一个特定节点。目标是确定一个收紧的变量界，并基于约束传播解释一个剪枝步骤。\n\n优化问题公式化为：\n$$\n\\max \\ \\sum_{i=1}^{5} p_i x_i\n$$\n约束条件为：\n$$\n\\sum_{i=1}^{5} w_i x_i \\le C \\quad (1)\n$$\n$$\nx_2 + x_3 \\le 1 \\quad (2)\n$$\n$$\nx_i \\in \\{0, 1\\} \\quad \\text{for } i = 1, \\dots, 5 \\quad (3)\n$$\n所提供的数据为 $C = 10$，$(p_1, p_2, p_3, p_4, p_5) = (8, 12, 7, 14, 6)$，以及 $(w_1, w_2, w_3, w_4, w_5) = (4, 5, 3, 7, 2)$。\n\nBB 算法采用问题的线性规划（LP）松弛，其中二进制约束 $x_i \\in \\{0, 1\\}$ 被松弛为连续约束 $0 \\le x_i \\le 1$。\n\n我们被要求分析从根节点通过对变量 $x_2$ 分支并将其值设为 $1$ 而创建的子节点。在此节点，约束 $x_2 = 1$ 被添加到 LP 松弛的约束集中。\n\n在此节点确定 $x_3$ 的界限的相关约束集包括：\n1.  原始不相容约束：$x_2 + x_3 \\le 1$。\n2.  根节点LP松弛得到的 $x_3$ 的界限：$0 \\le x_3 \\le 1$。\n3.  定义当前节点的新分支约束：$x_2 = 1$。\n\n为了推导 $x_3$ 的收紧变量界，我们将分支约束 $x_2 = 1$ 代入不相容约束 $(2)$：\n$$\n1 + x_3 \\le 1\n$$\n从该不等式两边减去 $1$，我们得到 $x_3$ 的一个新上界：\n$$\nx_3 \\le 0\n$$\n从基本的 LP 松弛中，我们还有非负约束 $x_3 \\ge 0$。一个变量必须同时满足所有活动约束。因此，$x_3$ 必须同时满足 $x_3 \\le 0$ 和 $x_3 \\ge 0$。唯一满足这两个条件的实数是 $x_3 = 0$。\n\n这意味着在 $x_2 = 1$ 的节点上，变量 $x_3$ 被固定为值 $0$。原始界限 $0 \\le x_3 \\le 1$ 被收紧为 $0 \\le x_3 \\le 0$。因此，在此节点上 $x_3$ 的收紧上界是 $0$。\n\n问题的第二部分要求解释为什么后续设置 $x_3 = 1$ 的分支会被剪枝（fathomed）。如果我们从当前节点（$x_2 = 1$）通过添加约束 $x_3 = 1$ 来创建一个子节点，那么这个新节点的子问题将由包括以下内容的约束集定义：\n*   $x_2 = 1$（来自父节点的分支）\n*   $x_3 = 1$（来自新分支）\n*   $x_2 + x_3 \\le 1$（来自原始问题公式）\n\n将 $x_2$ 和 $x_3$ 的值代入不相容约束，得到：\n$$\n1 + 1 \\le 1\n$$\n$$\n2 \\le 1\n$$\n这个结果是一个矛盾，这意味着这个假设节点的 LP 松弛的可行集是空的。一个子问题不可行的节点不可能包含任何可行的整数解。在 BB 算法中，这类节点会因不可行而被剪枝。这是一种逻辑预处理或约束传播的形式，它阻止算法探索一个保证不会导向可行解的分支。\n\n在 $x_2=1$ 的节点上，$x_3$ 的收紧上界是 $0$。", "answer": "$$\\boxed{0}$$", "id": "3128341"}, {"introduction": "我们可以利用的不仅仅是变量的固定值，还可以利用变量的整个取值范围（定义域）来收紧其他变量的界限。这个练习将演示一种称为“域过滤”的技术。通过这种技术，我们可以证明搜索树的整个分支从一开始就是不可行的，从而一次性剪除大量节点。[@problem_id:3128339]", "problem": "考虑一个在分支定界 (BB) 过程中的混合整数线性规划 (MILP) 子问题，其决策变量为 $x$、$y$ 和 $z$。变量 $x$ 是整数，变量 $y$ 和 $z$ 是连续的。当前节点的初始定义域界限为 $x \\in [0,10] \\cap \\mathbb{Z}$，$y \\in [0,4]$ 和 $z \\in [0,5]$。该节点受以下线性约束：\n$$3x + y \\geq 28,$$\n$$x + 2y + z \\leq 20,$$\n$$y + z \\leq 6.$$\n从线性不等式和可行集的基本性质出发，仅使用 $y$ 的界限和不等式 $3x + y \\geq 28$ 对 $x$ 应用定义域过滤，以推导出对于此节点的任何可行解都必须成立的 $x$ 的更紧的界。然后，假设求解器在当前节点上对 $x$ 使用二元分支，创建两个子节点，其析取条件分别为 $x \\leq 7$（左子节点）和 $x \\geq 8$（右子节点）。使用推导出的界来确定左子节点的可行性状态。\n\n假设求解器对左子节点有一个固定的后续分支计划：如果左子节点没有被立即剪枝，它接下来将对 $y$ 进行分支，使用析取条件 $y \\leq 2$ 和 $y \\geq 3$，然后在下一层级，它将对两个 $y$-子节点中的每一个再对 $z$ 进行分支，使用析取条件 $z \\leq 1$ 和 $z \\geq 2$。通过计算由于左子节点在创建时通过定义域过滤被证明为不可行而被移除的节点总数，来量化这个剪枝级联。这个总数包括左子节点本身以及在这个固定分支计划下本应被创建的所有后代节点。将你的最终答案表示为单个实数值。不需要四舍五入。", "solution": "该问题需要在分支定界 (BB) 框架内对一个混合整数线性规划 (MILP) 子问题进行三部分分析。首先，我们必须推导出整数变量 $x$ 的一个更紧的界。其次，我们使用这个界来确定一个子节点的可行性。第三，我们量化由于此可行性分析而被剪枝的节点数量。\n\n在当前 BB 节点，给定的变量及其初始定义域为：\n- $x \\in [0, 10] \\cap \\mathbb{Z}$ (整数)\n- $y \\in [0, 4]$ (连续)\n- $z \\in [0, 5]$ (连续)\n\n线性约束为：\n$$3x + y \\geq 28$$\n$$x + 2y + z \\leq 20$$\n$$y + z \\leq 6$$\n\n第1部分：对 $x$ 进行定义域过滤。\n问题要求仅使用不等式 $3x + y \\geq 28$ 和 $y$ 的定义域对 $x$ 进行定义域过滤。我们首先在此不等式中分离出 $x$：\n$$3x \\geq 28 - y$$\n$$x \\geq \\frac{28 - y}{3}$$\n这个不等式必须对任何可行解 $(x, y, z)$ 都成立。为了找到在此节点上对任何可行点都普遍成立的 $x$ 的最紧可能下界，我们必须找到右侧表达式的最小值。项 $\\frac{28 - y}{3}$ 是关于 $y$ 的单调递减函数。因此，当 $y$ 取其最大值时，该项达到其最小值。\n$y$ 的定义域为区间 $[0, 4]$。因此，$y$ 的最大值为 $y_{\\text{max}} = 4$。\n将此值代入关于 $x$ 的不等式中：\n$$x \\geq \\frac{28 - y_{\\text{max}}}{3}$$\n$$x \\geq \\frac{28 - 4}{3}$$\n$$x \\geq \\frac{24}{3}$$\n$$x \\geq 8$$\n由于 $x$ 是一个整数变量，这意味着对于当前节点的任何可行解，$x$ 必须是大于或等于 $8$ 的整数。$x$ 的初始定义域为 $x \\in \\{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10\\}$。推导出的条件 $x \\geq 8$ 将此定义域收紧为 $x \\in [8, 10] \\cap \\mathbb{Z}$，或 $x \\in \\{8, 9, 10\\}$。\n\n第2部分：左子节点的可行性状态。\n求解器对变量 $x$ 进行分支，创建两个子节点。左子节点是通过将约束 $x \\leq 7$ 添加到父节点的约束集中来定义的。右子节点是通过添加约束 $x \\geq 8$ 来定义的。\n为了确定左子节点的可行性，我们必须考虑其所有约束。这些约束包括从父节点继承的约束和新的分支约束。从第1部分中，我们确定了父节点问题的任何可行解都必须满足 $x \\geq 8$。左子节点施加了额外的约束 $x \\leq 7$。\n因此，左子节点的可行解必须同时满足 $x \\geq 8$ 和 $x \\leq 7$。没有整数 $x$ 能同时满足这两个相互矛盾的条件。整数集合 $\\{x \\in \\mathbb{Z} \\mid x \\geq 8\\}$ 和 $\\{x \\in \\mathbb{Z} \\mid x \\leq 7\\}$ 的交集是空集。\n因此，左子节点的可行域为空。这意味着该节点是不可行的，可以在其创建后立即从 BB 树中剪枝。\n\n第3部分：量化剪枝级联。\n当一个节点被剪枝时，算法不会探索其任何潜在的后代节点。问题要求我们量化因左子节点被证明不可行而从搜索中移除的节点总数。这个总数包括左子节点本身，以及根据指定的固定分支计划本应由它生成的所有后代节点。\n\n以左子节点为根的子树的分支计划如下：\n1.  左子节点本身构成了这个被剪掉的子树的根。这是 $1$ 个节点。\n2.  如果它没有被剪枝，下一层分支将是对变量 $y$ 进行，创建 $2$ 个子节点（一个对应 $y \\leq 2$，另一个对应 $y \\geq 3$）。\n3.  如果这些节点没有被剪枝，下一层分支将是对变量 $z$ 进行。对于上一层级的 $2$ 个节点中的每一个，此分支会创建 $2$ 个新子节点（一个对应 $z \\leq 1$，另一个对应 $z \\geq 2$）。这导致在这一层级产生 $2 \\times 2 = 4$ 个节点。\n\n被剪掉的整个子树由这三个层级的节点组成。被剪掉的节点总数是每个层级节点数之和：\n- 第 $0$ 层（左子节点）：$1$ 个节点。\n- 第 $1$ 层（由$y$-分支产生的子节点）：$2$ 个节点。\n- 第 $2$ 层（由$z$-分支产生的子节点）：$4$ 个节点。\n\n移除的节点总数 = $1 + 2 + 4 = 7$。\n这就是剪枝级联的规模。在左子节点创建时证明其不可行性，节省了创建和处理所有这 $7$ 个节点的计算工作量。", "answer": "$$\n\\boxed{7}\n$$", "id": "3128339"}, {"introduction": "现在，我们将引入一个更高级的概念：利用线性规划松弛（LP relaxation）提供的“经济信息”来进行剪枝。Reduced costs (检验数) 告诉我们强制一个非基变量进入解所需要付出的“代价”。这个练习将展示我们如何利用这一信息，判断一个分支是否注定会导向比当前最优解更差的解，这是一种称为“变量固定”的强大技术。[@problem_id:3128375]", "problem": "考虑一个形式为 $\\min \\{ c^{\\top} x : A x \\ge b, \\ x \\in \\{0,1\\}^n \\}$ 的 $0$-$1$ 整数线性规划 (ILP) 问题，该问题正在使用分支定界法 (BB) 求解。在某个特定节点，求解其线性规划 (LP) 松弛问题，得到最优目标值为 $z^{\\star}_{\\mathrm{LP}} = 132.4$。一个现任可行整数解的目标值为 $U = 140.6$。在该节点的当前最优 LP 基中，变量 $x_3$ 和 $x_7$ 是值为 0 的非基变量，其约化成本分别为 $\\bar{c}_3 = 9.1$ 和 $\\bar{c}_7 = 8.3$。该模型包含覆盖约束 $x_3 + x_7 \\ge 1$。\n\n使用通过高级约化成本进行变量固定的原理，剪掉了分支 $x_3 = 1$ 并在该节点上固定 $x_3 = 0$。然后，通过覆盖约束的逻辑传播，可推断出 $x_7$ 为 1。仅基于 LP 约化成本推理（在固定变量后不重新优化 LP），确定此传播后该节点目标值的更新有效下界。\n\n将最终答案表示为一个实数，并四舍五入到四位有效数字。", "solution": "问题背景是一个最小化 $0$-$1$ 整数线性规划 (ILP) 及其在一个分支定界 (BB) 节点上的线性规划 (LP) 松弛。我们使用的基本概念如下：\n\n1. LP 松弛的目标值 $z^{\\star}_{\\mathrm{LP}}$ 是该节点最小化 ILP 问题的一个有效下界。\n2. 对于一个给定的最优 LP 基，其约束关联的对偶乘子为 $\\pi$，非基变量 $x_i$ 的约化成本定义为\n$$\n\\bar{c}_i = c_i - a_i^{\\top} \\pi,\n$$\n其中 $c_i$ 是目标系数，$a_i$ 是 $A$ 中对应于 $x_i$ 的列。在一个最小化问题中，若 $x_i$ 是值为 0 的非基变量，$\\bar{c}_i > 0$ 意味着将 $x_i$ 从 0 增加，会使 LP 目标值以至少每单位 $\\bar{c}_i$ 的速率增加，直到基发生变化。这就得出了标准的约化成本界：如果我们强制 $x_i = 1$，LP 目标值不会减少；相反，对于这个强制解的一个有效界是\n$$\nz^{\\star}_{\\mathrm{LP}} + \\bar{c}_i.\n$$\n这可由对偶可行性和互补松弛性得出：任何违反约化成本非负性的可行原始变量变动，都必须使目标值至少增加被违反的约化成本之和。\n\n3. 在用于最小化问题的 BB 中，高级约化成本变量固定方法会将 $\\bar{c}_i$ 与到现任解的差距 $U - z^{\\star}_{\\mathrm{LP}}$ 进行比较。如果 $\\bar{c}_i \\ge U - z^{\\star}_{\\mathrm{LP}}$，那么分支 $x_i = 1$ 不可能产生一个严格小于 $U$ 的目标值，因此分支 $x_i = 1$ 被剪枝。对称地，可以在该节点上固定 $x_i = 0$。\n\n我们应用这些原理：\n\n- 计算到现任解的差距：\n$$\nU - z^{\\star}_{\\mathrm{LP}} = 140.6 - 132.4 = 8.2.\n$$\n- 由于 $\\bar{c}_3 = 9.1$ 且 $\\bar{c}_3 > 8.2$，设置 $x_3=1$ 不可能比现任解更优。因此，剪掉分支 $x_3 = 1$ 是合理的，并且我们在该节点上固定 $x_3 = 0$。\n\n- 覆盖约束 $x_3 + x_7 \\ge 1$ 意味着当 $x_3=0$ 时，我们必须有 $x_7=1$。\n\n- 在不重新优化的情况下，我们可以使用针对被强制变量 $x_7$ 的约化成本推理来更新节点的下界。因为 $x_7$ 当前是值为 0 的非基变量，其约化成本为 $\\bar{c}_7 = 8.3$，强制 $x_7 = 1$ 会使 LP 目标值至少增加 $\\bar{c}_7$。因此，更新后的有效下界是\n$$\nz^{\\star}_{\\mathrm{LP}} + \\bar{c}_7 = 132.4 + 8.3 = 140.7.\n$$\n\n最后，四舍五入到四位有效数字。值 $140.7$ 已经有四位有效数字，所以报告的界是 $140.7$。\n\n这个界也显示了 $140.7 \\ge U = 140.6$，这表明在传播后，该节点可以被剪除；然而，题目要求输出的是更新后的下界本身。", "answer": "$$\\boxed{140.7}$$", "id": "3128375"}]}