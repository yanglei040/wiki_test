## 引言
在解决复杂的决策问题时，[混合整数线性规划](@entry_id:636618)（MILP）是一个无处不在的强大模型。然而，求解这些问题，尤其是大规模问题，极具挑战性。单纯的[分支定界法](@entry_id:635251)虽然是核心策略，但当其[线性规划松弛](@entry_id:267116)与真实整数解相距甚远时，往往会因巨大的搜索空间而陷入计算困境。为了克服这一瓶颈，一种更为精妙和强大的技术——[分支切割](@entry_id:174657)法（Branch and Cut）应运而生。它通过智能地增强模型本身来从根本上解决问题，而非仅仅依赖于蛮力搜索。

本文旨在系统地揭开[分支切割](@entry_id:174657)法的面纱，为读者提供一个从理论到实践的全面视角。我们将从三个维度展开：
首先，在“原理与机制”一章中，我们将深入探讨[分支切割](@entry_id:174657)法的核心思想。您将理解为何需要[割平面](@entry_id:177960)，它们如何从几何上“切割”掉不可行的分数解区域，以及像Gomory[割平面](@entry_id:177960)和[覆盖不等式](@entry_id:634882)这样的关键技术是如何生成的。
其次，在“应用与跨学科联系”一章中，我们将穿越不同学科的边界，展示[分支切割](@entry_id:174657)法如何解决从经典的旅行商问题到现代机器学习中的[贝叶斯网络结构学习](@entry_id:746724)等一系列真实世界挑战。这一章将凸显该方法作为通用优化框架的强大威力。
最后，在“动手实践”部分，我们为您准备了精心设计的编程练习，引导您从手动推导一个[割平面](@entry_id:177960)，到实现一个基础的[分支切割](@entry_id:174657)算法，亲身体验理论知识如何转化为解决问题的实际能力。

通过本文的学习，您将不仅掌握[分支切割](@entry_id:174657)法的技术细节，更能领会其背后“将问题洞察力转化为计算效率”的核心哲学。现在，让我们一同启程，深入探索[分支切割](@entry_id:174657)法的原理、应用与实践。

## 原理与机制

在上一章中，我们介绍了[混合整数线性规划](@entry_id:636618)（MILP）的挑战，并概述了[分支定界法](@entry_id:635251)作为一种核心求解策略。该方法通过将问题分解为一系列线性规划（LP）松弛问题来系统地探索解空间。然而，单纯的[分支定界法](@entry_id:635251)往往面临计算效率的瓶颈，尤其是在[LP松弛](@entry_id:267116)解与整数最优解相去甚远的情况下。本章将深入探讨[分支切割](@entry_id:174657)法（Branch and Cut）的原理与机制，这是一种通过在分支定界框架中动态引入[有效不等式](@entry_id:170492)（即“[割平面](@entry_id:177960)”）来显著[增强算法](@entry_id:635795)性能的先进方法。我们将从[割平面](@entry_id:177960)的基本目的出发，逐步揭示其生成机制、应用策略以及与分支过程的协同作用。

### 为何需要[割平面](@entry_id:177960)？[线性规划松弛](@entry_id:267116)的局限性

[分支定界法](@entry_id:635251)的效率在很大程度上取决于[LP松弛](@entry_id:267116)的质量。一个“紧”的松弛能够为整数问题提供精确的界，从而有效剪除搜索树中的分支。反之，一个“松”的松弛则会导致界松弛，使得算法需要探索巨大的搜索树才能证明最优性。[LP松弛](@entry_id:267116)解的目标值与真实整数最优解的目标值之间的差距，通常被称为**[整数规划](@entry_id:178386)间隙 (integrality gap)**。[割平面](@entry_id:177960)的首要目标正是缩小甚至消除这一间隙。

为了直观地理解[整数规划](@entry_id:178386)间隙带来的挑战以及[割平面](@entry_id:177960)的巨大威力，让我们思考一个经典的组合优化问题：图上的最大稳定集问题。一个图的稳定集是指图中一个顶点[子集](@entry_id:261956)，其中任意两个顶点之间都没有边相连。在[完全图](@entry_id:266483) $K_{10}$（一个有10个顶点，且任意两个不同顶点之间都有一条边的图）上寻找最大稳定集，问题变得异常简单：由于任意两个顶点都相邻，任何稳定集最多只能包含一个顶点。因此，最大稳定集的规模为1。

现在，我们考虑该问题的标准[整数规划](@entry_id:178386)模型。令[二元变量](@entry_id:162761) $x_i$ 表示是否选择顶点 $i$（$x_i=1$ 表示选择，$x_i=0$ 表示不选择）。我们的目标是最大化所选顶点的数量，即 $\max \sum_{i=1}^{10} x_i$。约束条件是，对于图中任意一条边 $\{i,j\}$，两个顶点不能同时被选中，即 $x_i + x_j \le 1$。该模型的[LP松弛](@entry_id:267116)版本将 $x_i \in \{0,1\}$ 替换为 $0 \le x_i \le 1$。

令人惊讶的是，这个[LP松弛](@entry_id:267116)的解与整数解大相径庭。一个简单的可行LP解是为所有顶点都赋予 $x_i = 0.5$ 的值。这个解满足所有约束条件（因为对于任意边 $\{i,j\}$，$x_i + x_j = 0.5 + 0.5 = 1 \le 1$），并且其目标值为 $\sum x_i = 10 \times 0.5 = 5$。事实上，可以证明[LP松弛](@entry_id:267116)的最优值就是5。

此处，[整数规划](@entry_id:178386)间隙巨大：[LP松弛](@entry_id:267116)给出的[上界](@entry_id:274738)是5，而真实的整数最优解是1。如果仅依赖分支定界，算法将从一个极其松弛的根节点开始，可能需要进行大量分支才能将这个上界从5降低到1。

这正是[割平面](@entry_id:177960)发挥作用的舞台。一个**[有效不等式](@entry_id:170492) (valid inequality)**，或称**[割平面](@entry_id:177960) (cutting plane)**，是这样一种不等式：它被所有整数[可行解](@entry_id:634783)满足，但被当前的[LP松弛](@entry_id:267116)最优解违反。对于 $K_{10}$ 上的稳定集问题，一个非常强的[有效不等式](@entry_id:170492)是**团不等式 (clique inequality)**。由于整个图 $V$ 本身就是一个大小为10的团（clique），而稳定集中最多只能包含团中的一个顶点，因此我们知道任何整数可行解都必须满足 $\sum_{i \in V} x_i \le 1$。

这个不等式是有效的，因为我们已经知道任何稳定集的大小都不超过1。然而，它却被LP最优解 $x_i=0.5$ 严重违反，因为 $\sum x_i = 5 \not\le 1$。如果我们将这个[割平面](@entry_id:177960)加入到[LP松弛](@entry_id:267116)中，新的L[P问题](@entry_id:267898)就变成了在原有约束之上，额外要求 $\sum x_i \le 1$。显然，这个新LP的最优值最多为1。由于我们已经知道存在一个目标值为1的整数解（例如选择任意单个顶点），因此增强后的[LP松弛](@entry_id:267116)的最优解就是1，[整数规划](@entry_id:178386)间隙被完全消除。在这个例子中，仅仅增加一个[割平面](@entry_id:177960)，就使得[LP松弛](@entry_id:267116)在根节点上直接给出了整数最优解，从而避免了任何分支的需要 ([@problem_id:3104213])。

### [割平面](@entry_id:177960)的基本思想：从[多面体](@entry_id:637910)到整数包

上述例子揭示了[割平面](@entry_id:177960)的核心思想，我们可以用[多面体几何](@entry_id:163286)的语言将其形式化。一个[整数规划](@entry_id:178386)问题的[可行解](@entry_id:634783)集是高维空间中的一组离散点，我们记为 $S$。其[LP松弛](@entry_id:267116)的可行域则是一个**[多面体](@entry_id:637910) (polyhedron)**，记为 $P$，它包含了所有的整数点 $S$。我们的目标是在 $S$ 上最大化一个线性函数，而我们能高效求解的是在 $P$ 上的最大化问题。

所有整数可行点的**[凸包](@entry_id:262864) (convex hull)**，记为 $P_I = \text{conv}(S)$，被称为**整数包 (integer hull)**。整数包是包含 $S$ 的最小凸集。一个重要的理论是，在一个多面体上优化一个线性函数，其最优解一定可以在该[多面体的顶点](@entry_id:635258)上找到。由于 $P_I$ 的所有顶点都来自于整数点集 $S$，因此在 $P_I$ 上求解LP得到的最优解一定是整数的。这意味着，如果我们能得到描述 $P_I$ 的所有[线性不等式](@entry_id:174297)，我们就可以通过求解一个LP来精确地解决原来的[整数规划](@entry_id:178386)问题。

不幸的是，为一般[整数规划](@entry_id:178386)问题找到整数包 $P_I$ 的完整描述是极其困难的（通常和解决原问题一样难）。因此，[割平面](@entry_id:177960)方法的目标就不是一步登天，而是通过迭代地添加[有效不等式](@entry_id:170492)来**逼近**整数包。每一个[割平面](@entry_id:177960)都像一把“刀”，从松弛[多面体](@entry_id:637910) $P$ 上切掉一块不包含任何整数解的区域，从而得到一个更紧的、更好地近似 $P_I$ 的新[多面体](@entry_id:637910)。

一个简单的例子可以阐明这一过程。考虑这样一个二进制[整数规划](@entry_id:178386)问题：最大化 $x_1 + x_2 + x_3$，约束为 $2x_1 + 2x_2 + 2x_3 \le 3$ 且 $x_i \in \{0,1\}$ ([@problem_id:3104253])。任何满足约束的整数解，其变量之和 $x_1 + x_2 + x_3$ 必须是一个不大于 $1.5$ 的整数，即最多为1。因此，该问题的整数包由不等式 $x_1+x_2+x_3 \le 1$ 和变量界限 $x_i \ge 0$ 所定义。然而，其[LP松弛](@entry_id:267116)允许 $x_1+x_2+x_3 \le 1.5$，最优LP解可以是 $(0.5, 0.5, 0.5)$，目标值为1.5。通过应用一种名为[Chvátal-Gomory割](@entry_id:634739)平面的生成技术，我们可以从原始约束 $2x_1 + 2x_2 + 2x_3 \le 3$ 系统地推导出[割平面](@entry_id:177960) $x_1 + x_2 + x_3 \le 1$。将这个[割平面](@entry_id:177960)添加到[LP松弛](@entry_id:267116)中，就使得松弛[多面体](@entry_id:637910)与整数包完全重合，从而在第一步就解决了问题。所有可能的[Chvátal-Gomory割](@entry_id:634739)平面的交集所定义的多面体，被称为**Chvátal-Gomory闭包 (Chvátal-Gomory closure)**，它给出了对整数包的一种理论上的近似。

### 通用[割平面](@entry_id:177960)生成机制

虽然如团不等式这样的专用[割平面](@entry_id:177960)非常强大，但它们的推导依赖于对特定问题（如稳定集问题）组合结构的深刻理解。在求解通用MILP时，我们需要不依赖于特定问题结构的**通用[割平面](@entry_id:177960) (general-purpose cuts)**。

#### Chvátal-Gomory (CG) [割平面](@entry_id:177960)

[Chvátal-Gomory割](@entry_id:634739)平面是最早也是最基础的通用[割平面](@entry_id:177960)之一。其生成过程基于一个简单的原理：
1.  取现有约束的一个非负[线性组合](@entry_id:154743)，形成一个新的[有效不等式](@entry_id:170492) $\pi^\top A x \le \pi^\top b$。
2.  由于 $x$ 的分量是整数，如果新不等式左侧的系数 $\pi^\top A$ 也都是整数，那么左侧的值也必然是整数。
3.  因此，这个整数值必须小于或等于右侧值 $\pi^\top b$ 向下取整后的结果，即 $\lfloor \pi^\top b \rfloor$。

更一般地，对于任意非负的乘子向量 $\pi$，我们可以得到一个有效的CG[割平面](@entry_id:177960) $\lfloor \pi^\top A \rfloor x \le \lfloor \pi^\top b \rfloor$。

让我们通过一个[集合覆盖问题](@entry_id:275583)的例子 [@problem_id:3104275] 来看看CG[割平面](@entry_id:177960)的具体生成。假设我们有约束 $A x \ge \mathbf{1}$，其中 $A = \begin{pmatrix} 1  0  1  0 \\ 1  1  0  0 \\ 0  1  1  1 \end{pmatrix}$ 且 $x \in \{0,1\}^4$。我们选择乘子向量 $\pi = (\frac{1}{2}, \frac{1}{2}, \frac{1}{4})^\top$。首先，我们将所有不等式写成“小于等于”形式：$-A x \le -\mathbf{1}$。然后与 $\pi$ 做线性组合得到 $\pi^\top (-A) x \le \pi^\top (-\mathbf{1})$。这等价于 $\pi^\top A x \ge \pi^\top \mathbf{1}$。
计算可得：
$\pi^\top A = (1, \frac{3}{4}, \frac{3}{4}, \frac{1}{4})$
$\pi^\top \mathbf{1} = \frac{1}{2} + \frac{1}{2} + \frac{1}{4} = \frac{5}{4}$
我们得到的组合不等式是 $1 x_1 + \frac{3}{4} x_2 + \frac{3}{4} x_3 + \frac{1}{4} x_4 \ge \frac{5}{4}$。
由于 $x_j$ 是整数，左侧的表达式不必是整数。但我们可以对左侧系数向上取整，得到一个必然大于等于原左侧的整数表达式：$\lceil 1 \rceil x_1 + \lceil \frac{3}{4} \rceil x_2 + \lceil \frac{3}{4} \rceil x_3 + \lceil \frac{1}{4} \rceil x_4 = x_1+x_2+x_3+x_4$。这个整数表达式必然大于等于右侧的 $\frac{5}{4}$。一个大于等于 $\frac{5}{4}$ 的整数，最小也得是 $\lceil \frac{5}{4} \rceil = 2$。因此，我们得到了一个有效的CG[割平面](@entry_id:177960)：$x_1 + x_2 + x_3 + x_4 \ge 2$。这个新的不等式可以被加入到[LP松弛](@entry_id:267116)中以收紧[可行域](@entry_id:136622)。

#### 混合整数舍入 (MIR) 与 Gomory 混合整数 (GMI) [割平面](@entry_id:177960)

对于包含连续变量和整数变量的混合整数问题，CG[割平面](@entry_id:177960)的思想可以被推广，从而产生了更为强大的**混合整数舍入 (Mixed-Integer Rounding, MIR)** 和 **Gomory混合整数 (Gomory Mixed-Integer, GMI)** [割平面](@entry_id:177960)。这些是现代MILP求解器中最重要的通用[割平面](@entry_id:177960)。

它们通常从[LP松弛](@entry_id:267116)的单纯形表中的某一行推导出来，该行表达了一个基本变量（可以是整数或连续的）与其他非基本变量（同样，可以是整数或连续的）之间的关系。其核心思想是利用整数变量必须取整数值这一事实，对约束中的系数和常数项进行巧妙的“舍入”操作，从而推导出新的[有效不等式](@entry_id:170492)。

考虑一个典型的单约束混合整数集：$\sum_{i=1}^n a_i x_i + y \le b$，其中 $x \in \{0,1\}^n$ 是[二元变量](@entry_id:162761)，$y \ge 0$ 是一个连续[松弛变量](@entry_id:268374) [@problem_id:3104199]。MIR[割平面](@entry_id:177960)的推导过程如下：令 $f = b - \lfloor b \rfloor$ 为右端项 $b$ 的小数部分。对于每个系数 $a_i$，也将其分解为整数和小数部分 $a_i = \lfloor a_i \rfloor + r_i$。MIR[割平面](@entry_id:177960) $\sum_{i=1}^n \alpha_i x_i + \alpha_y y \le \lfloor b \rfloor$ 的系数 $\alpha_i$ 和 $\alpha_y$ 将根据 $r_i$ 与 $f$ 的关系来确定。例如，当 $f > 0$ 时，如果一个系数的小数部分 $r_i$ 不超过 $f$，则其在[割平面](@entry_id:177960)中的系数就直接向下取整为 $\lfloor a_i \rfloor$；而如果 $r_i$ 大于 $f$，其系数则会得到一个“惩罚项”，变为 $\lfloor a_i \rfloor + \frac{r_i - f}{1 - f}$。这个构造精妙地平衡了约束，确保了不等式对所有整数可行解都有效，同时又能切除那些过度依赖具有较大“小数部分”的变量的[LP松弛](@entry_id:267116)解。GMI[割平面](@entry_id:177960)在很多情况下，尤其是从此类单行约束推导时，与MIR[割平面](@entry_id:177960)是等价的。

#### 分裂割 (Split Cuts)

分裂割是另一类非常重要的通用[割平面](@entry_id:177960)，其思想与分支操作紧密相关。它的基础是**析取 (disjunction)**。对于任何一个整数变量 $x_j$ 和一个整数值 $\delta$，必然有 $x_j \le \delta$ 或 $x_j \ge \delta+1$ 成立。更一般地，对于一个整数表达式 $\pi^\top x$（其中 $\pi$ 是整数向量），必然有 $\pi^\top x \le \delta$ 或 $\pi^\top x \ge \delta+1$ 成立。这个“二选一”的逻辑就是一个**分裂析取 (split disjunction)**。

虽然析取本身不是一个[线性约束](@entry_id:636966)，但我们可以断言，任何可行的整数解都必须位于由这两个不等式所定义的两个分离的半空间之一。一个**分裂割 (split cut)** 就是任何对于这两个半空间与原有多面体交集的并集的凸包都有效的[线性不等式](@entry_id:174297)。

一个特别直观的情形是，当析取的一个分支是不可行的时候 [@problem_id:3104209]。假设我们有一个[LP松弛](@entry_id:267116)解 $x^*$ 使得 $\pi^\top x^*$ 是小数，令 $\delta = \lfloor \pi^\top x^* \rfloor$。我们知道任何整数解必须满足 $\pi^\top x \le \delta$ 或 $\pi^\top x \ge \delta+1$。如果我们能证明，在[LP松弛](@entry_id:267116)的可行域内，$\pi^\top x \ge \delta+1$ 这个分支是空的（即不存在满足该条件的LP可行解），那么所有整数[可行解](@entry_id:634783)就必须位于 $\pi^\top x \le \delta$ 这个分支中。在这种情况下，不等式 $\pi^\top x \le \delta$ 本身就成了一个有效的[割平面](@entry_id:177960)，它可以切除当前的[LP松弛](@entry_id:267116)解 $x^*$，因为 $x^*$ 满足 $\pi^\top x^* > \delta$。这个例子完美地揭示了分支和切割之间的深刻联系：一个分支选择（析取）有时可以直接导出一个切割操作。

### 专用[割平面](@entry_id:177960)：利用问题结构

尽管通用[割平面](@entry_id:177960)适用性广，但在解决具有特定组合结构的问题时，利用该结构推导出的**专用[割平面](@entry_id:177960) (problem-specific cuts)** 通常会表现出更强的切割能力。

#### [覆盖不等式](@entry_id:634882)与提升

对于经典的[0-1背包问题](@entry_id:262564)或任何包含背包类型约束的MILP，**[覆盖不等式](@entry_id:634882) (cover inequalities)** 是一类非常重要的专用[割平面](@entry_id:177960)。一个**覆盖 (cover)** $C$ 是指一组物品（变量），如果将它们全部选入背包（即对应的变量都取1），它们的总重量将超过背包容量。

如果集合 $C$ 是一个覆盖，那么我们显然不能同时选择 $C$ 中的所有物品。这可以直接转化为一个有效的[线性不等式](@entry_id:174297)：$\sum_{i \in C} x_i \le |C| - 1$。这就是最基本的[覆盖不等式](@entry_id:634882)。

然而，这个基本不等式只涉及覆盖内的变量，其强度有限。我们可以通过一个称为**提升 (lifting)** 的过程来强化它。提升的思想是将覆盖外的变量也引入到不等式中。对于一个不在覆盖 $C$ 内的变量 $x_j$，我们可以为其计算一个系数 $\alpha_j$，得到一个更强的**提升[覆盖不等式](@entry_id:634882) (lifted cover inequality)**:
$$ \sum_{i \in C} x_i + \alpha_j x_j \le |C| - 1 $$
系数 $\alpha_j$ 的计算原则是：在保证不等式有效性的前提下，使其值尽可能大。这通常通过解决一个子问题来实现：假设我们选择物品 $j$（即 $x_j=1$），然后计算在剩余容量下，我们最多还能从覆盖 $C$ 中选择多少个物品。假设这个最大数量是 $b_j$。那么为了维持不等式的有效性，当 $x_j=1$ 时，不等式左侧 $\sum_{i \in C} x_i$ 的值不能超过 $b_j$。代入提升不等式得到 $b_j + \alpha_j \le |C|-1$，因此 $\alpha_j$ 的最大[有效值](@entry_id:276804)就是 $|C|-1-b_j$。

这个过程可以推广到更复杂的情况，例如带有额外惩罚项的二次背包问题 [@problem_id:3104222]。通过枚举或优化来计算提升系数，我们可以从一个简单的[覆盖不等式](@entry_id:634882)逐步生成一个对[多面体](@entry_id:637910)有深刻切割效果的强不等式。

#### 混合整数问题的扩展

在更广泛的混合整数问题中，许多[割平面](@entry_id:177960)都源于对整数变量和连续变量之间相互作用的精细分析。例如，在一个带有模块化容量的[设施选址问题](@entry_id:172318)中 [@problem_id:3104231]，假设一个设施的容量由 $y$ 个容量为 $Q=5$ 的模块提供，其中 $y$ 是整数变量。该设施服务一组需求均为 $d_j=4$ 的客户 $x_j \in \{0,1\}$。容量约束为 $4\sum x_j \le 5y$。如果在分支树的某个节点上，我们有 $y \le 2$ 的界限，那么对于任何整数[可行解](@entry_id:634783)，$y$ 只能取 $\{0,1,2\}$，最大容量为 $5 \times 2 = 10$。这意味着最多能服务的客户数量为 $\lfloor 10/4 \rfloor = 2$。于是，我们得到了一个有效的**多覆盖[割平面](@entry_id:177960) (multiple cover cut)**: $\sum x_j \le 2$。

有趣的是，如果我们只考虑[LP松弛](@entry_id:267116)，其中 $y$ 可以取 $[0,2]$ 内的任意实数，那么从 $4\sum x_j \le 5y$ 和 $y \le 2$ 我们只能推断出 $4\sum x_j \le 5 \times 2 = 10$，即 $\sum x_j \le 2.5$。[割平面](@entry_id:177960) $\sum x_j \le 2$ 比[LP松弛](@entry_id:267116)本身蕴含的 $\sum x_j \le 2.5$ 要严格得多，它精确地利用了变量 $y$ 的**整数性**来收紧可行域。

### 分支与割的协同：完整的算法

[分支切割](@entry_id:174657)法将分支定界和[割平面](@entry_id:177960)生成这两种策略优雅地结合在一起。其算法流程通常如下：
在分支定界树的每个节点：
1.  求解当前节点的[LP松弛](@entry_id:267116)。
2.  如果LP解是整数的，则该节点得到一个可行解，可以进行剪枝或更新最优解。
3.  如果LP解是小数（非整数），则进入**[割平面](@entry_id:177960)循环 (cutting loop)**：
    a.  调用一个或多个**分离程序 (separation routines)**，尝试寻找违反当前LP解的[有效不等式](@entry_id:170492)（[割平面](@entry_id:177960)）。
    b.  如果找到了一个或多个[割平面](@entry_id:177960)，将它们加入到[LP模](@entry_id:170761)型中，然后返回步骤1重新求解。
    c.  如果没有找到有用的[割平面](@entry_id:177960)，则退出[割平面](@entry_id:177960)循环。
4.  如果退出[割平面](@entry_id:177960)循环后LP解仍然是小数，则选择一个小数变量进行**分支 (branching)**，创建两个新的子节点，并将它们加入到待处理的节点队列中。

#### 理想情况：在根节点终止

[割平面](@entry_id:177960)最理想的效果是在分支定界树的根节点就将[整数规划](@entry_id:178386)间隙完全闭合。这意味着，通过在根节点不断添加[割平面](@entry_id:177960)，我们最终得到的增强[LP松弛](@entry_id:267116)的解恰好是一个整数解。由于这个解是在未做任何分支的情况下得到的，它既是根节点LP的最优解，也是整个MIL[P问题](@entry_id:267898)的最优解。此时，算法就可以在根节点处终止，无需进行任何分支。

一个简单的例子可以说明这一点 [@problem_id:3104280]。考虑最大化 $7x+3y$，约束为 $2x+y \le 5$，$x \in \mathbb{Z}_+$，$y \ge 0$。其[LP松弛](@entry_id:267116)的最优解是 $(x,y)=(2.5, 0)$，目标值为17.5，是小数解。然而，从 $2x+y \le 5$ 和 $y \ge 0$ 我们可以推断出 $2x \le 5$，即 $x \le 2.5$。因为 $x$ 必须是整数，所以一个有效的MIR[割平面](@entry_id:177960)是 $x \le 2$。将这个[割平面](@entry_id:177960)加入[LP松弛](@entry_id:267116)后，新的最优解变为 $(x,y)=(2, 1)$，目标值为17。这个解对于原MILP是可行的（$x=2$ 是整数），且其目标值等于增强后LP给出的[上界](@entry_id:274738)。因此，$(2,1)$ 就是原MILP的最优解，整个问题在根节点就被解决了。

#### 实践中的[割平面](@entry_id:177960)管理：优势与[割平面](@entry_id:177960)池

在实际的求解器中，分离程序可能会生成成百上千个潜在的[割平面](@entry_id:177960)。将所有[割平面](@entry_id:177960)都加入[LP模](@entry_id:170761)型会使模型变得异常庞大，导致LP求解时间急剧增加，从而抵消了[割平面](@entry_id:177960)带来的好处。因此，对[割平面](@entry_id:177960)进行有效管理至关重要。

求解器通常维护一个**[割平面](@entry_id:177960)池 (cut pool)** 来存储已生成的[割平面](@entry_id:177960)。在向[LP模](@entry_id:170761)型添加[割平面](@entry_id:177960)之前，会进行筛选。一个关键的筛选标准是**优势 (dominance)**。如果一个[割平面](@entry_id:177960) $C_1: \alpha^{(1)} x \le \beta^{(1)}$ 能够推导出另一个[割平面](@entry_id:177960) $C_2: \alpha^{(2)} x \le \beta^{(2)}$（即满足 $C_1$ 的所有可行点都满足 $C_2$），我们就说 $C_1$ **主导 (dominates)** $C_2$。在这种情况下，$C_2$ 就是冗余的，可以从池中移除或不予添加。

检查[优势关系](@entry_id:156670)本身也需要计算成本。理论上，要检查 $C_1$是否主导 $C_2$，需要求解一个辅助LP：在满足 $C_1$ 和变量界限的条件下，最大化 $\alpha^{(2)} x$。如果得到的最大值不大于 $\beta^{(2)}$，则[优势关系](@entry_id:156670)成立 [@problem_id:3104164]。这引出了一个权衡：花费时间进行优势检查可以保持[割平面](@entry_id:177960)池的精简和高效，从而加速后续的LP求解；但如果检查本身过于频繁和昂贵，则可能得不偿失。现代求解器采用复杂的启发式策略来管理这个过程。

### 何时不需要[割平面](@entry_id:177960)？具有整数性的多面体

最后，我们必须认识到，[割平面](@entry_id:177960)虽然强大，但并非总是必需的。在某些特殊情况下，一个[整数规划](@entry_id:178386)问题的初始[LP松弛](@entry_id:267116)本身就具有**整数性 (integrality)**，即其所有顶点都是整数点。

这一现象最经典的理论基础是**[全幺模性](@entry_id:635632) (Total Unimodularity, TU)**。如果一个整数矩阵 $A$ 的每个方子矩阵的行列式都在 $\{-1, 0, 1\}$ 中，则称 $A$ 是全幺模的。一个重要的定理指出：如果一个LP的可行域由 $Ax \le b, x \ge 0$ 定义，其中 $A$ 是全[幺模矩阵](@entry_id:148345)且 $b$ 是整数向量，那么该LP的所有极点（顶点）都是整数的。

这意味着，对于这类问题，求解[LP松弛](@entry_id:267116)总能得到一个整数解，这个解也必然是原[整数规划](@entry_id:178386)问题的最优解。因此，[整数规划](@entry_id:178386)间隙为零，分支和切割都变得毫无必要。

一个典型的例子是二分图上的最大权[匹配问题](@entry_id:275163) [@problem_id:3104242]。该问题的[LP松弛](@entry_id:267116)的约束矩阵是图的[关联矩阵](@entry_id:263683)，而二分图的[关联矩阵](@entry_id:263683)恰好是全幺模的。因此，我们总能通过求解一个LP来高效地解决[二分图](@entry_id:262451)的最大权[匹配问题](@entry_id:275163)。在这种情况下，尝试生成和添加[割平面](@entry_id:177960)（例如，用于[一般图匹配](@entry_id:271156)问题的奇集不等式）是多余的。可以证明，在[二分图](@entry_id:262451)的背景下，这些[割平面](@entry_id:177960)实际上已经被原始的度约束所蕴含，因此它们不会对[LP松弛](@entry_id:267116)的[可行域](@entry_id:136622)产生任何改变。

理解这些具有“天然”整数性的问题结构，不仅能让我们在遇到它们时选择最高效的算法，也让我们更深刻地认识到，[割平面](@entry_id:177960)的真正价值在于处理那些[LP松弛](@entry_id:267116)与整数包之间存在本质差异的、更具挑战性的问题。