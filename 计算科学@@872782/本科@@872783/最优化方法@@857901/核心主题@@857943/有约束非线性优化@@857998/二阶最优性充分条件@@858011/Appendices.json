{"hands_on_practices": [{"introduction": "一个函数在整个空间上可能非凸，甚至具有“坏”的曲率（例如，鞍点），但这并不意味着它在约束条件下没有最小值。约束条件将我们的视线限制在可行集的一个子空间上，在这个子空间上，函数的曲率可能变得“良好”（即正定）。本练习 [@problem_id:3176387] 将通过一个二次规划问题清晰地展示这一核心思想，其中目标函数的Hessian矩阵是不定的，但在约束的切空间上却变为正定。", "problem": "考虑一个三维等式约束二次规划问题，其目标函数 $f:\\mathbb{R}^{3}\\to\\mathbb{R}$ 为\n$$\nf(x) \\;=\\; \\frac{1}{2}\\,x^{\\top}Qx \\;+\\; c^{\\top}x,\n$$\n其中\n$$\nQ \\;=\\; \\begin{pmatrix} 1  0  0 \\\\ 0  -1  0 \\\\ 0  0  2 \\end{pmatrix}, \n\\qquad\nc \\;=\\; \\begin{pmatrix} 1 \\\\ -2 \\\\ 3 \\end{pmatrix}.\n$$\n施加单线性等式约束\n$$\nA x \\;=\\; b, \n\\qquad \nA \\;=\\; \\begin{pmatrix} 0  1  0 \\end{pmatrix}, \n\\qquad \nb \\;=\\; 1.\n$$\n仅使用基本定义——即约束局部极小点的定义、可行方向和切空间的概念（此处由一阶约束线性化定义）、$f$ 的二阶泰勒展开式，以及 Karush-Kuhn-Tucker (KKT) 最优性条件——完成以下任务：\n\n1) 通过分析其特征值，确定对称矩阵 $Q$ 是不定的。\n\n2) 通过对约束进行线性化并刻画切空间 $\\{d \\in \\mathbb{R}^{3} : A d = 0\\}$，确定在任意可行点 $\\bar{x}$ 处的可行方向集合 $d$。\n\n3) 证明对于在第 2 部分中确定的所有非零可行方向 $d$，二次型 $d^{\\top}Qd$ 都是严格正的，并解释尽管 $Q$ 在 $\\mathbb{R}^{3}$ 中是不定的，但这如何在可行方向上强制产生正曲率。\n\n4) 从约束局部极小点的定义和拉格朗日函数出发，推导等式约束问题的一阶平稳条件，并求解得到的线性系统以获得候选最优点 $x^{\\star}$。\n\n5) 利用 $f$ 沿可行方向的二阶泰勒展开以及你在第 3 部分得到的结果，论证你的候选点满足二阶充分最优性条件，从而证明 $x^{\\star}$ 是一个严格局部极小点。\n\n你的最终答案必须是使用圆括号矩阵表示法写成的单个行向量形式的最优点 $x^{\\star}$。请给出精确答案，无需四舍五入。", "solution": "所述问题在数学上是适定的、内部一致的，并且没有任何科学或事实上的不准确之处。所有必要信息都已提供，可以确定唯一解。因此，我们可以按照要求进行完整推导。求解过程将遵循指定的五个步骤。\n\n问题是为目标函数 $f:\\mathbb{R}^{3}\\to\\mathbb{R}$ 寻找一个严格局部极小点，\n$$f(x) = \\frac{1}{2}x^{\\top}Qx + c^{\\top}x$$\n其中\n$$Q = \\begin{pmatrix} 1  0  0 \\\\ 0  -1  0 \\\\ 0  0  2 \\end{pmatrix}, \\quad c = \\begin{pmatrix} 1 \\\\ -2 \\\\ 3 \\end{pmatrix}$$\n该问题受线性等式约束 $Ax=b$ 的限制，其中\n$$A = \\begin{pmatrix} 0  1  0 \\end{pmatrix}, \\quad b = 1$$\n\n1) 我们首先确定对称矩阵 $Q$ 是不定的。如果一个对称矩阵至少有一个正特征值和至少一个负特征值，则它是不定的。矩阵 $Q$ 是一个对角矩阵，因此其特征值就是其对角线元素。特征值为 $\\lambda_1 = 1$，$\\lambda_2 = -1$ 和 $\\lambda_3 = 2$。由于 $\\lambda_1$ 和 $\\lambda_3$ 是正的，而 $\\lambda_2$ 是负的，根据定义，矩阵 $Q$ 是不定的。这意味着二次函数 $f(x)$ 是非凸的，并且在 $\\mathbb{R}^{3}$ 中既有正曲率也有负曲率。具体来说，二次型 $x^{\\top}Qx$ 是一个鞍形。\n\n2) 接下来，我们确定在任意可行点 $\\bar{x}$ 处的可行方向集合。如果一个点 $\\bar{x}$ 满足约束 $A\\bar{x} = b$，则该点是可行的。对于线性等式约束，任意可行点的可行方向集合就是切空间，该切空间对所有可行点都是相同的。如果对于一个可行点 $\\bar{x}$，点 $\\bar{x}+\\alpha d$ 对所有足够小的标量 $\\alpha$ 也满足约束，那么方向 $d \\in \\mathbb{R}^{3}$ 是一个可行方向。这要求 $A(\\bar{x}+\\alpha d) = b$。展开此式得到 $A\\bar{x} + \\alpha Ad = b$。由于 $\\bar{x}$ 是可行的，有 $A\\bar{x} = b$，该条件简化为 $\\alpha Ad = 0$。为了使此式对任意非零 $\\alpha$ 成立，我们必须有 $Ad=0$。因此，可行方向的集合是矩阵 $A$ 的零空间。\n给定 $A = \\begin{pmatrix} 0  1  0 \\end{pmatrix}$，我们通过求解 $Ad=0$ 来找到零空间：\n$$ \\begin{pmatrix} 0  1  0 \\end{pmatrix} \\begin{pmatrix} d_1 \\\\ d_2 \\\\ d_3 \\end{pmatrix} = 0 $$\n这个方程简化为 $d_2 = 0$。分量 $d_1$ 和 $d_3$ 可以是任意实数。因此，代表所有可行方向集合的切空间是\n$$ T = \\{ d \\in \\mathbb{R}^{3} \\mid Ad = 0 \\} = \\left\\{ \\begin{pmatrix} d_1 \\\\ 0 \\\\ d_3 \\end{pmatrix} \\mid d_1, d_3 \\in \\mathbb{R} \\right\\} $$\n这是 $\\mathbb{R}^{3}$ 的一个二维子空间，由基向量 $\\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$ 和 $\\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}$ 张成。\n\n3) 现在我们考察目标函数在这些可行方向上的曲率。这由二次型 $d^{\\top}Qd$ 对任意非零可行方向 $d \\in T$ 的符号决定。设 $d$ 是切空间中的一个非零向量，因此 $d = \\begin{pmatrix} d_1 \\\\ 0 \\\\ d_3 \\end{pmatrix}$，其中 $d_1$ 和 $d_3$ 不全为零。我们计算 $d^{\\top}Qd$：\n$$ d^{\\top}Qd = \\begin{pmatrix} d_1  0  d_3 \\end{pmatrix} \\begin{pmatrix} 1  0  0 \\\\ 0  -1  0 \\\\ 0  0  2 \\end{pmatrix} \\begin{pmatrix} d_1 \\\\ 0 \\\\ d_3 \\end{pmatrix} $$\n$$ = \\begin{pmatrix} d_1  0  2d_3 \\end{pmatrix} \\begin{pmatrix} d_1 \\\\ 0 \\\\ d_3 \\end{pmatrix} = d_1^2 + 2d_3^2 $$\n由于 $d_1, d_3 \\in \\mathbb{R}$，我们有 $d_1^2 \\ge 0$ 和 $2d_3^2 \\ge 0$。和 $d_1^2 + 2d_3^2$ 为零当且仅当 $d_1 = 0$ 且 $d_3 = 0$，这对应于零向量 $d=0$。由于我们考虑的是非零可行方向，因此有 $d_1^2 + 2d_3^2  0$。这表明二次型 $d^{\\top}Qd$ 对所有非零可行方向都是严格正的。这意味着目标函数的黑塞矩阵 $Q$ 在切空间 $T$ 上是正定的。与特征值 $\\lambda_2 = -1$ 相关的负曲率对应于 $x_2$ 方向。然而，约束 $Ax=b$（即 $x_2=1$）将可行点限制在一个平面上，并将可行方向限制在第二个分量为零的子空间中。这有效地中和了负曲率的方向，使得在所有允许的移动方向上只剩下正曲率。\n\n4) 我们推导并求解一阶最优性必要条件，即等式约束下的 Karush-Kuhn-Tucker (KKT) 条件。我们定义拉格朗日函数 $L(x, \\lambda) = f(x) - \\lambda (Ax - b)$，其中 $\\lambda$ 是标量拉格朗日乘子。\n$$ L(x, \\lambda) = \\frac{1}{2}x^{\\top}Qx + c^{\\top}x - \\lambda(A x - b) $$\n点 $x^{\\star}$ 成为局部极小点的一阶必要条件是存在一个乘子 $\\lambda^{\\star}$，使得拉格朗日函数对 $x$ 的梯度为零，并且该点是可行的：\n$$ \\nabla_x L(x^{\\star}, \\lambda^{\\star}) = Qx^{\\star} + c - A^{\\top}\\lambda^{\\star} = 0 $$\n$$ Ax^{\\star} - b = 0 $$\n代入给定的矩阵和向量，我们得到一个线性方程组：\n$$ \\begin{pmatrix} 1  0  0 \\\\ 0  -1  0 \\\\ 0  0  2 \\end{pmatrix} \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\end{pmatrix} + \\begin{pmatrix} 1 \\\\ -2 \\\\ 3 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} \\lambda = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n$$ \\begin{pmatrix} 0  1  0 \\end{pmatrix} \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\end{pmatrix} = 1 $$\n可行性约束 $Ax=b$ 给出 $x_2 = 1$。梯度方程产生一个包含三个标量方程的系统：\n1) $x_1 + 1 = 0 \\implies x_1 = -1$\n2) $-x_2 - 2 - \\lambda = 0$\n3) $2x_3 + 3 = 0 \\implies x_3 = -\\frac{3}{2}$\n将 $x_2=1$ 代入第二个方程，可以求出乘子 $\\lambda$：\n$-1 - 2 - \\lambda = 0 \\implies \\lambda = -3$。\n候选最优点是点 $x^{\\star}$，其分量为 $x_1 = -1$, $x_2 = 1$, 和 $x_3 = -\\frac{3}{2}$。\n$$ x^{\\star} = \\begin{pmatrix} -1 \\\\ 1 \\\\ -\\frac{3}{2} \\end{pmatrix} $$\n\n5) 最后，我们使用二阶充分条件（SOSC）来验证 $x^{\\star}$ 是一个严格局部极小点。对于等式约束，如果在 KKT 点 $(x^{\\star}, \\lambda^{\\star})$，拉格朗日函数关于 $x$ 的黑塞矩阵在 $x^{\\star}$ 处的取值在切空间 $T(x^{\\star})$ 上是正定的，那么二阶充分条件就得到满足。也就是说，对于所有非零的 $d \\in T(x^{\\star})$，都有 $d^{\\top} \\nabla_{xx}^2 L(x^{\\star}, \\lambda^{\\star}) d  0$。\n拉格朗日函数的黑塞矩阵是 $\\nabla_{xx}^2 L(x, \\lambda) = Q$。\n因此，SOSC 要求对于所有满足 $Ad=0$ 的非零 $d$，都有 $d^{\\top}Qd  0$。这恰好是我们在第 3 部分验证的条件。我们证明了对于任意 $d \\in T, d \\neq 0$，二次型计算结果为 $d^{\\top}Qd = d_1^2 + 2d_3^2  0$。\n为了理解这为何能保证一个严格局部最小值，我们考虑 $f(x)$ 在 $x^{\\star}$ 点沿可行方向 $d \\in T$ 的泰勒展开。对于一个点 $x = x^{\\star} + \\alpha d$，其中 $\\alpha \\in \\mathbb{R}$：\n$$ f(x^{\\star}+\\alpha d) - f(x^{\\star}) = \\alpha \\nabla f(x^{\\star})^{\\top}d + \\frac{1}{2}\\alpha^2 d^{\\top} \\nabla^2 f(x^{\\star}) d + o(\\alpha^2) $$\n根据 KKT 条件 $\\nabla_x L(x^{\\star}, \\lambda^{\\star}) = 0$，我们有 $\\nabla f(x^{\\star}) = A^{\\top}\\lambda^{\\star}$。一阶项是 $\\alpha (A^{\\top}\\lambda^{\\star})^{\\top}d = \\alpha (\\lambda^{\\star})^{\\top} (Ad)$。由于 $d \\in T$，我们有 $Ad=0$，所以一阶项消失。展开式变为：\n$$ f(x^{\\star}+\\alpha d) - f(x^{\\star}) = \\frac{1}{2}\\alpha^2 d^{\\top} Q d + o(\\alpha^2) $$\n正如已证实的，对于任意非零 $d \\in T$，都有 $d^{\\top}Qd  0$。因此，对于任意非零 $\\alpha$，项 $\\frac{1}{2}\\alpha^2 d^{\\top} Q d$ 是严格正的。当 $\\alpha$ 足够小时，这个二阶项将主导高阶项 $o(\\alpha^2)$，这意味着 $f(x^{\\star}+\\alpha d) - f(x^{\\star})  0$。这对任何可行方向 $d$ 都成立。因此，$x^{\\star}$ 是一个严格局部极小点。候选点 $x^{\\star} = \\begin{pmatrix} -1 \\\\ 1 \\\\ -\\frac{3}{2} \\end{pmatrix}$ 被确认为该约束问题的一个严格局部极小点。", "answer": "$$\\boxed{\\begin{pmatrix} -1  1  -\\frac{3}{2} \\end{pmatrix}}$$", "id": "3176387"}, {"introduction": "理解了约束如何改变有效曲率的概念之后，我们可以将这套分析方法应用于更一般的非线性问题。这个练习 [@problem_id:3176416] 旨在实践完整的分析流程：从求解KKT点，到构建约束雅可比矩阵的零空间基，再到计算降阶Hessian矩阵。通过这个例子，你将熟练掌握在等式约束下检验二阶充分条件的标准步骤。", "problem": "考虑一个等式约束优化问题，其目标函数为 $f:\\mathbb{R}^{2}\\to\\mathbb{R}$，由 $f(x)=\\exp(x_{1})+x_{2}^{2}$ 给出；其约束函数为 $g:\\mathbb{R}^{2}\\to\\mathbb{R}$，由 $g(x)=x_{1}+x_{2}$ 给出。可行集为 $\\{x\\in\\mathbb{R}^{2}:g(x)=0\\}$。请仅从等式约束的一阶 Karush–Kuhn–Tucker (KKT) 条件（可行性和平稳性）的核心定义以及沿切空间（缩减 Hessian 矩阵）的二阶曲率概念出发，完成以下任务：\n\n- 确定唯一的 KKT 点 $(x^{\\star},\\lambda^{\\star})$。\n- 为在 $x^{\\star}$ 处的约束雅可比矩阵的零空间构建一个标准正交基，并用它来构成在 $x^{\\star}$ 处的拉格朗日函数的缩减 Hessian 矩阵（一个标量）。\n- 利用此标量缩减 Hessian 矩阵，评估严格局部最小值的二阶充分条件是否成立，并定性解释由指数项 $\\exp(x_{1})$ 贡献的曲率如何与来自 $x_{2}^{2}$ 的二次曲率在切线方向上相互作用。\n\n请以封闭形式给出在使用标准正交零空间基时，KKT 点处标量缩减 Hessian 矩阵的精确值。不要对答案进行近似或四舍五入。最终答案必须是单一的解析表达式。", "solution": "该问题是约束优化领域中一个适定、有科学依据且客观的问题。它自成体系，提供了所有必要的定义和函数，并要求使用 Karush–Kuhn–Tucker (KKT) 条件和二阶充分条件进行标准分析。其中没有矛盾、歧义或违反数学原理之处。\n\n该优化问题是在约束 $g(x) = x_{1} + x_{2} = 0$ 下，最小化 $f(x) = \\exp(x_{1}) + x_{2}^{2}$。\n\n首先，我们定义拉格朗日函数 $L(x, \\lambda)$：\n$$L(x_1, x_2, \\lambda) = f(x_1, x_2) - \\lambda g(x_1, x_2) = \\exp(x_{1}) + x_{2}^{2} - \\lambda(x_{1} + x_{2})$$\n\n对于一个点 $x^{\\star}$ 和一个拉格朗日乘子 $\\lambda^{\\star}$，一阶最优性必要条件（KKT 条件）是：\n1.  **可行性**：$g(x^{\\star}) = 0$\n2.  **平稳性**：$\\nabla_x L(x^{\\star}, \\lambda^{\\star}) = 0$\n\n从这些条件中，我们推导出以下方程组：\n$$x_{1} + x_{2} = 0 \\quad (1)$$\n$$\\frac{\\partial L}{\\partial x_{1}} = \\exp(x_{1}) - \\lambda = 0 \\quad (2)$$\n$$\\frac{\\partial L}{\\partial x_{2}} = 2x_{2} - \\lambda = 0 \\quad (3)$$\n\n由方程 $(2)$ 和 $(3)$，我们得到 $\\lambda = \\exp(x_{1})$ 和 $\\lambda = 2x_{2}$。令二者相等可得：\n$$\\exp(x_{1}) = 2x_{2}$$\n根据可行性约束 $(1)$，我们将 $x_{1} = -x_{2}$ 代入此方程：\n$$\\exp(-x_{2}) = 2x_{2}$$\n为了求解 $x_{2}$，我们重新整理方程：\n$$\\frac{1}{2} = x_{2} \\exp(x_{2})$$\n该方程的形式为 $c = y \\exp(y)$，其解由朗伯 W 函数 (Lambert W function) 给出，即 $y = W(c)$。因此，$x_{2}$ 的解为：\n$$x_{2}^{\\star} = W\\left(\\frac{1}{2}\\right)$$\n使用 $x_{1} = -x_{2}$，我们求得 $x_{1}^{\\star}$：\n$$x_{1}^{\\star} = -W\\left(\\frac{1}{2}\\right)$$\n相应的拉格朗日乘子是：\n$$\\lambda^{\\star} = 2x_{2}^{\\star} = 2W\\left(\\frac{1}{2}\\right)$$\n因此，唯一的 KKT 点是 $(x^{\\star}, \\lambda^{\\star}) = \\left(\\left(-W\\left(\\frac{1}{2}\\right), W\\left(\\frac{1}{2}\\right)\\right), 2W\\left(\\frac{1}{2}\\right)\\right)$。\n\n接下来，我们分析二阶条件。我们需要拉格朗日函数关于 $x$ 的 Hessian 矩阵：\n$$\\nabla_{xx}^{2} L(x, \\lambda) = \\begin{pmatrix} \\frac{\\partial^2 L}{\\partial x_1^2}  \\frac{\\partial^2 L}{\\partial x_1 \\partial x_2} \\\\ \\frac{\\partial^2 L}{\\partial x_2 \\partial x_1}  \\frac{\\partial^2 L}{\\partial x_2^2} \\end{pmatrix} = \\begin{pmatrix} \\exp(x_{1})  0 \\\\ 0  2 \\end{pmatrix}$$\n在 KKT 点 $(x^{\\star}, \\lambda^{\\star})$ 处计算该矩阵：\n$$\\exp(x_{1}^{\\star}) = \\exp\\left(-W\\left(\\frac{1}{2}\\right)\\right)$$\n从 KKT 条件中，我们还知道 $\\exp(x_{1}^{\\star}) = \\lambda^{\\star} = 2W\\left(\\frac{1}{2}\\right)$。因此，在 KKT 点处的 Hessian 矩阵是：\n$$\\nabla_{xx}^{2} L(x^{\\star}, \\lambda^{\\star}) = \\begin{pmatrix} 2W\\left(\\frac{1}{2}\\right)  0 \\\\ 0  2 \\end{pmatrix}$$\n现在，我们求在 $x^{\\star}$ 处的切空间。这是约束雅可比矩阵 $\\nabla g(x)$ 的零空间。\n$$\\nabla g(x) = \\begin{pmatrix} \\frac{\\partial g}{\\partial x_1}  \\frac{\\partial g}{\\partial x_2} \\end{pmatrix} = \\begin{pmatrix} 1  1 \\end{pmatrix}$$\n零空间是所有满足 $\\nabla g(x^{\\star}) z = 0$ 的向量 $z = (z_{1}, z_{2})^{T}$ 的集合：\n$$1 \\cdot z_{1} + 1 \\cdot z_{2} = 0 \\implies z_{1} = -z_{2}$$\n这个一维零空间的一个基由向量 $v = (-1, 1)^{T}$ 给出。为了构成一个标准正交基，我们对该向量进行归一化。其范数为 $\\|v\\| = \\sqrt{(-1)^{2} + 1^{2}} = \\sqrt{2}$。\n标准正交基由单个向量 $Z$ 给出：\n$$Z = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix}$$\n缩减 Hessian 矩阵是 $Z^{T} \\nabla_{xx}^{2} L(x^{\\star}, \\lambda^{\\star}) Z$。由于零空间是一维的，这将是一个 $1 \\times 1$ 的矩阵（一个标量）。\n\\begin{align*} Z^{T} \\nabla_{xx}^{2} L(x^{\\star}, \\lambda^{\\star}) Z = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} -1  1 \\end{pmatrix} \\begin{pmatrix} 2W\\left(\\frac{1}{2}\\right)  0 \\\\ 0  2 \\end{pmatrix} \\frac{1}{\\sqrt{2}} \\begin{pmatrix} -1 \\\\ 1 \\end{pmatrix} \\\\ = \\frac{1}{2} \\begin{pmatrix} -1  1 \\end{pmatrix} \\begin{pmatrix} -2W\\left(\\frac{1}{2}\\right) \\\\ 2 \\end{pmatrix} \\\\ = \\frac{1}{2} \\left( (-1)\\left(-2W\\left(\\frac{1}{2}\\right)\\right) + (1)(2) \\right) \\\\ = \\frac{1}{2} \\left( 2W\\left(\\frac{1}{2}\\right) + 2 \\right) \\\\ = 1 + W\\left(\\frac{1}{2}\\right) \\end{align*}\n标量缩减 Hessian 矩阵是 $1 + W\\left(\\frac{1}{2}\\right)$。\n\n严格局部最小值的二阶充分条件是缩减 Hessian 矩阵为正定。由于缩减 Hessian 矩阵是一个标量，这意味着它必须是正数。对于任何 $z  0$，朗伯 W 函数 $W(z)$ 都是正的。因为 $1/2  0$，所以我们有 $W(1/2)  0$。因此，缩减 Hessian 矩阵 $1 + W(1/2)$ 是严格为正的。二阶充分条件成立，因此 $x^{\\star}$ 是一个严格局部最小值点。\n\n定性地看，缩减 Hessian 矩阵表示目标函数沿着可行方向的曲率。切线方向向量 $Z$ 表明，为了保持在约束线 $x_{1} + x_{2} = 0$ 上， $x_{1}$ 的变化必须伴随着 $x_{2}$ 的等量反向变化。拉格朗日函数沿方向 $d$ 的曲率由二次型 $d^{T} (\\nabla_{xx}^{2} L) d$ 给出。对于归一化的切线方向 $Z$，该曲率为 $Z^{T} (\\nabla_{xx}^{2} L) Z = 1 + W(1/2)$。这个值可以分解为来自每个变量的贡献。由指数项 $\\exp(x_{1})$ 贡献的曲率分量为 $(\\frac{-1}{\\sqrt{2}})^{2} \\exp(x_{1}^{\\star}) = \\frac{1}{2} (2W(\\frac{1}{2})) = W(\\frac{1}{2})$。由二次项 $x_{2}^{2}$ 贡献的曲率分量为 $(\\frac{1}{\\sqrt{2}})^{2} (2) = 1$。总曲率是这两个正贡献之和。指数函数和二次函数都是凸函数，它们在可行方向上的共同作用导致了正的总曲率，这证实了该点是一个最小值点。", "answer": "$$\\boxed{1 + W\\left(\\frac{1}{2}\\right)}$$", "id": "3176416"}, {"introduction": "现实世界中的优化问题常常包含不等式约束。对于这类问题，仅仅分析切空间上的曲率是不够的，我们需要一个更普适的工具——临界锥（critical cone）。本练习 [@problem_id:3176420] 将引导你处理一个带不等式约束的问题，验证其KKT条件，并学习如何在临界锥上分析Lagrangian函数的Hessian矩阵，这是将二阶条件理论从等式约束推广到一般非线性规划的关键一步。", "problem": "考虑非线性规划问题：最小化目标函数 $f(x) = x_1^2 + x_2^2$，满足单一不等式约束 $h(x) = \\cos(x_1) - x_2 \\le 0$。设候选点为 $x^\\star = (0, 1)$。\n\n您的任务是：\n\n- 从拉格朗日函数 $L(x,\\lambda) = f(x) + \\lambda h(x)$ 和 Karush–Kuhn–Tucker (KKT) 条件（原始可行性、对偶可行性、互补松弛性和稳定性）的定义出发，验证 $x^\\star$ 在 Mangasarian–Fromovitz 约束规范 (MFCQ) 下满足一阶条件，并确定相关的拉格朗日乘子 $\\lambda^\\star$。\n\n- 利用活动约束的一阶（线性）近似和线性化可行性的定义，导出在 $x^\\star$ 处的线性可行方向锥。然后，根据临界方向是目标函数一阶变化为零的线性可行方向这一原理，导出临界锥 $C(x^\\star,\\lambda^\\star)$。\n\n- 计算拉格朗日函数关于 $x$ 的海森矩阵，即 $\\nabla_{xx}^2 L(x^\\star,\\lambda^\\star)$，并评估沿临界方向的最小曲率：\n$$\n\\alpha^\\star \\;=\\; \\min \\left\\{ d^\\top \\nabla_{xx}^2 L(x^\\star,\\lambda^\\star)\\, d \\;:\\; d \\in C(x^\\star,\\lambda^\\star),\\ \\|d\\|_2 = 1 \\right\\}.\n$$\n\n给出 $\\alpha^\\star$ 作为您的最终答案。无需四舍五入，不涉及单位。将您的答案表示为单个实数。", "solution": "该问题要求分析非线性规划问题（最小化 $f(x) = x_1^2 + x_2^2$，约束为 $h(x) = \\cos(x_1) - x_2 \\le 0$）的候选点 $x^\\star = (0, 1)$。分析内容包括验证 Karush–Kuhn–Tucker (KKT) 条件，确定临界锥，以及计算拉格朗日函数的海森矩阵在该锥中归一化方向上的最小曲率。\n\n首先，我们定义该问题的拉格朗日函数 $L(x, \\lambda)$，其表达式为\n$$L(x, \\lambda) = f(x) + \\lambda h(x) = x_1^2 + x_2^2 + \\lambda (\\cos(x_1) - x_2).$$\n此处，$x = (x_1, x_2)^\\top$ 且 $\\lambda$ 是与不等式约束相关的拉格朗日乘子。\n\n我们首先在点 $x^\\star = (0, 1)^\\top$ 处验证一阶必要条件（KKT 条件）。\n\n目标函数 $f(x)$ 和约束函数 $h(x)$ 的梯度为：\n$$\\nabla f(x) = \\begin{pmatrix} 2x_1 \\\\ 2x_2 \\end{pmatrix}, \\quad \\nabla h(x) = \\begin{pmatrix} -\\sin(x_1) \\\\ -1 \\end{pmatrix}.$$\n在候选点 $x^\\star = (0, 1)^\\top$ 处，这些梯度变为：\n$$\\nabla f(x^\\star) = \\begin{pmatrix} 2(0) \\\\ 2(1) \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 2 \\end{pmatrix}, \\quad \\nabla h(x^\\star) = \\begin{pmatrix} -\\sin(0) \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -1 \\end{pmatrix}.$$\n\nKKT 条件包括原始可行性、对偶可行性、互补松弛性和稳定性。\n$1$. **原始可行性**：我们检查 $x^\\star$ 是否满足约束 $h(x) \\le 0$。\n$$h(x^\\star) = \\cos(0) - 1 = 1 - 1 = 0.$$\n由于 $h(x^\\star) = 0$，该约束被满足，并且在 $x^\\star$ 处是活动约束。\n\n$2$. **Mangasarian–Fromovitz 约束规范 (MFCQ)**：对于活动不等式约束集，其梯度向量必须线性无关。此处只有一个活动约束。其梯度 $\\nabla h(x^\\star) = (0, -1)^\\top$ 是一个非零向量，因此是线性无关的。故 MFCQ 在 $x^\\star$ 处成立，这保证了唯一的拉格朗日乘子 $\\lambda^\\star$ 的存在。\n\n$3$. **稳定性**：拉格朗日函数关于 $x$ 的梯度在 $(x^\\star, \\lambda^\\star)$ 处必须为零：\n$$\\nabla_x L(x^\\star, \\lambda^\\star) = \\nabla f(x^\\star) + \\lambda^\\star \\nabla h(x^\\star) = 0.$$\n代入我们计算出的梯度：\n$$\\begin{pmatrix} 0 \\\\ 2 \\end{pmatrix} + \\lambda^\\star \\begin{pmatrix} 0 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}.$$\n此向量方程产生两个标量方程：\n\\begin{align*} 0 + \\lambda^\\star(0) = 0 \\quad \\implies \\quad 0 = 0 \\\\ 2 - \\lambda^\\star = 0 \\quad \\implies \\quad \\lambda^\\star = 2 \\end{align*}\n稳定性条件在唯一的拉格朗日乘子 $\\lambda^\\star = 2$ 下成立。\n\n$4$. **对偶可行性**：对于形式为 $h(x) \\le 0$ 的不等式约束，其乘子必须为非负。我们求得 $\\lambda^\\star = 2$，满足 $\\lambda^\\star \\ge 0$。\n\n$5$. **互补松弛性**：该条件要求 $\\lambda^\\star h(x^\\star) = 0$。我们有 $\\lambda^\\star = 2$ 和 $h(x^\\star) = 0$，因此 $2 \\cdot 0 = 0$。该条件得到满足。\n所有 KKT 条件在 $x^\\star = (0, 1)$ 处，当 $\\lambda^\\star = 2$ 时均得到满足。\n\n接下来，我们推导临界锥 $C(x^\\star, \\lambda^\\star)$。这需要首先找到线性可行方向锥 $LF(x^\\star)$。对于所有活动不等式约束 $h_i$，如果 $\\nabla h_i(x^\\star)^\\top d \\le 0$，则方向 $d = (d_1, d_2)^\\top$ 属于 $LF(x^\\star)$。此处，只有 $h(x)$ 是活动约束。\n$$\\nabla h(x^\\star)^\\top d \\le 0 \\implies \\begin{pmatrix} 0  -1 \\end{pmatrix} \\begin{pmatrix} d_1 \\\\ d_2 \\end{pmatrix} \\le 0 \\implies -d_2 \\le 0 \\implies d_2 \\ge 0.$$\n所以，线性可行方向锥为 $LF(x^\\star) = \\{d \\in \\mathbb{R}^2 \\mid d_2 \\ge 0\\}$。\n\n临界锥 $C(x^\\star, \\lambda^\\star)$ 由 $LF(x^\\star)$ 中满足目标函数一阶变化为非正（即 $\\nabla f(x^\\star)^\\top d \\le 0$）的方向 $d$ 组成。注意到，由于稳定性条件，$\\nabla f(x^\\star)^\\top d = -\\lambda^\\star \\nabla h(x^\\star)^\\top d$。因为 $\\lambda^\\star  0$，条件 $\\nabla f(x^\\star)^\\top d \\le 0$ 等价于 $\\nabla h(x^\\star)^\\top d \\ge 0$。结合线性可行性条件 $\\nabla h(x^\\star)^\\top d \\le 0$，这意味着 $\\nabla h(x^\\star)^\\top d = 0$。\n我们用显式梯度来验证这一点：\n$$\\nabla f(x^\\star)^\\top d = \\begin{pmatrix} 0  2 \\end{pmatrix} \\begin{pmatrix} d_1 \\\\ d_2 \\end{pmatrix} = 2d_2.$$\n条件 $\\nabla f(x^\\star)^\\top d \\le 0$ 意味着 $2d_2 \\le 0$，即 $d_2 \\le 0$。\n如果一个方向 $d$ 同时满足 $d \\in LF(x^\\star)$（即 $d_2 \\ge 0$）和 $\\nabla f(x^\\star)^\\top d \\le 0$（即 $d_2 \\le 0$），则它在临界锥中。同时满足这两个条件的唯一方式是 $d_2 = 0$。\n因此，临界锥为：\n$$C(x^\\star, \\lambda^\\star) = \\{d = (d_1, d_2)^\\top \\in \\mathbb{R}^2 \\mid d_2 = 0\\}.$$\n这代表了 $x_1$ 轴。\n\n最后，我们计算 $\\alpha^\\star$，即拉格朗日函数的海森矩阵沿归一化临界方向的最小曲率。拉格朗日函数关于 $x$ 的海森矩阵是：\n$$\\nabla_{xx}^2 L(x, \\lambda) = \\nabla_{xx}^2 \\left( x_1^2 + x_2^2 + \\lambda (\\cos(x_1) - x_2) \\right) = \\begin{pmatrix} 2 - \\lambda \\cos(x_1)  0 \\\\ 0  2 \\end{pmatrix}.$$\n在 $(x^\\star, \\lambda^\\star) = ((0, 1), 2)$ 处计算该矩阵：\n$$\\nabla_{xx}^2 L(x^\\star, \\lambda^\\star) = \\begin{pmatrix} 2 - 2 \\cos(0)  0 \\\\ 0  2 \\end{pmatrix} = \\begin{pmatrix} 2 - 2(1)  0 \\\\ 0  2 \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ 0  2 \\end{pmatrix}.$$\n令 $H = \\nabla_{xx}^2 L(x^\\star, \\lambda^\\star)$。我们要求解：\n$$\\alpha^\\star = \\min \\left\\{ d^\\top H d \\mid d \\in C(x^\\star,\\lambda^\\star),\\ \\|d\\|_2 = 1 \\right\\}.$$\n临界锥 $C(x^\\star, \\lambda^\\star)$ 中的方向 $d$ 必须具有形式 $d = (d_1, 0)^\\top$。归一化条件 $\\|d\\|_2 = 1$ 意味着 $\\sqrt{d_1^2 + 0^2} = 1$，所以 $|d_1| = 1$。这给出了 $d$ 的两个可能向量：$(1, 0)^\\top$ 和 $(-1, 0)^\\top$。\n我们对一个通用的临界方向 $d = (d_1, 0)^\\top$ 计算二次型 $d^\\top H d$：\n$$d^\\top H d = \\begin{pmatrix} d_1  0 \\end{pmatrix} \\begin{pmatrix} 0  0 \\\\ 0  2 \\end{pmatrix} \\begin{pmatrix} d_1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} d_1  0 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} = 0.$$\n对于临界锥中的任何向量（包括归一化的向量），该二次型的值都为 $0$。因此，最小值为 $0$。\n$$\\alpha^\\star = 0.$$\n这个结果表明，严格局部最小值的二阶充分条件不被满足，因为它们要求在临界锥上的曲率必须为严格正值。", "answer": "$$\n\\boxed{0}\n$$", "id": "3176420"}]}