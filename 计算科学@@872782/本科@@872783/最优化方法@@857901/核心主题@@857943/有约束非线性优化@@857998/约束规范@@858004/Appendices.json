{"hands_on_practices": [{"introduction": "本练习将带你直接应用线性无关约束规范 (Linear Independence Constraint Qualification, LICQ) 的定义。通过计算在某一点处有效约束的梯度所构成的雅可比矩阵的秩[@problem_id:3112190]，你将能够判断这一重要的约束规范是否成立。这是诊断优化问题在特定点上正则性的基本技能。", "problem": "考虑一个在 $\\mathbb{R}^{3}$ 中的约束优化问题，在候选解点 $x^{\\star} \\in \\mathbb{R}^{3}$ 处有三个不等式约束是激活的。其外法向量（等价于在 $x^{\\star}$ 处的激活约束函数的梯度）由下式给出\n$$\nn_{1} = (1,\\,1,\\,0),\\quad n_{2} = (2,\\,2,\\,0),\\quad n_{3} = (0,\\,0,\\,1).\n$$\n令 $A \\in \\mathbb{R}^{3 \\times 3}$ 表示激活约束雅可比矩阵，其行向量为 $n_{1}$、$n_{2}$ 和 $n_{3}$。使用线性无关约束规范 (LICQ) 的定义，通过确定 $A$ 的秩 $r$ 来评估激活约束梯度的线性无关性。仅报告 $r$ 的值作为您的最终数值答案。", "solution": "该问题要求确定一个约束优化问题的激活约束雅可比矩阵 $A$ 的秩。该矩阵的秩用于评估在候选解点 $x^{\\star}$ 处是否满足线性无关约束规范 (LICQ)。\n\n该问题定义在 $\\mathbb{R}^{3}$ 中。在点 $x^{\\star}$ 处，有三个激活的不等式约束。这些激活约束函数的梯度，即外法向量，如下所示：\n$$n_{1} = (1,\\,1,\\,0)$$\n$$n_{2} = (2,\\,2,\\,0)$$\n$$n_{3} = (0,\\,0,\\,1)$$\n\n激活约束雅可比矩阵 $A$ 是由这些梯度向量作为其行向量构成的。因此，矩阵 $A \\in \\mathbb{R}^{3 \\times 3}$ 为：\n$$\nA = \\begin{pmatrix}\n1  1  0 \\\\\n2  2  0 \\\\\n0  0  1\n\\end{pmatrix}\n$$\n\n线性无关约束规范 (LICQ) 在某点成立，当且仅当该点处激活约束的梯度集是线性无关的。激活约束的数量为 $3$。因此，如果集合 $\\{n_{1}, n_{2}, n_{3}\\}$ 是线性无关的，则 LICQ 成立。这等价于矩阵 $A$ 的秩等于激活约束的数量，即 $3$。矩阵的秩，记作 $r = \\text{rank}(A)$，是其行（或列）向量所张成的向量空间的维度，等于最大线性无关行（或列）向量的数量。\n\n我们可以用几种方法确定矩阵 $A$ 的秩。一个标准程序是使用高斯消元法将矩阵化为行阶梯形。得到的阶梯形矩阵中的非零行数即为秩。\n\n设 $A$ 的行向量为 $R_{1}$、$R_{2}$ 和 $R_{3}$。\n$$\nA = \\begin{pmatrix}\nR_{1} \\\\\nR_{2} \\\\\nR_{3}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1  1  0 \\\\\n2  2  0 \\\\\n0  0  1\n\\end{pmatrix}\n$$\n我们观察到第二行 $R_{2}$ 是第一行 $R_{1}$ 的标量倍数，具体来说是 $R_{2} = 2R_{1}$。这表明这些行是线性相关的。让我们用行变换来形式化这个过程。我们将第二行 $R_{2}$ 替换为 $R_{2} - 2R_{1}$：\n$$\n\\begin{pmatrix}\n1  1  0 \\\\\n2 - 2(1)  2 - 2(1)  0 - 2(0) \\\\\n0  0  1\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1  1  0 \\\\\n0  0  0 \\\\\n0  0  1\n\\end{pmatrix}\n$$\n为了得到标准的行阶梯形，我们可以交换第二行和第三行：\n$$\n\\begin{pmatrix}\n1  1  0 \\\\\n0  0  1 \\\\\n0  0  0\n\\end{pmatrix}\n$$\n该矩阵是行阶梯形。它包含两个非零行。因此，矩阵 $A$ 的秩为 $2$。\n$$r = \\text{rank}(A) = 2$$\n\n或者，我们可以直接评估线性无关性。如果存在不全为零的标量 $c_{1}, c_{2}, c_{3}$，使得 $c_{1}n_{1} + c_{2}n_{2} + c_{3}n_{3} = \\mathbf{0}$，则向量集 $\\{n_{1}, n_{2}, n_{3}\\}$ 是线性相关的。\n通过观察可知，$n_{2} = 2n_{1}$。这个关系可以写成 $2n_{1} - n_{2} + 0n_{3} = \\mathbf{0}$。这是一个等于零向量的非平凡线性组合（系数为 $c_{1}=2$, $c_{2}=-1$, $c_{3}=0$），这证明了该向量集是线性相关的。\n由于这三个向量的集合是线性相关的，其秩必须小于 $3$。向量子集 $\\{n_{1}, n_{3}\\} = \\{(1,1,0), (0,0,1)\\}$ 显然是线性无关的，因为其中一个不能写成另一个的标量倍数。因此，由 $\\{n_{1}, n_{2}, n_{3}\\}$ 张成的空间的维度是 $2$。\n\n由于秩 $r=2$ 小于激活约束的数量（$3$），激活约束梯度是线性相关的，因此在点 $x^{\\star}$ 处不满足 LICQ 条件。问题要求的是矩阵 $A$ 的秩 $r$。\n\n根据行化简，秩为 $r=2$。", "answer": "$$\n\\boxed{2}\n$$", "id": "3112190"}, {"introduction": "当LICQ失效时会发生什么？这个实践揭示了一个关键后果：拉格朗日乘子的不唯一性。通过分析一个包含冗余约束的问题[@problem_id:3112197]，你将亲眼见证约束的几何特性（梯度线性相关）与最优性条件代数特性之间的深刻联系。", "problem": "考虑一个等式约束优化问题，其决策变量为 $x \\in \\mathbb{R}^2$，目标函数为 $f(x) = x_1^2 + x_2^2$，以及两个等式约束 $h_1(x) = x_1 + x_2 = 0$ 和 $h_2(x) = 2 x_1 + 2 x_2 = 0$。可行集为 $\\mathcal{F} = \\{ x \\in \\mathbb{R}^2 : h_1(x) = 0, h_2(x) = 0 \\}$。仅使用可行性、约束梯度、雅可比矩阵秩以及 Karush–Kuhn–Tucker (KKT) 条件的核心定义，来分析由重复的等式约束引起的退化以及线性无关约束规范 (Linear Independence Constraint Qualification, LICQ) 不成立的情况。计算以下量：\n- 在任意 $x \\in \\mathcal{F}$ 处，约束雅可比矩阵 $J(x)$ 的秩 $r$，其中 $J(x)$ 的行是 $\\nabla h_1(x)^\\top$ 和 $\\nabla h_2(x)^\\top$。\n- $J(x)$ 零空间的维数 $d_{\\mathrm{null}}$。\n- 令 $x^\\star$ 为 $f$ 在 $\\mathcal{F}$ 上的全局极小值点。在 $x^\\star$ 处，确定满足 KKT 平稳性条件的拉格朗日乘子 $\\lambda \\in \\mathbb{R}^2$ 集合的维数 $d_{\\lambda}$。\n\n将你的最终结果以单行矩阵 $\\left( r \\quad d_{\\mathrm{null}} \\quad d_{\\lambda} \\right)$ 的形式报告，使用精确值。无需四舍五入，不涉及单位。你可以在首次使用时使用线性无关约束规范 (Linear Independence Constraint Qualification, LICQ) 的全称。", "solution": "该问题要求分析一个以线性相关约束为特征的等式约束优化问题。我们必须计算与约束雅可比矩阵和拉格朗日乘子集合相关的三个量。\n\n该问题定义如下：\n最小化 $f(x) = x_1^2 + x_2^2$，其中 $x = (x_1, x_2) \\in \\mathbb{R}^2$。\n约束条件为：\n$h_1(x) = x_1 + x_2 = 0$\n$h_2(x) = 2x_1 + 2x_2 = 0$\n\n可行集为 $\\mathcal{F} = \\{ x \\in \\mathbb{R}^2 : h_1(x) = 0, h_2(x) = 0 \\}$。第二个约束 $h_2(x) = 2(x_1 + x_2) = 2h_1(x)$ 是冗余的。因此，可行集仅由第一个约束确定：\n$\\mathcal{F} = \\{ x \\in \\mathbb{R}^2 : x_1 + x_2 = 0 \\}$。该集合表示 $\\mathbb{R}^2$ 中一条穿过原点的直线。\n\n首先，我们计算约束雅可比矩阵 $J(x)$ 的秩 $r$。\n约束函数的梯度为：\n$$ \\nabla h_1(x) = \\begin{pmatrix} \\frac{\\partial h_1}{\\partial x_1} \\\\ \\frac{\\partial h_1}{\\partial x_2} \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} $$\n$$ \\nabla h_2(x) = \\begin{pmatrix} \\frac{\\partial h_2}{\\partial x_1} \\\\ \\frac{\\partial h_2}{\\partial x_2} \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ 2 \\end{pmatrix} $$\n约束雅可比矩阵 $J(x)$ 定义为行向量为 $\\nabla h_1(x)^\\top$ 和 $\\nabla h_2(x)^\\top$ 的矩阵：\n$$ J(x) = \\begin{pmatrix} 1  1 \\\\ 2  2 \\end{pmatrix} $$\n该雅可比矩阵对所有 $x \\in \\mathbb{R}^2$ 都是常数。为了求其秩，我们观察到第二行是第一行的 $2$ 倍。这两行是线性相关的。由于该矩阵非零，其秩必为 $1$。\n$$ r = \\mathrm{rank}(J(x)) = 1 $$\n这对于任何点 $x$ 都成立，包括任何 $x \\in \\mathcal{F}$。问题陈述中提到，要使线性无关约束规范 (Linear Independence Constraint Qualification, LICQ) 成立，积极约束的梯度必须线性无关。在这里，我们有两个等式约束，它们总是积极的。它们的梯度 $\\nabla h_1(x)$ 和 $\\nabla h_2(x)$ 对所有 $x$ 都是线性相关的。因此，LICQ 处处不成立。\n\n第二，我们计算 $J(x)$ 零空间的维数 $d_{\\mathrm{null}}$。根据秩-零度定理，对于一个有 $n$ 列的矩阵 $A$，有 $\\mathrm{rank}(A) + \\mathrm{dim}(\\mathrm{null}(A)) = n$。对于雅可比矩阵 $J(x)$，它是一个 $2 \\times 2$ 的矩阵，列数 $n=2$。\n使用我们刚刚求出的秩 $r=1$：\n$$ r + d_{\\mathrm{null}} = n \\implies 1 + d_{\\mathrm{null}} = 2 $$\n$$ d_{\\mathrm{null}} = 1 $$\n\n第三，我们计算在全局极小值点 $x^\\star$ 处的拉格朗日乘子 $\\lambda = (\\lambda_1, \\lambda_2)$ 集合的维数 $d_{\\lambda}$。\n首先，我们找到最优点 $x^\\star$。目标函数 $f(x) = x_1^2 + x_2^2 = \\|x\\|_2^2$ 是到原点的欧几里得距离的平方。可行集 $\\mathcal{F}$ 是穿过原点的直线 $x_1 + x_2 = 0$。这条线上离原点最近的点就是原点本身。因此，全局极小值点为：\n$$ x^\\star = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} $$\n对于等式约束问题，Karush-Kuhn-Tucker (KKT) 条件要求在局部极小值点 $x^\\star$ 处，存在拉格朗日乘子 $\\lambda$，使得拉格朗日函数的梯度为零。拉格朗日函数是：\n$$ \\mathcal{L}(x, \\lambda) = f(x) + \\lambda_1 h_1(x) + \\lambda_2 h_2(x) $$\n平稳性条件为 $\\nabla_x \\mathcal{L}(x^\\star, \\lambda) = 0$，可以写成：\n$$ \\nabla f(x^\\star) + \\sum_{i=1}^{2} \\lambda_i \\nabla h_i(x^\\star) = 0 $$\n我们计算目标函数的梯度：\n$$ \\nabla f(x) = \\begin{pmatrix} 2x_1 \\\\ 2x_2 \\end{pmatrix} $$\n在极小值点 $x^\\star = (0, 0)$ 处，梯度为 $\\nabla f(x^\\star) = (0, 0)^\\top$。平稳性条件变为：\n$$ \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} + \\lambda_1 \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} + \\lambda_2 \\begin{pmatrix} 2 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} $$\n这得到了一个关于 $\\lambda_1$ 和 $\\lambda_2$ 的由两个相同线性方程组成的方程组：\n$$ \\lambda_1 + 2\\lambda_2 = 0 $$\n满足此条件的拉格朗日乘子集合由 $\\lambda_1 = -2\\lambda_2$ 给出。该集合可以由单个变量（例如 $c \\in \\mathbb{R}$）参数化，使得 $\\lambda_2 = c$ 且 $\\lambda_1 = -2c$。乘子集合为：\n$$ \\{ \\lambda \\in \\mathbb{R}^2 : \\lambda = c \\begin{pmatrix} -2 \\\\ 1 \\end{pmatrix}, c \\in \\mathbb{R} \\} $$\n这个集合是 $\\mathbb{R}^2$ 的一个一维子空间，由向量 $(-2, 1)^\\top$ 张成。因此，拉格朗日乘子集合的维数是 $1$。\n$$ d_{\\lambda} = 1 $$\n拉格朗日乘子的这种非唯一性是 LICQ 不成立的直接后果。一般而言，如果 KKT 乘子集合非空，其维数为 $m - \\mathrm{rank}(J(x^\\star))$，其中 $m$ 是约束的数量。在这里，$m=2$ 且 $\\mathrm{rank}(J(x^\\star))=1$，所以维数是 $2 - 1 = 1$。\n\n综上所述，计算出的量为：\n- $r = 1$\n- $d_{\\mathrm{null}} = 1$\n- $d_{\\lambda} = 1$\n\n最终结果以行矩阵 $(r \\quad d_{\\mathrm{null}} \\quad d_{\\lambda})$ 的形式报告。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  1  1\n\\end{pmatrix}\n}\n$$", "id": "3112197"}, {"introduction": "LICQ是一个相对较强的条件。本练习将介绍更弱的Mangasarian-Fromovitz约束规范 (MFCQ)，并探讨一个LICQ失效的典型场景[@problem_id:3146844]。你将通过判断是否存在一个满足MFCQ要求的可行下降方向，来深入理解其几何本质，并体会不同约束规范之间的区别。", "problem": "考虑$\\mathbb{R}^2$中的不等式约束 $g_1(x)=x_1+x_2^2\\le 0$ 和 $g_2(x)=-x_1+x_2^2\\le 0$，以及点 $x^*=(0,0)$。使用 Mangasarian-Fromovitz 约束规范 (MFCQ) 的基本定义，该定义对于一组不等式约束，要求存在一个方向 $d\\in\\mathbb{R}^n$，使得在 $x^*$ 处所有有效约束的方向导数都严格为负。依据梯度、方向导数和有效约束的核心定义，并使用欧几里得范数 $\\|\\cdot\\|_2$。\n\n定义单位方向上的严格下降裕度\n$$\n\\alpha^*=\\sup_{\\|d\\|_2=1}\\;\\min_{i\\in\\{1,2\\}}\\left(-\\nabla g_i(x^*)\\cdot d\\right),\n$$\n该值量化了在 $x^*$ 处所有有效不等式约束可达到的最佳同步严格下降率。计算 $\\alpha^*$ 的精确值，并从概念上解释沿 $x_1$ 轴的梯度要求是否冲突。您最终报告的答案必须是 $\\alpha^*$ 的精确值，无四舍五入，无单位。", "solution": "问题要求计算严格下降裕度 $\\alpha^*=\\sup_{\\|d\\|_2=1}\\;\\min_{i\\in\\{1,2\\}}\\left(-\\nabla g_i(x^*)\\cdot d\\right)$，针对不等式约束 $g_1(x)=x_1+x_2^2\\le 0$ 和 $g_2(x)=-x_1+x_2^2\\le 0$ 在点 $x^*=(0,0) \\in \\mathbb{R}^2$ 的情况。我们还必须提供结果的概念性解释。\n\n首先，我们识别在 $x^*=(0,0)$ 处的有效约束集。如果 $g_i(x^*) = 0$，则约束 $g_i(x) \\le 0$ 在 $x^*$ 处是有效的。\n对于第一个约束，$g_1(x) = x_1+x_2^2$：\n$$g_1(x^*) = g_1(0,0) = 0 + 0^2 = 0$$\n由于 $g_1(x^*) = 0$，约束 $g_1$ 在 $x^*$ 处是有效的。\n\n对于第二个约束，$g_2(x) = -x_1+x_2^2$：\n$$g_2(x^*) = g_2(0,0) = -0 + 0^2 = 0$$\n由于 $g_2(x^*) = 0$，约束 $g_2$ 在 $x^*$ 处也是有效的。\n因此，在 $x^*$ 处的有效约束的索引集是 $I(x^*) = \\{1, 2\\}$。\n\n接下来，我们计算这些有效约束在点 $x^*=(0,0)$ 处的梯度。\n对于 $g_1(x)$，其梯度为：\n$$\\nabla g_1(x) = \\begin{pmatrix} \\frac{\\partial g_1}{\\partial x_1} \\\\ \\frac{\\partial g_1}{\\partial x_2} \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 2x_2 \\end{pmatrix}$$\n在 $x^*=(0,0)$ 处计算：\n$$\\nabla g_1(x^*) = \\begin{pmatrix} 1 \\\\ 2(0) \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$$\n\n对于 $g_2(x)$，其梯度为：\n$$\\nabla g_2(x) = \\begin{pmatrix} \\frac{\\partial g_2}{\\partial x_1} \\\\ \\frac{\\partial g_2}{\\partial x_2} \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ 2x_2 \\end{pmatrix}$$\n在 $x^*=(0,0)$ 处计算：\n$$\\nabla g_2(x^*) = \\begin{pmatrix} -1 \\\\ 2(0) \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ 0 \\end{pmatrix}$$\n\n现在我们可以构建 $\\alpha^*$ 的表达式。函数 $g_i$ 在 $x^*$ 处沿方向 $d$ 的方向导数由 $\\nabla g_i(x^*) \\cdot d$ 给出。如果存在一个方向 $d$，使得对于所有有效约束，该方向导数都严格为负，则 Mangasarian-Fromovitz 约束规范 (MFCQ) 成立。量 $\\alpha^*$ 衡量了在所有单位向量 $d$ 上最大化的这种同步严格下降的最优值。\n\n$\\alpha^*$ 的表达式为：\n$$\\alpha^*=\\sup_{\\|d\\|_2=1}\\;\\min_{i\\in I(x^*)}\\left(-\\nabla g_i(x^*)\\cdot d\\right)$$\n由于 $I(x^*) = \\{1,2\\}$，我们有：\n$$\\alpha^*=\\sup_{\\|d\\|_2=1}\\;\\min\\left(-\\nabla g_1(x^*)\\cdot d, -\\nabla g_2(x^*)\\cdot d\\right)$$\n令 $d = \\begin{pmatrix} d_1 \\\\ d_2 \\end{pmatrix}$ 为一个单位向量，因此其分量满足条件 $d_1^2 + d_2^2 = 1$。我们计算点积：\n$$-\\nabla g_1(x^*)\\cdot d = -\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} \\cdot \\begin{pmatrix} d_1 \\\\ d_2 \\end{pmatrix} = -d_1$$\n$$-\\nabla g_2(x^*)\\cdot d = -\\begin{pmatrix} -1 \\\\ 0 \\end{pmatrix} \\cdot \\begin{pmatrix} d_1 \\\\ d_2 \\end{pmatrix} = d_1$$\n将这些代入 $\\alpha^*$ 的表达式中：\n$$\\alpha^* = \\sup_{d_1^2+d_2^2=1} \\min(-d_1, d_1)$$\n我们来分析上确界内的函数 $f(d_1) = \\min(-d_1, d_1)$。\n如果 $d_1 \\ge 0$，则 $-d_1 \\le d_1$，所以 $\\min(-d_1, d_1) = -d_1$。\n如果 $d_1  0$，则 $-d_1 > d_1$，所以 $\\min(-d_1, d_1) = d_1$。\n这个函数等价于 $-|d_1|$。\n因此，问题简化为：\n$$\\alpha^* = \\sup_{d_1^2+d_2^2=1} (-|d_1|)$$\n目标函数仅取决于 $d_1$。约束 $d_1^2+d_2^2=1$ 意味着 $d_1$ 的可能值在区间 $[-1, 1]$ 内。我们想要找到当 $d_1 \\in [-1, 1]$ 时 $-|d_1|$ 的最大值。\n函数 $-|d_1|$ 总是非正的。当 $|d_1|$ 取最小值时，该函数达到其最大值。在区间 $[-1, 1]$ 上， $|d_1|$ 的最小值为 $0$，这在 $d_1=0$ 时发生。\n因此，$-|d_1|$ 的最大值为 $-|0|=0$。\n\n这个最大值在 $d_1=0$ 时达到。根据单位范数约束 $d_1^2+d_2^2=1$，我们有 $0^2+d_2^2=1$，这意味着 $d_2 = \\pm 1$。因此，上确界在方向 $d = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$ 和 $d = \\begin{pmatrix} 0 \\\\ -1 \\end{pmatrix}$ 上达到。\n严格下降裕度的值为 $\\alpha^* = 0$。\n\n从概念上讲，MFCQ 要求存在一个单一方向 $d$，它同时是所有有效约束的下降方向。这意味着对于所有 $i \\in I(x^*)$，都有 $\\nabla g_i(x^*) \\cdot d  0$。在我们的例子中，这转化为两个条件：\n1. $\\nabla g_1(x^*) \\cdot d = d_1  0$\n2. $\\nabla g_2(x^*) \\cdot d = -d_1  0 \\implies d_1 > 0$\n这两个条件，$d_1  0$ 和 $d_1 > 0$，是相互排斥的。不可能找到一个同时满足两者的方向 $d$。因此，MFCQ 在 $x^*$ 处不成立。\n冲突的产生是因为有效梯度 $\\nabla g_1(x^*) = (1,0)^T$ 和 $\\nabla g_2(x^*) = (-1,0)^T$ 是反平行向量。它们位于 $x_1$ 轴上，且指向相反的方向。从几何上看，一个下降方向必须与每个有效梯度向量形成钝角。任何向量 $d$ 都不可能同时与 $(1,0)^T$ 和 $(-1,0)^T$ 形成钝角。\n$\\alpha^*$ 值量化了这种情况。一个正的 $\\alpha^*$ 值将表明 MFCQ 成立。我们的结果 $\\alpha^*=0$ 意味着我们能做的最好情况是找到一个方向，使得方向导数为非正，但并非全部严格为负。这个“最佳”方向与冲突的梯度正交（即沿 $x_2$ 轴），使得两个方向导数都等于 $0$，因此对于 $i=1,2$ 都有 $-\\nabla g_i(x^*) \\cdot d = 0$。最小值为 $0$，这也是在所有可能方向上的上确界。", "answer": "$$\\boxed{0}$$", "id": "3146844"}]}