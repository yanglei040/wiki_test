## 引言
在求解线性规划问题时，单纯形法为我们提供了一条寻找最优解的系统路径。然而，当算法指示[目标函数](@entry_id:267263)可以无限增长时，我们会遇到一个特殊而重要的情形：无界性。这种情况不仅是一个计算上的[奇点](@entry_id:137764)，更是对问题本身结构的一个深刻揭示。许多学习者在遇到无界解时，常常会感到困惑，不确定这代表着模型错误还是问题的某种内在属性。本文旨在填补这一认知空白，系统性地阐明无界性的检测、解释及其应用。在接下来的章节中，我们将首先在“原理与机制”中深入剖析单纯形法识别无界性的代数条件、几何直觉和对偶联系；接着，在“应用与[交叉](@entry_id:147634)学科联系”中，我们将通过金融、工程和生物学等领域的实例，展示无界性如何作为[模型诊断](@entry_id:136895)工具和系统动态分析的手段；最后，在“动手实践”部分，你将有机会通过具体问题巩固所学知识。让我们从理解无界性背后的核心原理开始。

## 原理与机制

在单纯形法的迭代过程中，我们从一个基本[可行解](@entry_id:634783)出发，系统地移动到相邻的、目标函数值更优的基本[可行解](@entry_id:634783)，直至达到最优解。这个过程的核心在于两个关键步骤：选择一个可以改进[目标函数](@entry_id:267263)的非基变量（入基变量），以及通过[最小比率检验](@entry_id:634935)选择一个基变量离开基（出基变量），以确保移动后的新解仍然是可行的。[最小比率检验](@entry_id:634935)本质上是一个“制动”机制：它计算出入基变量在不违反任何非负约束的前提下所能增加的最大步长。

然而，在某些[线性规划](@entry_id:138188)问题中，我们可能会遇到一种特殊情况：单纯形法算法显示我们可以无限地改进[目标函数](@entry_id:267263)，而永远不会违反约束。这种情况被称为**无界性 (unboundedness)**。本章将深入探讨单纯形法中无界性的原理、识别机制及其几何与对偶解释。

### 无界性条件：当制动失效时

单纯形法的每一次迭代都旨在通过增加某个非基变量 $x_j$ 的值来改进[目标函数](@entry_id:267263)。对于一个最大化问题，这意味着 $x_j$ 对应的[检验数](@entry_id:173345)（或称判别数）$\bar{c}_j$ 必须为正（在使用 $z = z_0 + \sum \bar{c}_j x_j$ 的形式时），或者在单纯形表中目标行（$z$ 行）的系数为负（在使用 $z - \sum c'_j x_j = z_0$ 的形式时）。

当我们增加 $x_j$ 的值时，基变量的值会相应改变，以维持[等式约束](@entry_id:175290) $Ax=b$。具体而言，基变量向量 $x_{\mathcal{B}}$ 的变化由下式决定：
$x_{\mathcal{B}} = \bar{b} - \bar{A}_j x_j$
其中 $\bar{b}$是当前单纯形表中右端项（RHS）的列向量，$ \bar{A}_j$ 是与入基变量 $x_j$ 对应的列向量。为了保持可行性，所有变量必须保持非负，即 $x_{\mathcal{B}} \ge 0$。这个条件限制了 $x_j$ 的增量。对于 $\bar{A}_j$ 中任意一个正分量 $\bar{a}_{ij} > 0$，我们都面临一个约束：
$\bar{b}_i - \bar{a}_{ij} x_j \ge 0 \implies x_j \le \frac{\bar{b}_i}{\bar{a}_{ij}}$
[最小比率检验](@entry_id:634935)正是为了找出所有这些[上界](@entry_id:274738)中最小的一个，从而确定 $x_j$ 的最大允许步长。

现在，让我们思考一个关键问题：如果对于一个有利可图的入基变量 $x_j$（即 $\bar{c}_j > 0$），其在单纯形表中的对应列 $\bar{A}_j$ 的所有元素都是非正的（即 $\bar{a}_{ij} \le 0$ 对所有行 $i$ 成立），会发生什么？

在这种情况下，当我们增加 $x_j$ 时，对于任意基变量 $x_i$，我们有：
$x_i = \bar{b}_i - \bar{a}_{ij} x_j$
由于 $\bar{a}_{ij} \le 0$，那么 $-\bar{a}_{ij} \ge 0$。因此，随着 $x_j$ 的增加，每个基变量 $x_i$ 的值要么增加，要么保持不变，但绝不会减少。由于初始的基本[可行解](@entry_id:634783)满足 $x_{\mathcal{B}} = \bar{b} \ge 0$，因此无论 $x_j$ 增加多少，所有基变量都将始终保持非负。

这意味着没有任何一个基变量会成为限制 $x_j$ 增长的瓶颈。[最小比率检验](@entry_id:634935)无法执行，因为没有正的除数。我们可以无限地增加 $x_j$ 的值，而解始终保持可行。由于 $x_j$ 的[检验数](@entry_id:173345)为正，其值的无限增长将导致目标函数值也无限增长。

这就是单纯形法中**无界性的判别准则**：
对于一个最大化问题，如果在某次迭代中，存在一个非基变量，其[检验数](@entry_id:173345)为正，且其在单纯形表中对应的列的所有元素均为非正数，则该[线性规划](@entry_id:138188)问题是无界的。

例如，考虑一个情况，我们选择 $x_1$ 作为入基变量，其[检验数](@entry_id:173345)为正。如果其列向量中至少有一个正元素，例如在 [@problem_id:2192531] 的场景中，尽管 $x_1$ 列中有一个-1，但还有一个正数2，这使得我们可以执行[最小比率检验](@entry_id:634935)（$20/2=10$），从而确定一个出基变量 $s_2$。这表明问题在该方向上是有界的，可以进行一次成功的枢轴变换。然而，如果情况如 [@problem_id:3118331] 中所描述，入基变量 $x_1$ 的[检验数](@entry_id:173345)为正（$\frac{3}{2}$），并且其在所有约束行中的系数都为非负（字典形式中的系数符号与单纯形表相反，为$\frac{1}{2}, 1, 0$），这意味着增加 $x_1$ 不会导致任何基变量减少。因此，没有任何东西能阻止 $x_1$ 无限增加，从而导致目标函数无界。

### 无界性的几何解释：衰退方向

无界性的判别准则不仅是一个算法上的信号，它还具有深刻的几何意义。它揭示了[可行域](@entry_id:136622)中存在一个**衰退方向 (recession direction)** 或**极端射线 (extreme ray)**，沿着这个方向可以无限移动而永远不离开[可行域](@entry_id:136622)，并且目标函数值会持续增加。

这个衰退方向向量 $d$ 可以直接从单纯形表中构造出来。假设我们发现非基变量 $x_j$ 满足无界性条件。我们可以构造一个[方向向量](@entry_id:169562) $d$ 如下 [@problem_id:3118403] [@problem_id:3118303]：
1.  令 $d$ 中与入基变量 $x_j$ 对应的分量为 1。
2.  令 $d$ 中与所有其他非基变量对应的分量为 0。
3.  令 $d$ 中与基变量 $x_{\mathcal{B}}$ 对应的分量等于单纯形表中 $x_j$ 列向量的负值，即 $d_{\mathcal{B}} = -\bar{A}_j$。

让我们来验证这个向量 $d$ 的属性。根据无界性条件，我们知道 $\bar{A}_j \le 0$，因此 $d_{\mathcal{B}} = -\bar{A}_j \ge 0$。结合前两条规则，向量 $d$ 的所有分量都是非负的，即 $d \ge 0$。

现在考虑从当前基本可行解 $x^*$ 出发，沿着方向 $d$ 移动任意步长 $t \ge 0$，得到新点 $x(t) = x^* + t d$。
-   **保持[等式约束](@entry_id:175290)**：这个方向 $d$ 被构造为满足 $Ad=0$。因此，$A(x^*+td) = Ax^* + tAd = b + 0 = b$，[等式约束](@entry_id:175290)始终满足。[@problem_id:3118407]
-   **保持非负约束**：由于 $x^* \ge 0$ 且 $d \ge 0$，新点 $x(t) = x^* + td$ 对所有 $t \ge 0$ 显然也满足非负性。
-   **[目标函数](@entry_id:267263)增长**：[目标函数](@entry_id:267263)值的变化是 $c^\top (x^*+td) = c^\top x^* + t(c^\top d)$。$c^\top d$ 正是 $x_j$ 的[检验数](@entry_id:173345) $\bar{c}_j$。由于 $\bar{c}_j > 0$，当 $t \to \infty$ 时，[目标函数](@entry_id:267263)值也趋于无穷。

因此，这个向量 $d$ 是一个有效的**无界性证书 (certificate of unboundedness)**。它明确地给出了一个方向，沿着这个方向移动，我们既能保持可行性，又能使目标函数无限增长。这正是[Farkas引理](@entry_id:146719)在无界性情境下的具体体现：一个（可行的）线性规划是无界的，当且仅当存在一个方向 $d \ge 0$ 使得 $Ad \le 0$（对于不等式形式）且 $c^\top d > 0$ [@problem_id:3118335]。

例如，在 [@problem_id:3118403] 的场景中，入基变量是 $x_3$，其[检验数](@entry_id:173345)为4（正），其在单纯形表中的列向量为 $\begin{pmatrix} -3 \\ -2 \end{pmatrix}$（全为非正）。根据上述规则，我们构造衰退方向 $d$：
-   $d_3 = 1$ (入基变量)
-   $d_1 = d_2 = 0$ (其他非基变量)
-   基变量 $s_1, s_2$ 对应的分量为 $- \begin{pmatrix} -3 \\ -2 \end{pmatrix} = \begin{pmatrix} 3 \\ 2 \end{pmatrix}$。
所以，衰退方向为 $d = \begin{pmatrix} 0 & 0 & 1 & 3 & 2 \end{pmatrix}^\top$。沿着这个方向，可行性得以保持，而目标函数以每单位步长4的速度无限增长。

### 无界性的对偶解释

无界性也可以通过[对偶理论](@entry_id:143133)来理解。[弱对偶定理](@entry_id:152538)指出，对于任何可行的 primal 解 $x$ 和任何可行的 dual 解 $y$，primal 的[目标函数](@entry_id:267263)值（最大化问题）总是不大于 dual 的目标函数值（最小化问题），即 $c^\top x \le b^\top y$。

这个简单的定理有一个强大的推论：如果 primal 问题是可行的且无界的（即 $c^\top x$ 可以无限大），那么就不可能存在任何一个可行的 dual 解 $y$，因为任何一个 $b^\top y$ 的有限值都无法成为 $c^\top x$ 的[上界](@entry_id:274738)。因此，**如果 primal 问题是无界的，那么其对偶问题必定是不可行的**。

反之，如果 primal 问题可行，且其[对偶问题](@entry_id:177454)不可行，那么 primal 问题必定是无界的。这个关系为我们提供了另一种判断无界性的视角。

一个绝佳的例子是 [@problem_id:3118352] 中提出的问题。给定一个[可行域](@entry_id:136622)，我们考察两个不同的[目标函数](@entry_id:267263) $c$ 和 $-c$。
-   对于目标 $c = \begin{pmatrix} 1 \\ 0 \end{pmatrix}$，其对偶问题被证明是不可行的。由于 primal 问题是可行的（例如 $x=0$），我们可以断定 primal 问题 $\mathcal{P}(c)$ 是无界的。这与我们在单纯形表中观察到的情况完全一致：$x_1$ 的[检验数](@entry_id:173345)为正，且其列向量为非正。
-   对于目标 $-c = \begin{pmatrix} -1 \\ 0 \end{pmatrix}$，其[对偶问题](@entry_id:177454)是可行的（例如 $y=0$ 是一个对偶[可行解](@entry_id:634783)）。由于 primal 和 dual 均可行，根据强[对偶定理](@entry_id:137804)，两者都有最优解，且最优值相等。因此，primal 问题 $\mathcal{P}(-c)$ 是有界的。这同样与单纯形表分析一致：所有[检验数](@entry_id:173345)都为非正，表明初始解 $x=0$ 即为最优解。

更进一步，[Farkas引理](@entry_id:146719)不仅能证明对偶问题的[不可行性](@entry_id:164663)，还能提供一个**[不可行性证书](@entry_id:635369)**。这个证书可以直接转化为 primal 问题的衰退方向。如 [@problem_id:3118310] 所示，对偶问题的[不可行性证书](@entry_id:635369)是一个向量 $w$，满足 $Aw \ge 0, w \le 0, c^\top w > 0$。通过简单的代换 $d = -w$，我们得到的向量 $d$ 恰好满足 primal 无界性的条件：$Ad \le 0, d \ge 0, c^\top d > 0$。这揭示了 primal 无界性与 dual [不可行性](@entry_id:164663)之间深刻的数学联系。

### 区分无界性、[不可行性](@entry_id:164663)与退化

在单纯形法的实践中，算法的终止或异常行为可能有多种原因。准确区分这些情况至关重要。

**无界性 vs. [不可行性](@entry_id:164663)**

-   **[不可行性](@entry_id:164663) (Infeasibility)** 指的是[可行域](@entry_id:136622)为[空集](@entry_id:261946)，即不存在任何满足所有约束的点。在[两阶段单纯形法](@entry_id:176724)中，[不可行性](@entry_id:164663)是在**第一阶段**结束时被检测到的。如果第一阶段的[目标函数](@entry_id:267263)（[人工变量](@entry_id:164298)之和）的最小值大于零，则意味着无法找到一个满足原约束的解，因此原问题是不可行的 [@problem_id:3118158]。
-   **无界性 (Unboundedness)** 指的是[可行域](@entry_id:136622)非空，但目标函数可以在可行域内无限增长。无界性是在**第二阶段**（或标准单阶段法中）被检测到的，其信号如前所述：存在一个[检验数](@entry_id:173345)为正的入基变量，其对应列全为非正元素 [@problem_id:3118158]。
简而言之，[不可行性](@entry_id:164663)是“找不到起点”，而无界性是“找到了起点，但发现一条没有终点的康庄大道”。

**无界性 vs. 退化**

-   **退化 (Degeneracy)** 发生在一个或多个基变量的值为零时。退化本身并不意味着问题无界或最优。然而，它可能导致单纯形法在一次迭代中[目标函数](@entry_id:267263)值不发生变化。
-   这种情况发生在[最小比率检验](@entry_id:634935)中，当最小比率为零时。这意味着入基变量的步长为零，因此[目标函数](@entry_id:267263)值没有增加。枢轴变换仍然会进行，基会发生变化，但解的几何位置保持不变。这种情况被称为**退化枢轴 (degenerate pivot)** [@problem_id:3118399]。
-   退化和无界性的关键区别在于[最小比率检验](@entry_id:634935)的结果：
    -   在**退化枢轴**中，存在至少一个正的列元素 $\bar{a}_{ij}$，但对应的右端项 $\bar{b}_i$ 为零，导致最小比率为 $\min\{\dots, 0/\bar{a}_{ij}, \dots\} = 0$。步长为零。
    -   在**无界性**中，列元素 $\bar{A}_j$ 中**没有**正元素，因此无法计算比率。步长可以为无穷大。

因此，当单纯形法迭代未能使[目标函数](@entry_id:267263)值增加时，我们必须检查其原因。如果是由于最小比率为零，则我们遇到了退化；如果是因为找不到正的列元素来计算比率，我们则发现了问题的无界性。