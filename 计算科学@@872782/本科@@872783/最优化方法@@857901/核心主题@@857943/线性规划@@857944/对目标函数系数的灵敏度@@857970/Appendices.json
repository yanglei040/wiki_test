{"hands_on_practices": [{"introduction": "在通过单纯形法找到线性规划问题的最优解后，一个自然的问题是：如果目标函数中的某个系数发生变化，当前的最优基在多大范围内仍然是最优的？本练习将指导你利用最终单纯形表，通过计算非基变量的检验数（reduced costs）并维持其最优性条件，来确定一个基变量的目标系数所允许的变化范围。这是掌握目标系数敏感性分析最核心的计算技能之一。 [@problem_id:3178640]", "problem": "考虑一个标准形式的参数线性规划 (LP) 问题，其决策变量为 $x_1$ 和 $x_2$，松弛变量为 $s_1$ 和 $s_2$：\n$$\n\\max z \\;=\\; c_1 x_1 + 3 x_2\n$$\n约束条件为\n$$\nx_1 + 2 x_2 + s_1 \\;=\\; 8,\\quad 2 x_1 + x_2 + s_2 \\;=\\; 8,\\quad x_1, x_2, s_1, s_2 \\;\\ge\\; 0.\n$$\n假设单纯形法已经产生了一个由 $\\{x_1, x_2\\}$ 组成的当前基，其最终单纯形表如下（显示了基变量行；列的顺序为 $x_1, x_2, s_1, s_2$）：\n$$\n\\begin{array}{c|rrrr|r}\n  x_1  x_2  s_1  s_2  \\text{RHS} \\\\\n\\hline\nx_1  1  0  -\\frac{1}{3}  \\frac{2}{3}  \\frac{8}{3} \\\\\nx_2  0  1  \\frac{2}{3}  -\\frac{1}{3}  \\frac{8}{3}\n\\end{array}\n$$\n仅使用线性规划的核心定义和单纯形表的结构，推导目标函数系数 $c_1$ 的允许区间，使得当前基 $\\{x_1, x_2\\}$ 对该最大化问题保持最优。将精确的下界和上界以有理数形式报告。无需四舍五入。", "solution": "问题经过验证。\n\n### 第1步：提取已知条件\n- 目标函数：$\\max z \\;=\\; c_1 x_1 + 3 x_2$\n- 约束条件：\n  - $x_1 + 2 x_2 + s_1 \\;=\\; 8$\n  - $2 x_1 + x_2 + s_2 \\;=\\; 8$\n  - $x_1, x_2, s_1, s_2 \\;\\ge\\; 0$\n- 待分析的参数系数：$c_1$\n- 当前基：$\\{x_1, x_2\\}$\n- 该基的最终单纯形表：\n$$\n\\begin{array}{c|rrrr|r}\n  x_1  x_2  s_1  s_2  \\text{RHS} \\\\\n\\hline\nx_1  1  0  -\\frac{1}{3}  \\frac{2}{3}  \\frac{8}{3} \\\\\nx_2  0  1  \\frac{2}{3}  -\\frac{1}{3}  \\frac{8}{3}\n\\end{array}\n$$\n\n### 第2步：使用提取的已知条件进行验证\n该问题是线性规划灵敏度分析中的一个标准练习，具体是分析目标函数系数的范围。\n- **科学依据**：该问题基于线性规划和单纯形法这两个完善的数学理论。它在事实上是合理的。\n- **适定性**：它要求求解一个参数的特定区间，这是灵敏度分析的标准结果。预期会有一个唯一解。\n- **客观性**：问题使用精确、无歧义的数学术语进行陈述。\n- **完整性**：所有必要信息（目标函数、约束、变量、基和最终单纯形表）均已提供。单纯形表中提供的右端项（RHS）值与原始问题约束和基的逆矩阵是一致的，这一点可以被验证。\n- **未检测到其他缺陷。**\n\n### 第3步：结论与行动\n问题是**有效的**。将推导解答。\n\n### 解答推导\n在最大化线性规划 (LP) 问题中，一个基保持最优的核心原则是所有非基变量的检验数必须为非负数。变量 $x_j$ 的检验数记为 $z_j - c_j$。因此，为使当前基保持最优，对于所有非基变量 $j$，必须满足 $z_j - c_j \\ge 0$。\n\n问题中的变量集合为 $\\{x_1, x_2, s_1, s_2\\}$。给定的基是 $\\{x_1, x_2\\}$，它们是基变量。因此，非基变量是 $\\{s_1, s_2\\}$。\n\n检验数计算公式为 $z_j - c_j = \\mathbf{c}_B^T \\mathbf{B}^{-1} \\mathbf{a}_j - c_j$，其中：\n- $\\mathbf{c}_B$ 是基变量的目标函数系数向量。\n- $\\mathbf{B}^{-1}$ 是基矩阵的逆矩阵。\n- $\\mathbf{a}_j$ 是原始约束矩阵中变量 $j$ 对应的列向量。\n- $c_j$ 是变量 $j$ 的目标函数系数。\n\n根据问题陈述，目标函数为 $z = c_1 x_1 + 3 x_2 + 0 s_1 + 0 s_2$。\n基变量是 $x_1$ 和 $x_2$。它们的目标系数向量是：\n$$ \\mathbf{c}_B^T = \\begin{pmatrix} c_1  3 \\end{pmatrix} $$\n非基变量是 $s_1$ 和 $s_2$。它们的目标系数为 $c_{s_1} = 0$ 和 $c_{s_2} = 0$。\n\n最终单纯形表给出了矩阵乘积 $\\mathbf{B}^{-1}\\mathbf{A}$，其中 $\\mathbf{A}$ 是完整的约束矩阵。最终单纯形表中非基变量下方的列对应于每个非基变量 $j$ 的 $\\mathbf{B}^{-1}\\mathbf{a}_j$。\n\n从给定的单纯形表中，我们可以提取非基变量 $s_1$ 和 $s_2$ 对应的这些列：\n- 对于 $s_1$：该列为 $\\mathbf{B}^{-1}\\mathbf{a}_{s_1} = \\begin{pmatrix} -\\frac{1}{3} \\\\ \\frac{2}{3} \\end{pmatrix}$。\n- 对于 $s_2$：该列为 $\\mathbf{B}^{-1}\\mathbf{a}_{s_2} = \\begin{pmatrix} \\frac{2}{3} \\\\ -\\frac{1}{3} \\end{pmatrix}$。\n\n现在，我们可以计算每个非基变量的检验数。\n\n1.  **$s_1$ 的检验数**：\n    $$ z_{s_1} - c_{s_1} = \\mathbf{c}_B^T (\\mathbf{B}^{-1}\\mathbf{a}_{s_1}) - c_{s_1} $$\n    $$ z_{s_1} - c_{s_1} = \\begin{pmatrix} c_1  3 \\end{pmatrix} \\begin{pmatrix} -\\frac{1}{3} \\\\ \\frac{2}{3} \\end{pmatrix} - 0 $$\n    $$ z_{s_1} - c_{s_1} = c_1 \\left(-\\frac{1}{3}\\right) + 3 \\left(\\frac{2}{3}\\right) = -\\frac{1}{3}c_1 + 2 $$\n    为了保持最优性，该值必须为非负：\n    $$ -\\frac{1}{3}c_1 + 2 \\ge 0 \\implies 2 \\ge \\frac{1}{3}c_1 \\implies 6 \\ge c_1 $$\n\n2.  **$s_2$ 的检验数**：\n    $$ z_{s_2} - c_{s_2} = \\mathbf{c}_B^T (\\mathbf{B}^{-1}\\mathbf{a}_{s_2}) - c_{s_2} $$\n    $$ z_{s_2} - c_{s_2} = \\begin{pmatrix} c_1  3 \\end{pmatrix} \\begin{pmatrix} \\frac{2}{3} \\\\ -\\frac{1}{3} \\end{pmatrix} - 0 $$\n    $$ z_{s_2} - c_{s_2} = c_1 \\left(\\frac{2}{3}\\right) + 3 \\left(-\\frac{1}{3}\\right) = \\frac{2}{3}c_1 - 1 $$\n    为了保持最优性，该值必须为非负：\n    $$ \\frac{2}{3}c_1 - 1 \\ge 0 \\implies \\frac{2}{3}c_1 \\ge 1 \\implies 2c_1 \\ge 3 \\implies c_1 \\ge \\frac{3}{2} $$\n\n为确保当前基 $\\{x_1, x_2\\}$ 保持最优，必须同时满足这两个条件。结合这两个不等式，我们得到 $c_1$ 的允许区间：\n$$ \\frac{3}{2} \\le c_1 \\le 6 $$\n$c_1$ 的下界是 $\\frac{3}{2}$，上界是 $6$。", "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{3}{2}  6 \\end{pmatrix}}\n$$", "id": "3178640"}, {"introduction": "单纯形法中的最优性检验规则并非凭空产生，其背后有深刻的对偶理论支撑。本练习将引导你从一个更根本的视角——利用对偶价格（影子价格）和Karush-Kuhn-Tucker (KKT)条件——来分析最优解的敏感性。你将计算一个当前未被使用的非基变量（$x_3$）的检验数，并确定其目标系数需要达到什么阈值才能使其变得“有利可图”从而进入基，这有助于你深刻理解最优性与对偶可行性之间的内在联系。 [@problem_id:3178669]", "problem": "考虑以下线性规划 (LP) 问题，该问题为标准不等式形式，通过引入松弛变量来获得等式。原始问题是一个最大化问题：\n$$\n\\text{maximize } c_1 x_1 + c_2 x_2 + c_3 x_3\n$$\n约束条件为\n$$\n\\begin{aligned}\n2 x_1 + x_2 + x_3 + s_1 = 8, \\\\\n- x_1 + 2 x_2 + 3 x_3 + s_2 = 10, \\\\\nx_1, x_2, x_3, s_1, s_2 \\geq 0,\n\\end{aligned}\n$$\n其中 $x_1, x_2, x_3$ 是决策变量，$s_1, s_2$ 是松弛变量。据报告，当前的最优基为 $\\{ s_1, x_2 \\}$，其相关的基本可行解由约束条件计算得出。目标系数为 $c_1 = -4$, $c_2 = 7$，而 $c_3$ 被视为一个可能变化的参数。\n\n仅使用LP对偶、基本可行解和 Karush–Kuhn–Tucker (KKT) 条件的基本定义，分析当对应变量 $x_3$ 当前为非基变量时，最优解相对于单一目标系数 $c_3$ 的灵敏度。具体而言：\n- 确定与当前基相关联的对偶价格向量（也称为影子价格）。\n- 推导出 $x_3$ 的检验数，作为 $c_3$ 的函数。\n- 计算 $x_3$ 首次有资格进入基时的 $c_3$ 精确值（即，最优性符号条件被违反以致于有利于 $x_3$ 进入基的阈值）。\n\n将最终阈值以单个实数 $c_3^\\star$ 的形式给出。请给出精确答案，不要四舍五入。", "solution": "该问题要求分析一个线性规划 (LP) 最优解对于非基变量 $x_3$ 的目标函数系数 $c_3$ 变化的灵敏度。此分析必须基于对偶性的基本原理和 Karush-Kuhn-Tucker (KKT) 条件。\n\n引入松弛变量后，原始LP问题以标准形式给出：\n$$\n\\text{maximize } z = c_1 x_1 + c_2 x_2 + c_3 x_3 + 0 s_1 + 0 s_2\n$$\n约束条件为\n$$\n\\begin{aligned}\n2 x_1 + x_2 + x_3 + s_1 = 8 \\\\\n-x_1 + 2 x_2 + 3 x_3 + s_2 = 10 \\\\\nx_1, x_2, x_3, s_1, s_2 \\geq 0\n\\end{aligned}\n$$\n目标系数为 $c_1 = -4$，$c_2 = 7$，而 $c_3$ 是一个参数。\n以矩阵形式，我们要最大化 $\\mathbf{c}^T \\mathbf{x}$，约束条件为 $\\mathbf{A}\\mathbf{x} = \\mathbf{b}$ 且 $\\mathbf{x} \\geq \\mathbf{0}$，其中：\n$$ \\mathbf{x} = \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\\\ s_1 \\\\ s_2 \\end{pmatrix}, \\quad \\mathbf{c} = \\begin{pmatrix} -4 \\\\ 7 \\\\ c_3 \\\\ 0 \\\\ 0 \\end{pmatrix}, \\quad \\mathbf{A} = \\begin{pmatrix} 2  1  1  1  0 \\\\ -1  2  3  0  1 \\end{pmatrix}, \\quad \\mathbf{b} = \\begin{pmatrix} 8 \\\\ 10 \\end{pmatrix} $$\n问题陈述当前最优基为 $\\mathcal{B} = \\{s_1, x_2\\}$。基变量集合为 $\\mathbf{x}_B = [s_1, x_2]^T$，非基变量集合为 $\\mathbf{x}_N = [x_1, x_3, s_2]^T$。\n\n基矩阵 $\\mathbf{B}$ 由 $\\mathbf{A}$ 中对应于基变量的列组成，即第4列 ($s_1$) 和第2列 ($x_2$):\n$$ \\mathbf{B} = \\begin{pmatrix} 1  1 \\\\ 0  2 \\end{pmatrix} $$\n基变量的成本向量为 $\\mathbf{c}_B = [c_{s_1}, c_{x_2}]^T = [0, 7]^T$。\n\n首先，我们验证这个基是否对应一个基本可行解 (BFS)。基变量的值由 $\\mathbf{x}_B = \\mathbf{B}^{-1}\\mathbf{b}$ 给出。我们计算 $\\mathbf{B}$ 的逆矩阵：\n$$ \\mathbf{B}^{-1} = \\frac{1}{(1)(2) - (1)(0)} \\begin{pmatrix} 2  -1 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 1  -1/2 \\\\ 0  1/2 \\end{pmatrix} $$\n现在我们计算基本解：\n$$ \\mathbf{x}_B = \\begin{pmatrix} s_1 \\\\ x_2 \\end{pmatrix} = \\begin{pmatrix} 1  -1/2 \\\\ 0  1/2 \\end{pmatrix} \\begin{pmatrix} 8 \\\\ 10 \\end{pmatrix} = \\begin{pmatrix} 8 - 5 \\\\ 0 + 5 \\end{pmatrix} = \\begin{pmatrix} 3 \\\\ 5 \\end{pmatrix} $$\n由于 $s_1 = 3 \\geq 0$ 且 $x_2 = 5 \\geq 0$，该解是可行的。完整的解向量为 $\\mathbf{x} = [0, 5, 0, 3, 0]^T$。\n\n对偶价格向量（或影子价格），记为 $\\mathbf{y}$，与约束条件相关联。对于给定的基 $\\mathbf{B}$，对偶价格由关系式 $\\mathbf{y}^T = \\mathbf{c}_B^T \\mathbf{B}^{-1}$ 定义。这个定义确保了基变量的检验数为零，这是最优性的一个必要条件。\n$$ \\mathbf{y}^T = \\begin{pmatrix} 0  7 \\end{pmatrix} \\begin{pmatrix} 1  -1/2 \\\\ 0  1/2 \\end{pmatrix} = \\begin{pmatrix} 0  7/2 \\end{pmatrix} $$\n因此，对偶价格向量为 $\\mathbf{y} = [y_1, y_2]^T = [0, 7/2]^T$。\n\nKKT 条件为最优性提供了基本依据。对于一个LP问题，它们包括原始可行性、对偶可行性和互补松弛性。变量 $x_j$ 的检验数，记为 $\\bar{c}_j$，与KKT乘子直接相关。对于最大化问题，检验数定义为 $\\bar{c}_j = c_j - \\mathbf{y}^T \\mathbf{A}_j$，其中 $\\mathbf{A}_j$ 是约束矩阵 $\\mathbf{A}$ 的第 $j$ 列。一个解是最优的当且仅当所有检验数都为非正数，即对所有 $j$ 都有 $\\bar{c}_j \\leq 0$。\n\n我们计算非基变量 $x_1$、$x_3$ 和 $s_2$ 的检验数。$\\mathbf{A}$ 的相应列为 $\\mathbf{A}_1 = [2, -1]^T$、$\\mathbf{A}_3 = [1, 3]^T$ 和 $\\mathbf{A}_5 = [0, 1]^T$。对应的成本为 $c_1=-4$、$c_3$ 和 $c_{s_2}=0$。\n\n$x_1$ 的检验数：\n$$ \\bar{c}_1 = c_1 - \\mathbf{y}^T \\mathbf{A}_1 = -4 - \\begin{pmatrix} 0  7/2 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ -1 \\end{pmatrix} = -4 - (-\\frac{7}{2}) = -\\frac{1}{2} $$\n$x_3$ 的检验数：\n$$ \\bar{c}_3 = c_3 - \\mathbf{y}^T \\mathbf{A}_3 = c_3 - \\begin{pmatrix} 0  7/2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 3 \\end{pmatrix} = c_3 - \\frac{21}{2} $$\n这就是 $x_3$ 的检验数，作为 $c_3$ 的函数。\n\n$s_2$ 的检验数：\n$$ \\bar{c}_{s_2} = c_{s_2} - \\mathbf{y}^T \\mathbf{A}_5 = 0 - \\begin{pmatrix} 0  7/2 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = -\\frac{7}{2} $$\n为使给定基为最优，所有这些检验数必须小于或等于零。\n$$ \\bar{c}_1 = -1/2 \\leq 0 \\quad (\\text{满足}) $$\n$$ \\bar{c}_{s_2} = -7/2 \\leq 0 \\quad (\\text{满足}) $$\n$$ \\bar{c}_3 = c_3 - \\frac{21}{2} \\leq 0 \\implies c_3 \\leq \\frac{21}{2} $$\n只要 $c_3 \\leq 21/2$，当前基就是最优的。\n\n如果一个非基变量的值从0开始增加能够改善目标函数，那么它就有资格进入基。对于最大化问题，这种情况发生在其检验数为正时，即 $\\bar{c}_j  0$。阈值 $c_3^\\star$ 是 $c_3$ 首次满足此条件时的值。这发生在最优区域的边界上，此时检验数变为零。\n$$ \\bar{c}_3 = 0 \\implies c_3 - \\frac{21}{2} = 0 $$\n$$ c_3^\\star = \\frac{21}{2} $$\n对于任何 $c_3  21/2$，检验数 $\\bar{c}_3$ 将为正，这表示最优性条件被违反，且 $x_3$ 是一个可以进入基以增加目标函数值的候选者。因此，阈值为 $21/2$。", "answer": "$$\\boxed{\\frac{21}{2}}$$", "id": "3178669"}, {"introduction": "敏感性分析不仅限于求解抽象的线性规划模型，它在网络优化等具体应用中也扮演着关键角色。本练习将背景设定在一个经典的最短路径问题上，其中网络中每条弧的成本都是参数 $\\theta$ 的一个线性函数。通过构建并分析所有可能路径的成本函数，你将确定随着参数 $\\theta$ 的变化，哪条路径是“最短”的，并找出导致最优路径发生切换的“临界值”，从而将抽象的参数分析概念应用于一个直观的场景。 [@problem_id:3178654]", "problem": "考虑一个有向无环网络，节点为 $s$、$a$、$b$、$c$ 和 $t$。每条弧 $e$ 的成本为参数化形式 $c_{e}(\\theta) = c_{e} + \\theta d_{e}$，其中 $\\theta \\in \\mathbb{R}$ 是一个参数，$c_{e} \\in \\mathbb{R}$ 是基础成本，$d_{e} \\in \\mathbb{R}$ 是灵敏度系数。可用弧及其系数如下：\n- 从 $s$ 到 $a$：$c_{sa} = 4$，$d_{sa} = 1$。\n- 从 $s$ 到 $b$：$c_{sb} = 2$，$d_{sb} = 3$。\n- 从 $s$ 到 $c$：$c_{sc} = 10$，$d_{sc} = -2$。\n- 从 $a$ 到 $c$：$c_{ac} = 3$，$d_{ac} = 2$。\n- 从 $a$ 到 $t$：$c_{at} = 9$，$d_{at} = -1$。\n- 从 $b$ 到 $c$：$c_{bc} = 2$，$d_{bc} = 2$。\n- 从 $b$ 到 $t$：$c_{bt} = 7$，$d_{bt} = 0$。\n- 从 $c$ 到 $t$：$c_{ct} = 1$，$d_{ct} = 4$。\n\n一条路径的成本是其所有弧成本的总和。使用最短路径是最小化总路径成本的基本定义，通过明确写出所有从 $s$ 到 $t$ 的路径成本函数（作为 $\\theta$ 的函数）来构建参数化最短路径问题。然后，通过识别最优路径发生变化时的 $\\theta$ 的临界值，确定当 $\\theta$ 在 $\\mathbb{R}$ 上变化时的最优路径序列。将这些临界参数值的有序集合作为一个单行矩阵报告为您的最终答案，使用精确分数。不需要四舍五入。", "solution": "首先根据指定标准对问题进行验证。\n\n### 第 1 步：提取已知条件\n- **节点**：有向无环网络中的 $s$、$a$、$b$、$c$、$t$。\n- **参数化弧成本**：对于每条弧 $e$，成本为 $c_{e}(\\theta) = c_{e} + \\theta d_{e}$，其中 $\\theta \\in \\mathbb{R}$。\n- **弧成本系数**：\n  - 弧 $(s,a)$: $c_{sa} = 4$, $d_{sa} = 1$。\n  - 弧 $(s,b)$: $c_{sb} = 2$, $d_{sb} = 3$。\n  - 弧 $(s,c)$: $c_{sc} = 10$, $d_{sc} = -2$。\n  - 弧 $(a,c)$: $c_{ac} = 3$, $d_{ac} = 2$。\n  - 弧 $(a,t)$: $c_{at} = 9$, $d_{at} = -1$。\n  - 弧 $(b,c)$: $c_{bc} = 2$, $d_{bc} = 2$。\n  - 弧 $(b,t)$: $c_{bt} = 7$, $d_{bt} = 0$。\n  - 弧 $(c,t)$: $c_{ct} = 1$, $d_{ct} = 4$。\n- **任务**：\n  1. 写出所有 $s$–$t$ 路径的路径成本函数。\n  2. 确定当 $\\theta$ 变化时最优路径的序列。\n  3. 识别最优路径发生变化时的 $\\theta$ 临界值。\n  4. 将临界值的有序集合以行矩阵形式报告。\n\n### 第 2 步：使用提取的已知条件进行验证\n对问题进行严格审查：\n- **科学依据**：该问题是关于最短路径问题的参数化灵敏度分析的一个标准练习，这是网络优化和运筹学中的一个基本主题。该模型基于已建立的数学原理。\n- **适定性**：该问题定义在一个有向无环图（DAG）上，这保证了所有路径都是简单路径。成本函数是关于单个参数 $\\theta$ 的线性函数。目标是找到最短路径，这是一个明确定义的问题。因为成本函数是线性的，所以最小成本函数（下包络线）是一个分段线性凹函数，确保了对于所有 $\\theta$ 都存在唯一解，除了在有限数量的临界点上，此时可能有多条路径都是最优的。\n- **客观性**：问题使用精确的数学语言和数值数据陈述。没有主观或含糊不清的术语。\n- **完整性和一致性**：所有必要的数据（图结构、成本参数）都已提供，并且没有内部矛盾。\n- **其他标准**：该问题不违反任何其他验证标准。它是一个形式化的、可解的问题。\n\n### 第 3 步：结论与行动\n该问题是有效且适定的。将制定一个完整的解决方案。\n\n问题要求当参数 $\\theta$ 变化时，找出从节点 $s$ 到节点 $t$ 的最短路径序列。任何路径的成本是其所有弧成本的总和。\n\n首先，我们必须枚举给定有向无环图中从 $s$ 到 $t$ 的所有简单路径。\n这些路径是：\n1. $P_1: s \\rightarrow a \\rightarrow c \\rightarrow t$\n2. $P_2: s \\rightarrow a \\rightarrow t$\n3. $P_3: s \\rightarrow b \\rightarrow c \\rightarrow t$\n4. $P_4: s \\rightarrow b \\rightarrow t$\n5. $P_5: s \\rightarrow c \\rightarrow t$\n\n接下来，我们为每条路径 $P_i$ 构建总成本函数 $f_i(\\theta)$，方法是将其路径中所有弧的参数化成本相加。一般形式为 $f_i(\\theta) = C_i + \\theta D_i$，其中 $C_i$ 是路径 $P_i$ 中各条弧的基础成本 $c_e$ 的总和，$D_i$ 是灵敏度系数 $d_e$ 的总和。\n\n1.  对于 $P_1: s \\rightarrow a \\rightarrow c \\rightarrow t$：\n    $C_1 = c_{sa} + c_{ac} + c_{ct} = 4 + 3 + 1 = 8$\n    $D_1 = d_{sa} + d_{ac} + d_{ct} = 1 + 2 + 4 = 7$\n    $f_1(\\theta) = 8 + 7\\theta$\n\n2.  对于 $P_2: s \\rightarrow a \\rightarrow t$：\n    $C_2 = c_{sa} + c_{at} = 4 + 9 = 13$\n    $D_2 = d_{sa} + d_{at} = 1 + (-1) = 0$\n    $f_2(\\theta) = 13$\n\n3.  对于 $P_3: s \\rightarrow b \\rightarrow c \\rightarrow t$：\n    $C_3 = c_{sb} + c_{bc} + c_{ct} = 2 + 2 + 1 = 5$\n    $D_3 = d_{sb} + d_{bc} + d_{ct} = 3 + 2 + 4 = 9$\n    $f_3(\\theta) = 5 + 9\\theta$\n\n4.  对于 $P_4: s \\rightarrow b \\rightarrow t$：\n    $C_4 = c_{sb} + c_{bt} = 2 + 7 = 9$\n    $D_4 = d_{sb} + d_{bt} = 3 + 0 = 3$\n    $f_4(\\theta) = 9 + 3\\theta$\n\n5.  对于 $P_5: s \\rightarrow c \\rightarrow t$：\n    $C_5 = c_{sc} + c_{ct} = 10 + 1 = 11$\n    $D_5 = d_{sc} + d_{ct} = -2 + 4 = 2$\n    $f_5(\\theta) = 11 + 2\\theta$\n\n对于给定的 $\\theta$，最短路径成本为 $f^*(\\theta) = \\min \\{f_1(\\theta), f_2(\\theta), f_3(\\theta), f_4(\\theta), f_5(\\theta)\\}$。该函数 $f^*(\\theta)$ 表示这组线性路径成本函数的下包络线。$\\theta$ 的临界值是使最小化路径发生变化的那些点。这些是分段线性凹函数 $f^*(\\theta)$ 的断点。\n\n为了找到这些断点，我们分析在 $\\theta$ 的不同范围内哪条路径是最优的。\n- 当 $\\theta \\to -\\infty$ 时，路径成本由斜率 $D_i$ 最大的一项主导。最小成本将由 $D_i$ 最大的路径实现。这些斜率分别是 $D_1=7, D_2=0, D_3=9, D_4=3, D_5=2$。最大的斜率是 $D_3=9$，因此对于足够小的 $\\theta$，路径 $P_3$ 是最优的。\n- 当 $\\theta \\to +\\infty$ 时，路径成本由斜率 $D_i$ 最小的一项主导。最小成本将由 $D_i$ 最小的路径实现。最小的斜率是 $D_2=0$，因此对于足够大的 $\\theta$，路径 $P_2$ 是最优的。\n\n随着 $\\theta$ 的增加，最优路径的序列将从 $P_3$ 过渡到其他路径，并最终过渡到 $P_2$。过渡发生在构成下包络线的成本函数的交点处。\n\n我们从路径 $P_3$ 是最优的开始，通过增加 $\\theta$ 来寻找第一个临界点。我们计算 $f_3(\\theta)$ 与所有其他函数的交点：\n- $f_3(\\theta) = f_1(\\theta) \\implies 5 + 9\\theta = 8 + 7\\theta \\implies 2\\theta = 3 \\implies \\theta = \\frac{3}{2}$\n- $f_3(\\theta) = f_2(\\theta) \\implies 5 + 9\\theta = 13 \\implies 9\\theta = 8 \\implies \\theta = \\frac{8}{9}$\n- $f_3(\\theta) = f_4(\\theta) \\implies 5 + 9\\theta = 9 + 3\\theta \\implies 6\\theta = 4 \\implies \\theta = \\frac{2}{3}$\n- $f_3(\\theta) = f_5(\\theta) \\implies 5 + 9\\theta = 11 + 2\\theta \\implies 7\\theta = 6 \\implies \\theta = \\frac{6}{7}$\n\n这些交点值中最小的是 $\\theta = \\frac{2}{3}$。这是第一个临界点的候选值。在 $\\theta = \\frac{2}{3}$ 时，$f_3(\\theta) = f_4(\\theta) = 5 + 9(\\frac{2}{3}) = 11$。对于 $\\theta   \\frac{2}{3}$，$f_3(\\theta)  f_4(\\theta)$。我们必须验证对于所有 $\\theta  \\frac{2}{3}$，$P_3$ 确实是最优的。这要求对于所有 $j \\in \\{1, 2, 4, 5\\}$ 和所有 $\\theta  \\frac{2}{3}$，都有 $f_3(\\theta) \\le f_j(\\theta)$。如果 $\\theta$ 小于上面找到的所有交点，这个条件就成立，而对于 $\\theta  \\frac{2}{3}$ 这是正确的。因此，对于 $\\theta \\in (-\\infty, \\frac{2}{3}]$，$P_3$ 是最优路径。在 $\\theta=\\frac{2}{3}$ 时，最优路径从 $P_3$ 变为 $P_4$。因此，$\\theta_1 = \\frac{2}{3}$ 是第一个临界值。\n\n现在，对于 $\\theta > \\frac{2}{3}$，路径 $P_4$ 是新的最优路径。我们计算它与其他路径的交点来寻找下一个临界点。\n- $f_4(\\theta) = f_1(\\theta) \\implies 9 + 3\\theta = 8 + 7\\theta \\implies 1 = 4\\theta \\implies \\theta = \\frac{1}{4}$。这小于 $\\frac{2}{3}$，因此与下一次转换无关。\n- $f_4(\\theta) = f_2(\\theta) \\implies 9 + 3\\theta = 13 \\implies 3\\theta = 4 \\implies \\theta = \\frac{4}{3}$。\n- $f_4(\\theta) = f_5(\\theta) \\implies 9 + 3\\theta = 11 + 2\\theta \\implies \\theta = 2$。\n\n对于 $\\theta > \\frac{2}{3}$ 的下一个潜在临界点是 $\\{\\frac{4}{3}, 2\\}$ 中的最小值，即 $\\theta = \\frac{4}{3}$。在这一点上，$f_4(\\theta) = f_2(\\theta) = 9 + 3(\\frac{4}{3}) = 13$。对于 $\\theta \\in (\\frac{2}{3}, \\frac{4}{3})$，$f_4(\\theta)  f_2(\\theta)$。我们必须检查 $P_4$ 在此区间内是否为最优。为了使 $P_4$ 在 $[\\frac{2}{3}, \\frac{4}{3}]$ 上为最优，我们需要对于 $j \\in \\{1,2,3,5\\}$ 都有 $f_4(\\theta) \\le f_j(\\theta)$。\n- $f_4(\\theta) \\le f_1(\\theta) \\implies \\theta \\ge \\frac{1}{4}$（在此区间内成立）。\n- $f_4(\\theta) \\le f_2(\\theta) \\implies \\theta \\le \\frac{4}{3}$（在此区间内成立）。\n- $f_4(\\theta) \\le f_3(\\theta) \\implies \\theta \\ge \\frac{2}{3}$（在此区间内成立）。\n- $f_4(\\theta) \\le f_5(\\theta) \\implies \\theta \\le 2$（在此区间内成立）。\n因此，对于 $\\theta \\in [\\frac{2}{3}, \\frac{4}{3}]$，$P_4$ 是最优路径。在 $\\theta = \\frac{4}{3}$ 时，最优路径从 $P_4$ 变为 $P_2$。因此，$\\theta_2 = \\frac{4}{3}$ 是第二个临界值。\n\n对于 $\\theta > \\frac{4}{3}$，路径 $P_2$ 是新的最优路径。我们检查它与其他函数在 $\\theta > \\frac{4}{3}$ 时的交点。\n- $f_2(\\theta) = f_1(\\theta) \\implies 13 = 8 + 7\\theta \\implies 7\\theta = 5 \\implies \\theta = \\frac{5}{7}$。（小于 $\\frac{4}{3}$）\n- $f_2(\\theta) = f_3(\\theta) \\implies 13 = 5 + 9\\theta \\implies 9\\theta = 8 \\implies \\theta = \\frac{8}{9}$。（小于 $\\frac{4}{3}$）\n- $f_2(\\theta) = f_5(\\theta) \\implies 13 = 11 + 2\\theta \\implies 2\\theta = 2 \\implies \\theta = 1$。（小于 $\\frac{4}{3}$）\n由于 $f_2(\\theta)$ 与其他函数的所有交点都发生在 $\\theta  \\frac{4}{3}$，因此对于 $\\theta > \\frac{4}{3}$，最优路径不再有进一步的变化。路径 $P_2$ 在所有 $\\theta \\in [\\frac{4}{3}, \\infty)$ 上都保持最优。\n\n最优路径的序列是：\n- $P_3$ 适用于 $\\theta \\in (-\\infty, \\frac{2}{3}]$\n- $P_4$ 适用于 $\\theta \\in [\\frac{2}{3}, \\frac{4}{3}]$\n- $P_2$ 适用于 $\\theta \\in [\\frac{4}{3}, \\infty)$\n\n最优路径发生变化的点是临界值。临界值的有序集合是 $\\{\\frac{2}{3}, \\frac{4}{3}\\}$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{2}{3}  \\frac{4}{3}\n\\end{pmatrix}\n}\n$$", "id": "3178654"}]}