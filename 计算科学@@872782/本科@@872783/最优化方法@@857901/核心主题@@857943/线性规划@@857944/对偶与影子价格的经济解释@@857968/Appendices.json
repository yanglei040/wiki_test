{"hands_on_practices": [{"introduction": "这个练习使用一个经典的农业规划场景，为影子价格提供一个具体的入门介绍。通过比较正常年份和干旱年份，我们将亲眼看到一种资源（在这里是水）的经济价值不是固定的，而是由其稀缺性决定的。这个实践将帮助你建立直觉，理解为什么影子价格是资源管理的有力指标。[@problem_id:3124428]", "problem": "一个农场计划生产两种作物，将 $x_1$ 英亩土地分配给作物 A，将 $x_2$ 英亩土地分配给作物 B。作物 A 的每英亩利润为 $p_A = 300$，作物 B 的每英亩利润为 $p_B = 120$，单位为货币单位/英亩。作物 A 每英亩需要 $w_A = 4$ 单位的水，作物 B 每英亩需要 $w_B = 1$ 单位的水。该农场总共拥有 $L = 100$ 英亩的土地。水的可用量因情景而异：在正常情景下，水的可用量为 $W_N = 500$ 单位；在干旱情景下，水的可用量为 $W_D = 80$ 单位。\n\n农场选择 $(x_1, x_2)$ 以在资源约束下最大化总利润。请用决策变量 $x_1$ 和 $x_2$ 构建原始线性规划 (LP) 模型，并构建其对偶模型，其中对偶变量为 $y_L$（土地的影子价格）和 $y_W$（水的影子价格）。使用 LP 对偶性的基本定义、互补松弛性以及影子价格作为放松约束的边际价值的经济解释，确定在每种情景下哪些约束是紧约束，并计算正常和干旱情景下水的影子价格 $y_W$。\n\n最后，计算干旱和正常情景下水影子价格的差值，定义为 $\\Delta = y_W^{(D)} - y_W^{(N)}$，并用货币单位/单位水的形式表达您的最终数值答案。无需四舍五入。在您的推理中，解释随着水的可用性相对于土地的变化而发生的任何机制转换，以及紧约束如何决定影子价格。", "solution": "该问题要求在两种不同的资源情景下，构建并求解一个线性规划 (LP) 问题，以确定每种情况下水的影子价格。\n\n首先，我们验证问题陈述。\n\n**步骤1：提取已知条件**\n- 决策变量：$x_1$（作物 A 的英亩数），$x_2$（作物 B 的英亩数）。\n- 作物 A 的每英亩利润：$p_A = 300$ 货币单位/英亩。\n- 作物 B 的每英亩利润：$p_B = 120$ 货币单位/英亩。\n- 作物 A 的需水量：$w_A = 4$ 单位/英亩。\n- 作物 B 的需水量：$w_B = 1$ 单位/英亩。\n- 可用土地总量：$L = 100$ 英亩。\n- 正常可用水量：$W_N = 500$ 单位。\n- 干旱可用水量：$W_D = 80$ 单位。\n- 对偶变量：$y_L$（土地的影子价格），$y_W$（水的影子价格）。\n- 目标：最大化总利润，找出每种情景下的影子价格 $y_W$，并计算差值 $\\Delta = y_W^{(D)} - y_W^{(N)}$。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题是线性规划在资源分配中的一个标准的、定义明确的应用，是优化方法中的一个核心课题。所提供的数据是完整的、数值上一致的，并且在经济建模的背景下具有科学依据。问题是客观的、适定的，能够导出一个唯一且有意义的解。没有违反验证标准。\n\n**结论：该问题有效。**\n\n我们继续求解。\n\n**原始和对偶 LP 模型构建**\n目标是最大化总利润 $Z$。原始 LP 模型可以构建如下：\n$$\n\\text{最大化} \\quad Z = 300x_1 + 120x_2\n$$\n约束条件为：\n$$\n\\begin{align*}\nx_1 + x_2 \\le 100   \\text{(土地约束)} \\\\\n4x_1 + x_2 \\le W   \\text{(水资源约束)} \\\\\nx_1, x_2 \\ge 0   \\text{(非负性)}\n\\end{align*}\n$$\n其中 $W$ 是总可用水量。\n\n相应的对偶 LP 模型，其中对偶变量 $y_L$ 和 $y_W$ 分别代表土地和水的影子价格，如下所示：\n$$\n\\text{最小化} \\quad C = 100y_L + W y_W\n$$\n约束条件为：\n$$\n\\begin{align*}\ny_L + 4y_W \\ge 300   \\text{(对应 } x_1 \\text{ 的对偶约束)} \\\\\ny_L + y_W \\ge 120   \\text{(对应 } x_2 \\text{ 的对偶约束)} \\\\\ny_L, y_W \\ge 0   \\text{(非负性)}\n\\end{align*}\n$$\n\n**正常情景分析 ($W = W_N = 500$)**\n原始问题为：\n$$\n\\text{最大化} \\quad Z = 300x_1 + 120x_2\n$$\n约束条件为：\n$$\n\\begin{align*}\nx_1 + x_2 \\le 100 \\\\\n4x_1 + x_2 \\le 500 \\\\\nx_1, x_2 \\ge 0\n\\end{align*}\n$$\n让我们分析约束条件。对于满足土地约束（$x_1+x_2 \\le 100$ 且 $x_1, x_2 \\ge 0$）的任何可行点，我们有 $x_1 \\le 100$。我们可以将耗水量写为 $4x_1 + x_2 = 3x_1 + (x_1+x_2)$。由于 $x_1 \\le 100$ 且 $x_1+x_2 \\le 100$，在土地约束下的最大可能耗水量为 $3(100) + 100 = 400$。因为 $400  500$，所以如果满足土地约束，水资源约束 $4x_1 + x_2 \\le 500$ 总是被满足。因此，水资源约束是冗余的。\n\n问题简化为：\n$$\n\\text{最大化} \\quad Z = 300x_1 + 120x_2 \\quad \\text{约束于} \\quad x_1 + x_2 \\le 100, \\ x_1, x_2 \\ge 0.\n$$\n由于作物 A 的每英亩利润（$p_A = 300$）大于作物 B 的（$p_B = 120$），最优策略是将所有土地分配给作物 A。\n最优解为 $x_1^{(N)*} = 100$ 和 $x_2^{(N)*} = 0$。\n\n现在，我们使用互补松弛性条件来确定影子价格。\n1.  原始问题的水资源约束不是紧约束：$4x_1^{(N)*} + x_2^{(N)*} = 4(100) + 0 = 400  500$。因此，其对应的对偶变量必须为零：$y_W^{(N)} = 0$。\n2.  原始问题的土地约束是紧约束：$x_1^{(N)*} + x_2^{(N)*} = 100 + 0 = 100$。其对偶变量 $y_L^{(N)}$ 可以非零。\n3.  原始变量 $x_1^{(N)*}  0$，所以其对应的对偶约束必须是紧约束：$y_L^{(N)} + 4y_W^{(N)} = 300$。\n4.  原始变量 $x_2^{(N)*} = 0$，所以其对应的对偶约束可能不是紧约束。我们必须检查：$y_L^{(N)} + y_W^{(N)} \\ge 120$。\n\n将 $y_W^{(N)} = 0$ 代入紧的对偶约束中得到：\n$y_L^{(N)} + 4(0) = 300 \\implies y_L^{(N)} = 300$。\n检查另一个对偶约束：$300 + 0 = 300 \\ge 120$，该条件成立。\n正常情景下的影子价格为 $y_L^{(N)} = 300$ 和 $y_W^{(N)} = 0$。这在经济学上是直观的：在水资源过剩的情况下，额外一单位的水没有边际价值。\n\n**干旱情景分析 ($W = W_D = 80$)**\n原始问题为：\n$$\n\\text{最大化} \\quad Z = 300x_1 + 120x_2\n$$\n约束条件为：\n$$\n\\begin{align*}\nx_1 + x_2 \\le 100 \\\\\n4x_1 + x_2 \\le 80 \\\\\nx_1, x_2 \\ge 0\n\\end{align*}\n$$\n在这种情况下，对于任何满足水资源约束（$4x_1+x_2 \\le 80$ 且 $x_1, x_2 \\ge 0$）的点，我们有 $x_1+x_2 \\le 4x_1+x_2 \\le 80$。由于 $80  100$，如果满足水资源约束，则土地约束 $x_1+x_2 \\le 100$ 总是被满足。因此，土地约束是冗余的。\n\n问题简化为：\n$$\n\\text{最大化} \\quad Z = 300x_1 + 120x_2 \\quad \\text{约束于} \\quad 4x_1 + x_2 \\le 80, \\ x_1, x_2 \\ge 0.\n$$\n在这个缺水机制下，限制性资源是水。我们必须选择单位用水利润最高的作物。\n- 作物 A 的单位用水利润：$\\frac{p_A}{w_A} = \\frac{300}{4} = 75$。\n- 作物 B 的单位用水利润：$\\frac{p_B}{w_B} = \\frac{120}{1} = 120$。\n由于作物 B 的单位用水利润更高，最优策略是将所有可用水资源分配给作物 B。\n通过设置 $x_1=0$ 并将全部水预算用于 $x_2$ 来找到最优解：$4(0) + x_2 = 80 \\implies x_2 = 80$。\n最优解为 $x_1^{(D)*} = 0$ 和 $x_2^{(D)*} = 80$。\n\n我们使用互补松弛性来确定影子价格：\n1.  原始问题的土地约束不是紧约束：$x_1^{(D)*} + x_2^{(D)*} = 0 + 80 = 80  100$。因此，其对应的对偶变量必须为零：$y_L^{(D)} = 0$。\n2.  原始问题的水资源约束是紧约束：$4x_1^{(D)*} + x_2^{(D)*} = 4(0) + 80 = 80$。其对偶变量 $y_W^{(D)}$ 可以非零。\n3.  原始变量 $x_2^{(D)*}  0$，所以其对应的对偶约束必须是紧约束：$y_L^{(D)} + y_W^{(D)} = 120$。\n4.  原始变量 $x_1^{(D)*} = 0$，所以其对偶约束可能不是紧约束。我们必须检查：$y_L^{(D)} + 4y_W^{(D)} \\ge 300$。\n\n将 $y_L^{(D)} = 0$ 代入紧的对偶约束中得到：\n$0 + y_W^{(D)} = 120 \\implies y_W^{(D)} = 120$。\n检查另一个对偶约束：$0 + 4(120) = 480 \\ge 300$，该条件成立。\n干旱情景下的影子价格为 $y_L^{(D)} = 0$ 和 $y_W^{(D)} = 120$。这在经济学上也是直观的：土地资源过剩，所以其边际价值为零。额外一单位的水将被分配给作物 B（用水效率最高的作物），产生 120 的边际利润。\n\n**机制转换与最终计算**\n这两种情景展示了基于资源稀缺性的机制转换。\n- 在正常情景下，土地是限制性资源，所以农场优先选择每英亩利润最高的作物（A）。水资源充足，所以其影子价格为 $y_W^{(N)} = 0$。\n- 在干旱情景下，水是限制性资源，所以农场优先选择单位用水利润最高的作物（B）。土地资源充足，所以其影子价格为零，而水的影子价格由水在其最佳用途中的边际生产力决定：$y_W^{(D)} = 120$。\n\n两种情景下水影子价格的差值为：\n$$\n\\Delta = y_W^{(D)} - y_W^{(N)} = 120 - 0 = 120\n$$\n\n最终答案是 $120$ 货币单位/单位水。", "answer": "$$\\boxed{120}$$", "id": "3124428"}, {"introduction": "在对影子价格有了基础理解之后，这个实践将深入探讨一个关键的现实世界应用：电力市场。我们将对一个简化的电网进行建模，并发现所谓的“节点边际电价”（LMPs）正是电力平衡约束的影子价格。你将计算输电线路拥堵如何在不同地点之间产生价格差异，并量化由此产生的“拥堵租金”，这是市场设计中的一个核心概念。[@problem_id:3124474]", "problem": "考虑一个两节点直流最优潮流 (DC-OPF) 实例，该实例体现了对偶性和影子价格的经济学解释。节点$1$有一台发电机，其线性边际成本为每兆瓦时$20$美元，且没有约束性的容量限制。节点$2$有一台发电机，其线性边际成本为每兆瓦时$50$美元，且没有约束性的容量限制。节点$1$的有功功率需求为$d_{1} = 0$兆瓦，节点$2$的有功功率需求为$d_{2} = 150$兆瓦。从节点$1$到节点$2$的单条输电线路的绝对热极限为$60$兆瓦，即功率流$f_{12}$必须满足$-60 \\le f_{12} \\le 60$。假设网络无损耗，并采用标准的直流潮流符号约定，即正值$f_{12}$表示从节点$1$发送到节点$2$的功率。\n\n将DC-OPF问题构建为一个线性规划问题，决策变量为$g_{1}$、$g_{2}$和$f_{12}$：\n- 目标：最小化总发电成本。\n- 约束条件：每个节点的功率平衡以及线路潮流限制$-60 \\le f_{12} \\le 60$。\n\n以凸优化中的Karush–Kuhn–Tucker (KKT) 条件为基础，通过将节点边际电价 (LMP) 识别为与节点平衡约束相关的拉格朗日乘子（对偶变量）来推导它们。展示线路的影子价格（线路上下潮流极限的对偶变量）如何进入线路潮流的一阶最优性条件，并由此解释当线路发生拥塞时的价格分离。然后求解最优调度，并计算由对偶变量所隐含的总拥塞租金。\n\n以美元/小时为单位表示最终的拥塞租金，并将最终答案四舍五入到四位有效数字。在最终的方框答案中不要包含单位。", "solution": "用户提供了一个电力系统优化领域的适定问题。该问题具有科学依据，使用标准的直流最优潮流 (DC-OPF) 模型来探讨节点边际电价 (LMP) 和拥塞租金的经济学概念。所有必要的数据都已提供，且问题内部一致。因此，将推导出一个解决方案。\n\n首先，我们将DC-OPF问题构建为一个线性规划 (LP) 问题。目标是最小化总发电成本，即各发电机成本之和。\n\n决策变量：\n- $g_1$：节点$1$的发电功率（单位：MW）。\n- $g_2$：节点$2$的发电功率（单位：MW）。\n- $f_{12}$：从节点$1$到节点$2$的功率流（单位：MW）。\n\n目标函数：\n最小化 $C = 20 g_1 + 50 g_2$\n\n约束条件：\n该问题受每个节点的功率平衡和输电线路的热极限约束。我们还包括了发电量不能为负的隐含物理约束。\n1.  节点$1$的功率平衡：$g_1 - d_1 - f_{12} = 0$。由于$d_1=0$，该式变为$g_1 - f_{12} = 0$。我们将拉格朗日乘子（对偶变量）$\\lambda_1$与此约束关联。\n2.  节点$2$的功率平衡：$g_2 - d_2 + f_{12} = 0$。由于$d_2=150$，该式变为$g_2 + f_{12} = 150$。我们将拉格朗日乘子$\\lambda_2$与此约束关联。\n3.  线路潮流上限：$f_{12} \\le 60$。我们将拉格朗日乘子$\\mu_{12}^{\\text{max}}$与此约束关联。\n4.  线路潮流下限：$-f_{12} \\le 60$。我们将拉格朗日乘子$\\mu_{12}^{\\text{min}}$与此约束关联。\n5.  发电量非负性：$g_1 \\ge 0$ 且 $g_2 \\ge 0$。我们分别将乘子$\\eta_1$和$\\eta_2$与此关联。\n\n该问题的拉格朗日函数$\\mathcal{L}$为：\n$$\n\\mathcal{L} = 20g_1 + 50g_2 + \\lambda_1(f_{12} - g_1) + \\lambda_2(150 - g_2 - f_{12}) + \\mu_{12}^{\\text{max}}(f_{12} - 60) + \\mu_{12}^{\\text{min}}(-f_{12} - 60) - \\eta_1 g_1 - \\eta_2 g_2\n$$\n\n最优性的Karush-Kuhn-Tucker (KKT) 条件是：\n1.  **平稳性 (Stationarity)**：$\\mathcal{L}$关于主变量的偏导数必须为零。\n    $$ \\frac{\\partial \\mathcal{L}}{\\partial g_1} = 20 - \\lambda_1 - \\eta_1 = 0 $$\n    $$ \\frac{\\partial \\mathcal{L}}{\\partial g_2} = 50 - \\lambda_2 - \\eta_2 = 0 $$\n    $$ \\frac{\\partial \\mathcal{L}}{\\partial f_{12}} = \\lambda_1 - \\lambda_2 + \\mu_{12}^{\\text{max}} - \\mu_{12}^{\\text{min}} = 0 $$\n2.  **原始可行性 (Primal Feasibility)**：原始约束必须被满足。\n    $$ g_1 - f_{12} = 0 $$\n    $$ g_2 + f_{12} = 150 $$\n    $$ f_{12} \\le 60 $$\n    $$ -f_{12} \\le 60 $$\n    $$ g_1 \\ge 0, g_2 \\ge 0 $$\n3.  **对偶可行性 (Dual Feasibility)**：不等式约束的拉格朗日乘子必须为非负。\n    $$ \\mu_{12}^{\\text{max}} \\ge 0, \\mu_{12}^{\\text{min}} \\ge 0, \\eta_1 \\ge 0, \\eta_2 \\ge 0 $$\n4.  **互补松弛性 (Complementary Slackness)**：不等式约束的乘子与其松弛量的乘积必须为零。\n    $$ \\mu_{12}^{\\text{max}}(f_{12} - 60) = 0 $$\n    $$ \\mu_{12}^{\\text{min}}(-f_{12} - 60) = 0 $$\n    $$ \\eta_1 g_1 = 0 $$\n    $$ \\eta_2 g_2 = 0 $$\n\n为了求解这个系统，我们假设两台发电机都将被调度以满足负荷（即，$g_1  0$ 且 $g_2  0$）。这个假设是合理的，因为由于线路限制，节点$1$的廉价发电机不足以满足$150$兆瓦的总负荷，需要节点$2$的发电机运行。如果$g_1  0$且$g_2  0$，那么根据互补松弛性，$\\eta_1=0$且$\\eta_2=0$。\n\n$g_1$和$g_2$的平稳性条件简化为：\n$$ 20 - \\lambda_1 = 0 \\implies \\lambda_1 = 20 $$\n$$ 50 - \\lambda_2 = 0 \\implies \\lambda_2 = 50 $$\n这些对偶变量$\\lambda_1$和$\\lambda_2$分别是节点$1$和节点$2$的节点边际电价 (LMP)，单位为美元/兆瓦时。\n\n将这些LMP值代入$f_{12}$的平稳性条件中：\n$$ 20 - 50 + \\mu_{12}^{\\text{max}} - \\mu_{12}^{\\text{min}} = 0 \\implies \\mu_{12}^{\\text{max}} - \\mu_{12}^{\\text{min}} = 30 $$\n\n现在，我们分析输电线路的状态。\n- 如果线路未发生拥塞（$-60  f_{12}  60$），互补松弛性将要求$\\mu_{12}^{\\text{max}} = 0$和$\\mu_{12}^{\\text{min}} = 0$。这将导致$30 = 0$，这是一个矛盾。因此，线路必定发生拥塞。\n- 从节点$1$（成本较低）向节点$2$（成本较高）输电存在经济激励，因此我们测试$1 \\to 2$方向的拥塞情况。假设$f_{12} = 60$。这意味着约束$f_{12} \\le 60$是紧的，所以$\\mu_{12}^{\\text{max}} \\ge 0$。另一个线路约束$-f_{12} \\le 60$不是紧的，所以$\\mu_{12}^{\\text{min}} = 0$。潮流的平稳性方程变为$\\mu_{12}^{\\text{max}} - 0 = 30$，因此$\\mu_{12}^{\\text{max}} = 30$。这与对偶可行性（$\\mu_{12}^{\\text{max}} \\ge 0$）一致。\n\n当$f_{12}^* = 60$ MW时，我们从功率平衡方程中找到最优的发电调度：\n$$ g_1^* = f_{12}^* = 60 \\text{ MW} $$\n$$ g_2^* = 150 - f_{12}^* = 150 - 60 = 90 \\text{ MW} $$\n由于$g_1^*  0$且$g_2^*  0$，我们的初始假设成立。我们找到了唯一的KKT点，对于一个凸线性规划问题，这就是全局最优点。\n\n最优解为：调度$g_1^*=60$ MW和$g_2^*=90$ MW，功率流为$f_{12}^*=60$ MW。LMP分别为$\\lambda_1=20$ \\$/MWh和$\\lambda_2=50$ \\$/MWh。线路极限的影子价格为$\\mu_{12}^{\\text{max}}=30$ \\$/(MWh)和$\\mu_{12}^{\\text{min}}=0$。\n\n价格分离可以通过潮流的平稳性条件$\\lambda_2 - \\lambda_1 = \\mu_{12}^{\\text{max}} - \\mu_{12}^{\\text{min}}$来解释。当线路未拥塞时，影子价格为零，LMP相等。当从节点$1$到节点$2$的线路发生拥塞时，节点$2$的价格与节点$1$的价格分离。差价$\\lambda_2 - \\lambda_1 = 50 - 20 = 30$ \\$/MWh，恰好等于拥塞线路极限的影子价格$\\mu_{12}^{\\text{max}}$。这个差价反映了输电拥塞的边际成本；它是如果线路容量增加一个边际单位（1 MW），总系统成本将减少的数额。\n\n总拥塞租金是输电运营商收取的收入。它通过拥塞线路上的潮流乘以该线路两端的LMP差值来计算。\n$$ \\text{拥塞租金} = f_{12}^* \\times (\\lambda_2 - \\lambda_1) $$\n$$ \\text{拥塞租金} = 60 \\text{ MW} \\times (50 \\text{ \\$/MWh} - 20 \\text{ \\$/MWh}) $$\n$$ \\text{拥塞租金} = 60 \\times 30 = 1800 \\text{ \\$/h} $$\n或者，租金是拥塞容量的价值，由容量极限乘以其影子价格得出：\n$$ \\text{拥塞租金} = \\mu_{12}^{\\text{max}} \\times (\\text{线路极限}) = 30 \\text{ \\$/(MWh)} \\times 60 \\text{ MW} = 1800 \\text{ \\$/h} $$\n结果是每小时$1800$美元。问题要求答案四舍五入到四位有效数字。我们将$1800$表示为$1.800 \\times 10^3$。", "answer": "$$\\boxed{1.800 \\times 10^3}$$", "id": "3124474"}, {"introduction": "到目前为止，我们已经探讨了线性规划中的影子价格。这最后一个实践将这一概念推广到在经济建模中很常见的非线性优化问题。通过分析一个具有非线性生产函数的公司，你将使用Karush-Kuhn-Tucker（KKT）条件来证明拉格朗日乘子（即影子价格）恰好是资源的边际生产率。这个练习还将揭示生产函数的数学性质与经济学中的边际报酬递减规律之间的直接联系。[@problem_id:3124393]", "problem": "考虑生产中的资源分配问题，其中企业选择投入 $x \\in \\mathbb{R}^{2}$，以在一个单一的总资源约束和投入非负性的条件下，最大化一个非线性的凹生产函数。该企业的优化问题是\n$$\n\\max_{x \\in \\mathbb{R}^{2}} \\ \\theta \\, x_{1}^{p} x_{2}^{q} \\quad \\text{subject to} \\quad A x \\le b, \\ x \\ge 0,\n$$\n其中 $A = \\begin{pmatrix} 1  1 \\end{pmatrix}$，$b = B > 0$，$\\theta > 0$，$p \\in (0,1)$，$q \\in (0,1)$，且 $p+q  1$。不等式 $A x \\le b$ 代表单一资源约束 $x_{1} + x_{2} \\le B$，而 $x \\ge 0$ 施加了非负性约束。假设在可行域内，生产函数对每种投入都产生严格为正的边际产出。\n\n从拉格朗日函数的基本定义以及针对具有不等式约束的凹最大化问题的卡罗需-库恩-塔克（Karush–Kuhn–Tucker, KKT）条件出发，完成以下任务：\n\n1. 写出此问题的拉格朗日函数和所有KKT条件，清晰地标明原始可行性、对偶可行性、平稳性和互补松弛性。\n2. 求解KKT系统，推导出最优投入向量 $x^{\\star}(B)$ 和总资源约束上的影子价格 $\\lambda(B)$，并将其表示为关于 $B$、$p$、$q$ 和 $\\theta$ 的闭式解析函数。\n3. 使用最大化问题的包络定理，将乘子 $\\lambda(B)$ 解释为最优值相对于 $B$ 的边际增量。根据 $\\lambda(B)$ 中指数的符号，判断总资源的边际生产率是否随着 $B$ 的增加而呈现递减回报。\n\n请以 $\\lambda(B)$ 的闭式表达式作为最终答案。", "solution": "所述问题是一个标准的凸优化问题，具体而言，是在一个凸集上最大化一个凹函数。目标函数 $f(x_1, x_2) = \\theta x_1^p x_2^q$ 在参数 $p, q \\in (0,1)$ 且 $p+q  1$ 的条件下，在正象限上是严格凹的。约束条件 $x_1+x_2 \\le B$ 和 $x_1 \\ge 0, x_2 \\ge 0$ 定义了一个紧致的凸可行集。因此，存在唯一的最优解。该问题是适定的且科学上合理的，允许通过卡罗需-库恩-塔克（KKT）条件直接求解。\n\n**1. 拉格朗日函数与KKT条件**\n\n优化问题为：\n$$\n\\max_{x_1, x_2} \\ \\theta x_{1}^{p} x_{2}^{q}\n$$\n约束条件为：\n$$\ng_1(x_1, x_2) = x_1 + x_2 - B \\le 0 \\\\\ng_2(x_1, x_2) = -x_1 \\le 0 \\\\\ng_3(x_1, x_2) = -x_2 \\le 0\n$$\n拉格朗日函数 $\\mathcal{L}$ 的定义是，为资源约束引入非负的拉格朗日乘子（或对偶变量）$\\lambda$，并分别为 $x_1$ 和 $x_2$ 的非负性约束引入 $\\mu_1, \\mu_2$。\n$$\n\\mathcal{L}(x_1, x_2, \\lambda, \\mu_1, \\mu_2) = \\theta x_1^p x_2^q - \\lambda(x_1 + x_2 - B) - \\mu_1(-x_1) - \\mu_2(-x_2)\n$$\n$$\n\\mathcal{L}(x_1, x_2, \\lambda, \\mu_1, \\mu_2) = \\theta x_1^p x_2^q - \\lambda(x_1 + x_2 - B) + \\mu_1 x_1 + \\mu_2 x_2\n$$\n最优解 $(x_1^*, x_2^*, \\lambda^*, \\mu_1^*, \\mu_2^*)$ 的KKT条件如下：\n\n- **平稳性 (Stationarity):** 拉格朗日函数对原始变量的偏导数在最优点必须为零。\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial x_1} = p \\theta (x_1^*)^{p-1} (x_2^*)^q - \\lambda^* + \\mu_1^* = 0\n$$\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial x_2} = q \\theta (x_1^*)^p (x_2^*)^{q-1} - \\lambda^* + \\mu_2^* = 0\n$$\n\n- **原始可行性 (Primal Feasibility):** 原始解必须满足所有约束条件。\n$$\nx_1^* + x_2^* - B \\le 0\n$$\n$$\nx_1^* \\ge 0, \\quad x_2^* \\ge 0\n$$\n\n- **对偶可行性 (Dual Feasibility):** 不等式约束的拉格朗日乘子必须为非负。\n$$\n\\lambda^* \\ge 0, \\quad \\mu_1^* \\ge 0, \\quad \\mu_2^* \\ge 0\n$$\n\n- **互补松弛性 (Complementary Slackness):** 每个拉格朗日乘子与其对应约束的松弛量的乘积必须为零。\n$$\n\\lambda^*(x_1^* + x_2^* - B) = 0\n$$\n$$\n\\mu_1^* x_1^* = 0\n$$\n$$\n\\mu_2^* x_2^* = 0\n$$\n\n**2. 求解KKT系统以获得最优解**\n\n我们首先分析边界解的可能性，即 $x_1^*=0$ 或 $x_2^*=0$。如果任一投入为零，则产量为 $0$。由于 $\\theta > 0$ 且 $B > 0$，可以选择 $x_1 > 0$ 和 $x_2 > 0$ 使得 $x_1+x_2 \\le B$，这将产生大于 $0$ 的产量。因此，最优解必须在 $x_1^* > 0$ 和 $x_2^* > 0$ 的情况下出现。\n\n根据互补松弛性条件 $\\mu_1^* x_1^* = 0$ 和 $\\mu_2^* x_2^* = 0$，我们推断出 $x_1^* > 0$ 和 $x_2^* > 0$ 意味着 $\\mu_1^* = 0$ 和 $\\mu_2^* = 0$。\n\n平稳性条件简化为：\n$$\np \\theta (x_1^*)^{p-1} (x_2^*)^q = \\lambda^*\n$$\n$$\nq \\theta (x_1^*)^p (x_2^*)^{q-1} = \\lambda^*\n$$\n等式左边代表每种投入的边际产出（乘以 $\\theta$）。由于两者都等于 $\\lambda^*$，我们可以令它们相等：\n$$\np \\theta (x_1^*)^{p-1} (x_2^*)^q = q \\theta (x_1^*)^p (x_2^*)^{q-1}\n$$\n假设 $x_1^* > 0, x_2^* > 0$，我们可以除以公因式 $\\theta (x_1^*)^{p-1} (x_2^*)^{q-1}$ 得到：\n$$\np x_2^* = q x_1^* \\implies x_2^* = \\frac{q}{p} x_1^*\n$$\n该方程描述了投入的最优比例。\n\n对于正的投入，边际产出是严格为正的，因此企业将用尽其全部资源预算以最大化产量。因此，资源约束必须是紧的（binding），即 $x_1^* + x_2^* = B$。根据互补松弛性，这意味着 $\\lambda^* > 0$。\n\n我们将最优比例 $x_2^* = \\frac{q}{p} x_1^*$ 代入紧约束中：\n$$\nx_1^* + \\frac{q}{p} x_1^* = B \\implies x_1^*(1 + \\frac{q}{p}) = B \\implies x_1^*\\left(\\frac{p+q}{p}\\right) = B\n$$\n求解 $x_1^*$ 得到对 $x_1$ 的最优投入需求：\n$$\nx_1^*(B) = \\frac{p}{p+q} B\n$$\n将其代回以求得 $x_2^*$：\n$$\nx_2^*(B) = \\frac{q}{p} x_1^*(B) = \\frac{q}{p} \\left(\\frac{p}{p+q} B\\right) = \\frac{q}{p+q} B\n$$\n现在我们通过将最优投入 $x_1^*(B)$ 和 $x_2^*(B)$ 代入第一个平稳性方程来求出影子价格 $\\lambda(B)$：\n$$\n\\lambda(B) = p \\theta (x_1^*)^{p-1} (x_2^*)^q = p \\theta \\left(\\frac{pB}{p+q}\\right)^{p-1} \\left(\\frac{qB}{p+q}\\right)^q\n$$\n$$\n\\lambda(B) = p \\theta \\frac{p^{p-1} B^{p-1}}{(p+q)^{p-1}} \\frac{q^q B^q}{(p+q)^q} = \\theta \\frac{p \\cdot p^{p-1} \\cdot q^q}{(p+q)^{p-1+q}} B^{p-1+q}\n$$\n这可以简化为影子价格的闭式表达式：\n$$\n\\lambda(B) = \\theta \\frac{p^p q^q}{(p+q)^{p+q-1}} B^{p+q-1}\n$$\n\n**3. 经济学解释与包络定理**\n\n约束优化的包络定理指出，值函数对某个约束参数的导数等于与该约束相关的拉格朗日乘子的最优值。令 $V(B)$ 为在给定资源水平 $B$ 下目标函数的最优值。拉格朗日函数为 $\\mathcal{L} = \\mathcal{L}(x_1, x_2, \\lambda, \\dots; B)$。\n根据包络定理：\n$$\n\\frac{d V(B)}{d B} = \\frac{\\partial \\mathcal{L}}{\\partial B} \\bigg|_{(x^*, \\lambda^*, \\mu^*)} = \\lambda^*(B)\n$$\n这证实了影子价格 $\\lambda(B)$ 的经济学解释：它是总资源 $B$ 的边际生产率，即在总资源预算发生无穷小增加时，最大可能产出的增加率。\n\n为了确定资源的边际生产率是否呈现递减回报，我们考察 $\\lambda(B)$ 如何随着 $B$ 的增加而变化。这需要确定导数 $\\frac{d\\lambda}{dB}$ 的符号。我们的影子价格表达式形式为 $\\lambda(B) = K B^{\\alpha}$，其中常数 $K = \\theta \\frac{p^p q^q}{(p+q)^{p+q-1}}$ 为正，指数为 $\\alpha = p+q-1$。\n\n导数为：\n$$\n\\frac{d\\lambda}{dB} = K \\cdot (p+q-1) B^{p+q-2}\n$$\n该导数的符号由指数 $(p+q-1)$ 的符号决定。问题陈述中指明 $p+q  1$。这意味着指数为负：\n$$\np+q-1  0\n$$\n由于 $K > 0$ 且 $B^{p+q-2} > 0$ （因为 $B>0$），该导数为负：\n$$\n\\frac{d\\lambda}{dB}  0\n$$\n负导数意味着 $\\lambda(B)$ 是 $B$ 的递减函数。随着可用资源总量 $B$ 的增加，每增加一个单位资源的边际价值（或生产率）会下降。这就是边际回报递减的定义。条件 $p+q1$ 对应于生产函数的规模报酬递减，它直接导致了总资源预算的边际生产率递减。", "answer": "$$\n\\boxed{\\theta \\frac{p^p q^q}{(p+q)^{p+q-1}} B^{p+q-1}}\n$$", "id": "3124393"}]}