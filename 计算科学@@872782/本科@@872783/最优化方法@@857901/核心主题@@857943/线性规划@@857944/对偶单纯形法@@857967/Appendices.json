{"hands_on_practices": [{"introduction": "任何单纯形法的第一步都是确定正确的枢轴元素。本练习将指导您如何为一个问题建立对偶单纯形法的初始单纯形表，并应用其特定规则来找到第一个枢轴。掌握这个基础步骤对于正确应用该算法至关重要。[@problem_id:2213009]", "problem": "一家半导体制造厂正在开发一种用于制造定制芯片的新工艺，该工艺涉及三种不同类型的离子注入步骤，分别表示为工艺1、工艺2和工艺3。设 $x_1, x_2, x_3$ 分别代表每种工艺的运行持续时间（单位：小时）。该工厂旨在最小化的总能耗是这些持续时间的线性函数。需要最小化的目标函数为 $E = 4x_1 + 3x_2 + 5x_3$，单位为兆瓦时 (MWh)。\n\n为使芯片正常工作，必须满足两个质量控制规范。这些规范与两种掺杂剂（P型和N型）的最低要求浓度有关，而浓度是工艺持续时间的函数。\n1.  P型掺杂剂浓度约束：$2x_1 + x_2 + 3x_3 \\ge 10$（单位为任意浓度单位）\n2.  N型掺杂剂浓度约束：$x_1 + 2x_2 + x_3 \\ge 12$（单位为任意浓度单位）\n3.  持续时间必须为非负值：$x_1, x_2, x_3 \\ge 0$。\n\n为了使用对偶单纯形法解决这个线性规划问题，您必须首先建立初始单纯形表。该方法的标准形式要求在添加松弛变量（$s_1, s_2$）以形成等式之前，将 `≥` 不等式转换为 `≤` 不等式。单纯形表的排列应以目标函数行为首，其后是两个约束条件行。各列应按 $x_1, x_2, x_3, s_1, s_2$ 的顺序表示变量。\n\n根据对偶单纯形算法的规则，确定将选择的第一个主元的位置。请用一对整数 `(行索引, 列索引)` 来表示您的答案。这些索引指的是对应于约束条件的系数矩阵中的位置（即，不包括目标行和解/右端项列）。使用基于1的索引，其中行1是第一个约束行，列1对应于变量 $x_1$。", "solution": "我们要最小化 $E = 4x_{1} + 3x_{2} + 5x_{3}$，约束条件为\n$$2x_{1} + x_{2} + 3x_{3} \\ge 10, \\quad x_{1} + 2x_{2} + x_{3} \\ge 12, \\quad x_{1},x_{2},x_{3} \\ge 0.$$\n\n对于所要求的标准形式的对偶单纯形法，通过将两边乘以-1，将 $\\ge$ 约束转换为 $\\le$ 约束，然后添加松弛变量 $s_{1}, s_{2} \\ge 0$：\n$$-2x_{1} - x_{2} - 3x_{3} + s_{1} = -10,$$\n$$-x_{1} - 2x_{2} - x_{3} + s_{2} = -12.$$\n\n将目标函数写成典范形式，松弛变量的成本为零：\n$$E - 4x_{1} - 3x_{2} - 5x_{3} = 0.$$\n\n安排初始单纯形表，列为 $(x_{1}, x_{2}, x_{3}, s_{1}, s_{2})$。初始基变量为 $s_1, s_2$。右端项 $(-10,-12)$ 是负数，因此基是原始不可行的。\n对于最小化问题，当初始基为全松弛变量时，检验数 $\\bar{c}_{j} = c_{j} - z_j = c_j$。这里 $\\bar{c}_{1} = 4, \\bar{c}_{2} = 3, \\bar{c}_{3} = 5$。所有检验数均为非负，满足最小化问题的对偶可行性条件。因此，满足对偶单纯形法的起始条件。\n\n对偶单纯形法主元选择：\n1. 选择右端项（RHS）中负值最大的那一行作为出基行。此处，$\\min\\{-10,-12\\} = -12$，因此主元行是第二个约束行（行索引为 $2$）。\n2. 在主元行中系数为负的列中，计算比率 $\\frac{\\bar{c}_{j}}{-a_{rj}}$ 并选择最小值，其中 $r$ 是主元行索引。在第 $2$ 行，负系数出现在 $x_{1}, x_{2}, x_{3}$ 列，其中 $a_{2,1} = -1$, $a_{2,2} = -2$, $a_{2,3} = -1$。我们计算比率：\n$$\\frac{\\bar{c}_{1}}{-a_{2,1}} = \\frac{4}{1} = 4, \\quad \\frac{\\bar{c}_{2}}{-a_{2,2}} = \\frac{3}{2}, \\quad \\frac{\\bar{c}_{3}}{-a_{2,3}} = \\frac{5}{1} = 5.$$\n最小比率为 $\\frac{3}{2}$，位于 $x_{2}$ 列，即列索引为 $2$。\n\n因此，第一个主元位于第 $2$ 行、第 $2$ 列（即第二个约束行中 $x_{2}$ 列的条目 $-2$）。", "answer": "$$\\boxed{\\begin{pmatrix} 2  2 \\end{pmatrix}}$$", "id": "2213009"}, {"introduction": "确定枢轴元素后，下一步是执行枢轴操作以转换到新的基。这个练习提供了一个预先构建的单纯形表，并要求您执行一次完整的对偶单纯形法迭代。这有助于巩固您对算法如何通过机械步骤逼近解的理解。[@problem_id:2212987]", "problem": "考虑以下标准最大化问题的单纯形表，其中 $z$ 是目标函数，变量 $x_3, x_4, x_5$ 是当前的基变量。$z$ 行中的条目代表检验数 $z_j-c_j$。\n\n| 基 | $x_1$ | $x_2$ | $x_3$ | $x_4$ | $x_5$ | RHS |\n|:---|---:|---:|---:|---:|---:|---:|\n| $z$ | 3 | 2 | 0 | 0 | 0 | 50 |\n| $x_3$ | 1 | 3 | 1 | 0 | 0 | 10 |\n| $x_4$ | -1 | 2 | 0 | 1 | 0 | -4 |\n| $x_5$ | -2 | -1 | 0 | 0 | 1 | -5 |\n\n使用对偶单纯形法执行一次主元变换。在这次单次迭代后，确定新的基变量集合。报告这些新基变量的值以及目标函数 $z$ 的值。将基变量的值按照其变量索引的升序排列。你的答案应该是一个单行矩阵，包含这些值，后跟 $z$ 的值。例如，如果新的基变量是 $x_a, x_b, x_c$ 且 $abc$，那么您的答案应为 $\\begin{pmatrix} v_a  v_b  v_c  z \\end{pmatrix}$。", "solution": "我们应用对偶单纯形法，因为当前基 $\\{x_{3},x_{4},x_{5}\\}$ 导致 $x_{4}$ 和 $x_{5}$ 的右端项（RHS）为负，这表明原始问题不可行。对于最大化问题，使用 $z_{j}-c_{j}$ 检验数时，最优性（对偶可行性）条件为所有检验数非负。$z$ 行中非基变量 $x_{1},x_{2}$ 的检验数 $3$ 和 $2$ 均为非负，因此对偶可行性满足。\n\n步骤 1：选择离基变量。离基变量是具有最负 RHS 值的基变量。从表中可以看出，基变量行的 RHS 值分别为 $10$ (对于 $x_{3}$)，$-4$ (对于 $x_{4}$)，和 $-5$ (对于 $x_{5}$)。最负的值是 $-5$，所以 $x_{5}$ 是离基变量。\n\n步骤 2：使用对偶单纯形法的比值检验选择进基变量。对于主元行（$x_5$ 所在行），考虑满足 $a_{ij}  0$ 的列 $j$。在 $x_5$ 行中，$a_{51}=-2$ 和 $a_{52}=-1$，所以候选变量是 $x_1$ 和 $x_2$。我们计算比率 $\\min_{j: a_{ij}0} \\frac{z_j-c_j}{-a_{ij}}$:\n$$\n\\text{对于 } x_1: \\frac{3}{-(-2)}=\\frac{3}{2},\\qquad \\text{对于 } x_2: \\frac{2}{-(-1)}=2.\n$$\n最小值为 $\\frac{3}{2}$，所以 $x_{1}$ 是进基变量。主元元素是位于 $x_5$ 行和 $x_1$ 列交叉处的 $-2$。\n\n步骤 3：执行主元变换。首先，将主元行乘以 $-\\frac{1}{2}$，使主元元素变为 $1$：\n$$\nR_{5}'=\\left[\\,1,\\;\\frac{1}{2},\\;0,\\;0,\\;-\\frac{1}{2}\\;\\middle|\\;\\frac{5}{2}\\right]. \\quad (\\text{新 } x_1 \\text{ 行})\n$$\n从其他行中消去 $x_{1}$：\n\n- 新的 $z$ 行：$R_{z}'=R_{z}-3R_{x_1}'$ 得到\n$$\n[\\,0,\\;\\tfrac{1}{2},\\;0,\\;0,\\;\\tfrac{3}{2}\\;|\\;\\tfrac{85}{2}\\,].\n$$\n\n- 新的 $x_{3}$ 行：$R_{3}'=R_{3}-1 \\cdot R_{x_1}'$ 得到\n$$\n[\\,0,\\;\\tfrac{5}{2},\\;1,\\;0,\\;\\tfrac{1}{2}\\;|\\;\\tfrac{15}{2}\\,].\n$$\n\n- 新的 $x_{4}$ 行：$R_{4}'=R_{4}-(-1) \\cdot R_{x_1}' = R_{4}+R_{x_1}'$ 得到\n$$\n[\\,0,\\;\\tfrac{5}{2},\\;0,\\;1,\\;-\\tfrac{1}{2}\\;|\\;-\\tfrac{3}{2}\\,].\n$$\n\n经过这次对偶单纯形法的单次迭代后，基变量为 $\\{x_{1},x_{3},x_{4}\\}$，非基变量为 $\\{x_{2},x_{5}\\}$。将非基变量设为 $0$，基变量的值可以从其所在行的 RHS 读取：\n$$\nx_{1}=\\frac{5}{2},\\quad x_{3}=\\frac{15}{2},\\quad x_{4}=-\\frac{3}{2}.\n$$\n目标函数值是 $z$ 行的 RHS：\n$$\nz=\\frac{85}{2}.\n$$\n将基变量 $(x_{1},x_{3},x_{4})$ 按索引升序排列，所求的行向量为 $\\left(\\frac{5}{2},\\,\\frac{15}{2},\\, -\\frac{3}{2},\\, \\frac{85}{2}\\right)$。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{5}{2}  \\frac{15}{2}  -\\frac{3}{2}  \\frac{85}{2}\\end{pmatrix}}$$", "id": "2212987"}, {"introduction": "对偶单纯形法并非总能找到最优解；有时它会揭示问题本身的根本属性。本练习展示了一种关键的终止情形：算法证明线性规划问题是不可行的。理解如何解读这种结果与找到最优解同样重要。[@problem_id:2212994]", "problem": "给定一个最大化线性规划（LP）问题的初始单纯形表如下。决策变量为 $x_1$ 和 $x_2$，松弛变量为 $s_1$ 和 $s_2$，目标函数值为 $Z$。顶行代表单纯形表中的目标函数行，其对应方程为 $Z + x_1 + x_2 = 0$。\n\n| 基变量 | $Z$ | $x_1$ | $x_2$ | $s_1$ | $s_2$ | RHS |\n|:---|---:|---:|---:|---:|---:|---:|\n| $Z$ | 1 | 1 | 1 | 0 | 0 | 0 |\n| $s_1$ | 0 | -1 | -1 | 1 | 0 | -5 |\n| $s_2$ | 0 | 1 | 1 | 0 | 1 | 2 |\n\n此单纯形表是对偶可行的（目标行中非基变量的所有系数均为非负），但不是原始可行的（至少有一个右端项的值为负）。你的任务是对该单纯形表应用对偶单纯形法，直到满足终止条件。根据单纯形表的最终状态，关于相关LP问题的性质，以下哪个结论是正确的？\n\nA. 该问题有唯一最优解。\nB. 该问题有多个最优解。\nC. 该问题无可行解。\nD. 该问题是无界的。\nE. 对偶单纯形法不能应用于此单纯形表。", "solution": "我们得到一个最大化LP单纯形表，它是对偶可行的（目标行中非基变量的条目 $z_j-c_j$ 是非负的），但不是原始可行的（一个基本变量的右端项为负）。可以应用对偶单纯形法。\n\n初始单纯形表（各行解释为方程）：\n- 目标行：$Z + x_{1} + x_{2} = 0$，其中检验数 $\\bar{c}_{x_{1}} = 1$，$\\bar{c}_{x_{2}} = 1$（非负）。\n- 约束行：\n  - $-x_{1} - x_{2} + s_{1} = -5$（基变量 $s_{1}$ 的右端项为 $-5  0$）。\n  - $x_{1} + x_{2} + s_{2} = 2$（基变量 $s_{2}$ 的右端项为 $2 \\ge 0$）。\n\n对偶单纯形法的枢轴变换规则：\n- 选择具有最负右端项的离基行 $r$。这里 $r$ 是 $s_{1}$ 所在行，因为 $-5$ 是最负的值。\n- 在满足 $a_{rj}  0$ 的非基变量列 $j$ 中，选择使比率 $\\frac{\\bar{c}_{j}}{-a_{rj}}$ 最小化的列 $j$ 作为进基列。\n\n对于行 $r$（$s_{1}$ 所在行），系数为 $a_{r,x_{1}} = -1$，$a_{r,x_{2}} = -1$，检验数为 $\\bar{c}_{x_{1}} = 1$，$\\bar{c}_{x_{2}} = 1$。比值为\n$$\n\\frac{\\bar{c}_{x_{1}}}{-a_{r,x_{1}}} = \\frac{1}{-(-1)} = 1, \\quad \\frac{\\bar{c}_{x_{2}}}{-a_{r,x_{2}}} = \\frac{1}{-(-1)} = 1.\n$$\n存在相等情况；我们任意选择 $x_{1}$ 进基。在 $a_{r,x_{1}} = -1$ 上进行枢轴变换。\n\n执行枢轴变换：\n- 缩放枢轴行：新 $r$ 行 $:= (-1)\\times$ 旧 $r$ 行，得到\n$$\nx_{1} + x_{2} - s_{1} = 5.\n$$\n- 从其他行中消去 $x_{1}$：\n  - 新 $Z$ 行 $:=$ 旧 $Z$ 行 $-$ ($Z$ 行中 $x_{1}$ 的系数)$\\times$ 新 $r$ 行：\n    $$\n    (Z + x_{1} + x_{2} = 0) - 1\\cdot(x_{1} + x_{2} - s_{1} = 5)\n    \\;\\Rightarrow\\;\n    Z + s_{1} = -5.\n    $$\n    非基变量的检验数保持为 $\\bar{c}_{x_{2}} = 0$ 和 $\\bar{c}_{s_{1}} = 1$，均为非负，因此保持了对偶可行性。\n  - 新 $s_{2}$ 行 $:=$ 旧 $s_{2}$ 行 $-$ ($s_{2}$ 行中 $x_{1}$ 的系数)$\\times$ 新 $r$ 行：\n    $$\n    (x_{1} + x_{2} + s_{2} = 2) - 1\\cdot(x_{1} + x_{2} - s_{1} = 5)\n    \\;\\Rightarrow\\;\n    s_{1} + s_{2} = -3.\n    $$\n\n现在基变量为 $x_{1}$ 和 $s_{2}$，其右端项值分别为 $5$ 和 $-3$。该单纯形表仍然是对偶可行的（目标行非基变量系数为非负），但不是原始可行的，因为 $s_{2}$ 行的右端项为 $-3  0$。\n\n再次应用对偶单纯形法步骤：\n- 选择离基行：$s_{2}$ 所在行（右端项 $-3$ 为负）。\n- 确定进基变量：我们需要在 $s_{2}$ 行中找到一个非基列 $j$ 满足 $a_{rj}  0$，以便在改善原始可行性的同时保持对偶可行性。此阶段的非基变量是 $x_{2}$ 和 $s_{1}$。在 $s_{2}$ 行中，我们有系数\n$$\na_{r,x_{2}} = 0, \\quad a_{r,s_{1}} = 1,\n$$\n两者都不是负数。因此，没有合格的进基变量。\n\n这是对偶单纯形法证明问题不可行的终止条件：如果一个离基行具有负的右端项，并且在该行中所有非基变量的系数都非负，那么算法终止，原始LP问题是无解的。\n\n作为独立检验，初始单纯形表所隐含的原始约束是\n$$\n-x_{1} - x_{2} + s_{1} = -5 \\;\\Rightarrow\\; x_{1} + x_{2} \\ge 5,\n$$\n$$\nx_{1} + x_{2} + s_{2} = 2 \\;\\Rightarrow\\; x_{1} + x_{2} \\le 2,\n$$\n且 $x_{1}, x_2, s_{1}, s_{2} \\ge 0$。这些约束是矛盾的，从而证实了问题无可行解。\n\n因此，相关的LP问题是无可行解的。", "answer": "$$\\boxed{C}$$", "id": "2212994"}]}