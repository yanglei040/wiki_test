{"hands_on_practices": [{"introduction": "影子价格为我们提供了决策中一个强有力的概念：资源的边际价值。这个经典的饮食问题 [@problem_id:3179183] 将抽象的影子价格概念变得具体，它向我们揭示了为了满足一个额外的营养单位，我们愿意支付的成本是多少。通过求解这个线性规划问题并运用对偶理论，你将亲手计算出卡路里约束的影子价格，并分析当该约束变化时，不同食物之间的替代效应。", "problem": "考虑一个线性规划（LP）饮食配方问题，其中有两个决策变量，分别表示两种食物的每日份数，记为 $x_1$ 和 $x_2$，两者均受约束 $x_1 \\ge 0$ 和 $x_2 \\ge 0$。目标是最小化每日总成本。食物 $1$（大米）每份成本为 $0.50$ 美元，每份提供 $200$ 卡路里和 $4$ 克蛋白质。食物 $2$（豆类）每份成本为 $0.60$ 美元，每份提供 $100$ 卡路里和 $10$ 克蛋白质。每日最低需求量为 $600$ 卡路里和 $24$ 克蛋白质。将该线性规划问题表述为，在约束 $A x \\ge b$ 下最小化 $c^{\\top} x$，其中 $c = (0.50, 0.60)$，$x = (x_1, x_2)$，$A = \\begin{pmatrix} 200  100 \\\\ 4  10 \\end{pmatrix}$，$b = \\begin{pmatrix} 600 \\\\ 24 \\end{pmatrix}$。仅使用线性规划对偶和 Karush–Kuhn–Tucker (KKT) 条件的基本定义，确定与热量约束相关的影子价格（即最优目标值相对于热量约束右端值的边际增量）。然后，定性分析当热量约束的右端项增加 $10\\%$ 至 $b_{\\text{cal}}' = 1.10 \\times 600$，同时保持蛋白质需求量为 $24$ 克时，最优食物量 $(x_1, x_2)$ 如何变化，并解释在此变化下这两种食物是否充当替代品。仅报告热量约束的影子价格的数值，并将答案四舍五入到四位有效数字。以美元/卡路里为单位表示影子价格。", "solution": "用户希望我解决一个与饮食配方相关的线性规划问题。\n\n我的计划如下：\n1.  **验证问题陈述。**\n    *   **第1步：提取已知条件：** 我将列出问题中提供的所有变量、常数和约束。\n    *   **第2步：使用提取的已知条件进行验证：** 我将检查问题是否科学合理、适定、客观和完整。\n    *   **第3步：结论和行动：** 根据验证结果，我将继续解决问题或宣布其无效。\n\n2.  **解决问题（如果有效）。**\n    *   **建立原线性规划：** 问题已经给出了原问题的矩阵形式。我将明确地写出它。\n    *   **建立对偶线性规划：** 我将写出与给定的原最小化问题相对应的对偶问题。\n    *   **求解原线性规划：** 我需要找到最优解 $(x_1^*, x_2^*)$ 和最优成本。我可以通过图解法或通过找到紧约束的交点来做到这一点。\n    *   **求解对偶线性规划：** 影子价格是对偶变量的最优值。根据强对偶定理，原问题和对偶问题的最优目标值相等。我可以使用互补松弛性来找到最优对偶变量。\n    *   **确定热量约束的影子价格：** 热量约束的影子价格将是与第一个约束（热量）相关的对偶变量的值。\n    *   **分析右端项的变化：** 我需要分析当热量约束的右端项从 $600$ 变为 $660$ 时会发生什么。\n    *   **定性分析：** 我需要描述最优数量 $(x_1, x_2)$ 如何变化，并确定这些食物是否是替代品。\n    *   **最终答案：** 我将提供热量约束的影子价格的数值，并四舍五入到四位有效数字。\n\n---\n\n### 第1步：提取已知条件\n\n*   **决策变量**：$x_1$（食物1，大米的份数），$x_2$（食物2，豆类的份数）。\n*   **非负性约束**：$x_1 \\ge 0$，$x_2 \\ge 0$。\n*   **目标函数（原问题）**：最小化每日总成本，$Z = 0.50 x_1 + 0.60 x_2$。\n*   **成本向量**：$c = (0.50, 0.60)$。\n*   **约束矩阵**：$A = \\begin{pmatrix} 200  100 \\\\ 4  10 \\end{pmatrix}$。\n*   **右端项（RHS）向量**：$b = \\begin{pmatrix} 600 \\\\ 24 \\end{pmatrix}$。\n*   **约束（原问题）**：\n    *   热量约束：$200 x_1 + 100 x_2 \\ge 600$。\n    *   蛋白质约束：$4 x_1 + 10 x_2 \\ge 24$。\n*   **任务1**：使用LP对偶和KKT条件确定与热量约束相关的影子价格。\n*   **任务2**：当热量约束的右端项增加 $10\\%$ 至 $b_{\\text{cal}}' = 1.10 \\times 600 = 660$ 时，定性分析 $(x_1, x_2)$ 如何变化。\n*   **任务3**：解释在此变化下这两种食物是否充当替代品。\n*   **最终答案要求**：报告热量约束的影子价格的数值，四舍五入到四位有效数字，单位为美元/卡路里。\n\n---\n\n### 第2步：使用提取的已知条件进行验证\n\n1.  **科学合理性（关键）**：该问题是一个标准的饮食问题，是线性规划中的一个经典例子。营养价值和成本是虚构的但看似合理。LP和对偶的数学框架是完善的。它是科学合理的。\n2.  **适定性**：该问题是一个标准的LP问题。它有一个可行域（例如，大的 $x_1, x_2$ 满足约束），并且有下界 $0$。因此，存在最优解。问题要求一个特定的值（影子价格）和定性分析，这些都是优化中定义明确的概念。该问题似乎是适定的。\n3.  **客观性（关键）**：语言精确且量化。没有主观或基于意见的陈述。问题是客观的。\n4.  **完整性/一致性**：提供了建立和解决LP所需的所有必要信息（成本、营养成分、需求量）。设置中没有矛盾。\n5.  **现实性/可行性**：对于一个简化的饮食问题，这些值在合理范围内。不涉及物理上的不可能性。\n6.  **结构**：该问题明确地结构化为一个最小化LP问题。任务是具体的，并基于标准的LP理论。\n7.  **可验证性**：解可以使用标准的LP求解技术（图解法、单纯形法、KKT条件）进行验证。\n\n该问题有效。它是线性规划和对偶理论的标准应用。要求“仅使用线性规划对偶和 Karush–Kuhn–Tucker (KKT) 条件的基本定义”是对方法的指导，而不是缺陷。定性分析是优化中灵敏度分析的标准部分。\n\n---\n\n### 第3步：结论和行动\n\n问题**有效**。我将继续进行求解。\n\n---\n\n### 求解步骤\n\n**1. 原问题表述**\n\n原问题 $(P)$ 给出如下：\n最小化 $Z = 0.50 x_1 + 0.60 x_2$\n约束条件为：\n$200 x_1 + 100 x_2 \\ge 600$ (热量)\n$4 x_1 + 10 x_2 \\ge 24$ (蛋白质)\n$x_1 \\ge 0, x_2 \\ge 0$\n\n让我们简化约束条件：\n$2 x_1 + x_2 \\ge 6$\n$2 x_1 + 5 x_2 \\ge 12$\n$x_1 \\ge 0, x_2 \\ge 0$\n\n**2. 求解原问题**\n\n我将使用图解法找到最优解 $(x_1^*, x_2^*)$。\n首先，我将绘制约束的边界线：\n线1：$2 x_1 + x_2 = 6$\n- 如果 $x_1 = 0$，则 $x_2 = 6$。点：$(0, 6)$。\n- 如果 $x_2 = 0$，则 $x_1 = 3$。点：$(3, 0)$。\n\n线2：$2 x_1 + 5 x_2 = 12$\n- 如果 $x_1 = 0$，则 $x_2 = 12/5 = 2.4$。点：$(0, 2.4)$。\n- 如果 $x_2 = 0$，则 $x_1 = 6$。点：$(6, 0)$。\n\n可行域是第一象限中两条线上方的区域。可行域的角点是：\n- A点：$x_1=0$ 和 $2x_1 + x_2 = 6$ 的交点。即 $(0, 6)$。\n- B点：$2 x_1 + x_2 = 6$ 和 $2 x_1 + 5 x_2 = 12$ 的交点。\n  - 从第二个方程减去第一个方程：$(2 x_1 + 5 x_2) - (2 x_1 + x_2) = 12 - 6 \\implies 4 x_2 = 6 \\implies x_2 = 1.5$。\n  - 将 $x_2 = 1.5$ 代入第一个方程：$2 x_1 + 1.5 = 6 \\implies 2 x_1 = 4.5 \\implies x_1 = 2.25$。\n  - 所以，B点是 $(2.25, 1.5)$。\n- C点：$x_2=0$ 和 $2 x_1 + 5 x_2 = 12$ 的交点。这是 $(x_1=6, x_2=0)$，但这并不是一个顶点。顶点在 $2x_1+x_2=6$ 的x轴截距处，即 $(3,0)$。不，等等。可行域由“更靠上”的线界定。我们来检查一下顶点。顶点是边界线的交点。\n- 顶点1：$x_1=0$ 与边界的交点。线 $2x_1+x_2=6$ 给出 $(0,6)$。线 $2x_1+5x_2=12$ 给出 $(0, 2.4)$。可行域是 $x_2 \\ge 6$ 且 $x_2 \\ge (12-2x_1)/5$。所以对于 $x_1=0$，我们需要 $x_2 \\ge 6$ 和 $x_2 \\ge 2.4$。因此区域从 $x_2=6$ 开始。顶点是 $(0,6)$。\n- 顶点2：两条线 $2 x_1 + x_2 = 6$ 和 $2 x_1 + 5 x_2 = 12$ 的交点。这是 $(2.25, 1.5)$。\n- 顶点3：$x_2=0$ 与边界的交点。线 $2x_1+x_2=6$ 给出 $(3,0)$。线 $2x_1+5x_2=12$ 给出 $(6,0)$。可行域需要 $2x_1 \\ge 6$ 和 $2x_1 \\ge 12$。所以我们需要 $x_1 \\ge 3$ 和 $x_1 \\ge 6$。因此区域从 $x_1=6$ 开始。顶点是 $(6,0)$。\n\n可行域的角点是 $(0, 6)$、$(2.25, 1.5)$ 和 $(6, 0)$。\n\n现在，在这些点上评估目标函数 $Z = 0.5 x_1 + 0.6 x_2$：\n- 在 $(0, 6)$：$Z = 0.5(0) + 0.6(6) = 3.6$。\n- 在 $(2.25, 1.5)$：$Z = 0.5(2.25) + 0.6(1.5) = 1.125 + 0.9 = 2.025$。\n- 在 $(6, 0)$：$Z = 0.5(6) + 0.6(0) = 3.0$。\n\n最小成本为 $Z^* = 2.025$，在最优点 $(x_1^*, x_2^*) = (2.25, 1.5)$ 处取得。\n在这一点上，两个约束都是活动的（紧的），因为：\n$2(2.25) + 1.5 = 4.5 + 1.5 = 6$。（约束1是紧约束）\n$2(2.25) + 5(1.5) = 4.5 + 7.5 = 12$。（约束2是紧约束）\n所以，$200(2.25) + 100(1.5) = 450 + 150 = 600$。\n$4(2.25) + 10(1.5) = 9 + 15 = 24$。\n两个约束确实都是紧约束。非负性约束 $x_1 \\ge 0$ 和 $x_2 \\ge 0$ 不是紧约束。\n\n**3. 对偶问题和影子价格**\n\n原问题是：\n最小化 $c^{\\top} x$\n约束条件为 $A x \\ge b, x \\ge 0$。\n\n对偶问题 $(D)$ 是：\n最大化 $b^{\\top} y$\n约束条件为 $A^{\\top} y \\le c, y \\ge 0$。\n\n令 $y = (y_1, y_2)^{\\top}$ 为对偶变量。$y_1$ 与热量约束相关，$y_2$ 与蛋白质约束相关。\n最大化 $W = 600 y_1 + 24 y_2$\n约束条件为：\n$200 y_1 + 4 y_2 \\le 0.50$\n$100 y_1 + 10 y_2 \\le 0.60$\n$y_1 \\ge 0, y_2 \\ge 0$\n\n热量约束的影子价格是最优值 $y_1^*$。\n\n**4. 使用 KKT / 互补松弛性**\n\nKKT 条件连接了原问题和对偶问题的解。对于 LP，它们简化为互补松弛条件。\n\n原问题约束：\n1. $200 x_1 + 100 x_2 - 600 \\ge 0$\n2. $4 x_1 + 10 x_2 - 24 \\ge 0$\n3. $x_1 \\ge 0$\n4. $x_2 \\ge 0$\n\n对偶约束（来自 $A^\\top y \\le c$）：\n1. $0.50 - (200 y_1 + 4 y_2) \\ge 0$\n2. $0.60 - (100 y_1 + 10 y_2) \\ge 0$\n3. $y_1 \\ge 0$\n4. $y_2 \\ge 0$\n\n互补松弛条件：\n- $y_1^* (200 x_1^* + 100 x_2^* - 600) = 0$\n- $y_2^* (4 x_1^* + 10 x_2^* - 24) = 0$\n- $x_1^* (0.50 - (200 y_1^* + 4 y_2^*)) = 0$\n- $x_2^* (0.60 - (100 y_1^* + 10 y_2^*)) = 0$\n\n通过求解原问题，我们知道 $(x_1^*, x_2^*) = (2.25, 1.5)$。\n$x_1^*$ 和 $x_2^*$ 都是正数。这意味着根据第3和第4个互补松弛条件，相应的对偶约束在最优点必须是紧的（活动的）。\n$200 y_1^* + 4 y_2^* = 0.50$ (方程 I)\n$100 y_1^* + 10 y_2^* = 0.60$ (方程 II)\n\n我们得到一个关于两个变量 $y_1^*$ 和 $y_2^*$ 的二元线性方程组。\n将（方程 II）乘以2：\n$200 y_1^* + 20 y_2^* = 1.20$ (方程 III)\n从（方程 III）中减去（方程 I）：\n$(200 y_1^* + 20 y_2^*) - (200 y_1^* + 4 y_2^*) = 1.20 - 0.50$\n$16 y_2^* = 0.70$\n$y_2^* = 0.70 / 16 = 7/160 = 0.04375$。\n\n将 $y_2^*$ 代回（方程 II）：\n$100 y_1^* + 10(0.04375) = 0.60$\n$100 y_1^* + 0.4375 = 0.60$\n$100 y_1^* = 0.60 - 0.4375 = 0.1625$\n$y_1^* = 0.001625$。\n\n因此，最优对偶解为 $(y_1^*, y_2^*) = (0.001625, 0.04375)$。\n让我们检查一下是否 $y_1^* \\ge 0$ 和 $y_2^* \\ge 0$。是的，它们都满足。\n我们还从原问题的解中知道，前两个原问题约束是紧的。所以前两个互补松弛条件得到满足（$0=0$）。\n\n热量约束的影子价格是 $y_1^*$。\n$y_1^* = 0.001625$ 美元/卡路里。\n\n问题要求答案四舍五入到四位有效数字。$0.001625$ 写成科学记数法是 $1.625 \\times 10^{-3}$。有效数字是 1、6、2、5。所以这个值已经是四位有效数字了。\n\n**使用强对偶性检验结果。**\n原问题最优值：$Z^* = 2.025$。\n对偶问题最优值：$W^* = 600 y_1^* + 24 y_2^* = 600(0.001625) + 24(0.04375)$。\n$600 \\times 0.001625 = 6 \\times 0.1625 = 0.975$。\n$24 \\times 0.04375 = 24 \\times (7/160) = (3 \\times 8 \\times 7) / (20 \\times 8) = 21/20 = 1.05$。\n$W^* = 0.975 + 1.05 = 2.025$。\n$Z^* = W^*$，所以解是正确的。\n\n**5. 定性分析**\n\n问题的第二部分要求定性分析当热量约束的右端项增加 $10\\%$ 时，最优食物量 $(x_1, x_2)$ 如何变化。\n新的热量需求是 $b_{\\text{cal}}' = 1.10 \\times 600 = 660$。新的蛋白质需求保持为 $b_{\\text{prot}} = 24$。\n\n新的约束系统是：\n$200 x_1 + 100 x_2 \\ge 660 \\implies 2 x_1 + x_2 \\ge 6.6$ (新线 1)\n$4 x_1 + 10 x_2 \\ge 24 \\implies 2 x_1 + 5 x_2 \\ge 12$ (旧线 2)\n\n影子价格 $y_1^*$ 和 $y_2^*$ 在右端项值的一定变化范围内有效。只要变化足够小，使得基（紧约束集合）不改变，影子价格就能预测目标函数的变化。这里，我们被要求找到新的最优解 $(x_1', x_2')$。\n\n旧的最优解位于两条线的交点。让我们找到新的交点。\n新线1：$2 x_1 + x_2 = 6.6$\n旧线2：$2 x_1 + 5 x_2 = 12$\n\n从线2减去新线1：\n$(2 x_1 + 5 x_2) - (2 x_1 + x_2) = 12 - 6.6$\n$4 x_2 = 5.4$\n$x_2' = 5.4 / 4 = 1.35$。\n\n将 $x_2' = 1.35$ 代入新线1：\n$2 x_1' + 1.35 = 6.6$\n$2 x_1' = 6.6 - 1.35 = 5.25$\n$x_1' = 5.25 / 2 = 2.625$。\n\n新的最优解是 $(x_1', x_2') = (2.625, 1.35)$。\n我们应该通过检查新可行域的顶点来确认这个解是否可行。新线 $2x_1+x_2 = 6.6$ 与旧线平行但向外移动。可行域缩小了。顶点会移动。新的顶点是：\n- $x_1=0$ 和 $2x_1+x_2=6.6$ 的交点：$(0, 6.6)$。\n- 两条线的交点：$(2.625, 1.35)$。\n- $x_2=0$ 和 $2x_1+5x_2=12$ 的交点：$(6,0)$。\n角点是 $(0, 6.6)$、$(2.625, 1.35)$ 和 $(6,0)$。\n\n让我们在这些新顶点上评估目标函数 $Z = 0.5x_1 + 0.6x_2$：\n- 在 $(0, 6.6)$：$Z = 0.5(0) + 0.6(6.6) = 3.96$。\n- 在 $(2.625, 1.35)$：$Z = 0.5(2.625) + 0.6(1.35) = 1.3125 + 0.81 = 2.1225$。\n- 在 $(6,0)$：$Z = 0.5(6) + 0.6(0) = 3.0$。\n\n最小值仍然在两条约束线的交点处，所以基没有改变。新的最优解确实是 $(x_1', x_2') = (2.625, 1.35)$，新的最优成本为 $Z' = 2.1225$。\n\n由影子价格预测的目标函数变化量将是 $\\Delta Z = y_1^* \\times \\Delta b_1 = 0.001625 \\times (660 - 600) = 0.001625 \\times 60 = 0.0975$。\n预测的新成本是 $Z_{pred} = Z^* + \\Delta Z = 2.025 + 0.0975 = 2.1225$。\n这与新计算出的最优成本完全匹配。所以分析是一致的。\n\n现在是定性分析部分：\n原始解：$(x_1^*, x_2^*) = (2.25, 1.5)$。\n新解：$(x_1', x_2') = (2.625, 1.35)$。\n\n数量如何变化？\n- 食物1（大米）的量 $x_1$ 从 $2.25$ 增加到 $2.625$。\n- 食物2（豆类）的量 $x_2$ 从 $1.5$ 减少到 $1.35$。\n\n这些食物是替代品吗？\n如果一种商品价格的上涨导致另一种商品需求量的增加，那么这两种商品就是替代品。这里的情景略有不同。我们正在改变一个约束，而不是价格。然而，在经济学意义上，如果为了达到某个目标可以用一种投入替代另一种投入，那么这两种投入就是替代品。\n当热量需求增加时，饮食必须调整。新的最优解增加了大米（$x_1$）的消费量，并减少了豆类（$x_2$）的消费量。这展示了一种替代效应。为了在满足蛋白质需求并最小化成本的同时达到更高的热量目标，模型用一些较便宜的食物（大米，每美元热量密度更高）替代了较昂贵的食物（豆类，每美元蛋白质密度更高但热量密度较低）。\n\n让我们检查一下每美元的热量和蛋白质含量。\n食物1（大米）：\n- 成本：$0.50/份\n- 卡路里/美元：$200 / 0.50 = 400$\n- 蛋白质/美元：$4 / 0.50 = 8$\n\n食物2（豆类）：\n- 成本：$0.60/份\n- 卡路里/美元：$100 / 0.60 \\approx 166.67$\n- 蛋白质/美元：$10 / 0.60 \\approx 16.67$\n\n大米每美元提供更多的热量。豆类每美元提供更多的蛋白质。\n变化是热量需求的增加。为了以最便宜的方式满足这一新需求，模型增加了作为更便宜热量来源的食物的消费量，即大米（$x_1$）。\n新的解 $(2.625, 1.35)$ 在新的热量约束线上：\n$200(2.625) + 100(1.35) = 525 + 135 = 660$。它满足新的热量约束。\n检查蛋白质约束：\n$4(2.625) + 10(1.35) = 10.5 + 13.5 = 24$。它也恰好满足蛋白质约束。\n所以新的最优点再次位于两个约束边界的交点处。\n\n热量需求的增加迫使解沿着蛋白质约束边界移动。点从 $(2.25, 1.5)$ 移动到 $(2.625, 1.35)$。这意味着我们增加了 $x_1$ 并减少了 $x_2$。我们用大米替代了豆类。因此，这两种食物在应对热量需求变化时充当了替代品。\n\n解释是合理的。\n1. 热量需求的增加使热量约束线向外平移，与其原始位置平行。\n2. 位于两个约束边界交点处的最优解移动到一个新位置。\n3. 新的最优解需要更多的食物1（大米）和更少的食物2（豆类）。\n4. 这表明，为了以最具成本效益的方式满足增加的热量需求（同时保持蛋白质需求不变），饮食中用大米替代了豆类。大米是每美元更高效的热量来源，因此这是合乎逻辑的。\n\n问题要求：\n1.  热量约束的影子价格的数值，四舍五入到四位有效数字。\n2.  定性分析和关于替代品的解释。\n\n我已完成这两个部分。我现在将组织解决方案。\n\n解决方案的结构应该是：\n1.  引言，将问题陈述为原线性规划。\n2.  建立对偶线性规划，将对偶变量 $y_1$ 确定为热量约束的影子价格。\n3.  解释将使用KKT条件（对于LP即互补松弛性）来求解对偶变量。\n4.  求解原问题以找到最优点 $(x_1^*, x_2^*)$ 并确定哪些约束是紧的。\n5.  应用互补松弛条件，使用原问题的解为对偶变量 $(y_1^*, y_2^*)$ 建立一个方程组。\n6.  求解该方程组得到 $y_1^*$ 和 $y_2^*$。$y_1^*$ 的值就是影子价格。\n7.  以要求的格式陈述影子价格的值。\n8.  接着进行增加热量需求的定性分析。\n9.  计算新的最优解 $(x_1', x_2')$。\n10. 将新解与旧解进行比较，描述数量的变化。\n11. 基于这种变化和食物的相对效率解释替代效应。\n12. 最终答案框只包含数值。\n\n所有的数学公式都必须使用 LaTeX。像 $0.50$ 这样的数字必须在 LaTeX 中。最终答案应四舍五入到四位有效数字。$0.001625$ 已经是了。所以不需要四舍五入。\n\n影子价格的单位是美元/卡路里。我应该在文本中提到这一点，但不是在最终答案框中。问题要求以美元/卡路里表示。这加强了我对 $y_1^*$ 含义的理解。对偶目标是 $W = 600 y_1 + 24 y_2$。单位是（卡路里）$\\times y_1$ +（克蛋白质）$\\times y_2$，结果必须是美元。所以 $y_1$ 的单位是美元/卡路里，$y_2$ 的单位是美元/克蛋白质。这是一致的。\n\n让我们再次检查一下措辞“定性分析最优食物量 $(x_1, x_2)$ 如何变化……并解释这两种食物是否充当替代品”。我的分析是：\n- $x_1$ 增加，$x_2$ 减少。这是变化。\n- “增加所需热量摄入的最具成本效益的方式是增加大米的消费量，这是每美元热量密度更高的食物，同时减少豆类的消费量以维持蛋白质需求而不过量。这展示了一种替代效应，即在最优组合中一种食物被另一种食物所取代。”这是一个很好的解释。\n\n问题还提到“仅使用LP对偶和 Karush–Kuhn–Tucker (KKT) 条件的基本定义”。我的解决路径正是这样做的。我首先找到了原问题的解（应用KKT所需），然后使用互补松弛性（KKT的一个推论）来找到对偶解（影子价格）。这是标准且最直接的方法，避免了例如在对偶问题上运行单纯形算法。\n\n最后检查计算。……一切似乎都正确，可以写下来了。这个问题是一个教科书式的例子，解决路径很直接。格式要求需要仔细注意。每一个数字和变量都必须在 LaTeX 中。这很繁琐，但我必须遵守规则。", "answer": "$$\n\\boxed{0.001625}\n$$", "id": "3179183"}, {"introduction": "在最优解中，并非所有约束都是“活跃”或“紧的”。这个练习 [@problem_id:3179215] 旨在探讨当我们改变一个非紧约束的右侧值（RHS）时会发生什么。通过这个练习，你将理解一个关键概念：在一定范围内改变非紧约束不会影响最优解，其影子价格也相应为零。这个“允许变化范围”是敏感性分析中的核心思想。", "problem": "考虑以下线性规划 (LP) 问题：在线性不等式约束和非负约束条件下，最大化一个线性目标函数。问题数据如下：\n$$\n\\text{maximize } z = 3x_{1} + 2x_{2}\n$$\n约束条件为\n$$\n2x_{1} + x_{2} \\leq 8, \\quad x_{1} + 2x_{2} \\leq 8, \\quad x_{1} \\leq 3, \\quad x_{1} \\geq 0, \\quad x_{2} \\geq 0.\n$$\n您的任务是：\n1. 确定最优解向量 $x^{\\star}$，并指出在 $x^{\\star}$ 处哪些约束是紧约束。\n2. 考虑仅对非紧约束不等式 $x_{1} \\leq 3$ 的右侧 (RHS) 进行更改，将其替换为 $x_{1} \\leq 3 - \\Delta$，其中 $\\Delta \\geq 0$。利用线性规划对偶理论中的原始可行性、对偶可行性和互补松弛性的定义，解释为什么在 $\\Delta$ 的一个特定范围内，最优解 $x^{\\star}$ 和最优值保持不变。\n3. 计算最大的非负值 $\\Delta_{\\max}$，使得对于所有满足 $0 \\leq \\Delta \\leq \\Delta_{\\max}$ 的 $\\Delta$，最优解向量和最优值都保持不变。请将 $\\Delta_{\\max}$ 以单个精确数值的形式给出。无需四舍五入，也不涉及任何物理单位。", "solution": "所给问题是一个定义明确的、涉及灵敏度分析的线性规划 (LP) 问题。它在科学上是合理的、自洽的且客观的。提供了唯一解所需的所有数据和条件，并且没有内部矛盾。因此，该问题被认为是有效的，可以构建一个完整的解。\n\n原始线性规划问题 (P) 如下：\n$$ \\text{maximize } z = 3x_{1} + 2x_{2} $$\n约束条件为\n\\begin{align*} 2x_{1} + x_{2} \\leq 8 \\quad (1) \\\\ x_{1} + 2x_{2} \\leq 8 \\quad (2) \\\\ x_{1} \\leq 3 \\quad (3) \\\\ x_{1} \\geq 0 \\quad (4) \\\\ x_{2} \\geq 0 \\quad (5) \\end{align*}\n\n**1. 最优解与紧约束**\n\n这是一个二维线性规划问题，可以通过考察可行域的顶点来用图解法求解。可行域是由这些不等式在第一象限定义的一个多边形。顶点是边界线的交点。\n\n可行域的顶点是：\n- $x_1=0$ 和 $x_2=0$ 的交点：$(0, 0)$。\n- $x_1=3$ 和 $x_2=0$ 的交点：$(3, 0)$。\n- $x_1=3$ 和 $2x_1+x_2=8$ 的交点：$2(3)+x_2=8 \\implies x_2=2$。顶点是 $(3, 2)$。注意该点满足 $x_1+2x_2 = 3+2(2)=7 \\leq 8$。\n- $2x_1+x_2=8$ 和 $x_1+2x_2=8$ 的交点：由 $x_2=8-2x_1$，代入第二个方程：$x_1+2(8-2x_1)=8 \\implies x_1+16-4x_1=8 \\implies 3x_1=8 \\implies x_1=8/3$。则 $x_2=8-2(8/3) = 8-16/3 = 8/3$。顶点是 $(8/3, 8/3)$。注意该点满足 $x_1 = 8/3 \\leq 3$。\n- $x_1=0$ 和 $x_1+2x_2=8$ 的交点：$2x_2=8 \\implies x_2=4$。顶点是 $(0, 4)$。\n\n我们在每个顶点处计算目标函数 $z = 3x_{1} + 2x_{2}$ 的值：\n- 在 $(0, 0)$ 处：$z=3(0)+2(0)=0$。\n- 在 $(3, 0)$ 处：$z=3(3)+2(0)=9$。\n- 在 $(3, 2)$ 处：$z=3(3)+2(2)=13$。\n- 在 $(8/3, 8/3)$ 处：$z=3(8/3)+2(8/3)=8+16/3=40/3 \\approx 13.33$。\n- 在 $(0, 4)$ 处：$z=3(0)+2(4)=8$。\n\n目标函数的最大值是 $z^{\\star}=40/3$，在顶点 $(8/3, 8/3)$ 处取得。因此，最优解向量是 $x^{\\star} = \\begin{pmatrix} 8/3 \\\\ 8/3 \\end{pmatrix}$。\n\n为了确定在 $x^{\\star}$ 处哪些约束是紧约束，我们将最优解代入原始不等式中：\n- 约束 (1): $2(8/3) + 8/3 = 16/3 + 8/3 = 24/3 = 8$。由于 $8 \\leq 8$ 等式成立，该约束是**紧约束**。\n- 约束 (2): $8/3 + 2(8/3) = 8/3 + 16/3 = 24/3 = 8$。由于 $8 \\leq 8$ 等式成立，该约束是**紧约束**。\n- 约束 (3): $8/3 \\leq 3$。由于 $8/3 \\approx 2.67$，不等式 $2.67  3$ 是严格的。该约束是**非紧约束**。\n- 约束 (4): $8/3 \\geq 0$。这是严格的，因此是非紧约束。\n- 约束 (5): $8/3 \\geq 0$。这是严格的，因此是非紧约束。\n\n在 $x^{\\star}$ 处的紧约束是 $2x_{1} + x_{2} = 8$ 和 $x_{1} + 2x_{2} = 8$。\n\n**2. 更改非紧约束右侧的影响**\n\n问题被修改为将约束 (3) 更改为 $x_{1} \\leq 3 - \\Delta$，其中 $\\Delta \\geq 0$。我们必须解释为什么对于 $\\Delta$ 的某个范围，解 $x^{\\star}$ 仍然是最优的。我们使用对偶理论。\n\n与原始问题 (P) 对应的对偶问题 (D) 是：\n$$ \\text{minimize } w = 8y_{1} + 8y_{2} + 3y_{3} $$\n约束条件为\n\\begin{align*} 2y_{1} + y_{2} + y_{3} \\geq 3 \\\\ y_{1} + 2y_{2} \\geq 2 \\\\ y_{1}, y_{2}, y_{3} \\geq 0 \\end{align*}\n其中 $y_1, y_2, y_3$ 分别是对应于原始约束 (1)、(2) 和 (3) 的对偶变量。\n\nKarush-Kuhn-Tucker (KKT) 条件，包括原始可行性、对偶可行性和互补松弛性，在最优解处必须成立。\n从第1部分我们知道 $x^{\\star}=(8/3, 8/3)$。由于 $x_1^{\\star} > 0$ 和 $x_2^{\\star} > 0$，相应的对偶约束在对偶最优解 $y^{\\star}$ 处必须是紧约束：\n\\begin{align*} 2y_1^{\\star} + y_2^{\\star} + y_3^{\\star} = 3 \\\\ y_1^{\\star} + 2y_2^{\\star} = 2 \\end{align*}\n此外，由于原始约束 (3) $x_1 \\leq 3$ 在 $x^{\\star}$ 处是非紧约束 (即 $x_1^{\\star}  3$)，根据互补松弛性，其对应的对偶变量必须为零：$y_3^{\\star}=0$。\n\n将 $y_3^{\\star}=0$ 代入方程组得到：\n\\begin{align*} 2y_1^{\\star} + y_2^{\\star} = 3 \\\\ y_1^{\\star} + 2y_2^{\\star} = 2 \\end{align*}\n解此方程组得出 $y_1^{\\star}=4/3$ 和 $y_2^{\\star}=1/3$。最优对偶解是 $y^{\\star}=(4/3, 1/3, 0)$。此解是对偶可行的，因为 $y_1^{\\star} \\geq 0, y_2^{\\star} \\geq 0, y_3^{\\star} \\geq 0$。\n\n现在，考虑带有约束 $x_{1} \\leq 3 - \\Delta$ 的新问题 (P')。相应的新对偶问题 (D') 是：\n$$ \\text{minimize } w' = 8y_{1} + 8y_{2} + (3-\\Delta)y_{3} $$\n其约束与 (D) 相同。\n\n为了使解对 $(x^{\\star}, y^{\\star})$ 对新问题仍然是最优的，它必须满足 (P') 和 (D') 的最优性条件：\n- **对偶可行性**：(D') 的约束与 (D) 的约束相同。由于 $y^{\\star}=(4/3, 1/3, 0)$ 对 (D) 是可行的，所以它对 (D') 也仍然是可行的。\n- **原始可行性**：原始解 $x^{\\star}=(8/3, 8/3)$ 必须对 (P') 是可行的。前两个约束和非负约束不受影响且被满足。唯一需要检查的条件是被修改的那个：$x_{1}^{\\star} \\leq 3 - \\Delta$，即 $8/3 \\leq 3 - \\Delta$。只要这个条件成立，$x^{\\star}$ 就是原始可行的。\n- **互补松弛性**：我们检查解对 $(x^{\\star}, y^{\\star})$ 相对于新问题的条件。\n  - $y_1^{\\star}(8 - (2x_1^{\\star} + x_2^{\\star})) = (4/3)(8 - 8) = 0$。（成立）\n  - $y_2^{\\star}(8 - (x_1^{\\star} + 2x_2^{\\star})) = (1/3)(8 - 8) = 0$。（成立）\n  - $y_3^{\\star}((3-\\Delta) - x_1^{\\star}) = 0 \\cdot ((3-\\Delta) - 8/3) = 0$。这对任何 $\\Delta$ 都成立。\n  - $x_1^{\\star}( (2y_1^{\\star} + y_2^{\\star} + y_3^{\\star}) - 3 ) = (8/3)( (2(4/3) + 1/3 + 0) - 3) = (8/3)(3-3)=0$。（成立）\n  - $x_2^{\\star}( (y_1^{\\star} + 2y_2^{\\star}) - 2 ) = (8/3)( (4/3 + 2(1/3)) - 2) = (8/3)(2-2)=0$。（成立）\n\n只要 $x^{\\star}$ 保持原始可行，所有的最优性条件都得到满足。关键的观察是，因为原始约束是非紧约束，其对偶变量 $y_3^{\\star}$ 为零。这个零值“吸收”了该约束右侧的变化，使得在 $y^{\\star}$ 处的对偶目标值保持不变：$w'(y^{\\star}) = 8(4/3) + 8(1/3) + (3-\\Delta)(0) = 40/3$。在 $x^{\\star}$ 处的原始目标值也保持不变，为 $z(x^{\\star})=40/3$。由于原始目标值等于对偶目标值，并且两个解在 $\\Delta$ 的某个范围内都是可行的，因此它们必定保持最优。\n\n**3. $\\Delta_{\\max}$ 的计算**\n\n如第2部分所述，只要 $x^{\\star}$ 对于受扰动的问题仍然是可行解，解 $x^{\\star}=(8/3, 8/3)$ 和值 $z^{\\star}=40/3$ 就保持最优。唯一可能被违反的约束是被修改的那个。可行性条件是：\n$$ x_{1}^{\\star} \\leq 3 - \\Delta $$\n代入值 $x_{1}^{\\star}=8/3$：\n$$ \\frac{8}{3} \\leq 3 - \\Delta $$\n我们在寻找满足此不等式的最大非负 $\\Delta$。我们可以重新整理不等式来解出 $\\Delta$：\n$$ \\Delta \\leq 3 - \\frac{8}{3} $$\n$$ \\Delta \\leq \\frac{9}{3} - \\frac{8}{3} $$\n$$ \\Delta \\leq \\frac{1}{3} $$\n结合给定的条件 $\\Delta \\geq 0$，对于范围 $0 \\leq \\Delta \\leq 1/3$ 内的所有 $\\Delta$，旧解都保持最优。使之成立的 $\\Delta$ 的最大非负值是 $\\Delta_{\\max} = 1/3$。如果 $\\Delta > 1/3$，点 $x^{\\star}$ 将变得不可行，最优解的位置必须改变。", "answer": "$$\\boxed{\\frac{1}{3}}$$", "id": "3179215"}, {"introduction": "现在，让我们来探讨一个更复杂的情形，在这种情况下，我们的一些简单直觉可能不再适用。当一个最优解被多个约束“过度决定”时（这种情况称为“退化”），敏感性分析会变得更加微妙。这个问题 [@problem_id:3179271] 为这一重要现象提供了一个清晰的几何与代数视角，你将发现即使一个约束在最优点上是活跃的，它的影子价格也可能为零，并且其允许变化范围可能是单侧的。", "problem": "考虑以下标准不等式形式的线性规划问题：\n最大化 $z = x_{1} + x_{2}$\n满足约束条件\n$x_{1} + x_{2} \\leq 4$  (约束 $1$)\n$x_{1} \\leq 2$  (约束 $2$)\n$x_{2} \\leq 2$  (约束 $3$)\n$x_{1} \\geq 0$, $x_{2} \\geq 0$。\n使用标准的松弛变量形式来分析关于约束 $1$ 右端项的灵敏度。您的任务是：\n1. 求解该线性规划问题，并确定一个最优基本可行解 (BFS) 以及在松弛变量形式下的一个对应的最优基。请明确指出哪些是基变量。\n2. 从基、基变量和可行性的定义出发，并且仅使用单纯形法的核心结果，确定约束 $1$ 右端项 $b_{1}$ 的扰动 $\\Delta$ 的允许范围，以保持步骤 $1$ 中确定的基的可行性。请明确证明允许增加的范围非零，而允许减少的范围为零。\n3. 使用线性规划对偶理论中影子价格的定义（与一个约束相关的对偶变量等于最优目标值相对于该约束右端项的边际变化），计算与步骤 $1$ 中最优基相关的约束 $1$ 的影子价格。\n4. 从几何角度解释为什么在所确定的最优点，约束 $1$ 表现出非零的允许增加范围和零的允许减少范围。\n\n给出约束 $1$ 的影子价格的数值作为最终答案。无需四舍五入。", "solution": "给定的线性规划问题是：\n最大化 $z = x_{1} + x_{2}$\n满足约束条件\n$x_{1} + x_{2} \\leq 4$\n$x_{1} \\leq 2$\n$x_{2} \\leq 2$\n$x_{1} \\geq 0$, $x_{2} \\geq 0$。\n\n首先，我们通过引入非负的松弛变量 $s_{1}$、$s_{2}$ 和 $s_{3}$，将问题转化为标准的松弛变量形式：\n最大化 $z$\n满足约束条件\n$z - x_{1} - x_{2} = 0$\n$x_{1} + x_{2} + s_{1} = 4$\n$x_{1} + s_{2} = 2$\n$x_{2} + s_{3} = 2$\n$x_{1}, x_{2}, s_{1}, s_{2}, s_{3} \\geq 0$。\n\n这可以写成矩阵形式：最大化 $c^T x$，满足 $Ax=b, x \\ge 0$，其中\n$c = \\begin{pmatrix} 1  1  0  0  0 \\end{pmatrix}^T$, $x = \\begin{pmatrix} x_1  x_2  s_1  s_2  s_3 \\end{pmatrix}^T$,\n$A = \\begin{pmatrix} 1  1  1  0  0 \\\\ 1  0  0  1  0 \\\\ 0  1  0  0  1 \\end{pmatrix}$，以及 $b = \\begin{pmatrix} 4 \\\\ 2 \\\\ 2 \\end{pmatrix}$。\n\n**1. 最优解与基**\n\n通过图形化地考察可行域，顶点位于 $(0,0)$、$(2,0)$、$(0,2)$ 和 $(2,2)$。在这些顶点处计算目标函数 $z = x_{1} + x_{2}$ 的值：\n$z(0,0) = 0+0 = 0$\n$z(2,0) = 2+0 = 2$\n$z(0,2) = 0+2 = 2$\n$z(2,2) = 2+2 = 4$\n$z$ 的最大值是 $4$，在 $(x_{1}, x_{2}) = (2,2)$ 处取得。\n\n在这个最优点，松弛变量的值为：\n$s_{1} = 4 - x_{1} - x_{2} = 4 - 2 - 2 = 0$\n$s_{2} = 2 - x_{1} = 2 - 2 = 0$\n$s_{3} = 2 - x_{2} = 2 - 2 = 0$\n最优解是 $(x_{1}, x_{2}, s_{1}, s_{2}, s_{3}) = (2, 2, 0, 0, 0)$。\n由于有 $m=3$ 个约束，一个基本可行解 (BFS) 必须有 $3$ 个基变量。在这里，只有两个变量非零。这表明最优解是退化的。多个基的选择可以对应于这一个最优角点。\n\n问题要求找到这样一个基。正如我们将在下一步中看到的，问题的灵敏度要求指导了我们的选择。我们将选择一个基，使得约束 $1$ 右端项的允许增加范围非零，而允许减少范围为零。我们来测试由变量 $\\{x_{1}, x_{2}, s_{1}\\}$ 组成的基。非基变量是 $\\{s_{2}, s_{3}\\}$，它们被设为 $0$。这个选择对应于解点由约束 $2$ 和 $3$ 定义 ($s_2=0 \\implies x_1=2$; $s_3=0 \\implies x_2=2$)。基变量的值为：$x_1=2$, $x_2=2$, 以及 $s_1=4-x_1-x_2=0$。因此，所选的基是 $B_{vars} = \\{x_{1}, x_{2}, s_{1}\\}$，最优基本可行解是 $(x_{1}, x_{2}, s_{1}, s_{2}, s_{3}) = (2, 2, 0, 0, 0)$。\n\n**2. $b_{1}$ 的允许扰动范围**\n\n我们分析所选基 $B_{vars} = \\{x_{1}, x_{2}, s_{1}\\}$ 对于第一个约束右端项 $b_{1}$ 的扰动 $\\Delta$ 的灵敏度。新的右端项向量是 $b' = \\begin{pmatrix} 4+\\Delta \\\\ 2 \\\\ 2 \\end{pmatrix}$。\n\n基矩阵 $B$ 由 $A$ 中对应于基变量 $x_{1}, x_{2}, s_{1}$ 的列组成：\n$B = \\begin{pmatrix} 1  1  1 \\\\ 1  0  0 \\\\ 0  1  0 \\end{pmatrix}$\n我们求基矩阵的逆矩阵 $B^{-1}$：\n$\\begin{pmatrix} 1  1  1  |  1  0  0 \\\\ 1  0  0  |  0  1  0 \\\\ 0  1  0  |  0  0  1 \\end{pmatrix} \\rightarrow \\begin{pmatrix} 1  0  0  |  0  1  0 \\\\ 0  1  0  |  0  0  1 \\\\ 1  1  1  |  1  0  0 \\end{pmatrix} \\rightarrow \\begin{pmatrix} 1  0  0  |  0  1  0 \\\\ 0  1  0  |  0  0  1 \\\\ 0  1  1  |  1  -1  0 \\end{pmatrix} \\rightarrow \\begin{pmatrix} 1  0  0  |  0  1  0 \\\\ 0  1  0  |  0  0  1 \\\\ 0  0  1  |  1  -1  -1 \\end{pmatrix}$\n所以，$B^{-1} = \\begin{pmatrix} 0  1  0 \\\\ 0  0  1 \\\\ 1  -1  -1 \\end{pmatrix}$。\n\n对于扰动后的右端项 $b'$，基变量的值由 $x_{B} = B^{-1}b'$ 给出。只要 $x_{B} \\geq 0$，基就保持可行。\n$x_{B} = \\begin{pmatrix} x_{1} \\\\ x_{2} \\\\ s_{1} \\end{pmatrix} = \\begin{pmatrix} 0  1  0 \\\\ 0  0  1 \\\\ 1  -1  -1 \\end{pmatrix} \\begin{pmatrix} 4+\\Delta \\\\ 2 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} (0)(4+\\Delta) + (1)(2) + (0)(2) \\\\ (0)(4+\\Delta) + (0)(2) + (1)(2) \\\\ (1)(4+\\Delta) - (1)(2) - (1)(2) \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ 2 \\\\ \\Delta \\end{pmatrix}$。\n\n为了使这个解保持可行，所有基变量必须是非负的：\n$x_{1} = 2 \\geq 0$ (满足)\n$x_{2} = 2 \\geq 0$ (满足)\n$s_{1} = \\Delta \\geq 0$\n可行性的条件是 $\\Delta \\geq 0$。这意味着 $b_{1}$ 的允许增加量是任意非负值 ($\\Delta \\ge 0$)，使得允许增加范围非零。允许减少量为零，因为任何 $\\Delta  0$ 都会使 $s_{1}$ 为负，从而违反可行性。这满足了任务中指定的条件。\n\n**3. 约束 1 的影子价格**\n\n对偶变量（影子价格）向量 $y^T$ 由公式 $y^T = c_{B}^T B^{-1}$ 给出，其中 $c_{B}$ 是基变量在目标函数中的系数向量。\n对于基 $\\{x_{1}, x_{2}, s_{1}\\}$，系数向量是 $c_{B}^T = \\begin{pmatrix} 1  1  0 \\end{pmatrix}$ ($z$ 中 $x_{1}, x_{2}, s_{1}$ 的系数)。\n使用前面计算出的 $B^{-1}$：\n$y^T = \\begin{pmatrix} y_{1}  y_{2}  y_{3} \\end{pmatrix} = \\begin{pmatrix} 1  1  0 \\end{pmatrix} \\begin{pmatrix} 0  1  0 \\\\ 0  0  1 \\\\ 1  -1  -1 \\end{pmatrix}$\n$y^T = \\begin{pmatrix} (1)(0)+(1)(0)+(0)(1)   (1)(1)+(1)(0)+(0)(-1)   (1)(0)+(1)(1)+(0)(-1) \\end{pmatrix}$\n$y^T = \\begin{pmatrix} 0   1   1 \\end{pmatrix}$\n约束 $1$、$2$ 和 $3$ 的影子价格分别为 $y_{1}=0$、$y_{2}=1$ 和 $y_{3}=1$。\n对于所选的最优基，与约束 $1$ 相关的影子价格是 $y_{1} = 0$。\n\n**4. 几何解释**\n\n可行域是由不等式 $x_{1} \\ge 0$、$x_{2} \\ge 0$、$x_{1} \\le 2$、$x_{2} \\le 2$ 和 $x_{1}+x_{2} \\le 4$ 定义的一个多边形。最优解位于顶点 $(2,2)$。这个顶点是直线 $x_{1}=2$ (约束 $2$) 和 $x_{2}=2$ (约束 $3$) 的交点。值得注意的是，直线 $x_{1}+x_{2}=4$ (约束 $1$) 也通过这个点。这意味着在最优点，所有三个约束都是紧的，使其成为一个超定（退化）的角点。\n\n一个约束的影子价格衡量的是，当该约束的右端项每增加一个单位时，最优目标值的变化率。\n约束 $1$ 是 $x_{1}+x_{2} \\le 4$。\n对于这个基，允许减少量为零意味着，如果我们收紧这个约束（例如，$x_{1}+x_{2} \\le 3.9$），当前的最优点 $(2,2)$ 就变得不可行。可行域会缩小，最优点必须改变。$b_1$ 的微小变化会导致基的改变。\n\n非零的允许增加量意味着我们可以放宽这个约束（例如，$x_{1}+x_{2} \\le 5$），而当前的基不会变得次优。从几何上看，放宽约束 $1$ 会扩大可行域。然而，最优点 $(2,2)$ 是由约束 $x_1 \\le 2$ 和 $x_2 \\le 2$ 决定的。所以，即使由约束 $1$ 定义的区域变大，最优角点仍然固定在 $(2,2)$，最优目标值也保持为 $z=4$。由于增加 $b_1$ 不会改变最优值，增加 $b_1$ 的边际价值为 $0$。这就是影子价格为 $0$ 的原因。约束 $x_{1}+x_{2} \\le 4$ 在定义最优角点 $(2,2)$ 时是冗余的，尽管它穿过了该点。定义这个特定基本可行解的真正起约束作用的是 $x_1 \\le 2$ 和 $x_2 \\le 2$。", "answer": "$$\\boxed{0}$$", "id": "3179271"}]}