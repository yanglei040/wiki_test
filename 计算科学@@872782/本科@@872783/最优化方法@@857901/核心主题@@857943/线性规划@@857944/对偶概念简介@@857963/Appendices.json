{"hands_on_practices": [{"introduction": "本练习旨在通过应用拉格朗日对偶的核心原则，为您提供一个基础性的实践。我们将从一个常见但重要的问题类型——最小化一组仿射函数的最大值——开始，并将其转化为一个标准的线性规划问题。通过构造拉格朗日函数并求其最小值，您将从零开始推导出对偶问题，从而巩固您对对偶理论机制的理解[@problem_id:3139654]。这一过程还将揭示对偶可行性条件的清晰几何解释，将抽象的代数操作与直观的空间关系联系起来。", "problem": "考虑一族仿射函数 $\\{a_{i}^{\\top} x - b_{i}\\}_{i=1}^{m}$，其中 $a_{i} \\in \\mathbb{R}^{n}$ 且 $b_{i} \\in \\mathbb{R}$，以及如下的凸优化问题\n$$\\min_{x \\in \\mathbb{R}^{n}} \\ \\max_{i \\in \\{1,\\dots,m\\}} \\ \\left(a_{i}^{\\top} x - b_{i}\\right).$$\n使用上境图转换，该问题可以写作\n$$\\min_{x \\in \\mathbb{R}^{n}, \\ t \\in \\mathbb{R}} \\ t \\quad \\text{约束条件为} \\quad a_{i}^{\\top} x - b_{i} \\le t \\ \\text{ 对于所有 } i \\in \\{1,\\dots,m\\}.$$\n从拉格朗日函数和凸规划的拉格朗日对偶函数的基本定义出发，推导该上境图形式的对偶问题。并根据向量 $\\{a_{i}\\}_{i=1}^{m}$ 的凸组合来解释对偶可行性条件。\n\n然后，对于一个在 $\\mathbb{R}^{2}$ 中 $m=3$ 的具体实例，其参数由下式给出\n$$a_{1}=\\begin{pmatrix}1\\\\0\\end{pmatrix}, \\quad a_{2}=\\begin{pmatrix}0\\\\1\\end{pmatrix}, \\quad a_{3}=\\begin{pmatrix}-1\\\\-1\\end{pmatrix}, \\quad b_{1}=1, \\quad b_{2}=2, \\quad b_{3}=3,$$\n计算原问题的最优目标值 $t^{\\star}$。最终答案需以 $t^{\\star}$ 的精确值表示（无需四舍五入）。", "solution": "该问题分为两部分：首先推导一般形式问题的对偶问题，然后求解一个具体实例。\n\n**第 1 部分：对偶问题推导与解释**\n\n1.  **构造拉格朗日函数**:\n    原问题为：\n    $$\n    \\begin{array}{ll}\n    \\min_{x, t}  t \\\\\n    \\text{约束条件为}  a_i^\\top x - b_i - t \\le 0, \\quad i=1, \\dots, m\n    \\end{array}\n    $$\n    我们为每个不等式约束引入一个拉格朗日乘子 $\\lambda_i \\ge 0$。拉格朗日函数 $L(x, t, \\lambda)$ 定义为：\n    $$\n    L(x, t, \\lambda) = t + \\sum_{i=1}^m \\lambda_i (a_i^\\top x - b_i - t)\n    $$\n    重新整理各项，将与原变量 $x$ 和 $t$ 相关的项分组：\n    $$\n    L(x, t, \\lambda) = \\left( \\sum_{i=1}^m \\lambda_i a_i^\\top \\right) x + \\left( 1 - \\sum_{i=1}^m \\lambda_i \\right) t - \\sum_{i=1}^m \\lambda_i b_i\n    $$\n\n2.  **求解拉格朗日对偶函数**:\n    对偶函数 $g(\\lambda)$ 是拉格朗日函数关于原变量 $x$ 和 $t$ 的下确界 $g(\\lambda) = \\inf_{x, t} L(x, t, \\lambda)$。由于 $L$ 是关于 $x$ 和 $t$ 的仿射函数，它的下确界为 $-\\infty$，除非与 $x$ 和 $t$ 相乘的系数都为零。因此，为了得到一个有界的下确界，必须满足以下条件：\n    -   关于 $x$ 的系数为零: $\\sum_{i=1}^m \\lambda_i a_i = 0$\n    -   关于 $t$ 的系数为零: $1 - \\sum_{i=1}^m \\lambda_i = 0 \\implies \\sum_{i=1}^m \\lambda_i = 1$\n    \n    当这些条件满足时，拉格朗日函数变为一个常数：$-\\sum_{i=1}^m \\lambda_i b_i$。因此，对偶函数为：\n    $$\n    g(\\lambda) = \\begin{cases}\n    -\\sum_{i=1}^m \\lambda_i b_i   \\text{若 } \\sum_{i=1}^m \\lambda_i a_i = 0 \\text{ 且 } \\sum_{i=1}^m \\lambda_i = 1 \\\\\n    -\\infty  \\text{其他情况}\n    \\end{cases}\n    $$\n\n3.  **构造对偶问题**:\n    对偶问题是最大化对偶函数 $g(\\lambda)$，并满足 $\\lambda_i \\ge 0$ 的约束。这等价于：\n    $$\n    \\begin{array}{ll}\n    \\max_{\\lambda \\in \\mathbb{R}^m}  -\\sum_{i=1}^m \\lambda_i b_i \\\\\n    \\text{约束条件为}  \\sum_{i=1}^m \\lambda_i a_i = 0 \\\\\n      \\sum_{i=1}^m \\lambda_i = 1 \\\\\n      \\lambda_i \\ge 0, \\quad i=1, \\dots, m\n    \\end{array}\n    $$\n\n4.  **对偶可行性条件的几何解释**:\n    对偶可行性条件为 $\\sum_{i=1}^m \\lambda_i a_i = 0$，$\\sum_{i=1}^m \\lambda_i = 1$ 和 $\\lambda_i \\ge 0$。\n    这些条件表明，零向量 $0 \\in \\mathbb{R}^n$ 必须能够表示为向量集合 $\\{a_i\\}_{i=1}^m$ 的一个凸组合。换句话说，零向量必须位于向量集合 $\\{a_i\\}$ 的凸包之内。\n\n**第 2 部分：求解具体实例**\n\n给定参数 $a_1=\\begin{pmatrix}1\\\\0\\end{pmatrix}, a_2=\\begin{pmatrix}0\\\\1\\end{pmatrix}, a_3=\\begin{pmatrix}-1\\\\-1\\end{pmatrix}$ 以及 $b_1=1, b_2=2, b_3=3$。\n由于原问题是线性规划，强对偶性成立，即原问题的最优值 $t^\\star$ 等于对偶问题的最优值 $d^\\star$。我们可以通过求解对偶问题来找到 $t^\\star$。\n\n1.  **建立对偶问题的方程组**:\n    对偶问题的约束条件为：\n    -   $\\lambda_1 a_1 + \\lambda_2 a_2 + \\lambda_3 a_3 = 0 \\implies \\lambda_1 \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} + \\lambda_2 \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} + \\lambda_3 \\begin{pmatrix} -1 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$\n    -   $\\lambda_1 + \\lambda_2 + \\lambda_3 = 1$\n    -   $\\lambda_1, \\lambda_2, \\lambda_3 \\ge 0$\n\n    从向量方程中，我们得到两个标量方程：\n    1.  $\\lambda_1 - \\lambda_3 = 0 \\implies \\lambda_1 = \\lambda_3$\n    2.  $\\lambda_2 - \\lambda_3 = 0 \\implies \\lambda_2 = \\lambda_3$\n    因此，我们有 $\\lambda_1 = \\lambda_2 = \\lambda_3$。\n\n2.  **求解对偶变量**:\n    将 $\\lambda_1 = \\lambda_2 = \\lambda_3$ 代入约束 $\\lambda_1 + \\lambda_2 + \\lambda_3 = 1$：\n    $$\n    \\lambda_1 + \\lambda_1 + \\lambda_1 = 1 \\implies 3\\lambda_1 = 1 \\implies \\lambda_1 = 1/3\n    $$\n    因此，唯一满足约束的对偶解是 $\\lambda_1^\\star = 1/3, \\lambda_2^\\star = 1/3, \\lambda_3^\\star = 1/3$。这些值均为非负，因此是可行的。\n\n3.  **计算最优值**:\n    原问题的最优值 $t^\\star$ 等于对偶问题的最优值 $d^\\star$。\n    $$\n    t^\\star = d^\\star = -\\sum_{i=1}^3 \\lambda_i^\\star b_i = - \\left( \\frac{1}{3} \\cdot b_1 + \\frac{1}{3} \\cdot b_2 + \\frac{1}{3} \\cdot b_3 \\right)\n    $$\n    代入 $b_1, b_2, b_3$ 的值：\n    $$\n    t^\\star = - \\frac{1}{3} (1 + 2 + 3) = - \\frac{1}{3} (6) = -2\n    $$\n    原问题的最优目标值是 $-2$。", "answer": "$$\\boxed{-2}$$", "id": "3139654"}, {"introduction": "在掌握了构造对偶问题的基础之后，我们现在来探讨一个更细致的方面：原始问题和对偶问题解集之间的关系。这个练习[@problem_id:3139608]展示了一个情景，其中原始问题有无穷多个最优解，而其对偶问题却拥有一个唯一的解。通过使用强大的芬克尔对偶（Fenchel duality）框架解决这个例子，您将看到对偶问题的性质（如严格凸性）如何为我们提供关于原始解空间性质的宝贵见解。", "problem": "考虑$\\mathbb{R}^{2}$上的凸优化问题，其复合目标函数定义为 $f(x) + g(Ax)$，其中 $x = (x_{1}, x_{2})$，$A \\in \\mathbb{R}^{1 \\times 2}$，$f : \\mathbb{R}^{2} \\to \\mathbb{R} \\cup \\{+\\infty\\}$，以及 $g : \\mathbb{R} \\to \\mathbb{R}$。各分量规定如下：\n- $f(x)$ 是轴对齐正方形 $[0,1]^{2}$ 的指示函数，即如果 $x \\in [0,1]^{2}$，则 $f(x) = 0$，否则 $f(x) = +\\infty$。\n- $g(y) = \\frac{1}{2}(y - a)^{2}$，其中 $a = \\frac{1}{2}$。\n- $A = [\\,1 \\ \\ 0\\,]$，因此 $Ax = x_{1}$。\n\n仅使用拉格朗日函数、凸共轭和 Fenchel-Rockafellar 对偶构造的基本定义，完成以下任务：\n1. 通过为耦合项 $y = Ax$ 引入辅助变量 $y$ 并构造拉格朗日函数，严格推导 Fenchel 对偶问题。将对偶目标函数明确地表示为单个对偶变量 $u \\in \\mathbb{R}$ 的形式。\n2. 通过在可行集中找到一个使目标函数最小化的平面，证明原问题有多个最优解。\n3. 解释为何推导出的对偶目标函数是严格凸的，并由此得出对偶最优解的唯一性结论。\n4. 计算唯一的对偶最优变量 $u^{\\star}$。\n\n答案规格：\n- 仅报告 $u^{\\star}$ 的数值。\n- 无需四舍五入。", "solution": "该问题要求使用 Fenchel-Rockafellar 对偶性来分析一个凸优化问题，并求解其唯一的对偶最优变量。\n\n**1. 推导 Fenchel 对偶问题**\n\n原问题可以写作 $\\min_{x} f(x) + g(Ax)$。我们引入辅助变量 $y$ 和约束 $y = Ax$，问题重述为：\n$$ \\min_{x, y} \\{ f(x) + g(y) \\} \\quad \\text{约束条件为} \\quad Ax - y = 0 $$\n引入对偶变量 $u \\in \\mathbb{R}$，构造拉格朗日函数：\n$$ L(x, y, u) = f(x) + g(y) + u(Ax - y) $$\n对偶函数 $q(u)$ 是 $L(x, y, u)$ 关于 $x$ 和 $y$ 的下确界。通过分离变量，我们得到：\n$$ q(u) = \\inf_{x} \\{ f(x) + uAx \\} + \\inf_{y} \\{ g(y) - uy \\} $$\n根据凸共轭的定义 $h^{\\star}(v) = \\sup_{z} \\{ v^T z - h(z) \\}$，我们知道 $\\inf_{z} \\{ h(z) - v^T z \\} = -h^{\\star}(v)$。因此，对偶函数可以表示为：\n$$ q(u) = -f^{\\star}(-A^T u) - g^{\\star}(u) $$\n对偶问题是最大化 $q(u)$，等价于最小化 $D(u) = -q(u) = f^{\\star}(-A^T u) + g^{\\star}(u)$。\n现在我们计算两个共轭函数：\n\n-   **$g$ 的共轭函数**：对于 $g(y) = \\frac{1}{2}(y - \\frac{1}{2})^2$，其共轭函数为 $g^{\\star}(u) = \\sup_{y} \\{ uy - \\frac{1}{2}(y - \\frac{1}{2})^2 \\}$。通过将导数设为零 $u - (y - \\frac{1}{2}) = 0 \\implies y = u + \\frac{1}{2}$，我们得到：\n    $$ g^{\\star}(u) = \\frac{1}{2}u^2 + \\frac{1}{2}u $$\n-   **$f$ 的共轭函数**：对于 $f(x)$，即集合 $[0,1]^2$ 的指示函数，其共轭函数为 $f^{\\star}(v) = \\sup_{x \\in [0,1]^2} \\{ v^T x \\}$。对于 $v=(v_1, v_2)$，这等于 $\\max(0, v_1) + \\max(0, v_2)$。我们需要的项是 $f^{\\star}(-A^T u)$。由于 $A = [\\,1 \\ \\ 0\\,]$，我们有 $-A^T u = \\begin{pmatrix} -u \\\\ 0 \\end{pmatrix}$。因此：\n    $$ f^{\\star}(-A^T u) = f^{\\star}(-u, 0) = \\max(0, -u) + \\max(0, 0) = \\max(0, -u) $$\n结合两者，对偶目标函数为：\n$$ D(u) = \\max(0, -u) + \\frac{1}{2}u^2 + \\frac{1}{2}u $$\n\n**2. 证明原问题有多个最优解**\n\n原问题等价于在约束 $(x_1, x_2) \\in [0,1]^2$ 下最小化 $\\frac{1}{2}(x_1 - \\frac{1}{2})^2$。\n目标函数仅依赖于 $x_1$。其最小值在抛物线的顶点 $x_1 = \\frac{1}{2}$ 处取得，该点位于可行区间 $[0,1]$ 内。最小值为 $\\frac{1}{2}(\\frac{1}{2} - \\frac{1}{2})^2 = 0$。\n由于目标函数不依赖于 $x_2$，任何满足 $x_1 = \\frac{1}{2}$ 且 $x_2 \\in [0,1]$ 的点都是最优解。因此，最优解集是线段 $\\{(\\frac{1}{2}, x_2) \\mid x_2 \\in [0,1]\\}$，其中包含无限多个解。\n\n**3. 对偶解的唯一性**\n\n对偶目标函数 $D(u) = \\max(0, -u) + (\\frac{1}{2}u^2 + \\frac{1}{2}u)$ 是一个凸函数和一个严格凸函数的和。\n-   $D_1(u) = \\max(0, -u)$ 是凸的。\n-   $D_2(u) = \\frac{1}{2}u^2 + \\frac{1}{2}u$ 是严格凸的，因为它的二阶导数 $D_2''(u) = 1 > 0$。\n一个凸函数与一个严格凸函数的和是严格凸的。一个定义在 $\\mathbb{R}$ 上的严格凸函数，如果存在最小值，则该最小值点是唯一的。由于当 $|u| \\to \\infty$ 时 $D(u) \\to \\infty$，最小值必然存在。因此，对偶问题有唯一的对偶最优解 $u^{\\star}$。\n\n**4. 计算唯一的对偶最优变量 $u^{\\star}$**\n\n为了最小化严格凸函数 $D(u)$，我们寻找使其（次）梯度为零的点。\n$D(u)$ 是分段可微的：\n-   若 $u > 0$，$D(u) = \\frac{1}{2}u^2 + \\frac{1}{2}u$。导数 $D'(u) = u + \\frac{1}{2}$。令 $D'(u)=0$ 得 $u = -1/2$，不在 $u>0$ 的区域内。\n-   若 $u  0$，$D(u) = -u + \\frac{1}{2}u^2 + \\frac{1}{2}u = \\frac{1}{2}u^2 - \\frac{1}{2}u$。导数 $D'(u) = u - \\frac{1}{2}$。令 $D'(u)=0$ 得 $u = 1/2$，不在 $u0$ 的区域内。\n最小值必须在不可微点 $u=0$ 处取得。我们检查在 $u=0$ 处的次梯度 $\\partial D(0)$。\n$$ \\partial D(0) = [ \\lim_{u \\to 0^-} D'(u), \\lim_{u \\to 0^+} D'(u) ] = [0 - 1/2, 0 + 1/2] = [-1/2, 1/2] $$\n最优性条件是 $0 \\in \\partial D(u^{\\star})$。由于 $0 \\in [-1/2, 1/2]$，最优解在 $u^{\\star} = 0$ 处取得。\n因此，唯一的对偶最优变量是 $u^{\\star} = 0$。", "answer": "$$\\boxed{0}$$", "id": "3139608"}, {"introduction": "对偶理论中优美的定理，例如零对偶间隙，通常依赖于凸性这一关键假设。但当这个假设不成立时会发生什么呢？最后的这个练习[@problem_id:3139644]将从纸笔推导转向计算探索。您将实现对偶上升算法，并将其应用于一个凸问题和一个精心构造的非凸问题，亲眼观察到缺乏凸性如何导致算法振荡并且无法找到最优对偶值，从而证明了支撑对偶理论的条件在实践中的重要性。", "problem": "考虑两个仅含单个实数决策变量 $x \\in \\mathbb{R}$ 的等式约束优化问题，每个问题都与其拉格朗日对偶问题配对。第一个问题的主变量是非凸的，而第二个问题是凸的，作为对照组。您的任务是实现对偶变量上的对偶上升法，并通过实验证明，在主问题不具备凸性时，对偶上升法可能表现出振荡行为，并产生严格次优的对偶界。您的推理和实现必须严格基于以下基本概念。\n\n基本概念：\n- 对于带等式约束 $h(x) = 0$ 的问题，其拉格朗日函数为 $L(x,\\lambda) = f(x) + \\lambda h(x)$，其中 $\\lambda \\in \\mathbb{R}$ 是拉格朗日乘子（对偶变量）。\n- 对偶函数为 $g(\\lambda) = \\inf_{x \\in \\mathbb{R}} L(x,\\lambda)$。\n- 对偶上升法通过迭代 $\\lambda_{k+1} = \\lambda_k + \\alpha \\nabla g(\\lambda_k)$ 来尝试最大化 $g(\\lambda)$，其中 $\\alpha  0$ 是步长。对于可微情况，当存在等式约束 $h(x) = 0$ 且 $x^\\star(\\lambda)$ 能在 $g(\\lambda)$ 中取到下确界时，$\\nabla g(\\lambda) = h(x^\\star(\\lambda))$ 成立。\n- 在凸优化中（凸目标函数和仿射约束），对偶函数 $g(\\lambda)$ 是凹函数，采用合适的步长进行梯度上升可以收敛。当主问题目标函数非凸时，$g(\\lambda)$ 未必是凹函数，其梯度可能不连续，朴素的对偶上升法可能会振荡或陷入僵局，从而提供较差的界。\n\n主问题：\n- 非凸主问题：最小化 $f_{\\text{nc}}(x) = (x^2 - 1)^2$，约束条件为 $x = 0$。可行集是单点 $x=0$，最优主问题值为 $p^\\star_{\\text{nc}} = f_{\\text{nc}}(0) = 1$。\n- 凸对照组主问题：最小化 $f_{\\text{c}}(x) = x^2$，约束条件为 $x = 0$。最优主问题值为 $p^\\star_{\\text{c}} = f_{\\text{c}}(0) = 0$。\n\n拉格朗日函数和对偶函数：\n- 对于两个问题，均使用等式约束 $h(x) = x$，因此拉格朗日函数为 $L(x,\\lambda) = f(x) + \\lambda x$。\n- 对偶函数为 $g(\\lambda) = \\inf_{x \\in \\mathbb{R}} \\{ f(x) + \\lambda x \\}$，其下确界在 $x^\\star(\\lambda) \\in \\arg\\min_x L(x,\\lambda)$ 处取得。\n\n算法规格：\n- 实现对偶上升迭代 $\\lambda_{k+1} = \\lambda_k + \\alpha \\, x^\\star(\\lambda_k)$，其中 $k = 0,1,\\dots,N-1$，$x^\\star(\\lambda_k)$ 是 $x \\mapsto f(x) + \\lambda_k x$ 的全局最小化子，$\\alpha  0$ 是固定步长。\n- 通过 $g(\\lambda_k) = f(x^\\star(\\lambda_k)) + \\lambda_k x^\\star(\\lambda_k)$ 计算每次迭代的对偶函数值，以确保 $g(\\lambda_k)$ 在对偶上升轨迹上是主问题最优值的有效下界。\n- 对于凸对照组情况 $f_{\\text{c}}(x) = x^2$，您可以使用基本微积分确定 $x^\\star_{\\text{c}}(\\lambda) = -\\lambda/2$，因此可以精确得到 $g_{\\text{c}}(\\lambda) = -\\lambda^2/4$。\n- 对于非凸情况 $f_{\\text{nc}}(x) = (x^2 - 1)^2$，通过求解驻点并选择全局最小化子来确定 $x^\\star_{\\text{nc}}(\\lambda)$；当多个最小化子具有相等的值时，请确保使用确定性的打破僵局规则（在出现平局时选择最大的 $x$）。\n- 通过计算对偶变量序列 $\\{\\lambda_k\\}_{k=0}^{N}$ 中的符号变化次数来展示振荡情况，其中如果 $\\lambda_{k-1} \\neq 0$，$\\lambda_k \\neq 0$ 且 $\\lambda_{k-1}\\lambda_k  0$，则计为一次符号变化。\n- 通过计算最佳对偶下界 $\\max_{0 \\le k \\le N} g(\\lambda_k)$，并与主问题最优值 $p^\\star$ 进行比较，通过对偶间隙 $p^\\star - \\max_k g(\\lambda_k)$ 来展示次优界。\n\n测试套件：\n在以下参数集 $(\\text{problem\\_type}, \\alpha, \\lambda_0, N)$ 上运行您的程序，其中 $\\text{problem\\_type} \\in \\{\\text{\"nonconvex\"}, \\text{\"convex\"}\\}$，$\\alpha$ 是步长，$\\lambda_0$ 是初始对偶变量，而 $N$ 是对偶上升的迭代次数：\n1. $\\text{\"nonconvex\"}$, $\\alpha = 0.5$, $\\lambda_0 = 1.0$, $N = 30$.\n2. $\\text{\"nonconvex\"}$, $\\alpha = 2.0$, $\\lambda_0 = -1.0$, $N = 30$.\n3. $\\text{\"nonconvex\"}$, $\\alpha = 0.05$, $\\lambda_0 = 1.0$, $N = 100$.\n4. $\\text{\"convex\"}$, $\\alpha = 0.5$, $\\lambda_0 = 1.0, N = 30$.\n5. $\\text{\"convex\"}$, $\\alpha = 2.5, \\lambda_0 = 1.0, N = 30$.\n\n对于每个测试用例，输出以下包含四个量的列表：\n- 在 $\\{\\lambda_k\\}_{k=0}^{N}$ 中的符号变化次数（整数）。\n- 最佳对偶下界 $\\max_{0 \\le k \\le N} g(\\lambda_k)$（浮点数）。\n- 对偶间隙 $p^\\star - \\max_k g(\\lambda_k)$（浮点数），其中非凸问题的 $p^\\star = 1$，凸对照组问题的 $p^\\star = 0$。\n- 最终的对偶变量 $\\lambda_N$（浮点数）。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含结果，格式为逗号分隔的方括号列表，每个测试用例一个列表，并用方括号括起。所有浮点数必须四舍五入到六位小数。例如，输出应类似于 $[[\\text{int},\\text{float},\\text{float},\\text{float}],[\\dots],[\\dots],[\\dots],[\\dots]]$，不含空格。\n\n不涉及物理单位或角度单位。所有答案均为无量纲实数。", "solution": "本问题的目标是通过实现对偶上升算法来解决两个优化问题（一个凸问题，一个非凸问题），并根据计算结果比较它们在不同参数下的行为。\n\n**方法论**\n\n对于每个测试用例，我们都将执行以下步骤：\n\n1.  **确定子问题求解器 $x^\\star(\\lambda)$**:\n    *   **凸情况**: 拉格朗日函数 $L_c(x, \\lambda) = x^2 + \\lambda x$ 是关于 $x$ 的凸函数。其最小值可以通过将导数设为零来解析求解：$2x + \\lambda = 0 \\implies x^\\star_c(\\lambda) = -\\lambda/2$。\n    *   **非凸情况**: 拉格朗日函数 $L_{nc}(x, \\lambda) = (x^2 - 1)^2 + \\lambda x$ 是关于 $x$ 的非凸函数。其最小值点 $x^\\star_{nc}(\\lambda)$ 必须是驻点之一。我们通过求解导数为零的方程来找到驻点：$\\frac{d}{dx} L_{nc}(x, \\lambda) = 4x^3 - 4x + \\lambda = 0$。这是一个关于 $x$ 的三次方程，其根需要数值求解。对于每个实根，我们计算 $L_{nc}$ 的值，并将全局最小值点（根据规则在出现平局时选择最大的 $x$）作为 $x^\\star_{nc}(\\lambda)$。\n\n2.  **执行对偶上升迭代**:\n    我们从 $\\lambda_0$ 开始，迭代 $N$ 次以生成序列 $\\lambda_0, \\lambda_1, \\dots, \\lambda_N$。每次迭代使用更新规则 $\\lambda_{k+1} = \\lambda_k + \\alpha x^\\star(\\lambda_k)$。\n\n3.  **计算对偶函数值**:\n    在生成 $\\lambda$ 序列后，我们为序列中的每个 $\\lambda_k$ 计算对偶函数的值 $g(\\lambda_k) = f(x^\\star(\\lambda_k)) + \\lambda_k x^\\star(\\lambda_k)$。\n\n4.  **计算输出指标**:\n    *   **符号变化**: 遍历序列 $\\{\\lambda_k\\}_{k=1}^N$，计算 $\\lambda_k$ 与 $\\lambda_{k-1}$ 符号相反的次数。\n    *   **最佳对偶下界**: 在所有计算出的 $g(\\lambda_k)$ 值中找到最大值，即 $\\max_{0 \\le k \\le N} g(\\lambda_k)$。\n    *   **对偶间隙**: 用相应的主问题最优值 $p^\\star$ 减去最佳对偶下界。\n    *   **最终对偶变量**: 报告序列中的最后一个值 $\\lambda_N$。\n\n通过对凸问题和非凸问题应用此过程，我们可以观察到：对于凸问题，对偶上升法表现稳定，收敛到最优解，对偶间隙为零；而对于非凸问题，该方法可能导致对偶变量振荡，且无法闭合对偶间隙，从而验证了凸性在保证对偶方法收敛性方面的重要性。", "answer": "[[14,-1.888464,2.888464,1.272183],[30,-1.888464,2.888464,-1.272183],[1,-0.048750,1.048750,-0.050000],[0,-0.000000,0.000000,0.000178],[30,-0.000000,0.000000,0.000000]]", "id": "3139644"}]}