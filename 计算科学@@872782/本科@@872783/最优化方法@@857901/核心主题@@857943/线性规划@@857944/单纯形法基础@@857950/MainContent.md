## 引言
[线性规划](@entry_id:138188)是[优化理论](@entry_id:144639)的基石，致力于在满足一系列线性约束条件下，最大化或最小化一个线性[目标函数](@entry_id:267263)。而单纯形法，自George Dantzig提出以来，便一直是求解[线性规划](@entry_id:138188)问题最核心、最经典的方法。它不仅是一种高效的算法，更是一种思考和分析资源分配问题的强大思维框架。然而，初学者往往对其背后的数学原理和迭代步骤感到困惑，难以将其与现实世界的决策问题联系起来。

本篇文章旨在系统性地揭示单纯形法的全貌，弥合理论与实践之间的鸿沟。我们将带领读者深入探索这一强大的优化工具，从基本原理到广泛应用，最终通过实践加深理解。

*   在**“原理与机制”**一章中，我们将剖析单纯形法的核心迭代过程，阐明算法如何在[可行域的顶点](@entry_id:174284)间移动以寻找最优解，并探讨如何处理无界性、退化等特殊情况，以及如何通过[两阶段法](@entry_id:166636)等技术寻找初始解。
*   接着，在**“应用与跨学科联系”**一章中，我们将展示单纯形法如何在[运筹学](@entry_id:145535)、经济学、金融甚至机器学习等多个领域解决实际问题。您将看到[对偶变量](@entry_id:143282)如何化身为“影子价格”，为资源分配和战略决策提供深刻的经济洞察。
*   最后，在**“动手实践”**部分，我们提供了一系列精选的练习题，旨在帮助您巩固关键概念，如处理退化、寻找初始解和识别多重最优解，从而将理论知识转化为解决问题的实际能力。

通过本篇文章的学习，您将不仅掌握单纯形法的计算方法，更能深刻理解其背后的经济学直觉和在现代决策科学中的核心地位。

## 原理与机制

[线性规划](@entry_id:138188)的单纯形法是一种系统性的迭代算法，其核心思想是在[可行域的顶点](@entry_id:174284)之间移动，每一步都旨在改进[目标函数](@entry_id:267263)值，直至达到最优解。本章将深入剖析单纯形法的基本原理和核心机制，阐明其从一个基本可行解移动到下一个的完整过程，并探讨在此过程中可能出现的各种特殊情况。

### 单纯形迭代的剖析：从一个顶点到相邻顶点

单纯形法的基础是，对于一个有界线性规划问题，最优解必然在可行域的某个顶点上达到。这些顶点在代数上对应于**基本可行解 (Basic Feasible Solution, BFS)**。一个基本解是通过将变量分为**基变量** ($x_B$) 和**非基变量** ($x_N$) 来定义的。在一个包含 $m$ 个线性无关约束的标准型问题中，我们选择 $m$ 个变量作为基变量，其余变量作为非基变量。通过将所有非基变量设为零，我们就可以求解基变量的值。如果所有基变量的值都非负，这个基本解就是一个基本[可行解](@entry_id:634783)。

考虑标准形式的[线性规划](@entry_id:138188)问题：最大化 $z = c^\top x$，约束条件为 $Ax = b$ 和 $x \ge 0$。我们可以将矩阵 $A$ 分解为基矩阵 $B$ 和非基矩阵 $N$，同样，向量 $x$ 和 $c$ 也可以相应地分解。约束方程 $Ax=b$ 可以重写为 $Bx_B + Nx_N = b$。由于基矩阵 $B$ 是可逆的，我们可以将基变量表示为：

$x_B = B^{-1}b - B^{-1}Nx_N$

这是一个核心关系式，它构成了单纯形法的“字典”或“单纯形表”。当前的 BFS 对应于 $x_N = 0$，此时基变量的值为 $x_B = B^{-1}b$。

一次单纯形迭代，或称**枢轴变换 (pivot)**，是从一个 BFS 移动到一个相邻的 BFS 的过程。这个过程通过选择一个非基变量进入基，并选择一个基变量离开基来完成。这个过程围绕着三个关键问题展开：

1.  **方向选择**：我们应该增加哪个非基变量的值，才能最有效地改进[目标函数](@entry_id:267263)？（即，选择**进基变量**）
2.  **步长确定**：沿着选定的方向，我们能走多远而不违反可行性（即非负性约束）？（即，选择**出基变量**）
3.  **终止判断**：我们是否已经到达终点（最优解），或者问题本身是否存在特殊情况（如无界）？

### [最优性检验](@entry_id:164180)：识别最佳顶点

要回答第一个问题，我们需要一种衡量标准来评估增加一个非基变量对[目标函数](@entry_id:267263)的影响。这个标准就是**[检验数](@entry_id:173345) (reduced cost)**。[目标函数](@entry_id:267263) $z = c^\top x = c_B^\top x_B + c_N^\top x_N$。将 $x_B$ 的表达式代入，我们得到：

$z = c_B^\top (B^{-1}b - B^{-1}Nx_N) + c_N^\top x_N = c_B^\top B^{-1}b - (c_B^\top B^{-1}N - c_N^\top)x_N$

令 $\pi^\top = c_B^\top B^{-1}$，这个向量 $\pi$ 被称为**单纯形乘子 (simplex multipliers)** 或[对偶变量](@entry_id:143282)。于是，目标函数可以表示为当前值与非基变量的[线性组合](@entry_id:154743)：

$z = z_0 + (c_N^\top - \pi^\top N)x_N = z_0 + \sum_{j \in \mathcal{N}} \bar{c}_j x_j$

其中 $z_0 = c_B^\top B^{-1}b$ 是当前 BFS 的目标函数值，$\mathcal{N}$ 是非基变量的索引集。$\bar{c}_j = c_j - \pi^\top A_j$ 就是非基变量 $x_j$ 的[检验数](@entry_id:173345)。它表示当 $x_j$ 的值从 0 增加一个单位时，目标函数 $z$ 的变化率。

对于一个最大化问题，[最优性条件](@entry_id:634091)是：如果所有非基变量的[检验数](@entry_id:173345)都非正（$\bar{c}_j \le 0$ for all $j \in \mathcal{N}$），则当前解是最优解。因为增加任何非基变量的值都不能使[目标函数](@entry_id:267263)值增加。

在实际操作中，我们计算所有非基变量的[检验数](@entry_id:173345)。如果存在一个或多个[检验数](@entry_id:173345)为正的非基变量，我们就可以选择其中一个作为进基变量。一个常见的选择策略是**丹齐格法则 (Dantzig's rule)**，即选择具有最大正[检验数](@entry_id:173345)的变量作为进基变量，因为它提供了[目标函数](@entry_id:267263)最陡峭的增长方向 [@problem_id:3182212]。

### 枢轴变换机制：移动到更优的顶点

一旦确定了进基变量（例如 $x_j$），我们就需要回答第二个问题：可以增加 $x_j$ 多少？设 $x_j$ 的值从 0 增加到 $\theta > 0$，同时保持其他非基变量为 0。基变量的值将随之改变：

$x_B(\theta) = B^{-1}b - (B^{-1}A_j) \theta = \bar{b} - \bar{A}_j \theta$

这里 $\bar{b} = B^{-1}b$ 是当前基变量的值，$\bar{A}_j = B^{-1}A_j$ 是单纯形表中进基变量 $x_j$ 对应的列向量。为了维持可行性，所有变量必须保持非负，即 $x_B(\theta) \ge 0$。这个条件限制了 $\theta$ 的最大值。

对于基变量 $x_{B_i}$，我们有 $(x_B)_i(\theta) = \bar{b}_i - \bar{a}_{ij} \theta \ge 0$。

- 如果 $\bar{a}_{ij} \le 0$，那么当 $\theta$ 增加时，$(x_B)_i$ 不会减少，此约束不会限制 $\theta$ 的大小。
- 如果 $\bar{a}_{ij} > 0$，那么我们必须有 $\theta \le \frac{\bar{b}_i}{\bar{a}_{ij}}$。

为了确保所有基变量都保持非负，$\theta$ 必须小于或等于所有这些上界中的最小值。这个过程被称为**最小比率测试 (minimum ratio test)**：

$\theta^* = \min \left\{ \frac{\bar{b}_i}{\bar{a}_{ij}} \mid \bar{a}_{ij} > 0 \right\}$

这个最小步长 $\theta^*$ 决定了哪个基变量将首先达到 0。这个首先达到 0 的基变量就成为**出基变量** [@problem_id:3182223]。通过将 $x_j$ 引入基，并将这个出基变量移出基，我们就完成了一次枢轴变换，到达了一个新的 BFS。

### 特殊情况与处理

在单纯形法的迭代过程中，可能会遇到一些特殊情况，理解这些情况对于掌握算法至关重要。

#### 无界性

如果在选择进基变量 $x_j$（对于最大化问题，$\bar{c}_j > 0$）后，发现其在单纯形表中的对应列 $\bar{A}_j$ 所有元素都非正（即 $\bar{a}_{ij} \le 0$ for all $i$），那么最小比率测试将无法进行，因为没有正的分母。这意味着我们可以无限地增加 $x_j$ 的值，而不会导致任何基变量变为负数。由于 $\bar{c}_j > 0$，目标函数值也将随之无限增加。这种情况表明原线性规划问题是**无界的 (unbounded)**。此时，单纯形法终止，并报告问题无界。该算法提供了一个**无界性证书**：一个改进方向，沿着该方向可行域是无限的，且[目标函数](@entry_id:267263)持续改进 [@problem_id:3182239]。

#### 退化与循环

当一个或多个基变量的值为 0 时，称该 BFS 是**退化的 (degenerate)**。退化是线性规划中一个重要的理论和实践问题。在进行最小比率测试时，如果分子 $\bar{b}_i$ 为 0，而分母 $\bar{a}_{ij} > 0$，则最小比率 $\theta^*$ 将为 0。

这意味着枢轴变换的步长为 0。尽管我们执行了一次基的交换，但解的几何位置并未改变，目标函数值也保持不变（$\Delta z = \bar{c}_j \theta^* = 0$），这种现象称为**停滞 (stagnation)** [@problem_id:3182179]。虽然[检验数](@entry_id:173345)表明存在改进方向，但由于退化，我们无法沿该方向迈出任何[实质](@entry_id:149406)性的一步。

在极端情况下，一系列步长为 0 的退化枢轴变换可能导致算法重新访问之前已经访问过的基，从而陷入一个无限循环，这种现象称为**循环 (cycling)**。尽管在实际问题中很少见，但理论上它可能发生。为了避免循环，可以使用一些**[反循环规则](@entry_id:637416) (anti-cycling rule)**，例如**[布兰德法则](@entry_id:165331) (Bland's rule)**。[布兰德法则](@entry_id:165331)规定，在选择进基和出基变量时，如果存在多个选择，总是选择索引最小的那个变量。这个简单的规则足以从理论上保证单纯形法在有限步内终止 [@problem_id:3182224]。

### 寻找初始解：[两阶段法](@entry_id:166636)与[对偶单纯形法](@entry_id:164344)

单纯形法需要一个初始的基本[可行解](@entry_id:634783)作为起点。对于形如 $Ax \le b$ 且 $b \ge 0$ 的问题，我们可以通过引入[松弛变量](@entry_id:268374)，以[松弛变量](@entry_id:268374)为基，原点为非基，轻松获得一个初始 BFS。但当问题包含[等式约束](@entry_id:175290)或 $\ge$ 约束时，寻找初始 BFS 并非易事。

#### [两阶段法](@entry_id:166636)

为了解决这个问题，我们可以采用**[两阶段法](@entry_id:166636) (Two-Phase Method)**。

**第一阶段 (Phase I)** 的目标是为原问题找到一个 BFS。我们引入非负的**[人工变量](@entry_id:164298) (artificial variables)** 到那些没有现成基变量的约束中（通常是等式和 $\ge$ 约束）。然后，我们求解一个辅助的[线性规划](@entry_id:138188)问题：最小化所有[人工变量](@entry_id:164298)之和。

- 如果第一阶段结束时，[目标函数](@entry_id:267263)（[人工变量](@entry_id:164298)之和）的最小值为 0，这意味着所有[人工变量](@entry_id:164298)都可以被驱动到 0。此时，我们找到了原问题的一个 BFS。我们可以将[人工变量](@entry_id:164298)从基中移除，然后以这个 BFS 为起点，进入**第二阶段 (Phase II)**，即求解原问题的目标函数 [@problem_id:3182250]。
- 如果第一阶段结束时，[目标函数](@entry_id:267263)的最小值大于 0，这意味着不可能在满足原约束的同时使所有[人工变量](@entry_id:164298)都为 0。因此，原问题是**不可行的 (infeasible)**。这提供了一个**[不可行性证书](@entry_id:635369)** [@problem_id:3182187]。

#### [对偶单纯形法](@entry_id:164344)的视角

另一种处理可行性的思路来自于[对偶理论](@entry_id:143133)。标准的单纯形法（也称[原始单纯形法](@entry_id:634231)）维持解的**原始可行性**（所有变量非负），并逐步趋向**对偶可行性**（满足[最优性条件](@entry_id:634091)）。相对地，**[对偶单纯形法](@entry_id:164344) (Dual Simplex Method)** 维持对偶可行性（即所有[检验数](@entry_id:173345)满足[最优性条件](@entry_id:634091)），并逐步趋向原始可行性。

当一个解的[检验数](@entry_id:173345)满足[最优性条件](@entry_id:634091)，但某个基变量为负值（例如 $x_{B_i}  0$）时，该解是原始不可行的。[对偶单纯形法](@entry_id:164344)会选择一个负的基变量作为出基变量，然后通过一个类似比率测试的规则（在出基变量所在行中，寻找负系数的列）来选择进基变量，以恢复原始可行性，同时保持对偶可行性。这种恢复可行性的枢轴逻辑在某些情况下非常有用 [@problem_id:3182183]。

### 最优性、对偶性与证书

单纯形法的每一个机制都与**[对偶理论](@entry_id:143133) (duality theory)** 密切相关。事实上，单纯形法不仅求解了原始问题，也隐式地求解了其[对偶问题](@entry_id:177454)。

对于每个线性规划（**原始问题**），都存在一个与之对应的**[对偶问题](@entry_id:177454)**。[原始问题和对偶问题](@entry_id:151869)的最优目标函数值是相等的，这被称为**强对偶性 (strong duality)**。

单纯形法中的单纯形乘子 $\pi$ 正是与当前基对应的[对偶问题](@entry_id:177454)的解。[原始单纯形法](@entry_id:634231)的[最优性条件](@entry_id:634091)（所有[检验数](@entry_id:173345) $\bar{c}_j \le 0$）实际上等价于对偶问题的可行性条件。当单纯形法终止时，它不仅给出了原始问题的最优解 $x^*$，还给出了对偶问题的最优解 $\pi^*$。

这一对解 ($x^*$, $\pi^*$) 共同构成了一个**[最优性证书](@entry_id:178805) (optimality certificate)**。它们满足以下三个条件：
1.  $x^*$ 是原始可行的。
2.  $\pi^*$ 是对偶可行的。
3.  它们的目标函数值相等：$c^\top x^* = b^\top \pi^*$。

这种相等关系源于**[互补松弛性](@entry_id:141017) (complementary slackness)**。[互补松弛性](@entry_id:141017)描述了原始解和对偶解在最优状态下的内在联系 [@problem_id:3182257]：
- 如果一个原始变量为正 ($x_j^* > 0$)，则其对应的对偶约束必须是紧的（即以等式成立）。
- 如果一个原始约束是松的（即不以等式成立），则其对应的对偶变量必须为零 ($y_i^* = 0$)。

在单纯形法的最后一步，基变量可以为正，其[检验数](@entry_id:173345)（对偶松弛）为零；非基变量为零，其[检验数](@entry_id:173345)（对偶松弛）可以为非零。这正是[互补松弛性](@entry_id:141017)的体现。因此，一个最终的单纯形表不仅宣告了最优性，它通过提供一个原始[可行解](@entry_id:634783)和一个对偶[可行解](@entry_id:634783)，并满足[互补松弛性](@entry_id:141017)，从而严格地证明了这个解是最优的 [@problem_id:3182230]。