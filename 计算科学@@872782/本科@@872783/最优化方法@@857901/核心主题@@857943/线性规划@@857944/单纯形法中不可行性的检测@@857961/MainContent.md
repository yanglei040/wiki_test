## 引言
在线性规划的实践中，我们时常会遇到一个棘手的问题：模型“无解”。这种情况被称为[不可行性](@entry_id:164663)，它通常意味着模型中的约束条件相互冲突，不存在任何一个解能同时满足所有要求。这种矛盾可能源于错误的业务逻辑、不切实际的[资源限制](@entry_id:192963)或简单的数据录入失误。然而，仅仅知道问题无解是远远不够的；为了修正模型或深入理解系统局限，我们必须能够系统性地诊断出导致[不可行性](@entry_id:164663)的根源。

本文旨在深入剖析单纯形法——特别是其强大的[两阶段法](@entry_id:166636)——是如何不仅检测出[不可行性](@entry_id:164663)，更能提供一个清晰的数学“诊断报告”，即[不可行性证书](@entry_id:635369)。通过本文的学习，您将掌握识别和证明线性规划问题[不可行性](@entry_id:164663)的核心技术。

在接下来的章节中，我们将首先深入探讨[不可行性](@entry_id:164663)背后的数学原理以及单纯形法的检测机制（**原理与机制**）。接着，我们将通过丰富的实例展示这些理论在[运筹学](@entry_id:145535)、经济学和工程学等领域的实际应用价值（**应用与跨学科联系**）。最后，我们将通过一系列精心设计的练习，引导您亲手实践这些概念（**动手实践**），从而将理论知识转化为解决实际问题的能力。

## 原理与机制

在线性规划领域，一个模型的可行性是其最基本的属性。一个线性规划问题如果不存在任何满足其所有约束条件的解，则被称为**不可行（infeasible）**。在实际应用中，[不可行性](@entry_id:164663)往往源于模型构建时的错误，例如相互矛盾的业务规则、不切实际的[资源限制](@entry_id:192963)或是数据录入错误。因此，仅仅得到“无解”的结论是不够的；我们还需要一种系统性的方法来诊断[不可行性](@entry_id:164663)的来源。单纯形法，特别是其**[两阶段法](@entry_id:166636)（Two-Phase Method）**，不仅能可靠地检测[不可行性](@entry_id:164663)，还能提供一个明确的数学证明——即**[不可行性证书](@entry_id:635369)（infeasibility certificate）**。本章将深入探讨[不可行性](@entry_id:164663)背后的原理以及单纯形法检测[不可行性](@entry_id:164663)的具体机制。

### 何为[不可行性](@entry_id:164663)？

从根本上说，[不可行性](@entry_id:164663)意味着约束集合定义了一个**空[可行域](@entry_id:136622)（empty feasible region）**。几何上，这意味着代表每个约束的[半空间](@entry_id:634770)（或[超平面](@entry_id:268044)）没有共同的交集。

考虑一个简单的二维例子：一个变量 $x_1$ 需要同时满足 $x_1 \ge 1$ 和 $x_1 \le 0$。在数轴上，这两个区域没有任何重叠，因此不存在满足条件的 $x_1$。这个系统是不可行的 [@problem_id:3118219]。

另一个更直观的例子是两个相互矛盾的并行约束。假设我们需要找到非负变量 $x_1, x_2$ 使得它们同时满足：
1. $x_1 + x_2 \le 1$
2. $x_1 + x_2 \ge 3$

在二维平面上，第一个约束定义了直线 $x_1 + x_2 = 1$ 及其下方的区域，而第二个约束定义了直线 $x_1 + x_2 = 3$ 及其上方的区域。这两条线是平行的，它们所定义的区域没有任何公共部分。因此，这个问题的[可行域](@entry_id:136622)是空的，问题是不可行的 [@problem_id:3118100]。

虽然这些简单的例子可以通过直觉或代数推导轻易识别，但在包含成百上千个变量和约束的复杂问题中，这种方法变得不现实。我们需要一种算法化的、通用的检测机制。

### [不可行性](@entry_id:164663)检测：[两阶段单纯形法](@entry_id:176724)

单纯形法的基本运行机制是从一个**基本[可行解](@entry_id:634783)（Basic Feasible Solution, BFS）**出发，通过迭代移动到更优的相邻基本[可行解](@entry_id:634783)。但如果一个问题是不可行的，我们甚至无法找到第一个出发点。为了解决这个问题，我们引入了[两阶段法](@entry_id:166636)。

#### 辅助问题（第一阶段）

[两阶段法](@entry_id:166636)的核心思想是构造并求解一个**辅助[线性规划](@entry_id:138188)问题（auxiliary linear program）**，即**第一阶段（Phase I）**。这个辅助问题的设计目标有两个：
1. 它总是有一个显而易见的初始基本可行解。
2. 它的最优解能明确地告诉我们原始问题是否可行。

为了实现这一目标，我们为那些没有现成基本变量的约束（通常是“$\ge$”或“$=$”约束）引入**[人工变量](@entry_id:164298)（artificial variables）**，记为 $a_i \ge 0$。这些[人工变量](@entry_id:164298)在代数上“填补”了约束，使得我们可以轻松构造一个初始基。例如，约束 $x_1 - s_2 = 1$（其中 $s_2$ 是剩余变量）在 $x_1=0, s_2=0$ 时不满足。通过引入[人工变量](@entry_id:164298) $a_1$，我们将其改造为 $x_1 - s_2 + a_1 = 1$。现在，我们可以让 $a_1=1$ 作为初始基本变量。

[人工变量](@entry_id:164298)可以被视为对原始约束的一种“违反度量”。如果一个约束被满足，相应的[人工变量](@entry_id:164298)就可以为零。因此，第一阶段的目标就是最小化所有[人工变量](@entry_id:164298)之和。令 $w$ 为[人工变量](@entry_id:164298)的总和，即 $w = \sum a_i$。第一阶段的[优化问题](@entry_id:266749)是：
$$ \min w $$
这个辅助问题的解与原始问题的可行性之间存在一个基本联系：

*   如果第一阶段的最优值 $w_{\min} = 0$，这意味着所有[人工变量](@entry_id:164298)都可以被同时设为零。此时，我们找到了一个满足所有原始约束的解，即原始问题是**可行**的。该解可以作为第二阶段（优化原始目标函数）的起始基本[可行解](@entry_id:634783)。
*   如果第一阶段的最优值 $w_{\min} > 0$，这意味着无论如何调整原始变量，[人工变量](@entry_id:164298)的总和都无法降至零。这表明至少有一个[人工变量](@entry_id:164298)必须为正，从而至少有一个原始约束无法被满足。因此，原始问题是**不可行**的。

#### 第一阶段全流程演示

我们通过一个具体的例子来演示第一阶段如何检测[不可行性](@entry_id:164663) [@problem_id:3118219]。考虑以下[约束系统](@entry_id:164587)：
$$
\begin{aligned}
x_1 \le 0 \\
x_1 \ge 1 \\
x_1 \ge 0
\end{aligned}
$$
首先，我们引入一个**[松弛变量](@entry_id:268374)（slack variable）** $s_1 \ge 0$ 和一个**剩余变量（surplus variable）** $s_2 \ge 0$，将不等式转换为标准等式形式：
$$
\begin{aligned}
x_1 + s_1 = 0 \\
x_1 - s_2 = 1
\end{aligned}
$$
这个系统没有明显的初始基。因此，我们为每个等式引入[人工变量](@entry_id:164298) $a_1, a_2 \ge 0$，并构建第一阶段问题：
$$ \min w = a_1 + a_2 $$
约束条件为：
$$
\begin{aligned}
x_1 + s_1 + a_1 = 0 \\
x_1 - s_2 + a_2 = 1 \\
x_1, s_1, s_2, a_1, a_2 \ge 0
\end{aligned}
$$
由于右侧项（RHS）必须为非负，我们注意到第一个约束 $x_1+s_1=0$ 和非负性 $x_1 \ge 0, s_1 \ge 0$ 强制要求 $x_1=0, s_1=0$。然而，为了机械地应用算法，我们假设初始基由[人工变量](@entry_id:164298)构成，即 $\{a_1, a_2\}$。初始解为 $x_1=0, s_1=0, s_2=0$，此时 $a_1=0, a_2=1$。

我们构建第一阶段的单纯形表。[目标函数](@entry_id:267263)是 $w = a_1 + a_2$，或者 $w - a_1 - a_2 = 0$。
初始单纯形表如下：
$$
\begin{array}{c|c|cccccc|c}
\text{BV}  w  x_1  s_1  s_2  a_1  a_2  \text{RHS} \\
\hline
w  1  0  0  0  -1  -1  0 \\
a_1  0  1  1  0  1  0  0 \\
a_2  0  1  0  -1  0  1  1
\end{array}
$$
为了开始迭代，我们需要将目标行（$w$ 行）中基本变量 $a_1, a_2$ 的系数（即**[检验数](@entry_id:173345)**或**判别数**，reduced costs）变为0。这通过将包含 $a_1, a_2$ 的行加到目标行上来实现（$R_0' = R_0 + R_1 + R_2$）：
$$
\begin{array}{c|c|cccccc|c}
\text{BV}  w  x_1  s_1  s_2  a_1  a_2  \text{RHS} \\
\hline
w  1  2  1  -1  0  0  1 \\
a_1  0  1  1  0  1  0  0 \\
a_2  0  1  0  -1  0  1  1
\end{array}
$$
此时，目标函数值为 $w=1$。目标行中 $x_1$ 的[检验数](@entry_id:173345)最大（为 $2$），因此选择 $x_1$ 为进基变量。根据最小比率测试，$a_1$ 所在行的比率为 $0/1=0$，$a_2$ 所在行的比率为 $1/1=1$。最小非负比率为 $0$，因此 $a_1$ 为出基变量。

我们执行一次主元变换（pivot），得到更新后的单纯形表：
$$
\begin{array}{c|c|cccccc|c}
\text{BV}  w  x_1  s_1  s_2  a_1  a_2  \text{RHS} \\
\hline
w  1  0  -1  -1  -2  0  1 \\
x_1  0  1  1  0  1  0  0 \\
a_2  0  0  -1  -1  -1  1  1
\end{array}
$$
#### 解读最终单纯形表

在经过一次迭代后，我们观察新的目标行。所有非基本变量（$s_1, s_2, a_1$）的[检验数](@entry_id:173345)都已非正（$-1, -1, -2$）。对于一个最小化问题，这标志着算法已经达到最优解。

此时，第一阶段的最优目标值为 $w_{\min}=1$。

根据[两阶段法](@entry_id:166636)的基本原理，因为 $w_{\min} > 0$，我们断定原始问题是不可行的。这个正值表示，即使在最优情况下，[人工变量](@entry_id:164298)（在此例中是 $a_2=1$）也无法被从基中移除或降为零，这意味着原始约束之间存在不可调和的矛盾。

### [不可行性证书](@entry_id:635369)

算法给出的“不可行”结论是可靠的，但它本身并不是一个独立的、易于验证的证明。一个**[不可行性证书](@entry_id:635369)（infeasibility certificate）**是一个简洁的数学对象，任何人都可以用它来独立地验证一个系统确实是不可行的。

#### 从矛盾到证书

最基本的[不可行性证书](@entry_id:635369)，是原始约束的一个非负[线性组合](@entry_id:154743)，该组合会产生一个明显的矛盾，如 $0 \le -1$。

考虑一个由不等式 $Ax \le b$ 定义的系统。一个[不可行性证书](@entry_id:635369)是一个向量 $y \ge 0$，使得 $y^{\top}A = 0$ 且 $y^{\top}b  0$。如果我们用 $y^{\top}$ 左乘约束 $Ax \le b$，会得到 $y^{\top}Ax \le y^{\top}b$。代入证书的属性，这就变成了 $0^{\top}x \le (\text{一个负数})$，即 $0 \le (\text{一个负数})$，这是一个清晰的矛盾。

例如，对于系统 [@problem_id:3118212]：
$$
\begin{aligned}
x_1 \le 0 \\
x_2 \le 0 \\
-x_1 - x_2 \le -1
\end{aligned}
$$
我们可以将这三个不等式简单相加（相当于使用乘子向量 $y = \begin{pmatrix} 1  1  1 \end{pmatrix}^{\top}$）。
$$ (x_1) + (x_2) + (-x_1 - x_2) \le (0) + (0) + (-1) $$
这简化为 $0 \le -1$。这个矛盾证明了原系统是不可行的。这里的向量 $y = \begin{pmatrix} 1  1  1 \end{pmatrix}^{\top}$ 就是一个[不可行性证书](@entry_id:635369)。

#### [法卡斯引理](@entry_id:146719)与对偶性

这种证书的存在性由一个深刻的数学定理——**[法卡斯引理](@entry_id:146719)（Farkas' Lemma）**——来保证。[法卡斯引理](@entry_id:146719)有多种形式，其核心思想是关于某个线性系统的解的存在性与其对偶系统解的存在性之间的“择一”关系。对于标准形式的LP可行性问题“是否存在 $x \ge 0$ 使得 $Ax=b$”，[法卡斯引理](@entry_id:146719)的一个版本是 [@problem_id:3118176] [@problem_id:3118135]：

**二择一**：下面两个系统中，有且仅有一个有解。
(i) 存在 $x \ge 0$ 使得 $Ax = b$。
(ii) 存在 $y$ 使得 $A^{\top}y \ge 0$ 且 $b^{\top}y  0$。

系统 (i) 是我们原始的** primal 可行性问题**。系统 (ii) 定义了**对偶证书**，即一个法卡斯证书 $y$。当 primal 问题不可行时，对偶证书必然存在。这个证书 $y$ 提供了构造矛盾的“配方”。

#### 从单纯形表中提取证书

最巧妙之处在于，我们无需单独去寻找这个证书 $y$。当第一阶段单纯形法以 $w_{\min}>0$ 结束时，其最终的单纯形表已经包含了这个证书。

理论根源在于[对偶理论](@entry_id:143133)。第一阶段问题 $\min\{\mathbf{1}^{\top} a \mid Ax + a = b, x, a \ge 0\}$ 的对偶问题是 $\max\{y^{\top}b \mid A^{\top}y \le 0, y \le \mathbf{1}\}$。当第一阶段[算法终止](@entry_id:143996)时，我们得到了一个 primal 最优解 $(x^*, a^*)$ 和一个 dual 最优解 $y^*$（即单纯形乘子）。强对偶性告诉我们，它们的目标值相等：
$$ w_{\min} = \mathbf{1}^{\top}a^* = (y^*)^{\top}b $$
如果原始问题不可行，则 $w_{\min} > 0$，这意味着我们找到了一个满足 $A^{\top}y^* \le 0$ 和 $(y^*)^{\top}b > 0$ 的向量 $y^*$。

这个 $y^*$ 就是一个**[不可行性](@entry_id:164663)的对偶方向**。令 $\hat{y} = -y^*$，则有 $A^{\top}\hat{y} = -A^{\top}y^* \ge 0$ 且 $b^{\top}\hat{y} = -(y^*)^{\top}b  0$。这个 $\hat{y}$ 正是[法卡斯引理](@entry_id:146719)所保证的证书！

在第一阶段的最优单纯形表中，这个向量 $y^*$ 正是对应于原始约束的**单纯形乘子（simplex multipliers）**。我们可以通过[检验数](@entry_id:173345)公式来读取它。对于[人工变量](@entry_id:164298) $a_i$，其[检验数](@entry_id:173345) $\bar{c}_{a_i}$ 等于 $c_{a_i} - (y^*)^{\top}e_i = 1 - y_i^*$，其中 $e_i$是第 $i$ 个单位向量。因此，
$$ y_i^* = 1 - \bar{c}_{a_i} $$
例如，在问题 [@problem_id:3118099] 的最终单纯形表中，[人工变量](@entry_id:164298) $a_1, a_2$ 的[检验数](@entry_id:173345)分别是 $2$ 和 $0$。由此可得：
$y_1^* = 1 - 2 = -1$
$y_2^* = 1 - 0 = 1$
于是，单纯形乘子为 $y^* = \begin{pmatrix} -1  1 \end{pmatrix}^{\top}$。我们可以验证它是一个有效的对偶方向：
$$ A^{\top}y^* = \begin{pmatrix} 1  1 \\ 1  1 \end{pmatrix}^{\top} \begin{pmatrix} -1 \\ 1 \end{pmatrix} = \begin{pmatrix} 0 \\ 0 \end{pmatrix} \le 0 $$
$$ (y^*)^{\top}b = \begin{pmatrix} -1  1 \end{pmatrix} \begin{pmatrix} 1 \\ 3 \end{pmatrix} = -1 + 3 = 2 > 0 $$
这个值 $2$ 正是第一阶段的最优目标值 $w_{\min}$。这个 $y^*$ 证明了原始问题 $Ax=b, x\ge 0$ 不可行。

### 进阶主题与实践考量

#### 预处理技术

在调用昂贵的单纯形法之前，现代求解器通常会执行一个**预处理（presolve）**阶段，以简化模型并检测明显的[不可行性](@entry_id:164663)。一种简单的预处理技术是基于变量的边界进行“行活动范围检查” [@problem_id:3118151]。

例如，对于LP-[A模型](@entry_id:158323)：
$$
\begin{aligned}
x + y \ge 5 \\
0 \le x \le 1 \\
0 \le y \le 2
\end{aligned}
$$
预处理器会计算 $x+y$ 这个表达式可能的最大值。基于变量的上下界，$\max(x+y) = \max(x) + \max(y) = 1 + 2 = 3$。由于约束要求 $x+y \ge 5$，而它的最大可[能值](@entry_id:187992)仅为 $3$，这构成了一个直接的矛盾。因此，[预处理](@entry_id:141204)阶段就可以宣告问题不可行，无需启动单纯形法。

然而，预处理并非万能。对于 LP-B 模型（$x+y=1, x+y=3$），简单的[边界检查](@entry_id:746954)（仅有 $x \ge 0, y \ge 0$）无法检测到矛盾，因为 $x+y$ 的活动范围是 $[0, \infty)$，它同时覆盖了 $1$ 和 $3$。这种涉及多个约束之间逻辑冲突的[不可行性](@entry_id:164663)，通常需要依赖第一阶段单纯形法来发现。

#### 备选检测方法：[对偶单纯形法](@entry_id:164344)

除了[两阶段法](@entry_id:166636)，**[对偶单纯形法](@entry_id:164344)（Dual Simplex Method）**也提供了一种检测[不可行性](@entry_id:164663)的途径，尤其是在已经有一个对偶[可行解](@entry_id:634783)的情况下（例如，在添加新约束后）。[对偶单纯形法](@entry_id:164344)维持对偶可行性（所有[检验数](@entry_id:173345)满足[最优性条件](@entry_id:634091)），并逐步恢复 primal 可行性（所有基本变量非负）。

算法的**[不可行性](@entry_id:164663)检测规则**如下 [@problem_id:3118101]：
当算法选择一个基变量 $x_{B,i}  0$ 作为出基变量时，它需要在该行（枢轴行）中寻找一个负的系数 $a_{ij}  0$ 来确定进基变量 $x_j$。如果枢轴行中所有非基本变量的系数 $a_{ij}$ 都是非负的（$a_{ij} \ge 0$），那么[算法终止](@entry_id:143996)，并宣告 primal 问题不可行。

其原因在于枢轴行所代表的方程：
$$ x_{B,i} + \sum_{j \in \text{non-basic}} a_{ij}x_j = \bar{b}_i $$
其中 $\bar{b}_i$ 是 $x_{B,i}$ 当前的负值。为了使 $x_{B,i}$ 增加并变得非负，我们需要通过一个 $x_j > 0$ 来影响它。如果所有的 $a_{ij}$ 都 $\ge 0$，并且所有的 $x_j$ 都 $\ge 0$，那么 $\sum a_{ij}x_j$ 这一项也必然 $\ge 0$。这意味着 $x_{B,i} = \bar{b}_i - \sum a_{ij}x_j \le \bar{b}_i  0$。因此，$x_{B,i}$ 永远无法变为非负，该约束无法被满足。

#### 退化性与非唯一证书

在更复杂的情况下，第一阶段问题本身可能存在**退化（degeneracy）**（即某个基本[可行解](@entry_id:634783)中存在值为零的基本变量）或多个最优解。这些情况会影响[不可行性证书](@entry_id:635369)的特性 [@problem_id:3118190]。

*   **最优解中的零值[人工变量](@entry_id:164298)**：即使第一阶段最优值 $w_{\min}>0$，某些[人工变量](@entry_id:164298)在最优解中也可能为零。关键在于，*至少有一个*[人工变量](@entry_id:164298)的值为正。
*   **证书的非唯一性**：如果第一阶段问题的对偶问题有多个最优解，那么原始问题的[不可行性证书](@entry_id:635369)就不是唯一的（甚至在不考虑正标量乘法的情况下）。例如，在问题 [@problem_id:3118190] 中，[约束系统](@entry_id:164587) $x_1+x_2=1, x_1+x_2=2$ 导致了第一阶段对偶问题最优[解集](@entry_id:154326)是一个线段。这导致可以构造出多个[线性无关](@entry_id:148207)的法卡斯证书，如 $y^{(1)} = (1, -1, 0)^{\top}$ 和 $y^{(2)} = (0, -1, 1)^{\top}$（在使用适当的对偶形式后）。这在实践中意味着，不同的单纯形法路径或不同的求解器可能返回不同的[不可行性](@entry_id:164663)证明。

总之，单纯形法不仅是一个优化工具，更是一个强大的逻辑推理引擎。通过第一阶段的构造，它将一个关于可行性的逻辑问题转化为了一个可以机械求解的[数值优化](@entry_id:138060)问题，并最终从其数值解中提炼出简洁而深刻的、可被验证的逻辑证明。