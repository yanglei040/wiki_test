## 引言
在[线性规划](@entry_id:138188)这一强大的优化工具中，我们面临的现实世界问题往往以各种形式出现：最大化或最小化目标，伴随着“小于等于”、“大于等于”和“等于”等混合约束。这种多样性给开发通用求解算法带来了巨大挑战。为了系统性地解决这一问题，优化理论引入了一个核心概念——**规范型（Canonical Form）**，它是一种[标准化](@entry_id:637219)的数学结构，是启动诸如单纯形法等强大算法的必要前提。

本文旨在全面解析线性规划的规范型。在“原则与机制”一章中，我们将深入探讨规范型的定义，并系统性地学习如何通过引入松弛、剩余和[人工变量](@entry_id:164298)，将任意线性规划问题转化为这一[标准形式](@entry_id:153058)。接着，在“应用与跨学科联结”一章，我们将超越纯粹的数学转换，探索这些辅助变量在工程、经济和网络科学等领域的实际物理意义，揭示规范型作为一种通用建模语言的强大功能。最后，“动手实践”部分将提供精选练习，让你亲手操作转化过程，巩固所学知识。

通过学习本文，你将不仅掌握一项关键的技术操作，更能深刻理解[优化建模](@entry_id:170993)的内在逻辑，为解决复杂的现实世界决策问题奠定坚实的基础。让我们首先从规范型的基本原则与转换机制开始。

## 原则与机制

在[线性规划](@entry_id:138188)领域，将一个多样化形式的问题转化为一个统一的、[标准化](@entry_id:637219)的结构，是采用诸如单纯形法等通用算法求解的关键第一步。这个[标准化](@entry_id:637219)的结构被称为**规范型（Canonical Form）**。本章将深入探讨线性规划规范型的基本原则，并详细阐述将任意线性规划问题转化为规范型的系统性机制。

### [线性规划](@entry_id:138188)的规范型

一个[线性规划](@entry_id:138188)问题的**规范型**通常指满足以下三个核心条件的表达形式：

1.  **约束类型**：所有的约束都必须是等式（equality constraints）。
2.  **变量非负性**：所有的决策变量都必须是非负的（non-negative variables）。
3.  **右侧非负性**：所有约束等式右侧的常数项（Right-Hand Side, RHS）都必须是非负的。

用矩阵表示，一个处于规范型的[线性规划](@entry_id:138188)问题可以写为：
$$ \text{maximize (or minimize) } z = c^T x $$
$$ \text{subject to } Ax = b $$
$$ x \ge 0, \quad b \ge 0 $$
其中，$x$ 是决策变量的列向量，$c$ 是目标函数系数向量，$A$ 是约束系数矩阵，$b$ 是右侧常数项向量。

这种统一的格式消除了 `≤`、`≥` 和 `=` 约束之间的差异，并确保了所有变量都定义在非负域内。这为算法的实施提供了一个清晰、一致的起点。

### 转换为规范型的标准流程

将一个形式各异的线性规划问题转化为规范型，通常遵循一个系统性的流程。我们将通过一个具体的例子来分解这个流程的每一步。考虑如下的线性规划问题 [@problem_id:3106053]：
- 目标：最大化 $z = 2 x_1 - x_2 + 3 x_3$。
- 约束：
  - $(1)$ $3 x_1 - x_2 + x_3 \le 7$
  - $(2)$ $-2 x_1 + 4 x_2 \ge 6$
  - $(3)$ $x_1 - x_3 = -2$
- 变量界限：$x_1 \ge 0$, $x_2$ 是自由变量, $x_3 \ge 0$。

#### 步骤一：处理自由变量

规范型要求所有变量非负。然而，现实世界的问题常常包含**自由变量（free variables）**，即没有符号限制的变量。对于这类变量，标准处理方法是将其替换为两个非负变量的差。

对于任意自由变量 $x_j$，我们可以引入两个新的非负变量 $x_j^+$ 和 $x_j^-$，并令：
$$ x_j = x_j^+ - x_j^- \quad \text{where } x_j^+ \ge 0, x_j^- \ge 0 $$
这个替换必须在[目标函数](@entry_id:267263)和所有约束中进行。在上述例子中，$x_2$ 是[自由变量](@entry_id:151663)，我们将其替换为 $x_2^+ - x_2^-$。目标函数变为：
$$ z = 2 x_1 - (x_2^+ - x_2^-) + 3 x_3 = 2 x_1 - x_2^+ + x_2^- + 3 x_3 $$
约束(1)和(2)也相应地更新。如果一个问题的所有变量都是[自由变量](@entry_id:151663)，则需要对每一个变量都执行此操作 [@problem_id:3106042]。

#### 步骤二：确保右侧非负

规范型要求所有约束的右侧常数项 $b_i$ 均为非负。如果某个约束的右侧是负数，我们需要通过将整个约束乘以 $-1$ 来纠正它。这个操作会改变不等号的方向（`≤` 变为 `≥`，`≥` 变为 `≤`），但不会改变等式的性质。

在我们的例子中，约束(3) $x_1 - x_3 = -2$ 的右侧是负数。我们将其两边乘以 $-1$，得到：
$$ -x_1 + x_3 = 2 $$
对于[不等式约束](@entry_id:176084)，例如一个假设的约束 $x_1 - 2x_2 \ge -3$，乘以 $-1$ 会得到 $-x_1 + 2x_2 \le 3$。这个预处理步骤至关重要，因为它直接影响后续变量的引入 [@problem_id:3106049]。

#### 步骤三：将不等式转换为等式

为了满足所有约束均为等式的要求，我们引入两种辅助变量：

-   **[松弛变量](@entry_id:268374) (Slack Variables)**：对于 `≤` 型约束，我们在其左侧添加一个非负的**[松弛变量](@entry_id:268374)**，以弥补左侧与右侧之间的“松弛”或“差距”。例如，约束(1) $3 x_1 - x_2^+ + x_2^- + x_3 \le 7$ 变为：
    $$ 3 x_1 - x_2^+ + x_2^- + x_3 + s_1 = 7, \quad s_1 \ge 0 $$

-   **剩余变量 (Surplus Variables)**：对于 `≥` 型约束，我们从其左侧减去一个非负的**剩余变量**，以表示左侧超出右侧的“剩余”部分。例如，约束(2) $-2 x_1 + 4 x_2^+ - 4 x_2^- \ge 6$ 变为：
    $$ -2 x_1 + 4 x_2^+ - 4 x_2^- - s_2 = 6, \quad s_2 \ge 0 $$

完成这些步骤后，原始的混合[约束系统](@entry_id:164587)就完全转化为了一个等式系统，且所有变量（原始变量、新引入的差值变量、[松弛变量和剩余变量](@entry_id:634657)）都满足非负性要求。

### 构建初始可行基：[人工变量](@entry_id:164298)的角色

单纯形法不仅需要规范型，还需要一个**初始基本可行解 (initial basic feasible solution, BFS)** 作为算法的起点。在代数上，这意味着在约束矩阵 $A$ 中存在一个单位矩阵 $I$ 作为子矩阵，其对应的变量称为**基变量 (basic variables)**。初始解即为：令所有非基变量为0，基变量的值等于 $b$ 向量中对应的分量。由于规范型要求 $b \ge 0$，这个初始解自动满足非负性，因此是“可行的”。

#### 何时需要[人工变量](@entry_id:164298)

在将问题转化为等式系统后，我们检查是否能立即找到一个[单位矩阵](@entry_id:156724)：

-   对于 `≤` 型约束，引入的[松弛变量](@entry_id:268374) $s_i$ 在其所在行的系数为 $+1$，在其他行均为 $0$。因此，[松弛变量](@entry_id:268374)天然地构成了单位矩阵的一列，可以作为初始基变量。

-   对于 `≥` 型约束，减去的剩余变量 $s_i$ 的系数为 $-1$，其对应的列向量不是[单位向量](@entry_id:165907)（例如 $[0, -1, 0]^T$）。它不能直接作为初始基变量。

-   对于 `=` 型约束，通常不存在一个变量在该行系数为 $+1$ 且在其他行系数为 $0$。

当某个约束行缺少一个可以充当初始基变量的变量时，我们就需要引入一个**[人工变量](@entry_id:164298) (artificial variable)** $a_i \ge 0$。该变量只在该行以 $+1$ 的系数加入，从而“人为地”构建出一个单位列。

在我们的主示例中 [@problem_id:3106053]，[松弛变量](@entry_id:268374) $s_1$ 为第一行提供了基变量。然而，第二行（源于 `≥` 约束）和第三行（源于 `=` 约束）都缺少基变量。因此，我们必须为这两行引入[人工变量](@entry_id:164298) $a_2$ 和 $a_3$：
$$ -2 x_1 + 4 x_2^+ - 4 x_2^- - s_2 + a_2 = 6 $$
$$ -x_1 + x_3 + a_3 = 2 $$
此时，基变量集合为 $\{s_1, a_2, a_3\}$，它们对应的列构成了 $3 \times 3$ 的[单位矩阵](@entry_id:156724)。初始基本[可行解](@entry_id:634783)为 $s_1=7, a_2=6, a_3=2$，所有其他变量为 $0$。

#### 特殊情况：避免[人工变量](@entry_id:164298)

在某些情况下，[人工变量](@entry_id:164298)并非必需。一个重要的特殊情况是，如果一个[线性规划](@entry_id:138188)问题的所有约束最初都是 `≤` 类型（或可以被转化为 `≤` 类型），并且右侧常数项均为非负，那么我们可以通过简单地检查原点是否可行来判断。例如，考虑问题 [@problem_id:3106028]：
$$ \text{minimize } -x_1 + 4x_2 $$
$$ \text{s.t. } 2x_1 + x_2 \le 7, \quad -3x_1 + 2x_2 \ge -5, \quad x_1, x_2 \ge 0 $$
首先检查原点 $(x_1=0, x_2=0)$ 是否可行：$0 \le 7$（满足），$0 \ge -5$（满足）。由于原点可行，我们可以预見一个简单的初始BFS。通过将第二个约束乘以 $-1$ 转化为 $3x_1 - 2x_2 \le 5$，整个问题只有 `≤` 约束。引入[松弛变量](@entry_id:268374)后，系统为：
$$ 2x_1 + x_2 + s_1 = 7 $$
$$ 3x_1 - 2x_2 + s_2 = 5 $$
[松弛变量](@entry_id:268374) $\{s_1, s_2\}$ 形成了一个完美的初始基，对应的初始BFS为 $s_1=7, s_2=5, x_1=0, x_2=0$。这样便无需引入[人工变量](@entry_id:164298)和复杂的[两阶段法](@entry_id:166636)。

#### [两阶段法](@entry_id:166636)与[不可行性](@entry_id:164663)检测

当必须引入[人工变量](@entry_id:164298)时，我们采用**[两阶段法](@entry_id:166636) (Two-Phase Method)**。**第一阶段**的目标是找到一个原始问题的基本[可行解](@entry_id:634783)。其策略是构造一个新的目标函数：最小化所有[人工变量](@entry_id:164298)之和。
$$ \text{minimize } W = \sum a_i $$
然后用单纯形法求解这个新的（第一阶段）L[P问题](@entry_id:267898)。其结果有两种可能：
1.  如果最小化的 $W$ 值为 $0$，这意味着所有[人工变量](@entry_id:164298)都可以在基中被替换出去（或取值为0），我们便找到了原问题的一个BFS。此时，可以抛弃[人工变量](@entry_id:164298)，进入**第二阶段**，恢复原始的[目标函数](@entry_id:267263)继续求解。
2.  如果最小化的 $W$ 值严格为正 ($W_{min} \gt 0$)，这意味着至少有一个[人工变量](@entry_id:164298)无法从基中消除且值非零。这表明原始问题的约束是矛盾的，即**原问题无解（infeasible）**。

例如，对于一个包含矛盾约束 $x_1 - x_2 = 3$ 和 $2x_1 - 2x_2 = 8$ 的问题，后者可简化为 $x_1 - x_2 = 4$。显然，没有任何 $(x_1, x_2)$ 能同时满足这两个条件。[两阶段法](@entry_id:166636)会通过计算得出第一阶段的最小目标值为 $W_{min}=2 \gt 0$，从而在算法上证明该问题的[不可行性](@entry_id:164663) [@problem_id:3106102]。

### 典式 (字典) 的代数与几何解释

一旦我们有了一个基本可行解（无论是通过[松弛变量](@entry_id:268374)直接得到，还是通过第一阶段法找到），我们就可以将线性规划问题表示为**典式 (dictionary form)**。典式是规范型的一种特定代数表达，它明确地将基变量和[目标函数](@entry_id:267263)表示为非基变量的函数。

#### 从规范型到典式

给定一个基 $B$（对应基变量 $x_B$），我们将约束矩阵 $A$ 和变量向量 $x$ 相应地划分为基和非基部分：$A = [A_B, A_N]$ 和 $x = (x_B, x_N)$。[约束方程](@entry_id:138140) $Ax=b$ 可以写成：
$$ A_B x_B + A_N x_N = b $$
由于基矩阵 $A_B$ 是可逆的，我们可以解出 $x_B$：
$$ x_B = A_B^{-1}b - A_B^{-1}A_N x_N $$
同样，[目标函数](@entry_id:267263) $z = c_B^T x_B + c_N^T x_N$ 可以被重写为：
$$ z = c_B^T(A_B^{-1}b - A_B^{-1}A_N x_N) + c_N^T x_N = c_B^T A_B^{-1}b + (c_N^T - c_B^T A_B^{-1}A_N)x_N $$
这两组方程就是典式。它们表达了在当前基下的基本解 ($x_N=0 \Rightarrow x_B = A_B^{-1}b$) 以及如果非基变量从0增加时，基变量和[目标函数](@entry_id:267263)将如何变化。通过[高斯-若尔当消元法](@entry_id:150406)进行一系列行操作，也可以得到相同的典式 [@problem_id:3106136] [@problem_id:3106054]。

#### 典式的代数含义：[敏感性分析](@entry_id:147555)

典式 $x_B = \bar{b} - \bar{A}_N x_N$（其中 $\bar{b} = A_B^{-1}b$ 且 $\bar{A}_N = A_B^{-1}A_N$）的代数含义极为深刻。矩阵 $\bar{A}_N$ 的每个元素 $(\bar{A}_N)_{ij}$ 揭示了基变量对非基变量变化的敏感性。具体来说，它表示为了维持[等式约束](@entry_id:175290) $Ax=b$，当第 $j$ 个非基变量 $x_{N_j}$ 增加一个单位时，第 $i$ 个基变量 $x_{B_i}$ 必须改变的数量。注意方程中的负号，这意味着：
$$ \Delta x_{B_i} = -(\bar{A}_N)_{ij} \Delta x_{N_j} $$
例如，在一个问题中，如果我们推导出典式中的一行是 $x_1 = \frac{4}{3} + \frac{1}{3}s_1 - \frac{2}{3}s_2$，这告诉我们：
-   如果 $s_1$ 增加 1 个单位（而 $s_2$ 保持为0），$x_1$ 将增加 $\frac{1}{3}$ 个单位。
-   如果 $s_2$ 增加 1 个单位（而 $s_1$ 保持为0），$x_1$ 将减少 $\frac{2}{3}$ 个单位。
这种关系是单纯形法中进行 pivoting（基变换）和 ratio test（比例检验）的代数基础 [@problem_id:3106044]。

#### 典式的几何含义

从几何角度看，约束 $Ax=b$ 在高维空间中定义了一个**仿射[子空间](@entry_id:150286)（affine subspace）**，而可行域是这个[子空间](@entry_id:150286)与非负象限 $x \ge 0$ 相交形成的一个**[凸多面体](@entry_id:170947)（convex polyhedron）**。

典式 $x_B = A_B^{-1}b - A_B^{-1}A_N x_N$ 的作用是为这个仿射[子空间](@entry_id:150286)提供一个参数化表示。非基变量 $x_N$ 充当了自由参数，一旦它们的值被确定，基变量 $x_B$ 的值也随之确定。基本[可行解](@entry_id:634783)（$x_N=0$）对应于这个[多面体](@entry_id:637910)的一个**顶点（vertex）**。典式描述了从一个顶点出发，沿着多面体的边（通过增加一个非基变量）移动时，点的坐标如何变化 [@problem_id:3106054]。

### 规范型、可行性与最优性

典式是连接问题表述与单纯形法算法逻辑的桥梁。对于一个给定的基 $B$ 及其对应的典式，我们可以立即判断当前解的状态：

-   **原始可行性 (Primal Feasibility)**：当前[基本解](@entry_id:184782)是否可行，取决于 $x_B$ 的值是否全部非负。即检查条件 $x_B = A_B^{-1}b \ge 0$ 是否成立。

-   **对偶可行性 (Dual Feasibility) 或 [最优性条件](@entry_id:634091) (Optimality Condition)**：对于一个最大化问题，当前基本可行解是否最优，取决于目标函数 $z = z_0 + \bar{c}_N^T x_N$ 中非基变量的系数，即**既约成本 (reduced costs)** $\bar{c}_N$。如果所有的既约成本都非正（$\bar{c}_j \le 0$ for all $j \in N$），则意味着增加任何非基变量都无法使目标函数值增加。此时，当前解即为最优解。反之，如果存在一个正的既约成本 $\bar{c}_j \gt 0$，那么增加对应的非基变量 $x_j$ 将能提高[目标函数](@entry_id:267263)值，当前解非最优。

在一个具体问题中，选择基 $\{x_1, x_3\}$ 后，我们可能计算出基本解 $x_B = [3/2, 5/2]^T$，满足原始可行性。同时，计算出既约成本向量 $\bar{c}_N = [1/2, -3/2]^T$。由于 $\bar{c}_2 = 1/2 > 0$，违反了[最优性条件](@entry_id:634091)，因此当前解不是最优的，算法需要继续迭代 [@problem_id:3106101]。

### 高级主题：退化与循环

在实践中，我们可能会遇到一种特殊情况，称为**退化 (degeneracy)**。当一个基本可行解中至少有一个基变量的值为 $0$ 时，就称该解是退化的。例如，在典式 $x_5 = 0 + 1 x_1 - 1 x_2$ 中，初始BFS中基变量 $x_5$ 的值为 $0$ [@problem_id:3106126]。

退化的主要后果是可能出现**退化 pivot**。在进行 ratio test 时，如果最小比率为 $0$，意味着进入基的变量只能增加 $0$ 个单位。执行这样的 pivot 后，基变量集合发生了改变，但解的数值（即[多面体的顶点](@entry_id:635258)）没有移动，目标函数值也没有改善。

虽然退化在许多实际问题中很常见且通常无害，但在理论上，它可能导致**循环 (cycling)**：单纯形法在一系列退化基之间无限循环，永远无法达到最优解。为了保证算法的终止性，研究人员设计了**[反循环规则](@entry_id:637416) (anti-cycling rules)**，其中最著名的两种是：

-   **Bland 法则**：一个简单的组合规则。选择具有正既约成本的最小下标的变量进入基。当 ratio test 出现平局时，选择具有最小下标的变量离开基。
-   **[字典序](@entry_id:143032)法 (Lexicographic Pivoting)**：一个代数规则。它通过在 ratio test 中比较向量的字典序来打破平局，确保每次迭代都会有一个[字典序](@entry_id:143032)意义上的“进步”。

这些规则通过确保每次 pivot 都能以某种方式“前进”，从而从理论上杜绝了循环的可能性，保证了单纯形法的收敛性 [@problem_id:3106126]。