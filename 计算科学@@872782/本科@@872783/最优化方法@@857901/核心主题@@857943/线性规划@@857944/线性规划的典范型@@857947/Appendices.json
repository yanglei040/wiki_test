{"hands_on_practices": [{"introduction": "单纯形法等算法通常要求一个标准化的起点：一个等式约束系统，并带有一个明确的初始基本可行解。然而，现实世界的问题往往以混合不等式的形式出现。本练习 [@problem_id:3106013] 将指导你处理一种常见但棘手的情况：如何将一个包含负右侧项的线性规划问题转化为适用于两阶段法的规范型。这个过程是启动单纯形法前至关重要的预处理步骤。", "problem": "考虑一个最小化形式的线性规划（LP）问题，其决策向量为 $x \\in \\mathbb{R}^{3}$，目标为 $c^{\\top}x$，约束条件为分量非负 $x \\ge 0$ 以及以下线性不等式组：\n$$\n\\begin{aligned}\n2x_{1} - x_{2} + x_{3} \\le 3, \\\\\n- x_{1} + 4x_{2} + 2x_{3} \\le -5, \\\\\n3x_{1} + x_{2} - 2x_{3} \\le 7, \\\\\n- 2x_{1} + x_{2} + x_{3} \\le -1.\n\\end{aligned}\n$$\n从线性规划的规范等式形式的基本定义以及单纯形法所要求的基本可行解的构造出发，将该系统转化为适用于两阶段单纯形法（TPSM）的典范等式形式。具体而言，通过将每个右端项为负数的不等式乘以 $-1$ 来进行符号规范化（这将反转不等式的方向），然后为 $\\le$ 类型的约束引入松弛变量，为 $\\ge$ 类型的约束引入剩余变量和人工变量，从而得到一个具有非负变量的典范等式系统。\n\n将第一阶段的目标定义为所有引入的人工变量之和。如果在第一阶段中，原始决策变量初始化为零向量 $x=0$，那么对于您推导出的典范等式系统，在此初始点上第一阶段目标的值是多少？请以一个精确的实数形式给出答案，无需四舍五入。", "solution": "为了将给定的线性规划问题转化为适用于两阶段单纯形法的形式，我们遵循以下步骤：\n\n### 步骤 1：处理右侧负项\n\n我们检查所有约束，并将右侧常数项（RHS）为负的约束两边乘以 $-1$。这将改变不等号的方向。\n\n原始约束：\n1.  $2x_{1} - x_{2} + x_{3} \\le 3$\n2.  $-x_{1} + 4x_{2} + 2x_{3} \\le -5$\n3.  $3x_{1} + x_{2} - 2x_{3} \\le 7$\n4.  $-2x_{1} + x_{2} + x_{3} \\le -1$\n\n约束2和约束4的右侧为负。处理后得到：\n-   约束 2: $(-1)(-x_{1} + 4x_{2} + 2x_{3}) \\ge (-1)(-5) \\implies x_{1} - 4x_{2} - 2x_{3} \\ge 5$。\n-   约束 4: $(-1)(-2x_{1} + x_{2} + x_{3}) \\ge (-1)(-1) \\implies 2x_{1} - x_{2} - x_{3} \\ge 1$。\n\n规范化后的不等式组为：\n1.  $2x_{1} - x_{2} + x_{3} \\le 3$\n2.  $x_{1} - 4x_{2} - 2x_{3} \\ge 5$\n3.  $3x_{1} + x_{2} - 2x_{3} \\le 7$\n4.  $2x_{1} - x_{2} - x_{3} \\ge 1$\n\n### 步骤 2：引入辅助变量转换为等式\n\n现在，我们将不等式转换为等式，并确保每个约束都有一个可以作为初始基变量的变量。\n\n-   对于 $\\le$ 约束（1和3），我们引入非负的**松弛变量** $s_1, s_3 \\ge 0$。\n-   对于 $\\ge$ 约束（2和4），我们减去非负的**剩余变量** $s_2, s_4 \\ge 0$。由于减去变量后无法形成初始单位基，我们还需为这两个约束引入非负的**人工变量** $a_1, a_2 \\ge 0$。\n\n转换后的等式系统如下：\n$$\n\\begin{aligned}\n2x_{1} - x_{2} + x_{3} + s_1 \\phantom{-s_2+a_1} \\phantom{+s_3} \\phantom{-s_4+a_2} = 3 \\\\\nx_{1} - 4x_{2} - 2x_{3} \\phantom{+s_1} - s_2 + a_1 \\phantom{+s_3} \\phantom{-s_4+a_2} = 5 \\\\\n3x_{1} + x_{2} - 2x_{3} \\phantom{+s_1} \\phantom{-s_2+a_1} + s_3 \\phantom{-s_4+a_2} = 7 \\\\\n2x_{1} - x_{2} - x_{3} \\phantom{+s_1} \\phantom{-s_2+a_1} \\phantom{+s_3} - s_4 + a_2 = 1\n\\end{aligned}\n$$\n所有变量 $x_1, x_2, x_3, s_1, s_2, s_3, s_4, a_1, a_2$ 均为非负。\n\n### 步骤 3：计算第一阶段目标的初始值\n\n两阶段法的第一阶段目标是最小化所有人工变量之和。设目标函数为 $w$：\n$$ \\text{minimize } w = a_1 + a_2 $$\n初始基本可行解是通过将所有非基变量设为零来找到的。在这个系统中，初始基变量是 $\\{s_1, a_1, s_3, a_2\\}$，因为它们在约束矩阵中构成了单位矩阵。所有其他变量，即原始变量 $\\{x_1, x_2, x_3\\}$ 和剩余变量 $\\{s_2, s_4\\}$，是初始非基变量。\n\n根据题目要求，我们将非基变量设为零：$x_1=0, x_2=0, x_3=0, s_2=0, s_4=0$。将这些值代入等式系统，我们求解基变量的值：\n-   从方程 1: $2(0) - (0) + (0) + s_1 = 3 \\implies s_1 = 3$。\n-   从方程 2: $(0) - 4(0) - 2(0) - (0) + a_1 = 5 \\implies a_1 = 5$。\n-   从方程 3: $3(0) + (0) - 2(0) + s_3 = 7 \\implies s_3 = 7$。\n-   从方程 4: $2(0) - (0) - (0) - (0) + a_2 = 1 \\implies a_2 = 1$。\n\n初始基本可行解中，人工变量的值为 $a_1 = 5$ 和 $a_2 = 1$。因此，第一阶段目标函数的初始值为：\n$$ w = a_1 + a_2 = 5 + 1 = 6 $$", "answer": "$$\n\\boxed{6}\n$$", "id": "3106013"}, {"introduction": "一旦问题被转换成规范型，单纯形法通过一系列“主元变换”（或称“旋转”）从一个基本可行解迭代到另一个，直至找到最优解。本练习 [@problem_id:3106043] 让你亲手操作一次完整的主元变换。你将学习如何通过选择进基变量和出基变量，在代数上重构约束系统，并观察这如何引导我们向更优的解迈进。", "problem": "考虑以下通过引入松弛变量从两个资源约束导出的标准等式形式的线性规划 (Linear Program (LP))：\n$$\\text{maximize } z = 4 x_1 + 3 x_2 + 0 \\cdot s_1 + 0 \\cdot s_2,$$\n约束条件为\n$$x_1 + 2 x_2 + s_1 = 8,$$\n$$2 x_1 + x_2 + s_2 = 13,$$\n非负性约束为\n$$x_1 \\ge 0,\\quad x_2 \\ge 0,\\quad s_1 \\ge 0,\\quad s_2 \\ge 0.$$\n从基本定义出发：基是一组构成可逆子矩阵的列，基本可行解是通过将所有非基变量设置为零并求解基变量得到的，规范字典将基变量表示为非基变量的仿射函数，并提供目标值作为非基变量的仿射函数。仅使用这些定义，按以下步骤进行：\n- 为初始基构造规范字典，其中松弛变量 $s_1$ 和 $s_2$ 是基变量，决策变量 $x_1$ 和 $x_2$ 是非基变量。\n- 接下来，执行一次枢轴操作，将一个基变量与一个非基变量交换，选择入基变量为 $x_1$，并通过最小比率规则强制执行可行性要求 $x \\ge 0$ 来确定出基变量。\n- 在这次枢轴操作之后，计算更新后的规范字典的右端向量 $b$（当新的非基变量设置为零时新基变量的值）和新的非基变量的更新后的检验数 $\\bar c$。\n\n将您的最终答案表示为一个单行矩阵，其中的条目顺序为 $(b_{x_1}, b_{s_1}, \\bar c_{x_2}, \\bar c_{s_2})$。不需要四舍五入。", "solution": "我们按照单纯形法的步骤，使用字典表示法执行一次枢轴操作。\n\n### 步骤 1：构造初始规范字典\n\n初始基变量为 $\\{s_1, s_2\\}$，非基变量为 $\\{x_1, x_2\\}$。我们从约束方程中解出基变量，用非基变量来表示它们。\n\n-   从第一个约束：$x_1 + 2 x_2 + s_1 = 8 \\implies s_1 = 8 - x_1 - 2 x_2$\n-   从第二个约束：$2 x_1 + x_2 + s_2 = 13 \\implies s_2 = 13 - 2 x_1 - x_2$\n\n目标函数已经是以非基变量表示的形式：\n$$z = 4 x_1 + 3 x_2$$\n\n初始规范字典为：\n$$\n\\begin{aligned}\ns_1 = 8 - x_1 - 2 x_2 \\\\\ns_2 = 13 - 2 x_1 - x_2 \\\\\n\\hline\nz = 0 + 4 x_1 + 3 x_2\n\\end{aligned}\n$$\n\n### 步骤 2：执行枢轴操作\n\n**选择入基变量：**\n问题指定入基变量为 $x_1$。\n\n**选择出基变量（最小比率检验）：**\n我们确定在保持所有变量非负的前提下，$x_1$ 能增加的最大值。此时，我们假设其他非基变量 $x_2$ 保持为 $0$。\n\n1.  根据 $s_1 \\ge 0$：$s_1 = 8 - x_1 \\ge 0 \\implies x_1 \\le 8$。\n2.  根据 $s_2 \\ge 0$：$s_2 = 13 - 2 x_1 \\ge 0 \\implies x_1 \\le \\frac{13}{2} = 6.5$。\n\n$x_1$ 的最大允许值为 $\\min(8, 6.5) = 6.5$。这个限制来自 $s_2$ 所在的行，因此 $s_2$ 是出基变量。\n\n### 步骤 3：计算更新后的规范字典\n\n我们进行枢轴操作，交换 $x_1$ 和 $s_2$ 的角色。新的基变量是 $\\{s_1, x_1\\}$，新的非基变量是 $\\{x_2, s_2\\}$。\n\n首先，我们从出基变量 $s_2$ 的方程中解出入基变量 $x_1$：\n$$ s_2 = 13 - 2 x_1 - x_2 \\implies 2 x_1 = 13 - x_2 - s_2 \\implies x_1 = \\frac{13}{2} - \\frac{1}{2} x_2 - \\frac{1}{2} s_2 $$\n\n接下来，我们将 $x_1$ 的这个新表达式代入旧字典的其他方程中：\n\n-   对于基变量 $s_1$：\n    $$ s_1 = 8 - x_1 - 2 x_2 = 8 - \\left(\\frac{13}{2} - \\frac{1}{2} x_2 - \\frac{1}{2} s_2\\right) - 2 x_2 $$\n    $$ s_1 = \\left(8 - \\frac{13}{2}\\right) + \\left(\\frac{1}{2} - 2\\right) x_2 + \\frac{1}{2} s_2 = \\frac{3}{2} - \\frac{3}{2} x_2 + \\frac{1}{2} s_2 $$\n\n-   对于目标函数 $z$：\n    $$ z = 4 x_1 + 3 x_2 = 4 \\left(\\frac{13}{2} - \\frac{1}{2} x_2 - \\frac{1}{2} s_2\\right) + 3 x_2 $$\n    $$ z = 26 - 2 x_2 - 2 s_2 + 3 x_2 = 26 + x_2 - 2 s_2 $$\n\n更新后的规范字典为：\n$$\n\\begin{aligned}\nx_1 = \\frac{13}{2} - \\frac{1}{2} x_2 - \\frac{1}{2} s_2 \\\\\ns_1 = \\frac{3}{2} - \\frac{3}{2} x_2 + \\frac{1}{2} s_2 \\\\\n\\hline\nz = 26 + x_2 - 2 s_2\n\\end{aligned}\n$$\n\n### 步骤 4：提取所求值\n\n问题要求提供一个行矩阵 $(b_{x_1}, b_{s_1}, \\bar c_{x_2}, \\bar c_{s_2})$。\n\n-   **更新后的右端向量 $b$**：这是新基变量 $\\{x_1, s_1\\}$ 在字典中的常数项。\n    -   $b_{x_1} = \\frac{13}{2}$\n    -   $b_{s_1} = \\frac{3}{2}$\n\n-   **更新后的检验数 $\\bar c$**：这是目标函数 $z$ 中新非基变量 $\\{x_2, s_2\\}$ 的系数。\n    -   $\\bar c_{x_2} = 1$\n    -   $\\bar c_{s_2} = -2$\n\n将这些值按要求的顺序组合成一个行矩阵：\n$$ \\left( \\frac{13}{2}, \\frac{3}{2}, 1, -2 \\right) $$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{13}{2}  \\frac{3}{2}  1  -2\n\\end{pmatrix}\n}\n$$", "id": "3106043"}, {"introduction": "通常，我们选择松弛变量作为初始基变量，因为这非常方便，但实际上任何能构成可逆基矩阵的变量集合都可以定义一个基本可行解。这个进阶练习 [@problem_id:3106032] 挑战你从一个不那么直观的、由原始决策变量构成的基底出发，来构建单纯形字典。这项实践将加深你对支撑单纯形法的线性代数原理的理解，并揭示“字典”不仅仅是一个起点，而是从任何有效基的角度对问题的表示。", "problem": "考虑以下不等式形式的线性规划 (LP)。决策变量为 $x_1, x_2, x_3, x_4$，且均为非负：\n$$\n\\max \\ z \\ = \\ 5 x_1 + 3 x_2 + 4 x_3 + 2 x_4\n$$\n满足约束条件\n$$\n2 x_1 + x_2 + x_4 \\ \\le \\ 6, \\\\\n- x_1 + 2 x_2 + x_3 \\ \\le \\ 8, \\\\\nx_1 + 3 x_3 + 2 x_4 \\ \\le \\ 10, \\\\\nx_1, x_2, x_3, x_4 \\ \\ge \\ 0.\n$$\n引入松弛变量 $s_1, s_2, s_3$ 以获得等式约束。然后，不选择松弛变量作为基变量集合，而是特意选择非显而易见的基变量集合 $\\{x_1, x_2, x_3\\}$，并将 $\\{x_4, s_1, s_2, s_3\\}$ 视为非基变量。为这个基构造相应的规范单纯形字典，并通过在所有非基变量设为零时检查基本解来验证可行性，即验证所选基的 $x_B = b \\ge 0$。最后，计算此基本可行解处的目标函数值。将最终答案表示为精确值（无需四舍五入）。", "solution": "我们的目标是为指定的基变量集合 $\\{x_1, x_2, x_3\\}$ 构建单纯形字典，并计算对应的目标函数值。\n\n### 步骤 1：建立等式系统\n\n首先，我们引入非负松弛变量 $s_1, s_2, s_3$ 将不等式约束转换为等式约束：\n$$\n\\begin{aligned}\n2 x_1 + x_2 + x_4 + s_1 = 6 \\\\\n-x_1 + 2 x_2 + x_3 + s_2 = 8 \\\\\nx_1 + 3 x_3 + 2 x_4 + s_3 = 10\n\\end{aligned}\n$$\n所有变量 $x_1, x_2, x_3, x_4, s_1, s_2, s_3$ 均为非负。\n\n### 步骤 2：用矩阵代数求解基变量\n\n指定的基变量为 $\\mathbf{x}_B = (x_1, x_2, x_3)^T$，非基变量为 $\\mathbf{x}_N = (x_4, s_1, s_2, s_3)^T$。约束系统可以写成 $B \\mathbf{x}_B + N \\mathbf{x}_N = \\mathbf{b}$。\n\n基矩阵 $B$ 由 $x_1, x_2, x_3$ 的系数列构成，右侧向量为 $\\mathbf{b}$：\n$$\nB = \\begin{pmatrix} 2  1  0 \\\\ -1  2  1 \\\\ 1  0  3 \\end{pmatrix}, \\quad \\mathbf{b} = \\begin{pmatrix} 6 \\\\ 8 \\\\ 10 \\end{pmatrix}\n$$\n为了构造字典，我们需要将基变量 $\\mathbf{x}_B$ 表示为非基变量的函数。这需要计算 $B$ 的逆矩阵 $B^{-1}$。\n\n首先计算 $B$ 的行列式：\n$$ \\det(B) = 2(2 \\cdot 3 - 1 \\cdot 0) - 1(-1 \\cdot 3 - 1 \\cdot 1) + 0 = 2(6) - 1(-4) = 16 $$\n由于行列式不为零，该基是有效的。$B$ 的逆矩阵为：\n$$ B^{-1} = \\frac{1}{\\det(B)} \\text{adj}(B) = \\frac{1}{16} \\begin{pmatrix} \\text{Cofactor}(1,1)  \\text{Cofactor}(2,1)  \\text{Cofactor}(3,1) \\\\ \\text{Cofactor}(1,2)  \\text{Cofactor}(2,2)  \\text{Cofactor}(3,2) \\\\ \\text{Cofactor}(1,3)  \\text{Cofactor}(2,3)  \\text{Cofactor}(3,3) \\end{pmatrix} = \\frac{1}{16} \\begin{pmatrix} 6  -3  1 \\\\ 4  6  -2 \\\\ -2  1  5 \\end{pmatrix} $$\n\n### 步骤 3：计算基本可行解并验证可行性\n\n基本解是通过将所有非基变量设为零（$\\mathbf{x}_N = 0$）得到的，其值为 $\\mathbf{x}_B = B^{-1}\\mathbf{b}$。\n$$\n\\mathbf{x}_B = \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\end{pmatrix} = \\frac{1}{16} \\begin{pmatrix} 6  -3  1 \\\\ 4  6  -2 \\\\ -2  1  5 \\end{pmatrix} \\begin{pmatrix} 6 \\\\ 8 \\\\ 10 \\end{pmatrix} = \\frac{1}{16} \\begin{pmatrix} 36 - 24 + 10 \\\\ 24 + 48 - 20 \\\\ -12 + 8 + 50 \\end{pmatrix} = \\frac{1}{16} \\begin{pmatrix} 22 \\\\ 52 \\\\ 46 \\end{pmatrix} = \\begin{pmatrix} 11/8 \\\\ 13/4 \\\\ 23/8 \\end{pmatrix}\n$$\n由于 $x_1 = 11/8 \\ge 0$, $x_2 = 13/4 \\ge 0$ 且 $x_3 = 23/8 \\ge 0$，所有基变量均非负，因此该解是可行的。\n\n### 步骤 4：构建完整的字典（可选但有助于理解）\n\n为了得到完整的字典，我们需要将基变量表示为非基变量的函数：$\\mathbf{x}_B = B^{-1}\\mathbf{b} - B^{-1}N \\mathbf{x}_N$。\n非基矩阵 $N$ 包含 $x_4, s_1, s_2, s_3$ 的系数列：\n$$ N = \\begin{pmatrix} 1  1  0  0 \\\\ 0  0  1  0 \\\\ 2  0  0  1 \\end{pmatrix} $$\n计算 $B^{-1}N$：\n$$ B^{-1}N = \\frac{1}{16} \\begin{pmatrix} 6  -3  1 \\\\ 4  6  -2 \\\\ -2  1  5 \\end{pmatrix} \\begin{pmatrix} 1  1  0  0 \\\\ 0  0  1  0 \\\\ 2  0  0  1 \\end{pmatrix} = \\frac{1}{16} \\begin{pmatrix} 8  6  -3  1 \\\\ 0  4  6  -2 \\\\ 8  -2  1  5 \\end{pmatrix} $$\n字典的约束部分为：\n$$\n\\begin{aligned}\nx_1 = \\frac{11}{8} - \\frac{8}{16} x_4 - \\frac{6}{16} s_1 + \\frac{3}{16} s_2 - \\frac{1}{16} s_3 \\\\\nx_2 = \\frac{13}{4} - \\frac{0}{16} x_4 - \\frac{4}{16} s_1 - \\frac{6}{16} s_2 + \\frac{2}{16} s_3 \\\\\nx_3 = \\frac{23}{8} - \\frac{8}{16} x_4 + \\frac{2}{16} s_1 - \\frac{1}{16} s_2 - \\frac{5}{16} s_3\n\\end{aligned}\n$$\n\n### 步骤 5：计算目标函数值\n\n问题要求计算此基本可行解处的目标函数值。我们可以将基变量的值代入目标函数：\n$$ z = 5 x_1 + 3 x_2 + 4 x_3 + 2 x_4 $$\n在此基本解中，$x_1 = 11/8, x_2 = 13/4, x_3 = 23/8$，非基变量 $x_4=0$。\n$$\nz = 5 \\left(\\frac{11}{8}\\right) + 3 \\left(\\frac{13}{4}\\right) + 4 \\left(\\frac{23}{8}\\right) + 2(0)\n$$\n$$\nz = \\frac{55}{8} + 3 \\left(\\frac{26}{8}\\right) + \\frac{92}{8} = \\frac{55 + 78 + 92}{8} = \\frac{225}{8}\n$$\n因此，在该基本可行解处的目标函数值为 $\\frac{225}{8}$。", "answer": "$$\n\\boxed{\\frac{225}{8}}\n$$", "id": "3106032"}]}