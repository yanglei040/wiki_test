## 引言
单纯形法是求解[线性规划](@entry_id:138188)问题的基石算法，其大部分理论优雅地建立在非退化假设之上。然而，在现实世界的大规模问题中，一种名为**退化 (degeneracy)** 的现象却屡见不鲜，它破坏了理论的理想化假设。当退化发生时，单纯形法的[计算效率](@entry_id:270255)会显著降低（停滞），甚至在极端情况下，算法会因“循环”而永远无法收敛，从而导致求解失败。这一潜在的“阿喀琉斯之踵”构成了我们必须理解和解决的核心知识缺口。

本文旨在系统性地剖析退化与循环的理论与实践。在 **“原理与机制”** 章节中，我们将从代数和几何两个维度深入探讨退化的定义，揭示其如何导致算法停滞，并介绍布兰德规则等反循环策略。接着，在 **“应用与跨学科联系”** 章节中，我们将展示退化如何在[运输问题](@entry_id:136732)、金融投资、博弈论等不同领域的模型中自然产生，并分析其对算法性能的实际影响。最后，通过 **“动手实践”** 部分，你将通过具体的计算练习，亲手处理由冗余约束引起的退化，并应用不同的枢轴规则来观察其对算法路径的影响，从而巩固你的理论认知。

通过这三个层次的学习，你将不仅掌握退化与循环的底层机理，更能理解如何在实际建模和算法应用中预见、诊断并有效应对这一挑战，从而成为一名更加成熟和高效的优化实践者。

## 原理与机制

在[线性规划](@entry_id:138188)的单纯形法理论中，大部分基础理论都建立在“非退化”假设之上。然而，在实际应用中，特别是在大规模的结构化问题中，一种被称为**退化 (degeneracy)** 的现象频繁出现。退化不仅可能降低算法的[计算效率](@entry_id:270255)，在极端情况下甚至会导致算法失效。本章将深入探讨退化的基本原理、其在单纯形法中的表现形式、可能引发的“停滞”与“循环”问题，以及相应的解决方案和更广泛的理论影响。

### [退化现象](@entry_id:183258)

#### 退化的代数与几何定义

在[线性规划](@entry_id:138188)的[标准形式](@entry_id:153058)（最小化 $c^{\top}x$，约束为 $Ax=b, x \ge 0$）中，一个**基本[可行解](@entry_id:634783) (Basic Feasible Solution, BFS)** 是通过选择 $m$ 个[线性无关](@entry_id:148207)的列（构成基矩阵 $B$），令对应的非基变量为零，并解出基变量 $x_B = B^{-1}b \ge 0$ 得到的。

**退化** 的代数定义非常直接：一个基本[可行解](@entry_id:634783)如果其至少有一个基变量的值为零，则称该解是**退化的 (degenerate)**。

这个代数定义背后有着深刻的几何直观。一个[线性规划](@entry_id:138188)的可行域是一个[多面体](@entry_id:637910)。[多面体](@entry_id:637910)的每个顶点都对应着一个基本[可行解](@entry_id:634783)。在一个 $d$ 维空间中，一个顶点通常由 $d$ 个[线性无关](@entry_id:148207)的约束超平面交汇而成。例如，在三维空间中，一个顶点通常是三个平面的交点。

然而，一个退化的顶点是“过度确定”的。这意味着，在该顶点处，有超过 $d$ 个约束超平面交汇。例如，在问题 [@problem_id:3117224] 中，考虑由不等式 $|x_1| + |x_2| + |x_3| \le 1$ 定义的八面体。这是一个在 $\mathbb{R}^3$ 中的[多面体](@entry_id:637910)。其顶点之一 $\boldsymbol{v}=(1,0,0)$ 是一个[退化顶点](@entry_id:636994)。通过代入可以发现，该顶点同时满足以下四个约束等式：
1.  $x_1+x_2+x_3=1$
2.  $x_1+x_2-x_3=1$
3.  $x_1-x_2+x_3=1$
4.  $x_1-x_2-x_3=1$

由于在三维空间中，超过三个平面交于一点，这个顶点就是退化的。从[有效约束](@entry_id:635234)的角度看，在任意一个[可行解](@entry_id:634783) $x$ 处，[有效约束](@entry_id:635234)是指那些在该点取等号的约束。对于[标准形式](@entry_id:153058)，[等式约束](@entry_id:175290) $Ax=b$ 总是有效的。非负约束 $x_i \ge 0$ 在 $x_i=0$ 时是有效的。一个非退化的基本[可行解](@entry_id:634783)恰好有 $n$ 个线性无关的[有效约束](@entry_id:635234)（$m$ 个来自 $Ax=b$，$n-m$ 个来自非基变量 $x_N=0$）。而在一个退化解处，由于至少有一个基变量 $x_k=0$ ($k \in B$)，[有效约束](@entry_id:635234)的总数严格大于 $n$。我们可以通过检验在某点所有[有效约束](@entry_id:635234)梯度的秩来判断退化：如果[有效约束](@entry_id:635234)的数量大于其梯度构成的[矩阵的秩](@entry_id:155507)，则该点是退化的 [@problem_id:3117184]。

#### 退化、顶点与基

单纯形法的核心思想是在[可行域的顶点](@entry_id:174284)之间移动。在非退化的情况下，[可行域](@entry_id:136622)的每个顶点与一个唯一的基一一对应。然而，在退化的情况下，这种一对一的关系被打破了。**一个[退化顶点](@entry_id:636994)可能对应多个不同的基。**

这是因为，当一个顶点被过度确定时，我们可以从交汇于此的多个超平面中选择不同的[子集](@entry_id:261956)来定义同一点。例如，在上述的八面体问题 [@problem_id:3117224] 中，顶点 $\boldsymbol{v}=(1,0,0)$ 处有四个[有效约束](@entry_id:635234)。由于空间维度为3，我们任意从中选取三个线性无关的约束，它们的交点都将是 $\boldsymbol{v}$。计算表明，这四个约束中任意三个都是线性无关的，因此共有 $\binom{4}{3}=4$ 种不同的组合，每一种组合都对应一个可以定义该顶点的单纯形法中的基。

我们也可以通过一个纯代数的例子来理解这一点 [@problem_id:3117218]。考虑如下[线性规划](@entry_id:138188)问题：
最大化 $z = x_1$，约束为
$x_1 = 1$
$x_2 + x_3 = 0$
$x_1, x_2, x_3 \ge 0$
（这里为了清晰，已将[等式约束](@entry_id:175290) $Ax=b$ 写开）。
其约束矩阵为 $A = \begin{pmatrix} 1  0  0 \\ 0  1  1 \end{pmatrix}$，$b=\begin{pmatrix} 1 \\ 0 \end{pmatrix}$。
该问题只有一个顶点，即 $x^\star = (1,0,0)^\top$。我们可以为这个顶点找到两个不同的基：
1.  选择基变量为 $\{x_1, x_2\}$。基矩阵为 $B_1 = \begin{pmatrix} 1  0 \\ 0  1 \end{pmatrix}$。解得 $x_1=1, x_2=0$。这是一个退化的基本可行解，因为基变量 $x_2$ 的值为0。
2.  选择基变量为 $\{x_1, x_3\}$。基矩阵为 $B_2 = \begin{pmatrix} 1  0 \\ 0  1 \end{pmatrix}$。解得 $x_1=1, x_3=0$。这也是一个退化的基本可行解，因为基变量 $x_3$ 的值为0。

这两个不同的基，对应着同一个顶点。单纯形法在执行过程中，可能会在这些对应于同一顶点的不同基之间进行转换，而解的数值本身并无变化。

### 退化枢轴与停滞

[退化现象](@entry_id:183258)对单纯形法算法流程的直接影响体现在**退化枢轴 (degenerate pivot)** 操作上。

在单纯形法的每一次迭代中，我们通过最小比率测试来确定出基变量，其目的是为了保证在增加进基变量值的同时，所有基变量仍然保持非负。比率的计算公式为 $\theta = \min \{ \frac{x_{B_i}}{d_i} \mid d_i > 0 \}$，其中 $x_{B_i}$ 是当前基变量的值，$d_i$ 是进基列对应的变换后列向量的分量。

当一个基本[可行解](@entry_id:634783)是退化时，至少有一个基变量 $x_{B_k}=0$。如果在某次迭代中，这个值为0的基变量 $x_{B_k}$ 恰好是最小比率测试的胜出者（即它对应的 $d_k > 0$），那么最小比率 $\theta$ 的值将是 $0/d_k=0$。

一个步长 $\theta=0$ 的枢轴操作就是退化枢轴。它的后果是：
1.  **解向量不变**：进基变量的值从0增加到 $\theta=0$，仍然是0。其他基变量的值也保持不变。因此，算法在几何上停留在同一点。
2.  **[目标函数](@entry_id:267263)值不变**：[目标函数](@entry_id:267263)值的改变量为 $\Delta z = \bar{c}_j \theta$，其中 $\bar{c}_j$ 是进基变量的非负[检验数](@entry_id:173345)。由于 $\theta=0$，目标函数值不变，即 $\Delta z = 0$。

尽管解向量和目标函数值都没有改变，但基发生了变化：一个变量出基，另一个变量入基。算法在代数层面（字典或tableau）上取得了进展，但在几何和目标值上却原地踏步。这种现象被称为**停滞 (stalling)**。

问题 [@problem_id:3117227] 中的单纯形表提供了一个清晰的例子。在给定的tableau中，基变量 $s_1$ 和 $s_2$ 的值均为0，这是一个退化解。当选择 $x_1$ 作为进基变量时，最小比率测试在 $s_1$ 和 $s_2$ 对应的行上出现平局，且最小比率均为0。无论选择 $s_1$ 还是 $s_2$ 作为出基变量，都将执行一次退化枢轴，目标函数值不会改善。

更进一步，算法可能会经历一连串的退化枢轴，在多个基之间转换，而始终停留在同一个[退化顶点](@entry_id:636994)上。例如，在问题 [@problem_id:3117265] 中构造的例子里，单纯形法连续执行了两次退化枢轴，目标函数值一直保持为0，直到第三次枢轴操作才是一个非退化枢轴，使得[目标函数](@entry_id:267263)值得到改善。

### 循环：病态的停滞

停滞本身只是降低了算法效率，但它也可能演变成一种更严重、更具破坏性的病态行为：**循环 (cycling)**。

循环是指单纯形法在执行一系列退化枢轴后，返回到了一个先前已经访问过的基。一旦发生这种情况，由于枢轴[选择规则](@entry_id:140784)是确定性的，算法将陷入一个由这些[基组](@entry_id:160309)成的无限循环中，永远无法终止，也无法达到最优解。

我们可以将单纯形法的迭代过程看作是在一个[有向图](@entry_id:272310)上的游走，图的节点是所有可行的基，有向边表示一次有效的枢轴操作 [@problem_id:3117279]。
- 如果一个线性规划问题是**非退化的**，那么每一次枢轴操作的步长 $\theta$ 都严格大于0。如果选择的进基变量[检验数](@entry_id:173345)也严格为正，那么目标函数值在每次迭代中都会严格增加。由于基的数量是有限的，[目标函数](@entry_id:267263)值不能无限增加，因此算法绝不会回到一个旧的基，从而保证了不会发生循环。
- **循环的必要条件是退化**。只有在退化的情况下，才可能出现 $\theta=0$ 的退化枢轴，从而使得目标函数值不变。只有当目标函数值不变时，算法才有可能在不违反“目标值单调”的原则下回到一个旧的基。

一个著名的、专门用于展示循环现象的例子是Beale构造的[线性规划](@entry_id:138188)问题 [@problem_id:3117274]。当使用标准的Dantzig枢轴规则（选择具有最大正[检验数](@entry_id:173345)的变量作为进基变量）来求解该问题时，单纯形法会进入一个包含6个不同基的循环，永远无法收敛。

幸运的是，循环在实践中非常罕见，并且已经有成熟的理论可以彻底避免它。这些方法被称为**[反循环规则](@entry_id:637416) (anti-cycling rules)**。
- **Bland规则**：这是一个非常简单且优美的规则。它规定：
    1.  **进基规则**：在所有具有正[检验数](@entry_id:173345)的非基变量中，选择下标最小的那个作为进基变量。
    2.  **出基规则**：如果在最小比率测试中出现平局，选择下标最小的那个基变量作为出基变量。
    可以证明，只要严格遵守Bland规则，单纯形法就绝不会发生循环。在Beale的例子上应用Bland规则，算法会顺利地避开循环，并最终找到最优解 [@problem_id:3117274]。
- **词典法 (Lexicographic Method)**：这是另一种[反循环规则](@entry_id:637416)，它通过对单纯形表的行进行向量化的比较来打破平局，可以看作是对原始问题施加了一个无穷小的扰动。

### 退化的更广泛影响

退化的影响不仅限于计算过程中的停滞和循环，它还对线性规划的[对偶理论](@entry_id:143133)和[数值稳定性](@entry_id:146550)有着深刻的寓意。

#### [对偶问题](@entry_id:177454)与影子价格

对于一个[标准形式](@entry_id:153058)的 primal 问题，其 dual 问题是 $\min \{b^\top y \mid A^\top y \ge c\}$。对偶变量 $y$ 通常被解释为 primal 问题中约束 $Ax=b$ 对应的资源的**影子价格 (shadow prices)**，即每增加一单位资源所能带来的目标函数值的增量。

在 primal 问题非退化的情况下，其最优解 $x^*$ 对应的最优对偶解 $y^*$ 通常是唯一的。这意味着每种[资源的边际价值](@entry_id:634589)是唯一确定的。然而，当 primal 问题的最优解是退化时，其[对偶问题](@entry_id:177454)的最优解往往**不是唯一的** [@problem_id:3117185]。

在问题 [@problem_id:3117185] 中，primal 最优解是退化的。当我们求解其[对偶问题](@entry_id:177454)时，发现最优对偶解的集合构成了一条线段，连接了 $(3, 0)$ 和 $(0, 3)$ 两点。这意味着，对于两种资源，它们的影子价格 $(y_1, y_2)$ 可以是 $(3,0)$、$(0,3)$ 或介于两者之间的任何组合（例如 $(1.5, 1.5)$），只要它们的和为3。从经济学角度看，这意味着[资源的边际价值](@entry_id:634589)存在[歧义](@entry_id:276744)。具体哪个价值是“正确的”，取决于资源供给量发生微小变化的方向。这种由于退化导致的最优对偶解（影子价格）不唯一性，揭示了在资源约束“过度饱和”时，对资源进行估价的内在复杂性。

#### 数值退化与实现鲁棒性

在理论中，我们通常假设计算是精确的。但在计算机上使用浮点运算时，一个变量的值是“零”还是一个非常小的非零数（如 $10^{-15}$）变得模糊不清。这就引出了**数值退化 (numerical degeneracy)** 的概念。

当一个问题的基矩阵接近奇异（即列向量近乎线性相关）时，该问题是**病态的 (ill-conditioned)**。在这种情况下，计算中微小的舍入误差可能会被放大，导致灾难性的后果。问题 [@problem_id:3117200] 提供了一个例子，其基矩阵的行列式是一个非常小的数 $\varepsilon = 10^{-8}$，这导致其[逆矩阵](@entry_id:140380)的元素非常大，从而使得计算对[舍入误差](@entry_id:162651)极为敏感。

一个在理论上非退化的解，其基变量的值可能非常小（例如 $10^{-10}$），在数值计算中这与真正的退化（值为0）几乎无法区分。这种数值上的不稳定性，结合可能存在的退化，对单纯形法代码的**鲁棒性 (robustness)** 提出了严峻挑战。

为了编写一个稳健的单纯形法求解器，必须采用一系列策略来应对这些数值问题 [@problem_id:3117200]：
1.  **缩放 (Scaling)**：在求解之前，对约束矩阵的行和列进行缩放，使得所有系数的[数量级](@entry_id:264888)大致相当。这可以显著改善问题的[条件数](@entry_id:145150)。
2.  **容差 (Tolerances)**：不应使用“等于0”的精确比较。而应定义一系列容差，例如：
    - **可行性容差**：判断一个变量值 $x_i \ge -\epsilon_{\text{feas}}$ 是否满足非负约束。
    - **最优性容差**：判断一个[检验数](@entry_id:173345) $\bar{c}_j \le \epsilon_{\text{opt}}$ 是否满足[最优性条件](@entry_id:634091)。
    - **枢轴容差**：拒绝[绝对值](@entry_id:147688)小于 $\epsilon_{\text{piv}}$ 的枢轴元素，以避免除以一个接近于零的数。
    这些容差的选择（例如对于[双精度](@entry_id:636927)浮点数，常选在 $10^{-12}$ 到 $10^{-8}$ 之间）是数值稳定性的关键。
3.  **健壮的枢轴规则**：结合像Bland规则这样的反循环策略和上述的数值容差策略，可以确保算法既能在理论上保证终止，又能在实践中抵御浮点运算带来的不确定性。

综上所述，退化是线性规划中一个核心且复杂的概念。它从根本上改变了顶点与基的对应关系，可能导致算法[效率下降](@entry_id:272146)（停滞）甚至失败（循环），并对[对偶理论](@entry_id:143133)和数值计算产生深远影响。理解并妥善处理退化，是掌握单纯形法并将其成功应用于实际问题的关键。