{"hands_on_practices": [{"introduction": "支配边界有时会展现出一些反直觉的特性。这个练习将探讨一种特殊情况：一个包含自循环的节点。通过这个练习，我们将澄清支配边界的严格定义，并揭示一个节点如何能够成为其自身支配边界的一部分，这对理解其在循环优化中的作用至关重要。[@problem_id:3638510]", "problem": "考虑一个控制流图 (CFG)，其节点标记为 $n_0, n_1, n_2, n_3, n_4, n_5$，其中 $n_0$ 是唯一的入口节点，并且所有节点都可以从 $n_0$ 到达。有向边由 $n_0 \\to n_1$, $n_1 \\to n_2$, $n_2 \\to n_2$, $n_2 \\to n_3$, $n_1 \\to n_4$, $n_3 \\to n_4$, 和 $n_4 \\to n_5$ 给出。边 $n_2 \\to n_2$ 是一个自环。仅使用支配节点和支配边界的标准定义，计算此CFG中节点 $n_2$ 的支配边界 (DF)，并确定 $n_2$ 是否属于其自身的支配边界。设节点 $x$ 的支配边界 (DF) 定义为所有节点 $y$ 的集合，使得 $x$ 支配 $y$ 的至少一个前驱节点，但 $x$ 并不严格支配 $y$。如果从 $n_0$ 到节点 $n$ 的每一条路径都包含节点 $d$，则称节点 $d$ 支配节点 $n$；如果 $d$ 支配 $n$ 且 $d \\neq n$，则称 $d$ 严格支配 $n$。定义一个指示符 $I$，如果 $n_2 \\in DF(n_2)$，则 $I$ 等于 $1$，否则等于 $0$。为每个节点标签 $n_i$ 定义 $idx(n_i) = i$。报告单一数值量 $J = \\sum_{y \\in DF(n_2)} idx(y) + I$。无需四舍五入。", "solution": "该问题要求计算一个量 $J$，该量由给定控制流图 (CFG) 中特定节点 $n_2$ 的支配边界 (DF) 导出。该过程将分三步进行：首先，确定CFG中每个节点的支配节点集；其次，使用这些支配节点集计算 $DF(n_2)$；第三，计算最终的量 $J$。\n\n所提供的CFG具有节点 $\\{n_0, n_1, n_2, n_3, n_4, n_5\\}$ 和边 $\\{n_0 \\to n_1, n_1 \\to n_2, n_2 \\to n_2, n_2 \\to n_3, n_1 \\to n_4, n_3 \\to n_4, n_4 \\to n_5\\}$。唯一的入口节点是 $n_0$。\n\n**第一步：计算支配节点集**\n\n如果从入口节点 $n_0$ 到节点 $n$ 的每一条路径都包含节点 $d$，则称节点 $d$ 支配节点 $n$，记为 $d \\in Dom(n)$。一个节点总是支配其自身。\n\n*   $Dom(n_0)$: 从 $n_0$ 到 $n_0$ 的唯一路径是空路径。根据定义，$n_0$ 支配其自身。因此，$Dom(n_0) = \\{n_0\\}$。\n*   $Dom(n_1)$: 从 $n_0$ 到 $n_1$ 的唯一路径是 $n_0 \\to n_1$。此路径上的节点是 $\\{n_0, n_1\\}$。因此，$Dom(n_1) = \\{n_0, n_1\\}$。\n*   $Dom(n_2)$: 从 $n_0$ 到 $n_2$ 的任何路径都必须首先经过 $n_1$。初始路径段是 $n_0 \\to n_1 \\to n_2$。自环 $n_2 \\to n_2$ 不会引入避开 $n_0$ 或 $n_1$ 的路径。因此，到 $n_2$ 的每条路径都包含 $n_0$, $n_1$ 和 $n_2$。$Dom(n_2) = \\{n_0, n_1, n_2\\}$。\n*   $Dom(n_3)$: 要到达 $n_3$，必须通过边 $n_2 \\to n_3$ 经过 $n_2$。因此，到 $n_3$ 的任何路径都必须是到 $n_2$ 路径的延伸。$n_3$ 的支配节点包括 $n_2$ 的所有支配节点。因此，$Dom(n_3) = Dom(n_2) \\cup \\{n_3\\} = \\{n_0, n_1, n_2, n_3\\}$。\n*   $Dom(n_4)$: $n_4$ 有两条入边，一条来自 $n_1$，一条来自 $n_3$。这意味着从 $n_0$ 到 $n_4$ 至少有两种不同的路径结构：\n    1.  $P_1 = n_0 \\to n_1 \\to n_4$。此路径上的节点：$\\{n_0, n_1, n_4\\}$。\n    2.  $P_2 = n_0 \\to n_1 \\to n_2 \\to n_3 \\to n_4$。此路径上的节点：$\\{n_0, n_1, n_2, n_3, n_4\\}$。\n    $n_4$ 的支配节点是从 $n_0$ 到 $n_4$ 的所有可能路径上节点的交集（再加上 $n_4$ 本身）。所有路径共有的节点集是代表性路径节点集的交集：$\\{n_0, n_1, n_4\\} \\cap \\{n_0, n_1, n_2, n_3, n_4\\} = \\{n_0, n_1, n_4\\}$。\n    因此，$Dom(n_4) = \\{n_0, n_1, n_4\\}$。\n*   $Dom(n_5)$: 到达 $n_5$ 的唯一方法是从 $n_4$ 开始。因此，到 $n_5$ 的任何路径都是到 $n_4$ 路径的延伸。$n_5$ 的支配节点是 $n_4$ 的支配节点加上 $n_5$ 本身。$Dom(n_5) = Dom(n_4) \\cup \\{n_5\\} = \\{n_0, n_1, n_4, n_5\\}$。\n\n**第二步：计算支配边界 $DF(n_2)$**\n\n节点 $x$ 的支配边界定义为所有节点 $y$ 的集合，使得 $x$ 支配 $y$ 的一个前驱节点，但 $x$ 并不严格支配 $y$。\n如果 $d$ 支配 $n$ 且 $d \\neq n$，则称节点 $d$ 严格支配 $n$。\n\n我们需要计算 $DF(n_2)$。我们将检查图中的每个节点 $y$，以确定它是否在 $DF(n_2)$ 中。条件是：\n$y \\in DF(n_2) \\iff (\\exists p \\in Pred(y) \\text{ 使得 } n_2 \\in Dom(p)) \\land (n_2 \\text{ 不严格支配 } y)$。\n\n首先，让我们列出每个节点的前驱节点：\n$Pred(n_0) = \\emptyset$\n$Pred(n_1) = \\{n_0\\}$\n$Pred(n_2) = \\{n_1, n_2\\}$\n$Pred(n_3) = \\{n_2\\}$\n$Pred(n_4) = \\{n_1, n_3\\}$\n$Pred(n_5) = \\{n_4\\}$\n\n现在我们检查每个节点 $y$：\n*   $y = n_0$：$Pred(n_0)$ 为空，因此条件的第一个部分不成立。$n_0 \\notin DF(n_2)$。\n*   $y = n_1$：$Pred(n_1)=\\{n_0\\}$。$n_2$ 是否支配 $n_0$？否，$Dom(n_0) = \\{n_0\\}$。第一个条件不成立。$n_1 \\notin DF(n_2)$。\n*   $y = n_2$：$Pred(n_2)=\\{n_1, n_2\\}$。\n    1.  我们需要找到一个被 $n_2$ 支配的 $n_2$ 的前驱节点 $p$。让我们检查 $p=n_2$。$n_2 \\in Dom(n_2)$，这是正确的。所以第一个条件满足。\n    2.  $n_2$ 是否不严格支配 $n_2$？要使 $n_2$ 严格支配 $n_2$，我们需要 $n_2 \\in Dom(n_2)$ 且 $n_2 \\neq n_2$。第二部分 ($n_2 \\neq n_2$) 是错误的。因此，$n_2$ 不严格支配 $n_2$。第二个条件满足。\n    由于两个条件都成立，所以 $n_2 \\in DF(n_2)$。\n*   $y = n_3$：$Pred(n_3)=\\{n_2\\}$。\n    1.  前驱节点是 $p=n_2$。$n_2$ 是否支配 $n_2$？是的。第一个条件满足。\n    2.  $n_2$ 是否不严格支配 $n_3$？从第一步可知，$Dom(n_3)=\\{n_0, n_1, n_2, n_3\\}$。由于 $n_2 \\in Dom(n_3)$ 且 $n_2 \\neq n_3$，所以 $n_2$ *确实* 严格支配 $n_3$。第二个条件不成立。\n    因此，$n_3 \\notin DF(n_2)$。\n*   $y = n_4$：$Pred(n_4)=\\{n_1, n_3\\}$。\n    1.  我们需要找到一个被 $n_2$ 支配的 $n_4$ 的前驱节点 $p$。\n        - 检查 $p=n_1$：$n_2$ 是否支配 $n_1$？否，$Dom(n_1)=\\{n_0, n_1\\}$。\n        - 检查 $p=n_3$：$n_2$ 是否支配 $n_3$？是，$Dom(n_3)=\\{n_0, n_1, n_2, n_3\\}$。\n        由于一个前驱节点 ($n_3$) 被 $n_2$ 支配，所以第一个条件满足。\n    2.  $n_2$ 是否不严格支配 $n_4$？从第一步可知，$Dom(n_4)=\\{n_0, n_1, n_4\\}$。由于 $n_2 \\notin Dom(n_4)$，$n_2$ 不支配 $n_4$，因此不能严格支配 $n_4$。第二个条件满足。\n    由于两个条件都成立，所以 $n_4 \\in DF(n_2)$。\n*   $y = n_5$：$Pred(n_5)=\\{n_4\\}$。\n    1.  前驱节点是 $p=n_4$。$n_2$ 是否支配 $n_4$？否，$Dom(n_4)=\\{n_0, n_1, n_4\\}$。第一个条件不成立。\n    因此，$n_5 \\notin DF(n_2)$。\n\n综合这些结果，$n_2$ 的支配边界是 $DF(n_2) = \\{n_2, n_4\\}$。\n\n**第三步：计算最终的量 $J$**\n\n问题要求计算 $J = \\sum_{y \\in DF(n_2)} idx(y) + I$ 的值。\n\n首先，我们确定指示符 $I$ 的值。$I$ 定义为如果 $n_2 \\in DF(n_2)$ 则为 $1$，否则为 $0$。从第二步我们发现 $n_2 \\in DF(n_2)$。因此，$I=1$。\n\n接下来，我们计算总和。函数 $idx(n_i)$ 定义为 $i$。\n$$ \\sum_{y \\in DF(n_2)} idx(y) = idx(n_2) + idx(n_4) $$\n使用 $idx$ 的定义，我们有 $idx(n_2)=2$ 和 $idx(n_4)=4$。\n$$ \\sum_{y \\in DF(n_2)} idx(y) = 2 + 4 = 6 $$\n最后，我们计算 $J$：\n$$ J = \\left(\\sum_{y \\in DF(n_2)} idx(y)\\right) + I = 6 + 1 = 7 $$\n最终的数值是 $7$。", "answer": "$$\\boxed{7}$$", "id": "3638510"}, {"introduction": "在掌握了基本定义之后，我们将把支配边界的概念应用到程序中最常见的结构之一：循环。本练习涉及一个带有嵌套循环的控制流图。计算循环头和循环体内部节点的支配边界，是理解和实现循环相关优化的关键一步。[@problem_id:3638564]", "problem": "考虑以下具有两个嵌套循环的可约控制流图 (CFG)。节点由整数标记，节点 $0$ 是唯一的入口，节点 $10$ 是唯一的出口。有向边如下：\n$(0,1)$, $(1,2)$, $(2,3)$, $(2,9)$, $(3,4)$, $(4,5)$, $(4,7)$, $(5,6)$, $(6,4)$, $(7,8)$, $(8,2)$, $(9,10)$。外层循环的头节点是 $2$，其回边是 $(8,2)$；内层循环的头节点是 $4$，其回边是 $(6,4)$。内层循环体包含节点 $5$。\n\n仅使用控制流图中支配点理论的基本原理，确定内层循环头节点 $4$ 和内层循环体节点 $5$ 的支配边界 (DF)。然后计算数值\n$$S \\;=\\; \\sum_{n \\in \\mathrm{DF}(4)} n \\;+\\; 10 \\times \\sum_{m \\in \\mathrm{DF}(5)} m.$$\n\n将最终结果表示为一个精确整数（无需四舍五入）。此处，DF 表示编译器理论中标准定义的支配边界 (Dominance Frontier)。您可以假设支配性是相对于唯一入口节点 $0$ 定义的，并且一个节点支配其自身。", "solution": "### 步骤 1：定义控制流图 (CFG)\n\n问题定义了一个 CFG，其节点为 $V = \\{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10\\}$。入口节点是 $0$。有向边集 $E$ 如下所示：\n$E = \\{(0,1), (1,2), (2,3), (2,9), (3,4), (4,5), (4,7), (5,6), (6,4), (7,8), (8,2), (9,10)\\}$.\n\n为了找到支配边界，我们必须首先确定图中所有节点的支配关系。\n\n### 步骤 2：计算支配点\n\n如果从入口节点 ($0$) 到节点 $n$ 的每条路径都必须经过节点 $d$，则称节点 $d$ 支配节点 $n$，记作 $d \\text{ dom } n$。根据定义，每个节点都支配其自身。$n$ 的所有支配点的集合表示为 $\\mathrm{Dom}(n)$。支配点集可以通过使用不动点迭代法求解以下方程组来找到：\n$$ \\mathrm{Dom}(n) = \\{n\\} \\cup \\bigcap_{p \\in \\mathrm{preds}(n)} \\mathrm{Dom}(p) $$\n其中 $\\mathrm{preds}(n)$ 是 $n$ 的直接前驱节点集合。对于入口节点 $0$，$\\mathrm{Dom}(0)=\\{0\\}$。\n\n每个节点的前驱节点如下：\n$\\mathrm{preds}(0) = \\emptyset$\n$\\mathrm{preds}(1) = \\{0\\}$\n$\\mathrm{preds}(2) = \\{1, 8\\}$\n$\\mathrm{preds}(3) = \\{2\\}$\n$\\mathrm{preds}(4) = \\{3, 6\\}$\n$\\mathrm{preds}(5) = \\{4\\}$\n$\\mathrm{preds}(6) = \\{5\\}$\n$\\mathrm{preds}(7) = \\{4\\}$\n$\\mathrm{preds}(8) = \\{7\\}$\n$\\mathrm{preds}(9) = \\{2\\}$\n$\\mathrm{preds}(10) = \\{9\\}$\n\n我们初始化 $\\mathrm{Dom}(0) = \\{0\\}$ 且对于所有 $n \\ne 0$，$ \\mathrm{Dom}(n) = V$。迭代计算收敛到以下集合：\n- $\\mathrm{Dom}(0) = \\{0\\}$\n- $\\mathrm{Dom}(1) = \\{1\\} \\cup \\mathrm{Dom}(0) = \\{0, 1\\}$\n- $\\mathrm{Dom}(2) = \\{2\\} \\cup (\\mathrm{Dom}(1) \\cap \\mathrm{Dom}(8)) = \\{0, 1, 2\\}$\n- $\\mathrm{Dom}(3) = \\{3\\} \\cup \\mathrm{Dom}(2) = \\{0, 1, 2, 3\\}$\n- $\\mathrm{Dom}(4) = \\{4\\} \\cup (\\mathrm{Dom}(3) \\cap \\mathrm{Dom}(6)) = \\{0, 1, 2, 3, 4\\}$\n- $\\mathrm{Dom}(5) = \\{5\\} \\cup \\mathrm{Dom}(4) = \\{0, 1, 2, 3, 4, 5\\}$\n- $\\mathrm{Dom}(6) = \\{6\\} \\cup \\mathrm{Dom}(5) = \\{0, 1, 2, 3, 4, 5, 6\\}$\n- $\\mathrm{Dom}(7) = \\{7\\} \\cup \\mathrm{Dom}(4) = \\{0, 1, 2, 3, 4, 7\\}$\n- $\\mathrm{Dom}(8) = \\{8\\} \\cup \\mathrm{Dom}(7) = \\{0, 1, 2, 3, 4, 7, 8\\}$\n- $\\mathrm{Dom}(9) = \\{9\\} \\cup \\mathrm{Dom}(2) = \\{0, 1, 2, 9\\}$\n- $\\mathrm{Dom}(10) = \\{10\\} \\cup \\mathrm{Dom}(9) = \\{0, 1, 2, 9, 10\\}$\n\n从这些集合中，我们可以确定每个节点 $n \\ne 0$ 的直接支配点 $\\mathrm{idom}(n)$。直接支配点是 $n$ 的唯一支配点，它被 $n$ 的所有其他支配点所支配。\n- $\\mathrm{idom}(1) = 0$\n- $\\mathrm{idom}(2) = 1$\n- $\\mathrm{idom}(3) = 2$\n- $\\mathrm{idom}(4) = 3$\n- $\\mathrm{idom}(5) = 4$\n- $\\mathrm{idom}(6) = 5$\n- $\\mathrm{idom}(7) = 4$\n- $\\mathrm{idom}(8) = 7$\n- $\\mathrm{idom}(9) = 2$\n- $\\mathrm{idom}(10) = 9$\n\n### 步骤 3：计算支配边界\n\n节点 $n$ 的支配边界，表示为 $\\mathrm{DF}(n)$，是所有节点 $y$ 的集合，使得 $n$ 支配 $y$ 的一个直接前驱节点，但 $n$ 并不严格支配 $y$。如果 $n \\text{ dom } y$ 且 $n \\neq y$，则称节点 $n$ 严格支配 $y$（记作 $n \\text{ sdom } y$）。其形式化定义为：\n$$ \\mathrm{DF}(n) = \\{ y \\mid (\\exists p \\in \\mathrm{preds}(y)) (n \\text{ dom } p) \\land \\neg(n \\text{ sdom } y) \\} $$\n\n我们应用此定义来计算 $\\mathrm{DF}(4)$ 和 $\\mathrm{DF}(5)$。\n\n**$\\mathrm{DF}(4)$ 的计算：**\n我们需要找到所有满足以下条件的节点 $y$：对于 $y$ 的某个前驱节点 $p$，$4 \\text{ dom } p$ 且 $4$ 不严格支配 $y$。\n被 $4$ 支配的节点集合是 $\\{4, 5, 6, 7, 8\\}$。我们检查这些节点的后继节点。\n- $4$ 的后继节点：$\\{5, 7\\}$。\n  - 对于 $y=5$，$p=4$。$4 \\text{ dom } 4$ 为真。但 $4 \\text{ sdom } 5$ 也为真，所以 $5 \\notin \\mathrm{DF}(4)$。\n  - 对于 $y=7$，$p=4$。$4 \\text{ dom } 4$ 为真。但 $4 \\text{ sdom } 7$ 也为真，所以 $7 \\notin \\mathrm{DF}(4)$。\n- $5$ 的后继节点：$\\{6\\}$。\n  - 对于 $y=6$，$p=5$。$4 \\text{ dom } 5$ 为真。但 $4 \\text{ sdom } 6$ 也为真，所以 $6 \\notin \\mathrm{DF}(4)$。\n- $6$ 的后继节点：$\\{4\\}$。\n  - 对于 $y=4$，$p=6$。$4 \\text{ dom } 6$ 为真。$4$ 是否严格支配 $4$？否。因此，$\\neg(4 \\text{ sdom } 4)$ 为真。所以，$4 \\in \\mathrm{DF}(4)$。\n- $7$ 的后继节点：$\\{8\\}$。\n  - 对于 $y=8$，$p=7$。$4 \\text{ dom } 7$ 为真。但 $4 \\text{ sdom } 8$ 也为真，所以 $8 \\notin \\mathrm{DF}(4)$。\n- $8$ 的后继节点：$\\{2\\}$。\n  - 对于 $y=2$，$p=8$。$4 \\text{ dom } 8$ 为真。$4$ 是否严格支配 $2$？否，实际上是 $2$ 支配 $4$。因此，$\\neg(4 \\text{ sdom } 2)$ 为真。所以，$2 \\in \\mathrm{DF}(4)$。\n\n综合这些结果，节点 $4$ 的支配边界是 $\\mathrm{DF}(4) = \\{2, 4\\}$。\n\n**$\\mathrm{DF}(5)$ 的计算：**\n我们对节点 $5$ 应用相同的过程。\n被 $5$ 支配的节点集合是 $\\{5, 6\\}$。我们检查这些节点的后继节点。\n- $5$ 的后继节点：$\\{6\\}$。\n  - 对于 $y=6$，$p=5$。$5 \\text{ dom } 5$ 为真。但 $5 \\text{ sdom } 6$ 也为真，所以 $6 \\notin \\mathrm{DF}(5)$。\n- $6$ 的后继节点：$\\{4\\}$。\n  - 对于 $y=4$，$p=6$。$5 \\text{ dom } 6$ 为真。$5$ 是否严格支配 $4$？否，$4$ 支配 $5$。因此，$\\neg(5 \\text{ sdom } 4)$ 为真。所以，$4 \\in \\mathrm{DF}(5)$。\n\n节点 $5$ 的支配边界是 $\\mathrm{DF}(5) = \\{4\\}$。\n\n### 步骤 4：最终计算\n\n问题要求计算 $S$ 的值，定义如下：\n$$ S = \\sum_{n \\in \\mathrm{DF}(4)} n \\;+\\; 10 \\times \\sum_{m \\in \\mathrm{DF}(5)} m $$\n代入计算出的支配边界：\n$$ S = \\sum_{n \\in \\{2, 4\\}} n \\;+\\; 10 \\times \\sum_{m \\in \\{4\\}} m $$\n$$ S = (2 + 4) + 10 \\times (4) $$\n$$ S = 6 + 40 $$\n$$ S = 46 $$\n最终结果是一个精确整数。", "answer": "$$\n\\boxed{46}\n$$", "id": "3638564"}, {"introduction": "现在，让我们来看支配边界最重要的应用。支配边界不仅是一个理论概念，它还是构建静态单赋值（SSA）形式的核心机制。本练习将引导你完成从计算图中节点的支配边界，到使用迭代支配边界（$DF^+$）来精确确定为不同变量插入$\\phi$函数位置的完整过程。[@problem_id:3638894]", "problem": "考虑一个控制流图 (CFG)，其节点为 $E$、$B$、$L$、$R$、$J$、$B_2$、$L_2$、$R_2$、$J_2$ 和 $X$。有向边如下：\n$E \\to B$、$B \\to L$、$B \\to R$、$L \\to J$、$R \\to J$、$J \\to B_2$、$B_2 \\to L_2$、$B_2 \\to R_2$、$L_2 \\to J_2$、$R_2 \\to J_2$ 和 $J_2 \\to X$。该 CFG 形成了两个串联的菱形区域。\n\n使用以下编译原理中的基本定义：\n- 如果从入口节点到节点 $n$ 的每条路径都包含节点 $d$，则称节点 $d$ 支配节点 $n$。如果 $d \\neq n$，则 $d$ 严格支配 $n$。\n- 一个节点 $n$ 的支配边界 $DF(n)$ 是所有节点 $y$ 的集合，其中存在 $y$ 的一个前驱节点 $p$，$n$ 支配 $p$，但 $n$ 并不严格支配 $y$。\n- 静态单赋值 (SSA) 形式是一种表示形式，其中每个变量只被赋值一次，并且在汇合点使用 $\\phi$-函数来合并来自多个前驱的值。使用 Cytron 等人的 SSA 构造算法，不进行基于活跃度的剪枝：对于每个变量，在其定义点集合的迭代支配边界中的节点上放置 $\\phi$-函数，直到达到不动点。\n\n任务：\n1. 计算每个节点 $n \\in \\{E, B, L, R, J, B_2, L_2, R_2, J_2, X\\}$ 的支配边界 $DF(n)$。\n2. 假设有 3 个标量变量 $x$、$y$ 和 $w$ 的定义如下：\n   - $x$ 在 $L$ 和 $R$ 中定义。\n   - $y$ 在 $L_2$ 和 $R_2$ 中定义。\n   - $w$ 在 $R$ 和 $L_2$ 中定义。\n   使用上述 SSA 构造方法，通过计算其定义点的迭代支配边界，确定为每个变量放置 $\\phi$-函数的位置。\n3. 所有三个变量总共插入了多少个 $\\phi$-函数？请以单个整数形式提供最终答案。无需四舍五入。[@problem_id:101]", "solution": "该问题要求对给定的控制流图 (CFG)进行分析，以根据 Cytron 等人提出的静态单赋值 (SSA) 构造算法确定 $\\phi$-函数的位置。这包括三个主要步骤：首先，确定图中所有节点的支配边界；其次，利用这些信息为三个特定变量的定义点找到迭代支配边界；第三，计算所需的 $\\phi$-函数总数。\n\n该 CFG 的节点集为 $N = \\{E, B, L, R, J, B_2, L_2, R_2, J_2, X\\}$，有向边集为 $A = \\{ (E,B), (B,L), (B,R), (L,J), (R,J), (J,B_2), (B_2,L_2), (B_2,R_2), (L_2,J_2), (R_2,J_2), (J_2,X) \\}$。节点 $E$ 是该图唯一的入口节点，因为其入度为 $0$。\n\n首先，我们必须确定支配关系。如果从入口节点 $E$ 到节点 $n$ 的每条路径都包含节点 $d$，则称节点 $d$ 支配节点 $n$，记作 $d \\text{ dom } n$。如果 $d \\text{ dom } n$ 且 $d \\neq n$，则称节点 $d$ 严格支配节点 $n$，记作 $d \\text{ sdom } n$。一个节点 $n$ 的直接支配者，记为 $\\text{idom}(n)$，是指 $n$ 的严格支配者中被所有其他 $n$ 的严格支配者所支配的那一个。\n\n通过分析从 $E$ 出发的所有路径，我们建立以下直接支配关系：\n- $\\text{idom}(B) = E$\n- $\\text{idom}(L) = B$\n- $\\text{idom}(R) = B$\n- $\\text{idom}(J) = B$。这是因为任何到达 $J$ 的路径都必须经过 $B$，而路径 $E \\to B \\to L \\to J$ 和 $E \\to B \\to R \\to J$ 表明 $L$ 和 $R$ 都不支配 $J$。\n- $\\text{idom}(B_2) = J$\n- $\\text{idom}(L_2) = B_2$\n- $\\text{idom}(R_2) = B_2$\n- $\\text{idom}(J_2) = B_2$。与 $J$ 类似，任何到达 $J_2$ 的路径都必须经过 $B_2$，但不一定经过 $L_2$ 或 $R_2$。\n- $\\text{idom}(X) = J_2$\n\n支配树（表示直接支配关系）可以由这些关系构建。$E$ 是根节点。任何节点 $d$ 的子节点是所有满足 $\\text{idom}(n) = d$ 的节点 $n$。\n\n**任务 1：计算每个节点的支配边界 $DF(n)$**\n\n一个节点 $n$ 的支配边界 $\\text{DF}(n)$ 是所有节点 $y$ 的集合，使得 $n$ 支配 $y$ 的一个前驱节点 $p$，但 $n$ 并不严格支配 $y$。我们将此定义应用于每个节点 $n \\in N$。\n\n- $\\text{DF}(L)$: 唯一被 $L$（及其支配者）支配的节点只有 $L$ 自身。从 $L$ 出发的唯一一条边是 $L \\to J$。这里，前驱节点 $p$ 是 $L$，后继节点 $y$ 是 $J$。我们检查条件：$L \\text{ dom } L$，但 $L$ 并不严格支配 $J$ (因为 $\\text{idom}(J) = B$)。因此，$J \\in \\text{DF}(L)$。所以，$\\text{DF}(L) = \\{J\\}$。\n- $\\text{DF}(R)$: 根据与 $L$ 对称的推理，边 $R \\to J$ 导致 $J \\in \\text{DF}(R)$。所以，$\\text{DF}(R) = \\{J\\}$。\n- $\\text{DF}(L_2)$: 边是 $L_2 \\to J_2$。前驱节点是 $p=L_2$，后继节点是 $y=J_2$。我们检查：$L_2 \\text{ dom } L_2$，但 $L_2$ 并不严格支配 $J_2$ (因为 $\\text{idom}(J_2) = B_2$) 。因此，$J_2 \\in \\text{DF}(L_2)$。所以，$\\text{DF}(L_2) = \\{J_2\\}$。\n- $\\text{DF}(R_2)$: 根据与 $L_2$ 对称的推理，边 $R_2 \\to J_2$ 导致 $J_2 \\in \\text{DF}(R_2)$。所以，$\\text{DF}(R_2) = \\{J_2\\}$。\n- 对于所有其他节点 $n \\in \\{E, B, J, B_2, J_2, X\\}$，任何边 $(p, y)$，如果 $n \\text{ dom } p$，那么也必然有 $n \\text{ sdom } y$。例如，考虑 $n=J$。$J$ 支配 $J, B_2, L_2, R_2, J_2$ 和 $X$。任何从这些节点之一出发的边（例如，$J \\to B_2$ 或 $L_2 \\to J_2$）都会指向一个同样被 $J$ 严格支配的节点。因此，它们的支配边界是空集。\n- $\\text{DF}(E) = \\emptyset$\n- $\\text{DF}(B) = \\emptyset$\n- $\\text{DF}(J) = \\emptyset$\n- $\\text{DF}(B_2) = \\emptyset$\n- $\\text{DF}(J_2) = \\emptyset$\n- $\\text{DF}(X) = \\emptyset$ (没有出边)\n\n总结任务 1，非空的支配边界是：\n$\\text{DF}(L) = \\{J\\}$\n$\\text{DF}(R) = \\{J\\}$\n$\\text{DF}(L_2) = \\{J_2\\}$\n$\\text{DF}(R_2) = \\{J_2\\}$\n\n**任务 2：确定变量 $x$、$y$ 和 $w$ 的 $\\phi$-函数放置位置**\n\nCytron 等人的算法指出，一个变量的 $\\phi$-函数被放置在包含该变量定义的节点集 $S$ 的迭代支配边界 $DF^{+}(S)$ 中的每个节点上。迭代支配边界是通过重复计算原始定义点与前一轮迭代中找到的节点的并集的支配边界来计算的，直到达到不动点。\n令 $\\Phi$ 为放置 $\\phi$-函数的节点集合。\n\n- **变量 $x$**: 在 $S_x = \\{L, R\\}$ 中定义。\n我们计算 $DF^+(S_x)$。\n需要计算其边界的初始节点集合是 $S_x$。\n$\\text{DF}(S_x) = \\text{DF}(L) \\cup \\text{DF}(R) = \\{J\\} \\cup \\{J\\} = \\{J\\}$。\n所以，我们必须在节点 $J$ 处为变量 $x$ 放置一个 $\\phi$-函数，因此 $\\Phi_x = \\{J\\}$。\n现在我们进行迭代：我们为新的“定义”集合 $S_x \\cup \\Phi_x = \\{L, R, J\\}$ 计算 DF。\n$\\text{DF}(L) \\cup \\text{DF}(R) \\cup \\text{DF}(J) = \\{J\\} \\cup \\{J\\} \\cup \\emptyset = \\{J\\}$。\n$\\phi$-函数的位置集合没有改变。已达到不动点。\n为 $x$ 放置 $\\phi$-函数的节点集合是 $\\Phi_x = \\{J\\}$。这需要 1 个 $\\phi$-函数。\n\n- **变量 $y$**: 在 $S_y = \\{L_2, R_2\\}$ 中定义。\n我们计算 $DF^+(S_y)$。\n$\\text{DF}(S_y) = \\text{DF}(L_2) \\cup \\text{DF}(R_2) = \\{J_2\\} \\cup \\{J_2\\} = \\{J_2\\}$。\n所以，我们必须在节点 $J_2$ 处为变量 $y$ 放置一个 $\\phi$-函数，因此 $\\Phi_y = \\{J_2\\}$。\n现在我们进行迭代：我们为 $\\{L_2, R_2, J_2\\}$ 计算 DF。\n$\\text{DF}(L_2) \\cup \\text{DF}(R_2) \\cup \\text{DF}(J_2) = \\{J_2\\} \\cup \\{J_2\\} \\cup \\emptyset = \\{J_2\\}$。\n已达到不动点。\n为 $y$ 放置 $\\phi$-函数的节点集合是 $\\Phi_y = \\{J_2\\}$。这需要 1 个 $\\phi$-函数。\n\n- **变量 $w$**: 在 $S_w = \\{R, L_2\\}$ 中定义。\n我们计算 $DF^+(S_w)$。\n$\\text{DF}(S_w) = \\text{DF}(R) \\cup \\text{DF}(L_2) = \\{J\\} \\cup \\{J_2\\} = \\{J, J_2\\}$。\n所以，我们必须在节点 $J$ 和 $J_2$ 处为变量 $w$ 放置 $\\phi$-函数，因此 $\\Phi_w = \\{J, J_2\\}$。\n现在我们进行迭代：我们为 $\\{R, L_2, J, J_2\\}$ 计算 DF。\n$\\text{DF}(R) \\cup \\text{DF}(L_2) \\cup \\text{DF}(J) \\cup \\text{DF}(J_2) = \\{J\\} \\cup \\{J_2\\} \\cup \\emptyset \\cup \\emptyset = \\{J, J_2\\}$。\n已达到不动点。\n为 $w$ 放置 $\\phi$-函数的节点集合是 $\\Phi_w = \\{J, J_2\\}$。这需要 2 个 $\\phi$-函数。\n\n**任务 3：计算 $\\phi$-函数的总数**\n\n$\\phi$-函数的总数是为每个变量插入的 $\\phi$-函数数量之和。\n$x$ 的数量：$|\\Phi_x| = |\\{J\\}| = 1$。\n$y$ 的数量：$|\\Phi_y| = |\\{J_2\\}| = 1$。\n$w$ 的数量：$|\\Phi_w| = |\\{J, J_2\\}| = 2$。\n\n$\\phi$-函数总数 = $1 + 1 + 2 = 4$。", "answer": "$$\n\\boxed{4}\n$$", "id": "3638894"}]}