{"hands_on_practices": [{"introduction": "主成分分析的核心在于对协方差矩阵进行特征分解。这个练习将引导你亲手完成这一过程，从一个给定的协方差矩阵出发，通过解析计算来求解其特征值和特征向量。这不仅仅是一次数学计算，更重要的是，它将帮助你理解主成分的载荷（即特征向量的元素）是如何揭示变量间的“平均”效应和“对比”效应的，从而将抽象的线性代数概念与具体的数据结构联系起来。[@problem_id:3161250]", "problem": "给定一个中心化的三变量数据集，其模型为一个零均值随机向量 $X = (X_{1}, X_{2}, X_{3})^{\\top}$，其总体协方差矩阵已知\n$$\n\\Sigma \\;=\\; \\begin{pmatrix}\n1  \\tfrac{1}{2}  \\tfrac{1}{2} \\\\\n\\tfrac{1}{2}  1  \\tfrac{1}{2} \\\\\n\\tfrac{1}{2}  \\tfrac{1}{2}  1\n\\end{pmatrix}.\n$$\n这描述了三个具有共同正相关性的标准化测量值。请仅使用协方差的定义、对称矩阵的基本原理，以及主成分分析（PCA）是协方差矩阵的特征分解这一特性，完成以下任务：\n\n1. 解析地计算 $\\Sigma$ 的特征值和一组对应的标准正交特征向量。\n2. 将成分载荷定义为 $\\Sigma$ 的单位范数特征向量的元素，并从变量间的“平均”与“对比”角度解释每个特征向量，说明载荷的符号和相对大小如何编码这些概念。\n3. 最后，计算由“平均”成分（即对所有三个变量赋予相等正权重的成分）所解释的总方差的精确比例。将此最终比例表示为最简精确有理数形式。无需四舍五入。\n\n最终答案仅需陈述此最终比例。请勿在最终答案中包含任何单位或附加文本。", "solution": "问题要求计算在一个三变量系统的主成分分析（PCA）中，由“平均”成分所解释的总方差的比例。该系统由一个零均值随机向量 $X = (X_{1}, X_{2}, X_{3})^{\\top}$ 及其给定的总体协方差矩阵 $\\Sigma$ 描述。\n\n首先，我们验证问题的陈述。给定的是随机向量 $X$ 及其协方差矩阵\n$$\n\\Sigma \\;=\\; \\begin{pmatrix}\n1  \\tfrac{1}{2}  \\tfrac{1}{2} \\\\\n\\tfrac{1}{2}  1  \\tfrac{1}{2} \\\\\n\\tfrac{1}{2}  \\tfrac{1}{2}  1\n\\end{pmatrix}.\n$$\n问题指明，PCA应被理解为该协方差矩阵的特征分解。任务是找到特征值和特征向量，对它们进行解释，并计算一个特定的方差比例。该问题在标准多元统计学中有科学依据，提法明确，提供了所有必要信息，并且陈述客观。矩阵 $\\Sigma$ 是对称的，并且（我们将证明）是正定的，这使其成为一个有效的协方差矩阵。因此，该问题是有效的。\n\n我们按要求分三部分进行求解。\n\n第1部分：计算 $\\Sigma$ 的特征值和标准正交特征向量。\n主成分是协方差矩阵 $\\Sigma$ 的特征向量，其方差是对应的特征值。我们通过求解特征方程 $\\det(\\Sigma - \\lambda I) = 0$ 来找到特征值 $\\lambda$，其中 $I$ 是 $3 \\times 3$ 单位矩阵。\n$$\n\\det \\begin{pmatrix}\n1-\\lambda  \\tfrac{1}{2}  \\tfrac{1}{2} \\\\\n\\tfrac{1}{2}  1-\\lambda  \\tfrac{1}{2} \\\\\n\\tfrac{1}{2}  \\tfrac{1}{2}  1-\\lambda\n\\end{pmatrix} = 0\n$$\n展开行列式，我们得到：\n$$\n(1-\\lambda)\\left( (1-\\lambda)^2 - \\left(\\frac{1}{2}\\right)^2 \\right) - \\frac{1}{2}\\left( \\frac{1}{2}(1-\\lambda) - \\frac{1}{4} \\right) + \\frac{1}{2}\\left( \\frac{1}{4} - \\frac{1}{2}(1-\\lambda) \\right) = 0\n$$\n$$\n(1-\\lambda)\\left(\\lambda^2 - 2\\lambda + 1 - \\frac{1}{4}\\right) - \\frac{1}{2}\\left(\\frac{1}{4} - \\frac{\\lambda}{2}\\right) + \\frac{1}{2}\\left(-\\frac{1}{4} + \\frac{\\lambda}{2}\\right) = 0\n$$\n$$\n(1-\\lambda)(\\lambda^2 - 2\\lambda + \\frac{3}{4}) - \\frac{1}{8} + \\frac{\\lambda}{4} - \\frac{1}{8} + \\frac{\\lambda}{4} = 0\n$$\n$$\n\\lambda^2 - 2\\lambda + \\frac{3}{4} - \\lambda^3 + 2\\lambda^2 - \\frac{3}{4}\\lambda - \\frac{1}{4} + \\frac{\\lambda}{2} = 0\n$$\n$$\n-\\lambda^3 + 3\\lambda^2 - \\left(2 + \\frac{3}{4} - \\frac{1}{2}\\right)\\lambda + \\left(\\frac{3}{4} - \\frac{1}{4}\\right) = 0\n$$\n$$\n-\\lambda^3 + 3\\lambda^2 - \\frac{9}{4}\\lambda + \\frac{1}{2} = 0\n$$\n两边乘以 $-4$ 得到一个更简洁的多项式：\n$$\n4\\lambda^3 - 12\\lambda^2 + 9\\lambda - 2 = 0\n$$\n通过观察或有理根定理，我们可以测试可能的根。我们来测试 $\\lambda=2$：$4(2)^3 - 12(2)^2 + 9(2) - 2 = 32 - 48 + 18 - 2 = 0$。所以，$\\lambda=2$ 是一个根。\n我们来测试 $\\lambda=1/2$：$4(\\frac{1}{2})^3 - 12(\\frac{1}{2})^2 + 9(\\frac{1}{2}) - 2 = 4(\\frac{1}{8}) - 12(\\frac{1}{4}) + \\frac{9}{2} - 2 = \\frac{1}{2} - 3 + \\frac{9}{2} - 2 = \\frac{10}{2} - 5 = 0$。所以，$\\lambda=1/2$ 也是一个根。\n由于 $(\\lambda-2)$ 是多项式的一个因子，我们可以进行多项式除法，得到：\n$$\n(\\lambda-2)(4\\lambda^2 - 4\\lambda + 1) = 0\n$$\n这个二次因子是一个完全平方：$4\\lambda^2 - 4\\lambda + 1 = (2\\lambda - 1)^2$。\n因此，特征方程为 $(\\lambda-2)(2\\lambda-1)^2 = 0$。\n特征值为 $\\lambda_1 = 2$（重数为 $1$）和 $\\lambda_2 = \\lambda_3 = \\frac{1}{2}$（重数为 $2$）。\n\n现在，我们求一组标准正交特征向量。\n对于 $\\lambda_1 = 2$：我们求解 $(\\Sigma - 2I)v = 0$。\n$$\n\\begin{pmatrix} -1  \\tfrac{1}{2}  \\tfrac{1}{2} \\\\ \\tfrac{1}{2}  -1  \\tfrac{1}{2} \\\\ \\tfrac{1}{2}  \\tfrac{1}{2}  -1 \\end{pmatrix} \\begin{pmatrix} v_1 \\\\ v_2 \\\\ v_3 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n该线性方程组简化为 $v_1 = v_2 = v_3$。一个未归一化的特征向量是 $(1, 1, 1)^{\\top}$。为了获得单位范数特征向量 $u_1$，我们将其除以其范数 $\\sqrt{1^2+1^2+1^2} = \\sqrt{3}$。\n$$ u_1 = \\begin{pmatrix} 1/\\sqrt{3} \\\\ 1/\\sqrt{3} \\\\ 1/\\sqrt{3} \\end{pmatrix} $$\n\n对于 $\\lambda_2 = \\lambda_3 = \\frac{1}{2}$：我们求解 $(\\Sigma - \\frac{1}{2}I)v = 0$。\n$$\n\\begin{pmatrix} \\tfrac{1}{2}  \\tfrac{1}{2}  \\tfrac{1}{2} \\\\ \\tfrac{1}{2}  \\tfrac{1}{2}  \\tfrac{1}{2} \\\\ \\tfrac{1}{2}  \\tfrac{1}{2}  \\tfrac{1}{2} \\end{pmatrix} \\begin{pmatrix} v_1 \\\\ v_2 \\\\ v_3 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n这简化为单个方程 $v_1 + v_2 + v_3 = 0$。这描述了一个二维特征空间（一个平面），它与特征向量 $u_1$ 正交，这对于对称矩阵是符合预期的。我们需要找到这个平面的一个标准正交基。\n我们选择一个满足条件的简单向量，例如 $v' = (1, -1, 0)^{\\top}$。将其归一化得到我们的第二个特征向量 $u_2$：\n$$ u_2 = \\frac{1}{\\sqrt{1^2+(-1)^2+0^2}} \\begin{pmatrix} 1 \\\\ -1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1/\\sqrt{2} \\\\ -1/\\sqrt{2} \\\\ 0 \\end{pmatrix} $$\n对于第三个特征向量 $u_3$，它必须在同一个平面内（$u_{3,1}+u_{3,2}+u_{3,3}=0$），并且与 $u_2$ 正交（$u_2 \\cdot u_3 = 0$）。正交性条件给出 $\\frac{1}{\\sqrt{2}}u_{3,1} - \\frac{1}{\\sqrt{2}}u_{3,2} = 0$，这意味着 $u_{3,1} = u_{3,2}$。将此代入平面方程得到 $2u_{3,1} + u_{3,3} = 0$，即 $u_{3,3} = -2u_{3,1}$。因此，任何这样的向量都具有 $(c, c, -2c)^{\\top}$ 的形式。我们将其归一化以找到 $u_3$：\n$$ u_3 = \\frac{1}{\\sqrt{c^2+c^2+(-2c)^2}} \\begin{pmatrix} c \\\\ c \\\\ -2c \\end{pmatrix} = \\frac{1}{\\sqrt{6c^2}} \\begin{pmatrix} c \\\\ c \\\\ -2c \\end{pmatrix} = \\begin{pmatrix} 1/\\sqrt{6} \\\\ 1/\\sqrt{6} \\\\ -2/\\sqrt{6} \\end{pmatrix} $$\n\n第2部分：解释特征向量。\n特征向量是主成分，其元素是“载荷”。\n- 第一个主成分，对应于 $u_1=(1/\\sqrt{3}, 1/\\sqrt{3}, 1/\\sqrt{3})^{\\top}$，在所有三个变量上都有相等的正载荷。这个成分代表了变量的加权平均值，$Z_1 = \\frac{1}{\\sqrt{3}}(X_1+X_2+X_3)$，捕捉了它们协同变化的趋势。这就是问题中提到的“平均”成分。\n- 第二和第三个主成分，$u_2$ 和 $u_3$，同时具有正载荷和负载荷。它们代表“对比”。例如，$u_2=(1/\\sqrt{2}, -1/\\sqrt{2}, 0)^{\\top}$ 捕捉了 $X_1$ 和 $X_2$ 之间的差异。$u_3=(1/\\sqrt{6}, 1/\\sqrt{6}, -2/\\sqrt{6})^{\\top}$ 捕捉了 $X_1$ 和 $X_2$ 的平均值与 $X_3$ 之间的对比。\n\n第3部分：计算所解释的总方差的比例。\n数据集中的总方差是各个变量方差之和，即协方差矩阵 $\\Sigma$ 的迹。\n$$ \\text{总方差} = \\text{tr}(\\Sigma) = 1 + 1 + 1 = 3 $$\n这个和也必须等于特征值之和：$\\sum_{i=1}^3 \\lambda_i = 2 + \\frac{1}{2} + \\frac{1}{2} = 3$，这是一致的。\n每个主成分所解释的方差是其对应的特征值。“平均”成分是第一个主成分，其方差为 $\\lambda_1 = 2$。\n由“平均”成分所解释的总方差的比例是其方差与总方差的比值：\n$$ \\text{方差比例} = \\frac{\\lambda_1}{\\text{tr}(\\Sigma)} = \\frac{2}{3} $$\n这是一个最简形式的精确有理数。", "answer": "$$\\boxed{\\frac{2}{3}}$$", "id": "3161250"}, {"introduction": "现实世界的数据集常常包含高度相关甚至冗余的变量。这个练习通过一个包含重复变量的特设场景，让你探究主成分分析如何处理这种多重共线性问题。通过分析载荷如何在重复的变量间分配权重，以及这对主成分方差（即特征值）的影响，你将深刻理解为何PCA有时会将影响力“分散”到多个相关变量中，以及这种冗余信息是如何被“放大”的。[@problem_id:3161240]", "problem": "考虑具有三个特征 $x_1$、$x_2$ 和 $x_3$ 的中心化数据。假设 $x_2$ 是 $x_1$ 的一个精确副本（因此对于每个观测值都有 $x_2 = x_1$）。经验方差和协方差如下：$\\mathrm{Var}(x_1) = \\mathrm{Var}(x_2) = 4$，$\\mathrm{Cov}(x_1,x_2) = 4$，$\\mathrm{Var}(x_3) = 1$，以及 $\\mathrm{Cov}(x_1,x_3) = \\mathrm{Cov}(x_2,x_3) = 1$。令 $S$ 表示与特征向量 $(x_1,x_2,x_3)^\\top$ 对应的 $3 \\times 3$ 协方差矩阵。\n\n根据主成分分析（PCA）的定义，第一个载荷向量 $w_1$ 是使投影数据的方差最大化的单位向量，即在 $\\lVert w \\rVert_2 = 1$ 的约束下最大化 $w^\\top S w$，并且相关的最大值是 $S$ 的最大特征值 $\\lambda_1$。\n\n哪个陈述最能描述第一个载荷向量 $w_1$ 如何在重复变量 $x_1$ 和 $x_2$ 之间分配权重，以及与仅使用 $(x_1,x_3)$ 的情况（即不包括重复的 $x_2$）相比，重复对主特征值有何影响？\n\nA. 第一个载荷对 $x_1$ 和 $x_2$ 分配了相等的正权重（其前两个分量相等），最大主成分方差约为 $8.27$，这严格大于没有重复时的最高方差（约为 $4.30$）。\n\nB. 第一个载荷对 $x_1$ 和 $x_2$ 分配了相等但符号相反的权重，并且最大主成分方差不受重复的影响而改变。\n\nC. 第一个载荷将其所有权重都放在 $x_3$ 上，因为重复引入了一个零方差方向，并且最大主成分方差减小到约 $1.00$。\n\nD. 第一个载荷将其所有权重都放在 $x_1$ 上而忽略 $x_2$，从而得到与仅有 $(x_1,x_3)$ 的非重复情况下相同的最大主成分方差。", "solution": "用户希望我解决一个关于主成分分析（PCA）的问题。\n\n### 第 1 步：提取已知条件\n- 数据是中心化的。\n- 特征是 $x_1$，$x_2$，$x_3$。\n- $x_2$ 是 $x_1$ 的副本：$x_2 = x_1$。\n- 方差：$\\mathrm{Var}(x_1) = 4$，$\\mathrm{Var}(x_2) = 4$，$\\mathrm{Var}(x_3) = 1$。\n- 协方差：$\\mathrm{Cov}(x_1,x_2) = 4$，$\\mathrm{Cov}(x_1,x_3) = 1$，$\\mathrm{Cov}(x_2,x_3) = 1$。\n- $S$ 是 $(x_1, x_2, x_3)^\\top$ 的 $3 \\times 3$ 协方差矩阵。\n- 第一个载荷向量 $w_1$ 是最大化 $w^\\top S w$ 的单位向量。\n- 最大特征值 $\\lambda_1$ 是在 $\\lVert w \\rVert_2 = 1$ 约束下 $w^\\top S w$ 的最大值。\n- 问题要求描述第一个载荷向量 $w_1$（特别是它对 $x_1$ 和 $x_2$ 的权重）以及与仅有 $(x_1, x_3)$ 的情况相比，重复对最大特征值 $\\lambda_1$ 的影响。\n\n### 第 2 步：使用提取的已知条件进行验证\n问题陈述在科学上基于 PCA 理论，这是统计学中的一种标准方法。所提供的定义是正确的。指定的数据在内部是一致的。例如，给定 $x_2 = x_1$，可以得出 $\\mathrm{Var}(x_2) = \\mathrm{Var}(x_1) = 4$ 且 $\\mathrm{Cov}(x_1, x_2) = \\mathrm{Cov}(x_1, x_1) = \\mathrm{Var}(x_1) = 4$。此外，$\\mathrm{Cov}(x_2, x_3) = \\mathrm{Cov}(x_1, x_3) = 1$。所有这些一致性在已知条件中都成立。这个问题是适定问题，因为它要求一个特定对称矩阵的最大特征值和相应特征向量的性质，这是一个可解的数学问题。语言是客观和精确的。问题是有效的。\n\n### 第 3 步：求解推导\n\n该问题需要进行两部分分析：首先，分析包含重复变量的完整 $3$ 特征情况；其次，分析简化的 $2$ 特征情况以进行比较。\n\n**第 1 部分：分析具有特征 $(x_1, x_2, x_3)$ 的 $3 \\times 3$ 系统**\n\n协方差矩阵 $S$ 由给定的方差和协方差构成。元素 $S_{ij}$ 是 $\\mathrm{Cov}(x_i, x_j)$。\n$$\nS = \\begin{pmatrix}\n\\mathrm{Var}(x_1)  \\mathrm{Cov}(x_1, x_2)  \\mathrm{Cov}(x_1, x_3) \\\\\n\\mathrm{Cov}(x_2, x_1)  \\mathrm{Var}(x_2)  \\mathrm{Cov}(x_2, x_3) \\\\\n\\mathrm{Cov}(x_3, x_1)  \\mathrm{Cov}(x_3, x_2)  \\mathrm{Var}(x_3)\n\\end{pmatrix}\n= \\begin{pmatrix}\n4  4  1 \\\\\n4  4  1 \\\\\n1  1  1\n\\end{pmatrix}\n$$\n为了找到主成分，我们需要 $S$ 的特征值和特征向量。特征值 $\\lambda$ 是特征方程 $\\det(S - \\lambda I) = 0$ 的解。\n$$\n\\det \\begin{pmatrix}\n4-\\lambda  4  1 \\\\\n4  4-\\lambda  1 \\\\\n1  1  1-\\lambda\n\\end{pmatrix} = 0\n$$\n由于完全共线性 $x_1 = x_2$，数据位于一个子空间中。存在一个零方差方向，它对应于一个为 $0$ 的特征值。这个方向由表示线性依赖关系的向量 $x_1 - x_2 = 0$ 描述。特征空间中对应的向量是 $v = (1, -1, 0)^\\top$。我们来验证这是一个特征值为 $0$ 的特征向量：\n$$\nS v = \\begin{pmatrix}\n4  4  1 \\\\\n4  4  1 \\\\\n1  1  1\n\\end{pmatrix}\n\\begin{pmatrix}\n1 \\\\ -1 \\\\ 0\n\\end{pmatrix}\n= \\begin{pmatrix}\n4 - 4 + 0 \\\\\n4 - 4 + 0 \\\\\n1 - 1 + 0\n\\end{pmatrix}\n= \\begin{pmatrix}\n0 \\\\ 0 \\\\ 0\n\\end{pmatrix}\n= 0 \\cdot v\n$$\n因此，一个特征值是 $\\lambda_3 = 0$。第一个载荷向量 $w_1$ 对应于*最大*的特征值 $\\lambda_1$。对称矩阵的特征向量是正交的。因此，$w_1$ 必须与 $v=(1, -1, 0)^\\top$ 正交。令 $w_1 = (w_{11}, w_{12}, w_{13})^\\top$。正交条件 $w_1 \\cdot v = 0$ 意味着：\n$$\nw_{11} \\cdot 1 + w_{12} \\cdot (-1) + w_{13} \\cdot 0 = 0 \\implies w_{11} - w_{12} = 0 \\implies w_{11} = w_{12}\n$$\n这直接证明了第一个载荷向量必须为重复的特征 $x_1$ 和 $x_2$ 分配相等的权重。\n\n为了找到最大特征值 $\\lambda_1$，我们可以继续解特征方程。\n$$\n(4-\\lambda)((4-\\lambda)(1-\\lambda)-1) - 4(4(1-\\lambda)-1) + 1(4-(4-\\lambda)) = 0 \\\\\n(4-\\lambda)(\\lambda^2 - 5\\lambda + 3) - 4(3-4\\lambda) + \\lambda = 0 \\\\\n4\\lambda^2 - 20\\lambda + 12 - \\lambda^3 + 5\\lambda^2 - 3\\lambda - 12 + 16\\lambda + \\lambda = 0 \\\\\n-\\lambda^3 + 9\\lambda^2 - 6\\lambda = 0 \\\\\n-\\lambda(\\lambda^2 - 9\\lambda + 6) = 0\n$$\n根是 $\\lambda=0$（如前所述）以及 $\\lambda^2 - 9\\lambda + 6 = 0$ 的根。使用二次公式：\n$$\n\\lambda = \\frac{9 \\pm \\sqrt{(-9)^2 - 4(1)(6)}}{2} = \\frac{9 \\pm \\sqrt{81 - 24}}{2} = \\frac{9 \\pm \\sqrt{57}}{2}\n$$\n三个特征值是 $\\lambda_1 = \\frac{9 + \\sqrt{57}}{2}$，$\\lambda_2 = \\frac{9 - \\sqrt{57}}{2}$ 和 $\\lambda_3 = 0$。\n最大特征值，也就是第一个主成分的方差，是：\n$$\n\\lambda_1 = \\frac{9 + \\sqrt{57}}{2} \\approx \\frac{9 + 7.5498}{2} \\approx 8.2749\n$$\n这个值约为 $8.27$。\n\n对应的特征向量 $w_1$ 具有 $w_{11}=w_{12}$。根据惯例，这些分量将是非零的，并且可以选择为正。因此，第一个载荷向量为 $x_1$ 和 $x_2$ 分配了相等的正权重。\n\n**第 2 部分：分析具有特征 $(x_1, x_3)$ 的 $2 \\times 2$ 系统**\n现在我们考虑没有重复变量 $x_2$ 的情况。特征是 $(x_1, x_3)$。$2 \\times 2$ 的协方差矩阵，我们称之为 $S'$，是：\n$$\nS' = \\begin{pmatrix}\n\\mathrm{Var}(x_1)  \\mathrm{Cov}(x_1, x_3) \\\\\n\\mathrm{Cov}(x_3, x_1)  \\mathrm{Var}(x_3)\n\\end{pmatrix}\n= \\begin{pmatrix}\n4  1 \\\\\n1  1\n\\end{pmatrix}\n$$\n我们通过求解 $\\det(S' - \\lambda' I) = 0$ 来找到 $S'$ 的特征值：\n$$\n\\det \\begin{pmatrix}\n4-\\lambda'  1 \\\\\n1  1-\\lambda'\n\\end{pmatrix} = (4-\\lambda')(1-\\lambda') - 1 = 0 \\\\\n4 - 5\\lambda' + (\\lambda')^2 - 1 = 0 \\\\\n(\\lambda')^2 - 5\\lambda' + 3 = 0\n$$\n使用二次公式：\n$$\n\\lambda' = \\frac{5 \\pm \\sqrt{(-5)^2 - 4(1)(3)}}{2} = \\frac{5 \\pm \\sqrt{25 - 12}}{2} = \\frac{5 \\pm \\sqrt{13}}{2}\n$$\n在这种非重复情况下的最大特征值是：\n$$\n\\lambda'_1 = \\frac{5 + \\sqrt{13}}{2} \\approx \\frac{5 + 3.6056}{2} \\approx 4.3028\n$$\n这个值约为 $4.30$。\n\n**第 3 部分：比较和结论**\n通过比较这两种情况，我们得出：\n1.  对于 $3$ 特征的情况，第一个载荷向量 $w_1$ 的前两个分量相等，$w_{11} = w_{12}$。这些分量可以选择为正。\n2.  在有重复的情况下，最大特征值（第一主成分方差）为 $\\lambda_1 \\approx 8.27$。\n3.  在非重复情况下，最大特征值为 $\\lambda'_1 \\approx 4.30$。\n4.  显然，$\\lambda_1 > \\lambda'_1$。包含重复特征时，第一主成分的方差严格更大。\n\n### 逐项分析选项\n\n**A. 第一个载荷对 $x_1$ 和 $x_2$ 分配了相等的正权重（其前两个分量相等），最大主成分方差约为 $8.27$，这严格大于没有重复时的最高方差（约为 $4.30$）。**\n- 第一个载荷向量的前两个分量相等（$w_{11}=w_{12}$），我们已经证明了这一点。按照惯例，它们可以取正值。这部分是正确的。\n- 最大主成分方差是 $\\lambda_1 \\approx 8.27$。这部分是正确的。\n- 没有重复时的最高方差是 $\\lambda'_1 \\approx 4.30$。这部分是正确的。\n- $8.27$ 严格大于 $4.30$。这部分是正确的。\n- **结论：正确。**\n\n**B. 第一个载荷对 $x_1$ 和 $x_2$ 分配了相等但符号相反的权重，并且最大主成分方差不受重复的影响而改变。**\n- 对 $x_1$ 和 $x_2$ 分配相等但符号相反的权重对应于特征向量 $(1, -1, 0)^\\top$，它与最小的特征值 $\\lambda_3=0$ 相关联，而不是第一个载荷向量。这部分是错误的。\n- 方差并非不变（$\\lambda_1 \\approx 8.27$ 对比 $\\lambda'_1 \\approx 4.30$）。这部分是错误的。\n- **结论：错误。**\n\n**C. 第一个载荷将其所有权重都放在 $x_3$ 上，因为重复引入了一个零方差方向，并且最大主成分方差减小到约 $1.00$。**\n- 一个将所有权重都放在 $x_3$ 上的载荷向量将是 $(0, 0, 1)^\\top$。这不是 $S$ 的一个特征向量。这部分是错误的。\n- 最大方差是 $\\lambda_1 \\approx 8.27$，而不是减小到 $1.00$（即 $\\mathrm{Var}(x_3)$）。这部分是错误的。\n- **结论：错误。**\n\n**D. 第一个载荷将其所有权重都放在 $x_1$ 上而忽略 $x_2$，从而得到与仅有 $(x_1,x_3)$ 的非重复情况下相同的最大主成分方差。**\n- 载荷向量没有忽略 $x_2$；它给予 $x_1$ 和 $x_2$ 相等的权重。这部分是错误的。\n- 最大方差与非重复情况下的不同。这部分是错误的。\n- **结论：错误。**\n\n基于分析，只有选项 A 与推导出的结果一致。", "answer": "$$\\boxed{A}$$", "id": "3161240"}, {"introduction": "在应用主成分分析时，一个关键的实践决策是选择基于协方差矩阵还是相关系数矩阵。这个练习通过一个包含测量误差的生成模型，清晰地揭示了变量的“尺度”（即方差大小）如何影响分析结果。你将通过对比两种方法下的主成分载荷，直观地看到为何基于协方差的PCA可能被高方差变量（即使其方差主要源于噪声）所主导，以及为何标准化（即使用相关系数矩阵）是获得更稳健、更具解释力结果的常用策略。[@problem_id:3161286]", "problem": "考虑两个观测变量 $y_1$ 和 $y_2$，它们由一个共同的潜在信号 $z$ 和独立的测量误差生成。设 $z$ 是一个均值为零、方差为 $\\operatorname{Var}(z)=1$ 的随机变量，并定义 $y_1=z+\\epsilon_1$ 和 $y_2=z+\\epsilon_2$，其中 $\\epsilon_1$ 和 $\\epsilon_2$ 是均值为零、相互独立且独立于 $z$ 的随机变量，其方差分别为 $\\operatorname{Var}(\\epsilon_1)=\\tau_1^2$ 和 $\\operatorname{Var}(\\epsilon_2)=\\tau_2^2$。目标是分析在基于协方差矩阵的主成分分析 (PCA) 中，增加测量误差方差 $\\tau_1^2$ 如何增大了变量 $y_1$ 在第一主成分载荷中的权重，以及为什么基于相关系数矩阵的 PCA 能够缓解这种增大效应。\n\n使用以下基本定义：\n- $(y_1,y_2)$ 的协方差矩阵 $S$ 由下式给出：$S=\\begin{bmatrix}\\operatorname{Var}(y_1)\\operatorname{Cov}(y_1,y_2)\\\\ \\operatorname{Cov}(y_1,y_2)\\operatorname{Var}(y_2)\\end{bmatrix}$。\n- $(y_1,y_2)$ 的相关系数矩阵 $R$ 由下式给出：$R=D^{-1/2}SD^{-1/2}$，其中 $D=\\operatorname{diag}(\\operatorname{Var}(y_1),\\operatorname{Var}(y_2))$。\n- 主成分分析 (PCA) 将所选散布矩阵（对于基于协方差的 PCA 是 $S$，对于基于相关系数的 PCA 是 $R$）的特征向量作为主方向。第一主成分载荷向量是与最大特征值关联的单位范数特征向量。\n- 对于对应于第一主成分的载荷向量 $v$，变量 $y_j$ 的载荷是 $v$ 的第 $j$ 个分量。由于特征向量的定义可以相差一个符号，因此我们使用载荷的绝对值，即 $\\lvert v_j \\rvert$。\n\n设 $\\tau_2^2=0.5$ 为固定值。对于每个测试用例，使用上述模型构建 $S$ 和 $R$，并计算：\n1. 在基于协方差的 PCA 中，变量 $y_1$ 在第一主成分中的载荷大小，记为 $l_1^{\\text{cov}}$。\n2. 在基于相关系数的 PCA 中，变量 $y_1$ 在第一主成分中的载荷大小，记为 $l_1^{\\text{cor}}$。\n3. 比率 $r=\\dfrac{l_1^{\\text{cov}}}{l_1^{\\text{cor}}}$。\n\n您的程序必须在模型所隐含的无限样本极限下精确实现计算，即从 $(\\tau_1^2,\\tau_2^2)$ 解析地计算 $S$ 和 $R$，而不进行任何蒙特卡洛采样。\n\n测试套件：\n- 情况 A (基线): $\\tau_1^2=0.0$。\n- 情况 B (中等误差): $\\tau_1^2=0.5$。\n- 情况 C (大误差): $\\tau_1^2=2.0$。\n- 情况 D (极大误差): $\\tau_1^2=20.0$。\n\n对于每种情况，以浮点数形式输出比率 $r$。您的程序应生成单行输出，其中包含按顺序排列的四个比率，格式为方括号括起来的逗号分隔列表（例如 $[r_A,r_B,r_C,r_D]$）。本问题不涉及物理单位或角度单位。答案是浮点数，必须根据上述定义确定性地计算。", "solution": "我们从生成模型的定义以及协方差和相关性的基本性质开始。潜在信号 $z$ 的方差为 $\\operatorname{Var}(z)=1$，测量误差是独立的，其方差为 $\\operatorname{Var}(\\epsilon_1)=\\tau_1^2$ 和 $\\operatorname{Var}(\\epsilon_2)=\\tau_2^2$，并且 $z,\\epsilon_1,\\epsilon_2$ 相互独立。因此，根据协方差的双线性和独立性，我们有\n$$\n\\operatorname{Var}(y_1)=\\operatorname{Var}(z)+\\operatorname{Var}(\\epsilon_1)=1+\\tau_1^2,\n\\quad\n\\operatorname{Var}(y_2)=\\operatorname{Var}(z)+\\operatorname{Var}(\\epsilon_2)=1+\\tau_2^2,\n$$\n和\n$$\n\\operatorname{Cov}(y_1,y_2)=\\operatorname{Cov}(z+\\epsilon_1,z+\\epsilon_2)=\\operatorname{Cov}(z,z)+\\operatorname{Cov}(z,\\epsilon_2)+\\operatorname{Cov}(\\epsilon_1,z)+\\operatorname{Cov}(\\epsilon_1,\\epsilon_2)=1+0+0+0=1.\n$$\n因此协方差矩阵 $S$ 为\n$$\nS=\\begin{bmatrix}1+\\tau_1^2  1\\\\ 1  1+\\tau_2^2\\end{bmatrix}.\n$$\n$(y_1,y_2)$ 的相关系数矩阵 $R$ 通过 $y_1$ 和 $y_2$ 的标准差的倒数进行重新缩放。设 $D=\\operatorname{diag}(1+\\tau_1^2,\\,1+\\tau_2^2)$。则\n$$\nR=D^{-1/2}SD^{-1/2}\n=\\begin{bmatrix}\n\\frac{1}{\\sqrt{1+\\tau_1^2}}  0\\\\\n0  \\frac{1}{\\sqrt{1+\\tau_2^2}}\n\\end{bmatrix}\n\\begin{bmatrix}\n1+\\tau_1^2  1\\\\\n1  1+\\tau_2^2\n\\end{bmatrix}\n\\begin{bmatrix}\n\\frac{1}{\\sqrt{1+\\tau_1^2}}  0\\\\\n0  \\frac{1}{\\sqrt{1+\\tau_2^2}}\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n1  \\rho\\\\\n\\rho  1\n\\end{bmatrix},\n$$\n其中\n$$\n\\rho=\\frac{\\operatorname{Cov}(y_1,y_2)}{\\sqrt{\\operatorname{Var}(y_1)\\operatorname{Var}(y_2)}}\n=\\frac{1}{\\sqrt{(1+\\tau_1^2)(1+\\tau_2^2)}}.\n$$\n主成分分析 (PCA) 计算散布矩阵的正交单位特征向量。对于基于协方差的 PCA，我们使用 $S$；对于基于相关系数的 PCA，我们使用 $R$。第一主成分载荷向量是与最大特征值关联的单位范数特征向量。对于所选矩阵最大特征值对应的载荷向量 $v$，变量 $y_1$ 的载荷大小为 $\\lvert v_1\\rvert$。\n\n我们现在分析增加 $\\tau_1^2$ 如何在两种散布矩阵选择下影响第一主成分。\n\n在基于协方差的 PCA 中，矩阵 $S$ 的元素为 $S_{11}=1+\\tau_1^2$，$S_{22}=1+\\tau_2^2$ 和 $S_{12}=S_{21}=1$。当 $\\tau_2^2$ 保持固定而 $\\tau_1^2$ 增加时，$S_{11}$ 会增大，矩阵 $S$ 的 $(1,1)$ 项相对于 $(2,2)$ 项变得越来越具有对角占优性，而非对角项 $S_{12}$ 保持为 $1$。直观上，第一主成分在 $\\lVert v\\rVert_2=1$ 的约束下最大化 Rayleigh 商 $v^\\top S v$。随着 $S_{11}$ 的增长，在第一坐标上具有更大权重的方向会获得更大的方差。这使得第一主特征向量向 $y_1$ 轴倾斜，从而增加了 $\\lvert v_1\\rvert$。\n\n在基于相关系数的 PCA 中，矩阵 $R$ 的对角线元素为 1，非对角线元素为 $\\rho=\\frac{1}{\\sqrt{(1+\\tau_1^2)(1+\\tau_2^2)}}$。增加 $\\tau_1^2$ 不会改变 $R$ 的对角线元素（它们保持为 1），但会减小 $\\rho$，因为分子固定为 1 而分母增大。对称矩阵\n$$\nR=\\begin{bmatrix}1  \\rho\\\\ \\rho  1\\end{bmatrix}\n$$\n的特征结构很简单：特征向量为 $u_+=\\frac{1}{\\sqrt{2}}\\begin{pmatrix}1\\\\1\\end{pmatrix}$，其特征值为 $1+\\rho$；以及 $u_-=\\frac{1}{\\sqrt{2}}\\begin{pmatrix}1\\\\-1\\end{pmatrix}$，其特征值为 $1-\\rho$。对于 $\\rho\\ge 0$，最大特征值为 $1+\\rho$，其特征向量 $u_+$ 在 $y_1$ 和 $y_2$ 上具有相等的权重，载荷大小为 $\\lvert (u_+)_1\\rvert=\\frac{1}{\\sqrt{2}}$。关键在于，该特征向量与 $\\rho$ 无关，因此在基于相关系数的 PCA 中，增加 $\\tau_1^2$ 不会增大变量 $y_1$ 的载荷大小；它始终保持为 $\\frac{1}{\\sqrt{2}}$。\n\n从算法上讲，对于每个测试用例：\n1. 设置 $\\tau_2^2=0.5$ 并读取给定的 $\\tau_1^2$。\n2. 构建 $S=\\begin{bmatrix}1+\\tau_1^2  1\\\\ 1  1+\\tau_2^2\\end{bmatrix}$。\n3. 构建 $R=D^{-1/2}SD^{-1/2}$，其中 $D=\\operatorname{diag}(1+\\tau_1^2,\\,1+\\tau_2^2)$。\n4. 计算 $S$ 的特征值和特征向量，选择与最大特征值对应的特征向量，将其归一化为单位范数，并将 $l_1^{\\text{cov}}$ 设置为其第一个分量的绝对值。\n5. 对 $R$ 重复步骤 4 以获得 $l_1^{\\text{cor}}$。\n6. 计算比率 $r=\\dfrac{l_1^{\\text{cov}}}{l_1^{\\text{cor}}}$。\n7. 将四个比率 $[r_A,r_B,r_C,r_D]$ 汇总到单行打印输出中。\n\n这个过程确定性地量化了在基于协方差的 PCA 中，由于测量误差方差 $\\tau_1^2$ 增加而导致的变量 $y_1$ 在第一主成分中权重的增大，并证明了基于相关系数的 PCA 通过标准化变量来缓解这种效应，在仅考虑两个具有相同对角线元素的变量时，保持了主方向的对称性。测试套件包括无附加误差的基线、中等误差、大误差和极大误差的情况，从而涵盖了基于协方差 PCA 的典型行为和渐近倾斜，同时展示了基于相关系数 PCA 载荷的稳健性。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef first_pc_loading_var1(matrix: np.ndarray) - float:\n    \"\"\"\n    Compute the magnitude of the loading for variable 1 (index 0)\n    in the first principal component (largest eigenvalue) for a\n    symmetric 2x2 matrix.\n    \"\"\"\n    # Use eigh for symmetric matrices; returns eigenvalues in ascending order.\n    evals, evecs = np.linalg.eigh(matrix)\n    idx = int(np.argmax(evals))\n    v = evecs[:, idx]\n    # Ensure unit-norm eigenvector (eigh returns normalized eigenvectors).\n    # Take absolute value to remove sign ambiguity.\n    return float(abs(v[0]))\n\ndef build_covariance_matrix(tau1_sq: float, tau2_sq: float) - np.ndarray:\n    \"\"\"\n    Build the 2x2 covariance matrix S for y1 = z + e1, y2 = z + e2,\n    with Var(z)=1, Var(e1)=tau1_sq, Var(e2)=tau2_sq, and all independent.\n    \"\"\"\n    var1 = 1.0 + tau1_sq\n    var2 = 1.0 + tau2_sq\n    cov12 = 1.0\n    return np.array([[var1, cov12],\n                     [cov12, var2]], dtype=float)\n\ndef build_correlation_matrix_from_cov(S: np.ndarray) - np.ndarray:\n    \"\"\"\n    Build the correlation matrix R = D^{-1/2} S D^{-1/2},\n    where D = diag(S[0,0], S[1,1]).\n    \"\"\"\n    var1 = S[0, 0]\n    var2 = S[1, 1]\n    inv_sqrt_d = np.array([[1.0 / np.sqrt(var1), 0.0],\n                           [0.0, 1.0 / np.sqrt(var2)]], dtype=float)\n    R = inv_sqrt_d @ S @ inv_sqrt_d\n    return R\n\ndef solve():\n    # Fixed tau2^2 as specified in the problem.\n    tau2_sq = 0.5\n    # Define the test cases for tau1^2.\n    test_cases = [0.0, 0.5, 2.0, 20.0]\n\n    results = []\n    for tau1_sq in test_cases:\n        # Construct covariance matrix S.\n        S = build_covariance_matrix(tau1_sq, tau2_sq)\n        # Construct correlation matrix R.\n        R = build_correlation_matrix_from_cov(S)\n        # Compute loadings for variable 1 under covariance-PCA and correlation-PCA.\n        l1_cov = first_pc_loading_var1(S)\n        l1_cor = first_pc_loading_var1(R)\n        # Compute ratio r = l1_cov / l1_cor.\n        r = l1_cov / l1_cor\n        results.append(r)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "3161286"}]}