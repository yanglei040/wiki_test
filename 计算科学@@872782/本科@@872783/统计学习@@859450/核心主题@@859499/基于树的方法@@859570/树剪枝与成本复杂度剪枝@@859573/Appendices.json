{"hands_on_practices": [{"introduction": "成本复杂度剪枝为模型选择中的“奥卡姆剃刀”定律（即简约原则）提供了数学框架。这个练习 [@problem_id:3189470] 探讨了一个核心场景：两个不同的子树产生了完全相同的训练误差。你将应用成本复杂度准则，来理解正则化参数 $\\alpha$ 如何系统性地解决这种平局，并偏向于选择更简单的模型。", "problem": "考虑一个二元分类任务和一棵由分类与回归树（CART）构建的大树。设这棵大树的一个固定的内部节点 $t$ 为某个子树的根，并假设在节点 $t$ 处的子树有两种备选的剪枝方案：一个较深的子树 $T_{A}$ 和一个较浅的子树 $T_{B}$。对于每个子树 $T$，在 $0$–$1$ 损失下，其经验训练误差定义为\n$$\nR(T) \\equiv \\sum_{l \\in \\text{Leaves}(T)} \\sum_{i \\in l} \\mathbf{1}\\!\\left(y_{i} \\neq \\hat{y}_{l}\\right),\n$$\n其中 $y_{i}$ 是训练点 $i$ 的类别标签，$\\hat{y}_{l}$ 是叶节点的预测值（叶节点 $l$ 中的多数类）。令 $|\\!T\\!|$ 表示子树 $T$ 的终端节点（叶节点）数量。\n\n设计以下场景。较深子树 $T_{A}$ 的叶节点级别错分计数由多重集 $\\{2,1,0,3,1,0,2,3\\}$ 给出，因此 $|\\!T_{A}\\!| = 8$ 且 $R(T_{A}) = 12$。较浅子树 $T_{B}$ 的叶节点级别错分计数由多重集 $\\{4,0,2,3,3\\}$ 给出，因此 $|\\!T_{B}\\!| = 5$ 且 $R(T_{B}) = 12$。从经验风险最小化原则和应惩罚模型复杂度的结构风险最小化思想出发，考虑成本复杂度准则\n$$\nR_{\\alpha}(T) \\equiv R(T) + \\alpha \\, |\\!T\\!|,\n$$\n其中 $\\alpha \\geq 0$ 是一个正则化参数。\n\n仅使用这些基本定义，解释成本复杂度剪枝如何通过改变 $\\alpha$ 来解决 $T_{A}$ 和 $T_{B}$ 在 $R(T)$ 上的平局，并推导出确切的阈值 $\\alpha^{\\star}$，在该阈值下，一个子树在 $R_{\\alpha}(\\cdot)$ 准则下严格优于另一个子树（即，使得首选子树的 $R_{\\alpha}$ 严格小于备选子树的最小 $\\alpha$ 值）。请将您的最终答案 $\\alpha^{\\star}$ 以单个实数的形式给出。无需四舍五入。", "solution": "首先验证问题陈述，以确保其科学性、良构性、客观性和完整性。\n\n### 步骤1：提取已知条件\n- 一个使用CART构建的树的二元分类任务。\n- 两个备选的子树剪枝方案，$T_{A}$ 和 $T_{B}$，都以同一内部节点 $t$ 为根。\n- 经验训练误差定义为 $R(T) \\equiv \\sum_{l \\in \\text{Leaves}(T)} \\sum_{i \\in l} \\mathbf{1}\\!\\left(y_{i} \\neq \\hat{y}_{l}\\right)$。\n- 树 $T$ 的复杂度是其叶节点数，表示为 $|\\!T\\!|$。\n- 对于较深的子树 $T_{A}$：\n  - 叶节点数：$|\\!T_{A}\\!| = 8$。\n  - 总经验误差：$R(T_{A}) = 12$。\n- 对于较浅的子树 $T_{B}$：\n  - 叶节点数：$|\\!T_{B}\\!| = 5$。\n  - 总经验误差：$R(T_{B}) = 12$。\n- 成本复杂度准则定义为 $R_{\\alpha}(T) \\equiv R(T) + \\alpha \\, |\\!T\\!|$，其中正则化参数 $\\alpha \\geq 0$。\n- 目标是解释成本复杂度剪枝如何解决 $R(T)$ 的平局，并找到阈值 $\\alpha^{\\star}$，该阈值定义为使一个子树严格占优的最小 $\\alpha$。\n\n### 步骤2：使用提取的已知条件进行验证\n- **科学性**：该问题基于分类与回归树（CART）和成本复杂度剪枝的标准且成熟的理论，这是统计学习中的一个核心概念。定义和设置都是正确的。\n- **良构性**：问题陈述清晰，包含了所有必要的量化信息。它要求一个特定的值 $\\alpha^{\\star}$，这个值可以从给定的数据和定义中唯一确定。\n- **客观性**：问题以精确的数学语言表达，没有主观性或模糊性。\n- 问题内部一致，因为陈述的总误差 $R(T_A)$ 和 $R(T_B)$ 与提供的叶节点级别错分计数的总和相符。没有矛盾或信息缺失。\n\n### 步骤3：结论与行动\n问题是有效的。可以构建一个合理的解决方案。\n\n### 解题推导\n\n问题要求我们比较两个备选子树 $T_{A}$ 和 $T_{B}$，它们具有相同的经验训练误差但复杂度不同。这个场景凸显了结构风险最小化的核心原则，该原则通常与奥卡姆剃刀相关联：当两个模型在训练数据上表现同样出色时，应首选更简单的那个。成本复杂度剪枝提供了一个实现这一原则的正式机制。\n\n成本复杂度准则由 $R_{\\alpha}(T) = R(T) + \\alpha |\\!T\\!|$ 给出。其中，$R(T)$ 是经验风险（衡量训练数据拟合度的指标），而 $\\alpha |\\!T\\!|$ 是一个惩罚模型复杂度的惩罚项，其中 $|\\!T\\!|$ 是复杂度的度量，$\\alpha \\geq 0$ 是控制权衡的参数。\n\n对于这两个子树，我们有以下给定值：\n对于子树 $T_{A}$：\n- 经验误差: $R(T_{A}) = 12$\n- 复杂度（叶节点数）: $|\\!T_{A}\\!| = 8$\n\n对于子树 $T_{B}$：\n- 经验误差: $R(T_{B}) = 12$\n- 复杂度（叶节点数）: $|\\!T_{B}\\!| = 5$\n\n让我们将每个子树的成本复杂度写成 $\\alpha$ 的函数：\n$$\nR_{\\alpha}(T_{A}) = R(T_{A}) + \\alpha |\\!T_{A}\\!| = 12 + 8\\alpha\n$$\n$$\nR_{\\alpha}(T_{B}) = R(T_{B}) + \\alpha |\\!T_{B}\\!| = 12 + 5\\alpha\n$$\n\n剪枝的目标是对于给定的 $\\alpha$，选择具有最小成本复杂度 $R_{\\alpha}(T)$ 的子树。\n\n首先，我们分析 $\\alpha = 0$ 的情况。这对应于纯粹的经验风险最小化，即没有对复杂度的惩罚。\n$$\nR_{0}(T_{A}) = 12 + 8(0) = 12\n$$\n$$\nR_{0}(T_{B}) = 12 + 5(0) = 12\n$$\n在这种情况下，$R_{0}(T_{A}) = R_{0}(T_{B})$。仅基于经验风险，没有理由偏好一个子树而不是另一个；它们是平局。\n\n接下来，我们考虑 $\\alpha > 0$ 的情况。这引入了对复杂度的惩罚。结构风险最小化原则表明，应首选更简单的树 $T_{B}$。让我们通过比较 $R_{\\alpha}(T_{A})$ 和 $R_{\\alpha}(T_{B})$ 来验证这一点。我们寻求其中一个严格小于另一个的条件。\n让我们确定对于哪些 $\\alpha$ 值，子树 $T_{B}$ 是首选，即 $R_{\\alpha}(T_{B})  R_{\\alpha}(T_{A})$。\n$$\n12 + 5\\alpha  12 + 8\\alpha\n$$\n两边同时减去 $12$ 得：\n$$\n5\\alpha  8\\alpha\n$$\n两边同时减去 $5\\alpha$：\n$$\n0  3\\alpha\n$$\n由于 $\\alpha$ 是一个非负参数，这个不等式对所有 $\\alpha > 0$ 都成立。\n\n这个结果解释了成本复杂度剪枝如何解决平局。只要对复杂度施加任何正向惩罚（即，对于任何 $\\alpha > 0$），平局就会被打破。因为 $T_{B}$ 更简单（$|\\!T_{B}\\!|  |\\!T_{A}\\!|$），它的惩罚项 $\\alpha |\\!T_{B}\\!|$ 小于 $T_{A}$ 的惩罚项，使其总成本复杂度 $R_{\\alpha}(T_{B})$ 严格更小。因此，对于任何 $\\alpha > 0$，$T_{B}$ 都是严格占优的子树。\n\n问题要求找到“一个子树严格优于另一个子树的阈值 $\\alpha^{\\star}$”。这个阈值是标记了无差异区间和严格偏好区间边界的 $\\alpha$ 值。我们可以通过将成本复杂度设为相等并求解 $\\alpha$ 来找到这个边界点：\n$$\nR_{\\alpha}(T_{A}) = R_{\\alpha}(T_{B})\n$$\n$$\n12 + 8\\alpha = 12 + 5\\alpha\n$$\n$$\n3\\alpha = 0\n$$\n$$\n\\alpha = 0\n$$\n这个值 $\\alpha = 0$ 是转换点。在 $\\alpha = 0$ 时，成本相等。对于任何 $\\alpha > 0$ 的值，都会出现对 $T_{B}$ 的严格偏好。问题将 $\\alpha^{\\star}$ 定义为存在严格偏好的最小 $\\alpha$。存在严格偏好的 $\\alpha$ 值集合是 $(0, \\infty)$。满足此条件的最小值是任意小的 $\\epsilon > 0$。问题要求的是阈值，也就是这个集合的下确界。集合 $(0, \\infty)$ 的下确界是 $0$。\n\n因此，出现严格偏好的阈值 $\\alpha^{\\star}$ 是 $0$。", "answer": "$$\n\\boxed{0}\n$$", "id": "3189470"}, {"introduction": "在理解了基本的权衡之后，我们现在来探索完整的剪枝过程。这个练习 [@problem_id:3189468] 深入探讨了“最弱环节”剪枝算法，这正是生成一系列最优子树的机制。通过计算关键的“断点” (breakpoints)，你将描绘出完整的权衡路径，并精确地观察到当复杂度惩罚增加时，最优树结构是如何演变的。", "problem": "在一个训练集上，一棵回归树被生长为已知的最大树 $T_{\\max}$，并将使用代价复杂度准则进行剪枝。令 $R(T)$ 表示树 $T$ 在训练集上的经验残差平方和，令 $|T|$ 表示 $T$ 的终端节点（叶节点）数量。对于任意非负惩罚参数 $\\alpha \\ge 0$，树 $T$ 的代价复杂度定义为 $R_{\\alpha}(T) = R(T) + \\alpha |T|$。最弱链接剪枝通过重复折叠内部节点来构建一个嵌套的子树序列，被折叠的节点是那些移除后会导致每移除一个叶节点的 $R(T)$ 增量最小的节点。\n\n给定 $T_{\\max}$ 的结构如下：\n- 根节点 $r$ 有两个内部子节点 $L$ 和 $R$。\n- $L$ 和 $R$ 各自一次分裂成两个终端节点；没有更深的分裂。因此，$|T_{\\max}| = 4$ 且内部节点为 $\\{r,L,R\\}$。\n- 如果一个节点是叶节点，其经验残差平方和由 $R(r)=400$，$R(L)=120$ 和 $R(R)=200$ 给出。\n- 每个双叶子树的经验残差平方和为 $R(T_{L})=80$ 和 $R(T_{R})=150$。因此，$R(T_{\\max}) = R(T_{L}) + R(T_{R}) = 230$。\n\n任务A. 从 $T_{\\max}$ 开始，执行最弱链接剪枝，并计算惩罚断点 $\\{\\alpha_{j}\\}$ 的非递减序列，在这些断点处，剪枝后的子树会发生变化。计算从第一次剪枝到最后剪枝成单个叶节点的整个过程。按顺序报告断点 $\\alpha_{0}, \\alpha_{1}, \\alpha_{2}$，每个都要求精确值。\n\n任务B. 考虑一个具有相同拓扑结构的参数化树族，其量\n$$\\Delta_{L} := R(L) - R(T_{L}), \\quad \\Delta_{R} := R(R) - R(T_{R}), \\quad \\Delta_{r} := R(r) - \\big(R(L) + R(R)\\big),$$\n假定满足不等式 $\\Delta_{r} + \\Delta_{L} \\ge 2 \\Delta_{R} \\ge 2 \\Delta_{L}  0$。在这些约束条件下，用 $\\Delta_{L}, \\Delta_{R}, \\Delta_{r}$ 符号化地推导剪枝断点序列，然后给出该序列中连续断点之间最大间隔的单一闭式表达式。在 $(\\alpha, R_{\\alpha}(T))$ 平面中，简明解释为什么这些约束会产生异常大的间隔。\n\n答案格式：将您的最终答案以一个包含四个条目的单行矩阵形式提供，顺序为\n$$(\\alpha_{0}, \\alpha_{1}, \\alpha_{2}, \\text{largest-gap-expression}).$$\n无需四舍五入。", "solution": "用户提供的问题经分析验证，是统计学习领域中一个良置且有科学依据的问题。\n\n该问题要求对给定的回归树应用代价复杂度剪枝（也称为最弱链接剪枝）。该方法的核心是找到最大树 $T_{\\max}$ 的一个子树序列，该序列对于连续增加的惩罚参数 $\\alpha$ 是最优的。树 $T$ 的代价复杂度定义为 $R_{\\alpha}(T) = R(T) + \\alpha |T|$，其中 $R(T)$ 是残差平方和，而 $|T|$ 是终端节点的数量。\n\n剪枝过程生成一个嵌套的子树序列 $T_0 \\supset T_1 \\supset \\dots \\supset T_k$，其中 $T_0 = T_{\\max}$。在每个阶段，算法剪掉对应于“最弱链接”的内部节点 $t$，该节点被定义为最小化函数 $g(t, T) = \\frac{R(t) - R(T_t)}{|T_t| - 1}$ 的节点。这里，$T_t$ 是以 $t$ 为根的子树，$R(t)$ 表示如果节点 $t$ 是一个终端节点时的残差平方和。值 $\\alpha_{k+1} = \\min_{t} g(t, T_k)$ 成为序列中的下一个断点，即最优子树从 $T_k$ 转换到 $T_{k+1}$ 时的惩罚参数值。\n\n我们来定义剪枝序列中涉及的树：\n- $T_0 = T_{\\max}$：最大树，有 $|T_0| = 4$ 个叶节点。其 RSS (残差平方和) 给出为 $R(T_0) = R(T_{\\max}) = 230$。\n- $T_1$：通过剪枝节点 $L$ 得到的树。它有 $|T_1| = 3$ 个叶节点（$L$ 和 $R$ 的两个子节点）。其 RSS 为 $R(T_1) = R(L) + R(T_R) = 120 + 150 = 270$。\n- $T_2$：通过剪枝节点 $L$ 和 $R$ 得到的树。它有 $|T_2| = 2$ 个叶节点（$L$ 和 $R$）。其 RSS 为 $R(T_2) = R(L) + R(R) = 120 + 200 = 320$。\n- $T_3$：根树，由单个叶节点 $\\{r\\}$ 组成。它有 $|T_3| = 1$ 个叶节点。其 RSS 为 $R(T_3) = R(r) = 400$。\n\n存在另一种可能的三叶树，即首先剪枝节点 $R$，我们称之为 $T'_1$。其 RSS 为 $R(T'_1) = R(T_L) + R(R) = 80 + 200 = 280$。由于 $R(T_1)=270  R(T'_1)=280$，对于任何 $\\alpha>0$，都有 $R_\\alpha(T_1)  R_\\alpha(T'_1)$。因此，$T'_1$ 永远不会是最优子树，也不在 $(|T|,R(T))$ 点集的下凸包上。随着 $\\alpha$ 的增加，序列 $T_0, T_1, T_2, T_3$ 是正确的最优子树序列。\n\n### 任务A：断点的数值计算\n\n我们从树 $T_0 = T_{\\max}$ 开始，确定第一步剪枝。内部节点是 $L$ 和 $R$。\n最弱链接参数为：\n- 对于节点 $L$：$g(L, T_0) = \\frac{R(L) - R(T_L)}{|T_L| - 1} = \\frac{120 - 80}{2 - 1} = \\frac{40}{1} = 40$。\n- 对于节点 $R$：$g(R, T_0) = \\frac{R(R) - R(T_R)}{|T_R| - 1} = \\frac{200 - 150}{2 - 1} = \\frac{50}{1} = 50$。\n\n最小值为 $40$，因此第一个断点是 $\\alpha_0 = 40$。此时，节点 $L$ 被剪枝，最优树变为 $T_1$。\n\n接下来，我们从树 $T_1$ 开始。其内部节点是 $R$ 和根节点 $r$。\n- 对于节点 $R$：要被剪枝的分支是 $T_R$。$g(R, T_1) = \\frac{R(R) - R(T_R)}{|T_R| - 1} = \\frac{50}{1} = 50$。\n- 对于根节点 $r$：在 $r$ 处剪枝意味着将整个树 $T_1$ 折叠成单个节点 $\\{r\\}$。RSS 的增加量是 $R(r) - R(T_1) = 400 - 270 = 130$。叶节点的数量减少了 $|T_1| - 1 = 3 - 1 = 2$。\n$g(r, T_1) = \\frac{R(r) - R(T_1)}{|T_1| - 1} = \\frac{130}{2} = 65$。\n\n最小值为 $50$，因此第二个断点是 $\\alpha_1 = 50$。此时，节点 $R$ 被剪枝，最优树变为 $T_2$。\n\n最后，我们从树 $T_2$ 开始。它唯一的内部节点是根节点 $r$。\n- 对于根节点 $r$：剪枝意味着将 $T_2$ 折叠成 $\\{r\\}$。RSS 的增加量是 $R(r) - R(T_2) = 400 - 320 = 80$。叶节点的数量减少了 $|T_2| - 1 = 2 - 1 = 1$。\n$g(r, T_2) = \\frac{R(r) - R(T_2)}{|T_2| - 1} = \\frac{80}{1} = 80$。\n\n这必然是下一个断点，所以 $\\alpha_2 = 80$。对于 $\\alpha \\ge 80$，最优树是根树 $T_3$。\n\n断点序列为 $\\{\\alpha_0, \\alpha_1, \\alpha_2\\} = \\{40, 50, 80\\}$。\n\n### 任务B：符号推导与分析\n\n给定定义：\n$\\Delta_{L} = R(L) - R(T_{L})$\n$\\Delta_{R} = R(R) - R(T_{R})$\n$\\Delta_{r} = R(r) - (R(L) + R(R))$\n以及约束条件 $\\Delta_{r} + \\Delta_{L} \\ge 2 \\Delta_{R} \\ge 2 \\Delta_{L}  0$。\n\n剪枝断点可以通过寻找最优树发生变化时的 $\\alpha$ 值来找到。这发生在 $R_\\alpha(T_k) = R_\\alpha(T_{k+1})$ 时。\n1.  **断点 $\\alpha_0$（从 $T_0$ 到 $T_1$ 的转换）**：\n    $R_{\\alpha}(T_0) = R_{\\alpha}(T_1) \\implies R(T_0) + \\alpha |T_0| = R(T_1) + \\alpha |T_1|$\n    $R(T_{\\max}) + 4\\alpha = (R(L) + R(T_R)) + 3\\alpha$\n    $\\alpha = R(L) + R(T_R) - R(T_{\\max}) = R(L) + R(T_R) - (R(T_L) + R(T_R)) = R(L) - R(T_L) = \\Delta_L$。\n    所以，$\\alpha_0 = \\Delta_L$。这与最弱链接的计算结果一致，因为从 $2\\Delta_R \\ge 2\\Delta_L$ 我们得到 $\\Delta_R \\ge \\Delta_L$，这使得 $L$ 成为最弱链接。\n\n2.  **断点 $\\alpha_1$（从 $T_1$ 到 $T_2$ 的转换）**：\n    $R_{\\alpha}(T_1) = R_{\\alpha}(T_2) \\implies R(T_1) + 3\\alpha = R(T_2) + 2\\alpha$\n    $\\alpha = R(T_2) - R(T_1) = (R(L) + R(R)) - (R(L) + R(T_R)) = R(R) - R(T_R) = \\Delta_R$。\n    所以，$\\alpha_1 = \\Delta_R$。\n\n3.  **断点 $\\alpha_2$（从 $T_2$ 到 $T_3$ 的转换）**：\n    $R_{\\alpha}(T_2) = R_{\\alpha}(T_3) \\implies R(T_2) + 2\\alpha = R(T_3) + \\alpha$\n    $\\alpha = R(T_3) - R(T_2) = R(r) - (R(L) + R(R)) = \\Delta_r$。\n    所以，$\\alpha_2 = \\Delta_r$。\n\n断点序列为 $\\{\\Delta_L, \\Delta_R, \\Delta_r\\}$。给定的不等式 $2\\Delta_R \\ge 2\\Delta_L$ 意味着 $\\Delta_R \\ge \\Delta_L$。不等式 $\\Delta_r + \\Delta_L \\ge 2\\Delta_R$ 可以重写为 $\\Delta_r \\ge 2\\Delta_R - \\Delta_L$。由于 $\\Delta_R \\ge \\Delta_L$，我们有 $-\\Delta_L \\ge -\\Delta_R$，这意味着 $\\Delta_r \\ge 2\\Delta_R - \\Delta_L \\ge 2\\Delta_R - \\Delta_R = \\Delta_R$。因此，我们有排序 $\\Delta_r \\ge \\Delta_R \\ge \\Delta_L$，这证实了 $\\{\\alpha_0, \\alpha_1, \\alpha_2\\}$ 是一个非递减序列。\n\n连续断点之间的间隔是：\n- 间隔1: $\\alpha_1 - \\alpha_0 = \\Delta_R - \\Delta_L$。\n- 间隔2: $\\alpha_2 - \\alpha_1 = \\Delta_r - \\Delta_R$。\n\n为了找到最大的间隔，我们比较这两个表达式。约束条件 $\\Delta_r + \\Delta_L \\ge 2\\Delta_R$ 可以重排为 $\\Delta_r - \\Delta_R \\ge \\Delta_R - \\Delta_L$。\n这个不等式表明第二个间隔大于或等于第一个间隔。因此，连续断点之间的最大间隔是 $\\Delta_r - \\Delta_R$。\n\n**产生大间隔的几何原因：**\n在 $(\\alpha, R_{\\alpha}(T))$ 平面中，每个候选子树 $T_k$ 的代价复杂度是一条直线 $R_{\\alpha}(T_k) = R(T_k) + \\alpha |T_k|$，其斜率为 $|T_k|$。最优代价 $R_{\\alpha}^* = \\min_k R_{\\alpha}(T_k)$ 是这些线的下包络线，它是 $\\alpha$ 的一个分段线性凹函数。断点 $\\{\\alpha_j\\}$ 是这个下包络线顶点的 $\\alpha$ 坐标。\n我们发现断点为 $\\alpha_0 = \\Delta_L, \\alpha_1 = \\Delta_R, \\alpha_2 = \\Delta_r$。量 $\\Delta_L, \\Delta_R, \\Delta_r$ 代表了三个连续剪枝步骤中每一步 RSS 的增量。约束条件 $\\Delta_r - \\Delta_R \\ge \\Delta_R - \\Delta_L$ 意味着 RSS 增量序列 $(\\Delta_L, \\Delta_R, \\Delta_r)$ 是凸的。随着剪枝的进行，RSS 增量的这种“加速”导致断点——其值等于这些增量——随着 $\\alpha$ 的增加而间隔得更远。当 $\\Delta_r+\\Delta_L$ 显著大于 $2\\Delta_R$ 时，就会出现“异常大的间隔”，这使得 RSS 增量序列急剧凸增，从而拉伸了树 $T_2$ 为最优的区间 $(\\alpha_1, \\alpha_2)$。\n\n最终答案组合：\n$\\alpha_0 = 40$\n$\\alpha_1 = 50$\n$\\alpha_2 = 80$\n最大间隔表达式: $\\Delta_r - \\Delta_R$\n\n根据要求，这四个值将被放入一个行矩阵中。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n40  50  80  \\Delta_{r} - \\Delta_{R}\n\\end{pmatrix}\n}\n$$", "id": "3189468"}, {"introduction": "为了加深理解，这最后一个练习 [@problem_id:3189469] 从一个新颖的视角重新审视了树剪枝问题：一个经典的优化问题。通过构建一个场景，其中保留每个树分支都有明确的“收益”（误差减少 $\\Delta R_j$）和单位“成本”（一个叶子节点），你将证明选择最优的分支集合等价于解决一个0-1背包问题。这个强大的类比为“最弱环节”剪枝的贪心策略提供了深刻的理论依据。", "problem": "要求您对统计学习中剪枝二叉决策树的三种视角进行形式化、分析和等价性检验：代价复杂度剪枝、单位成本背包问题公式以及最弱连接剪枝路径。请从以下决策树和剪枝领域广泛接受的基础出发。\n\n基本基础与定义：考虑一个分类树，其有限的叶节点集合表示为 $T$。该树的经验重代入误差（训练集错分计数）表示为 $R(T)$。对于一个非负正则化参数 $\\alpha$，代价复杂度准则为\n$$\nC_{\\alpha}(T) \\equiv R(T) + \\alpha \\, |T|,\n$$\n其中 $|T|$ 是叶节点的数量。通过剪枝一个分支形成的子树，会将该分支（一个内部节点及其后代）替换为位于该节点处的单个叶节点。对于任何可剪枝的分支，如果保留该分支（相对于剪枝），叶节点数量增加 $\\Delta |T|$，重代入误差减少 $\\Delta R$，那么保留该分支时代价复杂度目标函数的净变化是\n$$\n\\Delta C_{\\alpha} = -\\Delta R + \\alpha \\, \\Delta |T|.\n$$\n最弱连接剪枝算法在每一步中移除比率 $\\Delta R / \\Delta |T|$ 最小的分支，并生成一个由 $\\alpha$ 索引的嵌套子树序列。\n\n为强制单位成本的数据集设计：构建一个合成数据集，该数据集产生 $m$ 个独立的候选分支，如果保留其中任一分支，误差将减少 $\\Delta R_j$，而 $|T|$ 恰好增加 $1$（因此对所有 $j \\in \\{1,\\dots,m\\}$ 都有 $\\Delta |T|_j = 1$）。实现此目标的一种方法是，假设一个固定的、已选定的划分，创建了 $m$ 个不相交的区域（组），在每个区域内都有一个可选的二元分裂，该分裂将一个叶节点变成两个。设第 $j$ 个区域由两个子组（称它们为 $s=0$ 和 $s=1$）组成，其正例和负例的计数分别为 $(p_{j0}, n_{j0})$ 和 $(p_{j1}, n_{j1})$。那么，如果区域内的次级分裂被保留，该区域分裂后的错分计数为 $\\min(p_{j0}, n_{j0}) + \\min(p_{j1}, n_{j1})$；而如果该分裂被剪枝，单个叶节点将预测该区域的多数类，错分计数为 $\\min(p_{j0}+p_{j1},\\, n_{j0}+n_{j1})$。因此，保留该分支的收益 $\\Delta R_j$ 为\n$$\n\\Delta R_j = \\min(p_{j0}+p_{j1},\\, n_{j0}+n_{j1}) - \\big(\\min(p_{j0}, n_{j0}) + \\min(p_{j1}, n_{j1})\\big),\n$$\n且每个被保留分支的成本为 $1$ 个叶节点。\n\n目标问题：您必须编写一个程序，给定几个小的 $\\Delta R$ 和/或明确子组计数的测试套件，检查以下三种等价性并输出可量化的结果。\n\n1) 对于固定的 $\\alpha$，代价复杂度最优性与贪心阈值规则的比较：\n- 使用代价复杂度目标函数，要保留的全局最优分支子集是在所有子集 $S$ 中最大化 $\\sum_{j \\in S} \\Delta R_j - \\alpha |S|$ 的那个。在单位成本 $\\Delta |T|_j = 1$ 的情况下，最优性的充要条件是精确地保留那些满足 $\\Delta R_j \\ge \\alpha$ 的分支。\n- 通过将穷举搜索找到的精确最优子集与贪心阈值规则“当且仅当 $\\Delta R_j \\ge \\alpha$ 时保留 $j$”进行比较，来验证此等价性。\n\n2) 存在平局的边界情况：\n- 对于边界上存在平局的情况（即，某些 $\\Delta R_j$ 等于 $\\alpha$），采用确定性约定，即当 $\\Delta R_j \\ge \\alpha$ 时保留分支，当 $\\Delta R_j  \\alpha$ 时剪枝。验证穷举搜索与此约定一致。\n\n3) 有预算约束的背包问题与拉格朗日形式的比较：\n- 在保留分支数量有预算 $B$（每个成本为 $1$）的情况下，优化问题 $\\max_{S: |S|\\le B} \\sum_{j \\in S} \\Delta R_j$ 是一个单位成本的 $0$–$1$ 背包问题，其解法是选择 $B$ 个最大的 $\\Delta R_j$。证明存在一个 $\\alpha$，使得拉格朗日解“保留所有 $\\Delta R_j \\ge \\alpha$”恰好产生 $B$ 个分支，并与预算解匹配。\n\n4) 最弱连接剪枝路径等价性：\n- 对于单位成本，最弱连接步骤移除具有最小 $\\Delta R_j$ 的分支，整个剪枝树序列对应于单调递增的 $\\alpha$。验证在多个 $\\alpha$ 值下通过阈值法生成的集合与通过相继移除最小 $\\Delta R_j$ 生成的集合相匹配。\n\n5) 基于计数的显式数据集：\n- 对 $m = 4$ 个组使用以下显式计数：\n  - 组 $0$：$(p_{00}, n_{00}) = (7, 1)$ 和 $(p_{01}, n_{01}) = (1, 5)$。\n  - 组 $1$：$(p_{10}, n_{10}) = (3, 2)$ 和 $(p_{11}, n_{11}) = (2, 3)$。\n  - 组 $2$：$(p_{20}, n_{20}) = (6, 0)$ 和 $(p_{21}, n_{21}) = (0, 4)$。\n  - 组 $3$：$(p_{30}, n_{30}) = (2, 1)$ 和 $(p_{31}, n_{31}) = (1, 2)$。\n  根据上述定义为每个组计算 $\\Delta R_j$，并对于 $\\alpha = 1.5$（以原始错分计数为单位，因此 $\\alpha$ 的单位是“错分数量”）的选择，验证第 $1$–$4$ 项中的等价性。\n\n测试套件规范：您的程序必须实现并评估以下参数集。\n- 测试 $1$（正常路径）：$\\Delta R = \\{0.31, 0.12, 0.27, 0.08, 0.19, 0.05, 0.14, 0.22\\}$，$\\alpha = 0.15$。\n- 测试 $2$（边界平局）：$\\Delta R = \\{0.20, 0.15, 0.15, 0.10\\}$，$\\alpha = 0.15$。\n- 测试 $3$（预算）：$\\Delta R = \\{0.31, 0.12, 0.27, 0.08, 0.19, 0.05, 0.14, 0.22\\}$，预算 $B = 3$，拉格朗日参数选择在第三大和第四大值之间。\n- 测试 $4$（最弱连接路径验证）：重用 $\\Delta R = \\{0.31, 0.12, 0.27, 0.08, 0.19, 0.05, 0.14, 0.22\\}$，并在一个跨越最小值以下和最大值以上的 $\\alpha$ 值网格上检查等价性。\n- 测试 $5$（显式计数）：使用上面指定的 $m=4$ 个组和 $\\alpha = 1.5$（计数，非比率），根据计数计算 $\\Delta R_j$，并验证穷举代价复杂度优化、阈值规则和最弱连接移除之间的等价性。\n\n要求的最终输出格式：您的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔列表，按顺序包含以下条目：\n- 条目 $1$：测试 $1$ 等价性的布尔值（如果穷举搜索等于阈值规则，则为 true）。\n- 条目 $2$：测试 $2$ 等价性的布尔值。\n- 条目 $3$：一个布尔值，如果预算约束的最优集等于前 $B$ 大贪心集和使用所选 $\\alpha$ 的拉格朗日集，则为 true。\n- 条目 $4$：一个布尔值，如果最弱连接路径在 $\\alpha$ 值网格上等于阈值化集合，则为 true。\n- 条目 $5$：使用显式计数和 $\\alpha = 1.5$ 的测试 $5$ 等价性的布尔值。\n- 条目 $6$：测试 $1$ 的唯一 $\\Delta R$ 值的排序列表。\n\n您的程序必须是完全确定性的，并且不得需要任何用户输入。除测试 5 中 $\\alpha$ 的单位是“错分数量”外，所有答案都是无量纲的。", "solution": "我们从分类树的代价复杂度目标函数开始，定义为 $C_{\\alpha}(T) = R(T) + \\alpha |T|$，其中 $R(T)$ 是经验错分计数，而 $|T|$ 是叶节点的数量。考虑一个固定的整体树结构，其中有 $m$ 个独立的、可选的分支，每个分支在保留时会将一个叶节点变为两个。对于分支 $j$，保留它相对于剪枝它会使重代入误差减少 $\\Delta R_j$，并使叶节点数量增加 $\\Delta |T|_j = 1$。保留分支 $j$ 时目标函数的变化是\n$$\n\\Delta C_{\\alpha,j} = -\\Delta R_j + \\alpha \\cdot 1,\n$$\n因此，当且仅当 $\\Delta R_j \\ge \\alpha$ 时，保留分支 $j$ 会改善目标函数。如果我们让 $S$ 为保留的分支集合，那么相对于完全剪枝的树（所有 $m$ 个可选分支都被剪枝），代价复杂度目标函数为\n$$\nC_{\\alpha}(S) = C_{\\alpha}(\\text{base}) - \\sum_{j \\in S} \\Delta R_j + \\alpha |S|.\n$$\n在所有 $S$ 中最小化 $C_{\\alpha}(S)$ 等价于最大化 $\\sum_{j \\in S} \\Delta R_j - \\alpha |S|$。对于单位成本情况 $\\Delta |T|_j = 1$（对所有 $j$），这个集合函数在 $j$ 上是可加分离的；最优策略是精确地包含那些满足 $\\Delta R_j \\ge \\alpha$ 的 $j$。这就建立了在固定 $\\alpha$ 下，代价复杂度剪枝与贪心阈值规则之间的等价性。边界约定 $\\Delta R_j \\ge \\alpha$ 确保了当 $\\Delta R_j = \\alpha$ 产生平局时结果的确定性，因为包含这样一个分支不会改变目标函数，而我们选择的约定是包含平局项。\n\n我们现在将此公式与 0-1 背包问题联系起来。考虑有预算约束的优化问题\n$$\n\\max_{S \\subseteq \\{1,\\dots,m\\}} \\sum_{j \\in S} \\Delta R_j\n\\quad \\text{subject to} \\quad |S| \\le B.\n$$\n这是一个单位成本、价值为 $\\Delta R_j$ 的背包问题。在单位成本下，最优解是选择具有最大 $\\Delta R_j$ 值的 $B$ 个分支。存在一个拉格朗日乘子 $\\alpha$，使得集合 $\\{j: \\Delta R_j \\ge \\alpha\\}$ 的基数为 $B$，前提是 $\\alpha$ 的取值严格介于第 $B$ 大和第 $(B+1)$ 大的 $\\Delta R_j$ 不同值之间。因此，在此单位成本设置中，拉格朗日形式和预算约束的背包解是一致的。\n\n对于最弱连接剪枝，分支 $j$ 变得无关紧要时的有效复杂度参数是比率 $\\Delta R_j / \\Delta |T|_j$。由于 $\\Delta |T|_j = 1$，该值等于 $\\Delta R_j$。最弱连接算法按 $\\Delta R_j$ 递增的顺序移除分支。当 $\\alpha$ 增加超过某个给定的 $\\Delta R_j$ 时，该分支就被剪掉。因此，由 $\\alpha$ 索引的整个最优子树路径与阈值规则“当且仅当 $\\Delta R_j \\ge \\alpha$ 时保留 $j$”是一一对应的。子树发生变化的临界 $\\alpha$ 值恰好是不同的 $\\Delta R_j$ 值。\n\n我们现在描述算法检查。\n\n1) 精确代价复杂度最优子集与阈值规则的比较：\n- 精确搜索：枚举所有子集 $S \\subseteq \\{1,\\dots,m\\}$ 并选择最大化 $\\sum_{j \\in S} \\Delta R_j - \\alpha |S|$ 的集合。\n- 贪心阈值：当且仅当 $\\Delta R_j \\ge \\alpha$ 时保留 $j$。\n- 比较所选索引集是否相等。\n\n2) 边界平局：\n- 当某些 $\\Delta R_j = \\alpha$ 时，使用相同的比较方法，规则为当 $\\Delta R_j \\ge \\alpha$ 时保留。\n- 穷举搜索最大化相同的目标函数，结果应一致，因为添加一个 $\\Delta R_j = \\alpha$ 的分支不会改变目标函数，而我们选择的约定包含平局项。\n\n3) 有预算约束的背包问题与拉格朗日形式的比较：\n- 通过选择 $B$ 个最大的 $\\Delta R_j$ 来解决单位成本背包问题。\n- 选择一个严格介于第 $B$ 大和第 $(B+1)$ 大 $\\Delta R_j$ 之间的 $\\alpha$，并计算拉格朗日阈值集。\n- 验证这两个集合相等，并且也最大化 $\\sum \\Delta R_j$（在 $|S| \\le B$ 的约束下）。\n\n4) 最弱连接路径等价性：\n- 对 $\\Delta R_j$ 排序，并考虑一个跨越最小 $\\Delta R_j$ 以下和最大 $\\Delta R_j$ 以上的 $\\alpha$ 值网格。\n- 对于每个 $\\alpha$，阈值集为 $\\{j: \\Delta R_j \\ge \\alpha\\}$。\n- 移除所有 $\\Delta R_j  \\alpha$ 的分支后，最弱连接集是同一个集合；验证在网格中的每个 $\\alpha$ 处两者相等。\n\n5) 显式计数和计算出的 $\\Delta R_j$：\n- 对于每个组 $j$，计算\n$$\n\\Delta R_j = \\min(p_{j0}+p_{j1},\\, n_{j0}+n_{j1}) - \\big(\\min(p_{j0}, n_{j0}) + \\min(p_{j1}, n_{j1})\\big).\n$$\n- 使用以错分计数为单位的 $\\alpha = 1.5$，并重复穷举优化和阈值规则之间的比较，以及与最弱连接的一致性。\n\n测试套件详情：\n- 测试 $1$：$\\Delta R = \\{0.31, 0.12, 0.27, 0.08, 0.19, 0.05, 0.14, 0.22\\}$，$\\alpha = 0.15$。\n- 测试 $2$：$\\Delta R = \\{0.20, 0.15, 0.15, 0.10\\}$，$\\alpha = 0.15$。\n- 测试 $3$：与测试 $1$ 相同的 $\\Delta R$，预算 $B = 3$，并选择 $\\alpha = 0.205$（第三大值 0.22 和第四大值 0.19 之间的中点）。\n- 测试 $4$：与测试 $1$ 相同的 $\\Delta R$，$\\alpha$ 网格为 $\\{0.00, 0.06, 0.10, 0.135, 0.17, 0.205, 0.245, 0.29, 0.33\\}$。\n- 测试 $5$：计数如问题陈述中所指定，计算 $\\Delta R$ 并使用 $\\alpha = 1.5$。\n\n程序实现：\n- 使用固定 $\\alpha$ 进行精确代价复杂度优化的穷举子集枚举。\n- 通过与 $\\alpha$ 直接比较的阈值规则。\n- 通过选择前 $B$ 大的值来解决单位成本背包问题，如果需要，也可以通过动态规划进行确认。\n- 通过对 $\\Delta R$ 排序并在网格上与阈值化集合进行比较的最弱连接路径。\n- 从显式子组计数计算 $\\Delta R$。\n\n最后，它打印一行列表，包含针对测试 1–5 的五个布尔值以及测试 1 的已排序唯一 $\\Delta R$ 值列表。此输出确认了等价性，并提供了由最弱连接路径所蕴含的临界 $\\alpha$ 断点。", "answer": "[True,True,True,True,True,[0.05, 0.08, 0.12, 0.14, 0.19, 0.22, 0.27, 0.31]]", "id": "3189469"}]}