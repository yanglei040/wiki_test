{"hands_on_practices": [{"introduction": "本练习将带你深入多元线性回归的核心：使用最小二乘法手动计算回归系数。通过一个具体的小型数据集，你将亲手实践驱动所有回归分析软件的矩阵代数运算。[@problem_id:1938980] 这项基础练习有助于揭示模型如何找到“最佳拟合”线的神秘面纱，为你建立坚实的理论基础。", "problem": "一位食品科学家正在开发一种新型烘焙零食，并希望了解烘焙条件如何影响其酥脆度。酥脆度在一个定量标度上进行测量。该科学家用四个批次进行了一个小型实验，改变了两个因素：烘焙温度和湿度。这些因素由编码变量表示，其中 $-1$ 代表低水平设置，$+1$ 代表高水平设置。\n\n提出的统计模型是一个形式如下的多元线性回归模型：\n$$y = \\beta_0 + \\beta_1 x_1 + \\beta_2 x_2 + \\epsilon$$\n其中：\n- $y$ 是酥脆度得分。\n- $x_1$ 是烘焙温度的编码变量。\n- $x_2$ 是湿度的编码变量。\n- $\\beta_0$、$\\beta_1$ 和 $\\beta_2$ 是未知的模型系数。\n- $\\epsilon$ 是随机误差项。\n\n四个实验批次的结果如下：\n- 批次 1：温度编码 ($x_1$) = -1，湿度编码 ($x_2$) = -1，酥脆度 ($y$) = 2。\n- 批次 2：温度编码 ($x_1$) = -1，湿度编码 ($x_2$) = 1，酥脆度 ($y$) = 4。\n- 批次 3：温度编码 ($x_1$) = 1，湿度编码 ($x_2$) = -1，酥脆度 ($y$) = 6。\n- 批次 4：温度编码 ($x_1$) = 1，湿度编码 ($x_2$) = 1，酥脆度 ($y$) = 8。\n\n使用最小二乘法，确定这些系数的估计值。将您的答案表示为一个单行矩阵，其中包含按 $(\\hat{\\beta}_0, \\hat{\\beta}_1, \\hat{\\beta}_2)$ 顺序排列的三个估计系数。", "solution": "目标是求出多元线性回归模型中系数 $\\beta_0$、$\\beta_1$ 和 $\\beta_2$ 的最小二乘估计值。该模型可以写成矩阵形式 $\\mathbf{y} = \\mathbf{X}\\boldsymbol{\\beta} + \\boldsymbol{\\epsilon}$，其中 $\\mathbf{y}$ 是响应向量，$\\mathbf{X}$ 是设计矩阵，$\\boldsymbol{\\beta}$ 是系数向量，$\\boldsymbol{\\epsilon}$ 是误差向量。\n\n首先，我们根据给定的实验数据构建响应向量 $\\mathbf{y}$ 和设计矩阵 $\\mathbf{X}$。设计矩阵包含一列全为 1 的元素，用于表示截距项 $\\beta_0$。\n\n响应向量 $\\mathbf{y}$ 包含酥脆度得分：\n$$\n\\mathbf{y} = \\begin{pmatrix} 2 \\\\ 4 \\\\ 6 \\\\ 8 \\end{pmatrix}\n$$\n\n设计矩阵 $\\mathbf{X}$ 的构造方式是，第一列为代表截距的全 1 列，其后是编码变量 $x_1$ 和 $x_2$ 的列：\n$$\n\\mathbf{X} = \\begin{pmatrix} 1  x_{11}  x_{21} \\\\ 1  x_{12}  x_{22} \\\\ 1  x_{13}  x_{23} \\\\ 1  x_{14}  x_{24} \\end{pmatrix} = \\begin{pmatrix} 1  -1  -1 \\\\ 1  -1  1 \\\\ 1  1  -1 \\\\ 1  1  1 \\end{pmatrix}\n$$\n\n待估计的系数向量为 $\\boldsymbol{\\beta} = (\\beta_0, \\beta_1, \\beta_2)^T$。最小二乘估计值，记为 $\\hat{\\boldsymbol{\\beta}}$，由正规方程组 $\\mathbf{X}^T\\mathbf{X}\\hat{\\boldsymbol{\\beta}} = \\mathbf{X}^T\\mathbf{y}$ 的解给出。假设 $\\mathbf{X}^T\\mathbf{X}$ 是可逆的，则解为：\n$$\n\\hat{\\boldsymbol{\\beta}} = (\\mathbf{X}^T\\mathbf{X})^{-1}\\mathbf{X}^T\\mathbf{y}\n$$\n\n我们将分几步进行计算。首先，我们求 $\\mathbf{X}$ 的转置矩阵：\n$$\n\\mathbf{X}^T = \\begin{pmatrix} 1  1  1  1 \\\\ -1  -1  1  1 \\\\ -1  1  -1  1 \\end{pmatrix}\n$$\n\n接下来，我们计算乘积 $\\mathbf{X}^T\\mathbf{X}$：\n$$\n\\mathbf{X}^T\\mathbf{X} = \\begin{pmatrix} 1  1  1  1 \\\\ -1  -1  1  1 \\\\ -1  1  -1  1 \\end{pmatrix} \\begin{pmatrix} 1  -1  -1 \\\\ 1  -1  1 \\\\ 1  1  -1 \\\\ 1  1  1 \\end{pmatrix}\n$$\n结果矩阵的元素为：\n- $(1,1): 1 \\cdot 1 + 1 \\cdot 1 + 1 \\cdot 1 + 1 \\cdot 1 = 4$\n- $(1,2): 1 \\cdot (-1) + 1 \\cdot (-1) + 1 \\cdot 1 + 1 \\cdot 1 = 0$\n- $(1,3): 1 \\cdot (-1) + 1 \\cdot 1 + 1 \\cdot (-1) + 1 \\cdot 1 = 0$\n- $(2,1): (-1) \\cdot 1 + (-1) \\cdot 1 + 1 \\cdot 1 + 1 \\cdot 1 = 0$\n- $(2,2): (-1) \\cdot (-1) + (-1) \\cdot (-1) + 1 \\cdot 1 + 1 \\cdot 1 = 4$\n- $(2,3): (-1) \\cdot (-1) + (-1) \\cdot 1 + 1 \\cdot (-1) + 1 \\cdot 1 = 0$\n- $(3,1): (-1) \\cdot 1 + 1 \\cdot 1 + (-1) \\cdot 1 + 1 \\cdot 1 = 0$\n- $(3,2): (-1) \\cdot (-1) + 1 \\cdot (-1) + (-1) \\cdot 1 + 1 \\cdot 1 = 0$\n- $(3,3): (-1) \\cdot (-1) + 1 \\cdot 1 + (-1) \\cdot (-1) + 1 \\cdot 1 = 4$\n\n因此，该矩阵是对角矩阵：\n$$\n\\mathbf{X}^T\\mathbf{X} = \\begin{pmatrix} 4  0  0 \\\\ 0  4  0 \\\\ 0  0  4 \\end{pmatrix} = 4\\mathbf{I}_3\n$$\n其中 $\\mathbf{I}_3$ 是 $3 \\times 3$ 的单位矩阵。\n\n这个对角矩阵的逆矩阵很容易计算：\n$$\n(\\mathbf{X}^T\\mathbf{X})^{-1} = \\frac{1}{4}\\mathbf{I}_3 = \\begin{pmatrix} \\frac{1}{4}  0  0 \\\\ 0  \\frac{1}{4}  0 \\\\ 0  0  \\frac{1}{4} \\end{pmatrix}\n$$\n\n现在，我们计算乘积 $\\mathbf{X}^T\\mathbf{y}$：\n$$\n\\mathbf{X}^T\\mathbf{y} = \\begin{pmatrix} 1  1  1  1 \\\\ -1  -1  1  1 \\\\ -1  1  -1  1 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ 4 \\\\ 6 \\\\ 8 \\end{pmatrix} = \\begin{pmatrix} 1(2)+1(4)+1(6)+1(8) \\\\ -1(2)-1(4)+1(6)+1(8) \\\\ -1(2)+1(4)-1(6)+1(8) \\end{pmatrix} = \\begin{pmatrix} 20 \\\\ 8 \\\\ 4 \\end{pmatrix}\n$$\n\n最后，我们将 $(\\mathbf{X}^T\\mathbf{X})^{-1}$ 与 $\\mathbf{X}^T\\mathbf{y}$ 相乘以求得 $\\hat{\\boldsymbol{\\beta}}$：\n$$\n\\hat{\\boldsymbol{\\beta}} = \\begin{pmatrix} \\hat{\\beta}_0 \\\\ \\hat{\\beta}_1 \\\\ \\hat{\\beta}_2 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{4}  0  0 \\\\ 0  \\frac{1}{4}  0 \\\\ 0  0  \\frac{1}{4} \\end{pmatrix} \\begin{pmatrix} 20 \\\\ 8 \\\\ 4 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{4}(20) \\\\ \\frac{1}{4}(8) \\\\ \\frac{1}{4}(4) \\end{pmatrix} = \\begin{pmatrix} 5 \\\\ 2 \\\\ 1 \\end{pmatrix}\n$$\n\n最小二乘估计值为 $\\hat{\\beta}_0 = 5$，$\\hat{\\beta}_1 = 2$，以及 $\\hat{\\beta}_2 = 1$。题目要求将答案表示为行矩阵 $(\\hat{\\beta}_0, \\hat{\\beta}_1, \\hat{\\beta}_2)$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 5  2  1 \\end{pmatrix}}\n$$", "id": "1938980"}, {"introduction": "一个可靠的回归模型需要其预测变量之间没有高度相关性，这个问题被称为多重共线性。本练习将介绍方差膨胀因子（VIF），这是一个用于诊断此问题的关键工具。[@problem_id:1938973] 通过计算VIF，你将学会如何量化多重共线性的严重程度，从而为调整和优化模型结构做出明智的决策。", "problem": "一个经济学家团队正在建立一个多元线性回归模型来预测一个国家的国内生产总值（GDP）。该模型使用多个预测变量，包括国民储蓄率、人口增长率和技术进步率。该团队担心潜在的多重共线性问题，当预测变量之间高度相关时，就会出现多重共线性。为了诊断这个问题，他们对‘国民储蓄率’这个预测变量进行辅助回归，即将其对模型中所有其他预测变量进行回归。从这个辅助回归中得到的决定系数 $R^2$ 为 $0.94$。\n\n计算‘国民储蓄率’预测变量的方差膨胀因子（VIF）。将您的最终答案四舍五入到两位有效数字。", "solution": "在多元线性回归中，一个预测变量的方差膨胀因子（VIF）由辅助回归的决定系数定义为：\n$$\n\\text{VIF} = \\frac{1}{1 - R^2}\n$$\n其中 $R^2$ 是通过将该预测变量对所有其他预测变量进行回归得到的。\n\n给定国民储蓄率的辅助回归的 $R^2 = 0.94$，\n$$\n\\text{VIF} = \\frac{1}{1 - 0.94} = \\frac{1}{0.06} = \\frac{100}{6} = \\frac{50}{3} \\approx 16.666\\ldots\n$$\n四舍五入到两位有效数字得到 $17$。", "answer": "$$\\boxed{17}$$", "id": "1938973"}, {"introduction": "许多回归模型的最终目标是对未曾见过的新数据进行预测。本练习将指导你构建一个预测区间，为未来的观测值提供一个可能的取值范围。[@problem_id:1938959] 这项实践将带领你从单一的点估计，走向考虑模型不确定性的区间预测，这是做出真实可靠预测的关键一步。", "problem": "一家零售分析公司正在开发一个模型，用于预测新快闪店的周销售额。他们收集了 n=30 家现有店铺的数据，并拟合了一个形式如下的多元线性回归模型：\n$$\n\\text{Sales} = \\beta_0 + \\beta_1 \\cdot \\text{Size} + \\beta_2 \\cdot \\text{PopDensity} + \\epsilon\n$$\n其中 `Sales` 以千美元为单位，`Size` 是以平方米为单位的建筑面积，`PopDensity` 是周围1公里半径内的人口密度，以千人/平方公里为单位。\n\n该团队的分析基于样本数据得出了以下结果：\n- 估计的回归方程为：$\\hat{y} = 51.5 + 0.24 x_1 + 14.8 x_2$，其中 $x_1$ 代表面积（Size），$x_2$ 代表人口密度（PopDensity）。\n- 残差标准误：$s_e = 12.5$（单位：千美元）。\n- 模型中预测变量的数量为 k=2。\n\n公司计划在一个人口密度为4.5千人/平方公里的区域开设一家新店，其面积（`Size`）为520平方米。对于这个由向量 $x_0$ 代表的新观测值，统计软件报告的杠杆率相关项的值为 $x_0^T (X^T X)^{-1} x_0 = 0.082$。此处，$X$ 是原始30个观测值的设计矩阵。\n\n使用给定的t分布临界值 $t_{0.05, 27} = 1.703$，为这家新店的周销售额构建一个90%的预测区间。报告该区间的下限和上限。两个值都应以千美元为单位表示，并四舍五入至三位有效数字。", "solution": "题目要求我们为一个多元线性回归模型中的新观测值计算90%的预测区间。已知 $n=30$，$k=2$ 个预测变量，残差标准误 $s_e=12.5$，杠杆项 $h_0=x_0^T(X^TX)^{-1}x_0=0.082$。自由度为 $n-k-1=27$，给定的临界值为 $t_{0.05,27}=1.703$。\n\n当 $x_1=520$，$x_2=4.5$ 时的点预测值可由拟合方程 $\\hat{y}=51.5+0.24x_1+14.8x_2$ 得到：\n$$\n\\hat{y}_0=51.5+0.24\\cdot 520+14.8\\cdot 4.5=51.5+124.8+66.6=242.9.\n$$\n\n预测的标准误为 $s_e\\sqrt{1+h_0}=12.5\\sqrt{1+0.082}=12.5\\sqrt{1.082}$。$90$% 的预测区间为\n$$\n\\hat{y}_0\\pm t_{0.05,27}\\,s_e\\sqrt{1+h_0}\n=242.9\\pm 1.703\\cdot 12.5\\cdot \\sqrt{1.082}.\n$$\n计算边际误差：\n$$\n\\sqrt{1.082}\\approx 1.040192,\\quad 12.5\\cdot \\sqrt{1.082}\\approx 13.0024,\\quad\n1.703\\cdot 13.0024\\approx 22.143.\n$$\n因此，区间的上下限为\n$$\n\\text{Lower}=242.9-22.143\\approx 220.757,\\qquad\n\\text{Upper}=242.9+22.143\\approx 265.043.\n$$\n将每个界限（单位：千美元）四舍五入至三位有效数字，得到 $221$ 和 $265$。", "answer": "$$\\boxed{\\begin{pmatrix}221  265\\end{pmatrix}}$$", "id": "1938959"}]}