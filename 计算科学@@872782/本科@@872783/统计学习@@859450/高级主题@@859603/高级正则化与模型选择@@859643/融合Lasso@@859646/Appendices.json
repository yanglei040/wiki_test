{"hands_on_practices": [{"introduction": "理解融合套索（Fused Lasso）核心机制的最佳方式之一是亲手推导其解路径。本练习提供了一个小规模数据集，要求你随着正则化参数 $\\lambda$ 的变化，手动计算出完整的解，并找出相邻系数发生“融合”的关键 $\\lambda$ 值。通过这个过程，你将对融合过程建立起一个基础且直观的认识 [@problem_id:3122167]。", "problem": "考虑一个长度为 $n=6$ 的链上的一维熔合套索（全变分降噪）问题。给定数据 $y \\in \\mathbb{R}^{6}$，其条目为 $y = (2, 0, 3, 4, 1, 5)$，将调节参数为 $\\lambda \\ge 0$ 的熔合套索估计量 $\\hat{\\beta}(\\lambda) \\in \\mathbb{R}^{6}$ 定义为以下凸优化问题的解\n$$\n\\min_{\\beta \\in \\mathbb{R}^{6}} \\;\\; \\frac{1}{2}\\sum_{i=1}^{6} (\\beta_{i} - y_{i})^{2} \\;+\\; \\lambda \\sum_{i=2}^{6} |\\beta_{i} - \\beta_{i-1}|.\n$$\n从带非光滑惩罚项的凸函数的基本最优性条件（次梯度最优性或 Karush–Kuhn–Tucker 条件）出发，手动推导当 $\\lambda$ 从 0 增大到足以使所有坐标熔合成一个常数时的精确分段线性解路径 $\\hat{\\beta}(\\lambda)$。在你的推导中，请明确：\n- 在差分的活动符号保持不变的每个 $\\lambda$ 区间上，确定 $\\{1,\\dots,6\\}$ 到连续熔合块的分割。\n- 对于每个这样的区间，用块均值和 $\\lambda$ 表示 $\\hat{\\beta}(\\lambda)$ 的块内常数值。\n- 确定所有相邻块熔合时 $\\lambda$ 的临界值。\n\n你最终报告的答案必须是发生熔合时所有不同的正临界值 $\\lambda$ 的有序列表（按升序排列）。给出精确值，不要四舍五入。将列表报告为单个行向量。不需要单位。", "solution": "该问题要求解给定数据向量 $y \\in \\mathbb{R}^6$ 的一维熔合套索估计量 $\\hat{\\beta}(\\lambda)$ 的解路径。该估计量是以下凸优化问题的解：\n$$\n\\min_{\\beta \\in \\mathbb{R}^{6}} L(\\beta) = \\min_{\\beta \\in \\mathbb{R}^{6}} \\left( \\frac{1}{2}\\sum_{i=1}^{6} (\\beta_{i} - y_{i})^{2} \\;+\\; \\lambda \\sum_{i=2}^{6} |\\beta_{i} - \\beta_{i-1}| \\right)\n$$\n其中 $y = (2, 0, 3, 4, 1, 5)$ 且 $\\lambda \\ge 0$。\n\n目标函数 $L(\\beta)$ 是凸函数。Karush-Kuhn-Tucker (KKT) 或次梯度最优性条件表明，向量 $\\hat{\\beta}$ 是一个最小值点，当且仅当零向量位于 $L(\\beta)$ 在 $\\hat{\\beta}$ 处的次微分中。$L(\\beta)$ 的次微分由 $\\partial L(\\beta) = (\\beta - y) + \\lambda \\partial P(\\beta)$ 给出，其中 $P(\\beta)=\\sum_{i=2}^{6} |\\beta_{i} - \\beta_{i-1}|$。\n\n让我们引入与每个差分相关联的对偶变量 $u_i$。最优性条件可以表示为一个原-对偶系统。令 $u_1=0$ 且 $u_{n+1}=u_7=0$。\n这些条件是：\n1. 对于 $i=1, \\dots, 6$，有 $\\hat{\\beta}_i - y_i = u_{i+1} - u_i$。\n2. 对于 $i=2, \\dots, 6$，有 $u_i \\in \\lambda \\cdot \\partial|\\hat{\\beta}_i - \\hat{\\beta}_{i-1}|$。这意味着：\n   - 如果 $\\hat{\\beta}_i - \\hat{\\beta}_{i-1} \\neq 0$，则 $u_i = \\lambda \\cdot \\text{sign}(\\hat{\\beta}_i - \\hat{\\beta}_{i-1})$。\n   - 如果 $\\hat{\\beta}_i - \\hat{\\beta}_{i-1} = 0$，则 $|u_i| \\le \\lambda$。\n\n将第一个条件从 $i=1$ 到 $k$ 求和，我们得到 $\\sum_{i=1}^k (\\hat{\\beta}_i - y_i) = u_{k+1} - u_1 = u_{k+1}$。这提供了一种从原解中求得对偶变量的方法：对于 $k=1, \\dots, 6$，有 $u_{k+1} = \\sum_{i=1}^k (\\hat{\\beta}_i - y_i)$。条件 $u_7=0$ 意味着 $\\sum_{i=1}^6 (\\hat{\\beta}_i - y_i) = 0$，所以 $\\sum_{i=1}^6 \\hat{\\beta}_i = \\sum_{i=1}^6 y_i$。\n\n我们通过将 $\\lambda$ 从 0 开始增加来追踪解路径 $\\hat{\\beta}(\\lambda)$。\n\n**区间 1：$\\lambda \\in [0, \\lambda_1]$**\n对于 $\\lambda=0$，解为 $\\hat{\\beta}(0) = y = (2, 0, 3, 4, 1, 5)$。\n差分为：\n$\\beta_2 - \\beta_1 = -2$\n$\\beta_3 - \\beta_2 = 3$\n$\\beta_4 - \\beta_3 = 1$\n$\\beta_5 - \\beta_4 = -3$\n$\\beta_6 - \\beta_5 = 4$\n对于 $\\lambda > 0$ 且足够小的情况，差分的符号保持不变。活动符号为 $s = (\\text{sign}(\\beta_2-\\beta_1), \\dots, \\text{sign}(\\beta_6-\\beta_5)) = (-1, 1, 1, -1, 1)$。\n这意味着对于 $i=2, \\dots, 6$，有 $u_i = \\lambda s_i$：\n$u_2 = -\\lambda$, $u_3 = \\lambda$, $u_4 = \\lambda$, $u_5 = -\\lambda$, $u_6 = \\lambda$。同时 $u_1=0$ 且 $u_7=0$。\n\n使用 $\\hat{\\beta}_i = y_i + u_{i+1} - u_i$，我们求得分段线性路径：\n$\\hat{\\beta}_1(\\lambda) = y_1 + u_2 - u_1 = 2 - \\lambda - 0 = 2 - \\lambda$\n$\\hat{\\beta}_2(\\lambda) = y_2 + u_3 - u_2 = 0 + \\lambda - (-\\lambda) = 2\\lambda$\n$\\hat{\\beta}_3(\\lambda) = y_3 + u_4 - u_3 = 3 + \\lambda - \\lambda = 3$\n$\\hat{\\beta}_4(\\lambda) = y_4 + u_5 - u_4 = 4 - \\lambda - \\lambda = 4 - 2\\lambda$\n$\\hat{\\beta}_5(\\lambda) = y_5 + u_6 - u_5 = 1 + \\lambda - (-\\lambda) = 1 + 2\\lambda$\n$\\hat{\\beta}_6(\\lambda) = y_6 + u_7 - u_6 = 5 + 0 - \\lambda = 5 - \\lambda$\n\n该路径在差分符号 $(-1, 1, 1, -1, 1)$ 保持不变时有效。这要求以下条件全部成立：\n$\\beta_2 - \\beta_1 = 3\\lambda - 2  0 \\implies \\lambda  2/3$\n$\\beta_3 - \\beta_2 = 3 - 2\\lambda > 0 \\implies \\lambda  3/2$\n$\\beta_4 - \\beta_3 = 1 - 2\\lambda > 0 \\implies \\lambda  1/2$\n$\\beta_5 - \\beta_4 = 4\\lambda - 3  0 \\implies \\lambda  3/4$\n$\\beta_6 - \\beta_5 = 4 - 3\\lambda > 0 \\implies \\lambda  4/3$\n当 $\\lambda$ 从 0 增加时，第一个被违反的条件是 $\\lambda  1/2$。因此，第一个熔合事件发生在 $\\lambda_1 = 1/2$ 处，此时 $\\beta_4 - \\beta_3 = 0$。\n\n**区间 2：$\\lambda \\in [1/2, \\lambda_2]$**\n在 $\\lambda_1 = 1/2$ 处，下标 3 和 4 熔合。对于 $\\lambda  1/2$，我们得到块划分 $\\{\\{1\\}, \\{2\\}, \\{3,4\\}, \\{5\\}, \\{6\\}\\}$。\n条件 $\\beta_3 = \\beta_4$ 意味着 $|u_4| \\le \\lambda$。其他差分保持非零，所以 $u_2 = -\\lambda, u_3 = \\lambda, u_5 = -\\lambda, u_6 = \\lambda$。\n我们有 $\\hat{\\beta}_3 = y_3 + u_4 - u_3 = 3+u_4-\\lambda$ 和 $\\hat{\\beta}_4 = y_4 + u_5 - u_4 = 4-\\lambda-u_4$。\n令 $\\hat{\\beta}_3 = \\hat{\\beta}_4$ 可得 $3+u_4-\\lambda = 4-\\lambda-u_4 \\implies 2u_4=1 \\implies u_4 = 1/2$。\n条件 $|u_4| \\le \\lambda$ 变为 $1/2 \\le \\lambda$，这与 $\\lambda  \\lambda_1$ 是一致的。\n块 $\\{3,4\\}$ 的共同值是 $\\hat{\\beta}_{3,4}(\\lambda) = 3 + 1/2 - \\lambda = 3.5 - \\lambda$。这等于 $\\frac{y_3+y_4}{2} + \\frac{u_5-u_3}{2} = \\frac{3+4}{2} + \\frac{-\\lambda-\\lambda}{2} = 3.5 - \\lambda$。\n其他系数和之前一样：$\\hat{\\beta}_1(\\lambda) = 2-\\lambda$，$\\hat{\\beta}_2(\\lambda) = 2\\lambda$，$\\hat{\\beta}_5(\\lambda) = 1+2\\lambda$，$\\hat{\\beta}_6(\\lambda) = 5-\\lambda$。\n分割为 $\\{1\\}, \\{2\\}, \\{3,4\\}, \\{5\\}, \\{6\\}\\}$。\n解路径为 $\\hat{\\beta}(\\lambda) = (2-\\lambda, 2\\lambda, 3.5-\\lambda, 3.5-\\lambda, 1+2\\lambda, 5-\\lambda)$。\n检查块之间的差分符号。在 $\\lambda=1/2$ 之后，符号为 $(-1, 1, -1, 1)$。该解路径在这些符号保持不变时有效：\n$\\beta_2 - \\beta_1 = 3\\lambda - 2  0 \\implies \\lambda  2/3$\n$\\beta_3 - \\beta_2 = 3.5 - 3\\lambda > 0 \\implies \\lambda  7/6$\n$\\beta_5 - \\beta_4 = 3\\lambda - 2.5  0 \\implies \\lambda  5/6$\n$\\beta_6 - \\beta_5 = 4 - 3\\lambda > 0 \\implies \\lambda  4/3$\n当 $\\lambda$ 从 $1/2$ 增加时，下一个被违反的条件是 $\\lambda  2/3$。下一次熔合发生在 $\\lambda_2 = 2/3$ 处，此时下标 1 和 2 熔合。\n\n**区间 3：$\\lambda \\in [2/3, \\lambda_3]$**\n在 $\\lambda_2 = 2/3$ 处，下标 1 和 2 熔合。块划分变为 $\\{\\{1,2\\}, \\{3,4\\}, \\{5\\}, \\{6\\}\\}$。\n这意味着 $|u_2| \\le \\lambda$ 且 $|u_4|=1/2 \\le \\lambda$。块之间的活动符号意味着 $u_3=\\lambda$, $u_5=-\\lambda$, $u_6=\\lambda$。\n我们使用块 $B$ 的通用公式：$\\hat{\\beta}_B(\\lambda) = \\frac{1}{|B|}\\sum_{i \\in B} y_i + \\frac{u_{\\max(B)+1} - u_{\\min(B)}}{|B|}$。\n$\\hat{\\beta}_{\\{1,2\\}}(\\lambda) = \\frac{y_1+y_2}{2} + \\frac{u_3-u_1}{2} = \\frac{2+0}{2} + \\frac{\\lambda-0}{2} = 1 + \\lambda/2$。\n$\\hat{\\beta}_{\\{3,4\\}}(\\lambda) = \\frac{y_3+y_4}{2} + \\frac{u_5-u_3}{2} = \\frac{3+4}{2} + \\frac{-\\lambda-\\lambda}{2} = 3.5 - \\lambda$。\n$\\hat{\\beta}_5(\\lambda) = y_5 + u_6 - u_5 = 1 + \\lambda - (-\\lambda) = 1 + 2\\lambda$。\n$\\hat{\\beta}_6(\\lambda) = y_6 + u_7 - u_6 = 5 - \\lambda$。\n检查块之间的差分符号。在 $\\lambda=2/3$ 之后，符号为 $(1, -1, 1)$。该解路径在这些符号保持不变时有效：\n$\\beta_3 - \\beta_2 = 2.5 - 1.5\\lambda > 0 \\implies \\lambda  5/3$。\n$\\beta_5 - \\beta_4 = 3\\lambda - 2.5  0 \\implies \\lambda  5/6$。\n$\\beta_6 - \\beta_5 = 4 - 3\\lambda > 0 \\implies \\lambda  4/3$。\n当 $\\lambda$ 从 $2/3$ 增加时，下一个被违反的条件是 $\\lambda  5/6$。下一次熔合发生在 $\\lambda_3 = 5/6$ 处，此时块 $\\{3,4\\}$ 与 $\\{5\\}$ 熔合。\n\n**区间 4：$\\lambda \\in [5/6, \\lambda_4]$**\n在 $\\lambda_3 = 5/6$ 处，块 $\\{3,4\\}$ 与下标 5 熔合。划分变为 $\\{\\{1,2\\}, \\{3,4,5\\}, \\{6\\}\\}$。\n这意味着 $|u_2|, |u_4|, |u_5| \\le \\lambda$。活动符号意味着 $u_3=\\lambda, u_6=\\lambda$。\n$\\hat{\\beta}_{\\{1,2\\}}(\\lambda) = \\frac{y_1+y_2}{2} + \\frac{u_3-u_1}{2} = 1 + \\lambda/2$。\n$\\hat{\\beta}_{\\{3,4,5\\}}(\\lambda) = \\frac{y_3+y_4+y_5}{3} + \\frac{u_6-u_3}{3} = \\frac{3+4+1}{3} + \\frac{\\lambda-\\lambda}{3} = 8/3$。\n$\\hat{\\beta}_6(\\lambda) = y_6 + u_7 - u_6 = 5 - \\lambda$。\n检查块之间的差分符号。在 $\\lambda=5/6$ 之后，符号为 $(1, 1)$。该解路径在这些符号保持不变时有效：\n$\\beta_3 - \\beta_2 = 5/3 - \\lambda/2 > 0 \\implies \\lambda  10/3$。\n$\\beta_6 - \\beta_5 = 7/3 - \\lambda > 0 \\implies \\lambda  7/3$。\n当 $\\lambda$ 从 $5/6$ 增加时，下一个被违反的条件是 $\\lambda  7/3$。下一次熔合发生在 $\\lambda_4 = 7/3$ 处，此时块 $\\{3,4,5\\}$ 与 $\\{6\\}$ 熔合。\n\n**区间 5：$\\lambda \\in [7/3, \\lambda_5]$**\n在 $\\lambda_4 = 7/3$ 处，块 $\\{3,4,5\\}$ 与下标 6 熔合。划分为 $\\{\\{1,2\\}, \\{3,4,5,6\\}\\}$。\n块之间的活动符号意味着 $u_3=\\lambda$。\n$\\hat{\\beta}_{\\{1,2\\}}(\\lambda) = \\frac{y_1+y_2}{2} + \\frac{u_3-u_1}{2} = 1 + \\lambda/2$。\n$\\hat{\\beta}_{\\{3,4,5,6\\}}(\\lambda) = \\frac{y_3+y_4+y_5+y_6}{4} + \\frac{u_7-u_3}{4} = \\frac{3+4+1+5}{4} + \\frac{0-\\lambda}{4} = 13/4 - \\lambda/4$。\n检查两个块之间的差分符号。在 $\\lambda=7/3$ 之后，符号为 $(1)$。该解路径在符号保持不变时有效：\n$\\beta_3 - \\beta_2 = 9/4 - 3\\lambda/4 > 0 \\implies \\lambda  3$。\n最终的熔合发生在 $\\lambda_5 = 3$ 处，此时两个剩余的块合并。\n\n**对于 $\\lambda \\ge 3$**\n所有系数都熔合成一个单一的块 $\\{1, \\dots, 6\\}$。解在所有下标上都是常数，等于数据的全局均值：\n$\\hat{\\beta}_i(\\lambda) = \\bar{y} = \\frac{1}{6}\\sum_{i=1}^6 y_i = \\frac{2+0+3+4+1+5}{6} = \\frac{15}{6} = 2.5$。\n作为检验，在 $\\lambda=3$ 处：\n$\\hat{\\beta}_{\\{1,2\\}}(3) = 1 + 3/2 = 2.5$。\n$\\hat{\\beta}_{\\{3,4,5,6\\}}(3) = 13/4 - 3/4 = 10/4 = 2.5$。\n解在临界值处是连续的，正如预期。\n\n发生熔合时 $\\lambda$ 的正的、不同的临界值，按升序排列为：\n$\\lambda_1 = 1/2$\n$\\lambda_2 = 2/3$\n$\\lambda_3 = 5/6$\n$\\lambda_4 = 7/3$\n$\\lambda_5 = 3$\n\n有序列表为 $(\\frac{1}{2}, \\frac{2}{3}, \\frac{5}{6}, \\frac{7}{3}, 3)$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{2}  \\frac{2}{3}  \\frac{5}{6}  \\frac{7}{3}  3\n\\end{pmatrix}\n}\n$$", "id": "3122167"}, {"introduction": "在掌握了基本的融合机制后，本练习将引导你探索输入数据本身的结构如何影响最终结果。通过对比一个简单情形与一个复制了某个数据点的情形，你将研究重复数据点是使融合变得更容易还是更困难。这个练习有助于加深你对数据保真项和惩罚项之间相互作用的直观理解 [@problem_id:3122140]。", "problem": "考虑一维融合套索信号近似器 (Fused Lasso Signal Approximator, FLSA)，它通过求解以下问题来从观测值 $y = (y_{1}, \\dots, y_{n})$ 估计参数序列 $\\beta = (\\beta_{1}, \\dots, \\beta_{n})$\n$$\n\\min_{\\beta \\in \\mathbb{R}^{n}} \\;\\; \\frac{1}{2}\\sum_{i=1}^{n} (y_{i} - \\beta_{i})^{2} \\;+\\; \\lambda \\sum_{i=1}^{n-1} |\\beta_{i+1} - \\beta_{i}|,\n$$\n其中 $\\lambda \\ge 0$ 是正则化强度， $|\\cdot|$ 表示绝对值。您将研究复制一个索引（创建一个具有相同观测值并相邻放置在链中的克隆数据点）如何影响 FLSA 融合相邻系数的趋势。\n\n比较以下两种情况。\n\n情况 I（无复制）：$y^{(1)} = (0, 3)$，其中 $n=2$。\n\n情况 II（复制第二个索引）：$y^{(2)} = (0, 3, 3)$，其中 $n=3$。\n\n对于每种情况，将“跨边界的局部融合”定义为边界左右两侧的估计系数相等的事件。具体来说，在情况 I 中，这意味着 $\\beta_{1} = \\beta_{2}$。在情况 II 中，这意味着 $\\beta_{1} = \\beta_{2} = \\beta_{3}$（即，最左边的系数等于复制的右侧的共同值）。\n\n令 $\\lambda^{\\star}$ 表示在最优解中实现这种跨边界局部融合所需的最小正则化强度。仅基于上述 FLSA 目标函数的基本原理（不提供额外公式），关于复制索引效果的哪个陈述是正确的？\n\nA. 复制索引会增加 $\\lambda^{\\star}$，因此重复点会削弱跨该边界的局部融合（即更难跨越边界进行融合）。\n\nB. 复制索引会减小 $\\lambda^{\\star}$，因此重复点会加强跨该边界的局部融合（即更容易跨越边界进行融合）。\n\nC. 如果重复点具有相同的观测值，复制索引对 $\\lambda^{\\star}$ 没有影响，因此跨边界的融合趋势不变。\n\nD. 复制索引会强制在任何 $\\lambda  0$ 时立即跨边界融合，因为额外的总变差惩罚施加了更强的相等性。", "solution": "问题要求比较在两种涉及一维融合套索信号近似器 (FLSA) 的情况下，实现局部融合所需的临界正则化强度 $\\lambda^{\\star}$。目标函数由下式给出：\n$$\nL(\\beta) = \\frac{1}{2}\\sum_{i=1}^{n} (y_{i} - \\beta_{i})^{2} \\;+\\; \\lambda \\sum_{i=1}^{n-1} |\\beta_{i+1} - \\beta_{i}|\n$$\n该函数是凸函数，对于 $\\lambda \\geq 0$，存在唯一的最小化子 $\\hat{\\beta}$。最优性条件（Karush-Kuhn-Tucker，或 KKT）指出，零向量必须位于解 $\\hat{\\beta}$ 处 $L(\\beta)$ 的次梯度中。\n\n$L(\\beta)$ 关于分量 $\\beta_k$ 的次梯度由下式给出：\n- 对于 $k=1$：$\\frac{\\partial L}{\\partial \\beta_1} = (\\beta_1 - y_1) - \\lambda g_1$\n- 对于 $k \\in \\{2, \\dots, n-1\\}$：$\\frac{\\partial L}{\\partial \\beta_k} = (\\beta_k - y_k) + \\lambda (g_{k-1} - g_k)$\n- 对于 $k=n$：$\\frac{\\partial L}{\\partial \\beta_n} = (\\beta_n - y_n) + \\lambda g_{n-1}$\n其中 $g_i \\in \\partial|\\beta_{i+1}-\\beta_i|$。这意味着如果 $\\beta_{i+1} \\neq \\beta_i$，则 $g_i = \\text{sign}(\\beta_{i+1}-\\beta_i)$；如果 $\\beta_{i+1} = \\beta_i$，则 $g_i \\in [-1, 1]$。\n\n在最优解 $\\hat{\\beta}$ 处，这些次梯度必须为零。KKT 条件是：\n1. $\\hat{\\beta}_1 - y_1 - \\lambda g_1 = 0$\n2. $\\hat{\\beta}_k - y_k + \\lambda (g_{k-1} - g_k) = 0$ 对于 $k=2, \\dots, n-1$\n3. $\\hat{\\beta}_n - y_n + \\lambda g_{n-1} = 0$\n\n我们现在将应用这些基本原理来为每种情况找到 $\\lambda^{\\star}$。\n\n### 情况 I 分析\n这里，$n=2$ 且 $y^{(1)} = (0, 3)$。目标函数是：\n$$\nL(\\beta_1, \\beta_2) = \\frac{1}{2}(\\beta_1 - 0)^2 + \\frac{1}{2}(\\beta_2 - 3)^2 + \\lambda |\\beta_2 - \\beta_1|\n$$\nKKT 条件是：\n1. $\\beta_1 - 0 - \\lambda g_1 = 0$\n2. $\\beta_2 - 3 + \\lambda g_1 = 0$\n其中 $g_1 \\in \\partial|\\beta_2-\\beta_1|$。\n\n对于较小的 $\\lambda  0$，我们预期解 $\\hat{\\beta}$ 会接近 $y$，所以 $\\hat{\\beta}_1 \\approx 0$ 且 $\\hat{\\beta}_2 \\approx 3$。这表明 $\\hat{\\beta}_2  \\hat{\\beta}_1$。在这种未融合的情况下，我们必须有 $g_1 = \\text{sign}(\\beta_2 - \\beta_1) = 1$。KKT 条件简化为：\n1. $\\beta_1 - \\lambda = 0 \\implies \\beta_1 = \\lambda$\n2. $\\beta_2 - 3 + \\lambda = 0 \\implies \\beta_2 = 3 - \\lambda$\n\n只要初始假设 $\\beta_2  \\beta_1$ 成立，这个解就有效。\n$3 - \\lambda  \\lambda \\implies 3  2\\lambda \\implies \\lambda  1.5$。\n\n在边界 $\\lambda = 1.5$ 处，我们发现 $\\beta_1 = 1.5$ 且 $\\beta_2 = 3 - 1.5 = 1.5$。因此，$\\beta_1 = \\beta_2$。这就是融合点。\n问题将 $\\lambda^{\\star}$ 定义为实现局部融合的最小正则化强度。因此，对于情况 I，$\\lambda_I^{\\star} = 1.5$。\n\n为了完整起见，我们来验证 $\\lambda \\ge 1.5$ 时的解。在融合的情况下，$\\beta_1 = \\beta_2 = \\beta_c$。KKT 条件变为：\n1. $\\beta_c - 0 - \\lambda g_1 = 0$\n2. $\\beta_c - 3 + \\lambda g_1 = 0$\n其中 $g_1$ 可以是 $[-1, 1]$ 中的任何值。将两个方程相加得到 $2\\beta_c - 3 = 0$，这给出了融合值 $\\beta_c = 1.5$。将其代入第一个方程得到 $1.5 - \\lambda g_1 = 0$，所以 $g_1 = 1.5/\\lambda$。此解为有效次梯度的条件是 $g_1 \\in [-1, 1]$，即 $|1.5/\\lambda| \\le 1$。由于 $\\lambda \\ge 0$，这要求 $\\lambda \\ge 1.5$。这证实了对于所有 $\\lambda \\ge 1.5$ 都会发生融合。\n\n### 情况 II 分析\n这里，$n=3$ 且 $y^{(2)} = (0, 3, 3)$。目标函数是：\n$$\nL(\\beta_1, \\beta_2, \\beta_3) = \\frac{1}{2}(\\beta_1 - 0)^2 + \\frac{1}{2}(\\beta_2 - 3)^2 + \\frac{1}{2}(\\beta_3 - 3)^2 + \\lambda (|\\beta_2 - \\beta_1| + |\\beta_3 - \\beta_2|)\n$$\nKKT 条件是：\n1. $\\beta_1 - 0 - \\lambda g_1 = 0$\n2. $\\beta_2 - 3 + \\lambda(g_1 - g_2) = 0$\n3. $\\beta_3 - 3 + \\lambda g_2 = 0$\n其中 $g_1 \\in \\partial|\\beta_2-\\beta_1|$ 且 $g_2 \\in \\partial|\\beta_3-\\beta_2|$。\n\n首先，我们分析 $\\beta_2$ 和 $\\beta_3$ 之间的关系。由于 $y_2=y_3=3$，没有数据证据来区分它们。任何对 $|\\beta_3 - \\beta_2|$ 的惩罚 $\\lambda  0$ 都会驱使它们靠拢。我们可以正式证明对于任何 $\\lambda  0$，$\\beta_2 = \\beta_3$。如果我们假设 $\\beta_2 \\neq \\beta_3$，我们将有 $g_2 = \\text{sign}(\\beta_3-\\beta_2) \\in \\{-1, 1\\}$。但这会导致 KKT 系统内的矛盾，如通过对方程 (2) 和 (3) 的代数操作所示。因此，对于任何 $\\lambda  0$，解必须有 $\\beta_2 = \\beta_3$，因此 $g_2 \\in [-1, 1]$。这就是在“复制的右侧”上的融合。\n\n问题将“跨边界的局部融合”定义为事件 $\\beta_1 = \\beta_2 = \\beta_3$。我们需要找到使之发生的最小 $\\lambda$。\n给定 $\\beta_2 = \\beta_3$，我们来分析 $\\beta_1 \\neq \\beta_2$ 的情况。与情况 I 一样，我们预期 $\\beta_1 \\approx 0$ 且 $\\beta_2 \\approx 3$，所以我们假设 $\\beta_2  \\beta_1$，这意味着 $g_1 = 1$。KKT 条件变为：\n1. $\\beta_1 - \\lambda = 0 \\implies \\beta_1 = \\lambda$\n2. $\\beta_2 - 3 + \\lambda(1 - g_2) = 0$\n3. $\\beta_2 - 3 + \\lambda g_2 = 0$\n\n从方程 (3)，我们有 $\\lambda g_2 = 3 - \\beta_2$。将其代入 (2) 得到 $\\beta_2 - 3 + \\lambda - (3 - \\beta_2) = 0$，简化为 $2\\beta_2 - 6 + \\lambda = 0$。这得出 $\\beta_2 = 3 - \\lambda/2$。\n只要我们的假设 $\\beta_2  \\beta_1$ 成立，这个解就有效：\n$3 - \\lambda/2  \\lambda \\implies 3  3\\lambda/2 \\implies 6  3\\lambda \\implies \\lambda  2$。\n\n在边界 $\\lambda = 2$ 处，我们发现 $\\beta_1 = 2$ 且 $\\beta_2 = 3 - 2/2 = 2$。因为我们已经知道 $\\beta_2 = \\beta_3$，此时我们有 $\\beta_1 = \\beta_2 = \\beta_3 = 2$。这就是问题中定义的完全融合点。\n因此，对于情况 II，$\\lambda_{II}^{\\star} = 2$。\n\n同样，为了完整起见，我们验证对于 $\\lambda \\ge 2$ 的完全融合解 $\\beta_1 = \\beta_2 = \\beta_3 = \\beta_c$。将三个 KKT 方程相加得到 $\\beta_1 + \\beta_2 + \\beta_3 - (y_1+y_2+y_3) = 0$，所以 $3\\beta_c - (0+3+3) = 0$，这给出 $\\beta_c = 2$。\n将 $\\beta_c=2$ 代入 KKT 系统：\n1. $2 - 0 - \\lambda g_1 = 0 \\implies g_1 = 2/\\lambda$\n3. $2 - 3 + \\lambda g_2 = 0 \\implies g_2 = 1/\\lambda$\n这些是有效的次梯度，只要 $|g_1| \\le 1$ 且 $|g_2| \\le 1$。\n$|2/\\lambda| \\le 1 \\implies \\lambda \\ge 2$。\n$|1/\\lambda| \\le 1 \\implies \\lambda \\ge 1$。\n两个条件都必须成立，所以我们必须有 $\\lambda \\ge 2$。这证实了对于 $\\lambda \\ge 2$ 会发生完全融合。\n\n### 比较与结论\n我们从基本原理推导出了临界正则化强度：\n-   情况 I：$\\lambda_I^{\\star} = 1.5$\n-   情况 II：$\\lambda_{II}^{\\star} = 2$\n\n我们观察到 $\\lambda_{II}^{\\star}  \\lambda_I^{\\star}$。这意味着当右侧的数据点被复制时，需要更强的正则化惩罚才能实现跨边界的融合。复制索引使得最左边的系数更难与其右侧的系数融合。\n\n现在，我们评估给出的选项：\n\n**A. 复制索引会增加 $\\lambda^{\\star}$，因此重复点会削弱跨该边界的局部融合（即更难跨越边界进行融合）。**\n我们的分析表明 $\\lambda^{\\star}$ 从 $1.5$ 增加到 $2$。更高的 $\\lambda^{\\star}$ 意味着需要更强的惩罚来引起融合，这意味着融合“更弱”或“更难实现”。这个陈述与我们的发现一致。\n**结论：正确。**\n\n**B. 复制索引会减小 $\\lambda^{\\star}$，因此重复点会加强跨该边界的局部融合（即更容易跨越边界进行融合）。**\n我们的分析表明 $\\lambda^{\\star}$ 增加，而不是减少。\n**结论：不正确。**\n\n**C. 如果重复点具有相同的观测值，复制索引对 $\\lambda^{\\star}$ 没有影响，因此跨边界的融合趋势不变。**\n我们的分析表明 $\\lambda^{\\star}$ 从 $1.5$ 变为 $2$。\n**结论：不正确。**\n\n**D. 复制索引会强制在任何 $\\lambda  0$ 时立即跨边界融合，因为额外的总变差惩罚施加了更强的相等性。**\n我们的分析表明，跨边界的融合（即 $\\beta_1 = \\beta_2$）仅在 $\\lambda = 2$ 时发生。对于任何 $\\lambda  0$ 发生的融合是重复点之间的融合（$\\beta_2 = \\beta_3$），而不是我们关心的跨边界融合。\n**结论：不正确。**", "answer": "$$\\boxed{A}$$", "id": "3122140"}, {"introduction": "理解了融合套索的运作机理后，我们现在转向其作为估计量的统计特性。本练习将问题简化为一个仅含单个跳变点的信号，并要求你推导估计出的跳变幅度。这个过程将揭示融合套索的一个基本性质：它会引入一种可预测的偏差，系统性地向零收缩估计的跳变幅度，从而让你更深刻地理解其作为去噪工具的行为 [@problem_id:3122180]。", "problem": "考虑一个分段常数信号的一维融合最小绝对收缩和选择算子（fused lasso）去噪问题，该信号恰好有两个常数段。假设有来自第一段的 $m_1$ 个连续观测值，其真实水平为 $\\theta_1$，随后是来自第二段的 $m_2$ 个连续观测值，其真实水平为 $\\theta_2$。其中，真实跳跃幅度为 $\\Delta = \\theta_2 - \\theta_1$ 且满足 $\\Delta  0$。观测值遵循 $y_i = \\theta_i + \\varepsilon_i$，其中 $\\varepsilon_i$ 是独立同分布（i.i.d.）的 $\\mathcal{N}(0,\\sigma^2)$ 噪声。融合 lasso 估计量 $\\hat{\\beta} = (\\hat{\\beta}_1,\\ldots,\\hat{\\beta}_{m_1+m_2})$ 解决了以下优化问题\n$$\n\\min_{\\beta \\in \\mathbb{R}^{m_1+m_2}} \\;\\; \\frac{1}{2}\\sum_{i=1}^{m_1+m_2} (y_i - \\beta_i)^2 \\;+\\; \\lambda \\sum_{i=2}^{m_1+m_2} |\\beta_i - \\beta_{i-1}|,\n$$\n其中调节参数 $\\lambda  0$。假设我们将注意力限制在每一段内为常数的估计量上，即对于 $i \\in \\{1,\\ldots,m_1\\}$ 有 $\\beta_i = \\mu_1$，对于 $i \\in \\{m_1+1,\\ldots,m_1+m_2\\}$ 有 $\\beta_i = \\mu_2$。将每段内的样本均值表示为 $\\bar{y}_1 = \\frac{1}{m_1}\\sum_{i=1}^{m_1} y_i$ 和 $\\bar{y}_2 = \\frac{1}{m_2}\\sum_{i=m_1+1}^{m_1+m_2} y_i$，并定义估计的跳跃幅度 $J_{\\text{hat}} = \\mu_2 - \\mu_1$。\n\n仅使用凸估计的基本定义和最优化原理，推导 $J_{\\text{hat}}$ 关于 $\\bar{y}_1$、$\\bar{y}_2$、$\\lambda$、$m_1$ 和 $m_2$ 的闭式表达式。然后，在 $\\Delta  0$ 且 $J_{\\text{hat}}$ 被收缩至零的概率可忽略不计的高信噪比情况下，使用您的表达式获得期望的估计跳跃幅度 $\\mathbb{E}[J_{\\text{hat}}]$ 关于 $\\Delta$、$\\lambda$、$m_1$ 和 $m_2$ 的一阶近似。\n\n以 $\\mathbb{E}[J_{\\text{hat}}]$ 关于 $\\Delta$、$\\lambda$、$m_1$ 和 $m_2$ 的单一闭式解析表达式的形式提供您的最终答案。", "solution": "本问题要求在一个简化的融合 lasso 设置下，推导估计跳跃幅度的闭式表达式，然后在高信噪比假设下求其期望值。\n\n首先，我们处理在指定约束下的优化问题。融合 lasso 目标函数由下式给出\n$$\nL(\\beta) = \\frac{1}{2}\\sum_{i=1}^{m_1+m_2} (y_i - \\beta_i)^2 \\;+\\; \\lambda \\sum_{i=2}^{m_1+m_2} |\\beta_i - \\beta_{i-1}|\n$$\n我们已知约束条件是解为具有两个分段的分段常数，这与真实的潜在结构相对应。这意味着解向量 $\\beta$ 的形式为：当 $i \\in \\{1, \\dots, m_1\\}$ 时 $\\beta_i = \\mu_1$，当 $i \\in \\{m_1+1, \\dots, m_1+m_2\\}$ 时 $\\beta_i = \\mu_2$。我们可以将此结构代入目标函数 $L(\\beta)$，以获得一个关于 $\\mu_1$ 和 $\\mu_2$ 的新目标函数。\n\n平方和项变为：\n$$\n\\frac{1}{2}\\sum_{i=1}^{m_1} (y_i - \\mu_1)^2 + \\frac{1}{2}\\sum_{i=m_1+1}^{m_1+m_2} (y_i - \\mu_2)^2\n$$\n对于一组固定的观测值 $\\{y_i\\}$，关于 $\\mu_1$ 和 $\\mu_2$ 最小化此项等价于最小化\n$$\n\\frac{m_1}{2}(\\mu_1 - \\bar{y}_1)^2 + \\frac{m_2}{2}(\\mu_2 - \\bar{y}_2)^2\n$$\n加上不依赖于 $\\mu_1$ 或 $\\mu_2$ 的项。这里，$\\bar{y}_1 = \\frac{1}{m_1}\\sum_{i=1}^{m_1} y_i$ 和 $\\bar{y}_2 = \\frac{1}{m_2}\\sum_{i=m_1+1}^{m_1+m_2} y_i$ 是两个分段的样本均值。\n\n在约束条件下，惩罚项 $\\lambda \\sum_{i=2}^{m_1+m_2} |\\beta_i - \\beta_{i-1}|$ 大大简化。除了 $i=m_1+1$ 之外，所有 $i$ 的差值 $\\beta_i - \\beta_{i-1}$ 都为零。在这一点上，$\\beta_{m_1+1} = \\mu_2$ 且 $\\beta_{m_1} = \\mu_1$。因此，惩罚项简化为 $\\lambda|\\mu_2 - \\mu_1|$。\n\n结合这些，优化问题变成一个关于 $\\mu_1$ 和 $\\mu_2$ 的二维问题：\n$$\n\\min_{\\mu_1, \\mu_2 \\in \\mathbb{R}} \\;\\; F(\\mu_1, \\mu_2) = \\frac{m_1}{2}(\\mu_1 - \\bar{y}_1)^2 + \\frac{m_2}{2}(\\mu_2 - \\bar{y}_2)^2 + \\lambda |\\mu_2 - \\mu_1|\n$$\n这是一个凸优化问题。通过将 $F(\\mu_1, \\mu_2)$ 的次梯度设为零，可以找到最小值 $(\\hat{\\mu}_1, \\hat{\\mu}_2)$。次梯度方程为：\n$$\n\\frac{\\partial F}{\\partial \\mu_1}: \\quad m_1(\\hat{\\mu}_1 - \\bar{y}_1) - \\lambda s = 0\n$$\n$$\n\\frac{\\partial F}{\\partial \\mu_2}: \\quad m_2(\\hat{\\mu}_2 - \\bar{y}_2) + \\lambda s = 0\n$$\n其中 $s$ 是绝对值函数在 $\\hat{\\mu}_2 - \\hat{\\mu}_1$ 处的次微分的一个元素。具体来说，如果 $\\hat{\\mu}_2 \\neq \\hat{\\mu}_1$，则 $s = \\text{sign}(\\hat{\\mu}_2 - \\hat{\\mu}_1)$；如果 $\\hat{\\mu}_2 = \\hat{\\mu}_1$，则 $s \\in [-1, 1]$。\n\n从这些方程中，我们可以表达出 $\\hat{\\mu}_1$ 和 $\\hat{\\mu}_2$：\n$$\n\\hat{\\mu}_1 = \\bar{y}_1 + \\frac{\\lambda s}{m_1}\n$$\n$$\n\\hat{\\mu}_2 = \\bar{y}_2 - \\frac{\\lambda s}{m_2}\n$$\n估计的跳跃幅度为 $J_{\\text{hat}} = \\hat{\\mu}_2 - \\hat{\\mu}_1$。将两个方程相减得到：\n$$\nJ_{\\text{hat}} = (\\bar{y}_2 - \\bar{y}_1) - \\lambda s \\left(\\frac{1}{m_1} + \\frac{1}{m_2}\\right)\n$$\n令 $D = \\bar{y}_2 - \\bar{y}_1$ 且 $C = \\lambda \\left(\\frac{1}{m_1} + \\frac{1}{m_2}\\right)$。方程变为 $J_{\\text{hat}} = D - sC$。我们根据 $s$ 的值对此进行分析：\n1.  如果 $J_{\\text{hat}}  0$，则必须有 $s=1$。解为 $J_{\\text{hat}} = D - C$。这种情况仅在 $D-C  0$ 时自洽，即 $D  C$。\n2.  如果 $J_{\\text{hat}}  0$，则必须有 $s=-1$。解为 $J_{\\text{hat}} = D + C$。这种情况仅在 $D+C  0$ 时自洽，即 $D  -C$。\n3.  如果 $J_{\\text{hat}} = 0$，我们有 $0 = D - sC$，这意味着 $s = D/C$（假设 $C0$）。这要求 $s \\in [-1, 1]$，等价于 $|D/C| \\le 1$，或 $|D| \\le C$。\n\n综合这三种情况，可以得到 $J_{\\text{hat}}$ 的单一表达式：\n$$\nJ_{\\text{hat}} = \n\\begin{cases}\nD - C  \\text{if } D  C \\\\\n0  \\text{if } |D| \\le C \\\\\nD + C  \\text{if } D  -C\n\\end{cases}\n$$\n这是应用于 $D$ 的软阈值函数，阈值为 $C$。它可以紧凑地写为 $J_{\\text{hat}} = \\text{sign}(D)(|D|-C)_+$，其中 $(x)_+ = \\max(x,0)$。代回 $D$ 和 $C$ 的表达式，我们得到：\n$$\nJ_{\\text{hat}} = \\text{sign}(\\bar{y}_2 - \\bar{y}_1) \\left( |\\bar{y}_2 - \\bar{y}_1| - \\lambda\\left(\\frac{1}{m_1} + \\frac{1}{m_2}\\right) \\right)_+\n$$\n这就是估计跳跃幅度的闭式表达式。\n\n接下来，我们求期望值 $\\mathbb{E}[J_{\\text{hat}}]$ 的一阶近似。我们已知模型为 $y_i = \\theta_i + \\varepsilon_i$，其中 $\\varepsilon_i \\sim \\text{i.i.d.} \\mathcal{N}(0,\\sigma^2)$。样本均值是随机变量：\n$$\n\\bar{y}_1 = \\frac{1}{m_1}\\sum_{i=1}^{m_1} (\\theta_1 + \\varepsilon_i) = \\theta_1 + \\bar{\\varepsilon}_1 \\sim \\mathcal{N}(\\theta_1, \\sigma^2/m_1)\n$$\n$$\n\\bar{y}_2 = \\frac{1}{m_2}\\sum_{i=m_1+1}^{m_1+m_2} (\\theta_2 + \\varepsilon_i) = \\theta_2 + \\bar{\\varepsilon}_2 \\sim \\mathcal{N}(\\theta_2, \\sigma^2/m_2)\n$$\n差值 $D = \\bar{y}_2 - \\bar{y}_1$ 也是一个正态随机变量，因为它是独立正态变量的线性组合。其均值和方差为：\n$$\n\\mathbb{E}[D] = \\mathbb{E}[\\bar{y}_2] - \\mathbb{E}[\\bar{y}_1] = \\theta_2 - \\theta_1 = \\Delta\n$$\n$$\n\\text{Var}(D) = \\text{Var}(\\bar{y}_2) + \\text{Var}(\\bar{y}_1) = \\frac{\\sigma^2}{m_2} + \\frac{\\sigma^2}{m_1} = \\sigma^2\\left(\\frac{1}{m_1} + \\frac{1}{m_2}\\right)\n$$\n问题陈述我们处于高信噪比情况下，其中 $\\Delta  0$ 并且 $J_{\\text{hat}}$ 被收缩到零的概率可以忽略不计。当 $|D| \\le C$ 时 $J_{\\text{hat}}=0$。在 $\\mathbb{E}[D] = \\Delta  0$ 的条件下，$P(|D| \\le C) \\approx 0$ 意味着 $D$ 的分布集中在区域 $D  C$。\n\n在这种情况下，我们有 $D  C$ 的概率几乎为 1。因此，$J_{\\text{hat}}$ 的表达式简化为第一种情况：\n$$\nJ_{\\text{hat}} \\approx D - C = (\\bar{y}_2 - \\bar{y}_1) - \\lambda\\left(\\frac{1}{m_1} + \\frac{1}{m_2}\\right)\n$$\n这种近似忽略了阈值函数在原点附近的非线性行为，这在高信噪比的假设下是合理的。这是一阶近似。\n\n我们现在对这个近似表达式求期望。由于期望是线性算子：\n$$\n\\mathbb{E}[J_{\\text{hat}}] \\approx \\mathbb{E}\\left[(\\bar{y}_2 - \\bar{y}_1) - \\lambda\\left(\\frac{1}{m_1} + \\frac{1}{m_2}\\right)\\right]\n$$\n$$\n\\mathbb{E}[J_{\\text{hat}}] \\approx \\mathbb{E}[\\bar{y}_2 - \\bar{y}_1] - \\lambda\\left(\\frac{1}{m_1} + \\frac{1}{m_2}\\right)\n$$\n使用 $\\mathbb{E}[\\bar{y}_2 - \\bar{y}_1] = \\Delta$ 的结果，我们得到期望的估计跳跃幅度的最终表达式：\n$$\n\\mathbb{E}[J_{\\text{hat}}] \\approx \\Delta - \\lambda\\left(\\frac{1}{m_1} + \\frac{1}{m_2}\\right)\n$$\n这表明，在这个简化模型下，对跳跃的融合 lasso 估计量是有偏的。偏差为负，意味着它将估计值向零收缩，其大小等于软阈值算子的阈值。", "answer": "$$\\boxed{\\Delta - \\lambda \\left(\\frac{1}{m_1} + \\frac{1}{m_2}\\right)}$$", "id": "3122180"}]}