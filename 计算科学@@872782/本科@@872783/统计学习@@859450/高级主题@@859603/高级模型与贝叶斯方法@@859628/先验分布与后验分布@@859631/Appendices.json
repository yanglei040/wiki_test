{"hands_on_practices": [{"introduction": "本次练习将通过一个具体的场景，巩固我们对贝叶斯推断的理解。我们将探讨如何利用共轭先验这一强大概念——具体来说，是泊松过程中的伽马分布——来更新我们对制造业缺陷率的信念。这个练习展示了融合先验知识与观测数据，从而得到更可靠的后验信念的核心机制[@problem_id:1946607]。", "problem": "一个工业过程生产大片的特种聚合物。一位质量控制专家将随机选择的 1 厘米乘 1 厘米方形聚合物样本中发现的微观缺陷数量建模为一个随机变量，该变量服从泊松分布，其未知平均率为每平方厘米 $\\lambda$ 个缺陷。\n\n基于对类似制造过程的丰富经验，该专家对参数 $\\lambda$ 的先验信念由一个 Gamma 分布建模，其形状参数 $\\alpha = 3$，率参数 $\\beta = 2$。Gamma($\\alpha, \\beta$) 分布的概率密度函数为 $f(x; \\alpha, \\beta) = \\frac{\\beta^\\alpha}{\\Gamma(\\alpha)} x^{\\alpha-1} \\exp(-\\beta x)$，其中 $x > 0$。\n\n然后，该专家取了五个独立的 1 厘米乘 1 厘米方形样本，并观察到以下缺陷数量：4, 2, 0, 3, 1。\n\n给定这些新数据，率参数 $\\lambda$ 的更新期望值（均值）是多少？请用精确分数表示你的答案。", "solution": "设观察到的计数为 $y_{1},\\dots,y_{n}$，其中 $n=5$ 且 $y_{1},\\dots,y_{5}\\in \\{4,2,0,3,1\\}$。抽样模型假设 $y_{i}\\mid \\lambda \\sim \\text{Poisson}(\\lambda)$ 独立同分布，因此似然函数为\n$$\nL(\\lambda; y_{1:n})=\\prod_{i=1}^{n}\\frac{\\exp(-\\lambda)\\lambda^{y_{i}}}{y_{i}!} \\propto \\lambda^{\\sum_{i=1}^{n} y_{i}} \\exp(-n\\lambda).\n$$\n先验分布为 $\\lambda \\sim \\text{Gamma}(\\alpha,\\beta)$，其密度函数为\n$$\np(\\lambda)=\\frac{\\beta^{\\alpha}}{\\Gamma(\\alpha)}\\lambda^{\\alpha-1}\\exp(-\\beta \\lambda), \\quad \\lambda>0.\n$$\n根据共轭性，后验分布正比于先验分布与似然函数的乘积：\n$$\np(\\lambda\\mid y_{1:n}) \\propto \\lambda^{\\alpha-1}\\exp(-\\beta \\lambda)\\cdot \\lambda^{\\sum_{i=1}^{n} y_{i}}\\exp(-n\\lambda)\n= \\lambda^{\\alpha+\\sum_{i=1}^{n} y_{i}-1}\\exp\\!\\big(-( \\beta+n)\\lambda\\big),\n$$\n这是 $\\text{Gamma}(\\alpha+\\sum_{i=1}^{n} y_{i},\\, \\beta+n)$ 分布的核（形状-率参数化）。\n\n对于给定的值 $\\alpha=3$, $\\beta=2$, $n=5$ 和 $\\sum_{i=1}^{5} y_{i}=4+2+0+3+1=10$，后验分布为\n$$\n\\lambda \\mid y_{1:5} \\sim \\text{Gamma}(3+10,\\, 2+5)=\\text{Gamma}(13,7).\n$$\n一个 $\\text{Gamma}(\\alpha',\\beta')$ 分布（率参数化）的均值是 $\\alpha'/\\beta'$，因此更新后的期望值为\n$$\n\\mathbb{E}[\\lambda \\mid y_{1:5}] = \\frac{13}{7}.\n$$", "answer": "$$\\boxed{\\frac{13}{7}}$$", "id": "1946607"}, {"introduction": "了解了贝叶斯更新的基本过程后，一个自然而然的问题是：我们接收数据的顺序会影响最终结果吗？本练习将通过比较批量更新与序贯更新来探讨这个根本性问题。通过证明两种方法得到完全相同的后验分布，我们将揭示贝叶斯框架的逻辑一致性与稳健性[@problem_id:1946578]。", "problem": "一位质量控制工程师正在评估一种旨在生产高可靠性电子元件的新制造工艺。该工艺的成功率，定义为一个元件为无缺陷的概率 $p$，是未知的。工程师对这个概率 $p$ 的初始信念被建模为一个服从贝塔分布的随机变量，其已知参数为 $\\alpha > 0$ 和 $\\beta > 0$。该信念的概率密度函数与 $p^{\\alpha-1}(1-p)^{\\beta-1}$ 成正比。\n\n工程师观察了一批新生产的 $n$ 个元件的测试批次。在这一批次中，总共有 $k$ 个元件被发现是无缺陷的（成功），因此，有 $n-k$ 个元件是有缺陷的（失败）。工程师希望根据这些观察结果更新他们对 $p$ 的信念。考虑了两种不同的更新方法。\n\n方法1（批量更新）：工程师等到所有 $n$ 个元件都测试完毕。然后他们使用 $k$ 次成功和 $n-k$ 次失败的总计数一次性更新其初始信念（先验）。更新后的信念（后验）是另一个具有新参数的贝塔分布，我们将其表示为 $(\\alpha_{batch}, \\beta_{batch})$。\n\n方法2（序贯更新）：工程师在每个元件测试后逐一更新其信念。从相同的初始信念 $(\\alpha, \\beta)$ 开始，他们在第一次观察后进行更新。得到的后验分布随即作为第二次观察的先验。这个过程对序列中的所有 $n$ 个观察重复进行。设经过所有 $n$ 次更新后的最终贝塔分布的参数表示为 $(\\alpha_{seq}, \\beta_{seq})$。\n\n确定由批量更新产生的参数 $\\alpha_{batch}$ 的表达式，以及由序贯更新产生的参数 $\\beta_{seq}$ 的表达式。将您的答案表示为一对表达式 $(\\alpha_{batch}, \\beta_{seq})$。", "solution": "我们将未知成功概率 $p$ 建模为具有参数 $(\\alpha,\\beta)$ 的贝塔先验，其密度与 $p^{\\alpha-1}(1-p)^{\\beta-1}$ 成正比。对于有 $k$ 次成功和 $n-k$ 次失败的 $n$ 次独立伯努利试验，其似然与 $p^{k}(1-p)^{n-k}$ 成正比。\n\n批量更新：根据贝叶斯法则和贝塔-二项共轭性，后验密度与先验和似然的乘积成正比，\n$$\np^{\\alpha-1}(1-p)^{\\beta-1}\\cdot p^{k}(1-p)^{n-k}\n= p^{\\alpha-1+k}(1-p)^{\\beta-1+(n-k)}.\n$$\n这是具有参数 $(\\alpha+k,\\beta+n-k)$ 的贝塔分布的核。因此，批量更新后与 $p$ 的指数相对应的参数是\n$$\n\\alpha_{batch}=\\alpha+k.\n$$\n\n序贯更新：考虑单个伯努利观察 $x\\in\\{0,1\\}$，其先验为 $\\operatorname{Beta}(a,b)$。似然与 $p^{x}(1-p)^{1-x}$ 成正比。那么后验与下式成正比\n$$\np^{a-1}(1-p)^{b-1}\\cdot p^{x}(1-p)^{1-x}\n= p^{(a-1)+x}(1-p)^{(b-1)+(1-x)},\n$$\n这是 $\\operatorname{Beta}(a+x,\\,b+1-x)$ 的核。因此，每次成功（$x=1$）使第一个参数增加1，每次失败（$x=0$）使第二个参数增加1。经过 $k$ 次成功和 $n-k$ 次失败后，从 $(\\alpha,\\beta)$ 开始，最终参数为 $(\\alpha+k,\\beta+n-k)$。因此，序贯更新后的第二个参数是\n$$\n\\beta_{seq}=\\beta+(n-k).\n$$\n\n因此，所求的序对是 $(\\alpha_{batch},\\beta_{seq})=(\\alpha+k,\\beta+n-k)$。", "answer": "$$\\boxed{\\begin{pmatrix}\\alpha+k & \\beta+n-k\\end{pmatrix}}$$", "id": "1946578"}, {"introduction": "许多现实世界的问题涉及两个以上的可能结果。本次练习将共轭先验的概念从二元事件（如成功/失败）扩展到具有多个类别的多项式场景。通过一个交通信号灯状态的例子，我们将看到狄利克雷分布如何作为多项式似然的共轭先验，为我们提供一个分析分类数据的灵活工具[@problem_id:1946611]。", "problem": "一位城市规划师正在分析一个城市交叉路口新安装的“自适应”交通信号灯的行为。该信号灯在三种状态之间循环：红灯 (R)、绿灯 (G) 和黄灯 (Y)。令 $p_R$、$p_G$ 和 $p_Y$ 分别表示信号灯长期处于红灯、绿灯和黄灯状态的时间比例。注意 $p_R + p_G + p_Y = 1$。\n\n在收集任何数据之前，规划师假设对这些比例处于完全无知的状态。这种初始信念通过一个关于 $(p_R, p_G, p_Y)$ 可能取值的先验概率分布来建模。所选择的先验分布是一个参数为 $(\\alpha_R, \\alpha_G, \\alpha_Y) = (1, 1, 1)$ 的狄利克雷分布（Dirichlet distribution）。\n\n为了更新这一信念，规划师在一天中随机选择了120个时刻，并记录了交通信号灯的状态。收集到的数据包括58次观测到红灯状态，52次绿灯状态，以及10次黄灯状态。\n\n这是一个已知的性质：如果一个多项过程的参数的先验分布是狄利克雷分布，那么在观测到数据后的后验分布也同样是狄利克雷分布。根据规划师的先验信念和收集到的数据，确定针对 $(p_R, p_G, p_Y)$ 的后验狄利克雷分布的参数 $(\\alpha'_R, \\alpha'_G, \\alpha'_Y)$。", "solution": "设 $(p_{R},p_{G},p_{Y})$ 的先验分布为 $\\operatorname{Dirichlet}(\\alpha_{R},\\alpha_{G},\\alpha_{Y})$，其密度正比于 $\\prod_{i \\in \\{R,G,Y\\}} p_{i}^{\\alpha_{i}-1}$。给定计数为 $(n_{R},n_{G},n_{Y})$ 的多项数据，似然函数正比于 $\\prod_{i \\in \\{R,G,Y\\}} p_{i}^{n_{i}}$。根据贝叶斯法则（Bayes’ rule）以及狄利克雷先验与多项似然的共轭性，后验分布正比于\n$$\n\\prod_{i \\in \\{R,G,Y\\}} p_{i}^{\\alpha_{i}-1} \\times \\prod_{i \\in \\{R,G,Y\\}} p_{i}^{n_{i}} \\;=\\; \\prod_{i \\in \\{R,G,Y\\}} p_{i}^{(\\alpha_{i}+n_{i})-1},\n$$\n这是一个 $\\operatorname{Dirichlet}(\\alpha_{R}+n_{R},\\alpha_{G}+n_{G},\\alpha_{Y}+n_{Y})$ 分布。\n\n在给定的先验参数 $(\\alpha_{R},\\alpha_{G},\\alpha_{Y})=(1,1,1)$ 和观测计数 $(n_{R},n_{G},n_{Y})=(58,52,10)$ 的情况下，后验参数为\n$$\n(\\alpha'_{R},\\alpha'_{G},\\alpha'_{Y})=(1+58,\\,1+52,\\,1+10)=(59,53,11).\n$$", "answer": "$$\\boxed{\\begin{pmatrix}59 & 53 & 11\\end{pmatrix}}$$", "id": "1946611"}]}