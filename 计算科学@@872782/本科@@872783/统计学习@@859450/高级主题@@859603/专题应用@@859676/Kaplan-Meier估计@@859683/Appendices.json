{"hands_on_practices": [{"introduction": "在进行任何生存分析之前，首要且关键的一步是整理和汇总原始数据。这个练习将指导你如何处理一个典型的临床试验数据集，系统地在每个事件发生的时间点上，统计出风险集内的个体数量 ($Y_j$)、事件数量 ($d_j$) 和删失数量 ($c_j$)。通过这个基础练习，你将掌握构建计算 Kaplan-Meier 生存曲线所需的基础数据表格的技能。", "problem": "一项临床试验旨在评估一种名为“Neurostabil”的新药在预防神经系统症状复发方面的疗效。十五名受试者参与了这项研究，研究计划持续12个月。对于每位受试者，数据以 `(时间, 状态)` 对的形式记录，其中 `时间` 是到症状复发（事件）或受试者被删失为止的月数，`状态` 是一个指示变量（1表示事件，0表示删失）。如果受试者退出研究，或者研究在他们经历事件之前结束，则该受试者被视为删失。\n\n15名受试者的数据如下：\n(3, 1), (5, 1), (12, 0), (7, 1), (4, 0), (9, 1), (7, 1), (10, 0), (11, 1), (12, 0), (3, 1), (7, 1), (8, 0), (5, 0), (9, 1)\n\n为了准备进行Kaplan-Meier生存分析，您需要对这些数据进行总结。设 $t_1  t_2  \\dots  t_k$ 是唯一的、有序的事件时间序列。对于每个不同的事件时间 $t_j$（其中 $j=1, \\dots, k$），我们定义以下量：\n- $Y_j$：在时间 $t_j$ 之前处于风险中的受试者数量。如果一个受试者在时间 $t_j$ 之前尚未发生事件或被删失，则认为其处于风险中。\n- $d_j$：在时间 $t_j$ 发生事件的受试者数量。\n- $c_j$：在时间区间 $[t_{j-1}, t_j)$ 内被删失的受试者数量，其中 $t_0 = 0$。\n\n确定所有不同事件时间的三元组 $(Y_j, d_j, c_j)$ 序列。将您的答案表示为一个矩阵，其中第 $j$ 行包含第 $j$ 个事件时间的三元组。", "solution": "我们总共有15名受试者。为了构建所需的三元组序列，我们首先需要识别出数据中所有唯一的事件时间，并按时间顺序排列它们。\n\n1.  **整理数据**：\n    *   事件时间（状态=1）：3, 3, 5, 7, 7, 7, 9, 9, 11\n    *   删失时间（状态=0）：4, 5, 8, 10, 12, 12\n    *   唯一的有序事件时间为 $t_1=3, t_2=5, t_3=7, t_4=9, t_5=11$。\n\n2.  **逐步计算**：\n    *   **初始状态**：在 $t=0$ 时，所有15名受试者都处于风险中。\n    *   **事件时间 $t_1=3$**：\n        *   风险集 $Y_1$：在时间3之前，所有15名受试者都处于风险中。因此，$Y_1=15$。\n        *   事件数 $d_1$：在时间3，有2名受试者发生事件。因此，$d_1=2$。\n        *   删失数 $c_1$：在区间 $[t_0, t_1) = [0, 3)$ 内，没有受试者被删失。因此，$c_1=0$。\n        *   三元组为 $(15, 2, 0)$。\n    *   **事件时间 $t_2=5$**：\n        *   风险集 $Y_2$：在时间3之后，有 $15-2=13$ 人仍在研究中。在区间 $[3, 5)$ 内，一名受试者在时间4被删失。因此，在时间5之前，处于风险中的人数为 $13-1=12$。所以，$Y_2=12$。\n        *   事件数 $d_2$：在时间5，有1名受试者发生事件。因此，$d_2=1$。\n        *   删失数 $c_2$：在区间 $[t_1, t_2) = [3, 5)$ 内，一名受试者在时间4被删失。因此，$c_2=1$。\n        *   三元组为 $(12, 1, 1)$。\n    *   **事件时间 $t_3=7$**：\n        *   风险集 $Y_3$：在时间5之后，有 $12-1=11$ 人仍在研究中。在区间 $[5, 7)$ 内，一名受试者在时间5被删失。因此，在时间7之前，处于风险中的人数为 $11-1=10$。所以，$Y_3=10$。\n        *   事件数 $d_3$：在时间7，有3名受试者发生事件。因此，$d_3=3$。\n        *   删失数 $c_3$：在区间 $[t_2, t_3) = [5, 7)$ 内，一名受试者在时间5被删失。因此，$c_3=1$。\n        *   三元组为 $(10, 3, 1)$。\n    *   **事件时间 $t_4=9$**：\n        *   风险集 $Y_4$：在时间7之后，有 $10-3=7$ 人仍在研究中。在区间 $[7, 9)$ 内，一名受试者在时间8被删失。因此，在时间9之前，处于风险中的人数为 $7-1=6$。所以，$Y_4=6$。\n        *   事件数 $d_4$：在时间9，有2名受试者发生事件。因此，$d_4=2$。\n        *   删失数 $c_4$：在区间 $[t_3, t_4) = [7, 9)$ 内，一名受试者在时间8被删失。因此，$c_4=1$。\n        *   三元组为 $(6, 2, 1)$。\n    *   **事件时间 $t_5=11$**：\n        *   风险集 $Y_5$：在时间9之后，有 $6-2=4$ 人仍在研究中。在区间 $[9, 11)$ 内，一名受试者在时间10被删失。因此，在时间11之前，处于风险中的人数为 $4-1=3$。所以，$Y_5=3$。\n        *   事件数 $d_5$：在时间11，有1名受试者发生事件。因此，$d_5=1$。\n        *   删失数 $c_5$：在区间 $[t_4, t_5) = [9, 11)$ 内，一名受试者在时间10被删失。因此，$c_5=1$。\n        *   三元组为 $(3, 1, 1)$。\n\n3.  **汇总结果**：\n将这些三元组按事件时间顺序排列成一个矩阵，得到最终答案。", "answer": "$$\\boxed{\\begin{pmatrix}\n15  2  0 \\\\\n12  1  1 \\\\\n10  3  1 \\\\\n6  2  1 \\\\\n3  1  1\n\\end{pmatrix}}$$", "id": "1961488"}, {"introduction": "掌握了如何准备数据之后，下一步就是应用 Kaplan-Meier 乘积极限公式来实际计算生存概率。本练习提供了一个新的场景，要求你在第二个事件发生时计算生存函数 $\\hat{S}(t)$ 的估计值。这个过程将帮助你深入理解 Kaplan-Meier 估计量是如何通过累积每个事件点的条件生存概率来逐步构建整个生存曲线的。", "problem": "一个材料科学研究小组正在测试一种新型可生物降解电子元件的耐久性。共有8个元件接受了加速老化测试。“事件”被定义为元件失效。由于测试设备的限制，一些测试在元件失效前被停止；这些被认为是“删失”观测值。该研究记录了以下数据，其中每对数据代表（时间（小时），状态），状态‘1’表示失效，状态‘0’表示在该时间观测被删失：\n\n(15, 1), (25, 1), (40, 1), (30, 0), (50, 1), (35, 0), (55, 0), (20, 1)\n\n计算在该研究中观察到的第二个失效事件发生的确切时间的Kaplan-Meier生存函数估计值 $\\hat{S}(t)$。将您的答案表示为保留三位有效数字的小数。", "solution": "问题要求计算在特定时间的Kaplan-Meier生存函数估计值 $\\hat{S}(t)$。Kaplan-Meier估计量是一种非参数统计方法，用于根据可能包含删失数据的寿命数据来估计生存函数。该估计量的公式是乘积极限公式：\n$$ \\hat{S}(t) = \\prod_{i: t_i \\le t} \\left( 1 - \\frac{d_i}{n_i} \\right) $$\n其中，$t_i$ 是事件（失效）发生的离散时间点，$d_i$ 是在时间 $t_i$ 发生的事件数，而 $n_i$ 是在时间 $t_i$ 之前处于风险中的个体数（即仍在观察中且未失效的元件数）。\n\n首先，我们必须按时间顺序整理数据。数据集包含8个元件及其事件/删失时间：(15, 1), (25, 1), (40, 1), (30, 0), (50, 1), (35, 0), (55, 0), (20, 1)。按时间排序后得到：\n\n1.  时间 15：失效（事件）\n2.  时间 20：失效（事件）\n3.  时间 25：失效（事件）\n4.  时间 30：删失\n5.  时间 35：删失\n6.  时间 40：失效（事件）\n7.  时间 50：失效（事件）\n8.  时间 55：删失\n\n问题要求计算在*第二次观察到失效事件*发生时的估计值 $\\hat{S}(t)$。从排序后的列表中，我们看到第一个失效事件发生在 $t=15$ 小时，第二个失效事件发生在 $t=20$ 小时。因此，我们需要计算 $\\hat{S}(20)$。\n\n计算过程涉及对截至并包括 $t=20$ 的所有离散事件时间点进行乘积。相关的事件时间是 $t_1 = 15$ 和 $t_2 = 20$。\n\n在研究开始时，即 $t=0$ 时，所有8个元件都处于风险中。\n\n**步骤1：计算在 $t_1 = 15$ 时第一次事件的生存因子。**\n- 在 $t=15$ 之前，处于风险中的元件数量为 $n_1 = 8$。\n- 在 $t=15$ 时，失效数量为 $d_1 = 1$。\n- 在此事件之后，立即计算生存概率估计值。此步骤的因子为 $\\left(1 - \\frac{d_1}{n_1}\\right) = \\left(1 - \\frac{1}{8}\\right) = \\frac{7}{8}$。\n- 对于区间 $[15, 20)$ 内的任何时间 $t$，Kaplan-Meier估计值为 $\\hat{S}(t) = \\frac{7}{8}$。\n\n**步骤2：计算在 $t_2 = 20$ 时第二次事件的生存因子。**\n- 为了找到在 $t=20$ 之前处于风险中的元件数量，我们从上一个事件之前的风险数量（$n_1=8$）开始，减去在该时间点与当前时间点之间发生事件或被删失的所有个体。在 $t=15$ 时有一个元件失效。在 $t=15$ 和 $t=20$ 之间没有元件被删失。\n- 因此，在 $t=20$ 之前处于风险中的元件数量为 $n_2 = 8 - 1 = 7$。\n- 在 $t=20$ 时，失效数量为 $d_2 = 1$。\n- 此步骤的因子为 $\\left(1 - \\frac{d_2}{n_2}\\right) = \\left(1 - \\frac{1}{7}\\right) = \\frac{6}{7}$。\n\n**步骤3：合并各因子以求得 $\\hat{S}(20)$。**\n在 $t=20$ 时的Kaplan-Meier估计值是发生在该时间或之前的所有事件的生存因子的乘积。\n$$ \\hat{S}(20) = \\prod_{i: t_i \\le 20} \\left( 1 - \\frac{d_i}{n_i} \\right) = \\left(1 - \\frac{d_1}{n_1}\\right) \\times \\left(1 - \\frac{d_2}{n_2}\\right) $$\n$$ \\hat{S}(20) = \\left(\\frac{7}{8}\\right) \\times \\left(\\frac{6}{7}\\right) $$\n‘7’项相互抵消：\n$$ \\hat{S}(20) = \\frac{6}{8} = \\frac{3}{4} $$\n换算成小数，结果是 $0.75$。\n\n问题要求答案保留三位有效数字。为了将 $0.75$ 表示为三位有效数字，我们在末尾加一个零。\n\n因此，Kaplan-Meier估计值为 $0.750$。", "answer": "$$\\boxed{0.750}$$", "id": "1961438"}, {"introduction": "计算生存曲线本身只是第一步，统计学的真正威力在于利用这些估计进行推断和比较。本练习将带你从描述性分析迈向统计推断，介绍如何使用非参数自助法（bootstrap）来量化不确定性。你将学习如何为一个重要的参数——两组中位生存时间的差异——构建置信区间，从而对不同组别间的差异做出有统计学依据的判断。", "problem": "一家科技公司正在对两款新型号智能手机“Aether”和“Chronos”的电池进行耐用性测试。从每个型号中抽取少量手机样本进行监测，直到其电池电量完全耗尽。然而，由于操作上的原因，一些测试在电池耗尽前被终止；这些观测值被视为右删失数据。该公司希望确定两种型号手机的电池寿命是否存在显著差异。\n\n收集到的数据由数对 $(t, \\delta)$ 组成，其中 $t$ 是到测试结束时的时间（以小时为单位），$\\delta$ 是一个状态指示符，$\\delta=1$ 表示电池耗尽（事件），$\\delta=0$ 表示测试在电池耗尽前被终止（删失）。\n\n两种型号的数据如下：\n- **Aether (A组)**: (10, 1), (12, 1), (15, 0), (18, 1), (20, 0), (22, 1)\n- **Chronos (C组)**: (14, 1), (19, 1), (24, 0), (25, 1), (28, 0), (30, 1)\n\n为了量化两种型号典型电池寿命差异的不确定性，我们采用了一种非参数自助法（bootstrap）程序。感兴趣的参数是中位生存时间的差异，$\\Delta = T_{C, 0.5} - T_{A, 0.5}$，其中 $T_{M, 0.5}$ 是型号 $M$ 的中位生存时间。该程序包括为每个组生成 $B=5000$ 个自助样本，为每个自助样本计算 Kaplan-Meier 生存曲线和相应的中位生存时间，然后计算两者之差。这得到了 5000 个差异的自助估计值 $\\Delta^*$。\n\n将这 5000 个自助法差异按升序排序后，发现第 125 个值为 7.5 小时，第 4875 个值为 11.5 小时。\n\n使用百分位数自助法，确定中位电池寿命差异 $\\Delta$ 的 95% 置信区间。请提供该置信区间的下界和上界，单位为小时。", "solution": "我们想要求解中位生存时间差异 $\\Delta = T_{C,0.5} - T_{A,0.5}$ 的双侧百分位数自助法置信区间。设 $B=5000$ 为自助法重复次数，自助估计值为 $\\{\\Delta^{*}_{b}\\}_{b=1}^{B}$。对它们进行排序以获得顺序统计量 $\\Delta^{*(1)} \\leq \\Delta^{*(2)} \\leq \\dots \\leq \\Delta^{*(B)}$。\n\n对于置信水平 $1-\\alpha=0.95$（$\\alpha=0.05$），百分位数自助法区间由概率为 $\\alpha/2$ 和 $1-\\alpha/2$ 的经验分位数定义，即\n$$\n\\left[\\hat{Q}_{\\Delta^{*}}\\!\\left(\\frac{\\alpha}{2}\\right),\\ \\hat{Q}_{\\Delta^{*}}\\!\\left(1-\\frac{\\alpha}{2}\\right)\\right].\n$$\n当 $B=5000$ 时，这些分位数对应的顺序统计量索引为\n$$\nk_{L} = \\alpha/2 \\times B = 0.025 \\times 5000 = 125,\\quad\nk_{U} = (1-\\alpha/2) \\times B = 0.975 \\times 5000 = 4875.\n$$\n题目说明 $\\Delta^{*(125)}=7.5$ 小时，$\\Delta^{*(4875)}=11.5$ 小时。因此，$\\Delta$ 的 95% 百分位数自助法置信区间是\n$$\n[7.5,\\ 11.5]\\ \\text{hours}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}7.5  11.5\\end{pmatrix}}$$", "id": "1961431"}]}