{"hands_on_practices": [{"introduction": "我们从机器学习的基石——感知器模型开始我们的实践，它实现了线性的决策边界。理解其容量是至关重要的。这个练习 [@problem_id:3192435] 要求你计算标准、无约束感知器以及一个仅有非负权重的“生物学上合理”版本的VC维。通过比较两者，你将具体理解模型约束如何直接影响其表达能力。", "problem": "考虑由线性阈值函数定义的 $\\mathbb{R}^{d}$ 上的感知机假设类。感知机根据 $h_{\\mathbf{w},b}(\\mathbf{x}) = \\mathrm{sign}(\\mathbf{w}^{\\top}\\mathbf{x} + b)$ 分配标签，其中 $\\mathbf{w} \\in \\mathbb{R}^{d}$ 是权重向量，$b \\in \\mathbb{R}$ 是偏置。在只有兴奋性突触的生物学合理模型中，权重被约束为非负，因此 $\\mathbf{w} \\in \\mathbb{R}_{+}^{d} := \\{\\mathbf{w} \\in \\mathbb{R}^{d} : w_{i} \\geq 0 \\text{ for all } i\\}$。令 $\\mathcal{H}_{+} := \\{h_{\\mathbf{w},b} : \\mathbf{w} \\in \\mathbb{R}_{+}^{d},\\ b \\in \\mathbb{R}\\}$ 表示这个纯兴奋类，并令 $\\mathcal{H} := \\{h_{\\mathbf{w},b} : \\mathbf{w} \\in \\mathbb{R}^{d},\\ b \\in \\mathbb{R}\\}$ 表示无限制的半空间类。\n\n从 Vapnik–Chervonenkis (VC) 维度和线性可分性的核心定义出发，计算 $\\mathbb{R}^{d}$ 上纯兴奋感知机的 VC 维度 $d_{\\mathrm{VC}}(\\mathcal{H}_{+})$，并将其与 $\\mathbb{R}^{d}$ 上无限制半空间的 VC 维度 $d_{\\mathrm{VC}}(\\mathcal{H})$ 进行比较。仅使用关于仿射无关和由非负权重引起的单调性的标准事实，从基本原理证明你的答案。将你的最终答案表示为一个双元行向量，给出用 $d$ 表示的 $d_{\\mathrm{VC}}(\\mathcal{H}_{+})$ 和 $d_{\\mathrm{VC}}(\\mathcal{H})$。不需要四舍五入，也不涉及物理单位。", "solution": "该问题要求计算 $\\mathbb{R}^d$ 上两种感知机假设类的 Vapnik-Chervonenkis (VC) 维度。第一个是无限制类 $\\mathcal{H}$，第二个是纯兴奋类 $\\mathcal{H}_+$，其中权重向量 $\\mathbf{w}$ 被约束为具有非负分量。\n\n**步骤 1：预备知识与 VC 维度的定义**\n\n二元分类器假设类 $\\mathcal{C}$ 的 Vapnik-Chervonenkis (VC) 维度是可以被 $\\mathcal{C}$ 打散的最大有限点集的大小。如果对于 $S$ 中点的每一种可能的标记（由向量 $\\boldsymbol{\\ell} = (\\ell_1, \\dots, \\ell_N) \\in \\{-1, +1\\}^N$ 表示），都存在一个分类器 $h \\in \\mathcal{C}$ 使得对所有 $i = 1, \\dots, N$ 都有 $h(\\mathbf{x}_i) = \\ell_i$，那么就称点集 $S = \\{\\mathbf{x}_1, \\dots, \\mathbf{x}_N\\}$ 被 $\\mathcal{C}$ 打散。这意味着 $\\mathcal{C}$ 可以实现集合 $S$ 的所有 $2^N$ 种可能的对分。\n\n分类器的形式为 $h_{\\mathbf{w},b}(\\mathbf{x}) = \\mathrm{sign}(\\mathbf{w}^{\\top}\\mathbf{x} + b)$。如果存在由假设类指定的参数 $(\\mathbf{w}, b)$，使得对所有 $i$ 都有 $\\ell_i (\\mathbf{w}^{\\top}\\mathbf{x}_i + b) > 0$，则称标记 $\\{\\ell_i\\}$ 被实现。对于符号函数，我们定义如果 $z \\geq 0$ 则 $\\mathrm{sign}(z)=+1$，如果 $z  0$ 则 $\\mathrm{sign}(z)=-1$。使用严格不等式是为了避免点落在边界上的问题。\n\n**步骤 2：无限制半空间的 VC 维度 $d_{\\mathrm{VC}}(\\mathcal{H})$**\n\n假设类 $\\mathcal{H} = \\{h_{\\mathbf{w},b} : \\mathbf{w} \\in \\mathbb{R}^{d},\\ b \\in \\mathbb{R}\\}$ 对应于 $\\mathbb{R}^d$ 中所有分离超平面的集合。在统计学习理论中，一个标准的结果是该类的 VC 维度为 $d+1$。我们通过证明一个下界和一个上界来展示这一点。\n\n*   **下界：$d_{\\mathrm{VC}}(\\mathcal{H}) \\geq d+1$**\n\n    为了证明 VC 维度至少为 $d+1$，我们必须找到一个能被 $\\mathcal{H}$ 打散的 $d+1$ 个点的集合。考虑 $\\mathbb{R}^d$ 中由原点和标准基向量组成的 $d+1$ 个点的集合：$S = \\{\\mathbf{0}, \\mathbf{e}_1, \\dots, \\mathbf{e}_d\\}$。\n\n    对于任意标记 $(\\ell_0, \\ell_1, \\dots, \\ell_d) \\in \\{-1, +1\\}^{d+1}$，我们需要找到 $\\mathbf{w} \\in \\mathbb{R}^d$ 和 $b \\in \\mathbb{R}$ 使得：\n    1.  $\\mathrm{sign}(\\mathbf{w}^{\\top}\\mathbf{0} + b) = \\mathrm{sign}(b) = \\ell_0$\n    2.  对于 $i=1, \\dots, d$，有 $\\mathrm{sign}(\\mathbf{w}^{\\top}\\mathbf{e}_i + b) = \\mathrm{sign}(w_i + b) = \\ell_i$。\n\n    我们可以如下构造 $(\\mathbf{w}, b)$。设 $b = \\ell_0$。\n    然后，对于 $i=1, \\dots, d$，我们需要 $\\mathrm{sign}(w_i + \\ell_0) = \\ell_i$。\n    - 如果 $\\ell_i = \\ell_0$，我们需要 $w_i + \\ell_0$ 与 $\\ell_0$ 同号。我们可以选择 $w_i = 0$。那么 $w_i + \\ell_0 = \\ell_0$，其符号为 $\\ell_0$。\n    - 如果 $\\ell_i = -\\ell_0$，我们需要 $w_i + \\ell_0$ 与 $\\ell_0$ 异号。我们可以选择 $w_i = -2\\ell_0$。那么 $w_i + \\ell_0 = -2\\ell_0 + \\ell_0 = -\\ell_0$，其符号为 $-\\ell_0 = \\ell_i$。\n\n    因为我们可以为 $2^{d+1}$ 种可能的标记中的任意一种找到一个 $(\\mathbf{w}, b)$，所以集合 $S$ 被打散。这证明了 $d_{\\mathrm{VC}}(\\mathcal{H}) \\geq d+1$。\n\n*   **上界：$d_{\\mathrm{VC}}(\\mathcal{H}) \\leq d+1$**\n\n    为了证明 VC 维度最多为 $d+1$，我们必须证明任何 $d+2$ 个点的集合都不能被打散。这是 Radon 定理的直接推论。\n    令 $S = \\{\\mathbf{x}_1, \\dots, \\mathbf{x}_{d+2}\\}$ 为 $\\mathbb{R}^d$ 中任意 $d+2$ 个点的集合。根据 Radon 定理，$S$ 可以被划分为两个不相交的子集 $S_1$ 和 $S_2$，使得它们的凸包相交：$\\mathrm{conv}(S_1) \\cap \\mathrm{conv}(S_2) \\neq \\emptyset$。\n\n    考虑将 $S_1$ 中所有点标记为 $+1$，并将 $S_2$ 中所有点标记为 $-1$。要让一个超平面 $h_{\\mathbf{w},b}$ 实现这种标记，我们需要对所有 $\\mathbf{x} \\in S_1$ 都有 $\\mathbf{w}^\\top\\mathbf{x} + b > 0$，对所有 $\\mathbf{x} \\in S_2$ 都有 $\\mathbf{w}^\\top\\mathbf{x} + b  0$。根据线性性质，这意味着该超平面分开了 $S_1$ 和 $S_2$ 的凸包。然而，由于它们的凸包相交，它们不能被一个超平面分开。因此，这种特定的标记无法实现。\n\n    因为对于任何 $d+2$ 个点的集合，都存在至少一种无法实现的标记，所以任何 $d+2$ 个点的集合都不能被打散。这证明了 $d_{\\mathrm{VC}}(\\mathcal{H}) \\leq d+1$。\n\n结合上下界，我们得出结论 $d_{\\mathrm{VC}}(\\mathcal{H}) = d+1$。\n\n**步骤 3：纯兴奋感知机的 VC 维度 $d_{\\mathrm{VC}}(\\mathcal{H}_{+})$**\n\n假设类 $\\mathcal{H}_{+} = \\{h_{\\mathbf{w},b} : \\mathbf{w} \\in \\mathbb{R}_{+}^{d}, b \\in \\mathbb{R}\\}$ 由法向量 $\\mathbf{w}$ 具有非负分量（对所有 $i$ 都有 $w_i \\geq 0$）的超平面组成。这个约束引入了一个单调性属性。如果 $\\mathbf{x} \\succeq \\mathbf{y}$（即，对所有 $i$ 都有 $x_i \\geq y_i$），那么对于任何 $\\mathbf{w} \\in \\mathbb{R}_+^d$，我们有 $\\mathbf{w}^\\top\\mathbf{x} \\geq \\mathbf{w}^\\top\\mathbf{y}$。这意味着 $\\mathbf{w}^\\top\\mathbf{x}+b \\geq \\mathbf{w}^\\top\\mathbf{y}+b$。因此，如果 $h(\\mathbf{y})=+1$，就不可能出现 $h(\\mathbf{x})=-1$。\n\n*   **下界：$d_{\\mathrm{VC}}(\\mathcal{H}_{+}) \\geq d$**\n\n    我们必须找到一个能被 $\\mathcal{H}_{+}$ 打散的 $d$ 个点的集合。考虑标准基向量的集合 $S = \\{\\mathbf{e}_1, \\dots, \\mathbf{e}_d\\}$。这个集合是一个反链，意味着没有一个元素支配另一个元素，因此单调性属性不会轻易地阻止打散。\n\n    对于任意标记 $(\\ell_1, \\dots, \\ell_d) \\in \\{-1, +1\\}^d$，我们需要找到 $\\mathbf{w} \\in \\mathbb{R}_+^d$ 和 $b \\in \\mathbb{R}$ 使得对所有 $i$ 都有 $\\mathrm{sign}(w_i + b) = \\ell_i$。\n    - 设 $b = -1/2$。\n    - 对于每个 $i \\in \\{1, \\dots, d\\}$：\n        - 如果 $\\ell_i = +1$，我们需要 $w_i - 1/2 \\geq 0$，所以 $w_i \\geq 1/2$。我们可以选择 $w_i = 1$。这满足 $w_i \\geq 0$。\n        - 如果 $\\ell_i = -1$，我们需要 $w_i - 1/2  0$，所以 $w_i  1/2$。我们可以选择 $w_i = 0$。这满足 $w_i \\geq 0$。\n    这个构造为任何标记提供了一个有效的 $(\\mathbf{w}, b)$。因此，集合 $S$ 可以被打散，这证明了 $d_{\\mathrm{VC}}(\\mathcal{H}_{+}) \\geq d$。\n\n*   **上界：$d_{\\mathrm{VC}}(\\mathcal{H}_{+}) \\leq d$**\n\n    我们证明任何 $d+1$ 个点的集合都不能被打散。令 $S = \\{\\mathbf{x}_1, \\dots, \\mathbf{x}_{d+1}\\}$ 为 $\\mathbb{R}^d$ 中任意 $d+1$ 个点的集合。\n\n    首先，我们可以平移整个坐标系而不改变集合被 $\\mathcal{H}_{+}$ 打散的能力。令 $\\mathbf{p} \\in \\mathbb{R}^d$ 为一个向量，其中每个分量 $p_j$ 是 $S$ 中所有点第 $j$ 个坐标的最小值：$p_j = \\min_{i=1, \\dots, d+1} x_{ij}$。我们定义一组新的点 $\\mathbf{y}_i = \\mathbf{x}_i - \\mathbf{p}$。作用于原始点上的分类器 $h_{\\mathbf{w},b}(\\mathbf{x})$ 等价于作用于新点上的分类器 $h_{\\mathbf{w},b'}(\\mathbf{y})$，其中 $b' = b + \\mathbf{w}^\\top\\mathbf{p}$。由于对于一个给定的分类器，$\\mathbf{w}$ 和 $\\mathbf{p}$ 是固定的，所以 $b'$ 只是另一个偏置项。约束 $\\mathbf{w} \\in \\mathbb{R}_+^d$ 不受影响。新点 $\\{\\mathbf{y}_i\\}$ 具有对所有 $i,j$ 都有 $y_{ij} \\geq 0$ 的性质。\n\n    集合 $\\{\\mathbf{y}_1, \\dots, \\mathbf{y}_{d+1}\\}$ 由 $\\mathbb{R}^d$ 中的 $d+1$ 个向量组成。因此，它们必须是线性相关的。存在不全为零的标量 $\\alpha_1, \\dots, \\alpha_{d+1}$，使得：\n    $$ \\sum_{i=1}^{d+1} \\alpha_i \\mathbf{y}_i = \\mathbf{0} $$\n    令 $P = \\{i : \\alpha_i > 0\\}$ 和 $N = \\{i : \\alpha_i  0\\}$。这些集合中至少有一个是非空的。如果其中一个为空，则相应的标记（全为 $+1$ 或全为 $-1$）可以通过设置 $\\mathbf{w}=\\mathbf{0}$ 和 $b=1$ 或 $b=-1$ 来轻易实现。然而，我们总能找到一个线性相关性，使得 $P$ 和 $N$ 都非空，除非所有点都位于从原点发出的一条射线上，这是一个我们可以忽略的退化情况。\n\n    考虑由 $\\ell_i = \\mathrm{sgn}(\\alpha_i)$ 给出的标记，其中 $i \\in P \\cup N$。为了引出矛盾，假设这个标记可以被某个 $h_{\\mathbf{w},b} \\in \\mathcal{H}_{+}$ 实现，其中 $\\mathbf{w} \\in \\mathbb{R}_+^d$。那么我们有：\n    - 对于 $i \\in P$，有 $\\mathbf{w}^\\top\\mathbf{y}_i + b > 0$\n    - 对于 $i \\in N$，有 $\\mathbf{w}^\\top\\mathbf{y}_i + b  0$\n\n    对于任何 $i \\in N$，我们有 $\\mathbf{w}^\\top\\mathbf{y}_i + b  0$。由于 $\\mathbf{w} \\in \\mathbb{R}_+^d$ 且 $\\mathbf{y}_i$ 的所有分量都是非负的，所以 $\\mathbf{w}^\\top\\mathbf{y}_i \\geq 0$。这迫使偏置项为负：$b  0$。\n\n    现在，将每个不等式乘以相应的 $\\alpha_i$ 并对所有 $i$ 求和：\n    $$ \\sum_{i=1}^{d+1} \\alpha_i (\\mathbf{w}^\\top\\mathbf{y}_i + b) > 0 $$\n    严格不等式成立的原因是，对于每个 $i \\in P \\cup N$，$\\alpha_i$ 与 $(\\mathbf{w}^\\top\\mathbf{y}_i + b)$ 的符号相同，所以它们的乘积为正。正数项的和为正。展开求和式：\n    $$ \\sum_{i=1}^{d+1} \\alpha_i (\\mathbf{w}^\\top\\mathbf{y}_i) + \\sum_{i=1}^{d+1} \\alpha_i b > 0 $$\n    $$ \\mathbf{w}^\\top \\left(\\sum_{i=1}^{d+1} \\alpha_i \\mathbf{y}_i\\right) + b \\left(\\sum_{i=1}^{d+1} \\alpha_i\\right) > 0 $$\n    根据线性相关性，第一项是 $\\mathbf{w}^\\top\\mathbf{0} = 0$。我们剩下：\n    $$ b \\left(\\sum_{i=1}^{d+1} \\alpha_i\\right) > 0 $$\n    凸几何中的一个标准结果是，对于像 $\\{\\mathbf{y}_i\\}$ 这样通过平移构造的点集，可以选择一个线性相关性使得 $\\sum \\alpha_i \\geq 0$。假设如此，我们有两个条件：\n    1.  $b  0$（从考虑标记为 $-1$ 的点导出）\n    2.  $b (\\sum \\alpha_i) > 0$ 其中 $\\sum \\alpha_i \\geq 0$。\n\n    如果 $\\sum \\alpha_i > 0$，这两个条件意味着 $b0$ 和 $b>0$，这是一个矛盾。如果 $\\sum \\alpha_i = 0$，第二个条件变为 $0 > 0$，也是一个矛盾。\n    因此，基于 $\\alpha_i$ 系数符号的标记无法实现。这表明任何 $d+1$ 个点的集合都不能被 $\\mathcal{H}_+$ 打散。这证明了 $d_{\\mathrm{VC}}(\\mathcal{H}_{+}) \\leq d$。\n\n结合上下界，我们得出结论 $d_{\\mathrm{VC}}(\\mathcal{H}_{+}) = d$。\n\n**步骤 4：比较与最终答案**\n\n我们已经发现，$\\mathbb{R}^d$ 中无限制半空间的 VC 维度是 $d_{\\mathrm{VC}}(\\mathcal{H}) = d+1$。$\\mathbb{R}^d$ 中纯兴奋感知机（非负权重）的 VC 维度是 $d_{\\mathrm{VC}}(\\mathcal{H}_{+}) = d$。\n\n非负权重的约束降低了假设类的复杂性，使其 VC 维度恰好减少了 1。\n\n最终答案是一个双元行向量，给出 $[d_{\\mathrm{VC}}(\\mathcal{H}_{+}), d_{\\mathrm{VC}}(\\mathcal{H})]$。\n即 $[d, d+1]$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nd  d+1\n\\end{pmatrix}\n}\n$$", "id": "3192435"}, {"introduction": "模型的复杂性总是随着数据空间维度的增加而增加吗？这个引人深思的练习 [@problem_id:3192514] 对这一普遍直觉提出了挑战。你将分析一个在高维空间 $\\mathbb{R}^d$ 中看似简单的分类器——它根据点到原点的距离进行分类。你的任务是确定其VC维是否随 $d$ 增长，从而揭示关于假设类结构的关键一课。", "problem": "令 $\\mathcal{H}_{d}$ 为 $\\mathbb{R}^{d}$ 上的二元分类器假设类，由以原点为中心的径向阈值定义：\n$$\n\\mathcal{H}_{d} \\;=\\; \\left\\{\\, h_{r}(x) \\;=\\; \\mathbb{I}\\left\\{ \\|x\\|_{2} \\leq r \\right\\} \\;:\\; r \\in [0,\\infty) \\,\\right\\}.\n$$\n仅使用统计学习理论的核心定义，特别是 Vapnik–Chervonenkis (VC) 维数的定义，确定 VC 维数 $d_{\\mathrm{VC}}(\\mathcal{H}_{d})$，并解释它是否依赖于环境维度 $d$。你的最终答案必须是一个整数。", "solution": "这个问题是有效的，因为它在科学上基于统计学习理论，问题提出得很好，是客观的，并且包含了求解所需的所有必要信息。\n\n问题要求计算在 $\\mathbb{R}^{d}$ 上的二元分类器假设类 $\\mathcal{H}_{d}$ 的 Vapnik–Chervonenkis (VC) 维数，该假设类定义为：\n$$\n\\mathcal{H}_{d} \\;=\\; \\left\\{\\, h_{r}(x) \\;=\\; \\mathbb{I}\\left\\{ \\|x\\|_{2} \\leq r \\right\\} \\;:\\; r \\in [0,\\infty) \\,\\right\\}\n$$\n其中 $\\mathbb{I}\\{\\cdot\\}$ 是指示函数。一个假设 $h_r \\in \\mathcal{H}_d$ 将一个点 $x$ 分类为 $1$，如果其欧几里得范数 $\\|x\\|_2$ 小于或等于半径 $r$；否则分类为 $0$。该假设集由非负半径 $r$ 参数化。\n\n一个假设类 $\\mathcal{H}$ 的 VC 维数，记为 $d_{\\mathrm{VC}}(\\mathcal{H})$，是能被 $\\mathcal{H}$ 打散的最大点集的大小。如果对于点集 $S = \\{x_1, x_2, \\ldots, x_k\\}$ 中点的每一种可能的 $\\{0, 1\\}$ 标记，都存在一个假设 $h \\in \\mathcal{H}$ 能够实现该标记，则称点集 $S$ 能被 $\\mathcal{H}$ 打散。共有 $2^k$ 种不同的标记。\n\n为了确定 $d_{\\mathrm{VC}}(\\mathcal{H}_{d})$，我们必须找到能被打散的 $k$ 个点的集合的最大整数 $k$。这包括两个步骤：\n1.  通过构造一个可以被打散的 $k$ 个点的集合，证明 $d_{\\mathrm{VC}}(\\mathcal{H}_{d}) \\geq k$。\n2.  通过证明任何 $k+1$ 个点的集合都不能被打散，证明 $d_{\\mathrm{VC}}(\\mathcal{H}_{d})  k+1$。\n\n让我们从测试较小的 $k$ 值开始。\n\n**步骤 1：证明 $d_{\\mathrm{VC}}(\\mathcal{H}_{d}) \\geq 1$。**\n\n为了证明 VC 维数至少为 $1$，我们必须找到一个大小为 $1$ 且能被打散的集合。令 $S = \\{x_1\\}$ 是一个在 $\\mathbb{R}^d$ 中包含单个点的集合，使得 $x_1 \\neq 0$。令其范数为 $\\|x_1\\|_2 = \\delta$，其中 $\\delta > 0$。\n\n对 $x_1$ 有 $2^1=2$ 种可能的标记：$\\{0\\}$ 和 $\\{1\\}$。\n- **要获得标记 $\\{1\\}$：** 我们需要一个假设 $h_r \\in \\mathcal{H}_d$ 使得 $h_r(x_1) = 1$。这等价于找到一个 $r$ 使得 $\\mathbb{I}\\{\\|x_1\\|_2 \\le r\\} = 1$，即 $\\|x_1\\|_2 \\le r$。我们可以选择 $r = \\delta$。这是一个有效的选择，因为 $\\delta \\ge 0$，所以 $h_{\\delta} \\in \\mathcal{H}_d$。\n- **要获得标记 $\\{0\\}$：** 我们需要一个假设 $h_r \\in \\mathcal{H}_d$ 使得 $h_r(x_1) = 0$。这等价于找到一个 $r$ 使得 $\\mathbb{I}\\{\\|x_1\\|_2 \\le r\\} = 0$，即 $\\|x_1\\|_2 > r$。我们可以选择 $r = \\frac{\\delta}{2}$。因为 $\\delta>0$，我们有 $r \\ge 0$，所以 $h_{\\delta/2} \\in \\mathcal{H}_d$。\n\n由于两种可能的标记都可以生成，集合 $S = \\{x_1\\}$ 被 $\\mathcal{H}_{d}$ 打散。因此，我们得出结论 $d_{\\mathrm{VC}}(\\mathcal{H}_{d}) \\geq 1$。\n\n**步骤 2：证明 $d_{\\mathrm{VC}}(\\mathcal{H}_{d})  2$。**\n\n为了证明 VC 维数小于 $2$，我们必须证明任何包含 $2$ 个点的集合都不能被 $\\mathcal{H}_{d}$ 打散。令 $S = \\{x_1, x_2\\}$ 是 $\\mathbb{R}^d$ 中任意两个不同点的集合。令它们各自的 L2-范数分别为 $d_1 = \\|x_1\\|_2$ 和 $d_2 = \\|x_2\\|_2$。我们必须证明，对于点对 $(x_1, x_2)$ 的 $2^2 = 4$ 种可能标记中，至少有一种不能被 $\\mathcal{H}_d$ 中的任何假设产生。这四种标记是 $(0,0), (0,1), (1,0), (1,1)$。\n\n我们根据点的范数考虑两种情况。\n\n**情况 A：$d_1 = d_2$。**\n点 $x_1$ 和 $x_2$ 位于以原点为中心、半径为 $d_1$ 的同一个超球面上。对于任何假设 $h_r \\in \\mathcal{H}_d$，$x_1$ 的分类是 $h_r(x_1) = \\mathbb{I}\\{d_1 \\le r\\}$，$x_2$ 的分类是 $h_r(x_2) = \\mathbb{I}\\{d_2 \\le r\\}$。由于 $d_1=d_2$，条件是相同的，所以对于任何 $r$ 的选择，都有 $h_r(x_1) = h_r(x_2)$。\n- 如果我们选择 $r  d_1$，两个点都被标记为 $0$，得到标记 $(0,0)$。\n- 如果我们选择 $r \\ge d_1$，两个点都被标记为 $1$，得到标记 $(1,1)$。\n不可能生成标记 $(0,1)$ 和 $(1,0)$。由于并非所有 $4$ 种标记都能被产生，所以集合 $S$ 没有被打散。\n\n**情况 B：$d_1 \\neq d_2$。**\n不失一般性，我们假设 $d_1  d_2$。（$d_2  d_1$ 的情况是对称的）。现在我们尝试生成标记 $(0,1)$，即 $h_r(x_1)=0$ 和 $h_r(x_2)=1$。\n- 条件 $h_r(x_1)=0$ 要求 $\\|x_1\\|_2 > r$，即 $d_1 > r$。\n- 条件 $h_r(x_2)=1$ 要求 $\\|x_2\\|_2 \\le r$，即 $d_2 \\le r$。\n将这两个不等式结合起来得到 $d_1 > r \\ge d_2$。这意味着 $d_1 > d_2$，这与我们 $d_1  d_2$ 的假设相矛盾。因此，标记 $(0,1)$ 不能被 $\\mathcal{H}_d$ 中的任何假设生成。由于并非所有 $4$ 种标记都能被产生，所以集合 $S$ 没有被打散。\n\n因为我们已经证明了对于任意两个点的集合，该集合都不能被打散，所以我们得出结论 $d_{\\mathrm{VC}}(\\mathcal{H}_{d})  2$。\n\n**结论：**\n\n从步骤 1，我们有 $d_{\\mathrm{VC}}(\\mathcal{H}_{d}) \\geq 1$。从步骤 2，我们有 $d_{\\mathrm{VC}}(\\mathcal{H}_{d})  2$。由于 VC 维数必须是整数，唯一可能的值是 $1$。\n\n$$d_{\\mathrm{VC}}(\\mathcal{H}_{d}) = 1$$\n\n问题还问到 VC 维数是否依赖于环境维度 $d$。我们的推导仅依赖于点的 L2-范数的大小，这些是非负实数。将这些距离与阈值 $r$ 进行比较的逻辑与点所在的维度 $d$ 无关（只要 $d \\ge 1$，以便我们可以找到一个非零点）。无法打散两个点是其范数的一维排序的结果，而与它们在 $\\mathbb{R}^d$ 中的几何构型无关。因此，VC 维数 $d_{\\mathrm{VC}}(\\mathcal{H}_{d})$ 不依赖于环境维度 $d$。", "answer": "$$\\boxed{1}$$", "id": "3192514"}, {"introduction": "VC维的概念超越了​​几何分类器，同样适用于更广泛的函数类别。在这个问题中 [@problem_id:3192499]，我们探讨一个由实直线上的分段常数函数构建的分类器家族。这些函数的复杂性由一个单一参数控制：即“跳跃点”或不连续点的最大数量 $k$。通过计算以 $k$ 为变量的VC维，你将看到模型结构复杂性与其学习能力之间直接而优雅的联系。", "problem": "设 $k \\in \\mathbb{N}$ 是一个固定的自然数。考虑实值函数 $f:\\mathbb{R}\\to\\mathbb{R}$ 的类别 $\\mathcal{F}_{k}$，这些函数是分段常数函数，最多有 $k$ 个跳跃点，即在 $\\mathbb{R}$ 中最多存在 $k$ 个点，函数 $f$ 在这些点上改变其值。从 $\\mathcal{F}_{k}$ 构建阈值分类器的假设类\n$$\n\\mathcal{H}_{k} \\;=\\; \\left\\{\\, h_{f,\\theta}(x) \\;=\\; \\mathbf{1}\\{ f(x) \\ge \\theta \\} \\;:\\; f \\in \\mathcal{F}_{k},\\ \\theta \\in \\mathbb{R} \\,\\right\\}.\n$$\n仅使用打散（shattering）和 Vapnik–Chervonenkis (VC) 维度的基本定义，确定 Vapnik–Chervonenkis 维度 $d_{\\mathrm{VC}}(\\mathcal{H}_{k})$ 作为 $k$ 的函数，并构造一个大小为 $d_{\\mathrm{VC}}(\\mathcal{H}_{k})$ 的能被 $\\mathcal{H}_{k}$ 打散的显式集合 $S \\subset \\mathbb{R}$。你的最终答案必须是 $d_{\\mathrm{VC}}(\\mathcal{H}_{k})$ 的精确闭式表达式。不需要数值四舍五入。", "solution": "一个假设类 $\\mathcal{H}$ 的 Vapnik-Chervonenkis (VC) 维度，记作 $d_{\\mathrm{VC}}(\\mathcal{H})$，是可以被 $\\mathcal{H}$ 打散的最大有限点集 $S$ 的大小。如果对于 $S$ 中点的每一种可能的二元标记，都存在一个假设 $h \\in \\mathcal{H}$ 能够实现该标记，那么集合 $S$ 就被 $\\mathcal{H}$ 打散。\n\n问题要求解假设类\n$$\n\\mathcal{H}_{k} \\;=\\; \\left\\{\\, h_{f,\\theta}(x) \\;=\\; \\mathbf{1}\\{ f(x) \\ge \\theta \\} \\;:\\; f \\in \\mathcal{F}_{k},\\ \\theta \\in \\mathbb{R} \\,\\right\\}\n$$\n的 VC 维度，其中 $\\mathcal{F}_k$ 是对于固定的 $k \\in \\mathbb{N}$，最多有 $k$ 个跳跃点的分段常数实值函数 $f:\\mathbb{R}\\to\\mathbb{R}$ 的类别。\n\n为了确定 $d_{\\mathrm{VC}}(\\mathcal{H}_{k})$，我们将确定其值的下界和上界。我们将证明 $d_{\\mathrm{VC}}(\\mathcal{H}_{k}) \\ge k+1$ 和 $d_{\\mathrm{VC}}(\\mathcal{H}_{k}) \\le k+1$，这两者共同意味着 $d_{\\mathrm{VC}}(\\mathcal{H}_{k}) = k+1$。\n\n**第1部分：下界, $d_{\\mathrm{VC}}(\\mathcal{H}_{k}) \\ge k+1$**\n\n为了建立下界，我们必须找到一个大小为 $k+1$ 且能被 $\\mathcal{H}_{k}$ 打散的点集 $S$。\n我们选择集合 $S = \\{1, 2, \\dots, k+1\\}$。该集合的大小为 $|S| = k+1$。\n为了证明 $S$ 被打散，我们必须表明对于任何可能的标记 $y = (y_1, y_2, \\dots, y_{k+1}) \\in \\{0, 1\\}^{k+1}$，都存在一个假设 $h \\in \\mathcal{H}_k$ 使得对所有 $i \\in S$ 都有 $h(i) = y_i$。一个假设 $h$ 由一个函数 $f \\in \\mathcal{F}_k$ 和一个阈值 $\\theta \\in \\mathbb{R}$ 定义。\n\n对于任意标记 $y \\in \\{0, 1\\}^{k+1}$，我们构造一个特定的函数 $f_y : \\mathbb{R} \\to \\mathbb{R}$。令潜在的跳跃点为 $t_i = i + 0.5$，其中 $i=1, 2, \\dots, k$。定义 $f_y$ 如下：\n$$\nf_y(x) = \\begin{cases}\n    y_1  \\text{if } x  t_1 \\\\\n    y_i  \\text{if } t_{i-1} \\le x  t_i \\quad \\text{for } i=2, \\dots, k \\\\\n    y_{k+1}  \\text{if } x \\ge t_k\n\\end{cases}\n$$\n根据构造，这个函数 $f_y$ 是分段常数的。$f_y(x)$ 的值只能在点 $t_1, t_2, \\dots, t_k$ 处改变。当且仅当 $y_i \\neq y_{i+1}$ 时，在 $t_i$ 处发生跳跃。总跳跃次数为 $\\sum_{i=1}^{k} \\mathbf{1}\\{y_i \\neq y_{i+1}\\}$。对于任何长度为 $k+1$ 的二元序列，这种交替的最大次数是 $k$（例如，序列 $(0, 1, 0, 1, \\dots)$）。因此，$f_y$ 的跳跃次数最多为 $k$，这意味着 $f_y \\in \\mathcal{F}_k$。\n\n通过这种构造，对于每个点 $i \\in S = \\{1, 2, \\dots, k+1\\}$，函数的值为 $f_y(i) = y_i$。例如，对于 $i=1$，有 $1  t_1 = 1.5$，所以 $f_y(1) = y_1$。对于 $i \\in \\{2, \\dots, k\\}$，我们有 $t_{i-1} = i-0.5 \\le i  i+0.5 = t_i$，所以 $f_y(i) = y_i$。对于 $i=k+1$，我们有 $k+1 > t_k = k+0.5$，所以 $f_y(k+1) = y_{k+1}$。\n\n现在，我们选择一个阈值 $\\theta$。设 $\\theta = 0.5$。相应的假设 $h_{f_y, \\theta}$ 由 $h(x) = \\mathbf{1}\\{f_y(x) \\ge 0.5\\}$ 给出。\n对于 $S$ 中的任何点 $i$，分类结果为：\n$$\nh(i) = \\mathbf{1}\\{f_y(i) \\ge 0.5\\} = \\mathbf{1}\\{y_i \\ge 0.5\\}\n$$\n由于 $y_i \\in \\{0, 1\\}$，条件 $y_i \\ge 0.5$ 为真当且仅当 $y_i = 1$。因此，$h(i) = y_i$。\n这对所有 $i \\in S$ 都成立。我们成功地在 $\\mathcal{H}_k$ 中构造了一个假设，实现了任意标记 $y$。由于这对所有 $2^{k+1}$ 种标记都是可能的，所以集合 $S$ 被 $\\mathcal{H}_k$ 打散。\n由于我们找到了一个大小为 $k+1$ 的被打散的集合，我们得出结论 $d_{\\mathrm{VC}}(\\mathcal{H}_{k}) \\ge k+1$。\n\n**第2部分：上界, $d_{\\mathrm{VC}}(\\mathcal{H}_{k}) \\le k+1$**\n\n为了建立上界，我们必须证明任何大小为 $k+2$ 的集合都不能被 $\\mathcal{H}_k$ 打散。\n设 $h \\in \\mathcal{H}_k$ 是一个任意假设。根据定义，$h(x) = \\mathbf{1}\\{f(x) \\ge \\theta\\}$，其中 $f \\in \\mathcal{F}_k$ 是一个函数，$\\theta \\in \\mathbb{R}$ 是一个阈值。函数 $f$ 是分段常数函数，最多有 $k$ 个跳跃点。设 $f$ 的跳跃点集合为 $T_f = \\{p_1, \\dots, p_m\\}$，其中 $m \\le k$。\n函数 $h(x)$ 也是分段常数的。它的值只能在 $f(x)$ 值改变的点处改变。因此，$h$ 的跳跃点必须是 $f$ 跳跃点的一个子集。所以，$h(x)$ 最多有 $m \\le k$ 个跳跃点。\n\n设 $S' = \\{x_1, x_2, \\dots, x_{k+2}\\}$ 是实数轴上任意 $k+2$ 个不同点的集合，并按 $x_1  x_2  \\dots  x_{k+2}$ 排序。\n考虑由 $h$ 导出的 $S'$ 的标记：$(h(x_1), h(x_2), \\dots, h(x_{k+2}))$。\n我们来计算这个标记序列中的交替次数，即相邻点之间标记改变的次数：$A = \\sum_{i=1}^{k+1} \\mathbf{1}\\{h(x_i) \\neq h(x_{i+1})\\}$。\n如果 $h(x_i) \\neq h(x_{i+1})$，函数 $h$ 必须在开区间 $(x_i, x_{i+1})$ 内的某处改变其值。由于 $h$ 是一个分段常数函数，这意味着在 $(x_i, x_{i+1})$ 中必须至少有一个 $h$ 的跳跃点。\n区间 $(x_1, x_2), (x_2, x_3), \\dots, (x_{k+1}, x_{k+2})$ 都是不相交的。因此，交替次数 $A$ 最多等于 $h$ 的总跳跃点数。正如我们所确定的，$h$ 的跳跃点数最多为 $k$。\n所以，对于任何 $h \\in \\mathcal{H}_k$，它在 $S'$ 上导出的标记最多只能有 $k$ 次交替。\n\n现在，考虑特定的标记 $y' = (1, 0, 1, 0, \\dots)$。这个长度为 $k+2$ 的序列中的交替次数是 $(k+2)-1 = k+1$。\n因为 $k+1 > k$，这个特定的标记 $y'$ 的交替次数比 $\\mathcal{H}_k$ 中任何假设在有序集合 $S'$ 上能产生的都要多。因此，这个标记不能被任何 $h \\in \\mathcal{H}_k$ 实现。\n这意味着集合 $S'$ 不能被 $\\mathcal{H}_k$ 打散。由于这对任何大小为 $k+2$ 的点集都成立，我们得出结论，没有大小为 $k+2$ 的集合可以被打散。\n根据 VC 维度的定义，这意味着 $d_{\\mathrm{VC}}(\\mathcal{H}_{k})  k+2$，或者说 $d_{\\mathrm{VC}}(\\mathcal{H}_{k}) \\le k+1$。\n\n**结论**\n\n根据第1部分，我们有 $d_{\\mathrm{VC}}(\\mathcal{H}_{k}) \\ge k+1$。\n根据第2部分，我们有 $d_{\\mathrm{VC}}(\\mathcal{H}_{k}) \\le k+1$。\n结合这两个不等式，我们唯一地确定了 VC 维度：\n$$\nd_{\\mathrm{VC}}(\\mathcal{H}_{k}) = k+1.\n$$\n能被打散的、大小为 $k+1$ 的显式集合是 $S = \\{1, 2, \\dots, k+1\\}$。", "answer": "$$\\boxed{k+1}$$", "id": "3192499"}]}