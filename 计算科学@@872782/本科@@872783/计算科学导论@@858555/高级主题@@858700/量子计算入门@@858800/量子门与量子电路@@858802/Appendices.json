{"hands_on_practices": [{"introduction": "量子计算的基础在于精确操控单个量子比特的状态。本练习将通过一个具体例子，展示如何通过应用一系列基本单量子比特门（如阿达玛门 $H$ 和相位门 $S$）将一个量子比特从初始状态 $|0\\rangle$ 转换到任意的目标态。掌握这种状态制备技术是构建更复杂量子算法的第一步 [@problem_id:1440374]。", "problem": "在一个量子计算中，一个量子比特被初始化到状态 $|0\\rangle$。目标是将这个量子比特变换到特定的目标态 $|\\psi_f\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + i|1\\rangle)$。你可使用一组标准的单量子比特门，包括哈达玛门（$H$）和相位门（$S$）。\n\n在标准计算基中，基态由列向量表示：\n$$|0\\rangle = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, \\quad |1\\rangle = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}$$\n哈达玛门和相位门的矩阵表示为：\n$$H = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1  1 \\\\ 1  -1 \\end{pmatrix}, \\quad S = \\begin{pmatrix} 1  0 \\\\ 0  i \\end{pmatrix}$$\n当应用一个门序列时，例如 `XY`，意味着先应用门 `Y`，然后应用门 `X`。这对应于矩阵乘法 $X(Y|\\psi_{in}\\rangle)$。\n\n下列哪个门序列能成功将初态 $|0\\rangle$ 变换到目标态 $|\\psi_f\\rangle$？\n\nA. $S$\n\nB. $H$\n\nC. $HS$\n\nD. $SH$\n\nE. $HSH$", "solution": "我们从初态 $|\\psi_{\\text{in}}\\rangle = |0\\rangle = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ 和目标态开始\n$$\n|\\psi_{f}\\rangle = \\frac{1}{\\sqrt{2}}\\left(|0\\rangle + i|1\\rangle\\right) = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ i \\end{pmatrix}.\n$$\n一个单量子比特门 $X$ 作为矩阵线性作用于状态向量，序列 $XY$ 意味着先应用 $Y$，再应用 $X$，即 $XY|\\psi\\rangle = X\\left(Y|\\psi\\rangle\\right)$。两个仅相差一个全局相位的态在物理上是等价的；因此，我们必须匹配分量之间的相对相位。\n\n给定\n$$\nH = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1  1 \\\\ 1  -1 \\end{pmatrix}, \\quad S = \\begin{pmatrix} 1  0 \\\\ 0  i \\end{pmatrix},\n$$\n我们评估每个选项。\n\n选项 A：$S$\n$$\nS|0\\rangle = \\begin{pmatrix} 1  0 \\\\ 0  i \\end{pmatrix}\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = |0\\rangle \\neq \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ i \\end{pmatrix}.\n$$\n这不是目标态（即使不考虑全局相位也不是）。\n\n选项 B：$H$\n$$\nH|0\\rangle = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1  1 \\\\ 1  -1 \\end{pmatrix}\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}.\n$$\n这个态的分量之间的相对相位为 $1$，而不是 $i$，因此它与目标态在不考虑全局相位的情况下不相等。\n\n选项 C：$HS$（先应用 $S$ 后应用 $H$）\n$$\nHS|0\\rangle = H\\left(S|0\\rangle\\right) = H|0\\rangle = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix},\n$$\n与选项 B 结果相同，因此不是目标态。\n\n选项 D：$SH$（先应用 $H$ 后应用 $S$）\n$$\nH|0\\rangle = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}, \\quad S\\left(H|0\\rangle\\right) = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1  0 \\\\ 0  i \\end{pmatrix}\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ i \\end{pmatrix} = |\\psi_{f}\\rangle.\n$$\n这恰好产生目标态。\n\n选项 E：$HSH$（先应用 $H$，然后 $S$，再然后 $H$）\n前两个门作用的结果为：\n$$\nSH|0\\rangle = \\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ i \\end{pmatrix}.\n$$\n应用最后一个 $H$，\n$$\nH\\left(\\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1 \\\\ i \\end{pmatrix}\\right) = \\frac{1}{\\sqrt{2}}\\cdot\\frac{1}{\\sqrt{2}}\\begin{pmatrix} 1  1 \\\\ 1  -1 \\end{pmatrix}\\begin{pmatrix} 1 \\\\ i \\end{pmatrix} = \\frac{1}{2}\\begin{pmatrix} 1 + i \\\\ 1 - i \\end{pmatrix}.\n$$\n分量的比值为\n$$\n\\frac{1 - i}{1 + i} = \\frac{(1 - i)^{2}}{(1 + i)(1 - i)} = \\frac{1 - 2i - 1}{1 - i^{2}} = \\frac{-2i}{2} = -i,\n$$\n而对于 $|\\psi_{f}\\rangle$，该比值为 $i$。由于相对相位不同，该状态与 $|\\psi_{f}\\rangle$ 在不考虑全局相位的情况下不相等。\n\n因此，唯一正确的序列是 $SH$。", "answer": "$$\\boxed{D}$$", "id": "1440374"}, {"introduction": "在掌握了单量子比特门之后，下一步是理解量子比特之间的相互作用，这是实现强大量子算法的关键。受控非门（CNOT）是多量子比特线路中最核心的构件之一，它能够产生量子纠缠。本练习将探究当 CNOT 门作用于叠加态的量子比特上时会发生什么，并计算最终的测量概率，从而加深对量子纠缠和测量的理解 [@problem_id:1440398]。", "problem": "考虑一个由两个量子比特组成的量子系统，标记为量子比特1和量子比特2。量子比特1的初始态制备在$|+\\rangle$态，量子比特2的初始态制备在$|-\\rangle$态。这些状态由计算基矢$|0\\rangle$和$|1\\rangle$定义如下：\n$$|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle)$$\n$$|-\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle - |1\\rangle)$$\n因此，系统的复合初始态是张量积$|\\psi_{in}\\rangle = |+\\rangle \\otimes |-\\rangle$。\n\n一个受控非门（CNOT）作用于这个双量子比特系统。量子比特1作为控制量子比特，量子比特2作为目标量子比特。CNOT门对计算基矢$|c\\rangle|t\\rangle$的作用是将其变换为$|c\\rangle|t \\oplus c\\rangle$，其中$\\oplus$表示模2加法。\n\n在CNOT操作之后，对第二个量子比特（目标量子比特）在计算基$\\{|0\\rangle, |1\\rangle\\}$下进行测量。计算测量第二个量子比特得到结果为$|1\\rangle$态的概率。请用简化分数表示你的答案。", "solution": "初始的单量子比特态由$|+\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle)$和$|-\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle - |1\\rangle)$给出。复合初始态是张量积\n$$\n|\\psi_{in}\\rangle = |+\\rangle \\otimes |-\\rangle = \\frac{1}{2}\\left(|0\\rangle + |1\\rangle\\right)\\otimes\\left(|0\\rangle - |1\\rangle\\right).\n$$\n在计算基中展开，\n$$\n|\\psi_{in}\\rangle = \\frac{1}{2}\\left(|00\\rangle - |01\\rangle + |10\\rangle - |11\\rangle\\right).\n$$\n一个以量子比特1为控制、量子比特2为目标的CNOT门的作用方式为$|c\\rangle|t\\rangle \\mapsto |c\\rangle|t \\oplus c\\rangle$，其对基矢的作用如下\n$$\n|00\\rangle \\mapsto |00\\rangle,\\quad |01\\rangle \\mapsto |01\\rangle,\\quad |10\\rangle \\mapsto |11\\rangle,\\quad |11\\rangle \\mapsto |10\\rangle.\n$$\n将此作用于$|\\psi_{in}\\rangle$得到门操作后的状态\n$$\n|\\psi_{out}\\rangle = \\frac{1}{2}\\left(|00\\rangle - |01\\rangle + |11\\rangle - |10\\rangle\\right) = \\frac{1}{2}\\left(|00\\rangle - |01\\rangle - |10\\rangle + |11\\rangle\\right).\n$$\n对第二个量子比特在计算基下的投影测量由投影算符$I \\otimes |0\\rangle\\langle 0|$和$I \\otimes |1\\rangle\\langle 1|$描述。根据玻恩定则，在第二个量子比特上获得结果$|1\\rangle$的概率为\n$$\np(1) = \\langle \\psi_{out}|\\,\\left(I \\otimes |1\\rangle\\langle 1|\\right)\\,|\\psi_{out}\\rangle.\n$$\n将$|\\psi_{out}\\rangle$投影到第二个量子比特为$|1\\rangle$的状态上，会选出$|01\\rangle$和$|11\\rangle$分量：\n$$\n\\left(I \\otimes |1\\rangle\\langle 1|\\right)|\\psi_{out}\\rangle = \\frac{1}{2}\\left(-|01\\rangle + |11\\rangle\\right).\n$$\n该概率是此向量的范数平方，\n$$\np(1) = \\left\\|\\frac{1}{2}\\left(-|01\\rangle + |11\\rangle\\right)\\right\\|^{2} = \\left(-\\frac{1}{2}\\right)^{2} + \\left(\\frac{1}{2}\\right)^{2} = \\frac{1}{4} + \\frac{1}{4} = \\frac{1}{2}.\n$$\n因此，测量第二个量子比特得到结果为$|1\\rangle$的概率是$\\frac{1}{2}$。", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "1440398"}, {"introduction": "许多量子算法依赖于可逆计算的原理，即在计算完成后能够将辅助量子比特“复位”到其初始状态，以避免不必要的纠缠。本练习介绍了一个重要的三量子比特门——托福利门（Toffoli gate），并演示了“计算-执行-反计算”这一在量子算法设计中至关重要的模式。通过这个练习，你将理解如何利用量子门实现逻辑运算，并干净地清除计算痕迹 [@problem_id:1440414]。", "problem": "在量子计算中，通常需要在输入量子比特上计算一个经典逻辑函数，并将结果存储在一个辅助量子比特（称为ancilla）中。许多量子算法的一个关键部分是接着“反计算”（uncompute）对辅助量子比特的改变，将其恢复到初始状态，以避免不必要的纠缠并释放该量子比特以供重用。\n\n考虑一个三量子比特的量子系统，其状态向量由 $|\\psi\\rangle = |q_1 q_2 q_3\\rangle$ 描述，其中 $q_1$ 和 $q_2$ 是输入量子比特，$q_3$ 是一个辅助量子比特。该系统被初始化到基态 $|\\psi_{init}\\rangle = |000\\rangle$。以下一系列量子门操作被应用于该系统：\n\n1.  对量子比特 $q_1$ 应用一个哈达玛（H）门。\n2.  对量子比特 $q_2$ 应用一个哈达玛（H）门。\n3.  应用一个托福利（Toffoli）门。托福利门是一个受控-受控-非（CCNOT）门，其中 $q_1$ 和 $q_2$ 为控制量子比特，$q_3$ 为目标量子比特。此门对基态 $|x, y, z\\rangle$ 的作用是将其转换为 $|x, y, z \\oplus (x \\cdot y)\\rangle$，其中 $\\oplus$ 表示模2加法，且 $x, y, z \\in \\{0, 1\\}$。\n4.  对辅助量子比特 $q_3$ 应用一个泡利-Z（Z）门。Z门对基态 $|z\\rangle$ 的作用是将其转换为 $(-1)^z |z\\rangle$。\n5.  再次应用与步骤3中相同的托福利（CCNOT）门。\n\n确定该三量子比特系统的最终状态 $|\\psi_{final}\\rangle$。从以下选项中选择正确的表达式。\n\nA. $\\frac{1}{2}(|000\\rangle + |010\\rangle + |100\\rangle + |111\\rangle)$\n\nB. $\\frac{1}{2}(|000\\rangle + |010\\rangle + |100\\rangle - |111\\rangle)$\n\nC. $\\frac{1}{2}(|000\\rangle + |010\\rangle + |100\\rangle + |110\\rangle)$\n\nD. $\\frac{1}{2}(-|000\\rangle + |010\\rangle + |100\\rangle + |110\\rangle)$\n\nE. $\\frac{1}{2}(|000\\rangle + |010\\rangle + |100\\rangle - |110\\rangle)$", "solution": "我们从初始状态 $|\\psi_{init}\\rangle = |000\\rangle$ 开始。\n\n1) 对 $q_{1}$ 应用一个哈达玛门。使用 $H|0\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle)$，状态变为\n$$\n|\\psi_{1}\\rangle = \\left(\\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle)\\right)\\otimes|00\\rangle = \\frac{1}{\\sqrt{2}}\\big(|000\\rangle + |100\\rangle\\big).\n$$\n\n2) 对 $q_{2}$ 应用一个哈达玛门。再次对第二个量子比特使用 $H|0\\rangle = \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle)$，\n$$\n|\\psi_{2}\\rangle = \\frac{1}{\\sqrt{2}}\\left(|0\\rangle\\otimes\\frac{|0\\rangle + |1\\rangle}{\\sqrt{2}}\\otimes|0\\rangle + |1\\rangle\\otimes\\frac{|0\\rangle + |1\\rangle}{\\sqrt{2}}\\otimes|0\\rangle\\right)\n= \\frac{1}{2}\\big(|000\\rangle + |010\\rangle + |100\\rangle + |110\\rangle\\big).\n$$\n\n3) 应用一个以 $q_{1},q_{2}$ 为控制位、 $q_{3}$ 为目标位的托福利（CCNOT）门。这将 $|x,y,z\\rangle$ 映射到 $|x,y,z\\oplus(x\\cdot y)\\rangle$。在上述分量中，只有 $|110\\rangle$ 满足 $x=y=1$，所以它会翻转为 $|111\\rangle$。因此\n$$\n|\\psi_{3}\\rangle = \\frac{1}{2}\\big(|000\\rangle + |010\\rangle + |100\\rangle + |111\\rangle\\big).\n$$\n\n4) 对 $q_{3}$ 应用一个泡利-Z 门。使用 $Z|z\\rangle = (-1)^{z}|z\\rangle$，只有 $q_{3}=1$ 的项会获得一个负号，即 $|111\\rangle\\mapsto -|111\\rangle$。于是\n$$\n|\\psi_{4}\\rangle = \\frac{1}{2}\\big(|000\\rangle + |010\\rangle + |100\\rangle - |111\\rangle\\big).\n$$\n\n5) 再次应用同一个托福利门。当 $q_{1}=q_{2}=1$ 时，它会翻转目标量子比特 $q_{3}$。现在唯一满足此条件的项是 $-|111\\rangle$，它被映射到 $-|110\\rangle$。因此最终状态是\n$$\n|\\psi_{final}\\rangle = \\frac{1}{2}\\big(|000\\rangle + |010\\rangle + |100\\rangle - |110\\rangle\\big),\n$$\n这对应于选项 E。", "answer": "$$\\boxed{E}$$", "id": "1440414"}]}