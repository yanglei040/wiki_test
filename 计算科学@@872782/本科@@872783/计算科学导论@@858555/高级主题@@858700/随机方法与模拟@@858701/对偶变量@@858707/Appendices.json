{"hands_on_practices": [{"introduction": "要想真正掌握对偶变量法的威力，具体的计算是必不可少的。第一个练习将挑战你分析性地确定将该方法应用于一个简单单调函数时所能实现的精确方差缩减，从而巩固你对该方法核心机制的理解。[@problem_id:2188199]", "problem": "在计算科学中，蒙特卡洛方法常用于近似计算定积分 $I = \\int_{0}^{1} f(x) \\,dx$ 的值。这些方法的一个关键方面是通过减少估计量的方差来提高准确性。\n\n考虑函数 $f(x) = (1+x)^2$ 在区间 $[0, 1]$ 上的积分。我们将比较该积分的两种蒙特卡洛估计量，这两种估计量都基于总共 $N$ 次函数求值，其中 $N$ 是一个偶数。\n\n1.  **标准蒙特卡洛估计量 ($\\hat{I}_{\\text{std}}$):**\n    该估计量通过从 Uniform(0,1) 分布中抽取 $N$ 个独立同分布的随机数 $X_1, X_2, \\ldots, X_N$ 形成。该估计量由下式给出：\n    $$ \\hat{I}_{\\text{std}} = \\frac{1}{N} \\sum_{i=1}^{N} f(X_i) $$\n\n2.  **对偶变量估计量 ($\\hat{I}_{\\text{anti}}$):**\n    该估计量通过从 Uniform(0,1) 分布中抽取 $M = N/2$ 个独立随机数 $U_1, U_2, \\ldots, U_M$ 形成。对每个 $U_i$，我们构成一对“对偶”样本 $(U_i, 1-U_i)$。该估计量由下式给出：\n    $$ \\hat{I}_{\\text{anti}} = \\frac{1}{M} \\sum_{i=1}^{M} \\frac{f(U_i) + f(1-U_i)}{2} $$\n\n你的任务是解析地确定对于这个特定函数，使用对偶变量所实现的理论方差减少量。计算比率 $R = \\frac{\\text{Var}(\\hat{I}_{\\text{anti}})}{\\text{Var}(\\hat{I}_{\\text{std}})}$ 的精确值。", "solution": "令 $X\\sim \\text{Uniform}(0,1)$ 且 $f(x)=(1+x)^{2}=1+2x+x^{2}$。具有 $N$ 个独立同分布样本的标准蒙特卡洛估计量的方差为\n$$\n\\text{Var}(\\hat{I}_{\\text{std}})=\\frac{\\text{Var}(f(X))}{N}.\n$$\n通过计算 $E[f(X)]$ 和 $E[f(X)^{2}]$ 来计算 $\\text{Var}(f(X))$。使用 $E[X]=\\frac{1}{2}$，$E[X^{2}]=\\frac{1}{3}$，$E[X^{3}]=\\frac{1}{4}$，$E[X^{4}]=\\frac{1}{5}$，\n$$\nE[f(X)]=E[1+2X+X^{2}]=1+2\\cdot \\frac{1}{2}+\\frac{1}{3}=\\frac{7}{3},\n$$\n且\n$$\nf(X)^{2}=(1+2X+X^{2})^{2}=1+4X+6X^{2}+4X^{3}+X^{4},\n$$\n所以\n$$\nE[f(X)^{2}]=1+4\\cdot \\frac{1}{2}+6\\cdot \\frac{1}{3}+4\\cdot \\frac{1}{4}+\\frac{1}{5}=\\frac{31}{5}.\n$$\n因此\n$$\n\\text{Var}(f(X))=E[f(X)^{2}]-\\left(E[f(X)]\\right)^{2}=\\frac{31}{5}-\\frac{49}{9}=\\frac{34}{45}.\n$$\n\n对于对偶估计量，定义 $M=\\frac{N}{2}$ 和 $Y=\\frac{f(U)+f(1-U)}{2}$，其中 $U\\sim \\text{Uniform}(0,1)$。那么\n$$\n\\text{Var}(\\hat{I}_{\\text{anti}})=\\frac{\\text{Var}(Y)}{M}.\n$$\n使用\n$$\n\\text{Var}(Y)=\\frac{1}{4}\\text{Var}\\big(f(U)+f(1-U)\\big)=\\frac{1}{4}\\left(2\\,\\text{Var}(f(X))+2\\,\\text{Cov}(f(U),f(1-U))\\right)\n=\\frac{1}{2}\\left(\\text{Var}(f(X))+\\text{Cov}(f(U),f(1-U))\\right).\n$$\n因此方差比为\n$$\nR=\\frac{\\text{Var}(\\hat{I}_{\\text{anti}})}{\\text{Var}(\\hat{I}_{\\text{std}})}\n=\\frac{\\frac{\\text{Var}(Y)}{M}}{\\frac{\\text{Var}(f(X))}{N}}\n=\\frac{\\text{Var}(Y)}{\\text{Var}(f(X))}\\cdot \\frac{N}{M}\n=\\frac{\\frac{1}{2}\\left(\\text{Var}(f(X))+\\text{Cov}(f(U),f(1-U))\\right)}{\\text{Var}(f(X))}\\cdot 2\n=1+\\frac{\\text{Cov}(f(U),f(1-U))}{\\text{Var}(f(X))}.\n$$\n\n剩下需要计算的是 $\\text{Cov}(f(U),f(1-U))$。由于 $f(1-U)=(2-U)^{2}=4-4U+U^{2}$，\n$$\nf(U)f(1-U)=(1+2U+U^{2})(4-4U+U^{2})=4+4U-3U^{2}-2U^{3}+U^{4}.\n$$\n因此\n$$\nE[f(U)f(1-U)]=4+4\\cdot \\frac{1}{2}-3\\cdot \\frac{1}{3}-2\\cdot \\frac{1}{4}+\\frac{1}{5}=\\frac{47}{10},\n$$\n且已知 $E[f(U)]=\\frac{7}{3}$，\n$$\n\\text{Cov}(f(U),f(1-U))=E[f(U)f(1-U)]-\\left(E[f(U)]\\right)^{2}=\\frac{47}{10}-\\frac{49}{9}=-\\frac{67}{90}.\n$$\n因此，\n$$\nR=1+\\frac{-\\frac{67}{90}}{\\frac{34}{45}}=1-\\frac{67}{90}\\cdot \\frac{45}{34}=1-\\frac{67}{68}=\\frac{1}{68}.\n$$\n因此，对于此函数 $f$，对偶变量估计量实现的方差是标准蒙特卡洛估计量方差的 $\\frac{1}{68}$。", "answer": "$$\\boxed{\\frac{1}{68}}$$", "id": "2188199"}, {"introduction": "对偶变量法的有效性并非放之四海而皆准，它与被积函数的性质密切相关。本练习通过研究一个振荡函数来探讨这种依赖关系，揭示该方法的性能如何根据函数的对称性，从实现完美的方差缩减到反而增加方差。[@problem_id:3285865]", "problem": "考虑使用对偶变量 (AV) 蒙特卡洛 (MC) 方法，为一个固定的正整数 $k$ 估计积分 $I(k) = \\int_{0}^{1} \\sin(k \\pi x) \\, dx$。设 $\\{U_i\\}_{i=1}^{n}$ 是从 $\\mathrm{Uniform}(0,1)$ 分布中抽取的独立同分布样本，其中 $n$ 为偶数。定义原始蒙特卡洛估计量为 $\\widehat{I}_{\\mathrm{MC}} = \\frac{1}{n} \\sum_{i=1}^{n} f(U_i)$，其中 $f(x) = \\sin(k \\pi x)$。通过将样本配对定义对偶估计量，即 $Y_i = \\frac{f(U_i) + f(1 - U_i)}{2}$（对于 $i = 1, \\dots, n/2$），并设 $\\widehat{I}_{\\mathrm{AV}} = \\frac{1}{n/2} \\sum_{i=1}^{n/2} Y_i$。仅使用期望、方差和协方差的基本定义以及基本的三角恒等式，推导方差比\n$$\nR(k) = \\frac{\\mathrm{Var}(\\widehat{I}_{\\mathrm{AV}})}{\\mathrm{Var}(\\widehat{I}_{\\mathrm{MC}})}\n$$\n的精确封闭形式表达式（仅用 $k$ 表示）。\n将您的最终结果表示为关于 $k$ 的单个简化解析表达式。不需要进行数值四舍五入。", "solution": "目标是计算比率 $R(k) = \\frac{\\mathrm{Var}(\\widehat{I}_{\\mathrm{AV}})}{\\mathrm{Var}(\\widehat{I}_{\\mathrm{MC}})}$。我们首先表达这两个估计量的方差。\n\n设 $U$ 是一个服从 $\\mathrm{Uniform}(0,1)$ 分布的随机变量。随机变量 $f(U_i)$ 是独立同分布的，具有共同的方差 $\\mathrm{Var}(f(U))$。\n原始蒙特卡洛估计量的方差为：\n$$\n\\mathrm{Var}(\\widehat{I}_{\\mathrm{MC}}) = \\mathrm{Var}\\left(\\frac{1}{n} \\sum_{i=1}^{n} f(U_i)\\right) = \\frac{1}{n^2} \\sum_{i=1}^{n} \\mathrm{Var}(f(U_i)) = \\frac{n}{n^2} \\mathrm{Var}(f(U)) = \\frac{1}{n} \\mathrm{Var}(f(U)).\n$$\n对偶估计量是 $n/2$ 个独立同分布随机变量 $Y_i = \\frac{f(U_i) + f(1 - U_i)}{2}$ 的平均值。设 $Y$ 是一个代表任何一个 $Y_i$ 的随机变量。\n对偶变量估计量的方差为：\n$$\n\\mathrm{Var}(\\widehat{I}_{\\mathrm{AV}}) = \\mathrm{Var}\\left(\\frac{1}{n/2} \\sum_{i=1}^{n/2} Y_i\\right) = \\frac{1}{(n/2)^2} \\sum_{i=1}^{n/2} \\mathrm{Var}(Y_i) = \\frac{n/2}{(n/2)^2} \\mathrm{Var}(Y) = \\frac{2}{n} \\mathrm{Var}(Y).\n$$\n$Y$ 的方差是：\n$$\n\\mathrm{Var}(Y) = \\mathrm{Var}\\left(\\frac{f(U) + f(1-U)}{2}\\right) = \\frac{1}{4} \\mathrm{Var}(f(U) + f(1-U)).\n$$\n使用两个随机变量和的方差公式 $\\mathrm{Var}(A+B) = \\mathrm{Var}(A) + \\mathrm{Var}(B) + 2\\mathrm{Cov}(A,B)$，我们得到：\n$$\n\\mathrm{Var}(Y) = \\frac{1}{4} \\left( \\mathrm{Var}(f(U)) + \\mathrm{Var}(f(1-U)) + 2\\mathrm{Cov}(f(U), f(1-U)) \\right).\n$$\n由于 $U \\sim \\mathrm{Uniform}(0,1)$，随机变量 $V = 1-U$ 也服从 $\\mathrm{Uniform}(0,1)$ 分布。因此，$\\mathrm{Var}(f(1-U)) = \\mathrm{Var}(f(V)) = \\mathrm{Var}(f(U))$。\n将其代回，我们有：\n$$\n\\mathrm{Var}(Y) = \\frac{1}{4} \\left( 2\\mathrm{Var}(f(U)) + 2\\mathrm{Cov}(f(U), f(1-U)) \\right) = \\frac{1}{2} \\left( \\mathrm{Var}(f(U)) + \\mathrm{Cov}(f(U), f(1-U)) \\right).\n$$\n因此，对偶估计量的方差为：\n$$\n\\mathrm{Var}(\\widehat{I}_{\\mathrm{AV}}) = \\frac{2}{n} \\mathrm{Var}(Y) = \\frac{1}{n} \\left( \\mathrm{Var}(f(U)) + \\mathrm{Cov}(f(U), f(1-U)) \\right).\n$$\n现在我们可以写出方差比 $R(k)$：\n$$\nR(k) = \\frac{\\mathrm{Var}(\\widehat{I}_{\\mathrm{AV}})}{\\mathrm{Var}(\\widehat{I}_{\\mathrm{MC}})} = \\frac{\\frac{1}{n} \\left( \\mathrm{Var}(f(U)) + \\mathrm{Cov}(f(U), f(1-U)) \\right)}{\\frac{1}{n} \\mathrm{Var}(f(U))} = 1 + \\frac{\\mathrm{Cov}(f(U), f(1-U))}{\\mathrm{Var}(f(U))}.\n$$\n为了计算这个比率，我们必须分析协方差项。此分析的核心在于函数 $f(x) = \\sin(k \\pi x)$ 的对称性质。让我们计算 $f(1-x)$：\n$$\nf(1-x) = \\sin(k \\pi (1-x)) = \\sin(k \\pi - k \\pi x).\n$$\n使用三角恒等式 $\\sin(A-B) = \\sin(A)\\cos(B) - \\cos(A)\\sin(B)$：\n$$\nf(1-x) = \\sin(k \\pi)\\cos(k \\pi x) - \\cos(k \\pi)\\sin(k \\pi x).\n$$\n因为 $k$ 是整数，所以 $\\sin(k \\pi) = 0$ 且 $\\cos(k \\pi) = (-1)^k$。该表达式简化为：\n$$\nf(1-x) = 0 - (-1)^k \\sin(k \\pi x) = -(-1)^k f(x).\n$$\n这个关系至关重要。它意味着随机变量 $f(1-U)$ 和 $f(U)$ 通过 $f(1-U) = -(-1)^k f(U)$ 相关联。\n\n我们现在可以分析协方差 $\\mathrm{Cov}(f(U), f(1-U))$：\n$$\n\\mathrm{Cov}(f(U), f(1-U)) = \\mathrm{Cov}(f(U), -(-1)^k f(U)).\n$$\n使用性质 $\\mathrm{Cov}(X, cY) = c\\mathrm{Cov}(X, Y)$，其中 $c = -(-1)^k$：\n$$\n\\mathrm{Cov}(f(U), f(1-U)) = -(-1)^k \\mathrm{Cov}(f(U), f(U)) = -(-1)^k \\mathrm{Var}(f(U)).\n$$\n我们现在可以直接将此结果代入比率 $R(k)$ 的表达式中：\n$$\nR(k) = 1 + \\frac{-(-1)^k \\mathrm{Var}(f(U))}{\\mathrm{Var}(f(U))}.\n$$\n只要 $\\mathrm{Var}(f(U)) \\neq 0$，我们就可以消去方差项。方差 $\\mathrm{Var}(f(U)) = \\mathrm{Var}(\\sin(k\\pi U))$ 仅在 $\\sin(k\\pi U)$ 是常数时为零，而对于正整数 $k$ 来说情况并非如此。因此，消去是有效的。\n$$\nR(k) = 1 - (-1)^k.\n$$\n这个单一的表达式优雅地捕捉了 $k$ 为偶数和奇数时的行为。\n\n为了完整起见，我们可以详细说明这两种情况：\n1.  如果 $k$ 是一个偶数，即 $k = 2m$（对于某个整数 $m \\ge 1$）。那么 $(-1)^k = 1$。比率为 $R(k) = 1 - 1 = 0$。这是因为当 $k$ 为偶数时，$f(1-x) = -f(x)$，意味着函数关于点 $x=1/2$ 是奇对称的。对偶配对的平均值为 $Y_i = \\frac{f(U_i) + f(1-U_i)}{2} = \\frac{f(U_i) - f(U_i)}{2} = 0$。估计量 $\\widehat{I}_{\\mathrm{AV}}$ 恒等于零，因此其方差为零。这对应于完美的方差缩减。\n\n2.  如果 $k$ 是一个奇数，即 $k = 2m-1$（对于某个整数 $m \\ge 1$）。那么 $(-1)^k = -1$。比率为 $R(k) = 1 - (-1) = 2$。这是因为当 $k$ 为奇数时，$f(1-x) = -(-1)f(x) = f(x)$，意味着函数关于点 $x=1/2$ 是偶对称的。对偶配对的平均值为 $Y_i = \\frac{f(U_i) + f(1-U_i)}{2} = \\frac{f(U_i) + f(U_i)}{2} = f(U_i)$。估计量变为 $\\widehat{I}_{\\mathrm{AV}} = \\frac{1}{n/2} \\sum_{i=1}^{n/2} f(U_i)$。其方差为 $\\mathrm{Var}(\\widehat{I}_{\\mathrm{AV}}) = \\frac{1}{n/2}\\mathrm{Var}(f(U)) = \\frac{2}{n}\\mathrm{Var}(f(U))$。比率变为 $\\frac{2/n \\cdot \\mathrm{Var}(f(U))}{1/n \\cdot \\mathrm{Var}(f(U))} = 2$。在这种情况下，与使用相同函数求值次数（$n$ 次）的原始蒙特卡洛估计量相比，对偶抽样技术实际上使方差增加了一倍。", "answer": "$$\n\\boxed{1 - (-1)^k}\n$$", "id": "3285865"}, {"introduction": "在实际应用中，为特定任务选择合适的工具至关重要。这个进阶问题将对偶变量法置于一个比较的背景中，要求你在固定的计算成本下，将其效率与另一种强大的技术——控制变量法——进行比较。这种练习旨在培养一种更深刻、更实用的理解，即如何选择最优的方差缩减策略。[@problem_id:3253427]", "problem": "考虑积分 $I=\\int_{0}^{1} e^{x}\\,dx$。你将使用蒙特卡洛（MC）积分来近似 $I$，样本 $U\\sim \\mathrm{Uniform}(0,1)$，使得 $f(U)=e^{U}$ 并且 $\\mathbb{E}[f(U)]=I$。为了在 $2n$ 次 $f(x)$ 求值的固定计算预算下进行公平比较，考虑以下三种蒙特卡洛估计量：\n\n- 原始蒙特卡洛（Crude MC）：使用 $2n$ 个独立样本 $U_{1},\\dots,U_{2n}$ 以及 $f(U_{i})$ 的样本均值。\n- 对偶变量（Antithetic variates）：使用 $n$ 次独立抽样 $U_{1},\\dots,U_{n}$，构造 $A_{i}=\\tfrac{1}{2}\\big(f(U_{i})+f(1-U_{i})\\big)$，并对 $A_{i}$求平均。\n- 控制变量（Control variates）：取 $g(x)=x$，其已知均值为 $\\int_{0}^{1} x\\,dx=\\tfrac{1}{2}$。使用 $2n$ 个独立样本 $U_{1},\\dots,U_{2n}$，构造具有最优选择系数 $\\beta$ 的控制变量估计量（不要假设 $\\beta$ 的公式；从第一性原理确定它）。\n\n仅使用期望、方差、协方差和独立性的定义（以及必要积分的基本微积分），推导这三种估计量作为 $n$ 的函数的精确方差，然后在 $2n$ 次 $f$ 求值的同等成本预算下，比较对偶变量与最优控制变量。下面哪个选项正确描述了它们在相同成本下相对于原始蒙特卡洛的相对方差减少情况？\n\nA. 在同等成本下，对偶变量相对于原始蒙特卡洛实现了约 $R_{\\mathrm{AV}}\\approx 0.0323$ 的方差比，而使用 $g(x)=x$ 的最优控制变量实现了约 $R_{\\mathrm{CV}}\\approx 0.0163$ 的方差比；因此控制变量减少的方差更多。\n\nB. 在同等成本下，对偶变量实现了约 $R_{\\mathrm{AV}}\\approx 0.0163$ 的方差比，而使用 $g(x)=x$ 的最优控制变量实现了约 $R_{\\mathrm{CV}}\\approx 0.0323$ 的方差比；因此对偶变量减少的方差更多。\n\nC. 在同等成本下，对偶变量和控制变量产生的方差减少完全相同，为 $R_{\\mathrm{AV}}=R_{\\mathrm{CV}}\\approx 0.0240$。\n\nD. 在同等成本下，两种方法相对于原始蒙特卡洛都没有减少方差，即 $R_{\\mathrm{AV}}\\geq 1$ 和 $R_{\\mathrm{CV}}\\geq 1$。", "solution": "问题是比较对偶变量和控制变量在蒙特卡洛近似积分 $I=\\int_{0}^{1} e^{x}\\,dx$ 时的方差减少情况。比较必须在函数 $f(x)=e^x$ 的 $2n$ 次求值的同等计算预算下进行。设 $U$ 是一个服从 $\\mathrm{Uniform}(0,1)$ 分布的随机变量。\n\n首先，我们计算必要的矩和协方差。\n积分的真实值是 $I = \\mathbb{E}[f(U)] = \\int_{0}^{1} e^x \\,dx = [e^x]_0^1 = e^1 - e^0 = e - 1$。\n\n$f(U) = e^U$ 的方差需要二阶矩：\n$\\mathbb{E}[f(U)^2] = \\mathbb{E}[e^{2U}] = \\int_{0}^{1} e^{2x} \\,dx = \\left[\\frac{1}{2} e^{2x}\\right]_0^1 = \\frac{1}{2}(e^2 - 1)$。\n$f(U)$ 的方差记为 $\\sigma_f^2$：\n$\\sigma_f^2 = \\mathrm{Var}(f(U)) = \\mathbb{E}[f(U)^2] - (\\mathbb{E}[f(U)])^2 = \\frac{1}{2}(e^2 - 1) - (e - 1)^2$\n$\\sigma_f^2 = \\frac{1}{2}e^2 - \\frac{1}{2} - (e^2 - 2e + 1) = -\\frac{1}{2}e^2 + 2e - \\frac{3}{2}$。\n\n对于控制变量估计量，我们使用 $g(x)=x$。\n$g(U) = U$ 的均值是 $\\mu_g = \\mathbb{E}[U] = \\int_{0}^{1} x \\,dx = \\frac{1}{2}$。\n$g(U)$ 的方差，记为 $\\sigma_g^2$，需要 $\\mathbb{E}[U^2] = \\int_{0}^{1} x^2 \\,dx = \\frac{1}{3}$。\n$\\sigma_g^2 = \\mathrm{Var}(U) = \\mathbb{E}[U^2] - (\\mathbb{E}[U])^2 = \\frac{1}{3} - \\left(\\frac{1}{2}\\right)^2 = \\frac{1}{3} - \\frac{1}{4} = \\frac{1}{12}$。\n\n$f(U)$ 和 $g(U)$ 之间的协方差是 $\\sigma_{fg} = \\mathrm{Cov}(f(U), g(U)) = \\mathbb{E}[f(U)g(U)] - \\mathbb{E}[f(U)]\\mathbb{E}[g(U)]$。\n$\\mathbb{E}[f(U)g(U)] = \\mathbb{E}[Ue^U] = \\int_{0}^{1} xe^x \\,dx$。\n使用分部积分法（$\\int u dv = uv - \\int v du$，其中 $u=x, dv=e^x dx$）：\n$\\int_{0}^{1} xe^x \\,dx = [xe^x]_0^1 - \\int_{0}^{1} e^x \\,dx = (1 \\cdot e^1 - 0) - [e^x]_0^1 = e - (e-1) = 1$。\n所以，$\\sigma_{fg} = 1 - (e-1)\\left(\\frac{1}{2}\\right) = 1 - \\frac{e}{2} + \\frac{1}{2} = \\frac{3-e}{2}$。\n\n现在我们分析这三种估计量。\n\n1.  **原始蒙特卡洛估计量**\n    该估计量使用 $2n$ 个样本：$\\hat{I}_{\\mathrm{Crude}} = \\frac{1}{2n} \\sum_{i=1}^{2n} e^{U_i}$。\n    由于样本 $U_i$ 是独立同分布的（i.i.d.），方差为：\n    $\\mathrm{Var}(\\hat{I}_{\\mathrm{Crude}}) = \\frac{1}{(2n)^2} \\sum_{i=1}^{2n} \\mathrm{Var}(e^{U_i}) = \\frac{2n}{(2n)^2} \\sigma_f^2 = \\frac{1}{2n} \\sigma_f^2$。\n    $\\mathrm{Var}(\\hat{I}_{\\mathrm{Crude}}) = \\frac{1}{2n} \\left(-\\frac{1}{2}e^2 + 2e - \\frac{3}{2}\\right)$。这是我们的基准方差。\n\n2.  **对偶变量（AV）估计量**\n    该估计量使用 $n$ 对样本 $(U_i, 1-U_i)$。总成本是 $2n$ 次 $f(x)$ 求值。\n    $\\hat{I}_{\\mathrm{AV}} = \\frac{1}{n} \\sum_{i=1}^{n} A_i$，其中 $A_i = \\frac{1}{2}(e^{U_i} + e^{1-U_i})$。\n    由于 $U_i$ 是独立同分布的，项 $A_i$ 也是独立同分布的。方差为：\n    $\\mathrm{Var}(\\hat{I}_{\\mathrm{AV}}) = \\frac{1}{n} \\mathrm{Var}(A_1) = \\frac{1}{n} \\mathrm{Var}\\left(\\frac{1}{2}(e^U + e^{1-U})\\right) = \\frac{1}{4n} \\mathrm{Var}(e^U + e^{1-U})$。\n    $\\mathrm{Var}(e^U + e^{1-U}) = \\mathrm{Var}(e^U) + \\mathrm{Var}(e^{1-U}) + 2\\mathrm{Cov}(e^U, e^{1-U})$。\n    由于 $1-U \\sim \\mathrm{Uniform}(0,1)$，$\\mathrm{Var}(e^{1-U}) = \\mathrm{Var}(e^U) = \\sigma_f^2$。\n    协方差是 $\\mathrm{Cov}(e^U, e^{1-U}) = \\mathbb{E}[e^U e^{1-U}] - \\mathbb{E}[e^U]\\mathbb{E}[e^{1-U}]$。\n    $\\mathbb{E}[e^U e^{1-U}] = \\mathbb{E}[e^{U+1-U}] = \\mathbb{E}[e] = e$。\n    $\\mathbb{E}[e^{1-U}] = \\mathbb{E}[e^U] = e-1$。\n    $\\mathrm{Cov}(e^U, e^{1-U}) = e - (e-1)^2 = e - (e^2-2e+1) = -e^2+3e-1$。\n    $\\mathrm{Var}(\\hat{I}_{\\mathrm{AV}}) = \\frac{1}{4n} (2\\sigma_f^2 + 2\\mathrm{Cov}(e^U, e^{1-U})) = \\frac{1}{2n}(\\sigma_f^2 + \\mathrm{Cov}(e^U, e^{1-U}))$。\n    代入 $\\sigma_f^2$ 和协方差的表达式：\n    $\\mathrm{Var}(\\hat{I}_{\\mathrm{AV}}) = \\frac{1}{2n} \\left( \\left(-\\frac{1}{2}e^2 + 2e - \\frac{3}{2}\\right) + (-e^2+3e-1) \\right) = \\frac{1}{2n} \\left(-\\frac{3}{2}e^2 + 5e - \\frac{5}{2}\\right)$。\n\n    方差比 $R_{\\mathrm{AV}}$ 是：\n    $R_{\\mathrm{AV}} = \\frac{\\mathrm{Var}(\\hat{I}_{\\mathrm{AV}})}{\\mathrm{Var}(\\hat{I}_{\\mathrm{Crude}})} = \\frac{\\frac{1}{2n} (-\\frac{3}{2}e^2 + 5e - \\frac{5}{2})}{\\frac{1}{2n} (-\\frac{1}{2}e^2 + 2e - \\frac{3}{2})} = \\frac{-3e^2+10e-5}{-e^2+4e-3}$。\n    使用 $e \\approx 2.71828$：\n    $R_{\\mathrm{AV}} \\approx \\frac{-3(7.389056) + 10(2.71828) - 5}{-7.389056 + 4(2.71828) - 3} = \\frac{0.015632}{0.484064} \\approx 0.03229$。因此，$R_{\\mathrm{AV}} \\approx 0.0323$。\n\n3.  **控制变量（CV）估计量**\n    该估计量使用 $2n$ 个样本：$\\hat{I}_{\\mathrm{CV}}(\\beta) = \\frac{1}{2n}\\sum_{i=1}^{2n} (f(U_i) - \\beta(g(U_i) - \\mu_g))$。\n    通过最小化单个项的方差来找到最优的 $\\beta$。\n    $\\mathrm{Var}(f(U) - \\beta(g(U)-\\mu_g)) = \\mathrm{Var}(f(U) - \\beta g(U)) = \\mathrm{Var}(f(U)) - 2\\beta\\mathrm{Cov}(f(U), g(U)) + \\beta^2\\mathrm{Var}(g(U))$。\n    这是 $\\sigma_f^2 - 2\\beta\\sigma_{fg} + \\beta^2\\sigma_g^2$。为了找到最小值，我们对 $\\beta$ 求导并令其等于 0：\n    $-2\\sigma_{fg} + 2\\beta\\sigma_g^2 = 0 \\implies \\beta^* = \\frac{\\sigma_{fg}}{\\sigma_g^2}$。\n    最小方差是 $\\sigma_f^2 - 2\\frac{\\sigma_{fg}}{\\sigma_g^2}\\sigma_{fg} + (\\frac{\\sigma_{fg}}{\\sigma_g^2})^2\\sigma_g^2 = \\sigma_f^2 - \\frac{\\sigma_{fg}^2}{\\sigma_g^2}$。\n    估计量的方差是 $\\mathrm{Var}(\\hat{I}_{\\mathrm{CV}}) = \\frac{1}{2n} \\left( \\sigma_f^2 - \\frac{\\sigma_{fg}^2}{\\sigma_g^2} \\right)$。\n    代入表达式：\n    $\\frac{\\sigma_{fg}^2}{\\sigma_g^2} = \\frac{((3-e)/2)^2}{1/12} = 12 \\frac{(3-e)^2}{4} = 3(9-6e+e^2) = 27-18e+3e^2$。\n    $\\mathrm{Var}(\\hat{I}_{\\mathrm{CV}}) = \\frac{1}{2n} \\left( (-\\frac{1}{2}e^2 + 2e - \\frac{3}{2}) - (27-18e+3e^2) \\right)$\n    $\\mathrm{Var}(\\hat{I}_{\\mathrm{CV}}) = \\frac{1}{2n} \\left(-\\frac{7}{2}e^2 + 20e - \\frac{57}{2}\\right)$。\n\n    方差比 $R_{\\mathrm{CV}}$ 是：\n    $R_{\\mathrm{CV}} = \\frac{\\mathrm{Var}(\\hat{I}_{\\mathrm{CV}})}{\\mathrm{Var}(\\hat{I}_{\\mathrm{Crude}})} = \\frac{\\sigma_f^2 - \\sigma_{fg}^2/\\sigma_g^2}{\\sigma_f^2} = \\frac{-\\frac{7}{2}e^2+20e-\\frac{57}{2}}{-\\frac{1}{2}e^2+2e-\\frac{3}{2}} = \\frac{-7e^2+40e-57}{-e^2+4e-3}$。\n    使用 $e \\approx 2.71828$：\n    $R_{\\mathrm{CV}} \\approx \\frac{-7(7.389056) + 40(2.71828) - 57}{0.484064} = \\frac{0.007888}{0.484064} \\approx 0.016295$。因此，$R_{\\mathrm{CV}} \\approx 0.0163$。\n\n比较和选项评估：\n我们已经推导出 $R_{\\mathrm{AV}} \\approx 0.0323$ 和 $R_{\\mathrm{CV}} \\approx 0.0163$。\n更小的方差比表示更大的方差减少。因为 $0.0163  0.0323$，所以控制变量方法对于这个问题更有效。\n\nA. 在同等成本下，对偶变量相对于原始蒙特卡洛实现了约 $R_{\\mathrm{AV}}\\approx 0.0323$ 的方差比，而使用 $g(x)=x$ 的最优控制变量实现了约 $R_{\\mathrm{CV}}\\approx 0.0163$ 的方差比；因此控制变量减少的方差更多。\n这个选项与我们推导出的值和结论相符。**正确**。\n\nB. 在同等成本下，对偶变量实现了约 $R_{\\mathrm{AV}}\\approx 0.0163$ 的方差比，而使用 $g(x)=x$ 的最优控制变量实现了约 $R_{\\mathrm{CV}}\\approx 0.0323$ 的方差比；因此对偶变量减少的方差更多。\n这个选项交换了两种方法的数值。**不正确**。\n\nC. 在同等成本下，对偶变量和控制变量产生的方差减少完全相同，为 $R_{\\mathrm{AV}}=R_{\\mathrm{CV}}\\approx 0.0240$。\n我们的计算表明方差比不相等。**不正确**。\n\nD. 在同等成本下，两种方法相对于原始蒙特卡洛都没有减少方差，即 $R_{\\mathrm{AV}}\\geq 1$ 和 $R_{\\mathrm{CV}}\\geq 1$。\n两个计算出的比率都显著小于 1，表明方差有显著减少。对于对偶变量，方差减少是因为 $f(x)=e^x$ 是单调的，导致负相关。对于控制变量，方差减少是因为 $f(x)=e^x$ 和 $g(x)=x$ 是正相关的。**不正确**。", "answer": "$$\\boxed{A}$$", "id": "3253427"}]}