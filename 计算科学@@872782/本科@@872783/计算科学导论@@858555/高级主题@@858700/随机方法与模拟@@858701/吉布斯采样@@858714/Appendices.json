{"hands_on_practices": [{"introduction": "任何吉布斯采样器的核心都在于其全条件分布。本练习将让你掌握从一个给定的联合概率分布中推导出这些“构建模块”的基本技能。在许多实际应用中，我们只知道联合分布的形式，但并不知道其归一化常数，这使得直接采样变得不可能。这个练习 [@problem_id:1338680] 将展示如何绕过难以处理的归一化常数，直接提取出吉布斯采样算法所需的核心条件概率。", "problem": "考虑两个相互作用的二元随机变量 $X$ 和 $Y$，它们各自可以取值为 0 或 1。它们的联合概率质量函数由一个未归一化的关系 $P(X=x, Y=y) \\propto f(x, y)$ 指定，其中函数 $f(x, y)$ 定义于 $x, y \\in \\{0, 1\\}$。这种类型的分布在统计力学和机器学习等领域中，对于建模相互作用的系统是基础性的。\n\n对于一个特定系统，其相互作用由以下函数描述：\n$$f(x, y) = \\exp(5xy - 2x - y)$$\n因此，联合概率由下式给出：\n$$P(X=x, Y=y) \\propto \\exp(5xy - 2x - y)$$\n\n你的任务是确定在给定变量 $Y$ 的状态下，变量 $X$ 取值为 1 的条件概率。推导 $P(X=1 | Y=y)$ 作为 $y$ 的函数的符号表达式。", "solution": "我们给定的联合分布在归一化之前指定为 $P(X=x, Y=y) \\propto f(x,y)$，其中 $f(x,y) = \\exp(5xy - 2x - y)$。对于离散随机变量，条件概率由下式给出：\n$$\nP(X=1 \\mid Y=y) = \\frac{P(X=1, Y=y)}{\\sum_{x \\in \\{0,1\\}} P(X=x, Y=y)}.\n$$\n因为 $P$ 与 $f$ 成正比，公共的比例常数在比率中被消掉，所以我们可以直接使用 $f$ 进行计算：\n$$\nP(X=1 \\mid Y=y) = \\frac{f(1,y)}{f(0,y) + f(1,y)}.\n$$\n计算所需的项：\n$$\nf(1,y) = \\exp(5 \\cdot 1 \\cdot y - 2 \\cdot 1 - y) = \\exp(4y - 2),\n$$\n$$\nf(0,y) = \\exp(5 \\cdot 0 \\cdot y - 2 \\cdot 0 - y) = \\exp(-y).\n$$\n因此，\n$$\nP(X=1 \\mid Y=y) = \\frac{\\exp(4y - 2)}{\\exp(-y) + \\exp(4y - 2)}.\n$$\n将分子和分母同除以 $\\exp(4y - 2)$ 以简化：\n$$\nP(X=1 \\mid Y=y) = \\frac{1}{1 + \\exp\\big((-y) - (4y - 2)\\big)} = \\frac{1}{1 + \\exp(2 - 5y)}.\n$$\n这就得到了作为 $y$ 的函数的所需符号表达式。", "answer": "$$\\boxed{\\frac{1}{1 + \\exp(2 - 5y)}}$$", "id": "1338680"}, {"introduction": "掌握了如何推导条件分布之后，下一步自然就是观察它们的实际运作。这个练习 [@problem_id:1338677] 模拟了吉布斯采样序列中的第一个更新步骤。通过一个给定的初始状态和已知的条件分布，你将计算采样器移动到某个新状态区间的概率，从而将抽象的迭代过程变得具体而直观。", "problem": "一个二维随机变量 $(X, Y)$ 由其条件分布来刻画。给定 $Y=y$ 时 $X$ 的条件分布是在区间 $[0, y]$ 上的连续均匀分布。给定 $X=x$ 时 $Y$ 的条件分布是均值为 $x$ 的泊松分布。\n\n使用基于吉布斯采样器的马尔可夫链蒙特卡洛 (MCMC) 模拟从 $(X, Y)$ 的联合分布中生成样本。生成样本序列 $(X^{(t)}, Y^{(t)})$ （其中 $t = 0, 1, 2, \\dots$）的迭代过程定义如下：\n1.  从给定 $Y=Y^{(t)}$ 时 $X$ 的条件分布中采样 $X^{(t+1)}$。\n2.  从给定 $X=X^{(t+1)}$ 时 $Y$ 的条件分布中采样 $Y^{(t+1)}$。\n\n该过程从初始状态 $(X^{(0)}, Y^{(0)}) = (4, 4)$ 开始。\n\n计算概率 $P(1  X^{(1)}  2.5)$。请用精确分数表示你的答案。", "solution": "给定条件分布如下：\n- 对于任意 $y0$，$X \\mid Y=y \\sim \\text{Uniform}(0,y)$，因此条件密度为\n$$\nf_{X\\mid Y}(x \\mid y) = \\begin{cases}\n\\frac{1}{y},  0 \\leq x \\leq y, \\\\\n0,  \\text{其它情况}。\n\\end{cases}\n$$\n- 对于任意 $x \\geq 0$，$Y \\mid X=x \\sim \\text{Poisson}(x)$。\n\n在吉布斯采样器中，步骤1从给定 $Y=Y^{(0)}$ 时 $X$ 的条件分布中更新 $X^{(1)}$。由于该过程从 $(X^{(0)}, Y^{(0)})=(4,4)$ 开始，我们有\n$$\nX^{(1)} \\mid Y^{(0)}=4 \\sim \\text{Uniform}(0,4),\n$$\n因此其条件密度为 $f_{X^{(1)} \\mid Y^{(0)}}(x \\mid 4) = \\frac{1}{4}$（当 $0 \\leq x \\leq 4$ 时），其它情况为 $0$。\n\n因此，\n$$P(1  X^{(1)}  \\frac{5}{2}) = \\int_{1}^{5/2} \\frac{1}{4} \\, dx = \\frac{1}{4}\\left(\\frac{5}{2} - 1\\right) = \\frac{1}{4} \\cdot \\frac{3}{2} = \\frac{3}{8}.$$\n因为在此设置中 $Y^{(0)}=4$ 是确定性的，所以这个条件概率等于无条件概率 $P(1  X^{(1)}  5/2)$。", "answer": "$$\\boxed{\\frac{3}{8}}$$", "id": "1338677"}, {"introduction": "一个强大算法的价值不仅在于它的能力，也在于我们对其局限性的理解。这个练习 [@problem_id:1338719] 提出了一个经典场景，其中吉布斯采样器由于变量间存在强相关性而无法有效工作。通过分析这个假设情景，你将深入理解何种分布结构特性会导致采样器“卡住”，从而无法探索整个目标空间。在实践中，理解这类失效模式对于正确应用MCMC方法至关重要。", "problem": "一个特殊化学反应器的监控系统追踪两个相关的温度读数，$X$ 和 $Y$。由于反应器设计带来的严格物理约束，这两个读数的联合概率密度函数 $p(x, y)$ 仅在由方程 $x + y = 10$ 定义的线段上非零，其中 $x$ 和 $y$ 均为非负值（即 $x \\ge 0$ 和 $y \\ge 0$）。在这条可及线段上，概率分布是均匀的。\n\n一位数据科学家决定使用吉布斯采样器来生成遵循此分布的合成数据点 $(X, Y)$。采样器在点 $(X_0, Y_0) = (4.5, 5.5)$ 处进行初始化。对于 $t = 1, 2, 3, \\dots$，从当前状态 $(X_{t-1}, Y_{t-1})$ 生成下一个状态 $(X_{t}, Y_{t})$ 的采样过程如下：\n1. 从条件分布 $p(x | Y=Y_{t-1})$ 中为第一个变量 $X_{t}$ 抽取一个新值。\n2. 从条件分布 $p(y | X=X_{t})$ 中为第二个变量 $Y_{t}$ 抽取一个新值。\n\n确定采样器在 100 次完整迭代后的状态 $(X_{100}, Y_{100})$。将你的答案表示为一对数。", "solution": "联合支撑集是线段 $S=\\{(x,y): x\\ge 0,\\ y\\ge 0,\\ x+y=10\\}$。由于 $p(x,y)$ 在这个一维集合上是均匀的，对于任何 $y\\in[0,10]$，条件分布 $p(x\\mid Y=y)$ 将其所有质量集中在满足 $x+y=10$ 的唯一 $x$ 上，即：\n$$\np(x\\mid Y=y)=\\delta\\!\\left(x-(10-y)\\right),\n$$\n并且，类似地，对于任何 $x\\in[0,10]$，\n$$\np(y\\mid X=x)=\\delta\\!\\left(y-(10-x)\\right).\n$$\n因此，吉布斯更新是确定性的：\n$$X_{t}=10-Y_{t-1},\\qquad Y_{t}=10-X_{t}.$$\n从 $(X_{0},Y_{0})=(4.5,5.5)$ 开始，第一次迭代产生：\n$$X_{1}=10-5.5=4.5,\\qquad Y_{1}=10-4.5=5.5,$$\n所以状态保持不变。通过归纳法，如果 $(X_{t},Y_{t})=(4.5,5.5)$，那么\n$$X_{t+1}=10-5.5=4.5,\\qquad Y_{t+1}=10-4.5=5.5,$$\n因此，对于所有的 $t$，链都保持在 $(4.5,5.5)$ 固定不变。特别地，\n$$(X_{100},Y_{100})=(4.5,5.5).$$", "answer": "$$\\boxed{\\begin{pmatrix} 4.5  5.5 \\end{pmatrix}}$$", "id": "1338719"}]}