{"hands_on_practices": [{"introduction": "掌握矩阵范数的第一步是能够根据其基本定义进行计算。本练习 [@problem_id:3158838] 将引导你从计算基本的 $1$-范数和 $\\infty$-范数入手，进而探索分块矩阵的范数界限。理解如何通过子块的性质来分析整个矩阵，是处理大规模计算问题的一项核心技能。", "problem": "考虑分块矩阵 $A \\in \\mathbb{R}^{4 \\times 4}$，它被划分为 $2 \\times 2$ 的块，\n$$\nA \\;=\\; \\begin{pmatrix}\nB  C \\\\\nD  E\n\\end{pmatrix},\n\\quad\nB \\;=\\; \\begin{pmatrix} 1  -2 \\\\ 3  0 \\end{pmatrix},\\;\nC \\;=\\; \\begin{pmatrix} -1  4 \\\\ 2  -3 \\end{pmatrix},\\;\nD \\;=\\; \\begin{pmatrix} 0  5 \\\\ -4  1 \\end{pmatrix},\\;\nE \\;=\\; \\begin{pmatrix} 2  -1 \\\\ 0  3 \\end{pmatrix}.\n$$\n对于向量 $x \\in \\mathbb{R}^{n}$，向量 $1$-范数定义为 $\\|x\\|_{1} = \\sum_{i=1}^{n} |x_{i}|$，向量 $\\infty$-范数定义为 $\\|x\\|_{\\infty} = \\max_{1 \\leq i \\leq n} |x_{i}|$。对于矩阵 $A \\in \\mathbb{R}^{n \\times n}$ 和给定的向量范数 $\\|\\cdot\\|$，其诱导算子范数（也称从属范数）为\n$$\n\\|A\\| \\;=\\; \\sup_{x \\neq 0} \\frac{\\|A x\\|}{\\|x\\|}.\n$$\n任务：\n- 仅使用这些核心定义和三角不等式，推导能够精确计算 $\\|A\\|_{1}$ 和 $\\|A\\|_{\\infty}$ 的表达式，然后计算上面给定矩阵 $A$ 的数值。\n- 设 $x \\in \\mathbb{R}^{4}$ 根据 $A$ 的分块结构进行相应划分，为 $x = \\begin{pmatrix} x_{1} \\\\ x_{2} \\end{pmatrix}$，其中 $x_{1}, x_{2} \\in \\mathbb{R}^{2}$。从同样的核心定义和基本不等式出发，解释 $A$ 的分块结构如何根据块 $B, C, D, E$ 的诱导范数以及 $x_{1}, x_{2}$ 的范数，导出关于 $\\|A x\\|_{1}$ 和 $\\|A x\\|_{\\infty}$ 的诱导范数界。通过构建一个其元素为各块诱导范数的 $2 \\times 2$ 标量矩阵，并展示其诱导范数如何界定 $\\|A x\\|$，来说明你的解释。\n\n提供 $\\|A\\|_{1}$ 和 $\\|A\\|_{\\infty}$ 的精确值。无需四舍五入。", "solution": "问题陈述已经过验证，被认为是合理的。这是一个在计算科学入门中，特别是在矩阵代数和范数主题下的适定问题。所有定义都是标准的，要求的任务清晰且可在数学上形式化。\n\n完整的矩阵 $A \\in \\mathbb{R}^{4 \\times 4}$ 是通过组合其构成块来构建的：\n$$\nA \\;=\\; \\begin{pmatrix}\nB  C \\\\\nD  E\n\\end{pmatrix} \\;=\\; \\begin{pmatrix}\n1  -2  -1  4 \\\\\n3  0  2  -3 \\\\\n0  5  2  -1 \\\\\n-4  1  0  3\n\\end{pmatrix}.\n$$\n\n### 矩阵 $1$-范数 $\\|A\\|_{1}$ 的推导与计算\n\n诱导矩阵 $1$-范数定义为 $\\|A\\|_{1} = \\sup_{x \\neq 0} \\frac{\\|A x\\|_{1}}{\\|x\\|_{1}}$。令 $y = Ax$。$y$ 的第 $i$ 个分量是 $y_i = \\sum_{j=1}^{4} A_{ij} x_j$。\n$y=Ax$ 的向量 $1$-范数由 $\\|Ax\\|_{1} = \\sum_{i=1}^{4} |y_i| = \\sum_{i=1}^{4} \\left| \\sum_{j=1}^{4} A_{ij} x_j \\right|$ 给出。\n应用标量和的三角不等式 $|\\sum_j a_j| \\le \\sum_j |a_j|$，我们得到：\n$$\n\\|Ax\\|_{1} \\le \\sum_{i=1}^{4} \\sum_{j=1}^{4} |A_{ij} x_j| = \\sum_{i=1}^{4} \\sum_{j=1}^{4} |A_{ij}| |x_j|.\n$$\n通过改变求和顺序，我们可以按 $|x_j|$ 对各项进行分组：\n$$\n\\|Ax\\|_{1} \\le \\sum_{j=1}^{4} \\left( |x_j| \\sum_{i=1}^{4} |A_{ij}| \\right).\n$$\n设 $C_j = \\sum_{i=1}^{4} |A_{ij}|$ 为 $A$ 的第 $j$ 列元素绝对值之和。设 $C_{\\max} = \\max_{1 \\le j \\le 4} C_j$ 为最大绝对列和。我们可以用 $C_{\\max}$ 来界定每个 $C_j$：\n$$\n\\|Ax\\|_{1} \\le \\sum_{j=1}^{4} |x_j| C_j \\le \\sum_{j=1}^{4} |x_j| C_{\\max} = C_{\\max} \\sum_{j=1}^{4} |x_j| = C_{\\max} \\|x\\|_{1}.\n$$\n这意味着对于任何非零 $x$，有 $\\frac{\\|A x\\|_{1}}{\\|x\\|_{1}} \\le C_{\\max}$，因此 $\\|A\\|_{1} \\le C_{\\max}$。\n\n为了证明这个界是可以达到的，我们必须找到一个向量 $x$ 使得等式成立。设 $k$ 是具有最大绝对和的列的索引，使得 $C_k = C_{\\max}$。考虑标准基向量 $x = e_k$，其中 $(e_k)_j = \\delta_{kj}$。对于这个向量，$\\|x\\|_{1} = \\sum_{j=1}^{4} |(e_k)_j| = 1$。乘积 $Ax = Ae_k$ 是 $A$ 的第 $k$ 列。\n这个乘积的 $1$-范数是：\n$$\n\\|Ae_k\\|_{1} = \\sum_{i=1}^{4} |(Ae_k)_i| = \\sum_{i=1}^{4} |A_{ik}| = C_k = C_{\\max}.\n$$\n对于这个特定的 $x$ 选择，我们有 $\\frac{\\|A x\\|_{1}}{\\|x\\|_{1}} = \\frac{C_{\\max}}{1} = C_{\\max}$。因为我们找到了一个达到上界的向量，所以上确界必定是这个值。因此，矩阵 $1$-范数的表达式是最大绝对列和：\n$$\n\\|A\\|_{1} = \\max_{1 \\le j \\le 4} \\sum_{i=1}^{4} |A_{ij}|.\n$$\n对于给定的矩阵 $A$，其绝对列和为：\n\\begin{itemize}\n    \\item 第 $1$ 列：$|1| + |3| + |0| + |-4| = 1 + 3 + 0 + 4 = 8$。\n    \\item 第 $2$ 列：$|-2| + |0| + |5| + |1| = 2 + 0 + 5 + 1 = 8$。\n    \\item 第 $3$ 列：$|-1| + |2| + |2| + |0| = 1 + 2 + 2 + 0 = 5$。\n    \\item 第 $4$ 列：$|4| + |-3| + |-1| + |3| = 4 + 3 + 1 + 3 = 11$。\n\\end{itemize}\n这些值的最大值是 $11$。因此，$\\|A\\|_{1} = 11$。\n\n### 矩阵 $\\infty$-范数 $\\|A\\|_{\\infty}$ 的推导与计算\n\n诱导矩阵 $\\infty$-范数定义为 $\\|A\\|_{\\infty} = \\sup_{x \\neq 0} \\frac{\\|A x\\|_{\\infty}}{\\|x\\|_{\\infty}}$。$y=Ax$ 的向量 $\\infty$-范数是 $\\|Ax\\|_{\\infty} = \\max_{1 \\le i \\le 4} |y_i| = \\max_{1 \\le i \\le 4} \\left| \\sum_{j=1}^{4} A_{ij} x_j \\right|$。\n对于任何特定的行 $i$，我们应用三角不等式：\n$$\n\\left| \\sum_{j=1}^{4} A_{ij} x_j \\right| \\le \\sum_{j=1}^{4} |A_{ij} x_j| = \\sum_{j=1}^{4} |A_{ij}| |x_j|.\n$$\n根据定义，对所有 $j$ 都有 $|x_j| \\le \\max_{1 \\le k \\le 4} |x_k| = \\|x\\|_{\\infty}$。因此：\n$$\n\\left| \\sum_{j=1}^{4} A_{ij} x_j \\right| \\le \\sum_{j=1}^{4} |A_{ij}| \\|x\\|_{\\infty} = \\|x\\|_{\\infty} \\sum_{j=1}^{4} |A_{ij}|.\n$$\n设 $R_i = \\sum_{j=1}^{4} |A_{ij}|$ 为第 $i$ 行元素绝对值之和。那么 $|(Ax)_i| \\le R_i \\|x\\|_{\\infty}$。由于这对所有 $i$ 都成立，它也必定对最大分量成立：\n$$\n\\|Ax\\|_{\\infty} = \\max_{1 \\le i \\le 4} |(Ax)_i| \\le \\max_{1 \\le i \\le 4} (R_i \\|x\\|_{\\infty}) = \\left(\\max_{1 \\le i \\le 4} R_i\\right) \\|x\\|_{\\infty}.\n$$\n设 $R_{\\max} = \\max_{1 \\le i \\le 4} R_i$。那么 $\\frac{\\|A x\\|_{\\infty}}{\\|x\\|_{\\infty}} \\le R_{\\max}$，这意味着 $\\|A\\|_{\\infty} \\le R_{\\max}$。\n\n为了证明这个界是可以达到的，设 $k$ 是具有最大绝对和的行的索引，$R_k = R_{\\max}$。我们构造一个向量 $x \\in \\mathbb{R}^4$，其分量为 $x_j = \\text{sgn}(A_{kj})$，其中如果 $z>0$，则 $\\text{sgn}(z) = 1$，如果 $z0$，则 $\\text{sgn}(z) = -1$，为简单起见，我们可以定义 $\\text{sgn}(0)=1$。对于这个向量 $x$，所有分量的绝对值 $|x_j| \\le 1$，并且至少有一个分量的绝对值为 $1$（除非第 $k$ 行为全零，这是一个平凡的情况）。因此，$\\|x\\|_{\\infty} = 1$。\n现在，考虑乘积 $Ax$ 的第 $k$ 个分量：\n$$\n(Ax)_k = \\sum_{j=1}^{4} A_{kj} x_j = \\sum_{j=1}^{4} A_{kj} \\text{sgn}(A_{kj}) = \\sum_{j=1}^{4} |A_{kj}| = R_k = R_{\\max}.\n$$\n$Ax$ 的 $\\infty$-范数必须至少是其第 $k$ 个分量的绝对值：\n$$\n\\|Ax\\|_{\\infty} = \\max_{1 \\le i \\le 4} |(Ax)_i| \\ge |(Ax)_k| = R_{\\max}.\n$$\n结合早先的不等式 $\\|Ax\\|_{\\infty} \\le R_{\\max}\\|x\\|_{\\infty} = R_{\\max}$（因为 $\\|x\\|_\\infty=1$），我们必有 $\\|Ax\\|_{\\infty} = R_{\\max}$。\n对于这个特定的 $x$，$\\frac{\\|A x\\|_{\\infty}}{\\|x\\|_{\\infty}} = \\frac{R_{\\max}}{1} = R_{\\max}$。因此上确界是 $R_{\\max}$。矩阵 $\\infty$-范数的表达式是最大绝对行和：\n$$\n\\|A\\|_{\\infty} = \\max_{1 \\le i \\le 4} \\sum_{j=1}^{4} |A_{ij}|.\n$$\n对于给定的矩阵 $A$，其绝对行和为：\n\\begin{itemize}\n    \\item 第 $1$ 行：$|1| + |-2| + |-1| + |4| = 1 + 2 + 1 + 4 = 8$。\n    \\item 第 $2$ 行：$|3| + |0| + |2| + |-3| = 3 + 0 + 2 + 3 = 8$。\n    \\item 第 $3$ 行：$|0| + |5| + |2| + |-1| = 0 + 5 + 2 + 1 = 8$。\n    \\item 第 $4$ 行：$|-4| + |1| + |0| + |3| = 4 + 1 + 0 + 3 = 8$。\n\\end{itemize}\n所有绝对行和都等于 $8$。最大值是 $8$。因此，$\\|A\\|_{\\infty} = 8$。\n\n### 分块矩阵的范数界\n\n设向量 $x \\in \\mathbb{R}^4$ 被划分为 $x = \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix}$，其中 $x_1, x_2 \\in \\mathbb{R}^2$。矩阵-向量乘积 $Ax$ 可以写成分块形式：\n$$\nAx = \\begin{pmatrix} B  C \\\\ D  E \\end{pmatrix} \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix} = \\begin{pmatrix} Bx_1 + Cx_2 \\\\ Dx_1 + Ex_2 \\end{pmatrix}.\n$$\n我们分析 $Ax$ 的 $1$-范数和 $\\infty$-范数。首先，我们使用上面推导的公式计算各个块的范数。\n\\begin{itemize}\n    \\item $\\|B\\|_{1} = \\max(|1|+|3|, |-2|+|0|) = 4$。\n    \\item $\\|C\\|_{1} = \\max(|-1|+|2|, |4|+|-3|) = 7$。\n    \\item $\\|D\\|_{1} = \\max(|0|+|-4|, |5|+|1|) = 6$。\n    \\item $\\|E\\|_{1} = \\max(|2|+|0|, |-1|+|3|) = 4$。\n\\end{itemize}\n\\begin{itemize}\n    \\item $\\|B\\|_{\\infty} = \\max(|1|+|-2|, |3|+|0|) = 3$。\n    \\item $\\|C\\|_{\\infty} = \\max(|-1|+|4|, |2|+|-3|) = 5$。\n    \\item $\\|D\\|_{\\infty} = \\max(|0|+|5|, |-4|+|1|) = 5$。\n    \\item $\\|E\\|_{\\infty} = \\max(|2|+|-1|, |0|+|3|) = 3$。\n\\end{itemize}\n\n**$\\|Ax\\|_{\\infty}$ 的界：**\n分块向量 $\\begin{pmatrix} u \\\\ v \\end{pmatrix}$ 的向量 $\\infty$-范数是 $\\max(\\|u\\|_{\\infty}, \\|v\\|_{\\infty})$。\n$$\n\\|Ax\\|_{\\infty} = \\left\\| \\begin{pmatrix} Bx_1 + Cx_2 \\\\ Dx_1 + Ex_2 \\end{{pmatrix} \\right\\|_{\\infty} = \\max\\left( \\|Bx_1 + Cx_2\\|_{\\infty}, \\|Dx_1 + Ex_2\\|_{\\infty} \\right).\n$$\n对每个块使用三角不等式和诱导范数的定义：\n\\begin{align*}\n\\|Bx_1 + Cx_2\\|_{\\infty} \\le \\|Bx_1\\|_{\\infty} + \\|Cx_2\\|_{\\infty} \\le \\|B\\|_{\\infty}\\|x_1\\|_{\\infty} + \\|C\\|_{\\infty}\\|x_2\\|_{\\infty}. \\\\\n\\|Dx_1 + Ex_2\\|_{\\infty} \\le \\|Dx_1\\|_{\\infty} + \\|Ex_2\\|_{\\infty} \\le \\|D\\|_{\\infty}\\|x_1\\|_{\\infty} + \\|E\\|_{\\infty}\\|x_2\\|_{\\infty}.\n\\end{align*}\n结合这些，我们得到：\n$$\n\\|Ax\\|_{\\infty} \\le \\max\\left( \\|B\\|_{\\infty}\\|x_1\\|_{\\infty} + \\|C\\|_{\\infty}\\|x_2\\|_{\\infty}, \\|D\\|_{\\infty}\\|x_1\\|_{\\infty} + \\|E\\|_{\\infty}\\|x_2\\|_{\\infty} \\right).\n$$\n这个表达式可以与一个 $2 \\times 2$ 的范数矩阵相关联。设 $\\mathcal{A}_{\\infty} = \\begin{pmatrix} \\|B\\|_{\\infty}  \\|C\\|_{\\infty} \\\\ \\|D\\|_{\\infty}  \\|E\\|_{\\infty} \\end{pmatrix}$ 和 $\\chi_{\\infty} = \\begin{pmatrix} \\|x_1\\|_{\\infty} \\\\ \\|x_2\\|_{\\infty} \\end{pmatrix}$。不等式的右边恰好是乘积 $\\mathcal{A}_{\\infty}\\chi_{\\infty}$ 的 $\\infty$-范数。\n$$\n\\|Ax\\|_{\\infty} \\le \\|\\mathcal{A}_{\\infty}\\chi_{\\infty}\\|_{\\infty}.\n$$\n使用 $\\mathcal{A}_{\\infty}$ 的诱导范数性质，我们有 $\\|\\mathcal{A}_{\\infty}\\chi_{\\infty}\\|_{\\infty} \\le \\|\\mathcal{A}_{\\infty}\\|_{\\infty}\\|\\chi_{\\infty}\\|_{\\infty}$。此外，$\\|\\chi_{\\infty}\\|_{\\infty} = \\max(\\|x_1\\|_{\\infty}, \\|x_2\\|_{\\infty}) = \\|x\\|_{\\infty}$。这给出了 $\\|Ax\\|_{\\infty}$ 的最终界：\n$$\n\\|Ax\\|_{\\infty} \\le \\|\\mathcal{A}_{\\infty}\\|_{\\infty} \\|x\\|_{\\infty}.\n$$\n这进一步意味着对矩阵范数本身的界：$\\|A\\|_{\\infty} \\le \\|\\mathcal{A}_{\\infty}\\|_{\\infty}$。对于我们的特定矩阵，$\\mathcal{A}_{\\infty} = \\begin{pmatrix} 3  5 \\\\ 5  3 \\end{pmatrix}$。其 $\\infty$-范数是 $\\|\\mathcal{A}_{\\infty}\\|_{\\infty} = \\max(3+5, 5+3) = 8$。因此，$\\|A\\|_{\\infty} \\le 8$，这与我们的精确计算一致。\n\n**$\\|Ax\\|_{1}$ 的界：**\n分块向量 $\\begin{pmatrix} u \\\\ v \\end{pmatrix}$ 的向量 $1$-范数是 $\\|u\\|_{1} + \\|v\\|_{1}$。\n$$\n\\|Ax\\|_{1} = \\left\\| \\begin{pmatrix} Bx_1 + Cx_2 \\\\ Dx_1 + Ex_2 \\end{pmatrix} \\right\\|_{1} = \\|Bx_1 + Cx_2\\|_{1} + \\|Dx_1 + Ex_2\\|_{1}.\n$$\n使用三角不等式和诱导范数的定义：\n$$\n\\|Ax\\|_{1} \\le (\\|Bx_1\\|_{1} + \\|Cx_2\\|_{1}) + (\\|Dx_1\\|_{1} + \\|Ex_2\\|_{1}) \\le (\\|B\\|_{1}\\|x_1\\|_{1} + \\|C\\|_{1}\\|x_2\\|_{1}) + (\\|D\\|_{1}\\|x_1\\|_{1} + \\|E\\|_{1}\\|x_2\\|_{1}).\n$$\n设 $\\mathcal{A}_{1} = \\begin{pmatrix} \\|B\\|_{1}  \\|C\\|_{1} \\\\ \\|D\\|_{1}  \\|E\\|_{1} \\end{pmatrix}$ 和 $\\chi_{1} = \\begin{pmatrix} \\|x_1\\|_{1} \\\\ \\|x_2\\|_{1} \\end{pmatrix}$。由于所有量 $\\|B\\|_{1}, \\|x_1\\|_{1}$ 等都是非负的，右侧可以被识别为乘积 $\\mathcal{A}_{1}\\chi_{1}$ 的 $1$-范数。\n$$\n\\|Ax\\|_{1} \\le (\\|B\\|_{1}\\|x_1\\|_{1} + \\|C\\|_{1}\\|x_2\\|_{1}) + (\\|D\\|_{1}\\|x_1\\|_{1} + \\|E\\|_{1}\\|x_2\\|_{1}) = \\|\\mathcal{A}_{1}\\chi_{1}\\|_{1}.\n$$\n使用 $\\mathcal{A}_{1}$ 的诱导范数性质，我们有 $\\|\\mathcal{A}_{1}\\chi_{1}\\|_{1} \\le \\|\\mathcal{A}_{1}\\|_{1}\\|\\chi_{1}\\|_{1}$。同时，$\\|\\chi_{1}\\|_{1} = \\|x_1\\|_{1} + \\|x_2\\|_{1} = \\|x\\|_{1}$。这给出了界：\n$$\n\\|Ax\\|_{1} \\le \\|\\mathcal{A}_{1}\\|_{1} \\|x\\|_{1}.\n$$\n这意味着矩阵范数界 $\\|A\\|_{1} \\le \\|\\mathcal{A}_{1}\\|_{1}$。对于我们的特定矩阵，$\\mathcal{A}_{1} = \\begin{pmatrix} 4  7 \\\\ 6  4 \\end{pmatrix}$。其 $1$-范数是 $\\|\\mathcal{A}_{1}\\|_{1} = \\max(4+6, 7+4) = \\max(10, 11) = 11$。因此，$\\|A\\|_{1} \\le 11$，这也与我们的精确计算一致。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n11  8\n\\end{pmatrix}\n}\n$$", "id": "3158838"}, {"introduction": "掌握了单一范数的计算后，更进一步是探索不同范数之间的内在联系。本练习 [@problem_id:3158812] 聚焦于一个重要的不等式 $\\|A\\|_2 \\le \\sqrt{\\|A\\|_1\\|A\\|_\\infty}$，它连接了谱范数、1-范数和无穷范数。通过分析不等式何时“紧致”或“宽松”的两个极端例子，你将对矩阵结构如何决定不同范数间的关系有更深刻的认识。", "problem": "在计算科学导论中，矩阵范数用于量化线性变换如何放大以不同方式测量的向量。对于一个实矩阵 $A \\in \\mathbb{R}^{m \\times n}$ 和一个向量 $x \\in \\mathbb{R}^{n}$，由向量范数 $\\|\\cdot\\|$ 导出的矩阵范数定义为 $\\|A\\| = \\sup_{x \\neq 0} \\frac{\\|Ax\\|}{\\|x\\|}$。考虑以下三种诱导范数：$1$-范数（$\\|x\\|_{1} = \\sum_{i=1}^{n} |x_{i}|$）、无穷范数（$\\|x\\|_{\\infty} = \\max_{1 \\leq i \\leq n} |x_{i}|$）和 $2$-范数（$\\|x\\|_{2} = \\sqrt{\\sum_{i=1}^{n} x_{i}^{2}}$）。相应的诱导矩阵范数表示为 $\\|A\\|_{1}$、$\\|A\\|_{\\infty}$ 和 $\\|A\\|_{2}$。定义紧度比\n$$\nR(A) \\;=\\; \\frac{\\|A\\|_{2}}{\\sqrt{\\|A\\|_{1}\\,\\|A\\|_{\\infty}}}.\n$$\n从上述定义和关于 $A^{\\top}A$ 特征值的标准事实出发，计算以下两个矩阵的 $R(A)$ 的精确值：\n\n1. 令 $E \\in \\mathbb{R}^{m \\times n}$ 只有一个非零元素 $E_{11} = s$（其中 $s0$），所有其他元素均为 $0$。计算 $R(E)$。\n\n2. 令 $H_{n} \\in \\mathbb{R}^{n \\times n}$ 是一个矩阵，其 $n$ 个列向量两两正交，且每个元素均为 $+1$ 或 $-1$。计算 $R(H_{n})$ 关于 $n$ 的闭式表达式，然后计算当 $n=16$ 时该比率的值。\n\n以精确值的形式报告有序对 $\\left(R(E),\\,R(H_{16})\\right)$ 的最终答案。无需四舍五入。", "solution": "首先对问题陈述进行严格的验证过程。\n\n### 步骤 1：提取已知条件\n- 一个实矩阵 $A \\in \\mathbb{R}^{m \\times n}$ 和一个向量 $x \\in \\mathbb{R}^{n}$。\n- 诱导矩阵范数定义：$\\|A\\| = \\sup_{x \\neq 0} \\frac{\\|Ax\\|}{\\|x\\|}$。\n- 向量 $1$-范数：$\\|x\\|_{1} = \\sum_{i=1}^{n} |x_{i}|$。\n- 向量无穷范数：$\\|x\\|_{\\infty} = \\max_{1 \\leq i \\leq n} |x_{i}|$。\n- 向量 $2$-范数：$\\|x\\|_{2} = \\sqrt{\\sum_{i=1}^{n} x_{i}^{2}}$。\n- 相应的诱导矩阵范数：$\\|A\\|_{1}$、$\\|A\\|_{\\infty}$ 和 $\\|A\\|_{2}$。\n- 紧度比定义：$R(A) = \\frac{\\|A\\|_{2}}{\\sqrt{\\|A\\|_{1}\\,\\|A\\|_{\\infty}}}$。\n- 矩阵 $E \\in \\mathbb{R}^{m \\times n}$ 只有一个非零元素 $E_{11} = s$（其中 $s0$），所有其他元素均为 $0$。\n- 矩阵 $H_{n} \\in \\mathbb{R}^{n \\times n}$，其 $n$ 个列向量两两正交，且每个元素均为 $+1$ 或 $-1$。\n- 任务是计算 $R(E)$ 和 $R(H_{n})$ 关于 $n$ 的精确值，对后者计算 $n=16$ 时的值，并报告有序对 $\\left(R(E),\\,R(H_{16})\\right)$。\n\n### 步骤 2：使用提取的已知条件进行验证\n1.  **科学或事实不健全**：该问题基于线性代数和数值分析中关于向量和矩阵范数的标准、正确的定义。所描述的矩阵是定义明确的数学对象。对于矩阵 $H_n$，其属性描述了一个缩放的 Hadamard 矩阵；已知当阶数 $n$ 是 $2$ 的幂时（包括 $n=16$），此类矩阵存在。该问题在数学上和科学上都是合理的。\n2.  **不可形式化或不相关**：该问题是矩阵代数中的一个形式化练习，与计算科学中矩阵范数的主题直接相关。\n3.  **不完整或矛盾的设置**：为矩阵 $E$ 和 $H_n$ 提供的定义和属性对于计算所需范数是充分且一致的。没有缺失或矛盾的条件。\n4.  **不切实际或不可行**：该问题纯属数学问题。条件在数学上是一致且可行的。\n5.  **不适定或结构不良**：该问题是适定的，具有明确的定义和目标，可以导出一个唯一的、可确定的解。\n6.  **伪深刻、琐碎或同义反复**：该问题需要对矩阵范数属性及其计算有扎实的理解。这是一个实质性的练习，既不琐碎，也非人为复杂化。\n7.  **超出科学可验证性**：结果可以通过标准的数学证明推导和验证。\n\n### 步骤 3：结论与行动\n该问题是有效的。将提供完整的解答。\n\n***\n\n解题过程首先计算每个矩阵所需的范数，然后计算紧度比 $R(A)$。\n\n**第一部分：矩阵 $E$ 的计算**\n\n矩阵 $E \\in \\mathbb{R}^{m \\times n}$ 只有一个非零元素 $E_{11} = s > 0$。所有其他元素 $E_{ij}$ 均为 $0$。\n\n1.  **计算 $\\|E\\|_{1}$**：诱导 $1$-范数是矩阵的列绝对值之和的最大值。\n    $$\n    \\|E\\|_{1} = \\max_{1 \\le j \\le n} \\sum_{i=1}^{m} |E_{ij}|\n    $$\n    第一列（$j=1$）的绝对值之和是 $\\sum_{i=1}^{m} |E_{i1}| = |E_{11}| + \\sum_{i=2}^{m} |E_{i1}| = |s| + 0 = s$，因为 $s0$。\n    对于任何其他列（$j  1$），和为 $\\sum_{i=1}^{m} |E_{ij}| = 0$，因为所有元素都为 $0$。\n    这些列和的最大值为 $s$。因此，$\\|E\\|_{1} = s$。\n\n2.  **计算 $\\|E\\|_{\\infty}$**：诱导 $\\infty$-范数是矩阵的行绝对值之和的最大值。\n    $$\n    \\|E\\|_{\\infty} = \\max_{1 \\le i \\le m} \\sum_{j=1}^{n} |E_{ij}|\n    $$\n    第一行（$i=1$）的绝对值之和是 $\\sum_{j=1}^{n} |E_{1j}| = |E_{11}| + \\sum_{j=2}^{n} |E_{1j}| = |s| + 0 = s$。\n    对于任何其他行（$i  1$），和为 $\\sum_{j=1}^{n} |E_{ij}| = 0$。\n    这些行和的最大值为 $s$。因此，$\\|E\\|_{\\infty} = s$。\n\n3.  **计算 $\\|E\\|_{2}$**：诱导 $2$-范数是矩阵的最大奇异值，也就是 $E^{\\top}E$ 的最大特征值的平方根。矩阵 $E^{\\top}$ 是一个 $n \\times m$ 矩阵，其 $(E^{\\top})_{11} = s$，所有其他元素均为 $0$。我们来计算乘积 $E^{\\top}E \\in \\mathbb{R}^{n \\times n}$。\n    $E^{\\top}E$ 的 $(k,l)$ 元素由 $(E^{\\top}E)_{kl} = \\sum_{i=1}^{m} (E^{\\top})_{ki}E_{il} = \\sum_{i=1}^{m} E_{ik}E_{il}$ 给出。\n    $E$ 中唯一的非零元素是 $E_{11}=s$。所以，只有当 $i=1$ 且 $k=1$ 时，$E_{ik}$ 才非零。同样，只有当 $i=1$ 且 $l=1$ 时，$E_{il}$ 才非零。\n    因此，只有当 $k=1$ 且 $l=1$ 时，和才非零：\n    $(E^{\\top}E)_{11} = \\sum_{i=1}^{m} E_{i1}E_{i1} = (E_{11})^2 = s^2$。\n    所有其他元素 $(E^{\\top}E)_{kl}$ 均为 $0$。\n    所以，$E^{\\top}E$ 是一个在 $(1,1)$ 位置为 $s^2$ 而其他位置均为零的矩阵。该矩阵的特征值是其对角线元素，即一个 $s^2$ 和 $n-1$ 个零。\n    最大特征值为 $\\lambda_{\\max}(E^{\\top}E) = s^2$。\n    $2$-范数为 $\\|E\\|_{2} = \\sqrt{\\lambda_{\\max}(E^{\\top}E)} = \\sqrt{s^2} = s$（因为 $s0$）。\n\n4.  **计算 $R(E)$**：\n    $$\n    R(E) = \\frac{\\|E\\|_{2}}{\\sqrt{\\|E\\|_{1}\\,\\|E\\|_{\\infty}}} = \\frac{s}{\\sqrt{s \\cdot s}} = \\frac{s}{\\sqrt{s^2}} = \\frac{s}{s} = 1.\n    $$\n\n**第二部分：矩阵 $H_n$ 的计算**\n\n矩阵 $H_{n} \\in \\mathbb{R}^{n \\times n}$ 的列向量两两正交，并且每个元素 $(H_n)_{ij}$ 均为 $+1$ 或 $-1$。\n\n令 $h_j$ 为 $H_n$ 的第 $j$ 列。给定的属性是：\n-   当 $i \\neq j$ 时，$h_i^{\\top}h_j = 0$。\n-   $H_n$ 的元素为 $(H_n)_{ij} \\in \\{+1, -1\\}$。\n\n根据第二个属性，任何列 $h_j$ 的欧几里得范数的平方是：\n$h_j^{\\top}h_j = \\|h_j\\|^2_2 = \\sum_{i=1}^{n} ((H_n)_{ij})^2 = \\sum_{i=1}^{n} (\\pm 1)^2 = \\sum_{i=1}^{n} 1 = n$。\n\n结合这些属性，我们可以确定矩阵乘积 $H_n^{\\top}H_n$。该乘积的第 $(i,j)$ 个元素是 $h_i^{\\top}h_j$。\n$$\n(H_n^{\\top}H_n)_{ij} = h_i^{\\top}h_j = \\begin{cases} n,  \\text{如果 } i=j \\\\ 0,  \\text{如果 } i \\neq j \\end{cases}\n$$\n这意味着 $H_n^{\\top}H_n = n I_n$，其中 $I_n$ 是 $n \\times n$ 的单位矩阵。\n\n1.  **计算 $\\|H_n\\|_{1}$**：列绝对值之和的最大值。\n    对于任何列 $j$，列绝对值之和为 $\\sum_{i=1}^{n} |(H_n)_{ij}|$。由于每个元素都是 $\\pm 1$，其绝对值为 $1$。\n    $$\n    \\sum_{i=1}^{n} |(H_n)_{ij}| = \\sum_{i=1}^{n} 1 = n.\n    $$\n    由于每一列的和都是 $n$，所以最大值是 $n$。因此，$\\|H_n\\|_{1} = n$。\n\n2.  **计算 $\\|H_n\\|_{\\infty}$**：行绝对值之和的最大值。\n    同样，对于任何行 $i$，行绝对值之和为 $\\sum_{j=1}^{n} |(H_n)_{ij}| = \\sum_{j=1}^{n} 1 = n$。\n    这些相同和的最大值为 $n$。因此，$\\|H_n\\|_{\\infty} = n$。\n\n3.  **计算 $\\|H_n\\|_{2}$**：$H_n^{\\top}H_n$ 的最大特征值的平方根。\n    如前所述，$H_n^{\\top}H_n = n I_n$。这是一个对角矩阵，所有对角元素都等于 $n$。\n    $n I_n$ 的所有特征值都等于 $n$。\n    最大特征值为 $\\lambda_{\\max}(H_n^{\\top}H_n) = n$。\n    因此，$2$-范数为 $\\|H_n\\|_{2} = \\sqrt{n}$。\n\n4.  **计算 $R(H_n)$**：\n    $$\n    R(H_n) = \\frac{\\|H_n\\|_{2}}{\\sqrt{\\|H_n\\|_{1}\\,\\|H_n\\|_{\\infty}}} = \\frac{\\sqrt{n}}{\\sqrt{n \\cdot n}} = \\frac{\\sqrt{n}}{\\sqrt{n^2}} = \\frac{\\sqrt{n}}{n} = \\frac{1}{\\sqrt{n}}.\n    $$\n\n最后，我们计算当 $n=16$ 时 $R(H_{n})$ 的值：\n$$\nR(H_{16}) = \\frac{1}{\\sqrt{16}} = \\frac{1}{4}.\n$$\n\n所求的有序对是 $(R(E), R(H_{16}))$。\n我们得到 $R(E)=1$ 和 $R(H_{16}) = \\frac{1}{4}$。\n该有序对是 $(1, \\frac{1}{4})$。", "answer": "$$\n\\boxed{\\begin{pmatrix} 1  \\frac{1}{4} \\end{pmatrix}}\n$$", "id": "3158812"}, {"introduction": "最后的练习旨在展示矩阵范数在实际科学计算中的核心作用。我们将分析一个源于物理问题（拉普拉斯方程离散化）的特定矩阵 [@problem_id:3158860]，它在工程与科学仿真中无处不在。通过这个例子，你将亲身体会到谱范数和条件数等概念如何直接决定数值算法的稳定性和性能，从而将抽象的线性代数理论与计算科学的实践挑战紧密联系起来。", "problem": "您将编写一个完整、可运行的程序，该程序构建与单位正方形上带有齐次狄利克雷边界条件的二维负拉普拉斯算子的标准五点有限差分格式离散化相对应的矩阵，然后使用该矩阵研究谱二范数和二范数条件数如何随网格分辨率变化。您的程序还必须量化相关线性常微分方程（ODE）系统的显式前向欧拉求解器的最大稳定时间步长。所有计算都将以纯粹的、无量纲的数学术语进行。\n\n考虑一个单位正方形上的 $n \\times n$ 内部点网格，其均匀间距为 $h = \\frac{1}{n+1}$。令 $N = n^2$ 为未知数的数量。定义矩阵 $A \\in \\mathbb{R}^{N \\times N}$ 来表示带有齐次狄利克雷边界条件的负拉普拉斯算子 $- \\Delta$ 的标准五点差分格式有限差分近似。形式上，令 $T \\in \\mathbb{R}^{n \\times n}$ 为一个三对角矩阵，其主对角线上的元素为 $2$，第一副对角线和第一超对角线上的元素为 $-1$，并令 $I \\in \\mathbb{R}^{n \\times n}$ 表示单位矩阵。那么 $A$ 是按 $1/h^2$ 缩放的克罗内克和，即\n$$\nA = \\frac{1}{h^2}\\left( I \\otimes T + T \\otimes I \\right).\n$$\n在所有后续计算中，您必须使用此 $A$ 作为唯一矩阵。\n\n令 $\\lVert \\cdot \\rVert_2$ 表示谱（算子）二范数，令 $\\kappa_2(A) = \\lVert A \\rVert_2 \\lVert A^{-1} \\rVert_2$ 为二范数条件数。仅使用关于范数、特征值、克罗内克和以及线性多步法稳定性的基本定义和事实，对下面的每个测试用例执行以下操作：\n1. 完全按照规定构建 $A$。\n2. 计算 $\\lVert A \\rVert_2$。\n3. 计算 $\\kappa_2(A)$。\n4. 考虑通过对具有单位扩散系数的热传导方程进行半离散化得到的线性 ODE 系统 $u'(t) = -A u(t)$。仅使用应用于 $u'(t) = -A u(t)$ 的显式前向欧拉方法的线性稳定性定义，确定该系统的最大稳定时间步长 $\\Delta t_{\\max}$。\n\n您的程序必须为以下网格尺寸的测试套件生成数值答案：\n- $n = 1$ (边界情况，最小的非平凡系统),\n- $n = 4$ (小系统),\n- $n = 8$ (中等系统),\n- $n = 16$ (较大系统),\n- $n = 32$ (合理运行时间内的压力测试)。\n\n每个测试用例的输出必须是一个包含三个实数 $[\\lVert A \\rVert_2, \\kappa_2(A), \\Delta t_{\\max}]$ 的列表，其中每个数字都四舍五入到六位有效数字。最终输出必须是单行，包含这些按 $n$ 的上述顺序排列的各用例结果的列表，行内无任何空格。例如，输出必须如下所示：\n$$\n[[x_{11},x_{12},x_{13}],[x_{21},x_{22},x_{23}],\\dots,[x_{51},x_{52},x_{53}]]\n$$\n其中每个 $x_{ij}$ 是一个四舍五入到六位有效数字的实数。\n\n您的程序必须无需用户输入，且不得访问外部文件或网络。它必须使用一种数值上可靠的方法，基于 $A$ 的结构以及二范数和条件数的定义来估算 $\\lVert A \\rVert_2$ 和 $\\kappa_2(A)$。\n\n您的最终程序必须只打印上述描述的单行作为其输出。", "solution": "问题陈述已经过严格审查，并被确定为有效。它在科学上基于偏微分方程数值分析的原理，是适定的，具有唯一且可计算的解，并以客观、形式化的语言表述。该问题是计算科学中的一个标准练习，旨在测试对有限差分法、源自克罗内克积的矩阵性质以及常微分方程（ODE）数值方法稳定性的理解。所有必要的数据和定义均已提供。\n\n任务是为一系列网格尺寸 $n$ 计算三个量：谱范数 $\\lVert A \\rVert_2$、二范数条件数 $\\kappa_2(A)$，以及一个相关 ODE 系统的最大稳定时间步长 $\\Delta t_{\\max}$。矩阵 $A \\in \\mathbb{R}^{N \\times N}$（其中 $N=n^2$）是单位正方形上负拉普拉斯算子的五点有限差分近似，由下式给出：\n$$\nA = \\frac{1}{h^2}\\left( I \\otimes T + T \\otimes I \\right)\n$$\n其中 $h = \\frac{1}{n+1}$，$I \\in \\mathbb{R}^{n \\times n}$ 是单位矩阵，$T \\in \\mathbb{R}^{n \\times n}$ 是一个三对角矩阵，其主对角线上的元素为 $2$，第一副对角线和第一超对角线上的元素为 $-1$。\n\n计算所需量最有效且数值上最可靠的方法是利用已知的 $A$ 特征值的解析表达式，而不是构建完整的 $N \\times N$ 矩阵并使用数值特征值求解器，因为对于大的 $n$，后者计算成本高昂且容易产生浮点误差。$A$ 的结构允许采用精确的解析方法。\n\n**1. 矩阵 $A$ 的特征值**\n\n矩阵 $T \\in \\mathbb{R}^{n \\times n}$ 的特征值是解析已知的，由下式给出：\n$$\n\\lambda_k(T) = 2 - 2 \\cos\\left(\\frac{k \\pi}{n+1}\\right) \\quad \\text{其中 } k = 1, 2, \\dots, n.\n$$\n矩阵 $A$ 定义为缩放后的克罗内克和 $A = \\frac{1}{h^2}(I \\otimes T + T \\otimes I)$。克罗内克和的一个基本性质是其特征值是组成矩阵特征值的和。具体来说，$I \\otimes T + T \\otimes I$ 的特征值是 $\\lambda_j(T) + \\lambda_k(T)$，对于所有索引对 $j,k \\in \\{1, \\dots, n\\}$。\n因此，$A$ 的特征值是：\n$$\n\\lambda_{j,k}(A) = \\frac{1}{h^2} \\left( \\lambda_j(T) + \\lambda_k(T) \\right) = \\frac{1}{h^2} \\left[ \\left(2 - 2 \\cos\\left(\\frac{j \\pi}{n+1}\\right)\\right) + \\left(2 - 2 \\cos\\left(\\frac{k \\pi}{n+1}\\right)\\right) \\right]\n$$\n对于 $j,k = 1, 2, \\dots, n$。由于 $h = \\frac{1}{n+1}$，我们有 $1/h^2 = (n+1)^2$。\n\n**2. 谱范数 $\\lVert A \\rVert_2$**\n\n矩阵 $T$ 是对称的，因此 $A$ 也是对称的。对于对称矩阵，谱范数（或 $2$-范数）等于其谱半径，即其特征值绝对值的最大值：\n$$\n\\lVert A \\rVert_2 = \\rho(A) = \\max_{j,k} |\\lambda_{j,k}(A)|.\n$$\n对于 $j,k \\in \\{1, \\dots, n\\}$，项 $\\frac{k \\pi}{n+1}$ 在区间 $(0, \\pi)$ 内，所以 $\\cos(\\frac{k \\pi}{n+1})  1$。这确保了对所有 $k$，$\\lambda_k(T) > 0$，因此，所有特征值 $\\lambda_{j,k}(A)$ 都严格为正。范数就是最大特征值 $\\lambda_{\\max}(A)$。\n当余弦项最小时，达到最大特征值。余弦函数在 $[0, \\pi]$ 上是递减的，所以我们必须为余弦选择尽可能大的参数，这对应于索引 $j=n$ 和 $k=n$。\n$$\n\\lVert A \\rVert_2 = \\lambda_{\\max}(A) = \\lambda_{n,n}(A) = \\frac{1}{h^2} \\left[ 4 - 4 \\cos\\left(\\frac{n \\pi}{n+1}\\right) \\right].\n$$\n使用恒等式 $1 - \\cos(\\theta) = 2 \\sin^2(\\theta/2)$，上式可简化为：\n$$\n\\lVert A \\rVert_2 = \\frac{4}{h^2} \\left( 2 \\sin^2\\left(\\frac{n \\pi}{2(n+1)}\\right) \\right) = \\frac{8}{h^2} \\sin^2\\left(\\frac{n \\pi}{2(n+1)}\\right).\n$$\n\n**3. 条件数 $\\kappa_2(A)$**\n\n$2$-范数条件数定义为 $\\kappa_2(A) = \\lVert A \\rVert_2 \\lVert A^{-1} \\rVert_2$。由于 $A$ 是对称正定的，其特征值为正，并且 $A^{-1}$ 的特征值为 $1/\\lambda_{j,k}(A)$。逆矩阵的范数为 $\\lVert A^{-1} \\rVert_2 = \\max(1/\\lambda) = 1/\\min(\\lambda) = 1/\\lambda_{\\min}(A)$。\n因此，条件数是最大特征值与最小特征值的比率：\n$$\n\\kappa_2(A) = \\frac{\\lambda_{\\max}(A)}{\\lambda_{\\min}(A)}.\n$$\n最小特征值 $\\lambda_{\\min}(A)$ 出现在其定义中的余弦项最大化时，这对应于最小的索引 $j=1$ 和 $k=1$。\n$$\n\\lambda_{\\min}(A) = \\lambda_{1,1}(A) = \\frac{1}{h^2} \\left[ 4 - 4 \\cos\\left(\\frac{\\pi}{n+1}\\right) \\right] = \\frac{8}{h^2} \\sin^2\\left(\\frac{\\pi}{2(n+1)}\\right).\n$$\n该比率则为：\n$$\n\\kappa_2(A) = \\frac{\\frac{8}{h^2} \\sin^2\\left(\\frac{n \\pi}{2(n+1)}\\right)}{\\frac{8}{h^2} \\sin^2\\left(\\frac{\\pi}{2(n+1)}\\right)} = \\frac{\\sin^2\\left(\\frac{n \\pi}{2(n+1)}\\right)}{\\sin^2\\left(\\frac{\\pi}{2(n+1)}\\right)}.\n$$\n使用恒等式 $\\sin(\\frac{\\pi}{2} - x) = \\cos(x)$，我们有 $\\sin(\\frac{n \\pi}{2(n+1)}) = \\sin(\\frac{\\pi}{2} - \\frac{\\pi}{2(n+1)}) = \\cos(\\frac{\\pi}{2(n+1)})$。这给出了一个更简单的表达式：\n$$\n\\kappa_2(A) = \\frac{\\cos^2\\left(\\frac{\\pi}{2(n+1)}\\right)}{\\sin^2\\left(\\frac{\\pi}{2(n+1)}\\right)} = \\cot^2\\left(\\frac{\\pi}{2(n+1)}\\right).\n$$\n\n**4. 最大稳定时间步长 $\\Delta t_{\\max}$**\n\n该 ODE 系统是 $u'(t) = -A u(t)$。应用显式前向欧拉方法得到迭代式：\n$$\nu_{m+1} = u_m + \\Delta t (-A u_m) = (I - \\Delta t A) u_m.\n$$\n为使此方法稳定，迭代矩阵 $G = I - \\Delta t A$ 的谱半径必须满足 $\\rho(G) \\le 1$。$G$ 的特征值为 $1 - \\Delta t \\lambda$，其中 $\\lambda$ 是 $A$ 的每个特征值。因此，稳定性条件是对于所有 $j,k$，都有 $|1 - \\Delta t \\lambda_{j,k}(A)| \\le 1$。\n这展开为 $-1 \\le 1 - \\Delta t \\lambda_{j,k}(A) \\le 1$。\n右侧不等式 $1 - \\Delta t \\lambda_{j,k}(A) \\le 1$ 意味着 $\\Delta t \\lambda_{j,k}(A) \\ge 0$，这总是成立的，因为 $\\Delta t > 0$ 且 $A$ 的所有特征值都为正。\n左侧不等式 $-1 \\le 1 - \\Delta t \\lambda_{j,k}(A)$ 意味着 $\\Delta t \\lambda_{j,k}(A) \\le 2$，或 $\\Delta t \\le \\frac{2}{\\lambda_{j,k}(A)}$。\n为对所有特征值都满足此条件，时间步长 $\\Delta t$ 必须受最严格情况的限制，这涉及最大特征值 $\\lambda_{\\max}(A) = \\lVert A \\rVert_2$。\n$$\n\\Delta t \\le \\frac{2}{\\lambda_{\\max}(A)}.\n$$\n因此，最大稳定时间步长为：\n$$\n\\Delta t_{\\max} = \\frac{2}{\\lambda_{\\max}(A)} = \\frac{2}{\\lVert A \\rVert_2}.\n$$\n\n**5. 计算实现**\n\n程序将遍历给定的 $n$ 值。对于每个 $n$，它将计算 $h$，然后应用推导出的解析公式计算 $\\lVert A \\rVert_2$、$\\kappa_2(A)$ 和 $\\Delta t_{\\max}$。结果将被格式化为六位有效数字，并组装成所需的最终输出字符串。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Constructs the matrix for the 2D Laplace operator, calculates its norm,\n    condition number, and the max stable timestep for an associated ODE system,\n    based on analytical formulas.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases_n = [1, 4, 8, 16, 32]\n\n    # A helper function to format a number to a specified number of significant figures.\n    # The '{:g}' format specifier in Python is suitable for this purpose.\n    def format_to_sig_figs(value, sig_figs):\n        return '{:.{p}g}'.format(value, p=sig_figs)\n\n    all_results = []\n    for n in test_cases_n:\n        # Mesh spacing h for an n x n grid of interior points on the unit square.\n        h = 1.0 / (n + 1)\n        pi = np.pi\n\n        # 1. Compute the spectral norm ||A||_2.\n        # This is equal to the maximum eigenvalue of A.\n        # norm_A = lambda_max(A) = (8/h^2) * sin^2(n*pi / (2*(n+1))).\n        # We can use the identity sin(pi/2 - x) = cos(x) to write\n        # sin(n*pi / (2*(n+1))) = sin(pi/2 - pi/(2*(n+1))) = cos(pi/(2*(n+1))).\n        arg_cos = pi / (2.0 * (n + 1))\n        norm_A = (8.0 / h**2) * (np.cos(arg_cos))**2\n\n        # 2. Compute the 2-norm condition number kappa_2(A).\n        # This is the ratio of the max to min eigenvalue.\n        # kappa_2(A) = cot^2(pi / (2*(n+1))).\n        arg_cot = pi / (2.0 * (n + 1))\n        # numpy does not have a cot function, but cot(x) = cos(x)/sin(x).\n        kappa_2_A = (np.cos(arg_cot) / np.sin(arg_cot))**2\n\n        # 3. Determine the largest stable time step dt_max for u'(t) = -A u(t).\n        # For the Forward Euler method, the stability condition is dt = 2/lambda_max(A).\n        # Therefore, dt_max = 2 / norm_A.\n        dt_max = 2.0 / norm_A\n\n        # Format results to six significant digits.\n        sig_figs = 6\n        rounded_norm = format_to_sig_figs(norm_A, sig_figs)\n        rounded_kappa = format_to_sig_figs(kappa_2_A, sig_figs)\n        rounded_dt = format_to_sig_figs(dt_max, sig_figs)\n\n        # Append the list of results for the current n.\n        all_results.append(f\"[{rounded_norm},{rounded_kappa},{rounded_dt}]\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(all_results)}]\")\n\nsolve()\n```", "id": "3158860"}]}