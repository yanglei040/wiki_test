{"hands_on_practices": [{"introduction": "要真正掌握 LU 分解，我们必须理解其核心定义 $A=LU$。这个练习将帮助你巩固这一基础。通过一个给定的矩阵 $A$ 及其上三角因子 $U$，你需要反向推导出相应的下三角因子 $L$，这将让你直接处理构成整个方法的矩阵乘法细节，从而加深理解。[@problem_id:2204087]", "problem": "在数值线性代数中，一个方阵 $A$ 的下上三角（LU）分解（Lower-Upper (LU) decomposition）是将其因式分解为一个乘积 $A = LU$，其中 $L$ 是一个下三角矩阵，$U$ 是一个上三角矩阵。对于Doolittle分解，矩阵 $L$ 被进一步约束为一个单位下三角矩阵，这意味着其主对角线上的所有元素都为1。\n\n考虑矩阵 $A$ 及其来自Doolittle分解的对应上三角因子 $U$，如下所示：\n$$\nA = \\begin{pmatrix} 2 & 1 & -3 \\\\ 4 & 6 & -1 \\\\ -2 & 11 & 16 \\end{pmatrix}, \\quad U = \\begin{pmatrix} 2 & 1 & -3 \\\\ 0 & 4 & 5 \\\\ 0 & 0 & -2 \\end{pmatrix}\n$$\n\n下列哪个矩阵表示正确的单位下三角矩阵 $L$，使得 $A = LU$？\n\nA. $L = \\begin{pmatrix} 1 & 0 & 0 \\\\ 2 & 1 & 0 \\\\ -1 & 3 & 1 \\end{pmatrix}$\n\nB. $L = \\begin{pmatrix} 1 & 0 & 0 \\\\ -2 & 1 & 0 \\\\ 1 & -3 & 1 \\end{pmatrix}$\n\nC. $L = \\begin{pmatrix} 1 & 0 & 0 \\\\ 4 & 1 & 0 \\\\ -2 & 11 & 1 \\end{pmatrix}$\n\nD. $L = \\begin{pmatrix} 1 & 0 & 0 \\\\ 2 & 1 & 0 \\\\ 1 & 3 & 1 \\end{pmatrix}$\n\nE. $L = \\begin{pmatrix} 1 & 0 & 0 \\\\ 2 & 1 & 0 \\\\ -1 & -3 & 1 \\end{pmatrix}$", "solution": "对于Doolittle分解，$L$ 是单位下三角矩阵。设\n$$\nL=\\begin{pmatrix}\n1 & 0 & 0 \\\\\n\\ell_{21} & 1 & 0 \\\\\n\\ell_{31} & \\ell_{32} & 1\n\\end{pmatrix}, \\quad\nU=\\begin{pmatrix}\n2 & 1 & -3 \\\\\n0 & 4 & 5 \\\\\n0 & 0 & -2\n\\end{pmatrix}.\n$$\n我们令 $A=LU$，并通过令 $LU$ 的元素与 $A$ 的对应元素相等来确定 $\\ell_{21}, \\ell_{31}, \\ell_{32}$。\n\n$LU$ 的第1行是 $U$ 的第一行，所以\n$$\n[2,\\,1,\\,-3]=\\text{row}_{1}(A),\n$$\n这是自动满足的。\n\n$LU$ 的第2行等于 $\\ell_{21}\\,\\text{row}_{1}(U)+\\text{row}_{2}(U)$，因此\n$$\n[2\\ell_{21},\\,\\ell_{21}+4,\\,-3\\ell_{21}+5]=[4,\\,6,\\,-1].\n$$\n令各分量相等，可得\n$$\n2\\ell_{21}=4 \\;\\Rightarrow\\; \\ell_{21}=2,\n$$\n并且一致性检验 $\\ell_{21}+4=6$ 和 $-3\\ell_{21}+5=-1$ 在 $\\ell_{21}=2$ 时成立。\n\n$LU$ 的第3行等于 $\\ell_{31}\\,\\text{row}_{1}(U)+\\ell_{32}\\,\\text{row}_{2}(U)+\\text{row}_{3}(U)$，所以\n$$\n[2\\ell_{31},\\,\\ell_{31}+4\\ell_{32},\\,-3\\ell_{31}+5\\ell_{32}-2]=[-2,\\,11,\\,16].\n$$\n令各分量相等，得到\n$$\n2\\ell_{31}=-2 \\;\\Rightarrow\\; \\ell_{31}=-1,\n$$\n$$\n\\ell_{31}+4\\ell_{32}=11 \\;\\Rightarrow\\; -1+4\\ell_{32}=11 \\;\\Rightarrow\\; \\ell_{32}=3,\n$$\n并且检验第三个分量：\n$$\n-3(-1)+5(3)-2=3+15-2=16.\n$$\n\n因此，\n$$\nL=\\begin{pmatrix}\n1 & 0 & 0 \\\\\n2 & 1 & 0 \\\\\n-1 & 3 & 1\n\\end{pmatrix},\n$$\n这对应于选项 A。", "answer": "$$\\boxed{A}$$", "id": "2204087"}, {"introduction": "在理解了分解的构成之后，下一步是应用它来解决实际问题。本练习的核心在于利用已知的 $L$ 和 $U$ 因子来求解线性系统 $Ax=b$。这展示了 LU 分解如何将一个复杂的求解问题，优雅地转化为求解两个更简单的三角系统（即通过前向替换和后向替换）的过程。[@problem_id:2204086]", "problem": "一个线性方程组由矩阵方程 $Ax=b$ 给出。矩阵 $A$ 已被分解为一个下三角矩阵 $L$ 和一个上三角矩阵 $U$ 的乘积，使得 $A=LU$。这种特定类型的 LU 分解（Lower-Upper factorization）是上三角矩阵 $U$ 的主对角线上元素均为1的分解。\n\n给定矩阵 $L$、$U$ 和向量 $b$ 如下：\n$$\nL = \\begin{pmatrix} 2 & 0 & 0 \\\\ -1 & 3 & 0 \\\\ 4 & -2 & 1 \\end{pmatrix}, \\quad U = \\begin{pmatrix} 1 & 2 & -1 \\\\ 0 & 1 & 3 \\\\ 0 & 0 & 1 \\end{pmatrix}, \\quad \\text{和} \\quad b = \\begin{pmatrix} -4 \\\\ 5 \\\\ -9 \\end{pmatrix}\n$$\n求解放向量 $x = \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\end{pmatrix}$。", "solution": "我们已知 $A=LU$，其中 $L$ 是下三角矩阵，$U$ 是主对角线上元素为1的上三角矩阵，我们需要求解 $Ax=b$。定义 $y=Ux$。那么可以通过前向替换法求解 $Ly=b$，然后通过后向替换法求解 $Ux=y$。\n\n首先求解 $Ly=b$，其中\n$$\nL=\\begin{pmatrix} 2 & 0 & 0 \\\\ -1 & 3 & 0 \\\\ 4 & -2 & 1 \\end{pmatrix},\\quad\ny=\\begin{pmatrix}y_{1}\\\\y_{2}\\\\y_{3}\\end{pmatrix},\\quad\nb=\\begin{pmatrix}-4\\\\5\\\\-9\\end{pmatrix}.\n$$\n写出该方程组：\n$$\n2y_{1}=-4,\\quad -y_{1}+3y_{2}=5,\\quad 4y_{1}-2y_{2}+y_{3}=-9.\n$$\n由第一个方程可得，\n$$\ny_{1}=\\frac{-4}{2}=-2.\n$$\n代入第二个方程：\n$$\n-(-2)+3y_{2}=5\\;\\Rightarrow\\;2+3y_{2}=5\\;\\Rightarrow\\;3y_{2}=3\\;\\Rightarrow\\;y_{2}=1.\n$$\n将 $y_{1}$ 和 $y_{2}$ 代入第三个方程：\n$$\n4(-2)-2(1)+y_{3}=-9\\;\\Rightarrow\\;-8-2+y_{3}=-9\\;\\Rightarrow\\;-10+y_{3}=-9\\;\\Rightarrow\\;y_{3}=1.\n$$\n因此，\n$$\ny=\\begin{pmatrix}-2\\\\1\\\\1\\end{pmatrix}.\n$$\n\n接下来求解 $Ux=y$，其中\n$$\nU=\\begin{pmatrix} 1 & 2 & -1 \\\\ 0 & 1 & 3 \\\\ 0 & 0 & 1 \\end{pmatrix},\\quad\nx=\\begin{pmatrix}x_{1}\\\\x_{2}\\\\x_{3}\\end{pmatrix},\\quad\ny=\\begin{pmatrix}-2\\\\1\\\\1\\end{pmatrix}.\n$$\n写出该方程组：\n$$\nx_{3}=1,\\quad x_{2}+3x_{3}=1,\\quad x_{1}+2x_{2}-x_{3}=-2.\n$$\n由第三行可得，\n$$\nx_{3}=1.\n$$\n由第二行可得，\n$$\nx_{2}+3(1)=1\\;\\Rightarrow\\;x_{2}=-2.\n$$\n由第一行可得，\n$$\nx_{1}+2(-2)-1=-2\\;\\Rightarrow\\;x_{1}-4-1=-2\\;\\Rightarrow\\;x_{1}-5=-2\\;\\Rightarrow\\;x_{1}=3.\n$$\n因此，解向量为 $x=\\begin{pmatrix}3\\\\-2\\\\1\\end{pmatrix}$。", "answer": "$$\\boxed{\\begin{pmatrix} 3 \\\\ -2 \\\\ 1 \\end{pmatrix}}$$", "id": "2204086"}, {"introduction": "在实际的数值计算中，由于有限精度算术的影响，我们得到的解往往只是一个近似值。这个练习将带你探索一种提高解精度的高级技术：迭代求精。你将学习如何利用已经计算出的 $L$ 和 $U$ 因子高效地计算误差并修正初始解，这突显了 LU 分解在应对现实世界计算挑战时的强大实用性。[@problem_id:2204084]", "problem": "一位数值分析师的任务是求解线性方程组 $Ax = b$，其中矩阵 $A$ 和向量 $b$ 如下所示：\n$$\nA = \\begin{pmatrix} 4 & 2 & 1 \\\\ 8 & 6 & 4 \\\\ 4 & 4 & 5 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 1 \\\\ 3 \\\\ 6 \\end{pmatrix}\n$$\n该分析师首先计算矩阵 $A$ 的下三角-上三角 (LU) 分解，使得 $A=LU$，得到：\n$$\nL = \\begin{pmatrix} 1 & 0 & 0 \\\\ 2 & 1 & 0 \\\\ 1 & 1 & 1 \\end{pmatrix}, \\quad U = \\begin{pmatrix} 4 & 2 & 1 \\\\ 0 & 2 & 2 \\\\ 0 & 0 & 2 \\end{pmatrix}\n$$\n使用这些分解因子，计算出一个初始解 $\\tilde{x}^{(0)}$。然而，由于有限精度算法的限制，这个解只是一个近似值：\n$$\n\\tilde{x}^{(0)} = \\begin{pmatrix} 0.51 \\\\ -1.55 \\\\ 2.02 \\end{pmatrix}\n$$\n为了提高精度，请执行恰好一步迭代改进来计算新的近似解 $\\tilde{x}^{(1)}$。请给出改进后解向量 $\\tilde{x}^{(1)} = (x^{(1)}_1, x^{(1)}_2, x^{(1)}_3)^T$ 的三个分量。将每个分量四舍五入到四位有效数字。", "solution": "迭代改进的原理是计算当前近似解的误差，并将其作为修正量。设 $\\tilde{x}^{(0)}$ 是初始近似解。真实解 $x$ 可以写成 $x = \\tilde{x}^{(0)} + e$，其中 $e$ 是误差向量。将此代入原方程 $Ax=b$ 得到 $A(\\tilde{x}^{(0)} + e) = b$，整理后为 $Ae = b - A\\tilde{x}^{(0)}$。项 $r = b - A\\tilde{x}^{(0)}$ 称为残差向量。迭代改进过程包括三个主要步骤：\n\n1.  计算残差 $r$。\n2.  求解线性系统 $Ae = r$ 以得到误差向量 $e$。\n3.  更新解：$\\tilde{x}^{(1)} = \\tilde{x}^{(0)} + e$。\n\n**步骤 1：计算残差**\n首先，我们计算乘积 $A\\tilde{x}^{(0)}$：\n$$\nA\\tilde{x}^{(0)} = \\begin{pmatrix} 4 & 2 & 1 \\\\ 8 & 6 & 4 \\\\ 4 & 4 & 5 \\end{pmatrix} \\begin{pmatrix} 0.51 \\\\ -1.55 \\\\ 2.02 \\end{pmatrix}\n= \\begin{pmatrix} 4(0.51) + 2(-1.55) + 1(2.02) \\\\ 8(0.51) + 6(-1.55) + 4(2.02) \\\\ 4(0.51) + 4(-1.55) + 5(2.02) \\end{pmatrix}\n= \\begin{pmatrix} 2.04 - 3.10 + 2.02 \\\\ 4.08 - 9.30 + 8.08 \\\\ 2.04 - 6.20 + 10.10 \\end{pmatrix}\n= \\begin{pmatrix} 0.96 \\\\ 2.86 \\\\ 5.94 \\end{pmatrix}\n$$\n现在，我们计算残差 $r = b - A\\tilde{x}^{(0)}$：\n$$\nr = \\begin{pmatrix} 1 \\\\ 3 \\\\ 6 \\end{pmatrix} - \\begin{pmatrix} 0.96 \\\\ 2.86 \\\\ 5.94 \\end{pmatrix} = \\begin{pmatrix} 0.04 \\\\ 0.14 \\\\ 0.06 \\end{pmatrix}\n$$\n\n**步骤 2：求解误差向量**\n我们需要求解系统 $Ae=r$。由于已经给出了 $A$ 的 LU 分解 ($A=LU$)，我们可以高效地求解该系统而无需对 $A$ 求逆。我们通过先求解 $Ly=r$ 得到 $y$ (前向代入)，然后求解 $Ue=y$ 得到 $e$ (后向代入) 来解出 $LUe=r$。\n\n首先，求解 $Ly=r$：\n$$\n\\begin{pmatrix} 1 & 0 & 0 \\\\ 2 & 1 & 0 \\\\ 1 & 1 & 1 \\end{pmatrix} \\begin{pmatrix} y_1 \\\\ y_2 \\\\ y_3 \\end{pmatrix} = \\begin{pmatrix} 0.04 \\\\ 0.14 \\\\ 0.06 \\end{pmatrix}\n$$\n根据第一行：$y_1 = 0.04$。\n根据第二行：$2y_1 + y_2 = 0.14 \\implies y_2 = 0.14 - 2(0.04) = 0.14 - 0.08 = 0.06$。\n根据第三行：$y_1 + y_2 + y_3 = 0.06 \\implies y_3 = 0.06 - y_1 - y_2 = 0.06 - 0.04 - 0.06 = -0.04$。\n所以，中间向量为 $y = \\begin{pmatrix} 0.04 \\\\ 0.06 \\\\ -0.04 \\end{pmatrix}$。\n\n接下来，求解 $Ue=y$：\n$$\n\\begin{pmatrix} 4 & 2 & 1 \\\\ 0 & 2 & 2 \\\\ 0 & 0 & 2 \\end{pmatrix} \\begin{pmatrix} e_1 \\\\ e_2 \\\\ e_3 \\end{pmatrix} = \\begin{pmatrix} 0.04 \\\\ 0.06 \\\\ -0.04 \\end{pmatrix}\n$$\n从第三行（回代）：$2e_3 = -0.04 \\implies e_3 = -0.02$。\n从第二行：$2e_2 + 2e_3 = 0.06 \\implies 2e_2 = 0.06 - 2(-0.02) = 0.06 + 0.04 = 0.10 \\implies e_2 = 0.05$。\n从第一行：$4e_1 + 2e_2 + e_3 = 0.04 \\implies 4e_1 = 0.04 - 2(0.05) - (-0.02) = 0.04 - 0.10 + 0.02 = -0.04 \\implies e_1 = -0.01$。\n误差向量为 $e = \\begin{pmatrix} -0.01 \\\\ 0.05 \\\\ -0.02 \\end{pmatrix}$。\n\n**步骤 3：更新解**\n改进后的解 $\\tilde{x}^{(1)}$ 是初始解与误差向量之和：\n$$\n\\tilde{x}^{(1)} = \\tilde{x}^{(0)} + e = \\begin{pmatrix} 0.51 \\\\ -1.55 \\\\ 2.02 \\end{pmatrix} + \\begin{pmatrix} -0.01 \\\\ 0.05 \\\\ -0.02 \\end{pmatrix} = \\begin{pmatrix} 0.51 - 0.01 \\\\ -1.55 + 0.05 \\\\ 2.02 - 0.02 \\end{pmatrix} = \\begin{pmatrix} 0.50 \\\\ -1.50 \\\\ 2.00 \\end{pmatrix}\n$$\n问题要求将每个分量四舍五入到四位有效数字。\n第一个分量是 $0.50$，保留四位有效数字为 $0.5000$。\n第二个分量是 $-1.50$，保留四位有效数字为 $-1.500$。\n第三个分量是 $2.00$，保留四位有效数字为 $2.000$。\n因此，改进后的解向量为 $\\tilde{x}^{(1)} = (0.5000, -1.500, 2.000)^T$。", "answer": "$$\\boxed{\\begin{pmatrix} 0.5000 \\\\ -1.500 \\\\ 2.000 \\end{pmatrix}}$$", "id": "2204084"}]}