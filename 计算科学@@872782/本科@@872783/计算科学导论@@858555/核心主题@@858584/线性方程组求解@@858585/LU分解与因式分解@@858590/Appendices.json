{"hands_on_practices": [{"introduction": "本练习旨在从头开始建立对 LU 分解的基本理解。通过手动计算一个具体示例中 $L$ 和 $U$ 矩阵的元素 ([@problem_id:3156996])，你将对分解过程的机理有一个具体的感受。这个练习还会促使你思考分解存在性和唯一性的条件，将计算过程与基本的线性代数原理联系起来。", "problem": "考虑一个方阵 $A \\in \\mathbb{R}^{3 \\times 3}$，将其进行下三角-上三角（LU）分解，即 $A = L U$，其中 $L$ 是下三角矩阵，$U$ 是上三角矩阵。您需要强制执行归一化约束，即 $U$ 的对角线元素全部等于 $1$，即 $u_{11} = u_{22} = u_{33} = 1$。这种归一化在计算实践中很常见，因为它将所有的主元缩放转移到了 $L$ 的对角线上。请在不进行行交换（即不选主元）且给定矩阵 $A$ 的分解存在的标准假设下进行计算。\n\n从矩阵乘法和三角结构的核心定义出发，并且只使用线性代数中已经过验证的结论（例如行列式的乘法性质和三角矩阵的行列式），按以下步骤进行：\n\n- 设\n$$A = \\begin{pmatrix}\n4  -2  6 \\\\\n8  -5  14 \\\\\n2  1  3\n\\end{pmatrix}, \\quad\nL = \\begin{pmatrix}\n\\ell_{11}  0  0 \\\\\n\\ell_{21}  \\ell_{22}  0 \\\\\n\\ell_{31}  \\ell_{32}  \\ell_{33}\n\\end{pmatrix}, \\quad\nU = \\begin{pmatrix}\n1  u_{12}  u_{13} \\\\\n0  1  u_{23} \\\\\n0  0  1\n\\end{pmatrix}.$$\n- 通过逐个元素地令 $A = L U$ 相等，并仅使用矩阵乘法的定义和三角结构，求解相容的元素 $\\ell_{ij}$ 和 $u_{ij}$。\n\n- 从基本定义出发，解释在 $u_{ii} = 1$ 的归一化条件下，LU 分解在何种意义上是唯一的，以及为确保在不选主元的情况下分解存在且唯一，需要对 $A$ 施加什么约束（用顺序主子式来表述）。您的讨论应基于三角矩阵和行列式的定义与性质，不应依赖任何预先给出的 LU 公式。\n\n- 作为最终的数值结果，计算 $A$ 的行列式。请将最终答案表示为一个精确的整数，无需四舍五入。", "solution": "此问题是有效的，因为它在科学上基于线性代数，提法恰当且客观。它为执行LU分解、分析其性质和计算行列式提供了一个完整且一致的框架。我将开始解答。\n\n该问题要求基于矩阵 $A$ 分解为一个下三角矩阵 $L$ 和一个单位上三角矩阵 $U$（即 $A = LU$）来完成三项任务。\n\n首先，我们必须对给定的矩阵 $A$ 求解 $L$ 和 $U$ 中的未知元素。\n给定的矩阵是：\n$$A = \\begin{pmatrix} 4  -2  6 \\\\ 8  -5  14 \\\\ 2  1  3 \\end{pmatrix}, \\quad L = \\begin{pmatrix} \\ell_{11}  0  0 \\\\ \\ell_{21}  \\ell_{22}  0 \\\\ \\ell_{31}  \\ell_{32}  \\ell_{33} \\end{pmatrix}, \\quad U = \\begin{pmatrix} 1  u_{12}  u_{13} \\\\ 0  1  u_{23} \\\\ 0  0  1 \\end{pmatrix}$$\n\n分解式 $A=LU$ 表示为：\n$$ \\begin{pmatrix} 4  -2  6 \\\\ 8  -5  14 \\\\ 2  1  3 \\end{pmatrix} = \\begin{pmatrix} \\ell_{11}  0  0 \\\\ \\ell_{21}  \\ell_{22}  0 \\\\ \\ell_{31}  \\ell_{32}  \\ell_{33} \\end{pmatrix} \\begin{pmatrix} 1  u_{12}  u_{13} \\\\ 0  1  u_{23} \\\\ 0  0  1 \\end{pmatrix} $$\n根据矩阵乘法的定义，乘积 $LU$ 的元素由 $(LU)_{ij} = \\sum_{k=1}^{3} L_{ik} U_{kj}$ 给出。我们将这些元素与 $A$ 的相应元素 $a_{ij}$ 相等。$L$ 和 $U$ 的三角结构显著简化了求和过程。\n\n我们通过依次确定 $L$ 的列和 $U$ 的行来进行计算。\n\n第1列：\n$a_{11} = \\ell_{11} u_{11} = \\ell_{11} \\cdot 1 \\implies \\ell_{11} = 4$。\n$a_{21} = \\ell_{21} u_{11} = \\ell_{21} \\cdot 1 \\implies \\ell_{21} = 8$。\n$a_{31} = \\ell_{31} u_{11} = \\ell_{31} \\cdot 1 \\implies \\ell_{31} = 2$。\n\n第1行：\n$a_{12} = \\ell_{11} u_{12} \\implies 4 u_{12} = -2 \\implies u_{12} = -\\frac{1}{2}$。\n$a_{13} = \\ell_{11} u_{13} \\implies 4 u_{13} = 6 \\implies u_{13} = \\frac{3}{2}$。\n\n第2列：\n$a_{22} = \\ell_{21} u_{12} + \\ell_{22} u_{22} = 8(-\\frac{1}{2}) + \\ell_{22}(1) = -4 + \\ell_{22}$。\n所以，$-5 = -4 + \\ell_{22} \\implies \\ell_{22} = -1$。\n$a_{32} = \\ell_{31} u_{12} + \\ell_{32} u_{22} = 2(-\\frac{1}{2}) + \\ell_{32}(1) = -1 + \\ell_{32}$。\n所以，$1 = -1 + \\ell_{32} \\implies \\ell_{32} = 2$。\n\n第2行：\n$a_{23} = \\ell_{21} u_{13} + \\ell_{22} u_{23} = 8(\\frac{3}{2}) + (-1)u_{23} = 12 - u_{23}$。\n所以，$14 = 12 - u_{23} \\implies u_{23} = -2$。\n\n第3列：\n$a_{33} = \\ell_{31} u_{13} + \\ell_{32} u_{23} + \\ell_{33} u_{33} = 2(\\frac{3}{2}) + 2(-2) + \\ell_{33}(1) = 3 - 4 + \\ell_{33} = -1 + \\ell_{33}$。\n所以，$3 = -1 + \\ell_{33} \\implies \\ell_{33} = 4$。\n\n所有未知元素都已确定。得到的矩阵是：\n$$ L = \\begin{pmatrix} 4  0  0 \\\\ 8  -1  0 \\\\ 2  2  4 \\end{pmatrix}, \\quad U = \\begin{pmatrix} 1  -\\frac{1}{2}  \\frac{3}{2} \\\\ 0  1  -2 \\\\ 0  0  1 \\end{pmatrix} $$\n\n第二，我们从基本定义出发解释唯一性和存在性条件。\n\n关于唯一性，假设一个非奇异矩阵 $A$ 存在两种这样的分解：$A = L_1 U_1$ 和 $A = L_2 U_2$。这里，$L_1$ 和 $L_2$ 是下三角矩阵，$U_1$ 和 $U_2$ 是单位上三角矩阵（对角线上元素为1的上三角矩阵）。\n从 $L_1 U_1 = L_2 U_2$，我们可以写出 $L_2^{-1} L_1 = U_2 U_1^{-1}$。\n下三角矩阵的逆是下三角矩阵，两个下三角矩阵的乘积也是下三角矩阵。因此，等式左侧的 $L_2^{-1} L_1$ 是一个下三角矩阵。\n单位上三角矩阵的逆是单位上三角矩阵，两个单位上三角矩阵的乘积也是单位上三角矩阵。因此，等式右侧的 $U_2 U_1^{-1}$ 是一个单位上三角矩阵。\n唯一一个既是下三角矩阵又是单位上三角矩阵的矩阵是单位矩阵 $I$。\n因此，我们必须有 $L_2^{-1} L_1 = I$ 和 $U_2 U_1^{-1} = I$。这些方程意味着 $L_1 = L_2$ 和 $U_1 = U_2$，这证明了如果分解存在，它是唯一的。这个证明依赖于 $L_2$ 和 $U_1$ 的可逆性。像 $U_1$ 这样的单位三角矩阵总是可逆的，因为它的行列式是 $1$。$L_2$ 的可逆性取决于其对角线元素非零。\n\n关于存在性，我们必须建立确保 $L$ 的对角线元素 $\\ell_{kk}$ 非零的条件，因为它们在计算过程中被用作除数。例如，我们计算了 $u_{12} = a_{12}/\\ell_{11}$。通常，对于 $j > k$ 的 $u_{kj}$ 的公式涉及除以 $\\ell_{kk}$。\n让我们将 $\\ell_{kk}$ 与 $A$ 的性质联系起来。考虑 $A$ 的 $k \\times k$ 顺序主子矩阵，记为 $A_k$。分解 $A=LU$ 意味着这些子矩阵也有一个分解。设 $L_k$ 和 $U_k$ 分别是 $L$ 和 $U$ 的 $k \\times k$ 顺序主子矩阵。矩阵乘法的结构意味着 $A_k = L_k U_k$。\n利用矩阵乘积的行列式等于其行列式乘积的性质，我们有 $\\det(A_k) = \\det(L_k) \\det(U_k)$。\n三角矩阵的行列式是其对角线元素的乘积。\n对于单位上三角矩阵 $U_k$，有 $\\det(U_k) = u_{11} u_{22} \\cdots u_{kk} = 1^k = 1$。\n对于 $L_k$，有 $\\det(L_k) = \\ell_{11} \\ell_{22} \\cdots \\ell_{kk}$。\n因此，我们找到了关键关系式：$\\det(A_k) = \\ell_{11} \\ell_{22} \\cdots \\ell_{kk}$。\n由此可得，对于 $k > 1$，有 $\\ell_{kk} = \\frac{\\det(A_k)}{\\det(A_{k-1})}$，且 $\\ell_{11} = \\det(A_1) = a_{11}$。\nLU分解算法（不选主元）按顺序计算 $\\ell_{ij}$ 和 $u_{ij}$。为了使算法可执行，我们必须能够解出每个未知数。这要求在每一步 $k$，对角线元素 $\\ell_{kk}$ 必须非零，因为它被用作除数来求解 $U$ 的第 $k$ 行的元素。\n对于所有 $k = 1, \\dots, n$，条件 $\\ell_{kk} \\neq 0$ 等价于条件 $\\det(A_k) \\neq 0$。\n因此，LU分解（其中 $u_{ii}=1$ 且不选主元）存在且唯一的充要条件是 $A$ 的所有顺序主子式都非零。\n\n第三，我们计算 $A$ 的行列式。\n利用性质 $\\det(A) = \\det(L) \\det(U)$，我们可以很容易地从分解中求出行列式。\n$L$ 的行列式是其对角线元素的乘积：\n$$ \\det(L) = \\ell_{11} \\ell_{22} \\ell_{33} = (4)(-1)(4) = -16 $$\n$U$ 的行列式是其对角线元素的乘积：\n$$ \\det(U) = u_{11} u_{22} u_{33} = (1)(1)(1) = 1 $$\n因此，$A$ 的行列式是：\n$$ \\det(A) = \\det(L) \\det(U) = (-16)(1) = -16 $$\n这就提供了所要求的数值结果。", "answer": "$$\\boxed{-16}$$", "id": "3156996"}, {"introduction": "虽然 LU 分解是一个强大的工具，但其数值稳定性是一个主要问题，尤其是在计算机上实现时。本练习探讨了一类特殊的矩阵——严格对角占优矩阵，对于这类矩阵，不进行主元选择的高斯消元法保证是稳定的 ([@problem_id:3156903])。你将从第一性原理出发证明这一性质，然后通过一个数值实验来亲身观察这种稳定性，即使在矩阵受到微小随机扰动时也是如此。", "problem": "要求您构造一个具体的方阵序列，并从第一性原理出发，论证无主元高斯消元法的存在性、唯一性和数值稳定性。然后，您将实现一个算法，在受控的随机扰动下对稳定性进行数值量化。所有数学符号、变量、运算符，甚至数字都必须使用 LaTeX 分隔符书写。\n\n任务 A (构造)。对于每个正整数 $n \\in \\{5,20,50\\}$，定义一个矩阵 $A_n \\in \\mathbb{R}^{n \\times n}$ 如下\n$$\n(A_n)_{ij} =\n\\begin{cases}\n3,  \\text{if } i=j, \\\\\n-1,  \\text{if } |i-j|=1, \\\\\n0,  \\text{otherwise}.\n\\end{cases}\n$$\n从核心定义和已充分验证的事实出发，证明每个 $A_n$ 都是按行严格对角占优且非奇异的。然后，对于 $\\{A_n\\}$ 这类矩阵，论证无主元高斯消元法对每个 $n$ 都能产生 $L U$ 分解，并且该消元过程是稳定的，即元素增长因子受一个与 $n$ 无关的适中常数限制。\n\n任务 B (从第一性原理推导稳定性)。仅使用核心定义和已充分验证的事实作为基础：\n1) 从按行严格对角占优的定义开始：一个矩阵 $A \\in \\mathbb{R}^{n \\times n}$ 是按行严格对角占优的，如果对于每个 $i \\in \\{1,\\dots,n\\}$，\n$$\n|a_{ii}| > \\sum_{j \\neq i} |a_{ij}|.\n$$\n2) 使用一个已充分验证的事实来证明 $A_n$ 的非奇异性，例如 Gershgorin Circle Theorem 或 Levy–Desplanques Theorem，这两个定理都表明按行严格对角占优可保证非奇异性。\n3) 考虑无主元高斯消元法的基本步骤。设 $A^{(k)}$ 是经过 $k-1$ 步消元后的矩阵，其主元为 $a^{(k)}_{kk} \\neq 0$，乘子为 $m_{ik} = a^{(k)}_{ik}/a^{(k)}_{kk}$（其中 $i>k$）。Schur 补更新公式为\n$$\na^{(k+1)}_{ij} = a^{(k)}_{ij} - m_{ik} a^{(k)}_{kj}, \\quad \\text{for } i,j > k.\n$$\n根据这些关系以及 $A^{(k)}$ 的按行严格对角占优性质，推导出 $|m_{ik}|  1$ 并且严格对角占优性质在后续子矩阵中得以保持。通过归纳法得出结论：不会出现零主元，因此对于 $A_n$ 存在无主元的 $L U$ 分解。\n4) 定义元素增长因子\n$$\n\\gamma = \\frac{\\max_{i,j} |u_{ij}|}{\\max_{i,j} |a_{ij}|},\n$$\n其中 $U$ 是无主元消元法产生的上三角因子。利用由严格对角占优性质得到的乘子界 $|m_{ik}|1$，将 $\\gamma$ 的上界限定为一个适中的常数（例如，证明对于此类矩阵，在不考虑有限精度算术中的舍入效应时，$\\gamma \\leq 2$）。\n\n任务 C (随机扰动下的数值实验)。对于每个 $n \\in \\{5,20,50\\}$ 和每个扰动水平 $\\varepsilon \\in \\{10^{-12},10^{-8},10^{-6}\\}$，执行以下操作：\n1) 按照任务 A 的方式构造 $A_n$。\n2) 构造一个随机扰动矩阵 $E \\in \\mathbb{R}^{n \\times n}$，其元素从标准正态分布中抽取，并缩放 $E$ 使其谱范数满足\n$$\n\\|E\\|_2 = \\varepsilon \\|A_n\\|_2.\n$$\n3) 构成扰动矩阵 $\\widetilde{A} = A_n + E$。生成一个随机的右端项 $b \\in \\mathbb{R}^n$，其元素为独立的标准正态分布。\n4) 计算 $\\widetilde{A}$ 的无主元 $L U$ 分解（请自行实现高斯消元法；不要调用任何执行主元选择的库例程），并求解 $\\widetilde{A} x = b$。\n5) 计算元素增长因子\n$$\n\\gamma = \\frac{\\max_{i,j} |U_{ij}|}{\\max_{i,j} |\\widetilde{A}_{ij}|}.\n$$\n6) 计算相对于未扰动矩阵 $A_n$ 的缩放后向残差，\n$$\n\\eta = \\frac{\\|A_n x - b\\|_2}{\\|A_n\\|_2 \\|x\\|_2 + \\|b\\|_2}.\n$$\n7) 对于每个测试用例，如果以下两个条件都成立，则认为该消元过程是数值稳定的：\n   a) $\\gamma \\leq 2.1$,\n   b) $\\eta \\leq 1.5 \\varepsilon$.\n\n测试套件与输出。使用以下给定的测试用例 $(n,\\varepsilon,\\text{seed})$：\n$$\n(5,10^{-12},0), \\quad (5,10^{-8},1), \\quad (5,10^{-6},2), \\quad (20,10^{-12},3), \\quad (20,10^{-8},4), \\quad (20,10^{-6},5), \\quad (50,10^{-12},6), \\quad (50,10^{-8},7), \\quad (50,10^{-6},8).\n$$\n对于每个三元组，在创建 $E$ 和 $b$ 之前，使用给定的整数种子设置伪随机数生成器。您的程序必须产生单行输出，其中包含九个布尔结果，每个结果对应于按所列顺序的一个测试用例，每个布尔值指示该用例是否通过了步骤 7 中的两个稳定性检查。要求的格式是用方括号括起来的逗号分隔列表，例如 $[{\\tt True},{\\tt False},\\dots]$。不应打印任何其他文本。", "solution": "在提供解决方案之前，需对问题进行验证。\n\n### 步骤 1：提取已知条件\n- **矩阵定义**：对于每个正整数 $n \\in \\{5, 20, 50\\}$，矩阵 $A_n \\in \\mathbb{R}^{n \\times n}$ 定义如下\n$$\n(A_n)_{ij} =\n\\begin{cases}\n3,  \\text{if } i=j, \\\\\n-1,  \\text{if } |i-j|=1, \\\\\n0,  \\text{otherwise}.\n\\end{cases}\n$$\n- **严格对角占优 (SDD) 定义**：一个矩阵 $A \\in \\mathbb{R}^{n \\times n}$ 是按行严格对角占优的，如果对于每个 $i \\in \\{1, \\dots, n\\}$，都有 $|a_{ii}| > \\sum_{j \\neq i} |a_{ij}|$。\n- **高斯消元步骤**：Schur 补更新为 $a^{(k+1)}_{ij} = a^{(k)}_{ij} - m_{ik} a^{(k)}_{kj}$，其中 $i,j > k$，且 $m_{ik} = a^{(k)}_{ik}/a^{(k)}_{kk}$。\n- **增长因子定义**：$\\gamma = \\frac{\\max_{i,j} |u_{ij}|}{\\max_{i,j} |a_{ij}|}$。\n- **扰动缩放**：对于一个随机扰动矩阵 $E$，其谱范数被缩放以满足 $\\|E\\|_2 = \\varepsilon \\|A_n\\|_2$。\n- **缩放后向残差**：$\\eta = \\frac{\\|A_n x - b\\|_2}{\\|A_n\\|_2 \\|x\\|_2 + \\|b\\|_2}$。\n- **数值稳定性条件**：\n  1. 增长因子 $\\gamma \\leq 2.1$。\n  2. 缩放后向残差 $\\eta \\leq 1.5 \\varepsilon$。\n- **测试套件**：一个包含 $9$ 个元组 $(n, \\varepsilon, \\text{seed})$ 的列表：$(5, 10^{-12}, 0)$、$(5, 10^{-8}, 1)$、$(5, 10^{-6}, 2)$、$(20, 10^{-12}, 3)$、$(20, 10^{-8}, 4)$、$(20, 10^{-6}, 5)$、$(50, 10^{-12}, 6)$、$(50, 10^{-8}, 7)$、$(50, 10^{-6}, 8)$。\n\n### 步骤 2：使用提取的已知条件进行验证\n1.  **科学依据**：该问题牢固地植根于数值线性代数的原理。它涉及 LU 分解、高斯消元法、严格对角占优、Gershgorin Circle Theorem、元素增长因子和后向误差分析等标准定义和概念。所有这些概念都是计算科学的基石。矩阵 $A_n$ 是一个著名的对称三对角矩阵，常被用作模型问题（例如，来自一维 Poisson 方程的离散化）。\n2.  **适定性**：理论任务（A 和 B）是针对一个特定、明确定义的矩阵类的标准证明。数值任务（C）是一个完全指定的计算实验。所有参数（$n$, $\\varepsilon$）、初始条件（随机种子）和评估指标（带有阈值的 $\\gamma$, $\\eta$）都已明确提供，确保可以获得一个唯一的、确定性的、有意义的解。\n3.  **客观性**：问题以精确、形式化的数学语言陈述，没有任何主观性或歧义。\n\n问题陈述没有显示任何缺陷。它在科学上是合理的、适定的、客观的、完整的，并且与指定主题相关。\n\n### 步骤 3：结论与行动\n问题有效。将提供完整解答。\n\n---\n\n### 任务 A 和 B：理论分析\n\n这里我们将任务 A 和 B 中要求的证明合并，因为它们在逻辑上是连续的。我们首先按照规定定义矩阵 $A_n$（对于 $n \\in \\mathbb{Z}^+$）：\n$$\n(A_n)_{ij} =\n\\begin{cases}\n3,  \\text{if } i=j, \\\\\n-1,  \\text{if } |i-j|=1, \\\\\n0,  \\text{otherwise}.\n\\end{cases}\n$$\n这是一个对称三对角矩阵。\n\n**$A_n$ 的严格对角占优性**\n\n如果一个矩阵 $A$ 的每一行 $i$ 中，对角元素的绝对值都严格大于该行所有其他元素的绝对值之和，即 $|a_{ii}| > \\sum_{j \\neq i} |a_{ij}|$，则该矩阵是按行严格对角占优 (SDD) 的。我们来验证 $A_n$ 是否满足此条件。\n\n- 对于第一行 ($i=1$)，对角元素为 $(A_n)_{11} = 3$。唯一的非零非对角元素是 $(A_n)_{12} = -1$。非对角元素的绝对值之和为 $\\sum_{j \\neq 1} |(A_n)_{1j}| = |(A_n)_{12}| = |-1| = 1$。我们必须检查 $|(A_n)_{11}| > 1$ 是否成立。由于 $|3| = 3 > 1$，该条件对 $i=1$ 成立。\n- 对于最后一行 ($i=n$)，对角元素为 $(A_n)_{nn} = 3$。唯一的非零非对角元素是 $(A_n)_{n,n-1} = -1$。和为 $\\sum_{j \\neq n} |(A_n)_{nj}| = |(A_n)_{n,n-1}| = |-1| = 1$。我们检查 $|(A_n)_{nn}| > 1$ 是否成立。由于 $|3| = 3 > 1$，该条件对 $i=n$ 成立。\n- 对于任意内部行 ($1  i  n$)，对角元素为 $(A_n)_{ii} = 3$。非零非对角元素为 $(A_n)_{i,i-1} = -1$ 和 $(A_n)_{i,i+1} = -1$。绝对值之和为 $\\sum_{j \\neq i} |(A_n)_{ij}| = |(A_n)_{i,i-1}| + |(A_n)_{i,i+1}| = |-1| + |-1| = 2$。我们检查 $|(A_n)_{ii}| > 2$ 是否成立。由于 $|3| = 3 > 2$，该条件成立。\n\n由于该条件对所有行 $i \\in \\{1, \\dots, n\\}$ 都成立，因此对于任意 $n \\ge 2$，矩阵 $A_n$ 都是按行严格对角占优的。\n\n**$A_n$ 的非奇异性**\n\nLevy–Desplanques 定理指出，任何按行严格对角占优的矩阵都是非奇异的。由于我们已经证明对于任意 $n \\ge 2$，$A_n$ 都是 SDD 的，因此根据该定理直接可得 $A_n$ 是非奇异的。对于 $n=1$ 的情况也成立，此时 $A_1 = [3]$ 显然是非奇异的。\n\n**无主元 LU 分解的存在性**\n\n当且仅当一个矩阵的所有前导主子矩阵都是非奇异的，无主元高斯消元法才能成功执行。设 $A_k$ 表示 $A_n$ 的 $k \\times k$ 前导主子矩阵。$A_k$ 由 $A_n$ 的前 $k$ 行和前 $k$ 列构成。$A_k$ 的结构与我们定义的 $A_n$ 矩阵相同，只是大小为 $k \\times k$。如上所示，任何这样的矩阵 $A_k$（对于 $k \\ge 1$）都是严格对角占优的，因此是非奇异的。由于 $A_n$ 的所有前导主子矩阵都是非奇异的，因此可以对 $A_n$ 执行无主元高斯消元法，从而产生 $LU$ 分解。\n\n**严格对角占优性的保持与乘子的有界性**\n\n我们通过归纳法证明，在消元过程中产生的 Schur 补仍然是 SDD 的。设 $A^{(1)} = A_n$。在消元的第 $k$ 步，我们得到矩阵 $A^{(k)}$。假设 $A^{(k)}$ 的大小为 $(n-k+1) \\times (n-k+1)$ 的后续子矩阵是 SDD 的。我们称这个子矩阵为 $S^{(k)}$。主元是 $a_{kk}^{(k)}$。乘子是 $m_{ik} = a_{ik}^{(k)}/a_{kk}^{(k)}$，其中 $i > k$。下一个 Schur 补 $S^{(k+1)}$ 的元素由 $a_{ij}^{(k+1)} = a_{ij}^{(k)} - m_{ik}a_{kj}^{(k)}$ 给出，其中 $i,j > k$。\n\n对于 $S^{(k+1)}$ 中的任意行 $i > k$，新的对角元素是 $a_{ii}^{(k+1)}$，非对角元素绝对值之和为 $\\sum_{j>k, j \\neq i} |a_{ij}^{(k+1)}|$。我们有：\n$$ |a_{ii}^{(k+1)}| = |a_{ii}^{(k)} - m_{ik}a_{ki}^{(k)}| \\ge |a_{ii}^{(k)}| - |m_{ik}||a_{ki}^{(k)}| $$\n$$ \\sum_{j>k, j \\neq i} |a_{ij}^{(k+1)}| = \\sum_{j>k, j \\neq i} |a_{ij}^{(k)} - m_{ik}a_{kj}^{(k)}| \\le \\sum_{j>k, j \\neq i} |a_{ij}^{(k)}| + |m_{ik}|\\sum_{j>k, j \\neq i} |a_{kj}^{(k)}| $$\n由于 $S^{(k)}$ 是 SDD 的，我们有 $|a_{ii}^{(k)}| > \\sum_{j \\ge k, j \\neq i} |a_{ij}^{(k)}|$ 和 $|a_{kk}^{(k)}| > \\sum_{j > k} |a_{kj}^{(k)}|$。\n证明 $|a_{ii}^{(k+1)}| > \\sum_{j>k, j \\neq i} |a_{ij}^{(k+1)}|$ 依赖于证明\n$|a_{ii}^{(k)}| - |m_{ik}||a_{ki}^{(k)}| > \\sum_{j>k, j \\neq i} |a_{ij}^{(k)}| + |m_{ik}|\\sum_{j>k, j \\neq i} |a_{kj}^{(k)}|$。\n代入 SDD 性质 $|a_{ii}^{(k)}| > |a_{ik}^{(k)}| + \\sum_{j>k, j \\neq i} |a_{ij}^{(k)}|$，这等价于证明：\n$|a_{ik}^{(k)}| - |m_{ik}||a_{ki}^{(k)}| > |m_{ik}|\\sum_{j>k, j \\neq i} |a_{kj}^{(k)}|$，这可以简化为 $|a_{kk}^{(k)}| > \\sum_{j>k} |a_{kj}^{(k)}|$，即主元行的 SDD 属性。因此，SDD 在所有 Schur 补中都得以保持。\n\n对于特定的矩阵 $A_n$，其结构简化了分析。在第 $k$ 步，活动子矩阵是三对角的。第 $k$ 列中对角线下唯一的非零元素是 $a_{k+1,k}^{(k)}=-1$。对于 $i > k+1$，所有其他的 $a_{ik}^{(k)}=0$。因此，唯一的非零乘子是 $m_{k+1,k} = a_{k+1,k}^{(k)}/a_{kk}^{(k)} = -1/a_{kk}^{(k)}$。\n主元 $d_k = a_{kk}^{(k)}$ 遵循一个递推关系。\n$d_1 = (A_n)_{11} = 3$。\n在第 1 步，更新只影响第 2 行：$a_{2j}^{(2)} = a_{2j}^{(1)} - m_{21}a_{1j}^{(1)}$。\n$d_2 = a_{22}^{(2)} = a_{22}^{(1)} - m_{21}a_{12}^{(1)} = 3 - (-1/3)(-1) = 3 - 1/3 = 8/3$。\n新的非对角元素是 $a_{23}^{(2)} = a_{23}^{(1)} - m_{21}a_{13}^{(1)} = -1 - (-1/3)(0) = -1$。\n这个过程继续下去，在第 $k$ 步，主元是 $d_k = a_{kk}^{(k)}$，非对角元素是 $a_{k,k+1}^{(k)}=-1$。下一个主元是 $d_{k+1} = a_{k+1,k+1}^{(k+1)} = a_{k+1,k+1}^{(k)} - m_{k+1,k}a_{k,k+1}^{(k)} = 3 - (-1/d_k)(-1) = 3 - 1/d_k$。\n主元序列为 $d_1=3$，$d_2=8/3 \\approx 2.667$，$d_3=3-3/8=21/8=2.625$。这个序列是单调递减的，并收敛到 $d=3-1/d$ 的较大根，即 $d=(3+\\sqrt{5})/2 \\approx 2.618$。\n因此，对于所有的 $k$，我们有 $(3+\\sqrt{5})/2 \\le d_k \\le 3$。\n唯一的非零乘子是 $m_{k+1,k} = -1/d_k$。它们的绝对值为 $|m_{k+1,k}| = 1/d_k \\le 1/((3+\\sqrt{5})/2) = 2/(3+\\sqrt{5}) = (3-\\sqrt{5})/2 \\approx 0.382  1$。\n这证明了所有乘子的绝对值都被一个严格小于 1 的常数所界定。\n\n**元素增长因子的界**\n\n增长因子为 $\\gamma = \\max_{i,j} |u_{ij}| / \\max_{i,j} |a_{ij}|$。对于 $A_n$，$\\max_{i,j} |(A_n)_{ij}| = 3$。\n消元产生的矩阵 $U$ 的元素为 $u_{ij} = a_{ij}^{(i)}$。\n对角线元素是主元 $u_{ii} = d_i$。我们发现 $(3+\\sqrt{5})/2 \\le d_i \\le 3$。\n非对角元素是 $u_{ij}$，其中 $j>i$。唯一的非零非对角元素位于第一超对角线上。让我们追踪它们的值。在第 $k$ 步，$u_{k,k+1} = a_{k,k+1}^{(k)}$。\n对于 $k=1$，$u_{12}=a_{12}^{(1)}=-1$。\n对于 $k=2$，$u_{23}=a_{23}^{(2)} = a_{23}^{(1)} - m_{21}a_{13}^{(1)} = -1 - (-1/3)(0) = -1$。\n通过归纳法，可以看出对于这种三对角矩阵，消元过程不会改变超对角线元素：对于所有 $i$，$u_{i,i+1} = -1$。\n矩阵 $U$ 是一个上双对角矩阵：\n$$\nU =\n\\begin{pmatrix}\nd_1  -1  0  \\dots \\\\\n0  d_2  -1  \\\\\n\\vdots   \\ddots  \\ddots \\\\\n   d_{n-1}  -1 \\\\\n0  \\dots   0  d_n\n\\end{pmatrix}\n$$\n$U$ 的元素是主元 $d_i \\in [(3+\\sqrt{5})/2, 3]$ 和 $-1$。\n因此，$\\max_{i,j} |u_{ij}| = \\max(d_1, |-1|) = \\max(3,1) = 3$。\n增长因子为 $\\gamma = \\frac{\\max_{i,j} |u_{ij}|}{\\max_{i,j} |(A_n)_{ij}|} = \\frac{3}{3} = 1$。\n这是一个非常稳定的情况。问题中要求的界 $\\gamma \\le 2$ 显然是满足的，因为 $\\gamma=1$。对于扰动矩阵 $\\widetilde{A}$，预计其增长因子也接近于 $1$。\n\n### 任务 C：数值实验设计\n\n对于每个测试用例 $(n, \\varepsilon, \\text{seed})$，实现将遵循以下步骤：\n1.  为保证可复现性，设置随机种子。\n2.  构造矩阵 $A_n \\in \\mathbb{R}^{n \\times n}$。\n3.  生成一个随机矩阵 $E \\in \\mathbb{R}^{n \\times n}$，其元素来自 $\\mathcal{N}(0,1)$ 分布。\n4.  计算谱范数 $\\|A_n\\|_2$ 和 $\\|E\\|_2$。缩放 $E$ 得到 $E' = E \\cdot (\\varepsilon \\|A_n\\|_2 / \\|E\\|_2)$。\n5.  构成扰动矩阵 $\\widetilde{A} = A_n + E'$。\n6.  生成一个随机右端向量 $b \\in \\mathbb{R}^n$，其元素来自 $\\mathcal{N}(0,1)$ 分布。\n7.  实现一个自定义函数 `lu_no_pivot` 来计算 $\\widetilde{A}$ 的无主元 $LU$ 分解，得到矩阵 $L$ 和 $U$。\n8.  实现用于前向代入（`forward_subst` 求解 $Ly=b$）和回代（`backward_subst` 求解 $Ux=y$）的自定义函数，以求得解 $x$。\n9.  计算增长因子 $\\gamma = \\max_{i,j} |U_{ij}| / \\max_{i,j} |\\widetilde{A}_{ij}|$。\n10. 计算缩放后向残差 $\\eta = \\|A_n x - b\\|_2 / (\\|A_n\\|_2 \\|x\\|_2 + \\|b\\|_2)$。\n11. 检查 $\\gamma \\le 2.1$ 和 $\\eta \\le 1.5\\varepsilon$ 是否同时为真。存储布尔结果。\n12. 在所有测试用例运行完毕后，打印布尔结果列表。", "answer": "```python\nimport numpy as np\n\ndef lu_no_pivot(A):\n    \"\"\"\n    Computes the LU factorization of a square matrix A without pivoting.\n    \n    Args:\n        A (np.ndarray): The input square matrix.\n        \n    Returns:\n        (np.ndarray, np.ndarray): A tuple containing the lower triangular\n                                  matrix L and the upper triangular matrix U.\n    \"\"\"\n    n = A.shape[0]\n    U = A.astype(np.float64, copy=True)\n    L = np.eye(n, dtype=np.float64)\n    for k in range(n - 1):\n        if U[k, k] == 0:\n            # Although theoretically impossible for SDD matrices,\n            # this is a safeguard for floating point arithmetic.\n            raise ValueError(\"Zero pivot encountered during LU factorization without pivoting.\")\n        for i in range(k + 1, n):\n            m = U[i, k] / U[k, k]\n            L[i, k] = m\n            U[i, k:] -= m * U[k, k:]\n            U[i, k] = 0.0 # Enforce exact zero for numerical stability\n    return L, U\n\ndef forward_subst(L, b):\n    \"\"\"\n    Solves the lower triangular system Ly = b.\n    \n    Args:\n        L (np.ndarray): A lower triangular matrix.\n        b (np.ndarray): The right-hand side vector.\n        \n    Returns:\n        np.ndarray: The solution vector y.\n    \"\"\"\n    n = L.shape[0]\n    y = np.zeros(n, dtype=np.float64)\n    for i in range(n):\n        y[i] = b[i] - np.dot(L[i, :i], y[:i])\n    return y\n\ndef backward_subst(U, y):\n    \"\"\"\n    Solves the upper triangular system Ux = y.\n    \n    Args:\n        U (np.ndarray): An upper triangular matrix.\n        y (np.ndarray): The right-hand side vector.\n        \n    Returns:\n        np.ndarray: The solution vector x.\n    \"\"\"\n    n = U.shape[0]\n    x = np.zeros(n, dtype=np.float64)\n    for i in range(n - 1, -1, -1):\n        x[i] = (y[i] - np.dot(U[i, i+1:], x[i+1:])) / U[i, i]\n    return x\n\ndef run_test_case(n, epsilon, seed):\n    \"\"\"\n    Runs a single stability test case.\n    \n    Args:\n        n (int): The dimension of the matrix.\n        epsilon (float): The perturbation level.\n        seed (int): The seed for the random number generator.\n        \n    Returns:\n        bool: True if the stability checks pass, False otherwise.\n    \"\"\"\n    np.random.seed(seed)\n    \n    # 1. Construct A_n\n    A_n = np.diag(np.full(n, 3.0, dtype=np.float64)) + \\\n          np.diag(np.full(n - 1, -1.0, dtype=np.float64), k=1) + \\\n          np.diag(np.full(n - 1, -1.0, dtype=np.float64), k=-1)\n\n    # 2. Construct random perturbation E\n    E = np.random.randn(n, n)\n    \n    # Scale E\n    norm_An = np.linalg.norm(A_n, ord=2)\n    norm_E = np.linalg.norm(E, ord=2)\n    if norm_E > 0:\n        E_scaled = E * (epsilon * norm_An / norm_E)\n    else: # Should not happen in practice\n        E_scaled = np.zeros((n,n), dtype=np.float64)\n        \n    # 3. Form perturbed matrix A_tilde and random vector b\n    A_tilde = A_n + E_scaled\n    b = np.random.randn(n)\n\n    # 4. Compute LU factorization and solve A_tilde * x = b\n    try:\n        L, U = lu_no_pivot(A_tilde)\n        y = forward_subst(L, b)\n        x = backward_subst(U, y)\n    except ValueError:\n        # If a zero pivot occurs, the process is unstable by definition\n        return False\n        \n    # 5. Compute element growth factor gamma\n    max_abs_U = np.max(np.abs(U))\n    max_abs_A_tilde = np.max(np.abs(A_tilde))\n    gamma = max_abs_U / max_abs_A_tilde if max_abs_A_tilde != 0 else float('inf')\n\n    # 6. Compute scaled backward residual eta\n    residual_norm = np.linalg.norm(A_n @ x - b, ord=2)\n    norm_x = np.linalg.norm(x, ord=2)\n    norm_b = np.linalg.norm(b, ord=2)\n    \n    denominator = norm_An * norm_x + norm_b\n    eta = residual_norm / denominator if denominator > 0 else float('inf')\n\n    # 7. Check stability conditions\n    gamma_stable = (gamma = 2.1)\n    eta_stable = (eta = 1.5 * epsilon)\n    \n    return gamma_stable and eta_stable\n\ndef solve():\n    \"\"\"\n    Main function to run all test cases and print the results.\n    \"\"\"\n    test_cases = [\n        # (n, epsilon, seed)\n        (5, 10**-12, 0),\n        (5, 10**-8, 1),\n        (5, 10**-6, 2),\n        (20, 10**-12, 3),\n        (20, 10**-8, 4),\n        (20, 10**-6, 5),\n        (50, 10**-12, 6),\n        (50, 10**-8, 7),\n        (50, 10**-6, 8),\n    ]\n\n    results = []\n    for n, epsilon, seed in test_cases:\n        is_stable = run_test_case(n, epsilon, seed)\n        results.append(str(is_stable))\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "3156903"}]}