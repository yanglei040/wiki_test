{"hands_on_practices": [{"introduction": "理论学习之后，最好的巩固方式莫过于亲手实践。这个练习将引导我们从头开始，为一个简单的多项式函数手动计算龙贝格表的前几个关键条目。通过这个过程，你将掌握构建龙贝格积分法的基本步骤，并直观地感受其如何通过外推法逐步提升精度。[@problem_id:2198730]", "problem": "Romberg积分法是一种数值方法，它通过对梯形法则的结果应用Richardson外推法来估计函数的定积分。这些估计值被组织在一个称为Romberg表的三角阵列中，记为 $R_{k,j}$。第一列 $R_{k,1}$ (对于 $k \\geq 1$) 是使用具有 $n = 2^{k-1}$ 个子区间的复化梯形法则生成的。后续的项通过以下递推公式计算：\n$$R_{k,j} = R_{k,j-1} + \\frac{1}{4^{j-1} - 1}(R_{k,j-1} - R_{k-1,j-1}) \\quad \\text{for } k \\geq j \\geq 2.$$\n\n考虑多项式函数 $f(x) = 4x^3 - 3x^2 + 5$ 在区间 $[0, 2]$ 上的定积分。您的任务是手动计算该积分的Romberg表的前三项。\n\n计算 $R_{1,1}$、$R_{2,1}$ 和 $R_{2,2}$ 的值。以包含三个数值 $(R_{1,1}, R_{2,1}, R_{2,2})$ 的行向量形式提供您的答案，并以精确整数表示。", "solution": "我们对函数 $f(x)=4x^{3}-3x^{2}+5$ 在区间 $[a,b]=[0,2]$ 上进行积分。使用 $n$ 个子区间，宽度为 $h=\\frac{b-a}{n}$ 的复化梯形法则是\n$$\nT_{n}=\\frac{h}{2}\\left(f(a)+2\\sum_{i=1}^{n-1}f(a+ih)+f(b)\\right).\n$$\n根据定义，$R_{k,1}=T_{2^{\\,k-1}}$。\n\n对于 $R_{1,1}$，取 $n=1$，则 $h=2$。计算 $f(0)=5$ 和 $f(2)=4\\cdot 2^{3}-3\\cdot 2^{2}+5=32-12+5=25$。那么\n$$\nR_{1,1}=T_{1}=\\frac{2}{2}\\left(f(0)+f(2)\\right)=1\\cdot(5+25)=30.\n$$\n\n对于 $R_{2,1}$，取 $n=2$，则 $h=1$，节点为 $0,1,2$。计算 $f(1)=4-3+5=6$。那么\n$$\nR_{2,1}=T_{2}=\\frac{1}{2}\\left(f(0)+2f(1)+f(2)\\right)=\\frac{1}{2}\\left(5+2\\cdot 6+25\\right)=\\frac{42}{2}=21.\n$$\n\nRomberg外推法使用\n$$\nR_{k,j}=R_{k,j-1}+\\frac{1}{4^{\\,j-1}-1}\\left(R_{k,j-1}-R_{k-1,j-1}\\right), \\quad k\\geq j\\geq 2.\n$$\n因此，\n$$\nR_{2,2}=R_{2,1}+\\frac{1}{4^{1}-1}\\left(R_{2,1}-R_{1,1}\\right)=21+\\frac{1}{3}(21-30)=21-\\frac{9}{3}=18.\n$$\n\n作为一致性检验，该定积分的精确值为\n$$\n\\int_{0}^{2}\\left(4x^{3}-3x^{2}+5\\right)\\,dx=\\left(x^{4}-x^{3}+5x\\right)\\bigg|_{0}^{2}=16-8+10=18,\n$$\n该结果与 $R_{2,2}$ 一致，这对于三次多项式是符合预期的。", "answer": "$$\\boxed{\\begin{pmatrix}30  21  18\\end{pmatrix}}$$", "id": "2198730"}, {"introduction": "在掌握了数值计算之后，让我们转向一个更深层次的挑战：分析龙贝格积分的代数结构。这个练习要求我们不代入具体数值，而是用符号推导出高阶近似值与初始梯形法则估计值之间的关系。这不仅能加深你对理查森外推本质的理解，也揭示了在计算机编程中实现该算法的内存优化技巧。[@problem_id:2198718]", "problem": "一位程序员的任务是实现龙贝格（Romberg）积分算法来近似计算一个定积分 $I = \\int_a^b f(x) \\, dx$。该算法生成一个由估计值组成的三角阵，记为 $R_{n,m}$，其中 $n$ 是行索引，$m$ 是列索引（$n \\ge m \\ge 0$）。第一列 $R_{n,0}$ 包含使用 $2^n$ 个子区间的复合梯形法则得到的初始估计值。后续的列是使用理查森（Richardson）外推公式生成的：\n$$R_{n,m} = R_{n,m-1} + \\frac{R_{n,m-1} - R_{n-1,m-1}}{4^m - 1} \\quad \\text{对于 } n \\ge 1, m \\ge 1$$\n最准确的估计值通常位于对角线上，即 $R_{n,n}$。\n\n为了优化内存使用，程序员决定只使用一个一维数组，我们称之为 `V`，其大小足以容纳该三角阵的一行（例如，对于最多 $k_{max}$ 次迭代，大小为 $k_{max}+1$）。算法按以下步骤进行：\n\n1.  计算基准情况 $R_{0,0}$ 并将其存储在 `V[0]` 中。\n2.  对于从 $1$ 到最大值 $k_{max}$ 的每次迭代 `n`：\n    a. 在迭代 `n` 开始时，假定数组 `V` 包含前一个已完成行的值，即，对于 $j=0, 1, \\dots, n-1$，`V[j]` 包含 $R_{n-1,j}$。\n    b. 计算一个新的梯形估计值 $R_{n,0}$。\n    c. 数组 `V` 被就地更新，以计算并存储新行 `n` 的值。\n    d. 在迭代 `n` 的更新过程完全结束后，数组 `V` 包含新行的值，即，对于 $j=0, 1, \\dots, n$，`V[j]` 现在持有 $R_{n,j}$。\n\n假设运行此算法，并生成了初始梯形估计值序列 $R_{0,0}, R_{1,0}, R_{2,0}, R_{3,0}, \\dots$。你的任务是确定在算法完全完成 `n=3` 的迭代后，将存储在 `V[2]` 中的值。\n\n将你的答案表示为梯形估计值 $R_{1,0}$、$R_{2,0}$ 和 $R_{3,0}$ 的线性组合。", "solution": "问题要求在算法完成其 `n=3` 的迭代后，存储在数组元素 `V[2]` 中的值。根据问题描述，在迭代 `n` 完成后，数组 `V` 存储了龙贝格三角阵的第 `n` 行。因此，`V[j]` 持有值 $R_{n,j}$。我们被要求求出 `n=3` 迭代后的 `V[2]`，这对应于 $R_{3,2}$ 的值。\n\n我们的目标是用初始梯形估计值 $R_{i,0}$ 来表示 $R_{3,2}$。我们将使用所提供的理查森外推公式：\n$$R_{n,m} = R_{n,m-1} + \\frac{R_{n,m-1} - R_{n-1,m-1}}{4^m - 1}$$\n\n首先，让我们通过在公式中设置 $n=3$ 和 $m=2$ 来写出 $R_{3,2}$ 的表达式：\n$$R_{3,2} = R_{3,1} + \\frac{R_{3,1} - R_{2,1}}{4^2 - 1} = R_{3,1} + \\frac{R_{3,1} - R_{2,1}}{15}$$\n这可以被重写以简化后续计算：\n$$R_{3,2} = \\frac{15R_{3,1} + (R_{3,1} - R_{2,1})}{15} = \\frac{16R_{3,1} - R_{2,1}}{15}$$\n\n现在，我们需要找到 $R_{3,1}$ 和 $R_{2,1}$ 关于第 $m=0$ 列估计值的表达式。\n\n对于 $R_{3,1}$，我们设置 $n=3$ 和 $m=1$：\n$$R_{3,1} = R_{3,0} + \\frac{R_{3,0} - R_{2,0}}{4^1 - 1} = R_{3,0} + \\frac{R_{3,0} - R_{2,0}}{3}$$\n合并各项得到：\n$$R_{3,1} = \\frac{3R_{3,0} + (R_{3,0} - R_{2,0})}{3} = \\frac{4R_{3,0} - R_{2,0}}{3}$$\n\n对于 $R_{2,1}$，我们设置 $n=2$ 和 $m=1$：\n$$R_{2,1} = R_{2,0} + \\frac{R_{2,0} - R_{1,0}}{4^1 - 1} = R_{2,0} + \\frac{R_{2,0} - R_{1,0}}{3}$$\n合并各项得到：\n$$R_{2,1} = \\frac{3R_{2,0} + (R_{2,0} - R_{1,0})}{3} = \\frac{4R_{2,0} - R_{1,0}}{3}$$\n\n现在我们将 $R_{3,1}$ 和 $R_{2,1}$ 的这些表达式代回到我们关于 $R_{3,2}$ 的方程中：\n$$R_{3,2} = \\frac{16 \\left( \\frac{4R_{3,0} - R_{2,0}}{3} \\right) - \\left( \\frac{4R_{2,0} - R_{1,0}}{3} \\right)}{15}$$\n让我们先简化分子：\n$$\\frac{16(4R_{3,0} - R_{2,0}) - (4R_{2,0} - R_{1,0})}{3} = \\frac{64R_{3,0} - 16R_{2,0} - 4R_{2,0} + R_{1,0}}{3} = \\frac{64R_{3,0} - 20R_{2,0} + R_{1,0}}{3}$$\n现在，将此结果代回 $R_{3,2}$ 的表达式中：\n$$R_{3,2} = \\frac{\\frac{64R_{3,0} - 20R_{2,0} + R_{1,0}}{3}}{15}$$\n$$R_{3,2} = \\frac{64R_{3,0} - 20R_{2,0} + R_{1,0}}{45}$$\n\n这就是表示为 $R_{3,0}$、$R_{2,0}$ 和 $R_{1,0}$ 线性组合的 $R_{3,2}$ 的值。\n因此，在 `n=3` 迭代后存储在 `V[2]` 中的值是 $\\frac{64}{45}R_{3,0} - \\frac{20}{45}R_{2,0} + \\frac{1}{45}R_{1,0}$。\n问题要求以线性组合的形式表示，我们已经找到了。\n最终表达式：$\\frac{64R_{3,0} - 20R_{2,0} + R_{1,0}}{45}$。", "answer": "$$\\boxed{\\frac{64R_{3,0} - 20R_{2,0} + R_{1,0}}{45}}$$", "id": "2198718"}, {"introduction": "一个真正的专家不仅知道如何使用一个工具，更重要的是知道它的局限性。此问题将我们带到龙贝格积分法的边界，通过分析一个在积分区间内存在不可导点的函数来探索其失效的原因。通过这个思想实验，你将理解为何龙贝格积分法依赖于被积函数的光滑性，以及当这个核心假设被破坏时会发生什么。[@problem_id:2435348]", "problem": "考虑应用龙贝格积分法（基于步长为 $h, h/2, h/4, \\ldots$ 的复合梯形法则构建的逐次理查森外推法）来计算定积分 $\\int_{-1}^{1} |x| \\, dx$。在 $N$ 个子区间的均匀网格上，复合梯形法则的步长为 $h = \\frac{2}{N}$。你的任务是从被积函数的可微性以及复合梯形法则的结构出发，论证龙贝格积分法是否以及为何能或不能对此积分加速收敛。\n\n哪个陈述最能解释这种行为？\n\nA. 被积函数 $|x|$ 在 $x=0$ 处不可微，因此龙贝格积分法所假设的偶次幂误差展开式不成立。对于复合梯形法则，全局误差是依赖于奇偶性的：当 $N$ 是奇数时（尖点严格位于一个子区间内），误差为 $E_N = \\frac{h^2}{4}$；当 $N$ 是偶数时（尖点与一个节点重合，每个子区间内的函数都是线性的），误差为 $E_N = 0$。由于在加密步长时，主误差项的系数不是一个固定常数，从 $h$ 到 $h/2$ 的第一次理查森外推可能会产生一个远离精确积分值的结果。\n\nB. 龙贝格积分法失败是因为该积分为瑕积分且在 $x=0$ 处发散，因此任何求积法则都无法有意义地应用。\n\nC. 龙贝格积分法失败是因为 $|x|$ 是在对称区间上的一个奇函数，在 $x=0$ 附近的抵消使得外推过程无效。\n\nD. 如果初始步长 $h$ 足够小，龙贝格积分法就会成功；对于足够小的 $h$，$x=0$ 处的尖点会有效消失，从而恢复龙贝格积分法所要求的光滑偶次幂误差展开式。\n\nE. 龙贝格积分法失败是因为复合梯形法则全局只有一阶精度，因此无论光滑性如何，偶次幂的理查森外推都不适用。", "solution": "该问题要求分析龙贝格积分法在计算定积分 $I = \\int_{-1}^{1} |x| \\, dx$ 时的表现。分析的核心在于龙贝格积分法的理论基础以及被积函数 $f(x) = |x|$ 的性质。\n\n首先，我们确定该积分的精确值。被积函数 $f(x) = |x|$ 是一个偶函数，因此在对称区间 $[-1, 1]$ 上的积分可以计算如下：\n$$ I = \\int_{-1}^{1} |x| \\, dx = 2 \\int_{0}^{1} x \\, dx = 2 \\left[ \\frac{x^2}{2} \\right]_{0}^{1} = 2 \\left( \\frac{1^2}{2} - \\frac{0^2}{2} \\right) = 1 $$\n积分的精确值为 $1$。\n\n接下来，我们分析龙贝格积分法的基础。龙贝格积分法是一种利用理查森外推来加速复合梯形法则收敛的方法。对于一个积分 $I$，步长为 $h$ 的复合梯形法则近似值 $T(h)$ 具有一个由欧拉-麦克劳林公式给出的渐近误差展开式：\n$$ T(h) = I + C_1 h^2 + C_2 h^4 + C_3 h^6 + \\dots $$\n这个展开式成立的条件是被积函数 $f(x)$ 在积分区间 $[a, b]$ 上足够光滑（即，具有足够多阶的连续导数）。具体来说，为了使展开式只包含 $h$ 的偶次幂，被积函数及其所有奇数阶导数必须在端点 $a$ 和 $b$ 处为零，或者该函数是周期为 $b-a$ 的周期函数。对于一个一般的非周期函数，展开式为 $T(h) = I + C_1 h^2 + C_2 h^4 + \\dots + K_p h^{2p} + O(h^{2p+2})$，这要求被积函数至少属于 $C^{2p+2}[a, b]$ 类。\n\n本题中的被积函数是 $f(x) = |x|$。这个函数处处连续。然而，它的一阶导数是符号函数 $f'(x) = \\text{sgn}(x)$，在 $x=0$ 处有一个跳跃间断点。\n$$ f'(x) = \\begin{cases} -1,  x  0 \\\\ 1,  x > 0 \\end{cases} $$\n由于 $f'(x)$ 在 $x=0$ 处不连续，函数 $f(x)=|x|$ 不属于 $C^1[-1, 1]$ 类。因此，它也不属于 $C^2[-1, 1]$。标准的欧拉-麦克劳林误差展开式的基本光滑性要求被违反了。复合梯形法則的误差将不具有仅含 $h$ 的偶次幂的形式，因此，龙贝格积分法的前提是无效的。\n\n我们现在必须分析复合梯形法则对于这个特定被积函数的具体行为。该法则应用于 $[-1, 1]$ 上 $N$ 个子区间的均匀网格，步长为 $h = \\frac{2}{N}$，节点为 $x_k = -1 + k h$，$k=0, 1, \\dots, N$。其行为关键取决于不可微点 $x=0$ 是否是一个网格节点。\n\n情况1：$N$ 是偶数。\n设 $N=2m$，其中 $m \\ge 1$ 是某个整数。步长为 $h = \\frac{2}{2m} = \\frac{1}{m}$。网格节点为 $x_k = -1 + \\frac{k}{m}$。对应于 $k=m$ 的节点是 $x_m = -1 + \\frac{m}{m} = 0$。因此，当 $N$ 是偶数时，不可微点 $x=0$ 总是一个网格节点。复合梯形法则将每个子区间上的结果相加。在 $[-1, 0]$ 内的子区间上，被积函数是 $f(x)=-x$，是一个线性函数。在 $[0, 1]$ 内的子区间上，被积函数是 $f(x)=x$，也是一个线性函数。梯形法则对于线性函数是精确的（其误差项涉及被积函数的二阶导数，对于线性函数而言二阶导数为零）。因此，对于每个子区间，近似都是精确的，计算出的总积分也是精确的。当 $N$ 是偶数时，误差 $E_N = T_N - I = 0$。\n\n情况2：$N$ 是奇数。\n设 $N=2m+1$，其中 $m \\ge 0$ 是某个整数。步长为 $h = \\frac{2}{2m+1}$。网格节点为 $x_k = -1 + k \\frac{2}{2m+1}$。若要 $x_k=0$，则需要 $-1 + k \\frac{2}{2m+1} = 0$，这意味着 $k = \\frac{2m+1}{2}$。这永远不是整数。因此，当 $N$ 是奇数时，$x=0$ 点总是严格落在一个子区间内部。这个子区间是 $[x_m, x_{m+1}]$，其中 $x_m = -1 + m h = \\frac{-(2m+1)+2m}{2m+1} = \\frac{-1}{2m+1}$ 且 $x_{m+1} = -1 + (m+1)h = \\frac{-(2m+1)+2m+2}{2m+1} = \\frac{1}{2m+1}$。注意这个区间关于 $0$ 对称，长度为 $h$。复合梯形法则的误差完全来自于这一个子区间，因为在所有其他子区间上被积函数都是线性的。\n这个子区间上的梯形近似值为：\n$$ T_{[x_m, x_{m+1}]} = \\frac{h}{2} (f(x_m) + f(x_{m+1})) = \\frac{h}{2} \\left(\\left|\\frac{-1}{2m+1}\\right| + \\left|\\frac{1}{2m+1}\\right|\\right) = \\frac{h}{2} \\left(\\frac{1}{2m+1} + \\frac{1}{2m+1}\\right) = \\frac{h}{2} \\left(\\frac{2}{2m+1}\\right) = \\frac{h^2}{2} $$\n这个子区间上的精确积分为：\n$$ I_{[x_m, x_{m+1}]} = \\int_{-1/(2m+1)}^{1/(2m+1)} |x|\\, dx = 2 \\int_0^{1/(2m+1)} x\\, dx = \\left[x^2\\right]_0^{1/(2m+1)} = \\left(\\frac{1}{2m+1}\\right)^2 = \\left(\\frac{h}{2}\\right)^2 = \\frac{h^2}{4} $$\n这个子区间的误差，也就是总误差 $E_N$，为 $E_N = T_{[x_m, x_{m+1}]} - I_{[x_m, x_{m+1}]} = \\frac{h^2}{2} - \\frac{h^2}{4} = \\frac{h^2}{4}$。当 $N$ 是奇数时，$E_N = \\frac{h^2}{4} \\ne 0$。\n\n理查森外推公式 $R_{k,1} = \\frac{4R_{k,0} - R_{k-1,0}}{3}$ 假设误差 $E(h) = C h^2 + O(h^4)$，其中 $C$ 是一个常数。我们的分析表明，误差序列是：当 $N$ 为奇数时 $E_N=h^2/4$，当 $N$ 为偶数时 $E_N=0$。当步长减半（$h \\to h/2$）时，区间数量加倍（$N \\to 2N$），如果 $N$ 是奇数，这将改变 $N$ 的奇偶性。这意味着误差项中的“常数”$C$ 并非恒定，而是在交替变化。这使得外推法失效。例如，如果我们从一个奇数 $N_0$（误差 $\\sim h_0^2/4$）开始，然后取 $N_1=2N_0$（误差为 $0$），外推法将产生一个很差的结果。\n\n现在，我们来评估每个选项。\n\nA. 被积函数 $|x|$ 在 $x=0$ 处不可微，因此龙贝格积分法所假设的偶次幂误差展开式不成立。对于复合梯形法则，全局误差是依赖于奇偶性的：当 $N$ 是奇数时（尖点严格位于一个子区间内），误差为 $E_N = \\frac{h^2}{4}$；当 $N$ 是偶数时（尖点与一个节点重合，每个子区间内的函数都是线性的），误差为 $E_N = 0$。由于在加密步长时，主误差项的系数不是一个固定常数，从 $h$ 到 $h/2$ 的第一次理查森外推可能会产生一个远离精确积分值的结果。\n这个陈述完美地总结了我们的推导。其中每一个论断都是正确的：不可微性、误差展开式失效、梯形法则的奇偶性依赖误差（奇数 $N$ 时为 $E_N=h^2/4$，偶数 $N$ 时为 $E_N=0$）、非恒定的误差系数以及由此导致的外推法失败。\n结论：**正确**。\n\nB. 龙贝格积分法失败是因为该积分为瑕积分且在 $x=0$ 处发散，因此任何求积法则都无法有意义地应用。\n积分 $\\int_{-1}^{1} |x| \\, dx$ 是一个正常积分。被积函数 $|x|$ 在有限区间 $[-1, 1]$ 上是连续且有界的。该积分收敛于 $1$。该陈述在事实上是错误的。\n结论：**不正确**。\n\nC. 龙贝格积分法失败是因为 $|x|$ 是在对称区间上的一个奇函数，在 $x=0$ 附近的抵消使得外推过程无效。\n函数 $f(x)=|x|$ 是一个偶函数，因为 $f(-x) = |-x| = |x| = f(x)$。该陈述的前提是错误的。\n结论：**不正确**。\n\nD. 如果初始步长 $h$ 足够小，龙贝格积分法就会成功；对于足够小的 $h$，$x=0$ 处的尖点会有效消失，从而恢复龙贝格积分法所要求的光滑偶次幂误差展开式。\n$x=0$ 处的不可微性是函数 $|x|$ 的一个内在属性。它在任何尺度下都不会消失。减小步长 $h$ 并不会使函数更光滑，也不会恢复所需的误差展开式。依赖于奇偶性的误差行为无论 $h$ 的大小如何都会持续存在。\n结论：**不正确**。\n\nE. 龙贝格积分法失败是因为复合梯形法则全局只有一阶精度，因此无论光滑性如何，偶次幂的理查森外推都不适用。\n对于足够光滑（$C^2$）的函数，复合梯形法则是二阶精度（$O(h^2)$）的，而不是一阶。在这种情况下，龙贝格积分法的失败正是由于光滑性的问题，而这个陈述忽略了这一点。该陈述的前提是不正确的。\n结论：**不正确**。", "answer": "$$\\boxed{A}$$", "id": "2435348"}]}