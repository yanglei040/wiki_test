{"hands_on_practices": [{"introduction": "理论是基础，但真正的理解源于实践。我们的第一个练习是一个热身，它将引导你精确地将四阶龙格-库塔（RK4）的公式应用于一个简单的初值问题。这个练习的重点是熟悉计算四个中间斜率（$k_1, k_2, k_3, k_4$）的步骤，并理解它们如何通过加权平均来得到一个高精度的近似解 [@problem_id:2197363]。", "problem": "考虑由微分方程 $y' = \\frac{x}{y}$ 和初始条件 $y(1) = 2$ 定义的初值问题。\n\n您的任务是应用单步四阶龙格-库塔 (RK4) 方法来近似计算 $y(1.1)$ 的值。对于微分方程 $y' = f(x, y)$ 和步长 $h$，RK4 方法使用以下公式从当前值 $y_n$ 计算下一个值 $y_{n+1}$：\n\n$y_{n+1} = y_n + \\frac{h}{6}(k_1 + 2k_2 + 2k_3 + k_4)$\n\n其中\n\n$k_1 = f(x_n, y_n)$\n$k_2 = f(x_n + \\frac{h}{2}, y_n + \\frac{h}{2}k_1)$\n$k_3 = f(x_n + \\frac{h}{2}, y_n + \\frac{h}{2}k_2)$\n$k_4 = f(x_n + h, y_n + h k_3)$\n\n计算 $y(1.1)$ 的数值近似值，并将您的最终答案四舍五入到五位有效数字。", "solution": "该问题要求使用四阶龙格-库塔 (RK4) 方法，对常微分方程 $y' = \\frac{x}{y}$（初始条件为 $y(1) = 2$）进行单步近似，以求得 $y(1.1)$ 的值。\n\n首先，我们确定 RK4 公式所需的各个组成部分。\n函数为 $f(x, y) = \\frac{x}{y}$。\n初始点为 $(x_0, y_0) = (1, 2)$。\n我们想求出在 $x_1 = 1.1$ 处的 $y$ 值。这意味着我们取一个大小为 $h = x_1 - x_0 = 1.1 - 1.0 = 0.1$ 的单步。\n\n现在，我们计算四个中间斜率 $k_1, k_2, k_3, k_4$。\n\n步骤 1：计算 $k_1$。\n$k_1 = f(x_0, y_0) = f(1, 2) = \\frac{1}{2} = 0.5$。\n\n步骤 2：计算 $k_2$。\n$k_2$ 的计算点是 $(x_0 + \\frac{h}{2}, y_0 + \\frac{h}{2}k_1)$。\n$x_0 + \\frac{h}{2} = 1 + \\frac{0.1}{2} = 1.05$。\n$y_0 + \\frac{h}{2}k_1 = 2 + \\frac{0.1}{2}(0.5) = 2 + 0.05(0.5) = 2 + 0.025 = 2.025$。\n所以，$k_2 = f(1.05, 2.025) = \\frac{1.05}{2.025}$。\n这个分数是 $\\frac{1050}{2025} = \\frac{42 \\times 25}{81 \\times 25} = \\frac{42}{81} = \\frac{14}{27}$。\n作为小数，$k_2 \\approx 0.5185185185...$。\n\n步骤 3：计算 $k_3$。\n$k_3$ 的计算点是 $(x_0 + \\frac{h}{2}, y_0 + \\frac{h}{2}k_2)$。\nx 坐标与 $k_2$ 的相同：$1.05$。\n$y_0 + \\frac{h}{2}k_2 = 2 + \\frac{0.1}{2} \\left(\\frac{14}{27}\\right) = 2 + 0.05 \\left(\\frac{14}{27}\\right) = 2 + \\frac{1}{20}\\frac{14}{27} = 2 + \\frac{7}{270} = \\frac{540+7}{270} = \\frac{547}{270}$。\n所以，$k_3 = f\\left(1.05, \\frac{547}{270}\\right) = \\frac{1.05}{547/270} = \\frac{21/20}{547/270} = \\frac{21}{20} \\cdot \\frac{270}{547} = \\frac{21 \\cdot 27}{2 \\cdot 547} = \\frac{567}{1094}$。\n作为小数，$k_3 \\approx 0.5182815356...$。\n\n步骤 4：计算 $k_4$。\n$k_4$ 的计算点是 $(x_0 + h, y_0 + h k_3)$。\n$x_0 + h = 1 + 0.1 = 1.1$。\n$y_0 + h k_3 = 2 + 0.1 \\left(\\frac{567}{1094}\\right) = 2 + \\frac{567}{10940} = \\frac{21880+567}{10940} = \\frac{22447}{10940}$。\n所以，$k_4 = f\\left(1.1, \\frac{22447}{10940}\\right) = \\frac{1.1}{22447/10940} = \\frac{11/10}{22447/10940} = \\frac{11}{10} \\cdot \\frac{10940}{22447} = \\frac{11 \\cdot 1094}{22447} = \\frac{12034}{22447}$。\n作为小数，$k_4 \\approx 0.536107275...$。\n\n步骤 5：计算最终近似值 $y_1$。\n$y_1 = y_0 + \\frac{h}{6}(k_1 + 2k_2 + 2k_3 + k_4)$。\n为了清晰起见，使用小数近似值（同时在计算中保持高精度）：\n$y_1 \\approx 2 + \\frac{0.1}{6}(0.5 + 2(0.5185185185) + 2(0.5182815356) + 0.536107275)$。\n$y_1 \\approx 2 + \\frac{0.1}{6}(0.5 + 1.037037037 + 1.0365630712 + 0.536107275)$。\n$y_1 \\approx 2 + \\frac{0.1}{6}(3.1097073832)$。\n$y_1 \\approx 2 + 0.05182845638...$。\n$y_1 \\approx 2.05182845638...$。\n\n最后，我们将结果四舍五入到五位有效数字。前五位有效数字是 2、0、5、1、8。后一位数字是 2，小于 5，所以我们向下舍入（即，我们不改变最后一位数字）。\n$y(1.1) \\approx 2.0518$。", "answer": "$$\\boxed{2.0518}$$", "id": "2197363"}, {"introduction": "现实世界中的许多问题涉及多个相互作用的变量，这通常被描述为常微分方程组。这个练习将展示龙格-库塔方法如何通过将状态变量及其导数视为向量，从而自然地推广到这类系统。我们将使用中点法（一种二阶龙格-库塔方法）来近似一个简谐振子的运动轨迹 [@problem_id:2197355]。", "problem": "考虑一个用于模拟理想化无阻尼振子的一阶常微分方程组：\n$$\n\\frac{dx}{dt} = -y\n$$\n$$\n\\frac{dy}{dt} = x\n$$\n系统在时间 $t=0$ 时的状态由初始条件 $x(0) = 2$ 和 $y(0) = 0$ 给出。\n\n我们希望使用数值方法，求出系统在稍后某一时刻状态的近似解。具体来说，我们将使用被称为中点法的二阶龙格-库塔方法。对于一个一般的向量常微分方程 $\\frac{d\\vec{u}}{dt} = \\vec{f}(t, \\vec{u})$，中点法从时间 $t_n$ 到 $t_{n+1} = t_n + h$ 的单步计算公式如下：\n$$\n\\vec{k}_1 = \\vec{f}(t_n, \\vec{u}_n)\n$$\n$$\n\\vec{k}_2 = \\vec{f}\\left(t_n + \\frac{h}{2}, \\vec{u}_n + \\frac{h}{2}\\vec{k}_1\\right)\n$$\n$$\n\\vec{u}_{n+1} = \\vec{u}_n + h \\vec{k}_2\n$$\n\n使用步长 $h=0.1$ 的中点法进行单步计算，求出 $x(0.1)$ 和 $y(0.1)$ 的近似值。你的答案应为 $x(0.1)$ 和 $y(0.1)$ 的近似值对，并按此顺序排列。", "solution": "我们通过定义 $\\vec{u}(t)=\\begin{pmatrix}x(t) \\\\ y(t)\\end{pmatrix}$ 和 $\\vec{f}(t,\\vec{u})=\\begin{pmatrix}-y \\\\ x\\end{pmatrix}$，将该方程组重写为向量形式。步长为 $h$ 的中点法计算如下：\n$$\n\\vec{k}_{1}=\\vec{f}(t_{0},\\vec{u}_{0}), \\quad\n\\vec{k}_{2}=\\vec{f}\\!\\left(t_{0}+\\frac{h}{2},\\ \\vec{u}_{0}+\\frac{h}{2}\\vec{k}_{1}\\right), \\quad\n\\vec{u}_{1}=\\vec{u}_{0}+h\\,\\vec{k}_{2}.\n$$\n给定 $t_{0}=0$，$\\vec{u}_{0}=\\begin{pmatrix}2 \\\\ 0\\end{pmatrix}$ 以及 $h=0.1$，我们计算\n$$\n\\vec{k}_{1}=\\vec{f}(0,\\vec{u}_{0})=\\begin{pmatrix}-y(0) \\\\ x(0)\\end{pmatrix}=\\begin{pmatrix}0 \\\\ 2\\end{pmatrix}.\n$$\n中点状态为\n$$\n\\vec{u}_{0}+\\frac{h}{2}\\vec{k}_{1}\n=\\begin{pmatrix}2 \\\\ 0\\end{pmatrix}\n+0.05\\begin{pmatrix}0 \\\\ 2\\end{pmatrix}\n=\\begin{pmatrix}2 \\\\ 0.1\\end{pmatrix}.\n$$\n然后\n$$\n\\vec{k}_{2}=\\vec{f}\\!\\left(0.05,\\begin{pmatrix}2 \\\\ 0.1\\end{pmatrix}\\right)\n=\\begin{pmatrix}-0.1 \\\\ 2\\end{pmatrix}.\n$$\n最后，\n$$\n\\vec{u}_{1}=\\vec{u}_{0}+h\\,\\vec{k}_{2}\n=\\begin{pmatrix}2 \\\\ 0\\end{pmatrix}\n+0.1\\begin{pmatrix}-0.1 \\\\ 2\\end{pmatrix}\n=\\begin{pmatrix}2-0.01 \\\\ 0.2\\end{pmatrix}\n=\\begin{pmatrix}1.99 \\\\ 0.2\\end{pmatrix}.\n$$\n因此，使用步长 $h=0.1$ 的中点法进行单步计算后，得到的近似值为 $x(0.1)\\approx 1.99$ 和 $y(0.1)\\approx 0.2$。", "answer": "$$\\boxed{\\begin{pmatrix}1.99 & 0.2\\end{pmatrix}}$$", "id": "2197355"}, {"introduction": "一个强大的数值方法，只有在能产生稳定解时才是有用的。最后一个练习探讨了“绝对稳定性”这一至关重要的概念，它决定了为防止数值误差失控增长所允许的最大步长。我们将通过分析一个源于牛顿冷却定律的物理场景，来确定RK4方法的稳定性极限，这是解决所谓“刚性”微分方程时一项不可或缺的技能 [@problem_id:2197380]。", "problem": "一个小的金属球初始温度为 $T_0$。它被浸入一个保持在恒定温度 $T_{env}$ 的大冷却浴中。温差 $\\Delta T(t) = T(t) - T_{env}$ 遵循牛顿冷却定律，对于该系统，这由以下常微分方程 (ODE) 描述：\n$$ \\frac{d(\\Delta T)}{dt} = -k \\Delta T $$\n其中冷却常数为 $k = 50.0 \\text{ s}^{-1}$。您的任务是使用经典的四阶龙格-库塔 (RK4) 方法对冷却过程进行数值模拟。为确保数值解不出现伪增长振荡（即，确保绝对稳定性），必须仔细选择时间步长 $h$。确定在此模拟中为保持绝对稳定性可以使用的最大可能时间步长 $h_{max}$。将您的答案 $h_{max}$ 以秒为单位表示，并四舍五入到三位有效数字。", "solution": "我们将温差的常微分方程重写为线性测试方程。令 $y(t) = \\Delta T(t)$。则\n$$\n\\frac{dy}{dt} = -k\\,y,\n$$\n因此，对于 RK4 稳定性分析，我们在标准测试方程 $y'=\\lambda y$ 中取 $\\lambda = -k$。\n\n对于应用于 $y'=\\lambda y$ 且步长为 $h$ 的龙格-库塔方法，更新公式为 $y_{n+1} = R(z)\\,y_{n}$，其中 $z = h\\lambda$。对于经典的四阶龙格-库塔方法，其稳定性函数是 $\\exp(z)$ 的4次泰勒多项式：\n$$\nR(z) = 1 + z + \\frac{z^{2}}{2} + \\frac{z^{3}}{6} + \\frac{z^{4}}{24}.\n$$\n绝对稳定性要求 $|R(z)| \\leq 1$。由于 $\\lambda = -k$ 是负实数，因此 $z = h\\lambda = -kh$ 也是负实数。绝对稳定性条件 $|R(z)| \\le 1$ 在负实轴上简化为 $-1 \\le R(z) \\le 1$。稳定性区间的右端点是 $z=0$，其中 $R(0)=1$。区间的左端点 $z_\\ast$ 是满足 $R(z_\\ast) = -1$ 的最接近零的负根。\n\n因此，我们求解方程 $R(z)=-1$：\n$$\n1 + z + \\frac{z^2}{2} + \\frac{z^3}{6} + \\frac{z^4}{24} = -1\n$$\n这等价于一个四次多项式方程：\n$$\n\\frac{z^4}{24} + \\frac{z^3}{6} + \\frac{z^2}{2} + z + 2 = 0\n$$\n或者\n$$\nz^4 + 4z^3 + 12z^2 + 24z + 48 = 0\n$$\n通过数值方法求解这个四次方程，我们发现其在负实轴上的根约为：\n$$\nz_{\\ast} \\approx -2.785.\n$$\n由于 $z = -k h$，保持绝对稳定性的最大时间步长是\n$$\nh_{\\max} = \\frac{|z_{\\ast}|}{k}.\n$$\n当 $k = 50.0\\,\\text{s}^{-1}$ 时，这给出\n$$\nh_{\\max} \\approx \\frac{2.785}{50.0} = 0.0557\\ \\text{s},\n$$\n根据要求四舍五入到三位有效数字，结果是 $0.0557$ 秒。", "answer": "$$\\boxed{0.0557}$$", "id": "2197380"}]}