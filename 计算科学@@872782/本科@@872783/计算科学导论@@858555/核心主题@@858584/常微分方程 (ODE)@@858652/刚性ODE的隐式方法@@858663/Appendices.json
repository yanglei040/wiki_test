{"hands_on_practices": [{"introduction": "要掌握隐式方法，第一步是熟悉其代数形式。这个练习将引导你对一个简单的线性常微分方程应用隐式中点法。通过这个过程，你将学会如何进行代数求解，从而得到一个关于下一时间步长 $y_{n+1}$ 的显式表达式，为理解更复杂的情况奠定基础。[@problem_id:2178584]", "problem": "在计算物理学中，许多问题需要对常微分方程（ODE）进行数值求解。考虑一个电子元件温度随时间变化的简化模型，其温度表示为 $y(t)$。其温度的变化率由以下线性一阶常微分方程描述：\n$$ \\frac{dy}{dt} = ay + b $$\n其中 $y_n$ 表示在时间 $t_n$ 时的已知温度，$a$ 和 $b$ 是由元件的物理特性及其环境决定的实常数。\n\n为了对解进行数值近似，我们可以使用一种隐式方法。其中一种方法是隐式中点法则，它使用以下公式计算下一个时间步的状态 $y_{n+1} = y(t_n + h)$：\n$$ y_{n+1} = y_n + h f\\left(t_n + \\frac{h}{2}, \\frac{y_n + y_{n+1}}{2}\\right) $$\n这里，$h$ 是恒定的时间步长，$f(t,y)$ 是定义该常微分方程的函数，即 $f(t,y) = \\frac{dy}{dt}$。\n\n通过对给定的常微分方程应用单步隐式中点法则，推导出 $y_{n+1}$ 关于 $y_n$、$h$、$a$ 和 $b$ 的显式解析表达式。", "solution": "我们从常微分方程 $ \\frac{dy}{dt} = a y + b $ 开始，并应用隐式中点法则\n$$\ny_{n+1} = y_n + h f\\left(t_n + \\frac{h}{2}, \\frac{y_n + y_{n+1}}{2}\\right).\n$$\n这里 $f(t,y) = a y + b$ 是自治的（不依赖于 $t$），所以\n$$\nf\\left(t_n + \\frac{h}{2}, \\frac{y_n + y_{n+1}}{2}\\right) = a \\left(\\frac{y_n + y_{n+1}}{2}\\right) + b.\n$$\n代入更新公式可得\n$$\ny_{n+1} = y_n + h \\left[ a \\left(\\frac{y_n + y_{n+1}}{2}\\right) + b \\right].\n$$\n展开并合并关于 $y_{n+1}$ 的项，\n$$\ny_{n+1} = y_n + \\frac{a h}{2} y_n + \\frac{a h}{2} y_{n+1} + h b,\n$$\n即\n$$\n\\left(1 - \\frac{a h}{2}\\right) y_{n+1} = \\left(1 + \\frac{a h}{2}\\right) y_n + h b.\n$$\n求解 $y_{n+1}$ 可得到显式解析表达式\n$$\ny_{n+1} = \\frac{\\left(1 + \\frac{a h}{2}\\right) y_n + h b}{1 - \\frac{a h}{2}}.\n$$", "answer": "$$\\boxed{\\frac{\\left(1 + \\frac{a h}{2}\\right) y_n + h b}{1 - \\frac{a h}{2}}}$$", "id": "2178584"}, {"introduction": "虽然线性方程是很好的起点，但大多数现实世界模型都是非线性的。这个练习将难度提高一步，要求你将后向欧拉法应用于非线性的逻辑斯谛增长方程。你会发现，隐式方法通常会将微分方程问题转化为每一步都需要求解的代数方程问题，在这种情况下是一个二次方程。[@problem_id:2178610]", "problem": "在计算科学中，逻辑斯谛增长模型是研究种群动态的一个常见例子。该模型由一阶常微分方程 (ODE) 描述：$P'(t) = r P(t) \\left(1 - \\frac{P(t)}{K}\\right)$，其中 $P(t)$ 是时间 $t$ 时的种群数量，$r  0$ 是内在增长率，$K  0$ 是环境承载能力。\n\n为了对该解进行数值近似，我们可以使用一种隐式方法，如后向欧拉法。我们使用一个常数步长 $h  0$ 将时间离散化，令 $t_n = n h$。时间 $t_n$ 时种群数量的数值近似值记为 $P_n$。对于形如 $y' = f(t, y)$ 的一般常微分方程，后向欧拉法由公式 $y_{n+1} = y_n + h f(t_{n+1}, y_{n+1})$ 给出。\n\n当此方法应用于逻辑斯谛方程时，在每个时间步都会得到一个关于 $P_{n+1}$ 的非线性代数方程。你的任务是求解这个方程，以找到用已知的先前状态 $P_n$ 以及参数 $h, r, K$ 表示的 $P_{n+1}$ 的显式公式。对于一个具有物理意义的种群模型，我们要求种群数量 $P_{n+1}$ 保持非负，并且在时间步长非常小（$h \\rightarrow 0$）的极限情况下，下一个状态应收敛到当前状态（$P_{n+1} \\rightarrow P_n$）。如果存在多个数学解，请使用这一物理上的考量来选择正确的解。", "solution": "我们从逻辑斯谛微分方程 $P'(t) = r P(t)\\left(1 - \\frac{P(t)}{K}\\right)$ 开始，并应用后向欧拉法。对于一般常微分方程 $y' = f(t,y)$，后向欧拉法由 $y_{n+1} = y_n + h f(t_{n+1}, y_{n+1})$ 给出。对于逻辑斯谛方程，$f(t,y) = r y \\left(1 - \\frac{y}{K}\\right)$，所以 $P_{n+1}$ 的后向欧拉更新式为\n$$\nP_{n+1} = P_n + h r P_{n+1} \\left(1 - \\frac{P_{n+1}}{K}\\right).\n$$\n令 $X := P_{n+1}$。整理后得到\n$$\nX = P_n + h r X - \\frac{h r}{K} X^{2}.\n$$\n将所有项移到一边，得到一个关于 $X$ 的二次方程：\n$$\n\\frac{h r}{K} X^{2} + (1 - h r) X - P_n = 0.\n$$\n两边同乘以 $K$ 以简化系数，得到\n$$\nh r X^{2} + K (1 - h r) X - K P_n = 0.\n$$\n这是一个二次方程 $a X^{2} + b X + c = 0$，其中 $a = h r$，$b = K (1 - h r)$，以及 $c = - K P_n$。根据二次方程求根公式，\n$$\nX = \\frac{ - b \\pm \\sqrt{ b^{2} - 4 a c } }{ 2 a } = \\frac{ - K (1 - h r) \\pm \\sqrt{ K^{2} (1 - h r)^{2} + 4 h r K P_n } }{ 2 h r }.\n$$\n为了选择具有物理意义的根，我们施加条件 $P_{n+1} \\geq 0$ 以及当 $h \\to 0$ 时有 $P_{n+1} \\to P_n$。考虑两个分支：\n\n1) 取正号：\n$$\nX_{+} = \\frac{ - K (1 - h r) + \\sqrt{ K^{2} (1 - h r)^{2} + 4 h r K P_n } }{ 2 h r }.\n$$\n对于小的 $h$，使用泰勒展开 $\\sqrt{A^{2} + \\epsilon} \\approx A + \\frac{\\epsilon}{2 A}$ 来近似平方根，其中 $A = K (1 - h r)$ 且 $\\epsilon = 4 h r K P_n$，得到\n$$\nX_{+} \\approx \\frac{ - A + \\left( A + \\frac{ \\epsilon }{ 2 A } \\right) }{ 2 h r } = \\frac{ \\epsilon }{ 4 A h r } = \\frac{ 4 h r K P_n }{ 2 \\cdot K (1 - h r) \\cdot 2 h r } = \\frac{ P_n }{ 1 - h r } \\to P_n \\quad \\text{as } h \\to 0,\n$$\n这满足所需的极限条件。此外，对于 $P_n \\geq 0$，被开方数至少为 $K^{2} (1 - h r)^{2}$，所以分子是非负的，因此 $X_{+} \\geq 0$。\n\n2) 取负号：\n$$\nX_{-} = \\frac{ - K (1 - h r) - \\sqrt{ K^{2} (1 - h r)^{2} + 4 h r K P_n } }{ 2 h r }.\n$$\n当 $h \\to 0$ 时，$X_{-} \\approx - \\frac{ 2K(1-hr) }{ 2hr } \\sim - \\frac{ K }{ h r } \\to - \\infty$，这违反了非负性和连续性要求 $P_{n+1} \\to P_n$。\n\n因此，正确的、具有物理意义的解是取正号的分支。将其写成一个略微因式分解的形式可得\n$$\nP_{n+1} = \\frac{K}{2 h r} \\left( - (1 - h r) + \\sqrt{ (1 - h r)^{2} + \\frac{ 4 h r }{ K } P_n } \\right).\n$$\n此表达式在 $P_n \\geq 0$ 时得出 $P_{n+1} \\geq 0$，并且满足当 $h \\to 0$ 时 $P_{n+1} \\to P_n$，符合要求。", "answer": "$$\\boxed{\\frac{K}{2 h r}\\left(-\\left(1-h r\\right)+\\sqrt{\\left(1-h r\\right)^{2}+\\frac{4 h r}{K}P_{n}}\\right)}$$", "id": "2178610"}, {"introduction": "我们为什么要费心使用隐式方法，尤其是当它们在每一步都可能需要更多计算时？这个练习直击问题的核心，它通过一个典型的刚性问题，直接比较了显式方法（RK4）和隐式方法（隐式欧拉法）的计算效率。通过分析稳定性带来的时间步长限制，你将定量地理解为什么对于刚性系统，隐式方法尽管单步成本更高，但总体上却快得多。[@problem_id:3142647]", "problem": "考虑标量常微分方程 (ODE) $y'(t)=\\lambda\\,y(t)$，其中常数 $\\lambda=-10^{6}$，该方程模拟一个强阻尼线性动力学过程。在初值问题的数值分析中，绝对稳定性是通过线性测试方程 $y'=\\lambda y$ 和相应的单步放大因子 $R(z)$ 来评估的，其中 $z=\\lambda\\,\\Delta t$，$\\Delta t0$ 是时间步长。当给定 $z$ 时，若 $|R(z)|\\leq 1$，则该方法对于该步长是绝对稳定的。\n\n您的任务是：\n- 仅使用经典四阶龙格－库塔方法 (RK4) 的定义，将其应用于测试方程 $y'=\\lambda y$，以获得其放大因子 $R_{\\mathrm{RK4}}(z)$ 作为 $z$ 的多项式。然后，将 $z$ 限制在负实数范围内，并通过找到绝对稳定边界与负实轴的交点，确定 $\\lambda=-10^{6}$ 时的最大稳定时间步长 $\\Delta t_{\\max}$。您可以用数值方法求解所得的实系数多项式方程。将 $\\Delta t_{\\max}$ 四舍五入到三位有效数字，并以秒为单位表示。\n- 将隐式欧拉法应用于 $y'=\\lambda y$ 并推导其放大因子 $R_{\\mathrm{IE}}(z)$。用它来证明为什么对于 $\\lambda0$ 选择 $\\Delta t=10^{-2}$ 秒是绝对稳定的。\n- 假设一个计算科学代码对于显式 RK4 的每步墙上时钟成本经测量为 $c_{\\mathrm{RK4}}=2.0\\times 10^{-6}$ 秒，对于隐式欧拉法为 $c_{\\mathrm{IE}}=5.0\\times 10^{-5}$ 秒（由于该标量问题上的非线性求解开销）。要使用各自的稳定步长（RK4 使用 $\\Delta t_{\\max}$；隐式欧拉法使用 $\\Delta t=10^{-2}$）从 $t=0$ 积分到 $t=1$ 秒，计算总墙上时钟时间之比 $T_{\\mathrm{RK4}}/T_{\\mathrm{IE}}$。将您的最终比率四舍五入到三位有效数字。将加速因子表示为无量纲数。\n\n只提供最终的比率作为您的答案。", "solution": "我们按要求将分析分为三部分。\n\n**第一部分：经典四阶龙格－库塔 (RK4) 方法的分析**\n对于初值问题 $y'(t) = f(t, y(t))$，RK4 方法由下式给出：\n$$ y_{n+1} = y_n + \\frac{\\Delta t}{6}(k_1 + 2k_2 + 2k_3 + k_4) $$\n将此方法应用于线性测试方程 $y' = \\lambda y$，并令 $z = \\lambda \\Delta t$，可以推导出其放大因子 $R_{\\mathrm{RK4}}(z) = y_{n+1}/y_n$ 为：\n$$ R_{\\mathrm{RK4}}(z) = 1 + z + \\frac{z^2}{2} + \\frac{z^3}{6} + \\frac{z^4}{24} $$\n该多项式是 $\\exp(z)$ 的泰勒级数在 $z^4$ 项之后的截断。\n\n绝对稳定性要求 $|R_{\\mathrm{RK4}}(z)| \\le 1$。对于本题，$\\lambda = -10^6  0$，所以 $z = \\lambda \\Delta t$ 是负实数。令 $z = -x$，其中 $x > 0$。稳定性条件是 $|R_{\\mathrm{RK4}}(-x)| \\le 1$。由于 $R_{\\mathrm{RK4}}(-x)$ 是实数，此条件等价于 $-1 \\le R_{\\mathrm{RK4}}(-x) \\le 1$。\n$$ R_{\\mathrm{RK4}}(-x) = 1 - x + \\frac{x^2}{2} - \\frac{x^3}{6} + \\frac{x^4}{24} $$\n该函数在 $x=0$ 时为 1，并随 $x$ 增大而减小。稳定区间的边界 $x_0$ 由等式 $R_{\\mathrm{RK4}}(-x_0) = -1$ 给出。即：\n$$ 1 - x_0 + \\frac{x_0^2}{2} - \\frac{x_0^3}{6} + \\frac{x_0^4}{24} = -1 $$\n整理后得到多项式方程：\n$$ \\frac{x_0^4}{24} - \\frac{x_0^3}{6} + \\frac{x_0^2}{2} - x_0 + 2 = 0 $$\n数值求解此方程，可得稳定边界约为 $x_0 \\approx 2.78528$。\n因此，负实轴上的稳定区间约为 $[-2.785, 0]$。最大稳定步长 $\\Delta t_{\\max}$ 由 $|\\lambda \\Delta t_{\\max}| = x_0$ 给出。\n$$ |-10^6 \\times \\Delta t_{\\max}| \\approx 2.78528 \\implies \\Delta t_{\\max} \\approx \\frac{2.78528}{10^6} \\text{ s} \\approx 2.78528 \\times 10^{-6} \\text{ s} $$\n四舍五入到三位有效数字，$\\Delta t_{\\max} \\approx 2.79 \\times 10^{-6}$ 秒。\n\n**第二部分：隐式欧拉法的分析**\n对于 $y' = \\lambda y$，隐式欧拉法为：\n$$ y_{n+1} = y_n + \\Delta t (\\lambda y_{n+1}) $$\n求解 $y_{n+1}$：\n$$ y_{n+1}(1 - \\lambda \\Delta t) = y_n \\implies \\frac{y_{n+1}}{y_n} = \\frac{1}{1 - \\lambda \\Delta t} $$\n放大因子为 $R_{\\mathrm{IE}}(z) = \\frac{1}{1-z}$。\n为了绝对稳定，我们需要 $|R_{\\mathrm{IE}}(z)| \\le 1$。对于 $\\lambda  0$，$z = \\lambda \\Delta t$ 是负实数。\n$$ \\left|\\frac{1}{1-z}\\right| \\le 1 $$\n由于 $z  0$，因此 $1-z > 1$。表达式 $\\frac{1}{1-z}$ 是正数且小于1。因此，对于任何 $z  0$，该不等式总是成立的。这意味着隐式欧拉法是A-稳定的，对于任何负实数 $\\lambda$ 和任何步长 $\\Delta t > 0$ 都是绝对稳定的。因此，选择步长 $\\Delta t = 10^{-2}$ 秒对于 $\\lambda = -10^6$ 是绝对稳定的。\n\n**第三部分：墙上时钟时间的比较**\n从 $t=0$ 积分到 $t=1$ 秒的总时间由步数乘以每步成本给出，即 $T = N \\times c = (\\frac{T_{\\text{end}} - T_{\\text{start}}}{\\Delta t}) \\times c$。\n\n对于 RK4：\n该方法是条件稳定的，要求 $\\Delta t_{\\mathrm{RK4}} = \\Delta t_{\\max} \\approx 2.78528 \\times 10^{-6}$ 秒。\n每步成本为 $c_{\\mathrm{RK4}} = 2.0 \\times 10^{-6}$ 秒。\n总墙上时钟时间为：\n$$ T_{\\mathrm{RK4}} = \\frac{1 \\text{ s}}{\\Delta t_{\\mathrm{RK4}}} \\times c_{\\mathrm{RK4}} = \\frac{1}{2.78528 \\times 10^{-6}} \\times (2.0 \\times 10^{-6}) \\text{ s} = \\frac{2.0}{2.78528} \\text{ s} $$\n\n对于隐式欧拉法：\n该方法是无条件稳定的，允许使用较大的步长 $\\Delta t_{\\mathrm{IE}} = 10^{-2}$ 秒。\n每步成本为 $c_{\\mathrm{IE}} = 5.0 \\times 10^{-5}$ 秒。\n总墙上时钟时间为：\n$$ T_{\\mathrm{IE}} = \\frac{1 \\text{ s}}{\\Delta t_{\\mathrm{IE}}} \\times c_{\\mathrm{IE}} = \\frac{1}{10^{-2}} \\times (5.0 \\times 10^{-5}) \\text{ s} = 100 \\times 5.0 \\times 10^{-5} \\text{ s} = 5.0 \\times 10^{-3} \\text{ s} $$\n\n总墙上时钟时间之比为：\n$$ \\frac{T_{\\mathrm{RK4}}}{T_{\\mathrm{IE}}} = \\frac{2.0 / 2.78528}{5.0 \\times 10^{-3}} = \\frac{0.718085}{0.005} \\approx 143.617 $$\n将最终比率四舍五入到三位有效数字，我们得到 $144$。这表明对于这个刚性问题，隐式方法比显式方法快大约 $144$ 倍，尽管隐式方法每一步的成本高得多，但这得益于它所允许的稳定步长要大得多。", "answer": "$$\\boxed{144}$$", "id": "3142647"}]}