{"hands_on_practices": [{"introduction": "掌握傅里叶级数的第一步是练习其基本功：计算傅里叶系数。本练习提供了一个经典的起点，要求你推导一个简单锯齿波的傅里叶级数。通过这个过程 [@problem_id:8857]，你将直接运用 $a_n$ 和 $b_n$ 的积分公式，并体会到如何利用函数的奇偶对称性等性质来大幅简化计算。", "problem": "一个周期为 $2L$ 的周期函数 $f(x)$，如果满足某些条件（狄利克雷条件），则可以表示为其傅里叶级数。对于定义在区间 $[-L, L]$ 上的函数，其傅里叶级数由下式给出\n$$\nf(x) \\sim \\frac{a_0}{2} + \\sum_{n=1}^{\\infty} \\left[ a_n \\cos\\left(\\frac{n\\pi x}{L}\\right) + b_n \\sin\\left(\\frac{n\\pi x}{L}\\right) \\right]\n$$\n级数的系数 $a_0$、$a_n$ 和 $b_n$ 使用以下公式计算：\n$$\na_0 = \\frac{1}{L} \\int_{-L}^{L} f(x) \\, dx\n$$\n$$\na_n = \\frac{1}{L} \\int_{-L}^{L} f(x) \\cos\\left(\\frac{n\\pi x}{L}\\right) \\, dx \\quad (n \\ge 1)\n$$\n$$\nb_n = \\frac{1}{L} \\int_{-L}^{L} f(x) \\sin\\left(\\frac{n\\pi x}{L}\\right) \\, dx \\quad (n \\ge 1)\n$$\n\n考虑定义在区间 $[-\\pi, \\pi]$ 上的简单线性函数 $f(x) = x$。该函数的周期为 $2\\pi$，因此 $L=\\pi$。\n\n推导该函数在指定区间上的完整傅里叶级数表示。", "solution": "问题是求函数 $f(x) = x$ 在区间 $[-\\pi, \\pi]$ 上的傅里叶级数。周期为 $2L = 2\\pi$，因此 $L=\\pi$。傅里叶级数的一般形式简化为：\n$$\nf(x) \\sim \\frac{a_0}{2} + \\sum_{n=1}^{\\infty} \\left[ a_n \\cos(nx) + b_n \\sin(nx) \\right]\n$$\n我们需要计算系数 $a_0$、$a_n$ 和 $b_n$。\n\n**步骤1：计算系数 $a_0$。**\n$a_0$ 的公式是：\n$$\na_0 = \\frac{1}{\\pi} \\int_{-\\pi}^{\\pi} f(x) \\, dx = \\frac{1}{\\pi} \\int_{-\\pi}^{\\pi} x \\, dx\n$$\n函数 $f(x) = x$ 是一个奇函数，即 $f(-x) = -f(x)$。奇函数在对称区间（如 $[-\\pi, \\pi]$）上的积分为零。\n$$\na_0 = 0\n$$\n或者，可以直接计算积分：\n$$\na_0 = \\frac{1}{\\pi} \\left[ \\frac{x^2}{2} \\right]_{-\\pi}^{\\pi} = \\frac{1}{2\\pi} (\\pi^2 - (-\\pi)^2) = \\frac{1}{2\\pi} (\\pi^2 - \\pi^2) = 0\n$$\n\n**步骤2：计算系数 $a_n$。**\n$a_n$ 的公式是：\n$$\na_n = \\frac{1}{\\pi} \\int_{-\\pi}^{\\pi} f(x) \\cos(nx) \\, dx = \\frac{1}{\\pi} \\int_{-\\pi}^{\\pi} x \\cos(nx) \\, dx\n$$\n被积函数是一个奇函数 ($x$) 和一个偶函数 ($\\cos(nx)$) 的乘积。一个奇函数和一个偶函数的乘积是一个奇函数。因此，在对称区间 $[-\\pi, \\pi]$ 上的积分为零。\n$$\na_n = 0 \\quad \\text{for all } n \\ge 1\n$$\n\n**步骤3：计算系数 $b_n$。**\n$b_n$ 的公式是：\n$$\nb_n = \\frac{1}{\\pi} \\int_{-\\pi}^{\\pi} f(x) \\sin(nx) \\, dx = \\frac{1}{\\pi} \\int_{-\\pi}^{\\pi} x \\sin(nx) \\, dx\n$$\n被积函数是一个奇函数 ($x$) 和一个奇函数 ($\\sin(nx)$) 的乘积。两个奇函数的乘积是一个偶函数。对于一个偶函数 $g(x)$，其在对称区间上的积分为 $\\int_{-a}^{a} g(x) dx = 2\\int_{0}^{a} g(x) dx$。\n$$\nb_n = \\frac{2}{\\pi} \\int_{0}^{\\pi} x \\sin(nx) \\, dx\n$$\n我们使用分部积分法 $\\int u \\, dv = uv - \\int v \\, du$。令 $u = x$ 且 $dv = \\sin(nx) \\, dx$。则 $du = dx$ 且 $v = -\\frac{1}{n}\\cos(nx)$。\n$$\n\\int x \\sin(nx) \\, dx = x \\left(-\\frac{\\cos(nx)}{n}\\right) - \\int \\left(-\\frac{\\cos(nx)}{n}\\right) \\, dx = -\\frac{x\\cos(nx)}{n} + \\frac{1}{n} \\int \\cos(nx) \\, dx\n$$\n$$\n= -\\frac{x\\cos(nx)}{n} + \\frac{\\sin(nx)}{n^2}\n$$\n现在，我们计算这个定积分：\n$$\nb_n = \\frac{2}{\\pi} \\left[ -\\frac{x\\cos(nx)}{n} + \\frac{\\sin(nx)}{n^2} \\right]_{0}^{\\pi}\n$$\n$$\nb_n = \\frac{2}{\\pi} \\left( \\left( -\\frac{\\pi\\cos(n\\pi)}{n} + \\frac{\\sin(n\\pi)}{n^2} \\right) - \\left( 0 + 0 \\right) \\right)\n$$\n我们知道对于任意整数 $n$，$\\sin(n\\pi) = 0$ 且 $\\cos(n\\pi) = (-1)^n$。\n$$\nb_n = \\frac{2}{\\pi} \\left( -\\frac{\\pi(-1)^n}{n} \\right) = -\\frac{2(-1)^n}{n} = \\frac{2(-1)(-1)^n}{n} = \\frac{2(-1)^{n+1}}{n}\n$$\n\n**步骤4：组装傅里叶级数。**\n将系数代入级数公式：\n$$\nf(x) \\sim \\frac{0}{2} + \\sum_{n=1}^{\\infty} \\left[ 0 \\cdot \\cos(nx) + \\frac{2(-1)^{n+1}}{n} \\sin(nx) \\right]\n$$\n$$\nf(x) \\sim \\sum_{n=1}^{\\infty} \\frac{2(-1)^{n+1}}{n} \\sin(nx)\n$$\n这可以展开写成：\n$$\nf(x) \\sim 2 \\left( \\sin(x) - \\frac{1}{2}\\sin(2x) + \\frac{1}{3}\\sin(3x) - \\frac{1}{4}\\sin(4x) + \\dots \\right)\n$$\n所求的傅里叶级数是最终组装好的表达式。", "answer": "$$\n\\boxed{\\sum_{n=1}^{\\infty} \\frac{2(-1)^{n+1}}{n} \\sin(nx)}\n$$", "id": "8857"}, {"introduction": "当我们构建了一个傅里叶级数后，一个自然而然的问题是：这个级数在哪些点上能精确收敛于原函数？答案并非总是简单的“处处相等”，尤其是在函数的边界或不连续点处。本练习 [@problem_id:8873] 深入探讨了这一关键问题，它将焦点放在不连续点上——这是许多真实世界信号的共同特征。你将应用狄利克雷收敛定理，发现级数在“跳跃点”处会巧妙地收敛到左右极限的平均值。", "problem": "考虑一个在区间 $(-L, L)$ 上定义的函数 $f(x) = x$。该函数被扩展为整个实数轴 $\\mathbb{R}$ 上的周期函数，周期为 $T = 2L$。\n\n这样一个函数的傅里叶级数表示为\n$$S(x) = \\frac{a_0}{2} + \\sum_{n=1}^{\\infty} \\left( a_n \\cos\\left(\\frac{n\\pi x}{L}\\right) + b_n \\sin\\left(\\frac{n\\pi x}{L}\\right) \\right)$$\n其中系数 $a_n$ 和 $b_n$ 由函数 $f(x)$ 决定。\n\n根据狄利克雷收敛定理（Dirichlet's Convergence Theorem），对于一个分段连续的周期函数，其傅里叶级数在任意点 $x_0$ 收敛。如果周期函数在 $x_0$ 点连续，则级数收敛于 $f(x_0)$。如果函数在 $x_0$ 点有跳跃间断点，则级数收敛于左右极限的平均值：\n$$S(x_0) = \\frac{1}{2} \\left( \\lim_{x \\to x_0^+} f(x) + \\lim_{x \\to x_0^-} f(x) \\right)$$\n其中极限是针对原始函数的周期性延拓而言的。\n\n给定函数 $f(x) = x$ 在区间 $(-1, 1)$上（因此 $L=1$），求其傅里叶级数在点 $x=1$ 处的收敛值。", "solution": "问题要求函数 $f(x) = x$ 在区间 $(-1, 1)$ 上的傅里叶级数在点 $x=1$ 处的收敛值。这里，区间长度参数为 $L=1$。\n\n点 $x=1$ 是基本区间 $(-1, 1)$ 的一个端点。函数的周期性延拓（我们称之为 $f_p(x)$）将在端点 $x = \\dots, -3, -1, 1, 3, \\dots$ 处具有跳跃间断点。我们必须使用狄利克雷收敛定理来处理间断点。\n\n该定理指出，在间断点 $x_0$ 处，傅里叶级数收敛于该点周期函数的左右极限的平均值：\n$$S(x_0) = \\frac{1}{2} \\left[ \\lim_{x \\to x_0^+} f_p(x) + \\lim_{x \\to x_0^-} f_p(x) \\right]$$\n\n在我们的例子中，$x_0 = 1$。我们需要求出周期性延拓 $f_p(x)$ 在 $x=1$ 处的左右极限。\n\n**1. 左极限：**\n左极限是通过 $x$ 从小于 $1$ 的值趋近于 $1$ 来计算的。对于这些 $x$ 值，我们处于原始定义区间 $(-1, 1)$ 内。\n$$\n\\lim_{x \\to 1^-} f_p(x) = \\lim_{x \\to 1^-} f(x) = \\lim_{x \\to 1^-} x\n$$\n计算此极限可得：\n$$\n\\lim_{x \\to 1^-} x = 1\n$$\n\n**2. 右极限：**\n右极限是通过 $x$ 从大于 $1$ 的值趋近于 $1$ 来计算的。对于这些值，我们必须使用函数的周期性。该函数是周期性的，周期为 $T=2L=2$。这意味着 $f_p(x) = f_p(x-2)$。\n因此，当 $x \\to 1^+$ 时的极限等价于当 $x \\to 1^+$ 时 $f_p(x-2)$ 的极限。令 $u = x-2$。当 $x \\to 1^+$ 时，$u \\to (1-2)^+ = -1^+$。\n$$\n\\lim_{x \\to 1^+} f_p(x) = \\lim_{x \\to 1^+} f_p(x-2) = \\lim_{u \\to -1^+} f_p(u)\n$$\n当 $u$ 从右侧趋近于 $-1$ 时，它位于原始定义区间 $(-1, 1)$ 内。因此，$f_p(u) = f(u) = u$。\n$$\n\\lim_{u \\to -1^+} f_p(u) = \\lim_{u \\to -1^+} u = -1\n$$\n所以，右极限为：\n$$\n\\lim_{x \\to 1^+} f_p(x) = -1\n$$\n\n**3. 极限的平均值：**\n现在，我们将这些极限代入狄利克雷收敛公式：\n$$\nS(1) = \\frac{1}{2} \\left[ \\lim_{x \\to 1^+} f_p(x) + \\lim_{x \\to 1^-} f_p(x) \\right]\n$$\n$$\nS(1) = \\frac{1}{2} \\left[ (-1) + 1 \\right]\n$$\n$$\nS(1) = \\frac{1}{2} (0) = 0\n$$\n因此，$f(x)=x$ 在 $(-1,1)$ 上的傅里叶级数在点 $x=1$ 处收敛于 $0$。", "answer": "$$\\boxed{0}$$", "id": "8873"}, {"introduction": "现在，让我们将理论与计算实践联系起来。基于我们对不连续点的理解，本练习 [@problem_id:3132915] 将引导你通过编程来探索著名的吉布斯现象。你会发现，在跳跃不连续点附近，傅里叶级数的近似函数会系统性地“过冲”原函数的值，即便我们增加非常多的项，这种现象依然存在。这项动手编程的数值研究，为理解傅里叶近似在信号分析中的一个关键特性与局限性，提供了具体而直观的认识。", "problem": "考虑一个 $2\\pi$-周期函数 $f(x)=\\mathrm{sgn}(\\sin x)$，其定义为：当 $x\\in(0,\\pi)$ 时 $f(x)=+1$；当 $x\\in(-\\pi,0)$ 时 $f(x)=-1$。该函数被周期性延拓，并且按照惯例，在傅里叶分析中不需要跳跃点处的值。从 $2\\pi$-周期函数 $f$ 的傅里叶级数的基本定义出发，\n$$a_0=\\frac{1}{\\pi}\\int_{-\\pi}^{\\pi} f(x)\\,dx,\\quad a_n=\\frac{1}{\\pi}\\int_{-\\pi}^{\\pi} f(x)\\cos(nx)\\,dx,\\quad b_n=\\frac{1}{\\pi}\\int_{-\\pi}^{\\pi} f(x)\\sin(nx)\\,dx,$$\n推导其正弦级数系数，并为 $f(x)$ 构建 $N$ 项奇次谐波部分和 $S_N(x)$，其中 $N$ 表示保留的奇次谐波的数量。角度必须以弧度为单位。仅使用这些基本定义来求得 $S_N(x)$；不要假定任何预先给定的傅里叶系数公式。\n\n对于给定的 $N$，将在 $x=0$ 处跳跃点附近的吉布斯过冲比定义为\n$$r_N=\\frac{\\max_{x\\in(0,\\pi)} S_N(x)-f(0^+)}{\\Delta f},$$\n其中 $f(0^+)=+1$ 是跳跃点处的右极限，$\\Delta f= f(0^+)-f(0^-)=2$ 是跳跃幅度。通过在区间 $(0,\\pi/2)$ 内定位 $S_N(x)$ 的第一个局部最大值来数值上估计 $r_N$；一种稳健的方法是在一个粗网格上计算 $S_N(x)$ 以界定第一个局部最大值的范围，然后在此范围内的一个更密的子网格上进行细化搜索。数值上验证当 $N\\to\\infty$ 时，$r_N$ 趋近于已知的吉布斯极限过冲常数 $\\approx 0.08949$。\n\n您的程序必须：\n- 根据推导出的傅里叶系数，仅使用奇次谐波来构建 $S_N(x)$。\n- 通过两阶段网格搜索（粗略界定后进行局部细化）在 $(0,\\pi/2)$ 区间内找到 $S_N(x)$ 的第一个局部最大值。\n- 使用上述定义计算 $r_N$，角度以弧度为单位。\n\n测试套件：\n- 使用 $N\\in\\{1,3,25,200\\}$ 来探究小数、中等和大量的谐波，包括边界行为（$N=1$）和近渐近行为（$N=200$）。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，顺序为 $[r_1,r_3,r_{25},r_{200},\\text{is\\_close}]$。$r_N$ 的值必须四舍五入到 $5$ 位小数。最后一项 $\\text{is\\_close}$ 必须是一个布尔值，指示 $|r_{200}-0.08949|\\leq 5\\times 10^{-4}$ 是否成立。例如，输出必须看起来像 $[0.12345,0.06789,0.09123,0.08949,True]$。", "solution": "用户提供的问题是一个关于傅里叶分析的适定且有科学依据的练习，具体涉及方波的吉布斯现象。所有定义和常数都是标准且正确的。任务是推导傅里叶级数，实现部分和，并数值研究过冲。该问题是有效的，将提供一个解决方案。\n\n问题要求分析 $2\\pi$-周期函数 $f(x) = \\mathrm{sgn}(\\sin x)$。该函数定义为当 $x \\in (0, \\pi)$ 时，$f(x)=+1$；当 $x \\in (-\\pi, 0)$ 时，$f(x)=-1$。\n\n首先，我们使用提供的积分定义来确定傅里叶系数 $a_0$、$a_n$ 和 $b_n$。我们从分析 $f(x)$ 的对称性开始。该函数是奇函数，因为对于任何 $x$，都有 $f(-x) = \\mathrm{sgn}(\\sin(-x)) = \\mathrm{sgn}(-\\sin x) = -\\mathrm{sgn}(\\sin x) = -f(x)$。奇函数的傅里叶级数简化为纯正弦级数，这意味着所有余弦系数 $a_0$ 和 $a_n$ 都必须为零。我们将明确地验证这一点。\n\n系数 $a_0$ 由下式给出：\n$$a_0 = \\frac{1}{\\pi} \\int_{-\\pi}^{\\pi} f(x) \\, dx = \\frac{1}{\\pi} \\left( \\int_{-\\pi}^{0} (-1) \\, dx + \\int_{0}^{\\pi} (+1) \\, dx \\right)$$\n$$a_0 = \\frac{1}{\\pi} \\left( [-x]_{-\\pi}^{0} + [x]_{0}^{\\pi} \\right) = \\frac{1}{\\pi} \\left( (-(0) - (-(-\\pi))) + ((\\pi) - (0)) \\right) = \\frac{1}{\\pi} (-\\pi + \\pi) = 0$$\n\n当 $n \\ge 1$ 时，系数 $a_n$ 由下式给出：\n$$a_n = \\frac{1}{\\pi} \\int_{-\\pi}^{\\pi} f(x) \\cos(nx) \\, dx$$\n被积函数是一个奇函数 $f(x)$ 和一个偶函数 $\\cos(nx)$ 的乘积。结果的乘积是一个奇函数。任何奇函数在对称区间如 $[-\\pi, \\pi]$ 上的积分都为零。因此，对于所有 $n \\ge 1$，$a_n=0$。\n\n当 $n \\ge 1$ 时，正弦系数 $b_n$ 由下式给出：\n$$b_n = \\frac{1}{\\pi} \\int_{-\\pi}^{\\pi} f(x) \\sin(nx) \\, dx$$\n被积函数是两个奇函数 $f(x)$ 和 $\\sin(nx)$ 的乘积。该乘积是一个偶函数。偶函数在对称区间 $[-\\pi, \\pi]$ 上的积分是在半区间 $[0, \\pi]$ 上积分的两倍。\n$$b_n = \\frac{2}{\\pi} \\int_{0}^{\\pi} f(x) \\sin(nx) \\, dx$$\n对于 $x \\in (0, \\pi)$，我们有 $f(x)=+1$。\n$$b_n = \\frac{2}{\\pi} \\int_{0}^{\\pi} (1) \\sin(nx) \\, dx = \\frac{2}{\\pi} \\left[ -\\frac{\\cos(nx)}{n} \\right]_{0}^{\\pi}$$\n$$b_n = -\\frac{2}{n\\pi} [\\cos(n\\pi) - \\cos(0)] = \\frac{2}{n\\pi} (1 - \\cos(n\\pi))$$\n由于 $\\cos(n\\pi) = (-1)^n$，表达式变为：\n$$b_n = \\frac{2}{n\\pi} (1 - (-1)^n)$$\n这个结果意味着，如果 $n$ 是偶数（例如 $n=2k$），则 $b_{2k} = \\frac{2}{2k\\pi} (1 - 1) = 0$。如果 $n$ 是奇数（例如 $n=2k-1$，其中 $k=1, 2, \\dots$），则 $b_{2k-1} = \\frac{2}{(2k-1)\\pi} (1 - (-1)) = \\frac{4}{(2k-1)\\pi}$。\n\n问题将部分和 $S_N(x)$ 定义为保留前 $N$ 个奇次谐波。这对应于对 $k=1, \\dots, N$ 的项求和。所得的部分和为：\n$$S_N(x) = \\sum_{k=1}^{N} b_{2k-1} \\sin((2k-1)x) = \\sum_{k=1}^{N} \\frac{4}{(2k-1)\\pi} \\sin((2k-1)x)$$\n$$S_N(x) = \\frac{4}{\\pi} \\sum_{k=1}^{N} \\frac{\\sin((2k-1)x)}{2k-1}$$\n\n接下来，我们处理吉布斯过冲比 $r_N$。它定义为：\n$$r_N = \\frac{\\max_{x\\in(0,\\pi)} S_N(x) - f(0^+)}{\\Delta f}$$\n根据给定值 $f(0^+) = 1$ 和跳跃幅度 $\\Delta f = f(0^+) - f(0^-) = 1 - (-1) = 2$，该公式变为：\n$$r_N = \\frac{\\max_{x\\in(0,\\pi)} S_N(x) - 1}{2}$$\n为了找到 $S_N(x)$ 的最大值，我们必须找到它在区间 $(0, \\pi/2)$ 内的第一个峰值的位置。解析地，这个点可以通过求解 $S_N'(x)=0$ 来找到。其导数为：\n$$S_N'(x) = \\frac{d}{dx} \\left( \\frac{4}{\\pi} \\sum_{k=1}^{N} \\frac{\\sin((2k-1)x)}{2k-1} \\right) = \\frac{4}{\\pi} \\sum_{k=1}^{N} \\cos((2k-1)x)$$\n使用三角恒等式 $\\sum_{k=1}^{N} \\cos((2k-1)x) = \\frac{\\sin(2Nx)}{2\\sin x}$，我们得到：\n$$S_N'(x) = \\frac{4}{\\pi} \\frac{\\sin(2Nx)}{2\\sin x} = \\frac{2 \\sin(2Nx)}{\\pi \\sin x}$$\n$S_N'(x)=0$ 的第一个正根出现在 $2Nx = \\pi$ 时，因此 $x_{\\text{max}} = \\frac{\\pi}{2N}$。问题中规定的数值方法——两阶段网格搜索——将被用来近似这个最大值。首先，在 $(0, \\pi/2)$ 上进行粗网格搜索，以确定最大值周围的一个狭窄区间。其次，在这个区间内进行细网格搜索，以高精度地确定 $S_N(x)$ 的最大值。\n\n提供的 Python 代码将为指定的 $N \\in \\{1, 3, 25, 200\\}$ 值实现这一逻辑，计算 $r_N$，并验证 $r_{200}$ 对已知吉布斯常数的渐近收敛性。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef s_n(x_vals, N):\n    \"\"\"\n    Calculates the N-term odd-harmonic partial sum of the Fourier series for sgn(sin(x)).\n    \n    Args:\n        x_vals (np.ndarray): An array of x values (in radians) at which to evaluate the sum.\n        N (int): The number of odd harmonics to include in the sum.\n        \n    Returns:\n        np.ndarray: The values of S_N(x) corresponding to each x in x_vals.\n    \"\"\"\n    # The sum is over k=1 to N for harmonics n=2k-1.\n    k = np.arange(1, N + 1)\n    n_harmonics = 2 * k - 1\n    \n    # Use broadcasting for an efficient vectorized calculation.\n    # x_vals shape: (M,) -> (M, 1)\n    # n_harmonics shape: (N,)\n    # Resulting shape of arg: (M, N)\n    x_col = x_vals[:, np.newaxis]\n    arg = x_col * n_harmonics\n    \n    # Perform the summation\n    terms = np.sin(arg) / n_harmonics\n    sum_val = np.sum(terms, axis=1)\n    \n    return (4 / np.pi) * sum_val\n\ndef calculate_r(N):\n    \"\"\"\n    Numerically estimates the Gibbs overshoot ratio r_N for a given N.\n\n    Args:\n        N (int): The number of odd harmonics.\n\n    Returns:\n        float: The estimated value of r_N.\n    \"\"\"\n    # Stage 1: Coarse grid search to bracket the first maximum in (0, pi/2).\n    # We use a small positive number for the start of the interval to avoid x=0.\n    coarse_grid = np.linspace(1e-9, np.pi / 2, 2000)\n    s_coarse = s_n(coarse_grid, N)\n    idx_max_coarse = np.argmax(s_coarse)\n\n    # Define the search bracket for the fine grid. Handle edge cases.\n    if idx_max_coarse == 0:\n        bracket_start = coarse_grid[0]\n        bracket_end = coarse_grid[1]\n    elif idx_max_coarse == len(coarse_grid) - 1:\n        bracket_start = coarse_grid[-2]\n        bracket_end = coarse_grid[-1]\n    else:\n        bracket_start = coarse_grid[idx_max_coarse - 1]\n        bracket_end = coarse_grid[idx_max_coarse + 1]\n\n    # Stage 2: Fine grid search within the bracket to find the maximum value.\n    fine_grid = np.linspace(bracket_start, bracket_end, 10000)\n    s_fine = s_n(fine_grid, N)\n    s_max = np.max(s_fine)\n\n    # Calculate the Gibbs overshoot ratio r_N.\n    # f(0^+) = 1.0, Delta_f = f(0^+) - f(0^-) = 1 - (-1) = 2.0\n    f0_plus = 1.0\n    delta_f = 2.0\n    r_N = (s_max - f0_plus) / delta_f\n    \n    return r_N\n\ndef solve():\n    \"\"\"\n    Main function to execute the problem, calculate r_N for the test suite,\n    and print the final results in the required format.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [1, 3, 25, 200]\n\n    results = []\n    for N in test_cases:\n        r_val = calculate_r(N)\n        results.append(r_val)\n\n    # Format the r_N values to 5 decimal places.\n    formatted_results = [f\"{r:.5f}\" for r in results]\n    \n    # Check if r_200 is close to the theoretical Gibbs constant.\n    gibbs_constant = 0.08949\n    tolerance = 5e-4\n    r_200 = results[-1]\n    is_close = abs(r_200 - gibbs_constant) = tolerance\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)},{is_close}]\")\n\nsolve()\n```", "id": "3132915"}]}