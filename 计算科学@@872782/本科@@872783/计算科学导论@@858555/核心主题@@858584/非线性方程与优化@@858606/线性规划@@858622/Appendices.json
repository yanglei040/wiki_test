{"hands_on_practices": [{"introduction": "在线性规划中，最优解（如果存在）总是在可行域的“角落”或顶点上找到。这个练习将几何直觉与代数方法联系起来，引导你系统地找出所有这些顶点，即所谓的基本可行解。掌握这项技能是理解单纯形法等求解算法如何运作的基石，因为它正是通过在这些顶点之间移动来寻找最优解的 [@problem_id:2180575]。", "problem": "考虑一个包含两个决策变量 $x_1$ 和 $x_2$ 的线性规划问题。该问题的可行域由以下约束条件组定义：\n$$\n\\begin{align*}\n3x_1 + 2x_2 \\le 12 \\\\\nx_1 + 4x_2 \\le 10 \\\\\nx_1 \\ge 0 \\\\\nx_2 \\ge 0\n\\end{align*}\n$$\n该系统的一个基本解可以通过将其转换为标准形式，并令特定数量的变量为零来求得。如果一个基本解也满足所有非负约束，则称其为基本可行解。\n\n你的任务是，用代数方法确定该系统的所有不同的基本可行解。然后，计算所有这些基本可行解的 $x_1$ 坐标之和。将最终答案表示为最简精确分数。", "solution": "引入松弛变量 $s_{1}$ 和 $s_{2}$ 将不等式转换为等式，得到标准形式\n$$\n\\begin{aligned}\n3x_{1}+2x_{2}+s_{1}=12,\\\\\nx_{1}+4x_{2}+s_{2}=10,\n\\end{aligned}\n$$\n其中 $x_{1},x_{2},s_{1},s_{2}\\geq 0$。这里有 $2$ 个方程，因此一个基本解可以通过选择任意 $2$ 个变量作为基变量，并将另外 $2$ 个变量设为零，然后求解得到。一个基本可行解（BFS）额外要求所有变量均为非负。\n\n1. 基 $\\{s_{1},s_{2}\\}$：令 $x_{1}=0$, $x_{2}=0$。则 $s_{1}=12$, $s_{2}=10$。这是可行的，得到 $(x_{1},x_{2})=(0,0)$。\n\n2. 基 $\\{x_{1},s_{1}\\}$：令 $x_{2}=0$, $s_{2}=0$。从 $x_{1}+4x_{2}+s_{2}=10$ 我们得到 $x_{1}=10$。然后 $3x_{1}+2x_{2}+s_{1}=12$ 得到 $s_{1}=12-3\\cdot 10=-18$。不可行；舍去。\n\n3. 基 $\\{x_{2},s_{1}\\}$：令 $x_{1}=0$, $s_{2}=0$。从 $x_{1}+4x_{2}+s_{2}=10$ 我们得到 $4x_{2}=10$，所以 $x_{2}=\\frac{5}{2}$。然后 $3x_{1}+2x_{2}+s_{1}=12$ 得到 $s_{1}=12-2\\cdot\\frac{5}{2}=12-5=7\\geq 0$。可行，得到 $(x_{1},x_{2})=(0,\\frac{5}{2})$。\n\n4. 基 $\\{x_{1},s_{2}\\}$：令 $x_{2}=0$, $s_{1}=0$。从 $3x_{1}+2x_{2}+s_{1}=12$ 我们得到 $3x_{1}=12$，所以 $x_{1}=4$。然后 $x_{1}+4x_{2}+s_{2}=10$ 得到 $s_{2}=10-4=6\\geq 0$。可行，得到 $(x_{1},x_{2})=(4,0)$。\n\n5. 基 $\\{x_{2},s_{2}\\}$：令 $x_{1}=0$, $s_{1}=0$。从 $3x_{1}+2x_{2}+s_{1}=12$ 我们得到 $2x_{2}=12$，所以 $x_{2}=6$。然后 $x_{1}+4x_{2}+s_{2}=10$ 得到 $s_{2}=10-24=-14$。不可行；舍去。\n\n6. 基 $\\{x_{1},x_{2}\\}$：令 $s_{1}=0$, $s_{2}=0$。求解\n$$\n\\begin{aligned}\n3x_{1}+2x_{2}=12,\\\\\nx_{1}+4x_{2}=10.\n\\end{aligned}\n$$\n将第二个方程乘以 $3$ 得到 $3x_{1}+12x_{2}=30$，减去第一个方程得到 $10x_{2}=18$，因此 $x_{2}=\\frac{9}{5}$。代入 $x_{1}+4x_{2}=10$ 得到 $x_{1}=10-4\\cdot\\frac{9}{5}=\\frac{14}{5}$。两者都是非负的，所以 $(x_{1},x_{2})=\\left(\\frac{14}{5},\\frac{9}{5}\\right)$ 是可行的。\n\n因此，不同的基本可行解为 $(0,0)$, $\\left(0,\\frac{5}{2}\\right)$, $(4,0)$ 和 $\\left(\\frac{14}{5},\\frac{9}{5}\\right)$。$x_{1}$ 坐标之和为\n$$\n0+0+4+\\frac{14}{5}=\\frac{20}{5}+\\frac{14}{5}=\\frac{34}{5}.\n$$", "answer": "$$\\boxed{\\frac{34}{5}}$$", "id": "2180575"}, {"introduction": "在我们确定了基本可行解是潜在的最优解之后，下一步便是理解如何在这些解之间进行搜索。单纯形法提供了一种系统性的方法，但如果可行域在某个能提升目标函数的方向上无限延伸，会发生什么呢？这个练习让你能够亲手诊断这种“无界”情况，通过运用单纯形法的核心机制——检验数和变换后的列向量——来识别无界性。这不仅加深了你对算法内部运作的理解，也让你对线性规划问题的几何本质有了更深刻的认识 [@problem_id:3154236]。", "problem": "考虑一个标准型的线性规划 (LP) 问题，其原始目标为在约束 $A x = b$ 和 $x \\ge 0$ 下最大化 $c^{T} x$。约束矩阵 $A \\in \\mathbb{R}^{2 \\times 4}$、右端向量 $b \\in \\mathbb{R}^{2}$ 和目标系数向量 $c \\in \\mathbb{R}^{4}$ 如下所示：\n$$\nA = \\begin{pmatrix}\n2  0  1  -4 \\\\\n1  1  2  -3\n\\end{pmatrix}, \\quad\nb = \\begin{pmatrix}\n8 \\\\ 7\n\\end{pmatrix}, \\quad\nc = \\begin{pmatrix}\n3 \\\\ -1 \\\\ 0 \\\\ 2\n\\end{pmatrix}.\n$$\n考虑由 $A$ 的前两列构成的基 $B$，即 $B = \\begin{pmatrix} 2  0 \\\\ 1  1 \\end{pmatrix}$，其基变量索引集为 $\\{1,2\\}$，非基变量索引集为 $\\{3,4\\}$。关注与基 $B$ 相关联的基本可行解，并仅使用核心定义（基本可行解、检验数和可行方向）从第一性原理出发进行推理。\n\n通过识别一个非基索引 $j$（该索引满足无界性的诊断条件），判断此基本可行解是否能证明原始问题是无界的。然后，在决策空间中追踪那条在增加目标函数值的同时保持可行性的对应射线。计算从给定的基本可行解开始，沿此射线每单位参数目标函数 $c^{T} x$ 的精确标量增长率。将最终答案表示为单个实数，无需四舍五入。", "solution": "首先，我们根据基索引 $\\mathcal{B} = \\{1, 2\\}$ 和非基索引 $\\mathcal{N} = \\{3, 4\\}$ 对矩阵和向量进行分块。基矩阵 $A_B$、非基矩阵 $A_N$、基变量 $x_B$、非基变量 $x_N$、以及对应的目标函数系数 $c_B$ 和 $c_N$ 如下：\n$$\nA_B = \\begin{pmatrix} 2  0 \\\\ 1  1 \\end{pmatrix}, \\quad A_N = \\begin{pmatrix} 1  -4 \\\\ 2  -3 \\end{pmatrix}\n$$\n$$\nx_B = \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix}, \\quad x_N = \\begin{pmatrix} x_3 \\\\ x_4 \\end{pmatrix}\n$$\n$$\nc_B = \\begin{pmatrix} 3 \\\\ -1 \\end{pmatrix}, \\quad c_N = \\begin{pmatrix} 0 \\\\ 2 \\end{pmatrix}\n$$\n我们通过设置非基变量为零 ($x_N = 0$) 来计算与该基对应的基本解，并求解 $A_B x_B = b$：\n$$\n\\begin{pmatrix} 2  0 \\\\ 1  1 \\end{pmatrix} \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix} = \\begin{pmatrix} 8 \\\\ 7 \\end{pmatrix}\n$$\n从第一行得到 $2x_1 = 8$，解得 $x_1 = 4$。代入第二行，$4 + x_2 = 7$，解得 $x_2 = 3$。由于 $x_1$ 和 $x_2$ 均为非负，这是一个基本可行解（BFS），其完整向量为 $x = (4, 3, 0, 0)^T$。\n\n接下来，我们计算非基变量的检验数（reduced costs）$\\bar{c}_j = c_j - c_B^T A_B^{-1} a_j$ 来判断是否存在改进方向。首先计算 $A_B$ 的逆矩阵：\n$$\nA_B^{-1} = \\frac{1}{(2)(1) - (0)(1)} \\begin{pmatrix} 1  0 \\\\ -1  2 \\end{pmatrix} = \\begin{pmatrix} 1/2  0 \\\\ -1/2  1 \\end{pmatrix}\n$$\n然后计算单纯形乘子 $y^T = c_B^T A_B^{-1}$：\n$$\ny^T = \\begin{pmatrix} 3  -1 \\end{pmatrix} \\begin{pmatrix} 1/2  0 \\\\ -1/2  1 \\end{pmatrix} = \\begin{pmatrix} 3/2 + 1/2    0 - 1 \\end{pmatrix} = \\begin{pmatrix} 2  -1 \\end{pmatrix}\n$$\n现在计算检验数：\n对于 $j=3$：$\\bar{c}_3 = c_3 - y^T a_3 = 0 - \\begin{pmatrix} 2  -1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix} = 0 - (2 - 2) = 0$。\n对于 $j=4$：$\\bar{c}_4 = c_4 - y^T a_4 = 2 - \\begin{pmatrix} 2  -1 \\end{pmatrix} \\begin{pmatrix} -4 \\\\ -3 \\end{pmatrix} = 2 - (-8 + 3) = 2 - (-5) = 7$。\n\n由于 $\\bar{c}_4 = 7 > 0$，增加 $x_4$ 的值可以提高目标函数值。现在我们需要检查这样做是否会导致任何基变量变为负数。我们计算方向向量 $d_4 = A_B^{-1} a_4$：\n$$\nd_4 = A_B^{-1} a_4 = \\begin{pmatrix} 1/2  0 \\\\ -1/2  1 \\end{pmatrix} \\begin{pmatrix} -4 \\\\ -3 \\end{pmatrix} = \\begin{pmatrix} -2 \\\\ 2 - 3 \\end{pmatrix} = \\begin{pmatrix} -2 \\\\ -1 \\end{pmatrix}\n$$\n当 $x_4$ 增加 $t$ ($t \\ge 0$) 时，基变量会更新为 $x_B(t) = x_B - d_4 t = \\begin{pmatrix} 4 \\\\ 3 \\end{pmatrix} - t \\begin{pmatrix} -2 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} 4 + 2t \\\\ 3 + t \\end{pmatrix}$。\n由于 $d_4$ 的所有分量都是非正数，当 $t$ 增加时，$x_B(t)$ 的所有分量也会增加（或保持不变），因此始终保持非负。这意味着我们可以无限增加 $x_4$ 而不违反可行性。因此，该问题是无界的。\n\n目标函数值随 $t$ 的变化率为 $\\frac{dz}{dt} = \\bar{c}_4 = 7$。这就是沿无界射线每单位参数目标函数的增长率。", "answer": "$$\n\\boxed{7}\n$$", "id": "3154236"}, {"introduction": "理论知识的真正威力在于解决实际问题。这个经典的“饮食问题”练习将带你从理论走向应用，不仅让你学习如何将一个现实场景构建成线性规划模型，更重要的是引入了灵敏度分析。通过这项实践，你将学会如何评估外部参数（如食品价格）的变化对最优饮食策略的影响，这让你从仅仅寻找一个静态的最优解，转向理解动态系统中的权衡与变化，这是计算科学家和分析师的一项关键技能 [@problem_id:2406884]。", "problem": "考虑一个成本最小化的饮食模型，该模型被表述为针对五种食物的线性规划（LP）问题：牛油果、鸡胸肉、黑豆、白米和西兰花。设决策变量为非负的食用份数，分别表示为 $x_{A}$（牛油果）、$x_{C}$（鸡肉）、$x_{B}$（豆类）、$x_{R}$（米饭）和 $x_{Br}$（西兰花）。每份食物的营养成分如下：牛油果提供 $240$ 千卡热量、$3$ 克蛋白质、$22$ 克脂肪和 $10$ 克纤维；鸡肉提供 $200$ 千卡热量、$35$ 克蛋白质、$5$ 克脂肪和 $0$ 克纤维；豆类提供 $180$ 千卡热量、$12$ 克蛋白质、$1$ 克脂肪和 $12$ 克纤维；米饭提供 $220$ 千卡热量、$4$ 克蛋白质、$1$ 克脂肪和 $1$ 克纤维；西兰花提供 $55$ 千卡热量、$4$ 克蛋白质、$0$ 克脂肪和 $5$ 克纤维。每日最低需求为 $2000$ 千卡热量、$50$ 克蛋白质、$44$ 克脂肪和 $30$ 克纤维。要最小化的总成本为 $c_{A} x_{A} + 2.5 x_{C} + 1.2 x_{B} + 0.6 x_{R} + 0.8 x_{Br}$，其中 $c_{A} \\ge 0$ 是每份牛油果的价格，其他价格以相同的货币单位/份固定。模型为\n$$\n\\min_{x_{A},x_{C},x_{B},x_{R},x_{Br} \\ge 0} \\; c_{A} x_{A} + 2.5 x_{C} + 1.2 x_{B} + 0.6 x_{R} + 0.8 x_{Br}\n$$\n受制于营养需求约束\n$$\n240 x_{A} + 200 x_{C} + 180 x_{B} + 220 x_{R} + 55 x_{Br} \\ge 2000,\n$$\n$$\n3 x_{A} + 35 x_{C} + 12 x_{B} + 4 x_{R} + 4 x_{Br} \\ge 50,\n$$\n$$\n22 x_{A} + 5 x_{C} + 1 x_{B} + 1 x_{R} + 0 x_{Br} \\ge 44,\n$$\n$$\n10 x_{A} + 0 x_{C} + 12 x_{B} + 1 x_{R} + 5 x_{Br} \\ge 30.\n$$\n所有份数均为无量纲的份数计数，成本以统一的货币单位/份计算。对于每个指定的牛油果价格 $c_{A}$，该模型都有一个明确定义的最优解。\n\n任务：通过对一组牛油果价格 $c_{A}$ 求解上述问题，对牛油果的目标函数系数 $c_{A}$ 进行敏感性分析，并在每种情况下，返回最优牛油果数量 $x_{A}^{\\star}$（以份为单位）和最优最低总成本 $z^{\\star}$（以相同的货币单位）。报告 $x_{A}^{\\star}$ 和 $z^{\\star}$，四舍五入到小数点后 $4$ 位。\n\n待分析的牛油果价格测试套件：\n- 正常路径中等价格：$c_{A} = 1.00$。\n- 低价（趋向于以牛油果为主的边缘情况）：$c_{A} = 0.50$。\n- 可能发生基变更前的中高价格：$c_{A} = 10.00$。\n- 可能发生基变更后的高价：$c_{A} = 12.00$。\n- 非常高的价格（趋向于排除牛油果的边缘情况）：$c_{A} = 25.00$。\n\n最终输出格式：您的程序应生成单行输出，其中包含一个逗号分隔的 $[x_{A}^{\\star},z^{\\star}]$ 对列表，用方括号括起来，顺序与测试套件中的顺序完全相同。将每个数字四舍五入到小数点后 $4$ 位。例如：$[[0.0000,123.4567],[1.2345,67.8901]]$。", "solution": "该问题要求对一个线性规划（LP）模型的目标函数系数进行敏感性分析。具体来说，我们需要在牛油果价格 $c_A$ 取不同值时，求解一个成本最小化的饮食问题。\n\n该LP模型可以写成标准矩阵形式：最小化 $z = \\mathbf{c}^T \\mathbf{x}$，约束条件为 $\\mathbf{A}\\mathbf{x} \\ge \\mathbf{b}$ 和 $\\mathbf{x} \\ge \\mathbf{0}$。\n- 决策变量向量 $\\mathbf{x} = [x_{A}, x_{C}, x_{B}, x_{R}, x_{Br}]^T$ 代表五种食物的份数。\n- 成本向量 $\\mathbf{c} = [c_{A}, 2.5, 1.2, 0.6, 0.8]^T$。\n- 营养矩阵 $\\mathbf{A}$ 和需求向量 $\\mathbf{b}$ 分别为：\n$$\n\\mathbf{A} = \\begin{pmatrix}\n240   200  180  220  55 \\\\\n3     35   12   4    4 \\\\\n22    5    1    1    0 \\\\\n10    0    12   1    5\n\\end{pmatrix},\n\\quad\n\\mathbf{b} = \\begin{pmatrix}\n2000 \\\\\n50 \\\\\n44 \\\\\n30\n\\end{pmatrix}\n$$\n为了使用标准的LP求解器（例如 Python 的 `scipy.optimize.linprog`），我们需要将“大于等于”的约束 $\\mathbf{A}\\mathbf{x} \\ge \\mathbf{b}$ 转换为“小于等于”的形式。这可以通过将不等式两边乘以 $-1$ 来实现：$-\\mathbf{A}\\mathbf{x} \\le -\\mathbf{b}$。\n\n我们的求解策略如下：\n1.  定义常量矩阵 $\\mathbf{A}$ 和向量 $\\mathbf{b}$。\n2.  遍历给定的牛油果价格 $c_A$ 列表：$\\{1.00, 0.50, 10.00, 12.00, 25.00\\}$。\n3.  对于每个 $c_A$ 值，构建相应的成本向量 $\\mathbf{c}$。\n4.  调用LP求解器，使用成本向量 $\\mathbf{c}$、转换后的约束矩阵 $-\\mathbf{A}$、转换后的需求向量 $-\\mathbf{b}$ 以及非负性边界条件。\n5.  从求解结果中提取最优牛油果份数 $x_A^\\star$ 和最优总成本 $z^\\star$。\n6.  将所有结果存储并格式化为指定的输出字符串，其中所有数值四舍五入到小数点后四位。\n\n这个过程将系统地为每个给定的价格点计算出最优饮食方案和成本，从而完成敏感性分析。", "answer": "```python\nimport numpy as np\nfrom scipy.optimize import linprog\n\ndef solve_diet_sensitivity_analysis():\n    \"\"\"\n    Solves a cost-minimization diet problem for a range of avocado prices.\n    The problem is formulated as a Linear Program and solved using SciPy.\n    \"\"\"\n    # Nutritional content matrix A (rows: nutrients, cols: foods)\n    # Foods: Avocado, Chicken, Beans, Rice, Broccoli\n    A = np.array([\n        [240, 200, 180, 220, 55],  # Kilocalories\n        [3,   35,  12,  4,   4],   # Protein (g)\n        [22,  5,   1,   1,   0],   # Fat (g)\n        [10,  0,   12,  1,   5]    # Fiber (g)\n    ])\n    \n    # Minimum daily requirements vector b\n    b = np.array([2000, 50, 44, 30])\n    \n    # Fixed costs for non-avocado foods\n    c_fixed = [2.5, 1.2, 0.6, 0.8]\n    \n    # Avocado prices to test\n    c_A_suite = [1.00, 0.50, 10.00, 12.00, 25.00]\n    \n    results = []\n    \n    for c_A in c_A_suite:\n        # Construct the full cost vector for the current scenario\n        c = np.array([c_A] + c_fixed)\n        \n        # scipy.optimize.linprog solves minimization problems with constraints\n        # of the form A_ub @ x = b_ub. We convert our A @ x >= b constraints\n        # by multiplying by -1, which yields -A @ x = -b.\n        res = linprog(c=c, \n                      A_ub=-A, \n                      b_ub=-b, \n                      bounds=(0, None), \n                      method='highs')\n        \n        if res.success:\n            x_A_star = res.x[0]  # Optimal avocado quantity\n            z_star = res.fun      # Optimal total cost\n            results.append([x_A_star, z_star])\n        else:\n            # The problem guarantees a solution, but this handles potential failures.\n            results.append([float('nan'), float('nan')])\n            \n    # Format the results into the specified string format with 4 decimal places.\n    formatted_pairs = [f\"[{x:.4f},{z:.4f}]\" for x, z in results]\n    print(f\"[{','.join(formatted_pairs)}]\")\n\nsolve_diet_sensitivity_analysis()\n```", "id": "2406884"}]}