{"hands_on_practices": [{"introduction": "让我们从一个经典的教科书式范例开始。这个练习将展示最速下降法的核心思想：当参数 $\\lambda$ 很大时，积分的值主要由相位函数 $\\phi(t)$ 取最小值处的邻域贡献。通过这个问题 [@problem_id:920264]，我们将练习如何找到这些关键点（鞍点），并计算它们对积分的贡献，从而掌握最速下降法的基本应用。", "problem": "考虑如下给出的积分\n$$I(\\lambda) = \\int_{-\\infty}^\\infty \\exp\\left[-\\lambda(t^2-a^2)^2\\right] dt$$\n其中 $\\lambda$ 是一个大的正参数，$a$ 是一个正常数。在 $\\lambda$ 很大的极限下计算此类积分是物理和工程各个领域的常见任务，通常可以使用最速下降法（也称为鞍点法）来解决。\n\n你的任务是找出当 $\\lambda \\to \\infty$ 时 $I(\\lambda)$ 的主阶渐近表达式。", "solution": "问题是要求积分 $I(\\lambda) = \\int_{-\\infty}^\\infty \\exp\\left[-\\lambda(t^2-a^2)^2\\right] dt$ 在 $\\lambda \\to \\infty$ 时的渐近行为。该积分是适用于最速下降法的标准形式 $\\int e^{-\\lambda \\phi(t)} dt$，其中相位函数为 $\\phi(t) = (t^2-a^2)^2$。\n\n最速下降法通过被积函数鞍点处的贡献来近似积分，这些鞍点对应于相位函数 $\\phi(t)$ 的极小值点。\n\n1.  **寻找鞍点：**\n    鞍点是 $\\phi(t)$ 的驻点，可通过将其一阶导数设为零来找到。\n    $$\\phi'(t) = \\frac{d}{dt}(t^2-a^2)^2 = 2(t^2-a^2)(2t) = 4t(t^2-a^2)$$\n    令 $\\phi'(t) = 0$ 得 $4t(t-a)(t+a) = 0$。鞍点位于 $t_1 = 0$，$t_2 = a$ 和 $t_3 = -a$。\n\n2.  **计算鞍点处的相位函数值：**\n    为了确定哪个鞍点提供主要贡献，我们计算每个点上的 $\\phi(t)$ 值。积分由 $\\phi(t)$ 取最小值处的点主导，因为在这些点上指数项 $e^{-\\lambda \\phi(t)}$ 最大。\n    $$\\phi(t_1) = \\phi(0) = (0^2 - a^2)^2 = a^4$$\n    $$\\phi(t_2) = \\phi(a) = (a^2 - a^2)^2 = 0$$\n    $$\\phi(t_3) = \\phi(-a) = ((-a)^2 - a^2)^2 = 0$$\n    由于 $a$ 是一个正常数，$a^4  0$。$\\phi(t)$ 的最小值为 $0$，出现在两个鞍点 $t = a$ 和 $t = -a$ 处。因此，积分的主阶渐近行为由这两个点邻域的贡献之和给出。来自 $t=0$ 的贡献将被因子 $e^{-\\lambda a^4}$ 抑制，因此对于大的 $\\lambda$ 可以忽略不计。\n\n3.  **分析主要鞍点附近的行为：**\n    鞍点 $t_k$ 对积分的贡献由其邻域内的高斯积分近似给出。来自一个简单鞍点 $t_k$ 的主阶贡献的标准公式是：\n    $$I_k(\\lambda) \\sim \\sqrt{\\frac{2\\pi}{\\lambda \\phi''(t_k)}} e^{-\\lambda \\phi(t_k)}$$\n    我们需要 $\\phi(t)$ 的二阶导数：\n    $$\\phi''(t) = \\frac{d}{dt}(4t^3 - 4a^2t) = 12t^2 - 4a^2$$\n    现在，我们在两个主要鞍点处计算 $\\phi''(t)$ 的值：\n    对于 $t=a$：\n    $$\\phi''(a) = 12a^2 - 4a^2 = 8a^2$$\n    对于 $t=-a$：\n    $$\\phi''(-a) = 12(-a)^2 - 4a^2 = 12a^2 - 4a^2 = 8a^2$$\n    由于 $\\phi''(a)$ 和 $\\phi''(-a)$ 均为正，这些点确实是实轴上的极小值点，并且积分路径（实轴）是穿过这些鞍点的最速下降路径。\n\n4.  **计算贡献并将它们相加：**\n    来自鞍点 $t=a$ 的贡献是：\n    $$I_a(\\lambda) \\sim \\sqrt{\\frac{2\\pi}{\\lambda \\phi''(a)}} e^{-\\lambda \\phi(a)} = \\sqrt{\\frac{2\\pi}{\\lambda (8a^2)}} e^{-\\lambda(0)} = \\sqrt{\\frac{\\pi}{4\\lambda a^2}} = \\frac{\\sqrt{\\pi}}{2a\\sqrt{\\lambda}}$$\n    来自鞍点 $t=-a$ 的贡献是：\n    $$I_{-a}(\\lambda) \\sim \\sqrt{\\frac{2\\pi}{\\lambda \\phi''(-a)}} e^{-\\lambda \\phi(-a)} = \\sqrt{\\frac{2\\pi}{\\lambda (8a^2)}} e^{-\\lambda(0)} = \\frac{\\sqrt{\\pi}}{2a\\sqrt{\\lambda}}$$\n    积分的总主阶渐近近似是这两个贡献的和：\n    $$I(\\lambda) \\sim I_a(\\lambda) + I_{-a}(\\lambda) = \\frac{\\sqrt{\\pi}}{2a\\sqrt{\\lambda}} + \\frac{\\sqrt{\\pi}}{2a\\sqrt{\\lambda}} = \\frac{2\\sqrt{\\pi}}{2a\\sqrt{\\lambda}} = \\frac{\\sqrt{\\pi}}{a\\sqrt{\\lambda}}$$", "answer": "$$\\boxed{\\frac{\\sqrt{\\pi}}{a\\sqrt{\\lambda}}}$$", "id": "920264"}, {"introduction": "在掌握了一维情况后，我们可以将最速下降法的思想推广到更高维度。这个练习 [@problem_id:920480] 挑战我们处理一个二维积分，我们需要找到一个二元函数的最小值点，并利用其 Hessian 矩阵来近似该点附近的函数形态。这是对一维方法的直接推广，也是该方法在统计力学等领域应用的关键一步。", "problem": "对于形如\n$$ I(\\lambda) = \\iint_D g(\\mathbf{x}) e^{-\\lambda f(\\mathbf{x})} d^n\\mathbf{x} $$\n的积分，当 $\\lambda \\to \\infty$ 时，其前导渐近行为可以使用最速下降法（或对于实积分使用拉普拉斯方法）来确定。该方法的原理是，对于大的 $\\lambda$，积分的值主要由函数 $f(\\mathbf{x})$ 的全局最小值点邻域的贡献所主导。\n\n考虑在整个平面 $\\mathbb{R}^2$ 上的特定二维积分：\n$$ I(\\lambda) = \\iint_{\\mathbb{R}^2} \\exp\\left[-\\lambda \\left( (x^2+y^2-a^2)^2 + b^2 x^2 \\right)\\right] dx dy $$\n其中 $a$ 和 $b$ 是正常数。\n\n确定当正数 $\\lambda$ 很大时，$I(\\lambda)$ 的渐近展开式中的首项。", "solution": "给定的积分形式为 $I(\\lambda) = \\iint_{\\mathbb{R}^2} g(x, y) e^{-\\lambda f(x, y)} dx dy$，其中函数为：\n$g(x, y) = 1$\n$f(x, y) = (x^2+y^2-a^2)^2 + b^2 x^2$\n\n根据拉普拉斯方法，当 $\\lambda \\to \\infty$ 时，积分的前导渐近行为由 $f(x, y)$ 的全局最小值点确定。首项的公式由每个全局最小值点 $\\mathbf{x}_i$ 的贡献之和给出：\n$$ I(\\lambda) \\sim \\sum_{i} \\left(\\frac{2\\pi}{\\lambda}\\right)^{n/2} \\frac{g(\\mathbf{x}_i)}{\\sqrt{\\det(H_f(\\mathbf{x}_i))}} e^{-\\lambda f(\\mathbf{x}_i)} $$\n其中 $n$ 是空间的维度（此处 $n=2$），$H_f(\\mathbf{x}_i)$ 是 $f$ 在最小值点 $\\mathbf{x}_i$ 处计算的海森矩阵。\n\n**步骤1：求 $f(x, y)$ 的临界点**\n我们需要找到 $f$ 的梯度为零的点 $(x, y)$。我们计算偏导数：\n$$ \\frac{\\partial f}{\\partial x} = 2(x^2+y^2-a^2)(2x) + 2b^2x = 2x [2(x^2+y^2-a^2) + b^2] $$\n$$ \\frac{\\partial f}{\\partial y} = 2(x^2+y^2-a^2)(2y) = 4y(x^2+y^2-a^2) $$\n令 $\\frac{\\partial f}{\\partial y} = 0$，我们有两种可能性：$y=0$ 或 $x^2+y^2-a^2=0$。\n\n情况1：$y=0$。\n第一个偏导数方程变为：\n$2x [2(x^2-a^2) + b^2] = 0$\n这意味着 $x=0$ 或 $2(x^2-a^2) + b^2 = 0$。第二个条件给出 $x^2 = a^2 - \\frac{b^2}{2}$。\n这给了我们临界点 $(0,0)$，并且如果 $a^2 \\ge b^2/2$，还有临界点 $(\\pm\\sqrt{a^2 - b^2/2}, 0)$。\n\n情况2：$x^2+y^2=a^2$。\n第二个偏导数方程得到满足。第一个方程变为：\n$2x [2(a^2-a^2) + b^2] = 2x b^2 = 0$\n由于 $b0$，这意味着 $x=0$。将 $x=0$ 代入 $x^2+y^2=a^2$ 得到 $y^2=a^2$，因此 $y=\\pm a$。\n这给了我们临界点 $(0, a)$ 和 $(0, -a)$。\n\n**步骤2：确定全局最小值点**\n现在我们在所有临界点上计算 $f(x, y)$ 的值以找到最小值。\n- 在 $(0,0)$ 处：$f(0,0) = (-a^2)^2 + 0 = a^4$。\n- 在 $(0, \\pm a)$ 处：$f(0, \\pm a) = (0^2+(\\pm a)^2-a^2)^2 + b^2(0)^2 = (a^2-a^2)^2 = 0$。\n- 如果存在，在 $(\\pm\\sqrt{a^2-b^2/2}, 0)$ 处：令 $x_c^2=a^2-b^2/2$。\n$f(\\pm x_c, 0) = (x_c^2+0-a^2)^2 + b^2x_c^2 = (a^2-b^2/2-a^2)^2 + b^2(a^2-b^2/2) = (-b^2/2)^2 + a^2b^2 - b^4/2 = b^4/4 + a^2b^2 - b^4/2 = a^2b^2 - b^4/4 = b^2(a^2-b^2/4)$。\n\n函数 $f(x, y)=(x^2+y^2-a^2)^2 + b^2 x^2$ 是平方和，所以其最小值必须是非负的。\n在 $(0, \\pm a)$ 处的值 $f=0$ 是可能的最低值。因此，$f(x, y)$ 的全局最小值点在 $\\mathbf{x}_1 = (0, a)$ 和 $\\mathbf{x}_2 = (0, -a)$。最小值为 $f_{min} = 0$。\n\n**步骤3：计算海森矩阵**\n海森矩阵 $H_f$ 的元素是 $f$ 的二阶偏导数。\n$f_{xx} = \\frac{\\partial^2 f}{\\partial x^2} = \\frac{\\partial}{\\partial x} (4x^3+4xy^2-4a^2x+2b^2x) = 12x^2+4y^2-4a^2+2b^2$。\n$f_{yy} = \\frac{\\partial^2 f}{\\partial y^2} = \\frac{\\partial}{\\partial y} (4yx^2+4y^3-4a^2y) = 4x^2+12y^2-4a^2$。\n$f_{xy} = f_{yx} = \\frac{\\partial^2 f}{\\partial y \\partial x} = \\frac{\\partial}{\\partial y} (4x^3+4xy^2-4a^2x+2b^2x) = 8xy$。\n因此，海森矩阵是：\n$$ H_f(x,y) = \\begin{pmatrix} 12x^2+4y^2-4a^2+2b^2  8xy \\\\ 8xy  4x^2+12y^2-4a^2 \\end{pmatrix} $$\n\n**步骤4：在最小值点计算海森矩阵**\n我们在两个最小值点 $\\mathbf{x}_1=(0, a)$ 和 $\\mathbf{x}_2=(0, -a)$ 处计算海森矩阵。\n对于 $\\mathbf{x}_1 = (0, a)$：\n$$ H_f(0,a) = \\begin{pmatrix} 4a^2-4a^2+2b^2  0 \\\\ 0  12a^2-4a^2 \\end{pmatrix} = \\begin{pmatrix} 2b^2  0 \\\\ 0  8a^2 \\end{pmatrix} $$\n行列式为 $\\det(H_f(0,a)) = (2b^2)(8a^2) = 16a^2b^2$。\n\n对于 $\\mathbf{x}_2 = (0, -a)$：\n$$ H_f(0,-a) = \\begin{pmatrix} 4(-a)^2-4a^2+2b^2  0 \\\\ 0  4(0)^2+12(-a)^2-4a^2 \\end{pmatrix} = \\begin{pmatrix} 2b^2  0 \\\\ 0  8a^2 \\end{pmatrix} $$\n行列式为 $\\det(H_f(0,-a)) = 16a^2b^2$。\n\n**步骤5：计算前导渐近项**\n我们现在应用拉普拉斯方法的公式。将两个最小值点的贡献相加。\n来自 $\\mathbf{x}_1=(0, a)$ 的贡献：\n$$ I_1(\\lambda) \\sim \\left(\\frac{2\\pi}{\\lambda}\\right)^{2/2} \\frac{g(0,a)}{\\sqrt{\\det(H_f(0,a))}} e^{-\\lambda f(0,a)} = \\frac{2\\pi}{\\lambda} \\frac{1}{\\sqrt{16a^2b^2}} e^{-\\lambda \\cdot 0} = \\frac{2\\pi}{\\lambda} \\frac{1}{4ab} = \\frac{\\pi}{2ab\\lambda} $$\n来自 $\\mathbf{x}_2=(0, -a)$ 的贡献：\n$$ I_2(\\lambda) \\sim \\left(\\frac{2\\pi}{\\lambda}\\right) \\frac{g(0,-a)}{\\sqrt{\\det(H_f(0,-a))}} e^{-\\lambda f(0,-a)} = \\frac{2\\pi}{\\lambda} \\frac{1}{\\sqrt{16a^2b^2}} e^{-\\lambda \\cdot 0} = \\frac{\\pi}{2ab\\lambda} $$\n总的前导渐近行为是这两个贡献之和：\n$$ I(\\lambda) \\sim I_1(\\lambda) + I_2(\\lambda) = \\frac{\\pi}{2ab\\lambda} + \\frac{\\pi}{2ab\\lambda} = \\frac{\\pi}{ab\\lambda} $$", "answer": "$$\\boxed{\\frac{\\pi}{ab\\lambda}}$$", "id": "920480"}, {"introduction": "最速下降法不仅是用于近似积分的解析工具，其核心思想也催生了数值优化领域中最重要的算法之一。这个实践 [@problem_id:3159947] 将连接起这两个概念，展示如何将解一个大型线性方程组（科学计算中的常见任务）重新表述为最小化一个二次函数。你将亲手实现数值最速下降算法，并将其与更先进的共轭梯度法进行比较，从而深入理解其在现代计算中的实际性能和角色。", "problem": "考虑单位正方形上的二维（$2$D）泊松问题，其带有齐次狄利克雷边界条件，连续形式写作 $-\\Delta u = f$ on $\\Omega = (0,1) \\times (0,1)$ 且 $u = 0$ on $\\partial \\Omega$。使用中心有限差分法，在大小为 $n \\times n$、网格间距为 $h = \\frac{1}{n+1}$ 的均匀内部网格上对拉普拉斯算子进行离散化，从而得到一个线性系统 $A x = b$，其中 $A$ 是对称正定（SPD）矩阵。将此线性系统解释为关于未知向量 $x$ 的一个严格凸二次泛函的平稳性条件。从二次泛函的梯度和欧几里得内积的定义出发，推导用于实现最速下降法和共轭梯度（CG）法（针对 SPD 系统）的算法更新规则，并解释 SPD 性质在确保收敛中的作用。使用基于残差的停止准则，当归一化残差满足 $\\frac{\\lVert r_k \\rVert_2}{\\lVert r_0 \\rVert_2} \\le \\varepsilon$ 时终止迭代，其中 $r_k = b - A x_k$ 且 $\\varepsilon$ 是一个预设的容差。\n\n通过与离散化算子 $-\\Delta$ 对应的五点有限差分格式隐式地构造 $A$，并通过在内部网格点上对源项 $f(x,y) = 1$（一个常数函数）进行采样来构造 $b$。使用零向量作为初始猜测值。对于下面的每个测试用例，运行这两种算法，直到满足停止准则或达到一个合理的迭代上限以保证终止。对于每个测试用例，分别记录最速下降法和共轭梯度法所需的迭代次数 $k_{\\mathrm{SD}}$ 和 $k_{\\mathrm{CG}}$。最终输出必须将所有测试用例的结果聚合到一个用方括号括起来的、逗号分隔的列表中，顺序为 $[k_{\\mathrm{SD}}^{(1)},k_{\\mathrm{CG}}^{(1)},k_{\\mathrm{SD}}^{(2)},k_{\\mathrm{CG}}^{(2)},\\dots]$。所有迭代次数必须是整数。\n\n您的推导和实现应基于以下基本定义：\n- 欧几里得内积 $\\langle u, v \\rangle = u^{\\mathsf{T}} v$ 和欧几里得范数 $\\lVert v \\rVert_2 = \\sqrt{\\langle v, v \\rangle}$。\n- 对于一个 SPD 矩阵 $A$，二次泛函 $F(x) = \\frac{1}{2} x^{\\mathsf{T}} A x - b^{\\mathsf{T}} x$ 有一个满足 $A x = b$ 的唯一最小化子，其梯度为 $\\nabla F(x) = A x - b$。\n- 在内部网格上对 $-\\Delta$ 的五点格式实现，对于齐次狄利克雷边界条件，会产生一个 SPD 矩阵 $A$。\n\n测试套件：\n- 用例 1：$n = 8$，$\\varepsilon = 10^{-8}$。\n- 用例 2：$n = 16$，$\\varepsilon = 10^{-8}$。\n- 用例 3：$n = 16$，$\\varepsilon = 10^{-10}$。\n- 用例 4：$n = 4$，$\\varepsilon = 10^{-8}$。\n\n不涉及单位，也不涉及角度单位。最终输出格式必须是单行：一个列表，其中按所列顺序包含每个测试用例的结果，先是最速下降法的迭代次数，然后是共轭梯度法的迭代次数；例如，$[k_{\\mathrm{SD}}^{(1)},k_{\\mathrm{CG}}^{(1)},k_{\\mathrm{SD}}^{(2)},k_{\\mathrm{CG}}^{(2)},k_{\\mathrm{SD}}^{(3)},k_{\\mathrm{CG}}^{(3)},k_{\\mathrm{SD}}^{(4)},k_{\\mathrm{CG}}^{(4)}]$。", "solution": "用户提供的问题是有效的。这是一个计算科学领域（特别是数值线性代数）中的适定问题，基于已确立的科学和数学原理。问题陈述是自洽的、一致的，并提供了推导和实现所需算法的所有必要信息。\n\n任务是使用最速下降（SD）和共轭梯度（CG）方法求解线性系统 $Ax=b$，该系统源于泊松方程的有限差分离散。核心思想是将这个线性代数问题重构为一个优化问题：寻找一个严格凸二次泛函 $F(x)$ 的最小值。$Ax=b$ 的解 $x$ 是 $F(x)$ 的唯一最小化子，在该点梯度 $\\nabla F(x)$ 为零。\n\n给定的二次泛函是：\n$$\nF(x) = \\frac{1}{2} x^{\\mathsf{T}} A x - b^{\\mathsf{T}} x\n$$\n其梯度是：\n$$\n\\nabla F(x) = A x - b\n$$\n问题指出，由离散化产生的矩阵 $A$ 是对称正定（SPD）的。对于一个 SPD 矩阵 $A$，泛函 $F(x)$ 是严格凸的，这保证了唯一的全局最小值的存在。该最小值的条件是 $\\nabla F(x) = 0$，这等价于求解线性系统 $Ax = b$。\n\n最小化 $F(x)$ 的迭代方法遵循以下通用更新规则：\n$$\nx_{k+1} = x_k + \\alpha_k p_k\n$$\n其中 $x_k$ 是当前的近似解，$p_k$ 是一个搜索方向，$\\alpha_k  0$ 是步长。对于给定的方向 $p_k$，最优步长 $\\alpha_k$ 是通过最小化关于 $\\alpha$ 的 $F(x_k + \\alpha p_k)$ 来找到的。令 $g(\\alpha) = F(x_k + \\alpha p_k)$。通过将导数设为零来找到最小值：\n$$\n\\frac{d g}{d \\alpha} = \\frac{d}{d \\alpha} F(x_k + \\alpha p_k) = \\nabla F(x_k + \\alpha p_k)^{\\mathsf{T}} p_k = 0\n$$\n使用梯度的表达式，我们有：\n$$\n(A(x_k + \\alpha p_k) - b)^{\\mathsf{T}} p_k = 0\n$$\n$$\n(A x_k - b + \\alpha A p_k)^{\\mathsf{T}} p_k = 0\n$$\n将第 $k$ 步的残差定义为 $r_k = b - A x_k = -\\nabla F(x_k)$，上式变为：\n$$\n(-r_k + \\alpha A p_k)^{\\mathsf{T}} p_k = 0\n$$\n$$\n-r_k^{\\mathsf{T}} p_k + \\alpha p_k^{\\mathsf{T}} A p_k = 0\n$$\n求解 $\\alpha$，我们得到最优步长：\n$$\n\\alpha_k = \\frac{r_k^{\\mathsf{T}} p_k}{p_k^{\\mathsf{T}} A p_k}\n$$\n\n最速下降法和共轭梯度法在搜索方向 $p_k$ 的选择上有所不同。\n\n### 最速下降法（SD）\n\n最速下降法选择与负梯度对齐的搜索方向，这是泛函 $F(x)$ 的最陡局部下降方向。\n$$\np_k = -\\nabla F(x_k) = b - A x_k = r_k\n$$\n将 $p_k = r_k$ 代入 $\\alpha_k$ 的公式中：\n$$\n\\alpha_k = \\frac{r_k^{\\mathsf{T}} r_k}{r_k^{\\mathsf{T}} A r_k} = \\frac{\\langle r_k, r_k \\rangle}{\\langle r_k, A r_k \\rangle} = \\frac{\\lVert r_k \\rVert_2^2}{r_k^{\\mathsf{T}} A r_k}\n$$\n最速下降法的完整算法如下：\n1.  初始化 $x_0$（例如，$x_0 = 0$），设置 $k=0$。\n2.  计算初始残差 $r_0 = b - A x_0$。\n3.  对于 $k = 0, 1, 2, \\dots$ 循环，直到收敛：\n    a. 计算步长：$\\alpha_k = \\frac{r_k^{\\mathsf{T}} r_k}{r_k^{\\mathsf{T}} A r_k}$。\n    b. 更新解：$x_{k+1} = x_k + \\alpha_k r_k$。\n    c. 高效地更新残差：$r_{k+1} = b - A x_{k+1} = b - A(x_k + \\alpha_k r_k) = (b - A x_k) - \\alpha_k A r_k = r_k - \\alpha_k A r_k$。\n\n### 共轭梯度法（CG）\n\nCG 方法通过选择 A-正交（或共轭）的搜索方向 $p_k$ 来改进最速下降法，即对于 $i \\neq j$ 有 $\\langle p_i, p_j \\rangle_A = p_i^{\\mathsf{T}} A p_j = 0$。这可以防止算法撤销在先前方向上取得的进展，从而导致更快的收敛速度。\n\n搜索方向是迭代构造的。从最速下降方向 $p_0 = r_0$ 开始，后续方向 $p_{k+1}$ 是通过取新的残差 $r_{k+1}$ 并使其与先前的搜索方向 $p_k$ A-正交来生成的：\n$$\np_{k+1} = r_{k+1} + \\beta_k p_k\n$$\n为了强制 A-正交性（$p_{k+1}^{\\mathsf{T}} A p_k = 0$），我们进行投影：\n$$\n(r_{k+1} + \\beta_k p_k)^{\\mathsf{T}} A p_k = 0 \\implies r_{k+1}^{\\mathsf{T}} A p_k + \\beta_k p_k^{\\mathsf{T}} A p_k = 0\n$$\n这给出了 $\\beta_k$ 的公式：\n$$\n\\beta_k = -\\frac{r_{k+1}^{\\mathsf{T}} A p_k}{p_k^{\\mathsf{T}} A p_k}\n$$\n虽然这个公式是正确的，但其计算效率低下。利用 CG 方法的正交性质（特别是对于 $i \\ne j$ 有 $\\langle r_i, r_j \\rangle = 0$），可以证明它等价于更简单的 Hestenes-Stiefel 公式：\n$$\n\\beta_k = \\frac{r_{k+1}^{\\mathsf{T}} r_{k+1}}{r_k^{\\mathsf{T}} r_k} = \\frac{\\lVert r_{k+1} \\rVert_2^2}{\\lVert r_k \\rVert_2^2}\n$$\n步长 $\\alpha_k$ 使用带有 CG 搜索方向 $p_k$ 的通用公式。通过使用性质 $\\langle r_k, p_k \\rangle = \\langle r_k, r_k \\rangle$ 也可以对其进行简化：\n$$\n\\alpha_k = \\frac{r_k^{\\mathsf{T}} r_k}{p_k^{\\mathsf{T}} A p_k}\n$$\n共轭梯度法的完整算法如下：\n1.  初始化 $x_0$（例如，$x_0 = 0$），设置 $k=0$。\n2.  计算 $r_0 = b - A x_0$。\n3.  设置第一个搜索方向 $p_0 = r_0$。\n4.  对于 $k = 0, 1, 2, \\dots$ 循环，直到收敛：\n    a. 计算步长：$\\alpha_k = \\frac{r_k^{\\mathsf{T}} r_k}{p_k^{\\mathsf{T}} A p_k}$。\n    b. 更新解：$x_{k+1} = x_k + \\alpha_k p_k$。\n    c. 更新残差：$r_{k+1} = r_k - \\alpha_k A p_k$。\n    d. 计算 $\\beta_k$：$\\beta_k = \\frac{r_{k+1}^{\\mathsf{T}} r_{k+1}}{r_k^{\\mathsf{T}} r_k}$。\n    e. 更新搜索方向：$p_{k+1} = r_{k+1} + \\beta_k p_k$。\n\n### SPD 性质的作用\n\n矩阵 $A$ 的对称正定（SPD）性质对这两种方法都至关重要。\n- **唯一解的存在性：** 对于一个 SPD 矩阵 $A$，二次泛函 $F(x)$ 是严格凸的。这保证了存在一个唯一的最小化子，它对应于 $Ax = b$ 的解。\n- **最速下降法的收敛性：** 因为 $A$ 是正定的，对于任何非零残差 $r_k$，步长公式中的分母 $r_k^{\\mathsf{T}} A r_k = \\langle r_k, r_k \\rangle_A$ 总是正的。这确保了 $\\alpha_k  0$，从而保证每一步都是 $F(x)$ 的一个下降方向，这是收敛的必要条件。\n- **共轭梯度法的基础：** SPD 性质是 CG 方法的理论基石。它确保了 $\\langle u, v \\rangle_A = u^{\\mathsf{T}} A v$ 定义了一个有效的内积。A-正交性的整个概念（这是 CG 效率的核心）都依赖于此。$\\alpha_k$ 公式中的分母（$p_k^{\\mathsf{T}} A p_k$）保证为正，从而防止了除以零。在精确算术中，SPD 性质支撑了 CG 方法在至多 $N$ 次迭代内找到一个 $N \\times N$ 系统的精确解的理论保证。没有它，该方法的收敛性质就会丧失。", "answer": "[1391,26,5389,52,6537,63,382,14]", "id": "3159947"}]}