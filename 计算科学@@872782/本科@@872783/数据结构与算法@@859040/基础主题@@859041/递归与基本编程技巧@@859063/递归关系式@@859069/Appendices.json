{"hands_on_practices": [{"introduction": "应用递推关系的第一步是学会在具体问题中发现其结构。本练习 ([@problem_id:1395092]) 将指导你通过一个简单的组合计数场景，学习如何将一个问题分解为规模更小且性质相同的子问题。这个过程是递推思维的核心，也是将问题描述转化为数学模型的关键一步。", "problem": "一个系统管理员负责在 $n$ 个连续的时间段（标记为 $1, 2, \\dots, n$）内安排一系列维护作业。由于作业的性质和共享资源的限制，系统被配置为防止在两个连续的时间段内安排作业。一个“有效安排”被定义为任何遵守此规则的、为维护而选择的时间段集合。这也包括了完全不执行任何作业的可能性（即选择空的时间段集合）。\n\n设 $S_n$ 为 $n$ 个时间段内可能的不同有效安排的数量。对于 $n \\ge 2$，序列 $S_n$ 可以用一个二阶常整数系数的线性齐次递推关系来描述，其形式为 $S_n = c_1 S_{n-1} + c_2 S_{n-2}$。\n\n确定整数系数的有序对 $(c_1, c_2)$。", "solution": "设 $S_{n}$ 表示有效安排的数量（即集合 $\\{1,2,\\dots,n\\}$ 中没有两个连续元素的子集）。对于 $n \\geq 2$，考虑一个有效安排，并根据最后一个时间段 $n$ 是否被选中来进行划分。\n\n如果 $n$ 未被选中，则所有的选择都发生在 $\\{1,2,\\dots,n-1\\}$ 中，且遵循相同的约束条件，这给出了 $S_{n-1}$ 种可能性。\n\n如果 $n$ 被选中，那么根据约束条件，$n-1$ 不能被选中，因此剩余的选择发生在 $\\{1,2,\\dots,n-2\\}$ 中，且遵循相同的约束条件，这给出了 $S_{n-2}$ 种可能性。\n\n这两种情况是互斥且穷尽的，因此根据加法原理，\n$$\nS_{n} = S_{n-1} + S_{n-2}.\n$$\n这是一个二阶常整数系数的线性齐次递推关系。与 $S_{n} = c_{1} S_{n-1} + c_{2} S_{n-2}$ 匹配，可得\n$$\nc_{1} = 1,\\quad c_{2} = 1.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}1  1\\end{pmatrix}}$$", "id": "1395092"}, {"introduction": "在建立递推关系之后，下一步便是求解其“封闭形式”的解，从而直接计算任意项。本练习 ([@problem_id:3264331]) 介绍了一种最直观的求解技巧——展开法（或称迭代法）。通过反复代入，你将学会如何将递推过程转化为一个求和级数，并最终利用数学恒等式得到简洁的答案。", "problem": "一位工程师分析一个递归过程，该过程通过逐个插入 $n$ 个不同的键来构建一个平衡搜索结构。在一个理想化的成本模型中，由于路径遍历和局部重新平衡，插入第 $k$ 个键恰好执行 $\\log_{2} k$ 个基本步骤，其中 $k \\in \\{2,3,\\ldots,n\\}$。设 $T(n)$ 表示处理 $n$ 个键所需的总基本步骤数，基准情形为 $T(1) = 0$。通过将总成本建模为递归子问题的成本与在当前规模下所做工作的成本之和，该工程师得出了以下递推关系\n$$\nT(n) = T(n-1) + \\log_{2} n \\quad \\text{for } n \\geq 2, \\quad T(1)=0.\n$$\n请从算法分析的第一性原理（顺序组合意味着成本相加）、对数的成熟性质（例如从乘法到加法的同态性）以及阶乘函数的定义出发，为 $T(n)$ 推导出一个闭式表达式。该表达式应为关于 $n$ 的显式函数，且不包含求和符号与渐近记号。请使用以 2 为底的对数。最终答案必须是关于 $n$ 的单个解析表达式。", "solution": "问题要求为由以下递推关系定义的总成本 $T(n)$ 寻找一个闭式表达式：\n$$\nT(n) = T(n-1) + \\log_{2} n \\quad \\text{for } n \\geq 2\n$$\n基准情形为 $T(1) = 0$。\n\n推导过程通过展开递推关系来进行。该方法也称为伸缩求和法或迭代法，其过程为将函数的定义式反复代入更小的参数中，直至达到基准情形。\n\n对于整数 $n \\geq 2$，我们可以写出：\n$$\nT(n) = T(n-1) + \\log_{2} n\n$$\n将 $T(n-1) = T(n-2) + \\log_{2}(n-1)$ 的表达式代入，可得：\n$$\nT(n) = \\left( T(n-2) + \\log_{2}(n-1) \\right) + \\log_{2} n = T(n-2) + \\log_{2}(n-1) + \\log_{2} n\n$$\n对 $T(n-2)$、$T(n-3)$ 以此类推，持续此代入过程，直至 $T(2)$：\n$$\nT(n) = T(n-3) + \\log_{2}(n-2) + \\log_{2}(n-1) + \\log_{2} n\n$$\n$$\n\\vdots\n$$\n$$\nT(n) = T(1) + \\log_{2}(2) + \\log_{2}(3) + \\ldots + \\log_{2}(n-1) + \\log_{2} n\n$$\n这可以用求和符号紧凑地表示为：\n$$\nT(n) = T(1) + \\sum_{k=2}^{n} \\log_{2} k\n$$\n问题指定了基准情形 $T(1) = 0$。将该值代入方程中可得：\n$$\nT(n) = 0 + \\sum_{k=2}^{n} \\log_{2} k = \\sum_{k=2}^{n} \\log_{2} k\n$$\n问题要求一个不含求和符号的表达式，这需要利用对数的性质。对数的基本性质指出，对数之和等于其各项参数乘积的对数。对于公共底数 $b > 0$，$b \\neq 1$：\n$$\n\\sum_{i} \\log_{b}(x_i) = \\log_{b} \\left( \\prod_{i} x_i \\right)\n$$\n将此性质应用于我们以 $b=2$ 为底的 $T(n)$ 表达式：\n$$\nT(n) = \\log_{2}(2) + \\log_{2}(3) + \\ldots + \\log_{2}(n) = \\log_{2} \\left( 2 \\times 3 \\times \\ldots \\times n \\right)\n$$\n对数参数中的乘积是 $2 \\times 3 \\times \\ldots \\times n$。该乘积与阶乘函数密切相关，阶乘函数对非负整数 $n$ 的定义为：\n$$\nn! = \\prod_{k=1}^{n} k = 1 \\times 2 \\times 3 \\times \\ldots \\times n\n$$\n由于乘以 $1$ 不改变乘积的值，我们有：\n$$\n2 \\times 3 \\times \\ldots \\times n = 1 \\times 2 \\times 3 \\times \\ldots \\times n = n!\n$$\n因此，我们可以用 $n!$ 代替对数内的乘积：\n$$\nT(n) = \\log_{2}(n!)\n$$\n此表达式即为所求的闭式解。它是一个关于 $n$ 的显式函数，不含求和符号或渐近记号，并使用了指定的以 2 为底的对数。当寻求对大 $n$ 的近似时，此结果也称为 Stirling 公式的对数，但此处要求的答案是其确切形式 $\\log_{2}(n!)$。", "answer": "$$\\boxed{\\log_{2}(n!)}$$", "id": "3264331"}, {"introduction": "对于一些结构更复杂的递推关系，例如非线性递推，我们需要更强大的分析工具。本练习 ([@problem_id:3264242]) 探讨了一个经典的几何组合问题——凸多边形三角剖分，它会导出一个与卡塔兰数 (Catalan numbers) 相关的著名非线性递推关系。你将通过这个问题，领略如何运用生成函数这一高等技巧，将序列问题转化为函数代数问题来求解。", "problem": "在平面计算几何中，多边形分解算法中的一个标准子程序是计算通过插入不相交的对角线来三角剖分一个凸多边形的不同方式的数量。设 $P(n)$ 表示一个凸 $n$ 边形的的不同三角剖分数，其中 $n \\ge 3$。请仅使用凸多边形、三角剖分（通过插入不交叉的对角线将多边形划分为不重叠的三角形）的定义以及组合计数的乘法法则，导出一个递推关系，该关系用 $P(k)$ 在严格较小参数上的值来表示 $P(n)$，并给出合理的基本情况。通过一个分解论证来证明你的递推关系是正确的，该论证在一个三角剖分集合与由一个与指定边关联的三角形所导出的两个较小多边形的三角剖分对集合之间建立一个双射。然后，从你的递推关系和基本情况出发，使用基于标准代数工具（如普通生成函数 OGFs）的逻辑上健全的方法，求解 $P(n)$ 的闭式解析表达式。你的最终答案必须是一个关于 $n$ 的单一简化表达式。不要将中间恒等式作为最终答案。不需要进行数值四舍五入。最终结果表示为无单位的表达式。", "solution": "该问题要求推导 $P(n)$（对于 $n \\ge 3$ 的凸 $n$ 边形的不同三角剖分数）的递推关系，证明其正确性，并随后使用普通生成函数推导 $P(n)$ 的闭式解。\n\n首先，我们推导 $P(n)$ 的递推关系。设凸 $n$ 边形的顶点按逆时针顺序标记为 $v_1, v_2, \\dots, v_n$。考虑边 $(v_1, v_n)$。在多边形的任何三角剖分中，这条边必须是且仅是一个三角形的一条边。这个三角形的第三个顶点必须是某个顶点 $v_k$，其中 $k$ 是一个满足 $2 \\le k \\le n-1$ 的整数。\n\n选择顶点 $v_k$ 以形成三角形 $(v_1, v_k, v_n)$ 的操作，将所有可能的三角剖分集合划分为 $n-2$ 个不相交的子集，每个子集对应一个可能的 $k$ 值。一旦这个三角形被选定，多边形的任何剩余区域也必须被三角剖分。对角线 $(v_1, v_k)$ 和 $(v_k, v_n)$ 分割了原始的 $n$ 边形。\n\n让我们分析由三角形 $(v_1, v_k, v_n)$ 创建的子问题。\n\\begin{itemize}\n    \\item 如果 $k=2$，三角形是 $(v_1, v_2, v_n)$。这留下一个由顶点 $(v_2, v_3, \\dots, v_n)$ 组成的凸多边形，这是一个 $(n-1)$-边形。对这个子多边形进行三角剖分的方法数是 $P(n-1)$。\n    \\item 如果 $k=n-1$，三角形是 $(v_1, v_{n-1}, v_n)$。这留下一个由顶点 $(v_1, v_2, \\dots, v_{n-1})$ 组成的凸多边形，这也是一个 $(n-1)$-边形。对这个子多边形进行三角剖分的方法数是 $P(n-1)$。\n    \\item 如果 $2  k  n-1$，三角形 $(v_1, v_k, v_n)$ 将原始多边形分割成两个较小的、不重叠的、必须被三角剖分的凸多边形：\n    \\begin{enumerate}\n        \\item 一个由顶点 $(v_1, v_2, \\dots, v_k)$ 定义的多边形。这是一个 $k$-边形，可以通过 $P(k)$ 种方式进行三角剖分。\n        \\item 一个由顶点 $(v_k, v_{k+1}, \\dots, v_n)$ 定义的多边形。这是一个 $(n-k+1)$-边形，可以通过 $P(n-k+1)$ 种方式进行三角剖分。\n    \\end{enumerate}\n    根据计数的乘法法则，对于这个范围内的固定 $k$，有 $P(k) \\times P(n-k+1)$ 种方式来完成三角剖分。\n\\end{itemize}\n\n为了统一这些情况，我们可以引入一个辅助定义。设 $P(2)=1$。这可以解释为一个退化的二边形（一条线段）只有一种“三角剖分”（即保持原样）。\n有了这个定义，对于 $k=2$，方法数是 $P(2) \\times P(n-1) = 1 \\times P(n-1) = P(n-1)$，这是一致的。\n对于 $k=n-1$，方法数是 $P(n-1) \\times P(2) = P(n-1) \\times 1 = P(n-1)$，也是一致的。\n\n由于对不同 $k$ 的选择所产生的三角剖分集合是不相交的，我们可以对所有可能的 $k$ 值求和，以获得总的三角剖分数 $P(n)$：\n$$P(n) = \\sum_{k=2}^{n-1} P(k) P(n-k+1)$$\n这个递推关系对 $n \\ge 3$ 成立。\n\n基本情况是三角形（$n=3$）。一个三角形本身已经是一个三角剖分，所以只有一种方式。因此，$P(3)=1$。\n让我们用我们的递推关系和辅助定义 $P(2)=1$ 来检验一下：\n$P(3) = \\sum_{k=2}^{2} P(k) P(3-k+1) = P(2) P(2) = 1 \\times 1 = 1$。递推关系与基本情况一致。\n\n上述推导过程也作为其正确性的证明。它在一个 $n$ 边形的三角剖分集合与较小多边形的三角剖分集合的笛卡尔积的不交并之间建立了一个双射。具体来说，如果 $T_m$ 是一个 $m$ 边形的三角剖分集合，该论证建立了双射 $T_n \\leftrightarrow \\bigcup_{k=2}^{n-1} (T_k \\times T_{n-k+1})$。取两边的基数得到 $|T_n| = \\sum_{k=2}^{n-1} |T_k| \\times |T_{n-k+1}|$，这正是递推关系 $P(n) = \\sum_{k=2}^{n-1} P(k) P(n-k+1)$。\n\n接下来，我们使用普通生成函数（OGF）来解这个递推关系。该递推关系不是标准的卷积形式。我们进行一次变元代换。令 $C_m = P(m+2)$ 对 $m \\ge 0$ 成立。这意味着 $P(n) = C_{n-2}$ 对 $n \\ge 2$ 成立。\n$C_0 = P(2) = 1$。\n$C_1 = P(3) = 1$。\n$C_2 = P(4) = P(2)P(3) + P(3)P(2) = 1 \\cdot 1 + 1 \\cdot 1 = 2$。\n序列 $C_m$ 对应于卡特兰数。让我们用 $C_m$ 来重写 $P(n)$ 的递推关系。\n令 $n = m+2$。\n$P(m+2) = \\sum_{k=2}^{m+1} P(k) P(m+2 - k + 1) = \\sum_{k=2}^{m+1} P(k) P(m+3-k)$。\n$C_m = \\sum_{k=2}^{m+1} C_{k-2} C_{m+3-k-2} = \\sum_{k=2}^{m+1} C_{k-2} C_{m+1-k}$。\n令 $j=k-2$。当 $k=2$ 时，$j=0$。当 $k=m+1$ 时，$j=m-1$。\n$$C_m = \\sum_{j=0}^{m-1} C_j C_{m-1-j}$$\n这是著名的卡特兰数递推关系，对 $m \\ge 1$ 成立，基本情况为 $C_0=1$。\n\n令卡特兰序列的 OGF 为 $C(x) = \\sum_{m=0}^{\\infty} C_m x^m$。\n考虑 OGF 的平方：\n$C(x)^2 = \\left(\\sum_{i=0}^{\\infty} C_i x^i\\right) \\left(\\sum_{j=0}^{\\infty} C_j x^j\\right) = \\sum_{m=0}^{\\infty} \\left(\\sum_{j=0}^{m} C_j C_{m-j}\\right) x^m$。\n$C(x)^2$ 中 $x^{m-1}$ 的系数是 $\\sum_{j=0}^{m-1} C_j C_{m-1-j}$，对于 $m \\ge 1$，这恰好是 $C_m$。\n因此，$C(x)^2 = \\sum_{m=1}^{\\infty} C_m x^{m-1}$。\n我们可以将这个和式与 $C(x)$ 联系起来：\n$C(x) = C_0 + \\sum_{m=1}^{\\infty} C_m x^m = 1 + x \\sum_{m=1}^{\\infty} C_m x^{m-1}$。\n所以，$\\sum_{m=1}^{\\infty} C_m x^{m-1} = \\frac{C(x)-1}{x}$。\n将此代入我们的方程中得到：\n$C(x)^2 = \\frac{C(x)-1}{x}$。\n这导出了关于 $C(x)$ 的二次方程：\n$$x C(x)^2 - C(x) + 1 = 0$$\n使用二次公式，我们求得 $C(x)$ 的解：\n$$C(x) = \\frac{1 \\pm \\sqrt{1 - 4x}}{2x}$$\n为了确定正确的符号，我们分析当 $x \\to 0$ 时的行为。我们必须有 $\\lim_{x\\to 0} C(x) = C_0 = 1$。\n对于“+”号，$\\lim_{x\\to 0} \\frac{1 + \\sqrt{1 - 4x}}{2x} \\to \\frac{2}{0}$，这是发散的。\n对于“-”号，我们得到一个不定形 $\\frac{0}{0}$。应用洛必达法则 (L'Hôpital's rule)：\n$\\lim_{x\\to 0} \\frac{1 - \\sqrt{1 - 4x}}{2x} = \\lim_{x\\to 0} \\frac{-\\frac{1}{2}(1-4x)^{-1/2}(-4)}{2} = \\lim_{x\\to 0} \\frac{2}{\\sqrt{1-4x}} = 2/1 = 1$。\n这与初始条件 $C_0=1$ 相匹配。因此，正确的生成函数是：\n$$C(x) = \\frac{1 - \\sqrt{1 - 4x}}{2x}$$\n为了找到 $C_m$ 的闭式解，我们从 $C(x)$ 中提取 $x^m$ 的系数。我们使用广义二项式定理 $(1+y)^\\alpha = \\sum_{k=0}^{\\infty} \\binom{\\alpha}{k} y^k$。\n$\\sqrt{1-4x} = (1-4x)^{1/2} = \\sum_{k=0}^{\\infty} \\binom{1/2}{k} (-4x)^k = 1 + \\sum_{k=1}^{\\infty} \\binom{1/2}{k} (-4)^k x^k$。\n对于 $k \\ge 1$，二项式系数 $\\binom{1/2}{k}$ 为：\n$$\\binom{1/2}{k} = \\frac{\\frac{1}{2}(\\frac{1}{2}-1)\\dots(\\frac{1}{2}-k+1)}{k!} = \\frac{(-1)^{k-1}}{2^k k!} (1 \\cdot 3 \\cdot \\ldots \\cdot (2k-3)) = \\frac{(-1)^{k-1}}{2^k k!} \\frac{(2k-2)!}{2^{k-1}(k-1)!} = \\frac{(-1)^{k-1}}{4^k} \\frac{2}{k} \\binom{2k-2}{k-1}$$\n一个更标准的形式是 $\\binom{1/2}{k} = \\frac{(-1)^{k-1}}{4^k(2k-1)}\\binom{2k}{k}$。\n将此代入 $\\sqrt{1-4x}$ 的展开式中：\n$\\sqrt{1-4x} = 1 + \\sum_{k=1}^{\\infty} \\frac{(-1)^{k-1}}{4^k(2k-1)}\\binom{2k}{k} (-4)^k x^k = 1 - \\sum_{k=1}^{\\infty} \\frac{1}{2k-1} \\binom{2k}{k} x^k$。\n现在，将此代入 $C(x)$ 的表达式中：\n$C(x) = \\frac{1 - \\left(1 - \\sum_{k=1}^{\\infty} \\frac{1}{2k-1} \\binom{2k}{k} x^k\\right)}{2x} = \\frac{1}{2x} \\sum_{k=1}^{\\infty} \\frac{1}{2k-1} \\binom{2k}{k} x^k = \\sum_{k=1}^{\\infty} \\frac{1}{2(2k-1)} \\binom{2k}{k} x^{k-1}$。\n为了找到 $C_m = [x^m] C(x)$，我们令指数 $m = k-1$，这意味着 $k = m+1$。\n$C_m = \\frac{1}{2(2(m+1)-1)} \\binom{2(m+1)}{m+1} = \\frac{1}{2(2m+1)} \\frac{(2m+2)!}{(m+1)!(m+1)!}$。\n使用恒等式 $\\frac{(2m+2)!}{(m+1)!(m+1)!} = \\frac{2(2m+1)}{m+1}\\binom{2m}{m}$，我们可以简化：\n$C_m = \\frac{1}{2(2m+1)} \\left( \\frac{2(2m+1)}{m+1} \\binom{2m}{m} \\right) = \\frac{1}{m+1} \\binom{2m}{m}$。\n\n最后，我们回到求 $P(n)$ 的原始问题。使用关系 $P(n) = C_{n-2}$，我们将 $m=n-2$ 代入 $C_m$ 的公式中。这个代换对于 $n-2 \\ge 0$ 即 $n \\ge 2$ 是有效的，这覆盖了我们感兴趣的定义域 $n \\ge 3$。\n$$P(n) = C_{n-2} = \\frac{1}{(n-2)+1} \\binom{2(n-2)}{n-2} = \\frac{1}{n-1} \\binom{2n-4}{n-2}$$\n这就是凸 $n$ 边形的不同三角剖分数的闭式解析表达式。\n该表达式也可以用阶乘写成 $P(n) = \\frac{(2n-4)!}{(n-1)!(n-2)!}$。", "answer": "$$\\boxed{\\frac{1}{n-1}\\binom{2n-4}{n-2}}$$", "id": "3264242"}]}