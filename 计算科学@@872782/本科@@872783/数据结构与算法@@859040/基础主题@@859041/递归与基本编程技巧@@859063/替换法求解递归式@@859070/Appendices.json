{"hands_on_practices": [{"introduction": "这个练习旨在解决一个在算法分析中经常遇到的递推关系，例如在分析随机数据流中寻找最小值的“雇佣问题”时就会出现。通过展开这个看似简单的递推式 [@problem_id:3277485]，你将练习代换法的基本技巧，并发现其解与一个重要的数学级数——调和级数——之间的深刻联系。这个过程不仅能巩固你的代换法技能，还能让你体会到算法分析与经典数学之间的交融。", "problem": "考虑一个算法，该算法处理一个由 $n$ 个不同元素组成的流，这些元素逐个到达，并维护一个动态最小值。每当当前元素严格小于所有先前看到的元素时，该算法会执行一次额外的常数时间更新。令 $T(n)$ 表示在观察 $n$ 个元素后这些额外更新的期望次数，并假设对于所有整数 $n \\geq 2$，以下递推关系成立：\n$$\nT(n) = T(n-1) + \\frac{1}{n},\n$$\n其初始条件为 $T(1) = 0$。使用代入法（也称为展开法），推导 $T(n)$ 的一个闭式表达式，用第 $n$ 个调和数 $H_n$ 表示，其中 $H_n$ 定义为\n$$\nH_n = \\sum_{k=1}^{n} \\frac{1}{k}.\n$$\n你的最终答案必须是用 $n$ 和 $H_n$ 表示的单个解析表达式。", "solution": "该问题在数学上是合理的，并且提供了求解所需的所有信息。如果 $n$ 个元素以随机排列的方式到达，那么第 $n$ 个元素是到目前为止所见过的所有元素中最小值的概率恰好是 $\\frac{1}{n}$。根据期望的线性性，在第 $n$ 步更新的期望次数是 $\\frac{1}{n}$，这导致了给定的递推关系。下面我们将推导其解。\n\n问题要求解递推关系\n$$\nT(n) = T(n-1) + \\frac{1}{n}\n$$\n其中 $n \\geq 2$，初始条件为 $T(1) = 0$。所用方法为代入法，也称为展开法或迭代法。\n\n我们从给定的递推关系开始：\n$$\nT(n) = T(n-1) + \\frac{1}{n}\n$$\n我们通过重复代入较小索引项的表达式来展开递推关系。\n对于 $T(n-1)$ 项，递推关系意味着 $T(n-1) = T(n-2) + \\frac{1}{n-1}$。将其代入 $T(n)$ 的方程中：\n$$\nT(n) = \\left( T(n-2) + \\frac{1}{n-1} \\right) + \\frac{1}{n} = T(n-2) + \\frac{1}{n-1} + \\frac{1}{n}\n$$\n接下来，我们代入 $T(n-2)$，即 $T(n-3) + \\frac{1}{n-2}$：\n$$\nT(n) = \\left( T(n-3) + \\frac{1}{n-2} \\right) + \\frac{1}{n-1} + \\frac{1}{n} = T(n-3) + \\frac{1}{n-2} + \\frac{1}{n-1} + \\frac{1}{n}\n$$\n一个模式正在出现。经过 $i$ 步展开后，表达式变为：\n$$\nT(n) = T(n-i) + \\sum_{k=0}^{i-1} \\frac{1}{n-k}\n$$\n为了达到初始条件 $T(1)$，我们必须展开直到 $T$ 的参数变为 $1$。我们设 $n-i = 1$，得到 $i = n-1$。\n将 $i = n-1$ 代入一般模式：\n$$\nT(n) = T(n-(n-1)) + \\sum_{k=0}^{(n-1)-1} \\frac{1}{n-k} = T(1) + \\sum_{k=0}^{n-2} \\frac{1}{n-k}\n$$\n让我们展开这个求和，以明确地看到各项：\n$$\n\\sum_{k=0}^{n-2} \\frac{1}{n-k} = \\frac{1}{n-0} + \\frac{1}{n-1} + \\dots + \\frac{1}{n-(n-2)} = \\frac{1}{n} + \\frac{1}{n-1} + \\dots + \\frac{1}{2}\n$$\n这是从 $2$ 到 $n$ 的倒数之和。我们可以用一个向上递增的索引，使用求和符号来写这个式子：\n$$\n\\sum_{j=2}^{n} \\frac{1}{j}\n$$\n因此，$T(n)$ 的表达式变为：\n$$\nT(n) = T(1) + \\sum_{j=2}^{n} \\frac{1}{j}\n$$\n我们已知初始条件 $T(1) = 0$。代入这个值：\n$$\nT(n) = 0 + \\sum_{j=2}^{n} \\frac{1}{j} = \\sum_{j=2}^{n} \\frac{1}{j}\n$$\n问题要求用第 $n$ 个调和数 $H_n$ 来表示解，其定义为：\n$$\nH_n = \\sum_{k=1}^{n} \\frac{1}{k}\n$$\n我们可以将 $H_n$ 的和在 $k=1$ 处分开：\n$$\nH_n = \\frac{1}{1} + \\sum_{k=2}^{n} \\frac{1}{k} = 1 + \\sum_{k=2}^{n} \\frac{1}{k}\n$$\n将此与我们的 $T(n)$ 表达式进行比较，我们看到 $T(n) = \\sum_{j=2}^{n} \\frac{1}{j}$。\n因此，我们可以写出：\n$$\nH_n = 1 + T(n)\n$$\n解出 $T(n)$，我们得到最终的闭式表达式：\n$$\nT(n) = H_n - 1\n$$\n这就是在处理 $n$ 个不同元素的随机排列时，动态最小值被更新的期望次数。", "answer": "$$\\boxed{H_n - 1}$$", "id": "3277485"}, {"introduction": "这个练习引入了一个更微妙的挑战：递推关系中的步长大于1。通过解决 $T(n) = T(n-2) + n^2$ [@problem_id:3277510]，你将学会如何处理解依赖于输入值奇偶性的情况。这个练习强调了仔细观察递推关系结构的重要性，并展示了如何将问题分解为不同情况来分别求解，这是处理更复杂递推关系的必备技能。", "problem": "考虑定义在非负整数上的递推关系 $T(n) = T(n-2) + n^{2}$，适用于所有整数 $n \\geq 2$，其初始值为 $T(0) = \\alpha$ 和 $T(1) = \\beta$，其中 $\\alpha$ 和 $\\beta$ 是固定的实数常数。使用代入法（迭代展开），从递推关系定义开始，将其展开直至达到基准情形。请仔细考虑奇偶性如何影响展开路径，并使用熟知的求和公式将所得表达式化简为封闭形式。您的任务是推导出 $T(n)$ 关于 $n$、$\\alpha$ 和 $\\beta$ 的精确解析封闭形式表达式，并区分 $n$ 为偶数和 $n$ 为奇数两种情况。将您的最终答案表示为一个行矩阵，其中第一个元素对应 $n$ 为偶数时的封闭形式，第二个元素对应 $n$ 为奇数时的封闭形式。无需进行舍入。", "solution": "该问题是算法分析中一个适定的数学问题，具有完整且一致的设定。我们将按照要求，使用代入法来解决它。\n\n递推关系由 $T(n) = T(n-2) + n^{2}$ 给出，适用于整数 $n \\geq 2$，初始条件为 $T(0) = \\alpha$ 和 $T(1) = \\beta$。递推参数 $n-2$ 中的步长为2，表明输入的奇偶性保持不变。这意味着当 $n$ 为偶数时，$T(n)$ 的值仅依赖于基准情形 $T(0)$，而当 $n$ 为奇数时，其值仅依赖于 $T(1)$。因此，我们必须分别分析这两种情况。\n\n**情况 1：$n$ 为偶数**\n设 $n$ 是一个偶数非负整数。我们可以将 $n$ 写成 $n = 2k$ 的形式，其中 $k$ 为某个整数 $k \\geq 0$。我们将使用代入法（迭代展开）来展开递推关系，直到达到基准情形 $T(0)$。\n$T(n) = T(n-2) + n^2$\n$T(n) = \\left( T(n-4) + (n-2)^2 \\right) + n^2 = T(n-4) + (n-2)^2 + n^2$\n$T(n) = \\left( T(n-6) + (n-4)^2 \\right) + (n-2)^2 + n^2 = T(n-6) + (n-4)^2 + (n-2)^2 + n^2$\n\n经过 $i$ 步展开后，递推式变为：\n$T(n) = T(n-2i) + \\sum_{j=0}^{i-1} (n-2j)^2$\n\n因为 $n=2k$，我们需要找到达到基准情形 $T(0)$ 所需的步数 $i$。这在 $n-2i = 0$ 时发生，这意味着 $2k - 2i = 0$，所以 $i=k$。\n将 $i=k$ 和 $n=2k$ 代入展开形式：\n$T(2k) = T(2k - 2k) + \\sum_{j=0}^{k-1} (2k - 2j)^2$\n$T(2k) = T(0) + \\sum_{j=0}^{k-1} (2(k-j))^2$\n$T(2k) = \\alpha + 4 \\sum_{j=0}^{k-1} (k-j)^2$\n\n令求和索引为 $m = k-j$。当 $j=0$ 时，$m=k$。当 $j=k-1$ 时，$m=1$。求和式变为：\n$T(2k) = \\alpha + 4 \\sum_{m=1}^{k} m^2$\n\n我们使用前 $k$ 个平方数求和的标准公式：$\\sum_{m=1}^{k} m^2 = \\frac{k(k+1)(2k+1)}{6}$。\n$T(2k) = \\alpha + 4 \\left( \\frac{k(k+1)(2k+1)}{6} \\right) = \\alpha + \\frac{2}{3} k(k+1)(2k+1)$\n\n为了得到用 $n$ 表示的封闭形式，我们代入 $k = n/2$：\n$T(n) = \\alpha + \\frac{2}{3} \\left(\\frac{n}{2}\\right) \\left(\\frac{n}{2}+1\\right) \\left(2 \\cdot \\frac{n}{2}+1\\right)$\n$T(n) = \\alpha + \\frac{n}{3} \\left(\\frac{n+2}{2}\\right) (n+1)$\n$T(n) = \\alpha + \\frac{n(n+1)(n+2)}{6}$\n\n**情况 2：$n$ 为奇数**\n设 $n$ 是一个奇数非负整数。我们可以将 $n$ 写成 $n = 2k+1$ 的形式，其中 $k$ 为某个整数 $k \\geq 0$。我们展开递推关系，直到达到基准情形 $T(1)$。\n经过 $i$ 步后，我们得到：\n$T(n) = T(n-2i) + \\sum_{j=0}^{i-1} (n-2j)^2$\n\n因为 $n = 2k+1$，我们需要找到达到 $T(1)$ 所需的步数 $i$。这在 $n-2i = 1$ 时发生，这意味着 $2k+1 - 2i = 1$，所以 $2k = 2i$，且 $i=k$。\n将 $i=k$ 和 $n=2k+1$ 代入：\n$T(2k+1) = T(2k+1 - 2k) + \\sum_{j=0}^{k-1} (2k+1 - 2j)^2$\n$T(2k+1) = T(1) + \\sum_{j=0}^{k-1} (2(k-j)+1)^2$\n\n令求和索引为 $m = k-j$。当 $j=0$ 时，$m=k$。当 $j=k-1$ 时，$m=1$。求和式变为：\n$T(2k+1) = \\beta + \\sum_{m=1}^{k} (2m+1)^2$\n\n我们计算求和 $\\sum_{m=1}^{k} (2m+1)^2$：\n$\\sum_{m=1}^{k} (2m+1)^2 = \\sum_{m=1}^{k} (4m^2 + 4m + 1) = 4\\sum_{m=1}^{k} m^2 + 4\\sum_{m=1}^{k} m + \\sum_{m=1}^{k} 1$\n使用公式 $\\sum m^2 = \\frac{k(k+1)(2k+1)}{6}$，$\\sum m = \\frac{k(k+1)}{2}$ 和 $\\sum 1 = k$：\n$S_k = 4\\left(\\frac{k(k+1)(2k+1)}{6}\\right) + 4\\left(\\frac{k(k+1)}{2}\\right) + k$\n$S_k = \\frac{2k(k+1)(2k+1)}{3} + 2k(k+1) + k$\n$S_k = \\frac{k}{3} [2(k+1)(2k+1) + 6(k+1) + 3]$\n$S_k = \\frac{k}{3} [2(2k^2+3k+1) + 6k+6 + 3]$\n$S_k = \\frac{k}{3} [4k^2+6k+2 + 6k+9] = \\frac{k(4k^2+12k+11)}{3}$\n因此，$T(2k+1) = \\beta + S_k = \\beta + \\frac{k(4k^2+12k+11)}{3}$。\n\n为了得到用 $n$ 表示的封闭形式，我们代入 $k = (n-1)/2$：\n$T(n) = \\beta + \\frac{(n-1)/2}{3} \\left[ 4\\left(\\frac{n-1}{2}\\right)^2 + 12\\left(\\frac{n-1}{2}\\right) + 11 \\right]$\n$T(n) = \\beta + \\frac{n-1}{6} \\left[ 4\\frac{(n-1)^2}{4} + 6(n-1) + 11 \\right]$\n$T(n) = \\beta + \\frac{n-1}{6} [ (n^2-2n+1) + 6n-6+11 ]$\n$T(n) = \\beta + \\frac{n-1}{6} (n^2+4n+6)$\n展开多项式乘积：\n$(n-1)(n^2+4n+6) = n(n^2+4n+6) - (n^2+4n+6) = n^3+4n^2+6n - n^2-4n-6 = n^3+3n^2+2n-6$\n项 $n^3+3n^2+2n$ 可以因式分解为 $n(n^2+3n+2) = n(n+1)(n+2)$。\n因此，表达式变为：\n$T(n) = \\beta + \\frac{n(n+1)(n+2) - 6}{6}$\n$T(n) = \\beta + \\frac{n(n+1)(n+2)}{6} - 1$\n\n总而言之，封闭形式解为：\n当 $n$ 为偶数时：$T(n) = \\alpha + \\frac{n(n+1)(n+2)}{6}$\n当 $n$ 为奇数时：$T(n) = \\beta - 1 + \\frac{n(n+1)(n+2)}{6}$", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\alpha + \\frac{n(n+1)(n+2)}{6}  \\beta - 1 + \\frac{n(n+1)(n+2)}{6}\n\\end{pmatrix}\n}\n$$", "id": "3277510"}, {"introduction": "当展开递推关系后得到的求和式难以用标准求和公式计算时，我们该怎么办？这个练习引导你使用微积分中的工具来解决这个问题 [@problem_id:3277521]。通过分析递推关系 $T(n) = T(n-c) + \\ln n$，你将学习如何使用定积分来逼近离散求和，从而确定函数的主导项和渐近增长率，这是一种在高级算法分析中极为强大的技术。", "problem": "设 $c \\in \\mathbb{Z}_{\\ge 1}$ 是一个固定的常数，并为整数 $n \\ge 1$ 定义递推关系如下\n$$\nT(n) \\;=\\; T(n - c) \\;+\\; \\ln n,\n$$\n其基本条件为对于所有 $n \\le 0$，$T(n) = 0$。假设 $\\ln$ 表示自然对数。仅从以下基本事实出发：$\\Theta(\\cdot)$ 记号的定义、自然对数的单调性以及初等微积分恒等式 $\\int \\ln x \\, dx = x \\ln x - x$，使用代换法（即，重复展开递推式直到达到基本条件），推导 $T(n)$ 关于 $n$ 和 $c$ 的渐近增长。根据您的推导，确定极限的精确值\n$$\nL(c) \\;=\\; \\lim_{n \\to \\infty} \\frac{T(n)}{n \\ln n},\n$$\n并用它来判断对于哪些整数常数 $c$，函数 $T(n)$ 的阶为 $\\Theta(n \\ln n)$。仅报告 $L(c)$ 的精确表达式作为您的最终答案。无需四舍五入。", "solution": "该问题表述清晰、科学有效，下面开始解题过程。\n\n任务是分析递推关系 $T(n) = T(n - c) + \\ln n$，其中 $n \\ge 1$ 为整数，$c \\in \\mathbb{Z}_{\\ge 1}$ 为固定的整数常数。基本条件是对于所有 $n \\le 0$，$T(n) = 0$。我们将使用代换法来找到 $T(n)$ 的表达式，确定其渐近增长，并计算极限 $L(c) = \\lim_{n \\to \\infty} \\frac{T(n)}{n \\ln n}$。\n\n首先，我们使用代换法展开递推关系：\n$$\n\\begin{aligned}\nT(n) = T(n-c) + \\ln n \\\\\n= (T(n-2c) + \\ln(n-c)) + \\ln n \\\\\n= (T(n-3c) + \\ln(n-2c)) + \\ln(n-c) + \\ln n \\\\\n\\vdots \\\\\n= T(n-kc) + \\sum_{i=0}^{k-1} \\ln(n-ic)\n\\end{aligned}\n$$\n当 $T$ 的参数变为非正数，即 $n-kc \\le 0$ 时，递归终止。由于对于 $x \\le 0$ 有 $T(x)=0$，我们可以将 $T(n)$ 完全写成一个和式。只要 $n-ic > 0$，和式就包含 $\\ln(n-ic)$ 这样的项。设 $k_{max}$ 是和式中的项数。参数是 $n, n-c, n-2c, \\dots, n-(k_{max}-1)c$。最后一项必须为正，所以 $n-(k_{max}-1)c > 0$，这意味着 $(k_{max}-1)c  n$，或 $k_{max}  \\frac{n}{c} + 1$。项数为 $k = \\lfloor \\frac{n-1}{c} \\rfloor + 1$。\n设 $n-1 = qc+r$，其中 $q = \\lfloor \\frac{n-1}{c} \\rfloor$ 是一个整数且 $0 \\le r  c$。\n和式中的项数为 $k = q+1$。\n和为 $T(n) = \\sum_{i=0}^{q} \\ln(n-ic)$。\n和式中最后一项的参数是当 $i=k-1=q$ 时：$n-cq = (qc+r+1)-cq = r+1$。由于 $0 \\le r  c$，我们有 $1 \\le r+1 \\le c$。因此，对数的所有参数都是正整数。\n所以，$T(n) = \\sum_{i=0}^{q} \\ln(n-ic) = \\ln(n) + \\ln(n-c) + \\dots + \\ln(r+1)$。\n\n为了找到 $T(n)$ 的渐近行为，我们用积分来近似这个和。这是合理的，因为 $\\ln x$ 是一个单调函数，这是我们被允许使用的基本事实之一。\n和式中的项是函数 $f(x) = \\ln x$ 在相距为 $c$ 的点上的值。设参数按升序表示为：$x_j = (r+1)+jc$，其中 $j=0, 1, \\dots, q$。注意 $x_q = r+1+qc = n$。$T(n)$ 的和为 $T(n) = \\sum_{j=0}^{q} \\ln(x_j)$。\n\n由于 $\\ln x$ 是一个单调递增函数，我们可以通过与积分比较来确定和的下界和上界。\n对于区间 $[x_j, x_{j+1}]$，我们有 $x_{j+1}-x_j = c$。因为 $\\ln x$ 是递增的：\n$$\nc \\ln(x_j) \\le \\int_{x_j}^{x_{j+1}} \\ln(t) dt \\le c \\ln(x_{j+1})\n$$\n从 $j=0$ 到 $q-1$ 求和：\n$$\nc \\sum_{j=0}^{q-1} \\ln(x_j) \\le \\sum_{j=0}^{q-1} \\int_{x_j}^{x_{j+1}} \\ln(t) dt \\le c \\sum_{j=0}^{q-1} \\ln(x_{j+1})\n$$\n积分的和是伸缩的：$\\sum_{j=0}^{q-1} \\int_{x_j}^{x_{j+1}} \\ln(t) dt = \\int_{x_0}^{x_q} \\ln(t) dt = \\int_{r+1}^{n} \\ln(t) dt$。\n左边的和是 $c(\\sum_{j=0}^{q} \\ln(x_j) - \\ln(x_q)) = c(T(n)-\\ln n)$。\n右边的和是 $c(\\sum_{j=0}^{q} \\ln(x_j) - \\ln(x_0)) = c(T(n)-\\ln(r+1))$。\n这得到了两个不等式：\n1. $c(T(n)-\\ln n) \\le \\int_{r+1}^{n} \\ln t \\, dt \\implies T(n) \\le \\frac{1}{c}\\int_{r+1}^{n} \\ln t \\, dt + \\ln n$。\n2. $\\int_{r+1}^{n} \\ln t \\, dt \\le c(T(n)-\\ln(r+1)) \\implies T(n) \\ge \\frac{1}{c}\\int_{r+1}^{n} \\ln t \\, dt + \\ln(r+1)$。\n\n现在我们使用给定的恒等式 $\\int \\ln x \\, dx = x \\ln x - x$ 来计算定积分：\n$$\n\\int_{r+1}^{n} \\ln t \\, dt = [t \\ln t - t]_{r+1}^{n} = (n \\ln n - n) - ((r+1)\\ln(r+1) - (r+1))\n$$\n$((r+1)\\ln(r+1) - (r+1))$ 这一项相对于 $n$ 是一个常数，因为 $r$ 只依赖于 $(n-1) \\pmod c$，因此在一组有限的值中循环。我们用 $C_r = (r+1)\\ln(r+1) - (r+1)$ 来表示这一项，由于 $1 \\le r+1 \\le c$，所以它是有界的。\n\n现在我们可以写出 $T(n)$ 的界：\n$$\n\\frac{1}{c}(n \\ln n - n - C_r) + \\ln(r+1) \\le T(n) \\le \\frac{1}{c}(n \\ln n - n - C_r) + \\ln n\n$$\n为了求极限 $L(c)$，我们将整个不等式除以 $n \\ln n$：\n$$\n\\frac{1}{c}\\left(1 - \\frac{1}{\\ln n} - \\frac{C_r}{n \\ln n}\\right) + \\frac{\\ln(r+1)}{n \\ln n} \\le \\frac{T(n)}{n \\ln n} \\le \\frac{1}{c}\\left(1 - \\frac{1}{\\ln n} - \\frac{C_r}{n \\ln n}\\right) + \\frac{1}{n}\n$$\n现在，我们取 $n \\to \\infty$ 时的极限。对于下界：\n$$\n\\lim_{n \\to \\infty} \\left[ \\frac{1}{c}\\left(1 - \\frac{1}{\\ln n} - \\frac{C_r}{n \\ln n}\\right) + \\frac{\\ln(r+1)}{n \\ln n} \\right] = \\frac{1}{c}(1 - 0 - 0) + 0 = \\frac{1}{c}\n$$\n对于上界：\n$$\n\\lim_{n \\to \\infty} \\left[ \\frac{1}{c}\\left(1 - \\frac{1}{\\ln n} - \\frac{C_r}{n \\ln n}\\right) + \\frac{1}{n} \\right] = \\frac{1}{c}(1 - 0 - 0) + 0 = \\frac{1}{c}\n$$\n根据夹逼定理 (Squeeze Theorem)，由于 $\\frac{T(n)}{n \\ln n}$ 的下界和上界都收敛于 $\\frac{1}{c}$，我们有：\n$$\nL(c) = \\lim_{n \\to \\infty} \\frac{T(n)}{n \\ln n} = \\frac{1}{c}\n$$\n问题还问到，对于哪些整数常数 $c$，函数 $T(n)$ 的阶为 $\\Theta(n \\ln n)$。如果极限 $\\lim_{n \\to \\infty} \\frac{f(n)}{g(n)}$ 存在且为一个正常数，那么函数 $f(n)$ 是 $\\Theta(g(n))$。在我们的例子中，$g(n) = n \\ln n$。我们发现极限为 $L(c) = \\frac{1}{c}$。问题陈述 $c \\in \\mathbb{Z}_{\\ge 1}$，这意味着 $c$ 是一个正整数（$1, 2, 3, \\dots$）。对于任何这样的 $c$，极限 $\\frac{1}{c}$ 是一个正常数。因此，对于所有整数常数 $c \\ge 1$，$T(n) = \\Theta(n \\ln n)$。\n\n所要求的最终答案是 $L(c)$ 的精确表达式。", "answer": "$$\n\\boxed{\\frac{1}{c}}\n$$", "id": "3277521"}]}