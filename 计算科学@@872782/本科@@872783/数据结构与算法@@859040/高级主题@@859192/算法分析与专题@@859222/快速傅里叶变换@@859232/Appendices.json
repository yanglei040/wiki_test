{"hands_on_practices": [{"introduction": "许多高效的快速傅里叶变换（FFT）算法，例如经典的库利-图基（Cooley-Tukey）算法，在计算时并不是按自然顺序处理输入数据的。为了实现“原地”计算并提高效率，它们通常需要一个初始的数据重排步骤，称为比特反转置换。通过这个练习[@problem_id:2213535]，你将亲手执行这一操作，从而具体地理解FFT算法内部的一个基本构件。", "problem": "快速傅里叶变换 (FFT) 算法的一种常见实现，特别是时间抽取 (decimation-in-time) 变体，需要一个初始数据重排步骤。考虑一个长度为 $N=8$ 的输入数据序列，记为 $X = (x_0, x_1, x_2, x_3, x_4, x_5, x_6, x_7)$。重排是使用位反转置换来执行的。\n\n对于一个长度为 $N=2^m$ 的序列，索引 $k$ 的位反转操作如下：\n1. 将索引 $k$ 表示为一个 $m$ 位的二进制数。如果其二进制表示不足 $m$ 位，则在前面用前导零填充。\n2. 反转这 $m$ 位的顺序。\n3. 反转后的二进制字符串对应的新整数值即为位反转索引，我们可将其记为 $\\text{rev}(k)$。\n\n置换规则规定，原先在索引 $k$ 处的数据点将被移动到索引为 $\\text{rev}(k)$ 的位置。你的任务是确定在对初始序列 $X$ 应用此置换后，最终重排的数据点序列。\n\n以下哪个选项表示正确重排后的序列？\n\nA. $(x_0, x_1, x_2, x_3, x_4, x_5, x_6, x_7)$\n\nB. $(x_0, x_4, x_2, x_6, x_1, x_5, x_3, x_7)$\n\nC. $(x_7, x_6, x_5, x_4, x_3, x_2, x_1, x_0)$\n\nD. $(x_7, x_3, x_5, x_1, x_6, x_2, x_4, x_0)", "solution": "我们有 $N=8$ 且 $N=2^{m}$，因此 $m=3$。对于每个索引 $k \\in \\{0,1,2,3,4,5,6,7\\}$，写出其 $3$ 位二进制表示，反转这 $3$ 位，并将结果解释为 $\\operatorname{rev}(k)$。计算过程如下：\n$$\n\\begin{aligned}\nk=0:\\ 000 \\mapsto 000 \\Rightarrow \\operatorname{rev}(0)=0,\\\\\nk=1:\\ 001 \\mapsto 100 \\Rightarrow \\operatorname{rev}(1)=4,\\\\\nk=2:\\ 010 \\mapsto 010 \\Rightarrow \\operatorname{rev}(2)=2,\\\\\nk=3:\\ 011 \\mapsto 110 \\Rightarrow \\operatorname{rev}(3)=6,\\\\\nk=4:\\ 100 \\mapsto 001 \\Rightarrow \\operatorname{rev}(4)=1,\\\\\nk=5:\\ 101 \\mapsto 101 \\Rightarrow \\operatorname{rev}(5)=5,\\\\\nk=6:\\ 110 \\mapsto 011 \\Rightarrow \\operatorname{rev}(6)=3,\\\\\nk=7:\\ 111 \\mapsto 111 \\Rightarrow \\operatorname{rev}(7)=7.\n\\end{aligned}\n$$\n置换规则是：数据 $x_{k}$ 移动到索引 $\\operatorname{rev}(k)$。设重排后的序列为 $Y=(Y_{0},Y_{1},\\dots,Y_{7})$，其中 $Y_{j}$ 表示最终索引为 $j$ 的元素。由于位反转是一个对合运算，即 $\\operatorname{rev}(\\operatorname{rev}(k))=k$，我们有 $Y_{j}=x_{\\operatorname{rev}(j)}$。使用计算出的值：\n$$\n\\begin{aligned}\nY_{0}=x_{\\operatorname{rev}(0)}=x_{0},\\quad Y_{1}=x_{\\operatorname{rev}(1)}=x_{4},\\quad Y_{2}=x_{\\operatorname{rev}(2)}=x_{2},\\quad Y_{3}=x_{\\operatorname{rev}(3)}=x_{6},\\\\\nY_{4}=x_{\\operatorname{rev}(4)}=x_{1},\\quad Y_{5}=x_{\\operatorname{rev}(5)}=x_{5},\\quad Y_{6}=x_{\\operatorname{rev}(6)}=x_{3},\\quad Y_{7}=x_{\\operatorname{rev}(7)}=x_{7}.\n\\end{aligned}\n$$\n因此，重排后的序列是 $(x_{0},x_{4},x_{2},x_{6},x_{1},x_{5},x_{3},x_{7})$，这对应于选项 B。", "answer": "$$\\boxed{B}$$", "id": "2213535"}, {"introduction": "计算出FFT频谱后，我们得到的是一系列对应于不同离散频率“仓”（bin）的复数值。然而，在实际应用中，我们更关心的是与这些抽象索引相对应的物理频率，例如以赫兹（Hz）为单位的频率。这个练习[@problem_id:2213513]将指导你完成从FFT输出的频率索引到有明确物理意义的频率值的关键转换，这是解读任何真实世界信号分析结果的基础。", "problem": "一位生物医学工程师正在分析用于研究肌肉疲劳的肌电图 (EMG) 信号，该信号测量骨骼肌的电活动。该信号是使用表面电极从一名运动员的腿部肌肉采集的。数据以 $f_s = 400$ Hz 的恒定速率进行采样。为了进行频谱分析，使用快速傅里叶变换 (FFT) 算法处理一段包含 $N = 128$ 个连续数据点的信号。所得频谱在频率索引 $k=10$ 处显示出一个显著的峰值。这个峰值代表了在特定收缩期间肌肉放电率中的一个主导频率分量。假设索引 $k=0$ 对应于直流 (DC) 分量，请确定这个主导分量的物理频率。\n\n请以赫兹 (Hz) 为单位，用数值表示你的答案。", "solution": "对于一个以速率 $f_s$ 采样并用 $N$ 点 DFT/FFT 进行分析的离散时间信号，其频率间隔（分辨率）为\n$$\n\\Delta f = \\frac{f_s}{N}.\n$$\n对应于索引 $k$ 的物理频率（其中 $k=0$ 为直流分量）为\n$$\nf_k = k\\,\\Delta f = \\frac{k f_s}{N}.\n$$\n已知 $f_s = 400$ Hz, $N = 128$, 且 $k = 10$,\n$$\nf_{10} = \\frac{10 \\times 400}{128} = \\frac{4000}{128} = \\frac{250}{8} = 31.25 \\text{ Hz}.\n$$\n因此，该主导分量的频率为 31.25 Hz。", "answer": "$$\\boxed{31.25}$$", "id": "2213513"}, {"introduction": "FFT最强大的应用之一是它能够依据卷积定理，将时域中计算复杂度为 $\\mathcal{O}(N^2)$ 的卷积操作，转化为频域中复杂度仅为 $\\mathcal{O}(N)$ 的逐点乘积，从而实现快速卷积。这个练习[@problem_id:1717795]将演示如何利用FFT计算两个信号的线性卷积，并特别强调“零填充”（zero-padding）这一关键技术，它是确保频域乘法结果正确对应于线性卷积而非循环卷积的必要步骤。", "problem": "考虑两个离散时间有限长度信号 $x[n]$ 和 $h[n]$，它们仅在 $n \\ge 0$ 时非零。信号定义如下：\n*   $x[n] = 2\\delta[n] + \\delta[n-1] - \\delta[n-2]$\n*   $h[n] = \\delta[n] + 3\\delta[n-1]$\n其中 $\\delta[n]$ 是克罗内克 delta 函数。\n\n令 $y[n]$ 表示 $x[n]$ 和 $h[n]$ 的线性卷积，即 $y[n] = (x * h)[n]$。你的任务是使用频域方法计算此卷积。具体来说，你必须使用快速傅里叶变换 (FFT) 和逆快速傅里叶变换 (IFFT) 在频域中执行乘法。\n\n确定输出样本 $y[2]$ 的值。", "solution": "我们希望通过使用 $N$ 点 FFT/IFFT 进行频域乘法来得到 $y[n]=(x*h)[n]$，其中 $N\\geq L_{x}+L_{h}-1$。$x[n]$ 的非零支撑集为 $n\\in\\{0,1,2\\}$，$h[n]$ 的非零支撑集为 $n\\in\\{0,1\\}$，所以 $L_{x}=3$，$L_{h}=2$，且 $L_{x}+L_{h}-1=4$。选择 $N=4$，这样在补零后，$4$ 点循环卷积就等于线性卷积。\n\n补零至长度 $4$：\n$$\nx[0]=2,\\;x[1]=1,\\;x[2]=-1,\\;x[3]=0,\\qquad\nh[0]=1,\\;h[1]=3,\\;h[2]=0,\\;h[3]=0.\n$$\n\n定义 $N$ 点 DFT 核 $W_{N}=\\exp(-\\mathrm{j}2\\pi/N)$，其中 $\\mathrm{j}^2=-1$。对于 $N=4$，$W_{4}=\\exp(-\\mathrm{j}\\pi/2)$ 且 $W_{4}^{0}=1$, $W_{4}^{1}=-\\mathrm{j}$, $W_{4}^{2}=-1$, $W_{4}^{3}=\\mathrm{j}$。\n\n计算 $4$ 点 DFT $X[k]=\\sum_{n=0}^{3}x[n]W_{4}^{kn}$ 和 $H[k]=\\sum_{n=0}^{3}h[n]W_{4}^{kn}$：\n- 对于 $X[k]$：\n$$\n\\begin{aligned}\nX[0]&=2+1+(-1)+0=2,\\\\\nX[1]&=2+1(-\\mathrm{j})+(-1)(-1)+0=3-\\mathrm{j},\\\\\nX[2]&=2+1(-1)+(-1)(1)+0=0,\\\\\nX[3]&=2+1(\\mathrm{j})+(-1)(-1)+0=3+\\mathrm{j}.\n\\end{aligned}\n$$\n- 对于 $H[k]$：\n$$\n\\begin{aligned}\nH[0]&=1+3+0+0=4,\\\\\nH[1]&=1+3(-\\mathrm{j})=1-3\\mathrm{j},\\\\\nH[2]&=1+3(-1)=-2,\\\\\nH[3]&=1+3(\\mathrm{j})=1+3\\mathrm{j}.\n\\end{aligned}\n$$\n\n在频域中相乘：$Y[k]=X[k]H[k]$：\n$$\n\\begin{aligned}\nY[0]&=2\\cdot 4=8,\\\\\nY[1]&=(3-\\mathrm{j})(1-3\\mathrm{j})=-10\\mathrm{j},\\\\\nY[2]&=0\\cdot(-2)=0,\\\\\nY[3]&=(3+\\mathrm{j})(1+3\\mathrm{j})=10\\mathrm{j}.\n\\end{aligned}\n$$\n\n应用 $4$ 点 IFFT 得到 $y[n]=\\frac{1}{4}\\sum_{k=0}^{3}Y[k]\\exp(\\mathrm{j}2\\pi kn/4)$。对于 $n=2$，\n$$\ny[2]=\\frac{1}{4}\\sum_{k=0}^{3}Y[k]\\exp(\\mathrm{j}\\pi k)=\\frac{1}{4}\\sum_{k=0}^{3}Y[k](-1)^{k}.\n$$\n代入 $Y[k]$：\n$$\ny[2]=\\frac{1}{4}\\left(8-(-10\\mathrm{j})+0-(10\\mathrm{j})\\right)=\\frac{1}{4}\\left(8+10\\mathrm{j}-10\\mathrm{j}\\right)=\\frac{8}{4}=2.\n$$\n\n因为 $N=4\\geq L_{x}+L_{h}-1$，所以这个 IFFT 样本等于所求的线性卷积样本，因此 $y[2]=2$。", "answer": "$$\\boxed{2}$$", "id": "1717795"}]}