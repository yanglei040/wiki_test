{"hands_on_practices": [{"introduction": "Cook-Levin 定理的核心思想是，任何 NP 问题都可以归约到布尔可满足性问题（SAT）。这个练习将通过一个经典的 NP 完全问题——图 3-着色问题——来让你亲手体验这一过程 [@problem_id:3268206]。通过为图的顶点和颜色定义布尔变量，并用子句来表达着色规则，你将学会如何将一个复杂的组合问题转化为一个等价的可满足性问题。", "problem": "考虑布尔可满足性问题 (SAT) 和 Cook–Levin 定理，该定理确立了 SAT 是非确定性多项式时间完备的 (NP-完备)。证明组合问题难度的一个经典方法是将其归约到 SAT。图 3-着色问题定义如下：给定一个无向图 $G=(V,E)$，判断是否可以用恰好 3 种颜色对 $V$ 中的顶点进行着色，使得 $E$ 中没有任意一条边的两个端点颜色相同。仅使用 SAT、合取范式 (CNF) 和图 3-着色问题的基本定义，对以下特定图实例执行归约：\n$$\nG=(V,E),\\quad V=\\{v_{1},v_{2},v_{3},v_{4},v_{5}\\},\\quad E=\\{(v_{1},v_{2}),(v_{2},v_{3}),(v_{3},v_{4}),(v_{4},v_{5}),(v_{5},v_{1}),(v_{2},v_{5})\\}.\n$$\n通过为每个顶点 $v_{i}\\in V$ 和每种颜色 $c\\in\\{1,2,3\\}$ 引入布尔变量 $x_{i,c}$，并编码以下约束，构造一个 CNF 公式，其可满足赋值与 $G$ 的正常 3-着色一一对应：\n- 对于每个顶点，约束其至少被赋予一种颜色且至多被赋予一种颜色，以及\n- 对于每条边，约束其端点颜色不同。\n\n明确列举出此实例中为每个顶点和每条边生成的所有变量和所有 CNF 子句。然后，计算所得 CNF 公式中的子句总数。将最终答案表示为一个精确整数。无需四舍五入。", "solution": "这个问题是有效的，因为它是计算复杂性理论中一个定义明确的标准练习，具体涉及将图 3-着色问题归约到布尔可满足性问题 (SAT)。所有必需信息，包括具体的图实例和构造合取范式 (CNF) 公式的规则，都已明确给出且逻辑上一致。\n\n我们的任务是构造一个 CNF 公式 $\\Phi$，该公式可满足当且仅当给定的图 $G=(V, E)$ 是 3-可着色的。该图定义为顶点集 $V=\\{v_{1},v_{2},v_{3},v_{4},v_{5}\\}$ 和边集 $E=\\{(v_{1},v_{2}),(v_{2},v_{3}),(v_{3},v_{4}),(v_{4},v_{5}),(v_{5},v_{1}),(v_{2},v_{5})\\}$。顶点数为 $|V|=5$，边数为 $|E|=6$。我们将使用包含 3 种颜色的集合，可以标记为 $\\{1, 2, 3\\}$。\n\n首先，我们定义布尔变量。对于每个顶点 $v_i \\in V$ 和每种颜色 $c \\in \\{1, 2, 3\\}$，我们引入一个变量 $x_{i,c}$。如果顶点 $v_i$ 被着以颜色 $c$，则变量 $x_{i,c}$ 的值为真，否则为假。由于有 5 个顶点和 3 种颜色，我们总共有 $5 \\times 3 = 15$ 个变量：\n$x_{1,1}, x_{1,2}, x_{1,3}, x_{2,1}, x_{2,2}, x_{2,3}, x_{3,1}, x_{3,2}, x_{3,3}, x_{4,1}, x_{4,2}, x_{4,3}, x_{5,1}, x_{5,2}, x_{5,3}$。\n\nCNF 公式 $\\Phi$ 是强制执行问题陈述中描述的三种类型约束的子句的合取。\n\n约束 1：每个顶点必须被赋予至少一种颜色。\n对于每个顶点 $v_i \\in V$，它必须被着色为颜色 1，或颜色 2，或颜色 3。这可以转化为形式为 $(x_{i,1} \\lor x_{i,2} \\lor x_{i,3})$ 的子句。由于有 $|V|=5$ 个顶点，此约束生成 5 个子句：\n1. 对于 $v_1$：$(x_{1,1} \\lor x_{1,2} \\lor x_{1,3})$\n2. 对于 $v_2$：$(x_{2,1} \\lor x_{2,2} \\lor x_{2,3})$\n3. 对于 $v_3$：$(x_{3,1} \\lor x_{3,2} \\lor x_{3,3})$\n4. 对于 $v_4$：$(x_{4,1} \\lor x_{4,2} \\lor x_{4,3})$\n5. 对于 $v_5$：$(x_{5,1} \\lor x_{5,2} \\lor x_{5,3})$\n此约束的子句总数为 $5$。\n\n约束 2：每个顶点至多被赋予一种颜色。\n对于每个顶点 $v_i \\in V$ 和每对不同的颜色 $c_1, c_2 \\in \\{1, 2, 3\\}$，顶点 $v_i$ 不能同时被着以 $c_1$ 和 $c_2$ 两种颜色。这通过子句 $(\\neg x_{i,c_1} \\lor \\neg x_{i,c_2})$ 来强制执行。对于每个顶点，有 $\\binom{3}{2}=3$ 对颜色：$(1,2)$、$(1,3)$ 和 $(2,3)$。由于有 $|V|=5$ 个顶点，此约束生成 $5 \\times 3 = 15$ 个子句。\n1. 对于 $v_1$：$(\\neg x_{1,1} \\lor \\neg x_{1,2})$、$(\\neg x_{1,1} \\lor \\neg x_{1,3})$、$(\\neg x_{1,2} \\lor \\neg x_{1,3})$\n2. 对于 $v_2$：$(\\neg x_{2,1} \\lor \\neg x_{2,2})$、$(\\neg x_{2,1} \\lor \\neg x_{2,3})$、$(\\neg x_{2,2} \\lor \\neg x_{2,3})$\n3. 对于 $v_3$：$(\\neg x_{3,1} \\lor \\neg x_{3,2})$、$(\\neg x_{3,1} \\lor \\neg x_{3,3})$、$(\\neg x_{3,2} \\lor \\neg x_{3,3})$\n4. 对于 $v_4$：$(\\neg x_{4,1} \\lor \\neg x_{4,2})$、$(\\neg x_{4,1} \\lor \\neg x_{4,3})$、$(\\neg x_{4,2} \\lor \\neg x_{4,3})$\n5. 对于 $v_5$：$(\\neg x_{5,1} \\lor \\neg x_{5,2})$、$(\\neg x_{5,1} \\lor \\neg x_{5,3})$、$(\\neg x_{5,2} \\lor \\neg x_{5,3})$\n此约束的子句总数为 $15$。\n\n约束 3：没有两个相邻顶点共享相同颜色。\n对于每条边 $(v_i, v_j) \\in E$ 和每种颜色 $c \\in \\{1, 2, 3\\}$，不允许 $v_i$ 和 $v_j$ 都被着以颜色 $c$。这由子句 $(\\neg x_{i,c} \\lor \\neg x_{j,c})$ 捕获。该图有 $|E|=6$ 条边。对于每条边，我们必须对所有 3 种颜色强制执行此约束。因此，此约束生成 $6 \\times 3 = 18$ 个子句。\n边集为 $E=\\{(v_{1},v_{2}),(v_{2},v_{3}),(v_{3},v_{4}),(v_{4},v_{5}),(v_{5},v_{1}),(v_{2},v_{5})\\}$。\n1. 对于边 $(v_1, v_2)$：$(\\neg x_{1,1} \\lor \\neg x_{2,1})$、$(\\neg x_{1,2} \\lor \\neg x_{2,2})$、$(\\neg x_{1,3} \\lor \\neg x_{2,3})$\n2. 对于边 $(v_2, v_3)$：$(\\neg x_{2,1} \\lor \\neg x_{3,1})$、$(\\neg x_{2,2} \\lor \\neg x_{3,2})$、$(\\neg x_{2,3} \\lor \\neg x_{3,3})$\n3. 对于边 $(v_3, v_4)$：$(\\neg x_{3,1} \\lor \\neg x_{4,1})$、$(\\neg x_{3,2} \\lor \\neg x_{4,2})$、$(\\neg x_{3,3} \\lor \\neg x_{4,3})$\n4. 对于边 $(v_4, v_5)$：$(\\neg x_{4,1} \\lor \\neg x_{5,1})$、$(\\neg x_{4,2} \\lor \\neg x_{5,2})$、$(\\neg x_{4,3} \\lor \\neg x_{5,3})$\n5. 对于边 $(v_5, v_1)$：$(\\neg x_{5,1} \\lor \\neg x_{1,1})$、$(\\neg x_{5,2} \\lor \\neg x_{1,2})$、$(\\neg x_{5,3} \\lor \\neg x_{1,3})$\n6. 对于边 $(v_2, v_5)$：$(\\neg x_{2,1} \\lor \\neg x_{5,1})$、$(\\neg x_{2,2} \\lor \\neg x_{5,2})$、$(\\neg x_{2,3} \\lor \\neg x_{5,3})$\n此约束的子句总数为 $18$。\n\n最后，为了求出所得 CNF 公式 $\\Phi$ 中的子句总数，我们将三种约束生成的子句数量相加：\n子句总数 = (约束 1 的子句数) + (约束 2 的子句数) + (约束 3 的子句数)\n子句总数 = $5 + 15 + 18 = 38$。\n因此，对于给定的图实例，等价于 3-着色问题的 CNF 公式由 38 个子句组成。", "answer": "$$\\boxed{38}$$", "id": "3268206"}, {"introduction": "虽然一般的 SAT 问题是 NP 完全的，但它的一个重要特例 2-SAT 却可以在多项式时间内求解。这个练习将引导你把一个关于社交偏好的实际场景建模为 2-SAT 问题，并利用蕴含图和强连通分量来找到一个可行的解决方案 [@problem_id:3268081]。这不仅能让你掌握一个高效的算法，还能锻炼你从复杂约束中识别易解结构的能力。", "problem": "一个小型研讨会正在组织中，有五名潜在的志愿者：Ada、Bo、Cy、Di 和 Emi。为每个人定义一个布尔变量 $x_A, x_B, x_C, x_D, x_E$，其中 $x_P = 1$ 表示 $P$ 参加，而 $x_P = 0$ 表示 $P$ 不参加。组织者收集了以下社交依赖性陈述：\n- Ada 和 Bo 不会同时参加。\n- 如果 Cy 参加，则 Ada 也参加。\n- Di 参加当且仅当 Bo 参加。\n- 除非 Cy 参加，否则 Emi 拒绝参加。\n- Ada 或 Di 中至少有一人参加。\n- Cy 或 Emi 中恰好有一人参加。\n- 如果 Ada 不参加，那么 Bo 必须参加。\n- 如果 Di 参加，那么 Cy 不参加。\n\n你的任务是：\n- 将这些陈述形式化为一个二元可满足性（2-SAT）实例，方法是将每个陈述转换为每个子句恰好包含两个文字的合取范式（CNF）子句。使用逻辑联结词 $\\lnot$、$\\lor$ 和 $\\land$。\n- 使用标准的二元可满足性（2-SAT）多项式时间推理方法，通过蕴含图和强连通分量（SCC），判断该实例是否可满足，并推导出 $(x_A, x_B, x_C, x_D, x_E)$ 的一个满足赋值。\n- 将满足赋值编码为一个比特顺序为 $[x_A, x_B, x_C, x_D, x_E]$ 的二进制数，其中 $1$ 表示参加， $0$ 表示缺席。将这个 5 比特的二进制字符串解释为一个以 2 为基数的整数，并以 10 为基数报告其值。\n\n背景知识：根据 Cook-Levin 定理，布尔可满足性问题是典型的 $\\mathsf{NP}$-完全问题，而二元可满足性（2-SAT）问题可以使用蕴含图在多项式时间内求解。\n\n将最终结果表示为单个整数。无需四舍五入。", "solution": "该问题要求我们确定关于五名志愿者的一组约束是否可以被满足，如果可以，则找出一个有效的参加情况分配。这是一个二元可满足性（2-SAT）问题的实例。\n\n首先，我们验证问题。给定的是五名志愿者，他们对应的布尔变量 $x_A, x_B, x_C, x_D, x_E$，以及八个依赖性陈述。该问题定义明确，在计算机科学和逻辑学领域有科学依据，并且所有陈述都是客观的。任务是将问题形式化为一个 2-SAT 实例，求解它，并以指定的数值格式报告结果。该问题是有效的。\n\n解决方案分三个阶段进行：\n1.  将英文陈述形式化为一个合取范式（CNF）公式，其中每个子句恰好包含两个文字（一个 2-CNF 公式）。\n2.  为该 2-CNF 公式构建蕴含图，找到其强连通分量（SCC），并确定一个满足赋值。\n3.  将该赋值编码为一个二进制数，并将其转换为十进制表示。\n\n令 $x_P = 1$ 表示 $P$ 参加， $x_P=0$ 表示他们不参加。一个文字是一个变量 $x_P$ 或其否定 $\\lnot x_P$。\n\n步骤 1：形式化为 2-CNF 子句\n\n我们将每个陈述翻译成一个或多个 2-CNF 子句，它们是两个文字的析取。整个公式是这些子句的合取。\n\n1.  “Ada 和 Bo 不会同时参加”：$\\lnot(x_A \\land x_B) \\equiv (\\lnot x_A \\lor \\lnot x_B)$。\n2.  “如果 Cy 参加，则 Ada 也参加”：$x_C \\implies x_A \\equiv (\\lnot x_C \\lor x_A)$。\n3.  “Di 参加当且仅当 Bo 参加”：$x_D \\iff x_B \\equiv (x_D \\implies x_B) \\land (x_B \\implies x_D) \\equiv (\\lnot x_D \\lor x_B) \\land (\\lnot x_B \\lor x_D)$。\n4.  “除非 Cy 参加，否则 Emi 拒绝参加”（如果 Emi 参加，则 Cy 参加）：$x_E \\implies x_C \\equiv (\\lnot x_E \\lor x_C)$。\n5.  “Ada 或 Di 中至少有一人参加”：$(x_A \\lor x_D)$。\n6.  “Cy 或 Emi 中恰好有一人参加”：$x_C \\oplus x_E \\equiv (x_C \\lor x_E) \\land (\\lnot x_C \\lor \\lnot x_E)$。\n7.  “如果 Ada 不参加，那么 Bo 必须参加”：$\\lnot x_A \\implies x_B \\equiv (\\lnot(\\lnot x_A) \\lor x_B) \\equiv (x_A \\lor x_B)$。\n8.  “如果 Di 参加，那么 Cy 不参加”：$x_D \\implies \\lnot x_C \\equiv (\\lnot x_D \\lor \\lnot x_C)$。\n\n完整的 2-CNF 公式是所有这些子句的合取：\n$$\n(\\lnot x_A \\lor \\lnot x_B) \\land (\\lnot x_C \\lor x_A) \\land (\\lnot x_D \\lor x_B) \\land (\\lnot x_B \\lor x_D) \\land (\\lnot x_E \\lor x_C) \\land (x_A \\lor x_D) \\land (x_C \\lor x_E) \\land (\\lnot x_C \\lor \\lnot x_E) \\land (x_A \\lor x_B) \\land (\\lnot x_D \\lor \\lnot x_C)\n$$\n\n步骤 2：蕴含图和可满足性\n\n一个 2-SAT 实例是可解的，当且仅当没有变量及其否定属于蕴含图的同一个强连通分量（SCC）。每个子句 $(L_1 \\lor L_2)$ 等价于两个蕴含：$(\\lnot L_1 \\implies L_2)$ 和 $(\\lnot L_2 \\implies L_1)$。这些蕴含成为图中的有向边，该图的顶点是文字集合 $\\{x_A, \\lnot x_A, \\dots, x_E, \\lnot x_E\\}$。\n\n这些边是：\n- 从 $(\\lnot x_A \\lor \\lnot x_B)$ 得出：$x_A \\to \\lnot x_B$, $x_B \\to \\lnot x_A$。\n- 从 $(\\lnot x_C \\lor x_A)$ 得出：$x_C \\to x_A$, $\\lnot x_A \\to \\lnot x_C$。\n- 从 $(\\lnot x_D \\lor x_B)$ 得出：$x_D \\to x_B$, $\\lnot x_B \\to \\lnot x_D$。\n- 从 $(\\lnot x_B \\lor x_D)$ 得出：$x_B \\to x_D$, $\\lnot x_D \\to \\lnot x_B$。\n- 从 $(\\lnot x_E \\lor x_C)$ 得出：$x_E \\to x_C$, $\\lnot x_C \\to \\lnot x_E$。\n- 从 $(x_A \\lor x_D)$ 得出：$\\lnot x_A \\to x_D$, $\\lnot x_D \\to x_A$。\n- 从 $(x_C \\lor x_E)$ 得出：$\\lnot x_C \\to x_E$, $\\lnot x_E \\to x_C$。\n- 从 $(\\lnot x_C \\lor \\lnot x_E)$ 得出：$x_C \\to \\lnot x_E$, $x_E \\to \\lnot x_C$。\n- 从 $(x_A \\lor x_B)$ 得出：$\\lnot x_A \\to x_B$, $\\lnot x_B \\to x_A$。\n- 从 $(\\lnot x_D \\lor \\lnot x_C)$ 得出：$x_D \\to \\lnot x_C$, $x_C \\to \\lnot x_D$。\n\n结合这些边，我们发现定义了强连通分量（SCC）的等价关系：\n- $x_B \\iff x_D$ (来自子句 3) 导致 SCCs $\\{x_B, x_D\\}$ 和 $\\{\\lnot x_B, \\lnot x_D\\}$。\n- $x_A \\iff \\lnot x_B$ (来自子句 1 和 7) 导致 SCCs $\\{x_A, \\lnot x_B\\}$ 和 $\\{\\lnot x_A, x_B\\}$。\n- $x_C \\iff \\lnot x_E$ (来自子句 6) 导致 SCCs $\\{x_C, \\lnot x_E\\}$ 和 $\\{\\lnot x_C, x_E\\}$。\n\n结合这些等价关系揭示了更大的 SCCs：\n- $x_A \\iff \\lnot x_B \\iff \\lnot x_D$。这得到 $S_1 = \\{x_A, \\lnot x_B, \\lnot x_D\\}$。\n- 其逆否命题给出 $\\lnot x_A \\iff x_B \\iff x_D$。这得到 $S_2 = \\{\\lnot x_A, x_B, x_D\\}$。\n- $x_C \\iff \\lnot x_E$。这得到 $S_3 = \\{x_C, \\lnot x_E\\}$。\n- 其逆否命题给出 $\\lnot x_C \\iff x_E$。这得到 $S_4 = \\{\\lnot x_C, x_E\\}$。\n\n由于没有 SCC 同时包含一个文字及其否定（例如，$x_A$ 和 $\\lnot x_A$），该公式是可满足的。\n\n为了找到一个满足赋值，我们分析这些 SCC 之间的蕴含关系，形成一个缩点图。\n- $x_D \\to \\lnot x_C$ (来自子句 8) 意味着一条从 $S_2$ 到 $S_4$ 的边。\n- $x_E \\to x_C$ (来自子句 4) 意味着一条从 $S_4$ 到 $S_3$ 的边。\n- $x_C \\to x_A$ (来自子句 2) 意味着一条从 $S_3$ 到 $S_1$ 的边。\n\n缩点图的结构是 $S_2 \\to S_4 \\to S_3 \\to S_1$。该图的一个拓扑排序是 $(S_2, S_4, S_3, S_1)$。为了找到一个满足赋值，我们按照拓扑排序的逆序处理 SCCs：$(S_1, S_3, S_4, S_2)$。\n\n1.  处理 $S_1 = \\{x_A, \\lnot x_B, \\lnot x_D\\}$。这些变量尚未被赋值。我们将这些文字赋值为 `true`：$x_A=1$, $\\lnot x_B=1 \\implies x_B=0$, $\\lnot x_D=1 \\implies x_D=0$。这确定了赋值 $(x_A, x_B, x_D) = (1, 0, 0)$。\n2.  处理 $S_3 = \\{x_C, \\lnot x_E\\}$。这些变量尚未被赋值。我们将这些文字赋值为 `true`：$x_C=1$, $\\lnot x_E=1 \\implies x_E=0$。这确定了赋值 $(x_C, x_E) = (1, 0)$。\n3.  处理 $S_4$ 和 $S_2$。这些 SCC 中的变量已在之前的步骤中被赋值。\n\n通过这种方法找到的唯一满足赋值是 $(x_A, x_B, x_C, x_D, x_E) = (1, 0, 1, 0, 0)$。\n我们验证这个解：\n- $x_A=1, x_B=0$: Ada 参加, Bo 不参加。满足约束 1、5、7。\n- $x_C=1, x_A=1$: 满足约束 2。\n- $x_D=0, x_B=0$: 满足约束 3。\n- $x_E=0, x_C=1$: 满足约束 4。\n- $x_C=1, x_E=0$: 满足约束 6。\n- $x_D=0, x_C=1 \\implies \\lnot x_C = 0$: 满足约束 8。\n所有约束都被满足。\n\n步骤 3：编码结果\n\n满足赋值 $(x_A, x_B, x_C, x_D, x_E) = (1, 0, 1, 0, 0)$ 被编码为一个比特顺序为 $[x_A, x_B, x_C, x_D, x_E]$ 的二进制数。该二进制字符串是 $10100_2$。\n将此转换为以 10 为基数的整数：\n$$\n10100_2 = 1 \\cdot 2^4 + 0 \\cdot 2^3 + 1 \\cdot 2^2 + 0 \\cdot 2^1 + 0 \\cdot 2^0 = 16 + 0 + 4 + 0 + 0 = 20\n$$\n其值为 $20$。", "answer": "$$\\boxed{20}$$", "id": "3268081"}]}