{"hands_on_practices": [{"introduction": "理论上的定义最好通过具体的例子来理解。这个练习将分析一个基于离散对数难题的函数，它构成了 ElGamal 加密系统的核心。通过这个练习，你将亲身体验一个公开函数如何做到易于计算但难以求逆，以及一个秘密的“陷门”信息如何让指定接收方能够轻易地完成求逆操作。[@problem_id:1467639]", "problem": "在公钥密码学的研究中，陷门单向函数的概念是基础。如果一个函数对于任何给定的输入都易于计算，但从给定的输出反向计算输入在计算上是不可行的，则该函数被认为是**单向的**。**陷门单向函数**是一种特殊的单向函数，其中，当且仅当拥有被称为陷门的特定秘密信息时，其反向计算才变得容易。\n\n考虑一个阶为大素数 $q$ 的有限循环群 $G$，其生成元 $g$ 已知。群运算用 $\\cdot$ 表示。设 $h$ 是 $G$ 中的一个公开元素，其构造方式为 $h=g^x$，其中 $x \\in \\{1, 2, \\ldots, q-1\\}$ 是一个秘密整数。你可以假设在 $G$ 中解决离散对数问题 (DLP)——即在给定 $g$ 和 $h$ 的情况下找到 $x$——在计算上是不可行的。\n\n现在，分析由以下公式定义的函数 $f: G \\times \\mathbb{Z}_q \\to G \\times G$：\n$f(m, r) = (g^r, m \\cdot h^r)$\n其中 $m \\in G$ 是消息， $r \\in \\mathbb{Z}_q$ 是一个随机选择的整数。授权接收者知道秘密，其主要目标是在收到输出 $(c_1, c_2) = f(m, r)$ 后，恢复原始消息 $m$。\n\n在离散对数问题是困难的假设下，以下哪个陈述最准确地描述了函数 $f(m, r)$ 的性质？\n\nA. 该函数是一个陷门单向函数，陷门是秘密指数 $x$。\n\nB. 该函数是一个陷门单向函数，陷门是随机整数 $r$。\n\nC. 该函数是一个陷门单向函数，陷门是消息 $m$。\n\nD. 该函数是一个单向函数，但没有陷门。\n\nE. 该函数不是一个单向函数，因为任何一方都可以轻易地将其反转。", "solution": "我们在一个阶为素数 $q$、生成元为 $g$ 的有限循环群 $G$ 中进行操作。公钥是 $h=g^{x}$，其中 $x \\in \\{1,2,\\ldots,q-1\\}$ 是秘密。函数为 $f(m,r)=(c_{1},c_{2})=(g^{r}, m \\cdot h^{r})$，其中 $m \\in G$ 且 $r \\in \\mathbb{Z}_{q}$。\n\n首先，展示知道 $x$ 的授权接收者如何从 $(c_{1},c_{2})$ 恢复 $m$。使用定义 $c_{1}=g^{r}$ 和陷门 $x$，计算\n$$\ns=c_{1}^{x}=(g^{r})^{x}=g^{rx}=h^{r}.\n$$\n这利用了群 $G$ 中的标准求幂运算以及关系 $h=g^{x}$。然后通过乘以 $s^{-1}=(h^{r})^{-1}$ 来反转 $c_{2}=m \\cdot h^{r}$：\n$$\nm=c_{2}\\cdot s^{-1}=m \\cdot h^{r} \\cdot (h^{r})^{-1}=m.\n$$\n因此，给定 $x$，从 $(c_{1},c_{2})$ 恢复 $m$ 是高效的，这证实了存在使用陷门 $x$ 的高效反转算法。\n\n接下来，论证在所述的困难性假设下，没有 $x$ 的情况下反转是不可行的。从 $(c_{1},c_{2})$ 中，要获得 $m$ 需要 $h^{r}$。有两条自然的途径：\n1. 从 $c_{1}=g^{r}$ 恢复 $r$，然后计算 $h^{r}$；但找到 $r$ 正是群 $G$ 中的离散对数问题，该问题被假设为困难的。\n2. 通过计算 $g^{xr}$ 直接从 $(g^{x},g^{r})$ 计算出 $h^{r}$；这是计算性 Diffie–Hellman 问题。虽然问题陈述只假设了 DLP 的困难性，但任何通过为任意 $(c_{1},c_{2})$ 输出 $m$ 来反转 $f$ 的算法，尤其是在 $m$ 对攻击者未知的情况下，将允许恢复 $m$，这需要从 $(g^{x},g^{r})$ 计算 $h^{r}$；在没有陷门 $x$ 的情况下，这被认为是不可行的。\n\n因此，在 DLP 困难性假设下，对于缺少 $x$ 的各方，$f$ 是单向的，而拥有 $x$ 的一方可以高效地反转以恢复 $m$。随机数 $r$ 是临时的，不是一个能够对所有输出进行反转的固定秘密；消息 $m$ 本身不是陷门；该函数也不易被任意方反转。\n\n因此，正确的描述是 $f$ 是一个以 $x$ 为陷门的陷门单向函数。", "answer": "$$\\boxed{A}$$", "id": "1467639"}, {"introduction": "在理解了具体的陷门函数构造后，我们来探讨其“计算上不可行”这一性质的深刻含义。这个思想实验将我们带到计算可行性的边界，通过设想我们拥有一个能解决著名的布尔可满足性问题（SAT）的强大“预言机”，来量化破解陷门函数的难度。这个练习将陷门函数的安全性与计算复杂性理论中的基本概念直接联系起来。[@problem_id:1467625]", "problem": "一位密码学家正在分析一种新提出的公钥密码方案。该方案的安全性依赖于一个陷门单向置换族。该置换族由一个生成算法 `Gen` 定义，当输入安全参数 `n` 时，它会输出一对密钥 `(pk, sk)`。公钥 `pk` 定义了一个置换 `f_{pk}: \\{0,1\\}^{n} \\to \\{0,1\\}^{n}`，而私钥 `sk` 则是允许高效求逆 `f_{pk}` 的陷门。\n\n公钥 `pk` 包含一个布尔电路 `C_{pk}` 的完整描述，该电路计算函数 `f_{pk}`。电路 `C_{pk}` 接受一个 `n` 比特的输入并产生一个 `n` 比特的输出。电路的大小，记为 `s(n)`，定义为其包含的逻辑门（例如，AND、OR、NOT）的总数。\n\n一个敌手截获了一个值 `y \\in \\{0,1\\}^{n}`，并且可以访问公钥 `pk`，但无法访问私钥 `sk`。敌手的目标是找到唯一的原像 `x \\in \\{0,1\\}^{n}`，使得 `f_{pk}(x) = y`。\n\n该敌手获得了一个强大的计算预言机 `O_SAT` 的访问权限。这个预言机解决布尔可满足性问题（SAT）。当给定一个用变量 `v_1, v_2, ...` 表示的布尔公式时，如果存在一组对变量的 `TRUE`/`FALSE` 赋值能使整个公式为 `TRUE`，则预言机返回 `TRUE`，否则返回 `FALSE`。关键在于，如果公式是可满足的，预言机还会为所有变量提供一个这样的可满足赋值。\n\n为了找到原像 `x`，敌手计划构造一个单一的布尔公式 `\\Phi`，并只查询 `O_SAT` 预言机一次。`\\Phi` 的变量将代表未知输入 `x` 的比特位以及电路 `C_{pk}` 内部线路上的逻辑值。对于这个公式 `\\Phi`，所需的布尔变量的最小总数是多少，表示为 `n` 和 `s(n)` 的函数？", "solution": "我们需要一个单一的 SAT 实例来捕捉以下约束：大小为 $s(n)$ 的电路 $C_{pk}$ 将一个未知输入 $x \\in \\{0,1\\}^{n}$ 映射到给定的输出 $y \\in \\{0,1\\}^{n}$。变量必须编码：\n- $x$ 的 $n$ 个未知输入比特，以及\n- $C_{pk}$ 内部线路所承载的逻辑值。\n\n使用标准的电路到SAT（Tseitin风格）编码：\n1) 为主输入引入 $n$ 个变量 $x_{1},\\dots,x_{n}$。\n2) 对于 $C_{pk}$ 中的 $s(n)$ 个门 $g_{1},\\dots,g_{s(n)}$ 中的每一个，引入一个变量 $z_{j}$ 来表示门 $g_{j}$ 的输出线（逻辑值）。通过将 $z_{j}$ 与其门的输入文字相关联的子句来强制执行每个门的功能。除了每个门的一个输出变量外，这不会引入额外的变量。\n3) 对于每个电路输出比特，约束相应的线路变量等于 $y$ 的已知比特。这通过单位子句（例如，$z_{o(i)}$ 或 $\\lnot z_{o(i)}$）来完成，因此不使用新的变量。\n\n因此，公式中布尔变量的总数恰好是主输入变量的数量加上每个门输出的一个变量：\n$$\nn + s(n).\n$$\n\n最小性：根据问题的规定，$\\Phi$ 的变量“代表未知输入 $x$ 的比特位以及电路 $C_{pk}$ 内部线路上的逻辑值”。有 $n$ 个输入比特和恰好 $s(n)$ 个不同的内部门输出信号，它们的逻辑值必须被表示，因此至少需要 $n + s(n)$ 个变量。此外，等于 $y$ 的输出可以通过单位子句来强制执行，而无需创建额外的变量。因此，所需的变量最小总数为 $n + s(n)$。", "answer": "$$\\boxed{n+s(n)}$$", "id": "1467625"}, {"introduction": "最后，我们将探索如何利用陷门函数的基本组件来构建更复杂的密码学工具。本练习介绍了一个精妙的概念——“有损”函数，它拥有两种在计算上无法区分的操作模式。通过分析函数在每种模式下像空间的大小，你将揭示其背后微妙的数学技巧，并理解这一技巧如何提供强大的密码学性质。[@problem_id:1467641]", "problem": "在现代密码学的研究中，有损函数（lossy function）是一种函数族，它可以通过两种计算上不可区分的模式之一来生成：一种是正常模式，其中函数按预期运行（例如，是单射的或具有大像集）；另一种是“有损”模式，其中函数的像集要小得多。\n\n考虑一个大素数阶 $q$ 的循环群 $G$。设 $n$ 是一个整数参数，满足 $n \\ge 2$。公钥，记为 $\\text{PK}$，被构造为一对向量 $(\\mathbf{u}, \\mathbf{v})$，其中 $\\mathbf{u} = (u_1, \\dots, u_n)$ 和 $\\mathbf{v} = (v_1, \\dots, v_n)$ 是来自 $G$ 中元素的向量。\n\n公钥 $\\text{PK}$ 通过以下两种模式之一生成，使用一个固定的、公开已知的生成元 $g \\in G$：\n\n1.  **正常模式：** 从 $(\\mathbb{Z}_q^*)^n$ 中随机选择两个指数向量 $\\mathbf{\\alpha} = (\\alpha_1, \\dots, \\alpha_n)$ 和 $\\mathbf{\\beta} = (\\beta_1, \\dots, \\beta_n)$，并满足它们在有限域 $\\mathbb{Z}_q$ 上线性无关的条件。然后，公钥元素计算为 $u_i = g^{\\alpha_i}$ 和 $v_i = g^{\\beta_i}$，其中 $i=1, \\dots, n$。\n\n2.  **有损模式：** 从 $(\\mathbb{Z}_q^*)^n$ 中随机选择一个指数向量 $\\mathbf{\\alpha} = (\\alpha_1, \\dots, \\alpha_n)$，并从 $\\mathbb{Z}_q^*$ 中随机选择一个标量 $s$。然后，公钥元素计算为 $u_i = g^{\\alpha_i}$ 和 $v_i = (g^{\\alpha_i})^s = g^{s\\alpha_i}$，其中 $i=1, \\dots, n$。\n\n对于任何给定的公钥 $\\text{PK} = (\\mathbf{u}, \\mathbf{v})$，我们定义一个函数 $F_{\\text{PK}}$，它从定义域 $\\mathbb{Z}_q^n$ 映射到陪域 $G \\times G$。该函数定义如下：\n$$F_{\\text{PK}}(\\mathbf{x}) = \\left( \\prod_{i=1}^n u_i^{x_i}, \\prod_{i=1}^n v_i^{x_i} \\right)$$\n其中 $\\mathbf{x} = (x_1, \\dots, x_n) \\in \\mathbb{Z}_q^n$。\n\n令 $S_N$ 为公钥 $\\text{PK}$ 在正常模式下生成时函数 $F_{\\text{PK}}$ 的像集的大小（基数）。令 $S_L$ 为公钥在有损模式下生成时 $F_{\\text{PK}}$ 的像集的大小。\n\n确定比值 $S_N / S_L$ 的值。你的答案应该是一个用给定参数表示的表达式。", "solution": "设 $G$ 是素数阶 $q$ 的循环群，生成元为 $g$。由 $\\varphi(y)=g^{y}$ 给出的映射 $\\varphi \\colon \\mathbb{Z}_{q}\\to G$ 是一个双射，因为 $g$ 生成 $G$ 且 $|G|=q$。因此，对于任何公钥 $\\text{PK}=(\\mathbf{u},\\mathbf{v})$，其中 $u_{i}=g^{\\alpha_{i}}$ 和 $v_{i}=g^{\\beta_{i}}$，函数\n$$\nF_{\\text{PK}}(\\mathbf{x})=\\left(\\prod_{i=1}^{n}u_{i}^{x_{i}},\\prod_{i=1}^{n}v_{i}^{x_{i}}\\right)=\\left(g^{\\sum_{i=1}^{n}\\alpha_{i}x_{i}},g^{\\sum_{i=1}^{n}\\beta_{i}x_{i}}\\right)\n$$\n的像集与 $\\mathbb{Z}_{q}$ 上的线性映射\n$$\nL \\colon \\mathbb{Z}_{q}^{n}\\to\\mathbb{Z}_{q}^{2},\\quad \\mathbf{x}\\mapsto\\left(\\langle\\boldsymbol{\\alpha},\\mathbf{x}\\rangle,\\langle\\boldsymbol{\\beta},\\mathbf{x}\\rangle\\right),\n$$\n的像集具有相同的基数，其中 $\\langle\\boldsymbol{\\alpha},\\mathbf{x}\\rangle=\\sum_{i=1}^{n}\\alpha_{i}x_{i}$ 且 $\\langle\\boldsymbol{\\beta},\\mathbf{x}\\rangle=\\sum_{i=1}^{n}\\beta_{i}x_{i}$。$L$ 的像集的大小是 $q^{r}$，其中 $r$ 是 $L$ 的秩（因为 $\\mathbb{Z}_{q}$ 是一个域，且像集是 $\\mathbb{Z}_{q}^{2}$ 的一个子空间）。\n\n在正常模式下，$\\boldsymbol{\\alpha},\\boldsymbol{\\beta}\\in(\\mathbb{Z}_{q}^{*})^{n}$ 在 $\\mathbb{Z}_{q}$ 上是线性无关的，所以行向量为 $\\boldsymbol{\\alpha}^{\\top}$ 和 $\\boldsymbol{\\beta}^{\\top}$ 的 $2\\times n$ 矩阵的秩为 $2$。因此，\n$$\nS_{N}=q^{2}.\n$$\n\n在有损模式下，$\\boldsymbol{\\beta}=s\\boldsymbol{\\alpha}$，其中 $s\\in\\mathbb{Z}_{q}^{*}$，所以这两个行向量是线性相关的，秩为 $1$（因为 $\\boldsymbol{\\alpha}\\neq\\mathbf{0}$，由于每个 $\\alpha_{i}\\in\\mathbb{Z}_{q}^{*}$）。因此，\n$$\nS_{L}=q.\n$$\n\n因此，比值为\n$$\n\\frac{S_{N}}{S_{L}}=\\frac{q^{2}}{q}=q.\n$$", "answer": "$$\\boxed{q}$$", "id": "1467641"}]}