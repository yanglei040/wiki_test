{"hands_on_practices": [{"introduction": "要确立一个问题的计算硬度，一种常用技术是把一个已知的难题归约到它。本练习将演示一个基础的归约，其目标是“正交向量”（Orthogonal Vectors, OV）问题，该问题的硬度由“强指数时间假设”（Strong Exponential Time Hypothesis, SETH）所预测。通过将一个寻找不相交基因集的生物信息学问题建模为OV问题实例，你将练习把一个问题的结构转化为另一个问题的核心技能。[@problem_id:1424387]", "problem": "在生物信息学领域，一个常见的任务是分析不同生物样本（例如，细胞类型、组织样本）之间的关系。一位研究人员正在研究 $n$ 个不同样本的集合。对于每个样本，他们从一个包含 $d$ 个可能基因的大通用集 $U = \\{g_1, g_2, \\dots, g_d\\}$ 中，确定了“活跃”的基因集。设样本 $i$ 的活跃基因集为 $S_i \\subseteq U$。研究人员假设每个样本至少有一个活跃基因，即对于所有的 $i=1, \\dots, n$，$S_i$ 都是非空的。\n\n研究人员感兴趣的是，是否存在任何一对样本 $(i, j)$（其中 $i \\neq j$）是“遗传不相容”的，这意味着它们的活跃基因集是不相交的（$S_i \\cap S_j = \\emptyset$）。为了高效地解决这个问题，他们决定将其建模为一个正交向量（Orthogonal Vectors, OV）问题的实例，这是一个有专门算法的著名计算问题。\n\n正交向量（OV）问题定义如下：给定两个向量集 $A = \\{a_1, \\dots, a_m\\}$ 和 $B = \\{b_1, \\dots, b_p\\}$，其中每个向量都在 $\\{0, 1\\}^d$ 中，确定是否存在索引 $i$ 和 $j$，使得点积 $a_i \\cdot b_j = 0$。点积是在整数上计算的，即 $a_i \\cdot b_j = \\sum_{k=1}^d a_{ik} b_{jk}$。\n\n以下哪个程序描述了将寻找遗传不相容样本对的问题正确且完整地规约到正交向量问题的过程？\n\nA. 对于每个集合 $S_i$，构造一个向量 $v_i \\in \\{0, 1\\}^d$，其中如果基因 $g_k \\in S_i$，则第 $k$ 个分量为 1，否则为 0。将 OV 问题的两个输入集都设置为这个向量集合，即 $A=B=\\{v_1, \\dots, v_n\\}$。OV 问题的“是”答案意味着存在一对遗传不相容的样本。\n\nB. 对于每个集合 $S_i$，构造一个向量 $v_i \\in \\{0, 1\\}^d$，其中如果基因 $g_k \\in S_i$，则第 $k$ 个分量为 0，否则为 1。将 OV 问题的两个输入集都设置为这个集合，即 $A=B=\\{v_1, \\dots, v_n\\}$。\n\nC. 假设 $n$ 是偶数。将样本分为两组：$G_1 = \\{S_1, \\dots, S_{n/2}\\}$ 和 $G_2 = \\{S_{n/2+1}, \\dots, S_n\\}$。对于每个集合 $S_i$，构造其特征向量 $v_i$（其中如果 $g_k \\in S_i$，则第 $k$ 个分量为 1，否则为 0）。将 OV 问题的输入设置为 $A=\\{v_1, \\dots, v_{n/2}\\}$ 和 $B=\\{v_{n/2+1}, \\dots, v_n\\}$。\n\nD. 对于每个基因 $g_k \\in U$，构造一个向量 $u_k \\in \\{0, 1\\}^n$，其中如果基因 $g_k$ 在集合 $S_i$ 中，则第 $i$ 个分量为 1，否则为 0。这将创建 $d$ 个维度为 $n$ 的向量。将 OV 问题的两个输入集都设置为这个集合，即 $A=B=\\{u_1, \\dots, u_d\\}$。", "solution": "我们给定 $n$ 个非空集合 $S_{1},\\dots,S_{n} \\subseteq U=\\{g_{1},\\dots,g_{d}\\}$，希望确定是否存在 $i \\neq j$ 使得 $S_{i} \\cap S_{j} = \\emptyset$。正交向量（OV）问题接受两个集合 $A,B \\subseteq \\{0,1\\}^{d}$，并询问是否存在 $a \\in A$ 和 $b \\in B$ 使得 $a \\cdot b = 0$，其中 $a \\cdot b = \\sum_{k=1}^{d} a_{k} b_{k}$。\n\n要将不相交查询规约到 OV 问题，考虑特征向量映射：对于每个 $S_{i}$，定义 $v_{i} \\in \\{0,1\\}^{d}$，其中若 $g_{k} \\in S_{i}$ 则 $v_{i,k} = 1$，否则 $v_{i,k} = 0$。那么对于任何 $i,j$：\n$$\nv_{i} \\cdot v_{j} \\;=\\; \\sum_{k=1}^{d} \\mathbf{1}[g_{k} \\in S_{i}] \\,\\mathbf{1}[g_{k} \\in S_{j}] \\;=\\; |S_{i} \\cap S_{j}|.\n$$\n因此，\n$$\nS_{i} \\cap S_{j} = \\emptyset \\quad \\Longleftrightarrow \\quad v_{i} \\cdot v_{j} = 0.\n$$\n如果我们设置 $A=B=\\{v_{1},\\dots,v_{n}\\}$，任何 OV 的“是”实例都会展示出满足 $v_{i} \\cdot v_{j} = 0$ 的 $i,j$，根据等价关系，这得出 $S_{i} \\cap S_{j} = \\emptyset$。$i=j$ 的可能性不会导致假阳性，因为 $S_{i} \\neq \\emptyset$ 意味着 $v_{i} \\cdot v_{i} = |S_{i}| \\geq 1$，因此 $v_{i} \\cdot v_{i} \\neq 0$。反之，如果存在 $i \\neq j$ 使得 $S_{i} \\cap S_{j} = \\emptyset$，那么 $v_{i} \\cdot v_{j} = 0$，并且在 $A=B$ 上的 OV 实例会回答“是”。这确立了程序 A 的可靠性与完备性。\n\n现在评估其他选项：\n\n对于 B，该构造使用补集指示符：若 $g_{k} \\in S_{i}$ 则 $v_{i,k}=0$，否则 $v_{i,k}=1$。那么\n$$\nv_{i} \\cdot v_{j} \\;=\\; \\sum_{k=1}^{d} \\mathbf{1}[g_{k} \\notin S_{i}] \\,\\mathbf{1}[g_{k} \\notin S_{j}] \\;=\\; |U \\setminus (S_{i} \\cup S_{j})|.\n$$\n因此，$v_{i} \\cdot v_{j} = 0$ 当且仅当 $S_{i} \\cup S_{j} = U$，这不等价于 $S_{i} \\cap S_{j} = \\emptyset$。因此 B 是不正确的。\n\n对于 C，将样本任意分成两半，并将 $A$ 设置为第一半，$B$ 设置为第二半，这只能检测跨组的不相交对。如果一对不相交的样本完全位于其中一半，它将被错过。因此 C 是不完备的。\n\n对于 D，构造以基因为索引的向量 $u_{k} \\in \\{0,1\\}^{n}$，其点积 $u_{k} \\cdot u_{\\ell}$ 等于基因 $g_{k}$ 和 $g_{\\ell}$ 同时活跃的样本数量。那么，正交性涉及的是在任何样本中都从未共同活跃的基因对，这不能回答是否存在两个具有不相交活跃基因集的样本。因此 D 没有规约到预期的问题。\n\n因此，只有程序 A 正确且完整地将遗传不相容对问题规约到 OV 问题。", "answer": "$$\\boxed{A}$$", "id": "1424387"}, {"introduction": "3SUM假设为证明许多问题的二次时间下界提供了基础，即使这些问题的结构并未直接暗示三个数求和。本练习挑战你通过将3SUM问题归约到寻找一个包含三个元素的等差数列，来揭示这种隐藏的硬度。这个练习将磨练你使用代数变换来构造非显而易见的归约的能力。[@problem_id:1424351]", "problem": "在计算复杂性理论中，3SUM 问题是一类计算几何及其他领域问题中的一个基础性难题。细粒度复杂性旨在理解此类问题的精确多项式时间复杂度。\n\n**3SUM 问题**定义如下：给定一个包含 $n$ 个整数的集合 $S$，判断是否存在三个元素 $x, y, z \\in S$ 使得 $x+y+z=0$。被广泛相信的 **3SUM 猜想**指出，任何解决 3SUM 问题的算法在最坏情况下都需要 $\\Omega(n^2)$ 的时间。这个猜想通常被扩展到 **3-列表 3SUM 变体**：给定三个大小均为 $n$ 的整数集合 $X, Y, Z$，判断是否存在元素 $x \\in X, y \\in Y, z \\in Z$ 使得 $x+y+z=0$。这个变体也被推测需要 $\\Omega(n^2)$ 的时间。\n\n考虑一个相关问题，我们称之为**等差数列-3 (AP3) 问题**：给定一个包含 $m$ 个整数的集合 $A$，判断是否存在三个*不同*的元素 $a, b, c \\in A$ 构成一个等差数列。三个数构成等差数列的条件是，当它们排序后，中间项是另外两项的平均值。这等价于检查是否存在这三个不同元素 $(a, b, c)$ 的一个排列 $(p, q, r)$，使得 $p+r=2q$。\n\n假设 3-列表 3SUM 猜想为真，那么在大小为 $m$ 的集合上解决 AP3 问题的最紧可能的最坏情况时间复杂度下界是多少？\n\nA. $\\Omega(m \\log m)$\nB. $\\Omega(m^{1.5})$\nC. $\\Omega(m^2)$\nD. $\\Omega(m^2 \\log m)$\nE. 该问题可在多项式时间内解决，但 3SUM 猜想并不意味着一个二次方的下界。", "solution": "我们将 3-列表 3SUM 归约到 AP3，其输入规模仅有线性增长，且开销为常数因子，这意味着在 3-列表 3SUM 猜想下，所声称的下界成立。\n\n从 3-列表 3SUM 的一个任意实例开始：三个大小均为 $n$ 的整数集合 $X, Y, Z$，问题是是否存在 $x \\in X, y \\in Y, z \\in Z$ 使得 $x + y + z = 0$。\n\n我们在线性时间内构造一个 AP3 的实例，该实例作用于单个集合 $A$ 上，其大小 $m = \\Theta(n)$，使得 $A$ 包含一个三项等差数列当且仅当原始的 3-列表 3SUM 实例是一个是-实例。引入一个符号参数 $T$，其绝对值大于任何输入值的固定的有限线性组合（因为输入是有限的，所以这样的选择是存在的）。定义三个不相交的“层”：\n$$\nB_{0} := \\{\\, 2x : x \\in X \\,\\}, \\quad B_{1} := \\{\\, 2T - y : y \\in Y \\,\\}, \\quad B_{2} := \\{\\, 4T + 2z : z \\in Z \\,\\},\n$$\n并设：\n$$\nA := B_{0} \\cup B_{1} \\cup B_{2}.\n$$\n这个构造是线性时间的，且 $|A| = |B_{0}| + |B_{1}| + |B_{2}| = 3n = \\Theta(n)$，因此 $m = \\Theta(n)$。\n\n完备性：如果存在一个解 $(x,y,z)$ 满足 $x + y + z = 0$，选择 $a = 2x \\in B_{0}$，$b = 2T - y \\in B_{1}$，$c = 4T + 2z \\in B_{2}$。那么\n$$\na + c = 2x + (4T + 2z) = 4T + 2(x + z) = 4T - 2y = 2(2T - y) = 2b,\n$$\n所以 $(a,b,c)$ 在 $A$ 中构成一个三项等差数列。\n\n可靠性与层的分离：因为 $B_{0}$ 中元素的量级是 $\\Theta(1)$，$B_{1}$ 中元素的量级以 $2T$ 为中心，$B_{2}$ 中元素的量级以 $4T$ 为中心，并且 $T$ 被选择为远大于任何输入值的固定线性组合，所以任何混合了不同层元素的等差数列，其最小元素必然来自 $B_{0}$，中间元素来自 $B_{1}$，最大元素来自 $B_{2}$。此外，对于这样一个三元组 $(a,b,c) \\in B_{0} \\times B_{1} \\times B_{2}$，等差数列的条件迫使：\n$$\na + c = 2b \\;\\;\\Longleftrightarrow\\;\\; 2x + (4T + 2z) = 2(2T - y) \\;\\;\\Longleftrightarrow\\;\\; x + y + z = 0.\n$$\n因此，$A$ 包含一个跨层的三项等差数列当且仅当原始的 3-列表 3SUM 实例是一个是-实例。\n\n这个归约是线性的时间和线性的规模。因此，如果 $m$ 个数上的 AP3 问题可以在 $o(m^{2})$ 时间内解决，那么我们就可以在 $o(n^{2})$ 时间内解决 $n = \\Theta(m)$ 个输入上的 3-列表 3SUM 问题，这与 3-列表 3SUM 猜想相矛盾。由于该猜想断言了一个二次方的下界（没有任何超线性的对数因子），因此可推导出的最紧下界是 $\\Omega(m^{2})$。\n\n在给出的选项中，这对应于选项 C。", "answer": "$$\\boxed{C}$$", "id": "1424351"}, {"introduction": "细粒度复杂性中的假设非常强大，但理解其确切的适用范围至关重要。本练习探讨了为何著名的“所有结点对最短路径”（All-Pairs Shortest Path, APSP）问题的立方时间硬度猜想不适用于无权图。通过分析这个特例，你将发现图路径查找与快速矩阵乘法之间的联系，这是一种完全不同的、能绕过猜想壁垒的算法方法。[@problem_id:1424347]", "problem": "在计算复杂性理论中，所有节点对最短路径（All-Pairs Shortest Path, APSP）问题要求计算给定图中每对顶点之间的最短路径距离。细粒度复杂性理论中的一个主要开放问题是，用于解决 APSP 问题的标准立方时间算法（例如 Floyd-Warshall 算法）是否是最优的。APSP 假说推测，对于一个拥有 $n$ 个顶点和任意实数边权重的有向图，任何解决 APSP 问题的算法都需要 $\\Omega(n^{3-\\delta})$ 的时间（对于任意 $\\delta  0$），这意味着不存在真正亚立方时间（例如 $O(n^{2.99})$）的算法。\n\n然而，这个条件性下界不适用于*无权*有向图的特殊情况。对于这种特殊情况，存在着可以被证明在真正亚立方时间内运行的算法。以下哪个陈述为这一事实提供了最准确和最根本的原因？\n\nA. 该问题可以通过从每个顶点运行广度优先搜索（BFS）来解决。由于 BFS 是一个线性时间算法，总时间显著小于立方级别。\nB. 在无权图中寻找最短路径的问题可以规约到一系列矩阵乘法，而这些矩阵乘法可以使用高级算法在真正亚立方时间内解决。\nC. 对于无权图，APSP 问题等价于寻找连通分量，而后者几乎可以在线性时间内解决。\nD. APSP 假说仅适用于包含负权重环的图，而这种情况在无权图中是不可能的。\nE. 所有无权有向图也都是有向无环图（DAG），而在 DAG 上可以更有效地解决 APSP 问题。", "solution": "这个问题的核心是理解在加权图与无权图上解决所有节点对最短路径（APSP）问题之间的算法差异。标准的 APSP 假说提出了一个接近立方时间的时间下界，其基础是处理任意实数值权重的困难性。我们需要找到无权图的哪个特定属性使得这个立方时间壁垒可以被打破。\n\n让我们分析一个有 $n$ 个顶点的无权有向图的问题。两个顶点（比如 $u$ 和 $v$）之间的最短路径就是从 $u$ 到 $v$ 的一条路径上的最小边数。\n\n关键的洞见在于通过线性代数的视角来看待图的可达性。设 $A$ 为图的邻接矩阵，其中如果从顶点 $i$ 到顶点 $j$ 有一条边，则 $A_{ij} = 1$，否则 $A_{ij} = 0$。为了寻找最短路径，我们还设定对所有 $i$ 都有 $A_{ii} = 1$，这表示一个顶点到其自身的长度为 0 的路径。\n\n现在，考虑使用标准矩阵乘法计算的矩阵乘积 $A^2 = A \\times A$。一个元素 $(A^2)_{ij}$ 由 $\\sum_{k=1}^n A_{ik} A_{kj}$ 给出。这个和大于零当且仅当存在至少一个顶点 $k$，使得有一条从 $i$ 到 $k$ 的边和一条从 $k$ 到 $j$ 的边。这对应于一条从 $i$ 到 $j$ 的长度为 2 的路径。更一般地，矩阵 $A^k$ 中的元素 $(A^k)_{ij}$ 非零，当且仅当存在一条从顶点 $i$ 到顶点 $j$ 的长度至多为 $k$ 的路径。（如果我们使用布尔矩阵乘法，这是成立的；如果使用标准整数乘法，它计算的是此类路径的数量）。\n\n因此，从 $i$ 到 $j$ 的最短路径距离，记作 $d(i, j)$，是使得 $(A^k)_{ij}  0$ 的最小整数 $k$。由于图中任何简单路径的长度最多为 $n-1$，我们只需要检查 $A$ 的幂次直到 $A^{n-1}$。\n\n一种朴素的方法是通过重复乘以 $A$ 来计算 $A^2, A^3, \\dots, A^{n-1}$。这将需要大约 $n-2$ 次矩阵乘法。然而，使用重复平方技术可以使效率大大提高。我们可以计算矩阵序列 $A^2, A^4, A^8, \\dots, A^{2^{\\lceil \\log_2 n \\rceil}}$。这只需要 $O(\\log n)$ 次矩阵乘法。通过组合这些矩阵的幂，我们可以确定最短路径距离。例如，长度最多为 $k$ 的路径矩阵可以通过组合 $A$ 的适当幂次（这些幂次的指数在二进制表示下和为 $k$）来形成。一种更复杂的方法（Zwick 算法）利用这些矩阵乘法的思想来解决 APSP 问题。\n\n关键点在于矩阵乘法的复杂性。虽然标准的（高中）算法需要 $O(n^3)$ 时间来乘以两个 $n \\times n$ 矩阵，但存在更快的先进算法。第一个这样的算法是 Strassen 算法，其复杂度约为 $O(n^{2.81})$。目前矩阵乘法指数（记为 $\\omega$）的记录约为 $\\omega \\approx 2.37286$。\n\n因此，在无权图上解决 APSP 问题可以在 $O(n^\\omega \\log n)$ 时间内完成。由于 $\\omega  3$，这个复杂度是真正的亚立方级别。例如，使用 Strassen 算法，运行时间为 $O(n^{2.81} \\log n)$，这比 $O(n^3)$ 更快。这打破了立方时间的壁垒，并解释了为什么为一般加权图制定的 APSP 假说不适用于无权图的情况。\n\n现在让我们评估给出的选项：\n\nA. 从每个顶点运行 BFS 是一个有效的算法。单次 BFS 需要 $O(V+E) = O(n+m)$ 的时间，其中 $m$ 是边的数量。对所有 $n$ 个顶点重复此操作，总复杂度为 $O(n(n+m))$。对于稠密图，其中 $m = O(n^2)$，复杂度变为 $O(n^3)$，这不是一个真正的亚立方算法。对于稀疏图，它可能更好（例如，如果 $m=O(n)$，则为 $O(n^2)$），但它并未为所有无权图（特别是稠密图）提供一个亚立方算法。所以这不是对一个普遍的亚立方级别突破的最佳解释。\n\nB. 这个陈述正确地指出了，该问题可以规约到快速矩阵乘法是存在真正亚立方算法的根本原因。如上所述，这种方法产生的时间复杂度为 $O(n^\\omega \\log n)$，这对于稠密图也是亚立方级别的。\n\nC. 这是不正确的。APSP 是关于找到所有节点对之间的距离，而不仅仅是确定它们是否在同一个连通分量中。寻找连通分量是一个简单得多的问题。\n\nD. 这是不正确的。APSP 假说通常是针对一般实数值权重陈述的，并不要求存在负权重环。主要的挑战来自于处理路径权重的加法结构，而用于无权图的矩阵乘法技巧绕过了这个问题。在一般情况下，对于只有非负权重的图上的问题，仍然被认为需要接近立方的时间。\n\nE. 这是不正确的。一个无权有向图可以有环。一条从 $i$ 到 $j$ 的简单有向边和另一条从 $j$ 到 $i$ 的边就形成了一个长度为 2 的环。只有当图是 DAG 时，我们才能使用拓扑排序在 $O(n(n+m))$ 时间内解决 APSP，但仅仅无权这个属性并不能保证图是 DAG。\n\n因此，最准确和最根本的原因是规约到快速矩阵乘法。", "answer": "$$\\boxed{B}$$", "id": "1424347"}]}