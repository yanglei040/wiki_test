{"hands_on_practices": [{"introduction": "理解像积和式（permanent）这样的新数学对象的最佳方式，是先从一个简单而基础的例子入手。本练习将单位矩阵的积和式与二分图中的唯一完美匹配联系起来，为积和式作为一种计数工具提供了具体的直观感受。通过解决这个问题 [@problem_id:1469066]，你将直接看到积和式的定义如何在一个清晰的图论背景下运作。", "problem": "在计算复杂性理论中，矩阵的积和式（permanent）扮演着至关重要的角色。虽然其定义与行列式（determinant）相似，但其计算已知要困难得多。对于一个 $n \\times n$ 矩阵 $A$，其积和式定义为：\n$$ \\text{perm}(A) = \\sum_{\\sigma \\in S_n} \\prod_{i=1}^n A_{i, \\sigma(i)} $$\n其中 $S_n$ 是数字 $\\{1, 2, \\dots, n\\}$ 的所有置换的集合。\n\n积和式在图论中有一个自然的解释。给定一个二分图 $G = (U \\cup V, E)$，其划分 $U=\\{u_1, \\dots, u_n\\}$ 和 $V=\\{v_1, \\dots, v_n\\}$ 大小相等，我们可以定义其 $n \\times n$ 的双邻接矩阵 $A$，其中如果 $u_i$ 和 $v_j$ 之间存在一条边，则 $A_{ij}=1$，否则 $A_{ij}=0$。$\\text{perm}(A)$ 的值等于图 $G$ 中完美匹配的数量。完美匹配是一个包含 $n$ 条边的集合，其中任意两条边都不共享一个公共顶点。\n\n考虑一个特殊情况，即二分图的双邻接矩阵是 $n \\times n$ 的单位矩阵 $I_n$。$I_n$ 的积和式的值是多少？图中完美匹配的结构又是什么？\n\nA. 值：$n!$；结构：一个完全匹配，其中一个划分中的每个顶点都与另一个划分中的每个顶点相连。\n\nB. 值：1；结构：一个单一、唯一的完美匹配，其中每个顶点 $u_i$ 仅与顶点 $v_i$ 匹配。\n\nC. 值：0；结构：不存在完美匹配。\n\nD. 值：$n$；结构：$n$ 个不同的完美匹配，每个匹配由一条孤立的单一边组成。\n\nE. 值：1；结构：一个形成穿过所有 $2n$ 个顶点的环的完美匹配。", "solution": "从积和式的定义开始。对于一个 $n \\times n$ 的矩阵 $A$，其积和式为\n$$\n\\operatorname{perm}(A)=\\sum_{\\sigma \\in S_{n}} \\prod_{i=1}^{n} A_{i,\\sigma(i)}.\n$$\n对于单位矩阵 $I_{n}$，其每个元素为 $A_{ij}=\\delta_{ij}$，其中 $\\delta_{ij}$ 是克罗内克δ函数（Kronecker delta）。代入 $A_{ij}=\\delta_{ij}$ 可得\n$$\n\\operatorname{perm}(I_{n})=\\sum_{\\sigma \\in S_{n}} \\prod_{i=1}^{n} \\delta_{i,\\sigma(i)}.\n$$\n对于任意置换 $\\sigma \\in S_{n}$，当且仅当对于所有 $i$ 都有 $\\sigma(i)=i$ 时（即 $\\sigma$ 是恒等置换），乘积 $\\prod_{i=1}^{n} \\delta_{i,\\sigma(i)}$ 等于 $1$；否则，存在某个 $i$ 使得 $\\sigma(i)\\neq i$，导致至少有一个因子 $\\delta_{i,\\sigma(i)}=0$，从而整个乘积为 $0$。因此，该求和式中恰好有一项为 $1$（对应于恒等置换），所有其他项均为 $0$，得出\n$$\n\\operatorname{perm}(I_{n})=1.\n$$\n在二分图的解释中，双邻接矩阵 $I_{n}$ 意味着对于每个 $i \\in \\{1,\\dots,n\\}$，仅在 $u_{i}$ 和 $v_{i}$ 之间存在边。一个完美匹配必须为每个顶点包含恰好一条关联边；唯一可能性是取所有边 $\\{(u_{i},v_{i}) : i=1,\\dots,n\\}$。因此，存在一个单一、唯一的完美匹配，其中每个 $u_{i}$ 仅与 $v_{i}$ 匹配。这对应于选项B。", "answer": "$$\\boxed{B}$$", "id": "1469066"}, {"introduction": "在上一个练习的基础上，我们现在来探索一个组合上更丰富的场景。本练习要求你找出一个矩阵，其积和式恰好等于一个完全二分图中所有可能的完美匹配的数量 [@problem_id:1469032]。这个实践将积和式与阶乘函数直接联系起来，进一步巩固其在枚举问题中的强大作用。", "problem": "一个 $n \\times n$ 矩阵 $A=(a_{ij})$ 的积和式 (permanent) 由以下公式定义：\n$$ \\text{perm}(A) = \\sum_{\\sigma \\in S_n} \\prod_{i=1}^n a_{i, \\sigma(i)} $$\n其中，求和遍及集合 $\\{1, 2, \\dots, n\\}$ 的所有排列 $\\sigma$。这个量与图论中的计数问题密切相关，构成了复杂性类 #P 的基础。\n\n考虑一个完全二分图，记作 $K_{n,n}$。该图有两组顶点，分别为 $U = \\{u_1, u_2, \\dots, u_n\\}$ 和 $V = \\{v_1, v_2, \\dots, v_n\\}$，并且 $U$ 中的每个顶点与 $V$ 中的每个顶点之间都存在一条边。$K_{n,n}$ 中的一个完美匹配（perfect matching）是指一个包含 $n$ 条边的集合，其中任意两条边都不共享顶点。这种配置将集合 $U$ 中的每个顶点与集合 $V$ 中的一个唯一顶点配对。\n\n你的任务是找出一个 $n \\times n$ 矩阵 $A$，使其积和式 $\\text{perm}(A)$ 正好等于图 $K_{n,n}$ 中不同完美匹配的数量。\n\n对于任意整数 $n \\ge 1$，下列哪个矩阵满足此条件？设 $J_n$ 是所有元素都为 1 的 $n \\times n$ 矩阵，设 $I_n$ 是 $n \\times n$ 单位矩阵，并设 $\\delta_{ij}$ 为克罗内克 delta 符号（Kronecker delta）。\n\nA. 元素为 $a_{ij} = n$ 的矩阵 $A$。\n\nB. 元素为 $a_{ij} = 1 - \\delta_{ij}$ 的矩阵 $A$。\n\nC. 矩阵 $A = I_n$。\n\nD. 矩阵 $A = J_n$。\n\nE. 元素为 $a_{ij} = ij$ 的矩阵 $A$。", "solution": "我们首先将完全二分图 $K_{n,n}$ 中的完美匹配与排列联系起来。一个完美匹配对应一个双射 $f: U \\to V$，它可以通过 $f(u_{i}) = v_{\\sigma(i)}$ 等同于一个排列 $\\sigma \\in S_{n}$。因此，$K_{n,n}$ 中完美匹配的数量就是 $n$ 个元素的排列数，即 $n!$。\n\n我们需要一个积和式等于这个计数的矩阵 $A$：\n$$\n\\text{perm}(A) = \\sum_{\\sigma \\in S_{n}} \\prod_{i=1}^{n} a_{i,\\sigma(i)} = n!.\n$$\n\n逐一评估每个选项：\n\n- 选项 D：$A = J_{n}$，其中对所有 $i,j$ 都有 $a_{ij} = 1$。\n对于任意 $\\sigma \\in S_{n}$，\n$$\n\\prod_{i=1}^{n} a_{i,\\sigma(i)} = \\prod_{i=1}^{n} 1 = 1.\n$$\n因此，\n$$\n\\text{perm}(J_{n}) = \\sum_{\\sigma \\in S_{n}} 1 = |S_{n}| = n!,\n$$\n这与 $K_{n,n}$ 中完美匹配的数量相符。\n\n- 选项 A：$a_{ij} = n$。\n对于任意 $\\sigma$，\n$$\n\\prod_{i=1}^{n} a_{i,\\sigma(i)} = \\prod_{i=1}^{n} n = n^{n},\n$$\n所以\n$$\n\\text{perm}(A) = \\sum_{\\sigma \\in S_{n}} n^{n} = n! \\, n^{n} \\neq n! \\quad \\text{对于 } n \\ge 2.\n$$\n\n- 选项 B：$a_{ij} = 1 - \\delta_{ij}$（对角线上为零，非对角线上为一）。\n对于任意 $\\sigma$，\n$$\n\\prod_{i=1}^{n} a_{i,\\sigma(i)} = \\prod_{i=1}^{n} (1 - \\delta_{i,\\sigma(i)}) =\n\\begin{cases}\n1,  \\text{如果对于所有 } i \\text{ 都有 } \\sigma(i) \\ne i, \\\\\n0,  \\text{其他情况}.\n\\end{cases}\n$$\n因此 $\\text{perm}(A)$ 计算的是 $n$ 的错排数，通常记作 $!n$，并且\n$$\n\\text{perm}(A) = !n \\neq n! \\quad \\text{对于 } n \\ge 2.\n$$\n\n- 选项 C：$A = I_{n}$。\n对于任意 $\\sigma$，\n$$\n\\prod_{i=1}^{n} a_{i,\\sigma(i)} = \\prod_{i=1}^{n} \\delta_{i,\\sigma(i)} =\n\\begin{cases}\n1,  \\sigma = \\text{id}, \\\\\n0,  \\text{其他情况},\n\\end{cases}\n$$\n所以\n$$\n\\text{perm}(I_{n}) = 1 \\neq n! \\quad \\text{对于 } n \\ge 2.\n$$\n\n- 选项 E：$a_{ij} = i j$。\n对于任意 $\\sigma$，\n$$\n\\prod_{i=1}^{n} a_{i,\\sigma(i)} = \\prod_{i=1}^{n} (i \\, \\sigma(i)) = \\left( \\prod_{i=1}^{n} i \\right)\\left( \\prod_{i=1}^{n} \\sigma(i) \\right) = (n!)^{2},\n$$\n与 $\\sigma$ 无关，因此\n$$\n\\text{perm}(A) = \\sum_{\\sigma \\in S_{n}} (n!)^{2} = n! \\, (n!)^{2} = (n!)^{3} \\neq n! \\quad \\text{对于 } n \\ge 2.\n$$\n\n只有选项 D 对于所有整数 $n \\ge 1$ 都能得出 $\\text{perm}(A) = n!$，与 $K_{n,n}$ 中完美匹配的数量相符。", "answer": "$$\\boxed{D}$$", "id": "1469032"}, {"introduction": "这是理解Valiant定理的关键一步。将#SAT问题归约到积和式计算的证明，依赖于一种从逻辑到代数的巧妙转换，这个过程被称为“算术化”（arithmetization）。本练习 [@problem_id:1469070] 让你亲手实践这一核心技术，通过构造一个多项式来模拟逻辑子句的行为。这是连接计算逻辑满足指派数量和求值代数表达式之间的概念桥梁。", "problem": "在一个新的计算模型中，逻辑变量由其数值对应物表示。具体来说，一个布尔变量 $x_i$ 映射到一个数值变量 $v_i$，其中如果 $x_i$ 为真（TRUE），则 $v_i=1$；如果 $x_i$ 为假（FALSE），则 $v_i=0$。因此，逻辑非 $\\neg x_i$ 由表达式 $1-v_i$ 表示。\n\n你的任务是为一个特定的逻辑子句设计一个算术表示。考虑子句 $C = (x_1 \\lor \\neg x_2 \\lor x_3)$。构建一个多元多项式 $P(v_1, v_2, v_3)$，使其具有以下性质：对于变量 $v_1, v_2, v_3$ 的任何来自集合 $\\{0, 1\\}$ 的赋值，如果相应的真值赋值满足子句 $C$，则多项式 $P$ 的值为 1，否则其值为 0。\n\n请用 $v_1, v_2, v_3$ 的多项式形式表示你的答案。", "solution": "我们用 $v_{i} \\in \\{0,1\\}$ 来编码布尔变量，其中文字（literal）为真时值为 $1$，为假时值为 $0$。子句 $C=(x_{1} \\lor \\neg x_{2} \\lor x_{3})$ 由三个文字组成：\n- $L_{1}=x_{1}$ 映射到 $v_{1}$，\n- $L_{2}=\\neg x_{2}$ 映射到 $1 - v_{2}$，\n- $L_{3}=x_{3}$ 映射到 $v_{3}$。\n\n对于文字 $L_{1},L_{2},L_{3} \\in \\{0,1\\}$，逻辑析取满足以下恒等式\n$$\nL_{1} \\lor L_{2} \\lor L_{3} \\;=\\; 1 - (1 - L_{1})(1 - L_{2})(1 - L_{3}),\n$$\n因为析取为假当且仅当所有三个文字都为假，并且对于 $\\{0,1\\}$ 变量，合取对应于乘法。\n\n代入 $L_{1}=v_{1}$，$L_{2}=1 - v_{2}$ 和 $L_{3}=v_{3}$ 得到\n$$\nP(v_{1},v_{2},v_{3}) \\;=\\; 1 - \\bigl(1 - v_{1}\\bigr)\\bigl(1 - (1 - v_{2})\\bigr)\\bigl(1 - v_{3}\\bigr)\n\\;=\\; 1 - \\bigl(1 - v_{1}\\bigr) v_{2} \\bigl(1 - v_{3}\\bigr).\n$$\n展开以获得多项式，\n$$\n\\bigl(1 - v_{1}\\bigr) v_{2} \\bigl(1 - v_{3}\\bigr)\n= v_{2}\\bigl(1 - v_{1}\\bigr)\\bigl(1 - v_{3}\\bigr)\n= v_{2}\\bigl(1 - v_{1} - v_{3} + v_{1} v_{3}\\bigr)\n= v_{2} - v_{1} v_{2} - v_{2} v_{3} + v_{1} v_{2} v_{3}.\n$$\n因此，\n$$\nP(v_{1},v_{2},v_{3}) = 1 - \\bigl(v_{2} - v_{1} v_{2} - v_{2} v_{3} + v_{1} v_{2} v_{3}\\bigr)\n= 1 - v_{2} + v_{1} v_{2} + v_{2} v_{3} - v_{1} v_{2} v_{3}.\n$$\n对于任何 $v_{1},v_{2},v_{3} \\in \\{0,1\\}$，当 $x_{1}$、$\\neg x_{2}$ 或 $x_{3}$ 中至少有一个为真时，该多项式的值恰好为 $1$，否则其值为 $0$。", "answer": "$$\\boxed{1 - v_{2} + v_{1} v_{2} + v_{2} v_{3} - v_{1} v_{2} v_{3}}$$", "id": "1469070"}]}