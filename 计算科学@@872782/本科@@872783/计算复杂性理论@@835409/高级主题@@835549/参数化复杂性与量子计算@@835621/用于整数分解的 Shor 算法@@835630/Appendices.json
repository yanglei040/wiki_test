{"hands_on_practices": [{"introduction": "Shor算法的核心是利用量子计算机找到一个特定函数的周期。在深入探讨量子部分之前，通过一个具体的经典计算来理解“周期”这一核心概念至关重要。这个练习将带你手动计算一个模幂函数的周期，为理解整个算法奠定坚实的基础。[@problem_id:1447896]", "problem": "考虑一个函数 $f$，它将非负整数映射到一个有限整数集，其定义规则为 $f(x) = a^x \\pmod{N}$，其中 $a$ 和 $N$ 是正整数，且 $a$ 和 $N$ 的最大公约数为 1。这个函数是周期性的。周期，记为 $r$，是满足 $a^r \\equiv 1 \\pmod{N}$ 的最小正整数。\n\n对于底数为 $a=7$、模数为 $N=15$ 的特定情况，通过直接计算来确定函数 $f(x) = 7^x \\pmod{15}$ 的周期 $r$。", "solution": "我们要求解 $a=7$ 模 $N=15$ 的周期（乘法阶）$r$，它被定义为满足 $7^{r} \\equiv 1 \\pmod{15}$ 的最小正整数 $r$。由于 $\\gcd(7,15)=1$，因此在模15的乘法群中，$7$ 的幂次是良定义的。根据欧拉定理，$7^{\\varphi(15)} \\equiv 1 \\pmod{15}$，其中 $\\varphi(15)=\\varphi(3)\\varphi(5)=2 \\cdot 4 = 8$，所以阶 $r$ 必定整除 $8$。我们通过直接计算来找到最小的这样的 $r$。\n\n利用若 $x \\equiv y \\pmod{15}$，则 $7x \\equiv 7y \\pmod{15}$ 的性质，计算 $7$ 模 $15$ 的连续幂次：\n\n$7^{1} \\equiv 7 \\pmod{15}$，它不同余于 $1$。\n\n$7^{2} \\equiv 7 \\cdot 7 = 49 \\equiv 49 - 45 = 4 \\pmod{15}$，它不同余于 $1$。\n\n$7^{3} \\equiv 7 \\cdot 7^{2} \\equiv 7 \\cdot 4 = 28 \\equiv 28 - 15 = 13 \\pmod{15}$，它不同余于 $1$。\n\n$7^{4} \\equiv 7 \\cdot 7^{3} \\equiv 7 \\cdot 13 = 91 \\equiv 91 - 90 = 1 \\pmod{15}$。\n\n因此，满足 $7^{r} \\equiv 1 \\pmod{15}$ 的最小正整数 $r$ 是 $r=4$。这也与阶必须整除 $8$ 的事实相符，并且我们已经验证了在 $1,2,3$ 中没有更小的正指数能得到模 $15$ 为 $1$ 的结果。", "answer": "$$\\boxed{4}$$", "id": "1447896"}, {"introduction": "找到周期$r$只是第一步，接下来的关键在于如何利用这个周期来分解整数$N$。算法的经典后处理部分依赖于一个巧妙的数论技巧，但这个技巧并非总是有效。这个练习探讨了一种常见的失败情况——当找到的周期是奇数时，算法为何会失败，从而帮助你更深入地理解算法背后的数学原理。[@problem_id:1447866]", "problem": "在用于整数分解的 Shor 算法中，一个关键步骤是对量子子程序找到的周期 $r$ 进行经典后处理。我们来考虑一个分解整数 $N=35$ 的尝试。一名学生选择了基数 $a=6$，并正确地使用算法的量子部分来寻找函数 $f(x)=6^x \\pmod{35}$ 的周期。找到的周期为 $r=2$。\n\n现在，考虑一个假设的替代情景。假设对于一个不同的整数 $N'$ 和一个不同的基数 $a'$，一名学生运行了量子周期寻找子程序，算法返回了一个奇数周期，例如 $r'=7$。在这种情况下，Shor 算法的标准经典后处理阶段将会失败，学生需要用另一个不同的基数重新启动算法。\n\n当周期 $r'$ 为奇数时，下列哪个陈述为 Shor 算法在经典后处理阶段失败提供了最准确和最根本的原因？\n\nA. 奇数周期 $r'$ 只有在所选基数 $a'$ 与 $N'$ 有公因子时才会出现，这意味着最大公约数 (GCD) 预检查 $\\gcd(a', N') > 1$ 应该已经找到了一个因子。\n\nB. 作为周期寻找子程序核心的量子傅里叶变换，在数学上被限制为只能对合数 $N'$ 产生偶数周期。奇数结果意味着量子硬件存在故障。\n\nC. 分解步骤依赖于将 $a'^{r'}-1$ 表示为平方差形式，这只有在指数 $r'/2$ 是整数时才可能。\n\nD. 奇数周期 $r'$ 意味着 $a'^{r'/2} \\equiv -1 \\pmod{N'}$，这是算法产生平凡因子的特定失败条件之一。\n\nE. 当周期 $r'$ 为奇数时，元素 $a'$ 在模 $N'$ 整数乘法群中的阶不是 2 的幂，这使得最终的 GCD 计算效率不高。", "solution": "在 Shor 算法中，在选择一个满足 $1  a'  N'$ 且 $\\gcd(a', N') = 1$ 的基数 $a'$ 并找到周期 $r'$ 后，下一步是检查 $r'$ 是否为偶数。如果 $r'$ 是偶数，我们就可以计算 $d = \\gcd(a'^{r'/2} - 1, N')$，这有可能得到一个非平凡因子。这个步骤的数学基础是恒等式 $a'^{r'} - 1 = (a'^{r'/2} - 1)(a'^{r'/2} + 1)$。如果 $r'$ 是奇数，那么 $r'/2$ 不是一个整数。因此，我们无法将 $a'^{r'} - 1$ 分解为两个整数因子的乘积，即无法构造出平方差形式。这样，算法就无法继续进行到求最大公约数的步骤，从而失败。因此，必须用一个新的基数 $a'$ 重新开始算法。选项 C 最准确地描述了这一根本性的数学障碍。", "answer": "$$\\boxed{C}$$", "id": "1447866"}, {"introduction": "量子计算机并不会直接告诉我们周期$r$的确切值。相反，它提供一个测量结果，这个结果是形如$c/r$的分数的一个高度精确的近似值。因此，我们需要一个高效的经典算法来从这个近似值中“解码”出真正的周期$r$。这个练习将让你亲手实践连分数算法，这是连接量子测量和最终答案的关键桥梁。[@problem_id:1447898]", "problem": "在用于整数分解的Shor算法的经典后处理阶段，从一个 $m$ 量子比特寄存器获得的测量结果 $y$ 被用来构成一个分数 $\\frac{y}{2^m}$。这个分数作为一个未知有理数 $\\frac{c}{r}$ 的近似值，其中 $r$ 是一个模幂函数的期望周期，而 $c$ 是一个与 $r$ 互质的整数。连分数算法提供了一种高效的方法，通过找到 $\\frac{y}{2^m}$ 的最佳有理逼近来恢复周期 $r$。\n\n假设在尝试分解一个大整数时，Shor算法的量子相位估计子程序使用了一个 $m=11$ 量子比特的辅助寄存器。对该寄存器的一次测量产生了整数值 $y=381$。从算法的理论保证可知，周期 $r$ 必须小于60。\n\n你的任务是分析这个测量结果。将连分数算法应用于值 $\\frac{y}{2^m}$，以生成其有理逼近（渐近分数）序列。从这个序列中，找出“最佳”有理逼近 $\\frac{p}{q}$，在本问题中，它被定义为在满足已知约束 $q  60$ 的前提下，具有最大分母 $q$ 的渐近分数。将这个分母 $q$ 作为你的最终答案。", "solution": "我们根据给定的数据构造测得的有理数。当 $m=11$ 且 $y=381$ 时，我们有\n$$\nx=\\frac{y}{2^{m}}=\\frac{381}{2^{11}}=\\frac{381}{2048}.\n$$\n为了得到 $x$ 的连分数，我们将欧几里得算法应用于数对 $(2048,381)$ 以提取部分商。执行除法运算：\n$$\n2048=5\\cdot 381+143,\\quad 381=2\\cdot 143+95,\\quad 143=1\\cdot 95+48,\n$$\n$$\n95=1\\cdot 48+47,\\quad 48=1\\cdot 47+1,\\quad 47=47\\cdot 1+0.\n$$\n因此，$\\frac{2048}{381}$ 的连分数是 $[5;2,1,1,1,47]$，所以 $x=\\frac{381}{2048}$ 的连分数是\n$$\n[0;5,2,1,1,1,47].\n$$\n通过标准递推关系计算渐近分数 $p_{k}/q_{k}$，其中 $a_{0}=0$, $a_{1}=5$, $a_{2}=2$, $a_{3}=1$, $a_{4}=1$, $a_{5}=1$, $a_{6}=47$，初始条件为 $p_{-2}=0$, $p_{-1}=1$, $q_{-2}=1$, $q_{-1}=0$：\n$$\np_{k}=a_{k}p_{k-1}+p_{k-2},\\quad q_{k}=a_{k}q_{k-1}+q_{k-2}.\n$$\n一步一步地：\n- $k=0$: $p_{0}=0\\cdot 1+0=0$, $q_{0}=0\\cdot 0+1=1$，所以 $\\frac{p_{0}}{q_{0}}=\\frac{0}{1}$。\n- $k=1$: $p_{1}=5\\cdot 0+1=1$, $q_{1}=5\\cdot 1+0=5$，所以 $\\frac{p_{1}}{q_{1}}=\\frac{1}{5}$。\n- $k=2$: $p_{2}=2\\cdot 1+0=2$, $q_{2}=2\\cdot 5+1=11$，所以 $\\frac{p_{2}}{q_{2}}=\\frac{2}{11}$。\n- $k=3$: $p_{3}=1\\cdot 2+1=3$, $q_{3}=1\\cdot 11+5=16$，所以 $\\frac{p_{3}}{q_{3}}=\\frac{3}{16}$。\n- $k=4$: $p_{4}=1\\cdot 3+2=5$, $q_{4}=1\\cdot 16+11=27$，所以 $\\frac{p_{4}}{q_{4}}=\\frac{5}{27}$。\n- $k=5$: $p_{5}=1\\cdot 5+3=8$, $q_{5}=1\\cdot 27+16=43$，所以 $\\frac{p_{5}}{q_{5}}=\\frac{8}{43}$。\n- $k=6$: $p_{6}=47\\cdot 8+5=381$, $q_{6}=47\\cdot 43+27=2048$，所以 $\\frac{p_{6}}{q_{6}}=\\frac{381}{2048}$。\n\n因此，这些渐近分数的分母分别为 $1,5,11,16,27,43,2048$。在约束 $q60$ 下，具有最大分母的渐近分数是 $\\frac{8}{43}$，因此所求的分母是 $q=43$。", "answer": "$$\\boxed{43}$$", "id": "1447898"}]}