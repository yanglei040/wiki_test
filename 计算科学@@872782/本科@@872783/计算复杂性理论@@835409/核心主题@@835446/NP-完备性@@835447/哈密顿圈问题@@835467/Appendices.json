{"hands_on_practices": [{"introduction": "在尝试寻找哈密顿环之前，我们首先需要理解其存在的基本条件。本练习旨在探讨一类重要的图——完全二分图——中存在哈密顿环所必须满足的结构性要求。通过解决这个问题 [@problem_id:1457281]，你将深入理解图的结构如何制约环的存在，这是图论问题分析中的一项核心技能。", "problem": "在图论中，一个图 $G$ 由一个集合对 $(V, E)$ 定义，其中 $V$ 是一个顶点集，$E$ 是一个连接顶点对的边集。一种特殊的图是**完全二分图**，记作 $K_{m,n}$，其中 $m$ 和 $n$ 是正整数。在这样的图中，顶点集 $V$ 可以被划分为两个不相交的子集 $U$ 和 $W$，使得 $|U|=m$ 且 $|W|=n$。边连接 $U$ 中的顶点和 $W$ 中的顶点；事实上，对于 $U$ 中的每个顶点 $u$ 和 $W$ 中的每个顶点 $w$，边 $(u,w)$ 都存在于 $E$ 中。在同一划分内部的顶点之间不存在边。\n\n**哈密顿圈**是图中的一个闭合回路，它恰好访问每个顶点一次并返回到起始顶点。\n\n给定一个完全二分图 $K_{m,n}$，以下关于整数 $m$ 和 $n$ 的哪个条件是该图拥有哈密顿圈的充分必要条件？\n\nA. $m = n$ 且 $m \\ge 2$\n\nB. $m$ 和 $n$ 都是正偶数。\n\nC. $m+n$ 是一个偶数且 $m, n \\ge 2$。\n\nD. $m \\ge 2$ 且 $n \\ge 2$。\n\nE. $m=n$ 且 $m \\ge 1$。", "solution": "我们首先分析必要条件。在任何具有划分集 $U$ 和 $W$ 的二分图中，每个圈都必须在 $U$ 和 $W$ 的顶点之间交替进行，因为没有边连接同一划分内的两个顶点。因此，任何圈都有偶数个顶点，其中包含来自 $U$ 和 $W$ 的相同数量的顶点。\n\n如果该图有一个哈密顿圈，该圈会恰好访问每个顶点一次，因此包含了 $U$ 中的所有 $m$ 个顶点和 $W$ 中的所有 $n$ 个顶点。根据交替性质，圈上来自 $U$ 的顶点数必须等于来自 $W$ 的顶点数，这就要求\n$$\nm = n.\n$$\n此外，一个简单二分图中的圈的长度必须至少为 $4$，所以每个部分必须至少有两个顶点。因此，$K_{m,n}$ 中的哈密顿圈必然要求\n$$\nm = n \\quad \\text{且} \\quad m \\ge 2.\n$$\n\n我们现在来证明充分性。假设 $m = n$ 且 $n \\ge 2$。将顶点标记为 $U = \\{u_{1}, u_{2}, \\ldots, u_{n}\\}$ 和 $W = \\{w_{1}, w_{2}, \\ldots, w_{n}\\}$。在 $K_{n,n}$ 中，每一对 $(u_{i}, w_{j})$ 都是一条边。考虑闭合路径\n$$\nu_{1} \\to w_{1} \\to u_{2} \\to w_{2} \\to \\cdots \\to u_{n} \\to w_{n} \\to u_{1}.\n$$\n每一步都使用了一条连接 $U$ 和 $W$ 的边，这条边在 $K_{n,n}$ 中是存在的。这条路径恰好访问了每个顶点一次，并返回到起始顶点，因此它是一个哈密顿圈。\n\n因此，条件 $m = n$ 且 $m \\ge 2$ 是 $K_{m,n}$ 拥有哈密顿圈的充分必要条件，这对应于选项 A。", "answer": "$$\\boxed{A}$$", "id": "1457281"}, {"introduction": "由于寻找最优哈密顿环在计算上是一个难题，我们常常采用启发式算法来寻找一个“足够好”的解。本练习将带你实践一种直观的贪心策略——最近邻算法，这是解决旅行商问题（哈密顿环问题的加权版本）的常用方法。通过亲手执行该算法 [@problem_id:1457266]，你将体会到启发式算法在解决NP难问题时的实际应用，并理解为何简单的贪心选择并不总能保证找到全局最优解。", "problem": "考虑一个完全、无向、带权图 $G$，其顶点集为 $V = \\{V_1, V_2, V_3, V_4\\}$。任意两个顶点之间的边的权重如下：\n- 顶点 $V_1$ 和 $V_2$ 之间的边的权重为 $101$。\n- 顶点 $V_1$ 和 $V_3$ 之间的边的权重为 $101$。\n- 顶点 $V_1$ 和 $V_4$ 之间的边的权重为 $400$。\n- 顶点 $V_2$ 和 $V_3$ 之间的边的权重为 $4$。\n- 顶点 $V_2$ 和 $V_4$ 之间的边的权重为 $101$。\n- 顶点 $V_3$ 和 $V_4$ 之间的边的权重为 $101$。\n\n一种寻找低权重哈密顿回路的常用启发式算法是最近邻算法。该算法的步骤如下：\n1.  从一个指定的顶点开始。该顶点作为路径的起点。\n2.  从当前顶点出发，移动到最近的未访问顶点（即由权重最小的边连接的顶点）。\n3.  如果到最近的未访问顶点存在权重相同的情况，算法选择索引最小的顶点（例如，如果 $i  j$，则选择 $V_i$ 而不是 $V_j$）。\n4.  重复步骤2，直到图中所有顶点都已被访问。\n5.  最后，从最后一个访问的顶点返回到起始顶点，以完成回路。\n\n将最近邻算法应用于图 $G$，从顶点 $V_1$ 开始。计算生成的哈密顿回路的总权重。", "solution": "我们从 $V_{1}$ 开始应用最近邻算法，使用给定的边权重 $w(V_{i},V_{j})$ 和偏向最小索引的平局打破规则。\n\n步骤1（开始）：当前顶点为 $V_{1}$。未访问的顶点是 $\\{V_{2},V_{3},V_{4}\\}$。候选边是 $w(V_{1},V_{2})=101$、$w(V_{1},V_{3})=101$ 和 $w(V_{1},V_{4})=400$。未访问顶点中的最小权重是 $101$，到 $V_{2}$ 和 $V_{3}$ 的权重相同。根据平局打破规则，选择索引较小的，因此移动到 $V_{2}$。目前的路径：$V_{1}\\to V_{2}$，成本为 $101$。\n\n步骤2：当前顶点为 $V_{2}$。未访问的顶点是 $\\{V_{3},V_{4}\\}$。候选边是 $w(V_{2},V_{3})=4$ 和 $w(V_{2},V_{4})=101$。最小值是 $4$，因此移动到 $V_{3}$。目前的路径：$V_{1}\\to V_{2}\\to V_{3}$，额外成本为 $4$。\n\n步骤3：当前顶点为 $V_{3}$。仅有的未访问顶点是 $\\{V_{4}\\}$。通过 $w(V_{3},V_{4})=101$ 移动到 $V_{4}$。目前的路径：$V_{1}\\to V_{2}\\to V_{3}\\to V_{4}$，额外成本为 $101$。\n\n步骤4（返回起点）：所有顶点都已被访问。从 $V_{4}$ 返回起点 $V_{1}$，成本为 $w(V_{4},V_{1})=400$。\n\n生成的哈密顿回路是 $V_{1}\\to V_{2}\\to V_{3}\\to V_{4}\\to V_{1}$，其总权重为\n$$101+4+101+400=606.$$", "answer": "$$\\boxed{606}$$", "id": "1457266"}, {"introduction": "虽然哈密顿环问题在一般图上是NP完全的，但当图具有某些特殊结构时，我们仍可能找到高效的精确解。本练习将介绍一种在树分解上使用动态规划的先进技术，该方法可以在图的“树宽”较小时高效地解决问题。这个练习 [@problem_id:1457286] 让你得以一窥参数化算法的领域，理解我们如何利用输入的结构特性来克服NP完全问题的计算复杂性。", "problem": "一家物流公司正在为其新型无人机配送队伍在密集的城市环境中优化路线。可能的投送点网络及它们之间的飞行路径构成了一个图 $G=(V, E)$。为了确保满载配送的最高效率，一架无人机必须从一个仓库出发，访问每一个投送点恰好一次，然后返回仓库。这个特定的路线要求被称为在图中寻找哈密顿回路（Hamiltonian Cycle）。\n\n虽然哈密顿回路问题在一般情况下是NP完全的，但该公司的网络分析师发现他们城市的网络图具有较低的树宽（treewidth），这使得可以使用动态规划（Dynamic Programming, DP）得到更高效的解法。该算法在图的*树分解*上进行操作。\n\n一个图 $G=(V, E)$ 的**树分解**是一个对 $(T, \\{X_i\\}_{i \\in V(T)})$，其中 $T$ 是一棵树，而 $\\{X_i\\}$ 是 $V$ 的一个子集族（称为“包”），$T$ 的每个节点 $i$ 对应一个包，满足以下条件：\n1.  **节点覆盖**：$G$ 的每个顶点至少存在于一个包 $X_i$ 中。\n2.  **边覆盖**：对于 $G$ 中的每条边 $(u,v)$，存在某个包 $X_i$ 同时包含 $u$ 和 $v$。\n3.  **连通性**：对于任意顶点 $v \\in V$，节点集合 $\\{i \\in V(T) \\mid v \\in X_i\\}$ 在 $T$ 中形成一个连通的子树。\n\n树分解的**宽度**为 $\\max_{i \\in V(T)} |X_i| - 1$。一个图 $G$ 的**树宽**（treewidth），记作 $tw(G)$，是 $G$ 所有可能树分解的最小宽度。\n\n动态规划算法通过从树分解的叶子节点向上处理到根节点来进行。在树分解的节点 $i$ 处的动态规划状态必须概括其包 $X_i$ *内部*的顶点是如何通过路径段连接的，这些路径段使用了在以 $i$ 为根的子树对应的子图中已经处理过的顶点。这些路径段是潜在哈密顿回路的部分片段。\n\n$X_i$ 包的一个DP状态可以由 $X_i$ 中顶点子集上的一个匹配来刻画。匹配中的一对顶点 $\\{u, v\\}$ 表示已经形成了一条以 $u$ 开始、以 $v$ 结束的路径段，该路径段使用了不在 $X_i$ 中（但在 $i$ “下方”的包中）的顶点。$X_i$ 中不属于任何配对的顶点被视为路径段的端点，这些路径段不与包内的另一个顶点相连。由于哈密顿回路是单个回路，任何子图中的部分路径都不能形成过早的回路。\n\n您的任务是确定单个包的DP状态空间的大小。具体来说，对于一个树宽为4的图，计算DP算法对单个包 $X_i$ 必须考虑的不同连接模式（匹配）的总数。假设所使用的树分解具有此树宽所允许的最大包大小。", "solution": "给定树宽为4，因此任何达到此宽度的树分解都具有最大包大小\n$$|X_{i}|=\\text{tw}(G)+1=5.$$\n根据问题的DP特性描述，一个包的状态是其顶点子集上的一个匹配：即在5个已标记的顶点中选择若干不相交的无序对，剩下的顶点（如果有的话）保持未匹配状态。不允许出现过早的回路；将状态表示为匹配（即不相交对的集合）确保了在包的摘要信息中不会形成回路。\n\n对于一个大小为 $k$ 的包，此类匹配（部分匹配）的总数是为任意满足 $0 \\leq m \\leq \\lfloor k/2 \\rfloor$ 的 $m$ 选择 $m$ 个不相交对的方法数。对于一个固定的 $m$：\n- 选择要匹配的 $2m$ 个顶点：$\\binom{k}{2m}$。\n- 将这 $2m$ 个已标记的顶点配成 $m$ 个无序对：$(2m-1)!!=\\frac{(2m)!}{2^{m} m!}$。\n\n因此，状态总数为\n$$\nM(k)=\\sum_{m=0}^{\\lfloor k/2 \\rfloor} \\binom{k}{2m} (2m-1)!!=\\sum_{m=0}^{\\lfloor k/2 \\rfloor} \\binom{k}{2m}\\frac{(2m)!}{2^{m} m!}=\\sum_{m=0}^{\\lfloor k/2 \\rfloor} \\frac{k!}{(k-2m)! \\, 2^{m} \\, m!}.\n$$\n代入 $k=5$：\n$$\nM(5)=\\sum_{m=0}^{2} \\frac{5!}{(5-2m)! \\, 2^{m} \\, m!}\n= \\frac{5!}{5!} + \\frac{5!}{3! \\cdot 2^{1} \\cdot 1!} + \\frac{5!}{1! \\cdot 2^{2} \\cdot 2!}\n= 1 + 10 + 15 = 26.\n$$\n因此，对于一个大小为5的包，DP必须考虑26种不同的连接模式（匹配）。", "answer": "$$\\boxed{26}$$", "id": "1457286"}]}