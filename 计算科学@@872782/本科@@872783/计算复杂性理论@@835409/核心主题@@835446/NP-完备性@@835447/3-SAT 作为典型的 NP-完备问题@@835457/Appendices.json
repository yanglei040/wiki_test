{"hands_on_practices": [{"introduction": "掌握任何一个新概念的第一步都是理解其基本定义。对于 3-可满足性问题（3-SAT），这意味着能够根据给定的真值指派，准确地判断一个布尔公式中哪些子句被满足。这个练习 [@problem_id:1410968] 提供了一个具体的 3-合取范式 (3-CNF) 公式和一组变量赋值，让你通过亲手计算来巩固对子句满足性定义的基本理解。", "problem": "在计算复杂性理论中，布尔可满足性问题 (SAT) 是一个基础性问题。一个常见的变体是 3-可满足性问题 (3-SAT)。如果一个布尔公式是子句的合取，并且每个子句都是恰好三个文字的析取，则该公式属于 3-合取范式 (3-CNF)。一个文字是一个布尔变量或其否定。我们使用符号 $\\land$ 表示逻辑与（合取），$\\lor$ 表示逻辑或（析取），以及 $\\neg$ 表示逻辑非（否定）。\n\n考虑一个定义在四个布尔变量集合 $\\{x_1, x_2, x_3, x_4\\}$ 上的 3-CNF 公式 $\\phi$。该公式 $\\phi$ 由以下五个子句的合取构成：\n$C_1 = (\\neg x_1 \\lor x_2 \\lor \\neg x_3)$\n$C_2 = (\\neg x_1 \\lor x_2 \\lor x_4)$\n$C_3 = (x_1 \\lor x_2 \\lor x_3)$\n$C_4 = (\\neg x_2 \\lor \\neg x_3 \\lor x_4)$\n$C_5 = (x_3 \\lor \\neg x_4 \\lor x_2)$\n\n所以，完整的公式为 $\\phi = C_1 \\land C_2 \\land C_3 \\land C_4 \\land C_5$。\n\n如果一个子句中至少有一个文字在某个真值指派下求值为真，则称该子句被该指派满足。当且仅当公式 $\\phi$ 的所有子句都被满足时，该公式才被满足。\n\n给定以下真值指派 $A$：\n$x_1 = \\text{True}$\n$x_2 = \\text{False}$\n$x_3 = \\text{True}$\n$x_4 = \\text{False}$\n\n请确定公式 $\\phi$ 中被真值指派 $A$ 满足的子句总数。", "solution": "一个 3-CNF 公式中的子句在其至少一个文字求值为 $\\text{True}$ 时即被满足。如果至少一个操作数为 $\\text{True}$，逻辑析取 $\\lor$ 的求值结果为 $\\text{True}$，并且否定运算满足 $\\neg \\text{True}=\\text{False}$ 和 $\\neg \\text{False}=\\text{True}$。在 $x_1=\\text{True}$，$x_2=\\text{False}$，$x_3=\\text{True}$，$x_4=\\text{False}$ 的指派 $A$ 下，我们首先计算所需的否定式：$\\neg x_1=\\text{False}$，$\\neg x_2=\\text{True}$，$\\neg x_3=\\text{False}$，$\\neg x_4=\\text{True}$。\n\n对每个子句求值：\n$$C_1=(\\neg x_1\\lor x_2\\lor \\neg x_3)=(\\text{False}\\lor \\text{False}\\lor \\text{False})=\\text{False},$$\n$$C_2=(\\neg x_1\\lor x_2\\lor x_4)=(\\text{False}\\lor \\text{False}\\lor \\text{False})=\\text{False},$$\n$$C_3=(x_1\\lor x_2\\lor x_3)=(\\text{True}\\lor \\text{False}\\lor \\text{True})=\\text{True},$$\n$$C_4=(\\neg x_2\\lor \\neg x_3\\lor x_4)=(\\text{True}\\lor \\text{False}\\lor \\text{False})=\\text{True},$$\n$$C_5=(x_3\\lor \\neg x_4\\lor x_2)=(\\text{True}\\lor \\text{True}\\lor \\text{False})=\\text{True}.$$\n\n因此，恰有三个子句，$C_3$、$C_4$ 和 $C_5$，被指派 $A$ 满足。", "answer": "$$\\boxed{3}$$", "id": "1410968"}, {"introduction": "在掌握了如何评估一个 3-CNF 公式之后，下一步是学习如何构建它们来表达特定的逻辑约束。将现实世界的问题或抽象的逻辑规则转化为 3-CNF 格式，是利用 3-SAT 作为工具来解决其他问题的核心技能。这个练习 [@problem_id:1410932] 挑战你构建一个公式来精确表达“三选一”的约束，这是一个在算法设计和复杂性归约中经常出现的经典“小工具”(gadget)。", "problem": "在设计一个工业机器人的安全关键控制系统时，存在三种互斥的操作模式，由布尔变量表示：焊接 ($x_1$)、喷漆 ($x_2$) 和钻孔 ($x_3$)。如果模式 $i$ 处于活动状态，则变量 $x_i$ 被赋值为 `true`，否则为 `false`。为了使系统安全运行，控制逻辑必须确保在任何给定时间，这三种模式中**恰好有一种**处于活动状态。\n\n控制逻辑被实现为一个布尔公式，当且仅当活动模式的配置有效时，该公式的求值结果为 `true`。为了与硬件兼容，这个公式必须表示为 3-合取范式 (3-CNF)。如果一个公式是一个或多个子句的合取（逻辑与，用 $\\land$ 表示），其中每个子句是恰好三个文字的析取（逻辑或，用 $\\lor$ 表示），那么这个公式就是 3-CNF 形式的。一个文字是一个变量或其否定（例如，$x_1$ 或 $\\neg x_1$）。\n\n下列哪个 3-CNF 公式正确地表示了变量 $x_1, x_2, x_3$ 中恰好有一个为 `true` 的约束？\n\nA. $(x_1 \\lor x_2 \\lor x_3) \\land (\\neg x_1 \\lor \\neg x_2 \\lor \\neg x_3) \\land (x_1 \\lor \\neg x_2 \\lor \\neg x_3) \\land (\\neg x_1 \\lor x_2 \\lor \\neg x_3) \\land (\\neg x_1 \\lor \\neg x_2 \\lor x_3)$\n\nB. $(\\neg x_1 \\lor \\neg x_2 \\lor \\neg x_3) \\land (x_1 \\lor \\neg x_2 \\lor \\neg x_3) \\land (\\neg x_1 \\lor x_2 \\lor \\neg x_3) \\land (\\neg x_1 \\lor \\neg x_2 \\lor x_3)$\n\nC. $(x_1 \\lor x_2 \\lor x_3) \\land (\\neg x_1 \\lor \\neg x_2) \\land (\\neg x_1 \\lor \\neg x_3) \\land (\\neg x_2 \\lor \\neg x_3)$\n\nD. $(x_1 \\lor x_2 \\lor x_3) \\land (x_1 \\lor x_2 \\lor \\neg x_3) \\land (x_1 \\lor \\neg x_2 \\lor x_3) \\land (\\neg x_1 \\lor x_2 \\lor x_3)$", "solution": "我们必须将约束“$x_1,x_2,x_3$ 中恰好有一个为真”编码为 3-CNF 形式，即一个子句的合取，其中每个子句是恰好三个文字的析取。\n\n从逻辑上讲，“恰好一个”等价于“至少一个”和“至多一个”的合取。“至少一个”的部分由单个子句表示：\n$$ (x_1 \\lor x_2 \\lor x_3) $$\n“至多一个”的部分要求没有任意一对变量同时为真，其 CNF 形式为：\n$$ (\\neg x_1 \\lor \\neg x_2) \\land (\\neg x_1 \\lor \\neg x_3) \\land (\\neg x_2 \\lor \\neg x_3) $$\n然而，这三个子句每个都只有两个文字，而问题要求每个子句必须恰好有三个文字。因此，在所提供的选项中，我们必须找到一个由 3-文字子句组成的合取式，它等价于“恰好一个”。\n\n评估每个选项：\n\n1. 选项 C 包含了正确的“至少一个”和成对的“至多一个”的逻辑结构，但是三个成对子句每个只有两个文字，因此它不符合所定义的 3-CNF 形式（每个子句恰好三个文字）。因此，根据给定的形式要求，C 是无效的。\n\n2. 选项 D 由以下子句组成：\n$$ (x_1 \\lor x_2 \\lor x_3) \\land (x_1 \\lor x_2 \\lor \\neg x_3) \\land (x_1 \\lor \\neg x_2 \\lor x_3) \\land (\\neg x_1 \\lor x_2 \\lor x_3) $$\n赋值 $x_1=x_2=x_3=\\text{true}$ 满足所有四个子句，所以 D 允许三个变量都为真，因而没有强制“恰好一个”。因此 D 是不正确的。\n\n3. 选项 B 由四个子句组成，包括 $(\\neg x_1 \\lor \\neg x_2 \\lor \\neg x_3)$ 和三个“一个肯定，两个否定”的子句。赋值 $x_1=x_2=x_3=\\text{false}$ 满足所有子句，所以 B 允许零个变量为真，因而没有强制“恰好一个”。因此 B 是不正确的。\n\n4. 选项 A 由以下子句组成：\n$$ (x_1 \\lor x_2 \\lor x_3) \\land (\\neg x_1 \\lor \\neg x_2 \\lor \\neg x_3) \\land (x_1 \\lor \\neg x_2 \\lor \\neg x_3) \\land (\\neg x_1 \\lor x_2 \\lor \\neg x_3) \\land (\\neg x_1 \\lor \\neg x_2 \\lor x_3) $$\n我们通过穷举逻辑蕴涵关系来验证其与“恰好一个”的等价性：\n- 如果恰好有一个变量为真，比如说 $x_1=\\text{true}$ 且 $x_2=x_3=\\text{false}$，那么第一个子句 $(x_1 \\lor x_2 \\lor x_3)$ 为真；第二个子句 $(\\neg x_1 \\lor \\neg x_2 \\lor \\neg x_3)$ 为真，因为至少有一个变量为假；并且其他三个子句中每个都至少有一个为真的文字（实际上，所有子句都满足），所以整个合取式为真。根据对称性，当 $x_2$ 或 $x_3$ 中恰好有一个为真时，情况同样成立。\n- 如果没有变量为真，那么 $(x_1 \\lor x_2 \\lor x_3)$ 为假，所以整个合取式为假。因此排除了零个变量为真的情况。\n- 如果有两个变量为真，比如说 $x_1=x_2=\\text{true}$ 且 $x_3=\\text{false}$，那么子句 $(\\neg x_1 \\lor \\neg x_2 \\lor x_3)$ 的求值结果为 $(\\text{false} \\lor \\text{false} \\lor \\text{false})$，因此整个合取式为假。根据对称性，任何有两个变量为真的赋值都会违反最后三个子句中的一个。\n- 如果所有三个变量都为真，那么 $(\\neg x_1 \\lor \\neg x_2 \\lor \\neg x_3)$ 为假，所以整个合取式为假。因此排除了三个变量都为真的情况。\n\n因此，选项 A 当且仅当 $x_1,x_2,x_3$ 中恰好有一个为真时成立，并且每个子句恰好有三个文字，所以它是一个满足要求的有效 3-CNF。\n\n因此，正确的选项是 A。", "answer": "$$\\boxed{A}$$", "id": "1410932"}, {"introduction": "3-SAT 在计算复杂性理论中之所以占据核心地位，关键在于我们可以将其他许多问题（包括更一般的可满足性问题）归约到它。这个归约过程的核心技术之一，就是将任意的 CNF 公式转换为一个保持可满足性不变的 3-CNF 公式。这个练习 [@problem_id:1410956] 将引导你实践这一转换过程，通过引入“辅助”变量，将一个不符合 3-CNF 格式的公式转化为等价的 3-CNF 形式，从而揭示 3-SAT 作为 NP 完全问题“基石”的深刻原因。", "problem": "在数字电路设计领域，工程师通常使用布尔公式来表示系统约束。一种常见的格式是合取范式（Conjunctive Normal Form, CNF），它是子句的合取（AND，用 $\\land$ 表示），其中每个子句是文字（变量或其否定）的析取（OR，用 $\\lor$ 表示）。如果存在一种对其变量的真/假值赋值，使得整个公式的值为真，则该公式是*可满足的*。\n\n一位工程师正在使用一种只能处理 3-CNF 公式的旧式硬件描述语言，这意味着公式中的每个子句必须恰好包含三个文字。该工程师的初始设计约束由以下涉及两个变量 $x_1$ 和 $x_2$ 的布尔公式 $\\phi$ 表示：\n$$ \\phi = (x_1 \\lor x_2) \\land (\\neg x_1) \\land (\\neg x_2) $$\n为了将此公式转换为等价的 3-CNF 公式 $\\psi$，该工程师使用了一种保持可满足性的标准展开过程。该过程为每个需要展开的原始子句引入新的、唯一的“虚拟”变量。规则如下：\n\n1.  包含两个文字的子句，如 $(l_1 \\lor l_2)$，被替换为两个新的三文字子句的合取：$(l_1 \\lor l_2 \\lor d_i) \\land (l_1 \\lor l_2 \\lor \\neg d_i)$，其中 $d_i$ 是一个新的虚拟变量。\n2.  包含一个文字的子句，如 $(l_1)$，被替换为四个新的三文字子句的合取：$(l_1 \\lor d_j \\lor d_k) \\land (l_1 \\lor d_j \\lor \\neg d_k) \\land (l_1 \\lor \\neg d_j \\lor d_k) \\land (l_1 \\lor \\neg d_j \\lor \\neg d_k)$，其中 $d_j$ 和 $d_k$ 是两个新的不同虚拟变量。\n\n设 $\\phi$ 的子句按顺序索引为：$C_1 = (x_1 \\lor x_2)$，$C_2 = (\\neg x_1)$ 和 $C_3 = (\\neg x_2)$。为了进行转换，对子句 $C_1$ 使用虚拟变量 $d_1$，对子句 $C_2$ 使用虚拟变量 $d_2$ 和 $d_3$，对子句 $C_3$ 使用虚拟变量 $d_4$ 和 $d_5$。得到的 3-CNF 公式 $\\psi$ 是所有新生成的子句的合取。\n\n下列哪个陈述正确描述了最终的公式 $\\psi$ 及其可满足性？\n\nA. $\\psi = [(x_1 \\lor x_2 \\lor d_1) \\land (x_1 \\lor x_2 \\lor \\neg d_1)] \\land [(\\neg x_1 \\lor d_2 \\lor d_3) \\land (\\neg x_1 \\lor d_2 \\lor \\neg d_3)] \\land [(\\neg x_2 \\lor d_4 \\lor d_5) \\land (\\neg x_2 \\lor d_4 \\lor \\neg d_5)]$，且 $\\psi$ 是不可满足的。\n\nB. $\\psi = [(x_1 \\lor x_2 \\lor d_1) \\land (x_1 \\lor x_2 \\lor \\neg d_1)] \\land [(\\neg x_1 \\lor d_2 \\lor d_3) \\land (\\neg x_1 \\lor d_2 \\lor \\neg d_3) \\land (\\neg x_1 \\lor \\neg d_2 \\lor d_3) \\land (\\neg x_1 \\lor \\neg d_2 \\lor \\neg d_3)] \\land [(\\neg x_2 \\lor d_4 \\lor d_5) \\land (\\neg x_2 \\lor d_4 \\lor \\neg d_5) \\land (\\neg x_2 \\lor \\neg d_4 \\lor d_5) \\land (\\neg x_2 \\lor \\neg d_4 \\lor \\neg d_5)]$，且 $\\psi$ 是可满足的。\n\nC. $\\psi = [(x_1 \\lor x_2 \\lor d_1)] \\land [(\\neg x_1 \\lor d_2 \\lor d_3)] \\land [(\\neg x_2 \\lor d_4 \\lor d_5)]$，且 $\\psi$ 是可满足的。\n\nD. $\\psi = [(x_1 \\lor x_2 \\lor d_1) \\land (x_1 \\lor x_2 \\lor \\neg d_1)] \\land [(\\neg x_1 \\lor d_2 \\lor d_3) \\land (\\neg x_1 \\lor d_2 \\lor \\neg d_3) \\land (\\neg x_1 \\lor \\neg d_2 \\lor d_3) \\land (\\neg x_1 \\lor \\neg d_2 \\lor \\neg d_3)] \\land [(\\neg x_2 \\lor d_4 \\lor d_5) \\land (\\neg x_2 \\lor d_4 \\lor \\neg d_5) \\land (\\neg x_2 \\lor \\neg d_4 \\lor d_5) \\land (\\neg x_2 \\lor \\neg d_4 \\lor \\neg d_5)]$，且 $\\psi$ 是不可满足的。", "solution": "我们从给定的 CNF 布尔公式 $\\phi$ 开始：\n$$ \\phi = (x_1 \\lor x_2) \\land (\\neg x_1) \\land (\\neg x_2) $$\n根据指令，我们需要使用给定的、保持可满足性的展开规则将 $\\phi$ 转换为 3-CNF 公式 $\\psi$，并为每个需要展开的子句引入新的虚拟变量。\n\n识别子句：$C_1 = (x_1 \\lor x_2)$，$C_2 = (\\neg x_1)$，$C_3 = (\\neg x_2)$。根据题目要求，为 $C_1$ 使用 $d_1$，为 $C_2$ 使用 $d_2, d_3$，为 $C_3$ 使用 $d_4, d_5$。\n\n逐个子句应用展开规则：\n1. 对于双文字子句 $C_1 = (x_1 \\lor x_2)$，规则 1 产生\n$$ (x_1 \\lor x_2 \\lor d_1) \\land (x_1 \\lor x_2 \\lor \\neg d_1) $$\n2. 对于单位子句 $C_2 = (\\neg x_1)$，规则 2 产生\n$$ (\\neg x_1 \\lor d_2 \\lor d_3) \\land (\\neg x_1 \\lor d_2 \\lor \\neg d_3) \\land (\\neg x_1 \\lor \\neg d_2 \\lor d_3) \\land (\\neg x_1 \\lor \\neg d_2 \\lor \\neg d_3) $$\n3. 对于单位子句 $C_3 = (\\neg x_2)$，规则 2 产生\n$$ (\\neg x_2 \\lor d_4 \\lor d_5) \\land (\\neg x_2 \\lor d_4 \\lor \\neg d_5) \\land (\\neg x_2 \\lor \\neg d_4 \\lor d_5) \\land (\\neg x_2 \\lor \\neg d_4 \\lor \\neg d_5) $$\n\n因此，得到的 $3$-CNF 公式 $\\psi$ 是所有这些子句的合取：\n$$ \\psi = [(x_1 \\lor x_2 \\lor d_1) \\land (x_1 \\lor x_2 \\lor \\neg d_1)] \\land [(\\neg x_1 \\lor d_2 \\lor d_3) \\land (\\neg x_1 \\lor d_2 \\lor \\neg d_3) \\land (\\neg x_1 \\lor \\neg d_2 \\lor d_3) \\land (\\neg x_1 \\lor \\neg d_2 \\lor \\neg d_3)] \\land [(\\neg x_2 \\lor d_4 \\lor d_5) \\land (\\neg x_2 \\lor d_4 \\lor \\neg d_5) \\land (\\neg x_2 \\lor \\neg d_4 \\lor d_5) \\land (\\neg x_2 \\lor \\neg d_4 \\lor \\neg d_5)] $$\n\n接下来，我们分析可满足性。原始公式 $\\phi$ 是不可满足的，因为 $(\\neg x_1) \\land (\\neg x_2)$ 强制 $x_1 = \\text{假}$ 且 $x_2 = \\text{假}$，这使得 $(x_1 \\lor x_2)$ 的值为假，因此没有赋值能满足 $\\phi$ 的所有子句。\n\n所使用的转换部件（gadgets）按以下方式保持可满足性：\n- 对于一个双文字子句 $(l_1 \\lor l_2)$，被替换为 $(l_1 \\lor l_2 \\lor d) \\land (l_1 \\lor l_2 \\lor \\neg d)$，如果 $l_1 \\lor l_2$ 为真，则无论 $d$ 取何值，两个子句都满足；如果 $l_1 \\lor l_2$ 为假，则合取式变为 $d \\land \\neg d$，这是不可满足的。\n- 对于一个单位子句 $(l)$，被替换为带有两个虚拟变量的四个子句，如果 $l$ 为真，所有四个子句都满足；如果 $l$ 为假，合取式简化为\n$$ (d_a \\lor d_b) \\land (d_a \\lor \\neg d_b) \\land (\\neg d_a \\lor d_b) \\land (\\neg d_a \\lor \\neg d_b) $$\n这是不可满足的，因为没有对 $d_a, d_b$ 的赋值能同时满足所有四个子句。\n\n将此应用于我们的情况，用于 $(\\neg x_1)$ 和 $(\\neg x_2)$ 的单位子句转换部件在 $\\psi$ 的任何满足赋值中都强制 $x_1 = \\text{假}$ 且 $x_2 = \\text{假}$。在 $x_1 = \\text{假}$ 和 $x_2 = \\text{假}$ 的条件下，用于 $(x_1 \\lor x_2)$ 的转换部件变为 $(d_1) \\land (\\neg d_1)$，这是不可满足的。因此，$\\psi$ 是不可满足的。\n\n与选项比较：结构上正确的展开式 $\\psi$ 是为 $C_1$ 使用两个子句，并为 $C_2$ 和 $C_3$ 各使用四个子句的那个，并且它是不可满足的。这与选项 D 相符。", "answer": "$$\\boxed{D}$$", "id": "1410956"}]}