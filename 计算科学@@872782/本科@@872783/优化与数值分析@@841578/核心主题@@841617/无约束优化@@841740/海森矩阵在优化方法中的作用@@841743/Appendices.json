{"hands_on_practices": [{"introduction": "理解Hessian矩阵始于掌握其计算方法。本练习将引导你从一个基础问题入手：计算平方欧几里得范数的Hessian矩阵，这是一个在优化问题中，尤其是在正则化背景下，频繁出现的函数[@problem_id:2198466]。其结果的简洁性揭示了该函数在整个定义域内恒定且均匀的曲率。", "problem": "在数值优化和机器学习的背景下，分析函数的局部曲率对于设计像牛顿法这样的高效算法至关重要。这种曲率由海森矩阵（Hessian matrix）来描述。\n\n考虑一个函数 $f: \\mathbb{R}^n \\to \\mathbb{R}$，它代表了模型中一个简化的正则化项。该函数定义为向量 $x \\in \\mathbb{R}^n$ 的欧几里得范数的平方，并由一个常数因子缩放：\n$$f(x) = \\frac{1}{2}\\|x\\|^2_2$$\n其中 $\\|x\\|_2 = \\sqrt{x_1^2 + x_2^2 + \\dots + x_n^2}$ 是标准的欧几里得范数。\n\n函数 $f$ 的海森矩阵，记作 $\\nabla^2 f(x)$，是一个 $n \\times n$ 的矩阵，其第 $j$ 行第 $k$ 列的元素由二阶偏导数 $\\frac{\\partial^2 f}{\\partial x_j \\partial x_k}$ 给出。\n\n对于任意向量 $x \\in \\mathbb{R}^n$，计算函数 $f(x)$ 的海森矩阵。请用 $n \\times n$ 的单位矩阵 $I_n$ 来表示你的最终答案。", "solution": "我们从函数作为平方和的定义开始：\n$$\nf(x) = \\frac{1}{2}\\|x\\|_{2}^{2} = \\frac{1}{2}\\sum_{i=1}^{n} x_{i}^{2}.\n$$\n为了计算海森矩阵，我们首先求梯度。对于每个坐标 $x_{j}$，其偏导数为\n$$\n\\frac{\\partial f}{\\partial x_{j}} = \\frac{1}{2}\\cdot 2 x_{j} = x_{j}.\n$$\n将这些分量收集起来，梯度为\n$$\n\\nabla f(x) = \\begin{pmatrix} x_{1} \\\\ \\vdots \\\\ x_{n} \\end{pmatrix} = x.\n$$\n接下来，我们计算二阶偏导数。对于海森矩阵第 $j$ 行第 $k$ 列的元素，\n$$\n\\frac{\\partial^{2} f}{\\partial x_{j}\\,\\partial x_{k}} = \\frac{\\partial}{\\partial x_{k}}\\left(\\frac{\\partial f}{\\partial x_{j}}\\right) = \\frac{\\partial}{\\partial x_{k}}(x_{j}) = \n\\begin{cases}\n1,  \\text{if } j = k, \\\\\n0,  \\text{if } j \\neq k,\n\\end{cases}\n$$\n这可以写成克罗内克（Kronecker）delta 符号 $\\delta_{jk}$。因此，海森矩阵在对角线上为 1，非对角线上为 0，这正是 $n \\times n$ 的单位矩阵。因此，\n$$\n\\nabla^{2} f(x) = I_{n}.\n$$\n该矩阵是常数，不依赖于 $x$。", "answer": "$$\\boxed{I_{n}}$$", "id": "2198466"}, {"introduction": "Hessian矩阵的真正威力不仅在于计算，更在于它能描述函数的局部几何形态。在这个实践问题中，你将探索Hessian矩阵的代数性质（如正定性）与凸性这一几何概念之间的关键联系[@problem_id:2198477]。通过确定Hessian矩阵正定的条件，你将直接保证对应的优化问题拥有一个形态良好、碗状且具有唯一全局最小值的优化曲面。", "problem": "在数值优化领域，一个常见的任务是找到一个函数的最小值。对于一个多元二次函数 $f(\\mathbf{x}) = \\frac{1}{2}\\mathbf{x}^T H \\mathbf{x} + \\mathbf{c}^T \\mathbf{x} + d$，其中 $\\mathbf{x}$ 是一个变量的列向量，该函数是严格凸的当且仅当其 Hessian 矩阵 $H$ 是正定的。这个性质非常理想，因为它保证了任何找到的局部最小值也是唯一的全局最小值。\n\n考虑一个二维二次代价函数 $f(x_1, x_2)$，其 Hessian 矩阵由下式给出：\n$$\nH = \\begin{pmatrix} 2  k \\\\ k  8 \\end{pmatrix}\n$$\n其中 $k$ 是一个实值参数，可以在代价函数的设计过程中进行调整。\n\n确定参数 $k$ 的取值范围，使得函数 $f(x_1, x_2)$ 是严格凸的。\n\nA. $k  4$\n\nB. $k > -4$\n\nC. $-4  k  4$\n\nD. $-4 \\leq k \\leq 4$\n\nE. $k > 4$ 或 $k  -4$\n\nF. $k = \\pm 4$", "solution": "对于具有常数 Hessian 矩阵 $H$ 的二次函数 $f(\\mathbf{x})=\\frac{1}{2}\\mathbf{x}^{T}H\\mathbf{x}+\\mathbf{c}^{T}\\mathbf{x}+d$，其严格凸性等价于 $H$ 是正定的。由于 $H$ 是对称的，根据 Sylvester 判据，它为正定的当且仅当其所有顺序主子式都为正。\n\n给定\n$$\nH=\\begin{pmatrix}2  k \\\\ k  8\\end{pmatrix},\n$$\n第一个顺序主子式是\n$$\n\\Delta_{1}=2>0,\n$$\n这对所有实数 $k$ 都成立。第二个顺序主子式是行列式\n$$\n\\Delta_{2}=\\det(H)=2\\cdot 8 - k^{2}=16 - k^{2}.\n$$\n正定性要求\n$$\n16 - k^{2} > 0 \\quad \\Longleftrightarrow \\quad k^{2}  16 \\quad \\Longleftrightarrow \\quad -4  k  4.\n$$\n因此，当且仅当 $-4", "answer": "$$\\boxed{C}$$", "id": "2198477"}, {"introduction": "Hessian矩阵的性质对优化算法的效率有着深远的影响。这个更进一步的练习将理论与实践相结合，要求你分析经典梯度下降算法的收敛速度[@problem_id:2198464]。你将推导出Hessian矩阵的条件数——一个衡量函数等值线拉伸程度的指标——如何直接决定算法逼近最优解的速度。", "problem": "考虑最小化强凸二次函数 $f(x) = \\frac{1}{2}x^T Q x - b^T x$ 的问题，其中 $x, b \\in \\mathbb{R}^n$，$Q$ 是一个 $n \\times n$ 的对称正定矩阵。该函数的最小值在一个唯一的点 $x^*$ 处取得。\n\n我们应用梯度下降法来寻找这个最小值，使用迭代更新规则 $x_{k+1} = x_k - \\alpha \\nabla f(x_k)$，其中 $k$ 是迭代次数，$\\alpha$ 是一个固定的步长。设 $\\lambda_{\\min}$ 和 $\\lambda_{\\max}$ 分别是矩阵 $Q$ 的最小和最大特征值。对于此问题，我们使用特定的固定步长 $\\alpha = \\frac{2}{\\lambda_{\\min} + \\lambda_{\\max}}$。\n\n已知误差的欧几里得范数 $\\|x_k - x^*\\|_2$ 在每一步迭代中都会减小。收敛是线性的，这意味着存在一个常数 $\\rho \\in [0, 1)$，使得对于所有 $k \\ge 0$ 都有 $\\|x_{k+1} - x^*\\|_2 \\le \\rho \\|x_k - x^*\\|_2$。\n\n你的任务是确定这个收敛因子 $\\rho$ 的最紧确界。你的最终答案需要仅用矩阵 $Q$ 的条件数 $\\kappa = \\frac{\\lambda_{\\max}}{\\lambda_{\\min}}$ 来表示。", "solution": "目标函数为 $f(x) = \\frac{1}{2}x^T Q x - b^T x$。其梯度由 $\\nabla f(x) = Qx - b$ 给出。\n最优解 $x^*$ 可通过将梯度设为零求得：$\\nabla f(x^*) = Qx^* - b = 0$，这意味着 $b = Qx^*$。\n\n梯度下降的更新规则是 $x_{k+1} = x_k - \\alpha \\nabla f(x_k)$。\n代入梯度的表达式，我们得到：\n$x_{k+1} = x_k - \\alpha (Qx_k - b)$。\n\n设第 $k$ 次迭代的误差定义为 $e_k = x_k - x^*$。我们希望找到误差的递推关系。\n$e_{k+1} = x_{k+1} - x^* = (x_k - \\alpha (Qx_k - b)) - x^*$。\n代入 $b = Qx^*$:\n$e_{k+1} = x_k - \\alpha (Qx_k - Qx^*) - x^* = (x_k - x^*) - \\alpha Q(x_k - x^*)$。\n这给出了误差的更新规则：\n$e_{k+1} = (I - \\alpha Q)e_k$。\n\n为了分析在欧几里得范数下的收敛性，我们对两边取2-范数：\n$\\|e_{k+1}\\|_2 = \\|(I - \\alpha Q)e_k\\|_2$。\n使用矩阵范数的性质 $\\|Ax\\|_2 \\le \\|A\\|_2 \\|x\\|_2$，其中 $\\|A\\|_2$ 是 $A$ 的谱范数，我们得到：\n$\\|e_{k+1}\\|_2 \\le \\|I - \\alpha Q\\|_2 \\|e_k\\|_2$。\n因此，收敛因子 $\\rho$ 是迭代矩阵 $G = I - \\alpha Q$ 的谱范数。\n$\\rho = \\|I - \\alpha Q\\|_2$。\n\n由于 $Q$ 是对称矩阵，矩阵 $G = I - \\alpha Q$ 也是对称的。对称矩阵的谱范数是其特征值绝对值的最大值。\n设 $\\lambda_i$（$i=1, \\dots, n$）是 $Q$ 的特征值。由于 $Q$ 是正定的，对于所有 $i$ 都有 $0  \\lambda_{\\min} \\le \\lambda_i \\le \\lambda_{\\max}$。\n$G = I - \\alpha Q$ 的特征值是 $\\mu_i = 1 - \\alpha \\lambda_i$。\n所以，收敛因子是：\n$\\rho = \\|G\\|_2 = \\max_{i} |\\mu_i| = \\max_{i} |1 - \\alpha \\lambda_i|$。\n\n函数 $g(\\lambda) = |1 - \\alpha \\lambda|$ 在区间 $[\\lambda_{\\min}, \\lambda_{\\max}]$ 上的最大值在其中一个端点处取得。\n因此，\n$\\rho = \\max(|1 - \\alpha \\lambda_{\\min}|, |1 - \\alpha \\lambda_{\\max}|)$。\n\n问题指定了步长 $\\alpha = \\frac{2}{\\lambda_{\\min} + \\lambda_{\\max}}$。我们将这个值代入 $\\rho$ 的表达式中。\n我们来计算 maximum 函数中的两项。\n第一项：\n$1 - \\alpha \\lambda_{\\min} = 1 - \\frac{2\\lambda_{\\min}}{\\lambda_{\\min} + \\lambda_{\\max}} = \\frac{(\\lambda_{\\min} + \\lambda_{\\max}) - 2\\lambda_{\\min}}{\\lambda_{\\min} + \\lambda_{\\max}} = \\frac{\\lambda_{\\max} - \\lambda_{\\min}}{\\lambda_{\\max} + \\lambda_{\\min}}$。\n第二项：\n$1 - \\alpha \\lambda_{\\max} = 1 - \\frac{2\\lambda_{\\max}}{\\lambda_{\\min} + \\lambda_{\\max}} = \\frac{(\\lambda_{\\min} + \\lambda_{\\max}) - 2\\lambda_{\\max}}{\\lambda_{\\min} + \\lambda_{\\max}} = \\frac{\\lambda_{\\min} - \\lambda_{\\max}}{\\lambda_{\\min} + \\lambda_{\\max}} = - \\frac{\\lambda_{\\max} - \\lambda_{\\min}}{\\lambda_{\\max} + \\lambda_{\\min}}$。\n\n这两项的绝对值相等：\n$|1 - \\alpha \\lambda_{\\min}| = |1 - \\alpha \\lambda_{\\max}| = \\frac{\\lambda_{\\max} - \\lambda_{\\min}}{\\lambda_{\\max} + \\lambda_{\\min}}$。\n因此，收敛因子是：\n$\\rho = \\frac{\\lambda_{\\max} - \\lambda_{\\min}}{\\lambda_{\\max} + \\lambda_{\\min}}$。\n\n最后，我们需要用条件数 $\\kappa = \\frac{\\lambda_{\\max}}{\\lambda_{\\min}}$ 来表示这个结果。为此，我们将 $\\rho$ 表达式的分子和分母同时除以 $\\lambda_{\\min}$（它是一个严格的正数）：\n$\\rho = \\frac{\\frac{\\lambda_{\\max}}{\\lambda_{\\min}} - \\frac{\\lambda_{\\min}}{\\lambda_{\\min}}}{\\frac{\\lambda_{\\max}}{\\lambda_{\\min}} + \\frac{\\lambda_{\\min}}{\\lambda_{\\min}}} = \\frac{\\kappa - 1}{\\kappa + 1}$。\n\n对于给定的步长，这是收敛因子 $\\rho$ 的最紧确界。", "answer": "$$\\boxed{\\frac{\\kappa - 1}{\\kappa + 1}}$$", "id": "2198464"}]}