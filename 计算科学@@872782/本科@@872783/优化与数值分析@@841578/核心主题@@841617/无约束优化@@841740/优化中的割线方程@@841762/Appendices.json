{"hands_on_practices": [{"introduction": "在应用或验证割线方程之前，我们必须首先熟练计算其核心组成部分：步长向量 $s_k$ 和梯度差向量 $y_k$。这个练习将带你针对一个简单的二次函数，亲手计算这些向量，并引出重要的曲率条件 $y_k^T s_k$，这是理解拟牛顿法中 Hessian 矩阵更新的关键第一步。", "problem": "在无约束优化的拟牛顿法发展中，Hessian矩阵的近似在每一步都会被更新。这种更新依赖于从最近一步收集到的信息。计算两个关键向量：步长向量 $s_k = x_{k+1} - x_k$，它表示变量向量的变化；以及梯度差向量 $y_k = \\nabla f(x_{k+1}) - \\nabla f(x_k)$，它捕捉了目标函数 $f$ 梯度的变化。这两个向量之间的关系构成了割线方程的基础。\n\n考虑二次目标函数 $f(x_1, x_2) = x_1^2 + 2x_2^2$。一个优化算法从列向量 $x_k = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$ 所描述的点，移动一步到点 $x_{k+1} = \\begin{pmatrix} 2 \\\\ 0 \\end{pmatrix}$。\n\n计算内积 $y_k^T s_k$ 的标量值。", "solution": "我们使用标准的拟牛顿法定义：步长向量为 $s_{k} = x_{k+1} - x_{k}$，梯度差向量为 $y_{k} = \\nabla f(x_{k+1}) - \\nabla f(x_{k})$。对于 $f(x_{1},x_{2}) = x_{1}^{2} + 2 x_{2}^{2}$，其梯度为\n$$\n\\nabla f(x_{1},x_{2}) = \\begin{pmatrix} \\frac{\\partial f}{\\partial x_{1}} \\\\ \\frac{\\partial f}{\\partial x_{2}} \\end{pmatrix} = \\begin{pmatrix} 2 x_{1} \\\\ 4 x_{2} \\end{pmatrix}.\n$$\n已知 $x_{k} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$ 和 $x_{k+1} = \\begin{pmatrix} 2 \\\\ 0 \\end{pmatrix}$，计算\n$$\ns_{k} = x_{k+1} - x_{k} = \\begin{pmatrix} 2 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}.\n$$\n计算梯度：\n$$\n\\nabla f(x_{k}) = \\begin{pmatrix} 2 \\cdot 1 \\\\ 4 \\cdot 1 \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ 4 \\end{pmatrix}, \\quad\n\\nabla f(x_{k+1}) = \\begin{pmatrix} 2 \\cdot 2 \\\\ 4 \\cdot 0 \\end{pmatrix} = \\begin{pmatrix} 4 \\\\ 0 \\end{pmatrix}.\n$$\n因此\n$$\ny_{k} = \\nabla f(x_{k+1}) - \\nabla f(x_{k}) = \\begin{pmatrix} 4 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 2 \\\\ 4 \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ -4 \\end{pmatrix}.\n$$\n所求的内积为\n$$\ny_{k}^{T} s_{k} = \\begin{pmatrix} 2  -4 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} = 2 \\cdot 1 + (-4) \\cdot (-1) = 2 + 4 = 6.\n$$", "answer": "$$\\boxed{6}$$", "id": "2220248"}, {"introduction": "掌握了如何计算 $s_k$ 和 $y_k$ 之后，下一步是理解它们如何通过完整的割线方程 $B_{k+1}s_k = y_k$ 与 Hessian 近似矩阵 $B_{k+1}$ 相关联。这个练习 [@problem_id:2220287] 提供了一个逆向思维的挑战：你需要通过调整目标函数中的一个参数，来使得一个给定的 Hessian 近似矩阵满足割线方程，从而加深对函数、迭代步和 Hessian 近似这三者之间内在联系的理解。", "problem": "在数值优化的拟牛顿法中，在每次迭代中都会更新海森矩阵的一个近似矩阵，记为 $B_{k+1}$。该矩阵必须满足的一个基本性质是割线方程，它建立了位置变化与目标函数梯度变化之间的关系。\n\n设目标函数为 $f(x_1, x_2) = \\alpha x_1^2 + x_1 x_2 + x_2^2$，其中变量向量为 $x = \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix}$，$\\alpha$ 是一个常数参数。一个优化算法从迭代 $k$ 进行到 $k+1$，给出的点为 $x_k = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$ 和 $x_{k+1} = \\begin{pmatrix} 2 \\\\ 3 \\end{pmatrix}$。\n\n割线方程定义为 $B_{k+1} s_k = y_k$，其中步长向量为 $s_k = x_{k+1} - x_k$，梯度差向量为 $y_k = \\nabla f(x_{k+1}) - \\nabla f(x_k)$。\n\n如果在更新中使用的海森矩阵近似为一个常数矩阵 $B_{k+1} = \\begin{pmatrix} 4  1 \\\\ 1  2 \\end{pmatrix}$，那么为了满足割线方程，参数 $\\alpha$ 必须取什么值？", "solution": "目标是找到满足割线方程 $B_{k+1} s_k = y_k$ 的参数 $\\alpha$ 的值。我们将逐步计算此方程中的每一项。\n\n首先，我们计算步长向量 $s_k = x_{k+1} - x_k$。题目给出了两个连续迭代的向量：\n$x_k = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$ 和 $x_{k+1} = \\begin{pmatrix} 2 \\\\ 3 \\end{pmatrix}$。\n将这两个向量相减，我们得到：\n$$s_k = x_{k+1} - x_k = \\begin{pmatrix} 2 \\\\ 3 \\end{pmatrix} - \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 2-1 \\\\ 3-1 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}$$\n\n接下来，我们计算梯度差向量 $y_k = \\nabla f(x_{k+1}) - \\nabla f(x_k)$。为此，我们首先需要求出目标函数 $f(x_1, x_2) = \\alpha x_1^2 + x_1 x_2 + x_2^2$ 的梯度。\n$f$ 的偏导数是：\n$\\frac{\\partial f}{\\partial x_1} = 2\\alpha x_1 + x_2$\n$\\frac{\\partial f}{\\partial x_2} = x_1 + 2x_2$\n所以，梯度向量 $\\nabla f(x)$ 是：\n$$\\nabla f(x) = \\begin{pmatrix} 2\\alpha x_1 + x_2 \\\\ x_1 + 2x_2 \\end{pmatrix}$$\n\n现在我们在点 $x_k$ 和 $x_{k+1}$ 处计算梯度。\n在 $x_k = (1, 1)^T$ 处：\n$$\\nabla f(x_k) = \\nabla f(1, 1) = \\begin{pmatrix} 2\\alpha(1) + 1 \\\\ 1 + 2(1) \\end{pmatrix} = \\begin{pmatrix} 2\\alpha + 1 \\\\ 3 \\end{pmatrix}$$\n在 $x_{k+1} = (2, 3)^T$ 处：\n$$\\nabla f(x_{k+1}) = \\nabla f(2, 3) = \\begin{pmatrix} 2\\alpha(2) + 3 \\\\ 2 + 2(3) \\end{pmatrix} = \\begin{pmatrix} 4\\alpha + 3 \\\\ 8 \\end{pmatrix}$$\n\n现在我们可以计算梯度差向量 $y_k$：\n$$y_k = \\nabla f(x_{k+1}) - \\nabla f(x_k) = \\begin{pmatrix} 4\\alpha + 3 \\\\ 8 \\end{pmatrix} - \\begin{pmatrix} 2\\alpha + 1 \\\\ 3 \\end{pmatrix} = \\begin{pmatrix} (4\\alpha + 3) - (2\\alpha + 1) \\\\ 8 - 3 \\end{pmatrix} = \\begin{pmatrix} 2\\alpha + 2 \\\\ 5 \\end{pmatrix}$$\n\n割线方程为 $B_{k+1} s_k = y_k$。我们有矩阵 $B_{k+1} = \\begin{pmatrix} 4  1 \\\\ 1  2 \\end{pmatrix}$，并且已经计算出了 $s_k$ 和 $y_k$。我们来计算方程的左侧：\n$$B_{k+1} s_k = \\begin{pmatrix} 4  1 \\\\ 1  2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} 4(1) + 1(2) \\\\ 1(1) + 2(2) \\end{pmatrix} = \\begin{pmatrix} 4 + 2 \\\\ 1 + 4 \\end{pmatrix} = \\begin{pmatrix} 6 \\\\ 5 \\end{pmatrix}$$\n\n最后，我们将割线方程的左侧和右侧相等：\n$B_{k+1} s_k = y_k$\n$$\\begin{pmatrix} 6 \\\\ 5 \\end{pmatrix} = \\begin{pmatrix} 2\\alpha + 2 \\\\ 5 \\end{pmatrix}$$\n要使这两个向量相等，它们对应的分量必须相等。这给了我们一个由两个线性方程组成的方程组：\n1) $6 = 2\\alpha + 2$\n2) $5 = 5$\n\n第二个方程是恒等式 $5=5$，这证实了我们的设置是一致的。我们求解第一个方程以得到 $\\alpha$：\n$6 = 2\\alpha + 2$\n$6 - 2 = 2\\alpha$\n$4 = 2\\alpha$\n$\\alpha = \\frac{4}{2} = 2$\n\n因此，为了满足割线方程，参数 $\\alpha$ 必须为 2。", "answer": "$$\\boxed{2}$$", "id": "2220287"}, {"introduction": "在拟牛顿法中，割线方程的根本作用是为更新 Hessian 近似矩阵提供约束。这个练习 [@problem_id:2220301] 将展示方程 $B s_k = y_k$ 如何转化为关于矩阵 $B$ 中未知元素的一组线性方程。通过为一个具有特定对称结构的矩阵 $B$ 求解其组成元素，你可以直观地看到在实践中是如何利用割线方程来构造或筛选合适的 Hessian 近似矩阵的。", "problem": "在用于寻找函数局部最小值或最大值的拟牛頓法中，Hessian矩阵在每次迭代 $k$ 时通过一个矩阵 $B_k$ 来近似，该矩阵在每次迭代中都会更新。这种近似的一个基本要求是它必须满足割线方程 $B_{k+1} s_k = y_k$。此处，$s_k = x_{k+1} - x_k$ 表示在变量空间中采取的步长，而 $y_k = \\nabla f(x_{k+1}) - \\nabla f(x_k)$ 是函数 $f$ 梯度的相应变化。\n\n考虑这样一个二维优化算法的单步。步长向量为 $s_k = \\begin{pmatrix} 1 \\\\ 3 \\end{pmatrix}$，梯度的变化为 $y_k = \\begin{pmatrix} 2 \\\\ -1 \\end{pmatrix}$。对于这个问题，我们寻找一个Hessian近似矩阵，我们将其简称为 $B$，它具有 $B = \\begin{pmatrix} a  b \\\\ b  a \\end{pmatrix}$ 形式的特殊对称结构，其中 $a$ 和 $b$ 是实常数。\n\n确定使矩阵 $B$ 对于给定的 $s_k$ 和 $y_k$ 满足割线方程的 $a$ 和 $b$ 的唯一值。请将您的答案表示为有序对 $(a, b)$。", "solution": "我们必须找到实数 $a$ 和 $b$，使得对称矩阵 $B=\\begin{pmatrix} a  b \\\\ b  a \\end{pmatrix}$ 在 $s_{k}=\\begin{pmatrix} 1 \\\\ 3 \\end{pmatrix}$ 和 $y_{k}=\\begin{pmatrix} 2 \\\\ -1 \\end{pmatrix}$ 的条件下满足割线方程 $B s_{k} = y_{k}$。\n\n计算矩阵向量乘积：\n$$\nB s_{k} = \\begin{pmatrix} a  b \\\\ b  a \\end{pmatrix}\\begin{pmatrix} 1 \\\\ 3 \\end{pmatrix}\n= \\begin{pmatrix} a + 3b \\\\ b + 3a \\end{pmatrix}.\n$$\n应用割线方程 $B s_{k} = y_{k}$ 可得\n$$\n\\begin{pmatrix} a + 3b \\\\ b + 3a \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ -1 \\end{pmatrix},\n$$\n这就得到了线性方程组\n$$\na + 3b = 2, \\quad 3a + b = -1.\n$$\n使用代入法求解。从 $a + 3b = 2$ 可得 $a = 2 - 3b$。将其代入 $3a + b = -1$：\n$$\n3(2 - 3b) + b = -1 \\implies 6 - 9b + b = -1 \\implies 6 - 8b = -1 \\implies -8b = -7 \\implies b = \\frac{7}{8}.\n$$\n然后\n$$\na = 2 - 3\\cdot \\frac{7}{8} = \\frac{16}{8} - \\frac{21}{8} = -\\frac{5}{8}.\n$$\n系数矩阵 $\\begin{pmatrix} 1  3 \\\\ 3  1 \\end{pmatrix}$ 的行列式为 $1\\cdot 1 - 3\\cdot 3 = -8 \\neq 0$，因此解是唯一的。所以，所求参数为 $a=-\\frac{5}{8}$ 和 $b=\\frac{7}{8}$。", "answer": "$$\\boxed{\\left(-\\frac{5}{8}, \\frac{7}{8}\\right)}$$", "id": "2220301"}]}