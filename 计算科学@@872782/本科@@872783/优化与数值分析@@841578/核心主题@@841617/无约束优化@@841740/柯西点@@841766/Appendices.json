{"hands_on_practices": [{"introduction": "掌握柯西点的计算是理解信赖域方法的基石。这个练习将带你完成一个标准情景下的完整计算：沿着最速下降方向，最小化一个二次模型函数。通过这个过程，你将学会如何确定最优步长，并检查该步长是否位于信赖域半径所定义的边界之内，这是求解柯西点的核心步骤。[@problem_id:2209928]", "problem": "在无约束优化的信赖域方法中，目标函数在每次迭代 $k$ 时被一个二次模型 $m_k(p)$ 近似。下一步 $p$ 是通过在“信赖域”内最小化这个模型来找到的，该信赖域通常是一个以当前点为中心、半径为 $\\Delta_k$ 的球。许多信赖域算法中的一个关键步骤是找到柯西点 (Cauchy point)，它是沿着受信赖域约束的最速下降方向的最小化问题的解。\n\n考虑一个二维优化问题，其中在当前迭代 $k$ 处的二次模型由下式给出：\n$$m_k(p) = f_k + g_k^T p + \\frac{1}{2} p^T B_k p$$\n这里，$p \\in \\mathbb{R}^2$ 是从当前位置出发的步长，$f_k$ 是函数值，$g_k$ 是梯度向量，$B_k$ 是Hessian矩阵的对称近似。用于信赖域的范数是标准的欧几里得范数 $\\|p\\|_2$。\n\n在某次特定的迭代中，已知以下值：\n- 梯度向量：$g_k = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$\n- 对称Hessian近似矩阵：$B_k = \\begin{pmatrix} 2  0 \\\\ 0  3 \\end{pmatrix}$\n- 信赖域半径：$\\Delta_k = 5$\n\n计算本次迭代的柯西点 $p_k^C$。将答案的分量表示为精确分数。", "solution": "在信赖域方法中，柯西点是二次模型在受信赖域半径约束的最速下降方向上的最小化子。将沿负梯度方向的步长参数化为 $p=-\\alpha g_{k}$，其中 $\\alpha \\ge 0$。代入模型中，我们得到\n$$\nm_{k}(-\\alpha g_{k})=f_{k}-\\alpha \\|g_{k}\\|_{2}^{2}+\\frac{1}{2}\\alpha^{2} g_{k}^{T} B_{k} g_{k}\n$$\n定义 $\\phi(\\alpha)=m_{k}(-\\alpha g_{k})$。其导数为\n$$\n\\phi'(\\alpha)=-\\|g_{k}\\|_{2}^{2}+\\alpha g_{k}^{T} B_{k} g_{k}\n$$\n沿该射线的无约束最小化子满足 $\\phi'(\\alpha)=0$，从而得到\n$$\n\\alpha^{\\ast}=\\frac{\\|g_{k}\\|_{2}^{2}}{g_{k}^{T} B_{k} g_{k}},\n$$\n条件是 $g_{k}^{T} B_{k} g_{k}0$。当 $g_{k}=\\begin{pmatrix}1 \\\\ 1\\end{pmatrix}$ 且 $B_{k}=\\begin{pmatrix}2  0 \\\\ 0  3\\end{pmatrix}$ 时，我们计算\n$$\n\\|g_{k}\\|_{2}^{2}=g_{k}^{T} g_{k}=1^{2}+1^{2}=2,\\qquad g_{k}^{T} B_{k} g_{k}=\\begin{pmatrix}1  1\\end{pmatrix}\\begin{pmatrix}2  0 \\\\ 0  3\\end{pmatrix}\\begin{pmatrix}1 \\\\ 1\\end{pmatrix}=2+3=5.\n$$\n因此\n$$\n\\alpha^{\\ast}=\\frac{2}{5}.\n$$\n信赖域约束要求 $\\alpha \\leq \\Delta_{k}/\\|g_{k}\\|_{2}$。在本例中，\n$$\n\\frac{\\Delta_{k}}{\\|g_{k}\\|_{2}}=\\frac{5}{\\sqrt{2}},\n$$\n并且由于 $\\frac{2}{5}  \\frac{5}{\\sqrt{2}}$，信赖域边界是不起作用的。因此，柯西点等于沿 $-g_{k}$ 方向的无约束最小化子：\n$$\np_{k}^{C}=-\\alpha^{\\ast} g_{k}=-\\frac{2}{5}\\begin{pmatrix}1 \\\\ 1\\end{pmatrix}=\\begin{pmatrix}-\\frac{2}{5} \\\\ -\\frac{2}{5}\\end{pmatrix}.\n$$\n表示为精确分数，其分量为 $-\\frac{2}{5}$ 和 $-\\frac{2}{5}$。", "answer": "$$\\boxed{\\begin{pmatrix} -\\frac{2}{5} \\\\ -\\frac{2}{5} \\end{pmatrix}}$$", "id": "2209928"}, {"introduction": "柯西点的求解策略分为两种情况：解位于信赖域内部，或在信赖域边界上。这两种情况的临界点由信赖域半径 $\\Delta_k$ 的一个特定值决定。本练习旨在让你通过计算找到这个关键的“临界半径”，从而深化你对信赖域约束如何影响最优化步骤的几何直观理解。[@problem_id:2209918]", "problem": "在用于数值优化的信赖域方法中，函数 $f(x)$ 在一个迭代点 $x_k$ 处被一个二次模型 $m_k(p)$ 近似：\n$$m_k(p) = f(x_k) + g_k^T p + \\frac{1}{2} p^T B_k p$$\n这里，$p$ 是从 $x_k$ 出发的步，$g_k$ 是 $f$ 在 $x_k$ 处的梯度，$B_k$ 是 $f$ 在 $x_k$ 处的 Hessian 矩阵的一个近似。步 $p$ 是通过在由 $\\|p\\|_2 \\le \\Delta_k$ 定义的信赖域内最小化 $m_k(p)$ 来找到的，其中 $\\Delta_k > 0$ 是信赖域半径。\n\n该方法的一个基本组成部分是计算柯西点 $p_k^C$。该点被定义为二次模型 $m_k(p)$ 沿着最速下降方向 $p(\\tau) = -\\tau g_k$（对于 $\\tau > 0$）在信赖域约束下的极小值点。\n\n考虑一个具体的迭代，其中梯度为 $g_k = \\begin{pmatrix} 3 \\\\ -4 \\end{pmatrix}$，Hessian 近似矩阵为 $B_k = \\begin{pmatrix} 2  1 \\\\ 1  3 \\end{pmatrix}$。\n\n确定信赖域半径 $\\Delta_k$ 的精确值，该值是两种情况之间的边界：一种情况是柯西点通过沿最速下降方向的无约束最小化找到，另一种情况是它受到信赖域边界的限制。将您的答案表示为一个精确的分数。", "solution": "我们考虑二次模型 $m_{k}(p)=f(x_{k})+g_{k}^{T}p+\\frac{1}{2}p^{T}B_{k}p$ 并将其限制在最速下降射线 $p(\\tau)=-\\tau g_{k}$（其中 $\\tau>0$）上。沿着这条射线，\n$$\nm_{k}(-\\tau g_{k})=f(x_{k})-\\tau\\,g_{k}^{T}g_{k}+\\frac{1}{2}\\tau^{2}\\,g_{k}^{T}B_{k}g_{k}.\n$$\n沿射线的无约束极小值点是通过将关于 $\\tau$ 的导数设为零来获得的：\n$$\n\\frac{\\mathrm{d}}{\\mathrm{d}\\tau}m_{k}(-\\tau g_{k})=-g_{k}^{T}g_{k}+\\tau\\,g_{k}^{T}B_{k}g_{k}=0,\n$$\n这得到\n$$\n\\tau_{\\ast}=\\frac{g_{k}^{T}g_{k}}{g_{k}^{T}B_{k}g_{k}}.\n$$\n相应的无约束步是 $p_{\\ast}=-\\tau_{\\ast}g_{k}$，其范数为\n$$\n\\|p_{\\ast}\\|_{2}=\\tau_{\\ast}\\|g_{k}\\|_{2}.\n$$\n当且仅当 $\\|p_{\\ast}\\|_{2}\\leq\\Delta_{k}$ 时，信赖域柯西点等于这个沿射线的无约束极小值点。因此，无约束情况和受信赖域限制情况之间的边界是\n$$\n\\Delta_{k}^{\\text{boundary}}=\\|p_{\\ast}\\|_{2}=\\tau_{\\ast}\\|g_{k}\\|_{2}.\n$$\n给定 $g_{k}=\\begin{pmatrix}3\\\\-4\\end{pmatrix}$ 和 $B_{k}=\\begin{pmatrix}2  1\\\\1  3\\end{pmatrix}$，计算\n$$\ng_{k}^{T}g_{k}=3^{2}+(-4)^{2}=9+16=25,\n$$\n$$\nB_{k}g_{k}=\\begin{pmatrix}2  1\\\\1  3\\end{pmatrix}\\begin{pmatrix}3\\\\-4\\end{pmatrix}=\\begin{pmatrix}2\\cdot 3+1\\cdot(-4)\\\\1\\cdot 3+3\\cdot(-4)\\end{pmatrix}=\\begin{pmatrix}2\\\\-9\\end{pmatrix},\n$$\n$$\ng_{k}^{T}B_{k}g_{k}= \\begin{pmatrix}3  -4\\end{pmatrix}\\begin{pmatrix}2\\\\-9\\end{pmatrix}=3\\cdot 2+(-4)\\cdot(-9)=6+36=42,\n$$\n和\n$$\n\\|g_{k}\\|_{2}=\\sqrt{25}=5.\n$$\n因此\n$$\n\\tau_{\\ast}=\\frac{25}{42},\\qquad \\Delta_{k}^{\\text{boundary}}=\\tau_{\\ast}\\|g_{k}\\|_{2}=\\frac{25}{42}\\cdot 5=\\frac{125}{42}.\n$$\n因此，两种情况边界处的精确信赖域半径为 $\\frac{125}{42}$。", "answer": "$$\\boxed{\\frac{125}{42}}$$", "id": "2209918"}, {"introduction": "在最优化中，梯度为零的点是特殊且重要的，它标志着一个驻点（stationary point）。本练习探讨了在这种特殊情况下柯西点的行为。通过分析梯度为零时的情景，你将加深对最速下降方向定义的理解，并认识到柯西点在一阶最优性条件满足时的理论意义。[@problem_id:2209943]", "problem": "在无约束优化的背景下，信赖域方法围绕当前迭代点 $x_k$ 迭代地构建目标函数的模型，并寻找一个步长 $p$ 以在给定的信赖域半径 $\\Delta_k$ 内最小化此模型。一个常见的模型是二次函数：\n$$\nm_k(p) = f_k + g_k^T p + \\frac{1}{2} p^T B_k p\n$$\n其中 $f_k = f(x_k)$ 是目标函数值，$g_k = \\nabla f(x_k)$ 是梯度向量，$B_k$ 是一个近似 $f$ 的Hessian矩阵的对称矩阵。步长 $p$ 通过求解子问题 $\\min_{\\|p\\| \\le \\Delta_k} m_k(p)$ 得到。\n\n柯西点，记为 $p_k^C$，是一个潜在的步长，定义为二次模型 $m_k(p)$ 沿着最速下降方向 $-g_k$ 且满足信赖域约束的最小化子。也就是说，$p_k^C$ 是对于路径 $\\{-\\tau g_k \\mid \\tau > 0, \\|-\\tau g_k\\| \\le \\Delta_k\\}$ 上的 $p$ 求解 $\\min m_k(p)$ 的解。\n\n考虑一个特定的迭代点 $k$，在该点目标函数的梯度为零向量，即 $g_k = 0$。对于这个特殊情况，确定柯西点向量的范数 $\\|p_k^C\\|$ 以及相应的预测模型下降量的值，该下降量定义为差值 $m_k(0) - m_k(p_k^C)$。\n\n将您的答案表示为一个包含两个数值的行矩阵：柯西点的范数和预测模型下降量，按此顺序排列。", "solution": "我们已知二次信赖域模型\n$$\nm_k(p) = f_k + g_k^{T}p + \\frac{1}{2}p^{T}B_k p,\n$$\n并且柯西点 $p_k^{C}$ 定义为 $m_k(p)$ 沿着路径 $\\{-\\tau g_k \\mid \\tau > 0, \\|-\\tau g_k\\| \\le \\Delta_k\\}$ 的最小化子。\n\n在所考虑的迭代点，$g_k = 0$。那么对于任何 $\\tau > 0$，路径简化为单点集\n$$\n-\\tau g_k = 0,\n$$\n因此柯西路径上唯一的候选点是 $p = 0$。所以，\n$$\np_k^{C} = 0 \\quad \\Rightarrow \\quad \\|p_k^{C}\\| = 0.\n$$\n接下来，计算预测模型下降量。我们有\n$$\nm_k(0) = f_k + g_k^{T}0 + \\frac{1}{2}0^{T}B_k 0 = f_k,\n$$\n并且因为 $p_k^{C} = 0$，\n$$\nm_k(p_k^{C}) = m_k(0) = f_k.\n$$\n因此预测下降量为\n$$\nm_k(0) - m_k(p_k^{C}) = f_k - f_k = 0.\n$$\n因此，柯西点的范数为 $0$，预测模型下降量为 $0$。", "answer": "$$\\boxed{\\begin{pmatrix}0  0\\end{pmatrix}}$$", "id": "2209943"}]}