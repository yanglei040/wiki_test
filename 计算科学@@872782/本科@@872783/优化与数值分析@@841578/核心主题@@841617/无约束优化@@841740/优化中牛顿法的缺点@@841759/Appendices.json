{"hands_on_practices": [{"introduction": "牛顿法功能强大，但它并非全局收敛，这意味着一个糟糕的初始猜测可能导致失败。本实践练习将展示一个经典的“发散”案例：对于一个简单的凸函数，迭代点会离最小值越来越远[@problem_id:2167231]。理解这种行为是学习如何稳健地使用牛顿法的第一步。", "problem": "在一个计算光学设计工具中，一个算法试图找到传感器上的位置 $x$，以最小化一个与光学像差相关的成本函数。该成本的一个简化模型由函数 $f(x) = \\sqrt{L^2 + x^2}$ 给出，其中 $L$ 是光学系统的一个固定的正特征长度。\n\n该算法使用牛顿优化法来找到 $f(x)$ 的最小值。该方法从一个初始猜测值 $x_0$ 开始，并使用以下迭代公式生成一系列估计值：\n$$x_{n+1} = x_n - \\frac{f'(x_n)}{f''(x_n)}$$\n其中 $f'(x)$ 和 $f''(x)$ 分别是 $f(x)$ 关于 $x$ 的一阶和二阶导数。\n\n现使用初始猜测值 $x_0 = \\sqrt{2}L$ 进行一次测试。计算该算法生成的第四个估计值 $x_4$。答案用 $L$ 表示。", "solution": "给定函数 $f(x) = \\sqrt{L^{2} + x^{2}}$（其中 $L>0$）和牛顿优化法\n$$\nx_{n+1} = x_{n} - \\frac{f'(x_{n})}{f''(x_{n})}.\n$$\n首先计算导数：\n$$\nf'(x) = \\frac{x}{\\sqrt{L^{2} + x^{2}}},\n$$\n$$\nf''(x) = \\frac{d}{dx}\\left(x\\left(L^{2}+x^{2}\\right)^{-\\frac{1}{2}}\\right) = \\left(L^{2}+x^{2}\\right)^{-\\frac{1}{2}} - x^{2}\\left(L^{2}+x^{2}\\right)^{-\\frac{3}{2}} = \\frac{L^{2}}{\\left(L^{2}+x^{2}\\right)^{\\frac{3}{2}}}.\n$$\n因此\n$$\n\\frac{f'(x)}{f''(x)} = \\frac{\\frac{x}{\\sqrt{L^{2}+x^{2}}}}{\\frac{L^{2}}{(L^{2}+x^{2})^{\\frac{3}{2}}}} = x\\cdot\\frac{L^{2}+x^{2}}{L^{2}}.\n$$\n因此，牛顿法的更新公式简化为\n$$\nx_{n+1} = x_{n} - x_{n}\\frac{L^{2}+x_{n}^{2}}{L^{2}} = -\\frac{x_{n}^{3}}{L^{2}}.\n$$\n从 $x_{0} = \\sqrt{2}\\,L$ 开始，迭代计算：\n$$\nx_{1} = -\\frac{x_{0}^{3}}{L^{2}} = -\\frac{\\left(\\sqrt{2}\\,L\\right)^{3}}{L^{2}} = -2^{\\frac{3}{2}}L,\n$$\n$$\nx_{2} = -\\frac{x_{1}^{3}}{L^{2}} = -\\frac{\\left(-2^{\\frac{3}{2}}L\\right)^{3}}{L^{2}} = 2^{\\frac{9}{2}}L,\n$$\n$$\nx_{3} = -\\frac{x_{2}^{3}}{L^{2}} = -\\frac{\\left(2^{\\frac{9}{2}}L\\right)^{3}}{L^{2}} = -2^{\\frac{27}{2}}L,\n$$\n$$\nx_{4} = -\\frac{x_{3}^{3}}{L^{2}} = -\\frac{\\left(-2^{\\frac{27}{2}}L\\right)^{3}}{L^{2}} = 2^{\\frac{81}{2}}L.\n$$\n因此，第四个估计值为 $x_{4} = 2^{\\frac{81}{2}}L$。", "answer": "$$\\boxed{2^{\\frac{81}{2}}L}$$", "id": "2167231"}, {"introduction": "牛顿法的主要吸引力在于其快速的二次收敛速度。然而，这种速度是有条件的，它依赖于最小值点处的二阶导数不为零的假设。本练习将探讨当此条件被违反时会发生什么，展示收敛速度如何退化为仅仅是线性的，这是一个显著的性能缺陷[@problem_id:2167211]。", "problem": "一个优化算法被用来寻找使函数 $f(x) = \\alpha x^4$ 最小化的 $x$ 值，其中 $\\alpha$ 是一个正常量。该算法使用牛顿法进行优化，从一个初始猜测 $x_0$ 开始，生成一个估计序列 $\\{x_k\\}$，其中 $k=0, 1, 2, \\dots$。其更新规则由下式给出：\n$$x_{k+1} = x_k - \\frac{f'(x_k)}{f''(x_k)}$$\n其中 $f'(x)$ 和 $f''(x)$ 分别是 $f(x)$ 关于 $x$ 的一阶和二阶导数。\n\n假设初始猜测 $x_0$ 不等于零。已知该算法收敛到 $x=0$ 处的最小值。为了描述此收敛的速度，请确定以下极限的精确值：\n$$L = \\lim_{k \\to \\infty} \\frac{|x_{k+1}|}{|x_k|}$$\n您的最终答案应以精确分数的形式给出。", "solution": "我们已知函数 $f(x) = \\alpha x^{4}$，其中 $\\alpha > 0$。使用标准求导法则计算其一阶和二阶导数：\n$$f'(x) = 4\\alpha x^{3}, \\quad f''(x) = 12\\alpha x^{2}.$$\n用于优化的牛顿法通过以下方式更新 $x_{k}$：\n$$x_{k+1} = x_{k} - \\frac{f'(x_{k})}{f''(x_{k})}.$$\n将导数代入更新规则，对于 $x_{k} \\neq 0$ 可得，\n$$x_{k+1} = x_{k} - \\frac{4\\alpha x_{k}^{3}}{12\\alpha x_{k}^{2}} = x_{k} - \\frac{1}{3}x_{k} = \\frac{2}{3}x_{k}.$$\n因此，在每次迭代中，\n$$\\frac{|x_{k+1}|}{|x_{k}|} = \\left|\\frac{2}{3}\\right| = \\frac{2}{3}.$$\n对于所有的 $k$（只要 $x_k \\neq 0$），这个量都是一个常数，并且序列以 $\\frac{2}{3}$ 的速率线性收敛到 $x=0$。因此，极限为\n$$L = \\lim_{k \\to \\infty} \\frac{|x_{k+1}|}{|x_{k}|} = \\frac{2}{3}.$$", "answer": "$$\\boxed{\\frac{2}{3}}$$", "id": "2167211"}, {"introduction": "现在我们从理论上的缺陷转向计算中的实际问题。理论上，牛顿法只需一步就能找到二次函数的最小值。本问题将阐明计算机的有限精度算术会如何破坏这种理想性能，导致一种“停滞”现象，即算法在接近但未精确达到真正最小值时就停止了[@problem_id:2167170]。", "problem": "理论上，牛顿优化法对于二次函数非常高效。对于一个通用的一维二次函数 $f(x) = \\frac{1}{2}ax^2 + bx + c$（其中 $a0$），该方法无论初始点如何，都会在单次迭代中收敛到精确的极小值点。\n\n然而，在实践中，计算机算术的有限精度可能会引入一些人为现象，导致算法无法按预期执行。考虑使用一台假想的计算机来最小化函数 $g(x) = \\frac{1}{2}x^2 - (\\ln 10) x$。该函数的真实最小值点位于 $x^* = \\ln 10$。\n\n这台计算机有以下规格：它使用一个维持5位有效数字的十进制浮点系统来表示所有数字并执行所有算术运算。为了处理需要超过5位有效数字的数，计算机使用“舍位”法（即，它简单地截断第五位有效数字之后的所有数字）。对于本问题，使用近似值 $\\ln 10 \\approx 2.30258509...$。\n\n这个优化程序是牛顿法的一个实现，其设计是在机器计算出的梯度值 $g'(x)$ 精确为零时停止。由于舍位行为，存在一个连续的实数区间 $I = [x_{\\text{low}}, x_{\\text{high}})$ ，使得对于该区间中的任意点 $x \\in I$， $x$ 的浮点表示与真实最小值点 $x^*$ 的浮点表示完全相同。这导致对于此区间内的任何 $x$，机器计算出的梯度都为零，从而使算法过早停滞。\n\n计算这个“停滞区间”的宽度，定义为 $x_{\\text{high}} - x_{\\text{low}}$。请以单个数值形式提供您的答案。", "solution": "我们考虑函数 $g(x) = \\frac{1}{2}x^{2} - (\\ln 10)\\,x$，其导数为 $g'(x) = x - \\ln 10$。在给定的计算机上，所有数都用具有 $t=5$ 位有效数字的十进制浮点数表示，并采用舍位法。令 $\\operatorname{fl}(\\cdot)$ 表示舍位到 $t=5$ 位有效数字的浮点映射。\n\n优化程序在机器计算出的梯度精确为零时停止。在浮点运算下，$g'(x)$ 被计算为 $\\operatorname{fl}\\big(\\operatorname{fl}(x) - \\operatorname{fl}(\\ln 10)\\big)$。在没有指数限制并采用舍位法的十进制浮点系统中，使其精确等于零的唯一方式是当减法的两个操作数在浮点表示上完全相等时，即，\n$$\n\\operatorname{fl}(x) = \\operatorname{fl}(\\ln 10).\n$$\n\n因此，停滞区间 $I$ 正是单个浮点数 $\\operatorname{fl}(\\ln 10)$ 在映射 $\\operatorname{fl}$ 下的原像。对于一个在十进制下有 $t$ 位有效数字的正规格化浮点数 $y$，写作 $y = m \\times 10^{e}$，其中 $1 \\leq m  10$，所有舍位后等于 $y$ 的实数的集合是半开区间\n$$\n[y,\\, y + \\operatorname{ulp}(y)),\n$$\n其中到下一个可表示数的间距是\n$$\n\\operatorname{ulp}(y) = 10^{\\,e - (t-1)}.\n$$\n这是因为将 $m$ 的最后一位（第 $t$ 位）有效数字增加一，会使 $y$ 的值改变 $10^{e-(t-1)}$。\n\n我们使用 $t=5$ 位数字和舍位法来计算 $\\operatorname{fl}(\\ln 10)$。因为 $\\ln 10 \\approx 2.30258509\\ldots$，舍位到5位有效数字得到\n$$\n\\operatorname{fl}(\\ln 10) = 2.3025 \\times 10^{0},\n$$\n我们有 $e=0$。因此，\n$$\n\\operatorname{ulp}\\big(\\operatorname{fl}(\\ln 10)\\big) = 10^{\\,0 - (5-1)} = 10^{-4}.\n$$\n因此，\n$$\nI = \\big[2.3025,\\, 2.3025 + 10^{-4}\\big)\n= [2.3025,\\, 2.3026),\n$$\n停滞区间的宽度是\n$$\nx_{\\text{high}} - x_{\\text{low}} = 10^{-4}.\n$$", "answer": "$$\\boxed{1 \\times 10^{-4}}$$", "id": "2167170"}]}