## 引言
单纯形法是运筹学和最优化领域的基石，为解决无数[资源分配](@entry_id:136615)和决策问题提供了强大的数学框架。然而，理解线性规划的概念是一回事，掌握系统性求解这些问题并从中洞察深层经济含义的工具则是另一项关键技能。单纯形表（Simplex Tableau）正是这一过程的核心，它不仅是一个计算工具，更是一个信息丰富的矩阵，揭示了[优化问题](@entry_id:266749)从数学表达到几何直观再到经济解释的全貌。本文旨在填补理论与实践之间的鸿沟，深入剖析单纯形表的内在逻辑与强大功能。

在接下来的内容中，我们将踏上一段结构化的学习之旅。首先，在“原理与机制”章节，我们将学习如何将一个线性规划问题转化为标准型，构建并操作单纯形表，掌握轴心变换这一优化的核心引擎。随后，在“应用与跨学科联系”章节，我们将超越计算本身，探索如何从最终单纯形表中解读出影子价格等关键经济指标，进行灵敏度分析，并了解其与经济学、博弈论及[整数规划](@entry_id:178386)等高级优化领域的深刻联系。最后，通过“动手实践”部分，你将有机会将所学知识应用于具体问题，巩固并加深理解。让我们从单纯形表的基本构建开始，一步步揭开这个强大工具的神秘面纱。

## 原理与机制

在上一章介绍线性规划的基本概念之后，本章将深入探讨求解这些问题的核心算法——单纯形法的机制。单纯形法是一种迭代算法，它通过在[可行域的顶点](@entry_id:174284)之间系统地移动来寻找最优解。这个过程的核心工具是 **单纯形表 (Simplex Tableau)**。本章将详细阐述如何构建、解读和操作单纯形表，揭示其背后的数学原理和几何直观。

### 从线性规划到初始单纯形表：标准化

单纯形算法并不直接处理任意形式的[线性规划](@entry_id:138188)问题。它要求问题被转换成一种特定的**标准型 (Standard Form)**，即所有约束都是等式，且所有变量都非负。这个转换过程是应用单纯形法的第一步。

#### 变量和约束的转换

一个典型的[线性规划](@entry_id:138188)问题可能包含[不等式约束](@entry_id:176084)（≤ 或 ≥ 类型）、[等式约束](@entry_id:175290)以及无约束变量。为了将其转化为标准型，我们需要进行如下操作：

1.  **处理[不等式约束](@entry_id:176084)**:
    *   对于“小于或等于”($\le$)类型的约束，我们通过加入一个非负的**[松弛变量](@entry_id:268374) (slack variable)**，将其转化为等式。例如，约束 $2x_1 + 3x_2 \le 300$ 可以写成 $2x_1 + 3x_2 + s_1 = 300$，其中 $s_1 \ge 0$。这个[松弛变量](@entry_id:268374) $s_1$ 代表了该项资源的“未使用量”或“剩余量”。
    *   对于“大于或等于”($\ge$)类型的约束，我们减去一个非负的**剩余变量 (surplus variable)**。例如，约束 $2x_1 - 5x_2 + x_3 \ge 10$ 变为 $2x_1 - 5x_2 + x_3 - s_2 = 10$，其中 $s_2 \ge 0$。

2.  **处理无约束变量**:
    如果一个变量 $x_j$ 在符号上是无约束的 (unrestricted in sign)，我们可以用两个非负变量的差来替换它：$x_j = x_j^+ - x_j^-$，其中 $x_j^+ \ge 0$ 和 $x_j^- \ge 0$。这个替换必须在整个模型（包括[目标函数](@entry_id:267263)和所有约束）中进行。

3.  **处理右侧负值 (RHS)**:
    标准型要求所有约束的右侧项（RHS）非负。如果一个约束的右侧是负数，只需将整个约束方程两边乘以 $-1$ 即可。例如， $x_1 - 3x_2 = -5$ 变为 $-x_1 + 3x_2 = 5$。

#### [人工变量](@entry_id:164298)与[两阶段法](@entry_id:166636)

在引入松弛和剩余变量后，我们得到了一组[等式约束](@entry_id:175290)。为了启动单纯形法，我们需要一个初始的**基本可行解 (Basic Feasible Solution, BFS)**。一个基本[可行解](@entry_id:634783)对应着[可行域](@entry_id:136622)的一个顶点。在代数上，一个[基本解](@entry_id:184782)是通过将一组变量（称为**非基本变量**）设为零，然后求解剩余变量（称为**基本变量**）得到的。如果所有基本变量的值都非负，那么这个基本解就是基本“可行”解。

对于原始问题中所有约束都是 $\le$ 类型且右侧项非负的情况，我们可以选择所有[松弛变量](@entry_id:268374)作为初始基本变量。它们的[系数矩阵](@entry_id:151473)恰好构成一个[单位矩阵](@entry_id:156724)，使得初始基本可行解可以被轻易地读出。然而，当问题包含 $\ge$ 或 $=$ 约束时，情况就变得复杂。在转化后的等式中，我们通常找不到一个现成的单位矩阵。

为了解决这个问题，我们引入了**[人工变量](@entry_id:164298) (artificial variables)**。对于每一个没有现成单位列的 $\ge$ 或 $=$ 约束，我们都添加一个非负的[人工变量](@entry_id:164298)。这些变量纯粹是数学构造，没有实际物理意义，其唯一目的是为了构成一个初始的单位矩阵，从而为我们提供一个起始的[基本解](@entry_id:184782)。

然而，[人工变量](@entry_id:164298)必须在最终解中为零，否则解就不是原问题的[可行解](@entry_id:634783)。为了保证这一点，我们采用**[两阶段法](@entry_id:166636) (Two-Phase Method)**：

*   **第一阶段 (Phase I)**: 目标是最小化所有[人工变量](@entry_id:164298)之和，我们称之为 $W$。我们对这个新的目标函数 $W$ 运行单纯形法。如果 $W$ 的最小值大于零，这意味着至少有一个[人工变量](@entry_id:164298)无法被从基中移除并变为零，这表明原问题没有[可行解](@entry_id:634783)。如果 $W$ 的最小值为零，那么所有[人工变量](@entry_id:164298)都已变为非基本变量（值为零），我们便找到了原问题的一个初始基本可行解。此时，第一阶段结束。

*   **第二阶段 (Phase II)**: 我们移除[人工变量](@entry_id:164298)和第一阶段的目标函数 $W$，恢复原问题的目标函数 $Z$，并从第一阶段结束时的基本[可行解](@entry_id:634783)开始，继续使用单纯形法进行优化，直至找到最优解。

例如，考虑一个生产计划问题 [@problem_id:2221265]，其约束包括 $x_1 + x_2 + x_3 \le 7$, $2x_1 - 5x_2 + x_3 \ge 10$ 和 $x_1 - 3x_2 = -5$。经过[标准化](@entry_id:637219)处理（包括替换无约束变量 $x_2$，处理RHS负值，并加入松弛、剩余和[人工变量](@entry_id:164298)），我们得到：
1. $x_{1} + x_{2}^{+} - x_{2}^{-} + x_{3} + s_{1} = 7$
2. $2x_{1} - 5x_{2}^{+} + 5x_{2}^{-} + x_{3} - s_{2} + a_{2} = 10$
3. $-x_{1} + 3x_{2}^{+} - 3x_{2}^{-} + a_{3} = 5$

初始的基本变量是 $s_1, a_2, a_3$。第一阶段的目标是最小化 $W = a_2 + a_3$。在构建初始单纯形表之前，我们需要将 $W$ 表示为非基本变量的函数。通过约束(2)和(3)解出 $a_2$ 和 $a_3$ 并代入 $W$ 的表达式，得到 $W = (10 - 2x_{1} + \dots) + (5 + x_{1} - \dots) = 15 - x_{1} + \dots$。在这个初始状态下，所有非基本变量（$x_1, x_2^+, x_2^-, x_3, s_2$）都为零，因此 $W$ 的初始值就是表达式中的常数项，即 $15$。这个值代表了初始解距离原问题可行性有多“远”。

### 单纯形表的结构与解读

单纯形表是单纯形算法的紧凑表示，它在一个矩阵中包含了求解所需的所有信息。每个单纯形表都对应着[可行域](@entry_id:136622)的一个顶点（一个基本[可行解](@entry_id:634783)）。

#### 表的组成

一个典型的单纯形表包含以下部分：
*   **变量列**: 表的每一列对应一个变量（决策变量、松弛/剩余变量）。
*   **约束行**: 表的主体部分，每一行代表一个[约束方程](@entry_id:138140)。
*   **目标行**: 通常是最后一行（或第一行），代表了表示为非基本变量形式的[目标函数](@entry_id:267263)。
*   **基本变量列**: 表的左侧通常会标出当前每一行对应的基本变量。
*   **右侧项 (RHS) 列**: 最后一列，表示当前基本[可行解](@entry_id:634783)中各基本变量的值以及[目标函数](@entry_id:267263)的当前值。

#### 解读表中的系数

表中的每一个数字都有其精确的含义。在**初始单纯形表**中，约束行中的系数尤为直观。例如，在一个生产两种产品（产品A和产品B）的[优化问题](@entry_id:266749)中 [@problem_id:2221285]，如果一个约束为 $2x_1 + 3x_2 \le 300$（其中 $x_1, x_2$ 是产量），那么在初始单纯形表中，与变量 $x_2$ 对应的列和与该约束对应的行相交处的系数就是 $3$。这个系数被称为**工艺系数 (technological coefficient)**，它表示每生产一单位的产品B需要消耗3单位的该项资源（例如，3小时的劳动时间）。

#### 识别基本变量与非基本变量

在一个处于**典[范式](@entry_id:161181) (canonical form)** 的单纯形表中，识别基本变量和非基本变量非常直接。如果一个变量的列在约束行部分是一个**[单位向量](@entry_id:165907)**（即只有一个元素为1，其余都为0），那么这个变量就是**基本变量 (basic variable)**。这个1所在的行就是该基本变量对应的行。所有其他变量都是**非基本变量 (non-basic variables)** [@problem_id:2221301]。

例如，在以下单纯形表中：
$$
\begin{array}{c|ccccc|c}
\text{变量} & x_1 & x_2 & s_1 & s_2 & P & \text{RHS} \\
\hline
? & 1/2 & 1 & 1/2 & 0 & 0 & 5 \\
? & 5/2 & 0 & -1/2 & 1 & 0 & 10 \\
\hline
P & -1/2 & 0 & 5/2 & 0 & 1 & 25 \\
\end{array}
$$
在约束行（前两行）中，$x_2$ 的列是 $\begin{pmatrix} 1 \\ 0 \end{pmatrix}$，$s_2$ 的列是 $\begin{pmatrix} 0 \\ 1 \end{pmatrix}$。因此，$x_2$ 和 $s_2$ 是当前的基本变量。而 $x_1$ 和 $s_1$ 的列不是单位向量，所以它们是非基本变量。

#### 读取当前解

给定一个典[范式](@entry_id:161181)的单纯形表，当前的基本[可行解](@entry_id:634783)可以轻松读出 [@problem_id:2221333]。其规则是：
*   所有**非基本变量**的值都为 $0$。
*   每个**基本变量**的值等于其所在行的**RHS**值。
*   **[目标函数](@entry_id:267263)**的当前值等于目标函数行中的**RHS**值。

在上述例子中 [@problem_id:2221301]，非基本变量 $x_1=0, s_1=0$。基本变量 $x_2$ 对应第一行，所以 $x_2=5$。基本变量 $s_2$ 对应第二行，所以 $s_2=10$。[目标函数](@entry_id:267263)值 $P=25$。因此，该表代表的解是 $(x_1, x_2) = (0, 5)$，此时资源约束的松弛情况为 $(s_1, s_2) = (0, 10)$，总利润为 $25$。

### 优化的引擎：轴心操作

单纯形法的核心在于**轴心操作 (pivot operation)**，这是一个代数过程，它将单纯形表从一个基本[可行解](@entry_id:634783)转换到另一个相邻且更优（或至少不差）的基本[可行解](@entry_id:634783)。

#### 轴心操作的几何意义

从几何角度看，[线性规划](@entry_id:138188)的可行域是一个多面[凸体](@entry_id:183909)（在二维空间中是多边形）。基本[可行解](@entry_id:634783)对应于这个多面体的**顶点**。一次轴心操作，在非退化的情况下，对应于从当前顶点沿着一条**棱**移动到另一个**相邻的顶点** [@problem_id:2221272]。算法的目标是沿着能使目标函数值改善最快的棱移动，直到到达一个无法再改善的顶点，这个顶点就是最优解。

#### 轴心操作的步骤

一次完整的轴心操作包含三个步骤：

1.  **选择入基变量 (Entering Variable)**:
    这一步决定了我们要沿着哪条棱移动。我们检查[目标函数](@entry_id:267263)行中非基本变量的系数，这些系数被称为**[检验数](@entry_id:173345) (reduced costs)**。
    *   对于**最大化问题**，如果一个非基本变量的[检验数](@entry_id:173345)是**负数**，那么增加该变量的值将会提高目标函数值。通常，我们选择具有**最负**[检验数](@entry_id:173345)的变量作为**入基变量 (entering variable)**，这被称为“最陡梯度”法则，因为它预期能带来最快的单位改进率 [@problem_id:2221282]。例如，如果目标行是 `[... -3/2, -5/2, 7/2 ...]`，我们会[选择检验](@entry_id:182706)数为 $-5/2$ 的变量入基。
    *   对于**最小化问题**，情况则相反。如果一个非基本变量的[检验数](@entry_id:173345)是**正数**，增加它将减少目标函数值。因此，我们选择具有**最大正**[检验数](@entry_id:173345)的变量入基。

2.  **选择出基变量 (Leaving Variable)：[最小比率检验](@entry_id:634935)**
    确定了入基变量后，我们需要决定可以沿着这条“棱”走多远。也就是说，我们可以将入基变量的值从0增加到多大，而不违反任何约束（即不使任何基本变量变为负数）。这个上限是由**[最小比率检验](@entry_id:634935) (minimum ratio test)** 确定的 [@problem_id:2221322]。
    检验方法如下：对于入基变量所在列（称为**轴心列 (pivot column)**）中的每一个**正系数**，我们计算该行RHS值与该正系数的比率。
    $$ \text{比率} = \frac{\text{RHS 值}}{\text{轴心列中的正系数}} $$
    我们选择具有**最小非负比率**的行。该行对应的基本变量就是**出基变量 (leaving variable)**。这个变量将首先达到0，成为新的非基本变量。如果轴心列中没有正系数，情况则特殊，我们将在后面讨论。

3.  **执行轴心变换 (Pivoting)**
    确定了入基变量和出基变量后，我们就找到了**轴心元素 (pivot element)**，它位于轴心列和轴心行（出基变量所在行）的交点。接下来的任务是通过一系列**行操作**（本质上是高斯消元法），将单纯形表更新为新的典[范式](@entry_id:161181)。目标是：
    *   将轴心元素变为 $1$。
    *   将轴心列中的所有其他元素（包括目标行中的元素）变为 $0$。
    经过这些行操作，入基变量的列会变成一个新的[单位向量](@entry_id:165907)，而原出基变量的列则不再是单位向量。至此，一次完整的轴心操作完成，我们到达了一个新的顶点。

### 解读最终单纯形表：终止条件与特殊情况

单纯形算法持续进行轴心操作，直到满足某个终止条件。最终的单纯形表不仅告诉我们最优解，还能揭示问题的其他重要特性。

#### [最优性条件](@entry_id:634091)

算法何时停止？当[目标函数](@entry_id:267263)无法再被改善时。这在单纯形表中有明确的标志：

*   对于**最大化问题**，当目标行中所有与**非基本变量**对应的系数（[检验数](@entry_id:173345)）都**非负**（$\ge 0$）时，即达到最优解。因为此时增加任何非基本变量的值都不会再使[目标函数](@entry_id:267263)值增加。
*   对于**最小化问题**，当目标行中所有与非基本变量对应的系数都**非正**（$\le 0$）时，达到最优解 [@problem_id:2192508]。

#### 无界解

在进行[最小比率检验](@entry_id:634935)时，如果选定的入基变量（例如，对于最大化问题，其[检验数](@entry_id:173345)为负）对应的轴心列中，所有约束行中的系数都**非正**（$\le 0$），那么会发生什么？这意味着我们无法计算出最小比率。

从几何上看，这表示我们可以无限增加该入基变量的值，而不会导致任何当前的基本变量变为负值。换句话说，我们可以沿着[可行域](@entry_id:136622)的一条“无限长”的棱一直走下去。由于该入基变量的[检验数](@entry_id:173345)指示了[目标函数](@entry_id:267263)会持续改善，因此目标函数值可以无限增大（对于最大化问题）或减小（对于最小化问题）。这种情况被称为**无界解 (unbounded solution)** [@problem_id:2221264]。

#### 多重最优解

当单纯形表满足[最优性条件](@entry_id:634091)时（例如，最大化问题中目标行所有系数非负），如果某个**非基本变量**在目标行中的系数恰好为**零**，这意味着存在**多重最优解 (multiple optimal solutions)** 或**替代最优解 (alternative optima)** [@problem_id:2221330]。

这个零系数表明，将该非基本变量引入基中（即将其值从0增加）不会改变目标函数的最[终值](@entry_id:141018)。通过对这个非基本变量执行一次轴心操作，我们可以得到另一个不同的基本可行解，但其目标函数值与之前的最优解完全相同。实际上，初始最优解和这个新最优解之间的所有点（线段上的点）也都是最优解。这在实际应用中非常重要，因为它为决策者提供了在不牺牲最优目标值的前提下，选择不同方案的灵活性。

本章系统地介绍了单纯形表的构建、解读和操作机制。掌握这些原理，不仅是为了能够手动求解[线性规划](@entry_id:138188)问题，更重要的是为了深刻理解[优化算法](@entry_id:147840)的内在逻辑，以及如何从模型的数学表达中洞察问题的几何结构与经济学含义。