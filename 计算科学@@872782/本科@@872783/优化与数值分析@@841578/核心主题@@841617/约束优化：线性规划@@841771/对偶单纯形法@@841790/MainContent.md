## 引言
[线性规划](@entry_id:138188)是[运筹学](@entry_id:145535)中解决资源分配和[优化问题](@entry_id:266749)的基石，而（原始）单纯形法是求解这类问题的经典算法。[原始单纯形法](@entry_id:634231)从一个可行的初始方案出发，沿着可行域的边界逐步迭代，直至找到最优解。然而，在许多情况下，我们遇到的初始状态并非如此理想。例如，在对一个已求得最优解的模型进行灵敏度分析时，资源的变动或新约束的增加可能导致原最优解变得不再可行。此时，我们可能得到一个满足[最优性条件](@entry_id:634091)，但违反了非负约束的“解”，[原始单纯形法](@entry_id:634231)对此束手无策。

这正是[对偶单纯形法](@entry_id:164344)（Dual Simplex Method）旨在解决的核心问题。它提供了一种优雅而高效的替代路径，专门处理这种“原始不可行但对偶可行”的局面。与原始方法相反，[对偶单纯形法](@entry_id:164344)从一个满足[最优性条件](@entry_id:634091)的[不可行解](@entry_id:171066)开始，其目标是在保持最优性的同时，通过一系列精巧的迭代逐步“修复”可行性，直至最终达到最优[可行解](@entry_id:634783)。

在本文中，我们将系统地探索[对偶单纯形法](@entry_id:164344)。我们首先将在**“原理与机制”**一章中，深入剖析其基本原理、独特的枢轴变换规则，以及它与深刻的[对偶理论](@entry_id:143133)之间优美的对称关系。接着，在**“应用与[交叉](@entry_id:147634)学科联系”**一章中，我们将展示该方法在灵敏度分析、[整数规划](@entry_id:178386)、博弈论等高级应用领域的强大威力，揭示其作为高级算法“内核引擎”的关键作用。最后，在**“动手实践”**部分，你将有机会通过具体问题，将理论知识转化为解决实际优化挑战的技能。

## 原理与机制

在上一章中，我们详细探讨了（原始）单纯形法，这是一种从一个初始的原始可行解出发，通过一系列迭代来寻找最优解的强大算法。该方法的一个核心前提是，在整个求解过程中，我们始终维持解的**原始可行性**（即所有变量均非负）。然而，在许多实际应用和理论情境中，我们可能会遇到一种相反的情况：我们手头有一个“解”，它满足[最优性条件](@entry_id:634091)，但不满足可行性约束。单纯形法在这种情况下便无从下手。

本章将介绍**[对偶单纯形法](@entry_id:164344)（Dual Simplex Method）**，这是一种专门为解决此类问题而设计的算法。它从一个**原始不可行**但**对偶可行**的基解开始，通过一系列枢轴变换，逐步恢复原始可行性，同时保持对偶可行性，最终达到[原始问题和对偶问题](@entry_id:151869)的最优解。

### [对偶单纯形法](@entry_id:164344)的基本原理

让我们首先明确何时需要以及能够使用[对偶单纯形法](@entry_id:164344)。在一个标准的线性规划问题中，当我们使用单纯形表或字典来表示其状态时，一个基解由两部分关键信息定义：变量的取值和[目标函数](@entry_id:267263)值。

考虑一个最大化问题。根据最优性理论，如果一个基解是**原始可行**的（即所有变量的值均非负），并且是**对偶可行**的（即[目标函数](@entry_id:267263)行中所有非基变量的[检验数](@entry_id:173345)均非负），那么这个解就是最优解。[原始单纯形法](@entry_id:634231)正是通过保持原始可行性，不断迭代直至满足对偶可行性来实现最优。

现在，设想我们遇到了一个不同的局面。例如，在某个字典表示中 [@problem_id:2212990]：
$$x_3 = -2 - 3x_1 + x_2$$
$$x_4 = 5 + x_1 - 2x_2$$
$$z = 10 - 4x_1 - 6x_2$$
令非基变量 $x_1=0, x_2=0$，我们得到基解 $x_3 = -2, x_4 = 5$。由于 $x_3  0$，这个解违反了非负约束，因此是**原始不可行**的。然而，观察[目标函数](@entry_id:267263) $z = 10 - 4x_1 - 6x_2$，两个非基变量的系数（$-4$ 和 $-6$）都是非正的。在一个最大化问题中，这意味着增加任何一个非基变量的值都无法使[目标函数](@entry_id:267263)值增加。这个条件，即所有[检验数](@entry_id:173345)均非正（或在某些表示法下，均非负），恰好是**对偶可行性**的标志。

类似地，在一个使用单纯形表的最小化问题中 [@problem_id:2192548] [@problem_id:2212979]，我们可能会遇到如下情况：目标函数行（$z$ 行）中所有非基变量的[检验数](@entry_id:173345)都已满足[最优性条件](@entry_id:634091)（例如，对于最小化问题，均为非正数），但“右端项”（RHS）列中存在负值。RHS列的值代表了当前基变量的取值，负值的出现意味着对应的基变量取值为负，从而违反了原始可行性。例如，在下表中，基变量 $x_2$ 的值为 $-6$。

| 基 | $x_1$ | $x_2$ | $x_3$ | $x_4$ | $x_5$ | RHS |
|:---:|:---:|:---:|:---:|:---:|:---:|:---:|
| $z$ | 0 | 0 | 0 | -4 | -2 | 180 |
| $x_1$ | 1 | 0 | 0 | 2 | -1 | 12 |
| $x_2$ | 0 | 1 | 0 | -3 | -2 | -6 |
| $x_3$ | 0 | 0 | 1 | 1 | 5 | 30 |

在这种“对偶可行但原始不可行”的状态下，[原始单纯形法](@entry_id:634231)的规则不再适用，因为它要求从一个可行解开始。然而，我们也不能直接断定问题无解或无界。这正是[对偶单纯形法](@entry_id:164344)发挥作用的起点。它的核心思想是：在保持对偶可行性的前提下，系统地修正[原始不可行性](@entry_id:176249)。每一次迭代都旨在消除一个负的基变量，使其变为非负，直到所有基变量都满足非负约束，此时由于对偶可行性一直被保持，我们也就达到了最优解。

### [对偶单纯形法](@entry_id:164344)的枢轴变换机制

[对偶单纯形法](@entry_id:164344)的每一次迭代同样围绕一个**枢轴变换（Pivot Operation）**进行，但这套规则与[原始单纯形法](@entry_id:634231)“对偶”呼应。它包含两个核心步骤：选择离基变量和选择进基变量。

#### 离基变量的选择

[原始单纯形法](@entry_id:634231)的目标是改善[目标函数](@entry_id:267263)，因此它首先选择一个能使目标函数改善的**进基变量**。相反，[对偶单纯形法](@entry_id:164344)的首要目标是修正[原始不可行性](@entry_id:176249)。[不可行性](@entry_id:164663)体现在基变量的负值上。因此，[对偶单纯形法](@entry_id:164344)的第一步是识别出当前最不可行的变量。

**规则：** 在单纯形表的右端项（RHS）列中，选择值最负的那个分量。该分量所在的行对应的基变量即为**离基变量（Leaving Variable）**。

例如，在以下这个原始不可行、对偶可行的初始状态中，我们有三个基变量 $s_1, s_2, s_3$ [@problem_id:2213024]：
| 基 | $x_1$ | $x_2$ | $x_3$ | $s_1$ | $s_2$ | $s_3$ | RHS |
|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|
| $z$ | 2 | 3 | 4 | 0 | 0 | 0 | 0 |
| $s_1$ | -1 | -2 | -1 | 1 | 0 | 0 | -10 |
| $s_2$ | -2 | -1 | -3 | 0 | 1 | 0 | -8 |
| $s_3$ | -3 | -1 | -1 | 0 | 0 | 1 | -12 |
RHS列的值分别为 $-10, -8, -12$。其中最负的值是 $-12$，它对应于基变量 $s_3$。因此，在第一步迭代中，$s_3$ 被选为离基变量，其所在行为**枢轴行（Pivot Row）**。

#### 进基变量的选择

选定枢轴行后，我们需要选择一个非基变量进入基，以替换离基变量。这个选择必须满足两个条件：
1.  通过枢轴变换，能使离基变量的新值（即RHS列中枢轴行的新值）从负数变为非负数。
2.  变换后，新的单纯形表必须保持对偶可行性。

让我们来分析这两个条件。设枢轴行为第 $r$ 行（对应离基变量 $x_B$），枢轴列为第 $j$ 列（对应进基变量 $x_j$），枢轴元素为 $\bar{a}_{rj}$。枢轴变换后，枢轴行的新RHS值将是 $\bar{b}_r' = \bar{b}_r / \bar{a}_{rj}$。由于我们选择的枢轴行满足 $\bar{b}_r  0$，为了使 $\bar{b}_r' \ge 0$，枢轴元素 $\bar{a}_{rj}$ 必须为**负数**。因此，我们只在枢轴行中系数为负的非基变量列中寻找进基变量。

第二个条件——保持对偶可行性——是选择的关键。它引出了[对偶单纯形法](@entry_id:164344)的“比值测试”。

**规则：** 对于枢轴行 $r$ 中所有系数 $\bar{a}_{rj}  0$ 的非基变量 $x_j$，我们需要通过“比值测试”来选择进基变量。该测试的目的是在修正[原始不可行性](@entry_id:176249)的同时，保持解的对偶可行性。比值的具体形式和选择标准（最小或最大）取决于问题的类型（最大化或最小化）和[检验数](@entry_id:173345)的表示约定。设 $\bar{c}_j$ 是 $x_j$ 在目标函数行中的[检验数](@entry_id:173345)。
*   对于**最大化**问题（通常此时对偶可行性要求 $\bar{c}_j \ge 0$），比值测试为：$\min \left\{ \frac{\bar{c}_j}{-\bar{a}_{rj}} \right\}$。
*   对于**最小化**问题（通常此时对偶可行性要求 $\bar{c}_j \le 0$），比值测试为：$\max \left\{ \frac{\bar{c}_j}{\bar{a}_{rj}} \right\}$ (即选择最接近0的负比值)，这等价于选择使比值 $\left| \frac{\bar{c}_j}{\bar{a}_{rj}} \right|$ 最小的变量。

我们选择满足相应规则的非基变量作为**进基变量（Entering Variable）**。

例如，考虑以下最小化问题中的一个状态，其中 $s_2$ 所在的行被选为枢轴行（RHS = -5） [@problem_id:2213017]。
- 目标行 ($z$) 的[检验数](@entry_id:173345): 对非基变量 $x_1, x_2$ 分别是 $\bar{c}_1 = -2, \bar{c}_2 = -3$。
- $s_2$ 行的系数: 对非基变量 $x_1, x_2$ 分别是 $\bar{a}_{s_2, 1} = -3, \bar{a}_{s_2, 2} = -1$。

两个非基变量在枢轴行中的系数均为负数，因此都是进基的候选者。我们为最小化问题计算比值 $\frac{\bar{c}_j}{\bar{a}_{rj}}$：
- 对于 $x_1$：比值为 $\frac{-2}{-3} = \frac{2}{3}$。
- 对于 $x_2$：比值为 $\frac{-3}{-1} = 3$。

根据最小化问题的规则，我们选择使比值最大的变量进基：$\max(\frac{2}{3}, 3) = 3$。因此，我们选择 $x_2$ 作为进基变量。枢轴元素就是 $s_2$ 行、$x_2$ 列的 $-1$。

选定枢轴元素后，执行标准的行变换操作（高斯消元）即可得到新的单纯形表。这个过程会使离基变量的值变为正数，并且（由于比值测试的保证）新表的目标函数行仍然满足对偶可行性条件 [@problem_id:2167656]。算法持续进行，直到RHS列中不再有负值，此时原始可行性得到满足，[算法终止](@entry_id:143996)，得到最优解。

#### 终止条件：原始问题无解

如果在选择进基变量时，发现选定的枢轴行中所有非基变量的系数都**非负**，那么[对偶单纯形法](@entry_id:164344)就会终止。这种情况意味着我们无法找到一个合适的进基变量来将离基变量的值从负数变为正数。这在理论上证明了原始线性规划问题是**无可行解（infeasible）**的。

例如，构造一个满足此条件的最小化问题 Tableau [@problem_id:2213007]：
$$\begin{pmatrix}
1  1  0  0  0  0 \\
0  0  0  1  0  0 \\
0  1  0  0  1  -1
\end{pmatrix}$$
这里，基为 $\{x_3, x_4\}$，RHS 分别为 $0$ 和 $-1$。这是一个对偶可行（[检验数](@entry_id:173345) $1, 0 \ge 0$）但原始不可行（$x_4 = -1$）的状态。唯一的枢轴行是第三行（对应 $x_4$）。然而，在该行中，非基变量 $x_1, x_2$ 的系数分别为 $1$ 和 $0$，均为非负。没有负的枢轴元素可供选择。因此，[算法终止](@entry_id:143996)，并断定原始问题无可行解。

### 与[对偶理论](@entry_id:143133)的联系

[对偶单纯形法](@entry_id:164344)的命名并非偶然，它与[线性规划](@entry_id:138188)的[对偶理论](@entry_id:143133)有着深刻而优美的联系。实际上，**在原始问题上执行一步[对偶单纯形法](@entry_id:164344)，等价于在其[对偶问题](@entry_id:177454)上执行一步[原始单纯形法](@entry_id:634231)。**

让我们通过一个例子来理解这一点 [@problem_id:2213008]。考虑原始问题（P）：
最小化 $z = 4x_1 + 5x_2$
受限于：
$2x_1 + x_2 \ge 6$
$x_1 + 3x_2 \ge 7$
$x_1, x_2 \ge 0$

其[对偶问题](@entry_id:177454)（D）为：
最大化 $g = 6y_1 + 7y_2$
受限于：
$2y_1 + y_2 \le 4$
$y_1 + 3y_2 \le 5$
$y_1, y_2 \ge 0$

将原始问题（P）转化为标准型，我们会得到一个初始的单纯形表，它是原始不可行但对偶可行的，适合作为[对偶单纯形法](@entry_id:164344)的起点。
另一方面，[对偶问题](@entry_id:177454)（D）的初始表是原始可行但非最优的，完全适用于标准的[原始单纯形法](@entry_id:634231)。

如果我们对（P）的表执行一步[对偶单纯形法](@entry_id:164344)，选择离基和进基变量，我们会发现这个选择与对（D）的表执行一步[原始单纯形法](@entry_id:634231)所做的选择完全对应。例如，在（D）中，我们可能会选择 $y_2$ 作为进基变量，因为它能最大程度地增加[目标函数](@entry_id:267263) $g$。这在（P）的[对偶单纯形法](@entry_id:164344)中，对应于选择某个特定的离基变量。进基/离基的选择规则，包括比值测试，在两个问题之间形成了[一一对应](@entry_id:143935)的关系。

这种对称性揭示了[对偶单纯形法](@entry_id:164344)的本质：它实际上是在对偶空间中沿着[对偶问题](@entry_id:177454)的可行域顶点移动，而其在原始问题空间中的表现就是从一个原始[不可行解](@entry_id:171066)移动到另一个，并逐步逼近可行域。

从 [Karush-Kuhn-Tucker](@entry_id:634966) (KKT) [最优性条件](@entry_id:634091)来看，[对偶单纯形法](@entry_id:164344)的每一步也可以被解释为修复一个被违反的 KKT 条件，同时保持其他条件成立 [@problem_id:2212992]。一个原始不可行、对偶可行的解违反了**原始可行性条件** ($x_i \ge 0$)，但满足**对偶可行性**和**[互补松弛性](@entry_id:141017)**。[对偶单纯形法](@entry_id:164344)的一次枢轴变换，其目的正是修复被违反的原始可行性（例如，使一个负的 $s_1$ 变为正数），同时通过精巧的比值测试规则，确保对偶可行性和[互补松弛性](@entry_id:141017)在新的基解中仍然得到满足。

### 高级主题与实现

#### 修正[对偶单纯形法](@entry_id:164344)

对于大规模问题，像[原始单纯形法](@entry_id:634231)一样，维护和更新整个单纯形表是低效的。**[修正单纯形法](@entry_id:177963)（Revised Simplex Method）**提供了一种更高效的实现方式，它只存储和更新关键信息，特别是基[矩阵的逆](@entry_id:140380) $\mathbf{B}^{-1}$。[对偶单纯形法](@entry_id:164344)同样有其修正版本。

在修正[对偶单纯形法](@entry_id:164344)的一次迭代中 [@problem_id:2212999]：
1.  **计算当前基解**：$\mathbf{\bar{b}} = \mathbf{B}^{-1}\mathbf{b}$。检查 $\mathbf{\bar{b}}$ 的分量，如果存在负值，则选择最负的分量对应的基变量作为离基变量。设其在基中的索引为 $r$。
2.  **计算枢轴行**：计算枢轴行在非基变量部分的系数向量 $\mathbf{p}^T = \mathbf{e}_r^T \mathbf{B}^{-1} \mathbf{A}_N$，其中 $\mathbf{e}_r$ 是第 $r$ 个[单位向量](@entry_id:165907)，$\mathbf{A}_N$ 是非基部分的约束矩阵。
3.  **计算[检验数](@entry_id:173345)**：计算对偶变量 $\mathbf{y}^T = \mathbf{c}_B^T \mathbf{B}^{-1}$，并用它计算非基变量的[检验数](@entry_id:173345) $\mathbf{\bar{c}}_N^T = \mathbf{c}_N^T - \mathbf{y}^T \mathbf{A}_N$，以确认对偶可行性。
4.  **选择进基变量**：在向量 $\mathbf{p}^T$ 中找到负的分量，并结合[检验数](@entry_id:173345) $\mathbf{\bar{c}}_N^T$ 进行比值测试，确定进基变量。
5.  **更新基**：确定进基和离基变量后，更新基[矩阵的逆](@entry_id:140380) $\mathbf{B}^{-1}$，然后开始下一次迭代。

这种方法避免了对整个非基部分的矩阵进行更新，大大节省了计算量。

#### 退化与抗[循环规则](@entry_id:262527)

在[对偶单纯形法](@entry_id:164344)中，当多个非基变量在比值测试中得到相同的最小比值时，就会出现**对偶退化（Dual Degeneracy）**。这种情况对应于[对偶问题](@entry_id:177454)中的一个退化基解。单纯地选择索引最小的变量来打破僵局，在理论上可能会导致**循环（Cycling）**，即算法在有限个基之间无限循环而无法终止。

尽管在实践中循环非常罕见，但为了保证算法的有限终止性，需要引入**抗[循环规则](@entry_id:262527)（Anti-cycling Rule）**。一种著名的规则是**字典序规则（Lexicographical Rule）**。

当比值测试出现平局时，我们不仅仅比较比值本身，而是比较由比值构成的向量。例如，对于每一个候选进基变量 $j$，我们构造一个向量 $\mathbf{v}_j$，其第一个分量是标准的比值，后续分量由单纯形表中该列的其他变换系数与枢轴行系数的比值构成。然后，我们选择导致字典序最小的向量 $\mathbf{v}_j$ 所对应的变量作为进基变量 [@problem_id:2212981]。这种方法确保了每一步迭代都会有一个字典序意义上的“改进”，从而从根本上消除了循环的可能性，保证了算法在有限步内终止。

总之，[对偶单纯形法](@entry_id:164344)不仅是求解线性规划问题的一个强大工具，特别是在处理初始解不可行的情况时，它也加深了我们对[对偶理论](@entry_id:143133)的理解。它在灵敏度分析、[整数规划](@entry_id:178386)（作为[分支定界法](@entry_id:635251)中的求解器）等领域有着广泛的应用。