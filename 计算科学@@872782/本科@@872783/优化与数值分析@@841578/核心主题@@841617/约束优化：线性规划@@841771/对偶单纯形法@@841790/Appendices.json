{"hands_on_practices": [{"introduction": "应用对偶单纯形法的第一步通常是正确地构建问题。这个练习 [@problem_id:2213009] 将引导你将一个现实世界中的最小化问题转化为适用于对偶单纯形法的初始单纯形表，并着重于识别第一个主元。这个过程连接了问题陈述与算法执行之间的鸿沟，是理解方法应用的关键。", "problem": "一家半导体制造厂正在开发一种制造定制芯片的新工艺，该工艺涉及三种不同类型的离子注入步骤，分别表示为工艺1、工艺2和工艺3。令 $x_1, x_2, x_3$ 分别代表每种工艺运行的持续时间（单位：小时）。该工厂寻求最小化的总能耗是这些持续时间的线性函数。要最小化的目标函数是 $E = 4x_1 + 3x_2 + 5x_3$，单位为兆瓦时 (MWh)。\n\n为确保芯片正常工作，必须满足两项质量控制规范。这些规范与两种类型的掺杂剂（P型和N型）所需的最低浓度有关，这些浓度是工艺持续时间的函数。\n1.  P型掺杂剂浓度约束：$2x_1 + x_2 + 3x_3 \\ge 10$（任意浓度单位）\n2.  N型掺杂剂浓度约束：$x_1 + 2x_2 + x_3 \\ge 12$（任意浓度单位）\n3.  持续时间必须为非负值：$x_1, x_2, x_3 \\ge 0$。\n\n要使用对偶单纯形法解决这个线性规划问题，您必须首先建立初始单纯形表。该方法的标准形式要求在添加松弛变量 ($s_1, s_2$) 以形成等式之前，将 `≥` 不等式转换为 `≤` 不等式。单纯形表应首先排列目标函数行，然后是两个约束的行。列应按 $x_1, x_2, x_3, s_1, s_2$ 的顺序表示变量。\n\n根据对偶单纯形算法的规则，确定将选择的第一个主元的位置。将您的答案表示为一对整数 `(row index, column index)`。这些索引指的是约束对应系数矩阵内的位置（即，不包括目标行和解/RHS列）。使用1-based索引，其中行1是第一个约束行，列1对应于变量 $x_1$。", "solution": "我们需要最小化 $E = 4x_{1} + 3x_{2} + 5x_{3}$，约束条件为\n$$2x_{1} + x_{2} + 3x_{3} \\ge 10, \\quad x_{1} + 2x_{2} + x_{3} \\ge 12, \\quad x_{1},x_{2},x_{3} \\ge 0.$$\n\n对于所要求的标准形式的对偶单纯形法，通过将两边乘以 $-1$ 把 $\\ge$ 约束转换为 $\\le$ 约束，然后添加松弛变量 $s_{1}, s_{2} \\ge 0$：\n$$-2x_{1} - x_{2} - 3x_{3} + s_{1} = -10,$$\n$$-x_{1} - 2x_{2} - x_{3} + s_{2} = -12.$$\n\n将目标函数写成规范形式，其中松弛变量的成本为零：\n$$E - 4x_{1} - 3x_{2} - 5x_{3} = 0.$$\n在单纯形表中，我们通常使用检验数 $\\bar{c}_j = c_j - z_j$ 或 $z_j-c_j$。对于一个最小化问题，若使用 $c_j - z_j$ 约定，最优性条件为所有 $\\bar{c}_j \\ge 0$。初始基为 $(s_1, s_2)$，基成本 $c_B = (0, 0)$，所以 $z_j=0$。因此，初始检验数就是 $c_j$ 本身，即 $\\bar{c}_{1}=4, \\bar{c}_{2}=3, \\bar{c}_{3}=5$，均为非负，满足对偶可行性。\n\n初始单纯形表为：\n| 基 | $x_1$ | $x_2$ | $x_3$ | $s_1$ | $s_2$ | RHS |\n|:---:|:---:|:---:|:---:|:---:|:---:|:---:|\n| $z$ | -4 | -3 | -5 | 0 | 0 | 0 |\n| $s_1$ | -2 | -1 | -3 | 1 | 0 | -10 |\n| $s_2$ | -1 | -2 | -1 | 0 | 1 | -12 |\n这里的目标行显示的是 $-c_j$。右端项 $(-10,-12)$ 是负数，因此基是原始不可行的。\n\n对偶单纯形法主元选择：\n1.  选择RHS中负值最大的行作为出基行。这里，$\\min\\{-10,-12\\} = -12$，所以主元行是第二个约束（$s_2$ 所在行，行索引为 $2$）。\n2.  在主元行中系数为负的列 $j$ 中，计算比率 $\\frac{\\bar{c}_{j}}{-a_{rj}}$ 并选择最小值，其中 $\\bar{c}_j$ 是检验数，$a_{rj}$ 是主元行中的系数。在第 $2$ 行中，负系数出现在 $x_{1}, x_{2}, x_{3}$ 列，其中 $a_{2,1} = -1$, $a_{2,2} = -2$, $a_{2,3} = -1$。检验数为 $\\bar{c}_{1} = 4$, $\\bar{c}_{2} = 3$, $\\bar{c}_{3} = 5$。\n比率计算如下：\n$$\\text{对于 } x_1: \\frac{\\bar{c}_{1}}{-a_{2,1}} = \\frac{4}{-(-1)} = 4$$\n$$\\text{对于 } x_2: \\frac{\\bar{c}_{2}}{-a_{2,2}} = \\frac{3}{-(-2)} = \\frac{3}{2}$$\n$$\\text{对于 } x_3: \\frac{\\bar{c}_{3}}{-a_{2,3}} = \\frac{5}{-(-1)} = 5$$\n最小比率为 $\\frac{3}{2}$，位于 $x_{2}$ 列，即列索引为 $2$。\n\n因此，第一个主元位于第 $2$ 行，第 $2$ 列（第二个约束行中 $x_{2}$ 列的条目 $-2$）。", "answer": "$$\\boxed{\\begin{pmatrix} 2  2 \\end{pmatrix}}$$", "id": "2213009"}, {"introduction": "一旦单纯形表建立起来，对偶单纯形法的核心就是轴心变换操作。这个练习 [@problem_id:2212987] 提供了一个已经设置好的、原始不可行但对偶可行的单纯形表，让你能够专注于单次迭代的核心机制。通过练习选择离基变量和进基变量并更新单纯形表，你将熟练掌握该算法的基本步骤。", "problem": "考虑以下用于标准最大化问题的单纯形表，其中 $z$ 是目标函数，变量 $x_3, x_4, x_5$ 是当前的基变量。\n\n$$\n\\begin{array}{c|cccccc|c}\n\\text{Basis}  z  x_1  x_2  x_3  x_4  x_5  \\text{RHS} \\\\\n\\hline\nz  1  3  2  0  0  0  50 \\\\\n\\hline\nx_3  0  1  3  1  0  0  10 \\\\\nx_4  0  -1  2  0  1  0  -4 \\\\\nx_5  0  -2  -1  0  0  1  -5 \\\\\n\\end{array}\n$$\n\n使用对偶单纯形法执行恰好一次主元运算。在这一次迭代之后，确定新的基变量集合。报告这些新基变量的值以及目标函数 $z$ 的值。将基变量的值按照其变量下标的升序排列。你的答案应该是一个单行矩阵，其中包含这些值，最后是 $z$ 的值。例如，如果新的基变量是 $x_a, x_b, x_c$ 且 $a  b  c$，结果应为 $\\begin{pmatrix} \\text{value}_a  \\text{value}_b  \\text{value}_c  z \\end{pmatrix}$。", "solution": "我们应用对偶单纯形法，因为当前基 $\\{x_{3},x_{4},x_{5}\\}$ 使得 $x_{4}$ 和 $x_{5}$ 的右端项为负，表明原问题不可行，而 $z$ 行中非基变量 $x_{1},x_{2}$ 的检验数是非负的，这在 $z_{j}-c_{j}$ 约定下表明对偶问题可行。\n\n步骤 1：选择右端项（RHS）最负的基变量作为出基变量。从表中可以看出，基变量所在行的右端项值分别为 $10$ (对应 $x_{3}$), $-4$ (对应 $x_{4}$), 和 $-5$ (对应 $x_{5}$)。最负的值是 $-5$，因此 $x_{5}$ 是出基变量。\n\n步骤 2：使用对偶单纯形法的比值检验来选择入基变量。对于主元行（$x_{5}$ 所在的行），考虑满足 $a_{rj}  0$ 的列 $j$。在 $x_{5}$ 行中，$a_{5,1}=-2$ 和 $a_{5,2}=-1$，因此候选变量是 $x_{1}$ 和 $x_{2}$。将 $z$ 行的条目解释为检验数 $\\bar{c}_j = z_{j}-c_{j}$，我们为最大化问题计算比率 $\\min \\left\\{ \\frac{\\bar{c}_j}{-a_{rj}} \\right\\}$：\n$$\n\\text{对于 } x_1: \\frac{3}{-(-2)}=\\frac{3}{2}\n$$\n$$\n\\text{对于 } x_2: \\frac{2}{-(-1)}=2\n$$\n最小值为 $\\frac{3}{2}$，因此 $x_{1}$ 是入基变量。主元元素是位于 $x_{5}$ 行和 $x_{1}$ 列交叉处的 $-2$。\n\n步骤 3：执行主元运算。首先将主元行乘以 $-\\frac{1}{2}$，使主元变为 $1$：\n$$\nR_{5}'=\\left[\\,0,\\;1,\\;\\frac{1}{2},\\;0,\\;0,\\;-\\frac{1}{2}\\;\\middle|\\;\\frac{5}{2}\\right].\n$$\n从其他行中消去 $x_{1}$：\n\n- 新的 $z$ 行：$R_{z}'=R_{z}-3R_{5}'$ 给出\n$$\n[\\,1,\\;0,\\;\\tfrac{1}{2},\\;0,\\;0,\\;\\tfrac{3}{2}\\;|\\;\\tfrac{85}{2}\\,].\n$$\n\n- 新的 $x_{3}$ 行：$R_{3}'=R_{3}-R_{5}'$ 给出\n$$\n[\\,0,\\;0,\\;\\tfrac{5}{2},\\;1,\\;0,\\;\\tfrac{1}{2}\\;|\\;\\tfrac{15}{2}\\,].\n$$\n\n- 新的 $x_{4}$ 行：$R_{4}'=R_{4}+R_{5}'$ 给出\n$$\n[\\,0,\\;0,\\;\\tfrac{5}{2},\\;0,\\;1,\\;-\\tfrac{1}{2}\\;|\\;-\\tfrac{3}{2}\\,].\n$$\n\n在这次对偶单纯形迭代之后，基变量为 $\\{x_{1},x_{3},x_{4}\\}$，非基变量为 $\\{x_{2},x_{5}\\}$。将非基变量设为 $0$，从它们所在行的右端项（RHS）读取基变量的值：\n$$\nx_{1}=\\frac{5}{2},\\quad x_{3}=\\frac{15}{2},\\quad x_{4}=-\\frac{3}{2}.\n$$\n目标函数值是 $z$ 行的右端项：\n$$\nz=\\frac{85}{2}.\n$$\n按照基变量的下标 $(x_{1},x_{3},x_{4})$ 升序排列，所求的行向量是 $\\left[\\frac{5}{2},\\,\\frac{15}{2},\\, -\\frac{3}{2},\\, \\frac{85}{2}\\right]$。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{5}{2}  \\frac{15}{2}  -\\frac{3}{2}  \\frac{85}{2}\\end{pmatrix}}$$", "id": "2212987"}, {"introduction": "对偶单纯形法不仅能解决问题，还能检测出问题何时无解。这个实践练习 [@problem_id:2212994] 展示了一个关键的终止条件。通过应用轴心变换规则，你将达到一个无法再进行轴心变换的状态，从而揭示出其背后的原始问题是不可行的。", "problem": "给定以下最大化线性规划 (LP) 问题的初始单纯形表。决策变量为 $x_1$ 和 $x_2$，松弛变量为 $s_1$ 和 $s_2$，目标函数值为 $Z$。顶行代表了该问题在当前基下的目标函数。\n\n| Basic Var. | Z | $x_1$ | $x_2$ | $s_1$ | $s_2$ | RHS |\n|:-----------|:-:|:---:|:---:|:---:|:---:|:----|\n| Z          | 1 | 1   | 1   | 0   | 0   | 0   |\n| $s_1$      | 0 | -1  | -1  | 1   | 0   | -5  |\n| $s_2$      | 0 | 1   | 1   | 0   | 1   | 2   |\n\n此单纯形表是对偶可行的（目标行中所有非基变量的系数均为非负），但不是主可行的（至少有一个右端项的值为负）。您的任务是对该表应用对偶单纯形法，直到满足终止条件。根据单纯形表的最终状态，关于相关 LP 问题的性质，哪个结论是正确的？\n\nA. 该问题有唯一最优解。\n\nB. 该问题有多个最优解。\n\nC. 该问题不可行。\n\nD. 该问题无界。\n\nE. 对偶单纯形法不能应用于此表。", "solution": "我们给定了一个最大化 LP 单纯形表，它是对偶可行的（目标行中非基变量 $x_1, x_2$ 的检验数 $1, 1$ 均为非负），但不是主可行的（基变量 $s_1$ 的右端项为 $-5  0$）。因此适用对偶单纯形法。\n\n初始单纯形表：\n- 目标行：$Z + x_{1} + x_{2} = 0$\n- 约束行：\n  - $-x_{1} - x_{2} + s_{1} = -5$\n  - $x_{1} + x_{2} + s_{2} = 2$\n\n对偶单纯形法主元选择规则：\n- 选择具有最负右端项的行作为离基行。这里是 $s_{1}$ 所在行，因为其RHS为 $-5$。\n- 在主元行中，寻找系数 $a_{rj}  0$ 的非基列 $j$。然后，在这些候选中选择使比值 $\\frac{\\bar{c}_{j}}{-a_{rj}}$ 最小的列作为入基列。\n\n对于 $s_{1}$ 所在行，非基变量 $x_1$ 和 $x_2$ 的系数分别为 $a_{r,x_{1}} = -1$, $a_{r,x_{2}} = -1$。检验数分别为 $\\bar{c}_{x_{1}} = 1$, $\\bar{c}_{x_{2}} = 1$。\n计算比值：\n$$\n\\text{对于 } x_1: \\frac{\\bar{c}_{x_{1}}}{-a_{r,x_{1}}} = \\frac{1}{-(-1)} = 1\n$$\n$$\n\\text{对于 } x_2: \\frac{\\bar{c}_{x_{2}}}{-a_{r,x_{2}}} = \\frac{1}{-(-1)} = 1\n$$\n存在相等情况；我们按最小下标规则，选择 $x_{1}$ 作为入基变量。在 $a_{r,x_{1}} = -1$ 上进行主元变换。\n\n执行主元变换：\n- 将主元行乘以 $-1$：新 $x_1$ 行变为 $(0, 1, 1, -1, 0 | 5)$。\n- 从其他行中消去 $x_{1}$：\n  - 新 $Z$ 行 $=$ 旧 $Z$ 行 $- 1 \\times$ (新 $x_1$ 行) $\\Rightarrow (1, 0, 0, 1, 0 | -5)$。\n  - 新 $s_{2}$ 行 $=$ 旧 $s_{2}$ 行 $- 1 \\times$ (新 $x_1$ 行) $\\Rightarrow (0, 0, 0, 1, 1 | -3)$。\n\n新的单纯形表为：\n| Basic Var. | Z | $x_1$ | $x_2$ | $s_1$ | $s_2$ | RHS |\n|:-----------|:-:|:---:|:---:|:---:|:---:|:----|\n| Z          | 1 | 0   | 0   | 1   | 0   | -5  |\n| $x_1$      | 0 | 1   | 1   | -1  | 0   | 5   |\n| $s_2$      | 0 | 0   | 0   | 1   | 1   | -3  |\n\n现在基变量是 $x_{1}$ 和 $s_{2}$。该表仍然是对偶可行的（目标行非基变量系数 $0, 1$ 均为非负），但不是主可行的，因为 $s_{2}$ 行的右端项为 $-3  0$。\n\n再次应用对偶单纯形步骤：\n- 选择离基行：$s_{2}$ 所在行（右端项 $-3$ 是唯一的负值）。\n- 确定入基变量：我们需要在 $s_{2}$ 行中找到一个非基列 $j$（即 $x_2$ 或 $s_1$），其系数 $a_{rj}  0$。\n在 $s_{2}$ 行中，我们有系数：\n$$\na_{s_2, x_2} = 0, \\quad a_{s_2, s_1} = 1\n$$\n两者都不是负数。因此，没有合格的入基变量。\n\n这是对偶单纯形法的不可行性判据：如果一个离基行的右端项为负，并且在该行中，所有非基列的系数 $a_{rj}$ 均非负，则无法进行主元变换。这证明了原始 LP 问题是不可行的。\n\n作为独立检验，初始单纯形表所隐含的原始约束是：\n$$\n-x_{1} - x_{2} + s_{1} = -5 \\;\\Rightarrow\\; x_{1} + x_{2} \\ge 5\n$$\n$$\nx_{1} + x_{2} + s_{2} = 2 \\;\\Rightarrow\\; x_{1} + x_{2} \\le 2\n$$\n其中 $x_1, x_2, s_{1}, s_{2} \\ge 0$。这些约束是不一致的（一个数不可能同时大于等于5且小于等于2），证实了不可行性。\n\n因此，相关的 LP 问题是不可行的。", "answer": "$$\\boxed{C}$$", "id": "2212994"}]}