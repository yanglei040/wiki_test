{"hands_on_practices": [{"introduction": "单纯形法的每一步迭代都依赖于一个关键决策：选择哪个非基变量进入基，以最有效地改善目标函数。这个决策的核心是计算“检验数”（reduced cost）。通过这个练习 [@problem_id:2220984]，你将亲手计算一个检验数，深入理解单纯形法如何判断当前解是否最优以及如何寻找改进方向。", "problem": "一家科技初创公司正在为其两款新设备（设备X和设备Y）规划生产计划。生产受到两种关键资源可用性的限制：微芯片和电池组。该公司希望通过解决以下线性规划（LP）问题来最大化其利润：\n\n最大化总利润 $Z$，其目标函数为：\n$Z = 3x_1 + 5x_2$\n\n其中 $x_1$ 是生产的设备X的数量， $x_2$ 是生产的设备Y的数量。\n\n生产受到以下资源约束：\n1. 微芯片约束：$x_1 + 3x_2 \\le 9$\n2. 电池组约束：$2x_1 + x_2 \\le 8$\n\n以及非负约束 $x_1 \\ge 0$ 和 $x_2 \\ge 0$。\n\n为了使用单纯形法解决这个线性规划问题，通过引入非负松弛变量 $s_1$ 和 $s_2$ 将不等式转化为等式。约束的标准形式为：\n$x_1 + 3x_2 + s_1 = 9$\n$2x_1 + x_2 + s_2 = 8$\n\n在执行单纯形法的第一轮迭代后，基变量集合已更新为 $\\{x_2, s_2\\}$。相应的非基变量为 $\\{x_1, s_1\\}$。\n\n您的任务是计算算法当前阶段非基变量 $x_1$ 对应的检验数。请提供该检验数的精确数值。", "solution": "我们得到了标准形式的线性规划问题，变量顺序为 $(x_{1},x_{2},s_{1},s_{2})$，目标函数系数为 $c=(3,5,0,0)^{\\top}$，约束矩阵为\n$$\nA=\\begin{pmatrix}\n1   3  1  0\\\\\n2   1  0  1\n\\end{pmatrix},\\quad b=\\begin{pmatrix}9\\\\8\\end{pmatrix}.\n$$\n第一轮迭代后，基为 $\\{x_{2},s_{2}\\}$。令 $B$ 表示由 $A$ 中对应于 $x_{2}$ 和 $s_{2}$ 的列组成的基矩阵。从 $A$ 中可知，$x_{2}$ 对应的列是 $\\begin{pmatrix}3\\\\1\\end{pmatrix}$，$s_{2}$ 对应的列是 $\\begin{pmatrix}0\\\\1\\end{pmatrix}$，因此\n$$\nB=\\begin{pmatrix}3   0\\\\ 1  1\\end{pmatrix}.\n$$\n计算 $B^{-1}$。行列式为 $\\det(B)=3\\cdot 1-0\\cdot 1=3$，所以\n$$\nB^{-1}=\\frac{1}{3}\\begin{pmatrix}1   0\\\\ -1  3\\end{pmatrix}.\n$$\n基变量的成本向量为 $c_{B}^{\\top}=(5,0)$，因为 $c_{x_{2}}=5$ 且 $c_{s_{2}}=0$。对于列为 $a_{j}$、成本为 $c_{j}$ 的非基变量，其检验数由以下公式给出：\n$$\n\\bar{c}_{j}=c_{j}-c_{B}^{\\top}B^{-1}a_{j}.\n$$\n对于 $x_{1}$，我们有 $c_{1}=3$，其在 $A$ 中的列是 $a_{1}=\\begin{pmatrix}1\\\\2\\end{pmatrix}$。首先计算\n$$\nc_{B}^{\\top}B^{-1}=(5,0)\\cdot \\frac{1}{3}\\begin{pmatrix}1   0\\\\ -1  3\\end{pmatrix}=\\frac{1}{3}(5,0)=\\begin{pmatrix}\\frac{5}{3}  0\\end{pmatrix}.\n$$\n然后\n$$\nc_{B}^{\\top}B^{-1}a_{1}=\\begin{pmatrix}\\frac{5}{3}  0\\end{pmatrix}\\begin{pmatrix}1\\\\2\\end{pmatrix}=\\frac{5}{3}.\n$$\n因此，$x_{1}$ 的检验数是\n$$\n\\bar{c}_{1}=3-\\frac{5}{3}=\\frac{4}{3}.\n$$", "answer": "$$\\boxed{\\frac{4}{3}}$$", "id": "2220984"}, {"introduction": "在理论上，单纯形法可能会陷入“循环”，即在几个解之间来回迭代而无法达到最优解，尤其是在出现“退化”现象时。为了保证算法的收敛性，我们需要一个明确的规则来打破歧义。这个练习 [@problem_id:2220987] 将指导你应用布兰德规则（Bland's rule），这是一种经典的反循环策略，用于在选择进基和出基变量时处理出现的平局情况。", "problem": "考虑一个旨在最大化目标函数 $z$ 的线性规划问题。该问题包含变量 $x_1, \\ldots, x_6$。经过数次单纯形法迭代后，得到如下的单纯形表。目标行（第一行）写为 $z + \\sum_{j=1}^{6} r_j x_j = z_0$ 的形式，其中 $r_j$ 是变量 $x_j$ 的检验数。‘B’列表示每一行对应的基变量。当前的基变量集合是 $\\{x_1, x_3, x_4, x_6\\}$。该单纯形表是退化的，因为右端（RHS）列中某些基变量的值为零。\n\n    B  |  z    x1     x2     x3     x4     x5     x6  |  RHS\n    --------------------------------------------------------------\n    z  |  1     0     -2      0      0     -4      0  |   50\n    x1 |  0     1      2      0      0      1      0  |   10\n    x3 |  0     0      4      1      0     -1      0  |   12\n    x4 |  0     0      1      0      1      3      0  |    0\n    x6 |  0     0      3      0      0     -2      1  |    0\n\n你需要从此单纯形表开始，执行恰好一次主元变换操作。为了解决选择进基变量和出基变量时可能出现的歧义，你必须严格遵守Bland最小标号反循环规则。完成这次主元变换后，原主元行中的基变量将变为非基变量。确定这个特定变量的新检验数。", "solution": "目标是使用Bland最小标号规则对给定的单纯形表执行一次主元变换，并找出出基变量的新检验数。\n\n**步骤1：确定进基变量**\n\n首先，我们确定非基变量及其检验数。基变量是 $\\{x_1, x_3, x_4, x_6\\}$，因此非基变量是 $\\{x_2, x_5\\}$。检验数是它们在目标行中的系数。\n- $x_2$ 的检验数是 $-2$。\n- $x_5$ 的检验数是 $-4$。\n\n对于一个最大化问题，如果一个变量的检验数为负，则它是进基的候选变量。$x_2$ 和 $x_5$ 都是候选变量。\n\nBland最小标号规则规定，我们必须在所有候选变量中选择下标最小的那个。候选变量的下标是 2 和 5。因为 $2  5$，我们必须选择 $x_2$ 作为进基变量。第二列（$x_2$ 所在的列）是主元列。\n\n**步骤2：确定出基变量**\n\n接下来，我们执行最小比值检验来找出出基变量。我们对每个基变量所在的行，计算其右端项（RHS）值与主元列（$x_2$列）中对应正数条目的比值。\n\n- **$x_1$ 所在行**：$x_2$ 列中的条目是 2（为正数）。比值为 $\\frac{10}{2} = 5$。\n- **$x_3$ 所在行**：$x_2$ 列中的条目是 4（为正数）。比值为 $\\frac{12}{4} = 3$。\n- **$x_4$ 所在行**：$x_2$ 列中的条目是 1（为正数）。比值为 $\\frac{0}{1} = 0$。\n- **$x_6$ 所在行**：$x_2$ 列中的条目是 3（为正数）。比值为 $\\frac{0}{3} = 0$。\n\n最小非负比值为 0。$x_4$ 所在行与 $x_6$ 所在行出现平局。\n\n使用Bland最小标号规则来打破此平局。我们必须选择下标最小的变量出基。出现平局的基变量的下标是 4（对于$x_4$）和 6（对于$x_6$）。因为 $4  6$，我们选择 $x_4$ 作为出基变量。\n\n主元行是对应于基变量 $x_4$ 的那一行。\n\n**步骤3：执行主元变换**\n\n主元元素位于主元列（$x_2$）和主元行（$x_4$所在行）的交点处。主元元素是 1。\n\n变量 $x_4$ 将出基，问题要求计算它的新检验数。$x_4$ 的新检验数将是它在新单纯形表的目标行中的系数。要找到这个值，我们只需要更新目标行。\n\n设 $R_z$ 为当前目标行，$R_{x_4}$ 为当前主元行。\n$R_z = [1, 0, -2, 0, 0, -4, 0 | 50]$\n$R_{x_4} = [0, 0, 1, 0, 1, 3, 0 | 0]$\n\n新的目标行 $R_z'$ 计算如下：\n$R_z' = R_z - (\\text{coefficient in } R_z \\text{ at pivot column}) \\times R_{\\text{pivot}}$\n\n$R_z$ 中主元列（$x_2$）的系数是 $-2$。\n主元元素是 1，所以主元行 $R_{x_4}$ 不需要进行缩放。\n$R_z' = R_z - (-2) \\times R_{x_4} = R_z + 2 \\times R_{x_4}$\n\n$R_z' = [1, 0, -2, 0, 0, -4, 0 | 50] + 2 \\times [0, 0, 1, 0, 1, 3, 0 | 0]$\n$R_z' = [1, 0, -2, 0, 0, -4, 0 | 50] + [0, 0, 2, 0, 2, 6, 0 | 0]$\n$R_z' = [1, 0, (-2+2), 0, (0+2), (-4+6), 0 | (50+0)]$\n$R_z' = [1, 0, 0, 0, 2, 2, 0 | 50]$\n\n新的目标行对应方程 $z + 0x_1 + 0x_2 + 0x_3 + 2x_4 + 2x_5 + 0x_6 = 50$。\n\n出基的变量是 $x_4$。它的新检验数是它在新目标行中的系数，即 2。", "answer": "$$\\boxed{2}$$", "id": "2220987"}, {"introduction": "在解决实际优化问题时，我们不仅关心当前的最优解，更关心这个解对问题参数变化的敏感程度。例如，当产品的利润或成本发生变化时，我们的最优生产策略是否依然有效？这个练习 [@problem_id:2221022] 探讨了灵敏度分析，你将确定一个关键参数（产品利润）的变化范围，在此范围内，当前的最优基保持不变。", "problem": "一家小型电子公司正在为其两款新产品：“Alpha”设备和“Beta”设备，规划生产计划。每种产品的生产单位数量分别由 $x_1$ 和 $x_2$ 表示。$x_1$ 和 $x_2$ 都必须是非负的。\n\n销售一个“Beta”设备单位的利润是稳定的5。然而，一个“Alpha”设备单位的利润受到市场波动的影响，由参数 $\\theta$ 表示。公司的目标是最大化其总利润 $Z$。\n\n生产受到两个制造过程的限制。第一个过程总共有10小时的可用产能，第二个过程有8小时。\n- 制造一个“Alpha”设备单位（$x_1$）需要第一个过程2小时和第二个过程1小时。\n- 制造一个“Beta”设备单位（$x_2$）需要第一个过程1小时和第二个过程2小时。\n\n一项初步分析确定，对于利润参数 $\\theta$ 的某个取值范围，最优策略是同时生产正数量的“Alpha”和“Beta”设备。你的任务是确定这个范围的边界值。这些是 $\\theta$ 的临界值，在这些值上，最优基（要生产的产品集合）即将发生变化。\n\n找出 $\\theta$ 的这两个临界值。将你的答案以行矩阵的形式呈现，包含一对数字，并按从小到大的顺序排列。数字应为其精确的分数或整数形式。", "solution": "我们将该问题建模为线性规划：\n最大化 $Z = \\theta x_{1} + 5 x_{2}$，约束条件为\n$$\n\\begin{aligned}\n2x_{1} + x_{2} \\leq 10,\\\\\nx_{1} + 2x_{2} \\leq 8,\\\\\nx_{1}, x_{2} \\geq 0.\n\\end{aligned}\n$$\n令 $A=\\begin{pmatrix}2   1 \\\\ 1  2\\end{pmatrix}$，$b=\\begin{pmatrix}10 \\\\ 8\\end{pmatrix}$，以及 $c=\\begin{pmatrix}\\theta \\\\ 5\\end{pmatrix}$。题目说明，对于 $\\theta$ 的一个范围，最优解会使用两种产品的正数量。在这种情况下，两个资源约束在最优点上都必须是紧约束，因此我们求解\n$$\n\\begin{aligned}\n2x_{1} + x_{2} = 10,\\\\\nx_{1} + 2x_{2} = 8.\n\\end{aligned}\n$$\n从第二个方程得到，$x_{1} = 8 - 2x_{2}$。代入第一个方程得到\n$$\n2(8 - 2x_{2}) + x_{2} = 10 \\;\\Longrightarrow\\; 16 - 4x_{2} + x_{2} = 10 \\;\\Longrightarrow\\; -3x_{2} = -6 \\;\\Longrightarrow\\; x_{2} = 2,\n$$\n接着 $x_{1} = 8 - 2\\cdot 2 = 4$。因此，$x_{1},x_{2}  0$ 的候选最优点是 $(x_{1},x_{2})=(4,2)$。\n\n为了找出该点在哪些 $\\theta$ 值下是最优的，我们使用对偶（或KKT）最优性条件。该问题的对偶问题是\n$$\n\\min_{y \\geq 0} \\; b^{T} y \\quad \\text{subject to} \\quad A^{T} y \\geq c,\n$$\n其中 $y=\\begin{pmatrix}y_{1}\\\\y_{2}\\end{pmatrix}$。由于 $x_{1}0$ 和 $x_{2}0$，互补松弛性要求相应的对偶不等式以等式形式成立：\n$$\n\\begin{aligned}\n2y_{1} + y_{2} = \\theta,\\\\\ny_{1} + 2y_{2} = 5.\n\\end{aligned}\n$$\n求解这个关于 $y_1, y_2$ 的线性方程组，用 $\\theta$ 表示解。将第二个方程乘以2得到 $2y_{1} + 4y_{2} = 10$，然后减去第一个方程：\n$$\n(2y_{1} + 4y_{2}) - (2y_{1} + y_{2}) = 10 - \\theta \\;\\Longrightarrow\\; 3y_{2} = 10 - \\theta \\;\\Longrightarrow\\; y_{2} = \\frac{10 - \\theta}{3}.\n$$\n代入 $y_{1} + 2y_{2} = 5$：\n$$\ny_{1} + 2\\left(\\frac{10 - \\theta}{3}\\right) = 5 \\;\\Longrightarrow\\; y_{1} = 5 - \\frac{20 - 2\\theta}{3} = \\frac{2\\theta - 5}{3}.\n$$\n对偶可行性要求 $y_{1} \\geq 0$ 和 $y_{2} \\geq 0$，这施加了如下约束\n$$\n\\frac{2\\theta - 5}{3} \\geq 0 \\;\\Longrightarrow\\; \\theta \\geq \\frac{5}{2}, \\qquad \\frac{10 - \\theta}{3} \\geq 0 \\;\\Longrightarrow\\; \\theta \\leq 10.\n$$\n因此，当且仅当 $\\theta$ 处于区间 $\\left[\\frac{5}{2},\\,10\\right]$ 时，两种产品产量均为正的交点 $(4,2)$ 是最优的。最优基即将变化的边界（临界）值是 $\\theta = \\frac{5}{2}$ 和 $\\theta = 10$。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{5}{2}  10\\end{pmatrix}}$$", "id": "2221022"}]}