{"hands_on_practices": [{"introduction": "这第一个练习展示了正规方程最常见的应用：为一组数据点寻找最佳拟合直线。通过解决这个问题 [@problem_id:2218054]，你将学习如何将数据拟合问题转化为矩阵形式 $A\\mathbf{x} \\approx \\mathbf{b}$，并应用正规方程直接求解使平方误差最小化的模型参数。这是所有最小二乘法分析的基础。", "problem": "一位实验物理学家正在研究一个现象，并收集了四个数据点 $(x_i, y_i)$，分别是：$(0, 5)$、$(1, 2)$、$(2, -1)$ 和 $(3, 10)$。该物理学家希望使用一条形式为 $y = mx + c$ 的直线来模拟 $x$ 和 $y$ 之间的关系。\n\n为了确定斜率 $m$ 和 y轴截距 $c$ 的最优值，该物理学家使用了最小二乘法。该方法旨在找到一条直线，使得每个数据点到该直线的垂直距离的平方和最小。这个和通常用 $S$ 表示，由表达式 $S = \\sum_{i=1}^{4} (y_i - (mx_i + c))^2$ 给出。\n\n你的任务是计算这条最佳拟合直线的 $m$ 和 $c$ 的精确值。请将你的答案表示为有理数（即分数）形式。将你的最终答案以一个包含 $m$ 和 $c$ 值（按此顺序）的单行矩阵形式呈现。", "solution": "我们寻求 $m$ 和 $c$ 来最小化对于数据点 $(0,5)$、$(1,2)$、$(2,-1)$、$(3,10)$ 的最小二乘目标函数 $S=\\sum_{i=1}^{4}\\left(y_{i}-(m x_{i}+c)\\right)^{2}$。通过将关于 $m$ 和 $c$ 的偏导数设为零，我们得到正规方程组：\n$$\n\\frac{\\partial S}{\\partial m}=-2\\sum_{i=1}^{4}x_{i}\\left(y_{i}-(m x_{i}+c)\\right)=0,\\quad \\frac{\\partial S}{\\partial c}=-2\\sum_{i=1}^{4}\\left(y_{i}-(m x_{i}+c)\\right)=0.\n$$\n这导出了如下的线性方程组\n$$\nm\\sum_{i=1}^{4}x_{i}^{2}+c\\sum_{i=1}^{4}x_{i}=\\sum_{i=1}^{4}x_{i}y_{i},\\quad m\\sum_{i=1}^{4}x_{i}+4c=\\sum_{i=1}^{4}y_{i}.\n$$\n从数据中计算所需的和：\n$$\n\\sum_{i=1}^{4}x_{i}=0+1+2+3=6,\\quad \\sum_{i=1}^{4}y_{i}=5+2+(-1)+10=16,\n$$\n$$\n\\sum_{i=1}^{4}x_{i}^{2}=0^{2}+1^{2}+2^{2}+3^{2}=14,\\quad \\sum_{i=1}^{4}x_{i}y_{i}=0\\cdot 5+1\\cdot 2+2\\cdot(-1)+3\\cdot 10=30.\n$$\n将这些和代入正规方程组得到\n$$\n14m+6c=30,\\quad 6m+4c=16.\n$$\n为了消去 $c$，将第一个方程乘以 $2$，第二个方程乘以 $3$：\n$$\n28m+12c=60,\\quad 18m+12c=48.\n$$\n两式相减得到 $10m=12$，因此\n$$\nm=\\frac{6}{5}.\n$$\n将 $m$ 的值代入 $6m+4c=16$ 得到\n$$\n6\\cdot \\frac{6}{5}+4c=16\\;\\Rightarrow\\; \\frac{36}{5}+4c=16\\;\\Rightarrow\\; 4c=16-\\frac{36}{5}=\\frac{44}{5}\\;\\Rightarrow\\; c=\\frac{11}{5}.\n$$\n因此，最小二乘直线是 $y=\\frac{6}{5}x+\\frac{11}{5}$，所求的行矩阵是 $\\begin{pmatrix}\\frac{6}{5}  \\frac{11}{5}\\end{pmatrix}$。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{6}{5}  \\frac{11}{5} \\end{pmatrix}}$$", "id": "2218054"}, {"introduction": "除了简单的曲线拟合，最小二乘法还具有深刻的几何意义。这个练习 [@problem_id:2218040] 将问题描述为在子空间中寻找一个离空间外某点最近的点，也就是正交投影。这种几何视角对于理解为什么正规方程能得到在欧几里得距离意义下的最优解至关重要。", "problem": "您是一名控制系统工程师，正在研究一个简单的2自由度 (2-DOF) 机械臂。该机器人的末端执行器在三维空间中移动，其相对于基座的位置由坐标向量 $\\mathbf{p} = [x, y, z]^T$ 描述。该机器人的运动由两个独立的执行器产生。第一个执行器沿方向向量 $\\mathbf{u}_1 = [1, 0, 1]^T$ 移动末端执行器，第二个执行器沿方向向量 $\\mathbf{u}_2 = [0, 1, 1]^T$ 移动它。因此，任何可达位置 $\\mathbf{p}_{reach}$ 都必须是这两个向量的线性组合：$\\mathbf{p}_{reach} = c_1 \\mathbf{u}_1 + c_2 \\mathbf{u}_2$，其中标量系数 $c_1$ 和 $c_2$ 代表执行器的位移。这意味着所有可达点的集合构成一个穿过原点的平面。\n\n一项任务要求机器人的末端执行器移动到目标位置 $\\mathbf{b} = [1, 2, 2]^T$。这个点可能不在机器人的可达平面内。控制系统的目标是在可达平面内找到一个点 $\\mathbf{p}^*$，该点在几何上最接近目标点 $\\mathbf{b}$。这个最优点是 $\\mathbf{b}$ 在由执行器方向向量所张成的子空间上的正交投影。\n\n使用法方程法，确定这个最优可达点 $\\mathbf{p}^*$ 的坐标向量。请用一个包含精确分数分量的列向量表示您的答案。", "solution": "问题要求解向量 $\\mathbf{b}$ 在由向量 $\\mathbf{u}_1$ 和 $\\mathbf{u}_2$ 所张成的子空间上的正交投影。这个子空间是矩阵 $A$ 的列空间，其中 $A$ 的列是 $\\mathbf{u}_1$ 和 $\\mathbf{u}_2$。投影 $\\mathbf{p}^*$ 是 $A$ 的列空间中最接近 $\\mathbf{b}$ 的向量。\n\n首先，我们定义矩阵 $A$ 和向量 $\\mathbf{b}$：\n$$ A = \\begin{bmatrix} 1  0 \\\\ 0  1 \\\\ 1  1 \\end{bmatrix}, \\quad \\mathbf{b} = \\begin{bmatrix} 1 \\\\ 2 \\\\ 2 \\end{bmatrix} $$\n\n投影 $\\mathbf{p}^*$ 可以表示为 $A$ 的列的线性组合，即 $\\mathbf{p}^* = A\\mathbf{c}^*$，其中 $\\mathbf{c}^* = \\begin{bmatrix} c_1 \\\\ c_2 \\end{bmatrix}$ 是使欧几里得距离的平方 $\\|A\\mathbf{c} - \\mathbf{b}\\|^2$ 最小化的系数向量。这是一个线性最小二乘问题。解 $\\mathbf{c}^*$ 可以通过求解法方程得到：\n$$ A^T A \\mathbf{c}^* = A^T \\mathbf{b} $$\n\n我们通过计算该方程的各部分来进行求解。\n\n步骤1：计算矩阵 $A^T A$。\n$A$ 的转置是：\n$$ A^T = \\begin{bmatrix} 1  0  1 \\\\ 0  1  1 \\end{bmatrix} $$\n现在，我们计算乘积 $A^T A$：\n$$ A^T A = \\begin{bmatrix} 1  0  1 \\\\ 0  1  1 \\end{bmatrix} \\begin{bmatrix} 1  0 \\\\ 0  1 \\\\ 1  1 \\end{bmatrix} = \\begin{bmatrix} (1)(1)+(0)(0)+(1)(1)  (1)(0)+(0)(1)+(1)(1) \\\\ (0)(1)+(1)(0)+(1)(1)  (0)(0)+(1)(1)+(1)(1) \\end{bmatrix} = \\begin{bmatrix} 2  1 \\\\ 1  2 \\end{bmatrix} $$\n\n步骤2：计算向量 $A^T \\mathbf{b}$。\n$$ A^T \\mathbf{b} = \\begin{bmatrix} 1  0  1 \\\\ 0  1  1 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 2 \\\\ 2 \\end{bmatrix} = \\begin{bmatrix} (1)(1)+(0)(2)+(1)(2) \\\\ (0)(1)+(1)(2)+(1)(2) \\end{bmatrix} = \\begin{bmatrix} 3 \\\\ 4 \\end{bmatrix} $$\n\n步骤3：求解法方程以得到 $\\mathbf{c}^*$。\n该方程组为：\n$$ \\begin{bmatrix} 2  1 \\\\ 1  2 \\end{bmatrix} \\begin{bmatrix} c_1 \\\\ c_2 \\end{bmatrix} = \\begin{bmatrix} 3 \\\\ 4 \\end{bmatrix} $$\n这对应于两个线性方程：\n1) $2c_1 + c_2 = 3$\n2) $c_1 + 2c_2 = 4$\n\n从方程(1)中，我们可以用 $c_1$ 表示 $c_2$：\n$c_2 = 3 - 2c_1$\n\n将此代入方程(2)：\n$c_1 + 2(3 - 2c_1) = 4$\n$c_1 + 6 - 4c_1 = 4$\n$-3c_1 = -2$\n$c_1 = \\frac{2}{3}$\n\n现在，将 $c_1$ 的值代回以求得 $c_2$：\n$c_2 = 3 - 2\\left(\\frac{2}{3}\\right) = 3 - \\frac{4}{3} = \\frac{9}{3} - \\frac{4}{3} = \\frac{5}{3}$\n所以，系数向量是 $\\mathbf{c}^* = \\begin{bmatrix} 2/3 \\\\ 5/3 \\end{bmatrix}$。\n\n步骤4：计算投影向量 $\\mathbf{p}^*$。\n最优可达点 $\\mathbf{p}^*$ 由 $A\\mathbf{c}^*$ 给出：\n$$ \\mathbf{p}^* = A\\mathbf{c}^* = \\begin{bmatrix} 1  0 \\\\ 0  1 \\\\ 1  1 \\end{bmatrix} \\begin{bmatrix} \\frac{2}{3} \\\\ \\frac{5}{3} \\end{bmatrix} = \\begin{bmatrix} (1)\\left(\\frac{2}{3}\\right) + (0)\\left(\\frac{5}{3}\\right) \\\\ (0)\\left(\\frac{2}{3}\\right) + (1)\\left(\\frac{5}{3}\\right) \\\\ (1)\\left(\\frac{2}{3}\\right) + (1)\\left(\\frac{5}{3}\\right) \\end{bmatrix} = \\begin{bmatrix} \\frac{2}{3} \\\\ \\frac{5}{3} \\\\ \\frac{2}{3} + \\frac{5}{3} \\end{bmatrix} = \\begin{bmatrix} \\frac{2}{3} \\\\ \\frac{5}{3} \\\\ \\frac{7}{3} \\end{bmatrix} $$\n\n最优可达点的坐标向量是 $\\mathbf{p}^* = [2/3, 5/3, 7/3]^T$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{2}{3} \\\\\n\\frac{5}{3} \\\\\n\\frac{7}{3}\n\\end{pmatrix}\n}\n$$", "id": "2218040"}, {"introduction": "正规方程的有效性依赖于一个关键条件：模型基函数的线性无关性。这个练习 [@problem_id:2218008] 探讨了当这个条件不被满足时的情形，此时会导致一个无法唯一求解的奇异系统。理解这一局限性对于在实践中建立有效且稳健的线性模型至关重要。", "problem": "一位初级分析师的任务是为一个控制变量 $x$ 和一个测量响应 $y$ 之间的关系建模。该分析师收集了 $m$ 个数据点 $(x_i, y_i)$，其中 $i=1, \\dots, m$。已知 $m  2$ 且并非所有的 $x_i$ 值都为零。所提出的模型是两个基函数 $f_1(x)$ 和 $f_2(x)$ 的线性组合，使得预测响应为 $\\hat{y} = c_1 f_1(x) + c_2 f_2(x)$。该分析师选择了函数 $f_1(x) = x$ 和 $f_2(x) = 2x$。\n\n为了找到最优系数 $c_1$ 和 $c_2$，该分析师使用了线性最小二乘法，其目标是找到系数向量 $\\mathbf{c} = [c_1, c_2]^T$ 以最小化观测响应和预测响应之间的平方误差和。这通过求解正规方程 $A^T A \\mathbf{c} = A^T \\mathbf{y}$ 来实现，其中 $A$ 是由基函数和数据构建的设计矩阵。\n\n在尝试数值求解此系统时，软件返回一个错误，指出矩阵 $A^T A$ 是奇异的，无法找到系数的唯一解。下列哪个选项为此问题提供了正确的数学解释？\n\nA. 数据点数量 $m$ 太少，无法唯一确定两个系数 $c_1$ 和 $c_2$。\nB. 该模型存在缺陷，因为问题本质上是非线性的，不能用线性最小二乘法求解。\nC. 基函数 $f_1(x) = x$ 和 $f_2(x) = 2x$ 是线性相关的。\nD. 测量响应值 $y_i$ 全部为零，导致软件无法处理的平凡解。\nE. 转置操作无效，因为设计矩阵 $A$ 不是方阵。", "solution": "我们通过在每个数据点上评估基函数来构建设计矩阵。对于每个 $i \\in \\{1,\\dots,m\\}$，$A$ 的第 $i$ 行为\n$$\n\\begin{pmatrix} f_{1}(x_{i})  f_{2}(x_{i}) \\end{pmatrix}=\\begin{pmatrix} x_{i}  2x_{i} \\end{pmatrix}.\n$$\n因此，$A$ 的两列是\n$$\na_{1}=\\begin{pmatrix} x_{1} \\\\ \\vdots \\\\ x_{m} \\end{pmatrix}, \\qquad a_{2}=\\begin{pmatrix} 2x_{1} \\\\ \\vdots \\\\ 2x_{m} \\end{pmatrix}=2a_{1}.\n$$\n因此，这些列是线性相关的，所以 $\\operatorname{rank}(A)=12$。在线性最小二乘法中，正规方程为\n$$\nA^{T}A\\,\\mathbf{c}=A^{T}\\mathbf{y}.\n$$\n唯一最小二乘解的充要条件是 $A$ 具有满列秩，等价于 $A^{T}A$ 是可逆的。由于 $A$ 的列是线性相关的，所以 $A^{T}A$ 是奇异的。\n\n这可以通过显式计算 $A^{T}A$ 来看出。令 $S=\\sum_{i=1}^{m} x_{i}^{2}$。那么\n$$\nA^{T}A=\\begin{pmatrix}\n\\sum_{i=1}^{m} x_{i}^{2}  \\sum_{i=1}^{m} 2x_{i}^{2} \\\\\n\\sum_{i=1}^{m} 2x_{i}^{2}  \\sum_{i=1}^{m} 4x_{i}^{2}\n\\end{pmatrix}\n=\\begin{pmatrix}\nS  2S \\\\\n2S  4S\n\\end{pmatrix}\n=S\\begin{pmatrix}\n1  2 \\\\\n2  4\n\\end{pmatrix}.\n$$\n其行列式为\n$$\n\\det(A^{T}A)=S^{2}\\left(1\\cdot 4-2\\cdot 2\\right)=S^{2}\\cdot 0=0,\n$$\n所以 $A^{T}A$ 是奇异的。因为并非所有 $x_{i}$ 都为零，所以 $S0$，但由于列相关性，行列式仍然为零。\n\n因此，正确的解释是基函数 $f_{1}(x)=x$ 和 $f_{2}(x)=2x$ 是线性相关的，导致 $A$ 是秩亏的且 $A^{T}A$ 是奇异的。其他选项是不正确的：在没有独立列的情况下，$m2$ 并不能保证唯一性（A 是错误的）；模型在系数上是线性的，因此线性最小二乘法是适用的（B 是错误的）；$y_{i}=0$ 不会导致 $A^{T}A$ 的奇异性（D 是错误的）；并且转置操作对非方阵 $A$ 是有效的（E 是错误的）。", "answer": "$$\\boxed{C}$$", "id": "2218008"}]}