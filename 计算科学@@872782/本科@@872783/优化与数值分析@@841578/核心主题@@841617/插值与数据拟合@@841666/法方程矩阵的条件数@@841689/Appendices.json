{"hands_on_practices": [{"introduction": "法方程矩阵 $A^TA$ 的条件数与矩阵 $A$ 的列向量之间的几何关系密切相关。当这些向量近乎共线时，矩阵会变得病态。本练习 [@problem_id:2162074] 通过一个简单的几何设定，即两个向量之间夹角 $\\theta$ 很小，来直观地揭示这一原理。通过分析条件数如何随着 $\\theta$ 趋近于零而急剧增大，您将对病态条件的几何根源建立起深刻的直觉。", "problem": "在数值线性代数中，矩阵的条件性是衡量其对输入数据中误差敏感性的一个关键指标。对于一个线性最小二乘问题 $A\\mathbf{x} \\approx \\mathbf{b}$，其敏感性由正规方程矩阵 $A^TA$ 的条件数决定。当矩阵 $A$ 的列向量近似线性相关时，通常会出现病态情况。\n\n考虑一个简单的 $2 \\times 2$ 矩阵 $A$，其列向量代表平面中的两个基向量。第一列是向量 $\\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$，第二列是向量 $\\begin{pmatrix} \\cos\\theta \\\\ \\sin\\theta \\end{pmatrix}$，其中 $\\theta$（以弧度为单位）是两个向量之间的夹角。假设 $\\theta$ 是一个小的正角。因此，矩阵 $A$ 由 $A = \\begin{pmatrix} 1  \\cos\\theta \\\\ 0  \\sin\\theta \\end{pmatrix}$ 给出。\n\n求当 $\\theta \\to 0^+$ 时，相关的正规方程矩阵 $A^TA$ 的 2-范数条件数的主阶渐近表达式。你的答案应该是一个关于 $\\theta$ 的简单表达式，能够捕捉小角度下的主导行为。", "solution": "我们要求解在 $\\theta \\to 0^{+}$ 的极限下，对于矩阵 $A=\\begin{pmatrix} 1  \\cos\\theta \\\\ 0  \\sin\\theta \\end{pmatrix}$，其正规方程矩阵 $A^{T}A$ 的 2-范数条件数。对于一个对称正定矩阵 $M$，其 2-范数条件数为 $\\kappa_{2}(M)=\\frac{\\lambda_{\\max}(M)}{\\lambda_{\\min}(M)}$，其中 $\\lambda_{\\max}$ 和 $\\lambda_{\\min}$ 分别是 $M$ 的最大和最小特征值。\n\n计算 $A^{T}A$：\n$$\nA^{T}=\\begin{pmatrix} 1  0 \\\\ \\cos\\theta  \\sin\\theta \\end{pmatrix}, \\quad\nA^{T}A=\\begin{pmatrix} 1  \\cos\\theta \\\\ \\cos\\theta  1 \\end{pmatrix}.\n$$\n矩阵 $\\begin{pmatrix} 1  \\cos\\theta \\\\ \\cos\\theta  1 \\end{pmatrix}$ 的特征值为\n$$\n\\lambda_{\\pm}=1 \\pm \\cos\\theta.\n$$\n因此，\n$$\n\\kappa_{2}(A^{T}A)=\\frac{\\lambda_{\\max}}{\\lambda_{\\min}}=\\frac{1+\\cos\\theta}{1-\\cos\\theta}.\n$$\n对于小的 $\\theta$，使用泰勒展开 $\\cos\\theta=1-\\frac{\\theta^{2}}{2}+O(\\theta^{4})$。由此\n$$\n1-\\cos\\theta=\\frac{\\theta^{2}}{2}+O(\\theta^{4}), \\quad 1+\\cos\\theta=2-\\frac{\\theta^{2}}{2}+O(\\theta^{4}).\n$$\n于是\n$$\n\\kappa_{2}(A^{T}A)=\\frac{2-\\frac{\\theta^{2}}{2}+O(\\theta^{4})}{\\frac{\\theta^{2}}{2}+O(\\theta^{4})}\n=\\frac{4}{\\theta^{2}}+O(1),\n$$\n所以当 $\\theta \\to 0^{+}$ 时，主阶渐近行为是\n$$\n\\kappa_{2}(A^{T}A)\\sim \\frac{4}{\\theta^{2}}.\n$$", "answer": "$$\\boxed{\\frac{4}{\\theta^{2}}}$$", "id": "2162074"}, {"introduction": "上一练习中的抽象几何问题在多项式回归等实际应用中会频繁出现。当对非常接近的数据点进行拟合时，设计矩阵 $A$ 的列会变得几乎线性相关，导致同样严重的病态问题。本练习 [@problem_id:2162115] 将量化这种效应，分析为两个紧密间隔的数据点拟合一条直线时，法方程矩阵的条件数是如何随数据点间距 $\\epsilon$ 的减小而恶化的。", "problem": "考虑一个线性最小二乘问题，用于将模型 $y(x) = c_1 + c_2 x$ 拟合到两个数据点。这些数据点的x坐标由 $x_1 = 1$ 和 $x_2 = 1 + \\epsilon$ 给出，其中 $\\epsilon$ 是一个小的正实数。该问题的设计矩阵 $A$ 的元素为 $A_{ij} = x_i^{j-1}$，其中 $i,j \\in \\{1,2\\}$。求解相关正规方程 $A^T A \\mathbf{c} = A^T \\mathbf{y}$ 的稳定性与矩阵 $B(\\epsilon) = A^T A(\\epsilon)$ 的条件数有关。\n\n对称正定矩阵 $B(\\epsilon)$ 的2-范数条件数定义为其最大特征值与最小特征值之比，即 $\\kappa_2(B(\\epsilon)) = \\frac{\\lambda_{\\max}(B(\\epsilon))}{\\lambda_{\\min}(B(\\epsilon))}$。对于小的 $\\epsilon$，该条件数可以通过以下形式的渐近公式来近似：\n$$ \\kappa_2(B(\\epsilon)) \\approx \\frac{C}{\\epsilon^n} $$\n其中 $C$ 是一个正常数， $n$ 是一个正整数。\n\n确定常数 $C$ 和整数 $n$ 的值。将你的答案表示为一个1x2的行矩阵，其元素按顺序为 $C$ 和 $n$。", "solution": "我们为 $x_{1}=1$ 和 $x_{2}=1+\\epsilon$ 这两个点构建范德蒙德型设计矩阵：\n$$\nA=\\begin{pmatrix}\n1  x_{1} \\\\\n1  x_{2}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1  1 \\\\\n1  1+\\epsilon\n\\end{pmatrix}.\n$$\n正规矩阵是 $B(\\epsilon)=A^{T}A$，当 $\\epsilon0$ 时，该矩阵是对称正定的（因为当 $x_{1}\\neq x_{2}$ 时，$A$ 的两行是线性无关的）。显式计算 $B(\\epsilon)$：\n$$\nB(\\epsilon)=A^{T}A=\n\\begin{pmatrix}\n\\sum_{i=1}^{2}1^{2}  \\sum_{i=1}^{2}1\\cdot x_{i} \\\\\n\\sum_{i=1}^{2}x_{i}\\cdot 1  \\sum_{i=1}^{2}x_{i}^{2}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n2  2+\\epsilon \\\\\n2+\\epsilon  2+2\\epsilon+\\epsilon^{2}\n\\end{pmatrix}.\n$$\n对于一个 $2\\times 2$ 的对称矩阵 $\\begin{pmatrix}a  b \\\\ b  c\\end{pmatrix}$，其特征值满足 $\\lambda_{\\max}+\\lambda_{\\min}=\\operatorname{tr}=a+c$ 和 $\\lambda_{\\max}\\lambda_{\\min}=\\det=ac-b^{2}$。这里，\n$$\na=2,\\quad b=2+\\epsilon,\\quad c=2+2\\epsilon+\\epsilon^{2}.\n$$\n因此行列式为\n$$\n\\det B(\\epsilon)=ac-b^{2}=2(2+2\\epsilon+\\epsilon^{2})-(2+\\epsilon)^{2}=(4+4\\epsilon+2\\epsilon^{2})-(4+4\\epsilon+\\epsilon^{2})=\\epsilon^{2}.\n$$\n当 $\\epsilon=0$ 时，我们有\n$$\nB(0)=\\begin{pmatrix}2  2 \\\\ 2  2\\end{pmatrix},\n$$\n其特征值为 $4$ 和 $0$。因此，对于小的 $\\epsilon0$，根据连续性，\n$$\n\\lambda_{\\max}(B(\\epsilon))=4+O(\\epsilon).\n$$\n使用恒等式 $\\lambda_{\\min}=\\det/\\lambda_{\\max}$，\n$$\n\\lambda_{\\min}(B(\\epsilon))=\\frac{\\det B(\\epsilon)}{\\lambda_{\\max}(B(\\epsilon))}=\\frac{\\epsilon^{2}}{4+O(\\epsilon)}=\\frac{1}{4}\\epsilon^{2}+O(\\epsilon^{3}).\n$$\n因此，2-范数条件数为\n$$\n\\kappa_{2}(B(\\epsilon))=\\frac{\\lambda_{\\max}(B(\\epsilon))}{\\lambda_{\\min}(B(\\epsilon))}=\\frac{4+O(\\epsilon)}{\\frac{1}{4}\\epsilon^{2}+O(\\epsilon^{3})}=\\frac{16}{\\epsilon^{2}}+O\\!\\left(\\frac{1}{\\epsilon}\\right).\n$$\n因此，渐近形式 $\\kappa_{2}(B(\\epsilon))\\approx \\frac{C}{\\epsilon^{n}}$ 具有\n$$\nC=16,\\quad n=2.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}16  2\\end{pmatrix}}$$", "id": "2162115"}, {"introduction": "在掌握了病态问题的渐近行为之后，现在我们转向一个具体的数值计算，以体会其实际影响。本练习 [@problem_id:2218032] 提供了一组典型的实验数据，并要求您计算相应法方程矩阵 $A^TA$ 的条件数。通过这个动手计算，您将看到在实际场景中条件数可以变得多么巨大，从而深刻理解为何识别和缓解病态问题在科学计算中至关重要。", "problem": "在科学计算中，正规方程法是求解形如 $A\\mathbf{x} \\approx \\mathbf{b}$ 的线性最小二乘问题的常用方法。该方法将问题转化为求解一个方阵线性系统 $(A^T A)\\mathbf{x} = A^T\\mathbf{b}$。然而，如果矩阵 $M = A^T A$ 是病态的，这种方法可能会遭受数值不稳定性的影响。当矩阵 $A$ 的列近似线性相关时，病态性通常会加剧。\n\n考虑一个实验，其中物理量 $y$ 被建模为时间 $t$ 的线性函数，即 $y(t) = c_0 + c_1 t$。为了确定系数 $c_0$ 和 $c_1$，在时间 $t_1 = 100.0$，$t_2 = 101.0$ 和 $t_3 = 102.0$ 对 $y$ 进行了三次测量。该问题对应的最小二乘矩阵 $A$ 由下式给出：\n$$A = \\begin{pmatrix} 1  t_1 \\\\ 1  t_2 \\\\ 1  t_3 \\end{pmatrix}$$\n求解正规方程的数值稳定性与矩阵 $M = A^T A$ 的条件数有关。对于像 $M$ 这样的对称正定矩阵，谱条件数（记作 $\\kappa_2(M)$）定义为其最大特征值与最小特征值之比：\n$$\\kappa_2(M) = \\frac{\\lambda_{\\max}}{\\lambda_{\\min}}$$\n大的条件数表明矩阵是病态的。\n\n你的任务是计算由上述测量时间定义的矩阵 $A$ 的谱条件数 $\\kappa_2(A^T A)$。将你的最终答案四舍五入到四位有效数字。", "solution": "给定 $A=\\begin{pmatrix}1  t_{1}\\\\ 1  t_{2}\\\\ 1  t_{3}\\end{pmatrix}$，其中 $t_{1}=100$，$t_{2}=101$，$t_{3}=102$。正规方程矩阵为\n$$\nA^{T}A=\\begin{pmatrix}\n\\sum_{i=1}^{3}1  \\sum_{i=1}^{3}t_{i}\\\n$$4pt]\n\\sum_{i=1}^{3}t_{i}  \\sum_{i=1}^{3}t_{i}^{2}\n\\end{pmatrix}.\n$$\n计算各项和：\n$$\n\\sum_{i=1}^{3}1=3,\\quad \\sum_{i=1}^{3}t_{i}=100+101+102=303,\\quad \\sum_{i=1}^{3}t_{i}^{2}=10000+10201+10404=30605.\n$$\n因此\n$$\nA^{T}A=\\begin{pmatrix}3  303\\\\ 303  30605\\end{pmatrix}.\n$$\n对于一个对称的 $2\\times 2$ 矩阵 $\\begin{pmatrix}a  b\\\\ b  c\\end{pmatrix}$，其特征值为\n$$\n\\lambda_{\\pm}=\\frac{(a+c)\\pm\\sqrt{(a-c)^{2}+4b^{2}}}{2}.\n$$\n等价地，设迹 $\\tau=a+c$ 和行列式 $\\det=ac-b^{2}$，我们可以写成\n$$\n\\lambda_{\\pm}=\\frac{\\tau\\pm\\sqrt{\\tau^{2}-4\\det}}{2}.\n$$\n这里 $a=3$，$b=303$，$c=30605$，所以\n$$\n\\tau=3+30605=30608,\\qquad \\det=3\\cdot 30605-303^{2}=91815-91809=6,\n$$\n和\n$$\nD=\\tau^{2}-4\\det=30608^{2}-24=936849640.\n$$\n因此\n$$\n\\lambda_{\\max}=\\frac{\\tau+\\sqrt{D}}{2},\\qquad \\lambda_{\\min}=\\frac{\\tau-\\sqrt{D}}{2}.\n$$\n谱条件数为\n$$\n\\kappa_{2}(A^{T}A)=\\frac{\\lambda_{\\max}}{\\lambda_{\\min}}=\\frac{\\tau+\\sqrt{D}}{\\tau-\\sqrt{D}}.\n$$\n为了避免相消误差，重写为\n$$\n\\kappa_{2}(A^{T}A)=\\frac{(\\tau+\\sqrt{D})^{2}}{\\tau^{2}-D}=\\frac{(\\tau+\\sqrt{D})^{2}}{4\\det}=\\frac{(30608+\\sqrt{936849640})^{2}}{24}.\n$$\n精确计算 $\\sqrt{936849640}$。注意到 $30608^{2}=936849664$，所以\n$$\n\\sqrt{936849640}=\\sqrt{30608^{2}-24}\\approx 30608-\\frac{24}{2\\cdot 30608}=30608-\\frac{3}{7652}\\approx 30607.9996079456.\n$$\n因此\n$$\n\\tau+\\sqrt{D}\\approx 61215.9996079456,\n$$\n所以\n$$\n(\\tau+\\sqrt{D})^{2}\\approx 3{,}747{,}398{,}608,\n$$\n因此\n$$\n\\kappa_{2}(A^{T}A)\\approx \\frac{3{,}747{,}398{,}608}{24}=156{,}141{,}608.666\\ldots\n$$\n四舍五入到四位有效数字，得到\n$$\n\\kappa_{2}(A^{T}A)\\approx 1.561\\times 10^{8}.\n$$", "answer": "$$\\boxed{1.561 \\times 10^{8}}$$", "id": "2218032"}]}