{"hands_on_practices": [{"introduction": "这项练习将最小二乘法的核心概念具体化，将其应用于一个可触摸的三维问题：寻找最佳拟合平面。通过解决这个问题，你将练习如何为一个多变量模型建立并求解正规方程，这是数据拟合中的一项基本技能 [@problem_id:2212243]。", "problem": "一位质量控制工程师正在检查一块新制造的矩形板，该板应为完全平坦的。为评估其平整度，工程师使用三坐标测量机记录板表面上几个点的高度 $z$，这些点对应于坐标 $(x, y)$。工程师为板表面建立的模型是一个由方程 $z = ax + by + c$ 定义的平面，其中 $a$ 和 $b$ 分别表示在 $x$ 和 $y$ 方向上的倾斜度，而 $c$ 是在原点 $(0, 0)$ 处的高度。\n\n采集了以下四个测量数据，所有坐标均以无量纲单位给出：\n- 点 1：$(x_1, y_1, z_1) = (0, 0, 1)$\n- 点 2：$(x_2, y_2, z_2) = (1, 0, 3)$\n- 点 3：$(x_3, y_3, z_3) = (0, 2, 2)$\n- 点 4：$(x_4, y_4, z_4) = (1, 2, 5)$\n\n假设“最佳拟合”平面是使测量点与平面之间的垂直距离平方和最小的平面，请确定参数 $a$、$b$ 和 $c$ 的最优值。\n\n将参数 $(a, b, c)$ 的最终答案以行矩阵的形式呈现。", "solution": "我们将表面建模为 $z=ax+by+c$，并通过最小化残差平方和 $S(a,b,c)=\\sum_{i=1}^{4}\\left(ax_{i}+by_{i}+c-z_{i}\\right)^{2}$ 来寻求 $(a,b,c)$ 的最小二乘估计。将 $S$ 相对于 $(a,b,c)$ 的梯度设为零，得到正规方程\n$$\nX^{T}X\\,\\theta=X^{T}z,\n$$\n其中 $X$ 的行为 $[x_{i}\\;y_{i}\\;1]$，$z$ 是测量高度的向量，且 $\\theta=\\begin{pmatrix}a\\\\ b\\\\ c\\end{pmatrix}$。根据数据，\n$$\nX=\\begin{pmatrix}\n0  0  1\\\\\n1  0  1\\\\\n0  2  1\\\\\n1  2  1\n\\end{pmatrix},\\quad\nz=\\begin{pmatrix}\n1\\\\\n3\\\\\n2\\\\\n5\n\\end{pmatrix}.\n$$\n计算\n$$\nX^{T}X=\\begin{pmatrix}\n\\sum x_{i}^{2}  \\sum x_{i}y_{i}  \\sum x_{i}\\\\\n\\sum x_{i}y_{i}  \\sum y_{i}^{2}  \\sum y_{i}\\\\\n\\sum x_{i}  \\sum y_{i}  4\n\\end{pmatrix}\n=\\begin{pmatrix}\n2  2  2\\\\\n2  8  4\\\\\n2  4  4\n\\end{pmatrix},\n$$\n和\n$$\nX^{T}z=\\begin{pmatrix}\n\\sum x_{i}z_{i}\\\\\n\\sum y_{i}z_{i}\\\\\n\\sum z_{i}\n\\end{pmatrix}\n=\\begin{pmatrix}\n8\\\\\n14\\\\\n11\n\\end{pmatrix}.\n$$\n因此我们求解\n$$\n\\begin{pmatrix}\n2  2  2\\\\\n2  8  4\\\\\n2  4  4\n\\end{pmatrix}\n\\begin{pmatrix}\na\\\\\nb\\\\\nc\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n8\\\\\n14\\\\\n11\n\\end{pmatrix}.\n$$\n将每个方程除以 $2$ 得到\n$$\n\\begin{cases}\na+b+c=4,\\\\\na+4b+2c=7,\\\\\na+2b+2c=\\frac{11}{2}.\n\\end{cases}\n$$\n用第二个方程减去第一个方程得到 $3b+c=3$，用第三个方程减去第一个方程得到 $b+c=\\frac{3}{2}$。将这两个方程相减得到 $2b=\\frac{3}{2}$，因此 $b=\\frac{3}{4}$。代入 $b+c=\\frac{3}{2}$ 得到 $c=\\frac{3}{4}$。最后，从 $a+b+c=4$ 我们得到 $a=4-\\frac{3}{4}-\\frac{3}{4}=\\frac{5}{2}$。因此，最小二乘最佳拟合参数为 $(a,b,c)=\\left(\\frac{5}{2},\\frac{3}{4},\\frac{3}{4}\\right)$。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{5}{2}  \\frac{3}{4}  \\frac{3}{4}\\end{pmatrix}}$$", "id": "2212243"}, {"introduction": "这项练习超越了标准的最小二乘法，介绍了“总体最小二乘法”的概念，这在所有测量变量都存在误差时至关重要。通过最小化数据点到拟合直线的垂直距离，你将学习一种更稳健的拟合技术，并体会到“最佳拟合”的定义取决于对误差来源的假设 [@problem_id:2212231]。", "problem": "一名物理系本科生正在研究一个在近乎无摩擦的直导线上的小珠子的运动。一个理论模型预测珠子的位置 $p$ 与实验控制参数时间 $t$ 之间存在线性关系，由方程 $p = mt + c$ 给出。为了检验这个理论并确定常数 $m$ 和 $c$，该学生收集了一系列数据点。然而，由于测量设备固有的局限性，位置读数和时间测量都存在随机实验误差。\n\n该学生决定采用一种考虑了两个变量中都存在误差的方法来找到“最佳拟合”直线。该方法将最佳拟合直线定义为使每个数据点到直线的*垂直*距离的平方和最小化的那条直线。\n\n收集到的实验数据由四个 $(t, p)$ 对组成，如下所示：\n(2 s, 3 m), (4 s, 8 m), (7 s, 10 m), (9 s, 15 m).\n\n使用这些数据，计算通过最小化垂直距离平方和定义的最佳拟合直线的斜率 $m$ 和截距 $c$。以 m/s 为单位报告斜率的答案，以 m 为单位报告截距的答案。将您的最终答案四舍五入到四位有效数字。", "solution": "我们用直线 $p = m t + c$ 来为数据建模，并将需要最小化的垂直距离平方和定义为\n$$\nF(m,c) = \\sum_{i=1}^{n} \\frac{(m t_{i} - p_{i} + c)^{2}}{m^{2} + 1}.\n$$\n令 $\\partial F/\\partial c=0$ 可得\n$$\n\\frac{2}{m^{2}+1}\\sum_{i=1}^{n}\\left(m t_{i} - p_{i} + c\\right)=0 \\quad\\Longrightarrow\\quad c=\\bar{p}-m\\bar{t},\n$$\n其中 $\\bar{t}$ 和 $\\bar{p}$ 是样本均值。定义中心化变量 $t_{i}'=t_{i}-\\bar{t}$ 和 $p_{i}'=p_{i}-\\bar{p}$。代入 $c=\\bar{p}-m\\bar{t}$ 可得\n$$\nF(m)=\\frac{1}{m^{2}+1}\\sum_{i=1}^{n}\\left(m t_{i}' - p_{i}'\\right)^{2}\n=\\frac{m^{2} S_{tt} - 2 m S_{tp} + S_{pp}}{m^{2}+1},\n$$\n其中 $S_{tt}=\\sum (t_{i}')^{2}$，$S_{pp}=\\sum (p_{i}')^{2}$，以及 $S_{tp}=\\sum t_{i}'p_{i}'$。对 $m$ 求导并令其为零，得到总体最小二乘条件\n$$\nS_{tp} m^{2} + (S_{tt} - S_{pp}) m - S_{tp} = 0,\n$$\n等价地\n$$\nS_{tp}(m^{2}-1) + (S_{tt}-S_{pp}) m = 0.\n$$\n解这个二次方程，\n$$\nm=\\frac{S_{pp}-S_{tt} \\pm \\sqrt{(S_{pp}-S_{tt})^{2}+4 S_{tp}^{2}}}{2 S_{tp}}.\n$$\n我们计算数据 $(t,p)\\in\\{(2,3),(4,8),(7,10),(9,15)\\}$ 的样本均值和总和。当 $n=4$ 时，\n$$\n\\bar{t}=\\frac{2+4+7+9}{4}=\\frac{22}{4}=5.5,\\qquad \\bar{p}=\\frac{3+8+10+15}{4}=\\frac{36}{4}=9.\n$$\n中心化后的值为 $(t',p')\\in\\{(-3.5,-6),(-1.5,-1),(1.5,1),(3.5,6)\\}$，得到\n$$\nS_{tt}=(-3.5)^{2}+(-1.5)^{2}+(1.5)^{2}+(3.5)^{2}=29,\n$$\n$$\nS_{pp}=(-6)^{2}+(-1)^{2}+(1)^{2}+(6)^{2}=74,\n$$\n$$\nS_{tp}=(-3.5)(-6)+(-1.5)(-1)+(1.5)(1)+(3.5)(6)=45.\n$$\n因此\n$$\nm=\\frac{74-29 \\pm \\sqrt{(74-29)^{2}+4\\cdot 45^{2}}}{2\\cdot 45}\n=\\frac{45 \\pm 45\\sqrt{5}}{90}=\\frac{1\\pm \\sqrt{5}}{2}.\n$$\n数据表现出正相关性，因此我们取正根，\n$$\nm=\\frac{1+\\sqrt{5}}{2}.\n$$\n截距由 $c=\\bar{p}-m\\bar{t}$ 得出：\n$$\nc=9-\\left(\\frac{1+\\sqrt{5}}{2}\\right)\\cdot 5.5\n=9-\\frac{11(1+\\sqrt{5})}{4}\n=\\frac{25-11\\sqrt{5}}{4}.\n$$\n数值上，精确到四位有效数字，\n$$\nm\\approx 1.618,\\qquad c\\approx 0.1008.\n$$\n这对应于要求的单位，$m$ 的单位为 m/s，$c$ 的单位为 m。", "answer": "$$\\boxed{\\begin{pmatrix}1.618  0.1008\\end{pmatrix}}$$", "id": "2212231"}, {"introduction": "现实世界的数据经常表现出结构性断点，即其潜在关系发生变化。这项练习挑战你超越单一模型的拟合，转而寻找一个最优的“变化点”将数据分成不同的线性区域。解决这个问题需要巧妙地结合线性回归和组合搜索，展示了一种更高级的数据建模方法 [@problem_id:2212179]。", "problem": "一位工程师正在校准一种新型压力传感器。传感器的输出电压预计会随施加的压力线性变化。在一次测试中，压力以离散的步长增加，并记录传感器的电压输出。有序数据对 $(x_i, y_i)$ 如下，其中 $x_i$ 是施加的压力（单位：千帕，kPa），$y_i$ 是输出电压（单位：毫伏，mV）：\n\n(1, 2.1), (2, 2.9), (3, 3.8), (4, 2.1), (5, -0.1), (6, -1.8)\n\n工程师怀疑传感器的响应特性在测试过程中的某个点发生了突变。为了对此进行建模，他们提出了一个变点模型。数据将在一个整数索引 $k$ 处被分成两个连续的部分。第一部分包含数据点 $1$ 到 $k$，第二部分包含数据点 $k+1$ 到 $6$。然后用各自独立的直线 $y=mx+c$ 对每个部分进行拟合。\n\n每个部分的“最佳”拟合定义为使该部分内各点的垂直误差平方和最小化的直线。对于给定的 $k$，变点模型的整体质量由总误差平方和（SSE）来衡量，该值是两个独立线性拟合的 SSE 之和。\n\n为确保每个线性拟合都是良定义的，每个部分必须包含至少两个数据点。因此，变点索引 $k$ 的可能取值为 $2、3$ 和 $4$。\n\n确定使总 SSE 最小化的变点索引 $k$ 的最佳整数值。", "solution": "对于一个包含点 $(x_{i},y_{i})$（$i=1,\\dots,n$）的部分，用直线 $y=mx+c$ 进行普通最小二乘法拟合的误差平方和可以用以下各项来表示：\n$$\nS_{x}=\\sum x_{i},\\quad S_{y}=\\sum y_{i},\\quad \\sum x_{i}^{2},\\quad \\sum y_{i}^{2},\\quad \\sum x_{i}y_{i},\n$$\n以及中心化和\n$$\nS_{xx}=\\sum x_{i}^{2}-\\frac{S_{x}^{2}}{n},\\quad S_{yy}=\\sum y_{i}^{2}-\\frac{S_{y}^{2}}{n},\\quad S_{xy}=\\sum x_{i}y_{i}-\\frac{S_{x}S_{y}}{n}.\n$$\n斜率为 $m=\\frac{S_{xy}}{S_{xx}}$，该部分的 SSE 为\n$$\n\\mathrm{SSE}=S_{yy}-\\frac{S_{xy}^{2}}{S_{xx}}.\n$$\n对于包含两个点的部分，拟合直线会穿过这两个点，因此 SSE 等于 $0$。\n\n情况 $k=2$：部分1使用 $(1,2.1),(2,2.9)$，所以 $\\mathrm{SSE}_{1}=0$。部分2使用 $(3,3.8),(4,2.1),(5,-0.1),(6,-1.8)$，其中 $n=4$, $S_{x}=18$, $S_{y}=4.0$, $\\sum x_{i}^{2}=86$, $\\sum y_{i}^{2}=22.10$, $\\sum x_{i}y_{i}=8.5$。于是\n$$\nS_{xx}=86-\\frac{18^{2}}{4}=5,\\quad S_{yy}=22.10-\\frac{4.0^{2}}{4}=18.10,\\quad S_{xy}=8.5-\\frac{18\\cdot 4.0}{4}=-9.5,\n$$\n所以\n$$\n\\mathrm{SSE}_{2}=18.10-\\frac{(-9.5)^{2}}{5}=18.10-18.05=0.05.\n$$\n因此 $\\mathrm{SSE}_{\\text{total}}(k=2)=0+0.05=0.05$。\n\n情况 $k=3$：部分1使用 $(1,2.1),(2,2.9),(3,3.8)$，其中 $n=3$, $S_{x}=6$, $S_{y}=8.8$, $\\sum x_{i}^{2}=14$, $\\sum y_{i}^{2}=27.26$, $\\sum x_{i}y_{i}=19.3$。于是\n$$\nS_{xx}=14-\\frac{6^{2}}{3}=2,\\quad S_{yy}=27.26-\\frac{8.8^{2}}{3}=\\frac{217}{150},\\quad S_{xy}=19.3-\\frac{6\\cdot 8.8}{3}=1.7,\n$$\n所以\n$$\n\\mathrm{SSE}_{1}=\\frac{217}{150}-\\frac{(1.7)^{2}}{2}=\\frac{217}{150}-\\frac{289}{200}=\\frac{1}{600}.\n$$\n部分2使用 $(4,2.1),(5,-0.1),(6,-1.8)$，其中 $n=3$, $S_{x}=15$, $S_{y}=0.2$, $\\sum x_{i}^{2}=77$, $\\sum y_{i}^{2}=7.66$, $\\sum x_{i}y_{i}=-2.9$。于是\n$$\nS_{xx}=77-\\frac{15^{2}}{3}=2,\\quad S_{yy}=7.66-\\frac{0.2^{2}}{3}=\\frac{1147}{150},\\quad S_{xy}=-2.9-\\frac{15\\cdot 0.2}{3}=-3.9,\n$$\n所以\n$$\n\\mathrm{SSE}_{2}=\\frac{1147}{150}-\\frac{(-3.9)^{2}}{2}=\\frac{1147}{150}-\\frac{1521}{200}=\\frac{1}{24}.\n$$\n因此\n$$\n\\mathrm{SSE}_{\\text{total}}(k=3)=\\frac{1}{600}+\\frac{1}{24}=\\frac{26}{600}=\\frac{13}{300}\\approx 0.043333\\ldots.\n$$\n\n情况 $k=4$：部分1使用 $(1,2.1),(2,2.9),(3,3.8),(4,2.1)$，其中 $n=4$, $S_{x}=10$, $S_{y}=10.9$, $\\sum x_{i}^{2}=30$, $\\sum y_{i}^{2}=31.67$, $\\sum x_{i}y_{i}=27.7$。于是\n$$\nS_{xx}=30-\\frac{10^{2}}{4}=5,\\quad S_{yy}=31.67-\\frac{10.9^{2}}{4}=1.9675,\\quad S_{xy}=27.7-\\frac{10\\cdot 10.9}{4}=0.45,\n$$\n所以\n$$\n\\mathrm{SSE}_{1}=1.9675-\\frac{(0.45)^{2}}{5}=1.9675-0.0405=1.927.\n$$\n部分2使用 $(5,-0.1),(6,-1.8)$，所以 $\\mathrm{SSE}_{2}=0$。因此 $\\mathrm{SSE}_{\\text{total}}(k=4)=1.927$。\n\n比较各项总和，$\\mathrm{SSE}_{\\text{total}}(k=2)=0.05$，$\\mathrm{SSE}_{\\text{total}}(k=3)=\\frac{13}{300}\\approx 0.04333$ 以及 $\\mathrm{SSE}_{\\text{total}}(k=4)=1.927$。最小值在 $k=3$ 时取得。", "answer": "$$\\boxed{3}$$", "id": "2212179"}]}