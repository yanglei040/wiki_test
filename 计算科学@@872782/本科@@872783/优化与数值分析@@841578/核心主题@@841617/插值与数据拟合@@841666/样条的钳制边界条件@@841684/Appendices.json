{"hands_on_practices": [{"introduction": "本节将通过一个基础练习，带你一步步构建一个夹持三次样条。这个练习 [@problem_id:2159084] 将帮助你熟悉样条插值的基本计算过程，即如何在给定端点导数的情况下，求解样条曲线在特定点上的值。这是理解和应用更复杂样条技术的重要第一步。", "problem": "一个夹持三次样条被用来插值一组数据点。一个三次样条 $S(x)$ 由分段三次多项式组成，每个多项式对应于连续数据点之间的一个区间。对于一组点 $(x_0, y_0), (x_1, y_1), \\dots, (x_n, y_n)$，在区间 $[x_j, x_{j+1}]$ 上的多项式由 $S_j(x) = a_j + b_j(x-x_j) + c_j(x-x_j)^2 + d_j(x-x_j)^3$ 给出。\n\n考虑一个由三个点组成的数据集：$(x_0, y_0) = (0, 0)$，$(x_1, y_1) = (1, 2)$ 和 $(x_2, y_2) = (2, 1)$。构造一个夹持三次样条 $S(x)$ 穿过这些点，并附加边界条件，即端点处的导数为零，即 $S'(0) = 0$ 和 $S'(2) = 0$。\n\n计算该样条在 $x=1.5$ 处的值。将您的最终答案四舍五入到三位有效数字。", "solution": "一个具有节点 $x_{0}=0$, $x_{1}=1$, $x_{2}=2$ 和端点导数 $S'(0)=0$, $S'(2)=0$ 的夹持三次样条可以使用标准的二阶导数（矩）公式来构造。令 $M_{i}=S''(x_{i})$ 和 $h_{i}=x_{i+1}-x_{i}$。对于夹持端点，关于 $M_{0},M_{1},M_{2}$ 的方程组为\n$$\n2h_{0}M_{0}+h_{0}M_{1}=6\\left(\\frac{y_{1}-y_{0}}{h_{0}}-S'(x_{0})\\right),\n$$\n$$\nh_{0}M_{0}+2(h_{0}+h_{1})M_{1}+h_{1}M_{2}=6\\left(\\frac{y_{2}-y_{1}}{h_{1}}-\\frac{y_{1}-y_{0}}{h_{0}}\\right),\n$$\n$$\nh_{1}M_{1}+2h_{1}M_{2}=6\\left(S'(x_{2})-\\frac{y_{2}-y_{1}}{h_{1}}\\right).\n$$\n这里 $h_{0}=h_{1}=1$，$(y_{0},y_{1},y_{2})=(0,2,1)$，$\\frac{y_{1}-y_{0}}{h_{0}}=2$，$\\frac{y_{2}-y_{1}}{h_{1}}=-1$，并且 $S'(x_{0})=S'(x_{2})=0$。方程组变为\n$$\n2M_{0}+M_{1}=12,\\quad M_{0}+4M_{1}+M_{2}=-18,\\quad M_{1}+2M_{2}=6.\n$$\n求解得到\n$$\nM_{0}=\\frac{21}{2},\\quad M_{1}=-9,\\quad M_{2}=\\frac{15}{2}.\n$$\n在区间 $[x_{1},x_{2}]=[1,2]$ 上，样条为\n$$\nS_{1}(x)=\\frac{M_{1}}{6}(x_{2}-x)^{3}+\\frac{M_{2}}{6}(x-x_{1})^{3}+\\left(y_{1}-\\frac{M_{1}h_{1}^{2}}{6}\\right)\\frac{x_{2}-x}{h_{1}}+\\left(y_{2}-\\frac{M_{2}h_{1}^{2}}{6}\\right)\\frac{x-x_{1}}{h_{1}}.\n$$\n当 $h_{1}=1$，$x_{1}=1$，$x_{2}=2$，$M_{1}/6=-\\frac{3}{2}$，$M_{2}/6=\\frac{5}{4}$，$y_{1}-M_{1}/6=\\frac{7}{2}$ 以及 $y_{2}-M_{2}/6=-\\frac{1}{4}$ 时，上式简化为\n$$\nS_{1}(x)=-\\frac{3}{2}(2-x)^{3}+\\frac{5}{4}(x-1)^{3}+\\frac{7}{2}(2-x)-\\frac{1}{4}(x-1).\n$$\n在 $x=1.5$ 处，令 $u=0.5$ 得到\n$$\nS(1.5)=-\\frac{3}{2}u^{3}+\\frac{5}{4}u^{3}+\\frac{7}{2}u-\\frac{1}{4}u\n= -\\frac{3}{16}+\\frac{5}{32}+\\frac{7}{4}-\\frac{1}{8}\n=\\frac{51}{32}=1.59375.\n$$\n四舍五入到三位有效数字得到 $1.59$。", "answer": "$$\\boxed{1.59}$$", "id": "2159084"}, {"introduction": "选择正确的边界条件对于样条模型的物理真实性至关重要。本练习 [@problem_id:2159102] 探讨了端点导数选择不当如何导致非物理性的“摆动”或多余的拐点。通过求解一个确保样条全程保持特定形状（如凹性）的初始导数值，你将学会如何利用数学约束来保证模型符合预期的物理特性。", "problem": "一个夹持三次样条被用来基于三个离散测量值对一个物理过程进行建模。数据点 $(t_i, y_i)$ 为 $(0, 1)$、$(1, 3)$ 和 $(3, 2)$，其中 $t$ 是任意单位的时间，$y$ 是传感器读数。\n\n样条记为 $S(t)$，它对这些点进行插值。为了确保到后续数据的平滑过渡，该样条在终点被“夹持”，具有指定的导数：$S'(3) = -1$。在初始点的导数 $v_0 = S'(0)$ 是一个工程师必须选择的参数。\n\n已知所建模的底层物理过程本质上是凹的，这意味着其真实的二阶导数始终为非正数。初始导数 $v_0$ 的不当选择会导致样条模型出现人为的“摆动”，表现为一个凸性区域，在该区域样条的二阶导数 $S''(t)$ 变为正数。这样的区域在模型中代表了一种非物理的人为现象。\n\n确定初始导数 $v_0$ 的最小数值，以确保所得样条 $S(t)$ 在整个区间 $[0, 3]$ 上是纯凹的，从而避免任何非物理的人为现象。将您的答案四舍五入到三位有效数字。", "solution": "我们在节点 $t_{0}=0$，$t_{1}=1$，$t_{2}=3$ 上构建夹持三次样条，其值为 $y_{0}=1$，$y_{1}=3$，$y_{2}=2$，并规定了端点导数 $S'(0)=v_{0}$（未知）和 $S'(3)=-1$。令 $h_{0}=t_{1}-t_{0}=1$ 和 $h_{1}=t_{2}-t_{1}=2$。在标准的三次样条公式中，令 $M_{i}=S''(t_{i})$，其中 $i=0,1,2$。对于夹持样条，$M_{i}$ 满足以下三对角系统：\n- 内部方程（来自 $S'$ 在 $t_{1}$ 处的连续性）：\n$$\nh_{0} M_{0} + 2(h_{0}+h_{1}) M_{1} + h_{1} M_{2} = 6\\left( \\frac{y_{2}-y_{1}}{h_{1}} - \\frac{y_{1}-y_{0}}{h_{0}} \\right).\n$$\n- 左边界（夹持）方程：\n$$\n2 h_{0} M_{0} + h_{0} M_{1} = 6\\left( \\frac{y_{1}-y_{0}}{h_{0}} - v_{0} \\right).\n$$\n- 右边界（夹持）方程：\n$$\nh_{1} M_{1} + 2 h_{1} M_{2} = 6\\left( -1 - \\frac{y_{2}-y_{1}}{h_{1}} \\right).\n$$\n\n计算所需的斜率：\n$$\n\\frac{y_{1}-y_{0}}{h_{0}} = 2, \\qquad \\frac{y_{2}-y_{1}}{h_{1}} = -\\frac{1}{2}.\n$$\n代入 $h_{0}=1$，$h_{1}=2$ 和这些斜率，该系统变为\n$$\n\\text{(I)}\\quad M_{0} + 6 M_{1} + 2 M_{2} = -15,\n$$\n$$\n\\text{(L)}\\quad 2 M_{0} + M_{1} = 12 - 6 v_{0},\n$$\n$$\n\\text{(R)}\\quad 2 M_{1} + 4 M_{2} = -3.\n$$\n用 $v_{0}$ 表示 $M_{i}$。由 (R) 式，$M_{1} = -\\frac{3}{2} - 2 M_{2}$。代入 (I) 式得到 $M_{0} = -6 + 10 M_{2}$。将两者都代入 (L) 式：\n$$\n2(-6 + 10 M_{2}) + \\left( -\\frac{3}{2} - 2 M_{2} \\right) = 12 - 6 v_{0},\n$$\n化简为\n$$\n18 M_{2} - \\frac{27}{2} = 12 - 6 v_{0}.\n$$\n因此\n$$\nM_{2} = \\frac{51 - 12 v_{0}}{36} = \\frac{17 - 4 v_{0}}{12}.\n$$\n然后\n$$\nM_{1} = -\\frac{3}{2} - 2 M_{2} = -\\frac{3}{2} - \\frac{17 - 4 v_{0}}{6} = \\frac{2 v_{0} - 13}{3},\n$$\n以及\n$$\nM_{0} = -6 + 10 M_{2} = -6 + \\frac{10(17 - 4 v_{0})}{12} = \\frac{49 - 20 v_{0}}{6}.\n$$\n\n在每个子区间上，三次样条的二阶导数是线性的：\n$$\nS''(t) = M_{i} \\frac{t_{i+1}-t}{h_{i}} + M_{i+1} \\frac{t - t_{i}}{h_{i}}, \\qquad t \\in [t_{i}, t_{i+1}],\n$$\n所以 $S''$ 是 $M_{i}$ 和 $M_{i+1}$ 之间的线性插值。因此，对于所有 $t \\in [0,3]$，$S''(t) \\le 0$ 当且仅当\n$$\nM_{0} \\le 0, \\quad M_{1} \\le 0, \\quad M_{2} \\le 0.\n$$\n将上述表达式代入这些条件：\n- $M_{2} \\le 0 \\implies \\frac{17 - 4 v_{0}}{12} \\le 0 \\implies v_{0} \\ge \\frac{17}{4}。$\n- $M_{1} \\le 0 \\implies \\frac{2 v_{0} - 13}{3} \\le 0 \\implies v_{0} \\le \\frac{13}{2}。$\n- $M_{0} \\le 0 \\implies \\frac{49 - 20 v_{0}}{6} \\le 0 \\implies v_{0} \\ge \\frac{49}{20}。$\n\n合并可得\n$$\nv_{0} \\in \\left[ \\frac{17}{4}, \\frac{13}{2} \\right],\n$$\n因此，确保在 $[0,3]$ 上 $S''(t) \\le 0$ 的最小 $v_{0}$ 是 $v_{0} = \\frac{17}{4} = 4.25$。四舍五入到三位有效数字，结果为 $4.25$。", "answer": "$$\\boxed{4.25}$$", "id": "2159102"}, {"introduction": "在实际工程问题中，我们常常需要利用全局信息来确定局部参数。这个高级练习 [@problem_id:2159088] 展示了如何通过一个全局约束（即样条曲线下的总面积）来反向求解一个未知的端点导数。这个过程模拟了在力学等领域中，根据总作用力或总量来确定边界条件的情景，极大地提升了解决实际问题的能力。", "problem": "一个机械部件的一维应力分布 $S(x)$ 在定义域 $[0, 3]$ 上使用三次样条进行建模。三次样条函数由分段三次多项式构成，这些多项式在一组称为节点的点上连接，并且在每个内部节点处，其一阶和二阶导数都是连续的。\n\n样条 $S(x)$ 由以下条件定义：\n1.  节点位于 $x_0 = 0$，$x_1 = 1$ 和 $x_2 = 3$。\n2.  样条必须经过点 $(x_0, y_0) = (0, 0)$，$(x_1, y_1) = (1, 1)$ 和 $(x_2, y_2) = (3, -1)$。\n3.  该样条是夹持三次样条，意味着其在端点处的一阶导数是指定的。区间起点的导数给定为 $S'(0) = 1$。\n4.  在整个部件长度上的总积分应力（对应于总力）必须等于一个特定的目标值。该约束条件由 $\\int_{0}^{3} S(x) dx = \\frac{7}{16}$ 给出。\n\n你的任务是确定满足所有给定条件的区间终点导数 $S'(3)$ 的值。请将答案表示为单个实数。", "solution": "设三次样条为 $S(x)$。它在两个区间上定义：在 $[0, 1]$ 上由三次多项式 $S_0(x)$ 定义，在 $[1, 3]$ 上由三次多项式 $S_1(x)$ 定义。节点为 $x_0=0, x_1=1, x_2=3$。对应的函数值为 $y_0=0, y_1=1, y_2=-1$。区间长度为 $h_0 = x_1 - x_0 = 1$ 和 $h_1 = x_2 - x_1 = 2$。\n\n三次样条由其在节点处的二阶导数 $M_i = S''(x_i)$ 唯一确定。对于一个有 $n+1$ 个节点（$x_0, \\dots, x_n$）的样条，值 $M_1, \\dots, M_{n-1}$ 满足一个线性方程组。对于夹持样条，其中 $S'(x_0)=v_0$ 和 $S'(x_n)=v_n$ 是指定的，完整的二阶导数集合 $M_0, \\dots, M_n$ 通过解一个更大的方程组来找到。\n\n在我们的例子中，$n=2$。针对内部节点 $x_1$ 的一般方程组是：\n$$h_0 M_0 + 2(h_0+h_1)M_1 + h_1 M_2 = 6\\left(\\frac{y_2-y_1}{h_1} - \\frac{y_1-y_0}{h_0}\\right)$$\n代入给定值（$h_0=1, h_1=2, y_0=0, y_1=1, y_2=-1$）：\n$$1 \\cdot M_0 + 2(1+2)M_1 + 2 \\cdot M_2 = 6\\left(\\frac{-1-1}{2} - \\frac{1-0}{1}\\right)$$\n$$M_0 + 6M_1 + 2M_2 = 6(-1 - 1) = -12 \\quad (*)$$\n\n对于夹持样条，边界条件提供了另外两个方程。\n在 $x_0=0$ 处，我们有 $S'(0) = v_0 = 1$。方程是：\n$$2h_0 M_0 + h_0 M_1 = 6\\left(\\frac{y_1-y_0}{h_0} - v_0\\right)$$\n$$2(1)M_0 + 1 \\cdot M_1 = 6\\left(\\frac{1-0}{1} - 1\\right) = 0$$\n$$2M_0 + M_1 = 0 \\implies M_1 = -2M_0 \\quad (**)$$\n\n在 $x_2=3$ 处，导数 $S'(3)=v_2$ 是我们需要求解的。方程是：\n$$h_1 M_1 + 2h_1 M_2 = 6\\left(v_2 - \\frac{y_2-y_1}{h_1}\\right)$$\n$$2M_1 + 2(2)M_2 = 6\\left(v_2 - \\frac{-1-1}{2}\\right) = 6(v_2+1)$$\n$$2M_1 + 4M_2 = 6v_2 + 6 \\implies M_1 + 2M_2 = 3v_2 + 3 \\quad (***)$$\n\n我们得到了一个关于 $M_0, M_1, M_2$ 且以未知数 $v_2$ 为参数的三元线性方程组。让我们用 $v_2$ 来表示 $M_i$。\n将 $(**)$ 式的 $M_1 = -2M_0$ 代入 $(*)$ 和 $(***)$：\n代入 $(*)$： $M_0 + 6(-2M_0) + 2M_2 = -12 \\implies -11M_0 + 2M_2 = -12$。\n代入 $(***)$： $-2M_0 + 2M_2 = 3v_2 + 3 \\implies 2M_2 = 2M_0 + 3v_2 + 3$。\n\n现在将 $2M_2$ 的表达式代入修改后的方程 $(*)$：\n$$-11M_0 + (2M_0 + 3v_2 + 3) = -12$$\n$$-9M_0 = -15 - 3v_2 \\implies M_0 = \\frac{15+3v_2}{9} = \\frac{5}{3} + \\frac{1}{3}v_2$$\n现在我们可以求出 $M_1$ 和 $M_2$：\n$$M_1 = -2M_0 = -2\\left(\\frac{5}{3} + \\frac{1}{3}v_2\\right) = -\\frac{10}{3} - \\frac{2}{3}v_2$$\n$$2M_2 = 2M_0 + 3v_2 + 3 = 2\\left(\\frac{5}{3} + \\frac{1}{3}v_2\\right) + 3v_2 + 3 = \\frac{10}{3} + \\frac{2}{3}v_2 + 3v_2 + 3 = \\frac{19}{3} + \\frac{11}{3}v_2$$\n$$M_2 = \\frac{19}{6} + \\frac{11}{6}v_2$$\n\n下一步是使用积分约束。从 $x_i$ 到 $x_{i+1}$ 的单个三次样条段的积分由下式给出：\n$$\\int_{x_i}^{x_{i+1}} S_i(x) dx = \\frac{h_i}{2}(y_i + y_{i+1}) - \\frac{h_i^3}{24}(M_i + M_{i+1})$$\n总积分是区间 $[0,1]$ 和 $[1,3]$ 上积分的和：\n$$\\int_0^3 S(x) dx = \\left[\\frac{h_0}{2}(y_0+y_1) - \\frac{h_0^3}{24}(M_0+M_1)\\right] + \\left[\\frac{h_1}{2}(y_1+y_2) - \\frac{h_1^3}{24}(M_1+M_2)\\right]$$\n代入数值：\n$$\\int_0^3 S(x) dx = \\left[\\frac{1}{2}(0+1) - \\frac{1^3}{24}(M_0+M_1)\\right] + \\left[\\frac{2}{2}(1-1) - \\frac{2^3}{24}(M_1+M_2)\\right]$$\n$$\\int_0^3 S(x) dx = \\left(\\frac{1}{2} - \\frac{1}{24}(M_0+M_1)\\right) + \\left(0 - \\frac{8}{24}(M_1+M_2)\\right)$$\n$$\\int_0^3 S(x) dx = \\frac{1}{2} - \\frac{1}{24}M_0 - \\frac{1}{24}M_1 - \\frac{8}{24}M_1 - \\frac{8}{24}M_2$$\n$$\\int_0^3 S(x) dx = \\frac{1}{2} - \\frac{1}{24}(M_0 + 9M_1 + 8M_2)$$\n根据题目条件，我们有 $\\int_0^3 S(x) dx = \\frac{7}{16}$。\n$$\\frac{7}{16} = \\frac{1}{2} - \\frac{1}{24}(M_0 + 9M_1 + 8M_2)$$\n$$\\frac{1}{24}(M_0 + 9M_1 + 8M_2) = \\frac{1}{2} - \\frac{7}{16} = \\frac{8-7}{16} = \\frac{1}{16}$$\n$$M_0 + 9M_1 + 8M_2 = \\frac{24}{16} = \\frac{3}{2}$$\n\n现在，将用 $v_2$ 表示的 $M_0, M_1, M_2$ 的表达式代入此方程：\n$$\\left(\\frac{5}{3} + \\frac{1}{3}v_2\\right) + 9\\left(-\\frac{10}{3} - \\frac{2}{3}v_2\\right) + 8\\left(\\frac{19}{6} + \\frac{11}{6}v_2\\right) = \\frac{3}{2}$$\n$$\\frac{5}{3} + \\frac{1}{3}v_2 - 30 - 6v_2 + \\frac{76}{3} + \\frac{44}{3}v_2 = \\frac{3}{2}$$\n将含有 $v_2$ 的项和不含 $v_2$ 的项分组：\n$$\\left(\\frac{5}{3} - 30 + \\frac{76}{3}\\right) + \\left(\\frac{1}{3} - 6 + \\frac{44}{3}\\right)v_2 = \\frac{3}{2}$$\n$$\\left(\\frac{81}{3} - 30\\right) + \\left(\\frac{45}{3} - 6\\right)v_2 = \\frac{3}{2}$$\n$$(27 - 30) + (15 - 6)v_2 = \\frac{3}{2}$$\n$$-3 + 9v_2 = \\frac{3}{2}$$\n$$9v_2 = 3 + \\frac{3}{2} = \\frac{9}{2}$$\n$$v_2 = \\frac{1}{9}\\left(\\frac{9}{2}\\right) = \\frac{1}{2}$$\n因此，在 $x=3$ 处所需的导数是 $S'(3) = 1/2$。", "answer": "$$\\boxed{\\frac{1}{2}}$$", "id": "2159088"}]}