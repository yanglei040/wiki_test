{"hands_on_practices": [{"introduction": "第一个练习将我们带回最基础的情景。我们将探索最简单的情况：如何找到一个最佳常数值来代表一系列测量结果。通过这个练习，你将亲眼看到最小化平方误差的核心思想是如何自然地导出我们所熟悉的算术平均值这一统计概念，从而为最小二乘法原理建立坚实的直观基础。[@problem_id:2218976]", "problem": "进行一项实验以确定一个恒定的物理参数。由于随机实验误差，多次测量得出了略有不同的值。收集到的数据包含三对测量值 $(x_i, y_i)$，其中 $x_i$ 代表一个自变量（例如时间），$y_i$ 是该参数的测量值。观测到的数据点为 $(1, 3)$、$(2, 5)$ 和 $(3, 4)$。\n\n假设该参数的真实值是一个常数，我们希望找到这个常数的最佳估计值。这可以通过将数据拟合到一条形如 $y = c$ 的水平线来实现。\n\n使用最小二乘法原理，确定常数 $c$ 的值，使其最能拟合给定的数据点。请用一个精确的数字表示您的答案。", "solution": "我们用一个常数 $c$ 来为测量值建模，使得每个观测值 $y_{i}$ 都由 $c$ 来近似。根据最小二乘法原理，我们选择 $c$ 来最小化残差平方和\n$$\nS(c)=\\sum_{i=1}^{3}\\left(y_{i}-c\\right)^{2}.\n$$\n对 $c$ 求导并将导数设为零：\n$$\n\\frac{dS}{dc}=\\sum_{i=1}^{3}2\\left(c-y_{i}\\right)=2\\left(3c-\\sum_{i=1}^{3}y_{i}\\right)=0.\n$$\n这得出了正规方程\n$$\n3c=\\sum_{i=1}^{3}y_{i}\\quad\\Longrightarrow\\quad c=\\frac{1}{3}\\sum_{i=1}^{3}y_{i}.\n$$\n代入数据 $y_{1}=3$、$y_{2}=5$、$y_{3}=4$ 得\n$$\nc=\\frac{1}{3}(3+5+4)=\\frac{12}{3}=4.\n$$\n为了验证这是一个最小值，注意到\n$$\n\\frac{d^{2}S}{dc^{2}}=\\sum_{i=1}^{3}2=6>0,\n$$\n因此 $c=4$ 使 $S(c)$ 最小化，并且是最小二乘估计值（即 $y_{i}$ 值的样本均值）。", "answer": "$$\\boxed{4}$$", "id": "2218976"}, {"introduction": "在上一个例子的基础上，我们现在考虑一个稍微复杂的模型，其中两个变量成正比关系。这个练习要求你推导通过原点的最佳拟合直线的斜率。这是理解线性回归和数据关系建模的关键一步。[@problem_id:2219020]", "problem": "在许多物理系统中，两个量之间预期存在正比关系，该关系可用形如 $y = mx$ 的方程来建模。考虑一个实验，它产生了一组 $N$ 个数据点 $(x_1, y_1), (x_2, y_2), \\dots, (x_N, y_N)$。我们希望为该数据集找到一条穿过原点的“最佳拟合”直线。\n\n根据最小二乘法原理，最佳拟合是指能够最小化观测数据点与模型直线之间垂直距离平方和的拟合。设这个误差平方和为 $S$。\n\n请确定使 $S$ 最小化的斜率 $m$ 的解析表达式。您的答案应以给定的数据坐标 $x_i$ 和 $y_i$ 表示。", "solution": "我们假设模型为 $y=m x$（一条约束通过原点的直线）。对于数据 $\\{(x_{i},y_{i})\\}_{i=1}^{N}$，作为 $m$ 的函数的最小二乘目标（垂直残差平方和）为\n$$\nS(m)=\\sum_{i=1}^{N}\\left(y_{i}-m x_{i}\\right)^{2}.\n$$\n为找到使 $S(m)$ 最小的斜率，我们将 $S(m)$ 对 $m$ 求导，并令导数为零（一阶最优性条件）：\n$$\n\\frac{dS}{dm}=\\sum_{i=1}^{N}2\\left(y_{i}-m x_{i}\\right)\\left(-x_{i}\\right)=-2\\sum_{i=1}^{N}x_{i}y_{i}+2m\\sum_{i=1}^{N}x_{i}^{2}.\n$$\n令 $\\frac{dS}{dm}=0$：\n$$\n-2\\sum_{i=1}^{N}x_{i}y_{i}+2m\\sum_{i=1}^{N}x_{i}^{2}=0.\n$$\n求解 $m$：\n$$\nm\\sum_{i=1}^{N}x_{i}^{2}=\\sum_{i=1}^{N}x_{i}y_{i}\\quad\\Rightarrow\\quad m=\\frac{\\sum_{i=1}^{N}x_{i}y_{i}}{\\sum_{i=1}^{N}x_{i}^{2}}.\n$$\n为确认这是一个最小值点，我们计算二阶导数：\n$$\n\\frac{d^{2}S}{dm^{2}}=2\\sum_{i=1}^{N}x_{i}^{2}\\ge 0,\n$$\n只要至少有一个 $x_{i}\\neq 0$，该二阶导数就严格为正，从而确保了存在一个唯一的最小值点。如果 $\\sum_{i=1}^{N}x_{i}^{2}=0$（即所有 $x_{i}=0$），那么 $S(m)=\\sum_{i=1}^{N}y_{i}^{2}$ 与 $m$ 无关，因此斜率是不可辨识的。否则，使S最小化的斜率即为上述表达式。", "answer": "$$\\boxed{\\frac{\\sum_{i=1}^{N} x_{i} y_{i}}{\\sum_{i=1}^{N} x_{i}^{2}}}$$", "id": "2219020"}, {"introduction": "现实世界的问题常常涉及多个参数，使用线性代数的语言来处理这些问题是最高效的。本练习将介绍最小二乘问题的强大矩阵表示法。你将学习如何使用正规方程求解最佳拟合参数，这是数据分析和科学计算中的一个标准且至关重要的技术。[@problem_id:2218998]", "problem": "在许多数据分析应用中，我们会遇到 $A\\mathbf{x} = \\mathbf{b}$ 形式的超定线性系统，其中矩阵 $A$ 的行数多于列数。这类系统通常没有精确解。最小二乘法原理提供了一种寻找近似解 $\\hat{\\mathbf{x}}$ 的方法，即通过最小化残差向量 $r = A\\mathbf{x} - \\mathbf{b}$ 的欧几里得范数的平方来实现。\n\n考虑一个特定的超定系统 $A\\mathbf{x} = \\mathbf{b}$，其中矩阵 $A$ 和向量 $\\mathbf{b}$ 由下式给出：\n$$\nA = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\\\ 1 & 1 \\end{pmatrix}, \\quad \\mathbf{b} = \\begin{pmatrix} 2 \\\\ 3 \\\\ 5 \\end{pmatrix}\n$$\n求向量 $\\hat{\\mathbf{x}} = \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix}$，使其成为该系统的最小二乘解。你的答案应为向量 $\\hat{\\mathbf{x}}$。", "solution": "我们寻求最小二乘解 $\\hat{\\mathbf{x}}$，它使得 $\\|A\\mathbf{x}-\\mathbf{b}\\|^{2}$ 最小。最小化问题的必要条件由正规方程给出\n$$\nA^{T}A\\,\\hat{\\mathbf{x}}=A^{T}\\mathbf{b}.\n$$\n已知\n$$\nA=\\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\\\ 1 & 1 \\end{pmatrix},\\quad \\mathbf{b}=\\begin{pmatrix} 2 \\\\ 3 \\\\ 5 \\end{pmatrix},\n$$\n计算\n$$\nA^{T}=\\begin{pmatrix} 1 & 0 & 1 \\\\ 0 & 1 & 1 \\end{pmatrix},\n$$\n所以\n$$\nA^{T}A=\\begin{pmatrix} 1 & 0 & 1 \\\\ 0 & 1 & 1 \\end{pmatrix}\\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\\\ 1 & 1 \\end{pmatrix}\n=\\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix},\n$$\n以及\n$$\nA^{T}\\mathbf{b}=\\begin{pmatrix} 1 & 0 & 1 \\\\ 0 & 1 & 1 \\end{pmatrix}\\begin{pmatrix} 2 \\\\ 3 \\\\ 5 \\end{pmatrix}\n=\\begin{pmatrix} 7 \\\\ 8 \\end{pmatrix}.\n$$\n因此 $\\hat{\\mathbf{x}}$ 满足\n$$\n\\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix}\\begin{pmatrix}x_{1}\\\\x_{2}\\end{pmatrix}=\\begin{pmatrix} 7 \\\\ 8 \\end{pmatrix}.\n$$\n求解该方程组，\n$$\n\\begin{cases}\n2x_{1}+x_{2}=7,\\\\\nx_{1}+2x_{2}=8,\n\\end{cases}\n\\quad\\Rightarrow\\quad x_{2}=7-2x_{1},\n$$\n代入第二个方程：\n$$\nx_{1}+2(7-2x_{1})=8\\;\\Rightarrow\\;-3x_{1}=-6\\;\\Rightarrow\\;x_{1}=2,\n$$\n然后\n$$\nx_{2}=7-2\\cdot 2=3.\n$$\n因此，\n$$\n\\hat{\\mathbf{x}}=\\begin{pmatrix} 2 \\\\ 3 \\end{pmatrix}.\n$$\n值得注意的是，$A\\hat{\\mathbf{x}}=\\begin{pmatrix} 2 \\\\ 3 \\\\ 5 \\end{pmatrix}=\\mathbf{b}$，所以残差为零，并且该系统是相容的。", "answer": "$$\\boxed{\\begin{pmatrix}2\\\\3\\end{pmatrix}}$$", "id": "2218998"}]}