{"hands_on_practices": [{"introduction": "在数值计算中，我们经常面临一对相互矛盾的误差源：截断误差和舍入误差。截断误差源于我们用有限项来近似一个无限过程，而舍入误差则源于计算机有限的浮点精度。这个练习将引导你通过一个基本但极其重要的任务：为一个给定的数值微分公式，解析地找到一个“最佳”步长 $h$。通过建立总误差模型并找到其最小值，你将亲身体会到如何在截断误差和舍入误差之间取得精妙的平衡，这是所有数值分析实践的核心挑战之一。[@problem_id:2167887]", "problem": "在数值分析领域，一个基本的挑战是在截断误差（来自数学近似）和舍入误差（来自有限精度硬件）之间取得平衡。考虑使用中心差分公式计算函数 $f(x) = \\sin(x)$ 在任意点 $x=a$ 处的导数。\n\n总误差 $E_{total}(h)$ 作为步长 $h$ 的函数，被建模为这两种误差类型的绝对值之和。\n对于中心差分法，其截断误差的绝对值由以下表达式给出：\n$$|E_{trunc}(h)| = \\frac{h^2}{6} |f'''(a)|$$\n由浮点运算的限制所导致的舍入误差，其绝对值被建模为：\n$$|E_{round}(h)| = \\frac{\\epsilon}{h}$$\n在此，$\\epsilon$ 是一个小的正常数，代表了单次函数求值绝对误差的上界。\n\n因此，总误差可由和 $E_{total}(h) = |E_{trunc}(h)| + |E_{round}(h)|$ 近似。你的任务是找到使该总误差最小化的最优步长 $h_{opt}$。\n\n请以参数 $a$ 和 $\\epsilon$ 表示的闭式解析表达式的形式给出答案。你可以假设 $\\cos(a) \\neq 0$。", "solution": "我们已知函数 $f(x) = \\sin(x)$ 和中心差分总误差模型\n$$E_{total}(h) = |E_{trunc}(h)| + |E_{round}(h)| = \\frac{h^{2}}{6}\\,|f'''(a)| + \\frac{\\epsilon}{h}.$$\n对于 $f(x) = \\sin(x)$，其三阶导数为 $f'''(x) = -\\cos(x)$，因此 $|f'''(a)| = |\\cos(a)|$。所以，\n$$E_{total}(h) = \\frac{h^{2}}{6}\\,|\\cos(a)| + \\frac{\\epsilon}{h}, \\quad h>0.$$\n为求得使误差最小的步长，我们对 $h$ 求导，并令导数等于零：\n$$\\frac{dE_{total}}{dh} = \\frac{2h}{6}\\,|\\cos(a)| - \\frac{\\epsilon}{h^{2}} = \\frac{h}{3}\\,|\\cos(a)| - \\frac{\\epsilon}{h^{2}}.$$\n令 $\\frac{dE_{total}}{dh}=0$ 可得\n$$\\frac{h}{3}\\,|\\cos(a)| = \\frac{\\epsilon}{h^{2}} \\quad \\Longrightarrow \\quad \\frac{|\\cos(a)|}{3}\\,h^{3} = \\epsilon \\quad \\Longrightarrow \\quad h^{3} = \\frac{3\\epsilon}{|\\cos(a)|}.$$\n因此，\n$$h_{opt} = \\left(\\frac{3\\epsilon}{|\\cos(a)|}\\right)^{\\frac{1}{3}}.$$\n为了验证这是一个极小值点，我们计算二阶导数：\n$$\\frac{d^{2}E_{total}}{dh^{2}} = \\frac{1}{3}\\,|\\cos(a)| + \\frac{2\\epsilon}{h^{3}},$$\n当 $h>0$ 时，该式严格为正，从而证实该临界点是一个极小值点。因此，最优步长为\n$$h_{opt} = \\left(\\frac{3\\epsilon}{|\\cos(a)|}\\right)^{\\frac{1}{3}}.$$", "answer": "$$\\boxed{\\left(\\frac{3\\epsilon}{|\\cos(a)|}\\right)^{\\frac{1}{3}}}$$", "id": "2167887"}, {"introduction": "掌握了寻找最优步长的基本方法后，一个自然的问题是：这种最优选择是否依赖于我们使用的具体算法？这个练习将我们带入更深的层次，通过比较两种广泛使用的有限差分方法——一阶前向差分和二阶中心差分——来探讨这个问题。你将发现，算法的精度（即其截断误差的阶数）直接影响最优步长 $h$ 的量级。这个对比分析不仅强化了你对误差平衡的理解，也揭示了在实践中选择更高级算法的优势。[@problem_id:2167846]", "problem": "在数值分析领域，一个常见的任务是在点 $x_0$ 处近似函数 $f(x)$ 的导数。这通常使用有限差分公式来完成。然而，步长 $h$ 的选择至关重要。较大的 $h$ 会导致近似产生较大的截断误差，而非常小的 $h$ 则可能由于计算机算术的有限精度而导致较大的舍入误差。总误差是这两个相互竞争的误差源之和。\n\n考虑函数 $f(x) = \\exp(ax)$，其中 $a=2$。我们希望在某个点 $x_0$ 处近似其导数 $f'(x_0)$。我们将比较两种常用方法：一阶向前差分公式和二阶中心差分公式。\n\n1.  **向前差分：** $D_f(x_0; h) = \\frac{f(x_0+h) - f(x_0)}{h}$\n2.  **中心差分：** $D_c(x_0; h) = \\frac{f(x_0+h) - f(x_0-h)}{2h}$\n\n这些方法的绝对截断误差的首项可以从它们的泰勒级数展开中得到。\n- 对于向前差分，截断误差为 $E_{\\text{trunc,f}} \\approx \\frac{h}{2}|f''(x_0)|$。\n- 对于中心差分，截断误差为 $E_{\\text{trunc,c}} \\approx \\frac{h^2}{6}|f'''(x_0)|$。\n\n绝对舍入误差主要由分子中的相减抵消引起。我们将此误差建模如下：\n- 导数近似中的舍入误差为 $E_{\\text{round}} = \\frac{\\delta_{num}}{D}$，其中 $\\delta_{num}$ 是分子中的绝对误差，而 $D$ 是公式的分母。\n- 对于向前差分和中心差分公式，我们将分子中的绝对误差（例如，在计算 $f(x_0+h) - f(x_0)$ 时）建模为约等于 $2\\varepsilon_m|f(x_0)|$，其中 $\\varepsilon_m$ 是机器ε。\n\n假设所用浮点运算的机器ε为 $\\varepsilon_m = 1.25 \\times 10^{-16}$。\n\n你的任务是求出比率 $\\frac{h_c}{h_f}$，其中 $h_f$ 是使向前差分法的总绝对误差最小的最佳步长，而 $h_c$ 是使中心差分法的总绝对误差最小的最佳步长。将你的最终答案表示为一个四舍五入到三位有效数字的数值。", "solution": "我们将总绝对误差建模为截断误差和舍入误差之和。对于在 $x_{0}$ 处的 $f(x)=\\exp(ax)$，我们有 $f''(x_{0})=a^{2}\\exp(a x_{0})$ 和 $f'''(x_{0})=a^{3}\\exp(a x_{0})$。记 $f_{0}=f(x_{0})=\\exp(a x_{0})>0$。\n\n对于向前差分，\n$$\nE_{\\text{trunc,f}}(h)\\approx \\frac{h}{2}|f''(x_{0})|=\\frac{a^{2}}{2}f_{0}\\,h,\n\\quad\nE_{\\text{round,f}}(h)\\approx \\frac{2\\varepsilon_{m}f_{0}}{h},\n$$\n所以\n$$\nE_{f}(h)=\\frac{a^{2}}{2}f_{0}\\,h+\\frac{2\\varepsilon_{m}f_{0}}{h}.\n$$\n为了最小化，求导并令其为零：\n$$\n\\frac{dE_{f}}{dh}=f_{0}\\left(\\frac{a^{2}}{2}-\\frac{2\\varepsilon_{m}}{h^{2}}\\right)=0\n\\;\\;\\Rightarrow\\;\\;\nh_{f}^{2}=\\frac{4\\varepsilon_{m}}{a^{2}}\n\\;\\;\\Rightarrow\\;\\;\nh_{f}=\\frac{2}{|a|}\\varepsilon_{m}^{1/2}.\n$$\n\n对于中心差分，分母是 $2h$，所以\n$$\nE_{\\text{trunc,c}}(h)\\approx \\frac{h^{2}}{6}|f'''(x_{0})|=\\frac{a^{3}}{6}f_{0}\\,h^{2},\n\\quad\nE_{\\text{round,c}}(h)\\approx \\frac{\\varepsilon_{m}f_{0}}{h},\n$$\n因此\n$$\nE_{c}(h)=\\frac{a^{3}}{6}f_{0}\\,h^{2}+\\frac{\\varepsilon_{m}f_{0}}{h}.\n$$\n为求最小值，\n$$\n\\frac{dE_{c}}{dh}=f_{0}\\left(\\frac{a^{3}}{3}h-\\frac{\\varepsilon_{m}}{h^{2}}\\right)=0\n\\;\\;\\Rightarrow\\;\\;\nh_{c}^{3}=\\frac{3\\varepsilon_{m}}{a^{3}}\n\\;\\;\\Rightarrow\\;\\;\nh_{c}=\\left(\\frac{3\\varepsilon_{m}}{a^{3}}\\right)^{1/3}.\n$$\n\n该比率为\n$$\n\\frac{h_{c}}{h_{f}}=\\frac{\\left(\\frac{3\\varepsilon_{m}}{a^{3}}\\right)^{1/3}}{\\frac{2}{|a|}\\varepsilon_{m}^{1/2}}\n=\\frac{3^{1/3}}{2}\\,\\varepsilon_{m}^{-1/6},\n$$\n这与 $a$ 无关。当 $a=2$ 且 $\\varepsilon_{m}=1.25\\times 10^{-16}$ 时，\n$$\n\\frac{h_{c}}{h_{f}}=\\frac{3^{1/3}}{2}\\left(1.25\\times 10^{-16}\\right)^{-1/6}\\approx 322.463\\ldots\n$$\n四舍五入到三位有效数字，结果是 $322$。", "answer": "$$\\boxed{322}$$", "id": "2167846"}, {"introduction": "前面的练习都基于误差的数学模型，现在让我们深入“机器内部”，亲手模拟计算过程，直观地感受舍入误差的威力。在这个练习中，你将扮演一台只有5位有效数字精度的假设计算机，去计算一个简单分段线性函数的导数。这个看似简单的任务将戏剧性地揭示“灾难性抵消”（subtractive cancellation）的后果，即两个相近的数相减导致有效信息的严重损失。通过这个动手模拟，你将不再把舍入误差看作一个抽象概念，而是作为一个在代码中真实发生的、可能导致计算结果完全错误的具体过程。[@problem_id:2167890]", "problem": "在计算科学领域，理解浮点运算的局限性对于解释数值结果至关重要。考虑一个场景，一位科学家正在模拟一个由分段线性函数 $f(x)$ 控制的物理过程，该函数定义如下：\n\n$$\nf(x) = \\begin{cases} 109.995 - 2x & \\text{if } x  50 \\\\ 9.995 + 3(x-50)  \\text{if } x \\ge 50 \\end{cases}\n$$\n\n一台假设的计算机的任务是数值估计该函数的导数。这台计算机使用维持5位有效数字精度的浮点标准执行其所有计算。每次算术运算后，结果都会被舍入到其5位有效数字的表示形式。采用的舍入规则是“半值向上舍入”（例如，2.555舍入到3位有效数字是2.56，而2.554是2.55）。\n\n计算机使用前向有限差分公式来近似导数：\n$$\nf'(x) \\approx \\frac{f(x+h) - f(x)}{h}\n$$\n\n你的任务是确定这台计算机在点 $x = 1.0$ 处，使用步长 $h = 10^{-4}$ 计算出的 $f(x)$ 的导数值。\n\n将你的答案表示为整数。", "solution": "我们必须模拟计算机的运算，每一步操作后都保留5位有效数字并进行半值向上舍入。对于接近 $x=1$ 的输入，函数使用分支 $f(x)=109.995-2x$。\n\n定义 $R(\\cdot)$ 为保留5位有效数字的半值向上舍入。\n\n首先计算 $x+h$：\n$$\nx=1.0,\\quad h=10^{-4},\\quad x+h=R(1.0+10^{-4})=R(1.0001)=1.0001.\n$$\n\n在 $x=1.0$ 处计算 $f(x)$ 的值：\n- 乘法：$R(2\\cdot 1.0)=R(2.0)=2.0000$。\n- 减法：$R(109.995-2.0000)=R(107.995)=108.00$（因为第六位有效数字是$5$，所以向上舍入）。\n\n因此，在机器中 $f(1.0)=108.00$。\n\n在 $x+h=1.0001$ 处计算 $f(x+h)$ 的值：\n- 乘法：$R(2\\cdot 1.0001)=R(2.0002)=2.0002$。\n- 减法：$R(109.995-2.0002)=R(107.9948)=107.99$（因为第六位有效数字是$4$，所以向下舍入）。\n\n因此，在机器中 $f(1.0001)=107.99$。\n\n构建前向差分的分子，然后除以 $h$：\n$$\nR\\big(f(1.0001)-f(1.0)\\big)=R(107.99-108.00)=R(-0.01)=-0.01,\n$$\n$$\nR\\left(\\frac{-0.01}{10^{-4}}\\right)=R(-100)=-100.\n$$\n\n因此，计算机在 $x=1.0$ 处使用 $h=10^{-4}$ 计算出的导数值为 $-100$。", "answer": "$$\\boxed{-100}$$", "id": "2167890"}]}