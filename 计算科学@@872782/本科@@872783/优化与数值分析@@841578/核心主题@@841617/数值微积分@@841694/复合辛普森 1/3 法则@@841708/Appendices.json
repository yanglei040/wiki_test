{"hands_on_practices": [{"introduction": "掌握任何数值方法的第一步都是熟悉其基本计算过程。本练习将引导你应用复合辛普森1/3法则来近似计算一个我们已知其精确解的简单积分。通过将数值近似结果与精确值进行比较 [@problem_id:2210199]，你将直观地理解近似误差的概念，并为更复杂的应用打下坚实的基础。", "problem": "物理系统中一个可观测量 $Q$ 的变化率由函数 $f(t) = V_0 \\cos(\\omega t)$ 描述，其中 $t$ 是时间。该量在区间 $[a, b]$ 上的总变化量由定积分 $\\Delta Q = \\int_{a}^{b} f(t) \\, dt$ 给出。\n\n考虑一个系统，其常数为 $V_0 = 1.0$ 单位/秒 和 $\\omega = 1.0$ 弧度/秒。你的任务是分析在从 $t=0$ 到 $t=\\frac{\\pi}{2}$ 秒的时间区间内，$Q$ 的总变化量 $\\Delta Q$ (以单位计)。\n\n首先，计算总变化量的精确值 $\\Delta Q_{exact}$。\n其次，通过使用 $n=4$ 个子区间的复合辛普森 1/3 法则，计算总变化量的近似值 $\\Delta Q_{approx}$。当子区间数 $n$ 为偶数时，积分 $\\int_a^b g(x) \\, dx$ 的复合辛普森 1/3 法则近似公式为\n$$S_n = \\frac{h}{3} \\left[ g(x_0) + 4\\sum_{i=1}^{n/2} g(x_{2i-1}) + 2\\sum_{i=1}^{n/2-1} g(x_{2i}) + g(x_n) \\right]$$\n其中 $h = \\frac{b-a}{n}$ 且 $x_i = a+ih$，$i=0, 1, \\dots, n$。\n\n最后，计算近似值的绝对误差大小，其定义为 $|\\Delta Q_{exact} - \\Delta Q_{approx}|$。将此绝对误差作为你的最终答案报告。将最终答案四舍五入到五位有效数字。", "solution": "给定变化率 $f(t) = V_{0}\\cos(\\omega t)$ 以及在 $[a,b]$ 上的总变化量：\n$$\n\\Delta Q=\\int_{a}^{b} f(t)\\,dt.\n$$\n当 $V_{0}=1$ 和 $\\omega=1$ 时，我们有 $f(t)=\\cos t$，$a=0$，$b=\\frac{\\pi}{2}$。\n\n精确值：\n使用反导数 $\\int \\cos t\\,dt=\\sin t$，根据微积分基本定理可得\n$$\n\\Delta Q_{\\text{exact}}=\\int_{0}^{\\frac{\\pi}{2}} \\cos t\\,dt=\\left[\\sin t\\right]_{0}^{\\frac{\\pi}{2}}=\\sin\\!\\left(\\frac{\\pi}{2}\\right)-\\sin(0)=1-0=1.\n$$\n\n使用 $n=4$ 的复合辛普森 1/3 法则：\n这里 $h=\\frac{b-a}{n}=\\frac{\\frac{\\pi}{2}-0}{4}=\\frac{\\pi}{8}$ 且 $x_{i}=a+ih=0+i\\frac{\\pi}{8}$，对于 $i=0,1,2,3,4$。因此\n$$\nx_{0}=0,\\quad x_{1}=\\frac{\\pi}{8},\\quad x_{2}=\\frac{\\pi}{4},\\quad x_{3}=\\frac{3\\pi}{8},\\quad x_{4}=\\frac{\\pi}{2}.\n$$\n使用复合辛普森公式\n$$\nS_{4}=\\frac{h}{3}\\left[g(x_{0})+4\\sum_{i=1}^{2}g(x_{2i-1})+2\\sum_{i=1}^{1}g(x_{2i})+g(x_{4})\\right],\n$$\n当 $g(t)=\\cos t$ 时，我们得到\n$$\nS_{4}=\\frac{\\pi}{24}\\left[\\cos 0+4\\left(\\cos\\!\\left(\\frac{\\pi}{8}\\right)+\\cos\\!\\left(\\frac{3\\pi}{8}\\right)\\right)+2\\cos\\!\\left(\\frac{\\pi}{4}\\right)+\\cos\\!\\left(\\frac{\\pi}{2}\\right)\\right].\n$$\n使用精确的特殊值 $\\cos 0=1$、$\\cos\\!\\left(\\frac{\\pi}{4}\\right)=\\frac{\\sqrt{2}}{2}$、$\\cos\\!\\left(\\frac{\\pi}{2}\\right)=0$，以及数值近似 $\\cos\\!\\left(\\frac{\\pi}{8}\\right)\\approx 0.9238795325$、$\\cos\\!\\left(\\frac{3\\pi}{8}\\right)\\approx 0.3826834324$，我们计算\n$$\nS_{4}\\approx \\frac{\\pi}{24}\\left[1+4(0.9238795325+0.3826834324)+2\\cdot 0.7071067812+0\\right]\\approx 1.000134584974194.\n$$\n\n绝对误差：\n$$\n\\left|\\Delta Q_{\\text{exact}}-\\Delta Q_{\\text{approx}}\\right|=\\left|1-1.000134584974194\\right|\\approx 0.000134584974194.\n$$\n四舍五入到五位有效数字得到 $1.3458\\times 10^{-4}$。", "answer": "$$\\boxed{1.3458 \\times 10^{-4}}$$", "id": "2210199"}, {"introduction": "在许多科学和工程应用中，我们往往无法得到一个完美的数学函数，而是拥有一系列离散的测量数据。这个练习模拟了一个真实的环境工程场景，你需要利用辛普森法则来处理这些离散的数据点。这个实践将展示数值积分如何成为连接离散观测与连续总量估算之间的桥梁 [@problem_id:2210253]，突显其在处理实验数据时的强大功能。", "problem": "一位环境工程师正在监测从一个工业设施排放到河流中的一种污染物。水的排放体积流量恒定，为 $Q = 50.0 \\, \\text{m}^3/\\text{hr}$。一个传感器记录了排放水中污染物的浓度 $C(t)$，单位为克每立方米（$\\text{g}/\\text{m}^3$）。在特定的时间点记录了以下浓度：在 $t=0.0$ 小时， $C(0.0) = 5.1$；在 $t=0.2$ 小时， $C(0.2) = 7.3$；在 $t=0.4$ 小时， $C(0.4) = 8.9$；在 $t=0.6$ 小时， $C(0.6) = 7.5$；以及在 $t=0.8$ 小时， $C(0.8) = 6.2$。\n\n估算在 $t=0.0$ 小时到 $t=0.8$ 小时的时间间隔内排放的污染物总质量。你对相应积分的数值近似应基于一种能产生 $O(h^4)$ 阶全局误差的方法，其中 $h$ 是连续测量之间的时间步长。请用千克（kg）表示你的最终答案，并四舍五入到三位有效数字。", "solution": "瞬时质量排放率由 $r(t)=Q\\,C(t)$ 给出，因此在 $[0,0.8]$ 小时内的总质量为\n$$\nM=\\int_{0}^{0.8} r(t)\\,dt=Q\\int_{0}^{0.8} C(t)\\,dt.\n$$\n在 $t_{k}=0.0,0.2,0.4,0.6,0.8$ 小时进行均匀测量，步长为 $h=0.2$。为达到 $O(h^{4})$ 的全局误差，使用复合辛普森法则：\n$$\n\\int_{0}^{0.8} C(t)\\,dt \\approx \\frac{h}{3}\\left[C(0.0)+4C(0.2)+2C(0.4)+4C(0.6)+C(0.8)\\right].\n$$\n代入记录的浓度值，\n$$\n\\int_{0}^{0.8} C(t)\\,dt \\approx \\frac{0.2}{3}\\left[5.1+4(7.3)+2(8.9)+4(7.5)+6.2\\right].\n$$\n计算加权和：\n$$\n5.1+4(7.3)+2(8.9)+4(7.5)+6.2=5.1+29.2+17.8+30.0+6.2=88.3,\n$$\n所以\n$$\n\\int_{0}^{0.8} C(t)\\,dt \\approx \\frac{0.2}{3}\\cdot 88.3=\\frac{88.3}{15}.\n$$\n因此，总质量（以克为单位）是\n$$\nM=Q\\int_{0}^{0.8} C(t)\\,dt=50\\cdot \\frac{88.3}{15}=\\frac{4415}{15}=\\frac{883}{3}\\ \\text{g}.\n$$\n转换为千克：\n$$\nM=\\frac{883}{3}\\times 10^{-3}\\ \\text{kg}=0.294333\\ldots\\ \\text{kg}.\n$$\n四舍五入到三位有效数字得到 $0.294$。", "answer": "$$\\boxed{0.294}$$", "id": "2210253"}, {"introduction": "获得一个近似值固然重要，但保证这个近似值的精度同样关键。本练习将带你深入该方法的理论层面，学习如何使用误差界限公式来预先规划计算。通过确定为达到特定精度要求所需的最小子区间数 [@problem_id:2210241]，你将学会如何设计既高效又可靠的数值计算方案，这是从方法的使用者到设计者的关键一步。", "problem": "在数值分析中，当一个函数的解析解难以或不可能求得时，其定积分通常使用求积法则来近似计算。复化辛普son 1/3 法则就是其中一种方法。\n\n考虑近似计算积分 $I = \\int_1^2 \\frac{1}{x} \\, dx$ 的值。\n\n使用偶数个子区间 $n$ 的复化辛普森 1/3 法则来近似计算 $\\int_a^b f(x) \\, dx$ 的绝对误差 $E_S$ 由以下不等式给出界限：\n$$|E_S| \\leq \\frac{(b-a)^5}{180n^4} M_4$$\n其中 $M_4$ 是函数 $f(x)$ 在区间 $[a, b]$ 上四阶导数绝对值的上界；即对所有 $x \\in [a, b]$ 都有 $|f^{(4)}(x)| \\leq M_4$。\n\n确定为保证使用复化辛普森 1/3 法则对积分 $I$ 的近似值的绝对误差小于 $10^{-5}$ 所需的最小偶数 $n$。", "solution": "我们使用具有 $n$ 个（偶数）子区间的复化辛普森 1/3 法则来近似计算 $I=\\int_{1}^{2}\\frac{1}{x}\\,dx$。误差界为\n$$\n|E_{S}|\\leq \\frac{(b-a)^{5}}{180\\,n^{4}}\\,M_{4},\n$$\n其中 $M_{4}$ 满足对于 $x\\in[1,2]$ 和 $f(x)=\\frac{1}{x}$，有 $|f^{(4)}(x)|\\leq M_{4}$。\n\n计算导数：\n$$\nf(x)=x^{-1},\\quad f'(x)=-x^{-2},\\quad f''(x)=2x^{-3},\\quad f^{(3)}(x)=-6x^{-4},\\quad f^{(4)}(x)=24x^{-5}.\n$$\n因此 $|f^{(4)}(x)|=24x^{-5}$，它在 $[1,2]$ 上是递减的，所以其最大值在 $x=1$ 处取得。因此\n$$\nM_{4}=24.\n$$\n\n当 $a=1$ 和 $b=2$ 时，我们有 $b-a=1$，所以误差界变为\n$$\n|E_{S}|\\leq \\frac{1^{5}}{180\\,n^{4}}\\cdot 24=\\frac{24}{180\\,n^{4}}=\\frac{2}{15\\,n^{4}}.\n$$\n为保证 $|E_{S}|  10^{-5}$，只需满足\n$$\n\\frac{2}{15n^{4}}  10^{-5}\\quad\\Longrightarrow\\quad n^{4} > \\frac{2}{15}\\times 10^{5}=\\frac{40000}{3}.\n$$\n取四次方根得出 $n > \\left(\\frac{40000}{3}\\right)^{1/4} \\approx 10.74$。由于 $n$ 必须是偶数，我们测试 $n=10$ 和 $n=12$：\n$$\n10^{4}=10000  \\frac{40000}{3},\\quad 12^{4}=20736 > \\frac{40000}{3}.\n$$\n因此，保证 $|E_{S}|  10^{-5}$ 的最小偶数 $n$ 是 $n=12$。", "answer": "$$\\boxed{12}$$", "id": "2210241"}]}