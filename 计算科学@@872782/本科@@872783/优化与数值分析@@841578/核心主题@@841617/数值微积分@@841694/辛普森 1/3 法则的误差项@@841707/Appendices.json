{"hands_on_practices": [{"introduction": "为了真正掌握辛普森法则的误差项，我们从一个直接的计算开始。第一个练习将引导你为一个简单的积分计算数值近似产生的实际误差和理论误差界 [@problem_id:2170172]。通过比较这两个值，你将对误差公式如何为近似的非精确性提供上限有一个具体的理解，尤其是在一个理论界限被精确达到的特殊情况下。", "problem": "一名数值分析课程的学生，其任务是评估辛普森1/3法则对于一个特定多项式函数的性能。所讨论的积分为 $I = \\int_{0}^{1} x^{4} dx$。学生使用辛普森1/3法则，取 $n=2$ 个子区间来找到一个近似值，我们称之为 $S_2$。\n\n接着，学生被要求进行误差分析。这个分析包括两个部分：\n1.  计算实际误差的大小，$E_{actual} = |I - S_2|$。\n2.  使用辛普森法则的标准公式计算理论误差界 $E_{bound}$：\n    $$E_{bound} = \\frac{(b-a)^5}{180n^4} M$$\n    其中 $[a, b]$ 是积分区间，$n$ 是子区间的数量（必须是偶数），$M$ 是被积函数在区间上四阶导数绝对值的最大值，即 $M = \\max_{x \\in [a, b]} |f^{(4)}(x)|$。\n\n计算实际误差 $E_{actual}$ 和理论误差界 $E_{bound}$ 的值。将你的最终答案以行矩阵 $(E_{actual}, E_{bound})$ 的形式表示为一对精确的分数。", "solution": "设函数 $f(x)=x^{4}$ 在 $[a,b]=[0,1]$ 上。其精确积分为\n$$\nI=\\int_{0}^{1} x^{4}\\,dx=\\left.\\frac{x^{5}}{5}\\right|_{0}^{1}=\\frac{1}{5}.\n$$\n使用辛普森1/3法则，取 $n=2$ 个子区间，步长为 $h=\\frac{b-a}{n}=\\frac{1}{2}$，节点为 $x_{0}=0$，$x_{1}=\\frac{1}{2}$，$x_{2}=1$。辛普森近似值为\n$$\nS_{2}=\\frac{h}{3}\\big(f(x_{0})+4f(x_{1})+f(x_{2})\\big)=\\frac{1/2}{3}\\left(f(0)+4f\\!\\left(\\frac{1}{2}\\right)+f(1)\\right).\n$$\n计算 $f$ 在这些节点上的值，得到 $f(0)=0$，$f\\!\\left(\\frac{1}{2}\\right)=\\left(\\frac{1}{2}\\right)^{4}=\\frac{1}{16}$，以及 $f(1)=1$。因此\n$$\nS_{2}=\\frac{1}{6}\\left(0+4\\cdot\\frac{1}{16}+1\\right)=\\frac{1}{6}\\left(\\frac{1}{4}+1\\right)=\\frac{1}{6}\\cdot\\frac{5}{4}=\\frac{5}{24}.\n$$\n实际误差为\n$$\nE_{\\text{actual}}=\\left|I-S_{2}\\right|=\\left|\\frac{1}{5}-\\frac{5}{24}\\right|=\\left|\\frac{24}{120}-\\frac{25}{120}\\right|=\\frac{1}{120}.\n$$\n对于理论误差界，我们计算四阶导数：$f'(x)=4x^{3}$，$f''(x)=12x^{2}$，$f^{(3)}(x)=24x$，以及 $f^{(4)}(x)=24$。因此\n$$\nM=\\max_{x\\in[0,1]}|f^{(4)}(x)|=24.\n$$\n使用辛普森误差界公式\n$$\nE_{\\text{bound}}=\\frac{(b-a)^{5}}{180\\,n^{4}}\\,M=\\frac{1^{5}}{180\\cdot 2^{4}}\\cdot 24=\\frac{24}{2880}=\\frac{1}{120}.\n$$\n因此，实际误差和理论误差界均为 $\\frac{1}{120}$。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{1}{120}  \\frac{1}{120}\\end{pmatrix}}$$", "id": "2170172"}, {"introduction": "辛普森法则的误差不仅与区间大小或步数有关，它也与函数本身密切相关。这个练习挑战你比较两个不同三角函数的误差界，看看它们的内在属性如何影响潜在的误差 [@problem_id:2170149]。这将帮助你培养一种直觉，即一个函数的“振荡性”（由其四阶导数的幅度捕捉）如何影响近似的准确性。", "problem": "在数值分析中，辛普森1/3法则是近似计算函数定积分的一种方法。这种近似的精度可以通过误差界来估计。使用辛普森1/3法则和 $n$ 个子区间（其中 $n$ 是偶数）来近似积分 $\\int_a^b f(x) \\, dx$ 时，最大绝对误差（记为 $|E_S|$）由以下不等式给出：\n$$|E_S| \\leq \\frac{(b-a)^5}{180n^4} M_4$$\n这里，$M_4$ 是函数四阶导数绝对值的最大值，即 $M_4 = \\max_{x \\in [a, b]} |f^{(4)}(x)|$。\n\n考虑使用辛普森1/3法则对两个不同的积分进行数值近似，两个积分都在相同的区间 $[0, \\pi]$ 上进行，并使用相同数量的子区间 $n$。\n这两个积分是：\n$$I_1 = \\int_{0}^{\\pi} \\cos(x) \\, dx$$\n$$I_2 = \\int_{0}^{\\pi} \\cos(3x) \\, dx$$\n\n设 $E_{max,1}$ 是 $I_1$ 近似的最大可能误差（误差界），$E_{max,2}$ 是 $I_2$ 近似的最大可能误差。计算比值 $\\frac{E_{max,2}}{E_{max,1}}$ 的精确值。", "solution": "我们使用辛普森1/3法则的误差界\n$$|E_{S}| \\leq \\frac{(b-a)^{5}}{180 n^{4}} M_{4}, \\quad M_{4}=\\max_{x\\in[a,b]}|f^{(4)}(x)|.$$\n对于积分 $I_{1}$ 和 $I_{2}$，区间都是 $[0,\\pi]$，子区间的数量 $n$ 也相同。因此，\n$$\\frac{E_{max,2}}{E_{max,1}}=\\frac{M_{4,2}}{M_{4,1}}.$$\n\n计算 $f_{1}(x)=\\cos(x)$ 的 $M_{4,1}$：\n- $f_{1}'(x)=-\\sin(x)$,\n- $f_{1}''(x)=-\\cos(x)$,\n- $f_{1}'''(x)=\\sin(x)$,\n- $f_{1}^{(4)}(x)=\\cos(x)$.\n因此 $\\max_{x\\in[0,\\pi]}|f_{1}^{(4)}(x)|=\\max_{x\\in[0,\\pi]}|\\cos(x)|=1$，所以 $M_{4,1}=1$。\n\n计算 $f_{2}(x)=\\cos(3x)$ 的 $M_{4,2}$：\n- $f_{2}'(x)=-3\\sin(3x)$,\n- $f_{2}''(x)=-9\\cos(3x)$,\n- $f_{2}'''(x)=27\\sin(3x)$,\n- $f_{2}^{(4)}(x)=81\\cos(3x)$.\n因此 $\\max_{x\\in[0,\\pi]}|f_{2}^{(4)}(x)|=81\\max_{x\\in[0,\\pi]}|\\cos(3x)|=81$，所以 $M_{4,2}=81$。\n\n因此，\n$$\\frac{E_{max,2}}{E_{max,1}}=\\frac{M_{4,2}}{M_{4,1}}=\\frac{81}{1}=81.$$", "answer": "$$\\boxed{81}$$", "id": "2170149"}, {"introduction": "误差公式最强大的用途或许不是在事后进行分析，而是在事前规划计算。在最后一个练习中，你将使用误差界来解决一个常见的实际问题：确定为一个给定的积分达到期望的精度水平所需的最少子区间数 [@problem_id:2170216]。这展示了理论如何指导高效、可靠的数值计算工作。", "problem": "一位数值分析师的任务是近似计算自然对数 2 的值，该值由定积分 $\\int_1^2 \\frac{1}{x} dx$ 给出。为此，将使用复合辛普森 1/3 法则对该积分进行数值计算。确定所需的最小偶数子区间数 $n$，以保证近似值的绝对误差最多为 $10^{-6}$。", "solution": "我们使用复合辛普森 1/3 法则在区间 $[1,2]$ 上，取偶数个子区间 $n$ 且步长为 $h = \\frac{b-a}{n} = \\frac{1}{n}$，来近似计算 $\\int_{1}^{2} \\frac{1}{x} \\, dx = \\ln(2)$。对于一个在 $[a,b]$ 上具有四阶连续导数的函数 $f$，其复合辛普森误差满足\n$$\nE_{S} = -\\frac{b-a}{180} h^{4} f^{(4)}(\\xi)\n$$\n其中 $\\xi \\in (a,b)$，因此\n$$\n|E_{S}| \\leq \\frac{b-a}{180} h^{4} \\max_{x \\in [a,b]} |f^{(4)}(x)|.\n$$\n\n本题中，$f(x) = x^{-1}$ 定义在 $[1,2]$ 上。我们计算其导数：\n$$\nf'(x) = -x^{-2}, \\quad f''(x) = 2 x^{-3}, \\quad f^{(3)}(x) = -6 x^{-4}, \\quad f^{(4)}(x) = 24 x^{-5}.\n$$\n因此，\n$$\n|f^{(4)}(x)| = 24 x^{-5},\n$$\n该函数在 $[1,2]$ 上是递减的，并在 $x=1$ 处取得其最大值，得到\n$$\nM := \\max_{x \\in [1,2]} |f^{(4)}(x)| = 24.\n$$\n\n当 $b-a = 1$ 且 $h = \\frac{1}{n}$ 时，误差界变为\n$$\n|E_{S}| \\leq \\frac{1}{180} \\left(\\frac{1}{n}\\right)^{4} \\cdot 24 = \\frac{24}{180} \\frac{1}{n^{4}} = \\frac{2}{15} \\frac{1}{n^{4}}.\n$$\n为保证 $|E_{S}| \\leq 1 \\times 10^{-6}$，我们需要\n$$\n\\frac{2}{15} \\frac{1}{n^{4}} \\leq 1 \\times 10^{-6}\n\\;\\;\\Longleftrightarrow\\;\\;\nn^{4} \\geq \\frac{2}{15} \\times 10^{6}.\n$$\n因此\n$$\nn^4 \\ge \\frac{2}{15} \\times 10^6 \\approx 133333.33.\n$$\n我们需要找到满足此条件的最小偶数 $n$。测试可得 $18^4=104976  133333.33$，不满足。而 $20^4=160000 > 133333.33$，满足。因此，所需的最小偶数子区间数 $n$ 是 20。", "answer": "$$\\boxed{20}$$", "id": "2170216"}]}