{"hands_on_practices": [{"introduction": "理解部分主元法的第一步是掌握其最基本的操作：选择最佳的主元。这个练习将重点放在高斯消元法开始时，如何正确地识别需要交换的行，这是确保算法从一开始就保持稳定的关键技能。[@problem_id:2193012]", "problem": "在数值线性代数中，人们采用一些策略来提高像高斯消元法这类算法的稳定性。考虑由矩阵方程 $A\\mathbf{x} = \\mathbf{b}$ 表示的线性方程组，其中系数矩阵 $A$ 如下所示：\n\n$$\nA = \\begin{pmatrix}\n3.1  -1.5  4.2 \\\\\n-2.5  8.9  -0.7 \\\\\n-7.8  3.4  1.1\n\\end{pmatrix}\n$$\n\n为了开始使用带部分主元法的高斯消元法求解该方程组，必须首先执行一次特定的行交换，以确保主元具有可能的最大绝对值。下列哪项描述了该策略所要求的第一步操作？\n\nA. 交换第1行和第2行。\n\nB. 交换第1行和第3行。\n\nC. 交换第2行和第3行。\n\nD. 第一步不需要进行任何行交换。\n\nE. 该策略无法应用，因为矩阵是奇异的。", "solution": "问题要求对给定的 $3 \\times 3$ 矩阵 $A$ 使用带部分主元法的高斯消元法的第一步。\n\n矩阵为：\n$$\nA = \\begin{pmatrix}\n3.1  -1.5  4.2 \\\\\n-2.5  8.9  -0.7 \\\\\n-7.8  3.4  1.1\n\\end{pmatrix}\n$$\n\n针对第一列（步骤 $k=1$）的部分主元策略是，找出第一列中绝对值最大的元素所在的行。该元素将成为第一阶段消元的主元。\n\n我们将矩阵的元素表示为 $a_{ij}$，其中 $i$ 是行索引，$j$ 是列索引。我们需要检查第一列中的元素：$a_{11}$、$a_{21}$ 和 $a_{31}$。\n\n这些元素是：\n$a_{11} = 3.1$\n$a_{21} = -2.5$\n$a_{31} = -7.8$\n\n接下来，我们计算这些元素的绝对值：\n$|a_{11}| = |3.1| = 3.1$\n$|a_{21}| = |-2.5| = 2.5$\n$|a_{31}| = |-7.8| = 7.8$\n\n我们现在找出这些绝对值中的最大值：\n$\\max(|a_{11}|, |a_{21}|, |a_{31}|) = \\max(3.1, 2.5, 7.8) = 7.8$。\n\n这个最大的绝对值对应于元素 $a_{31}$，它位于第三行。\n\n根据部分主元法的步骤，包含主元（当前列中绝对值最大的元素）的行必须与当前主元行进行交换。对于第一步，当前主元行是第1行。由于绝对值最大的元素在第3行，我们必须交换第1行和第3行。\n\n交换后，矩阵将变为：\n$$\nA' = \\begin{pmatrix}\n-7.8  3.4  1.1 \\\\\n-2.5  8.9  -0.7 \\\\\n3.1  -1.5  4.2\n\\end{pmatrix}\n$$\n新的主元是 $a'_{11} = -7.8$，其绝对值比第一列中其他原始元素的绝对值都大。\n\n因此，要求的第一步操作是交换第1行和第3行。这对应于选项B。选项E是错误的，因为无论矩阵是否奇异（尽管奇异矩阵会在某个阶段导致主元为零），主元策略都可以应用，且该操作是明确定义的。", "answer": "$$\\boxed{B}$$", "id": "2193012"}, {"introduction": "掌握了初始主元的选择后，下一步就是迭代地应用这个过程。这个练习要求你在高斯消元的全过程中追踪主元选择的完整序列，帮助你内化整个算法，并理解矩阵在每一步是如何变换的。[@problem_id:2192993]", "problem": "考虑使用带部分主元法的高斯消元法求解线性方程组 $Ax=b$ 的过程。在该方法中，对给定的列 $k$ 进行消元之前，算法会找出在列 $k$ 中具有最大绝对值元素的行 $i \\geq k$。然后将该行 $i$ 与当前行 $k$ 进行交换。此时位于位置 $(k,k)$ 的元素成为该步骤的主元。\n\n给定以下 $4 \\times 4$ 矩阵 $A$：\n$$\nA = \\begin{pmatrix}\n1  -2  3  4 \\\\\n3  1  -5  2 \\\\\n-4  5  1  -1 \\\\\n2  -3  4  1\n\\end{pmatrix}\n$$\n\n设矩阵的原始行索引为 1 到 4。当对矩阵 $A$ 执行带部分主元法的高斯消元时，您将为四个步骤（即对列 $k=1, 2, 3, 4$）中的每一步选择一个主元。请确定在每个步骤中选定的主元的*原始*行索引序列。\n\n例如，如果第一步（k=1）的主元来自原始矩阵的第三行，那么序列中的第一个数字是 3。如果第二步（k=2）的主元来自原始矩阵的第一行，则序列将以 `[3, 1, ...]` 开始。\n\n以下哪个选项代表了正确的主元原始行索引序列？\n\nA. `[1, 2, 3, 4]`\n\nB. `[3, 2, 1, 4]`\n\nC. `[3, 2, 4, 1]`\n\nD. `[3, 1, 2, 4]`", "solution": "我们应用带部分主元法的高斯消元法。在每个步骤 $k$，我们在列 $k$ 中行 $i \\geq k$ 的元素里选择绝对值最大的元素作为主元，将该行与第 $k$ 行交换，然后消去主元下方的元素。我们跟踪原始行索引。\n\n初始时，\n$$\nA=\\begin{pmatrix}\n1  -2  3  4 \\\\\n3  1  -5  2 \\\\\n-4  5  1  -1 \\\\\n2  -3  4  1\n\\end{pmatrix}.\n$$\n\n步骤 $k=1$：在第 $1$ 列中，绝对值为 $|1|,|3|,|{-4}|,|2|$，最大值 $4$ 位于原始第 $3$ 行。将第 $1$ 行与第 $3$ 行交换（主元的原始索引为 $3$）：\n$$\n\\begin{pmatrix}\n-4  5  1  -1 \\\\\n3  1  -5  2 \\\\\n1  -2  3  4 \\\\\n2  -3  4  1\n\\end{pmatrix}.\n$$\n使用 $m_{21}=\\frac{3}{-4}=-\\frac{3}{4}$，$m_{31}=\\frac{1}{-4}=-\\frac{1}{4}$，$m_{41}=\\frac{2}{-4}=-\\frac{1}{2}$ 进行下方消元，即 $\\text{row}_{i}\\leftarrow \\text{row}_{i}-m_{i1}\\text{row}_{1}$：\n$$\n\\text{row}_{2}=\\begin{pmatrix}3  1  -5  2\\end{pmatrix}+\\frac{3}{4}\\begin{pmatrix}-4  5  1  -1\\end{pmatrix}=\\begin{pmatrix}0  \\frac{19}{4}  -\\frac{17}{4}  \\frac{5}{4}\\end{pmatrix},\n$$\n$$\n\\text{row}_{3}=\\begin{pmatrix}1  -2  3  4\\end{pmatrix}+\\frac{1}{4}\\begin{pmatrix}-4  5  1  -1\\end{pmatrix}=\\begin{pmatrix}0  -\\frac{3}{4}  \\frac{13}{4}  \\frac{15}{4}\\end{pmatrix},\n$$\n$$\n\\text{row}_{4}=\\begin{pmatrix}2  -3  4  1\\end{pmatrix}+\\frac{1}{2}\\begin{pmatrix}-4  5  1  -1\\end{pmatrix}=\\begin{pmatrix}0  -\\frac{1}{2}  \\frac{9}{2}  \\frac{1}{2}\\end{pmatrix}.\n$$\n\n步骤 $k=2$：在第 $2$ 列（第 $2$ 行到第 $4$ 行）中，绝对值为 $\\left|\\frac{19}{4}\\right|,\\left|-\\frac{3}{4}\\right|,\\left|-\\frac{1}{2}\\right|$，最大值 $\\frac{19}{4}$ 位于当前第 $2$ 行（原始第 $2$ 行）。不进行交换（主元的原始索引为 $2$）。使用以下公式进行下方消元\n$$\nm_{32}=\\frac{-\\frac{3}{4}}{\\frac{19}{4}}=-\\frac{3}{19},\\quad m_{42}=\\frac{-\\frac{1}{2}}{\\frac{19}{4}}=-\\frac{2}{19}.\n$$\n因此，\n$$\n\\text{row}_{3}=\\begin{pmatrix}0  -\\frac{3}{4}  \\frac{13}{4}  \\frac{15}{4}\\end{pmatrix}+\\frac{3}{19}\\begin{pmatrix}0  \\frac{19}{4}  -\\frac{17}{4}  \\frac{5}{4}\\end{pmatrix}=\\begin{pmatrix}0  0  \\frac{49}{19}  \\frac{75}{19}\\end{pmatrix},\n$$\n$$\n\\text{row}_{4}=\\begin{pmatrix}0  -\\frac{1}{2}  \\frac{9}{2}  \\frac{1}{2}\\end{pmatrix}+\\frac{2}{19}\\begin{pmatrix}0  \\frac{19}{4}  -\\frac{17}{4}  \\frac{5}{4}\\end{pmatrix}=\\begin{pmatrix}0  0  \\frac{77}{19}  \\frac{12}{19}\\end{pmatrix}.\n$$\n\n步骤 $k=3$：在第 $3$ 列（第 $3$ 行和第 $4$ 行）中，绝对值为 $\\left|\\frac{49}{19}\\right|$ 和 $\\left|\\frac{77}{19}\\right|$，最大值 $\\frac{77}{19}$ 位于当前第 $4$ 行（原始第 $4$ 行）。交换第 $3$ 行和第 $4$ 行（主元的原始索引为 $4$），然后进行下方消元：\n$$\n\\text{row}_{4}\\leftarrow \\text{row}_{4}-\\frac{\\frac{49}{19}}{\\frac{77}{19}}\\text{row}_{3}=\\begin{pmatrix}0  0  \\frac{49}{19}  \\frac{75}{19}\\end{pmatrix}-\\frac{49}{77}\\begin{pmatrix}0  0  \\frac{77}{19}  \\frac{12}{19}\\end{pmatrix}=\\begin{pmatrix}0  0  0  \\frac{39}{11}\\end{pmatrix}.\n$$\n\n步骤 $k=4$：只剩下第 $4$ 行；其原始索引为 $1$（主元的原始索引为 $1$）。\n\n因此，主元的原始行索引序列是 $[3,2,4,1]$，对应选项 C。", "answer": "$$\\boxed{C}$$", "id": "2192993"}, {"introduction": "部分主元法的真正价值在于它对数值精度的保障。这个练习将通过一个精心设计的案例，让你在有限精度算术的环境下求解一个线性系统。通过运用部分主元法，你将亲身体会到该策略如何在一个潜在不稳定的问题中确保解的准确性，从而深刻理解为何它是不可或缺的。[@problem_id:2193047]", "problem": "考虑以下线性方程组：\n$$\n\\begin{align*}\n(2.00 \\times 10^{-4}) x_1 + 2.00 x_2 &= 4.00 \\\\\n1.00 x_1 + 3.00 x_2 &= 5.00\n\\end{align*}\n$$\n你需要使用高斯消元法求解该方程组，但所有计算都必须使用一种简化的浮点表示法，称为**三位数截断算术**。在这种算术系统中，数字首先被写成规格化十进制形式 $\\pm 0.d_1d_2d_3d_4... \\times 10^n$，其中 $d_1 \\in \\{1, 2, \\dots, 9\\}$。然后通过“截断”第三位之后的所有数字来存储该数，得到形式 $\\pm 0.d_1d_2d_3 \\times 10^n$。每次独立的算术运算（加、减、乘、除）后都会进行这种截断。\n\n使用**部分主元法**的高斯消元法计算解向量 $\\mathbf{x} = [x_1, x_2]^T$。将你的最终答案表示为解向量的两个分量。", "solution": "我们应用带有部分主元法的高斯消元法，并遵循三位数截断算术规则（每次运算后以三位有效数字的规格化形式存储数字）。\n\n从增广矩阵开始\n$$\n\\left[\\begin{array}{cc|c}\n2.00\\times 10^{-4} & 2.00 & 4.00\\\\\n1.00 & 3.00 & 5.00\n\\end{array}\\right].\n$$\n对第1列进行部分主元法，比较 $|2.00\\times 10^{-4}|$ 和 $|1.00|$，因此我们交换两行：\n$$\n\\left[\\begin{array}{cc|c}\n1.00 & 3.00 & 5.00\\\\\n2.00\\times 10^{-4} & 2.00 & 4.00\n\\end{array}\\right].\n$$\n消元乘数\n$$\n\\ell_{21}=\\text{chop}_{3}\\left(\\frac{2.00\\times 10^{-4}}{1.00}\\right)=2.00\\times 10^{-4}.\n$$\n在每次运算后进行截断，更新第2行的元素：\n- 新的 $a_{21}$：\n$$\n\\text{chop}_{3}\\left(2.00\\times 10^{-4}-\\ell_{21}\\cdot 1.00\\right)=\\text{chop}_{3}\\left(2.00\\times 10^{-4}-2.00\\times 10^{-4}\\right)=0.\n$$\n- 新的 $a_{22}$：\n$$\n\\ell_{21}\\cdot a_{12}=\\text{chop}_{3}\\left((2.00\\times 10^{-4})\\cdot 3.00\\right)=6.00\\times 10^{-4},\n$$\n$$\na_{22}^{(new)}=\\text{chop}_{3}\\left(2.00-6.00\\times 10^{-4}\\right)=\\text{chop}_{3}(1.9994)=1.99.\n$$\n- 新的 $b_{2}$：\n$$\n\\ell_{21}\\cdot b_{1}=\\text{chop}_{3}\\left((2.00\\times 10^{-4})\\cdot 5.00\\right)=1.00\\times 10^{-3},\n$$\n$$\nb_{2}^{(new)}=\\text{chop}_{3}\\left(4.00-1.00\\times 10^{-3}\\right)=\\text{chop}_{3}(3.999)=3.99.\n$$\n因此，上三角系统为\n$$\n\\begin{cases}\n1.00\\,x_{1}+3.00\\,x_{2}=5.00,\\\\\n1.99\\,x_{2}=3.99.\n\\end{cases}\n$$\n在每次运算后进行截断，进行回代求解：\n$$\nx_{2}=\\text{chop}_{3}\\left(\\frac{3.99}{1.99}\\right)=\\text{chop}_{3}(2.005025\\ldots)=2.00.\n$$\n然后\n$$\na_{12}\\,x_{2}=\\text{chop}_{3}(3.00\\cdot 2.00)=6.00,\\quad\nb_{1}-a_{12}x_{2}=\\text{chop}_{3}(5.00-6.00)=-1.00,\n$$\n$$\nx_{1}=\\text{chop}_{3}\\left(\\frac{-1.00}{1.00}\\right)=-1.00.\n$$\n因此，在采用部分主元法的三位数截断算术下，解向量为 $x_{1}=-1.00$ 和 $x_{2}=2.00$。", "answer": "$$\\boxed{x_1 = -1.00, \\quad x_2 = 2.00}$$", "id": "2193047"}]}