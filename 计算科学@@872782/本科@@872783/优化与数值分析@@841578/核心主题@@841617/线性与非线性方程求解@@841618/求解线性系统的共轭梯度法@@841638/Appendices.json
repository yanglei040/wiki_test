{"hands_on_practices": [{"introduction": "掌握共轭梯度法这类算法的最佳途径是动手实践。我们首先从一个基础计算开始：确定第一次迭代中的最优步长 $\\alpha_0$。这个练习 [@problem_id:2210975] 将隔离出这一关键计算，让你专注于理解算法如何决定沿初始搜索方向前进的最佳距离。", "problem": "考虑线性方程组 $Ax = b$，其中 $A$ 是一个对称正定矩阵，$b$ 是一个向量。该方程组将使用共轭梯度（CG）法进行求解。具体的矩阵和向量如下所示：\n$$ A = \\begin{pmatrix} 5  1 \\\\ 1  2 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} $$\n迭代过程从初始猜测值 $x_0 = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$ 开始。在 CG 算法的第一次迭代中，解根据 $x_1 = x_0 + \\alpha_0 p_0$ 进行更新，其中 $p_0$ 是初始搜索方向，$\\alpha_0$ 是沿着搜索方向能使误差的 A-范数最小化的最优步长。\n\n你的任务是计算这第一个步长 $\\alpha_0$ 的值。请将你的答案表示为精确分数。", "solution": "对于一个对称正定矩阵 $A$，共轭梯度法从 $x_{0}$、残差 $r_{0} = b - A x_{0}$ 和初始搜索方向 $p_{0} = r_{0}$ 开始。沿着 $p_{0}$ 且能最小化误差的 A-范数的步长 $\\alpha_{0}$，可以通过最小化二次泛函 $f(x) = \\tfrac{1}{2} x^{T} A x - b^{T} x$ 在 $x(\\alpha) = x_{0} + \\alpha p_{0}$ 上的值来获得。令导数为零可得\n$$\n\\frac{d}{d\\alpha} f(x_{0} + \\alpha p_{0}) = p_{0}^{T}\\left(A(x_{0} + \\alpha p_{0}) - b\\right) = p_{0}^{T}(A x_{0} - b) + \\alpha\\, p_{0}^{T} A p_{0} = -p_{0}^{T} r_{0} + \\alpha\\, p_{0}^{T} A p_{0} = 0,\n$$\n因此\n$$\n\\alpha_{0} = \\frac{p_{0}^{T} r_{0}}{p_{0}^{T} A p_{0}}.\n$$\n根据 CG 的初始化条件 $p_{0} = r_{0}$，上式可化简为\n$$\n\\alpha_{0} = \\frac{r_{0}^{T} r_{0}}{p_{0}^{T} A p_{0}}.\n$$\n给定 $x_{0} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$，初始残差为\n$$\nr_{0} = b - A x_{0} = b = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix},\n$$\n所以 $p_{0} = r_{0} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。计算分子：\n$$\nr_{0}^{T} r_{0} = \\begin{pmatrix} 1  1 \\end{pmatrix}\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = 2.\n$$\n通过先计算 $A p_{0}$ 来计算分母：\n$$\nA p_{0} = \\begin{pmatrix} 5  1 \\\\ 1  2 \\end{pmatrix}\\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 6 \\\\ 3 \\end{pmatrix},\n$$\n然后\n$$\np_{0}^{T} A p_{0} = \\begin{pmatrix} 1  1 \\end{pmatrix}\\begin{pmatrix} 6 \\\\ 3 \\end{pmatrix} = 9.\n$$\n因此，\n$$\n\\alpha_{0} = \\frac{2}{9}.\n$$", "answer": "$$\\boxed{\\frac{2}{9}}$$", "id": "2210975"}, {"introduction": "在掌握了步长的计算后，下一个自然步骤是完成一次完整的迭代。这个练习 [@problem_id:2211037] 将各个部分组合在一起，要求你计算初始残差、设定搜索方向、确定步长并最终更新解，以得到第一个近似解 $x_1$。通过这个练习，你将完整地演练共轭梯度法单次迭代的核心流程。", "problem": "考虑求解线性方程组 $Ax = b$ 的问题，其中 $A$ 是一个对称正定矩阵。共轭梯度（CG）法是一种非常适合此类问题的迭代算法。\n\n给定由矩阵 $A$ 和向量 $b$ 定义的特定系统：\n$$\nA = \\begin{pmatrix} 2  0  0 \\\\ 0  4  0 \\\\ 0  0  5 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix}\n$$\n从初始猜测 $x_0 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$ 开始，执行一次完整的共轭梯度算法迭代，以找到下一个近似解 $x_1$。\n\n你的最终答案应该是向量 $x_1$，以其分量组成的行矩阵形式表示。", "solution": "共轭梯度（CG）法是求解线性系统 $Ax=b$ 的一种迭代算法，其中 $A$ 是对称正定矩阵。我们被要求从 $x_0 = \\mathbf{0}$ 开始，找到第一个近似解 $x_1$。\n\nCG算法第一次迭代（从 $k=0$ 到 $k=1$）的步骤如下：\n\n1.  **初始化残差：** 初始残差 $r_0$ 定义为 $r_0 = b - Ax_0$。\n2.  **初始化搜索方向：** 第一个搜索方向 $p_0$ 设置为等于初始残差，即 $p_0 = r_0$。\n3.  **计算步长：** 沿搜索方向 $p_0$ 移动的最优步长 $\\alpha_0$ 由公式 $\\alpha_0 = \\frac{r_0^T r_0}{p_0^T A p_0}$ 给出。\n4.  **更新解：** 通过从 $x_0$ 沿方向 $p_0$ 迈出一步来找到新的近似解 $x_1$：$x_1 = x_0 + \\alpha_0 p_0$。\n\n让我们将这些步骤应用于给定的问题。\n\n**第1步：初始化残差 $r_0$**\n给定 $x_0 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}$。\n残差为 $r_0 = b - Ax_0$。\n$$\nAx_0 = \\begin{pmatrix} 2  0  0 \\\\ 0  4  0 \\\\ 0  0  5 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n因此，\n$$\nr_0 = b - \\mathbf{0} = b = \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix}\n$$\n\n**第2步：初始化搜索方向 $p_0$**\n初始搜索方向设置为初始残差：\n$$\np_0 = r_0 = \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix}\n$$\n\n**第3步：计算步长 $\\alpha_0$**\n步长的计算公式为 $\\alpha_0 = \\frac{r_0^T r_0}{p_0^T A p_0}$。\n首先，我们计算分子 $r_0^T r_0$：\n$$\nr_0^T r_0 = \\begin{pmatrix} 1  2  3 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix} = (1)(1) + (2)(2) + (3)(3) = 1 + 4 + 9 = 14\n$$\n接下来，我们计算分母 $p_0^T A p_0$。由于 $p_0 = r_0$，我们需要计算 $p_0^T A p_0$。让我们先计算向量 $A p_0$：\n$$\nA p_0 = \\begin{pmatrix} 2  0  0 \\\\ 0  4  0 \\\\ 0  0  5 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix} = \\begin{pmatrix} (2)(1) \\\\ (4)(2) \\\\ (5)(3) \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ 8 \\\\ 15 \\end{pmatrix}\n$$\n现在我们可以计算点积 $p_0^T (A p_0)$：\n$$\np_0^T A p_0 = \\begin{pmatrix} 1  2  3 \\end{pmatrix} \\begin{pmatrix} 2 \\\\ 8 \\\\ 15 \\end{pmatrix} = (1)(2) + (2)(8) + (3)(15) = 2 + 16 + 45 = 63\n$$\n最后，我们计算 $\\alpha_0$：\n$$\n\\alpha_0 = \\frac{14}{63} = \\frac{2 \\times 7}{9 \\times 7} = \\frac{2}{9}\n$$\n\n**第4步：更新解以找到 $x_1$**\n更新后的解为 $x_1 = x_0 + \\alpha_0 p_0$。\n$$\nx_1 = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} + \\frac{2}{9} \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix} = \\begin{pmatrix} (2/9) \\times 1 \\\\ (2/9) \\times 2 \\\\ (2/9) \\times 3 \\end{pmatrix} = \\begin{pmatrix} 2/9 \\\\ 4/9 \\\\ 6/9 \\end{pmatrix} = \\begin{pmatrix} 2/9 \\\\ 4/9 \\\\ 2/3 \\end{pmatrix}\n$$\n因此，一次迭代后的第一个近似解为 $x_1 = \\begin{pmatrix} 2/9 \\\\ 4/9 \\\\ 2/3 \\end{pmatrix}$。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{2}{9}  \\frac{4}{9}  \\frac{2}{3} \\end{pmatrix}}$$", "id": "2211037"}, {"introduction": "为了加深理解，检验算法在理想化特殊情况下的表现是一种有效的方法。这个练习 [@problem_id:2211022] 探讨了当系数矩阵 $A$ 是单位矩阵时的情形。通过这个思想实验，你将发现共轭梯度法在这种最简单的情况下能够一步到位地找到精确解，这直观地展示了该方法的效率和内在的最优性。", "problem": "共轭梯度法（CG法）是一种迭代算法，用于数值求解形如 $A\\vec{x} = \\vec{b}$ 的线性方程组，其中 $A$ 是一个 $n \\times n$ 的对称正定矩阵，$\\vec{x}$ 是未知向量，$\\vec{b}$ 是已知向量。\n\n该算法从一个初始猜测 $\\vec{x}_0$ 开始，流程如下：\n1.  初始化残差 $\\vec{r}_0 = \\vec{b} - A\\vec{x}_0$。\n2.  初始化搜索方向 $\\vec{p}_0 = \\vec{r}_0$。\n3.  对于 $k = 0, 1, 2, \\dots$，直到解收敛：\n    a. 计算步长：$\\alpha_k = \\frac{\\vec{r}_k^T \\vec{r}_k}{\\vec{p}_k^T A \\vec{p}_k}$\n    b. 更新解：$\\vec{x}_{k+1} = \\vec{x}_k + \\alpha_k \\vec{p}_k$\n    c. 更新残差：$\\vec{r}_{k+1} = \\vec{r}_k - \\alpha_k A \\vec{p}_k$\n    d. 计算搜索方向的改进因子：$\\beta_k = \\frac{\\vec{r}_{k+1}^T \\vec{r}_{k+1}}{\\vec{r}_k^T \\vec{r}_k}$\n    e. 更新搜索方向：$\\vec{p}_{k+1} = \\vec{r}_{k+1} + \\beta_k \\vec{p}_k$\n\n考虑线性方程组 $A\\vec{x} = \\vec{b}$ 的一个特殊情况，其中 $A$ 是 $n \\times n$ 的单位矩阵 $I_n$。右端向量由 $\\vec{b} = \\vec{u}$ 给出，算法的初始猜测为 $\\vec{x}_0 = \\vec{v}$。向量 $\\vec{u}$ 和 $\\vec{v}$ 是 $\\mathbb{R}^n$ 中的不同向量。\n\n您的任务是确定 CG 算法经过一次完整迭代后解向量的状态。求出向量 $\\vec{x}_1$。用 $\\vec{u}$ 和 $\\vec{v}$ 表示您的答案。", "solution": "我们将共轭梯度算法应用于系统 $A\\vec{x}=\\vec{b}$，其中 $A=I_{n}$，$\\vec{b}=\\vec{u}$，初始猜测为 $\\vec{x}_{0}=\\vec{v}$。初始残差为\n$$\n\\vec{r}_{0}=\\vec{b}-A\\vec{x}_{0}=\\vec{u}-I_{n}\\vec{v}=\\vec{u}-\\vec{v}.\n$$\n初始搜索方向为\n$$\n\\vec{p}_{0}=\\vec{r}_{0}=\\vec{u}-\\vec{v}.\n$$\n步长为\n$$\n\\alpha_{0}=\\frac{\\vec{r}_{0}^{T}\\vec{r}_{0}}{\\vec{p}_{0}^{T}A\\vec{p}_{0}}=\\frac{\\vec{r}_{0}^{T}\\vec{r}_{0}}{\\vec{p}_{0}^{T}\\vec{p}_{0}},\n$$\n并且由于 $\\vec{p}_{0}=\\vec{r}_{0}$，可得\n$$\n\\alpha_{0}=\\frac{\\vec{r}_{0}^{T}\\vec{r}_{0}}{\\vec{r}_{0}^{T}\\vec{r}_{0}}=1.\n$$\n因此，一次迭代后更新的解为\n$$\n\\vec{x}_{1}=\\vec{x}_{0}+\\alpha_{0}\\vec{p}_{0}=\\vec{v}+1\\cdot(\\vec{u}-\\vec{v})=\\vec{u}.\n$$\n为了完整起见，残差将变为\n$$\n\\vec{r}_{1}=\\vec{r}_{0}-\\alpha_{0}A\\vec{p}_{0}=(\\vec{u}-\\vec{v})-1\\cdot(\\vec{u}-\\vec{v})=\\vec{0},\n$$\n所以该方法在一步内终止。所求向量为 $\\vec{x}_{1}=\\vec{u}$。", "answer": "$$\\boxed{\\vec{u}}$$", "id": "2211022"}]}