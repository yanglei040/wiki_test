{"hands_on_practices": [{"introduction": "Thomas算法是求解三对角系统的强大工具，但它并非万能。理解算法的局限性与其工作原理同等重要。本练习将通过识别一个会导致算法失败的特定系统，帮助你深入理解前向消元过程中的关键步骤，特别是主元为零的情况[@problem_id:2222897]。", "problem": "三对角线性方程组是一种形如 $Ax=d$ 的系统，其中矩阵 $A$ 的非零元素仅位于主对角线、其下方第一条对角线（次对角线）和其上方第一条对角线（超对角线）上。一个通用的 $n \\times n$ 三对角系统可以写成如下形式：\n$$\n\\begin{pmatrix}\nb_1  c_1   \\\\\na_2  b_2  c_2  \\\\\n \\ddots  \\ddots  \\ddots \\\\\n  a_{n-1}  b_{n-1}  c_{n-1} \\\\\n   a_n  b_n\n\\end{pmatrix}\n\\begin{pmatrix}\nx_1 \\\\ x_2 \\\\ \\vdots \\\\ x_{n-1} \\\\ x_n\n\\end{pmatrix}\n=\n\\begin{pmatrix}\nd_1 \\\\ d_2 \\\\ \\vdots \\\\ d_{n-1} \\\\ d_n\n\\end{pmatrix}\n$$\n其中未显示的元素均为零。注意，按照惯例，次对角线向量的索引从 $a_2$ 到 $a_n$，超对角线向量的索引从 $c_1$ 到 $c_{n-1}$。\n\n托马斯算法是求解此类系统的一种高效方法。该算法的第一阶段称为前向消元过程，包括为矩阵和右侧向量计算一组新的系数。该过程的递推关系为：\n$$c'_1 = \\frac{c_1}{b_1}$$\n$$d'_1 = \\frac{d_1}{b_1}$$\n对于 $i = 2, 3, \\dots, n$：\n$$m_i = b_i - a_i c'_{i-1}$$\n$$c'_i = \\frac{c_i}{m_i} \\quad (\\text{for } in)$$\n$$d'_i = \\frac{d_i - a_i d'_{i-1}}{m_i}$$\n给定以下 $3 \\times 3$ 三对角系统（由它们的矩阵 $A$ 定义），其中哪个系统会导致标准的托马斯算法失败？\n\nA. $A = \\begin{pmatrix} 4  -1  0 \\\\ -1  4  -1 \\\\ 0  -1  4 \\end{pmatrix}$\n\nB. $A = \\begin{pmatrix} 1  1  0 \\\\ 2  3  1 \\\\ 0  3  5 \\end{pmatrix}$\n\nC. $A = \\begin{pmatrix} 2  4  0 \\\\ 1  2  -3 \\\\ 0  1  1 \\end{pmatrix}$\n\nD. $A = \\begin{pmatrix} 5  -2  0 \\\\ 10  -3  1 \\\\ 0  1  2 \\end{pmatrix}$", "solution": "为了确定托马斯算法对哪个系统会失败，我们必须检查前向消元递推关系中的分母，看是否会出现除以零的情况。潜在的失败点是第一个主元 $b_1$ 和随后的主元 $m_i = b_i - a_i c'_{i-1}$。我们处理的是 $3 \\times 3$ 系统，因此需要检查 $b_1$ 和 $m_2 = b_2 - a_2 c'_{1}$。如果 $m_2$ 已经为零，我们就不需要计算 $m_3$。右侧向量 $d$ 不影响前向消元是否会因主元为零而失败，因此我们只需要考虑每个选项的矩阵 $A$。\n\n对于每个系统，向量 $a$、$b$ 和 $c$ 定义如下：\n$A = \\begin{pmatrix} b_1  c_1  0 \\\\ a_2  b_2  c_2 \\\\ 0  a_3  b_3 \\end{pmatrix}$\n\n让我们逐一分析每个选项：\n\n**选项 A：**\n矩阵为 $A = \\begin{pmatrix} 4  -1  0 \\\\ -1  4  -1 \\\\ 0  -1  4 \\end{pmatrix}$。\n系数为 $b_1=4, c_1=-1, a_2=-1, b_2=4$。\n1.  检查第一个主元：$b_1 = 4$。由于 $b_1 \\neq 0$，第一步有效。\n2.  计算 $c'_1$：$c'_1 = \\frac{c_1}{b_1} = \\frac{-1}{4}$。\n3.  计算第二个主元 $m_2$：$m_2 = b_2 - a_2 c'_{1} = 4 - (-1)\\left(\\frac{-1}{4}\\right) = 4 - \\frac{1}{4} = \\frac{15}{4}$。\n由于 $m_2 \\neq 0$，算法对该系统不会失败。\n\n**选项 B：**\n矩阵为 $A = \\begin{pmatrix} 1  1  0 \\\\ 2  3  1 \\\\ 0  3  5 \\end{pmatrix}$。\n系数为 $b_1=1, c_1=1, a_2=2, b_2=3$。\n1.  检查第一个主元：$b_1 = 1$。由于 $b_1 \\neq 0$，第一步有效。\n2.  计算 $c'_1$：$c'_1 = \\frac{c_1}{b_1} = \\frac{1}{1} = 1$。\n3.  计算第二个主元 $m_2$：$m_2 = b_2 - a_2 c'_{1} = 3 - (2)(1) = 3 - 2 = 1$。\n由于 $m_2 \\neq 0$，算法对该系统不会失败。\n\n**选项 C：**\n矩阵为 $A = \\begin{pmatrix} 2  4  0 \\\\ 1  2  -3 \\\\ 0  1  1 \\end{pmatrix}$。\n系数为 $b_1=2, c_1=4, a_2=1, b_2=2$。\n1.  检查第一个主元：$b_1 = 2$。由于 $b_1 \\neq 0$，第一步有效。\n2.  计算 $c'_1$：$c'_1 = \\frac{c_1}{b_1} = \\frac{4}{2} = 2$。\n3.  计算第二个主元 $m_2$：$m_2 = b_2 - a_2 c'_{1} = 2 - (1)(2) = 2 - 2 = 0$。\n由于 $m_2 = 0$，在计算 $c'_2$ 和 $d'_2$ 时将出现除以零的情况。因此，托马斯算法对该系统失败。\n\n**选项 D：**\n矩阵为 $A = \\begin{pmatrix} 5  -2  0 \\\\ 10  -3  1 \\\\ 0  1  2 \\end{pmatrix}$。\n系数为 $b_1=5, c_1=-2, a_2=10, b_2=-3$。\n1.  检查第一个主元：$b_1 = 5$。由于 $b_1 \\neq 0$，第一步有效。\n2.  计算 $c'_1$：$c'_1 = \\frac{c_1}{b_1} = \\frac{-2}{5}$。\n3.  计算第二个主元 $m_2$：$m_2 = b_2 - a_2 c'_{1} = -3 - (10)\\left(\\frac{-2}{5}\\right) = -3 - (-4) = 1$。\n由于 $m_2 \\neq 0$，算法对该系统不会失败。\n\n根据分析，只有选项 C 中的系统会在托马斯算法的前向消元过程中导致除以零。", "answer": "$$\\boxed{C}$$", "id": "2222897"}, {"introduction": "Thomas算法的核心在于其两阶段过程：前向消元和反向回代。在本练习中，我们将专注于第二阶段，即反向回代。通过手动完成一个已经完成前向消元步骤的系统求解，你将熟练掌握从上三角系统高效求得最终解的技巧[@problem_id:2222856]。", "problem": "在计算物理中，离散化微分方程通常会产生大型线性方程组。例如，对杆中的一维稳态热传导进行建模，可能会得到一个形式为 $A\\mathbf{x} = \\mathbf{d}$ 的三对角系统，其中 $\\mathbf{x}$ 代表杆上离散点的温度。\n\n假设这样一个 $5 \\times 5$ 的系统已经使用 Thomas 算法的向前消元阶段进行了预处理。该操作将原始系统转换为一个等价的上双对角系统 $U\\mathbf{x} = \\mathbf{y}$，形式如下：\n$$\n\\begin{pmatrix}\n1  c'_{1}  0  0  0 \\\\\n0  1  c'_{2}  0  0 \\\\\n0  0  1  c'_{3}  0 \\\\\n0  0  0  1  c'_{4} \\\\\n0  0  0  0  1\n\\end{pmatrix}\n\\begin{pmatrix}\nx_1 \\\\ x_2 \\\\ x_3 \\\\ x_4 \\\\ x_5\n\\end{pmatrix}\n=\n\\begin{pmatrix}\ny_1 \\\\ y_2 \\\\ y_3 \\\\ y_4 \\\\ y_5\n\\end{pmatrix}\n$$\n矩阵 $U$ 的非零非对角线系数如下：\n$c'_{1} = -0.5$\n$c'_{2} = 0.25$\n$c'_{3} = -0.2$\n$c'_{4} = 0.5$\n\n变换后的右端向量 $\\mathbf{y}$ 的元素为：\n$y_1 = 3.0$\n$y_2 = -1.0$\n$y_3 = 5.0$\n$y_4 = 2.0$\n$y_5 = 8.0$\n\n您的任务是通过执行回代过程来完成求解过程，以找到未知向量 $\\mathbf{x} = (x_1, x_2, x_3, x_4, x_5)^T$。计算第一个分量 $x_1$ 的值。将您的最终答案四舍五入到四位有效数字。", "solution": "对于单位对角线的上双对角系统，回代过程从最后一个方程向上进行。对于给定的系统，方程为：\n$$x_{5} = y_{5},$$\n$$x_{4} + c'_{4} x_{5} = y_{4} \\implies x_{4} = y_{4} - c'_{4} x_{5},$$\n$$x_{3} + c'_{3} x_{4} = y_{3} \\implies x_{3} = y_{3} - c'_{3} x_{4},$$\n$$x_{2} + c'_{2} x_{3} = y_{2} \\implies x_{2} = y_{2} - c'_{2} x_{3},$$\n$$x_{1} + c'_{1} x_{2} = y_{1} \\implies x_{1} = y_{1} - c'_{1} x_{2}.$$\n\n代入给定值：\n$$x_{5} = 8.0,$$\n$$x_{4} = 2.0 - (0.5)(8.0) = 2.0 - 4.0 = -2.0,$$\n$$x_{3} = 5.0 - (-0.2)(-2.0) = 5.0 - 0.4 = 4.6,$$\n$$x_{2} = -1.0 - (0.25)(4.6) = -1.0 - 1.15 = -2.15,$$\n$$x_{1} = 3.0 - (-0.5)(-2.15) = 3.0 - 1.075 = 1.925.$$\n\n将 $x_{1}$ 四舍五入到四位有效数字得到 $1.925$。", "answer": "$$\\boxed{1.925}$$", "id": "2222856"}, {"introduction": "数值算法的稳定性及其对输入的敏感性是计算科学中的一个核心问题。这个思想实验探讨了当输入向量 $\\mathbf{d}$ 中的单个元素发生微小扰动时，解向量 $\\mathbf{x}$ 会如何变化。通过追踪这种扰动在Thomas算法的前向和后向过程中的传播，你将对三对角系统解的全局依赖性有一个更深刻的认识[@problem_id:2222882]。", "problem": "考虑一个包含 $N$ 个线性方程的方程组 $A\\mathbf{x} = \\mathbf{d}$，其中 $A$ 是一个非奇异的 $N \\times N$ 三对角矩阵，由其非零对角线定义：次对角线 $a_i$ (对于 $i=2, \\dots, N$)，主对角线 $b_i$ (对于 $i=1, \\dots, N$)，以及超对角线 $c_i$ (对于 $i=1, \\dots, N-1$)。该方程组的形式为：\n$$\n\\begin{pmatrix}\nb_1  c_1   \\\\\na_2  b_2  c_2  \\\\\n a_3  b_3  c_3  \\\\\n  \\ddots  \\ddots  \\ddots \\\\\n   a_N  b_N\n\\end{pmatrix}\n\\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\\\ \\vdots \\\\ x_N \\end{pmatrix}\n=\n\\begin{pmatrix} d_1 \\\\ d_2 \\\\ d_3 \\\\ \\vdots \\\\ d_N \\end{pmatrix}\n$$\n该方程组可以使用托马斯算法（Thomas algorithm）高效求解，这是一个两阶段的过程。\n\n**第一阶段：前向消元**\n该算法首先执行一次前向扫描以消去次对角线元素。这个过程会修改超对角线系数和右端向量，产生新的值 $c'_i$ 和 $d'_i$。递推公式为：\n对于 $i = 1$:\n$$c'_1 = \\frac{c_1}{b_1} \\quad , \\quad d'_1 = \\frac{d_1}{b_1}$$\n对于 $i = 2, 3, \\dots, N-1$:\n$$c'_i = \\frac{c_i}{b_i - a_i c'_{i-1}}$$\n对于 $i = 2, 3, \\dots, N$:\n$$d'_i = \\frac{d_i - a_i d'_{i-1}}{b_i - a_i c'_{i-1}}$$\n(对于最后一步 $i=N$，$c_{N}$ 没有定义，这可以通过设置 $c'_N = 0$ 来处理)。\n\n**第二阶段：回代**\n在前向消元之后，修改后的系统是上双对角矩阵，解向量 $\\mathbf{x}$ 通过一次后向过程求得：\n$$x_N = d'_N$$\n对于 $i = N-1, N-2, \\dots, 1$:\n$$x_i = d'_i - c'_i x_{i+1}$$\n现在，假设我们有一个 $N=10$ 的系统。我们求解一次得到解 $\\mathbf{x}$。然后，我们仅对右端向量的第五个元素引入一个小的扰动，将 $d_5$ 变为 $d_5 + \\delta$，其中 $\\delta$ 是一个小的非零值。我们然后用这个新的右端向量重新求解该系统，得到一个新的解 $\\mathbf{x}_{\\text{new}}$。假设系数 $a_i, b_i, c_i$ 均不会导致除以零或其他数值不稳定性，解向量的哪些元素保证会改变（即，对于哪些索引 $i$，$x_{i, \\text{new}} \\neq x_i$）？\n\nA. 只有元素 $x_5$。\n\nB. 元素 $x_5, x_6, x_7, x_8, x_9, x_{10}$。\n\nC. 元素 $x_1, x_2, x_3, x_4, x_5$。\n\nD. 所有元素，$x_1, x_2, \\dots, x_{10}$。", "solution": "我们用 $c'_{i}$ 和 $d'_{i}$ 表示从未受扰动的右端向量 $\\mathbf{d}$ 得到的前向消元系数，用 $\\tilde{c}'_{i}$ 和 $\\tilde{d}'_{i}$ 表示仅将 $d_5$ 扰动为 $d_{5}+\\delta$ (其中 $\\delta \\neq 0$) 后得到的系数。由于 $c'_{i}$ 的公式仅涉及矩阵系数 $a_{i},b_{i},c_{i}$，\n$$\nc'_{1}=\\frac{c_{1}}{b_{1}},\\quad c'_{i}=\\frac{c_{i}}{b_{i}-a_{i}c'_{i-1}}\\quad (i=2,\\dots,N-1),\n$$\n修改后的扫描会产生相同的值：\n$$\n\\tilde{c}'_{i}=c'_{i}\\quad \\text{对所有 }i.\n$$\n对于 $d'$ 的递推关系，\n$$\nd'_{1}=\\frac{d_{1}}{b_{1}},\\quad d'_{i}=\\frac{d_{i}-a_{i}d'_{i-1}}{b_{i}-a_{i}c'_{i-1}}\\quad (i=2,\\dots,N),\n$$\n扰动只影响从索引 $i=5$ 开始的项。定义差值\n$$\n\\Delta d'_{i}:=\\tilde{d}'_{i}-d'_{i}.\n$$\n那么，利用递推的线性和 $\\tilde{d}_{i}=d_{i}$ (当 $i\\neq 5$ 时) 以及 $\\tilde{d}_{5}=d_{5}+\\delta$，我们有\n$$\n\\Delta d'_{i}=0\\quad (i=1,2,3,4),\n$$\n$$\n\\Delta d'_{5}=\\frac{\\delta}{b_{5}-a_{5}c'_{4}},\n$$\n并且对于 $i=6,\\dots,N$，\n$$\n\\Delta d'_{i}=\\frac{-a_{i}\\,\\Delta d'_{i-1}}{b_{i}-a_{i}c'_{i-1}}.\n$$\n在给定的假设下，即没有任何系数会导致除以零或数值不稳定性，所有的分母 $b_{i}-a_{i}c'_{i-1}$ 都是有限且非零的，因此 $\\Delta d'_{5}\\neq 0$。并且根据递推关系，前向扫描会对所有 $i=5,6,\\dots,N$ 产生 $\\Delta d'_{i}\\neq 0$。\n\n在回代过程中，解满足\n$$\nx_{N}=d'_{N},\\qquad x_{i}=d'_{i}-c'_{i}x_{i+1}\\quad (i=N-1,\\dots,1).\n$$\n定义解的差值 $\\Delta x_{i}:=\\tilde{x}_{i}-x_{i}$。使用 $\\tilde{c}'_{i}=c'_{i}$ 和回代递推的线性性质，可得\n$$\n\\Delta x_{N}=\\Delta d'_{N},\n$$\n$$\n\\Delta x_{i}=\\Delta d'_{i}-c'_{i}\\,\\Delta x_{i+1}\\quad (i=N-1,\\dots,1).\n$$\n由于 $\\Delta d'_{N}\\neq 0$，我们有 $\\Delta x_{N}\\neq 0$。然后，向上回代，每个 $\\Delta x_{i}$ 都依赖于 $\\Delta d'_{i}$（对于 $i\\geq 5$ 非零，对于 $i\\leq 4$ 为零）和 $\\Delta x_{i+1}$。因此，这个变化从 $x_N$ 开始，通过整个链条反向传播到 $x_1$，使得对于所有 $i=1,2,\\dots,10$，都有 $\\Delta x_{i}\\neq 0$。\n\n等价地，以矩阵形式表示，新的解是\n$$\n\\mathbf{x}_{\\text{new}}=\\mathbf{x}+\\delta\\,A^{-1}\\mathbf{e}_{5},\n$$\n所以变化量是 $A^{-1}$ 的第五列乘以 $\\delta$。对于一个在托马斯算法所用的既定假设下的非奇异三对角系统，如上所示，这种扰动通过前向消元和回代递推影响解的每一个分量。因此，所有元素 $x_{1},x_{2},\\dots,x_{10}$ 都保证会改变。\n\n因此，正确选项是 D。", "answer": "$$\\boxed{D}$$", "id": "2222882"}]}