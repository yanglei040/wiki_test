{"hands_on_practices": [{"introduction": "理论学习之后，最好的巩固方式就是动手计算。本练习将指导您完成斯蒂芬森方法的一次完整迭代。通过这个基础计算，您将熟悉该方法的具体操作步骤，为理解其收敛特性和更复杂的应用打下坚实基础。[@problem_id:2206211]", "problem": "Steffensen 方法是一种迭代过程，用于寻找函数 $g(x)$ 的不动点，即满足 $p = g(p)$ 的值 $p$。给定一个初始近似值 $x_0$，该方法会生成一个收敛于不动点的序列。产生下一个近似值 $x_1$ 的第一次迭代公式如下：\n\n$$x_1 = x_0 - \\frac{(g(x_0) - x_0)^2}{g(g(x_0)) - 2g(x_0) + x_0}$$\n\n考虑函数 $g(x) = \\exp(-x)$。从初始猜测值 $x_0 = 1$ 开始，应用一次 Steffensen 方法的迭代来求近似值 $x_1$。\n\n计算 $x_1$ 的值，并将最终答案四舍五入至五位有效数字。", "solution": "Steffensen 方法通过下式从 $x_{0}$ 更新得到 $x_{1}$：\n$$\nx_{1}=x_{0}-\\frac{(g(x_{0})-x_{0})^{2}}{g(g(x_{0}))-2g(x_{0})+x_{0}}.\n$$\n当 $g(x)=\\exp(-x)$ 且 $x_{0}=1$ 时，计算：\n$$\ng(x_{0})=\\exp(-1),\\quad g(g(x_{0}))=\\exp(-\\exp(-1)).\n$$\n因此，\n$$\nx_{1}=1-\\frac{(\\exp(-1)-1)^{2}}{\\exp(-\\exp(-1))-2\\exp(-1)+1}.\n$$\n使用恒等式 $(\\exp(-1))^{2}=\\exp(-2)$ 将分子写为：\n$$\n(\\exp(-1)-1)^{2}=(1-\\exp(-1))^{2}=1-2\\exp(-1)+\\exp(-2).\n$$\n因此，\n$$\nx_{1}=1-\\frac{1-2\\exp(-1)+\\exp(-2)}{1-2\\exp(-1)+\\exp(-\\exp(-1))}.\n$$\n现在进行数值计算（因为题目要求十进制近似值）：\n$$\n\\exp(-1)\\approx 0.3678794411714423,\\quad \\exp(-2)\\approx 0.1353352832366127,\\quad \\exp(-\\exp(-1))\\approx 0.6922006275553464.\n$$\n因此，\n$$\n\\text{分子}\\approx 1-2(0.3678794411714423)+0.1353352832366127\\approx 0.3995764008937280,\n$$\n$$\n\\text{分母}\\approx 1-2(0.3678794411714423)+0.6922006275553464\\approx 0.9564417452124617,\n$$\n$$\n\\frac{\\text{分子}}{\\text{分母}}\\approx 0.417773903,\n$$\n所以\n$$\nx_{1}\\approx 1-0.417773903\\approx 0.582226097.\n$$\n四舍五入到五位有效数字，得到 $x_{1}\\approx 0.58223$。", "answer": "$$\\boxed{0.58223}$$", "id": "2206211"}, {"introduction": "理想的数学算法在真实的计算机上运行时，会遇到有限精度算术带来的挑战。本练习探讨了一个关键的实际问题：当初始猜测值非常接近真解时，由于计算机的浮点数表示限制，斯蒂芬森方法可能会意外失效。通过分析这个假设场景，您将深入理解数值稳定性在算法设计中的重要性。[@problem_id:2206171]", "problem": "斯蒂芬森方法是一种迭代求根算法，其公式如下：\n$$x_{n+1} = x_n - \\frac{f(x_n)^2}{f(x_n+f(x_n)) - f(x_n)}$$\n其中 $x_n$ 是第 $n$ 次迭代时对根的估计值。\n\n考虑寻找函数 $f(x) = \\ln(x) - C$ 的根的任务，其中 $C > 0$ 是一个给定的正常数。计算是在一台具有有限精度算术的简化计算机上执行的。该计算机对于浮点加法具有以下特性：对于任意两个实数 $a$ 和 $b$，如果满足条件 $|b|  \\epsilon |a|$，它们的和在计算上被评估为 `fl(a+b) = a`。这里，$\\epsilon$ 是一个小的正常数，称为机器精度。\n\n这种有限精度可能导致斯蒂芬森方法在第一步（$n=0$）就失败，如果迭代公式的分母计算结果为零。假设我们从一个初始猜测值 $x_0$ 开始，它非常接近函数 $f(x)$ 的真实根 $\\alpha$。我们可以将这个初始猜测值写为 $x_0 = \\alpha + \\delta$，其中 $\\delta$ 代表一个小的偏差。\n\n确定这个偏差的临界大小 $\\delta_c > 0$，使得对于任何满足 $|\\delta|  \\delta_c$ 的初始猜测值，斯蒂芬森方法的第一步会因为上述浮点行为导致的除零错误而失败。用 $C$ 和 $\\epsilon$ 表示你的答案 $\\delta_c$。", "solution": "$f(x)=\\ln(x)-C$ 的根是满足 $\\ln(\\alpha)-C=0$ 的 $\\alpha$，因此 $\\alpha=\\exp(C)$。设初始猜测值为 $x_{0}=\\alpha+\\delta$，其中 $\\delta$ 很小。\n\n计算在 $x_{0}$ 处的函数值：\n$$\nf(x_{0})=\\ln(x_{0})-C=\\ln(\\alpha+\\delta)-C=\\ln(\\alpha)+\\ln\\left(1+\\frac{\\delta}{\\alpha}\\right)-C=\\ln\\left(1+\\frac{\\delta}{\\alpha}\\right).\n$$\n\n斯蒂芬森方法第一步的分母是 $f(x_{0}+f(x_{0}))-f(x_{0})$。根据浮点运算法则，当且仅当满足以下条件时，中间的加法 $x_{0}+f(x_{0})$ 会被计算为 $\\mathrm{fl}(x_{0}+f(x_{0}))=x_{0}$：\n$$\n|f(x_{0})|\\epsilon|x_{0}|.\n$$\n当这种情况发生时，$f(x_{0}+f(x_{0}))$ 的计算将使用舍入后的参数 $x_{0}$，得到 $f(x_{0}+f(x_{0}))=f(x_{0})$，因此分母变为零，方法在 $n=0$ 时失败。\n\n因此，失败的条件是\n$$\n\\left|\\ln\\left(1+\\frac{\\delta}{\\alpha}\\right)\\right|\\epsilon|\\alpha+\\delta|.\n$$\n对于 $|\\delta|\\ll\\alpha$（如题所述，$x_{0}$ 非常接近 $\\alpha$），我们使用一阶展开 $\\ln(1+u)=u+\\mathcal{O}(u^{2})$，其中 $u=\\delta/\\alpha$，并且 $|\\alpha+\\delta|=\\alpha+\\mathcal{O}(|\\delta|)$。在主导阶上，失败的边界满足\n$$\n\\frac{|\\delta|}{\\alpha}=\\epsilon\\,\\alpha,\n$$\n这给出了临界大小\n$$\n\\delta_{c}=\\epsilon\\,\\alpha^{2}=\\epsilon\\,\\exp(2C).\n$$\n因此，对于任何满足 $|\\delta|\\delta_{c}$ 的初始值 $x_{0}=\\alpha+\\delta$，斯蒂芬森方法的第一步会因为浮点加法将 $x_{0}+f(x_{0})$ 舍入为 $x_{0}$ 而失败。", "answer": "$$\\boxed{\\epsilon\\,\\exp(2C)}$$", "id": "2206171"}, {"introduction": "在识别出算法的潜在弱点后，下一步自然是设法改进它。本练习将引导您从分析转向综合，通过引入一个“正则化”项来增强斯蒂芬森方法的稳定性。这项实践不仅展示了如何处理数值计算中分母过小的问题，也体现了设计更稳健、更可靠算法的工程思维。[@problem_id:2206188]", "problem": "在数值分析中，Steffensen 方法是一种求根算法，它能提供二次收敛速度，且无需计算导数。对于函数 $f(x)$，寻找一个根（即满足 $f(x)=0$ 的值 $x$）的迭代公式如下：\n$$x_{n+1} = x_n - \\frac{(f(x_n))^2}{f(x_n + f(x_n)) - f(x_n)}$$\n其中 $x_n$ 是第 $n$ 次迭代时根的近似值。\n\n该方法的一个已知问题是数值不稳定性，当分母 $D_n = f(x_n + f(x_n)) - f(x_n)$ 变得非常接近零时会出现。这可能导致更新步长过大，从而引起发散。为了缓解这个问题，可以应用一种简单的正则化技术。其思想是在分母上增加一个小项，以防止分母变为零，同时该项又足够小，在迭代稳定时不会显著改变收敛性质。\n\n考虑一个改进方案，通过在不稳定的分母 $D_n$ 上加上一个与当前迭代点函数值平方成正比的正则化项来使其稳定。具体来说，新的分母由原分母加上 $\\alpha (f(x_n))^2$ 这一项构成，其中 $\\alpha$ 是一个小的、正的、无量纲常数。\n\n基于此正则化方案，确定 $x_{n+1}$ 的修正迭代公式。用 $x_n$、函数 $f$ 和常数 $\\alpha$ 来表示你关于 $x_{n+1}$ 的答案。", "solution": "从 Steffensen 的原始迭代公式开始：\n$$x_{n+1}=x_{n}-\\frac{(f(x_{n}))^{2}}{f(x_{n}+f(x_{n}))-f(x_{n})}.$$\n将原始分母定义为\n$$D_{n}=f(x_{n}+f(x_{n}))-f(x_{n}).$$\n所提出的正则化方法增加了一个与 $(f(x_{n}))^{2}$ 成正比的稳定项，比例常数为 $\\alpha0$，从而得到修正后的分母\n$$D_{n}^{\\text{reg}}=D_{n}+\\alpha\\,(f(x_{n}))^{2}=f(x_{n}+f(x_{n}))-f(x_{n})+\\alpha\\,(f(x_{n}))^{2}.$$\n将更新公式中的分母替换后，得到修正的迭代公式：\n$$x_{n+1}=x_{n}-\\frac{(f(x_{n}))^{2}}{f(x_{n}+f(x_{n}))-f(x_{n})+\\alpha\\,(f(x_{n}))^{2}}.$$\n这便按要求用 $x_{n}$、$f$ 和 $\\alpha$ 表示了 $x_{n+1}$。", "answer": "$$\\boxed{x_{n+1}=x_{n}-\\frac{(f(x_{n}))^{2}}{f(x_{n}+f(x_{n}))-f(x_{n})+\\alpha\\,(f(x_{n}))^{2}}}$$", "id": "2206188"}]}