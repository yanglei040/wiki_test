{"hands_on_practices": [{"introduction": "要解决病态系统，首先需要一种量化其“病态”程度的方法。条件数 $\\kappa(A)$ 正是为此而生的关键指标，它衡量了线性系统解对输入数据扰动的敏感度。通过这个练习 [@problem_id:2203804]，你将亲手计算一个典型病态矩阵的条件数，并理解为何无论使用何种范数，其结果都非常大，从而揭示了系统的内在不稳定性。", "problem": "在数值线性代数中，矩阵的条件数衡量了线性系统解对输入数据微小变化的敏感程度。条件数很高的系统称为病态系统。考虑一个 $2 \\times 2$ 的矩阵 $A$：\n$$\nA = \\begin{pmatrix} 1  1 \\\\ 1  1.001 \\end{pmatrix}\n$$\n条件数 $\\kappa(A)$ 的值取决于所选择的矩阵范数。对于一个非奇异矩阵 $A$，其关于范数 $\\| \\cdot \\|$ 的条件数定义为 $\\kappa(A) = \\|A\\| \\|A^{-1}\\|$。\n\n你需要使用三种不同的标准矩阵范数来计算矩阵 $A$ 的条件数，对于一个 $m \\times n$ 矩阵 $A = (a_{ij})$，这些范数定义如下：\n1.  1-范数（或最大绝对列和范数）：$\\|A\\|_1 = \\max_{1 \\le j \\le n} \\sum_{i=1}^{m} |a_{ij}|$。\n2.  ∞-范数（或最大绝对行和范数）：$\\|A\\|_\\infty = \\max_{1 \\le i \\le m} \\sum_{j=1}^{n} |a_{ij}|$。\n3.  2-范数（或谱范数）：$\\|A\\|_2 = \\sqrt{\\lambda_{\\max}(A^T A)}$，其中 $A^T$ 是 $A$ 的转置，$\\lambda_{\\max}(A^T A)$ 是矩阵 $A^T A$ 的最大特征值。\n\n计算条件数 $\\kappa_1(A)$、$\\kappa_\\infty(A)$ 和 $\\kappa_2(A)$。按顺序将 $\\kappa_1(A)$、$\\kappa_\\infty(A)$ 和 $\\kappa_2(A)$ 的三个结果表示为一行数字。所有数值必须四舍五入到五位有效数字。", "solution": "本题要求计算给定矩阵 $A$ 的条件数 $\\kappa_1(A)$、$\\kappa_\\infty(A)$ 和 $\\kappa_2(A)$。条件数的定义是 $\\kappa(A) = \\|A\\| \\|A^{-1}\\|$。\n\n首先，我们需要求矩阵 $A$ 的逆矩阵。\n给定矩阵为 $A = \\begin{pmatrix} 1  1 \\\\ 1  1.001 \\end{pmatrix}$。\n$A$ 的行列式是 $\\det(A) = (1)(1.001) - (1)(1) = 1.001 - 1 = 0.001$。\n一个通用的 $2 \\times 2$ 矩阵 $\\begin{pmatrix} a  b \\\\ c  d \\end{pmatrix}$ 的逆矩阵是 $\\frac{1}{ad-bc} \\begin{pmatrix} d  -b \\\\ -c  a \\end{pmatrix}$。\n所以，$A$ 的逆矩阵是：\n$$\nA^{-1} = \\frac{1}{0.001} \\begin{pmatrix} 1.001  -1 \\\\ -1  1 \\end{pmatrix} = 1000 \\begin{pmatrix} 1.001  -1 \\\\ -1  1 \\end{pmatrix} = \\begin{pmatrix} 1001  -1000 \\\\ -1000  1000 \\end{pmatrix}\n$$\n\n现在我们计算 $A$ 和 $A^{-1}$ 所需的范数。\n\n**第1步：计算 $\\kappa_1(A)$**\n1-范数是最大绝对列和。\n对于矩阵 $A$：\n第一列的绝对值之和为 $|1| + |1| = 2$。\n第二列的绝对值之和为 $|1| + |1.001| = 2.001$。\n所以，$\\|A\\|_1 = \\max(2, 2.001) = 2.001$。\n对于矩阵 $A^{-1}$：\n第一列的绝对值之和为 $|1001| + |-1000| = 1001 + 1000 = 2001$。\n第二列的绝对值之和为 $|-1000| + |1000| = 1000 + 1000 = 2000$。\n所以，$\\|A^{-1}\\|_1 = \\max(2001, 2000) = 2001$。\n1-范数下的条件数是：\n$$\n\\kappa_1(A) = \\|A\\|_1 \\|A^{-1}\\|_1 = 2.001 \\times 2001 = 4004.001\n$$\n\n**第2步：计算 $\\kappa_\\infty(A)$**\n∞-范数是最大绝对行和。\n对于矩阵 $A$：\n第一行的绝对值之和为 $|1| + |1| = 2$。\n第二行的绝对值之和为 $|1| + |1.001| = 2.001$。\n所以，$\\|A\\|_\\infty = \\max(2, 2.001) = 2.001$。\n对于矩阵 $A^{-1}$：\n第一行的绝对值之和为 $|1001| + |-1000| = 1001 + 1000 = 2001$。\n第二行的绝对值之和为 $|-1000| + |1000| = 1000 + 1000 = 2000$。\n所以，$\\|A^{-1}\\|_\\infty = \\max(2001, 2000) = 2001$。\n∞-范数下的条件数是：\n$$\n\\kappa_\\infty(A) = \\|A\\|_\\infty \\|A^{-1}\\|_\\infty = 2.001 \\times 2001 = 4004.001\n$$\n\n**第3步：计算 $\\kappa_2(A)$**\n2-范数条件数定义为 $\\kappa_2(A) = \\sqrt{\\frac{\\lambda_{\\max}(A^T A)}{\\lambda_{\\min}(A^T A)}}$。\n首先，我们计算矩阵 $A^T A$：\n$$\nA^T A = \\begin{pmatrix} 1  1 \\\\ 1  1.001 \\end{pmatrix} \\begin{pmatrix} 1  1 \\\\ 1  1.001 \\end{pmatrix} = \\begin{pmatrix} 2  2.001 \\\\ 2.001  2.002001 \\end{pmatrix}\n$$\n其特征方程为 $\\det(A^T A - \\lambda I) = 0$，展开后得到：\n$$\n\\lambda^2 - 4.002001\\lambda + 0.000001 = 0\n$$\n这是一个形如 $\\lambda^2 - S\\lambda + P = 0$ 的二次方程，其中 $S=4.002001$，$P=0.000001$。直接使用二次公式计算较小的根 $\\lambda_{\\min}$ 会因两个相近的数相减而导致精度损失。一个更数值稳定的方法是利用 $\\kappa_2(A)^2 = \\frac{\\lambda_{\\max}}{\\lambda_{\\min}}$。\n对于二次方程，根的比值为：\n$$\n\\frac{\\lambda_{\\max}}{\\lambda_{\\min}} = \\frac{(S + \\sqrt{S^2-4P})/2}{(S - \\sqrt{S^2-4P})/2} = \\frac{S + \\sqrt{S^2-4P}}{S - \\sqrt{S^2-4P}}\n$$\n为避免分母中的减法，我们将分子和分母同乘以 $S + \\sqrt{S^2-4P}$：\n$$\n\\frac{\\lambda_{\\max}}{\\lambda_{\\min}} = \\frac{(S + \\sqrt{S^2-4P})^2}{S^2 - (S^2-4P)} = \\frac{(S + \\sqrt{S^2-4P})^2}{4P}\n$$\n因此，条件数为：\n$$\n\\kappa_2(A) = \\sqrt{\\frac{\\lambda_{\\max}}{\\lambda_{\\min}}} = \\frac{S + \\sqrt{S^2-4P}}{2\\sqrt{P}}\n$$\n现在代入数值：\n$S = 4.002001$\n$P = 10^{-6} \\implies 2\\sqrt{P} = 0.002$\n$S^2 - 4P = (4.002001)^2 - 4 \\times 10^{-6} = 16.016012004001 - 0.000004 = 16.016008004001$\n$\\sqrt{S^2 - 4P} \\approx 4.00200050025$\n$$\n\\kappa_2(A) = \\frac{4.002001 + 4.00200050025}{0.002} = \\frac{8.00400150025}{0.002} = 4002.000750125\n$$\n\n**第4步：最终结果与四舍五入**\n计算出的值为：\n$\\kappa_1(A) = 4004.001$\n$\\kappa_\\infty(A) = 4004.001$\n$\\kappa_2(A) = 4002.00075...$\n\n四舍五入到五位有效数字：\n$\\kappa_1(A) \\approx 4004.0$\n$\\kappa_\\infty(A) \\approx 4004.0$\n$\\kappa_2(A) \\approx 4002.0$\n\n最终答案应表示为这三个数字组成的一行。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n4004.0  4004.0  4002.0\n\\end{pmatrix}\n}\n$$", "id": "2203804"}, {"introduction": "理解了如何用条件数来度量不稳定性后，下一步是亲眼见证其在实践中带来的危害。一个高的条件数意味着输入数据中微小的误差（例如测量噪声）可能会在解中被急剧放大，导致结果完全失真。这个练习 [@problem_id:2203824] 提供了一个极具冲击力的具体例子，展示了右侧向量 $b$ 的一个微小变化是如何导致解 $x$ 发生巨大改变的。", "problem": "考虑线性方程组 $A\\mathbf{x} = \\mathbf{b}$，其中矩阵 $A$ 和向量 $\\mathbf{b}$ 由下式给出：\n$$\nA = \\begin{pmatrix} 1000  999 \\\\ 999  998 \\end{pmatrix}, \\quad \\mathbf{b} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n$$\n该方程组有一个分量为整数的精确解，我们将其记为 $\\mathbf{x}_{exact}$。\n\n现在，假设由于一个小的测量或数据录入误差，右端向量被轻微扰动，成为一个新向量 $\\mathbf{b}_{pert}$：\n$$\n\\mathbf{b}_{pert} = \\begin{pmatrix} 1.001 \\\\ 1 \\end{pmatrix}\n$$\n这产生了一个新的线性方程组 $A \\mathbf{x}_{pert} = \\mathbf{b}_{pert}$，其解为 $\\mathbf{x}_{pert}$。\n\n本问题的目的是研究这个小扰动对解的影响。使用无穷范数，对于向量 $\\mathbf{v} = (v_1, v_2, \\dots, v_n)^T$ 定义为 $\\|\\mathbf{v}\\|_{\\infty} = \\max_i |v_i|$，计算解的相对误差。相对误差定义为比值 $\\frac{\\|\\mathbf{x}_{pert} - \\mathbf{x}_{exact}\\|_{\\infty}}{\\|\\mathbf{x}_{exact}\\|_{\\infty}}$。\n\n计算这个相对误差的值。将最终答案四舍五入到三位有效数字。", "solution": "我们使用矩阵的逆来精确求解这两个线性方程组。对于一个一般的 $2 \\times 2$ 矩阵 $A = \\begin{pmatrix} a  b \\\\ c  d \\end{pmatrix}$，其行列式为 $\\det(A) = ad - bc$，其逆矩阵为 $A^{-1} = \\frac{1}{\\det(A)} \\begin{pmatrix} d  -b \\\\ -c  a \\end{pmatrix}$，条件是 $\\det(A) \\neq 0$。\n\n在本题中，\n$$\nA = \\begin{pmatrix} 1000  999 \\\\ 999  998 \\end{pmatrix}, \\quad \\det(A) = 1000 \\cdot 998 - 999 \\cdot 999 = 998000 - 998001 = -1,\n$$\n所以\n$$\nA^{-1} = \\frac{1}{-1} \\begin{pmatrix} 998  -999 \\\\ -999  1000 \\end{pmatrix} = \\begin{pmatrix} -998  999 \\\\ 999  -1000 \\end{pmatrix}.\n$$\n\n精确解为\n$$\n\\mathbf{x}_{exact} = A^{-1} \\mathbf{b} = \\begin{pmatrix} -998  999 \\\\ 999  -1000 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} -998 + 999 \\\\ 999 - 1000 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}.\n$$\n因此，\n$$\n\\|\\mathbf{x}_{exact}\\|_{\\infty} = \\max\\{ |1|, |-1| \\} = 1.\n$$\n\n对于扰动后的右端向量 $\\mathbf{b}_{pert} = \\begin{pmatrix} 1.001 \\\\ 1 \\end{pmatrix}$，记 $1.001 = \\frac{1001}{1000}$。则\n$$\n\\mathbf{x}_{pert} = A^{-1} \\mathbf{b}_{pert} = \\begin{pmatrix} -998  999 \\\\ 999  -1000 \\end{pmatrix} \\begin{pmatrix} \\frac{1001}{1000} \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} -998 \\cdot \\frac{1001}{1000} + 999 \\\\ 999 \\cdot \\frac{1001}{1000} - 1000 \\end{pmatrix}.\n$$\n精确计算每个分量：\n$$\nx_{pert,1} = -\\frac{998 \\cdot 1001}{1000} + 999 = -\\frac{998998}{1000} + \\frac{999000}{1000} = \\frac{2}{1000} = \\frac{1}{500},\n$$\n$$\nx_{pert,2} = \\frac{999 \\cdot 1001}{1000} - 1000 = \\frac{999999}{1000} - \\frac{1000000}{1000} = -\\frac{1}{1000}.\n$$\n因此，\n$$\n\\mathbf{x}_{pert} = \\begin{pmatrix} \\frac{1}{500} \\\\ -\\frac{1}{1000} \\end{pmatrix}.\n$$\n\n差值为\n$$\n\\mathbf{x}_{pert} - \\mathbf{x}_{exact} = \\begin{pmatrix} \\frac{1}{500} - 1 \\\\ -\\frac{1}{1000} - (-1) \\end{pmatrix} = \\begin{pmatrix} -\\frac{499}{500} \\\\ \\frac{999}{1000} \\end{pmatrix}.\n$$\n因此，差值的无穷范数是\n$$\n\\|\\mathbf{x}_{pert} - \\mathbf{x}_{exact}\\|_{\\infty} = \\max\\left\\{ \\left|\\!-\\frac{499}{500}\\right|, \\left|\\frac{999}{1000}\\right| \\right\\} = \\max(0.998, 0.999) = \\frac{999}{1000} = 0.999.\n$$\n\n因此，相对误差为\n$$\n\\frac{\\|\\mathbf{x}_{pert} - \\mathbf{x}_{exact}\\|_{\\infty}}{\\|\\mathbf{x}_{exact}\\|_{\\infty}} = \\frac{0.999}{1} = 0.999,\n$$\n保留三位有效数字为 $0.999$。", "answer": "$$\\boxed{0.999}$$", "id": "2203824"}, {"introduction": "既然我们能够诊断病态问题并了解其危害，那么如何才能从一个病态系统中获得一个有意义的解呢？正则化是解决这一问题的核心思想，它旨在寻找一个稳定的近似解，而非精确但充满噪声的解。奇异值分解 (Singular Value Decomposition, SVD) 为此提供了一个强大的工具，它允许我们识别并“过滤掉”导致不稳定的部分。这个练习 [@problem_id:2203817] 将引导你完成一个基于 SVD 的典型正则化流程，从而获得一个可靠的解。", "problem": "在数据分析领域，如果矩阵 $A$ 是病态的，求解线性方程组 $A\\mathbf{x}=\\mathbf{b}$ 可能会遇到问题。这意味着测量向量 $\\mathbf{b}$ 中的小误差可能会导致解向量 $\\mathbf{x}$ 中出现大的、物理上无意义的误差。为了克服这个问题，通常会采用正则化过程来寻找一个稳定的近似解。\n\n考虑这样一个系统，其矩阵 $A$ 的奇异值分解（SVD）由 $A = U \\Sigma V^T$ 给出。分解的各分量和测量向量 $\\mathbf{b}$ 如下所示：\n$$ U = \\frac{1}{\\sqrt{5}}\\begin{pmatrix} 1  -2 \\\\ 2  1 \\end{pmatrix}, \\quad \\Sigma = \\begin{pmatrix} \\sqrt{50}  0 \\\\ 0  10^{-5} \\end{pmatrix}, \\quad V = \\frac{1}{\\sqrt{10}}\\begin{pmatrix} 1  -3 \\\\ 3  1 \\end{pmatrix} $$\n$$ \\mathbf{b} = \\begin{pmatrix} 5\\sqrt{5} \\\\ 0 \\end{pmatrix} $$\n一个正则化解，记为 $\\mathbf{x}_{\\text{reg}}$，通过以下三步计算得出：\n1.  首先，通过计算 $\\mathbf{b}' = U^T \\mathbf{b}$ 将测量向量 $\\mathbf{b}$ 变换到由 $U$ 定义的新基中。设 $\\mathbf{b}'$ 的分量为 $b'_1$ 和 $b'_2$。\n2.  接下来，构造一个滤波向量 $\\mathbf{w} = \\begin{pmatrix} w_1 \\\\ w_2 \\end{pmatrix}$。$\\mathbf{w}$ 的分量由以下规则确定：如果对应的奇异值 $\\sigma_i$ 大于阈值 $\\tau = 10^{-3}$，则 $w_i = \\frac{b'_i}{\\sigma_i}$。如果 $\\sigma_i$ 不大于 $\\tau$，则 $w_i = 0$。奇异值 $\\sigma_i$ 是矩阵 $\\Sigma$ 的对角线元素。\n3.  最后，使用关系式 $\\mathbf{x}_{\\text{reg}} = V\\mathbf{w}$ 将滤波向量 $\\mathbf{w}$ 变换回原始基，以找到正则化解。\n\n计算正则化解向量 $\\mathbf{x}_{\\text{reg}}$。将最终答案表示为一个 2x1 的列向量，其数值项四舍五入到三位有效数字。", "solution": "我们已知 SVD 分量 $U$、$\\Sigma$、$V$ 和向量 $\\mathbf{b}$，我们遵循规定的三步正则化过程。\n\n第1步：计算 $\\mathbf{b}' = U^{T} \\mathbf{b}$。已知\n$$\nU^{T} = \\frac{1}{\\sqrt{5}}\\begin{pmatrix} 1  2 \\\\ -2  1 \\end{pmatrix}, \\quad \\mathbf{b} = \\begin{pmatrix} 5\\sqrt{5} \\\\ 0 \\end{pmatrix},\n$$\n我们得到\n$$\n\\mathbf{b}' = \\frac{1}{\\sqrt{5}}\\begin{pmatrix} 1  2 \\\\ -2  1 \\end{pmatrix}\\begin{pmatrix} 5\\sqrt{5} \\\\ 0 \\end{pmatrix}\n= \\frac{1}{\\sqrt{5}}\\begin{pmatrix} 5\\sqrt{5} \\\\ -10\\sqrt{5} \\end{pmatrix}\n= \\begin{pmatrix} 5 \\\\ -10 \\end{pmatrix}.\n$$\n因此 $b'_{1} = 5$ 且 $b'_{2} = -10$。\n\n第2步：使用奇异值 $\\sigma_{1} = \\sqrt{50} = 5\\sqrt{2}$ 和 $\\sigma_{2} = 10^{-5}$ 以及阈值 $\\tau = 10^{-3}$，通过阈值规则构造 $\\mathbf{w}$。由于 $\\sigma_{1} > \\tau$，我们设\n$$\nw_{1} = \\frac{b'_{1}}{\\sigma_{1}} = \\frac{5}{\\sqrt{50}} = \\frac{5}{5\\sqrt{2}} = \\frac{1}{\\sqrt{2}}.\n$$\n由于 $\\sigma_{2} \\leq \\tau$，我们设 $w_{2} = 0$。因此\n$$\n\\mathbf{w} = \\begin{pmatrix} \\frac{1}{\\sqrt{2}} \\\\ 0 \\end{pmatrix}.\n$$\n\n第3步：计算 $\\mathbf{x}_{\\text{reg}} = V \\mathbf{w}$。已知\n$$\nV = \\frac{1}{\\sqrt{10}}\\begin{pmatrix} 1  -3 \\\\ 3  1 \\end{pmatrix},\n$$\n我们得到\n$$\n\\mathbf{x}_{\\text{reg}} = \\frac{1}{\\sqrt{10}}\\begin{pmatrix} 1  -3 \\\\ 3  1 \\end{pmatrix}\\begin{pmatrix} \\frac{1}{\\sqrt{2}} \\\\ 0 \\end{pmatrix}\n= \\frac{1}{\\sqrt{10}}\\begin{pmatrix} \\frac{1}{\\sqrt{2}} \\\\ \\frac{3}{\\sqrt{2}} \\end{pmatrix}\n= \\begin{pmatrix} \\frac{1}{\\sqrt{20}} \\\\ \\frac{3}{\\sqrt{20}} \\end{pmatrix}.\n$$\n数值上，使用 $\\sqrt{20} = 2\\sqrt{5}$，得到\n$$\n\\mathbf{x}_{\\text{reg}} \\approx \\begin{pmatrix} 0.2236067978 \\\\ 0.6708203933 \\end{pmatrix}.\n$$\n将每个条目四舍五入到三位有效数字，得到\n$$\n\\mathbf{x}_{\\text{reg}} \\approx \\begin{pmatrix} 0.224 \\\\ 0.671 \\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}0.224 \\\\ 0.671\\end{pmatrix}}$$", "id": "2203817"}]}