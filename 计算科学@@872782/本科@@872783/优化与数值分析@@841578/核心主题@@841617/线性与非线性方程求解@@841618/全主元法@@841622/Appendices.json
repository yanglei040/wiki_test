{"hands_on_practices": [{"introduction": "理论学习之后，最好的检验方法就是动手实践。我们从一个看似简单但暗藏玄机的线性方程组开始。这个练习将向您展示，即使是基础的高斯消元法，在遇到主对角线上为零的元素时也会束手无策，而全主元消去法是如何轻松化解这一难题的 [@problem_id:2174449]。", "problem": "一个包含两个未知数 $x_1$ 和 $x_2$ 的二元线性方程组由以下关系定义：\n$$a_{11} x_1 + a_{12} x_2 = b_1$$\n$$a_{21} x_1 + a_{22} x_2 = b_2$$\n系数的数值为 $a_{11} = 0.0$，$a_{12} = 4.8$，$a_{21} = 2.1$ 和 $a_{22} = -3.5$。右侧常数为 $b_1 = 12.0$ 和 $b_2 = 1.4$。\n\n您的任务是应用高斯消元法结合全主元策略来求解该方程组，以确定变量 $x_1$ 和 $x_2$ 的值。在确定 $x_1$ 和 $x_2$ 的值后，计算它们的和 $S = x_1 + x_2$。\n\n报告 $S$ 的值，并四舍五入到三位有效数字。", "solution": "给定线性方程组\n$$a_{11}x_{1}+a_{12}x_{2}=b_{1},\\quad a_{21}x_{1}+a_{22}x_{2}=b_{2},$$\n其数值系数为\n$$a_{11}=0,\\quad a_{12}=4.8,\\quad a_{21}=2.1,\\quad a_{22}=-3.5,\\quad b_{1}=12,\\quad b_{2}=1.4.$$\n写成矩阵形式为\n$$\\begin{pmatrix}0 & 4.8 \\\\ 2.1 & -3.5\\end{pmatrix}\\begin{pmatrix}x_{1}\\\\x_{2}\\end{pmatrix}=\\begin{pmatrix}12\\\\1.4\\end{pmatrix}.$$\n\n应用带全主元策略的高斯消元法。在初始步骤，检查系数矩阵中所有元素的绝对值以选择主元。绝对值最大的元素是位于位置 $(1,2)$ 的 $4.8$。全主元策略通过交换列将此主元移动到位置 $(1,1)$。交换第1列和第2列对应于将未知数重新排序为 $(x_{2},x_{1})$。列交换后，方程组变为\n$$\\begin{pmatrix}4.8 & 0 \\\\ -3.5 & 2.1\\end{pmatrix}\\begin{pmatrix}y_{1}\\\\y_{2}\\end{pmatrix}=\\begin{pmatrix}12\\\\1.4\\end{pmatrix},$$\n其中 $y_{1}=x_{2}$ 且 $y_{2}=x_{1}$。\n\n使用位置 $(1,1)$ 的主元 $4.8$ 继续进行消元。用于消去位置 $(2,1)$ 元素的乘数为\n$$m_{21}=\\frac{-3.5}{4.8}=-\\frac{35}{48}.$$\n通过 $R_{2}\\leftarrow R_{2}-m_{21}R_{1}$ 更新第2行。由于 $(1,2)$ 位置的元素为 $0$，所以 $(2,2)$ 位置的元素保持不变\n$$a_{22}^{(new)}=2.1=\\frac{21}{10}.$$\n右侧向量更新为\n$$b_{2}^{(new)}=1.4-\\left(-\\frac{35}{48}\\right)\\cdot 12=\\frac{7}{5}+\\frac{35}{4}=\\frac{203}{20}.$$\n\n得到的上三角方程组为\n$$4.8\\,y_{1}=12,\\qquad \\frac{21}{10}\\,y_{2}=\\frac{203}{20}.$$\n求解这些方程：\n$$y_{1}=\\frac{12}{4.8}=\\frac{120}{48}=\\frac{5}{2},\\qquad y_{2}=\\frac{\\frac{203}{20}}{\\frac{21}{10}}=\\frac{203}{42}=\\frac{29}{6}.$$\n\n回想一下 $y_{1}=x_{2}$ 和 $y_{2}=x_{1}$，因此\n$$x_{1}=\\frac{29}{6},\\qquad x_{2}=\\frac{5}{2}.$$\n它们的和是\n$$S=x_{1}+x_{2}=\\frac{29}{6}+\\frac{5}{2}=\\frac{29}{6}+\\frac{15}{6}=\\frac{44}{6}=\\frac{22}{3}.$$\n四舍五入到三位有效数字，$S=7.33$。", "answer": "$$\\boxed{7.33}$$", "id": "2174449"}, {"introduction": "理解了为何需要主元选取后，我们来精确掌握全主元法的核心操作。此练习要求您识别出在全主元消去法的第一步中，将矩阵中绝对值最大的元素移动到主元位置所需的行和列置换矩阵。这有助于您将抽象的“交换”概念转化为具体的矩阵运算 [@problem_id:2174480]。", "problem": "在对矩阵 $A$ 进行全主元高斯消去法的第一步中，会确定一个行置换矩阵 $P_1$ 和一个列置换矩阵 $Q_1$。选择这些矩阵，以使变换后矩阵 $A' = P_1 A Q_1$ 在位置 $(1,1)$ 的元素在 $A$ 的所有元素中具有最大绝对值。\n\n考虑给定的矩阵 $A$：\n$$\nA = \\begin{pmatrix}\n2 & 1 & -3 & 4 \\\\\n-5 & 6 & 1 & 0 \\\\\n3 & -2 & 8 & -1 \\\\\n-4 & 7 & -9 & 5\n\\end{pmatrix}\n$$\n\n确定在对矩阵 $A$ 执行全主元高斯消去法第一步时所用的正确矩阵对 $(P_1, Q_1)$。从以下选项中选择有效的一项。\n\nA. $P_1 = \\begin{pmatrix} 0 & 1 & 0 & 0 \\\\ 1 & 0 & 0 & 0 \\\\ 0 & 0 & 1 & 0 \\\\ 0 & 0 & 0 & 1 \\end{pmatrix}, \\quad Q_1 = \\begin{pmatrix} 1 & 0 & 0 & 0 \\\\ 0 & 1 & 0 & 0 \\\\ 0 & 0 & 1 & 0 \\\\ 0 & 0 & 0 & 1 \\end{pmatrix}$\n\nB. $P_1 = \\begin{pmatrix} 0 & 0 & 1 & 0 \\\\ 0 & 1 & 0 & 0 \\\\ 1 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 1 \\end{pmatrix}, \\quad Q_1 = \\begin{pmatrix} 0 & 0 & 0 & 1 \\\\ 0 & 1 & 0 & 0 \\\\ 0 & 0 & 1 & 0 \\\\ 1 & 0 & 0 & 0 \\end{pmatrix}$\n\nC. $P_1 = \\begin{pmatrix} 0 & 0 & 1 & 0 \\\\ 0 & 1 & 0 & 0 \\\\ 1 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 1 \\end{pmatrix}, \\quad Q_1 = \\begin{pmatrix} 0 & 0 & 1 & 0 \\\\ 0 & 1 & 0 & 0 \\\\ 1 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 1 \\end{pmatrix}$\n\nD. $P_1 = \\begin{pmatrix} 0 & 0 & 0 & 1 \\\\ 0 & 1 & 0 & 0 \\\\ 0 & 0 & 1 & 0 \\\\ 1 & 0 & 0 & 0 \\end{pmatrix}, \\quad Q_1 = \\begin{pmatrix} 0 & 0 & 1 & 0 \\\\ 0 & 1 & 0 & 0 \\\\ 1 & 0 & 0 & 0 \\\\ 0 & 0 & 0 & 1 \\end{pmatrix}$", "solution": "在全主元高斯消去法中，第一步我们选择置换，使得整个矩阵中绝对值最大的元素成为 $A' = P_{1} A Q_{1}$ 在位置 $(1,1)$ 的主元。\n\n给定\n$$\nA=\\begin{pmatrix}\n2 & 1 & -3 & 4 \\\\\n-5 & 6 & 1 & 0 \\\\\n3 & -2 & 8 & -1 \\\\\n-4 & 7 & -9 & 5\n\\end{pmatrix},\n$$\n我们计算其元素的绝对值，发现\n$$\n\\max_{i,j} |a_{ij}| = 9 \\quad \\text{at position} \\quad (4,3) \\text{ with } a_{4,3}=-9.\n$$\n因此，我们必须进行行置换，将第 $4$ 行移至第 $1$ 行，并进行列置换，将第 $3$ 列移至第 $1$ 列。相应的置换矩阵是执行行对换 $(1\\,4)$ 和列对换 $(1\\,3)$ 的矩阵。\n\n一个交换第 $1$ 行和第 $4$ 行的置换矩阵是\n$$\nP_{1}=\\begin{pmatrix}\n0 & 0 & 0 & 1 \\\\\n0 & 1 & 0 & 0 \\\\\n0 & 0 & 1 & 0 \\\\\n1 & 0 & 0 & 0\n\\end{pmatrix},\n$$\n因为 $P_1$ 的第一行选取了 $A$ 的第四行，而其第四行选取了 $A$ 的第一行。\n\n一个交换第 $1$ 列和第 $3$ 列的置换矩阵是\n$$\nQ_{1}=\\begin{pmatrix}\n0 & 0 & 1 & 0 \\\\\n0 & 1 & 0 & 0 \\\\\n1 & 0 & 0 & 0 \\\\\n0 & 0 & 0 & 1\n\\end{pmatrix},\n$$\n因为右乘 $Q_1$ 会将第一列替换为原来的第三列，并将第三列替换为原来的第一列。\n\n有了这两个矩阵，变换后的矩阵满足\n$$\nA'_{1,1}=(P_{1} A Q_{1})_{1,1}=a_{4,3}=-9,\n$$\n该值在 $A$ 的所有元素中具有最大的绝对值。在所提供的选项中，这对矩阵与选项 D 匹配。其他选项要么没有将绝对值最大的元素移到位置 $(1,1)$，要么将一个不同的元素移到了该位置（例如，选项 C 得到 $A'_{1,1}=a_{3,3}=8$，其绝对值不是最大的）。", "answer": "$$\\boxed{D}$$", "id": "2174480"}, {"introduction": "全主元法为何要选择绝对值最大的元素作为主元？这是一个关乎算法稳定性的深刻问题。通过这个独特的思想实验 [@problem_id:2174438]，我们将探索一种“最小模”主元策略，并观察它在有限精度计算下如何导致灾难性的误差。这个练习将加深您对数值稳定性重要性的理解。", "problem": "在一个使用四位有效数字舍入的浮点运算环境中，一位研究人员提出了一种新的主元选择策略，用于通过高斯消元法求解线性系统 $A\\mathbf{x} = \\mathbf{b}$。该策略，我们称之为“最小绝对值全主元法”，规定在消元过程的每一步 $k$（对于 $k=1, 2, \\dots, n-1$），通过搜索整个剩余子矩阵（从 $k$ 到 $n$ 的行和列）中具有最小非零绝对值的元素来选择主元。然后通过将其所在的行和列分别与第 $k$ 行和第 $k$ 列进行交换，将该元素移动到对角线位置 $(k,k)$。\n\n要求你分析该策略对于以下 $2 \\times 2$ 系统的数值稳定性：\n$$\nA = \\begin{pmatrix} 2.000 \\times 10^{-5} & 1.000 \\\\ 1.000 & 1.000 \\end{pmatrix}, \\quad \\mathbf{b} = \\begin{pmatrix} 1.000 \\\\ 3.000 \\end{pmatrix}\n$$\n使用高斯消元法结合这种最小绝对值全主元策略，并对所有中间计算结果保留四位有效数字，求出解向量的第二个分量 $x_2$ 的值。\n\n报告你的最终答案，并四舍五入到四位有效数字。", "solution": "我们在浮点运算中进行计算，结果四舍五入到四位有效数字，并使用最小绝对值全主元法。\n\n在步骤 $k=1$ 时，剩余子矩阵是整个矩阵 $A$，其元素的绝对值为 $2.000\\times 10^{-5}$、$1.000$、$1.000$、$1.000$。最小的非零绝对值是 $2.000\\times 10^{-5}$，位于 $(1,1)$ 位置，因此不进行行或列交换。主元是 $a_{11}=2.000\\times 10^{-5}$。\n\n计算用于消去 $a_{21}$ 的乘数：\n$$\nm_{21}=\\frac{a_{21}}{a_{11}}=\\frac{1.000}{2.000\\times 10^{-5}}=5.000\\times 10^{4}\n$$\n四舍五入到四位有效数字。\n\n更新次对角线元素（以确认得到三角形式）：\n$$\na_{21}^{\\text{new}}=a_{21}-m_{21}a_{11}=1.000-(5.000\\times 10^{4})(2.000\\times 10^{-5})=1.000-1.000=0.000\n$$\n每个乘积和差都四舍五入到四位有效数字。\n\n更新尾随元素 $a_{22}$：\n$$\nm_{21}a_{12}=(5.000\\times 10^{4})(1.000)=5.000\\times 10^{4},\n$$\n$$\na_{22}^{\\text{new}}=a_{22}-m_{21}a_{12}=1.000-5.000\\times 10^{4}=-4.9999\\times 10^{4}\\;\\;\\text{(exactly }-49999\\text{),}\n$$\n四舍五入到四位有效数字为\n$$\na_{22}^{\\text{new}}=-5.000\\times 10^{4}.\n$$\n\n更新右侧向量：\n$$\nm_{21}b_{1}=(5.000\\times 10^{4})(1.000)=5.000\\times 10^{4},\n$$\n$$\nb_{2}^{\\text{new}}=b_{2}-m_{21}b_{1}=3.000-5.000\\times 10^{4}=-4.9997\\times 10^{4}\\;\\;\\text{(exactly }-49997\\text{),}\n$$\n四舍五入到四位有效数字为\n$$\nb_{2}^{\\text{new}}=-5.000\\times 10^{4}.\n$$\n\n回代求解得到\n$$\nx_{2}=\\frac{b_{2}^{\\text{new}}}{a_{22}^{\\text{new}}}=\\frac{-5.000\\times 10^{4}}{-5.000\\times 10^{4}}=1.000\n$$\n四舍五入到四位有效数字。\n\n因此，第二个分量是 $x_{2}=1.000$，保留四位有效数字。", "answer": "$$\\boxed{1.000}$$", "id": "2174438"}]}