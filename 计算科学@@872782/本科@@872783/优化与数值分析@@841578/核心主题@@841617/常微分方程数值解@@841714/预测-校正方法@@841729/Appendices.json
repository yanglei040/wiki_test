{"hands_on_practices": [{"introduction": "让我们从一个基础练习开始。本题将引导你完成欧拉预测-梯形校正法的一个完整步骤，这是最直观的预测-校正格式之一。通过完成这个计算 [@problem_id:2194236]，你将对这些方法核心的“预测-评估-校正”序列有一个具体而清晰的认识。", "problem": "考虑由常微分方程定义的初值问题：\n$$ y' = x^2 - y^2 $$\n初始条件为 $y(0) = 1$。\n\n你的任务是使用欧拉预测-梯形校正法执行单步计算，来近似 $y(0.1)$ 的值。使用步长 $h=0.1$。\n\n将最终答案保留四位有效数字。", "solution": "我们将微分方程定义为 $y' = f(x,y)$，其中 $f(x,y) = x^{2} - y^{2}$，初始条件为 $y(0) = 1$。令 $h = 0.1$, $x_{0} = 0$，以及 $x_{1} = x_{0} + h = 0.1$。\n\n欧拉预测公式为\n$$\ny_{1}^{(p)} = y_{0} + h\\,f(x_{0},y_{0}).\n$$\n计算\n$$\nf(x_{0},y_{0}) = f(0,1) = 0^{2} - 1^{2} = -1,\n$$\n所以\n$$\ny_{1}^{(p)} = 1 + 0.1(-1) = 0.9.\n$$\n\n梯形校正公式（使用预测值进行一次校正）为\n$$\ny_{1} = y_{0} + \\frac{h}{2}\\left[f(x_{0},y_{0}) + f(x_{1},y_{1}^{(p)})\\right].\n$$\n计算\n$$\nf(x_{1},y_{1}^{(p)}) = f(0.1,0.9) = (0.1)^{2} - (0.9)^{2} = 0.01 - 0.81 = -0.8.\n$$\n因此\n$$\ny_{1} = 1 + \\frac{0.1}{2}\\left[(-1) + (-0.8)\\right] = 1 + 0.05(-1.8) = 1 - 0.09 = 0.91.\n$$\n\n保留四位有效数字得到 $0.9100$。", "answer": "$$\\boxed{0.9100}$$", "id": "2194236"}, {"introduction": "现在，我们从基础的欧拉法转向一种更强大、更常用的技术。本练习将应用二阶 Adams-Bashforth 预测器和 Adams-Moulton 校正器，这种组合通常能提供更高的精度。这个实践 [@problem_id:2194669] 展示了多步法的完整工作流程，突出了如何利用先前步骤的信息来预测未来的状态。", "problem": "考虑由常微分方程 (ODE) 定义的初值问题：\n$$y'(t) = t + \\cos(y(t))$$\n已知两点处的函数值：$y(0) = 0$ 和 $y(0.1) = 0.0525$。常微分方程中的所有三角函数均以弧度为单位进行计算。\n\n使用步长 $h=0.1$，应用一次预测-校正方法的迭代，求出 $y(0.2)$ 的近似值。该方法包括作为预测部分的二阶 Adams-Bashforth 方法和作为校正部分的二阶 Adams-Moulton 方法。\n\n报告 $y(0.2)$ 的最终校正值。将您的最终答案四舍五入到四位有效数字。", "solution": "目标是使用预测-校正方法的一步迭代来求 $y(0.2)$ 的近似值。我们已知常微分方程 $y'(t) = f(t, y) = t + \\cos(y)$，步长 $h=0.1$，以及两个初始点。\n\n我们记 $t_n = n h$ 和 $y_n \\approx y(t_n)$。\n我们已知：\n- $t_0 = 0$, $y_0 = y(0) = 0$\n- $t_1 = 0.1$, $y_1 = y(0.1) = 0.0525$\n- 步长 $h = 0.1$\n\n我们要求解 $y_2 \\approx y(0.2)$。这个过程包含一个预测步骤和一个校正步骤。\n\n预测部分是二阶 Adams-Bashforth (AB2) 方法：\n$$y_{i+1}^* = y_i + \\frac{h}{2} \\left[ 3 f(t_i, y_i) - f(t_{i-1}, y_{i-1}) \\right]$$\n校正部分是二阶 Adams-Moulton (AM2) 方法：\n$$y_{i+1} = y_i + \\frac{h}{2} \\left[ f(t_{i+1}, y_{i+1}^*) + f(t_i, y_i) \\right]$$\n\n我们需要计算 $y_2$，因此在这些公式中令 $i=1$。\n\n**步骤 1：在已知点处计算函数 $f(t,y)$ 的值。**\n我们需要计算 $f_0 = f(t_0, y_0)$ 和 $f_1 = f(t_1, y_1)$。\n$$f_0 = f(0, 0) = 0 + \\cos(0) = 1$$\n$$f_1 = f(0.1, 0.0525) = 0.1 + \\cos(0.0525)$$\n使用计算器（弧度模式），我们得到：\n$$\\cos(0.0525) \\approx 0.99862215$$\n$$f_1 \\approx 0.1 + 0.99862215 = 1.09862215$$\n\n**步骤 2：应用预测部分 (AB2) 来求得 $y_2^*$。**\n我们使用 $i=1$ 时的 AB2 公式：\n$$y_2^* = y_1 + \\frac{h}{2} (3f_1 - f_0)$$\n代入已知值：\n$$y_2^* = 0.0525 + \\frac{0.1}{2} (3 \\times 1.09862215 - 1)$$\n$$y_2^* = 0.0525 + 0.05 (3.29586645 - 1)$$\n$$y_2^* = 0.0525 + 0.05 (2.29586645)$$\n$$y_2^* = 0.0525 + 0.11479332$$\n$$y_2^* \\approx 0.16729332$$\n\n**步骤 3：应用校正部分 (AM2) 来求得 $y_2$。**\n首先，我们必须在新点 $(t_2, y_2^*)$ 处计算 $f$ 的值，其中 $t_2 = t_1 + h = 0.1 + 0.1 = 0.2$。我们称这个值为 $f_2^*$。\n$$f_2^* = f(t_2, y_2^*) = f(0.2, 0.16729332)$$\n$$f_2^* = 0.2 + \\cos(0.16729332)$$\n使用计算器（弧度模式）：\n$$\\cos(0.16729332) \\approx 0.98595001$$\n$$f_2^* \\approx 0.2 + 0.98595001 = 1.18595001$$\n\n现在，我们使用 $i=1$ 时的 AM2 公式：\n$$y_2 = y_1 + \\frac{h}{2} (f_2^* + f_1)$$\n代入数值：\n$$y_2 = 0.0525 + \\frac{0.1}{2} (1.18595001 + 1.09862215)$$\n$$y_2 = 0.0525 + 0.05 (2.28457216)$$\n$$y_2 = 0.0525 + 0.11422861$$\n$$y_2 \\approx 0.16672861$$\n\n**步骤 4：四舍五入最终答案。**\n题目要求将最终答案四舍五入到四位有效数字。\n$y_2$ 的计算值约为 $0.16672861$。\n四舍五入到四位有效数字得到 $0.1667$。", "answer": "$$\\boxed{0.1667}$$", "id": "2194669"}, {"introduction": "最后的这项实践将我们的重点从数值计算转向分析，这对任何计算科学家来说都是一项至关重要的技能。你将不再仅仅是应用一个方法，而是通过检验它在物理系统中如何处理守恒量（能量），来研究其基本属性 [@problem_id:2194239]。推导出数值能量如何随步长变化，将为你深入理解积分格式的长期准确性和稳定性提供深刻的洞见。", "problem": "在计算物理中，对任何数值积分算法的一个关键测试是其遵循其所模拟的连续物理系统守恒定律的能力。考虑物理学中的一个基本模型——简谐振子，它由二阶微分方程 $\\frac{d^2x}{dt^2} = -x$ 描述。这可以表示为一个由两个一阶常微分方程组成的方程组：\n$$\n\\frac{dx}{dt} = v\n$$\n$$\n\\frac{dv}{dt} = -x\n$$\n其中 $x$ 是位置，$v$ 是速度。对于这个连续系统，总能量定义为 $E = \\frac{1}{2}(v^2 + x^2)$，它是一个守恒量。\n\n我们希望研究一种特定的数值方法——欧拉-梯形预测-校正方法的能量守恒性质。为了将解从时间 $t_n$推进到 $t_{n+1} = t_n + h$（其中 $h$ 是步长），该方法分两个阶段进行：\n\n1.  **预测步**：首先，使用一个从状态 $(x_n, v_n)$ 开始的前向欧拉步来计算一个中间的预测状态 $(\\tilde{x}_{n+1}, \\tilde{v}_{n+1})$：\n    $$\n    \\tilde{x}_{n+1} = x_n + h \\cdot v_n\n    $$\n    $$\n    \\tilde{v}_{n+1} = v_n + h \\cdot (-x_n)\n    $$\n2.  **校正步**：然后，通过应用梯形法则来计算最终状态 $(x_{n+1}, v_{n+1})$，该法则对步长开始时的导数 $(v_n, -x_n)$ 和预测的步长结束时的导数 $(\\tilde{v}_{n+1}, -\\tilde{x}_{n+1})$ 进行平均：\n    $$\n    x_{n+1} = x_n + \\frac{h}{2}(v_n + \\tilde{v}_{n+1})\n    $$\n    $$\n    v_{n+1} = v_n + \\frac{h}{2}(-x_n - \\tilde{x}_{n+1})\n    $$\n\n设 $E_n = \\frac{1}{2}(v_n^2 + x_n^2)$ 为系统在第 $n$ 步的数值能量。在使用步长为 $h$ 的这种预测-校正方法进行单步计算后，能量将变为 $E_{n+1} = \\frac{1}{2}(v_{n+1}^2 + x_{n+1}^2)$。\n\n假设初始状态 $(x_n, v_n)$ 不是原点，求一步之后的能量与初始能量之比 $E_{n+1}/E_n$ 作为步长 $h$ 的函数。", "solution": "我们从给定的系统 $x' = v$, $v' = -x$ 的预测-校正格式开始。\n\n预测步：\n$$\n\\tilde{x}_{n+1} = x_{n} + h v_{n}, \\qquad \\tilde{v}_{n+1} = v_{n} - h x_{n}.\n$$\n\n校正步：\n$$\nx_{n+1} = x_{n} + \\frac{h}{2}\\left(v_{n} + \\tilde{v}_{n+1}\\right), \\qquad v_{n+1} = v_{n} + \\frac{h}{2}\\left(-x_{n} - \\tilde{x}_{n+1}\\right).\n$$\n将预测值代入校正步，得到\n$$\nx_{n+1} = x_{n} + \\frac{h}{2}\\left(v_{n} + v_{n} - h x_{n}\\right) = \\left(1 - \\frac{h^{2}}{2}\\right)x_{n} + h v_{n},\n$$\n$$\nv_{n+1} = v_{n} + \\frac{h}{2}\\left(-x_{n} - (x_{n} + h v_{n})\\right) = -h x_{n} + \\left(1 - \\frac{h^{2}}{2}\\right)v_{n}.\n$$\n\n因此，单步更新可以写成矩阵形式\n$$\n\\begin{pmatrix} x_{n+1} \\\\ v_{n+1} \\end{pmatrix}\n=\n\\underbrace{\\begin{pmatrix} 1 - \\frac{h^{2}}{2}  h \\\\ -h  1 - \\frac{h^{2}}{2} \\end{pmatrix}}_{M}\n\\begin{pmatrix} x_{n} \\\\ v_{n} \\end{pmatrix}.\n$$\n令 $a = 1 - \\frac{h^{2}}{2}$ 且 $b = h$。那么 $M = a I + b J$，其中\n$$\nI = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}, \\qquad J = \\begin{pmatrix} 0  1 \\\\ -1  0 \\end{pmatrix}.\n$$\n注意性质 $J^{T} = -J$ 和 $J^{2} = -I$。计算\n$$\nM^{T}M = (a I - b J)(a I + b J) = a^{2} I - b^{2} J^{2} = (a^{2} + b^{2}) I.\n$$\n对于任意状态向量 $w_{n} = \\begin{pmatrix} x_{n} \\\\ v_{n} \\end{pmatrix}$，这意味着\n$$\nx_{n+1}^{2} + v_{n+1}^{2} = \\|w_{n+1}\\|^{2} = w_{n}^{T} M^{T} M w_{n} = (a^{2} + b^{2}) \\|w_{n}\\|^{2} = (a^{2} + b^{2})(x_{n}^{2} + v_{n}^{2}).\n$$\n根据 $E_{n} = \\frac{1}{2}(x_{n}^{2} + v_{n}^{2})$，我们得到\n$$\n\\frac{E_{n+1}}{E_{n}} = \\frac{\\frac{1}{2}(x_{n+1}^{2} + v_{n+1}^{2})}{\\frac{1}{2}(x_{n}^{2} + v_{n}^{2})} = a^{2} + b^{2}.\n$$\n代入 $a = 1 - \\frac{h^{2}}{2}$ 和 $b = h$，\n$$\na^{2} + b^{2} = \\left(1 - \\frac{h^{2}}{2}\\right)^{2} + h^{2} = 1 - h^{2} + \\frac{h^{4}}{4} + h^{2} = 1 + \\frac{h^{4}}{4}.\n$$\n根据假设 $(x_{n}, v_{n}) \\neq (0,0)$，该比率是良定义的，并且与具体的初始状态无关。\n\n因此，\n$$\n\\frac{E_{n+1}}{E_{n}} = 1 + \\frac{h^{4}}{4}.\n$$", "answer": "$$\\boxed{1+\\frac{h^{4}}{4}}$$", "id": "2194239"}]}