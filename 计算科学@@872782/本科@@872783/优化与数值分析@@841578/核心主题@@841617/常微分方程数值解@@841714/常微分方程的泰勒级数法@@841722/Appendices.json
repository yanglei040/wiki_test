{"hands_on_practices": [{"introduction": "理论知识是实践的基础，现在让我们通过一个具体的例子来动手应用泰勒级数法。这个练习将引导你使用二阶泰勒方法解决一个基本的初值问题。通过这个过程，你将掌握该方法的核心步骤：计算所需阶数的导数，并将其代入泰勒展开式以求得数值解，这是将理论转化为计算能力的关键一步。[@problem_id:2208091]", "problem": "考虑由常微分方程给出的初值问题（IVP）：\n$$\ny'(t) = t^2 + y(t)\n$$\n其初始条件为 $y(0) = 1$。\n\n你的任务是近似求解在 $t=0.2$ 时的解 $y(t)$ 的值。为此，请使用步长为 $h=0.2$ 的单步二阶泰勒级数法。\n\n将你的最终答案表示为一个保留三位有效数字的数值。", "solution": "我们对常微分方程 $y'(t)=f(t,y)$ 应用二阶泰勒级数法，其中 $f(t,y)=t^{2}+y$。该方法使用\n$$\ny(t_{0}+h)\\approx y(t_{0})+h\\,y'(t_{0})+\\frac{h^{2}}{2}\\,y''(t_{0}).\n$$\n这里 $t_{0}=0$，$y(0)=1$，$h=0.2$。首先计算 $y'(t_{0})=f(t_{0},y_{0})=0^{2}+1=1$。接下来，通过将常微分方程沿解对 $t$ 求导来计算 $y''(t)$：\n$$\ny''(t)=\\frac{d}{dt}(t^{2}+y)=2t+y' = 2t + t^{2}+y.\n$$\n在点 $(t_{0},y_{0})=(0,1)$ 处求值，得到 $y''(0)=2\\cdot 0+0^{2}+1=1$。代入泰勒公式：\n$$\ny(0.2)\\approx 1 + 0.2\\cdot 1 + \\frac{0.2^{2}}{2}\\cdot 1 = 1 + 0.2 + \\frac{0.04}{2} = 1.22.\n$$\n保留三位有效数字，近似值为 $1.22$。", "answer": "$$\\boxed{1.22}$$", "id": "2208091"}, {"introduction": "许多科学和工程领域的复杂系统，例如天体运动或化学反应网络，都是通过常微分方程组来描述的。本练习旨在将泰勒方法从单个方程的应用扩展到方程组，你将学习如何对系统中的每个变量分别进行泰勒展开，从而同步求解。这项实践不仅能加深你对方法本身的理解，还能让你体会到它在解决多维问题时的强大功能。[@problem_id:2208129]", "problem": "考虑以下由一个二元一阶常微分方程组定义的初值问题：\n$$\n\\begin{cases}\nx'(t) = x(t) - y(t) \\\\\ny'(t) = x(t) + y(t)\n\\end{cases}\n$$\n初始条件为 $x(0) = 1$ 和 $y(0) = 0$。\n\n您的任务是近似求解在 $t = 0.2$ 处的解。使用步长固定为 $h = 0.1$ 的二阶泰勒方法。这需要两步计算。\n\n给出 $x(0.2)$ 和 $y(0.2)$ 的近似数值。将您的最终答案表示为一对数，其中 $x(0.2)$ 的值在前，$y(0.2)$ 的值在后。将两个数值答案四舍五入到三位有效数字。", "solution": "我们按分量应用二阶泰勒方法。对于一个系统 $u' = f(u)$，其中 $u = (x,y)^{\\top}$，步长为 $h$，其二阶泰勒更新公式为\n$$\nu_{n+1} = u_{n} + h f(u_{n}) + \\frac{h^{2}}{2} u''(t_{n}),\n$$\n其中 $u''(t) = \\frac{d}{dt} u'(t)$。对于给定的系统，\n$$\nx' = x - y,\\quad y' = x + y.\n$$\n再次微分可得\n$$\nx'' = x' - y' = (x - y) - (x + y) = -2y,\\qquad y'' = x' + y' = (x - y) + (x + y) = 2x.\n$$\n因此泰勒更新公式为\n$$\nx_{n+1} = x_{n} + h(x_{n} - y_{n}) - \\frac{h^{2}}{2}(2 y_{n}),\\qquad\ny_{n+1} = y_{n} + h(x_{n} + y_{n}) + \\frac{h^{2}}{2}(2 x_{n}).\n$$\n当 $h = 0.1$ 且初始值为 $x_{0} = 1, y_{0} = 0$ 时：\n\n从 $t_{0} = 0$ 到 $t_{1} = 0.1$ 的步骤：\n$$\nx'_{0} = 1 - 0 = 1,\\quad y'_{0} = 1 + 0 = 1,\\quad x''_{0} = -2\\cdot 0 = 0,\\quad y''_{0} = 2\\cdot 1 = 2,\n$$\n$$\nx_{1} = 1 + 0.1\\cdot 1 + \\frac{0.1^{2}}{2}\\cdot 0 = 1.1,\\qquad\ny_{1} = 0 + 0.1\\cdot 1 + \\frac{0.1^{2}}{2}\\cdot 2 = 0.11.\n$$\n\n从 $t_{1} = 0.1$ 到 $t_{2} = 0.2$ 的步骤：\n$$\nx'_{1} = 1.1 - 0.11 = 0.99,\\quad y'_{1} = 1.1 + 0.11 = 1.21,\\quad x''_{1} = -2\\cdot 0.11 = -0.22,\\quad y''_{1} = 2\\cdot 1.1 = 2.2,\n$$\n$$\nx_{2} = 1.1 + 0.1\\cdot 0.99 + \\frac{0.1^{2}}{2}\\cdot(-0.22) = 1.1979,\\qquad\ny_{2} = 0.11 + 0.1\\cdot 1.21 + \\frac{0.1^{2}}{2}\\cdot 2.2 = 0.242.\n$$\n\n四舍五入到三位有效数字，得到 $x(0.2) \\approx 1.20$ 和 $y(0.2) \\approx 0.242$。", "answer": "$$\\boxed{\\begin{pmatrix}1.20  0.242\\end{pmatrix}}$$", "id": "2208129"}, {"introduction": "在实际的数值求解过程中，选择一个合适的步长 $h$ 至关重要。一个固定的步长可能在解变化平缓时过于保守（效率低），而在解急剧变化时又不够精确。这个练习将向你介绍一个更为高级和实用的技术：自适应步长控制。你将学习如何利用泰勒展开中的高阶项来估计局部截断误差，并基于此来动态调整步长，以在满足精度要求的同时尽可能提高计算效率。[@problem_id:2208102]", "problem": "用于常微分方程（ODE）数值求解器的自适应步长控制器，其设计目的是在每个积分区间的开始选择一个合适的步长 $h$。这一选择基于维持一个目标精度水平。\n\n考虑由以下微分方程定义的初值问题：\n$$\ny'(t) = y(t)^2 - t\n$$\n其初始条件为 $y(0) = 1$。\n\n我们将使用二阶泰勒方法来近似求解该问题。初始步长 $h_1$ 必须通过一个按如下方式运作的控制策略来确定：\n首先，建立对局部截断误差大小的估计。对于一个二阶方法，步长为 $h$ 的局部截断误差主要由一个与 $h^3$ 和解的三阶导数 $y'''(t)$ 成正比的项主导。误差估计记为 $\\text{Est}$，定义为 $\\text{Est} = \\frac{h^3}{6} |y'''(t_n)|$，其中 $(t_n, y_n)$ 是该步开始时的状态。\n\n接着，将此误差估计值设为等于一个给定的容差 $\\text{TOL}$。然后求解所得方程，以找到一个“理想”步长，根据该估计，此步长将产生一个恰好等于容差的误差。\n\n最后，为了确保稳定性并考虑到误差估计中所做的近似，这个理想步长会乘以一个安全因子 $\\rho$，以产生用于下一步的最终推荐步长。\n\n给定容差 $\\text{TOL} = 2.0 \\times 10^{-6}$ 和安全因子 $\\rho = 0.8$，计算此问题的推荐初始步长 $h_1$。将您的答案表示为一个四舍五入到三位有效数字的实数。", "solution": "问题要求我们根据一个特定的自适应步长控制算法，计算使用二阶泰勒方法求解初值问题 $y'(t) = y(t)^2 - t$，$y(0)=1$ 的初始步长 $h_1$。\n\n第一步开始时的状态是 $(t_0, y_0) = (0, 1)$。\n\n步长控制策略基于局部截断误差（LTE）。对于二阶泰勒方法，LTE 由 $\\tau = \\frac{h^3}{3!}y'''(\\xi)$ 给出，其中 $\\xi$ 在该步的区间内。问题指明，误差估计 $\\text{Est}$ 是使用区间开始点 $t_0$ 处的三阶导数值来计算的：\n$$\n\\text{Est} = \\frac{h_1^3}{6} |y'''(t_0)|\n$$\n控制策略要求将此估计值设为等于容差 $\\text{TOL}$：\n$$\n\\frac{h_1^3}{6} |y'''(t_0)| = \\text{TOL}\n$$\n首先，我们求解该方程以得到一个“理想”步长，我们称之为 $h_{\\text{ideal}}$：\n$$\nh_{\\text{ideal}}^3 = \\frac{6 \\cdot \\text{TOL}}{|y'''(t_0)|} \\implies h_{\\text{ideal}} = \\left( \\frac{6 \\cdot \\text{TOL}}{|y'''(t_0)|} \\right)^{1/3}\n$$\n最终的推荐步长 $h_1$ 是通过应用安全因子 $\\rho$ 获得的：\n$$\nh_1 = \\rho \\cdot h_{\\text{ideal}} = \\rho \\left( \\frac{6 \\cdot \\text{TOL}}{|y'''(t_0)|} \\right)^{1/3}\n$$\n要使用此公式，我们必须首先计算 $y'''(t_0)$。我们通过对给定的ODE $y' = y^2 - t$ 逐次求导并应用链式法则来做到这一点。\n\n一阶导数（给定）：\n$y'(t) = y(t)^2 - t$\n\n二阶导数：\n$y''(t) = \\frac{d}{dt}(y(t)^2 - t) = 2y(t)y'(t) - 1$\n\n三阶导数：\n$y'''(t) = \\frac{d}{dt}(2y(t)y'(t) - 1) = 2(y'(t))^2 + 2y(t)y''(t)$\n\n现在，我们在初始点 $(t_0, y_0) = (0, 1)$ 处计算这些导数的值。\n\n$y'(0) = y(0)^2 - 0 = 1^2 - 0 = 1$\n\n$y''(0) = 2y(0)y'(0) - 1 = 2(1)(1) - 1 = 1$\n\n$y'''(0) = 2(y'(0))^2 + 2y(0)y''(0) = 2(1)^2 + 2(1)(1) = 2 + 2 = 4$\n\n所以， $|y'''(0)| = 4$。\n\n现在我们可以将 $|y'''(0)|$、$\\text{TOL}$ 和 $\\rho$ 的值代入 $h_1$ 的表达式中。\n给定的值为 $\\text{TOL} = 2.0 \\times 10^{-6}$ 和 $\\rho = 0.8$。\n\n$$\nh_1 = 0.8 \\left( \\frac{6 \\cdot (2.0 \\times 10^{-6})}{4} \\right)^{1/3}\n$$\n$$\nh_1 = 0.8 \\left( \\frac{12.0 \\times 10^{-6}}{4} \\right)^{1/3}\n$$\n$$\nh_1 = 0.8 \\left( 3.0 \\times 10^{-6} \\right)^{1/3}\n$$\n我们来计算立方根：\n$$\n(3.0 \\times 10^{-6})^{1/3} = (3.0)^{1/3} \\times (10^{-6})^{1/3} = (3.0)^{1/3} \\times 10^{-2}\n$$\n使用计算器，$(3.0)^{1/3} \\approx 1.44224957$。\n所以，$(3.0 \\times 10^{-6})^{1/3} \\approx 1.44224957 \\times 10^{-2} = 0.0144224957$。\n\n最后，我们计算 $h_1$：\n$$\nh_1 \\approx 0.8 \\times 0.0144224957\n$$\n$$\nh_1 \\approx 0.011537996\n$$\n问题要求将答案四舍五入到三位有效数字。\n前三位有效数字是 1、1、5。第四位是 3，所以我们舍去。\n$$\nh_1 \\approx 0.0115\n$$", "answer": "$$\\boxed{0.0115}$$", "id": "2208102"}]}