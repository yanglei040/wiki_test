{"hands_on_practices": [{"introduction": "本次练习将引导你首次接触隐式欧拉方法的核心操作。我们将该方法应用于一个模拟 CPU 温度变化的线性常微分方程 ([@problem_id:2178316])。通过这个实践，你将学会如何构建隐式方程，并通过简单的代数变换直接求解下一时间步的数值，这是掌握该方法的基础。", "problem": "一个用于描述可变负载下中央处理器（CPU）的简化热模型由以下一阶常微分方程给出：\n$$ \\frac{dT}{dt} = -k(T - T_a) + P(t) $$\n其中，$T(t)$ 是 CPU 在时间 $t$（分钟）时的温度，单位为摄氏度（$^{\\circ}\\text{C}$），$k$ 是散热常数，$T_a$ 是恒定的环境温度，$P(t)$ 表示 CPU 活动产生的热量。\n\n假设参数如下：\n- 散热常数，$k = 0.5 \\text{ min}^{-1}$\n- 环境温度，$T_a = 25\\,^{\\circ}\\text{C}$\n- 生热函数，$P(t) = P_0 \\cos(\\omega t)$，其中 $P_0 = 10\\,^{\\circ}\\text{C}/\\text{min}$ 且 $\\omega = \\frac{\\pi}{6} \\text{ rad/min}$。\n- CPU 的初始温度为 $T(0) = 85\\,^{\\circ}\\text{C}$。\n\n为了预测温度的演变，我们采用一种数值方法。下一个时间步 $t_{n+1}$ 时的温度 $T_{n+1}$，是根据当前时间步 $t_n$ 时的温度 $T_n$ 使用以下更新规则估算得出的：\n$$ T_{n+1} = T_n + h \\left( \\frac{dT}{dt} \\right)_{t=t_{n+1}, T=T_{n+1}} $$\n其中 $h = t_{n+1} - t_n$ 是时间步长。\n\n使用该数值方法，步长 $h = 0.5$ 分钟，进行单步计算，求出 CPU 在 $t = 0.5$ 分钟时的近似温度。\n\n答案以摄氏度为单位，并四舍五入到四位有效数字。", "solution": "给定一阶常微分方程\n$$\n\\frac{dT}{dt}=-k\\left(T-T_{a}\\right)+P(t), \\quad P(t)=P_{0}\\cos(\\omega t),\n$$\n我们要应用步长为 $h$ 的隐式（向后）欧拉法，从 $t_{0}=0$ 到 $t_{1}=h$ 进行一步计算。向后欧拉法的更新公式为\n$$\nT_{1}=T_{0}+h\\left.\\frac{dT}{dt}\\right|_{t=t_{1},\\,T=T_{1}}=T_{0}+h\\big(-k(T_{1}-T_{a})+P_{0}\\cos(\\omega t_{1})\\big).\n$$\n求解这个关于 $T_{1}$ 的方程。展开右侧并合并含 $T_{1}$ 的项：\n$$\nT_{1}=T_{0}-hkT_{1}+hkT_{a}+hP_{0}\\cos(\\omega t_{1}).\n$$\n将含 $T_{1}$ 的项移到左侧：\n$$\nT_{1}+hkT_{1}=T_{0}+hkT_{a}+hP_{0}\\cos(\\omega t_{1}).\n$$\n对左侧进行因式分解，解出 $T_{1}$：\n$$\nT_{1}=\\frac{T_{0}+hkT_{a}+hP_{0}\\cos(\\omega t_{1})}{1+hk}.\n$$\n现在代入给定数据 $T_{0}=85\\,^{\\circ}\\text{C}$，$k=0.5 \\text{ min}^{-1}$，$T_{a}=25\\,^{\\circ}\\text{C}$，$P_{0}=10\\,^{\\circ}\\text{C}/\\text{min}$，$\\omega=\\frac{\\pi}{6} \\text{ rad/min}$，$h=0.5$ 分钟 以及 $t_{1}=0.5$ 分钟：\n$$\n1+hk=1+0.5\\times 0.5=1.25,\n$$\n$$\nhkT_{a}=0.5\\times 0.5\\times 25=6.25,\n$$\n$$\nhP_{0}\\cos(\\omega t_{1})=0.5\\times 10\\times \\cos\\!\\left(\\frac{\\pi}{6}\\times 0.5\\right)=5\\cos\\!\\left(\\frac{\\pi}{12}\\right).\n$$\n因此\n$$\nT_{1}=\\frac{85+6.25+5\\cos\\!\\left(\\frac{\\pi}{12}\\right)}{1.25}.\n$$\n使用 $\\cos\\!\\left(\\frac{\\pi}{12}\\right)\\approx 0.9659258263$，我们得到\n$$\nT_{1}\\approx \\frac{85+6.25+4.829629131}{1.25}=\\frac{96.079629131}{1.25}\\approx 76.86370331.\n$$\n四舍五入到四位有效数字，在 $t=0.5$ 分钟时的近似温度为 $76.86$ 摄氏度。", "answer": "$$\\boxed{76.86}$$", "id": "2178316"}, {"introduction": "在掌握了基础应用之后，我们将挑战一个源于化学动力学的非线性问题 ([@problem_id:2178299])。这个练习将向你展示，“隐式”方法并非总是需要复杂的迭代求解器。在此场景中，应用隐式欧拉法会得到一个二次方程，我们可以直接求得其解析解，从而让你更深刻地理解在每个时间步中分析和求解代数方程的重要性。", "problem": "一个化学反应器中，二级分解反应的反应物浓度 $C(t)$ 由以下微分方程控制：\n$$\n\\frac{dC}{dt} = - \\alpha C(t)^{2}\n$$\n其中 $t$ 是时间，$\\alpha$ 是一个正的反应速率常数。\n\n为了数值近似求解，一位工程师采用了一种方案，其中下一个时间步的浓度 $C_{n+1}$ 是根据当前时间步的浓度 $C_n$ 和在*下一个*时间步评估的变化率来确定的。其更新规则如下：\n$$\nC_{n+1} = C_n + h \\left( \\frac{dC}{dt} \\right)\\bigg|_{t=t_{n+1}}\n$$\n其中 $h = t_{n+1} - t_n$ 是恒定的时间步长，而 $C_n$ 是 $C(t_n)$ 的近似值。\n\n假设 $C_n$、$\\alpha$ 和 $h$ 均为正值，推导 $C_{n+1}$ 关于 $C_n$、$\\alpha$ 和 $h$ 的显式闭式表达式。", "solution": "给定自治常微分方程 $\\,\\frac{dC}{dt}=-\\alpha C^{2}\\,$（其中 $\\alpha>0$）以及在下一个时间层级评估速率的单步格式：\n$$\nC_{n+1}=C_{n}+h\\left(\\frac{dC}{dt}\\right)\\bigg|_{t=t_{n+1}}.\n$$\n由于右侧仅依赖于 $C$，我们代入 $\\left.\\frac{dC}{dt}\\right|_{t=t_{n+1}}=-\\alpha C_{n+1}^{2}$ 以获得隐式更新方程\n$$\nC_{n+1}=C_{n}-h\\,\\alpha\\,C_{n+1}^{2}.\n$$\n整理各项可得一个关于 $C_{n+1}$ 的二次方程：\n$$\nh\\,\\alpha\\,C_{n+1}^{2}+C_{n+1}-C_{n}=0.\n$$\n使用二次公式，其中 $a=h\\alpha$，$b=1$，$c=-C_{n}$，可得\n$$\nC_{n+1}=\\frac{-1\\pm\\sqrt{1-4(h\\alpha)(-C_{n})}}{2h\\alpha}\n=\\frac{-1\\pm\\sqrt{1+4\\alpha h C_{n}}}{2\\alpha h}.\n$$\n由于 $C_{n}>0$、$\\alpha>0$ 和 $h>0$，判别式 $1+4\\alpha h C_{n}>0$。分子中带负号的根为负，而平方根前带正号的根为正。为了保持 $C_{n+1}>0$，我们选择的根是\n$$\nC_{n+1}=\\frac{-1+\\sqrt{1+4\\alpha h C_{n}}}{2\\alpha h}.\n$$\n这就是 $C_{n+1}$ 关于 $C_{n}$、$\\alpha$ 和 $h$ 的显式闭式表达式。", "answer": "$$\\boxed{\\frac{-1+\\sqrt{1+4\\alpha h C_{n}}}{2\\alpha h}}$$", "id": "2178299"}, {"introduction": "现实世界中的许多问题会导出无法通过代数方法直接求解的非线性方程。本次练习 [@problem_id:2178312] 探讨了这种情况，此时通常需要使用牛顿法等迭代方法来求解每个时间步的隐式方程。你将研究该方法的一个关键失效点——奇异雅可比矩阵，并理解其发生的原因，从而对隐式方法的实际应用挑战获得宝贵的见解。", "problem": "考虑单个标量函数 $y(t)$ 的初值问题 (IVP) 的数值解：\n$$\ny'(t) = \\sqrt{y(t)}, \\quad y(0) = 0\n$$\n我们希望使用单步隐式欧拉法来近似时间 $t=h$ 处的解。隐式欧拉法的一般公式为 $y_{n+1} = y_n + h f(y_{n+1})$，其中 $h$ 是步长。对于第一步，这会产生一个关于未知值 $y_1 \\approx y(h)$ 的非线性代数方程。\n\n求解此类非线性方程的标准方法是牛顿法。为求解 $g(x)=0$ 形式的方程，牛顿法使用一种迭代格式，该格式需要计算函数 $g(x)$ 及其导数 $g'(x)$（在此一维情况下即为系统的雅可比矩阵）。如果雅可比矩阵在任何一次迭代中变为奇异（即等于零），牛顿法就会失效。\n\n确定使隐式欧拉步的牛顿法求解器所关联的雅可比矩阵变为奇异的 $y_1$ 的特定正值。将你的答案表示为步长 $h$ 的符号表达式。", "solution": "我们对初值问题 $y'(t)=\\sqrt{y(t)}$，$y(0)=0$ 应用一步隐式欧拉法。隐式欧拉法的更新公式为\n$$\ny_{1}=y_{0}+h f(y_{1})=0+h\\sqrt{y_{1}},\n$$\n这就得到了非线性方程\n$$\ng(y_{1})=y_{1}-h\\sqrt{y_{1}}=0.\n$$\n求解 $g(y)=0$ 的牛顿法使用雅可比矩阵（导数）$g'(y)$。我们计算得到\n$$\ng'(y)=\\frac{d}{dy}\\left(y-h\\sqrt{y}\\right)=1-\\frac{h}{2\\sqrt{y}},\n$$\n其定义域为 $y>0$。当 $g'(y)=0$ 时，雅可比矩阵变为奇异。因此我们求解\n$$\n1-\\frac{h}{2\\sqrt{y}}=0 \\quad \\Longrightarrow \\quad \\frac{h}{2\\sqrt{y}}=1 \\quad \\Longrightarrow \\quad 2\\sqrt{y}=h \\quad \\Longrightarrow \\quad \\sqrt{y}=\\frac{h}{2} \\quad \\Longrightarrow \\quad y=\\frac{h^{2}}{4}.\n$$\n因此，使得牛顿法的雅可比矩阵变为奇异的 $y_1$ 的特定正值为 $y_{1}=h^{2}/4$。", "answer": "$$\\boxed{\\frac{h^{2}}{4}}$$", "id": "2178312"}]}