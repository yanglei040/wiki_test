{"hands_on_practices": [{"introduction": "为了解决常微分方程，我们有多种数值方法可供选择。$\\theta$-方法是一个包含多种常用格式（如显式欧拉法和隐式欧拉法）的统一框架。通过调整参数 $\\theta$，我们可以改变方法的性质，这个练习将引导我们探索 $\\theta$ 的取值如何决定方法的 A-稳定性，从而揭示从条件稳定到无条件稳定方法的过渡。", "problem": "考虑由 $y'(t) = f(t, y(t))$ 和初始条件 $y(t_0) = y_0$ 给出的一阶常微分方程（ODE）的一般初值问题。用于近似求解此类问题的一族通用的单步数值方法是 $\\theta$-方法，其由以下递推关系定义：\n$$y_{n+1} = y_n + h \\left[ (1-\\theta)f(t_n, y_n) + \\theta f(t_{n+1}, y_{n+1}) \\right]$$\n在此，$y_n$ 是在时刻 $t_n = t_0 + nh$ 时 $y(t_n)$ 的数值近似值，$h$ 是常数步长，$\\theta$ 是在 $[0, 1]$ 范围内的参数。$\\theta$ 的不同取值会得到不同的熟知方法，例如显式欧拉法（$\\theta=0$）和隐式欧拉法（$\\theta=1$）。\n\n数值方法的一个关键性质是其稳定性。如果一个方法应用于 Dahlquist 测试方程 $y'(t) = \\lambda y(t)$（其中 $\\lambda$ 是任何实部为非正的复数，即 $\\text{Re}(\\lambda) \\le 0$）时，对于任意步长 $h  0$ 的选择，数值近似序列 $y_n$ 都是有界的，则该方法被定义为 A-稳定的。这个条件等价于要求该方法的增长因子 $R(z) = y_{n+1}/y_n$（其中 $z = h\\lambda$）对于所有实部 $\\text{Re}(z) \\le 0$ 的复数 $z$ 都满足 $|R(z)| \\le 1$。\n\n对于 $\\theta \\in [0, 1]$ 的 $\\theta$-方法族，确定能确保该方法是 A-稳定的参数 $\\theta$ 的完整取值范围。\n\nA. $\\theta \\in [0, 1/2)$\n\nB. $\\theta \\in [1/2, 1]$\n\nC. $\\theta \\in (1/2, 1]$\n\nD. $\\theta = 1/2$ only\n\nE. $\\theta = 1$ only", "solution": "将 $\\theta$-方法应用于 Dahlquist 测试方程 $y'(t)=\\lambda y(t)$，其中 $z=h\\lambda$。递推关系变为\n$$\ny_{n+1}=y_n+h\\left[(1-\\theta)\\lambda y_n+\\theta\\lambda y_{n+1}\\right].\n$$\n合并关于 $y_{n+1}$ 的项可得\n$$\n(1-\\theta z)y_{n+1}=(1+(1-\\theta)z)y_n,\n$$\n因此增长因子为\n$$\nR(z)=\\frac{y_{n+1}}{y_n}=\\frac{1+(1-\\theta)z}{1-\\theta z}.\n$$\nA-稳定性要求对于所有 $\\Re(z)\\le 0$ 的 $z$，都有 $|R(z)|\\le 1$。这等价于\n$$\n|1+(1-\\theta)z|^2\\le |1-\\theta z|^2\\quad\\text{对于所有 }z=x+\\mathrm{i}y\\text{ 且 }x\\le 0.\n$$\n令 $a=1-\\theta$ 和 $b=\\theta$。那么\n$$\n|1+az|^2=(1+ax)^2+(ay)^2=1+2ax+a^2(x^2+y^2),\n$$\n$$\n|1-bz|^2=(1-bx)^2+(by)^2=1-2bx+b^2(x^2+y^2).\n$$\n因此不等式变为\n$$\n1+2ax+a^2(x^2+y^2)\\le 1-2bx+b^2(x^2+y^2),\n$$\n化简为\n$$\n2(a+b)x\\le (b^2-a^2)(x^2+y^2).\n$$\n因为 $a+b=1$ 且 $b^2-a^2=(\\theta^2-(1-\\theta)^2)=2\\theta-1$，我们得到\n$$\n2x\\le (2\\theta-1)(x^2+y^2)\\quad\\text{对于所有 }x\\le 0,\\;y\\in\\mathbb{R}.\n$$\n设 $s=2\\theta-1$。考虑三种情况：\n\n1) 如果 $s0$（即 $\\theta\\frac{1}{2}$），那么对于任意固定的 $x0$，当 $|y|\\to\\infty$ 时，右侧的 $s(x^2+y^2)\\to -\\infty$，所以对于足够大的 $|y|$，不等式不成立。因此该方法不是 A-稳定的。\n\n2) 如果 $s=0$（即 $\\theta=\\frac{1}{2}$），不等式简化为 $2x\\le 0$，这对于所有 $x\\le 0$ 都成立。因此该方法是 A-稳定的。\n\n3) 如果 $s>0$（即 $\\theta>\\frac{1}{2}$），那么对于所有 $x\\le 0$，左侧 $2x \\le 0$，而右侧 $s(x^2+y^2)\\ge 0$。因此不等式 $2x \\le s(x^2+y^2)$ 总是成立的。因此该方法是 A-稳定的。\n\n综合以上情况，A-稳定性成立的充要条件是 $2\\theta-1\\ge 0$，即 $\\theta\\in\\left[\\frac{1}{2},1\\right]$。在给定的选项中，这对应于选项 B。", "answer": "$$\\boxed{B}$$", "id": "2151760"}, {"introduction": "在理解了如何为一族方法确定 A-稳定性之后，让我们来练习应用 A-稳定性和 L-稳定性的正式定义。这个练习提供了一个具体方法的稳定性函数 $R(z)$，并要求我们直接检验其稳定性。通过这个计算，我们可以加深对这些关键稳定性概念的理解，并熟练掌握其数学判据。", "problem": "在分析求解常微分方程（ODE）的数值方法时，方法的稳定性是一个至关重要的性质。这通常通过将方法应用于 Dahlquist 测试方程 $y' = \\lambda y$ 来研究，其中 $\\lambda$ 是一个满足 $\\text{Re}(\\lambda) \\leq 0$ 的复数。该分析引出一个稳定性函数 $R(z)$，其中 $z = h\\lambda$ 且 $h$ 是步长。$R(z)$ 的行为决定了该方法的稳定性。\n\n两个重要的稳定性是 A-稳定性和 L-稳定性：\n1.  如果一个方法的绝对稳定区域包含整个复平面的左半部分，则该方法是 **A-稳定的**。对于具有有理稳定性函数 $R(z)$ 的方法，这等价于对于所有满足 $\\text{Re}(z) \\leq 0$ 的复数 $z$，条件 $|R(z)| \\leq 1$ 成立。\n2.  如果一个方法是 A-稳定的，并且其稳定性函数还满足条件 $\\lim_{|z| \\to \\infty, \\text{Re}(z)\\le 0} R(z) = 0$，则该方法是 **L-稳定的**。\n\n考虑一个假设的单步数值方法，其稳定性函数由以下有理函数给出：\n$$\nR(z) = \\frac{1+\\frac{1}{3}z}{1-\\frac{2}{3}z}\n$$\n\n根据所提供的定义，确定此方法的稳定性。\n\nA. 该方法是 A-稳定的，但不是 L-稳定的。\n\nB. 该方法是 L-稳定的。\n\nC. 该方法不是 A-稳定的。\n\nD. 该方法既不是 A-稳定的，也不是 L-稳定的。", "solution": "给定稳定性函数\n$$\nR(z) = \\frac{1+\\frac{1}{3}z}{1-\\frac{2}{3}z}.\n$$\nA-稳定性要求绝对稳定区域\n$$\nS=\\{z\\in\\mathbb{C}:\\,|R(z)|\\leq 1\\}\n$$\n包含整个左半平面 $\\{z:\\,\\text{Re}(z)\\leq 0\\}$。我们通过求解不等式来分析 $S$\n$$\n\\left|\\frac{1+\\frac{1}{3}z}{1-\\frac{2}{3}z}\\right|\\leq 1\n\\quad\\Longleftrightarrow\\quad\n\\left|1+\\frac{1}{3}z\\right|^2\\leq\\left|1-\\frac{2}{3}z\\right|^2.\n$$\n设 $z=x+iy$，其中 $x,y\\in\\mathbb{R}$。对于实数 $\\alpha$，使用 $|1+\\alpha z|^{2}=(1+\\alpha x)^{2}+(\\alpha y)^{2}$，我们计算\n$$\n\\left|1+\\frac{1}{3}z\\right|^{2}=1+\\frac{2}{3}x+\\frac{1}{9}(x^{2}+y^{2}),\\qquad\n\\left|1-\\frac{2}{3}z\\right|^{2}=1-\\frac{4}{3}x+\\frac{4}{9}(x^{2}+y^{2}).\n$$\n因此\n$$\n1+\\frac{2}{3}x+\\frac{1}{9}(x^{2}+y^{2}) \\leq 1-\\frac{4}{3}x+\\frac{4}{9}(x^{2}+y^{2}).\n$$\n消去 $1$ 并合并项得到\n$$\n\\frac{2}{3}x+\\frac{1}{9}(x^{2}+y^{2}) \\leq -\\frac{4}{3}x+\\frac{4}{9}(x^{2}+y^{2}),\n$$\n$$\n\\frac{2}{3}x+\\frac{4}{3}x \\leq \\frac{4}{9}(x^{2}+y^{2})-\\frac{1}{9}(x^{2}+y^{2}),\n$$\n$$\n2x \\leq \\frac{1}{3}(x^{2}+y^{2}).\n$$\n两边乘以 $3$ 并重新整理得到\n$$\n6x \\leq x^{2}+y^{2}\\quad\\Longleftrightarrow\\quad x^{2}-6x+y^{2} \\geq 0.\n$$\n配方法，\n$$\n(x-3)^{2}+y^{2} \\geq 9.\n$$\n因此，绝对稳定区域 $S$ 是以 $(3,0)$ 为圆心、半径为 $3$ 的圆的外部（包括边界）。对于任何满足 $\\text{Re}(z)=x\\leq 0$ 的 $z$，我们有 $(x-3)^{2}\\geq (-3)^2 = 9$，因此 $(x-3)^{2}+y^{2}\\geq 9$，所以每个这样的 $z$ 都位于 $S$ 中。因此，整个左半平面都被包含在内，该方法是 A-稳定的。\n\n为了检查 L-稳定性，计算当 $|z|\\to\\infty$ 时 $R(z)$ 的极限。由于分子和分母的次数相等，极限是首项系数的比值：\n$$\n\\lim_{|z|\\to\\infty}R(z)=\\lim_{|z|\\to\\infty}\\frac{1/z+\\frac{1}{3}}{1/z-\\frac{2}{3}}=\\frac{1/3}{-2/3}=-\\frac{1}{2}\\neq 0.\n$$\n因此，该方法不是 L-稳定的。\n\n综合这些结果，该方法是 A-稳定的但不是 L-稳定的，这对应于选项 A。", "answer": "$$\\boxed{A}$$", "id": "2151768"}, {"introduction": "理论固然重要，但这些稳定性概念在实践中究竟意味着什么？这个练习将通过一个典型的“刚性”问题，直观地展示 A-稳定和 L-稳定方法在实际计算中的巨大差异。我们将看到，当使用较大的步长求解时，L-稳定性对于获得符合物理直觉的、快速衰减的解是多么关键。", "problem": "考虑由微分方程 $y'(t) = -1000 y(t)$ 和初始条件 $y(0) = 1$ 给出的刚性初值问题（IVP）。我们希望使用两种不同的一步隐式数值方法来近似求解。\n\n第一种方法，我们称之为方法A，由以下递推关系定义：\n$$y_{n+1} = y_n + \\frac{h}{2} (f(t_n, y_n) + f(t_{n+1}, y_{n+1}))$$\n其中 $h$ 是步长，$f(t, y) = y'(t)$。\n\n第二种方法，方法B，由以下递推关系定义：\n$$y_{n+1} = y_n + h f(t_{n+1}, y_{n+1})$$\n\n使用大小为 $h=0.1$ 的单个步长，计算在时间 $t_1 = 0.1$ 时解的第一个步长近似值 $y_1$。设方法A的结果为 $y_{1,A}$，方法B的结果为 $y_{1,B}$。\n\n将你的答案表示为包含两个值 $(y_{1,A}, y_{1,B})$ 的行矩阵。将最终答案中的两个数值都四舍五入到三位有效数字。", "solution": "给定刚性初值问题 $y'(t) = -1000\\,y(t)$，其中 $y(0)=1$，步长 $h=0.1$。令 $f(t,y)=-1000\\,y$。\n\n对于方法A（隐式梯形法则），单步更新公式为\n$$\ny_{1} = y_{0} + \\frac{h}{2}\\left(f(t_{0},y_{0}) + f(t_{1},y_{1})\\right).\n$$\n代入 $f(t,y)=-1000\\,y$ 得\n$$\ny_{1} = y_{0} + \\frac{h}{2}\\left(-1000\\,y_{0} - 1000\\,y_{1}\\right)\n= y_{0} - 500\\,h\\,(y_{0} + y_{1}).\n$$\n整理\n$$\ny_{1} + 500\\,h\\,y_{1} = y_{0} - 500\\,h\\,y_{0},\n$$\n所以\n$$\ny_{1}(1 + 500\\,h) = y_{0}(1 - 500\\,h),\n$$\n因此\n$$\ny_{1} = \\frac{1 - 500\\,h}{1 + 500\\,h}\\,y_{0}.\n$$\n当 $h=0.1$ 且 $y_{0}=1$ 时，\n$$\ny_{1,A} = \\frac{1 - 50}{1 + 50} = -\\frac{49}{51} \\approx -0.960784\\ldots,\n$$\n四舍五入到三位有效数字为 $-0.961$。\n\n对于方法B（后向欧拉法），单步更新公式为\n$$\ny_{1} = y_{0} + h\\,f(t_{1},y_{1}) = y_{0} - 1000\\,h\\,y_{1}.\n$$\n整理\n$$\ny_{1} + 1000\\,h\\,y_{1} = y_{0} \\quad \\Rightarrow \\quad y_{1}(1 + 1000\\,h) = y_{0},\n$$\n因此\n$$\ny_{1} = \\frac{y_{0}}{1 + 1000\\,h}.\n$$\n当 $h=0.1$ 且 $y_{0}=1$ 时，\n$$\ny_{1,B} = \\frac{1}{1 + 100} = \\frac{1}{101} \\approx 0.00990099\\ldots,\n$$\n四舍五入到三位有效数字为 $0.00990$。\n\n因此，所求的行矩阵为 $\\begin{pmatrix} y_{1,A}  y_{1,B} \\end{pmatrix} = \\begin{pmatrix} -0.961  0.00990 \\end{pmatrix}$。", "answer": "$$\\boxed{\\begin{pmatrix}-0.961  0.00990\\end{pmatrix}}$$", "id": "2151749"}]}