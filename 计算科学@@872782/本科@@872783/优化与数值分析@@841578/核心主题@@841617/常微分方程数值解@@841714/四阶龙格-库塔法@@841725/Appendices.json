{"hands_on_practices": [{"introduction": "掌握四阶龙格—库塔（RK4）方法的最好方式就是亲手实践。下面的练习将引导你从基础计算开始，逐步解决更复杂的问题。这个首个练习是一个直接应用RK4公式的场景，旨在帮助你理解计算四个斜率（$k_1, k_2, k_3, k_4$）并加权平均以获得最终估计值的核心机制。通过一个关于探测器温度变化的物理模型，我们可以看到RK4方法如何应用于实际工程问题中。[@problem_id:2174156]", "problem": "一个小探测器进入行星大气层时，其温度 $T$（单位为摄氏度）由一个简化的微分方程建模。其温度随时间 $t$（单位为秒）的变化率受到大气摩擦加热和辐射冷却的共同影响。其控制方程为：\n$$ \\frac{dT}{dt} = \\alpha t^{2} - \\beta T $$\n其中 $\\alpha = 0.50 \\text{ C/s}^3$ 是与摩擦加热相关的系数，$\\beta = 0.20 \\text{ s}^{-1}$ 是一个冷却常数。\n在进入的时刻，$t_0 = 0 \\text{ s}$，探测器的初始温度为 $T_0 = 100.0 \\text{ C}$。\n\n使用步长为 $h = 0.4 \\text{ s}$ 的四阶龙格-库塔（RK4）方法的单步计算，估算探测器在时间 $t_1 = 0.4 \\text{ s}$ 时的温度。将您的答案以摄氏度表示，并四舍五入到四位有效数字。", "solution": "我们给定的初值问题是 $T^{\\prime}(t)=f(t,T)=\\alpha t^{2}-\\beta T$，其中 $\\alpha=0.50$，$\\beta=0.20$，$t_{0}=0$，$T_{0}=100.0$，步长 $h=0.4$。一个单步的四阶龙格-库塔计算如下：\n$$\nT_{1}=T_{0}+\\frac{h}{6}\\left(k_{1}+2k_{2}+2k_{3}+k_{4}\\right),\n$$\n其中\n$$\nk_{1}=f(t_{0},T_{0}),\\quad\nk_{2}=f\\!\\left(t_{0}+\\frac{h}{2},\\,T_{0}+\\frac{h}{2}k_{1}\\right),\\quad\nk_{3}=f\\!\\left(t_{0}+\\frac{h}{2},\\,T_{0}+\\frac{h}{2}k_{2}\\right),\\quad\nk_{4}=f(t_{0}+h,\\,T_{0}+hk_{3}).\n$$\n\n计算每个阶段：\n$$\nk_{1}=\\alpha t_{0}^{2}-\\beta T_{0}=0.50\\cdot 0^{2}-0.20\\cdot 100.0=-20.\n$$\n$$\nt_{0}+\\frac{h}{2}=0.2,\\quad T_{0}+\\frac{h}{2}k_{1}=100.0+0.2(-20)=96.0,\n$$\n$$\nk_{2}=f(0.2,96.0)=0.50\\cdot(0.2)^{2}-0.20\\cdot 96.0=0.02-19.2=-19.18.\n$$\n$$\nt_{0}+\\frac{h}{2}=0.2,\\quad T_{0}+\\frac{h}{2}k_{2}=100.0+0.2(-19.18)=96.164,\n$$\n$$\nk_{3}=f(0.2,96.164)=0.50\\cdot(0.2)^{2}-0.20\\cdot 96.164=0.02-19.2328=-19.2128.\n$$\n$$\nt_{0}+h=0.4,\\quad T_{0}+hk_{3}=100.0+0.4(-19.2128)=92.31488,\n$$\n$$\nk_{4}=f(0.4,92.31488)=0.50\\cdot(0.4)^{2}-0.20\\cdot 92.31488=0.08-18.462976=-18.382976.\n$$\n\n综合更新：\n$$\nT_{1}=100.0+\\frac{0.4}{6}\\left((-20)+2(-19.18)+2(-19.2128)+(-18.382976)\\right).\n$$\n计算括号内的加权和：\n$$\nk_{1}+2k_{2}+2k_{3}+k_{4}=-20-38.36-38.4256-18.382976=-115.168576.\n$$\n因此，\n$$\nT_{1}=100.0+\\frac{0.4}{6}\\left(-115.168576\\right)=100.0-7.677905...=92.322094...\n$$\n四舍五入到四位有效数字，估算值为 $92.32$。", "answer": "$$\\boxed{92.32}$$", "id": "2174156"}, {"introduction": "许多物理系统，例如振子或行星轨道，都是用二阶常微分方程（ODE）来描述的。然而，RK4方法本身是为一阶ODE设计的。这个练习将向你展示一个关键技巧：如何将一个二阶ODE转化为一个由两个一阶ODE组成的系统，从而使RK4方法能够求解更高阶的问题。我们将以经典的简谐振子模型为例，来说明这一重要技术。[@problem_id:2174142]", "problem": "一个质量为 $m$ 的载荷连接到一个劲度系数为 $k$ 的理想水平弹簧上。该载荷可以在一个无摩擦的表面上自由滑动。这个简谐振子的运动由二阶常微分方程（ODE）$m \\frac{d^2x}{dt^2} + kx = 0$ 描述，其中 $x(t)$ 是载荷在时间 $t$ 时偏离其平衡位置的位移。\n\n假设载荷的质量为 $m = 2.0$ kg，弹簧的劲度系数为 $k = 8.0$ N/m。在初始时间 $t=0$ 时，载荷位于位置 $x(0) = 1.0$ m，并以初始速度 $v(0) = \\frac{dx}{dt}|_{t=0} = 2.0$ m/s 运动。\n\n使用步长为 $h = 0.1$ s 的四阶龙格－库塔方法进行单步计算，估算载荷在时间 $t = 0.1$ s 时的速度。答案以 m/s 为单位，并四舍五入到四位有效数字。", "solution": "运动方程为简谐振子常微分方程 $m \\frac{d^{2}x}{dt^{2}} + k x = 0$。引入速度 $v(t) = \\frac{dx}{dt}$，我们将其改写为一阶系统：\n$$\n\\frac{dx}{dt} = v, \\quad \\frac{dv}{dt} = -\\frac{k}{m} x.\n$$\n当 $m=2.0$ 且 $k=8.0$ 时，我们有 $\\frac{k}{m} = 4.0$，因此\n$$\n\\frac{dx}{dt} = v, \\quad \\frac{dv}{dt} = -4 x.\n$$\n令 $y = \\begin{pmatrix} x \\\\ v \\end{pmatrix}$ 且 $f(y) = \\begin{pmatrix} v \\\\ -4 x \\end{pmatrix}$。使用步长为 $h=0.1$ 的四阶龙格－库塔方法进行一步计算，从 $t=0$ 开始，初值为 $x(0)=1.0$ 和 $v(0)=2.0$，定义\n$$\nk_{1} = f(y_{0}), \\quad\nk_{2} = f\\!\\left(y_{0} + \\frac{h}{2} k_{1}\\right), \\quad\nk_{3} = f\\!\\left(y_{0} + \\frac{h}{2} k_{2}\\right), \\quad\nk_{4} = f\\!\\left(y_{0} + h k_{3}\\right),\n$$\n以及\n$$\ny_{1} = y_{0} + \\frac{h}{6}\\left(k_{1} + 2 k_{2} + 2 k_{3} + k_{4}\\right).\n$$\n按分量计算各阶段的值。在 $t_{0}=0$ 时，$x_{0}=1.0$，$v_{0}=2.0$：\n$$\nk_{1x} = v_{0} = 2.0, \\quad k_{1v} = -4 x_{0} = -4.0.\n$$\n当 $h/2 = 0.05$ 时，\n$$\nx_{0} + \\frac{h}{2} k_{1x} = 1.0 + 0.05 \\cdot 2.0 = 1.1, \\quad\nv_{0} + \\frac{h}{2} k_{1v} = 2.0 + 0.05 \\cdot (-4.0) = 1.8,\n$$\n所以\n$$\nk_{2x} = 1.8, \\quad k_{2v} = -4 \\cdot 1.1 = -4.4.\n$$\n接下来，\n$$\nx_{0} + \\frac{h}{2} k_{2x} = 1.0 + 0.05 \\cdot 1.8 = 1.09, \\quad\nv_{0} + \\frac{h}{2} k_{2v} = 2.0 + 0.05 \\cdot (-4.4) = 1.78,\n$$\n所以\n$$\nk_{3x} = 1.78, \\quad k_{3v} = -4 \\cdot 1.09 = -4.36.\n$$\n然后，\n$$\nx_{0} + h k_{3x} = 1.0 + 0.1 \\cdot 1.78 = 1.178, \\quad\nv_{0} + h k_{3v} = 2.0 + 0.1 \\cdot (-4.36) = 1.564,\n$$\n所以\n$$\nk_{4x} = 1.564, \\quad k_{4v} = -4 \\cdot 1.178 = -4.712.\n$$\n速度的更新公式为\n$$\nv_{1} = v_{0} + \\frac{h}{6}\\left(k_{1v} + 2 k_{2v} + 2 k_{3v} + k_{4v}\\right).\n$$\n计算加权和：\n$$\nk_{1v} + 2 k_{2v} + 2 k_{3v} + k_{4v} = -4.0 + 2(-4.4) + 2(-4.36) + (-4.712) = -26.232,\n$$\n因此，当 $h/6 = 0.1/6$ 时，\n$$\nv_{1} = 2.0 + \\frac{0.1}{6} \\cdot (-26.232) = 2.0 - 0.4372 = 1.5628.\n$$\n四舍五入到四位有效数字得到 $1.563$。", "answer": "$$\\boxed{1.563}$$", "id": "2174142"}, {"introduction": "在某些情况下，我们可能知道一个系统在某个未来时刻的状态，并希望推断其初始状态。这类问题被称为“终值问题”。这个练习揭示了RK4方法的灵活性，展示了如何通过使用一个负的时间步长 $h$ 来进行时间上的“向后”积分。这是一个非常巧妙的应用，它挑战我们对数值积分步骤的传统理解，并在控制理论和参数估计等领域有重要应用。[@problem_id:2174167]", "problem": "一个小型球形探测器从一艘深空探测船中被弹出。探测器内部的电子设备会产生少量但恒定的热量，同时其表面向接近绝对零度的太空真空中辐射热量。探测器的温度 $T$（单位：开尔文, K）作为时间 $t$（单位：秒, s）的函数，由以下一阶常微分方程决定：\n$$\n\\frac{dT}{dt} = - \\alpha T^{4} + \\beta\n$$\n其中，$\\alpha = 2.0 \\times 10^{-8} \\text{ K}^{-3}\\text{s}^{-1}$ 是一个与探测器的发射率和表面积相关的常数，而 $\\beta = 0.5 \\text{ K s}^{-1}$ 是由于内部生热导致的恒定温升率。\n\n在弹出后 $t_f = 2.0$ 秒时，一次远程测量确定探测器的温度为 $T(t_f) = 100.0$ K。你的任务是估计探测器在弹出时刻 $t_0 = 0.0$ 秒时的温度。\n\n使用四阶龙格-库塔方法（RK4），通过单个时间步长，计算 $T(0.0)$ 的近似值。以开尔文（K）为单位表示你的答案，并四舍五入到四位有效数字。", "solution": "该问题描述包含一个物理上的矛盾：文字描述“内部生热导致的恒定温升率”意味着 $\\beta$ 项在微分方程中应为正（代表热量增加），但原始公式可能写作了负号。为了修正这个科学上的不一致，我们将公式确定为与物理描述相符的形式：\n$$\n\\frac{dT}{dt} = f(T) = -\\alpha T^4 + \\beta\n$$\n我们给定的参数为 $\\alpha = 2.0 \\times 10^{-8} \\text{ K}^{-3}\\text{s}^{-1}$ 和 $\\beta = 0.5 \\text{ K s}^{-1}$。终值条件为 $T(t_f) = T(2.0) = 100.0$ K。我们的目标是估计初值 $T(t_0) = T(0.0)$。\n\n为此，我们使用单步四阶龙格-库塔方法进行时间上的向后积分。步长为 $h = t_0 - t_f = 0.0 - 2.0 = -2.0$ s。积分的起点是 $(t_n, T_n) = (2.0, 100.0)$。\n\nRK4 更新公式为：\n$$ T(0.0) \\approx T_n + \\frac{h}{6}(k_1 + 2k_2 + 2k_3 + k_4) $$\n\n现在，我们计算四个斜率：\n1.  **计算 $k_1$**:\n    $$ k_1 = f(T_n) = f(100.0) = -(2.0 \\times 10^{-8})(100.0)^4 + 0.5 = -2.0 + 0.5 = -1.5 $$\n2.  **计算 $k_2$**:\n    用于 $k_2$ 的中间温度是 $T_n + \\frac{h}{2}k_1 = 100.0 + \\frac{-2.0}{2}(-1.5) = 101.5$。\n    $$ k_2 = f(101.5) = -(2.0 \\times 10^{-8})(101.5)^4 + 0.5 \\approx -2.12305 + 0.5 = -1.62305 $$\n3.  **计算 $k_3$**:\n    用于 $k_3$ 的中间温度是 $T_n + \\frac{h}{2}k_2 = 100.0 + \\frac{-2.0}{2}(-1.62305) = 101.62305$。\n    $$ k_3 = f(101.62305) = -(2.0 \\times 10^{-8})(101.62305)^4 + 0.5 \\approx -2.13210 + 0.5 = -1.63210 $$\n4.  **计算 $k_4$**:\n    用于 $k_4$ 的中间温度是 $T_n + h k_3 = 100.0 + (-2.0)(-1.63210) = 103.2642$。\n    $$ k_4 = f(103.2642) = -(2.0 \\times 10^{-8})(103.2642)^4 + 0.5 \\approx -2.27507 + 0.5 = -1.77507 $$\n5.  **最终更新**:\n    $$ T(0.0) \\approx 100.0 + \\frac{-2.0}{6}(-1.5 + 2(-1.62305) + 2(-1.63210) + (-1.77507)) $$\n    $$ T(0.0) \\approx 100.0 - \\frac{1}{3}(-1.5 - 3.2461 - 3.2642 - 1.77507) $$\n    $$ T(0.0) \\approx 100.0 - \\frac{1}{3}(-9.78537) = 100.0 + 3.26179 = 103.26179 $$\n\n四舍五入到四位有效数字，我们得到 $T(0.0) \\approx 103.3$。", "answer": "$$\\boxed{103.3}$$", "id": "2174167"}]}