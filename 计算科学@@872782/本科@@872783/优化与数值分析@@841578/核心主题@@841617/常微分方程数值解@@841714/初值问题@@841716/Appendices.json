{"hands_on_practices": [{"introduction": "欧拉方法是求解初值问题的最基本数值方法，是所有更复杂方法的概念基石。这个练习提供了一个具体的、单步计算的机会，让你亲手实践如何从一个已知点出发，预测下一个点的状态。通过这个简单的计算，你将掌握数值积分的核心思想。[@problem_id:2180117]", "problem": "考虑由常微分方程 $y' = x + \\cos(\\pi y)$ 和初始条件 $y(0) = 1$ 给出的初值问题。使用单步欧拉法来近似 $y(0.1)$ 的值。", "solution": "我们使用单步欧拉法，从 $x_{0}=0$ 到 $x_{1}=0.1$，步长为 $h=0.1=\\frac{1}{10}$。欧拉法的更新公式为\n$$\ny_{1}=y_{0}+h\\,f(x_{0},y_{0}),\n$$\n其中 $f(x,y)=x+\\cos(\\pi y)$。根据在 $x_{0}=0$ 处的初始条件 $y_{0}=1$，我们计算\n$$\nf(0,1)=0+\\cos(\\pi\\cdot 1)=\\cos(\\pi)=-1.\n$$\n因此，\n$$\ny(0.1)\\approx y_{1}=1+\\frac{1}{10}\\cdot(-1)=1-\\frac{1}{10}=\\frac{9}{10}.\n$$", "answer": "$$\\boxed{\\frac{9}{10}}$$", "id": "2180117"}, {"introduction": "虽然欧拉方法很简单，但它在长期模拟中可能会产生不符合物理规律的结果。这个练习通过对比显式欧拉方法和一种称为辛欧拉方法的改进算法，来模拟一个简谐振子。你将看到，选择一个能够保持系统能量等物理性质的数值方法是多么重要。[@problem_id:1684988]", "problem": "一个质量为单位值（$m=1$）的粒子连接在一个线性弹簧上，形成一个简谐振子。其运动由二阶常微分方程 $\\frac{d^2x}{dt^2} + \\omega^2 x = 0$ 描述，该方程可以等价地写成一个包含两个一阶方程的方程组：\n$$\n\\frac{dx}{dt} = v\n$$\n$$\n\\frac{dv}{dt} = -\\omega^2 x\n$$\n该系统的角频率为 $\\omega = 1.0 \\text{ rad/s}$，并从初始状态 $(x_0, v_0) = (x(0), v(0)) = (1.0 \\text{ m}, 1.0 \\text{ m/s})$ 释放。\n\n我们希望比较由两种不同的积分方法生成的数值轨迹，两者都使用 $h=0.5 \\text{ s}$ 的时间步长。设第 $n$ 步的状态为 $(x_n, v_n)$。这两种方法定义如下：\n\n**方法 A (显式欧拉法):**\n$$\nx_{n+1} = x_n + h v_n\n$$\n$$\nv_{n+1} = v_n - h \\omega^2 x_n\n$$\n\n**方法 B (辛欧拉法):**\n$$\nx_{n+1} = x_n + h v_n\n$$\n$$\nv_{n+1} = v_n - h \\omega^2 x_{n+1}\n$$\n\n系统的机械能由 $E(x, v) = \\frac{1}{2} m v^2 + \\frac{1}{2} m \\omega^2 x^2$ 给出。对于单位质量（$m=1$），我们将能量函数定义为 $E(x, v) = \\frac{1}{2}(v^2 + \\omega^2 x^2)$。\n\n经过精确的 $N=4$ 步后，设由方法 A 计算出的状态为 $(x_A, v_A)$，其对应的能量为 $E_A = E(x_A, v_A)$。类似地，设由方法 B 计算出的状态为 $(x_B, v_B)$，其能量为 $E_B = E(x_B, v_B)$。\n\n计算比值 $R = \\frac{E_A}{E_B}$ 的数值。将最终答案四舍五入到四位有效数字。", "solution": "给定质量为单位值、角频率为 $\\omega=1$ 的简谐振子，因此其一阶方程组为\n$$\n\\frac{dx}{dt}=v,\\qquad \\frac{dv}{dt}=-x,\n$$\n离散时间步长为 $h=\\frac{1}{2}$。单位质量的能量为\n$$\nE(x,v)=\\frac{1}{2}\\left(v^{2}+x^{2}\\right).\n$$\n\n方法 A (显式欧拉法) 通过以下方式更新：\n$$\nx_{n+1}=x_{n}+h v_{n},\\qquad v_{n+1}=v_{n}-h x_{n},\n$$\n初始条件为 $(x_{0},v_{0})=(1,1)$。迭代四步：\n- 第 1 步：$x_{1}=1+\\frac{1}{2}\\cdot 1=\\frac{3}{2}$，$v_{1}=1-\\frac{1}{2}\\cdot 1=\\frac{1}{2}$。\n- 第 2 步：$x_{2}=\\frac{3}{2}+\\frac{1}{2}\\cdot\\frac{1}{2}=\\frac{7}{4}$，$v_{2}=\\frac{1}{2}-\\frac{1}{2}\\cdot\\frac{3}{2}=-\\frac{1}{4}$。\n- 第 3 步：$x_{3}=\\frac{7}{4}+\\frac{1}{2}\\cdot\\left(-\\frac{1}{4}\\right)=\\frac{13}{8}$，$v_{3}=-\\frac{1}{4}-\\frac{1}{2}\\cdot\\frac{7}{4}=-\\frac{9}{8}$。\n- 第 4 步：$x_{4}=\\frac{13}{8}+\\frac{1}{2}\\cdot\\left(-\\frac{9}{8}\\right)=\\frac{17}{16}$，$v_{4}=-\\frac{9}{8}-\\frac{1}{2}\\cdot\\frac{13}{8}=-\\frac{31}{16}$。\n因此 $(x_{A},v_{A})=\\left(\\frac{17}{16},-\\frac{31}{16}\\right)$ 并且\n$$\nE_{A}=\\frac{1}{2}\\left[\\left(\\frac{31}{16}\\right)^{2}+\\left(\\frac{17}{16}\\right)^{2}\\right]\n=\\frac{1}{2}\\cdot\\frac{961+289}{256}=\\frac{625}{256}.\n$$\n\n方法 B (辛欧拉法) 通过以下方式更新：\n$$\nx_{n+1}=x_{n}+h v_{n},\\qquad v_{n+1}=v_{n}-h x_{n+1},\n$$\n初始条件相同。迭代四步：\n- 第 1 步：$x_{1}=1+\\frac{1}{2}\\cdot 1=\\frac{3}{2}$，$v_{1}=1-\\frac{1}{2}\\cdot\\frac{3}{2}=\\frac{1}{4}$。\n- 第 2 步：$x_{2}=\\frac{3}{2}+\\frac{1}{2}\\cdot\\frac{1}{4}=\\frac{13}{8}$，$v_{2}=\\frac{1}{4}-\\frac{1}{2}\\cdot\\frac{13}{8}=-\\frac{9}{16}$。\n- 第 3 步：$x_{3}=\\frac{13}{8}+\\frac{1}{2}\\cdot\\left(-\\frac{9}{16}\\right)=\\frac{43}{32}$，$v_{3}=-\\frac{9}{16}-\\frac{1}{2}\\cdot\\frac{43}{32}=-\\frac{79}{64}$。\n- 第 4 步：$x_{4}=\\frac{43}{32}+\\frac{1}{2}\\cdot\\left(-\\frac{79}{64}\\right)=\\frac{93}{128}$，$v_{4}=-\\frac{79}{64}-\\frac{1}{2}\\cdot\\frac{93}{128}=-\\frac{409}{256}$。\n因此 $(x_{B},v_{B})=\\left(\\frac{93}{128},-\\frac{409}{256}\\right)$ 并且\n$$\nE_{B}=\\frac{1}{2}\\left[\\left(\\frac{409}{256}\\right)^{2}+\\left(\\frac{93}{128}\\right)^{2}\\right]\n=\\frac{1}{2}\\left(\\frac{167281}{65536}+\\frac{8649}{16384}\\right)\n=\\frac{1}{2}\\cdot\\frac{167281+34596}{65536}\n=\\frac{201877}{131072}.\n$$\n\n因此，比值为\n$$\nR=\\frac{E_{A}}{E_{B}}=\\frac{\\frac{625}{256}}{\\frac{201877}{131072}}\n=\\frac{625\\cdot 131072}{256\\cdot 201877}=\\frac{320000}{201877}\\approx 1.585123615\\ldots\n$$\n四舍五入到四位有效数字，$R=1.585$。", "answer": "$$\\boxed{1.585}$$", "id": "1684988"}, {"introduction": "在选择数值方法时，我们如何量化其优劣？“精度阶”是一个关键指标，它描述了当步长减小时，方法的误差下降速度。本练习将指导你通过数值实验来确定一个新提出的多步方法的精度阶，这是一个在评估和开发新算法时至关重要的实践技能。[@problem_id:2179607]", "problem": "一个新颖的显式两步线性多步法被提出来用于求解形式为 $y'(t) = f(t, y(t))$ 的一阶初值问题（IVP）。对于均匀步长 $h$，该方法由以下递推关系定义：\n$$\ny_{n+1} = 2y_n - y_{n-1} + h \\left( f(t_n, y_n) - f(t_{n-1}, y_{n-1}) \\right)\n$$\n其中 $n \\ge 1$，$y_k$ 是在时间 $t_k = t_0 + kh$ 时真实解 $y(t_k)$ 的数值近似。作为一个两步法，它需要两个初始值 $y_0$ 和 $y_1$ 来开始迭代。\n\n在固定的最终时间 $T$，一个数值方法的全局误差 $E(h)$ 通常期望遵循形式为 $E(h) \\approx C h^p$ 的幂律，其中 $p$ 是该方法的精度阶，$C$ 是一个常数。您的任务是对此特定方法数值估计其阶 $p$。\n\n考虑以下初值问题（IVP）：\n$$\ny'(t) = -2y(t) + \\sin(t), \\quad y(0) = 1\n$$\n该IVP的精确解析解为 $y(t) = \\frac{1}{5}(2\\sin(t) - \\cos(t)) + \\frac{6}{5}\\exp(-2t)$。\n\n为了估计阶 $p$，请执行以下步骤：\n1.  使用四种不同的均匀步长：$h_1 = 0.1$，$h_2 = 0.05$，$h_3 = 0.025$ 和 $h_4 = 0.0125$，从 $t=0$ 到 $T=2$ 数值求解该IVP。\n2.  对于每次运行，使用精确的初始值 $y_0 = y(t_0)$ 和 $y_1 = y(t_1) = y(h)$ 来初始化该方法。\n3.  设 $E_i$ 为在最终时间 $T=2$ 时的绝对误差，定义为 $E_i = |y_{N_i} - y(T)|$，其中 $y_{N_i}$ 是用步长 $h_i$ 计算得到的在 $t=T$ 时的数值解，且 $N_i = T/h_i$。\n4.  使用最小的两个步长（$h_3$ 和 $h_4$）的运行结果，计算表观精度阶 $p$。\n\n报告您计算出的 $p$ 值，四舍五入到三位有效数字。", "solution": "给定显式两步法\n$$\ny_{n+1}=2y_{n}-y_{n-1}+h\\bigl(f(t_{n},y_{n})-f(t_{n-1},y_{n-1})\\bigr),\n$$\n应用于初值问题 $y'(t)=-2y(t)+\\sin(t)$，使用精确初始值 $y_{0}=y(0)$ 和 $y_{1}=y(h)$，最终时间为 $T=2$。我们需要从步长为 $h_{3}=0.025$ 和 $h_{4}=0.0125$ 的两个最精细的运行中估计阶 $p$。\n\n为了确定阶数，我们考虑将该方法应用于精确解 $y(t)$ 时的局部截断误差。对于精确解，有 $f(t_{k},y(t_{k}))=y'(t_{k})$，因此在第 $n+1$ 步代入精确值时的残差为\n$$\n\\tau_{n+1}=y(t_{n+1})-2y(t_{n})+y(t_{n-1})-h\\bigl(y'(t_{n})-y'(t_{n-1})\\bigr).\n$$\n设 $t=t_{n}$ 并在 $t$ 点进行泰勒级数展开：\n$$\n\\begin{aligned}\ny(t+h)=y(t)+h y'(t)+\\frac{h^{2}}{2}y''(t)+\\frac{h^{3}}{6}y^{(3)}(t)+\\frac{h^{4}}{24}y^{(4)}(t)+\\frac{h^{5}}{120}y^{(5)}(t)+O(h^{6}),\\\\\ny(t-h)=y(t)-h y'(t)+\\frac{h^{2}}{2}y''(t)-\\frac{h^{3}}{6}y^{(3)}(t)+\\frac{h^{4}}{24}y^{(4)}(t)-\\frac{h^{5}}{120}y^{(5)}(t)+O(h^{6}),\\\\\ny'(t-h)=y'(t)-h y''(t)+\\frac{h^{2}}{2}y^{(3)}(t)-\\frac{h^{3}}{6}y^{(4)}(t)+\\frac{h^{4}}{24}y^{(5)}(t)+O(h^{5}).\n\\end{aligned}\n$$\n于是\n$$\n\\begin{aligned}\ny(t+h)-2y(t)+y(t-h)=h^{2}y''(t)+\\frac{h^{4}}{12}y^{(4)}(t)+O(h^{6}),\\\\\nh\\bigl(y'(t)-y'(t-h)\\bigr)=h^{2}y''(t)-\\frac{h^{3}}{2}y^{(3)}(t)+\\frac{h^{4}}{6}y^{(4)}(t)-\\frac{h^{5}}{24}y^{(5)}(t)+O(h^{6}).\n\\end{aligned}\n$$\n因此\n$$\n\\tau_{n+1}=\\frac{h^{3}}{2}y^{(3)}(t)-\\frac{h^{4}}{12}y^{(4)}(t)+\\frac{h^{5}}{24}y^{(5)}(t)+O(h^{6}),\n$$\n所以局部截断误差是 $O(h^{3})$，这意味着全局误差为 $E(h)=O(h^{2})$。因此该方法的阶为 $p=2$。\n\n这可以通过使用线性多步法的阶条件独立地证实，其系数为 $\\alpha_{0}=1$，$\\alpha_{1}=-2$，$\\alpha_{2}=1$ 和 $\\beta_{0}=-1$，$\\beta_{1}=1$，$\\beta_{2}=0$。以下恒等式成立：\n$$\n\\sum_{j=0}^{2}\\alpha_{j}=0,\\quad \\sum_{j=0}^{2}j\\alpha_{j}=\\sum_{j=0}^{2}\\beta_{j},\\quad \\sum_{j=0}^{2}j^{2}\\alpha_{j}=2\\sum_{j=0}^{2}j\\beta_{j}\n$$\n然而\n$$\n\\sum_{j=0}^{2}j^{3}\\alpha_{j}\\neq 3\\sum_{j=0}^{2}j^{2}\\beta_{j},\n$$\n所以阶恰好是 $p=2$。\n\n对于从两个最精细的运行中计算出的表观阶，定义 $E_{i}=|y_{N_{i}}-y(T)|$，其中 $N_{i}=T/h_{i}$，并使用\n$$\np=\\frac{\\ln\\!\\bigl(E_{3}/E_{4}\\bigr)}{\\ln\\!\\bigl(h_{3}/h_{4}\\bigr)}.\n$$\n因为 $h_{4}=h_{3}/2$ 且 $E(h)\\approx C h^{p}$（其中 $p=2$），我们得到\n$$\np=\\frac{\\ln\\!\\bigl(C h_{3}^{2}/C h_{4}^{2}\\bigr)}{\\ln\\!\\bigl(h_{3}/h_{4}\\bigr)}=\\frac{\\ln\\!\\bigl((h_{3}/h_{4})^{2}\\bigr)}{\\ln\\!\\bigl(h_{3}/h_{4}\\bigr)}=2.\n$$\n因此，从 $h_{3}$ 和 $h_{4}$ 估计的表观阶是 $p=2$，四舍五入到三位有效数字为 $2.00$。", "answer": "$$\\boxed{2.00}$$", "id": "2179607"}]}