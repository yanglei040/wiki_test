{"hands_on_practices": [{"introduction": "本节的第一个练习将带你入门配置法。通过一个简单的二阶边值问题，你将学习如何设置试函数、计算残差，并在单个配置点上求解未知系数。这个基本练习 ([@problem_id:2159820]) 是掌握配置法核心思想和操作流程的第一步。", "problem": "考虑由以下微分方程定义的两点边值问题 (BVP)：\n$$y''(x) + \\epsilon y'(x) = 1$$\n定义域为 $x \\in [0, 1]$，边界条件为 $y(0) = 0$ 和 $y(1) = 0$。其中 $\\epsilon$ 是一个实常数。\n\n我们希望使用配置法求此边值问题的一个近似解。选择一个单参数试函数 $\\tilde{y}(x)$，它本身就满足给定的边界条件：\n$$\\tilde{y}(x) = c_1 x(1-x)$$\n其中 $c_1$ 是一个未知系数。\n\n配置法要求微分方程的残差在定义域内一个或多个指定点（配置点）处为零。对于此问题，使用位于 $x_c = 1/4$ 的单个配置点。\n\n确定系数 $c_1$ 作为参数 $\\epsilon$ 的函数的表达式。", "solution": "我们使用配置法和单参数试函数 $\\tilde{y}(x) = c_{1}x(1-x)$，对于任意 $c_{1}$，该函数都满足 $y(0)=0$ 和 $y(1)=0$。计算其导数：\n$$\n\\tilde{y}'(x) = c_{1}(1-2x), \\qquad \\tilde{y}''(x) = -2c_{1}.\n$$\n微分方程 $y''(x) + \\epsilon y'(x) = 1$ 的残差为\n$$\nR(x) = \\tilde{y}''(x) + \\epsilon \\tilde{y}'(x) - 1 = -2c_{1} + \\epsilon c_{1}(1-2x) - 1 = c_{1}\\bigl[-2 + \\epsilon(1-2x)\\bigr] - 1.\n$$\n在 $x_{c} = \\tfrac{1}{4}$ 处施加配置条件，我们使用 $1 - 2x_{c} = \\tfrac{1}{2}$ 来得到\n$$\nR\\!\\left(\\tfrac{1}{4}\\right) = c_{1}\\left(-2 + \\frac{\\epsilon}{2}\\right) - 1 = 0.\n$$\n解出 $c_{1}$ 得\n$$\nc_{1} = \\frac{1}{-2 + \\frac{\\epsilon}{2}} = \\frac{2}{\\epsilon - 4},\n$$\n该解在 $\\epsilon \\neq 4$ 时有效（当 $\\epsilon=4$ 时，残差与 $c_{1}$ 无关，无法在 $x_{c}$ 处为零）。", "answer": "$$\\boxed{\\frac{2}{\\epsilon - 4}}$$", "id": "2159820"}, {"introduction": "掌握了基本流程后，下一个自然而然的问题是：配置点的选择会如何影响我们的近似解？这个练习 ([@problem_id:2159865]) 直接探讨了这个问题，要求你对同一个边值问题，使用两个不同的配置点来分别确定试函数的系数。通过比较结果，你将直观地理解到配置点选择对解的形态和精度的重要影响。", "problem": "配置法是一种求解微分方程近似解的技术。该方法包括选择一个带有未知参数的试探函数，然后通过强制该试探函数在一组特定的点（称为配置点）上满足微分方程来确定这些参数。\n\n考虑在区间 $x \\in [0, 1]$ 上的以下二阶线性边值问题 (BVP)：\n$$y''(x) + y(x) = 1$$\n边界条件为 $y(0) = 0$ 和 $y(1) = 0$。\n\n我们寻求一个形式为 $\\tilde{y}(x) = c \\sin(\\pi x)$ 的近似解，其中 $c$ 是一个待定常数。注意，这个试探函数自然满足给定的边界条件。\n\n您的任务是使用单点配置法，针对两个不同的配置点，确定系数 $c$ 的值。\n1.  首先，通过强制微分方程在配置点 $x = 1/2$ 处精确满足，求出系数（我们称之为 $c_A$）。\n2.  其次，通过强制微分方程在配置点 $x = 1/3$ 处精确满足，求出系数（我们称之为 $c_B$）。\n\n提供 $c_A$ 和 $c_B$ 的值，以一对解析表达式的形式给出。", "solution": "我们使用试探函数 $\\tilde{y}(x)=c\\sin(\\pi x)$ 应用单点配置法，该函数自动满足 $y(0)=0$ 和 $y(1)=0$。控制微分方程为 $y''(x)+y(x)=1$。计算二阶导数：\n$$\n\\tilde{y}''(x)=c\\frac{d^{2}}{dx^{2}}\\sin(\\pi x)=c\\frac{d}{dx}\\left(\\pi\\cos(\\pi x)\\right)=c\\left(-\\pi^{2}\\sin(\\pi x)\\right).\n$$\n因此，\n$$\n\\tilde{y}''(x)+\\tilde{y}(x)=c\\left(-\\pi^{2}\\sin(\\pi x)\\right)+c\\sin(\\pi x)=c(1-\\pi^{2})\\sin(\\pi x).\n$$\n在点 $x_{c}$ 的配置条件强制微分方程在该点精确成立：\n$$\nc(1-\\pi^{2})\\sin(\\pi x_{c})=1 \\quad\\Longrightarrow\\quad c=\\frac{1}{(1-\\pi^{2})\\sin(\\pi x_{c})}.\n$$\n对于 $x_{c}=1/2$，$\\sin(\\pi/2)=1$，得到\n$$\nc_{A}=\\frac{1}{1-\\pi^{2}}.\n$$\n对于 $x_{c}=1/3$，$\\sin(\\pi/3)=\\frac{\\sqrt{3}}{2}$，得到\n$$\nc_{B}=\\frac{1}{(1-\\pi^{2})\\left(\\frac{\\sqrt{3}}{2}\\right)}=\\frac{2}{\\sqrt{3}\\,(1-\\pi^{2})}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{1}{1-\\pi^{2}}  \\frac{2}{\\sqrt{3}\\left(1-\\pi^{2}\\right)}\\end{pmatrix}}$$", "id": "2159865"}, {"introduction": "为了获得更精确的近似解，我们通常需要使用多个基函数的线性组合。这个进阶练习 ([@problem_id:2159868]) 将指导你如何从单个未知系数扩展到处理一个系数向量，通过在多个配置点上应用配置条件，建立并求解一个线性方程组。这个过程是在实践中应用配置法解决复杂问题的关键一步，也为你展示了如何选择更优的配置点（如 Legendre 多项式的根）。", "problem": "考虑由微分方程给出的二阶线性齐次边值问题 (BVP)\n$$ y''(x) + x^2 y(x) = 0 $$\n该问题定义在区间 $x \\in [-1, 1]$ 上，并带有狄利克雷边界条件 $y(-1) = 0$ 和 $y(1) = 0$。\n\n我们希望使用配置法求此边值问题的一个近似解。该近似解 $\\tilde{y}(x)$ 被构造为基函数的线性组合：\n$$ \\tilde{y}(x) = c_1 \\phi_1(x) + c_2 \\phi_2(x) $$\n其中 $c_1$ 和 $c_2$ 是待定系数。基函数选择为偶次多项式 $\\phi_1(x) = 1 - x^2$ 和 $\\phi_2(x) = x^2(1 - x^2)$，它们本身就满足边界条件。\n\n配置点选为四阶 Legendre 多项式 $P_4(x)$ 的正根，其标准形式由下式给出\n$$ P_4(x) = \\frac{1}{8} (35x^4 - 30x^2 + 3) $$\n配置法要求微分方程的残差在这些点上为零。这一要求导出了一个形式为 $A \\mathbf{c} = \\mathbf{0}$ 的齐次线性方程组，其中 $\\mathbf{c} = \\begin{pmatrix} c_1 \\\\ c_2 \\end{pmatrix}$ 且 $A$ 是 $2 \\times 2$ 的配置矩阵。\n\n确定 $2 \\times 2$ 配置矩阵 $A$ 的精确解析表达式。", "solution": "我们对算子 $L[y]=y''+x^{2}y$ 使用配置法，试验解为 $\\tilde{y}(x)=c_{1}\\phi_{1}(x)+c_{2}\\phi_{2}(x)$，其中 $\\phi_{1}(x)=1-x^{2}$ 且 $\\phi_{2}(x)=x^{2}(1-x^{2})=x^{2}-x^{4}$。配置点 $x_{1},x_{2}$ 是 $P_{4}(x)=\\frac{1}{8}(35x^{4}-30x^{2}+3)$ 的正根，因此它们满足\n$$\n35x^{4}-30x^{2}+3=0.\n$$\n定义 $s=x^{2}$。则在配置点处，$s$ 满足\n$$\n35s^{2}-30s+3=0,\n$$\n其根为\n$$\ns_{1}=\\frac{15-2\\sqrt{30}}{35}, \\qquad s_{2}=\\frac{15+2\\sqrt{30}}{35}.\n$$\n\n计算算子 $L$ 作用于基函数的结果：\n$$\n\\phi_{1}''(x)=-2, \\quad \\Rightarrow \\quad L[\\phi_{1}](x)=-2+x^{2}-x^{4},\n$$\n$$\n\\phi_{2}''(x)=2-12x^{2}, \\quad \\Rightarrow \\quad L[\\phi_{2}](x)=2-12x^{2}+x^{4}-x^{6}.\n$$\n因此配置矩阵的元素为\n$$\nA_{i1}=L[\\phi_{1}](x_{i})=-2+s_{i}-s_{i}^{2}, \\qquad A_{i2}=L[\\phi_{2}](x_{i})=2-12s_{i}+s_{i}^{2}-s_{i}^{3}.\n$$\n\n使用二次关系式 $35s^{2}-30s+3=0$ 对 $s$ 进行降幂：\n$$\ns^{2}=\\frac{30s-3}{35}, \\qquad s^{3}=s\\cdot s^{2}=\\frac{30s^{2}-3s}{35}=\\frac{159s-18}{245}.\n$$\n因此\n$$\nA_{i1}=-2+s_{i}-\\frac{30s_{i}-3}{35}=-\\frac{67}{35}+\\frac{1}{7}s_{i}=\\frac{-67+5s_{i}}{35},\n$$\n$$\nA_{i2}=2-12s_{i}+\\frac{30s_{i}-3}{35}-\\frac{159s_{i}-18}{245}\n=\\frac{487}{245}-\\frac{2889}{245}s_{i}.\n$$\n\n代入 $s_{1}=\\frac{15-2\\sqrt{30}}{35}$ 和 $s_{2}=\\frac{15+2\\sqrt{30}}{35}$ 可得\n$$\nA_{11}=\\frac{-454-2\\sqrt{30}}{245}, \\quad A_{21}=\\frac{-454+2\\sqrt{30}}{245},\n$$\n$$\nA_{12}=\\frac{-26290+5778\\sqrt{30}}{8575}, \\quad A_{22}=\\frac{-26290-5778\\sqrt{30}}{8575}.\n$$\n\n因此，精确的 $2\\times 2$ 配置矩阵 $A$ 是\n$$\nA=\\begin{pmatrix}\n\\dfrac{-454-2\\sqrt{30}}{245}  & \\dfrac{-26290+5778\\sqrt{30}}{8575} \\\\\n\\dfrac{-454+2\\sqrt{30}}{245}  & \\dfrac{-26290-5778\\sqrt{30}}{8575}\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\n\\dfrac{-454-2\\sqrt{30}}{245}  & \\dfrac{-26290+5778\\sqrt{30}}{8575} \\\\\n\\dfrac{-454+2\\sqrt{30}}{245}  & \\dfrac{-26290-5778\\sqrt{30}}{8575}\n\\end{pmatrix}}$$", "id": "2159868"}]}