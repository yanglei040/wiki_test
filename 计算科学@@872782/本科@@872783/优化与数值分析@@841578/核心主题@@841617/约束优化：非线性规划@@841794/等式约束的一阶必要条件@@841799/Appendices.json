{"hands_on_practices": [{"introduction": "本练习要求你找出椭球体上距离原点最远的点。这是一个应用拉格朗日乘子法的经典范例，完美地阐释了等式约束下一阶必要条件的几何意义，即在极值点处，目标函数的梯度必然与约束曲面的梯度（法向量）共线。通过这个练习 [@problem_id:2173341]，你将对拉格朗日乘子法建立起直观的几何理解。", "problem": "在各向异性材料的塑性研究中，屈服面是定义材料在复杂加载条件下弹性极限的一个准则。对于一种特定的正交各向异性材料，其主应力状态（用向量 $(\\sigma_1, \\sigma_2, \\sigma_3)$ 表示）被约束在一个椭球屈服面上。该曲面的方程为：\n$$ \\frac{\\sigma_1^2}{S_1^2} + \\frac{\\sigma_2^2}{S_2^2} + \\frac{\\sigma_3^2}{S_3^2} = 1 $$\n这里，$S_1, S_2,$ 和 $S_3$ 代表材料沿其三个主轴的屈服强度。它们是正常数，并且对于这种特定材料，它们的大小顺序为 $S_1 > S_2 > S_3 > 0$。\n\n我们感兴趣的是找出该屈服面上具有最大总模量的应力状态。应力向量的模定义为 $M = \\sqrt{\\sigma_1^2 + \\sigma_2^2 + \\sigma_3^2}$。\n\n确定位于此屈服面上的应力状态的模 $M$ 的最大可能值。", "solution": "问题是要求解位于由约束方程 $\\frac{\\sigma_1^2}{S_1^2} + \\frac{\\sigma_2^2}{S_2^2} + \\frac{\\sigma_3^2}{S_3^2} = 1$ 定义的椭球面上的点 $(\\sigma_1, \\sigma_2, \\sigma_3)$ 的应力向量的模 $M = \\sqrt{\\sigma_1^2 + \\sigma_2^2 + \\sigma_3^2}$ 的最大值。\n\n这是一个约束优化问题。为了简化计算，由于 $M$ 总是非负的，我们可以最大化其平方 $M^2$，而不是最大化 $M$。设待最大化的函数为 $f(\\sigma_1, \\sigma_2, \\sigma_3) = \\sigma_1^2 + \\sigma_2^2 + \\sigma_3^2$。约束函数为 $g(\\sigma_1, \\sigma_2, \\sigma_3) = \\frac{\\sigma_1^2}{S_1^2} + \\frac{\\sigma_2^2}{S_2^2} + \\frac{\\sigma_3^2}{S_3^2} - 1 = 0$。\n\n我们使用拉格朗日乘数法。拉格朗日函数 $\\mathcal{L}$ 定义为：\n$$ \\mathcal{L}(\\sigma_1, \\sigma_2, \\sigma_3, \\lambda) = f(\\sigma_1, \\sigma_2, \\sigma_3) - \\lambda g(\\sigma_1, \\sigma_2, \\sigma_3) $$\n$$ \\mathcal{L}(\\sigma_1, \\sigma_2, \\sigma_3, \\lambda) = (\\sigma_1^2 + \\sigma_2^2 + \\sigma_3^2) - \\lambda \\left( \\frac{\\sigma_1^2}{S_1^2} + \\frac{\\sigma_2^2}{S_2^2} + \\frac{\\sigma_3^2}{S_3^2} - 1 \\right) $$\n为了找到极值，我们计算 $\\mathcal{L}$ 关于 $\\sigma_1, \\sigma_2, \\sigma_3$ 和 $\\lambda$ 的偏导数，并令它们等于零。\n$$ \\frac{\\partial \\mathcal{L}}{\\partial \\sigma_1} = 2\\sigma_1 - \\frac{2\\lambda \\sigma_1}{S_1^2} = 2\\sigma_1 \\left( 1 - \\frac{\\lambda}{S_1^2} \\right) = 0 $$\n$$ \\frac{\\partial \\mathcal{L}}{\\partial \\sigma_2} = 2\\sigma_2 - \\frac{2\\lambda \\sigma_2}{S_2^2} = 2\\sigma_2 \\left( 1 - \\frac{\\lambda}{S_2^2} \\right) = 0 $$\n$$ \\frac{\\partial \\mathcal{L}}{\\partial \\sigma_3} = 2\\sigma_3 - \\frac{2\\lambda \\sigma_3}{S_3^2} = 2\\sigma_3 \\left( 1 - \\frac{\\lambda}{S_3^2} \\right) = 0 $$\n$$ \\frac{\\partial \\mathcal{L}}{\\partial \\lambda} = -\\left( \\frac{\\sigma_1^2}{S_1^2} + \\frac{\\sigma_2^2}{S_2^2} + \\frac{\\sigma_3^2}{S_3^2} - 1 \\right) = 0 $$\n最后一个方程就是原始的约束条件。从前三个方程中，我们分析非平凡解的条件（原点 $(\\sigma_1, \\sigma_2, \\sigma_3) = (0,0,0)$ 不在椭球面上，因为它不满足约束条件）。\n\n情况1：$\\sigma_1 \\neq 0$, $\\sigma_2 = 0$, $\\sigma_3 = 0$。\n第一个方程给出 $1 - \\frac{\\lambda}{S_1^2} = 0$，这意味着 $\\lambda = S_1^2$。由于 $\\sigma_2=0$ 和 $\\sigma_3=0$，第二个和第三个方程得到满足。\n将 $\\sigma_2 = 0$ 和 $\\sigma_3 = 0$ 代入约束方程：\n$$ \\frac{\\sigma_1^2}{S_1^2} + 0 + 0 = 1 \\implies \\sigma_1^2 = S_1^2 \\implies \\sigma_1 = \\pm S_1 $$\n候选点是 $(\\pm S_1, 0, 0)$。在这些点上，我们的目标函数的值为 $f = (\\pm S_1)^2 + 0^2 + 0^2 = S_1^2$。\n\n情况2：$\\sigma_2 \\neq 0$, $\\sigma_1 = 0$, $\\sigma_3 = 0$。\n第二个方程给出 $1 - \\frac{\\lambda}{S_2^2} = 0$，这意味着 $\\lambda = S_2^2$。\n将 $\\sigma_1 = 0$ 和 $\\sigma_3 = 0$ 代入约束方程：\n$$ 0 + \\frac{\\sigma_2^2}{S_2^2} + 0 = 1 \\implies \\sigma_2^2 = S_2^2 \\implies \\sigma_2 = \\pm S_2 $$\n候选点是 $(0, \\pm S_2, 0)$。目标函数的值为 $f = 0^2 + (\\pm S_2)^2 + 0^2 = S_2^2$。\n\n情况3：$\\sigma_3 \\neq 0$, $\\sigma_1 = 0$, $\\sigma_2 = 0$。\n第三个方程给出 $1 - \\frac{\\lambda}{S_3^2} = 0$，这意味着 $\\lambda = S_3^2$。\n将 $\\sigma_1 = 0$ 和 $\\sigma_2 = 0$ 代入约束方程：\n$$ 0 + 0 + \\frac{\\sigma_3^2}{S_3^2} = 1 \\implies \\sigma_3^2 = S_3^2 \\implies \\sigma_3 = \\pm S_3 $$\n候选点是 $(0, 0, \\pm S_3)$。目标函数的值为 $f = 0^2 + 0^2 + (\\pm S_3)^2 = S_3^2$。\n\n其他 $(\\sigma_1, \\sigma_2, \\sigma_3)$ 中有多于一个分量不为零的情况是不可能的。例如，如果 $\\sigma_1 \\neq 0$ 且 $\\sigma_2 \\neq 0$，那么从前两个偏导数方程，我们必须有 $\\lambda = S_1^2$ 和 $\\lambda = S_2^2$。这将意味着 $S_1^2 = S_2^2$，这与给定的条件 $S_1 > S_2 > S_3 > 0$ 相矛盾。\n\n现在我们比较这三种情况下目标函数 $f = M^2$ 的值：$S_1^2, S_2^2, S_3^2$。\n我们已知 $S_1 > S_2 > S_3 > 0$。对这些正值进行平方会保持不等式关系：$S_1^2 > S_2^2 > S_3^2$。\n因此，$f = M^2$ 的最大值是 $S_1^2$。\n模 $M$ 的最大值是这个值的平方根。\n$$ M_{\\text{max}} = \\sqrt{S_1^2} = S_1 $$\n（我们取正平方根，因为 $M$ 是一个模，且已知 $S_1$ 是正数）。", "answer": "$$\\boxed{S_1}$$", "id": "2173341"}, {"introduction": "许多实际的优化问题常常涉及多个等式约束。本练习 [@problem_id:2173347] 要求你找出由一个锥面和一个平面相交形成的曲线上点的最高和最低位置，这需要你将拉格朗日乘子法推广到处理多个约束的情形。你将从中学会，在这种情况下，目标函数的梯度必须位于由所有约束函数的梯度所张成的线性空间中。", "problem": "考虑三维欧几里得空间中的一条曲线，它由两个曲面相交而成。第一个曲面是一个双锥面，其方程为 $z^{2} = x^{2} + y^{2}$。第二个曲面是一个平面，其方程为 $x + 2y + z = 4$。\n\n求出位于该交线上的所有点 $(x,y,z)$ 的 $z$ 坐标的最大值和最小值。\n\n请以一对精确解析值的形式给出答案，并按从最小值到最大值的顺序排列。", "solution": "我们寻求函数 $f(x,y,z)=z$ 在由约束条件 $g_{1}(x,y,z)=z^{2}-x^{2}-y^{2}=0$ 和 $g_{2}(x,y,z)=x+2y+z-4=0$ 定义的曲线上的极值。根据拉格朗日乘数法，存在 $\\lambda$ 和 $\\mu$ 使得\n$$\n\\nabla f=\\lambda\\,\\nabla g_{1}+\\mu\\,\\nabla g_{2}.\n$$\n计算梯度：$\\nabla f=(0,0,1)$，$\\nabla g_{1}=(-2x,-2y,2z)$，以及 $\\nabla g_{2}=(1,2,1)$。因此，\n$$\n(0,0,1)=\\lambda(-2x,-2y,2z)+\\mu(1,2,1).\n$$\n令各分量相等，得到\n$$\n0=-2\\lambda x+\\mu,\\qquad 0=-2\\lambda y+2\\mu,\\qquad 1=2\\lambda z+\\mu.\n$$\n由前两个方程可知，$\\mu=2\\lambda x$ 且 $\\mu=\\lambda y$，所以要么 $\\lambda=0$，要么 $y=2x$。如果 $\\lambda=0$，那么由第一个方程可得 $\\mu=0$，这与第三个方程 $1=2\\lambda z+\\mu=0$ 相矛盾。因此 $\\lambda\\neq 0$ 且 $y=2x$。\n\n将 $y=2x$ 代入约束条件。平面方程给出 $x+2y+z=4$，即 $x+4x+z=4$，因此\n$$\nz=4-5x.\n$$\n锥面方程给出 $z^{2}=x^{2}+y^{2}=x^{2}+(2x)^{2}=5x^{2}$，即\n$$\nz^{2}=5x^{2}.\n$$\n将 $z=4-5x$ 代入 $z^{2}=5x^{2}$：\n$$\n(4-5x)^{2}=5x^{2}\\;\\;\\Longrightarrow\\;\\;16-40x+25x^{2}=5x^{2}\\;\\;\\Longrightarrow\\;\\;20x^{2}-40x+16=0.\n$$\n两边同除以 $4$ 得到 $5x^{2}-10x+4=0$，其解为\n$$\nx=\\frac{10\\pm\\sqrt{100-80}}{10}=\\frac{10\\pm2\\sqrt{5}}{10}=1\\pm\\frac{\\sqrt{5}}{5}.\n$$\n则\n$$\nz=4-5x=4-5\\left(1\\pm\\frac{\\sqrt{5}}{5}\\right)=4-(5\\pm\\sqrt{5})=-1\\mp\\sqrt{5}.\n$$\n因此，两个临界 $z$ 值为 $-1-\\sqrt{5}$ 和 $-1+\\sqrt{5}$。由于交线是有界的（一个椭圆），这些值分别是曲线上 $z$ 坐标的最小值和最大值。\n\n按从最小值到最大值的顺序，这些值为 $-1-\\sqrt{5}$ 和 $-1+\\sqrt{5}$。", "answer": "$$\\boxed{\\begin{pmatrix}-1-\\sqrt{5} & -1+\\sqrt{5}\\end{pmatrix}}$$", "id": "2173347"}, {"introduction": "约束优化的威力远不止于解决三维几何问题，它同样适用于更抽象的向量空间。在本问题中 [@problem_id:2173359]，你将处理一项工程实际任务：为一个数学模型寻找一组最优系数，使其在满足实验数据约束的前提下，尽可能地接近一个理论目标。这个问题展示了最小化二次型函数（欧氏距离的平方）同时满足线性约束的基本原理，在信号处理、机器学习等领域有着广泛的应用。", "problem": "一位工程师正在使用形式为 $P(t) = c_1 \\cos(t) + c_2 \\sin(t) + c_3 \\cos(2t) + c_4 \\sin(2t)$ 的三角多项式来为一个周期性物理过程建模。这些系数构成一个向量 $\\mathbf{x} = (c_1, c_2, c_3, c_4)^T$。根据先前的理论工作，一组理想的系数被认为是 $\\mathbf{x}_{\\text{target}} = (2, 0, 1, 0)^T$。然而，一项新的实验测量要求模型满足条件 $P(\\pi/3) = 1$。该工程师决定找到一个系数向量 $\\mathbf{x}^*$，它在最小二乘意义下最接近理想向量 $\\mathbf{x}_{\\text{target}}$，同时满足实验约束。这意味着要最小化欧几里得范数的平方 $\\|\\mathbf{x} - \\mathbf{x}_{\\text{target}}\\|^2$。确定最优系数向量 $\\mathbf{x}^* = (c_1^*, c_2^*, c_3^*, c_4^*)^T$ 的分量。将你的答案表示为一个包含这四个系数的行矩阵，并以精确分数形式给出。", "solution": "我们在一个线性约束条件下最小化欧几里得距离的平方。设 $\\mathbf{x}=(c_{1},c_{2},c_{3},c_{4})^{T}$，$\\mathbf{x}_{\\text{target}}=\\mathbf{x}_{0}=(2,0,1,0)^{T}$，且约束为 $P(\\pi/3)=1$。该约束可以写成 $\\mathbf{a}^{T}\\mathbf{x}=b$ 的形式，其中\n$$\n\\mathbf{a}=\\begin{pmatrix}\\cos(\\pi/3)\\\\ \\sin(\\pi/3)\\\\ \\cos(2\\pi/3)\\\\ \\sin(2\\pi/3)\\end{pmatrix}\n=\\begin{pmatrix}\\frac{1}{2}\\\\ \\frac{\\sqrt{3}}{2}\\\\ -\\frac{1}{2}\\\\ \\frac{\\sqrt{3}}{2}\\end{pmatrix},\\quad b=1.\n$$\n我们通过正交投影（等价于拉格朗日乘子法）来求解这个带约束的最小二乘问题。标准结果为\n$$\n\\mathbf{x}^{*}=\\mathbf{x}_{0}+\\frac{b-\\mathbf{a}^{T}\\mathbf{x}_{0}}{\\|\\mathbf{a}\\|^{2}}\\,\\mathbf{a}.\n$$\n计算所需的量：\n$$\n\\|\\mathbf{a}\\|^{2}=\\left(\\frac{1}{2}\\right)^{2}+\\left(\\frac{\\sqrt{3}}{2}\\right)^{2}+\\left(-\\frac{1}{2}\\right)^{2}+\\left(\\frac{\\sqrt{3}}{2}\\right)^{2}=\\frac{1}{4}+\\frac{3}{4}+\\frac{1}{4}+\\frac{3}{4}=2,\n$$\n$$\n\\mathbf{a}^{T}\\mathbf{x}_{0}=2\\cdot\\frac{1}{2}+0\\cdot\\frac{\\sqrt{3}}{2}+1\\cdot\\left(-\\frac{1}{2}\\right)+0\\cdot\\frac{\\sqrt{3}}{2}=\\frac{1}{2}.\n$$\n因此\n$$\n\\frac{b-\\mathbf{a}^{T}\\mathbf{x}_{0}}{\\|\\mathbf{a}\\|^{2}}=\\frac{1-\\frac{1}{2}}{2}=\\frac{1}{4},\n$$\n所以\n$$\n\\mathbf{x}^{*}=\\mathbf{x}_{0}+\\frac{1}{4}\\mathbf{a}=\\begin{pmatrix}2\\\\ 0\\\\ 1\\\\ 0\\end{pmatrix}+\\frac{1}{4}\\begin{pmatrix}\\frac{1}{2}\\\\ \\frac{\\sqrt{3}}{2}\\\\ -\\frac{1}{2}\\\\ \\frac{\\sqrt{3}}{2}\\end{pmatrix}=\\begin{pmatrix}\\frac{17}{8}\\\\ \\frac{\\sqrt{3}}{8}\\\\ \\frac{7}{8}\\\\ \\frac{\\sqrt{3}}{8}\\end{pmatrix}.\n$$\n直接验证表明，使用这些系数时 $P(\\pi/3)=1$，并且根据构造，它们是在欧几里得范数意义下最接近 $\\mathbf{x}_{\\text{target}}$ 的。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{17}{8} & \\frac{\\sqrt{3}}{8} & \\frac{7}{8} & \\frac{\\sqrt{3}}{8}\\end{pmatrix}}$$", "id": "2173359"}]}