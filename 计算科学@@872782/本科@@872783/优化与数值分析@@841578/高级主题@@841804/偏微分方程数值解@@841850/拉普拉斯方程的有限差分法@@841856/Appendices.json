{"hands_on_practices": [{"introduction": "第一个练习是关于有限差分法的基本步骤：将一个连续的偏微分方程转化为一个离散的代数方程组。通过考虑一个简单的 $2 \\times 2$ 网格，我们可以清楚地看到五点差分格式在每个内部节点上如何产生一个线性系统，该系统可以用一个系数矩阵来表示。这个练习旨在巩固物理问题与其数值表示之间的联系。[@problem_id:2101988]", "problem": "考虑一根长的中空导电管，其在 $xy$ 平面上的横截面为方形，由区域 $0 \\le x \\le L$ 和 $0 \\le y \\le L$ 定义。管壁保持在恒定的静电势 $V_0$。在远离管端的地方，管内的静电势 $V(x,y)$ 由二维拉普拉斯方程决定：\n$$\n\\frac{\\partial^2 V}{\\partial x^2} + \\frac{\\partial^2 V}{\\partial y^2} = 0\n$$\n为了找到电势的近似解，我们可以使用有限差分法。我们在两个方向上使用均匀的网格间距 $h = L/3$ 对区域进行离散化。这在位置 $(ih, jh)$（其中 $i,j \\in \\{1, 2\\}$）处创建了四个内部网格点。令 $V_{ij}$ 表示这些内部点处的电势 $V(ih, jh)$。\n\n每个内部网格点处的电势值近似为其四个最近邻点电势的平均值（五点差分格式法），这可以从拉普拉斯方程的离散形式经代数重排得到：\n$$\n4V_{ij} - V_{i+1,j} - V_{i-1,j} - V_{i,j+1} - V_{i,j-1} = 0\n$$\n将此关系应用于四个内部点中的每一个，并使用已知的边界电势，可以得到一个包含四个未知电势的四元线性方程组。该方程组可以写成矩阵形式 $A\\mathbf{v} = \\mathbf{b}$。\n\n设未知电势向量按列排序为 $\\mathbf{v} = [V_{11}, V_{12}, V_{21}, V_{22}]^T$。求系数矩阵 $A$ 的行列式的数值。", "solution": "对于每个内部节点 $(i,j)\\in\\{(1,1),(1,2),(2,1),(2,2)\\}$，离散拉普拉斯方程的五点差分格式给出：\n$$\n4V_{ij} - V_{i+1,j} - V_{i-1,j} - V_{i,j+1} - V_{i,j-1} = 0.\n$$\n将已知的边界值移到右侧，未知数的系数保持不变。明确写出方程并将未知数排序为 $\\mathbf{v}=[V_{11},V_{12},V_{21},V_{22}]^{T}$，得到：\n- 在点 $(1,1)$ 处：$4V_{11} - V_{12} - V_{21} = V_{01}+V_{10}$。\n- 在点 $(1,2)$ 处：$-V_{11} + 4V_{12} - V_{22} = V_{02}+V_{13}$。\n- 在点 $(2,1)$ 处：$-V_{11} + 4V_{21} - V_{22} = V_{31}+V_{20}$。\n- 在点 $(2,2)$ 处：$-V_{12} - V_{21} + 4V_{22} = V_{32}+V_{23}$。\n\n因此，系数矩阵 $A$（与边界值无关）为：\n$$\nA=\\begin{pmatrix}\n4  -1  -1  0\\\\\n-1  4  0  -1\\\\\n-1  0  4  -1\\\\\n0  -1  -1  4\n\\end{pmatrix}.\n$$\n将 $A$ 分成 $2\\times 2$ 的分块矩阵，形式如下：\n$$\nA=\\begin{pmatrix}B  C\\\\ C  B\\end{pmatrix},\\quad\nB=\\begin{pmatrix}4  -1\\\\ -1  4\\end{pmatrix},\\quad\nC=\\begin{pmatrix}-1  0\\\\ 0  -1\\end{pmatrix},\n$$\n我们使用标准的块对角化方法，可得：\n$$\n\\det(A)=\\det(B+C)\\,\\det(B-C).\n$$\n计算\n$$\nB+C=\\begin{pmatrix}3  -1\\\\ -1  3\\end{pmatrix},\\quad \\det(B+C)=3\\cdot 3-(-1)(-1)=8,\n$$\n$$\nB-C=\\begin{pmatrix}5  -1\\\\ -1  5\\end{pmatrix},\\quad \\det(B-C)=5\\cdot 5-(-1)(-1)=24.\n$$\n因此，\n$$\n\\det(A)=8\\times 24=192.\n$$", "answer": "$$\\boxed{192}$$", "id": "2101988"}, {"introduction": "一旦我们得到了一个线性方程组，就需要一种方法来求解它，特别是对于由精细网格产生的庞大系统。本练习将介绍雅可比法，这是求解此类系统的最简单的迭代技术之一。通过手动执行一次完整的迭代，您将具体地理解这些方法如何仅利用相邻点的信息，逐步将初始猜测值修正为最终的正确解。[@problem_id:2172039]", "problem": "考虑在一个方形无电荷区域内确定静电势 $u(x,y)$ 的问题。该电势满足二维拉普拉斯方程：\n$$\n\\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2} = 0\n$$\n该区域被离散化为一个由点 $(x_i, y_j)$ 组成的均匀网格，其中 $x_i = i \\cdot h$ 且 $y_j = j \\cdot h$，对于 $i,j \\in \\{0, 1, 2, 3\\}$。网格间距 $h$ 是一个常数。该网格产生四个内部点：$(x_1, y_1)$、$(x_1, y_2)$、$(x_2, y_1)$ 和 $(x_2, y_2)$。设这些网格点上的电势表示为 $u_{ij} = u(x_i, y_j)$。\n\n边界上的电势是固定的。与内部网格点相邻的边界点上的值如下：\n- 左边界上：$u_{0,1} = 21.0$ V 且 $u_{0,2} = 21.0$ V。\n- 右边界上：$u_{3,1} = 41.0$ V 且 $u_{3,2} = 41.0$ V。\n- 下边界上：$u_{1,0} = 9.0$ V 且 $u_{2,0} = 9.0$ V。\n- 上边界上：$u_{1,3} = 81.0$ V 且 $u_{2,3} = 81.0$ V。\n\n拉普拉斯方程使用标准的五点中心差分格式进行近似，该格式将一个内部点的电势与其四个最近邻点联系起来。使用雅可比法求解所得到的线性方程组。\n\n从所有四个内部点（其中 $i,j \\in \\{1,2\\}$）的初始猜测值 $u_{ij}^{(0)} = 0$ V 开始，计算经过一次完整的雅可比法迭代后这些点上电势的数值。\n\n按此特定顺序提供 $u_{11}, u_{12}, u_{21}, u_{22}$ 的更新后电势值。最终答案应为一组四个数字。最终答案中不要包含单位。", "solution": "在均匀网格上使用标准五点中心差分格式离散化的二维拉普拉斯方程，对于内部节点 $(i,j)$，可得：\n$$\n\\frac{u_{i+1,j}-2u_{i,j}+u_{i-1,j}}{h^{2}}+\\frac{u_{i,j+1}-2u_{i,j}+u_{i,j-1}}{h^{2}}=0,\n$$\n化简后得到平均值关系式\n$$\nu_{i,j}=\\frac{1}{4}\\left(u_{i+1,j}+u_{i-1,j}+u_{i,j+1}+u_{i,j-1}\\right).\n$$\n雅可比迭代使用前一次迭代的邻近点值来更新每个内部点：\n$$\nu_{i,j}^{(k+1)}=\\frac{1}{4}\\left(u_{i+1,j}^{(k)}+u_{i-1,j}^{(k)}+u_{i,j+1}^{(k)}+u_{i,j-1}^{(k)}\\right),\n$$\n其中边界值保持不变。使用初始猜测值 $u_{ij}^{(0)}=0$（对于 $i,j\\in\\{1,2\\}$）和给定的边界数据，第一次迭代的更新如下：\n\n对于 $u_{11}$：\n$$\nu_{11}^{(1)}=\\frac{1}{4}\\left(u_{21}^{(0)}+u_{01}+u_{12}^{(0)}+u_{10}\\right)=\\frac{1}{4}\\left(0+21+0+9\\right)=7.5.\n$$\n\n对于 $u_{12}$：\n$$\nu_{12}^{(1)}=\\frac{1}{4}\\left(u_{22}^{(0)}+u_{02}+u_{13}+u_{11}^{(0)}\\right)=\\frac{1}{4}\\left(0+21+81+0\\right)=25.5.\n$$\n\n对于 $u_{21}$：\n$$\nu_{21}^{(1)}=\\frac{1}{4}\\left(u_{31}+u_{11}^{(0)}+u_{22}^{(0)}+u_{20}\\right)=\\frac{1}{4}\\left(41+0+0+9\\right)=12.5.\n$$\n\n对于 $u_{22}$：\n$$\nu_{22}^{(1)}=\\frac{1}{4}\\left(u_{32}+u_{12}^{(0)}+u_{23}+u_{21}^{(0)}\\right)=\\frac{1}{4}\\left(41+0+81+0\\right)=30.5.\n$$\n\n因此，从零开始经过一次雅可比迭代后，按顺序 $(u_{11},u_{12},u_{21},u_{22})$ 排列的更新后电势值为 $(7.5,25.5,12.5,30.5)$。", "answer": "$$\\boxed{7.5, 25.5, 12.5, 30.5}$$", "id": "2172039"}, {"introduction": "一个数值解只有在我们能够信任其准确性时才是有用的。最后一个练习探讨了收敛性的概念，这对于验证数值方法的可靠性至关重要。通过将两个不同网格上的有限差分解的误差与已知的精确解进行比较，我们可以凭经验检验该方法是否达到了其理论精度阶数，从而建立对其结果的信心。[@problem_id:2102014]", "problem": "考虑一个薄方形金属板上的稳态温度分布 $u(x, y)$。该温度由拉普拉斯方程 $\\frac{\\partial^2 u}{\\partial x^2} + \\frac{\\partial^2 u}{\\partial y^2} = 0$ 控制，定义在由 $0 \\le x \\le 1$ 和 $0 \\le y \\le 1$ 给出的单位正方形区域上。\n\n对于施加在边界上的一组特定热源，已知的精确解析解为 $u_{exact}(x, y) = \\sin(\\pi x) \\sinh(\\pi y)$。因此，该问题的边界条件由该函数在正方形边界上的取值确定。\n\n你的任务是数值研究该问题标准有限差分法的收敛性。该区域被离散化为一个由点 $(x_i, y_j)$ 组成的网格，其中 $x_i = i h$ 且 $y_j = j h$，$h$ 是均匀的网格间距。拉普拉斯方程在每个内部网格点上使用标准的二阶中心差分近似进行逼近，该近似将一个点上的值与其四个最近邻点的值联系起来。\n\n你的分析将涉及两种不同的网格间距：\n\n1.  首先，考虑一个间距为 $h_1 = 1/2$ 的粗网格。该网格只有一个内部点。计算该内部点温度的数值近似值，我们称之为 $u_{num,1}$。然后，确定该点对应的绝对误差 $E_1 = |u_{exact} - u_{num,1}|$。注意，对于只有一个内部点的网格，该点的误差也是网格上的最大误差。\n\n2.  接下来，对于一个间距为 $h_2 = 1/4$ 的更精细的网格，其数值解已预先计算好。在这个更精细的网格上所有内部点的最大绝对误差，定义为 $E_2 = \\max |u_{exact}(x_i, y_j) - u_{num,2}(x_i, y_j)|$，已知约为 $E_2 \\approx 0.1878$。\n\n该数值方法的理论精度阶为2，这意味着最大误差 $E$ 应与网格间距 $h$ 满足关系 $E \\approx K h^2$（其中 $K$ 为某个常数），尤其是在 $h$ 变得非常小时。\n\n使用你计算出的 $E_1$ 值和给定的 $E_2$ 值，计算最大误差之比 $R = E_1 / E_2$ 的数值。将你的最终答案四舍五入到三位有效数字。", "solution": "我们在单位正方形上求解拉普拉斯方程，其狄利克雷边界数据取自精确解 $u_{exact}(x,y)=\\sin(\\pi x)\\sinh(\\pi y)$。对于网格间距为 $h$ 的内部网格点 $(i,j)$，标准的二阶五点有限差分格式为\n$$\n\\frac{u_{i+1,j}-2u_{i,j}+u_{i-1,j}}{h^{2}}+\\frac{u_{i,j+1}-2u_{i,j}+u_{i,j-1}}{h^{2}}=0,\n$$\n这等价于\n$$\n4u_{i,j}=u_{i+1,j}+u_{i-1,j}+u_{i,j+1}+u_{i,j-1}.\n$$\n\n对于 $h_{1}=1/2$，网格点为 $x_{i}=ih_{1}$，$y_{j}=jh_{1}$，其中 $i,j\\in\\{0,1,2\\}$。在 $(i,j)=(1,1)$ 处有一个唯一的内部点，即 $(x,y)=(1/2,1/2)$。它的四个邻点是位于 $(0,1/2)$、$(1,1/2)$、$(1/2,0)$ 和 $(1/2,1)$ 的边界点，其狄利克雷值由 $u_{exact}$ 给出：\n$$\nu(0,1/2)=\\sin(0)\\sinh\\!\\left(\\frac{\\pi}{2}\\right)=0,\\quad\nu(1,1/2)=\\sin(\\pi)\\sinh\\!\\left(\\frac{\\pi}{2}\\right)=0,\n$$\n$$\nu(1/2,0)=\\sin\\!\\left(\\frac{\\pi}{2}\\right)\\sinh(0)=0,\\quad\nu(1/2,1)=\\sin\\!\\left(\\frac{\\pi}{2}\\right)\\sinh(\\pi)=\\sinh(\\pi).\n$$\n因此，有限差分方程给出的内部点数值解是这些邻点值的平均值：\n$$\nu_{num,1}(1/2,1/2)=\\frac{1}{4}\\left[0+0+0+\\sinh(\\pi)\\right]=\\frac{1}{4}\\sinh(\\pi).\n$$\n该点的精确值为\n$$\nu_{exact}(1/2,1/2)=\\sin\\!\\left(\\frac{\\pi}{2}\\right)\\sinh\\!\\left(\\frac{\\pi}{2}\\right)=\\sinh\\!\\left(\\frac{\\pi}{2}\\right).\n$$\n因此，单个内部点的绝对误差（也就是该粗网格上的最大误差）为\n$$\nE_{1}=\\left|\\sinh\\!\\left(\\frac{\\pi}{2}\\right)-\\frac{1}{4}\\sinh(\\pi)\\right|.\n$$\n数值上，\n$$\n\\sinh(\\pi)\\approx 11.548739357257748,\\qquad \\sinh\\!\\left(\\frac{\\pi}{2}\\right)\\approx 2.301298902307295,\n$$\n所以\n$$\nE_{1}\\approx \\left|2.301298902307295-\\frac{1}{4}\\cdot 11.548739357257748\\right|\\approx \\left|2.301298902307295-2.887184839314437\\right|\\approx 0.585885937007142.\n$$\n\n对于 $h_{2}=1/4$ 的更精细网格，我们已知 $E_{2}\\approx 0.1878$。因此最大误差之比为\n$$\nR=\\frac{E_{1}}{E_{2}}\\approx \\frac{0.585885937007142}{0.1878}\\approx 3.1197334238\\ldots\n$$\n四舍五入到三位有效数字，得到\n$$\nR\\approx 3.12.\n$$", "answer": "$$\\boxed{3.12}$$", "id": "2102014"}]}