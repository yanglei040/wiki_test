{"hands_on_practices": [{"introduction": "理论知识是基础，但真正的理解来自于实践。本章节将通过一系列动手实践，带你深入探索冯·诺依曼稳定性分析的应用。我们将从分析一个看似简单却存在根本缺陷的数值格式开始。这个练习将探讨著名的时间前向、空间居中（FTCS）格式在求解平流方程时的表现。通过这个实践，你不仅会证明其不稳定性，还将识别出哪种类型的误差增长最快，从而直观地理解这种不稳定性在计算结果中会呈现为什么样的形态。[@problem_id:2225581]", "problem": "考虑一维线性平流方程，它描述了量 $u(x,t)$ 以恒定正速度 $c$ 的输运过程：\n$$ \\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} = 0 $$\n一位工程师试图在空间步长为 $\\Delta x$、时间步长为 $\\Delta t$ 的均匀网格上数值求解该方程。他们采用了时间前向、空间中心 (FTCS) 差分格式，其有限差分方程如下：\n$$ \\frac{u_j^{n+1} - u_j^n}{\\Delta t} + c \\frac{u_{j+1}^n - u_{j-1}^n}{2\\Delta x} = 0 $$\n其中 $u_j^n$ 是 $u(j\\Delta x, n\\Delta t)$ 的数值近似。\n\n已知该格式是无条件不稳定的，这会导致任何初始的舍入误差随时间增长。误差可以分解为傅里叶模的叠加。波数为 $k$ 的单个傅里叶模从一个时间步到下一个时间步的演化由一个复数放大因子 $G(k)$ 控制。与该因子最大模 $|G(k)|$ 对应的模将增长最快，并最终在数值解中占主导地位。\n\n你的任务是确定增长最快的傅里叶模的具体波数 $k$。将此波数 $k$ 表示为以空间网格间距 $\\Delta x$ 为参数的符号表达式。", "solution": "考虑 FTCS 格式\n$$\\frac{u_{j}^{n+1}-u_{j}^{n}}{\\Delta t}+c\\,\\frac{u_{j+1}^{n}-u_{j-1}^{n}}{2\\Delta x}=0.$$\n通过代入单个傅里叶模进行冯·诺依曼分析\n$$u_{j}^{n}=\\hat{u}^{n}\\exp(i j \\theta),\\quad \\theta=k\\Delta x,$$\n并定义放大因子为 $u_{j}^{n+1}=G\\,u_{j}^{n}$。代入可得\n$$\\frac{G-1}{\\Delta t}+c\\,\\frac{\\exp(i\\theta)-\\exp(-i\\theta)}{2\\Delta x}=0.$$\n使用 $\\exp(i\\theta)-\\exp(-i\\theta)=2i\\sin\\theta$，我们得到\n$$\\frac{G-1}{\\Delta t}+c\\,\\frac{i\\sin\\theta}{\\Delta x}=0 \\quad\\Longrightarrow\\quad G=1-i\\nu\\sin\\theta,$$\n其中 $\\nu=\\frac{c\\,\\Delta t}{\\Delta x}$ 是库朗数。放大因子的模为\n$$|G|=\\sqrt{1+\\nu^{2}\\sin^{2}\\theta}.$$\n对于固定的 $\\nu$，当 $|G|$ 最大化时，每个时间步的增长也达到最大，这发生在 $|\\sin\\theta|$ 为最大值时。由于 $|\\sin\\theta|$ 在以下位置达到其最大值 $1$：\n$$\\theta=\\frac{\\pi}{2}+m\\pi,\\quad m\\in\\mathbb{Z},$$\n相应的波数满足\n$$k\\Delta x=\\frac{\\pi}{2}+m\\pi \\quad\\Longrightarrow\\quad k=\\frac{(2m+1)\\pi}{2\\Delta x}.$$\n限制在第一布里渊区中的主波数，可得出具体增长最快的模\n$$k=\\frac{\\pi}{2\\Delta x}.$$", "answer": "$$\\boxed{\\frac{\\pi}{2\\Delta x}}$$", "id": "2225581"}, {"introduction": "在上一个实践中，我们看到了一个总是失败的格式。现在，我们将研究一个其成败取决于具体物理情境的格式。这个练习将探讨时间前向、空间后向（FTBS）格式，这是一种“迎风”格式。你会发现，该格式的稳定性与波的传播方向密切相关，从而学到一堂关键的课程：数值方法必须尊重底层物理系统中的信息流动方向。[@problem_id:2225619]", "problem": "一位气象学家正在为冷锋开发一个一维数值模型。温度分布 $T(x,t)$ 由以下线性平流方程控制：\n$$\n\\frac{\\partial T}{\\partial t} + v \\frac{\\partial T}{\\partial x} = 0\n$$\n其中速度 $v$ 是一个负常数，表示锋面从右向左移动（沿 $x$ 轴负方向）。\n\n为了对该方程进行数值求解，我们定义一个网格，其均匀空间步长为 $\\Delta x$，时间步长为 $\\Delta t$。令 $T_j^n$ 表示在位置 $x_j = j\\Delta x$ 和时间 $t_n = n\\Delta t$ 时温度的数值近似。所提出的数值格式是一种前向时间、后向空间（FTBS）方法，其离散形式为：\n$$\n\\frac{T_j^{n+1} - T_j^n}{\\Delta t} + v \\frac{T_j^n - T_{j-1}^n}{\\Delta x} = 0\n$$\n\n该格式的稳定性通过库朗数进行分析，在本问题中我们将其定义为 $\\alpha = \\frac{v \\Delta t}{\\Delta x}$。注意，由于 $v  0$，库朗数 $\\alpha$ 也是负的。\n\n使用冯·诺依曼稳定性分析，确定该特定FTBS格式在给定平流问题（其中 $v  0$）中的稳定性。从以下选项中选择正确的结论。\n\nA) 该格式是稳定的，当且仅当 $-1 \\le \\alpha \\le 0$。\n\nB) 该格式是稳定的，当且仅当 $-2 \\le \\alpha \\le 0$。\n\nC) 对于所有有效的 $\\alpha  0$，该格式都是无条件稳定的。\n\nD) 对于任何 $\\alpha  0$，该格式都是无条件不稳定的。", "solution": "我们从FTBS离散化开始\n$$\n\\frac{T_{j}^{n+1}-T_{j}^{n}}{\\Delta t}+v\\frac{T_{j}^{n}-T_{j-1}^{n}}{\\Delta x}=0,\n$$\n它可以写成\n$$\nT_{j}^{n+1}=T_{j}^{n}-\\alpha\\left(T_{j}^{n}-T_{j-1}^{n}\\right),\n\\qquad \\alpha=\\frac{v\\Delta t}{\\Delta x}.\n$$\n通过代入一个傅里叶模 $T_{j}^{n}=\\hat{T}^{n}\\exp(i\\kappa j)$（其中 $\\kappa=k\\Delta x$）来进行冯·诺依曼分析。这得到 $T_{j-1}^{n}=\\exp(-i\\kappa)T_{j}^{n}$，因此由 $T_{j}^{n+1}=G\\,T_{j}^{n}$ 定义的放大因子 $G$ 满足\n$$\nG=1-\\alpha\\left(1-\\exp(-i\\kappa)\\right).\n$$\n其模的平方是\n$$\n|G|^{2}=\\left[1-\\alpha\\left(1-\\cos\\kappa\\right)\\right]^{2}+\\left[\\alpha\\sin\\kappa\\right]^{2}.\n$$\n使用 $(1-\\cos\\kappa)^{2}+\\sin^{2}\\kappa=2-2\\cos\\kappa$ 展开并化简得到\n$$\n|G|^{2}=1-2\\alpha(1-\\cos\\kappa)+\\alpha^{2}\\left(2-2\\cos\\kappa\\right)\n=1+2\\alpha(\\alpha-1)\\left(1-\\cos\\kappa\\right).\n$$\n为了保证稳定性，我们要求对于所有的 $\\kappa$ 都有 $|G|\\leq 1$，即\n$$\n|G|^{2}\\leq 1 \\quad \\text{for all } \\kappa.\n$$\n由于对所有 $\\kappa$ 都有 $1-\\cos\\kappa\\geq 0$，因此条件 $|G|^{2}\\leq 1$ 对所有 $\\kappa$ 成立等价于\n$$\n\\alpha(\\alpha-1)\\leq 0 \\quad \\Longleftrightarrow \\quad 0\\leq \\alpha \\leq 1.\n$$\n在本问题中，$v0$ 意味着 $\\alpha=\\frac{v\\Delta t}{\\Delta x}0$，因此对于任何有效的负 $\\alpha$ 值，稳定区间 $0\\leq \\alpha \\leq 1$ 都无法满足。因此，对于应用于向左平流（$v0$）的此FTBS格式，该方法对于任何 $\\alpha0$ 都是不稳定的。\n\n因此，正确的选项是该格式对于任何 $\\alpha0$ 都是无条件不稳定的。", "answer": "$$\\boxed{D}$$", "id": "2225619"}, {"introduction": "现实世界的问题往往涉及在多维空间中同时发生的多种物理过程。最后的这项实践将挑战你分析一个更贴近现实的场景：模拟由二维平流-扩散方程控制的烟雾。通过为迎风平流和中心扩散的组合格式推导稳定性条件，你将学会如何将来自不同物理现象的稳定性约束综合成一个统一、全面的规则，以确保模拟的稳定。[@problem_id:2449689]", "problem": "考虑一个用于模拟计算机图形学中烟雾密度的无源标量场 $\\rho(x,y,t)$ 的二维输运，该过程由以下线性对流-扩散方程控制：\n$$\n\\partial_t \\rho + u_x \\,\\partial_x \\rho + u_y \\,\\partial_y \\rho \\;=\\; \\kappa \\left(\\partial_{xx} \\rho + \\partial_{yy} \\rho\\right),\n$$\n其中 $u_x$ 和 $u_y$ 是恒定速度，单位为 $\\mathrm{m/s}$，$\\kappa$ 是恒定扩散系数，单位为 $\\mathrm{m^2/s}$。计算域在具有间距 $\\Delta x$ 和 $\\Delta y$（单位为 $\\mathrm{m}$）的均匀笛卡尔网格上进行离散化，并在两个空间方向上施加周期性边界条件。\n\n定义一个完全显式的有限差分时间步进格式，时间步长为 $\\Delta t$（单位为 $\\mathrm{s}$），如下所示：\n- 时间导数由时间上的前向差分近似。\n- $x$ 和 $y$ 方向的对流项使用由 $u_x$ 和 $u_y$ 各自的符号决定的一阶迎风差分。具体来说，对于网格索引 $(i,j)$ 处的 $x$ 方向导数，\n$$\n\\partial_x \\rho \\approx\n\\begin{cases}\n\\displaystyle \\frac{\\rho_{i,j}^n - \\rho_{i-1,j}^n}{\\Delta x},  \\text{若 } u_x \\ge 0,\\\n$$1em]\n\\displaystyle \\frac{\\rho_{i+1,j}^n - \\rho_{i,j}^n}{\\Delta x},  \\text{若 } u_x  0,\n\\end{cases}\n$$\n$y$ 方向导数也类似，使用 $\\Delta y$ 和 $u_y$ 的符号。\n- 扩散项在每个空间方向上使用标准的二阶中心差分，即5点拉普拉斯模板。\n\n假设周期性边界条件和空间无限傅里叶分解，因此可以通过要求所有离散傅里叶模态的增长因子模长不超过 $1$ 来评估稳定性。请根据 $u_x$、 $u_y$、 $\\kappa$、 $\\Delta x$ 和 $\\Delta y$ 确定最大时间步长 $\\Delta t_{\\max}$（单位为 $\\mathrm{s}$），使得该格式在上述意义下对所有傅里叶模态都是稳定的。然后，对于下面测试套件中的每个参数集，计算 $\\Delta t_{\\max}$，并通过检查 $\\Delta t \\le \\Delta t_{\\max}$ 来判断给定的 $\\Delta t$ 是否稳定。\n\n所有速度 $u_x$ 和 $u_y$ 必须以 $\\mathrm{m/s}$ 为单位，扩散系数 $\\kappa$ 以 $\\mathrm{m^2/s}$ 为单位，网格间距 $\\Delta x$ 和 $\\Delta y$ 以 $\\mathrm{m}$ 为单位，时间步长 $\\Delta t$ 和 $\\Delta t_{\\max}$ 以 $\\mathrm{s}$ 为单位。最终的 $\\Delta t_{\\max}$ 值以 $\\mathrm{s}$ 为单位表示，并四舍五入到 $6$ 位小数。稳定性指标必须是一个布尔值，约定 $\\text{True}$ 表示稳定，$\\text{False}$ 表示不稳定。\n\n测试套件（每个案例为 $(u_x,u_y,\\kappa,\\Delta x,\\Delta y,\\Delta t)$，单位如上所述）：\n- 案例 $1$： $(+1.0,\\,-0.5,\\,0.01,\\,0.02,\\,0.02,\\,0.004)$\n- 案例 $2$： $(+0.4,\\,+0.6,\\,0.0,\\,1.0,\\,1.0,\\,1.0)$\n- 案例 $3$： $(0.0,\\,0.0,\\,0.2,\\,0.5,\\,0.25,\\,0.125)$\n- 案例 $4$： $(-2.0,\\,0.0,\\,0.0,\\,0.01,\\,0.01,\\,0.006)$\n- 案例 $5$： $(0.0,\\,0.0,\\,0.001,\\,0.005,\\,0.01,\\,0.02)$\n- 案例 $6$： $(+3.0,\\,+1.0,\\,0.05,\\,0.1,\\,0.2,\\,0.05)$\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个条目是一个二元列表 $[\\Delta t_{\\max},\\,\\text{is\\_stable}]$，按给定顺序对应于各个案例。例如，输出格式必须类似于\n$[[\\Delta t_{\\max,1},\\text{is\\_stable}_1],[\\Delta t_{\\max,2},\\text{is\\_stable}_2],\\dots]$，\n其中每个 $\\Delta t_{\\max}$ 四舍五入到 $6$ 位小数，每个 $\\text{is\\_stable}$ 是一个布尔值。", "solution": "标量场 $\\rho(x,y,t)$ 输运的控制偏微分方程(PDE)由下式给出：\n$$\n\\partial_t \\rho + u_x \\,\\partial_x \\rho + u_y \\,\\partial_y \\rho \\;=\\; \\kappa \\left(\\partial_{xx} \\rho + \\partial_{yy} \\rho\\right)\n$$\n此处，$u_x$ 和 $u_y$ 是恒定对流速度，$\\kappa$ 是恒定扩散系数。计算域是一个间距为 $\\Delta x$ 和 $\\Delta y$ 的均匀笛卡尔网格。\n\n问题指定了一个完全显式的有限差分格式。我们通过将每个导数替换为其有限差分近似来离散化该PDE。令 $\\rho_{i,j}^n$ 表示在时间 $n\\Delta t$、网格点 $(i\\Delta x, j\\Delta y)$ 处 $\\rho$ 的值。\n\n1.  **时间导数**：使用时间前向差分（前向欧拉法）：\n    $$ \\partial_t \\rho \\approx \\frac{\\rho_{i,j}^{n+1} - \\rho_{i,j}^n}{\\Delta t} $$\n\n2.  **对流项**：使用一阶迎风差分。模板点的选择取决于速度分量的符号。这可以使用记号 $u^+ = \\max(u, 0)$ 和 $u^- = \\min(u, 0)$（其中 $u = u^+ + u^-$）来紧凑地表示。空间导数 $\\partial_x \\rho$ 近似为：\n    $$ u_x \\partial_x \\rho \\approx u_x^+ \\frac{\\rho_{i,j}^n - \\rho_{i-1,j}^n}{\\Delta x} + u_x^- \\frac{\\rho_{i+1,j}^n - \\rho_{i,j}^n}{\\Delta x} $$\n    对于 $u_y \\partial_y \\rho$ 存在类似的表达式。注意 $u_x^+ - u_x^- = |u_x|$。\n\n3.  **扩散项**：对于拉普拉斯算子 $\\nabla^2 \\rho = \\partial_{xx} \\rho + \\partial_{yy} \\rho$，使用标准的二阶中心差分：\n    $$ \\kappa \\nabla^2 \\rho \\approx \\kappa \\left( \\frac{\\rho_{i+1,j}^n - 2\\rho_{i,j}^n + \\rho_{i-1,j}^n}{(\\Delta x)^2} + \\frac{\\rho_{i,j+1}^n - 2\\rho_{i,j}^n + \\rho_{i,j-1}^n}{(\\Delta y)^2} \\right) $$\n\n将这些近似代入PDE并求解 $\\rho_{i,j}^{n+1}$，得到完整的更新规则：\n$$ \\frac{\\rho_{i,j}^{n+1} - \\rho_{i,j}^n}{\\Delta t} = - \\left( u_x^+ \\frac{\\rho_{i,j}^n - \\rho_{i-1,j}^n}{\\Delta x} + u_x^- \\frac{\\rho_{i+1,j}^n - \\rho_{i,j}^n}{\\Delta x} \\right) - \\left( u_y^+ \\frac{\\rho_{i,j}^n - \\rho_{i,j-1}^n}{\\Delta y} + u_y^- \\frac{\\rho_{i,j+1}^n - \\rho_{i,j}^n}{\\Delta y} \\right) + \\kappa \\left( \\frac{\\rho_{i+1,j}^n - 2\\rho_{i,j}^n + \\rho_{i-1,j}^n}{(\\Delta x)^2} + \\frac{\\rho_{i,j+1}^n - 2\\rho_{i,j}^n + \\rho_{i,j-1}^n}{(\\Delta y)^2} \\right) $$\n我们可以通过收集不同模板点上 $\\rho^n$ 值的系数来重排此方程：\n$$\n\\begin{aligned}\n\\rho_{i,j}^{n+1} =  \\left(1 - \\frac{\\Delta t}{\\Delta x}(u_x^+ - u_x^-) - \\frac{\\Delta t}{\\Delta y}(u_y^+ - u_y^-) - 2\\kappa \\frac{\\Delta t}{(\\Delta x)^2} - 2\\kappa \\frac{\\Delta t}{(\\Delta y)^2}\\right) \\rho_{i,j}^n \\\\\n + \\left(\\frac{u_x^+ \\Delta t}{\\Delta x} + \\frac{\\kappa \\Delta t}{(\\Delta x)^2}\\right) \\rho_{i-1,j}^n + \\left(-\\frac{u_x^- \\Delta t}{\\Delta x} + \\frac{\\kappa \\Delta t}{(\\Delta x)^2}\\right) \\rho_{i+1,j}^n \\\\\n + \\left(\\frac{u_y^+ \\Delta t}{\\Delta y} + \\frac{\\kappa \\Delta t}{(\\Delta y)^2}\\right) \\rho_{i,j-1}^n + \\left(-\\frac{u_y^- \\Delta t}{\\Delta y} + \\frac{\\kappa \\Delta t}{(\\Delta y)^2}\\right) \\rho_{i,j+1}^n\n\\end{aligned}\n$$\n使用恒等式 $u_x^+ - u_x^- = |u_x|$ 和 $u_y^+ - u_y^- = |u_y|$，$\\rho_{i,j}^n$ 的系数简化为：\n$$ C_{i,j} = 1 - \\frac{|u_x|\\Delta t}{\\Delta x} - \\frac{|u_y|\\Delta t}{\\Delta y} - 2\\kappa\\Delta t \\left(\\frac{1}{(\\Delta x)^2} + \\frac{1}{(\\Delta y)^2}\\right) $$\n对于 von Neumann 稳定性，我们要求对于任何傅里叶模态，增长因子 $|G|$ 的模长不超过 $1$。一个充分的稳定性条件（对于此格式也是必要的）是 $\\rho_{i,j}^{n+1}$ 的更新是前一时间步值的凸组合。这要求模板系数满足两个条件：\n1.  所有系数必须为非负。\n2.  所有系数之和必须等于 $1$。\n\n让我们验证系数之和。将所有系数相加得到：\n$$ C_{sum} = (C_{i,j}) + \\left(\\frac{u_x^+\\Delta t}{\\Delta x} + \\dots\\right) + \\left(\\frac{-u_x^-\\Delta t}{\\Delta x} + \\dots\\right) + \\dots = 1 $$\n这是因为涉及 $\\Delta t$ 的项会抵消。例如，与 $x$ 方向相关的项之和为：\n$$ \\left(1 - \\frac{|u_x|\\Delta t}{\\Delta x}\\right) + \\left(\\frac{u_x^+\\Delta t}{\\Delta x}\\right) + \\left(\\frac{-u_x^-\\Delta t}{\\Delta x}\\right) = 1 - \\frac{(u_x^+ - u_x^-)\\Delta t}{\\Delta x} + \\frac{(u_x^+ - u_x^-)\\Delta t}{\\Delta x} = 1 $$\n和确实为 $1$。现在我们强制要求非负性。\n-   $\\rho_{i-1,j}^n$ 的系数： $(\\frac{u_x^+ \\Delta t}{\\Delta x} + \\frac{\\kappa \\Delta t}{(\\Delta x)^2}) \\ge 0$。此式成立，因为 $u_x^+ \\ge 0$ 且 $\\kappa \\ge 0$。\n-   $\\rho_{i+1,j}^n$ 的系数： $(-\\frac{u_x^- \\Delta t}{\\Delta x} + \\frac{\\kappa \\Delta t}{(\\Delta x)^2}) \\ge 0$。此式成立，因为 $u_x^- \\le 0$ 且 $\\kappa \\ge 0$。\n-   类似地，$\\rho_{i,j-1}^n$ 和 $\\rho_{i,j+1}^n$ 的系数也是非负的。\n\n唯一剩下的约束来自于要求 $\\rho_{i,j}^n$ 的系数为非负：\n$$ 1 - \\frac{|u_x|\\Delta t}{\\Delta x} - \\frac{|u_y|\\Delta t}{\\Delta y} - 2\\kappa\\Delta t \\left(\\frac{1}{(\\Delta x)^2} + \\frac{1}{(\\Delta y)^2}\\right) \\ge 0 $$\n对 $\\Delta t$ 求解：\n$$ \\Delta t \\left(\\frac{|u_x|}{\\Delta x} + \\frac{|u_y|}{\\Delta y} + 2\\kappa \\left(\\frac{1}{(\\Delta x)^2} + \\frac{1}{(\\Delta y)^2}\\right)\\right) \\le 1 $$\n这给出了时间步长 $\\Delta t_{\\max}$ 的稳定性极限。如果分母为零（即 $u_x=u_y=0$ 且 $\\kappa=0$），则该格式是无条件稳定的，$\\Delta t_{\\max}$ 为无穷大。否则：\n$$ \\Delta t_{\\max} = \\frac{1}{\\frac{|u_x|}{\\Delta x} + \\frac{|u_y|}{\\Delta y} + 2\\kappa \\left(\\frac{1}{(\\Delta x)^2} + \\frac{1}{(\\Delta y)^2}\\right)} $$\n当且仅当所选的时间步长 $\\Delta t$ 满足 $\\Delta t \\le \\Delta t_{\\max}$ 时，数值格式是稳定的。\n\n我们现在将此公式应用于每个测试案例。\n-   **案例 1**： $\\Delta t_{\\max} = 1 / (|1.0|/0.02 + |-0.5|/0.02 + 2(0.01)(1/0.02^2 + 1/0.02^2)) = 1 / (50 + 25 + 100) = 1/175 \\approx 0.005714$。由于 $\\Delta t=0.004 \\le 0.005714$，因此是稳定的。\n-   **案例 2**： $\\Delta t_{\\max} = 1 / (|0.4|/1.0 + |0.6|/1.0 + 0) = 1 / (0.4 + 0.6) = 1.0$。由于 $\\Delta t=1.0 \\le 1.0$，因此是稳定的。\n-   **案例 3**： $\\Delta t_{\\max} = 1 / (0 + 0 + 2(0.2)(1/0.5^2 + 1/0.25^2)) = 1 / (0.4(4 + 16)) = 1/8 = 0.125$。由于 $\\Delta t=0.125 \\le 0.125$，因此是稳定的。\n-   **案例 4**： $\\Delta t_{\\max} = 1 / (|-2.0|/0.01 + 0 + 0) = 1/200 = 0.005$。由于 $\\Delta t=0.006 > 0.005$，因此是不稳定的。\n-   **案例 5**： $\\Delta t_{\\max} = 1 / (0 + 0 + 2(0.001)(1/0.005^2 + 1/0.01^2)) = 1 / (0.002(40000 + 10000)) = 1/100 = 0.01$。由于 $\\Delta t=0.02 > 0.01$，因此是不稳定的。\n-   **案例 6**： $\\Delta t_{\\max} = 1 / (|3.0|/0.1 + |1.0|/0.2 + 2(0.05)(1/0.1^2 + 1/0.2^2)) = 1 / (30 + 5 + 0.1(100+25)) = 1/(35 + 12.5) = 1/47.5 \\approx 0.021053$。由于 $\\Delta t=0.05 > 0.021053$，因此是不稳定的。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the stability of a finite difference scheme for the 2D\n    advection-diffusion equation for a series of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (ux, uy, kappa, dx, dy, dt)\n    test_cases = [\n        (1.0, -0.5, 0.01, 0.02, 0.02, 0.004),\n        (0.4, 0.6, 0.0, 1.0, 1.0, 1.0),\n        (0.0, 0.0, 0.2, 0.5, 0.25, 0.125),\n        (-2.0, 0.0, 0.0, 0.01, 0.01, 0.006),\n        (0.0, 0.0, 0.001, 0.005, 0.01, 0.02),\n        (3.0, 1.0, 0.05, 0.1, 0.2, 0.05),\n    ]\n\n    results = []\n    for case in test_cases:\n        ux, uy, kappa, dx, dy, dt = case\n\n        # The stability condition is derived from requiring the coefficients of the\n        # explicit stencil to be non-negative. This yields:\n        # dt_max * ( |ux|/dx + |uy|/dy + 2*kappa*(1/dx^2 + 1/dy^2) ) = 1\n        \n        # Calculate the terms in the denominator of the dt_max expression.\n        advection_term_x = abs(ux) / dx\n        advection_term_y = abs(uy) / dy\n        diffusion_term = 2 * kappa * (1 / dx**2 + 1 / dy**2)\n        \n        denominator = advection_term_x + advection_term_y + diffusion_term\n\n        # If the denominator is zero, the scheme is unconditionally stable.\n        if denominator == 0:\n            dt_max = float('inf')\n        else:\n            dt_max = 1 / denominator\n\n        # Check if the given time step dt is stable.\n        is_stable = dt = dt_max\n        \n        # Format the result for the current case.\n        # dt_max is rounded to 6 decimal places.\n        formatted_result = [round(dt_max, 6), is_stable]\n        results.append(formatted_result)\n\n    # Final print statement in the exact required format.\n    # Using str() on the list of lists produces the required output format.\n    # Replace single quotes with double quotes for JSON-like but not strict JSON format\n    # and remove spaces.\n    print(str(results).replace(\"'\", \"\").replace(\" \", \"\"))\n\nsolve()\n```", "id": "2449689"}]}