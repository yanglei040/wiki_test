{"hands_on_practices": [{"introduction": "预处理的一个最直观的应用是解决矩阵中元素数值差异过大的问题。当一个线性方程组的某些行或列的数值尺度远大于其他部分时，迭代求解器可能会遇到困难。通过一个简单的对角“缩放”矩阵，我们可以平衡方程组，为迭代方法创造一个更“公平”的竞争环境。这个练习将向你展示如何通过行均衡（row equilibration）技术，构造一个对角预处理器来改善矩阵的性质。[@problem_id:2194457]", "problem": "考虑线性方程组 $Ax = b$，其中矩阵 $A$ 和向量 $b$ 由下式给出：\n$$\nA = \\begin{pmatrix} 2  -1  0 \\\\ 1000  2000  -1000 \\\\ 0  -1  2 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 1 \\\\ 0 \\\\ 1 \\end{pmatrix}\n$$\n我们观察到，通过将系统转换为一个等价的系统 $A'x = b'$，其中新矩阵 $A'$ 的各行具有更均匀的“大小”，可以改善许多迭代求解器的收敛性。这种转换是通过使用一个可逆矩阵 $P$ 来实现的，使得 $A' = PA$ 和 $b' = Pb$。\n\n你的任务是找到一个形如下式的对角矩阵 $P$\n$$\nP = \\begin{pmatrix} p_1  0  0 \\\\ 0  p_2  0 \\\\ 0  0  p_3 \\end{pmatrix}\n$$\n该矩阵对 $A$ 进行行平衡。具体来说，确定 $p_1, p_2,$ 和 $p_3$ 的值，使得所得矩阵 $A'$ 中每个行向量的无穷范数都等于 1。向量 $v = (v_1, v_2, \\dots, v_n)$ 的无穷范数定义为 $\\|v\\|_{\\infty} = \\max_{i} |v_i|$。为简单起见，可以假设 $P$ 的对角元素为正。\n\n将你的最终答案表示为 3x3 矩阵 $P$。", "solution": "我们寻求一个对角缩放矩阵 $P=\\operatorname{diag}(p_{1},p_{2},p_{3})$，使得 $A' = PA$ 的每一行的无穷范数都等于 $1$。设 $a_{i}^{T}$ 表示 $A$ 的第 $i$ 行。那么 $A'$ 的第 $i$ 行为 $p_{i}a_{i}^{T}$。由于 $p_{i}  0$，无穷范数的缩放关系如下：\n$$\n\\|p_{i}a_{i}^{T}\\|_{\\infty} = p_{i}\\|a_{i}^{T}\\|_{\\infty}.\n$$\n施加条件 $\\|p_{i}a_{i}^{T}\\|_{\\infty} = 1$ 可得\n$$\np_{i} = \\frac{1}{\\|a_{i}^{T}\\|_{\\infty}} \\quad \\text{for } i=1,2,3.\n$$\n计算 $A$ 的各行无穷范数：\n- 第 $1$ 行：$a_{1}^{T}=(2,-1,0)$，所以 $\\|a_{1}^{T}\\|_{\\infty}=\\max\\{|2|,|{-1}|,|0|\\}=2$，因此 $p_{1}=\\frac{1}{2}$。\n- 第 $2$ 行：$a_{2}^{T}=(1000,2000,-1000)$，所以 $\\|a_{2}^{T}\\|_{\\infty}=\\max\\{|1000|,|2000|,|-1000|\\}=2000$，因此 $p_{2}=\\frac{1}{2000}$。\n- 第 $3$ 行：$a_{3}^{T}=(0,-1,2)$，所以 $\\|a_{3}^{T}\\|_{\\infty}=\\max\\{|0|,|{-1}|,|2|\\}=2$，因此 $p_{3}=\\frac{1}{2}$。\n\n因此，\n$$\nP=\\begin{pmatrix}\n\\frac{1}{2}  0  0 \\\\\n0  \\frac{1}{2000}  0 \\\\\n0  0  \\frac{1}{2}\n\\end{pmatrix}.\n$$\n这个选择确保了 $A' = PA$ 的每一行的无穷范数都等于 $1$。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{1}{2}  0  0 \\\\ 0  \\frac{1}{2000}  0 \\\\ 0  0  \\frac{1}{2}\\end{pmatrix}}$$", "id": "2194457"}, {"introduction": "理想的预处理器能将原矩阵变换为一个条件数为1的矩阵，这会使得许多迭代方法在理论上仅需一步即可收敛。虽然在实践中构造完美的预处理器通常不可行，但通过一个简单的例子来探索这个“理想”情景，有助于我们深刻理解预处理的核心目标。在这个练习中，你将为一个$2 \\times 2$矩阵设计一个对角预处理器，使其预处理后的系统条件数恰好为1。[@problem_id:2194479]", "problem": "在数值线性代数中，迭代法常用于求解形如 $A\\mathbf{x} = \\mathbf{b}$ 的大型线性方程组的近似解。许多这类方法的效率很大程度上取决于系数矩阵 $A$ 的性质，特别是其条件数 $\\kappa(A)$。为了改善收敛性，使用了一种称为预处理的技术。原始系统被转换为一个等价的系统 $M\\mathbf{x} = \\mathbf{c}$，其中 $M = P^{-1}A$ 且 $\\mathbf{c} = P^{-1}\\mathbf{b}$。矩阵 $P$ 被称为预处理器，选择它的目的是使预处理矩阵 $M$ 的条件数 $\\kappa(M)$ 尽可能接近 1，同时确保 $P^{-1}$ 易于计算。\n\n考虑矩阵 $A$：\n$$A = \\begin{pmatrix} 1  2 \\\\ -4  2 \\end{pmatrix}$$\n我们正在寻找一个形如下式的对角预处理器 $P$：\n$$P = \\begin{pmatrix} p_1  0 \\\\ 0  p_2 \\end{pmatrix}$$\n其中 $p_1$ 和 $p_2$ 是正实数。\n\n求比值 $p_2/p_1$ 的值，使得预处理矩阵 $P^{-1}A$ 关于矩阵2-范数的条件数 $\\kappa_2(P^{-1}A)$ 恰好为 1。", "solution": "我们希望 $\\kappa_{2}(P^{-1}A)=1$。对于矩阵2-范数，$\\kappa_{2}(M)=1$ 的充要条件是存在 $\\alpha0$ 使得 $M^{T}M=\\alpha I$。设 $M=P^{-1}A$，其中 $P=\\mathrm{diag}(p_{1},p_{2})$ 且 $p_{1},p_{2}0$。则\n$$\nM^{T}M=A^{T}P^{-T}P^{-1}A=A^{T}P^{-2}A,\n$$\n因为 $P$ 是对角矩阵且对角元素为正。记 $D=P^{-2}=\\mathrm{diag}(d_{1},d_{2})$，其中 $d_{1}=p_{1}^{-2}$ 且 $d_{2}=p_{2}^{-2}$。我们寻求 $d_{1},d_{2}0$ 和 $\\alpha0$ 使得\n$$\nA^{T}DA=\\alpha I.\n$$\n对于 $A=\\begin{pmatrix} 1  2 \\\\ -4  2 \\end{pmatrix}$，我们计算矩阵乘积 $A^T D A$:\n$$\nA^{T}DA=\\begin{pmatrix}1  -4\\\\ 2  2\\end{pmatrix}\\begin{pmatrix}d_1  0 \\\\ 0  d_2\\end{pmatrix}\\begin{pmatrix}1  2 \\\\ -4  2\\end{pmatrix}\n=\\begin{pmatrix}d_{1}+16d_{2}  2d_{1}-8d_{2}\\\\ 2d_{1}-8d_{2}  4d_{1}+4d_{2}\\end{pmatrix}.\n$$\n为了使该矩阵等于 $\\alpha I$，非对角线元素必须为零，且对角线元素必须相等。非对角线条件给出\n$$\n2d_{1}-8d_{2}=0 \\quad \\Longrightarrow \\quad d_{1}=4d_{2}.\n$$\n有了这个关系，对角线元素自动相等：\n$$\nd_{1}+16d_{2}=4d_{2}+16d_{2}=20d_{2}, \\quad 4d_{1}+4d_{2}=16d_{2}+4d_{2}=20d_{2}.\n$$\n因此 $D$ 必须满足 $d_{1}=4d_{2}$。用 $p_{1},p_{2}$ 表示，这即是\n$$\np_{1}^{-2}=4p_{2}^{-2} \\quad \\Longrightarrow \\quad \\frac{p_{1}^{-2}}{p_{2}^{-2}}=4 \\quad \\Longrightarrow \\quad \\frac{p_{2}^{2}}{p_{1}^{2}}=4 \\quad \\Longrightarrow \\quad \\frac{p_{2}}{p_{1}}=2,\n$$\n利用 $p_{1},p_{2}0$。因此，$\\kappa_{2}(P^{-1}A)=1$ 当且仅当 $p_{2}/p_{1}=2$。", "answer": "$$\\boxed{2}$$", "id": "2194479"}, {"introduction": "在使用预条件迭代法时，我们通常会监控预处理后的残差（preconditioned residual）来判断收敛性，因为它的计算可能更方便。然而，一个小的预处理残差并不总能保证原始系统的真实残差也同样小，这种差异有时会导致算法过早停止。这个练习通过一个具体的计算，揭示了真实残差和预处理残差之间的关系，强调了在设计停止准则时需要考虑的细微之处。[@problem_id:2194449]", "problem": "在数值线性代数中，预处理是一种用于改善求解线性系统 $Ax=b$ 的迭代法收敛性质的技术。考虑一个系统，其中\n$$ A = \\begin{pmatrix} 5  0 \\\\ 0  50 \\end{pmatrix} \\quad \\text{and} \\quad b = \\begin{pmatrix} 5 \\\\ 50 \\end{pmatrix}. $$\n使用左预处理的迭代法来求解。预处理器 $M$ 被选为雅可比预处理器，即包含 $A$ 的对角元素的对角矩阵。经过一定次数的迭代后，该方法得到一个近似解\n$$ x_k = \\begin{pmatrix} 0.8 \\\\ 0.9 \\end{pmatrix}. $$\n原始残差定义为 $r_k = b - Ax_k$，预处理残差为 $\\hat{r}_k = M^{-1}(b - Ax_k)$。该迭代法的停止准则基于预处理残差的范数 $\\|\\hat{r}_k\\|_2$ 很小。然而，这并不能保证原始残差的范数 $\\|r_k\\|_2$ 也很小。\n\n为了说明这一点，计算比值 $\\frac{\\|r_k\\|_2}{\\|\\hat{r}_k\\|_2}$。符号 $\\|\\cdot\\|_2$ 表示向量 $v = (v_1, v_2, ..., v_n)$ 的标准欧几里得范数（或 $\\ell_2$-范数），定义为 $\\|v\\|_2 = \\sqrt{\\sum_{i=1}^n v_i^2}$。请用最简形式的单一符号表达式表示你的答案。", "solution": "给定 $A=\\begin{pmatrix}5  0\\\\0  50\\end{pmatrix}$，$b=\\begin{pmatrix}5\\\\50\\end{pmatrix}$，$x_{k}=\\begin{pmatrix}0.8\\\\0.9\\end{pmatrix}$，以及雅可比预处理器 $M=\\operatorname{diag}(A)=\\begin{pmatrix}5  0\\\\0  50\\end{pmatrix}$。原始残差为 $r_{k}=b-Ax_{k}$，预处理残差为 $\\hat{r}_{k}=M^{-1}(b-Ax_{k})$。\n\n首先计算残差：\n$$\nr_{k}=b-Ax_{k}\n=\\begin{pmatrix}5\\\\50\\end{pmatrix}-\\begin{pmatrix}5  0\\\\0  50\\end{pmatrix}\\begin{pmatrix}0.8\\\\0.9\\end{pmatrix}\n=\\begin{pmatrix}5-5\\cdot 0.8\\\\50-50\\cdot 0.9\\end{pmatrix}\n=\\begin{pmatrix}1\\\\5\\end{pmatrix}.\n$$\n\n计算 $M^{-1}$ 和预处理残差：\n$$\nM^{-1}=\\begin{pmatrix}\\frac{1}{5}  0\\\\0  \\frac{1}{50}\\end{pmatrix},\n\\quad\n\\hat{r}_{k}=M^{-1}r_{k}\n=\\begin{pmatrix}\\frac{1}{5}  0\\\\0  \\frac{1}{50}\\end{pmatrix}\\begin{pmatrix}1\\\\5\\end{pmatrix}\n=\\begin{pmatrix}\\frac{1}{5}\\\\\\frac{1}{10}\\end{pmatrix}.\n$$\n\n计算欧几里得范数：\n$$\n\\|r_{k}\\|_{2}=\\sqrt{1^{2}+5^{2}}=\\sqrt{26},\\qquad\n\\|\\hat{r}_{k}\\|_{2}=\\sqrt{\\left(\\frac{1}{5}\\right)^{2}+\\left(\\frac{1}{10}\\right)^{2}}\n=\\sqrt{\\frac{1}{25}+\\frac{1}{100}}\n=\\sqrt{\\frac{5}{100}}\n=\\frac{\\sqrt{5}}{10}.\n$$\n\n构造比值并化简：\n$$\n\\frac{\\|r_{k}\\|_{2}}{\\|\\hat{r}_{k}\\|_{2}}\n=\\frac{\\sqrt{26}}{\\frac{\\sqrt{5}}{10}}\n=10\\cdot\\frac{\\sqrt{26}}{\\sqrt{5}}\n=10\\cdot\\frac{\\sqrt{130}}{5}\n=2\\sqrt{130}.\n$$", "answer": "$$\\boxed{2\\sqrt{130}}$$", "id": "2194449"}]}