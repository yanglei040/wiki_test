## 引言
在数值计算的广阔领域中，我们经常需要将复杂的[矩阵变换](@entry_id:156789)为更简单的形式，以便于分析和求解。吉文斯旋转（Givens Rotation）正是实现这一目标的一种优雅而强大的工具。它通过一系列精确的平面旋转，以极高的[数值稳定性](@entry_id:146550)在向量或矩阵中引入零元素，是现代[计算数学](@entry_id:153516)武库中的关键组成部分。然而，对于初学者而言，其背后的数学原理、与其他方法（如[Householder变换](@entry_id:168808)）的微妙区别，以及其在不同学科中的广泛应用，往往构成了一个知识上的挑战。

本文旨在系统性地揭开吉文斯旋转的神秘面纱。我们将从以下三个层面展开：
*   在“**原理与机制**”一章中，我们将从二维平面旋转的定义出发，深入探讨其正交性、范数保持性等基本性质，学习如何将其推广至高维空间，并分析实现数值稳定计算的关键技术。
*   接着，在“**应用与跨学科联系**”一章中，我们将展示吉文斯旋转如何在[QR分解](@entry_id:139154)、[特征值计算](@entry_id:145559)等经典算法中发挥核心作用，并探索其思想如何延伸至[计算机图形学](@entry_id:148077)、[数字信号处理](@entry_id:263660)乃至前沿的[量子计算](@entry_id:142712)领域。
*   最后，“**动手实践**”部分将提供一系列练习，帮助您将理论知识转化为实际的计算技能。

通过本文的学习，您将不仅掌握吉文斯旋转的操作方法，更能深刻理解其作为一种基础数学工具，在解决复杂科学与工程问题中所展现出的普适性和力量。让我们首先进入第一章，探究其根本的原理与机制。

## 原理与机制

在[数值线性代数](@entry_id:144418)中，我们经常需要在向量或矩阵中引入零元素，以将其简化为更易于处理的形式，例如上三角形式。吉文斯旋转（Givens Rotation）是一种实现此目标的强大而精确的工具。它本质上是一种在特定二维平面内的旋转，其设计目的就是为了精确地将向量的某个特定分量置为零。本章将深入探讨吉文斯旋转的根本原理、关键性质、战略应用以及在实际计算中需要注意的问题。

### 定义吉文斯旋转：一种目标明确的平面旋转

吉文斯旋转的核心思想是在一个二维[子空间](@entry_id:150286)中操作，以消除该[子空间](@entry_id:150286)中一个向量的一个分量。让我们从最简单的情形开始。考虑一个二维列向量 $v = \begin{pmatrix} a \\ b \end{pmatrix}$，其中 $a$ 和 $b$ 不全为零。我们的目标是找到一个变换矩阵 $G$，使得变换后的向量 $v' = Gv$ 的第二个分量为零。

为了保持向量的几何特性（例如长度），我们要求 $G$ 是一个**[正交矩阵](@entry_id:169220)**。最简单的此类变换是平面旋转。一个通用的 $2 \times 2$ 吉文斯旋转矩阵可以写为：
$$
G = \begin{pmatrix} c & s \\ -s & c \end{pmatrix}
$$
其中实数 $c$ 和 $s$ 必须满足正交条件 $c^2 + s^2 = 1$。从几何上看，这对应于一个旋转，其中 $c$ 和 $s$ 可以被认为是某个旋转角的余弦和正弦，但通常我们直接计算它们的值而无需关心具体的角度。

将此变换应用于向量 $v$：
$$
v' = Gv = \begin{pmatrix} c & s \\ -s & c \end{pmatrix} \begin{pmatrix} a \\ b \end{pmatrix} = \begin{pmatrix} ca + sb \\ -sa + cb \end{pmatrix}
$$

为了使 $v'$ 的第二个分量为零，我们必须满足：
$$
-sa + cb = 0 \quad \implies \quad cb = sa
$$
结合条件 $c^2 + s^2 = 1$，我们可以求解 $c$ 和 $s$。定义 $r = \sqrt{a^2 + b^2}$，这是向量 $v$ 的[欧几里得范数](@entry_id:172687)。由于 $a$ 和 $b$ 不全为零，$r > 0$。一个直接满足上述两个条件的解是：
$$
c = \frac{a}{r}, \quad s = \frac{b}{r}
$$
我们可以验证这个解：$cb = \frac{a}{r}b$ 和 $sa = \frac{b}{r}a$ 相等。同时，$c^2 + s^2 = \frac{a^2}{r^2} + \frac{b^2}{r^2} = \frac{a^2+b^2}{r^2} = 1$。

将这对 $(c, s)$ 代入变换后的向量 $v'$ 的第一个分量：
$$
v'_1 = ca + sb = \frac{a}{r}a + \frac{b}{r}b = \frac{a^2 + b^2}{r} = \frac{r^2}{r} = r
$$
因此，变换后的向量为 $v' = \begin{pmatrix} r \\ 0 \end{pmatrix}$。吉文斯旋转成功地将向量旋转，使其与[坐标系](@entry_id:156346)的第一[根轴](@entry_id:166633)对齐，其新的非零分量正是原向量的长度。这个过程为我们提供了一个计算 $c$ 和 $s$ 的标准方法 [@problem_id:2176469] [@problem_id:2176507]。

值得注意的是，解 $(c, s)$ 并非唯一。例如，$(-c, -s)$ 也是一组有效的参数，它会将向量变换为 $\begin{pmatrix} -r \\ 0 \end{pmatrix}$。在实践中，为了确保算法的确定性，需要一个统一的约定。例如，在处理向量 $\begin{pmatrix} -15 \\ 8 \end{pmatrix}$ 时，我们有 $a=-15, b=8$，且 $r = \sqrt{(-15)^2 + 8^2} = \sqrt{225+64} = \sqrt{289} = 17$。标准公式给出 $c = -15/17, s = 8/17$。然而，某些数值库可能采用不同的约定，比如要求 $c \ge 0$。在这种情况下，我们必须选择 $c = 15/17$，从而导出 $s = -8/17$ [@problem_id:2176477]。这两种选择都能达到将第二个分量置零的目的，只是第一个分量的符号不同。

在文献中，吉文斯矩阵也可能写成 $G = \begin{pmatrix} c & -s \\ s & c \end{pmatrix}$ 的形式，这对应于相反方向的旋转。选择哪种形式取决于约定，但其核心功能——利用[正交变换](@entry_id:155650)引入零——保持不变。

### 吉文斯旋转的基本性质

吉文斯旋转有两个至关重要的基本性质，它们都源于其正交性。

#### 正交性
根据定义，吉文斯矩阵 $G$ 是**正交的**，即 $G^T G = I$，其中 $G^T$ 是 $G$ 的转置，$I$ 是单位矩阵。对于我们定义的 $2 \times 2$ 矩阵：
$$
G^T G = \begin{pmatrix} c & -s \\ s & c \end{pmatrix} \begin{pmatrix} c & s \\ -s & c \end{pmatrix} = \begin{pmatrix} c^2 + s^2 & cs - sc \\ sc - cs & s^2 + c^2 \end{pmatrix} = \begin{pmatrix} 1 & 0 \\ 0 & 1 \end{pmatrix} = I
$$
正交性是“纯旋转”变换的数学表达。这意味着变换不会引入任何缩放或剪切效应，它严格地保持了空间的几何结构。在数值计算中，[正交变换](@entry_id:155650)因其卓越的数值稳定性而备受青睐。任何满足列向量（或行向量）构成[标准正交集](@entry_id:155086)（即它们相互正交且长度为1）的方阵都是[正交矩阵](@entry_id:169220) [@problem_id:2176491]。

#### 范数保持性
作为正交变换的一个直接推论，吉文斯旋转**保持向量的欧几里得范数**。也就是说，对于任何向量 $x$，变换后向量的长度与原向量相同，即 $\|Gx\|_2 = \|x\|_2$。我们可以通过直接计算来证明这一点 [@problem_id:2176533]。对于 $x = \begin{pmatrix} x_1 \\ x_2 \end{pmatrix}$ 和 $G = \begin{pmatrix} c & s \\ -s & c \end{pmatrix}$：
$$
\|Gx\|_2^2 = (cx_1 + sx_2)^2 + (-sx_1 + cx_2)^2
$$
展开平方项：
$$
\|Gx\|_2^2 = (c^2x_1^2 + 2csx_1x_2 + s^2x_2^2) + (s^2x_1^2 - 2scx_1x_2 + c^2x_2^2)
$$
合并同类项后，交叉项 $2csx_1x_2$ 和 $-2scx_1x_2$ 相互抵消：
$$
\|Gx\|_2^2 = (c^2+s^2)x_1^2 + (s^2+c^2)x_2^2 = 1 \cdot x_1^2 + 1 \cdot x_2^2 = x_1^2 + x_2^2 = \|x\|_2^2
$$
这个性质证实了吉文斯变换确实是一种纯旋转。当我们将向量 $\begin{pmatrix} a \\ b \end{pmatrix}$ 旋转成 $\begin{pmatrix} r \\ 0 \end{pmatrix}$ 时，新[向量的范数](@entry_id:154882)是 $\sqrt{r^2+0^2} = r$，而原[向量的范数](@entry_id:154882)是 $\sqrt{a^2+b^2}$。我们已经知道 $r = \sqrt{a^2+b^2}$，这再次验证了范数保持性。

### 高维空间中的吉文斯旋转

吉文斯旋转的真正威力在于它能够被推广到任意 $n$ 维空间 $\mathbb{R}^n$ 中，并用于选择性地操作任意两个分量，而不影响其他分量。

一个作用于第 $i$ 和第 $j$ 个坐标轴所构成平面（其中 $i  j$）的 $n \times n$ 吉文斯[旋转矩阵](@entry_id:140302)，记为 $G_{ij}(c, s)$，其形式是在 $n \times n$ 单位矩阵的基础上，修改四个位置的元素：
$$
\begin{aligned}
(G_{ij})_{ii} = c \\
(G_{ij})_{jj} = c \\
(G_{ij})_{ij} = s \\
(G_{ij})_{ji} = -s
\end{aligned}
$$
所有其他对角[线元](@entry_id:196833)素为1，所有其他非对角[线元](@entry_id:196833)素为0。这个矩阵在由[基向量](@entry_id:199546) $e_i$ 和 $e_j$ 张成的[子空间](@entry_id:150286)中表现为一个 $2 \times 2$ 的吉文斯旋转，而在其[正交补](@entry_id:149922)空间中表现为[恒等变换](@entry_id:264671)。

这种结构的关键优势在于其**局部作用**。当用 $G_{ij}$左乘一个向量 $v \in \mathbb{R}^n$ 时，只有第 $i$ 个和第 $j$ 个分量会发生改变。对于所有 $k \notin \{i, j\}$，新向量 $v'$ 的第 $k$ 个分量 $v'_k$ 与原向量的 $v_k$ 完全相同 [@problem_id:1365893]。

例如，考虑一个5维向量 $v = (8, -3, 5, 1, 4)^T$。如果我们想在第2和第4个分量之间进行旋转，我们会构造一个 $G_{2,4}$ 矩阵。假设旋转参数为 $c=1/2, s=\sqrt{3}/2$，那么 $G_{2,4}$ 矩阵为：
$$
G_{2,4} = \begin{pmatrix}
1  0  0  0  0 \\
0  c  0  s  0 \\
0  0  1  0  0 \\
0  -s  0  c  0 \\
0  0  0  0  1
\end{pmatrix}
=
\begin{pmatrix}
1  0  0  0  0 \\
0  1/2  0  \sqrt{3}/2  0 \\
0  0  1  0  0 \\
0  -\sqrt{3}/2  0  1/2  0 \\
0  0  0  0  1
\end{pmatrix}
$$
变换后的向量 $v' = G_{2,4}v$ 的第1、3、5分量将保持不变，而第2和第4分量会被更新：
$$
\begin{pmatrix} v'_2 \\ v'_4 \end{pmatrix} = \begin{pmatrix} c  s \\ -s  c \end{pmatrix} \begin{pmatrix} v_2 \\ v_4 \end{pmatrix} = \begin{pmatrix} 1/2  \sqrt{3}/2 \\ -\sqrt{3}/2  1/2 \end{pmatrix} \begin{pmatrix} -3 \\ 1 \end{pmatrix} = \begin{pmatrix} -3/2 + \sqrt{3}/2 \\ 3\sqrt{3}/2 + 1/2 \end{pmatrix}
$$
这种“外科手术式”的精确操作使得吉文斯旋转在需要对矩阵或向量进行稀疏或结构化修改时特别有用 [@problem_id:2176492]。

### 策略性应用：消去多个元素

有了在高维空间中精确引入零的工具，我们就可以设计策略来执行更复杂的任务，例如将一个任意向量 $x \in \mathbb{R}^n$ 变换为与[标准基向量](@entry_id:152417) $e_1$平行的形式，即 $(r, 0, \dots, 0)^T$。这需要将 $x$ 的最后 $n-1$ 个分量全部置为零。

一个直观但低效的方法是逐个消去元素。例如，用 $G_{2,3}$ 消去 $x_3$ 会改变 $x_2$；接着用 $G_{2,4}$ 消去 $x_4$ 又会改变 $x_2$。这种方法会“污染”之前处理过的分量。

一个更有效的策略是，始终使用一个固定的“枢轴”分量（例如第一个分量）来消去其他分量。具体步骤如下 [@problem_id:1365884]：
1.  **消去 $x_n$**：构造一个作用于 $(1, n)$ 平面的吉文斯旋转 $G_{1,n}$，选择合适的 $c, s$ 参数使得新向量的第 $n$ 个分量为零。此操作只改变第1和第 $n$ 个分量。
2.  **消去 $x_{n-1}$**：接着，对新得到的向量，构造一个作用于 $(1, n-1)$ 平面的吉文斯旋转 $G_{1, n-1}$，将其第 $n-1$ 个分量置为零。重要的是，此操作只改变第1和第 $n-1$ 个分量，而不会影响我们已置为零的第 $n$ 个分量。
3.  **依此类推**：我们继续这个过程，依次用 $G_{1,j}$ 消去第 $j$ 个分量，其中 $j$ 从 $n$ 递减到 $2$。

每一步都会引入一个新的零，且不会破坏之前步骤的成果。要消去从 $x_2$ 到 $x_n$ 的所有 $n-1$ 个分量，我们总共需要 $n-1$ 次吉文斯旋转。

这个过程表明，通过 $n-1$ 次旋转，我们可以将任何非[零向量](@entry_id:156189) $x$ 变换为 $r \cdot e_1$ 的形式。可以进一步论证，对于一个没有任何零分量的“通用”向量，我们至少需要 $n-1$ 次旋转，因为每次旋转最多只能引入一个新零。因此，$n-1$ 是将任意向量变换为 $r \cdot e_1$ 所需的最小旋转次数 [@problem_id:1365884]。这一策略是许多算法（如QR分解）的核心步骤。

### 实践中的考量

在将理论转化为可靠的计算机程序时，必须考虑数值稳定性和计算效率。

#### [数值稳定性](@entry_id:146550)

我们之[前推](@entry_id:158718)导出的标准公式 $c = a/r, s = b/r$，其中 $r = \sqrt{a^2 + b^2}$，在数学上是完美的，但在有限精度的浮点数运算中可能存在风险。如果 $a$ 或 $b$ 的[绝对值](@entry_id:147688)非常大，计算 $a^2$ 或 $b^2$ 可能会导致**[溢出](@entry_id:172355)**（overflow），即使最终的 $c$ 和 $s$ 值都在 $[-1, 1]$ 的安全范围内。类似地，如果 $a$ 和 $b$ 的值都非常小， $a^2+b^2$ 可能会导致**下溢**（underflow），损失精度。

例如，在一台[溢出](@entry_id:172355)阈值为 $1.0 \times 10^{80}$ 的计算机上，若向量分量为 $v_a = 3.6 \times 10^{40}$ 和 $v_b = 4.8 \times 10^{40}$，直接计算 $v_a^2 = 1.296 \times 10^{81}$ 将立即导致溢出错误，程序中断 [@problem_id:2176509]。

为了避免这种情况，我们可以设计一个**数值稳定**的算法。关键在于避免计算平方项，而是先计算比值。假设 $v_a, v_b$ 不为零：
- 如果 $|v_b|  |v_a|$，令 $t = v_a / v_b$。则 $c$ 和 $s$ 可以通过 $s = \frac{\text{sgn}(v_b)}{\sqrt{t^2+1}}$ 和 $c = s \cdot t$ 计算。
- 如果 $|v_a| \ge |v_b|$，令 $t = v_b / v_a$。则 $c$ 可以通过 $c = \frac{\text{sgn}(v_a)}{\sqrt{t^2+1}}$ 和 $s = c \cdot t$ 计算。

在这种方法中，我们计算的比值 $t$ 的[绝对值](@entry_id:147688)总是不大于1，从而保证 $t^2+1$ 的计算不会溢出。这种重新[排列](@entry_id:136432)的计算方式在数学上等价，但在数值上却稳健得多。

#### 计算成本与[Householder变换](@entry_id:168808)的比较

在矩阵计算中，另一个常用于引入零的工具是**[Householder反射](@entry_id:637383)**。当需要在一个 $m \times n$ 矩阵的某一列中引入多个零时，我们面临一个选择：是使用一系列吉文斯旋转，还是使用单个[Householder变换](@entry_id:168808)？

假设我们需要在一个列向量中，使用第1个元素（枢轴）来消去其下的 $k$ 个非零元素。
- **方法 G (Givens)**：我们需要 $k$ 次吉文斯旋转，每次旋转作用于枢轴行和 $k$ 个目标行之一。每次旋转涉及两行的[线性组合](@entry_id:154743)，当应用于整个 $m \times n$ 矩阵时，更新这两行需要大约 $6n$ 次浮点运算（FLOPs）。因此，总成本约为 $6kn$ FLOPs。
- **方法 H (Householder)**：我们可以构造一个作用于所有 $k+1$ 行（枢轴行 + $k$ 个目标行）的[Householder反射](@entry_id:637383)，一次性将所有 $k$ 个元素置为零。应用一个这样的[Householder变换](@entry_id:168808)到这 $k+1$ 行上，大约需要 $4(k+1)n$ FLOPs。

为了比较这两种方法的效率，我们比较它们的计算成本 [@problem_id:2176498]：
$$
\text{Givens 更优} \iff 6kn  4(k+1)n \iff 6k  4k+4 \iff 2k  4 \iff k  2
$$
由于 $k$ 必须是正整数，这个不等式仅在 $k=1$ 时成立。

**结论是**：
- 当只需要引入**一个零**（$k=1$）时，吉文斯旋转的计算成本（$\approx 6n$ FLOPs）低于[Householder变换](@entry_id:168808)（$\approx 8n$ FLOPs）。
- 当需要引入**两个或更多零**（$k \ge 2$）时，[Householder变换](@entry_id:168808)变得更有效率。

因此，吉文斯旋转的优势在于其**[稀疏性](@entry_id:136793)**和**选择性**。它非常适合于只需要修改少数几个元素的场景，例如在[QR分解](@entry_id:139154)的更新、稀疏矩阵的分解，或是在[Jacobi特征值算法](@entry_id:155924)中逐个消去非对角[线元](@entry_id:196833)素。

### 代数性质：可交换性

最后，我们探讨一个更具理论性的问题：两个不同的吉文斯旋转 $G_1 = G(i, j, \theta_1)$ 和 $G_2 = G(k, l, \theta_2)$ 在什么条件下可以交换运算次序，即满足 $G_1 G_2 = G_2 G_1$？

这个问题的答案取决于它们作用的平面之间的关系 [@problem_id:2176470]。令 $I = \{i, j\}$ 和 $K = \{k, l\}$ 为定义旋转平面的索引集。
1.  **不相交的平面 ($|I \cap K| = 0$)**: 如果两个旋转作用于完全不同的坐标轴对上（例如 $G_{1,2}$ 和 $G_{3,4}$），它们的变换是相互独立的。$G_1$ 只改变分量1和2，$G_2$ 只改变分量3和4。无论先执行哪个变换，对另一对分量的影响都是零。因此，它们是可交换的。
2.  **相同的平面 ($|I \cap K| = 2$)**: 如果 $I=K$，两个旋转都作用于同一个二维平面。这相当于在二维空间中连续进行两次旋转，其结果是两次旋转角度之和的单次旋转。由于角度加法满足交换律（$\theta_1 + \theta_2 = \theta_2 + \theta_1$），所以这两个旋转是可交换的。
3.  **重叠的平面 ($|I \cap K| = 1$)**: 如果两个平面共享一个坐标轴（例如 $G_{1,2}$ 和 $G_{1,3}$），它们通常是**不可交换的**。直观地看，$G_{1,2}$ 会将一部分分量2“混合”到分量1中。接着应用的 $G_{1,3}$ 会操作这个被改变了的分量1。如果颠倒次序，$G_{1,3}$ 先作用，它不会影响分量2；然后 $G_{1,2}$ 再作用时，其输入的分量1是未经修改的。由于输入不同，结果通常也不同。除非旋转角度是 $\pi$ 的整数倍（此时[旋转矩阵](@entry_id:140302)为 $\pm I$），否则它们不可交换。

综上所述，两个吉文斯旋转 $G_1$ 和 $G_2$ 可交换的充分必要条件是，它们的旋转平面要么完全相同，要么完全不相交，即它们的索引集交集的大小不为1。这个性质在设计[并行算法](@entry_id:271337)或分析算法步骤的可重排性时非常重要。