{"hands_on_practices": [{"introduction": "要真正理解像BiCGSTAB这样的迭代算法，就必须超越抽象的公式，进行一次具体的计算。这个练习 [@problem_id:2374444] 将引导您在一个简单的 $2 \\times 2$ 系统上逐步应用BiCGSTAB方法。通过追踪每个中间向量和标量，您将对残差如何被系统性地减小，以及算法如何在有限步数内（在精确算术中）收敛到精确解有一个切实的理解。", "problem": "您将应用双共轭梯度稳定 (BiConjugate Gradient Stabilized, BiCGSTAB) 方法到一个非对称线性系统，以明确说明在精确算术和标准参数选择下，从零初始猜测开始，该方法需要两次迭代才能收敛。考虑如下线性系统：\n- 矩阵 $A = \\begin{pmatrix} 1  2 \\\\ 3  4 \\end{pmatrix}$，\n- 右端项 $b = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$，\n- 初始猜测 $x_0 = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$，\n- 单位预条件子，以及\n- 影子残差 $\\hat{r} = r_0$，其中 $r_0 = b - A x_0$。\n\n所有内积均为标准欧几里得内积。请使用精确算术（即不要对中间量进行四舍五入）。从定义 BiCGSTAB 递推关系的残差、搜索方向和标量系数的核心定义开始，逐步执行 BiCGSTAB 迭代，并证明：\n1. 第一次迭代后，残差非零。\n2. 第二次迭代后，该方法达到精确解（残差等于零向量）。\n\n明确计算并报告 BiCGSTAB 直至收敛所使用的所有中间向量和标量，以证实这些论断。最后，提供该系统在第一次 BiCGSTAB 迭代期间产生的第一个平滑参数 $\\omega_1$ 的精确值。请将您的最终答案表示为精确的有理数，不要四舍五入。", "solution": "对问题陈述进行验证。\n\n**第一步：提取已知条件**\n- **方法：** 双共轭梯度稳定 (BiCGSTAB)\n- **线性系统：** $A x = b$\n- **矩阵：** $A = \\begin{pmatrix} 1  2 \\\\ 3  4 \\end{pmatrix}$\n- **右端项：** $b = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$\n- **初始猜测：** $x_0 = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$\n- **预条件子：** 单位矩阵 ($M=I$)\n- **影子残差：** $\\hat{r}_0 = r_0$，其中 $r_0 = b - A x_0$\n- **内积：** 标准欧几里得内积，记为 $(u, v) = u^T v$。\n- **算术：** 要求使用精确算术。\n\n**第二步：使用提取的已知条件进行验证**\n- **科学依据：** 该问题是 BiCGSTAB 算法的直接和标准应用，BiCGSTAB 算法是数值线性代数中求解非对称线性系统的成熟方法。该问题具有科学合理性。\n- **适定性：** 矩阵 $A$ 的行列式为 $\\det(A) = (1)(4) - (2)(3) = 4 - 6 = -2 \\neq 0$。因此，$A$ 是可逆的，线性系统 $Ax=b$ 有唯一解。BiCGSTAB 算法是一个定义明确的程序。对于一个大小为 $N \\times N$ 的系统，像 BiCGSTAB 这样的克雷洛夫子空间方法在精确算术下保证最多在 $N$ 次迭代内找到精确解。对于这个 $2 \\times 2$ 系统，恰好在 2 次迭代内收敛是一个合理且可验证的论断。\n- **客观性：** 该问题使用精确的数学语言陈述，没有任何主观性或模糊性。\n\n**结论：** 该问题是有效的，因为它具有科学依据、适定性和客观性。它是计算工程领域内一个可形式化的问题。我们可以着手求解。\n\n我们将通过逐步应用 BiCGSTAB 算法来构建解。该算法如下：\n\n**初始化：**\n1. 给定初始猜测 $x_0$。\n2. 计算初始残差 $r_0 = b - Ax_0$。\n3. 选择一个影子残差向量 $\\hat{r}_0$，使得 $(\\hat{r}_0, r_0) \\neq 0$。此处，给定 $\\hat{r}_0 = r_0$。\n4. 为递推设置初始参数：$\\rho_0 = 1$, $\\alpha_0 = 1$, $\\omega_0 = 1$。\n5. 设置初始搜索方向：$p_0 = \\mathbf{0}$, $v_0 = \\mathbf{0}$。\n\n**主循环 (对于 $k = 1, 2, \\dots$)：**\n1. $\\rho_k = (\\hat{r}_0, r_{k-1})$\n2. $\\beta_k = \\frac{\\rho_k}{\\rho_{k-1}} \\frac{\\alpha_{k-1}}{\\omega_{k-1}}$\n3. $p_k = r_{k-1} + \\beta_k (p_{k-1} - \\omega_{k-1} v_{k-1})$\n4. $v_k = A p_k$\n5. $\\alpha_k = \\frac{\\rho_k}{(\\hat{r}_0, v_k)}$\n6. $s_k = r_{k-1} - \\alpha_k v_k$\n7. $t_k = A s_k$\n8. $\\omega_k = \\frac{(t_k, s_k)}{(t_k, t_k)}$\n9. $x_k = x_{k-1} + \\alpha_k p_k + \\omega_k s_k$\n10. $r_k = s_k - \\omega_k t_k$\n\n我们现在将此算法应用于给定系统。\n\n**初始化 ($k=0$)：**\n- 系统由 $A = \\begin{pmatrix} 1  2 \\\\ 3  4 \\end{pmatrix}$ 和 $b = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$ 定义。\n- 初始猜测为 $x_0 = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$。\n- 初始残差为 $r_0 = b - Ax_0 = b = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。\n- 影子残差为 $\\hat{r}_0 = r_0 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。\n- 初始参数设置为 $\\rho_0 = 1$, $\\alpha_0 = 1$, $\\omega_0 = 1$。\n- 初始方向向量为 $p_0 = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$ 和 $v_0 = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$。\n\n**迭代 1 ($k=1$)：**\n1. $\\rho_1 = (\\hat{r}_0, r_0) = \\begin{pmatrix} 1  0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = 1$。\n2. $\\beta_1 = \\frac{\\rho_1}{\\rho_0} \\frac{\\alpha_0}{\\omega_0} = \\frac{1}{1} \\frac{1}{1} = 1$。\n3. $p_1 = r_0 + \\beta_1(p_0 - \\omega_0 v_0) = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} + 1 \\left( \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} - 1 \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} \\right) = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$。\n4. $v_1 = A p_1 = \\begin{pmatrix} 1  2 \\\\ 3  4 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 3 \\end{pmatrix}$。\n5. $\\alpha_1$ 的分母为 $(\\hat{r}_0, v_1) = \\begin{pmatrix} 1  0 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 3 \\end{pmatrix} = 1$。因此，$\\alpha_1 = \\frac{\\rho_1}{(\\hat{r}_0, v_1)} = \\frac{1}{1} = 1$。\n6. $s_1 = r_0 - \\alpha_1 v_1 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} - 1 \\begin{pmatrix} 1 \\\\ 3 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -3 \\end{pmatrix}$。\n7. $t_1 = A s_1 = \\begin{pmatrix} 1  2 \\\\ 3  4 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ -3 \\end{pmatrix} = \\begin{pmatrix} -6 \\\\ -12 \\end{pmatrix}$。\n8. 对于 $\\omega_1$，我们计算内积：\n   $(t_1, s_1) = \\begin{pmatrix} -6  -12 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ -3 \\end{pmatrix} = (0)(-6) + (-3)(-12) = 36$。\n   $(t_1, t_1) = \\begin{pmatrix} -6  -12 \\end{pmatrix} \\begin{pmatrix} -6 \\\\ -12 \\end{pmatrix} = (-6)^2 + (-12)^2 = 36 + 144 = 180$。\n   所以，$\\omega_1 = \\frac{(t_1, s_1)}{(t_1, t_1)} = \\frac{36}{180} = \\frac{1}{5}$。\n9. $x_1 = x_0 + \\alpha_1 p_1 + \\omega_1 s_1 = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} + 1 \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} + \\frac{1}{5} \\begin{pmatrix} 0 \\\\ -3 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ -\\frac{3}{5} \\end{pmatrix}$。\n10. $r_1 = s_1 - \\omega_1 t_1 = \\begin{pmatrix} 0 \\\\ -3 \\end{pmatrix} - \\frac{1}{5} \\begin{pmatrix} -6 \\\\ -12 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -3 \\end{pmatrix} - \\begin{pmatrix} -\\frac{6}{5} \\\\ -\\frac{12}{5} \\end{pmatrix} = \\begin{pmatrix} \\frac{6}{5} \\\\ -\\frac{3}{5} \\end{pmatrix}$。\n\n第一次迭代后，残差为 $r_1 = \\begin{pmatrix} \\frac{6}{5} \\\\ -\\frac{3}{5} \\end{pmatrix}$，它不是零向量。这证实了第一个论断。\n\n**迭代 2 ($k=2$)：**\n1. $\\rho_2 = (\\hat{r}_0, r_1) = \\begin{pmatrix} 1  0 \\end{pmatrix} \\begin{pmatrix} \\frac{6}{5} \\\\ -\\frac{3}{5} \\end{pmatrix} = \\frac{6}{5}$。\n2. $\\beta_2 = \\frac{\\rho_2}{\\rho_1} \\frac{\\alpha_1}{\\omega_1} = \\frac{6/5}{1} \\frac{1}{1/5} = \\frac{6}{5} \\cdot 5 = 6$。\n3. $p_2 = r_1 + \\beta_2(p_1 - \\omega_1 v_1) = \\begin{pmatrix} \\frac{6}{5} \\\\ -\\frac{3}{5} \\end{pmatrix} + 6 \\left( \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} - \\frac{1}{5} \\begin{pmatrix} 1 \\\\ 3 \\end{pmatrix} \\right) = \\begin{pmatrix} \\frac{6}{5} \\\\ -\\frac{3}{5} \\end{pmatrix} + 6 \\begin{pmatrix} \\frac{4}{5} \\\\ -\\frac{3}{5} \\end{pmatrix} = \\begin{pmatrix} \\frac{6}{5} + \\frac{24}{5} \\\\ -\\frac{3}{5} - \\frac{18}{5} \\end{pmatrix} = \\begin{pmatrix} \\frac{30}{5} \\\\ -\\frac{21}{5} \\end{pmatrix} = \\begin{pmatrix} 6 \\\\ -\\frac{21}{5} \\end{pmatrix}$。\n4. $v_2 = A p_2 = \\begin{pmatrix} 1  2 \\\\ 3  4 \\end{pmatrix} \\begin{pmatrix} 6 \\\\ -\\frac{21}{5} \\end{pmatrix} = \\begin{pmatrix} 6 - \\frac{42}{5} \\\\ 18 - \\frac{84}{5} \\end{pmatrix} = \\begin{pmatrix} \\frac{30-42}{5} \\\\ \\frac{90-84}{5} \\end{pmatrix} = \\begin{pmatrix} -\\frac{12}{5} \\\\ \\frac{6}{5} \\end{pmatrix}$。\n5. $\\alpha_2$ 的分母为 $(\\hat{r}_0, v_2) = \\begin{pmatrix} 1  0 \\end{pmatrix} \\begin{pmatrix} -\\frac{12}{5} \\\\ \\frac{6}{5} \\end{pmatrix} = -\\frac{12}{5}$。因此，$\\alpha_2 = \\frac{\\rho_2}{(\\hat{r}_0, v_2)} = \\frac{6/5}{-12/5} = -\\frac{1}{2}$。\n6. $s_2 = r_1 - \\alpha_2 v_2 = \\begin{pmatrix} \\frac{6}{5} \\\\ -\\frac{3}{5} \\end{pmatrix} - \\left(-\\frac{1}{2}\\right) \\begin{pmatrix} -\\frac{12}{5} \\\\ \\frac{6}{5} \\end{pmatrix} = \\begin{pmatrix} \\frac{6}{5} \\\\ -\\frac{3}{5} \\end{pmatrix} - \\begin{pmatrix} \\frac{6}{5} \\\\ -\\frac{3}{5} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$。\n7. 由于 $s_2 = \\mathbf{0}$，我们有 $t_2 = A s_2 = A \\mathbf{0} = \\mathbf{0}$。\n8. $\\omega_2$ 的公式变为 $\\frac{(t_2, s_2)}{(t_2, t_2)} = \\frac{0}{0}$。这是一种所谓的“幸运分解”，它表明在这一步将找到精确解。我们可以设置 $\\omega_2 = 0$。\n9. $x_2 = x_1 + \\alpha_2 p_2 + \\omega_2 s_2 = \\begin{pmatrix} 1 \\\\ -\\frac{3}{5} \\end{pmatrix} + \\left(-\\frac{1}{2}\\right) \\begin{pmatrix} 6 \\\\ -\\frac{21}{5} \\end{pmatrix} + 0 \\cdot \\mathbf{0} = \\begin{pmatrix} 1 - 3 \\\\ -\\frac{3}{5} + \\frac{21}{10} \\end{pmatrix} = \\begin{pmatrix} -2 \\\\ -\\frac{6}{10} + \\frac{21}{10} \\end{pmatrix} = \\begin{pmatrix} -2 \\\\ \\frac{15}{10} \\end{pmatrix} = \\begin{pmatrix} -2 \\\\ \\frac{3}{2} \\end{pmatrix}$。\n10. $r_2 = s_2 - \\omega_2 t_2 = \\mathbf{0} - 0 \\cdot \\mathbf{0} = \\mathbf{0}$。\n\n残差 $r_2$ 是零向量，这意味着算法已经收敛到精确解。这证实了第二个论断。为了验证，我们检查该解：\n$A x_2 = \\begin{pmatrix} 1  2 \\\\ 3  4 \\end{pmatrix} \\begin{pmatrix} -2 \\\\ \\frac{3}{2} \\end{pmatrix} = \\begin{pmatrix} 1(-2) + 2(\\frac{3}{2}) \\\\ 3(-2) + 4(\\frac{3}{2}) \\end{pmatrix} = \\begin{pmatrix} -2 + 3 \\\\ -6 + 6 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = b$。\n该解是正确的。\n\n问题要求第一个平滑参数 $\\omega_1$ 的值。根据第一次迭代的计算，该值为 $\\omega_1 = \\frac{1}{5}$。", "answer": "$$\n\\boxed{\\frac{1}{5}}\n$$", "id": "2374444"}, {"introduction": "BiCGSTAB名称中的“稳定”部分不仅仅是一个名字，它解决了其前身双共轭梯度（BiCG）方法的一个实际弱点。某些线性系统可能会导致BiCG算法过早地中断。这项实践 [@problem_id:2376326] 展示了一个BiCG方法因双正交性丧失而失败的特定系统，然后您将对同一系统应用BiCGSTAB，观察其以参数 $\\omega_k$ 为特征的平滑步骤如何成功绕过该问题并继续求解，从而突显其更优越的鲁棒性。", "problem": "要求您从克里洛夫子空间迭代法的基本原理出发，论证对于同一线性系统，双共轭梯度 (BiCG) 法如何可能发生崩溃，而稳定双共轭梯度 (BiCGSTAB) 法仍然收敛。考虑线性系统 $A x = b$，其中\n$$\nA \\;=\\; \\begin{pmatrix}\n2  0  1\\\\\n1  3  0\\\\\n0  0  4\n\\end{pmatrix}, \n\\qquad\nb \\;=\\; \\begin{pmatrix} 1\\\\ 0\\\\ 0 \\end{pmatrix},\n\\qquad\nx_0 \\;=\\; \\begin{pmatrix} 0\\\\ 0\\\\ 0 \\end{pmatrix}.\n$$\n对于双共轭梯度 (BiCG) 法，设置初始残差 $r_0 = b - A x_0$ 和初始影子残差 $\\tilde{r}_0 = r_0$。仅使用 BiCG 中第一步更新的定义（残差和影子残差由单步克里洛夫投影和双正交配对定义），显式计算 $r_1$ 和 $\\tilde{r}_1$ 并验证 $r_1 \\neq 0$, $\\tilde{r}_1 \\neq 0$, 以及 $r_1^{T}\\tilde{r}_1 = 0$，这表明 BiCG 法将在下一步发生崩溃。\n\n接下来，对同一系统应用稳定双共轭梯度 (BiCGSTAB) 法，使用相同的初始猜测 $x_0$，相同的初始残差 $r_0$，以及一个选定的固定影子残差 $\\hat{r}$，其定义为\n$$\n\\hat{r} \\;=\\; r_0 + \\begin{pmatrix} 0\\\\ 1\\\\ 0 \\end{pmatrix} \\;=\\; \\begin{pmatrix} 1\\\\ 1\\\\ 0 \\end{pmatrix}.\n$$\n使用 BiCGSTAB 递推的标准定义（标量系数由 $r_{k-1}$、$\\hat{r}$ 的内积以及在 $A$ 作用下的克里洛夫像定义），执行第一次 BiCGSTAB 迭代以计算平滑参数 $\\omega_1$。\n\n您的任务是给出标量 $\\omega_1$ 的值。将您的最终答案精确表示为最简分数。无需四舍五入。最终答案必须是一个不带单位的数字。", "solution": "所提出的问题在科学上是合理的、适定的且客观的。它提供了一个具体的、可验证的数值示例，以论证计算物理学中的一个已知现象：在特定条件下，双共轭梯度 (BiCG) 法的崩溃以及稳定双共轭梯度 (BiCGSTAB) 法的鲁棒性。所有必要的数据和定义都已给出，且任务是一个直接的计算任务。因此，该问题是有效的。\n\n所考虑的线性系统是 $A x = b$，给定条件如下：\n$$\nA \\;=\\; \\begin{pmatrix}\n2  0  1\\\\\n1  3  0\\\\\n0  0  4\n\\end{pmatrix}, \n\\qquad\nb \\;=\\; \\begin{pmatrix} 1\\\\ 0\\\\ 0 \\end{pmatrix},\n\\qquad\nx_0 \\;=\\; \\begin{pmatrix} 0\\\\ 0\\\\ 0 \\end{pmatrix}.\n$$\n\n首先，我们分析 BiCG 方法。初始残差是 $r_0 = b - A x_0 = b - 0 = \\begin{pmatrix} 1\\\\ 0\\\\ 0 \\end{pmatrix}$。\n问题指定设置初始影子残差 $\\tilde{r}_0 = r_0$。因此，$\\tilde{r}_0 = \\begin{pmatrix} 1\\\\ 0\\\\ 0 \\end{pmatrix}$。\nBiCG 算法将初始搜索方向设置为 $p_0 = r_0$ 和 $\\tilde{p}_0 = \\tilde{r}_0$。\n在每一步 $k$，标量 $\\alpha_k$ 按如下方式计算 $\\alpha_k = \\frac{\\tilde{r}_k^T r_k}{\\tilde{p}_k^T A p_k}$。\n对于第一步 ($k=0$)：\n分子是 $\\tilde{r}_0^T r_0 = r_0^T r_0 = \\begin{pmatrix} 1  0  0 \\end{pmatrix} \\begin{pmatrix} 1\\\\ 0\\\\ 0 \\end{pmatrix} = 1$。\n为了计算分母，我们首先计算 $A p_0$：\n$A p_0 = A r_0 = \\begin{pmatrix} 2  0  1\\\\ 1  3  0\\\\ 0  0  4 \\end{pmatrix} \\begin{pmatrix} 1\\\\ 0\\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 2\\\\ 1\\\\ 0 \\end{pmatrix}$。\n则分母为 $\\tilde{p}_0^T A p_0 = \\tilde{r}_0^T (A r_0) = \\begin{pmatrix} 1  0  0 \\end{pmatrix} \\begin{pmatrix} 2\\\\ 1\\\\ 0 \\end{pmatrix} = 2$。\n因此，$\\alpha_0 = \\frac{1}{2}$。\n\n更新后的残差 $r_1$ 和 $\\tilde{r}_1$ 计算如下：\n$r_1 = r_0 - \\alpha_0 A p_0 = \\begin{pmatrix} 1\\\\ 0\\\\ 0 \\end{pmatrix} - \\frac{1}{2} \\begin{pmatrix} 2\\\\ 1\\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1\\\\ 0\\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 1\\\\ 1/2\\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0\\\\ -1/2\\\\ 0 \\end{pmatrix}$。\n$\\tilde{r}_1 = \\tilde{r}_0 - \\alpha_0 A^T \\tilde{p}_0$。$A$ 的转置是 $A^T = \\begin{pmatrix} 2  1  0\\\\ 0  3  0\\\\ 1  0  4 \\end{pmatrix}$。\n$A^T \\tilde{p}_0 = A^T \\tilde{r}_0 = \\begin{pmatrix} 2  1  0\\\\ 0  3  0\\\\ 1  0  4 \\end{pmatrix} \\begin{pmatrix} 1\\\\ 0\\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 2\\\\ 0\\\\ 1 \\end{pmatrix}$。\n$\\tilde{r}_1 = \\begin{pmatrix} 1\\\\ 0\\\\ 0 \\end{pmatrix} - \\frac{1}{2} \\begin{pmatrix} 2\\\\ 0\\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1\\\\ 0\\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 1\\\\ 0\\\\ 1/2 \\end{pmatrix} = \\begin{pmatrix} 0\\\\ 0\\\\ -1/2 \\end{pmatrix}$。\n\n我们验证问题中陈述的条件：\n1. $r_1 = \\begin{pmatrix} 0\\\\ -1/2\\\\ 0 \\end{pmatrix} \\neq 0$。\n2. $\\tilde{r}_1 = \\begin{pmatrix} 0\\\\ 0\\\\ -1/2 \\end{pmatrix} \\neq 0$。\n3. $r_1^T \\tilde{r}_1 = \\begin{pmatrix} 0  -1/2  0 \\end{pmatrix} \\begin{pmatrix} 0\\\\ 0\\\\ -1/2 \\end{pmatrix} = (0)(0) + (-1/2)(0) + (0)(-1/2) = 0$。\n\nBiCG 算法的下一步将是计算 $\\beta_0 = \\frac{\\tilde{r}_1^T r_1}{\\tilde{r}_0^T r_0} = \\frac{0}{1} = 0$。\n这会得到新的搜索方向 $p_1 = r_1 + \\beta_0 p_0 = r_1$ 和 $\\tilde{p}_1 = \\tilde{r}_1 + \\beta_0 \\tilde{p}_0 = \\tilde{r}_1$。\n然后，下一个标量 $\\alpha_1$ 按如下方式计算 $\\alpha_1 = \\frac{\\tilde{r}_1^T r_1}{\\tilde{p}_1^T A p_1} = \\frac{0}{\\tilde{r}_1^T A r_1}$。\n分母项是 $\\tilde{r}_1^T A r_1 = \\begin{pmatrix} 0  0  -1/2 \\end{pmatrix} \\begin{pmatrix} 2  0  1\\\\ 1  3  0\\\\ 0  0  4 \\end{pmatrix} \\begin{pmatrix} 0\\\\ -1/2\\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0  0  -2 \\end{pmatrix} \\begin{pmatrix} 0\\\\ -1/2\\\\ 0 \\end{pmatrix} = 0$。\n由于 $\\alpha_1$ 的分子和分母均为零，这构成了 BiCG 算法的一次严重崩溃。\n\n接下来，我们应用 BiCGSTAB 方法。初始残差是 $r_0 = \\begin{pmatrix} 1\\\\ 0\\\\ 0 \\end{pmatrix}$。给定的固定影子残差是 $\\hat{r} = \\begin{pmatrix} 1\\\\ 1\\\\ 0 \\end{pmatrix}$。\n标准算法以初始值 $\\rho_0=1$, $\\alpha_0=1$, $\\omega_0=1$, $p_0=0$ 和 $v_0=0$ 开始。我们执行第一次迭代 ($k=1$) 。\n\n1. 计算 $\\rho_1 = \\hat{r}^T r_0$：\n$\\rho_1 = \\begin{pmatrix} 1  1  0 \\end{pmatrix} \\begin{pmatrix} 1\\\\ 0\\\\ 0 \\end{pmatrix} = 1$。\n\n2. 计算 $\\beta_1 = \\frac{\\rho_1}{\\rho_0} \\frac{\\alpha_0}{\\omega_0}$：\n$\\beta_1 = \\frac{1}{1} \\cdot \\frac{1}{1} = 1$。\n\n3. 计算 $p_1 = r_0 + \\beta_1 (p_0 - \\omega_0 v_0)$：\n$p_1 = r_0 + 1 (0 - 1 \\cdot 0) = r_0 = \\begin{pmatrix} 1\\\\ 0\\\\ 0 \\end{pmatrix}$。\n\n4. 计算 $v_1 = A p_1$：\n$v_1 = A r_0 = \\begin{pmatrix} 2  0  1\\\\ 1  3  0\\\\ 0  0  4 \\end{pmatrix} \\begin{pmatrix} 1\\\\ 0\\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 2\\\\ 1\\\\ 0 \\end{pmatrix}$。\n\n5. 计算 $\\alpha_1 = \\frac{\\rho_1}{\\hat{r}^T v_1}$：\n$\\hat{r}^T v_1 = \\begin{pmatrix} 1  1  0 \\end{pmatrix} \\begin{pmatrix} 2\\\\ 1\\\\ 0 \\end{pmatrix} = (1)(2) + (1)(1) + (0)(0) = 3$。\n$\\alpha_1 = \\frac{1}{3}$。\n\n6. 计算临时残差 $s_1 = r_0 - \\alpha_1 v_1$：\n$s_1 = \\begin{pmatrix} 1\\\\ 0\\\\ 0 \\end{pmatrix} - \\frac{1}{3} \\begin{pmatrix} 2\\\\ 1\\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 - 2/3\\\\ 0 - 1/3\\\\ 0 - 0 \\end{pmatrix} = \\begin{pmatrix} 1/3\\\\ -1/3\\\\ 0 \\end{pmatrix}$。\n\n7. 计算 $t_1 = A s_1$：\n$t_1 = \\begin{pmatrix} 2  0  1\\\\ 1  3  0\\\\ 0  0  4 \\end{pmatrix} \\begin{pmatrix} 1/3\\\\ -1/3\\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 2(1/3) + 0(-1/3) + 1(0) \\\\ 1(1/3) + 3(-1/3) + 0(0) \\\\ 0(1/3) + 0(-1/3) + 4(0) \\end{pmatrix} = \\begin{pmatrix} 2/3\\\\ 1/3 - 1\\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 2/3\\\\ -2/3\\\\ 0 \\endpmatrix}$。\n\n8. 计算平滑参数 $\\omega_1 = \\frac{t_1^T s_1}{t_1^T t_1}$：\n分子是 $t_1^T s_1 = \\begin{pmatrix} 2/3  -2/3  0 \\end{pmatrix} \\begin{pmatrix} 1/3\\\\ -1/3\\\\ 0 \\end{pmatrix} = (\\frac{2}{3})(\\frac{1}{3}) + (\\frac{-2}{3})(\\frac{-1}{3}) = \\frac{2}{9} + \\frac{2}{9} = \\frac{4}{9}$。\n分母是 $t_1^T t_1 = \\begin{pmatrix} 2/3  -2/3  0 \\end{pmatrix} \\begin{pmatrix} 2/3\\\\ -2/3\\\\ 0 \\end{pmatrix} = (\\frac{2}{3})^2 + (\\frac{-2}{3})^2 = \\frac{4}{9} + \\frac{4}{9} = \\frac{8}{9}$。\n$\\omega_1 = \\frac{4/9}{8/9} = \\frac{4}{8} = \\frac{1}{2}$。\n\n平滑参数 $\\omega_1$ 的值为 $\\frac{1}{2}$。这表明，通过为 $\\hat{r}$ 选择一个合适的值，BiCGSTAB 算法不会崩溃并能继续进行计算。", "answer": "$$\n\\boxed{\\frac{1}{2}}\n$$", "id": "2376326"}, {"introduction": "尽管像BiCGSTAB这样的迭代方法功能强大，但它们并非万无一失，可能会遇到数值问题，尤其是除以零，这会使计算过程停止。理解这些“崩溃”的来源对于稳健的实现和问题排查至关重要。这个练习 [@problem_id:2208883] 要求您仔细检查BiCGSTAB算法的核心公式，通过识别可能导致除以零的具体计算，您将对该方法的数值稳定性及其可能失败的条件有更深刻的认识。", "problem": "稳定双共轭梯度法 (BiCGSTAB) 是一种迭代算法，用于求解形如 $A\\mathbf{x} = \\mathbf{b}$ 的非对称线性方程组。该算法生成一系列近似解 $\\mathbf{x}_i$，这些解会收敛到真实解。\n\n给定一个初始猜测值 $\\mathbf{x}_0$，初始残差为 $\\mathbf{r}_0 = \\mathbf{b} - A\\mathbf{x}_0$。此外，还会选择一个辅助残差向量 $\\hat{\\mathbf{r}}_0$，通常取 $\\hat{\\mathbf{r}}_0 = \\mathbf{r}_0$。该算法通过 $i=1, 2, \\dots$ 的迭代过程如下进行，其中 $(\\mathbf{u}, \\mathbf{v})$ 表示向量 $\\mathbf{u}$ 和 $\\mathbf{v}$ 之间的内积：\n\n- 初始化：$\\rho_0 = 1$，$\\alpha_{0} = 1$，$\\omega_{0} = 1$，$\\mathbf{v}_0 = \\mathbf{0}$，$\\mathbf{p}_0 = \\mathbf{0}$。\n\n- 对于 $i=1, 2, \\dots$\n    1. $\\rho_i = (\\hat{\\mathbf{r}}_0, \\mathbf{r}_{i-1})$\n    2. $\\beta_i = \\frac{\\rho_i}{\\rho_{i-1}} \\frac{\\alpha_{i-1}}{\\omega_{i-1}}$\n    3. $\\mathbf{p}_i = \\mathbf{r}_{i-1} + \\beta_i (\\mathbf{p}_{i-1} - \\omega_{i-1} \\mathbf{v}_{i-1})$\n    4. $\\mathbf{v}_i = A \\mathbf{p}_i$\n    5. $\\alpha_i = \\frac{\\rho_i}{(\\hat{\\mathbf{r}}_0, \\mathbf{v}_i)}$  (BiCG 步的步长)\n    6. $\\mathbf{s}_i = \\mathbf{r}_{i-1} - \\alpha_i \\mathbf{v}_i$\n    7. $\\mathbf{t}_i = A \\mathbf{s}_i$\n    8. $\\omega_i = \\frac{(\\mathbf{t}_i, \\mathbf{s}_i)}{(\\mathbf{t}_i, \\mathbf{t}_i)}$      (稳定步的步长)\n    9. $\\mathbf{x}_i = \\mathbf{x}_{i-1} + \\alpha_i \\mathbf{p}_i + \\omega_i \\mathbf{s}_i$ (更新解)\n    10. $\\mathbf{r}_i = \\mathbf{s}_i - \\omega_i \\mathbf{t}_i$       (更新残差)\n\n与许多数值算法一样，BiCGSTAB 容易出现崩溃，特别是由于除以零导致的崩溃。考虑在单次迭代 $i$ 中的计算。在计算步长 $\\alpha_i$ 和 $\\omega_i$ 的过程中可能会发生崩溃。\n\n从以下选项中，选择所有描述在第 $i$ 次迭代中计算步长 $\\alpha_i$ 或步长 $\\omega_i$ 时导致除零失败的条件。\n\nA. $(\\hat{\\mathbf{r}}_0, \\mathbf{v}_i) = 0$\n\nB. $(\\mathbf{t}_i, \\mathbf{t}_i) = 0$\n\nC. $(\\mathbf{r}_{i-1}, \\mathbf{r}_{i-1}) = 0$\n\nD. $\\rho_i = (\\hat{\\mathbf{r}}_0, \\mathbf{r}_{i-1}) = 0$\n\nE. $(\\mathbf{t}_i, \\mathbf{s}_i) = 0$", "solution": "我们分析 BiCGSTAB 迭代中的两个步长定义：\n$$\n\\alpha_{i}=\\frac{\\rho_{i}}{(\\hat{\\mathbf{r}}_{0},\\mathbf{v}_{i})},\\qquad\n\\omega_{i}=\\frac{(\\mathbf{t}_{i},\\mathbf{s}_{i})}{(\\mathbf{t}_{i},\\mathbf{t}_{i})}.\n$$\n在计算 $\\alpha_{i}$ 过程中，当且仅当分母 $(\\hat{\\mathbf{r}}_{0},\\mathbf{v}_{i})$ 为零时，会发生除零失败。这完全对应于选项 A。\n\n在计算 $\\omega_{i}$ 过程中，当且仅当分母 $(\\mathbf{t}_{i},\\mathbf{t}_{i})$ 为零时，会发生除零失败。这完全对应于选项 B。注意，如果 $\\mathbf{t}_{i}=\\mathbf{0}$，则 $(\\mathbf{t}_{i},\\mathbf{t}_{i})=0$，表达式变为 $0/0$ 的形式，这是未定义的。\n\n选项 D，$\\rho_{i}=(\\hat{\\mathbf{r}}_{0},\\mathbf{r}_{i-1})=0$，在计算 $\\alpha_{i}$ 时不会导致除零错误；它只会使分子为零，在 $(\\hat{\\mathbf{r}}_{0},\\mathbf{v}_{i})\\neq 0$ 的条件下得到 $\\alpha_{i}=0$。选项 E，$(\\mathbf{t}_{i},\\mathbf{s}_{i})=0$，将 $\\omega_{i}$ 的分子设为零，因此在 $(\\mathbf{t}_{i},\\mathbf{t}_{i})\\neq 0$ 的条件下得到 $\\omega_{i}=0$，这不属于除零错误。选项 C，$(\\mathbf{r}_{i-1},\\mathbf{r}_{i-1})=0$，意味着 $\\mathbf{r}_{i-1}=\\mathbf{0}$（精确收敛），并可能导致 $\\mathbf{t}_{i}=\\mathbf{0}$，但是在步长计算中触发除零错误的直接条件是由选项 B 描述的，而非 C 本身。\n\n因此，在计算步长 $\\alpha_{i}$ 或 $\\omega_{i}$ 时直接导致除零失败的条件是 A 和 B。", "answer": "$$\\boxed{AB}$$", "id": "2208883"}]}