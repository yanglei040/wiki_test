## 引言
在优化领域，许多现实世界的决策问题，从生产调度到物流规划，都要求变量取整数值，这类问题被称为[整数线性规划](@entry_id:636600)（ILP）。直接求解IL[P问题](@entry_id:267898)在计算上极具挑战性。一个常见的策略是先忽略整数要求，求解其[线性规划](@entry_id:138188)（LP）松弛问题，但这往往得到一个包含小数的、在现实中不可行的解。那么，我们如何从这个分数解出发，系统地找到真正的整数最优解呢？这正是[割平面法](@entry_id:635930)所要解决的核心问题。

本文将深入探讨[割平面法](@entry_id:635930)这一经典而强大的[优化技术](@entry_id:635438)。我们将分三个主要部分展开：
- 在**“原理和机制”**中，您将学习到[割平面法](@entry_id:635930)的核心思想——如何通过添加新的约束（“割”）来逐步“雕刻”可行域，并掌握Gomory割这一通用[割平面](@entry_id:177960)的生成方法及其与[对偶单纯形法](@entry_id:164344)的结合。
- 接着，在**“应用与跨学科联系”**中，我们将展示[割平面法](@entry_id:635930)在制造业、物流、金融等领域的广泛应用，并探讨其如何融入[分支切割法](@entry_id:637850)和[Benders分解](@entry_id:635451)等更高级的算法框架中。
- 最后，**“动手实践”**部分将提供一系列练习，让您亲手演练从求解[LP松弛](@entry_id:267116)到生成并添加[割平面](@entry_id:177960)的完整流程，将理论知识转化为实践技能。

通过本文的学习，您将不仅理解[割平面法](@entry_id:635930)的数学原理，更能体会到它作为现代优化工具箱中基石的强大威力。

## 原理和机制

在前一章中，我们介绍了[整数线性规划](@entry_id:636600)（ILP）问题及其求解的复杂性。我们看到，简单地将整数变量松弛为连续变量来求解[线性规划](@entry_id:138188)（LP）松弛问题，通常只会得到一个分数解，这对于原始问题是不可行的。本章将深入探讨一种经典而强大的求解[整数规划](@entry_id:178386)问题的方法——**[割平面法](@entry_id:635930)**。其核心思想是通过系统地添加新的约束（即“[割平面](@entry_id:177960)”）来迭代地“切割”掉[LP松弛](@entry_id:267116)可行域中不包含任何整数解的部分，从而逐步收紧可行域，直至最终找到一个整数最优解。

### 核心思想：通过[割平面](@entry_id:177960)收紧[可行域](@entry_id:136622)

想象一个[整数规划](@entry_id:178386)问题的[可行域](@entry_id:136622)。所有满足约束条件的整数点构成了一个离散的点集。这些点的**凸包**（convex hull），即包含所有这些整数可行点的最小凸集，被称为**整数包**（integer hull）。整数包是一个多面体，一个关键的理论事实是：在这个整数包上优化原始的线性[目标函数](@entry_id:267263)，其最优解必然会出现在整数包的某个顶点上，而这些顶点恰好都是整数点。因此，如果我们能够用一组[线性不等式](@entry_id:174297)来精确描述这个整数包，那么求解原始的IL[P问题](@entry_id:267898)就等价于求解一个标准的L[P问题](@entry_id:267898)，这在计算上要容易得多。

然而，直接找到整数包的完整描述通常和求解原始IL[P问题](@entry_id:267898)一样困难。[割平面法](@entry_id:635930)的策略则是一种更为务实的“迂回”战术：它并不试图一次性找到整个整数包，而是从[LP松弛](@entry_id:267116)的可行域开始，逐步地、迭代地添加新的[线性约束](@entry_id:636966)，这些约束被称为**[割平面](@entry_id:177960)**或**割**（cuts）。

一个有效的[割平面](@entry_id:177960)必须满足两个基本属性 [@problem_id:2211973] [@problem_id:2211947] [@problem_id:2211976]：

1.  **有效性**：[割平面](@entry_id:177960)不能切除任何原始问题的可行整数解。换言之，所有满足原始ILP约束的整数点也必须满足这个新的[割平面](@entry_id:177960)约束。
2.  **分离性**：[割平面](@entry_id:177960)必须“切掉”当前[LP松弛](@entry_id:267116)问题的最优分数解。也就是说，当前的分数解违反这个新的[割平面](@entry_id:177960)不等式。

通过迭代地添加这样的[割平面](@entry_id:177960)，我们不断地“雕刻”[LP松弛](@entry_id:267116)的可行域，使其越来越贴近底层的整数包。理想情况下，这个过程最终会产生一个L[P问题](@entry_id:267898)，其最优解恰好是一个整数解，这个解也就是原始IL[P问题](@entry_id:267898)的最优解。

为了更具体地理解这两个属性，我们来看一个例子。假设一个问题的[LP松弛](@entry_id:267116)最优解为 $(x_1^*, x_2^*) = (\frac{55}{26}, \frac{28}{13}) \approx (2.11, 2.15)$。现在我们考虑一个潜在的[割平面](@entry_id:177960) $x_1 + x_2 \le 4$。首先，我们检查分离性：$x_1^* + x_2^* = \frac{55}{26} + \frac{56}{26} = \frac{111}{26} \approx 4.27$，这个值大于4，因此该约束确实切掉了当前的分数解。其次，我们需要验证有效性，即所有可行的整数解都满足 $x_1 + x_2 \le 4$。如果我们通过分析（或者像在教学例子中那样，通过枚举）确认了这一点，那么 $x_1 + x_2 \le 4$ 就是一个有效的[割平面](@entry_id:177960) [@problem_id:2211973]。

相比之下，像 $x_2 \le 2$ 这样的约束可能不是有效的，因为它可能会切除一个可行的整数解（例如，如果 $(1,3)$ 是一个可行整数点）。而像 $x_1 + x_2 \le 5$ 这样的约束，虽然可能不会切掉任何整数解，但它也没有切掉当前的分数解（因为 $4.27 \le 5$），因此在当前迭代中它不是一个有用的[割平面](@entry_id:177960)。

值得注意的是，这种“收紧[可行域](@entry_id:136622)”的策略与**[分支定界法](@entry_id:635251)**（Branch-and-Bound）有着本质的不同 [@problem_id:2211953]。[割平面法](@entry_id:635930)始终在维护和修改一个单一的L[P问题](@entry_id:267898)，通过增加约束来缩小其[可行域](@entry_id:136622)。而[分支定界法](@entry_id:635251)则通过对一个分数变量（例如 $x_i = 2.5$）创建两个分支（$x_i \le 2$ 和 $x_i \ge 3$）来将问题**分割**成两个独立的子问题，从而系统地探索整个[解空间](@entry_id:200470)。

### [割平面](@entry_id:177960)的系统生成：Gomory割

仅仅理解什么是有效的[割平面](@entry_id:177960)是不够的，我们需要一种系统性的方法来**生成**它们。这正是 Ralph Gomory 在20世纪50年代[末期](@entry_id:169480)的开创性贡献。他提出了一种从单纯形表的特定行导出[割平面](@entry_id:177960)的通用方法，这种[割平面](@entry_id:177960)被称为**Gomory割**。

#### Chvátal-Gomory 割的基本原理

在介绍完整的Gomory分数割之前，我们先通过一个更简单的例子来理解其背后的基本思想，这个思想有时被称为**Chvátal-Gomory (CG) 舍入**。

考虑一个由不等式 $Ax \le b$ 定义的LP[可行域](@entry_id:136622)，其中 $x$ 的分量需要取整数。我们可以通过对原始约束进行非负线性组合来得到新的[有效不等式](@entry_id:170492)。例如，如果我们有两个约束 $2x_1 + 5x_2 \le 15$ 和 $6x_1 + 2x_2 \le 17$，我们可以用非负权重 $u_1, u_2$ 将它们组合起来：
$$(2u_1 + 6u_2)x_1 + (5u_1 + 2u_2)x_2 \le 15u_1 + 17u_2$$
这个新不等式对于LP可行域内的所有点都成立。如果我们巧妙地选择 $u_1, u_2$ 使得 $x_1$ 和 $x_2$ 的系数都为整数，那么对于任何整数解 $(x_1, x_2)$，不等式的左边也必然是一个整数。这就意味着，左边的值不能超过右边值的整数部分。

例如，在问题 [@problem_id:2211976] 中，我们有约束 $2x_1 + 4x_2 \le 17$。由于我们关心的是整数解，我们可以安全地将两边同除以2，得到 $x_1 + 2x_2 \le 8.5$。因为 $x_1$ 和 $x_2$ 都是整数，所以左边的 $x_1 + 2x_2$ 也必须是整数。一个小于等于8.5的整数，其最大可能值是8。因此，我们可以推断出所有整数可行解都必须满足以下更强的约束：
$$x_1 + 2x_2 \le 8$$
这就是一个CG割。如果我们当前的LP最优解违反了这个约束（例如，如果解是 $x_1=2.5, x_2=3.1$，则 $2.5 + 2(3.1) = 8.7 > 8$），那么我们就成功地生成了一个有效的[割平面](@entry_id:177960)。

#### Gomory分数割

Gomory分数割是一种更为通用的方法，它可以直接从[LP松弛](@entry_id:267116)问题最优解的单纯形表中导出。假设我们已经求解了[LP松弛](@entry_id:267116)问题，并且在最终的单纯形表中，某个基变量 $x_i$ 的值 $\bar{b}_i$ 是一个分数。对应的单纯形表中的行可以写成一个方程：
$$x_i + \sum_{j \in N} \bar{a}_{ij} x_j = \bar{b}_i$$
其中 $N$ 是非基变量的索引集合，$\bar{a}_{ij}$ 是单纯形表中的系数。

我们将方程中的每个系数（包括右端项 $\bar{b}_i$）都分解为其整数部分 $\lfloor \cdot \rfloor$ 和小数部分 $f(\cdot)$，其中 $f(y) = y - \lfloor y \rfloor$ 且 $0 \le f(y)  1$。
$$x_i + \sum_{j \in N} (\lfloor \bar{a}_{ij} \rfloor + f(\bar{a}_{ij})) x_j = \lfloor \bar{b}_i \rfloor + f(\bar{b}_i)$$
将整数项移到一边，小数项移到另一边：
$$x_i + \sum_{j \in N} \lfloor \bar{a}_{ij} \rfloor x_j - \lfloor \bar{b}_i \rfloor = f(\bar{b}_i) - \sum_{j \in N} f(\bar{a}_{ij}) x_j$$
对于任何满足整数约束的[可行解](@entry_id:634783)，方程的左侧必然是一个整数。因此，右侧也必须是一个整数。

现在我们来分析右侧。由于 $f(\bar{b}_i)$ 是一个真小数（$0  f(\bar{b}_i)  1$，因为我们假设 $\bar{b}_i$ 是分数），并且对于所有非基变量 $x_j \ge 0$ 和系数的小数部分 $f(\bar{a}_{ij}) \ge 0$，我们有 $\sum_{j \in N} f(\bar{a}_{ij}) x_j \ge 0$。因此，右侧 $f(\bar{b}_i) - \sum_{j \in N} f(\bar{a}_{ij}) x_j$ 的值严格小于1。

一个严格小于1的整数，其最大可能值是0。所以，我们必然有：
$$f(\bar{b}_i) - \sum_{j \in N} f(\bar{a}_{ij}) x_j \le 0$$
整理后就得到了**Gomory分数割**：
$$\sum_{j \in N} f(\bar{a}_{ij}) x_j \ge f(\bar{b}_i)$$
这个新的不等式对所有整数可行解都成立，但它被当前的LP最优解所违反（因为在当前解中，所有非基变量 $x_j=0$，导致不等式变为 $0 \ge f(\bar{b}_i)$，而 $f(\bar{b}_i) > 0$，这显然是矛盾的）。因此，这是一个有效的[割平面](@entry_id:177960)。

让我们通过一个具体的例子来演示这个过程 [@problem_id:2211961]。假设我们从单纯形表中选择了基变量 $x_1$ 所在的行：
$$x_1 + \frac{9}{4}s_1 - \frac{1}{4}s_2 = \frac{9}{4}$$
这里的非基变量是[松弛变量](@entry_id:268374) $s_1$ 和 $s_2$。我们计算各项的小数部分：
- 右端项：$f(\frac{9}{4}) = f(2 + \frac{1}{4}) = \frac{1}{4}$
- $s_1$ 的系数：$f(\frac{9}{4}) = f(2 + \frac{1}{4}) = \frac{1}{4}$
- $s_2$ 的系数：$f(-\frac{1}{4}) = f(-1 + \frac{3}{4}) = \frac{3}{4}$

根据Gomory割的公式，我们得到：
$$\frac{1}{4}s_1 + \frac{3}{4}s_2 \ge \frac{1}{4}$$
这个只涉及非基变量的新约束就是一个Gomory割。我们可以引入一个新的[松弛变量](@entry_id:268374) $s_3 \ge 0$ 将其写成等式形式：
$$\frac{1}{4}s_1 + \frac{3}{4}s_2 - s_3 = \frac{1}{4}$$
或者，为了方便添加到单纯形表中，通常写为：
$$s_3 = -\frac{1}{4} + \frac{1}{4}s_1 + \frac{3}{4}s_2$$
这就是我们找到的[割平面](@entry_id:177960)。

### 完整算法：[割平面](@entry_id:177960)与[对偶单纯形法](@entry_id:164344)

现在我们可以将所有部分整合起来，形成完整的[割平面](@entry_id:177960)算法流程：
1.  求解IL[P问题](@entry_id:267898)的[LP松弛](@entry_id:267116)。
2.  检查最优解。如果所有变量均为整数，则[算法终止](@entry_id:143996)，我们找到了ILP的最优解。
3.  如果解是分数的，选择一个值为分数的基变量 $x_i$。
4.  根据 $x_i$ 所在的单纯形表行，生成一个Gomory割。
5.  将这个[割平面](@entry_id:177960)作为一个新的约束添加到L[P问题](@entry_id:267898)中。
6.  重新优化修改后的L[P问题](@entry_id:267898)，然后返回步骤2。

这里的关键在于步骤6：如何高效地“重新优化”？当我们添加一个新约束后，之前的最优解变得不可行了。然而，对于一个最大化问题，它仍然满足[最优性条件](@entry_id:634091)（所有非基变量的[检验数](@entry_id:173345)或简约成本都非正）。这种“对偶可行，主不可行”的状态，正是**[对偶单纯形法](@entry_id:164344)**（Dual Simplex Method）的用武之地。

让我们看一个例子 [@problem_id:2211918]。假设我们已经得到了一个LP最优解，并用字典形式表示：
$Z = \frac{41}{4} - \frac{5}{4}s_1 - \frac{1}{4}s_2$
$x_1 = \frac{15}{4} - \frac{3}{4}s_1 + \frac{1}{4}s_2$
$x_2 = \frac{17}{4} - \frac{1}{4}s_1 - \frac{1}{4}s_2$

当前解为 $(x_1, x_2) = (\frac{15}{4}, \frac{17}{4})$，是分数解。我们从 $x_1$ 所在的行生成Gomory割。$f(\frac{15}{4}) = \frac{3}{4}$， $f(-\frac{3}{4})=\frac{1}{4}$，$f(\frac{1}{4})=\frac{1}{4}$。[割平面](@entry_id:177960)是 $\frac{1}{4}s_1 + \frac{1}{4}s_2 \ge \frac{3}{4}$。引入新的[松弛变量](@entry_id:268374) $s_3 \ge 0$ 并改写，得到新约束：
$$s_3 = -\frac{3}{4} + \frac{1}{4}s_1 + \frac{1}{4}s_2$$ 
*注：这里我们使用问题中给出的[割平面](@entry_id:177960) $s_3 = -\frac{3}{4} + \frac{3}{4}s_1 + \frac{3}{4}s_2$ 来继续演示。*

我们将这个新约束添加到系统中。在新的基解中（$s_1=0, s_2=0$），我们得到 $s_3 = -\frac{3}{4}$。这个负值表明当前基解是主不可行的。[对偶单纯形法](@entry_id:164344)的步骤如下：
1.  **选择出基变量**：选择值为负的基变量。这里只有 $s_3$ 是候选者，因此 $s_3$ 将离开基。
2.  **选择入基变量**：查看 $s_3$ 所在行的非基变量的系数。对于系数为正的非基变量，计算目标函数中其[检验数](@entry_id:173345)与该行中其系数的比值，选择使得该比值最大的变量（即最接近0的负数）入基。在我们的例子中，目标行是 $Z = \frac{41}{4} - \frac{5}{4}s_1 - \frac{1}{4}s_2$， $s_3$ 所在行是 $s_3 = -\frac{3}{4} + \frac{3}{4}s_1 + \frac{3}{4}s_2$。
    - 对 $s_1$：比值为 $(-\frac{5}{4}) / (\frac{3}{4}) = -\frac{5}{3}$
    - 对 $s_2$：比值为 $(-\frac{1}{4}) / (\frac{3}{4}) = -\frac{1}{3}$
    我们选择比值最大的那个（即最接近0的负数），即 $-\frac{1}{3}$。因此，$s_2$ 进入基。
3.  **执行主元变换**：用 $s_3$ 的方程来表达 $s_2$，并代入到系统的其他方程中。经过代数运算，我们得到一个新的字典，其基解是 $(x_1, x_2) = (4, 4)$。这个解是整数解，且由于[对偶单纯形法](@entry_id:164344)保持对偶可行性，这也是当前LP的最优解。因此，[算法终止](@entry_id:143996)，我们找到了ILP的最优解 $(4,4)$。

### 高级主题与实践考量

#### 收敛性与循环问题

一个自然的问题是：[割平面](@entry_id:177960)算法是否总能保证在有限步内终止？答案是，不一定。在某些退化的情况下，算法可能会陷入循环，不断添加[割平面](@entry_id:177960)但最优目标值没有改善。为了保证算法的**有限终止性**，需要采用特殊的**主元[选择规则](@entry_id:140784)**来打破循环，例如**[字典序](@entry_id:143032)规则**（lexicographical pivot rule）[@problem_id:2211977]。

其基本思想是将整个单纯形表（或字典）的行向量按特定顺序列成一个大的行向量。字典序规则确保在每次主元变换后，这个代表整个表状态的大向量在字典序上是严格减小的。因为对于一个给定的问题，可能的基和对应的单纯形表数量是有限的，所以一个严格递减的序列不可能无限地持续下去。这从理论上保证了[对偶单纯形法](@entry_id:164344)的每轮重新优化都会在有限步内结束，进而保证了整个[割平面](@entry_id:177960)算法的收敛性。

#### [割平面](@entry_id:177960)选择策略

当[LP松弛](@entry_id:267116)解中有多个分数基变量时，我们可以从多个行生成不同的Gomory割。那么应该选择哪一个呢？这引出了**[割平面](@entry_id:177960)选择策略**的问题，因为不同[割平面](@entry_id:177960)的“质量”不同，选择好的[割平面](@entry_id:177960)可能会显著加速算法的收敛。

常见的[启发式](@entry_id:261307)策略包括 [@problem_id:2211927]：

-   **最深割**（Deepest Cut）：选择与当前LP最优分数解距离最远的[割平面](@entry_id:177960)。几何直观上，这样的[割平面](@entry_id:177960)“切得最深”，可能一次性排除掉更大体积的可行域，从而带来更快的进展。
-   **[梯度对齐](@entry_id:172328)割**（Gradient-Aligned Cut）：选择其法向量与目标函数[梯度向量](@entry_id:141180)最对齐的[割平面](@entry_id:177960)。直观上，这种[割平面](@entry_id:177960)在“正确”的方向上切割可行域，即在推动解朝向最优目标值的方向上施加最大的压力。

在实践中，这两种策略可能会选择不同的[割平面](@entry_id:177960)。例如，在一个问题中，通过计算发现“最深割”策略选择的[割平面](@entry_id:177960)是 $3x_1 + 7x_2 \le 20$，而“[梯度对齐](@entry_id:172328)割”策略选择的[割平面](@entry_id:177960)是 $13x_1 + 22x_2 \le 70$ [@problem_id:2211927]。选择哪种策略是一个复杂的权衡，现代求解器可能会使用这些思想的更复杂组合。

#### 数值不稳定性

尽管[割平面法](@entry_id:635930)在理论上很优美，但在实践中，尤其是在处理大规模问题时，可能会遇到严重的**数值不稳定性**问题 [@problem_id:2211930]。当算法迭代进行，添加了成百上千个[割平面](@entry_id:177960)后，一个常见的问题是，许多新添加的[割平面](@entry_id:177960)在当前最优解附近是**几乎平行**的。

当一组在基中的约束（在单纯形法的顶点上是紧的约束）几乎平行时，它们对应的系数矩阵的行向量是近似[线性相关](@entry_id:185830)的。这意味着该矩阵的**条件数**（condition number）会非常大，矩阵接近于奇异。从数值分析的角度来看，求解一个由病态（ill-conditioned）矩阵定义的线性系统对输入数据的微小扰动非常敏感。在LP求解器中，这会导致[浮点运算误差](@entry_id:637950)被放大，从而产生各种问题：求解器可能错误地报告矩阵是奇异的而失败，或者对约束系数的微小变化（甚至只是机器精度误差）产生巨大的解的波动，使得一个点被错误地判断为可行或不可行。这是纯[割平面法](@entry_id:635930)在商业求解器中通常不被单独使用，而是与[分支定界法](@entry_id:635251)结合成“[分支切割法](@entry_id:637850)”（Branch-and-Cut）的主要原因之一。

#### 对偶视角

最后，我们可以从[对偶理论](@entry_id:143133)的更深层次来理解[割平面](@entry_id:177960)。向[主问题](@entry_id:635509)（primal problem）添加一个新约束（[割平面](@entry_id:177960)），在[对偶问题](@entry_id:177454)（dual problem）中对应着增加一个新的[对偶变量](@entry_id:143282)。整个[割平面法](@entry_id:635930)可以被看作是在对偶空间中寻找一个更好的对偶可行解的过程 [@problem_id:2211955]。通过[拉格朗日松弛](@entry_id:635609)等技术，可以证明生成[割平面](@entry_id:177960)等价于求解一个相关的[对偶问题](@entry_id:177454)。这个视角为设计更强大的[割平面](@entry_id:177960)（如混合整数舍入割、覆盖割等）提供了坚实的理论基础，这些内容将在更高级的课程中探讨。