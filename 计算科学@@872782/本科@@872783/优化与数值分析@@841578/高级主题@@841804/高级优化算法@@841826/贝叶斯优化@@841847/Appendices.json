{"hands_on_practices": [{"introduction": "贝叶斯优化的核心在于其智能地选择下一个评估点，以在“探索”（exploration）和“利用”（exploitation）之间取得平衡。“置信上界”（Upper Confidence Bound, UCB）采集函数是实现这一平衡的经典策略。本练习将让你亲手应用UCB公式 $A(x) = \\mu(x) + \\kappa \\sigma(x)$，通过计算来决定在给定的代理模型（surrogate model）下，哪一个候选点最有价值，从而深入理解探索-利用的权衡[@problem_id:2156656]。", "problem": "一位数据科学家正在使用带有高斯过程代理模型的贝叶斯优化来为一个机器学习模型调整超参数 $\\lambda$。目标是最大化模型的验证准确率。经过一组初始评估后，代理模型为 $\\lambda$ 的五个候选值提供了以下后验统计数据（平均准确率 $\\mu$ 和准确率标准差 $\\sigma$）：\n\n*   A点：$\\lambda = 0.10$，平均准确率 $\\mu = 0.915$，标准差 $\\sigma = 0.010$\n*   B点：$\\lambda = 0.25$，平均准确率 $\\mu = 0.920$，标准差 $\\sigma = 0.005$\n*   C点：$\\lambda = 0.50$，平均准确率 $\\mu = 0.890$，标准差 $\\sigma = 0.025$\n*   D点：$\\lambda = 0.75$，平均准确率 $\\mu = 0.910$，标准差 $\\sigma = 0.014$\n*   E点：$\\lambda = 0.90$，平均准确率 $\\mu = 0.905$，标准差 $\\sigma = 0.018$\n\n该数据科学家正在使用上置信界 (UCB) 采集函数来决定接下来要评估哪个 $\\lambda$ 值。UCB 策略定义为选择使量 $A(x) = \\mu(x) + \\kappa \\sigma(x)$ 最大化的点 $x$。在此优化步骤中，探索-利用权衡参数设置为 $\\kappa = 2.5$。\n\n根据 UCB 采集函数，五个候选点中的哪一个将被选择用于下一次评估？\n\nA. A点\n\nB. B点\n\nC. C点\n\nD. D点\n\nE. E点", "solution": "我们使用上置信界 (UCB) 采集函数，它选择使 $A(x) = \\mu(x) + \\kappa \\sigma(x)$ 最大化的点 $x$。这里，$\\kappa = 2.5$。对于每个候选点：\n\n对于A点：\n$$A(\\text{A}) = 0.915 + 2.5 \\times 0.010 = 0.915 + 0.025 = 0.940.$$\n\n对于B点：\n$$A(\\text{B}) = 0.920 + 2.5 \\times 0.005 = 0.920 + 0.0125 = 0.9325.$$\n\n对于C点：\n$$A(\\text{C}) = 0.890 + 2.5 \\times 0.025 = 0.890 + 0.0625 = 0.9525.$$\n\n对于D点：\n$$A(\\text{D}) = 0.910 + 2.5 \\times 0.014 = 0.910 + 0.035 = 0.945.$$\n\n对于E点：\n$$A(\\text{E}) = 0.905 + 2.5 \\times 0.018 = 0.905 + 0.045 = 0.950.$$\n\n比较这些采集值，最大值为 $0.9525$，在C点取得。因此，UCB 策略选择 C 点。", "answer": "$$\\boxed{C}$$", "id": "2156656"}, {"introduction": "当贝叶斯优化过程（例如，实验预算用尽）结束后，我们如何从充满噪声的观测数据中确定最终的最优参数？这个实际问题是应用贝叶斯优化时的关键一步。本练习将通过一个具体场景，帮助你辨析单个的最佳“观测值”与模型给出的最佳“后验均值”之间的区别，并理解为什么后者才是更可靠的最终推荐选择[@problem_id:2156691]。", "problem": "一位材料科学家正在使用贝叶斯优化 (BO) 来寻找最佳固化温度 $x$，以最大化一种新型聚合物复合材料的拉伸强度 $f(x)$。拉伸强度的测量会受到实验噪声的影响。该科学家使用高斯过程 (GP) 对未知函数 $f(x)$ 进行建模。\n\n在进行了四次实验后，优化预算已经用尽。收集到的数据由成对的固化温度（单位：摄氏度）和相应的带噪声的拉伸强度测量值（单位：兆帕，MPa）组成。GP 模型为任意温度 $x$ 下的拉伸强度提供了后验均值 $\\mu(x)$ 和后验标准差 $\\sigma(x)$。\n\n四次实验的结果如下：\n\n| 实验 | 温度 $x$ ($^{\\circ}$C) | 观测强度 $y$ (MPa) | 后验均值 $\\mu(x)$ (MPa) | 后验标准差 $\\sigma(x)$ (MPa) |\n|------------|------------------------------|-------------------------------|---------------------------------|------------------------------------------|\n| 1          | 120                          | 315.4                         | 316.0                           | 1.8                                      |\n| 2          | 130                          | 325.1                         | 322.5                           | 1.7                                      |\n| 3          | 140                          | 324.8                         | 326.2                           | 1.9                                      |\n| 4          | 150                          | 320.7                         | 321.0                           | 2.5                                      |\n\n现在，这位科学家必须为该聚合物的批量生产推荐一个唯一的最佳温度。根据以上数据，应该推荐哪个温度？并且选择该温度的正确理由是什么？\n\nA. 推荐 $140^{\\circ}$C，因为其对应的后验均值最高，这代表了模型在考虑所有数据并滤除噪声后，对真实最大强度的最佳估计。\n\nB. 推荐 $130^{\\circ}$C，因为它产生了最高的直接观测拉伸强度，而经验测量值比模型预测更值得信赖。\n\nC. 推荐 $150^{\\circ}$C，因为该温度下的高后验标准差表明，它具有最大的未探索潜力，可能产生比已观测到的更高的强度。\n\nD. 推荐 $130^{\\circ}$C，因为它与其他点相比具有相对较低的后验标准差，这表明其较高的测量强度是一个可靠的结果。", "solution": "贝叶斯优化的目标是找到一个未知的、可能带有噪声的函数 $f(x)$ 的全局最优解。在这个问题中，需要最大化的函数是聚合物的拉伸强度，它是固化温度的函数。优化过程已经结束，最终任务不是进一步探索，而是利用已获得的知识来做出最佳推荐。这意味着我们必须确定最有可能产生真实的、潜在函数 $f(x)$ 最大值的输入 $x$，而不仅仅是带噪声的最大观测值 $y$。\n\n让我们分析一下问题的各个组成部分：\n1.  **观测强度 ($y$)**: $y$ 值是真实强度的带噪声测量值。某个特定的观测值由 $y_i = f(x_i) + \\epsilon_i$ 给出，其中 $\\epsilon_i$ 是一个随机噪声项。因此，在 $x = 130^{\\circ}$C 时的最高观测值 $y = 325.1$ MPa，可能是一个中等高的真实强度与一个大的正向噪声波动相结合的结果。仅仅依赖单个最佳观测值是一种脆弱的策略，因为它忽略了数据的噪声特性。\n\n2.  **后验均值 ($\\mu(x)$)**: 高斯过程 (GP) 模型在给定观测数据的情况下，提供了函数 $f(x)$ 的后验分布。后验均值 $\\mu(x)$ 代表了在输入 $x$ 处真实函数 $f(x)$ 的期望值。它是通过考虑*所有*数据点的影响来计算的，这些数据点根据它们的邻近程度和模型的关联性假设进行加权。因此，$\\mu(x)$ 可作为真实函数的去噪估计。为了最大化真实强度 $f(x)$，我们的最佳策略是选择能够最大化我们对 $f(x)$ 的估计值的 $x$，而这个估计值正是后验均值 $\\mu(x)$。\n\n3.  **后验标准差 ($\\sigma(x)$)**: 这个值量化了模型对其估计值 $\\mu(x)$ 的不确定性。在优化阶段（现已完成），高的不确定性对于探索是有价值的。例如，像上置信界 (UCB) 这样的采集函数，定义为 $\\text{UCB}(x) = \\mu(x) + \\beta \\sigma(x)$，它在高均值区域的利用 (exploitation) 和高不确定性区域的探索 (exploration) 之间进行权衡。然而，一旦过程结束需要做出最终推荐时，目标就是纯粹的利用。当需要一个最终的、唯一的最佳选择时，仅仅因为一个点的不确定性高（探索）而选择它是不正确的。\n\n基于以上理解，让我们评估各个选项：\n-   **_选项 A_**: 此选项建议选择 $x = 140^{\\circ}$C。查看表格，后验均值 $\\mu(140) = 326.2$ MPa 是 $\\mu(x)$ 列中的最大值。其理由是后验均值是模型对真实函数的最佳估计，已经滤除了噪声。这与贝叶斯优化中的利用原则完全一致。我们希望推荐模型认为是真实最优点的那一点。\n\n-   **_选项 B_**: 此选项建议选择 $x = 130^{\\circ}$C，因为它产生了最高的观测值 $y = 325.1$ MPa。如前所述，这忽略了噪声的影响。模型在该点的后验均值 $\\mu(130) = 322.5$ MPa 显著低于观测值，表明模型将该高读数部分归因于正向噪声。这个选择并非最优。\n\n-   **_选项 C_**: 此选项建议选择 $x = 150^{\\circ}$C，因为其不确定性高 ($\\sigma(150) = 2.5$ MPa)。这是一种探索策略，而不是利用策略。如果预算没有用尽，这是决定*下一步*在哪里采样的有效考虑，但它不是做出最终推荐的正确策略。目标不再是改进模型，而是使用当前模型做出最佳选择。\n\n-   **_选项 D_**: 此选项建议选择 $x = 130^{\\circ}$C，但其理由是基于其低不确定性。虽然低不确定性意味着可靠性，但主要目标是最大化函数值。一个对次优值的高度可靠的估计，并不比一个对更优值稍微不那么可靠的估计更好。推荐应基于期望结果 ($\\mu(x)$)，而不仅仅是其确定性 ($\\sigma(x)$)。点 $x = 140^{\\circ}$C 有更高的期望结果 $\\mu(140) = 326.2$ MPa，尽管其不确定性比 $x=130^{\\circ} \\text{C}$ 略高，但这使其成为更好的选择。\n\n因此，正确的做法是相信模型的去噪估计，即后验均值，并选择使其最大化的输入。最高的后验均值是 $326.2$ MPa，对应的温度是 $140^{\\circ}$C。", "answer": "$$\\boxed{A}$$", "id": "2156691"}, {"introduction": "贝叶斯优化的威力不仅限于寻找最大值或最小值，它本质上是一个在不确定性下进行高效序贯决策的通用框架。这个高级练习将挑战你跳出传统优化思维，为一个新颖的目标——寻找昂贵“黑箱”函数的根（即函数值为零的点）——设计一个全新的采集函数。通过推导这个“概率寻根”（Probabilistic Root Finder）采集函数，你将体会到如何灵活运用高斯过程代理模型来解决更多样的科学与工程问题[@problem_id:2156644]。", "problem": "一个材料科学研究团队正在开发一种新的热电合金。目标是找到一个特定的掺杂浓度 $x$，使得在某一关键工作温度下，塞贝克系数恰好为零，因为这是无源热传感器应用的一项关键要求。将塞贝克系数 $S(x)$ 与掺杂浓度 $x$ 相关联的函数是未知的，并且通过实验进行评估的成本非常高昂。因此，该团队采用贝叶斯优化来指导他们的实验。\n\n其贝叶斯优化框架的核心是一个高斯过程 (GP)，用于对未知函数 $S(x)$ 进行建模。经过一组初步实验后，高斯过程提供了关于该函数的后验信念。对于任何未经评估的浓度 $x$，塞贝克系数 $S(x)$ 的后验分布是一个正态分布，其特征在于后验均值 $\\mu(x)$ 和后验标准差 $\\sigma(x)$。即，$S(x) \\sim \\mathcal{N}(\\mu(x), \\sigma^2(x))$。\n\n为了决定下一个要测试的掺杂浓度，团队需要一个他们将要最大化的采集函数 $\\alpha(x)$。一种可行的策略是查询使得函数值为零的后验概率密度最大化的点 $x$。我们将此称为概率求根器 (Probabilistic Root Finder, PRF) 采集函数，记作 $\\alpha_{PRF}(x)$。\n\n你的任务是根据高斯过程提供的后验均值 $\\mu(x)$ 和后验标准差 $\\sigma(x)$，推导出概率求根器采集函数 $\\alpha_{PRF}(x)$ 的闭式解析表达式。", "solution": "本题要求推导概率求根器 (PRF) 采集函数 $\\alpha_{PRF}(x)$。该函数被定义为：在给定高斯过程模型的条件下，函数值 $S(x)$ 等于零的后验概率密度。\n\n题目指出，在任意点 $x$ 处函数 $S(x)$ 值的后验信念由一个正态（高斯）分布建模：\n$$\nS(x) \\sim \\mathcal{N}(\\mu(x), \\sigma^2(x))\n$$\n在此，$\\mu(x)$ 是后验均值，$\\sigma^2(x)$ 是后验方差。标准差为 $\\sigma(x)$。\n\n对于一个均值为 $\\mu_Y$、方差为 $\\sigma_Y^2$ 的一般正态随机变量 $Y$，其概率密度函数 (PDF) 由以下公式给出：\n$$\np(Y=y) = \\frac{1}{\\sqrt{2\\pi\\sigma_Y^2}} \\exp\\left( -\\frac{(y - \\mu_Y)^2}{2\\sigma_Y^2} \\right)\n$$\n这可以写成以标准差 $\\sigma_Y$ 表示的形式：\n$$\np(Y=y) = \\frac{1}{\\sigma_Y \\sqrt{2\\pi}} \\exp\\left( -\\frac{(y - \\mu_Y)^2}{2\\sigma_Y^2} \\right)\n$$\n为了找到采集函数 $\\alpha_{PRF}(x)$，我们需要针对我们的具体情况来评估这个 PDF。\n随机变量是塞贝克系数，所以我们确定 $Y = S(x)$。\n分布的均值是 $\\mu_Y = \\mu(x)$。\n分布的标准差是 $\\sigma_Y = \\sigma(x)$。\n我们关心的是函数值为零时的概率密度，所以我们设定 $y = 0$。\n\n将这些部分代入通用的 PDF 公式，我们得到 $\\alpha_{PRF}(x)$ 的表达式：\n$$\n\\alpha_{PRF}(x) = p(S(x)=0) = \\frac{1}{\\sigma(x) \\sqrt{2\\pi}} \\exp\\left( -\\frac{(0 - \\mu(x))^2}{2\\sigma(x)^2} \\right)\n$$\n化简指数内的项，得到最终表达式：\n$$\n\\alpha_{PRF}(x) = \\frac{1}{\\sigma(x) \\sqrt{2\\pi}} \\exp\\left( -\\frac{\\mu(x)^2}{2\\sigma(x)^2} \\right)\n$$\n这就是概率求根器采集函数的闭式解析表达式。在实践中，为了选择下一个采样点，人们会求解优化问题 $x_{next} = \\arg\\max_x \\alpha_{PRF}(x)$，并且为了简化，通常会省略常数因子 $1/\\sqrt{2\\pi}$。", "answer": "$$\\boxed{\\frac{1}{\\sigma(x)\\sqrt{2\\pi}} \\exp\\left(-\\frac{\\mu(x)^2}{2\\sigma(x)^2}\\right)}$$", "id": "2156644"}]}