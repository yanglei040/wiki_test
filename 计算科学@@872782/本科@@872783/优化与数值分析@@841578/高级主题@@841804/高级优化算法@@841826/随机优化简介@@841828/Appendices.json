{"hands_on_practices": [{"introduction": "最短路径问题是确定性优化中的一个经典问题。然而，在现实世界中，诸如交通时间之类的变量往往充满不确定性。本练习将向您展示如何使用样本均值近似（SAA）方法，将这个经典问题扩展到随机环境中，这是随机优化领域的一项基础技术。[@problem_id:2182114]", "problem": "一家物流公司正在使用模拟来优化一个拥堵的小型城区的配送路线。该城区的道路网络可以建模为由四个交叉口（标记为1、2、3和4）和五条双向路段组成的集合。这些路段是(1,2)、(1,3)、(2,3)、(2,4)和(3,4)。\n\n为了考虑交通的可变性，该公司运行了五次模拟，每次模拟代表一种不同的可能交通情景。下表给出了在每种情景下，穿越各路段所需的行程时间（单位：分钟）。\n\n| 路段    | 情景 1 | 情景 2 | 情景 3 | 情景 4 | 情景 5 |\n|--------------|------------|------------|------------|------------|------------|\n| (1,2)        | 15         | 25         | 18         | 22         | 20         |\n| (1,3)        | 30         | 12         | 15         | 18         | 25         |\n| (2,3)        | 10         | 8          | 12         | 15         | 5          |\n| (2,4)        | 35         | 40         | 28         | 30         | 32         |\n| (3,4)        | 20         | 25         | 35         | 30         | 20         |\n\n您的任务是找到从交叉口1到交叉口4的最佳路线。您需要使用样本均值近似（SAA）方法。在SAA方法中，每个路段的真实（但未知）期望行程时间由其样本均值来近似，该均值是根据模拟数据计算得出的。于是，问题就变成了寻找具有最小总近似行程时间的路径。\n\n根据这个SAA模型，从交叉口1到交叉口4的行程的估计最小平均行程时间是多少？请用分钟作答，并四舍五入到三位有效数字。", "solution": "我们应用样本均值近似（SAA）方法：对于每个路段 $e$，我们用5个情景下的样本均值来近似其期望行程时间，\n$$\n\\hat{t}_{e}=\\frac{1}{5}\\sum_{s=1}^{5}t_{e}^{(s)}.\n$$\n计算所有路段的样本均值：\n- 对于 $(1,2)$:\n$$\n\\hat{t}_{12}=\\frac{1}{5}(15+25+18+22+20)=\\frac{100}{5}=20.\n$$\n- 对于 $(1,3)$:\n$$\n\\hat{t}_{13}=\\frac{1}{5}(30+12+15+18+25)=\\frac{100}{5}=20.\n$$\n- 对于 $(2,3)$:\n$$\n\\hat{t}_{23}=\\frac{1}{5}(10+8+12+15+5)=\\frac{50}{5}=10.\n$$\n- 对于 $(2,4)$:\n$$\n\\hat{t}_{24}=\\frac{1}{5}(35+40+28+30+32)=\\frac{165}{5}=33.\n$$\n- 对于 $(3,4)$:\n$$\n\\hat{t}_{34}=\\frac{1}{5}(20+25+35+30+20)=\\frac{130}{5}=26.\n$$\n\n使用这些边权重，计算从1到4的简单路径的总时间：\n- 路径 $1\\to 2\\to 4$：$20+33=53$。\n- 路径 $1\\to 3\\to 4$：$20+26=46$。\n- 路径 $1\\to 2\\to 3\\to 4$：$20+10+26=56$。\n- 路径 $1\\to 3\\to 2\\to 4$：$20+10+33=63$。\n\n最小总时间为 $46$，路径为 $1\\to 3\\to 4$。四舍五入到三位有效数字得到 $46.0$。", "answer": "$$\\boxed{46.0}$$", "id": "2182114"}, {"introduction": "虽然样本均值近似（SAA）是一个强大的工具，但它终究是一种近似方法。本练习将通过一个农业规划的例子，将基于小样本的SAA解决方案与已知的真实最优解进行比较，从而深入探讨这一概念。这个对比突出了样本规模的重要性以及SAA作为一种实用工具的本质。[@problem_id:2182086]", "problem": "一位农场经理必须决定在即将到来的季节里种植多少英亩的玉米（$x_1$）和多少英亩的小麦（$x_2$）。该经理总共有100英亩的土地可供使用。种植需要一种特殊的肥料，总共有240个单位可用。玉米每英亩需要4个单位的肥料，而小麦每英亩需要2个单位。\n\n每种作物的每英亩利润是不确定的，取决于季节性降雨量，降雨量可以是“低”、“中”或“高”。下表给出了每种情景的概率以及相应的每英亩利润（单位：美元）：\n\n| 降雨情景 | 概率 | 玉米利润 ($c_1$) | 小麦利润 ($c_2$) |\n|:---:|:---:|:---:|:---:|\n| 低 | 0.2 | 100 | 180 |\n| 中 | 0.5 | 200 | 150 |\n| 高 | 0.3 | 250 | 100 |\n\n经理希望确定能使期望总利润最大化的种植策略 $(x_1, x_2)$。这就是“真实”的随机问题。\n\n作为比较，另一种方法是使用有限的样本集来解决一个近似问题。这种方法被称为样本均值近似（SAA）。经理获得了一份预报，该预报为本季节提供了一个包含10个预测降雨结果的特定序列：\n['低', '低', '中', '低', '中', '高', '低', '中', '低', '中']\n\n计算解决真实随机问题的最优种植策略 $(x_{1,\\text{true}}, x_{2,\\text{true}})$，以及解决SAA问题的最优策略 $(x_{1,\\text{SAA}}, x_{2,\\text{SAA}})$。你的最终答案应该是一组四个数值，代表 $(x_{1,\\text{true}}, x_{2,\\text{true}}, x_{1,\\text{SAA}}, x_{2,\\text{SAA}})$，每个数值的单位都是英亩。", "solution": "设 $x_{1}$ 和 $x_{2}$ 分别表示玉米和小麦的种植英亩数。约束条件为：\n$$\nx_{1}+x_{2}\\leq 100,\\quad 4x_{1}+2x_{2}\\leq 240,\\quad x_{1}\\geq 0,\\ x_{2}\\geq 0.\n$$\n真实随机问题的目标是最大化期望利润。设 $c_{1}$ 和 $c_{2}$ 分别为玉米和小麦的每英亩利润。对于情景 $\\{\\text{低},\\text{中},\\text{高}\\}$ 和概率 $\\{0.2,0.5,0.3\\}$，每英亩的期望利润为\n$$\n\\mathbb{E}[c_{1}]=0.2\\cdot 100+0.5\\cdot 200+0.3\\cdot 250=195,\\quad\n\\mathbb{E}[c_{2}]=0.2\\cdot 180+0.5\\cdot 150+0.3\\cdot 100=141.\n$$\n因此，真实问题是\n$$\n\\max\\ 195\\,x_{1}+141\\,x_{2}\\quad\\text{s.t.}\\quad x_{1}+x_{2}\\leq 100,\\ 4x_{1}+2x_{2}\\leq 240,\\ x_{1},x_{2}\\geq 0.\n$$\n列举可行域的顶点。约束条件 $x_{1}+x_{2}=100$ 和 $2x_{1}+x_{2}=120$（后者等价于 $4x_{1}+2x_{2}=240$）相交于 $x_{1}=20, x_{2}=80$。顶点集为 $(0,0)$、$(60,0)$、$(0,100)$ 和 $(20,80)$。目标函数值为：\n$$\n(60,0):\\ 195\\cdot 60=11700,\\quad (0,100):\\ 141\\cdot 100=14100,\\quad (20,80):\\ 195\\cdot 20+141\\cdot 80=15180.\n$$\n最优解为 $(x_{1,\\text{true}},x_{2,\\text{true}})=(20,80)$。\n\n对于样本均值近似（SAA），用给定的10个结果的样本均值代替期望值。经验频率为 $\\{\\text{低}:5/10,\\ \\text{中}:4/10,\\ \\text{高}:1/10\\}$。样本均值的每英亩利润为\n$$\n\\bar{c}_{1}=\\frac{1}{10}\\left(5\\cdot 100+4\\cdot 200+1\\cdot 250\\right)=155,\\quad\n\\bar{c}_{2}=\\frac{1}{10}\\left(5\\cdot 180+4\\cdot 150+1\\cdot 100\\right)=160.\n$$\nSAA问题是\n$$\n\\max\\ 155\\,x_{1}+160\\,x_{2}\\quad\\text{s.t.}\\quad x_{1}+x_{2}\\leq 100,\\ 4x_{1}+2x_{2}\\leq 240,\\ x_{1},x_{2}\\geq 0.\n$$\n在相同的顶点上计算目标函数值：\n$$\n(60,0):\\ 155\\cdot 60=9300,\\quad (0,100):\\ 160\\cdot 100=16000,\\quad (20,80):\\ 155\\cdot 20+160\\cdot 80=15900.\n$$\n最优解为 $(x_{1,\\text{SAA}},x_{2,\\text{SAA}})=(0,100)$。\n\n因此，所求的四元组是 $(20,80,0,100)$，单位为英亩。", "answer": "$$\\boxed{\\begin{pmatrix} 20  80  0  100 \\end{pmatrix}}$$", "id": "2182086"}, {"introduction": "现在让我们来探讨一个更高级的场景：两阶段随机规划，决策是在不确定性揭晓前后分阶段进行的。这个问题更进一步，要求您决定对市场研究的最佳投资额以减少不确定性，从而阐释决策中“信息价值”这一强大概念。[@problem_id:2182118]", "problem": "一家科技初创公司正准备推出其全新的、高度专业化的处理芯片。该公司面临着该芯片市场需求的巨大不确定性。根据初步分析，管理团队认为第一个生产周期存在两种等可能的市场需求情景：“低需求” $d_L = 5000$ 单位和“高需求” $d_H = 10000$ 单位。每种情景的先验概率为 0.5。\n\n生产过程分为两个阶段。在第一阶段，实际市场需求未知之前，公司必须决定一个初始生产数量 $x$。此阶段每块芯片的生产成本为 $c = \\$80$。产品发布后，真实需求 $D$ 将被揭示。如果初始产量 $x$ 小于需求 $D$，公司必须通过使用更昂贵的加急生产流程来弥补缺口，每单位成本为 $c_e = \\$210$。如果初始产量 $x$ 超过需求 $D$，多余的单位必须被储存并最终进行残值处理，每单位产生 $h = \\$20$ 的有效持有成本。\n\n为了降低风险，公司可以选择在投入初始生产前委托进行市场研究。该研究提供一个简单的预测： “乐观” ($S_O$) 或 “悲观” ($S_P$) 。研究的质量由一个准确度参数 $\\alpha$ 决定，公司可以在 $[0.5, 1]$ 的范围内选择该参数。准确度由条件概率 $P(S_O | D=d_H) = \\alpha$ 和 $P(S_P | D=d_L) = \\alpha$ 定义。根据对称性，这意味着 $P(S_O | D=d_L) = 1-\\alpha$ 和 $P(S_P | D=d_H) = 1-\\alpha$。准确度 $\\alpha=0.5$ 代表一个无用的预测（相当于抛硬币），而 $\\alpha=1$ 代表一个完美的预测。委托进行准确度为 $\\alpha$ 的研究的成本由函数 $C(\\alpha) = K(\\alpha - 0.5)^2$ 给出，其中成本系数为 $K = \\$2,000,000$。\n\n公司的目标是选择预测准确度水平 $\\alpha$ 及后续的生产数量，以最小化总期望成本，该成本包括市场研究成本、第一阶段生产成本以及预期的第二阶段成本（缺货或库存过剩成本）。\n\n确定公司应选择的最优市场研究准确度 $\\alpha^*$。将最终答案四舍五入到四位有效数字。", "solution": "首先，我们定义在给定生产水平 $x$ 和需求 $D$ 下的总成本函数：\n$$ C(x, D) = c x + c_e (D-x)^+ + h (x-D)^+ $$\n其中 $(z)^+ = \\max(0, z)$，$c=80$，$c_e=210$，$h=20$。\n\n在不确定性下，对于给定的需求概率分布，我们的目标是选择 $x$ 来最小化期望成本 $\\mathbb{E}[C(x, D)]$。由于需求只有两个可能的值 $d_L=5000$ 和 $d_H=10000$，最优的生产决策 $x^*$ 也只会是这两个值之一。我们通过比较在 $x=d_L$ 和 $x=d_H$ 时的期望成本来做出决策。\n设高需求的概率为 $p = P(D=d_H)$。\n- 如果生产 $x=d_L$，期望成本为：$EC(d_L) = c d_L + p \\cdot c_e (d_H - d_L)$。\n- 如果生产 $x=d_H$，期望成本为：$EC(d_H) = c d_H + (1-p) \\cdot h (d_H - d_L)$。\n\n我们应该选择生产 $d_L$ 如果 $EC(d_L)  EC(d_H)$，即：\n$ c d_L + p c_e (d_H - d_L)  c d_H + (1-p) h (d_H - d_L) $\n$ p(c_e + h)  c + h $\n$ p  \\frac{c+h}{c_e+h} $\n这个临界概率为 $p_{crit} = \\frac{80+20}{210+20} = \\frac{100}{230} \\approx 0.4348$。\n决策规则是：如果高需求的概率 $p  p_{crit}$，则生产 $d_L$；否则，生产 $d_H$。\n\n接下来，我们分析市场研究的价值。研究的准确度为 $\\alpha$。\n先验概率为 $P(D=d_H) = P(D=d_L) = 0.5$。\n利用贝叶斯定理计算后验概率：\n- 收到“乐观”信号 $S_O$ 时，高需求的后验概率为：$P(D=d_H|S_O) = \\frac{P(S_O|d_H)P(d_H)}{P(S_O|d_H)P(d_H)+P(S_O|d_L)P(d_L)} = \\frac{\\alpha \\cdot 0.5}{\\alpha \\cdot 0.5 + (1-\\alpha) \\cdot 0.5} = \\alpha$。\n- 收到“悲观”信号 $S_P$ 时，高需求的后验概率为：$P(D=d_H|S_P) = \\frac{P(S_P|d_H)P(d_H)}{P(S_P|d_H)P(d_H)+P(S_P|d_L)P(d_L)} = \\frac{(1-\\alpha) \\cdot 0.5}{(1-\\alpha) \\cdot 0.5 + \\alpha \\cdot 0.5} = 1-\\alpha$。\n信号出现的概率均为 $P(S_O)=P(S_P)=0.5$。\n\n现在，我们可以确定基于信号的最优生产策略：\n1.  如果收到 $S_O$，后验概率为 $\\alpha$。由于 $\\alpha \\in [0.5, 1]$，我们总是有 $\\alpha > p_{crit} \\approx 0.4348$。因此，最优决策是生产 $x=d_H$。此时的期望成本为 $EC(S_O) = c d_H + P(D=d_L|S_O)h(d_H-d_L) = c d_H + (1-\\alpha)h(d_H-d_L)$。\n2.  如果收到 $S_P$，后验概率为 $1-\\alpha$。如果 $1-\\alpha  p_{crit}$（即 $\\alpha > 1-p_{crit} \\approx 0.5652$），最优决策是生产 $x=d_L$。此时的期望成本为 $EC(S_P) = c d_L + P(D=d_H|S_P)c_e(d_H-d_L) = c d_L + (1-\\alpha)c_e(d_H-d_L)$。\n\n总期望成本 (Total Expected Cost, TEC) 是研究成本加上所有情景下的期望生产和追索成本：\n$$ TEC(\\alpha) = C(\\alpha) + P(S_O)EC(S_O) + P(S_P)EC(S_P) $$\n假设 $\\alpha > 0.5652$，则：\n$$ TEC(\\alpha) = K(\\alpha-0.5)^2 + 0.5 [c d_H + (1-\\alpha)h(d_H-d_L)] + 0.5 [c d_L + (1-\\alpha)c_e(d_H-d_L)] $$\n$$ TEC(\\alpha) = K(\\alpha-0.5)^2 + 0.5c(d_H+d_L) + 0.5(1-\\alpha)(h+c_e)(d_H-d_L) $$\n我们的目标是最小化这个关于 $\\alpha$ 的函数。将常数项合并，我们得到一个关于 $\\alpha$ 的二次函数：\n$$ TEC(\\alpha) = K(\\alpha-0.5)^2 - 0.5\\alpha(h+c_e)(d_H-d_L) + \\text{const} $$\n代入数值：$K=2,000,000$, $h+c_e=230$, $d_H-d_L=5000$。\n$$ TEC(\\alpha) = 2\\cdot 10^6(\\alpha^2 - \\alpha + 0.25) - 0.5 \\alpha (230)(5000) + \\text{const} $$\n$$ TEC(\\alpha) = 2\\cdot 10^6 \\alpha^2 - (2\\cdot 10^6 + 575,000)\\alpha + \\text{const} $$\n$$ TEC(\\alpha) = 2,000,000 \\alpha^2 - 2,575,000 \\alpha + \\text{const} $$\n为了找到最小值，我们将导数设为零：\n$$ \\frac{d(TEC)}{d\\alpha} = 4,000,000 \\alpha - 2,575,000 = 0 $$\n$$ \\alpha^* = \\frac{2,575,000}{4,000,000} = 0.64375 $$\n这个结果满足我们之前的假设 $\\alpha > 0.5652$，因此该解是有效的。\n将最优准确度四舍五入到四位有效数字，得到 $\\alpha^* = 0.6438$。", "answer": "$$\\boxed{0.6438}$$", "id": "2182118"}]}