{"hands_on_practices": [{"introduction": "掌握任何算法的第一步都是亲手完成一个完整的计算周期。本练习将引导你完成一轮标准的增广拉格朗日方法迭代，包括两个核心步骤：求解无约束的增广拉格朗日函数，以及更新拉格朗日乘子。通过这个具体的计算实例 [@problem_id:2208360]，你将对该方法的内部运作机制建立起坚实的初步理解。", "problem": "考虑最小化目标函数 $f(x) = x^2$ 的约束优化问题，其等式约束为 $h(x) = x - 3 = 0$。\n\n增广拉格朗日方法是求解此类问题的一种迭代算法。增广拉格朗日函数定义为：\n$$L_A(x, \\lambda; \\rho) = f(x) + \\lambda h(x) + \\frac{\\rho}{2} [h(x)]^2$$\n其中 $\\lambda$ 是拉格朗日乘子估计值，$\\rho > 0$ 是惩罚参数。\n\n从一个估计值 $\\lambda_k$ 开始，该方法的一次迭代包含以下两个主要步骤：\n1.  通过求解以下无约束最小化问题来找到下一个迭代点 $x_{k+1}$：\n    $$x_{k+1} = \\arg\\min_{x} L_A(x, \\lambda_k; \\rho)$$\n2.  使用以下公式更新拉格朗日乘子：\n    $$\\lambda_{k+1} = \\lambda_k + \\rho h(x_{k+1})$$\n\n使用初始乘子估计值 $\\lambda_0 = 1$ 和惩罚参数 $\\rho = 2$，执行一轮完整的增广拉格朗日方法迭代。确定得到的新迭代点 $x_1$ 和更新后的乘子 $\\lambda_1$ 的值。\n\n将你的答案表示为一个行矩阵 $\\begin{pmatrix} x_1 & \\lambda_1 \\end{pmatrix}$，并使用精确分数。", "solution": "给定 $f(x) = x^{2}$ 和 $h(x) = x - 3$，其增广拉格朗日函数为\n$$L_{A}(x,\\lambda;\\rho) = f(x) + \\lambda h(x) + \\frac{\\rho}{2}[h(x)]^{2}。$$\n当 $\\lambda_{0} = 1$ 且 $\\rho = 2$ 时，该函数变为\n$$L_{A}(x,1;2) = x^{2} + 1\\cdot(x-3) + \\frac{2}{2}(x-3)^{2} = x^{2} + x - 3 + (x-3)^{2} = 2x^2 - 5x + 6。$$\n为了得到 $x_{1}$，求解无约束最小化问题：\n$$x_{1} = \\arg\\min_{x} L_{A}(x,1;2)。$$\n求导并令其导数为零：\n$$\\frac{d}{dx}L_{A}(x,1;2) = 4x - 5,$$\n$$4x - 5 = 0 \\implies x_{1} = \\frac{5}{4}。$$\n其二阶导数为\n$$\\frac{d^{2}}{dx^{2}}L_{A}(x,1;2) = 4 > 0,$$\n因此 $x_{1} = \\frac{5}{4}$ 是唯一的极小值点。\n\n使用 $\\lambda_{1} = \\lambda_{0} + \\rho h(x_{1})$ 更新乘子：\n$$h(x_{1}) = \\frac{5}{4} - 3 = -\\frac{7}{4},$$\n$$\\lambda_{1} = 1 + 2\\left(-\\frac{7}{4}\\right) = 1 - \\frac{7}{2} = -\\frac{5}{2}。$$\n\n因此，得到的值为 $x_{1} = \\frac{5}{4}$ 和 $\\lambda_{1} = -\\frac{5}{2}$。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{5}{4} & -\\frac{5}{2} \\end{pmatrix}}$$", "id": "2208360"}, {"introduction": "在熟悉了单次迭代的计算流程后，理解算法中各个参数的作用至关重要。这个练习 [@problem_id:2208363] 将带领我们从具体的数值计算转向符号分析，旨在揭示惩罚参数 $\\rho$ 如何影响迭代解。通过推导一个解析解，你将能直观地理解该方法是如何通过调整 $\\rho$ 来平衡目标函数最小化与约束满足程度的。", "problem": "一位工程师正在使用增广拉格朗日方法来解决一个简单的一维约束优化问题。目标是最小化目标函数 $f(x) = \\frac{1}{2} \\beta x^2$，约束条件为线性等式约束 $c(x) = x - a = 0$。其中，$\\beta$ 和 $a$ 是给定的正常数。\n\n该问题的增广拉格朗日函数定义为 $L_A(x, \\lambda; \\rho) = f(x) + \\lambda c(x) + \\frac{\\rho}{2} [c(x)]^2$，其中 $\\lambda$ 是拉格朗日乘子，$\\rho > 0$ 是惩罚参数。\n\n算法的第一步是关于 $x$ 最小化 $L_A(x, \\lambda_0; \\rho)$，以找到第一个原始迭代值 $x_0$。这一步使用拉格朗日乘子的初始猜测值 $\\lambda_0$ 来执行。假设工程师使用的初始猜测值为 $\\lambda_0 = 0$，并使用一个固定的惩罚参数 $\\rho$。\n\n确定得到的第一个原始迭代值 $x_0$。请用 $a$、$\\beta$ 和 $\\rho$ 表示您的答案，形式为一个单一的闭式解析表达式。", "solution": "我们给定的目标函数为 $f(x) = \\frac{1}{2}\\beta x^{2}$，约束条件为 $c(x) = x - a = 0$。增广拉格朗日函数为\n$$\nL_{A}(x,\\lambda;\\rho) = f(x) + \\lambda c(x) + \\frac{\\rho}{2}[c(x)]^{2}.\n$$\n在初始乘子 $\\lambda_{0} = 0$ 的情况下，我们对以下函数关于 $x$ 进行最小化：\n$$\nL_{A}(x,0;\\rho) = \\frac{1}{2}\\beta x^{2} + \\frac{\\rho}{2}(x - a)^{2}.\n$$\n为了找到最小值点，我们对 $x$ 求导并令其为零：\n$$\n\\frac{d}{dx}L_{A}(x,0;\\rho) = \\beta x + \\rho(x - a) = (\\beta + \\rho)x - \\rho a = 0.\n$$\n解出 $x$ 可得\n$$\nx = \\frac{\\rho a}{\\beta + \\rho}.\n$$\n由于二阶导数为\n$$\n\\frac{d^{2}}{dx^{2}}L_{A}(x,0;\\rho) = \\beta + \\rho > 0,\n$$\n该临界点是唯一的最小值点。因此，第一个原始迭代值为\n$$\nx_{0} = \\frac{\\rho a}{\\beta + \\rho}.\n$$", "answer": "$$\\boxed{\\frac{\\rho a}{\\beta + \\rho}}$$", "id": "2208363"}, {"introduction": "增广拉格朗日方法的真正威力在于其迭代过程。此练习 [@problem_id:2208359] 让你通过执行连续三次迭代，亲眼见证算法的动态收敛过程。通过追踪解的演变，你可以观察到迭代序列是如何一步步逼近真实约束最优解的，从而对算法的收敛特性获得深刻的体会。", "problem": "乘子法，也称为增广拉格朗日方法，是一种求解约束优化问题的迭代算法。考虑以下形式的一维优化问题：\n最小化 $f(x)$，满足等式约束 $h(x) = 0$。\n\n增广拉格朗日函数 $L_\\rho(x, \\lambda)$ 定义为：\n$$L_\\rho(x, \\lambda) = f(x) + \\lambda h(x) + \\frac{\\rho}{2} (h(x))^2$$\n其中 $\\lambda$ 是拉格朗日乘子估计值，$\\rho > 0$ 是一个常数惩罚参数。\n\n乘子法从初始乘子 $\\lambda_0$ 开始，通过以下迭代方案进行：\n对于 $k = 0, 1, 2, \\dots$\n1. 通过使用当前乘子估计值 $\\lambda_k$ 最小化增广拉格朗日函数，找到下一个迭代点 $x_{k+1}$：\n   $$x_{k+1} = \\arg\\min_x L_\\rho(x, \\lambda_k)$$\n2. 更新拉格朗日乘子：\n   $$\\lambda_{k+1} = \\lambda_k + \\rho h(x_{k+1})$$\n\n将此方法的前三次迭代应用于最小化函数 $f(x) = x^2$ 且满足约束 $x - 1 = 0$ 的问题。\n使用固定的惩罚参数 $\\rho > 0$，并从初始乘子估计值 $\\lambda_0 = 0$ 开始。\n\n确定前三个最小化点 $x_1, x_2$ 和 $x_3$ 关于惩罚参数 $\\rho$ 的解析表达式。按顺序给出 $x_1, x_2$ 和 $x_3$ 的答案。", "solution": "我们被要求使用乘子法来最小化 $f(x)=x^{2}$，约束条件为 $h(x)=x-1=0$，其增广拉格朗日函数为\n$$\nL_{\\rho}(x,\\lambda)=x^{2}+\\lambda(x-1)+\\frac{\\rho}{2}(x-1)^{2},\n$$\n其中 $\\rho>0$ 为固定值，初始乘子 $\\lambda_{0}=0$。迭代过程如下：\n$$\nx_{k+1}=\\arg\\min_{x}L_{\\rho}(x,\\lambda_{k}),\\quad \\lambda_{k+1}=\\lambda_{k}+\\rho\\,h(x_{k+1})=\\lambda_{k}+\\rho(x_{k+1}-1).\n$$\n为了找到 $x_{k+1}$，我们将 $L_{\\rho}(x,\\lambda_{k})$ 对 $x$ 求导，并令其导数为零：\n$$\n\\frac{\\partial L_{\\rho}}{\\partial x}=2x+\\lambda_{k}+\\rho(x-1)=0.\n$$\n这给出了一个关于 $x$ 的线性方程：\n$$\n(2+\\rho)x+\\lambda_{k}-\\rho=0 \\quad\\Longrightarrow\\quad x_{k+1}=\\frac{\\rho-\\lambda_{k}}{2+\\rho}.\n$$\n使用以下规则更新 $\\lambda$：\n$$\n\\lambda_{k+1}=\\lambda_{k}+\\rho\\left(\\frac{\\rho-\\lambda_{k}}{2+\\rho}-1\\right)=\\lambda_{k}-\\frac{\\rho(\\lambda_{k}+2)}{2+\\rho}.\n$$\n这可以简化为仿射递推关系\n$$\n\\lambda_{k+1}=\\frac{2}{2+\\rho}\\lambda_{k}-\\frac{2\\rho}{2+\\rho}.\n$$\n定义 $a=\\frac{2}{2+\\rho}$。当 $\\lambda_{0}=0$ 时，该递推关系的解为\n$$\n\\lambda_{k}=-2\\rho\\frac{a(1-a^{k})}{1-a} = -2(1-a^k) = 2a^k-2.\n$$\n代入 $x_{k+1}=\\frac{\\rho-\\lambda_{k}}{2+\\rho}$ 中得到\n$$\nx_{k+1}=\\frac{\\rho-(2a^{k}-2)}{2+\\rho}=\\frac{\\rho+2-2a^{k}}{2+\\rho}=1-\\frac{2a^{k}}{2+\\rho}\n=1-\\frac{2^{k+1}}{(2+\\rho)^{k+1}}.\n$$\n现在计算前三个最小化点：\n- 对于 $k=0$，\n$$\nx_{1}=1-\\frac{2}{2+\\rho}=\\frac{\\rho}{2+\\rho}.\n$$\n- 对于 $k=1$，\n$$\nx_{2}=1-\\frac{2^{2}}{(2+\\rho)^{2}}=\\frac{(2+\\rho)^{2}-4}{(2+\\rho)^{2}}=\\frac{\\rho(\\rho+4)}{(2+\\rho)^{2}}.\n$$\n- 对于 $k=2$，\n$$\nx_{3}=1-\\frac{2^{3}}{(2+\\rho)^{3}}=\\frac{(2+\\rho)^{3}-8}{(2+\\rho)^{3}}=\\frac{\\rho(\\rho^{2}+6\\rho+12)}{(2+\\rho)^{3}}.\n$$\n因此，所求的 $x_{1},x_{2},x_{3}$ 关于 $\\rho$ 的表达式如上所示。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{\\rho}{2+\\rho} & \\frac{\\rho(\\rho+4)}{(2+\\rho)^{2}} & \\frac{\\rho(\\rho^{2}+6\\rho+12)}{(2+\\rho)^{3}}\\end{pmatrix}}$$", "id": "2208359"}]}