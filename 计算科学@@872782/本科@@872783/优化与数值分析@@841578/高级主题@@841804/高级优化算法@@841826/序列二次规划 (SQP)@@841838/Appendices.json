{"hands_on_practices": [{"introduction": "序列二次规划（SQP）的核心思想是，在当前点附近用一个二次规划（QP）子问题来近似原始的非线性规划问题。构建这个QP子问题的第一步，就是收集原始问题在当前点的局部信息。本练习将带你计算这些最基本的构建模块：目标函数的梯度和约束函数的雅可比矩阵，它们将直接定义QP子问题的目标函数和线性约束。[@problem_id:2201991]", "problem": "考虑以下非线性优化问题：\n最小化 $f(x_1, x_2) = \\exp(x_1 + x_2)$\n满足等式约束 $h(x_1, x_2) = x_1^2 + x_2^2 - 1 = 0$。\n\n解决此类问题的一个有效方法是序列二次规划（SQP）算法。该算法的第一次迭代从一个初始点 $\\mathbf{x}_0$ 开始，并涉及求解一个二次规划（QP）子问题。为了构建这个子问题，我们需要目标函数的梯度 $\\nabla f(\\mathbf{x})$ 和约束函数的雅可比矩阵 $J_h(\\mathbf{x})$。\n\n给定初始点 $\\mathbf{x}_0 = (1, 1)$，确定目标函数的梯度 $\\nabla f(\\mathbf{x}_0)$ 和约束的雅可比矩阵 $J_h(\\mathbf{x}_0)$。\n\n将您的结果表示为一个 $2 \\times 2$ 矩阵，其中第一行由目标函数的转置梯度 $\\nabla f(\\mathbf{x}_0)^T$ 的分量组成，第二行由约束函数的雅可比矩阵 $J_h(\\mathbf{x}_0)$ 的分量组成。", "solution": "我们给定了目标函数 $f(x_{1},x_{2})=\\exp(x_{1}+x_{2})$ 和等式约束 $h(x_{1},x_{2})=x_{1}^{2}+x_{2}^{2}-1=0$，初始点为 $\\mathbf{x}_{0}=(1,1)$。我们需要求出 $\\nabla f(\\mathbf{x}_{0})$ 和 $J_{h}(\\mathbf{x}_{0})$。\n\n首先，计算目标函数的梯度。对 $f(x_{1},x_{2})=\\exp(x_{1}+x_{2})$ 使用链式法则，\n$$\n\\frac{\\partial f}{\\partial x_{1}}=\\exp(x_{1}+x_{2}), \\quad \\frac{\\partial f}{\\partial x_{2}}=\\exp(x_{1}+x_{2}).\n$$\n因此，\n$$\n\\nabla f(x_{1},x_{2})=\\begin{pmatrix}\\exp(x_{1}+x_{2}) \\\\ \\exp(x_{1}+x_{2})\\end{pmatrix}.\n$$\n在点 $\\mathbf{x}_{0}=(1,1)$ 处求值，得到\n$$\n\\nabla f(\\mathbf{x}_{0})=\\begin{pmatrix}\\exp(2) \\\\ \\exp(2)\\end{pmatrix}, \\quad \\nabla f(\\mathbf{x}_{0})^{T}=\\begin{pmatrix}\\exp(2) & \\exp(2)\\end{pmatrix}.\n$$\n\n接下来，计算约束的雅可比矩阵。对于 $h(x_{1},x_{2})=x_{1}^{2}+x_{2}^{2}-1$，其偏导数为\n$$\n\\frac{\\partial h}{\\partial x_{1}}=2x_{1}, \\quad \\frac{\\partial h}{\\partial x_{2}}=2x_{2}.\n$$\n由于 $h:\\mathbb{R}^{2}\\to\\mathbb{R}$，其雅可比矩阵是一个 $1\\times 2$ 的行向量\n$$\nJ_{h}(x_{1},x_{2})=\\begin{pmatrix}2x_{1} & 2x_{2}\\end{pmatrix}.\n$$\n在点 $\\mathbf{x}_{0}=(1,1)$ 处求值，得到\n$$\nJ_{h}(\\mathbf{x}_{0})=\\begin{pmatrix}2 & 2\\end{pmatrix}.\n$$\n\n因此，所要求的 $2\\times 2$ 矩阵，其第一行等于 $\\nabla f(\\mathbf{x}_{0})^{T}$，第二行等于 $J_{h}(\\mathbf{x}_{0})$，为\n$$\n\\begin{pmatrix}\n\\exp(2) & \\exp(2) \\\\\n2 & 2\n\\end{pmatrix}.\n$$", "answer": "$$\\boxed{\\begin{pmatrix}\\exp(2) & \\exp(2) \\\\ 2 & 2\\end{pmatrix}}$$", "id": "2201991"}, {"introduction": "在我们学会了如何计算构建QP子问题所需的梯度和雅可比矩阵之后，下一步自然就是组装并求解这个子问题。本练习将指导你通过求解这个简化的二次模型，来确定一个最优的搜索方向 $p$。这个方向告诉我们为了改进当前解，应该朝哪个方向移动，这是SQP算法迭代过程的核心。[@problem_id:2202023]", "problem": "考虑一个非线性优化问题，即在等式约束 $c(x_1, x_2) = 0$ 下最小化函数 $f(x_1, x_2)$。序列二次规划 (SQP) 方法是求解此类问题的一种迭代算法。在每次迭代中，通过求解一个二次规划 (QP) 子问题来找到搜索方向，该子问题由拉格朗日函数的二次模型和约束的线性模型构建而成。\n\n设目标函数为 $f(x_1, x_2) = x_1 + x_2^2$，等式约束由方程 $(x_1-1)^2 + x_2^2 = 1$ 给出。\n\n我们希望从初始点 $x_0 = (1, 1)$ 开始，执行 SQP 算法的第一次迭代。用于寻找搜索方向 $p = (p_1, p_2)$ 的 QP 子问题定义如下：\n\n最小化：$q(p) = \\frac{1}{2} p^T B_0 p + \\nabla f(x_0)^T p$\n约束条件：$\\nabla c(x_0)^T p + c(x_0) = 0$\n\n对于此问题，使用单位矩阵 $B_0 = I$ 作为拉格朗日函数的海森矩阵的近似。约束函数定义为 $c(x_1, x_2) = (x_1-1)^2 + x_2^2 - 1$。\n\n通过求解这第一个 QP 子问题，确定搜索方向 $p = (p_1, p_2)$。将你的答案 $p$ 表示为行矩阵。", "solution": "给定 $f(x_{1},x_{2})=x_{1}+x_{2}^{2}$ 和 $c(x_{1},x_{2})=(x_{1}-1)^{2}+x_{2}^{2}-1$，以及初始点 $x_{0}=(1,1)$ 和 $B_{0}=I$。QP 子问题是\n$$\n\\min_{p}\\; q(p)=\\frac{1}{2}p^{T}Ip+\\nabla f(x_{0})^{T}p\n\\quad\\text{s.t.}\\quad \\nabla c(x_{0})^{T}p+c(x_{0})=0.\n$$\n计算在 $x_{0}$ 处的梯度：\n$$\n\\nabla f(x)=\\begin{pmatrix}1\\\\2x_{2}\\end{pmatrix}\\;\\Rightarrow\\;\\nabla f(x_{0})=\\begin{pmatrix}1\\\\2\\end{pmatrix},\\qquad\n\\nabla c(x)=\\begin{pmatrix}2(x_{1}-1)\\\\2x_{2}\\end{pmatrix}\\;\\Rightarrow\\;\\nabla c(x_{0})=\\begin{pmatrix}0\\\\2\\end{pmatrix}.\n$$\n并且 $c(x_{0})=(1-1)^{2}+1^{2}-1=0$。因此 QP 问题是\n$$\n\\min_{p}\\;\\frac{1}{2}(p_{1}^{2}+p_{2}^{2})+p_{1}+2p_{2}\n\\quad\\text{s.t.}\\quad 0\\cdot p_{1}+2p_{2}+0=0\\;\\Rightarrow\\;p_{2}=0.\n$$\n当 $p_{2}=0$ 时，目标函数简化为\n$$\n\\min_{p_{1}}\\;\\frac{1}{2}p_{1}^{2}+p_{1},\n$$\n其一阶条件 $p_{1}+1=0$ 得出 $p_{1}=-1$。\n\n等价地，求解该 QP 问题的 KKT 系统，\n$$\nIp+\\nabla f(x_{0})+\\lambda\\,\\nabla c(x_{0})=0,\\qquad \\nabla c(x_{0})^{T}p=0,\n$$\n得到分量方程\n$$\np_{1}+1+0\\cdot\\lambda=0,\\quad p_{2}+2+2\\lambda=0,\\quad 0\\cdot p_{1}+2p_{2}=0,\n$$\n由此可得 $p_{2}=0$，$p_{1}=-1$ 以及 $\\lambda=-1$。\n\n因此，SQP 搜索方向为 $p=(-1,0)$，表示为行矩阵。", "answer": "$$\\boxed{\\begin{pmatrix}-1 & 0\\end{pmatrix}}$$", "id": "2202023"}, {"introduction": "尽管SQP方法非常强大，但它并非万无一失。一个常见的问题是，在某次迭代中，构建的QP子问题可能根本没有可行解。这种情况通常发生在当前点对原始约束的线性化导致了一组相互矛盾的线性约束时。这个练习将展示一个导致QP子问题不可行的具体例子，这对于理解基本SQP方法的局限性以及为何需要更稳健的算法至关重要。[@problem_id:2202038]", "problem": "考虑以下具有两个变量 $x_1$ 和 $x_2$ 的非线性规划 (NLP) 问题：\n\n最小化 $f(x_1, x_2) = (x_1-5)^2 + x_2^2$\n\n约束条件为：\n$c_1(x_1, x_2) = -x_1^2 + x_2 - 1 \\ge 0$\n$c_2(x_1, x_2) = 0.2x_1^4 + x_2^2 - x_2 - 1 \\ge 0$\n\n使用一个基于序列二次规划 (SQP) 的优化算法来求解此问题。该算法从初始点 $x_0 = (0, 0)$ 开始。在 SQP 方法的第一次迭代中，构建一个二次规划 (QP) 子问题来寻找搜索方向（步长）$p = (p_1, p_2)$。这个 QP 子问题是在当前点 $x_0$ 处，通过使用目标函数的二次近似和约束条件的线性化来构建的。\n\n下列哪个陈述正确地描述了关于搜索方向 $p$ 的第一个 QP 子问题？\n\nA. QP 子问题是无界的。\n\nB. QP 子问题对于 $p$ 有一个唯一的非零解。\n\nC. QP 子问题的唯一可行解是 $p=0$。\n\nD. QP 子问题是不可行的。\n\nE. 当前点 $x_0$ 必须是原始 NLP 问题的一个局部极小值点。", "solution": "我们在当前迭代点 $x_{0}=(0,0)$ 处使用标准的 SQP 第一个 QP 子问题。该 QP 最小化一个带有线性化约束条件的拉格朗日函数的二次模型：\n$$\n\\min_{p\\in\\mathbb{R}^{2}} \\;\\; \\nabla f(x_{0})^{\\top}p + \\frac{1}{2} p^{\\top} B_{0} p\n\\quad\\text{subject to}\\quad\nc_{i}(x_{0}) + \\nabla c_{i}(x_{0})^{\\top} p \\ge 0,\\; i=1,2,\n$$\n其中，在初始乘子取为零的情况下，$B_{0}$ 通常被选择为 $\\nabla^{2} f(x_{0})$。\n\n计算在 $x_{0}$ 处的各个组成部分：\n- 目标函数：$f(x_{1},x_{2})=(x_{1}-5)^{2}+x_{2}^{2}$，所以\n$$\n\\nabla f(x) = \\begin{pmatrix} 2(x_{1}-5) \\\\ 2 x_{2} \\end{pmatrix}, \\quad \\nabla f(x_{0})=\\begin{pmatrix} -10 \\\\ 0 \\end{pmatrix}, \\quad \\nabla^{2} f(x)=\\begin{pmatrix} 2 & 0 \\\\ 0 & 2 \\end{pmatrix}, \\; B_{0}=\\begin{pmatrix} 2 & 0 \\\\ 0 & 2 \\end{pmatrix}.\n$$\n- 约束条件及其线性化：\n对于 $c_{1}(x)=-x_{1}^{2}+x_{2}-1$，\n$$\nc_{1}(x_{0})=-1,\\quad \\nabla c_{1}(x)=\\begin{pmatrix} -2 x_{1} \\\\ 1 \\end{pmatrix},\\quad \\nabla c_{1}(x_{0})=\\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix},\n$$\n因此\n$$\nc_{1}(x_{0})+\\nabla c_{1}(x_{0})^{\\top}p = -1 + p_{2} \\ge 0 \\;\\;\\Longleftrightarrow\\;\\; p_{2} \\ge 1.\n$$\n对于 $c_{2}(x)=0.2\\,x_{1}^{4}+x_{2}^{2}-x_{2}-1$，\n$$\nc_{2}(x_{0})=-1,\\quad \\nabla c_{2}(x)=\\begin{pmatrix} 0.8\\,x_{1}^{3} \\\\ 2 x_{2}-1 \\end{pmatrix},\\quad \\nabla c_{2}(x_{0})=\\begin{pmatrix} 0 \\\\ -1 \\end{pmatrix},\n$$\n因此\n$$\nc_{2}(x_{0})+\\nabla c_{2}(x_{0})^{\\top}p = -1 - p_{2} \\ge 0 \\;\\;\\Longleftrightarrow\\;\\; p_{2} \\le -1.\n$$\n线性化的约束条件要求同时满足 $p_{2} \\ge 1$ 和 $p_{2} \\le -1$，这是不可能的。因此，QP 子问题的可行集是空的，所以该 QP 子问题是不可行的。\n\n因此，在所列的陈述中，正确的说法是 QP 子问题是不可行的。", "answer": "$$\\boxed{D}$$", "id": "2202038"}]}