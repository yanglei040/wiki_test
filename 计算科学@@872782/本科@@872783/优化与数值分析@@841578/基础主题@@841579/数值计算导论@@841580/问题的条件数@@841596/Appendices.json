{"hands_on_practices": [{"introduction": "理论知识需要通过实践来巩固。让我们从一个基础练习开始，将问题条件数的概念应用于一个我们都熟悉的统计量：算术平均值。这个练习将帮助我们理解如何量化一个问题的解对其输入数据的微小扰动的敏感性，并为“病态”或“良态”问题建立一个直观的认识[@problem_id:2161810]。", "problem": "在数值分析中，一个问题的条件指的是其解对输入数据中微小相对扰动的敏感性。考虑计算一组 $n$ 个正数据点 $\\{x_1, x_2, \\dots, x_n\\}$ 的算术平均值的问题。该平均值由函数 $M(x_1, \\dots, x_n) = \\frac{1}{n}\\sum_{i=1}^n x_i$ 给出。\n\n此计算关于特定数据点 $x_k$ 的相对条件数 $\\kappa_k$，衡量了 $x_k$ 中的相对误差在计算出的平均值中被放大的程度。对于一个多变量 $x_1, \\dots, x_n$ 的可微函数 $f$，该条件数定义为：\n$$ \\kappa_k = \\left| \\frac{\\partial f}{\\partial x_k} \\frac{x_k}{f} \\right| $$\n假设一位物理学家对某个物理量收集了以下五个测量值：$\\{12.5, 15.2, 11.8, 13.5, 90.0\\}$。该物理学家担心最后一个测量值可能有较大的不确定性，并希望量化算术平均值对这个特定值的敏感性。\n\n计算算术平均值计算关于第五个数据点 $x_5 = 90.0$ 的相对条件数。将最终答案四舍五入到三位有效数字。", "solution": "$n$ 个正数据点的算术平均值是函数 $M(x_{1},\\dots,x_{n})=\\frac{1}{n}\\sum_{i=1}^{n}x_{i}$。对于一个可微函数 $f$，关于 $x_k$ 的相对条件数定义为\n$$\n\\kappa_{k}=\\left|\\frac{\\partial f}{\\partial x_{k}}\\frac{x_{k}}{f}\\right|.\n$$\n对于 $f=M$，关于 $x_{k}$ 的偏导数是\n$$\n\\frac{\\partial M}{\\partial x_{k}}=\\frac{1}{n}.\n$$\n因此，\n$$\n\\kappa_{k}=\\left|\\frac{1}{n}\\cdot\\frac{x_{k}}{M}\\right|=\\left|\\frac{x_{k}}{nM}\\right|.\n$$\n因为 $nM=\\sum_{i=1}^{n}x_{i}$，上式可简化为\n$$\n\\kappa_{k}=\\left|\\frac{x_{k}}{\\sum_{i=1}^{n}x_{i}}\\right|.\n$$\n对于给定的数据 $\\{12.5,15.2,11.8,13.5,90.0\\}$ 且 $n=5$，其和为\n$$\n\\sum_{i=1}^{5}x_{i}=12.5+15.2+11.8+13.5+90.0=143.0,\n$$\n平均值为\n$$\nM=\\frac{143.0}{5}=28.6.\n$$\n对于 $x_{5}=90.0$，\n$$\n\\kappa_{5}=\\left|\\frac{1}{5}\\cdot\\frac{90.0}{28.6}\\right|=\\frac{90}{5\\cdot 28.6}=\\frac{90}{143}.\n$$\n数值上，\n$$\n\\frac{90}{143}\\approx 0.629370\\ldots\n$$\n四舍五入到三位有效数字得到 $0.629$。", "answer": "$$\\boxed{0.629}$$", "id": "2161810"}, {"introduction": "在数值计算中，一个常见的陷阱是“灾难性抵消”(catastrophic cancellation)，即两个非常接近的大数相减，导致有效数字的严重损失。这个问题展示了一个典型的例子：一个在数学上完全正确的方差计算公式，在计算机上执行时却可能因为数值不稳定性而产生巨大误差。通过分析这个过程，我们可以理解条件数是如何预警这类计算风险的，并认识到算法选择在科学计算中的重要性[@problem_id:2161813]。", "problem": "一位质量控制工程师负责验证高精度部件制造过程的一致性。工程师收集了 $N$ 个部件的样本，并测量了它们的质量，记为 $x_1, x_2, \\ldots, x_N$。这些质量的样本均值计算为 $\\bar{x}$，样本标准差为 $S$。已知该过程非常稳定，其测量结果的标准差远小于均值（即 $S \\ll \\bar{x}$）。\n\n工程师的分析软件使用所谓的“计算公式”来计算样本方差 $S^2$。该方法包括两个步骤。首先，计算两个中间量：$T_1 = \\sum_{i=1}^N x_i^2$ 和 $T_2 = N\\bar{x}^2$。其次，利用这些值来求得方差：$S^2 = \\frac{T_1 - T_2}{N-1}$。\n\n由于计算机算术的有限精度，软件存储的值并非完全精确。设计算值为 $\\hat{T}_1$ 和 $\\hat{T}_2$，并假设它们相对于真值存在小的相对误差 $\\delta_1$ 和 $\\delta_2$，使得 $\\hat{T}_1 = T_1(1+\\delta_1)$ 和 $\\hat{T}_2 = T_2(1+\\delta_2)$。这些初始误差的量级受一个小的正值 $\\epsilon$ 的限制，该值代表机器精度：$|\\delta_1| \\leq \\epsilon$ 和 $|\\delta_2| \\leq \\epsilon$。\n\n工程师担心，两个大而相近的数 $T_1$ 和 $T_2$ 相减可能会导致严重的精度损失。为研究此问题，请确定计算出的差值 $D = T_1 - T_2$ 的相对误差量级的上界。计算出的差值为 $\\hat{D} = \\hat{T}_1 - \\hat{T}_2$。你的任务是推导此相对误差量级 $\\left|\\frac{\\hat{D} - D}{D}\\right|$ 的上界。\n\n请将最终答案表示为包含样本数 $N$、样本均值 $\\bar{x}$、样本标准差 $S$ 和误差界 $\\epsilon$ 的单个闭式解析表达式。", "solution": "我们从以下定义的精确量开始\n$$\nT_{1}=\\sum_{i=1}^{N}x_{i}^{2},\\qquad T_{2}=N\\bar{x}^{2},\\qquad D=T_{1}-T_{2}.\n$$\n计算值满足\n$$\n\\hat{T}_{1}=T_{1}(1+\\delta_{1}),\\qquad \\hat{T}_{2}=T_{2}(1+\\delta_{2}),\\qquad |\\delta_{1}|\\leq \\epsilon,\\quad |\\delta_{2}|\\leq \\epsilon,\n$$\n且计算出的差值为\n$$\n\\hat{D}=\\hat{T}_{1}-\\hat{T}_{2}=T_{1}(1+\\delta_{1})-T_{2}(1+\\delta_{2})=D+\\delta_{1}T_{1}-\\delta_{2}T_{2}.\n$$\n因此，差值的相对误差为\n$$\n\\frac{\\hat{D}-D}{D}=\\frac{\\delta_{1}T_{1}-\\delta_{2}T_{2}}{D}.\n$$\n取绝对值并使用三角不等式以及 $\\delta_{1}$ 和 $\\delta_{2}$ 的界限，可得\n$$\n\\left|\\frac{\\hat{D}-D}{D}\\right|\\leq \\frac{|\\delta_{1}|T_{1}+|\\delta_{2}|T_{2}}{|D|}\\leq \\epsilon\\,\\frac{T_{1}+T_{2}}{D}.\n$$\n为了用 $N$、$\\bar{x}$ 和 $S$ 来表示这个界，我们使用样本均值和样本方差的标准恒等式：\n$$\nS^{2}=\\frac{1}{N-1}\\sum_{i=1}^{N}(x_{i}-\\bar{x})^{2},\\qquad \\sum_{i=1}^{N}x_{i}^{2}=\\sum_{i=1}^{N}(x_{i}-\\bar{x})^{2}+N\\bar{x}^{2}.\n$$\n因此，\n$$\nT_{1}=(N-1)S^{2}+N\\bar{x}^{2},\\qquad T_{2}=N\\bar{x}^{2},\\qquad D=T_{1}-T_{2}=(N-1)S^{2}.\n$$\n代入上界可得\n$$\n\\left|\\frac{\\hat{D}-D}{D}\\right|\\leq \\epsilon\\,\\frac{(N-1)S^{2}+2N\\bar{x}^{2}}{(N-1)S^{2}}=\\epsilon\\left(1+\\frac{2N\\bar{x}^{2}}{(N-1)S^{2}}\\right).\n$$\n只要 $S>0$，这个界就是有限的；当 $S=0$ 时，$D=0$ 且相对误差未定义，这对应于退化的零方差情况。", "answer": "$$\\boxed{\\epsilon\\left(1+\\frac{2N\\bar{x}^{2}}{(N-1)S^{2}}\\right)}$$", "id": "2161813"}, {"introduction": "现在，我们将条件数的概念从简单的函数推广到线性代数的核心——矩阵。求解线性方程组 $Ax=b$ 是科学与工程计算的基石，而矩阵 $A$ 的条件数决定了求解过程的稳定性。这个问题通过分析一个参数化矩阵在趋近奇异（不可逆）时的行为，深刻揭示了矩阵条件数如何量化线性系统的“病态”程度，以及为什么对于接近奇异的矩阵，求解结果可能完全不可靠[@problem_id:2428542]。", "problem": "在计算工程中，线性系统 $A(\\epsilon)\\,x=b$ 对 $b$ (或 $A(\\epsilon)$) 中扰动的敏感性由条件数来量化。考虑参数化的 $2 \\times 2$ 对称矩阵\n$$\nA(\\epsilon)=\\begin{pmatrix}\n1  1 \\\\\n1  1+\\epsilon\n\\end{pmatrix},\n$$\n其中 $\\epsilon>0$ 是一个小参数。使用谱范数（由欧几里得向量范数诱导的矩阵范数），确定当 $\\epsilon \\to 0^{+}$ 时，谱条件数 $\\kappa_{2}(A(\\epsilon))$ 的领头阶渐近表达式。请给出一个用 $\\epsilon$ 表示的单一简化解析表达式。不要进行数值近似。", "solution": "对于一个可逆矩阵 $A$，其谱条件数 $\\kappa_{2}(A)$ 定义为该矩阵与其逆矩阵的谱范数之积：\n$$\n\\kappa_{2}(A) = \\|A\\|_{2} \\|A^{-1}\\|_{2}\n$$\n题目指定矩阵 $A(\\epsilon)$ 为：\n$$\nA(\\epsilon) = \\begin{pmatrix} 1  1 \\\\ 1  1+\\epsilon \\end{pmatrix}\n$$\n这个矩阵是对称的。对于对称矩阵，谱范数 $\\| \\cdot \\|_{2}$ 等于其谱半径，即其特征值绝对值的最大值。设 $A(\\epsilon)$ 的特征值为 $\\lambda$。特征值是特征方程 $\\det(A(\\epsilon) - \\lambda I) = 0$ 的根，其中 $I$ 是 $2 \\times 2$ 单位矩阵。\n\n特征方程为：\n$$\n\\det \\begin{pmatrix} 1-\\lambda  1 \\\\ 1  1+\\epsilon-\\lambda \\end{pmatrix} = 0\n$$\n展开行列式可得：\n$$\n(1-\\lambda)(1+\\epsilon-\\lambda) - 1^{2} = 0\n$$\n$$\n1 + \\epsilon - \\lambda - \\lambda - \\epsilon\\lambda + \\lambda^{2} - 1 = 0\n$$\n$$\n\\lambda^{2} - (2+\\epsilon)\\lambda + \\epsilon = 0\n$$\n这是一个关于 $\\lambda$ 的二次方程。我们使用求根公式来解 $\\lambda$：\n$$\n\\lambda = \\frac{-(-(2+\\epsilon)) \\pm \\sqrt{(-(2+\\epsilon))^{2} - 4(1)(\\epsilon)}}{2(1)}\n$$\n$$\n\\lambda = \\frac{2+\\epsilon \\pm \\sqrt{4 + 4\\epsilon + \\epsilon^{2} - 4\\epsilon}}{2}\n$$\n$$\n\\lambda = \\frac{2+\\epsilon \\pm \\sqrt{4 + \\epsilon^{2}}}{2}\n$$\n这给出了两个特征值，我们记为 $\\lambda_{max}$ 和 $\\lambda_{min}$：\n$$\n\\lambda_{max} = \\frac{2+\\epsilon + \\sqrt{4 + \\epsilon^{2}}}{2}\n$$\n$$\n\\lambda_{min} = \\frac{2+\\epsilon - \\sqrt{4 + \\epsilon^{2}}}{2}\n$$\n因为 $\\epsilon > 0$，我们有 $\\sqrt{4+\\epsilon^{2}} > \\sqrt{4} = 2$。并且，$(2+\\epsilon)^2 = 4+4\\epsilon+\\epsilon^2 > 4+\\epsilon^2$，这意味着 $2+\\epsilon > \\sqrt{4+\\epsilon^2}$。因此，可以得出 $\\lambda_{max} > \\lambda_{min} > 0$。两个特征值都是正数。\n\n$A(\\epsilon)$ 的谱范数是其最大的绝对值特征值：\n$$\n\\|A(\\epsilon)\\|_{2} = |\\lambda_{max}| = \\lambda_{max} = \\frac{2+\\epsilon + \\sqrt{4 + \\epsilon^{2}}}{2}\n$$\n矩阵 $A(\\epsilon)$ 是可逆的，因为其行列式为 $\\det(A(\\epsilon)) = (1)(1+\\epsilon) - (1)(1) = \\epsilon \\neq 0$。逆矩阵 $A(\\epsilon)^{-1}$ 的特征值是 $A(\\epsilon)$ 特征值的倒数，即 $1/\\lambda_{max}$ 和 $1/\\lambda_{min}$。由于 $A(\\epsilon)^{-1}$ 也是对称的，其谱范数是其最大的绝对值特征值。因为 $0  \\lambda_{min}  \\lambda_{max}$，所以 $0  1/\\lambda_{max}  1/\\lambda_{min}$。因此：\n$$\n\\|A(\\epsilon)^{-1}\\|_{2} = \\frac{1}{\\lambda_{min}} = \\frac{2}{2+\\epsilon - \\sqrt{4 + \\epsilon^{2}}}\n$$\n谱条件数是最大特征值模与最小特征值模的比值：\n$$\n\\kappa_{2}(A(\\epsilon)) = \\frac{\\lambda_{max}}{\\lambda_{min}} = \\frac{\\frac{2+\\epsilon + \\sqrt{4 + \\epsilon^{2}}}{2}}{\\frac{2+\\epsilon - \\sqrt{4 + \\epsilon^{2}}}{2}} = \\frac{2+\\epsilon + \\sqrt{4 + \\epsilon^{2}}}{2+\\epsilon - \\sqrt{4 + \\epsilon^{2}}}\n$$\n为了确定当 $\\epsilon \\to 0^{+}$ 时的领头阶渐近表达式，我们分析当 $\\epsilon$ 很小时分子和分母的行为。使用对于小 $x$ 的二项式级数展开 $(1+x)^{\\alpha} \\approx 1+\\alpha x$ 来展开项 $\\sqrt{4+\\epsilon^2}$：\n$$\n\\sqrt{4+\\epsilon^2} = 2\\sqrt{1+\\frac{\\epsilon^2}{4}}\n$$\n令 $x = \\epsilon^{2}/4$ 且 $\\alpha = 1/2$，展开式为：\n$$\n2\\sqrt{1+\\frac{\\epsilon^2}{4}} \\approx 2\\left(1 + \\frac{1}{2}\\frac{\\epsilon^2}{4}\\right) = 2 + \\frac{\\epsilon^2}{4}\n$$\n所以，当 $\\epsilon \\to 0^{+}$ 时，我们有 $\\sqrt{4+\\epsilon^2} = 2 + \\frac{\\epsilon^2}{4} + O(\\epsilon^4)$。\n\n现在我们分析 $\\lambda_{max}$ 和 $\\lambda_{min}$ 的领头阶行为。\n对于 $\\kappa_2(A(\\epsilon))$ 的分子：\n$$\n2+\\epsilon + \\sqrt{4 + \\epsilon^{2}} = 2+\\epsilon + \\left(2 + \\frac{\\epsilon^2}{4} + O(\\epsilon^4)\\right) = 4 + \\epsilon + O(\\epsilon^2)\n$$\n当 $\\epsilon \\to 0^{+}$ 时，领头项是 $4$。\n\n对于 $\\kappa_2(A(\\epsilon))$ 的分母：\n$$\n2+\\epsilon - \\sqrt{4 + \\epsilon^{2}} = 2+\\epsilon - \\left(2 + \\frac{\\epsilon^2}{4} + O(\\epsilon^4)\\right) = \\epsilon - \\frac{\\epsilon^2}{4} + O(\\epsilon^4)\n$$\n当 $\\epsilon \\to 0^{+}$ 时，领头项是 $\\epsilon$。\n\n因此，条件数的领头阶渐近表达式是这些领头项的比值：\n$$\n\\kappa_2(A(\\epsilon)) \\approx \\frac{4+\\epsilon}{\\epsilon - \\frac{\\epsilon^2}{4}} = \\frac{4(1+\\frac{\\epsilon}{4})}{\\epsilon(1-\\frac{\\epsilon}{4})} \\approx \\frac{4}{\\epsilon} \\quad \\text{as } \\epsilon \\to 0^{+}\n$$\n更形式化地，我们可以写成：\n$$\n\\kappa_2(A(\\epsilon)) = \\frac{4 + O(\\epsilon)}{\\epsilon + O(\\epsilon^2)} = \\frac{1}{\\epsilon} \\frac{4 + O(\\epsilon)}{1 + O(\\epsilon)} = \\frac{1}{\\epsilon} (4 + O(\\epsilon)) = \\frac{4}{\\epsilon} + O(1)\n$$\n当 $\\epsilon \\to 0^{+}$ 时，$\\kappa_{2}(A(\\epsilon))$ 的领头阶渐近表达式是 $\\frac{4}{\\epsilon}$。这表明当 $\\epsilon \\to 0$ 时，矩阵趋于奇异，从而呈现严重的病态。", "answer": "$$\\boxed{\\frac{4}{\\epsilon}}$$", "id": "2428542"}]}