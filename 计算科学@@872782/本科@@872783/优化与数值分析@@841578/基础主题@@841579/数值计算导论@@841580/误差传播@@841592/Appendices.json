{"hands_on_practices": [{"introduction": "许多科学模型依赖于通过测量得到的参数，而这些参数不可避免地带有不确定性。这个练习将指导你如何量化模型输入参数（例如增长率）的微小误差对模型长期预测结果的影响。通过运用微积分，我们将推导出误差放大因子，它揭示了在指数增长这类常见模型中，相对误差是如何随时间被放大的 [@problem_id:2169903]。", "problem": "在一个简化的气候模型中，某种特定温室气体的大气浓度 $C$ 预计会随时间 $t$ 根据指数增长模型增长：\n$$C(t) = C_0 \\exp(kt)$$\n其中 $C_0$ 是 $t=0$ 时的初始浓度，$k$ 是每年的净分数增长率。\n\n一个科学家团队已经以非常高的精度确定了初始浓度 $C_0$，因此其相关误差可以忽略不计。然而，增长率 $k$ 是从复杂的地球物理数据中估算出来的，并具有已知的​​不确定性。$k$ 的这种不确定性会传播并影响浓度 $C(t)$ 的长期预测。\n\n令量 $X$ 的相对误差的一阶近似定义为 $\\epsilon_X = \\left|\\frac{\\Delta X}{X}\\right|$，其中 $\\Delta X$ 是 $X$ 中的小误差。模型预测对增长率不确定性的敏感度由误差放大因子 $A$ 量化，其定义为预测浓度的相对误差与增长率的相对误差之比：\n$$A = \\frac{\\epsilon_C}{\\epsilon_k}$$\n假设增长率 $k$ 为正，计算在时间 $t = 50$ 年时所做预测的放大因子 $A$ 的值，给定估算的增长率为每年 $k = 0.035$。\n\n将最终答案四舍五入到三位有效数字。", "solution": "问题要求计算浓度模型 $C(t) = C_0 \\exp(kt)$ 的误差放大因子 $A = \\frac{\\epsilon_C}{\\epsilon_k}$。相对误差定义为 $\\epsilon_C = \\left|\\frac{\\Delta C}{C}\\right|$ 和 $\\epsilon_k = \\left|\\frac{\\Delta k}{k}\\right|$。我们需要找到增长率中的一个微小变化（误差）$\\Delta k$ 与预测浓度中由此产生的变化 $\\Delta C$ 之间的关系。\n\n我们可以使用微分学来找到这种关系。我们将浓度 $C$ 视为变量 $k$ 的函数，其中 $C_0$ 和 $t$ 是常数参数。对于一个微小的变化 $\\Delta k$，$C$ 的一阶变化由下式给出：\n$$\\Delta C \\approx \\frac{dC}{dk} \\Delta k$$\n首先，我们需要计算 $C(k) = C_0 \\exp(kt)$ 对 $k$ 的导数。使用链式法则进行微分：\n$$\\frac{dC}{dk} = \\frac{d}{dk} \\left( C_0 \\exp(kt) \\right) = C_0 \\cdot \\frac{d}{dk}(\\exp(kt))$$\n$$\\frac{dC}{dk} = C_0 \\cdot \\exp(kt) \\cdot \\frac{d}{dk}(kt) = C_0 \\exp(kt) \\cdot t$$\n注意到项 $C_0 \\exp(kt)$ 就是原始函数 $C(t)$。所以，我们可以将导数写为：\n$$\\frac{dC}{dk} = C(t) \\cdot t$$\n现在我们将此导数代入 $\\Delta C$ 的表达式中：\n$$\\Delta C \\approx (C(t) \\cdot t) \\cdot \\Delta k$$\n为了求出 $C$ 的相对误差 $\\epsilon_C$，我们将两边都除以 $C = C(t)$：\n$$\\frac{\\Delta C}{C(t)} \\approx \\frac{C(t) \\cdot t \\cdot \\Delta k}{C(t)}$$\n$$\\frac{\\Delta C}{C(t)} \\approx t \\cdot \\Delta k$$\n我们关心的是相对误差之间的关系。$k$ 的相对误差是 $\\epsilon_k = \\left|\\frac{\\Delta k}{k}\\right|$。我们可以将 $\\Delta k$ 的表达式重写为 $\\Delta k = k \\cdot \\left(\\frac{\\Delta k}{k}\\right)$。将此代入我们的方程中：\n$$\\frac{\\Delta C}{C(t)} \\approx t \\cdot \\left(k \\cdot \\frac{\\Delta k}{k}\\right)$$\n$$\\frac{\\Delta C}{C(t)} \\approx (kt) \\cdot \\frac{\\Delta k}{k}$$\n现在我们取两边的绝对值，得到相对误差大小之间的关系：\n$$\\left|\\frac{\\Delta C}{C(t)}\\right| \\approx \\left| (kt) \\cdot \\frac{\\Delta k}{k} \\right|$$\n由于给定的 $k$ 和 $t$ 都是正值，它们的乘积 $kt$ 也是正的，所以 $|kt| = kt$。\n$$\\left|\\frac{\\Delta C}{C(t)}\\right| \\approx kt \\cdot \\left|\\frac{\\Delta k}{k}\\right|$$\n使用相对误差的定义 $\\epsilon_C = \\left|\\frac{\\Delta C}{C}\\right|$ 和 $\\epsilon_k = \\left|\\frac{\\Delta k}{k}\\right|$，我们有：\n$$\\epsilon_C \\approx (kt) \\cdot \\epsilon_k$$\n误差放大因子 $A$ 定义为比率 $\\frac{\\epsilon_C}{\\epsilon_k}$。从上面的方程，我们得到：\n$$A = \\frac{\\epsilon_C}{\\epsilon_k} \\approx kt$$\n这是该模型放大因子的一般表达式。现在我们可以代入给定的数值：$t = 50$ 年 和 $k = 0.035$ 年$^{-1}$。\n$$A \\approx (0.035 \\text{ year}^{-1}) \\cdot (50 \\text{ years})$$\n$$A \\approx 1.75$$\n问题要求将答案四舍五入到三位有效数字。计算出的值 $1.75$ 已经有三位有效数字。", "answer": "$$\\boxed{1.75}$$", "id": "2169903"}, {"introduction": "误差不仅来源于不精确的输入，也可能在计算过程中产生，尤其是在处理浮点数时。“灾难性抵消”是数值计算中的一个主要陷阱，当两个几乎相等的数相减时，会造成有效数字的严重损失。这个练习将通过一个经典的例子，向你展示如何通过代数变换重写表达式，从而避免灾难性抵消，确保算法的数值稳定性 [@problem_id:2375840]。", "problem": "设 $f(x) = \\sqrt{x^{2}+1} - x$ 对于实数 $x > 0$。在一个具有单位舍入 $u$ 的标准浮点运算模型中，对于非常大的 $x$ 直接计算 $f(x)$ 可能会遭受灾难性抵消。通过从基本原理出发进行推理，推导一个与 $f(x)$ 代数等价且数值稳定的闭式表达式，该表达式避免了在 $x$ 非常大时减去两个几乎相等的量。将你的最终答案表示为仅含 $x$ 的单个解析表达式。不需要进行舍入。", "solution": "对问题陈述进行验证。\n\n提取已知条件如下：\n1.  函数定义为 $f(x) = \\sqrt{x^{2}+1} - x$。\n2.  函数的定义域指定为实数 $x > 0$。\n3.  计算环境是一个具有单位舍入 $u$ 的标准浮点运算模型。\n4.  所述的数值问题是，对于非常大的 $x$ 直接计算 $f(x)$ 会遭受灾难性抵消。\n5.  目标是推导一个与 $f(x)$ 代数等价、数值稳定的闭式表达式，以避免此问题。最终答案必须是仅含 $x$ 的单个解析表达式。\n\n问题陈述的验证：\n-   **科学基础**：该问题具有科学依据。在减去两个几乎相等的浮点数时出现的灾难性抵消现象是数值分析和计算科学中的一个基本课题。函数 $f(x) = \\sqrt{x^{2}+1} - x$ 是一个用于说明这种效应的典型例子。对于大的正数 $x$，项 $\\sqrt{x^{2}+1}$ 可以通过泰勒级数展开来近似：$\\sqrt{x^{2}+1} = x\\sqrt{1 + \\frac{1}{x^{2}}} \\approx x(1 + \\frac{1}{2x^{2}}) = x + \\frac{1}{2x}$。因此，$f(x) \\approx (x + \\frac{1}{2x}) - x = \\frac{1}{2x}$。被减去的两个量，$\\sqrt{x^{2}+1}$ 和 $x$，确实几乎相等，这证实了灾难性抵消的前提。\n-   **适定性**：该问题是适定的。它要求对给定表达式进行代数重构，以达到一个特定的、明确定义的数值属性（稳定性）。存在一个唯一的标准解。\n-   **客观性**：该问题以精确、客观的数学语言陈述。它没有歧义和主观论断。\n\n因此，该问题陈述被认为是有效的。解答过程如下。\n\n对于大的 $x > 0$，表达式 $f(x) = \\sqrt{x^{2}+1} - x$ 中数值不稳定性的来源是两个数量级相近的量的相减。在浮点运算中，如果两个数 $a$ 和 $b$ 非常接近，它们的差 $a-b$ 的有效数字位数将显著少于 $a$ 或 $b$ 各自的有效数字位数。这种相对精度的损失被称为灾难性抵消。\n\n为了推导出一个数值稳定的表达式，我们必须消除这种减法。对于涉及平方根的差值表达式，形如 $\\sqrt{A} - B$，一个标准的代数技巧是乘以并除以其共轭表达式 $\\sqrt{A} + B$。这种技巧通常被称为“分子有理化”。\n\n给定函数为 $f(x) = \\sqrt{x^{2}+1} - x$。其共轭表达式是 $\\sqrt{x^{2}+1} + x$。我们将 $f(x)$ 乘以并除以这个共轭表达式：\n\n$$ f(x) = (\\sqrt{x^{2}+1} - x) \\cdot \\frac{\\sqrt{x^{2}+1} + x}{\\sqrt{x^{2}+1} + x} $$\n\n现在分子是 $(a-b)(a+b)$ 的形式，可以简化为 $a^{2}-b^{2}$。这里，$a = \\sqrt{x^{2}+1}$ 且 $b = x$。\n\n$$ f(x) = \\frac{(\\sqrt{x^{2}+1})^{2} - x^{2}}{\\sqrt{x^{2}+1} + x} $$\n\n简化分子：\n\n$$ (\\sqrt{x^{2}+1})^{2} - x^{2} = (x^{2}+1) - x^{2} = 1 $$\n\n将此结果代回 $f(x)$ 的表达式中：\n\n$$ f(x) = \\frac{1}{\\sqrt{x^{2}+1} + x} $$\n\n这个新表达式在定义域内的所有 $x$ 上都与原表达式代数等价。我们现在必须验证其数值稳定性。分母由两个正量 $\\sqrt{x^{2}+1}$ 和 $x$ 的和组成。在浮点运算中，两个同号数相加是一个良性操作，不会引起灾难性抵消。随后的除以这个和的运算也是一个数值稳定的操作。\n\n对于大的 $x$，分母变得很大，结果正确地趋近于零，而没有任何相对精度的损失。因此，这个变换后的表达式对于所有 $x > 0$ 都是数值稳定的，特别是对于原表达式失效的大 $x$ 值。", "answer": "$$ \\boxed{\\frac{1}{\\sqrt{x^{2}+1} + x}} $$", "id": "2375840"}, {"introduction": "在设计数值方法时，我们常常需要在两种不同类型的误差之间进行权衡。例如，在数值微分中，减小步长可以降低逼近公式带来的截断误差，但同时会放大由计算机有限精度引起的舍入误差。这个练习将引导你解决一个核心问题：如何选择一个最优的步长，以最小化总误差，这揭示了计算科学中的一个根本性挑战 [@problem_id:2169892]。", "problem": "一位工程师正在分析一个信号，该信号由一个至少三阶连续可微（$C^3$）的函数 $f(t)$ 表示。为了估计信号在特定时间 $t_0$ 的瞬时变化率 $f'(t)$，该工程师使用了对称差商：\n$$\nf'(t_0) \\approx \\frac{f(t_0+h) - f(t_0-h)}{2h}\n$$\n其中 $h  0$ 是步长。\n\n该估计的总误差来自两个不同的来源：\n1.  **近似误差**：此误差是公式本身固有的，因为它是真实导数的一个近似。对于一个足够光滑的函数，该误差的大小由 $|E_A| \\le \\frac{M h^2}{6}$ 界定，其中 $M$ 是一个正常数，表示函数三阶导数在 $t_0$ 附近的绝对值的最大值，即 $|f'''(t)|$。\n2.  **计算精度误差**：用于测量或计算函数值 $f(t)$ 的设备精度有限。计算出的 $f(t)$ 值，记为 $\\text{fl}(f(t))$，会受到舍入误差的影响。任何单次函数求值的绝对误差都以一个最大值 $\\varepsilon  0$ 为界，使得 $|\\text{fl}(f(t)) - f(t)| \\le \\varepsilon$。当使用这些不精确的值计算差商时，这种误差会传播。\n\n工程师希望选择一个步长 $h$ 来最小化总误差。假设在最坏情况下，各个误差会累加，请确定能最小化总误差上界的最优步长 $h_{opt}$。请用 $M$ 和 $\\varepsilon$ 的符号表达式表示你的答案。", "solution": "我们将中心差分近似记为\n$$\nD(h) = \\frac{f(t_{0}+h)-f(t_{0}-h)}{2h}.\n$$\n根据带余项的泰勒定理，对于 $t_{0}-h$ 和 $t_{0}+h$ 之间的某些点，有\n$$\nf(t_{0}\\pm h) = f(t_{0}) \\pm h f'(t_{0}) + \\frac{h^{2}}{2} f''(t_{0}) \\pm \\frac{h^{3}}{6} f^{(3)}(\\xi_{\\pm}),\n$$\n这给出了中心差分截断误差\n$$\nE_{A} = D(h) - f'(t_{0}) = \\frac{h^{2}}{6} f^{(3)}(\\xi),\n$$\n其中 $\\xi$ 位于 $t_{0}-h$ 和 $t_{0}+h$ 之间。因此，利用在 $t_{0}$ 附近 $|f^{(3)}(t)| \\le M$ 的条件，近似误差满足\n$$\n|E_{A}| \\le \\frac{M h^{2}}{6}.\n$$\n\n对于计算精度误差，设计算出的函数值为\n$$\n\\text{fl}(f(t_{0}\\pm h)) = f(t_{0}\\pm h) + \\delta_{\\pm}, \\quad |\\delta_{\\pm}| \\le \\varepsilon.\n$$\n那么计算出的差商为\n$$\n\\frac{\\text{fl}(f(t_{0}+h)) - \\text{fl}(f(t_{0}-h))}{2h}\n= D(h) + \\frac{\\delta_{+} - \\delta_{-}}{2h},\n$$\n因此，所引起的舍入误差部分满足\n$$\n|E_{R}| = \\left|\\frac{\\delta_{+} - \\delta_{-}}{2h}\\right|\n\\le \\frac{|\\delta_{+}| + |\\delta_{-}|}{2h}\n\\le \\frac{2 \\varepsilon}{2 h}\n= \\frac{\\varepsilon}{h}.\n$$\n\n假设在最坏情况下误差可加性累积，总误差上界作为 $h0$ 的函数为\n$$\nE(h) = \\frac{M h^{2}}{6} + \\frac{\\varepsilon}{h}.\n$$\n为了最小化 $E(h)$，我们求导并令其为零：\n$$\nE'(h) = \\frac{M}{3} h - \\varepsilon h^{-2} = 0\n\\quad \\Longrightarrow \\quad\n\\frac{M}{3} h^{3} = \\varepsilon\n\\quad \\Longrightarrow \\quad\nh = \\left(\\frac{3 \\varepsilon}{M}\\right)^{\\frac{1}{3}}.\n$$\n由于\n$$\nE''(h) = \\frac{M}{3} + 2 \\varepsilon h^{-3}  0,\n$$\n该临界点是唯一的最小值点。因此，最优步长为\n$$\nh_{\\text{opt}} = \\left(\\frac{3 \\varepsilon}{M}\\right)^{\\frac{1}{3}}.\n$$", "answer": "$$\\boxed{\\left(\\frac{3 \\varepsilon}{M}\\right)^{\\frac{1}{3}}}$$", "id": "2169892"}]}