{"hands_on_practices": [{"introduction": "与关注输出误差（“我的答案错到哪儿了？”）的前向误差分析不同，向后误差分析提出了一个反向的问题：“需要对输入数据做多小的改动，才能使我的计算结果变得完全精确？” 这个练习通过一个直观的几何情景来阐释这一核心思想。我们将计算一个数据点到一条给定模型直线的最小距离，这个距离就代表了使该数据点完美符合模型的最小扰动，也就是向后误差。[@problem_id:2155431]", "problem": "在数值分析领域，向后误差分析是理解数学模型与观测数据之间差异的强大工具。它不问“对于给定的输入，模型输出的误差有多大？”，而是问“需要对输入数据做多小的改动，才能使模型的输出完全精确？”\n\n考虑一个由方程 $y = mx + c$ 给出的简单线性模型。采集了一个实验数据点 $(x_i, y_i)$，该点并不完全落在这条直线上。我们希望找到与此数据点和模型相关的向后误差。\n\n向后误差定义为对数据点 $(\\delta x_i, \\delta y_i)$ 的最小扰动的大小，使得新的点 $(x_i + \\delta x_i, y_i + \\delta y_i)$ 完全落在模型直线上。扰动的大小由标准欧几里得距离来衡量，即我们寻求最小化 $\\sqrt{(\\delta x_i)^2 + (\\delta y_i)^2}$ 的值。\n\n找到这个代表向后误差的最小扰动大小的符号表达式，该表达式用模型参数 $m$ 和 $c$ 以及数据坐标 $x_i$ 和 $y_i$ 来表示。", "solution": "我们寻求最小的扰动 $(\\delta x_{i}, \\delta y_{i})$，使得扰动后的点 $(x_{i} + \\delta x_{i}, y_{i} + \\delta y_{i})$ 完全落在直线 $y = m x + c$ 上。这个要求施加了以下约束条件\n$$\ny_{i} + \\delta y_{i} = m \\left(x_{i} + \\delta x_{i}\\right) + c,\n$$\n它可以被重写为\n$$\n\\delta y_{i} - m\\,\\delta x_{i} = m x_{i} + c - y_{i}.\n$$\n向后误差是在上述线性约束条件下，欧几里得范数\n$$\n\\sqrt{(\\delta x_{i})^{2} + (\\delta y_{i})^{2}},\n$$\n的最小值。因为平方根函数是单调的，我们等价地最小化\n$$\nJ(\\delta x_{i}, \\delta y_{i}) = (\\delta x_{i})^{2} + (\\delta y_{i})^{2}\n$$\n约束条件为\n$$\ng(\\delta x_{i}, \\delta y_{i}) = \\delta y_{i} - m\\,\\delta x_{i} - (m x_{i} + c - y_{i}) = 0.\n$$\n引入一个拉格朗日乘子 $\\lambda$ 并构造\n$$\n\\mathcal{L} = (\\delta x_{i})^{2} + (\\delta y_{i})^{2} + \\lambda\\left(\\delta y_{i} - m\\,\\delta x_{i} - (m x_{i} + c - y_{i})\\right).\n$$\n将偏导数设为零：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial \\delta x_{i}} = 2\\,\\delta x_{i} - \\lambda m = 0 \\quad \\Rightarrow \\quad \\delta x_{i} = \\frac{\\lambda m}{2},\n$$\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial \\delta y_{i}} = 2\\,\\delta y_{i} + \\lambda = 0 \\quad \\Rightarrow \\quad \\delta y_{i} = -\\frac{\\lambda}{2}.\n$$\n代入约束条件：\n$$\n\\delta y_{i} - m\\,\\delta x_{i} = m x_{i} + c - y_{i}.\n$$\n代入 $\\delta x_{i}$ 和 $\\delta y_{i}$ 的表达式：\n$$\n-\\frac{\\lambda}{2} - m\\left(\\frac{\\lambda m}{2}\\right) = m x_{i} + c - y_{i}\n\\quad \\Rightarrow \\quad\n-\\frac{\\lambda}{2}(1 + m^{2}) = m x_{i} + c - y_{i}.\n$$\n因此\n$$\n\\lambda = \\frac{2\\,(y_{i} - m x_{i} - c)}{1 + m^{2}}.\n$$\n所以，\n$$\n\\delta x_{i} = \\frac{\\lambda m}{2} = \\frac{m\\,(y_{i} - m x_{i} - c)}{1 + m^{2}}, \n\\quad\n\\delta y_{i} = -\\frac{\\lambda}{2} = -\\frac{y_{i} - m x_{i} - c}{1 + m^{2}}.\n$$\n最小的平方大小为\n$$\n(\\delta x_{i})^{2} + (\\delta y_{i})^{2} \n= \\frac{m^{2}(y_{i} - m x_{i} - c)^{2} + (y_{i} - m x_{i} - c)^{2}}{(1 + m^{2})^{2}}\n= \\frac{(y_{i} - m x_{i} - c)^{2}}{1 + m^{2}}.\n$$\n因此，最小扰动大小（即向后误差）是\n$$\n\\frac{|y_{i} - m x_{i} - c|}{\\sqrt{1 + m^{2}}}.\n$$\n这就是点 $(x_{i}, y_{i})$ 到直线 $y = m x + c$ 的垂直距离。", "answer": "$$\\boxed{\\frac{|y_{i} - m x_{i} - c|}{\\sqrt{1 + m^{2}}}}$$", "id": "2155431"}, {"introduction": "计算机在执行算术运算时会引入微小的舍入误差。当多个运算链接在一起时，这些误差会如何累积？向后误差分析为我们提供了一个强大的框架，它将最终计算结果中的总误差归结为对初始输入的等效扰动。在这个练习中，我们将通过分析一个复合运算 $z = (x+y)/w$ 来实践这一过程，学习如何将每一步产生的浮点误差追溯并分配回原始输入数据 $x$、$y$ 和 $w$。[@problem_id:2155424]", "problem": "考虑一台根据标准模型执行浮点运算的计算机。对于任意两个浮点数 $a$ 和 $b$，以及任意基本算术运算 $\\circ \\in \\{+, -, \\times, \\div\\}$，计算结果由 $fl(a \\circ b) = (a \\circ b)(1+\\delta)$ 给出，其中 $\\delta$ 是该运算的相对误差，其大小受机器精度 $u$ 的限制，即 $|\\delta| \\le u$。\n\n一位分析人员正在为给定的浮点数 $x, y, w$ 计算量 $z = \\frac{x+y}{w}$。该计算分两个连续的操作执行：首先，计算和 $s=x+y$；然后，计算商 $z=s/w$。设计算结果为 $\\hat{z}$。\n\n向后误差分析提供了一个解释这种计算误差的框架，它指出计算值 $\\hat{z}$ 是一个输入数据经过微小扰动后问题的 *精确* 结果。具体来说，我们可以找到相对扰动 $\\epsilon_x$, $\\epsilon_y$ 和 $\\epsilon_w$，使得以下等式精确成立：\n$$ \\hat{z} = \\frac{x(1+\\epsilon_x) + y(1+\\epsilon_y)}{w(1+\\epsilon_w)} $$\n假设加法步骤的相对误差为 $\\delta_1$，除法步骤的相对误差为 $\\delta_2$。扰动的选择不是唯一的。对于本问题，你需要遵循一个特定的误差归因方案：来自和 $(x+y)$ 的误差完全且对称地与单个项 $x$ 和 $y$ 相关联，而来自后续除法的误差完全与项 $w$ 相关联。\n\n遵循此误差归因方案，确定相对向后误差 $\\epsilon_x$, $\\epsilon_y$ 和 $\\epsilon_w$ 关于 $\\delta_1$ 和 $\\delta_2$ 的表达式。从以下选项中选择正确的表达式组。\n\nA. $\\epsilon_x = \\delta_1$, $\\epsilon_y = \\delta_1$, $\\epsilon_w = \\delta_2$\n\nB. $\\epsilon_x = \\delta_1+\\delta_2$, $\\epsilon_y = \\delta_1+\\delta_2$, $\\epsilon_w = 0$\n\nC. $\\epsilon_x = \\delta_1$, $\\epsilon_y = \\delta_1$, $\\epsilon_w = -\\delta_2$\n\nD. $\\epsilon_x = \\delta_1$, $\\epsilon_y = \\delta_1$, $\\epsilon_w = \\frac{-\\delta_2}{1+\\delta_2}$\n\nE. $\\epsilon_x = \\delta_1+\\delta_2$, $\\epsilon_y = \\delta_1+\\delta_2$, $\\epsilon_w = -\\delta_1-\\delta_2$\n\nF. $\\epsilon_x = \\delta_1(1+\\delta_2)$, $\\epsilon_y = \\delta_1(1+\\delta_2)$, $\\epsilon_w = 0$", "solution": "我们使用标准浮点模型：对于任意基本运算，$fl(a \\circ b) = (a \\circ b)(1+\\delta)$，其中 $|\\delta| \\leq u$。计算分两步进行。\n\n首先，计算和，其相对误差为 $\\delta_{1}$：\n$$\n\\hat{s} = fl(x+y) = (x+y)(1+\\delta_{1}).\n$$\n其次，计算除法，其相对误差为 $\\delta_{2}$：\n$$\n\\hat{z} = fl\\left(\\frac{\\hat{s}}{w}\\right) = \\left(\\frac{\\hat{s}}{w}\\right)(1+\\delta_{2}) = \\frac{(x+y)(1+\\delta_{1})}{w}(1+\\delta_{2}).\n$$\n\n向后误差分析要求找到 $\\epsilon_{x}$、$\\epsilon_{y}$、$\\epsilon_{w}$ 使得\n$$\n\\hat{z} = \\frac{x(1+\\epsilon_{x}) + y(1+\\epsilon_{y})}{w(1+\\epsilon_{w})}.\n$$\n根据归因方案，来自和的误差完全且对称地与 $x$ 和 $y$ 相关联，而来自除法的误差完全与 $w$ 相关联。\n\n为了对称地表示和的误差，我们选择\n$$\n\\epsilon_{x} = \\delta_{1}, \\quad \\epsilon_{y} = \\delta_{1},\n$$\n这得到\n$$\nx(1+\\epsilon_{x}) + y(1+\\epsilon_{y}) = x(1+\\delta_{1}) + y(1+\\delta_{1}) = (x+y)(1+\\delta_{1}).\n$$\n\n为了将除法的误差完全体现在 $w$ 中，我们要求\n$$\n\\frac{(x+y)(1+\\delta_{1})}{w(1+\\epsilon_{w})} = \\frac{(x+y)(1+\\delta_{1})}{w}(1+\\delta_{2}),\n$$\n这在消去公因子 $(x+y)(1+\\delta_{1})$ 后可化简为\n$$\n\\frac{1}{1+\\epsilon_{w}} = 1+\\delta_{2}.\n$$\n解出 $\\epsilon_{w}$ 可得\n$$\n1+\\epsilon_{w} = \\frac{1}{1+\\delta_{2}}, \\quad \\epsilon_{w} = \\frac{-\\delta_{2}}{1+\\delta_{2}}.\n$$\n\n因此，所需的扰动为\n$$\n\\epsilon_{x} = \\delta_{1}, \\quad \\epsilon_{y} = \\delta_{1}, \\quad \\epsilon_{w} = \\frac{-\\delta_{2}}{1+\\delta_{2}},\n$$\n这对应于选项 D。", "answer": "$$\\boxed{D}$$", "id": "2155424"}, {"introduction": "向后误差分析的真正威力在于评估整个算法的稳定性。一个数值稳定的算法，其计算出的解即使与真实解有偏差，也应是某个“邻近”问题的精确解。本练习将通过霍纳（Horner）方法计算多项式值的例子，来深入探讨这个概念。我们将证明，一个使得多项式计算结果为零的“机器根”，虽然不是原多项式的精确根，但它是一个系数被轻微扰动后的新多项式的精确根，这正是向后稳定性的体现。[@problem_id:2155426]", "problem": "在数值分析中，向后误差分析通过证明计算结果是某个邻近问题的精确解，来研究算法的稳定性。考虑对一个给定的值 $\\hat{x}$，计算二次多项式 $p(x) = ax^2 + bx + c$ 的值。该求值过程在浮点运算中采用霍纳方法（Horner's method）进行，其运算顺序对应于 $(a\\hat{x} + b)\\hat{x} + c$。\n\n我们采用一个简化的浮点运算模型，其中每个基本二元运算（`+`, `*`）都会引入一个相对误差。也就是说，对于任意两个数 $z_1$ 和 $z_2$，其浮点运算结果由 `fl(z_1 op z_2) = (z_1 op z_2)(1 + \\delta)` 给出，其中 $\\delta$ 是一个小的、特定于该次运算的相对误差项。\n\n计算 $p(\\hat{x})$ 值的浮点运算序列定义如下：\n1.  $a$ 和 $\\hat{x}$ 相乘，引入相对误差 $\\delta_1$。\n2.  第1步的结果与 $b$ 相加，引入相对误差 $\\delta_2$。\n3.  第2步的结果与 $\\hat{x}$ 相乘，引入相对误差 $\\delta_3$。\n4.  第3步的结果与 $c$ 相加，引入相对误差 $\\delta_4$。\n\n一个数值求根算法产生了一个值 $\\hat{x}$，使得这个四步序列的最终计算结果精确为零。这意味着 $\\hat{x}$ 可以被认为是该多项式的一个“机器根”。你的任务是应用向后误差分析，找出一个摄动多项式 $\\hat{p}(x) = \\hat{a}x^2 + \\hat{b}x + \\hat{c}$ 的系数 $(\\hat{a}, \\hat{b}, \\hat{c})$，使得 $\\hat{x}$ 是该多项式的一个*精确*根。换句话说，方程 $\\hat{a}\\hat{x}^2 + \\hat{b}\\hat{x} + \\hat{c} = 0$ 在精确算术下必须成立。\n\n请用原始系数 $a, b, c$ 和误差项 $\\delta_1, \\delta_2, \\delta_3, \\delta_4$ 来表示系数 $\\hat{a}$、$\\hat{b}$ 和 $\\hat{c}$。", "solution": "我们将每个浮点运算建模为一个精确运算乘以一个乘性扰动。设 $\\hat{x}$ 为返回的“机器根”，霍纳求值过程如下：\n1) 根据浮点乘法模型，$y_{1}=\\mathrm{fl}(a\\hat{x})=a\\hat{x}(1+\\delta_{1})$。\n2) 根据浮点加法模型，$y_{2}=\\mathrm{fl}(y_{1}+b)=(y_{1}+b)(1+\\delta_{2})=\\big(a\\hat{x}(1+\\delta_{1})+b\\big)(1+\\delta_{2})$。\n3) 根据浮点乘法模型，$y_{3}=\\mathrm{fl}(y_{2}\\hat{x})=y_{2}\\hat{x}(1+\\delta_{3})=\\big(a\\hat{x}(1+\\delta_{1})+b\\big)(1+\\delta_{2})\\hat{x}(1+\\delta_{3})$。\n4) 根据浮点加法模型，$y_{4}=\\mathrm{fl}(y_{3}+c)=(y_{3}+c)(1+\\delta_{4})$。\n\n根据假设，计算结果精确为零，所以 $y_{4}=0$。由于相对误差项很小，$1+\\delta_{4}\\neq 0$，因此\n$$\ny_{3}+c=0.\n$$\n将第3步的 $y_{3}$ 代入，得到\n$$\n\\big(a\\hat{x}(1+\\delta_{1})+b\\big)(1+\\delta_{2})\\hat{x}(1+\\delta_{3})+c=0.\n$$\n展开并按 $\\hat{x}$ 的幂次合并同类项，得到\n$$\na\\hat{x}^{2}(1+\\delta_{1})(1+\\delta_{2})(1+\\delta_{3})+b\\hat{x}(1+\\delta_{2})(1+\\delta_{3})+c=0.\n$$\n定义摄动系数为\n$$\n\\hat{a}=a(1+\\delta_{1})(1+\\delta_{2})(1+\\delta_{3}),\\quad\n\\hat{b}=b(1+\\delta_{2})(1+\\delta_{3}),\\quad\n\\hat{c}=c.\n$$\n那么上述方程变为\n$$\n\\hat{a}\\hat{x}^{2}+\\hat{b}\\hat{x}+\\hat{c}=0,\n$$\n所以 $\\hat{x}$ 是摄动多项式 $\\hat{p}(x)=\\hat{a}x^{2}+\\hat{b}x+\\hat{c}$ 的一个精确根。注意 $\\delta_{4}$ 没有出现在 $\\hat{a},\\hat{b},\\hat{c}$ 中，因为 $y_{4}=0$ 使得 $y_{3}+c=0$ 成立，这与最后的乘性因子 $(1+\\delta_{4})$ 无关。", "answer": "$$\\boxed{\\begin{pmatrix} a(1+\\delta_{1})(1+\\delta_{2})(1+\\delta_{3}) & b(1+\\delta_{2})(1+\\delta_{3}) & c \\end{pmatrix}}$$", "id": "2155426"}]}