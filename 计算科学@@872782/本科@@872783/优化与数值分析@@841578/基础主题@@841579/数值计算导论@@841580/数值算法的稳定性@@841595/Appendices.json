{"hands_on_practices": [{"introduction": "在计算机科学中，看似直接的数学表达式在有限精度算术下可能得出严重不准确的结果。这个练习 [@problem_id:2205457] 揭示了一个称为“灾难性抵消”的常见陷阱，即两个几乎相等的数相减会导致有效数字的大量损失。通过代数重构表达式，我们可以开发出一种数值上更稳定的计算方法。", "problem": "考虑函数 $f(x) = \\sqrt{x+1} - \\sqrt{x}$。当 $x$ 为很大的正数时，直接使用标准浮点运算计算 $f(x)$ 会因两个几乎相等的数相减而导致严重的精度损失。你的任务是首先找到一个与 $f(x)$ 代数上等价的表达式，该表达式由于避免了这种减法，在 $x$ 很大时数值上更稳定。然后，使用这个改进后的表达式来计算当 $x = 4 \\times 10^{16}$ 时 $f(x)$ 的值。\n\n将你的答案以科学记数法 $a \\times 10^b$ 的形式表示，并四舍五入到三位有效数字。", "solution": "我们希望避免当 $x$ 为大的正数时，在 $f(x) = \\sqrt{x+1} - \\sqrt{x}$ 中出现的灾难性抵消。分子和分母同乘以共轭表达式，得到一个代数上等价的形式：\n$$\nf(x) = \\left(\\sqrt{x+1} - \\sqrt{x}\\right)\\frac{\\sqrt{x+1} + \\sqrt{x}}{\\sqrt{x+1} + \\sqrt{x}} = \\frac{(x+1) - x}{\\sqrt{x+1} + \\sqrt{x}} = \\frac{1}{\\sqrt{x+1} + \\sqrt{x}}.\n$$\n这个表达式避免了两个几乎相等的大数相减，因此在数值上更稳定。\n\n对于 $x = 4 \\times 10^{16}$，使用稳定形式计算：\n$$\nf(4 \\times 10^{16}) = \\frac{1}{\\sqrt{4 \\times 10^{16} + 1} + \\sqrt{4 \\times 10^{16}}}.\n$$\n注意到 $\\sqrt{4 \\times 10^{16}} = 2 \\times 10^{8}$。此外，\n$$\n\\sqrt{4 \\times 10^{16} + 1} = 2 \\times 10^{8}\\sqrt{1 + \\frac{1}{4 \\times 10^{16}}}.\n$$\n设 $\\epsilon = \\frac{1}{4 \\times 10^{16}}$。使用二项式展开 $\\sqrt{1+\\epsilon} = 1 + \\frac{\\epsilon}{2} - \\frac{\\epsilon^{2}}{8} + \\cdots$，我们有\n$$\n\\sqrt{4 \\times 10^{16} + 1} = 2 \\times 10^{8}\\left(1 + \\frac{\\epsilon}{2} - \\frac{\\epsilon^{2}}{8} + \\cdots \\right) = 2 \\times 10^{8} + 10^{8}\\epsilon + O(\\epsilon^{2}).\n$$\n因此分母是\n$$\n\\sqrt{4 \\times 10^{16} + 1} + \\sqrt{4 \\times 10^{16}} = 4 \\times 10^{8} + 10^{8}\\epsilon + O(\\epsilon^{2}).\n$$\n因此，\n$$\nf(4 \\times 10^{16}) = \\frac{1}{4 \\times 10^{8} + 10^{8}\\epsilon + O(\\epsilon^{2})} = \\frac{1}{4 \\times 10^{8}}\\left(1 - \\frac{10^{8}\\epsilon}{4 \\times 10^{8}} + O(\\epsilon^{2})\\right).\n$$\n因为 $\\epsilon = 2.5 \\times 10^{-17}$，主项是\n$$\n\\frac{1}{4 \\times 10^{8}} = 2.5 \\times 10^{-9},\n$$\n而修正项的量级为 $10^{-26}$，这不影响四舍五入到三位有效数字的结果。因此，保留三位有效数字，\n$$\nf(4 \\times 10^{16}) \\approx 2.50 \\times 10^{-9}.\n$$", "answer": "$$\\boxed{2.50 \\times 10^{-9}}$$", "id": "2205457"}, {"introduction": "灾难性抵消的问题也出现在我们熟知的一元二次方程求根公式中。这个练习 [@problem_id:2205401] 演示了标准求根公式如何在特定系数下失效，并介绍了利用韦达定理的稳定替代算法。这强调了在求解问题时，选择正确的数值算法至关重要。", "problem": "某个阻尼系统中一个特定物理量的时间演化可以通过求解二次方程 $at^2 + bt + c = 0$ 的根来确定。对于一个具有非常强阻尼的特定实验装置，其系数确定为 $a = 1.00$，$b = 1.00 \\times 10^7$ 和 $c = 1.00$。该系统的长期行为由绝对值较小的根决定。\n\n确定方程 $t^2 + (1.00 \\times 10^7) t + 1.00 = 0$ 的两个根中量值较小的那个根的值。\n\n将你的答案以实数形式给出，并四舍五入到三位有效数字。", "solution": "问题要求解二次方程 $at^2 + bt + c = 0$ 中量值较小的根，其中 $a=1.00$，$b=1.00 \\times 10^7$，$c=1.00$。\n\n该方程根的标准二次公式为：\n$$t = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$$\n\n代入给定值，我们得到：\n$$t = \\frac{-1.00 \\times 10^7 \\pm \\sqrt{(1.00 \\times 10^7)^2 - 4(1.00)(1.00)}}{2(1.00)}$$\n$$t = \\frac{-10^7 \\pm \\sqrt{10^{14} - 4}}{2}$$\n\n这给出了两个根：\n$$t_1 = \\frac{-10^7 + \\sqrt{10^{14} - 4}}{2}$$\n$$t_2 = \\frac{-10^7 - \\sqrt{10^{14} - 4}}{2}$$\n\n我们需要找出量值较小的那个根。\n对于 $t_2$，分子是两个大的负数之和。所以，$|t_2| \\approx \\frac{10^7 + 10^7}{2} = 10^7$。\n对于 $t_1$，项 $\\sqrt{10^{14} - 4}$ 非常接近 $\\sqrt{10^{14}} = 10^7$。因此，分子涉及两个几乎相等的数的减法：$-10^7$ 和一个略小于 $10^7$ 的数。这意味着 $t_1$ 的量值会非常小。因此，$t_1$ 就是我们要找的根。\n\n然而，在有限精度算法中，直接使用这个公式计算 $t_1$ 会有问题。两个几乎相等的数相减会导致有效数字的损失，这种效应被称为灾难性抵消。例如，如果一个计算器保留8位有效数字，$\\sqrt{10^{14}-4}$ 将被计算为 $10^7$，分子将变为 $-10^7 + 10^7 = 0$，从而得到一个错误的根 $0$。\n\n为了找到 $t_1$ 的精确值，我们必须使用一种数值稳定的方法。我们可以利用韦达定理，它将多项式的系数与其根联系起来。对于二次方程，两根之积由 $t_1 t_2 = \\frac{c}{a}$ 给出。\n\n我们可以先计算 $t_2$，因为它的公式涉及两个同号大数的相加，这在数值上是稳定的。\n$$t_2 = \\frac{-10^7 - \\sqrt{10^{14} - 4}}{2}$$\n由于 $10^{14} \\gg 4$，$\\sqrt{10^{14}-4}$ 非常接近 $10^7$。所以，$t_2 \\approx \\frac{-10^7 - 10^7}{2} = -10^7$。\n\n现在，我们可以使用关系式 $t_1 = \\frac{c/a}{t_2}$ 来求 $t_1$：\n$$t_1 = \\frac{1.00/1.00}{t_2} = \\frac{1}{t_2} = \\frac{1}{\\frac{-10^7 - \\sqrt{10^{14} - 4}}{2}} = \\frac{2}{-10^7 - \\sqrt{10^{14} - 4}}$$\n这个 $t_1$ 的表达式在数值上是稳定的，因为分母涉及两个大的负数相加。\n\n为了计算这个值，我们可以再次注意到分母约等于 $-10^7 - 10^7 = -2 \\times 10^7$。\n$$t_1 \\approx \\frac{2}{-2 \\times 10^7} = -1 \\times 10^{-7}$$\n\n为了证实这一点并获得所需的精度，我们可以使用二项式近似。设 $\\delta = \\frac{4ac}{b^2} = \\frac{4}{10^{14}} = 4 \\times 10^{-14}$。\n项 $\\sqrt{b^2 - 4ac}$ 可以写成 $|b|\\sqrt{1 - \\frac{4ac}{b^2}} = b\\sqrt{1-\\delta}$（因为 $b>0$）。\n对于小的 $x$，使用泰勒展开 $(1-x)^{1/2} \\approx 1 - \\frac{1}{2}x$：\n$$ \\sqrt{b^2 - 4ac} \\approx b \\left(1 - \\frac{1}{2}\\frac{4ac}{b^2}\\right) = b - \\frac{2ac}{b} $$\n将此代入不稳定的 $t_1$ 公式中：\n$$ t_1 = \\frac{-b + \\sqrt{b^2-4ac}}{2a} \\approx \\frac{-b + (b - \\frac{2ac}{b})}{2a} = \\frac{-2ac/b}{2a} = -\\frac{c}{b} $$\n这为小根提供了一个非常精确的近似值：\n$$ t_1 \\approx -\\frac{c}{b} = -\\frac{1.00}{1.00 \\times 10^7} = -1.00 \\times 10^{-7} $$\n这个结果与使用稳定公式计算的结果一致。\n\n将结果四舍五入到三位有效数字，我们得到 $-1.00 \\times 10^{-7}$。", "answer": "$$\\boxed{-1.00 \\times 10^{-7}}$$", "id": "2205401"}, {"introduction": "数值稳定性不仅关乎单次运算的精度，更关乎迭代算法在多步计算后的累积行为。这个练习 [@problem_id:2205446] 探讨了显式欧拉法在求解微分方程时的稳定性。它将向你展示，一个看似合理的步长选择如何导致数值解发散，并产生完全不符合物理现实的结果。", "problem": "一位科学家正在模拟一个简单的一级反应中化学反应物浓度 $C(t)$ 的变化。该反应物浓度的变化率与浓度本身成正比，遵循以下微分方程：\n$$\n\\frac{dC}{dt} = -k C(t)\n$$\n速率常数给定为 $k = 50.0 \\text{ s}^{-1}$，时间 $t=0$ 时的初始浓度为 $C(0) = 100.0 \\text{ mol/L}$。\n\n为了预测未来的浓度，该科学家采用了一种使用固定时间步长 $h$ 的数值方法。该方法根据显式欧拉更新法则，使用前一个时间步 $t_n = nh$ 的值来近似计算时间 $t_{n+1} = (n+1)h$ 时的浓度：\n$$\nC_{n+1} = C_n + h \\left( \\frac{dC}{dt} \\right)_{t=t_n}\n$$\n该科学家决定使用 $h = 0.0410 \\text{ s}$ 的时间步长。计算该方法在三个时间步长后预测的浓度 $C_3$ 的数值。以 mol/L 为单位表示您的答案，并四舍五入至三位有效数字。", "solution": "给定一阶线性常微分方程 $\\frac{dC}{dt}=-kC(t)$ 和显式欧拉更新\n$$\nC_{n+1}=C_{n}+h\\left(\\frac{dC}{dt}\\right)_{t=t_{n}}=C_{n}+h(-kC_{n})=(1-kh)C_{n}.\n$$\n通过递推，可得\n$$\nC_{n}=C_{0}(1-kh)^{n}.\n$$\n已知 $C_{0}=100.0$，$k=50.0\\,\\text{s}^{-1}$ 以及 $h=0.0410\\,\\text{s}$，无量纲乘积为\n$$\nkh=(50.0)(0.0410)=2.05,\\quad 1-kh=1-2.05=-1.05.\n$$\n因此，三步之后，\n$$\nC_{3}=100.0\\,(-1.05)^{3}.\n$$\n计算幂次：\n$$\n(-1.05)^{2}=1.1025,\\quad (-1.05)^{3}=1.1025\\times(-1.05)=-1.157625,\n$$\n所以\n$$\nC_{3}=100.0\\times(-1.157625)=-115.7625.\n$$\n四舍五入至三位有效数字得到 $-1.16\\times 10^{2}$，即 $-116$。注意，显式欧拉因子满足 $|1-kh|=1.05>1$，表明对于该步长是不稳定的，这解释了不符合物理实际的符号变化。", "answer": "$$\\boxed{-116}$$", "id": "2205446"}]}