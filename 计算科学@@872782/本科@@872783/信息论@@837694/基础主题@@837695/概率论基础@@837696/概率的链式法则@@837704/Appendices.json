{"hands_on_practices": [{"introduction": "概率的链式法则是理解和分析序贯事件的基础。本练习通过一个自适应学习系统的具体场景，让你初步实践链式法则最直接的应用：计算一个马尔可夫过程中特定结果序列的概率。通过这个练习，你将学会如何将一个复杂序列的联合概率分解为一系列更简单的条件概率的乘积。[@problem_id:1609151]", "problem": "一个自适应学习系统向学生展示一系列三个数学问题。该系统的算法会根据学生在前一个问题上的表现来调整每个问题的难度。设 $S_k$ 表示学生成功解决问题 $k$ 的事件， $F_k$ 表示学生未能解决问题 $k$ 的事件。\n\n该系统根据以下概率规则运行：\n1.  对于第一个问题，成功解决的概率是 $P(S_1) = 0.65$。\n2.  对于任何后续问题 $k > 1$，成功的概率取决于问题 $k-1$ 的结果。\n    -   如果学生解决了问题 $k-1$，系统会呈现一个更难的问题，解决问题 $k$ 的概率是 $P(S_k | S_{k-1}) = 0.40$。\n    -   如果学生未能解决问题 $k-1$，系统会呈现一个更容易的问题，解决问题 $k$ 的概率是 $P(S_k | F_{k-1}) = 0.85$。\n3.  任何问题 $k$ 的结果在给定问题 $k-1$ 的结果的条件下，与 $k-1$ 之前的所有结果条件独立。\n\n计算学生对这三个问题的结果序列为“成功、失败、再成功”的概率。将最终答案以小数形式给出，并四舍五入到三位有效数字。", "solution": "我们要求解序列 $S_{1}, F_{2}, S_{3}$ 的概率。根据概率的链式法则，\n$$\nP(S_{1} \\cap F_{2} \\cap S_{3}) = P(S_{1}) \\, P(F_{2} \\mid S_{1}) \\, P(S_{3} \\mid F_{2}, S_{1}).\n$$\n根据指定的条件独立规则（马尔可夫性质），问题3的结果仅取决于问题2，所以\n$$\nP(S_{3} \\mid F_{2}, S_{1}) = P(S_{3} \\mid F_{2}).\n$$\n使用给定的转移概率，\n$$\nP(S_{1}) = 0.65, \\quad P(F_{2} \\mid S_{1}) = 1 - P(S_{2} \\mid S_{1}) = 1 - 0.40 = 0.60, \\quad P(S_{3} \\mid F_{2}) = 0.85.\n$$\n因此，\n$$\nP(S_{1} \\cap F_{2} \\cap S_{3}) = 0.65 \\times 0.60 \\times 0.85 = 0.3315.\n$$\n四舍五入到三位有效数字，概率为 $0.332$。", "answer": "$$\\boxed{0.332}$$", "id": "1609151"}, {"introduction": "在许多现实世界的应用中，我们关心的不仅仅是某一个特定序列发生的概率，而是某个“目标事件”发生的总概率，这个事件可能由多个不同序列构成。这个问题将引导你从计算单一路径的概率，进阶到计算一个复合事件的概率——在此例中，即一个传输的数据块是“可纠正的”的概率。你需要运用链式法则计算每种可纠正错误模式的概率，然后将它们相加，从而掌握解决更复杂概率问题的关键技巧。[@problem_id:1609163]", "problem": "一个4比特的数据块通过一个有噪声的数字信道传输。该信道表现出记忆效应，即在给定位置发生比特错误的可能性取决于前一个位置是否发生了错误。设 $E_i$ 为在比特位置 $i$ 发生错误的事件，其中 $i \\in \\{1, 2, 3, 4\\}$。\n\n其错误特征如下：\n- 第一个比特发生错误的概率为 $P(E_1) = p_1$。\n- 对于任何后续比特 $i > 1$，在前一个比特位置 $i-1$ 发生错误的条件下，该位置发生错误的条件概率为 $P(E_i | E_{i-1}) = p_c$。\n- 对于任何后续比特 $i > 1$，在前一个比特位置 $i-1$ 没有发生错误的条件下，该位置发生错误的条件概率为 $P(E_i | E_{i-1}^c) = p_u$，其中 $E_{i-1}^c$ 是 $E_{i-1}$ 的补事件。\n\n接收到的数据块随后由一个单位纠错码的译码器处理。当且仅当接收到的数据块最多包含一个比特错误时，该译码器才能成功恢复原始的4比特数据块。\n\n给定参数 $p_1 = 0.05$，$p_c = 0.4$ 和 $p_u = 0.02$，计算一个传输的4比特数据块可被该译码器纠正的总概率。将您的最终答案四舍五入到四位有效数字。", "solution": "设 $E_{i}$ 表示在比特 $i$ 发生错误的事件，$E_{i}^{c}$ 是其补事件。该信道具有一阶记忆，因此一个长度为4的错误/无错误序列的概率等于初始概率与三个基于紧邻前一结果的条件转移概率的乘积。\n\n定义互补概率\n$$q_{1} = 1 - p_{1}, \\quad q_{c} = 1 - p_{c}, \\quad q_{u} = 1 - p_{u}.$$\n\n当且仅当数据块中最多只有一个错误时，译码器才能成功。我们对所有零错误和恰好一个错误的序列的概率求和。\n\n零错误 (模式 $E_{1}^{c}E_{2}^{c}E_{3}^{c}E_{4}^{c}$):\n$P_{0} = P(E_{1}^{c}) P(E_{2}^{c} \\mid E_{1}^{c}) P(E_{3}^{c} \\mid E_{2}^{c}) P(E_{4}^{c} \\mid E_{3}^{c}) = q_{1} \\, q_{u}^{3}.$\n\n在位置1恰好有一个错误 (模式 $E_{1}E_{2}^{c}E_{3}^{c}E_{4}^{c}$):\n$P_{1} = P(E_{1}) P(E_{2}^{c} \\mid E_{1}) P(E_{3}^{c} \\mid E_{2}^{c}) P(E_{4}^{c} \\mid E_{3}^{c}) = p_{1} \\, q_{c} \\, q_{u}^{2}.$\n\n在位置2恰好有一个错误 (模式 $E_{1}^{c}E_{2}E_{3}^{c}E_{4}^{c}$):\n$P_{2} = P(E_{1}^{c}) P(E_{2} \\mid E_{1}^{c}) P(E_{3}^{c} \\mid E_{2}) P(E_{4}^{c} \\mid E_{3}^{c}) = q_{1} \\, p_{u} \\, q_{c} \\, q_{u}.$\n\n在位置3恰好有一个错误 (模式 $E_{1}^{c}E_{2}^{c}E_{3}E_{4}^{c}$):\n$P_{3} = P(E_{1}^{c}) P(E_{2}^{c} \\mid E_{1}^{c}) P(E_{3} \\mid E_{2}^{c}) P(E_{4}^{c} \\mid E_{3}) = q_{1} \\, q_{u} \\, p_{u} \\, q_{c}.$\n\n在位置4恰好有一个错误 (模式 $E_{1}^{c}E_{2}^{c}E_{3}^{c}E_{4}$):\n$P_{4} = P(E_{1}^{c}) P(E_{2}^{c} \\mid E_{1}^{c}) P(E_{3}^{c} \\mid E_{2}^{c}) P(E_{4} \\mid E_{3}^{c}) = q_{1} \\, q_{u}^{2} \\, p_{u}.$\n\n因此，总的可纠正概率为\n$$P_{\\text{corr}} = P_{0} + P_{1} + P_{2} + P_{3} + P_{4} = q_{1} q_{u}^{3} + p_{1} q_{c} q_{u}^{2} + 2 q_{1} p_{u} q_{c} q_{u} + q_{1} q_{u}^{2} p_{u}.$$\n使用 $q_{u}^{3} + q_{u}^{2} p_{u} = q_{u}^{2} (q_{u} + p_{u}) = q_{u}^{2}$，可以简化为\n$$P_{\\text{corr}} = q_{1} q_{u} \\left(q_{u} + 2 p_{u} q_{c}\\right) + p_{1} q_{c} q_{u}^{2}.$$\n\n代入 $p_{1} = 0.05$，$p_{c} = 0.4$，$p_{u} = 0.02$，因此 $q_{1} = 0.95$，$q_{c} = 0.6$，$q_{u} = 0.98$：\n$q_{u}^{2} = 0.9604, \\quad 2 p_{u} q_{c} = 2 \\cdot 0.02 \\cdot 0.6 = 0.024,$\n$q_{u} + 2 p_{u} q_{c} = 0.98 + 0.024 = 1.004,$\n$q_{1} q_{u} \\left(q_{u} + 2 p_{u} q_{c}\\right) = 0.95 \\cdot 0.98 \\cdot 1.004 = 0.934724,$\n$p_{1} q_{c} q_{u}^{2} = 0.05 \\cdot 0.6 \\cdot 0.9604 = 0.028812.$\n因此，\n$$P_{\\text{corr}} = 0.934724 + 0.028812 = 0.963536.$$\n四舍五入到四位有效数字得到 $0.9635$。", "answer": "$$\\boxed{0.9635}$$", "id": "1609163"}, {"introduction": "链式法则的威力远不止于处理简单的一维时间序列，它可以推广到更复杂的依赖结构。这个挑战性问题将促使你将序贯条件概率的思想应用到一个二维网格上，这种模型在图像处理和统计物理等领域中至关重要。通过计算一个特定网格构型的概率，你将深入理解如何系统性地分解和计算复杂高维系统中的联合概率，这为你理解更高级的概率模型（如马尔可夫随机场）打下坚实基础。[@problem_id:1609176]", "problem": "考虑一个新型存储阵列的简化模型，该模型由一个 $3 \\times 3$ 的相互作用的二进制单元格网格组成。位于第 $i$ 行、第 $j$ 列的单元的状态由一个随机变量 $X_{i,j} \\in \\{0, 1\\}$ 表示，其中 $i, j \\in \\{1, 2, 3\\}$。\n\n单元的状态按光栅扫描顺序依次确定：$X_{1,1}, X_{1,2}, X_{1,3}, X_{2,1}, X_{2,2}, X_{2,3}, X_{3,1}, X_{3,2}, X_{3,3}$。每个单元的状态，条件性地依赖于其状态已被确定的邻居。如果 $|i-k| + |j-l| = 1$，则两个单元 $(i,j)$ 和 $(k,l)$ 被认为是邻居。\n\n决定单元 $(i,j)$ 状态的概率规则如下。首先，根据在光栅扫描序列中其状态已被确定的邻居，计算一个局部影响场 $h_{i,j}$。该场由下式给出：\n$$h_{i,j} = \\sum_{(k,l) \\in N_{i,j}^{\\text{prev}}} (2X_{k,l} - 1)$$\n其中 $N_{i,j}^{\\text{prev}}$ 是单元 $(i,j)$ 的状态先被确定的邻居的集合。如果一个单元没有状态先被确定的邻居，其影响场为 $h_{i,j}=0$。\n\n单元状态为1的条件概率则由该场的一个逻辑斯谛函数给出：\n$$P(X_{i,j}=1 | \\text{past states}) = \\frac{1}{1 + \\exp(-\\gamma h_{i,j})}$$\n其中 $\\gamma = \\ln(3)$ 是一个耦合常数。\n\n你的任务是计算观测到整个网格出现以下特定棋盘格配置的概率：\n$$\n\\begin{pmatrix}\nX_{1,1}  X_{1,2}  X_{1,3} \\\\\nX_{2,1}  X_{2,2}  X_{2,3} \\\\\nX_{3,1}  X_{3,2}  X_{3,3}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n1  0  1 \\\\\n0  1  0 \\\\\n1  0  1\n\\end{pmatrix}\n$$\n计算这个总概率，并以四舍五入到四位有效数字的小数形式给出你的答案。", "solution": "我们通过与光栅扫描顺序一致的链式法则，来顺序地描述联合概率。对于每个单元，局部场为\n$$\nh_{i,j}=\\sum_{(k,l)\\in N_{i,j}^{\\text{prev}}} (2X_{k,l}-1),\n$$\n且条件概率是逻辑斯谛的：\n$$\nP(X_{i,j}=1 \\mid \\text{past})=\\frac{1}{1+\\exp(-\\gamma h_{i,j})},\\quad \\gamma=\\ln(3).\n$$\n由于 $\\exp(-\\gamma h)=\\exp(-\\ln(3)\\,h)=3^{-h}$，我们可以推导出状态为1和0的概率：\n$$\nP(X=1\\mid h)=\\frac{1}{1+3^{-h}},\\qquad P(X=0\\mid h)=1-P(X=1\\mid h)=\\frac{1}{1+3^{h}}.\n$$\n指定配置的联合概率等于按光栅顺序计算的这些条件概率的乘积。\n\n我们按如下方式为目标配置\n$$\n\\begin{pmatrix}\n1  0  1\\\\\n0  1  0\\\\\n1  0  1\n\\end{pmatrix}\n$$\n计算每个因子，其中仅使用先前已确定的邻居（左侧和/或上方）：\n\n1) $(1,1)$: $N_{1,1}^{\\text{prev}}=\\varnothing$，所以 $h_{1,1}=0$。当 $X_{1,1}=1$ 时，$P = \\frac{1}{1+3^{-0}} = \\frac{1}{2}$。\n\n2) $(1,2)$: $N_{1,2}^{\\text{prev}}=\\{(1,1)\\}$，其中 $X_{1,1}=1$，所以 $h_{1,2}=+1$。当 $X_{1,2}=0$ 时，$P = \\frac{1}{1+3^1} = \\frac{1}{4}$。\n\n3) $(1,3)$: $N_{1,3}^{\\text{prev}}=\\{(1,2)\\}$，其中 $X_{1,2}=0$，所以 $h_{1,3}=-1$。当 $X_{1,3}=1$ 时，$P = \\frac{1}{1+3^{-(-1)}} = \\frac{1}{1+3} = \\frac{1}{4}$。\n\n4) $(2,1)$: $N_{2,1}^{\\text{prev}}=\\{(1,1)\\}$，其中 $X_{1,1}=1$，所以 $h_{2,1}=+1$。当 $X_{2,1}=0$ 时，$P = \\frac{1}{1+3^1} = \\frac{1}{4}$。\n\n5) $(2,2)$: $N_{2,2}^{\\text{prev}}=\\{(2,1),(1,2)\\}$，其中 $X_{2,1}=0$ 且 $X_{1,2}=0$，所以 $h_{2,2}=-1-1=-2$。当 $X_{2,2}=1$ 时，$P = \\frac{1}{1+3^{-(-2)}} = \\frac{1}{1+3^2} = \\frac{1}{10}$。\n\n6) $(2,3)$: $N_{2,3}^{\\text{prev}}=\\{(2,2),(1,3)\\}$，其中 $X_{2,2}=1$ 且 $X_{1,3}=1$，所以 $h_{2,3}=+1+1=+2$。当 $X_{2,3}=0$ 时，$P = \\frac{1}{1+3^2} = \\frac{1}{10}$。\n\n7) $(3,1)$: $N_{3,1}^{\\text{prev}}=\\{(2,1)\\}$，其中 $X_{2,1}=0$，所以 $h_{3,1}=-1$。当 $X_{3,1}=1$ 时，$P = \\frac{1}{1+3^{-(-1)}} = \\frac{1}{1+3} = \\frac{1}{4}$。\n\n8) $(3,2)$: $N_{3,2}^{\\text{prev}}=\\{(3,1),(2,2)\\}$，其中 $X_{3,1}=1$ 且 $X_{2,2}=1$，所以 $h_{3,2}=+2$。当 $X_{3,2}=0$ 时，$P = \\frac{1}{1+3^2} = \\frac{1}{10}$。\n\n9) $(3,3)$: $N_{3,3}^{\\text{prev}}=\\{(3,2),(2,3)\\}$，其中 $X_{3,2}=0$ 且 $X_{2,3}=0$，所以 $h_{3,3}=-2$。当 $X_{3,3}=1$ 时，$P = \\frac{1}{1+3^{-(-2)}} = \\frac{1}{1+3^2} = \\frac{1}{10}$。\n\n因此，总概率为\n$$\nP_{\\text{total}}=\\left(\\frac{1}{2}\\right)\\left(\\frac{1}{4}\\right)^{4}\\left(\\frac{1}{10}\\right)^{4}\n=\\frac{1}{2\\cdot 256 \\cdot 10000}=\\frac{1}{5120000}.\n$$\n转换为科学记数法并四舍五入到四位有效数字，\n$$\n\\frac{1}{5120000}=1.953125\\times 10^{-7}\\approx 1.953\\times 10^{-7}.\n$$", "answer": "$$\\boxed{1.953 \\times 10^{-7}}$$", "id": "1609176"}]}