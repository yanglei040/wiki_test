## 引言
在探索由[随机过程](@entry_id:159502)驱动的复杂系统时，一个核心问题浮出水面：随着时间的推移，这些系统的[长期行为](@entry_id:192358)会呈现出何种模式？它们是会陷入无尽的混沌，还是会趋向于某种可预测的稳定状态？[马尔可夫链](@entry_id:150828)为我们提供了一个强大的框架来模拟这类系统，而“[平稳分布](@entry_id:194199)”正是揭示其长期行为之谜的关键。它解决了当系统演化了足够长的时间后，其状态概率将如何[分布](@entry_id:182848)这一知识空白，从而使我们能够预测和理解从物理粒子运动到网页浏览行为等各种现象的宏观均衡。

本文将系统性地引导你深入理解[马尔可夫链](@entry_id:150828)的平稳分布。在“原理与机制”一章中，我们将从基本定义出发，学习如何通过[求解线性方程组](@entry_id:169069)来精确计算[平稳分布](@entry_id:194199)，并探讨保证其存在且唯一的关键理论条件。接着，在“应用与跨学科联系”一章，我们将跨越学科界限，展示平稳分布如何在物理学、遗传学、计算机科学（著名的[PageRank算法](@entry_id:138392)）和机器学习（如[MCMC方法](@entry_id:137183)）等领域中发挥核心作用，将抽象理论与实际问题紧密相连。最后，通过“动手实践”部分精心设计的练习，你将有机会亲手应用所学知识，巩固对这一强大概念的掌握。让我们一同开始这段探索随机世界中稳定秩序的旅程。

## 原理与机制

在对[马尔可夫链](@entry_id:150828)进行了初步介绍之后，一个自然而深刻的问题随之而来：当一个系统经历了大量的时间步长后，它的行为会呈现出怎样的模式？系统最终会趋于一种稳定状态吗？如果是，我们如何描述和预测这种[长期行为](@entry_id:192358)？本章将深入探讨**[平稳分布](@entry_id:194199)（stationary distribution）**的概念，它正是回答这些问题的关键。平稳分布描述了马尔可夫链的[长期均衡](@entry_id:139043)特性，是理解和应用马尔可夫链的核心。

### [平稳分布](@entry_id:194199)的定义

一个[马尔可夫链](@entry_id:150828)的平稳分布是一个特殊的[概率分布](@entry_id:146404)，一旦系统达到这个[分布](@entry_id:182848)，它在未来的所有时间步长中都将保持这个[分布](@entry_id:182848)。从直观上看，它代表了系统的一种“随机均衡”状态。

形式上，对于一个具有转移[概率矩阵](@entry_id:274812) $P$ 的[马尔可夫链](@entry_id:150828)，一个行向量 $\pi = (\pi_1, \pi_2, \dots, \pi_k)$ 如果满足以下三个条件，就被称为该[马尔可夫链](@entry_id:150828)的**[平稳分布](@entry_id:194199)**：
1.  **状态方程**: $\pi P = \pi$
2.  **非负性**: 所有分量 $\pi_i \ge 0$
3.  **归一化**: 所有分量之和为 1, 即 $\sum_{i=1}^{k} \pi_i = 1$

[状态方程](@entry_id:274378) $\pi P = \pi$ 是核心所在。它表明，如果系统在某个时刻的状态[分布](@entry_id:182848)是 $\pi$，那么经过一步转移后，系统的状态[分布](@entry_id:182848)仍然是 $\pi$。换言之，在平稳状态下，从其他状态流入任意状态 $j$ 的总概率恰好等于从状态 $j$ 流出的总概率，从而使得每个状态的概率得以保持恒定。

这种“[不变性](@entry_id:140168)”是[平稳分布](@entry_id:194199)最根本的特性。我们可以通过一个例子来加深理解 [@problem_id:1660526]。假设一个用户群体在三个网站之间的浏览行为构成一个[马尔可夫链](@entry_id:150828)。如果该用户群体在初始时刻 $t=0$ 的[分布](@entry_id:182848) $p_0 = \begin{pmatrix} \frac{4}{11}  \frac{4}{11}  \frac{3}{11} \end{pmatrix}$ 恰好是该链的[平稳分布](@entry_id:194199)，那么在下一个时刻 $t=1$，其[分布](@entry_id:182848)将是 $p_1 = p_0 P$。根据平稳分布的定义，我们有 $p_0 P = p_0$，因此 $p_1 = p_0$。通过[数学归纳法](@entry_id:138544)，我们可以轻易地证明，在任何后续时刻 $n$，[分布](@entry_id:182848)都将保持不变，即 $p_n = p_0$。因此，即使在50个时间步之后，用户群体的[分布](@entry_id:182848) $p_{50}$ 依然是 $\begin{pmatrix} \frac{4}{11}  \frac{4}{11}  \frac{3}{11} \end{pmatrix}$。这个例子生动地展示了“平稳”的含义：一旦系统进入平稳分布，它就会“停驻”于此。

然而，需要强调的是，并非任何一个[概率分布](@entry_id:146404)都是[平稳分布](@entry_id:194199)。必须通过 $\pi P = \pi$ 的检验。例如，考虑一个用户在三个网页（主页、产品页、关于页）之间跳转的模型 [@problem_id:1660552]。我们可能会猜测，从长远来看，用户停留在每个页面的概率是均等的，即[平稳分布](@entry_id:194199)是[均匀分布](@entry_id:194597) $\pi = \begin{pmatrix} \frac{1}{3}  \frac{1}{3}  \frac{1}{3} \end{pmatrix}$。为了验证这个猜想，我们必须计算 $\pi P$：
$$
\pi P = \begin{pmatrix} \frac{1}{3}  \frac{1}{3}  \frac{1}{3} \end{pmatrix} \begin{pmatrix} 0.5  0.5  0 \\ 0.2  0.6  0.2 \\ 1.0  0  0 \end{pmatrix} = \begin{pmatrix} \frac{17}{30}  \frac{11}{30}  \frac{2}{30} \end{pmatrix}
$$
计算结果 $\begin{pmatrix} \frac{17}{30}  \frac{11}{30}  \frac{2}{30} \end{pmatrix}$ 显然不等于我们所假设的 $\pi = \begin{pmatrix} \frac{10}{30}  \frac{10}{30}  \frac{10}{30} \end{pmatrix}$。因此，对于这个特定的马尔可夫链，[均匀分布](@entry_id:194597)并非其平稳分布。这说明[平稳分布](@entry_id:194199)是由[转移矩阵](@entry_id:145510) $P$ 的内在结构唯一决定的，不能随意猜测。

### 计算平稳分布

既然[平稳分布](@entry_id:194199)如此重要，我们如何找到它呢？定义本身就提供了计算方法。求解平稳分布的核心就是求解满足 $\pi P = \pi$ 和 $\sum \pi_i = 1$ 的向量 $\pi$。

方程 $\pi P = \pi$ 等价于 $\pi (P - I) = \mathbf{0}$，其中 $I$ 是单位矩阵，$\mathbf{0}$ 是[零向量](@entry_id:156189)。这本质上是一个求解[齐次线性方程组](@entry_id:153432)的问题。对于任何一个[随机矩阵](@entry_id:269622) $P$，$\lambda=1$ 始终是其一个[特征值](@entry_id:154894)，这意味着矩阵 $P-I$ 是奇异的，因此该[方程组](@entry_id:193238)总存在非零解。实际上，这些方程通常是[线性相关](@entry_id:185830)的，我们无法仅凭它们得到唯一解。

为了得到唯一的[概率分布](@entry_id:146404)解，我们必须引入[归一化条件](@entry_id:156486) $\sum \pi_i = 1$。将这个方程与从 $\pi P = \pi$ 导出的（通常是 $k-1$ 个独立的）线性方程联立，我们就可以求解出唯一的[平稳分布](@entry_id:194199) $\pi$（在一定条件下）。

让我们通过一个具体的例子来演示这个过程。考虑一个音乐[推荐系统](@entry_id:172804)模型，它在三种音乐流派（流行、摇滚、爵士）之间切换 [@problem_id:1639054]。其转移矩阵为：
$$
P = \begin{pmatrix} 0.5  0.4  0.1 \\ 0.2  0.6  0.2 \\ 0.1  0.1  0.8 \end{pmatrix}
$$
我们需要找到[平稳分布](@entry_id:194199) $\pi = (\pi_1, \pi_2, \pi_3)$。根据 $\pi = \pi P$，我们写出分量方程：
$$
\begin{cases}
\pi_1 = 0.5\pi_1 + 0.2\pi_2 + 0.1\pi_3 \\
\pi_2 = 0.4\pi_1 + 0.6\pi_2 + 0.1\pi_3 \\
\pi_3 = 0.1\pi_1 + 0.2\pi_2 + 0.8\pi_3
\end{cases}
$$
将这些方程整理后得到（实际上，其中一个方程是冗余的）：
$$
\begin{cases}
0.5\pi_1 - 0.2\pi_2 - 0.1\pi_3 = 0 \\
-0.4\pi_1 + 0.4\pi_2 - 0.1\pi_3 = 0
\end{cases}
$$
结合[归一化条件](@entry_id:156486) $\pi_1 + \pi_2 + \pi_3 = 1$，我们可以解这个[线性方程组](@entry_id:148943)。例如，从前两个方程中消去 $\pi_3$ 可以得到 $\pi_2$ 和 $\pi_1$ 的关系，例如 $\pi_2 = \frac{3}{2}\pi_1$。接着可以表达出 $\pi_3 = 2\pi_1$。最后代入[归一化条件](@entry_id:156486)：
$$
\pi_1 + \frac{3}{2}\pi_1 + 2\pi_1 = 1 \implies \frac{9}{2}\pi_1 = 1 \implies \pi_1 = \frac{2}{9}
$$
由此可得 $\pi_2 = \frac{1}{3}$ 和 $\pi_3 = \frac{4}{9}$。因此，该系统的平稳分布为 $\pi = \begin{pmatrix} \frac{2}{9}  \frac{1}{3}  \frac{4}{9} \end{pmatrix}$。这个向量精确地描述了在长时间运行后，用户收听每种音乐流派的时间比例。

这个计算方法具有普适性，对于更大规模的系统同样适用。例如，在一个四状态的内容推荐模型中 [@problem_id:1660529]，我们同样可以建立一个包含四个变量和[归一化条件](@entry_id:156486)的[线性方程组](@entry_id:148943)来求解平稳分布，从而确定用户在各类内容上花费时间的长期比例。

从线性代数的角度来看，方程 $\pi P = \pi$ 意味着 $\pi$ 是[转移矩阵](@entry_id:145510) $P$ 对应于[特征值](@entry_id:154894) $\lambda=1$ 的一个**左[特征向量](@entry_id:151813)** [@problem_id:1660521]。对于随机矩阵，Perron-Frobenius 定理保证了 $\lambda=1$ 始终是其最大[特征值](@entry_id:154894)，并且在特定条件下，对应的[特征向量](@entry_id:151813)是唯一的（在缩放意义下），这为[平稳分布的存在性](@entry_id:272084)和唯一性提供了坚实的理论基础。

### [平稳分布的存在性](@entry_id:272084)与唯一性

我们已经学会了如何计算平稳分布，但平稳分布是否总是存在？并且是否唯一？答案取决于马尔可夫链的结构特性，主要是**不可约性（irreducibility）**和**周期性（periodicity）**。

**[马尔可夫链](@entry_id:150828)基本定理**给出了一个强有力的结论：对于任何一个状态有限、**不可约**且**非周期**的马尔可夫链，存在一个**唯一**的平稳分布 $\pi$。并且，该[分布](@entry_id:182848)的所有分量 $\pi_i$ 均为正值。

- **不可约性**意味着从任何状态出发，都有可能在有限步内到达任何其他状态。整个系统是“连通”的。
- **非周期性**意味着系统不会被困在确定的循环中。

对于满足这些条件的“行为良好”的[马尔可夫链](@entry_id:150828)，[平稳分布](@entry_id:194199)不仅存在且唯一，它还是系统的**[极限分布](@entry_id:174797)（limiting distribution）**。这意味着，无论系统的初始[分布](@entry_id:182848) $p_0$ 是什么，当时间趋于无穷时，系统在时刻 $n$ 的状态[分布](@entry_id:182848) $p_n = p_0 P^n$ 都会收敛到唯一的[平稳分布](@entry_id:194199) $\pi$。
$$
\lim_{n \to \infty} p_n = \lim_{n \to \infty} p_0 P^n = \pi
$$
一个模拟嘈杂存储单元中单个比特的例子 [@problem_id:1660500] 很好地说明了这种收敛性。我们可以解析地求出其[平稳分布](@entry_id:194199)为 $\pi = \begin{pmatrix} 0.75  0.25 \end{pmatrix}$。同时，我们也可以通过计算转移矩阵的高次幂，如 $P^{100}$，来数值逼近这个结果。当 $n$ 足够大时，$P^n$ 的每一行都会非常接近同一个向量，这个向量就是平稳分布 $\pi$。这表明，经过足够长的时间后，无论该比特最初是0还是1，它处于状态0的概率都将稳定在0.75。

那么，当这些条件不被满足时，情况会如何呢？

**[周期性马尔可夫链](@entry_id:268175)**：如果一个链是不可约但**周期性**的（例如，周期为 $d > 1$），那么唯一的平稳分布 $\pi$ 仍然存在。然而，状态[分布](@entry_id:182848) $p_n$ 可能不会收敛到 $\pi$，而是在多个[分布](@entry_id:182848)之间循环[振荡](@entry_id:267781)。一个极端的例子是，一个比特在每个时间步都确定地从0翻转到1，从1翻转到0 [@problem_id:1660484]。其转移矩阵为 $$P = \begin{pmatrix} 0  1 \\ 1  0 \end{pmatrix}$$。我们很容易求出其平稳分布为 $\pi = \begin{pmatrix} \frac{1}{2}  \frac{1}{2} \end{pmatrix}$。但是，如果系统从状态0开始（[分布](@entry_id:182848)为 $(1, 0)$），后续的状态[分布](@entry_id:182848)将是 $(0, 1), (1, 0), (0, 1), \dots$，永远不会收敛。在这种情况下，$\pi_i$ 的最佳物理解释是系统在长时间运行中，处于状态 $i$ 的**时间占比的平均值**。

**可约[马尔可夫链](@entry_id:150828)**：如果一个链是**可约**的，意味着[状态空间](@entry_id:177074)可以被划分为多个相互隔离的闭合子集。一旦系统进入某个闭合子集，就再也无法离开。在这种情况下，[平稳分布](@entry_id:194199)仍然存在，但**不再唯一**。
一个具有两个独立工作模块的CPU模型 [@problem_id:1660549] 清晰地揭示了这一点。其转移矩阵是块对角的，将状态集 {S1, S2} 和 {S3, S4} 分隔开来。求解[平稳分布](@entry_id:194199)的方程也因此解耦，导致存在无穷多个解，形成一个解的族。最终系统会达到哪一个[平稳分布](@entry_id:194199)，取决于其落入每个闭合子集的初始概率。

关于[可约链](@entry_id:200553)的平稳分布，有一个普遍的结论 [@problem_id:1660496]：如果一个[马尔可夫链](@entry_id:150828)由多个独立的不可约部分组成（例如，社交网络中两个互不往来的社群），那么该链的任意一个[平稳分布](@entry_id:194199)都是其各个组成部分平稳分布的**[凸组合](@entry_id:635830)（convex combination）**。若 $\pi_A'$ 和 $\pi_B'$ 分别是社群A和社群B在其全集上的“填充”平稳分布，那么整个网络的所有[平稳分布](@entry_id:194199)的集合可以表示为 $\{ \alpha \pi_A' + (1-\alpha) \pi_B' \mid \alpha \in [0, 1] \}$。这里的系数 $\alpha$ 代表了系统最终停留在社群A中的总概率。

### [细致平衡条件](@entry_id:265158)

在许多物理和化学系统中，均衡[状态表](@entry_id:178995)现出一种比平稳更强的对称性，这被**[细致平衡条件](@entry_id:265158)（detailed balance condition）**所刻画。

该条件表述为：对于所有状态对 $(i, j)$，均满足
$$
\pi_i P_{ij} = \pi_j P_{ji}
$$
其直观物理解释是：在均衡状态下，从状态 $i$ 转移到状态 $j$ 的“[概率流](@entry_id:150949)”恰好等于从状态 $j$ 反向转移到状态 $i$ 的“[概率流](@entry_id:150949)”。

如果一个[分布](@entry_id:182848) $\pi$ 满足[细致平衡条件](@entry_id:265158)，那么它必然是一个平稳分布。我们可以通过对所有状态 $j$ 求和来证明这一点：
$$
\sum_{j} \pi_i P_{ij} = \sum_{j} \pi_j P_{ji}
$$
方程左边是 $\pi_i \sum_{j} P_{ij} = \pi_i \cdot 1 = \pi_i$。方程右边根据定义恰好是向量 $\pi P$ 的第 $i$ 个分量。因此，我们得到 $\pi_i = (\pi P)_i$，这正是[平稳分布](@entry_id:194199)的定义。

满足[细致平衡条件](@entry_id:265158)的[马尔可夫链](@entry_id:150828)被称为**[可逆马尔可夫链](@entry_id:198392)（reversible Markov chain）**。这是一个非常重要的性质，在统计物理中的玻尔兹曼分布以及[马尔可夫链蒙特卡洛](@entry_id:138779)（MCMC）等现代计算算法中扮演着核心角色。

值得注意的是，[细致平衡](@entry_id:145988)是一个**充分条件**，但非必要条件。也就是说，一个[马尔可夫链](@entry_id:150828)可以拥有[平稳分布](@entry_id:194199)但却不可逆。

一个CPU在“空闲”和“繁忙”状态间切换的模型 [@problem_id:1660489] 提供了一个检验此条件的机会。对于一个提议的[分布](@entry_id:182848) $\pi = (0.7, 0.3)$ 和给定的[转移矩阵](@entry_id:145510) $P$，我们检验[细致平衡](@entry_id:145988)：
- 从状态1到2的流：$\pi_1 P_{12} = 0.7 \times 0.1 = 0.07$
- 从状态2到1的流：$\pi_2 P_{21} = 0.3 \times 0.4 = 0.12$
因为 $0.07 \neq 0.12$，[细致平衡条件](@entry_id:265158)不满足。在这个例子中，进一步的计算表明该[分布](@entry_id:182848)也不是[平稳分布](@entry_id:194199)。对于二状态马尔可夫链，[细致平衡条件](@entry_id:265158)和平稳条件实际上是等价的。这表明，[细致平衡条件](@entry_id:265158)在某些情况下可以作为判断一个[分布](@entry_id:182848)是否平稳的便捷工具。

总而言之，[平稳分布](@entry_id:194199)是[马尔可夫链](@entry_id:150828)理论的基石。通过求解线性方程组 $\pi P = \pi$，我们可以计算出这个描述系统长期行为的[概率分布](@entry_id:146404)。其存在性和唯一性由链的不可约性和[非周期性](@entry_id:275873)保证。对于满足这些条件的链，[平稳分布](@entry_id:194199)是系统不依赖于初始状态的最终归宿；对于其他类型的链，它则代表了时间平均的占用率。而[细致平衡条件](@entry_id:265158)则为我们提供了一个更深刻的视角来理解一类重要的[可逆系统](@entry_id:269797)。