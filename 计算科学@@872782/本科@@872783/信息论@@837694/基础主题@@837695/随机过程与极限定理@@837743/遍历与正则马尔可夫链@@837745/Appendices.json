{"hands_on_practices": [{"introduction": "马尔可夫链最重要的应用之一是分析系统的长期行为。对于遍历马尔可夫链，系统最终会达到一个稳定的状态，即平稳分布。这个练习将指导你完成计算一个简单二状态系统的平稳分布的核心过程，这是一个基础且至关重要的技能，适用于从物理学到经济学的众多领域 [@problem_id:1621829]。", "problem": "一个用于计算机中央处理器（CPU）电源管理的简化模型，在离散的时间间隔上描述其状态。CPU可以处于两种状态之一：状态1（活动）或状态2（低功耗）。这些状态之间的转移被建模为马尔可夫链。\nCPU从一个时间步到下一个时间步保持在活动状态的概率为 $p_{11} = 0.75$。\nCPU从一个时间步到下一个时间步保持在低功耗状态的概率为 $p_{22} = 0.5$。\n如果系统没有保持在当前状态，它必须转移到另一个状态。\n假设该系统运行很长时间，它将趋近于一个稳态，在该稳态下，处于任一状态的概率变得恒定。这种稳态概率分布被称为平稳分布。\n计算平稳分布向量 $\\pi = (\\pi_1, \\pi_2)$，其中 $\\pi_1$ 是长期来看CPU处于活动状态的概率，而 $\\pi_2$ 是长期来看CPU处于低功耗状态的概率。\n将平稳分布向量的分量表示为精确分数。", "solution": "设两个状态为状态1（活动）和状态2（低功耗）。问题给出了保持在给定状态的概率。我们可以利用这些信息构建一步转移概率矩阵 $P$。矩阵 $P$ 是一个 $2 \\times 2$ 矩阵，其中元素 $P_{ij}$ 是从状态 $i$ 转移到状态 $j$ 的概率。\n\n保持在活动状态（状态1）的概率为 $p_{11} = 0.75$。由于转移矩阵中任何一行的概率之和必须为1，从活动状态转移到低功耗状态（状态2）的概率为 $p_{12} = 1 - p_{11} = 1 - 0.75 = 0.25$。\n\n保持在低功耗状态（状态2）的概率为 $p_{22} = 0.5$。因此，从低功耗状态转移到活动状态（状态1）的概率为 $p_{21} = 1 - p_{22} = 1 - 0.5 = 0.5$。\n\n有了这些概率，转移矩阵 $P$ 为：\n$$\nP = \\begin{pmatrix} 0.75 & 0.25 \\\\ 0.5 & 0.5 \\end{pmatrix}\n$$\n\n平稳分布是一个概率向量 $\\pi = (\\pi_1, \\pi_2)$，它满足两个条件：\n1. $\\pi P = \\pi$\n2. $\\pi_1 + \\pi_2 = 1$ (概率之和必须为1)\n\n让我们使用第一个条件，$\\pi P = \\pi$：\n$$\n(\\pi_1, \\pi_2) \\begin{pmatrix} 0.75 & 0.25 \\\\ 0.5 & 0.5 \\end{pmatrix} = (\\pi_1, \\pi_2)\n$$\n\n这个矩阵方程给了我们一个由两个线性方程组成的方程组：\n(i) $0.75 \\pi_1 + 0.5 \\pi_2 = \\pi_1$\n(ii) $0.25 \\pi_1 + 0.5 \\pi_2 = \\pi_2$\n\n让我们简化第一个方程 (i)：\n$$\n0.5 \\pi_2 = \\pi_1 - 0.75 \\pi_1\n$$\n$$\n0.5 \\pi_2 = 0.25 \\pi_1\n$$\n两边同乘以4以去掉小数，我们得到：\n$$\n2 \\pi_2 = \\pi_1\n$$\n\n第二个方程 (ii) 是冗余的，因为它会得出相同的关系。让我们验证一下：\n$$\n0.25 \\pi_1 = \\pi_2 - 0.5 \\pi_2\n$$\n$$\n0.25 \\pi_1 = 0.5 \\pi_2\n$$\n乘以4得到：\n$$\n\\pi_1 = 2 \\pi_2\n$$\n正如预期的，两个方程是等价的。\n\n现在我们使用第二个条件，即归一化方程：\n$$\n\\pi_1 + \\pi_2 = 1\n$$\n将关系式 $\\pi_1 = 2 \\pi_2$ 代入归一化方程：\n$$\n(2 \\pi_2) + \\pi_2 = 1\n$$\n$$\n3 \\pi_2 = 1\n$$\n$$\n\\pi_2 = \\frac{1}{3}\n$$\n\n现在我们可以用关系式 $\\pi_1 = 2 \\pi_2$ 来求 $\\pi_1$：\n$$\n\\pi_1 = 2 \\left( \\frac{1}{3} \\right) = \\frac{2}{3}\n$$\n\n因此，平稳分布向量是 $\\pi = (\\pi_1, \\pi_2) = (\\frac{2}{3}, \\frac{1}{3})$。这意味着，从长期来看，CPU将有大约 $66.7\\%$ 的时间处于活动状态，有大约 $33.3\\%$ 的时间处于低功耗状态。问题要求将分量表示为精确分数。\n平稳分布是 $(\\frac{2}{3}, \\frac{1}{3})$。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{2}{3} & \\frac{1}{3} \\end{pmatrix}}$$", "id": "1621829"}, {"introduction": "在掌握了计算平稳分布的方法之后，理解保证这种长期稳定性存在的条件变得至关重要。并非所有的马尔可夫链都具有遍历性，这个练习 [@problem_id:1621848] 旨在深化你对不可约性、周期性和遍历性这些关键概念的理解。通过分析一个具体的例子，你将学会如何根据一个链的结构特性对其进行分类，这是正确预测其动态行为的关键一步。", "problem": "一个网络数据路由器缓冲区的简化模型可以用一个离散时间马尔可夫链来描述，该链有三个状态：$S_1$ (空)、$S_2$ (半满) 和 $S_3$ (满)。在每个时间步结束时观察路由器的状态。状态之间的转移遵循以下规则：\n\n1.  如果在时间步开始时缓冲区为空 ($S_1$)，则必定会有一个数据包到达，导致缓冲区在时间步结束时变为半满 ($S_2$)。\n2.  如果缓冲区为半满 ($S_2$)，有 50% 的概率会有一个新数据包到达，使其变为满 ($S_3$)，也有 50% 的概率会有一个数据包被处理并发送，使其变为空 ($S_1$)。这是仅有的两种可能性。\n3.  如果缓冲区为满 ($S_3$)，路由器会优先发送一个数据包。它必定会处理并发送一个数据包，导致缓冲区在时间步结束时变为半满 ($S_2$)。\n\n基于这个模型，应如何对所得到的马尔可夫链进行分类？\n\nA. 该链是正则的。\n\nB. 该链是遍历的但不是正则的。\n\nC. 该链是不可约的但不是遍历的。\n\nD. 该链不是不可约的。\n\nE. 该链至少有一个吸收态。", "solution": "设状态排序为 $(S_{1},S_{2},S_{3})$。根据规则：\n- 从 $S_{1}$ 出发，下一状态以概率 $1$ 为 $S_{2}$。\n- 从 $S_{2}$ 出发，下一状态以概率 $\\frac{1}{2}$ 为 $S_{1}$，以概率 $\\frac{1}{2}$ 为 $S_{3}$。\n- 从 $S_{3}$ 出发，下一状态以概率 $1$ 为 $S_{2}$。\n\n因此，一步转移矩阵为\n$$\nP=\\begin{pmatrix}\n0 & 1 & 0\\\\\n\\frac{1}{2} & 0 & \\frac{1}{2}\\\\\n0 & 1 & 0\n\\end{pmatrix}.\n$$\n\n不可约性：如果一个有限状态马尔可夫链中的每个状态都与其他所有状态互通，则该链是不可约的。从 $S_{1}$ 出发，一步可达 $S_{2}$，通过 $S_{2}$ 两步可达 $S_{3}$。从 $S_{3}$ 出发，一步可达 $S_{2}$，通过 $S_{2}$ 两步可达 $S_{1}$。从 $S_{2}$ 出发，一步可达 $S_{1}$ 或 $S_{3}$。因此，每对状态都互通，所以该链是不可约的。\n\n周期性：状态 $i$ 的周期是 $d(i)=\\gcd\\{n\\ge 1: (P^{n})_{ii}>0\\}$。考虑状态 $S_{2}$。我们有 $(P^{1})_{22}=0$，而 $(P^{2})_{22}>0$ 是因为路径 $S_{2}\\to S_{1}\\to S_{2}$ 的发生概率为 $\\frac{1}{2}\\cdot 1>0$。并且 $(P^{3})_{22}=0$，因为任何从 $S_{2}$ 出发的长度为 $3$ 的路径必须在第 $1$ 步离开 $S_{2}$，在第 $2$ 步返回，然后在第 $3$ 步再次离开，所以它不可能在 $S_{2}$ 结束。更一般地，返回到 $S_{2}$ 只在偶数时间步发生，所以 $\\{n\\ge 1:(P^{n})_{22}>0\\}=\\{2,4,6,\\dots\\}$ 且 $d(S_{2})=2$。在一个不可约链中，所有状态共享相同的周期，因此每个状态的周期都是 $2$。因此，该链是周期的（不是非周期的）。\n\n这对选项的影响如下：\n- 因为对所有 $i$ 都有 $(P)_{ii}\\neq 1$，所以不存在吸收态。因此选项 E 是错误的。\n- 该链是不可约的（所以选项 D 是错误的），但它是周期为 $2$ 的周期链，因此在标准定义（不可约且非周期）下它不是遍历的。因此选项 B 是错误的。\n- 一个正则链（或称本原链）要求存在某个幂次 $P^{n}$，其所有元素都严格为正；对于像这样一个周期性的二分链，这个条件不成立，所以选项 A 是错误的。\n- 因此，正确的分类是该链不可约但不是遍历的。\n\n因此，正确选项是 C。", "answer": "$$\\boxed{C}$$", "id": "1621848"}, {"introduction": "现实世界中的许多过程的“记忆”不止一步，其未来状态取决于过去多个时刻的状态。这个练习 [@problem_id:1621836] 介绍了一种强大的建模技术：将高阶马尔可夫过程转换为等价的一阶马尔可夫链，从而使其能够被我们已有的工具分析。通过确定保证遍历性的参数条件，你将学会在更复杂的模型中应用核心概念，这是从理论走向实际应用的重要一步。", "problem": "一个二元记忆-2信源生成一个比特序列 $X_1, X_2, X_3, \\dots$，其中每个比特 $X_n$ 是 0 或 1。该过程是一个二阶马尔可夫过程，意味着下一个比特的概率取决于前两个比特：$P(X_n | X_{n-1}, X_{n-2}, \\dots, X_1) = P(X_n | X_{n-1}, X_{n-2})$。\n\n转移概率由两个参数 $\\alpha$ 和 $\\beta$ 定义，它们是范围在 $[0, 1]$ 内的实数。生成 '1' 的概率如下所示：\n\n- $P(X_n=1 | X_{n-1}=1, X_{n-2}=1) = 1 - \\alpha$\n- $P(X_n=1 | X_{n-1}=0, X_{n-2}=0) = \\beta$\n- $P(X_n=1 | X_{n-1}=1, X_{n-2}=0) = 1/2$\n- $P(X_n=1 | X_{n-1}=0, X_{n-2}=1) = 1/2$\n\n通过定义一组新状态，这个二阶过程可以转换为等价的一阶马尔可夫链。请确定参数 $\\alpha$ 和 $\\beta$ 需要满足的全部条件，以确保这个等价的一阶马尔可夫链是遍历的。\n\n从以下选项中选择唯一有效的选项。\n\nA. $0 < \\alpha < 1$ 且 $0 < \\beta < 1$\n\nB. $0 \\le \\alpha \\le 1$ 且 $0 \\le \\beta \\le 1$\n\nC. $0 < \\alpha \\le 1$ 且 $0 < \\beta \\le 1$\n\nD. $0 < \\alpha < 1$ 且 $0 < \\beta \\le 1$\n\nE. $\\alpha + \\beta > 0$ 且 $\\alpha + \\beta < 2$", "solution": "要解决这个问题，我们首先需要将给定的二阶马尔可夫过程转换为等价的一阶马尔可夫链。然后，我们必须找到使该链遍历的 $\\alpha$ 和 $\\beta$ 的条件。一个有限状态马尔可夫链如果既是不可约的又是无周期的，则它是遍历的。\n\n**步骤 1：定义一阶链的状态空间**\n\n一个二阶过程 $P(X_n | X_{n-1}, X_{n-2})$ 可以通过将时间 $n$ 的状态定义为最后两个结果的配对，来建模成一个一阶过程。设新链在时间 $n$ 的状态为 $Y_n = (X_{n-1}, X_n)$。这个新链的状态空间 $S$ 由所有可能的连续比特对组成：\n$$ S = \\{(0,0), (0,1), (1,0), (1,1)\\} $$\n为了清晰起见，我们将这些状态标记为：$S_{00} = (0,0)$，$S_{01} = (0,1)$，$S_{10} = (1,0)$ 和 $S_{11} = (1,1)$。\n\n**步骤 2：构建转移矩阵**\n\n从状态 $Y_{n-1}=(X_{n-2}, X_{n-1})$ 到状态 $Y_n=(X_{n-1}, X_n)$ 的转移概率仅在起始状态的第二个元素与目标状态的第一个元素匹配时才非零。转移概率由 $P(Y_n | Y_{n-1}) = P(X_n | X_{n-1}, X_{n-2})$ 给出。\n\n让我们计算转移矩阵 $T$ 的条目，其中 $T_{ij}$ 是从状态 $i$ 转移到状态 $j$ 的概率。我们按 $S_{00}, S_{01}, S_{10}, S_{11}$ 的顺序排列状态。\n\n- **从 $S_{00}=(0,0)$ 出发：** 此处，$X_{n-2}=0, X_{n-1}=0$。下一个状态是 $(X_{n-1}, X_n)=(0, X_n)$。\n    - 到 $S_{00}=(0,0)$：$P(X_n=0|X_{n-1}=0, X_{n-2}=0) = 1 - P(X_n=1|X_{n-1}=0, X_{n-2}=0) = 1-\\beta$。\n    - 到 $S_{01}=(0,1)$：$P(X_n=1|X_{n-1}=0, X_{n-2}=0) = \\beta$。\n- **从 $S_{01}=(0,1)$ 出发：** 此处，$X_{n-2}=0, X_{n-1}=1$。下一个状态是 $(X_{n-1}, X_n)=(1, X_n)$。\n    - 到 $S_{10}=(1,0)$：$P(X_n=0|X_{n-1}=1, X_{n-2}=0) = 1 - P(X_n=1|X_{n-1}=1, X_{n-2}=0) = 1 - 1/2 = 1/2$。\n    - 到 $S_{11}=(1,1)$：$P(X_n=1|X_{n-1}=1, X_{n-2}=0) = 1/2$。\n- **从 $S_{10}=(1,0)$ 出发：** 此处，$X_{n-2}=1, X_{n-1}=0$。下一个状态是 $(X_{n-1}, X_n)=(0, X_n)$。\n    - 到 $S_{00}=(0,0)$：$P(X_n=0|X_{n-1}=0, X_{n-2}=1) = 1 - P(X_n=1|X_{n-1}=0, X_{n-2}=1) = 1 - 1/2 = 1/2$。\n    - 到 $S_{01}=(0,1)$：$P(X_n=1|X_{n-1}=0, X_{n-2}=1) = 1/2$。\n- **从 $S_{11}=(1,1)$ 出发：** 此处，$X_{n-2}=1, X_{n-1}=1$。下一个状态是 $(X_{n-1}, X_n)=(1, X_n)$。\n    - 到 $S_{10}=(1,0)$：$P(X_n=0|X_{n-1}=1, X_{n-2}=1) = \\alpha$。\n    - 到 $S_{11}=(1,1)$：$P(X_n=1|X_{n-1}=1, X_{n-2}=1) = 1-\\alpha$。\n\n转移矩阵 $T$ 是：\n$$ T = \\begin{pmatrix}\n1-\\beta & \\beta & 0 & 0 \\\\\n0 & 0 & 1/2 & 1/2 \\\\\n1/2 & 1/2 & 0 & 0 \\\\\n0 & 0 & \\alpha & 1-\\alpha\n\\end{pmatrix} $$\n\n**步骤 3：分析不可约性**\n\n如果每个状态都可以从其他任何状态到达，则马尔可夫链是不可约的。这等价于状态转移图是强连通的。\n让我们分析图中的路径：\n- $S_{00} \\to S_{01}$ 要求 $\\beta > 0$。\n- $S_{01} \\to S_{10}$ 和 $S_{01} \\to S_{11}$ 总是可能的。\n- $S_{10} \\to S_{00}$ 和 $S_{10} \\to S_{01}$ 总是可能的。\n- $S_{11} \\to S_{10}$ 要求 $\\alpha > 0$。\n\n为了使图是强连通的，我们必须能够形成包含所有状态的环路。\n- 考虑从“0-簇”($S_{00}, S_{01}$) 到“1-簇”($S_{10}, S_{11}$) 的路径。从 $S_{01}$，我们总是可以到达 $S_{10}$ 和 $S_{11}$。所以我们需要能够从 $S_{00}$ 到达 $S_{01}$。这需要一个转移 $S_{00} \\to S_{01}$，其概率为 $\\beta$。因此，我们需要 $\\beta > 0$。如果 $\\beta=0$，$T_{00,00}=1$，并且 $S_{00}$ 成为一个吸收态。任何可以到达 $S_{00}$ 的状态（例如 $S_{10}$）都会导致一个非不可约链。\n\n- 考虑从“1-簇”到“0-簇”的路径。从 $S_{10}$，我们总是可以到达 $S_{00}$ 和 $S_{01}$。所以我们需要能够从 $S_{11}$ 到达 $S_{10}$。这需要一个转移 $S_{11} \\to S_{10}$，其概率为 $\\alpha$。因此，我们需要 $\\alpha > 0$。如果 $\\alpha=0$，$T_{11,11}=1$，并且 $S_{11}$ 成为一个吸收态。任何可以到达 $S_{11}$ 的状态（例如 $S_{01}$）都会导致一个非不可约链。\n\n因此，为了使链不可约，我们必须有 $\\alpha > 0$ 和 $\\beta > 0$。由于 $\\alpha$ 和 $\\beta$ 是概率，它们不可约性的完整范围是 $0 < \\alpha \\le 1$ 和 $0 < \\beta \\le 1$。\n\n**步骤 4：分析无周期性**\n\n如果任何返回到某个状态的步数都必须是 $d$ 的倍数，并且 $d$ 是满足此条件的最大整数，则该状态的周期为 $d$。如果一个链的所有状态的周期都为 1，则该链是无周期的。对于一个不可约链，所有状态具有相同的周期。\n\n对于不可约链，无周期性的一个充分条件是至少存在一个带有自环的状态（即转移到自身的概率非零）。\n- 状态 $S_{00}$ 有一个自环，如果 $T_{00,00} = 1-\\beta > 0$，即 $\\beta < 1$。\n- 状态 $S_{11}$ 有一个自环，如果 $T_{11,11} = 1-\\alpha > 0$，即 $\\alpha < 1$。\n\n如果满足不可约性条件（$0 < \\alpha \\le 1, 0 < \\beta \\le 1$），并且 $\\alpha < 1$ 或 $\\beta < 1$ 之一成立，则至少存在一个自环，该链是无周期的。\n\n我们只需要检查没有自环的特殊情况，这种情况发生在 $\\alpha=1$ 和 $\\beta=1$ 时。在这种情况下，转移矩阵是：\n$$ T = \\begin{pmatrix}\n0 & 1 & 0 & 0 \\\\\n0 & 0 & 1/2 & 1/2 \\\\\n1/2 & 1/2 & 0 & 0 \\\\\n0 & 0 & 1 & 0\n\\end{pmatrix} $$\n对于这些值，链仍然是不可约的。为了检查无周期性，我们找到状态图中所有可能的闭环（圈）长度的最大公约数 (GCD)。\n- 环 1：$S_{10} \\to S_{01} \\to S_{10}$。这个环的长度是 2。\n- 环 2：$S_{00} \\to S_{01} \\to S_{10} \\to S_{00}$。这个环的长度是 3。\n\n由于在单个通信类中存在长度为 2 和 3 的环，所有环长度的 GCD 是 $\\text{gcd}(2, 3) = 1$。因此，即使当 $\\alpha=1$ 和 $\\beta=1$ 时，该链也是无周期的。\n\n**步骤 5：结论**\n\n对于所有使链不可约的 $\\alpha$ 和 $\\beta$ 值，该链都是无周期的。\n因此，遍历性的条件与不可约性的条件相同。\n不可约性的条件是 $0 < \\alpha \\le 1$ 和 $0 < \\beta \\le 1$。\n\n将此结果与给定选项进行比较：\nA. $0 < \\alpha < 1$ 且 $0 < \\beta < 1$：不正确，因为它排除了边界情况 $\\alpha=1$ 或 $\\beta=1$。\nB. $0 \\le \\alpha \\le 1$ 且 $0 \\le \\beta \\le 1$：不正确，因为它包括了链是可约的情况（$\\alpha=0$ 或 $\\beta=0$）。\nC. $0 < \\alpha \\le 1$ 且 $0 < \\beta \\le 1$：正确。这涵盖了链是不可约和无周期的所有情况。\nD. $0 < \\alpha < 1$ 且 $0 < \\beta \\le 1$：不正确，因为它排除了情况 $\\alpha=1$。\nE. $\\alpha + \\beta > 0$ 且 $\\alpha + \\beta < 2$：不正确。例如，$\\alpha=1.5, \\beta=0.1$ 满足该条件但不是有效概率。即使在 $[0,1]$ 范围内，$\\alpha=0.1, \\beta=0$ 也不满足条件。\n\n因此，正确选项是 C。", "answer": "$$\\boxed{C}$$", "id": "1621836"}]}