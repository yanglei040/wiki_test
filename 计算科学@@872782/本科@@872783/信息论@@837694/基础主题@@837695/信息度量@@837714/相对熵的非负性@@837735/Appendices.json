{"hands_on_practices": [{"introduction": "相对熵，也称为KL散度，为我们量化使用简化模型（$Q$）替代真实数据分布（$P$）时所产生的信息损失提供了一种严谨的方法。这个练习将通过一个简单的二元系统场景，让你亲手计算模型散度，从而直观地理解当我们的假设与现实不符时，KL散度是如何衡量这种差异的 [@problem_id:1643625]。", "problem": "一位工程师的任务是分析一种新的半导体制造工艺。该工艺生产的每个芯片可分为两种状态之一：'operational'（正常工作）或 'defective'（有缺陷）。在没有初始数据的情况下，提出了一个简化模型，该模型假设任何给定的芯片是正常工作或有缺陷的概率相等。\n\n在一次试生产后，详细分析表明芯片“正常工作”的真实概率为 $p$。为了量化简化模型与观测现实之间的差异，计算了一个“模型散度”指标 $D$。该指标由以下公式定义：\n\n$$D = \\sum_{s \\in S} P(s) \\ln\\left(\\frac{P(s)}{Q(s)}\\right)$$\n\n其中 $S = \\{\\text{operational, defective}\\}$ 是芯片所有可能状态的集合，$P(s)$ 是从试生产中确定的状态的真实概率分布，而 $Q(s)$ 是简化模型所假设的概率分布。\n\n给定芯片正常工作的真实概率为 $p = 0.90$，计算模型散度指标 $D$ 的值。将您的答案报告为一个四舍五入到三位有效数字的实数。", "solution": "我们给定一个二元状态空间 $S=\\{\\text{operational},\\text{defective}\\}$，其真实分布为 $P$，模型分布为 $Q$。模型假设 $Q(\\text{operational})=Q(\\text{defective})=\\frac{1}{2}$。从试生产得到的真实分布为 $P(\\text{operational})=p$ 和 $P(\\text{defective})=1-p$，其中 $p=0.90$。\n\n模型散度是 Kullback–Leibler 散度\n$$\nD=\\sum_{s\\in S}P(s)\\ln\\!\\left(\\frac{P(s)}{Q(s)}\\right).\n$$\n代入两种状态及其概率，\n$$\nD=p\\ln\\!\\left(\\frac{p}{\\frac{1}{2}}\\right)+(1-p)\\ln\\!\\left(\\frac{1-p}{\\frac{1}{2}}\\right)\n=p\\ln(2p)+(1-p)\\ln\\!\\bigl(2(1-p)\\bigr).\n$$\n当 $p=0.90$ 时，我们得到\n$$\nD=0.90\\,\\ln(1.8)+0.10\\,\\ln(0.2).\n$$\n使用 $\\ln(1.8)\\approx 0.5877866649$ 和 $\\ln(0.2)=-\\ln(5)\\approx -1.6094379124$ 进行计算，\n$$\n0.90\\,\\ln(1.8)\\approx 0.90\\times 0.5877866649\\approx 0.5290079984,\n$$\n$$\n0.10\\,\\ln(0.2)\\approx 0.10\\times(-1.6094379124)\\approx -0.1609437912.\n$$\n因此，\n$$\nD\\approx 0.5290079984-0.1609437912=0.3680642072.\n$$\n四舍五入到三位有效数字，得到 $D\\approx 0.368$。", "answer": "$$\\boxed{0.368}$$", "id": "1643625"}, {"introduction": "在熟悉了KL散度的基本计算后，探索其核心性质至关重要。一个常见的误解是将其视为像欧氏距离那样的对称“距离”度量。通过计算$D_{KL}(P||Q)$和$D_{KL}(Q||P)$，本练习将清晰地揭示相对熵的非对称性（即$D_{KL}(P||Q) \\neq D_{KL}(Q||P)$），这对于准确理解它在比较两个概率分布时的含义至关重要 [@problem_id:1643606]。", "problem": "在信息论中，Kullback-Leibler (KL) 散度，或称相对熵，是衡量一个概率分布与另一个参考概率分布差异的度量。\n\n考虑一个离散随机变量，它可以取三种可能的结果之一，我们将其标记为 $\\{O_1, O_2, O_3\\}$。现已提出两种不同的概率模型，模型 $P$ 和模型 $Q$，来描述这些结果的可能性。\n\n模型 $P$ 由概率分布 $P(O_1) = \\frac{1}{2}$，$P(O_2) = \\frac{1}{4}$ 和 $P(O_3) = \\frac{1}{4}$ 描述。\n模型 $Q$ 假设所有三种结果都是等可能的；也就是说，它是在结果集上的一个均匀分布。\n\n您的任务是计算 $P$ 相对于 $Q$ 的 KL 散度，记为 $D_{KL}(P||Q)$，以及 $Q$ 相对于 $P$ 的 KL 散度，记为 $D_{KL}(Q||P)$。请以有序数值对 $(D_{KL}(P||Q), D_{KL}(Q||P))$ 的形式提供您的结果。\n\n请用精确的解析表达式以奈特（nats）为单位表示您的答案，这对应于使用自然对数（$\\ln$）。", "solution": "我们有三个结果 $\\{O_{1},O_{2},O_{3}\\}$，模型 $P$ 由 $P(O_{1})=\\frac{1}{2}$，$P(O_{2})=\\frac{1}{4}$，$P(O_{3})=\\frac{1}{4}$ 给出，模型 $Q$ 是均匀分布，因此对于 $i\\in\\{1,2,3\\}$ 有 $Q(O_{i})=\\frac{1}{3}$。\n\n根据定义，$P$ 相对于 $Q$ 的 Kullback-Leibler 散度为\n$$\nD_{KL}(P\\|Q)=\\sum_{i=1}^{3}P(O_{i})\\ln\\!\\left(\\frac{P(O_{i})}{Q(O_{i})}\\right).\n$$\n代入概率值，\n$$\nD_{KL}(P\\|Q)=\\frac{1}{2}\\ln\\!\\left(\\frac{\\frac{1}{2}}{\\frac{1}{3}}\\right)+\\frac{1}{4}\\ln\\!\\left(\\frac{\\frac{1}{4}}{\\frac{1}{3}}\\right)+\\frac{1}{4}\\ln\\!\\left(\\frac{\\frac{1}{4}}{\\frac{1}{3}}\\right)\n=\\frac{1}{2}\\ln\\!\\left(\\frac{3}{2}\\right)+\\frac{1}{2}\\ln\\!\\left(\\frac{3}{4}\\right)\n=\\frac{1}{2}\\ln\\!\\left(\\frac{9}{8}\\right).\n$$\n\n类似地，$Q$ 相对于 $P$ 的 Kullback-Leibler 散度为\n$$\nD_{KL}(Q\\|P)=\\sum_{i=1}^{3}Q(O_{i})\\ln\\!\\left(\\frac{Q(O_{i})}{P(O_{i})}\\right),\n$$\n得到\n$$\nD_{KL}(Q\\|P)=\\frac{1}{3}\\ln\\!\\left(\\frac{\\frac{1}{3}}{\\frac{1}{2}}\\right)+\\frac{1}{3}\\ln\\!\\left(\\frac{\\frac{1}{3}}{\\frac{1}{4}}\\right)+\\frac{1}{3}\\ln\\!\\left(\\frac{\\frac{1}{3}}{\\frac{1}{4}}\\right)\n=\\frac{1}{3}\\ln\\!\\left(\\frac{2}{3}\\right)+\\frac{2}{3}\\ln\\!\\left(\\frac{4}{3}\\right)\n=\\frac{1}{3}\\ln\\!\\left(\\frac{32}{27}\\right).\n$$\n\n因此，有序对 $(D_{KL}(P\\|Q), D_{KL}(Q\\|P))$ 是 $\\left(\\frac{1}{2}\\ln\\left(\\frac{9}{8}\\right), \\frac{1}{3}\\ln\\left(\\frac{32}{27}\\right)\\right)$ 奈特。", "answer": "$$\\boxed{\\begin{pmatrix}\\frac{1}{2}\\ln\\left(\\frac{9}{8}\\right)  \\frac{1}{3}\\ln\\left(\\frac{32}{27}\\right)\\end{pmatrix}}$$", "id": "1643606"}, {"introduction": "此练习将相对熵的应用从简单的度量推向了参数优化的领域。我们将探讨如何利用KL散度的非负性（即$D_{KL}(P||Q) \\ge 0$）来寻找最优模型参数。这个问题展示了通过最小化真实分布与模型分布之间的平均散度，我们可以精确地确定最佳模型，这正是机器学习和统计推断中的一个核心思想 [@problem_id:1643617]。", "problem": "一位工程师正在为一个数字通信信道设计一个简化模型。信道的输入是一个二元随机变量 $X \\in \\{0, 1\\}$，其先验概率分布已知为 $p(X=1) = p$ 和 $p(X=0) = 1-p$，其中 $0  p  1$。\n\n信道的真实物理行为由一个条件概率密度函数 $p(y|x)$ 描述，其中 $y$ 是连续的输出信号。对于给定的输入 $x$，输出 $y$ 服从高斯分布，其均值取决于输入比特，方差为常数 $\\sigma^2$。具体来说，真实的信道由下式给出：\n$$p(y|x) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(y - \\mu_x)^2}{2\\sigma^2}\\right)$$\n其中均值 $\\mu_x$ 对于输入 $x=1$ 和 $x=0$ 分别为 $\\mu_0$ 和 $-\\mu_0$。这里，$\\mu_0$ 是一个已知的正常数。\n\n工程师的简化模型 $q(y|x)$ 也被假设为高斯分布，具有相同的方差 $\\sigma^2$，但其均值的模型参数为 $\\nu_1$ 和 $\\nu_0$。\n$$q(y|x) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(y - \\nu_x)^2}{2\\sigma^2}\\right)$$\n为了找到最佳拟合模型，工程师决定最小化真实信道与模型之间的平均信息损失。该损失通过 $p(y|x)$ 和 $q(y|x)$ 之间的期望 Kullback-Leibler (KL) 散度来量化，其中期望是针对输入 $X$ 的分布计算的。需要最小化的目标函数是：\n$$L(\\nu_0, \\nu_1) = \\mathbb{E}_{p(x)}[D_{KL}(p(y|x) || q(y|x))]$$\n确定能最小化此平均散度的最优模型参数 $\\nu_0$ 和 $\\nu_1$ 的表达式。最终答案应为一组用 $\\mu_0$、$p$ 和 $\\sigma$ 表示的 $\\nu_0$ 和 $\\nu_1$ 的表达式。", "solution": "给定一个二元输入 $X \\in \\{0,1\\}$，其分布为 $p(X=1)=p$ 和 $p(X=0)=1-p$，以及一个真实的条件密度 $p(y|x)$，它是一个方差为 $\\sigma^{2}$、均值为 $\\mu_{x}$ 的高斯分布。模型 $q(y|x)$ 也是一个方差为 $\\sigma^{2}$、均值为 $\\nu_{x}$ 的高斯分布。需要最小化的平均损失是期望 Kullback-Leibler 散度\n$$\nL(\\nu_{0},\\nu_{1})=\\mathbb{E}_{p(x)}\\left[D_{KL}\\left(p(y|x)\\,\\|\\,q(y|x)\\right)\\right].\n$$\n对于固定的 $x$，两个方差相同（均为 $\\sigma^{2}$）但均值分别为 $\\mu_{x}$ 和 $\\nu_{x}$ 的一元高斯分布之间的 KL 散度可以直接根据定义计算：\n$$\nD_{KL}\\left(p(y|x)\\,\\|\\,q(y|x)\\right)=\\mathbb{E}_{p(y|x)}\\left[\\ln\\frac{p(y|x)}{q(y|x)}\\right].\n$$\n使用\n$$\n\\ln p(y|x)=-\\frac{1}{2}\\ln(2\\pi\\sigma^{2})-\\frac{(y-\\mu_{x})^{2}}{2\\sigma^{2}},\\quad\n\\ln q(y|x)=-\\frac{1}{2}\\ln(2\\pi\\sigma^{2})-\\frac{(y-\\nu_{x})^{2}}{2\\sigma^{2}},\n$$\n它们的差为\n$$\n\\ln p(y|x)-\\ln q(y|x)=\\frac{(y-\\nu_{x})^{2}-(y-\\mu_{x})^{2}}{2\\sigma^{2}}.\n$$\n对 $p(y|x)$（其中 $y\\sim\\mathcal{N}(\\mu_{x},\\sigma^{2})$）求期望，我们使用\n$$\n\\mathbb{E}\\left[(y-\\mu_{x})^{2}\\right]=\\sigma^{2},\\quad\n\\mathbb{E}\\left[(y-\\nu_{x})^{2}\\right]=\\sigma^{2}+(\\mu_{x}-\\nu_{x})^{2},\n$$\n得到\n$$\nD_{KL}\\left(p(y|x)\\,\\|\\,q(y|x)\\right)=\\frac{(\\mu_{x}-\\nu_{x})^{2}}{2\\sigma^{2}}.\n$$\n因此，目标函数变为\n$$\nL(\\nu_{0},\\nu_{1})=\\mathbb{E}_{p(x)}\\left[\\frac{(\\mu_{x}-\\nu_{x})^{2}}{2\\sigma^{2}}\\right]\n=p \\cdot D_{KL}(p(y|1)\\,\\|\\,q(y|1))+(1-p) \\cdot D_{KL}(p(y|0)\\,\\|\\,q(y|0)).\n$$\n根据问题描述，真实的信道均值对于输入 $x=1$ 是 $\\mu_1 = \\mu_0$，对于输入 $x=0$ 是 $-\\mu_0$。代入目标函数：\n$$L(\\nu_{0},\\nu_{1}) = \\frac{p}{2\\sigma^{2}}(\\mu_{0}-\\nu_{1})^{2}+\\frac{1-p}{2\\sigma^{2}}(-\\mu_{0}-\\nu_{0})^{2}.$$\n由于 $0  p  1$ 且 $\\sigma^2 > 0$，损失 $L$ 是两个非负项的加权和。为了最小化 $L$，我们必须将每个平方项设置为零，这给出了最优模型参数：\n$$ \\nu_1 = \\mu_0 $$\n$$ \\nu_0 = -\\mu_0 $$\n因此，最优参数为 $(\\nu_0, \\nu_1) = (-\\mu_0, \\mu_0)$。", "answer": "$$\\boxed{\\begin{pmatrix}-\\mu_{0}  \\mu_{0}\\end{pmatrix}}$$", "id": "1643617"}]}