{"hands_on_practices": [{"introduction": "理论知识需要通过实践来巩固。现代纠错码（如Turbo码）的强大之处在于它们不只处理“硬判决”的0和1，而是利用包含可靠性度量的“软信息”。第一个练习 [@problem_id:1665637] 将演示如何将从通信信道接收到的原始带噪信号，转换为Turbo解码过程所需的基本输入——对数似然比（Log-Likelihood Ratios, LLRs）。这是理解软输入软输出解码算法的第一步。", "problem": "在一个简化的深空通信系统模型中，一个探测器向地球上的接收机发送一个由四个数据位 $u_k \\in \\{0, 1\\}$ 组成的短序列。所使用的调制方案是二进制相移键控 (BPSK)，其中比特 '0' 映射为发射信号电平 $+A$，比特 '1' 映射为 $-A$。传输通过一个加性高斯白噪声 (AWGN) 信道，该信道会在每个发射信号电平 $x_k$ 上叠加一个噪声分量 $n_k$。噪声 $n_k$ 服从均值为零、方差为 $\\sigma^2$ 的高斯分布。因此，接收到的信号为 $y_k = x_k + n_k$。\n\n接收机采用Turbo解码器，它需要为每个比特提供一个初始“软”输入。这个初始软信息是一个可靠性度量，定义为在给定观测到的接收信号值 $y_k$ 的条件下，发射比特为 '0' 的概率与发射比特为 '1' 的概率之比的自然对数。\n\n假设系统参数如下：\n- 信号幅度, $A = 1.0$ 伏特。\n- 噪声方差, $\\sigma^2 = 0.5$ 伏特$^2$。\n- 先验地，发射比特 '0' 和 '1' 是等概率的。\n- 四个接收信号值的序列为 `y = [0.85, -1.10, 0.40, -0.25]` 伏特。\n\n计算与这四个接收值分别对应的初始可靠性度量序列。将你的最终答案表示为一组四个数值，并四舍五入到三位有效数字。", "solution": "问题要求计算每个接收比特的初始可靠性度量，其定义为在给定接收信号值的条件下，该比特为 '0' 的后验概率与为 '1' 的后验概率之比的自然对数。设第 $k$ 个比特的这个度量为 $L_k$。\n$$L_k = \\ln\\left(\\frac{P(u_k=0 | y_k)}{P(u_k=1 | y_k)}\\right)$$\n其中 $u_k$ 是发射的比特，$y_k$ 是对应的接收信号值。\n\n根据贝叶斯定理，后验概率 $P(u_k | y_k)$ 可以表示为：\n$$P(u_k | y_k) = \\frac{p(y_k | u_k) P(u_k)}{p(y_k)}$$\n此处，$p(y_k | u_k)$ 是在发送了比特 $u_k$ 的条件下接收到 $y_k$ 的条件概率密度函数 (PDF)。$P(u_k)$ 是比特 $u_k$ 的先验概率，$p(y_k)$ 是接收信号的概率密度函数，它作为一个归一化常数。\n\n将此代入 $L_k$ 的表达式中：\n$$L_k = \\ln\\left(\\frac{\\frac{p(y_k | u_k=0) P(u_k=0)}{p(y_k)}}{\\frac{p(y_k | u_k=1) P(u_k=1)}{p(y_k)}}\\right)$$\n分子和分母中的 $p(y_k)$ 项相互抵消。问题陈述中提到，发射的比特是等概率的，因此 $P(u_k=0) = P(u_k=1) = 0.5$。这些项也相互抵消。\n$L_k$ 的表达式简化为信道观测值的对数似然比：\n$$L_k = \\ln\\left(\\frac{p(y_k | u_k=0)}{p(y_k | u_k=1)}\\right)$$\n\n接下来，我们根据 BPSK 调制和 AWGN 信道模型来定义条件概率密度函数。\n如果发射比特 $u_k=0$，则信号电平为 $x_k = +A$。接收到的信号是 $y_k = A + n_k$。由于 $n_k$ 是均值为 0、方差为 $\\sigma^2$ 的高斯噪声，所以 $y_k$ 服从均值为 $A$、方差为 $\\sigma^2$ 的高斯分布。其条件概率密度函数为：\n$$p(y_k | u_k=0) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(y_k - A)^2}{2\\sigma^2}\\right)$$\n如果发射比特 $u_k=1$，则信号电平为 $x_k = -A$。接收到的信号是 $y_k = -A + n_k$。所以，$y_k$ 服从均值为 $-A$、方差为 $\\sigma^2$ 的高斯分布。其条件概率密度函数为：\n$$p(y_k | u_k=1) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(y_k - (-A))^2}{2\\sigma^2}\\right) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(y_k + A)^2}{2\\sigma^2}\\right)$$\n\n现在，将这些概率密度函数代回 $L_k$ 的表达式中：\n$$L_k = \\ln\\left( \\frac{\\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(y_k - A)^2}{2\\sigma^2}\\right)}{\\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(y_k + A)^2}{2\\sigma^2}\\right)} \\right)$$\n常数项 $\\frac{1}{\\sqrt{2\\pi\\sigma^2}}$ 相互抵消。\n$$L_k = \\ln\\left( \\exp\\left(-\\frac{(y_k - A)^2}{2\\sigma^2} + \\frac{(y_k + A)^2}{2\\sigma^2}\\right) \\right)$$\n自然对数和指数函数是互逆的，因此它们相互抵消：\n$$L_k = -\\frac{(y_k - A)^2}{2\\sigma^2} + \\frac{(y_k + A)^2}{2\\sigma^2}$$\n$$L_k = \\frac{1}{2\\sigma^2} \\left[ -(y_k^2 - 2Ay_k + A^2) + (y_k^2 + 2Ay_k + A^2) \\right]$$\n$$L_k = \\frac{1}{2\\sigma^2} \\left[ -y_k^2 + 2Ay_k - A^2 + y_k^2 + 2Ay_k + A^2 \\right]$$\n$$L_k = \\frac{1}{2\\sigma^2} [4Ay_k] = \\frac{2Ay_k}{\\sigma^2}$$\n这就是 BPSK 信号在 AWGN 信道上的初始可靠性度量的通用表达式。\n\n现在我们代入给定的数值：$A = 1.0$ 和 $\\sigma^2 = 0.5$。\n$$L_k = \\frac{2 \\times (1.0) \\times y_k}{0.5} = 4y_k$$\n我们现在可以为接收序列 `y = [0.85, -1.10, 0.40, -0.25]` 中的每个值计算可靠性度量。\n\n对于 $y_1 = 0.85$：\n$L_1 = 4 \\times 0.85 = 3.40$\n\n对于 $y_2 = -1.10$：\n$L_2 = 4 \\times (-1.10) = -4.40$\n\n对于 $y_3 = 0.40$：\n$L_3 = 4 \\times 0.40 = 1.60$\n\n对于 $y_4 = -0.25$：\n$L_4 = 4 \\times (-0.25) = -1.00$\n\n问题要求结果保留三位有效数字。计算出的值已经满足或可以表示为三位有效数字。\n可靠性度量的序列是 $[3.40, -4.40, 1.60, -1.00]$。", "answer": "$$\\boxed{\\begin{pmatrix} 3.40  -4.40  1.60  -1.00 \\end{pmatrix}}$$", "id": "1665637"}, {"introduction": "获得初始LLRs后，Turbo解码器便开始其核心的迭代过程。每个分量解码器的核心是BCJR（或称MAP）算法，它通过在网格图上传递信息来更新对所传输比特的置信度。这个练习 [@problem_id:1665643] 将让你亲手实践该算法中的一个关键步骤：计算前向状态度量。通过这个计算，你将深入了解外在信息是如何在两个解码器之间生成和交换的，这也是Turbo码性能卓越的奥秘所在。", "problem": "在为深空探测器设计的通信系统中，使用了一种速率为1/2的Turbo码进行纠错。解码过程依赖于Bahl-Cocke-Jelinek-Raviv (BCJR) 算法，该算法通过在表示分量编码器的网格图上迭代计算状态度量。\n\n考虑该系统中使用的递归系统卷积 (RSC) 编码器之一。它有四个状态 ($m \\in \\{0, 1, 2, 3\\}$)。状态 $m$ 由一个二进制元组 $(s_1, s_0)$ 表示，对应于两个存储单元的内容，使得 $m = 2s_1 + s_0$。状态转移动态如下：给定在时刻 $k-1$ 的状态 $S_{k-1}=(s_{k-1,1}, s_{k-1,0})$ 和一个信息比特 $u_k \\in \\{0,1\\}$，计算出一个新值 $a_k = u_k \\oplus s_{k-1,1}$，其中 $\\oplus$ 表示模2加法。在时刻 $k$ 的新状态变为 $S_k = (s_{k,1}, s_{k,0}) = (a_k, s_{k-1,1})$，相应的奇偶校验位为 $p_k = a_k \\oplus s_{k-1,0}$。\n\n信息比特 ($u_k$) 和奇偶校验位 ($p_k$) 使用双极性相移键控 (BPSK) 进行调制，其中比特 $b \\in \\{0,1\\}$ 映射到符号 $x = 1 - 2b$。这些符号通过噪声方差为 $\\sigma^2$ 的加性高斯白噪声 (AWGN) 信道传输。\n\n在解码过程中的特定时间步 $k$，以下信息是可用的：\n- 来自前一时间步 $k-1$ 的归一化前向状态度量为：\n  $\\alpha_{k-1}(m=0) = 0.40$\n  $\\alpha_{k-1}(m=1) = 0.10$\n  $\\alpha_{k-1}(m=2) = 0.30$\n  $\\alpha_{k-1}(m=3) = 0.20$\n- 在时刻 $k$ 接收到的带噪BPSK符号对于系统位是 $y_k^s = -0.50$，对于奇偶校验位是 $y_k^p = +0.80$。\n- 信息比特 $u_k$ 的先验概率为 $\\Pr(u_k=0) = 0.60$ 和 $\\Pr(u_k=1) = 0.40$。\n- 信道噪声方差为 $\\sigma^2 = 0.50$。\n\n未归一化的前向状态度量 $\\tilde{\\alpha}_k(m)$ 使用和积规则递归计算：$\\tilde{\\alpha}_k(m) = \\sum_{m'} \\alpha_{k-1}(m') \\tilde{\\gamma}_k(m', m)$。对于此分析，您必须使用简化的、未归一化的分支度量 $\\tilde{\\gamma}_k(m', m)$，定义为：\n$$\n\\tilde{\\gamma}_k(m', m) = \\Pr(u_k) \\exp\\left(\\frac{y_k^s x_k^s + y_k^p x_k^p}{\\sigma^2}\\right)\n$$\n其中 $u_k$ 是引起从状态 $m'$ 到 $m$ 转移的信息比特，而 $x_k^s$ 和 $x_k^p$ 分别是系统位和奇偶校验位的相应BPSK符号。\n\n计算在时间步 $k$ 时状态 $m=2$ 的未归一化前向状态度量 $\\tilde{\\alpha}_k(m)$ 的值。将您的最终答案四舍五入到四位有效数字。", "solution": "我们首先确定在时刻 $k$ 哪些转移会导致状态 $m=2$。由于状态表示为 $S_{k}=(s_{k,1},s_{k,0})$ 且 $m=2s_{1}+s_{0}$，目标状态 $m=2$ 对应于 $S_{k}=(1,0)$。根据给定的状态演化，\n$$\nS_{k}=(a_{k},s_{k-1,1}), \\quad a_{k}=u_{k}\\oplus s_{k-1,1}.\n$$\n因此，要得到 $S_{k}=(1,0)$，我们需要 $s_{k-1,1}=0$ 和 $a_{k}=1$。由于 $a_{k}=u_{k}\\oplus s_{k-1,1}$ 且 $s_{k-1,1}=0$，可以得出 $u_{k}=1$。因此，前一个状态 $S_{k-1}=(s_{k-1,1}, s_{k-1,0})$ 必须有 $s_{k-1,1}=0$，这意味着起始状态 $m'$ 只能是 $m'=0$ ($S_{k-1}=(0,0)$) 或 $m'=1$ ($S_{k-1}=(0,1)$)。\n\n接下来，我们计算这两个转移对应的分支度量 $\\tilde{\\gamma}_k(m', 2)$。\n1.  **从 $m'=0$ ($S_{k-1}=(0,0)$) 到 $m=2$ 的转移**：\n    - 输入比特必须是 $u_k=1$。\n    - 内部信号 $a_k = u_k \\oplus s_{k-1,1} = 1 \\oplus 0 = 1$。\n    - 校验比特 $p_k = a_k \\oplus s_{k-1,0} = 1 \\oplus 0 = 1$。\n    - BPSK符号：系统位 $u_k=1 \\Rightarrow x_k^s = -1$；校验位 $p_k=1 \\Rightarrow x_k^p = -1$。\n    - 分支度量计算：\n    $$ \\tilde{\\gamma}_k(0, 2) = \\Pr(u_k=1) \\exp\\left(\\frac{y_k^s x_k^s + y_k^p x_k^p}{\\sigma^2}\\right) $$\n    $$ = 0.40 \\exp\\left(\\frac{(-0.50)(-1) + (0.80)(-1)}{0.50}\\right) = 0.40 \\exp\\left(\\frac{0.50 - 0.80}{0.50}\\right) = 0.40 \\exp\\left(\\frac{-0.30}{0.50}\\right) = 0.40 e^{-0.6} $$\n\n2.  **从 $m'=1$ ($S_{k-1}=(0,1)$) 到 $m=2$ 的转移**：\n    - 输入比特必须是 $u_k=1$。\n    - 内部信号 $a_k = u_k \\oplus s_{k-1,1} = 1 \\oplus 0 = 1$。\n    - 校验比特 $p_k = a_k \\oplus s_{k-1,0} = 1 \\oplus 1 = 0$。\n    - BPSK符号：系统位 $u_k=1 \\Rightarrow x_k^s = -1$；校验位 $p_k=0 \\Rightarrow x_k^p = +1$。\n    - 分支度量计算：\n    $$ \\tilde{\\gamma}_k(1, 2) = \\Pr(u_k=1) \\exp\\left(\\frac{y_k^s x_k^s + y_k^p x_k^p}{\\sigma^2}\\right) $$\n    $$ = 0.40 \\exp\\left(\\frac{(-0.50)(-1) + (0.80)(+1)}{0.50}\\right) = 0.40 \\exp\\left(\\frac{0.50 + 0.80}{0.50}\\right) = 0.40 \\exp\\left(\\frac{1.30}{0.50}\\right) = 0.40 e^{2.6} $$\n\n未归一化的前向度量 $\\tilde{\\alpha}_k(2)$ 是所有导致状态 $m=2$ 的路径的度量之和：\n$$ \\tilde{\\alpha}_k(2) = \\sum_{m' \\in \\{0,1,2,3\\}} \\alpha_{k-1}(m') \\tilde{\\gamma}_k(m', 2) $$\n由于只有从 $m'=0$ 和 $m'=1$ 的转移可以到达 $m=2$，上式简化为：\n$$ \\tilde{\\alpha}_k(2) = \\alpha_{k-1}(0) \\tilde{\\gamma}_k(0, 2) + \\alpha_{k-1}(1) \\tilde{\\gamma}_k(1, 2) $$\n代入给定的前向度量 $\\alpha_{k-1}(0)=0.40$ 和 $\\alpha_{k-1}(1)=0.10$：\n$$ \\tilde{\\alpha}_k(2) = (0.40)(0.40 e^{-0.6}) + (0.10)(0.40 e^{2.6}) $$\n$$ \\tilde{\\alpha}_k(2) = 0.16 e^{-0.6} + 0.04 e^{2.6} $$\n现在进行数值计算：\n$$ e^{-0.6} \\approx 0.5488116 $$\n$$ e^{2.6} \\approx 13.463738 $$\n$$ \\tilde{\\alpha}_k(2) \\approx 0.16 \\times 0.5488116 + 0.04 \\times 13.463738 $$\n$$ \\tilde{\\alpha}_k(2) \\approx 0.0878098 + 0.5385495 $$\n$$ \\tilde{\\alpha}_k(2) \\approx 0.6263593 $$\n四舍五入到四位有效数字，结果是 $0.6264$。", "answer": "$$\\boxed{0.6264}$$", "id": "1665643"}, {"introduction": "Turbo码接近香农限的卓越性能并非偶然，它源于递归卷积码（RSC）和伪随机交织器的巧妙结合。最后一个练习 [@problem_id:1665620] 旨在揭示编码器设计的重要性，要求你利用一个简单块交织器的结构特性，找出一个特定的低重量输入消息，该消息会产生一个总重量也很低的输出码字。理解这类“坏”情况对于设计更优的交织器至关重要，它能让你深刻体会到为何交织器设计对整个编码系统的强度起着决定性作用。", "problem": "一个简化的速率为1/3的turbo码由两个相同的递归系统卷积（RSC）编码器和一个块交织器构成。输入是一个长度为 $K=16$ 比特的消息块 `u`，索引从 $k=0$ 到 $k=15$。二进制序列的汉明重量定义为序列中非零元素的数量。\n\n其组成部分的RSC编码器由生成矩阵 $G(D) = [1, \\frac{g_1(D)}{g_0(D)}]$ 定义，其中 $D$ 是延迟算子。反馈多项式为 $g_0(D) = 1+D+D^2$，前馈多项式为 $g_1(D) = 1+D$。所有多项式运算都在二元域 GF(2) 上进行。\n\n交织器是一个 $4 \\times 4$ 的块交织器。输入数据逐行（从左到右，从上到下）写入一个 $4 \\times 4$ 矩阵，然后逐列（从上到下，从左到右）读出，以产生交织后的序列 `u'`。对于原始索引为 $k$ 的输入比特，其中 $k = 4 \\times (\\text{行}) + (\\text{列})$（行和列均使用基于0的索引），其在交织序列中的新索引为 $\\pi(k) = 4 \\times (\\text{列}) + (\\text{行})$。\n\nTurbo编码过程如下：\n1. 原始消息 `u` 是码字的系统部分。\n2. 消息 `u` 由第一个RSC编码器处理，生成一个16比特的校验序列 `p1`。\n3. 消息 `u` 被交织成 `u'`。\n4. 交织后的消息 `u'` 由第二个RSC编码器处理，生成一个16比特的校验序列 `p2`。\n最终输出的码字 `c` 是 `(u, p1, p2)` 的串联，总长度为 $3K=48$ 比特。对于本问题，假设两个编码器都从全零状态开始，并且可以忽略网格终止（trellis termination）的影响（即，只考虑由16个消息比特生成的16个校验比特）。\n\n你的任务是找到一个汉明重量为2的输入消息 `u`，通过利用这个特定交织器的结构特性，生成一个权重特别低的输出码字。对于你找到的消息，计算最终48比特码字 `c` 的总汉明重量。", "solution": "为了找到一个能产生低重量码字的重量为2的输入消息，我们需要利用RSC编码器和交织器的代数特性。一个低重量的码字通常源于一个低重量的输入，该输入经过交织后，仍然是一个对第二个编码器“有利”的结构。\n\n**1. RSC编码器特性分析**\n\nRSC编码器的校验序列由传递函数 $G_p(D) = \\frac{g_1(D)}{g_0(D)} = \\frac{1+D}{1+D+D^2}$ 决定。反馈多项式 $g_0(D) = 1+D+D^2$ 是一个本原多项式，它的根的周期为 $2^2-1=3$。这意味着一个重量为1的输入（冲激）会使编码器状态进入一个长度为3的循环，并产生一个周期性的输出。\n\n一个能使编码器状态返回到全零状态的最低重量输入多项式是 $g_0(D) = 1+D+D^2$ 本身。然而，我们寻找重量为2的输入 $u(D) = D^i + D^j$。如果 $j-i$ 是3的倍数，即 $u(D) = D^i(1+D^{3m})$，则该输入产生的校验序列重量会很低。这是因为在GF(2)上，$1+D^3 = (1+D)(1+D+D^2) = (1+D)g_0(D)$。\n\n对于一个输入 $U(D) = 1+D^3$，其校验输出为：\n$$ P(D) = U(D)G_p(D) = (1+D^3) \\frac{1+D}{1+D+D^2} = (1+D)g_0(D) \\frac{1+D}{g_0(D)} = (1+D)^2 = 1+D^2 $$\n该校验序列为 `(1, 0, 1, 0, 0, ...)`，汉明重量为2。\n类似地，对于 $U(D) = 1+D^{12} = 1+(D^3)^4 = (1+D^3)^4 = ((1+D)g_0(D))^4 = (1+D)^4 g_0(D)^4$。由于我们是在GF(2)上进行多项式运算，且$x^2-y^2=(x-y)^2=(x+y)^2$，所以 $(1+D)^4 = 1+D^4$ 以及 $(1+D)^8=1+D^8$。因此，对于输入 $U(D)=1+D^{12}$，校验输出为 $P(D) = (1+D^{12})G_p(D) = ((1+D)^2)^4 \\pmod{g_0(D)}...$ 这个计算比较复杂。一个更简单的方法是利用 $P(D)=(1+D^3)^4 G_p(D) = (1+D^2)^4 = 1+D^8$。因此，校验序列为 `(1, 0, 0, 0, 0, 0, 0, 0, 1, 0, ...)`，重量也是2。\n\n**2. 利用交织器结构**\n\n我们的目标是找到一个重量为2的输入 `u`，其非零位在索引 $i$ 和 $j$。我们希望：\n- $j-i$ 是3的倍数，以使第一个校验序列 `p1` 的重量低。\n- 交织后的索引 $\\pi(i)$ 和 $\\pi(j)$ 的差值 $\\pi(j)-\\pi(i)$ 也是3的倍数，以使第二个校验序列 `p2` 的重量也低。\n\n我们来测试一些简单的重量为2的输入。\n选择输入 `u` 在索引 $i=0$ 和 $j=3$ 处为 '1'。\n- `u` = `(1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)`。\n- 输入的汉明重量 $w(u) = 2$。\n- 输入的位置差为 $3-0=3$，是3的倍数。因此，第一个校验序列 `p1` 的重量为 $w((1+D^3)G_p(D)) = w(1+D^2) = 2$。\n\n现在我们看交织后的输入 `u'`。\n- 交织器是一个 $4 \\times 4$ 的块交织器。\n- 比特在索引 $i=0$ 处：在矩阵中位于 (行=0, 列=0)。交织后的索引 $\\pi(0) = 4 \\times 0 + 0 = 0$。\n- 比特在索引 $j=3$ 处：在矩阵中位于 (行=0, 列=3)。交织后的索引 $\\pi(3) = 4 \\times 3 + 0 = 12$。\n- 交织后的输入 `u'` 在索引 $0$ 和 $12$ 处为 '1'。\n- 交织后输入的位置差为 $12-0=12$。这也是3的倍数 ($12 = 4 \\times 3$)。\n- 因此，第二个校验序列 `p2` 的重量为 $w((1+D^{12})G_p(D)) = w(1+D^8) = 2$。\n\n**3. 计算总汉明重量**\n\n我们找到了一个满足条件的输入消息 `u`，它在位置0和3处为1。现在计算最终码字 `c = (u, p1, p2)` 的总汉明重量。\n- 消息 `u` 的重量: $w(u) = 2$。\n- 第一个校验序列 `p1` 的重量: $w(p1) = 2$。\n- 第二个校验序列 `p2` 的重量: $w(p2) = 2$。\n\n总汉明重量 $w(c) = w(u) + w(p1) + w(p2) = 2 + 2 + 2 = 6$。\n\n这个重量（6）远小于一个随机的重量为2的输入所期望产生的码字重量，因此它是一个典型的导致错误平层的低重量码字。", "answer": "$$\\boxed{6}$$", "id": "1665620"}]}