{"hands_on_practices": [{"introduction": "许多常见的概率分布，从高斯分布到泊松分布，都是一个更广泛的类别——指数分布族——的成员。这种通用的结构使我们能够以统一的方式研究它们的性质。本练习将指导您将几何分布重塑为其规范的指数族形式，这是理解和应用这些模型的一项基本技能 [@problem_id:1623491]。", "problem": "在设计一个可靠的数据传输协议时，一位工程师对发送数据包的过程进行建模。每次传输尝试都是一次独立的伯努利试验，其成功概率为 $p$，其中 $0  p  1$。令随机变量 $X$ 表示在第一次成功传输发生前失败的尝试次数。$X$ 的概率质量函数由几何分布给出：\n$$P(X=x) = (1-p)^x p, \\quad \\text{for } x \\in \\{0, 1, 2, \\dots\\}$$\n任何可以写成如下形式的概率分布\n$$f(x|\\theta) = h(x) \\exp(\\eta(\\theta) T(x) - A(\\eta(\\theta)))$$\n都是指数族的一员。对于典范形式，我们使用自然参数 $\\eta = \\eta(\\theta)$ 并将分布写为：\n$$f(x|\\eta) = h(x) \\exp(\\eta T(x) - A(\\eta))$$\n其中 $h(x)$ 是基测度，$T(x)$ 是充分统计量，$\\eta$ 是自然参数，$A(\\eta)$ 是对数配分函数（或称累积量生成函数）。\n\n您的任务是将给定的几何分布表示为这种典范指数族形式。在 $\\eta = \\ln(1-p)$ 的情况下，以下哪个选项正确地标识了分量三元组 $(h(x), T(x), A(\\eta))$？\n\nA. $(h(x)=1, \\quad T(x)=x, \\quad A(\\eta)=-\\ln(1-e^\\eta))$\n\nB. $(h(x)=1, \\quad T(x)=x, \\quad A(\\eta)=\\eta - \\ln(1-e^\\eta))$\n\nC. $(h(x)=p, \\quad T(x)=x, \\quad A(\\eta)=0)$\n\nD. $(h(x)=1, \\quad T(x)=x, \\quad A(\\eta)=\\ln(1-e^\\eta))$\n\nE. $(h(x)=1, \\quad T(x)=1, \\quad A(\\eta)=-\\ln(1-e^\\eta))$", "solution": "我们从几何分布的概率质量函数开始：\n$$P(X=x) = (1-p)^x p, \\quad x \\in \\{0, 1, 2, \\dots\\}$$\n为了将其转换为指数族形式，我们取其对数并进行指数化：\n$$P(X=x) = \\exp(\\ln((1-p)^x p)) = \\exp(x \\ln(1-p) + \\ln p)$$\n根据题意，自然参数为 $\\eta = \\ln(1-p)$。这直接给出了充分统计量 $T(x)=x$。\n\n现在我们需要用 $\\eta$ 来表示 $p$。从 $\\eta = \\ln(1-p)$，我们得到 $e^\\eta = 1-p$，因此 $p = 1 - e^\\eta$。\n\n将这个关系代入上式中的 $\\ln p$ 项：\n$$P(X=x) = \\exp(x\\eta + \\ln(1-e^\\eta))$$\n将此表达式与典范形式 $h(x) \\exp(\\eta T(x) - A(\\eta))$ 进行比较。\n\n我们看到基测度 $h(x)=1$，充分统计量 $T(x)=x$，并且：\n$$-A(\\eta) = \\ln(1-e^\\eta)$$\n因此，对数配分函数为：\n$$A(\\eta) = -\\ln(1-e^\\eta)$$\n综上所述，分量三元组是 $(h(x)=1, T(x)=x, A(\\eta)=-\\ln(1-e^\\eta))$。这与选项 A 相符。", "answer": "$$\\boxed{A}$$", "id": "1623491"}, {"introduction": "指数族表示法最强大的特性之一是它简化了统计矩的计算。对数配分函数 $A(\\eta)$ 不仅仅是一个归一化常数，它的导数直接给出了充分统计量的期望值。这个问题提供了对这一优雅性质的动手实践，让您能够为一个自定义的分布计算期望值，而无需执行标准的求和计算 [@problem_id:1623484]。", "problem": "考虑一个离散随机变量 $X$，其定义域为整数集 $\\{0, 1, 2\\}$。$X$ 的概率质量函数 (PMF) 由以下形式的双参数指数族描述：\n$$p(x | \\eta_1, \\eta_2) = \\exp(\\eta_1 T_1(x) + \\eta_2 T_2(x) - A(\\eta_1, \\eta_2))$$\n其中 $\\eta_1$ 和 $\\eta_2$ 是自然参数，$A(\\eta_1, \\eta_2)$ 是对分布进行归一化的对数配分函数。基测度是均匀的，即对于定义域中的所有 $x$，都有 $h(x) = 1$。\n\n该指数族的充分统计量定义为：\n$T_1(x) = x$\n$T_2(x) = |x-1|$\n\n对于该分布的一个特定实例，自然参数给定为 $\\eta_1 = 1.0$ 和 $\\eta_2 = -1.0$。计算随机变量的期望值 $E[X]$。\n\n将最终答案四舍五入到四位有效数字。", "solution": "指数族由下式给出：\n$$p(x | \\eta_1, \\eta_2) = \\exp(\\eta_1 T_1(x) + \\eta_2 T_2(x) - A(\\eta_1, \\eta_2))$$\n其中基测度 $h(x)=1$，充分统计量为 $T_1(x)=x$ 和 $T_2(x)=|x-1|$，对数配分函数为：\n$$A(\\eta_1, \\eta_2) = \\ln\\left(\\sum_{x\\in\\{0,1,2\\}} \\exp(\\eta_1 x + \\eta_2|x-1|)\\right)$$\n指数族的一个标准性质是，充分统计量的期望可以通过对对数配分函数求导得到。对于 $T_1(x)=x$，我们有 $E[X] = \\frac{\\partial A}{\\partial \\eta_1}$。这等价于直接用概率分布定义计算期望值。\n\n对于给定的参数 $\\eta_1 = 1.0$ 和 $\\eta_2 = -1.0$，我们首先计算未归一化的权重 $w(x) = \\exp(\\eta_1 x + \\eta_2 |x-1|) = \\exp(x - |x-1|)$：\n对于 $x=0$，$w(0) = \\exp(0 - |0-1|) = \\exp(-1)$。\n对于 $x=1$，$w(1) = \\exp(1 - |1-1|) = \\exp(1)$。\n对于 $x=2$，$w(2) = \\exp(2 - |2-1|) = \\exp(1)$。\n\n配分函数 $Z$ 是这些权重的总和：\n$$Z = \\sum_x w(x) = \\exp(-1) + \\exp(1) + \\exp(1) = \\exp(-1) + 2\\exp(1)$$\n现在，我们可以计算期望值 $E[X]$：\n$$E[X] = \\sum_{x \\in \\{0,1,2\\}} x \\cdot p(x) = \\frac{1}{Z} \\sum_{x \\in \\{0,1,2\\}} x \\cdot w(x)$$\n$$E[X] = \\frac{0 \\cdot \\exp(-1) + 1 \\cdot \\exp(1) + 2 \\cdot \\exp(1)}{\\exp(-1) + 2\\exp(1)} = \\frac{3\\exp(1)}{\\exp(-1) + 2\\exp(1)}$$\n为了简化表达式，分子和分母同乘以 $\\exp(1)$：\n$$E[X] = \\frac{3\\exp(1) \\cdot \\exp(1)}{(\\exp(-1) + 2\\exp(1)) \\cdot \\exp(1)} = \\frac{3\\exp(2)}{1 + 2\\exp(2)}$$\n计算数值：\n$$E[X] \\approx \\frac{3 \\times 7.389056}{1 + 2 \\times 7.389056} \\approx \\frac{22.167168}{15.778112} \\approx 1.40493$$\n四舍五入到四位有效数字，结果为 $1.405$。", "answer": "$$\\boxed{1.405}$$", "id": "1623484"}, {"introduction": "最大熵原理为基于有限信息构建概率分布提供了一种强大而客观的方法。当我们的知识以期望值的形式作为约束时，该原理自然地导向属于指数族的分布。在这个问题中，您将应用这一原理，在给定物理系统的平均能量的情况下，确定其最可能的能级状态分布，并亲眼见证这种联系 [@problem_id:1623482]。", "problem": "一个物理系统已知拥有三个离散的能级，$E_1=\\epsilon_0, E_2=2\\epsilon_0, E_3=3\\epsilon_0$，其中 $\\epsilon_0$ 是一个正的能量常数。通过对在相同条件下制备的大量相同系统的系综进行一系列测量，确定其平均能量为 $\\langle E \\rangle = \\frac{7}{3}\\epsilon_0$。根据最大熵原理，假设系统的状态分布 $\\{p_1, p_2, p_3\\}$ 是与此观测到的平均能量相符且熵最高的那一个分布。计算系统处于第二个能级 $E_2$ 的概率 $p_2$。请用一个单一的闭式解析表达式表示你的答案。", "solution": "该问题要求解在特定约束条件下，使香农熵最大化的概率分布 $\\{p_1, p_2, p_3\\}$。香农熵由 $H(p_1, p_2, p_3) = - \\sum_{i=1}^{3} p_i \\ln(p_i)$ 给出。\n\n对概率的约束条件是：\n1.  归一化：所有概率之和必须为1。\n    $$g_1(p_1, p_2, p_3) = \\sum_{i=1}^{3} p_i - 1 = p_1 + p_2 + p_3 - 1 = 0$$\n2.  平均能量：能量的期望值必须与观测值相符。\n    $$g_2(p_1, p_2, p_3) = \\sum_{i=1}^{3} p_i E_i - \\langle E \\rangle = p_1 E_1 + p_2 E_2 + p_3 E_3 - \\langle E \\rangle = 0$$\n\n我们使用拉格朗日乘子法来解决这个约束优化问题。拉格朗日函数 $\\mathcal{L}$ 构造如下：\n$$\\mathcal{L}(p_1, p_2, p_3, \\lambda_0, \\lambda_1) = H - \\lambda_0 g_1 - \\lambda_1 g_2$$\n$$\\mathcal{L} = -\\sum_{i=1}^{3} p_i \\ln(p_i) - \\lambda_0 (p_1+p_2+p_3-1) - \\lambda_1 (p_1 E_1 + p_2 E_2 + p_3 E_3 - \\langle E \\rangle)$$\n为了找到最大值，我们对 $\\mathcal{L}$ 关于每个 $p_i$ 求偏导数，并令其为零。\n$$\\frac{\\partial \\mathcal{L}}{\\partial p_i} = -(\\ln(p_i) + 1) - \\lambda_0 - \\lambda_1 E_i = 0$$\n求解 $p_i$：\n$$\\ln(p_i) = -1 - \\lambda_0 - \\lambda_1 E_i$$\n$$p_i = \\exp(-1 - \\lambda_0 - \\lambda_1 E_i) = \\exp(-1-\\lambda_0) \\exp(-\\lambda_1 E_i)$$\n我们定义一个新常数 $\\beta = \\lambda_1$。项 $\\exp(-1-\\lambda_0)$ 是一个常数，可以通过归一化约束来确定。我们称之为 $1/Z$。那么概率分布就呈现玻尔兹曼分布的形式，这是指数族的一员：\n$$p_i = \\frac{1}{Z} \\exp(-\\beta E_i)$$\n归一化常数 $Z$，也称为配分函数，通过对概率求和得到：\n$$Z = \\sum_{i=1}^{3} \\exp(-\\beta E_i)$$\n\n现在，我们使用给定的值：$E_1=\\epsilon_0, E_2=2\\epsilon_0, E_3=3\\epsilon_0$ 和 $\\langle E \\rangle = \\frac{7}{3}\\epsilon_0$。平均能量约束为：\n$$\\langle E \\rangle = \\sum_{i=1}^{3} p_i E_i = \\frac{1}{Z} \\sum_{i=1}^{3} E_i \\exp(-\\beta E_i) = \\frac{7}{3}\\epsilon_0$$\n代入 $E_i$ 的表达式：\n$$\\frac{\\epsilon_0 \\exp(-\\beta \\epsilon_0) + 2\\epsilon_0 \\exp(-2\\beta \\epsilon_0) + 3\\epsilon_0 \\exp(-3\\beta \\epsilon_0)}{\\exp(-\\beta \\epsilon_0) + \\exp(-2\\beta \\epsilon_0) + \\exp(-3\\beta \\epsilon_0)} = \\frac{7}{3}\\epsilon_0$$\n常数 $\\epsilon_0$ 从两边消去。我们引入一个变量 $x = \\exp(-\\beta \\epsilon_0)$。方程变为：\n$$\\frac{x + 2x^2 + 3x^3}{x + x^2 + x^3} = \\frac{7}{3}$$\n由于 $x$ 不能为零（否则概率将无定义），我们可以从分子和分母中提出因子 $x$：\n$$\\frac{1 + 2x + 3x^2}{1 + x + x^2} = \\frac{7}{3}$$\n现在我们求解 $x$：\n$$3(1 + 2x + 3x^2) = 7(1 + x + x^2)$$\n$$3 + 6x + 9x^2 = 7 + 7x + 7x^2$$\n$$2x^2 - x - 4 = 0$$\n这是一个关于 $x$ 的二次方程。使用二次公式 $x = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$：\n$$x = \\frac{1 \\pm \\sqrt{(-1)^2 - 4(2)(-4)}}{2(2)} = \\frac{1 \\pm \\sqrt{1 + 32}}{4} = \\frac{1 \\pm \\sqrt{33}}{4}$$\n由于 $x = \\exp(-\\beta \\epsilon_0)$ 并且 $\\epsilon_0>0$ 是一个物理能量，$\\beta$ 必须是实数，这意味着 $x$ 必须是一个正实数。因此，我们取正根：\n$$x = \\frac{1 + \\sqrt{33}}{4}$$\n问题要求概率 $p_2$。我们用 $x$ 来表示 $p_2$：\n$$p_2 = \\frac{\\exp(-2\\beta\\epsilon_0)}{Z} = \\frac{\\exp(-2\\beta\\epsilon_0)}{\\exp(-\\beta\\epsilon_0) + \\exp(-2\\beta\\epsilon_0) + \\exp(-3\\beta\\epsilon_0)}$$\n$$p_2 = \\frac{x^2}{x + x^2 + x^3} = \\frac{x}{1 + x + x^2}$$\n根据二次方程 $2x^2 - x - 4 = 0$，我们有 $x^2 = \\frac{x+4}{2}$。让我们将此代入 $p_2$ 表达式的分母中：\n$$1 + x + x^2 = 1 + x + \\frac{x+4}{2} = \\frac{2 + 2x + x + 4}{2} = \\frac{3x+6}{2}$$\n现在将此代回 $p_2$ 的表达式中：\n$$p_2 = \\frac{x}{\\frac{3x+6}{2}} = \\frac{2x}{3x+6} = \\frac{2x}{3(x+2)}$$\n最后，我们代入 $x = \\frac{1+\\sqrt{33}}{4}$ 的值：\n$$p_2 = \\frac{2(\\frac{1+\\sqrt{33}}{4})}{3(\\frac{1+\\sqrt{33}}{4} + 2)} = \\frac{\\frac{1+\\sqrt{33}}{2}}{3(\\frac{1+\\sqrt{33}+8}{4})} = \\frac{1+\\sqrt{33}}{2} \\cdot \\frac{4}{3(9+\\sqrt{33})} = \\frac{2(1+\\sqrt{33})}{3(9+\\sqrt{33})}$$\n为了简化，我们通过将分子和分母同乘以分母的共轭项 $(9-\\sqrt{33})$ 来使分母有理化：\n$$p_2 = \\frac{2(1+\\sqrt{33})(9-\\sqrt{33})}{3(9+\\sqrt{33})(9-\\sqrt{33})} = \\frac{2(9 - \\sqrt{33} + 9\\sqrt{33} - 33)}{3(9^2 - (\\sqrt{33})^2)} = \\frac{2(8\\sqrt{33} - 24)}{3(81 - 33)}$$\n$$p_2 = \\frac{2 \\cdot 8(\\sqrt{33} - 3)}{3(48)} = \\frac{16(\\sqrt{33} - 3)}{144}$$\n简化分数 $\\frac{16}{144} = \\frac{1}{9}$：\n$$p_2 = \\frac{\\sqrt{33} - 3}{9}$$", "answer": "$$\\boxed{\\frac{\\sqrt{33}-3}{9}}$$", "id": "1623482"}]}