{"hands_on_practices": [{"introduction": "这项实践通过数据压缩这个直观的例子，带你领略MDL原则的核心思想。假设你想发送一条短消息，是使用接收方已有的通用字典（通用模型）更高效，还是先为你的消息专门创建一个频率表（自定义模型）再发送？本练习 [@problem_id:1641426] 要求你计算并比较这两种策略的总描述长度，让你具体感受模型本身的成本与使用该模型编码数据所需成本之间的权衡。", "problem": "一位信息理论家正在使用最小描述长度 (MDL) 原则分析短文本字符串的压缩策略。MDL 的核心思想是找到一个能够对数据进行最短总描述的模型，该总描述长度是模型自身描述长度与使用该模型编码数据时的数据描述长度之和。\n\n待编码的特定数据字符串是 $S = \\text{\"AAAAABBCCC\"}$。\n\n现有两种竞争模型可供考虑：\n\n1.  **通用模型 ($M_U$)**：这是一个针对4字符字母表 {A, B, C, D} 的预先存在的固定模型，假定发送方和接收方均已知。因此，其描述长度被认为是零。在此模型下，各字符的概率为：\n    $P_U(A) = 0.4$\n    $P_U(B) = 0.3$\n    $P_U(C) = 0.2$\n    $P_U(D) = 0.1$\n    对于此策略，总描述长度就是使用基于模型 $M_U$ 的理想编码对字符串 $S$ 进行编码后的长度。\n\n2.  **自定义模型 ($M_C$)**：此模型是专门为字符串 $S$ 构建的。它使用 $S$ 中字符的经验频率作为其概率。该自定义模型的字母表仅包含 $S$ 中出现的字符。要使用此模型，发送方必须首先将模型的描述传输给接收方。\n    - **模型描述长度 $L(M_C)$**：通过传输 $S$ 中每个唯一字符的计数来描述该模型。对于一个总长度为 $N$、包含 $K$ 个唯一字符的字符串，传输这 $K$ 个计数的成本定义为 $L(M_C) = K \\log_2(N+1)$。\n    - **数据描述长度 $L(D|M_C)$**：这是使用基于自定义模型 $M_C$ 的概率的理想编码对字符串 $S$ 进行编码后的长度。\n\n基于某个模型的理想编码对字符串进行编码后的长度，由其各字符概率的以2为底的负对数之和给出。所有描述长度都以比特为单位计量。\n\n你的任务是确定哪个模型为字符串 $S$ 提供了更短的总描述长度。计算出可能的最短总描述长度。\n\n你的答案应以比特为单位，并四舍五入到四位有效数字。", "solution": "我们需要计算两种模型的总描述长度，并选择最小值。MDL 的总长度为 $L_{\\text{total}} = L(M) + L(D \\mid M)$，其中 $L(D \\mid M) = -\\sum \\log_{2} P_{M}(\\text{symbol})$ 是对字符串中所有符号（计入重复次数）求和。\n\n对于给定的字符串 $S=\\text{\"AAAAABBCCC\"}$，各字符计数为 $n_{A}=5$, $n_{B}=2$, $n_{C}=3, n_{D}=0$，总长度为 $N=10$，唯一字符数为 $K=3$。\n\n通用模型 $M_{U}$：模型成本为零，因此总长度就是数据编码长度\n$$\nL_{\\text{U}} = 5\\big(-\\log_{2}(0.4)\\big) + 2\\big(-\\log_{2}(0.3)\\big) + 3\\big(-\\log_{2}(0.2)\\big).\n$$\n使用 $-\\log_{2}(0.4)=\\log_{2}(5/2)\\approx 1.321928095$、$-\\log_{2}(0.3)\\approx 1.736965594$ 和 $-\\log_{2}(0.2)=\\log_{2}(5)\\approx 2.321928095$，我们得到\n$$\nL_{\\text{U}} \\approx 5(1.321928095) + 2(1.736965594) + 3(2.321928095) \\approx 17.049355948\\ \\text{比特}。\n$$\n\n自定义模型 $M_{C}$：模型成本为\n$$\nL(M_{C}) = K \\log_{2}(N+1) = 3\\log_{2}(11) \\approx 10.378294856.\n$$\n经验概率为 $P_{C}(A)=\\frac{5}{10}=0.5$、$P_{C}(B)=\\frac{2}{10}=0.2$、$P_{C}(C)=\\frac{3}{10}=0.3$。数据编码长度为\n$$\nL(D\\mid M_{C}) = 5\\big(-\\log_{2}(0.5)\\big) + 2\\big(-\\log_{2}(0.2)\\big) + 3\\big(-\\log_{2}(0.3)\\big).\n$$\n使用 $-\\log_{2}(0.5)=1$、$-\\log_{2}(0.2)=\\log_{2}(5)\\approx 2.321928095$ 和 $-\\log_{2}(0.3)\\approx 1.736965594$，我们得到\n$$\nL(D\\mid M_{C}) \\approx 5(1) + 2(2.321928095) + 3(1.736965594) \\approx 14.854752972.\n$$\n因此，自定义模型的总长度为\n$$\nL_{\\text{C}} = L(M_{C}) + L(D\\mid M_{C}) \\approx 10.378294856 + 14.854752972 \\approx 25.233047828\\ \\text{比特}。\n$$\n\n比较可知，$L_{\\text{U}} \\approx 17.049355948$ 比特，$L_{\\text{C}} \\approx 25.233047828$ 比特，所以通用模型产生的总描述长度更短。将最小值四舍五入到四位有效数字，得到 $17.05$ 比特。", "answer": "$$\\boxed{17.05}$$", "id": "1641426"}, {"introduction": "真实世界的数据往往并不完美，其中可能包含一些看起来“格格不入”的数值。这项实践旨在解决经典的异常值问题：一个出人意料的数据点，究竟是源于我们假设过程中的真实罕见事件，还是仅仅是一个错误或异常？MDL原则为此提供了一种规范化的决策方法，它通过计算两种解释的“成本”来进行判断：一种是扩展模型使其能够解释所有数据，另一种是付出一定代价将该点标记为异常，并用一个更简单的模型来解释其余数据 [@problem_id:1641424]。这个练习展示了MDL如何将奥卡姆剃刀原则应用于统计建模中。", "problem": "一位分析师正在使用最小描述长度 (MDL) 原则评估一个小型测量数据集 `D = {2.1, 2.9, 3.1, 3.3, 3.5, 10.0}`。目标是确定两个竞争假设中的哪一个为数据提供了更简洁的解释。一个假设的总描述长度 (DL) 是描述模型的成本与在给定模型下描述数据的成本之和，即 `DL(Hypothesis) = DL(Model) + DL(Data | Model)`。所有描述长度均以奈特 (nats) 为单位。\n\n**假设 H1：** 所有 `N=6` 个数据点均来自一个单一的高斯分布 `N(μ, σ^2)`。\n\n**假设 H2：** `N=6` 个数据点中的一个是离群值，该值被显式描述，而其余 `N-1=5` 个“内点”则来自一个高斯分布 `N(μ', σ'^2)`。对于此假设，假定离群值是数据点 `10.0`。\n\n成本函数定义如下：\n\n1.  **高斯分布的模型成本：** 对拟合 `n` 个数据点的高斯模型参数进行编码的成本由 `DL(Gaussian Params) = (k/2) * ln(n)` 给出，其中 `k=2` 是参数（μ 和 σ）的数量。对于所有高斯模型，使用参数的最大似然估计 (MLE)，其中均值 `μ` 是样本均值，方差 `σ^2` 是根据所建模的 `n` 个点计算出的样本方差 `(1/n) * Σ(x_i - μ)^2`。\n\n2.  **H2 中离群值的模型成本：** 指定 H2 模型的成本包括两部分：\n    a. 识别 `N` 个点中哪一个是指定离群值的成本，即 `ln(N)`。\n    b. 显式编码该离群值数值的成本，这是一个常数 `C = 8.0` 奈特。\n\n3.  **给定高斯模型的数据成本：** 在给定参数为 `μ` 和 `σ` 的高斯模型下，编码 `n` 个数据点的成本是负对数似然：\n    `DL(Data | Gaussian) = n * ln(σ) + (n/2) * ln(2π) + (1/(2σ^2)) * Σ(x_i - μ)^2`。\n\n在您的计算中，请使用以下近似值：`ln(2π) ≈ 1.838`、`ln(5) ≈ 1.609` 和 `ln(6) ≈ 1.792`。\n\n计算描述长度的差异 `DL(H1) - DL(H2)`。正值结果表示假设 H2 提供了更紧凑的描述。将您的最终答案四舍五入到三位有效数字。", "solution": "我们遵循 MDL 原则，其中\n$$\nDL(\\text{Hypothesis})=DL(\\text{Model})+DL(\\text{Data}\\mid \\text{Model}).\n$$\n对于包含 $n$ 个点的高斯分布，其模型成本为 $DL(\\text{Gaussian Params})=\\frac{k}{2}\\ln(n)$，其中 $k=2$，因此 $DL=\\ln(n)$。给定高斯分布 $N(\\mu,\\sigma^{2})$ 的数据成本为\n$$\nDL(\\text{Data}\\mid \\text{Gaussian})=n\\ln(\\sigma)+\\frac{n}{2}\\ln(2\\pi)+\\frac{1}{2\\sigma^{2}}\\sum_{i=1}^{n}(x_{i}-\\mu)^{2}.\n$$\n在最大似然估计 (MLE) 处，$\\mu$ 是样本均值，且 $\\sigma^{2}=\\frac{1}{n}\\sum_{i=1}^{n}(x_{i}-\\mu)^{2}$。记 $SS=\\sum_{i=1}^{n}(x_{i}-\\mu)^{2}$。则 $\\sigma^{2}=SS/n$ 且\n$$\nDL(\\text{Data}\\mid \\text{Gaussian MLE})=n\\ln(\\sigma)+\\frac{n}{2}\\ln(2\\pi)+\\frac{n}{2}\n=\\frac{n}{2}\\big[\\ln(2\\pi e)+\\ln(SS/n)\\big].\n$$\n我们将使用 $\\ln(2\\pi)\\approx 1.838$，因此 $\\ln(2\\pi e)=\\ln(2\\pi)+1\\approx 2.838$，以及 $\\ln(5)\\approx 1.609$，$\\ln(6)\\approx 1.792$。\n\n假设 H1：所有 $N=6$ 个点来自同一个高斯分布。数据为 $D=\\{2.1,2.9,3.1,3.3,3.5,10.0\\}$，因此 $n=6$，$\\mu_{1}=\\frac{2.1+2.9+3.1+3.3+3.5+10.0}{6}=\\frac{24.9}{6}=4.15$。离差平方为\n$$\n(2.1-4.15)^{2}=4.2025,\\quad (2.9-4.15)^{2}=1.5625,\\quad (3.1-4.15)^{2}=1.1025,\n$$\n$$\n(3.3-4.15)^{2}=0.7225,\\quad (3.5-4.15)^{2}=0.4225,\\quad (10.0-4.15)^{2}=34.2225,\n$$\n所以\n$$\nSS_{1}=4.2025+1.5625+1.1025+0.7225+0.4225+34.2225=42.235,\\quad \\frac{SS_{1}}{n}=\\frac{42.235}{6}=7.039166\\ldots\n$$\n因此\n$$\nDL(\\text{Data}\\mid H1)=\\frac{6}{2}\\big[\\,\\ln(2\\pi e)+\\ln(SS_{1}/6)\\,\\big]\n=3\\big[\\,2.838+\\ln(7.039166\\ldots)\\,\\big].\n$$\n由于 $\\ln(7.039166\\ldots)\\approx 1.95149$，可得\n$$\nDL(\\text{Data}\\mid H1)\\approx 3\\,(2.838+1.95149)=14.3685.\n$$\n模型成本为 $DL(\\text{Model}\\mid H1)=\\ln(6)=1.792$。因此\n$$\nDL(H1)=1.792+14.3685=16.1605.\n$$\n\n假设 H2：一个离群值（给定为 $10.0$）被显式编码；其余的 $n=5$ 个内点服从高斯分布。内点为 $\\{2.1,2.9,3.1,3.3,3.5\\}$，所以\n$$\n\\mu_{2}=\\frac{2.1+2.9+3.1+3.3+3.5}{5}=\\frac{14.9}{5}=2.98,\n$$\n它们的离差平方为\n$$\n(2.1-2.98)^{2}=0.7744,\\quad (2.9-2.98)^{2}=0.0064,\\quad (3.1-2.98)^{2}=0.0144,\n$$\n$$\n(3.3-2.98)^{2}=0.1024,\\quad (3.5-2.98)^{2}=0.2704,\n$$\n所以\n$$\nSS_{2}=0.7744+0.0064+0.0144+0.1024+0.2704=1.168,\\quad \\frac{SS_{2}}{5}=0.2336.\n$$\n因此\n$$\nDL(\\text{Data}\\mid H2)=\\frac{5}{2}\\big[\\,\\ln(2\\pi e)+\\ln(SS_{2}/5)\\,\\big]\n=\\frac{5}{2}\\big[\\,2.838+\\ln(0.2336)\\,\\big].\n$$\n由于 $\\ln(0.2336)\\approx -1.45414$，我们得到\n$$\nDL(\\text{Data}\\mid H2)\\approx \\frac{5}{2}\\,(2.838-1.45414)=3.45965.\n$$\nH2 的模型成本包括 5 个内点的高斯参数、从 6 个点中识别出离群值，以及显式编码成本 $C=8.0$：\n$$\nDL(\\text{Model}\\mid H2)=\\ln(5)+\\ln(6)+C=1.609+1.792+8.0=11.401.\n$$\n因此\n$$\nDL(H2)=11.401+3.45965=14.86065.\n$$\n\n所求的差值为\n$$\nDL(H1)-DL(H2)=16.1605-14.86065=1.29985\\approx 1.30\\ \\text{nats},\n$$\n这里我们按要求四舍五入到三位有效数字。正值表示 H2 提供了更紧凑的描述。", "answer": "$$\\boxed{1.30}$$", "id": "1641424"}, {"introduction": "MDL原则的应用远不止于简单的数据拟合，它在行为科学等复杂领域中也是一种强大的科学探究工具。通过观察一个玩家在一场博弈中的一系列行为，我们能否推断出其背后隐藏的策略？这项实践 [@problem_id:1641397] 让你应用MDL来比较关于智能体决策过程的两种竞争假设：一种是简单的无记忆策略，另一种是更复杂的“以牙还牙”策略。它展示了MDL如何作为一个原则性工具，帮助我们基于经验证据来评估和选择不同的科学理论。", "problem": "一位分析师正在研究一个重复策略博弈中两名参与者的行为。在每个回合中，参与者可以选择两种行动之一：合作 (C) 或背叛 (D)。该分析师试图基于一个 10 回合的序列来为参与者 2 的策略建模。已知参与者 1 所采取的行动序列为 `D, C, C, D, C, C, D, D, C, C`。观察到参与者 2 所采取的行动序列为 `C, D, C, D, D, C, C, D, D, C`。\n\n该分析师希望使用最小描述长度 (MDL) 原则来为参与者 2 的策略选择最佳模型。对于给定的模型（假设）$H$ 和数据 $D$，总描述长度由 $L(H, D) = L(H) + L(D|H)$ 给出，其中 $L(H)$ 是模型的描述长度，$L(D|H) = -\\log_2(P(D|H))$ 是给定模型下数据的描述长度。对于本问题，假设对一个通过计数 $k$ 次试验中的事件得出的概率参数进行编码的成本为 $L(H) = \\frac{1}{2}\\log_2(k)$。所有计算均使用以 2 为底的对数。\n\n该分析师考虑了两种可能的参与者 2 策略模型：\n\n**模型 1：无记忆策略者。** 参与者 2 以固定的概率 $p_C$ 选择合作 (C)，以概率 $p_D = 1-p_C$ 选择背叛 (D)，且与任何先前的行动无关。参数 $p_C$ 将使用最大似然法从观察到的参与者 2 的 10 回合行动序列中估计得出。\n\n**模型 2：噪声针锋相对 (TFT) 策略者。** 参与者 2 的第一步总是合作 (C)。对于每个后续回合 $t > 1$，参与者 2 试图采取与参与者 1 在前一回合 $t-1$ 中相同的行动。然而，这个过程是有缺陷的，参与者 2 会以一个恒定的概率 $\\epsilon$ 犯错（即，采取与 TFT 规则所指示的相反的行动）。参数 $\\epsilon$ 将使用最大似然法从观察到的数据中估计得出。\n\n根据 MDL 原则，哪个模型能更好地解释参与者 2 的观察行为？它们的近似总描述长度是多少？\n\nA. 模型 1 更优，因为其总描述长度约为 6.1 比特，而模型 2 约为 11.7 比特。\n\nB. 模型 2 更优，因为其总描述长度约为 6.1 比特，而模型 1 约为 11.7 比特。\n\nC. 模型 1 和模型 2 同等优选，因为它们的总描述长度几乎相同。\n\nD. 模型 2 更优，因为它完美地解释了数据，导致数据描述长度 $L(D|H_2)$ 为 0。\n\nE. 模型 1 更优，因为它是一个更简单的模型，具有更低的模型描述成本 $L(H_1)$。", "solution": "我们已知参与者 1 在 10 个回合中的行动为：D, C, C, D, C, C, D, D, C, C，参与者 2 的行动为：C, D, C, D, D, C, C, D, D, C。一个模型的 MDL 分数是 $L(H, D) = L(H) + L(D|H)$，其中当从 $k$ 次试验中估计单个概率参数时，$L(H) = \\frac{1}{2}\\log_{2}(k)$，并且 $L(D|H) = -\\log_{2}(P(D|H))$。\n\n模型 1（无记忆策略者）假设参与者 2 以固定概率 $p_{C}$ 采取行动 C，以 $1 - p_{C}$ 的概率采取行动 D，且各次行动独立。通过对参与者 2 的 10 次行动进行最大似然估计来估算 $p_{C}$。统计参与者 2 的行动，有 $n_{C} = 5$ 次合作和 $n_{D} = 5$ 次背叛，所以最大似然估计 (MLE) 是 $\\hat{p}_{C} = \\frac{n_{C}}{n_{C} + n_{D}} = \\frac{5}{10} = \\frac{1}{2}$。似然函数为\n$$\nP(D|\\hat{p}_{C}) = \\hat{p}_{C}^{n_{C}}(1-\\hat{p}_{C})^{n_{D}} = \\left(\\frac{1}{2}\\right)^{10}.\n$$\n因此，\n$$\nL(D|H_{1}) = -\\log_{2}\\left[\\left(\\frac{1}{2}\\right)^{10}\\right] = 10.\n$$\n模型描述长度使用 $k = 10$ 次试验：\n$$\nL(H_{1}) = \\frac{1}{2}\\log_{2}(10).\n$$\n所以，\n$$\nL(H_{1}, D) = 10 + \\frac{1}{2}\\log_{2}(10) \\approx 10 + 1.660964 \\approx 11.661 \\text{ 比特} \\approx 11.7 \\text{ 比特}.\n$$\n\n模型 2（噪声针锋相对）假设第一个行动确定为 C，并且对于 $t>1$，试图复制参与者 1 在时刻 $t-1$ 的行动，但会以概率 $\\epsilon$ 翻转该行动。参数 $\\epsilon$ 是从 $k=9$ 次试验（回合 $t=2$ 到 $t=10$）中估计的。对于每个 $t=2,\\dots,10$，预测的行动是参与者 1 在 $t-1$ 时的行动。\n\n我们比较从 $t=2$ 到 $t=10$ 的预测行动与观察到的行动：\n- $t=2$：预测 D，观察到 D (正确)；\n- $t=3$：预测 C，观察到 C (正确)；\n- $t=4$：预测 C，观察到 D (错误)；\n- $t=5$：预测 D，观察到 D (正确)；\n- $t=6$：预测 C，观察到 C (正确)；\n- $t=7$：预测 C，观察到 C (正确)；\n- $t=8$：预测 D，观察到 D (正确)；\n- $t=9$：预测 D，观察到 D (正确)；\n- $t=10$：预测 C，观察到 C (正确)。\n\n在 $k=9$ 次试验中，有 $m=1$ 次错误和 8 次正确，因此最大似然估计 (MLE) 是 $\\hat{\\epsilon} = \\frac{m}{k} = \\frac{1}{9}$。根据该模型，第一步行动 C 是确定性的，并且与数据相符，其贡献的概率为 1。所以，\n$$\nP(D|H_{2}, \\hat{\\epsilon}) = (1-\\hat{\\epsilon})^{8}\\hat{\\epsilon}^{1} = \\left(\\frac{8}{9}\\right)^{8}\\left(\\frac{1}{9}\\right),\n$$\n并且\n$$\nL(D|H_{2}) = -\\log_{2}\\left[\\left(\\frac{8}{9}\\right)^{8}\\left(\\frac{1}{9}\\right)\\right] = -8\\log_{2}\\left(\\frac{8}{9}\\right) - \\log_{2}\\left(\\frac{1}{9}\\right) = 8\\log_{2}\\left(\\frac{9}{8}\\right) + \\log_{2}(9).\n$$\n数值上，$\\log_{2}(9) \\approx 3.169925$ 并且 $\\log_{2}\\left(\\frac{9}{8}\\right) = \\log_{2}(9) - \\log_{2}(8) \\approx 3.169925 - 3 = 0.169925$，所以\n$$\nL(D|H_{2}) \\approx 8 \\times 0.169925 + 3.169925 \\approx 4.529325 \\text{ 比特}.\n$$\n从 $k=9$ 次试验中估计一个参数的模型描述长度是\n$$\nL(H_{2}) = \\frac{1}{2}\\log_{2}(9) \\approx 1.584963.\n$$\n所以，\n$$\nL(H_{2}, D) = \\frac{1}{2}\\log_{2}(9) + 8\\log_{2}\\left(\\frac{9}{8}\\right) + \\log_{2}(9) \\approx 1.584963 + 4.529325 \\approx 6.114288 \\text{ 比特} \\approx 6.1 \\text{ 比特}.\n$$\n\n比较总长度，$L(H_{1}, D) \\approx 11.7$ 比特，$L(H_{2}, D) \\approx 6.1$ 比特，因此模型 2 提供了更好的 MDL 解释。这与选项 B 相符。注意，模型 2 并未完美解释数据，因为存在一次错误，所以 $L(D|H_{2}) \\neq 0$。", "answer": "$$\\boxed{B}$$", "id": "1641397"}]}