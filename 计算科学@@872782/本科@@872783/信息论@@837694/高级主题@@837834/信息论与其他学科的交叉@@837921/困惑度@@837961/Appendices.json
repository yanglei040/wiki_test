{"hands_on_practices": [{"introduction": "理解困惑度最直观的方式，是从所有选项完全等可能性的情况入手。这个练习模拟了一个常见的安全问题——猜测一个有特定规则的PIN码。通过计算这种均匀分布下的困惑度，你将亲手验证一个核心概念：当不确定性最大化时，困惑度就等于可能选项的总数。[@problem_id:1646104]", "problem": "一位安全分析师正在研究 4 位个人识别码 (PIN) 的模式。PIN 是一个由四位数字组成的有序序列，其中每一位数字都是 0 到 9 之间的整数（含 0 和 9）。分析师对一种常见的用户行为进行建模，即用户会避免在某一位数字出现后立即重复使用它。例如，在此模型下，像 '3435' 这样的 PIN 被认为是有效的，但 '3345' 和 '3445' 则不是。\n\n假设所有满足此非连续重复规则的 4 位 PIN 被选择的概率均等，那么在所有可能的 PIN 集合上，由此产生的概率分布的困惑度是多少？\n\n以单个整数形式提供答案。", "solution": "4 位 PIN 是一个有序的四元组，其数字来自集合 $\\{0,1,2,\\dots,9\\}$。非连续重复规则要求，对于每个位置 $i \\in \\{2,3,4\\}$，位置 $i$ 上的数字不能与位置 $i-1$ 上的数字相同。\n\n计算有效 PIN 的数量：\n- 第一位数字有 $10$ 种选择。\n- 对于每个后续数字，有 $9$ 种选择（除了紧邻的前一位数字之外的任何数字）。\n因此，有效 PIN 的总数为\n$$\nN = 10 \\times 9^{3}.\n$$\n明确地计算这个值：\n$$\nN = 10 \\times 729 = 7290.\n$$\n\n熵为 $H$（单位为比特）的分布的困惑度定义为 $2^{H}$。对于 $N$ 个结果上的均匀分布，\n$$\nH = \\log_{2}(N) \\quad \\Rightarrow \\quad \\text{perplexity} = 2^{H} = 2^{\\log_{2}(N)} = N.\n$$\n因此，困惑度等于有效 PIN 的数量，即 $7290$。", "answer": "$$\\boxed{7290}$$", "id": "1646104"}, {"introduction": "现实世界中的概率分布很少是均匀的，尤其是在语言处理中，某些字符或单词的出现频率远高于其他。这个练习将带你分析一个简化的字符预测模型，该模型根据观测频率赋予了不同字符不同的概率。通过计算这个非均匀分布的困惑度，你将掌握其核心计算方法，并体会概率分布如何影响不确定性的大小。[@problem_id:1646124]", "problem": "一位计算机科学家正在分析一个简化的字符级预测模型。该模型的目的是根据训练语料库的统计数据来预测序列中的下一个字符。在观察到特定的字符序列后，模型会查询其训练数据，并找到在此上下文中先前出现过的字符的频率如下：\n- 字符 'a' 出现了 125 次。\n- 字符 'e' 出现了 125 次。\n- 字符 'i' 出现了 60 次。\n- 字符 'o' 出现了 60 次。\n- 字符 'u' 出现了 30 次。\n\n该模型定义下一个字符为特定字符的概率与其观察到的频率成正比。任何不在上述列表中的字符出现的概率为零。根据此概率分布，计算该模型预测的困惑度。\n\n在所有对数计算中使用自然对数。将最终答案表示为四舍五入到三位有效数字的数值。", "solution": "该模型分配的概率与观察到的频率成正比。设计数为 $f_{a}=125$，$f_{e}=125$，$f_{i}=60$，$f_{o}=60$，$f_{u}=30$。总计数为\n$$\nF=\\sum f=125+125+60+60+30=400.\n$$\n因此，概率为\n$$\np(a)=\\frac{125}{400}=\\frac{5}{16},\\quad p(e)=\\frac{5}{16},\\quad p(i)=\\frac{60}{400}=\\frac{3}{20},\\quad p(o)=\\frac{3}{20},\\quad p(u)=\\frac{30}{400}=\\frac{3}{40}.\n$$\n使用自然对数的单步预测分布的困惑度定义为\n$$\n\\mathrm{PP}=\\exp\\!\\left(H\\right),\\quad H=-\\sum_{x}p(x)\\ln p(x).\n$$\n计算熵：\n$$\nH=-\\Bigg[2\\cdot\\frac{5}{16}\\ln\\!\\left(\\frac{5}{16}\\right)+2\\cdot\\frac{3}{20}\\ln\\!\\left(\\frac{3}{20}\\right)+\\frac{3}{40}\\ln\\!\\left(\\frac{3}{40}\\right)\\Bigg].\n$$\n用数值方法计算对数和乘积（使用 $\\ln$）：\n$$\nH\\approx -\\Big[2\\cdot 0.3125\\cdot(-1.1631508098)+2\\cdot 0.15\\cdot(-1.8971199849)+0.075\\cdot(-2.5902671654)\\Big]\\approx 1.4903752890.\n$$\n因此困惑度为\n$$\n\\mathrm{PP}=\\exp(H)\\approx \\exp(1.4903752890)\\approx 4.4387610695.\n$$\n四舍五入到三位有效数字，困惑度为 $4.44$。", "answer": "$$\\boxed{4.44}$$", "id": "1646124"}, {"introduction": "让我们将困惑度的应用推向一个更接近现实的场景。这个练习构建了一个关于英文单词首字母的统计模型，它比简单的频率统计更具结构性。你的任务是评估这个模型的困惑度，并将其与字母表的总大小进行比较，从而深刻理解困惑度如何量化一个概率分布的“有效选项数量”，揭示为何一个拥有26个可能结果的系统，其不确定性可能远低于26。[@problem_id:1646140]", "problem": "为尝试对英语的统计特性建模，一位语言学家提出了一个用于随机选择的单词首字母的简化概率分布。该模型考虑了标准的26个英文字母，并将这些字母分为三个不同的频率组：\n\n1.  **高频组**：包含4个特定字母。一个单词以这些字母中任意一个开头的概率为 $p_1 = 0.10$。\n2.  **中频组**：包含10个特定字母。一个单词以这些字母中任意一个开头的概率为 $p_2 = 0.04$。\n3.  **低频组**：包含余下的12个字母。一个单词以这些字母中任意一个开头的概率为 $p_3 = 1/60$。\n\n设 $X$ 是根据此模型抽取的单词首字母的随机变量。随机变量 $X$ 的困惑度，记作 $PP(X)$，衡量了在猜测 $X$ 的值时所拥有的有效选择数。\n\n根据此模型，计算该分布的困惑度。下列哪个值最接近您的结果？\n\nA. 4.4\n\nB. 10.1\n\nC. 20.7\n\nD. 26.0", "solution": "困惑度定义为香农熵的指数。在语言模型中，通常使用以2为底的熵，因此 $PP(X) = 2^{H_{2}(X)}$，其中 $H_{2}(X) = -\\sum_{x} p(x)\\log_{2} p(x)$。\n\n有4个字母，每个的概率为 $p_{1}=\\frac{1}{10}$；10个字母，每个的概率为 $p_{2}=\\frac{1}{25}$；以及12个字母，每个的概率为 $p_{3}=\\frac{1}{60}$。将相同的项分组后，以比特为单位的熵为\n$$\nH_{2}(X)=-4\\cdot \\frac{1}{10}\\log_{2}\\!\\left(\\frac{1}{10}\\right)-10\\cdot \\frac{1}{25}\\log_{2}\\!\\left(\\frac{1}{25}\\right)-12\\cdot \\frac{1}{60}\\log_{2}\\!\\left(\\frac{1}{60}\\right).\n$$\n使用 $\\log_{2}(1/a)=-\\log_{2}a$ 并化简系数可得，\n$$\nH_{2}(X)=\\frac{2}{5}\\log_{2} 10+\\frac{2}{5}\\log_{2} 25+\\frac{1}{5}\\log_{2} 60\n=\\frac{1}{5}\\log_{2}\\!\\left(10^{2}\\cdot 25^{2}\\cdot 60\\right)\n=\\frac{1}{5}\\log_{2}(3750000).\n$$\n因此，\n$$\nPP(X)=2^{H_{2}(X)}=2^{\\frac{1}{5}\\log_{2}(3750000)}=3750000^{1/5}.\n$$\n为了与给定选项进行比较，我们近似计算其五次方根：因为 $20^{5}=3200000$，我们有\n$$\nPP(X)=3750000^{1/5}\\approx 20\\cdot \\left(\\frac{3750000}{3200000}\\right)^{1/5}\\approx 20\\cdot 1.032\\approx 20.64,\n$$\n该值最接近 $20.7$。\n\n因此，正确选项是C。", "answer": "$$\\boxed{C}$$", "id": "1646140"}]}