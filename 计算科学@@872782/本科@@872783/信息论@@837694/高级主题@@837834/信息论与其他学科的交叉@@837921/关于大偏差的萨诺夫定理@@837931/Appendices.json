{"hands_on_practices": [{"introduction": "我们从一个直观的例子开始，将基本的概率计算与大偏差理论联系起来。这个练习探讨了一个非常罕见的事件：在一个很长的序列中完全没有观察到某个特定符号。通过直接计算其概率并将其与萨诺夫定理的指数形式进行比较，我们可以为更抽象的大偏差率函数建立一个坚实的、可触摸的基础。这个练习 [@problem_id:1655867] 旨在展示大偏差理论如何为我们已经熟悉的概率概念提供一个更普适的框架。", "problem": "考虑一个信源，它生成一个符号序列 $X_1, X_2, \\ldots, X_n$，这些符号是独立同分布 (i.i.d.) 的。这些符号从一个有限字母表 $\\mathcal{X} = \\{x_1, x_2, \\ldots, x_K\\}$ 中抽取，其中 $K \\ge 2$。对任意 $i$，生成符号 $x_k$ 的概率由 $p_k = \\text{Pr}(X_i = x_k)$ 给出。给定对于所有的 $k \\in \\{1, 2, \\ldots, K\\}$，都有 $p_k > 0$。\n\n对于一个长度为 $n$ 的很长序列，符号 $x_k$ 的经验频率是它在该序列中出现的次数所占的比例。特定符号 $x_K$ 的经验频率恰好为零的概率是一个罕见事件。当 $n$ 很大时，这个概率可以很好地用以下形式近似：\n$$ \\text{Pr}(\\text{符号 } x_K \\text{ 的经验频率为 } 0) \\approx \\exp(-nC) $$\n其中 $C$ 是一个依赖于信源概率的正常数。\n\n确定常数 $C$，并用概率 $p_K$ 给出其解析表达式。", "solution": "设 $X_{1},\\ldots,X_{n}$ 是在 $\\mathcal{X}$ 上的独立同分布随机变量，且 $\\text{Pr}(X_{i}=x_{K})=p_{K}$ 以及 $0  p_K  1$。\n事件“符号 $x_K$ 的经验频率恰好为零”等同于在 $n$ 次试验中，符号 $x_K$ 一次也没有出现。\n对于单次试验，不出现 $x_K$ 的概率是 $1 - p_K$。\n由于所有试验都是独立同分布的，所以在 $n$ 次试验中一次也不出现 $x_K$ 的概率是 $(1 - p_K)^n$。\n我们将这个概率写成指数形式：\n$$ \\text{Pr}(\\text{符号 } x_K \\text{ 的经验频率为 } 0) = (1-p_K)^n = \\exp(n \\ln(1-p_K)) $$\n与题目中给出的形式 $\\exp(-nC)$ 进行比较，我们得到：\n$$ -nC = n \\ln(1-p_K) $$\n因此，常数 $C$ 是：\n$$ C = -\\ln(1-p_K) $$", "answer": "$$\\boxed{-\\ln(1-p_{K})}$$", "id": "1655867"}, {"introduction": "在掌握了基本直觉之后，我们现在转向一个更典型的应用，直接使用库尔贝克-莱布勒（KL）散度公式来计算率函数。本练习 [@problem_id:1655921] 考虑了一个有偏的二元信源，并要求我们计算观察到两种结果数量完全相等的概率的指数衰减率。这个练习将帮助你熟练掌握将一个具体的稀有事件转化为经验分布，并应用萨诺夫定理的核心公式进行计算的关键技能。", "problem": "一家工厂生产大量微芯片。由于存在持续的制造缺陷，每个芯片有 $p = 1/3$ 的概率是次品。质量控制过程包括测试一长串随机抽取的 $n$ 个芯片。测试结果被认为是独立同分布 (i.i.d.) 的随机变量。\n\n设 $N_G$ 为测试序列中好芯片的数量，$N_F$ 为次品芯片的数量，序列长度为 $n$。对于非常大量的测试芯片（即，当 $n \\to \\infty$ 时），观测到的次品芯片比例 $N_F/n$ 显著偏离真实概率 $p$ 的概率，已知遵循大偏差原理（Large Deviation Principle）。这意味着观测到一个不寻常事件的概率随 $n$ 指数衰减：\n$$P(\\text{event}) \\approx \\exp(-nI)$$\n其中 $I$ 是一个称为速率函数（rate function）的正定常数，其值取决于具体事件。\n\n考虑事件：序列中好芯片的数量与次品芯片的数量完全相等。计算此事件的速率函数 $I$ 的值。请以单一的、闭合形式的解析表达式给出你的答案。", "solution": "令 $X_{i} \\in \\{0,1\\}$ 表示第 $i$ 个测试的芯片是否为次品，其中 $P(X_{i}=1)=p=\\frac{1}{3}$ 且 $P(X_{i}=0)=1-p=\\frac{2}{3}$。总和 $S_{n}=\\sum_{i=1}^{n}X_{i}=N_{F}$ 是次品芯片的数量，事件 $N_{G}=N_{F}$ 等价于（对于偶数 $n$）$S_{n}=\\frac{n}{2}$，即经验比例 $\\hat{q}_{n}=S_{n}/n$ 等于 $q=\\frac{1}{2}$。\n\n根据克拉默定理（或适用于伯努利测度的萨诺夫定理），经验均值 $\\hat{q}_{n}$ 满足一个大偏差原理，其良速率函数 (good rate function) 为\n$$\nI(q)=\\sup_{t \\in \\mathbb{R}}\\{tq-\\Lambda(t)\\},\\qquad \\Lambda(t)=\\ln\\big((1-p)+p\\exp(t)\\big).\n$$\n为了计算 $I(q)$，我们需要最大化 $tq-\\Lambda(t)$。一阶条件是\n$$\n0=\\frac{\\partial}{\\partial t}\\big(tq-\\Lambda(t)\\big)=q-\\Lambda'(t),\\qquad \\Lambda'(t)=\\frac{p\\exp(t)}{(1-p)+p\\exp(t)}.\n$$\n求解 $q=\\Lambda'(t)$ 得\n$$\nq=\\frac{p\\exp(t)}{(1-p)+p\\exp(t)}\\;\\;\\Longrightarrow\\;\\;\\exp(t^{\\ast})=\\frac{q(1-p)}{(1-q)p}.\n$$\n在 $t^{\\ast}$ 处计算上确界：\n$$\nI(q)=q\\,t^{\\ast}-\\Lambda(t^{\\ast})\n= q\\ln\\!\\left(\\frac{q(1-p)}{(1-q)p}\\right) - \\ln\\!\\left((1-p)+p\\frac{q(1-p)}{(1-q)p}\\right).\n$$\n由于 $(1-p)+p\\frac{q(1-p)}{(1-q)p}=\\frac{1-p}{1-q}$，该式可简化为库尔贝克-莱布勒散度\n$$\nI(q)=q\\ln\\!\\left(\\frac{q}{p}\\right) + (1-q)\\ln\\!\\left(\\frac{1-q}{1-p}\\right).\n$$\n对于事件 $N_{G}=N_{F}$，我们有 $q=\\frac{1}{2}$ 和 $p=\\frac{1}{3}$，因此\n$$\nI= \\frac{1}{2}\\ln\\!\\left(\\frac{\\frac{1}{2}}{\\frac{1}{3}}\\right) + \\frac{1}{2}\\ln\\!\\left(\\frac{\\frac{1}{2}}{\\frac{2}{3}}\\right)\n= \\frac{1}{2}\\left[\\ln\\!\\left(\\frac{3}{2}\\right) + \\ln\\!\\left(\\frac{3}{4}\\right)\\right]\n= \\frac{1}{2}\\ln\\!\\left(\\frac{9}{8}\\right).\n$$\n该速率决定了对于偶数 $n$ 的 $P(N_{F}=n/2)$；对于奇数 $n$ 该事件不可能发生，但这不影响沿偶数子序列的指数率。", "answer": "$$\\boxed{\\frac{1}{2}\\ln\\!\\left(\\frac{9}{8}\\right)}$$", "id": "1655921"}, {"introduction": "最后，我们来解决一个更复杂的问题，它真正展示了萨诺夫定理的强大之处和其应用的深度。在这个练习中，稀有事件不再由简单的频率来定义，而是由经验分布的一个内在属性——熵——来界定 [@problem_id:1655900]。你需要确定当一个序列的经验熵超过某个特定阈值时的概率衰减率，这要求你不仅要最小化KL散度，还要理解熵函数与经验频率之间的关系，这体现了收缩原理（Contraction Principle）的思想。", "problem": "考虑一个以独立同分布 (i.i.d.) 方式生成二进制数字（比特）序列的源。生成“1”的概率为 $p = 1/4$，生成“0”的概率为 $1-p = 3/4$。对于一个长度为 $N$ 的长比特序列，令 $\\hat{p}$ 表示“1”的经验频率（即序列中“1”的数量除以 $N$）。该序列的经验熵由 $H(\\hat{p}) = -\\hat{p} \\log_2(\\hat{p}) - (1-\\hat{p})\\log_2(1-\\hat{p})$ 给出。\n\n我们关心一个特定大偏差事件的概率：即序列的经验熵 $H(\\hat{p})$ 大于或等于另一个以 $1/3$ 概率产生“1”的二进制源的熵的事件。\n\n根据大偏差理论，对于非常大的 $N$，该事件的概率 $P_N$ 可以近似为 $P_N \\approx \\exp(-N \\cdot I)$，其中 $I$ 是一个正常数，称为率函数或大偏差指数。\n\n确定该指数 $I$ 的精确值。你的答案应该是一个包含自然对数 ($\\ln$) 的闭式解析表达式。", "solution": "该源是真实参数为 $p=1/4$ 的独立同分布伯努利源。令 $q$ 表示一个通用的经验频率。关于经验分布的大偏差原理（萨诺夫定理）指出，对于一个经验测度集合 $A$，\n$$\n\\Pr(\\hat{p} \\in A) \\approx \\exp\\!\\left(-N \\inf_{q \\in A} D(q||p)\\right),\n$$\n其中对于伯努利分布\n$$\nD(q||p) = q \\ln\\!\\left(\\frac{q}{p}\\right) + (1-q)\\ln\\!\\left(\\frac{1-q}{1-p}\\right).\n$$\n\n我们感兴趣的事件是 $H(\\hat{p}) \\geq H(1/3)$，其中 $H$ 是以 2 为底的对数定义的。由于改变对数底数相当于将熵乘以一个正常数 $1/\\ln 2$，不等式 $H(\\hat{p}) \\geq H(1/3)$ 等价于 $H_{e}(\\hat{p}) \\geq H_{e}(1/3)$，其中 $H_{e}(q) = -q \\ln q - (1-q)\\ln(1-q)$。因为 $H_{e}(q)$ 关于 $q=1/2$ 对称，并且在 $[0,1/2]$ 上严格递增，所以约束 $H_{e}(q) \\geq H_{e}(1/3)$ 等价于 $q \\in [1/3,\\,2/3]$。\n\n因此，根据萨诺夫定理和压缩原理，大偏差指数为\n$$\nI = \\inf_{q \\in [1/3,\\,2/3]} D(q||1/4).\n$$\n函数 $D(q||1/4)$ 是关于 $q$ 的凸函数，在 $q=1/4$ 处有唯一的全局最小值，该点位于 $[1/3,\\,2/3]$ 之外。因此，该区间上的下确界在最接近 $1/4$ 的边界点取得，即 $q^{\\star}=1/3$。于是\n$$\nI = D\\!\\left(\\frac{1}{3}||\\frac{1}{4}\\right)\n= \\frac{1}{3}\\ln\\!\\left(\\frac{1/3}{1/4}\\right) + \\frac{2}{3}\\ln\\!\\left(\\frac{1-1/3}{1-1/4}\\right)\n= \\frac{1}{3}\\ln\\!\\left(\\frac{4}{3}\\right) + \\frac{2}{3}\\ln\\!\\left(\\frac{8}{9}\\right).\n$$\n合并各项，\n$$\nI = \\frac{1}{3}\\big(2\\ln 2 - \\ln 3\\big) + \\frac{2}{3}\\big(3\\ln 2 - 2\\ln 3\\big)\n= \\frac{8}{3}\\ln 2 - \\frac{5}{3}\\ln 3\n= \\frac{1}{3}\\ln\\!\\left(\\frac{256}{243}\\right).\n$$\n这就是精确的大偏差指数。", "answer": "$$\\boxed{\\frac{1}{3}\\ln\\!\\left(\\frac{256}{243}\\right)}$$", "id": "1655900"}]}