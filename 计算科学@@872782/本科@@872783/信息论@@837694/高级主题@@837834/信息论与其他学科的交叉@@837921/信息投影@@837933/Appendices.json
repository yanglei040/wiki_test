{"hands_on_practices": [{"introduction": "信息投影的基本思想是在满足新信息（约束）的前提下，找到一个与我们先验知识“最接近”的概率分布。这个练习提供了一个经典的场景：我们有一个关于骰子点数的已知概率分布，现在需要根据一个关于偶数点数概率的新约束来更新它。通过这个练习，你将掌握使用拉格朗日乘数法求解此类问题的核心技巧。", "problem": "一位工程师正在为一个加权的六面骰子建模。其结果 $\\{1, 2, 3, 4, 5, 6\\}$ 的概率分布，记为 $Q$，被发现是非均匀的。各概率如下所示：$Q(1) = 1/12$，$Q(2) = 1/6$，$Q(3) = 1/12$，$Q(4) = 1/3$，$Q(5) = 1/12$，$Q(6) = 1/4$。\n\n该工程师需要为同一个骰子找到一个新的理论概率分布 $P$，使其尽可能“接近”$Q$，同时满足一个新的设计约束。该约束是掷出偶数（结果在集合 $\\{2, 4, 6\\}$ 中）的总概率必须恰好为 $1/3$。\n\n两个分布 $P$ 和 $Q$ 之间的“接近度”通过库尔贝克-莱布勒（KL）散度来衡量，其定义为 $D_{KL}(P || Q) = \\sum_{i=1}^6 P(i) \\ln \\left(\\frac{P(i)}{Q(i)}\\right)$，其中 $\\ln$ 表示自然对数。您的任务是找到在给定约束条件下最小化此散度的分布 $P$。\n\n确定新分布的六个概率，$P(1)$ 到 $P(6)$。将您的答案表示为一个包含六个概率的行矩阵 $[P(1), P(2), P(3), P(4), P(5), P(6)]$，每个概率都以精确分数形式给出。", "solution": "问题是找到一个概率分布 $P = (p_1, p_2, p_3, p_4, p_5, p_6)$，使其与给定分布 $Q = (q_1, q_2, q_3, q_4, q_5, q_6)$ 的库尔贝克-莱布勒（KL）散度最小，同时满足某些约束条件。\n\n需要最小化的目标函数是 KL 散度：\n$$ D_{KL}(P || Q) = \\sum_{i=1}^{6} p_i \\ln\\left(\\frac{p_i}{q_i}\\right) $$\n给定的分布是 $Q = (1/12, 2/12, 1/12, 4/12, 1/12, 3/12) = (1/12, 1/6, 1/12, 1/3, 1/12, 1/4)$。\n\n分布 $P$ 有两个约束条件：\n1.  所有概率之和必须为 1：$\\sum_{i=1}^{6} p_i = 1$。\n2.  偶数结果的概率之和必须为 $1/3$：$p_2 + p_4 + p_6 = 1/3$。\n\n这是一个约束优化问题，可以使用拉格朗日乘数法解决。我们定义拉格朗日函数 $\\mathcal{L}$：\n$$ \\mathcal{L}(p_1, \\dots, p_6, \\lambda_0, \\lambda_1) = \\sum_{i=1}^{6} p_i \\ln\\left(\\frac{p_i}{q_i}\\right) - \\lambda_0 \\left(\\sum_{i=1}^{6} p_i - 1\\right) - \\lambda_1 \\left(p_2 + p_4 + p_6 - \\frac{1}{3}\\right) $$\n为了找到最小值，我们将 $\\mathcal{L}$ 对每个 $p_k$ 的偏导数设为零。\n$$ \\frac{\\partial \\mathcal{L}}{\\partial p_k} = \\frac{\\partial}{\\partial p_k} \\left(p_k \\ln p_k - p_k \\ln q_k\\right) - \\lambda_0 - \\lambda_1 \\delta_{k \\in E} = 0 $$\n其中 $E = \\{2, 4, 6\\}$ 是偶数结果的集合，$\\delta_{k \\in E}$ 是克罗内克 delta，如果 $k \\in E$ 则为 1，否则为 0。\n\n导数为：\n$$ (\\ln p_k + 1) - \\ln q_k - \\lambda_0 - \\lambda_1 \\delta_{k \\in E} = 0 $$\n$$ \\ln\\left(\\frac{p_k}{q_k}\\right) = \\lambda_0 - 1 + \\lambda_1 \\delta_{k \\in E} $$\n求解 $p_k$：\n$$ p_k = q_k \\exp(\\lambda_0 - 1 + \\lambda_1 \\delta_{k \\in E}) $$\n我们可以将其重写为更方便的形式。令 $C_0 = \\exp(\\lambda_0 - 1)$ 和 $C_1 = \\exp(\\lambda_1)$。那么解的形式为：\n- 对于奇数结果（$k \\in \\{1, 3, 5\\}$）：$p_k = q_k C_0 \\exp(0) = C_0 q_k$。\n- 对于偶数结果（$k \\in \\{2, 4, 6\\}$）：$p_k = q_k C_0 \\exp(\\lambda_1) = C_0 C_1 q_k$。\n\n现在我们使用约束条件来找到常数 $C_0$ 和 $C_1$。\n首先，我们计算原始分布 $Q$ 中奇数和偶数结果的概率之和。\n奇数结果之和：$Q_{odd} = q_1 + q_3 + q_5 = \\frac{1}{12} + \\frac{1}{12} + \\frac{1}{12} = \\frac{3}{12} = \\frac{1}{4}$。\n偶数结果之和：$Q_{even} = q_2 + q_4 + q_6 = \\frac{2}{12} + \\frac{4}{12} + \\frac{3}{12} = \\frac{9}{12} = \\frac{3}{4}$。\n\n现在我们将约束条件应用于 $P$：\n约束 2：$p_2 + p_4 + p_6 = 1/3$。\n$$ \\sum_{k \\in E} p_k = \\sum_{k \\in E} C_0 C_1 q_k = C_0 C_1 \\sum_{k \\in E} q_k = C_0 C_1 Q_{even} = \\frac{1}{3} $$\n代入 $Q_{even}$ 的值：\n$$ C_0 C_1 \\left(\\frac{3}{4}\\right) = \\frac{1}{3} \\implies C_0 C_1 = \\frac{4}{9} $$\n\n约束 1：$\\sum_{k=1}^{6} p_k = 1$。\n$$ \\sum_{k=1}^{6} p_k = \\sum_{k \\in \\{1,3,5\\}} p_k + \\sum_{k \\in \\{2,4,6\\}} p_k = 1 $$\n根据约束 2，第二个和为 $1/3$。第一个和是：\n$$ \\sum_{k \\in \\{1,3,5\\}} p_k = \\sum_{k \\in \\{1,3,5\\}} C_0 q_k = C_0 \\sum_{k \\in \\{1,3,5\\}} q_k = C_0 Q_{odd} $$\n因此第一个约束变为：\n$$ C_0 Q_{odd} + \\frac{1}{3} = 1 $$\n代入 $Q_{odd}$ 的值：\n$$ C_0 \\left(\\frac{1}{4}\\right) + \\frac{1}{3} = 1 \\implies \\frac{C_0}{4} = 1 - \\frac{1}{3} = \\frac{2}{3} \\implies C_0 = \\frac{8}{3} $$\n现在我们可以使用 $C_0 C_1 = 4/9$ 来找到 $C_1$：\n$$ \\left(\\frac{8}{3}\\right) C_1 = \\frac{4}{9} \\implies C_1 = \\frac{4}{9} \\times \\frac{3}{8} = \\frac{12}{72} = \\frac{1}{6} $$\n\n有了 $C_0 = 8/3$ 和 $C_0 C_1 = 4/9$，我们可以求出每个概率 $p_k$：\n对于奇数 $k \\in \\{1, 3, 5\\}$：$p_k = C_0 q_k = \\frac{8}{3} q_k$。\n$p_1 = \\frac{8}{3} \\times \\frac{1}{12} = \\frac{8}{36} = \\frac{2}{9}$。\n$p_3 = \\frac{8}{3} \\times \\frac{1}{12} = \\frac{8}{36} = \\frac{2}{9}$。\n$p_5 = \\frac{8}{3} \\times \\frac{1}{12} = \\frac{8}{36} = \\frac{2}{9}$。\n\n对于偶数 $k \\in \\{2, 4, 6\\}$：$p_k = (C_0 C_1) q_k = \\frac{4}{9} q_k$。\n$p_2 = \\frac{4}{9} \\times q_2 = \\frac{4}{9} \\times \\frac{1}{6} = \\frac{4}{54} = \\frac{2}{27}$。\n$p_4 = \\frac{4}{9} \\times q_4 = \\frac{4}{9} \\times \\frac{1}{3} = \\frac{4}{27}$。\n$p_6 = \\frac{4}{9} \\times q_6 = \\frac{4}{9} \\times \\frac{1}{4} = \\frac{1}{9}$。\n\n让我们检查最终的分布 $P$：\n$p_1+p_2+p_3+p_4+p_5+p_6 = \\frac{2}{9} + \\frac{2}{27} + \\frac{2}{9} + \\frac{4}{27} + \\frac{2}{9} + \\frac{1}{9}$\n$= \\frac{6}{27} + \\frac{2}{27} + \\frac{6}{27} + \\frac{4}{27} + \\frac{6}{27} + \\frac{3}{27} = \\frac{6+2+6+4+6+3}{27} = \\frac{27}{27} = 1$。和为 1。\n$p_2+p_4+p_6 = \\frac{2}{27} + \\frac{4}{27} + \\frac{1}{9} = \\frac{2}{27} + \\frac{4}{27} + \\frac{3}{27} = \\frac{9}{27} = \\frac{1}{3}$。约束得到满足。\n\n最终的分布是 $P = (2/9, 2/27, 2/9, 4/27, 2/9, 1/9)$。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{2}{9} & \\frac{2}{27} & \\frac{2}{9} & \\frac{4}{27} & \\frac{2}{9} & \\frac{1}{9} \\end{pmatrix}}$$", "id": "1631738"}, {"introduction": "在基础练习之上，我们来探讨一种更常见的约束形式：累积概率。在数据分析中，我们常常获得关于某个变量小于或大于某值的概率信息。这个练习将展示如何将一个均匀先验分布投影到一个满足累积概率约束的集合上，并揭示出信息投影一个有趣的特性——解常常会呈现出与约束相关的分段结构。", "problem": "一个数据采集系统监测一个过程，该过程可以占据十个离散能态中的一个，这些能态由集合 $S = \\{1, 2, \\ldots, 10\\}$ 中的整数标记。最初，根据最大熵原理，我们用均匀概率分布 $Q$ 来为该系统建模，其中对于每个状态 $x \\in S$，$Q(x) = 1/10$。一次更新的测量提供了一条新信息：系统处于状态 $x \\le 3$ 的累积概率恰好为 0.5。我们需要找到一个新的概率分布 $P$，它既要包含这个约束条件，又要尽可能地接近我们原始的均匀模型 $Q$。\n\n在信息论中，这个“最接近”的分布是指从 $Q$ 到 $P$ 的 Kullback-Leibler (KL) 散度（也称为相对熵）最小的那个分布。KL 散度由下式给出：\n$$D_{KL}(P || Q) = \\sum_{x \\in S} P(x) \\ln\\left(\\frac{P(x)}{Q(x)}\\right)$$\n找出在给定约束条件下最小化此散度的概率分布 $P$。根据此分布，确定概率 $P(X=1)$。将你的最终答案四舍五入到四位有效数字。", "solution": "我们必须在约束条件 $\\sum_{x\\in S}P(x)=1$ 和 $\\sum_{x\\leq 3}P(x)=0.5$ 下，最小化 Kullback-Leibler 散度\n$$D_{KL}(P||Q)=\\sum_{x\\in S} P(x)\\ln\\!\\left(\\frac{P(x)}{Q(x)}\\right)$$\n其中对于所有 $x\\in S=\\{1,2,\\ldots,10\\}$，$Q(x)=\\frac{1}{10}$。\n\n分别为归一化和累积约束引入拉格朗日乘子 $\\alpha$ 和 $\\beta$，并构造拉格朗日函数\n$$\\mathcal{L}=\\sum_{x\\in S} P(x)\\ln\\!\\left(\\frac{P(x)}{Q(x)}\\right)+\\alpha\\left(\\sum_{x\\in S}P(x)-1\\right)+\\beta\\left(\\sum_{x\\leq 3}P(x)-0.5\\right).$$\n对 $P(x)$ 求导并令其为零，得到两种情况：\n- 对于 $x\\leq 3$，\n$$\\frac{\\partial \\mathcal{L}}{\\partial P(x)}=\\ln\\!\\left(\\frac{P(x)}{Q(x)}\\right)+1+\\alpha+\\beta=0 \\quad\\Rightarrow\\quad P(x)=Q(x)\\exp(-1-\\alpha-\\beta).$$\n- 对于 $x>3$，\n$$\\frac{\\partial \\mathcal{L}}{\\partial P(x)}=\\ln\\!\\left(\\frac{P(x)}{Q(x)}\\right)+1+\\alpha=0 \\quad\\Rightarrow\\quad P(x)=Q(x)\\exp(-1-\\alpha).$$\n\n因此 $P$ 在每个组内是常数。令 $a=\\exp(-1-\\alpha-\\beta)$ 和 $b=\\exp(-1-\\alpha)$。那么\n$$P(x)=\\frac{1}{10}a \\text{ 对于 } x\\leq 3,\\qquad P(x)=\\frac{1}{10}b \\text{ 对于 } x>3.$$\n应用约束条件。根据 $\\sum_{x\\leq 3}P(x)=0.5$，\n$$3\\cdot \\frac{1}{10}a=0.5 \\quad\\Rightarrow\\quad a=\\frac{5}{3}.$$\n根据归一化条件 $\\sum_{x\\in S}P(x)=1$，\n$$3\\cdot \\frac{1}{10}a+7\\cdot \\frac{1}{10}b=1 \\quad\\Rightarrow\\quad 3a+7b=10 \\quad\\Rightarrow\\quad 3\\cdot \\frac{5}{3}+7b=10 \\quad\\Rightarrow\\quad b=\\frac{5}{7}.$$\n因此，\n$$P(x)=\\frac{1}{6} \\text{ 对于 } x\\in\\{1,2,3\\},\\qquad P(x)=\\frac{1}{14} \\text{ 对于 } x\\in\\{4,5,6,7,8,9,10\\}.$$\n因此\n$$P(X=1)=\\frac{1}{6}.$$\n四舍五入到四位有效数字，结果是 $0.1667$。", "answer": "$$\\boxed{0.1667}$$", "id": "1631708"}, {"introduction": "信息投影的强大之处不仅在于处理数值约束，还在于施加结构性约束。本练习探讨了一个非常优雅的问题：如何根据经验数据找到一个“最接近”的对称概率分布。这个问题不仅引入了对称性这一结构性要求，还使用了另一种相关的散度度量，其解法直观地展示了如何通过“平均”来构造满足约束的分布，从而加深对信息几何思想的理解。", "problem": "一位实验物理学家正在研究一个特定的衰变过程。该实验为每次衰变事件测量一个整数值量 $k$。这个量的物理边界为 $0 \\le k \\le N$，其中 $N$ 是一个已知的整数。在记录了大量事件之后，这位物理学家为结果 $k \\in \\{0, 1, \\dots, N\\}$ 构建了一个经验概率分布 $Q(k)$。\n\n根据一个基础理论，真实的潜在概率分布（我们称之为 $P(k)$）被预期是对称的。集合 $\\{0, 1, \\dots, N\\}$ 上的一个概率分布 $P$ 被定义为对称的，如果它对所有从 $0$ 到 $N$ 的整数 $k$ 都满足条件 $P(k) = P(N-k)$。\n\n这位物理学家想要找到一个对称分布 $P$，作为其经验数据 $Q$ 的最佳近似。在信息论中，衡量真实分布 $P$ 和经验分布 $Q$ 之间差异的一个标准度量是库尔贝克-莱布勒（KL）散度，其定义为：\n$$ D_{KL}(Q || P) = \\sum_{k=0}^{N} Q(k) \\ln\\left(\\frac{Q(k)}{P(k)}\\right) $$\n其中 $\\ln$ 是自然对数。我们假设求和只对 $Q(k) > 0$ 的 $k$ 进行。\n\n您的任务是找到一个特定的对称概率分布 $P$，使得这个 KL 散度 $D_{KL}(Q || P)$ 最小化。您的最终答案应该是 $P(k)$ 的一个闭式解析表达式，用经验分布 $Q$ 的概率和参数 $N$ 来表示。", "solution": "给定集合 $\\{0,1,\\dots,N\\}$ 上的一个经验分布 $Q$，我们寻求一个对称分布 $P$（即对所有 $k$ 满足 $P(k)=P(N-k)$），以最小化库尔贝克-莱布勒散度\n$$\nD_{KL}(Q\\|P)=\\sum_{k=0}^{N} Q(k)\\ln\\left(\\frac{Q(k)}{P(k)}\\right),\n$$\n并约定求和实际上是针对 $Q(k)>0$ 的 $k$ 进行的。由于 $Q$ 是固定的，最小化 $D_{KL}(Q\\|P)$ 等价于最大化\n$$\n\\sum_{k=0}^{N} Q(k)\\ln P(k)\n$$\n其约束条件为 $P(k)\\ge 0$，$\\sum_{k=0}^{N} P(k)=1$，以及对所有 $k$ 满足 $P(k)=P(N-k)$。\n\n利用对称性，通过对称轨道对 $P$ 进行参数化。对于 $0\\le k  N/2$，定义 $s_{k}$ 使得 $P(k)=P(N-k)=s_{k}$。如果 $N$ 是偶数，还需定义 $t=P\\!\\left(\\frac{N}{2}\\right)$。归一化约束变为：\n- 如果 $N$ 是奇数：$2\\sum_{k=0}^{(N-1)/2} s_{k}=1$。\n- 如果 $N$ 是偶数：$2\\sum_{k=0}^{N/2-1} s_{k}+t=1$。\n\n用这些变量来写出目标函数。对于 $k  N/2$ 的一对 $(k,N-k)$，其贡献为\n$$\nQ(k)\\ln s_{k}+Q(N-k)\\ln s_{k}=\\bigl(Q(k)+Q(N-k)\\bigr)\\ln s_{k}.\n$$\n如果 $N$ 是偶数，中点的贡献为 $Q(N/2)\\ln t$。定义权重 $w_{k}=Q(k)+Q(N-k)$（对于 $0\\le k  N/2$），并且如果 $N$ 是偶数，定义 $w_{\\mathrm{mid}}=Q(N/2)$。\n\n对于 $N$ 是奇数的情况，拉格朗日量为\n$$\n\\mathcal{L}=\\sum_{k=0}^{(N-1)/2} w_{k}\\ln s_{k}+\\lambda\\left(2\\sum_{k=0}^{(N-1)/2} s_{k}-1\\right).\n$$\n将导数设为零，对每个 $k$ 可得，\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial s_{k}}=\\frac{w_{k}}{s_{k}}+2\\lambda=0\n\\quad\\Rightarrow\\quad\ns_{k}=-\\frac{w_{k}}{2\\lambda}.\n$$\n施加归一化约束，\n$$\n2\\sum_{k=0}^{(N-1)/2} s_{k}=-\\frac{2}{2\\lambda}\\sum_{k=0}^{(N-1)/2} w_{k}=-\\frac{1}{\\lambda}\\sum_{k=0}^{(N-1)/2} w_{k}=1.\n$$\n由于 $\\sum_{k=0}^{(N-1)/2} w_{k}=\\sum_{k=0}^{N} Q(k)=1$，我们得到 $\\lambda=-1$，因此\n$$\ns_{k}=\\frac{w_{k}}{2}=\\frac{Q(k)+Q(N-k)}{2}.\n$$\n\n对于 $N$ 是偶数的情况，拉格朗日量为\n$$\n\\mathcal{L}=\\sum_{k=0}^{N/2-1} w_{k}\\ln s_{k}+w_{\\mathrm{mid}}\\ln t+\\lambda\\left(2\\sum_{k=0}^{N/2-1} s_{k}+t-1\\right).\n$$\n驻点条件得出\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial s_{k}}=\\frac{w_{k}}{s_{k}}+2\\lambda=0\n\\quad\\Rightarrow\\quad\ns_{k}=-\\frac{w_{k}}{2\\lambda},\n\\qquad\n\\frac{\\partial \\mathcal{L}}{\\partial t}=\\frac{w_{\\mathrm{mid}}}{t}+\\lambda=0\n\\quad\\Rightarrow\\quad\nt=-\\frac{w_{\\mathrm{mid}}}{\\lambda}.\n$$\n归一化可得\n$$\n2\\sum_{k=0}^{N/2-1} s_{k}+t=-\\frac{1}{\\lambda}\\left(\\sum_{k=0}^{N/2-1} w_{k}+w_{\\mathrm{mid}}\\right)=-\\frac{1}{\\lambda}\\sum_{k=0}^{N} Q(k)=-\\frac{1}{\\lambda}=1,\n$$\n因此再次得到 $\\lambda=-1$，所以\n$$\ns_{k}=\\frac{w_{k}}{2}=\\frac{Q(k)+Q(N-k)}{2},\\qquad t=w_{\\mathrm{mid}}=Q(N/2).\n$$\n\n综合两种情况，我们得到一个对所有 $N$ 和所有 $k$ 都有效的单一闭式表达式：\n$$\nP(k)=\\frac{Q(k)+Q(N-k)}{2},\\quad k=0,1,\\dots,N.\n$$\n根据构造，该分布是对称的，并且是归一化的，因为\n$$\n\\sum_{k=0}^{N} P(k)=\\frac{1}{2}\\sum_{k=0}^{N}\\bigl(Q(k)+Q(N-k)\\bigr)=\\frac{1}{2}\\bigl(1+1\\bigr)=1,\n$$\n并且它在对称性约束下最小化了 $D_{KL}(Q\\|P)$。如果对于某一对 $k$ 和 $N-k$ 有 $Q(k)=Q(N-k)=0$，那么可以推导出 $P(k)=P(N-k)=0$，这与在满足归一化条件的同时最大化目标函数是一致的。", "answer": "$$\\boxed{\\frac{Q(k)+Q(N-k)}{2}}$$", "id": "1631718"}]}