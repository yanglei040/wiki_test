{"hands_on_practices": [{"introduction": "一次性密码本的一个核心特性是，其产生的密文是均匀分布的，这意味着任何可能的密文出现的概率都完全相同，与原始消息的内容无关。这个练习将通过一个具体的计算来验证这一基本属性 [@problem_id:1644135]。通过计算密文恰好为全零字符串的概率，你将直观地理解密钥的随机性是如何将消息的概率分布“抹平”，从而使密文呈现均匀分布的。", "problem": "一个基础的安全通信系统使用一种称为一次性密码本（OTP）的加密方案。在该系统中，一个长度为 $n$ 比特的二进制消息 $M$ 使用一个同样为 $n$ 比特长度的二进制密钥 $K$ 进行加密。产生的密文 $C$ 是通过对消息和密钥进行逐位异或（XOR）运算得到的，可以写作 $C = M \\oplus K$。\n\n假设消息 $M$是从所有可能的 $n$ 比特字符串集合中均匀随机选取的，并且独立地，密钥 $K$ 也是从所有可能的 $n$ 比特字符串集合中均匀随机选取的。\n\n计算所得密文 $C$ 是全零的特定 $n$ 比特字符串的概率。请将您的答案表示为 $n$ 的函数。", "solution": "令 $M \\in \\{0,1\\}^{n}$ 和 $K \\in \\{0,1\\}^{n}$ 是独立且均匀分布的，并令 $C = M \\oplus K$ 为密文。我们要求解 $\\Pr(C = 0^{n})$，其中 $0^{n}$ 表示长度为 $n$ 的全零字符串。\n\n对于比特 $a,b \\in \\{0,1\\}$，异或运算的性质是 $a \\oplus b = 0$ 当且仅当 $a = b$。将此性质逐位应用于 $n$ 比特字符串，我们得到 $C = 0^{n}$ 当且仅当 $M = K$。\n\n因此，\n$$\n\\Pr(C = 0^{n}) = \\Pr(M = K) = \\sum_{m \\in \\{0,1\\}^{n}} \\Pr(M = m, K = m).\n$$\n根据 $M$ 和 $K$ 的独立性，\n$$\n\\Pr(M = m, K = m) = \\Pr(M = m)\\Pr(K = m).\n$$\n由于两者在 $\\{0,1\\}^{n}$ 上都是均匀分布的，对于每一个 $m$，\n$$\n\\Pr(M = m) = \\frac{1}{2^{n}}, \\quad \\Pr(K = m) = \\frac{1}{2^{n}}.\n$$\n因此，\n$$\n\\Pr(C = 0^{n}) = \\sum_{m \\in \\{0,1\\}^{n}} \\frac{1}{2^{n}} \\cdot \\frac{1}{2^{n}} = 2^{n} \\cdot \\frac{1}{2^{n}} \\cdot \\frac{1}{2^{n}} = \\frac{1}{2^{n}}.\n$$\n等价地，对于任意固定的 $M$，在 $2^{n}$ 个等可能的密钥中，恰好只有一个密钥 $K$（即 $K = M$）能使得 $C = 0^{n}$，这给出了相同的概率 $\\frac{1}{2^{n}}$。", "answer": "$$\\boxed{\\frac{1}{2^{n}}}$$", "id": "1644135"}, {"introduction": "在探讨了密文的概率特性之后，我们可以运用信息论来更严谨地理解系统的安全性，其中熵是衡量不确定性的核心工具。这个练习要求你计算消息和密钥的联合熵，它代表了加密开始前系统中存在的总不确定性 [@problem_id:1644099]。这个计算将帮助你巩固一个关键概念：为什么密钥必须拥有与其所保护的消息同样多的不确定性（即熵）。", "problem": "在一个使用一次性密码本（OTP）加密协议的高度安全的通信网络中，一个明文消息 $M$ 表示为一个长度为 $n$ 的比特串。用于加密的密钥 $K$ 也是一个长度为 $n$ 的比特串。为使一次性密码本提供完美保密性，必须满足两个条件：（1）消息源是均匀随机的，即 $2^n$ 个可能的消息中的任何一个都是等可能的。（2）密钥也是从所有可能的 $n$ 比特串集合中均匀随机选择的，并且与消息在统计上是独立的。在这些理想条件下，计算联合熵 $H(M, K)$，它量化了与变量对 $(M, K)$ 相关的总平均不确定性。请用关于 $n$ 的解析表达式表示你的最终答案。", "solution": "设 $M$ 和 $K$ 是在 $\\{0,1\\}^{n}$ 中取值的随机变量。在所述条件下：\n- 均匀性：对于每个 $m \\in \\{0,1\\}^{n}$，$\\Pr(M=m)=2^{-n}$，且对于每个 $k \\in \\{0,1\\}^{n}$，$\\Pr(K=k)=2^{-n}$。\n- 独立性：对于每一对 $(m,k)$，$\\Pr(M=m, K=k)=\\Pr(M=m)\\Pr(K=k)=2^{-n}\\cdot 2^{-n}=2^{-2n}$。\n\n根据定义，对于一个具有概率质量函数（pmf）$p_{X}$ 的离散随机变量 $X$，其以比特为单位的香农熵为\n$$\nH(X)=-\\sum_{x} p_{X}(x)\\,\\log_{2}\\big(p_{X}(x)\\big).\n$$\n\n首先计算边缘熵。对于 $M$：\n$$\nH(M)=-\\sum_{m \\in \\{0,1\\}^{n}} 2^{-n}\\,\\log_{2}\\big(2^{-n}\\big)\n= -2^{n}\\cdot 2^{-n}\\cdot (-n)=n.\n$$\n通过相同的论证，可得 $H(K)=n$。\n\n使用链式法则和独立性，\n$$\nH(M,K)=H(M)+H(K \\mid M).\n$$\n独立性意味着 $H(K \\mid M)=H(K)$，因此\n$$\nH(M,K)=H(M)+H(K)=n+n=2n.\n$$\n\n等价地，直接从联合概率质量函数计算：\n$$\nH(M,K)=-\\sum_{m,k} 2^{-2n}\\,\\log_{2}\\big(2^{-2n}\\big)\n=-2^{2n}\\cdot 2^{-2n}\\cdot (-2n)=2n,\n$$\n这与使用链式法则得到的结果一致。", "answer": "$$\\boxed{2n}$$", "id": "1644099"}, {"introduction": "一次性密码本的安全性依赖于几个严格的条件，特别是密钥必须从所有可能性中均匀随机地选取。如果这个条件被违反了会发生什么呢？这个练习将探讨一个现实中的安全缺陷：密钥是从一个已知的、更小的集合中生成的 [@problem_id:1644119]。通过计算消息和密文之间的互信息，你将能精确地量化这一缺陷导致的信息泄露量，这不仅揭示了不当密钥生成的危险，也展示了如何使用信息论工具来评估密码系统的安全漏洞。", "problem": "一家密码学初创公司正在设计一个基于一次性密码本原则的系统。在他们的系统中，一个秘密消息 $M$（表示为一个 $n$ 比特的二进制字符串）通过与一个 $n$ 比特密钥 $K$ 进行按位异或操作来加密。生成的 $n$ 比特密文为 $C = M \\oplus K$。\n\n由于密钥生成过程中的一个缺陷，密钥 $K$ 不是从所有 $2^n$ 个可能密钥的完整集合中均匀随机选择的。而是从一个记为 $\\mathcal{S}$ 的特定的、公开已知的密钥子集中均匀随机选择。已知该子集的大小为 $|\\mathcal{S}| = 2^{n-k}$，其中 $n$ 和 $k$ 是正整数且 $k < n$。\n\n敌手 Eve 截获了一个密文 $C$。Eve 知道加密算法（$C = M \\oplus K$）以及受限密钥集 $\\mathcal{S}$ 的确切构成。Eve 通过观察密文 $C$ 能够获得的关于消息 $M$ 的信息量由互信息 $I(M; C)$ 来量化。该值可能取决于原始消息 $M$ 的统计分布。\n\n假设消息 $M$ 和密钥 $K$ 是独立选择的，请确定互信息 $I(M; C)$ 的最大可能值（以比特为单位）。该最大值是在消息 $M$ 的所有可能概率分布上取到的。你的答案应为一个用 $n$ 和/或 $k$ 表示的表达式。", "solution": "令 $H(\\cdot)$ 表示以比特为单位的香农熵。互信息满足\n$$\nI(M;C)=H(C)-H(C|M).\n$$\n因为 $C=M\\oplus K$，且对于任意固定的 $m$，映射 $k\\mapsto c=m\\oplus k$ 是 $\\{0,1\\}^{n}$ 上的一个双射，我们有\n$$\nH(C|M=m)=H(K) \\quad \\text{对于所有 } m,\n$$\n并且因为 $M$ 和 $K$ 是独立的，这导出\n$$\nH(C|M)=H(K).\n$$\n鉴于 $K$ 在 $|\\mathcal{S}|=2^{n-k}$ 的集合 $\\mathcal{S}$ 上是均匀分布的，我们得到\n$$\nH(K)=\\log_{2}|\\mathcal{S}|=\\log_{2}\\left(2^{n-k}\\right)=n-k.\n$$\n因此\n$$\nI(M;C)=H(C)-(n-k).\n$$\n由于 $C$ 在 $\\{0,1\\}^{n}$ 中取值，我们有界 $H(C)\\leq n$，这意味着\n$$\nI(M;C)\\leq n-(n-k)=k.\n$$\n为了证明这个上界是可以达到的，选择 $M$ 在 $\\{0,1\\}^{n}$ 上均匀分布。那么对于任意的 $c$，\n$$\nP_{C}(c)=\\sum_{m}P_{M}(m)P_{K}(c\\oplus m)=\\frac{1}{2^{n}}\\sum_{m}P_{K}(c\\oplus m)=\\frac{1}{2^{n}}\\sum_{k}P_{K}(k)=\\frac{1}{2^{n}},\n$$\n所以 $C$ 是均匀分布的，且 $H(C)=n$。代入可得\n$$\nI(M;C)=n-(n-k)=k.\n$$\n因此，在所有消息分布上的最大值是 $k$ 比特。", "answer": "$$\\boxed{k}$$", "id": "1644119"}]}