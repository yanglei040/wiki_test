{"hands_on_practices": [{"introduction": "理论知识需要通过实践来巩固。让我们从一个基本问题开始，探索实现完美保密的基石。这个练习将引导我们推导出一个基于模运算的密码系统（可以看作是“一次性密码本”的推广）要达到完美保密，其密钥必须满足的数学条件。通过解决这个问题，你将亲身体会到为什么均匀分布的密钥在信息论安全中是不可或缺的。[@problem_id:1657913]", "problem": "一个极简的安全通信系统被设计用于传输三种可能消息中的一种，这些消息由整数集合 $\\mathcal{M} = \\{0, 1, 2\\}$ 表示。为了加密一条消息 $m \\in \\mathcal{M}$，一个密钥 $k$ 根据概率分布 $P(K=k)$ 从集合 $\\mathcal{K} = \\{0, 1, 2\\}$ 中选择。加密函数将消息 $m$ 和密钥 $k$ 映射到一个密文 $c$，该函数由模运算规则 $c = (m + k) \\pmod 3$ 给出。得到的密文 $c$ 也是集合 $\\{0, 1, 2\\}$ 中的一个元素。\n\n该系统被设计用来实现完美保密。一个密码系统具有完美保密性的充要条件是，对于所有可能的密文，在给定明文 $m$ 的条件下观察到密文 $c$ 的条件概率，记为 $P(C=c|M=m)$，与明文 $m$ 无关。\n\n以下哪项描述了该系统要达到完美保密性，对密钥概率分布的必要和充分条件？\n\nA. $P(K=0) = P(K=1) = P(K=2)$\n\nB. $P(K=0) = 1/2$, $P(K=1) = 1/4$, $P(K=2) = 1/4$\n\nC. 密钥分布必须与明文分布相同，即对于 $i \\in \\{0, 1, 2\\}$，有 $P(K=i) = P(M=i)$。\n\nD. 必须确定性地选择一个密钥，例如 $P(K=0)=1$。\n\nE. 任何分布都是有效的，只要对于所有的 $k \\in \\mathcal{K}$ 都有 $P(K=k) > 0$。", "solution": "我们给定一个在集合 $\\{0,1,2\\}$ 上的密码系统，其加密规则为 $c = (m + k) \\pmod 3$。密钥 $K$ 根据分布 $P(K=k)$ 选择，并且，在完美保密的分析中，通常假定 $K$ 的选择独立于 $M$。完美保密性要求对于所有的 $c$，$P(C=c \\mid M=m)$ 都与 $m$ 无关。\n\n由于加密是确定性的，对于任何固定的 $m$ 和 $c$，事件 $\\{C=c\\}$ 发生当且仅当 $K \\equiv c - m \\pmod{3}$。利用 $K$ 和 $M$ 的独立性，我们得到\n$$\nP(C=c \\mid M=m) = P\\big(K = (c - m) \\pmod 3\\big).\n$$\n因此，为了实现完美保密性（$C$ 独立于 $M$），等式右边必须不依赖于 $m$。固定 $c$，比较不同 $m$ 的值：\n- 对于 $m=0$：$P(C=c \\mid M=0) = P(K=c)$。\n- 对于 $m=1$：$P(C=c \\mid M=1) = P(K=(c-1) \\pmod 3)$。\n- 对于 $m=2$：$P(C=c \\mid M=2) = P(K=(c-2) \\pmod 3)$。\n\n与 $m$ 的无关性意味着，对于每个固定的 $c$，有\n$$\nP(K=0) = P(K=1) = P(K=2).\n$$\n这证明了必要性。对于充分性，如果 $P(K=0) = P(K=1) = P(K=2)$，那么对于任何 $m$ 和 $c$，\n$$\nP(C=c \\mid M=m) = P\\big(K = (c - m) \\pmod 3\\big)\n$$\n对于 $(c-m) \\pmod 3$ 的所有三个可能值，其结果都是相同的常数，因此它与 $m$ 无关。因此该条件也是充分的。\n\n因此，密钥分布必须在 $\\{0,1,2\\}$ 上是均匀的，这正是选项 A。", "answer": "$$\\boxed{A}$$", "id": "1657913"}, {"introduction": "在理解了密钥均匀分布的关键性之后，我们来检验不同的加密操作如何影响系统的安全性。这个练习通过一个思想实验，比较了我们熟悉的异或（XOR）操作和异或非（XNOR）操作。你的任务是运用完美保密的严格定义来判断，当密钥是真正随机时，这两种看似不同的操作是否都能构建出安全的密码系统。这个过程将帮助你深化理解：一个好的加密操作与随机密钥结合所产生的统计特性，才是保密性的核心。[@problem_id:1645927]", "problem": "两名密码学学生，Alex和Beth，正在讨论用于加密单个比特信息的简单密码。明文消息是一个比特 $M \\in \\{0, 1\\}$，密钥也是一个比特 $K \\in \\{0, 1\\}$。密钥 $K$ 是均匀随机选择的，即 $P(K=0) = P(K=1) = 1/2$。得到的密文是一个比特 $C \\in \\{0, 1\\}$。\n\nAlex 提出了一种基于异或 (XOR) 运算的密码，记作 $\\oplus$。加密规则是：\n$$C_A = M \\oplus K$$\n\nBeth 提出了另一种基于异或非 (XNOR) 运算的密码。XNOR 运算在其两个输入相同时输出1，否则输出0。Beth 的加密规则是：\n$$C_B = M \\text{ XNOR } K$$\n\n他们正在分析这些密码是否能实现完美保密。如果一个密文的观察者无法获得关于明文的任何额外信息，那么该系统就具有完美保密性。从数学上讲，如果密文的概率分布与明文无关，那么这一点就成立。\n\n关于完美保密性这一特性，以下哪个陈述正确地比较了这两种密码？\n\nA. 只有 Alex 的密码实现了完美保密；Beth 的密码泄露了关于明文的一些信息。\n\nB. 只有 Beth 的密码实现了完美保密；Alex 的密码泄露了关于明文的一些信息。\n\nC. 两种密码都实现了完美保密，并且从分析密文以获取明文信息的攻击者角度来看，它们在功能上是等效的。\n\nD. 两种密码都未能实现完美保密，因为密钥空间太小。\n\nE. 两种密码都实现了完美保密，但 Alex 的密码更优越，因为 XOR 运算的特性使得解密更简单。\n\nF. 两种密码都实现了完美保密，但它们有根本的不同，因为 Beth 方案中密文的统计特性依赖于明文，而 Alex 的方案则不然。", "solution": "为了确定哪种密码实现了完美保密，我们必须分析每个系统中明文和密文之间的关系。如果给定明文 $M$ 的条件下密文 $C$ 的条件概率与明文无关，那么该密码就具有完美保密性。也就是说，对于所有 $m$ 的值，$P(C=c|M=m)$ 必须是相同的。我们已知密钥 $K$ 是均匀随机的，因此 $P(K=0) = P(K=1) = 1/2$。\n\n首先，我们来分析 Alex 的密码：$C_A = M \\oplus K$。\n\n情况1：明文是 $M=0$。\n密文是 $C_A = 0 \\oplus K = K$。\n得到密文 $C_A=0$ 的概率是 $P(C_A=0|M=0) = P(K=0) = 1/2$。\n得到密文 $C_A=1$ 的概率是 $P(C_A=1|M=0) = P(K=1) = 1/2$。\n\n情况2：明文是 $M=1$。\n密文是 $C_A = 1 \\oplus K = \\neg K$ (K的非)。\n得到密文 $C_A=0$ 的概率是 $P(C_A=0|M=1) = P(\\neg K=0) = P(K=1) = 1/2$。\n得到密文 $C_A=1$ 的概率是 $P(C_A=1|M=1) = P(\\neg K=1) = P(K=0) = 1/2$。\n\n在所有情况下，对于任意明文比特 $m \\in \\{0,1\\}$ 和任意密文比特 $c \\in \\{0,1\\}$，都有 $P(C_A=c|M=m) = 1/2$。由于密文的概率分布与明文无关，Alex 的密码实现了完美保密。\n\n现在，我们来分析 Beth 的密码：$C_B = M \\text{ XNOR } K$。\nXNOR 运算定义为：如果 $a=b$，则 $a \\text{ XNOR } b = 1$；如果 $a \\neq b$，则为 $0$。这等价于 $a \\text{ XNOR } b = \\neg(a \\oplus b)$。\n\n情况1：明文是 $M=0$。\n密文是 $C_B = 0 \\text{ XNOR } K$。如果 $K=0$，$C_B=1$。如果 $K=1$，$C_B=0$。因此，$C_B = \\neg K$。\n得到密文 $C_B=0$ 的概率是 $P(C_B=0|M=0) = P(\\neg K=0) = P(K=1) = 1/2$。\n得到密文 $C_B=1$ 的概率是 $P(C_B=1|M=0) = P(\\neg K=1) = P(K=0) = 1/2$。\n\n情况2：明文是 $M=1$。\n密文是 $C_B = 1 \\text{ XNOR } K$。如果 $K=0$，$C_B=0$。如果 $K=1$，$C_B=1$。因此，$C_B = K$。\n得到密文 $C_B=0$ 的概率是 $P(C_B=0|M=1) = P(K=0) = 1/2$。\n得到密文 $C_B=1$ 的概率是 $P(C_B=1|M=1) = P(K=1) = 1/2$。\n\n与 Alex 的密码一样，我们发现对于任意明文比特 $m \\in \\{0,1\\}$ 和任意密文比特 $c \\in \\{0,1\\}$，都有 $P(C_B=c|M=m) = 1/2$。Beth 的密码中密文的概率分布也与明文无关。因此，Beth 的密码也实现了完美保密。\n\n由于两种密码都实现了完美保密，选项 A、B 和 D 是不正确的。选项 F 是不正确的，因为正如我们刚刚证明的，Beth 方案中密文的统计特性也与明文无关。\n\n让我们从观察者的角度来考虑。对于这两种密码，观察到特定密文比特 $c$ 的概率由全概率定律给出：\n$$P(C=c) = P(C=c|M=0)P(M=0) + P(C=c|M=1)P(M=1)$$\n由于两种密码的 $P(C=c|M=m) = 1/2$，这可以简化为：\n$$P(C=c) = \\frac{1}{2} P(M=0) + \\frac{1}{2} P(M=1) = \\frac{1}{2} (P(M=0) + P(M=1)) = \\frac{1}{2}$$\n对于 Alex 和 Beth 的密码，无论原始明文分布如何，输出的密文都是一个均匀随机的比特 ($P(C=0)=1/2, P(C=1)=1/2$)。观察密文流的攻击者会看到一个完全随机的比特序列，并且无法区分使用的是 XOR 还是 XNOR 运算。因此，从信息论安全的角度来看，这两种密码在功能上是等效的。\n\n最后，选项 E 声称 Alex 的密码因解密更简单而更优越。对于 Alex 的密码，$C_A = M \\oplus K$，所以解密是 $M = C_A \\oplus K$。对于 Beth 的密码，$C_B = M \\text{ XNOR } K$。我们来检查解密：$C_B \\text{ XNOR } K = (M \\text{ XNOR } K) \\text{ XNOR } K$。由于 XNOR 是可结合的，并且 $K \\text{ XNOR } K = 1$，这变成了 $M \\text{ XNOR } (K \\text{ XNOR } K) = M \\text{ XNOR } 1 = M$。所以，Beth 密码的解密是 $M = C_B \\text{ XNOR } K$。解密操作与加密操作相同，就像 XOR 一样。因此，选项 E 的前提是错误的。\n\n基于此分析，两种密码都实现了完美保密，并且对于观察密文的攻击者来说是无法区分的。\n\n因此，陈述 C 是正确的结论。", "answer": "$$\\boxed{C}$$", "id": "1645927"}, {"introduction": "理想的条件在现实世界中往往难以完全满足。那么，当一个密码系统未能达到完美保密的标准时，我们该如何衡量其“不安全”的程度呢？这个问题将带你分析一个由于密钥生成存在缺陷（非均匀分布）而导致信息泄露的系统。你将学习使用互信息 $I(M;C)$ 这一信息论工具，来精确定量地计算从明文“泄露”到密文中的信息量。这使我们能够超越“安全”与“不安全”的二元判断，对系统的安全性进行更细致的评估。[@problem_id:1645954]", "problem": "一位工程师正在分析一个设计用于加密单个二进制数字的简单密码系统。该系统模型如下：明文消息，由随机变量 $M$ 表示，可以是 0 或 1。消息源是无偏的，即 $P(M=0) = 0.5$。加密密钥，由随机变量 $K$ 表示，也是一个单个二进制数字。该密钥由一个本应是随机的过程中生成，但一个缺陷导致了有偏分布：生成 0 的概率为 $P(K=0) = 0.2$。密文 $C$ 是通过对消息和密钥进行按位异或（XOR）运算产生的，即 $C = M \\oplus K$。假设密钥生成过程与消息无关。\n\n您的任务是通过计算消息 $M$ 和密文 $C$ 之间的互信息 $I(M;C)$ 来量化该系统的信息泄漏。请用比特表示您的答案，并四舍五入到三位有效数字。", "solution": "设 $M\\in\\{0,1\\}$，其中 $P(M=0)=P(M=1)=\\frac{1}{2}$，且 $K\\in\\{0,1\\}$ 与 $M$ 独立，其中 $P(K=0)=0.2$ 且 $P(K=1)=0.8$。密文为 $C=M\\oplus K$。\n\n我们使用以下公式计算互信息\n$$\nI(M;C)=H(C)-H(C|M).\n$$\n\n首先，计算 $H(C)$。由于 $C=M\\oplus K$，\n$$\nP(C=1)=P(M\\neq K)=P(M=0)P(K=1)+P(M=1)P(K=0)=\\tfrac{1}{2}\\cdot 0.8+\\tfrac{1}{2}\\cdot 0.2=\\tfrac{1}{2},\n$$\n类似地，$P(C=0)=\\tfrac{1}{2}$。因此\n$$\nH(C)=H_{2}\\!\\left(\\tfrac{1}{2}\\right)=1 \\text{ 比特},\n$$\n其中 $H_{2}(p)=-p\\log_{2}p-(1-p)\\log_{2}(1-p)$ 是二元熵函数。\n\n接下来，计算 $H(C|M)$。对于任何固定的 $m\\in\\{0,1\\}$，\n$$\nP(C=m\\,|\\,M=m)=P(K=0)=0.2,\\quad P(C\\neq m\\,|\\,M=m)=P(K=1)=0.8,\n$$\n所以\n$$\nH(C|M=m)=H_{2}(0.8).\n$$\n对 $M$ 求平均值得到\n$$\nH(C|M)=H_{2}(0.8).\n$$\n\n因此，\n$$\nI(M;C)=H(C)-H(C|M)=1-H_{2}(0.8).\n$$\n数值上，\n$$\nH_{2}(0.8)=-0.8\\log_{2}(0.8)-0.2\\log_{2}(0.2)\\approx 0.721928094887,\n$$\n因此\n$$\nI(M;C)\\approx 1-0.721928094887=0.278071905113 \\text{ 比特}.\n$$\n四舍五入到三位有效数字，结果是 $0.278$ 比特。", "answer": "$$\\boxed{0.278}$$", "id": "1645954"}]}