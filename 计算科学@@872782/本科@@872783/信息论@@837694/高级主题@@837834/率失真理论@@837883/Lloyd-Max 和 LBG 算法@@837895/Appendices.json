{"hands_on_practices": [{"introduction": "在设计一个最优量化器时，一个核心问题是：给定一组固定的重建电平（或称码字），我们应该如何划分输入信号的范围以最小化误差？这个练习将引导你推导并应用“最近邻条件”。你将发现，对于最小化均方误差而言，最优的判决边界恰好位于相邻重建电平的中点。[@problem_id:1637665]", "problem": "一个模拟传感器产生一个电压信号，该信号可以建模为一个在区间 $[-3, 3]$ 上服从均匀概率分布的连续随机变量 $X$。为了将该信号数字化以进行处理，我们采用了一个简单的1比特标量量化器。该量化器将输入电压映射到两个预定义的重建电平之一。由于硬件限制，重建电平被不对称地设置为 $y_1 = -2.5$ 和 $y_2 = 1.8$。\n\n假设设计目标是最小化均方误差 (MSE) 失真，请确定划分两个量化区域的最优决策边界 $b_1$。决策规则如下：如果输入信号 $x$ 小于或等于 $b_1$，它将被映射到 $y_1$；否则，它将被映射到 $y_2$。随机变量 $X$ 的定义域是区间 $[-3, 3]$，因此两个量化区域是 $[-3, b_1]$ 和 $(b_1, 3]$。\n\n请用一个实数表示你的答案。", "solution": "问题要求解一个1比特量化器的最优决策边界 $b_1$，该边界能够最小化均方误差 (MSE)。该量化器将输入信号 $x$ 映射到两个重建电平之一，$y_1 = -2.5$ 或 $y_2 = 1.8$。输入信号 $X$ 是一个在 $[-3, 3]$上均匀分布的随机变量。\n\n在区间 $[a, b]$ 上的均匀分布的概率密度函数 (PDF) 为 $p(x) = \\frac{1}{b-a}$（当 $x \\in [a, b]$ 时），否则 $p(x)=0$。对于本例，区间为 $[-3, 3]$，因此 PDF 为 $p(x) = \\frac{1}{3 - (-3)} = \\frac{1}{6}$（当 $x \\in [-3, 3]$ 时）。\n\n量化函数 $Q(x)$ 由决策边界 $b_1$ 定义：\n$$\nQ(x) = \\begin{cases} y_1  \\text{if } x \\le b_1 \\\\ y_2  \\text{if } x > b_1 \\end{cases}\n$$\n均方误差失真 $D$ 是输入信号 $X$ 与其量化表示 $Q(X)$ 之间误差平方的期望值。它通过在整个分布上对误差平方进行积分来计算：\n$$\nD = E[(X - Q(X))^2] = \\int_{-3}^{3} (x - Q(x))^2 p(x) dx\n$$\n我们可以将此积分分解为由边界 $b_1$ 定义的两个量化区域：区域 $[-3, b_1]$（其中 $Q(x) = y_1$）和区域 $(b_1, 3]$（其中 $Q(x) = y_2$）。\n$$\nD(b_1) = \\int_{-3}^{b_1} (x - y_1)^2 p(x) dx + \\int_{b_1}^{3} (x - y_2)^2 p(x) dx\n$$\n为了找到最小化失真 $D$ 的最优决策边界 $b_1$，我们需要找到使 $D$ 对 $b_1$ 的导数为零的 $b_1$ 值。我们使用莱布尼茨积分法则（积分符号下的微分）：\n$$\n\\frac{d}{dc} \\int_{a(c)}^{b(c)} f(x, c) dx = f(b(c), c) \\frac{db}{dc} - f(a(c), c) \\frac{da}{dc} + \\int_{a(c)}^{b(c)} \\frac{\\partial f}{\\partial c} dx\n$$\n在我们的例子中，被积函数不依赖于 $b_1$，因此偏导数项为零。应用该法则，我们得到：\n$$\n\\frac{dD}{db_1} = \\left[ (b_1 - y_1)^2 p(b_1) \\right] - \\left[ (b_1 - y_2)^2 p(b_1) \\right]\n$$\n将导数设为零以求最小值：\n$$\n\\frac{dD}{db_1} = p(b_1) \\left[ (b_1 - y_1)^2 - (b_1 - y_2)^2 \\right] = 0\n$$\n最优边界 $b_1$ 必须位于区间 $(-3, 3)$ 内，在此区间中 $p(b_1) = 1/6 \\neq 0$。因此，我们可以除以 $p(b_1)$：\n$$\n(b_1 - y_1)^2 - (b_1 - y_2)^2 = 0\n$$\n$$\n(b_1 - y_1)^2 = (b_1 - y_2)^2\n$$\n对两边取平方根，得到两种可能性：\n1. $b_1 - y_1 = b_1 - y_2$，简化为 $y_1 = y_2$。这是不可能的，因为重建电平 $y_1 = -2.5$ 和 $y_2 = 1.8$ 是不同的。\n2. $b_1 - y_1 = -(b_1 - y_2)$，简化为 $b_1 - y_1 = y_2 - b_1$。\n\n我们求解第二个方程以得到 $b_1$：\n$$\n2b_1 = y_1 + y_2\n$$\n$$\nb_1 = \\frac{y_1 + y_2}{2}\n$$\n这个结果是著名的最优量化最近邻条件：两个重建电平之间的决策边界应该是它们的中点。\n\n现在，我们将给定的 $y_1$ 和 $y_2$ 的值代入此公式：\n$$\ny_1 = -2.5\n$$\n$$\ny_2 = 1.8\n$$\n$$\nb_1 = \\frac{-2.5 + 1.8}{2} = \\frac{-0.7}{2} = -0.35\n$$\n最优决策边界是 $b_1 = -0.35$。该值在信源的范围 $[-3, 3]$ 内，证实了它是一个有效的边界。", "answer": "$$\\boxed{-0.35}$$", "id": "1637665"}, {"introduction": "现在，我们来看问题的另一面：如果我们已经确定了如何划分数据（即判决区域是固定的），那么每个区域的最佳代表点（重建电平）应该是什么？本练习将揭示“质心条件”。通过这个练习，你会理解为什么将重建电平设为对应区域内所有数据点的“质心”（或期望值）可以使该区域的均方误差最小化。[@problem_id:1637680]", "problem": "考虑一个表示信号源的连续随机变量 $X$。信号幅值的概率密度函数在区间 $[0, 1]$ 上是均匀分布的。采用一个1比特标量量化器对该信号进行数字化。该量化器使用位于 $0.5$ 处的单个决策边界将输入范围划分为两个不同的区域，$R_1 = [0, 0.5]$ 和 $R_2 = (0.5, 1]$。对于任何输入信号 $x \\in R_1$，量化器输出一个恒定的重建电平 $y_1$。对于任何输入信号 $x \\in R_2$，它输出一个恒定的重建电平 $y_2$。为了最小化原始信号与量化信号之间的均方误差，必须最优地选择重建电平 $y_1$ 和 $y_2$。\n\n确定重建电平 $y_1$ 和 $y_2$ 的最优值。", "solution": "问题要求解对于一个给定的1比特量化器，能够最小化均方误差（MSE）的最优重建电平 $y_1$ 和 $y_2$。设 $X$ 是表示源信号的随机变量，设 $Q(X)$ 是量化输出。源信号 $X$ 在区间 $[0, 1]$ 上具有均匀概率密度函数（PDF）$f_X(x)$。\n$$\nf_X(x) =\n\\begin{cases}\n1  \\text{for } 0 \\le x \\le 1 \\\\\n0  \\text{otherwise}\n\\end{cases}\n$$\n量化器函数 $Q(x)$ 基于两个区域 $R_1 = [0, 0.5]$ 和 $R_2 = (0.5, 1]$ 定义如下：\n$$\nQ(x) =\n\\begin{cases}\ny_1  \\text{for } x \\in R_1 \\\\\ny_2  \\text{for } x \\in R_2\n\\end{cases}\n$$\n均方误差定义为原始信号与其量化表示之间差值平方的期望值：\n$$\nMSE = E[(X - Q(X))^2] = \\int_{-\\infty}^{\\infty} (x - Q(x))^2 f_X(x) dx\n$$\n根据指定的区域和概率密度函数，我们可以将均方误差的积分写成两个区域上积分的和：\n$$\nMSE = \\int_{0}^{0.5} (x - y_1)^2 f_X(x) dx + \\int_{0.5}^{1} (x - y_2)^2 f_X(x) dx\n$$\n由于在区间 $[0, 1]$ 上 $f_X(x) = 1$，这可以简化为：\n$$\nMSE = \\int_{0}^{0.5} (x - y_1)^2 dx + \\int_{0.5}^{1} (x - y_2)^2 dx\n$$\n为了找到最小化均方误差的 $y_1$ 和 $y_2$ 的值，我们必须求均方误差关于 $y_1$ 和 $y_2$ 的偏导数，并令它们为零。\n\n首先，我们来求 $y_1$ 的最优值。我们对均方误差关于 $y_1$ 求导。注意，第二个积分不依赖于 $y_1$。\n$$\n\\frac{\\partial (MSE)}{\\partial y_1} = \\frac{\\partial}{\\partial y_1} \\int_{0}^{0.5} (x - y_1)^2 dx = \\int_{0}^{0.5} \\frac{\\partial}{\\partial y_1} (x - y_1)^2 dx\n$$\n$$\n\\frac{\\partial (MSE)}{\\partial y_1} = \\int_{0}^{0.5} 2(x - y_1)(-1) dx = -2 \\int_{0}^{0.5} (x - y_1) dx\n$$\n将导数设为零以求最小值：\n$$\n-2 \\int_{0}^{0.5} (x - y_1) dx = 0 \\implies \\int_{0}^{0.5} x dx - \\int_{0}^{0.5} y_1 dx = 0\n$$\n由于 $y_1$ 是一个常数，我们可以将其从积分中提出：\n$$\n\\int_{0}^{0.5} x dx = y_1 \\int_{0}^{0.5} 1 dx\n$$\n求解 $y_1$：\n$$\ny_1 = \\frac{\\int_{0}^{0.5} x dx}{\\int_{0}^{0.5} 1 dx}\n$$\n这个表达式是源分布在区域 $R_1$ 上的质心（或条件期望）。我们现在计算这些积分：\n分子是 $\\int_{0}^{0.5} x dx = \\left[ \\frac{x^2}{2} \\right]_{0}^{0.5} = \\frac{(0.5)^2}{2} - 0 = \\frac{0.25}{2} = \\frac{1/4}{2} = \\frac{1}{8}$。\n分母是 $\\int_{0}^{0.5} 1 dx = [x]_{0}^{0.5} = 0.5 - 0 = 0.5 = \\frac{1}{2}$。\n所以，$y_1$ 的最优值是：\n$$\ny_1 = \\frac{1/8}{1/2} = \\frac{1}{4}\n$$\n接下来，我们用同样的方法求 $y_2$ 的最优值。我们对均方误差关于 $y_2$ 求导。第一个积分不依赖于 $y_2$。\n$$\n\\frac{\\partial (MSE)}{\\partial y_2} = \\frac{\\partial}{\\partial y_2} \\int_{0.5}^{1} (x - y_2)^2 dx = \\int_{0.5}^{1} \\frac{\\partial}{\\partial y_2} (x - y_2)^2 dx\n$$\n$$\n\\frac{\\partial (MSE)}{\\partial y_2} = \\int_{0.5}^{1} 2(x - y_2)(-1) dx = -2 \\int_{0.5}^{1} (x - y_2) dx\n$$\n将导数设为零：\n$$\n-2 \\int_{0.5}^{1} (x - y_2) dx = 0 \\implies \\int_{0.5}^{1} x dx - \\int_{0.5}^{1} y_2 dx = 0\n$$\n求解 $y_2$：\n$$\ny_2 = \\frac{\\int_{0.5}^{1} x dx}{\\int_{0.5}^{1} 1 dx}\n$$\n这是源分布在区域 $R_2$ 上的质心。我们计算这些积分：\n分子是 $\\int_{0.5}^{1} x dx = \\left[ \\frac{x^2}{2} \\right]_{0.5}^{1} = \\frac{1^2}{2} - \\frac{(0.5)^2}{2} = \\frac{1}{2} - \\frac{0.25}{2} = \\frac{0.75}{2} = \\frac{3/4}{2} = \\frac{3}{8}$。\n分母是 $\\int_{0.5}^{1} 1 dx = [x]_{0.5}^{1} = 1 - 0.5 = 0.5 = \\frac{1}{2}$。\n所以，$y_2$ 的最优值是：\n$$\ny_2 = \\frac{3/8}{1/2} = \\frac{3}{4}\n$$\n最优的重建电平是 $y_1 = 1/4$ 和 $y_2 = 3/4$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n\\frac{1}{4}  \\frac{3}{4}\n\\end{pmatrix}\n}\n$$", "id": "1637680"}, {"introduction": "Lloyd-Max算法的精髓在于交替应用我们刚刚练习过的两个条件：首先根据最近邻原则对数据进行分区，然后更新重建电平为新分区的质心。这个练习将带你完整地走一遍这个强大的优化过程。通过完成一次完整的迭代，你将巩固对该算法实际工作原理的理解。[@problem_id:1637671]", "problem": "一个数据采集系统被设计用于测量一个物理量，该物理量经过采样和一些初始处理后，会从一个离散的电平集合中产生数值。可能的输出电平集合由字母表 $\\mathcal{X} = \\{1, 3, 4, 8\\}$ 给出。由于底层物理过程的性质，观测到这四个电平中每一个的概率均相等。\n\n为了压缩这些数据以便传输，需要实现一个简单的1比特标量量化器。这意味着所有的源值将被映射到两个重建电平中的一个。选择 Lloyd-Max 算法来优化这两个重建电平的位置，以最小化均方量化误差。\n\n优化过程始于对两个重建电平的初始猜测：$y_1^{(0)} = 2.5$ 和 $y_2^{(0)} = 7.0$。\n\n你的任务是执行一次 Lloyd-Max 算法的完整迭代。一次完整迭代包括两个步骤：首先，根据最近的重建电平对源字母表进行划分；其次，将重建电平更新为新划分区域的质心。\n\n计算新的一对重建电平 $(y_1^{(1)}, y_2^{(1)})$。将你的答案表示为一个行矩阵，其中包含按升序排列的两个值，如有必要，请使用精确分数。", "solution": "源字母表为 $\\mathcal{X}=\\{1,3,4,8\\}$，对于每个 $x \\in \\mathcal{X}$，其概率均相等，为 $p(x)=\\frac{1}{4}$。对于均方误差，两个重建电平之间的 Lloyd-Max 划分边界是当前电平的中点。当 $y_{1}^{(0)}=\\frac{5}{2}$ 且 $y_{2}^{(0)}=7$ 时，判决边界为\n$$\nb=\\frac{y_{1}^{(0)}+y_{2}^{(0)}}{2}=\\frac{\\frac{5}{2}+7}{2}=\\frac{\\frac{5}{2}+\\frac{14}{2}}{2}=\\frac{\\frac{19}{2}}{2}=\\frac{19}{4}.\n$$\n因此，由最近邻分配所产生的划分为 $S_{1}=\\{1,3,4\\}$ 和 $S_{2}=\\{8\\}$。\n\n对于离散等概率点，质心更新公式为\n$$\ny_{k}^{(1)}=\\frac{\\sum_{x \\in S_{k}} x\\,p(x)}{\\sum_{x \\in S_{k}} p(x)}.\n$$\n对于 $S_{1}$，\n$$\ny_{1}^{(1)}=\\frac{(1+3+4)\\cdot \\frac{1}{4}}{3 \\cdot \\frac{1}{4}}=\\frac{8}{3},\n$$\n对于 $S_{2}$，\n$$\ny_{2}^{(1)}=\\frac{8 \\cdot \\frac{1}{4}}{1 \\cdot \\frac{1}{4}}=8.\n$$\n按升序排列，更新后的重建电平为 $\\frac{8}{3}$ 和 $8$。", "answer": "$$\\boxed{\\begin{pmatrix} \\frac{8}{3}  8 \\end{pmatrix}}$$", "id": "1637671"}]}