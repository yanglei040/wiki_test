{"hands_on_practices": [{"introduction": "Blahut-Arimoto 算法的核心在于其迭代过程。为了真正掌握这个算法，最好的方法就是亲手执行一次完整的迭代。这个练习将指导你完成这个基本步骤，从一个给定的初始分布出发，计算更新后的条件概率和边缘概率分布，从而熟悉算法的运作机制 [@problem_id:1605365]。", "problem": "考虑一个涉及二进制信源的通信问题，其中信源字母表为 $\\mathcal{X} = \\{0, 1\\}$。该信源是不对称的，生成符号的概率为 $p(x=0) = 0.75$ 和 $p(x=1) = 0.25$。我们希望使用再生字母表 $\\mathcal{\\hat{X}} = \\{0, 1\\}$ 来表示信源输出。再生质量由汉明失真来衡量，定义为：如果 $x = \\hat{x}$，则 $d(x, \\hat{x}) = 0$；如果 $x \\neq \\hat{x}$，则 $d(x, \\hat{x}) = 1$。\n\n该信源的率失真函数可以使用 Blahut-Arimoto 算法进行数值计算。该算法通过迭代优化条件分布 $q(\\hat{x}|x)$ 和再生分布 $q(\\hat{x})$ 来寻找率失真曲线上的一个点。迭代更新依赖于一个斜率参数 $\\beta \\ge 0$。对于迭代步骤 $k$，更新规则如下：\n\n1.  更新条件分布：\n    $$ q_{k+1}(\\hat{x}|x) = \\frac{q_k(\\hat{x}) \\exp(-\\beta d(x, \\hat{x}))}{\\sum_{\\hat{x}' \\in \\mathcal{\\hat{X}}} q_k(\\hat{x}') \\exp(-\\beta d(x, \\hat{x}'))} $$\n\n2.  更新再生分布：\n    $$ q_{k+1}(\\hat{x}) = \\sum_{x \\in \\mathcal{X}} p(x) q_{k+1}(\\hat{x}|x) $$\n\n假设我们用一个均匀再生分布 $q_0(\\hat{x}=0) = q_0(\\hat{x}=1) = 0.5$ 来初始化算法（在步骤 $k=0$ 时）。使用参数值 $\\beta = 2.0$，执行算法的一次完整迭代，以找到更新后的再生分布 $q_1(\\hat{x})$。\n\n计算 $q_1(\\hat{x}=0)$ 的值。将您的答案表示为四舍五入到四位有效数字的小数。", "solution": "我们给定一个二进制信源，其概率为 $p(0)=0.75$ 和 $p(1)=0.25$，汉明失真为 $d(x,\\hat{x})$，初始再生分布为 $q_{0}(\\hat{x}=0)=q_{0}(\\hat{x}=1)=0.5$，以及 $\\beta=2.0$。根据率失真理论，拉格朗日乘子 $\\beta$ 必须为非负数。Blahut-Arimoto 条件更新公式为\n$$\nq_{1}(\\hat{x}\\mid x)=\\frac{q_{0}(\\hat{x})\\exp(-\\beta d(x,\\hat{x}))}{\\sum_{\\hat{x}'\\in\\{0,1\\}}q_{0}(\\hat{x}')\\exp(-\\beta d(x,\\hat{x}'))}.\n$$\n令 $E=\\exp(-2)$。对于 $x=0$，$d(0,0)=0$ 且 $d(0,1)=1$，因此\n$$\nq_{1}(0\\mid 0)=\\frac{0.5\\cdot \\exp(0)}{0.5\\cdot \\exp(0)+0.5\\cdot \\exp(-2)}=\\frac{1}{1+E},\\quad\nq_{1}(1\\mid 0)=\\frac{0.5\\cdot \\exp(-2)}{0.5\\cdot \\exp(0)+0.5\\cdot \\exp(-2)}=\\frac{E}{1+E}.\n$$\n对于 $x=1$，$d(1,1)=0$ 且 $d(1,0)=1$，得到\n$$\nq_{1}(0\\mid 1)=\\frac{E}{1+E},\\quad q_{1}(1\\mid 1)=\\frac{1}{1+E}.\n$$\n再生分布的更新公式为\n$$\nq_{1}(\\hat{x})=\\sum_{x\\in\\{0,1\\}}p(x)\\,q_{1}(\\hat{x}\\mid x).\n$$\n因此\n$$\nq_{1}(0)=p(0)\\,q_{1}(0\\mid 0)+p(1)\\,q_{1}(0\\mid 1)=\\frac{3}{4}\\cdot \\frac{1}{1+E}+\\frac{1}{4}\\cdot \\frac{E}{1+E}=\\frac{3+E}{4(1+E)}.\n$$\n当 $E=\\exp(-2)\\approx 0.135335$ 时，我们得到\n$$\nq_{1}(0)=\\frac{3+\\exp(-2)}{4(1+\\exp(-2))}\\approx 0.690403,\n$$\n四舍五入到四位有效数字为 $0.6904$。", "answer": "$$\\boxed{0.6904}$$", "id": "1605365"}, {"introduction": "在理解了单次迭代的计算方法后，我们自然会问：重复这个过程会发生什么？这个练习将带你进行两次迭代，让你观察算法如何向一个稳定的解收敛。更重要的是，它将算法的输出与我们的最终目标——计算在特定失真水平下可达到的最低码率（即率失真函数上的一个点）——联系起来 [@problem_id:1605389]。", "problem": "考虑一个二元无记忆信源，其生成的符号来自字母表 $\\mathcal{X} = \\{0, 1\\}$。符号以等概率产生，即 $p(X=0) = p(X=1) = \\frac{1}{2}$。我们希望使用字母表 $\\hat{\\mathcal{X}} = \\{0, 1\\}$ 对该信源进行压缩和重构。重构的质量由汉明失真度量，其定义为：如果 $x = \\hat{x}$，则 $d(x, \\hat{x}) = 0$；如果 $x \\neq \\hat{x}$，则 $d(x, \\hat{x}) = 1$。\n\nBlahut-Arimoto 算法可用于迭代寻找最优的条件概率分布 $q(\\hat{x}|x)$，该分布在给定的失真水平下最小化互信息 $I(X; \\hat{X})$。对于一个固定的折衷参数 $\\beta > 0$，该算法通过以下两个步骤将分布 $q_k(\\hat{x}|x)$ 更新为 $q_{k+1}(\\hat{x}|x)$：\n\n1.  首先，基于当前信道 $q_k(\\hat{x}|x)$ 计算边缘输出分布：\n    $$ q_k(\\hat{x}) = \\sum_{x \\in \\mathcal{X}} p(x) q_k(\\hat{x}|x) $$\n2.  然后，使用上一步得到的边缘分布更新信道分布：\n    $$ q_{k+1}(\\hat{x}|x) = \\frac{q_k(\\hat{x}) \\exp(-\\beta d(x, \\hat{x}))}{\\sum_{\\hat{x}' \\in \\hat{\\mathcal{X}}} q_k(\\hat{x}') \\exp(-\\beta d(x, \\hat{x}'))} $$\n\n您的任务是分析一个特定场景下的此过程。设参数为 $\\beta = \\ln(9)$。从初始分布 $q_0(\\hat{x}|x) = 1/2$ 开始，其中 $x \\in \\mathcal{X}$ 和 $\\hat{x} \\in \\hat{\\mathcal{X}}$ 的所有组合均适用。\n\n执行 Blahut-Arimoto 算法的两次完整迭代，以确定分布 $q_2(\\hat{x}|x)$。随后，计算与此分布对应的互信息 $I_2(X; \\hat{X})$。互信息代表可达到的压缩率，由以下公式给出：\n$$ I(X; \\hat{X}) = \\sum_{x \\in \\mathcal{X}} \\sum_{\\hat{x} \\in \\hat{\\mathcal{X}}} p(x) q(\\hat{x}|x) \\log_2\\left(\\frac{q(\\hat{x}|x)}{q(\\hat{x})}\\right) $$\n给出该率的值。您的最终答案以比特为单位，并四舍五入到四位有效数字。", "solution": "信源是二元的，满足 $p(0)=p(1)=\\frac{1}{2}$，重构字母表也是二元的。失真为汉明失真：如果 $x=\\hat{x}$，则 $d(x,\\hat{x})=0$；否则 $d(x,\\hat{x})=1$。对于固定的 $\\beta0$，Blahut-Arimoto 更新公式为\n$$\nq_{k}(\\hat{x})=\\sum_{x\\in\\mathcal{X}}p(x)\\,q_{k}(\\hat{x}\\mid x),\n\\qquad\nq_{k+1}(\\hat{x}\\mid x)=\\frac{q_{k}(\\hat{x})\\exp(-\\beta d(x,\\hat{x}))}{\\sum_{\\hat{x}'\\in\\hat{\\mathcal{X}}}q_{k}(\\hat{x}')\\exp(-\\beta d(x,\\hat{x}'))}.\n$$\n给定 $\\beta=\\ln(9)$ 以及对所有 $x,\\hat{x}$ 的初始化 $q_{0}(\\hat{x}\\mid x)=\\frac{1}{2}$。\n\n第0次到第1次迭代：\n首先使用 $q_{0}(\\hat{x}\\mid x)$ 计算边缘输出分布：\n$$\nq_{0}(\\hat{x})=\\sum_{x\\in\\mathcal{X}}p(x)\\,q_{0}(\\hat{x}\\mid x)=\\frac{1}{2}\\cdot\\frac{1}{2}+\\frac{1}{2}\\cdot\\frac{1}{2}=\\frac{1}{2},\\quad\\text{对于 }\\hat{x}\\in\\{0,1\\}.\n$$\n使用 $\\beta=\\ln(9)$，我们有 $\\exp(-\\beta)=\\exp(-\\ln(9))=\\frac{1}{9}$。然后更新公式给出，对每个 $x$：\n- 如果 $\\hat{x}=x$ (因此 $d(x,\\hat{x})=0$)，分子为 $q_{0}(\\hat{x})\\exp(0)=\\frac{1}{2}$。\n- 如果 $\\hat{x}\\neq x$ (因此 $d(x,\\hat{x})=1$)，分子为 $q_{0}(\\hat{x})\\exp(-\\beta)=\\frac{1}{2}\\cdot\\frac{1}{9}$。\n分母是这两项的和：\n$$\n\\frac{1}{2}+\\frac{1}{2}\\cdot\\frac{1}{9}=\\frac{1}{2}\\left(1+\\frac{1}{9}\\right)=\\frac{1}{2}\\cdot\\frac{10}{9}=\\frac{5}{9}.\n$$\n因此，\n$$\nq_{1}(\\hat{x}=x\\mid x)=\\frac{\\frac{1}{2}}{\\frac{5}{9}}=\\frac{9}{10},\\qquad\nq_{1}(\\hat{x}\\neq x\\mid x)=\\frac{\\frac{1}{2}\\cdot\\frac{1}{9}}{\\frac{5}{9}}=\\frac{1}{10}.\n$$\n因此 $q_{1}(\\hat{x}\\mid x)$ 是一个交叉概率为 $\\frac{1}{10}$ 的二元对称信道。\n\n第1次到第2次迭代：\n使用 $q_{1}(\\hat{x}\\mid x)$ 计算新的边缘分布：\n$$\nq_{1}(0)=\\frac{1}{2}\\,q_{1}(0\\mid 0)+\\frac{1}{2}\\,q_{1}(0\\mid 1)=\\frac{1}{2}\\cdot\\frac{9}{10}+\\frac{1}{2}\\cdot\\frac{1}{10}=\\frac{1}{2},\n$$\n类似地 $q_{1}(1)=\\frac{1}{2}$。在更新中使用这些边缘分布和相同的 $\\beta$ 会得到与上面相同的计算结果，因此\n$$\nq_{2}(\\hat{x}=x\\mid x)=\\frac{9}{10},\\qquad q_{2}(\\hat{x}\\neq x\\mid x)=\\frac{1}{10}.\n$$\n因此 $q_{2}(\\hat{x}\\mid x)=q_{1}(\\hat{x}\\mid x)$。\n\n对于 $q_{2}$ 的互信息：\n使用\n$$\nI(X;\\hat{X})=\\sum_{x\\in\\mathcal{X}}\\sum_{\\hat{x}\\in\\hat{\\mathcal{X}}}p(x)\\,q(\\hat{x}\\mid x)\\,\\log_{2}\\!\\left(\\frac{q(\\hat{x}\\mid x)}{q(\\hat{x})}\\right),\n$$\n并且对于两个 $\\hat{x}$ 都有 $q_{2}(\\hat{x})=\\frac{1}{2}$，结合 $q_{2}(x\\mid x)=\\frac{9}{10}$ 和 $q_{2}(\\hat{x}\\neq x\\mid x)=\\frac{1}{10}$，我们得到\n$$\nI_{2}(X;\\hat{X})=\\frac{1}{2}\\sum_{x}\\left[\\frac{9}{10}\\log_{2}\\!\\left(\\frac{\\frac{9}{10}}{\\frac{1}{2}}\\right)+\\frac{1}{10}\\log_{2}\\!\\left(\\frac{\\frac{1}{10}}{\\frac{1}{2}}\\right)\\right]\n=\\left(\\frac{9}{10}\\right)\\log_{2}\\!\\left(\\frac{9}{5}\\right)+\\left(\\frac{1}{10}\\right)\\log_{2}\\!\\left(\\frac{1}{5}\\right).\n$$\n等价地，$I_{2}(X;\\hat{X})=1-\\left[-\\frac{1}{10}\\log_{2}\\!\\left(\\frac{1}{10}\\right)-\\frac{9}{10}\\log_{2}\\!\\left(\\frac{9}{10}\\right)\\right]=1-H_{2}\\!\\left(\\frac{1}{10}\\right)$。数值上，\n$$\nI_{2}(X;\\hat{X})\\approx 0.5310044064\\ \\text{比特}.\n$$\n四舍五入到四位有效数字，结果是 $0.5310$ 比特。", "answer": "$$\\boxed{0.5310}$$", "id": "1605389"}, {"introduction": "任何数值算法的成功应用都不仅在于执行计算，还在于理解其假设和潜在的陷阱。这个练习是一个思想实验，旨在探讨初始分布选择对 Blahut-Arimoto 算法行为的深远影响 [@problem_id:1605398]。通过分析一个看似无害的初始选择的后果，你将培养出更深刻的洞察力，避免在实际应用中可能遇到的常见问题。", "problem": "一位信息论专业的学生正在使用 Blahut-Arimoto 算法来数值近似一个离散无记忆信源的率失真函数上的一个点。其目标是找到一个信道（一个条件概率分布 $q(\\hat{x}|x)$），使得泛函 $J = I(X;\\hat{X}) + \\beta D$ 最小化，其中 $I(X;\\hat{X})$ 是互信息，$D$ 是期望失真，$\\beta  0$ 是一个固定的正常数。\n\n信源由一个字母表 $\\mathcal{X}$ 定义，其概率质量函数对于所有 $x \\in \\mathcal{X}$ 满足 $p(x)  0$。再现字母表是 $\\mathcal{\\hat{X}}$，任何信源符号 $x$ 和再现符号 $\\hat{x}$ 之间的失真由一个有限值 $d(x, \\hat{x})$ 给出。\n\n该迭代算法从对边缘再现分布 $q_0(\\hat{x})$ 的一个初始猜测开始，按如下步骤进行：\n\n1.  **在第 $k$ 次迭代中，更新条件分布：**\n    $$ q_{k+1}(\\hat{x}|x) = \\frac{q_k(\\hat{x}) \\exp(-\\beta d(x, \\hat{x}))}{\\sum_{\\hat{x}' \\in \\mathcal{\\hat{X}}} q_k(\\hat{x}') \\exp(-\\beta d(x, \\hat{x}'))} $$\n2.  **更新边缘再现分布：**\n    $$ q_{k+1}(\\hat{x}) = \\sum_{x \\in \\mathcal{X}} p(x) q_{k+1}(\\hat{x}|x) $$\n\n该学生对再现字母表上的分布做了一个特定的初始化选择。他们选择了一个特定的符号 $\\hat{x}_0 \\in \\mathcal{\\hat{X}}$ 并将其初始概率设为零，$q_0(\\hat{x}_0) = 0$。对于所有其他再现符号 $\\hat{x} \\in \\mathcal{\\hat{X}}$ 且 $\\hat{x} \\neq \\hat{x}_0$，其初始概率严格为正，$q_0(\\hat{x})  0$。\n\n对于算法的所有后续迭代（即，对于所有 $k \\ge 1$），下列哪个陈述是这种特定初始化策略的必然结果？\n\nA. 期望失真 $D_k = \\sum_{x, \\hat{x}} p(x)q_k(\\hat{x}|x)d(x,\\hat{x})$ 将是无穷大。\n\nB. 该算法必然会收敛到使泛函 $J$ 最小化的全局最优信道。\n\nC. 互信息 $I_k(X;\\hat{X})$ 将为零。\n\nD. 对于特定符号 $\\hat{x}_0$，其边缘概率将保持为零，即 $q_k(\\hat{x}_0) = 0$。\n\nE. 条件概率 $q_1(\\hat{x}_0|x)$ 对于至少一个信源符号 $x$ 将变为严格为正，因为算法试图纠正这个糟糕的初始化。", "solution": "Blahut-Arimoto 算法在第 $k$ 次迭代的更新步骤为\n$$\nq_{k+1}(\\hat{x}\\mid x)=\\frac{q_{k}(\\hat{x})\\exp(-\\beta d(x,\\hat{x}))}{\\sum_{\\hat{x}'\\in\\mathcal{\\hat{X}}}q_{k}(\\hat{x}')\\exp(-\\beta d(x,\\hat{x}'))},\\qquad\nq_{k+1}(\\hat{x})=\\sum_{x\\in\\mathcal{X}}p(x)q_{k+1}(\\hat{x}\\mid x).\n$$\n给定对于所有 $(x,\\hat{x})$ 都有 $\\beta0$ 和有限的 $d(x,\\hat{x})$，我们有对于所有 $(x,\\hat{x})$ 都有 $\\exp(-\\beta d(x,\\hat{x}))0$。\n\n假设初始化满足 $q_{0}(\\hat{x}_{0})=0$ 且对于所有 $\\hat{x}\\neq\\hat{x}_{0}$ 都有 $q_{0}(\\hat{x})0$。对于任何 $x\\in\\mathcal{X}$，在 $k=0$ 时对 $\\hat{x}_{0}$ 的更新得到\n$$\nq_{1}(\\hat{x}_{0}\\mid x)=\\frac{q_{0}(\\hat{x}_{0})\\exp(-\\beta d(x,\\hat{x}_{0}))}{\\sum_{\\hat{x}'\\in\\mathcal{\\hat{X}}}q_{0}(\\hat{x}')\\exp(-\\beta d(x,\\hat{x}'))}\n=\\frac{0}{\\sum_{\\hat{x}'\\neq\\hat{x}_{0}}q_{0}(\\hat{x}')\\exp(-\\beta d(x,\\hat{x}'))}=0,\n$$\n因为分母由于至少存在一个 $\\hat{x}'\\neq\\hat{x}_{0}$ 使得 $q_{0}(\\hat{x}')0$ 以及指数项严格为正，所以分母是严格为正的。因此，\n$$\nq_{1}(\\hat{x}_{0})=\\sum_{x\\in\\mathcal{X}}p(x)q_{1}(\\hat{x}_{0}\\mid x)=0.\n$$\n通过归纳法，假设对于某个 $k\\geq 0$ 有 $q_{k}(\\hat{x}_{0})=0$。那么对于所有的 $x$，\n$$\nq_{k+1}(\\hat{x}_{0}\\mid x)=\\frac{q_{k}(\\hat{x}_{0})\\exp(-\\beta d(x,\\hat{x}_{0}))}{\\sum_{\\hat{x}'\\in\\mathcal{\\hat{X}}}q_{k}(\\hat{x}')\\exp(-\\beta d(x,\\hat{x}'))}=0,\n$$\n这意味着\n$$\nq_{k+1}(\\hat{x}_{0})=\\sum_{x\\in\\mathcal{X}}p(x)q_{k+1}(\\hat{x}_{0}\\mid x)=0.\n$$\n因此，对于所有 $k\\geq 0$ 都有 $q_{k}(\\hat{x}_{0})=0$，并且对于所有 $x$ 和所有 $k\\geq 0$ 都有 $q_{k+1}(\\hat{x}_{0}\\mid x)=0$。\n\n基于此，我们评估各个选项：\n- A 是错误的，因为期望失真 $D_{k}=\\sum_{x,\\hat{x}}p(x)q_{k}(\\hat{x}\\mid x)d(x,\\hat{x})$ 是有限值 $d(x,\\hat{x})$ 的有限加权和，其非负权重之和为一；因此 $D_{k}$ 是有限的。\n- B 不被保证：通过对所有 $k$ 固定 $q_{k}(\\hat{x}_{0})=0$，算法被限制在支撑集为 $\\mathcal{\\hat{X}}\\setminus\\{\\hat{x}_{0}\\}$ 的信道上；如果全局最小化子为 $\\hat{x}_{0}$ 分配了正的概率质量，那么该解是不可达的。\n- C 不被保证：$I_{k}(X;\\hat{X})=\\sum_{x,\\hat{x}}p(x)q_{k}(\\hat{x}\\mid x)\\ln\\!\\left(\\frac{q_{k}(\\hat{x}\\mid x)}{q_{k}(\\hat{x})}\\right)$ 不必为零，除非对于所有 $x$ 都有 $q_{k}(\\hat{x}\\mid x)=q_{k}(\\hat{x})$，而更新步骤并不强制这一点。\n- D 被上述归纳法所保证：对于所有 $k\\geq 0$ 都有 $q_{k}(\\hat{x}_{0})=0$。\n- E 是错误的，因为如上所示，对于所有 $x$ 都有 $q_{1}(\\hat{x}_{0}\\mid x)=0$。\n\n因此，必然的结果是 $\\hat{x}_{0}$ 的边缘概率在所有迭代中都保持为零。", "answer": "$$\\boxed{D}$$", "id": "1605398"}]}