{"hands_on_practices": [{"introduction": "要掌握叠加编码，我们首先要从最基本的元素入手：理解弱用户的视角。弱用户面临最严峻的信道条件，必须在将强用户的信号视为额外噪声的情况下解码自己的信息。这个练习 [@problem_id:1661770] 将指导你计算这个基础速率，它为整个广播系统的性能设定了基准。", "problem": "考虑一个双用户高斯广播信道（GBC），其中单个发射机向两个独立的接收机发送信号。用户1和用户2接收到的信号由下式给出：\n$$Y_1 = X + Z_1$$\n$$Y_2 = X + Z_2$$\n\n其中，$X$ 是发射信号。$Z_1$ 和 $Z_2$ 是独立的随机变量，代表加性高斯白噪声（AWGN），其均值为零，方差分别为 $E[Z_1^2] = N_1$ 和 $E[Z_2^2] = N_2$。该信道是降级信道，用户2的信道噪声更大，即 $N_2  N_1$。\n\n为了同时服务两个用户，发射机采用叠加编码。发射信号构造为 $X = X_1 + X_2$，其中 $X_1$ 是为用户1（强用户）承载信息的信号，$X_2$ 是为用户2（弱用户）承载信息的信号。信号 $X_1$ 和 $X_2$ 由独立的高斯码本生成，并且也与噪声变量 $Z_1$ 和 $Z_2$ 相互独立。\n\n发射信号的总平均功率受限于 $P$。该功率的一部分 $\\alpha$ 分配给用户2的信号，因此 $E[X_2^2] = \\alpha P$。剩余功率分配给用户1的信号，因此 $E[X_1^2] = (1-\\alpha)P$，其中 $0 \\le \\alpha \\le 1$。\n\n在该方案中，用户2通过将发给用户1的信号（$X_1$）视为总噪声的一部分来解码自己的消息（来自信号 $X_2$）。\n\n确定在此策略下用户2可实现的最大通信速率 $R_2$。请用 $P$、$N_2$ 和功率分配因子 $\\alpha$ 的封闭形式解析表达式来表示您的答案。", "solution": "用户2观测到 $Y_{2} = X_{1} + X_{2} + Z_{2}$。当用户2将 $X_{1}$ 视为噪声时，定义有效噪声为 $W \\triangleq X_{1} + Z_{2}$。因为 $X_{1}$ 和 $Z_{2}$ 是独立的零均值高斯变量，其方差分别为 $E[X_{1}^{2}] = (1-\\alpha)P$ 和 $E[Z_{2}^{2}] = N_{2}$，所以它们的和 $W$ 是一个高斯变量，其方差为\n$$\n\\operatorname{Var}(W) = (1-\\alpha)P + N_{2}.\n$$\n用户2的期望信号是 $X_{2}$，其功率为 $E[X_{2}^{2}] = \\alpha P$，且与 $W$ 独立。因此，用户2的有效信道是一个AWGN信道\n$$\nY_{2} = X_{2} + W,\n$$\n信号功率为 $\\alpha P$，噪声方差为 $(1-\\alpha)P + N_{2}$。\n\n对于实数AWGN信道上的高斯输入，可达速率等于互信息 $I(X_{2};Y_{2}) = h(Y_{2}) - h(Y_{2}\\mid X_{2})$。由于 $X_{2}$ 和 $W$ 是独立的高斯变量，$Y_{2} = X_{2} + W$ 是一个高斯变量，其方差为\n$$\n\\operatorname{Var}(Y_{2}) = \\alpha P + (1-\\alpha)P + N_{2} = P + N_{2}.\n$$\n因此，\n$$\nh(Y_{2}) = \\frac{1}{2}\\ln\\!\\big(2\\pi e\\,(P+N_{2})\\big),\\qquad\nh(Y_{2}\\mid X_{2}) = h(W) = \\frac{1}{2}\\ln\\!\\big(2\\pi e\\,((1-\\alpha)P+N_{2})\\big).\n$$\n相减得到\n$$\nI(X_{2};Y_{2}) = \\frac{1}{2}\\ln\\!\\left(\\frac{P+N_{2}}{(1-\\alpha)P+N_{2}}\\right)\n= \\frac{1}{2}\\ln\\!\\left(1 + \\frac{\\alpha P}{(1-\\alpha)P + N_{2}}\\right).\n$$\n因此，在此策略下用户2可实现的最大速率为\n$$\nR_{2} = \\frac{1}{2}\\ln\\!\\left(1 + \\frac{\\alpha P}{(1-\\alpha)P + N_{2}}\\right).\n$$", "answer": "$$\\boxed{\\frac{1}{2}\\ln\\!\\left(1+\\frac{\\alpha P}{(1-\\alpha)P+N_{2}}\\right)}$$", "id": "1661770"}, {"introduction": "在掌握了基础知识之后，我们现在来解决一个常见的工程目标：为实现公平性而进行的资源分配。在叠加编码中，发射功率是一种可以在用户之间分配的资源。这个实践问题 [@problem_id:1661703] 要求你找到精确的功率分配方案，使得强用户和弱用户能够达到完全相同的数据速率，从而揭示了系统内在的权衡关系。", "problem": "一个蜂窝基站正在通过广播信道与两个用户（用户 A 和用户 B）进行通信。到用户 A 的信道明显优于到用户 B 的信道。该场景可以建模为两个并行的加性高斯白噪声 (AWGN) 信道。用户 A 接收到的信号为 $Y_A = X + Z_A$，用户 B 接收到的信号为 $Y_B = X + Z_B$。这里，$X$ 是基站发射的信号，$Z_A$ 和 $Z_B$ 是独立的零均值高斯噪声过程，其方差分别为 $N_A$ 和 $N_B$，其中 $N_A  N_B$。\n\n基站采用叠加编码向两个用户发送独立的消息。发射信号形如 $X = U_A + U_B$，其中 $U_A$ 和 $U_B$ 分别是为用户 A 和用户 B 编码的信号。信号 $U_A$ 和 $U_B$ 由独立的零均值高斯码本生成。总发射功率受到约束，使得 $X$ 的期望功率为 $P$。总功率 $P$ 的一部分 $\\alpha$ 分配给信号 $U_B$（较弱用户的信号），使得 $E[U_B^2] = \\alpha P$，其中 $0 \\le \\alpha \\le 1$。剩余功率分配给 $U_A$。\n\n设 $R_A$ 和 $R_B$ 分别为在此方案下用户 A 和用户 B 的最大可实现数据速率。求使两个用户的数据速率相等的功率分配因子 $\\alpha$ 的具体值，即 $R_A = R_B$。将你的答案表示为关于总功率 $P$ 以及噪声方差 $N_A$ 和 $N_B$ 的单个闭式解析表达式。", "solution": "对于高斯信令，信噪比为 $s$ 的实数 AWGN 信道的容量为 $C=\\frac{1}{2}\\ln(1+s)$ 奈特/信道使用。对于降级高斯广播信道，采用叠加编码和功率分配 $E[U_B^{2}]=\\alpha P$，$E[U_A^{2}]=(1-\\alpha)P$，用户 B（较弱用户）将 $U_A$ 视作噪声来解码 $U_B$，而用户 A（较强用户）首先解码 $U_B$ 并将其消除，然后再解码 $U_A$。\n\n因此，可实现的速率为\n$$\nR_B=\\frac{1}{2}\\ln\\!\\left(1+\\frac{\\alpha P}{N_B+(1-\\alpha)P}\\right),\\qquad\nR_A=\\frac{1}{2}\\ln\\!\\left(1+\\frac{(1-\\alpha)P}{N_A}\\right).\n$$\n为了使速率相等，令 $R_A=R_B$。由于 $\\frac{1}{2}\\ln(\\cdot)$ 是严格递增的，这等价于\n$$\n1+\\frac{(1-\\alpha)P}{N_A}=1+\\frac{\\alpha P}{N_B+(1-\\alpha)P}.\n$$\n消去 1 和 $P0$，得到\n$$\n\\frac{1-\\alpha}{N_A}=\\frac{\\alpha}{N_B+(1-\\alpha)P}.\n$$\n交叉相乘得到\n$$\n(1-\\alpha)\\bigl(N_B+(1-\\alpha)P\\bigr)=\\alpha N_A.\n$$\n展开并重新整理得到一个关于 $\\alpha$ 的二次方程：\n$$\nP\\alpha^{2}-(N_A+N_B+2P)\\alpha+(N_B+P)=0.\n$$\n在 $[0,1]$ 区间内具有物理意义的根是\n$$\n\\alpha=\\frac{N_A+N_B+2P-\\sqrt{(N_A+N_B)^{2}+4PN_A}}{2P}.\n$$\n这是使 $R_A$ 和 $R_B$ 相等的唯一功率分配。", "answer": "$$\\boxed{\\frac{2P+N_{A}+N_{B}-\\sqrt{(N_{A}+N_{B})^{2}+4PN_{A}}}{2P}}$$", "id": "1661703"}, {"introduction": "现在，让我们将理解拓展到一个更复杂、更现实的场景中。这个高级练习 [@problem_id:1661771] 将双用户模型推广到了一个具有复杂消息层级的三用户降级广播信道。通过为私有消息、半公共消息和公共消息设计编码方案，你将看到叠加编码和连续干扰消除的核心原理如何被优雅地分层应用，以满足多个用户的不同需求。", "problem": "一个卫星通信系统设计用于向三个地面站广播信息，这可以被建模为一个三用户降级高斯广播信道。用户 $i$ 处的接收信号由 $Y_i = X + Z_i$ 给出，其中 $X$ 是来自卫星的发射信号，$Z_i$ 是一个独立的、零均值的加性高斯白噪声 (AWGN) 项，其方差为 $N_i$。该信道是降级的，意味着噪声方差排序为 $N_1  N_2  N_3$，因此用户1的信道最好，用户3的信道最差。卫星对信号 $X$ 有一个总平均功率约束 $P$。\n\n卫星采用叠加编码来同时传输三个不同的消息：\n1.  一个私有消息 $W_p$，仅供用户1使用。\n2.  一个半公共消息 $W_s$，供用户1和用户2共同使用。\n3.  一个公共消息 $W_c$，供所有三个用户使用。\n\n为实现此目的，发射信号 $X$ 是三个独立的、零均值的高斯码本之和，$X = U_p + U_s + U_c$，其平均功率分别为 $P_p = E[U_p^2]$、$P_s = E[U_s^2]$ 和 $P_c = E[U_c^2]$，满足 $P_p + P_s + P_c = P$。接收机使用连续干扰消除 (SIC) 进行解码。信号功率为 $S$、噪声功率为 $N$ 的AWGN信道容量由 $\\frac{1}{2}\\ln(1 + S/N)$ 给出，单位是奈特/信道使用。\n\n该系统以实现对称速率的方式运行，其中所有三个消息的数据速率均相同：$R_p = R_s = R_c = R$。选择功率分配 $(P_p, P_s, P_c)$ 以最大化此对称速率 $R$。在为稳健性能设计的特定操作模式下，总发射功率 $P$ 被专门配置为 $P = 4N_1 + 2N_2 + N_3$。\n\n确定在此特定功率配置下可实现的最大对称速率 $R$。请用一个解析表达式表示您的答案，单位为奈特/信道使用。", "solution": "问题要求解在特定消息结构和特殊功率约束下，三用户降级高斯广播信道的最大对称速率 $R$。我们将使用叠加编码和连续干扰消除 (SIC) 的原理。\n\n首先，我们根据解码顺序确定每个消息的可实现速率。解码必须从最公共的消息进行到最私有的消息。\n\n1.  **公共消息 ($W_c$)：** 此消息必须能被所有用户解码。用户3是瓶颈，因为它具有最高的噪声方差 ($N_3$)。用户3在解码 $U_c$ 时，将 $U_p$ 和 $U_s$ 视为额外噪声。\n    $W_c$ 的信号功率为 $P_c$。\n    用户3的总噪声功率为 $P_p + P_s + N_3$。\n    因此，公共消息的最大可实现速率 $R_c$ 受限于用户3的容量：\n    $$R_c \\le \\frac{1}{2}\\ln\\left(1 + \\frac{P_c}{P_p + P_s + N_3}\\right)$$\n\n2.  **半公共消息 ($W_s$)：** 此消息必须能被用户1和用户2解码。由于 $N_1  N_2$，用户2是此消息的瓶颈。为了解码 $W_s$，用户2必须首先成功解码 $W_c$，并从其接收信号中减去相应的信号 $U_c$ (SIC)。SIC之后，用户2的剩余信号为 $Y_2' = U_p + U_s + Z_2$。现在，用户2在解码 $U_s$ 时将 $U_p$ 视为噪声。\n    $W_s$ 的信号功率为 $P_s$。\n    SIC后用户2的噪声功率为 $P_p + N_2$。\n    半公共消息的最大可实现速率 $R_s$ 受限于用户2的容量：\n    $$R_s \\le \\frac{1}{2}\\ln\\left(1 + \\frac{P_s}{P_p + N_2}\\right)$$\n    （注：为了让用户2首先能解码 $W_c$，其速率必须至少为 $R_c$。由于 $N_2  N_3$，用户2的信道比用户3好，所以如果用户3能解码 $W_c$，用户2也一定能。这个条件没有约束力。）\n\n3.  **私有消息 ($W_p$)：** 此消息仅供用户1使用。用户1首先解码 $W_c$ 并减去 $U_c$，然后解码 $W_s$ 并减去 $U_s$。经过两级SIC后，剩余信号为 $Y_1'' = U_p + Z_1$。\n    $W_p$ 的信号功率为 $P_p$。\n    用户1的噪声功率仅为 $N_1$。\n    私有消息的最大可实现速率 $R_p$ 为：\n    $$R_p \\le \\frac{1}{2}\\ln\\left(1 + \\frac{P_p}{N_1}\\right)$$\n\n为了最大化对称速率 $R = R_p = R_s = R_c$，我们必须满足所有三个不等式，这意味着我们应将它们变为等式。我们定义一个变量 $K = \\exp(2R)$。由于 $R0$，我们有 $K1$。\n\n从这三个速率方程，我们得到：\n(i) $K = 1 + \\frac{P_p}{N_1} \\implies P_p = N_1(K-1)$\n(ii) $K = 1 + \\frac{P_s}{P_p + N_2} \\implies P_s = (K-1)(P_p + N_2)$\n(iii) $K = 1 + \\frac{P_c}{P_p + P_s + N_3} \\implies P_c = (K-1)(P_p + P_s + N_3)$\n\n我们得到了一个关于功率 $P_p, P_s, P_c$ 的以 $K$ 为参数的方程组。我们可以使用累积功率水平更清晰地表达它们。让我们定义以下自然出现在分母中的累积和：\n$S_1 = P_p + N_1$\n$S_2 = P_p + P_s + N_2$\n$S_3 = P_p + P_s + P_c + N_3 = P + N_3$\n\n从我们的速率方程：\n从(i)：$P_p/N_1 = K-1 \\implies P_p+N_1 = KN_1 \\implies S_1 = KN_1$。\n从(ii)：$P_s/(P_p+N_2) = K-1 \\implies P_s+(P_p+N_2) = K(P_p+N_2) \\implies S_2 = K(P_p+N_2)$。\n从(iii)：$P_c/(P_p+P_s+N_3) = K-1 \\implies P_c+(P_p+P_s+N_3) = K(P_p+P_s+N_3) \\implies S_3=K(P_p+P_s+N_3)$。\n\n现在我们建立一个递归关系。\n从 $S_2 = K(P_p+N_2)$，代入 $P_p=S_1-N_1$：\n$S_2 = K((S_1-N_1)+N_2) = K(S_1 + N_2 - N_1)$。\n代入 $S_1 = KN_1$：\n$S_2 = K(KN_1 + N_2 - N_1) = N_1 K^2 + (N_2 - N_1)K$。\n\n接下来，从 $S_3 = K(P_p+P_s+N_3)$，代入 $P_p+P_s = S_2 - N_2$：\n$S_3 = K((S_2-N_2)+N_3) = K(S_2 + N_3 - N_2)$。\n代入 $S_2$ 的表达式：\n$S_3 = K( (N_1 K^2 + (N_2 - N_1)K) + N_3 - N_2) = N_1 K^3 + (N_2 - N_1)K^2 + (N_3 - N_2)K$。\n\n我们还知道 $S_3 = P + N_3$。将 $S_3$ 的两个表达式相等：\n$P + N_3 = N_1 K^3 + (N_2 - N_1)K^2 + (N_3 - N_2)K$。\n\n这是关于 $K = \\exp(2R)$ 的核心三次方程。问题给出了总功率的一个特定条件：$P = 4N_1 + 2N_2 + N_3$。\n让我们将此代入我们方程的左侧：\n$P + N_3 = (4N_1 + 2N_2 + N_3) + N_3 = 4N_1 + 2N_2 + 2N_3$。\n\n所以方程变为：\n$N_1 K^3 + (N_2 - N_1)K^2 + (N_3 - N_2)K = 4N_1 + 2N_2 + 2N_3$。\n\n我们来检验 $K=2$ 是否是这个方程的一个解。\n将 $K=2$ 代入左侧 (LHS)：\nLHS = $N_1 (2)^3 + (N_2 - N_1)(2)^2 + (N_3 - N_2)(2)$\nLHS = $8N_1 + 4(N_2 - N_1) + 2(N_3 - N_2)$\nLHS = $8N_1 + 4N_2 - 4N_1 + 2N_3 - 2N_2$\nLHS = $(8-4)N_1 + (4-2)N_2 + 2N_3$\nLHS = $4N_1 + 2N_2 + 2N_3$。\n\n这与右侧 (RHS) 完全相等。因此，$K=2$ 是该多项式方程的一个根。\n设 $f(K) = N_1 K^3 + (N_2 - N_1)K^2 + (N_3 - N_2)K$。其导数为 $f'(K) = 3N_1 K^2 + 2(N_2 - N_1)K + (N_3 - N_2)$。由于 $N_1  0$，$N_2 - N_1  0$ 且 $N_3 - N_2  0$，所以 $f'(K)$ 的所有系数都是正的。对于 $K0$，$f'(K)0$，这意味着 $f(K)$ 是一个在正数域上严格递增的函数。\n这意味着方程 $f(K) = P+N_3$ 有一个唯一的正实根。\n既然我们发现 $K=2$ 是一个根，那么它必定是这个唯一的正根。\n\n找到了 $K$ 的唯一有效解后，我们可以求出对称速率 $R$：\n$K = \\exp(2R) \\implies 2 = \\exp(2R)$\n$\\ln(2) = 2R$\n$R = \\frac{1}{2}\\ln(2)$。\n\n最大可实现的对称速率是 $\\frac{1}{2}\\ln(2)$ 奈特/信道使用。", "answer": "$$\\boxed{\\frac{1}{2}\\ln(2)}$$", "id": "1661771"}]}