{"hands_on_practices": [{"introduction": "本练习是后验概率最大化（MAP）解码的一个基本应用。我们将为一个具有不均匀先验概率的二元信源，在经过一个典型的二元对称信道（BSC）后，推导其最优决策规则。通过这个练习，你将掌握如何结合信源的先验知识和信道的统计特性来做出最可靠的推断，这是MAP解码的核心思想。[@problem_id:1639810]", "problem": "一个远程环境监测系统使用一个二进制传感器来传输其探测结果。传感器的状态由一个二进制随机变量 $X$ 表示，其中 $X=0$ 表示“正常”状态，$X=1$ 表示“警报”状态。长期数据显示“正常”状态更常见，其先验概率为 $P(X=0) = 0.7$ 和 $P(X=1) = 0.3$。\n\n传感器的状态通过一个有噪声的通信链路传输到基站，该链路表现为二进制对称信道（BSC）。BSC 由单个参数，即交叉概率 $p$ 来表征，它是指传输的比特被错误接收的概率（即，'0'被接收为'1'或'1'被接收为'0'）。对于这个特定的信道，交叉概率为 $p = 0.1$。\n\n在基站，解码器接收一个符号 $Y \\in \\{0, 1\\}$，并且必须对原始传输的符号 $X$ 做出估计 $\\hat{X}$。为了达到最低的错误决策率，采用了最大后验概率（MAP）决策准则。\n\n你的任务是确定具体的 MAP 决策准则以及由此产生的平均错误概率 $P_e = P(\\hat{X} \\neq X)$。该决策准则由输出对 $(\\hat{X}(Y=0), \\hat{X}(Y=1))$ 完全描述，它为每个可能接收到的符号指定了估计值。\n\n以下哪个选项正确地陈述了 MAP 决策准则及相应的平均错误概率？\n\nA. 准则是 $(\\hat{X}(Y=0), \\hat{X}(Y=1)) = (0, 1)$，且 $P_e = 0.10$。\n\nB. 准则是 $(\\hat{X}(Y=0), \\hat{X}(Y=1)) = (0, 0)$，且 $P_e = 0.30$。\n\nC. 准则是 $(\\hat{X}(Y=0), \\hat{X}(Y=1)) = (0, 1)$，且 $P_e = 0.07$。\n\nD. 准则是 $(\\hat{X}(Y=0), \\hat{X}(Y=1)) = (0, 0)$，且 $P_e = 0.10$。\n\nE. 准则是 $(\\hat{X}(Y=0), \\hat{X}(Y=1)) = (1, 0)$，且 $P_e = 0.90$。", "solution": "我们已知一个二进制信源，其先验概率为 $P(X=0)=0.7$ 和 $P(X=1)=0.3$，以及一个交叉概率为 $p=0.1$ 的二进制对称信道（BSC）。接收到的符号是 $Y \\in \\{0,1\\}$。MAP 准则对于每个接收到的 $y$，选择使后验概率 $P(X=x \\mid Y=y)$ 最大化的假设 $x \\in \\{0,1\\}$，这等价于最大化乘积 $P(Y=y \\mid X=x)P(X=x)$。\n\n对于 BSC，似然函数为\n$$\nP(Y=y \\mid X=x)=\\begin{cases}\n1-p,   y=x,\\\\\np,     y \\neq x.\n\\end{cases}\n$$\n\n对于 $Y=0$ 的决策：比较 $P(Y=0|X=0)P(X=0)$ 与 $P(Y=0|X=1)P(X=1)$。\n$$\n(1-p)P(X=0) \\quad \\text{vs.} \\quad p P(X=1)\n$$\n代入给定值，\n$$\n(1-0.1)\\cdot 0.7 = 0.63 \\quad \\text{and} \\quad 0.1 \\cdot 0.3 = 0.03,\n$$\n由于 $0.63 > 0.03$，MAP 决策为 $\\hat{X}(Y=0)=0$。\n\n对于 $Y=1$ 的决策：比较 $P(Y=1|X=0)P(X=0)$ 与 $P(Y=1|X=1)P(X=1)$。\n$$\np P(X=0) \\quad \\text{vs.} \\quad (1-p)P(X=1)\n$$\n代入，\n$$\n0.1 \\cdot 0.7 = 0.07 \\quad \\text{and} \\quad (1-0.1)\\cdot 0.3 = 0.27,\n$$\n由于 $0.07  0.27$，MAP 决策为 $\\hat{X}(Y=1)=1$。\n\n因此，MAP 准则是 $(\\hat{X}(Y=0), \\hat{X}(Y=1))=(0,1)$。\n\n接下来，计算此准则下的平均错误概率：\n$$\nP_{e} = P(X=0) P(\\text{error} \\mid X=0) + P(X=1) P(\\text{error} \\mid X=1).\n$$\n根据该准则，当且仅当信道翻转了比特时才会发生错误：\n当 $X=0$ 时，我们接收到 $Y=1$ 会发生错误，其概率为 $p$。\n当 $X=1$ 时，我们接收到 $Y=0$ 会发生错误，其概率为 $p$。\n因此，\n$$\nP_{e} = P(X=0)\\,p + P(X=1)\\,p = p\\big(P(X=0)+P(X=1)\\big) = p = 0.1.\n$$\n\n所以，正确的选项是准则 $(0,1)$ 且 $P_{e}=0.10$。", "answer": "$$\\boxed{A}$$", "id": "1639810"}, {"introduction": "这个实践问题将MAP解码的应用从简单的二元场景扩展到更复杂的编码系统。你将为一个三元信源（其码字通过两个独立的、具有不同错误率的信道）进行解码，特别是当收到的序列不是任何一个有效码字时。这个问题旨在训练你在非理想条件下，权衡先验概率和多个不同信道似然度的能力，以找出最可能的原始信息。[@problem_id:1639840]", "problem": "一个专用数据存储系统处理三种类型的数据包，分别标记为 A、B 和 C。遇到每种数据包类型的先验概率由 $P(X=A) = \\frac{1}{2}$、$P(X=B) = \\frac{1}{3}$ 和 $P(X=C) = \\frac{1}{6}$ 给出，其中 $X$ 是表示数据包类型的随机变量。存储之前，每个数据包被编码为一个 2 比特的码字，规则如下：\n- 数据包 A 编码为 `00`。\n- 数据包 B 编码为 `01`。\n- 数据包 C 编码为 `11`。\n\n码字的两个比特分别存储在两个独立且相互独立的内存模块中。第一个比特存储在模块 1 中，第二个比特存储在模块 2 中。两个模块都会发生比特翻转错误，并且可以被建模为通信信道。模块 1 的行为类似于一个二进制对称信道 (BSC)，其交叉概率（比特翻转的概率）为 $p_1 = 0.1$。模块 2 的可靠性较低，被建模为一个交叉概率为 $p_2 = 0.2$ 的 BSC。\n\n假设在检索时，从内存模块中读取的 2 比特序列为 $Y = `10`$。根据这一观测结果，哪种原始数据包类型最有可能被存储？你的任务是确定原始数据包 $X$ 的最大后验 (MAP) 估计。\n\n以下哪一项代表了原始数据包的 MAP 估计？\n\nA. A\n\nB. B\n\nC. C\n\nD. B 和 C 等可能性且比 A 的可能性更大。\n\nE. 根据给定信息无法确定。", "solution": "我们要求最大后验 (MAP) 估计，其定义为\n$$\n\\hat{x}_{\\text{MAP}}=\\arg\\max_{x\\in\\{A,B,C\\}} P(X=x\\mid Y=10),\n$$\n这等价于最大化与先验概率乘以似然函数成正比的后验概率：\n$$\nP(X=x\\mid Y=10)\\propto P(Y=10\\mid X=x)P(X=x).\n$$\n编码是确定性的：$A\\mapsto 00$，$B\\mapsto 01$，$C\\mapsto 11$。这两个内存模块是独立的二进制对称信道，第一个比特的交叉概率为 $p_{1}$，第二个比特的交叉概率为 $p_{2}$。对于一个 BSC，不发生翻转的概率是 $1-p$，发生翻转的概率是 $p$。由于模块独立地作用于两个比特，似然函数可以分解为\n$$\nP(Y=10\\mid X=x)=P(Y_{1}=1\\mid \\text{bit}_{1}(x))\\cdot P(Y_{2}=0\\mid \\text{bit}_{2}(x)).\n$$\n计算每个似然值：\n- 对于 $X=A$ (码字 $00$)：第一个比特翻转 ($0\\to 1$) 的概率为 $p_{1}$，第二个比特不翻转 ($0\\to 0$) 的概率为 $1-p_{2}$，所以\n$$\nP(Y=10\\mid X=A)=p_{1}(1-p_{2}).\n$$\n- 对于 $X=B$ (码字 $01$)：第一个比特翻转 ($0\\to 1$) 的概率为 $p_{1}$，第二个比特翻转 ($1\\to 0$) 的概率为 $p_{2}$，所以\n$$\nP(Y=10\\mid X=B)=p_{1}p_{2}.\n$$\n- 对于 $X=C$ (码字 $11$)：第一个比特不翻转 ($1\\to 1$) 的概率为 $1-p_{1}$，第二个比特翻转 ($1\\to 0$) 的概率为 $p_{2}$，所以\n$$\nP(Y=10\\mid X=C)=(1-p_{1})p_{2}.\n$$\n乘以先验概率以形成未归一化的后验概率：\n$$\nS_{A}=P(X=A)P(Y=10\\mid X=A)=\\frac{1}{2}\\,p_{1}(1-p_{2}),\n$$\n$$\nS_{B}=P(X=B)P(Y=10\\mid X=B)=\\frac{1}{3}\\,p_{1}p_{2},\n$$\n$$\nS_{C}=P(X=C)P(Y=10\\mid X=C)=\\frac{1}{6}\\,(1-p_{1})p_{2}.\n$$\n代入 $p_{1}=0.1 = \\frac{1}{10}$ 和 $p_{2}=0.2 = \\frac{1}{5}$：\n$$\nS_{A}=\\frac{1}{2}\\cdot \\frac{1}{10}\\cdot \\left(1-\\frac{1}{5}\\right)=\\frac{1}{2}\\cdot \\frac{1}{10}\\cdot \\frac{4}{5}=\\frac{4}{100}=\\frac{1}{25},\n$$\n$$\nS_{B}=\\frac{1}{3}\\cdot \\frac{1}{10}\\cdot \\frac{1}{5}=\\frac{1}{150},\n$$\n$$\nS_{C}=\\frac{1}{6}\\cdot \\left(1-\\frac{1}{10}\\right)\\cdot \\frac{1}{5}=\\frac{1}{6}\\cdot \\frac{9}{10}\\cdot \\frac{1}{5}=\\frac{9}{300}=\\frac{3}{100}.\n$$\n比较这些值：\n$$\nS_A = \\frac{1}{25} = \\frac{6}{150}, \\quad S_B = \\frac{1}{150}, \\quad S_C = \\frac{3}{100} = \\frac{4.5}{150}.\n$$\n因此，$S_A > S_C > S_B$。\n具有最大后验概率的原始数据包是 A。", "answer": "$$\\boxed{A}$$", "id": "1639840"}, {"introduction": "本练习将MAP解码从单个符号的决策推向序列估计的领域，这在许多现实世界应用中至关重要。你将处理一个具有马尔可夫性质（即当前状态依赖于前一状态）的信源，并学习如何通过递归计算来更新你对隐藏状态的置信度。这个问题是理解隐马尔可夫模型（HMM）和维特比等高级解码算法的重要一步。[@problem_id:1639803]", "problem": "考虑一个数据存储系统的简化模型，其中二进制比特由一个随机变量序列 $\\{X_k\\}_{k=1,2,3,...}$（其中 $X_k \\in \\{0, 1\\}$）表示，并被顺序存储。由于相邻存储单元之间的物理相互作用，该系统表现为一个一阶二元马尔可夫源。对于 $k \\ge 2$，转移概率由 $P(X_k = 1 | X_{k-1} = 0) = 0.2$ 和 $P(X_k = 0 | X_{k-1} = 1) = 0.3$ 给出。对于第一个比特，其概率相等，即 $P(X_1=0) = P(X_1=1) = 0.5$。\n\n当读取数据时，该过程会受到噪声的干扰，这种噪声被建模为一个无记忆二元对称信道 (BSC)。BSC 的交叉概率为 $\\epsilon = 0.1$，这意味着在读出过程中一个比特被翻转的概率是 $0.1$。设 $\\{Y_k\\}_{k=1,2,3,...}$ 是从存储系统中读出的比特序列。\n\n一位操作员从设备中读取前三个比特，获得序列 $Y_1=1, Y_2=0, Y_3=1$。为执行最优的逐比特最大后验 (MAP) 决策，操作员需要根据截至该点的观测序列，计算每个已发送比特的后验概率。\n\n计算后验概率 $P(X_3=1 | Y_1=1, Y_2=0, Y_3=1)$。将最终答案四舍五入到四位有效数字。", "solution": "我们将隐藏的比特建模为一个一阶二元马尔可夫链，其转移概率为\n$$\nP(X_{k}=1\\mid X_{k-1}=0)=0.2,\\quad P(X_{k}=0\\mid X_{k-1}=1)=0.3,\n$$\n因此\n$$\nP(X_{k}=0\\mid X_{k-1}=0)=1-0.2=0.8,\\quad P(X_{k}=1\\mid X_{k-1}=1)=1-0.3=0.7,\n$$\n初始分布为\n$$\nP(X_{1}=0)=P(X_{1}=1)=0.5.\n$$\n观测值通过一个交叉概率为 $\\epsilon=0.1$ 的无记忆二元对称信道，因此对于每个 $k$，\n$$\nP(Y_{k}=y\\mid X_{k}=x)=\\begin{cases}\n1-\\epsilon=0.9,  y=x,\\\\\n\\epsilon=0.1,  y\\neq x.\n\\end{cases}\n$$\n我们使用前向算法计算联合概率。定义前向变量 $\\alpha_{k}(x)=P(X_{k}=x, Y_{1}=y_{1},\\ldots,Y_{k}=y_{k})$。\n递归关系为\n$$\n\\alpha_{k}(x_{k})=P(Y_{k}=y_{k}\\mid X_{k}=x_{k})\\sum_{x_{k-1}\\in\\{0,1\\}}P(X_{k}=x_{k}\\mid X_{k-1}=x_{k-1})\\,\\alpha_{k-1}(x_{k-1}).\n$$\n\n**第1步：k=1**\n给定 $y_{1}=1$，我们有\n$$\n\\alpha_{1}(0)=P(Y_{1}=1\\mid X_{1}=0)P(X_{1}=0)=0.1\\cdot 0.5=0.05.\n$$\n$$\n\\alpha_{1}(1)=P(Y_{1}=1\\mid X_{1}=1)P(X_{1}=1)=0.9\\cdot 0.5=0.45.\n$$\n\n**第2步：k=2**\n给定 $y_{2}=0$，我们首先计算 $X_2$ 的预测概率与 $Y_1$ 的联合概率：\n$$\nP(X_{2}=0, Y_1=1) = \\sum_{x_{1}}P(X_{2}=0\\mid X_{1}=x_{1})\\alpha_{1}(x_{1}) = 0.8\\cdot 0.05 + 0.3\\cdot 0.45 = 0.04 + 0.135 = 0.175.\n$$\n$$\nP(X_{2}=1, Y_1=1) = \\sum_{x_{1}}P(X_{2}=1\\mid X_{1}=x_{1})\\alpha_{1}(x_{1}) = 0.2\\cdot 0.05 + 0.7\\cdot 0.45 = 0.01 + 0.315 = 0.325.\n$$\n现在更新前向变量：\n$$\n\\alpha_{2}(0)=P(Y_2=0|X_2=0) \\cdot P(X_{2}=0, Y_1=1) = 0.9\\cdot 0.175=0.1575.\n$$\n$$\n\\alpha_{2}(1)=P(Y_2=0|X_2=1) \\cdot P(X_{2}=1, Y_1=1) = 0.1\\cdot 0.325=0.0325.\n$$\n\n**第3步：k=3**\n给定 $y_{3}=1$，我们计算 $X_3$ 的预测概率与 $Y_1,Y_2$ 的联合概率：\n$$\nP(X_3=0, Y_{1,2}) = \\sum_{x_{2}}P(X_3=0\\mid X_{2}=x_{2})\\alpha_{2}(x_{2})=0.8\\cdot 0.1575 + 0.3\\cdot 0.0325 = 0.126 + 0.00975 = 0.13575.\n$$\n$$\nP(X_3=1, Y_{1,2}) = \\sum_{x_{2}}P(X_3=1\\mid X_{2}=x_{2})\\alpha_{2}(x_{2})=0.2\\cdot 0.1575 + 0.7\\cdot 0.0325 = 0.0315 + 0.02275 = 0.05425.\n$$\n现在更新前向变量：\n$$\n\\alpha_{3}(0)=P(Y_3=1|X_3=0) \\cdot P(X_3=0, Y_{1,2})=0.1\\cdot 0.13575 = 0.013575.\n$$\n$$\n\\alpha_{3}(1)=P(Y_3=1|X_3=1) \\cdot P(X_3=1, Y_{1,2})=0.9\\cdot 0.05425 = 0.048825.\n$$\n\n**第4步：计算后验概率**\n我们要求的后验概率为\n$$\nP(X_{3}=1\\mid Y_{1}=1,Y_{2}=0,Y_{3}=1)=\\frac{\\alpha_{3}(1)}{\\alpha_{3}(0)+\\alpha_{3}(1)} = \\frac{0.048825}{0.013575+0.048825} = \\frac{0.048825}{0.0624}.\n$$\n使用分数进行精确计算：\n$\\alpha_3(0) = \\frac{543}{40000}$, $\\alpha_3(1) = \\frac{1953}{40000}$.\n$$\nP(X_3=1 | Y_1,Y_2,Y_3) = \\frac{1953/40000}{543/40000 + 1953/40000} = \\frac{1953}{543+1953} = \\frac{1953}{2496} = \\frac{651}{832}.\n$$\n数值上，\n$$\n\\frac{651}{832}\\approx 0.782451923\\ldots\n$$\n四舍五入到四位有效数字是 $0.7825$。", "answer": "$$\\boxed{0.7825}$$", "id": "1639803"}]}