{"hands_on_practices": [{"introduction": "让我们从一个基础场景开始，掌握注水算法的核心机制。这个练习要求你在两个噪声水平不同的信道间，对固定的总功率进行最优分配，为理解如何最大化通信容量提供了坚实的入门。在此应用注水原理 [@problem_id:1668042] 将为解决更复杂的问题奠定基础。", "problem": "一个无线通信系统在两个独立的、互不干扰的频段上运行。每个频段都可以被建模为一个并行的加性高斯白噪声（AWGN）信道，其中 AWGN 指的是一种信道模型，其唯一的损伤是线性叠加了具有恒定谱密度和高斯幅度分布的宽带或白噪声。为便于解决此问题，假设两个频段的信道功率增益均为单位1。\n\n第一个频段的噪声功率由方差 $\\sigma_1^2 = 1.0$（任意单位）表征，而第二个频段的噪声功率方差为 $\\sigma_2^2 = 3.0$（任意单位）。发射机有总功率预算 $P = 4.0$（任意单位），可以分配给这两个频段。\n\n为了在两个信道上实现最大可能的总信息论容量，必须采用最优的功率分配策略。确定分配给第一个信道的最佳功率 $P_1$ 和分配给第二个信道的最佳功率 $P_2$。\n\n以数值对 $(P_1, P_2)$ 的形式给出你的答案，单位为任意单位。", "solution": "我们将这两个频段建模为具有单位增益和噪声方差 $\\sigma_{1}^{2}$ 及 $\\sigma_{2}^{2}$ 的并行 AWGN 信道。设 $P_{1}$ 和 $P_{2}$ 是分配给信道1和信道2的功率，满足 $P_{1} \\ge 0$、 $P_{2} \\ge 0$ 且 $P_{1} + P_{2} = P$。\n\n总容量（每次信道使用）与下式成正比：\n$$\nC(P_{1},P_{2}) \\propto \\ln\\!\\left(1 + \\frac{P_{1}}{\\sigma_{1}^{2}}\\right) + \\ln\\!\\left(1 + \\frac{P_{2}}{\\sigma_{2}^{2}}\\right),\n$$\n此处使用 $\\ln$（自然对数）不失一般性，因为在相同约束条件下，任何正的乘法变换或单调变换都不会改变最大化问题的解。\n\n构造拉格朗日函数以在约束条件 $P_{1} + P_{2} = P$ 和 $P_{i} \\ge 0$ 下最大化 $C$：\n$$\n\\mathcal{L} = \\sum_{i=1}^{2} \\ln\\!\\left(1 + \\frac{P_{i}}{\\sigma_{i}^{2}}\\right) - \\lambda\\left(P_{1} + P_{2} - P\\right) - \\sum_{i=1}^{2} \\nu_{i} P_{i},\n$$\n其中 $\\lambda$ 是等式约束的乘子，$\\nu_{i} \\ge 0$ 是非负约束的乘子。\n\n对于任何 $P_{i}  0$（因此 $\\nu_{i} = 0$）的 $i$，KKT 平稳性条件给出：\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial P_{i}} = \\frac{1}{\\sigma_{i}^{2} + P_{i}} - \\lambda = 0\n\\;\\;\\Rightarrow\\;\\;\nP_{i} = \\frac{1}{\\lambda} - \\sigma_{i}^{2}.\n$$\n施加 $P_{i} \\ge 0$ 的约束，得到注水解：\n$$\nP_{i} = \\max\\!\\left(0,\\, \\mu - \\sigma_{i}^{2}\\right), \\quad \\text{其中 } \\mu \\equiv \\frac{1}{\\lambda},\n$$\n其中选择 $\\mu$ 以满足总功率约束：\n$$\n\\sum_{i=1}^{2} \\max\\!\\left(0,\\, \\mu - \\sigma_{i}^{2}\\right) = P.\n$$\n\n代入给定值 $\\sigma_{1}^{2} = 1$，$\\sigma_{2}^{2} = 3$ 和 $P = 4$。检查两个信道是否都处于活动状态。如果 $\\mu \\le 3$，则 $P_{2} = 0$ 且 $P_{1} = \\mu - 1$。强制 $P_{1} = 4$ 将要求 $\\mu = 5$，这与 $\\mu \\le 3$ 矛盾。因此 $\\mu  3$，所以两个信道都处于活动状态，并且\n$$\n(\\mu - 1) + (\\mu - 3) = 4\n\\;\\;\\Rightarrow\\;\\;\n2\\mu - 4 = 4\n\\;\\;\\Rightarrow\\;\\;\n\\mu = 4.\n$$\n因此\n$$\nP_{1} = \\mu - \\sigma_{1}^{2} = 4 - 1 = 3,\n\\qquad\nP_{2} = \\mu - \\sigma_{2}^{2} = 4 - 3 = 1,\n$$\n这些值满足 $P_{1} + P_{2} = 4$ 和 $P_{i} \\ge 0$，因此是该最优分配问题的解。", "answer": "$$\\boxed{\\begin{pmatrix}3  1\\end{pmatrix}}$$", "id": "1668042"}, {"introduction": "在掌握了基本分配方法之后，这个问题将我们的重点转移到注水策略的临界阈值上。你将不再是分配一个给定的功率，而是要去确定激活所有可用信道所需的最小总功率 [@problem_id:1668073]。这个练习能加深你对总功率、活跃信道数量以及整体系统效率之间关系的理解。", "problem": "一个数字通信系统被设计用于通过三个并行、独立的频率信道传输数据。这些信道的质量各不相同，这通过不同的噪声功率水平来建模。设三个信道的噪声功率分别为 $N_1 = 0.5$、$N_2 = 1.0$ 和 $N_3 = 2.0$，以归一化单位表示。为了在给定的总传输功率 $P$ 下最大化系统的总吞吐量，采用了称为注水算法的功率分配策略。该算法以最优方式将总功率 $P$ 分配给各个信道，即 $P_1, P_2, P_3$（其中 $P_1+P_2+P_3=P$）。一个信道仅在被分配了严格为正的功率（即 $P_i  0$）时，才被认为是“激活”的。确定确保所有三个信道都被激活所需的确切最小总功率 $P$。", "solution": "问题要求计算在给定噪声功率 $N_1 = 0.5$、$N_2 = 1.0$ 和 $N_3 = 2.0$ 的情况下，激活三个并行信道所需的最小总功率 $P$。功率分配由注水算法确定，该算法旨在最大化总信道容量。\n\n注水算法通过分配功率来最大化各独立信道容量之和，即 $C = \\sum_i C_i$。对于加性高斯白噪声（AWGN）信道，其容量由香农-哈特利定理给出：$C_i = B \\log_2(1+P_i/N_i)$，其中 $B$ 是带宽，$P_i$ 是分配的功率，$N_i$ 是噪声功率。为简化起见，我们可以假设归一化带宽 $B=1$，因为这不影响功率分配。\n\n注水算法的核心原理，是通过在总功率约束 $\\sum P_i = P$ 下优化总容量推导出来的。其结论是，分配给信道 $i$ 的功率 $P_i$ 由下式给出：\n$$P_i = (\\mu - N_i)^+ = \\max(0, \\mu - N_i)$$\n此处，$\\mu$ 是一个常数，通常被称为“水位”。这个水位由可用的总功率 $P$ 决定。选择 $\\mu$ 的值，使得分配的功率总和等于总功率预算：\n$$P = \\sum_i P_i = \\sum_i \\max(0, \\mu - N_i)$$\n\n题目指出，一个信道 $i$ 只有在分配了严格为正的功率时才被视为“激活”的，即 $P_i  0$。\n根据功率分配规则，条件 $P_i  0$ 可转化为：\n$$\\max(0, \\mu - N_i)  0$$\n当且仅当 $\\mu - N_i  0$，即 $\\mu  N_i$ 时，此式成立。\n\n要使所有三个信道都被激活，水位 $\\mu$ 必须严格大于每个信道的噪声功率：\n1. 信道1激活：$P_1  0 \\implies \\mu  N_1 = 0.5$\n2. 信道2激活：$P_2  0 \\implies \\mu  N_2 = 1.0$\n3. 信道3激活：$P_3  0 \\implies \\mu  N_3 = 2.0$\n\n为了同时满足这三个条件，水位 $\\mu$ 必须严格大于所有噪声功率的最大值：\n$$\\mu  \\max(N_1, N_2, N_3) = \\max(0.5, 1.0, 2.0) = 2.0$$\n\n当条件 $\\mu  2.0$ 满足时，所有三个信道都会被分配正功率。分配的功率分别为：\n$P_1 = \\mu - N_1 = \\mu - 0.5$\n$P_2 = \\mu - N_2 = \\mu - 1.0$\n$P_3 = \\mu - N_3 = \\mu - 2.0$\n\n总功率 $P$ 是这些单个功率的总和：\n$$P = P_1 + P_2 + P_3 = (\\mu - 0.5) + (\\mu - 1.0) + (\\mu - 2.0)$$\n$$P = 3\\mu - (0.5 + 1.0 + 2.0)$$\n$$P = 3\\mu - 3.5$$\n\n我们正在寻找确保所有信道都被激活所需的最小总功率 $P$。这对应于满足 $\\mu  2.0$ 的最小可能 $\\mu$ 值所需的功率。这是一个极限情况，即水位 $\\mu$ 从上方趋近于 $2.0$。我们可以通过在边界值 $\\mu = 2.0$ 处计算 $P$ 的表达式来求得最小功率。\n$$P_{\\text{min}} = \\lim_{\\mu \\to 2.0^+} (3\\mu - 3.5) = 3(2.0) - 3.5$$\n$$P_{\\text{min}} = 6.0 - 3.5 = 2.5$$\n\n因此，激活所有三个信道所需的最小总功率为 2.5 归一化单位。如果 $P \\leq 2.5$，则得到的水位 $\\mu = (P+3.5)/3$ 将小于或等于 2.0，导致分配给信道 3 的功率为 $P_3 = \\max(0, \\mu - 2.0) = 0$，这意味着信道 3 将不被激活。", "answer": "$$\\boxed{2.5}$$", "id": "1668073"}, {"introduction": "现在，让我们从具体的噪声数值转向符号化的表示，以此来概括我们的理解。这个问题将信道噪声建模为一个等差数列，挑战你推导出一个通用公式，用以计算激活特定数量信道所需的总功率 [@problem_id:1668046]。解决这个问题将展示你对注水算法及其底层结构的强大而抽象的掌握能力。", "problem": "在一个多载波数字通信系统（例如使用正交频分复用 (OFDM) 的系统）中，总可用带宽被划分为 $M$ 个独立的、并行的、平坦衰落的子信道。目标是在这些子信道之间分配总发射功率 $P$，以最大化总数据速率（即总容量）。\n\n第 $i$ 个子信道的容量由 $C_i = B \\log_2(1 + P_i/N_i)$ 给出，其中 $B$ 是子信道的带宽，$P_i$ 是分配给它的功率，$N_i$ 是该子信道中的噪声功率。为简便起见，我们假设 $B=1$ 并使用自然对数，这只会将容量乘以一个常数因子。总容量为 $C = \\sum_{i} \\ln(1 + P_i/N_i)$，并受总功率约束 $\\sum_{i} P_i \\le P$ 的限制。\n\n最优功率分配策略由注水算法描述。该策略为每个信道 $i$ 分配功率 $P_i = \\max(0, \\mu - N_i)$，其中常数 $\\mu$（通常称为“水位”）的选择是为了满足总功率约束。对于满足 $\\mu \\le N_i$ 的信道，不使用（$P_i = 0$）。\n\n考虑一个拥有大量子信道（$M \\to \\infty$）的系统，其噪声功率按非递减顺序排序：$N_1 \\le N_2 \\le N_3 \\le \\dots$。发现第 $i$ 个信道的噪声功率遵循等差数列：\n$$N_i = \\alpha + (i-1)\\beta$$\n其中 $\\alpha  0$ 是一个基础噪声功率水平，$\\beta  0$ 是每个信道索引的增量噪声功率。\n\n使用的最优信道数，记为 $K^*$，是使得分配给第 $k$ 个信道的功率 $P_k$ 为正的最大整数 $k$。我们感兴趣的是一个特定的边界条件，即最优活跃信道数恰好为 $K$。这种情况发生在水位 $\\mu$ 精确等于下一个可用信道的噪声水平时，即 $\\mu = N_{K+1}$。在这种情况下，信道 $K$ 接收正功率，但信道 $K+1$ 及所有后续信道接收的功率恰好为零。\n\n确定发生此特定边界条件所需的确切总功率 $P$。用 $K$、$\\alpha$ 和 $\\beta$ 表示你的答案。", "solution": "我们使用注水算法分配功率 $P_{i}=\\max(0,\\mu-N_{i})$，其中选择水位 $\\mu$ 以满足总功率约束。在恰好有 $K$ 个信道活跃的边界上，给定条件为 $\\mu=N_{K+1}$ 且 $P_{K}0$，$P_{K+1}=0$。根据等差数列 $N_{i}=\\alpha+(i-1)\\beta$，我们有\n$$\n\\mu=N_{K+1}=\\alpha+K\\beta。\n$$\n对于 $i\\in\\{1,\\dots,K\\}$，分配的功率为\n$$\nP_{i}=\\mu-N_{i}=(\\alpha+K\\beta)-\\bigl(\\alpha+(i-1)\\beta\\bigr)=(K-i+1)\\beta,\n$$\n由于 $\\beta0$ 且 $i\\leq K$，该值严格为正。根据构造，对于 $i\\geq K+1$，$P_{i}=0$。\n\n在此边界上所需的总功率是所有活跃信道的功率之和：\n$$\nP=\\sum_{i=1}^{K}P_{i}=\\sum_{i=1}^{K}(K-i+1)\\beta=\\beta\\sum_{j=1}^{K}j=\\beta\\,\\frac{K(K+1)}{2}。\n$$\n等价地，使用 $P=\\sum_{i=1}^{K}(\\mu-N_{i})=K\\mu-\\sum_{i=1}^{K}N_{i}$，\n$$\n\\sum_{i=1}^{K}N_{i}=\\sum_{i=1}^{K}\\bigl(\\alpha+(i-1)\\beta\\bigr)=K\\alpha+\\beta\\frac{K(K-1)}{2},\n$$\n并代入 $\\mu=\\alpha+K\\beta$，\n$$\nP=K(\\alpha+K\\beta)-\\left(K\\alpha+\\beta\\frac{K(K-1)}{2}\\right)=\\beta\\,\\frac{K(K+1)}{2}。\n$$\n因此，所需的总功率仅取决于 $K$ 和 $\\beta$；$\\alpha$ 项被消掉了。", "answer": "$$\\boxed{\\frac{\\beta K(K+1)}{2}}$$", "id": "1668046"}]}