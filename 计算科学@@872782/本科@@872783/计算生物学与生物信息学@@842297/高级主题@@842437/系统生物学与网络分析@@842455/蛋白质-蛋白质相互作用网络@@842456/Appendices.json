{"hands_on_practices": [{"introduction": "一个蛋白质的相互作用伙伴数量（即它的“度”）是一个基础指标，但它并不能完全描绘其在网络中的角色。通过计算局部聚类系数，我们可以洞察一个蛋白质所处的“邻里环境”的紧密程度。这个练习将指导你计算该指标，并解释其生物学意义，揭示为何度相同的蛋白质可能扮演着截然不同的结构角色 [@problem_id:1460581]。", "problem": "在系统生物学领域，蛋白质-蛋白质相互作用（PPI）网络被用来模拟细胞内蛋白质之间复杂的相互作用关系。这些网络可以表示为图，其中蛋白质是节点，它们之间的物理相互作用是边。一个用于分析此类网络局部结构的关键指标是局部聚类系数。\n\n对于一个有 $k_i$ 个相互作用伙伴（度 $k_i > 1$）的蛋白质（节点）$i$，其局部聚类系数 $C_i$ 定义为：\n$$C_i = \\frac{2 E_i}{k_i (k_i - 1)}$$\n其中 $E_i$ 是蛋白质 $i$ 的 $k_i$ 个伙伴之间直接相互作用（边）的数量。这个无量纲的指标衡量了一个蛋白质的邻居们接近于一个完全连接的团（clique）的程度。较高的值表示一个更紧密结合的局部邻域。\n\n考虑一个由八种蛋白质组成的假设PPI网络：A、B、C、D、E、F、G和H。观察到的全部相互作用列表如下：\nA-B、A-C、A-D、\nB-C、B-D、B-F、\nC-D、\nD-E、D-F、\nE-F、E-G、E-H。\n\n蛋白质B和E具有相同数量的相互作用伙伴。基于对它们局部聚类系数的比较，以下哪项陈述为它们在网络中的不同角色提供了最准确的生物学解释？\n\nA. 与蛋白质E相比，蛋白质B是更紧密互连的功能模块的一部分。\n\nB. 与蛋白质B相比，蛋白质E是更紧密互连的功能模块的一部分。\n\nC. 由于它们具有相同数量的相互作用伙伴，蛋白质B和E都同等地整合到局部功能模块中。\n\nD. 网络结构表明蛋白质B是一种酶，而蛋白质E是一种结构蛋白。", "solution": "根据定义，对于一个度为 $k_{i}>1$ 的节点 $i$，其局部聚类系数为\n$$\nC_{i}=\\frac{2E_{i}}{k_{i}\\left(k_{i}-1\\right)},\n$$\n其中 $E_{i}$ 是节点 $i$ 的邻居之间的边的数量。\n\n首先，利用给定的无向相互作用，列出蛋白质B和E的邻居和度。\n对于蛋白质B，其邻居为 $N(B)=\\{A,C,D,F\\}$，所以 $k_{B}=4$。根据提供的列表，这些邻居之间的边有：$A\\text{-}C$、$A\\text{-}D$、$C\\text{-}D$ 和 $D\\text{-}F$。因此，邻居之间的边数为 $E_{B}=4$。所以，\n$$\nC_{B}=\\frac{2E_{B}}{k_{B}(k_{B}-1)}=\\frac{2\\cdot 4}{4\\cdot 3}=\\frac{8}{12}=\\frac{2}{3}.\n$$\n\n对于蛋白质E，其邻居为 $N(E)=\\{D,F,G,H\\}$，所以 $k_{E}=4$。根据给定的列表，这些邻居之间的边只有：$D\\text{-}F$；不存在边 $D\\text{-}G$、$D\\text{-}H$、$F\\text{-}G$、$F\\text{-}H$ 或 $G\\text{-}H$。因此 $E_{E}=1$。所以，\n$$\nC_{E}=\\frac{2E_{E}}{k_{E}(k_{E}-1)}=\\frac{2\\cdot 1}{4\\cdot 3}=\\frac{2}{12}=\\frac{1}{6}.\n$$\n\n由于 $C_{B}=\\frac{2}{3}$ 大于 $C_{E}=\\frac{1}{6}$，蛋白质B的邻域比蛋白质E的邻域连接更紧密。度相同并不意味着聚类系数相等，因此最吻合的解释是，与蛋白质E相比，蛋白质B是更紧密互连的功能模块的一部分。特定的生化作用（例如，酶与结构蛋白）无法仅从网络拓扑结构中推断出来。", "answer": "$$\\boxed{A}$$", "id": "1460581"}, {"introduction": "蛋白质相互作用网络中的功能模块通常表现为连接紧密的蛋白质群落。Girvan-Newman算法是一种识别这些群落的经典方法，其核心思想是识别并移除连接不同群落的“桥梁”边。通过这个练习，你将亲手实践计算“边介数中心性”——一种衡量边是否是桥梁的关键指标，从而理解社区发现的基本原理 [@problem_id:1460612]。", "problem": "在系统生物学中，人们常常分析蛋白质-蛋白质相互作用（PPI）网络以寻找功能模块或蛋白质复合物，这些模块或复合物在网络中表现为节点密集连接的社区。Girvan-Newman算法是一种常用的社区发现方法，其工作原理是逐步移除具有最高“边介数中心性”的边。\n\n考虑一个简化的PPI网络，该网络由七种蛋白质组成，分别表示为A、B、C、D、E、F和G。这些蛋白质之间的相互作用（边）如下：A与B、C和D相互作用。B与A和C相互作用。C与A、B和D相互作用。D与A、C和E相互作用。E与D、F和G相互作用。F与E和G相互作用。G与E和F相互作用。所有相互作用都是双向的。\n\n一条边的边介数中心性定义为通过该边的所有节点对之间最短路径的比例之和。具体来说，对于一条边 $e$，其介数 $C_B(e)$ 由公式 $C_B(e) = \\sum_{u \\neq v} \\frac{\\sigma_{uv}(e)}{\\sigma_{uv}}$ 给出，其中 $\\sigma_{uv}$ 是节点 $u$ 和 $v$ 之间最短路径的总数，而 $\\sigma_{uv}(e)$ 是这些最短路径中通过边 $e$ 的数量。求和遍及网络中所有不同的节点对 $(u,v)$。\n\n根据Girvan-Newman算法的第一步，该网络中的哪个相互作用具有最高的边介数中心性，因此应该首先被考虑移除？\n\nA. 蛋白质A和C之间的相互作用。\n\nB. 蛋白质C和D之间的相互作用。\n\nC. 蛋白质D和E之间的相互作用。\n\nD. 蛋白质E和F之间的相互作用。\n\nE. 蛋白质F和G之间的相互作用。", "solution": "问题要求我们在给定的蛋白质-蛋白质相互作用网络中找到具有最高介数中心性的边。这包括三个主要步骤：\n1.  识别网络中每对节点之间的所有最短路径。\n2.  对每条边，通过对穿过它的最短路径的比例求和来计算其介数中心性。\n3.  比较介数中心性值以找到最大值。\n\n该网络有7个节点：{A, B, C, D, E, F, G}。\n边是：(A, B), (A, C), (A, D), (B, C), (C, D), (D, E), (E, F), (E, G), (F, G)。\n\n我们来分析网络结构。我们可以观察到两个密集连接的子图。\n-   簇1 (C1): {A, B, C, D}。节点A、B、C形成一个三角形。节点D连接到A和C。边是(A,B), (B,C), (A,C), (A,D), (C,D)。等等，问题描述中说“A与B、C和D相互作用。B与A和C相互作用。C与A、B和D相互作用。”这意味着这个簇中的边是(A,B), (A,C), (A,D), (B,C), (C,D)。这形成了一个{A,B,C}的团，其中D附加到A和C上。让我们根据描述重新核实完整的边列表。\n    - A与{B, C, D}相互作用 -> (A,B), (A,C), (A,D)\n    - B与{A, C}相互作用 -> (B,A), (B,C)\n    - C与{A, B, D}相互作用 -> (C,A), (C,B), (C,D)\n    - D与{A, C, E}相互作用 -> (D,A), (D,C), (D,E)\n    - E与{D, F, G}相互作用 -> (E,D), (E,F), (E,G)\n    - F与{E, G}相互作用 -> (F,E), (F,G)\n    - G与{E, F}相互作用 -> (G,E), (G,F)\n    唯一的边：(A,B), (A,C), (A,D), (B,C), (C,D), (D,E), (E,F), (E,G), (F,G)。我之前根据文本的假设是正确的。该网络由两个簇C1={A,B,C,D}和C2={E,F,G}组成，通过一条单一的桥边(D,E)连接。\n-   簇1 (C1): {A, B, C, D}。节点{A, C, D}形成一个三角形，B连接到A和C。\n-   簇2 (C2): {E, F, G}。这三个节点形成一个三角形。\n-   桥：边(D, E)是C1和C2之间的唯一连接。\n\n任何在C1中的节点和C2中的节点之间的最短路径都必须通过边(D, E)。这样的节点对有 $4 \\times 3 = 12$ 对。对于这12对中的每一对，边(D,E)都位于每条最短路径上。我们来验证几对。\n-   路径(B, F)：从B到D的最短路径是B-A-D或B-C-D（长度为2）。从E到F的最短路径是E-F（长度为1）。因此，从B到F的最短路径是B-A-D-E-F和B-C-D-E-F（长度为4）。两条路径都使用了边(D,E)。\n-   路径(A, G)：最短路径是A-D-E-G（长度为3）。这条路径使用了(D,E)。\n\n我们来系统地计算对边(D,E)介数的贡献。对于任何节点对 $(u,v)$，其中 $u \\in \\{A,B,C,D\\}$ 且 $v \\in \\{E,F,G\\}$，从 $u$ 到 $v$ 的所有最短路径都必须穿过边(D,E)。因此，对于这 $4 \\times 3 = 12$ 对中的每一对，边(D,E)都得到一个值为 $\\frac{\\sigma_{uv}(D,E)}{\\sigma_{uv}} = 1$ 的贡献。边(D,E)的总介数是这些贡献的总和。C1内部或C2内部的任何最短路径都不会使用跨簇的边(D,E)。\n因此，边(D,E)的介数中心性为 $C_B(D,E) = 12$。\n\n现在，我们计算其他一些边的介数，以确认12是最大值。\n\n**边 (C, D):** 这条边位于C1内部的路径以及从C1到C2的路径上。\n-   C1内部的路径：\n    -   (C,D)：路径是C-D。边(C,D)的贡献为1。\n    -   (B,D)：最短路径是B-C-D和B-A-D（长度均为2）。(C,D)位于这两条路径中的一条上，因此其贡献为 $1/2$。\n-   从C1到C2的路径：\n    -   从C开始的路径：(C,E), (C,F), (C,G)。所有路径都必须经过D才能到达E。最短路径是C-D-E, C-D-E-F, C-D-E-G。边(C,D)位于所有3条路径上，每条路径贡献1。总贡献：3。\n    -   从B开始的路径：(B,E), (B,F), (B,G)。从B到D的最短路径是B-C-D和B-A-D。到E、F、G的路径将沿用这些路径。例如，(B,E)的路径是B-C-D-E和B-A-D-E。因此，对于(B,E), (B,F), (B,G)这3对中的每一对，边(C,D)的贡献都是 $1/2$。总贡献：$3 \\times (1/2) = 1.5$。\n    -   从A开始的路径：从A到D的最短路径是A-D（长度为1）。路径A-C-D（长度为2）不是最短路径。因此对于节点对(A,E), (A,F), (A,G)，最短路径不使用(C,D)。\n总结(C,D)的主要贡献：$1 (\\text{来自 C,D}) + 0.5 (\\text{来自 B,D}) + 3 (\\text{从 C 到 C2}) + 1.5 (\\text{从 B 到 C2}) = 6.0$。\n这个值已经小于12。根据对称性，(A,D)的介数将是相似的。路径(B,D)使用(A,D)的贡献为1/2。从A到C2的路径使用(A,D)，贡献为3。从B出发的路径对3个节点对使用(A,D)，贡献为1/2，总贡献为1.5。路径(A,D)本身贡献为1。(A,D)的总介数为 $1+0.5+3+1.5=6.0$。\n因此 $C_B(C,D) = 6.0$。\n\n**边 (E, F):** 这条边在C2中。它将位于C2内部的路径以及从C1到C2中节点的路径上。\n-   路径(E,F)：贡献为1。\n-   路径(G,F)：最短路径是G-F（长度为1）。存在一条更长的路径G-E-F（长度为2）。所以(E,F)不在(G,F)的最短路径上。等等，C2簇(E,F,G)是一个三角形。所以(G,F)的路径长度是1，(G,E)-(E,F)的长度是2。好的。\n-   从C1到F的路径：C1中的所有节点都必须经过D然后E才能到达F。C1中有4个节点(A,B,C,D)。\n    -   (D,F)：路径 D-E-F。(E,F)的贡献为1。\n    -   (C,F)：路径 C-D-E-F。(E,F)的贡献为1。\n    -   (A,F)：路径 A-D-E-F。(E,F)的贡献为1。\n    -   (B,F)：路径 B-C-D-E-F 和 B-A-D-E-F。两者都通过(E,F)，所以贡献为 $1/2+1/2=1$。\n从C1到F的总贡献是 $1+1+1+1 = 4$。\n因此，$C_B(E,F) = 1 (\\text{来自 E,F}) + 4 (\\text{从 C1 到 F}) = 5.0$。\n根据对称性，$C_B(E,G) = 5.0$。\n\n**边 (F, G):**\n-   路径(F,G)：本身贡献为1。\n-   还有其他使用(F,G)的最短路径吗？没有。对于任何节点 $u \\notin \\{F,G\\}$，从 $u$ 到 F 的路径比路径 $u-G-F$ 更短或等长。例如，$d(E,F)=1$ 而 $d(E,G)+d(G,F)=1+1=2$。所以从E到F没有最短路径会经过G。\n因此，$C_B(F,G) = 1.0$。\n\n**边 (A, C):**\n-   路径(A,C)：贡献为1。\n-   路径(B,D)：最短路径是B-A-D和B-C-D。两者都不使用(A,C)。\n-   路径(B, 到C2)：B-A-D-E-... 和 B-C-D-E-... 两者都不使用(A,C)。\n因此，$C_B(A,C) = 1.0$。\n\n我们来总结一下计算出的介数值：\n-   $C_B(D, E) = 12.0$\n-   $C_B(A, D) = 6.0$\n-   $C_B(C, D) = 6.0$\n-   $C_B(E, F) = 5.0$\n-   $C_B(E, G) = 5.0$\n-   $C_B(A, B)$ (通过与(B,C)类似的逻辑) $\\approx 3.0$\n-   $C_B(B, C)$ (通过与(A,B)类似的逻辑) $\\approx 3.0$\n-   $C_B(A, C) = 1.0$\n-   $C_B(F, G) = 1.0$\n\n最高的边介数中心性是12.0，对应于边(D, E)。这条边在网络中充当了两个社区之间的主要桥梁。因此，这是Girvan-Newman算法将要移除的第一条边。\n\n将此结果与给定选项进行比较：\nA. 蛋白质A和C之间的相互作用：$C_B(A,C) = 1.0$。\nB. 蛋白质C和D之间的相互作用：$C_B(C,D) = 6.0$。\nC. 蛋白质D和E之间的相互作用：$C_B(D,E) = 12.0$。\nD. 蛋白质E和F之间的相互作用：$C_B(E,F) = 5.0$。\nE. 蛋白质F和G之间的相互作用：$C_B(F,G) = 1.0$。\n\n最高值对应于选项C。", "answer": "$$\\boxed{C}$$", "id": "1460612"}, {"introduction": "PPI网络并非静态的蓝图，它们必须在部分组件失效时仍能可靠地运作。此练习探讨了网络鲁棒性这一概念，这是许多生物网络所共有的“无标度”网络结构的一个关键特征。通过模拟随机故障和针对性攻击这两种情况，我们可以理解为何这些网络对随机错误具有惊人的弹性，但对其中心“枢纽”蛋白的攻击却异常脆弱 [@problem_id:1460589]。", "problem": "在系统生物学中，蛋白质-蛋白质相互作用（PPI）网络通常被建模为无标度网络，其特征是存在少数高度连接的蛋白质（枢纽蛋白）和大量连接稀疏的蛋白质。这类网络对其组成蛋白质被移除的鲁棒性是一个关键问题。\n\n考虑一个简化的PPI网络模型，该网络共包含 $N=1000$ 个蛋白质。这些蛋白质分为两类：\n1.  **枢纽蛋白**：有 $N_h = 100$ 个枢纽蛋白，它们具有非常多的连接（高度）。\n2.  **外周蛋白**：有 $N_p = 900$ 个外周蛋白，它们具有很少的连接（低度）。\n\n网络的连通性定义如下：\n*   这100个枢纽蛋白彼此之间紧密连接，为网络形成一个单一、稳定的核心。\n*   900个外周蛋白中的每一个都恰好连接到一个枢纽蛋白。这些连接是均匀分布的，意味着100个枢纽蛋白中的每一个都作为恰好 $N_p/N_h = 9$ 个外周蛋白的“锚点”。\n*   外周蛋白之间没有任何连接。\n\n最初，整个网络是完全连通的，形成一个大小为1000的单一最大连通分量（LCC）。如果一个蛋白质不再是这个主要LCC的一部分，则认为它已断开连接。对网络的总损害由断开连接的蛋白质总数来衡量，即初始LCC大小减去蛋白质移除后的最终LCC大小。\n\n你需要比较从网络中移除10%的蛋白质（即移除100个蛋白质）的两种不同策略。\n\n**情景 A（靶向攻击）**：故意移除度最高的100个蛋白质。在此模型中，这些就是100个枢纽蛋白。\n**情景 B（随机失效）**：从整个网络中完全随机地选择100个蛋白质并移除。\n\n设 $D_A$ 为情景 A 中从LCC断开连接的蛋白质总数，$D_B$ 为情景 B 中从LCC断开连接的蛋白质总数。计算靶向攻击造成的损害与随机失效造成的损害之比，$D_A / D_B$。\n\n以保留三位有效数字的数值形式给出你的答案。", "solution": "我们将网络建模为由100个完全互连的枢纽蛋白组成的核心，每个枢纽蛋白锚定9个外周蛋白，且外周蛋白之间没有边。初始最大连通分量（LCC）的大小为1000。\n\n情景 A（靶向攻击）：移除100个枢纽蛋白会删除所有连接。剩下的900个外周蛋白被孤立，因此最终的LCC大小为1。因此，\n$$\nD_{A} = 1000 - 1 = 999.\n$$\n\n情景 B（随机失效）：无放回地从网络中均匀随机地移除100个节点。设 $S$ 为幸存的枢纽蛋白数量，设 $K$ 为自身幸存且其所连接的枢纽蛋白也幸存的外周蛋白数量。如果 $S>0$，LCC由所有幸存的枢纽蛋白加上所有连接到幸存枢纽蛋白的幸存外周蛋白组成，即大小为 $S+K$。如果 $S=0$，则只剩下孤立的外周蛋白，所以LCC的大小为 $1$。因此，\n$$\n\\mathbb{E}[\\text{LCC}] = \\mathbb{E}[S] + \\mathbb{E}[K] + \\mathbb{P}(S=0).\n$$\n我们计算每一项：\n- 每个枢纽蛋白幸存的概率为 $900/1000$，所以\n$$\n\\mathbb{E}[S] = 100 \\cdot \\frac{900}{1000} = 90.\n$$\n- 对于任意一个给定的外周蛋白及其特定的枢纽蛋白，两者都幸存的概率是\n$$\n\\frac{\\binom{998}{100}}{\\binom{1000}{100}} = \\frac{900}{1000} \\cdot \\frac{899}{999}.\n$$\n有900个外周蛋白，所以\n$$\n\\mathbb{E}[K] = 900 \\cdot \\frac{900}{1000} \\cdot \\frac{899}{999} = 810 \\cdot \\frac{899}{999} = \\frac{26970}{37}.\n$$\n- 所有100个枢纽蛋白都被移除的概率是\n$$\n\\mathbb{P}(S=0) = \\frac{\\binom{100}{100}\\binom{900}{0}}{\\binom{1000}{100}} = \\frac{1}{\\binom{1000}{100}}.\n$$\n因此，\n$$\n\\mathbb{E}[\\text{LCC}] = 90 + 810 \\cdot \\frac{899}{999} + \\frac{1}{\\binom{1000}{100}} = 90 + \\frac{26970}{37} + \\frac{1}{\\binom{1000}{100}}.\n$$\n于是，\n$$\nD_{B} = 1000 - \\mathbb{E}[\\text{LCC}] = 1000 - 90 - 810 \\cdot \\frac{899}{999} - \\frac{1}{\\binom{1000}{100}} = 910 - \\frac{26970}{37} - \\frac{1}{\\binom{1000}{100}} = \\frac{6700}{37} - \\frac{1}{\\binom{1000}{100}}.\n$$\n该比值为\n$$\n\\frac{D_{A}}{D_{B}} = \\frac{999}{\\frac{6700}{37} - \\frac{1}{\\binom{1000}{100}}}.\n$$\n由于 $\\binom{1000}{100}$ 是一个天文数字般的大数，在所要求的精度下，修正项可以忽略不计，所以\n$$\n\\frac{D_{A}}{D_{B}} \\approx \\frac{999 \\cdot 37}{6700} = \\frac{36963}{6700} \\approx 5.5168657.\n$$\n保留三位有效数字，结果为 $5.52$。", "answer": "$$\\boxed{5.52}$$", "id": "1460589"}]}