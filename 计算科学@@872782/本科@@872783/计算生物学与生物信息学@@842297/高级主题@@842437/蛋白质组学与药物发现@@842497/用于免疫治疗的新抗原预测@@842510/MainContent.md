## 引言
近年来，个性化免疫治疗的兴起正在彻底改变癌症治疗的格局。其核心思想是利用患者[自身免疫](@entry_id:148521)系统的力量，来精准地识别并摧毁癌细胞，同时最大限度地减少对正常组织的伤害。实现这一目标的关键，在于找到能够将癌细胞与正常细胞明确区分开的“[分子指纹](@entry_id:172531)”——新抗原（Neoantigen）。新抗原是源于肿瘤细胞特有[基因突变](@entry_id:262628)的蛋白质片段，它们被免疫系统视为“非我”异物，从而成为理想的治疗靶点。然而，一个肿瘤可能携带成千上万个突变，但只有极少数能够最终生成被[T细胞](@entry_id:181561)有效识别的新抗原。如何从海量的潜在候选者中精确、高效地筛选出这几个“金牌”靶点，便构成了该领域的核心挑战与知识缺口。

本文旨在系统性地解决这一问题，为读者提供一个关于[新抗原](@entry_id:155699)计算预测的全面指南。我们将首先在“原理与机制”一章中，深入剖析新抗原从产生到呈递的生物学全过程，并介绍用于量化每个步骤的[计算模型](@entry_id:152639)。接着，在“应用与跨学科连接”一章中，我们将展示这些原理如何转化为强大的临床应用，例如设计[个性化癌症疫苗](@entry_id:186825)、预测[免疫疗法](@entry_id:150458)反应，并探讨其与[病毒学](@entry_id:175915)、微生物学等领域的深刻联系。最后，通过“动手实践”部分的一系列编程练习，读者将有机会亲手实现关键的预测算法，将理论知识转化为实践技能。通过这三章的学习，您将掌握[新抗原预测](@entry_id:173241)背后的核心逻辑，并理解其在现代精准医学中的关键作用。

## 原理与机制

在“引言”章节中，我们概述了新抗原在个性化免疫治疗中的核心作用。本章将深入探讨[新抗原预测](@entry_id:173241)背后的生物学原理和计算机制。我们将系统性地剖析从一个[基因突变](@entry_id:262628)到能够被[T细胞识别](@entry_id:173985)的细胞表面信号的完整级联过程。理解这些机制不仅是构建精确预测模型的基石，也是解读模型输出、设计更有效治疗策略的关键。

### [新抗原](@entry_id:155699)呈递的核心法则

[新抗原](@entry_id:155699)的产生和呈递遵循着一条从基因组到细胞表面的清晰路径，这可以被视为免疫学领域的“核心法则”。这一过程始于肿瘤细胞DNA中的一个[体细胞突变](@entry_id:276057)，该突变通过转录和翻译过程，最终产生一种突变蛋白。这种蛋白与体内的任何正常蛋白（即“自身”蛋白）都不同。随后，细胞内的蛋白酶体将这种突变蛋白降解成短肽段。在这些肽段中，一小部分能够通过[抗原加工相关转运体](@entry_id:150652)（Transporter Associated with Antigen Processing, **TAP**）进入内质网。在内质网中，这些肽段竞争性地与个体特异性的[主要组织相容性复合物](@entry_id:152090)I类分子（Major Histocompatibility Complex class I, **MHC-I**，在人类中也称为人类白细胞抗原 (Human Leukocyte Antigen, **HLA**)）结合。只有那些能够稳定结合的肽-MHC复合物才会被运输到细胞表面，呈递给循环中的[T细胞](@entry_id:181561)。如果一个[CD8+ T细胞](@entry_id:188448)的[T细胞受体](@entry_id:185613)（TCR）能够特异性地识别这个“非自身”的肽-MHC复合物，它就会被激活，进而攻击并摧毁该肿瘤细胞。

这个过程本质上是一个多步骤的筛选漏斗，每一步都具有其特有的选择性和效率。因此，一个新抗原的最终呈递概率可以被建模为一系列独立或半[独立事件](@entry_id:275822)概率的乘积。一个简化的、但极具指导意义的模型可以表示为：

$P(\text{呈递}) \propto P(\text{生成}) \times P(\text{切割}) \times P(\text{转运}) \times P(\text{结合}) \times P(\text{稳定性})$

其中，每一项都代表了生物学通路中的一个关键环节。例如，在一些[计算模型](@entry_id:152639)中，总的呈递概率 $P_i$ 可以被形式化为各阶段概率的乘积，并考虑[MHC分子](@entry_id:181864)的总体可用性 [@problem_id:2409289]。这种模块化的思想允许我们对每个步骤进行独立的量化建模，然后将它们整合起来，从而系统地评估任何一个候选肽成为真正新抗原的潜力。

### [新抗原](@entry_id:155699)的来源

虽然经典的体细胞[错义突变](@entry_id:137620)是新抗原最常见的来源，但任何能够在肿瘤细胞中产生“非自身”蛋白质序列的生物学事件都有可能成为[新抗原](@entry_id:155699)的来源。

#### 基因组变异

体细胞[DNA突变](@entry_id:164149)是新抗原的主要驱动力。**[错义突变](@entry_id:137620)**导致单个氨基酸替换，产生与野生型序列仅有一个残基差异的肽段。**[移码突变](@entry_id:138848)**（由插入或缺失导致）则会产生全新的、更长的非自身肽段序列，这些序列通常具有很强的免疫原性。此外，**基因融合**（由[染色体易位](@entry_id:271862)等[结构变异](@entry_id:173359)引起）可以产生嵌合蛋白，其连接点跨越的肽段也是全新的。

在临床应用中，区分**[驱动突变](@entry_id:173105)**（driver mutations）和**[过客突变](@entry_id:273262)**（passenger mutations）产生的新抗原具有重要意义。[驱动突变](@entry_id:173105)是促进肿瘤生长和存活的关键突变，它们存在于肿瘤的每个细胞中（即**克隆性**的），并且在肿瘤的整个生命周期中都倾向于被保留。因此，源自[驱动突变](@entry_id:173105)的[新抗原](@entry_id:155699)是更理想的治疗靶点。相比之下，[过客突变](@entry_id:273262)是随机累积的，对肿瘤生长没有贡献，可能只存在于部分肿瘤细胞中（即**亚克隆性**的）。识别[驱动突变](@entry_id:173105)来源的新抗原需要整合多维度信息，如突变在已知癌症基因热点的位置、跨肿瘤的复发频率、突变位点的进化保守性，以及其克隆性状态等 [@problem_id:2409271]。

#### 转录后和翻译后修饰

除了基因组层面的变异，在转录和翻译后发生的异常事件也能创造出免疫系统眼中的新序列。

一个典型的例子是**[RNA编辑](@entry_id:261025)**，例如[腺苷](@entry_id:186491)到[肌苷](@entry_id:266796)（A-to-I）的编辑。在细胞中，[肌苷](@entry_id:266796)（I）在翻译过程中被[核糖体](@entry_id:147360)识别为鸟苷（G）。因此，如果一个A-to-I编辑事件发生在编码区并导致了[氨基酸序列](@entry_id:163755)的改变（即非同义重编码），它就能产生一种突变蛋白，尽管其对应的DNA序列是正常的。要从计算上识别这类[新抗原](@entry_id:155699)，需要一个严谨的工作流程：首先，在肿瘤[RNA测序](@entry_id:178187)数据中寻找A-to-G的不匹配位点；其次，通过与肿瘤和正常组织的[DNA测序](@entry_id:140308)数据比对，排除基因组DNA变异的可能；然后，过滤掉在正常组织中也普遍存在的生理性编辑位点；最后，对剩下的候选编辑位点进行与标准新抗原类似的呈递预测分析 [@problem_id:2409236]。

另一类重要的来源是异常的**翻译后修饰**（Post-Translational Modifications, **PTMs**）。肿瘤细胞常常表现出与正常细胞不同的P[TM模](@entry_id:266144)式，如异常的糖基化、磷酸化或乙酰化。当这些异常修饰发生在一个能够结合MHC的肽段上时，就可能创造出一个新的[T细胞表位](@entry_id:188572)。例如，一个在正常细胞中从未被[糖基化](@entry_id:163537)的[N-连接糖基化](@entry_id:152566)位点（基序为 $N-X-S/T$，其中 $X \neq P$），如果在肿瘤中被异常激活，产生的糖肽就可能被免疫系统识别。这类[新抗原](@entry_id:155699)的预测模型通常关注一个关键原则：修饰后的肽段与MHC的[结合能](@entry_id:143405)力必须显著优于其未修饰的野生型对应物，这样才能克服中心[免疫耐受](@entry_id:180369) [@problem_id:2409229]。

### 抗原处理与呈递途径的量化视角

为了从数以万计的潜在候选者中筛选出最可能有效的少数几个新抗原，计算生物学家为抗原呈递的每个步骤都开发了定量模型。

#### 抗原生成与丰度

一个突变肽段能否被呈递，首先取决于其源蛋白的表达丰度。源基因的表达水平越高，突变等位基因的比例越大，产生的突变蛋白就越多，从而增加了其被加工和呈递的机会。这可以通过一个简单的概率模型来量化。例如，我们可以假设突变肽段的生成量 $\lambda_i$ 与其源基因的mRNA表达水平 $x_i$（如以[每百万转录本](@entry_id:170576)的转录数，[TPM](@entry_id:170576)，为单位）和突变等位基因频率 $v_i$ 成正比，即 $\lambda_i = \gamma \cdot x_i \cdot v_i$，其中 $\gamma$ 是一个常数。那么，至少生成一个突变肽段的概率就可以用[泊松分布](@entry_id:147769)来描述：$g_i = 1 - \exp(-\lambda_i)$ [@problem_id:2409289]。这个简单的公式强调了高表达和高VAF的重要性。

#### [蛋白酶体](@entry_id:172113)切割

细胞质中的蛋白质被蛋白酶体切割成短肽。这个过程并非随机，蛋白酶体对不同[氨基酸序列](@entry_id:163755)具有不同的切割偏好。例如，它倾向于在大的[疏水性](@entry_id:185618)残基（如L, V, I, Y, F）或碱性残基（如K, R）之后进行切割，而对酸性残基（D, E）或[脯氨酸](@entry_id:166601)（P）附近的切割则受到抑制。这种偏好可以被建模为一个[肽键](@entry_id:144731)被切割的速率。

在一个竞争动力学模型中，一个完整的肽段要么被内部切割而破坏，要么被完整地加载到[MHC分子](@entry_id:181864)上。我们可以将每个内部肽键的切割和MHC的加载都视为独立的指数等待过程。肽段的整体破坏速率 $R$ 是所有内部[肽键](@entry_id:144731)切割速率 $r_i$ 的总和，即 $R = \sum_i r_i$。每个 $r_i$ 又可以被建模为基础速率 $r_0$ 与特定氨基酸上下文的乘数 $m(s_i)$ 的乘积。如果MHC的加载速率为 $\lambda_L$，那么肽段在被加载前因切割而被破坏的概率为 $P_{\text{destruct}} = \frac{R}{R + \lambda_L}$ [@problem_id:2409253]。这个模型揭示了肽段的内在稳定性（即抗切割能力）是其能否成功呈递的一个重要、但常被忽略的因素。

#### TAP转运

成功生成的肽段必须被TAP[转运蛋白](@entry_id:176617)从细胞质泵入内质网。[TAP转运体](@entry_id:150652)同样具有序列偏好，它优先转运长度为8-16个氨基酸、C端为疏水性或碱性残基的肽段。这种偏好可以通过一个转运效率得分 $\tau_i \in [0,1]$ 来量化。在预测流程中，低TAP转运效率的肽段可以被降权或直接过滤掉。

#### MHC结合：核心筛选步骤

MHC结合是整个[新抗原](@entry_id:155699)呈递途径中选择性最强、也是最关键的一步。MHC-I分子的[肽结合槽](@entry_id:198529)具有高度多态性的特征，不同[HLA等位基因](@entry_id:185458)的结合槽形状和化学性质各异，导致它们各自偏好结合具有特定序列模式（称为**[锚定残基](@entry_id:204433)**）的肽段。一个肽段只有与患者自身的某种[HLA等位基因](@entry_id:185458)结合，才有可能被呈递。

**[结合亲和力预测](@entry_id:163728)**：目前，最先进的预测工具（如NetMHCpan）利用[深度学习](@entry_id:142022)，基于海量的肽-MHC[结合亲和力](@entry_id:261722)实验数据进行训练，可以为任意给定的肽段和[HLA等位基因](@entry_id:185458)预测其结合强度。结合强度通常以半数抑制浓度（**IC50**）表示，即抑制50%的参照肽结合所需的肽浓度，单位为纳摩尔（nM）。IC50值越低，表示结合亲和力越强。通常，IC50低于500 nM的肽段被认为是潜在的结合者。这个结合过程可以用标准的[受体-配体结合](@entry_id:272572)公式来建模，结合概率 $p_{\text{bind}, i}$ 可以表示为 $p_{\text{bind}, i} = \frac{1}{1 + \mathrm{IC50}_i / C}$，其中 $C$ 是内质网中肽段的有效浓度 [@problem_id:2409289]。

**差异亲和力**：一个理想的[新抗原](@entry_id:155699)不仅自身要与MHC强力结合，其对应的野生型肽段最好与MHC结合很弱或不结合。这是因为在胸腺中，能够识别与MHC结合的自身肽段的[T细胞](@entry_id:181561)会被清除（中心耐受）。如果一个突变肽段与其野生型版本都能很好地结合MHC，那么识别它们的[T细胞](@entry_id:181561)可能早已被清除。因此，预测时需要同时评估突变肽和野生型肽的结合亲和力，并优先选择那些显示出显著“差异亲和力”的候选者 [@problem_id:2409229] [@problem_id:2409271]。

**竞争性结合**：在真实的细胞环境中，一个[新抗原](@entry_id:155699)肽段必须与成千上万种自身肽段竞争有限的MHC分子。一个[新抗原](@entry_id:155699)即使自身结合能力很强，但如果细胞内存在大量浓度更高、[结合能](@entry_id:143405)力更强的自身肽段，它被呈递的机会也会大大降低。基于质量作用定律的竞争性结合模型可以描述这一现象。在存在多种竞争肽段 $L_i$（浓度为 $[L_i]$，[解离常数](@entry_id:265737)为 $K_{d,i}$）的情况下，新抗原 $L_0$ 占据[MHC分子](@entry_id:181864)的平衡分数 $f_0$ 为：
$f_0 = \frac{[L_0]/K_{d,0}}{1 + [L_0]/K_{d,0} + \sum_{i=1}^{n} [L_i]/K_{d,i}}$ [@problem_id:2409242]。
这个公式清晰地表明，新抗原的呈递是其自身“结合潜力”（$[L]/K_d$）与整个肽池总结合潜力的相对比较。

### 高级主题与系统级复杂性

除了上述核心步骤，一些更复杂的系统级因素也深刻影响着新抗原的免疫学图景。

#### 肿瘤异质性与克隆性

肿瘤并非由单一类型的细胞构成，而是由具有不同基因型和表型的**亚克隆**组成的异质性群体。这意味着一个[新抗原](@entry_id:155699)可能只存在于一部分肿瘤细胞中（亚克隆性），而不是全部（克隆性）。从治疗角度看，靶向克隆性[新抗原](@entry_id:155699)更为理想，因为这有可能清除整个肿瘤群体。此外，新抗原的表达水平也可能在不同亚克隆间存在差异。一个理想的靶点应该在所有（或大部分）亚克隆中都稳定高表达。为了量化这一特性，我们可以定义一个“稳定性-优先化”分数，例如 $S_i = \frac{\mu_i}{1 + \sigma_i}$，其中 $\mu_i$ 是[新抗原](@entry_id:155699)在所有亚克隆中的加权平均丰度，而 $\sigma_i$ 是其加权标准差。这个分数会优先选择那些平均表达量高（高 $\mu_i$）且在各亚克隆间表达稳定（低 $\sigma_i$）的新抗原 [@problem_id:2409262]。

#### 抗原处理机制（APM）损伤

肿瘤细胞为了逃避[免疫监视](@entry_id:204356)，常常会进化出破坏抗原呈递通路（APM）的突变。例如，`B2M`（[β-2微球蛋白](@entry_id:195288)，MHC-I[分子稳定性](@entry_id:137744)的必需亚基）的失活突变会导致MHC-I分子无法在细胞表面表达。同样，`TAP1`或`TAP2`的突变会损害肽段的转运功能。这些APM突变会系统性地改变新抗原的呈递景观。例如，`TAP1`的损伤会不成比例地影响那些严重依赖TAP转运的肽段，而对不依赖TAP的肽段影响较小。通过模块化的呈递[概率模型](@entry_id:265150)，我们可以量化这些突变的影响，例如，通过引入一个[乘性](@entry_id:187940)因子 $r_{\text{TAP}}$ 或 $r_{\text{B2M}}$ 来降低转运或MHC可用性，从而预测哪些[新抗原](@entry_id:155699)会因此“丢失”（lost），哪些可能会相对“增益”（gained） [@problem_id:2409250] [@problem_id:2409289]。

#### [杂合子](@entry_id:276964)个体的挑战

绝大多数人类个体的[HLA基因](@entry_id:175412)座都是杂合的，即表达多种不同的HLA-I类分子（如HLA-A, -B, -C各有两种）。这意味着一个理想的治疗性[新抗原](@entry_id:155699)肽段最好能与该患者表达的多种[HLA等位基因](@entry_id:185458)结合，以引发更广泛的免疫应答。然而，不同[HLA等位基因](@entry_id:185458)的结合偏好差异巨大，找到一个能“取悦”所有等位基因的“通用”肽段非常困难。这是一个[多目标优化](@entry_id:637420)问题。一种复杂的建模方法是定义一个“软最小值”能量聚合器，如 $J_{\beta}(\mathbf{p}) = -\frac{1}{\beta}\log\left(\frac{1}{M}\sum_{a=1}^{M}\exp\left(-\beta E_a(\mathbf{p})\right)\right)$，来寻找在多个等位基因（每个等位基因的结合能为 $E_a$）之间实现最佳结合能权衡的肽段 $\mathbf{p}$ [@problem_id:2409228]。

#### [免疫编辑](@entry_id:163576)与肿瘤进化

[新抗原](@entry_id:155699)的图景不是静态的，而是在免疫系统的[选择压力](@entry_id:175478)下动态演化的。这个过程被称为**[免疫编辑](@entry_id:163576)**，包含三个阶段：清除、平衡和逃逸。在早期，免疫系统能有效识别并清除表达强[免疫原性](@entry_id:164807)[新抗原](@entry_id:155699)的肿瘤细胞。幸存下来的肿瘤细胞进入平衡期，其免疫原性与[免疫监视](@entry_id:204356)之间达成一种[动态平衡](@entry_id:136767)。最终，肿瘤细胞可能通过各种机制（如丢失新抗原、下调HLA表达）完全逃避[免疫监视](@entry_id:204356)，进入逃逸期。

这个[进化过程](@entry_id:175749)意味着，在临床可诊断的肿瘤中观察到的[新抗原](@entry_id:155699)，很可能是经过免疫系统长期“筛选”后留下的、[免疫原性](@entry_id:164807)相对较弱的“幸存者”。我们可以通过一个简单的仿真模型来验证这个假说：假设一个肿瘤细胞群体的生存权重与其免疫原性 $s$ 成反比，例如 $w(s) = \max\{0, 1 - \alpha s\}$，其中 $\alpha$ 是免疫选择压力。通过模拟多代人的选择和突变过程，可以观察到在存在[选择压力](@entry_id:175478)（$\alpha > 0$）的情况下，群体的平均[免疫原性](@entry_id:164807)会随时间显著下降 [@problem_id:2409240]。这一原理提醒我们，在进行[新抗原预测](@entry_id:173241)时，我们面对的可能是一个已经被“预先筛选”过的、充满挑战的靶标集合。

### 整合性预测工作流程

综合以上所有原理，一个现代化的、严谨的[新抗原预测](@entry_id:173241)工作流程是一个多步骤、多维度的信息整合过程。它不再是单一的亲和力预测，而是一个系统的过滤和优先级排序框架 [@problem_id:2409271]。

一个典型的流程如下：

1.  **[变异识别](@entry_id:177461)**：通过对肿瘤及其匹配的正常组织进行高通量测序（全外显子组或[全基因组测序](@entry_id:169777)，以及[RNA测序](@entry_id:178187)），识别出肿瘤特有的[体细胞突变](@entry_id:276057)或异常[RNA编辑](@entry_id:261025)事件。

2.  **[蛋白质序列](@entry_id:184994)翻译**：将导致非同义改变的变异翻译成突变后的蛋白质序列。

3.  **肽段生成**：从突变位点周围提取所有长度符合MHC-I结合要求（通常为8-11个氨基酸）的重叠肽段。

4.  **[HLA分型](@entry_id:194202)与结合预测**：确定患者的HLA-I类等位基因型别，并为每个候选肽段预测其与每个[HLA等位基因](@entry_id:185458)的[结合亲和力](@entry_id:261722)（如IC50）。

5.  **初步筛选**：基于一个宽松的[结合亲和力](@entry_id:261722)阈值（例如，$\text{IC50}  500 \, \text{nM}$）进行初步筛选，保留所有潜在的结合者。

6.  **整合性优先级排序**：对通过初筛的候选肽段，利用一个综合评分模型进行排序。该模型应整合以下多维度证据：
    *   **结合强度**：绝对结合亲和力（IC50值或百分位排名）。
    *   **差异亲和力**：与对应野生型肽段的[结合亲和力](@entry_id:261722)差异。
    *   **表达丰度**：源基因的表达水平（[TPM](@entry_id:170576)）和变异等位基因频率（VAF）。
    *   **抗原加工**：[蛋白酶体](@entry_id:172113)切割和TAP转运的预测分数。
    *   **克隆性**：评估新抗原是克隆性还是亚克隆性。
    *   **[免疫编辑](@entry_id:163576)压力**：突变是否位于T细胞受体（TCR）接触位点，以及肽段与自身蛋白组的相似性。
    *   **驱动状态**：源基因是否为已知驱动基因，或突变是否具有高复发性等特征。

最终，排名靠前的少数候选肽段将作为高置信度的[新抗原](@entry_id:155699)，进入后续的实验验证和[疫苗设计](@entry_id:191068)阶段。这个流程体现了[新抗原预测](@entry_id:173241)的本质：它不是一个简单的“是/否”问题，而是一个基于多重生物学证据的、复杂的概率推断过程。