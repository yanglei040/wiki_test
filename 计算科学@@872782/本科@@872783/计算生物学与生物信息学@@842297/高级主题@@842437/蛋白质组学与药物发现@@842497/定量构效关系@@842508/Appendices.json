{"hands_on_practices": [{"introduction": "QSAR 的基石之一是 Hansch 分析，它揭示了分子的物理化学性质（如疏水性）与其生物活性之间的定量关系。经典的 Hansch 方程通常是一个抛物线模型，表明存在一个最佳的疏水性值（以 $cLogP$ 度量）可以使生物活性达到峰值。本练习将通过一个假设的 Hansch 方程，让你动手实践如何利用微积分来确定最大化生物活性的最佳描述符值，这是药物设计中的一个核心优化问题 [@problem_id:2423851]。", "problem": "在定量构效关系 (QSAR) 建模中，化合物的疏水性通常通过计算出的辛醇-水分配系数的对数 (cLogP) 来编码。考虑一个由以下函数给出的生物效价与疏水性之间的Hansch型关系\n$$\n\\log_{10}\\!\\left(\\frac{1}{C}\\right) \\;=\\; 0.5 \\cdot \\mathrm{cLogP} \\;-\\; 0.01 \\cdot (\\mathrm{cLogP})^{2} \\;+\\; 1.2,\n$$\n其中 $C$ 表示达到特定效应水平所需的摩尔浓度，而 $\\mathrm{cLogP}$ 是无量纲的。根据QSAR中的标准解释，最佳疏水性对应于使生物活性最大化的$\\mathrm{cLogP}$值，这等同于最大化$\\log_{10}(1/C)$。\n\n确定最佳的 $\\mathrm{cLogP}$。提供精确值，无需四舍五入。答案是无单位的。", "solution": "必须首先对问题陈述进行严格验证。\n\n**步骤1：提取已知条件**\n逐字列出所给的已知条件如下：\n- Hansch型关系：$\\log_{10}\\!\\left(\\frac{1}{C}\\right) \\;=\\; 0.5 \\cdot \\mathrm{cLogP} \\;-\\; 0.01 \\cdot (\\mathrm{cLogP})^{2} \\;+\\; 1.2$\n- $C$ 是达到特定效应水平所需的摩尔浓度。\n- $\\mathrm{cLogP}$ 是无量纲的。\n- 目标是找到使生物活性最大化的$\\mathrm{cLogP}$值，这等同于最大化函数$\\log_{10}(1/C)$。\n\n**步骤2：使用提取的已知条件进行验证**\n根据所需标准评估问题。\n1.  **科学依据**：该问题描述了Hansch分析，这是定量构效关系 (QSAR) 研究中的一个基础概念。生物响应与像疏水性 ($\\mathrm{cLogP}$) 这样的理化参数之间的抛物线关系是一个经典模型，用于解释膜渗透和受体结合等性质如何影响活性。该方程是此模型的标准表示形式。因此，该问题在科学上是合理的，并基于计算药物设计中的既定原则。\n2.  **适定性**：任务是求一个二次函数的最大值。该函数被明确定义，待优化的变量也已清楚说明。一个平方项系数为负的二次函数具有唯一的全局最大值。因此，该问题是适定的。\n3.  **客观性和独立性**：该问题使用精确、客观的数学和科学语言进行陈述。解决问题所需的所有信息都已提供。没有歧义或缺失的定义。\n\n**步骤3：结论与行动**\n该问题是有效的。这是一个基于计算化学标准模型的直接优化问题。我将继续进行解答。\n\n该问题要求找到使生物活性最大化的$\\mathrm{cLogP}$的最佳值，生物活性由函数$\\log_{10}(1/C)$给出。让我们定义一个函数$f(x)$，其中$x = \\mathrm{cLogP}$。需要最大化的函数是：\n$$\nf(x) = 0.5 x - 0.01 x^2 + 1.2\n$$\n这是一个形式为 $f(x) = ax^2 + bx + c$ 的二次函数，其中系数为 $a = -0.01$，$b = 0.5$，$c = 1.2$。由于系数 $a$ 是负数（$a = -0.01  0$），该函数的图像是一个开口向下的抛物线，这保证了存在一个唯一的全局最大值。\n\n为了找到使 $f(x)$ 最大化的 $x$ 值，我们必须使用微分学。最大值出现在函数关于 $x$ 的一阶导数等于零的临界点。\n我们计算一阶导数 $f'(x)$：\n$$\nf'(x) = \\frac{d}{dx} \\left( 0.5 x - 0.01 x^2 + 1.2 \\right)\n$$\n应用微分的幂法则：\n$$\nf'(x) = 0.5 - (2 \\cdot 0.01) x^{1} + 0\n$$\n$$\nf'(x) = 0.5 - 0.02 x\n$$\n现在，我们将一阶导数设为零以找到临界点：\n$$\n0.5 - 0.02 x = 0\n$$\n解这个关于 $x$ 的线性方程：\n$$\n0.02 x = 0.5\n$$\n$$\nx = \\frac{0.5}{0.02}\n$$\n为了简化分数，我们可以将分子和分母同乘以 $100$：\n$$\nx = \\frac{50}{2} = 25\n$$\n为确认该 $x$ 值对应一个最大值，我们可以使用二阶导数检验法。我们计算二阶导数 $f''(x)$：\n$$\nf''(x) = \\frac{d}{dx} (0.5 - 0.02 x) = -0.02\n$$\n由于对所有 $x$ 值，$f''(x) = -0.02  0$，该函数处处为凹，因此 $x=25$ 处的临界点确实是一个全局最大值。\n\n因此，使生物活性最大化的$\\mathrm{cLogP}$的最佳值为$25$。", "answer": "$$\\boxed{25}$$", "id": "2423851"}, {"introduction": "任何 QSAR 模型的预测能力都局限于其训练数据所覆盖的化学空间内，这个范围被称为模型的“适用域”（Applicability Domain, AD）。对于一个落在适用域之外的新化合物，模型的预测结果很可能是不可靠的。本练习将指导你通过一种基于杠杆值（leverage）的常用统计方法，以编程方式判断一个新化合物是否位于模型的可靠预测区间内，这是负责任地应用 QSAR 模型的关键一步 [@problem_id:2423889]。", "problem": "一个分子描述符数据集被用于开发定量构效关系（QSAR）模型。一个新化合物产生了较大的预测误差。请判断这种失败是否可以通过基于从标准化描述符空间计算的杠杆值得到的适用域准则来预测。\n\n设训练描述符矩阵为 $X \\in \\mathbb{R}^{n \\times m}$，其中包含 $n=12$ 个化合物和 $m=3$ 个描述符。对于描述符列 $j \\in \\{1,2,3\\}$，计算训练集均值 $\\mu_j$ 和总体标准差 $\\sigma_j$ 如下：\n$$\n\\mu_j \\;=\\; \\frac{1}{n}\\sum_{i=1}^{n} X_{ij}, \\qquad\n\\sigma_j \\;=\\; \\sqrt{\\frac{1}{n}\\sum_{i=1}^{n} \\bigl(X_{ij}-\\mu_j\\bigr)^2}.\n$$\n按列标准化训练矩阵，得到 $Z \\in \\mathbb{R}^{n \\times m}$，其元素为 $Z_{ij} = \\frac{X_{ij}-\\mu_j}{\\sigma_j}$。定义对称正定矩阵 $S \\in \\mathbb{R}^{m \\times m}$ 为\n$$\nS \\;=\\; Z^\\top Z.\n$$\n对于一个具有原始描述符向量 $x_{\\text{new}} \\in \\mathbb{R}^m$ 的新化合物，使用训练集的统计数据对其进行标准化，得到 $z_{\\text{new}} \\in \\mathbb{R}^m$，其元素为 $z_{\\text{new},j} = \\frac{x_{\\text{new},j}-\\mu_j}{\\sigma_j}$。定义其杠杆值为\n$$\nh_{\\text{new}} \\;=\\; z_{\\text{new}}^\\top S^{-1} z_{\\text{new}}.\n$$\n使用基于杠杆值的常规适用域阈值\n$$\nh^\\star \\;=\\; \\frac{3m}{n}.\n$$\n当且仅当 $h_{\\text{new}}  h^\\star$ 时，宣布新化合物在适用域之外。对于本问题，将“失败是可预测的”解释为事件 $h_{\\text{new}}  h^\\star$。\n\n使用以下训练描述符矩阵 $X$（行是化合物，列是描述符），所有数值对于每个描述符均使用相同的任意单位：\n- 第 1 行：$\\bigl[\\,1.2,\\,35.0,\\,2.10\\,\\bigr]$\n- 第 2 行：$\\bigl[\\,1.5,\\,40.2,\\,2.30\\,\\bigr]$\n- 第 3 行：$\\bigl[\\,0.8,\\,28.7,\\,1.80\\,\\bigr]$\n- 第 4 行：$\\bigl[\\,1.1,\\,33.3,\\,2.00\\,\\bigr]$\n- 第 5 行：$\\bigl[\\,1.7,\\,45.1,\\,2.60\\,\\bigr]$\n- 第 6 行：$\\bigl[\\,1.3,\\,36.9,\\,2.20\\,\\bigr]$\n- 第 7 行：$\\bigl[\\,1.0,\\,31.5,\\,1.90\\,\\bigr]$\n- 第 8 行：$\\bigl[\\,1.4,\\,38.4,\\,2.40\\,\\bigr]$\n- 第 9 行：$\\bigl[\\,1.6,\\,43.0,\\,2.50\\,\\bigr]$\n- 第 10 行：$\\bigl[\\,0.9,\\,29.8,\\,1.70\\,\\bigr]$\n- 第 11 行：$\\bigl[\\,1.8,\\,47.5,\\,2.80\\,\\bigr]$\n- 第 12 行：$\\bigl[\\,1.2,\\,34.1,\\,2.05\\,\\bigr]$\n\n评估以下 4 个新化合物（测试集），每个化合物以原始描述符向量 $x_{\\text{new}}$ 的形式给出：\n- 情况 A：$\\bigl[\\,1.3,\\,36.0,\\,2.10\\,\\bigr]$\n- 情况 B：$\\bigl[\\,2.5,\\,70.0,\\,4.5\\,\\bigr]$\n- 情况 C：$\\bigl[\\,0.7,\\,26.0,\\,1.5\\,\\bigr]$\n- 情况 D：$\\bigl[\\,1.5,\\,40.2,\\,2.30\\,\\bigr]$\n\n你的程序必须：\n- 使用上述公式，从训练矩阵 $X$ 中计算 $\\mu_j$ 和 $\\sigma_j$，其中 $n=12$。\n- 标准化 $X$ 得到 $Z$，并计算 $S = Z^\\top Z$。\n- 对于每个新情况，将 $x_{\\text{new}}$ 标准化为 $z_{\\text{new}}$，计算 $h_{\\text{new}} = z_{\\text{new}}^\\top S^{-1} z_{\\text{new}}$，计算 $h^\\star = \\frac{3m}{n}$（其中 $m=3$，$n=12$），并判断是否 $h_{\\text{new}}  h^\\star$。\n- 生成单行输出，包含四个情况的结果，格式为方括号内以逗号分隔的布尔值列表，顺序为 $\\bigl[\\text{A},\\text{B},\\text{C},\\text{D}\\bigr]$，例如 $\\bigl[\\text{True},\\text{False},\\text{True},\\text{False}\\bigr]$。\n\n输出中不需要物理单位。不使用角度。不使用百分比。输出必须是严格按照上述格式的一行。", "solution": "题目要求我们针对每个新化合物，判断其较大的预测误差是否可以通过基于新数据点在训练集所张成的标准化描述符空间中的杠杆值的适用域分析来预测。其基本构造是在没有截距项的描述符空间中的帽子矩阵：对于一个标准化的训练矩阵 $Z \\in \\mathbb{R}^{n \\times m}$，定义矩阵 $H \\in \\mathbb{R}^{n \\times n}$ 为 $H = Z \\bigl(Z^\\top Z\\bigr)^{-1} Z^\\top$，其对角线元素衡量了训练集中各个化合物的杠杆值。对于一个新的标准化描述符向量 $z_{\\text{new}} \\in \\mathbb{R}^m$，其相对于训练集的杠杆值为\n$$\nh_{\\text{new}} \\;=\\; z_{\\text{new}}^\\top \\bigl(Z^\\top Z\\bigr)^{-1} z_{\\text{new}}.\n$$\n该表达式直接源于在由 $Z$ 的列向量所张成的 $m$ 维描述符空间中，最小二乘投影的几何解释。此处使用的适用域阈值为\n$$\nh^\\star \\;=\\; \\frac{3m}{n},\n$$\n该阈值与训练集大小 $n$ 成反比，与维度 $m$ 成正比。\n\n与这些原则一致的算法步骤如下：\n1.  给定 $X \\in \\mathbb{R}^{n \\times m}$，其中 $n=12$，$m=3$，计算按列的均值和总体标准差：\n    $$\n    \\mu_j = \\frac{1}{12}\\sum_{i=1}^{12} X_{ij}, \\quad \\sigma_j = \\sqrt{\\frac{1}{12}\\sum_{i=1}^{12} \\bigl(X_{ij}-\\mu_j\\bigr)^2}, \\quad j \\in \\{1,2,3\\}.\n    $$\n    这将得到具体的数值 $\\mu_1, \\mu_2, \\mu_3$ 和 $\\sigma_1, \\sigma_2, \\sigma_3$。\n2.  构建标准化训练矩阵 $Z$，其元素为 $Z_{ij} = \\frac{X_{ij}-\\mu_j}{\\sigma_j}$，确保每列的均值为零，总体方差为一。计算 $S = Z^\\top Z \\in \\mathbb{R}^{3 \\times 3}$ 并求其逆矩阵 $S^{-1}$（可逆性源于列向量的线性无关性）。\n3.  对于每个新的原始描述符向量 $x_{\\text{new}}$，使用相同的 $\\mu_j$ 和 $\\sigma_j$ 计算 $z_{\\text{new}}$，即 $z_{\\text{new},j} = \\frac{x_{\\text{new},j}-\\mu_j}{\\sigma_j}$，然后计算杠杆值 $h_{\\text{new}} = z_{\\text{new}}^\\top S^{-1} z_{\\text{new}}$。\n4.  设置 $h^\\star = \\frac{3m}{n} = \\frac{3 \\cdot 3}{12}$。\n5.  如果 $h_{\\text{new}}  h^\\star$，则判定为“可预测的失败”，否则为“不可预测”。\n\n将这些步骤应用于所提供的数据：\n- 使用给定的 $X$，直接根据定义计算均值和总体标准差。标准化后得到 $Z$，然后构建并求逆 $S = Z^\\top Z$。\n- 对于情况 A，其 $x_{\\text{new}} = \\bigl[\\,1.3,\\,36.0,\\,2.10\\,\\bigr]$，标准化后的向量 $z_{\\text{new}}$ 接近原点；得到的 $h_{\\text{new}}$ 远小于 $h^\\star$，因此判定为“不可预测”（布尔值 $\\text{False}$）。\n- 对于情况 B，其 $x_{\\text{new}} = \\bigl[\\,2.5,\\,70.0,\\,4.5\\,\\bigr]$，$z_{\\text{new}}$ 远离训练数据云；$h_{\\text{new}}$ 远大于 $h^\\star$，因此判定为“可预测”（布尔值 $\\text{True}$）。\n- 对于情况 C，其 $x_{\\text{new}} = \\bigl[\\,0.7,\\,26.0,\\,1.5\\,\\bigr]$，$z_{\\text{new}}$ 离中心有一定距离；$h_{\\text{new}}$ 大于 $h^\\star$，因此判定为“可预测”（布尔值 $\\text{True}$）。\n- 对于情况 D，其 $x_{\\text{new}} = \\bigl[\\,1.5,\\,40.2,\\,2.30\\,\\bigr]$，这与一个训练点重合，$h_{\\text{new}}$ 相较于 $h^\\star$ 很小，因此判定为“不可预测”（布尔值 $\\text{False}$）。\n\n因此，按 $\\bigl[\\text{A},\\text{B},\\text{C},\\text{D}\\bigr]$ 顺序，布尔结果为 $\\bigl[\\text{False},\\text{True},\\text{True},\\text{False}\\bigr]$。附带的程序通过遵循上述定义计算这些值，并以要求的单行格式打印它们。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef standardize_training(X):\n    \"\"\"\n    Compute column-wise means and population standard deviations (ddof=0),\n    then standardize X using these statistics.\n    Returns Z (standardized), means, stds.\n    \"\"\"\n    means = X.mean(axis=0)\n    # population std: sqrt(mean((x - mean)^2))\n    diffs = X - means\n    vars_pop = (diffs ** 2).mean(axis=0)\n    stds = np.sqrt(vars_pop)\n    # Guard against zero std (not expected here)\n    if np.any(stds == 0):\n        raise ValueError(\"Zero standard deviation encountered in a descriptor column.\")\n    Z = (X - means) / stds\n    return Z, means, stds\n\ndef leverage_new_point(z_new, S_inv):\n    \"\"\"\n    Compute leverage h_new = z_new^T S^{-1} z_new\n    where S = Z^T Z for training standardized matrix Z.\n    \"\"\"\n    return float(z_new @ S_inv @ z_new)\n\ndef solve():\n    # Training descriptor matrix X: n=12, m=3\n    X = np.array([\n        [1.2, 35.0, 2.10],\n        [1.5, 40.2, 2.30],\n        [0.8, 28.7, 1.80],\n        [1.1, 33.3, 2.00],\n        [1.7, 45.1, 2.60],\n        [1.3, 36.9, 2.20],\n        [1.0, 31.5, 1.90],\n        [1.4, 38.4, 2.40],\n        [1.6, 43.0, 2.50],\n        [0.9, 29.8, 1.70],\n        [1.8, 47.5, 2.80],\n        [1.2, 34.1, 2.05],\n    ], dtype=float)\n\n    # Test suite: new compounds (A, B, C, D)\n    new_compounds = [\n        np.array([1.3, 36.0, 2.10], dtype=float),  # A\n        np.array([2.5, 70.0, 4.50], dtype=float),  # B\n        np.array([0.7, 26.0, 1.50], dtype=float),  # C\n        np.array([1.5, 40.2, 2.30], dtype=float),  # D\n    ]\n\n    n, m = X.shape\n    # Standardize training data\n    Z, means, stds = standardize_training(X)\n    # Compute S and its inverse\n    S = Z.T @ Z\n    # Using a robust inverse in case of near-singularity; here it should be fine.\n    S_inv = np.linalg.inv(S)\n\n    # Applicability domain threshold h* = 3m/n\n    h_star = 3.0 * m / n\n\n    results = []\n    for x_new in new_compounds:\n        z_new = (x_new - means) / stds\n        h_new = leverage_new_point(z_new, S_inv)\n        predictable = h_new > h_star\n        results.append(predictable)\n\n    # Final print statement in the exact required format.\n    # Booleans will be printed as True/False without spaces as per join formatting.\n    print(f\"[{','.join('True' if r else 'False' for r in results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2423889"}, {"introduction": "在模型构建中，我们常常面临一个选择：是选择一个简单、可解释的模型，还是一个复杂但可能更强大的“黑箱”模型？当一个简单的线性模型和一个复杂的随机森林模型在交叉验证中表现出相同的预测性能（$Q^2$）时，我们该如何抉择？本练习旨在挑战你超越原始的性能指标，深入思考科学建模中的奥卡姆剃刀原理（即简约性原理），强调模型可解释性、稳健性以及避免过拟合的重要性 [@problem_id:2423926]。", "problem": "您正在构建一个定量构效关系 (QSAR) 模型，以预测一个化学系列的抑制效力（以 $pK_i$ 表示）。您有一个包含 $n$ 个分子（响应为 $y_1,\\dots,y_n$）的数据集、标准化的分子描述符，以及两个候选模型。这两个模型在相同的预处理和相同的 $k$ 折交叉验证 (CV) 划分下进行了训练和评估：\n- 模型 $L$：一个使用 $2$ 个标准化描述符的线性回归模型。\n- 模型 $R$：一个使用 $200$ 个标准化描述符的随机森林 (RF) 模型，其默认超参数仅在训练折内进行了调整。\n\n在相同的 $k$ 折交叉验证方案中，两个模型都取得了相同的交叉验证决定系数 $Q^2$（误差小于 $10^{-3}$）。目前没有可用的外部测试集。您必须选择一个模型立即部署，作为向药物化学家报告的主要 QSAR 模型。\n\n哪个选择最合适？为什么？\n\nA. 选择模型 $L$（$2$ 个描述符的线性模型），因为在相同的验证条件下 $Q^2$ 相等时，更简单的模型因其较低的方差、更好的可解释性以及更低的机会相关风险而更受青睐，除非且直到复杂模型在独立数据上表现出明显的预测优势。\n\nB. 选择模型 $R$（$200$ 个描述符的随机森林模型），因为使用更多描述符保证了更广的应用域并避免了欠拟合，所以即使当前 $Q^2$ 相等，它的泛化能力也会更好。\n\nC. 选择模型 $R$，因为它可以捕捉非线性效应；如果其 $Q^2$ 与线性模型相同，那么非线性模型对于新数据必须更加稳健。\n\nD. 都不选；$Q^2$ 没有用。选择训练集 $R^2$ 更高的模型，因为它能更好地反映拟合质量。\n\nE. 立即将 $L$ 和 $R$ 组合成一个集成模型；集成必然会提高 $Q^2$，而无需额外的验证。", "solution": "首先将验证问题陈述的科学性和逻辑完整性。\n\n**步骤 1：提取已知条件**\n- **任务：** 构建一个定量构效关系 (QSAR) 模型来预测抑制效力 $pK_i$。\n- **数据集：** 一组 $n$ 个分子，响应为 $y_1, \\dots, y_n$。所有分子描述符都已标准化。\n- **模型 L：** 一个使用 $2$ 个标准化描述符的线性回归模型。\n- **模型 R：** 一个使用 $200$ 个标准化描述符的随机森林 (RF) 模型。其超参数在交叉验证的训练折内进行了调整。\n- **验证方案：** 两个模型都使用相同的 $k$ 折交叉验证 (CV) 划分进行训练和评估。\n- **性能指标：** 两个模型都取得了相同的交叉验证决定系数 $Q^2$，误差小于 $10^{-3}$。\n- **约束：** 没有可用的外部测试集用于进一步验证。\n- **问题：** 哪个模型是立即部署的最合适选择？\n\n**步骤 2：使用提取的已知条件进行验证**\n问题陈述描述了计算药物设计和生物信息学领域中一个常见且现实的场景。所有使用的术语——QSAR、$pK_i$、线性回归、随机森林、标准化描述符、$k$ 折交叉验证以及 $Q^2$ 指标——在该领域都是标准且明确定义的。该设定是自洽的、有科学依据的，并且不包含矛盾、歧义或事实错误。该问题是适定的，要求基于既定的统计模型选择原则做出合理的决定。\n\n**步骤 3：结论与行动**\n问题陈述是**有效的**。将通过在统计建模原则的背景下分析所提供的信息来推导出解决方案。\n\n**求解过程**\n这个问题的核心是在预测性能相等的情况下进行模型选择。指导此类选择的原则是简约性原则，通常称为奥卡姆剃刀 (Occam's Razor)，该原则指出，在能够同等好地解释数据的相互竞争的假设或模型中，应选择假设最少的那个（即最简单的那个）。\n\n让我们比较这两个模型：\n\n1.  **模型 L（线性回归，$2$ 个描述符）：**\n    - **复杂度：** 这是一个复杂度非常低的模型。它是一个由 $y = \\beta_0 + \\beta_1 x_1 + \\beta_2 x_2$ 定义的线性函数，仅涉及估计 $3$ 个参数。\n    - **可解释性：** 该模型高度可解释。系数 $\\beta_1$ 和 $\\beta_2$ 直接量化了每个描述符对生物活性 $pK_i$ 影响的大小和方向。这对药物化学家非常有价值，因为它为理性药物设计提供了清晰、可检验的假设。\n    - **风险状况：** 由于只有 $2$ 个描述符，该模型的内在方差较低，不易对训练数据过拟合。仅因机会相关而发现虚假关系的风险，与一个搜索 $200$ 个描述符的模型相比要低得多。\n\n2.  **模型 R（随机森林，$200$ 个描述符）：**\n    - **复杂度：** 这是一个高复杂度的非线性、非参数集成模型。它涉及大量内部参数（树结构、节点分裂），并使用了一个大得多的特征空间（$200$ 个描述符）。\n    - **可解释性：** 该模型实际上是一个“黑箱”。虽然存在估计特征重要性的方法，但它们无法提供线性模型系数那样简单、直接且可操作的见解。对构效关系的确切性质的理解变得模糊不清。\n    - **风险状况：** 尽管随机森林具有固有的减少过拟合的机制（例如，自助聚合抽样和特征子抽样），一个能接触到 $200$ 个描述符的模型具有非常高的容量。其交叉验证性能（$Q^2$）不优于一个简单的 $2$ 描述符线性模型，这是一个重要的危险信号。这表明额外的复杂度和描述符并没有捕捉到任何超出线性模型所捕捉的、真实的、可泛化的信号。大量的描述符极大地增加了发现无法泛化到新数据的机会相关的可能性。复杂模型可能在交叉验证的训练折内过拟合，其 $Q^2$ 可能是对其在独立测试集上真实性能的乐观估计。\n\n**结论：**\n鉴于 $Q^2_L \\approx Q^2_R$，这两个模型在交叉验证下表现出等效的预测能力。根据简约性原则，更简单的模型 L 是更优的选择。其优势在于：\n- **更低的过拟合风险：** 它具有较低的模型方差，并且不太可能利用了机会相关。\n- **更高的可解释性：** 它为构效关系提供了清晰的见解，这是 QSAR 的一个主要目标。\n- **稳健性：** 其性能更有可能在真正的外部数据集上保持稳健。更复杂的模型有责任证明它能提供显著优势；而在这里，它并没有。\n\n**逐项分析选项**\n\n**A. 选择模型 $L$（$2$ 个描述符的线性模型），因为在相同的验证条件下 $Q^2$ 相等时，更简单的模型因其较低的方差、更好的可解释性以及更低的机会相关风险而更受青睐，除非且直到复杂模型在独立数据上表现出明显的预测优势。**\n这个理由完全合理。它正确地应用了简约性原则，并指出了线性模型在此特定情境下的关键优势：较低的方差（稳健性）、高的可解释性以及较低的发现虚假关系的风险。关于要求复杂模型提供未来证据的限定条件在科学上也是合适的。\n**结论：正确。**\n\n**B. 选择模型 $R$（$200$ 个描述符的随机森林模型），因为使用更多描述符保证了更广的应用域并避免了欠拟合，所以即使当前 $Q^2$ 相等，它的泛化能力也会更好。**\n这个理由是有缺陷的。描述符的数量并不决定应用域；训练集化合物的化学空间才决定应用域。此外，对于一个拥有 $200$ 个描述符的模型，主要风险是过拟合，而不是欠拟合。声称它“会泛化得更好”是毫无根据的断言，与现有证据（$Q^2$ 相等）相矛盾。\n**结论：不正确。**\n\n**C. 选择模型 $R$，因为它可以捕捉非线性效应；如果其 $Q^2$ 与线性模型相同，那么非线性模型对于新数据必须更加稳健。**\n这个论证在逻辑上是错误的。虽然随机森林可以捕捉非线性，但如果其性能仅与线性模型相当，则意味着底层关系在很大程度上是线性的，或者随机森林模型的复杂性没有提供任何真正的预测增益。没有依据可以断定它“必须更加稳健”；事实上，不必要的复杂性表明它可能*更不*稳健。\n**结论：不正确。**\n\n**D. 都不选；$Q^2$ 没有用。选择训练集 $R^2$ 更高的模型，因为它能更好地反映拟合质量。**\n这种说法表明了对模型验证的基本误解。训练集决定系数 $R^2$ 衡量的是对训练数据的拟合优度，是预测新数据性能的不良指标。高训练集 $R^2$ 通常是过拟合的症状。来自交叉验证的 $Q^2$ 是一个用于评估模型泛化能力的远为关键和有用的指标。为了训练集 $R^2$ 而忽视 $Q^2$ 是不正确的做法。\n**结论：不正确。**\n\n**E. 立即将 $L$ 和 $R$ 组合成一个集成模型；集成必然会提高 $Q^2$，而无需额外的验证。**\n这是不正确的。集成不同的模型并不“一定”能提高性能；有时甚至可能使其恶化，特别是如果其中一个模型很差。最重要的是，任何新模型，包括集成模型，都**必须**独立验证。在没有进行适当验证（例如对集成预测执行新的 $k$ 折交叉验证程序）的情况下假设其性能是不科学的。\n**结论：不正确。**", "answer": "$$\\boxed{A}$$", "id": "2423926"}]}