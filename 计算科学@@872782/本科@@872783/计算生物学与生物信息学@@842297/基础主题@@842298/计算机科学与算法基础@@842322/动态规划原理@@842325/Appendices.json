{"hands_on_practices": [{"introduction": "在解决优化问题时，贪心算法因其简单直观而具有吸引力，但它真的总能找到最佳答案吗？本练习 [@problem_id:2387141] 将通过一个具体的序列比对场景，让你亲手计算并对比贪心策略与动态规划方法所得出的结果。这个对比将清晰地揭示为何动态规划所保证的全局最优性在生物信息学问题中至关重要。", "problem": "在计算生物学和生物信息学中，动态规划原理的一个重要应用是全局序列比对。考虑脱氧核糖核酸字母表 $\\Sigma=\\{\\texttt{A},\\texttt{C},\\texttt{G},\\texttt{T}\\}$，并定义一个替换评分函数 $s:\\Sigma\\times\\Sigma\\to\\mathbb{R}$，当 $x=y$ 时 $s(x,y)=+2$，当 $x\\neq y$ 时 $s(x,y)=-1$。对于任何字母与一个空位的比对，使用线性空位罚分 $g=-2$。\n\n设两个序列为 $X=\\texttt{ACG}$ 和 $Y=\\texttt{AG}$。您将比较两种策略：\n\n1. 使用全局比对的动态规划原理（Needleman–Wunsch 算法）计算的全局最优比对，该方法依赖于前缀的最优子结构性质。\n2. 一种贪婪比对策略，定义如下：在每一步，给定下一个未比对的字母 $x_i$ 和 $y_j$，从三种可能性中选择具有最高即时得分的操作：将 $x_i$ 与 $y_j$ 比对，得分为 $s(x_i,y_j)$；将 $x_i$ 与一个空位比对，得分为 $g$；或将 $y_j$ 与一个空位比对，得分为 $g$。如果出现得分相同的情况，则优先选择将 $x_i$ 与 $y_j$ 比对；如果仍然相同，则优先选择将 $x_i$ 与空位比对，而不是将 $y_j$ 与空位比对。继续此过程，直到两个序列都完全比对。\n\n仅使用动态规划原理和上述定义（不使用任何未提供的公式），计算：\n- 在 $s$ 和 $g$ 规则下，比对 $X$ 和 $Y$ 的最优全局比对得分 $F$，\n- 通过上述贪婪规则产生的贪婪比对得分 $G$，\n- 最后是差值 $\\Delta=F-G$。\n\n仅报告 $\\Delta$ 的值作为您的最终答案。无需四舍五入，也无需单位。", "solution": "对问题陈述进行验证。\n\n第1步：提取已知条件\n- 字母表：$\\Sigma=\\{\\texttt{A},\\texttt{C},\\texttt{G},\\texttt{T}\\}$\n- 替换评分函数 $s(x,y)$：如果 $x=y$，$s(x,y)=+2$；如果 $x \\neq y$，$s(x,y)=-1$。\n- 线性空位罚分：$g=-2$。\n- 序列：$X=\\texttt{ACG}$，$Y=\\texttt{AG}$。\n- 策略1：使用动态规划原理的全局最优比对。得分记为 $F$。\n- 策略2：一种指定的贪婪比对策略。得分记为 $G$。\n- 贪婪策略的平局打破规则：如果得分出现平局，操作的优先顺序是：首先，将 $x_i$ 与 $y_j$ 比对；其次，将 $x_i$ 与空位比对；第三，将 $y_j$ 与空位比对。\n- 目标：计算差值 $\\Delta=F-G$。\n\n第2步：验证\n该问题具有科学依据，因为它涉及 Needleman-Wunsch 算法，这是计算生物学中的一个基本概念。问题提法得当，提供了所有必要的序列、一个完整的评分函数，以及针对最优和贪婪过程的明确规则。语言客观、精确。问题是自包含的，不违反任何物理或数学原理。所有术语都得到了清晰的定义。\n\n第3步：结论\n该问题有效。将制定一个完整的解决方案。\n\n任务要求基于提供的评分方案计算序列 $X=\\texttt{ACG}$ 和 $Y=\\texttt{AG}$ 的两个比对得分：匹配得分为 $s(x,y)=+2$，错配得分为 $s(x,y)=-1$，线性空位罚分为 $g=-2$。\n\n首先，我们将使用动态规划原理计算最优全局比对得分 $F$。设 $m$ 是序列 $X$ 的长度，$n$ 是序列 $Y$ 的长度。这里，$m=3$，$n=2$。我们定义一个矩阵 $F(i,j)$，表示前缀 $X[1..i]$ 和 $Y[1..j]$ 的最优比对得分。$F(i,j)$ 的值源于最优子结构性质，该性质规定前缀的最优比对必须由更小前缀的最优比对构成。每个单元格的值由三种可能的前置状态的最大值决定：\n1. 将 $X[i]$ 与 $Y[j]$ 比对：得分为 $F(i-1, j-1) + s(X[i], Y[j])$。\n2. 将 $X[i]$ 与空位比对：得分为 $F(i-1, j) + g$。\n3. 将 $Y[j]$ 与空位比对：得分为 $F(i, j-1) + g$。\n\n因此，递推关系为：\n$$F(i,j) = \\max\\left\\{ F(i-1, j-1) + s(X[i], Y[j]),\\; F(i-1, j) + g,\\; F(i, j-1) + g \\right\\}$$\n基本条件是前缀与空字符串的比对：\n$F(0,0) = 0$\n$F(i,0) = i \\times g$ 对于 $i > 0$\n$F(0,j) = j \\times g$ 对于 $j > 0$\n\n我们构建一个 $(m+1) \\times (n+1)$ 即 $4 \\times 3$ 的矩阵。\n初始化：\n$F(0,0) = 0$\n$F(1,0) = 1 \\times (-2) = -2$\n$F(2,0) = 2 \\times (-2) = -4$\n$F(3,0) = 3 \\times (-2) = -6$\n$F(0,1) = 1 \\times (-2) = -2$\n$F(0,2) = 2 \\times (-2) = -4$\n\n填充矩阵，其中 $i \\in \\{1,2,3\\}$ 且 $j \\in \\{1,2\\}$：\n$F(1,1)$：比对 $X_1=\\texttt{A}$ 和 $Y_1=\\texttt{A}$。$s(\\texttt{A},\\texttt{A})=+2$。\n$F(1,1) = \\max\\{F(0,0)+2, F(0,1)-2, F(1,0)-2\\} = \\max\\{0+2, -2-2, -2-2\\} = 2$。\n\n$F(2,1)$：比对 $X_2=\\texttt{C}$ 和 $Y_1=\\texttt{A}$。$s(\\texttt{C},\\texttt{A})=-1$。\n$F(2,1) = \\max\\{F(1,0)-1, F(1,1)-2, F(2,0)-2\\} = \\max\\{-2-1, 2-2, -4-2\\} = \\max\\{-3, 0, -6\\} = 0$。\n\n$F(3,1)$：比对 $X_3=\\texttt{G}$ 和 $Y_1=\\texttt{A}$。$s(\\texttt{G},\\texttt{A})=-1$。\n$F(3,1) = \\max\\{F(2,0)-1, F(2,1)-2, F(3,0)-2\\} = \\max\\{-4-1, 0-2, -6-2\\} = \\max\\{-5, -2, -8\\} = -2$。\n\n$F(1,2)$：比对 $X_1=\\texttt{A}$ 和 $Y_2=\\texttt{G}$。$s(\\texttt{A},\\texttt{G})=-1$。\n$F(1,2) = \\max\\{F(0,1)-1, F(0,2)-2, F(1,1)-2\\} = \\max\\{-2-1, -4-2, 2-2\\} = \\max\\{-3, -6, 0\\} = 0$。\n\n$F(2,2)$：比对 $X_2=\\texttt{C}$ 和 $Y_2=\\texttt{G}$。$s(\\texttt{C},\\texttt{G})=-1$。\n$F(2,2) = \\max\\{F(1,1)-1, F(1,2)-2, F(2,1)-2\\} = \\max\\{2-1, 0-2, 0-2\\} = \\max\\{1, -2, -2\\} = 1$。\n\n$F(3,2)$：比对 $X_3=\\texttt{G}$ 和 $Y_2=\\texttt{G}$。$s(\\texttt{G},\\texttt{G})=+2$。\n$F(3,2) = \\max\\{F(2,1)+2, F(2,2)-2, F(3,1)-2\\} = \\max\\{0+2, 1-2, -2-2\\} = \\max\\{2, -1, -4\\} = 2$。\n\n完整的DP矩阵如下：\n\n| | | A | G |\n|---|---|---|---|\n| | 0 | -2 | -4 |\n| A | -2 | 2 | 0 |\n| C | -4 | 0 | 1 |\n| G | -6 | -2 | 2 |\n\n最优全局比对得分是右下角单元格的值，即 $F = F(3,2) = 2$。\n\n接下来，我们计算贪婪比对得分 $G$。贪婪策略考虑下一个未比对的字母，并选择具有最大即时得分的操作。设 $i$ 和 $j$ 是指向 $X$ 和 $Y$ 中当前字符的指针，从 $i=1, j=1$ 开始。总分 $G$ 初始化为 $0$。\n\n第1步：$i=1, j=1$。当前字母是 $X_1=\\texttt{A}, Y_1=\\texttt{A}$。\n- 操作1（将 $X_1$ 与 $Y_1$ 比对）：得分 $s(\\texttt{A},\\texttt{A}) = +2$。\n- 操作2（将 $X_1$ 与空位比对）：得分 $g = -2$。\n- 操作3（将 $Y_1$ 与空位比对）：得分 $g = -2$。\n最高分是 $2$。我们将 $\\texttt{A}$ 与 $\\texttt{A}$ 比对。\n$G$ 变为 $0+2=2$。我们将两个指针都推进到 $i=2, j=2$。比对为 $\\texttt{A}$ -- $\\texttt{A}$。\n\n第2步：$i=2, j=2$。当前字母是 $X_2=\\texttt{C}, Y_2=\\texttt{G}$。\n- 操作1（将 $X_2$ 与 $Y_2$ 比对）：得分 $s(\\texttt{C},\\texttt{G}) = -1$。\n- 操作2（将 $X_2$ 与空位比对）：得分 $g = -2$。\n- 操作3（将 $Y_2$ 与空位比对）：得分 $g = -2$。\n最高分是 $-1$。我们将 $\\texttt{C}$ 与 $\\texttt{G}$ 比对。\n$G$ 变为 $2+(-1)=1$。我们将两个指针都推进到 $i=3, j=3$。比对为 $\\texttt{AC}$ -- $\\texttt{AG}$。\n\n第3步：$i=3, j=3$。序列 $Y$ 已用尽，因为 $j > n=2$。\n唯一剩下的操作是将序列 $X$ 的剩余部分与空位比对。剩下的字符是 $X_3=\\texttt{G}$。\n我们将 $\\texttt{G}$ 与一个空位比对，得分为 $g=-2$。\n$G$ 变为 $1+(-2)=-1$。我们将 $i$ 推进到 $4$。比对为 $\\texttt{ACG}$ -- $\\texttt{AG-}$。\n\n现在两个序列都已完全比对。最终的贪婪比对得分是 $G=-1$。\n\n最后，我们计算差值 $\\Delta=F-G$。\n$F = 2$\n$G = -1$\n$\\Delta = F - G = 2 - (-1) = 3$。\n\n通过动态规划得到的最优得分与指定贪婪策略得到的得分之差为 $3$。", "answer": "$$\n\\boxed{3}\n$$", "id": "2387141"}, {"introduction": "动态规划的威力远不止于简单的双序列比对。本练习 [@problem_id:2387070] 旨在拓宽你的视野，展示如何运用动态规划原理解决一个看似不同但内在相关的问题：寻找最长回文子序列。通过将此问题巧妙地转化为一个最长公共子序列（LCS）问题，你将更深刻地理解动态规划的灵活性与通用性。", "problem": "一个脱氧核糖核酸（DNA）片段被建模为字母表 $\\{\\text{A}, \\text{C}, \\text{G}, \\text{T}\\}$ 上的有限字符串 $S$。$S$ 的一个子序列是通过从 $S$ 中删除零个或多个字符而不改变其余字符的顺序得到的。回文串是指与其反向字符串完全相同的字符串。考虑长度为 $10$ 的DNA字符串 $S = \\text{ACGTCAGCAT}$。\n\n仅使用上述定义和动态规划原理，确定 $S$ 的最长回文子序列的长度（不一定连续）。将长度报告为单个整数，不带单位。无需四舍五入。", "solution": "对提出的问题进行验证。\n\n**步骤1：提取已知条件**\n-   **领域**：一个脱氧核糖核酸（DNA）片段被建模为字母表 $\\{\\text{A}, \\text{C}, \\text{G}, \\text{T}\\}$ 上的有限字符串 $S$。\n-   **子序列的定义**：$S$ 的一个子序列是通过从 $S$ 中删除零个或多个字符而不改变其余字符的顺序得到的。\n-   **回文串的定义**：回文串是指与其反向字符串完全相同的字符串。\n-   **输入字符串**：$S = \\text{ACGTCAGCAT}$。\n-   **输入字符串长度**：$10$。\n-   **目标**：确定 $S$ 的最长回文子序列的长度。\n-   **约束**：解决方案必须使用动态规划原理。\n\n**步骤2：使用提取的已知条件进行验证**\n根据所需标准评估问题陈述：\n-   **科学依据**：该问题在计算生物学和计算机科学中有充分的依据。将DNA表示为字符串并分析其子序列是标准且有效的抽象。\n-   **适定性**：寻找最长回文子序列的长度是一个经典的、定义明确的问题，具有唯一的解。所有必要的数据（$S$）和定义均已提供。\n-   **客观性**：语言正式、精确，没有任何主观性或歧义。\n\n**结论：** 该问题是有效的。这是一个动态规划的标准练习，内容自洽且科学合理。开始求解。\n\n问题是求给定字符串 $S$ 的最长回文子序列（LPS）的长度。算法理论中的一个基本结论指出，字符串 $S$ 的最长回文子序列的长度等于 $S$ 与其反向字符串 $S_{rev}$ 的最长公共子序列（LCS）的长度。我们将使用动态规划来解决这个等价的LCS问题。\n\n设给定字符串为 $S = \\text{ACGTCAGCAT}$。其长度为 $n=10$。\n$S$ 的反向字符串为 $S_{rev} = \\text{TACGACGTCA}$。\n\n令 $L(i, j)$ 表示 $S$ 的长度为 $i$ 的前缀（即 $S[1..i]$）与 $S_{rev}$ 的长度为 $j$ 的前缀（即 $S_{rev}[1..j]$）的最长公共子序列的长度。我们的目标是计算 $L(n, n) = L(10, 10)$。\n\n对于 $i, j \\in \\{1, \\dots, n\\}$，$L(i, j)$ 的动态规划递推关系如下：\n$$\nL(i, j) =\n\\begin{cases}\n    L(i-1, j-1) + 1,  & \\text{if } S[i] = S_{rev}[j] \\\\\n    \\max(L(i-1, j), L(i, j-1)),  & \\text{if } S[i] \\neq S_{rev}[j]\n\\end{cases}\n$$\n基本情况是，对于所有 $i \\in \\{0, \\dots, n\\}$，$L(i, 0) = 0$；对于所有 $j \\in \\{0, \\dots, n\\}$，$L(0, j) = 0$。\n\n我们构建一个 $(n+1) \\times (n+1)$ 的表格来存储 $L(i, j)$ 的值。行由 $S$ 的字符索引（从 $i=1$ 到 $10$），列由 $S_{rev}$ 的字符索引（从 $j=1$ 到 $10$）。第 $0$ 行和第 $0$ 列初始化为 $0$。\n\n令 $S_i$ 为 $S$ 的第 $i$ 个字符，$(S_{rev})_j$ 为 $S_{rev}$ 的第 $j$ 个字符。\n$S = \\text{A}_1 \\text{C}_2 \\text{G}_3 \\text{T}_4 \\text{C}_5 \\text{A}_6 \\text{G}_7 \\text{C}_8 \\text{A}_9 \\text{T}_{10}$\n$S_{rev} = \\text{T}_1 \\text{A}_2 \\text{C}_3 \\text{G}_4 \\text{A}_5 \\text{C}_6 \\text{G}_7 \\text{T}_8 \\text{C}_9 \\text{A}_{10}$\n\n表格填充如下：\n\n| $L(i,j)$ | | $T_1$ | $A_2$ | $C_3$ | $G_4$ | $A_5$ | $C_6$ | $G_7$ | $T_8$ | $C_9$ | $A_{10}$ |\n|---|---|---|---|---|---|---|---|---|---|---|---|\n| | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |\n| $A_1$ | 0 | 0 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 | 1 |\n| $C_2$ | 0 | 0 | 1 | 2 | 2 | 2 | 2 | 2 | 2 | 2 | 2 |\n| $G_3$ | 0 | 0 | 1 | 2 | 3 | 3 | 3 | 3 | 3 | 3 | 3 |\n| $T_4$ | 0 | 1 | 1 | 2 | 3 | 3 | 3 | 3 | 4 | 4 | 4 |\n| $C_5$ | 0 | 1 | 1 | 2 | 3 | 3 | 4 | 4 | 4 | 5 | 5 |\n| $A_6$ | 0 | 1 | 2 | 2 | 3 | 4 | 4 | 4 | 4 | 5 | 6 |\n| $G_7$ | 0 | 1 | 2 | 2 | 3 | 4 | 4 | 5 | 5 | 5 | 6 |\n| $C_8$ | 0 | 1 | 2 | 3 | 3 | 4 | 5 | 5 | 5 | 6 | 6 |\n| $A_9$ | 0 | 1 | 2 | 3 | 3 | 4 | 5 | 5 | 5 | 6 | 7 |\n| $T_{10}$| 0 | 1 | 2 | 3 | 3 | 4 | 5 | 5 | 6 | 6 | 7 |\n\n让我们验证几个关键条目以确保正确性。\n-   $L(6, 10)$: $S[6] = \\text{'A'}$ 且 $S_{rev}[10] = \\text{'A'}$。因此，$L(6, 10) = L(5, 9) + 1 = 5 + 1 = 6$。\n-   $L(8, 9)$: $S[8] = \\text{'C'}$ 且 $S_{rev}[9] = \\text{'C'}$。因此，$L(8, 9) = L(7, 8) + 1 = 5 + 1 = 6$。\n-   $L(9, 10)$: $S[9] = \\text{'A'}$ 且 $S_{rev}[10] = \\text{'A'}$。因此，$L(9, 10) = L(8, 9) + 1 = 6 + 1 = 7$。\n-   $L(10, 10)$: $S[10] = \\text{'T'}$ 且 $S_{rev}[10] = \\text{'A'}$。它们不相等。因此，$L(10, 10) = \\max(L(9, 10), L(10, 9)) = \\max(7, 6) = 7$。\n\n表格中的最后一个条目 $L(10, 10)$ 给出了 $S$ 和 $S_{rev}$ 的最长公共子序列的长度，也就是 $S$ 的最长回文子序列的长度。\n从表格中可知，$L(10, 10)$ 的值为 $7$。\n一个可能的最长回文子序列是 $\\text{ACGAGCA}$。这可以通过回溯表格中的路径来构建。\n\n最长回文子序列的长度为 $7$。", "answer": "$$\\boxed{7}$$", "id": "2387070"}, {"introduction": "多序列比对是生物信息学中的一项核心任务，而动态规划是解决该问题的理论基石。本练习 [@problem_id:2387093] 将挑战你将二维动态规划的思想扩展到三维空间，以同时比对三个序列。通过处理更复杂的多维计分函数，你将为理解更高级的生物信息学工具打下坚实的基础。", "problem": "考虑三个基于字母表 $\\mathcal{A}=\\{\\text{A},\\text{C},\\text{G},\\text{T}\\}$ 的脱氧核糖核酸 (DNA) 序列：$X=(\\text{A},\\text{G},\\text{C})$，$Y=(\\text{A},\\text{C})$ 和 $Z=(\\text{A},\\text{G})$。一个比对是一系列列，每一列都是 $(\\mathcal{A}\\cup\\{-\\})^{3}$ 的一个元素，其中三个条目不全为 $-$，并且来自每个序列的非空位字符总数等于其长度。比对的分数是其各列的自定义三元组评分函数 $S$ 的得分之和，该函数取决于列中的三个条目，并且不能简化为两两配对分数的总和。函数 $S$ 对任何三元组 $(u,v,w)\\in(\\mathcal{A}\\cup\\{-\\})^{3}$ 定义如下：\n- 如果没有空位，即 $u,v,w\\in\\mathcal{A}$，则\n  - 如果 $u=v=w$，$S(u,v,w)=\\alpha$；\n  - 如果 $u,v,w$ 中恰好有两个相等，$S(u,v,w)=\\beta$；\n  - 如果 $u$、$v$ 和 $w$ 全都不同，$S(u,v,w)=\\gamma$。\n- 如果恰好有一个空位，对于字母 $a,b\\in\\mathcal{A}$，\n  - 如果 $a=b$，$S(a,b,-)=S(a,-,b)=S(-,a,b)=\\delta$，\n  - 如果 $a\\neq b$，$S(a,b,-)=S(a,-,b)=S(-,a,b)=\\epsilon$。\n- 如果恰好有两个空位，对于任何 $a\\in\\mathcal{A}$，\n  - $S(a,-,-)=S(-,a,-)=S(-,-,a)=\\zeta$。\n\n使用参数值 $\\alpha=5、\\beta=2、\\gamma=-1、\\delta=1、\\epsilon=-2$ 和 $\\zeta=-3$。在此方案下，计算 $X$、$Y$ 和 $Z$ 的最佳全局三序列比对分数，其中比对分数是其各列上 $S$ 的总和。给出精确的整数值（不要四舍五入）。答案中不要包含单位。", "solution": "用户提交了一个问题，在尝试解决之前必须对其进行验证。\n\n### 步骤 1：提取已知条件\n- **序列**：\n  - $X = (\\text{A}, \\text{G}, \\text{C})$，长度 $n_x=3$。\n  - $Y = (\\text{A}, \\text{C})$，长度 $n_y=2$。\n  - $Z = (\\text{A}, \\text{G})$，长度 $n_z=2$。\n- **字母表**：$\\mathcal{A} = \\{\\text{A}, \\text{C}, \\text{G}, \\text{T}\\}$。\n- **评分函数** $S(u,v,w)$，对于 $(u,v,w) \\in (\\mathcal{A} \\cup \\{-\\})^3$：\n  - **零空位**：如果 $u=v=w$，$S(u,v,w) = \\alpha$；如果恰好有两个相等，$S(u,v,w) = \\beta$；如果全部不同，$S(u,v,w) = \\gamma$。\n  - **一个空位**：如果 $a=b$，$S(a,b,-) = S(a,-,b) = S(-,a,b) = \\delta$；如果 $a \\neq b$，$S(a,b,-) = S(a,-,b) = S(-,a,b) = \\epsilon$。\n  - **两个空位**：$S(a,-,-) = S(-,a,-) = S(-,-,a) = \\zeta$。\n- **参数值**：\n  - $\\alpha = 5$\n  - $\\beta = 2$\n  - $\\gamma = -1$\n  - $\\delta = 1$\n  - $\\epsilon = -2$\n  - $\\zeta = -3$\n- **目标**：计算最佳全局三序列比对分数。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据验证标准评估问题。\n- **科学性**：该问题是标准的多序列比对任务，这是计算生物学和生物信息学中的一个基本概念。评分方案定义明确。此项有效。\n- **适定性**：该问题要求在给定评分函数下求一个最优分数。这是一个经典的优化问题，可以用动态规划解决。存在唯一的最优分数。此项有效。\n- **客观性**：问题陈述使用了精确的定义和数值，没有主观或模棱两可的语言。此项有效。\n- **完整性和一致性**：所有必需的信息（序列、字母表、评分函数、参数）都已提供。没有矛盾之处。此项有效。\n- **可行性**：序列很短，使得该问题可以通过手动计算解决，适合作为练习。此项有效。\n\n### 步骤 3：结论和行动\n该问题具有科学性、适定性和完整性。这是一个有效的问题。开始进行解答。\n\n这个问题要求计算三个序列的全局比对的最佳分数。这是动态规划原理的一个经典应用。我们定义一个 3 维矩阵 $F$，其中 $F(i, j, k)$ 表示序列前缀 $X[1..i]$、$Y[1..j]$ 和 $Z[1..k]$ 比对的最大分数。序列分别为 $X=(\\text{A}, \\text{G}, \\text{C})$（长度 $n_x=3$）、$Y=(\\text{A}, \\text{C})$（长度 $n_y=2$）和 $Z=(\\text{A}, \\text{G})$（长度 $n_z=2$）。我们的目标是计算 $F(3, 2, 2)$。\n\n评分参数为 $\\alpha=5$，$\\beta=2$，$\\gamma=-1$，$\\delta=1$，$\\epsilon=-2$ 和 $\\zeta=-3$。\n\n$F(i, j, k)$ 的值由 7 种可能的先前状态中的最大值确定，这对应于 7 种非空的比对列类型：\n$$\nF(i, j, k) = \\max \\begin{cases}\nF(i-1, j-1, k-1) + S(x_i, y_j, z_k)  \\text{(比对 } x_i, y_j, z_k \\text{)} \\\\\nF(i-1, j-1, k) + S(x_i, y_j, -)  \\text{(比对 } x_i, y_j \\text{ 和空位)} \\\\\nF(i-1, j, k-1) + S(x_i, -, z_k)  \\text{(比对 } x_i, z_k \\text{ 和空位)} \\\\\nF(i, j-1, k-1) + S(-, y_j, z_k)  \\text{(比对 } y_j, z_k \\text{ 和空位)} \\\\\nF(i-1, j, k) + S(x_i, -, -)  \\text{(比对 } x_i \\text{ 和两个空位)} \\\\\nF(i, j-1, k) + S(-, y_j, -)  \\text{(比对 } y_j \\text{ 和两个空位)} \\\\\nF(i, j, k-1) + S(-, -, z_k)  \\text{(比对 } z_k \\text{ 和两个空位)}\n\\end{cases}\n$$\n\n**初始化**：\n与空序列比对的分数为 $0$，所以 $F(0, 0, 0) = 0$。将一个序列的前缀与两个空序列比对只涉及引入空位。\n$F(i, 0, 0) = i \\times \\zeta$ 对于 $i \\in \\{1, 2, 3\\}$。\n$F(0, j, 0) = j \\times \\zeta$ 对于 $j \\in \\{1, 2\\}$。\n$F(0, 0, k) = k \\times \\zeta$ 对于 $k \\in \\{1, 2\\}$。\n\n将两个序列的前缀与一个空序列比对是一个标准的双序列比对问题，其中一个空位对应于分数 $\\zeta$，而匹配/错配对应于 $S(a,b,-)$。\n$F(i, j, 0) = \\max(F(i-1, j, 0) + \\zeta, F(i, j-1, 0) + \\zeta, F(i-1, j-1, 0) + S(x_i, y_j, -))$。\n$F(i, 0, k)$ 和 $F(0, j, k)$ 也有类似的关系。\n\n我们填充 $4 \\times 3 \\times 3$ 的动态规划表 $F(i,j,k)$，其中 $i \\in [0,3], j \\in [0,2], k \\in [0,2]$。\n\n**平面 $k=0$**：\n$F(0,0,0) = 0$\n$F(1,0,0)=-3$, $F(2,0,0)=-6$, $F(3,0,0)=-9$\n$F(0,1,0)=-3$, $F(0,2,0)=-6$\n$F(1,1,0) = \\max(F(0,0,0)+S(\\text{A},\\text{A},-), F(1,0,0)+\\zeta, F(0,1,0)+\\zeta) = \\max(0+\\delta, -3-3, -3-3) = 1$\n$F(1,2,0) = \\max(F(0,1,0)+S(\\text{A},\\text{C},-), F(1,1,0)+\\zeta, F(0,2,0)+\\zeta) = \\max(-3+\\epsilon, 1-3, -6-3) = -2$\n$F(2,1,0) = \\max(F(1,0,0)+S(\\text{G},\\text{A},-), F(2,0,0)+\\zeta, F(1,1,0)+\\zeta) = \\max(-3+\\epsilon, -6-3, 1-3) = -2$\n$F(2,2,0) = \\max(F(1,1,0)+S(\\text{G},\\text{C},-), F(2,1,0)+\\zeta, F(1,2,0)+\\zeta) = \\max(1+\\epsilon, -2-3, -2-3) = -1$\n$F(3,1,0) = \\max(F(2,0,0)+S(\\text{C},\\text{A},-), F(3,0,0)+\\zeta, F(2,1,0)+\\zeta) = \\max(-6+\\epsilon, -9-3, -2-3) = -5$\n$F(3,2,0) = \\max(F(2,1,0)+S(\\text{C},\\text{C},-), F(3,1,0)+\\zeta, F(2,2,0)+\\zeta) = \\max(-2+\\delta, -5-3, -1-3) = -1$\n\n**平面 $k=1$**：\n$F(0,0,1)=-3$, $F(0,1,1)=1$, $F(0,2,1)=-2$\n$F(1,0,1)=1$, $F(2,0,1)=-2$, $F(3,0,1)=-5$\n$F(1,1,1) = \\max(F(0,0,0)+S(\\text{A},\\text{A},\\text{A}), \\dots) = \\max(0+\\alpha, F(0,0,1)+S(\\text{A},\\text{A},-), \\dots) = \\max(5, -3+\\delta, \\dots) = 5$\n$F(1,2,1) = \\max(F(0,1,0)+S(\\text{A},\\text{C},\\text{A}), \\dots, F(1,1,1)+S(-,\\text{C},-), \\dots) = \\max(-3+\\beta, \\dots, 5+\\zeta, \\dots) = \\max(-1, 2) = 2$\n$F(2,1,1) = \\max(F(1,0,0)+S(\\text{G},\\text{A},\\text{A}), \\dots, F(1,1,1)+S(\\text{G},-,-), \\dots) = \\max(-3+\\beta, \\dots, 5+\\zeta, \\dots) = \\max(-1, 2) = 2$\n$F(2,2,1) = \\max(F(1,1,0)+S(\\text{G},\\text{C},\\text{A}), \\dots, F(1,1,1)+S(\\text{G},\\text{C},-), \\dots) = \\max(1+\\gamma, \\dots, 5+\\epsilon, \\dots) = \\max(0, 3) = 3$\n$F(3,1,1) = \\max(F(2,0,0)+S(\\text{C},\\text{A},\\text{A}), \\dots, F(2,1,1)+S(\\text{C},-,-), \\dots) = \\max(-6+\\beta, \\dots, 2+\\zeta, \\dots) = \\max(-4, -1) = -1$\n$F(3,2,1) = \\max(F(2,1,0)+S(\\text{C},\\text{C},\\text{A}), \\dots, F(2,1,1)+S(\\text{C},\\text{C},-), \\dots) = \\max(-2+\\beta, \\dots, 2+\\delta, \\dots) = \\max(0, 3) = 3$\n\n**平面 $k=2$**：\n$F(0,0,2)=-6$, $F(0,1,2)=-2$, $F(0,2,2)=-1$\n$F(1,0,2)=-2$, $F(2,0,2)=2$, $F(3,0,2)=-1$\n$F(1,1,2) = \\max(F(0,0,1)+S(\\text{A},\\text{A},\\text{G}), \\dots, F(1,1,1)+S(-,-,\\text{G}), \\dots) = \\max(-3+\\beta, \\dots, 5+\\zeta, \\dots) = \\max(-1, 2) = 2$\n$F(1,2,2) = \\max(F(0,1,1)+S(\\text{A},\\text{C},\\text{G}), \\dots, F(1,1,1)+S(-,\\text{C},\\text{G}), \\dots) = \\max(1+\\gamma, \\dots, 5+\\epsilon, \\dots) = \\max(0, 3) = 3$\n$F(2,1,2) = \\max(F(1,0,1)+S(\\text{G},\\text{A},\\text{G}), \\dots, F(1,1,1)+S(\\text{G},-, \\text{G}), \\dots) = \\max(1+\\beta, \\dots, 5+\\delta, \\dots) = \\max(3, 6) = 6$\n$F(2,2,2) = \\max(F(1,1,1)+S(\\text{G},\\text{C},\\text{G}), \\dots) = \\max(5+\\beta, \\dots) = \\max(7, \\dots) = 7$\n$F(3,1,2) = \\max(\\dots, F(2,0,2)+S(\\text{C},\\text{A},-), \\dots, F(2,1,2)+S(\\text{C},-,-), \\dots) = \\max(\\dots, 2+\\epsilon, \\dots, 6+\\zeta, \\dots) = \\max(\\dots, 0, \\dots, 3, \\dots) = 3$\n\n最后，我们计算 $F(3,2,2)$，即完整序列的最佳分数：\n$$\nF(3,2,2) = \\max \\begin{cases}\nF(2,1,1) + S(x_3, y_2, z_2) = F(2,1,1) + S(\\text{C},\\text{C},\\text{G}) = 2 + \\beta = 2+2=4 \\\\\nF(2,1,2) + S(x_3, y_2, -) = F(2,1,2) + S(\\text{C},\\text{C},-) = 6 + \\delta = 6+1=7 \\\\\nF(2,2,1) + S(x_3, -, z_2) = F(2,2,1) + S(\\text{C},-,\\text{G}) = 3 + \\epsilon = 3-2=1 \\\\\nF(3,1,1) + S(-, y_2, z_2) = F(3,1,1) + S(-,\\text{C},\\text{G}) = -1+\\epsilon = -1-2=-3 \\\\\nF(2,2,2) + S(x_3, -, -) = F(2,2,2) + S(\\text{C},-,-) = 7 + \\zeta = 7-3=4 \\\\\nF(3,1,2) + S(-, y_2, -) = F(3,1,2) + S(-,\\text{C},-) = 3+\\zeta = 3-3=0 \\\\\nF(3,2,1) + S(-, -, z_2) = F(3,2,1) + S(-,-,\\text{G}) = 3+\\zeta = 3-3=0\n\\end{cases}\n$$\n这些值的最大值是 $7$。\n最佳比对分数为 $F(3,2,2)=7$。这个最佳分数是通过路径 $F(0,0,0) \\to F(1,1,1) \\to F(2,1,2) \\to F(3,2,2)$ 实现的，这对应于比对：\n$$\n\\begin{pmatrix} \\text{A} & \\text{G} & \\text{C} \\\\ \\text{A} & - & \\text{C} \\\\ \\text{A} & \\text{G} & - \\end{pmatrix}\n$$\n这个比对的分数是 $S(\\text{A},\\text{A},\\text{A}) + S(\\text{G},-, \\text{G}) + S(\\text{C},\\text{C},-) = \\alpha + \\delta + \\delta = 5 + 1 + 1 = 7$，证实了结果。", "answer": "$$\\boxed{7}$$", "id": "2387093"}]}