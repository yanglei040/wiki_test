{"hands_on_practices": [{"introduction": "预测DNA双螺旋的稳定性是分子生物学和生物技术中的一项核心任务。本练习将引导你通过一个简化的双态热力学模型，来模拟DNA发夹结构的热解链过程 [@problem_id:2386777]。你将亲手实现计算解链温度 ($T_m$) 的代码，并探索一个常见的G-T摆动错配对如何影响结构的稳定性，从而直观地理解DNA热力学的基础原理。", "problem": "您的任务是使用两态热力学模型，构建一个脱氧核糖核酸（DNA）发夹结构热变性（熔解）的独立模拟，并量化茎区中单个鸟嘌呤-胸腺嘧啶（G-T）摆动碱基对对熔解温度的影响。在此模型中，一个具有长度为 $n$ 个碱基对的茎区和长度为 $L$ 的环区的发夹结构，在完全折叠态和完全解折叠态之间切换。折叠态通过茎区内的碱基配对和堆积作用而稳定，并通过环闭合熵而不稳定。解折叠态被视为参考态，其焓和熵均为零。\n\n假设在绝对温度 $T$ 下，折叠的总吉布斯自由能由 $\\Delta G(T) = \\Delta H_{\\mathrm{tot}} - T \\Delta S_{\\mathrm{tot}}$ 给出，其中 $\\Delta H_{\\mathrm{tot}}$ 和 $\\Delta S_{\\mathrm{tot}}$ 是来自碱基对、碱基对堆积和环熵贡献的与温度无关的总和。在温度 $T$ 下的折叠分数由两态玻尔兹曼平衡定义为 $f_{\\mathrm{fold}}(T) = \\dfrac{1}{1+\\exp\\left(\\dfrac{\\Delta G(T)}{R T}\\right)}$，其中 $R$ 是普适气体常数。熔解温度 $T_m$ 被定义为使得 $f_{\\mathrm{fold}}(T_m)=\\dfrac{1}{2}$ 的唯一温度（以开尔文为单位）。\n\n对于折叠态的茎区和环区，使用以下粗粒化、有物理基础的参数化方案，所有焓的单位为 $\\mathrm{cal\\cdot mol^{-1}}$，熵的单位为 $\\mathrm{cal\\cdot mol^{-1}\\cdot K^{-1}}$：\n- 普适气体常数：$R = 1.987\\ \\mathrm{cal\\cdot mol^{-1}\\cdot K^{-1}}$。\n- 茎区中每个碱基对的贡献：\n  - 沃森-克里克 G-C 对：$\\Delta h_{\\mathrm{GC}} = -9800$，$\\Delta s_{\\mathrm{GC}} = -24.4$。\n  - 沃森-克里克 A-T 对：$\\Delta h_{\\mathrm{AT}} = -7200$，$\\Delta s_{\\mathrm{AT}} = -20.4$。\n  - G-T 摆动对：$\\Delta h_{\\mathrm{GT}} = -4000$，$\\Delta s_{\\mathrm{GT}} = -12.0$。\n- 茎区内每个相邻堆积对的贡献（协同性），适用于 $n$ 个碱基对茎区中的每一个 $n-1$ 相邻位置：\n  - $\\Delta h_{\\mathrm{stack}} = -800$，$\\Delta s_{\\mathrm{stack}} = -2.0$。\n- 环长度为 $L$（单位为核苷酸）的环熵罚分，使用聚合物环闭合形式建模，其焓为零，熵贡献为 $\\Delta s_{\\mathrm{loop}}(L) = R \\ln\\!\\big(A L^{-c}\\big)$，其中 $A = 1.0$ 且 $c = 1.8$。因此，总的环贡献为 $\\Delta h_{\\mathrm{loop}}(L) = 0$ 和 $\\Delta s_{\\mathrm{loop}}(L) = - c R \\ln L$。\n\n给定一个发夹结构，其茎区中三种碱基对类型的数量分别为 $n_{\\mathrm{GC}}$、$n_{\\mathrm{AT}}$ 和 $n_{\\mathrm{GT}}$（因此 $n = n_{\\mathrm{GC}} + n_{\\mathrm{AT}} + n_{\\mathrm{GT}}$），其在折叠态的总焓和总熵为：\n$$\n\\Delta H_{\\mathrm{tot}} = n_{\\mathrm{GC}}\\,\\Delta h_{\\mathrm{GC}} + n_{\\mathrm{AT}}\\,\\Delta h_{\\mathrm{AT}} + n_{\\mathrm{GT}}\\,\\Delta h_{\\mathrm{GT}} + (n-1)\\,\\Delta h_{\\mathrm{stack}},\n$$\n$$\n\\Delta S_{\\mathrm{tot}} = n_{\\mathrm{GC}}\\,\\Delta s_{\\mathrm{GC}} + n_{\\mathrm{AT}}\\,\\Delta s_{\\mathrm{AT}} + n_{\\mathrm{GT}}\\,\\Delta s_{\\mathrm{GT}} + (n-1)\\,\\Delta s_{\\mathrm{stack}} + \\Delta s_{\\mathrm{loop}}(L).\n$$\n根据两态模型，$T_m$ 满足 $\\Delta G(T_m)=0$。\n\n测试套件和要求输出：\n对于以下三种情况中的每一种，考虑两种变体：一种是没有 G-T 摆动的天然变体（$n_{\\mathrm{GT}}=0$），另一种是其中一个指定类型的沃森-克里克对被单个 G-T 摆动对替换的摆动变体（将该沃森-克里克对的数量减 1 并设置 $n_{\\mathrm{GT}}=1$）。对于每种情况，计算熔解温度的变化量 $\\Delta T_m = T_m^{\\mathrm{wobble}} - T_m^{\\mathrm{native}}$（以开尔文为单位）。\n\n- 情况 1（理想路径）：$n_{\\mathrm{GC}}=6$，$n_{\\mathrm{AT}}=0$，$L=4$，摆动对替换一个 G-C 对。\n- 情况 2（混合内容）：$n_{\\mathrm{GC}}=3$，$n_{\\mathrm{AT}}=3$，$L=8$，摆动对替换一个 A-T 对。\n- 情况 3（边界，最小茎区）：$n_{\\mathrm{GC}}=1$，$n_{\\mathrm{AT}}=0$，$L=3$，摆动对替换一个 G-C 对。\n\n角度单位不适用。所有温度必须以开尔文表示，并且每个最终数值结果必须是浮点数。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，按三种情况的顺序排列结果，每个 $\\Delta T_m$ 值均以开尔文为单位并四舍五入到三位小数。例如，输出行的格式为 $[\\Delta T_{m,1},\\Delta T_{m,2},\\Delta T_{m,3}]$。", "solution": "问题陈述已经过严格验证，被认为是有效的。它在科学上基于生物物理化学的原理，特别是核酸热力学的两态最近邻模型。该问题是适定的，提供了确定熔解温度 $T_m$ 唯一解所需的所有参数、常数和方程。所提供的参数对于粗粒化模型而言在物理上是合理的。总焓和总熵的公式是自洽的。关于环熵公式 $\\Delta s_{\\mathrm{loop}}(L) = - c R \\ln L$（从 $\\Delta s_{\\mathrm{loop}}(L) = R \\ln(A L^{-c})$ 在 $A = 1.0$ 时推导得出）的澄清是正确的。我们注意到了“角度单位不适用”这一无关陈述，但它不影响问题的完整性或可解性。由于问题是有效的，现提供一个完整的、推理严谨的解决方案。\n\n目标是计算当一个沃森-克里克碱基对被一个 G-T 摆动对替换时，DNA 发夹结构的熔解温度变化量 $\\Delta T_m = T_m^{\\mathrm{wobble}} - T_m^{\\mathrm{native}}$。该解决方案基于所提供的两态热力学模型。\n\n熔解温度 $T_m$ 被定义为发夹结构一半折叠时的温度，即 $f_{\\mathrm{fold}}(T_m) = 1/2$。根据给定的折叠分数模型，\n$$f_{\\mathrm{fold}}(T) = \\dfrac{1}{1+\\exp\\left(\\dfrac{\\Delta G(T)}{R T}\\right)}$$\n条件 $f_{\\mathrm{fold}}(T_m) = 1/2$ 意味着指数项必须等于 $1$。这只有在指数为零时才可能，从而得出熔解温度的基本条件：\n$$\\Delta G(T_m) = 0$$\n折叠的吉布斯自由能由 $\\Delta G(T) = \\Delta H_{\\mathrm{tot}} - T \\Delta S_{\\mathrm{tot}}$ 给出。将此代入 $T_m$ 的条件，得到：\n$$\\Delta H_{\\mathrm{tot}} - T_m \\Delta S_{\\mathrm{tot}} = 0$$\n求解 $T_m$，我们得到计算的核心方程，它将熔解温度（以开尔文为单位）表示为折叠过程的总焓变与总熵变之比：\n$$T_m = \\frac{\\Delta H_{\\mathrm{tot}}}{\\Delta S_{\\mathrm{tot}}}$$\n该方程在 $\\Delta S_{\\mathrm{tot}} \\neq 0$ 的条件下有效，对于任何物理上的发夹结构，该条件都成立，因为所有给定的熵贡献都是非零负值，确保了总和不为零。\n\n要计算任何给定发夹结构的 $T_m$，我们必须首先计算其总折叠焓 $\\Delta H_{\\mathrm{tot}}$ 和总折叠熵 $\\Delta S_{\\mathrm{tot}}$。这些量是通过对茎区中所有组分碱基对、它们之间的堆积相互作用以及环闭合的熵代价的贡献求和来确定的。所提供的公式为：\n$$\n\\Delta H_{\\mathrm{tot}} = n_{\\mathrm{GC}}\\,\\Delta h_{\\mathrm{GC}} + n_{\\mathrm{AT}}\\,\\Delta h_{\\mathrm{AT}} + n_{\\mathrm{GT}}\\,\\Delta h_{\\mathrm{GT}} + (n-1)\\,\\Delta h_{\\mathrm{stack}}\n$$\n$$\n\\Delta S_{\\mathrm{tot}} = n_{\\mathrm{GC}}\\,\\Delta s_{\\mathrm{GC}} + n_{\\mathrm{AT}}\\,\\Delta s_{\\mathrm{AT}} + n_{\\mathrm{GT}}\\,\\Delta s_{\\mathrm{GT}} + (n-1)\\,\\Delta s_{\\mathrm{stack}} + \\Delta s_{\\mathrm{loop}}(L)\n$$\n其中 $n = n_{\\mathrm{GC}} + n_{\\mathrm{AT}} + n_{\\mathrm{GT}}$ 是茎区中的总碱基对数。项 $(n-1)$ 正确地说明了长度为 $n$ 的茎区中的 $n-1$ 个相邻堆积相互作用。对于只有一个碱基对的茎区（$n=1$），该项自然变为零，这在物理上是正确的，因为没有堆积相互作用。\n\n环闭合熵 $\\Delta s_{\\mathrm{loop}}(L)$ 由以下公式给出：\n$$\n\\Delta s_{\\mathrm{loop}}(L) = -c R \\ln L\n$$\n其中模型参数 $c = 1.8$，普适气体常数 $R = 1.987\\ \\mathrm{cal\\cdot mol^{-1}\\cdot K^{-1}}$，$L$ 是环的长度（单位为核苷酸）。\n\n算法步骤如下：\n$1$. 实现一个计算函数，根据推导出的公式 $T_m = \\Delta H_{\\mathrm{tot}} / \\Delta S_{\\mathrm{tot}}$ 计算 $T_m$。该函数接受 GC、AT 和 GT 对的数量（$n_{\\mathrm{GC}}$、$n_{\\mathrm{AT}}$、$n_{\\mathrm{GT}}$）以及环长度（$L$）作为输入。\n$2$. 在此函数内部，使用给定参数（$\\Delta h_{\\mathrm{GC}} = -9800$、$\\Delta s_{\\mathrm{GC}} = -24.4$、$\\Delta h_{\\mathrm{AT}} = -7200$、$\\Delta s_{\\mathrm{AT}} = -20.4$、$\\Delta h_{\\mathrm{GT}} = -4000$、$\\Delta s_{\\mathrm{GT}} = -12.0$、$\\Delta h_{\\mathrm{stack}} = -800$ 和 $\\Delta s_{\\mathrm{stack}} = -2.0$）通过对指定的热力学贡献求和来计算 $\\Delta H_{\\mathrm{tot}}$ 和 $\\Delta S_{\\mathrm{tot}}$。\n$3$. 然后，程序遍历指定的三个测试用例。对于每个用例，它定义“天然”发夹结构及其“摆动”对应物的参数。\n$4$. 对于每个用例，调用 $T_m$ 计算函数两次：一次用于天然变体（$T_m^{\\mathrm{native}}$），一次用于摆动变体（$T_m^{\\mathrm{wobble}}$）。\n$5$. 计算熔解温度的变化量 $\\Delta T_m = T_m^{\\mathrm{wobble}} - T_m^{\\mathrm{native}}$。\n$6$. 将三个用例的结果收集起来，按要求四舍五入到三位小数，并格式化为单个输出字符串。\n\n引入 G-T 摆动对会使发夹茎区不稳定，因为 G-T 摆动对在热力学上比 G-C 或 A-T 沃森-克里克对更不稳定（即其 $\\Delta h$ 和 $\\Delta s$ 值的负值更小）。这种不稳定性将降低熔解温度，因此我们预计在所有情况下 $\\Delta T_m$ 都将为负。这种效应的大小将取决于被替换的原始碱基对的稳定性以及发夹结构的整体稳定性。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the DNA hairpin melting problem by calculating the change in melting\n    temperature upon introduction of a G-T wobble pair for three test cases.\n    \"\"\"\n\n    # --- Thermodynamic Parameters ---\n    # Universal gas constant (cal/mol/K)\n    R = 1.987\n    \n    # Per base-pair contributions (enthalpy in cal/mol, entropy in cal/mol/K)\n    # Guanine-Cytosine pair\n    DH_GC = -9800.0\n    DS_GC = -24.4\n    # Adenine-Thymine pair\n    DH_AT = -7200.0\n    DS_AT = -20.4\n    # Guanine-Thymine wobble pair\n    DH_GT = -4000.0\n    DS_GT = -12.0\n    \n    # Per adjacent stacked-pair contribution\n    DH_STACK = -800.0\n    DS_STACK = -2.0\n    \n    # Loop entropy model parameter\n    C_LOOP = 1.8\n\n    def calculate_tm(n_gc, n_at, n_gt, loop_len):\n        \"\"\"\n        Calculates the melting temperature (Tm) for a DNA hairpin.\n\n        Args:\n            n_gc (int): Number of GC pairs.\n            n_at (int): Number of AT pairs.\n            n_gt (int): Number of GT pairs.\n            loop_len (int): Length of the loop in nucleotides.\n\n        Returns:\n            float: The melting temperature in Kelvin.\n        \"\"\"\n        # Total number of base pairs in the stem\n        n = n_gc + n_at + n_gt\n\n        if n == 0:\n            # A stem of zero length has no defined melting transition\n            return np.nan\n\n        # Calculate total enthalpy of folding\n        delta_h_tot = (n_gc * DH_GC + n_at * DH_AT + n_gt * DH_GT)\n        # Stacking contribution exists only for stems with 2 or more pairs\n        if n > 1:\n            delta_h_tot += (n - 1) * DH_STACK\n\n        # Calculate total entropy of folding\n        # Loop entropy penalty (destabilizing)\n        delta_s_loop = -C_LOOP * R * np.log(loop_len)\n        \n        delta_s_tot = (n_gc * DS_GC + n_at * DS_AT + n_gt * DS_GT + delta_s_loop)\n        # Stacking contribution\n        if n > 1:\n            delta_s_tot += (n - 1) * DS_STACK\n            \n        # If entropy change is zero, Tm is not well-defined in this model\n        if delta_s_tot == 0:\n            return np.nan\n\n        # Melting temperature is the ratio of enthalpy to entropy\n        tm = delta_h_tot / delta_s_tot\n        return tm\n\n    # Define the test cases from the problem statement\n    test_cases = [\n        # Case 1: nGC=6, nAT=0, L=4. A GC pair is replaced by a GT wobble.\n        {\n            \"native\": {\"n_gc\": 6, \"n_at\": 0, \"n_gt\": 0, \"loop_len\": 4},\n            \"wobble\": {\"n_gc\": 5, \"n_at\": 0, \"n_gt\": 1, \"loop_len\": 4}\n        },\n        # Case 2: nGC=3, nAT=3, L=8. An AT pair is replaced by a GT wobble.\n        {\n            \"native\": {\"n_gc\": 3, \"n_at\": 3, \"n_gt\": 0, \"loop_len\": 8},\n            \"wobble\": {\"n_gc\": 3, \"n_at\": 2, \"n_gt\": 1, \"loop_len\": 8}\n        },\n        # Case 3: nGC=1, nAT=0, L=3. A GC pair is replaced by a GT wobble.\n        {\n            \"native\": {\"n_gc\": 1, \"n_at\": 0, \"n_gt\": 0, \"loop_len\": 3},\n            \"wobble\": {\"n_gc\": 0, \"n_at\": 0, \"n_gt\": 1, \"loop_len\": 3}\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        # Calculate Tm for both the native and wobble-containing variants\n        tm_native = calculate_tm(**case[\"native\"])\n        tm_wobble = calculate_tm(**case[\"wobble\"])\n\n        # Calculate the change in melting temperature\n        delta_tm = tm_wobble - tm_native\n        \n        # Format the result to three decimal places\n        results.append(f\"{delta_tm:.3f}\")\n\n    # Print the final output in the exact required format\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```", "id": "2386777"}, {"introduction": "在掌握了基本的热力学模型后，我们将更深入地探究序列缺陷对DNA物理特性的影响。本练习将关注脱碱基位点——一种常见的DNA损伤——并使用更精细的近邻模型来量化其对解链温度的影响 [@problem_id:2386781]。更重要的是，这个练习引入了一个新的维度：通过一个简化的弹簧模型，你将计算并比较正常与受损DNA在局部柔性上的差异，揭示序列信息是如何同时编码热力学稳定性和力学性质的。", "problem": "编写一个完整、可运行的程序，在一个基于物理的简化框架下，模拟单个脱碱基位点对脱氧核糖核酸（DNA）双螺旋的局部柔性和熔解温度的影响。对于每个测试用例，程序必须计算两个量：完整双链和带有一个脱碱基位点的双链的熔解温度（单位为摄氏度），以及在指定参考温度下，脱碱基位点处弯曲涨落的局部角度方差（单位为弧度平方），包括完整和脱碱基两种情况。所有数值输入和输出必须使用指定的单位处理。您的程序必须生成单行输出，其中包含所有测试用例的结果，格式为方括号括起来的逗号分隔列表，每个测试用例贡献一个如下文所述顺序的列表。\n\n数学和物理设置：\n- 使用双态近似模拟双链的热力学。设标准吉布斯自由能变化写为 $\\Delta G(T) = \\Delta H - T \\,\\Delta S$，其中 $\\Delta H$ 是双链形成的标准焓变，$\\Delta S$ 是标准熵变。对于总链浓度为 $C_t$（单位为 $\\mathrm{M}$）的非自互补双链，在熔解温度 $T_m$ 时，化学平衡意味着 $K(T) = \\dfrac{1}{C_t/4}$，其中平衡常数 $K(T) = \\exp\\!\\left(-\\dfrac{\\Delta G(T)}{R T}\\right)$，$R$ 是普适气体常数。\n- 使用最近邻（NN）可加性假说：对于长度为 $N$ 个碱基对的双链，写出 $\\Delta H = \\sum_{i=1}^{N-1} \\Delta H_i$ 和 $\\Delta S = \\sum_{i=1}^{N-1} \\Delta S_i + \\Delta S_{\\text{salt}}$，其中每个碱基对堆积 $i$ 根据一条链上的 $5^\\prime\\!\\to\\!3^\\prime$ 二核苷酸贡献 $(\\Delta H_i,\\Delta S_i)$，单价盐校正为 $\\Delta S_{\\text{salt}} = 0.368\\,(N-1)\\,\\ln([\\mathrm{Na}^+])$，其中 $[\\mathrm{Na}^+]$ 单位为 $\\mathrm{M}$，$\\ln$ 为自然对数。忽略任何起始或末端校正。假设所有测试序列都是非自互补的。\n- NN参数 $(\\Delta H_i,\\Delta S_i)$ 必须从以下规范集合中获取（单位：$\\Delta H$ 为 $\\mathrm{kcal}\\,\\mathrm{mol}^{-1}$，$\\Delta S$ 为 $\\mathrm{cal}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$），以所考虑链上的 $5^\\prime\\!\\to\\!3^\\prime$ 二核苷酸为键。使用反向互补等效性将任何未明确列出的二核苷酸映射到相应的规范条目：\n  - $AA: (\\,-7.9,\\,-22.2\\,)$, $AT: (\\,-7.2,\\,-20.4\\,)$, $TA: (\\,-7.2,\\,-21.3\\,)$, $CA: (\\,-8.5,\\,-22.7\\,)$, $GT: (\\,-8.4,\\,-22.4\\,)$, $CT: (\\,-7.8,\\,-21.0\\,)$, $GA: (\\,-8.2,\\,-22.2\\,)$, $CG: (\\,-10.6,\\,-27.2\\,)$, $GC: (\\,-9.8,\\,-24.4\\,)$, $GG: (\\,-8.0,\\,-19.9\\,)$。\n  - 对于列表中没有的任何二核苷酸 $XY$，使用其反向互补序列 $\\mathrm{rc}(XY)$ 的条目，其中互补定义为 $A\\leftrightarrow T$，$C\\leftrightarrow G$，而 $\\mathrm{rc}(XY)$ 是反向字符串的互补序列。\n- 脱碱基位点热力学：设在碱基对索引为 $j$（沿双链的基于1的索引）处有一个脱碱基位点。通过仅修改与 $j$ 相邻的两个最近邻堆积（即堆积 $j-1$ 和 $j$，如果它们在 $1,\\dots,N-1$ 范围内存在）来模拟其效应。对于每个受影响的堆积，将焓贡献乘以一个因子 $\\beta$，并将熵贡献移动一个偏移量 $\\delta$，其中\n  - $\\beta = 0.5$（无量纲）且 $\\delta = +5.0\\,\\mathrm{cal}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$。\n  与脱碱基位点不相邻的堆积不作修改。\n- 熔解温度计算：使用 $R = 1.98720425864083\\,\\mathrm{cal}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$。将最终熔解温度 $T_m$ 以摄氏度表示。明确指定用于任何角度量的角度单位。\n- 局部柔性模型：用谐波角刚度 $k$（弹簧常数）（单位为 $\\mathrm{pN}\\cdot\\mathrm{nm}\\cdot\\mathrm{rad}^{-2}$）表示碱基对堆积附近的弯曲性。为正常堆积分配 $k_0 = 150.0\\,\\mathrm{pN}\\cdot\\mathrm{nm}\\cdot\\mathrm{rad}^{-2}$，为与脱碱基位点相邻的堆积分配 $k_{\\text{ab}} = 30.0\\,\\mathrm{pN}\\cdot\\mathrm{nm}\\cdot\\mathrm{rad}^{-2}$。将脱碱基位置的有效局部刚度定义为一个或两个相邻堆积上的串联弹簧：\n  $$\\frac{1}{k_{\\mathrm{eff}}} = \\sum_{\\ell} \\frac{1}{k_{\\ell}},$$\n  其中求和遍历堆积 $j-1$ 和 $j$（如果两者都存在）；如果脱碱基位点在末端（因此只有一个相邻堆积存在），则 $k_{\\mathrm{eff}}$ 等于该单个堆积的刚度。使用针对单个二次角度自由度的能量均分定理，角度方差为\n  $$\\sigma^2 = \\frac{k_{\\mathrm{B}}\\,T_{\\mathrm{ref}}}{k_{\\mathrm{eff}}},$$\n  其中玻尔兹曼常数 $k_{\\mathrm{B}} = 0.01380649\\,\\mathrm{pN}\\cdot\\mathrm{nm}\\cdot\\mathrm{K}^{-1}$，参考温度 $T_{\\mathrm{ref}} = 298.15\\,\\mathrm{K}$。以 $\\mathrm{rad}^2$ 为单位报告 $\\sigma^2$。\n- 单位和数值要求：\n  - 以摄氏度报告 $T_m$，以 $\\mathrm{rad}^2$ 报告 $\\sigma^2$。\n  - 对所有 $\\ln(\\cdot)$ 使用自然对数。\n  - 所有输入浓度 $C_t$ 和 $[\\mathrm{Na}^+]$ 均以 $\\mathrm{M}$ 为单位。\n\n要实现和评估的测试套件：\n- 用例 1：序列 $S = \\mathrm{ATGCGTAC}$，长度 $N=8$，脱碱基位点索引 $j=4$，总链浓度 $C_t = 2\\times 10^{-6}\\,\\mathrm{M}$，单价盐浓度 $[\\mathrm{Na}^+] = 0.05\\,\\mathrm{M}$。\n- 用例 2：序列 $S = \\mathrm{ATATATAT}$，$N=8$，$j=4$，$C_t = 1\\times 10^{-6}\\,\\mathrm{M}$，$[\\mathrm{Na}^+] = 0.01\\,\\mathrm{M}$。\n- 用例 3：序列 $S = \\mathrm{GCGCGCGC}$，$N=8$，$j=1$，$C_t = 5\\times 10^{-6}\\,\\mathrm{M}$，$[\\mathrm{Na}^+] = 1.0\\,\\mathrm{M}$。\n- 用例 4：序列 $S = \\mathrm{ATGC}$，$N=4$，$j=2$，$C_t = 1\\times 10^{-7}\\,\\mathrm{M}$，$[\\mathrm{Na}^+] = 0.05\\,\\mathrm{M}$。\n\n对于每种情况，程序必须按以下顺序生成包含四个实数的列表：\n- 完整双链的 $T_m$（摄氏度），\n- 经过上述脱碱基位点修饰的双链的 $T_m$（摄氏度），\n- 在指定脱碱基位点索引处，完整双链的 $\\sigma^2$（单位为 $\\mathrm{rad}^2$），\n- 在指定脱碱基位点索引处，经过脱碱基修饰的双链的 $\\sigma^2$（单位为 $\\mathrm{rad}^2$）。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含所有结果，格式为方括号括起来的逗号分隔列表，每个元素是对应一个测试用例的四个数字的列表，顺序与测试套件用例的顺序相同。例如：$[ [x_1,x_2,x_3,x_4], [y_1,y_2,y_3,y_4], \\dots ]$。", "solution": "所提出的问题要求计算DNA双链的热力学和力学性质，包括其完整形式和带有单个脱碱基位点缺陷的形式。所提供的框架是一个简化的、但基于物理的模型，在生物物理化学中很常见。在继续之前，我有责任验证问题陈述的科学合理性和逻辑一致性。\n\n问题指定了一套用于DNA稳定性的最近邻参数、一个标准的盐校正和一个用于熔解的双态模型。熔解温度 $T_m$ 的方程源自条件 $K(T_m)=4/C_t$，这对于非自互补双链是正确的。问题随后指示“假设所有测试序列都是非自互补的”。然而，对所提供测试用例的检查显示，用例2（$S = \\mathrm{ATATATAT}$）和用例3（$S = \\mathrm{GCGCGCGC}$）包含自互补序列。对于此类序列，熔解平衡是不同的，导致条件为 $K(T_m)=1/C_t$。\n\n这在明确的假设和所提供的数据之间呈现了一个矛盾。在严谨的科学背景下，人们会对每种序列类型使用正确的公式。然而，在学术问题的范围内，一个明确的“假设”指令必须被解释为应用指定模型的指令，即使它代表了一种简化或在其典型领域之外应用。它为本练习设定了计算规则。因此，我将严格遵守所述假设，按照指示对所有情况应用非自互补公式。因此，该问题被认为是有效的，尽管其表述不完美。所有科学原理和常数在其他方面都是标准的并被正确陈述。\n\n解决方案的结构如下：\n首先，将执行热力学计算，以找到双链形成的总焓变 $\\Delta H$ 和熵变 $\\Delta S$。这使用了最近邻模型，其中每个二核苷酸堆积的参数被加总。从提供的10对和反向互补对称规则构建了所有16个二核苷酸的完整表格。对于脱碱基情况，与脱碱基位点相邻的两个堆积的焓和熵贡献根据给定的参数 $\\beta$ 和 $\\delta$ 进行修改。\n\n熔解温度 $T_m$ 源自熔解点处的化学平衡关系。给定浓度依赖的平衡常数 $K(T) = \\exp(-\\Delta G(T) / (RT))$，以及非自互补链在 $T_m$ 处双链分数为 $1/2$ 的条件，我们有 $K(T_m)=4/C_t$。吉布斯自由能为 $\\Delta G(T) = \\Delta H - T\\Delta S$。\n由此，我们推导出以开尔文为单位的 $T_m$ 的表达式：\n$$ \\ln(K(T_m)) = \\ln\\left(\\frac{4}{C_t}\\right) = -\\frac{\\Delta H - T_m \\Delta S}{R T_m} = -\\frac{\\Delta H}{R T_m} + \\frac{\\Delta S}{R} $$\n解出 $T_m$：\n$$ T_m = \\frac{\\Delta H}{\\Delta S - R \\ln(4/C_t)} $$\n这里，$\\Delta H$ 和 $\\Delta S$ 是双链形成的总焓变和熵变，包括盐效应。注意单位必须一致。给定的 $\\Delta H_i$ 单位是 $\\mathrm{kcal}\\,\\mathrm{mol}^{-1}$，必须通过乘以 $1000$ 转换为 $\\mathrm{cal}\\,\\mathrm{mol}^{-1}$。得到的开尔文温标下的 $T_m$ 通过减去 $273.15$ 转换为摄氏度。此过程对完整和脱碱基修饰的双链均适用。\n\n其次，通过计算缺陷位置的角度方差 $\\sigma^2$ 来模拟局部柔性。双链被视为具有谐波弯曲刚度的链段链。在位置 $j$ 处的有效刚度 $k_{\\mathrm{eff}}$ 通过将相邻的碱基对堆积（$j-1$ 和 $j$）视为串联弹簧来计算。\n$$ \\frac{1}{k_{\\mathrm{eff}}} = \\sum_{\\ell \\in \\{j-1, j\\} \\cap \\{1, \\dots, N-1\\}} \\frac{1}{k_{\\ell}} $$\n对于一个完整的双链，所有堆积的刚度均为 $k_0 = 150.0\\,\\mathrm{pN}\\cdot\\mathrm{nm}\\cdot\\mathrm{rad}^{-2}$。对于一个内部位点（$1  j  N$），这得出 $1/k_{\\mathrm{eff}} = 1/k_0 + 1/k_0 = 2/k_0$，所以 $k_{\\mathrm{eff}} = k_0/2$。对于一个末端位点（$j=1$ 或 $j=N$），$k_{\\mathrm{eff}} = k_0$。\n对于在位置 $j$ 有一个脱碱基位点的双链，相邻堆积的刚度减小为 $k_{\\text{ab}} = 30.0\\,\\mathrm{pN}\\cdot\\mathrm{nm}\\cdot\\mathrm{rad}^{-2}$。同样的串联组合规则适用，对于内部位点导致 $k_{\\mathrm{eff}} = k_{\\text{ab}}/2$，对于末端位点导致 $k_{\\mathrm{eff}} = k_{\\text{ab}}$。\n\n然后使用针对单个二次角度自由度的能量均分定理找到角度方差 $\\sigma^2$：\n$$ \\sigma^2 = \\frac{k_{\\mathrm{B}}\\,T_{\\mathrm{ref}}}{k_{\\mathrm{eff}}} $$\n其中 $k_{\\mathrm{B}} = 0.01380649\\,\\mathrm{pN}\\cdot\\mathrm{nm}\\cdot\\mathrm{K}^{-1}$ 是玻尔兹曼常数，$T_{\\mathrm{ref}} = 298.15\\,\\mathrm{K}$ 是参考温度。对方差的计算使用各自的 $k_{\\mathrm{eff}}$ 值，分别用于完整和脱碱基的情况。\n\n实现将通过应用这两个计算步骤来处理每个测试用例，从而产生四个所需的量：$T_{m,\\text{intact}}$、$T_{m,\\text{abasic}}$、$\\sigma^2_{\\text{intact}}$ 和 $\\sigma^2_{\\text{abasic}}$。", "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the DNA thermodynamics and mechanics problem as specified.\n    \"\"\"\n    # Global constants\n    R_GAS = 1.98720425864083  # cal mol^-1 K^-1\n    KB = 0.01380649          # pN nm K^-1\n    T_REF = 298.15            # K\n    K_0 = 150.0               # pN nm rad^-2\n    K_AB = 30.0               # pN nm rad^-2\n    K_TO_C = -273.15          # Kelvin to Celsius conversion\n\n    # Nearest-neighbor parameters (dH in kcal/mol, dS in cal/mol/K)\n    nn_params_raw = {\n        'AA': (-7.9, -22.2), 'AT': (-7.2, -20.4), 'TA': (-7.2, -21.3),\n        'CA': (-8.5, -22.7), 'GT': (-8.4, -22.4), 'CT': (-7.8, -21.0),\n        'GA': (-8.2, -22.2), 'CG': (-10.6, -27.2), 'GC': (-9.8, -24.4),\n        'GG': (-8.0, -19.9)\n    }\n\n    # Build full 16-dinucleotide parameter set using reverse complement symmetry\n    complements = {'A': 'T', 'T': 'A', 'C': 'G', 'G': 'C'}\n    \n    def reverse_complement(seq):\n        return \"\".join(complements[base] for base in reversed(seq))\n\n    nn_params = {}\n    all_bases = ['A', 'C', 'G', 'T']\n    for b1 in all_bases:\n        for b2 in all_bases:\n            dinucl = b1 + b2\n            if dinucl in nn_params_raw:\n                nn_params[dinucl] = nn_params_raw[dinucl]\n            else:\n                rc_dinucl = reverse_complement(dinucl)\n                nn_params[dinucl] = nn_params_raw[rc_dinucl]\n\n    # Abasic site modification parameters\n    BETA = 0.5   # Enthalpy scaling factor\n    DELTA = 5.0  # Entropy offset in cal/mol/K\n\n    test_cases = [\n        # S, N, j, Ct, Na_conc\n        (\"ATGCGTAC\", 8, 4, 2e-6, 0.05),\n        (\"ATATATAT\", 8, 4, 1e-6, 0.01),\n        (\"GCGCGCGC\", 8, 1, 5e-6, 1.0),\n        (\"ATGC\", 4, 2, 1e-7, 0.05),\n    ]\n\n    results = []\n\n    def calculate_tm(sequence, na_conc, ct, abasic_j=None):\n        \"\"\"Calculates melting temperature.\"\"\"\n        n = len(sequence)\n        \n        dH_total_kcal = 0.0\n        dS_nn_total = 0.0\n        \n        # Sum over nearest-neighbor steps\n        for i in range(n - 1):\n            step_idx = i + 1\n            dinucl = sequence[i:i+2]\n            dH_i_kcal, dS_i = nn_params[dinucl]\n            \n            # Apply abasic modification if applicable\n            if abasic_j is not None:\n                # Abasic site at base 'j' affects steps 'j-1' and 'j'\n                if step_idx == abasic_j - 1 or step_idx == abasic_j:\n                    dH_i_kcal *= BETA\n                    dS_i += DELTA\n            \n            dH_total_kcal += dH_i_kcal\n            dS_nn_total += dS_i\n        \n        # Convert dH to cal/mol\n        dH_total_cal = dH_total_kcal * 1000.0\n        \n        # Salt correction for entropy\n        dS_salt = 0.368 * (n - 1) * np.log(na_conc)\n        dS_total = dS_nn_total + dS_salt\n        \n        # Calculate Tm in Kelvin\n        # Formula: Tm = dH / (dS - R * ln(4/Ct)) for non-self-complementary\n        denominator = dS_total - R_GAS * np.log(4.0 / ct)\n        \n        # Avoid division by zero, though unlikely with physical params\n        if abs(denominator)  1e-9:\n            return float('nan')\n        \n        tm_k = dH_total_cal / denominator\n        \n        # Convert to Celsius\n        tm_c = tm_k + K_TO_C\n        return tm_c\n\n    def calculate_variance(n, j):\n        \"\"\"Calculates local angular variance.\"\"\"\n        k_b_t_ref = KB * T_REF\n\n        # Intact duplex\n        if j == 1 or j == n: # Terminal position\n            k_eff_intact = K_0\n        else: # Internal position\n            k_eff_intact = K_0 / 2.0\n        \n        sigma2_intact = k_b_t_ref / k_eff_intact\n\n        # Abasic duplex\n        if j == 1 or j == n: # Terminal position\n            k_eff_abasic = K_AB\n        else: # Internal position\n            k_eff_abasic = K_AB / 2.0\n        \n        sigma2_abasic = k_b_t_ref / k_eff_abasic\n\n        return sigma2_intact, sigma2_abasic\n\n    for case in test_cases:\n        s, n, j, ct, na_conc = case\n        \n        # Calculate Tm for intact and abasic duplexes\n        tm_intact = calculate_tm(s, na_conc, ct)\n        tm_abasic = calculate_tm(s, na_conc, ct, abasic_j=j)\n        \n        # Calculate variances for intact and abasic duplexes\n        sigma2_intact, sigma2_abasic = calculate_variance(n, j)\n        \n        results.append([tm_intact, tm_abasic, sigma2_intact, sigma2_abasic])\n\n    # Format the final output string as specified\n    output_str = \"[\" + \",\".join([str(res) for res in results]) + \"]\"\n    print(output_str)\n\nsolve()\n```", "id": "2386781"}, {"introduction": "从碱基对的局部相互作用到整个分子的宏观行为，尺度转换是生物物理建模的关键。本练习将DNA抽象为一个弹性棒，这是高分子物理中著名的“蠕虫状链”模型的一个核心思想 [@problem_id:2386739]。你将推导并实现一个算法，用于计算非均质DNA序列的有效弯曲刚度，并最终预测其持续长度 ($L_p$)——一个描述DNA链在溶液中弯曲刚性的关键参数，这对于理解DNA在细胞内的包装和成环至关重要。", "problem": "要求您将脱氧核糖核酸 (DNA) 的序列依赖力学模型与一个物理上可测量的涌现参数——持续长度——联系起来。将 DNA 建模为一根细长的、不可伸长的弹性杆，其中心线的几何形状由连续的弧长坐标 $s$ 和曲率 $\\kappa(s)$ 描述。假设绕主轴的弯曲是各向同性的，并且局部弯曲刚度（也称为弯曲模量）$A(s)$ 会因序列的异质性而随 $s$ 变化。在小偏转情况下，该杆的弹性势能遵循标准弹性杆泛函\n$$\nE[\\kappa] \\;=\\; \\tfrac{1}{2} \\int_{0}^{L} A(s)\\,\\kappa(s)^2\\,ds,\n$$\n其构象的统计力学遵循玻尔兹曼分布，其中 $T$ 为绝对温度，$k_{\\mathrm{B}}$ 为玻尔兹曼常数。蠕虫状链 (WLC) 模型是此类弹性模型的经典连续极限。\n\n任务：\n1) 从上述能量泛函出发，并根据在给定净弯曲角下，平衡曲率场 $\\kappa(s)$ 是通过在总弯曲的几何约束下最小化 $E[\\kappa]$ 得到的原理，推导出一个总轮廓长度为 $L$ 的异质杆的等效均质弯曲模量 $A_{\\mathrm{eff}}$ 的表达式。然后，对于一个由 $N$ 个碱基对步长组成的离散化杆，每个步长的弧长为 $b_i$，局部弯曲模量为 $A_i$，将您的连续表达式转换为一个用 $\\{A_i\\}_{i=1}^{N}$ 和 $\\{b_i\\}_{i=1}^{N}$ 表示的离散公式。\n\n2) 使用热化弹性杆和蠕虫状链模型的平衡统计力学基本结果，用 $A_{\\mathrm{eff}}$、$k_{\\mathrm{B}}$ 和 $T$ 表示持续长度 $L_p$。您必须清楚地陈述证明该关系所依据的最小物理假设。\n\n3) 实现一个程序，给定温度 $T$（单位：开尔文）和 DNA 片段的每步弯曲模量列表 $\\{A_i\\}$（单位：$\\mathrm{pN}\\cdot\\mathrm{nm}^2$），以及均匀的碱基对上升高度 $b$（单位：纳米），使用您推导出的离散 $A_{\\mathrm{eff}}$ 和 $L_p$ 表达式来计算持续长度 $L_p$（单位：纳米）。使用 $k_{\\mathrm{B}} = 1.380649\\times 10^{-23}\\ \\mathrm{J/K}$ 的值，并通过 $1\\ \\mathrm{J} = 10^{21}\\ \\mathrm{pN}\\cdot\\mathrm{nm}$ 将其转换为 $\\mathrm{pN}\\cdot\\mathrm{nm/K}$。\n\n4) 物理和数值单位：输入弯曲模量 $A_i$ 的单位是 $\\mathrm{pN}\\cdot\\mathrm{nm}^2$，碱基对上升高度 $b$ 的单位是 $\\mathrm{nm}$，温度 $T$ 的单位是 $\\mathrm{K}$，您必须输出 $L_p$（单位：$\\mathrm{nm}$）。报告每个数值结果时，四舍五入到 $6$ 位小数。\n\n5) 测试套件：您的程序必须为以下参数集计算 $L_p$。在所有情况下，均采用均匀的每步上升高度 $b = 0.34\\ \\mathrm{nm}$。\n- 情况 1（均质，室温下标准类 DNA 刚度）：$T = 298.15$, $A = [\\,205.7,\\,205.7,\\,205.7,\\,205.7,\\,205.7\\,]$。\n- 情况 2（软硬交替的步长）：$T = 298.15$, $A = [\\,100,\\,300,\\,100,\\,300,\\,100,\\,300\\,]$。\n- 情况 3（非常刚硬）：$T = 298.15$, $A = [\\,1000,\\,1000,\\,1000\\,]$。\n- 情况 4（多个刚硬步长中的一个非常软的步长）：$T = 298.15$, $A = [\\,300,\\,300,\\,300,\\,10,\\,300,\\,300,\\,300,\\,300,\\,300,\\,300\\,]$。\n- 情况 5（生理温度下的温度依赖性）：$T = 310.0$, $A = [\\,205.7,\\,205.7,\\,205.7,\\,205.7\\,]$。\n- 情况 6（单步长边缘情况）：$T = 298.15$, $A = [\\,150\\,]$。\n\n6) 最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，“[result1,result2,result3]”）。每个条目必须是等于 $L_p$（单位：$\\mathrm{nm}$）的浮点数，四舍五入到 $6$ 位小数，并按上面列出的情况顺序排列。\n\n重要约束：\n- 您的推导必须从能量泛函和广义统计力学原理开始，而不是从快捷公式开始。您必须证明任何连续到离散转换的合理性。\n- 如果在推导过程中引入角度，则应将其视为小角度并以弧度为单位。最终的数值输入或输出中不出现角度。\n- 您唯一可以使用的物理常数是 $k_{\\mathrm{B}}$ 以及指定的 $\\mathrm{J}$ 和 $\\mathrm{pN}\\cdot\\mathrm{nm}$ 之间的单位转换。", "solution": "我们从脱氧核糖核酸 (DNA) 的细长弹性杆模型开始，采用小偏转体系和各向同性弯曲。对于具有曲率场 $\\kappa(s)$ 和位置依赖的弯曲模量 $A(s)$ 的空间曲线，其弹性势能为\n$$\nE[\\kappa] \\;=\\; \\frac{1}{2}\\int_{0}^{L} A(s)\\,\\kappa(s)^2\\,ds,\n$$\n其中 $s$ 是弧长，$L$ 是轮廓长度。考虑在末端切线之间施加一个净角度为 $\\Theta$ 的小整体弯曲。其几何约束为\n$$\n\\int_{0}^{L} \\kappa(s)\\,ds \\;=\\; \\Theta,\n$$\n其中 $\\Theta$ 以弧度为单位。在所有满足此约束的容许 $\\kappa(s)$ 中，物理弯曲响应会使 $E[\\kappa]$ 最小化。为此约束引入一个拉格朗日乘数 $\\lambda$ 并最小化\n$$\n\\mathcal{F}[\\kappa] \\;=\\; \\frac{1}{2}\\int_{0}^{L} A(s)\\,\\kappa(s)^2\\,ds \\;-\\; \\lambda\\left(\\int_{0}^{L}\\kappa(s)\\,ds - \\Theta\\right).\n$$\n关于变分 $\\delta \\kappa(s)$ 的平稳性条件得出\n$$\n\\frac{\\delta \\mathcal{F}}{\\delta \\kappa(s)} \\;=\\; A(s)\\,\\kappa(s) \\;-\\; \\lambda \\;=\\; 0 \\quad\\Rightarrow\\quad \\kappa(s) \\;=\\; \\frac{\\lambda}{A(s)}.\n$$\n强制执行该约束可得\n$$\n\\Theta \\;=\\; \\int_{0}^{L}\\kappa(s)\\,ds \\;=\\; \\int_{0}^{L}\\frac{\\lambda}{A(s)}\\,ds \\;=\\; \\lambda \\int_{0}^{L}\\frac{ds}{A(s)} \\;\\Rightarrow\\; \\lambda \\;=\\; \\frac{\\Theta}{\\int_{0}^{L}\\frac{ds}{A(s)}}.\n$$\n将最小化曲率代回能量表达式中可得\n$$\nE_{\\min} \\;=\\; \\frac{1}{2}\\int_{0}^{L}A(s)\\left(\\frac{\\lambda}{A(s)}\\right)^2 ds \n\\;=\\; \\frac{1}{2}\\lambda^2 \\int_{0}^{L}\\frac{ds}{A(s)}\n\\;=\\; \\frac{1}{2}\\frac{\\Theta^2}{\\int_{0}^{L}\\frac{ds}{A(s)}}.\n$$\n对于一个模量为 $A_{\\mathrm{eff}}$ 的等效均质杆，施加相同的弯曲 $\\Theta$ 将消耗的能量为\n$$\nE_{\\mathrm{hom}} \\;=\\; \\frac{1}{2}\\frac{A_{\\mathrm{eff}}}{L}\\,\\Theta^2,\n$$\n因为曲率是均匀的，$\\kappa = \\Theta/L$，从而得到 $E = \\frac{1}{2}\\int_{0}^{L} A_{\\mathrm{eff}}(\\Theta/L)^2 ds = \\frac{1}{2}\\frac{A_{\\mathrm{eff}}}{L}\\Theta^2$。令 $E_{\\min}$ 和 $E_{\\mathrm{hom}}$ 相等可得\n$$\n\\frac{1}{2}\\frac{A_{\\mathrm{eff}}}{L}\\,\\Theta^2 \\;=\\; \\frac{1}{2}\\frac{\\Theta^2}{\\int_{0}^{L}\\frac{ds}{A(s)}} \\quad\\Rightarrow\\quad \\frac{1}{A_{\\mathrm{eff}}} \\;=\\; \\frac{1}{L}\\int_{0}^{L}\\frac{ds}{A(s)}.\n$$\n因此，有效弯曲模量是按弧长加权的局部模量的调和平均值：\n$$\nA_{\\mathrm{eff}} \\;=\\; \\frac{L}{\\displaystyle \\int_{0}^{L}\\frac{ds}{A(s)}}.\n$$\n\n碱基对步长的离散公式。设杆被离散化为 $N$ 个步长，索引为 $i=1,\\dots,N$，其长度为 $b_i$（单位：纳米），模量为 $A_i$（单位：$\\mathrm{pN}\\cdot\\mathrm{nm}^2$）。用黎曼和近似该积分可得\n$$\nL \\;=\\; \\sum_{i=1}^{N} b_i,\\qquad \\int_{0}^{L}\\frac{ds}{A(s)} \\;\\approx\\; \\sum_{i=1}^{N}\\frac{b_i}{A_i},\n$$\n因此\n$$\nA_{\\mathrm{eff}} \\;=\\; \\frac{\\displaystyle \\sum_{i=1}^{N} b_i}{\\displaystyle \\sum_{i=1}^{N}\\frac{b_i}{A_i}}.\n$$\n对于均匀步长 $b_i=b$，该式简化为（非加权）调和平均值：\n$$\nA_{\\mathrm{eff}} \\;=\\; \\frac{N}{\\displaystyle \\sum_{i=1}^{N}\\frac{1}{A_i}}.\n$$\n\n源于统计力学的持续长度。在蠕虫状链 (WLC) 模型中（该模型是弹性杆的热涨落对应物），切向-切向相关函数随弧长呈指数衰减，即 $\\langle \\mathbf{t}(s)\\cdot\\mathbf{t}(0)\\rangle = e^{-s/L_p}$，此式定义了持续长度 $L_p$。一个标准且经过充分检验的关系通过热能将弯曲模量与持续长度联系起来：\n$$\nL_p \\;=\\; \\frac{A}{k_{\\mathrm{B}} T}.\n$$\n这可由能量均分定理和二次弯曲能量密度推导得出：对于小的热涨落，每个二次模态平均贡献 $\\tfrac{1}{2}k_{\\mathrm{B}}T$ 的能量，这导致单位长度的平均曲率方差由 $k_{\\mathrm{B}}T/A$ 决定，而在 WLC 连续极限中，相关长度 $L_p$ 与该方差成反比。对于一个粗粒化为等效均质杆的异质丝状体，我们用 $A_{\\mathrm{eff}}$ 替换 $A$：\n$$\nL_p \\;=\\; \\frac{A_{\\mathrm{eff}}}{k_{\\mathrm{B}} T}.\n$$\n\n单位与换算。给定 $A_i$ 的单位为 $\\mathrm{pN}\\cdot\\mathrm{nm}^2$，$b_i$ 的单位为 $\\mathrm{nm}$，$T$ 的单位为 $\\mathrm{K}$。玻尔兹曼常数 $k_{\\mathrm{B}} = 1.380649\\times 10^{-23}\\ \\mathrm{J/K}$。使用 $1\\ \\mathrm{J} = 10^{21}\\ \\mathrm{pN}\\cdot\\mathrm{nm}$，我们有\n$$\nk_{\\mathrm{B}} \\;=\\; 1.380649\\times 10^{-23}\\ \\mathrm{J/K} \\;=\\; 1.380649\\times 10^{-23}\\times 10^{21}\\ \\mathrm{pN}\\cdot\\mathrm{nm/K} \\;=\\; 0.01380649\\ \\mathrm{pN}\\cdot\\mathrm{nm/K}.\n$$\n因此，$k_{\\mathrm{B}}T$ 的单位是 $\\mathrm{pN}\\cdot\\mathrm{nm}$，$A_{\\mathrm{eff}}/(k_{\\mathrm{B}}T)$ 得出的 $L_p$ 单位是 $\\mathrm{nm}$。\n\n算法：\n- 对每种情况，构建 $b_i$ 和 $A_i$，计算 $L=\\sum_i b_i$ 和 $S=\\sum_i b_i/A_i$。\n- 计算 $A_{\\mathrm{eff}} = L/S$。\n- 计算 $k_{\\mathrm{B}}T = 0.01380649 \\times T$（单位：$\\mathrm{pN}\\cdot\\mathrm{nm}$）。\n- 计算 $L_p = A_{\\mathrm{eff}}/(k_{\\mathrm{B}}T)$（单位：$\\mathrm{nm}$）。\n- 四舍五入到 $6$ 位小数。\n\n现在使用均匀的 $b_i=b=0.34\\ \\mathrm{nm}$ 对测试套件进行数值评估。\n\n情况 1：$T=298.15$, $A=[205.7,205.7,205.7,205.7,205.7]$。\n- $A_{\\mathrm{eff}} = 205.7$。\n- $k_{\\mathrm{B}}T = 0.01380649\\times 298.15 = 4.1164049935$。\n- $L_p = 205.7/4.1164049935 \\approx 49.970788\\ \\mathrm{nm}$。\n\n情况 2：$T=298.15$, $A=[100,300,100,300,100,300]$。\n- $A_{\\mathrm{eff}} = \\left(6 / (3/100+3/300)\\right) = 150$。\n- $k_{\\mathrm{B}}T = 4.1164049935$。\n- $L_p = 150/4.1164049935 \\approx 36.439563\\ \\mathrm{nm}$。\n\n情况 3：$T=298.15$, $A=[1000,1000,1000]$。\n- $A_{\\mathrm{eff}} = 1000$。\n- $k_{\\mathrm{B}}T = 4.1164049935$。\n- $L_p = 1000/4.1164049935 \\approx 242.930420\\ \\mathrm{nm}$。\n\n情况 4：$T=298.15$, $A=[300,300,300,10,300,300,300,300,300,300]$。\n- $A_{\\mathrm{eff}} = 10/\\left(9/300 + 1/10\\right) = 76.9230769231$。\n- $k_{\\mathrm{B}}T = 4.1164049935$。\n- $L_p \\approx 76.9230769231/4.1164049935 \\approx 18.686956\\ \\mathrm{nm}$。\n\n情况 5：$T=310.0$, $A=[205.7,205.7,205.7,205.7]$。\n- $A_{\\mathrm{eff}} = 205.7$。\n- $k_{\\mathrm{B}}T = 0.01380649\\times 310.0 = 4.2800119$。\n- $L_p = 205.7/4.2800119 \\approx 48.052203\\ \\mathrm{nm}$。\n\n情况 6：$T=298.15$, $A=[150]$。\n- $A_{\\mathrm{eff}} = 150$。\n- $k_{\\mathrm{B}}T = 4.1164049935$。\n- $L_p = 150/4.1164049935 \\approx 36.439563\\ \\mathrm{nm}$。\n\n最终要求的输出（四舍五入到 $6$ 位小数并按指定顺序排列）是包含浮点数列表的单行文本：\n$[49.970788,36.439563,242.930420,18.686956,48.052203,36.439563]$。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef effective_bending_modulus(A_list, b_list):\n    \"\"\"\n    Compute A_eff for a heterogeneous elastic rod discretized into steps.\n    A_list: list or array of per-step bending moduli (pN*nm^2)\n    b_list: list or array of per-step lengths (nm)\n    Returns A_eff in pN*nm^2.\n    \"\"\"\n    A = np.asarray(A_list, dtype=float)\n    b = np.asarray(b_list, dtype=float)\n    L = b.sum()  # total contour length (nm)\n    compliance_sum = np.sum(b / A)  # sum of ds/A(s)\n    return L / compliance_sum\n\ndef persistence_length_nm(A_eff, T_kelvin):\n    \"\"\"\n    Compute L_p in nm given A_eff (pN*nm^2) and temperature T (K).\n    Uses k_B = 0.01380649 pN*nm/K (from 1.380649e-23 J/K with 1 J = 1e21 pN*nm).\n    \"\"\"\n    kB_pNnm_perK = 0.01380649\n    kBT = kB_pNnm_perK * T_kelvin  # pN*nm\n    return A_eff / kBT  # nm\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (T in K, b in nm, list of A_i in pN*nm^2)\n    test_cases = [\n        (298.15, 0.34, [205.7, 205.7, 205.7, 205.7, 205.7]),\n        (298.15, 0.34, [100.0, 300.0, 100.0, 300.0, 100.0, 300.0]),\n        (298.15, 0.34, [1000.0, 1000.0, 1000.0]),\n        (298.15, 0.34, [300.0, 300.0, 300.0, 10.0, 300.0, 300.0, 300.0, 300.0, 300.0, 300.0]),\n        (310.0,  0.34, [205.7, 205.7, 205.7, 205.7]),\n        (298.15, 0.34, [150.0]),\n    ]\n\n    results = []\n    for T, b, A_list in test_cases:\n        b_list = [b] * len(A_list)\n        A_eff = effective_bending_modulus(A_list, b_list)\n        Lp = persistence_length_nm(A_eff, T)\n        results.append(f\"{Lp:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```", "id": "2386739"}]}