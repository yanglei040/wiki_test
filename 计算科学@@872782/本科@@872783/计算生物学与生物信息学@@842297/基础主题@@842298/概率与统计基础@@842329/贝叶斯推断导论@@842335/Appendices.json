{"hands_on_practices": [{"introduction": "让我们从生物信息学中的一个经典场景开始：评估一个诊断分类器的性能。这个练习展示了贝叶斯推断的核心——根据新证据（分类器的标记）来更新我们对一个假设（某个蛋白质是朊病毒）的信念。通过解决这个问题 [@problem_id:2400337]，你将学会如何将分类器的准确性（其真阳性率和假阳性率）与条件的初始流行率结合起来，以计算出一个更具信息量的后验概率，这是解读任何诊断或筛选工具的一项基本技能。", "problem": "一个生物信息学流程筛选一个大型真核蛋白质组，以识别朊病毒样蛋白。对于每个蛋白质，一个二元分类器会输出“标记”或“不标记”。令 $\\text{prion}$ 表示根据真实情况一个蛋白质确实是朊病毒样的事件，令 $\\text{flag}$ 表示分类器标记该蛋白质的事件。该分类器的真阳性率（TPR）为 $0.80$，即 $P(\\text{flag}\\mid \\text{prion})=0.80$。该分类器的假阳性率（FPR）为 $0.10$，即 $P(\\text{flag}\\mid \\neg \\text{prion})=0.10$。此蛋白质组中朊病毒样蛋白的基础比率（流行率）为 $P(\\text{prion})=0.01$。一个随机选择的蛋白质被分类器标记了。\n\n后验概率 $P(\\text{prion}\\mid \\text{flag})$ 是多少？请以精确分数形式提供答案。", "solution": "该问题要求计算后验概率 $P(\\text{prion}\\mid \\text{flag})$，即在一个蛋白质被分类器标记的情况下，该蛋白质确实是朊病毒样的概率。这是贝叶斯定理的一个标准应用。该问题陈述清晰，并为直接计算提供了所有必要信息。\n\n我们如下定义事件：\n- $\\text{prion}$: 随机选择的蛋白质确实是朊病毒样的事件。\n- $\\neg \\text{prion}$: 随机选择的蛋白质不是朊病毒样的事件。\n- $\\text{flag}$: 分类器标记该蛋白质的事件。\n\n根据问题陈述，我们已知以下概率：\n- 一个蛋白质是朊病毒样的先验概率（流行率）：$P(\\text{prion}) = 0.01$。\n- 在蛋白质是朊病毒样的情况下被标记的条件概率（真阳性率）：$P(\\text{flag}\\mid \\text{prion}) = 0.80$。\n- 在蛋白质不是朊病毒样的情况下被标记的条件概率（假阳性率）：$P(\\text{flag}\\mid \\neg \\text{prion}) = 0.10$。\n\n贝叶斯定理表述如下：\n$$\nP(\\text{prion}\\mid \\text{flag}) = \\frac{P(\\text{flag}\\mid \\text{prion}) P(\\text{prion})}{P(\\text{flag})}\n$$\n分母 $P(\\text{flag})$ 是一个蛋白质被标记的边际概率。这个概率使用全概率公式计算，对完备且互斥的事件集合 $\\{\\text{prion}, \\neg \\text{prion}\\}$ 求和：\n$$\nP(\\text{flag}) = P(\\text{flag}\\mid \\text{prion}) P(\\text{prion}) + P(\\text{flag}\\mid \\neg \\text{prion}) P(\\neg \\text{prion})\n$$\n首先，我们必须确定一个蛋白质不是朊病毒样的概率 $P(\\neg \\text{prion})$。由于这是事件 $\\text{prion}$ 的补集，其概率为：\n$$\nP(\\neg \\text{prion}) = 1 - P(\\text{prion}) = 1 - 0.01 = 0.99\n$$\n现在，我们可以将已知值代入 $P(\\text{flag})$ 的表达式中：\n$$\nP(\\text{flag}) = (0.80)(0.01) + (0.10)(0.99)\n$$\n$$\nP(\\text{flag}) = 0.008 + 0.099 = 0.107\n$$\n计算出 $P(\\text{flag})$ 的值后，我们现在可以回到贝叶斯定理来求后验概率 $P(\\text{prion}\\mid \\text{flag})$。分子是似然与先验概率的乘积：\n$$\nP(\\text{flag}\\mid \\text{prion}) P(\\text{prion}) = (0.80)(0.01) = 0.008\n$$\n因此，后验概率为：\n$$\nP(\\text{prion}\\mid \\text{flag}) = \\frac{0.008}{0.107}\n$$\n问题要求答案为精确分数。我们将小数值转换为其等价的分数形式以简化表达式：\n$$\nP(\\text{prion}\\mid \\text{flag}) = \\frac{\\frac{8}{1000}}{\\frac{107}{1000}}\n$$\n这可以简化为：\n$$\nP(\\text{prion}\\mid \\text{flag}) = \\frac{8}{107}\n$$\n数字 $107$ 是一个质数，且不能整除 $8$。因此，分数 $\\frac{8}{107}$ 是最简形式。这就是在被分类器标记的情况下，一个蛋白质是朊病毒样的精确后验概率。", "answer": "$$\\boxed{\\frac{8}{107}}$$", "id": "2400337"}, {"introduction": "在基础之上，我们现在考虑一个更精细的诊断工具，它输出一个连续的分数，而不仅仅是一个简单的二元标记。这种情况在现代计算生物学中很常见，其中基因表达分析或机器学习模型等方法提供的是分级的证据。这个练习 [@problem_id:2400344] 将教你当证据是一个连续变量时如何应用贝叶斯定理，使用概率密度函数作为似然来更新你对病情根本原因的信念。", "problem": "一名发热患者正在接受两种互斥病因的评估：流感 (Flu) 和酿脓链球菌 (Strep)。根据当地监测数据，先验概率为 $P(\\text{Flu}) = 0.6$ 和 $P(\\text{Strep}) = 0.4$。一个基于RNA测序(RNA-seq)数据训练的宿主转录组分类器会输出一个连续的无量纲分数 $s$。在真实病因的条件下，该分数被建模为高斯分布：$s \\mid \\text{Flu} \\sim \\mathcal{N}(\\mu_F, \\sigma^{2})$，其中 $\\mu_F = 2.0$，$\\sigma^{2} = 1.0$；以及 $s \\mid \\text{Strep} \\sim \\mathcal{N}(\\mu_S, \\sigma^{2})$，其中 $\\mu_S = 0.0$，$\\sigma^{2} = 1.0$。对于该患者，测得的分数为 $s = 1.1$。假设这两种病因是穷尽的且模型是正确的，计算后验概率 $P(\\text{Flu} \\mid s = 1.1)$。将您的答案四舍五入到四位有效数字。", "solution": "对问题陈述进行验证。\n\n步骤 1：提取已知条件\n-   病因：流感 (Flu) 和酿脓链球菌 (Strep)。\n-   这两种病因是互斥且穷尽的。\n-   先验概率：$P(\\text{Flu}) = 0.6$，$P(\\text{Strep}) = 0.4$。\n-   测量得到一个连续的无量纲分数 $s$。\n-   分数 $s$ 的条件概率分布（似然）：\n    -   给定流感 (Flu)：$s \\mid \\text{Flu} \\sim \\mathcal{N}(\\mu_F, \\sigma^{2})$，其中 $\\mu_F = 2.0$ 且 $\\sigma^{2} = 1.0$。\n    -   给定链球菌 (Strep)：$s \\mid \\text{Strep} \\sim \\mathcal{N}(\\mu_S, \\sigma^{2})$，其中 $\\mu_S = 0.0$ 且 $\\sigma^{2} = 1.0$。\n-   观测数据：该患者的测量分数为 $s = 1.1$。\n-   目标：计算后验概率 $P(\\text{Flu} \\mid s = 1.1)$ 并四舍五入到四位有效数字。\n\n步骤 2：使用提取的已知条件进行验证\n-   **科学依据**：该问题在科学上是合理的。它使用了贝叶斯定理——概率论的一个基本原理，并将其应用于计算生物学和医学诊断中的一个现实问题。使用宿主转录组分类器产生一个由高斯分布建模的分数，是该领域中一种标准且成熟的方法。\n-   **适定性**：该问题是适定的。它要求计算一个特定的后验概率，并且所有必需的组成部分都已提供：先验概率、所有参数都已指定的似然函数以及观测数据点。问题是明确的，并且允许一个唯一的、稳定的解。先验概率之和为 $P(\\text{Flu}) + P(\\text{Strep}) = 0.6 + 0.4 = 1.0$，这与病因是穷尽的陈述相符。\n-   **客观性**：该问题以精确、客观、形式化的数学语言陈述，没有任何主观论断或含糊之处。\n\n步骤 3：结论与行动\n问题有效。它是贝叶斯推断的一个定义明确、自成体系的应用。我将继续进行解答。\n\n目标是计算在给定观测分数 $s = 1.1$ 下的流感后验概率 $P(\\text{Flu} \\mid s = 1.1)$。我们采用贝叶斯定理，它将后验概率与先验概率和似然联系起来。对于 Flu 和 Strep 这两个互斥且穷尽的假设以及数据 $s$，Flu 的后验概率由下式给出：\n$$ P(\\text{Flu} \\mid s) = \\frac{p(s \\mid \\text{Flu}) P(\\text{Flu})}{p(s \\mid \\text{Flu}) P(\\text{Flu}) + p(s \\mid \\text{Strep}) P(\\text{Strep})} $$\n这里，$p(s \\mid \\cdot)$ 表示在给定病因条件下分数 $s$ 的概率密度函数，也就是似然。$P(\\cdot)$ 是先验概率。分母是数据 $p(s)$ 的边际似然，也称为证据。\n\n似然由正态分布 $\\mathcal{N}(\\mu, \\sigma^2)$ 的概率密度函数 (PDF) 给出，即：\n$$ f(x \\mid \\mu, \\sigma^2) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left(-\\frac{(x - \\mu)^2}{2\\sigma^2}\\right) $$\n\n首先，我们定义在观测值 $s=1.1$ 下，Flu 假设的似然。\n参数为 $\\mu_F = 2.0$ 和 $\\sigma^2 = 1.0$。\n$$ p(s=1.1 \\mid \\text{Flu}) = \\frac{1}{\\sqrt{2\\pi(1.0)}} \\exp\\left(-\\frac{(1.1 - 2.0)^2}{2(1.0)}\\right) = \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{(-0.9)^2}{2}\\right) = \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{0.81}{2}\\right) = \\frac{1}{\\sqrt{2\\pi}} \\exp(-0.405) $$\n\n其次，我们定义在观测值 $s=1.1$ 下，Strep 假设的似然。\n参数为 $\\mu_S = 0.0$ 和 $\\sigma^2 = 1.0$。\n$$ p(s=1.1 \\mid \\text{Strep}) = \\frac{1}{\\sqrt{2\\pi(1.0)}} \\exp\\left(-\\frac{(1.1 - 0.0)^2}{2(1.0)}\\right) = \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{1.1^2}{2}\\right) = \\frac{1}{\\sqrt{2\\pi}} \\exp\\left(-\\frac{1.21}{2}\\right) = \\frac{1}{\\sqrt{2\\pi}} \\exp(-0.605) $$\n\n给定的先验概率为 $P(\\text{Flu}) = 0.6$ 和 $P(\\text{Strep}) = 0.4$。\n\n现在，我们将这些部分代入贝叶斯定理。让我们将未归一化的似然（与PDF成比例）表示为 $L_F = \\exp(-0.405)$ 和 $L_S = \\exp(-0.605)$，注意到归一化常数 $\\frac{1}{\\sqrt{2\\pi}}$ 将从分子和分母中抵消掉。\n$$ P(\\text{Flu} \\mid s=1.1) = \\frac{p(s=1.1 \\mid \\text{Flu}) P(\\text{Flu})}{p(s)} = \\frac{\\left(\\frac{1}{\\sqrt{2\\pi}} L_F\\right) P(\\text{Flu})}{\\left(\\frac{1}{\\sqrt{2\\pi}} L_F\\right) P(\\text{Flu}) + \\left(\\frac{1}{\\sqrt{2\\pi}} L_S\\right) P(\\text{Strep})} $$\n$$ P(\\text{Flu} \\mid s=1.1) = \\frac{L_F P(\\text{Flu})}{L_F P(\\text{Flu}) + L_S P(\\text{Strep})} $$\n代入数值：\n$$ P(\\text{Flu} \\mid s=1.1) = \\frac{\\exp(-0.405) \\cdot 0.6}{\\exp(-0.405) \\cdot 0.6 + \\exp(-0.605) \\cdot 0.4} $$\n现在我们必须计算数值。\n分子是：\n$$ 0.6 \\cdot \\exp(-0.405) \\approx 0.6 \\cdot 0.6669768 = 0.40018608 $$\n分母是：\n$$ (0.6 \\cdot \\exp(-0.405)) + (0.4 \\cdot \\exp(-0.605)) \\approx 0.40018608 + (0.4 \\cdot 0.5460835) $$\n$$ \\approx 0.40018608 + 0.2184334 = 0.61861948 $$\n后验概率是该比率：\n$$ P(\\text{Flu} \\mid s=1.1) \\approx \\frac{0.40018608}{0.61861948} \\approx 0.6468750... $$\n问题要求答案四舍五入到四位有效数字。第五位有效数字是 $7$，因此需要将第四位有效数字向上取整。\n$$ P(\\text{Flu} \\mid s=1.1) \\approx 0.6469 $$\n这是最终答案。", "answer": "$$\n\\boxed{0.6469}\n$$", "id": "2400344"}, {"introduction": "现在，我们将从分类离散状态转向估计一个连续的生物学参数——一项新疗法的未知成功率 $p$。这代表了贝叶斯推断在概念上的一个重要步骤，我们的目标不再仅仅是在几个假设之间做出选择，而是要量化我们对一个连续量的不确定性。在这个练习中 [@problem_id:1923968]，你将学习在观测到数据后，如何将关于一个参数的先验信念更新为一个完整的后验概率分布，并如何使用这个分布来推导有意义的概括性统计量。", "problem": "一种新的高风险外科手术正在被开发，用于治疗一种以前被认为是无法治愈的疾病。该手术的真实成功概率（记为 $p$）是未知的。在进行任何临床试验之前，医学研究人员对这个概率没有任何先入为主的偏见，因此认为 $p$ 在区间 $[0, 1]$ 上的所有可能值都是等可能的。\n\n随后，该手术在 $n$ 位不同的患者身上进行了尝试。在这 $n$ 次独立试验的每一次中，手术都未能成功。\n\n基于 $n$ 次试验中零次成功的观测数据，形成了关于成功概率 $p$ 的一个更新的信念。一位医学统计学家决定通过计算一个中心值 $p_{med}$ 来总结这个更新的信念。该值的定义是：在给定观测数据的情况下，真实成功率 $p$ 小于或等于 $p_{med}$ 的概率与 $p$ 大于 $p_{med}$ 的概率相等。\n\n求出 $p_{med}$ 关于 $n$ 的闭式解析表达式。", "solution": "设 $p$ 表示成功概率。先验信念是在 $[0,1]$ 上的均匀分布，这是一个 $\\operatorname{Beta}(1,1)$ 先验，其密度函数为 $\\pi(p)=1$，$p\\in[0,1]$。\n\n我们观察到 $n$ 次独立的伯努利试验，其中成功次数为 $k=0$。似然函数为\n$$\nL(p\\mid \\text{data}) \\propto p^{k}(1-p)^{n-k}=(1-p)^{n}.\n$$\n根据贝叶斯定理，后验分布正比于先验分布乘以似然函数：\n$$\n\\pi(p\\mid \\text{data}) \\propto \\pi(p)L(p\\mid \\text{data}) \\propto (1-p)^{n}, \\quad 0\\leq p\\leq 1.\n$$\n这是一个 $\\operatorname{Beta}(1,n+1)$ 分布。明确地进行归一化，\n$$\n\\int_{0}^{1} (1-p)^{n}\\,dp=\\frac{1}{n+1},\n$$\n所以后验密度函数为\n$$\nf(p\\mid \\text{data})=(n+1)(1-p)^{n}, \\quad 0\\leq p\\leq 1.\n$$\n后验累积分布函数是\n$$\nF(p)=\\int_{0}^{p} (n+1)(1-t)^{n}\\,dt.\n$$\n通过令 $u=1-t$，$du=-dt$ 来计算积分：\n$$\nF(p)=(n+1)\\int_{0}^{p} (1-t)^{n}\\,dt=(n+1)\\int_{1-p}^{1} u^{n}\\,du\n= (n+1)\\left[\\frac{u^{n+1}}{n+1}\\right]_{1-p}^{1}\n=1-(1-p)^{n+1}.\n$$\n后验中位数 $p_{med}$ 满足 $F(p_{med})=\\frac{1}{2}$，因此\n$$\n1-(1-p_{med})^{n+1}=\\frac{1}{2}\n\\;\\;\\Longrightarrow\\;\\;\n(1-p_{med})^{n+1}=\\frac{1}{2}.\n$$\n两边取 $(n+1)$ 次方根，得到\n$$\n1-p_{med}=2^{-\\frac{1}{n+1}},\n$$\n所以\n$$\np_{med}=1-2^{-\\frac{1}{n+1}}.\n$$\n该表达式对所有 $n\\geq 0$ 均有效，特别地，对于问题背景中的 $n\\geq 1$ 也有效。", "answer": "$$\\boxed{1-2^{-\\frac{1}{n+1}}}$$", "id": "1923968"}]}