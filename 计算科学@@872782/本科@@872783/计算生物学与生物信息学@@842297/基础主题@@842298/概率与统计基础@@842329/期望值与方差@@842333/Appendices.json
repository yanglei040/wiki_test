{"hands_on_practices": [{"introduction": "我们从一个在生物信息学中至关重要的应用开始：分析RNA测序（RNA-seq）数据。这个练习 [@problem_id:2389172] 将帮助您理解RNA-seq读数计数常用的泊松分布模型。通过探索测序深度如何影响计数的期望值和方差，您将掌握一个对于实验设计和数据解释都至关重要的基本原理。", "problem": "在一项使用RNA测序（RNA-seq）的差异基因表达研究中，假设对于一个特定基因，在固定的实验条件和固定的测序深度下，观测到的读数计数 $X$ 服从参数为 $\\lambda$ 的泊松分布，即 $X \\sim \\operatorname{Pois}(\\lambda)$。然后，实验室在相同条件下重复该实验，但测序深度增加到原来的 $3$ 倍，并将所有读数汇集到一个文库中。在标准假设下，即读数生成事件是独立的，并且一个基因的期望计数与测序深度成线性比例，请确定该基因的合并读数计数的新期望值和方差。\n\n请以行向量 $\\left(\\mathbb{E}[X'], \\operatorname{Var}(X')\\right)$ 的形式报告您的答案，用 $\\lambda$ 表示。无需进行数值近似。", "solution": "首先必须验证问题陈述的科学性和逻辑一致性。前提如下：\n1. 初始读数计数，一个随机变量 $X$，服从参数为 $\\lambda$ 的泊松分布。这记作 $X \\sim \\operatorname{Pois}(\\lambda)$。\n2. 一个基因的期望读数计数与测序深度成线性比例。\n3. 进行了一项新实验，其测序深度是原始深度的 $3$ 倍。\n\n这些前提在计算生物学领域分析RNA-seq数据是标准且公认的。该模型具有科学依据，且问题提法合理。我们可以着手求解。\n\n设原始测序深度为 $D$。初始读数计数是随机变量 $X$，并且已知 $X \\sim \\operatorname{Pois}(\\lambda)$。泊松分布的基本性质表明，其期望值和方差均等于其参数。因此，对于初始实验，我们有：\n$$\n\\mathbb{E}[X] = \\lambda\n$$\n$$\n\\operatorname{Var}(X) = \\lambda\n$$\n\n问题陈述指出，期望计数与测序深度成正比。我们可以用一个比例常数 $k$ 来数学地表达这种关系，该常数取决于特定基因和固定的实验条件。\n$$\n\\mathbb{E}[X] = kD\n$$\n由此，我们可以将期望值的两个表达式相等，从而将泊松参数 $\\lambda$ 与测序深度 $D$ 联系起来：\n$$\n\\lambda = kD\n$$\n\n接下来，描述了一个新实验。设 $X'$ 是代表这个新实验读数计数的随机变量。新的测序深度是原始深度的 $3$ 倍，我们记作 $D' = 3D$。问题暗示新的计数 $X'$ 也服从泊松分布，这与标准模型一致。设这个新分布的参数为 $\\lambda'$。因此，$X' \\sim \\operatorname{Pois}(\\lambda')$。\n\n我们将线性比例假设应用于新实验。比例常数 $k$ 保持不变，因为基因和其他条件未改变。新的期望值是：\n$$\n\\mathbb{E}[X'] = kD' = k(3D)\n$$\n我们可以通过组合项来重写这个表达式：\n$$\n\\mathbb{E}[X'] = 3(kD)\n$$\n代入我们之前得到的 $\\lambda = kD$，我们用 $\\lambda$ 来确定新的期望值：\n$$\n\\mathbb{E}[X'] = 3\\lambda\n$$\n\n对于新的泊松分布变量 $X'$，其参数 $\\lambda'$ 必须等于其期望值。因此：\n$$\n\\lambda' = \\mathbb{E}[X'] = 3\\lambda\n$$\n泊松分布的方差也等于其参数。因此，新读数计数 $X'$ 的方差是：\n$$\n\\operatorname{Var}(X') = \\lambda' = 3\\lambda\n$$\n\n问题要求以行向量 $(\\mathbb{E}[X'], \\operatorname{Var}(X'))$ 的形式报告新的期望值和方差。我们已经求出了这两个量。新的期望值是 $3\\lambda$，新的方差是 $3\\lambda$。", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n3\\lambda  3\\lambda\n\\end{pmatrix}\n}\n$$", "id": "2389172"}, {"introduction": "接下来，我们挑战一个从零开始构建概率模型的任务，该模型应用于新兴的DNA数据存储技术。此练习 [@problem_id:2389185] 模拟了一个包含合成和测序两个错误阶段的数据恢复过程。您将运用指示随机变量和期望的线性性质来量化系统的整体性能，这是分析任何多步骤随机过程的强大技巧。", "problem": "脱氧核糖核酸（DNA）数据存储管道将数字消息编码为合成DNA，随后通过测序解码。考虑一个模型，其中每个预期的二进制位都经过 $2$ 个独立阶段：\n\n- 在合成过程中，存储的比特与预期的比特相同的概率为 $1-p$，被翻转的概率为 $p$。\n- 在测序（读取）过程中，报告的比特与存储的比特相同的概率为 $1-q$，被翻转的概率为 $q$。\n\n假设所有比特错误都是跨比特和跨阶段发生的独立替换，并忽略插入和删除。考虑一个大小为 $1\\,\\mathrm{KB}$ 的消息，其中 $1\\,\\mathrm{KB}=1024$ 字节，每字节 $8$ 比特。\n\n经过这两个阶段后，正确恢复的比特数的期望值是多少，用一个关于 $p$ 和 $q$ 的封闭形式解析表达式表示？请提供一个未经四舍五入的单一表达式作为答案。", "solution": "该问题要求计算经过两阶段错误过程后，消息中正确恢复的比特数的期望值。需对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- 过程有两个独立阶段：合成和测序。\n- 合成错误概率（比特翻转）：$p$。\n- 合成无错误的概率：$1-p$。\n- 测序错误概率（比特翻转）：$q$。\n- 测序无错误的概率：$1-q$。\n- 所有比特错误都是独立替换。\n- 插入和删除被忽略。\n- 消息大小：$1\\,\\mathrm{KB}$。\n- 换算关系：$1\\,\\mathrm{KB} = 1024$ 字节。\n- 换算关系：$1$ 字节 = $8$ 比特。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据：** 该问题为DNA数据存储通道中的错误提供了一个简化但有效的概率模型，这是计算生物学和生物信息学中公认的课题。所使用的概念（独立事件、概率、期望值）是数学和信息论的基础。该模型在科学上是合理的。\n- **问题适定性：** 该问题提供了所有必要的参数（$p$，$q$）和常数（消息大小），以确定一个唯一的解析解。\n- **客观性：** 问题以精确、定量的术语陈述，没有任何主观性或模糊性。\n\n**结论：** 该问题具有科学依据、适定且客观。判定为**有效**。我们可以继续求解。\n\n设 $N$ 为消息中的总比特数。消息大小为 $1\\,\\mathrm{KB}$，定义为 $1\\,\\mathrm{KB} = 1024$ 字节，且 $1$ 字节 $= 8$ 比特。因此，总比特数为：\n$$N = 1024 \\times 8 = 8192$$\n\n让我们考虑单个比特。设 $X$ 为一个指示随机变量，如果该比特在两个阶段后被正确恢复，则 $X=1$，否则 $X=0$。任务是求出正确恢复的总比特数的期望值。设这个总数为 $S$。如果我们有 $N$ 个比特，索引为 $i=1, 2, \\dots, N$，我们可以为每个比特定义一个指示变量 $X_i$。正确比特的总数为 $S = \\sum_{i=1}^{N} X_i$。\n\n根据期望的线性性质，正确比特的总期望值为：\n$$E[S] = E\\left[\\sum_{i=1}^{N} X_i\\right] = \\sum_{i=1}^{N} E[X_i]$$\n由于每个比特的错误过程是相同且独立的，所以所有 $i$ 的期望值 $E[X_i]$ 都相同。设这个共同的值为 $E[X]$。因此，\n$$E[S] = N \\cdot E[X]$$\n指示变量的期望值是它所指示事件的概率。因此，$E[X] = P(X=1)$，即单个比特被正确恢复的概率。\n\n如果最终报告的比特与原始预期的比特相同，则该比特被正确恢复。这可以通过两种互斥的方式发生：\n1. 比特在合成过程中未被翻转，且在测序过程中也未被翻转。发生了偶数次（$0$ 次）翻转。\n2. 比特在合成过程中被翻转，且在测序过程中再次被翻转。发生了偶数次（$2$ 次）翻转，使比特恢复到其原始状态。\n\n让我们计算每种情况的概率。这两个阶段是独立的。\n- 第一种情况（任一阶段均未翻转）的概率是每个阶段不翻转概率的乘积：\n$$P(\\text{no flip, no flip}) = (1-p)(1-q)$$\n- 第二种情况（两个阶段均翻转）的概率是每个阶段翻转概率的乘积：\n$$P(\\text{flip, flip}) = p \\cdot q$$\n\n单个比特被正确恢复的总概率 $P(X=1)$ 是这两个不相交事件的概率之和：\n$$P(X=1) = (1-p)(1-q) + pq$$\n展开这个表达式，我们得到：\n$$P(X=1) = 1 - p - q + pq + pq = 1 - p - q + 2pq$$\n\n现在，我们可以通过代入 $N$ 和 $P(X=1)$ 的值来计算正确恢复的总比特数的期望值 $E[S]$：\n$$E[S] = N \\cdot P(X=1) = 8192 \\cdot (1 - p - q + 2pq)$$\n这就是所求的关于错误概率 $p$ 和 $q$ 的正确恢复比特数的期望值的封闭形式解析表达式。", "answer": "$$\n\\boxed{8192(1 - p - q + 2pq)}\n$$", "id": "2389185"}, {"introduction": "最后，我们将处理一个更高级的复合随机过程，以模拟体细胞突变在人体内的累积。这个问题 [@problem_id:2389107] 建立了一个结合了细胞分裂率和分裂时突变数量的复杂模型。通过应用全期望定律，您将学会如何分解复杂问题并计算出关键生物学过程的长期期望结果，这在研究衰老和癌症等领域至关重要。", "problem": "一个健康的成年人维持着一个大致恒定的造血干细胞 (HSC) 池。考虑以下随机模型，用于描述从出生到 $50$ 岁期间，HSC 区室中单核苷酸变异 (SNV) 点突变的累积。\n\n- HSC 种群大小恒定为 $N = 5 \\times 10^{4}$ 个细胞。\n- 在长度为 $T = 50$ 年的时间区间内，每个 HSC 根据速率为每年 $d = 0.7$ 次分裂的均匀泊松过程进行有丝分裂，各细胞间及时间上均相互独立。\n- 以一次 HSC 分裂为条件，引入到分裂细胞基因组中的新 SNV 点突变数量是一个泊松随机变量，其均值为每次细胞分裂 $\\mu = 2.8$ 个突变。各次分裂的突变计数相互独立。\n- 忽略选择、细胞凋亡以及任何在 DNA 复制之外产生的突变。计算在 $T$ 年时间区间内 HSC 区室中发生的每一次突变事件，无论突变的子细胞是保留为 HSC 还是分化。\n\n仅使用这些假设，计算从出生到 50 岁期间 HSC 区室中累积的 SNV 突变事件的总期望数。将答案四舍五入到两位有效数字。最终答案以纯数字形式表示（无单位）。", "solution": "必须首先严格验证问题陈述的科学性和数学合理性。\n\n首先，我将逐字提取陈述中给出的所有信息。\n- HSC 种群大小恒定为 $N = 5 \\times 10^{4}$ 个细胞。\n- 每个 HSC 根据速率为每年 $d = 0.7$ 次分裂的均匀泊松过程进行有丝分裂，各细胞间及时间上均相互独立。\n- 时间区间长度为 $T = 50$ 年。\n- 以一次 HSC 分裂为条件，引入的新 SNV 点突变数量是一个泊松随机变量，其均值为每次细胞分裂 $\\mu = 2.8$ 个突变。\n- 各次分裂的突变计数相互独立。\n- 模型要求忽略选择、细胞凋亡以及任何在 DNA 复制之外产生的突变。\n- 任务是计算在 $T$ 年时间区间内 HSC 区室中发生的每一次突变事件。\n- 最终目标是计算 SNV 突变事件的总期望数，并将答案四舍五入到两位有效数字。\n\n接下来，我将根据所需标准验证该问题。\n1.  **科学依据**：该问题使用随机模型（泊松过程），这是计算生物学中用于建模细胞分裂和突变等事件的标准且有效的工具。种群大小 ($N$)、分裂速率 ($d$) 和每次分裂的突变负荷 ($\\mu$) 的参数值在人类造血干细胞的生物学合理范围内。所作的假设虽然是简化的，但都已明确说明。因此，作为一个建模练习，该问题具有科学依据。\n2.  **良定性**：所有必需的参数（$N$, $d$, $T$, $\\mu$）均已提供。目标——计算期望值——是明确定义的。随机过程被明确指定，从而可以得到唯一解。\n3.  **客观性**：该问题以精确、定量的术语陈述，没有主观或模棱两可的语言。\n\n该问题是应用概率论和计算生物学领域中一个有效、自洽且良定的问题。它没有违反任何无效标准。因此，我将继续进行求解。\n\n设 $M_{total}$ 为在长度为 $T$ 的时间区间内，整个 HSC 区室中 SNV 突变事件总数的随机变量。我们的目标是计算其期望值 $E[M_{total}]$。\n\n突变总数是每次分裂时发生突变的数量之和。这可以建模为一个随机数量的随机变量之和。设 $D_{total}$ 为在时间区间 $[0, T]$ 内区室中 HSC 分裂的总次数。设 $M_j$ 为第 $j$ 次分裂事件中发生的新突变数量。我们已知 $M_j$ 是一个均值为 $\\mu$ 的泊松随机变量。因此，$E[M_j] = \\mu$。\n\n突变总数为 $M_{total} = \\sum_{j=1}^{D_{total}} M_j$。\n为了求 $M_{total}$ 的期望值，我们可以使用全期望定律，在此情境下也称为瓦尔德等式 (Wald's identity)：\n$$E[M_{total}] = E[E[M_{total} | D_{total}]]$$\n首先，我们计算以一个固定的总分裂次数 $D_{total}$ 为条件的内部期望。\n$$E[M_{total} | D_{total}] = E\\left[\\sum_{j=1}^{D_{total}} M_j \\bigg| D_{total}\\right]$$\n由于每次分裂的突变数 ($M_j$) 与其他分裂的突变数相互独立，并且也与总分裂次数本身独立（除了它设定了求和的项数），我们可以使用期望的线性性质：\n$$E\\left[\\sum_{j=1}^{D_{total}} M_j \\bigg| D_{total}\\right] = \\sum_{j=1}^{D_{total}} E[M_j] = \\sum_{j=1}^{D_{total}} \\mu = D_{total} \\mu$$\n现在，我们将此结果代回到全期望定律中：\n$$E[M_{total}] = E[D_{total} \\mu] = \\mu E[D_{total}]$$\n问题现在简化为求总分裂次数的期望值 $E[D_{total}]$。\n\nHSC 区室包含 $N$ 个细胞。总分裂次数 $D_{total}$ 是在时间区间 $T$ 内， $N$ 个细胞中每一个细胞分裂次数的总和。设 $D_i(T)$ 为细胞 $i$ 在 $[0, T]$ 内的分裂次数。那么：\n$$D_{total} = \\sum_{i=1}^{N} D_i(T)$$\n根据期望的线性性质：\n$$E[D_{total}] = E\\left[\\sum_{i=1}^{N} D_i(T)\\right] = \\sum_{i=1}^{N} E[D_i(T)]$$\n对于每个细胞 $i$，其分裂次数 $D_i(T)$ 遵循一个速率为 $d$ 的均匀泊松过程。这样一个过程在长度为 $T$ 的区间内的事件数是一个均值为 $d T$ 的泊松分布随机变量。\n因此，对于每个细胞 $i=1, \\dots, N$，都有 $E[D_i(T)] = d T$。\n\n将此代回到 $E[D_{total}]$ 的表达式中：\n$$E[D_{total}] = \\sum_{i=1}^{N} (d T) = N d T$$\n最后，我们可以求出突变总数的期望值：\n$$E[M_{total}] = \\mu E[D_{total}] = \\mu N d T$$\n这是突变事件总期望数的最终解析表达式。\n\n现在，我将代入给定的数值：\n- $N = 5 \\times 10^{4}$\n- $d = 0.7$ 年$^{-1}$\n- $T = 50$ 年\n- $\\mu = 2.8$\n\n$$E[M_{total}] = (2.8) \\times (5 \\times 10^{4}) \\times (0.7) \\times (50)$$\n$$E[M_{total}] = 2.8 \\times 5 \\times 0.7 \\times 50 \\times 10^{4}$$\n$$E[M_{total}] = (2.8 \\times 0.7) \\times (5 \\times 50) \\times 10^{4}$$\n$$E[M_{total}] = 1.96 \\times 250 \\times 10^{4}$$\n$$E[M_{total}] = 490 \\times 10^{4}$$\n$$E[M_{total}] = 4.9 \\times 10^{6}$$\n问题要求答案四舍五入到两位有效数字。计算结果 $4.9 \\times 10^{6}$ 已经是用两位有效数字表示的。", "answer": "$$\\boxed{4.9 \\times 10^{6}}$$", "id": "2389107"}]}