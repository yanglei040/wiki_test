{"hands_on_practices": [{"introduction": "理解E值的第一步是掌握其基本计算方法。E值本质上是将单次比较中偶然匹配的概率（即p值）外推到整个数据库搜索空间的结果。这个练习将引导你完成这个核心计算 ([@problem_id:2387483])，将一个极小的概率转化为一个有实际意义的期望值。", "problem": "在一次蛋白质数据库搜索中发现的一个局部比对，据报告其单次比较尾部概率（p值）为 $10^{-6}$；也就是说，在序列不相关的零假设下，单次随机比较产生一个不低于观测分数的得分的概率是 $10^{-6}$。对于此查询和数据库，有效搜索空间参数（记作 $K m' n'$）等于 $10^{8}$，代表了搜索期间有效独立评分机会的数量。在局部比对分数的标准零模型下，期望值（E值）定义为在整个搜索中，得分不低于观测分数的随机比对的期望数量。\n\n计算此比对的E值。请以精确数值（不要四舍五入）报告您的答案。", "solution": "首先对问题陈述进行验证。\n\n步骤1：提取已知条件。\n- 单次比较尾部概率（p值）：$p = 10^{-6}$。\n- 有效搜索空间参数：$K m' n' = 10^{8}$。\n- 期望值（E值）的定义：在整个搜索中，得分不低于观测分数的随机比对的期望数量。\n\n步骤2：使用提取的已知条件进行验证。\n- 该问题具有科学依据。p值、E值和有效搜索空间大小（$K m' n'$）等概念是序列数据库搜索算法（如BLAST和FASTA）统计框架的核心，具体源于Karlin-Altschul统计理论。\n- 该问题提法恰当。它提供了计算所求量所需的所有数值和明确的定义。存在一个唯一且有意义的解。\n- 该问题是客观的。语言精确，没有主观或推测性内容。\n\n步骤3：结论与行动。\n该问题被视为有效，并将提供解答。\n\nE值，记为$E$，表示在数据库搜索中，随机情况下预期出现的得分大于或等于特定分数$S$的不同比对的数量。该问题提供了计算所需的基本量。\n\n单次比较尾部概率，或p值，记为$p$，是两条随机序列进行单次比较时，产生不低于观测分数的得分的概率。其值为：\n$$p = 10^{-6}$$\n\n有效搜索空间大小代表了搜索过程中执行的有效独立比较的次数。它由参数 $K m' n'$ 给出，其中 $m'$ 和 $n'$ 是查询序列和数据库序列的有效长度，而 $K$ 是一个取决于计分矩阵和序列组成的统计参数。其值为：\n$$K m' n' = 10^{8}$$\n让我们将这个有效独立比较的次数记为 $N_{eff}$。\n$$N_{eff} = K m' n' = 10^{8}$$\n\nE值定义为得分不低于观测分数的随机比对的期望数量。这可以概念化为一系列 $N_{eff}$ 次伯努利试验，其中每次试验对应一次随机比对比较，其成功概率为 $p$。在这样一系列试验中，期望的成功次数是试验次数与每次试验成功概率的乘积。\n\n因此，E值 $E$ 的计算方法是有效搜索空间大小与p值的乘积：\n$$E = N_{eff} \\times p$$\n\n将给定值代入此方程：\n$$E = (10^{8}) \\times (10^{-6})$$\n\n使用指数的性质，我们合并这些项：\n$$E = 10^{8 - 6}$$\n$$E = 10^{2}$$\n$$E = 100$$\n\n这个结果意味着，在使用给定的查询搜索如此大小的数据库时，人们预期会纯粹由偶然机会找到100个得分等于或高于观测分数的比对。", "answer": "$$\\boxed{100}$$", "id": "2387483"}, {"introduction": "一个常见的误解是认为比对的质量（由比特分反映）是E值的唯一决定因素。然而，E值同样受到搜索空间大小的深刻影响。通过分析一个比特分相同但E值不同的假想情景 ([@problem_id:2387487])，本练习揭示了数据库或查询序列的有效长度如何直接影响最终的统计显著性。", "problem": "两次使用基础局部比对搜索工具 (BLAST) 的独立搜索，对一个查询-靶标对产生了相同的比对结果，报告了相同的比特分数，但报告的期望值 (E-value) 在第一次搜索中为 $0.01$，在第二次搜索中为 $0.04$。假设 E 值的标准统计解释为在搜索空间中随机匹配到同样好或更好结果的期望数量，并且报告的比特分数在两次运行中是直接可比的，那么下列哪种搜索场景组合最能解释这种情况的发生？请选择所有适用的选项。\n\nA. 运行 $1$ 使用蛋白质-蛋白质搜索，针对一个总有效数据库长度为 $M$ 个残基的经过整理的子集；而运行 $2$ 使用相同的查询和评分方案，针对一个约有 $4M$ 个残基的数据库。比对质量相同，因此比特分数也相同，但运行 $2$ 中更大的搜索空间产生的 E 值大约大 $4$ 倍。\n\nB. 运行 $1$ 和运行 $2$ 使用相同的查询、相同的数据库和相同的有效搜索空间，但使用了不同的替换矩阵；因为矩阵不同，即使报告的比特分数相同，E 值也可能相差 $4$ 倍。\n\nC. 运行 $1$ 对查询序列应用了低复杂度区域屏蔽，使其有效查询长度约为未屏蔽长度的四分之一，而运行 $2$ 没有进行屏蔽；所有其他设置都相同，且比对区域与被屏蔽的片段不重叠，因此比特分数保持相同，但运行 $1$ 中小四倍的有效搜索空间产生的 E 值大约小 $4$ 倍。\n\nD. 运行 $1$ 是蛋白质-蛋白质搜索，运行 $2$ 是蛋白质对六框翻译核苷酸的搜索，两者都被构造成在有效数据库中具有相同总数的目标氨基酸残基；仅凭运行 $2$ 中六个阅读框的存在就足以解释 E 值大四倍，尽管搜索空间大小和比特分数相同。", "solution": "该问题描述了一种情况：两次独立的 Basic Local Alignment Search Tool (BLAST) 搜索产生了一个相同的比对，具有相同的比特分数 ($S'$)，但期望值 (E-value) 相差四倍。具体来说，$E_1 = 0.01$ 且 $E_2 = 0.04$。我们需要确定所提供的哪种情景可以解释这一观察结果。\n\nE 值 ($E$)、比特分数 ($S'$) 和搜索空间大小之间的基本关系由以下公式给出：\n$$E = m' n' 2^{-S'}$$\n其中 $m'$ 是查询序列的有效长度，而 $n'$ 是数据库的有效长度。乘积 $m'n'$ 构成了有效搜索空间的大小。\n\n题目给出两次运行的比特分数相同，即 $S'_1 = S'_2 = S'$。两次运行的 E 值分别为：\n$$E_1 = (m'n')_1 \\cdot 2^{-S'}$$\n$$E_2 = (m'n')_2 \\cdot 2^{-S'}$$\n此处，$(m'n')_1$ 和 $(m'n')_2$ 分别代表运行 $1$ 和运行 $2$ 的有效搜索空间大小。\n\n为了找到搜索空间之间的关系，我们计算 E 值的比率：\n$$\\frac{E_2}{E_1} = \\frac{(m'n')_2 \\cdot 2^{-S'}}{(m'n')_1 \\cdot 2^{-S'}}$$\n由于 $2^{-S'}$ 是一个公因子，它被消去，剩下：\n$$\\frac{E_2}{E_1} = \\frac{(m'n')_2}{(m'n')_1}$$\n代入给定的 E 值数值：\n$$\\frac{0.04}{0.01} = 4$$\n因此，要满足观察到的 E 值，必须满足的条件是运行 $2$ 的有效搜索空间必须是运行 $1$ 的有效搜索空间的四倍：\n$$\\frac{(m'n')_2}{(m'n')_1} = 4$$\n\n我们现在将根据这个推导出的条件来评估每个选项。\n\nA. 运行 $1$ 使用蛋白质-蛋白质搜索，针对一个总有效数据库长度为 $M$ 个残基的经过整理的子集；而运行 $2$ 使用相同的查询和评分方案，针对一个约有 $4M$ 个残基的数据库。比对质量相同，因此比特分数也相同，但运行 $2$ 中更大的搜索空间产生的 E 值大约大 $4$ 倍。\n\n在这种情景下，两次运行中的查询序列相同，因此有效查询长度 $m'$ 是恒定的。有效数据库长度分别为 $n'_1 \\approx M$ 和 $n'_2 \\approx 4M$。\n搜索空间大小的比率为：\n$$\\frac{(m'n')_2}{(m'n')_1} = \\frac{m' \\cdot n'_2}{m' \\cdot n'_1} \\approx \\frac{m' \\cdot (4M)}{m' \\cdot M} = 4$$\n这种情况完全符合所需条件。比特分数取决于比对和评分系统（替换矩阵和空位罚分），而不是数据库的大小。由于比对和评分方案相同，比特分数也会相同。数据库大小增加四倍直接导致 E 值增加四倍。\n结论：**正确**。\n\nB. 运行 $1$ 和运行 $2$ 使用相同的查询、相同的数据库和相同的有效搜索空间，但使用了不同的替换矩阵；因为矩阵不同，即使报告的比特分数相同，E 值也可能相差 $4$ 倍。\n\n这个说法从根本上就是错误的。如果有效搜索空间 ($m'n'$) 和比特分数 ($S'$) 都相同，那么根据公式 $E = m'n' \\cdot 2^{-S'}$ 计算出的 E 值也必须相同。在这些条件下 E 值可能不同的前提，直接与统计模型相矛盾。虽然不同的替换矩阵确实有不同的统计参数（$K$ 和 $\\lambda$），但比特分数 $S' = (\\lambda S - \\ln K) / \\ln 2$ 是专门设计成一个归一化分数，以便在不同评分系统之间进行比较。使用不同的矩阵对相同的比对得到完全相同的比特分数已经是非常不可能的了，但即使我们接受这个前提，如果搜索空间也相同，那么 E 值会不同的结论在数学上是不可能的。\n结论：**不正确**。\n\nC. 运行 $1$ 对查询序列应用了低复杂度区域屏蔽，使其有效查询长度约为未屏蔽长度的四分之一，而运行 $2$ 没有进行屏蔽；所有其他设置都相同，且比对区域与被屏蔽的片段不重叠，因此比特分数保持相同，但运行 $1$ 中小四倍的有效搜索空间产生的 E 值大约小 $4$ 倍。\n\n在这种情景下，两次运行的数据库相同，因此有效数据库长度 $n'$ 是恒定的。运行 $2$ 使用完整的、未屏蔽的查询序列，其有效查询长度为 $m'_2$。运行 $1$ 使用了被屏蔽的查询序列，其有效长度减少到四分之一，因此 $m'_1 \\approx m'_2 / 4$。搜索空间大小的比率为：\n$$\\frac{(m'n')_2}{(m'n')_1} = \\frac{m'_2 \\cdot n'}{m'_1 \\cdot n'} \\approx \\frac{m'_2 \\cdot n'}{(m'_2 / 4) \\cdot n'} = 4$$\n这种情况也符合所需条件。题目说明比特分数是针对一个未被屏蔽区域的比对。局部比对的比特分数与决定 E 值的总序列长度无关，因此比特分数相同是合理的。运行 $1$ 的有效查询长度减少四倍，导致其 E 值比运行 $2$ 小四倍。\n结论：**正确**。\n\nD. 运行 $1$ 是蛋白质-蛋白质搜索，运行 $2$ 是蛋白质对六框翻译核苷酸的搜索，两者都被构造成在有效数据库中具有相同总数的目标氨基酸残基；仅凭运行 $2$ 中六个阅读框的存在就足以解释 E 值大四倍，尽管搜索空间大小和比特分数相同。\n\n该选项明确指出，两次运行中“有效数据库中的目标氨基酸残基总数”是相同的。这意味着 $n'_1 = n'_2$。由于查询是同一个蛋白质，所以 $m'_1 = m'_2$。因此，有效搜索空间的大小是相同的：$(m'n')_1 = (m'n')_2$。鉴于比特分数也相同 ($S'_1 = S'_2$)，根据 $E = m'n' \\cdot 2^{-S'}$，E 值必须相同。声称“仅凭运行 $2$ 中存在六个阅读框”就足以证明 E 值不同，这是对 BLAST 统计学的误解。六框翻译的影响已经计入总有效数据库长度 $n'$ 的计算中。如果这个长度与蛋白质-蛋白质搜索中的长度相同，则不存在额外的临时校正因子。这种情况与观察到的 E 值差异不符。\n结论：**不正确**。", "answer": "$$\\boxed{AC}$$", "id": "2387487"}, {"introduction": "在解释BLAST结果时，初学者常常会过度依赖于序列的百分比一致性。本练习提出了一个经典的对比场景 ([@problem_id:2387464])，旨在说明为何一个长但仅有部分匹配的比对可能远比一个短的完美匹配更具统计学意义。这有助于你建立一个更深刻的理解：比对的累积得分和长度，而非简单的匹配率，才是决定其生物学相关性的关键。", "problem": "一位研究人员使用基本局部比对搜索工具（BLAST）对一个综合蛋白质数据库进行蛋白质搜索，观察到以下两个局部比对结果：(i) 在一个目标序列中出现一个长度为 $6$ 个氨基酸的完全匹配，其期望值（E-value）报告为 $E>1$，以及 (ii) 一个长度为 $50$ 个氨基酸、约有 $30\\%$ 残基相同且有空位的局部比对，其报告的 $E  10^{-10}$。以下哪个选项最能解释为什么更长、同源性更低的比对在统计上可能远比短的完全匹配更显著？\n\nA. 期望值（E-value）定义为在整个数据库中，偶然出现得分不低于观测得分的比对的预期数量；在一个大型蛋白质数据库中，长度为 $6$ 的短完全匹配片段预计会偶然出现多次，而一个 $50$ 个残基的比对可以累积得到高得多的比对分数（即使只有 $30\\%$ 的同源性），因此在极值分布下，其出现的概率呈指数级降低，从而得到一个非常小的 $E$ 值。\n\nB. 期望值（E-value）仅仅是同源性百分比的转换，因此较低的同源性百分比（例如 $30\\%$）总是意味着比高的同源性百分比（例如 $6$ 个残基的 $100\\%$）有更小的 $E$ 值，而无论比对长度或数据库大小如何。\n\nC. 无论其他因素如何，空位总是会降低期望值（E-value），因此任何有空位的比对本质上都比任何没有空位的完全匹配更具统计显著性。\n\nD. 大于 $1$ 的期望值（E-value）必然表示打分矩阵失效；选择一个不同的替换矩阵会自动使任何完全匹配（即使长度为 $6$）都比任何更长、同源性更低的比对更显著。\n\nE. 短的完全匹配被降权仅仅是因为低复杂性区域屏蔽，而较长的比对逃脱了这种过滤，因此后者总是更显著，与数据库大小或打分考量无关。", "solution": "问题陈述在科学上是有效的。它描述了生物信息学中一个关于序列比对统计显著性的经典且基本的情景，这是一个基于既定原则的恰当问题。所提供的数据对于从基本局部比对搜索工具（BLAST）搜索中获得的结果是符合实际的。因此，我们可以进行全面分析。\n\n核心概念是期望值，即“$E$”值，它量化了局部比对的统计显著性。$E$值表示在给定大小的数据库中，偶然出现的得分不低于观测得分的比对的预期数量。较小的$E$值表示统计上更显著的比对，意味着它不太可能是随机偶然的产物。\n\n局部比对的分数，用$S$表示，是根据替换矩阵（例如，BLOSUM62）和空位罚分计算的。对于一个长度为$m$的查询序列和一个总长度为$n$的数据库之间的比对，“$E$”值由以下公式给出：\n$$ E = Kmn e^{-\\lambda S} $$\n此处，$K$和$\\lambda$是统计参数，它们是打分系统（所使用的特定替换矩阵和空位罚分）和背景氨基酸分布的特征。该方程揭示了$E$值的关键依赖关系：\n1. 它与搜索空间的大小成正比，由乘积$mn$表示。更大的数据库或更长的查询序列会增加偶然发现匹配的概率。\n2. 它随着比对分数$S$的增加呈指数级下降。这种指数关系是实现高统计显著性的最关键因素。\n\n让我们分析问题中描述的两个结果：\n\n(i) 长度为 $6$ 个氨基酸的完全匹配，其$E > 1$：\n一个仅有$6$个残基的完全匹配会产生一个相对较低的比对分数$S$。虽然同源性百分比为$100\\%$，但其短小的长度几乎没有机会累积高分。例如，使用BLOSUM62矩阵，像`METALA`这样的肽的分数将是$5+5+1+4+1+4 = 20$。让我们假设原始分数为$S_{short}$。考虑到一个综合蛋白质数据库，搜索空间$mn$非常大（通常是数十亿个残基）。在公式$E = Kmn e^{-\\lambda S_{short}}$中，当$S_{short}$很小时，较大的$mn$项会主导$e^{-\\lambda S_{short}}$项。因此，$E$值很大（本例中$E > 1$），表明预期会纯粹由于偶然出现一个或多个这样的匹配。因此，该结果在统计上不显著。\n\n(ii) 长度为 $50$ 个氨基酸、$30\\%$同源性且$E  10^{-10}$的有空位比对：\n这个比对要长得多。尽管同源性百分比较低（$30\\%$），但比对分数$S_{long}$是在所有$50$个位置上计算的。这包括来自$30\\% \\times 50 = 15$个相同残基的正分，可能来自其他$35$个位置中保守替换的正分，以及来自非保守替换和空位罚分的负分。在很长的片段上，即使是微弱但一致的相关性信号也可以累积成一个非常大的总分$S_{long}$，使得$S_{long} \\gg S_{short}$。由于$E$值公式中的指数项$e^{-\\lambda S}$，一个大的分数$S_{long}$会导致一个指数级小的（因此非常显著的）$E$值。$E  10^{-10}$这个值表明观测到的比对极不可能是偶然发生的。\n\n核心原则是，比对长度提供了统计能力，用以区分一个真实的（尽管是遥远的）同源关系和随机背景噪音。\n\n现在，我们来评估每个选项：\n\nA. 期望值（E-value）定义为在整个数据库中，偶然出现得分不低于观测得分的比对的预期数量；在一个大型蛋白质数据库中，长度为 $6$ 的短完全匹配片段预计会偶然出现多次，而一个 $50$ 个残基的比对可以累积得到高得多的比对分数（即使只有 $30\\%$ 的同源性），因此在极值分布下，其出现的概率呈指数级降低，从而得到一个非常小的 $E$ 值。\n这个陈述是一个精确而完整的解释。它正确地定义了$E$值。它准确地描述了为什么一个短的6-mer的$E$值很差（低分无法克服巨大的搜索空间，使其成为统计上预期的随机事件）。它正确地指出，一个$50$个残基的长比对可以累积得到高得多的分数，由于统计的指数性质（基于局部比对分数的极值分布），这会导致一个非常小的$E$值。\n结论：**正确**。\n\nB. 期望值（E-value）仅仅是同源性百分比的转换，因此较低的同源性百分比（例如 $30\\%$）总是意味着比高的同源性百分比（例如 $100\\%$ over $6$ residues）有更小的 $E$ 值，而无论比对长度或数据库大小如何。\n这个陈述有根本性缺陷。$E$值不是同源性百分比的简单转换；它是比对分数$S$和搜索空间大小$mn$的函数。比对长度是一个关键因素，正如问题本身所示。一个$100\\%$同源性的短比对可能不显著，而一个低同源性的长比对可能非常显著。声称较低的同源性百分比*总是*意味着较小的$E$值是错误的，忽略比对长度和数据库大小是一个严重的错误。\n结论：**不正确**。\n\nC. 无论其他因素如何，空位总是会降低期望值（E-value），因此任何有空位的比对本质上都比任何没有空位的完全匹配更具统计显著性。\n这个陈述在逻辑上是颠倒的。空位会受到罚分，这意味着它们会*降低*比对分数$S$。根据公式$E = Kmn e^{-\\lambda S}$，$S$的降低会导致$E$值的*增加*，使比对的显著性降低。引入空位是为了允许一个更好的整体比对路径，从而得到比其他方式可能获得的更高的分数，但空位本身对分数是有害的。声称任何有空位的比对都比任何没有空位的比对本质上更显著，这显然是错误的。\n结论：**不正确**。\n\nD. 大于 $1$ 的期望值（E-value）必然表示打分矩阵失效；选择一个不同的替换矩阵会自动使任何完全匹配（即使长度为 $6$）都比任何更长、同源性更低的比对更显著。\n这个陈述是不正确的。大于$1$的$E$值并不表示打分矩阵“失效”。相反，它表明统计框架正在正确工作，将一个比对标记为与随机偶然一致。没有哪个标准替换矩阵能够“自动”使一个短的、低分的匹配比一个长的、高分的匹配更显著，因为这将违反序列比较的统计原则。统计显著性从根本上与比对的信息内容（反映在其分数中）相关，而对于短匹配来说，信息内容很低。\n结论：**不正确**。\n\nE. 短的完全匹配被降权仅仅是因为低复杂性区域屏蔽，而较长的比对逃脱了这种过滤，因此后者总是更显著，与数据库大小或打分考量无关。\n这个解释既不充分也不完整。低复杂性区域屏蔽是针对具有偏向性组成区域（例如，多聚丙氨酸序列）的特定过滤器，它可能适用于也可能不适用于给定的$6$个残基的匹配。任何短匹配显著性低下的根本原因在于其相对于数据库大小的潜在分数较低，这一原则即使对非低复杂性序列也适用。此外，声称显著性“与数据库大小或打分考量无关”显然是错误的；这些正是$E$值的主要决定因素。\n结论：**不正确**。", "answer": "$$\\boxed{A}$$", "id": "2387464"}]}