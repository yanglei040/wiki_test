{"hands_on_practices": [{"introduction": "在深入研究复杂的模拟计算之前，理解自由能与实验可观测量之间的基本关系至关重要。本练习将理论与实践联系起来，要求您直接根据实验测得的解离常数（$K_d$）计算结合自由能的变化（$\\Delta\\Delta G^\\circ$），这是药物发现和分子生物学中的一项常见任务。[@problem_id:2112182]", "problem": "在一种新型抗生素的研发过程中，一名研究人员正在研究它与一种关键细菌酶的相互作用。该酶的野生型与抗生素结合的解离常数 $K_{d, \\text{WT}}$ 为 $1.0 \\times 10^{-6}$ M。发现一种该细菌的耐药菌株，其携带的这种酶有一个单点突变。生物化学分析显示，这种突变酶与同一种抗生素的结合亲和力显著减弱，其特征解离常数 $K_{d, \\text{MUT}}$ 为 $5.0 \\times 10^{-5}$ M。\n\n计算由该单点突变引起的结合标准吉布斯自由能的变化，其定义为 $\\Delta \\Delta G^\\circ = \\Delta G^\\circ_{\\text{MUTANT}} - \\Delta G^\\circ_{\\text{WILD-TYPE}}$。\n\n假设测量在标准温度 $298$ K下进行。使用理想气体常数值 $R = 8.314 \\text{ J} \\cdot \\text{mol}^{-1} \\cdot \\text{K}^{-1}$。最终答案以 kJ/mol 为单位，并四舍五入至三位有效数字。", "solution": "结合标准吉布斯自由能 $\\Delta G^\\circ$ 与结合过程平衡常数之间的关系是热力学的一个基本原理。对于一个结合反应，平衡常数是结合常数 $K_a$。方程为：\n$$ \\Delta G^\\circ = -RT \\ln K_a $$\n其中 $R$ 是理想气体常数，$T$ 是绝对温度。\n\n题目给出了离解常数 $K_d$，它是结合常数 $K_a$ 的倒数。\n$$ K_d = \\frac{1}{K_a} $$\n将此关系代入自由能方程，我们得到用 $K_d$ 表示 $\\Delta G^\\circ$ 的表达式：\n$$ \\Delta G^\\circ = -RT \\ln\\left(\\frac{1}{K_d}\\right) $$\n利用对数性质 $\\ln(1/x) = -\\ln(x)$，我们可以将方程简化为：\n$$ \\Delta G^\\circ = RT \\ln K_d $$\n该方程适用于野生型（WT）和突变型（MUT）酶-抗生素的相互作用。\n\n对于野生型酶，结合标准吉布斯自由能为：\n$$ \\Delta G^\\circ_{\\text{WILD-TYPE}} = RT \\ln K_{d, \\text{WT}} $$\n\n对于突变酶，结合标准吉布斯自由能为：\n$$ \\Delta G^\\circ_{\\text{MUTANT}} = RT \\ln K_{d, \\text{MUT}} $$\n\n题目要求计算结合标准吉布斯自由能的变化 $\\Delta \\Delta G^\\circ$，其定义为突变型和野生型结合自由能之差：\n$$ \\Delta \\Delta G^\\circ = \\Delta G^\\circ_{\\text{MUTANT}} - \\Delta G^\\circ_{\\text{WILD-TYPE}} $$\n代入每一项 $\\Delta G^\\circ$ 的表达式：\n$$ \\Delta \\Delta G^\\circ = (RT \\ln K_{d, \\text{MUT}}) - (RT \\ln K_{d, \\text{WT}}) $$\n我们可以提出公因式 $RT$：\n$$ \\Delta \\Delta G^\\circ = RT (\\ln K_{d, \\text{MUT}} - \\ln K_{d, \\text{WT}}) $$\n利用对数性质 $\\ln(a) - \\ln(b) = \\ln(a/b)$，我们得到 $\\Delta \\Delta G^\\circ$ 的最终符号表达式：\n$$ \\Delta \\Delta G^\\circ = RT \\ln\\left(\\frac{K_{d, \\text{MUT}}}{K_{d, \\text{WT}}}\\right) $$\n\n现在，我们可以将给定的数值代入此表达式。\n各常数为：\n$R = 8.314 \\text{ J} \\cdot \\text{mol}^{-1} \\cdot \\text{K}^{-1}$\n$T = 298 \\text{ K}$\n\n解离常数为：\n$K_{d, \\text{WT}} = 1.0 \\times 10^{-6} \\text{ M}$\n$K_{d, \\text{MUT}} = 5.0 \\times 10^{-5} \\text{ M}$\n\n首先，计算解离常数的比值。注意单位 (M) 将会相消，留下一个无量纲的数字，这是对数的自变量所要求的。\n$$ \\frac{K_{d, \\text{MUT}}}{K_{d, \\text{WT}}} = \\frac{5.0 \\times 10^{-5} \\text{ M}}{1.0 \\times 10^{-6} \\text{ M}} = 50 $$\n\n现在，将此比值和各常数代入 $\\Delta \\Delta G^\\circ$ 的方程中：\n$$ \\Delta \\Delta G^\\circ = (8.314 \\text{ J} \\cdot \\text{mol}^{-1} \\cdot \\text{K}^{-1}) \\times (298 \\text{ K}) \\times \\ln(50) $$\n计算 $R$ 和 $T$ 的乘积：\n$$ RT = 8.314 \\times 298 \\approx 2477.572 \\text{ J/mol} $$\n计算 50 的自然对数：\n$$ \\ln(50) \\approx 3.912023 $$\n现在，将这些值相乘，求得以 J/mol 为单位的 $\\Delta \\Delta G^\\circ$：\n$$ \\Delta \\Delta G^\\circ \\approx 2477.572 \\text{ J/mol} \\times 3.912023 \\approx 9692.23 \\text{ J/mol} $$\n\n题目要求答案以 kJ/mol 为单位。要从 J/mol 转换为 kJ/mol，我们需除以 1000：\n$$ \\Delta \\Delta G^\\circ \\approx \\frac{9692.23}{1000} \\text{ kJ/mol} \\approx 9.69223 \\text{ kJ/mol} $$\n最后，我们必须按要求将答案四舍五入到三位有效数字：\n$$ \\Delta \\Delta G^\\circ \\approx 9.69 \\text{ kJ/mol} $$\n正值表明突变酶的结合更不利（被去稳定化），这与其较高的解离常数相符。", "answer": "$$\\boxed{9.69}$$", "id": "2112182"}, {"introduction": "计算生物学中的一个核心挑战是如何模拟溶剂（尤其是水）的效应。本练习将指导您构建一个简化但富有启发性的疏水效应模型，这是蛋白质折叠和配体结合的主要驱动力之一。您将通过结合两个甲烷分子的直接 Lennard-Jones 相互作用和基于溶剂可及表面积的溶剂化项，来计算它们之间的平均力势（PMF），从而亲身体验如何估算溶剂化自由能。[@problem_id:2455815]", "problem": "要求您计算液态水中两个甲烷分子缔合的自由能，该自由能是其中心间距的函数。将每个甲烷分子模拟为其中心位置的单个Lennard–Jones (LJ) 位点，并将其视为用于溶剂暴露的硬球。假设环境条件，并使用以下定义和参数。\n\n定义和物理模型：\n- 在分离距离 $r$ 处的平均力势 (PMF)，记作 $\\Delta G(r)$，被建模为直接对相互作用与溶剂项之和，该溶剂项源于溶剂可及表面积 (SASA) 相对于无限分离时的变化：\n  - 直接对相互作用：$12$–$6$ Lennard-Jones 势 $U_{\\mathrm{LJ}}(r)$，其参数如下所述。\n  - 溶剂项：自由能贡献与两个溶剂可及球体并集的 SASA 减去无限分离时的 SASA 成正比。设溶剂可及半径为 $R_{\\mathrm{SASA}} = a + r_{\\mathrm{p}}$，其中 $a$ 是甲烷硬球半径，$r_{\\mathrm{p}}$ 是溶剂探针半径。SASA 取为几何表面积（无曲率校正）。对于 $r \\ge 2 R_{\\mathrm{SASA}}$，球体不重叠，并集的 SASA 等于两个独立 SASA 之和。\n- 使用水的表面张力将 SASA 的变化转换为自由能。将表面张力 $\\gamma$ 视为单位面积的能量。\n\n使用的参数和常数：\n- 甲烷硬球半径：$a = 2.0\\ \\mathrm{\\AA}$。\n- 溶剂探针半径：$r_{\\mathrm{p}} = 1.4\\ \\mathrm{\\AA}$。\n- Lennard-Jones 尺寸参数：$\\sigma = 3.73\\ \\mathrm{\\AA}$。\n- Lennard-Jones 势阱深度以温度形式给出：$\\epsilon / k_{\\mathrm{B}} = 148\\ \\mathrm{K}$。使用摩尔气体常数 $R = 8.314462618 \\times 10^{-3}\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$ 将其转换为以 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$ 为单位的 $\\epsilon$。\n- 水的表面张力：$\\gamma_{\\mathrm{water}} = 0.072\\ \\mathrm{J}\\,\\mathrm{m}^{-2}$。使用阿伏伽德罗常数 $N_{\\mathrm{A}} = 6.02214076 \\times 10^{23}\\ \\mathrm{mol}^{-1}$ 和 $1\\ \\mathrm{m}^{2} = 10^{20}\\ \\mathrm{\\AA}^{2}$ 将其转换为 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{\\AA}^{-2}$。\n\n需要实现的数学要求：\n- 使用标准的 $12$–$6$ Lennard-Jones 势 $U_{\\mathrm{LJ}}(r) = 4 \\epsilon [(\\frac{\\sigma}{r})^{12} - (\\frac{\\sigma}{r})^{6}]$。\n- 令 $A_{\\mathrm{union}}(r)$ 为两个半径为 $R_{\\mathrm{SASA}}$、中心相距为 $r$ 的球体并集的表面积。计算溶剂自由能贡献为 $\\Delta G_{\\mathrm{solv}}(r) = \\gamma (A_{\\mathrm{union}}(r) - 8\\pi R_{\\mathrm{SASA}}^{2})$，当 $r \\ge 2 R_{\\mathrm{SASA}}$ 时该值为零，当球体交叠时为负值。则 PMF 为 $\\Delta G(r) = U_{\\mathrm{LJ}}(r) + \\Delta G_{\\mathrm{solv}}(r)$。\n- 所有能量必须以 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$ 表示。所有距离均以 $\\mathrm{\\AA}$ 表示。\n\n测试组：\n使用上述参数值，按此精确顺序计算以下分离距离（均以 $\\mathrm{\\AA}$ 为单位）的 $\\Delta G(r)$：\n- $r_{1} = 12.0$\n- $r_{2} = 6.8$\n- $r_{3} = 5.0$\n- $r_{4} = 4.186$\n- $r_{5} = 3.5$\n\n答案规格：\n- 对于每个测试距离，输出一个浮点数值，该值等于以 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$ 为单位的 $\\Delta G(r)$，并四舍五入到六位小数。\n- 您的程序应生成单行输出，其中包含以方括号括起来的逗号分隔列表形式的结果（例如，$\\left[ \\text{result}_{1}, \\text{result}_{2}, \\ldots \\right]$，但没有空格）。", "solution": "问题陈述已经过分析，并被确定为有效。它具有科学依据、问题明确、客观，并包含推导唯一解所需的所有必要信息。所提供的模型是计算化学中用于估算内隐溶剂中缔合自由能的一种简化但标准的方法。我们现在将进行正式求解。\n\n该问题要求计算水中两个甲烷分子缔合的平均力势 (PMF)，即 $\\Delta G(r)$，作为其分离距离 $r$ 的函数。PMF 被建模为两个贡献项之和：两个分子之间的直接相互作用势 $U_{\\mathrm{LJ}}(r)$，以及与溶剂重排相关的自由能变化 $\\Delta G_{\\mathrm{solv}}(r)$。\n$$\n\\Delta G(r) = U_{\\mathrm{LJ}}(r) + \\Delta G_{\\mathrm{solv}}(r)\n$$\n所有能量必须以 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$ 为单位，距离以 $\\mathrm{\\AA}$ 为单位。\n\n首先，我们必须建立一套单位一致的参数和常数。\nLennard-Jones 势阱深度 $\\epsilon$ 以温度形式给出，$\\epsilon / k_{\\mathrm{B}} = 148\\ \\mathrm{K}$。使用摩尔气体常数 $R = N_{\\mathrm{A}} k_{\\mathrm{B}} = 8.314462618 \\times 10^{-3}\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$，我们将 $\\epsilon$ 转换为摩尔能量：\n$$\n\\epsilon = \\left(\\frac{\\epsilon}{k_{\\mathrm{B}}}\\right) \\times R = 148\\ \\mathrm{K} \\times 8.314462618 \\times 10^{-3}\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1} \\approx 1.230538\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}\n$$\nLennard-Jones 尺寸参数为 $\\sigma = 3.73\\ \\mathrm{\\AA}$。\n\n与溶剂相关的项取决于水的表面张力，$\\gamma_{\\mathrm{water}} = 0.072\\ \\mathrm{J}\\,\\mathrm{m}^{-2}$。我们必须使用阿伏伽德罗常数 $N_{\\mathrm{A}} = 6.02214076 \\times 10^{23}\\ \\mathrm{mol}^{-1}$ 以及换算关系 $1\\ \\mathrm{kJ} = 1000\\ \\mathrm{J}$ 和 $1\\ \\mathrm{m} = 10^{10}\\ \\mathrm{\\AA}$ 将其转换为 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{\\AA}^{-2}$ 单位：\n$$\n\\gamma = 0.072\\ \\frac{\\mathrm{J}}{\\mathrm{m}^2} \\times \\frac{10^{-3}\\ \\mathrm{kJ}}{1\\ \\mathrm{J}} \\times \\left(\\frac{1\\ \\mathrm{m}}{10^{10}\\ \\mathrm{\\AA}}\\right)^2 \\times N_{\\mathrm{A}}\\ \\mathrm{mol}^{-1}\n$$\n$$\n\\gamma = 0.072 \\times 10^{-3} \\times 10^{-20} \\times 6.02214076 \\times 10^{23}\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{\\AA}^{-2} \\approx 0.433594\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{\\AA}^{-2}\n$$\n溶剂可及半径 $R_{\\mathrm{SASA}}$ 是甲烷硬球半径 $a = 2.0\\ \\mathrm{\\AA}$ 和溶剂探针半径 $r_{\\mathrm{p}} = 1.4\\ \\mathrm{\\AA}$ 的和：\n$$\nR_{\\mathrm{SASA}} = a + r_{\\mathrm{p}} = 2.0\\ \\mathrm{\\AA} + 1.4\\ \\mathrm{\\AA} = 3.4\\ \\mathrm{\\AA}\n$$\n直接相互作用由 $12$-$6$ Lennard-Jones 势给出：\n$$\nU_{\\mathrm{LJ}}(r) = 4\\epsilon \\left[ \\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^{6} \\right]\n$$\n溶剂化自由能 $\\Delta G_{\\mathrm{solv}}(r)$ 与溶剂可及表面积 (SASA) 相对于无限分离时的变化成正比。对于两个半径为 $R = R_{\\mathrm{SASA}}$ 的球体从无限远处移动到分离距离为 $r$ 时，SASA 的变化 $\\Delta A(r)$ 仅在它们重叠时（即当 $r  2R$ 时）非零。对于 $r \\ge 2R$，球体不重叠，$\\Delta A(r) = 0$。\n对于 $r  2R$，两个球体并集的表面积小于它们各自面积之和。两个相同球体并集的面积由 $A_{\\mathrm{union}}(r) = 4\\pi R^2 + 2\\pi R r$ 给出。两个独立球体的总面积是 $2 \\times 4\\pi R^2 = 8\\pi R^2$。因此，面积的变化为：\n$$\n\\Delta A(r) = A_{\\mathrm{union}}(r) - 8\\pi R^2 = (4\\pi R^2 + 2\\pi R r) - 8\\pi R^2 = 2\\pi R r - 4\\pi R^2 = 2\\pi R (r - 2R)\n$$\n这个变化是负值，代表了在络合过程中被“埋藏”的面积。\n溶剂化自由能则为：\n$$\n\\Delta G_{\\mathrm{solv}}(r) = \\gamma \\times \\Delta A(r) = \\begin{cases} \\gamma \\left[ 2\\pi R_{\\mathrm{SASA}} (r - 2R_{\\mathrm{SASA}}) \\right]  \\text{如果 } r  2R_{\\mathrm{SASA}} \\\\ 0  \\text{如果 } r \\ge 2R_{\\mathrm{SASA}} \\end{cases}\n$$\n此处，$2R_{\\mathrm{SASA}} = 2 \\times 3.4\\ \\mathrm{\\AA} = 6.8\\ \\mathrm{\\AA}$。\n\n结合这些项，PMF 的完整表达式为：\n$$\n\\Delta G(r) = 4\\epsilon \\left[ \\left(\\frac{\\sigma}{r}\\right)^{12} - \\left(\\frac{\\sigma}{r}\\right)^{6} \\right] + \\begin{cases} \\gamma \\left[ 2\\pi R_{\\mathrm{SASA}} (r - 2R_{\\mathrm{SASA}}) \\right]  \\text{如果 } r  6.8\\ \\mathrm{\\AA} \\\\ 0  \\text{如果 } r \\ge 6.8\\ \\mathrm{\\AA} \\end{cases}\n$$\n我们现在将实现这些公式，以计算指定距离 $r \\in \\{12.0, 6.8, 5.0, 4.186, 3.5\\}\\ \\mathrm{\\AA}$ 处的 $\\Delta G(r)$。计算将以编程方式执行，使用高精度的派生常数。\n例如，对于 $r=5.0\\ \\mathrm{\\AA}$：\n由于 $r=5.0  6.8$，两个项都有贡献。\n$U_{\\mathrm{LJ}}(5.0) = 4(1.230538) \\left[ \\left(\\frac{3.73}{5.0}\\right)^{12} - \\left(\\frac{3.73}{5.0}\\right)^{6} \\right] \\approx -0.700624\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$。\n$\\Delta G_{\\mathrm{solv}}(5.0) = (0.433594) \\left[ 2\\pi (3.4) (5.0 - 6.8) \\right] \\approx -16.674458\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$。\n$\\Delta G(5.0) = -0.700624 - 16.674458 = -17.375082\\ \\mathrm{kJ}\\,\\mathrm{mol}^{-1}$。\n最终的代码将把此逻辑应用于所有测试用例，并按规定格式化输出。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the free energy of association for two methane molecules\n    in liquid water as a function of their separation distance.\n    \"\"\"\n\n    # Define parameters and constants\n    A_RADIUS = 2.0  # Methane hard-sphere radius, Angstrom\n    R_PROBE = 1.4  # Solvent probe radius, Angstrom\n    SIGMA = 3.73  # Lennard-Jones size parameter, Angstrom\n    EPSILON_OVER_KB = 148.0  # Lennard-Jones well depth, K\n    R_GAS_CONSTANT = 8.314462618e-3  # Molar gas constant, kJ mol^-1 K^-1\n    GAMMA_WATER = 0.072  # Water surface tension, J m^-2\n    NA_AVOGADRO = 6.02214076e23  # Avogadro's constant, mol^-1\n    M2_TO_A2 = 1e20  # Conversion from m^2 to Angstrom^2\n\n    # Calculate derived parameters in consistent units (kJ, mol, Angstrom)\n    # Solvent-accessible radius\n    r_sasa = A_RADIUS + R_PROBE  # Angstrom\n\n    # Lennard-Jones well depth in kJ/mol\n    epsilon = EPSILON_OVER_KB * R_GAS_CONSTANT  # kJ/mol\n\n    # Surface tension in kJ mol^-1 Angstrom^-2\n    # gamma [J/m^2] * (1e-3 kJ/J) * (1/1e20 m^2/A^2) * N_A [mol^-1]\n    gamma = GAMMA_WATER * 1e-3 / M2_TO_A2 * NA_AVOGADRO\n\n    # Test cases for separation distance r in Angstrom\n    test_cases = [12.0, 6.8, 5.0, 4.186, 3.5]\n\n    results = []\n    \n    # The critical distance for solvent sphere overlap is 2 * r_sasa\n    overlap_distance = 2.0 * r_sasa\n\n    def calculate_pmf(r, epsilon_val, sigma_val, gamma_val, r_sasa_val, overlap_dist_val):\n        \"\"\"Calculates the Potential of Mean Force (PMF) delta_G(r).\"\"\"\n        \n        # 1. Direct pair interaction: Lennard-Jones potential\n        sr6 = (sigma_val / r) ** 6\n        sr12 = sr6 ** 2\n        u_lj = 4.0 * epsilon_val * (sr12 - sr6)\n\n        # 2. Solvent term: Free energy from SASA change\n        delta_g_solv = 0.0\n        if r  overlap_dist_val:\n            # Change in surface area for two overlapping spheres\n            delta_area = 2.0 * np.pi * r_sasa_val * (r - overlap_dist_val)\n            delta_g_solv = gamma_val * delta_area\n        \n        # 3. Total PMF\n        delta_g_total = u_lj + delta_g_solv\n        return delta_g_total\n\n    for r_dist in test_cases:\n        pmf_value = calculate_pmf(r_dist, epsilon, SIGMA, gamma, r_sasa, overlap_distance)\n        results.append(pmf_value)\n\n    # Format the results to six decimal places for the final output\n    formatted_results = [f\"{res:.6f}\" for res in results]\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2455815"}, {"introduction": "现代自由能计算依赖于严谨的统计方法从分子模拟中提取信息。这项高级练习介绍了 Bennett 接受率（BAR）方法，这是一种功能强大且广泛用于高精度计算自由能差异的技术。通过实现 BAR 方程来分析预先生成的模拟数据，您将学会如何确定药物对野生型蛋白及其突变体的相对结合亲和力，这是理解耐药性和指导蛋白质工程的关键任务。[@problem_id:2455727]", "problem": "给定来自两个热力学状态的离散样本，这两个状态代表了野生型蛋白质（状态 $0$）和突变蛋白质（状态 $1$）之间的炼金术转换。对于每个热力学环境（结合复合物以及溶剂中的未结合配体），都提供了两个无量纲约化势能差的列表。对于一个构象 $\\mathbf{x}$，该值定义为 $\\Delta u(\\mathbf{x}) = \\beta \\left[ U_1(\\mathbf{x}) - U_0(\\mathbf{x}) \\right]$，其中 $\\beta = 1/(k_B T)$，$U_0$ 和 $U_1$ 分别是状态 $0$ 和状态 $1$ 的势能，$k_B$ 是玻尔兹曼常数，$T$ 是绝对温度。一个列表 $\\{\\Delta u_i^{(0)}\\}_{i=1}^{n_0}$ 包含从状态 $0$ 中采样的构象计算出的值（每个元素是 $\\Delta u(\\mathbf{x}_i)$，其中 $\\mathbf{x}_i \\sim \\pi_0$），另一个列表 $\\{\\Delta u_j^{(1)}\\}_{j=1}^{n_1}$ 包含从状态 $1$ 中采样的构象计算出的值（每个元素是 $\\Delta u(\\mathbf{y}_j)$，其中 $\\mathbf{y}_j \\sim \\pi_1$）。状态 $1$ 和状态 $0$ 之间的无量纲自由能差 $\\Delta f$ 被定义为满足以下隐式方程的唯一实数\n$$\n\\sum_{i=1}^{n_0} \\frac{1}{1 + \\exp\\!\\left(\\Delta u_i^{(0)} - \\Delta f - \\ln\\!\\frac{n_1}{n_0}\\right)}\n=\n\\sum_{j=1}^{n_1} \\frac{1}{1 + \\exp\\!\\left(-\\Delta u_j^{(1)} + \\Delta f - \\ln\\!\\frac{n_1}{n_0}\\right)}.\n$$\n对于每个环境（结合态和非结合态），从相应的列表对中计算 $\\Delta f$。突变相对于野生型的结合自由能变化，记作 $\\Delta\\Delta G_{\\text{bind}}$，则由下式给出：\n$$\n\\Delta\\Delta G_{\\text{bind}} = \\left( \\Delta f_{\\text{bound}} - \\Delta f_{\\text{unbound}} \\right) \\, k_B T N_A,\n$$\n其中 $N_A$ 是 Avogadro's number。以千焦/摩尔（kJ/mol）为单位表示 $\\Delta\\Delta G_{\\text{bind}}$。使用 $k_B = 1.380\\,649 \\times 10^{-23}$ 焦耳/开尔文，$N_A = 6.022\\,140\\,76 \\times 10^{23}$ /摩尔，以及每个测试用例中指定的温度 $T$。注意 $k_B T N_A = R T$，其中 $R$ 是摩尔气体常数。\n\n你的程序必须为以下每个测试用例评估 $\\Delta\\Delta G_{\\text{bind}}$，并输出一行包含三个结果的逗号分隔列表，并用方括号括起来。每个结果必须四舍五入到恰好三位小数，单位为 kJ/mol。\n\n测试套件：\n- 案例 1（理想路径，中等重叠）：\n  - 温度：$T = 300$ K。\n  - 结合环境：\n    - $\\{\\Delta u_i^{(0)}\\}_{\\text{bound}} = [\\,-1.2,\\,-0.8,\\,-1.0,\\,-1.1,\\,-0.9,\\,-1.3,\\,-0.7,\\,-1.0\\,]$\n    - $\\{\\Delta u_j^{(1)}\\}_{\\text{bound}} = [\\,-0.4,\\,-0.6,\\,-0.5,\\,-0.7,\\,-0.8,\\,-0.3,\\,-0.6,\\,-0.5\\,]$\n  - 非结合环境：\n    - $\\{\\Delta u_i^{(0)}\\}_{\\text{unbound}} = [\\,0.2,\\,0.1,\\,0.3,\\,0.0,\\,0.4,\\,0.2,\\,0.1,\\,0.3\\,]$\n    - $\\{\\Delta u_j^{(1)}\\}_{\\text{unbound}} = [\\,0.5,\\,0.4,\\,0.6,\\,0.7,\\,0.3,\\,0.5,\\,0.4,\\,0.6\\,]$\n- 案例 2（边界情况，相同状态）：\n  - 温度：$T = 300$ K。\n  - 结合环境：\n    - $\\{\\Delta u_i^{(0)}\\}_{\\text{bound}} = [\\,0.0,\\,0.0,\\,0.0,\\,0.0\\,]$\n    - $\\{\\Delta u_j^{(1)}\\}_{\\text{bound}} = [\\,0.0,\\,0.0,\\,0.0,\\,0.0\\,]$\n  - 非结合环境：\n    - $\\{\\Delta u_i^{(0)}\\}_{\\text{unbound}} = [\\,0.0,\\,0.0,\\,0.0,\\,0.0\\,]$\n    - $\\{\\Delta u_j^{(1)}\\}_{\\text{unbound}} = [\\,0.0,\\,0.0,\\,0.0,\\,0.0\\,]$\n- 案例 3（样本大小不等，偏斜分布）：\n  - 温度：$T = 300$ K。\n  - 结合环境：\n    - $\\{\\Delta u_i^{(0)}\\}_{\\text{bound}} = [\\,0.9,\\,1.1,\\,0.8,\\,1.0,\\,0.7,\\,1.2\\,]$\n    - $\\{\\Delta u_j^{(1)}\\}_{\\text{bound}} = [\\,0.4,\\,0.3,\\,0.5\\,]$\n  - 非结合环境：\n    - $\\{\\Delta u_i^{(0)}\\}_{\\text{unbound}} = [\\,0.2,\\,0.3,\\,0.1,\\,0.4,\\,0.2,\\,0.3\\,]$\n    - $\\{\\Delta u_j^{(1)}\\}_{\\text{unbound}} = [\\,0.0,\\,0.1,\\,0.2\\,]$\n\n要求：\n- 对每个环境使用所提供的 $\\Delta f$ 定义。\n- 为每个案例计算 $\\Delta\\Delta G_{\\text{bind}}$（单位为 $\\text{kJ}\\cdot\\text{mol}^{-1}$）并四舍五入到三位小数。\n- 你的程序应生成单行输出，其中包含用方括号括起来的逗号分隔结果列表（例如，“[result1,result2,result3]”），不含空格也无其他文本。", "solution": "对问题陈述进行验证。\n\n**第一步：提取已知条件**\n- 无量纲约化势能差的定义：$\\Delta u(\\mathbf{x}) = \\beta \\left[ U_1(\\mathbf{x}) - U_0(\\mathbf{x}) \\right]$。\n- 从状态 $0$ 采样的数据：$\\{\\Delta u_i^{(0)}\\}_{i=1}^{n_0}$。\n- 从状态 $1$ 采样的数据：$\\{\\Delta u_j^{(1)}\\}_{j=1}^{n_1}$。\n- 无量纲自由能差 $\\Delta f$ 的隐式方程：\n$$\n\\sum_{i=1}^{n_0} \\frac{1}{1 + \\exp\\!\\left(\\Delta u_i^{(0)} - \\Delta f - \\ln\\!\\frac{n_1}{n_0}\\right)}\n=\n\\sum_{j=1}^{n_1} \\frac{1}{1 + \\exp\\!\\left(-\\Delta u_j^{(1)} + \\Delta f - \\ln\\!\\frac{n_1}{n_0}\\right)}.\n$$\n- 结合自由能变化的公式：$\\Delta\\Delta G_{\\text{bind}} = \\left( \\Delta f_{\\text{bound}} - \\Delta f_{\\text{unbound}} \\right) \\, k_B T N_A$。\n- 常数：$k_B = 1.380\\,649 \\times 10^{-23} \\, \\text{J/K}$，$N_A = 6.022\\,140\\,76 \\times 10^{23} \\, \\text{mol}^{-1}$。\n- 测试用例为‘结合’和‘非结合’环境提供了特定的温度 $T$ 和 $\\{\\Delta u\\}$ 值列表。\n\n**第二步：验证**\n该问题具有科学依据，定义明确且客观。\n- **科学依据**：该问题描述了 Bennett Acceptance Ratio (BAR) 方法，这是一种用于计算自由能差的严谨且广泛使用的统计力学技术。所提供的方程是从 BAR 方法推导出的 $\\Delta f$ 的正确最大似然估计量。用于定义 $\\Delta\\Delta G_{\\text{bind}}$ 的热力学循环也是化学中的一个标准和基本概念。\n- **适定性**：核心任务是求解给定的关于 $\\Delta f$ 的隐式方程。我们希望找到函数 $g(\\Delta f)$ 的根，该函数定义为：\n$$\ng(\\Delta f) = \\sum_{i=1}^{n_0} \\frac{1}{1 + \\exp\\!\\left(\\Delta u_i^{(0)} - \\Delta f - K \\right)} - \\sum_{j=1}^{n_1} \\frac{1}{1 + \\exp\\!\\left(-\\Delta u_j^{(1)} + \\Delta f - K \\right)}\n$$\n其中 $K = \\ln(n_1/n_0)$。\n为了评估是否存在唯一解，我们考察 $g(\\Delta f)$ 关于 $\\Delta f$ 的导数。令 $h(x) = (1 + e^x)^{-1}$。其导数为 $h'(x) = -e^x(1+e^x)^{-2} = -h(x)(1-h(x))$，该值严格为负。第一项关于 $\\Delta f$ 的导数为 $\\sum_{i=1}^{n_0} h'(\\dots) \\cdot (-1) > 0$。第二项关于 $\\Delta f$ 的导数为 $\\sum_{j=1}^{n_1} h'(\\dots) \\cdot (+1)  0$。因此，它们差的导数 $g'(\\Delta f)$ 是两个正项的和，因此严格为正。这证明了 $g(\\Delta f)$ 是一个关于 $\\Delta f$ 的严格单调递增函数。此外，当 $\\Delta f \\to \\infty$ 时，$g(\\Delta f) \\to n_0 > 0$。当 $\\Delta f \\to -\\infty$ 时，$g(\\Delta f) \\to -n_1  0$。一个从负值穿过坐标轴到正值的连续单调函数必有且只有一个根。因此，该问题是适定的。\n- **客观性和完整性**：该问题使用精确、无歧义的数学和科学语言陈述。所有必要的数据和常数都已提供。未发现任何缺陷。\n\n**结论：** 该问题有效。\n\n**解题步骤**\n求解过程首先确定每个热力学环境（结合的蛋白质-配体复合物和溶剂中未结合的配体）的无量纲自由能差 $\\Delta f$。这通过数值求解所提供的隐式方程来实现。然后根据这些值计算结合自由能的变化量 $\\Delta\\Delta G_{\\text{bind}}$。\n\n1.  **求解 $\\Delta f$**：对于每个环境，我们必须找到函数 $g(\\Delta f) = 0$ 的根。由于已证明 $g(\\Delta f)$ 是单调的，我们可以采用一个稳健的一维求根算法。Brent's 方法因其高效性和在有界区间内保证收敛而成为此目的的绝佳选择。我们必须根据输入数据数组 $\\{\\Delta u_i^{(0)}\\}$ 和 $\\{\\Delta u_j^{(1)}\\}$ 以及样本大小 $n_0$ 和 $n_1$ 来定义函数 $g(\\Delta f)$。常数项 $K = \\ln(n_1/n_0)$ 会被预先计算。考虑到函数的渐进行为，一个宽的搜索区间，如 $[-100, 100]$，足以将根包含在内。\n\n2.  **计算 $\\Delta\\Delta G_{\\text{bind}}$**：一旦计算出结合态 ($\\Delta f_{\\text{bound}}$) 和非结合态 ($\\Delta f_{\\text{unbound}}$) 的自由能差，就可以使用热力学循环关系计算相对结合自由能：\n    $$\n    \\Delta\\Delta G_{\\text{bind}} = (\\Delta f_{\\text{bound}} - \\Delta f_{\\text{unbound}}) \\times k_B T N_A\n    $$\n    乘积 $k_B N_A$ 是摩尔气体常数，$R \\approx 8.314\\,462\\,618 \\dots \\, \\text{J} \\cdot \\text{mol}^{-1} \\cdot \\text{K}^{-1}$。结果值最初以焦耳/摩尔为单位，必须通过除以 1000 转换为千焦/摩尔。\n\n3.  **实现**：整个算法在一个 Python 程序中实现。对于每个测试用例，流程如下：\n    a. 提取温度 $T$ 和四个能量差列表。\n    b. 调用一个实现 Brent's 方法（使用 `scipy.optimize.brentq`）的辅助函数，使用‘结合态’数据来求解 $\\Delta f_{\\text{bound}}$。\n    c. 调用同一个辅助函数，使用‘非结合态’数据来求解 $\\Delta f_{\\text{unbound}}$。\n    d. 使用步骤 b 和 c 的值计算 $\\Delta\\Delta G_{\\text{bind}}$（单位 kJ/mol）。\n    e. 按要求将结果四舍五入到三位小数。\n    f. 收集所有测试用例的结果，并将其格式化为指定的输出字符串。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import brentq\n\ndef solve():\n    \"\"\"\n    Solves for the change in binding free energy for three test cases\n    using the Bennett Acceptance Ratio (BAR) method.\n    \"\"\"\n    # Define physical constants\n    K_B = 1.380649e-23  # Boltzmann constant in J/K\n    N_A = 6.02214076e+23 # Avogadro's number in mol^-1\n    R_J_PER_MOL_K = K_B * N_A # Molar gas constant in J/(mol*K)\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"T\": 300.0,\n            \"bound\": {\n                \"u0\": [-1.2, -0.8, -1.0, -1.1, -0.9, -1.3, -0.7, -1.0],\n                \"u1\": [-0.4, -0.6, -0.5, -0.7, -0.8, -0.3, -0.6, -0.5],\n            },\n            \"unbound\": {\n                \"u0\": [0.2, 0.1, 0.3, 0.0, 0.4, 0.2, 0.1, 0.3],\n                \"u1\": [0.5, 0.4, 0.6, 0.7, 0.3, 0.5, 0.4, 0.6],\n            },\n        },\n        {\n            \"T\": 300.0,\n            \"bound\": {\n                \"u0\": [0.0, 0.0, 0.0, 0.0],\n                \"u1\": [0.0, 0.0, 0.0, 0.0],\n            },\n            \"unbound\": {\n                \"u0\": [0.0, 0.0, 0.0, 0.0],\n                \"u1\": [0.0, 0.0, 0.0, 0.0],\n            },\n        },\n        {\n            \"T\": 300.0,\n            \"bound\": {\n                \"u0\": [0.9, 1.1, 0.8, 1.0, 0.7, 1.2],\n                \"u1\": [0.4, 0.3, 0.5],\n            },\n            \"unbound\": {\n                \"u0\": [0.2, 0.3, 0.1, 0.4, 0.2, 0.3],\n                \"u1\": [0.0, 0.1, 0.2],\n            },\n        },\n    ]\n\n    def _bar_objective_function(delta_f, u0, u1, log_n1_over_n0):\n        \"\"\"\n        The objective function for BAR, the root of which is delta_f.\n        g(delta_f) = LHS - RHS from the problem statement.\n        \"\"\"\n        # Arguments for the exponential function\n        arg1 = u0 - delta_f - log_n1_over_n0\n        arg2 = -u1 + delta_f - log_n1_over_n0\n        \n        # Fermi-Dirac-like terms\n        # np.exp handles large negative exponents (result is 0) and large positive\n        # exponents (result is inf), which leads to the correct limit of 0 for 1/inf.\n        lhs = np.sum(1.0 / (1.0 + np.exp(arg1)))\n        rhs = np.sum(1.0 / (1.0 + np.exp(arg2)))\n        \n        return lhs - rhs\n\n    def calculate_delta_f(u0_list, u1_list):\n        \"\"\"\n        Calculates the dimensionless free energy difference (delta_f)\n        by finding the root of the BAR equation.\n        \"\"\"\n        u0 = np.array(u0_list, dtype=np.float64)\n        u1 = np.array(u1_list, dtype=np.float64)\n        \n        n0 = len(u0)\n        n1 = len(u1)\n        \n        if n0 == 0 or n1 == 0:\n            raise ValueError(\"Sample lists cannot be empty.\")\n\n        log_n1_over_n0 = np.log(n1 / n0)\n        \n        # Use brentq a robust root-finding algorithm. The function is monotonic,\n        # so a wide bracket is safe.\n        try:\n            # A search interval of [-100, 100] is sufficiently large.\n            delta_f = brentq(\n                _bar_objective_function,\n                a=-100.0,\n                b=100.0,\n                args=(u0, u1, log_n1_over_n0)\n            )\n        except ValueError:\n            # This can happen if the function does not cross zero within the interval,\n            # which indicates an issue with the data or interval. For this problem,\n            # it should not occur. A wider interval could be used if necessary.\n            delta_f = brentq(\n                _bar_objective_function,\n                a=-1000.0,\n                b=1000.0,\n                args=(u0, u1, log_n1_over_n0)\n            )\n\n        return delta_f\n\n    results = []\n    for case in test_cases:\n        T = case[\"T\"]\n        \n        # Calculate delta_f for the bound state\n        delta_f_bound = calculate_delta_f(case[\"bound\"][\"u0\"], case[\"bound\"][\"u1\"])\n        \n        # Calculate delta_f for the unbound state\n        delta_f_unbound = calculate_delta_f(case[\"unbound\"][\"u0\"], case[\"unbound\"][\"u1\"])\n        \n        # Calculate the final binding free energy change in kJ/mol\n        # delta_delta_G = (delta_f_bound - delta_f_unbound) * R * T\n        delta_delta_G_j_mol = (delta_f_bound - delta_f_unbound) * R_J_PER_MOL_K * T\n        delta_delta_G_kj_mol = delta_delta_G_j_mol / 1000.0\n        \n        results.append(delta_delta_G_kj_mol)\n\n    # Format the results to exactly three decimal places and create the final output string.\n    formatted_results = [\"{:.3f}\".format(res) for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```", "id": "2455727"}]}