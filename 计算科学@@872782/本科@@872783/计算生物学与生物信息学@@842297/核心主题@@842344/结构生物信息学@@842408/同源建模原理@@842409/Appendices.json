{"hands_on_practices": [{"introduction": "同源建模的成功在很大程度上取决于模板的选择，而这往往需要在不完美的选项之间做出权衡。这个练习 ([@problem_id:2398292]) 将带你体验一个真实世界中的决策过程，你需要评估两个候选模板的优劣。通过这个过程，你将学会如何综合考量序列一致性、分辨率、结构完整性以及生物学相关性（如寡聚状态），从而为你的模型奠定最坚实的基础。", "problem": "您正在构建一个长度为 $280$ 个氨基酸的单体酶的比较（同源）模型，以指导活性位点的突变设计。现有两个候选模板：\n\n模板X（X射线晶体学 (XRC)）：\n- 分辨率 $2.8\\,\\text{\\AA}$。\n- 在 $260$ 个比对位置上与靶标的全局序列一致性为 $35\\%$（剩余的靶标残基位于末端）。\n- 以结构域交换二聚体的形式结晶；用于比对的链通过一个表面与伙伴链接触，该表面包含了与靶标残基 $150\\text{–}165$ 比对的区域。\n- 注释为脱辅基（apo）形式；与靶标残基 $150\\text{–}162$ 比对的柔性区（loop）在电子密度图中未解析，并且在坐标中缺失。\n- 结构核心部分看起来有序度很高，但活性位点柔性区附近在晶体中是无序的。\n\n模板N（核磁共振 (NMR)）：\n- 一个包含 $20$ 个模型的系综，在近生理条件下的溶液中解析得到。\n- 在全部 $280$ 个残基上与靶标的全局序列一致性为 $33\\%$（比对中无空位）。\n- 在溶液中为单体。\n- 与靶标残基 $150\\text{–}165$ 比对的活性位点柔性区存在，并在系综中呈现多种构象。\n- 报道的系综内主链均方根偏差（RMSD）在结构核心区为 $0.7\\,\\text{\\AA}$，在活性位点柔性区为 $2.4\\,\\text{\\AA}$。\n\n假设没有可用于靶标的额外实验约束，并且您的最高优先级是在单体状态下，为活性位点柔性区获得一个物理上真实的核心和一个合理的、功能相关的构象。\n\n在构建初始同源模型时，以下哪个是最合理的选择？为什么？\n\nA. 使用模板X作为唯一模板，因为其略高的序列一致性和原子级分辨率的坐标保证了比任何NMR衍生的模板更准确的模型；缺失的柔性区可以稍后添加，并且二聚化对于单体靶标无关紧要。\n\nB. 使用模板N作为唯一模板，因为其在正确的单体状态下的全长比对以及对活性位点柔性区的明确构象采样，其重要性超过了序列一致性的微小差异；该系综为功能上重要的柔性区提供了现实的备选构象。\n\nC. 计算所有 $20$ 个模板N模型的算术平均值，以生成一个“降噪”的单一平均结构，并将其作为唯一模板以消除系综的模糊性。\n\nD. 两个模板都不使用；序列一致性低于 $50\\%$ 且X射线分辨率差于 $2.0\\,\\text{\\AA}$ 的模型对于任何理性设计都太不可靠，因此最好等待一个更相似、更高分辨率的模板。", "solution": "在尝试解答之前，必须首先验证问题陈述的科学合理性和逻辑一致性。\n\n**第1步：提取已知信息**\n\n- **靶标蛋白：** 长度为 $280$ 个氨基酸的单体酶。\n- **目标：** 构建一个比较（同源）模型，以指导活性位点的突变设计。\n- **优先级：** 在单体状态下，为活性位点柔性区获得一个物理上真实的核心和一个合理的、功能相关的构象。\n- **模板X（来自X射线晶体学 - XRC）：**\n    - 分辨率：$2.8\\,\\text{\\AA}$。\n    - 全局序列一致性：在 $260$ 个比对位置上与靶标为 $35\\%$。\n    - 寡聚状态：结构域交换二聚体。\n    - 二聚体界面：用于比对的链通过一个表面与伙伴链接触，该表面包含了与靶标残基 $150\\text{–}165$ 比对的区域。\n    - 完整性：注释为脱辅基（apo）形式。与靶标残基 $150\\text{–}162$ 比对的柔性区在电子密度图中未解析，并且在坐标中缺失。\n    - 无序性：活性位点柔性区附近在晶体中是无序的。\n- **模板N（来自核磁共振 - NMR）：**\n    - 数据类型：在溶液中解析的包含 $20$ 个模型的系综。\n    - 条件：近生理条件。\n    - 全局序列一致性：在全部 $280$ 个残基上与靶标为 $33\\%$，比对中无空位。\n    - 寡聚状态：在溶液中为单体。\n    - 活性位点柔性区：与靶标残基 $150\\text{–}165$ 比对的柔性区存在，并在系综中呈现多种构象。\n    - 结构变异性（RMSD）：系综内主链均方根偏差在结构核心区为 $0.7\\,\\text{\\AA}$，在活性位点柔性区为 $2.4\\,\\text{\\AA}$。\n- **附加信息：** 没有可用于靶标的其他实验约束。\n\n**第2步：使用已知信息进行验证**\n\n问题陈述描述了一个计算结构生物学中的标准且现实的场景，特别是在同源建模这一子领域。任务是在两个不完美的模板之间进行选择，以构建靶标蛋白的模型。\n\n- **科学依据：** 该问题牢固地植根于蛋白质结构、X射线晶体学、NMR光谱学和比较建模的原理中。所有使用的术语（序列一致性、分辨率、RMSD、结构域交换、缺失的柔性区、NMR系综）都是该领域的标准术语。提供的数值（$2.8\\,\\text{\\AA}$、$33\\%-35\\%$、$0.7\\,\\text{\\AA}$ RMSD等）都是合理的。\n- **问题的明确性：** 该问题提供了一个明确的目标（为突变设计进行模型构建）和一个具体的优先级（真实的核心和活性位点柔性区）。它提出了两个具有明确优缺点的不同选择。这种结构允许基于同源建模中已建立的最佳实践得出一个唯一的、站得住脚的解决方案。\n- **客观性：** 对模板的描述是基于假设的实验数据，是事实性和客观的。没有主观或基于意见的语言。\n\n**第3步：结论与行动**\n\n问题陈述在科学上是合理的、定义明确的、客观的且信息自足的。这是一个计算生物学中的有效问题。我现在将进行解答。\n\n**求解推导**\n\n核心任务是为同源建模选择最佳模板，明确目标是研究用于突变设计的活性位点柔性区。选择必须基于哪个模板更有可能产生一个在物理和生物学上都与靶标的单体功能状态相关的模型。\n\n让我们根据既定优先级评估这两个模板。\n\n**模板X (XRC) 的分析：**\n- **序列一致性：** $35\\%$。这略高于模板N的 $33\\%$。在序列一致性的“暮光区”（约 $25\\%-35\\%$），$2\\%$ 的差异通常不被认为是决定性的，尤其是在有其他关键因素影响时。\n- **分辨率：** $2.8\\,\\text{\\AA}$。这是一个中等而非高的分辨率。在此水平上，整体折叠是可靠的，但侧链甚至一些主链区域的精确坐标可能不确定。\n- **关键缺陷1：寡聚状态：** 模板是结构域交换二聚体，而靶标是单体。二聚体界面包含了与靶标活性位点柔性区（残基 $150\\text{–}165$）相对应的区域。这意味着模板X中这个关键区域的构象是由靶标单体中不存在的非生理性堆积相互作用所决定的。使用这个结构几乎肯定会给模型最重要的区域引入一个重大的假象。\n- **关键缺陷2：缺失的柔性区：** 与靶标残基 $150\\text{–}162$ 相对应的柔性区未解析，并在坐标中缺失。这是其在晶体中无序的直接后果。对于一个专注于这个特定柔性区的项目来说，这是模板的一个灾难性缺陷。人们将被迫使用*从头*（de novo）柔性区建模方法来填补这个长达 $13$ 个残基的缺口，而这种方法的可靠性是出了名的差。其结果充其量只是推测性的。\n\n**模板N (NMR) 的分析：**\n- **序列一致性：** $33\\%$。如前所述，这仅略低于模板X，并不构成显著劣势。比对覆盖了靶标的全长，这是一个优势。\n- **结构数据：** 一个包含 $20$ 个模型的系综提供了蛋白质在溶液中、近生理条件下的构象动力学信息。这通常比静态的、晶体堆积的结构更与功能相关。\n- **关键优势1：寡聚状态：** 模板是单体，与靶标的生物学状态相匹配。这确保了整体折叠和表面柔性区的构象不会因人为的晶体堆积或非天然的寡聚化而扭曲。\n- **关键优势2：完整的柔性区信息：** 活性位点柔性区存在于系综的所有模型中。它呈现多种构象（由 $2.4\\,\\text{\\AA}$ 的高RMSD表示）这一事实不是一个缺陷，而是至关重要的*数据*。它反映了该柔性区固有的柔性，这很可能对其功能（例如，底物结合、催化）至关重要。这个系综为柔性区提供了一组物理上合理的起始构象，这对于突变设计来说，远比一个单一、任意构建的柔性区更有价值。\n- **核心结构质量：** 核心区的低主链RMSD（$0.7\\,\\text{\\AA}$）表明这部分结构定义良好且稳定，为模型提供了坚实的基础。\n\n**推导结论：**\n对于既定目的而言，模板N具有压倒性优势。其正确的单体状态，以及最重要的是，其对柔性活性位点柔性区构象空间的明确表示，直接解决了项目的主要目标。与模板X相关的严重假象（影响活性位点的不正确的寡聚状态，以及关键柔性区的完全缺失）使其不适用，尽管其序列一致性略高。\n\n**逐项分析**\n\n- **A. 使用模板X作为唯一模板，因为其略高的序列一致性和原子级分辨率的坐标保证了比任何NMR衍生的模板更准确的模型；缺失的柔性区可以稍后添加，并且二聚化对于单体靶标无关紧要。**\n这个陈述存在根本性缺陷。$2\\%$ 的序列一致性差异可以忽略不计。一个 $2.8\\,\\text{\\AA}$ 的结构并不能保证高精度，尤其是在无序区域。声称NMR衍生的模板本质上就不那么准确是一种过度简化，并且通常是错误的。最关键的是，它忽视了两个致命缺陷：活性位点处的二聚化假象是高度相关且具有破坏性的，“稍后添加柔性区”是一个极易出错的过程，不能依赖其进行理性设计。\n**结论：不正确。**\n\n- **B. 使用模板N作为唯一模板，因为其在正确的单体状态下的全长比对以及对活性位点柔性区的明确构象采样，其重要性超过了序列一致性的微小差异；该系综为功能上重要的柔性区提供了现实的备选构象。**\n这个陈述准确地反映了可靠的同源建模原则。它正确地将生物学相关性（单体状态）和功能关键区域（活性位点柔性区）的完整性置于边际的序列一致性差异之上。它正确地将NMR系综解释为有价值的构象动力学数据（而非“噪音”），为柔性区提供了“现实的备选构象”。这是最站得住脚的科学结论。\n**结论：正确。**\n\n- **C. 计算所有 $20$ 个模板N模型的算术平均值，以生成一个“降噪”的单一平均结构，并将其作为唯一模板以消除系综的模糊性。**\n这表明对NMR系综有深刻的误解。对多个不同构象（尤其是在柔性环中）的坐标进行平均并不能“减少噪音”；它会创建一个具有不合理键长、键角和空间位阻的、物理上不真实的单一结构。由此产生的“平均”构象甚至可能不是一个低能态。这个过程破坏了系综中包含的宝贵的动力学信息。\n**结论：不正确。**\n\n- **D. 两个模板都不使用；序列一致性低于 $50\\%$ 且X射线分辨率差于 $2.0\\,\\text{\\AA}$ 的模型对于任何理性设计都太不可靠，因此最好等待一个更相似、更高分辨率的模板。**\n这种立场过于教条且毫无裨益。虽然更高的序列一致性和分辨率总是更可取的，但基于 $30\\%-40\\%$ 一致性范围内的模板构建的同源模型，在常规和成功的实验设计中被用来产生假设。“完美”的模板可能永远不会出现。科学家的任务是最好地利用现有数据。因为模板N提供了一个非常合理的前进道路，所以放弃这两个模板等于无故放弃整个项目。\n**结论：不正确。**", "answer": "$$\\boxed{B}$$", "id": "2398292"}, {"introduction": "在选定模板之后，下一个关键步骤是生成最优的靶标-模板序列比对。一个好的比对应该最大化保守区域的匹配，并将缺口（gap）置于结构上可容忍的位置。本练习 ([@problem_id:2398300]) 将指导你构建一个量化的评分函数，它综合了结构保守区、功能关键位点和缺口分布等多个因素，让你能够从多个候选比对中科学地选择出最佳方案。", "problem": "您的任务是，使用一个基于结构保守性、功能性残基保留、覆盖率和空位分布等基本原则的数学定义综合分数，对同一目标-模板对的五个备选序列比对进行排序，以评估其同源建模的适用性。对于每个比对，您会得到一些计数和分数，这些数据总结了该比对如何在结构保守区（SCRs）、环区和功能关键位置上将目标序列映射到模板序列。您的程序必须为每个比对计算分数，为每个测试用例选择得分最高的比对，并报告每个测试用例所选比对的零基索引。\n\n单个比对的分数定义如下。设 $N$ 为比对位置总数，$N_c$ 为被注释为属于结构保守区（SCR）的比对位置数，而 $N_\\ell = N - N_c$ 为环区位置数。设 $I_{\\mathrm{all}}$ 为所有 $N$ 个比对位置上的相同匹配数，$I_c$ 为大小为 $N_c$ 的 SCR 内的相同匹配数，$C_c$ 为 SCR 内的保守替换数。设 $G_c$ 为 SCR 中的空位开口数，$G_\\ell$ 为环区中的空位开口数，$g_{\\max,c}$ 为 SCR 内最大连续空位段的长度。设 $K$ 为预先指定的关键功能位置总数，$K_m$ 为这些关键位置中在其比对位置上与模板不完全匹配的数量。设 $\\mathrm{cov}$ 为比对中包含的目标残基的覆盖率分数，其中 $0 \\le \\mathrm{cov} \\le 1$。所有计数都满足显而易见的约束条件，例如 $0 \\le I_c + C_c \\le N_c$, $0 \\le I_{\\mathrm{all}} \\le N$, $0 \\le G_c$, $0 \\le G_\\ell$, $0 \\le g_{\\max,c} \\le N_c$ 以及 $1 \\le K$。\n\n定义以下归一化量：\n- 核心区一致性分数：$f_{c,\\mathrm{id}} = \\dfrac{I_c}{N_c}$，当 $N_c \\ge 1$ 时。\n- 核心区保守性分数：$f_{c,\\mathrm{cons}} = \\dfrac{C_c}{N_c}$，当 $N_c \\ge 1$ 时。\n- 全局一致性分数：$f_{\\mathrm{id}} = \\dfrac{I_{\\mathrm{all}}}{N}$，当 $N \\ge 1$ 时。\n- 核心区空位开口率：$r_{c,\\mathrm{gap}} = \\dfrac{G_c}{N_c}$，当 $N_c \\ge 1$ 时。\n- 环区空位开口率：$r_{\\ell,\\mathrm{gap}} = \\begin{cases}\\dfrac{G_\\ell}{N_\\ell},  \\text{若 } N_\\ell \\ge 1, \\\\ 0,  \\text{若 } N_\\ell = 0.\\end{cases}$\n- 关键位点错配分数：$f_{\\mathrm{key}} = \\dfrac{K_m}{K}$，当 $K \\ge 1$ 时。\n- 最大核心区空位分数：$f_{c,\\mathrm{gmax}} = \\dfrac{g_{\\max,c}}{N_c}$，当 $N_c \\ge 1$ 时。\n\n使用反映同源建模优先级的固定权重：\n- $w_1 = 0.35$, $w_2 = 0.15$, $w_3 = 0.15$, $w_4 = 0.10$, $w_5 = 0.10$, $w_6 = 0.05$, $w_7 = 0.08$, $w_8 = 0.02$，\n定义综合分数 $S$ 为\n$$\nS = w_1 f_{c,\\mathrm{id}} + w_2 f_{c,\\mathrm{cons}} + w_3 f_{\\mathrm{id}} + w_4 \\mathrm{cov} - w_5 r_{c,\\mathrm{gap}} - w_6 r_{\\ell,\\mathrm{gap}} - w_7 f_{\\mathrm{key}} - w_8 f_{c,\\mathrm{gmax}}.\n$$\n更高的 $S$ 值表示该比对更适合同源建模。\n\n对于下述每个测试用例，您的程序必须使用上述定义为五个比对中的每一个计算 $S$ 值，选择具有最高 $S$ 值的比对，并输出该比对的零基索引。如果在同一测试用例中，两个或多个比对的 $S$ 值相同，则选择并列比对中最小的索引。\n\n测试套件。共有三个独立的测试用例。在每个测试用例中，都恰好有五个比对；每个比对由一个有序元组指定\n$$\n(N, N_c, I_{\\mathrm{all}}, I_c, C_c, G_c, G_\\ell, g_{\\max,c}, K_m, K, \\mathrm{cov}).\n$$\n\n- 测试用例 $1$：\n  - 比对 $0$：$(90, 60, 55, 40, 15, 1, 2, 2, 0, 3, 0.90)$。\n  - 比对 $1$：$(90, 60, 52, 35, 18, 2, 1, 4, 1, 3, 0.92)$。\n  - 比对 $2$：$(90, 60, 45, 28, 10, 3, 3, 5, 2, 3, 0.95)$。\n  - 比对 $3$：$(90, 60, 58, 36, 12, 5, 0, 6, 0, 3, 0.85)$。\n  - 比对 $4$：$(90, 60, 50, 38, 14, 1, 1, 2, 1, 3, 0.75)$。\n\n- 测试用例 $2$：\n  - 比对 $0$：$(80, 80, 60, 56, 16, 1, 0, 3, 0, 2, 0.80)$。\n  - 比对 $1$：$(80, 80, 59, 55, 18, 0, 0, 0, 0, 2, 0.86)$。\n  - 比对 $2$：$(80, 80, 61, 57, 15, 0, 0, 0, 1, 2, 0.82)$。\n  - 比对 $3$：$(80, 80, 57, 50, 20, 0, 0, 2, 0, 2, 0.90)$。\n  - 比对 $4$：$(80, 80, 56, 55, 10, 4, 0, 5, 0, 2, 0.85)$。\n\n- 测试用例 $3$：\n  - 比对 $0$：$(100, 40, 55, 30, 6, 1, 8, 2, 0, 4, 0.88)$。\n  - 比对 $1$：$(100, 40, 54, 26, 10, 0, 0, 0, 1, 4, 0.90)$。\n  - 比对 $2$：$(100, 40, 54, 26, 12, 0, 1, 0, 0, 4, 0.97)$。\n  - 比对 $3$：$(100, 40, 60, 28, 8, 3, 0, 4, 0, 4, 0.80)$。\n  - 比对 $4$：$(100, 40, 50, 29, 7, 0, 0, 0, 0, 4, 0.70)$。\n\n最终输出格式。您的程序应生成单行输出，其中包含结果，格式为一个用方括号括起来的逗号分隔列表，每个测试用例对应一个整数，该整数是该测试用例所选比对的零基索引（例如，$[a,b,c]$）。此问题不涉及物理单位。不存在角度。百分比仅以 $0$ 到 $1$ 之间的分数形式出现，必须作为实数处理。", "solution": "所提出的问题是计算生物学中一个定义明确且具有科学依据的任务，具体来说，是评估用于同源建模的序列比对。目标是通过为每个比对计算一个综合分数 $S$ 来对多个候选比对进行排序。得分最高的比对被认为是最合适的。这个分数是几个指标的加权和，这些指标反映了蛋白质结构和功能的生物物理学和进化原理。更高的分数意味着更好的比对。\n\n综合分数 $S$ 定义为：\n$$\nS = w_1 f_{c,\\mathrm{id}} + w_2 f_{c,\\mathrm{cons}} + w_3 f_{\\mathrm{id}} + w_4 \\mathrm{cov} - w_5 r_{c,\\mathrm{gap}} - w_6 r_{\\ell,\\mathrm{gap}} - w_7 f_{\\mathrm{key}} - w_8 f_{c,\\mathrm{gmax}}\n$$\n其中权重是固定常数：$w_1 = 0.35$，$w_2 = 0.15$，$w_3 = 0.15$，$w_4 = 0.10$，$w_5 = 0.10$，$w_6 = 0.05$，$w_7 = 0.08$，$w_8 = 0.02$。\n\n该分数由增加其值的正向项和减少其值的惩罚项组成。\n正向贡献来自：\n- 核心区一致性分数 ($f_{c,\\mathrm{id}}$): 此项权重最高 ($w_1 = 0.35$)，强调了结构保守区 (SCRs) 中相同残基的重要性，因为这是结构保留的最强指标。\n- 核心区保守性分数 ($f_{c,\\mathrm{cons}}$): 奖励 SCRs 中的保守替换，因为这些替换很可能维持局部折叠。\n- 全局一致性分数 ($f_{\\mathrm{id}}$): 考虑整个比对的总体序列一致性。\n- 覆盖率 ($\\mathrm{cov}$): 偏好于模拟了目标序列更大部分的比对。\n\n惩罚贡献来自：\n- 核心区空位开口率 ($r_{c,\\mathrm{gap}}$): 惩罚 SCRs 内的空位，因为它们会破坏结构。\n- 环区空位开口率 ($r_{\\ell,\\mathrm{gap}}$): 惩罚环区中的空位，但权重较低 ($w_6  w_5$)，因为环区对插入和删除的容忍度更高。\n- 关键位点错配分数 ($f_{\\mathrm{key}}$): 惩罚功能关键位置的错配，以确保模型的生物学相关性。\n- 最大核心区空位分数 ($f_{c,\\mathrm{gmax}}$): 特别惩罚 SCRs 中的长空位，因为这些空位可能特别难以精确建模。\n\n每个比对的输入是一个参数元组：$(N, N_c, I_{\\mathrm{all}}, I_c, C_c, G_c, G_\\ell, g_{\\max,c}, K_m, K, \\mathrm{cov})$。根据这些参数，我们首先计算必要的中间量和归一化量。环区中的比对位置数为 $N_\\ell = N - N_c$。\n\n归一化分数的计算如下：\n- 核心区一致性分数：$f_{c,\\mathrm{id}} = \\dfrac{I_c}{N_c}$ (当 $N_c \\ge 1$ 时)\n- 核心区保守性分数：$f_{c,\\mathrm{cons}} = \\dfrac{C_c}{N_c}$ (当 $N_c \\ge 1$ 时)\n- 全局一致性分数：$f_{\\mathrm{id}} = \\dfrac{I_{\\mathrm{all}}}{N}$ (当 $N \\ge 1$ 时)\n- 关键位点错配分数：$f_{\\mathrm{key}} = \\dfrac{K_m}{K}$ (当 $K \\ge 1$ 时)\n- 最大核心区空位分数：$f_{c,\\mathrm{gmax}} = \\dfrac{g_{\\max,c}}{N_c}$ (当 $N_c \\ge 1$ 时)\n- 核心区空位开口率：$r_{c,\\mathrm{gap}} = \\dfrac{G_c}{N_c}$ (当 $N_c \\ge 1$ 时)\n- 环区空位开口率：$r_{\\ell,\\mathrm{gap}}$，分段定义以处理 $N_\\ell = 0$ 的情况：\n$$\nr_{\\ell,\\mathrm{gap}} = \\begin{cases}\\dfrac{G_\\ell}{N_\\ell},  \\text{若 } N_\\ell \\ge 1, \\\\ 0,  \\text{若 } N_\\ell = 0.\\end{cases}\n$$\n\n该解决方案的实现首先是定义一个函数，该函数接收一个比对的参数元组并计算分数 $S$。此函数封装了计算所有归一化量及其加权和的逻辑。\n\n主算法通过遍历每个提供的测试用例来进行。对于每个测试用例，它为五个比对中的每一个计算分数 $S$。分数存储在一个数组中。然后确定最大分数的索引。问题规定，如果出现平局，应选择具有较小零基索引的比对。标准数值库函数（如 `numpy.argmax`）会找到最大值的首次出现位置的索引，这自然满足了该条件。收集每个测试用例的结果索引，最终输出格式为一个用方括号括起来的逗号分隔的索引列表。提供的测试数据是充分且自洽的，没有出现问题定义中未明确处理的除零等边界情况。\n\n例如，考虑测试用例 1，比对 0，其参数为 $(90, 60, 55, 40, 15, 1, 2, 2, 0, 3, 0.90)$。\n首先，我们计算 $N_\\ell = 90 - 60 = 30$。\n归一化项为：\n$f_{c,\\mathrm{id}} = 40/60$, $f_{c,\\mathrm{cons}} = 15/60$, $f_{\\mathrm{id}} = 55/90$, $r_{c,\\mathrm{gap}} = 1/60$, $r_{\\ell,\\mathrm{gap}} = 2/30$, $f_{\\mathrm{key}} = 0/3$, $f_{c,\\mathrm{gmax}} = 2/60$。覆盖率 $\\mathrm{cov}$ 已给出为 $0.90$。\n将这些值代入分数公式：\n$$\nS = 0.35\\left(\\frac{40}{60}\\right) + 0.15\\left(\\frac{15}{60}\\right) + 0.15\\left(\\frac{55}{90}\\right) + 0.10(0.90) - 0.10\\left(\\frac{1}{60}\\right) - 0.05\\left(\\frac{2}{30}\\right) - 0.08\\left(\\frac{0}{3}\\right) - 0.02\\left(\\frac{2}{60}\\right)\n$$\n此计算得出 $S \\approx 0.4468$。对所有测试用例中的所有比对重复此过程，以找到每个测试用例的最优选择。", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of ranking sequence alignments for homology modeling.\n    Computes a composite score for each alignment and selects the best one for each test case.\n    \"\"\"\n\n    # Define the weights for the composite score S.\n    weights = {\n        'w1': 0.35, 'w2': 0.15, 'w3': 0.15, 'w4': 0.10,\n        'w5': 0.10, 'w6': 0.05, 'w7': 0.08, 'w8': 0.02,\n    }\n\n    # Define the test cases. Each alignment is a tuple:\n    # (N, N_c, I_all, I_c, C_c, G_c, G_l, g_max_c, K_m, K, cov)\n    test_cases = [\n        # Test case 1\n        [\n            (90, 60, 55, 40, 15, 1, 2, 2, 0, 3, 0.90),\n            (90, 60, 52, 35, 18, 2, 1, 4, 1, 3, 0.92),\n            (90, 60, 45, 28, 10, 3, 3, 5, 2, 3, 0.95),\n            (90, 60, 58, 36, 12, 5, 0, 6, 0, 3, 0.85),\n            (90, 60, 50, 38, 14, 1, 1, 2, 1, 3, 0.75),\n        ],\n        # Test case 2\n        [\n            (80, 80, 60, 56, 16, 1, 0, 3, 0, 2, 0.80),\n            (80, 80, 59, 55, 18, 0, 0, 0, 0, 2, 0.86),\n            (80, 80, 61, 57, 15, 0, 0, 0, 1, 2, 0.82),\n            (80, 80, 57, 50, 20, 0, 0, 2, 0, 2, 0.90),\n            (80, 80, 56, 55, 10, 4, 0, 5, 0, 2, 0.85),\n        ],\n        # Test case 3\n        [\n            (100, 40, 55, 30, 6, 1, 8, 2, 0, 4, 0.88),\n            (100, 40, 54, 26, 10, 0, 0, 0, 1, 4, 0.90),\n            (100, 40, 54, 26, 12, 0, 1, 0, 0, 4, 0.97),\n            (100, 40, 60, 28, 8, 3, 0, 4, 0, 4, 0.80),\n            (100, 40, 50, 29, 7, 0, 0, 0, 0, 4, 0.70),\n        ],\n    ]\n\n    def calculate_score(alignment_data, w):\n        \"\"\"\n        Computes the composite score S for a single alignment.\n        \"\"\"\n        N, N_c, I_all, I_c, C_c, G_c, G_l, g_max_c, K_m, K, cov = alignment_data\n\n        # Calculate loop size\n        N_l = N - N_c\n\n        # Calculate normalized quantities, checking for zero denominators\n        f_c_id = I_c / N_c if N_c > 0 else 0\n        f_c_cons = C_c / N_c if N_c > 0 else 0\n        f_id = I_all / N if N > 0 else 0\n        r_c_gap = G_c / N_c if N_c > 0 else 0\n        r_l_gap = G_l / N_l if N_l > 0 else 0\n        f_key = K_m / K if K > 0 else 0\n        f_c_gmax = g_max_c / N_c if N_c > 0 else 0\n\n        # Calculate the composite score S\n        score = (\n            w['w1'] * f_c_id +\n            w['w2'] * f_c_cons +\n            w['w3'] * f_id +\n            w['w4'] * cov -\n            w['w5'] * r_c_gap -\n            w['w6'] * r_l_gap -\n            w['w7'] * f_key -\n            w['w8'] * f_c_gmax\n        )\n        return score\n\n    results = []\n    for case in test_cases:\n        scores = [calculate_score(alignment, weights) for alignment in case]\n        # Find the index of the highest score. numpy.argmax returns the index of the\n        # first occurrence in case of a tie, which satisfies the problem statement.\n        best_index = np.argmax(scores)\n        results.append(best_index)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```", "id": "2398300"}, {"introduction": "模型建成后，严格的验证是必不可少的环节，以确保其物理化学合理性和生物学意义。本练习 ([@problem_id:2398359]) 提出了一个经典的验证难题：模型中出现了一个深埋的、未配对的电荷残基。这个问题将挑战你像结构生物学家一样思考，避免草率地将其判断为“错误”，而是学习如何系统地进行生物信息学排查，探究其背后可能存在的稳定机制。", "problem": "您使用与目标序列具有约 $35\\%$ 序列一致性的同源物的实验测定结构，构建了一个酶的比较（同源）模型。在模型验证期间，您发现位置 $R_{157}$ 处的一个精氨酸，其侧链被深埋（通过标准探针测得的相对溶剂可及性 $\\!5\\%$），并且在模建的构象中，其 $5\\,\\text{\\AA}$ 范围内没有邻近的酸性伴侣。该模型不包含任何结合的配体或显式的内部水分子。在接近 $pH\\approx 7$ 的生理 pH 条件下，精氨酸通常是质子化的。您必须判断这一特征是否是关键的模建错误，并确定适当的后续分析。\n\n哪个选项最能说明这是否必然是一个关键错误，并概述了一套在决定重建该区域之前应进行研究的、有科学依据的生物信息学检查方法？\n\nA. 这是一个关键错误，因为任何没有明显盐桥的埋藏正电荷本质上都是不稳定的。唯一明智的补救方法是将该残基突变为一个疏水性氨基酸并重新构建模型；不需要额外的分析。\n\nB. 这不自动算作一个关键错误；尽管在能量上可疑，但一个埋藏的精氨酸可以通过局部氢键网络、阳离子-π 相互作用或变化的质子化状态来稳定，或者它可能与尚未模建的配体或埋藏水分子相互作用。适当的检查包括精确计算溶剂可及性，检查多重序列比对中的保守性和模板结构中同源位置的情况，评估侧链旋转异构体的替代方案和堆积情况，预测局部 $pK_a$ 和静电势，以及在决定重建模型之前评估是否存在缺失的配体或埋藏水分子。\n\nC. 如果该蛋白质是胞质蛋白，那么这不是一个错误，因为细胞内的离子强度会屏蔽静电作用；因此，不需要进一步的检查。\n\nD. 这很可能是一个比对假象；唯一必要的检查是检查序列-结构比对中附近是否存在空位。如果没有空位，那么精氨酸的埋藏是可以接受的，不需要进一步分析。\n\nE. 这通常是有问题的；最快的修复方法是在模建过程中在口袋中放置一个抗衡离子（例如氯离子）以形成盐桥，从而省去额外的验证步骤。", "solution": "首先必须对问题陈述进行严格的验证。\n\n**步骤 1：提取已知条件**\n- **模建方法**：酶的比较（同源）模建。\n- **模板-目标序列一致性**：约 $35\\%$。\n- **关注的特征**：模型中 $R_{157}$ 位置的一个精氨酸残基。\n- **结构特征**：精氨酸侧链被深埋。\n- **定量埋藏度量**：通过标准探针测得的相对溶剂可及性 (RSA) $\\!5\\%$。\n- **局部环境**：在 $5\\,\\text{\\AA}$ 距离内没有邻近的酸性伴侣（天冬氨酸或谷氨酸）。\n- **模型局限性**：模型不包含任何结合的配体或显式的内部水分子。\n- **假定条件**：生理 pH，接近 $pH\\approx 7$。\n- **推断的化学状态**：在 $pH\\approx 7$ 时，假定精氨酸侧链处于其质子化的带正电状态，因为其固有 $pK_a$ 约为 $12.5$。\n- **核心问题**：这个特征是否必然是一个关键的模建错误？科学上适当的后续分析是什么？\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题在科学上是适定的且内部一致的。\n1.  **科学依据**：该前提基于蛋白质生物物理学的基本原理。将一个未补偿的电荷埋藏在蛋白质内部的低介电环境（介电常数 $\\epsilon_p \\approx 2-4$）中，与体相水（$\\epsilon_w \\approx 80$）相比，会产生巨大的能量惩罚，这种现象被称为去溶剂化惩罚。因此，一个埋藏的、显然未配对的电荷（如精氨酸）是蛋白质结构验证中一个众所周知的、合理的危险信号。$35\\%$ 的序列一致性正确地将问题置于同源模建的“模糊区”，在该区域，结构错误（尤其是在环区和侧链堆积方面）是常见的。所有概念——同源模建、RSA、盐桥、pKa、配体、埋藏水分子——在计算结构生物学中都是标准概念。\n2.  **问题的适定性**：该问题是适定的。它描述了一个具体的、常见的观察现象，并要求对其严重性做出判断并为进一步研究提供方案。对于这种情况，存在一套合乎逻辑且独特的最佳实践方法。\n3.  **客观性**：该陈述使用了精确、客观的术语（$R_{157}$、RSA $\\!5\\%$、$5\\,\\text{\\AA}$、$pH\\approx 7$），并避免了主观性语言。\n\n**步骤 3：结论与行动**\n问题陈述是有效的。它提出了一个在蛋白质模型验证中现实且非平凡的挑战。我将继续对各选项进行全面推导和分析。\n\n**解答推导**\n一个埋藏的精氨酸 $R_{157}$，在生理 pH 下带正电，但在盐桥距离（$\\!5\\,\\text{\\AA}$）内没有明显的酸性伴侣（天冬氨酸或谷氨酸），这会带来显著的能量负债。将一个单位电荷从高介电介质（水）转移到低介电介质（蛋白质核心）的玻恩能量是非常不利的。\n\n然而，断定这是一个明确的“关键错误”是草率且不科学的。“错误”一词意味着模型不准确地代表了真实的天然结构。该特征可能是一个真正的模建假象，也可能是一个真实的、但复杂的结构特征，其稳定因素不是立即可见的，或在初始模型中被忽略了。\n\n在蛋白质核心中，电荷可以通过除与酸性残基形成典型盐桥之外的其他机制来稳定：\n1.  **分布式氢键**：精氨酸的胍基是一个极好的氢键供体。它可以与主链羰基氧或极性不带电的侧链（如天冬酰胺、谷氨酰胺、丝氨酸、苏氨酸、酪氨酸）形成多个（$>2$）氢键。这个网络可以有效地使正电荷离域，从而减轻去溶剂化惩罚。\n2.  **阳离子-π 相互作用**：正电荷可以通过与芳香族侧链（色氨酸、酪氨酸或苯丙氨酸）的富电子 π 体系之间有利的静电相互作用来稳定。\n3.  **pKa 偏移**：局部微环境可以显著改变可电离基团的 $pK_a$。虽然疏水环境通常不利于带电状态，因此会提高碱基的 $pK_a$，使其*更*容易被质子化，但局部偶极子的特定排列或一个极不寻常的环境有可能将 $pK_a$ 降低到足以使精氨酸在 $pH \\approx 7$ 时呈中性。考虑到精氨酸的高固有 $pK_a$，这种情况极不可能发生，但在没有计算的情况下不能排除。\n4.  **与缺失的模型组分的相互作用**：问题陈述指出模型缺乏显式的水分子和配体。一个埋藏的电荷通常是结合位点的标志。\n    -   **埋藏的水分子**：一个或多个埋藏的水分子可以介导氢键并稳定电荷。\n    -   **配体或辅因子**：该精氨酸可能是用于结合带负电荷的底物、变构调节剂或结构辅因子（如磷酸基团）的结合口袋的一部分。\n    -   **结构离子**：像氯离子 ($Cl^-$) 或磷酸根离子 ($PO_4^{3-}$) 这样的简单阴离子可能是蛋白质结构的天然组成部分，用于中和精氨酸。\n\n因此，在做出任何重建决定之前，必须进行严谨的调查。正确的做法是进行系统的生物信息学分析，以区分模建假象和真实的功能性特征。所需的步骤包括：\n-   **验证**：首先，确认基本参数。RSA 计算是否正确？该残基是否真的不可及？\n-   **模板与比对分析**：这是最关键的步骤。检查用于模建的模板结构。在同源位置存在什么残基？如果它是一个保守的精氨酸，那么在高分辨率的实验结构中它是如何被稳定的？它是否结合了配体、金属，或形成了一个不明显的相互作用网络？检查序列-结构比对中可能存在的错误，尤其是在空位附近或序列相似性低的区域。\n-   **构象采样**：模建的侧链构象（旋转异构体）可能不正确。探索 $R_{157}$ 及其邻近残基的其他旋转异构体，看是否存在更稳定的构象，例如，能将侧链暴露于溶剂或形成稳定相互作用的构象。\n-   **生物物理计算**：使用计算工具分析模型。预测局部静电势。对 $R_{157}$ 进行 $pK_a$ 计算，以评估其电离状态发生偏移的可能性。\n-   **生物学背景**：研究该酶家族的已知生物学信息。文献或数据库注释（例如 UniProt、PDBsum）是否表明存在特定的配体或离子？\n\n只有在这些详尽的检查都无法解释这个埋藏电荷之后，才应将该特征视为一个可能的假象，并进行局部重建或精修。\n\n**选项评估**\n\n**A. 这是一个关键错误，因为任何没有明显盐桥的埋藏正电荷本质上都是不稳定的。唯一明智的补救方法是将该残基突变为一个疏水性氨基酸并重新构建模型；不需要额外的分析。**\n这个陈述是教条式的且不正确。它草率地宣布存在错误，并提出了一个完全不恰当的“补救”措施。模建的目标是代表野生型蛋白质，而不是进行计算机模拟诱变来创造一个更“稳定”但非天然的结构。拒绝进一步分析在科学上是不可接受的。\n**结论：不正确。**\n\n**B. 这不自动算作一个关键错误；尽管在能量上可疑，但一个埋藏的精氨酸可以通过局部氢键网络、阳离子-π 相互作用或变化的质子化状态来稳定，或者它可能与尚未模建的配体或埋藏水分子相互作用。适当的检查包括精确计算溶剂可及性，检查多重序列比对中的保守性和模板结构中同源位置的情况，评估侧链旋转异构体的替代方案和堆积情况，预测局部 $pK_a$ 和静电势，以及在决定重建模型之前评估是否存在缺失的配体或埋藏水分子。**\n这个选项正确地描述了情况的细微之处。它正确地指出该特征是可疑的，但不能确定是错误。它准确地列出了稳定这种电荷的可能物理机制。至关重要的是，它概述了一套在得出任何结论之前必须执行的全面且科学严谨的分析步骤。这代表了计算结构生物学中的尽职调查标准。\n**结论：正确。**\n\n**C. 如果该蛋白质是胞质蛋白，那么这不是一个错误，因为细胞内的离子强度会屏蔽静电作用；因此，不需要进一步的检查。**\n这个推理是有缺陷的。虽然体相溶剂的离子强度影响长程静电相互作用，但它并不能消除将电荷移入蛋白质低介电内部所带来的巨大去溶剂化惩罚。主要的能量成本是局部的，而不是长程的。做出不进行进一步检查的结论是不负责任的。\n**结论：不正确。**\n\n**D. 这很可能是一个比对假象；唯一必要的检查是检查序列-结构比对中附近是否存在空位。如果没有空位，那么精氨酸的埋藏是可以接受的，不需要进一步分析。**\n这是过度简化。比对假象是一个可能的原因，但不是唯一的原因。此外，即使在没有附近空位的情况下，比对也可能不正确。该选项忽略了许多其他重要的检查（模板分析、旋转异构体库、静电学、缺失的配体），并得出了没有空位就证明结构有效的毫无根据的结论。\n**结论：不正确。**\n\n**E. 这通常是有问题的；最快的修复方法是在模建过程中在口袋中放置一个抗衡离子（例如氯离子）以形成盐桥，从而省去额外的验证步骤。**\n这相当于捏造数据。在没有任何实验或强有力的比较证据的情况下引入抗衡离子，是一种临时的“修复”，它使模型在没有任何现实依据的情况下看起来更好。科学模建要求基于证据来证明特征的合理性，而不是为了证明特征而捏造证据。这种方法完全绕过了必要的验证过程。\n**结论：不正确。**", "answer": "$$\\boxed{B}$$", "id": "2398359"}]}