## 引言
[核苷酸](@entry_id:275639)取代模型是现代计算生物学和[进化生物学](@entry_id:145480)的基石，它为我们破译隐藏在DNA序列中的生命演化历史提供了强大的定量工具。当我们比较两个物种的基因组时，一个看似简单的问题是：它们有多“远”？直观地计算序列间的差异百分比似乎是一个合理的答案，但这却忽略了一个关键的演化现实——随着时间的推移，同一位点可能发生多次未被观察到的取代事件，即所谓的“多重命中”，导致我们严重低估真实的进化距离。

本文旨在系统性地解决这一问题，深入剖析[核苷酸](@entry_id:275639)取代模型的原理与应用。我们将带领读者开启一段从理论到实践的探索之旅。在第一章“原理与机制”中，我们将建立描述[核苷酸](@entry_id:275639)取代过程的[连续时间马尔可夫链](@entry_id:276307)数学框架，并在此基础上，逐一介绍从简单的JC69到复杂的GTR等经典模型，理解它们如何校正[演化距离](@entry_id:177968)。随后，在第二章“应用与跨学科联系”中，我们将展示这些模型在[系统发育分析](@entry_id:172534)中的核心应用，例如如何通过模型选择提高建树的准确性，以及如何利用模型[参数推断](@entry_id:753157)选择压力等演化过程，并进一步探索其思想在其他学科中的延伸。最后，第三章“动手实践”将通过具体的计算问题，帮助你将理论知识转化为解决实际问题的能力。

通过本文的学习，你将不仅掌握[核苷酸](@entry_id:275639)取代模型这一具体工具，更能领会其背后普适的[随机过程](@entry_id:159502)建模思想。现在，让我们从最核心的问题开始：如何为那些看不见的演化历史进行校正。

## 原理与机制

在上一章中，我们介绍了[核苷酸](@entry_id:275639)取代模型在[进化生物学](@entry_id:145480)中的核心作用，即作为一种工具来推断物种间的[进化关系](@entry_id:175708)。本章将深入探讨这些模型的内部工作原理。我们将从一个基本问题开始：为什么我们不能简单地通过计算两个DNA序列之间的差异来衡量它们的进化距离？然后，我们将构建描述[核苷酸](@entry_id:275639)取代过程的数学框架，并在此框架内，系统地介绍一系列从简单到复杂的标准模型。最后，我们将讨论这些模型的一些关键属性和重要扩展，这些属性和扩展使其能够更好地拟合真实生物数据的复杂性。

### 核心问题：为不可见的演化历史进行校正

想象一下，我们有两个同源的DNA序列，每个序列都来自一个不同的物种。衡量它们之间差异的一个最直观的方法是计算它们在比对后不相同的[核苷酸](@entry_id:275639)位点的比例。这个比例被称为 **p-距离** (p-distance)。例如，如果两个长度为1000个碱基对的序列在250个位点上有所不同，那么p-距离就是 $250/1000 = 0.25$。

然而，p-距离仅仅是当前差异的一个“快照”，它并不能完全反映两个物种自其共同祖先分化以来所发生的全部演化事件。其根本原因在于，随着时间的推移，同一个[核苷酸](@entry_id:275639)位点可能经历多次取代事件。这些事件被称为 **多重命中** (multiple hits)，它们会掩盖真实的演化历史，导致p-距离系统性地低估了真实的[演化距离](@entry_id:177968)。

考虑以下几种情况，它们都可能导致p-距离的低估 [@problem_id:1951108]：

1.  **平行取代 (Parallel Substitution)**：在两个不同的谱系中，同一个位点独立地从祖先状态（如 A）突变为相同的[核苷酸](@entry_id:275639)（如 G）。尽管发生了两次取代事件，但这两个序列在该位点上仍然是相同的（都是 G），因此观察到的差异为零。

2.  **[回复突变](@entry_id:163326) (Back-substitution)**：在一个谱系中，一个位点可能从 A 变为 G，然后在后续的演化中又变回了 A。发生了两次取代，但最终状态与初始状态相同，观察到的差异同样为零。

3.  **多重但非回复的取代**：在一个谱系中，位点从 A 变为 G；在另一个谱系中，位点从 A 变为 C。虽然总共发生了两次取代，但我们只能观察到一次差异（G vs C）。

随着演化时间的增加，发生多重命中的概率也随之增加。最终，序列差异会达到一个平台期，即使演化仍在继续，p-距离也不再增加。这种现象被称为 **饱和** (saturation)。例如，对于一个简单的模型，当时间趋于无穷时，任意两个序列在任一位点上相同的概率会趋向于一个非零的平衡值（例如0.25），这意味着p-距离的最大值被限制在0.75左右，而真实的[演化距离](@entry_id:177968)（以每个位点的平均取代次数计）理论上可以无限增加。

因此，[核苷酸](@entry_id:275639)取代模型的首要目标，就是通过数学方法来校正这种由多重命中造成的低估，从而从可观察的p-距离推断出更接近真实的[演化距离](@entry_id:177968)，我们通常用 $K$ 来表示。这个校正过程的数学本质，我们稍后会看到，通常涉及对数函数。这是因为序列保持不变的概率随时间呈指数衰减，而反转这种指数关系就需要用到对数 [@problem_id:2407113]。

在深入模型细节之前，区分 **突变 (mutation)** 和 **取代 (substitution)** 这两个概念至关重要。突变是指[DNA复制](@entry_id:140403)或修复过程中发生的错误，是新遗传变异的原始来源。然而，并非所有突变都能在群体中保留下来。一个新突变的命运受到[遗传漂变](@entry_id:145594)和自然选择的共同影响。只有当一个突变在群体中[扩散](@entry_id:141445)并最终被 **固定** (fixation) 下来，即其频率达到100%时，我们才称之为一个取代。[核苷酸](@entry_id:275639)取代模型所模拟的，正是这个取代的速率，而不是原始的突变率。在[中性演化](@entry_id:172700)理论下，一个[中性突变](@entry_id:176508)的[固定概率](@entry_id:178551)等于其在群体中的初始频率（对于[二倍体](@entry_id:268054)生物是 $1/(2N_e)$，其中 $N_e$ 是有效种群大小），因此中性取代率 $k_{neutral}$ 恰好等于[突变率](@entry_id:136737) $\mu$。然而，对于受正选择的有利突变，其[固定概率](@entry_id:178551)会显著提高（近似为 $2s$，其中 $s$ 是[选择系数](@entry_id:155033)），导致其取代率 $k_{adv}$ 远高于[突变率](@entry_id:136737)。例如，在一个大的昆虫种群中，一个具有微[弱优势](@entry_id:138271)（$s = 5.0 \times 10^{-4}$）的突变，其取代率可以比[中性突变](@entry_id:176508)高出数百倍 [@problem_id:1951131]。这提醒我们，模型中的速[率参数](@entry_id:265473)综合了突变、漂变和选择等复杂的群体遗传学过程。

### 数学框架：[连续时间马尔可夫链](@entry_id:276307)

现代[核苷酸](@entry_id:275639)取代模型普遍建立在 **[连续时间马尔可夫链](@entry_id:276307)** (Continuous-Time Markov Chain, CTMC) 的数学框架之上。这个框架为描述一个系统（在这里是一个[核苷酸](@entry_id:275639)位点）在不同状态（{A, C, G, T}）之间随时间随机转换的过程提供了一套严谨的语言 [@problem_id:2739889]。

一个CTMC模型由以下几个关键部分定义：

**[状态空间](@entry_id:177074)**：对于DNA，[状态空间](@entry_id:177074)是四个[核苷酸](@entry_id:275639)碱基的集合，即 $S = \{A, C, G, T\}$。

**速率矩阵 (Rate Matrix)** $Q$：这是一个 $4 \times 4$ 的矩阵，是模型的核心。
*   对于任意两个不同的状态 $i$ 和 $j$（例如 $i=A, j=C$），[矩阵元](@entry_id:186505)素 $q_{ij}$ 是从状态 $i$ 瞬间转变为状态 $j$ 的 **[瞬时速率](@entry_id:182981)**。这个速率必须是非负的，即 $q_{ij} \ge 0$。在极小的时间间隔 $\Delta t$ 内，一个处于状态 $i$ 的位点转变为状态 $j$ 的概率近似为 $q_{ij} \Delta t$。
*   矩阵的对角[线元](@entry_id:196833)素 $q_{ii}$ 被定义为离开状态 $i$ 的所有速率之和的负数，即 $q_{ii} = - \sum_{j \neq i} q_{ij}$。这保证了矩阵的每一行之和都等于零。$-q_{ii}$ 的量值代表了从状态 $i$ 转变到任何其他状态的总速率。

**转移[概率矩阵](@entry_id:274812) (Transition Probability Matrix)** $P(t)$：这是一个 $4 \times 4$ 的矩阵，其元素 $p_{ij}(t)$ 表示在经过时间 $t$ 后，一个初始状态为 $i$ 的位点，其最终状态为 $j$ 的概率。这个矩阵具有所有[概率矩阵](@entry_id:274812)的性质，例如所有元素都在 $[0, 1]$ 区间内，并且每一行之和为1。

$Q$ 矩阵和 $P(t)$ 矩阵通过一个基本的[微分方程组](@entry_id:148215)（[柯尔莫哥洛夫方程](@entry_id:270139)）联系在一起，其解可以用 **矩阵指数** (matrix exponential) 的形式优美地表达 [@problem_id:2407160]：
$$ P(t) = \exp(Qt) = \sum_{k=0}^{\infty} \frac{(Qt)^k}{k!} $$
这个关系式是整个理论的基石。它揭示了几个重要属性：
*   当 $t=0$ 时，没有时间流逝，位点状态不变，因此 $P(0) = I$ (单位矩阵)。
*   对时间求导，我们得到柯尔莫哥洛夫前向方程 $\frac{d}{dt}P(t) = P(t)Q$（或后向方程 $\frac{d}{dt}P(t) = QP(t)$），这表明速率矩阵 $Q$ 决定了概率随时间的变化方式。
*   如果 $\lambda$ 是 $Q$ 的一个[特征值](@entry_id:154894)，那么 $e^{\lambda t}$ 就是 $P(t)$ 的一个[特征值](@entry_id:154894)。由于 $Q$ 的行和为零，它总有一个[特征值](@entry_id:154894)为0，对应的[特征向量](@entry_id:151813)是所有元素为1的向量。其他[特征值](@entry_id:154894)通常是负实数或共轭复数（对于可逆模型，均为负实数），这导致了概率函数中包含指数衰减项 $e^{\lambda t}$，这也是距离校正公式中出现对数的原因。

**[平稳分布](@entry_id:194199) (Stationary Distribution)** $\boldsymbol{\pi}$：这是一个行向量 $\boldsymbol{\pi} = (\pi_A, \pi_C, \pi_G, \pi_T)$，其中 $\pi_i$ 代表在演化[达到平衡](@entry_id:170346)时，状态 $i$ 出现的频率，即碱[基频](@entry_id:268182)率。它满足 $\sum \pi_i = 1$。在数学上，[平稳分布](@entry_id:194199)是满足 $\boldsymbol{\pi}Q = \mathbf{0}$ 的[概率向量](@entry_id:200434)。这意味着一旦达到平稳分布，碱基的总体频率将不再随时间改变，即 $\boldsymbol{\pi}P(t) = \boldsymbol{\pi}$ 对于所有 $t \ge 0$ 成立 [@problem_id:2407160]。

最后，在系统发育学中，通常会对 $Q$ 矩阵进行 **标度 (scaling)**，使得沿着树枝的预期取代次数与枝长成正比。一个常见的约定是调整 $Q$ 矩阵，使得平均取代率 $\mu = - \sum_i \pi_i q_{ii}$ 等于1。在这种标度下，长度为 $t$ 的树枝就代表了每个位点预期发生 $t$ 次取代。

### 模型层级结构

不同的[核苷酸](@entry_id:275639)取代模型，本质上是对速率矩阵 $Q$ 施加了不同的约束。这些模型形成了一个嵌套的层级结构，从最简单的模型开始，通过逐步放宽约束，可以得到更复杂、更普适的模型 [@problem_id:1951089]。

#### [Jukes-Cantor (JC69)](@entry_id:176270) 模型

JC69模型是最基础的模型，它做了两个最强的简化假设：
1.  **所有类型的取代都以相同的速率发生**。即速率矩阵 $Q$ 的所有非对角元素都相等，设为 $\alpha$。
2.  **所有[核苷酸](@entry_id:275639)的[平衡频率](@entry_id:275072)相等**。即 $\pi_A = \pi_C = \pi_G = \pi_T = 0.25$。

在JC69模型下，从任意一个碱基转变为其他三个碱基中任意一个的概率都是相同的。然而，这个“所有碱基频率相等”的假设在真实的生物数据中常常不成立。许多生物的基因组在碱[基组](@entry_id:160309)成上存在偏好，例如某些细菌基因组的[GC含量](@entry_id:275315)（鸟嘌呤和胞嘧啶的比例）可能远高于或低于50%。这种现象被称为 **[GC含量](@entry_id:275315)偏倚 (GC-content bias)**，它是对JC69模型假设的一个直接违背 [@problem_id:1951130]。

#### Kimura 2-Parameter (K80) 模型

生物化学研究表明，[核苷酸](@entry_id:275639)的取代并非完全随机。在化学结构上，A和G属于 **嘌呤 (purines)**，C和T属于 **嘧啶 (pyrimidines)**。在嘌呤之间 (A↔G) 或嘧啶之间 (C↔T) 发生的取代被称为 **转换 (transition)**。在[嘌呤和嘧啶](@entry_id:168622)之间发生的取代被称为 **[颠换](@entry_id:270979) (transversion)**。由于转换过程涉及的化学结构变化较小，在生物体内，转换的发生频率通常显著高于[颠换](@entry_id:270979)。

K80模型正是为了捕捉这一生物学现实而提出的。它放宽了JC69的第一个假设：
1.  **转换和[颠换](@entry_id:270979)有不同的速率**。所有转换以速率 $\alpha$ 发生，所有[颠换](@entry_id:270979)以速率 $\beta$ 发生。
2.  **所有[核苷酸](@entry_id:275639)的[平衡频率](@entry_id:275072)仍然相等** ($\pi_i = 0.25$)。

当观察到的数据中转换和[颠换](@entry_id:270979)的比例严重失衡时（例如，观察到20次转换和4次[颠换](@entry_id:270979)），JC69模型的单一速率假设显然被违背了。此时，使用能够区分这两种速率的K80模型会更加合理和准确 [@problem_id:1951148]。从模型层级上看，K80是JC69的推广。如果我们在K80模型中设定转换速率等于[颠换](@entry_id:270979)速率（$\alpha=\beta$），它就退化为了JC69模型。

#### Hasegawa-Kishino-Yano (HKY85) 模型

[HKY85模型](@entry_id:163074)在K80的基础上，进一步放宽了关于碱基频率的假设，使其能同时处理转换/[颠换](@entry_id:270979)速率差异和碱基频率偏倚这两种常见的生物学现象。
1.  **转换和[颠换](@entry_id:270979)有不同的速率**。
2.  **允许不相等的平衡碱基频率** ($\pi_A, \pi_C, \pi_G, \pi_T$ 可以是任意值，只要总和为1)。

因此，当面对一个数据集，它既表现出显著的转换/[颠换](@entry_id:270979)偏倚，又显示出强烈的[GC含量](@entry_id:275315)偏倚时（例如[GC含量](@entry_id:275315)为70%），K80模型就显得力不从心了，因为它无法处理不等的碱[基频](@entry_id:268182)率。在这种情况下，[HKY85模型](@entry_id:163074)是更合适的选择 [@problem_id:1951132]。从层级上看，HKY85是K80的推广。如果在[HKY85模型](@entry_id:163074)中设定所有碱[基频](@entry_id:268182)率相等 ($\pi_i = 0.25$)，它就退化为了K80模型。

综上所述，这三个模型形成了一个清晰的嵌套层级：HKY85 $\rightarrow$ K80 $\rightarrow$ JC69。从复杂到简单的方向，HKY85在设定 **所有平衡碱[基频](@entry_id:268182)率相等** 的约束下简化为K80；K80在设定 **转换速率等于[颠换](@entry_id:270979)速率** 的约束下简化为JC69 [@problem_id:1951089]。更进一步，最普适的可逆模型之一是 **通用时间可逆 (General Time-Reversible, GTR)** 模型，它为每对碱基间的对称取代（如A↔C, A↔G, A↔T, C↔G, C↔T, G↔T）都设定了独立的速率参数，并允许不等的碱基频率。

### 重要模型属性与扩展

除了基本的模型层级，还有一些重要的概念和扩展，它们极大地增强了模型在实际应用中的灵活性和真实性。

#### [时间可逆性](@entry_id:274492) (Time Reversibility)

几乎所有标准的[核苷酸](@entry_id:275639)取代模型（包括JC69, K80, HKY85, GTR）都具有一个称为 **[时间可逆性](@entry_id:274492)** 的重要数学属性。一个[马尔可夫过程](@entry_id:160396)是时间可逆的，如果它满足 **[细致平衡条件](@entry_id:265158) (detailed balance condition)** [@problem_id:1951125]：
$$ \pi_i q_{ij} = \pi_j q_{ji} \quad \text{对于所有 } i \neq j $$
这个方程的直观含义是，在演化达到平衡时，从状态 $i$ 流向状态 $j$ 的“通量”等于从状态 $j$ 反向流回状态 $i$ 的“通量”。换句话说，[演化过程](@entry_id:175749)在统计上无法区分时间是向前还是向后流逝的。

[时间可逆性](@entry_id:274492)在[系统发育分析](@entry_id:172534)中具有巨大的计算优势。它意味着在计算一棵给定拓扑结构的[系统发育树](@entry_id:140506)的[似然性](@entry_id:167119) (likelihood) 时，我们无需知道树根 (root) 的位置。无论我们将根放在树的哪个枝上，计算出的整棵树的似然值都是相同的。这使得我们可以专注于推断[无根树](@entry_id:199885)的拓扑和枝长，大大简化了计算的复杂性。

#### [位点间速率异质性](@entry_id:177947) (Among-Site Rate Heterogeneity)

到目前为止，我们讨论的模型都隐含了一个假设：序列中的所有位点都以相同的速率演化。然而，生物学现实并非如此。在一段基因或基因组区域中，不同位点承受的[选择压力](@entry_id:175478)不同，导致它们的演化速率也不同。例如，在蛋白质编码基因中，决定活性的关键氨基酸的[密码子](@entry_id:274050)位点会受到强烈的[纯化选择](@entry_id:170615)，其演化速率非常慢（**保守位点**）；而一些非功能性区域，如某些内含子区域，则可能以接近中性速率的速度快速演化（**易变位点**）。

忽略这种 **[位点间速率异质性](@entry_id:177947) (Among-Site Rate Heterogeneity, ASRH)** 会导致严重的系统性误差，通常是低估较长分支的长度。原因在于，模型会错误地将观察到的差异平均分配到所有位点上。而实际上，许多差异都集中在少数快速演化的位点上，这些位点因此经历了更多的多重命中。一个未能考虑ASRH的模型会低估这些位点上发生的隐藏取代次数。

为了解决这个问题，我们可以为基础模型增加一个描述速率变化的组件。最常用的方法是假设不同位点的速率值是从一个 **伽马 ($\Gamma$) [分布](@entry_id:182848)** 中抽取的。这个[分布](@entry_id:182848)由一个 **形状参数** $a$ (或 $\alpha$) 控制。$a$ 的值越小，速率[分布](@entry_id:182848)越不均匀（即[速率异质性](@entry_id:149577)越强）；当 $a$ 趋于无穷大时，所有位点的速率趋于相等，模型退化为均匀速率模型。

将伽马[分布](@entry_id:182848)整合到模型中（例如，JC69+$\Gamma$）会得到一个更复杂的距离校正公式。对于相同的观察差异 $p$，考虑了[速率异质性](@entry_id:149577)的模型（如JC69+$\Gamma$）通常会估算出比均匀速率模型（如JC69）更大的[演化距离](@entry_id:177968)。例如，对于20%的序列差异，使用一个中等强度的[速率异质性](@entry_id:149577)（$a=0.5$）模型估算的距离，可能是均匀速率模型估算距离的1.39倍 [@problem_id:1951123]。这反映了对那些快速演化位点上更严重的多重命中的校正。