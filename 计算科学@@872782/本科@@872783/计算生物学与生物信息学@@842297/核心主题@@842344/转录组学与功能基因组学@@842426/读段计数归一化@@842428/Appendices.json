{"hands_on_practices": [{"introduction": "在比较不同实验样本中同一基因的表达水平时，我们面临的第一个挑战是总测序读数（即测序深度）的差异。原始读数计数可能会产生误导，因为它没有考虑到一个样本可能比另一个样本测序得更深。本练习将通过一个具体案例，演示像RPKM这样的归一化方法如何校正测序深度，从而实现更准确的跨样本表达量比较。[@problem_id:2424950]", "problem": "一项RNA测序实验分析了两个样本中的一个基因。在样本A中，该基因获得了$1$个唯一比对上的读段（read），总唯一比对读段数为$10 \\times 10^{6}$。在样本B中，该基因获得了$2$个唯一比对上的读段，总唯一比对读段数为$20 \\times 10^{6}$。该基因的长度为$1$千碱基（kb）。每千碱基转录本每百万比对读段的读段数（RPKM）定义为分配给一个基因的读段数，并根据基因长度（以千碱基为单位）和总比对读段数（以百万为单位）进行归一化。\n\n计算该基因以RPKM衡量的表达倍数变化，定义为样本B中该基因的RPKM与样本A中该基因的RPKM之比。以纯数字（无单位）形式报告您的答案，并四舍五入到三位有效数字。", "solution": "首先将对问题陈述进行严格验证。\n\n**步骤1：提取已知条件**\n- 样本A：基因获得$1$个唯一比对上的读段。\n- 样本A：总唯一比对读段数为$10 \\times 10^{6}$。\n- 样本B：基因获得$2$个唯一比对上的读段。\n- 样本B：总唯一比对读段数为$20 \\times 10^{6}$。\n- 基因长度：$1$千碱基（kb）。\n- RPKM（每千碱基转录本每百万比对读段的读段数）的定义：分配给一个基因的读段数，并根据基因长度（以千碱基为单位）和总比对读段数（以百万为单位）进行归一化。\n- 要求计算：倍数变化，定义为样本B中基因的RPKM与样本A中基因的RPKM之比。\n- 要求格式：纯数字，四舍五入到三位有效数字。\n\n**步骤2：使用提取的已知条件进行验证**\n根据所需标准对问题进行评估。\n- **科学依据**：该问题描述了RNA测序数据分析中的一个标准、基础的计算。RPKM是一种公认的（尽管现在常被取代）用于归一化基因表达的指标。所提供的值对于真实实验是合理的。该问题具有科学合理性。\n- **良态问题**：所有必要的数据和定义都已提供。目标明确，能导出一个唯一、稳定的解。该问题是良态的。\n- **客观性**：该问题使用精确、定量和无偏见的语言进行陈述。它不含主观或基于意见的主张。\n\n**步骤3：结论与行动**\n该问题是有效的。它具有科学依据、是良态的、客观且完整。现在将推导解决方案。\n\n该问题要求计算两个样本之间基因表达的倍数变化，其中表达量使用每千碱基转录本每百万比对读段数（RPKM）指标进行量化。\n\n让我们从问题陈述中定义变量：\n- $C_A$：样本A中比对到该基因的读段数，$C_A = 1$。\n- $N_A$：样本A中的总比对读段数，$N_A = 10 \\times 10^{6}$。\n- $C_B$：样本B中比对到该基因的读段数，$C_B = 2$。\n- $N_B$：样本B中的总比对读段数，$N_B = 20 \\times 10^{6}$。\n- $L$：基因的长度，单位为千碱基（kb），$L = 1$。\n\nRPKM的定义如下：\n$$ \\text{RPKM} = \\frac{\\text{Number of reads}}{(\\text{Gene length in kb}) \\times (\\text{Total reads in millions})} $$\n这可以数学化地表述。总读段数（以百万为单位）是总读段计数除以$10^6$。\n$$ \\text{RPKM} = \\frac{C}{L \\times (N / 10^6)} $$\n其中$C$是基因的读段计数，$L$是基因长度（以kb为单位），$N$是总文库大小（总比对读段数）。\n\n首先，我们计算样本A的RPKM（$\\text{RPKM}_A$）：\n$$ \\text{RPKM}_A = \\frac{C_A}{L \\times (N_A / 10^6)} $$\n代入给定值：\n$$ \\text{RPKM}_A = \\frac{1}{1 \\times (10 \\times 10^6 / 10^6)} = \\frac{1}{1 \\times 10} = 0.1 $$\n\n接下来，我们计算样本B的RPKM（$\\text{RPKM}_B$）：\n$$ \\text{RPKM}_B = \\frac{C_B}{L \\times (N_B / 10^6)} $$\n代入给定值：\n$$ \\text{RPKM}_B = \\frac{2}{1 \\times (20 \\times 10^6 / 10^6)} = \\frac{2}{1 \\times 20} = \\frac{2}{20} = 0.1 $$\n\n问题要求计算倍数变化（FC），定义为$\\text{RPKM}_B$与$\\text{RPKM}_A$的比值。\n$$ \\text{FC} = \\frac{\\text{RPKM}_B}{\\text{RPKM}_A} $$\n代入计算出的RPKM值：\n$$ \\text{FC} = \\frac{0.1}{0.1} = 1 $$\n\n另外，我们也可以先进行符号运算来计算倍数变化，这是一种更稳健的方法。\n$$ \\text{FC} = \\frac{\\text{RPKM}_B}{\\text{RPKM}_A} = \\frac{\\frac{C_B}{L \\times (N_B / 10^6)}}{\\frac{C_A}{L \\times (N_A / 10^6)}} $$\n基因长度$L$和缩放因子$10^6$在分子和分母中是共有的，因此它们可以消去：\n$$ \\text{FC} = \\frac{C_B / N_B}{C_A / N_A} = \\frac{C_B}{C_A} \\times \\frac{N_A}{N_B} $$\n该表达式表明，RPKM的倍数变化是原始读段计数的比值，并用总文库大小的反比进行校正。现在，我们将数值代入这个简化表达式中：\n$$ \\text{FC} = \\frac{2}{1} \\times \\frac{10 \\times 10^6}{20 \\times 10^6} = 2 \\times \\frac{10}{20} = 2 \\times \\frac{1}{2} = 1 $$\n\n结果恰好是$1$。问题要求答案四舍五入到三位有效数字。为了用三位有效数字表示$1$，我们将其写为$1.00$。这表示该值精确到百分位。\n原始读段计数的加倍（从$1$到$2$）被测序深度的加倍（从$10$百万到$20$百万读段）完全抵消，导致归一化后的表达值相同，因此倍数变化为$1$。", "answer": "$$\n\\boxed{1.00}\n$$", "id": "2424950"}, {"introduction": "除了测序深度，基因本身的长度是另一个主要的偏倚来源。在同一样本中，即使表达水平相同，较长的基因也自然会捕获比短基因更多的测序读数。这个练习旨在阐明TPM（每百万转录本）等归一化方法如何解决这个问题，从而能够公平地比较同一样本内不同基因的表达丰度。[@problem_id:2424999]", "problem": "一项RNA测序实验获得了在同一样本中测量的两个单一异构体基因的唯一比对读数计数。基因$\\mathcal{A}$的长度为$500$个碱基对（bp），有$50$个比对读数。基因$\\mathcal{B}$的长度为$5000$个碱基对（bp），有$450$个比对读数。每百万转录本（TPM）被定义为一种样本内表达量度量，其计算方法是：首先，用每个基因的转录本长度（以千碱基为单位）对该基因的读数计数进行标准化；然后，对得到的值进行缩放，使样本中所有基因的缩放后值的总和等于一百万。\n\n仅使用上述信息和TPM的定义，通过计算比率$\\mathrm{TPM}_{\\mathcal{A}} / \\mathrm{TPM}_{\\mathcal{B}}$，确定哪个基因在该样本中表达水平更高。请以无单位的精确分数形式表示您的答案。最终答案必须是单个实数值。", "solution": "该问题要求计算来自单个RNA测序样本的两个基因$\\mathcal{A}$和$\\mathcal{B}$的每百万转录本（$\\mathrm{TPM}$）的比率。\n\n首先，我们必须严格地形式化所提供的$\\mathrm{TPM}$定义。设$C_i$为基因$i$的唯一比对读数数量，设$L_i$为基因$i$的长度（以碱基对bp为单位）。该定义包含两个步骤。\n\n步骤1：用以千碱基（kb）为单位的基因长度对读数计数进行标准化。\n基因$i$的长度（以千碱基为单位），记作$L_{i, \\text{kb}}$，由$L_{i, \\text{kb}} = \\frac{L_i}{1000}$给出。\n长度标准化的读数计数，我们称之为$R_i$，是读数计数与基因长度（以千碱基为单位）的比率：\n$$R_i = \\frac{C_i}{L_{i, \\text{kb}}} = \\frac{C_i}{L_i / 1000}$$\n\n步骤2：对这些标准化后的计数进行缩放，使得样本中所有基因的缩放后值的总和等于一百万（$10^6$）。\n设$\\mathcal{G}$表示样本中所有基因的集合。所有长度标准化的读数计数之和由缩放因子$S$给出：\n$$S = \\sum_{j \\in \\mathcal{G}} R_j$$\n单个基因$i$的$\\mathrm{TPM}$值随后计算如下：\n$$\\mathrm{TPM}_i = \\left( \\frac{R_i}{S} \\right) \\times 10^6$$\n\n我们已知以下数据：\n对于基因$\\mathcal{A}$：\n- 读数计数：$C_{\\mathcal{A}} = 50$\n- 长度：$L_{\\mathcal{A}} = 500$ bp\n\n对于基因$\\mathcal{B}$：\n- 读数计数：$C_{\\mathcal{B}} = 450$\n- 长度：$L_{\\mathcal{B}} = 5000$ bp\n\n我们现在对每个基因应用步骤1。\n对于基因$\\mathcal{A}$，其长度（以千碱基为单位）是 $L_{\\mathcal{A}, \\text{kb}} = \\frac{500}{1000} = 0.5$ kb。\n基因$\\mathcal{A}$的长度标准化读数计数是：\n$$R_{\\mathcal{A}} = \\frac{C_{\\mathcal{A}}}{L_{\\mathcal{A}, \\text{kb}}} = \\frac{50}{0.5} = 100$$\n\n对于基因$\\mathcal{B}$，其长度（以千碱基为单位）是 $L_{\\mathcal{B}, \\text{kb}} = \\frac{5000}{1000} = 5$ kb。\n基因$\\mathcal{B}$的长度标准化读数计数是：\n$$R_{\\mathcal{B}} = \\frac{C_{\\mathcal{B}}}{L_{\\mathcal{B}, \\text{kb}}} = \\frac{450}{5} = 90$$\n\n问题要求计算比率$\\frac{\\mathrm{TPM}_{\\mathcal{A}}}{\\mathrm{TPM}_{\\mathcal{B}}}$。使用$\\mathrm{TPM}$的公式，我们可以将这个比率写为：\n$$\\frac{\\mathrm{TPM}_{\\mathcal{A}}}{\\mathrm{TPM}_{\\mathcal{B}}} = \\frac{\\left( \\frac{R_{\\mathcal{A}}}{S} \\right) \\times 10^6}{\\left( \\frac{R_{\\mathcal{B}}}{S} \\right) \\times 10^6}$$\n\n每百万缩放因子$10^6$和标准化读数总和$S$对于两个基因是相同的，因为它们是在同一样本中测量的。因此，这些项在比率中被消去：\n$$\\frac{\\mathrm{TPM}_{\\mathcal{A}}}{\\mathrm{TPM}_{\\mathcal{B}}} = \\frac{R_{\\mathcal{A}}}{R_{\\mathcal{B}}}$$\n这表明，在同一样本中两个基因的$\\mathrm{TPM}$值的比率仅取决于它们各自的读数计数和长度，而与文库中的任何其他基因无关。\n\n代入$R_{\\mathcal{A}}$和$R_{\\mathcal{B}}$的计算值：\n$$\\frac{\\mathrm{TPM}_{\\mathcal{A}}}{\\mathrm{TPM}_{\\mathcal{B}}} = \\frac{100}{90}$$\n化简这个分数得到最终结果：\n$$\\frac{\\mathrm{TPM}_{\\mathcal{A}}}{\\mathrm{TPM}_{\\mathcal{B}}} = \\frac{10}{9}$$\n由于比率$\\frac{10}{9} > 1$，显然$\\mathrm{TPM}_{\\mathcal{A}} > \\mathrm{TPM}_{\\mathcal{B}}$，这意味着在该样本中基因$\\mathcal{A}$的表达水平高于基因$\\mathcal{B}$。问题要求的是这个比率的数值。", "answer": "$$\\boxed{\\frac{10}{9}}$$", "id": "2424999"}, {"introduction": "掌握了归一化的基本原理后，将这些概念应用于实际数据集至关重要。这个综合练习要求你从一个包含多个基因原始读数和长度的假设数据集中，完整地计算出特定基因的TPM值。通过这个过程，你将把对基因长度和文库大小的校正结合起来，从而巩固对TPM计算流程的理解。[@problem_id:2424928]", "problem": "一项实验采用单端 RNA 测序技术，对单个样本中的信使核糖核酸（mRNA）表达谱进行分析。考虑以下基因水平的数据集，其中每个基因 $G_{i}$ 都有一个转录本长度和一个观测到的原始读数计数。比对上的读数总数等于所示原始计数的总和。\n\n- 基因 $G_{1}$：长度 $2000$ bp，原始计数 $4000$\n- 基因 $G_{2}$：长度 $10000$ bp，原始计数 $9000$\n- 基因 $G_{3}$：长度 $1500$ bp，原始计数 $3500$\n- 基因 $G_{4}$：长度 $3000$ bp，原始计数 $5000$\n- 基因 $G_{5}$：长度 $500$ bp，原始计数 $1200$\n- 基因 $G_{6}$：长度 $8000$ bp，原始计数 $7000$\n- 基因 $G_{7}$：长度 $1200$ bp，原始计数 $3000$\n\n构建此数据集的方式，使得在使用原始计数与使用归一化表达指标时，表达量最高的 $5$ 个基因的排序会有所不同。请使用每千碱基每百万比对读数（Reads Per Kilobase per Million mapped reads, RPKM）和每百万转录本（Transcripts Per Million, TPM）的标准单样本定义。每千碱基转录本每百万比对片段（Fragments Per Kilobase of transcript per Million mapped reads, FPKM）在此不适用，因为数据是单端的。\n\n计算基因 $G_{5}$ 的 TPM 值。将您的答案四舍五入到四位有效数字。以 TPM 单位表示最终值。", "solution": "该问题陈述是生物信息学中的一个标准练习，具体涉及 RNA 测序数据的归一化。它要求根据给定的原始读数计数和基因长度数据集，计算特定基因的每百万转录本数（TPM）。\n\n首先，评估问题的有效性。\n\n已知条件逐条摘录如下：\n- 基因 $G_{1}$：长度 $2000$ bp，原始计数 $4000$\n- 基因 $G_{2}$：长度 $10000$ bp，原始计数 $9000$\n- 基因 $G_{3}$：长度 $1500$ bp，原始计数 $3500$\n- 基因 $G_{4}$：长度 $3000$ bp，原始计数 $5000$\n- 基因 $G_{5}$：长度 $500$ bp，原始计数 $1200$\n- 基因 $G_{6}$：长度 $8000$ bp，原始计数 $7000$\n- 基因 $G_{7}$：长度 $1200$ bp，原始计数 $3000$\n- 数据来自单端 RNA 测序。\n- 比对上的总读数等于所示原始计数的总和。\n- 适用 RPKM 和 TPM 的标准定义。\n- FPKM 不适用。\n- 任务是计算基因 $G_{5}$ 的 TPM 值并四舍五入到四位有效数字。\n\n该问题具有科学依据，因为 TPM 是一个广泛用于归一化基因表达数据的指标。问题定义明确，为获得唯一解提供了所有必要数据（7 个基因及其长度和读数计数）。其语言客观而精确。该问题不包含任何科学谬误、矛盾或含糊之处。因此，该问题被认为是有效的，并将推导出一个严谨的解。\n\n每百万转录本（TPM）归一化方法旨在校正因基因长度和测序深度而产生的偏差。计算过程分两步进行。首先，根据基因转录本的长度对原始读数计数进行归一化。其次，将这些经过长度归一化的计数，再根据样本中转录本的总“数量”进行归一化，以确保所有 TPM 值的总和为一百万。\n\n设 $C_{i}$ 为基因 $i$ 的原始读数计数，$L_{i}$ 为基因 $i$ 的长度，单位为碱基对（bp）。\n\n步骤 1：按基因长度对每个基因的读数计数进行归一化。我们将基因长度以千碱基（kb）为单位表示，其中 $1$ kb $= 1000$ bp。对于每个基因 $i$，我们计算一个比率 $R_{i}$，它代表每千碱基转录本的读数。\n$$R_{i} = \\frac{C_{i}}{L_{i} / 1000}$$\n我们对数据集中的所有 7 个基因计算此值。\n\n对于基因 $G_{1}$：$R_{1} = \\frac{4000}{2000 / 1000} = \\frac{4000}{2} = 2000$\n对于基因 $G_{2}$：$R_{2} = \\frac{9000}{10000 / 1000} = \\frac{9000}{10} = 900$\n对于基因 $G_{3}$：$R_{3} = \\frac{3500}{1500 / 1000} = \\frac{3500}{1.5} = \\frac{7000}{3}$\n对于基因 $G_{4}$：$R_{4} = \\frac{5000}{3000 / 1000} = \\frac{5000}{3}$\n对于基因 $G_{5}$：$R_{5} = \\frac{1200}{500 / 1000} = \\frac{1200}{0.5} = 2400$\n对于基因 $G_{6}$：$R_{6} = \\frac{7000}{8000 / 1000} = \\frac{7000}{8} = 875$\n对于基因 $G_{7}$：$R_{7} = \\frac{3000}{1200 / 1000} = \\frac{3000}{1.2} = 2500$\n\n步骤 2：将这些比率归一化，使它们的总和为一百万。为此，我们首先计算所有比率的总和，记为 $S$。\n$$S = \\sum_{i=1}^{7} R_{i}$$\n$$S = 2000 + 900 + \\frac{7000}{3} + \\frac{5000}{3} + 2400 + 875 + 2500$$\n分别合并整数项和分数项：\n$$S = (2000 + 900 + 2400 + 875 + 2500) + \\left(\\frac{7000}{3} + \\frac{5000}{3}\\right)$$\n$$S = 8675 + \\frac{12000}{3} = 8675 + 4000 = 12675$$\n这个总和 $S$ 是样本的缩放因子。\n\n然后，特定基因 $i$ 的 TPM 值通过其比率 $R_{i}$ 除以比率总和 $S$，再乘以 $10^{6}$ 来计算。\n$$TPM_{i} = \\frac{R_{i}}{S} \\times 10^{6}$$\n题目要求我们计算基因 $G_{5}$ 的 TPM。我们使用值 $R_{5} = 2400$ 和 $S = 12675$。\n$$TPM_{5} = \\frac{2400}{12675} \\times 10^{6}$$\n现在，我们进行数值计算：\n$$TPM_{5} \\approx 0.1893491124 \\times 10^{6} = 189349.1124$$\n问题要求答案四舍五入到四位有效数字。该数值为 $189349.1124...$。前四位有效数字是 $1$、$8$、$9$ 和 $3$。第五位有效数字是 $4$。由于 $4  5$，我们向下舍入，即保持第四位有效数字不变，并将随后的数字用零替换以保持其数量级。\n舍入后的值为 $189300$。\n\n用科学记数法表示以明确显示四位有效数字，即为 $1.893 \\times 10^{5}$。单位是 TPM，但根据全局格式化规则，最终方框答案中省略了单位。", "answer": "$$\n\\boxed{1.893 \\times 10^{5}}\n$$", "id": "2424928"}]}