{"hands_on_practices": [{"introduction": "Before applying any numerical method, a crucial question is: how accurate will the result be? This exercise delves into the error analysis of the trapezoidal rule, a fundamental aspect of numerical integration. By working through this problem [@problem_id:2170478], you will learn how to use the formal error bound to determine the minimum number of subintervals required to guarantee a desired level of precision, a critical skill for any practical application in science and engineering.", "id": "2170478", "problem": "An engineering team is designing a decorative architectural element for a modern building facade. The curved top profile of this element, spanning a horizontal distance between two pillars, is described by the function $f(x) = h_0 \\cos\\left(\\frac{\\pi x}{2L}\\right)$. Here, $x$ is the horizontal position in meters, with $x=0$ at the midpoint between the pillars. The pillars are located at $x=-L$ and $x=L$. The parameter $h_0$ is the maximum height of the arch, and $2L$ is the total span.\n\nTo estimate the cost of materials, the team needs to calculate the cross-sectional area under this curve, which is given by the integral $\\int_{-L}^{L} f(x) \\,dx$. They decide to use the composite trapezoidal rule for this numerical approximation. The design specifications are $h_0 = 10 \\text{ m}$ and $L = 20 \\text{ m}$.\n\nTo ensure the accuracy of their cost estimate, the absolute error of the area calculation must be less than $E_{max} = 0.1 \\text{ m}^2$. What is the minimum integer number of subintervals, $n$, that must be used in the trapezoidal rule to guarantee this level of accuracy?\n\n", "solution": "We want to approximate the integral $\\int_{-L}^{L} f(x)\\,dx$ of $f(x)=h_{0}\\cos\\left(\\frac{\\pi x}{2L}\\right)$ using the composite trapezoidal rule with $n$ subintervals over $[a,b]=[-L,L]$. The error bound for the composite trapezoidal rule for a function with a continuous second derivative on $[a,b]$ is\n$$\n|E_{T}| \\leq \\frac{(b-a)^{3}}{12 n^{2}} \\max_{x \\in [a,b]} |f''(x)|.\n$$\n\nFirst, compute $f''(x)$. Let $k=\\frac{\\pi}{2L}$. Then\n$$\nf(x)=h_{0}\\cos(kx),\\quad f'(x)=-h_{0}k\\sin(kx),\\quad f''(x)=-h_{0}k^{2}\\cos(kx).\n$$\nHence\n$$\n|f''(x)|=h_{0}k^{2}|\\cos(kx)| \\leq h_{0}k^{2}=h_{0}\\left(\\frac{\\pi}{2L}\\right)^{2}.\n$$\nWith $a=-L$, $b=L$, we have $b-a=2L$. Substituting into the error bound,\n$$\n|E_{T}| \\leq \\frac{(2L)^{3}}{12 n^{2}} \\cdot h_{0}\\left(\\frac{\\pi}{2L}\\right)^{2}\n= \\frac{8L^{3}}{12 n^{2}} \\cdot h_{0}\\frac{\\pi^{2}}{4L^{2}}\n= \\frac{\\pi^{2}}{6}\\cdot \\frac{h_{0}L}{n^{2}}.\n$$\n\nTo guarantee $|E_{T}| \\leq E_{\\max}$, it suffices that\n$$\n\\frac{\\pi^{2}}{6}\\cdot \\frac{h_{0}L}{n^{2}} \\leq E_{\\max}\n\\quad\\Longrightarrow\\quad\nn^{2} \\geq \\frac{\\pi^{2}}{6}\\cdot \\frac{h_{0}L}{E_{\\max}}\n\\quad\\Longrightarrow\\quad\nn \\geq \\sqrt{\\frac{\\pi^{2}}{6}\\cdot \\frac{h_{0}L}{E_{\\max}}}.\n$$\n\nWith $h_{0}=10$, $L=20$, and $E_{\\max}=0.1$, this becomes\n$$\nn \\geq \\sqrt{\\frac{\\pi^{2}}{6}\\cdot \\frac{10\\cdot 20}{0.1}}\n= \\sqrt{\\frac{\\pi^{2}}{6}\\cdot 2000}\n= \\sqrt{\\frac{1000}{3}\\,\\pi^{2}}.\n$$\nNumerically, $\\frac{1000}{3}\\pi^{2} \\approx 3289.9$, so $n \\geq \\sqrt{3289.9} \\approx 57.35$. Therefore, the minimum integer $n$ that guarantees the required accuracy is $n=58$.", "answer": "$$\\boxed{58}$$"}, {"introduction": "With a grasp of the trapezoidal rule's accuracy, we can now apply it to a classic scenario in resource economics. This problem [@problem_id:2444238] asks you to estimate the total oil extracted over two decades, where the extraction rate follows Hotelling's rule for resource depletion. This practice is designed to solidify your ability to set up and compute an approximation for a definite integral that represents a cumulative total from a rate of change.", "id": "2444238", "problem": "A resource extraction firm operates an oil reserve under an intertemporal model consistent with Hotellingâ€™s rule. The instantaneous extraction rate at time $t$ (in years) is $E(t) = E_{0}\\exp(r t)$, where $E_{0}$ is the initial extraction rate (in barrels per year) and $r$ is a constant growth rate (in year$^{-1}$). The cumulative amount extracted over a horizon $[0,T]$ is the time integral $\\int_{0}^{T} E(t)\\,dt$. The firm records the extraction rate annually at times $t_{k} = k$ for $k=0,1,2,\\dots,20$.\n\nUsing the composite trapezoidal rule on this annual grid to estimate the integral, compute the total amount of oil extracted over $T=20$ years when $E_{0} = 5.0 \\times 10^{7}$ and $r = 0.03$. Express your final answer in billions of barrels, and round your answer to four significant figures.", "solution": "The problem requires the computation of the total amount of oil extracted over a period of $T=20$ years, which is given by the definite integral of the extraction rate $E(t)$. The extraction rate is modeled by the function $E(t) = E_{0}\\exp(r t)$. We are asked to estimate this integral using the composite trapezoidal rule with a specific grid and parameters.\n\nFirst, we must validate the problem statement.\n\n**Step 1: Extract Givens**\n- Instantaneous extraction rate: $E(t) = E_{0}\\exp(r t)$\n- Time $t$ is in years.\n- $E_{0}$ is the initial extraction rate in barrels per year.\n- $r$ is a constant growth rate in year$^{-1}$.\n- Cumulative amount extracted over $[0,T]$: $\\int_{0}^{T} E(t)\\,dt$.\n- Data recording times: $t_{k} = k$ for $k=0,1,2,\\dots,20$.\n- Numerical method: Composite trapezoidal rule.\n- Time horizon: $T=20$ years.\n- Initial extraction rate: $E_{0} = 5.0 \\times 10^{7}$ barrels/year.\n- Growth rate: $r = 0.03$ year$^{-1}$.\n- Final answer requirements: Express in billions of barrels, rounded to four significant figures.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, as it employs a standard exponential growth model and a fundamental numerical integration technique (trapezoidal rule). It is well-posed, providing all necessary parameters ($E_0$, $r$, $T$) and a clear definition of the discretisation ($t_k=k$) to compute a unique numerical result. The language is objective and precise. The problem does not violate any of the invalidity criteria. For instance, it is not scientifically unsound, as the exponential model is common in economics. It is not incomplete, as all data for the calculation are provided.\n\n**Step 3: Verdict and Action**\nThe problem is valid. I will proceed with the solution.\n\nThe problem asks for the numerical approximation of the integral representing the cumulative extraction, which we denote as $Q$:\n$$ Q = \\int_{0}^{20} E(t) \\, dt = \\int_{0}^{20} E_{0}\\exp(r t) \\, dt $$\nWe will use the composite trapezoidal rule. The time points are given as $t_k = k$ for $k=0, 1, \\dots, 20$. This defines a partition of the interval $[0, 20]$ into $n=20$ subintervals, each of width $h = t_{k+1} - t_k = 1$ year.\n\nThe composite trapezoidal rule approximates the integral as a sum of the areas of trapezoids constructed on each subinterval:\n$$ Q_{T} = \\sum_{k=0}^{n-1} \\frac{h}{2} \\left[ E(t_k) + E(t_{k+1}) \\right] $$\nSubstituting the given parameters and function: $n=20$, $h=1$, $t_k=k$, and $E(t_k) = E_0 \\exp(r t_k) = E_0 \\exp(rk)$.\n$$ Q_{T} = \\sum_{k=0}^{19} \\frac{1}{2} \\left[ E_{0} \\exp(rk) + E_{0} \\exp(r(k+1)) \\right] $$\nWe can factor out constant terms:\n$$ Q_{T} = \\frac{E_{0}}{2} \\sum_{k=0}^{19} \\left[ \\exp(rk) + \\exp(rk+r) \\right] $$\n$$ Q_{T} = \\frac{E_{0}}{2} \\sum_{k=0}^{19} \\exp(rk) \\left[ 1 + \\exp(r) \\right] $$\nThe term $(1 + \\exp(r))$ is constant with respect to the summation index $k$, so it can be moved outside the sum:\n$$ Q_{T} = \\frac{E_{0}}{2} (1 + \\exp(r)) \\sum_{k=0}^{19} \\exp(rk) $$\nThe remaining summation is a finite geometric series of the form $\\sum_{k=0}^{m} x^k$ with $m=19$ and common ratio $x = \\exp(r)$. The sum of such a series is given by the formula $\\frac{x^{m+1}-1}{x-1}$.\n$$ \\sum_{k=0}^{19} (\\exp(r))^k = \\frac{(\\exp(r))^{19+1} - 1}{\\exp(r) - 1} = \\frac{\\exp(20r) - 1}{\\exp(r) - 1} $$\nSubstituting this result back into the expression for $Q_T$:\n$$ Q_{T} = \\frac{E_{0}}{2} (1 + \\exp(r)) \\frac{\\exp(20r) - 1}{\\exp(r) - 1} $$\nThis is the analytical expression for the trapezoidal approximation. Now, we substitute the given numerical values: $E_{0} = 5.0 \\times 10^{7}$ and $r = 0.03$. The integration horizon gives $20r = 20 \\times 0.03 = 0.6$.\n$$ Q_{T} = \\frac{5.0 \\times 10^{7}}{2} (1 + \\exp(0.03)) \\frac{\\exp(0.6) - 1}{\\exp(0.03) - 1} $$\nWe compute the values of the exponential terms:\n$\\exp(0.03) \\approx 1.03045453$\n$\\exp(0.6) \\approx 1.82211880$\n\nSubstituting these into the expression:\n$$ Q_{T} \\approx (2.5 \\times 10^{7}) \\cdot (1 + 1.03045453) \\frac{1.82211880 - 1}{1.03045453 - 1} $$\n$$ Q_{T} \\approx (2.5 \\times 10^{7}) \\cdot (2.03045453) \\frac{0.82211880}{0.03045453} $$\n$$ Q_{T} \\approx (2.5 \\times 10^{7}) \\cdot (2.03045453) \\cdot (26.99420028) $$\n$$ Q_{T} \\approx (2.5 \\times 10^{7}) \\cdot (54.81434191) $$\n$$ Q_{T} \\approx 1370358547.65 \\text{ barrels} $$\nThe problem requires the answer to be expressed in billions of barrels ($1 \\text{ billion} = 10^9$).\n$$ Q_{T} \\approx \\frac{1370358547.65}{10^9} \\text{ billion barrels} $$\n$$ Q_{T} \\approx 1.37035854765 \\text{ billion barrels} $$\nFinally, we must round the result to four significant figures.\n$$ Q_{T} \\approx 1.370 \\text{ billion barrels} $$", "answer": "$$\n\\boxed{1.370}\n$$"}, {"introduction": "Numerical methods are not just for finding answers; they can also be powerful tools for uncovering missing information. This advanced practice [@problem_id:2444241] flips the typical problem on its head by using the definition of the Gini coefficient and a set of incomplete macroeconomic data. You will use the trapezoidal rule to construct an equation and solve for an unknown value of the Lorenz curve, demonstrating how numerical integration can be a key component of economic modeling and data imputation.", "id": "2444241", "problem": "In income distribution analysis, the Gini coefficient $G$ is defined from the Lorenz curve $L(p)$ by the relation $G = 1 - 2 \\int_{0}^{1} L(p) \\, dp$, where $p \\in [0,1]$ denotes the cumulative population share and $L(p)$ denotes the corresponding cumulative income share. A national statistics office reports a Gini coefficient of $G = 0.336$ for a given year. From microdata aggregation, the Lorenz curve has been tabulated on the uniform grid $p \\in \\{0, 0.2, 0.4, 0.6, 0.8, 1\\}$, with the following values known at all but one point:\n- $L(0) = 0$,\n- $L(0.2) = 0.05$,\n- $L(0.4) = 0.15$,\n- $L(0.6) = \\text{unknown}$,\n- $L(0.8) = 0.60$,\n- $L(1) = 1$.\n\nOn this grid, the integral $\\int_{0}^{1} L(p) \\, dp$ is to be approximated by the composite trapezoidal rule.\n\nUsing only the information above, determine the missing value $L(0.6)$. Express your final answer as a decimal number.", "solution": "By definition, the Gini coefficient $G$ and the Lorenz curve $L(p)$ satisfy\n$$\nG \\;=\\; 1 \\;-\\; 2 \\int_{0}^{1} L(p) \\, dp.\n$$\nHence, the integral of the Lorenz curve is\n$$\n\\int_{0}^{1} L(p) \\, dp \\;=\\; \\frac{1 - G}{2}.\n$$\nWith $G = 0.336$, this yields\n$$\n\\int_{0}^{1} L(p) \\, dp \\;=\\; \\frac{1 - 0.336}{2} \\;=\\; \\frac{0.664}{2} \\;=\\; 0.332.\n$$\n\nWe approximate $\\int_{0}^{1} L(p) \\, dp$ using the composite trapezoidal rule on the uniform grid $p_i = 0, 0.2, 0.4, 0.6, 0.8, 1$ with step size $h = 0.2$. Denote the unknown value $L(0.6)$ by $x$. The composite trapezoidal rule gives\n$$\n\\int_{0}^{1} L(p) \\, dp \\;\\approx\\; h \\left( \\frac{L(0)+L(1)}{2} + L(0.2) + L(0.4) + L(0.6) + L(0.8) \\right).\n$$\nSubstituting the known values and $h = 0.2$,\n$$\n\\int_{0}^{1} L(p) \\, dp \\;\\approx\\; 0.2 \\left( \\frac{0 + 1}{2} + 0.05 + 0.15 + x + 0.60 \\right)\n\\;=\\; 0.2 \\left( 0.5 + 0.05 + 0.15 + 0.60 + x \\right)\n\\;=\\; 0.2 \\left( 1.30 + x \\right)\n\\;=\\; 0.26 + 0.2 x.\n$$\nEquating this approximation to the value implied by $G$,\n$$\n0.26 + 0.2 x \\;=\\; 0.332.\n$$\nSolving for $x$,\n$$\n0.2 x \\;=\\; 0.332 - 0.26 \\;=\\; 0.072,\n\\qquad\nx \\;=\\; \\frac{0.072}{0.2} \\;=\\; 0.36.\n$$\nTherefore, the missing Lorenz curve value is $L(0.6) = 0.36$.", "answer": "$$\\boxed{0.36}$$"}]}