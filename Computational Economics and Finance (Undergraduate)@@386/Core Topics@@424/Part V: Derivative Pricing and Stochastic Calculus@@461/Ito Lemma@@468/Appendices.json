{"hands_on_practices": [{"introduction": "Before diving into complex analytical derivations, it's powerful to see a fundamental result in action. This practice guides you in numerically verifying Itō's lemma for the canonical Geometric Brownian Motion (GBM) process. By simulating a path for an asset price $S_t$ and comparing the actual change in its logarithm, $\\ln(S_t)$, to the change predicted by the lemma, you will build a strong intuition for the 'Itō term' and bridge the gap between continuous-time theory and discrete-time computation.", "id": "2404258", "problem": "Consider a single-asset price process modeled as a Geometric Brownian Motion (GBM), defined by the stochastic differential equation (SDE)\n$$\n\\mathrm{d}S_t=\\mu S_t\\,\\mathrm{d}t+\\sigma S_t\\,\\mathrm{d}W_t,\n$$\nwhere $S_t$ is the asset price at time $t$, $\\mu$ is the constant drift, $\\sigma$ is the constant volatility, and $W_t$ is a standard Wiener process (Brownian motion). Let $f(s)=\\ln(s)$ and denote by $\\Delta \\ln(S)$ the realized discrete change $\\ln(S_{t_{k+1}})-\\ln(S_{t_k})$ over a small time step $\\Delta t$.\n\nUsing Itô's lemma applied to $f(s)=\\ln(s)$ for the GBM above, determine the formula for the instantaneous change in $\\ln(S_t)$, and use it to specify, in terms of $\\mu$, $\\sigma$, $\\Delta t$, and the Brownian increment $\\Delta W_k:=W_{t_{k+1}}-W_{t_k}$, the predicted discrete increment for $\\ln(S)$ over a single step. Then, for each test case below, construct one simulated path that is consistent with the SDE over the time interval $[0,T]$ using a uniform grid $0=t_0<t_1<\\dots<t_N=T$ with $t_{k+1}-t_k=\\Delta t=T/N$ and independent Gaussian increments $\\Delta W_k$ that are each normally distributed with mean $0$ and variance $\\Delta t$. For reproducibility, the Brownian increments for each test case must be generated from a fixed pseudorandom number seed specified in the test suite.\n\nFor each test case, compute:\n- the sequence of realized log-increments $\\Delta \\ln(S)_k:=\\ln(S_{t_{k+1}})-\\ln(S_{t_k})$ along the simulated path,\n- the sequence of predicted log-increments from your Itô's lemma formula using the same $\\Delta W_k$,\n- the maximum absolute discrepancy over the path,\n$$\n\\max_{0\\le k\\le N-1}\\left|\\Delta \\ln(S)_k-\\left(\\text{prediction from Itô's lemma at step }k\\right)\\right|.\n$$\n\nA test case is deemed to pass if and only if this maximum absolute discrepancy is less than or equal to the tolerance $10^{-10}$.\n\nTest suite (each tuple is $(S_0,\\mu,\\sigma,T,N,\\text{seed})$):\n1. $(100.0,\\,0.08,\\,0.2,\\,1.0,\\,5000,\\,11)$\n2. $(100.0,\\,0.05,\\,0.0,\\,1.0,\\,100,\\,13)$\n3. $(250.0,\\,0.0,\\,0.3,\\,2.0,\\,2000,\\,17)$\n4. $(50.0,\\,-0.1,\\,0.15,\\,1.5,\\,1500,\\,19)$\n5. $(1.0,\\,0.2,\\,0.4,\\,0.0,\\,1,\\,23)$\n\nRequirements:\n- Use the parameters exactly as listed.\n- For each test case, generate a single path using the stated time grid and independent Gaussian increments with variance $\\Delta t$ constructed from the given seed for that case.\n- For each case, produce a boolean indicating whether the pass criterion is met.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[true_case1,true_case2,...]\"). Use the textual representations \"True\" and \"False\" for the booleans.", "solution": "The problem statement is subjected to validation before a solution is attempted.\n\nStep 1: Extract Givens\n- Asset price process: Geometric Brownian Motion (GBM), defined by the stochastic differential equation (SDE) $\\mathrm{d}S_t=\\mu S_t\\,\\mathrm{d}t+\\sigma S_t\\,\\mathrm{d}W_t$.\n- Parameters: $\\mu$ is constant drift, $\\sigma$ is constant volatility.\n- Stochastic process: $W_t$ is a standard Wiener process.\n- Function of interest: $f(s)=\\ln(s)$.\n- Discrete change definition: $\\Delta \\ln(S)$ is the realized discrete change $\\ln(S_{t_{k+1}})-\\ln(S_{t_k})$.\n- Brownian increment definition: $\\Delta W_k := W_{t_{k+1}}-W_{t_k}$.\n- Time grid: Uniform grid $0=t_0<t_1<\\dots<t_N=T$ with time step $\\Delta t=t_{k+1}-t_k=T/N$.\n- Distribution of increments: $\\Delta W_k$ are independent and normally distributed with mean $0$ and variance $\\Delta t$.\n- Task:\n    1. Use Itô's lemma for $f(s)=\\ln(s)$ to derive the formula for the instantaneous change in $\\ln(S_t)$.\n    2. Use this to specify the predicted discrete increment for $\\ln(S)$ over a single step.\n    3. For each test case, simulate one path for $S_t$.\n    4. Compute the sequence of realized log-increments, $\\Delta \\ln(S)_k = \\ln(S_{t_{k+1}}) - \\ln(S_{t_k})$.\n    5. Compute the sequence of predicted log-increments from the derived formula.\n    6. Compute the maximum absolute discrepancy: $\\max_{0\\le k\\le N-1}\\left|\\Delta \\ln(S)_k-\\left(\\text{prediction from Itô's lemma at step }k\\right)\\right|$.\n- Pass criterion: The maximum absolute discrepancy must be less than or equal to the tolerance $10^{-10}$.\n- Test suite:\n    1. $(S_0=100.0, \\mu=0.08, \\sigma=0.2, T=1.0, N=5000, \\text{seed}=11)$\n    2. $(S_0=100.0, \\mu=0.05, \\sigma=0.0, T=1.0, N=100, \\text{seed}=13)$\n    3. $(S_0=250.0, \\mu=0.0, \\sigma=0.3, T=2.0, N=2000, \\text{seed}=17)$\n    4. $(S_0=50.0, \\mu=-0.1, \\sigma=0.15, T=1.5, N=1500, \\text{seed}=19)$\n    5. $(S_0=1.0, \\mu=0.2, \\sigma=0.4, T=0.0, N=1, \\text{seed}=23)$\n\nStep 2: Validate Using Extracted Givens\n- **Scientifically Grounded**: The problem is based on Geometric Brownian Motion and Itô's lemma, which are canonical, universally accepted models in mathematical finance and stochastic calculus. The premises are factually sound.\n- **Well-Posed**: The problem is clearly defined. It asks for a derivation, a simulation based on a specified procedure, and a quantitative comparison. All necessary parameters and conditions are provided for each test case, including initial values, model parameters, time horizon, discretization steps, and random number generator seeds. The objective (pass/fail criterion) is unambiguous.\n- **Objective**: The problem is stated in precise mathematical and computational terms, free of subjectivity or ambiguity.\n- **Completeness and Consistency**: The problem is self-contained. The test cases, including the degenerate case where $T=0$, are specified and do not introduce contradictions. The relationship between the continuous SDE and its discrete simulation is a standard topic.\n- **No other flaws are detected.**\n\nStep 3: Verdict and Action\nThe problem is valid. It constitutes a standard and instructive exercise in applying stochastic calculus to computational finance, specifically testing the understanding that the process for $\\ln(S_t)$ has an exact discrete-time solution. We proceed to the solution.\n\n**Theoretical Derivation**\n\nThe analysis begins with Itô's lemma. For a twice-differentiable function $f(S_t)$ of a stochastic process $S_t$ which follows the SDE $\\mathrm{d}S_t = a(S_t, t)\\,\\mathrm{d}t + b(S_t, t)\\,\\mathrm{d}W_t$, the change $\\mathrm{d}f$ is given by:\n$$\n\\mathrm{d}f(S_t) = \\left( \\frac{\\partial f}{\\partial S_t} a(S_t, t) + \\frac{1}{2} \\frac{\\partial^2 f}{\\partial S_t^2} b(S_t, t)^2 \\right) \\mathrm{d}t + \\frac{\\partial f}{\\partial S_t} b(S_t, t) \\,\\mathrm{d}W_t\n$$\nIn this problem, the process is GBM, so $S_t$ follows $\\mathrm{d}S_t = \\mu S_t\\,\\mathrm{d}t + \\sigma S_t\\,\\mathrm{d}W_t$. Thus, we identify $a(S_t, t) = \\mu S_t$ and $b(S_t, t) = \\sigma S_t$. The function is $f(s) = \\ln(s)$. We compute its partial derivatives with respect to $s$:\n$$\n\\frac{\\partial f}{\\partial s} = \\frac{1}{s}\n$$\n$$\n\\frac{\\partial^2 f}{\\partial s^2} = -\\frac{1}{s^2}\n$$\nSubstituting these expressions into Itô's lemma:\n$$\n\\mathrm{d}(\\ln S_t) = \\left( \\left(\\frac{1}{S_t}\\right) (\\mu S_t) + \\frac{1}{2} \\left(-\\frac{1}{S_t^2}\\right) (\\sigma S_t)^2 \\right) \\mathrm{d}t + \\left(\\frac{1}{S_t}\\right) (\\sigma S_t) \\,\\mathrm{d}W_t\n$$\nSimplifying the terms yields the SDE for $\\ln(S_t)$:\n$$\n\\mathrm{d}(\\ln S_t) = \\left( \\mu - \\frac{1}{2}\\sigma^2 \\right) \\mathrm{d}t + \\sigma \\,\\mathrm{d}W_t\n$$\nThis is the required formula for the instantaneous change. The process for $\\ln(S_t)$ is an arithmetic Brownian motion with constant drift $(\\mu - \\frac{1}{2}\\sigma^2)$ and constant volatility $\\sigma$.\n\nTo find the discrete increment over a time step $\\Delta t = t_{k+1} - t_k$, we integrate the SDE from $t_k$ to $t_{k+1}$:\n$$\n\\int_{t_k}^{t_{k+1}} \\mathrm{d}(\\ln S_t) = \\int_{t_k}^{t_{k+1}} \\left( \\mu - \\frac{1}{2}\\sigma^2 \\right) \\mathrm{d}t + \\int_{t_k}^{t_{k+1}} \\sigma \\,\\mathrm{d}W_t\n$$\nThis yields:\n$$\n\\ln(S_{t_{k+1}}) - \\ln(S_{t_k}) = \\left( \\mu - \\frac{1}{2}\\sigma^2 \\right) \\Delta t + \\sigma (W_{t_{k+1}} - W_{t_k})\n$$\nUsing the notation $\\Delta W_k = W_{t_{k+1}} - W_{t_k}$, we obtain the formula for the predicted discrete log-increment:\n$$\n\\text{Predicted Increment}_k = \\left( \\mu - \\frac{1}{2}\\sigma^2 \\right) \\Delta t + \\sigma \\Delta W_k\n$$\n\n**Simulation and Verification**\n\nThe SDE for $\\ln(S_t)$ has constant coefficients, which allows for an exact simulation scheme. The discrete-time evolution of $\\ln(S_t)$ is given by the formula derived above. Exponentiating both sides gives the exact solution for $S_{t_{k+1}}$ in terms of $S_{t_k}$:\n$$\nS_{t_{k+1}} = S_{t_k} \\exp\\left( \\left( \\mu - \\frac{1}{2}\\sigma^2 \\right) \\Delta t + \\sigma \\Delta W_k \\right)\n$$\nThis is the correct method for simulating a GBM path, as requested.\n\nThe problem requires a comparison between the \"realized\" and \"predicted\" log-increments.\n- The **predicted** increment is the right-hand side of the integrated SDE for $\\ln(S_t)$: $\\left(\\mu - \\frac{1}{2}\\sigma^2 \\right)\\Delta t + \\sigma \\Delta W_k$.\n- The **realized** increment is defined as $\\Delta \\ln(S)_k = \\ln(S_{t_{k+1}}) - \\ln(S_{t_k})$.\n\nBy substituting the simulation formula for $S_{t_{k+1}}$ into the definition of the realized increment, we find:\n$$\n\\Delta \\ln(S)_k = \\ln\\left(S_{t_k} \\exp\\left( \\left(\\mu - \\frac{1}{2}\\sigma^2 \\right)\\Delta t + \\sigma \\Delta W_k \\right)\\right) - \\ln(S_{t_k})\n$$\nUsing the logarithm property $\\ln(ab) = \\ln(a) + \\ln(b)$:\n$$\n\\Delta \\ln(S)_k = \\left(\\ln(S_{t_k}) + \\ln\\left(\\exp\\left( \\left(\\mu - \\frac{1}{2}\\sigma^2 \\right)\\Delta t + \\sigma \\Delta W_k \\right)\\right)\\right) - \\ln(S_{t_k})\n$$\n$$\n\\Delta \\ln(S)_k = \\ln\\left(\\exp\\left( \\left(\\mu - \\frac{1}{2}\\sigma^2 \\right)\\Delta t + \\sigma \\Delta W_k \\right)\\right)\n$$\nAnalytically, the realized increment is identical to the predicted increment. The discrepancy is then:\n$$\n\\text{Discrepancy}_k = \\left| \\ln(\\exp(\\text{Predicted}_k)) - \\text{Predicted}_k \\right|\n$$\nThis measures a fundamental property of floating-point arithmetic. For any floating-point number $x$ where $\\exp(x)$ does not overflow or underflow, the quantity $\\ln(\\exp(x))$ is computationally very close to $x$. The problem is therefore a verification that this computational error is within the specified tolerance of $10^{-10}$.\n\n**Algorithm**\nFor each test case $(S_0, \\mu, \\sigma, T, N, \\text{seed})$:\n1.  Set the random number generator seed to `seed` for reproducibility.\n2.  If $N>0$, calculate the time step $\\Delta t = T / N$. If $N=0$, no steps are taken and the discrepancy is vacuously $0$. However, all test cases have $N \\ge 1$.\n3.  Generate an array of $N$ independent Brownian increments $\\Delta W_k$, where each is drawn from a normal distribution with mean $0$ and variance $\\Delta t$. This is achieved by sampling $N$ values $Z_k$ from a standard normal distribution $\\mathcal{N}(0, 1)$ and setting $\\Delta W_k = Z_k \\sqrt{\\Delta t}$.\n4.  Calculate the array of predicted log-increments using the derived formula: $\\text{Predicted}_k = (\\mu - 0.5\\sigma^2)\\Delta t + \\sigma \\Delta W_k$.\n5.  Simulate the asset price path $S_t$. Initialize an array $S$ of size $N+1$ with $S_0$. Then, for $k = 0, \\dots, N-1$, calculate $S_{t_{k+1}} = S_{t_k} \\exp(\\text{Predicted}_k)$. This can be vectorized using cumulative products.\n6.  Compute the array of realized log-increments: $\\Delta \\ln(S)_k = \\ln(S_{t_{k+1}}) - \\ln(S_{t_k})$. This can be done by taking the natural logarithm of the path $S$ and then computing the first difference.\n7.  Calculate the maximum absolute discrepancy between the predicted and realized increments over all $N$ steps.\n8.  Compare this maximum discrepancy to the tolerance $10^{-10}$ to determine if the test case passes.\n9.  Collect the boolean results for all test cases.\n\nThis procedure will be implemented in the final program.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem by deriving the discrete log-increment formula from Ito's lemma,\n    simulating GBM paths, and comparing realized vs. predicted increments.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (S0, mu, sigma, T, N, seed)\n        (100.0, 0.08, 0.2, 1.0, 5000, 11),\n        (100.0, 0.05, 0.0, 1.0, 100, 13),\n        (250.0, 0.0, 0.3, 2.0, 2000, 17),\n        (50.0, -0.1, 0.15, 1.5, 1500, 19),\n        (1.0, 0.2, 0.4, 0.0, 1, 23),\n    ]\n\n    results = []\n    tolerance = 1e-10\n\n    for case in test_cases:\n        s0, mu, sigma, T, N, seed = case\n        \n        # N must be an integer\n        N = int(N)\n\n        # Handle the case where N=0, though not in the test suite.\n        # The max over an empty set of steps is 0.\n        if N == 0:\n            results.append(True)\n            continue\n            \n        # Set seed for reproducibility\n        np.random.seed(seed)\n\n        # Calculate time step\n        dt = T / N\n\n        # 1. Generate Brownian increments dW ~ N(0, dt)\n        # We generate N standard normal variables Z and scale them.\n        Z = np.random.standard_normal(N)\n        dW = Z * np.sqrt(dt)\n\n        # 2. Calculate the sequence of predicted log-increments from Ito's lemma\n        # d(lnS) = (mu - 0.5*sigma^2)dt + sigma*dW\n        predicted_log_increments = (mu - 0.5 * sigma**2) * dt + sigma * dW\n\n        # 3. Construct the simulated path for S_t.\n        # S_{t+dt} = S_t * exp((mu - 0.5*sigma^2)dt + sigma*dW)\n        # This can be done vectorially for efficiency.\n        # First, compute the cumulative product of the exponential terms.\n        # S[k] = S0 * product(exp(predicted_increments[i])) for i=0 to k-1\n        s_path = np.zeros(N + 1)\n        s_path[0] = s0\n        # The cumulative product builds the path S_1, S_2, ...\n        s_path[1:] = s0 * np.cumprod(np.exp(predicted_log_increments))\n\n        # 4. Compute the sequence of realized log-increments\n        # delta_ln_S = ln(S_{k+1}) - ln(S_k)\n        # Suppress \"divide by zero\" or \"invalid value\" warnings for log if S becomes 0,\n        # although this is extremely unlikely with standard parameters.\n        with np.errstate(divide='ignore', invalid='ignore'):\n            log_s_path = np.log(s_path)\n        \n        # Check for -inf or nan in log_s_path, which would indicate S hit 0 or below.\n        if np.any(np.isneginf(log_s_path)) or np.any(np.isnan(log_s_path)):\n             # This path is numerically unstable, discrepancy is likely large.\n             # This case should not happen with the given parameters but is a robust check.\n             max_discrepancy = np.inf\n        else:\n            realized_log_increments = np.diff(log_s_path)\n    \n            # 5. Compute the maximum absolute discrepancy\n            # The discrepancy at each step is due to floating point error in log(exp(x)) != x\n            discrepancies = np.abs(realized_log_increments - predicted_log_increments)\n            max_discrepancy = np.max(discrepancies)\n\n        # 6. Check if the pass criterion is met\n        pass_criterion_met = max_discrepancy <= tolerance\n        results.append(str(pass_criterion_met))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"}, {"introduction": "Having built confidence in Itō's lemma through numerical simulation, we now wield it as a powerful analytical tool. Many stochastic differential equations (SDEs) that initially appear intractable can be solved by finding a clever change of variable. This exercise [@problem_id:2404213] challenges you to transform a non-linear SDE into a simple, solvable form, showcasing the lemma's utility in simplifying complex dynamics.", "id": "2404213", "problem": "Consider the stochastic differential equation (SDE) in continuous time finance\n$$\ndX_t = X_t^{3}\\,dt + X_t^{2}\\,dZ_t,\\quad X_0 = x_0 \\neq 0,\n$$\nwhere $\\{Z_t\\}_{t \\ge 0}$ is a standard Brownian motion (Wiener process) with $Z_0 = 0$. Work on a filtered probability space satisfying the usual conditions, and interpret the SDE in the Itō sense. Find the explicit strong solution $X_t$ as a closed-form analytical expression in terms of $x_0$ and $Z_t$. Your final answer must be a single analytic expression. If your answer involves any stopping time considerations, state them in your reasoning, but do not include them in the final expression.", "solution": "The problem statement is subjected to validation and is found to be valid. It is a well-posed problem in stochastic calculus. The given stochastic differential equation (SDE) is:\n$$\ndX_t = X_t^{3}\\,dt + X_t^{2}\\,dZ_t\n$$\nwith initial condition $X_0 = x_0$, where $x_0 \\neq 0$. The process $\\{Z_t\\}_{t \\ge 0}$ is a standard Brownian motion.\n\nThe drift coefficient, $\\mu(x) = x^3$, and the diffusion coefficient, $\\sigma(x) = x^2$, do not satisfy the global linear growth condition. That is, there exists no constant $K$ such that $|\\mu(x)| \\le K(1 + |x|)$ and $|\\sigma(x)| \\le K(1 + |x|)$ for all $x \\in \\mathbb{R}$. This suggests that the solution may exhibit finite-time explosion. The problem is to find an explicit formula for the strong solution, which may only exist up to a random stopping time.\n\nTo solve this SDE, we seek a transformation of the process $X_t$. Let $Y_t = f(X_t)$ for some twice-differentiable function $f$. By Itō's lemma, the differential of $Y_t$ is given by:\n$$\ndY_t = f'(X_t) dX_t + \\frac{1}{2} f''(X_t) (dX_t)^2\n$$\nSubstituting the given SDE for $dX_t$ and using the Itō multiplication rule $(dZ_t)^2 = dt$, $(dt)^2 = 0$, and $dt\\,dZ_t = 0$, we get:\n$$\n(dX_t)^2 = (X_t^{3}\\,dt + X_t^{2}\\,dZ_t)^2 = (X_t^2)^2 (dZ_t)^2 + (\\text{terms with } dt) = X_t^4 dt\n$$\nThus, the SDE for $Y_t$ becomes:\n$$\ndY_t = f'(X_t) (X_t^{3}\\,dt + X_t^{2}\\,dZ_t) + \\frac{1}{2} f''(X_t) X_t^4 dt\n$$\nGrouping the $dt$ and $dZ_t$ terms:\n$$\ndY_t = \\left[ X_t^3 f'(X_t) + \\frac{1}{2} X_t^4 f''(X_t) \\right] dt + X_t^2 f'(X_t) dZ_t\n$$\nWe aim to choose a function $f$ that simplifies this equation. A standard technique is to eliminate the dependence on $X_t$ in the diffusion coefficient. We set the coefficient of $dZ_t$ to a constant. Let us choose this constant to be $-1$:\n$$\nX_t^2 f'(X_t) = -1\n$$\nThis implies $f'(x) = -x^{-2}$. This ordinary differential equation for $f(x)$ can be solved by integration:\n$$\nf(x) = \\int -x^{-2} \\,dx = \\frac{1}{x} + C\n$$\nWe can choose the constant of integration $C=0$ for simplicity, yielding the transformation $f(x) = 1/x$. This transformation is well-defined because the initial condition $X_0 = x_0 \\neq 0$, and it can be shown that the process $X_t$ will almost surely not reach $0$ if it starts from a non-zero value. The first and second derivatives of $f(x)$ are:\n$$\nf'(x) = -x^{-2} \\quad \\text{and} \\quad f''(x) = 2x^{-3}\n$$\nNow we substitute these derivatives into the drift term of the SDE for $Y_t$:\n$$\n\\text{Drift term} = X_t^3 f'(X_t) + \\frac{1}{2} X_t^4 f''(X_t) = X_t^3 (-X_t^{-2}) + \\frac{1}{2} X_t^4 (2X_t^{-3}) = -X_t + X_t = 0\n$$\nThe drift term vanishes. The SDE for $Y_t$ simplifies dramatically to:\n$$\ndY_t = 0 \\cdot dt - 1 \\cdot dZ_t = -dZ_t\n$$\nThis is a simple SDE that can be solved by direct integration from $t=0$ to $t$:\n$$\n\\int_0^t dY_s = - \\int_0^t dZ_s\n$$\nThis gives:\n$$\nY_t - Y_0 = -(Z_t - Z_0)\n$$\nGiven that $Z_0=0$ and $Y_0 = f(X_0) = 1/X_0 = 1/x_0$, we have:\n$$\nY_t - \\frac{1}{x_0} = -Z_t\n$$\nSolving for $Y_t$:\n$$\nY_t = \\frac{1}{x_0} - Z_t\n$$\nFinally, we transform back to the original process $X_t$ using the relation $X_t = 1/Y_t$:\n$$\nX_t = \\frac{1}{Y_t} = \\frac{1}{\\frac{1}{x_0} - Z_t}\n$$\nThis expression can be simplified by multiplying the numerator and denominator by $x_0$:\n$$\nX_t = \\frac{x_0}{1 - x_0 Z_t}\n$$\nThis is the explicit strong solution for the process $X_t$. The solution exists as long as the denominator is non-zero. Let $\\tau$ be the stopping time defined as $\\tau = \\inf\\{t>0 \\mid 1 - x_0 Z_t = 0\\}$. This is the first time the process $Z_t$ reaches the level $1/x_0$. For a standard one-dimensional Brownian motion, this time is almost surely finite. Therefore, the solution $X_t$ explodes to infinity in finite time with probability $1$. The expression we have found is the solution for $t \\in [0, \\tau)$.\n\nTo verify the solution, we can apply Itō's lemma to the function $g(z) = \\frac{x_0}{1-x_0 z}$, with $X_t = g(Z_t)$. The derivatives are $g'(z) = \\frac{x_0^2}{(1-x_0 z)^2}$ and $g''(z) = \\frac{2x_0^3}{(1-x_0 z)^3}$. In terms of $X_t$, these become $g'(Z_t) = X_t^2$ and $g''(Z_t) = 2X_t^3$.\nApplying Itō's lemma to $X_t = g(Z_t)$:\n$$\ndX_t = g'(Z_t)dZ_t + \\frac{1}{2}g''(Z_t)(dZ_t)^2 = X_t^2 dZ_t + \\frac{1}{2}(2X_t^3)dt = X_t^3 dt + X_t^2 dZ_t\n$$\nThis matches the original SDE, confirming the correctness of the solution.", "answer": "$$\n\\boxed{\\frac{x_0}{1 - x_0 Z_t}}\n$$"}, {"introduction": "Let's bring our skills into the domain of financial engineering by analyzing a popular portfolio management strategy. This practice explores Constant Proportion Portfolio Insurance (CPPI), where the goal is to provide downside protection while participating in upside market movements. You will apply Itō's lemma to derive the dynamics of the portfolio's 'coverage ratio' [@problem_id:2404245], a key metric for risk management, and see firsthand how the concepts we've learned are used to model and understand real-world financial products.", "id": "2404245", "problem": "Consider a market with one risky asset and one risk-free asset on a filtered probability space supporting a standard Brownian motion. The risky asset price $S_t$ follows Geometric Brownian Motion (GBM) with constant parameters, so that $dS_t = \\mu S_t \\, dt + \\sigma S_t \\, dW_t$, where $\\mu \\in \\mathbb{R}$ and $\\sigma > 0$. The risk-free asset (money market account) $B_t$ satisfies $dB_t = r B_t \\, dt$ with constant short rate $r \\in \\mathbb{R}$. A Constant Proportion Portfolio Insurance (CPPI) strategy has total portfolio value $A_t$ and a floor process $F_t$ that is continuously financed at the risk-free rate, so that $dF_t = r F_t \\, dt$ with strictly positive $F_t$. The strategy allocates a dollar amount $m \\left(A_t - F_t\\right)$ to the risky asset at each time $t$, where the multiplier $m > 1$ is constant, and the remainder to the risk-free asset. The trading strategy is self-financing. Assume $A_0 > F_0 > 0$ and that $A_t - F_t > 0$ for all $t$ under consideration.\n\nStarting from the self-financing condition and the given asset dynamics, derive from first principles the stochastic differential equation for the coverage ratio $R_t \\equiv \\frac{A_t}{F_t}$ using Itō's lemma. Write the dynamics in the form $dR_t = b_R\\!\\left(R_t,t\\right) \\, dt + a_R\\!\\left(R_t,t\\right) \\, dW_t$ and determine the drift coefficient $b_R\\!\\left(R_t,t\\right)$ and diffusion coefficient $a_R\\!\\left(R_t,t\\right)$ explicitly as functions of $R_t$ and the model parameters. Your final answer must be a single analytic expression containing both coefficients in a single pair. No numerical evaluation is required.", "solution": "The problem is assessed to be valid as it is scientifically grounded, well-posed, and objective. It is a standard exercise in stochastic calculus applied to mathematical finance. We will proceed with the derivation.\n\nThe objective is to derive the stochastic differential equation (SDE) for the coverage ratio $R_t \\equiv \\frac{A_t}{F_t}$. The derivation must proceed from first principles.\n\nFirst, we must establish the SDE for the total portfolio value, $A_t$. The portfolio is self-financing, meaning the change in its value, $dA_t$, is caused only by the returns on the assets held. The portfolio consists of an amount $\\Pi_t^S$ in the risky asset $S_t$ and an amount $\\Pi_t^B$ in the risk-free asset $B_t$. The self-financing condition is expressed as:\n$$\ndA_t = \\Pi_t^S \\frac{dS_t}{S_t} + \\Pi_t^B \\frac{dB_t}{B_t}\n$$\nThe problem specifies the allocation strategy. The dollar amount invested in the risky asset is $\\Pi_t^S = m(A_t - F_t)$, where $m > 1$ is the multiplier. The remainder of the portfolio is invested in the risk-free asset, so $\\Pi_t^B = A_t - \\Pi_t^S = A_t - m(A_t - F_t)$.\n\nThe asset price dynamics are given as:\n$$\n\\frac{dS_t}{S_t} = \\mu \\, dt + \\sigma \\, dW_t\n$$\n$$\n\\frac{dB_t}{B_t} = r \\, dt\n$$\nSubstituting the allocations and asset returns into the self-financing equation yields:\n$$\ndA_t = m(A_t - F_t)(\\mu \\, dt + \\sigma \\, dW_t) + \\left[A_t - m(A_t - F_t)\\right](r \\, dt)\n$$\nWe collect the terms with $dt$ and $dW_t$ to define the drift and diffusion of $A_t$:\n$$\ndA_t = \\left[ m(A_t - F_t)\\mu + rA_t - m r(A_t - F_t) \\right] dt + m\\sigma(A_t - F_t) \\, dW_t\n$$\nGrouping terms by factors of $\\mu$ and $r$:\n$$\ndA_t = \\left[ m(\\mu - r)(A_t - F_t) + rA_t \\right] dt + m\\sigma(A_t - F_t) \\, dW_t\n$$\nThis is the SDE for the portfolio value $A_t$.\n\nNext, we seek the dynamics of the coverage ratio $R_t = \\frac{A_t}{F_t}$. We apply Itō's lemma for a function of two stochastic processes, $A_t$ and $F_t$. Let $R_t = f(A_t, F_t) = \\frac{A_t}{F_t}$. The general form of Itō's lemma for $f(A_t, F_t)$ is:\n$$\ndf = \\frac{\\partial f}{\\partial A} dA_t + \\frac{\\partial f}{\\partial F} dF_t + \\frac{1}{2}\\frac{\\partial^2 f}{\\partial A^2}d\\langle A, A \\rangle_t + \\frac{1}{2}\\frac{\\partial^2 f}{\\partial F^2}d\\langle F, F \\rangle_t + \\frac{\\partial^2 f}{\\partial A \\partial F}d\\langle A, F \\rangle_t\n$$\nThe SDEs for $A_t$ and $F_t$ are:\n$$\ndA_t = \\mu_A \\, dt + \\sigma_A \\, dW_t \\quad \\text{where} \\quad \\mu_A = m(\\mu - r)(A_t - F_t) + rA_t, \\quad \\sigma_A = m\\sigma(A_t - F_t)\n$$\n$$\ndF_t = rF_t \\, dt\n$$\nFrom these, we identify the quadratic variation and covariation terms:\n$d\\langle A, A \\rangle_t = \\sigma_A^2 \\, dt = [m\\sigma(A_t - F_t)]^2 \\, dt$\n$d\\langle F, F \\rangle_t = 0$\n$d\\langle A, F \\rangle_t = 0 \\cdot \\sigma_A \\, dt = 0$\n\nThe terms involving $d\\langle F, F \\rangle_t$ and $d\\langle A, F \\rangle_t$ are zero because the process $F_t$ has zero volatility (it is a deterministic function of time, given $F_0$).\n\nThe required partial derivatives of $f(A, F) = \\frac{A}{F}$ are:\n$\\frac{\\partial f}{\\partial A} = \\frac{1}{F_t}$, $\\frac{\\partial f}{\\partial F} = -\\frac{A_t}{F_t^2}$, and $\\frac{\\partial^2 f}{\\partial A^2} = 0$.\n\nSince $\\frac{\\partial^2 f}{\\partial A^2} = 0$, the quadratic variation term for $A_t$ also vanishes. Thus, Itō's lemma simplifies significantly to the standard quotient rule from calculus, a direct consequence of the denominator process $F_t$ having zero volatility:\n$$\ndR_t = \\frac{\\partial f}{\\partial A} dA_t + \\frac{\\partial f}{\\partial F} dF_t = \\frac{1}{F_t}dA_t - \\frac{A_t}{F_t^2}dF_t\n$$\nNow, we substitute the expressions for $dA_t$ and $dF_t$:\n$$\ndR_t = \\frac{1}{F_t} \\left\\{ \\left[ m(\\mu - r)(A_t - F_t) + rA_t \\right] dt + m\\sigma(A_t - F_t) \\, dW_t \\right\\} - \\frac{A_t}{F_t^2} (rF_t \\, dt)\n$$\nLet us separate the drift ($dt$) and diffusion ($dW_t$) terms for $R_t$.\nThe drift term is:\n$$\n\\left( \\frac{m(\\mu - r)(A_t - F_t) + rA_t}{F_t} - \\frac{rA_t}{F_t} \\right) dt = \\frac{m(\\mu - r)(A_t - F_t)}{F_t} \\, dt\n$$\nThe diffusion term is:\n$$\n\\frac{m\\sigma(A_t - F_t)}{F_t} \\, dW_t\n$$\nCombining these gives the SDE for $R_t$:\n$$\ndR_t = \\frac{m(\\mu - r)(A_t - F_t)}{F_t} \\, dt + \\frac{m\\sigma(A_t - F_t)}{F_t} \\, dW_t\n$$\nFinally, we express the coefficients in terms of $R_t = \\frac{A_t}{F_t}$. We can write $\\frac{A_t - F_t}{F_t} = \\frac{A_t}{F_t} - 1 = R_t - 1$.\nSubstituting this into the SDE:\n$$\ndR_t = m(\\mu - r)(R_t - 1) \\, dt + m\\sigma(R_t - 1) \\, dW_t\n$$\nThis is the desired SDE in the form $dR_t = b_R(R_t,t) \\, dt + a_R(R_t,t) \\, dW_t$. The coefficients do not have explicit time dependence. The drift coefficient is $b_R(R_t) = m(\\mu - r)(R_t - 1)$ and the diffusion coefficient is $a_R(R_t) = m\\sigma(R_t - 1)$. The problem requires both coefficients.", "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nm(\\mu - r)(R_t - 1) & m\\sigma(R_t - 1)\n\\end{pmatrix}\n}\n$$"}]}