{"hands_on_practices": [{"introduction": "To truly grasp the Euler-Maruyama scheme, we must begin with its fundamental action: a single time step. This exercise invites you to analyze the statistical consequences of a one-step-ahead approximation for a mean-reverting process. By calculating the expected value and variance after one step, you will build a core intuition for how the drift and diffusion coefficients of an SDE shape the short-term behavior of its numerical solution [@problem_id:1311634].", "id": "1311634", "problem": "Consider the Ornstein-Uhlenbeck process, a model often used in finance and physics to describe mean-reverting systems. The evolution of this process is governed by the Stochastic Differential Equation (SDE):\n$$dX_t = -\\lambda X_t dt + \\sigma dW_t$$\nwhere $X_t$ is the value of the process at time $t$, $\\lambda > 0$ is the rate of mean reversion, $\\sigma$ is the volatility parameter, and $W_t$ is a standard Wiener process (Brownian motion).\n\nTo approximate the solution numerically, one common method is the Euler-Maruyama scheme. For a general SDE of the form $dX_t = a(X_t, t)dt + b(X_t, t)dW_t$, one step of the Euler-Maruyama approximation from time $t_i$ to $t_{i+1} = t_i + \\Delta t$ is given by:\n$$\\hat{X}_{t_{i+1}} = \\hat{X}_{t_i} + a(\\hat{X}_{t_i}, t_i)\\Delta t + b(\\hat{X}_{t_i}, t_i)\\Delta W_i$$\nwhere $\\Delta W_i = W_{t_{i+1}} - W_{t_i}$ is an increment of the Wiener process. These increments are independent random variables, each drawn from a normal distribution with a mean of zero and a variance equal to the time step, i.e., $\\Delta W_i \\sim N(0, \\Delta t)$.\n\nSuppose we have a specific Ornstein-Uhlenbeck process with parameters $\\lambda = 1$ and $\\sigma = 1$, starting from a known initial value $X_0 = 3$. We wish to analyze the statistical properties of the first numerical step.\n\nCalculate the theoretical expected value and the variance of the approximated value $\\hat{X}_{\\Delta t}$ after a single time step of duration $\\Delta t$. Express your answers for the expected value and the variance, in that order, as a pair of symbolic expressions in terms of the time step $\\Delta t$.\n\n", "solution": "The problem asks for the expected value, $E[\\hat{X}_{\\Delta t}]$, and the variance, $Var(\\hat{X}_{\\Delta t})$, of the one-step Euler-Maruyama approximation for a given Stochastic Differential Equation (SDE).\n\nThe SDE is a specific case of the Ornstein-Uhlenbeck process:\n$$dX_t = -\\lambda X_t dt + \\sigma dW_t$$\nwith parameters $\\lambda = 1$ and $\\sigma = 1$. The SDE is therefore:\n$$dX_t = -X_t dt + dW_t$$\nComparing this to the general form $dX_t = a(X_t, t)dt + b(X_t, t)dW_t$, we can identify the drift coefficient $a(X_t, t) = -X_t$ and the diffusion coefficient $b(X_t, t) = 1$. The initial condition is given as $X_0 = 3$.\n\nThe Euler-Maruyama scheme for a single step from $t_0=0$ to $t_1=\\Delta t$ is:\n$$\\hat{X}_{\\Delta t} = X_0 + a(X_0, 0)\\Delta t + b(X_0, 0)\\Delta W_0$$\nwhere $\\Delta W_0 = W_{\\Delta t} - W_0$ is the first increment of the Wiener process.\n\nSubstituting the specific forms of $a$ and $b$ and the initial condition $X_0 = 3$:\n$$a(X_0, 0) = -X_0 = -3$$\n$$b(X_0, 0) = 1$$\nPlugging these into the Euler-Maruyama formula gives the expression for the approximated value $\\hat{X}_{\\Delta t}$:\n$$\\hat{X}_{\\Delta t} = 3 + (-3)\\Delta t + (1)\\Delta W_0$$\n$$\\hat{X}_{\\Delta t} = 3 - 3\\Delta t + \\Delta W_0$$\n\nNow, we need to find the expected value of $\\hat{X}_{\\Delta t}$. We use the linearity of the expectation operator $E[\\cdot]$.\n$$E[\\hat{X}_{\\Delta t}] = E[3 - 3\\Delta t + \\Delta W_0]$$\nSince $3$ and $3\\Delta t$ are constants (non-random), the expectation operator treats them as such:\n$$E[\\hat{X}_{\\Delta t}] = E[3] - E[3\\Delta t] + E[\\Delta W_0]$$\n$$E[\\hat{X}_{\\Delta t}] = 3 - 3\\Delta t + E[\\Delta W_0]$$\nThe problem states that the Wiener process increment $\\Delta W_0$ is drawn from a normal distribution with mean 0 and variance $\\Delta t$. Thus, $E[\\Delta W_0] = 0$.\nSubstituting this into the equation for the expected value:\n$$E[\\hat{X}_{\\Delta t}] = 3 - 3\\Delta t + 0 = 3 - 3\\Delta t$$\n\nNext, we calculate the variance of $\\hat{X}_{\\Delta t}$. The variance operator $Var(\\cdot)$ has the property that for any random variable $Z$ and constant $c$, $Var(Z+c) = Var(Z)$.\n$$Var(\\hat{X}_{\\Delta t}) = Var(3 - 3\\Delta t + \\Delta W_0)$$\nIn this expression, the term $3 - 3\\Delta t$ is a constant. Therefore, it does not contribute to the variance.\n$$Var(\\hat{X}_{\\Delta t}) = Var(\\Delta W_0)$$\nAs stated in the problem, the variance of the Wiener process increment is equal to the time step, $Var(\\Delta W_0) = \\Delta t$.\nSo, the variance of the one-step approximation is:\n$$Var(\\hat{X}_{\\Delta t}) = \\Delta t$$\n\nThe question asks for the expected value and the variance as a pair of symbolic expressions. The expected value is $3 - 3\\Delta t$ and the variance is $\\Delta t$.", "answer": "$$\\boxed{\\begin{pmatrix} 3 - 3\\Delta t & \\Delta t \\end{pmatrix}}$$"}, {"introduction": "A correct numerical scheme can still produce nonsensical results if it is not stable. This practice delves into the crucial concept of mean-square stability, a condition that ensures the variance of the simulation does not grow uncontrollably [@problem_id:2440441]. By comparing the stability regions of explicit and drift-implicit Euler-Maruyama schemes under a hypothetical stiff SDE, you will learn why the choice of implementation is critical for obtaining reliable results, especially in financial models where parameters can be extreme.", "id": "2440441", "problem": "Consider the linear scalar Stochastic Differential Equation (SDE) defined by $dX_t = a X_t \\, dt + b X_t \\, dW_t$ with initial value $X_0 = x_0$, drift coefficient $a \\in \\mathbb{R}$, volatility coefficient $b \\ge 0$, and where $W_t$ is a standard Wiener process. Let $\\Delta t > 0$ denote a uniform time step and let $\\Delta W_n := W_{t_{n+1}} - W_{t_n}$ be the Wiener increment, which satisfies $\\Delta W_n \\sim \\mathcal{N}(0,\\Delta t)$ and is independent across $n$. Two time-discretization schemes are defined as follows on the grid $t_n = n \\Delta t$:\n- Explicit Euler-Maruyama (EM): $X_{n+1}^{\\mathrm{exp}} = X_n^{\\mathrm{exp}} + a X_n^{\\mathrm{exp}} \\, \\Delta t + b X_n^{\\mathrm{exp}} \\, \\Delta W_n$.\n- Drift-implicit Euler-Maruyama (EM): $X_{n+1}^{\\mathrm{imp}} = X_n^{\\mathrm{imp}} + a X_{n+1}^{\\mathrm{imp}} \\, \\Delta t + b X_n^{\\mathrm{imp}} \\, \\Delta W_n$.\n\nMean-square stability of a one-step scheme for this linear SDE is defined in terms of its per-step mean-square amplification factor. Writing the one-step update in the form $X_{n+1} = G X_n$ for a random scalar $G$ that depends on $a$, $b$, $\\Delta t$, and $\\Delta W_n$, the scheme is said to be mean-square stable if and only if $\\mathbb{E}[|G|^2] < 1$. The expectation is taken over the distribution of the Wiener increment $\\Delta W_n$.\n\nYour task is to determine, for each of the parameter sets in the test suite below, whether each of the two schemes is mean-square stable in the above sense. For each parameter set, output two boolean values: first for the drift-implicit Euler-Maruyama scheme, and second for the explicit Euler-Maruyama scheme.\n\nTest suite (each case is a triple $(a,b,\\Delta t)$):\n- Case $1$: $(a,b,\\Delta t) = (-50.0, 1.0, 0.05)$.\n- Case $2$: $(a,b,\\Delta t) = (-50.0, 1.0, 0.005)$.\n- Case $3$: $(a,b,\\Delta t) = (0.0, 1.0, 0.1)$.\n\nFinal output format: Your program should produce a single line of output containing a list of six boolean values ordered as $[\\text{imp}_{1}, \\text{exp}_{1}, \\text{imp}_{2}, \\text{exp}_{2}, \\text{imp}_{3}, \\text{exp}_{3}]$, where $\\text{imp}_{k}$ and $\\text{exp}_{k}$ are the mean-square stability booleans for the drift-implicit and explicit schemes, respectively, for case $k$. The list must be printed as a comma-separated list enclosed in square brackets, for example $[\\text{True},\\text{False},\\ldots]$.", "solution": "The problem as stated is valid. It is a well-defined question within the standard theory of numerical methods for stochastic differential equations. All necessary definitions, parameters, and conditions are provided, and the problem is free of scientific inaccuracies or ambiguities. We shall proceed with a formal derivation of the stability conditions.\n\nThe linear scalar Stochastic Differential Equation (SDE) is:\n$$dX_t = a X_t \\, dt + b X_t \\, dW_t, \\quad X_0 = x_0$$\nwhere $a \\in \\mathbb{R}$, $b \\ge 0$, and $W_t$ is a standard Wiener process. The mean-square stability of a one-step numerical scheme $X_{n+1} = G X_n$ is determined by the condition $\\mathbb{E}[|G|^2] < 1$, where the expectation is taken over the distribution of the Wiener increment $\\Delta W_n \\sim \\mathcal{N}(0, \\Delta t)$. The key properties of the Wiener increment we will use are its first and second moments: $\\mathbb{E}[\\Delta W_n] = 0$ and $\\mathbb{E}[(\\Delta W_n)^2] = \\Delta t$.\n\nFirst, we analyze the explicit Euler-Maruyama (EM) scheme:\n$$X_{n+1}^{\\mathrm{exp}} = X_n^{\\mathrm{exp}} + a X_n^{\\mathrm{exp}} \\, \\Delta t + b X_n^{\\mathrm{exp}} \\, \\Delta W_n$$\nWe can express this in the form $X_{n+1}^{\\mathrm{exp}} = G_{\\mathrm{exp}} X_n^{\\mathrm{exp}}$ by factoring out $X_n^{\\mathrm{exp}}$:\n$$X_{n+1}^{\\mathrm{exp}} = (1 + a \\Delta t + b \\Delta W_n) X_n^{\\mathrm{exp}}$$\nThe amplification factor is $G_{\\mathrm{exp}} = 1 + a \\Delta t + b \\Delta W_n$. To check for stability, we compute the expectation of its square:\n$$\\mathbb{E}[|G_{\\mathrm{exp}}|^2] = \\mathbb{E}[(1 + a \\Delta t + b \\Delta W_n)^2]$$\nExpanding the term inside the expectation yields:\n$$\\mathbb{E}[|G_{\\mathrm{exp}}|^2] = \\mathbb{E}[(1 + a \\Delta t)^2 + 2(1 + a \\Delta t) b \\Delta W_n + b^2 (\\Delta W_n)^2]$$\nUsing the linearity of expectation, we have:\n$$\\mathbb{E}[|G_{\\mathrm{exp}}|^2] = (1 + a \\Delta t)^2 + 2(1 + a \\Delta t) b \\, \\mathbb{E}[\\Delta W_n] + b^2 \\, \\mathbb{E}[(\\Delta W_n)^2]$$\nSubstituting the moments $\\mathbb{E}[\\Delta W_n] = 0$ and $\\mathbb{E}[(\\Delta W_n)^2] = \\Delta t$:\n$$\\mathbb{E}[|G_{\\mathrm{exp}}|^2] = (1 + a \\Delta t)^2 + b^2 \\Delta t$$\nThus, the condition for mean-square stability of the explicit scheme is:\n$$(1 + a \\Delta t)^2 + b^2 \\Delta t < 1$$\n\nNext, we analyze the drift-implicit Euler-Maruyama scheme:\n$$X_{n+1}^{\\mathrm{imp}} = X_n^{\\mathrm{imp}} + a X_{n+1}^{\\mathrm{imp}} \\, \\Delta t + b X_n^{\\mathrm{imp}} \\, \\Delta W_n$$\nTo find the amplification factor, we must first isolate $X_{n+1}^{\\mathrm{imp}}$:\n$$X_{n+1}^{\\mathrm{imp}} (1 - a \\Delta t) = X_n^{\\mathrm{imp}} (1 + b \\Delta W_n)$$\nAssuming $1 - a \\Delta t \\neq 0$, we solve for $X_{n+1}^{\\mathrm{imp}}$:\n$$X_{n+1}^{\\mathrm{imp}} = \\left(\\frac{1 + b \\Delta W_n}{1 - a \\Delta t}\\right) X_n^{\\mathrm{imp}}$$\nThe amplification factor is $G_{\\mathrm{imp}} = \\frac{1 + b \\Delta W_n}{1 - a \\Delta t}$. The denominator is a deterministic constant. We compute the expectation of its square:\n$$\\mathbb{E}[|G_{\\mathrm{imp}}|^2] = \\mathbb{E}\\left[\\left|\\frac{1 + b \\Delta W_n}{1 - a \\Delta t}\\right|^2\\right] = \\frac{1}{(1 - a \\Delta t)^2} \\mathbb{E}[(1 + b \\Delta W_n)^2]$$\nThe expectation in the numerator is $\\mathbb{E}[1 + 2b \\Delta W_n + b^2 (\\Delta W_n)^2] = 1 + 2b\\mathbb{E}[\\Delta W_n] + b^2\\mathbb{E}[(\\Delta W_n)^2] = 1 + b^2 \\Delta t$.\nTherefore, we obtain:\n$$\\mathbb{E}[|G_{\\mathrm{imp}}|^2] = \\frac{1 + b^2 \\Delta t}{(1 - a \\Delta t)^2}$$\nThe condition for mean-square stability of the drift-implicit scheme is:\n$$\\frac{1 + b^2 \\Delta t}{(1 - a \\Delta t)^2} < 1$$\n\nWe now apply these two conditions to the test cases.\n\nCase 1: $(a,b,\\Delta t) = (-50.0, 1.0, 0.05)$\n- **Drift-implicit scheme:** The stability value is $\\frac{1 + (1.0)^2(0.05)}{(1 - (-50.0)(0.05))^2} = \\frac{1.05}{(1+2.5)^2} = \\frac{1.05}{12.25} \\approx 0.0857$. Since $0.0857 < 1$, the scheme is stable (True).\n- **Explicit scheme:** The stability value is $(1 + (-50.0)(0.05))^2 + (1.0)^2(0.05) = (1 - 2.5)^2 + 0.05 = (-1.5)^2 + 0.05 = 2.25 + 0.05 = 2.3$. Since $2.3 \\ge 1$, the scheme is unstable (False).\n\nCase 2: $(a,b,\\Delta t) = (-50.0, 1.0, 0.005)$\n- **Drift-implicit scheme:** The stability value is $\\frac{1 + (1.0)^2(0.005)}{(1 - (-50.0)(0.005))^2} = \\frac{1.005}{(1+0.25)^2} = \\frac{1.005}{1.5625} = 0.6432$. Since $0.6432 < 1$, the scheme is stable (True).\n- **Explicit scheme:** The stability value is $(1 + (-50.0)(0.005))^2 + (1.0)^2(0.005) = (1 - 0.25)^2 + 0.005 = (0.75)^2 + 0.005 = 0.5625 + 0.005 = 0.5675$. Since $0.5675 < 1$, the scheme is stable (True).\n\nCase 3: $(a,b,\\Delta t) = (0.0, 1.0, 0.1)$\nFor $a=0.0$, the two schemes are identical, and we expect identical stability results.\n- **Drift-implicit scheme:** The stability value is $\\frac{1 + (1.0)^2(0.1)}{(1 - (0.0)(0.1))^2} = \\frac{1.1}{1^2} = 1.1$. Since $1.1 \\ge 1$, the scheme is unstable (False).\n- **Explicit scheme:** The stability value is $(1 + (0.0)(0.1))^2 + (1.0)^2(0.1) = 1^2 + 0.1 = 1.1$. Since $1.1 \\ge 1$, the scheme is unstable (False).\n\nCombining these results in the specified order gives the final list of boolean values: $[\\text{True}, \\text{False}, \\text{True}, \\text{True}, \\text{False}, \\text{False}]$.", "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# from scipy import ...\n\ndef solve():\n    \"\"\"\n    Determines the mean-square stability of two Euler-Maruyama schemes for a\n    linear scalar SDE for a given set of test cases.\n    \"\"\"\n    # Test suite: each case is a tuple (a, b, dt)\n    test_cases = [\n        (-50.0, 1.0, 0.05),\n        (-50.0, 1.0, 0.005),\n        (0.0, 1.0, 0.1),\n    ]\n\n    results = []\n    for case in test_cases:\n        a, b, dt = case\n\n        # --- Drift-implicit Euler-Maruyama stability analysis ---\n        # The stability condition is derived from E[|G_imp|^2] < 1, where\n        # G_imp = (1 + b*dW_n) / (1 - a*dt).\n        # This leads to the condition: (1 + b**2 * dt) / (1 - a * dt)**2 < 1.\n        \n        # Note: The denominator (1 - a*dt) is non-zero for all test cases.\n        imp_stability_value = (1 + b**2 * dt) / (1 - a * dt)**2\n        is_stable_imp = imp_stability_value < 1.0\n        results.append(is_stable_imp)\n\n        # --- Explicit Euler-Maruyama stability analysis ---\n        # The stability condition is derived from E[|G_exp|^2] < 1, where\n        # G_exp = 1 + a*dt + b*dW_n.\n        # This leads to the condition: (1 + a * dt)**2 + b**2 * dt < 1.\n        \n        exp_stability_value = (1 + a * dt)**2 + b**2 * dt\n        is_stable_exp = exp_stability_value < 1.0\n        results.append(is_stable_exp)\n\n    # The final output must be a single line containing a list of boolean values\n    # ordered as [imp_1, exp_1, imp_2, exp_2, imp_3, exp_3].\n    # map(str, results) converts [True, False, ...] to ['True', 'False', ...].\n    # ','.join(...) creates the comma-separated string 'True,False,...'.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"}, {"introduction": "In the world of computational finance, resources are finite. This exercise presents a realistic challenge: how to best allocate a fixed computational budget to minimize the overall error in a Monte Carlo simulation [@problem_id:2440399]. You will explore the fundamental trade-off between discretization error, which shrinks with smaller time steps ($\\Delta t$), and statistical error, which shrinks with more simulation paths ($N$). Mastering this balance is the key to designing efficient and accurate numerical experiments.", "id": "2440399", "problem": "In computational economics and finance, consider estimating the expectation of a smooth payoff $f$ of the terminal state $X_T$ of a stochastic differential equation (SDE) using Monte Carlo (MC) simulation with the Euler–Maruyama (EM) time discretization. Specifically, let $X_t$ solve\n$$\n\\mathrm{d}X_t = a(X_t)\\,\\mathrm{d}t + b(X_t)\\,\\mathrm{d}W_t,\\quad t\\in[0,T],\\quad X_0=x_0,\n$$\nwhere $a(\\cdot)$ and $b(\\cdot)$ are globally Lipschitz and $T>0$, and suppose $f$ is sufficiently smooth so that the EM scheme has weak convergence order $p=1$ for $\\mathbb{E}[f(X_T)]$. You simulate $N$ independent paths with a uniform time step $\\Delta t$, so the number of time steps per path is $M=T\\,\\Delta t^{-1}$.\n\nAssume the following cost and error model:\n- The total computational cost is proportional to the total number of time steps computed, so the fixed budget constraint can be written as $N\\,M=K$, where $K>0$ is a given constant that must be fully used.\n- The mean squared error (MSE) of the MC estimator $\\hat{\\mu}_{N,\\Delta t}=\\frac{1}{N}\\sum_{i=1}^{N} f(\\hat{X}_T^{(i)})$ for $\\mu=\\mathbb{E}[f(X_T)]$ admits the standard decomposition into variance plus squared bias. Under the stated smoothness, the variance scales as $C_1 N^{-1}$ for some $C_1>0$ (independent of $N$ and $\\Delta t$), and the squared bias scales as $C_2 \\Delta t^{2p}=C_2 \\Delta t^{2}$ for some $C_2>0$ (independent of $N$ and $\\Delta t$). Higher-order terms can be ignored.\n\nUnder these assumptions and the budget constraint $N\\,T\\,\\Delta t^{-1}=K$, which of the following statements about the trade-off between using many paths $N$ versus a small time step $\\Delta t$ is/are correct?\n\nA. There is an interior optimal allocation that minimizes the MSE, characterized (up to positive multiplicative constants independent of $K$) by $\\Delta t^\\star \\propto K^{-1/3}$ and $N^\\star \\propto K^{2/3}$.\n\nB. For any fixed budget $K$, maximizing $N$ (and thus using as large a $\\Delta t$ as needed to satisfy the budget) always minimizes the MSE.\n\nC. When the EM scheme has weak order $p=1$, the optimal allocation under a fixed budget equates the variance and the squared bias contributions to the MSE.\n\nD. If the variance scales like $\\mathcal{O}(N^{-1})$ and the weak discretization error scales like $\\mathcal{O}(\\Delta t)$, then under the fixed budget $K$ the minimal achievable MSE scales like $\\mathcal{O}(K^{-2/3})$.\n\nE. In estimating $\\mathbb{E}[f(X_T)]$ for smooth $f$, the strong convergence order of EM determines the discretization bias in the MSE; the weak order is irrelevant for this purpose.\n\nSelect all that apply.", "solution": "The problem asks for an analysis of the trade-off in a Monte Carlo simulation for a stochastic differential equation, specifically how to allocate a fixed computational budget to minimize the mean squared error. I will first validate the problem statement and then, upon confirmation of its validity, proceed to a full mathematical derivation and evaluation of each provided option.\n\nThe problem is valid. It presents a standard, well-posed optimization problem in the field of computational finance. The assumptions about the SDE, the Euler-Maruyama scheme, the error components, and the computational cost are all standard and scientifically sound. The problem is self-contained and stated with sufficient precision to admit a unique, verifiable solution.\n\nLet us proceed with the derivation. The goal is to estimate $\\mu = \\mathbb{E}[f(X_T)]$. The Mean Squared Error (MSE) of the estimator $\\hat{\\mu}_{N,\\Delta t}$ is given by the sum of the variance and the squared bias. According to the problem statement, we have:\n$$\n\\text{MSE} \\approx C_1 N^{-1} + C_2 \\Delta t^{2p}\n$$\nwhere $p=1$ is the weak order of convergence. Thus, the function to be minimized is:\n$$\nE(N, \\Delta t) = C_1 N^{-1} + C_2 \\Delta t^2\n$$\nThe minimization is subject to a fixed computational budget constraint:\n$$\nN \\cdot M = K\n$$\nwhere $M = T \\Delta t^{-1}$ is the number of time steps. Substituting $M$ into the constraint gives:\n$$\nN T \\Delta t^{-1} = K\n$$\nwhere $K > 0$ is a constant representing the total budget. This constraint connects the number of paths $N$ and the time step size $\\Delta t$. We can express one variable in terms of the other. Let us express $N$ as a function of $\\Delta t$:\n$$\nN = K T^{-1} \\Delta t\n$$\nNow, we substitute this expression for $N$ into the MSE equation to obtain the MSE as a function of a single variable, $\\Delta t$:\n$$\nE(\\Delta t) = C_1 (K T^{-1} \\Delta t)^{-1} + C_2 \\Delta t^2 = C_1 T K^{-1} \\Delta t^{-1} + C_2 \\Delta t^2\n$$\nTo find the optimal time step $\\Delta t^\\star$ that minimizes this error, we must compute the first derivative of $E(\\Delta t)$ with respect to $\\Delta t$ and set it to zero.\n$$\n\\frac{\\mathrm{d}E}{\\mathrm{d}\\Delta t} = -C_1 T K^{-1} \\Delta t^{-2} + 2 C_2 \\Delta t\n$$\nSetting the derivative to zero yields the first-order condition for an extremum:\n$$\n2 C_2 \\Delta t = C_1 T K^{-1} \\Delta t^{-2}\n$$\nSolving for $\\Delta t$:\n$$\n\\Delta t^3 = \\frac{C_1 T}{2 C_2 K}\n$$\n$$\n\\Delta t^\\star = \\left(\\frac{C_1 T}{2 C_2}\\right)^{1/3} K^{-1/3}\n$$\nThe second derivative is $\\frac{\\mathrm{d}^2E}{\\mathrm{d}(\\Delta t)^2} = 2 C_1 T K^{-1} \\Delta t^{-3} + 2 C_2$, which is strictly positive for $\\Delta t > 0$, confirming that this is indeed a minimum.\n\nUsing the relation $N = K T^{-1} \\Delta t$, we find the optimal number of paths $N^\\star$:\n$$\nN^\\star = K T^{-1} \\Delta t^\\star = K T^{-1} \\left(\\frac{C_1 T}{2 C_2}\\right)^{1/3} K^{-1/3} = \\left(\\frac{C_1 K^3 T^{-3} T}{2 C_2}\\right)^{1/3} = \\left(\\frac{C_1 K^2}{2 C_2 T^2}\\right)^{1/3}\n$$\nFrom these expressions, we can determine the scaling with respect to the budget $K$:\n$$\n\\Delta t^\\star \\propto K^{-1/3} \\quad \\text{and} \\quad N^\\star \\propto K^{2/3}\n$$\nNow let us evaluate each statement.\n\nA. There is an interior optimal allocation that minimizes the MSE, characterized (up to positive multiplicative constants independent of $K$) by $\\Delta t^\\star \\propto K^{-1/3}$ and $N^\\star \\propto K^{2/3}$.\nOur derivation shows that there exists a unique positive value for $\\Delta t^\\star$ that minimizes the MSE. This represents an interior optimum, as opposed to a boundary solution where $\\Delta t \\to 0$ or $\\Delta t$ is maximal. The derived scalings are $\\Delta t^\\star \\propto K^{-1/3}$ and $N^\\star \\propto (K^2)^{1/3} = K^{2/3}$. This is precisely what the statement claims.\nVerdict: **Correct**.\n\nB. For any fixed budget $K$, maximizing $N$ (and thus using as large a $\\Delta t$ as needed to satisfy the budget) always minimizes the MSE.\nFrom the budget constraint $N = K T^{-1} \\Delta t$, maximizing the number of paths $N$ requires maximizing the time step $\\Delta t$. This would minimize the variance term $C_1 N^{-1}$ but maximize the squared bias term $C_2 \\Delta t^2$. As we have found an interior optimum, such a corner solution at one extreme of the trade-off cannot be the general minimum. The optimal balance depends on the relative magnitudes of the constants $C_1$ and $C_2$.\nVerdict: **Incorrect**.\n\nC. When the EM scheme has weak order $p=1$, the optimal allocation under a fixed budget equates the variance and the squared bias contributions to the MSE.\nLet us examine the two error components at the optimal allocation.\nThe variance term is $V^\\star = C_1 (N^\\star)^{-1} = C_1 (K T^{-1} \\Delta t^\\star)^{-1} = C_1 T K^{-1} (\\Delta t^\\star)^{-1}$.\nThe squared bias term is $(B^\\star)^2 = C_2 (\\Delta t^\\star)^2$.\nFrom our first-order condition for optimality, $2 C_2 \\Delta t^\\star = C_1 T K^{-1} (\\Delta t^\\star)^{-2}$. Multiplying by $\\Delta t^\\star$, we get:\n$$\n2 C_2 (\\Delta t^\\star)^2 = C_1 T K^{-1} (\\Delta t^\\star)^{-1}\n$$\nThis is equivalent to:\n$$\n2 (B^\\star)^2 = V^\\star\n$$\nAt the optimum, the variance contribution is twice the squared bias contribution. They are not equal.\nVerdict: **Incorrect**.\n\nD. If the variance scales like $\\mathcal{O}(N^{-1})$ and the weak discretization error scales like $\\mathcal{O}(\\Delta t)$, then under the fixed budget $K$ the minimal achievable MSE scales like $\\mathcal{O}(K^{-2/3})$.\nThe premise of this statement is consistent with the problem setup, where \"weak discretization error\" scaling as $\\mathcal{O}(\\Delta t)$ corresponds to the weak order $p=1$, and thus a squared bias of $\\mathcal{O}(\\Delta t^2)$. Let us compute the minimal MSE, $E^\\star = E(\\Delta t^\\star)$:\n$$\nE^\\star = V^\\star + (B^\\star)^2\n$$\nUsing the relation $V^\\star = 2(B^\\star)^2$, we have $E^\\star = 3(B^\\star)^2 = 3 C_2 (\\Delta t^\\star)^2$.\nSince we found that $\\Delta t^\\star \\propto K^{-1/3}$, the minimal MSE scales as:\n$$\nE^\\star \\propto (\\Delta t^\\star)^2 \\propto (K^{-1/3})^2 = K^{-2/3}\n$$\nThe minimal achievable MSE scales as $\\mathcal{O}(K^{-2/3})$.\nVerdict: **Correct**.\n\nE. In estimating $\\mathbb{E}[f(X_T)]$ for smooth $f$, the strong convergence order of EM determines the discretization bias in the MSE; the weak order is irrelevant for this purpose.\nThe discretization bias in the MSE for the quantity $\\mathbb{E}[f(X_T)]$ is precisely the difference $\\mathbb{E}[f(\\hat{X}_T)] - \\mathbb{E}[f(X_T)]$, where $\\hat{X}_T$ is the numerical approximation at time $T$. The rate at which this difference converges to zero as $\\Delta t \\to 0$ is the definition of the weak order of convergence. The strong convergence order, on the other hand, concerns the pathwise error, characterized by quantities like $\\mathbb{E}[|X_T - \\hat{X}_T|]$. While strong convergence can provide an upper bound for the weak error, the weak convergence order gives the sharp rate for the bias of interest. For the Euler-Maruyama scheme, the weak order ($p=1$) is typically higher than the strong order ($\\gamma=0.5$), making it the more relevant and accurate measure for the bias in this context. The statement is fundamentally contrary to these definitions.\nVerdict: **Incorrect**.", "answer": "$$\\boxed{AD}$$"}]}