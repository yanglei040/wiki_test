{
    "hands_on_practices": [
        {
            "introduction": "理解变分不等式算子的数学性质，如单调性，是分析和求解这些问题的关键第一步。本练习将引导你剖析一个仿射算子 $F(x) = Ax + b$ 的结构，并通过基本定义来检验其单调性，特别关注其对称和斜对称部分如何影响这些核心性质 。通过这个练习，你将对算子性质的判定及其对微小扰动的鲁棒性有更深入的理解。",
            "id": "3197571",
            "problem": "考虑如下定义的变分不等式 (VI)：找到 $x^{\\star} \\in K$，使得对于所有 $y \\in K$，都有 $\\langle F(x^{\\star}), y - x^{\\star} \\rangle \\ge 0$ 成立，其中 $K = [0,1]^n$ 是 $n$ 维方盒，$F: \\mathbb{R}^n \\to \\mathbb{R}^n$ 是一个给定映射。如果对于所有 $x,y \\in K$ 都有 $\\langle F(x) - F(y), x - y \\rangle \\ge 0$，则称算子 $F$ 在集合 $K$ 上是单调的。令 $n = 2$，并特化为仿射映射 $F(x) = A x + b$，其中对称矩阵 $A \\in \\mathbb{R}^{2 \\times 2}$ 和向量 $b \\in \\mathbb{R}^2$ 由下式给出：\n$$\nA = \\begin{pmatrix} 2  0 \\\\ 0  4 \\end{pmatrix}, \\qquad b = \\begin{pmatrix} -1 \\\\ -3 \\end{pmatrix}.\n$$\n你将通过半正定性来检验单调性，然后研究小的非对称扰动的影响。\n\n定义一个扰动算子 $F_{\\epsilon}(x) = (A + \\epsilon E)x + b$，其中 $\\epsilon \\in \\mathbb{R}$ 且\n$$\nE = \\begin{pmatrix} 0  1 \\\\ -1  0 \\end{pmatrix}.\n$$\n任务：\n- 仅使用基本定义，验证 $F$ 在 $K$ 上的单调性，并解释 $A$ 上意味着单调性的精确结构条件。\n- 分析由 $\\epsilon E$ 控制的扰动如何影响单调性，并从第一性原理出发严格地论证你的结论。\n- 在唯一 VI 解 $x^{\\star}(\\epsilon)$ 位于方盒内部的假设下，即对于 $i \\in \\{1,2\\}$ 有 $0  x_i^{\\star}(\\epsilon)  1$，推导 VI 解的第一个分量 $x_1^{\\star}(\\epsilon)$ 作为 $\\epsilon$ 的函数的闭式解析表达式。\n\n你的最终答案必须是关于 $x_1^{\\star}(\\epsilon)$ 的单个闭式表达式。",
            "solution": "问题陈述已被评估并被认为是有效的。这是一个适定的、有科学依据的数学优化问题，特别是关于变分不等式。所有必要的数据和定义都已提供，没有矛盾或歧义。\n\n问题是分析一个变分不等式 (VI) 并在特定条件下找到其解的一个分量。该 VI 是找到 $x^{\\star} \\in K$ 使得对于所有 $y \\in K$ 都有 $\\langle F(x^{\\star}), y - x^{\\star} \\rangle \\ge 0$。\n\n首先，我们按规定完成三个任务。\n\n**任务1：$F(x) = Ax+b$ 的单调性**\n\n算子 $F$ 在集合 $K$ 上是单调的，其定义为：如果对于所有 $x, y \\in K$ 都有 $\\langle F(x) - F(y), x - y \\rangle \\ge 0$。\n对于给定的仿射算子 $F(x) = Ax + b$，我们有：\n$$\nF(x) - F(y) = (Ax + b) - (Ay + b) = A(x - y)\n$$\n将其代入单调性条件，得到：\n$$\n\\langle A(x - y), x - y \\rangle \\ge 0\n$$\n令 $z = x - y$。由于 $x$ 和 $y$ 可以是 $K = [0,1]^2$ 中的任意向量，向量 $z$ 可以取集合 $\\{x-y \\mid x,y \\in [0,1]^2\\} = [-1,1]^2$ 中的任意值。然而，对于 $\\mathbb{R}^n$ 上的仿射算子 $F(x) = Ax+b$ 的标准单调性定义要求该条件对所有 $x,y \\in \\mathbb{R}^n$ 成立，这意味着 $z$ 可以是 $\\mathbb{R}^n$ 中的任意向量。条件 $\\langle Az, z \\rangle \\ge 0$ 对所有 $z \\in \\mathbb{R}^n$ 成立，是矩阵 $A$ 为半正定的定义。这是 $A$ 上的精确结构条件，它意味着仿射映射 $F(x) = Ax+b$ 在任何集合 $K \\subseteq \\mathbb{R}^n$ 上都是单调的。\n\n我们现在对给定的矩阵 $A$ 进行验证：\n$$\nA = \\begin{pmatrix} 2  0 \\\\ 0  4 \\end{pmatrix}\n$$\n这个矩阵是对称的。一个对称矩阵是半正定的当且仅当其所有特征值都是非负的。对角矩阵的特征值是其对角元素。因此，$A$ 的特征值是 $\\lambda_1 = 2$ 和 $\\lambda_2 = 4$。由于两个特征值都严格为正，矩阵 $A$ 是正定的，这是一个比半正定更强的条件。\n对于任意非零向量 $z = \\begin{pmatrix} z_1 \\\\ z_2 \\end{pmatrix} \\in \\mathbb{R}^2$，我们有：\n$$\n\\langle Az, z \\rangle = z^T A z = \\begin{pmatrix} z_1  z_2 \\end{pmatrix} \\begin{pmatrix} 2  0 \\\\ 0  4 \\end{pmatrix} \\begin{pmatrix} z_1 \\\\ z_2 \\end{pmatrix} = 2z_1^2 + 4z_2^2 > 0\n$$\n由于对于所有 $x, y \\in \\mathbb{R}^2$（因此也对所有 $x,y \\in K$）都有 $\\langle A(x - y), x - y \\rangle \\ge 0$，算子 $F$ 在 $\\mathbb{R}^2$ 上是严格单调的，因此在 $K$ 上也是。\n\n**任务2：扰动对单调性的影响**\n\n扰动算子为 $F_{\\epsilon}(x) = (A + \\epsilon E)x + b$，其中 $A_{\\epsilon} = A + \\epsilon E$。\n$$\nA_{\\epsilon} = \\begin{pmatrix} 2  0 \\\\ 0  4 \\end{pmatrix} + \\epsilon \\begin{pmatrix} 0  1 \\\\ -1  0 \\end{pmatrix} = \\begin{pmatrix} 2  \\epsilon \\\\ -\\epsilon  4 \\end{pmatrix}\n$$\n为了分析 $F_{\\epsilon}$ 的单调性，我们检查与之前相同的条件：\n$$\n\\langle F_{\\epsilon}(x) - F_{\\epsilon}(y), x - y \\rangle \\ge 0 \\quad \\forall x,y \\in K\n$$\n这等价于检查对于 $z = x - y$ 是否有 $\\langle A_{\\epsilon}z, z \\rangle \\ge 0$。我们对任意 $z \\in \\mathbb{R}^n$ 分析此条件。\n$$\n\\langle A_{\\epsilon}z, z \\rangle = \\langle (A + \\epsilon E)z, z \\rangle = \\langle Az, z \\rangle + \\langle \\epsilon E z, z \\rangle = \\langle Az, z \\rangle + \\epsilon \\langle E z, z \\rangle\n$$\n从第一个任务中，我们知道 $\\langle Az, z \\rangle \\ge 0$。我们现在考察项 $\\langle Ez, z \\rangle$。矩阵 $E$ 是斜对称的，即 $E^T = -E$。对于任何斜对称矩阵 $M$ 和任何向量 $z$，二次型 $\\langle Mz, z \\rangle$ 总是为零。这可以从第一性原理证明：\n值 $\\langle Mz, z \\rangle = z^T M z$ 是一个标量，所以它等于其转置：\n$$\n\\langle Mz, z \\rangle = (z^T M z)^T = z^T M^T (z^T)^T = z^T M^T z\n$$\n使用斜对称性质 $M^T = -M$，我们得到：\n$$\nz^T M^T z = z^T (-M) z = - z^T M z = - \\langle Mz, z \\rangle\n$$\n因此，我们证明了 $\\langle Mz, z \\rangle = - \\langle Mz, z \\rangle$，这意味着 $2 \\langle Mz, z \\rangle = 0$，所以 $\\langle Mz, z \\rangle = 0$。\n将此应用于我们的特定矩阵 $E$，我们有对于所有 $z \\in \\mathbb{R}^2$ 都有 $\\langle Ez, z \\rangle = 0$。\n\n$F_{\\epsilon}$ 的单调性条件变为：\n$$\n\\langle A_{\\epsilon}z, z \\rangle = \\langle Az, z \\rangle + \\epsilon \\cdot 0 = \\langle Az, z \\rangle \\ge 0\n$$\n这个结果与 $\\epsilon$ 无关。由于 $F(x)$ 是单调的，所以对于任意 $\\epsilon \\in \\mathbb{R}$，$F_{\\epsilon}(x)$ 也是单调的。斜对称扰动不影响仿射算子的单调性。\n\n**任务3：解分量 $x_1^{\\star}(\\epsilon)$ 的推导**\n\n问题是找到求解该 VI 的 $x^{\\star}(\\epsilon)$。我们有一个关键假设，即解位于方盒 $K=[0,1]^2$ 的内部，即 $x^{\\star}(\\epsilon) \\in (0,1)^2$。\n\n设 $x^{\\star}$ 是一个内部解。那么，对于任意向量 $v \\in \\mathbb{R}^2$，我们可以找到一个足够小的标量 $t>0$，使得 $y_1 = x^{\\star} + tv$ 和 $y_2 = x^{\\star} - tv$ 都在 $K$ 中。\nVI 条件必须对 $y_1$ 成立：\n$$\n\\langle F_{\\epsilon}(x^{\\star}), y_1 - x^{\\star} \\rangle = \\langle F_{\\epsilon}(x^{\\star}), tv \\rangle = t \\langle F_{\\epsilon}(x^{\\star}), v \\rangle \\ge 0\n$$\n因为 $t>0$，这意味着 $\\langle F_{\\epsilon}(x^{\\star}), v \\rangle \\ge 0$。\nVI 条件也必须对 $y_2$ 成立：\n$$\n\\langle F_{\\epsilon}(x^{\\star}), y_2 - x^{\\star} \\rangle = \\langle F_{\\epsilon}(x^{\\star}), -tv \\rangle = -t \\langle F_{\\epsilon}(x^{\\star}), v \\rangle \\ge 0\n$$\n这意味着 $\\langle F_{\\epsilon}(x^{\\star}), v \\rangle \\le 0$。\n为了使两个条件同时成立，我们必须有 $\\langle F_{\\epsilon}(x^{\\star}), v \\rangle = 0$。由于这对*任意*向量 $v \\in \\mathbb{R}^2$ 都必须成立，这迫使向量 $F_{\\epsilon}(x^{\\star})$ 本身为零向量。\n$$\nF_{\\epsilon}(x^{\\star}(\\epsilon)) = 0\n$$\n这将 VI 问题简化为求解一个线性方程组：\n$$\n(A + \\epsilon E) x^{\\star} + b = 0 \\implies (A + \\epsilon E) x^{\\star} = -b\n$$\n代入给定的矩阵和向量：\n$$\n\\begin{pmatrix} 2  \\epsilon \\\\ -\\epsilon  4 \\end{pmatrix} \\begin{pmatrix} x_1^{\\star} \\\\ x_2^{\\star} \\end{pmatrix} = - \\begin{pmatrix} -1 \\\\ -3 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 3 \\end{pmatrix}\n$$\n我们想找到 $x_1^{\\star}(\\epsilon)$ 的表达式。我们可以使用克莱姆法则。系数矩阵 $A_{\\epsilon} = A + \\epsilon E$ 的行列式是：\n$$\n\\det(A_{\\epsilon}) = (2)(4) - (\\epsilon)(-\\epsilon) = 8 + \\epsilon^2\n$$\n为了找到 $x_1^{\\star}$，我们将 $A_{\\epsilon}$ 的第一列替换为右侧向量 $-b$，并计算这个新矩阵的行列式：\n$$\n\\det \\begin{pmatrix} 1  \\epsilon \\\\ 3  4 \\end{pmatrix} = (1)(4) - (\\epsilon)(3) = 4 - 3\\epsilon\n$$\n$x_1^{\\star}(\\epsilon)$ 的解是这些行列式的比值：\n$$\nx_1^{\\star}(\\epsilon) = \\frac{4 - 3\\epsilon}{8 + \\epsilon^2}\n$$\n这是在解位于定义域 $K$ 内部的假设下，VI 解第一个分量的闭式解析表达式。注意，对于实数 $\\epsilon$，分母 $8+\\epsilon^2$ 总是正的，所以该表达式总是良定义的。",
            "answer": "$$\n\\boxed{\\frac{4 - 3\\epsilon}{\\epsilon^2 + 8}}\n$$"
        },
        {
            "introduction": "理论分析与数值实现相结合是掌握优化算法精髓的必经之路。这个综合性练习聚焦于求解变分不等式的迭代算法，深入探讨了算子的结构（特别是斜对称部分）如何影响算法的收敛速度 。你将从第一性原理出发，推导两种经典算法（梯度法和外梯度法）的收敛因子，并通过编程实现来亲眼验证理论预测，从而深刻体会到算法设计的精妙之处。",
            "id": "3197483",
            "problem": "考虑在 $\\mathbb{R}^2$ 上的无约束变分不等式 (VI)，它由单调算子 $F:\\mathbb{R}^2 \\to \\mathbb{R}^2$ 定义，具体为\n$$\nF(z) = M z, \\qquad M = \\mu I + \\alpha J, \\qquad J = \\begin{bmatrix} 0  1 \\\\ -1  0 \\end{bmatrix},\n$$\n其中参数 $\\mu > 0$ 且 $\\alpha \\in \\mathbb{R}$。该 VI 问题是找到一个 $z^\\star \\in \\mathbb{R}^2$，使得\n$$\n\\langle F(z^\\star), y - z^\\star \\rangle \\ge 0 \\quad \\text{对于所有 } y \\in \\mathbb{R}^2 \\text{ 成立}.\n$$\n因为可行集是整个空间且 $F$ 是线性的，该 VI 问题简化为求解 $F(z^\\star) = 0$，即 $M z^\\star = 0$。\n\n任务：\n1) 从单调性和利普希茨连续性的核心定义出发，证明：\n- $F$ 是 $\\mu$-强单调的，即对于所有 $x,y \\in \\mathbb{R}^2$，\n$$\n\\langle F(x) - F(y), x - y \\rangle \\ge \\mu \\|x - y\\|_2^2.\n$$\n- $F$ 对于欧几里得范数是 $L$-利普希茨连续的，其中\n$$\nL = \\|M\\|_2 = \\sqrt{\\mu^2 + \\alpha^2}.\n$$\n解释为什么 $J$ 是反对称的，这如何导致 $M$ 的对称部分是 $\\mu I$，以及为什么这是 $F$ 是 $\\mu$-强单调的根本原因。\n\n2) 考虑应用于 $F$ 的基本前向（不动点）方法：\n$$\nz_{k+1} = z_k - \\eta F(z_k) = (I - \\eta M) z_k.\n$$\n仅使用线性代数和对 $M$ 的特征分析，推导此迭代关于步长 $\\eta$ 的精确线性收敛因子：\n- 证明 $M$ 的特征值为 $\\lambda_\\pm = \\mu \\pm i\\alpha$。\n- 论证沿任一特征方向的单次迭代误差收缩率为 $|1 - \\eta \\lambda_\\pm|$，因此最坏情况下的收缩因子为\n$$\n\\rho_{\\mathrm{gd}}(\\eta) = \\max \\left\\{ |1 - \\eta(\\mu + i\\alpha)|, \\, |1 - \\eta(\\mu - i\\alpha)| \\right\\} = \\sqrt{(1 - \\eta \\mu)^2 + (\\eta \\alpha)^2}.\n$$\n- 通过在 $\\eta > 0$ 的范围内最小化 $\\rho_{\\mathrm{gd}}(\\eta)$，确定最优步长\n$$\n\\eta_{\\mathrm{gd}}^\\star = \\frac{\\mu}{\\mu^2 + \\alpha^2},\n$$\n以及相应的最优收缩因子\n$$\n\\rho_{\\mathrm{gd}}^\\star = \\sqrt{1 - \\frac{\\mu^2}{\\mu^2 + \\alpha^2}} = \\frac{|\\alpha|}{\\sqrt{\\mu^2 + \\alpha^2}}.\n$$\n从 $M$ 的谱性质出发，仔细论证每一步。\n\n3) 考虑对此 VI 问题使用的外梯度法（也称为 Korpelevich 方法），该方法无投影（因为可行集是 $\\mathbb{R}^2$）：\n$$\ny_k = z_k - \\eta F(z_k), \\qquad z_{k+1} = z_k - \\eta F(y_k).\n$$\n对于线性的 $F(z) = M z$，证明此迭代是线性的，其迭代矩阵为\n$$\nP(\\eta) = I - \\eta M + \\eta^2 M^2.\n$$\n具体到步长 $\\eta_{\\mathrm{eg}} = 1/L$，证明在与特征值 $\\lambda \\in \\{\\mu \\pm i\\alpha\\}$（其中 $|\\lambda| = \\sqrt{\\mu^2 + \\alpha^2} = L$）对应的任一特征方向上，标量收缩因子等于\n$$\n\\rho_{\\mathrm{eg}} = \\left|1 - \\frac{\\lambda}{L} + \\frac{\\lambda^2}{L^2}\\right| = \\left|2\\cos\\theta - 1\\right| = \\left| \\frac{2\\mu}{L} - 1 \\right|,\n$$\n其中 $\\cos\\theta = \\mu/L$ 且 $\\sin\\theta = \\alpha/L$。结论是，当 $|\\alpha|$ 相对于 $\\mu$ 很大时，基本前向方法的收敛因子表现为 $1 - \\tfrac{1}{2}(\\mu/\\alpha)^2$（非常慢），而外梯度法的收敛因子表现为 $1 - 2(\\mu/|\\alpha|)$（快得多）。解释其直观原因：反对称分量会引起旋转，基本前向方法无法有效抑制这种旋转，而外梯度法的“前瞻”步骤在此双线性玩具模型中抵消了这种旋转的很大一部分。\n\n4) 实现和数值测试套件。实现一个程序，该程序：\n- 使用初始点 $z_0 = [1, -1]^T$。\n- 对欧几里得范数使用 $\\varepsilon = 10^{-6}$ 的容差，即当 $\\|z_k\\|_2 \\le \\varepsilon$ 时停止。\n- 使用以下 $(\\mu,\\alpha)$ 对的测试套件，选择这些值是为了探测不同的情况：\n    - 情况 1（接近对称）：$(\\mu,\\alpha) = (1, 0.1)$。\n    - 情况 2（平衡）：$(\\mu,\\alpha) = (1, 1)$。\n    - 情况 3（反对称主导）：$(\\mu,\\alpha) = (1, 5)$。\n    - 情况 4（高度反对称主导）：$(\\mu,\\alpha) = (1, 20)$。\n- 对每种情况：\n    - 运行使用最优步长 $\\eta_{\\mathrm{gd}}^\\star = \\mu / (\\mu^2 + \\alpha^2)$ 的基本前向方法，并计算直到 $\\|z_k\\|_2 \\le \\varepsilon$ 所需的迭代次数 $k_{\\mathrm{gd}}$。\n    - 运行使用步长 $\\eta_{\\mathrm{eg}} = 1 / \\sqrt{\\mu^2 + \\alpha^2}$ 的外梯度法，并计算直到 $\\|z_k\\|_2 \\le \\varepsilon$ 所需的迭代次数 $k_{\\mathrm{eg}}$。\n    - 使用 $200{,}000$ 的最大迭代上限，以避免在退化参数选择中出现无限循环；在此测试套件中，不应达到此上限。\n\n最终输出规格：\n- 您的程序应生成单行输出，其中包含一个由方括号括起来的、包含八个整数的逗号分隔列表，顺序如下\n$$\n[k_{\\mathrm{gd}}^{(1)}, k_{\\mathrm{eg}}^{(1)}, k_{\\mathrm{gd}}^{(2)}, k_{\\mathrm{eg}}^{(2)}, k_{\\mathrm{gd}}^{(3)}, k_{\\mathrm{eg}}^{(3)}, k_{\\mathrm{gd}}^{(4)}, k_{\\mathrm{eg}}^{(4)}],\n$$\n其中上标表示测试套件中的情况编号。不应打印任何额外文本。",
            "solution": "问题陈述已经过验证，被认为是有效的。这是一个在数值优化和变分不等式领域中，提法恰当、内容完整且科学合理的问题。\n\n变分不等式 (VI) 的唯一解是 $z^\\star \\in \\mathbb{R}^2$，满足 $F(z^\\star) = 0$。给定 $F(z) = Mz$，这等价于求解线性系统 $Mz^\\star=0$。矩阵 $M = \\mu I + \\alpha J$ 的行列式为 $\\det(M) = \\mu^2 + \\alpha^2$。因为给定 $\\mu > 0$，所以 $\\det(M) > 0$，这保证了 $M$ 是可逆的。因此，该 VI 的唯一解是 $z^\\star = M^{-1}0 = 0$。下面的分析关注两种迭代方法收敛到此解的收敛速度。\n\n**1) F 的单调性和利普希茨连续性**\n\n我们分析算子 $F(z) = Mz$ 的性质。\n\n**强单调性：**\n算子 $F$ 的 $\\mu$-强单调性定义为：对于所有 $x, y$，有 $\\langle F(x) - F(y), x - y \\rangle \\ge \\mu \\|x - y\\|_2^2$。\n对于线性算子 $F(z)=Mz$，我们有 $F(x) - F(y) = Mx - My = M(x-y)$。将其代入定义可得：\n$$\n\\langle M(x-y), x-y \\rangle \\ge \\mu \\|x-y\\|_2^2\n$$\n令 $v = x-y$。不等式变为 $\\langle Mv, v \\rangle \\ge \\mu \\|v\\|_2^2$。\n内积可以写成二次型 $v^T M v$。任何方阵 $M$ 都可以分解为其对称部分 $M_{\\text{sym}} = \\frac{1}{2}(M+M^T)$ 和其反对称部分 $M_{\\text{skew}} = \\frac{1}{2}(M-M^T)$，使得 $M = M_{\\text{sym}} + M_{\\text{skew}}$。对于任意向量 $v$，反对称部分的二次型为零：$v^T M_{\\text{skew}} v = 0$。\n因此，$v^T M v = v^T M_{\\text{sym}} v$。\n\n让我们求 $M = \\mu I + \\alpha J$ 的对称部分。首先，我们注意到矩阵 $J = \\begin{bmatrix} 0  1 \\\\ -1  0 \\end{bmatrix}$ 是反对称的，因为 $J^T = \\begin{bmatrix} 0  -1 \\\\ 1  0 \\end{bmatrix} = -J$。$M$ 的转置是：\n$$\nM^T = (\\mu I + \\alpha J)^T = \\mu I^T + \\alpha J^T = \\mu I - \\alpha J\n$$\n$M$ 的对称部分是：\n$$\nM_{\\text{sym}} = \\frac{1}{2}(M + M^T) = \\frac{1}{2}( (\\mu I + \\alpha J) + (\\mu I - \\alpha J) ) = \\frac{1}{2}(2\\mu I) = \\mu I\n$$\n这就是 $F$ 具有强单调性的根本原因。非对称部分对 $\\langle Mv, v \\rangle$ 的值没有贡献。\n我们现在可以计算这个内积：\n$$\n\\langle M(x-y), x-y \\rangle = (x-y)^T M_{\\text{sym}} (x-y) = (x-y)^T (\\mu I) (x-y) = \\mu (x-y)^T (x-y) = \\mu \\|x-y\\|_2^2\n$$\n此式以等号成立，满足 $\\ge$ 条件，从而证明 $F$ 是 $\\mu$-强单调的。\n\n**利普希茨连续性：**\n算子 $F$ 的 $L$-利普希茨连续性定义为 $\\|F(x) - F(y)\\|_2 \\le L \\|x - y\\|_2$。\n对于 $F(z)=Mz$，这变为：\n$$\n\\|M(x-y)\\|_2 \\le L \\|x-y\\|_2\n$$\n根据定义，矩阵 $M$ 的诱导 2-范数是 $\\|M\\|_2 = \\sup_{v \\ne 0} \\frac{\\|Mv\\|_2}{\\|v\\|_2}$。因此，$L$（利普希茨常数）的最小可能值是 $L = \\|M\\|_2$。\n$M$ 的诱导 2-范数是其最大奇异值，即 $M^T M$ 的最大特征值的平方根。\n$$\nM^T M = (\\mu I - \\alpha J)(\\mu I + \\alpha J) = \\mu^2 I^2 + \\mu \\alpha J - \\alpha \\mu J - \\alpha^2 J^2 = \\mu^2 I - \\alpha^2 J^2\n$$\n我们计算 $J^2$：\n$$\nJ^2 = \\begin{bmatrix} 0  1 \\\\ -1  0 \\end{bmatrix} \\begin{bmatrix} 0  1 \\\\ -1  0 \\end{bmatrix} = \\begin{bmatrix} -1  0 \\\\ 0  -1 \\end{bmatrix} = -I\n$$\n将其代回 $M^T M$ 的表达式中：\n$$\nM^T M = \\mu^2 I - \\alpha^2 (-I) = (\\mu^2 + \\alpha^2)I\n$$\n这是一个对角线上元素均为 $(\\mu^2 + \\alpha^2)$ 的对角矩阵。它的所有特征值都是 $\\mu^2 + \\alpha^2$。最大特征值为 $\\lambda_{\\text{max}}(M^T M) = \\mu^2 + \\alpha^2$。\n因此，利普希茨常数 $L$ 是：\n$$\nL = \\|M\\|_2 = \\sqrt{\\lambda_{\\text{max}}(M^T M)} = \\sqrt{\\mu^2 + \\alpha^2}\n$$\n这证实了 $F$ 是 $L$-利普希茨连续的，其中 $L=\\sqrt{\\mu^2 + \\alpha^2}$。\n\n**2) 基本前向方法（不动点迭代）**\n\n迭代公式为 $z_{k+1} = z_k - \\eta F(z_k)$。由于 $F(z_k) = M z_k$，这是一个线性迭代：\n$$\nz_{k+1} = z_k - \\eta M z_k = (I - \\eta M) z_k\n$$\n此迭代收敛到解 $z^\\star=0$ 的性质由迭代矩阵 $G(\\eta) = I - \\eta M$ 的谱半径决定。\n\n**M 的特征值：**\n为了求 $M$ 的特征值，我们求解特征方程 $\\det(M - \\lambda I) = 0$。\n$$\nM - \\lambda I = \\begin{bmatrix} \\mu-\\lambda  \\alpha \\\\ -\\alpha  \\mu-\\lambda \\end{bmatrix}\n$$\n$$\n\\det(M - \\lambda I) = (\\mu-\\lambda)^2 - (\\alpha)(-\\alpha) = (\\mu-\\lambda)^2 + \\alpha^2 = 0\n$$\n这意味着 $(\\mu-\\lambda)^2 = -\\alpha^2$，所以 $\\mu-\\lambda = \\pm i\\alpha$。$M$ 的特征值为 $\\lambda_{\\pm} = \\mu \\mp i\\alpha$。我们使用问题中陈述的约定 $\\lambda_{\\pm} = \\mu \\pm i\\alpha$，这描述的是同一组特征值。\n\n**收敛因子：**\n迭代矩阵 $G(\\eta) = I - \\eta M$ 的特征值为 $1 - \\eta \\lambda_{\\pm}$。谱半径 $\\rho_{\\mathrm{gd}}(\\eta) = \\rho(G(\\eta))$ 是这些特征值模长的最大值。\n$$\n|1 - \\eta \\lambda_{\\pm}| = |1 - \\eta(\\mu \\pm i\\alpha)| = |(1 - \\eta\\mu) \\mp i(\\eta\\alpha)| = \\sqrt{(1 - \\eta\\mu)^2 + (\\eta\\alpha)^2}\n$$\n两个特征值的模长相同。因此，每次迭代的误差收缩因子为：\n$$\n\\rho_{\\mathrm{gd}}(\\eta) = \\sqrt{(1 - \\eta\\mu)^2 + (\\eta\\alpha)^2}\n$$\n\n**最优步长和收缩因子：**\n为了找到最优步长 $\\eta^\\star_{\\mathrm{gd}}$，我们对 $\\eta > 0$ 最小化 $\\rho_{\\mathrm{gd}}(\\eta)$。这等价于最小化其平方 $g(\\eta) = (1 - \\eta\\mu)^2 + (\\eta\\alpha)^2$。我们通过将导数设为零来求最小值：\n$$\n\\frac{dg}{d\\eta} = 2(1 - \\eta\\mu)(-\\mu) + 2(\\eta\\alpha)(\\alpha) = -2\\mu + 2\\eta\\mu^2 + 2\\eta\\alpha^2 = 0\n$$\n$$\n2\\eta(\\mu^2 + \\alpha^2) = 2\\mu \\implies \\eta^\\star_{\\mathrm{gd}} = \\frac{\\mu}{\\mu^2 + \\alpha^2}\n$$\n将此最优步长代回其收缩因子的平方表达式中：\n$$\n(\\rho_{\\mathrm{gd}}^\\star)^2 = \\left(1 - \\frac{\\mu}{\\mu^2 + \\alpha^2} \\mu\\right)^2 + \\left(\\frac{\\mu}{\\mu^2 + \\alpha^2} \\alpha\\right)^2\n$$\n$$\n= \\left(\\frac{\\mu^2+\\alpha^2-\\mu^2}{\\mu^2+\\alpha^2}\\right)^2 + \\frac{\\mu^2\\alpha^2}{(\\mu^2+\\alpha^2)^2} = \\left(\\frac{\\alpha^2}{\\mu^2+\\alpha^2}\\right)^2 + \\frac{\\mu^2\\alpha^2}{(\\mu^2+\\alpha^2)^2}\n$$\n$$\n= \\frac{\\alpha^4 + \\mu^2\\alpha^2}{(\\mu^2+\\alpha^2)^2} = \\frac{\\alpha^2(\\alpha^2 + \\mu^2)}{(\\mu^2+\\alpha^2)^2} = \\frac{\\alpha^2}{\\mu^2 + \\alpha^2}\n$$\n最优收缩因子是其平方根：\n$$\n\\rho_{\\mathrm{gd}}^\\star = \\sqrt{\\frac{\\alpha^2}{\\mu^2 + \\alpha^2}} = \\frac{|\\alpha|}{\\sqrt{\\mu^2 + \\alpha^2}}\n$$\n\n**3) 外梯度法**\n\n外梯度迭代由下式给出：\n$$\ny_k = z_k - \\eta F(z_k), \\qquad z_{k+1} = z_k - \\eta F(y_k)\n$$\n对于线性算子 $F(z)=Mz$，我们可以找到其线性迭代矩阵。\n$$\ny_k = z_k - \\eta M z_k = (I - \\eta M) z_k\n$$\n$$\nz_{k+1} = z_k - \\eta M y_k = z_k - \\eta M (I - \\eta M) z_k = (I - \\eta M(I - \\eta M)) z_k = (I - \\eta M + \\eta^2 M^2) z_k\n$$\n迭代矩阵为 $P(\\eta) = I - \\eta M + \\eta^2 M^2$。\n\n**步长为 $\\eta_{\\mathrm{eg}} = 1/L$ 时的收缩因子：**\n$P(\\eta)$ 的特征值形式为 $1 - \\eta \\lambda + \\eta^2 \\lambda^2$，其中 $\\lambda$ 是 $M$ 的一个特征值。我们使用步长 $\\eta_{\\mathrm{eg}} = 1/L = 1/\\sqrt{\\mu^2+\\alpha^2}$。\n$M$ 的特征值为 $\\lambda_{\\pm} = \\mu \\pm i\\alpha$。它们的模长为 $|\\lambda_{\\pm}| = \\sqrt{\\mu^2+\\alpha^2} = L$。\n所以我们可以写成 $\\lambda = L e^{\\pm i\\theta}$，其中 $\\cos\\theta = \\mu/L$ 且 $\\sin\\theta = \\alpha/L$。步长为 $\\eta = 1/L = 1/|\\lambda|$。\n迭代矩阵 $P(1/L)$ 相应的特征值为：\n$$\np(\\lambda) = 1 - \\frac{\\lambda}{L} + \\left(\\frac{\\lambda}{L}\\right)^2 = 1 - e^{\\pm i\\theta} + (e^{\\pm i\\theta})^2\n$$\n收缩因子是其模长 $|p(\\lambda)|$。我们来分析 $1 - z + z^2$，其中 $|z|=1$。\n令 $z = e^{i\\theta}$。则 $1 - e^{i\\theta} + e^{i2\\theta} = e^{i\\theta}(e^{-i\\theta} - 1 + e^{i\\theta}) = e^{i\\theta}(2\\cos\\theta - 1)$。\n其模长为 $|e^{i\\theta}(2\\cos\\theta-1)| = |e^{i\\theta}| \\cdot |2\\cos\\theta - 1| = |2\\cos\\theta - 1|$。\n因为 $\\cos\\theta = \\mu/L$，每个特征方向的收缩因子为：\n$$\n\\rho_{\\mathrm{eg}} = \\left| \\frac{2\\mu}{L} - 1 \\right|\n$$\n$P(1/L)$ 的谱半径就是这个值，因为对于两个特征值 $\\lambda_{\\pm}$ 它都是相同的。\n\n**当 $|\\alpha|/\\mu$ 很大时的渐近比较：**\n令 $r = |\\alpha|/\\mu \\gg 1$。\n前向方法的最优因子是 $\\rho_{\\mathrm{gd}}^\\star = \\frac{|\\alpha|}{\\sqrt{\\mu^2+\\alpha^2}} = \\frac{|\\alpha|/\\mu}{\\sqrt{1+(\\alpha/\\mu)^2}} = \\frac{r}{\\sqrt{1+r^2}} = (1+r^{-2})^{-1/2}$。使用泰勒展开 $(1+x)^k \\approx 1+kx$ 对于小的 $x=r^{-2}$，我们得到：\n$$\n\\rho_{\\mathrm{gd}}^\\star \\approx 1 - \\frac{1}{2}r^{-2} = 1 - \\frac{1}{2}\\left(\\frac{\\mu}{|\\alpha|}\\right)^2\n$$\n外梯度法的因子是 $\\rho_{\\mathrm{eg}} = |\\frac{2\\mu}{L}-1| = |\\frac{2\\mu}{\\sqrt{\\mu^2+\\alpha^2}}-1| = |\\frac{2}{\\sqrt{1+r^2}}-1|$。对于大的 $r$，$\\frac{2}{\\sqrt{1+r^2}}  1$，所以绝对值可以去掉：\n$$\n\\rho_{\\mathrm{eg}} = 1 - \\frac{2}{\\sqrt{1+r^2}} = 1-2(1+r^2)^{-1/2} \\approx 1-2\\left(1 - \\frac{1}{2}r^{-2}\\right) = 1-2+\\frac{1}{r^2} = -1 + r^{-2}\n$$\n这里的近似需要更小心。让我们使用一个不同的近似：$(1+r^2)^{-1/2} = \\frac{1}{r}(1+r^{-2})^{-1/2} \\approx \\frac{1}{r}(1 - \\frac{1}{2}r^{-2})$。\n$$\n\\rho_{\\mathrm{eg}} \\approx 1 - \\frac{2}{r}\\left(1 - \\frac{1}{2r^2}\\right) = 1 - \\frac{2}{r} + \\frac{1}{r^3} \\approx 1 - \\frac{2}{r} = 1 - \\frac{2\\mu}{|\\alpha|}\n$$\n比较收敛速度：对于 $\\rho \\approx 1-\\delta$，一个更小的 $\\delta$ 意味着更慢的收敛。前向方法的 $\\delta_{\\mathrm{gd}} \\approx \\frac{1}{2}(\\mu/|\\alpha|)^2$，而外梯度法的 $\\delta_{\\mathrm{eg}} \\approx 2(\\mu/|\\alpha|)$。对于大的 $|\\alpha|/\\mu$，$\\mu/|\\alpha|$ 是一个小数，它的一次幂远大于其二次幂。因此，$\\delta_{\\mathrm{eg}} \\gg \\delta_{\\mathrm{gd}}$，这意味着外梯度法的收敛速度快得多。\n\n直观上，大的 $\\alpha$ 项对应于算子 $F$ 中一个强的旋转分量。基本前向步骤 $z_k - \\eta F(z_k)$ 的移动方向偏离了最速下降方向，发生了“旋转”。外梯度法到 $y_k$ 的“前瞻”步骤以及随后对 $F(y_k)$ 的使用，有效地预测并抵消了这种旋转的很大一部分，从而得到一条更直接的通往解的路径，因此收敛更快。\n\n**4) 实现与数值测试**\n\n两种算法的数值实现，已根据指定的 $(\\mu, \\alpha)$ 对套件进行了测试，并在下面的最终答案部分提供。该代码计算并打印每种方法和每个测试用例收敛所需的迭代次数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the variational inequality problem using the basic forward method\n    and the extragradient method for a suite of test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (mu, alpha)\n        (1.0, 0.1),  # Case 1 (near-symmetric)\n        (1.0, 1.0),  # Case 2 (balanced)\n        (1.0, 5.0),  # Case 3 (skew-dominated)\n        (1.0, 20.0), # Case 4 (highly skew-dominated)\n    ]\n    \n    z0 = np.array([1.0, -1.0])\n    epsilon = 1e-6\n    max_iter = 200000\n    \n    results = []\n\n    for mu, alpha in test_cases:\n        # Define the matrix M for the current case\n        M = np.array([\n            [mu, alpha],\n            [-alpha, mu]\n        ])\n        \n        # --- Basic Forward (Gradient) Method with Optimal Step Size ---\n        eta_gd = mu / (mu**2 + alpha**2)\n        z = z0.copy()\n        k_gd = 0\n        while np.linalg.norm(z)  epsilon and k_gd  max_iter:\n            Fz = M @ z\n            z = z - eta_gd * Fz\n            k_gd += 1\n        results.append(k_gd)\n        \n        # --- Extragradient Method with step size 1/L ---\n        L = np.sqrt(mu**2 + alpha**2)\n        eta_eg = 1.0 / L\n        z = z0.copy()\n        k_eg = 0\n        while np.linalg.norm(z)  epsilon and k_eg  max_iter:\n            # Extragradient step\n            Fz = M @ z\n            y = z - eta_eg * Fz\n            Fy = M @ y\n            z = z - eta_eg * Fy\n            k_eg += 1\n        results.append(k_eg)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}