{
    "hands_on_practices": [
        {
            "introduction": "To master column generation, we first need to understand its core decision-making tool: the reduced cost. This exercise focuses on this fundamental calculation, which tells us the potential improvement offered by a new column at the current stage of the optimization process . By computing the reduced cost $r_{p} = c_{p} - \\pi^{\\top} a_{p}$ for several candidate columns, you will develop an intuition for how the pricing subproblem identifies promising new variables.",
            "id": "3108996",
            "problem": "Consider a column generation setting for a linear Restricted Master Problem written in primal standard form as minimize an objective of the form $\\sum_{p} c_{p} x_{p}$ subject to a system of two equality constraints $A x = b$ and nonnegativity $x \\ge 0$. The dual variables associated with the two equality constraints are collected in the vector $\\pi \\in \\mathbb{R}^{2}$. At a given iteration, the current dual price vector is $\\pi = (1,1)$. You are given three candidate columns with their associated cost coefficients and constraint columns: column $p=1$ has $a_{1} = (2,0)$ and $c_{1} = 3$, column $p=2$ has $a_{2} = (1,1)$ and $c_{2} = 2$, and column $p=3$ has $a_{3} = (0,2)$ and $c_{3} = 3$. Using only fundamental principles of linear programming duality and the definition of reduced cost, compute the reduced cost for each candidate column at the given dual vector $\\pi$, and then report the minimum reduced cost among the three candidates. Express your final answer as a single real number. No rounding is required.",
            "solution": "We begin from fundamental principles of linear programming duality. Consider a primal problem in standard form with equality constraints and nonnegativity, written as minimize $\\sum_{p} c_{p} x_{p}$ subject to $A x = b$, $x \\ge 0$, where $A \\in \\mathbb{R}^{m \\times n}$ and $b \\in \\mathbb{R}^{m}$. Its Lagrangian with dual vector $\\pi \\in \\mathbb{R}^{m}$ associated with the equality constraints is\n$$\n\\mathcal{L}(x,\\pi) = \\sum_{p} c_{p} x_{p} + \\pi^{\\top} (b - A x) = \\pi^{\\top} b + \\sum_{p} \\left(c_{p} - a_{p}^{\\top} \\pi\\right) x_{p},\n$$\nwhere $a_{p}$ denotes the $p$-th column of $A$. The coefficient multiplying $x_{p}$ in the Lagrangian, namely $c_{p} - a_{p}^{\\top} \\pi$, is the reduced cost of variable $x_{p}$ with respect to the dual vector $\\pi$. This follows because, for a given $\\pi$, the Lagrangian provides a linearized measure of how introducing a small positive amount of $x_{p}$ changes the objective after accounting for the value of the constraints through $\\pi$. In column generation, the pricing subproblem evaluates this reduced cost to decide whether adding the corresponding column can improve the current Restricted Master Problem solution (for a minimization problem, a negative reduced cost indicates potential improvement).\n\nThus, for each candidate column $p$, the reduced cost is\n$$\nr_{p} = c_{p} - a_{p}^{\\top} \\pi.\n$$\n\nWe are given $\\pi = (1,1)$ and three candidates:\n\n1. For $p=1$, we have $a_{1} = (2,0)$ and $c_{1} = 3$. Compute\n$$\na_{1}^{\\top} \\pi = (2,0) \\cdot (1,1) = 2 \\cdot 1 + 0 \\cdot 1 = 2,\n$$\nso\n$$\nr_{1} = 3 - 2 = 1.\n$$\n\n2. For $p=2$, we have $a_{2} = (1,1)$ and $c_{2} = 2$. Compute\n$$\na_{2}^{\\top} \\pi = (1,1) \\cdot (1,1) = 1 \\cdot 1 + 1 \\cdot 1 = 2,\n$$\nso\n$$\nr_{2} = 2 - 2 = 0.\n$$\n\n3. For $p=3$, we have $a_{3} = (0,2)$ and $c_{3} = 3$. Compute\n$$\na_{3}^{\\top} \\pi = (0,2) \\cdot (1,1) = 0 \\cdot 1 + 2 \\cdot 1 = 2,\n$$\nso\n$$\nr_{3} = 3 - 2 = 1.\n$$\n\nThe three reduced costs are $r_{1} = 1$, $r_{2} = 0$, and $r_{3} = 1$. The minimum reduced cost among the three candidates is therefore\n$$\n\\min\\{1, 0, 1\\} = 0.\n$$\n\nBecause the current problem is a minimization, the fact that the minimum reduced cost is $0$ indicates that none of the candidates offers strict improvement at this dual vector, although the column with reduced cost $0$ is marginal with respect to optimality conditions.",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "Now that you can calculate reduced costs, let's see how this fits into a complete iteration of the column generation algorithm. This practice guides you through the essential cycle: solving a simplified Restricted Master Problem (RMP), calculating the corresponding dual variables $\\pi$, and then using these duals to price out a new column . This exercise reveals the interplay between the master and pricing problems that drives the entire method forward.",
            "id": "3108999",
            "problem": "Consider the linear program (LP) in column generation form where the primal is a minimization problem with equality constraints and nonnegativity: minimize $c^{\\top}x$ subject to $A x = b$ and $x \\ge 0$. Let the Restricted Master Problem (RMP) be defined by two constraints with\n$$\nA=\\begin{pmatrix}1  1  0 \\\\ 0  1  1\\end{pmatrix},\\quad\nb=\\begin{pmatrix}1 \\\\ 1\\end{pmatrix},\\quad\nc=\\begin{pmatrix}1 \\\\ 1 \\\\ 1\\end{pmatrix}.\n$$\nIn column generation, one maintains a working set of columns as a basis. Initialize the RMP basis with columns $1$ and $3$ of $A$, and treat column $2$ as currently missing. From first principles of primal-dual linear programming and reduced costs, compute the dual vector $\\pi \\in \\mathbb{R}^{2}$ associated with the current basis and the reduced cost of the missing column $2$. Use these quantities to decide whether column $2$ should enter the basis.\n\nReport your final result as a single row matrix whose first two entries are the components of $\\pi$ and whose third entry is the reduced cost of column $2$. No rounding is required.",
            "solution": "The problem is a valid application of linear programming, specifically the column generation method. All necessary data and definitions are provided, and the problem is well-posed and scientifically grounded. We proceed with the solution.\n\nThe general form of the primal linear program (LP) is given as:\n$$\n\\text{minimize } z = c^{\\top}x\n$$\n$$\n\\text{subject to } Ax = b\n$$\n$$\nx \\ge 0\n$$\n\nThe given full problem matrices and vectors are:\n$$\nA = \\begin{pmatrix} 1  1  0 \\\\ 0  1  1 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}, \\quad c = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\end{pmatrix}\n$$\n\nThe column generation process starts with a Restricted Master Problem (RMP) that includes a subset of the columns of $A$. We are instructed to initialize the basis with columns $1$ and $3$. Let the index set of basic columns be $\\mathcal{B} = \\{1, 3\\}$. The basis matrix, denoted $A_B$, is formed by these columns:\n$$\nA_B = \\begin{pmatrix} A_1  A_3 \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}\n$$\nThis is the $2 \\times 2$ identity matrix, $I_2$.\n\nThe cost vector corresponding to the basic variables is $c_B$:\n$$\nc_B = \\begin{pmatrix} c_1 \\\\ c_3 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n$$\n\nThe dual problem associated with the RMP involves finding a vector of dual variables $\\pi \\in \\mathbb{R}^2$. The dual variables are the solution to the system of equations that prices out the basic columns to zero reduced cost. The condition is $c_B^{\\top} - \\pi^{\\top} A_B = 0^{\\top}$, which is more commonly written as:\n$$\n\\pi^{\\top} A_B = c_B^{\\top}\n$$\nTransposing both sides gives a system of linear equations for $\\pi$:\n$$\nA_B^{\\top} \\pi = c_B\n$$\nSubstituting the matrices $A_B$ and $c_B$:\n$$\n\\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}^{\\top} \\begin{pmatrix} \\pi_1 \\\\ \\pi_2 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n$$\nSince the transpose of the identity matrix is the identity matrix itself, the system is:\n$$\n\\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} \\pi_1 \\\\ \\pi_2 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n$$\nThis yields the solution for the dual vector $\\pi$:\n$$\n\\pi_1 = 1\n$$\n$$\n\\pi_2 = 1\n$$\nSo, the dual vector is $\\pi = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$.\n\nNext, we must determine if any non-basic columns should be added to the RMP. This is done by computing the reduced cost for each non-basic column. In this problem, the only non-basic column specified for evaluation is column $2$.\n\nThe reduced cost $\\bar{c}_j$ for a column $j$ is defined as:\n$$\n\\bar{c}_j = c_j - \\pi^{\\top} A_j\n$$\nFor column $j=2$, we have the cost $c_2 = 1$ and the column vector $A_2 = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$.\nSubstituting the values of $\\pi$, $c_2$, and $A_2$ into the formula:\n$$\n\\bar{c}_2 = c_2 - \\pi^{\\top} A_2 = 1 - \\begin{pmatrix} 1  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n$$\nPerforming the matrix multiplication:\n$$\n\\bar{c}_2 = 1 - (1 \\cdot 1 + 1 \\cdot 1) = 1 - (1 + 1) = 1 - 2\n$$\n$$\n\\bar{c}_2 = -1\n$$\nThe reduced cost for column $2$ is $-1$.\n\nIn a minimization problem, a column is a candidate to enter the basis if its reduced cost is negative. Since $\\bar{c}_2 = -1  0$, introducing column $2$ into the basis will lead to a decrease in the objective function value. Therefore, column $2$ should enter the basis.\n\nThe problem asks for a final report as a single row matrix containing the components of $\\pi$ and the reduced cost of column $2$.\nThe components of $\\pi$ are $\\pi_1 = 1$ and $\\pi_2 = 1$.\nThe reduced cost of column $2$ is $\\bar{c}_2 = -1$.\nThe resulting row matrix is $\\begin{pmatrix} 1  1  -1 \\end{pmatrix}$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1  1  -1\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "We now apply the full column generation framework to one of its most famous applications: the cutting-stock problem. This problem demonstrates how column generation can solve problems with an astronomical number of potential variables (cutting patterns) by generating them only as needed . You will see how the abstract pricing subproblem transforms into a concrete and well-known combinatorial problem—the knapsack problem—showcasing the elegance and power of this decomposition technique.",
            "id": "3108997",
            "problem": "You are given a one-dimensional cutting-stock planning problem with roll length $L=17$, item sizes $S=\\{3,4,7\\}$, and demands $d=(3,2,2)$ corresponding to sizes $3$, $4$, and $7$, respectively. The objective is to minimize the number of rolls used. A cutting pattern $p$ is a vector $a_{\\cdot p}=(a_{1p},a_{2p},a_{3p})$ of nonnegative integers, where $a_{ip}$ is the count of items of size $s_i$ cut in pattern $p$, and any feasible pattern must satisfy the length feasibility constraint $\\sum_{i=1}^{3} s_i a_{ip} \\le L$. Consider a linear programming (LP) relaxation master formulation over a subset of patterns with decision variables $x_p \\ge 0$ denoting how many times pattern $p$ is used. The objective coefficient for any pattern is $c_p=1$ (each roll used costs one unit). Constraints ensure that the demands are met.\n\nStart from a restricted master problem that includes only the three “single-size maximal-fill” patterns:\n- $p_1$ cuts only size $3$ items as many as fit: $(a_{1p_1},a_{2p_1},a_{3p_1})=(5,0,0)$,\n- $p_2$ cuts only size $4$ items as many as fit: $(0,4,0)$,\n- $p_3$ cuts only size $7$ items as many as fit: $(0,0,2)$.\n\nTasks:\n1. Formulate the restricted master problem using these three patterns and solve it to optimality. From first principles of LP duality, write down the dual of this restricted master and use complementary slackness to determine the optimal dual prices $\\pi_1,\\pi_2,\\pi_3$ associated with the demand constraints for sizes $3$, $4$, and $7$.\n2. Using the optimal dual prices, derive the pricing subproblem as an integer knapsack problem that selects a new pattern $p$ by choosing nonnegative integers $(a_{1p},a_{2p},a_{3p})$ satisfying $\\sum_{i=1}^{3} s_i a_{ip} \\le L$ so as to minimize the reduced cost. Solve this pricing problem exactly and compute the minimal reduced cost value returned by the pricing subproblem at this iteration.\n\nState the final answer as the single numerical value of the minimal reduced cost, expressed as an exact rational number.",
            "solution": "The problem asks for the execution of one iteration of the column generation algorithm for a one-dimensional cutting-stock problem. This involves two main tasks: first, solving a restricted master problem (RMP) and finding its dual prices, and second, using these prices to solve a pricing subproblem to find a new cutting pattern with the most negative reduced cost.\n\n### Part 1: Restricted Master Problem and Dual Prices\n\nThe initial Restricted Master Problem (RMP) is formulated using a given subset of feasible cutting patterns. The objective is to satisfy total demand for all item types while minimizing the total number of rolls used.\n\nThe given parameters are:\n- Roll length: $L = 17$.\n- Item sizes: $s_1 = 3$, $s_2 = 4$, $s_3 = 7$.\n- Demands: $d_1 = 3$, $d_2 = 2$, $d_3 = 2$.\n\nThe initial basic patterns, denoted $p_1, p_2, p_3$, are the \"single-size maximal-fill\" patterns.\n- Pattern $p_1$: Cuts only items of size $s_1=3$. The number of items is $\\lfloor L/s_1 \\rfloor = \\lfloor 17/3 \\rfloor = 5$. The pattern vector is $a_{\\cdot 1} = (5, 0, 0)$.\n- Pattern $p_2$: Cuts only items of size $s_2=4$. The number of items is $\\lfloor L/s_2 \\rfloor = \\lfloor 17/4 \\rfloor = 4$. The pattern vector is $a_{\\cdot 2} = (0, 4, 0)$.\n- Pattern $p_3$: Cuts only items of size $s_3=7$. The number of items is $\\lfloor L/s_3 \\rfloor = \\lfloor 17/7 \\rfloor = 2$. The pattern vector is $a_{\\cdot 3} = (0, 0, 2)$.\n\nLet $x_p \\ge 0$ be the decision variable representing how many times pattern $p$ is used. The LP-relaxed RMP is:\n$$\n\\begin{align*}\n\\text{Minimize} \\quad Z =  x_1 + x_2 + x_3 \\\\\n\\text{Subject to} \\quad  5x_1 \\ge 3  (\\text{demand for size } 3) \\\\\n 4x_2 \\ge 2  (\\text{demand for size } 4) \\\\\n 2x_3 \\ge 2  (\\text{demand for size } 7) \\\\\n x_1, x_2, x_3 \\ge 0\n\\end{align*}\n$$\nTo minimize the sum $x_1+x_2+x_3$, we must choose the smallest possible values for each variable that satisfy the constraints. This yields the optimal primal solution for the RMP:\n$x_1^* = \\frac{3}{5}$, $x_2^* = \\frac{2}{4} = \\frac{1}{2}$, $x_3^* = \\frac{2}{2} = 1$.\nThe optimal objective value is $Z^* = \\frac{3}{5} + \\frac{1}{2} + 1 = \\frac{6}{10} + \\frac{5}{10} + \\frac{10}{10} = \\frac{21}{10}$.\n\nNext, we formulate the dual of this RMP. Let $\\pi_1, \\pi_2, \\pi_3$ be the dual variables associated with the three demand constraints. The dual problem is:\n$$\n\\begin{align*}\n\\text{Maximize} \\quad W =  3\\pi_1 + 2\\pi_2 + 2\\pi_3 \\\\\n\\text{Subject to} \\quad  5\\pi_1 \\le 1  (\\text{dual constraint for } x_1) \\\\\n 4\\pi_2 \\le 1  (\\text{dual constraint for } x_2) \\\\\n 2\\pi_3 \\le 1  (\\text{dual constraint for } x_3) \\\\\n \\pi_1, \\pi_2, \\pi_3 \\ge 0\n\\end{align*}\nTo find the optimal dual variables, we apply the principle of complementary slackness. The relevant condition states that for any optimal primal solution variable $x_p^* > 0$, the corresponding dual constraint must be binding (satisfied with equality). In our case, $x_1^* = \\frac{3}{5} > 0$, $x_2^* = \\frac{1}{2} > 0$, and $x_3^* = 1 > 0$. Thus, all three dual constraints must be tight at the optimum:\n- $5\\pi_1^* = 1 \\implies \\pi_1^* = \\frac{1}{5}$\n- $4\\pi_2^* = 1 \\implies \\pi_2^* = \\frac{1}{4}$\n- $2\\pi_3^* = 1 \\implies \\pi_3^* = \\frac{1}{2}$\nThese values satisfy the non-negativity constraints $\\pi_i^* \\ge 0$. The optimal dual variables, often called simplex multipliers or shadow prices, are $\\pi^* = (\\frac{1}{5}, \\frac{1}{4}, \\frac{1}{2})$.\n\n### Part 2: Pricing Subproblem and Reduced Cost\n\nThe next step in column generation is to find a new pattern that, if added to the RMP, could lead to a better solution. We search for a pattern $p$ with a negative reduced cost, $\\bar{c}_p$. The reduced cost of a pattern $p$ with vector $a_{\\cdot p} = (a_{1p}, a_{2p}, a_{3p})$ is given by:\n$$ \\bar{c}_p = c_p - \\sum_{i=1}^3 \\pi_i^* a_{ip} $$\nwhere $c_p=1$ is the cost of using the pattern (one roll). Using the optimal dual prices, we have:\n$$ \\bar{c}_p = 1 - \\left( \\frac{1}{5}a_{1p} + \\frac{1}{4}a_{2p} + \\frac{1}{2}a_{3p} \\right) $$\nTo find the pattern with the minimum reduced cost, we must find a feasible pattern that maximizes the quantity $\\sum_{i=1}^3 \\pi_i^* a_{ip}$. This is the pricing subproblem. It can be formulated as an integer knapsack problem:\n$$\n\\begin{align*}\n\\text{Maximize} \\quad Z_{sub} =  \\frac{1}{5}a_1 + \\frac{1}{4}a_2 + \\frac{1}{2}a_3 \\\\\n\\text{Subject to} \\quad  3a_1 + 4a_2 + 7a_3 \\le 17 \\\\\n a_1, a_2, a_3 \\in \\mathbb{Z}_{\\ge 0}\n\\end{align*}\nHere, the item sizes $s_i$ are the \"weights,\" the dual prices $\\pi_i^*$ are the \"values,\" and the roll length $L$ is the \"knapsack capacity.\"\n\nWe solve this integer knapsack problem. This can be done using dynamic programming. Let $f(w)$ be the maximum value achievable with a capacity of $w$. We need to compute $f(17)$. The recurrence relation is:\n$$ f(w) = \\max \\left\\{ f(w-3) + \\frac{1}{5}, f(w-4) + \\frac{1}{4}, f(w-7) + \\frac{1}{2} \\right\\} $$\nSolving this systematically, or by inspection for a small problem, we test combinations of items $(a_1, a_2, a_3)$ that satisfy the capacity constraint $3a_1 + 4a_2 + 7a_3 \\le 17$.\n- Pattern $(5,0,0)$: weight $15$, value $5 \\times \\frac{1}{5} = 1$.\n- Pattern $(0,4,0)$: weight $16$, value $4 \\times \\frac{1}{4} = 1$.\n- Pattern $(0,0,2)$: weight $14$, value $2 \\times \\frac{1}{2} = 1$.\n- Pattern $(1,0,2)$: weight $3(1)+7(2) = 17$, value $1 \\times \\frac{1}{5} + 2 \\times \\frac{1}{2} = \\frac{1}{5} + 1 = \\frac{6}{5}$.\n- Pattern $(3,0,1)$: weight $3(3)+7(1) = 16$, value $3 \\times \\frac{1}{5} + 1 \\times \\frac{1}{2} = \\frac{3}{5} + \\frac{1}{2} = \\frac{11}{10}$.\n- Pattern $(2,1,1)$: weight $3(2)+4(1)+7(1) = 6+4+7=17$, value $2 \\times \\frac{1}{5} + 1 \\times \\frac{1}{4} + 1 \\times \\frac{1}{2} = \\frac{2}{5} + \\frac{1}{4} + \\frac{1}{2} = \\frac{8+5+10}{20} = \\frac{23}{20}$.\n- Pattern $(0,2,1)$: weight $4(2)+7(1)=15$, value $2 \\times \\frac{1}{4} + 1 \\times \\frac{1}{2} = \\frac{1}{2}+\\frac{1}{2}=1$.\n\nComparing the values:\n$\\frac{6}{5} = 1.2$\n$\\frac{11}{10} = 1.1$\n$\\frac{23}{20} = 1.15$\n$1$\n\nThe maximum value is $Z_{sub}^* = \\frac{6}{5}$, achieved with the pattern $a^* = (1, 0, 2)$.\n\nFinally, we compute the minimal reduced cost using this maximal value:\n$$ \\bar{c}_{min} = 1 - Z_{sub}^* = 1 - \\frac{6}{5} = \\frac{5}{5} - \\frac{6}{5} = -\\frac{1}{5} $$\nSince the minimal reduced cost is negative, the current LP solution is not optimal for the full (unrestricted) master problem. The pattern $(1,0,2)$ is a candidate to enter the basis in the next iteration of the column generation algorithm. The problem asks only for the value of this minimal reduced cost.",
            "answer": "$$\\boxed{-\\frac{1}{5}}$$"
        }
    ]
}