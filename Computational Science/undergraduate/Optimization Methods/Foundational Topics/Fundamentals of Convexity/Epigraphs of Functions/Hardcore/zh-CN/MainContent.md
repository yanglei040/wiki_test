## 引言
在优化理论的广阔世界中，我们常常面临一个挑战：如何系统性地处理那些在现实世界中无处不在但又难以直接优化的函数，例如[绝对值](@entry_id:147688)、最大值函数或各种范数？这些函数往往是“非光滑”的，在某些点上不可微，这使得传统的[基于梯度的优化](@entry_id:169228)方法难以适用。为了跨越这一障碍，我们需要一种更强大的视角，一种能将函数的代数与分析性质转化为几何直观的工具。函数的**上镜图（epigraph）**正是为此而生的核心概念。

本文将带领读者深入探索上镜图的世界。通过将一个函数及其上方的空间区域视为一个几何对象，上镜图为我们提供了一把解锁复杂[优化问题](@entry_id:266749)的钥匙。我们将看到，许多棘手的非光滑问题都可以通过上镜图的视角，被优雅地重构为我们所熟知的、易于求解的标准问题，如线性规划（LP）或[二阶锥规划](@entry_id:165523)（SOCP）。

在接下来的内容中，我们将分三步展开：首先，在“**原理与机制**”一章中，我们将建立上镜图的正式定义，并揭示其与函数凸性、连续性等核心分析性质之间深刻的[等价关系](@entry_id:138275)。接着，在“**应用与跨学科联系**”一章，我们将通过一系列来自机器学习、统计学和金融工程等领域的实例，展示上镜图作为一种强大建模语言的实际应用。最后，在“**动手实践**”部分，你将有机会通过具体的编程练习，将理论知识转化为解决问题的实用技能。

让我们从最基础的部分开始，深入理解上镜图的定义及其背后的几何与分析原理。

## 原理与机制

在[优化理论](@entry_id:144639)中，将代数与分析概念转化为几何直观是理解和解决问题的关键。函数的 **上镜图（epigraph）** 概念是这一思想的完美体现，它为我们提供了一个强大的框架，用以[连接函数](@entry_id:636388)（如凸性或连续性）的分析性质与其在高维空间中的几何形态。通过将函数本身视为一个几何对象，我们可以利用[凸几何](@entry_id:262845)的强大工具来分析和重构[优化问题](@entry_id:266749)，时常能将复杂或不可微的问题转化为更易于处理的标准形式，例如线性规划。本章将深入探讨上镜图的定义、核心性质及其在现代优化中的关键应用。

### 上镜图：一种几何视角

首先，我们建立上镜图的正式定义。

**定义（上镜图）**：对于一个函数 $f: \mathbb{R}^{n} \to \mathbb{R} \cup \{+\infty\}$，其 **上镜图** 定义为集合 $\operatorname{epi} f$，该集合由 $\mathbb{R}^{n+1}$ 空间中所有位于函数 $f$ 图像上方（或之上）的点 $(x, t)$ 组成。数学上，它表示为：
$$
\operatorname{epi} f = \{(x, t) \in \mathbb{R}^{n} \times \mathbb{R} \mid t \ge f(x)\}
$$
这里，$x \in \mathbb{R}^n$ 是函数的输入变量，$t \in \mathbb{R}$ 是一个辅助的标量变量，代表“高度”。

直观地，如果想象函数 $f$ 的图像是 $\mathbb{R}^{n+1}$ 空间中的一个“[曲面](@entry_id:267450)”，那么它的上镜图就是这个[曲面](@entry_id:267450)以及其上方无限延伸的所有空间区域。例如，对于一维函数 $f(x) = x^2$，其图像是一个抛物线，而其上镜图则是这个抛物线“碗”内部及边缘的所有点。

这个简单的几何构造是[连接函数](@entry_id:636388)分析和[凸几何](@entry_id:262845)的桥梁，其重要性将在下一节中凸显。

### 上镜图与[凸性](@entry_id:138568)

上镜图最重要的应用之一是它为函数[凸性](@entry_id:138568)提供了一种等价的几何描述。

#### 基本[等价关系](@entry_id:138275)

一个函数是[凸函数](@entry_id:143075)，与它的上镜图是凸集，这两种说法是完全等价的。这是一个基础性定理，是[凸分析](@entry_id:273238)的基石。

**定理（[凸性](@entry_id:138568)与上镜图）**：一个函数 $f: \mathbb{R}^{n} \to \mathbb{R} \cup \{+\infty\}$ 是 **凸函数**，当且仅当其上镜图 $\operatorname{epi} f$ 是 $\mathbb{R}^{n+1}$ 空间中的一个 **[凸集](@entry_id:155617)**。

回顾一下，一个集合 $C$ 是凸的，如果对于集合中任意两点 $u, v \in C$，连接这两点的线段上的所有点也都属于 $C$。即，对于所有 $\lambda \in [0, 1]$，点 $\lambda u + (1-\lambda)v$ 仍在 $C$ 中。

将此定义应用于上镜图，设 $(x_1, t_1)$ 和 $(x_2, t_2)$ 是 $\operatorname{epi} f$ 中的任意两点，这意味着 $t_1 \ge f(x_1)$ 和 $t_2 \ge f(x_2)$。如果 $\operatorname{epi} f$ 是[凸集](@entry_id:155617)，那么对于任意 $\lambda \in [0, 1]$，它们的[凸组合](@entry_id:635830) $(\lambda x_1 + (1-\lambda)x_2, \lambda t_1 + (1-\lambda)t_2)$ 也必须在 $\operatorname{epi} f$ 中。这要求：
$$
\lambda t_1 + (1-\lambda)t_2 \ge f(\lambda x_1 + (1-\lambda)x_2)
$$
由于 $t_1 \ge f(x_1)$ 和 $t_2 \ge f(x_2)$，我们有 $\lambda t_1 + (1-\lambda)t_2 \ge \lambda f(x_1) + (1-\lambda)f(x_2)$。为了满足上述条件，函数 $f$ 必须满足：
$$
\lambda f(x_1) + (1-\lambda)f(x_2) \ge f(\lambda x_1 + (1-\lambda)x_2)
$$
这恰好是 **Jensen 不等式**，即凸函数的标准定义。因此，函数的分析定义（Jensen 不等式）和几何定义（上镜图为凸集）是等价的。

#### [凸性](@entry_id:138568)检验

这种几何观点为[检验函数](@entry_id:166589)是否为[凸函数](@entry_id:143075)提供了一种直观的方法。如果我们可以找到上镜图中的两个点，它们的中点位于函数图像的“下方”，那么该函数就不是凸函数。

考虑一个[分段函数](@entry_id:160275) ：
$$
f(x) = \begin{cases}
x^2+1,  x \le 0, \\
x+1,  0  x \le 2, \\
3,  x > 2.
\end{cases}
$$
虽然该函数的每个分段（抛物线、直线、常数）本身都是凸的，并且函数在连接点 $x=0$ 和 $x=2$ 处是连续的，但这并不足以保证整个函数是凸的。我们可以通过检验其上镜图来判断。

我们选取两个位于函数图像上的点，例如 $z_1 = (1.5, f(1.5)) = (1.5, 2.5)$ 和 $z_2 = (3, f(3)) = (3, 3)$。这两个点显然位于 $\operatorname{epi} f$ 的边界上。它们的几何中点是：
$$
z_{0.5} = 0.5 z_1 + 0.5 z_2 = (0.5 \cdot 1.5 + 0.5 \cdot 3, 0.5 \cdot 2.5 + 0.5 \cdot 3) = (2.25, 2.75)
$$
令中点为 $(x_m, t_m) = (2.25, 2.75)$。为了使该点位于上镜图中，必须满足 $t_m \ge f(x_m)$。我们计算 $f(x_m) = f(2.25)$。由于 $2.25 > 2$，根据函数定义，$f(2.25) = 3$。
检验条件为 $2.75 \ge 3$，这显然是错误的。由于连接 $\operatorname{epi} f$ 中两点 $z_1$ 和 $z_2$ 的线段的中点 $z_{0.5}$ 不在 $\operatorname{epi} f$ 中，$\operatorname{epi} f$ 不是一个凸集。因此，函数 $f$ 不是一个[凸函数](@entry_id:143075)。

#### 二次函数的[凸性](@entry_id:138568)

对于在优化中至关重要的二次函数 $q(x) = \frac{1}{2} x^\top H x + g^\top x + c$，其[凸性](@entry_id:138568)完全由其 Hessian 矩阵 $H$（在此为常数矩阵）的性质决定。

**定理**：二次函数 $q(x)$ 是凸函数（即其上镜图 $\operatorname{epi} q$ 是凸集），当且仅当其 Hessian 矩阵 $H$ 是 **半正定（positive semidefinite）** 的 。

一个对称矩阵 $H$ 是半正定的，意味着对于所有向量 $z \in \mathbb{R}^n$，都有 $z^\top H z \ge 0$。这个条件描述了函数图像的曲率。如果 $H$ 是半正定的，那么函数在任何方向上都“向上弯曲”或“是平的”，这正是[凸性](@entry_id:138568)的几何本质。线性项 $g^\top x$ 和常数项 $c$ 分别对应于对上镜图进行剪切（shearing）和平移，这些变换保持集合的凸性。因此，它们不[影响函数](@entry_id:168646)的[凸性](@entry_id:138568)。

此外，还有一个更强的结论：函数 $q(x)$ 是 **严格凸** 的（即 Jensen 不等式中的不等号对于不同的点总是严格成立），当且仅当 $H$ 是 **正定（positive definite）** 的（即对于所有非[零向量](@entry_id:156189) $z$，都有 $z^\top H z > 0$）。几何上，这意味着 $\operatorname{epi} q$ 是一个 **严格凸集** 。

### 上镜图在优化中的应用

上镜图不仅是一个理论工具，更是一种强大的实践技术，尤其是在算法设计中，它能够将非[标准形式](@entry_id:153058)的[优化问题](@entry_id:266749)转化为易于求解的标准形式。

#### 上镜图重构原理

核心思想是将一个目标函数 $f(x)$ 的最小化问题
$$
\min_{x \in \mathcal{C}} f(x)
$$
等价地重构为一个在更高维空间中的问题。通过引入一个辅助变量 $t$，原问题可以被写成：
$$
\min_{x \in \mathcal{C}, t \in \mathbb{R}} t \quad \text{subject to} \quad t \ge f(x)
$$
约束 $t \ge f(x)$（结合 $x \in \mathcal{C}$）精确地定义了 $f$ 在可行域 $\mathcal{C}$ 上的上镜图。因此，这个问题等价于在函数的上镜图中寻找具有最小高度 $t$ 的点。

这个“上镜图技巧”的威力在于，它将最小化一个可能复杂的、[非线性](@entry_id:637147)的、甚至不可微的函数 $f(x)$ 的任务，转变为最小化一个简单的 **线性函数** $t$ 的任务，代价是增加了一个（可能复杂的）约束。如果这个新约束 $t \ge f(x)$ 能够被表达为一组简单的约束（例如[线性不等式](@entry_id:174297)），那么问题就变得更加 tractable。

#### 应用：极小化极大值问题与[线性规划](@entry_id:138188)

一个经典的应用场景是处理形如 $f(x) = \max_{i \in \{1,\dots,m\}} (a_i^\top x + b_i)$ 的函数，即一组[仿射函数](@entry_id:635019)的逐点最大值。这类函数是凸的但通常在最大值切换点处不可微。直接使用[基于梯度的方法](@entry_id:749986)会遇到困难。

通过上镜图重构，最小化 $f(x)$ 的问题 $\min_{x \in \mathcal{C}} f(x)$ 变为  ：
$$
\min_{x \in \mathcal{C}, t \in \mathbb{R}} t \quad \text{subject to} \quad t \ge \max_{i \in \{1,\dots,m\}} (a_i^\top x + b_i)
$$
关键的一步是，不等式 $t \ge \max(\dots)$ 等价于一系列独立的、更简单的不等式：
$$
t \ge a_i^\top x + b_i \quad \text{for all } i \in \{1, \dots, m\}
$$
这样，原始的[非光滑优化](@entry_id:167581)问题就等价地转化为了：
$$
\min_{x, t} t \quad \text{subject to} \quad x \in \mathcal{C} \text{ and } a_i^\top x - t + b_i \le 0 \text{ for } i=1,\dots,m
$$
如果原始[可行域](@entry_id:136622) $\mathcal{C}$ 是由[线性不等式](@entry_id:174297)描述的[多面体](@entry_id:637910)，那么这个新问题就是一个 **线性规划（Linear Program, LP）** 问题。它的[目标函数](@entry_id:267263) $(t)$ 和所有约束都是线性的。这具有巨大的实践意义，因为[线性规划](@entry_id:138188)是优化领域中研究最透彻、求解器最成熟和高效的分支之一 。

#### 应用：[L1范数最小化](@entry_id:751086)

另一个重要的例子是 $L_1$ 范数最小化，也称为[最小绝对偏差](@entry_id:175855)回归，其[目标函数](@entry_id:267263)为 $\sum_{i=1}^m |a_i^\top x - b_i|$。[绝对值函数](@entry_id:160606) $|z|$ 是[非线性](@entry_id:637147)的，并且在 $z=0$ 处不可微。

我们可以对求和中的每一项应用上镜图思想。引入辅助变量 $t_i$ 来“捕获”每一项的[绝对值](@entry_id:147688) 。原问题
$$
\min_x \sum_{i=1}^m |a_i^\top x - b_i|
$$
可以被重构为：
$$
\min_{x, t_1, \dots, t_m} \sum_{i=1}^m t_i \quad \text{subject to} \quad t_i \ge |a_i^\top x - b_i| \text{ for } i=1, \dots, m
$$
在最优点，不等式必定取等，否则我们可以减小某个 $t_i$ 来得到更优的目标值。现在，我们处理约束 $t_i \ge |a_i^\top x - b_i|$。一个值大于等于另一个值的[绝对值](@entry_id:147688)，等价于它同时大于等于该值本身及其相反数。因此，每个非[线性约束](@entry_id:636966)可以分解为两个 **线性约束**：
$$
t_i \ge a_i^\top x - b_i \quad \text{and} \quad t_i \ge -(a_i^\top x - b_i)
$$
这两种形式，即 $t_i \ge \pm(a_i^\top x - b_i)$ 或紧凑形式 $-t_i \le a_i^\top x - b_i \le t_i$，都是等价的[线性表示](@entry_id:139970) 。最终，我们得到了一个拥有线性目标函数和线性约束的 LP 问题，可以被高效求解。

此外，还有一种等价的LP形式，即引入非负变量 $u_i, v_i \ge 0$ 来表示每个残差的正部和负部：$a_i^\top x - b_i = u_i - v_i$。在这种情况下，[绝对值](@entry_id:147688) $|a_i^\top x - b_i|$ 等于 $u_i + v_i$（在目标函数 $\min \sum(u_i+v_i)$ 的驱动下， $u_i$ 和 $v_i$ 中至少有一个会是零）。这同样将问题转化为了一个 LP 。

### 上镜图的几何与性质

深入研究上镜图的几何形态，可以揭示函数本身更深层次的结构。

#### 范数的上镜图

范数是[向量空间](@entry_id:151108)中长度的基本度量，它们的上镜图是被称为 **锥（cone）** 的重要几何对象。一个集合 $K$ 是一个锥，如果对于任意 $z \in K$ 和任意非负标量 $\lambda \ge 0$，点 $\lambda z$ 仍然在 $K$ 中。所有范数的上镜图都是[凸锥](@entry_id:635652)。

考虑 $\mathbb{R}^n$ 中的三种常见范数 ：
1.  **[无穷范数](@entry_id:637586) ($L_\infty$-norm)**: $f(x) = \|x\|_\infty = \max_{i=1,\dots,n} |x_i|$。
    其上镜图 $\operatorname{epi}(\|\cdot\|_\infty)$ 由不等式 $\max_i |x_i| \le t$ 定义。这等价于 $2n$ 个[线性不等式](@entry_id:174297)：$-t \le x_i \le t$ 对于所有 $i=1,\dots,n$。由于它是由有限个[线性不等式](@entry_id:174297)定义的，它是一个 **[多面体](@entry_id:637910)锥（polyhedral cone）**。

2.  **$L_1$-范数**: $f(x) = \|x\|_1 = \sum_{i=1}^n |x_i|$。
    其上镜图 $\operatorname{epi}(\|\cdot\|_1)$ 由不等式 $\sum_i |x_i| \le t$ 定义。通过考虑 $x_i$ 的所有 $2^n$ 种符号组合，这个不等式可以被表示为 $2^n$ 个[线性不等式](@entry_id:174297)的交集，形式为 $s^\top x \le t$，其中 $s$ 是由 $\pm 1$ 组成的向量。因此，它也是一个 **多面体锥**。

3.  **$L_2$-范数 (欧几里得范数)**: $f(x) = \|x\|_2 = \sqrt{\sum_{i=1}^n x_i^2}$。
    其上镜图 $\operatorname{epi}(\|\cdot\|_2)$ 由不等式 $\|x\|_2 \le t$ 定义。这个集合在 $\mathbb{R}^{n+1}$ 中被称为 **[二阶锥](@entry_id:637114)（Second-Order Cone, SOC）** 或[洛伦兹锥](@entry_id:637114)。这个不等式是[非线性](@entry_id:637147)的，不能用有限个[线性不等式](@entry_id:174297)来表达，因此它是一个 **非多面体** 的[凸锥](@entry_id:635652)。

#### 集合包含关系与范数不等式

范数之间的大小关系与它们的上镜图的包含关系之间存在一种优美的对偶性。具体而言：
$$
\|x\|_b \le \|x\|_a \text{ for all } x \in \mathbb{R}^n \iff \operatorname{epi}(\|\cdot\|_a) \subseteq \operatorname{epi}(\|\cdot\|_b)
$$
这个结论的证明很简单：如果 $\operatorname{epi}(\|\cdot\|_a) \subseteq \operatorname{epi}(\|\cdot\|_b)$，那么对于任意 $x$，点 $(x, \|x\|_a)$ 属于 $\operatorname{epi}(\|\cdot\|_a)$，因此也必须属于 $\operatorname{epi}(\|\cdot\|_b)$，这意味着 $\|x\|_b \le \|x\|_a$。反之亦然。

对于 $\mathbb{R}^n$ 中的向量，著名的范数不等式链是：
$$
\|x\|_\infty \le \|x\|_2 \le \|x\|_1
$$
根据上述对偶关系，这直接对应于上镜图的 **反向** 包含关系 ：
$$
\operatorname{epi}(\|\cdot\|_1) \subseteq \operatorname{epi}(\|\cdot\|_2) \subseteq \operatorname{epi}(\|\cdot\|_\infty)
$$
这提供了一个几何图像：$L_1$ 范数的上镜图是最“尖锐”的锥，而 $L_\infty$ 范数的上镜图是最“宽广”的锥，$L_2$ 范数的上镜图则介于两者之间。例如，我们可以精确地量化这种包含关系。从不等式 $\|x\|_2 \le \sqrt{n} \|x\|_\infty$ 可知，如果将 $\operatorname{epi}(\|\cdot\|_\infty)$ 中的点 $(x,t)$ 的垂直坐标 $t$ 放大 $\sqrt{n}$ 倍，那么新的点 $(x, \sqrt{n}t)$ 一定位于 $\operatorname{epi}(\|\cdot\|_2)$ 中 。

#### [次梯度](@entry_id:142710)作为[支撑超平面](@entry_id:274981)

对于在某点不可微的凸函数，次梯度（subgradient）的概念推广了导数。[次梯度](@entry_id:142710)与上镜图的几何关系极为密切：它定义了上镜图的一个 **[支撑超平面](@entry_id:274981)（supporting hyperplane）**。

一个向量 $g$ 是 $f$ 在点 $x_0$ 的次梯度，如果对于所有 $x$，都满足以下 **[次梯度](@entry_id:142710)不等式**：
$$
f(x) \ge f(x_0) + g^\top(x - x_0)
$$
现在考虑上镜图 $\operatorname{epi} f$ 中的任意一点 $(x,t)$。根据定义，$t \ge f(x)$。将这两个不等式结合，我们得到：
$$
t \ge f(x) \ge f(x_0) + g^\top(x - x_0)
$$
通过移项，我们可以得到一个关于变量 $(x, t)$ 的[线性不等式](@entry_id:174297)：
$$
g^\top x - t \le g^\top x_0 - f(x_0)
$$
这个不等式定义了 $\mathbb{R}^{n+1}$ 中的一个半空间。它表明整个上镜图 $\operatorname{epi} f$ 都位于由[法向量](@entry_id:264185) $(g, -1)$ 和截距 $b = g^\top x_0 - f(x_0)$ 定义的超平面的一侧。这个[超平面](@entry_id:268044) $g^\top x - t = b$ 就是 $\operatorname{epi} f$ 在点 $(x_0, f(x_0))$ 处的一个[支撑超平面](@entry_id:274981)。

例如，考虑函数 $f(x) = \|x\|_2$ 在点 $x_0=(3,4)$ 的情况 。我们有 $f(x_0) = \sqrt{3^2+4^2} = 5$。对于 $x_0 \neq 0$，$f(x)$ 是可微的，其唯一的[次梯度](@entry_id:142710)（即梯度）是 $g = \frac{x_0}{\|x_0\|_2} = (\frac{3}{5}, \frac{4}{5})$。
根据上述推导，[支撑超平面](@entry_id:274981)的[法向量](@entry_id:264185)为 $(g, -1) = (\frac{3}{5}, \frac{4}{5}, -1)$，截距为 $b = g^\top x_0 - f(x_0) = (\frac{3}{5}\cdot3 + \frac{4}{5}\cdot4) - 5 = 5-5=0$。因此，[支撑超平面](@entry_id:274981)的方程是：
$$
\frac{3}{5}x_1 + \frac{4}{5}x_2 - t = 0
$$
这个平面通过点 $(x_0, f(x_0)) = (3,4,5)$，并且整个[二阶锥](@entry_id:637114) $\operatorname{epi}(\|\cdot\|_2)$ 都位于其定义的[半空间](@entry_id:634770) $\frac{3}{5}x_1 + \frac{4}{5}x_2 - t \le 0$ 中。

### [拓扑性质](@entry_id:141605)与变换

最后，我们讨论上镜图的拓扑性质及其在[函数变换](@entry_id:141095)下的行为。

#### [闭包](@entry_id:148169)性与下半连续性

在分析中，[函数的连续性](@entry_id:193744)是一个核心概念。在优化理论中，一个更宽泛且同样重要的概念是 **下半连续性（lower semicontinuity, l.s.c.）**。一个函数 $f$ 在点 $x_0$ 是下半连续的，如果对于任何收敛到 $x_0$ 的序列 $x_k \to x_0$，都有 $f(x_0) \le \liminf_{k\to\infty} f(x_k)$。直观上，这意味着函数的值不会在[极限点](@entry_id:177089)处突然“跳跃”到一个更低的值。

下半连续性与上镜图的[拓扑性质](@entry_id:141605)——[闭包](@entry_id:148169)性，有着直接的[等价关系](@entry_id:138275)。

**定理**：一个函数 $f$ 在其定义域上是下半连续的，当且仅当其上镜图 $\operatorname{epi} f$ 是一个 **[闭集](@entry_id:136446)**。

一个[闭集](@entry_id:136446)包含其所有的[极限点](@entry_id:177089)。如果一个函数的上镜图不是[闭集](@entry_id:136446)，那么就存在一系列点 $(x_k, t_k) \in \operatorname{epi} f$ 收敛到一个极限点 $(x_0, t_0)$，但该[极限点](@entry_id:177089)本身不在 $\operatorname{epi} f$ 中。这通常发生在函数不是下半连续的地方。

考虑一个经典的例子 ：
$$
f(x) = \begin{cases} 1  \text{if } x=0 \\ 0  \text{if } x \neq 0 \end{cases}
$$
在 $x_0=0$ 处，$f(0)=1$。但我们可以取序列 $x_k = 1/k \to 0$，其函数值为 $f(x_k)=0$。因此，$\liminf f(x_k) = 0$，我们有 $f(0) > \liminf f(x_k)$，所以函数在 $x=0$ 处不是下半连续的。

相应地，其上镜图也不是[闭集](@entry_id:136446)。考虑序列 $(x_k, t_k)=(1/k, 0)$。因为 $t_k=0 \ge f(x_k)=0$，所以这些点都在 $\operatorname{epi} f$ 中。当 $k \to \infty$ 时，这个[序列收敛](@entry_id:143579)到[极限点](@entry_id:177089) $(0,0)$。然而，点 $(0,0)$ 并不在 $\operatorname{epi} f$ 中，因为条件 $t \ge f(x)$ 在此变为 $0 \ge f(0)=1$，这是不成立的 。因为 $\operatorname{epi} f$ 缺少了它的一个[极限点](@entry_id:177089)，所以它不是[闭集](@entry_id:136446)。

一个相关概念是 **下半连续包（l.s.c. envelope）**，记为 $\mathrm{cl} f$。它的上镜图恰好是原函数上镜[图的闭包](@entry_id:269136)，即 $\operatorname{epi}(\mathrm{cl} f) = \overline{\operatorname{epi} f}$。对于上面的例子，$\mathrm{cl} f(x) = 0$ 对所有 $x$ 成立，其上镜图是[闭集](@entry_id:136446) $\mathbb{R} \times [0, \infty)$。

#### 上镜图的变换

当一个函数 $f$ 经过[仿射变换](@entry_id:144885)（[线性变换](@entry_id:149133)加平移）时，其上镜图也会相应地进行[几何变换](@entry_id:150649)。考虑函数 $g(x) = a f(Bx) + c$，其中 $B$ 是一个矩阵，$a, c$ 是标量。我们可以推导出 $\operatorname{epi} g$ 与 $\operatorname{epi} f$ 之间的关系 。

根据定义，$(x, t) \in \operatorname{epi} g$ 当且仅当 $t \ge a f(Bx) + c$。我们通过整理这个不等式来建立联系，这需要根据 $a$ 的符号分情况讨论。

- **情况 1: $a > 0$**
  不等式变为 $\frac{t-c}{a} \ge f(Bx)$。令 $y=Bx$ 和 $s=\frac{t-c}{a}$，我们得到 $s \ge f(y)$。这正是 $(y,s) \in \operatorname{epi} f$ 的条件。因此，$\operatorname{epi} g$ 是通过对 $\operatorname{epi} f$ 中的点 $(y,s)$ 进行[仿射变换](@entry_id:144885)得到的：
  $$
  \operatorname{epi} g = \left\{ (x, t) \in \mathbb{R}^n \times \mathbb{R} \mid \left(Bx, \frac{t-c}{a}\right) \in \operatorname{epi} f \right\}
  $$

- **情况 2: $a = 0$**
  函数变为[常数函数](@entry_id:152060) $g(x) = c$。其上镜图是一个半空间，与 $f$ 无关：
  $$
  \operatorname{epi} g = \{ (x,t) \in \mathbb{R}^n \times \mathbb{R} \mid t \ge c \}
  $$

- **情况 3: $a  0$**
  此时，除以 $a$ 会反转不等号：$\frac{t-c}{a} \le f(Bx)$。这定义了函数 $f$ 的 **亚图（hypograph）**。为了回到上镜图的框架，我们对不等式两边取负：$\frac{c-t}{a} \ge -f(Bx)$。令 $-f$ 表示函数 $y \mapsto -f(y)$，则该条件意味着点 $(Bx, \frac{c-t}{a})$ 位于函数 $-f$ 的上镜图中。
  $$
  \operatorname{epi} g = \left\{ (x, t) \in \mathbb{R}^n \times \mathbb{R} \mid \left(Bx, \frac{c-t}{a}\right) \in \operatorname{epi}(-f) \right\}
  $$
  这里我们看到，当乘以一个负数时，原函数的上镜图与新函数的上镜图之间的关系是通过“翻转”的函数 $-f$ 来建立的。

通过以上讨论，我们看到上镜图不仅是一个抽象的定义，更是一个贯穿[凸分析](@entry_id:273238)和优化的核心工具，它将函数的代数和分析性质与高维空间的几何直观紧密联系在一起，为理论理解和算法设计提供了深刻的洞察力。