{
    "hands_on_practices": [
        {
            "introduction": "我们从最熟悉的范数——$L_2$ 范数（或欧几里得范数）开始。这个练习将引导你证明其一个优美的性质：自对偶性，这一概念与柯西-施瓦茨不等式直接相关。理解这个特例将为你探索其他范数对打下坚实的基础。",
            "id": "977935",
            "problem": "考虑向量空间 $\\mathbb{R}^2$，其配备了标准内积 $\\langle \\mathbf{x}, \\mathbf{y} \\rangle = x_1 y_1 + x_2 y_2$。向量 $\\mathbf{x} = (x_1, x_2)$ 的 $L_2$ 范数定义为 $\\|\\mathbf{x}\\|_2 = \\sqrt{x_1^2 + x_2^2}$。关于 $L_2$ 范数，向量 $\\mathbf{z} \\in \\mathbb{R}^2$ 的对偶范数由下式给出：\n\n$$\n\\|\\mathbf{z}\\|_* = \\sup \\left\\{ \\langle \\mathbf{z}, \\mathbf{x} \\rangle \\mid \\|\\mathbf{x}\\|_2 \\leq 1 \\right\\}.\n$$\n\n计算向量 $\\mathbf{z} = (1, 1)$ 的对偶范数。",
            "solution": "1. 对偶范数定义为\n$$\n\\|\\mathbf{z}\\|_* = \\sup_{\\|\\mathbf{x}\\|_2 \\le 1} \\langle \\mathbf{z}, \\mathbf{x} \\rangle.\n$$\n2. 根据柯西-施瓦茨不等式，\n$$\n\\langle \\mathbf{z}, \\mathbf{x} \\rangle \\le \\|\\mathbf{z}\\|_2 \\,\\|\\mathbf{x}\\|_2 \\le \\|\\mathbf{z}\\|_2.\n$$\n因此，当 $\\mathbf{x}$ 与 $\\mathbf{z}$ 方向相同时，达到上确界，其值为 $\\|\\mathbf{z}\\|_2$。\n3. 对于 $\\mathbf{z}=(1,1)$，\n$$\n\\|\\mathbf{z}\\|_2 = \\sqrt{1^2 + 1^2} = \\sqrt{2}.\n$$\n因此，\n$$\n\\|\\mathbf{z}\\|_* = \\sqrt{2}.\n$$",
            "answer": "$$\\boxed{\\sqrt{2}}$$"
        },
        {
            "introduction": "在了解了 $L_2$ 范数的对称情况后，我们转向 $L_1$ 范数和 $L_\\infty$ 范数之间的不对称关系。这个练习将展示在非自对偶情况下如何计算对偶范数，并揭示优化与数据科学中最重要的对偶范数对之一。",
            "id": "977759",
            "problem": "计算 $\\mathbb{R}^2$ 中向量 $\\mathbf{z} = (3, 4)$ 关于 $L^1$ 范数的对偶范数。向量 $\\mathbf{z}$ 的对偶范数定义为\n\n$$\n\\|\\mathbf{z}\\|_* = \\sup \\left\\{ \\left| \\langle \\mathbf{z}, \\mathbf{x} \\rangle \\right| : \\|\\mathbf{x}\\|_1 \\leq 1 \\right\\},\n$$\n\n其中，对于 $\\mathbf{x} = (x_1, x_2)$，$\\langle \\mathbf{z}, \\mathbf{x} \\rangle = 3x_1 + 4x_2$ 且 $\\|\\mathbf{x}\\|_1 = |x_1| + |x_2|$。",
            "solution": "我们要求\n$$\\|\\mathbf z\\|_*=\\sup_{\\|\\mathbf x\\|_1\\le1}|\\langle\\mathbf z,\\mathbf x\\rangle|\n=\\sup_{|x_1|+|x_2|\\le1}|3x_1+4x_2|.$$\n根据定义，$L^1$ 范数的对偶是 $L^\\infty$ 范数，所以\n$$\\|\\mathbf z\\|_*=\\|\\mathbf z\\|_\\infty=\\max\\{|3|,|4|\\}=4.$$\n另外，可以设 $x_1=\\alpha\\,\\mathrm{sign}(3)$，$x_2=(1-\\alpha)\\,\\mathrm{sign}(4)$，其中 $\\alpha\\in[0,1]$。那么\n$$3x_1+4x_2=3\\alpha+4(1-\\alpha)=4-(4-3)\\alpha=4-\\alpha,$$\n其在 $\\alpha\\in[0,1]$ 上的最大值是 $4$。\n因此 $\\|\\mathbf z\\|_*=4\\,.$",
            "answer": "$$\\boxed{4}$$"
        },
        {
            "introduction": "现在，让我们从纯粹的计算过渡到优化中的一个实际应用。这个问题探讨了欧几里得投影到一个范数球上的概念，这是许多算法中的基本操作。通过推导到 $L_\\infty$ 球上的投影，我们将看到 $L_1$ 和 $L_\\infty$ 范数之间对偶关系的一个具体几何意义。",
            "id": "3197835",
            "problem": "设 $n \\in \\mathbb{N}$，考虑将向量 $\\boldsymbol{v} \\in \\mathbb{R}^{n}$ 欧几里得投影到闭凸集 $\\mathcal{C}_{\\infty}(\\tau) \\coloneqq \\{\\boldsymbol{x} \\in \\mathbb{R}^{n} : \\|\\boldsymbol{x}\\|_{\\infty} \\le \\tau\\}$ 上，其中 $\\tau  0$ 且 $\\|\\cdot\\|_{\\infty}$ 表示 $\\ell_{\\infty}$ 范数。仅从欧几里得投影到非空闭凸集上的定义以及对偶范数的定义出发，完成以下任务：\n\n1) 通过直接求解其定义的优化问题，推导欧几里得投影 $\\Pi_{\\mathcal{C}_{\\infty}(\\tau)}(\\boldsymbol{v})$ 的结构。在您的推导中，确定该解是否可以表示为逐坐标运算，并使用凸优化的基本原理证明您的结论。\n\n2) 解释 $\\mathcal{C}_{\\infty}(\\tau)$ 如何与 $\\ell_{1}$ 范数的对偶球相关，明确指出 $\\|\\cdot\\|_{1}$ 的对偶范数及相关的对偶球。\n\n3) 将您的结果应用于具体数据 $\\boldsymbol{v} = (\\,3.1,\\,-2.4,\\,1.8,\\,-0.9,\\,2.0,\\,-4.6\\,) \\in \\mathbb{R}^{6}$ 和 $\\tau = 2$，计算唯一的欧几里得投影 $\\Pi_{\\mathcal{C}_{\\infty}(2)}(\\boldsymbol{v})$。\n\n提供最终的投影向量作为您的答案。您无需四舍五入；给出精确值。",
            "solution": "首先对用户提供的问题进行严格的验证过程。\n\n### 步骤 1：提取已知条件\n- 一个自然数 $n \\in \\mathbb{N}$。\n- 一个向量 $\\boldsymbol{v} \\in \\mathbb{R}^{n}$。\n- 一个闭凸集 $\\mathcal{C}_{\\infty}(\\tau) \\coloneqq \\{\\boldsymbol{x} \\in \\mathbb{R}^{n} : \\|\\boldsymbol{x}\\|_{\\infty} \\le \\tau\\}$。\n- 一个正标量 $\\tau  0$。\n- 范数 $\\|\\cdot\\|_{\\infty}$ 是 $\\ell_{\\infty}$ 范数。\n- 任务包含三个部分：\n    1) 通过求解定义的优化问题推导欧几里得投影 $\\Pi_{\\mathcal{C}_{\\infty}(\\tau)}(\\boldsymbol{v})$，并确定该运算是否为逐坐标运算。\n    2) 解释 $\\mathcal{C}_{\\infty}(\\tau)$ 与 $\\ell_{1}$ 范数的对偶球之间的关系。\n    3) 应用结果计算 $\\boldsymbol{v} = (\\,3.1,\\,-2.4,\\,1.8,\\,-0.9,\\,2.0,\\,-4.6\\,) \\in \\mathbb{R}^{6}$ 和 $\\tau = 2$ 的投影。\n\n### 步骤 2：使用提取的已知条件进行验证\n根据科学和数学原理评估问题的有效性。\n- **科学基础：** 该问题设置在凸分析与优化这一成熟的数学领域内。范数（$\\ell_{\\infty}$、$\\ell_{1}$）、对偶范数、凸集和欧几里得投影等概念都是标准的且有严格定义。\n- **适定性：** 集合 $\\mathcal{C}_{\\infty}(\\tau)$ 是一个以原点为中心的超立方体，是 $\\mathbb{R}^{n}$ 的一个非空、闭、凸子集。根据投影到凸集上的理论，对于任何点 $\\boldsymbol{v} \\in \\mathbb{R}^{n}$，在 $\\mathcal{C}_{\\infty}(\\tau)$ 中存在一个唯一的点，在欧几里得意义下与 $\\boldsymbol{v}$ 最接近。推导和计算所需的所有信息均已提供。\n- **客观性：** 问题以精确、无歧义的数学语言陈述。\n\n### 步骤 3：结论与行动\n该问题是**有效的**。这是一个标准的、适定的凸优化问题，没有科学缺陷、矛盾或歧义。可以继续进行求解过程。\n\n---\n\n### 第 1 部分：投影算子的推导\n\n将向量 $\\boldsymbol{v} \\in \\mathbb{R}^{n}$ 欧几里得投影到非空闭凸集 $\\mathcal{C}$ 上，定义为在 $\\mathcal{C}$ 中唯一能最小化与 $\\boldsymbol{v}$ 的欧几里得距离的向量 $\\boldsymbol{x}^*$。这等价于最小化差值的欧几里得范数的平方，这是一个严格凸优化问题。令 $\\boldsymbol{x}^* = \\Pi_{\\mathcal{C}_{\\infty}(\\tau)}(\\boldsymbol{v})$。那么 $\\boldsymbol{x}^*$ 是以下问题的解：\n$$\n\\boldsymbol{x}^* = \\arg\\min_{\\boldsymbol{x} \\in \\mathcal{C}_{\\infty}(\\tau)} \\frac{1}{2} \\|\\boldsymbol{x} - \\boldsymbol{v}\\|_{2}^{2}\n$$\n目标函数为 $f(\\boldsymbol{x}) = \\frac{1}{2} \\|\\boldsymbol{x} - \\boldsymbol{v}\\|_{2}^{2} = \\frac{1}{2} \\sum_{i=1}^{n} (x_i - v_i)^2$。约束集为 $\\mathcal{C}_{\\infty}(\\tau) = \\{\\boldsymbol{x} \\in \\mathbb{R}^{n} : \\|\\boldsymbol{x}\\|_{\\infty} \\le \\tau\\}$。根据 $\\ell_{\\infty}$-范数的定义，$\\|\\boldsymbol{x}\\|_{\\infty} = \\max_{i=1, \\dots, n} |x_i|$。因此，约束 $\\|\\boldsymbol{x}\\|_{\\infty} \\le \\tau$ 等价于对每个 $i \\in \\{1, \\dots, n\\}$ 的 $n$ 个独立约束 $|x_i| \\le \\tau$。这可以写成 $-\\tau \\le x_i \\le \\tau$。\n\n因此，优化问题为：\n$$\n\\begin{array}{ll}\n\\text{最小化}  \\frac{1}{2} \\sum_{i=1}^{n} (x_i - v_i)^2 \\\\\n\\text{约束于}  -\\tau \\le x_i \\le \\tau, \\quad \\text{对于 } i = 1, \\dots, n\n\\end{array}\n$$\n目标函数是各项之和，其中每一项仅依赖于单个变量 $x_i$。约束也是解耦的，独立地应用于每个坐标 $x_i$。这种可分性意味着这个 $n$ 维优化问题可以分解为 $n$ 个独立的一维优化问题：\n$$\n\\text{对于每个 } i \\in \\{1, \\dots, n\\}, \\quad \\text{求解: } \\quad\n\\begin{array}{ll}\n\\text{最小化}  \\frac{1}{2} (x_i - v_i)^2 \\\\\n\\text{约束于}  x_i \\in [-\\tau, \\tau]\n\\end{array}\n$$\n$\\frac{1}{2} (x_i - v_i)^2$ 的无约束最小化子是 $x_i = v_i$。\n- 如果 $v_i$ 位于可行区间 $[-\\tau, \\tau]$ 内（即 $|v_i| \\le \\tau$），则唯一解是 $x_i^* = v_i$。\n- 如果 $v_i  \\tau$，则二次函数在区间 $[-\\tau, \\tau]$ 上的最小值在最接近 $v_i$ 的端点处取得，即 $x_i^* = \\tau$。\n- 如果 $v_i  -\\tau$，则最小值在另一个端点处取得，即 $x_i^* = -\\tau$。\n\n这三种情况可以紧凑地表示为将标量 $v_i$ 投影到区间 $[-\\tau, \\tau]$ 上。每个分量的解是：\n$$\nx_i^* = \\begin{cases}\n\\tau  \\text{如果 } v_i  \\tau \\\\\nv_i  \\text{如果 } -\\tau \\le v_i \\le \\tau \\\\\n-\\tau  \\text{如果 } v_i  -\\tau\n\\end{cases}\n$$\n该运算也称为裁剪或饱和，可以写成 $x_i^* = \\text{median}(-\\tau, v_i, \\tau)$ 或 $x_i^* = \\text{sign}(v_i) \\min(|v_i|, \\tau)$。\n\n投影 $\\Pi_{\\mathcal{C}_{\\infty}(\\tau)}(\\boldsymbol{v})$ 的结构是逐坐标运算。这是目标函数（欧几里得范数的平方）和约束集（与坐标轴对齐的超立方体）都具有可分性的直接结果。根据凸优化的基本原理，因为该问题可以分解为关于每个坐标的独立子问题，所以总的解就是这些子问题解的向量。\n\n### 第 2 部分：与 $\\|\\cdot\\|_1$ 的对偶范数的关系\n\n$\\mathbb{R}^n$ 上范数 $\\|\\cdot\\|$ 的对偶范数 $\\|\\cdot\\|_*$ 定义为\n$$\n\\|\\boldsymbol{z}\\|_* \\coloneqq \\sup_{\\|\\boldsymbol{x}\\| \\le 1} \\boldsymbol{z}^{\\top}\\boldsymbol{x}\n$$\n我们寻求 $\\ell_1$-范数 $\\|\\cdot\\|_1 = \\sum_{i=1}^n |x_i|$ 的对偶范数。令 $\\|\\cdot\\| = \\|\\cdot\\|_1$。其对偶范数为：\n$$\n\\|\\boldsymbol{z}\\|_* = \\sup_{\\|\\boldsymbol{x}\\|_1 \\le 1} \\sum_{i=1}^n z_i x_i\n$$\n为了在约束 $\\sum_i |x_i| \\le 1$ 下最大化 $\\sum_i z_i x_i$，我们应该将向量 $\\boldsymbol{x}$ 与 $\\boldsymbol{z}$ 中具有最大幅值的分量对齐。令 $k = \\arg\\max_{i} |z_i|$，因此 $|z_k| = \\|\\boldsymbol{z}\\|_{\\infty}$。我们构造一个向量 $\\boldsymbol{x}$，其中 $x_k = \\text{sign}(z_k)$ 且对于所有 $i \\neq k$，$x_i = 0$。该向量满足约束 $\\|\\boldsymbol{x}\\|_1 = |\\text{sign}(z_k)| = 1$。对于这个 $\\boldsymbol{x}$ 的选择，内积为 $\\boldsymbol{z}^{\\top}\\boldsymbol{x} = z_k x_k = z_k \\text{sign}(z_k) = |z_k| = \\|\\boldsymbol{z}\\|_{\\infty}$。\n\n根据 $\\ell_p$-范数的 Hölder 不等式，有 $|\\boldsymbol{z}^{\\top}\\boldsymbol{x}| \\le \\|\\boldsymbol{z}\\|_q \\|\\boldsymbol{x}\\|_p$，其中 $\\frac{1}{p} + \\frac{1}{q} = 1$。对于 $p=1$，我们有 $q=\\infty$。因此，对于任何满足 $\\|\\boldsymbol{x}\\|_1 \\le 1$ 的 $\\boldsymbol{x}$：\n$$\n\\boldsymbol{z}^{\\top}\\boldsymbol{x} \\le |\\boldsymbol{z}^{\\top}\\boldsymbol{x}| \\le \\|\\boldsymbol{z}\\|_{\\infty} \\|\\boldsymbol{x}\\|_1 \\le \\|\\boldsymbol{z}\\|_{\\infty}\n$$\n由于我们找到了一个达到此上界的可行点 $\\boldsymbol{x}$，因此上确界是 $\\|\\boldsymbol{z}\\|_{\\infty}$。所以，$\\ell_1$-范数的对偶范数是 $\\ell_{\\infty}$-范数。\n\n与范数 $\\|\\cdot\\|$ 相关联的单位对偶球是集合 $\\{\\boldsymbol{z} \\in \\mathbb{R}^n : \\|\\boldsymbol{z}\\|_* \\le 1\\}$。对于 $\\ell_1$-范数，其对偶范数是 $\\|\\cdot\\|_{\\infty}$，所以它的单位对偶球是 $\\{\\boldsymbol{z} \\in \\mathbb{R}^n : \\|\\boldsymbol{z}\\|_{\\infty} \\le 1\\}$。这恰好是集合 $\\mathcal{C}_{\\infty}(1)$。\n问题中给出的集合 $\\mathcal{C}_{\\infty}(\\tau) = \\{\\boldsymbol{x} \\in \\mathbb{R}^{n} : \\|\\boldsymbol{x}\\|_{\\infty} \\le \\tau\\}$，是半径为 $\\tau$ 的 $\\ell_{\\infty}$-球。它是 $\\ell_1$-范数单位对偶球的一个缩放版本，缩放因子为 $\\tau$。\n\n### 第 3 部分：应用于具体数据\n\n给定向量 $\\boldsymbol{v} = (\\,3.1,\\,-2.4,\\,1.8,\\,-0.9,\\,2.0,\\,-4.6\\,) \\in \\mathbb{R}^{6}$ 和参数 $\\tau = 2$。投影 $\\boldsymbol{x}^* = \\Pi_{\\mathcal{C}_{\\infty}(2)}(\\boldsymbol{v})$ 的计算方法是，将第 1 部分中推导的逐坐标裁剪运算应用于 $\\boldsymbol{v}$ 的每个分量，区间为 $[ -2, 2 ]$。\n\n- $v_1 = 3.1$：因为 $3.1  2$，所以 $x_1^* = 2$。\n- $v_2 = -2.4$：因为 $-2.4  -2$，所以 $x_2^* = -2$。\n- $v_3 = 1.8$：因为 $-2 \\le 1.8 \\le 2$，所以 $x_3^* = 1.8$。\n- $v_4 = -0.9$：因为 $-2 \\le -0.9 \\le 2$，所以 $x_4^* = -0.9$。\n- $v_5 = 2.0$：因为 $-2 \\le 2.0 \\le 2$，所以 $x_5^* = 2.0$。\n- $v_6 = -4.6$：因为 $-4.6  -2$，所以 $x_6^* = -2$。\n\n结合这些结果，得到投影向量。\n唯一的欧几里得投影为 $\\boldsymbol{x}^* = (\\,2, -2, 1.8, -0.9, 2, -2\\,)$。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n2  -2  1.8  -0.9  2  -2\n\\end{pmatrix}\n}\n$$"
        }
    ]
}