## 引言
[整数规划](@entry_id:178386)（Integer Programming, IP）是优化领域的核心，它专注于解决现实世界中普遍存在的离散决策问题。然而，求解[整数规划](@entry_id:178386)问题面临一个根本性挑战：高效的线性规划（Linear Programming, LP）算法（如单纯形法）所找到的最优解常常是分数值，这在许多实际场景下是不可行的。如何系统地从这些非整数解中找到真正的整数最优解，是[整数规划](@entry_id:178386)理论的核心问题。切[割平面法](@entry_id:635930)（Cutting-plane Method）为此提供了一个优雅而强大的框架，而Ralph Gomory在1958年提出的Gomory割则是这一方法的开创性成果。

本文旨在对Gomory割提供一个全面而深入的理解，从其根本原理到实际应用。通过本文的学习，你将不仅掌握一个算法，更能洞悉[整数规划](@entry_id:178386)求解背后的深刻思想。

- 在第一章**“原理与机制”**中，我们将从第一性原理出发，详细推导Gomory分数割的数学形式，揭示其背后的代数技巧和几何直观，并探讨其成立的关键假设与理论基础。
- 随后，在第二章**“应用与跨学科联系”**中，我们将把目光投向实践，探索Gomory割如何在[运筹学](@entry_id:145535)的经典问题（如生产、物流、调度）中发挥作用，并揭示其与[对偶单纯形法](@entry_id:164344)、[分支定界法](@entry_id:635251)等其他核心优化算法的协同关系。
- 最后，**“动手实践”**部分将提供一系列精心设计的练习，帮助你将理论知识转化为解决实际问题的能力，真正掌握Gomory割的计算与应用。

让我们首先进入Gomory割的核心，理解它是如何被构想和建立起来的。

## 原理与机制

在前一章介绍[整数规划](@entry_id:178386)（Integer Programming, IP）及其与[线性规划](@entry_id:138188)（Linear Programming, LP）的联系后，我们认识到，解决[整数规划](@entry_id:178386)问题的一个核心挑战在于如何处理由[LP松弛](@entry_id:267116)产生的非整数解。单纯形法为求解L[P问题](@entry_id:267898)提供了高效的框架，但其最优解可能位于[可行域的顶点](@entry_id:174284)，而这些顶点可能不满足整数要求。切[割平面法](@entry_id:635930)（Cutting-plane Method）是解决这一问题的经典策略之一。其基本思想是，当[LP松弛](@entry_id:267116)得到一个非整数最优解时，我们系统性地引入一个新的线性约束（即“割”），这个约束能够“切除”包含当前非整数解的可行域部分，但同时保留所有原始的整数可行解。通过迭代地添加[割平面](@entry_id:177960)，我们逐步收紧[可行域](@entry_id:136622)，直至找到一个整数最优解。

Ralph Gomory于1958年提出的Gomory割是第一个被证明能在有限步内收敛的切[割平面](@entry_id:177960)算法。本章将深入探讨Gomory割的基本形式——分数割（fractional cut）的原理、推导过程、几何意义及其理论基础。

### 从第一性原理推导Gomory分数割

Gomory割的精妙之处在于它直接利用了[LP松弛](@entry_id:267116)求解后最终单纯形表中的信息。假设我们已经求解了一个纯[整数规划](@entry_id:178386)问题的[LP松弛](@entry_id:267116)，并得到了一个最优单纯形表。然而，该表对应的基本可行解中，某个需要取整数值的基本变量 $x_B$ 的值 $\bar{b}_B$ 是一个分数。

在单纯形表中，与 $x_B$ 对应的行可以写成如下的典式方程：
$x_B + \sum_{j \in N} \bar{a}_{Bj} x_j = \bar{b}_B$

其中，$N$ 是非基本变量的索引集合，$x_j$ 是非基本变量，$\bar{a}_{Bj}$ 是单纯形表中的系数，而 $\bar{b}_B$ 是该行的右端项（RHS），即 $x_B$ 的当前值。由于这是一个最优表，所有非基本变量的值都为0，因此 $x_B = \bar{b}_B$。

Gomory割的推导基于一个简单而深刻的观察：在任何一个可行的整数解中，所有变量都必须取整数值。利用这一事实，我们可以从上述方程中构造出一个新的、对所有整数解都成立但对当前非整数解不成立的约束。

推导过程如下：

我们将方程中的每一个系数（包括右端项）分解为其整数部分和分数部分。对于任何实数 $y$，我们定义其**整数部分 (integer part)** $\lfloor y \rfloor$ 为不大于 $y$ 的最大整数，其**分数部分 (fractional part)** $\{y\}$ 为 $y - \lfloor y \rfloor$。根据定义，我们总是有 $0 \le \{y\}  1$。

将这一定义应用于典式方程中的每一项：
$x_B + \sum_{j \in N} (\lfloor \bar{a}_{Bj} \rfloor + \{\bar{a}_{Bj}\}) x_j = \lfloor \bar{b}_B \rfloor + \{\bar{b}_B\}$

现在，我们将所有具有整数系数的项移到等式的一边，所有具有分数系数的项移到另一边：
$x_B + \sum_{j \in N} \lfloor \bar{a}_{Bj} \rfloor x_j - \lfloor \bar{b}_B \rfloor = \{\bar{b}_B\} - \sum_{j \in N} \{\bar{a}_{Bj}\} x_j$

让我们来分析这个重排后的方程。对于任何一个满足原始[整数规划](@entry_id:178386)问题约束的解，变量 $x_B$ 和所有变量 $x_j$ (在纯[整数规划](@entry_id:178386)中)都必须是整数。因此，上式左侧的表达式是由整数的加、减、乘运算构成的，其结果必然是一个整数。

由于左侧是一个整数，等式右侧也必须是一个整数。我们来考察右侧的性质：
$\{\bar{b}_B\} - \sum_{j \in N} \{\bar{a}_{Bj}\} x_j$

根据分数部分的定义，我们知道 $0 \le \{\bar{a}_{Bj}\}  1$。同时，在标准的单纯形法框架下，所有变量（包括非基本变量 $x_j$）都必须满足非负性约束，即 $x_j \ge 0$。因此，求和项 $\sum_{j \in N} \{\bar{a}_{Bj}\} x_j$ 必然是非负的。

另外，由于我们选择的这一行是对应一个非整数[基本解](@entry_id:184782)的，所以 $\bar{b}_B$ 是一个分数，这意味着 $0  \{\bar{b}_B\}  1$。

综合以上分析，右侧表达式的值小于1：
$\{\bar{b}_B\} - (\text{一个非负数}) \le \{\bar{b}_B\}  1$

我们已经得出结论：对于任何可行的整数解，右侧表达式必须是一个整数，且其值必须小于1。满足这两个条件的唯一整数是0以及所有负整数。因此，我们可以断定：
$\{\bar{b}_B\} - \sum_{j \in N} \{\bar{a}_{Bj}\} x_j \le 0$

将此不等式重新整理，便得到了**Gomory分数割 (Gomory fractional cut)**：
$$ \sum_{j \in N} \{\bar{a}_{Bj}\} x_j \ge \{\bar{b}_B\} $$

这个不等式是一个新的[有效约束](@entry_id:635234)。它的重要性在于：
1.  **有效性**：如推导所示，所有满足原问题整数约束的解都必然满足这个不等式。因此，添加这个[割平面](@entry_id:177960)不会切除任何合法的整数解。
2.  **切割作用**：当前[LP松弛](@entry_id:267116)的最优解是 $x_j=0$ (对于所有 $j \in N$)，代入Gomory割的左侧，得到0。不等式变为 $0 \ge \{\bar{b}_B\}$。然而，我们推导的前提是 $\bar{b}_B$ 为分数，即 $\{\bar{b}_B\} > 0$。因此，$0 \ge \{\bar{b}_B\}$ 是一个矛盾，这表明当前的非整数最优解不满足新添加的Gomory割。这样，这个割就成功地“切掉”了当前的非整数顶点。 

### Gomory割的计算与应用

掌握了Gomory割的推导原理后，其实际应用就变成了一个直接的计算过程。给定一个含有非整数基本解的最优单纯形表，我们只需选择其中一个对应整数变量且其值为分数的行，然后应用上述公式。

我们以一个具体的例子来说明。假设在求解一个[整数规划](@entry_id:178386)问题时，我们得到的最优单纯形表包含以下一行，其中 $x_1$ 是基本变量，而 $x_2$ 和 $s_1$（[松弛变量](@entry_id:268374)）是非基本变量 ：

| Basis |  $z$  | $x_1$ | $x_2$ | $s_1$ |  RHS  |
|:-----:|:-----:|:-----:|:-----:|:-----:|:-----:|
| $x_1$ |   0   |   1   | $7/5$ | $2/5$ | $13/5$|

这一行对应的典式方程是：
$x_1 + \frac{7}{5}x_2 + \frac{2}{5}s_1 = \frac{13}{5}$

当前解中 $x_1 = 13/5$，不满足整数要求。我们可以从这一行生成一个Gomory割。
首先，识别出非基本变量为 $x_2$ 和 $s_1$。
然后，计算方程中各项系数的分数部分：
-   非基本变量 $x_2$ 的系数是 $\bar{a}_{12} = \frac{7}{5}$。其分数部分为 $\{\frac{7}{5}\} = \frac{7}{5} - \lfloor \frac{7}{5} \rfloor = \frac{7}{5} - 1 = \frac{2}{5}$。
-   非基本变量 $s_1$ 的系数是 $\bar{a}_{13} = \frac{2}{5}$。其分数部分为 $\{\frac{2}{5}\} = \frac{2}{5} - \lfloor \frac{2}{5} \rfloor = \frac{2}{5} - 0 = \frac{2}{5}$。
-   右端项是 $\bar{b}_1 = \frac{13}{5}$。其分数部分为 $\{\frac{13}{5}\} = \frac{13}{5} - \lfloor \frac{13}{5} \rfloor = \frac{13}{5} - 2 = \frac{3}{5}$。

根据Gomory割的公式 $\sum_{j \in N} \{\bar{a}_{Bj}\} x_j \ge \{\bar{b}_B\}$，我们得到：
$\frac{2}{5}x_2 + \frac{2}{5}s_1 \ge \frac{3}{5}$

为了方便计算，我们可以将不等式两边同乘以5，得到一个系数为整数的等价形式：
$2x_2 + 2s_1 \ge 3$

这就是从所给行生成的Gomory割。这个新的约束可以被添加回原有的L[P问题](@entry_id:267898)中，然后继续用[对偶单纯形法](@entry_id:164344)等方法求解，直到找到一个满足所有整数约束的解。

在计算分数部[分时](@entry_id:274419)，需要特别注意负系数的情况。分数部分的定义 $y - \lfloor y \rfloor$ 对所有实数都适用。例如，考虑另一行方程 ：
$x_1 + \frac{3}{5}s_2 - \frac{2}{5}s_3 = \frac{12}{5}$

其中 $s_2$ 和 $s_3$ 是非基本变量。我们需要计算系数 $-\frac{2}{5}$ 的分数部分：
$\{-\frac{2}{5}\} = -\frac{2}{5} - \lfloor -\frac{2}{5} \rfloor = -\frac{2}{5} - (-1) = \frac{3}{5}$

这是一个非常关键的计算细节，错误的计算将导致无效的割。该行的Gomory割为：
$\{\frac{3}{5}\}s_2 + \{-\frac{2}{5}\}s_3 \ge \{\frac{12}{5}\}$
即：
$\frac{3}{5}s_2 + \frac{3}{5}s_3 \ge \frac{2}{5}$

### 几何解释与变量转换

Gomory割是在包含[松弛变量](@entry_id:268374)（非基本变量）的空间中生成的，但其真正的威力在于它如何在原始决策变量的空间中切割[可行域](@entry_id:136622)。为了理解其几何意义，我们需要将[割平面](@entry_id:177960)从[松弛变量](@entry_id:268374)的表达形式转换回原始决策变量（如 $x_1, x_2$）的形式。

这个转换过程依赖于[松弛变量](@entry_id:268374)的定义。每个[松弛变量](@entry_id:268374)都代表了其对应约束的“余量”。例如，假设一个问题包含以下约束 ：
1. $3x_1 + x_2 \le 13$
2. $x_1 + 4x_2 \le 18$

对应的[松弛变量](@entry_id:268374) $s_1, s_2$ 定义为：
$s_1 = 13 - 3x_1 - x_2$
$s_2 = 18 - x_1 - 4x_2$

假设我们从单纯形表的某一行推导出了一个关于 $s_1$ 和 $s_2$ 的Gomory割，例如：
$4s_1 + 10s_2 \ge 1$

要理解这个割在 $(x_1, x_2)$ 平面上的样子，我们只需将 $s_1$ 和 $s_2$ 的定义代入：
$4(13 - 3x_1 - x_2) + 10(18 - x_1 - 4x_2) \ge 1$

展开并简化该不等式：
$52 - 12x_1 - 4x_2 + 180 - 10x_1 - 40x_2 \ge 1$
$232 - 22x_1 - 44x_2 \ge 1$
$231 \ge 22x_1 + 44x_2$

两边同除以11，得到最简形式：
$21 \ge 2x_1 + 4x_2$ 或 $2x_1 + 4x_2 \le 21$

这个不等式 $2x_1 + 4x_2 \le 21$ 就是Gomory割在原始 $(x_1, x_2)$ 空间中的体现。它定义了一个新的半平面。[LP松弛](@entry_id:267116)问题的[可行域](@entry_id:136622)（一个多边形）的非整数最优顶点会被这个新的半平面“切掉”，但所有原始的整数可行点都会被保留在该半平面内。

从更深层次的几何角度看，所有可行整数点的凸包（convex hull）构成了所谓的**整数包（integer hull）**。任何有效的[割平面](@entry_id:177960)，包括Gomory割，都定义了一个包含整个整数包的半空间。理想情况下，一个好的[割平面](@entry_id:177960)应该是一个**[支撑超平面](@entry_id:274981)（supporting hyperplane）**，即它不仅包含整个整数包，而且与整数包的边界相切（即至少有一个整数点落在该超平面上）。Gomory割正是这样一种旨在逼近整数包边界的[有效不等式](@entry_id:170492)。

### 重要假设与特殊情况

Gomory分数割的推导虽然优雅，但其有效性依赖于几个关键假设。理解这些假设和一些特殊情况对于正确应用该方法至关重要。

#### 非负性假设

在推导Gomory割的过程中，一个至关重要的步骤是论证 $\sum_{j \in N} \{\bar{a}_{Bj}\} x_j \ge 0$。这一步依赖于两个条件：$\{\bar{a}_{Bj}\} \ge 0$（由分数部分的定义保证）和 $x_j \ge 0$（非基本变量的非负性）。如果非基本变量可以是负数，那么这个论证就不成立，Gomory割的有效性也无法保证。

考虑一个简单的整数[约束方程](@entry_id:138140) ：
$x_3 = \frac{1}{2} + \frac{1}{2}x_1 + \frac{1}{2}x_2$
其中 $x_1, x_2, x_3$ 都必须是整数。

如果遵循标准流程，假设 $x_1, x_2 \ge 0$，我们可以从方程 $x_3 - \frac{1}{2}x_1 - \frac{1}{2}x_2 = \frac{1}{2}$ 推导出Gomory割：$\{\!-\frac{1}{2}\}x_1 + \{\!-\frac{1}{2}\}x_2 \ge \{\frac{1}{2}\}$，这等价于 $\frac{1}{2}x_1 + \frac{1}{2}x_2 \ge \frac{1}{2}$，即 $x_1 + x_2 \ge 1$。

然而，如果我们去掉 $x_1, x_2 \ge 0$ 的约束，允许它们取任意整数值。考虑点 $(x_1, x_2, x_3) = (-1, 0, 0)$。这个点满足原始方程：$0 = \frac{1}{2} + \frac{1}{2}(-1) + \frac{1}{2}(0)$。这是一个合法的整数解。但是，它却违反了我们推导出的Gomory割：$-1+0 \ge 1$ 是错误的。这表明，当非基本变量可以为负时，标准的Gomory分数割可能会错误地切除掉合法的整数解。因此，**Gomory分数割的有效性严格依赖于非基本变量的非负性**。

#### 右端项为整数的情况

Gomory割的出发点是基本变量的值为分数。如果在一个最优单纯形表中，所有需要取整数的基本变量的值恰好都已经是整数了，会发生什么？

让我们来考察这种情况。假设一个整数变量 $x_1$ 对应的行为 ：
$x_1 = 3 + 0.4y + 0.25s_2$

这里的右端项 $\bar{b}_1=3$ 是一个整数。其分数部分 $\{\bar{b}_1\} = \{3\} = 0$。
应用Gomory割公式，我们得到：
$\{0.4\}y + \{0.25\}s_2 \ge \{3\}$
$0.4y + 0.25s_2 \ge 0$

由于变量 $y, s_2$ 都是非负的，且系数 $0.4, 0.25$ 也是非负的，这个不等式 $0.4y + 0.25s_2 \ge 0$ 总是被满足的。它等价于已有的非负性约束，没有提供任何新信息，也无法切割掉任何可行域。这种割被称为**平凡割（trivial cut）**。

因此，当一个整[数基](@entry_id:634389)本变量在[LP松弛](@entry_id:267116)解中已经取到整数值时，从它对应的行无法生成一个有用的Gomory分数割。如果一个LP最优解中所有整数变量都取了整数值，那么这个解就是原I[P问题](@entry_id:267898)的最优解，[算法终止](@entry_id:143996)。如果某些整数变量是整数，而另一些是分数，我们只能从值为分数的那些行生成割。如果所有整数变量的值都是整数，但某个连续变量的值使得解对整个问题（例如，[混合整数规划](@entry_id:173755)）不可行，那么Gomory分数割方法在此刻就会“停滞”，需要依赖其他类型的割或者分支定界等方法。

#### 连续基本变量的情况

Gomory分数割的推导还依赖于等式左侧 $x_B + \sum \lfloor \bar{a}_{Bj} \rfloor x_j - \lfloor \bar{b}_B \rfloor$ 必须为整数。这要求基本变量 $x_B$ 本身是整数约束变量。如果一个基本变量是连续变量，即使它的值 $\bar{b}_B$ 是一个分数，也不能从这一行生成Gomory分数割，因为推导的根基——“左侧必须为整数”——不再成立。

### 理论基础：[Chvátal-Gomory割](@entry_id:634739)与[次可加性](@entry_id:137224)

虽然Gomory割的推导过程看似是一种巧妙的代数技巧，但它背后有更深刻的理论支撑，将其与更普适的[割平面](@entry_id:177960)生成理论联系起来。

#### Chvátal-Gomory 割

一个更一般化的生成[有效不等式](@entry_id:170492)的方法是Chvátal-Gomory (C-G) 过程。该过程如下：
1.  取原始约束集 $A\mathbf{x} \le \mathbf{b}$ 的一个非负[线性组合](@entry_id:154743)，得到一个新的[有效不等式](@entry_id:170492) $\mathbf{u}^T A \mathbf{x} \le \mathbf{u}^T \mathbf{b}$，其中 $\mathbf{u} \ge 0$。
2.  如果组合后的系数向量 $\mathbf{a}' = \mathbf{u}^T A$ 恰好是一个整数向量，那么由于 $\mathbf{x}$ 也必须是整数，左侧 $\mathbf{a}'^T \mathbf{x}$ 必然是一个整数。
3.  因此，我们可以将右侧向下取整，得到一个更强的[有效不等式](@entry_id:170492)（C-G割）：$\mathbf{a}'^T \mathbf{x} \le \lfloor \mathbf{u}^T \mathbf{b} \rfloor$。

Gomory从单纯形表中推导出的分数割，实际上可以被看作一种以系统性方式执行C-G过程的特例。单纯形法的每一步操作（如行变换）本质上都是对原始约束的[线性组合](@entry_id:154743)。最终单纯形表中的每一行都代表了原始约束的一个特定线性组合。Gomory割的推导过程，巧妙地利用了单纯形表已经完成的线性组合，并在此基础上应用了取整原理。可以证明，从单纯形表某行生成的Gomory割，等价于选择一组特定的非负乘子 $\mathbf{u}$ 应用于原始约束，然后执行C-G取整步骤。

#### [次可加性](@entry_id:137224)

从更现代的视角看，Gomory割是基于**次可加函数（subadditive function）**理论的一个实例。一个函数 $\psi: \mathbb{R} \to \mathbb{R}$ 被称为次可加的，如果对于其定义域中的任意 $u, v$，都满足 $\psi(u+v) \le \psi(u) + \psi(v)$。

可以证明，我们用于推导Gomory割的分数部分函数 $\psi(t) = \{t\} = t - \lfloor t \rfloor$ 背后相关的楼板函数具有一个著名性质。其函数的[次可加性](@entry_id:137224) $\{u+v\} \le \{u\} + \{v\}$ 等价于 $\lfloor u+v \rfloor \ge \lfloor u \rfloor + \lfloor v \rfloor$，这是楼板函数的一个著名性质。

对于一个形如 $\sum a_j x_j = b$ 的方程，其中 $x_j$ 是非负整数，任何一个次可加函数 $\psi$ 都可以生成一个有效的不等式。Gomory分数割正是利用了分数部分函数 $\psi(t)=\{t\}$ 的相关性质，并结合其他性质，系统性地从单纯形表中导出的。 这个理论视角将Gomory割置于一个更广阔的框架中，该框架还包括了用于[混合整数规划](@entry_id:173755)的混合整数Gomory (GMI) 割等其他重要类型的[割平面](@entry_id:177960)。

综上所述，Gomory分数割不仅是一种实用的算法工具，它也体现了[整数规划](@entry_id:178386)中深刻的代数、几何与函数理论。通过理解其从第一性原理出发的推导、几何意义、关键假设以及背后的理论基础，我们能更深刻地把握切[割平面法](@entry_id:635930)的精髓。