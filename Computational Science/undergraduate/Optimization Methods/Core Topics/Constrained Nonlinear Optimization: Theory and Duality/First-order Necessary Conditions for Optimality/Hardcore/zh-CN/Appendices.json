{
    "hands_on_practices": [
        {
            "introduction": "理论学习的最佳伙伴是动手实践。我们从一个经典且直观的问题开始，它将一阶必要条件应用于一个基本但极为重要的统计学概念——最小二乘法。通过解决这个问题，你将看到如何通过将函数的导数设为零来找到最优解，并从优化的角度理解为什么样本均值是一组测量值的最佳估计。",
            "id": "2173061",
            "problem": "一位实验物理学家进行 $n$ 次实验来测量一个基本物理常数。得到的测量值集合为 $\\{y_1, y_2, \\ldots, y_n\\}$。为了根据这些测量值确定该常数的单个最佳估计值 $c$，该物理学家决定使用最小二乘法原理。该原理指出，最佳估计值是使估计值与每次测量值之间的离差平方和最小化的 $c$ 值。\n\n离差平方和由以下函数给出：\n$$ S(c) = \\sum_{i=1}^n (y_i - c)^2 $$\n\n使用一阶必要条件求最小值，确定使 $S(c)$ 最小的 $c$ 值。答案需用测量值 $y_i$ 和测量总次数 $n$ 的符号表达式表示。",
            "solution": "我们寻求使 $S(c) = \\sum_{i=1}^{n} (y_{i} - c)^{2}$ 最小化的 $c$。使用一阶必要条件，对 $S(c)$ 关于 $c$ 求导：\n$$\n\\frac{dS}{dc} = \\sum_{i=1}^{n} \\frac{d}{dc}(y_{i} - c)^{2} = \\sum_{i=1}^{n} 2(y_{i} - c)(-1) = 2 \\sum_{i=1}^{n} (c - y_{i}) = 2\\left(nc - \\sum_{i=1}^{n} y_{i}\\right).\n$$\n令导数为零：\n$$\n2\\left(nc - \\sum_{i=1}^{n} y_{i}\\right) = 0 \\quad \\Longrightarrow \\quad nc - \\sum_{i=1}^{n} y_{i} = 0 \\quad \\Longrightarrow \\quad c = \\frac{1}{n} \\sum_{i=1}^{n} y_{i}.\n$$\n为完整起见，二阶导数为\n$$\n\\frac{d^{2}S}{dc^{2}} = \\sum_{i=1}^{n} 2 = 2n > 0,\n$$\n这证实了该临界点是一个最小值点。因此，使 $S(c)$ 最小的 $c$ 是测量值的算术平均值。",
            "answer": "$$\\boxed{\\frac{1}{n}\\sum_{i=1}^{n} y_{i}}$$"
        },
        {
            "introduction": "现实世界中的优化问题很少是无约束的，我们必须处理各种限制。这个练习将引导你进入有约束优化的领域，系统地应用Karush-Kuhn-Tucker (KKT) 条件。你将学习如何为包含等式和不等式约束的问题构建拉格朗日函数，并求解完整的KKT系统，这是解决复杂优化问题的核心技能。",
            "id": "3129884",
            "problem": "设决策变量为 $\\mathbf{x} = (x_1, x_2) \\in \\mathbb{R}^2$。考虑最小化目标函数\n$$\nf(\\mathbf{x}) = (x_1 - 3)^2 + (x_2 + 1)^2 + 2(x_1 - x_2)\n$$\n的约束优化问题，其等式约束为\n$$\nh(\\mathbf{x}) = x_1 + x_2 - 2 = 0\n$$\n不等式约束为\n$$\ng_1(\\mathbf{x}) = -x_1 \\le 0, \\quad g_2(\\mathbf{x}) = -x_2 \\le 0, \\quad g_3(\\mathbf{x}) = x_1 - 2 \\le 0.\n$$\n完成以下任务：\n- 根据优化方法中约束局部最小值的定义和一阶必要条件，系统地写出该问题的 Karush-Kuhn-Tucker (KKT) 条件（原始可行性、对偶可行性、互补松弛性和平稳性），为 $h(\\mathbf{x})$ 引入拉格朗日乘子 $\\lambda$，为 $g_1(\\mathbf{x}), g_2(\\mathbf{x}), g_3(\\mathbf{x})$ 引入非负乘子 $\\mu_1, \\mu_2, \\mu_3$。\n- 确定求解该问题的 KKT 点处的有效约束集，并推断哪些不等式乘子必须严格为正，哪些必须为零，以及哪些即使在相应约束有效的情况下也可能为零。\n- 计算 KKT 点处与等式约束相关的拉格朗日乘子的值。\n\n将最终答案表示为单个实数。无需四舍五入。",
            "solution": "该约束优化问题是最小化目标函数\n$$ f(\\mathbf{x}) = (x_1 - 3)^2 + (x_2 + 1)^2 + 2(x_1 - x_2) $$\n其中 $\\mathbf{x} = (x_1, x_2) \\in \\mathbb{R}^2$，服从等式约束\n$$ h(\\mathbf{x}) = x_1 + x_2 - 2 = 0 $$\n和不等式约束\n$$ g_1(\\mathbf{x}) = -x_1 \\le 0 $$\n$$ g_2(\\mathbf{x}) = -x_2 \\le 0 $$\n$$ g_3(\\mathbf{x}) = x_1 - 2 \\le 0 $$\n\n目标函数是一个严格凸的二次函数（其 Hessian 矩阵是正定的），由线性约束定义的可行域是一个凸集。因此，任何满足 Karush-Kuhn-Tucker (KKT) 条件的点都是唯一的全局最小值。\n\n首先，按要求，我们系统地写出该问题的 KKT 条件。拉格朗日函数 $L(\\mathbf{x}, \\lambda, \\boldsymbol{\\mu})$ 由 $h(\\mathbf{x})$ 的乘子 $\\lambda$ 和 $g_1(\\mathbf{x}), g_2(\\mathbf{x}), g_3(\\mathbf{x})$ 的乘子 $\\mu_1, \\mu_2, \\mu_3$ 定义：\n$$ L(x_1, x_2, \\lambda, \\mu_1, \\mu_2, \\mu_3) = f(\\mathbf{x}) + \\lambda h(\\mathbf{x}) + \\sum_{i=1}^3 \\mu_i g_i(\\mathbf{x}) $$\n$$ L(x_1, x_2, \\lambda, \\mu_1, \\mu_2, \\mu_3) = \\left[(x_1 - 3)^2 + (x_2 + 1)^2 + 2(x_1 - x_2)\\right] + \\lambda(x_1 + x_2 - 2) + \\mu_1(-x_1) + \\mu_2(-x_2) + \\mu_3(x_1 - 2) $$\n点 $\\mathbf{x}^*$ 成为约束局部最小值的 KKT 条件如下：\n\n1.  **原始可行性**：该点必须满足所有约束。\n    $$ x_1^* + x_2^* - 2 = 0 $$\n    $$ -x_1^* \\le 0 \\implies x_1^* \\ge 0 $$\n    $$ -x_2^* \\le 0 \\implies x_2^* \\ge 0 $$\n    $$ x_1^* - 2 \\le 0 \\implies x_1^* \\le 2 $$\n\n2.  **对偶可行性**：不等式约束的乘子必须为非负。\n    $$ \\mu_1 \\ge 0, \\quad \\mu_2 \\ge 0, \\quad \\mu_3 \\ge 0 $$\n\n3.  **互补松弛性**：每个不等式乘子与其对应约束函数值的乘积必须为零。\n    $$ \\mu_1(-x_1^*) = 0 $$\n    $$ \\mu_2(-x_2^*) = 0 $$\n    $$ \\mu_3(x_1^* - 2) = 0 $$\n\n4.  **平稳性**：拉格朗日函数关于决策变量 $\\mathbf{x}$ 的梯度在点 $\\mathbf{x}^*$ 处必须为零。目标函数的梯度为：\n    $$ \\nabla f(\\mathbf{x}) = \\begin{pmatrix} \\frac{\\partial f}{\\partial x_1} \\\\ \\frac{\\partial f}{\\partial x_2} \\end{pmatrix} = \\begin{pmatrix} 2(x_1 - 3)(1) + 2 \\\\ 2(x_2 + 1)(1) - 2 \\end{pmatrix} = \\begin{pmatrix} 2x_1 - 4 \\\\ 2x_2 \\end{pmatrix} $$\n    约束函数的梯度为：\n    $$ \\nabla h(\\mathbf{x}) = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}, \\quad \\nabla g_1(\\mathbf{x}) = \\begin{pmatrix} -1 \\\\ 0 \\end{pmatrix}, \\quad \\nabla g_2(\\mathbf{x}) = \\begin{pmatrix} 0 \\\\ -1 \\end{pmatrix}, \\quad \\nabla g_3(\\mathbf{x}) = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} $$\n    平稳性条件 $\\nabla_{\\mathbf{x}} L(\\mathbf{x}^*, \\lambda, \\boldsymbol{\\mu}) = \\mathbf{0}$ 产生以下两个方程：\n    $$ 2x_1^* - 4 + \\lambda - \\mu_1 + \\mu_3 = 0 $$\n    $$ 2x_2^* + \\lambda - \\mu_2 = 0 $$\n\n为了求解该系统，我们首先确定最优点 $\\mathbf{x}^*$。我们可以将等式约束 $x_2 = 2 - x_1$ 代入目标函数，得到一个关于 $x_1$ 的一维问题。$x_1$ 的可行范围由 $x_1 \\ge 0$ 和 $x_2 = 2 - x_1 \\ge 0$ 确定，这意味着 $x_1 \\in [0, 2]$。约束 $x_1 \\le 2$ 是冗余的。\n新的目标函数为 $F(x_1) = f(x_1, 2-x_1)$：\n$$ F(x_1) = (x_1 - 3)^2 + ((2-x_1) + 1)^2 + 2(x_1 - (2-x_1)) $$\n$$ F(x_1) = (x_1 - 3)^2 + (3 - x_1)^2 + 2(2x_1 - 2) $$\n$$ F(x_1) = 2(x_1 - 3)^2 + 4(x_1 - 1) = 2(x_1^2 - 6x_1 + 9) + 4x_1 - 4 = 2x_1^2 - 8x_1 + 14 $$\n为了在 $[0, 2]$ 上找到 $F(x_1)$ 的最小值，我们计算其导数：\n$$ F'(x_1) = 4x_1 - 8 $$\n令 $F'(x_1) = 0$ 得到 $x_1 = 2$。该点是开口向上的抛物线 $F(x_1)$ 的顶点，且位于可行区间 $[0, 2]$ 的边界上。因此，$F(x_1)$ 在此区间上的最小值在 $x_1^*=2$ 处取得。\n$x_2$ 的相应值为 $x_2^* = 2 - x_1^* = 2 - 2 = 0$。\nKKT 点，即最优解为 $\\mathbf{x}^* = (2, 0)$。\n\n接下来，我们确定有效约束集和乘子。在 $\\mathbf{x}^* = (2, 0)$ 处：\n- $h(\\mathbf{x}^*) = 2 + 0 - 2 = 0$（有效）。\n- $g_1(\\mathbf{x}^*) = -x_1^* = -2  0$（非有效）。\n- $g_2(\\mathbf{x}^*) = -x_2^* = -0 = 0$（有效）。\n- $g_3(\\mathbf{x}^*) = x_1^* - 2 = 2 - 2 = 0$（有效）。\n有效约束集为 $\\{h, g_2, g_3\\}$。\n\n根据互补松弛性条件：\n- 由于 $g_1$ 是非有效的，其乘子必须为零：$\\mu_1 = 0$。\n- 对于有效的 $g_2$ 和 $g_3$，该条件得到满足，乘子 $\\mu_2$ 和 $\\mu_3$ 不一定为零。根据对偶可行性，$\\mu_2 \\ge 0$ 且 $\\mu_3 \\ge 0$。\n\n现在我们将 $\\mathbf{x}^* = (2, 0)$ 和 $\\mu_1 = 0$ 代入平稳性方程：\n1.  $2(2) - 4 + \\lambda - 0 + \\mu_3 = 0 \\implies \\lambda + \\mu_3 = 0$。\n2.  $2(0) + \\lambda - \\mu_2 = 0 \\implies \\lambda - \\mu_2 = 0$。\n\n由第二个方程可知 $\\lambda = \\mu_2$。因为 $\\mu_2 \\ge 0$（对偶可行性），我们必有 $\\lambda \\ge 0$。\n由第一个方程可知 $\\mu_3 = -\\lambda$。因为 $\\mu_3 \\ge 0$（对偶可行性），我们必有 $-\\lambda \\ge 0$，这意味着 $\\lambda \\le 0$。\n\n要同时满足 $\\lambda \\ge 0$ 和 $\\lambda \\le 0$，唯一可能性是 $\\lambda = 0$。\n因此，这得到 $\\mu_2 = \\lambda = 0$ 和 $\\mu_3 = -\\lambda = 0$。\n完整的乘子集合为 $(\\lambda, \\mu_1, \\mu_2, \\mu_3) = (0, 0, 0, 0)$。\n这是一个退化情况，其中有效不等式约束的乘子为零。这种情况发生的原因是，目标函数在 $(2, 0)$ 处的无约束最小值恰好与可行域的一个顶点重合。\n\n回答具体问题：\n- KKT 条件已在上文写出。\n- 在 KKT 点 $\\mathbf{x}^*=(2,0)$ 处的有效约束集为 $\\{h, g_2, g_3\\}$。由于 $g_1$ 是非有效的，其乘子 $\\mu_1$ 必须为零。乘子 $\\mu_2$ 和 $\\mu_3$ 对应于有效约束，但在此解中它们也为零；这表明有效约束可以有零乘子。没有不等式乘子是严格为正的。\n- 在 KKT 点处与等式约束相关的拉格朗日乘子的值为 $\\lambda = 0$。",
            "answer": "$$\n\\boxed{0}\n$$"
        },
        {
            "introduction": "在许多现代应用中（例如机器学习），我们遇到的目标函数可能不是处处可微的。这个练习将一阶最优性条件推广到非光滑凸函数的情况，你需要使用次微分的概念。通过解决这个问题，你将学会如何通过寻找使零包含在次微分集 $0 \\in \\partial f(x^{\\star})$ 中的点来确定非光滑函数的最小值，这对于理解更高级的优化算法至关重要。",
            "id": "3129939",
            "problem": "设函数 $f : \\mathbb{R} \\to \\mathbb{R}$ 定义为\n$$\nf(x) = \\max\\left\\{\\,3x - 4,\\,-x + 1,\\,\\frac{1}{2}x\\,\\right\\}.\n$$\n函数 $f$ 是一个分段线性和凸函数，其不可导的“拐点”出现在两个或多个定义它的线性部分相等并达到最大值的点上。利用凸优化中的一阶最优性必要条件，确定所有满足 $0 \\in \\partial f(x^{\\star})$ 的点 $x^{\\star} \\in \\mathbb{R}$，其中 $\\partial f(x^{\\star})$ 表示函数 $f$ 在点 $x^{\\star}$ 处的次微分。请根据凸性和次梯度的定义来证明你的答案。如果答案唯一，请将其表示为单个实数；如果不唯一，请将其表示为单个封闭形式的解析表达式。无需四舍五入。",
            "solution": "题目要求找出所有满足函数 $f(x) = \\max\\left\\{\\,3x - 4,\\,-x + 1,\\,\\frac{1}{2}x\\,\\right\\}$ 的一阶最优性必要条件的点 $x^{\\star} \\in \\mathbb{R}$。该条件为 $0 \\in \\partial f(x^{\\star})$，其中 $\\partial f(x^{\\star})$ 是 $f$ 在 $x^{\\star}$ 处的次微分。\n\n设三个线性函数分别为 $f_1(x) = 3x - 4$、$f_2(x) = -x + 1$ 和 $f_3(x) = \\frac{1}{2}x$。函数 $f(x)$ 定义为 $f(x) = \\max\\{f_1(x), f_2(x), f_3(x)\\}$。每个函数 $f_i(x)$ 都是仿射函数，因此也是凸函数。一组凸函数的最大值也是一个凸函数。因此，$f(x)$ 是一个凸函数。\n\n对于一个凸函数 $f: \\mathbb{R} \\to \\mathbb{R}$，一个点 $x^{\\star}$ 是全局最小值点的充分必要条件是满足一阶最优性必要条件。该条件表明，零向量必须是 $f$ 在 $x^{\\star}$ 处次微分的元素。在我们的**一维**情况下，这个条件是 $0 \\in \\partial f(x^{\\star})$。\n\n次梯度 $g$ 满足不等式 $f(y) \\geq f(x) + g(y-x)$ 对所有 $y \\in \\mathbb{R}$ 成立。如果 $0 \\in \\partial f(x^{\\star})$，我们可以选择 $g=0$ 作为一个次梯度，这得到 $f(y) \\geq f(x^{\\star}) + 0 \\cdot (y-x^{\\star}) = f(x^{\\star})$ 对所有 $y$ 成立。这就是全局最小值的定义。因此，找出所有满足 $0 \\in \\partial f(x^{\\star})$ 的 $x^{\\star}$ 等价于找出 $f(x)$ 的所有全局最小值点。\n\n对于一个定义为若干个可微凸函数的最大值的函数 $f(x) = \\max_{i \\in \\{1, \\dots, n\\}} f_i(x)$，其在点 $x$ 处的次微分由该点处“有效”函数的梯度的凸包给出。有效索引的集合是 $I(x) = \\{i \\mid f_i(x) = f(x)\\}$。那么次微分就是 $\\partial f(x) = \\text{conv}\\{\\nabla f_i(x) \\mid i \\in I(x)\\}$，其中 $\\text{conv}$ 表示凸包。\n\n在我们的例子中，函数 $f_i(x)$ 处处可微。它们的导数（在 $\\mathbb{R}$ 中的梯度）是常数：\n$\\nabla f_1(x) = f_1'(x) = 3$\n$\\nabla f_2(x) = f_2'(x) = -1$\n$\\nabla f_3(x) = f_3'(x) = \\frac{1}{2}$\n\n为了确定次微分 $\\partial f(x)$，我们必须首先确定对于任意给定的 $x$，哪个（或哪些）函数是有效的。这需要找到定义最大值的函数发生变化的点。这些点是分段线性函数 $f(x)$ 的“拐点”，它们出现在构成上包络线的各条直线的交点处。\n\n我们求这些直线的交点：\n1. $f_1(x) = f_2(x) \\implies 3x - 4 = -x + 1 \\implies 4x = 5 \\implies x = \\frac{5}{4}$。\n2. $f_2(x) = f_3(x) \\implies -x + 1 = \\frac{1}{2}x \\implies 1 = \\frac{3}{2}x \\implies x = \\frac{2}{3}$。\n3. $f_1(x) = f_3(x) \\implies 3x - 4 = \\frac{1}{2}x \\implies \\frac{5}{2}x = 4 \\implies x = \\frac{8}{5}$。\n\n让我们在这些交点处计算这三个函数的值，以确定哪些交点位于上包络线上（即，$f(x)$ 的实际拐点）：\n在 $x = \\frac{2}{3}$ 处：\n$f_2(\\frac{2}{3}) = -(\\frac{2}{3}) + 1 = \\frac{1}{3}$。\n$f_3(\\frac{2}{3}) = \\frac{1}{2}(\\frac{2}{3}) = \\frac{1}{3}$。\n$f_1(\\frac{2}{3}) = 3(\\frac{2}{3}) - 4 = 2 - 4 = -2$。\n因为 $f_2(\\frac{2}{3}) = f_3(\\frac{2}{3}) > f_1(\\frac{2}{3})$，所以 $x = \\frac{2}{3}$ 是 $f(x)$ 的一个拐点。\n\n在 $x = \\frac{8}{5}$ 处：\n$f_1(\\frac{8}{5}) = 3(\\frac{8}{5}) - 4 = \\frac{24}{5} - \\frac{20}{5} = \\frac{4}{5}$。\n$f_3(\\frac{8}{5}) = \\frac{1}{2}(\\frac{8}{5}) = \\frac{4}{5}$。\n$f_2(\\frac{8}{5}) = -(\\frac{8}{5}) + 1 = -\\frac{3}{5}$。\n因为 $f_1(\\frac{8}{5}) = f_3(\\frac{8}{5}) > f_2(\\frac{8}{5})$，所以 $x = \\frac{8}{5}$ 也是 $f(x)$ 的一个拐点。\n\n在 $x = \\frac{5}{4}$ 处：\n$f_1(\\frac{5}{4}) = 3(\\frac{5}{4}) - 4 = \\frac{15}{4} - \\frac{16}{4} = -\\frac{1}{4}$。\n$f_2(\\frac{5}{4}) = -(\\frac{5}{4}) + 1 = -\\frac{1}{4}$。\n$f_3(\\frac{5}{4}) = \\frac{1}{2}(\\frac{5}{4}) = \\frac{5}{8}$。\n因为 $f_3(\\frac{5}{4}) > f_1(\\frac{5}{4}) = f_2(\\frac{5}{4})$，所以 $f_1$ 和 $f_2$ 的交点位于 $f_3$ 的下方。因此，$x = \\frac{5}{4}$ 不是 $f(x)$ 的拐点。\n\n$f(x)$ 的拐点在 $x = \\frac{2}{3}$ 和 $x = \\frac{8}{5}$。现在我们分析由这些拐点定义的区域内的次微分。\n\n情况 1: $x  \\frac{2}{3}$。\n在此区域，$f_2(x) = -x+1$ 是最大函数。因此，$I(x) = \\{2\\}$。\n$\\partial f(x) = \\{\\nabla f_2(x)\\} = \\{-1\\}$。条件 $0 \\in \\{-1\\}$ 不成立。\n\n情况 2: $x = \\frac{2}{3}$。\n在这一点，$f_2(x)$ 和 $f_3(x)$ 是有效的。$I(\\frac{2}{3}) = \\{2, 3\\}$。\n次微分是相应梯度的凸包：\n$\\partial f(\\frac{2}{3}) = \\text{conv}\\{\\nabla f_2(x), \\nabla f_3(x)\\} = \\text{conv}\\{-1, \\frac{1}{2}\\}$。\n这是一个闭区间 $[-1, \\frac{1}{2}]$。\n条件 $0 \\in [-1, \\frac{1}{2}]$ 成立。因此，$x^{\\star} = \\frac{2}{3}$ 是一个满足最优性条件的点。\n\n情况 3: $\\frac{2}{3}  x  \\frac{8}{5}$。\n在此区域，$f_3(x) = \\frac{1}{2}x$ 是最大函数。因此，$I(x) = \\{3\\}$。\n$\\partial f(x) = \\{\\nabla f_3(x)\\} = \\{\\frac{1}{2}\\}$。条件 $0 \\in \\{\\frac{1}{2}\\}$ 不成立。\n\n情况 4: $x = \\frac{8}{5}$。\n在这一点，$f_1(x)$ 和 $f_3(x)$ 是有效的。$I(\\frac{8}{5}) = \\{1, 3\\}$。\n次微分是相应梯度的凸包：\n$\\partial f(\\frac{8}{5}) = \\text{conv}\\{\\nabla f_1(x), \\nabla f_3(x)\\} = \\text{conv}\\{3, \\frac{1}{2}\\}$。\n这是一个闭区间 $[\\frac{1}{2}, 3]$。\n条件 $0 \\in [\\frac{1}{2}, 3]$ 不成立。\n\n情况 5: $x > \\frac{8}{5}$。\n在此区域，$f_1(x) = 3x-4$ 是最大函数。因此，$I(x) = \\{1\\}$。\n$\\partial f(x) = \\{\\nabla f_1(x)\\} = \\{3\\}$。条件 $0 \\in \\{3\\}$ 不成立。\n\n通过检查所有可能的 $x$ 值，我们发现一阶最优性必要条件 $0 \\in \\partial f(x^{\\star})$ 仅在单一点 $x^{\\star} = \\frac{2}{3}$ 处满足。由于 $f(x)$ 是凸函数，这个点是该函数的唯一全局最小值点。",
            "answer": "$$\n\\boxed{\\frac{2}{3}}\n$$"
        }
    ]
}