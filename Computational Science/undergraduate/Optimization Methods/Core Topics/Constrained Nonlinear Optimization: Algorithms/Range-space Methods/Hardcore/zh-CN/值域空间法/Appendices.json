{
    "hands_on_practices": [
        {
            "introduction": "对于等式约束二次规划问题，范围空间方法通过从KKT（Karush-Kuhn-Tucker）条件中消去原始变量 $\\mathbf{x}$，将问题转化为一个关于拉格朗日乘子 $\\boldsymbol{\\lambda}$ 的简化线性系统。该方法的核心在于构建简化系统的系数矩阵 $S = AH^{-1}A^{\\top}$。这个基础练习  将指导你通过一个具体的例子，亲手计算这个关键矩阵，从而牢固掌握范围空间方法的基本操作。",
            "id": "3171154",
            "problem": "考虑一个等式约束二次规划问题，其目标函数为 $f(\\mathbf{x}) = \\frac{1}{2}\\mathbf{x}^{\\top}H\\mathbf{x}$，等式约束为 $A\\mathbf{x} = \\mathbf{b}$，其中 $H \\in \\mathbb{R}^{n \\times n}$ 是对称正定矩阵，$A \\in \\mathbb{R}^{m \\times n}$ 是满行秩矩阵。\n\n在值域空间法中，通过消去主变量来获得一个关于拉格朗日乘子的降维系统，其系数矩阵记为 $S$。\n\n构建一个示例实例，其中 $n = 5$，$m = 2$，海森矩阵 $H$ 是对角缩放的，约束矩阵 $A$ 形成分量的和，具体如下：\n- 令 $H = \\mathrm{diag}(1,\\,0.1,\\,10,\\,2,\\,0.5)$。\n- 令 $A \\in \\mathbb{R}^{2 \\times 5}$ 的第一行为 $[1,\\,1,\\,1,\\,0,\\,0]$，第二行为 $[0,\\,0,\\,1,\\,1,\\,1]$。\n\n从等式约束二次优化的基本原理出发，推导降维乘子系统，并计算此实例中矩阵 $S$ 的行列式。你的最终答案必须是一个实数值。请提供精确值，不要四舍五入。",
            "solution": "该问题是一个标准的等式约束二次规划（QP）问题，它被认为是有效的，因为它具有科学依据、是良定的，并且提供了求解矩阵 $S$ 行列式所需的所有信息。\n\n优化问题表述如下：\n$$\n\\begin{aligned}\n\\text{minimize} \\quad  f(\\mathbf{x}) = \\frac{1}{2}\\mathbf{x}^{\\top}H\\mathbf{x} \\\\\n\\text{subject to} \\quad  A\\mathbf{x} = \\mathbf{b}\n\\end{aligned}\n$$\n其中 $\\mathbf{x} \\in \\mathbb{R}^n$，$H \\in \\mathbb{R}^{n \\times n}$ 是对称正定矩阵，$A \\in \\mathbb{R}^{m \\times n}$ 具有满行秩，$\\mathbf{b} \\in \\mathbb{R}^m$。\n\n该问题的拉格朗日函数为：\n$$ \\mathcal{L}(\\mathbf{x}, \\boldsymbol{\\lambda}) = \\frac{1}{2}\\mathbf{x}^{\\top}H\\mathbf{x} + \\boldsymbol{\\lambda}^{\\top}(A\\mathbf{x} - \\mathbf{b}) $$\n其中 $\\boldsymbol{\\lambda} \\in \\mathbb{R}^m$ 是拉格朗日乘子向量。\n\n最优性的一阶必要条件（Karush-Kuhn-Tucker 或 KKT 条件）是通过将拉格朗日函数相对于 $\\mathbf{x}$ 和 $\\boldsymbol{\\lambda}$ 的梯度设为零得到的：\n$$ \\nabla_{\\mathbf{x}} \\mathcal{L} = H\\mathbf{x} + A^{\\top}\\boldsymbol{\\lambda} = \\mathbf{0} $$\n$$ \\nabla_{\\boldsymbol{\\lambda}} \\mathcal{L} = A\\mathbf{x} - \\mathbf{b} = \\mathbf{0} $$\n这是一个线性方程组，通常写成矩阵形式：\n$$ \\begin{pmatrix} H  A^{\\top} \\\\ A  0 \\end{pmatrix} \\begin{pmatrix} \\mathbf{x} \\\\ \\boldsymbol{\\lambda} \\end{pmatrix} = \\begin{pmatrix} \\mathbf{0} \\\\ \\mathbf{b} \\end{pmatrix} $$\n\n值域空间法首先消去主变量 $\\mathbf{x}$ 来求解对偶变量 $\\boldsymbol{\\lambda}$。根据第一个KKT方程，$H\\mathbf{x} = -A^{\\top}\\boldsymbol{\\lambda}$。由于给定 $H$ 是对称正定的，因此它是可逆的。我们可以将 $\\mathbf{x}$ 表示为：\n$$ \\mathbf{x} = -H^{-1}A^{\\top}\\boldsymbol{\\lambda} $$\n将 $\\mathbf{x}$ 的这个表达式代入第二个 KKT 方程（可行性约束）中，得到：\n$$ A(-H^{-1}A^{\\top}\\boldsymbol{\\lambda}) - \\mathbf{b} = \\mathbf{0} $$\n$$ -(AH^{-1}A^{\\top})\\boldsymbol{\\lambda} = \\mathbf{b} $$\n这可以重写为关于拉格朗日乘子的降维系统：\n$$ (AH^{-1}A^{\\top})\\boldsymbol{\\lambda} = -\\mathbf{b} $$\n这个降维系统的系数矩阵记为 $S$。因此，\n$$ S = AH^{-1}A^{\\top} $$\n问题要求我们计算给定实例中该矩阵的行列式 $\\det(S)$。\n\n给定的矩阵是：\n- $H = \\mathrm{diag}(1,\\,0.1,\\,10,\\,2,\\,0.5)$。为了精确计算，我们可以将小数值写成分数形式：$H = \\mathrm{diag}(1, \\frac{1}{10}, 10, 2, \\frac{1}{2})$。\n- $A \\in \\mathbb{R}^{2 \\times 5}$ 由 $A = \\begin{pmatrix} 1  1  1  0  0 \\\\ 0  0  1  1  1 \\end{pmatrix}$ 给出。\n\n首先，我们计算 $H$ 的逆矩阵。由于 $H$ 是一个对角矩阵，其逆矩阵 $H^{-1}$ 也是一个对角矩阵，其对角元素是 $H$ 相应元素的倒数：\n$$ H^{-1} = \\mathrm{diag}(1^{-1}, (\\frac{1}{10})^{-1}, 10^{-1}, 2^{-1}, (\\frac{1}{2})^{-1}) = \\mathrm{diag}(1, 10, \\frac{1}{10}, \\frac{1}{2}, 2) $$\n用数值表示，即为 $H^{-1} = \\mathrm{diag}(1, 10, 0.1, 0.5, 2)$。\n\n接下来，我们计算 $A$ 的转置：\n$$ A^{\\top} = \\begin{pmatrix} 1  0 \\\\ 1  0 \\\\ 1  1 \\\\ 0  1 \\\\ 0  1 \\end{pmatrix} $$\n\n现在，我们可以计算矩阵 $S = AH^{-1}A^{\\top}$。让我们先计算乘积 $H^{-1}A^{\\top}$：\n$$ H^{-1}A^{\\top} = \\begin{pmatrix} 1  0  0  0  0 \\\\ 0  10  0  0  0 \\\\ 0  0  \\frac{1}{10}  0  0 \\\\ 0  0  0  \\frac{1}{2}  0 \\\\ 0  0  0  0  2 \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 1  0 \\\\ 1  1 \\\\ 0  1 \\\\ 0  1 \\end{pmatrix} = \\begin{pmatrix} 1 \\cdot 1  1 \\cdot 0 \\\\ 10 \\cdot 1  10 \\cdot 0 \\\\ \\frac{1}{10} \\cdot 1  \\frac{1}{10} \\cdot 1 \\\\ \\frac{1}{2} \\cdot 0  \\frac{1}{2} \\cdot 1 \\\\ 2 \\cdot 0  2 \\cdot 1 \\end{pmatrix} = \\begin{pmatrix} 1  0 \\\\ 10  0 \\\\ \\frac{1}{10}  \\frac{1}{10} \\\\ 0  \\frac{1}{2} \\\\ 0  2 \\end{pmatrix} $$\n\n最后，我们用 $A$ 左乘这个结果以获得 $S$：\n$$ S = A(H^{-1}A^{\\top}) = \\begin{pmatrix} 1  1  1  0  0 \\\\ 0  0  1  1  1 \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 10  0 \\\\ \\frac{1}{10}  \\frac{1}{10} \\\\ 0  \\frac{1}{2} \\\\ 0  2 \\end{pmatrix} $$\n得到的矩阵 $S$ 是一个 $2 \\times 2$ 矩阵。其元素为：\n$$ S_{11} = (1)(1) + (1)(10) + (1)(\\frac{1}{10}) + (0)(0) + (0)(0) = 1 + 10 + \\frac{1}{10} = 11 + \\frac{1}{10} = \\frac{111}{10} $$\n$$ S_{12} = (1)(0) + (1)(0) + (1)(\\frac{1}{10}) + (0)(\\frac{1}{2}) + (0)(2) = \\frac{1}{10} $$\n$$ S_{21} = (0)(1) + (0)(10) + (1)(\\frac{1}{10}) + (1)(0) + (1)(0) = \\frac{1}{10} $$\n$$ S_{22} = (0)(0) + (0)(0) + (1)(\\frac{1}{10}) + (1)(\\frac{1}{2}) + (1)(2) = \\frac{1}{10} + \\frac{5}{10} + \\frac{20}{10} = \\frac{26}{10} $$\n所以矩阵 $S$ 是：\n$$ S = \\begin{pmatrix} \\frac{111}{10}  \\frac{1}{10} \\\\ \\frac{1}{10}  \\frac{26}{10} \\end{pmatrix} $$\n一个 $2 \\times 2$ 矩阵 $\\begin{pmatrix} a  b \\\\ c  d \\end{pmatrix}$ 的行列式是 $ad - bc$。因此，$S$ 的行列式是：\n$$ \\det(S) = \\left(\\frac{111}{10}\\right)\\left(\\frac{26}{10}\\right) - \\left(\\frac{1}{10}\\right)\\left(\\frac{1}{10}\\right) $$\n$$ \\det(S) = \\frac{111 \\times 26}{100} - \\frac{1}{100} $$\n让我们计算乘积 $111 \\times 26$：\n$$ 111 \\times 26 = 111 \\times (20 + 6) = 2220 + 666 = 2886 $$\n将此结果代回行列式表达式中：\n$$ \\det(S) = \\frac{2886}{100} - \\frac{1}{100} = \\frac{2885}{100} = 28.85 $$\n行列式是一个精确的实数值。",
            "answer": "$$\\boxed{28.85}$$"
        },
        {
            "introduction": "在数值计算中，矩阵的条件数是衡量求解线性系统稳定性的重要指标。一个自然的问题是：如果原始问题中的Hessian矩阵 $H$ 是病态的（ill-conditioned），那么范围空间法得到的简化系统矩阵 $S$ 是否也一定是病态的？这个练习  通过一个精心设计的例子揭示了答案。你将发现，约束与目标函数曲率之间的特定几何关系可以使得简化系统表现出优异的数值特性，这突显了范围空间法的一个深刻优势。",
            "id": "3171127",
            "problem": "考虑等式约束二次规划问题：最小化 $f(x) = \\tfrac{1}{2} x^{\\top} H x$，约束为 $A x = b$，其中 $H \\in \\mathbb{R}^{n \\times n}$ 是对称正定 (SPD) 矩阵，且 $A \\in \\mathbb{R}^{m \\times n}$ 是行满秩矩阵。值域空间法将 Karush–Kuhn–Tucker (KKT) 系统简化为一个关于拉格朗日乘子的线性系统。仅从 KKT 最优性条件和 2-范数条件数的定义出发，执行此简化过程，得到简化系统及其系统矩阵。然后，对于以下特定构造，评估该简化系统的条件状况。该构造的设计使得 $H$ 是病态的，但由于矩阵 $A$ 的行与 $H$ 的主特征向量对齐，简化后的系统矩阵是良态的。\n\n构造：令 $n = 3$，$m = 2$，并选择\n$$\nH = \\begin{pmatrix}\n10^{6}  0  0 \\\\\n0  10^{6}  0 \\\\\n0  0  1\n\\end{pmatrix}, \\quad\nA = \\begin{pmatrix}\n1  0  0 \\\\\n0  1  0\n\\end{pmatrix}, \\quad\nb \\in \\mathbb{R}^{2} \\text{ 为任意向量。}\n$$\n你可以假设 $H$ 是 SPD 矩阵，并且一个 SPD 矩阵 $M$ 的 2-范数条件数为 $\\kappa_{2}(M) = \\lambda_{\\max}(M) / \\lambda_{\\min}(M)$，其中 $\\lambda_{\\max}(M)$ 和 $\\lambda_{\\min}(M)$ 分别是 $M$ 的最大和最小特征值。未经推导，不得使用其他任何专门公式。\n\n任务：\n1. 从 KKT 条件出发，消去原始变量，得到关于乘子的简化线性系统，并确定其系统矩阵。\n2. 使用上述构造，计算简化系统矩阵的 2-范数条件数，并利用特征向量对齐解释为什么即使 $H$ 是病态的，该矩阵却是良态的。\n\n对于此构造，简化系统矩阵的 2-范数条件数的值是多少？请提供一个精确值，不要四舍五入。将你的最终答案表示为一个不带单位的实数。",
            "solution": "该问题要求推导一个等式约束二次规划的简化系统矩阵，并为一个特定的构造计算其条件数。\n\n### 步骤 1：简化系统的推导\n\n该问题是一个等式约束二次规划 (EQP)，其形式如下：\n$$\n\\text{最小化 } f(x) = \\frac{1}{2} x^{\\top} H x \\quad \\text{约束为 } Ax = b\n$$\n其中 $x \\in \\mathbb{R}^{n}$，$H \\in \\mathbb{R}^{n \\times n}$ 是对称正定 (SPD) 矩阵，$A \\in \\mathbb{R}^{m \\times n}$ 是行满秩矩阵 ($m \\le n$)，且 $b \\in \\mathbb{R}^{m}$。\n\n该问题的拉格朗日函数为：\n$$\nL(x, \\lambda) = f(x) + \\lambda^{\\top}(Ax - b) = \\frac{1}{2} x^{\\top} H x + \\lambda^{\\top}Ax - \\lambda^{\\top}b\n$$\n其中 $\\lambda \\in \\mathbb{R}^{m}$ 是拉格朗日乘子向量。\n\n通过将拉格朗日函数关于 $x$ 和 $\\lambda$ 的梯度设为零，可得一阶 Karush–Kuhn–Tucker (KKT) 最优性条件：\n1.  $\\nabla_{x} L(x, \\lambda) = Hx + A^{\\top}\\lambda = 0$ (平稳性)\n2.  $\\nabla_{\\lambda} L(x, \\lambda) = Ax - b = 0$ (原始可行性)\n\n这两个条件构成一个分块线性系统，称为 KKT 系统：\n$$\n\\begin{pmatrix}\nH  A^{\\top} \\\\\nA  0\n\\end{pmatrix}\n\\begin{pmatrix}\nx \\\\\n\\lambda\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n0 \\\\\nb\n\\end{pmatrix}\n$$\n值域空间法通过消去原始变量 $x$ 来获得一个仅用对偶变量 $\\lambda$ 表示的更小的系统。\n\n从平稳性条件 $Hx + A^{\\top}\\lambda = 0$，我们可以用 $\\lambda$ 表示 $x$。因为给定 $H$ 是 SPD 矩阵，所以它是可逆的。因此：\n$$\nHx = -A^{\\top}\\lambda\n$$\n$$\nx = -H^{-1}A^{\\top}\\lambda\n$$\n现在，将这个 $x$ 的表达式代入原始可行性条件 $Ax = b$ 中：\n$$\nA(-H^{-1}A^{\\top}\\lambda) = b\n$$\n$$\n-(AH^{-1}A^{\\top})\\lambda = b\n$$\n$$\n(AH^{-1}A^{\\top})\\lambda = -b\n$$\n这就是关于拉格朗日乘子 $\\lambda$ 的简化线性系统。其系统矩阵（我们记为 $M_R$）是：\n$$\nM_R = AH^{-1}A^{\\top}\n$$\n这个矩阵是一个 $m \\times m$ 的矩阵。它也是 SPD 的，因为 $H^{-1}$ 是 SPD 的（由于 $H$ 是 SPD 的）并且 $A$ 是行满秩的。这就完成了第一个任务。\n\n### 步骤 2：对特定构造的分析\n\n给定 $n=3$ 和 $m=2$ 的特定矩阵如下：\n$$\nH = \\begin{pmatrix}\n10^{6}  0  0 \\\\\n0  10^{6}  0 \\\\\n0  0  1\n\\end{pmatrix}, \\quad\nA = \\begin{pmatrix}\n1  0  0 \\\\\n0  1  0\n\\end{pmatrix}\n$$\n首先，我们计算 $H$ 的逆矩阵。由于 $H$ 是一个对角矩阵，其逆矩阵是以原对角元素倒数为对角元素的对角矩阵：\n$$\nH^{-1} = \\begin{pmatrix}\n10^{-6}  0  0 \\\\\n0  10^{-6}  0 \\\\\n0  0  1\n\\end{pmatrix}\n$$\n接下来，我们计算简化系统矩阵 $M_R = AH^{-1}A^{\\top}$。$A$ 的转置是：\n$$\nA^{\\top} = \\begin{pmatrix}\n1  0 \\\\\n0  1 \\\\\n0  0\n\\end{pmatrix}\n$$\n现在我们进行矩阵乘法：\n$$\nM_R = AH^{-1}A^{\\top} = \\begin{pmatrix}\n1  0  0 \\\\\n0  1  0\n\\end{pmatrix}\n\\begin{pmatrix}\n10^{-6}  0  0 \\\\\n0  10^{-6}  0 \\\\\n0  0  1\n\\end{pmatrix}\n\\begin{pmatrix}\n1  0 \\\\\n0  1 \\\\\n0  0\n\\end{pmatrix}\n$$\n首先，计算乘积 $AH^{-1}$：\n$$\nAH^{-1} = \\begin{pmatrix}\n1  0  0 \\\\\n0  1  0\n\\end{pmatrix}\n\\begin{pmatrix}\n10^{-6}  0  0 \\\\\n0  10^{-6}  0 \\\\\n0  0  1\n\\end{pmatrix} = \\begin{pmatrix}\n10^{-6}  0  0 \\\\\n0  10^{-6}  0\n\\end{pmatrix}\n$$\n现在，乘以 $A^{\\top}$：\n$$\nM_R = (AH^{-1})A^{\\top} = \\begin{pmatrix}\n10^{-6}  0  0 \\\\\n0  10^{-6}  0\n\\end{pmatrix}\n\\begin{pmatrix}\n1  0 \\\\\n0  1 \\\\\n0  0\n\\end{pmatrix} = \\begin{pmatrix}\n10^{-6}  0 \\\\\n0  10^{-6}\n\\end{pmatrix}\n$$\n所以，简化系统矩阵是 $M_R = 10^{-6} I_{2}$，其中 $I_2$ 是 $2 \\times 2$ 的单位矩阵。\n\n为了计算 2-范数条件数 $\\kappa_2(M_R)$，我们使用 SPD 矩阵的公式：$\\kappa_2(M_R) = \\lambda_{\\max}(M_R) / \\lambda_{\\min}(M_R)$。对角矩阵的特征值就是其对角线上的元素。$M_R$ 的特征值均为 $10^{-6}$。\n$$\n\\lambda_{\\max}(M_R) = 10^{-6}\n$$\n$$\n\\lambda_{\\min}(M_R) = 10^{-6}\n$$\n因此，条件数为：\n$$\n\\kappa_2(M_R) = \\frac{10^{-6}}{10^{-6}} = 1\n$$\n\n### 关于条件状况的解释\n\n$H$ 本身的条件状况很差。$H$ 的特征值是其对角线元素：$\\lambda_1 = 10^6$，$\\lambda_2 = 10^6$ 和 $\\lambda_3 = 1$。$H$ 的条件数是：\n$$\n\\kappa_2(H) = \\frac{\\lambda_{\\max}(H)}{\\lambda_{\\min}(H)} = \\frac{10^6}{1} = 10^6\n$$\n$10^6$ 的条件数表明 $H$ 是病态的。然而，简化系统矩阵 $M_R$ 却是完全良态的，其条件数为 $\\kappa_2(M_R) = 1$。\n\n这个有利的结果是由于约束矩阵 $A$ 与 Hessian 矩阵 $H$ 的特征向量之间的特殊对齐关系。对角矩阵 $H$ 的特征向量是标准基向量：\n- $v_1 = (1, 0, 0)^{\\top}$ 对应于 $\\lambda = 10^6$。\n- $v_2 = (0, 1, 0)^{\\top}$ 对应于 $\\lambda = 10^6$。\n- $v_3 = (0, 0, 1)^{\\top}$ 对应于 $\\lambda = 1$。\n\n约束矩阵 $A$ 的行是 $a_1^{\\top} = (1, 0, 0)$ 和 $a_2^{\\top} = (0, 1, 0)$。$A^{\\top}$ 的值域，记作 $\\text{range}(A^{\\top})$，由 $A^{\\top}$ 的列向量张成，而这些列向量恰好是特征向量 $v_1$ 和 $v_2$。这个子空间 $\\text{span}\\{v_1, v_2\\}$ 是 $H$ 对应于大特征值 $\\lambda=10^6$ 的特征空间。\n\n矩阵 $M_R = AH^{-1}A^{\\top}$ 实际上衡量了 $H^{-1}$ 在由约束定义的子空间（即 $\\text{range}(A^{\\top})$）上的作用。对于任何向量 $y \\in \\mathbb{R}^2$，向量 $A^{\\top}y$ 位于 $\\text{range}(A^{\\top})$ 中。由于这个子空间是 $H$（因此也是 $H^{-1}$）的一个特征空间，所以 $H^{-1}$ 对 $\\text{range}(A^{\\top})$ 中任何向量 $z$ 的作用，就是简单地乘以 $H^{-1}$ 相应的特征值，即 $1/10^6 = 10^{-6}$。\n$$\nH^{-1}(A^{\\top}y) = 10^{-6}(A^{\\top}y)\n$$\n将此代入 $M_R$ 的表达式中：\n$$\nM_R y = A (H^{-1} A^{\\top} y) = A(10^{-6} A^{\\top} y) = 10^{-6} (AA^{\\top})y\n$$\n我们计算 $AA^{\\top}$：\n$$\nAA^{\\top} = \\begin{pmatrix}\n1  0  0 \\\\\n0  1  0\n\\end{pmatrix}\n\\begin{pmatrix}\n1  0 \\\\\n0  1 \\\\\n0  0\n\\end{pmatrix} = \\begin{pmatrix}\n1  0 \\\\\n0  1\n\\end{pmatrix} = I_2\n$$\n因此，$M_R y = 10^{-6} I_2 y$，这意味着 $M_R = 10^{-6} I_2$。\n\n$H$ 的病态性源于它在特征空间 $\\text{span}\\{v_1, v_2\\}$ 与特征空间 $\\text{span}\\{v_3\\}$ 中对向量的缩放方式存在巨大差异。然而，$A$ 的结构确保了简化系统矩阵 $M_R$ 只“看到” $H^{-1}$ 在由 $A$ 的行张成的单一特征空间内的均匀缩放行为。$H^{-1}$ 的另一种动态模式（与特征值 $1$ 和特征向量 $v_3$ 相关）与 $A$ 的零空间有关，其影响在乘积 $AH^{-1}A^{\\top}$ 中被完全滤除。因此，$M_R$ 是单位矩阵的标量倍数，是完全良态的。\n\n对于此构造，简化系统矩阵的 2-范数条件数的值恰好是 $1$。",
            "answer": "$$\n\\boxed{1}\n$$"
        },
        {
            "introduction": "在许多实际的优化算法（如有效集法）中，约束条件是在迭代过程中动态添加或移除的。如果每次约束集发生变化都从头重新计算范围空间矩阵 $S$ 及其逆矩阵，效率会非常低下。这个更高级的练习  将向你展示一种更高效的策略：当增加一个新的约束时，如何利用分块矩阵求逆或Sherman-Morrison-Woodbury公式来快速更新 $S^{-1}$。这个实践将理论与高效算法实现联系起来，揭示了范围空间法在迭代求解器中的实际应用威力。",
            "id": "3171093",
            "problem": "在等式约束二次规划中，值域空间法将一个Karush–Kuhn–Tucker (KKT) 系统简化为求解以对称正定矩阵 $S = A H^{-1} A^{\\top}$ 为系数的线性系统，其中 $H \\in \\mathbb{R}^{n \\times n}$ 是对称正定矩阵，$A \\in \\mathbb{R}^{m \\times n}$ 具有行满秩，约束条件为 $A x = b$。考虑通过附加一个新的等式约束 $a^{\\top} x = b_{+}$ 来扩充活动集，方法是将 $a^{\\top}$ 堆叠在 $A$ 的下方以形成增广矩阵 $A_{+} \\in \\mathbb{R}^{(m+1) \\times n}$。从值域空间矩阵的核心定义和标准分块矩阵恒等式出发，推导增广值域空间矩阵 $S_{+} = A_{+} H^{-1} A_{+}^{\\top}$ 的逆矩阵的表达式（用 $S^{-1}$、$A$、$H$ 和 $a$ 表示），并确定出现在 $S_{+}^{-1}$ 右下角的标量。\n\n然后，对于具体数据\n$$\nH = \\operatorname{diag}(2,\\,3,\\,6), \\quad\nA = \\begin{pmatrix}\n1  1  0 \\\\\n0  1  2\n\\end{pmatrix}, \\quad\na = \\begin{pmatrix} 1 \\\\ -1 \\\\ 1 \\end{pmatrix},\n$$\n计算 $S_{+}^{-1}$ 右下角元素的精确值（无四舍五入）。请以一个无单位的实数形式给出你的最终答案。",
            "solution": "对该问题的分析将分两部分进行。首先，将对增广值域空间矩阵的逆 $S_{+}^{-1}$ 进行通用符号推导。其次，将使用提供的具体数值数据来计算 $S_{+}^{-1}$ 右下角元素的值。\n\n### 第1部分：$S_{+}^{-1}$的符号推导\n\n问题将初始值域空间矩阵定义为 $S = A H^{-1} A^{\\top}$，其中 $H \\in \\mathbb{R}^{n \\times n}$ 是对称正定矩阵，$A \\in \\mathbb{R}^{m \\times n}$ 具有行满秩。这些条件保证了 $S \\in \\mathbb{R}^{m \\times m}$ 是对称正定的，因此是可逆的。\n\n引入一个新的等式约束，得到一个增广矩阵 $A_{+}$，它通过将新的约束行 $a^{\\top}$ 附加到 $A$ 上形成：\n$$\nA_{+} = \\begin{pmatrix} A \\\\ a^{\\top} \\end{pmatrix} \\in \\mathbb{R}^{(m+1) \\times n}\n$$\n相应的增广值域空间矩阵 $S_{+}$ 定义为：\n$$\nS_{+} = A_{+} H^{-1} A_{+}^{\\top}\n$$\n我们可以通过代入 $A_{+}$ 的分块结构，将 $S_{+}$ 表示为 $2 \\times 2$ 分块矩阵形式：\n$$\nS_{+} = \\begin{pmatrix} A \\\\ a^{\\top} \\end{pmatrix} H^{-1} \\begin{pmatrix} A^{\\top}  a \\end{pmatrix}\n$$\n进行分块矩阵乘法，我们得到：\n$$\nS_{+} = \\begin{pmatrix} A H^{-1} A^{\\top}  A H^{-1} a \\\\ a^{\\top} H^{-1} A^{\\top}  a^{\\top} H^{-1} a \\end{pmatrix}\n$$\n我们可以识别这个矩阵中的各个分块。左上角的分块是原始矩阵 $S = A H^{-1} A^{\\top}$。我们定义以下量：\n- 向量 $u = A H^{-1} a \\in \\mathbb{R}^{m \\times 1}$。\n- 标量 $\\delta = a^{\\top} H^{-1} a \\in \\mathbb{R}$。\n\n由于 $H$ 是对称的，$H^{-1}$ 也是对称的。因此，左下角的分块是 $(a^{\\top} H^{-1} A^{\\top}) = (A (H^{-1})^{\\top} a)^{\\top} = (A H^{-1} a)^{\\top} = u^{\\top}$。\n因此，$S_{+}$ 可以简洁地写成：\n$$\nS_{+} = \\begin{pmatrix} S  u \\\\ u^{\\top}  \\delta \\end{pmatrix}\n$$\n为了求逆矩阵 $S_{+}^{-1}$，我们使用 $2 \\times 2$ 分块矩阵的求逆公式。该公式依赖于左上角分块 $S$ 或右下角分块 $\\delta$ 的舒尔补。令 $\\gamma$ 为 $S$ 的舒尔补，在本例中它是一个标量：\n$$\n\\gamma = \\delta - u^{\\top} S^{-1} u\n$$\n为了使 $S_{+}^{-1}$ 存在，$S_{+}$ 必须是非奇异的。这要求新的约束 $a^{\\top}$ 与 $A$ 的行向量线性无关，这保证了 $\\gamma \\neq 0$。$S_{+}^{-1}$ 的逆则由分块矩阵求逆公式（也称为分块求逆公式）给出：\n$$\nS_{+}^{-1} = \\begin{pmatrix} S^{-1} + S^{-1} u \\gamma^{-1} u^{\\top} S^{-1}  -S^{-1} u \\gamma^{-1} \\\\ -\\gamma^{-1} u^{\\top} S^{-1}  \\gamma^{-1} \\end{pmatrix}\n$$\n这就是增广值域空间矩阵的逆的通用表达式。出现在 $S_{+}^{-1}$ 右下角的标量是 $\\gamma^{-1}$。\n$$\n\\text{$S_{+}^{-1}$ 的右下角元素} = \\gamma^{-1} = (\\delta - u^{\\top} S^{-1} u)^{-1} = \\left( (a^{\\top} H^{-1} a) - (a^{\\top} H^{-1} A^{\\top}) (A H^{-1} A^{\\top})^{-1} (A H^{-1} a) \\right)^{-1}\n$$\n\n### 第2部分：数值计算\n\n我们得到以下具体数据：\n$$\nH = \\operatorname{diag}(2,\\,3,\\,6) = \\begin{pmatrix} 2  0  0 \\\\ 0  3  0 \\\\ 0  0  6 \\end{pmatrix}, \\quad\nA = \\begin{pmatrix} 1  1  0 \\\\ 0  1  2 \\end{pmatrix}, \\quad\na = \\begin{pmatrix} 1 \\\\ -1 \\\\ 1 \\end{pmatrix}\n$$\n为了找到 $S_{+}^{-1}$ 的右下角元素，我们需要计算 $\\gamma^{-1}$。我们按步骤进行。\n\n1.  **计算 $H^{-1}$**：由于 $H$ 是一个对角矩阵，其逆矩阵是其对角元素倒数构成的对角矩阵。\n    $$\n    H^{-1} = \\operatorname{diag}\\left(\\frac{1}{2},\\,\\frac{1}{3},\\,\\frac{1}{6}\\right) = \\begin{pmatrix} \\frac{1}{2}  0  0 \\\\ 0  \\frac{1}{3}  0 \\\\ 0  0  \\frac{1}{6} \\end{pmatrix}\n    $$\n\n2.  **计算 $\\delta = a^{\\top} H^{-1} a$**：\n    首先，计算 $H^{-1}a$：\n    $$\n    H^{-1}a = \\begin{pmatrix} \\frac{1}{2}  0  0 \\\\ 0  \\frac{1}{3}  0 \\\\ 0  0  \\frac{1}{6} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ -1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2} \\\\ -\\frac{1}{3} \\\\ \\frac{1}{6} \\end{pmatrix}\n    $$\n    然后，计算点积 $a^{\\top}(H^{-1}a)$：\n    $$\n    \\delta = \\begin{pmatrix} 1  -1  1 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{2} \\\\ -\\frac{1}{3} \\\\ \\frac{1}{6} \\end{pmatrix} = (1)\\left(\\frac{1}{2}\\right) + (-1)\\left(-\\frac{1}{3}\\right) + (1)\\left(\\frac{1}{6}\\right) = \\frac{1}{2} + \\frac{1}{3} + \\frac{1}{6} = \\frac{3+2+1}{6} = \\frac{6}{6} = 1\n    $$\n\n3.  **计算 $u = A H^{-1} a$**：\n    使用先前计算的 $H^{-1}a$：\n    $$\n    u = \\begin{pmatrix} 1  1  0 \\\\ 0  1  2 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{2} \\\\ -\\frac{1}{3} \\\\ \\frac{1}{6} \\end{pmatrix} = \\begin{pmatrix} (1)(\\frac{1}{2}) + (1)(-\\frac{1}{3}) + (0)(\\frac{1}{6}) \\\\ (0)(\\frac{1}{2}) + (1)(-\\frac{1}{3}) + (2)(\\frac{1}{6}) \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2} - \\frac{1}{3} \\\\ -\\frac{1}{3} + \\frac{1}{3} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{6} \\\\ 0 \\end{pmatrix}\n    $$\n    所以，$u^{\\top} = \\begin{pmatrix} \\frac{1}{6}  0 \\end{pmatrix}$。\n\n4.  **计算 $S^{-1} = (A H^{-1} A^{\\top})^{-1}$**：\n    首先，计算 $S = A H^{-1} A^{\\top}$。\n    $$\n    A H^{-1} = \\begin{pmatrix} 1  1  0 \\\\ 0  1  2 \\end{pmatrix} \\begin{pmatrix} \\frac{1}{2}  0  0 \\\\ 0  \\frac{1}{3}  0 \\\\ 0  0  \\frac{1}{6} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2}  \\frac{1}{3}  0 \\\\ 0  \\frac{1}{3}  \\frac{2}{6} \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2}  \\frac{1}{3}  0 \\\\ 0  \\frac{1}{3}  \\frac{1}{3} \\end{pmatrix}\n    $$\n    $$\n    S = (A H^{-1}) A^{\\top} = \\begin{pmatrix} \\frac{1}{2}  \\frac{1}{3}  0 \\\\ 0  \\frac{1}{3}  \\frac{1}{3} \\end{pmatrix} \\begin{pmatrix} 1  0 \\\\ 1  1 \\\\ 0  2 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{2}(1) + \\frac{1}{3}(1)  \\frac{1}{2}(0) + \\frac{1}{3}(1) \\\\ \\frac{1}{3}(1)  \\frac{1}{3}(1) + \\frac{1}{3}(2) \\end{pmatrix} = \\begin{pmatrix} \\frac{5}{6}  \\frac{1}{3} \\\\ \\frac{1}{3}  1 \\end{pmatrix}\n    $$\n    现在，计算逆矩阵 $S^{-1}$。$S$ 的行列式是：\n    $$\n    \\det(S) = \\left(\\frac{5}{6}\\right)(1) - \\left(\\frac{1}{3}\\right)\\left(\\frac{1}{3}\\right) = \\frac{5}{6} - \\frac{1}{9} = \\frac{15 - 2}{18} = \\frac{13}{18}\n    $$\n    逆矩阵是：\n    $$\n    S^{-1} = \\frac{1}{\\det(S)} \\begin{pmatrix} 1  -\\frac{1}{3} \\\\ -\\frac{1}{3}  \\frac{5}{6} \\end{pmatrix} = \\frac{18}{13} \\begin{pmatrix} 1  -\\frac{1}{3} \\\\ -\\frac{1}{3}  \\frac{5}{6} \\end{pmatrix} = \\begin{pmatrix} \\frac{18}{13}  -\\frac{6}{13} \\\\ -\\frac{6}{13}  \\frac{15}{13} \\end{pmatrix}\n    $$\n\n5.  **计算 $u^{\\top} S^{-1} u$**：\n    $$\n    u^{\\top} S^{-1} u = \\begin{pmatrix} \\frac{1}{6}  0 \\end{pmatrix} \\begin{pmatrix} \\frac{18}{13}  -\\frac{6}{13} \\\\ -\\frac{6}{13}  \\frac{15}{13} \\end{pmatrix} \\begin{pmatrix} \\frac{1}{6} \\\\ 0 \\end{pmatrix}\n    $$\n    让我们先计算 $S^{-1}u$：\n    $$\n    S^{-1}u = \\begin{pmatrix} \\frac{18}{13}  -\\frac{6}{13} \\\\ -\\frac{6}{13}  \\frac{15}{13} \\end{pmatrix} \\begin{pmatrix} \\frac{1}{6} \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} \\frac{18}{13 \\cdot 6} \\\\ -\\frac{6}{13 \\cdot 6} \\end{pmatrix} = \\begin{pmatrix} \\frac{3}{13} \\\\ -\\frac{1}{13} \\end{pmatrix}\n    $$\n    现在乘以 $u^{\\top}$：\n    $$\n    u^{\\top} (S^{-1} u) = \\begin{pmatrix} \\frac{1}{6}  0 \\end{pmatrix} \\begin{pmatrix} \\frac{3}{13} \\\\ -\\frac{1}{13} \\end{pmatrix} = \\left(\\frac{1}{6}\\right)\\left(\\frac{3}{13}\\right) = \\frac{3}{78} = \\frac{1}{26}\n    $$\n\n6.  **计算 $\\gamma = \\delta - u^{\\top} S^{-1} u$**：\n    $$\n    \\gamma = 1 - \\frac{1}{26} = \\frac{25}{26}\n    $$\n\n7.  **计算最终答案 $\\gamma^{-1}$**：\n    $S_{+}^{-1}$ 的右下角元素是 $\\gamma^{-1}$。\n    $$\n    \\gamma^{-1} = \\left(\\frac{25}{26}\\right)^{-1} = \\frac{26}{25}\n    $$",
            "answer": "$$\\boxed{\\frac{26}{25}}$$"
        }
    ]
}