{
    "hands_on_practices": [
        {
            "introduction": "第一个练习将引导你完整地、一步步地走过零空间方法的整个流程。通过求解一个简单的二维二次规划问题 ，你将实践该技术的每一个关键环节：寻找一个可行点，计算零空间的基，构建并求解降维后的无约束问题，最后验证解的正确性。这个动手实践的例子旨在将零空间方法的抽象步骤变得具体而易于理解。",
            "id": "3158284",
            "problem": "考虑等式约束的二次优化问题\n$$\\min_{x \\in \\mathbb{R}^{2}} \\;\\; \\frac{1}{2} x^{\\top} H x + g^{\\top} x \\quad \\text{subject to} \\quad A x = b,$$\n其中数据为\n$$H = \\begin{pmatrix} 2 & 0 \\\\ 0 & 4 \\end{pmatrix}, \\quad g = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}, \\quad A = \\begin{pmatrix} 1 & 1 \\end{pmatrix}, \\quad b = 2.$$\n由于海森矩阵 $H$ 是对称正定的，该问题是严格凸的。使用基于线性代数和等式约束优化最优性条件的零空间法，执行以下步骤：\n\n1. 计算转置矩阵 $A^{\\top}$ 的完全 $QR$ 分解，即找到一个正交矩阵 $Q \\in \\mathbb{R}^{2 \\times 2}$ 和一个上三角（在矩形意义下）矩阵 $R \\in \\mathbb{R}^{2 \\times 1}$，使得 $A^{\\top} = Q R$。从 $Q$ 中，确定一个矩阵 $Z \\in \\mathbb{R}^{2 \\times 1}$，其列构成了 $A$ 的零空间的一组标准正交基。\n\n2. 找到满足 $A x_{0} = b$ 的任意可行点 $x_{0} \\in \\mathbb{R}^{2}$。\n\n3. 使用零空间参数化 $x = x_{0} + Z p$（其中 $p \\in \\mathbb{R}$），通过代入目标函数，推导出关于 $p$ 的降维一维二次型。求解最小化子 $p^{\\star}$，并计算相应的原始最小化子 $x^{\\star} = x_{0} + Z p^{\\star}$。\n\n4. 验证 $x^{\\star}$ 满足可行性条件 $A x^{\\star} = b$，并且零空间中的降维最优性条件成立。\n\n5. 独立地，通过 Karush–Kuhn–Tucker (KKT) 条件求解该等式约束问题。对于等式约束，KKT 条件断言了平稳性和可行性。构建并求解线性 KKT 系统以获得原始解。将其与零空间法得到的解进行比较。\n\n以行矩阵形式报告你的最终答案，即最优原始向量 $x^{\\star}$。无需四舍五入；请提供精确值。",
            "solution": "该问题是一个适定的等式约束二次规划问题。它在科学上是合理的、自洽的，并且求解所需的所有数据均已提供。海森矩阵 $H$ 是对称正定的，这保证了目标函数是严格凸的，并且存在唯一的最小化子。约束矩阵 $A$ 具有满行秩，确保了约束的可行性。因此，该问题是有效的，我们可以按照指定的步骤进行求解。\n\n目标是在约束 $A x = b$ 下最小化 $f(x) = \\frac{1}{2} x^{\\top} H x + g^{\\top} x$，给定数据为：\n$$H = \\begin{pmatrix} 2 & 0 \\\\ 0 & 4 \\end{pmatrix}, \\quad g = \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}, \\quad A = \\begin{pmatrix} 1 & 1 \\end{pmatrix}, \\quad b = 2$$\n\n**1. QR 分解与零空间基**\n\n我们计算 $A^{\\top}$ 的完全 $QR$ 分解。矩阵 $A^{\\top}$ 是 $\\mathbb{R}^{2}$ 中的一个列向量：\n$$A^{\\top} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$$\n我们需要找到一个正交矩阵 $Q \\in \\mathbb{R}^{2 \\times 2}$ 和一个上三角矩阵 $R \\in \\mathbb{R}^{2 \\times 1}$，使得 $A^{\\top} = QR$。我们可以使用 Gram-Schmidt 过程。设 $Q$ 的列为 $q_1$ 和 $q_2$。\n\n第一列 $q_1$ 是 $A^{\\top}$ 的归一化版本：\n$$\\|A^{\\top}\\| = \\sqrt{1^2 + 1^2} = \\sqrt{2}$$\n$$q_1 = \\frac{A^{\\top}}{\\|A^{\\top}\\|} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1/\\sqrt{2} \\\\ 1/\\sqrt{2} \\end{pmatrix}$$\n第二列 $q_2$ 必须是与 $q_1$ 正交的单位向量。我们可以选择：\n$$q_2 = \\begin{pmatrix} 1/\\sqrt{2} \\\\ -1/\\sqrt{2} \\end{pmatrix}$$\n我们可以验证 $q_1^{\\top} q_2 = 0$ 且 $\\|q_2\\|=1$。\n正交矩阵 $Q$ 由这些列构成：\n$$Q = \\begin{pmatrix} q_1 & q_2 \\end{pmatrix} = \\begin{pmatrix} 1/\\sqrt{2} & 1/\\sqrt{2} \\\\ 1/\\sqrt{2} & -1/\\sqrt{2} \\end{pmatrix}$$\n矩阵 $R$ 由 $R = Q^{\\top} A^{\\top}$ 给出：\n$$R = \\begin{pmatrix} 1/\\sqrt{2} & 1/\\sqrt{2} \\\\ 1/\\sqrt{2} & -1/\\sqrt{2} \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} \\frac{1}{\\sqrt{2}} + \\frac{1}{\\sqrt{2}} \\\\ \\frac{1}{\\sqrt{2}} - \\frac{1}{\\sqrt{2}} \\end{pmatrix} = \\begin{pmatrix} \\sqrt{2} \\\\ 0 \\end{pmatrix}$$\n这个 $R$ 是上三角矩阵。\n\n$A$ 的零空间，记作 $\\mathcal{N}(A)$，包含所有满足 $Az=0$ 的向量 $z$。对于 $A = \\begin{pmatrix} 1 & 1 \\end{pmatrix}$，这意味着 $z_1+z_2=0$。$Q$ 的列可以被划分为 $Q = \\begin{pmatrix} Y & Z \\end{pmatrix}$，其中 $Y$ 的列构成 $A^{\\top}$ 的值域空间的一组基，而 $Z$ 的列构成 $A$ 的零空间的一组基。在这里，$Y$ 对应于 $q_1$，$Z$ 对应于 $q_2$。\n$$Z = q_2 = \\begin{pmatrix} 1/\\sqrt{2} \\\\ -1/\\sqrt{2} \\end{pmatrix}$$\n我们验证 $AZ = \\begin{pmatrix} 1 & 1 \\end{pmatrix} \\begin{pmatrix} 1/\\sqrt{2} \\\\ -1/\\sqrt{2} \\end{pmatrix} = 1/\\sqrt{2} - 1/\\sqrt{2} = 0$。所以，$Z$ 确实构成了 $\\mathcal{N}(A)$ 的一组标准正交基。\n\n**2. 寻找可行点**\n\n我们需要找到线性系统 $Ax=b$ 的任意一个特解 $x_0$：\n$$\\begin{pmatrix} 1 & 1 \\end{pmatrix} \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix} = 2 \\quad \\implies \\quad x_1 + x_2 = 2$$\n一个简单的选择是 $x_1=1$, $x_2=1$。因此，一个可行点是：\n$$x_0 = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$$\n\n**3. 零空间参数化与求解**\n\n任何可行点 $x$ 都可以表示为一个特解 $x_0$ 与一个来自 $A$ 的零空间的向量之和。由于 $Z$ 是 $\\mathcal{N}(A)$ 的一组基，任何这样的向量都可以写成 $Zp$ 的形式，其中 $p \\in \\mathbb{R}$。\n$$x = x_0 + Zp = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} + \\begin{pmatrix} 1/\\sqrt{2} \\\\ -1/\\sqrt{2} \\end{pmatrix} p$$\n我们将其代入目标函数 $f(x)$，得到一个降维的二次函数 $q(p)$：\n$$f(x_0+Zp) = \\frac{1}{2}(x_0+Zp)^{\\top}H(x_0+Zp) + g^{\\top}(x_0+Zp)$$\n$$q(p) = \\frac{1}{2} p^{\\top}(Z^{\\top}HZ)p + (x_0^{\\top}HZ + g^{\\top}Z)p + (\\frac{1}{2}x_0^{\\top}Hx_0 + g^{\\top}x_0)$$\n由于 $p$ 是一个标量，我们可以将其写为：\n$$q(p) = \\frac{1}{2} (Z^{\\top}HZ) p^2 + (Z^{\\top}(Hx_0+g)) p + \\text{const.}$$\n我们计算系数。降维海森矩阵是：\n$$H Z = \\begin{pmatrix} 2 & 0 \\\\ 0 & 4 \\end{pmatrix} \\begin{pmatrix} 1/\\sqrt{2} \\\\ -1/\\sqrt{2} \\end{pmatrix} = \\begin{pmatrix} 2/\\sqrt{2} \\\\ -4/\\sqrt{2} \\end{pmatrix}$$\n$$Z^{\\top}HZ = \\begin{pmatrix} 1/\\sqrt{2} & -1/\\sqrt{2} \\end{pmatrix} \\begin{pmatrix} 2/\\sqrt{2} \\\\ -4/\\sqrt{2} \\end{pmatrix} = \\frac{2}{2} - \\frac{-4}{2} = 1+2 = 3$$\n降维梯度项的系数是：\n$$Hx_0 + g = \\begin{pmatrix} 2 & 0 \\\\ 0 & 4 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} + \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ 4 \\end{pmatrix} + \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} 3 \\\\ 3 \\end{pmatrix}$$\n$$Z^{\\top}(Hx_0+g) = \\begin{pmatrix} 1/\\sqrt{2} & -1/\\sqrt{2} \\end{pmatrix} \\begin{pmatrix} 3 \\\\ 3 \\end{pmatrix} = \\frac{3}{\\sqrt{2}} - \\frac{3}{\\sqrt{2}} = 0$$\n降维目标函数是：\n$$q(p) = \\frac{3}{2} p^2 + \\text{const.}$$\n为了找到最小化子 $p^{\\star}$，我们将关于 $p$ 的导数设为零：\n$$\\frac{d q}{d p} = 3p = 0 \\quad \\implies \\quad p^{\\star} = 0$$\n最优原始解 $x^{\\star}$ 于是为：\n$$x^{\\star} = x_0 + Z p^{\\star} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} + \\begin{pmatrix} 1/\\sqrt{2} \\\\ -1/\\sqrt{2} \\end{pmatrix} (0) = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$$\n\n**4. 验证**\n\n首先，我们检查 $x^{\\star}$ 的可行性：\n$$A x^{\\star} = \\begin{pmatrix} 1 & 1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = 1+1=2 = b$$\n约束得到满足。\n其次，我们检查降维最优性条件。降维问题的梯度 $\\nabla_p q(p) = (Z^{\\top}HZ)p + Z^{\\top}(Hx_0+g)$ 在 $p^{\\star}$ 处必须为零。这等价于检查原始目标函数在 $x^{\\star}$ 处的梯度 $\\nabla f(x^{\\star}) = Hx^{\\star}+g$ 与零空间正交，即 $Z^{\\top}(Hx^{\\star}+g)=0$。\n$$Hx^{\\star}+g = \\begin{pmatrix} 2 & 0 \\\\ 0 & 4 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} + \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} 2 \\\\ 4 \\end{pmatrix} + \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix} = \\begin{pmatrix} 3 \\\\ 3 \\end{pmatrix}$$\n$$Z^{\\top}(Hx^{\\star}+g) = \\begin{pmatrix} 1/\\sqrt{2} & -1/\\sqrt{2} \\end{pmatrix} \\begin{pmatrix} 3 \\\\ 3 \\end{pmatrix} = 0$$\n降维最优性条件成立。\n\n**5. 通过 KKT 条件求解**\n\n此等式约束问题的 Karush-Kuhn-Tucker (KKT) 条件是平稳性和原始可行性。设 $\\lambda \\in \\mathbb{R}$ 是单个约束的拉格朗日乘子。\n1. 平稳性：$\\nabla f(x) + A^{\\top}\\lambda = 0 \\implies Hx + g + A^{\\top}\\lambda = 0$\n2. 原始可行性：$Ax=b$\n\n这构成一个线性方程组：\n$$\\begin{pmatrix} H & A^{\\top} \\\\ A & 0 \\end{pmatrix} \\begin{pmatrix} x \\\\ \\lambda \\end{pmatrix} = \\begin{pmatrix} -g \\\\ b \\end{pmatrix}$$\n代入给定的矩阵和向量：\n$$\\begin{pmatrix} 2 & 0 & 1 \\\\ 0 & 4 & 1 \\\\ 1 & 1 & 0 \\end{pmatrix} \\begin{pmatrix} x_1 \\\\ x_2 \\\\ \\lambda \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ 1 \\\\ 2 \\end{pmatrix}$$\n这代表了以下方程组：\n(i) $2x_1 + \\lambda = -1$\n(ii) $4x_2 + \\lambda = 1$\n(iii) $x_1 + x_2 = 2$\n\n由 (iii) 得 $x_2 = 2-x_1$。由 (i) 得 $\\lambda = -1 - 2x_1$。将这些代入 (ii)：\n$$4(2-x_1) + (-1-2x_1) = 1$$\n$$8 - 4x_1 - 1 - 2x_1 = 1$$\n$$7 - 6x_1 = 1$$\n$$6x_1 = 6 \\implies x_1 = 1$$\n那么，$x_2 = 2 - 1 = 1$。\n最优原始解是 $x^{\\star} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$。\n这个结果与通过零空间法得到的结果相同，证实了我们解的正确性。相应的最优拉格朗日乘子是 $\\lambda = -1 - 2(1) = -3$。\n\n最终答案是最优原始向量 $x^{\\star}$。",
            "answer": "$$\\boxed{\\begin{pmatrix} 1 & 1 \\end{pmatrix}}$$"
        },
        {
            "introduction": "在之前例子的基础上，本次实践聚焦于齐次约束问题 ($Ax=0$)，其可行集是一个线性子空间。这种特殊情况无需寻找特解，从而简化了问题，使我们能专注于核心的线性代数任务：构造零空间的基。本练习  旨在强化矩阵 $A$ 的零空间与其转置 $A^T$ 的值域之间的基本联系，这是零空间方法的理论基石。",
            "id": "3158300",
            "problem": "考虑在$\\mathbb{R}^{3}$中的一个等式约束优化问题，该问题由二次目标函数和齐次线性约束定义\n$$\n\\min_{x \\in \\mathbb{R}^{3}} \\;\\; f(x) \\equiv \\frac{1}{2} x^{\\top} Q x + c^{\\top} x \\quad \\text{subject to} \\quad A x = 0,\n$$\n其中\n$$\nQ = \\begin{pmatrix} 2 & 0 & 0 \\\\ 0 & 3 & 0 \\\\ 0 & 0 & 4 \\end{pmatrix}, \\qquad c = \\begin{pmatrix} 1 \\\\ -2 \\\\ 3 \\end{pmatrix}, \\qquad A = \\begin{pmatrix} 1 & 1 & 0 \\\\ 0 & 1 & 1 \\end{pmatrix}.\n$$\n使用基于核心线性代数定义的零空间方法。具体而言：\n- 从值域空间$\\mathcal{R}(A^{\\top})$及其正交补的定义出发，手动为$\\mathcal{R}(A^{\\top})^{\\perp}$构造一个标准正交基，并组建零空间基矩阵$Z$，其各列构成该标准正交基。\n- 通过$x = Z y$（其中$y \\in \\mathbb{R}$）对可行集进行重新参数化，从第一性原理推导出关于$y$的简化无约束问题，并求解。\n- 报告在约束$A x = 0$下$f(x)$达到的最小值。\n\n将最终答案表示为单个实数。无需四舍五入。",
            "solution": "该问题被验证为一个适定、有科学依据且形式上明确的等式约束二次规划问题。所有必要数据均已提供，所要求的零空间方法是解决该问题的标准且合适的技术。我们可以继续。\n\n问题是求目标函数的最小值\n$$\nf(x) = \\frac{1}{2} x^{\\top} Q x + c^{\\top} x\n$$\n约束条件为线性约束$A x = 0$，其中$x \\in \\mathbb{R}^{3}$，给定的矩阵为\n$$\nQ = \\begin{pmatrix} 2 & 0 & 0 \\\\ 0 & 3 & 0 \\\\ 0 & 0 & 4 \\end{pmatrix}, \\qquad c = \\begin{pmatrix} 1 \\\\ -2 \\\\ 3 \\end{pmatrix}, \\qquad A = \\begin{pmatrix} 1 & 1 & 0 \\\\ 0 & 1 & 1 \\end{pmatrix}.\n$$\nHessian矩阵$Q$是一个对角矩阵，其对角线上的元素为正数$2$、$3$和$4$，这意味着它是正定的。具有正定Hessian矩阵的二次函数是严格凸函数。由$Ax=0$定义的可行集是一个非空、闭合的凸集（$\\mathbb{R}^{3}$的一个子空间）。在此类集合上最小化一个严格凸函数的问题有唯一解。\n\n我们将按指定要求使用零空间方法。可行集由所有满足$A x = 0$的向量$x$组成，这正是矩阵$A$的零空间的定义，记作$\\mathcal{N}(A)$。根据线性代数基本定理，一个矩阵的零空间是其转置矩阵值域的正交补：$\\mathcal{N}(A) = \\mathcal{R}(A^{\\top})^{\\perp}$。\n\n第一步是为$\\mathcal{N}(A)$构造一个标准正交基。$A$的转置是\n$$\nA^{\\top} = \\begin{pmatrix} 1 & 0 \\\\ 1 & 1 \\\\ 0 & 1 \\end{pmatrix}.\n$$\n$A^{\\top}$的列向量，即$v_1 = \\begin{pmatrix} 1 \\\\ 1 \\\\ 0 \\end{pmatrix}$和$v_2 = \\begin{pmatrix} 0 \\\\ 1 \\\\ 1 \\end{pmatrix}$，是线性无关的，因此构成了值域空间$\\mathcal{R}(A^{\\top})$的一个基。一个向量$z = \\begin{pmatrix} z_1 \\\\ z_2 \\\\ z_3 \\end{pmatrix}$属于$\\mathcal{N}(A) = \\mathcal{R}(A^{\\top})^{\\perp}$当且仅当它同时与$v_1$和$v_2$正交。这给出了以下方程组：\n$$\nv_1^{\\top} z = 0 \\implies z_1 + z_2 = 0\n$$\n$$\nv_2^{\\top} z = 0 \\implies z_2 + z_3 = 0\n$$\n从第一个方程可得$z_1 = -z_2$。从第二个方程可得$z_3 = -z_2$。我们可以为$z_2$选择一个值来求得一个基向量。令$z_2 = -1$。则$z_1 = 1$且$z_3 = 1$。因此，零空间$\\mathcal{N}(A)$的一个基向量为\n$$\nz_{base} = \\begin{pmatrix} 1 \\\\ -1 \\\\ 1 \\end{pmatrix}.\n$$\n题目要求一个标准正交基。$\\mathcal{N}(A)$的维度为$1$，因此我们只需将这个向量单位化。其欧几里得范数为\n$$\n\\|z_{base}\\| = \\sqrt{1^2 + (-1)^2 + 1^2} = \\sqrt{3}.\n$$\n$\\mathcal{N}(A)$的一个标准正交基由单个向量$\\frac{1}{\\sqrt{3}} z_{base}$构成。零空间基矩阵$Z$是一个$3 \\times 1$的矩阵，其列为这个基向量：\n$$\nZ = \\frac{1}{\\sqrt{3}} \\begin{pmatrix} 1 \\\\ -1 \\\\ 1 \\end{pmatrix}.\n$$\n任何可行向量$x$都可以表示为零空间基向量的线性组合。在本例中，$x = Z y$，其中$y \\in \\mathbb{R}$是某个标量。我们将此重新参数化代入目标函数，得到一个关于变量$y$的简化无约束问题：\n$$\nf(x) = f(Zy) = \\frac{1}{2} (Zy)^{\\top} Q (Zy) + c^{\\top} (Zy)\n$$\n$$\ng(y) \\equiv f(Zy) = \\frac{1}{2} y^{\\top} (Z^{\\top} Q Z) y + (c^{\\top} Z) y.\n$$\n由于$y$是标量，上式可简化为\n$$\ng(y) = \\frac{1}{2} (Z^{\\top} Q Z) y^2 + (c^{\\top} Z) y.\n$$\n我们现在计算这个关于$y$的二次函数的系数。简化的Hessian矩阵是一个$1 \\times 1$矩阵（一个标量）$Z^{\\top} Q Z$：\n$$\nZ^{\\top} Q Z = \\left( \\frac{1}{\\sqrt{3}} \\begin{pmatrix} 1 & -1 & 1 \\end{pmatrix} \\right) \\begin{pmatrix} 2 & 0 & 0 \\\\ 0 & 3 & 0 \\\\ 0 & 0 & 4 \\end{pmatrix} \\left( \\frac{1}{\\sqrt{3}} \\begin{pmatrix} 1 \\\\ -1 \\\\ 1 \\end{pmatrix} \\right)\n$$\n$$\nZ^{\\top} Q Z = \\frac{1}{3} \\begin{pmatrix} 1 & -1 & 1 \\end{pmatrix} \\begin{pmatrix} 2 & 0 & 0 \\\\ 0 & 3 & 0 \\\\ 0 & 0 & 4 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ -1 \\\\ 1 \\end{pmatrix} = \\frac{1}{3} \\begin{pmatrix} 2 & -3 & 4 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ -1 \\\\ 1 \\end{pmatrix}\n$$\n$$\nZ^{\\top} Q Z = \\frac{1}{3} (2 \\cdot 1 + (-3) \\cdot (-1) + 4 \\cdot 1) = \\frac{1}{3}(2+3+4) = \\frac{9}{3} = 3.\n$$\n简化的梯度项是标量$c^{\\top} Z$：\n$$\nc^{\\top} Z = \\begin{pmatrix} 1 & -2 & 3 \\end{pmatrix} \\left( \\frac{1}{\\sqrt{3}} \\begin{pmatrix} 1 \\\\ -1 \\\\ 1 \\end{pmatrix} \\right) = \\frac{1}{\\sqrt{3}}(1 \\cdot 1 + (-2) \\cdot (-1) + 3 \\cdot 1) = \\frac{1}{\\sqrt{3}}(1+2+3) = \\frac{6}{\\sqrt{3}} = 2\\sqrt{3}.\n$$\n简化的无约束问题是最小化函数$g(y)$：\n$$\ng(y) = \\frac{1}{2}(3) y^2 + (2\\sqrt{3}) y = \\frac{3}{2} y^2 + 2\\sqrt{3} y.\n$$\n为求最小值，我们计算$g(y)$对$y$的导数并令其为$0$：\n$$\ng'(y) = \\frac{d}{dy} \\left(\\frac{3}{2} y^2 + 2\\sqrt{3} y\\right) = 3y + 2\\sqrt{3}.\n$$\n令$g'(y) = 0$可得最优值$y^*$：\n$$\n3y^* + 2\\sqrt{3} = 0 \\implies 3y^* = -2\\sqrt{3} \\implies y^* = -\\frac{2\\sqrt{3}}{3}.\n$$\n二阶导数$g''(y) = 3 > 0$，确认了$y^*$对应一个最小值。\n\n原始目标函数$f(x)$的最小值即为简化函数$g(y)$在$y^*$处的值：\n$$\nf_{min} = g(y^*) = \\frac{3}{2} (y^*)^2 + 2\\sqrt{3} y^*.\n$$\n代入$y^*$的值：\n$$\nf_{min} = \\frac{3}{2} \\left(-\\frac{2\\sqrt{3}}{3}\\right)^2 + 2\\sqrt{3} \\left(-\\frac{2\\sqrt{3}}{3}\\right)\n$$\n$$\nf_{min} = \\frac{3}{2} \\left(\\frac{4 \\cdot 3}{9}\\right) - \\frac{4 \\cdot (\\sqrt{3})^2}{3} = \\frac{3}{2} \\left(\\frac{12}{9}\\right) - \\frac{12}{3}\n$$\n$$\nf_{min} = \\frac{3}{2} \\left(\\frac{4}{3}\\right) - 4 = \\frac{12}{6} - 4 = 2-4 = -2.\n$$\n在约束$Ax=0$下，$f(x)$的最小值为$-2$。",
            "answer": "$$\n\\boxed{-2}\n$$"
        },
        {
            "introduction": "我们最后的实践将挑战你将零空间方法应用于一个更高维的问题，把一个四维的约束问题转化为一个二维的无约束问题 。这里的关键在于学习如何从约束的结构中直接推导出一个“自然”的零空间基，这种方法有时比 QR 分解或 SVD 等形式化方法更为直观。本练习将提升你扩展零空间方法以及利用问题特定结构寻找巧妙解法的能力。",
            "id": "3158219",
            "problem": "考虑 $\\mathbb{R}^{4}$ 中的等式约束二次优化问题：\n最小化 $f(x) = \\tfrac{1}{2}\\,x^{\\top} H x$，约束条件为 $A x = b$。其中，$H \\in \\mathbb{R}^{4 \\times 4}$ 是对角矩阵，$A \\in \\mathbb{R}^{2 \\times 4}$ 强制不相交坐标对的和，$b \\in \\mathbb{R}^{2}$ 将这些对的和设置为指定值。具体来说，令\n$$\nH = \\operatorname{diag}(2,4,1,3), \\quad\nA = \\begin{pmatrix} 1 & 1 & 0 & 0 \\\\ 0 & 0 & 1 & 1 \\end{pmatrix}, \\quad\nb = \\begin{pmatrix} 2 \\\\ 2 \\end{pmatrix}.\n$$\n仅使用等式约束问题的拉格朗日函数和矩阵零空间的定义作为出发点，按以下步骤进行：\n\n- 构建一个满足 $A x_{p} = b$ 的可行特解 $x_{p}$。\n- 显式推导一个列满秩矩阵 $Z \\in \\mathbb{R}^{4 \\times 2}$，其列构成 $A$ 的零空间的一组基。选择自然地编码和约束的坐标差作为基向量。\n- 将所有可行解 $x$ 表示为 $x = x_{p} + Z z$（其中 $z \\in \\mathbb{R}^{2}$）的形式，构建关于 $z$ 的降维二次型，并解析求解唯一的最小化子 $z^{\\star}$。\n- 求出相应的最优点 $x^{\\star}$ 并计算最优目标值 $f(x^{\\star})$。\n\n仅报告 $f(x^{\\star})$ 的精确值，以最简分数形式表示。无需四舍五入，不涉及单位。",
            "solution": "我们从等式约束二次优化的基本原理开始。目标函数是二次函数 $f(x) = \\tfrac{1}{2}\\,x^{\\top} H x$，其中 $H$ 是一个对称正定矩阵。约束条件是线性等式 $A x = b$。拉格朗日乘子法引入了拉格朗日函数\n$$\n\\mathcal{L}(x,\\lambda) = \\tfrac{1}{2}\\,x^{\\top} H x + \\lambda^{\\top}(A x - b),\n$$\n以及 Karush–Kuhn–Tucker (KKT) 一阶最优性条件为\n$$\nH x + A^{\\top} \\lambda = 0, \\quad A x = b.\n$$\n一种等价的方法，称为零空间法，通过一个可行特解和 $A$ 的零空间的一组基来参数化所有可行点。我们遵循这条路线。\n\n步骤 1：构建一个可行特解 $x_{p}$。\n约束条件是 $x_{1} + x_{2} = 2$ 和 $x_{3} + x_{4} = 2$。一个方便的选择是将每个和均匀分配：\n$$\nx_{p} = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\\\ 1 \\end{pmatrix},\n$$\n它满足 $A x_{p} = b$。\n\n步骤 2：推导一个以坐标差表示的零空间基 $Z$。\n零空间 $\\mathcal{N}(A)$ 由满足 $A v = 0$ 的向量 $v \\in \\mathbb{R}^{4}$ 组成，即满足 $v_{1} + v_{2} = 0$ 和 $v_{3} + v_{4} = 0$ 的向量。自然的基向量是每对坐标内的差：\n$$\nz_{1} = \\begin{pmatrix} 1 \\\\ -1 \\\\ 0 \\\\ 0 \\end{pmatrix}, \\quad\nz_{2} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\\\ -1 \\end{pmatrix}.\n$$\n将它们作为列收集到\n$$\nZ = \\begin{pmatrix}\n1 & 0 \\\\\n-1 & 0 \\\\\n0 & 1 \\\\\n0 & -1\n\\end{pmatrix}.\n$$\n可以验证 $A Z = 0$，所以 $Z$ 的列张成了 $\\mathcal{N}(A)$。\n\n步骤 3：参数化可行域并构建降维问题。\n每个可行解 $x$ 都可以写成 $x = x_{p} + Z z$ 的形式，其中 $z \\in \\mathbb{R}^{2}$。将其代入 $f$ 得到关于 $z$ 的降维二次型：\n$$\n\\phi(z) \\equiv f(x_{p} + Z z) = \\tfrac{1}{2}\\,(x_{p} + Z z)^{\\top} H (x_{p} + Z z).\n$$\n展开并利用 $H$ 的对称性，\n$$\n\\phi(z) = \\tfrac{1}{2}\\,z^{\\top}(Z^{\\top} H Z) z + (Z^{\\top} H x_{p})^{\\top} z + \\tfrac{1}{2}\\,x_{p}^{\\top} H x_{p}.\n$$\n降维后的海森矩阵是 $Z^{\\top} H Z \\in \\mathbb{R}^{2 \\times 2}$，并且因为 $H$ 是正定的且 $Z$ 是列满秩的，所以 $Z^{\\top} H Z$ 是正定的。唯一的最小化子 $z^{\\star}$ 满足一阶条件\n$$\n\\nabla \\phi(z) = (Z^{\\top} H Z)\\,z + Z^{\\top} H x_{p} = 0,\n$$\n所以\n$$\nz^{\\star} = -\\,(Z^{\\top} H Z)^{-1} Z^{\\top} H x_{p}.\n$$\n\n步骤 4：计算 $Z^{\\top} H Z$ 和 $Z^{\\top} H x_{p}$，求解 $z^{\\star}$，并恢复 $x^{\\star}$。\n首先通过将 $H = \\operatorname{diag}(2,4,1,3)$ 作用于 $Z$ 的列来计算 $H Z$：\n$$\nH z_{1} = \\begin{pmatrix} 2 \\\\ -4 \\\\ 0 \\\\ 0 \\end{pmatrix}, \\quad\nH z_{2} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\\\ -3 \\end{pmatrix}.\n$$\n因此，\n$$\nZ^{\\top} H Z\n= \\begin{pmatrix}\nz_{1}^{\\top} H z_{1} & z_{1}^{\\top} H z_{2} \\\\\nz_{2}^{\\top} H z_{1} & z_{2}^{\\top} H z_{2}\n\\end{pmatrix}\n= \\begin{pmatrix}\n6 & 0 \\\\\n0 & 4\n\\end{pmatrix}.\n$$\n接下来计算 $H x_{p}$：\n$$\nH x_{p} = \\operatorname{diag}(2,4,1,3)\\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\\\ 1 \\end{pmatrix}\n= \\begin{pmatrix} 2 \\\\ 4 \\\\ 1 \\\\ 3 \\end{pmatrix}.\n$$\n然后\n$$\nZ^{\\top} H x_{p}\n= \\begin{pmatrix}\nz_{1}^{\\top} H x_{p} \\\\\nz_{2}^{\\top} H x_{p}\n\\end{pmatrix}\n= \\begin{pmatrix}\n(1)(2) + (-1)(4) + (0)(1) + (0)(3) \\\\\n(0)(2) + (0)(4) + (1)(1) + (-1)(3)\n\\end{pmatrix}\n= \\begin{pmatrix} -2 \\\\ -2 \\end{pmatrix}.\n$$\n因此，\n$$\nz^{\\star} = - \\begin{pmatrix} 6 & 0 \\\\ 0 & 4 \\end{pmatrix}^{-1} \\begin{pmatrix} -2 \\\\ -2 \\end{pmatrix}\n= - \\begin{pmatrix} \\tfrac{1}{6} & 0 \\\\ 0 & \\tfrac{1}{4} \\end{pmatrix} \\begin{pmatrix} -2 \\\\ -2 \\end{pmatrix}\n= \\begin{pmatrix} \\tfrac{1}{3} \\\\ \\tfrac{1}{2} \\end{pmatrix}.\n$$\n恢复 $x^{\\star} = x_{p} + Z z^{\\star}$：\n$$\nx^{\\star} = \\begin{pmatrix} 1 \\\\ 1 \\\\ 1 \\\\ 1 \\end{pmatrix}\n+ \\begin{pmatrix}\n1 & 0 \\\\\n-1 & 0 \\\\\n0 & 1 \\\\\n0 & -1\n\\end{pmatrix}\n\\begin{pmatrix} \\tfrac{1}{3} \\\\ \\tfrac{1}{2} \\end{pmatrix}\n= \\begin{pmatrix}\n1 + \\tfrac{1}{3} \\\\\n1 - \\tfrac{1}{3} \\\\\n1 + \\tfrac{1}{2} \\\\\n1 - \\tfrac{1}{2}\n\\end{pmatrix}\n= \\begin{pmatrix}\n\\tfrac{4}{3} \\\\ \\tfrac{2}{3} \\\\ \\tfrac{3}{2} \\\\ \\tfrac{1}{2}\n\\end{pmatrix}.\n$$\n\n步骤 5：计算最优目标值 $f(x^{\\star})$。\n使用 $H = \\operatorname{diag}(2,4,1,3)$ 计算 $x^{\\star \\top} H x^{\\star}$：\n$$\nx^{\\star \\top} H x^{\\star}\n= 2\\left(\\tfrac{4}{3}\\right)^{2} + 4\\left(\\tfrac{2}{3}\\right)^{2} + 1\\left(\\tfrac{3}{2}\\right)^{2} + 3\\left(\\tfrac{1}{2}\\right)^{2}\n= \\tfrac{32}{9} + \\tfrac{16}{9} + \\tfrac{9}{4} + \\tfrac{3}{4}.\n$$\n合并各项：\n$$\n\\tfrac{32}{9} + \\tfrac{16}{9} = \\tfrac{48}{9} = \\tfrac{16}{3}, \\quad\n\\tfrac{9}{4} + \\tfrac{3}{4} = \\tfrac{12}{4} = 3,\n$$\n所以\n$$\nx^{\\star \\top} H x^{\\star} = \\tfrac{16}{3} + 3 = \\tfrac{25}{3}.\n$$\n因此，\n$$\nf(x^{\\star}) = \\tfrac{1}{2}\\,x^{\\star \\top} H x^{\\star} = \\tfrac{1}{2} \\cdot \\tfrac{25}{3} = \\tfrac{25}{6}.\n$$\n因为 $Z^{\\top} H Z$ 是正定的，所以这个最小化子是唯一的，并且计算出的值是唯一的最优目标值。",
            "answer": "$$\\boxed{\\tfrac{25}{6}}$$"
        }
    ]
}