## 引言
单纯形法是求解[线性规划](@entry_id:138188)问题的基石算法，其核心在于通过迭代不断改进目标函数值，直至找到最优解。然而，在某些被称为“退化”的特殊情况下，单纯形法可能会陷入一系列无法改善[目标函数](@entry_id:267263)的迭代中，最终导致无限循环，永远无法终止。这一理论上的陷阱挑战了算法的可靠性。

本文旨在深入剖析这一难题，并系统介绍确保单纯形法稳健性的关键机制——反[循环规则](@entry_id:262527)。通过学习这些规则，读者将不仅理解一个深刻的优化理论问题，更能掌握保证算法在复杂实践中可靠运行的核心技术。

在接下来的章节中，我们将：
-   **原理与机制**: 深入探讨[退化现象](@entry_id:183258)的本质，并详细阐述[Bland法则](@entry_id:165331)和词典序法等反[循环规则](@entry_id:262527)是如何从根本上防止循环的。
-   **应用与[交叉](@entry_id:147634)学科联系**: 将视野拓展到更广阔的领域，展示反[循环规则](@entry_id:262527)在[网络优化](@entry_id:266615)、[整数规划](@entry_id:178386)、经济学和工程学等问题中的关键作用与深刻内涵。
-   **动手实践**: 通过具体的编程与模拟练习，亲身体验循环现象，并验证反[循环规则](@entry_id:262527)的有效性，将理论知识转化为实践能力。

现在，让我们从“原理与机制”开始，深入理解这一精妙的理论及其解决方案。

## 原理与机制

单纯形法的基础在于其迭代改进的过程：在[可行域的顶点](@entry_id:174284)之间移动，每一步都确保[目标函数](@entry_id:267263)值得到严格改善。这一“严格改善”的特性是算法收敛性的核心保证，因为它确保了我们永远不会重复访问同一个顶点，并且由于顶点数量有限，算法必然能在有限步内终止。然而，在某些特殊情况下，这种严格改善的保证可能会失效，从而引发一个被称为**循环 (cycling)** 的理论难题。本章将深入探讨这一现象的根源——**退化 (degeneracy)**，并详细阐述确保算法收敛性的关键机制——**反[循环规则](@entry_id:262527) (anti-cycling rules)**。

### 退化：单纯形法的“停滞”现象

在线性规划中，一个基本可行解被称为**退化的 (degenerate)**，如果其至少有一个基变量的值为零。[退化现象](@entry_id:183258)在几何上对应于可行多面体的一个顶点由超过必要数量的超平面（约束）交汇而成。虽然退化在理论模型和实际应用中都相当常见，但它给单纯形法的执行带来了独特的挑战。

当一个基本可行解是退化的，单纯形法在下一次迭代中可能会执行一次**[退化主元](@entry_id:636499)变换 (degenerate pivot)**。这种情况通常发生在最小比率测试中，当用于确定离基变量的最小比率为零时。

考虑一个最大化问题，我们选择了一个进基变量 $x_k$，其[检验数](@entry_id:173345)为正。我们通过最小比率测试来确定离基变量，以保证移动到下一个顶点后所有变量仍为非负。步长 $\theta$ 由下式决定：
$$ \theta = \min_{i} \left\{ \frac{b_i}{a_{ik}} \,\middle|\, a_{ik} > 0 \right\} $$
其中 $b_i$ 是第 $i$ 个约束的右端项（即当前基变量的值），$a_{ik}$ 是 $x_k$ 在第 $i$ 个约束中的系数。

如果某个基变量 $x_{B_i}$ 的当前值为零（即 $b_i=0$），并且其在进基变量 $x_k$ 对应的列中的系数 $a_{ik}$ 为正，那么该行计算出的比率将是 $\frac{0}{a_{ik}} = 0$。如果这个比率是所有比率中的最小值，那么步长 $\theta$ 将为零。 

一个步长为零的主元变换意味着：
1.  **[目标函数](@entry_id:267263)值不发生变化**：目标函数的增量为 $\Delta z = \bar{c}_k \theta = \bar{c}_k \times 0 = 0$。尽管我们选择了一个具有正[检验数](@entry_id:173345)的“有利”方向，但我们无法沿着这个方向移动任何距离。
2.  **解向量保持不变**：新的变量值是通过将进基变量从 $0$ 增加到 $\theta$ 来计算的。由于 $\theta=0$，所有变量的值都保持不变。从几何上看，算法在[可行域](@entry_id:136622)的同一个顶点上“停滞”了。
3.  **基发生改变**：尽管解没有移动，单纯形法的代数步骤仍然会完成。一个离基变量（其比率为零）被一个进基[变量替换](@entry_id:141386)，从而产生一个新的基。

这种基发生改变但解向量和目标函数值均保持不变的现象，就是[退化主元](@entry_id:636499)变换。它打破了单纯形法“每一步都严格改善[目标函数](@entry_id:267263)”的常规行为。

### 循环现象及其风险

[退化主元](@entry_id:636499)变换本身只是让算法暂时停滞，更深层次的危险在于它可能导致**循环 (cycling)**。循环是指单纯形法在一系列[退化主元](@entry_id:636499)变换之后，返回到它之前访问过的一个基。由于单纯形法的每一步选择都是确定性的，一旦进入这样的循环，算法将无限地重复同一系列基的变换，永远无法达到最优解或断定问题无界。

幸运的是，循环在实践中极为罕见，并且退化本身并不必然导致循环。在许多情况下，即使出现[退化主元](@entry_id:636499)变换，算法在几次“停滞”后也能找到一个非退化的方向并继续前进。例如，在一个退化问题中，即使最小比率测试出现平局（tie），不同的平局打破规则也可能引导算法走向不同的路径，并且这些路径可能都不会导致循环。

然而，从理论上保证算法的可靠性，我们必须有一种系统性的方法来处理退化问题中的平局，从而从根本上杜绝循环的可能性。这就是**反[循环规则](@entry_id:262527)**的用武之地。

### 布兰德规则：一种简洁有效的反循环策略

为了克服循环的潜在风险，已经发展出多种反[循环规则](@entry_id:262527)，其中最著名和最简洁的之一是**布兰德规则 (Blan[d'](@entry_id:189153)s rule)**。该规则由 Robert G. Bland 提出，它为单纯形法在选择进基和离基变量时提供了明确的、无歧义的平局打破机制。

布兰德规则包含两个部分：

1.  **进基变量选择 (定价规则)**：在所有具有能改善目标函数的[检验数](@entry_id:173345)的非基变量中，选择**下标最小**的那个作为进基变量。对于最大化问题，这意味着在所有[检验数](@entry_id:173345)为正的非基变量中选择下标最小者；对于最小化问题，则是在所有[检验数](@entry_id:173345)为负的非基变量中选择下标最小者。

2.  **离基变量选择 (比率测试规则)**：如果在最小比率测试中，有多个基变量得到相同的最小比率，选择其中**下标最小**的那个作为离基变量。

变量的下标是预先确定的，通常是按照决策变量、[松弛变量](@entry_id:268374)、[人工变量](@entry_id:164298)的顺序列出，例如 $x_1, x_2, \dots, x_n, s_1, s_2, \dots, s_m$。

让我们通过一个例子来理解布兰德规则的运作。假设在一个最大化问题中，我们有如下单纯形表，基变量为 $\{x_4, x_5\}$，变量下标为 $x_1 \to 1, x_2 \to 2, \dots, x_5 \to 5$。
$$
\begin{array}{c|c|ccccc|c}
\text{基} & Z & x_1 & x_2 & x_3 & x_4 & x_5 & \text{RHS} \\
\hline
Z & 1 & -5 & -5 & -2 & 0 & 0 & 0 \\
\hline
x_4 & 0 & 2 & 1 & 4 & 1 & 0 & 10 \\
x_5 & 0 & 3 & 4 & 1 & 0 & 1 & 15 \\
\end{array}
$$
在这个表中，Z-行系数是[检验数](@entry_id:173345)的相反数。非基变量 $x_1, x_2, x_3$ 的[检验数](@entry_id:173345)分别为 $5, 5, 2$，都是正数。
*   **进基[变量选择](@entry_id:177971)**：根据标准的丹齐格（Dantzig）规则，我们可以在 $x_1$ 和 $x_2$ 中任选一个，因为它们都有最大的[检验数](@entry_id:173345) $5$。但布兰德规则要求我们选择下标最小的，即 $x_1$（下标为1）作为进基变量。
*   **离基变量选择**：对 $x_1$ 列进行最小比率测试。
    *   $x_4$ 行：比率 $10/2 = 5$。
    *   $x_5$ 行：比率 $15/3 = 5$。
    比率出现平局。此时，布兰德规则要求我们比较平局行对应的基变量的下标。$x_4$ 的下标为 $4$，$x_5$ 的下标为 $5$。由于 $4 < 5$，我们选择下标较小的 $x_4$ 作为离基变量。

因此，根据布兰德规则，下一步主元变换将是 $x_1$ 进基，$x_4$ 离基。这个选择是唯一且确定的。即使在出现[退化主元](@entry_id:636499)变换的情况下（例如最小比率为0），布兰德规则同样适用。

布兰德规则的威力在于它能同时处理进基和离基选择中的歧义。例如，在一个最小化问题中，我们需要从所有[检验数](@entry_id:173345)为负的非基变量中选择一个进基。如果多个变量的[检验数](@entry_id:173345)都为负，布兰德规则规定选择下标最小的那个。随后，如果在比率测试中出现平局，同样选择下标最小的基变量离基。

### 布兰德规则的特性与影响

布兰德规则之所以重要，不仅因为它是一个有效的反循环工具，还因为它深刻地影响了单纯形法的行为和性能。

#### 有限收敛性保证

布兰德规则最重要的理论性质是：**任何使用布兰德规则的单纯形法都保证在有限步内终止**。这个结论的证明相当精妙，它表明在使用布兰德规则时，任何一个基都不可能被重复访问。这从根本上消除了循环的可能性，使得单纯形法成为一个在理论上完全可靠的算法。

#### 对收敛路径的影响

单纯形法的不同主元[选择规则](@entry_id:140784)（即定价规则），本质上是在[可行域](@entry_id:136622)[多面体](@entry_id:637910)的边上选择不同的路径。标准的丹齐格规则（[选择检验](@entry_id:182706)数最优的变量）是一种“最陡边”的贪心策略，期望每一步都能获得最大的[目标函数](@entry_id:267263)改善。而布兰德规则则完全忽略了[检验数](@entry_id:173345)的大小，只关心变量的下标。

这导致布兰德规则所走的路径可能与丹齐格规则截然不同。在同一个问题上，两条路径可能会经过不同的顶点序列，经历不同次数的迭代，并且每一步的[目标函数](@entry_id:267263)值改善情况也可能大相径庭。

#### [收敛速度](@entry_id:636873)的权衡

虽然布兰德规则保证了算法的终止，但它并不保证最快的[收敛速度](@entry_id:636873)。由于它优先考虑小下标而非大的目标函数改善，有时可能会选择一个只能带来微小收益的进基变量。

考虑一个最大化问题，[目标函数](@entry_id:267263)为 $z = \epsilon x_1 + x_2$，其中 $0 < \epsilon \ll 1$。假设 $x_1$ 和 $x_2$ 都是可选的进基变量。根据布兰德规则，由于 $x_1$ 的下标更小，它将被选为进基变量，即使它的[检验数](@entry_id:173345) $\epsilon$ 非常小。而选择 $x_2$ 可能会使目标函数值得到更大的提升。因此，在某些情况下，布兰德规则可能会导致算法沿着一条改善缓慢的路径前进，从而需要更多的迭代次数才能达到最优解。 这种行为是为保证算法的绝对可靠性而付出的潜在效率代价。

然而，布兰德规则的确定性也使其在理论分析中非常有用。对于某些特定结构的线性规划问题，我们可以精确地预测出布兰德规则下的单纯形法将要经过的顶点序列和所需的迭代步数。

### 词典序法：一种更深层的解释

布兰德规则为何能有效防止循环？一种更深层的解释来自于**词典序法 (lexicographical method)**。词典序法是另一种强大的反[循环规则](@entry_id:262527)，它为布兰德规则的有效性提供了几何和代数上的直观解释。

词典序法的核心思想是通过对约束的右端项向量 $b$ 进行一个无穷小的**符号扰动 (symbolic perturbation)** 来从根本上消除退化。想象一下，我们将每个约束的右端项 $b_i$ 替换为一个关于无穷小量 $\epsilon$ 的多项式或[幂级数](@entry_id:146836)，例如 $b_i(\epsilon) = b_i + \epsilon^i$。在几何上，这相当于将每个约束超平面进行一个极其微小的平移，每个平移的幅度都不同。这种差异化的平移会“错开”那些原本交于同一点的多余[超平面](@entry_id:268044)，从而使得每个顶点都恰好由 $n$ 个[超平面](@entry_id:268044)定义，消除了所有退化。

在这个被扰动的问题中，最小比率测试中的平局将不复存在。例如，如果原本两个比率都是 $b_i/a_i = b_j/a_j$，在扰动后，它们变成了 $b_i(\epsilon)/a_i$ 和 $b_j(\epsilon)/a_j$。比较这两个比率的大小，就等同于**词典序比较**它们在 $\epsilon$ 下的[幂级数展开](@entry_id:273325)式的系数。

例如，假设在选择离基变量时，有三行的比率需要比较，它们扰动后的形式为：
- 行 1: $R_1(\epsilon) = \frac{4 + \epsilon + \epsilon^2}{2} = 2 + \frac{1}{2}\epsilon + \frac{1}{2}\epsilon^2$
- 行 2: $R_2(\epsilon) = \frac{4 + 3\epsilon}{2} = 2 + \frac{3}{2}\epsilon$
- 行 3: $R_3(\epsilon) = \frac{7 + \epsilon}{3} = \frac{7}{3} + \frac{1}{3}\epsilon$

词典序比较首先比较常数项（$\epsilon^0$ 的系数）。$R_1$ 和 $R_2$ 的常数项都是 $2$，小于 $R_3$ 的 $\frac{7}{3}$。因此，$R_3$ 首先被排除。接着，比较 $R_1$ 和 $R_2$ 的 $\epsilon^1$ 项系数，$\frac{1}{2} < \frac{3}{2}$。因此，$R_1(\epsilon)$ 在词典序上是最小的。对应的第一行基变量将被选为离基变量。

可以证明，布兰德规则实际上等价于一种特定形式的词典序方法。它通过简单的小标号优先规则，巧妙地实现了与复杂的符号扰动计算相同的效果。这为布兰德规则的强大能力提供了坚实的理论基础：它通过一种隐式的、组合的方式打破了退化，从而保证了单纯形法的每一步都是在朝着一个（词典序意义下）“更优”的基前进，杜绝了任何回到旧基的可能性。

综上所述，退化虽然对单纯形法的基本假设提出了挑战，但通过布兰德规则等反循环机制，我们能够确保算法的稳健性和收敛性，使其成为解决线性规划问题的一个强大而可靠的理论与实践工具。