## 引言
[线性规划](@entry_id:138188) (Linear Programming, LP) 是优化领域的一块基石，为解决无数资源分配和决策问题提供了强大的数学框架。然而，仅仅知道如何求解一个线性规划问题是不够的；更深层次的理解来自于对其内在结构和性质的洞察。为何最优解总出现在“角点”？我们如何严格证明一个解是最优的，或者一个问题根本无解？资源的“价值”又该如何量化？本文旨在系统性地回答这些核心问题。

本文将带领读者踏上一段从理论到实践的探索之旅。在第一章“原理与机制”中，我们将剖析[线性规划](@entry_id:138188)的几何与代数基础，揭示可行域的多面体结构与基本[可行解](@entry_id:634783)之间的深刻联系，并介绍强大的[对偶理论](@entry_id:143133)。接着，在第二章“应用与交叉学科联系”中，我们将展示这些抽象的原理如何在经济、工程、数据科学等多个领域中转化为解决实际问题的洞见，从电网定价到[机器学习模型](@entry_id:262335)训练。最后，在“动手实践”部分，您将有机会通过具体问题来巩固和应用所学到的理论知识。

通过这一结构化的学习路径，您将不仅掌握线性规划的“操作方法”，更能深刻理解其背后的“为何如此”，从而具备更强的建模、分析和解决复杂[优化问题](@entry_id:266749)的能力。

## 原理与机制

本章在前一章介绍性内容的基础上，深入探讨了线性规划 (Linear Programming, LP) 的核心几何与代数原理。我们将剖析可行集的[多面体](@entry_id:637910)结构，阐释顶点与基本可行解之间的等价关系，并揭示[对偶理论](@entry_id:143133)如何为最优性和[不可行性](@entry_id:164663)提供深刻见解和证明。

### 可行集的几何结构：多面体

[线性规划](@entry_id:138188)的可行域由一组[线性不等式](@entry_id:174297)和等式定义，其在几何上对应于一个**[多面体](@entry_id:637910) (polyhedron)**。[多面体](@entry_id:637910)是有限个半空间的交集。对于一个形如 $A x \le b$ 的[线性规划](@entry_id:138188)问题，其中 $x \in \mathbb{R}^{n}$，$A \in \mathbb{R}^{m \times n}$，$b \in \mathbb{R}^{m}$，其可行集 $P = \{ x \in \mathbb{R}^{n} : A x \le b \}$ 正是一个[多面体](@entry_id:637910)。多面体的“角点”在几何上至关重要，我们称之为**极点 (extreme point)** 或顶点。一个极点是[多面体](@entry_id:637910)中的一个点，它不能被表示为[多面体](@entry_id:637910)中另外两个不同点的严格[凸组合](@entry_id:635830)。

[多面体](@entry_id:637910)可以是**有界的 (bounded)** 或**无界的 (unbounded)**。一个有界的[多面体](@entry_id:637910)被称为**[多胞体](@entry_id:635589) (polytope)**。对于无界多面体，其无界性由一组[方向向量](@entry_id:169562)来刻画。这些方向构成了多面体的**衰退锥 (recession cone)**。对于一个非空[多面体](@entry_id:637910) $P = \{ x : A x \le b \}$，其衰退锥定义为 $D = \{ d \in \mathbb{R}^{n} : A d \le 0 \}$。衰退锥的几何意义在于，如果 $x$ 是 $P$ 中的一个点，而 $d$ 是 $D$ 中的一个方向，那么从 $x$ 出发沿方向 $d$ 的整条射线 $x + \lambda d$（对于所有 $\lambda \ge 0$）都将位于 $P$ 内部。

因此，一个无界多面体可以被分解为一个[有界部分和](@entry_id:159812)一个无界部分。这引出了一个深刻的结构性定理——**闵可夫斯基-外尔[表示定理](@entry_id:637872) (Minkowski–Weyl representation theorem)**。该定理指出，任何[多面体](@entry_id:637910) $P$ 都可以表示为其极点集合 $\{v_i\}$ 的[凸包](@entry_id:262864) (convex hull) 与其衰退锥的极射线 (extreme rays) 集合 $\{d_j\}$ 的[锥包](@entry_id:634790) (conic hull) 的和。即：
$$ P = \operatorname{conv}\{v_i\} + \operatorname{cone}\{d_j\} $$
这意味着 $P$ 中的任意一点 $x$ 都可以写成 $x = \sum_i \lambda_i v_i + \sum_j \mu_j d_j$ 的形式，其中 $\lambda_i \ge 0, \sum_i \lambda_i = 1$ 且 $\mu_j \ge 0$。

例如，考虑一个由 $A = \begin{pmatrix} -1 & 0 \\ 0 & -1 \\ -1 & -1 \end{pmatrix}$ 和 $b = \begin{pmatrix} 0 \\ 0 \\ -1 \end{pmatrix}$ 定义的[多面体](@entry_id:637910) $P = \{ x \in \mathbb{R}^2 : Ax \le b \}$ 。其约束为 $x_1 \ge 0, x_2 \ge 0, x_1+x_2 \ge 1$。通过求解可以发现其极点为 $v_1 = (1, 0)^{\top}$ 和 $v_2 = (0, 1)^{\top}$。其衰退锥为 $D = \{d \in \mathbb{R}^2 : d_1 \ge 0, d_2 \ge 0\}$，即第一象限，其极射线可以取为 $d_1 = (1, 0)^{\top}$ 和 $d_2 = (0, 1)^{\top}$。因此，这个无界[多面体](@entry_id:637910)可以表示为连接 $(1,0)$ 和 $(0,1)$ 的线段，并向第一象限无限延伸。

另一个与[凸组合](@entry_id:635830)相关的基本定理是**[卡拉西奥多里定理](@entry_id:173956) (Carathéodory's Theorem)**。它指出，如果一个点 $u$ 位于 $\mathbb{R}^n$ 中某个点集 $S$ 的凸包内，那么 $u$ 可以被表示为 $S$ 中最多 $n+1$ 个点的凸组合。例如，在 $\mathbb{R}^n$ 中，标准单纯形 $P = \{x \in \mathbb{R}^{n} : x \ge 0, \ \mathbf{1}^{\top}x \le 1\}$ 的极点是原点 $\mathbf{0}$ 和 $n$ 个[标准基向量](@entry_id:152417) $e_1, \dots, e_n$。其内部点 $u = (\frac{1}{n+1}, \dots, \frac{1}{n+1})^{\top}$ 可以唯一地表示为所有 $n+1$ 个极点的[凸组合](@entry_id:635830)，每个极点的权重都是 $\frac{1}{n+1}$，这说明了[卡拉西奥多里定理](@entry_id:173956)中的界 $n+1$ 是紧的 。

### 代数视角：基本可行解与顶点

尽管几何直觉很有帮助，但高维多面体的可视化非常困难。因此，我们需要一个等价的代数描述。对于标准形式的线性规划 $\min c^\top x$ s.t. $Ax=b, x\ge 0$，其中 $A \in \mathbb{R}^{m \times n}$ 且行满秩，我们引入**基本[可行解](@entry_id:634783) (Basic Feasible Solution, BFS)** 的概念。

一个基本[可行解](@entry_id:634783)是通过以下步骤得到的：
1.  从 $A$ 的 $n$ 个列中选择 $m$ 个[线性无关](@entry_id:148207)的列，构成一个可逆的 $m \times m$ 矩阵 $A_B$，称为**基矩阵 (basis matrix)**。对应的变量 $x_B$ 称为**基本变量 (basic variables)**。
2.  将其余的 $n-m$ 个变量（称为**非基本变量 (non-basic variables)** $x_N$）设为零。
3.  [求解线性系统](@entry_id:146035) $A_B x_B = b$，得到 $x_B = A_B^{-1}b$。
4.  如果解出的 $x_B$ 满足非负性约束，即 $x_B \ge 0$，那么所构造的解 $x = (x_B, x_N)$ 就是一个基本[可行解](@entry_id:634783)。

**[线性规划基本定理](@entry_id:164405) (Fundamental Theorem of Linear Programming)** 建立了代数与几何之间的桥梁：一个点是[可行域](@entry_id:136622)多面体的极点，当且仅当它是一个基本可行解 。这一定理极为重要，因为它将几何上寻找“角点”的问题，转化为了代数上寻找和评估基本[可行解](@entry_id:634783)的系统性过程。单纯形法正是基于这一原理，在不同的基本可行解（即顶点）之间进行迭代。

一个基本[可行解](@entry_id:634783)可以是**非退化的 (non-degenerate)** 或**退化的 (degenerate)**。
-   一个**非退化的BFS** 是指其所有 $m$ 个基本变量都严格为正 ($x_B > 0$)。在不等式形式 $A'x \le b'$ 的问题中（$x \in \mathbb{R}^n$），非[退化顶点](@entry_id:636994)是指恰好有 $n$ 个约束在该点处被激活（即取等号）。
-   一个**退化的BFS** 是指其至少有一个基本变量为零。在不等式形式中，[退化顶点](@entry_id:636994)是指有超过 $n$ 个约束在该点处被激活。

例如，在 $\mathbb{R}^2$ 中，考虑[可行域](@entry_id:136622) $x_1 \ge 0, x_2 \ge 0, x_1+x_2 \le 1$。顶点 $v_A=(0,0)$ 是一个非[退化顶点](@entry_id:636994)，因为在二维空间中，恰好有两个约束（$x_1=0$ 和 $x_2=0$）在此处激活。因此，有唯一的一组（两个）[线性无关](@entry_id:148207)的[有效约束](@entry_id:635234)来定义这个点，即对应一个唯一的基 。

相比之下，考虑可行域 $x_1 \ge 0, x_2 \ge 0, x_1+x_2 \le 0$。这个可行域只包含一个点 $v_B=(0,0)$。在这个点，三个约束（$x_1=0, x_2=0, x_1+x_2=0$）都同时激活。由于在二维空间中有超过两个约束被激活，所以 $v_B$ 是一个[退化顶点](@entry_id:636994)。这意味着我们可以从这三个[有效约束](@entry_id:635234)中选择不同的组合（例如 $\{x_1=0, x_2=0\}$ 或 $\{x_1=0, x_1+x_2=0\}$）来定义同一个顶点。每一个这样的组合都对应一个不同的基。因此，一个[退化顶点](@entry_id:636994)可以对应多个基本[可行解](@entry_id:634783)的[代数表示](@entry_id:143783)  。退化是[线性规划](@entry_id:138188)理论和实践中的一个重要问题，它可能导致单纯形法在同一个顶点上循环。

### 最优性原理与解的结构

[线性规划](@entry_id:138188)的目标是最大化或最小化一个线性函数 $c^\top x$。从几何上看，这相当于找到一个点 $x$，使得[目标函数](@entry_id:267263)的等值线（或超平面）$c^\top x = z$ 在保持与可行[多面体](@entry_id:637910) $P$ 相交的同时，将截距 $z$ 推向最远。

**基本最优性结果**：如果一个线性规划存在最优解，那么至少有一个极点（顶点）是最优的。这一性质是单纯形法有效性的基石，因为它允许我们将搜索范围从无限个可行点缩小到有限个顶点。

最优解的集合本身也是 $P$ 的一个**面 (face)**。一个面是被某个[支撑超平面](@entry_id:274981)“暴露”出来的[子集](@entry_id:261956)。根据目标向量 $c$ 的方向，最优解集可能是：
-   **一个顶点**：当目标向量 $c$ 不与 $P$ 的任何边平行时，通常只有一个顶点是最优的。形式上，这发生在 $c$ 位于该顶点**[法锥](@entry_id:272387) (normal cone)** 的内部时 。
-   **一条边**：当目标向量 $c$ 恰好垂直于 $P$ 的某条边时，该边上的所有点都将成为最优解。例如，在最大化 $c^\top x$ 的问题中，如果边 $E$ 由约束 $a^\top x = b'$ 定义，且 $c$ 是 $a$ 的正数倍，则 $E$ 上的所有点都会给出相同的最大目标值 。
-   **一个更高维的面**：在更高维度中，最优[解集](@entry_id:154326)也可能是一个多边形或更高维度的面。

[线性规划](@entry_id:138188)问题也可能没有有限最优解。这分为两种情况：**无界 (unbounded)** 和**不可行 (infeasible)**。

-   **无界问题**：如果可行域 $P$ 是无界的，我们必须检查[目标函数](@entry_id:267263)在衰退方向上的行为。
    -   如果对于所有衰退方向 $d \in D$（其中 $D$ 是衰退锥），都有 $c^\top d \le 0$（对于最大化问题），那么即使可行域无界，目标值仍然是有界的，问题存在有限最优解 。
    -   反之，如果存在至少一个衰退方向 $d \in D$ 使得 $c^\top d > 0$，那么我们可以沿着这个方向无限移动，使得目标函数值趋于无穷大。这种情况下，我们说LP的目标是无界的 。

-   **[不可行问题](@entry_id:635482)**：如果约束条件相互矛盾，导致可行集 $P$ 为[空集](@entry_id:261946)，则问题是不可行的。例如，约束 $x_1 \ge 1$ 和 $x_1 \le 0$ 同时存在，使得系统不可行 。

### 对偶性：最优性与[不可行性](@entry_id:164663)的证明

每个线性规划问题（称为**原问题 (primal problem)**）都有一个与之紧密相关的**[对偶问题](@entry_id:177454) (dual problem)**。[对偶理论](@entry_id:143133)为我们理解LP的性质提供了极其强大的工具。

考虑原问题-对偶问题对：
- **原问题 (Primal)**: $\max c^\top x$ s.t. $Ax \le b$.
- **对偶问题 (Dual)**: $\min b^\top y$ s.t. $A^\top y = c, y \ge 0$. (这是其中一种标准形式)

**[弱对偶定理](@entry_id:152538) (Weak Duality Theorem)**：对于任何原问题可行解 $x$ 和任何对偶问题[可行解](@entry_id:634783) $y$，总有 $c^\top x \le b^\top y$。这个看似简单的定理蕴含着深刻的结论。它为原问题的目标值提供了一个上界，也为对偶问题的目标值提供了一个下界。

**强[对偶定理](@entry_id:137804) (Strong Duality Theorem)**：如果一个[线性规划](@entry_id:138188)有有限最优解，那么它的对偶问题也有有限最优解，并且它们的最优目标值相等。即，存在最优解 $x^*$ 和 $y^*$ 使得 $c^\top x^* = b^\top y^*$。

这个零差距的属性是寻找和验证最优解的关键。如果我们能找到一对原问题和[对偶问题](@entry_id:177454)的可行解 $(x, y)$，使得它们的目标值相等，那么我们就可以断定它们都是各自问题的最优解 。

[对偶理论](@entry_id:143133)不仅能证明最优性，还能证明[不可行性](@entry_id:164663)。**[法卡斯引理](@entry_id:146719) (Farkas' Lemma)** 是这一思想的核心，它是一个“择一性定理”。对于一个形如 $Ax \le b$ 的系统，[法卡斯引理](@entry_id:146719)的一个版本表明：
-   要么，系统 $Ax \le b$ 有解 $x$。
-   要么，存在一个向量 $y \ge 0$ 使得 $y^\top A = 0$ 且 $y^\top b  0$。

第二种情况提供了一个**[不可行性证书](@entry_id:635369) (certificate of infeasibility)**。向量 $y$ 给出了一组原始不等式的非负线性组合，这个组合会产生一个明显的矛盾，如 $0 \le -1$ 。从几何上看，这个向量 $y$ 定义了一个超平面，该超平面将[仿射集](@entry_id:634284) $\{Ax - b : x \in \mathbb{R}^n\}$ 与非正象限严格分离，从而证明了 $Ax-b$ 不可能为非正，即 $Ax \le b$ 不可行。

最后，对偶性揭示了原问题和[对偶问题](@entry_id:177454)的状态之间的对称关系：
-   如果一个问题有有限最优解，则另一个也有。
-   如果一个问题目标无界，则另一个问题必定不可行。例如，如果原问题不可行，其[对偶问题](@entry_id:177454)可能是无界的 。
-   原问题和对偶问题都可能不可行。

通过这些原理，我们不仅能够求解[线性规划](@entry_id:138188)问题，还能够深刻理解解的几何性质、[代数结构](@entry_id:137052)以及它们存在或不存在的根本原因。