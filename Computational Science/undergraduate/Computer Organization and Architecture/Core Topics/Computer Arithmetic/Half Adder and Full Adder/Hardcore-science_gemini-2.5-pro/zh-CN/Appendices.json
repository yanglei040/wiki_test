{
    "hands_on_practices": [
        {
            "introduction": "通过分析元件在意外情况下的行为，我们常常能更深刻地理解其功能。本练习  将通过一个假设的“固定型”故障（硬件测试中的一种常见模型）来探讨全加器和半加器之间的基本关系。通过确定一个有故障的全加器的功能，你将巩固对定义这些基本算术电路的核心布尔方程的掌握。",
            "id": "1938847",
            "problem": "一个标准的1位全加器电路是数字算术中的一个基本组件。它有三个二进制输入，表示为$A$、$B$和进位输入$C_{in}$，并产生两个二进制输出：一个和位$S$和一个进位输出位$C_{out}$。在对一批这些组件进行常规测试时，发现其中一个存在故障。该故障被确定为输入线$A$上的“固定为0”（stuck-at-0）状态。这意味着在内部，$A$的逻辑值始终为0，无论施加到外部引脚$A$的信号是什么。其他输入$B$和$C_{in}$保持功能完好。\n\n鉴于此故障，该电路现在产生修正后的输出，我们称之为$S'$和$C'_{out}$。以下哪个选项准确地描述了这个有故障的全加器对其两个正常工作的输入$B$和$C_{in}$所执行的整体逻辑功能？\n\nA. 该电路的功能相当于一个2到1多路复用器，其中$C_{in}$是选择线。\n\nB. 该电路的输出$S'$和$C'_{out}$都永久固定为0。\n\nC. 该电路的功能相当于一个半加器。\n\nD. 该电路的功能相当于一个半减器。\n\nE. 输出为 $S' = B + C_{in}$（或门）和 $C'_{out} = B \\cdot C_{in}$（与门）。\n\nF. 该电路的功能相当于一个异或非门（XNOR）和一个与门（AND）。",
            "solution": "一个标准的1位全加器的输出由以下布尔方程定义：\n$$S=A \\oplus B \\oplus C_{in}, \\quad C_{out}=A B + B C_{in} + A C_{in}.$$\n在输入$A$存在“固定为0”故障的情况下，内部逻辑为$A=0$，与外部引脚无关。代入$A=0$可得：\n$$S' = 0 \\oplus B \\oplus C_{in}, \\quad C'_{out} = (0 \\cdot B) + (B \\cdot C_{in}) + (0 \\cdot C_{in}).$$\n使用恒等式 $x \\oplus 0 = x$、$0 \\cdot x = 0$ 和 $x + 0 = x$，我们简化得到：\n$$S' = B \\oplus C_{in}, \\quad C'_{out} = B \\cdot C_{in}.$$\n这些方程正是一个以$B$和$C_{in}$为输入的半加器的和与进位方程。因此，这个有故障的全加器的功能相当于一个半加器。\n\n检查所列选项，这对应于选项C，而选项E则要求$S' = B + C_{in}$，这是不正确的，因为通常情况下$B \\oplus C_{in} \\neq B + C_{in}$。",
            "answer": "$$\\boxed{C}$$"
        },
        {
            "introduction": "从抽象逻辑到实际实现是数字设计的关键一步。本练习  挑战你仅使用与非门（NAND gate）——一种基本的“通用门”——来构建一个半加器。这个实践不仅关乎功能的正确性，更引入了传播延迟这一关键概念，促使你寻找一个能最小化延迟从而最大化电路运行速度的优化设计。",
            "id": "3645102",
            "problem": "一个半加器具有布尔输出，其定义为 $S = A \\oplus B$ 和 $C = A \\cdot B$，其中 $A$ 和 $B$ 是布尔输入，$\\oplus$ 表示异或。请仅使用双输入与非门重新设计此半加器，并遵循以下实现规则和时序模型：每个与非门具有相同的传播延迟 $t_{pd}$，反相器必须通过将一个与非门的两个输入端连接在一起实现，扇出不受限制，导线/互连延迟忽略不计，$S$ 和 $C$ 之间可以共享中间信号。将一个输出的逻辑深度定义为从任何主输入到该输出的最长路径上的门级数。半加器的最坏情况传播延迟是 $S$ 和 $C$ 传播延迟中的最大值。\n\n在这些约束条件下，对于所有能同时产生 $S$ 和 $C$ 的、仅使用与非门的半加器实现方案，请确定可实现的最小最坏情况传播延迟，并以 $t_{pd}$ 的闭式解析表达式表示。您的推理过程必须说明每个输出的门深度，并证明所达到的深度是最小的。只需报告最终的单个表达式，以 $t_{pd}$ 表示；无需绘图，也无需四舍五入。",
            "solution": "为了找到最小的最坏情况传播延迟，我们必须为和（$S = A \\oplus B$）与进位（$C = A \\cdot B$）设计出逻辑深度最小的、仅使用与非门的电路，并可以共享中间逻辑。传播延迟等于逻辑深度乘以单个门的延迟 $t_{pd}$。\n\n**1. 进位输出 ($C$) 的实现**\n\n进位函数是 $C = A \\cdot B$。使用与非门，我们可以通过双重求反来实现与（AND）操作：\n$$ C = ( (A \\cdot B)' )' $$\n这个表达式直接映射到一个两级与非门电路：\n*   第一级：一个与非门计算 $N_1 = (A \\cdot B)'$。此门的输入是主输入 $A$ 和 $B$（深度为0），因此 $N_1$ 的逻辑深度为1。\n*   第二级：第二个与非门用作反相器，计算 $C = (N_1 \\cdot N_1)'$。此门的输入 $N_1$ 深度为1，因此最终输出 $C$ 的逻辑深度为 $1+1=2$。\n因此，$\\text{depth}(C) = 2$，对应的延迟为 $2 \\cdot t_{pd}$。这是能达到的最小深度，因为单个与非门无法直接产生与逻辑。\n\n**2. 和输出 ($S$) 的实现**\n\n和函数是异或（XOR）操作，$S = A \\oplus B$。一个高效的、仅使用与非门实现XOR的方法是：\n$$ S = ( (A \\cdot N_1)' \\cdot (B \\cdot N_1)' )' $$\n其中 $N_1 = (A \\cdot B)'$ 是我们为进位逻辑计算的中间信号。通过复用 $N_1$，我们可以优化电路：\n*   信号 $N_1 = (A \\cdot B)'$ 的深度为1。\n*   计算 $N_2 = (A \\cdot N_1)'$。此门的输入为 $A$（深度0）和 $N_1$（深度1）。因此，$\\text{depth}(N_2) = \\max(0, 1) + 1 = 2$。\n*   计算 $N_3 = (B \\cdot N_1)'$。此门的输入为 $B$（深度0）和 $N_1$（深度1）。因此，$\\text{depth}(N_3) = \\max(0, 1) + 1 = 2$。\n*   最后，计算 $S = (N_2 \\cdot N_3)'$。此门的输入为 $N_2$ 和 $N_3$，两者的深度均为2。因此，最终输出 $S$ 的深度为 $\\text{depth}(S) = \\max(2, 2) + 1 = 3$。\n因此，$\\text{depth}(S) = 3$，对应的延迟为 $3 \\cdot t_{pd}$。可以证明，对于非反相输入，使用双输入与非门实现XOR功能的最小逻辑深度就是3。\n\n**3. 最坏情况传播延迟**\n\n半加器的两个输出的延迟分别为：\n*   $\\text{delay}(C) = 2 \\cdot t_{pd}$\n*   $\\text{delay}(S) = 3 \\cdot t_{pd}$\n\n最坏情况传播延迟是这两个延迟中的最大值：\n$$ \\text{Delay}_{\\text{worst-case}} = \\max(\\text{delay}(S), \\text{delay}(C)) = \\max(3 \\cdot t_{pd}, 2 \\cdot t_{pd}) = 3 \\cdot t_{pd} $$\n这个设计达到了 $S$ 输出的最小可能深度，因此该最坏情况延迟是可实现的最小值。",
            "answer": "$$\n\\boxed{3 \\cdot t_{pd}}\n$$"
        },
        {
            "introduction": "单位加法器是构建多位算术电路的基础。最后的这个练习将分析从单个元件提升到系统层面，通过考察一个由这些模块构成的行波进位加法器（ripple-carry adder）来完成。通过探索进位传播的概率特性，这个思想实验  将让你更深刻地理解影响数字加法器速度的性能瓶颈，例如进位链的长度。",
            "id": "3645111",
            "problem": "一个位宽为 $n$ 的异步行波进位加法器（RCA）将两个独立的均匀随机 $n$ 位操作数 $A=\\sum_{i=0}^{n-1} a_i 2^i$ 和 $B=\\sum_{i=0}^{n-1} b_i 2^i$ 相加，其中每个比特 $a_i$ 和 $b_i$ 都是独立的，并以相等的概率在 $\\{0,1\\}$ 中取值。在比特位置 $i$，通过逻辑关系 $g_i = a_i \\cdot b_i$（生成）、$p_i = a_i \\oplus b_i$（传播）和 $k_i = \\overline{a_i}\\cdot \\overline{b_i}$（终止）来定义标准的进位分类信号，其中 $\\cdot$ 表示逻辑与，$\\oplus$ 表示异或。如果 $g_i=1$，则称进位链在位置 $i$ 开始，并且只要后续位置满足 $p_{i+1}=1,p_{i+2}=1,\\dots$，它就会向前通过位置 $i+1,i+2,\\dots$ 传播。链在第一个满足 $p_j=0$ 的位置 $j>i$ 处终止，或在最高有效位边界处终止，以先发生者为准。定义链长 $L$ 为链中包含的比特位置数，包括起始位置 $i$。假设 $n$ 足够大，以至于可以忽略边界效应，并假设比特片在不同位置上是独立的。\n\n仅使用操作数比特的独立性和等概率性，以及上述 $g_i, p_i, k_i$ 的逻辑定义，从第一性原理推导由“生成”事件开始的进位链的精确期望长度 $\\mathbb{E}[L]$。将你的最终答案表示为一个精确的实数（无需四舍五入）。",
            "solution": "问题要求计算行波进位加法器中，从一个“生成”事件开始的进位链的期望长度。我们被要求使用给定的定义和概率模型，从第一性原理进行推导。\n\n首先，我们必须确定在任意给定比特位置 $i$ 处，基本进位分类信号的概率。输入比特 $a_i$ 和 $b_i$ 是独立的且均匀随机的，这意味着 $P(a_i=0) = P(a_i=1) = 1/2$ 且 $P(b_i=0) = P(b_i=1) = 1/2$。因此，四种可能的输入对 $(a_i, b_i)$——$(0,0)$, $(0,1)$, $(1,0)$ 和 $(1,1)$——是等概率的，每种发生的概率为 $P(a_i, b_i) = (1/2) \\times (1/2) = 1/4$。\n\n逻辑信号定义如下：\n- 生成: $g_i = a_i \\cdot b_i$\n- 传播: $p_i = a_i \\oplus b_i$\n- 终止: $k_i = \\overline{a_i} \\cdot \\overline{b_i}$\n\n我们现在可以计算这些信号被断言（等于$1$）的概率：\n- “生成”信号 $g_i=1$ 仅在 $a_i=1$ 且 $b_i=1$ 时发生。\n$$P(g_i=1) = P(a_i=1 \\text{ and } b_i=1) = P(a_i=1)P(b_i=1) = \\frac{1}{2} \\cdot \\frac{1}{2} = \\frac{1}{4}$$\n- “传播”信号 $p_i=1$ 在 $a_i \\neq b_i$ 时发生，即 $(a_i, b_i)$ 为 $(0,1)$ 或 $(1,0)$。\n$$P(p_i=1) = P(a_i=0, b_i=1) + P(a_i=1, b_i=0) = \\frac{1}{4} + \\frac{1}{4} = \\frac{1}{2}$$\n- “终止”信号 $k_i=1$ 仅在 $a_i=0$ 且 $b_i=0$ 时发生。\n$$P(k_i=1) = P(a_i=0 \\text{ and } b_i=0) = P(a_i=0)P(b_i=0) = \\frac{1}{2} \\cdot \\frac{1}{2} = \\frac{1}{4}$$\n\n如果 $p_j=0$，则进位链不通过位置 $j$ 传播。此事件的概率是：\n$$P(p_j=0) = 1 - P(p_j=1) = 1 - \\frac{1}{2} = \\frac{1}{2}$$\n另一种方式是，$p_j=0$ 当 $a_j=b_j$ 时，这对应于事件 $g_j=1$ 或 $k_j=1$。由于这些事件是互斥的，所以 $P(p_j=0) = P(g_j=1) + P(k_j=1) = 1/4 + 1/4 = 1/2$。\n\n问题陈述一个进位链从位置 $i$ 开始（由于一个生成事件 $g_i=1$），并要求其期望长度 $L$。长度 $L$ 定义为链中的比特位置数。问题假设 $n$ 足够大，可以忽略边界效应，因此链仅在遇到非传播位置时终止。\n\n让我们对随机变量 $L$ 进行建模。\n- 如果链未能在位置 $i+1$ 传播，它就在起始位置 $i$ 之后立即终止。这意味着 $p_{i+1}=0$。问题将终止定义为在第一个满足 $p_j=0$ 的位置 $j>i$ 发生。这里，$j=i+1$。链中包含的位置集合仅为 $\\{i\\}$。因此，长度为 $L=1$。其概率为：\n$$P(L=1) = P(p_{i+1}=0) = \\frac{1}{2}$$\n- 如果链通过位置 $i+1$ 传播（意味着 $p_{i+1}=1$）但在位置 $i+2$ 终止（意味着 $p_{i+2}=0$），则其长度为 $L=2$。链中包含的位置是 $\\{i, i+1\\}$，所以长度为 $2$。由于比特片是独立的，所以对于不同的 $j$，$p_j$ 信号是独立的。因此：\n$$P(L=2) = P(p_{i+1}=1) \\cdot P(p_{i+2}=0) = \\frac{1}{2} \\cdot \\frac{1}{2} = \\frac{1}{4}$$\n- 一般来说，对于长度为 $L=k$（其中 $k \\ge 1$）的链，它必须通过位置 $i+1, \\dots, i+k-1$ 传播，并在位置 $i+k$ 终止。这对应于事件序列 $p_{i+1}=1, p_{i+2}=1, \\dots, p_{i+k-1}=1,$ 和 $p_{i+k}=0$。长度为 $k$，因为位置 $\\{i, i+1, \\dots, i+k-1\\}$ 是链的一部分。此事件的概率是：\n$$P(L=k) = \\left(\\prod_{j=1}^{k-1} P(p_{i+j}=1)\\right) \\cdot P(p_{i+k}=0) = \\left(\\frac{1}{2}\\right)^{k-1} \\cdot \\frac{1}{2} = \\left(\\frac{1}{2}\\right)^k$$\n\n链长 $L$ 的概率质量函数 (PMF) 是 $P(L=k) = (1/2)^k$，其中 $k=1, 2, 3, \\ldots$。这是一个在正整数集上的几何分布，描述了获得第一次“成功”所需的试验次数，其中一次试验是检查下一个比特位置，而一次“成功”是链终止事件 $p_j=0$。成功的概率是 $p = P(p_j=0) = 1/2$。\n\n服从此分布的随机变量的期望值 $\\mathbb{E}[L]$ 由公式 $\\mathbb{E}[L] = 1/p$ 给出。在我们的情况下：\n$$\\mathbb{E}[L] = \\frac{1}{1/2} = 2$$\n\n或者，我们可以直接从其定义计算期望：\n$$\\mathbb{E}[L] = \\sum_{k=1}^{\\infty} k \\cdot P(L=k) = \\sum_{k=1}^{\\infty} k \\left(\\frac{1}{2}\\right)^k$$\n这是一个算术-几何级数。我们使用对于 $|x|<1$ 的标准恒等式：\n$$\\sum_{k=1}^{\\infty} kx^k = \\frac{x}{(1-x)^2}$$\n代入 $x=1/2$：\n$$\\mathbb{E}[L] = \\frac{1/2}{(1 - 1/2)^2} = \\frac{1/2}{(1/2)^2} = \\frac{1/2}{1/4} = 2$$\n两种方法都得到相同的结果。由“生成”事件引发的进位链的期望长度为 $2$。",
            "answer": "$$\n\\boxed{2}\n$$"
        }
    ]
}