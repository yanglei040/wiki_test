{
    "hands_on_practices": [
        {
            "introduction": "The Average Memory Access Time (AMAT) is the cornerstone metric for evaluating memory hierarchy performance. This first exercise grounds your understanding by tasking you with deriving the AMAT formula from first principles for a three-level cache system. You will then use calculus to determine the sensitivity of AMAT to the miss rate at each level, revealing which parts of the hierarchy offer the greatest potential for optimization . This practice bridges theoretical models with the practical goal of performance analysis and tuning.",
            "id": "3660682",
            "problem": "A three-level cache hierarchy consists of Level-1 ($L1$), Level-2 ($L2$), and Level-3 ($L3$) caches, followed by main memory. The Average Memory Access Time (AMAT) is defined as the expected latency per memory reference. Let $m_1$, $m_2$, and $m_3$ denote the miss rates at $L1$, $L2$, and $L3$, respectively, where each $m_i$ is the conditional miss probability given that the access has reached level $i$. Let $t_1$, $t_2$, and $t_3$ denote the service time (latency) to access $L1$, $L2$, and $L3$, respectively, and let $t_M$ denote the main memory access latency. Assume that a memory reference incurs $t_1$ to probe $L1$; if $L1$ misses, it incurs $t_2$ to probe $L2$; if $L2$ misses, it incurs $t_3$ to probe $L3$; if $L3$ misses, it incurs $t_M$ to access main memory. Assume no overlap and that latencies add along the miss path.\n\nStarting only from the law of total expectation and the definitions of conditional probability and expected cost per event, do the following:\n\n1. Express the AMAT as an expectation over the mutually exclusive events of hitting or missing at each level, in terms of $t_1$, $t_2$, $t_3$, $t_M$ and the conditional miss rates $m_1$, $m_2$, $m_3$. Then, symbolically derive the sensitivity of AMAT to each $m_i$ by computing the partial derivatives $\\frac{\\partial\\, AMAT}{\\partial m_1}$, $\\frac{\\partial\\, AMAT}{\\partial m_2}$, and $\\frac{\\partial\\, AMAT}{\\partial m_3}$.\n\n2. Suppose you have Hardware Performance Counters (HPC) that report total cycles $C$, total memory references $N$, and per-level misses $M_1$, $M_2$, $M_3$. Describe an empirically grounded procedure to estimate each partial derivative $\\frac{\\partial\\, AMAT}{\\partial m_i}$ near an operating point by designing controlled perturbation experiments that adjust $m_i$ while keeping other $m_j$ approximately constant. Your design must explain how to isolate changes in $m_1$, $m_2$, and $m_3$ using workload working sets relative to $L1$, $L2$, and $L3$ capacities, and how to use HPC-derived estimates $\\hat{AMAT} = \\frac{C}{N}$ and $\\hat{m}_i$ from counters to approximate each derivative via small finite differences.\n\n3. For a system with $t_1 = 1$ cycles, $t_2 = 12$ cycles, $t_3 = 35$ cycles, $t_M = 220$ cycles, $m_1 = 0.07$, $m_2 = 0.22$, and $m_3 = 0.40$, compute the numerical value of $\\frac{\\partial\\, AMAT}{\\partial m_2}$ at this operating point. Express the final answer in cycles and round your answer to $4$ significant figures.",
            "solution": "The problem statement is scientifically grounded, well-posed, and all necessary parameters and definitions are provided. It is consistent with established principles of computer architecture and performance analysis. Therefore, the problem is deemed valid and a full solution follows.\n\nThe solution is presented in three parts as requested.\n\n### Part 1: AMAT Derivation and Sensitivity Analysis\n\nThe Average Memory Access Time (AMAT) is the expectation of the total time, $T$, required to service a memory reference. We can derive an expression for AMAT using the law of total expectation, considering the costs incurred at each level of the memory hierarchy. The model specifies a sequential, non-overlapped access pattern.\n\nEvery memory reference must first access the Level-$1$ ($L1$) cache. This takes a time of $t_1$.\nA fraction of these references, given by the conditional $L1$ miss rate $m_1$, will miss in $L1$ and must then proceed to access the Level-$2$ ($L2$) cache. The additional time incurred for an $L2$ access is $t_2$.\nA fraction of the references that reach $L2$, given by the conditional $L2$ miss rate $m_2$, will also miss in $L2$. The absolute fraction of total references that miss in both $L1$ and $L2$ is the product of the probabilities, $m_1 m_2$. These references proceed to access the Level-$3$ ($L3$) cache, incurring an additional time of $t_3$.\nFinally, a fraction of references reaching $L3$, given by the conditional $L3$ miss rate $m_3$, will miss. The absolute fraction of total references that miss in all three cache levels is $m_1 m_2 m_3$. These references must access main memory, incurring a final additional penalty of $t_M$.\n\nSumming these costs, weighted by the probability of incurring them, gives the AMAT equation:\n$$AMAT = t_1 + m_1 t_2 + (m_1 m_2) t_3 + (m_1 m_2 m_3) t_M$$\n\nThis expression represents the expected cost, starting with the base cost to access $L1$ and adding the expected penalties for misses at each successive level.\n\nTo find the sensitivity of AMAT to each conditional miss rate $m_i$, we compute the partial derivatives of the AMAT expression with respect to $m_1$, $m_2$, and $m_3$.\n\n**Sensitivity to $m_1$:**\nWe treat $m_2$ and $m_3$ as constants and differentiate with respect to $m_1$:\n$$ \\frac{\\partial\\, AMAT}{\\partial m_1} = \\frac{\\partial}{\\partial m_1} (t_1 + m_1 t_2 + m_1 m_2 t_3 + m_1 m_2 m_3 t_M) $$\n$$ \\frac{\\partial\\, AMAT}{\\partial m_1} = 0 + t_2 + m_2 t_3 + m_2 m_3 t_M $$\n$$ \\frac{\\partial\\, AMAT}{\\partial m_1} = t_2 + m_2(t_3 + m_3 t_M) $$\nThis derivative represents the change in AMAT for a small change in the $L1$ miss rate. It is the full miss penalty for an $L1$ miss, which includes the time to access $L2$ ($t_2$) plus the expected miss penalty of the lower levels of the hierarchy.\n\n**Sensitivity to $m_2$:**\nWe treat $m_1$ and $m_3$ as constants and differentiate with respect to $m_2$:\n$$ \\frac{\\partial\\, AMAT}{\\partial m_2} = \\frac{\\partial}{\\partial m_2} (t_1 + m_1 t_2 + m_1 m_2 t_3 + m_1 m_2 m_3 t_M) $$\n$$ \\frac{\\partial\\, AMAT}{\\partial m_2} = 0 + 0 + m_1 t_3 + m_1 m_3 t_M $$\n$$ \\frac{\\partial\\, AMAT}{\\partial m_2} = m_1 (t_3 + m_3 t_M) $$\nThis derivative is scaled by $m_1$ because any change in $m_2$ only affects the fraction of accesses that have already missed in $L1$. The term $(t_3 + m_3 t_M)$ is the miss penalty for an $L2$ miss.\n\n**Sensitivity to $m_3$:**\nWe treat $m_1$ and $m_2$ as constants and differentiate with respect to $m_3$:\n$$ \\frac{\\partial\\, AMAT}{\\partial m_3} = \\frac{\\partial}{\\partial m_3} (t_1 + m_1 t_2 + m_1 m_2 t_3 + m_1 m_2 m_3 t_M) $$\n$$ \\frac{\\partial\\, AMAT}{\\partial m_3} = 0 + 0 + 0 + m_1 m_2 t_M $$\n$$ \\frac{\\partial\\, AMAT}{\\partial m_3} = m_1 m_2 t_M $$\nThis derivative is scaled by the factor $m_1 m_2$ because a change in $m_3$ is only relevant for accesses that have already missed in both $L1$ and $L2$. The term $t_M$ is the miss penalty for an $L3$ miss.\n\n### Part 2: Empirical Estimation Procedure\n\nTo empirically estimate the partial derivatives $\\frac{\\partial\\, AMAT}{\\partial m_i}$, we can design controlled experiments that perturb each $m_i$ individually and measure the resulting change in AMAT. This procedure uses Hardware Performance Counters (HPCs) and the finite difference method.\n\nFirst, we establish the relationship between the model parameters and the observables from HPCs:\n-   Total memory references: $N$\n-   Total execution cycles for these references: $C$\n-   $L1$ misses: $M_1$\n-   $L2$ misses: $M_2$\n-   $L3$ misses: $M_3$\n\nFrom these counters, we can estimate the parameters of our model near an operating point:\n-   Estimated AMAT: $\\hat{AMAT} = \\frac{C}{N}$\n-   Estimated conditional $L1$ miss rate: $\\hat{m}_1 = \\frac{M_1}{N}$\n-   Estimated conditional $L2$ miss rate: $\\hat{m}_2 = \\frac{M_2}{M_1}$ (for $M_1 > 0$)\n-   Estimated conditional $L3$ miss rate: $\\hat{m}_3 = \\frac{M_3}{M_2}$ (for $M_2 > 0$)\n\nThe experimental procedure to estimate $\\frac{\\partial\\, AMAT}{\\partial m_i}$ is as follows:\n\n**General Procedure:**\n$1$. **Isolate the Target Variable:** To estimate the sensitivity with respect to a specific miss rate, $m_i$, we must devise a method to change $m_i$ while keeping the other miss rates, $m_j$ (where $j \\neq i$), as constant as possible. This is achieved by carefully controlling the working set size (WSS) of a test workload relative to the cache capacities $S_1 < S_2 < S_3$.\n\n$2$. **Design Perturbation Workloads:** For each target $m_i$, two workloads are created: a baseline workload ($W_a$) and a perturbed workload ($W_b$).\n    -   To perturb $m_1$: Design $W_a$ with WSS $< S_1$ and $W_b$ with WSS $> S_1$ but WSS $\\ll S_2$.\n    -   To perturb $m_2$: Design $W_a$ with WSS $> S_1$ but WSS $< S_2$, and $W_b$ with WSS $> S_2$ but WSS $\\ll S_3$.\n    -   To perturb $m_3$: Design $W_a$ with WSS $> S_2$ but WSS $< S_3$, and $W_b$ with WSS $> S_3$.\n\n$3$. **Data Collection:** Execute both workloads ($W_a$ and $W_b$) on the target system and collect the HPC data ($C, N, M_1, M_2, M_3$) for each run. Let the collected data for the baseline run be ($C_a, N_a, M_{1a}, M_{2a}, M_{3a}$) and for the perturbed run be ($C_b, N_b, M_{1b}, M_{2b}, M_{3b}$).\n\n$4$. **Calculate Empirical Parameters:** For each run $k \\in \\{a, b\\}$, calculate the estimated parameters $\\hat{AMAT}_k$, $\\hat{m}_{1,k}$, $\\hat{m}_{2,k}$, and $\\hat{m}_{3,k}$ using the formulas defined above.\n\n$5$. **Approximate the Derivative:** Use the finite difference approximation for the partial derivative. For example, to estimate the sensitivity to $m_2$:\n$$ \\frac{\\partial\\, AMAT}{\\partial m_2} \\approx \\frac{\\Delta \\hat{AMAT}}{\\Delta \\hat{m}_2} = \\frac{\\hat{AMAT}_b - \\hat{AMAT}_a}{\\hat{m}_{2,b} - \\hat{m}_{2,a}} $$\n\n$6$. **Validation:** A crucial step is to verify the quality of the experiment. The changes in the non-target miss rates, $|\\hat{m}_{j,b} - \\hat{m}_{j,a}|$ for $j \\neq i$, should be significantly smaller than the change in the target miss rate, $|\\hat{m}_{i,b} - \\hat{m}_{i,a}|$. If this condition is not met, the experimental setup (e.g., workload WSS) must be refined to better isolate the variable of interest.\n\nThis systematic procedure allows for an empirically grounded estimation of how sensitive the system's performance (AMAT) is to the efficiency of each level of the cache hierarchy.\n\n### Part 3: Numerical Calculation\n\nWe are asked to compute the numerical value of $\\frac{\\partial\\, AMAT}{\\partial m_2}$ at a specific operating point. The formula derived in Part 1 is:\n$$ \\frac{\\partial\\, AMAT}{\\partial m_2} = m_1 (t_3 + m_3 t_M) $$\n\nThe given values are:\n-   $t_1 = 1$ cycle\n-   $t_2 = 12$ cycles\n-   $t_3 = 35$ cycles\n-   $t_M = 220$ cycles\n-   $m_1 = 0.07$\n-   $m_2 = 0.22$\n-   $m_3 = 0.40$\n\nSubstituting the relevant values into the expression for the partial derivative:\n$$ \\frac{\\partial\\, AMAT}{\\partial m_2} = 0.07 \\times (35 + 0.40 \\times 220) $$\nFirst, we calculate the term inside the parentheses, which represents the $L2$ miss penalty:\n$$ 35 + 0.40 \\times 220 = 35 + 88 = 123 $$\nNow, we multiply by the $L1$ miss rate:\n$$ \\frac{\\partial\\, AMAT}{\\partial m_2} = 0.07 \\times 123 = 8.61 $$\nThe result is $8.61$ cycles. The problem requires the answer to be rounded to $4$ significant figures. Therefore, the value is $8.610$. This value signifies that for a small increase in the $L2$ conditional miss rate of, for instance, $0.01$ (i.e., $1\\%$), the AMAT would increase by approximately $0.01 \\times 8.610 = 0.0861$ cycles.",
            "answer": "$$\n\\boxed{8.610}\n$$"
        },
        {
            "introduction": "Miss rates are not arbitrary numbers; they are the direct result of how a program's memory access patterns interact with the cache's finite size and associativity. This next practice moves from abstract formulas to a concrete scenario involving cache contention, a common performance bottleneck. By analyzing a microbenchmark where instruction and data streams compete for space in a unified L1 cache, you will learn to predict miss rates by reasoning about working set size, address mapping, and replacement policies .",
            "id": "3660665",
            "problem": "A single-threaded microbenchmark executes on a processor with a unified Level 1 cache (L1) and a multi-level memory hierarchy. The unified Level 1 cache has capacity $64 \\,\\text{KiB}$, associativity $4$ (four-way set associative), and cache line size $64 \\,\\text{B}$. The Level 2 cache (L2) is unified, has capacity $512 \\,\\text{KiB}$, associativity $8$, and line size $64 \\,\\text{B}$. The Level 3 cache (L3) is unified, has capacity $8 \\,\\text{MiB}$, associativity $16$, and line size $64 \\,\\text{B}$. The unified Level 1 cache is physically indexed and physically tagged with the set index formed from address bits $b_{6..13}$.\n\nThe microbenchmark places a large code section and its read-only data array contiguously in memory and aligned on $64 \\,\\text{B}$. The code section size is $96 \\,\\text{KiB}$, and the data array size is $48 \\,\\text{KiB}$. In each iteration of the microbenchmark:\n- The instruction stream sequentially executes through the entire $96 \\,\\text{KiB}$ code section once, fetching instructions at a constant rate with spatial locality that touches each $64 \\,\\text{B}$ line exactly once.\n- The data access pattern sequentially loads one $8 \\,\\text{B}$ element per $64 \\,\\text{B}$ line across the entire $48 \\,\\text{KiB}$ data array once, producing one demand load per data line.\n\nAssume the following:\n- The placement of the code and data is such that their addresses uniformly span the same set indices in the unified Level 1 cache, i.e., both streams distribute uniformly across all Level 1 sets and contend for the same sets because they are contiguous and aligned, and the index bits $b_{6..13}$ select $256$ sets for the Level 1 cache.\n- Replacement is true Least Recently Used (LRU).\n- The Level 2 cache can hold the entire working set from both streams without eviction during an iteration, and the Level 2 hit latency for refilling a Level 1 line is $12$ cycles. Ignore Level 3 and main memory for this scenario.\n- Misses from the unified Level 1 cache do not overlap; i.e., each Level 1 miss contributes additively to pipeline stall cycles, and the processor cannot hide these penalties.\n\nStarting from definitions of miss rate and associativity constraints, determine the steady-state Level 1 miss rates for instruction fetches and data loads, denoted $m_{I1}$ and $m_{D1}$, respectively. Then compute the total pipeline stall cycles per iteration due to Level 1 misses from both streams, assuming each Level 1 miss is serviced by the Level 2 hit latency of $12$ cycles. Express the final stall count in cycles per iteration, and round this stall count to four significant figures. The final answer must be a single row matrix containing $m_{I1}$, $m_{D1}$, and the rounded stall cycles per iteration, in that order.",
            "solution": "The solution requires analyzing the contention between the instruction and data streams in the unified Level 1 cache.\n\n**1. Analyze L1 Cache Structure and Workload Size**\n\nFirst, we determine the number of cache lines required by each stream and how they map to the L1 cache sets.\n- L1 Cache Line Size: $L = 64 \\,\\text{B}$\n- L1 Associativity: $A_1 = 4$\n- L1 Number of Sets: The index bits $b_{6..13}$ comprise $13 - 6 + 1 = 8$ bits, so there are $S_1 = 2^8 = 256$ sets. (Check: $C_1 = S_1 \\times A_1 \\times L = 256 \\times 4 \\times 64\\,\\text{B} = 64\\,\\text{KiB}$, which is consistent).\n\nNext, we calculate the number of cache lines for each stream:\n- Instruction stream lines: $N_I = \\frac{96 \\,\\text{KiB}}{64 \\,\\text{B}} = \\frac{96 \\times 1024}{64} = 1536$ lines.\n- Data stream lines: $N_D = \\frac{48 \\,\\text{KiB}}{64 \\,\\text{B}} = \\frac{48 \\times 1024}{64} = 768$ lines.\n\nThe problem states that both streams are distributed uniformly across all L1 sets. We can analyze the behavior of a single representative set.\n- Instruction lines per set: $N_{I,set} = \\frac{N_I}{S_1} = \\frac{1536}{256} = 6$ lines.\n- Data lines per set: $N_{D,set} = \\frac{N_D}{S_1} = \\frac{768}{256} = 3$ lines.\n\n**2. Determine Miss Rates**\n\nFor any given cache set, the total number of unique memory lines that map to it during one iteration is $N_{total,set} = N_{I,set} + N_{D,set} = 6 + 3 = 9$.\nThe L1 cache is $4$-way set associative, meaning each set can only hold $4$ unique cache lines at a time.\nThe microbenchmark accesses each of the $9$ unique lines per set sequentially once per iteration. There is no temporal reuse within an iteration.\n\nUnder the LRU policy:\n- The first $4$ unique accesses to a set will be compulsory misses, filling the set.\n- The $5^{th}$ unique access will also be a miss (a conflict miss) because the set is full. It will evict the least recently used line (the $1^{st}$ line that was loaded).\n- This pattern continues for all subsequent unique accesses. The $k^{th}$ unique access (for $k > 4$) will evict a previously loaded line.\n\nSince no line is re-referenced within an iteration, every access to a unique line will find that the line is not in the cache. The line needed was either never loaded (compulsory miss) or was loaded but has since been evicted by other competing lines (conflict miss). Therefore, in the steady state, every access results in a miss.\n\n- **Instruction Miss Rate ($m_{I1}$):** The instruction stream accesses $1536$ unique lines. Each access results in a miss.\n$$m_{I1} = \\frac{\\text{Instruction Misses}}{\\text{Instruction Accesses}} = \\frac{1536}{1536} = 1$$\n- **Data Miss Rate ($m_{D1}$):** The data stream accesses $768$ unique lines. Each access results in a miss.\n$$m_{D1} = \\frac{\\text{Data Misses}}{\\text{Data Accesses}} = \\frac{768}{768} = 1$$\n\n**3. Calculate Total Pipeline Stalls**\n\nThe total number of L1 misses per iteration is the sum of instruction and data misses.\n- Total Misses = $N_I + N_D = 1536 + 768 = 2304$ misses.\n\nEach L1 miss is serviced by an L2 hit, incurring a penalty of $12$ cycles. The problem states these penalties are additive.\n- Total Stall Cycles = (Total Misses) $\\times$ (Miss Penalty)\n- Total Stall Cycles = $2304 \\times 12 = 27648$ cycles.\n\nThe final stall count must be rounded to four significant figures. The number $27648$ has five significant figures. The fifth digit is $8$, so we round up the fourth digit.\n- Rounded Stall Cycles = $27650$ cycles.\n\nThe final answer is a matrix containing $m_{I1}$, $m_{D1}$, and the rounded stall cycles.\n- $m_{I1} = 1$\n- $m_{D1} = 1$\n- Rounded Stall Cycles = $27650$",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n1 & 1 & 27650\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "Cache performance has profound implications that extend beyond a single program to the behavior of the entire operating system. This final practice explores the dynamic nature of cache state in a time-sharing environment, focusing on the \"cache warming\" effect after a context switch. You will model how miss rates change as a new process populates the cache and use this model to determine the minimum time slice required to amortize the initial performance penalty, linking low-level hardware characteristics to high-level OS scheduling policy .",
            "id": "3660694",
            "problem": "A single core executes a time-sharing workload under an Operating System (OS) with context switches between independent processes. The core has a two-level private cache hierarchy in front of a large inclusive Last-Level Cache (LLC): a Level-1 (L1) cache and a Level-2 (L2) cache. For the purpose of timing, treat the LLC/memory service beyond L2 as a single stage with a fixed additional latency. The following properties hold for a representative process when it is scheduled to run after being descheduled long enough that its private caches contain no useful lines for its own working set.\n\n- L1 hit latency is $t_1 = 1\\,\\text{ns}$.\n- On an L1 miss, the additional service time from L2 (if L2 hits) is $t_2 = 4\\,\\text{ns}$.\n- On an L2 miss, the additional service time from the LLC/memory is $t_M = 60\\,\\text{ns}$.\n- In steady state for this process (after warm-up), the L1 and L2 miss rates are $m_1^{\\star} = 0.04$ and $m_2^{\\star} = 0.15$, respectively.\n- Immediately after a context switch into this process, the effective miss rates start at $m_1(0) = 1$ and $m_2(0) = 1$ and then warm toward $m_1^{\\star}$ and $m_2^{\\star}$.\n- Assume an Independent Reference Model (IRM) with Poisson novelty for the stream of distinct cache-line touches at each level. Under this assumption, the fraction of not-yet-touched lines at level $i \\in \\{1,2\\}$ decays exponentially with rate $\\alpha_i$. For this workload, the effective novelty rates are $\\alpha_1 = 5 \\times 10^{6}\\,\\text{s}^{-1}$ and $\\alpha_2 = 1 \\times 10^{6}\\,\\text{s}^{-1}$.\n\nUsing only the core definitions of cache hit, cache miss, miss rate, and the notion that Poisson arrivals imply exponential decay of the fraction of not-yet-seen items, carry out the following.\n\n1) Define a physically justified functional form for $m_1(t)$ and $m_2(t)$ that is consistent with the given assumptions, and from it determine the smallest warm-up time $\\tau$ such that both $|m_1(t) - m_1^{\\star}| \\le 0.05\\, m_1^{\\star}$ and $|m_2(t) - m_2^{\\star}| \\le 0.05\\, m_2^{\\star}$ hold for all $t \\ge \\tau$.\n\n2) Let Average Memory Access Time (AMAT) at time $t$ be the expected access latency constructed from $t_1$, $t_2$, $t_M$, and the instantaneous miss rates $m_1(t)$ and $m_2(t)$. The OS uses fixed-length time slices of length $T$. To amortize warm-up cost, it requires that the time-average AMAT over the first slice after a context switch exceeds the steady-state AMAT by no more than $0.05$ of the steady-state AMAT. Compute the minimal $T$ that satisfies this requirement.\n\nProvide your final answers as two numbers: the warm-up time $\\tau$ and the minimal time-slice length $T$ that achieves the amortization requirement. Round your answers to three significant figures and express both times in $\\mu\\text{s}$.",
            "solution": "This solution is presented in two parts as requested by the problem.\n\n### Part 1: Warm-up Time $\\tau$\n\n**Functional Form for Miss Rate**\nThe miss rate $m_i(t)$ is composed of misses on \"new\" lines (compulsory misses) and misses on \"old\" lines (capacity/conflict misses).\n- The probability of accessing a new line at time $t$ is given by the exponential decay model: $P(\\text{new}) = \\exp(-\\alpha_i t)$. An access to a new line is always a miss.\n- The probability of accessing an old line is $P(\\text{old}) = 1 - \\exp(-\\alpha_i t)$. For these lines, the miss rate is the steady-state miss rate, $m_i^{\\star}$.\n\nCombining these, the time-dependent miss rate $m_i(t)$ is:\n$$m_i(t) = (1 \\cdot P(\\text{new})) + (m_i^{\\star} \\cdot P(\\text{old}))$$\n$$m_i(t) = \\exp(-\\alpha_i t) + m_i^{\\star} (1 - \\exp(-\\alpha_i t))$$\n$$m_i(t) = m_i^{\\star} + (1 - m_i^{\\star}) \\exp(-\\alpha_i t)$$\nThis form correctly yields $m_i(0)=1$ and $m_i(t) \\to m_i^{\\star}$ as $t \\to \\infty$.\n\n**Calculating Warm-up Time**\nThe warm-up time $\\tau$ is the smallest time where the miss rates are within $5\\%$ of their steady-state values. For each level $i$, we must find $\\tau_i$ such that for $t \\ge \\tau_i$:\n$$|m_i(t) - m_i^{\\star}| \\le 0.05 \\, m_i^{\\star}$$\nSince $m_i(t) \\ge m_i^{\\star}$, this simplifies to:\n$$(1 - m_i^{\\star}) \\exp(-\\alpha_i \\tau_i) \\le 0.05 \\, m_i^{\\star}$$\nSolving for $\\tau_i$:\n$$\\tau_i \\ge \\frac{1}{\\alpha_i} \\ln\\left(\\frac{1 - m_i^{\\star}}{0.05 \\, m_i^{\\star}}\\right)$$\nThe overall warm-up time is $\\tau = \\max(\\tau_1, \\tau_2)$.\n\nGiven values:\n- $m_1^{\\star} = 0.04$, $\\alpha_1 = 5 \\times 10^{6}\\,\\text{s}^{-1}$\n- $m_2^{\\star} = 0.15$, $\\alpha_2 = 1 \\times 10^{6}\\,\\text{s}^{-1}$\n\nFor L1:\n$$\\tau_1 = \\frac{1}{5 \\times 10^6} \\ln\\left(\\frac{1 - 0.04}{0.05 \\times 0.04}\\right) = \\frac{1}{5 \\times 10^6} \\ln(480) \\approx \\frac{6.1738}{5 \\times 10^6} \\approx 1.235 \\times 10^{-6}\\,\\text{s}$$\nFor L2:\n$$\\tau_2 = \\frac{1}{1 \\times 10^6} \\ln\\left(\\frac{1 - 0.15}{0.05 \\times 0.15}\\right) = \\frac{1}{1 \\times 10^6} \\ln\\left(\\frac{0.85}{0.0075}\\right) \\approx \\frac{4.7303}{1 \\times 10^6} \\approx 4.730 \\times 10^{-6}\\,\\text{s}$$\nThus, $\\tau = \\max(\\tau_1, \\tau_2) = 4.730 \\times 10^{-6}\\,\\text{s}$.\nRounded to three significant figures, $\\tau = 4.73\\,\\mu\\text{s}$.\n\n### Part 2: Minimal Time-Slice Length $T$\n\n**AMAT Formulation**\nThe AMAT is the expected access time. Based on the problem's definition of \"additional service time\":\n$\\text{AMAT}(t) = t_1 + m_1(t) \\times (\\text{L1 Miss Penalty})$\n$\\text{L1 Miss Penalty} = t_2 + m_2(t) \\times t_M$\nSo, $\\text{AMAT}(t) = t_1 + m_1(t) t_2 + m_1(t) m_2(t) t_M$.\n\nThe steady-state AMAT, $\\text{AMAT}^{\\star}$, is:\n$\\text{AMAT}^{\\star} = t_1 + m_1^{\\star} t_2 + m_1^{\\star} m_2^{\\star} t_M$\n$\\text{AMAT}^{\\star} = 1\\,\\text{ns} + (0.04)(4\\,\\text{ns}) + (0.04)(0.15)(60\\,\\text{ns}) = 1 + 0.16 + 0.36 = 1.52\\,\\text{ns}$.\n\n**Time-Slice Condition**\nThe condition is that the time-average AMAT over $[0, T]$ must not exceed the steady-state AMAT by more than $5\\%$:\n$$\\frac{1}{T} \\int_0^T \\text{AMAT}(t) \\,dt \\le 1.05 \\, \\text{AMAT}^{\\star}$$\nThis can be rewritten in terms of the total warm-up overhead:\n$$\\int_0^T (\\text{AMAT}(t) - \\text{AMAT}^{\\star}) \\,dt \\le 0.05 \\, T \\, \\text{AMAT}^{\\star}$$\nThe integral represents the total excess cycles during warm-up. We can approximate the integral by noting that for a sufficiently large time slice $T$, the exponential terms will have fully decayed. Let $A_{overhead} = \\int_0^\\infty (\\text{AMAT}(t) - \\text{AMAT}^{\\star}) \\,dt$. The condition simplifies to finding $T$ such that this total fixed overhead is amortized to $5\\%$ of the steady-state cost:\n$$A_{overhead} \\approx 0.05 \\, T \\, \\text{AMAT}^{\\star} \\implies T \\approx \\frac{A_{overhead}}{0.05 \\, \\text{AMAT}^{\\star}}$$\nThe overhead term $\\Delta\\text{AMAT}(t) = \\text{AMAT}(t) - \\text{AMAT}^{\\star}$ can be written as:\n$$\\Delta\\text{AMAT}(t) = C_1 e^{-\\alpha_1 t} + C_2 e^{-\\alpha_2 t} + C_{12} e^{-(\\alpha_1+\\alpha_2)t}$$\nwhere:\n$C_1 = (1-m_1^{\\star})(t_2 + m_2^{\\star}t_M) = (1-0.04)(4 + 0.15 \\cdot 60) = 0.96 \\times 13 = 12.48\\,\\text{ns}$\n$C_2 = m_1^{\\star}(1-m_2^{\\star})t_M = 0.04(1-0.15) \\times 60 = 2.04\\,\\text{ns}$\n$C_{12} = (1-m_1^{\\star})(1-m_2^{\\star})t_M = (1-0.04)(1-0.15) \\times 60 = 48.96\\,\\text{ns}$\n\nThe total integrated overhead is:\n$$A_{overhead} = \\int_0^\\infty \\Delta\\text{AMAT}(t) \\,dt = \\frac{C_1}{\\alpha_1} + \\frac{C_2}{\\alpha_2} + \\frac{C_{12}}{\\alpha_1+\\alpha_2}$$\nRates in $\\text{ns}^{-1}$: $\\alpha_1 = 0.005\\,\\text{ns}^{-1}$, $\\alpha_2 = 0.001\\,\\text{ns}^{-1}$.\n$$A_{overhead} = \\frac{12.48}{0.005} + \\frac{2.04}{0.001} + \\frac{48.96}{0.006} = 2496 + 2040 + 8160 = 12696\\,\\text{ns}^2$$\nNow, solve for $T$:\n$$T \\approx \\frac{12696\\,\\text{ns}^2}{0.05 \\times 1.52\\,\\text{ns}} = \\frac{12696}{0.076}\\,\\text{ns} \\approx 167053\\,\\text{ns}$$\nExpressing in microseconds and rounding to three significant figures, $T = 167\\,\\mu\\text{s}$.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\n4.73 & 167\n\\end{pmatrix}\n}\n$$"
        }
    ]
}