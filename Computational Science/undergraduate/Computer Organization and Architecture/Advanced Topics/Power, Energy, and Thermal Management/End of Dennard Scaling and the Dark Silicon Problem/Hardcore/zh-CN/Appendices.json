{
    "hands_on_practices": [
        {
            "introduction": "登纳德缩放定律的终结意味着晶体管密度增长速度超过了功率效率的提升速度。这导致了一个核心矛盾：我们可以在芯片上集成大量处理单元，但无法同时为它们全部供电，否则将超出散热设计功耗（$TDP$）的限制。这个练习将通过一个基本计算，帮助你亲手量化“暗硅”问题，让你了解在局部热点和整体功耗的双重约束下，一个多核处理器究竟能点亮多少核心。",
            "id": "3639241",
            "problem": "一个包含 $N = 128$ 个相同计算单元的多核片上系统，由于丹纳德缩放定律（Dennard scaling）的终结，在恒定电源电压 $V$ 下运行，因此每次转换的动态开关能耗不随频率降低而减少。在参考频率 $f_{0} = 1$ GHz 下，每个活动计算单元测得的动态功耗为 $P_{\\mathrm{dyn},0} = 2$ W，每个活动计算单元的泄漏功耗为 $P_{\\mathrm{leak}} = 0.5$ W。为防止局部热失控而设置的单位功耗上限为 $P_{\\mathrm{cap}} = 3$ W。芯片级热设计功耗（TDP）为 $P_{\\mathrm{TDP}} = 200$ W，并且存在一个固定的非核心部分（uncore）基准功耗 $P_{\\mathrm{uncore}} = 20$ W，该功耗不依赖于活动计算单元的数量。\n\n假设所有活动计算单元都在一个共同的时钟频率 $f$ 下运行，并且在恒定电压 $V$ 下，动态功耗与频率成线性关系。非活动（暗）单元被完全门控功耗，其功耗贡献可忽略不计。仅使用这些信息，首先确定最大可行频率 $f_{\\max}$，使得一个活动单元的总功耗满足 $P_{\\mathrm{unit}}(f) \\leq P_{\\mathrm{cap}}$。然后，在 $f = f_{\\max}$ 时，确定可同时活动的最大计算单元数 $M$，使得芯片总功耗小于或等于 $P_{\\mathrm{TDP}}$。\n\n中间频率以 GHz 为单位表示。对于最终答案，请以整数形式报告单个数字 $M$。",
            "solution": "将首先根据所需标准对问题进行验证。\n\n### 问题验证\n\n**步骤 1：提取已知条件**\n问题陈述中提供的明确数据和条件如下：\n- 计算单元总数：$N = 128$\n- 电源电压：$V$ 为常数\n- 参考频率：$f_{0} = 1$ GHz\n- 在 $f_0$ 时每个活动单元的动态功耗：$P_{\\mathrm{dyn},0} = 2$ W\n- 每个活动单元的泄漏功耗：$P_{\\mathrm{leak}} = 0.5$ W\n- 单位功耗上限：$P_{\\mathrm{cap}} = 3$ W\n- 芯片级热设计功耗：$P_{\\mathrm{TDP}} = 200$ W\n- 固定的非核心部分基准功耗：$P_{\\mathrm{uncore}} = 20$ W\n- 假设：动态功耗与频率 $f$ 成线性关系。\n- 假设：非活动单元被完全门控功耗，其功耗贡献可忽略不计。\n- 目标 1：确定最大可行频率 $f_{\\max}$，使得单个活动单元的功耗 $P_{\\mathrm{unit}}(f)$ 不超过 $P_{\\mathrm{cap}}$。\n- 目标 2：在 $f = f_{\\max}$ 时，确定最大活动单元数 $M$，使得芯片总功耗不超过 $P_{\\mathrm{TDP}}$。\n\n**步骤 2：使用提取的已知条件进行验证**\n对问题的有效性进行分析：\n- **科学基础：** 该问题基于计算机体系结构和VLSI设计的基本概念，特别是现代多核处理器的功耗特性。丹纳德缩放定律的失效、动态功耗、泄漏功耗、功耗上限和热设计功耗（TDP）等概念都是标准且成熟的。在固定电压下，动态功耗随频率线性扩展的模型是一个正确的一阶近似（$P_{\\mathrm{dyn}} = C V^2 f$，其中 $C$ 和 $V$ 是常数）。核心功耗和非核心功耗之间的区别也是标准做法。\n- **适定性：** 该问题提供了所有必要的数值和一组清晰的约束条件，以唯一确定所要求的两个量 $f_{\\max}$ 和 $M$。目标陈述明确。\n- **客观性：** 语言精确且量化，没有任何主观或模糊的术语。\n- **完整性和一致性：** 数据自洽且充分，没有矛盾之处。例如，计算出的活动核心数量预计将小于可用核心总数（$M  N$），这是该问题所模拟的“暗硅”（dark silicon）问题的一个标志。\n- **现实性：** 功耗和频率值在一个高性能片上系统的合理范围内。\n\n**步骤 3：结论与行动**\n该问题被判定为**有效**。这是一个计算机工程领域中适定且有科学依据的问题。将提供完整的解决方案。\n\n### 解答\n\n单个活动计算单元的总功耗 $P_{\\mathrm{unit}}$ 是其动态功耗 $P_{\\mathrm{dyn}}$ 和泄漏功耗 $P_{\\mathrm{leak}}$ 的总和。\n$$P_{\\mathrm{unit}}(f) = P_{\\mathrm{dyn}}(f) + P_{\\mathrm{leak}}$$\n泄漏功耗给定为恒定值 $P_{\\mathrm{leak}} = 0.5$ W。\n动态功耗 $P_{\\mathrm{dyn}}(f)$ 被指出在恒定电源电压 $V$ 下与工作频率 $f$ 成线性关系。我们可以将此关系写为：\n$$P_{\\mathrm{dyn}}(f) = k \\cdot f$$\n其中 $k$ 是一个比例常数。我们可以根据给定的参考条件确定 $k$：在 $f = f_0 = 1$ GHz 时，动态功耗为 $P_{\\mathrm{dyn},0} = 2$ W。\n$$k = \\frac{P_{\\mathrm{dyn},0}}{f_0} = \\frac{2 \\text{ W}}{1 \\text{ GHz}} = 2 \\frac{\\text{W}}{\\text{GHz}}$$\n因此，单个活动单元的功耗作为频率的函数是：\n$$P_{\\mathrm{unit}}(f) = \\left(\\frac{P_{\\mathrm{dyn},0}}{f_0}\\right)f + P_{\\mathrm{leak}}$$\n\n第一个目标是找到最大可行频率 $f_{\\max}$，在该频率下，单个单元的功耗不超过单位功耗上限 $P_{\\mathrm{cap}}$。这可以用不等式表示为：\n$$P_{\\mathrm{unit}}(f) \\leq P_{\\mathrm{cap}}$$\n为了找到最大频率，我们将单元的功耗设置为其上限值：\n$$P_{\\mathrm{unit}}(f_{\\max}) = P_{\\mathrm{cap}}$$\n代入 $P_{\\mathrm{unit}}(f)$ 的表达式：\n$$\\left(\\frac{P_{\\mathrm{dyn},0}}{f_0}\\right)f_{\\max} + P_{\\mathrm{leak}} = P_{\\mathrm{cap}}$$\n现在我们可以解出 $f_{\\max}$：\n$$f_{\\max} = \\frac{P_{\\mathrm{cap}} - P_{\\mathrm{leak}}}{\\left(\\frac{P_{\\mathrm{dyn},0}}{f_0}\\right)} = f_0 \\frac{P_{\\mathrm{cap}} - P_{\\mathrm{leak}}}{P_{\\mathrm{dyn},0}}$$\n代入给定的数值：\n$$f_{\\max} = (1 \\text{ GHz}) \\frac{3 \\text{ W} - 0.5 \\text{ W}}{2 \\text{ W}} = (1 \\text{ GHz}) \\frac{2.5}{2} = 1.25 \\text{ GHz}$$\n\n第二个目标是，在以该频率 $f_{\\max}$ 运行时，找到可同时活动的最大计算单元数 $M$，且不超过芯片级热设计功耗 $P_{\\mathrm{TDP}}$。\n\n芯片的总功耗 $P_{\\mathrm{total}}$ 是 $M$ 个活动单元的功耗与固定的非核心部分功耗 $P_{\\mathrm{uncore}}$ 的总和。\n$$P_{\\mathrm{total}} = M \\cdot P_{\\mathrm{unit}}(f_{\\max}) + P_{\\mathrm{uncore}}$$\n从上一步我们知道，当 $f = f_{\\max}$ 时，每个活动单元的功耗正好达到其上限，所以 $P_{\\mathrm{unit}}(f_{\\max}) = P_{\\mathrm{cap}} = 3$ W。\n总功耗约束为：\n$$P_{\\mathrm{total}} \\leq P_{\\mathrm{TDP}}$$\n为了找到最大活动单元数 $M$，我们将总功耗设置为 TDP：\n$$M \\cdot P_{\\mathrm{cap}} + P_{\\mathrm{uncore}} = P_{\\mathrm{TDP}}$$\n解出 $M$：\n$$M = \\frac{P_{\\mathrm{TDP}} - P_{\\mathrm{uncore}}}{P_{\\mathrm{cap}}}$$\n代入给定的数值：\n$$M = \\frac{200 \\text{ W} - 20 \\text{ W}}{3 \\text{ W}} = \\frac{180 \\text{ W}}{3 \\text{ W}} = 60$$\n由于计算单元的数量必须是整数，所以最大数量是 $60$。这个数字小于可用的单元总数（$60  128$），这说明了暗硅问题。",
            "answer": "$$\\boxed{60}$$"
        },
        {
            "introduction": "既然我们理解了功耗墙的限制，那么架构师能做些什么呢？此练习探讨了一种常见的架构权衡：通过关闭某个组件（如大型三级缓存）来节省功率，并将其“重新投资”到核心上以提高其工作频率。这个练习将挑战你分析这种策略对最终性能的影响，并揭示其有效性在很大程度上取决于应用程序的特性——究竟是计算密集型还是访存密集型。",
            "id": "3639291",
            "problem": "一款在丹纳德缩放（Dennard scaling）结束后设计的多核处理器拥有八个相同的核心和一个共享的三级（L3）缓存。该芯片的热设计功耗（TDP）为 $95$ W。在一个启用L3缓存的标称工作点，核心以 $f_0 = 2.5$ GHz的频率运行，整个芯片的总功耗等于TDP。在此标称点，L3缓存消耗 $20$ W，八个核心共同消耗剩余的功耗。假设核心动态功耗遵循标准的开关关系 $P_{\\text{dyn}} = \\alpha C V^2 f$，并且在该技术中，为了实现更高的频率，$V$ 在允许范围内与 $f$ 近似线性相关，因此对于某个常数 $k$，$V = k f$。漏电功耗存在，但在所考虑的微小电压/频率变化范围内近似恒定，并且在微分分析中可以忽略不计。\n\n当L3缓存被禁用（保持暗状态）以节省功耗时，所有节省下来的L3功耗通过提高核心的供电电压和频率重新分配给核心，直到芯片再次达到TDP。在L3禁用的情况下，内存层次结构仅包含一级（L1）和二级（L2）缓存；在启用情况下的L3命中在禁用情况下变为主存（DRAM）访问。考虑两类应用程序：\n\n- 计算密集型应用：基础每指令周期数 $c_{\\text{CB}} = 1.0$，平均每指令内存操作数 $a_{\\text{CB}} = 0.01$。\n- 内存密集型应用：基础每指令周期数 $c_{\\text{MB}} = 1.5$，平均每指令内存操作数 $a_{\\text{MB}} = 0.30$。\n\n假设以下内存参数，这些参数对所有应用程序同样适用：\n- 每次内存操作的L1未命中率 $m_1 = 0.10$。\n- 给定L1未命中的条件下，L2的条件未命中率 $m_2 = 0.50$。\n- 在启用情况下，给定L2未命中的条件下，L3的条件未命中率 $m_3 = 0.20$。\n- L2命中停顿时间 $T_{L2} = 6$ ns。\n- L3命中停顿时间 $T_{L3} = 20$ ns。\n- DRAM停顿时间 $T_{\\text{DRAM}} = 80$ ns。\n\n假设顺序依赖性阻止了内存停顿时间与计算时间的重叠；停顿时间线性相加，基础每指令周期数通过 $(\\text{周期数})/f$ 转换为时间。所有内存停顿时间均为绝对时间（纳秒），且不依赖于核心频率。忽略预取效应和写回成本。\n\n仅使用上述基本关系，确定当禁用L3缓存并将核心频率提高以保持在TDP内时，净性能的变化。将性能定义为每秒指令数，并将“L3禁用，更高频率$f$”配置相对于标称“L3启用，频率$f_0$”配置的加速比定义为新吞吐量与旧吞吐量之比。计算两个加速比：一个用于计算密集型应用，一个用于内存密集型应用。将这两个加速比表示为无单位的小数值，顺序为“计算密集型，内存密集型”。将您的最终值四舍五入到四位有效数字。",
            "solution": "用户提供的问题经评估有效，因为它在科学上基于计算机体系结构的原理，问题设定良好，具有完整且一致的参数集，并且其表述是客观的。该问题提出了一个关于后丹纳德缩放时代（通常称为暗硅问题）中处理能力与内存层次结构性能之间权衡的现实场景。因此，我们可以进行完整的解答。\n\n解决方案分为三个部分：\n1.  当功耗从L3缓存重新分配时，计算新的核心频率。\n2.  计算两种配置（L3启用 vs. L3禁用）的平均内存停顿时间。\n3.  计算两种指定应用程序的整体性能加速比。\n\n**1. 核心频率计算**\n\n问题陈述，核心动态功耗 $P_{\\text{dyn}}$ 与电源电压 $V$ 和频率 $f$ 的关系为 $P_{\\text{dyn}} = \\alpha C V^2 f$，其中 $\\alpha$ 和 $C$ 是常数。此外，电压与频率线性相关，$V = kf$。将电压关系代入功耗方程，得到：\n$$P_{\\text{dyn}} = \\alpha C (kf)^2 f = (\\alpha C k^2) f^3$$\n由于在此微分分析中漏电功耗被认为是可忽略的，核心总功耗 $P_{\\text{cores}}$ 与频率的立方成正比：\n$$P_{\\text{cores}} = A f^3$$\n其中 $A$ 是一个比例常数。\n\n在标称配置（启用L3缓存）下，芯片的总功耗为热设计功耗（TDP），$P_{\\text{TDP}} = 95$ W。L3缓存消耗 $P_{L3} = 20$ W。剩余的功耗由8个核心消耗。\n$$P_{\\text{cores},0} = P_{\\text{TDP}} - P_{L3} = 95 \\text{ W} - 20 \\text{ W} = 75 \\text{ W}$$\n此功耗水平对应于标称频率 $f_0 = 2.5$ GHz。\n\n当L3缓存被禁用（“暗”状态）时，其功耗变为零，这部分功耗被重新分配给核心。芯片总功耗保持在TDP，因此核心的新功耗预算为：\n$$P_{\\text{cores}, \\text{new}} = P_{\\text{TDP}} = 95 \\text{ W}$$\n\n我们可以通过建立功耗-频率关系的比例来找到新频率 $f_{\\text{new}}$：\n$$\\frac{P_{\\text{cores}, \\text{new}}}{P_{\\text{cores}, 0}} = \\frac{A f_{\\text{new}}^3}{A f_0^3} = \\left(\\frac{f_{\\text{new}}}{f_0}\\right)^3$$\n求解 $f_{\\text{new}}$：\n$$f_{\\text{new}} = f_0 \\left(\\frac{P_{\\text{cores}, \\text{new}}}{P_{\\text{cores}, 0}}\\right)^{1/3} = 2.5 \\text{ GHz} \\times \\left(\\frac{95}{75}\\right)^{1/3} = 2.5 \\text{ GHz} \\times \\left(\\frac{19}{15}\\right)^{1/3}$$\n数值上，$f_{\\text{new}} \\approx 2.7050$ GHz。\n\n**2. 内存停顿时间计算**\n\n每次内存操作的平均停顿时间 $T_{\\text{stall, mem-op}}$ 由内存层次结构的未命中率和惩罚延迟决定。停顿由L1未命中引发。惩罚是从下一级层次结构中检索数据所需的时间。\n\n每次内存操作的平均停顿时间由下式给出：\n$$T_{\\text{stall, mem-op}} = m_1 \\times (\\text{L1 miss penalty})$$\n其中 $m_1$ 是L1未命中率。L1未命中惩罚取决于数据在何处找到（L2、L3或DRAM）。\n$$\\text{L1 miss penalty} = (1-m_2)T_{L2} + m_2 \\times (\\text{L2 miss penalty})$$\n其中 $m_2$ 是给定L1未命中的条件L2未命中率，$T_{L2}$ 是L2命中停顿时间。\n\n**配置1：启用L3缓存**\n\n在这种情况下，L2未命中可以由L3缓存或主存（DRAM）来服务。\n$$\\text{L2 miss penalty}_{\\text{enabled}} = (1-m_3)T_{L3} + m_3 T_{\\text{DRAM}}$$\n其中 $m_3$ 是条件L3未命中率。\n\n结合这些，每次内存操作的平均停顿时间是：\n$$T_{\\text{stall, enabled}} = m_1 \\left( (1-m_2)T_{L2} + m_2 \\left[ (1-m_3)T_{L3} + m_3 T_{\\text{DRAM}} \\right] \\right)$$\n使用给定值：$m_1=0.10$，$m_2=0.50$，$m_3=0.20$，$T_{L2}=6$ ns，$T_{L3}=20$ ns，以及 $T_{\\text{DRAM}}=80$ ns。\n$$T_{\\text{stall, enabled}} = 0.10 \\left( (1-0.50)(6) + 0.50 \\left[ (1-0.20)(20) + (0.20)(80) \\right] \\right) \\text{ ns}$$\n$$T_{\\text{stall, enabled}} = 0.10 \\left( (0.50)(6) + 0.50 \\left[ (0.80)(20) + 16 \\right] \\right) \\text{ ns}$$\n$$T_{\\text{stall, enabled}} = 0.10 \\left( 3 + 0.50 \\left[ 16 + 16 \\right] \\right) \\text{ ns} = 0.10 \\left( 3 + 0.50(32) \\right) \\text{ ns}$$\n$$T_{\\text{stall, enabled}} = 0.10 \\left( 3 + 16 \\right) \\text{ ns} = 1.9 \\text{ ns}$$\n\n**配置2：禁用L3缓存**\n\n当L3缓存被禁用时，L2缓存中的任何未命中都必须由DRAM来服务。这等同于设置L3未命中率 $m_3=1$。\n$$\\text{L2 miss penalty}_{\\text{disabled}} = T_{\\text{DRAM}}$$\n平均停顿时间变为：\n$$T_{\\text{stall, disabled}} = m_1 \\left( (1-m_2)T_{L2} + m_2 T_{\\text{DRAM}} \\right)$$\n$$T_{\\text{stall, disabled}} = 0.10 \\left( (1-0.50)(6) + 0.50(80) \\right) \\text{ ns}$$\n$$T_{\\text{stall, disabled}} = 0.10 \\left( (0.50)(6) + 40 \\right) \\text{ ns} = 0.10 \\left( 3 + 40 \\right) \\text{ ns}$$\n$$T_{\\text{stall, disabled}} = 4.3 \\text{ ns}$$\n\n**3. 性能加速比计算**\n\n执行一条指令的总时间 $T_{\\text{inst}}$ 是核心计算时间与内存停顿时间之和。\n$$T_{\\text{inst}} = T_{\\text{compute}} + T_{\\text{stall}} = \\frac{c_{\\text{base}}}{f} + a \\times T_{\\text{stall, mem-op}}$$\n其中 $c_{\\text{base}}$ 是基础每指令周期数，$a$ 是平均每指令内存操作数。\n\n加速比 $S$ 是新吞吐量与旧吞吐量之比。吞吐量是每秒指令数，即 $1/T_{\\text{inst}}$。\n$$S = \\frac{\\text{Throughput}_{\\text{new}}}{\\text{Throughput}_{\\text{enabled}}} = \\frac{1 / T_{\\text{inst, new}}}{1 / T_{\\text{inst, enabled}}} = \\frac{T_{\\text{inst, enabled}}}{T_{\\text{inst, new}}}$$\n\n我们现在为这两类应用程序计算这个值。注意，频率 $f$ 的单位是GHz，意味着 $1/f$ 的单位是纳秒。\n\n**计算密集型应用** ($c_{\\text{CB}} = 1.0$, $a_{\\text{CB}} = 0.01$)\n\n每指令时间（启用L3，标称频率 $f_0$）：\n$$T_{\\text{inst, enabled, CB}} = \\frac{c_{\\text{CB}}}{f_0} + a_{\\text{CB}} T_{\\text{stall, enabled}} = \\frac{1.0}{2.5} + 0.01 \\times 1.9 = 0.4 + 0.019 = 0.419 \\text{ ns}$$\n每指令时间（禁用L3，新频率 $f_{\\text{new}}$）：\n$$T_{\\text{inst, new, CB}} = \\frac{c_{\\text{CB}}}{f_{\\text{new}}} + a_{\\text{CB}} T_{\\text{stall, disabled}} = \\frac{1.0}{2.5 \\left(\\frac{19}{15}\\right)^{1/3}} + 0.01 \\times 4.3 \\approx 0.369686 \\text{ ns} + 0.043 \\text{ ns} = 0.412686 \\text{ ns}$$\n计算密集型应用的加速比：\n$$S_{\\text{CB}} = \\frac{T_{\\text{inst, enabled, CB}}}{T_{\\text{inst, new, CB}}} = \\frac{0.419}{0.412686} \\approx 1.015300$$\n四舍五入到四位有效数字，加速比为 $1.015$。\n\n**内存密集型应用** ($c_{\\text{MB}} = 1.5$, $a_{\\text{MB}} = 0.30$)\n\n每指令时间（启用L3，标称频率 $f_0$）：\n$$T_{\\text{inst, enabled, MB}} = \\frac{c_{\\text{MB}}}{f_0} + a_{\\text{MB}} T_{\\text{stall, enabled}} = \\frac{1.5}{2.5} + 0.30 \\times 1.9 = 0.6 + 0.57 = 1.17 \\text{ ns}$$\n每指令时间（禁用L3，新频率 $f_{\\text{new}}$）：\n$$T_{\\text{inst, new, MB}} = \\frac{c_{\\text{MB}}}{f_{\\text{new}}} + a_{\\text{MB}} T_{\\text{stall, disabled}} = \\frac{1.5}{2.5 \\left(\\frac{19}{15}\\right)^{1/3}} + 0.30 \\times 4.3 \\approx 0.554528 \\text{ ns} + 1.29 \\text{ ns} = 1.844528 \\text{ ns}$$\n内存密集型应用的加速比：\n$$S_{\\text{MB}} = \\frac{T_{\\text{inst, enabled, MB}}}{T_{\\text{inst, new, MB}}} = \\frac{1.17}{1.844528} \\approx 0.634323$$\n四舍五入到四位有效数字，加速比为 $0.6343$。小于1的值表示减速。",
            "answer": "$$\\boxed{\\begin{pmatrix} 1.015  0.6343 \\end{pmatrix}}$$"
        },
        {
            "introduction": "除了静态的设计决策，现代处理器还采用动态策略来管理功耗预算。这个练习模拟了在不同操作模式（高性能的“睿频”模式与低功耗的“节能”模式）之间的选择。它引入了如能量延迟积（$EDP$）等行业标准评价指标，并展示了如何根据优化目标（追求纯粹速度还是能源效率）来决定利用功耗预算的“最优”策略，从而让你更深刻地理解性能与能效之间的权衡。",
            "id": "3639311",
            "problem": "一块芯片集成了 $N_{\\text{total}} = 20$ 个相同的核心，但由于 Dennard 缩放的终结，并非所有晶体管都能在不违反热设计功耗 (TDP) 约束的情况下同时供电。这导致了暗硅现象，即在任何时候都必须有一部分硅保持未通电状态。每个核心可以在两个电压-频率点之一运行：一个加速点和一个节能点。根据经验，并与动态功耗缩放（其中动态功耗与 $V^2 f$ 成正比，吞吐量与 $f$ 成正比）的理论一致，可以实现以下单核工作点：\n- 加速模式：单核功耗 $p_T = 12\\,\\text{W}$，单核吞吐量 $r_T = 4\\,\\text{Gops/s}$。\n- 节能模式：单核功耗 $p_E = 4\\,\\text{W}$，单核吞吐量 $r_E = 2\\,\\text{Gops/s}$。\n假设功耗上限 (TDP) 为 $P_{\\text{cap}} = 96\\,\\text{W}$。由于共享内存带宽的限制，最多可以有 12 个节能模式的核心并发工作而不会出现吞吐量饱和；超过 12 个节能模式核心，总吞吐量不会增加。假设下面列出的给定的加速模式核心数量不存在此类内存瓶颈。考虑一个固定的工作负载 $W = 240\\,\\text{Gops}$，其中 $\\text{Gops/s}$ 表示每秒十亿次操作，$\\text{Gops}$ 表示十亿次操作。能量-延迟乘积 (EDP) 定义为 $EDP = E \\cdot T$，能量-延迟平方乘积 ($ED^2P$) 定义为 $ED^2P = E \\cdot T^2$，其中能量 $E$ 等于功耗 $P$ 乘以执行时间 $T$，而 $T = W/X$（$X$ 为吞吐量）。\n\n提出了三种可行策略：\n- 策略 1：激活 8 个加速核心，关闭所有其他核心。\n- 策略 2：激活 12 个节能核心，关闭所有其他核心（不超过内存带宽限制）。\n- 策略 3：混合模式：激活 4 个加速核心和 6 个节能核心，关闭所有其他核心。\n\n对于每种策略，仅使用基本原理 $E = P \\cdot T$ 和 $T = W/X$ 来计算 $EDP$ 和 $ED^2P$。然后确定哪种策略可以最小化 $EDP$，哪种策略可以最小化 $ED^2P$。还要计算每种选定策略中的暗硅比例，定义为必须保持未通电状态的核心数占 $N_{\\text{total}}$ 的分数。\n\n选择下面正确的陈述。\n\nA. 最小化 $EDP$ 选择策略 2，其暗硅比例为 $40\\%$；最小化 $ED^2P$ 选择策略 1，其暗硅比例为 $60\\%$。\n\nB. 最小化 $EDP$ 选择策略 1，其暗硅比例为 $60\\%$；最小化 $ED^2P$ 选择策略 2，其暗硅比例为 $40\\%$。\n\nC. $EDP$ 和 $ED^2P$ 都选择策略 3，其暗硅比例为 $50\\%$。\n\nD. 最小化 $EDP$ 选择策略 2；最小化 $ED^2P$ 选择策略 3（无需计算暗硅比例）。",
            "solution": "首先对问题陈述进行验证。\n\n### 步骤 1：提取已知条件\n- 核心总数：$N_{\\text{total}} = 20$。\n- 加速核心工作点：单核功耗 $p_T = 12\\,\\text{W}$，单核吞吐量 $r_T = 4\\,\\text{Gops/s}$。\n- 节能核心工作点：单核功耗 $p_E = 4\\,\\text{W}$，单核吞吐量 $r_E = 2\\,\\text{Gops/s}$。\n- 芯片功耗上限 (TDP)：$P_{\\text{cap}} = 96\\,\\text{W}$。\n- 内存带宽约束：最多可以激活 12 个节能模式的核心。\n- 工作负载：$W = 240\\,\\text{Gops}$。\n- 能量-延迟乘积 ($EDP$)：$EDP = E \\cdot T$。\n- 能量-延迟平方乘积 ($ED^2P$)：$ED^2P = E \\cdot T^2$。\n- 能量：$E = P \\cdot T$。\n- 执行时间：$T = W/X$，其中 $X$ 是总吞吐量。\n- 暗硅比例：（未通电核心数）/ $N_{\\text{total}}$。\n- 策略 1：$n_T = 8$ 个加速核心，$n_E = 0$ 个节能核心。\n- 策略 2：$n_E = 12$ 个节能核心，$n_T = 0$ 个加速核心。\n- 策略 3：$n_T = 4$ 个加速核心，$n_E = 6$ 个节能核心。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题在科学上基于 Dennard 缩放失效、暗硅以及多核处理器中功耗/性能权衡等已确立的概念。指标 $EDP$ 和 $ED^2P$ 是计算机体系结构中用于评估性能和能耗之间平衡的标准。该问题定义良好，提供了计算每种策略所需量的所有必要数据和定义。\n\n我们必须验证所提出的每种策略是否如陈述中所述是“可行的”，即它遵守功耗上限和内存带宽约束。\n- **策略 1：** 总功耗为 $8 \\cdot p_T = 8 \\cdot 12\\,\\text{W} = 96\\,\\text{W}$，等于 $P_{\\text{cap}} = 96\\,\\text{W}$。满足约束。\n- **策略 2：** 总功耗为 $12 \\cdot p_E = 12 \\cdot 4\\,\\text{W} = 48\\,\\text{W}$，小于 $P_{\\text{cap}}$。节能核心数量（12个）处于指定的内存带宽限制，但未超过。满足约束。\n- **策略 3：** 总功耗为 $4 \\cdot p_T + 6 \\cdot p_E = 4 \\cdot 12\\,\\text{W} + 6 \\cdot 4\\,\\text{W} = 48\\,\\text{W} + 24\\,\\text{W} = 72\\,\\text{W}$，小于 $P_{\\text{cap}}$。节能核心数量（6个）低于内存带宽限制。满足约束。\n\n该问题是自洽、一致、客观且科学合理的。没有发现任何缺陷。\n\n### 步骤 3：结论与行动\n问题有效。继续求解。\n\n### 解题推导\n我们将为每种策略计算相关指标。核心量是：总功耗 ($P$)、总吞吐量 ($X$)、执行时间 ($T$)、总能量 ($E$)、能量-延迟乘积 ($EDP$) 和能量-延迟平方乘积 ($ED^2P$)。工作负载 $W = 240\\,\\text{Gops}$ 是恒定的。\n\n**策略 1：激活 8 个加速核心**\n- 总功耗：$P_1 = 8 \\cdot p_T = 8 \\cdot 12\\,\\text{W} = 96\\,\\text{W}$。\n- 总吞吐量：$X_1 = 8 \\cdot r_T = 8 \\cdot 4\\,\\text{Gops/s} = 32\\,\\text{Gops/s}$。\n- 执行时间：$T_1 = W / X_1 = 240\\,\\text{Gops} / 32\\,\\text{Gops/s} = 7.5\\,\\text{s}$。\n- 能量：$E_1 = P_1 \\cdot T_1 = 96\\,\\text{W} \\cdot 7.5\\,\\text{s} = 720\\,\\text{J}$。\n- EDP：$EDP_1 = E_1 \\cdot T_1 = 720\\,\\text{J} \\cdot 7.5\\,\\text{s} = 5400\\,\\text{J}\\cdot\\text{s}$。\n- $ED^2P$：$ED^2P_1 = E_1 \\cdot T_1^2 = 720\\,\\text{J} \\cdot (7.5\\,\\text{s})^2 = 720 \\cdot 56.25\\,\\text{J}\\cdot\\text{s}^2 = 40500\\,\\text{J}\\cdot\\text{s}^2$。\n- 暗硅：20 个核心中有 8 个被激活。未通电的核心数量为 $20 - 8 = 12$。比例为 $12/20 = 0.6 = 60\\%$。\n\n**策略 2：激活 12 个节能核心**\n- 总功耗：$P_2 = 12 \\cdot p_E = 12 \\cdot 4\\,\\text{W} = 48\\,\\text{W}$。\n- 总吞吐量：$X_2 = 12 \\cdot r_E = 12 \\cdot 2\\,\\text{Gops/s} = 24\\,\\text{Gops/s}$。\n- 执行时间：$T_2 = W / X_2 = 240\\,\\text{Gops} / 24\\,\\text{Gops/s} = 10\\,\\text{s}$。\n- 能量：$E_2 = P_2 \\cdot T_2 = 48\\,\\text{W} \\cdot 10\\,\\text{s} = 480\\,\\text{J}$。\n- EDP：$EDP_2 = E_2 \\cdot T_2 = 480\\,\\text{J} \\cdot 10\\,\\text{s} = 4800\\,\\text{J}\\cdot\\text{s}$。\n- $ED^2P$：$ED^2P_2 = E_2 \\cdot T_2^2 = 480\\,\\text{J} \\cdot (10\\,\\text{s})^2 = 48000\\,\\text{J}\\cdot\\text{s}^2$。\n- 暗硅：20 个核心中有 12 个被激活。未通电的核心数量为 $20 - 12 = 8$。比例为 $8/20 = 0.4 = 40\\%$。\n\n**策略 3：混合模式：激活 4 个加速核心和 6 个节能核心**\n- 总功耗：$P_3 = 4 \\cdot p_T + 6 \\cdot p_E = 4 \\cdot 12\\,\\text{W} + 6 \\cdot 4\\,\\text{W} = 48\\,\\text{W} + 24\\,\\text{W} = 72\\,\\text{W}$。\n- 总吞吐量：$X_3 = 4 \\cdot r_T + 6 \\cdot r_E = 4 \\cdot 4\\,\\text{Gops/s} + 6 \\cdot 2\\,\\text{Gops/s} = 16\\,\\text{Gops/s} + 12\\,\\text{Gops/s} = 28\\,\\text{Gops/s}$。\n- 执行时间：$T_3 = W / X_3 = 240\\,\\text{Gops} / 28\\,\\text{Gops/s} = 60/7\\,\\text{s} \\approx 8.57\\,\\text{s}$。\n- 能量：$E_3 = P_3 \\cdot T_3 = 72\\,\\text{W} \\cdot (60/7)\\,\\text{s} = 4320/7\\,\\text{J} \\approx 617.14\\,\\text{J}$。\n- EDP：$EDP_3 = E_3 \\cdot T_3 = (4320/7)\\,\\text{J} \\cdot (60/7)\\,\\text{s} = 259200/49\\,\\text{J}\\cdot\\text{s} \\approx 5289.8\\,\\text{J}\\cdot\\text{s}$。\n- $ED^2P$：$ED^2P_3 = E_3 \\cdot T_3^2 = EDP_3 \\cdot T_3 = (259200/49)\\,\\text{J}\\cdot\\text{s} \\cdot (60/7)\\,\\text{s} = 15552000/343\\,\\text{J}\\cdot\\text{s}^2 \\approx 45341.1\\,\\text{J}\\cdot\\text{s}^2$。\n- 暗硅：20 个核心中有 $4+6=10$ 个被激活。未通电的核心数量为 $20 - 10 = 10$。比例为 $10/20 = 0.5 = 50\\%$。\n\n### 比较与结论\n- **最小化 EDP**：\n  - $EDP_1 = 5400\\,\\text{J}\\cdot\\text{s}$\n  - $EDP_2 = 4800\\,\\text{J}\\cdot\\text{s}$ (最小值)\n  - $EDP_3 \\approx 5289.8\\,\\text{J}\\cdot\\text{s}$\n  最小化 $EDP$ 的策略是 **策略 2**。其暗硅比例为 $40\\%$。\n\n- **最小化 $ED^2P$**：\n  - $ED^2P_1 = 40500\\,\\text{J}\\cdot\\text{s}^2$ (最小值)\n  - $ED^2P_2 = 48000\\,\\text{J}\\cdot\\text{s}^2$\n  - $ED^2P_3 \\approx 45341.1\\,\\text{J}\\cdot\\text{s}^2$\n  最小化 $ED^2P$ 的策略是 **策略 1**。其暗硅比例为 $60\\%$。\n\n指标 $EDP = P T^2$ 对功耗的惩罚很重，但对时间的惩罚较轻，而 $ED^2P = P T^3$ 对长执行时间的惩罚更为严厉。策略 2 是最节能的（$E_2=480\\,\\text{J}$），使其成为 $EDP$ 的最佳选择。策略 1 的执行时间最短（$T_1=7.5\\,\\text{s}$），使其成为对时间更敏感的 $ED^2P$ 指标的最佳选择。\n\n### 逐项分析选项\n\nA. **最小化 $EDP$ 选择策略 2，其暗硅比例为 $40\\%$；最小化 $ED^2P$ 选择策略 1，其暗硅比例为 $60\\%$。**\n该陈述与我们推导出的结果完全匹配。最小化 $EDP$ 选择策略 2（暗硅比例 $40\\%$），最小化 $ED^2P$ 选择策略 1（暗硅比例 $60\\%$）。\n**结论：正确。**\n\nB. **最小化 $EDP$ 选择策略 1，其暗硅比例为 $60\\%$；最小化 $ED^2P$ 选择策略 2，其暗硅比例为 $40\\%$。**\n该陈述颠倒了正确的对应关系。$EDP$ 由策略 2 最小化，而不是策略 1。$ED^2P$ 由策略 1 最小化，而不是策略 2。\n**结论：不正确。**\n\nC. **$EDP$ 和 $ED^2P$ 都选择策略 3，其暗硅比例为 $50\\%$。**\n策略 3 没有最小化任何一个指标。策略 2 最小化 $EDP$，策略 1 最小化 $ED^2P$。\n**结论：不正确。**\n\nD. **最小化 $EDP$ 选择策略 2；最小化 $ED^2P$ 选择策略 3（无需计算暗硅比例）。**\n第一部分“最小化 $EDP$ 选择策略 2”是正确的。然而，第二部分“最小化 $ED^2P$ 选择策略 3”是不正确的。我们的计算显示 $ED^2P_1 = 40500\\,\\text{J}\\cdot\\text{s}^2$，小于 $ED^2P_3 \\approx 45341.1\\,\\text{J}\\cdot\\text{s}^2$。\n**结论：不正确。**",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}