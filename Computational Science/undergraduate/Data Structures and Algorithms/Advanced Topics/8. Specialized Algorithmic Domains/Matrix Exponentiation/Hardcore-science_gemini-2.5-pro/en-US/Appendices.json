{
    "hands_on_practices": [
        {
            "introduction": "The most direct and fundamental application of matrix exponentiation is in counting walks between vertices in a graph. This exercise provides a concrete scenario to practice this core principle, where the number of walks of length $k$ from vertex $i$ to $j$ is found in the $(i,j)$-th entry of the $k$-th power of the adjacency matrix. You will also learn how to adapt this method to handle constraints, such as avoiding a specific edge in the graph.",
            "id": "3249456",
            "problem": "Consider a finite directed graph $G$ with vertex set $V=\\{1,2,3\\}$ and edge set $E=\\{(1,2),(1,3),(2,1),(2,3),(3,1),(3,2)\\}$. Let $A$ be the adjacency matrix of $G$ indexed by the vertex order $(1,2,3)$, so that\n$$\nA=\\begin{pmatrix}\n0  1  1 \\\\\n1  0  1 \\\\\n1  1  0\n\\end{pmatrix}.\n$$\nYou are asked to count directed walks (possibly revisiting vertices and edges) of a fixed length that avoid a specific directed edge. Formally, define the forbidden edge $e=(3,2)$, the source vertex $u=1$, the target vertex $v=2$, and the length parameter $k=5$. Using only the fundamental definition of adjacency matrices for directed graphs, and constructing your reasoning from first principles in data structures and algorithms, determine the exact number of directed walks from $u$ to $v$ of length exactly $k$ that do not use the edge $e$. Provide your final answer as a single integer. No rounding is required.",
            "solution": "The problem asks for the number of directed walks of a specific length between two vertices in a given directed graph, with the constraint that a particular edge must not be used.\n\nLet $G=(V, E)$ be a directed graph with $n$ vertices, and let $A$ be its adjacency matrix, where $A_{ij} = 1$ if there is an edge from vertex $i$ to vertex $j$, and $A_{ij} = 0$ otherwise. A fundamental principle in graph theory and algorithms states that the number of distinct walks of length $k$ from a source vertex $u$ to a target vertex $v$ is given by the entry $(u,v)$ of the matrix $A^k$. We can establish this principle by induction on the length $k$.\n\nBase case ($k=1$): A walk of length $1$ from $u$ to $v$ exists if and only if there is a directed edge $(u,v) \\in E$. The number of such walks is $1$ if $(u,v) \\in E$ and $0$ otherwise. This is precisely the definition of the adjacency matrix entry $A_{uv}$. Thus, the principle holds for $k=1$, as $(A^1)_{uv} = A_{uv}$.\n\nInductive step: Assume the principle holds for some length $m \\ge 1$. That is, the number of walks of length $m$ from any vertex $i$ to any vertex $j$ is given by $(A^m)_{ij}$. Now, consider a walk of length $m+1$ from $u$ to $v$. Any such walk consists of a walk of length $m$ from $u$ to some intermediate vertex $p \\in V$, followed by a single edge from $p$ to $v$. To find the total number of such walks, we can sum over all possible intermediate vertices $p$:\n$$\n\\text{Number of walks of length } m+1 \\text{ from } u \\text{ to } v = \\sum_{p \\in V} (\\text{Number of walks of length } m \\text{ from } u \\text{ to } p) \\times (\\text{Number of walks of length } 1 \\text{ from } p \\text{ to } v)\n$$\nUsing the inductive hypothesis and the base case, this sum can be written in terms of matrix entries:\n$$\n\\sum_{p=1}^{n} (A^m)_{up} \\cdot A_{pv}\n$$\nThis sum is, by the definition of matrix multiplication, the entry $(u,v)$ of the product matrix $A^m \\cdot A = A^{m+1}$. Thus, the number of walks of length $m+1$ from $u$ to $v$ is $(A^{m+1})_{uv}$. By the principle of mathematical induction, the statement holds for all integers $k \\ge 1$.\n\nThe problem requires us to count walks that do not use the forbidden edge $e=(3,2)$. This is equivalent to counting walks in a modified graph $G'$ which is identical to the original graph $G$ but with the edge $e$ removed. The adjacency matrix of this new graph, let's call it $A'$, will be identical to the original matrix $A$ except for the entry corresponding to the forbidden edge, which will be set to $0$.\n\nThe given adjacency matrix is:\n$$\nA = \\begin{pmatrix} 0  1  1 \\\\ 1  0  1 \\\\ 1  1  0 \\end{pmatrix}\n$$\nThe vertices are indexed in the order $(1, 2, 3)$. The forbidden edge $e=(3,2)$ corresponds to the entry in the $3$-rd row and $2$-nd column. We therefore construct the matrix $A'$ by setting this entry to $0$:\n$$\nA' = \\begin{pmatrix} 0  1  1 \\\\ 1  0  1 \\\\ 1  0  0 \\end{pmatrix}\n$$\nThe problem specifies the source vertex $u=1$, the target vertex $v=2$, and the walk length $k=5$. According to the established principle, the number of walks from $u$ to $v$ of length $k$ in the graph $G'$ is given by the entry $(1,2)$ of the matrix $(A')^5$. Our task is to compute this value.\n\nWe compute the powers of $A'$ sequentially.\nFirst, we find $A'^2$:\n$$\nA'^2 = A' \\cdot A' = \\begin{pmatrix} 0  1  1 \\\\ 1  0  1 \\\\ 1  0  0 \\end{pmatrix} \\begin{pmatrix} 0  1  1 \\\\ 1  0  1 \\\\ 1  0  0 \\end{pmatrix} = \\begin{pmatrix} 2  0  1 \\\\ 1  1  1 \\\\ 0  1  1 \\end{pmatrix}\n$$\nNext, we can compute $A'^4$ by squaring $A'^2$:\n$$\nA'^4 = A'^2 \\cdot A'^2 = \\begin{pmatrix} 2  0  1 \\\\ 1  1  1 \\\\ 0  1  1 \\end{pmatrix} \\begin{pmatrix} 2  0  1 \\\\ 1  1  1 \\\\ 0  1  1 \\end{pmatrix} = \\begin{pmatrix} 4  1  3 \\\\ 3  2  3 \\\\ 1  2  2 \\end{pmatrix}\n$$\nFinally, we compute $A'^5$ by multiplying $A'^4$ by $A'$:\n$$\nA'^5 = A'^4 \\cdot A' = \\begin{pmatrix} 4  1  3 \\\\ 3  2  3 \\\\ 1  2  2 \\end{pmatrix} \\begin{pmatrix} 0  1  1 \\\\ 1  0  1 \\\\ 1  0  0 \\end{pmatrix} = \\begin{pmatrix} 4  4  5 \\\\ 5  3  5 \\\\ 4  1  3 \\end{pmatrix}\n$$\nThe number of directed walks from vertex $u=1$ to vertex $v=2$ of length $k=5$ that do not use the edge $(3,2)$ is the entry $(1,2)$ of the matrix $A'^5$.\n$$\n((A')^5)_{12} = 4\n$$\nTherefore, there are exactly $4$ such walks.",
            "answer": "$$\n\\boxed{4}\n$$"
        },
        {
            "introduction": "Many problems in combinatorics and dynamic programming can be boiled down to solving linear recurrence relations. This practice problem challenges you to first model a counting problem—the number of ways to climb a staircase—as a recurrence, and then represent that recurrence using a transition matrix. By applying matrix exponentiation, you can efficiently compute the number of ways for a large number of steps, bypassing the much slower iterative approach.",
            "id": "3249460",
            "problem": "A staircase has $n$ steps. You can climb the staircase by taking steps whose sizes belong to the set $S = \\{1, 2, 5\\}$. Let $W(n)$ denote the number of distinct ordered sequences of steps (where order matters) whose sizes sum exactly to $n$. Assume that $W(0) = 1$ (the empty sequence is counted as one way) and that $W(k) = 0$ for all $k  0$. Starting from first principles of combinatorial decomposition and the shift-register representation of linear recurrences, derive a linear recurrence for $W(n)$, cast it into a matrix form suitable for fast exponentiation, and use this framework to determine $W(25)$. Express the final answer as an integer. No rounding is required.",
            "solution": "The problem asks for the number of ways, $W(n)$, to climb a staircase of $n$ steps using step sizes from $\\{1, 2, 5\\}$, and specifically to find $W(25)$. The solution must be derived using the matrix exponentiation framework.\n\n**1. Deriving the Linear Recurrence Relation**\nTo reach the $n$-th step, the final step must have a size of 1, 2, or 5. Since these cases are mutually exclusive, we can sum the number of ways to reach the preceding steps ($n-1$, $n-2$, and $n-5$, respectively). This gives the linear recurrence relation:\n$$W(n) = W(n-1) + W(n-2) + W(n-5)$$\nThe given base conditions are $W(0)=1$ and $W(k)=0$ for any $k  0$.\n\n**2. Matrix Representation**\nThe recurrence is of order 5, so we define a 5-dimensional state vector to capture the necessary history:\n$$V_n = \\begin{pmatrix} W(n) \\\\ W(n-1) \\\\ W(n-2) \\\\ W(n-3) \\\\ W(n-4) \\end{pmatrix}$$\nThe evolution of this state is governed by the linear transformation $V_n = M V_{n-1}$, where $M$ is the $5 \\times 5$ transition matrix. The matrix $M$ is constructed to reflect the recurrence relation in its first row and shift the remaining state elements down:\n$$M = \\begin{pmatrix} 1  1  0  0  1 \\\\ 1  0  0  0  0 \\\\ 0  1  0  0  0 \\\\ 0  0  1  0  0 \\\\ 0  0  0  1  0 \\end{pmatrix}$$\n\n**3. Applying Matrix Exponentiation**\nFrom the state update rule, it follows that $V_n = M^{n-k} V_k$ for any $n \\ge k$. To find $W(25)$, we compute $V_{25}$. A convenient starting point is the base vector $V_4$. We first compute its components using the recurrence:\n- $W(0) = 1$\n- $W(1) = W(0) = 1$\n- $W(2) = W(1) + W(0) = 1 + 1 = 2$\n- $W(3) = W(2) + W(1) = 2 + 1 = 3$\n- $W(4) = W(3) + W(2) = 3 + 2 = 5$\nThus, our base state vector is:\n$$V_4 = \\begin{pmatrix} 5 \\\\ 3 \\\\ 2 \\\\ 1 \\\\ 1 \\end{pmatrix}$$\nThe state vector for $n=25$ is then given by:\n$$V_{25} = M^{25-4} V_4 = M^{21} V_4$$\nThe required number, $W(25)$, is the first component of the resulting vector $V_{25}$. The matrix power $M^{21}$ is calculated efficiently using exponentiation by squaring in $O(\\log 21)$ matrix multiplications.\n\n**4. Final Calculation**\nBy computing the matrix power $M^{21}$ and multiplying it by the base vector $V_4$, we obtain the state vector $V_{25}$. The first element of this vector is the solution:\n$$W(25) = 401411$$",
            "answer": "$$\\boxed{401411}$$"
        },
        {
            "introduction": "Matrix exponentiation is a versatile tool that is not limited to standard integer arithmetic. This advanced exercise demonstrates its power within a different algebraic structure: the finite field $\\text{GF}(2)$, used here to determine the parity of the number of walks. You will discover that operating in a finite field can reveal periodic patterns in matrix powers, leading to elegant and extremely efficient solutions for problems with very large exponents.",
            "id": "3249427",
            "problem": "Let $A$ be the adjacency matrix of a directed graph on nodes $\\{1,2\\}$, given by\n$$\nA \\;=\\; \\begin{pmatrix}\n1  1\\\\\n1  0\n\\end{pmatrix}.\n$$\nBy definition, for any nonnegative integer $k$, the $(i,j)$-entry of $A^{k}$ equals the number of length-$k$ walks (allowing repeated vertices and edges) from node $i$ to node $j$ when arithmetic is carried out over the integers. We are interested in the parity of this count, which equals the $(i,j)$-entry of $A^{k}$ reduced modulo $2$.\n\nUsing only the definition of matrix multiplication and exponentiation, determine the parity (that is, the value in $\\{0,1\\}$) of the number of length-$k$ walks from node $1$ to node $2$ for $k = 2024$. Express your final answer as a single integer in $\\{0,1\\}$. No rounding is required or permitted. All arithmetic relevant to the parity must be taken modulo $2$ within the Galois Field (GF(2)).",
            "solution": "The problem requires the determination of the parity of the number of walks of length $k=2024$ from node $1$ to node $2$ in a directed graph defined by the adjacency matrix $A$. The arithmetic for determining parity is specified to be modulo $2$, which corresponds to computation in the Galois Field $\\text{GF}(2)$, also denoted $\\mathbb{F}_2$.\n\nFirst, we establish the mathematical formulation of the problem. The number of walks of length $k$ from a node $i$ to a node $j$ is given by the $(i,j)$-entry of the matrix $A^k$. We are asked for the parity of this number, which is equivalent to finding the value of this entry modulo $2$. This is mathematically equivalent to computing the matrix power $A^k$ where all arithmetic operations (addition and multiplication) are performed in $\\mathbb{F}_2$.\n\nLet $\\bar{A}$ be the matrix $A$ with its entries considered as elements of $\\mathbb{F}_2 = \\{0, 1\\}$.\nThe given matrix is:\n$$\nA \\;=\\; \\begin{pmatrix}\n1  1\\\\\n1  0\n\\end{pmatrix}\n$$\nSince all entries of $A$ are already in $\\{0, 1\\}$, the matrix $\\bar{A}$ over $\\mathbb{F}_2$ is identical in its representation:\n$$\n\\bar{A} \\;=\\; \\begin{pmatrix}\n1  1\\\\\n1  0\n\\end{pmatrix}\n$$\nThe problem is to find the $(1,2)$-entry of the matrix $\\bar{A}^{2024}$. We proceed by using the definition of matrix multiplication and exponentiation over $\\mathbb{F}_2$. Let us compute the first few powers of $\\bar{A}$.\n\nThe square of $\\bar{A}$ is:\n$$\n\\bar{A}^2 \\;=\\; \\bar{A} \\cdot \\bar{A} \\;=\\; \\begin{pmatrix}\n1  1\\\\\n1  0\n\\end{pmatrix}\n\\begin{pmatrix}\n1  1\\\\\n1  0\n\\end{pmatrix} \\;=\\; \\begin{pmatrix}\n1 \\cdot 1 + 1 \\cdot 1  1 \\cdot 1 + 1 \\cdot 0 \\\\\n1 \\cdot 1 + 0 \\cdot 1  1 \\cdot 1 + 0 \\cdot 0\n\\end{pmatrix}\n$$\nPerforming the arithmetic modulo $2$:\n$$\n\\bar{A}^2 \\;=\\; \\begin{pmatrix}\n1 + 1  1 + 0 \\\\\n1 + 0  1 + 0\n\\end{pmatrix} \\pmod 2 \\;=\\; \\begin{pmatrix}\n0  1 \\\\\n1  1\n\\end{pmatrix}\n$$\nNext, we compute the cube of $\\bar{A}$:\n$$\n\\bar{A}^3 \\;=\\; \\bar{A}^2 \\cdot \\bar{A} \\;=\\; \\begin{pmatrix}\n0  1 \\\\\n1  1\n\\end{pmatrix}\n\\begin{pmatrix}\n1  1\\\\\n1  0\n\\end{pmatrix} \\;=\\; \\begin{pmatrix}\n0 \\cdot 1 + 1 \\cdot 1  0 \\cdot 1 + 1 \\cdot 0 \\\\\n1 \\cdot 1 + 1 \\cdot 1  1 \\cdot 1 + 1 \\cdot 0\n\\end{pmatrix}\n$$\nPerforming the arithmetic modulo $2$:\n$$\n\\bar{A}^3 \\;=\\; \\begin{pmatrix}\n0 + 1  0 + 0 \\\\\n1 + 1  1 + 0\n\\end{pmatrix} \\pmod 2 \\;=\\; \\begin{pmatrix}\n1  0 \\\\\n0  1\n\\end{pmatrix} \\;=\\; I\n$$\nwhere $I$ is the $2 \\times 2$ identity matrix.\n\nThe fact that $\\bar{A}^3 = I$ implies that the sequence of powers of $\\bar{A}$ is periodic. For any integer $n \\ge 1$, we have $\\bar{A}^{n+3} = \\bar{A}^n \\cdot \\bar{A}^3 = \\bar{A}^n \\cdot I = \\bar{A}^n$. The sequence of matrices $(\\bar{A}^k)_{k \\ge 1}$ is periodic with a period of $3$.\n\nTo compute $\\bar{A}^{2024}$, we can exploit this periodicity by finding the remainder of the exponent $2024$ upon division by $3$. We can use the property that an integer is congruent to the sum of its digits modulo $3$.\nThe sum of the digits of $2024$ is $2+0+2+4=8$.\nThe remainder of $8$ when divided by $3$ is $2$, because $8 = 2 \\times 3 + 2$.\nThus, we have $2024 \\equiv 2 \\pmod 3$.\n\nThis allows us to simplify the exponentiation. We can write $2024 = 3 \\cdot 674 + 2$.\n$$\n\\bar{A}^{2024} \\;=\\; \\bar{A}^{3 \\cdot 674 + 2} \\;=\\; (\\bar{A}^3)^{674} \\cdot \\bar{A}^2\n$$\nSubstituting $\\bar{A}^3 = I$:\n$$\n\\bar{A}^{2024} \\;=\\; (I)^{674} \\cdot \\bar{A}^2 \\;=\\; I \\cdot \\bar{A}^2 \\;=\\; \\bar{A}^2\n$$\nThe problem is thereby reduced to finding the $(1,2)$-entry of $\\bar{A}^2$. From our earlier calculation:\n$$\n\\bar{A}^2 \\;=\\; \\begin{pmatrix}\n0  1 \\\\\n1  1\n\\end{pmatrix}\n$$\nThe entry in the first row and second column, $(\\bar{A}^2)_{1,2}$, is $1$.\n\nTherefore, the parity of the number of length-$2024$ walks from node $1$ to node $2$ is odd, which corresponds to the value $1$ in $\\mathbb{F}_2$.",
            "answer": "$$\\boxed{1}$$"
        }
    ]
}