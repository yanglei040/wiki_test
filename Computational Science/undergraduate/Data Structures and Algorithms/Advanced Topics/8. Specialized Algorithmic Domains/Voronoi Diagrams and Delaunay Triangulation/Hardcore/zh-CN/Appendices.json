{
    "hands_on_practices": [
        {
            "introduction": "沃罗诺伊图中的一个基本构成元素是沃罗诺伊顶点，它是一个与三个或更多生成点等距的特殊点。在几何上，这个点正是由这三个点构成的三角形的外接圆圆心。本练习将通过一个天体物理学的假想情景，引导你实践计算沃罗诺伊顶点的基本方法，这对于理解沃罗诺伊图的结构至关重要。",
            "id": "2175770",
            "problem": "在计算天体物理学中，沃罗诺伊图被用来模拟天体周围的影响区域。一位天文学家正在分析一个新勘测的空间区域，并确定了三个不同的、不共线的脉冲星：PSR-A、PSR-B 和 PSR-C。在一个以光年为单位的二维笛卡尔坐标图上，这些脉冲星的位置分别为 $P_A = (1, 7)$、$P_B = (9, 1)$ 和 $P_C = (-3, -3)$。\n\n一个理论模型表明，在该平面中存在一个与这三颗脉冲星等距的唯一点。这个点在几何上具有重要意义，因为它代表了由这三个生成点定义的唯一沃罗诺伊顶点。确定该点对于校准一种新型引力波探测器至关重要。\n\n确定这个沃罗诺伊顶点的坐标 $(x_V, y_V)$。",
            "solution": "沃罗诺伊顶点是与给定的三个点 $P_A = (1, 7)$、$P_B = (9, 1)$ 和 $P_C = (-3, -3)$ 等距的点 $(x_V, y_V)$。这个点是由 $P_A$、$P_B$ 和 $P_C$ 构成的三角形的外心。外心可以通过求三角形各边垂直平分线的交点来找到。我们只需要求出其中两条垂直平分线的方程，然后解所得的线性方程组。\n\n我们来求线段 $P_A P_B$ 的垂直平分线方程。\n首先，我们求连接 $P_A$ 和 $P_B$ 的线段的中点 $M_{AB}$：\n$$\nM_{AB} = \\left( \\frac{x_A + x_B}{2}, \\frac{y_A + y_B}{2} \\right) = \\left( \\frac{1 + 9}{2}, \\frac{7 + 1}{2} \\right) = (5, 4)\n$$\n接下来，我们确定线段 $P_A P_B$ 的斜率 $m_{AB}$：\n$$\nm_{AB} = \\frac{y_B - y_A}{x_B - x_A} = \\frac{1 - 7}{9 - 1} = \\frac{-6}{8} = -\\frac{3}{4}\n$$\n垂直平分线的斜率 $m_{\\perp AB}$ 是 $m_{AB}$ 的负倒数：\n$$\nm_{\\perp AB} = -\\frac{1}{m_{AB}} = -\\frac{1}{-3/4} = \\frac{4}{3}\n$$\n使用点 $M_{AB}=(5,4)$ 和斜率 $m_{\\perp AB} = 4/3$，通过点斜式方程，我们得到第一条垂直平分线的方程：\n$$\ny - 4 = \\frac{4}{3}(x - 5)\n$$\n$$\ny = \\frac{4}{3}x - \\frac{20}{3} + 4 = \\frac{4}{3}x - \\frac{20}{3} + \\frac{12}{3}\n$$\n$$\ny = \\frac{4}{3}x - \\frac{8}{3}\n$$\n为了消去分数，我们可以将其写为 $3y = 4x - 8$，或 $4x - 3y = 8$。（方程1）\n\n现在，我们来求线段 $P_B P_C$ 的垂直平分线方程。\n首先，我们求连接 $P_B = (9,1)$ 和 $P_C = (-3,-3)$ 的线段的中点 $M_{BC}$：\n$$\nM_{BC} = \\left( \\frac{x_B + x_C}{2}, \\frac{y_B + y_C}{2} \\right) = \\left( \\frac{9 + (-3)}{2}, \\frac{1 + (-3)}{2} \\right) = \\left( \\frac{6}{2}, \\frac{-2}{2} \\right) = (3, -1)\n$$\n接下来，我们确定线段 $P_B P_C$ 的斜率 $m_{BC}$：\n$$\nm_{BC} = \\frac{y_C - y_B}{x_C - x_B} = \\frac{-3 - 1}{-3 - 9} = \\frac{-4}{-12} = \\frac{1}{3}\n$$\n垂直平分线的斜率 $m_{\\perp BC}$ 是 $m_{BC}$ 的负倒数：\n$$\nm_{\\perp BC} = -\\frac{1}{m_{BC}} = -\\frac{1}{1/3} = -3\n$$\n使用点 $M_{BC}=(3,-1)$ 和斜率 $m_{\\perp BC} = -3$，通过点斜式，我们得到第二条垂直平分线的方程：\n$$\ny - (-1) = -3(x - 3)\n$$\n$$\ny + 1 = -3x + 9\n$$\n$$\ny = -3x + 8\n$$\n（方程2）\n\n最后，我们通过解这两个线性方程组成的方程组来求交点 $(x_V, y_V)$：\n1. $4x - 3y = 8$\n2. $y = -3x + 8$\n\n将方程2代入方程1：\n$$\n4x - 3(-3x + 8) = 8\n$$\n$$\n4x + 9x - 24 = 8\n$$\n$$\n13x = 32\n$$\n$$\nx_V = \\frac{32}{13}\n$$\n现在将 $x_V$ 的值代回方程2以求出 $y_V$：\n$$\ny_V = -3\\left(\\frac{32}{13}\\right) + 8 = -\\frac{96}{13} + \\frac{8 \\cdot 13}{13} = -\\frac{96}{13} + \\frac{104}{13} = \\frac{8}{13}\n$$\n因此，沃罗诺伊顶点的坐标是 $\\left(\\frac{32}{13}, \\frac{8}{13}\\right)$。",
            "answer": "$$\\boxed{\\left(\\frac{32}{13}, \\frac{8}{13}\\right)}$$"
        },
        {
            "introduction": "德劳内三角剖分与沃罗诺伊图是彼此的对偶，它们之间存在着深刻的联系。一个“好”的三角剖分通常满足德劳内条件，即任何三角形的外接圆内部都不包含点集中的任何其他点。本练习提供了一个具体情境，让你判断一条给定的内边是否满足德劳内条件，并理解何时需要通过“边翻转”来优化三角剖分。",
            "id": "2175772",
            "problem": "为了监测一个偏远的生态区，部署了四个自动传感器站，分别记为 $S_1, S_2, S_3,$ 和 $S_4$。它们在二维笛卡尔平面上的位置由坐标 $S_1(0, 0)$, $S_2(8, 2)$, $S_3(6, 9),$ 和 $S_4(-2, 5)$ 给出。坐标单位为米。\n\n为了建立一个通信网络，这些站点最初被连接起来形成一个三角剖分。这些连接构成了四边形 $S_1S_2S_3S_4$ 的周长，以及一条内部连线 $S_1S_3$，该连线将该区域划分为两个三角形：$\\triangle S_1S_2S_3$ 和 $\\triangle S_1S_3S_4$。\n\n为实现最优信号三角测量，该网络必须满足德劳内条件 (Delaunay condition)。一个三角剖分是德劳内三角剖分，条件是对于网络中的每一个三角形，其外接圆（通过其三个顶点的唯一圆）的内部不包含任何其他站点。对于由两个三角形共享的一条内部边，如果第四个顶点（不属于该边的顶点）位于由该边和另一个顶点组成的三角形的外接圆内部，则该条件被违反。如果一条边违反了此条件，它就被认为是非德劳内的，并且必须通过“翻转”到四边形的另一条对角线来改进三角剖分。\n\n给定初始设置，以下哪个陈述正确地描述了内部边 $S_1S_3$ 的状态以及所需的操作？\n\nA) 边 $S_1S_3$ 是德劳内边，不需要任何更改。\nB) 边 $S_1S_3$ 不是德劳内边，应通过翻转将其替换为边 $S_2S_4$。\nC) 替代边 $S_2S_4$ 将是非德劳内边，而当前边 $S_1S_3$ 是德劳内边。\nD) 四个站点共线，无法形成有效的三角剖分。\nE) 四个站点形成一个凹四边形，无法通过简单的边翻转来解决。",
            "solution": "给定 $S_{1}(0,0)$, $S_{2}(8,2)$, $S_{3}(6,9)$ 和 $S_{4}(-2,5)$。当前的三角剖分使用内部边 $S_{1}S_{3}$，形成三角形 $\\triangle S_{1}S_{2}S_{3}$ 和 $\\triangle S_{1}S_{3}S_{4}$。\n\n首先，验证多边形 $S_{1}S_{2}S_{3}S_{4}$ 是严格凸的（以排除选项D和E，并确保有效的局部德劳内翻转测试适用）。计算连续三元组的有向面积（方向）：\n- 对于 $(S_{1},S_{2},S_{3})$，使用 $(S_{2}-S_{1}) \\times (S_{3}-S_{1})$：$(8,2) \\times (6,9)$ 得到 $8\\cdot 9 - 2\\cdot 6 = 60 > 0$。\n- 对于 $(S_{2},S_{3},S_{4})$：$(S_{3}-S_{2})=(-2,7)$，$(S_{4}-S_{2})=(-10,3)$，叉积为 $(-2)\\cdot 3 - 7\\cdot(-10) = 64 > 0$。\n- 对于 $(S_{3},S_{4},S_{1})$：$(S_{4}-S_{3})=(-8,-4)$，$(S_{1}-S_{3})=(-6,-9)$，叉积为 $(-8)\\cdot(-9) - (-4)\\cdot(-6) = 48 > 0$。\n- 对于 $(S_{4},S_{1},S_{2})$：$(S_{1}-S_{4})=(2,-5)$，$(S_{2}-S_{4})=(10,-3)$，叉积为 $2\\cdot(-3) - (-5)\\cdot 10 = 44 > 0$。\n所有四个结果均为正值，因此按给定顺序该四边形是严格凸的。\n\n对于内部边 $S_{1}S_{3}$ 的局部德劳内条件要求，每个相邻三角形的对顶点必须位于另一个三角形的外接圆的外部。我们只需检验点 $S_{2}$ 是否位于 $\\triangle S_{1}S_{3}S_{4}$ 的外接圆内部（或等价地，检验点 $S_{4}$ 是否位于 $\\triangle S_{1}S_{2}S_{3}$ 的外接圆内部）。我们使用外接圆测试行列式 (in-circle determinant)，并对参考三角形的顶点采用逆时针排序。\n\n首先，确认 $\\triangle S_{1}S_{3}S_{4}$ 的方向是逆时针的：\n$$(S_{3}-S_{1}) \\times (S_{4}-S_{1}) = (6,9) \\times (-2,5) = 6\\cdot 5 - 9\\cdot(-2) = 48 > 0,$$\n所以 $(S_{1},S_{3},S_{4})$ 是逆时针序。\n\n定义 $r_{i} = x_{i}^{2} + y_{i}^{2}$。计算\n$$r_{1} = 0^{2} + 0^{2} = 0,\\quad r_{3} = 6^{2} + 9^{2} = 117,\\quad r_{4} = (-2)^{2} + 5^{2} = 29,\\quad r_{2} = 8^{2} + 2^{2} = 68.$$\n用于检验 $S_{2}$ 是否在 $\\triangle S_{1}S_{3}S_{4}$ 外接圆内部的外接圆测试行列式为\n$$\\Delta = \n\\begin{vmatrix}\nx_{1} & y_{1} & r_{1} & 1 \\\\\nx_{3} & y_{3} & r_{3} & 1 \\\\\nx_{4} & y_{4} & r_{4} & 1 \\\\\nx_{2} & y_{2} & r_{2} & 1\n\\end{vmatrix}\n=\n\\begin{vmatrix}\n0 & 0 & 0 & 1 \\\\\n6 & 9 & 117 & 1 \\\\\n-2 & 5 & 29 & 1 \\\\\n8 & 2 & 68 & 1\n\\end{vmatrix}.$$\n沿第一行展开得\n$$\\Delta = -\\begin{vmatrix}\n6 & 9 & 117 \\\\\n-2 & 5 & 29 \\\\\n8 & 2 & 68\n\\end{vmatrix}.$$\n计算这个 $3\\times 3$ 行列式：\n\\begin{align*}\n\\begin{vmatrix}\n6 & 9 & 117 \\\\\n-2 & 5 & 29 \\\\\n8 & 2 & 68\n\\end{vmatrix}\n&= 6\\,(5\\cdot 68 - 29\\cdot 2) - 9\\,((-2)\\cdot 68 - 29\\cdot 8) + 117\\,((-2)\\cdot 2 - 5\\cdot 8) \\\\\n&= 6\\,(340 - 58) - 9\\,(-136 - 232) + 117\\,(-4 - 40) \\\\\n&= 6\\cdot 282 - 9\\cdot(-368) + 117\\cdot(-44) \\\\\n&= 1692 + 3312 - 5148 \\\\\n&= -144.\n\\end{align*}\n因此 $\\Delta = -(-144) = 144 > 0$。因为三角形顶点是逆时针排序，且行列式为正，所以点 $S_{2}$ 位于 $\\triangle S_{1}S_{3}S_{4}$ 的外接圆内部。\n\n因此，内部边 $S_{1}S_{3}$ 违反了德劳内条件，必须翻转成另一条对角线 $S_{2}S_{4}$。这对应于选项B。",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "理解了基本定义后，让我们来探索一个更深入的问题：当我们对一个点集进行坐标变换时，它的德劳内三角剖分会保持不变吗？此问题将揭示德劳内三角剖分的一个重要特性：它在旋转、平移和均匀缩放等欧几里得变换下是不变的，但对于非均匀缩放这类仿射变换则不然。通过解决这个问题，你将更深刻地理解德劳内条件与欧几里得距离的内在联系。",
            "id": "2175764",
            "problem": "考虑笛卡尔平面上的一个四点集，$S = \\{P_1, P_2, P_3, P_4\\}$，其坐标为：\n$P_1 = (-2, 0)$\n$P_2 = (0, 1)$\n$P_3 = (2, 0)$\n$P_4 = (0, -1.1)$\n\n这四个点构成一个凸四边形。该四边形的一种三角剖分可以通过选择两条可能的内部对角线之一来形成：连接$P_1$和$P_3$的线段$D_1$，或者连接$P_2$和$P_4$的线段$D_2$。Delaunay三角剖分的定义是：对于该剖分中的每一个构成三角形，其外接圆的内部不包含该点集的第四个点。\n\n现在，考虑一个新的点集$S'$，它是通过对原始点集$S$中的每个点应用非均匀缩放变换$T(x,y) = (x, 2y)$而创建的。\n\n确定哪条对角线（$D_1$或$D_2$）对应于原始点集$S$的Delaunay三角剖分，以及哪条变换后的对角线（$D_1'$或$D_2'$）对应于新点集$S'$的Delaunay三角剖分。\n\nA. 原始点集$S$：对角线$D_1$；变换后点集$S'$：对角线$D_1'$\nB. 原始点集$S$：对角线$D_1$；变换后点集$S'$：对角线$D_2'$\nC. 原始点集$S$：对角线$D_2$；变换后点集$S'$：对角线$D_1'$\nD. 原始点集$S$：对角线$D_2$；变换后点集$S'$：对角线$D_2'$",
            "solution": "给定四个点$P_{1}=(-2,0)$, $P_{2}=(0,1)$, $P_{3}=(2,0)$, $P_{4}=(0,-1.1)$，它们构成一个凸四边形。两条可能的对角线是$D_{1}=\\overline{P_{1}P_{3}}$和$D_{2}=\\overline{P_{2}P_{4}}$。根据Delaunay准则，对于所选的对角线，形成的两个三角形中的每一个，其相对顶点都必须位于其外接圆的外部。\n\n首先确定原始点集$S$的情况。考虑使用对角线$D_{1}$的三角剖分，它产生三角形$T_{\\text{top}}=(P_{1},P_{2},P_{3})$和$T_{\\text{bot}}=(P_{1},P_{3},P_{4})$。只需测试其中一个即可；如果相对的点位于其外接圆内部，则使用$D_{1}$的剖分不是Delaunay三角剖分。\n\n计算通过$P_{1}=(-2,0)$, $P_{2}=(0,1)$, $P_{3}=(2,0)$的三角形$T_{\\text{top}}$的外接圆。根据对称性，圆心位于$y$轴上。线段$\\overline{P_{1}P_{2}}$的垂直平分线经过中点$M_{12}=(-1,\\tfrac{1}{2})$，由于$\\overline{P_{1}P_{2}}$的斜率为$\\tfrac{1}{2}$，其斜率为$-2$。其方程为\n$$\ny-\\tfrac{1}{2}=-2\\left(x+1\\right)\\;\\;\\Rightarrow\\;\\;y=-2x-\\tfrac{3}{2}.\n$$\n与$y$轴$x=0$相交，得到圆心\n$$\nC_{\\text{top}}=(0,-\\tfrac{3}{2}).\n$$\n半径是到$P_{2}$的距离：\n$$\nr_{\\text{top}}=\\sqrt{(0-0)^{2}+(1-(-\\tfrac{3}{2}))^{2}}=\\tfrac{5}{2}.\n$$\n通过计算$P_{4}=(0,-1.1)$到$C_{\\text{top}}$的距离来检验该点是否在此圆内部：\n$|P_{4}-C_{\\text{top}}|=\\sqrt{(0-0)^{2}+(-1.1-(-\\frac{3}{2}))^{2}}=0.4  r_{\\text{top}}$。\n因此，$P_{4}$严格位于$T_{\\text{top}}$的外接圆内部，所以使用$D_{1}$的三角剖分违反了Delaunay条件。因此，对于原始点集$S$，Delaunay三角剖分使用另一条对角线$D_{2}$。\n\n现在应用非均匀缩放$T(x,y)=(x,2y)$来获得$S'$，其点为\n$$\nP_{1}'=(-2,0),\\quad P_{2}'=(0,2),\\quad P_{3}'=(2,0),\\quad P_{4}'=(0,-2.2).\n$$\n再次测试使用对角线$D_{1}'=\\overline{P_{1}'P_{3}'}$的三角剖分，其上方的三角形是$T_{\\text{top}}'=(P_{1}',P_{2}',P_{3}')$。计算其外接圆。根据对称性，圆心位于$y$轴上。线段$\\overline{P_{1}'P_{2}'}$的垂直平分线经过中点$M_{12}'=(-1,1)$；$\\overline{P_{1}'P_{2}'}$的斜率为$1$，因此垂直斜率为$-1$。其方程为\n$$\ny-1=-1(x+1)\\;\\;\\Rightarrow\\;\\;y=-x.\n$$\n与$x=0$相交，得到圆心\n$$\nC_{\\text{top}}'=(0,0),\n$$\n半径为\n$$\nr_{\\text{top}}'=\\sqrt{(0-0)^{2}+(2-0)^{2}}=2.\n$$\n检验$P_{4}'=(0,-2.2)$是否在此圆内部：\n$$\n|P_{4}'-C_{\\text{top}}'|=\\sqrt{(0-0)^{2}+(-2.2-0)^{2}}=2.22=r_{\\text{top}}'.\n$$\n因此，$P_{4}'$位于$T_{\\text{top}}'$的外接圆外部，所以使用$D_{1}'$的三角剖分满足Delaunay空圆条件（因此是Delaunay的选择）。因此，对于$S'$，Delaunay三角剖分使用对角线$D_{1}'$。\n\n综合两个判定：原始点集$S$使用$D_{2}$，变换后点集$S'$使用$D_{1}'$，这对应于选项C。",
            "answer": "$$\\boxed{C}$$"
        }
    ]
}