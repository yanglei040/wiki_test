{
    "hands_on_practices": [
        {
            "introduction": "一个真正安全的伪随机生成器不应给观察者留下任何统计线索。第一个练习将挑战你扮演密码破译者的角色，为一个简单的生成器设计一个“区分器”。通过识别输出比特之间的可预测关系，你将精确地量化这个生成器为何以及如何未能通过真随机性的测试。",
            "id": "1439184",
            "problem": "在计算复杂性理论中，伪随机生成器（PRG）是一种高效的确定性算法，它接收一个短的真随机种子，并将其扩展为一个更长的字符串，该字符串在计算上与同等长度的真随机字符串是不可区分的。\n\n让我们来分析一个简单的PRG候选者。考虑一个为任意整数 $s \\ge 1$ 定义的生成器 $G: \\{0,1\\}^s \\to \\{0,1\\}^{s+1}$。对于任何输入种子 $x \\in \\{0,1\\}^s$，该生成器产生输出 $G(x) = x || \\text{parity}(x)$，其中 `||` 表示字符串拼接，而 $\\text{parity}(x)$ 是 $x$ 的各位比特之和模2的值。例如，如果 $s=3$ 且 $x=101$，则 $\\text{parity}(x) = (1+0+1) \\pmod 2 = 0$，所以 $G(101) = 1010$。\n\n如果存在一个称为区分器 $D$ 的高效算法，能够以不可忽略的优势将其输出与真随机字符串区分开来，那么这个PRG就被认为是“被攻破”的。区分器 $D$ 是一个算法，它接收一个长度为 $s+1$ 的字符串作为输入，并输出1（猜测输入来自PRG）或0（猜测输入是真随机的）。\n\n区分器 $D$ 对于生成器 $G$ 的优势定义为：\n$$ \\text{Adv}_G(D) = \\left| \\Pr_{x \\sim U_s}[D(G(x)) = 1] - \\Pr_{y \\sim U_{s+1}}[D(y) = 1] \\right| $$\n其中 $U_n$ 表示在所有长度为 $n$ 的二进制字符串上的均匀分布。\n\n你的任务是证明生成器 $G(x) = x || \\text{parity}(x)$ 不是一个安全的PRG。首先，为区分器 $D$ 设计一个简单、高效的算法。然后，计算你所提出的区分器的确切优势 $\\text{Adv}_G(D)$。最终答案应为这个单一的数值。",
            "solution": "定义一个高效的区分器 $D$，对于输入 $y \\in \\{0,1\\}^{s+1}$，它将 $y$ 解析为 $y=a||b$，其中 $a \\in \\{0,1\\}^{s}$ 且 $b \\in \\{0,1\\}$，计算 $\\text{parity}(a)$（$a$ 的各位比特之和模2的值），当且仅当 $b=\\text{parity}(a)$ 时输出1；否则输出0。这个算法是高效的，因为计算奇偶性和单个比较都是多项式时间操作。\n\n当 $y$ 的形式为 $G(x)$，其中 $x \\sim U_{s}$ 时，根据定义我们有 $G(x)=x||\\text{parity}(x)$，所以对于每个输入，最后一个比特都等于前 $s$ 个比特的奇偶性。因此，\n$$\n\\Pr_{x \\sim U_{s}}[D(G(x))=1]=1.\n$$\n当 $y \\sim U_{s+1}$ 是真均匀分布时，将 $y$ 写为 $y=a||b$，其中 $a \\in \\{0,1\\}^{s}$ 且 $b \\in \\{0,1\\}$。对于任何固定的 $a$，$\\text{parity}(a)$ 的值是固定的，而 $b$ 是均匀且独立的，所以\n$$\n\\Pr[b=\\text{parity}(a)\\mid a]=\\frac{1}{2}.\n$$\n根据全概率定律以及 $a$ 的均匀性，\n$$\n\\Pr_{y \\sim U_{s+1}}[D(y)=1]=\\sum_{a \\in \\{0,1\\}^{s}} \\Pr[a]\\Pr[b=\\text{parity}(a)\\mid a]=\\sum_{a \\in \\{0,1\\}^{s}} 2^{-s}\\cdot \\frac{1}{2}=\\frac{1}{2}.\n$$\n因此，区分优势为\n$$\n\\text{Adv}_{G}(D)=\\left|\\Pr_{x \\sim U_{s}}[D(G(x))=1]-\\Pr_{y \\sim U_{s+1}}[D(y)=1]\\right|=\\left|1-\\frac{1}{2}\\right|=\\frac{1}{2}.\n$$\n这个不可忽略的优势表明 $G$ 不是一个安全的PRG。",
            "answer": "$$\\boxed{\\frac{1}{2}}$$"
        },
        {
            "introduction": "伪随机生成器中的可预测性可以有多种形式，不仅仅是简单的算术关系。在这个练习中，我们将探索一个在其输出上施加全局结构模式——对称性——的生成器。你的任务是利用这种回文结构，证明尽管其输出乍一看可能显得随机，但其潜在的可预测性使其变得不安全。",
            "id": "1439190",
            "problem": "在计算复杂性理论领域，伪随机生成器（PRG）是一种确定性算法，它接受一个短的均匀随机种子，并将其扩展为一个更长的字符串，该字符串对于任何计算能力有界的观察者来说都显得是随机的。\n\n形式上，生成器是一个函数 $G: \\{0,1\\}^s \\to \\{0,1\\}^n$，其中 $n  s$，$s$ 是种子长度。区分器是一个算法 $D: \\{0,1\\}^n \\to \\{0,1\\}$，它试图区分生成器的输出和一个真正的随机字符串。\n\n区分器 $D$ 对于生成器 $G$ 的“优势”，记作 $Adv_G(D)$，用于衡量其成功程度。其定义如下：\n$Adv_G(D) = \\left| \\Pr_{x \\leftarrow \\{0,1\\}^s}[D(G(x)) = 1] - \\Pr_{y \\leftarrow \\{0,1\\}^n}[D(y) = 1] \\right|$,\n其中，符号 $v \\leftarrow S$ 表示 $v$ 是从集合 $S$ 中均匀随机选择的。如果存在一个高效的（多项式时间）区分器，其优势不可忽略，则该生成器被认为是不安全的。\n\n考虑一个特定的、简单的生成器 $G_{pal}: \\{0,1\\}^s \\to \\{0,1\\}^{2s}$，其中 $s$ 是一个正整数。对于给定的种子 $x \\in \\{0,1\\}^s$，输出由种子及其反转串联而成。如果 $x^R$ 表示字符串 $x$ 的反转，则 $G_{pal}(x) = x \\mathbin{\\|} x^R$。\n\n现在，考虑一个区分器 $D_{test}$，它作用于长度为 $2s$ 的字符串。该区分器旨在检查一种特定的结构特性。对于输入 $z \\in \\{0,1\\}^{2s}$，如果 $z$ 是一个回文串（即，$z$ 正向和反向读取都相同），$D_{test}(z)$ 输出 1，否则输出 0。\n\n您的任务是计算这个区分器 $D_{test}$ 的优势 $Adv_{G_{pal}}(D_{test})$。请将您的答案表示为种子长度 $s$ 的函数。",
            "solution": "根据定义，区分器 $D$ 对抗生成器 $G$ 的优势为\n$$\nAdv_{G}(D)=\\left|\\Pr_{x\\leftarrow\\{0,1\\}^{s}}\\left[D(G(x))=1\\right]-\\Pr_{y\\leftarrow\\{0,1\\}^{n}}\\left[D(y)=1\\right]\\right|.\n$$\n这里，$G_{pal}:\\{0,1\\}^{s}\\to\\{0,1\\}^{2s}$ 由 $G_{pal}(x)=x\\mathbin{\\|} x^{R}$ 给出，而 $D_{test}$ 对 $z\\in\\{0,1\\}^{2s}$ 输出 $1$ 当且仅当 $z$ 是一个回文串。\n\n首先，对于任何 $x\\in\\{0,1\\}^{s}$，令 $z=G_{pal}(x)=x\\mathbin{\\|} x^{R}$。那么 $z$ 的反转是\n$$\nz^{R}=(x\\mathbin{\\|} x^{R})^{R}=(x^{R})^{R}\\mathbin{\\|} x^{R}=x\\mathbin{\\|} x^{R}=z,\n$$\n所以 $z$ 是一个回文串。因此，\n$$\n\\Pr_{x\\leftarrow\\{0,1\\}^{s}}\\left[D_{test}(G_{pal}(x))=1\\right]=1.\n$$\n\n其次，对于一个从 $\\{0,1\\}^{2s}$ 中均匀随机选取的 $y$，$y$ 是否为回文串的事件完全由其前 $s$ 个比特决定；一旦前 $s$ 个比特确定，后 $s$ 个比特必须是它们的反转。因此，在 $\\{0,1\\}^{2s}$ 中回文串的数量是 $2^{s}$，而字符串的总数是 $2^{2s}$。所以，\n$$\n\\Pr_{y\\leftarrow\\{0,1\\}^{2s}}\\left[D_{test}(y)=1\\right]=\\frac{2^{s}}{2^{2s}}=2^{-s}.\n$$\n\n综合以上两点，优势为\n$$\nAdv_{G_{pal}}(D_{test})=\\left|1-2^{-s}\\right|=1-2^{-s},\n$$\n因为对于正整数 $s$，$1\\geq 2^{-s}$。",
            "answer": "$$\\boxed{1-2^{-s}}$$"
        },
        {
            "introduction": "在学习了如何破解不安全的生成器之后，一项关键技能是理解如何构建安全的生成器。这个问题将我们的视角从攻击转向构建，探讨对一个安全的伪随机生成器进行简单变换是否能保持其安全性。你将使用归约证明（一种密码学和计算复杂性理论中的基本技巧）来形式化地推理伪随机性的属性。",
            "id": "1439188",
            "problem": "在计算复杂性理论中，伪随机生成器 (PRG) 是一种确定性算法，它接收一个短的、真正的随机种子，并将其扩展成一个更长的伪随机字符串。如果输出与相同长度的真随机字符串在计算上不可区分，则该输出被认为是伪随机的。\n\n形式上，一个函数 $G: \\{0,1\\}^n \\to \\{0,1\\}^m$，其中输出长度 $m=m(n)$ 是种子长度 $n$ 的一个多项式且 $m(n)  n$，如果对于每一个概率多项式时间 (PPT) 算法 $D$（称为区分器），以下不等式成立，则该函数是一个安全的PRG：\n$$\n|\\Pr_{x \\sim U_n}[D(G(x)) = 1] - \\Pr_{y \\sim U_m}[D(y) = 1]| \\le \\epsilon(n)\n$$\n其中 $x \\sim U_n$ 表示种子 $x$ 是从 $\\{0,1\\}^n$ 中均匀随机选择的，$y \\sim U_m$ 表示 $y$ 是从 $\\{0,1\\}^m$ 中均匀随机选择的，而 $\\epsilon(n)$ 是一个可忽略函数（一个比任何多项式的倒数下降得更快的函数）。\n\n假设给定一个函数 $G: \\{0,1\\}^n \\to \\{0,1\\}^m$，它是一个安全的PRG。现在，考虑一个新的生成器 $G_{neg}: \\{0,1\\}^n \\to \\{0,1\\}^m$，定义为 $G_{neg}(x) = \\neg G(x)$，其中 $\\neg$ 是按位取反运算（即，对于比特串 $y=y_1y_2...y_m$，运算 $\\neg y$ 会得到一个新字符串 $z=z_1z_2...z_m$，使得对于所有的 $i$ 都有 $z_i = 1 - y_i$）。\n\n关于 $G_{neg}$ 的安全性，以下哪个陈述是正确的？\n\nA. $G_{neg}$ 始终是一个安全的PRG。\nB. $G_{neg}$ 永远不是一个安全的PRG。\nC. $G_{neg}$ 的安全性取决于 $G$ 的具体构造，无法一概而论。\nD. $G_{neg}$ 的安全性是一个计算上不可判定问题。",
            "solution": "设 $G:\\{0,1\\}^{n}\\to\\{0,1\\}^{m}$ 是一个安全的PRG，并定义 $G_{neg}(x)=\\neg G(x)$，其中 $\\neg$ 是在 $\\{0,1\\}^{m}$ 上的按位取反运算。我们通过归约法证明 $G_{neg}$ 也是一个安全的PRG。设 $D$ 是任意一个试图区分 $G_{neg}(U_{n})$ 和 $U_{m}$ 的PPT区分器。定义一个新的PPT区分器 $D':\\{0,1\\}^{m}\\to\\{0,1\\}$ 为 $D'(y)=D(\\neg y)$。映射 $y\\mapsto\\neg y$ 是 $\\{0,1\\}^{m}$ 上的一个双射，并且可在多项式时间内计算，同时它保持均匀测度：如果 $y\\sim U_{m}$，那么 $\\neg y\\sim U_{m}$。\n\n考虑区分器 $D$ 针对 $G_{neg}$ 的区分优势：\n$$\n\\Delta \\equiv \\left|\\Pr_{x\\sim U_{n}}[D(G_{neg}(x))=1]-\\Pr_{y\\sim U_{m}}[D(y)=1]\\right|.\n$$\n根据 $G_{neg}$ 和 $D'$ 的定义，\n$$\n\\Pr_{x\\sim U_{n}}[D(G_{neg}(x))=1]=\\Pr_{x\\sim U_{n}}[D(\\neg G(x))=1]=\\Pr_{x\\sim U_{n}}[D'(G(x))=1].\n$$\n此外，由于 $y\\sim U_{m}$ 意味着 $\\neg y\\sim U_{m}$ 并且 $\\neg$ 是一个置换，\n$$\n\\Pr_{y\\sim U_{m}}[D(y)=1]=\\Pr_{y\\sim U_{m}}[D(\\neg y)=1]=\\Pr_{y\\sim U_{m}}[D'(y)=1].\n$$\n因此，\n$$\n\\Delta=\\left|\\Pr_{x\\sim U_{n}}[D'(G(x))=1]-\\Pr_{y\\sim U_{m}}[D'(y)=1]\\right|.\n$$\n由于 $G$ 是一个安全的PRG，对于任意的PPT区分器 $D'$，这个优势被一个可忽略函数 $\\epsilon(n)$ 所界定：\n$$\n\\left|\\Pr_{x\\sim U_{n}}[D'(G(x))=1]-\\Pr_{y\\sim U_{m}}[D'(y)=1]\\right|\\le \\epsilon(n).\n$$\n因此对于任意的PPT区分器 $D$ 都有 $\\Delta\\le \\epsilon(n)$，这证明了 $G_{neg}$ 是一个安全的PRG。所以，正确的陈述是 $G_{neg}$ 始终是一个安全的PRG。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}