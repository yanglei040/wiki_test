{
    "hands_on_practices": [
        {
            "introduction": "对角化论证是计算复杂性理论中构建反例的基石，尤其在预言机论证中。通过这个练习 ，你将亲身体验一个对角化步骤的核心逻辑，即如何通过精心设计一个预言机来“欺骗”一个计算能力较弱的机器，从而强制分离两个复杂性类。掌握这一技巧对于理解为什么某些证明技术，比如相对化技术，无法解决 $P$ 与 $NP$ 问题至关重要。",
            "id": "1430202",
            "problem": "在计算复杂性理论中，相对化技术通过为所有计算模型提供对预言机（一个可以在单一步骤内回答特定查询的辅助函数）的访问，来探索复杂性类之间的关系。著名的 Baker-Gill-Solovay 定理证明了存在预言机 $A$ 和 $B$，使得 $\\mathrm{P}^A = \\mathrm{NP}^A$ 且 $\\mathrm{P}^B \\neq \\mathrm{NP}^B$。这意味着相对化的证明技术（即，无论使用何种预言机都成立的技术）不足以解决 P versus NP 问题。\n\n你的任务是分析一个类似但更通用的构造中的一个关键步骤：构造一个预言机 $A$，该预言机迫使多项式时间层级（PH）是无限的。无限的 PH 意味着对于每个整数 $k \\ge 0$，复杂性类 $\\Sigma_k^{\\mathrm{P},A}$ 都严格包含在 $\\Sigma_{k+1}^{\\mathrm{P},A}$ 中。\n\n预言机 $A$ 的构造是分阶段进行的。在每个阶段，我们的目标是确保来自较高层级的语言不能被任何来自较低层级的机器所判定。让我们关注这个对角化论证中的一个通用阶段。\n\n**场景：**\n\n设 $A_{current}$ 是在先前阶段构造的预言机的有限部分。在当前阶段，我们的目标是针对一个特定的机器 $M \\in \\Sigma_k^{\\mathrm{P},A}$，对一个语言 $L_{k+1}(A) \\in \\Sigma_{k+1}^{\\mathrm{P},A}$ 进行对角化。我们选择一个特殊的输入字符串 $w$，其属性依赖于一个被选为非常大的整数 $n$。\n\n$w$ 是否属于我们的目标语言 $L_{k+1}(A)$ 被设计为依赖于单个、当前未定的“见证”字符串 $s_w$。具体来说，该构造保证：\n$$w \\in L_{k+1}(A) \\quad \\iff \\quad s_w \\in A$$\n\n为了实现对角化，我们必须确保 $L(M^A) \\neq w \\in L_{k+1}(A)$。策略如下：\n\n1.  我们在输入 $w$ 上模拟机器 $M$。由于 $M$ 是一个 $\\Sigma_k^{\\mathrm{P},A}$ 机器，其计算涉及量词和对预言机 $A$ 的访问。\n2.  在模拟期间，如果 $M$ 查询一个其在 $A$ 中的成员资格已由 $A_{current}$ 确定的字符串，我们使用该答案。对于任何关于新字符串（包括 $s_w$）的查询，我们暂时回答“否”（即，不在预言机中）。\n3.  设 $Q$ 为此次模拟中查询的所有新字符串的集合。见证字符串 $s_w$ 被精心选择，使其不在 $Q$ 中。\n4.  模拟完成后，我们决定是否将 $s_w$ 添加到预言机中，从而创建 $A_{next}$。这个决定基于模拟的结果。\n\n**问题：**\n\n以下哪个决策规则能正确确保对于输入 $w$，$L(M^A) \\neq L_{k+1}(A)$，从而成功完成对角化步骤？\n\nA. 如果 $M(w)$ 的模拟拒绝，我们承诺永不将 $s_w$ 添加到预言机中。如果模拟接受，我们将 $s_w$ 添加到预言机中。\n\nB. 如果 $M(w)$ 的模拟拒绝，我们将 $s_w$ 添加到预言机中。如果模拟接受，我们承诺永不将 $s_w$ 添加到预言机中。\n\nC. 无论模拟结果如何，我们都将 $s_w$ 添加到预言机中，因为这保证了 $w \\in L_{k+1}(A)$ 并且 $L_{k+1}(A)$ 是更强大的类。\n\nD. 仅当模拟进行了奇数次查询时，我们才将 $s_w$ 添加到预言机中。否则，我们承诺永不将 $s_w$ 添加到预言机中。\n\nE. 如果 $M(w)$ 的模拟接受，我们找到一个被查询过的不同字符串 $s'_w \\in Q$，并将其添加到预言机中以代替 $s_w$。如果模拟拒绝，我们将 $s_w$ 添加到预言机中。",
            "solution": "我们将对角化步骤形式化，针对一个固定的 $k \\ge 0$、一个有限的预言机前缀 $A_{current}$、一个目标语言 $L_{k+1}(A) \\in \\Sigma_{k+1}^{\\mathrm{P},A}$（其构造方式使得对于选定的输入 $w$ 存在一个单一的未定见证 $s_{w}$）且满足\n$$\nw \\in L_{k+1}(A) \\iff s_{w} \\in A,\n$$\n以及一个需要对其进行对角化的特定机器 $M \\in \\Sigma_{k}^{\\mathrm{P},A}$。\n\n步骤 1：使用部分预言机答案在输入 $w$ 上模拟 $M$，如下所示：\n- 如果 $M$ 查询一个字符串 $x$，其在 $A$ 中的成员资格已由 $A_{current}$ 确定，则用该确定值回答。\n- 如果 $M$ 查询一个新字符串 $x \\notin \\mathrm{dom}(A_{current})$，则暂时回答 $x \\notin A$。\n设 $Q$ 为此次模拟中查询的所有新字符串的集合。根据构造，选择 $s_{w} \\notin Q$。设模拟结果为一个比特 $b \\in \\{0,1\\}$，其中 $b=1$ 表示接受，$b=0$ 表示拒绝。\n\n步骤 2：将模拟与最终预言机更新下的真实运行联系起来。定义下一个预言机 $A_{next}$，通过可能将 $s_{w}$ 添加到 $A_{current}$ 中，并保持 $\\mathrm{dom}(A_{current})$ 之外的所有其他字符串为未定义状态，但我们不会改变对 $Q$ 中字符串的任何回答。因为 $s_{w} \\notin Q$，所以添加或不添加 $s_{w}$ 不会改变 $M$ 在模拟中发出的任何查询的答案。因此，机器在预言机 $A_{next}$ 下对 $w$ 的实际决策等于模拟结果：\n$$\nL(M^{A_{next}})(w) = b.\n$$\n\n步骤 3：计算预言机更新后的目标语言成员资格。根据 $L_{k+1}(A)$ 的设计，\n$$\nw \\in L_{k+1}(A_{next}) \\iff s_{w} \\in A_{next}.\n$$\n因此，如果我们设置 $s_{w} \\in A_{next}$，那么 $w \\in L_{k+1}(A_{next})$；如果我们设置 $s_{w} \\notin A_{next}$，那么 $w \\notin L_{k+1}(A_{next})$。\n\n步骤 4：选择更新规则以迫使不一致。为确保 $L(M^{A_{next}})(w) \\neq L_{k+1}(A_{next})(w)$，我们必须设置\n$$\ns_{w} \\in A_{next} \\iff b=0,\n$$\n也就是说，当且仅当模拟拒绝时才将 $s_{w}$ 添加到预言机中，否则不添加 $s_{w}$。\n\n针对选项进行验证：\n- 选项 A 使得 $s_{w} \\in A_{next} \\iff b=1$，这导致了一致，而不是对角化。\n- 选项 B 使得 $s_{w} \\in A_{next} \\iff b=0$，这按要求导致了不一致。\n- 选项 C 总是添加 $s_{w}$，这不能保证不一致。\n- 选项 D 将决策与查询次数的奇偶性联系起来，这与迫使不一致无关。\n- 选项 E 在 $M$ 接受时添加某个 $s'_{w} \\in Q$；这改变了 $M$ 实际发出的一个查询的答案，因此 $L(M^{A_{next}})(w)$ 可能与模拟的 $b$ 不同，破坏了对角化所需的控制。\n\n因此，正确的规则是选项 B。",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "在证明了我们可以构建预言机来分离复杂性类之后，下一个自然的问题是：我们能否构建一个预言机来使它们相等？这个问题触及了相对化限制的核心。这个练习  探讨了当预言机本身具有巨大计算能力时（例如，一个 $PSPACE$ 完全问题），它如何能够“提升”确定性图灵机的能力，使其能够模拟非确定性计算，从而导致 $P^A = NP^A$。这揭示了 $P$ 与 $NP$ 之间的关系是多么依赖于我们所处的计算世界。",
            "id": "1430179",
            "problem": "Baker-Gill-Solovay 定理是计算复杂性理论中的一个基础性成果，它展示了相对化证明技术的局限性。该定理表明，存在预言机 $A$ 和 $B$ 使得 $P^A = NP^A$ 且 $P^B \\neq NP^B$。这意味着任何对预言机存在与否不敏感的证明技术（即“相对化”技术）都无法解决 P 与 NP 问题。\n\n你的任务是探究如何构造一个预言机，该预言机能迫使多项式层级在其第一层级上坍缩。预言机图灵机是一种标准的图灵机，它配备了一条特殊的查询带和一个查询状态。当机器进入查询状态时，会检查其查询带上的字符串 $q$ 是否属于一个固定的预言机语言 $A$。这个查询被认为只占用一个计算步骤。我们将 $P^A$ 定义为可由使用预言机 $A$ 的多项式时间确定性预言机图灵机判定的语言类，将 $NP^A$ 定义为可由使用预言机 $A$ 的多项式时间非确定性预言机图灵机判定的语言类。\n\n选择所有以下语言，当用作预言机 $A$ 时，会导致相对化的复杂性类 $P^A$ 和 $NP^A$ 相等。你可以假设所列出的所有语言都在指数时间（EXPTIME）内是可判定的，并且它们各自的完全性属性在多项式时间归约下成立。\n\nA. SAT：所有可满足的布尔公式的语言。该语言是 NP-完全的。\nB. TQBF：所有为真的量化布尔公式的语言。该语言是 PSPACE-完全的。\nC. PATH：所有元组 $\\langle G, s, t \\rangle$ 的语言，其中 $G$ 是一个包含从顶点 $s$到顶点 $t$ 路径的有向图。该语言是 P-完全的。\nD. ALL_NFA：所有接受其输入字母表上所有字符串（即 $L(M) = \\Sigma^*$）的非确定性有限自动机（NFA）$\\langle M \\rangle$ 的语言。该语言是 PSPACE-完全的。\nE. 一个 EXPTIME-完全语言：任何对于复杂性类 EXPTIME 是完全的语言。",
            "solution": "我们被要求确定，对于每个提议的预言机语言，当用作预言机 $A$ 时，是否会迫使 $P^{A} = NP^{A}$，即，在第一层级上导致相对化多项式层级坍缩。我们使用标准定义：$P^{A}$ 是带预言机 $A$ 的确定性多项式时间，而 $NP^{A}$ 是带预言机 $A$ 的非确定性多项式时间。我们依赖于（如题所述的）多项式时间多一归约下的完全性，以及标准的闭包性质。\n\n使用的一般原则：\n1) 如果 $A$ 在多项式时间多一归约下对于一个类 $\\mathcal{C}$ 是完全的，那么对于每个 $L \\in \\mathcal{C}$，都存在一个多项式时间可计算的归约 $f$，使得 $x \\in L$ 当且仅当 $f(x) \\in A$。因此 $L \\in P^{A}$，所以 $\\mathcal{C} \\subseteq P^{A}$。\n2) 如果 $A \\in \\mathcal{C}$ 并且 $\\mathcal{C}$ 在多项式时间图灵归约下是封闭的，那么 $P^{A} \\subseteq \\mathcal{C}$，因为一个 $P^{A}$ 计算可以由一个 $\\mathcal{C}$-机器来模拟，该机器在 $\\mathcal{C}$ 内回答每个预言机查询，并组合多项式数量的此类调用。\n3) 对于带有 $\\mathcal{C}$-预言机的非确定性，其中 $\\mathcal{C}$ 至少是 PSPACE 或 EXPTIME，我们使用 $NPSPACE = PSPACE$ (Savitch) 以及 EXPTIME 在多项式时间图灵归约下是封闭的，并且可以通过暴力破解多项式数量的非确定性分支而不超过指数时间。因此，只要 $A \\in \\mathcal{C}$ 且具有所述的闭包性质，就有 $NP^{A} \\subseteq \\mathcal{C}$。\n\n我们逐个分析每个选项。\n\nA. $A = SAT$ (NP-完全)。\n因为 $SAT$ 是 NP-完全的，所以 $P^{SAT} = P^{NP} = \\Delta_{2}^{P}$ 并且 $NP^{SAT} = NP^{NP} = \\Sigma_{2}^{P}$。目前尚不清楚 $\\Delta_{2}^{P}$ 是否等于 $\\Sigma_{2}^{P}$。因此，使用 $SAT$ 作为预言机并不能证明会导致 $P^{A} = NP^{A}$，所以我们不能选择此选项。\n\nB. $A = TQBF$ (PSPACE-完全)。\n首先，根据完全性，对于任何 $L \\in PSPACE$，都存在一个到 $TQBF$ 的多项式时间多一归约 $f$，所以 $PSPACE \\subseteq P^{A}$。其次，因为 $A \\in PSPACE$ 并且 $PSPACE$ 在多项式时间图灵归约下是封闭的，所以任何 $P^{A}$ 计算都可以在 $PSPACE$ 中模拟，因此 $P^{A} \\subseteq PSPACE$。于是有\n$$\nP^{A} = PSPACE\n$$\n此外，$P^{A} \\subseteq NP^{A}$ 意味着 $PSPACE \\subseteq NP^{A}$。对于反向包含关系，可以通过对其多项式深度的计算树进行深度优先遍历，在多项式空间内模拟一个 $NP^{A}$ 机器，同时在多项式空间内回答对 $A \\in PSPACE$ 的每个预言机查询。因此 $NP^{A} \\subseteq PSPACE$。所以\n$$\nNP^{A} = PSPACE\n$$\n因此 $P^{A} = NP^{A}$。\n\nC. $A = PATH$ (P-完全)。\n因为 $A \\in P$，任何 $P^{A}$ 机器的预言机查询都可以在多项式时间内模拟，从而得到 $P^{A} = P$。类似地，$NP^{A} = NP$。因此，$P^{A} = NP^{A}$ 将意味着 $P = NP$，而这是未知的。因此，这个预言机并不能证明会导致 $P^{A} = NP^{A}$，所以我们不选择此选项。\n\nD. $A = ALL\\_NFA$ (PSPACE-完全)。\n这与对 $TQBF$ 的论证完全相同。根据完全性和闭包性，我们得到 $P^{A} = PSPACE$ 和 $NP^{A} = PSPACE$，因此 $P^{A} = NP^{A}$。\n\nE. $A$ 是 EXPTIME-完全的。\n根据完全性，对于任何 $L \\in EXPTIME$，都存在一个到 $A$ 的多项式时间多一归约 $f$，所以 $EXPTIME \\subseteq P^{A}$。反过来，确定性地模拟任何 $P^{A}$ 计算：其多项式数量的对 $A$ 的预言机查询中的每一个都可以在指数时间内对多项式长度的输入进行回答，总时间仍然是指数级的，所以 $P^{A} \\subseteq EXPTIME$。于是有\n$$\nP^{A} = EXPTIME\n$$\n对于 $NP^{A}$，带有 $EXPTIME$ 预言机的非确定性多项式时间可以通过枚举最多 $\\exp(p(n))$ 个分支来在确定性指数时间内模拟，每个分支由于预言机调用和多项式工作最多耗时 $\\exp(p(n))$，使总时间保持在 $\\exp(q(n))$ 之内。因此 $NP^{A} \\subseteq EXPTIME$，并且由于 $P^{A} = EXPTIME \\subseteq NP^{A}$，我们得出结论\n$$\nNP^{A} = EXPTIME\n$$\n因此 $P^{A} = NP^{A}$。\n\n结论：\n- B 和 D（均为 PSPACE-完全预言机）得出 $P^{A} = NP^{A} = PSPACE$。\n- E（EXPTIME-完全预言机）得出 $P^{A} = NP^{A} = EXPTIME$。\n- 在目前的知识下，A 和 C 并不能证明会导致 $P^{A} = NP^{A}$。\n\n因此，正确的选项是 B、D 和 E。",
            "answer": "$$\\boxed{BDE}$$"
        },
        {
            "introduction": "理解了预言机可以分离或合并复杂性类后，我们进一步探讨一个更微妙的问题：所有预言机分离都具有同等的意义吗？此练习  引入了“稀疏预言机”的概念，并挑战你思考为什么使用稀疏预言机来证明 $P^S \\neq NP^S$ 比使用标准（密集）预言机更具启发性。这迫使我们思考分离的根本原因，超越了仅仅利用预言机中存在大量“证据”的简单技巧，并指明了通往非相对化证明方法的可能路径。",
            "id": "1430234",
            "problem": "在计算复杂性理论中，预言图灵机是一种用于研究证明技术局限性的理论模型。预言机 $A$ 是一个在固定字母表（例如 $\\{0,1\\}$）上的字符串集合，一台可以访问此预言机的机器可以在单个计算步骤内确定任何给定字符串是否属于 $A$。我们将可通过带有预言机 $A$ 的确定性机器在多项式时间内解决的判定问题类表示为 $\\mathrm{P}^A$，将可通过非确定性机器解决的表示为 $\\mathrm{NP}^A$。相对化障碍（由 Baker-Gill-Solovay 定理著名地证明）表明，存在预言机 $O_1$ 和 $O_2$，使得 $\\mathrm{P}^{O_1} = \\mathrm{NP}^{O_1}$ 且 $\\mathrm{P}^{O_2} \\neq \\mathrm{NP}^{O_2}$。这意味着“相对化”的证明技术（即对任何可能的预言机都成立的技术）不足以解决基础的 $\\mathrm{P}$ 与 $\\mathrm{NP}$ 问题。\n\n因此，一个主要的研究方向是尝试寻找“非相对化”的证明技术。一种方法是研究 $\\mathrm{P}^A$ 和 $\\mathrm{NP}^A$ 之间的分离如何取决于预言机 $A$ 的性质。如果存在一个多项式 $p(n)$，使得对于任何非负整数 $n$，$S$ 中长度不超过 $n$ 的字符串数量最多为 $p(n)$，则称预言机 $S$ 是“稀疏的”。形式上，$|S \\cap \\{0,1\\}^{\\le n}| \\le p(n)$。一个不稀疏的预言机被称为“稠密的”。\n\n在该领域中，人们普遍认为，证明对于某个稀疏预言机 $S$ 有 $\\mathrm{P}^S \\neq \\mathrm{NP}^S$，将是朝着解决 $\\mathrm{P}$ 与 $\\mathrm{NP}$ 问题迈出的比 Baker-Gill-Solovay 原始的分离预言机（它是稠密的）更重要的一步。以下哪个陈述为这一信念提供了最好的理由？\n\nA. 已知稀疏预言机存在于 P 类中，因此使用稀疏预言机的任何分离都将直接意味着 P $\\neq$ NP。\nB. 用稀疏预言机证明分离需要本质上非相对化的技术，因为稀疏预言机的存在本身就使得 Baker-Gill-Solovay 定理的前提失效。\nC. 非确定性机器的计算能力被稠密预言机大大增强，因为它可以轻易地“猜测”一个在预言机中的见证字符串。这种优势在使用稀疏预言机时会显著减弱，这意味着分离必须依赖于 P 和 NP 之间更根本的区别。\nD. 所有已知的、属于 NP 但被怀疑不属于 P 的现实世界计算问题都可以用稀疏预言机建模，但不能用稠密预言机建模。\nE. 一个多项式时间的确定性机器可以生成一个稀疏预言机中直到给定长度的所有字符串的完整列表，从而有效地抵消了预言机对 NP 机器的效用。",
            "solution": "我们首先回顾相关的正式定义。对于任何预言机 $A \\subseteq \\{0,1\\}^{\\ast}$，$\\mathrm{P}^{A}$ 是指在允许对 $A$ 进行单位时间成员查询的情况下，可由确定性预言图灵机在输入长度的多项式时间内解决的判定问题集合，而 $\\mathrm{NP}^{A}$ 是具有非确定性的类似类别。Baker-Gill-Solovay 定理给出了预言机 $O_{1}$ 和 $O_{2}$，使得 $\\mathrm{P}^{O_{1}}=\\mathrm{NP}^{O_{1}}$ 且 $\\mathrm{P}^{O_{2}} \\neq \\mathrm{NP}^{O_{2}}$，这表明相对化的技术无法解决 $\\mathrm{P}$ 与 $\\mathrm{NP}$ 的问题。\n\n如果存在一个多项式 $p$，使得对于所有 $n \\in \\mathbb{N}$，\n$$|S \\cap \\{0,1\\}^{\\leq n}| \\leq p(n)$$\n都成立，则预言机 $S$ 是稀疏的。\n相比之下，一个稠密的预言机通常包含指数级数量的长度至多为 $n$ 的字符串。例如，长度至多为 $n$ 的二进制字符串总数为\n$$\\sum_{i=0}^{n} 2^{i} = 2^{n+1}-1,$$\n一个稠密的预言机可能包含其中的一个常数比例，即在长度 $n$ 时有 $\\Theta(2^n)$ 个。\n\n我们现在分析每个提出的理由：\n\nA. “稀疏预言机存在于 $\\mathrm{P}$ 类中”这一说法是正确的，但结论“因此使用稀疏预言机的任何分离都将直接意味着 $\\mathrm{P} \\neq \\mathrm{NP}$”仅在特定的分离稀疏预言机 $S$ 也满足 $S \\in \\mathrm{P}$ 时才成立。该陈述并未断言分离的稀疏预言机将在 $\\mathrm{P}$ 中；此外，问题要求的是解释为什么这样的结果将是更重要的一步，而不是它会直接意味着 $\\mathrm{P} \\neq \\mathrm{NP}$。因此 A 不是正确的理由。\n\nB. 声称使用稀疏预言机的分离“需要本质上非相对化的技术”是不正确的。对于一个特定的 $S$ 证明 $\\mathrm{P}^{S} \\neq \\mathrm{NP}^{S}$ 仍然是一个相对化的陈述（它是关于相对于该 $S$ 的计算），它本身并不能使相对化现象失效，也不能强制使用非相对化技术。因此 B 是不正确的。\n\nC. 非确定性机器可以通过存在性分支到很可能命中预言机中肯定字符串的猜测，来利用稠密预言机，因为存在指数级的机会：如果在长度 $n$ 时有 $\\Theta(2^n)$ 个预言机中的肯定字符串，非确定性分支可以利用这种丰富性来使用短的、预言机中的肯定见证来认证成员资格。相比之下，对于稀疏预言机，长度不超过 $n$ 的预言机中肯定字符串的数量受 $p(n)$ 的限制，这是 $n$ 的一个多项式，因此非确定性机器不能依赖预言机中肯定字符串的“丰富性”来获得能力；任何 $\\mathrm{P}^{S} \\neq \\mathrm{NP}^{S}$ 的分离都必须依赖于确定性计算和非确定性计算之间更内在的差异，而不是一个微不足道的密度效应。这就是为什么稀疏预言机分离被认为是解决 $\\mathrm{P}$ 与 $\\mathrm{NP}$ 问题的一个更强有力的迹象的核心启发式理由。因此 C 是最好的理由。\n\nD. 关于“所有已知的现实世界 NP 问题”都可以用稀疏预言机而不是稠密预言机来建模的断言是毫无根据且不正确的；对现实世界问题的预言机建模并没有受到这种方式的限制。因此 D 是错误的。\n\nE. “稀疏”这一性质限制了数量，但对成员资格的可判定性或有效可枚举性没有任何说明。在预言机设置中，$S$ 可以是任意的稀疏集合（甚至可以是不可判定的），并且没有通用的多项式时间确定性方法可以在没有预言机访问权限的情况下，列出 $S \\cap \\{0,1\\}^{\\leq n}$。因此 E 是错误的。\n\n从这些分析中，选项 C 提供了正确且最有说服力的理由。",
            "answer": "$$\\boxed{C}$$"
        }
    ]
}