{
    "hands_on_practices": [
        {
            "introduction": "沙米尔定理证明的核心在于，将一个关于量化布尔公式（QBF）的复杂逻辑问题，转化为一个多项式代数问题。这个被称为“算术化”的转化过程是整个交互式证明协议的基石。本练习旨在让你亲手实践这一关键步骤，学习如何将一个 QBF 公式的内部部分转化为一个单变量多项式，这正是证明者（Prover）在协议每一轮中向验证者（Verifier）提出的核心“声明”。",
            "id": "1447644",
            "problem": "在计算复杂性理论的背景下，Shamir 定理指出，复杂性类 IP（包含所有可通过交互式证明系统解决的问题）等于 PSPACE（可由确定性图灵机使用多项式大小的空间解决的问题类）。$IP = PSPACE$ 证明的一个关键部分涉及对量化布尔公式 (QBF) 的算术化。\n\n此算术化过程将布尔公式转换为多项式。设布尔变量 $x_i$ 的取值范围为 $\\{0, 1\\}$，其中 $1$ 代表“真”(TRUE)，$0$ 代表“假”(FALSE)。逻辑运算按如下方式映射到算术运算：\n-   $A \\land B$ 转换为乘积 $A \\cdot B$。\n-   $\\neg A$ 转换为 $(1-A)$。\n-   $A \\lor B$ 转换为 $1 - (1-A)(1-B) = A+B-AB$。\n\n类似地，量词被转换为对公式 $\\phi$ 的多项式表示 $\\phi'$ 的运算。如果一个关于变量 $x$ 的子公式的多项式表示为 $f(x)$，那么：\n-   $\\exists x \\phi(x)$ 转换为运算 $f(0)+f(1)-f(0)f(1)$。\n-   $\\forall x \\phi(x)$ 转换为运算 $f(0) \\cdot f(1)$。\n\n任何得到的多项式都可以使用以下性质进行简化：对于任意布尔变量 $x_i \\in \\{0,1\\}$ 和任意整数 $k \\ge 1$，均有 $x_i^k = x_i$。\n\n考虑以下量化布尔公式：\n$$ \\Phi = \\exists x_1 \\forall x_2 \\exists x_3 ((x_1 \\lor x_2) \\land (\\neg x_2 \\lor x_3)) $$\n\n在此 QBF 的交互式证明的第一轮中，证明者 (Prover) 必须构造一个多项式来表示剥离最外层量词后的公式。这个我们称之为 $P(z)$ 的多项式是单变量 $z$ 的函数，其中 $z$ 代表 $x_1$。请确定多项式 $P(z)$。请用变量 $z$ 的多项式表示您的答案。",
            "solution": "我们将 QBF 的内部公式记为 $\\psi(x_1, x_2, x_3) = ((x_1 \\lor x_2) \\land (\\neg x_2 \\lor x_3))$。我们的目标是为公式 $\\forall x_2 \\exists x_3 \\psi(z, x_2, x_3)$ 找到对应的单变量多项式 $P(z)$。\n\n第一步，我们将 $\\psi$ 算术化为多项式 $\\psi'(x_1, x_2, x_3)$。\n$x_1 \\lor x_2 \\mapsto x_1+x_2-x_1x_2$\n$\\neg x_2 \\lor x_3 \\mapsto (1-x_2)+x_3-(1-x_2)x_3 = 1-x_2+x_2x_3$\n因此，$\\psi'(x_1, x_2, x_3) = (x_1+x_2-x_1x_2)(1-x_2+x_2x_3)$。\n\n第二步，我们从内到外处理量词。首先是 $\\exists x_3$。设 $f_2(x_1, x_2)$ 是代表 $\\exists x_3 \\psi(x_1, x_2, x_3)$ 的多项式。\n$f_2(x_1, x_2) = \\psi'(x_1, x_2, 0) + \\psi'(x_1, x_2, 1) - \\psi'(x_1, x_2, 0)\\psi'(x_1, x_2, 1)$。\n令 $A = (x_1+x_2-x_1x_2)$。\n$\\psi'(x_1, x_2, 0) = A \\cdot (1-x_2+x_2 \\cdot 0) = A(1-x_2)$。\n$\\psi'(x_1, x_2, 1) = A \\cdot (1-x_2+x_2 \\cdot 1) = A \\cdot 1 = A$。\n所以，$f_2(x_1, x_2) = A(1-x_2) + A - A(1-x_2)A = A(2-x_2) - A^2(1-x_2)$。\n\n第三步，我们处理量词 $\\forall x_2$。$P(z)$ 是代表 $\\forall x_2 f_2(z, x_2)$ 的多项式。\n$P(z) = f_2(z, 0) \\cdot f_2(z, 1)$。\n我们需要分别计算 $f_2$ 在 $x_2=0$ 和 $x_2=1$ 时的值（此时 $x_1$ 被看作 $z$）。\n-   当 $x_2=0$ 时，$A = z+0-z\\cdot0 = z$。\n    $f_2(z, 0) = z(2-0) - z^2(1-0) = 2z-z^2$。\n    因为变量 $x_1$（现在是 $z$）最终是布尔值，在量化前可以应用 $z^2=z$ 简化，所以 $f_2(z,0) = 2z-z = z$。\n-   当 $x_2=1$ 时，$A = z+1-z\\cdot1 = 1$。\n    $f_2(z, 1) = 1(2-1) - 1^2(1-1) = 1 \\cdot 1 - 1 \\cdot 0 = 1$。\n\n最后，我们将这两个结果相乘：\n$P(z) = f_2(z, 0) \\cdot f_2(z, 1) = z \\cdot 1 = z$。\n\n因此，代表剥离最外层量词后公式的多项式是 $z$。",
            "answer": "$$\\boxed{z}$$"
        },
        {
            "introduction": "在掌握了如何为协议的单步生成多项式声明后，我们自然会好奇：这些步骤是如何串联起来，最终让验证者确信最初论断的真实性的？本练习将带领你完整地追踪整个协议的执行流程。你将看到，在每一轮中，验证者如何利用一个随机选择的值 $r_i$ 来递归地降低问题的复杂度，并最终导出一个可直接检验的简单代数等式。",
            "id": "1447617",
            "problem": "考虑给定的量化布尔公式 (QBF) $\\Phi = \\exists x_1 \\forall x_2 \\exists x_3 ((x_1 \\lor \\neg x_2) \\land (\\neg x_1 \\lor x_3))$。我们希望使用基于算术化的交互式证明协议来验证该公式是否为真，该协议是 Shamir 定理证明的核心，该定理指出交互式证明系统 (IP) 等价于多项式空间 (PSPACE)。\n\n协议按以下步骤进行：\n1.  **公式体的算术化：**布尔变量 $x_i \\in \\{0, 1\\}$ 被视为整数。公式体 $\\phi(x_1, x_2, x_3) = (x_1 \\lor \\neg x_2) \\land (\\neg x_1 \\lor x_3)$ 中的逻辑运算被转换为在足够大的域上的多项式运算：\n    -   $\\neg z$ 变为 $1-z$。\n    -   $z_1 \\land z_2$ 变为 $z_1 z_2$。\n    -   $z_1 \\lor z_2$ 变为 $z_1 + z_2 - z_1 z_2$。\n    这产生一个我们记为 $P(x_1, x_2, x_3)$ 的多项式。由于变量是布尔值，您可以使用恒等式 $x_i^2 = x_i$ 来简化多项式。\n\n2.  **量词的算术化：**量词 $Q_i$ 被视作算子。设 $f$ 是一个关于变量 $z_i, z_{i+1}, \\dots$ 的多项式。\n    -   $\\exists z_i f(z_i, \\dots)$ 对应于运算 $\\mathcal{O}_{\\exists z_i} f = f(0, \\dots) + f(1, \\dots) - f(0, \\dots)f(1, \\dots)$。\n    -   $\\forall z_i f(z_i, \\dots)$ 对应于运算 $\\mathcal{O}_{\\forall z_i} f = f(0, \\dots) \\cdot f(1, \\dots)$。\n    整个公式 $\\Phi$ 求值得到一个最终的代数值，我们称之为 $V$。公式 $\\Phi$ 为真当且仅当 $V=1$。\n\n3.  **交互式协议：**协议每次消除一个量词，从最外层到最内层 ($x_1, x_2, x_3$)。\n    -   设第 $i-1$ 步的断言为 $C_{i-1}$，它陈述了 $(\\mathcal{O}_{Q_i x_i} \\dots \\mathcal{O}_{Q_n x_n} P)(r_1, \\dots, r_{i-1}) = k_{i-1}$ (对于 $i=1$，这是关于值 $V=k_0$ 的初始断言)。\n    -   在第 $i$ 步，证明者 (Prover) 发送一个单变量多项式 $S_i(z_i)$，并声称它等于 $(\\mathcal{O}_{Q_{i+1} x_{i+1}} \\dots \\mathcal{O}_{Q_n x_n} P)(r_1, \\dots, r_{i-1}, z_i)$。\n    -   验证者 (Verifier) 通过将算子 $\\mathcal{O}_{Q_i}$ 应用于 $S_i(z_i)$ 并与 $k_{i-1}$ 比较，来检查 $S_i(z_i)$ 是否与前一个断言 $C_{i-1}$ 一致。\n    -   如果一致，验证者从域中选择一个随机值 $r_i$ 并形成新的断言 $C_i$: $(\\mathcal{O}_{Q_{i+1} x_{i+1}} \\dots \\mathcal{O}_{Q_n x_n} P)(r_1, \\dots, r_i) = S_i(r_i)$。值 $S_i(r_i)$ 成为新的目标值 $k_i$。\n\n在协议通过分别选择随机值 $r_1, r_2,$ 和 $r_3$ 消除所有三个量词 $x_1, x_2,$ 和 $x_3$ 之后，验证者需要检查一个最终的断言。这个最终断言陈述了 $P(r_1, r_2, r_3)$ 等于一个由协议期间交换的多项式决定的特定值。\n\n您的任务是确定这个值的表达式，即 $P(r_1, r_2, r_3)$ 被声称等于的值。请将您的答案表示为关于符号随机值 $r_1, r_2,$ 和 $r_3$ 的多项式。",
            "solution": "我们首先使用 $\\neg z\\mapsto 1-z$，$z_{1}\\land z_{2}\\mapsto z_{1}z_{2}$，$z_{1}\\lor z_{2}\\mapsto z_{1}+z_{2}-z_{1}z_{2}$ 来算术化公式体 $\\phi(x_{1},x_{2},x_{3})=(x_{1}\\lor \\neg x_{2})\\land(\\neg x_{1}\\lor x_{3})$。这得到\n$$\nP(x_{1},x_{2},x_{3})=\\bigl(x_{1}+(1-x_{2})-x_{1}(1-x_{2})\\bigr)\\cdot\\bigl((1-x_{1})+x_{3}-(1-x_{1})x_{3}\\bigr).\n$$\n简化每个因子：\n$$\nx_{1}+(1-x_{2})-x_{1}(1-x_{2})=1-x_{2}+x_{1}x_{2},\n$$\n$$\n(1-x_{1})+x_{3}-(1-x_{1})x_{3}=1-x_{1}+x_{1}x_{3}.\n$$\n因此\n$$\nP(x_{1},x_{2},x_{3})=(1-x_{2}+x_{1}x_{2})(1-x_{1}+x_{1}x_{3}).\n$$\n展开并对布尔变量使用 $x_{i}^{2}=x_{i}$：\n$$\n\\begin{aligned}\nP  = (1)(1-x_{1}+x_{1}x_{3}) - x_{2}(1-x_{1}+x_{1}x_{3}) + x_{1}x_{2}(1-x_{1}+x_{1}x_{3})\\\\\n = (1-x_{1}+x_{1}x_{3}) - (x_{2}-x_{1}x_{2}+x_{1}x_{2}x_{3}) + (x_{1}x_{2}-x_{1}^{2}x_{2}+x_{1}^{2}x_{2}x_{3})\\\\\n = 1-x_{1}+x_{1}x_{3}-x_{2}+x_{1}x_{2}-x_{1}x_{2}x_{3}+x_{1}x_{2}-x_{1}x_{2}+x_{1}x_{2}x_{3} \\\\\n = 1-x_1-x_2+x_1x_2+x_1x_3.\n\\end{aligned}\n$$\n\n在交互式协议中，分别为 $x_{1}$、$x_{2}$、$x_{3}$ 选择随机域元素 $r_{1}$、$r_{2}$、$r_{3}$ 后，需要检查的最终断言是\n$$\nP(r_{1},r_{2},r_{3})=S_{3}(r_{3}),\n$$\n其中 $S_{3}(z_{3})=P(r_{1},r_{2},z_{3})$ 是诚实证明者最后的单变量多项式。代入 $P$ 得到\n$$\nP(r_{1},r_{2},r_{3})=1-r_{1}-r_{2}+r_{1}r_{2}+r_{1}r_{3}.\n$$\n因此，$P(r_{1},r_{2},r_{3})$ 被声称等于的特定值是关于随机值 $r_{1},r_{2},r_{3}$ 的多项式 $1-r_{1}-r_{2}+r_{1}r_{2}+r_{1}r_{3}$。",
            "answer": "$$\\boxed{1-r_{1}-r_{2}+r_{1}r_{2}+r_{1}r_{3}}$$"
        },
        {
            "introduction": "一个协议的强大不仅在于其功能，更在于其抵御欺骗的能力。沙米尔协议的安全性高度依赖于验证者选择的随机性，这使得不诚实的证明者几乎无法作弊。本练习通过一个假设性场景，揭示了当验证者的随机性存在缺陷时（例如，总是选择一个固定的值）会带来怎样的安全漏洞。通过解决这个问题，你将深刻理解为什么随机性是交互式证明协议中不可或缺的关键设计。",
            "id": "1447618",
            "problem": "在计算复杂性理论的研究中，Shamir定理指出，拥有交互式证明系统（IP）的问题类别等同于可在多项式空间（PSPACE）内解决的问题类别。该定理证明的一个关键部分是针对真量化布尔公式（TQBF）问题的交互式协议，该问题是PSPACE完备的。\n\n该协议涉及一个称为“算术化”的过程。一个量化布尔公式（QBF）被转换为有限域 $\\mathbb{F}_p$ 上的一个多项式表达式。布尔变量 $x_i \\in \\{0, 1\\}$ 被视为域元素。逻辑运算转换如下：$\\neg x$ 变为 $1-x$，$a \\land b$ 变为 $ab$，以及 $a \\lor b$ 变为 $a+b-ab$。量词也被算术化：如果一个关于变量 $x_i$ 的子公式的多项式表示为 $f(x_i)$，那么 $\\exists x_i$ 被替换为运算 $f(0)+f(1)-f(0)f(1)$，而 $\\forall x_i$ 被替换为运算 $f(0) \\cdot f(1)$。一个QBF为真，当且仅当其算术化形式在 $\\mathbb{F}_p$ 中计算出的值为1。\n\n考虑以下已知为假的QBF：\n$$ \\phi = \\exists x_1 \\forall x_2 (x_1 \\leftrightarrow x_2) $$\n内部子句 $(x_1 \\leftrightarrow x_2)$ 的算术化是多项式 $P(x_1, x_2) = 2x_1x_2 - x_1 - x_2 + 1$。整个公式 $\\phi$ 正确地计算出值为0。\n\n一个全能但不诚实的证明者 Merlin，想让验证者 Arthur 相信 $\\phi$ 的值为1。该协议在有限域 $\\mathbb{F}_{101}$ 上运行。\n\n协议分轮进行，每个变量一轮，从最外层的变量到最内层的变量。\n1.  **第一轮 ($\\exists x_1$):**\n    子公式 $\\forall x_2 (x_1 \\leftrightarrow x_2)$ 的算术化结果是一个关于 $x_1$ 的多项式，我们称之为 $P_1(x_1)$。Merlin 本应将此多项式发送给 Arthur。由于量词是 $\\exists x_1$，Arthur 会检查 $P_1(0) + P_1(1) - P_1(0)P_1(1)$ 是否等于 $\\phi$ 的声称值。然而，Merlin 发送了一个（可能具有欺骗性的）多项式 $P'_1(z)$。Arthur 检查 $P'_1(0) + P'_1(1) - P'_1(0)P'_1(1) = 1$ 是否成立。如果此检查失败，Arthur 将拒绝。\n2.  如果检查通过，Arthur 从 $\\mathbb{F}_{101}$ 中选择一个值 $c_1$ 并发送给 Merlin。协议接下来继续解决验证 $P_1(c_1)$ 是否等于 Arthur 计算出的值 $P'_1(c_1)$ 的子问题。\n\nArthur 的一个特定实现存在缺陷：它不是随机选择 $c_1$，而是总是选择预定值 $c_1 = 5$。Merlin 知道这个缺陷。为了构造一个成功的欺骗，Merlin 精心设计了一个欺骗性多项式 $P'_1(z)$，它必须满足两个条件：\n(i) 它必须通过 Arthur 基于量词的初始检查。\n(ii) 它必须在 Arthur 将要检查的特定点上与真实多项式 $P_1(z)$ 的值一致，即 $P'_1(5) = P_1(5)$。这确保了 Merlin 的谎言不会被立即揭穿。\n\nMerlin 将他的欺骗性多项式构造成 $P'_1(z) = az^2 + bz$ 的形式。确定 Merlin 必须使用的唯一整数系数 $a$ 和 $b$（其中 $0 \\le a, b \\le 100$）。",
            "solution": "我们将子句 $x_{1} \\leftrightarrow x_{2}$ 算术化为 $P(x_{1},x_{2})=2x_{1}x_{2}-x_{1}-x_{2}+1$，在 $\\mathbb{F}_{101}$ 上，该多项式满足当且仅当 $x_{1}=x_{2}$ 时 $P(x_{1},x_{2})=1$，否则 $P(x_{1},x_{2})=0$。对于全称量词，子公式 $\\forall x_{2}(x_{1} \\leftrightarrow x_{2})$ 算术化为对 $x_{2} \\in \\{0,1\\}$ 的乘积：\n$$\nP_{1}(x_{1})=\\prod_{x_{2} \\in \\{0,1\\}}P(x_{1},x_{2})=P(x_{1},0)\\cdot P(x_{1},1).\n$$\n计算每个因子：\n$$\nP(x_{1},0)=2x_{1}\\cdot 0 - x_{1} - 0 + 1 = 1 - x_{1}, \\quad P(x_{1},1)=2x_{1}\\cdot 1 - x_{1} - 1 + 1 = x_{1}.\n$$\n因此\n$$\nP_{1}(x_{1})=(1-x_{1})x_{1}=x_{1}-x_{1}^{2}.\n$$\n外层的 $\\exists x_{1}$ 量词对应于将 $P_{1}(x_{1})$ 对 $x_{1} \\in \\{0,1\\}$ 应用“或”规则，得到 $P_{1}(0)+P_{1}(1)-P_1(0)P_1(1)=0+0-0\\cdot0=0$，这与一个假公式的预期结果相符。\n\nMerlin 发送 $P'_{1}(z)=az^{2}+bz$ 且必须满足：\n(i) Arthur 的存在性检查：$P'_{1}(0)+P'_{1}(1)-P'_{1}(0)P'_{1}(1)=1$。\n由于 $P'_{1}(0)=0$ 且 $P'_{1}(1)=a+b$，该检查变为 $0+(a+b)-0\\cdot(a+b)=1$，这给出\n$$\na+b \\equiv 1 \\pmod{101}.\n$$\n(ii) 在 Arthur 的固定选择 $c_{1}=5$ 处一致：$P'_{1}(5)=P_{1}(5)$。计算\n$$\nP_{1}(5)=5-5^{2}=5-25=-20 \\equiv 81 \\pmod{101},\n$$\n以及\n$$\nP'_{1}(5)=25a+5b \\equiv 81 \\pmod{101}.\n$$\n因此，我们在 $\\mathbb{F}_{101}$ 上解以下线性方程组：\n$$\n\\begin{cases}\na+b \\equiv 1,\\\\\n25a+5b \\equiv 81.\n\\end{cases}\n$$\n从 $b \\equiv 1-a$ 代入得：\n$$\n25a+5(1-a)=81 \\;\\Rightarrow\\; 20a+5=81 \\;\\Rightarrow\\; 20a=76.\n$$\n由于 $101=5\\cdot 20+1$，我们有 $20^{-1}\\equiv -5 \\equiv 96 \\pmod{101}$。因此\n$$\na \\equiv 76 \\cdot 96 \\equiv 7296 \\equiv 24 \\pmod{101}, \\quad b \\equiv 1-a \\equiv 1-24 \\equiv -23 \\equiv 78 \\pmod{101}.\n$$\n验证：$a+b=24+78=102 \\equiv 1$ 且 $25a+5b=25\\cdot 24+5\\cdot 78=600+390=990 \\equiv 81 \\pmod{101}$。系数是唯一的，因为行列式 $5-25=-20 \\not\\equiv 0 \\pmod{101}$。",
            "answer": "$$\\boxed{\\begin{pmatrix}24  78\\end{pmatrix}}$$"
        }
    ]
}