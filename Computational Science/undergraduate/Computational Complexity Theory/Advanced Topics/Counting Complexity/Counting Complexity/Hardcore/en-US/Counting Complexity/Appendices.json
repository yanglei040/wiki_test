{
    "hands_on_practices": [
        {
            "introduction": "We begin our exploration of counting complexity by examining a problem that is surprisingly tractable. This exercise  demonstrates how fundamental concepts from linear algebra, specifically the rank-nullity theorem, can provide a powerful and efficient way to count the number of solutions to a system of equations over a finite field like $GF(2)$. Understanding this connection is key to recognizing when a counting problem possesses an underlying structure that places it in the class `FP`, meaning it is computationally easy.",
            "id": "1419328",
            "problem": "In computational complexity theory, the class `FP` (Function-P) is the set of function problems that can be computed by a deterministic Turing machine in polynomial time. A function problem takes an input string and produces an output string, in contrast to a decision problem which outputs a simple 'yes' or 'no'.\n\nConsider the following function problem, which we'll call `CountGF2Solutions`. The input to this problem is a system of $m$ linear equations in $n$ variables, where all coefficients and constants belong to the finite field of two elements, $GF(2) = \\{0, 1\\}$. This system can be compactly represented by an $m \\times n$ matrix $A$ and an $m \\times 1$ vector $b$, both with entries from $\\{0, 1\\}$, representing the equation $Ax = b$. The function `CountGF2Solutions` must output the number of distinct solution vectors $x \\in \\{0, 1\\}^n$ for the given system.\n\nIt is a known result that `CountGF2Solutions` belongs to the class `FP`, meaning its output can be calculated in polynomial time with respect to the input size (proportional to $m \\times n$). A crucial step in proving this involves establishing a formula for the number of solutions, assuming the system is consistent (i.e., at least one solution exists).\n\nLet $r$ be the rank of the coefficient matrix $A$. Assuming the system $Ax=b$ is known to be consistent, what is the total number of distinct solutions? Express your answer as an analytical expression in terms of $n$ and $r$.",
            "solution": "We work over the vector space $(\\mathrm{GF}(2))^{n}$. Let $A$ be an $m \\times n$ matrix over $\\mathrm{GF}(2)$ with rank $r$, and suppose the system $Ax=b$ is consistent. Then there exists a particular solution $x_{0}$ such that $Ax_{0}=b$.\n\nThe set of all solutions is\n$$\nS=\\{x \\in (\\mathrm{GF}(2))^{n} : Ax=b\\}=\\{x_{0}+y : y \\in \\ker(A)\\}=x_{0}+\\ker(A).\n$$\nThe map $\\phi:\\ker(A)\\to S$ defined by $\\phi(y)=x_{0}+y$ is a bijection because addition by a fixed vector is invertible in an abelian group. Therefore,\n$$\n|S|=|\\ker(A)|.\n$$\nConsider the linear transformation $T:(\\mathrm{GF}(2))^{n}\\to(\\mathrm{GF}(2))^{m}$ given by $T(x)=Ax$. By the rank-nullity theorem,\n$$\n\\dim(\\ker(A))+\\operatorname{rank}(A)=n,\n$$\nso\n$$\n\\dim(\\ker(A))=n-r.\n$$\nOver $\\mathrm{GF}(2)$, any vector space of dimension $d$ has exactly $2^{d}$ elements, since each vector is a linear combination of a basis with coefficients in $\\{0,1\\}$. Hence,\n$$\n|\\ker(A)|=2^{\\dim(\\ker(A))}=2^{n-r}.\n$$\nCombining these, the total number of solutions is\n$$\n|S|=2^{n-r}.\n$$",
            "answer": "$$\\boxed{2^{n-r}}$$"
        },
        {
            "introduction": "Building on our first example of tractable counting, we now turn to a problem with a combinatorial flavor that can be solved using a different but equally powerful technique. This practice  involves finding the number of valid colorings for a cycle graph, a classic problem in graph theory. You will see how to develop a recurrence relation to model the problem, illustrating a common and elegant method for solving counting problems that have a sequential or inductive structure.",
            "id": "1419344",
            "problem": "A designer is creating a decorative circular chain composed of $n$ beads, where $n \\ge 3$. The beads are arranged in a circle such that each bead is considered adjacent to exactly two other beads. The designer has a palette of three distinct colors. According to the design specification, any two adjacent beads in the chain must have different colors. This is known as a valid coloring. The problem is to determine the total number of distinct valid colorings possible for a chain of $n$ beads.\n\nFind a closed-form analytic expression for the total number of valid 3-colorings for a circular chain of $n$ beads. Express your answer in terms of $n$.",
            "solution": "Model the circular chain as the cycle graph with $n$ vertices. Let $k$ denote the number of available colors; ultimately we will set $k=3$. We count proper colorings where adjacent vertices have different colors.\n\nFix the color of the first bead. For $i \\geq 1$, define:\n- $a_{i}$ as the number of valid color sequences of length $i$ whose $i$-th bead has the same color as the first bead.\n- $b_{i}$ as the number of valid color sequences of length $i$ whose $i$-th bead has a different color from the first bead.\n\nWith the first bead fixed, the initial conditions are $a_{1}=1$ and $b_{1}=0$.\n\nTransition relations follow from the adjacency constraint:\n- To have the $(i+1)$-th bead equal to the first, the $i$-th bead must be different, and there is exactly $1$ choice (the first color), so\n$$\na_{i+1} = b_{i}.\n$$\n- To have the $(i+1)$-th bead different from the first:\n  • If the $i$-th bead equals the first (state $a_{i}$), the next bead must be any of the $k-1$ colors different from the first, contributing $(k-1)a_{i}$.\n  • If the $i$-th bead is different from the first (state $b_{i}$), the next bead must be different from the current bead. Among the $k-1$ choices, exactly $1$ equals the first, so $k-2$ choices keep it different from the first, contributing $(k-2)b_{i}$. Hence\n$$\nb_{i+1} = (k-1)a_{i} + (k-2)b_{i}.\n$$\n\nEliminating $a_{i}$ via $a_{i}=b_{i-1}$ yields the second-order recurrence\n$$\nb_{i+1} = (k-2)b_{i} + (k-1)b_{i-1},\n$$\nwith $b_{1}=0$ and $b_{2}=(k-1)a_{1} + (k-2)b_{1} = k-1$.\n\nThe characteristic equation is\n$$\nx^{2} - (k-2)x - (k-1) = 0,\n$$\nwhose roots are $x = k-1$ and $x = -1$. Therefore,\n$$\nb_{i} = \\alpha (k-1)^{i-1} + \\beta (-1)^{i-1}.\n$$\nUsing $b_{1}=0$ gives $\\alpha + \\beta = 0$, so $\\beta = -\\alpha$. Using $b_{2}=k-1$ gives\n$$\nk-1 = \\alpha (k-1) - \\beta = \\alpha (k-1 + 1) = \\alpha k,\n$$\nhence $\\alpha = \\frac{k-1}{k}$ and $\\beta = -\\frac{k-1}{k}$. Thus\n$$\nb_{n} = \\frac{k-1}{k} \\left( (k-1)^{n-1} - (-1)^{n-1} \\right).\n$$\n\nFor a cycle, the last bead must be different from the first, so with the first color fixed the number of valid sequences is $b_{n}$. Allowing the first bead to be any of $k$ colors multiplies by $k$, giving the total number of valid colorings:\n$$\nN_{k}(n) = k \\, b_{n} = (k-1)^{n} + (k-1)(-1)^{n}.\n$$\n\nSetting $k=3$ yields\n$$\nN_{3}(n) = 2^{n} + 2(-1)^{n}.\n$$\nThis is the required closed-form expression for the number of valid 3-colorings of a circular chain of $n$ beads with $n \\geq 3$.",
            "answer": "$$\\boxed{2^{n} + 2(-1)^{n}}$$"
        },
        {
            "introduction": "Having seen examples of efficiently solvable counting problems, we now confront the other side of the coin: the vast class of intractable counting problems within `#P`. To prove a problem is likely 'hard,' we often show it is at least as hard as a known hard problem through a reduction. This exercise  provides a hands-on guide to constructing a parsimonious reduction, a special type of mapping that precisely preserves the number of solutions between problems, which is a cornerstone technique for proving `#P`-completeness.",
            "id": "1419342",
            "problem": "A computer scientist is investigating the relationship between different counting problems within computational complexity theory. They are focused on a problem they call #PAIRED-NOT-EQUAL (#PNE), which is known to be a #P-complete problem. An instance of #PNE is defined by a set of $n$ Boolean variables and a list of $m$ specific pairs of these variables. A valid solution to a #PNE instance is a truth assignment to the $n$ variables such that for every specified pair $(x_i, x_j)$, the variables are assigned different truth values (i.e., $x_i \\ne x_j$). The problem #PNE is to count the total number of such valid solutions.\n\nTo leverage a powerful hardware accelerator designed for Not-All-Equal 3-Satisfiability (NAE-3-SAT) problems, the scientist devises a transformation. For each of the $m$ pairs $(x_i, x_j)$ in the #PNE instance, a \"gadget\" is created. This gadget consists of two NAE-3-SAT clauses involving a new, unique auxiliary variable $a_k$ (where $k$ is the index of the pair, from $1$ to $m$). Specifically, the two clauses generated for the pair $(x_i, x_j)$ are: $(x_i, x_j, a_k)$ and $(x_i, x_j, \\neg a_k)$.\n\nThe new NAE-3-SAT formula, denoted $\\phi'$, is formed by the collection of all $2m$ clauses generated from the $m$ pairs. Suppose a given instance of #PNE has $m$ pairs and is known to have $N_{PNE}$ satisfying assignments. Determine the total number of NAE-satisfying assignments for the corresponding transformed formula $\\phi'$. Express your answer as an analytical expression in terms of $N_{PNE}$ and $m$.",
            "solution": "Let the original #PNE instance be over variables $x_{1},\\dots,x_{n}$ with $m$ specified pairs. A truth assignment to the $x$-variables is valid for #PNE if and only if for every specified pair $(x_{i},x_{j})$ we have $x_{i} \\neq x_{j}$. Let the number of such assignments be $N_{PNE}$.\n\nFor each pair indexed by $k \\in \\{1,\\dots,m\\}$, the transformation introduces an auxiliary variable $a_{k}$ and two NAE-3-SAT clauses:\n$$\nC_{k}^{+}:(x_{i},x_{j},a_{k}), \\quad C_{k}^{-}:(x_{i},x_{j},\\neg a_{k}).\n$$\nRecall that a NAE clause on three literals is satisfied if and only if not all three literals have the same truth value, equivalently if and only if there is at least one true and at least one false among them.\n\nFix any assignment $\\mathbf{x}$ to the $x$-variables and analyze the number of extensions to $(a_{1},\\dots,a_{m})$ that satisfy all clauses.\n\n1) If for a given pair $k$ we have $x_{i} \\neq x_{j}$ under $\\mathbf{x}$, then among the literals $(x_{i},x_{j},a_{k})$ there is already one true and one false coming from $x_{i}$ and $x_{j}$. Hence $C_{k}^{+}$ is satisfied for both $a_{k}=0$ and $a_{k}=1$. The same reasoning applies to $C_{k}^{-}$, because replacing $a_{k}$ by $\\neg a_{k}$ does not change the fact that $x_{i}$ and $x_{j}$ already witness both truth values. Therefore, when $x_{i} \\neq x_{j}$, both clauses $C_{k}^{+}$ and $C_{k}^{-}$ are satisfied for each of the two values of $a_{k}$, yielding exactly $2$ valid choices for $a_{k}$.\n\n2) If for a given pair $k$ we have $x_{i}=x_{j}=v \\in \\{0,1\\}$ under $\\mathbf{x}$, then $C_{k}^{+}$ is NAE-satisfied if and only if $a_{k} \\neq v$, while $C_{k}^{-}$ is NAE-satisfied if and only if $\\neg a_{k} \\neq v$, i.e., $a_{k}=v$. These two conditions are contradictory, so there is no value of $a_{k}$ that simultaneously satisfies both $C_{k}^{+}$ and $C_{k}^{-}$. Thus, when $x_{i}=x_{j}$, there are $0$ valid choices for $a_{k}$.\n\nBecause each gadget uses a distinct auxiliary variable, the choices of $a_{k}$ across different pairs are independent. Therefore, for a fixed $\\mathbf{x}$:\n- If $\\mathbf{x}$ satisfies all $m$ inequalities (i.e., $\\mathbf{x}$ is a #PNE solution), then there are $2$ valid choices for each $a_{k}$, giving $2^{m}$ extensions to $(a_{1},\\dots,a_{m})$ that NAE-satisfy all clauses in $\\phi'$.\n- If $\\mathbf{x}$ violates at least one inequality, then for that violated pair there are $0$ valid choices for the corresponding $a_{k}$, yielding $0$ extensions overall.\n\nSumming over all assignments $\\mathbf{x} \\in \\{0,1\\}^{n}$, the total number of NAE-satisfying assignments of $\\phi'$ is\n$$\n\\sum_{\\mathbf{x}} \\left|\\left\\{\\mathbf{a} \\in \\{0,1\\}^{m} : (\\mathbf{x},\\mathbf{a}) \\text{ NAE-satisfies } \\phi' \\right\\}\\right| \\;=\\; N_{PNE} \\cdot 2^{m}.\n$$\nThus, the transformed formula $\\phi'$ has exactly $N_{PNE} 2^{m}$ NAE-satisfying assignments.",
            "answer": "$$\\boxed{N_{PNE}\\,2^{m}}$$"
        }
    ]
}