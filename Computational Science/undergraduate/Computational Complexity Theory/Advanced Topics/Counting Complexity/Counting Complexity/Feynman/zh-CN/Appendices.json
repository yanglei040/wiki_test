{
    "hands_on_practices": [
        {
            "introduction": "并非所有的计数问题都是计算上困难的。有些问题，比如计算特定域上线性方程组的解的数量，实际上可以被高效解决，属于函数类 $FP$。这个练习将通过一个源自线性代数的经典结果——秩-零度定理，来展示如何精确计算解的数量，从而为你提供一个具体的多项式时间计数算法的实例。",
            "id": "1419328",
            "problem": "在计算复杂性理论中，类 `FP` (Function-P) 是指可以由确定性图灵机在多项式时间内计算的函数问题的集合。与输出简单“是”或“否”的判定问题不同，函数问题接受一个输入字符串并产生一个输出字符串。\n\n考虑以下我们称之为 `CountGF2Solutions` 的函数问题。该问题的输入是一个包含 $n$ 个变量的 $m$ 个线性方程组，其中所有系数和常数都属于二元有限域 $GF(2) = \\{0, 1\\}$。该方程组可以由一个 $m \\times n$ 的矩阵 $A$ 和一个 $m \\times 1$ 的向量 $b$ 紧凑地表示，两者的元素均来自 $\\{0, 1\\}$，代表方程 $Ax = b$。函数 `CountGF2Solutions` 必须为给定的方程组输出不同解向量 $x \\in \\{0, 1\\}^n$ 的数量。\n\n`CountGF2Solutions` 属于类 `FP` 是一个已知结果，这意味着它的输出可以在相对于输入大小（与 $m \\times n$ 成比例）的多项式时间内计算出来。证明此结论的一个关键步骤是，在假设方程组是相容的（即，至少存在一个解）前提下，建立一个计算解数量的公式。\n\n设 $r$ 为系数矩阵 $A$ 的秩。假设方程组 $Ax=b$ 已知是相容的，那么不同解的总数是多少？用一个包含 $n$ 和 $r$ 的解析表达式来表示你的答案。",
            "solution": "我们在向量空间 $(\\mathrm{GF}(2))^{n}$ 上进行运算。设 $A$ 是一个在 $\\mathrm{GF}(2)$ 上秩为 $r$ 的 $m \\times n$ 矩阵，并假设方程组 $Ax=b$ 是相容的。那么存在一个特解 $x_{0}$ 使得 $Ax_{0}=b$。\n\n所有解的集合是\n$$\nS=\\{x \\in (\\mathrm{GF}(2))^{n} : Ax=b\\}=\\{x_{0}+y : y \\in \\ker(A)\\}=x_{0}+\\ker(A).\n$$\n由 $\\phi(y)=x_{0}+y$ 定义的映射 $\\phi:\\ker(A)\\to S$ 是一个双射，因为在一个阿贝尔群中，加上一个固定向量的运算是可逆的。因此，\n$$\n|S|=|\\ker(A)|.\n$$\n考虑由 $T(x)=Ax$ 给出的线性变换 $T:(\\mathrm{GF}(2))^{n}\\to(\\mathrm{GF}(2))^{m}$。根据秩-零度定理，\n$$\n\\dim(\\ker(A))+\\operatorname{rank}(A)=n,\n$$\n所以\n$$\n\\dim(\\ker(A))=n-r.\n$$\n在 $\\mathrm{GF}(2)$ 上，任何维度为 $d$ 的向量空间都恰好有 $2^{d}$ 个元素，因为每个向量都是一组基的线性组合，其系数取自 $\\{0,1\\}$。因此，\n$$\n|\\ker(A)|=2^{\\dim(\\ker(A))}=2^{n-r}.\n$$\n综合以上，解的总数是\n$$\n|S|=2^{n-r}.\n$$",
            "answer": "$$\\boxed{2^{n-r}}$$"
        },
        {
            "introduction": "让我们更深入地探讨规约，特别是“保持数量的规约”（parsimonious reduction），这对于证明 $\\#P$-完备性至关重要。这个练习将指导你构造一个“小工具”(gadget)，将一个问题（$\\#PNE$）的实例转化为另一个问题（$\\#NAE-3-SAT$）的实例，同时在它们的解计数之间保持精确的乘法关系。掌握这种技术是理解计数问题相对难度的关键。",
            "id": "1419342",
            "problem": "一位计算机科学家正在研究计算复杂性理论中不同计数问题之间的关系。他们专注于一个他们称之为#PAIRED-NOT-EQUAL (#PNE) 的问题，该问题已知是一个#P完全问题。#PNE问题的一个实例由一组 $n$ 个布尔变量和包含这些变量的 $m$ 个特定变量对的列表定义。#PNE实例的一个有效解是对这 $n$ 个变量的一个真值指派，使得对于每个指定的变量对 $(x_i, x_j)$，这两个变量被赋予不同的真值（即 $x_i \\ne x_j$）。#PNE问题就是计算这类有效解的总数。\n\n为了利用一个为非全等三元可满足性 (Not-All-Equal 3-Satisfiability, NAE-3-SAT) 问题设计的强大硬件加速器，这位科学家设计了一种转换。对于#PNE实例中的 $m$ 个变量对 $(x_i, x_j)$ 中的每一个，都会创建一个“小工具”(gadget)。这个小工具由两个NAE-3-SAT子句组成，其中涉及一个新的、唯一的辅助变量 $a_k$ （其中 $k$ 是变量对的索引，从 $1$ 到 $m$）。具体来说，为变量对 $(x_i, x_j)$ 生成的两个子句是：$(x_i, x_j, a_k)$ 和 $(x_i, x_j, \\neg a_k)$。\n\n新的NAE-3-SAT公式，记为 $\\phi'$，由从 $m$ 个变量对生成的所有 $2m$ 个子句集合而成。假设一个给定的#PNE实例有 $m$ 个变量对，并且已知有 $N_{PNE}$ 个满足指派。请确定其对应的转换后公式 $\\phi'$ 的NAE满足指派的总数。请用 $N_{PNE}$ 和 $m$ 将你的答案表示为一个解析表达式。",
            "solution": "设原始#PNE实例建立在变量 $x_{1},\\dots,x_{n}$ 和 $m$ 个指定变量对之上。对 $x$ 变量的一个真值指派是#PNE的有效解，当且仅当对于每个指定的变量对 $(x_{i},x_{j})$，都有 $x_{i} \\neq x_{j}$。设这类指派的数量为 $N_{PNE}$。\n\n对于每个索引为 $k \\in \\{1,\\dots,m\\}$ 的变量对，该转换引入一个辅助变量 $a_{k}$ 和两个NAE-3-SAT子句：\n$$\nC_{k}^{+}:(x_{i},x_{j},a_{k}), \\quad C_{k}^{-}:(x_{i},x_{j},\\neg a_{k}).\n$$\n回顾一下，一个包含三个文字的NAE子句被满足，当且仅当这三个文字不都具有相同的真值，这等价于它们中至少有一个为真且至少有一个为假。\n\n固定对 $x$ 变量的任意指派 $\\mathbf{x}$，并分析能满足所有子句的对 $(a_{1},\\dots,a_{m})$ 的扩展数量。\n\n1) 如果对于给定的变量对 $k$，在指派 $\\mathbf{x}$ 下有 $x_{i} \\neq x_{j}$，那么在文字 $(x_{i},x_{j},a_{k})$ 中，已经有一个来自 $x_{i}$ 和 $x_{j}$ 的真值和一个假值。因此，对于 $a_{k}=0$ 和 $a_{k}=1$ 两种情况，$C_{k}^{+}$ 都被满足。同样的推理也适用于 $C_{k}^{-}$，因为将 $a_{k}$ 替换为 $\\neg a_{k}$ 并不会改变 $x_{i}$ 和 $x_{j}$ 已经包含了真假两种值这一事实。因此，当 $x_{i} \\neq x_{j}$ 时，对于 $a_{k}$ 的两种取值，子句 $C_{k}^{+}$ 和 $C_{k}^{-}$ 都会被满足，从而为 $a_{k}$ 提供了恰好 $2$ 个有效选择。\n\n2) 如果对于给定的变量对 $k$，在指派 $\\mathbf{x}$ 下有 $x_{i}=x_{j}=v \\in \\{0,1\\}$，那么 $C_{k}^{+}$ 是NAE满足的当且仅当 $a_{k} \\neq v$，而 $C_{k}^{-}$ 是NAE满足的当且仅当 $\\neg a_{k} \\neq v$，即 $a_{k}=v$。这两个条件是矛盾的，所以不存在任何 $a_{k}$ 的值能同时满足 $C_{k}^{+}$ 和 $C_{k}^{-}$。因此，当 $x_{i}=x_{j}$ 时， $a_{k}$ 有 $0$ 个有效选择。\n\n因为每个小工具使用一个不同的辅助变量，所以不同变量对之间对 $a_{k}$ 的选择是相互独立的。因此，对于一个固定的指派 $\\mathbf{x}$：\n- 如果 $\\mathbf{x}$ 满足所有 $m$ 个不等式（即 $\\mathbf{x}$ 是一个#PNE解），那么对于每个 $a_{k}$ 都有 $2$ 个有效选择，从而产生 $2^{m}$ 个对 $(a_{1},\\dots,a_{m})$ 的扩展，这些扩展NAE满足 $\\phi'$ 中的所有子句。\n- 如果 $\\mathbf{x}$ 违反了至少一个不等式，那么对于那个被违反的变量对，其对应的 $a_k$ 就有 $0$ 个有效选择，从而导致总的扩展数量为 $0$。\n\n对所有指派 $\\mathbf{x} \\in \\{0,1\\}^{n}$ 求和，$\\phi'$ 的NAE满足指派的总数是\n$$\n\\sum_{\\mathbf{x}} \\left|\\left\\{\\mathbf{a} \\in \\{0,1\\}^{m} : (\\mathbf{x},\\mathbf{a}) \\text{ NAE-satisfies } \\phi' \\right\\}\\right| \\;=\\; N_{PNE} \\cdot 2^{m}.\n$$\n因此，转换后的公式 $\\phi'$ 恰好有 $N_{PNE} 2^{m}$ 个NAE满足指派。",
            "answer": "$$\\boxed{N_{PNE}\\,2^{m}}$$"
        }
    ]
}