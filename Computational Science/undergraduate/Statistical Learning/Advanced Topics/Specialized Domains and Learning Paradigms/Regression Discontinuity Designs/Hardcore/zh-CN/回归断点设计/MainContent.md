## 引言
在探寻“是什么原因导致的？”这类因果问题的过程中，研究者常常面临[选择偏误](@entry_id:172119)的挑战，即接受干预的群体与未接受干预的群体在干预前就存在系统性差异。回归断点设计（Regression Discontinuity Design, RDD）作为一种强大而直观的[准实验方法](@entry_id:636714)，为解决这一难题提供了严谨的框架。它巧妙地利用现实世界中基于明确阈值的分配规则，通过比较阈值两侧“几乎相同”的个体，来估计干预的局部因果效应，从而在非实验数据中获得了接近随机实验的可信度。

本文将系统性地引导您深入理解回归断点设计的全貌。在接下来的内容中，您将学习到：

-   **第一章：原理与机制**，我们将深入剖析支撑RDD的理论基石。您将了解夏普（Sharp）与模糊（Fuzzy）两种设计的核心思想、关键的识别假设，以及如何通过局部[多项式回归](@entry_id:176102)等方法准确估计因果效应，同时还将探讨如何识别和应对潜在的偏误。

-   **第二章：应用与跨学科联系**，我们将展示RDD在经济学、公共政策、医学、生态学等多个学科领域的广泛应用实例。您将看到这一方法如何被扩展以解决复杂的研究问题，例如结合差异中的差异法（DiD），并理解在不同情境下进行诊断性检验的重要性。

-   **第三章：动手实践**，您将通过具体的练习，探讨在实际操作中可能遇到的挑战，如政策断点与实际处理错位、数据边界效应以及估计器参数选择等问题，从而将理论知识转化为解决实际问题的能力。

通过这三个章节的学习，您将能够全面掌握回归断点设计的精髓，并有能力在自己的研究中审慎地应用这一强大的因果推断工具。

## 原理与机制

在寻求理解干预措施因果效应的过程中，回归断点设计（Regression Discontinuity Design, RDD）提供了一种强大且直观的[准实验方法](@entry_id:636714)。与依赖强假设的传统回归方法不同，RDD 利用了现实世界中普遍存在的基于明确规则的分配机制。本章将深入探讨支撑 RDD 的核心原理、关键假设、估计机制以及识别和应对潜在偏误的诊断工具。

### 核心思想：利用断点进行因果推断

想象一个场景：大学根据某个[标准化](@entry_id:637219)考试成绩是否达到特定分数线来决定是否授予奖学金。直观上，考试成绩刚好在分数线上方的学生与刚好在分数线下方的学生，在学术能力、家庭背景和学习动机等方面可能非常相似。他们之间最大的系统性差异，似乎就是其中一组获得了奖学金，而另一组没有。这种“局部[随机化](@entry_id:198186)”的思想正是回归断点设计的精髓。

在 RDD 框架中，我们定义几个关键要素：

1.  **驱动变量 (Running Variable)**, $X$: 一个连续的变量，决定个体是否接受干预。在上述例子中，这是学生的考试成绩。
2.  **断点 (Cutoff)**, $c$: 驱动变量的一个阈值，处理分配规则在此处发生改变。例如，奖学金的分数线。
3.  **处理 (Treatment)**, $D$: 一个[二元变量](@entry_id:162761)，指示个体是否接受了干预。

为了严谨地定义因果效应，我们引入**[潜在结果框架](@entry_id:636884) (Potential Outcomes Framework)**。对于每个个体，存在两个[潜在结果](@entry_id:753644)：$Y(1)$ 表示接受处理后的结果（例如，获得奖学金后的学业表现），$Y(0)$ 表示未接受处理时的结果。我们实际观测到的结果 $Y$ 是 $Y = D \cdot Y(1) + (1 - D) \cdot Y(0)$。因果推断的目标是估计处理对结果的影响，例如平均[处理效应](@entry_id:636010) $E[Y(1) - Y(0)]$。然而，一个简单的比较，即比较所有受处理者和未受处理者的平均结果，通常会因[选择偏误](@entry_id:172119)而产生误导——获得奖学金的学生本身可能就更优秀。RDD 通过聚焦于断点周围的局部比较，为克服这一挑战提供了解决方案。

### 夏普回归断点 (Sharp RD) 设计

最简单的 RDD 形式是夏普回归断点设计，其中处理状态完全由驱动变量是否超过断点决定。

**定义与假设**

在夏普 RDD 中，处理分配规则是确定性的：
$$
D = \mathbf{1}\{X \ge c\}
$$
其中 $\mathbf{1}\{\cdot\}$ 是[指示函数](@entry_id:186820)。所有 $X$ 大于等于 $c$ 的个体都接受处理，所有 $X$ 小于 $c$ 的个体都不接受处理。

我们感兴趣的估计目标是在断点处的**局部平均[处理效应](@entry_id:636010) (Local Average Treatment Effect, LATE)**，定义为：
$$
\tau_{SRD} = E[Y(1) - Y(0) \mid X=c]
$$
这个量度捕捉了对于那些驱动变量恰好等于断点的群体的平均因果效应。

为了从观测数据中识别出 $\tau_{SRD}$，RDD 依赖一个核心的识别假设：**[潜在结果](@entry_id:753644)的连续性**。该假设要求，[潜在结果](@entry_id:753644)的[条件期望](@entry_id:159140)函数 $E[Y(1) \mid X=x]$ 和 $E[Y(0) \mid X=x]$ 在断点 $x=c$ 处是连续的 。直观地说，这意味着在没有处理的情况下，结果变量随驱动变量平滑变化，在断点处没有“跳跃”。如果这个假设成立，那么恰好在断点两侧的个体，除了处理状态不同之外，在所有其他方面都是可比的。

**识别机制**

基于连续性假设，我们可以推导出识别策略。考虑观测结果的条件期望 $E[Y \mid X=x]$：

-   当 $x$ 从右侧逼近断点 $c$ 时（$x \downarrow c$），所有个体的处理状态均为 $D=1$，因此观测结果为 $Y=Y(1)$。根据连续性假设：
    $$
    \lim_{x \downarrow c} E[Y \mid X=x] = \lim_{x \downarrow c} E[Y(1) \mid X=x] = E[Y(1) \mid X=c]
    $$
-   当 $x$ 从左侧逼近断点 $c$ 时（$x \uparrow c$），所有个体的处理状态均为 $D=0$，观测结果为 $Y=Y(0)$。同样，根据连续性假设：
    $$
    \lim_{x \uparrow c} E[Y \mid X=x] = \lim_{x \uparrow c} E[Y(0) \mid X=x] = E[Y(0) \mid X=c]
    $$

将两者相减，我们发现观测结果在断点处的跳跃幅度恰好等于我们感兴趣的因果效应：
$$
\lim_{x \downarrow c} E[Y \mid X=x] - \lim_{x \uparrow c} E[Y \mid X=x] = E[Y(1) \mid X=c] - E[Y(0) \mid X=c] = \tau_{SRD}
$$
因此，夏普 RDD 将因果推断问题转化为了一个估计函数在某一点处不连续性的统计问题。

连续性假设是 RDD 的基石。如果这个假设被违反，估计就会产生偏误。例如，设想一个情景，其中[潜在结果](@entry_id:753644) $Y_0(x)$ 本身在断点 $c$ 处就存在一个大小为 $\delta$ 的跳跃。这意味着，即使没有施加任何处理，断点两侧的个体也存在系统性差异。在这种情况下，观测结果的跳跃将是 $(\tau + \delta)$，我们的估计量将错误地将这个固有的跳跃 $\delta$ 归因于[处理效应](@entry_id:636010)，导致估计偏误恰好为 $\delta$ 。这凸显了检验 RDD 假设的重要性。

### 模糊回归断点 (Fuzzy RD) 设计

在许多现实情景中，跨越断点并不直接决定处理，而是改变了接受处理的**概率**。例如，考试成绩超过分数线可能使学生有*资格*获得辅导，但并非所有符合资格的学生都会参加。这种设计被称为模糊回归断点 (Fuzzy RD) 设计。

在模糊 RDD 中，处理分配不再是确定性的。我们引入一个工具变量 (Instrumental Variable, IV) $Z = \mathbf{1}\{X \ge c\}$，它代表了处理的“意图”或“鼓励”。实际接受的处理仍然是 $D$。

**作为局部 IV 的模糊 RDD**

模糊 RDD 可以被看作是一个在断点 $c$ 附近的局部 IV 估计问题。为了识别因果效应，除了[潜在结果](@entry_id:753644)的连续性假设外，还需要两个来自 IV 框架的标准假设：

1.  **排除限制 (Exclusion Restriction)**: 工具变量 $Z$ 只能通过影响处理 $D$ 来影响结果 $Y$。在 RDD 的背景下，这意味着跨越断点本身除了改变处理概率外，不应直接影响结果。
2.  **[单调性](@entry_id:143760) (Monotonicity)**: 工具变量对所有个体的影响方向是相同的。具体来说，对于任何个体，如果他们在没有鼓励的情况下会接受处理，那么在有鼓励的情况下也一定会接受处理 ($D(Z=1) \ge D(Z=0)$)。这个假设排除了“** defiant者**”的存在，即那些因为被鼓励而反而拒绝处理的人。

在这些假设下，我们可以推导出**局部瓦尔德估计量 (Local Wald Estimator)** 。它等于结果变量在断点处的跳跃（即“简化形式”效应）与处理概率在断点处的跳跃（即“第一阶段”效应）之比：
$$
\tau_{FRD} = \frac{\lim_{x \downarrow c} E[Y \mid X=x] - \lim_{x \uparrow c} E[Y \mid X=x]}{\lim_{x \downarrow c} E[D \mid X=x] - \lim_{x \uparrow c} E[D \mid X=x]}
$$
这个比率所识别的，是在断点处因跨越阈值而被诱导接受处理的那部分人群（即“**依从者 (compliers)**”）的平均[处理效应](@entry_id:636010)。这就是模糊 RDD 的局部平均[处理效应](@entry_id:636010) (LATE)。

[单调性](@entry_id:143760)假设至关重要。如果这个假设不成立，例如，如果第一阶段的跳跃为负（意味着跨越断点反而降低了处理概率），这表明在断点附近，defiant者的数量超过了 complier 的数量。在这种情况下，瓦尔德估计量会混合 complier 和 defiant者 的[处理效应](@entry_id:636010)，失去其清晰的因果解释 。

### 估计方法：局部[多项式回归](@entry_id:176102)

理论上，RDD 估计的是[条件期望](@entry_id:159140)函数在断点处的极限差。在实践中，我们如何从有限的样本中估计这些极限？

一个常见的错误是使用全局[平滑方法](@entry_id:754982)，如局部加权散点平滑法 (LOESS)，跨越整个数据范围拟合一条曲线。这类方法的设计初衷是拟合[连续函数](@entry_id:137361)，因此它们会有意地“平滑掉”断点处的真实跳跃，导致对[处理效应](@entry_id:636010)的估计严重偏向于零 。

正确的做法是采用**局部**方法，明确允许在断点处存在不连续性。目前最流行和推荐的方法是**局部[多项式回归](@entry_id:176102) (Local Polynomial Regression)**。该方法包括以下步骤：

1.  选择一个带宽 $h$ 和一个多项式阶数 $p$（通常为 $p=1$，即[局部线性回归](@entry_id:635822)）。
2.  在断点的左侧，使用带宽 $[c-h, c)$ 内的数据点，拟合一个 $p$ 阶加权[多项式回归](@entry_id:176102)。
3.  在断点的右侧，使用带宽 $[c, c+h]$ 内的数据点，拟合另一个 $p$ 阶加权[多项式回归](@entry_id:176102)。
4.  权重通常由一个核函数 (kernel function) 给出，例如三角核，它为离断点更近的点赋予更大的权重。
5.  RDD 效应的估计值 $\hat{\tau}$ 是右侧回归在 $c$ 点的预测值与左侧回归在 $c$ 点的预测值之差。对于[局部线性回归](@entry_id:635822)，这恰好是两个[回归模型](@entry_id:163386)的截距之差。

选择带宽 $h$ 是一个关键的权衡过程：较小的 $h$ 可以减少由模型错误设定（例如，用直线逼近曲线）引起的**偏误**，但会因为使用更少的数据点而增加估计的**[方差](@entry_id:200758)**。现代 RDD 软件通常包含数据驱动的最优[带宽选择](@entry_id:174093)算法。在模糊 RDD 中，由于结果回归和处理概率回归的函数形式与误差结构不同，分别为分子和分母选择不同的最优带宽是合理且推荐的做法 。

虽然[局部线性回归](@entry_id:635822)是标准做法，但其他[非参数方法](@entry_id:138925)也存在，如使用带罚项的样条回归 。[样条](@entry_id:143749)回归更灵活，能够从远离断点的数据中“[借力](@entry_id:167067)”来估计函数的整体曲率，这在数据稀疏的区域可能有助于减小偏误。然而，它也引入了由平滑参数控制的正则化偏误。选择哪种方法取决于具体的数据特征和研究目标。

### 对有效性的威胁与诊断检验

RDD 的有效性依赖于其核心假设。因此，在报告 RDD 结果之前，进行一系列严格的诊断检验是至关重要的。

#### 驱动变量的操纵

RDD 的一个核心前提是，个体不能精确地操纵驱动变量 $X$ 以便刚好落在断点的有利一侧 。如果那些能从处理中获益最多的人能够通过努力将他们的分数刚好提高到分数线以上，那么断点两侧的群体就不再具有可比性。这种“策略性排序”会直接破坏[潜在结果](@entry_id:753644)的连续性假设。

这种操纵行为的一个可观测后果是，驱动变量 $X$ 的**[概率密度函数](@entry_id:140610)**在断点处可能会出现不连续。例如，我们可能会观察到断点右侧的个体数量异常增多，而左侧则相应减少。**麦克雷里检验 (McCrary Test)** 是一种专门用于检测驱动变量密度在断点处是否存在跳跃的 formal test.

更细致地看，即使没有明显的密度跳跃，操纵也可能以更微妙的方式发生。例如，如果某个区间的个体（如分数在 $[c-\delta, c)$ 内）有机会将他们的分数提高 $\delta$，这会扭曲观测到的驱动变量 $X^*$与真实的潜在驱动变量 $X$ 之间的关系，从而在断点处引入偏误 。

#### 驱动变量的测量误差

另一个常见的复杂情况是驱动变量存在[测量误差](@entry_id:270998)。假设处理是由真实的潜在变量 $X^*$ 决定的，但我们只能观测到一个带噪音的版本 $W = X^* + U$。在这种情况下，断点变得“模糊”。即使我们选择一个基于观测变量 $W$ 的窗口（例如 $[0, h]$），这个窗口内也会混杂着真实 $X^*$ 大于零和小于零的个体。这种混淆导致了处理组和[控制组](@entry_id:747837)的“污染”，使得两组之间的差异变得不那么明显。其最终结果是对[处理效应](@entry_id:636010)的估计产生**[衰减偏误](@entry_id:746571) (attenuation bias)**，即估计值的大小会系统性地偏向于零 。

#### 安慰剂检验 (Placebo Tests)

RDD 的识别逻辑仅适用于存在真实处理分配机制的断点 $c$。一个强大的诊断方法是在不存在[处理效应](@entry_id:636010)的地方进行“安慰剂”检验。这通常通过两种方式实现：

1.  **在其他断点进行检验**: 如果在驱动变量的其他位置 $c'$（理论上不应有任何效应）应用相同的 RDD 估计程序，我们期望得到一个接近于零且不显著的“效应”。如果在多个安慰剂断点处反复发现显著的非零效应，这是一个强烈的[危险信号](@entry_id:195376)。它表明我们的估计模型（例如，所选的带宽过大或多项式阶数过低）可能存在严重错误设定，错误地将平滑的[非线性](@entry_id:637147)趋势解读为了虚假的“跳跃” 。

2.  **对不受影响的结果变量进行检验**: 我们可以将 RDD 方法应用于那些已知不受处理影响的**前定协变量 (pre-determined covariates)**。例如，我们不期望奖学金的发放会改变学生在接受奖学金之前的家庭收入。

#### [协变](@entry_id:634097)量平衡性检验

这一思想引出了**协变量平衡性检验**。如果断点两侧的个体确实“局部随机”，那么他们的所有前定特征（如性别、年龄、之前的成绩等）的平均值在断点处也应该是连续的。我们可以通过对每个重要的[协变](@entry_id:634097)量 $Z$ 运行 RDD 分析来检验这一点。如果在任何一个[协变](@entry_id:634097)量上发现了显著的断点，这将对整个 RDD 设计的有效性提出严重质疑。

进行此项检验时，至关重要的是使用与主结果分析**完全相同**的估计设定（即相同的带宽 $h$ 和多项式阶数 $p$）。如果使用不同的设定，例如为[协变](@entry_id:634097)量检验选择一个更大的带宽，可能会因为平滑作用而掩盖掉一个只在断点附近存在的真实不平衡，从而給出一种虛假的安全感 。

总之，回归断点设计是一个透明且基于可信假设的因果推断工具。然而，它的有效性并非自动保证。研究者必须仔细考虑其基本原理，审慎选择估计方法，并执行一套全面的诊断检验，以确保所得结论的稳健性和可信度。