{
    "hands_on_practices": [
        {
            "introduction": "要真正掌握混淆矩阵，第一步是亲手构建一个。本练习  提供了一个具体的生物学场景，您将使用一个高斯朴素贝叶斯分类器来预测细胞周期阶段。通过对每个测试样本进行分类，并将其预测结果与真实标签进行比较，您将学习如何系统地填充混淆矩阵的每一个单元格，从而巩固对真阳性、假阳性、真阴性和假阴性这些核心概念的理解。",
            "id": "1423429",
            "problem": "一位系统生物学家正在开发一个模型，用于将单个细胞分为三个不同的细胞周期阶段：阶段 1 (P1)、阶段 2 (P2) 和阶段 3 (P3)。分类依据是两个关键调控基因（基因 A 和基因 B）的归一化表达水平。\n\n该任务选择了高斯朴素贝叶斯分类器。该模型假设在给定的细胞周期阶段，基因 A 和基因 B 的表达水平是条件独立的。它还假设每个阶段内每个基因的表达水平服从正态（高斯）分布。\n\n从大量预先分类的细胞中，得出了以下训练数据的统计摘要：\n- 训练细胞总数为 1000。每个阶段的计数为：P1 阶段 400 个细胞，P2 阶段 350 个细胞，P3 阶段 250 个细胞。\n- 每个阶段中每个基因的归一化表达水平的均值 ($\\mu$) 和标准差 ($\\sigma$) 在下表中给出。表达水平是无量纲量。\n\n| 阶段 | 基因 A ($\\mu_A, \\sigma_A$) | 基因 B ($\\mu_B, \\sigma_B$) |\n|---|---|---|\n| P1 | (5.0, 1.0) | (4.0, 1.2) |\n| P2 | (8.0, 1.5) | (6.0, 1.0) |\n| P3 | (6.0, 1.2) | (9.0, 1.5) |\n\n收集了一组新的 6 个已知真实阶段的测试细胞来评估分类器的性能。它们的基因表达水平和真实阶段如下：\n\n| 细胞 ID | 基因 A 表达量 | 基因 B 表达量 | 真实阶段 |\n|---|---|---|---|\n| S1 | 5.5 | 4.5 | P1 |\n| S2 | 7.5 | 5.8 | P2 |\n| S3 | 6.2 | 8.5 | P3 |\n| S4 | 4.8 | 6.5 | P1 |\n| S5 | 8.5 | 8.8 | P2 |\n| S6 | 7.0 | 7.0 | P3 |\n\n对于每个测试细胞，使用训练好的高斯朴素贝叶斯分类器确定其预测阶段。然后，构建分类器在该测试集上性能的混淆矩阵。混淆矩阵应该是一个 3x3 矩阵，其中行代表真实阶段（按 P1、P2、P3 的顺序），列代表预测阶段（按 P1、P2、P3 的顺序）。\n\n以逐行列表的形式提供混淆矩阵的 9 个整数元素作为您的最终答案。也就是说，先提供 (真实 P1, 预测 P1) 的元素，然后是 (真实 P1, 预测 P2)、(真实 P1, 预测 P3)，接着是 (真实 P2, 预测 P1)，依此类推。",
            "solution": "我们使用高斯朴素贝叶斯分类器对类条件密度进行建模。设类别标签为 $c \\in \\{\\text{P1}, \\text{P2}, \\text{P3}\\}$，特征为基因 A 和基因 B 的 $x = (x_{A}, x_{B})$。该模型假设在给定类别下条件独立，并且每个基因服从单变量正态分布：\n$$\np(x \\mid c) \\;=\\; \\prod_{j \\in \\{A,B\\}} \\frac{1}{\\sigma_{c,j}\\sqrt{2\\pi}} \\exp\\!\\left(-\\frac{(x_{j}-\\mu_{c,j})^{2}}{2\\sigma_{c,j}^{2}}\\right).\n$$\n根据计数得出的类别先验概率为\n$$\n\\pi_{\\text{P1}}=\\frac{400}{1000}=0.4,\\quad \\pi_{\\text{P2}}=\\frac{350}{1000}=0.35,\\quad \\pi_{\\text{P3}}=\\frac{250}{1000}=0.25.\n$$\n对于预测，我们比较（未归一化的）对数后验分数\n$$\ns_{c}(x) \\;=\\; \\ln \\pi_{c} \\;+\\; \\sum_{j \\in \\{A,B\\}} \\left[-\\ln \\sigma_{c,j} \\;-\\; \\frac{(x_{j}-\\mu_{c,j})^{2}}{2\\sigma_{c,j}^{2}} \\right] \\;-\\; \\sum_{j \\in \\{A,B\\}} \\ln \\sqrt{2\\pi}.\n$$\n最后一项 $-\\sum_{j} \\ln \\sqrt{2\\pi}$ 对于固定的 $x$ 在所有类别中是常数，因此在求 argmax 时可以省略。定义\n$$\n\\text{base}_{c} \\;=\\; \\ln \\pi_{c} \\;-\\; \\sum_{j \\in \\{A,B\\}} \\ln \\sigma_{c,j}, \\qquad Q_{c}(x) \\;=\\; \\sum_{j \\in \\{A,B\\}} \\frac{(x_{j}-\\mu_{c,j})^{2}}{2\\sigma_{c,j}^{2}},\n$$\n这样 $s_{c}(x)=\\text{base}_{c} - Q_{c}(x)$，不计一个与 $c$ 无关的加性常数。\n\n根据表格，参数如下：\n- P1: $(\\mu_{A},\\sigma_{A})=(5.0,1.0)$, $(\\mu_{B},\\sigma_{B})=(4.0,1.2)$,\n- P2: $(\\mu_{A},\\sigma_{A})=(8.0,1.5)$, $(\\mu_{B},\\sigma_{B})=(6.0,1.0)$,\n- P3: $(\\mu_{A},\\sigma_{A})=(6.0,1.2)$, $(\\mu_{B},\\sigma_{B})=(9.0,1.5)$.\n\n计算基础项：\n$$\n\\ln \\pi_{\\text{P1}} = \\ln(0.4) \\approx -0.916291,\\quad -\\sum \\ln \\sigma_{\\text{P1},j} = -\\ln 1.0 - \\ln 1.2 \\approx -0.182322,\\quad \\text{base}_{\\text{P1}} \\approx -1.098613,\n$$\n$$\n\\ln \\pi_{\\text{P2}} = \\ln(0.35) \\approx -1.049822,\\quad -\\sum \\ln \\sigma_{\\text{P2},j} = -\\ln 1.5 - \\ln 1.0 \\approx -0.405465,\\quad \\text{base}_{\\text{P2}} \\approx -1.455287,\n$$\n$$\n\\ln \\pi_{\\text{P3}} = \\ln(0.25) \\approx -1.386294,\\quad -\\sum \\ln \\sigma_{\\text{P3},j} = -\\ln 1.2 - \\ln 1.5 \\approx -0.587787,\\quad \\text{base}_{\\text{P3}} \\approx -1.974081.\n$$\n\n对于每个测试细胞 $x=(x_{A},x_{B})$，计算 $Q_{c}(x)=\\sum_{j} \\frac{(x_{j}-\\mu_{c,j})^{2}}{2\\sigma_{c,j}^{2}}$，然后计算 $s_{c}(x)=\\text{base}_{c}-Q_{c}(x)$；预测具有最大 $s_{c}(x)$ 值的类别。\n\nS1: $(5.5,4.5)$。\n- P1: 偏差 $(0.5,0.5)$，方差 $(1.0,1.44)$，\n$$\nQ_{\\text{P1}} = \\frac{0.5^{2}}{2\\cdot 1.0} + \\frac{0.5^{2}}{2\\cdot 1.44} = 0.125 + 0.086806 \\approx 0.211806,\\quad s_{\\text{P1}} \\approx -1.098613 - 0.211806 = -1.310419.\n$$\n- P2: 偏差 $(-2.5,-1.5)$，方差 $(2.25,1.0)$，\n$$\nQ_{\\text{P2}} = \\frac{2.5^{2}}{2\\cdot 2.25} + \\frac{1.5^{2}}{2\\cdot 1.0} = 1.388889 + 1.125 = 2.513889,\\quad s_{\\text{P2}} \\approx -1.455287 - 2.513889 = -3.969176.\n$$\n- P3: 偏差 $(-0.5,-4.5)$，方差 $(1.44,2.25)$，\n$$\nQ_{\\text{P3}} = \\frac{0.5^{2}}{2\\cdot 1.44} + \\frac{4.5^{2}}{2\\cdot 2.25} = 0.086806 + 4.5 = 4.586806,\\quad s_{\\text{P3}} \\approx -1.974081 - 4.586806 = -6.560887.\n$$\n预测：P1。\n\nS2: $(7.5,5.8)$。\n- P1: 偏差 $(2.5,1.8)$，方差 $(1.0,1.44)$，\n$$\nQ_{\\text{P1}} = \\frac{2.5^{2}}{2\\cdot 1.0} + \\frac{1.8^{2}}{2\\cdot 1.44} = 3.125 + 1.125 = 4.25,\\quad s_{\\text{P1}} \\approx -1.098613 - 4.25 = -5.348613.\n$$\n- P2: 偏差 $(-0.5,-0.2)$，方差 $(2.25,1.0)$，\n$$\nQ_{\\text{P2}} = \\frac{0.5^{2}}{2\\cdot 2.25} + \\frac{0.2^{2}}{2\\cdot 1.0} = 0.055556 + 0.02 = 0.075556,\\quad s_{\\text{P2}} \\approx -1.455287 - 0.075556 = -1.530843.\n$$\n- P3: 偏差 $(1.5,-3.2)$，方差 $(1.44,2.25)$，\n$$\nQ_{\\text{P3}} = \\frac{1.5^{2}}{2\\cdot 1.44} + \\frac{3.2^{2}}{2\\cdot 2.25} = 0.78125 + 2.275556 = 3.056806,\\quad s_{\\text{P3}} \\approx -1.974081 - 3.056806 = -5.030887.\n$$\n预测：P2。\n\nS3: $(6.2,8.5)$。\n- P1: 偏差 $(1.2,4.5)$，方差 $(1.0,1.44)$，\n$$\nQ_{\\text{P1}} = \\frac{1.2^{2}}{2\\cdot 1.0} + \\frac{4.5^{2}}{2\\cdot 1.44} = 0.72 + 7.03125 = 7.75125,\\quad s_{\\text{P1}} \\approx -1.098613 - 7.75125 = -8.849863.\n$$\n- P2: 偏差 $(-1.8,2.5)$，方差 $(2.25,1.0)$，\n$$\nQ_{\\text{P2}} = \\frac{1.8^{2}}{2\\cdot 2.25} + \\frac{2.5^{2}}{2\\cdot 1.0} = 0.72 + 3.125 = 3.845,\\quad s_{\\text{P2}} \\approx -1.455287 - 3.845 = -5.300287.\n$$\n- P3: 偏差 $(0.2,-0.5)$，方差 $(1.44,2.25)$，\n$$\nQ_{\\text{P3}} = \\frac{0.2^{2}}{2\\cdot 1.44} + \\frac{0.5^{2}}{2\\cdot 2.25} = 0.013889 + 0.055556 = 0.0694449,\\quad s_{\\text{P3}} \\approx -1.974081 - 0.0694449 = -2.043526.\n$$\n预测：P3。\n\nS4: $(4.8,6.5)$。\n- P1: 偏差 $(-0.2,2.5)$，方差 $(1.0,1.44)$，\n$$\nQ_{\\text{P1}} = \\frac{0.2^{2}}{2\\cdot 1.0} + \\frac{2.5^{2}}{2\\cdot 1.44} = 0.02 + 2.170139 = 2.190139,\\quad s_{\\text{P1}} \\approx -1.098613 - 2.190139 = -3.288752.\n$$\n- P2: 偏差 $(-3.2,0.5)$，方差 $(2.25,1.0)$，\n$$\nQ_{\\text{P2}} = \\frac{3.2^{2}}{2\\cdot 2.25} + \\frac{0.5^{2}}{2\\cdot 1.0} = 2.275556 + 0.125 = 2.400556,\\quad s_{\\text{P2}} \\approx -1.455287 - 2.400556 = -3.855843.\n$$\n- P3: 偏差 $(-1.2,-2.5)$，方差 $(1.44,2.25)$，\n$$\nQ_{\\text{P3}} = \\frac{1.2^{2}}{2\\cdot 1.44} + \\frac{2.5^{2}}{2\\cdot 2.25} = 0.5 + 1.388889 = 1.888889,\\quad s_{\\text{P3}} \\approx -1.974081 - 1.888889 = -3.862970.\n$$\n预测：P1。\n\nS5: $(8.5,8.8)$。\n- P1: 偏差 $(3.5,4.8)$，方差 $(1.0,1.44)$，\n$$\nQ_{\\text{P1}} = \\frac{3.5^{2}}{2\\cdot 1.0} + \\frac{4.8^{2}}{2\\cdot 1.44} = 6.125 + 8 = 14.125,\\quad s_{\\text{P1}} \\approx -1.098613 - 14.125 = -15.223613.\n$$\n- P2: 偏差 $(0.5,2.8)$，方差 $(2.25,1.0)$，\n$$\nQ_{\\text{P2}} = \\frac{0.5^{2}}{2\\cdot 2.25} + \\frac{2.8^{2}}{2\\cdot 1.0} = 0.055556 + 3.92 = 3.975556,\\quad s_{\\text{P2}} \\approx -1.455287 - 3.975556 = -5.430843.\n$$\n- P3: 偏差 $(2.5,-0.2)$，方差 $(1.44,2.25)$，\n$$\nQ_{\\text{P3}} = \\frac{2.5^{2}}{2\\cdot 1.44} + \\frac{0.2^{2}}{2\\cdot 2.25} = 2.170139 + 0.008889 = 2.179028,\\quad s_{\\text{P3}} \\approx -1.974081 - 2.179028 = -4.153109.\n$$\n预测：P3。\n\nS6: $(7.0,7.0)$。\n- P1: 偏差 $(2.0,3.0)$，方差 $(1.0,1.44)$，\n$$\nQ_{\\text{P1}} = \\frac{2.0^{2}}{2\\cdot 1.0} + \\frac{3.0^{2}}{2\\cdot 1.44} = 2 + 3.125 = 5.125,\\quad s_{\\text{P1}} \\approx -1.098613 - 5.125 = -6.223613.\n$$\n- P2: 偏差 $(-1.0,1.0)$，方差 $(2.25,1.0)$，\n$$\nQ_{\\text{P2}} = \\frac{1.0^{2}}{2\\cdot 2.25} + \\frac{1.0^{2}}{2\\cdot 1.0} = 0.222222 + 0.5 = 0.722222,\\quad s_{\\text{P2}} \\approx -1.455287 - 0.722222 = -2.177509.\n$$\n- P3: 偏差 $(1.0,-2.0)$，方差 $(1.44,2.25)$，\n$$\nQ_{\\text{P3}} = \\frac{1.0^{2}}{2\\cdot 1.44} + \\frac{2.0^{2}}{2\\cdot 2.25} = 0.347222 + 0.888889 = 1.236111,\\quad s_{\\text{P3}} \\approx -1.974081 - 1.236111 = -3.210192.\n$$\n预测：P2。\n\n预测标签：\n- S1: P1; S4: P1 (两者真实阶段均为 P1),\n- S2: P2; S5: P3 (真实阶段为 P2，一个正确，一个被错误分类为 P3),\n- S3: P3; S6: P2 (真实阶段为 P3，一个正确，一个被错误分类为 P2)。\n\n构建混淆矩阵，行代表真实阶段 (P1, P2, P3)，列代表预测阶段 (P1, P2, P3)。计数：\n- 真实 P1: 预测为 P1 两次，P2 零次，P3 零次 → $(2,0,0)$。\n- 真实 P2: 预测为 P1 零次，P2 一次，P3 一次 → $(0,1,1)$。\n- 真实 P3: 预测为 P1 零次，P2 一次，P3 一次 → $(0,1,1)$。\n\n逐行列表，这 9 个元素是 $2, 0, 0, 0, 1, 1, 0, 1, 1$。",
            "answer": "$$\\boxed{\\begin{pmatrix}2  0  0  0  1  1  0  1  1\\end{pmatrix}}$$"
        },
        {
            "introduction": "虽然准确率（$\\text{Acc}$）是一个直观的指标，但它有时会掩盖模型的关键缺陷，尤其是在处理类别不平衡的数据时。本练习  旨在揭示准确率的局限性，它展示了两个具有相同准确率但 $F_1$ 分数截然不同的分类系统。通过分析假阳性（$FP$）和假阴性（$FN$）的权衡，您将理解为什么精确率（$P$）和召回率（$R$）的调和平均值——$F_1$ 分数，能为我们提供一个更全面、更稳健的模型性能评估。",
            "id": "3094202",
            "problem": "一个二元分类器在一个数据集上进行评估，结果由一个混淆矩阵总结，其条目为 $(TP, FP, TN, FN)$，其中 $TP$ 表示真正例的数量，$FP$ 表示假正例的数量，$TN$ 表示真反例的数量，$FN$ 表示假反例的数量。准确率（$\\text{Acc}$）定义为 $\\text{Acc} = \\frac{TP + TN}{TP + FP + TN + FN}$。精确率（$P$）和召回率（$R$）分别定义为 $P = \\frac{TP}{TP + FP}$ 和 $R = \\frac{TP}{TP + FN}$。$F_1$ 分数（$F_1$）是总结 $P$ 和 $R$ 的标准单一数值指标。\n\n选择唯一一个选项，该选项为两个系统（比如系统 $X$ 和系统 $Y$）提供了两个混淆矩阵 $(TP, FP, TN, FN)$，这两个系统具有相同的 $\\text{Acc}$ 但 $F_1$ 分数差异巨大（将“差异巨大”解释为 $F_1$ 分数的差异至少为 $0.30$），并且该选项还提供了关于 $F_1$ 为何不同的正确结构性解释，该解释用 $P$ 和 $R$ 来陈述，并基于 $FP$ 和 $FN$ 的差异。只有一个选项同时满足数值和解释上的要求。\n\nA. 系统 $X$：$(TP, FP, TN, FN) = (20, 5, 895, 80)$；系统 $Y$：$(TP, FP, TN, FN) = (80, 65, 835, 20)$。解释：两个系统的 $TP + TN$ 相同，因此 $\\text{Acc}$ 匹配。$F_1$ 不同是因为在 $FP$ 和 $FN$ 之间进行了权衡：系统 $X$ 的 $FP$ 较小（高 $P$），但 $FN$ 较大（低 $R$）；系统 $Y$ 的 $FP$ 较大（较低的 $P$），但 $FN$ 较小（较高的 $R$），从而产生了 $P$ 和 $R$ 的截然不同的调和平衡。\n\nB. 系统 $X$：$(TP, FP, TN, FN) = (50, 50, 850, 50)$；系统 $Y$：$(TP, FP, TN, FN) = (45, 45, 855, 55)$。解释：因为两者的 $\\text{Acc}$ 相同，所以它们的 $F_1$ 分数必然相等；$F_1$ 完全由 $\\text{Acc}$ 决定。\n\nC. 系统 $X$：$(TP, FP, TN, FN) = (10, 10, 980, 0)$；系统 $Y$：$(TP, FP, TN, FN) = (10, 0, 970, 20)$。解释：它们的 $\\text{Acc}$ 值相等，而 $F_1$ 不同是因为真反例数 $TN$ 直接驱动 $F_1$。\n\nD. 系统 $X$：$(TP, FP, TN, FN) = (90, 10, 890, 10)$；系统 $Y$：$(TP, FP, TN, FN) = (80, 0, 900, 20)$。解释：这里的任何 $F_1$ 差异主要是由改变 $TN$ 引起的，因为 $TN$ 出现在 $P$ 和 $R$ 的分母中并直接改变两者。",
            "solution": "用户请求对问题陈述进行严格验证，然后对所提供的选项进行全面推导和评估。\n\n### 问题验证\n\n**步骤1：提取已知条件**\n\n问题为一个在数据集上评估的二元分类器提供了以下定义和条件：\n- 混淆矩阵条目：$(TP, FP, TN, FN)$，表示真正例、假正例、真反例和假反例。\n- 准确率定义：$ \\text{Acc} = \\frac{TP + TN}{TP + FP + TN + FN} $。\n- 精确率定义：$ P = \\frac{TP}{TP + FP} $。\n- 召回率定义：$ R = \\frac{TP}{TP + FN} $。\n- $F_1$ 分数 ($F_1$) 定义为“$P$ 和 $R$ 的标准单值摘要”。\n- 任务是选择唯一一个选项，该选项为系统 $X$ 和系统 $Y$ 提供了两个混淆矩阵，并满足两个数值标准和一个解释性标准：\n    1.  准确率相同：$\\text{Acc}_X = \\text{Acc}_Y$。\n    2.  $F_1$ 分数“差异巨大”，解释为差异至少为 $0.30$：$|F_{1,X} - F_{1,Y}| \\geq 0.30$。\n    3.  选项用 $P$、$R$、$FP$ 和 $FN$ 提供了关于 $F_1$ 差异的正确结构性解释。\n\n**步骤2：使用提取的已知条件进行验证**\n\n- **科学依据**：问题基于统计学习和模型评估中使用的基本和标准指标。准确率、精确率和召回率的定义是正确的。将 $F_1$ 分数称为“标准单值摘要”正确地指向了精确率和召回率的调和平均数，这是一个公认的概念。\n- **适定性**：问题是一个多项选择题，要求应用给定的公式并评估逻辑解释。术语“差异巨大”被赋予了精确的量化含义 ($|F_{1,X} - F_{1,Y}| \\geq 0.30$)，从而消除了歧义。问题的结构决定了只有一个正确答案同时满足数值和解释标准。\n- **客观性**：问题陈述使用数学定义，以精确、客观的语言编写。没有主观性。\n- **完整性和一致性**：解决问题所需的所有必要定义和数据（在选项中）都已提供。在此上下文中，对标准 $F_1$ 分数的引用是明确的。问题内部是一致的。\n\n**步骤3：结论和行动**\n\n问题陈述有效。它具有科学性、适定性和客观性。我将继续进行解答。\n\n### 解题推导\n\n$F_1$ 分数是精确率 ($P$) 和召回率 ($R$) 的调和平均数。其标准公式为：\n$$ F_1 = 2 \\cdot \\frac{P \\cdot R}{P + R} $$\n代入 $P$ 和 $R$ 的定义，可以得到一个直接用混淆矩阵分量表示的公式：\n$$ F_1 = 2 \\cdot \\frac{\\frac{TP}{TP + FP} \\cdot \\frac{TP}{TP + FN}}{\\frac{TP}{TP + FP} + \\frac{TP}{TP + FN}} = \\frac{2 \\cdot TP}{2 \\cdot TP + FP + FN} $$\n后一种形式在计算上更方便。样本总数为 $N = TP + FP + TN + FN$。准确率可以写为 $\\text{Acc} = \\frac{TP + TN}{N}$。\n\n我们现在将通过计算所需的指标并评估所提供解释的有效性来评估每个选项。\n\n**选项A的分析**\n\n系统 $X$：$(TP, FP, TN, FN) = (20, 5, 895, 80)$\n- 样本总数：$N_X = 20 + 5 + 895 + 80 = 1000$。\n- 准确率：$\\text{Acc}_X = \\frac{20 + 895}{1000} = \\frac{915}{1000} = 0.915$。\n- 精确率：$P_X = \\frac{20}{20 + 5} = \\frac{20}{25} = 0.8$。\n- 召回率：$R_X = \\frac{20}{20 + 80} = \\frac{20}{100} = 0.2$。\n- $F_1$ 分数：$F_{1,X} = \\frac{2 \\cdot TP_X}{2 \\cdot TP_X + FP_X + FN_X} = \\frac{2 \\cdot 20}{2 \\cdot 20 + 5 + 80} = \\frac{40}{40 + 85} = \\frac{40}{125} = 0.32$。\n\n系统 $Y$：$(TP, FP, TN, FN) = (80, 65, 835, 20)$\n- 样本总数：$N_Y = 80 + 65 + 835 + 20 = 1000$。\n- 准确率：$\\text{Acc}_Y = \\frac{80 + 835}{1000} = \\frac{915}{1000} = 0.915$。\n- 精确率：$P_Y = \\frac{80}{80 + 65} = \\frac{80}{145} = \\frac{16}{29} \\approx 0.5517$。\n- 召回率：$R_Y = \\frac{80}{80 + 20} = \\frac{80}{100} = 0.8$。\n- $F_1$ 分数：$F_{1,Y} = \\frac{2 \\cdot TP_Y}{2 \\cdot TP_Y + FP_Y + FN_Y} = \\frac{2 \\cdot 80}{2 \\cdot 80 + 65 + 20} = \\frac{160}{160 + 85} = \\frac{160}{245} = \\frac{32}{49} \\approx 0.6531$。\n\n**选项A的评估：**\n1.  **准确率相等**：$\\text{Acc}_X = 0.915$ 且 $\\text{Acc}_Y = 0.915$。此条件满足。\n2.  **F1差异**：$|F_{1,X} - F_{1,Y}| = |0.32 - 0.6531| = 0.3331$。由于 $0.3331 \\geq 0.30$，此条件满足。\n3.  **解释**：解释指出，$\\text{Acc}$ 匹配是因为两个系统的 $TP + TN$ 相同（均为 $915$），而样本总数 $N$ 也相同（均为 $1000$）。这是正确的。它进一步解释说，$F_1$ 之所以不同，是由于在 $FP$ 和 $FN$ 之间存在权衡。系统 $X$ 的 $FP$ 很低（$5$），$FN$ 很高（$80$），导致高 $P$（$0.8$）和低 $R$（$0.2$）。系统 $Y$ 的 $FP$ 很高（$65$），$FN$ 很低（$20$），导致较低的 $P$（$\\approx 0.55$）和高 $R$（$0.8$）。$P$ 和 $R$ 之间的这种权衡导致了 $F_1$ 分数的差异，作为调和平均数，$F_1$ 对这种不平衡很敏感。该解释在结构上和事实上都是正确的。\n\n选项A的结论：**正确**。\n\n**选项B的分析**\n\n系统 $X$：$(TP, FP, TN, FN) = (50, 50, 850, 50)$\n系统 $Y$：$(TP, FP, TN, FN) = (45, 45, 855, 55)$\n- $\\text{Acc}_X = \\frac{50 + 850}{1000} = 0.9$。\n- $\\text{Acc}_Y = \\frac{45 + 855}{1000} = 0.9$。\n准确率相等。\n- $F_{1,X} = \\frac{2 \\cdot 50}{2 \\cdot 50 + 50 + 50} = \\frac{100}{200} = 0.5$。\n- $F_{1,Y} = \\frac{2 \\cdot 45}{2 \\cdot 45 + 45 + 55} = \\frac{90}{90 + 100} = \\frac{90}{190} = \\frac{9}{19} \\approx 0.4737$。\n- $|F_{1,X} - F_{1,Y}| = |0.5 - 0.4737| \\approx 0.0263$。这个值不 $\\geq 0.30$。\n- **解释**：解释声称“因为两者的 $ \\text{Acc} $ 相同，所以它们的 $F_1$ 分数必然相等；$F_1$ 完全由 $ \\text{Acc} $ 决定。” 这个陈述是根本错误的。准确率和 $F_1$ 分数是不同的指标，它们之间没有确定性的联系。我们对选项A的分析已经提供了一个反例。\n\n选项B的结论：**错误**。\n\n**选项C的分析**\n\n系统 $X$：$(TP, FP, TN, FN) = (10, 10, 980, 0)$\n系统 $Y$：$(TP, FP, TN, FN) = (10, 0, 970, 20)$\n- $\\text{Acc}_X = \\frac{10 + 980}{1000} = 0.99$。\n- $\\text{Acc}_Y = \\frac{10 + 970}{1000} = 0.98$。\n- 准确率不相等（$\\text{Acc}_X \\neq \\text{Acc}_Y$）。问题的第一个条件未满足。\n- **解释**：该解释包含两个错误的陈述。首先，它错误地声称准确率相等。其次，它声称“$TN$ 直接驱动 $F_1$”。$F_1$ 的公式是 $F_1 = \\frac{2 \\cdot TP}{2 \\cdot TP + FP + FN}$，其中不包含 $TN$ 项。因此，$TN$ 对 $F_1$ 分数没有直接影响。\n\n选项C的结论：**错误**。\n\n**选项D的分析**\n\n系统 $X$：$(TP, FP, TN, FN) = (90, 10, 890, 10)$\n系统 $Y$：$(TP, FP, TN, FN) = (80, 0, 900, 20)$\n- $\\text{Acc}_X = \\frac{90 + 890}{1000} = 0.98$。\n- $\\text{Acc}_Y = \\frac{80 + 900}{1000} = 0.98$。\n准确率相等。\n- $F_{1,X} = \\frac{2 \\cdot 90}{2 \\cdot 90 + 10 + 10} = \\frac{180}{200} = 0.9$。\n- $F_{1,Y} = \\frac{2 \\cdot 80}{2 \\cdot 80 + 0 + 20} = \\frac{160}{180} = \\frac{8}{9} \\approx 0.8889$。\n- $|F_{1,X} - F_{1,Y}| = |0.9 - 0.8889| \\approx 0.0111$。这个值不 $\\geq 0.30$。\n- **解释**：解释声称 $F_1$ 的差异“主要是由改变 $TN$ 引起的，因为 $TN$ 出现在 $P$ 和 $R$ 的分母中”。这在事实上是错误的。$P$ 和 $R$ 的公式是 $P = \\frac{TP}{TP + FP}$ 和 $R = \\frac{TP}{TP + FN}$。$TN$ 项既没有出现在这两个公式中，也没有出现在 $F_1$ 的公式中。\n\n选项D的结论：**错误**。\n\n根据详细分析，只有选项A满足所有陈述的数值和解释要求。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "在评估模型时，选择正确的度量标准与模型本身同样重要，这取决于您的最终目标。本练习  深入探讨了在类别不平衡场景下，整体准确率（Overall Accuracy）和平衡准确率（Balanced Accuracy）之间的权衡。通过一个具体的案例，您将看到一个平衡准确率更高的分类器可能其整体准确率反而更低，这促使我们思考：我们是想最小化总的错误数量，还是确保模型在少数类别上同样表现出色？",
            "id": "3181064",
            "problem": "考虑一个二元分类任务，其数据集大小为 $N = 1000$，高度不平衡，包含 $100$ 个正例和 $900$ 个负例。在该数据集上评估了两个分类器，分别表示为 $\\mathcal{A}$ 和 $\\mathcal{B}$，它们产生以下混淆矩阵（条目为样本计数）：对于 $\\mathcal{A}$，$\\mathrm{TP} = 20$，$\\mathrm{FN} = 80$，$\\mathrm{TN} = 891$，$\\mathrm{FP} = 9$；对于 $\\mathcal{B}$，$\\mathrm{TP} = 80$，$\\mathrm{FN} = 20$，$\\mathrm{TN} = 810$，$\\mathrm{FP} = 90$。仅使用混淆矩阵各项数量的核心定义以及从中派生的标准比率，从第一性原理出发，推断每个分类器优化了哪个指标，并判断选择一个优化了按类别平均的度量的分类器是否会降低按流行度加权的总体准确率。然后，基于该推理，从以下选项中选择所有正确的陈述。不要假设任何未陈述的公式；将您的答案基于混淆矩阵所隐含的计数和比率的定义。\n\nA. 分类器 $\\mathcal{A}$ 的总体准确率高于分类器 $\\mathcal{B}$，但平衡准确率低于分类器 $\\mathcal{B}$；这种模式在不平衡数据中可能出现，因为按类别平均同等对待少数类和多数类。\n\nB. 分类器 $\\mathcal{B}$ 的总体准确率和平衡准确率都高于分类器 $\\mathcal{A}$；优化按类别平均的度量会降低总体准确率的现象不可能发生。\n\nC. 当类别先验概率高度不平衡且少数类和多数类中的错误被认为同等重要时，或者当少数类的召回率是主要目标时，优化平衡准确率是可取的，因为按类别平均可以抵消流行度主导的影响。\n\nD. 当目标是在每个样本的错分成本相等的情况下最小化错误总数时，优化平衡准确率是不可取的，因为总体准确率已经按流行度对类别进行了加权。\n\nE. 如果两个分类器具有相同的平衡准确率，那么无论类别是否不平衡，它们也必须具有相同的总体准确率。",
            "solution": "首先对问题陈述进行严格的验证过程。\n\n### 步骤 1：提取已知条件\n- 数据集总大小：$N = 1000$\n- 正例数量：$P = 100$\n- 负例数量：$N_{neg} = 900$（为避免与总大小 $N$ 混淆，我们用 $N_{neg}$ 表示）\n- 分类器 $\\mathcal{A}$ 的混淆矩阵计数：$\\mathrm{TP}_{\\mathcal{A}} = 20$, $\\mathrm{FN}_{\\mathcal{A}} = 80$, $\\mathrm{TN}_{\\mathcal{A}} = 891$, $\\mathrm{FP}_{\\mathcal{A}} = 9$\n- 分类器 $\\mathcal{B}$ 的混淆矩阵计数：$\\mathrm{TP}_{\\mathcal{B}} = 80$, $\\mathrm{FN}_{\\mathcal{B}} = 20$, $\\mathrm{TN}_{\\mathcal{B}} = 810$, $\\mathrm{FP}_{\\mathcal{B}} = 90$\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题位于统计学习中二元分类评估的标准框架内。我们必须验证所提供数据的内部一致性。\n\n1.  **正类计数的一致性：** 正例的总数 $P$ 必须等于真正例和假负例的总和 ($\\mathrm{TP} + \\mathrm{FN}$)。\n    - 对于分类器 $\\mathcal{A}$：$\\mathrm{TP}_{\\mathcal{A}} + \\mathrm{FN}_{\\mathcal{A}} = 20 + 80 = 100$。这与给定的 $P = 100$ 相符。\n    - 对于分类器 $\\mathcal{B}$：$\\mathrm{TP}_{\\mathcal{B}} + \\mathrm{FN}_{\\mathcal{B}} = 80 + 20 = 100$。这也与给定的 $P = 100$ 相符。\n\n2.  **负类计数的一致性：** 负例的总数 $N_{neg}$ 必须等于真负例和假正例的总和 ($\\mathrm{TN} + \\mathrm{FP}$)。\n    - 对于分类器 $\\mathcal{A}$：$\\mathrm{TN}_{\\mathcal{A}} + \\mathrm{FP}_{\\mathcal{A}} = 891 + 9 = 900$。这与给定的 $N_{neg} = 900$ 相符。\n    - 对于分类器 $\\mathcal{B}$：$\\mathrm{TN}_{\\mathcal{B}} + \\mathrm{FP}_{\\mathcal{B}} = 810 + 90 = 900$。这也与给定的 $N_{neg} = 900$ 相符。\n\n3.  **数据集总大小的一致性：** 数据集总大小 $N$ 必须等于所有混淆矩阵条目的总和。\n    - 对于分类器 $\\mathcal{A}$：$\\mathrm{TP}_{\\mathcal{A}} + \\mathrm{FN}_{\\mathcal{A}} + \\mathrm{TN}_{\\mathcal{A}} + \\mathrm{FP}_{\\mathcal{A}} = 20 + 80 + 891 + 9 = 1000$。这与给定的 $N=1000$ 相符。\n    - 对于分类器 $\\mathcal{B}$：$\\mathrm{TP}_{\\mathcal{B}} + \\mathrm{FN}_{\\mathcal{B}} + \\mathrm{TN}_{\\mathcal{B}} + \\mathrm{FP}_{\\mathcal{B}} = 80 + 20 + 810 + 90 = 1000$。这也与给定的 $N=1000$ 相符。\n\n该问题在既定的统计理论中有科学依据，问题设定良好，提供了所有必要信息，并且内部一致。不平衡数据集的场景是现实的，在实践中很常见。语言客观而精确。\n\n### 步骤 3：结论和行动\n问题陈述是**有效的**。我们继续进行求解。\n\n### 推导与选项分析\n\n我们将从第一性原理出发，为两个分类器推导相关指标。核心指标是真正例率 (TPR)、真负例率 (TNR)、总体准确率 (ACC) 和平衡准确率 (BA)。设 $P$ 为正例数量，$N_{neg}$ 为负例数量。\n\n- **真正例率 (TPR)** 或 **召回率 (Recall)**：$\\mathrm{TPR} = \\frac{\\mathrm{TP}}{P} = \\frac{\\mathrm{TP}}{\\mathrm{TP} + \\mathrm{FN}}$\n- **真负例率 (TNR)** 或 **特异度 (Specificity)**：$\\mathrm{TNR} = \\frac{\\mathrm{TN}}{N_{neg}} = \\frac{\\mathrm{TN}}{\\mathrm{TN} + \\mathrm{FP}}$\n- **总体准确率 (ACC)**：$\\mathrm{ACC} = \\frac{\\mathrm{TP} + \\mathrm{TN}}{P + N_{neg}}$\n- **平衡准确率 (BA)**：$\\mathrm{BA} = \\frac{\\mathrm{TPR} + \\mathrm{TNR}}{2}$\n\n给定数据集有 $P=100$ 和 $N_{neg}=900$。\n\n**分类器 $\\mathcal{A}$ 的计算：**\n- $\\mathrm{TPR}_{\\mathcal{A}} = \\frac{\\mathrm{TP}_{\\mathcal{A}}}{P} = \\frac{20}{100} = 0.2$\n- $\\mathrm{TNR}_{\\mathcal{A}} = \\frac{\\mathrm{TN}_{\\mathcal{A}}}{N_{neg}} = \\frac{891}{900} = 0.99$\n- $\\mathrm{ACC}_{\\mathcal{A}} = \\frac{\\mathrm{TP}_{\\mathcal{A}} + \\mathrm{TN}_{\\mathcal{A}}}{P + N_{neg}} = \\frac{20 + 891}{1000} = \\frac{911}{1000} = 0.911$\n- $\\mathrm{BA}_{\\mathcal{A}} = \\frac{\\mathrm{TPR}_{\\mathcal{A}} + \\mathrm{TNR}_{\\mathcal{A}}}{2} = \\frac{0.2 + 0.99}{2} = \\frac{1.19}{2} = 0.595$\n\n**分类器 $\\mathcal{B}$ 的计算：**\n- $\\mathrm{TPR}_{\\mathcal{B}} = \\frac{\\mathrm{TP}_{\\mathcal{B}}}{P} = \\frac{80}{100} = 0.8$\n- $\\mathrm{TNR}_{\\mathcal{B}} = \\frac{\\mathrm{TN}_{\\mathcal{B}}}{N_{neg}} = \\frac{810}{900} = 0.90$\n- $\\mathrm{ACC}_{\\mathcal{B}} = \\frac{\\mathrm{TP}_{\\mathcal{B}} + \\mathrm{TN}_{\\mathcal{B}}}{P + N_{neg}} = \\frac{80 + 810}{1000} = \\frac{890}{1000} = 0.890$\n- $\\mathrm{BA}_{\\mathcal{B}} = \\frac{\\mathrm{TPR}_{\\mathcal{B}} + \\mathrm{TNR}_{\\mathcal{B}}}{2} = \\frac{0.8 + 0.9}{2} = \\frac{1.7}{2} = 0.85$\n\n**比较：**\n- 总体准确率：$\\mathrm{ACC}_{\\mathcal{A}} (0.911) > \\mathrm{ACC}_{\\mathcal{B}} (0.890)$\n- 平衡准确率：$\\mathrm{BA}_{\\mathcal{A}} (0.595)  \\mathrm{BA}_{\\mathcal{B}} (0.85)$\n\n分类器 $\\mathcal{A}$ 偏向于在多数（负）类上的性能，以极低的 $\\mathrm{TPR}_{\\mathcal{A}}$（0.2）为代价，实现了非常高的 $\\mathrm{TNR}_{\\mathcal{A}}$（0.99）。由于负类的高流行度（$90\\%$），该策略最大化了总体准确率。分类器 $\\mathcal{B}$ 在各个类别上的性能更为均衡，实现了较高的 $\\mathrm{TPR}_{\\mathcal{B}}$（$0.8$）和 $\\mathrm{TNR}_{\\mathcal{B}}$（$0.9$），从而获得了更高的平衡准确率，但总体准确率略低。\n\n现在，我们来评估每个选项。\n\n**A. 分类器 $\\mathcal{A}$ 的总体准确率高于分类器 $\\mathcal{B}$，但平衡准确率低于分类器 $\\mathcal{B}$；这种模式在不平衡数据中可能出现，因为按类别平均同等对待少数类和多数类。**\n- 第一句话，‘分类器 $\\mathcal{A}$ 的总体准确率高于分类器 $\\mathcal{B}$，但平衡准确率低于分类器 $\\mathcal{B}$’，已由我们的计算证实（ACC 为 $0.911 > 0.890$，BA 为 $0.595  0.85$）。\n- 所提供的理由是‘按类别平均同等对待少数类和多数类’。平衡准确率是各类别准确率（TPR 和 TNR）的算术平均值，给每个类别的权重为 $1/2$。总体准确率可以表示为加权平均值：$\\mathrm{ACC} = \\pi_P \\cdot \\mathrm{TPR} + \\pi_{N_{neg}} \\cdot \\mathrm{TNR}$，其中 $\\pi_P = P/(P+N_{neg}) = 0.1$ 和 $\\pi_{N_{neg}} = N_{neg}/(P+N_{neg}) = 0.9$ 是类别流行度。负类的高流行度 $\\pi_{N_{neg}}=0.9$ 意味着总体准确率主要由 TNR 主导。平衡准确率的均等加权抵消了这一点。该陈述完全正确。\n- 结论：**正确**。\n\n**B. 分类器 $\\mathcal{B}$ 的总体准确率和平衡准确率都高于分类器 $\\mathcal{A}$；优化按类别平均的度量会降低总体准确率的现象不可能发生。**\n- 第一句话，‘分类器 $\\mathcal{B}$ 的总体准确率更高’是错误的，因为 $\\mathrm{ACC}_{\\mathcal{B}} = 0.890  \\mathrm{ACC}_{\\mathcal{A}} = 0.911$。\n- 第二句话，‘优化按类别平均的度量会降低总体准确率的现象不可能发生’也是错误的。这个问题本身就提供了一个反例：分类器 $\\mathcal{B}$ 的平衡准确率显著高于分类器 $\\mathcal{A}$，但总体准确率却更低。选择 $\\mathcal{B}$ 而不是 $\\mathcal{A}$（即优化 BA）会降低 ACC。\n- 结论：**错误**。\n\n**C. 当类别先验概率高度不平衡且少数类和多数类中的错误被认为同等重要时，或者当少数类的召回率是主要目标时，优化平衡准确率是可取的，因为按类别平均可以抵消流行度主导的影响。**\n- 这是一个关于平衡准确率效用的概念性陈述。当类别先验概率不平衡时，模型可以通过简单地预测多数类来获得高总体准确率。如果两类中的错误‘同等重要’，那么一个按流行度加权类别性能的指标（如总体准确率）就不合适。平衡准确率给予每个类的性能相同的权重，满足了这一需求。此外，为了获得高平衡准确率，分类器不能有非常低的 TPR（少数类召回率），这使得在少数类召回率很重要时，它成为一个合适的目标。这种行为的原因被正确地认定为‘按类别平均抵消了流行度主导’。该陈述清晰而准确地描述了使用平衡准确率的动机。\n- 结论：**正确**。\n\n**D. 当目标是在每个样本的错分成本相等的情况下最小化错误总数时，优化平衡准确率是不可取的，因为总体准确率已经按流行度对类别进行了加权。**\n- ‘最小化错误总数’的目标在数学上等同于最小化总和 $\\mathrm{FN} + \\mathrm{FP}$。总体准确率定义为 $\\mathrm{ACC} = 1 - \\frac{\\mathrm{FN} + \\mathrm{FP}}{N_{total}}$。因此，最大化总体准确率等同于最小化错误总数。\n- 我们的例子显示，分类器 $\\mathcal{A}$ 有更高的 ACC（$0.911$）和更少的总错误数（$\\mathrm{FN}_{\\mathcal{A}} + \\mathrm{FP}_{\\mathcal{A}} = 80+9=89$）。分类器 $\\mathcal{B}$ 有更高的 BA（$0.85$）但有更多的总错误数（$\\mathrm{FN}_{\\mathcal{B}} + \\mathrm{FP}_{\\mathcal{B}} = 20+90=110$）。如果目标是最小化总错误数，那么应该选择 $\\mathcal{A}$，即具有更高 ACC 而非更高 BA 的分类器。因此，优化 BA 将是错误的策略。所提供的理由也是正确的：总体准确率实现了这一目标，因为它平等地加权每个实例，这意味着类别是按流行度加权的。\n- 结论：**正确**。\n\n**E. 如果两个分类器具有相同的平衡准确率，那么无论类别是否不平衡，它们也必须具有相同的总体准确率。**\n- 这个陈述可以通过一个反例来证明是错误的。设 $\\mathrm{BA}_{\\mathcal{C}} = \\mathrm{BA}_{\\mathcal{D}}$。这意味着 $\\frac{1}{2}(\\mathrm{TPR}_{\\mathcal{C}} + \\mathrm{TNR}_{\\mathcal{C}}) = \\frac{1}{2}(\\mathrm{TPR}_{\\mathcal{D}} + \\mathrm{TNR}_{\\mathcal{D}})$。\n- 总体准确率为 $\\mathrm{ACC} = \\pi_P \\mathrm{TPR} + \\pi_{N_{neg}} \\mathrm{TNR}$。\n- 假设我们的不平衡数据集具有 $\\pi_P = 0.1$ 和 $\\pi_{N_{neg}} = 0.9$。\n- 假设分类器 $\\mathcal{C}$ 的 $\\mathrm{TPR}_{\\mathcal{C}} = 0.9$ 和 $\\mathrm{TNR}_{\\mathcal{C}} = 0.7$。那么 $\\mathrm{BA}_{\\mathcal{C}} = (0.9+0.7)/2 = 0.8$。其准确率为 $\\mathrm{ACC}_{\\mathcal{C}} = (0.1)(0.9) + (0.9)(0.7) = 0.09 + 0.63 = 0.72$。\n- 假设分类器 $\\mathcal{D}$ 的 $\\mathrm{TPR}_{\\mathcal{D}} = 0.7$ 和 $\\mathrm{TNR}_{\\mathcal{D}} = 0.9$。那么 $\\mathrm{BA}_{\\mathcal{D}} = (0.7+0.9)/2 = 0.8$。其准确率为 $\\mathrm{ACC}_{\\mathcal{D}} = (0.1)(0.7) + (0.9)(0.9) = 0.07 + 0.81 = 0.88$。\n- 在这里，$\\mathrm{BA}_{\\mathcal{C}} = \\mathrm{BA}_{\\mathcal{D}}$，但 $\\mathrm{ACC}_{\\mathcal{C}} \\neq \\mathrm{ACC}_{\\mathcal{D}}$。该陈述是错误的。它仅在平衡数据集的特殊情况下才成立，即 $\\pi_P = \\pi_{N_{neg}} = 0.5$，此时 $\\mathrm{ACC} = 0.5(\\mathrm{TPR}+\\mathrm{TNR}) = \\mathrm{BA}$。‘无论类别是否不平衡’这一短语使该陈述确定无疑是错误的。\n- 结论：**错误**。",
            "answer": "$$\\boxed{ACD}$$"
        }
    ]
}