{
    "hands_on_practices": [
        {
            "introduction": "第一个练习将抽象的系数 $\\beta_1$ 与一个具体的结果——“优势翻倍”联系起来。这是将模型呈线性的对数优势（log-odds）尺度，转换为效应呈乘性的、更直观的优势（odds）尺度的第一步。这个练习将帮助你计算，为了使优势发生特定的倍数变化，预测变量需要改变多少。",
            "id": "3133350",
            "problem": "一个数据录入专员的培训项目研究了模拟器练习时间对学员首次尝试通过认证考试概率的影响。设 $Y \\in \\{0,1\\}$ 表示学员是否通过（$Y=1$）或未通过（$Y=0$），并设 $x$ 表示考试前完成的模拟器练习小时数。使用历史数据拟合了一个使用 `logit` 连接的逻辑回归模型，得出 $x$ 的斜率系数为 $\\beta_1 = 0.27$（解释为在保持所有其他协变量固定的情况下，练习时间每增加一小时，对数优势比的变化量）。从优势比（对于概率 $p$ 定义为 $p/(1-p)$）和逻辑回归中对数优势比（logit）连接的定义出发，确定对于一个当前练习 $x$ 小时且其他条件相同的学员，需要增加多少练习时间 $\\Delta x$ 才能使通过考试的优势比翻倍。最终答案以小时为单位表示。将答案四舍五入至 $4$ 位有效数字。",
            "solution": "问题要求计算能使通过认证考试的优势比翻倍所需增加的练习时间，记为 $\\Delta x$。练习时间与通过概率之间的关系使用逻辑回归进行建模。\n\n首先，我们必须根据题目给出的信息，正式定义逻辑回归模型的各个组成部分。对于一组给定的预测变量，通过的概率记为 $p$。通过的优势比定义为通过的概率与未通过的概率之比：\n$$ \\text{odds} = \\frac{p}{1-p} $$\n逻辑回归模型将优势比的自然对数（对数优势比或logit）与预测变量的线性组合关联起来。设 $x$ 为模拟器练习的小时数，其他协变量由 $x_2, x_3, \\dots, x_k$ 表示。模型方程为：\n$$ \\ln\\left(\\frac{p}{1-p}\\right) = \\beta_0 + \\beta_1 x + \\sum_{j=2}^{k} \\beta_j x_j $$\n此处，$\\beta_1$ 是练习时间 $x$ 的系数，其给定值为 $\\beta_1 = 0.27$。$\\beta_1$ 的解释是，在保持所有其他变量不变的情况下，$x$ 每增加一个单位，通过的对数优势比增加 $\\beta_1$。\n\n让我们考虑一个其他条件相同的学员的两种情况。“其他条件相同”意味着所有其他协变量（$x_2, \\dots, x_k$）保持不变。\n\n情况1：学员练习 $x$ 小时。通过的对数优势比由下式给出：\n$$ \\ln(\\text{odds}_1) = \\beta_0 + \\beta_1 x + \\sum_{j=2}^{k} \\beta_j x_j $$\n\n情况2：学员练习增加到 $x + \\Delta x$ 小时。此时通过的对数优势比为：\n$$ \\ln(\\text{odds}_2) = \\beta_0 + \\beta_1 (x + \\Delta x) + \\sum_{j=2}^{k} \\beta_j x_j $$\n\n我们关心的是这两种情况下对数优势比的变化。用情况2的方程减去情况1的方程，我们可以分离出额外练习时间 $\\Delta x$ 的影响：\n$$ \\ln(\\text{odds}_2) - \\ln(\\text{odds}_1) = \\left(\\beta_0 + \\beta_1 (x + \\Delta x) + \\sum_{j=2}^{k} \\beta_j x_j\\right) - \\left(\\beta_0 + \\beta_1 x + \\sum_{j=2}^{k} \\beta_j x_j\\right) $$\n截距 $\\beta_0$、初始练习时间的项 $\\beta_1 x$ 以及代表其他协变量的总和项都被消去，剩下：\n$$ \\ln(\\text{odds}_2) - \\ln(\\text{odds}_1) = \\beta_1 (x + \\Delta x) - \\beta_1 x = \\beta_1 \\Delta x $$\n使用对数性质 $\\ln(a) - \\ln(b) = \\ln(a/b)$，我们可以将方程的左边重写为：\n$$ \\ln\\left(\\frac{\\text{odds}_2}{\\text{odds}_1}\\right) = \\beta_1 \\Delta x $$\n这个方程表明，优势比率的对数与预测变量的变化量 $\\Delta x$ 成正比，比例常数为系数 $\\beta_1$。\n\n问题要求我们找到使优势比翻倍的特定 $\\Delta x$。这个条件表示为：\n$$ \\text{odds}_2 = 2 \\times \\text{odds}_1 $$\n这意味着优势比的比率为：\n$$ \\frac{\\text{odds}_2}{\\text{odds}_1} = 2 $$\n将这个值代入我们导出的方程：\n$$ \\ln(2) = \\beta_1 \\Delta x $$\n现在我们可以解出 $\\Delta x$：\n$$ \\Delta x = \\frac{\\ln(2)}{\\beta_1} $$\n题目给出的斜率系数值为 $\\beta_1 = 0.27$。将这个值代入 $\\Delta x$ 的方程：\n$$ \\Delta x = \\frac{\\ln(2)}{0.27} $$\n使用 $2$ 的自然对数值 $\\ln(2) \\approx 0.69314718$：\n$$ \\Delta x \\approx \\frac{0.69314718}{0.27} \\approx 2.56721178 \\text{ 小时} $$\n问题要求将答案四舍五入到 $4$ 位有效数字。将计算出的值四舍五入得到：\n$$ \\Delta x \\approx 2.567 \\text{ 小时} $$\n因此，在保持所有其他因素不变的情况下，需要增加大约 $2.567$ 小时的模拟器练习时间，才能使学员通过认证考试的优势比翻倍。",
            "answer": "$$\\boxed{2.567}$$"
        },
        {
            "introduction": "一个常见的误解是认为恒定的系数意味着对概率的效应也是恒定的。这个练习将揭示为何这种想法是错误的。通过将相同的对数优势（log-odds）增量应用于不同的基线概率，你将亲眼看到逻辑函数的S形曲线如何决定了概率的绝对变化是依赖于初始值的。",
            "id": "3133329",
            "problem": "一个二元结果通过逻辑回归进行建模，其中，预测变量每增加一个单位，事件的对数几率（logit）就会增加一个恒定的增量 $\\delta$。考虑两个具有不同基线事件概率的群体：一个是基线概率为 $p_{L}=\\frac{1}{10}$ 的低风险组，另一个是基线概率为 $p_{H}=\\frac{4}{5}$ 的高风险组。假设预测变量增加一个单位，相应的对数几率增量为 $\\delta=\\ln(2)$。仅以几率 $o=\\frac{p}{1-p}$ 和 `logit` 函数 $\\text{logit}(p)=\\ln\\!\\left(\\frac{p}{1-p}\\right)$ 的定义为出发点，推导出增量后的概率 $p'$ 作为基线概率 $p$ 和 $\\delta$ 的函数，然后计算概率变化量 $p_{L}'-p_{L}$ 和 $p_{H}'-p_{H}$。将数值 $\\Delta=(p'_{H}-p_{H})-(p'_{L}-p_{L})$ 作为精确值报告。不要对答案进行四舍五入。",
            "solution": "第一步是推导增量后的概率（我们记为 $p'$）的表达式，它是一个关于基线概率 $p$ 和对数几率增量 $\\delta$ 的函数。基线概率 $p$ 的对数几率（或 logit）定义为：\n$$\n\\text{logit}(p) = \\ln\\left(\\frac{p}{1-p}\\right)\n$$\n预测变量增加一个单位，导致对数几率增加一个恒定量 $\\delta$。因此，新的对数几率 $\\text{logit}(p')$ 为：\n$$\n\\text{logit}(p') = \\text{logit}(p) + \\delta = \\ln\\left(\\frac{p}{1-p}\\right) + \\delta\n$$\n为了求出新的概率 $p'$，我们首先需要求出新的几率 $o'$。几率是通过对对数几率取指数得到的：\n$$\no' = \\exp(\\text{logit}(p')) = \\exp\\left(\\ln\\left(\\frac{p}{1-p}\\right) + \\delta\\right)\n$$\n利用指数的性质 $\\exp(a+b) = \\exp(a)\\exp(b)$，我们可以将各项分开：\n$$\no' = \\exp\\left(\\ln\\left(\\frac{p}{1-p}\\right)\\right) \\cdot \\exp(\\delta) = \\left(\\frac{p}{1-p}\\right) \\exp(\\delta)\n$$\n概率和几率之间的关系是 $p = \\frac{o}{1+o}$。因此，新的概率 $p'$ 可以用新的几率 $o'$ 表示为：\n$$\np' = \\frac{o'}{1+o'}\n$$\n代入 $o'$ 的表达式：\n$$\np' = \\frac{\\left(\\frac{p}{1-p}\\right) \\exp(\\delta)}{1 + \\left(\\frac{p}{1-p}\\right) \\exp(\\delta)}\n$$\n为了简化这个表达式，我们将分子和分母同时乘以 $(1-p)$：\n$$\np' = \\frac{p \\exp(\\delta)}{(1-p) + p \\exp(\\delta)}\n$$\n这就是所求的增量后概率 $p'$ 作为 $p$ 和 $\\delta$ 的函数的通用公式。\n\n接下来，我们代入给定的对数几率增量值 $\\delta = \\ln(2)$。这意味着 $\\exp(\\delta) = \\exp(\\ln(2)) = 2$。$p'$ 的公式简化为：\n$$\np' = \\frac{2p}{1+p}\n$$\n现在，我们将此公式应用于两个指定的群体。\n\n对于低风险组，基线概率为 $p_{L} = \\frac{1}{10}$。增量后的概率 $p_{L}'$ 为：\n$$\np_{L}' = \\frac{2 p_{L}}{1+p_{L}} = \\frac{2\\left(\\frac{1}{10}\\right)}{1+\\frac{1}{10}} = \\frac{\\frac{2}{10}}{\\frac{11}{10}} = \\frac{2}{11}\n$$\n低风险组的概率变化量为：\n$$\np_{L}' - p_{L} = \\frac{2}{11} - \\frac{1}{10} = \\frac{2 \\cdot 10 - 1 \\cdot 11}{110} = \\frac{20-11}{110} = \\frac{9}{110}\n$$\n\n对于高风险组，基线概率为 $p_{H} = \\frac{4}{5}$。增量后的概率 $p_{H}'$ 为：\n$$\np_{H}' = \\frac{2 p_{H}}{1+p_{H}} = \\frac{2\\left(\\frac{4}{5}\\right)}{1+\\frac{4}{5}} = \\frac{\\frac{8}{5}}{\\frac{9}{5}} = \\frac{8}{9}\n$$\n高风险组的概率变化量为：\n$$\np_{H}' - p_{H} = \\frac{8}{9} - \\frac{4}{5} = \\frac{8 \\cdot 5 - 4 \\cdot 9}{45} = \\frac{40-36}{45} = \\frac{4}{45}\n$$\n\n最后，我们计算量 $\\Delta$，即这两个概率变化量之差：\n$$\n\\Delta = (p_{H}' - p_{H}) - (p_{L}' - p_{L}) = \\frac{4}{45} - \\frac{9}{110}\n$$\n为了对这两个分数进行减法运算，我们找到一个公分母。$45$ 和 $110$ 的最小公倍数是 $990$。\n$45 = 5 \\times 9$\n$110 = 10 \\times 11 = 2 \\times 5 \\times 11$\n$\\text{lcm}(45, 110) = 2 \\times 5 \\times 9 \\times 11 = 990$。\n我们用公分母重写这些分数：\n$$\n\\Delta = \\frac{4 \\cdot (990/45)}{990} - \\frac{9 \\cdot (990/110)}{990} = \\frac{4 \\cdot 22}{990} - \\frac{9 \\cdot 9}{990} = \\frac{88}{990} - \\frac{81}{990}\n$$\n$$\n\\Delta = \\frac{88 - 81}{990} = \\frac{7}{990}\n$$\n这个结果表明，对数几率的恒定增量对应于概率的非恒定增量，且概率变化的幅度取决于基线概率。",
            "answer": "$$\\boxed{\\frac{7}{990}}$$"
        },
        {
            "introduction": "在现实世界中，我们很少使用只含单个预测变量的模型。最后的这个练习将我们带入一个真实的多变量场景，展示如何综合多个预测变量的效应来比较两个不同个体的风险状况。你将计算一个个体相对于另一个个体的优势比（odds ratio），这是风险分层中的一项核心任务。",
            "id": "3133360",
            "problem": "一家医院使用逻辑回归模型来估计一名患者在 $10$ 年内发生重大心血管事件的概率 $p(\\mathbf{x})$。该模型使用 `logit` 连接，因此 $\\ln\\!\\big(\\frac{p(\\mathbf{x})}{1-p(\\mathbf{x})}\\big)$ 是特征的线性函数。具体来说，对于具有特征 $\\mathbf{x}=(x_{\\mathrm{age}},x_{\\mathrm{LDL}},x_{\\mathrm{smoke}})$ 的患者，模型为\n$\\ln\\!\\big(\\frac{p(\\mathbf{x})}{1-p(\\mathbf{x})}\\big)=\\beta_{0}+\\beta_{\\mathrm{age}}\\,x_{\\mathrm{age}}+\\beta_{\\mathrm{LDL}}\\,x_{\\mathrm{LDL}}+\\beta_{\\mathrm{smoke}}\\,x_{\\mathrm{smoke}}$，\n其中 $x_{\\mathrm{age}}=(\\text{年龄（岁）}-40)/10$，$x_{\\mathrm{LDL}}=(\\text{低密度脂蛋白胆固醇（mmol/L）}-3)$，如果患者是当前吸烟者，则 $x_{\\mathrm{smoke}}$ 等于 $1$，否则等于 $0$。估计的系数为 $\\beta_{0}=-3.2$，$\\beta_{\\mathrm{age}}=0.55$，$\\beta_{\\mathrm{LDL}}=0.25$ 和 $\\beta_{\\mathrm{smoke}}=1.10$。\n\n考虑两位具有以下特征值的患者：\n- 患者A：年龄 $62$ 岁，LDL $4.2$ mmol/L，当前吸烟者 ($x_{\\mathrm{smoke}}=1$)。\n- 患者B：年龄 $54$ 岁，LDL $2.8$ mmol/L，非当前吸烟者 ($x_{\\mathrm{smoke}}=0$)。\n\n仅使用 `logit` 连接和优势的定义，首先根据模型系数和特征差异推导出对数优势差 $\\ln\\!\\big(\\frac{p(\\mathbf{x}_A)}{1-p(\\mathbf{x}_A)}\\big)-\\ln\\!\\big(\\frac{p(\\mathbf{x}_B)}{1-p(\\mathbf{x}_B)}\\big)$ 的表达式。然后计算患者 A 相对于患者 B 的优势比，定义为 $\\frac{p(\\mathbf{x}_A)/(1-p(\\mathbf{x}_A))}{p(\\mathbf{x}_B)/(1-p(\\mathbf{x}_B))}$。将优势比报告为单个实数，四舍五入到四位有效数字。这个优势比是医院用于两两风险分层的量。",
            "solution": "设具有特征 $\\mathbf{x}$ 的患者的对数优势为 $L(\\mathbf{x}) = \\ln\\!\\big(\\frac{p(\\mathbf{x})}{1-p(\\mathbf{x})}\\big)$。\n模型由下式给出：\n$L(\\mathbf{x}) = \\beta_{0}+\\beta_{\\mathrm{age}}\\,x_{\\mathrm{age}}+\\beta_{\\mathrm{LDL}}\\,x_{\\mathrm{LDL}}+\\beta_{\\mathrm{smoke}}\\,x_{\\mathrm{smoke}}$\n其中系数为 $\\beta_{0}=-3.2$，$\\beta_{\\mathrm{age}}=0.55$，$\\beta_{\\mathrm{LDL}}=0.25$ 和 $\\beta_{\\mathrm{smoke}}=1.10$。\n\n患者 A 和患者 B 的特征计算如下：\n对于患者 A（年龄 $62$ 岁，LDL $4.2$，吸烟者）：\n$x_{\\mathrm{age},A} = (62-40)/10 = 2.2$\n$x_{\\mathrm{LDL},A} = 4.2 - 3 = 1.2$\n$x_{\\mathrm{smoke},A} = 1$\n因此，$\\mathbf{x}_A = (2.2, 1.2, 1)$。\n\n对于患者 B（年龄 $54$ 岁，LDL $2.8$，非吸烟者）：\n$x_{\\mathrm{age},B} = (54-40)/10 = 1.4$\n$x_{\\mathrm{LDL},B} = 2.8 - 3 = -0.2$\n$x_{\\mathrm{smoke},B} = 0$\n因此，$\\mathbf{x}_B = (1.4, -0.2, 0)$。\n\n患者 A 和患者 B 的对数优势为：\n$L(\\mathbf{x}_A) = \\beta_0 + \\beta_{\\mathrm{age}}\\,x_{\\mathrm{age},A} + \\beta_{\\mathrm{LDL}}\\,x_{\\mathrm{LDL},A} + \\beta_{\\mathrm{smoke}}\\,x_{\\mathrm{smoke},A}$\n$L(\\mathbf{x}_B) = \\beta_0 + \\beta_{\\mathrm{age}}\\,x_{\\mathrm{age},B} + \\beta_{\\mathrm{LDL}}\\,x_{\\mathrm{LDL},B} + \\beta_{\\mathrm{smoke}}\\,x_{\\mathrm{smoke},B}$\n\n对数优势的差为：\n$L(\\mathbf{x}_A) - L(\\mathbf{x}_B) = (\\beta_0 + \\beta_{\\mathrm{age}}\\,x_{\\mathrm{age},A} + \\beta_{\\mathrm{LDL}}\\,x_{\\mathrm{LDL},A} + \\beta_{\\mathrm{smoke}}\\,x_{\\mathrm{smoke},A}) - (\\beta_0 + \\beta_{\\mathrm{age}}\\,x_{\\mathrm{age},B} + \\beta_{\\mathrm{LDL}}\\,x_{\\mathrm{LDL},B} + \\beta_{\\mathrm{smoke}}\\,x_{\\mathrm{smoke},B})$\n$L(\\mathbf{x}_A) - L(\\mathbf{x}_B) = \\beta_{\\mathrm{age}}(x_{\\mathrm{age},A} - x_{\\mathrm{age},B}) + \\beta_{\\mathrm{LDL}}(x_{\\mathrm{LDL},A} - x_{\\mathrm{LDL},B}) + \\beta_{\\mathrm{smoke}}(x_{\\mathrm{smoke},A} - x_{\\mathrm{smoke},B})$\n这就是所要求的、用模型系数和特征差异表示的对数优势差的表达式。\n\n患者 A 相对于患者 B 的优势比 (OR) 定义为其优势的比率：\n$\\mathrm{OR} = \\frac{\\text{odds}_A}{\\text{odds}_B} = \\frac{p(\\mathbf{x}_A)/(1-p(\\mathbf{x}_A))}{p(\\mathbf{x}_B)/(1-p(\\mathbf{x}_B))}$\n使用对数优势的定义，我们可以将优势比写为：\n$\\mathrm{OR} = \\frac{\\exp(L(\\mathbf{x}_A))}{\\exp(L(\\mathbf{x}_B))} = \\exp(L(\\mathbf{x}_A) - L(\\mathbf{x}_B))$\n因此，优势比是对数优势差的指数。\n\n现在，我们计算对数优势差的数值：\n$x_{\\mathrm{age},A} - x_{\\mathrm{age},B} = 2.2 - 1.4 = 0.8$\n$x_{\\mathrm{LDL},A} - x_{\\mathrm{LDL},B} = 1.2 - (-0.2) = 1.4$\n$x_{\\mathrm{smoke},A} - x_{\\mathrm{smoke},B} = 1 - 0 = 1$\n\n$L(\\mathbf{x}_A) - L(\\mathbf{x}_B) = (0.55)(0.8) + (0.25)(1.4) + (1.10)(1)$\n$= 0.44 + 0.35 + 1.10 = 1.89$\n\n最后，我们计算优势比：\n$\\mathrm{OR} = \\exp(1.89) \\approx 6.619332$\n\n四舍五入到四位有效数字，我们得到：\n$\\mathrm{OR} \\approx 6.619$",
            "answer": "$$\\boxed{6.619}$$"
        }
    ]
}