{
    "hands_on_practices": [
        {
            "introduction": "在实践中，我们常常用线性模型来拟合数据，但真实世界的关系可能更为复杂。本练习探讨当真实数据生成过程是二次方时，用线性模型去拟合会发生什么，这个现象被称为*模型设定偏误*（model misspecification bias）。你将推导出真实二次关系下的最佳线性近似斜率，并分析该斜率与真实模型参数的差异，从而理解预测变量$X$的分布如何影响这种偏误。",
            "id": "3159615",
            "problem": "考虑一个实值预测变量 $X$ 和响应变量 $Y$ 的联合分布，其满足以下数据生成过程\n$$\nY \\;=\\; \\beta_{0} \\;+\\; \\beta_{1} X \\;+\\; \\beta_{2} X^{2} \\;+\\; \\varepsilon,\n$$\n其中 $\\mathbb{E}[\\varepsilon \\mid X]=0$ 且 $\\mathbb{E}[\\varepsilon^{2}]<\\infty$。因此，总体回归函数（总体二次目标）为 $m(x)=\\mathbb{E}[Y \\mid X=x]=\\beta_{0}+\\beta_{1} x+\\beta_{2} x^{2}$。假设我们只关注线性预测器 $f(x)=a+bx$，并将总体线性目标定义为期望平方损失 $\\mathbb{E}\\big[(Y-a-bX)^{2}\\big]$ 的最小化者 $(a^{\\star},b^{\\star})$。令 $\\mu_{k}=\\mathbb{E}[X^{k}]$，其中 $k\\in\\{1,2,3\\}$，并假设 $\\operatorname{Var}(X)=\\mu_{2}-\\mu_{1}^{2}>0$。\n\n任务：\n- 仅使用总体线性目标作为 $\\mathbb{E}\\big[(Y-a-bX)^{2}\\big]$ 最小化者的定义，推导最优斜率 $b^{\\star}$ 关于 $\\beta_{1}$、$\\beta_{2}$、$\\mu_{1}$、$\\mu_{2}$ 和 $\\mu_{3}$ 的闭式表达式。由此，求出斜率偏差 $b^{\\star}-\\beta_{1}$，并用 $X$ 的分布（通过 $\\mu_{1}$、$\\mu_{2}$ 和 $\\mu_{3}$）来表示它。\n- 将您的表达式应用于 $X$ 的分布关于 $0$ 对称的特殊情况，此时 $\\mu_{1}=0$ 且 $\\mu_{3}=0$，并陈述在这种情况下得到的 $b^{\\star}$（最终答案无需计算过程）。\n- 最后，对于具体情况 $X \\sim \\mathrm{Uniform}[0,1]$ 且参数为 $\\beta_{0}=1$、$\\beta_{1}=2$ 和 $\\beta_{2}=3$ 时，计算 $b^{\\star}$ 的值。请给出 $b^{\\star}$ 的精确值作为最终答案（不要四舍五入）。",
            "solution": "该问题要求推导对于二次生成响应的线性预测器的最优斜率 $b^{\\star}$，并在一个具体案例中进行求值。\n\n首先，我们验证问题陈述的有效性。\n给定条件如下：\n- 数据生成过程：$Y = \\beta_{0} + \\beta_{1} X + \\beta_{2} X^{2} + \\varepsilon$。\n- 误差条件：$\\mathbb{E}[\\varepsilon \\mid X]=0$ 且 $\\mathbb{E}[\\varepsilon^{2}]<\\infty$。\n- 总体二次目标：$m(x)=\\mathbb{E}[Y \\mid X=x]=\\beta_{0}+\\beta_{1} x+\\beta_{2} x^{2}$。\n- 线性预测器：$f(x)=a+bx$。\n- 总体线性目标：$(a^{\\star},b^{\\star}) = \\arg\\min_{a,b} \\mathbb{E}\\big[(Y-a-bX)^{2}\\big]$。\n- $X$ 的矩：$\\mu_{k}=\\mathbb{E}[X^{k}]$，其中 $k\\in\\{1,2,3\\}$。\n- 方差条件：$\\operatorname{Var}(X)=\\mu_{2}-\\mu_{1}^{2}>0$。\n\n该问题在科学上基于统计回归理论，特别是分析由模型设定不当引起的偏差。这是一个适定问题，因为在条件 $\\operatorname{Var}(X)>0$ 下对凸函数进行最小化可保证唯一解的存在。其语言客观，设定自洽。因此，该问题被认为是有效的。\n\n我们现在开始求解。总体线性目标参数 $(a^{\\star}, b^{\\star})$ 是使期望平方误差损失函数 $L(a,b) = \\mathbb{E}[(Y-a-bX)^2]$ 最小化的 $a$ 和 $b$ 的值。为了找到最小值，我们对 $L(a,b)$ 分别求关于 $a$ 和 $b$ 的偏导数，并令它们为零。\n\n关于 $a$ 的偏导数是：\n$$\n\\frac{\\partial L}{\\partial a} = \\frac{\\partial}{\\partial a} \\mathbb{E}[(Y-a-bX)^2] = \\mathbb{E}\\left[\\frac{\\partial}{\\partial a}(Y-a-bX)^2\\right] = \\mathbb{E}[-2(Y-a-bX)]\n$$\n令其为零：\n$$\n\\mathbb{E}[Y - a^{\\star} - b^{\\star}X] = 0 \\implies \\mathbb{E}[Y] - a^{\\star} - b^{\\star}\\mathbb{E}[X] = 0\n$$\n这给了我们第一个正规方程，它关联了 $a^{\\star}$ 和 $b^{\\star}$：\n$$\na^{\\star} = \\mathbb{E}[Y] - b^{\\star}\\mathbb{E}[X]\n$$\n\n关于 $b$ 的偏导数是：\n$$\n\\frac{\\partial L}{\\partial b} = \\frac{\\partial}{\\partial b} \\mathbb{E}[(Y-a-bX)^2] = \\mathbb{E}\\left[\\frac{\\partial}{\\partial b}(Y-a-bX)^2\\right] = \\mathbb{E}[-2X(Y-a-bX)]\n$$\n令其为零得到第二个正规方程：\n$$\n\\mathbb{E}[X(Y - a^{\\star} - b^{\\star}X)] = 0 \\implies \\mathbb{E}[XY] - a^{\\star}\\mathbb{E}[X] - b^{\\star}\\mathbb{E}[X^2] = 0\n$$\n将第一个方程中 $a^{\\star}$ 的表达式代入第二个方程：\n$$\n\\mathbb{E}[XY] - (\\mathbb{E}[Y] - b^{\\star}\\mathbb{E}[X])\\mathbb{E}[X] - b^{\\star}\\mathbb{E}[X^2] = 0\n$$\n$$\n\\mathbb{E}[XY] - \\mathbb{E}[Y]\\mathbb{E}[X] + b^{\\star}(\\mathbb{E}[X])^2 - b^{\\star}\\mathbb{E}[X^2] = 0\n$$\n项 $\\mathbb{E}[XY] - \\mathbb{E}[X]\\mathbb{E}[Y]$ 是协方差 $\\operatorname{Cov}(X,Y)$。项 $\\mathbb{E}[X^2] - (\\mathbb{E}[X])^2$ 是方差 $\\operatorname{Var}(X)$。方程变为：\n$$\n\\operatorname{Cov}(X,Y) - b^{\\star}\\operatorname{Var}(X) = 0\n$$\n求解 $b^{\\star}$，我们得到众所周知的结果：\n$$\nb^{\\star} = \\frac{\\operatorname{Cov}(X,Y)}{\\operatorname{Var}(X)}\n$$\n问题要求用 $\\beta_1$、$\\beta_2$ 和 $X$ 的矩来表示这个结果。我们必须计算 $\\operatorname{Cov}(X,Y)$。首先，我们计算 $\\mathbb{E}[Y]$ 和 $\\mathbb{E}[XY]$。根据全期望定律和给定条件 $\\mathbb{E}[\\varepsilon \\mid X]=0$，我们有 $\\mathbb{E}[\\varepsilon] = \\mathbb{E}[\\mathbb{E}[\\varepsilon \\mid X]] = \\mathbb{E}[0] = 0$。\n$$\n\\mathbb{E}[Y] = \\mathbb{E}[\\beta_0 + \\beta_1 X + \\beta_2 X^2 + \\varepsilon] = \\beta_0 + \\beta_1 \\mathbb{E}[X] + \\beta_2 \\mathbb{E}[X^2] + \\mathbb{E}[\\varepsilon] = \\beta_0 + \\beta_1 \\mu_1 + \\beta_2 \\mu_2\n$$\n类似地，我们计算 $\\mathbb{E}[XY]$。首先，注意 $\\mathbb{E}[X\\varepsilon] = \\mathbb{E}[\\mathbb{E}[X\\varepsilon \\mid X]] = \\mathbb{E}[X\\mathbb{E}[\\varepsilon \\mid X]] = \\mathbb{E}[X \\cdot 0] = 0$。\n$$\n\\mathbb{E}[XY] = \\mathbb{E}[X(\\beta_0 + \\beta_1 X + \\beta_2 X^2 + \\varepsilon)] = \\mathbb{E}[\\beta_0 X + \\beta_1 X^2 + \\beta_2 X^3 + X\\varepsilon]\n$$\n$$\n\\mathbb{E}[XY] = \\beta_0 \\mathbb{E}[X] + \\beta_1 \\mathbb{E}[X^2] + \\beta_2 \\mathbb{E}[X^3] + \\mathbb{E}[X\\varepsilon] = \\beta_0 \\mu_1 + \\beta_1 \\mu_2 + \\beta_2 \\mu_3\n$$\n现在我们计算协方差：\n$$\n\\operatorname{Cov}(X,Y) = \\mathbb{E}[XY] - \\mathbb{E}[X]\\mathbb{E}[Y] = (\\beta_0 \\mu_1 + \\beta_1 \\mu_2 + \\beta_2 \\mu_3) - \\mu_1(\\beta_0 + \\beta_1 \\mu_1 + \\beta_2 \\mu_2)\n$$\n$$\n\\operatorname{Cov}(X,Y) = \\beta_0 \\mu_1 + \\beta_1 \\mu_2 + \\beta_2 \\mu_3 - \\beta_0 \\mu_1 - \\beta_1 \\mu_1^2 - \\beta_2 \\mu_1 \\mu_2\n$$\n$$\n\\operatorname{Cov}(X,Y) = \\beta_1 (\\mu_2 - \\mu_1^2) + \\beta_2 (\\mu_3 - \\mu_1 \\mu_2)\n$$\n$X$ 的方差是 $\\operatorname{Var}(X) = \\mu_2 - \\mu_1^2$。将这些代入 $b^{\\star}$ 的表达式中：\n$$\nb^{\\star} = \\frac{\\beta_1 (\\mu_2 - \\mu_1^2) + \\beta_2 (\\mu_3 - \\mu_1 \\mu_2)}{\\mu_2 - \\mu_1^2} = \\beta_1 + \\beta_2 \\frac{\\mu_3 - \\mu_1 \\mu_2}{\\mu_2 - \\mu_1^2}\n$$\n这就是所求的 $b^{\\star}$ 的闭式表达式。斜率偏差是这个最优线性斜率与真实线性系数 $\\beta_1$ 之间的差值：\n$$\n\\text{斜率偏差} = b^{\\star} - \\beta_1 = \\beta_2 \\frac{\\mu_3 - \\mu_1 \\mu_2}{\\mu_2 - \\mu_1^2}\n$$\n这种偏差是模型设定不当的结果，即用线性模型去拟合由二次过程生成的数据。如果 $\\beta_2=0$（真实模型是线性的），或者项 $\\mu_3 - \\mu_1 \\mu_2 = \\mathbb{E}[X^3] - \\mathbb{E}[X]\\mathbb{E}[X^2] = \\operatorname{Cov}(X, X^2)$ 为零，则偏差为零。\n\n对于第二个任务，如果 $X$ 的分布关于 $0$ 对称，则其奇数阶矩为零。因此，$\\mu_1 = \\mathbb{E}[X] = 0$ 且 $\\mu_3 = \\mathbb{E}[X^3] = 0$。将这些代入 $b^{\\star}$ 的表达式中：\n$$\nb^{\\star} = \\beta_1 + \\beta_2 \\frac{0 - 0 \\cdot \\mu_2}{\\mu_2 - 0^2} = \\beta_1 + \\beta_2 \\frac{0}{\\mu_2}\n$$\n因为 $\\operatorname{Var}(X) = \\mu_2 - \\mu_1^2 = \\mu_2 > 0$，所以分母不为零。表达式简化为 $b^{\\star} = \\beta_1$。在这种情况下，斜率偏差为 $0$。\n\n对于最后一个任务，我们在 $X \\sim \\mathrm{Uniform}[0,1]$ 且 $\\beta_1=2$、$\\beta_2=3$ 的条件下计算 $b^{\\star}$。我们需要矩 $\\mu_1$、$\\mu_2$ 和 $\\mu_3$。对于一个在 $[0,1]$ 上服从均匀分布的随机变量 $X$，其 $k$ 阶矩为：\n$$\n\\mu_k = \\mathbb{E}[X^k] = \\int_0^1 x^k \\cdot 1 \\,dx = \\left[ \\frac{x^{k+1}}{k+1} \\right]_0^1 = \\frac{1}{k+1}\n$$\n因此：\n$$\n\\mu_1 = \\frac{1}{2}, \\quad \\mu_2 = \\frac{1}{3}, \\quad \\mu_3 = \\frac{1}{4}\n$$\n现在我们计算 $b^{\\star}$ 公式所需的各项：\n分数项的分子是 $\\mu_3 - \\mu_1 \\mu_2$：\n$$\n\\mu_3 - \\mu_1 \\mu_2 = \\frac{1}{4} - \\left(\\frac{1}{2}\\right)\\left(\\frac{1}{3}\\right) = \\frac{1}{4} - \\frac{1}{6} = \\frac{3-2}{12} = \\frac{1}{12}\n$$\n分母是 $\\operatorname{Var}(X) = \\mu_2 - \\mu_1^2$：\n$$\n\\mu_2 - \\mu_1^2 = \\frac{1}{3} - \\left(\\frac{1}{2}\\right)^2 = \\frac{1}{3} - \\frac{1}{4} = \\frac{4-3}{12} = \\frac{1}{12}\n$$\n将这些代入 $b^{\\star}$ 的表达式中：\n$$\nb^{\\star} = \\beta_1 + \\beta_2 \\frac{\\frac{1}{12}}{\\frac{1}{12}} = \\beta_1 + \\beta_2(1) = \\beta_1 + \\beta_2\n$$\n给定值 $\\beta_1 = 2$ 和 $\\beta_2 = 3$，我们求出 $b^{\\star}$ 的具体值：\n$$\nb^{\\star} = 2 + 3 = 5\n$$",
            "answer": "$$\\boxed{5}$$"
        },
        {
            "introduction": "即便两个变量在总体中完全不相关（即真实斜率为零），有限的样本也几乎总会因为纯粹的随机性而显示出某种非零的相关关系。本练习将量化这种*抽样变异性*（sampling variability）的影响。你将推导在真实斜率为零的假设下，最小二乘斜率估计量的分布，并计算出观察到“伪关系”的概率及其期望大小。这项实践有助于你深刻理解为何我们需要统计推断来区分真实效应与随机噪声。",
            "id": "3159729",
            "problem": "考虑一个随机设计简单线性回归模型，其中解释变量 $X$ 和响应 $Y$ 按如下方式联合生成：抽取 $n$ 个独立同分布的配对 $(X_i,Y_i)$，其中 $X_i \\sim \\mathcal{N}(0,\\tau^2)$ 且 $Y_i \\sim \\mathcal{N}(0,\\sigma^2)$，对于每个 $i$，$X_i$ 与 $Y_i$ 独立，并且不同 $i$ 之间也相互独立。在这种情况下，由于 $\\operatorname{Cov}(X,Y)=0$，$Y$ 对 $X$ 的总体回归线的斜率为 $0$。然而，由于有限样本协方差的随机波动，从有限样本计算出的普通最小二乘估计量可能具有非零斜率。\n\n令带截距的最小二乘斜率为\n$$\n\\hat{\\beta}_1 \\;=\\; \\frac{\\sum_{i=1}^n (X_i - \\bar{X})(Y_i - \\bar{Y})}{\\sum_{i=1}^n (X_i - \\bar{X})^2},\n$$\n其中 $\\bar{X} = \\frac{1}{n}\\sum_{i=1}^n X_i$ 且 $\\bar{Y} = \\frac{1}{n}\\sum_{i=1}^n Y_i$。\n\n您的目标是，对于给定的 $(n,\\tau,\\sigma,t)$，从基本原理出发推导并计算以下量：\n\n1. 无条件概率 $P(|\\hat{\\beta}_1| \\ge t)$，即最小二乘斜率的绝对值超过阈值 $t$ 的概率，用给定生成模型下的基本分布和期望表示。\n\n2. 最小二乘斜率的无条件期望绝对值 $E(|\\hat{\\beta}_1|)$。\n\n3. $|\\hat{\\beta}_1|$ 的无条件中位数绝对值 $m$，定义为 $P(|\\hat{\\beta}_1| \\le m) = 1/2$。\n\n从以下基本事实出发：\n- 协方差的定义以及 $Y$ 对 $X$ 的总体回归斜率由 $\\beta_1^\\star = \\frac{\\operatorname{Cov}(X,Y)}{\\operatorname{Var}(X)}$ 给出。\n- 如上给出的带截距的最小二乘斜率估计量的定义。\n- 一个事实是，在观测到 $X_1,\\dots,X_n$ 的条件下，对于模型 $Y_i$ 独立于 $X_i$ 且 $Y_i \\sim \\mathcal{N}(0,\\sigma^2)$，最小二乘斜率服从均值为 $0$、方差为 $\\sigma^2/\\sum_{i=1}^n (X_i - \\bar{X})^2$ 的正态分布。\n- 另一个事实是，当 $X_i \\sim \\mathcal{N}(0,\\tau^2)$ 时，中心化平方和 $S_{XX} = \\sum_{i=1}^n (X_i - \\bar{X})^2$ 的分布为 $S_{XX} \\sim \\tau^2 \\cdot \\chi^2_{n-1}$，其中 $\\chi^2_{k}$ 表示一个自由度为 $k$ 的卡方随机变量。\n\n推导对所有 $n \\ge 3$ 以及有限正值 $\\tau$ 和 $\\sigma$ 都有效的表达式。不要在问题陈述中提供捷径公式。\n\n数值答案必须是实数，并且不带单位。本问题不涉及角度。如果存在百分比，必须以小数形式表示。\n\n测试套件：\n为以下参数集 $(n,\\tau,\\sigma,t)$ 提供结果：\n- 情况 1：$(n,\\tau,\\sigma,t) = (3,1.0,1.0,1.0)$\n- 情况 2：$(n,\\tau,\\sigma,t) = (10,1.0,1.0,0.5)$\n- 情况 3：$(n,\\tau,\\sigma,t) = (50,1.0,1.0,0.2)$\n- 情况 4：$(n,\\tau,\\sigma,t) = (20,0.2,2.0,0.5)$\n\n最终输出格式：\n您的程序应生成单行输出，其中包含四个测试用例的结果。结果是一个用方括号括起来的逗号分隔列表，每个用例的结果本身是一个包含三个浮点数的方括号列表，顺序为 $[P(|\\hat{\\beta}_1|\\ge t), E(|\\hat{\\beta}_1|), m]$。例如，一个包含两个假设用例的输出应如下所示：`[[0.123,0.456,0.789],[0.012,0.034,0.056]]`。您的代码必须实现必要的积分和计算，以生成每个测试用例所需的值。",
            "solution": "此问题被评估为有效。它具有科学依据，问题提出得当，客观，自洽且一致。该问题要求在一个指定的随机设计数据生成过程下，推导并计算简单线性回归模型中普通最小二乘（OLS）斜率估计量的几个统计性质。所有提供的信息在统计理论领域内都是标准且正确的。因此，我们可以进行推导和求解。\n\n解决方案的核心在于找到 OLS 斜率估计量 $\\hat{\\beta}_1$ 的无条件抽样分布。问题指定了一个两阶段的数据生成过程：首先，抽取解释变量 $X_i$，然后抽取响应变量 $Y_i$。这种结构为求解提供了一条路径：首先，确定在给定 $X_1, \\dots, X_n$ 值条件下的 $\\hat{\\beta}_1$ 分布，然后对 $X_i$ 变量的分布进行平均，以找到无条件分布。\n\n**第 1 步：$\\hat{\\beta}_1$ 的条件分布**\n\n问题提供的 OLS 斜率估计量为：\n$$\n\\hat{\\beta}_1 = \\frac{\\sum_{i=1}^n (X_i - \\bar{X})(Y_i - \\bar{Y})}{\\sum_{i=1}^n (X_i - \\bar{X})^2}\n$$\n分子可以简化为：\n$$\n\\sum_{i=1}^n (X_i - \\bar{X})(Y_i - \\bar{Y}) = \\sum_{i=1}^n (X_i - \\bar{X})Y_i - \\bar{Y}\\sum_{i=1}^n (X_i - \\bar{X})\n$$\n由于 $\\sum_{i=1}^n (X_i - \\bar{X}) = 0$，第二项消失。令 $S_{XX} = \\sum_{i=1}^n (X_i - \\bar{X})^2$。则，\n$$\n\\hat{\\beta}_1 = \\frac{\\sum_{i=1}^n (X_i - \\bar{X})Y_i}{S_{XX}} = \\sum_{i=1}^n c_i Y_i\n$$\n其中 $c_i = \\frac{X_i - \\bar{X}}{S_{XX}}$。\n\n在 $X_1, \\dots, X_n$ 的特定实现条件下，$c_i$ 是固定常数。响应变量 $Y_i$ 是独立同分布（i.i.d.）的，即 $Y_i \\sim \\mathcal{N}(0, \\sigma^2)$，并且独立于 $X_i$。因此，在 $X_i$ 的条件下，$\\hat{\\beta}_1$ 是独立高斯随机变量的线性组合，因此其本身也是一个高斯随机变量。\n\n条件均值为：\n$$\nE[\\hat{\\beta}_1 | X_1, \\dots, X_n] = E\\left[\\sum_{i=1}^n c_i Y_i \\Big| X_1, \\dots, X_n\\right] = \\sum_{i=1}^n c_i E[Y_i] = \\sum_{i=1}^n c_i \\cdot 0 = 0\n$$\n条件方差为：\n$$\n\\operatorname{Var}(\\hat{\\beta}_1 | X_1, \\dots, X_n) = \\operatorname{Var}\\left(\\sum_{i=1}^n c_i Y_i \\Big| X_1, \\dots, X_n\\right) = \\sum_{i=1}^n c_i^2 \\operatorname{Var}(Y_i) = \\sigma^2 \\sum_{i=1}^n c_i^2\n$$\n系数平方和为：\n$$\n\\sum_{i=1}^n c_i^2 = \\sum_{i=1}^n \\left(\\frac{X_i - \\bar{X}}{S_{XX}}\\right)^2 = \\frac{\\sum_{i=1}^n (X_i - \\bar{X})^2}{S_{XX}^2} = \\frac{S_{XX}}{S_{XX}^2} = \\frac{1}{S_{XX}}\n$$\n因此，条件方差为 $\\frac{\\sigma^2}{S_{XX}}$。这证实了问题陈述中给出的事实，即在 $X_1, \\dots, X_n$ 的条件下，$\\hat{\\beta}_1$ 的分布为：\n$$\n\\hat{\\beta}_1 \\Big| (X_1, \\dots, X_n) \\sim \\mathcal{N}\\left(0, \\frac{\\sigma^2}{S_{XX}}\\right)\n$$\n这使我们能够将 $\\hat{\\beta}_1$ 写成 $\\hat{\\beta}_1 = \\frac{\\sigma}{\\sqrt{S_{XX}}} Z$ 的形式，其中 $Z \\sim \\mathcal{N}(0, 1)$ 是一个标准正态随机变量，独立于 $X_i$，因此也独立于 $S_{XX}$。\n\n**第 2 步：$\\hat{\\beta}_1$ 的无条件分布**\n\n为了找到无条件分布，我们必须考虑 $S_{XX}$ 的随机性。问题指出 $X_i \\sim \\mathcal{N}(0, \\tau^2)$ 是独立同分布的。统计学中的一个标准结果（与 Cochran 定理相关）是，对于这样的 $X_i$，中心化平方和 $S_{XX} = \\sum_{i=1}^n (X_i - \\bar{X})^2$ 服从一个缩放的卡方分布：\n$$\nS_{XX} \\sim \\tau^2 \\cdot \\chi^2_{n-1}\n$$\n其中 $\\chi^2_{n-1}$ 表示一个自由度为 $n-1$ 的卡方随机变量。令 $k = n-1$ 为自由度。令 $U \\sim \\chi^2_k$。则 $S_{XX} = \\tau^2 U$。\n\n将此代入我们关于 $\\hat{\\beta}_1$ 的表达式中：\n$$\n\\hat{\\beta}_1 = \\frac{\\sigma}{\\sqrt{\\tau^2 U}} Z = \\frac{\\sigma}{\\tau} \\frac{Z}{\\sqrt{U}}\n$$\n其中 $Z \\sim \\mathcal{N}(0, 1)$ 和 $U \\sim \\chi^2_k$ 是独立的随机变量。\n\n根据定义，一个自由度为 $k$ 的学生 t 分布随机变量 $T_k$ 由比率 $T_k = \\frac{Z}{\\sqrt{U/k}}$ 给出。我们可以重写 $\\hat{\\beta}_1$ 的表达式以分离出这种结构：\n$$\n\\hat{\\beta}_1 = \\frac{\\sigma}{\\tau} \\frac{Z}{\\sqrt{U/k} \\cdot \\sqrt{k}} = \\left(\\frac{\\sigma}{\\tau\\sqrt{k}}\\right) \\frac{Z}{\\sqrt{U/k}} = \\frac{\\sigma}{\\tau\\sqrt{n-1}} T_{n-1}\n$$\n这就是 $\\hat{\\beta}_1$ 的无条件分布。它是一个缩放的学生 t 分布，自由度为 $k = n-1$。令缩放常数为 $C = \\frac{\\sigma}{\\tau\\sqrt{n-1}}$。\n\n**第 3 步：所需量的推导**\n\n利用无条件分布 $\\hat{\\beta}_1 = C \\cdot T_{n-1}$，我们可以推导出所要求的三个量。\n\n**1. 概率 $P(|\\hat{\\beta}_1| \\ge t)$**\n$$\nP(|\\hat{\\beta}_1| \\ge t) = P(|C \\cdot T_{n-1}| \\ge t) = P\\left(|T_{n-1}| \\ge \\frac{t}{|C|}\\right)\n$$\n由于 $\\sigma, \\tau > 0$，常数 $C$ 是正的。\n$$\nP(|\\hat{\\beta}_1| \\ge t) = P\\left(|T_{n-1}| \\ge \\frac{t}{C}\\right) = P\\left(|T_{n-1}| \\ge \\frac{t \\tau\\sqrt{n-1}}{\\sigma}\\right)\n$$\n学生 t 分布关于 $0$ 对称。因此，这个概率是在正阈值处求值的生存函数（sf，或 $1-$CDF）值的两倍：\n$$\nP(|\\hat{\\beta}_1| \\ge t) = 2 \\cdot \\operatorname{sf}_{T_{n-1}}\\left(\\frac{t \\tau\\sqrt{n-1}}{\\sigma}\\right)\n$$\n其中 $\\operatorname{sf}_{T_k}(\\cdot)$ 是自由度为 $k$ 的 t 分布的生存函数。\n\n**2. 期望绝对值 $E(|\\hat{\\beta}_1|)$**\n$$\nE[|\\hat{\\beta}_1|] = E\\left[\\left| C \\cdot T_{n-1} \\right|\\right] = C \\cdot E[|T_{n-1}|]\n$$\n我们从基本原理推导 $k=n-1$ 时的 $E[|T_k|]$。使用 $T_k = Z/\\sqrt{U/k}$，其中 $Z \\sim \\mathcal{N}(0,1)$ 和 $U \\sim \\chi^2_k$ 独立：\n$$\nE[|T_k|] = E\\left[\\frac{|Z|}{\\sqrt{U/k}}\\right] = E[|Z|] \\cdot E\\left[(U/k)^{-1/2}\\right] \\quad (\\text{根据独立性})\n$$\n第一项是标准半正态分布的期望值：\n$$\nE[|Z|] = \\int_{-\\infty}^\\infty |z| \\frac{e^{-z^2/2}}{\\sqrt{2\\pi}} dz = 2 \\int_0^\\infty z \\frac{e^{-z^2/2}}{\\sqrt{2\\pi}} dz = \\sqrt{\\frac{2}{\\pi}} \\left[-e^{-z^2/2}\\right]_0^\\infty = \\sqrt{\\frac{2}{\\pi}}\n$$\n第二项是 $E[(U/k)^{-1/2}] = \\sqrt{k} \\cdot E[U^{-1/2}]$。$U \\sim \\chi^2_k$ 的概率密度函数（PDF）是 $f_U(u) = \\frac{u^{k/2-1}e^{-u/2}}{2^{k/2}\\Gamma(k/2)}$，对于 $u>0$。此期望要求 $k>1$（即 $n>2$），这满足了问题 $n \\ge 3$ 的约束。\n$$\nE[U^{-1/2}] = \\int_0^\\infty u^{-1/2} f_U(u) du = \\frac{1}{2^{k/2}\\Gamma(k/2)} \\int_0^\\infty u^{(k-1)/2-1} e^{-u/2} du\n$$\n该积分是形状参数 $\\alpha = (k-1)/2$ 和速率参数 $\\beta=1/2$ 的伽马分布的核。积分的值是 $\\Gamma((k-1)/2)/(1/2)^{(k-1)/2} = \\Gamma((k-1)/2) \\cdot 2^{(k-1)/2}$。\n$$\nE[U^{-1/2}] = \\frac{\\Gamma((k-1)/2) \\cdot 2^{(k-1)/2}}{2^{k/2}\\Gamma(k/2)} = \\frac{\\Gamma((k-1)/2)}{\\sqrt{2}\\Gamma(k/2)}\n$$\n结合这些结果：\n$$\nE[|T_k|] = E[|Z|] \\cdot \\sqrt{k} \\cdot E[U^{-1/2}] = \\sqrt{\\frac{2}{\\pi}} \\cdot \\sqrt{k} \\cdot \\frac{\\Gamma((k-1)/2)}{\\sqrt{2}\\Gamma(k/2)} = \\frac{\\sqrt{k}}{\\sqrt{\\pi}} \\frac{\\Gamma(\\frac{k-1}{2})}{\\Gamma(\\frac{k}{2})}\n$$\n最后，将此代入 $E[|\\hat{\\beta}_1|]$ 的表达式中：\n$$\nE[|\\hat{\\beta}_1|] = C \\cdot E[|T_{n-1}|] = \\frac{\\sigma}{\\tau\\sqrt{n-1}} \\cdot \\frac{\\sqrt{n-1}}{\\sqrt{\\pi}} \\frac{\\Gamma(\\frac{n-2}{2})}{\\Gamma(\\frac{n-1}{2})} = \\frac{\\sigma}{\\tau\\sqrt{\\pi}} \\frac{\\Gamma(\\frac{n-2}{2})}{\\Gamma(\\frac{n-1}{2})}\n$$\n\n**3. 中位数绝对值 $m$**\n中位数绝对值 $m$ 由条件 $P(|\\hat{\\beta}_1| \\le m) = 1/2$ 定义。这等价于 $P(|\\hat{\\beta}_1| > m) = 1/2$。\n$$\nP(|C \\cdot T_{n-1}| > m) = P\\left(|T_{n-1}| > \\frac{m}{C}\\right) = \\frac{1}{2}\n$$\n令 $q = m/C$。我们需要找到 $q$ 使得 $P(|T_{n-1}| > q) = 1/2$。这意味着 $P(-q \\le T_{n-1} \\le q) = 1/2$。\n令 $F_{T_{k}}$ 为 $T_{k}$ 分布的累积分布函数（CDF）。根据对称性，$P(-q \\le T_{n-1} \\le q) = F_{T_{n-1}}(q) - F_{T_{n-1}}(-q) = F_{T_{n-1}}(q) - (1-F_{T_{n-1}}(q)) = 2F_{T_{n-1}}(q)-1$。\n将此设为 $1/2$：$2F_{T_{n-1}}(q)-1 = 1/2 \\implies 2F_{T_{n-1}}(q) = 3/2 \\implies F_{T_{n-1}}(q) = 3/4 = 0.75$。\n这意味着 $q$ 是 $T_{n-1}$ 分布的第 75 百分位数（第三四分位数）。这个值可以使用百分点函数（ppf），即逆 CDF 来找到。令 $q_{0.75} = \\operatorname{ppf}_{T_{n-1}}(0.75)$。\n从 $m/C = q_{0.75}$，我们得到 $m = C \\cdot q_{0.75}$。\n$$\nm = \\frac{\\sigma}{\\tau\\sqrt{n-1}} \\cdot \\operatorname{ppf}_{T_{n-1}}(0.75)\n$$\n\n**计算公式总结**\n对于给定的参数集 $(n, \\tau, \\sigma, t)$，且 $k=n-1$：\n1.  $P(|\\hat{\\beta}_1| \\ge t) = 2 \\cdot \\operatorname{sf}_{T_k}\\left(t \\frac{\\tau\\sqrt{k}}{\\sigma}\\right)$\n2.  $E(|\\hat{\\beta}_1|) = \\frac{\\sigma}{\\tau\\sqrt{\\pi}} \\frac{\\Gamma(\\frac{k-1}{2})}{\\Gamma(\\frac{k}{2})}$\n3.  $m = \\frac{\\sigma}{\\tau\\sqrt{k}} \\cdot \\operatorname{ppf}_{T_k}(0.75)$\n\n这些公式将在 Python 代码中用于计算测试套件的值。我们将使用 `scipy.stats.t` 来处理 t 分布函数，并使用 `scipy.special.gammaln` 来进行伽马函数比值的数值稳定计算。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import stats\nfrom scipy.special import gammaln\n\ndef solve():\n    \"\"\"\n    Derives and computes properties of the OLS slope estimator under a null model.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (n, tau, sigma, t)\n        (3, 1.0, 1.0, 1.0),\n        (10, 1.0, 1.0, 0.5),\n        (50, 1.0, 1.0, 0.2),\n        (20, 0.2, 2.0, 0.5),\n    ]\n\n    results = []\n    for case in test_cases:\n        n, tau, sigma, t = case\n        \n        # Degrees of freedom for the t-distribution\n        k = n - 1 # must be >= 2 as n >= 3\n\n        # 1. Compute the probability P(|beta_hat_1| >= t)\n        # The unconditional distribution of beta_hat_1 is a scaled t-distribution:\n        # beta_hat_1 = (sigma / (tau * sqrt(n-1))) * T_{n-1}\n        # P(|beta_hat_1| >= t) = P(|T_{n-1}| >= t * tau * sqrt(n-1) / sigma)\n        scaled_t = t * tau * np.sqrt(k) / sigma\n        # For a symmetric distribution, P(|X| >= a) = 2 * SF(a) for a > 0\n        prob_ge_t = 2 * stats.t.sf(scaled_t, df=k)\n\n        # 2. Compute the unconditional expected magnitude E(|beta_hat_1|)\n        # E[|beta_hat_1|] = (sigma / tau) * (1/sqrt(pi)) * Gamma((n-2)/2) / Gamma((n-1)/2)\n        # Using logarithms of gamma functions for numerical stability.\n        # log(Gamma(a)/Gamma(b)) = gammaln(a) - gammaln(b)\n        log_gamma_ratio = gammaln((k - 1) / 2) - gammaln(k / 2)\n        exp_mag = (sigma / tau / np.sqrt(np.pi)) * np.exp(log_gamma_ratio)\n\n        # 3. Compute the unconditional median magnitude m of |beta_hat_1|\n        # m is defined by P(|beta_hat_1| = m) = 1/2\n        # This implies m / (sigma / (tau * sqrt(n-1))) = ppf_{T_{n-1}}(0.75)\n        # m = (sigma / (tau * sqrt(n-1))) * ppf_{T_{n-1}}(0.75)\n        q_75 = stats.t.ppf(0.75, df=k)\n        median_mag = (sigma / (tau * np.sqrt(k))) * q_75\n        \n        results.append([prob_ge_t, exp_mag, median_mag])\n\n    # Format the final output as a string according to the specification.\n    # e.g., [[val1,val2,val3],[val4,val5,val6]]\n    output_str = f\"[{','.join(f'[{v[0]},{v[1]},{v[2]}]' for v in results)}]\"\n    print(output_str)\n\nsolve()\n\n```"
        },
        {
            "introduction": "真实世界的数据集很少是完美无瑕的，其中某些数据点（被称为影响点）可能对回归结果产生不成比例的巨大影响。本练习旨在介绍*杠杆率*（leverage）和*影响点诊断*（influence diagnostics），特别是库克距离（Cook's distance），作为识别这些异常点的有力工具。通过对一个包含高杠杆率点的小型数据集进行计算，你将亲身体验单个观测值如何将样本最小二乘直线拉离真实的总体回归线，从而认识到在实际回归分析中进行诊断检查的重要性。",
            "id": "3159624",
            "problem": "在统计学习设定下，对一个有限样本拟合一个简单线性回归，其中假定总体回归线为 $y = 2 + 1.5 x$。考虑根据 $y_i = 2 + 1.5 x_i + \\varepsilon_i$ 生成的 $n = 6$ 个观测值 $(x_i, y_i)$，其中 $\\varepsilon_i$ 为小的扰动项：\n$(x_1, y_1) = (0, 2)$，$(x_2, y_2) = (1, 3.5)$，$(x_3, y_3) = (2, 5)$，$(x_4, y_4) = (3, 6.5)$，$(x_5, y_5) = (8, 16)$，$(x_6, y_6) = (2, 5)$。\n将这些视为一个已实现的有限样本，并使用普通最小二乘法 (OLS; Ordinary Least Squares) 拟合最小二乘线。仅使用最小二乘估计、杠杆值和影响的基本定义，计算每个观测值的库克距离，并用它来评估在存在一个罕见的 $x$ 值的情况下，有限样本的最小二乘线如何偏离总体回归线。然后选择正确的陈述。\n\n选项：\nA. $x = 8$ 的观测值具有最大的库克距离，移除它会使最小二乘线更接近总体回归线 $y = 2 + 1.5 x$。\n\nB. $x = 3$ 的观测值具有最大的库克距离，因为它在非罕见 $x$ 值中具有最大的残差绝对值。\n\nC. 库克距离仅取决于残差平方 $r_i^2$；两个具有相同残差的点，无论其 $x_i$ 值如何，都将具有相同的库克距离。\n\nD. 当 $x_i$ 非常接近样本均值 $\\bar{x}$ 时，会产生高杠杆值；因此，罕见的 $x = 8$ 点具有低杠杆值。\n\nE. 根据计算出的库克距离，所有点都低于启发式阈值 $4/n$；因此没有观测值是有影响的。",
            "solution": "用户希望我验证问题陈述，如果有效，则通过推导最小二乘线、计算库克距离并评估每个给定陈述来解决问题。\n\n### 第1步：提取已知条件\n- 模型是简单线性回归：$y_i = \\beta_0 + \\beta_1 x_i + \\varepsilon_i$。\n- 总体回归线为 $y = 2 + 1.5 x$，所以 $\\beta_0 = 2$ 且 $\\beta_1 = 1.5$。\n- 样本量为 $n=6$。\n- 观测数据点为：\n  - $(x_1, y_1) = (0, 2)$\n  - $(x_2, y_2) = (1, 3.5)$\n  - $(x_3, y_3) = (2, 5)$\n  - $(x_4, y_4) = (3, 6.5)$\n  - $(x_5, y_5) = (8, 16)$\n  - $(x_6, y_6) = (2, 5)$\n- 拟合方法是普通最小二乘法 (OLS)。\n- 任务是计算每个观测值的库克距离并评估其影响。\n\n### 第2步：使用提取的已知条件进行验证\n- **科学依据：** 问题基于统计学中的基本和标准概念：简单线性回归、普通最小二乘法、杠杆值和库克距离。这些是统计学习中成熟的核心课题。\n- **适定性：** 问题提供了一个完整的数据集，并要求基于定义明确的统计公式进行计算。对于此数据集，存在唯一的 OLS 解和相应的诊断统计量。\n- **客观性：** 问题提供了数值数据，并要求基于标准统计指标进行客观的计算和解释。“小的扰动项”和“罕见的 $x$ 值”是对所提供数据结构的恰当非正式描述。我们可以验证扰动项 $\\varepsilon_i = y_i - (2 + 1.5 x_i)$：\n  - $\\varepsilon_1 = 2 - (2 + 1.5 \\cdot 0) = 0$\n  - $\\varepsilon_2 = 3.5 - (2 + 1.5 \\cdot 1) = 0$\n  - $\\varepsilon_3 = 5 - (2 + 1.5 \\cdot 2) = 0$\n  - $\\varepsilon_4 = 6.5 - (2 + 1.5 \\cdot 3) = 0$\n  - $\\varepsilon_5 = 16 - (2 + 1.5 \\cdot 8) = 16 - 14 = 2$\n  - $\\varepsilon_6 = 5 - (2 + 1.5 \\cdot 2) = 0$\n  扰动项确实很小，只有一个非零值。术语“罕见的 $x$ 值”客观地描述了 $x_5=8$，它远离其他 $x$ 值 $(0, 1, 2, 3)$。\n- **完整性和一致性：** 问题是自洽的，并提供了进行下去所需的所有数据和定义。没有内部矛盾。重复点 $(2, 5)$ 的存在是抽样中的一个有效情景。\n\n### 第3步：结论和行动\n问题是**有效的**。现在开始求解过程。\n\n### 推导\n目标是为给定的 $n=6$ 个数据点拟合一条最小二乘线 $\\hat{y} = \\hat{\\beta}_0 + \\hat{\\beta}_1 x$，并使用库克距离分析每个点的影响。\n\n**1. 计算 OLS 系数 ($\\hat{\\beta}_0, \\hat{\\beta}_1$)**\n\n首先，我们计算样本均值 $\\bar{x}$ 和 $\\bar{y}$。\n$x$ 值为 $(0, 1, 2, 3, 8, 2)$。$y$ 值为 $(2, 3.5, 5, 6.5, 16, 5)$。\n$$ \\bar{x} = \\frac{0+1+2+3+8+2}{6} = \\frac{16}{6} = \\frac{8}{3} $$\n$$ \\bar{y} = \\frac{2+3.5+5+6.5+16+5}{6} = \\frac{38}{6} = \\frac{19}{3} $$\nOLS 斜率估计量是 $\\hat{\\beta}_1 = \\frac{\\sum_{i=1}^n (x_i - \\bar{x})(y_i - \\bar{y})}{\\sum_{i=1}^n (x_i - \\bar{x})^2}$。\n分母是：\n$$ \\sum_{i=1}^n (x_i - \\bar{x})^2 = (0-\\frac{8}{3})^2 + (1-\\frac{8}{3})^2 + (2-\\frac{8}{3})^2 + (3-\\frac{8}{3})^2 + (8-\\frac{8}{3})^2 + (2-\\frac{8}{3})^2 $$\n$$ = (-\\frac{8}{3})^2 + (-\\frac{5}{3})^2 + (-\\frac{2}{3})^2 + (\\frac{1}{3})^2 + (\\frac{16}{3})^2 + (-\\frac{2}{3})^2 = \\frac{64+25+4+1+256+4}{9} = \\frac{354}{9} = \\frac{118}{3} $$\n分子是：\n$$ \\sum_{i=1}^n (x_i - \\bar{x})(y_i - \\bar{y}) = (0-\\frac{8}{3})(2-\\frac{19}{3}) + (1-\\frac{8}{3})(3.5-\\frac{19}{3}) + \\dots $$\n$$ = (-\\frac{8}{3})(-\\frac{13}{3}) + (-\\frac{5}{3})(-\\frac{8.5}{3}) + (-\\frac{2}{3})(-\\frac{4}{3}) + (\\frac{1}{3})(\\frac{0.5}{3}) + (\\frac{16}{3})(\\frac{29}{3}) + (-\\frac{2}{3})(-\\frac{4}{3}) $$\n$$ = \\frac{104 + 42.5 + 8 + 0.5 + 464 + 8}{9} = \\frac{627}{9} = \\frac{209}{3} $$\n所以，斜率是：\n$$ \\hat{\\beta}_1 = \\frac{209/3}{118/3} = \\frac{209}{118} \\approx 1.771 $$\n截距估计量是 $\\hat{\\beta}_0 = \\bar{y} - \\hat{\\beta}_1 \\bar{x}$：\n$$ \\hat{\\beta}_0 = \\frac{19}{3} - \\frac{209}{118} \\cdot \\frac{8}{3} = \\frac{1}{3} \\left( 19 - \\frac{1672}{118} \\right) = \\frac{1}{3} \\left( \\frac{2242 - 1672}{118} \\right) = \\frac{1}{3} \\frac{570}{118} = \\frac{190}{118} = \\frac{95}{59} \\approx 1.610 $$\n最小二乘线是 $\\hat{y} = \\frac{95}{59} + \\frac{209}{118} x$，约等于 $\\hat{y} \\approx 1.610 + 1.771 x$。\n这偏离了总体线 $y = 2 + 1.5 x$。\n\n**2. 计算杠杆值和库克距离**\n\n观测值 $i$ 的库克距离由下式给出：\n$$ D_i = \\frac{r_i^2}{p \\cdot \\text{MSE}} \\left[ \\frac{h_{ii}}{(1-h_{ii})^2} \\right] $$\n其中 $p$ 是估计参数的数量（对于 $\\hat{\\beta}_0, \\hat{\\beta}_1$，$p=2$），$r_i=y_i-\\hat{y}_i$ 是残差，MSE 是均方误差，而 $h_{ii}$ 是观测值 $i$ 的杠杆值。\n\n杠杆值 $h_{ii}$ 由下式给出：\n$$ h_{ii} = \\frac{1}{n} + \\frac{(x_i - \\bar{x})^2}{\\sum_{j=1}^n (x_j - \\bar{x})^2} $$\n$x_5 = 8$ 的观测值距离 $\\bar{x} = 8/3 \\approx 2.67$ 最远。它的杠杆值将是最高的。\n$$ h_{55} = \\frac{1}{6} + \\frac{(8 - 8/3)^2}{118/3} = \\frac{1}{6} + \\frac{(16/3)^2}{118/3} = \\frac{1}{6} + \\frac{256/9}{118/3} = \\frac{1}{6} + \\frac{256 \\cdot 3}{9 \\cdot 118} = \\frac{1}{6} + \\frac{256}{3 \\cdot 118} = \\frac{1}{6} + \\frac{256}{354} $$\n$$ h_{55} = \\frac{59}{354} + \\frac{256}{354} = \\frac{315}{354} = \\frac{105}{118} \\approx 0.890 $$\n这是一个极高的杠杆值（所有杠杆值之和为 $p=2$）。\n\n### 逐项分析\n\n**A. $x = 8$ 的观测值具有最大的库克距离，移除它会使最小二乘线更接近总体回归线 $y = 2 + 1.5 x$。**\n\n库克距离 $D_i$ 的公式在分母中包含项 $(1-h_{ii})^2$。对于观测值 5，$h_{55} \\approx 0.890$，因此 $(1-h_{55})^2 \\approx (0.110)^2$ 非常小，这使得项 $\\frac{h_{ii}}{(1-h_{ii})^2}$ 非常大。这强烈表明 $D_5$ 将是最大的。虽然它的残差可能不是最大的，但其极端的杠杆值使其成为最具影响力的点。\n点 5 的残差是 $r_5 = y_5 - \\hat{y}_5 = 16 - (\\frac{95}{59} + \\frac{209}{118} \\cdot 8) = 16 - \\frac{190+1672}{118} = 16 - \\frac{1862}{118} = 16 - \\frac{931}{59} = \\frac{944-931}{59} = \\frac{13}{59}$。\n\n为了检查陈述的第二部分，我们移除观测值 5 ($(8, 16)$) 并重新拟合回归线。剩下的 5 个点是：$(0, 2)$, $(1, 3.5)$, $(2, 5)$, $(3, 6.5)$ 和 $(2, 5)$。\n我们来检查这些点是否落在总体线 $y = 2 + 1.5x$ 上：\n- 对于 $(0, 2)$: $2 = 2 + 1.5(0)$。正确。\n- 对于 $(1, 3.5)$: $3.5 = 2 + 1.5(1)$。正确。\n- 对于 $(2, 5)$: $5 = 2 + 1.5(2)$。正确。\n- 对于 $(3, 6.5)$: $6.5 = 2 + 1.5(3)$。正确。\n由于所有其余的点都完全落在直线 $y = 2 + 1.5x$ 上，因此对这个数据子集的 OLS 拟合将恰好得出 $\\hat{\\beta}_{0,(5)} = 2$ 和 $\\hat{\\beta}_{1,(5)} = 1.5$。\n原始的线是 $\\hat{y} \\approx 1.610 + 1.771 x$。移除点 5 后，线变为 $\\hat{y}_{(5)} = 2 + 1.5 x$，这正是总体回归线。因此，移除该点会使最小二乘线更接近总体线。陈述的两个部分都为真。\n\n结论：**正确**。\n\n**B. $x = 3$ 的观测值具有最大的库克距离，因为它在非罕见 $x$ 值中具有最大的残差绝对值。**\n\n我们已经确定观测值 5 ($x=8$) 极具影响力，并将具有最大的库克距离。让我们计算所有点的残差来验证第二个论断。\n$\\hat{y}_i = \\frac{95}{59} + \\frac{209}{118} x_i$。\n- $r_1 (x=0): 2 - \\frac{95}{59} = \\frac{23}{59} \\approx 0.390$\n- $r_2 (x=1): 3.5 - (\\frac{95}{59} + \\frac{209}{118}) = 3.5 - \\frac{399}{118} = \\frac{413-399}{118} = \\frac{14}{118} = \\frac{7}{59} \\approx 0.119$\n- $r_3, r_6 (x=2): 5 - (\\frac{95}{59} + \\frac{209}{118} \\cdot 2) = 5 - \\frac{608}{118} = \\frac{590-608}{118} = -\\frac{18}{118} = -\\frac{9}{59} \\approx -0.153$\n- $r_4 (x=3): 6.5 - (\\frac{95}{59} + \\frac{209}{118} \\cdot 3) = 6.5 - \\frac{817}{118} = \\frac{767-817}{118} = -\\frac{50}{118} = -\\frac{25}{59} \\approx -0.424$\n非罕见 $x$ 值的残差绝对值为 $|r_1| \\approx 0.390$，$|r_2| \\approx 0.119$，$|r_{3,6}| \\approx 0.153$ 和 $|r_4| \\approx 0.424$。点 4 ($x=3$) 在这些点中确实具有最大的残差绝对值。然而，它的库克距离远小于点 5 的库克距离。“因为...”这个前提是正确的，但主要结论是错误的。整个陈述是错误的。\n\n结论：**不正确**。\n\n**C. 库克距离仅取决于残差平方 $r_i^2$；两个具有相同残差的点，无论其 $x_i$ 值如何，都将具有相同的库克距离。**\n\n库克距离的公式是 $D_i = \\frac{r_i^2}{p \\cdot \\text{MSE}} \\left[ \\frac{h_{ii}}{(1-h_{ii})^2} \\right]$。它清楚地表明 $D_i$ 是残差平方 $r_i^2$ 和杠杆值 $h_{ii}$ 两者的函数。杠杆值 $h_{ii}$ 是 $x_i$ 与均值 $\\bar{x}$ 距离的函数。因此，两个具有相同残差但不同 $x_i$ 值的点将具有不同的杠杆值，从而具有不同的库克距离。该陈述根本上不正确。\n\n结论：**不正确**。\n\n**D. 当 $x_i$ 非常接近样本均值 $\\bar{x}$ 时，会产生高杠杆值；因此，罕见的 $x = 8$ 点具有低杠杆值。**\n\n杠杆值的公式是 $h_{ii} = \\frac{1}{n} + \\frac{(x_i - \\bar{x})^2}{\\sum_{j=1}^n (x_j - \\bar{x})^2}$。这个公式表明，随着 $(x_i - \\bar{x})^2$（即 $x_i$ 与样本均值 $\\bar{x}$ 的距离平方）的增加，杠杆值也增加。该陈述声称的恰恰相反。$x_i$ 值远离 $\\bar{x}$ 的点具有高杠杆值。点 $x_5=8$ 距离 $\\bar{x} = 8/3$ 最远，因此它具有最高的杠杆值，而不是低杠杆值。我们的计算证实了这一点：$h_{55} \\approx 0.890$。\n\n结论：**不正确**。\n\n**E. 根据计算出的库克距离，所有点都低于启发式阈值 $4/n$；因此没有观测值是有影响的。**\n\n识别影响点的一个常用启发式方法是检查是否 $D_i > 4/n$。\n在这个问题中，$n=6$，所以阈值是 $4/6 = 2/3 \\approx 0.667$。\n让我们计算点 5 的库克距离。\n我们需要 MSE：$\\text{MSE} = \\frac{\\sum r_i^2}{n-p} = \\frac{1}{4} \\sum r_i^2$。\n$\\sum r_i^2 = \\frac{1}{59^2} (23^2 + 7^2 + (-9)^2 + (-25)^2 + 13^2 + (-9)^2) = \\frac{529+49+81+625+169+81}{3481} = \\frac{1534}{3481}$。\n$\\text{MSE} = \\frac{1}{4} \\frac{1534}{3481} = \\frac{767}{2 \\cdot 3481} = \\frac{767}{6962} \\approx 0.110$。\n$p \\cdot \\text{MSE} = 2 \\cdot \\frac{767}{6962} = \\frac{767}{3481}$。\n$$ D_5 = \\frac{r_5^2}{p \\cdot \\text{MSE}} \\left[ \\frac{h_{55}}{(1-h_{55})^2} \\right] = \\frac{(13/59)^2}{767/3481} \\left[ \\frac{315/354}{(1 - 315/354)^2} \\right] $$\n$$ D_5 = \\frac{169/3481}{767/3481} \\left[ \\frac{315/354}{(39/354)^2} \\right] = \\frac{169}{767} \\frac{315 \\cdot 354}{39^2} = \\frac{12390}{767} \\approx 16.15 $$\n由于 $D_5 \\approx 16.15$ 远大于阈值 $4/6 \\approx 0.667$，所以“所有点都低于阈值”的陈述是错误的。观测值 5 具有高影响力。\n\n结论：**不正确**。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}