{
    "hands_on_practices": [
        {
            "introduction": "理解抽象概念的最佳方式往往始于一个具体的例子。本练习为探索病态系统提供了一个切实的起点 。通过处理一个简单的 $2 \\times 2$ 矩阵，你将亲手构造一个微小的扰动，并观察到它如何导致解发生不成比例的巨大变化，这正是高灵敏度的标志。这项动手计算将帮助你在转向更复杂场景之前，为理解条件数的含义建立起坚实的直觉。",
            "id": "2428587",
            "problem": "在计算工程中，线性系统的条件数通过其解对数据中微小扰动的敏感程度来评估。考虑$\\mathbb{R}^{2}$中的线性系统$A x = b$，其中\n$$\nA = \\begin{pmatrix} 1 & 1 \\\\ 1 & 1.05 \\end{pmatrix}, \\qquad b = \\begin{pmatrix} 1 \\\\ 1.015 \\end{pmatrix}.\n$$\n全程使用欧几里得向量范数和诱导矩阵范数（矩阵$2$-范数）。\n\n1) 从解的敏感性和诱导范数的定义出发，通过显式构造来验证：存在一个相对大小为 $\\|\\Delta b\\|_{2}/\\|b\\|_{2} = 0.01$ 的扰动 $\\Delta b$，使得 $A \\tilde{x} = b + \\Delta b$ 的解 $\\tilde{x}$ 与 $A x = b$ 的解 $x$ 位于 $\\mathbb{R}^{2}$ 的不同开象限中。你必须显式地构造 $\\Delta b$ 并从第一性原理出发证明每一步。\n\n2) 使用矩阵$2$-范数下条件数的定义，并且不使用任何未经证明的简化公式，计算给定矩阵 $A$ 的条件数 $\\kappa_{2}(A)$。\n\n最终答案仅提供 $\\kappa_{2}(A)$ 的数值，四舍五入到四位有效数字。不需要单位。",
            "solution": "对问题陈述进行验证。\n\n逐字提取的已知条件如下：\n- 线性系统：$A x = b$ 在 $\\mathbb{R}^{2}$ 中。\n- 矩阵：$A = \\begin{pmatrix} 1 & 1 \\\\ 1 & 1.05 \\end{pmatrix}$。\n- 向量：$b = \\begin{pmatrix} 1 \\\\ 1.015 \\end{pmatrix}$。\n- 范数：欧几里得向量范数（$\\|\\cdot\\|_{2}$）和诱导矩阵范数（$2$-范数）。\n- 扰动系统：$A \\tilde{x} = b + \\Delta b$。\n- 扰动约束：$\\|\\Delta b\\|_{2}/\\|b\\|_{2} = 0.01$。\n- 任务1：构造 $\\Delta b$ 使得 $\\tilde{x}$ 和 $x$ 位于不同的开象限。\n- 任务2：根据定义计算条件数 $\\kappa_{2}(A)$。\n\n验证结论：\n该问题具有科学依据，是适定且客观的。它提出了一个关于线性系统敏感性的数值线性代数标准练习，这是计算工程中的一个核心主题。矩阵 $A$ 是可逆的，因为其行列式为 $\\det(A) = (1)(1.05) - (1)(1) = 0.05 \\neq 0$，确保存在唯一解。所有数据和约束都已提供，没有矛盾或歧义。该问题是有效的。\n\n解题过程如下。\n\n第1部分：构造一个合适的扰动 $\\Delta b$。\n\n首先，我们求解未扰动的系统 $A x = b$ 以找到原始解 $x$。\n$$\n\\begin{pmatrix} 1 & 1 \\\\ 1 & 1.05 \\end{pmatrix} \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1.015 \\end{pmatrix}\n$$\n这对应于方程组：\n$x_1 + x_2 = 1$\n$x_1 + 1.05 x_2 = 1.015$\n\n第二个方程减去第一个方程得到：\n$(x_1 + 1.05 x_2) - (x_1 + x_2) = 1.015 - 1$\n$0.05 x_2 = 0.015$\n$x_2 = \\frac{0.015}{0.05} = \\frac{15}{50} = \\frac{3}{10} = 0.3$。\n\n将 $x_2 = 0.3$ 代入第一个方程：\n$x_1 + 0.3 = 1 \\implies x_1 = 0.7$。\n\n解为 $x = \\begin{pmatrix} 0.7 \\\\ 0.3 \\end{pmatrix}$。由于 $x_1 > 0$ 且 $x_2 > 0$，该向量位于 $\\mathbb{R}^{2}$ 的第一开象限。\n\n接下来，我们分析扰动系统 $A \\tilde{x} = b + \\Delta b$。解为 $\\tilde{x} = A^{-1}(b + \\Delta b) = A^{-1}b + A^{-1}\\Delta b = x + \\Delta x$，其中 $\\Delta x = A^{-1}\\Delta b$。我们必须构造一个扰动 $\\Delta b$ 使得 $\\tilde{x}$ 位于不同的开象限。例如，我们可以目标定在第四象限，这要求 $\\tilde{x}_1 > 0$ 和 $\\tilde{x}_2 < 0$。\n\n新解的分量为 $\\tilde{x}_1 = x_1 + \\Delta x_1 = 0.7 + \\Delta x_1$ 和 $\\tilde{x}_2 = x_2 + \\Delta x_2 = 0.3 + \\Delta x_2$。要移动到第四象限，我们需要 $\\tilde{x}_2 < 0$，这意味着 $0.3 + \\Delta x_2 < 0$，即 $\\Delta x_2 < -0.3$。\n\n为了找到 $\\Delta x$ 和 $\\Delta b$ 之间的关系，我们必须计算 $A$ 的逆矩阵。\n$$\nA^{-1} = \\frac{1}{\\det(A)} \\begin{pmatrix} 1.05 & -1 \\\\ -1 & 1 \\end{pmatrix} = \\frac{1}{0.05} \\begin{pmatrix} 1.05 & -1 \\\\ -1 & 1 \\end{pmatrix} = 20 \\begin{pmatrix} 1.05 & -1 \\\\ -1 & 1 \\end{pmatrix} = \\begin{pmatrix} 21 & -20 \\\\ -20 & 20 \\end{pmatrix}.\n$$\n解的变化为 $\\Delta x = \\begin{pmatrix} \\Delta x_1 \\\\ \\Delta x_2 \\end{pmatrix} = A^{-1} \\Delta b = \\begin{pmatrix} 21 & -20 \\\\ -20 & 20 \\end{pmatrix} \\begin{pmatrix} \\Delta b_1 \\\\ \\Delta b_2 \\end{pmatrix}$。\n第二个分量是 $\\Delta x_2 = -20 \\Delta b_1 + 20 \\Delta b_2 = 20(\\Delta b_2 - \\Delta b_1)$。我们的条件 $\\Delta x_2 < -0.3$ 变为 $20(\\Delta b_2 - \\Delta b_1) < -0.3$，简化为 $\\Delta b_2 - \\Delta b_1 < -0.015$。\n\n扰动 $\\Delta b$ 还必须满足相对大小约束 $\\|\\Delta b\\|_{2} / \\|b\\|_{2} = 0.01$。首先，我们计算 $b$ 的范数。\n$$\n\\|b\\|_{2}^{2} = 1^{2} + 1.015^{2} = 1 + 1.030225 = 2.030225.\n$$\n所以，$\\|b\\|_{2} = \\sqrt{2.030225}$。\n对 $\\Delta b$ 的约束是 $\\|\\Delta b\\|_{2} = 0.01 \\|b\\|_{2} = 0.01 \\sqrt{2.030225}$。这意味着 $\\|\\Delta b\\|_{2}^{2} = (0.01)^{2} (2.030225) = 0.0002030225$。\n\n我们需要找到一个向量 $\\Delta b = \\begin{pmatrix} \\Delta b_1 \\\\ \\Delta b_2 \\end{pmatrix}$，它同时满足 $\\Delta b_2 - \\Delta b_1 < -0.015$ 和 $\\Delta b_1^2 + \\Delta b_2^2 = 0.0002030225$。\n为了在固定范数下使 $\\Delta b_2 - \\Delta b_1$ 的值最小化（即尽可能负），$\\Delta b$ 的方向应与向量 $\\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}$ 同向。因此，我们选择 $\\Delta b$ 的方向与单位向量 $\\begin{pmatrix} 1/\\sqrt{2} \\\\ -1/\\sqrt{2} \\end{pmatrix}$ 相同。\n\n令 $\\Delta b = R \\begin{pmatrix} 1/\\sqrt{2} \\\\ -1/\\sqrt{2} \\end{pmatrix}$，其中 $R = \\|\\Delta b\\|_{2} = 0.01 \\sqrt{2.030225}$。\n所以，$\\Delta b_1 = \\frac{R}{\\sqrt{2}}$ 且 $\\Delta b_2 = -\\frac{R}{\\sqrt{2}}$。\n该向量显式为：\n$$\n\\Delta b = \\frac{0.01 \\sqrt{2.030225}}{\\sqrt{2}} \\begin{pmatrix} 1 \\\\ -1 \\end{pmatrix}.\n$$\n让我们验证这个构造。范数为 $\\|\\Delta b\\|_{2} = \\sqrt{(\\frac{R}{\\sqrt{2}})^2 + (-\\frac{R}{\\sqrt{2}})^2} = \\sqrt{\\frac{R^2}{2} + \\frac{R^2}{2}} = R$，根据构造这是正确的。\n现在检查分量的条件：\n$\\Delta b_2 - \\Delta b_1 = -\\frac{R}{\\sqrt{2}} - \\frac{R}{\\sqrt{2}} = -\\frac{2R}{\\sqrt{2}} = -R\\sqrt{2}$。\n代入 $R = 0.01 \\sqrt{2.030225}$：\n$$\n\\Delta b_2 - \\Delta b_1 = -(0.01 \\sqrt{2.030225})\\sqrt{2} = -0.01 \\sqrt{4.06045}.\n$$\n由于 $2^2=4$，我们有 $\\sqrt{4.06045} > 2$。因此，$\\Delta b_2 - \\Delta b_1 < -0.01 \\times 2 = -0.02$。因为 $-0.02 < -0.015$，我们的条件得到满足。\n让我们计算解向量 $x$ 的变化。\n$\\Delta x_2 = 20(\\Delta b_2 - \\Delta b_1) = 20(-0.01\\sqrt{4.06045}) = -0.2\\sqrt{4.06045}$。\n数值上，$\\Delta x_2 \\approx -0.2 \\times 2.01505... \\approx -0.403$。\n新分量 $\\tilde{x}_2 = x_2 + \\Delta x_2 = 0.3 + \\Delta x_2 \\approx 0.3 - 0.403 = -0.103 < 0$。\n\n为求完整，我们检查 $\\tilde{x}_1$。\n$\\Delta x_1 = 21 \\Delta b_1 - 20 \\Delta b_2 = 21(\\frac{R}{\\sqrt{2}}) - 20(-\\frac{R}{\\sqrt{2}}) = \\frac{41R}{\\sqrt{2}} = \\frac{41(0.01\\sqrt{2.030225})}{\\sqrt{2}} > 0$。\n所以 $\\tilde{x}_1 = x_1 + \\Delta x_1 > 0.7 > 0$。\n新解 $\\tilde{x}$ 的分量为 $\\tilde{x}_1 > 0$ 和 $\\tilde{x}_2 < 0$，使其位于第四象限。构造有效。\n\n第2部分：计算条件数 $\\kappa_{2}(A)$。\n\n矩阵$2$-范数下的条件数定义为 $\\kappa_{2}(A) = \\|A\\|_{2}\\|A^{-1}\\|_{2}$。\n问题要求从第一性原理计算，而不是使用未经证明的简化公式。矩阵 $M$ 的矩阵$2$-范数（或谱范数）定义为其最大奇异值，$\\|M\\|_{2} = \\sigma_{\\max}(M) = \\sqrt{\\lambda_{\\max}(M^{T}M)}$，其中 $\\lambda_{\\max}(M^{T}M)$ 是 $M^{T}M$ 的最大特征值。\n\n给定矩阵 $A = \\begin{pmatrix} 1 & 1 \\\\ 1 & 1.05 \\end{pmatrix}$ 是一个对称矩阵，即 $A = A^{T}$。\n对于对称矩阵 $A$，乘积 $A^{T}A$ 变为 $A^{2}$。\n$A^{2}$ 的特征值是 $A$ 的特征值的平方。如果 $\\lambda$ 是 $A$ 的一个特征值，其特征向量为 $v$，则 $A^{2}v = A(Av) = A(\\lambda v) = \\lambda(Av) = \\lambda^2 v$。\n因此，$\\lambda_{\\max}(A^{T}A) = \\lambda_{\\max}(A^{2}) = (\\max_i |\\lambda_i(A)|)^{2}$，其中 $\\lambda_i(A)$ 是 $A$ 的特征值。\n因此，对于对称矩阵 $A$，其$2$-范数是最大绝对特征值：\n$$\n\\|A\\|_{2} = \\sqrt{(\\max_i |\\lambda_i(A)|)^{2}} = \\max_i |\\lambda_i(A)|.\n$$\n逆矩阵 $A^{-1}$ 也是对称的。其特征值是 $A$ 的特征值的倒数。\n所以，$\\|A^{-1}\\|_{2} = \\max_i |1/\\lambda_i(A)| = 1 / \\min_i |\\lambda_i(A)|$。\n这在 $A$ 可逆的情况下成立，而 $A$ 确实是可逆的。\n综合这些结果，对称矩阵 $A$ 的条件数是其最大绝对特征值与最小绝对特征值的比率：\n$$\n\\kappa_{2}(A) = \\frac{\\max_i |\\lambda_i(A)|}{\\min_i |\\lambda_i(A)|}.\n$$\n我们现在通过求解特征方程 $\\det(A - \\lambda I) = 0$ 来找到 $A$ 的特征值。\n$$\n\\det\\begin{pmatrix} 1-\\lambda & 1 \\\\ 1 & 1.05-\\lambda \\end{pmatrix} = (1-\\lambda)(1.05-\\lambda) - 1 = 0.\n$$\n$$\n\\lambda^{2} - 1.05\\lambda - \\lambda + 1.05 - 1 = 0\n$$\n$$\n\\lambda^{2} - 2.05\\lambda + 0.05 = 0.\n$$\n使用二次公式，$\\lambda = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$：\n$$\n\\lambda = \\frac{2.05 \\pm \\sqrt{(-2.05)^{2} - 4(1)(0.05)}}{2} = \\frac{2.05 \\pm \\sqrt{4.2025 - 0.2}}{2} = \\frac{2.05 \\pm \\sqrt{4.0025}}{2}.\n$$\n$A$ 的迹（$2.05 > 0$）和行列式（$0.05 > 0$）都为正，所以 $A$ 是正定矩阵，其特征值也为正。\n最大和最小特征值是：\n$$\n\\lambda_{\\max} = \\frac{2.05 + \\sqrt{4.0025}}{2}\n$$\n$$\n\\lambda_{\\min} = \\frac{2.05 - \\sqrt{4.0025}}{2}\n$$\n条件数是它们的比值：\n$$\n\\kappa_{2}(A) = \\frac{\\lambda_{\\max}}{\\lambda_{\\min}} = \\frac{(2.05 + \\sqrt{4.0025})/2}{(2.05 - \\sqrt{4.0025})/2} = \\frac{2.05 + \\sqrt{4.0025}}{2.05 - \\sqrt{4.0025}}.\n$$\n计算数值：\n$\\sqrt{4.0025} \\approx 2.0006249377...$\n$$\n\\kappa_{2}(A) \\approx \\frac{2.05 + 2.0006249377}{2.05 - 2.0006249377} = \\frac{4.0506249377}{0.0493750623} \\approx 82.038160...\n$$\n四舍五入到四位有效数字，我们得到 $82.04$。",
            "answer": "$$\\boxed{82.04}$$"
        },
        {
            "introduction": "线性系统的稳定性不仅是其背后物理原理的固有属性，也可能受到我们构建数学模型方式的显著影响。本练习有力地阐释了这一原则，展示了改变度量单位（例如从米到毫米）这样一个简单的举动，如何能急剧改变系统矩阵的条件数 。通过这个练习，你将认识到在模型建立阶段做出的选择对于确保数值稳健性至关重要。",
            "id": "2381774",
            "problem": "一根长度为 $L$ 的直细长梁，在 $x=0$ 处被夹紧，并在一个轻微载荷作用下产生微小的横向挠度 $y(x)$。在 $x=0$ 和 $x=L$ 这两个位置之间的短区间上，一位工程师将挠度建模为线性关系 $y(x) = ax + b$，其中 $a$ 和 $b$ 是未知常数。在位置 $x=0$ 和 $x=L$ 处对挠度进行了两次测量，得到了一个关于参数矢量 $(a,b)^{\\mathsf{T}}$ 的 $2\\times 2$ 线性系统，其系统矩阵为\n$$\nA = \\begin{pmatrix}\nx_1 & 1 \\\\\nx_2 & 1\n\\end{pmatrix},\n$$\n其中 $x_1 = 0$ 且 $x_2 = L$。考虑 $L = 1$ 米的情况。现在，假设同样地，这些物理位置用毫米记录，那么当 $L$ 表示为 $1000$ 毫米时，位置的数值变为 $x_1' = 0$ 和 $x_2' = 1000$。这只改变了系统矩阵的数值项（而不是物理过程）。设 $A_{\\mathrm{m}}$ 表示使用米为单位的位置构建的矩阵，而 $A_{\\mathrm{mm}}$ 表示使用毫米为单位的位置构建的矩阵。\n\n计算矩阵 $2$-范数下条件数的比率 $\\kappa_{2}(A_{\\mathrm{mm}})/\\kappa_{2}(A_{\\mathrm{m}})$。将你的最终答案四舍五入到四位有效数字。最终答案是一个无单位的实数。",
            "solution": "首先必须验证问题陈述的科学性和逻辑完整性。\n\n步骤 1：提取已知条件\n- 一根长度为 $L$ 的直细长梁。\n- 在 $x=0$ 处被夹紧。\n- 微小的横向挠度被建模为线性关系：$y(x) = ax + b$。\n- 待定参数：$(a,b)^{\\mathsf{T}}$。\n- 在位置 $x=0$ 和 $x=L$ 处进行两次测量。\n- 参数的线性系统有一个系统矩阵 $A = \\begin{pmatrix} x_1 & 1 \\\\ x_2 & 1 \\end{pmatrix}$，其中 $x_1=0$ 且 $x_2=L$。\n- 情况 1 (米)：$L = 1$ 米，得到 $x_1=0$, $x_2=1$。该矩阵记为 $A_{\\mathrm{m}}$。\n- 情况 2 (毫米)：同样的物理长度 $L$ 表示为 $1000$ 毫米。位置的数值为 $x_1' = 0$, $x_2' = 1000$。该矩阵记为 $A_{\\mathrm{mm}}$。\n- 任务是计算矩阵 $2$-范数下条件数的比率：$\\kappa_{2}(A_{\\mathrm{mm}})/\\kappa_{2}(A_{\\mathrm{m}})$。\n- 最终答案必须是一个无单位的实数，并四舍五入到四位有效数字。\n\n步骤 2：使用提取的已知条件进行验证\n将夹紧梁的挠度建模为 $y(x) = ax+b$ 的物理前提是一个粗略的简化。一个物理上精确的夹紧梁模型需要满足 $y(0)=0$ 和斜率 $y'(0)=0$。如果 $b=0$，线性模型可以满足 $y(0)=0$，但除非 $a=0$（这意味着零挠度），否则它不能满足 $y'(0)=0$。然而，这个问题不是一个固体力学问题，而是一个数值线性代数问题。它提出了一个关于“工程师建模的”特定线性系统的数值稳定性问题，而无需考虑该模型对底层物理过程的保真度。关于条件数对坐标缩放依赖性的核心数学问题是适定的、客观的，并且在计算科学领域内有其科学依据。该问题是自洽的，提供了所有必要的信息，并且其解是唯一的、可验证的。因此，该问题被认为是有效的。\n\n步骤 3：结论与行动\n该问题有效。我将继续进行求解。\n\n问题要求计算两个矩阵的 $2$-范数条件数的比率。$2$-范数下的条件数定义为 $\\kappa_2(A) = \\|A\\|_2 \\|A^{-1}\\|_2$。对于一个可逆矩阵 $A$，这等价于其最大奇异值与最小奇异值的比率，即 $\\kappa_2(A) = \\sigma_{\\max}(A) / \\sigma_{\\min}(A)$。$A$ 的奇异值是矩阵 $A^{\\mathsf{T}}A$ 的特征值的平方根。\n\n让我们考虑问题中给定形式的一般矩阵，其中 $x_1=0$ 且 $x_2=L$：\n$$\nA_L = \\begin{pmatrix} 0 & 1 \\\\ L & 1 \\end{pmatrix}\n$$\n我们首先计算 $A_L^{\\mathsf{T}}A_L$：\n$$\nA_L^{\\mathsf{T}}A_L = \\begin{pmatrix} 0 & L \\\\ 1 & 1 \\end{pmatrix} \\begin{pmatrix} 0 & 1 \\\\ L & 1 \\end{pmatrix} = \\begin{pmatrix} L^2 & L \\\\ L & 2 \\end{pmatrix}\n$$\n接下来，我们通过求解特征方程 $\\det(A_L^{\\mathsf{T}}A_L - \\lambda I) = 0$ 来求这个对称矩阵的特征值：\n$$\n\\det \\begin{pmatrix} L^2 - \\lambda & L \\\\ L & 2 - \\lambda \\end{pmatrix} = 0\n$$\n$$\n(L^2 - \\lambda)(2 - \\lambda) - L^2 = 0\n$$\n$$\n2L^2 - L^2\\lambda - 2\\lambda + \\lambda^2 - L^2 = 0\n$$\n$$\n\\lambda^2 - (L^2 + 2)\\lambda + L^2 = 0\n$$\n$A_L^{\\mathsf{T}}A_L$ 的特征值，记为 $\\lambda_{\\pm}$，由二次方程求根公式给出：\n$$\n\\lambda_{\\pm} = \\frac{(L^2 + 2) \\pm \\sqrt{(L^2 + 2)^2 - 4L^2}}{2} = \\frac{(L^2 + 2) \\pm \\sqrt{L^4 + 4L^2 + 4 - 4L^2}}{2} = \\frac{L^2 + 2 \\pm \\sqrt{L^4 + 4}}{2}\n$$\n$A_L$ 的奇异值为 $\\sigma_{\\pm} = \\sqrt{\\lambda_{\\pm}}$。条件数 $\\kappa_2(A_L)$ 是最大奇异值与最小奇异值的比率：\n$$\n\\kappa_2(A_L) = \\frac{\\sigma_+}{\\sigma_-} = \\sqrt{\\frac{\\lambda_+}{\\lambda_-}} = \\sqrt{\\frac{L^2 + 2 + \\sqrt{L^4 + 4}}{L^2 + 2 - \\sqrt{L^4 + 4}}}\n$$\n为简化此表达式，我们将平方根内的分子和分母同乘以分母的共轭项：\n$$\n\\kappa_2(A_L)^2 = \\frac{L^2 + 2 + \\sqrt{L^4 + 4}}{L^2 + 2 - \\sqrt{L^4 + 4}} \\cdot \\frac{L^2 + 2 + \\sqrt{L^4 + 4}}{L^2 + 2 + \\sqrt{L^4 + 4}} = \\frac{(L^2 + 2 + \\sqrt{L^4 + 4})^2}{(L^2 + 2)^2 - (L^4 + 4)}\n$$\n$$\n\\kappa_2(A_L)^2 = \\frac{(L^2 + 2 + \\sqrt{L^4 + 4})^2}{L^4 + 4L^2 + 4 - L^4 - 4} = \\frac{(L^2 + 2 + \\sqrt{L^4 + 4})^2}{4L^2}\n$$\n取平方根，得到条件数的简化通用公式：\n$$\n\\kappa_2(A_L) = \\frac{L^2 + 2 + \\sqrt{L^4 + 4}}{2L}\n$$\n现在我们将此公式应用于两种情况。\n\n情况 1：矩阵 $A_{\\mathrm{m}}$，用米为单位的位置构建。这里，$L=1$：\n$$\n\\kappa_2(A_{\\mathrm{m}}) = \\kappa_2(A_{L=1}) = \\frac{1^2 + 2 + \\sqrt{1^4 + 4}}{2(1)} = \\frac{3 + \\sqrt{5}}{2}\n$$\n\n情况 2：矩阵 $A_{\\mathrm{mm}}$，用毫米为单位的位置构建。这里，$L=1000$：\n$$\n\\kappa_2(A_{\\mathrm{mm}}) = \\kappa_2(A_{L=1000}) = \\frac{1000^2 + 2 + \\sqrt{1000^4 + 4}}{2(1000)} = \\frac{1000002 + \\sqrt{10^{12} + 4}}{2000}\n$$\n所求的比率是 $\\kappa_{2}(A_{\\mathrm{mm}})/\\kappa_{2}(A_{\\mathrm{m}})$：\n$$\n\\frac{\\kappa_{2}(A_{\\mathrm{mm}})}{\\kappa_{2}(A_{\\mathrm{m}})} = \\frac{\\left( \\frac{1000002 + \\sqrt{10^{12} + 4}}{2000} \\right)}{\\left( \\frac{3 + \\sqrt{5}}{2} \\right)} = \\frac{1000002 + \\sqrt{10^{12} + 4}}{1000(3 + \\sqrt{5})}\n$$\n我们现在对这个表达式进行数值计算。\n首先，分母：\n$3 + \\sqrt{5} \\approx 3 + 2.236067977 = 5.236067977$\n$1000(3 + \\sqrt{5}) \\approx 5236.067977$\n接下来，分子：\n$\\sqrt{10^{12} + 4} = 10^6 \\sqrt{1 + 4 \\times 10^{-12}} \\approx 10^6 (1 + \\frac{1}{2} \\cdot 4 \\times 10^{-12}) = 10^6 + 2 \\times 10^{-6} = 1000000.000002$\n$1000002 + \\sqrt{10^{12} + 4} \\approx 1000002 + 1000000.000002 = 2000002.000002$\n比率约为：\n$$\n\\frac{2000002.000002}{5236.067977} \\approx 381.96699933\n$$\n将此结果四舍五入到四位有效数字，得到 $382.0$。",
            "answer": "$$\n\\boxed{382.0}\n$$"
        },
        {
            "introduction": "在数值分析中，有些问题因其计算难度而臭名昭著，并成为检验算法性能的“试金石”。希尔伯特矩阵 (Hilbert matrix) 就是一个极端病态的典型例子 。本次计算实践将引导你深入研究希尔伯特矩阵，并观察一个关键且常常违反直觉的现象：即使计算出的数值解的残差极小（意味着它几乎完美地满足方程），它也可能与真实解相去甚远。这个练习突显了条件数作为衡量解精度的指标，比单独依赖残差更为可靠。",
            "id": "2381734",
            "problem": "要求您使用 Hilbert 矩阵（一个典型的病态矩阵示例）来研究求解线性系统时的数值敏感性。请完全使用纯数学术语进行分析，并报告不带物理单位的数值结果。本说明中的所有数学符号均按标准方式解释：线性系统写作 $A x = b$，向量或矩阵的2-范数表示为 $\\lVert \\cdot \\rVert_2$，2-范数条件数表示为 $\\kappa_2(A)$。Hilbert 矩阵 $H \\in \\mathbb{R}^{n \\times n}$ 的元素定义为 $H_{ij} = 1/(i + j - 1)$，其中 $i,j \\in \\{1,\\dots,n\\}$。\n\n任务。对于每个测试用例，您需要：\n1. 构造大小为 $n$ 的 Hilbert 矩阵 $H$。\n2. 根据奇异值的定义计算2-范数条件数 $\\kappa_2(H)$。\n3. 将真实解设为 $x_{\\text{true}} = \\mathbf{1} \\in \\mathbb{R}^n$ (所有元素均为1的向量)，并构造右端项 $b = H x_{\\text{true}}$。\n4. 使用直接求解器在浮点运算中求解线性系统 $H \\hat{x} = b$，以获得数值解 $\\hat{x}$。\n5. 计算相对前向误差 $e_{\\text{fwd}} = \\lVert \\hat{x} - x_{\\text{true}} \\rVert_2 / \\lVert x_{\\text{true}} \\rVert_2$。\n6. 计算相对残差 $r_{\\text{rel}} = \\lVert H \\hat{x} - b \\rVert_2 / \\lVert b \\rVert_2$。\n7. 按如下方式构造一个相对大小为 $\\varepsilon_{\\text{rel}}$ 的确定性扰动。令 $v \\in \\mathbb{R}^n$ 的分量为 $v_i = (-1)^{i-1}$，其中 $i \\in \\{1,\\dots,n\\}$。定义一个缩放的扰动方向 $p = \\lVert b \\rVert_2 \\, v / \\lVert v \\rVert_2$，使得 $\\lVert p \\rVert_2 = \\lVert b \\rVert_2$。构造受扰动的右端项 $b_{\\text{pert}} = b + \\varepsilon_{\\text{rel}} \\, p$。\n8. 使用相同的直接求解器求解 $H \\tilde{x} = b_{\\text{pert}}$ 以得到 $\\tilde{x}$。\n9. 将解中观察到的扰动放大因子量化为 $A = \\big( \\lVert \\tilde{x} - \\hat{x} \\rVert_2 / \\lVert x_{\\text{true}} \\rVert_2 \\big) / \\varepsilon_{\\text{rel}}$。\n\n原理。步骤5和6区分了计算解的前向误差和线性系统的残差，强调了对于病态矩阵，小的残差并不一定意味着小的前向误差。步骤7-9通过比较解的相对变化与数据的相对变化，经验性地评估解相对于 $b$ 中扰动的敏感性。\n\n测试集。使用以下参数对 $(n,\\varepsilon_{\\text{rel}})$ 列表：\n- $(n,\\varepsilon_{\\text{rel}}) = (3, 1\\times 10^{-12})$,\n- $(n,\\varepsilon_{\\text{rel}}) = (10, 1\\times 10^{-10})$,\n- $(n,\\varepsilon_{\\text{rel}}) = (12, 1\\times 10^{-10})$.\n\n答案规格。对于每个测试用例，按此顺序计算四个标量：\n- $\\kappa_2(H)$,\n- $e_{\\text{fwd}}$,\n- $r_{\\text{rel}}$,\n- $A$.\n\n最终输出格式。您的程序应生成单行输出，其中包含一个逗号分隔的列表，包含所有十二个数字（每个测试用例四个数字，按上述测试用例顺序排列），并用方括号括起来。也就是说，输出必须是以下形式：\n`[ \\kappa_2(H_{n_1}), e_{\\text{fwd},n_1}, r_{\\text{rel},n_1}, A_{n_1}, \\kappa_2(H_{n_2}), e_{\\text{fwd},n_2}, r_{\\text{rel},n_2}, A_{n_2}, \\kappa_2(H_{n_3}), e_{\\text{fwd},n_3}, r_{\\text{rel},n_3}, A_{n_3} ]`。\n不应打印任何额外文本。角度和物理单位不适用；所有值都是无量纲实数。程序必须是一个完整的、可运行的脚本，执行所有计算并完全按照指定格式打印最后一行。",
            "solution": "问题陈述是有效的。它在科学上基于数值线性代数的原理，特别是关于病态线性系统的分析。问题是适定的、客观的，并提供了执行计算和得出唯一、可验证的数值结果所需的所有信息。任务是研究求解线性系统 $A x = b$ 的数值敏感性，其中矩阵 $A$ 是 Hilbert 矩阵 $H$，这是一个严重病态的经典例子。\n\n解决方案通过为每个测试用例 $(n, \\varepsilon_{\\text{rel}})$ 实现指定的任务序列来进行。所有计算均使用标准的双精度浮点运算执行。\n\n步骤1：Hilbert 矩阵构造\n对于给定的维度 $n$，构造 Hilbert 矩阵 $H \\in \\mathbb{R}^{n \\times n}$。其元素由公式定义：\n$$\nH_{ij} = \\frac{1}{i + j - 1} \\quad \\text{for } i, j \\in \\{1, 2, \\dots, n\\}\n$$\n在使用0基索引的计算环境中，这对应于 $H_{ij} = 1 / ((i+1) + (j+1) - 1) = 1 / (i+j+1)$，其中 $i,j \\in \\{0, 1, \\dots, n-1\\}$。\n\n步骤2：条件数计算\n2-范数条件数 $\\kappa_2(H)$ 是衡量线性系统解对输入数据变化的敏感程度的指标。它定义为矩阵的2-范数与其逆矩阵的2-范数的乘积，即 $\\kappa_2(H) = \\lVert H \\rVert_2 \\lVert H^{-1} \\rVert_2$。一种更数值稳定的计算方法，如题目所指定，是通过矩阵的奇异值。设 $H$ 的奇异值为 $\\sigma_1 \\ge \\sigma_2 \\ge \\dots \\ge \\sigma_n > 0$。则条件数是最大奇异值与最小奇异值之比：\n$$\n\\kappa_2(H) = \\frac{\\sigma_{\\max}(H)}{\\sigma_{\\min}(H)} = \\frac{\\sigma_1}{\\sigma_n}\n$$\n奇异值将使用奇异值分解 (SVD) 算法计算。\n\n步骤3：线性系统设置\n真实解被定义为一个所有元素均为1的向量，$x_{\\text{true}} = \\mathbf{1} \\in \\mathbb{R}^n$。然后通过执行矩阵-向量乘法来确定右端项向量 $b$：\n$$\nb = H x_{\\text{true}}\n$$\n\n步骤4：数值求解\n使用标准的直接数值求解器（例如基于带部分主元选择的 LU 分解的求解器）求解线性系统 $H \\hat{x} = b$ 以得到 $\\hat{x}$。由于 $H$ 的病态性质和浮点运算的限制，计算出的解 $\\hat{x}$ 将偏离真实解 $x_{\\text{true}}$。\n\n步骤5：相对前向误差\n相对前向误差 $e_{\\text{fwd}}$ 量化了计算解 $\\hat{x}$ 与真实解 $x_{\\text{true}}$ 的偏差，相对于真实解的范数。\n$$\ne_{\\text{fwd}} = \\frac{\\lVert \\hat{x} - x_{\\text{true}} \\rVert_2}{\\lVert x_{\\text{true}} \\rVert_2}\n$$\n\n步骤6：相对残差\n相对残差 $r_{\\text{rel}}$ 衡量计算解 $\\hat{x}$ 满足原始方程的程度。它是残差向量 $H \\hat{x} - b$ 的范数相对于原始右端项 $b$ 的范数。这也称为后向误差的一种度量。\n$$\nr_{\\text{rel}} = \\frac{\\lVert H \\hat{x} - b \\rVert_2}{\\lVert b \\rVert_2}\n$$\n对于病态系统，典型的特征是 $r_{\\text{rel}}$ 很小（接近机器精度），而 $e_{\\text{fwd}}$ 很大，这说明小的残差不能保证解的准确性。\n\n步骤7：扰动构造\n为了经验性地测试系统的敏感性，在右端项向量 $b$ 中引入一个确定性扰动。定义一个扰动方向向量 $v \\in \\mathbb{R}^n$，其分量交替变化，$v_i = (-1)^{i-1}$，其中 $i \\in \\{1, \\dots, n\\}$。该向量被缩放以形成一个范数等于 $b$ 范数的扰动 $p$：\n$$\np = \\frac{\\lVert b \\rVert_2}{\\lVert v \\rVert_2} v\n$$\n然后，通过添加这个按相对因子 $\\varepsilon_{\\text{rel}}$ 缩放的扰动来构造受扰动的右端项 $b_{\\text{pert}}$：\n$$\nb_{\\text{pert}} = b + \\varepsilon_{\\text{rel}} p\n$$\n此扰动的相对大小为 $\\lVert b_{\\text{pert}} - b \\rVert_2 / \\lVert b \\rVert_2 = \\varepsilon_{\\text{rel}}$。选择符号交替的 $v$ 是为了激发与 $H$ 的最小特征值相对应的特征向量（因为 $H$ 是对称正定矩阵，其奇异向量就是其特征向量），从而最大化系统对扰动的响应。\n\n步骤8：求解受扰动系统\n使用相同的直接求解器求解涉及受扰动右端项的新线性系统 $H \\tilde{x} = b_{\\text{pert}}$，以得到 $\\tilde{x}$。\n\n步骤9：放大因子\n计算观察到的放大因子 $A$。该因子衡量解的相对变化与右端项数据相对变化之比。解的变化以 $\\lVert \\tilde{x} - \\hat{x} \\rVert_2$ 衡量，并用 $\\lVert x_{\\text{true}} \\rVert_2$ 进行归一化。\n$$\nA = \\frac{\\left( \\frac{\\lVert \\tilde{x} - \\hat{x} \\rVert_2}{\\lVert x_{\\text{true}} \\rVert_2} \\right)}{\\varepsilon_{\\text{rel}}}\n$$\n条件数理论预测，这个放大因子 $A$ 可以大到与条件数 $\\kappa_2(H)$ 相当。本实验旨在观察这种关系。\n\n通过为每个 $(n, \\varepsilon_{\\text{rel}})$ 对执行这些步骤，我们将生成所需的十二个数值集合，这些数值表征了这个病态系统的行为。对于更大的 $n$，我们预计 $\\kappa_2(H)$ 会急剧增长，导致较大的前向误差 $e_{\\text{fwd}}$ 和与 $\\kappa_2(H)$ 量级相似的放大因子 $A$，即使相对残差 $r_{\\text{rel}}$ 保持很小。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem for the given test cases and prints the results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (3, 1e-12),\n        (10, 1e-10),\n        (12, 1e-10),\n    ]\n\n    results = []\n    for n, eps_rel in test_cases:\n        # Task 1: Construct the Hilbert matrix H.\n        # Use 0-based indexing for numpy arrays.\n        # H_ij = 1 / ((i+1) + (j+1) - 1) = 1 / (i + j + 1)\n        i, j = np.ogrid[0:n, 0:n]\n        H = 1.0 / (i + j + 1)\n\n        # Task 2: Compute the two-norm condition number kappa_2(H).\n        # This is done via singular values.\n        singular_values = np.linalg.svd(H, compute_uv=False)\n        kappa_2_H = singular_values[0] / singular_values[-1]\n\n        # Task 3: Set up the true solution and the right-hand side.\n        x_true = np.ones(n)\n        b = H @ x_true\n\n        # Task 4: Solve the linear system to get the numerical solution.\n        x_hat = np.linalg.solve(H, b)\n\n        # Task 5: Compute the relative forward error e_fwd.\n        norm_x_true = np.linalg.norm(x_true, 2)\n        e_fwd = np.linalg.norm(x_hat - x_true, 2) / norm_x_true\n\n        # Task 6: Compute the relative residual r_rel.\n        norm_b = np.linalg.norm(b, 2)\n        r_rel = np.linalg.norm(H @ x_hat - b, 2) / norm_b\n\n        # Task 7: Construct a deterministic perturbation to b.\n        # v_i = (-1)^(i-1) for 1-based index i.\n        # v_i = (-1)^i for 0-based index i.\n        v = (-1.0)**np.arange(n)\n        norm_v = np.linalg.norm(v, 2)\n        p = (norm_b / norm_v) * v\n        b_pert = b + eps_rel * p\n\n        # Task 8: Solve the perturbed system.\n        x_tilde = np.linalg.solve(H, b_pert)\n\n        # Task 9: Quantify the observed amplification factor A.\n        # Note: the problem defines the change relative to x_hat (tilde{x} - hat{x})\n        # but normalizes by x_true.\n        # A = ( ||x_tilde - x_hat|| / ||x_true|| ) / eps_rel\n        A = (np.linalg.norm(x_tilde - x_hat, 2) / norm_x_true) / eps_rel\n        \n        # Append the four required scalars for the current test case.\n        results.extend([kappa_2_H, e_fwd, r_rel, A])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}