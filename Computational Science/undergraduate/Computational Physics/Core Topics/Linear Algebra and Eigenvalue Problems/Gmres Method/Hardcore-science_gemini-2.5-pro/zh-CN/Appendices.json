{
    "hands_on_practices": [
        {
            "introduction": "GMRES方法的核心是在每一步中最小化残差的范数。要真正理解这一点，最好的方法就是亲手执行一次迭代。这个练习将指导你完成GMRES的第一步，从一个零初始猜测开始，计算出第一个近似解，从而揭示该方法背后的基本优化原理。",
            "id": "2214790",
            "problem": "广义最小残差法 (GMRES) 是一种迭代算法，用于求解线性方程组 $Ax=b$ 的近似解。考虑由矩阵 $A$ 和向量 $b$ 定义的线性系统：\n$$\nA = \\begin{pmatrix} 2  1 \\\\ -1  3 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}\n$$\n从初始猜测 $x_0 = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$ 开始，应用一步 GMRES 算法来求得第一个近似解 $x_1$。将您的答案表示为分量为有理数的列向量。",
            "solution": "GMRES 在仿射空间 $x_{0}+\\mathcal{K}_{1}(A,r_{0})$ 上最小化残差的 2-范数，其中 $r_{0}=b-Ax_{0}$ 且 $\\mathcal{K}_{1}(A,r_{0})=\\mathrm{span}\\{r_{0}\\}$。当 $x_{0}=\\begin{pmatrix}0\\\\0\\end{pmatrix}$ 时，我们有\n$$\nr_{0}=b=\\begin{pmatrix}1\\\\2\\end{pmatrix}.\n$$\n经过一步 GMRES 迭代后，$x_1$ 的形式为 $x_{1}=x_{0}+\\alpha r_{0}$，其中选择 $\\alpha$ 以最小化\n$$\n\\|b-A(x_{0}+\\alpha r_{0})\\|_{2}=\\|r_{0}-\\alpha A r_{0}\\|_{2}.\n$$\n令 $w=A r_{0}$。则最小化问题为 $\\min_{\\alpha}\\|r_{0}-\\alpha w\\|_{2}^{2}$。使用欧几里得内积，定义\n$$\n\\phi(\\alpha)=(r_{0}-\\alpha w)^{T}(r_{0}-\\alpha w)=r_{0}^{T}r_{0}-2\\alpha w^{T}r_{0}+\\alpha^{2}w^{T}w.\n$$\n令 $\\frac{d\\phi}{d\\alpha}=0$ 可得\n$$\n-2\\,w^{T}r_{0}+2\\alpha\\,w^{T}w=0 \\quad\\Rightarrow\\quad \\alpha=\\frac{w^{T}r_{0}}{w^{T}w}.\n$$\n计算 $w$ 和所需的内积：\n$$\nw=A r_{0}=A b=\\begin{pmatrix}2  1\\\\ -1  3\\end{pmatrix}\\begin{pmatrix}1\\\\2\\end{pmatrix}=\\begin{pmatrix}4\\\\5\\end{pmatrix},\\quad\nw^{T}r_{0}=\\begin{pmatrix}4  5\\end{pmatrix}\\begin{pmatrix}1\\\\2\\end{pmatrix}=14,\\quad\nw^{T}w=4^{2}+5^{2}=41.\n$$\n因此\n$$\n\\alpha=\\frac{14}{41},\\qquad x_{1}=x_{0}+\\alpha r_{0}=\\frac{14}{41}\\begin{pmatrix}1\\\\2\\end{pmatrix}=\\begin{pmatrix}\\frac{14}{41}\\\\ \\frac{28}{41}\\end{pmatrix}.\n$$\n这个 $x_1$ 是 GMRES(1) 的迭代解，即在 $x_{0}+\\mathrm{span}\\{r_{0}\\}$ 上残差范数的最小化子。",
            "answer": "$$\\boxed{\\begin{pmatrix}\\frac{14}{41}\\\\ \\frac{28}{41}\\end{pmatrix}}$$"
        },
        {
            "introduction": "在了解了GMRES如何逐步减小残差之后，探索一些看似“停滞”的特殊情况会非常有启发性。这个问题构建了一个场景，其中第一步迭代后残差范数并未减小。这并非算法的失败，而是问题几何特性的必然结果，它能加深我们对Krylov子空间和优化方向的理解。",
            "id": "2214807",
            "problem": "考虑使用迭代法求解线性方程组 $A\\mathbf{x} = \\mathbf{b}$ 的问题，其中矩阵 $A$ 和向量 $\\mathbf{b}$ 由下式给出：\n$$A = \\begin{pmatrix} 1  1 \\\\ -4  2 \\end{pmatrix}, \\quad \\mathbf{b} = \\begin{pmatrix} 2 \\\\ 1 \\end{pmatrix}$$\n该解使用广义最小残差（GMRES）方法进行近似。过程从初始猜测 $\\mathbf{x}_0 = \\mathbf{0}$ 开始。第 $k$ 次迭代的残差定义为 $\\mathbf{r}_k = \\mathbf{b} - A\\mathbf{x}_k$。\n\n计算比率 $\\frac{\\|\\mathbf{r}_1\\|_2}{\\|\\mathbf{r}_0\\|_2}$，其中 $\\|\\cdot\\|_2$ 表示向量的标准欧几里得范数。",
            "solution": "我们从初始猜测 $\\mathbf{x}_{0}=\\mathbf{0}$ 开始，因此初始残差为\n$$\n\\mathbf{r}_{0}=\\mathbf{b}-A\\mathbf{x}_{0}=\\mathbf{b}=\\begin{pmatrix}2\\\\1\\end{pmatrix}.\n$$\n在一次GMRES迭代中，搜索空间为 $\\mathcal{K}_{1}(A,\\mathbf{r}_{0})=\\operatorname{span}\\{\\mathbf{r}_{0}\\}$，所以下一个迭代解的形式为\n$$\n\\mathbf{x}_{1}=\\mathbf{x}_{0}+c\\,\\mathbf{r}_{0}=c\\,\\mathbf{b},\n$$\n其中标量 $c$ 的选择是为了最小化残差范数。这一步的残差是\n$$\n\\mathbf{r}_{1}=\\mathbf{b}-A\\mathbf{x}_{1}=\\mathbf{b}-c\\,A\\mathbf{b}.\n$$\n令 $\\mathbf{y}=A\\mathbf{b}$。系数 $c$ 最小化二次函数\n$$\nf(c)=\\|\\mathbf{b}-c\\,\\mathbf{y}\\|_{2}^{2}=(\\mathbf{b}-c\\mathbf{y})^{T}(\\mathbf{b}-c\\mathbf{y})=\\mathbf{b}^{T}\\mathbf{b}-2c\\,\\mathbf{y}^{T}\\mathbf{b}+c^{2}\\,\\mathbf{y}^{T}\\mathbf{y}.\n$$\n令 $\\frac{d}{dc}f(c)=0$ 可得到正规方程\n$$\n-2\\,\\mathbf{y}^{T}\\mathbf{b}+2c\\,\\mathbf{y}^{T}\\mathbf{y}=0 \\quad\\Longrightarrow\\quad c^{*}=\\frac{\\mathbf{y}^{T}\\mathbf{b}}{\\mathbf{y}^{T}\\mathbf{y}}.\n$$\n计算 $\\mathbf{y}=A\\mathbf{b}$：\n$$\n\\mathbf{y}=\\begin{pmatrix}1  1\\\\ -4  2\\end{pmatrix}\\begin{pmatrix}2\\\\1\\end{pmatrix}=\\begin{pmatrix}3\\\\-6\\end{pmatrix}.\n$$\n接着\n$$\n\\mathbf{y}^{T}\\mathbf{b}=\\begin{pmatrix}3  -6\\end{pmatrix}\\begin{pmatrix}2\\\\1\\end{pmatrix}=6-6=0,\\qquad \\mathbf{y}^{T}\\mathbf{y}=3^{2}+(-6)^{2}=45.\n$$\n因此 $c^{*}=0$，所以 $\\mathbf{x}_{1}=\\mathbf{0}$，从而 $\\mathbf{r}_{1}=\\mathbf{b}$。因此，\n$$\n\\frac{\\|\\mathbf{r}_{1}\\|_{2}}{\\|\\mathbf{r}_{0}\\|_{2}}=\\frac{\\|\\mathbf{b}\\|_{2}}{\\|\\mathbf{b}\\|_{2}}=1.\n$$",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "GMRES方法最微妙也是最重要的一个特性是，它保证最小化的是“残差”，而非与真实解之间的“误差”。这个练习通过一个精心设计的思想实验，清晰地展示了在某些情况下（尤其是对于非正规矩阵），算法迭代过程中的误差范数甚至可能不减反增。理解这一点对于在实际应用中正确评估迭代方法的收敛性至关重要。",
            "id": "2398705",
            "problem": "考虑线性系统 $A x = b$，其中 $2 \\times 2$ 矩阵为\n$$\nA = \\begin{pmatrix}\n1  10 \\\\\n0  1\n\\end{pmatrix},\n$$\n右端项为 $b = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$，初始猜测为 $x_{0} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$。令 $\\|\\cdot\\|$ 表示欧几里得范数。对于任意 $x$，残差为 $r(x) = b - A x$。广义最小残差法（GMRES）将第一次迭代的结果 $x_{1}$ 定义为仿射空间 $x_{0} + \\mathcal{K}_{1}(A, r_{0})$ 中的唯一向量，该向量使得 $\\|r(x)\\|$ 最小化，其中 $r_{0} = r(x_{0})$。\n\n计算比值\n$$\n\\frac{\\|x - x_{1}\\|}{\\|x - x_{0}\\|},\n$$\n其中 $x$ 是 $A x = b$ 的精确解，使用欧几里得范数。将您的答案四舍五入到四位有效数字。",
            "solution": "目标是计算比值 $\\frac{\\|x - x_{1}\\|}{\\|x - x_{0}\\|}$，其中 $x$ 是线性系统 $A x = b$ 的精确解，$x_{0}$ 是给定的初始猜测，$x_{1}$ 是由GMRES方法生成的第一次迭代结果。所用范数为欧几里得范数。\n\n首先，我们确定精确解 $x$。线性系统为：\n$$\nA x = b \\implies \\begin{pmatrix} 1  10 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} x_a \\\\ x_b \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n$$\n使用回代法，第二行给出 $0 \\cdot x_a + 1 \\cdot x_b = 1$，这意味着 $x_b = 1$。\n将 $x_b=1$ 代入第一行，得到 $1 \\cdot x_a + 10 \\cdot (1) = 1$，从而得出 $x_a = 1 - 10 = -9$。\n因此，精确解为 $x = \\begin{pmatrix} -9 \\\\ 1 \\end{pmatrix}$。\n\n接下来，我们计算初始残差 $r_0$。初始猜测为 $x_0 = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$。\n残差定义为 $r(x) = b - A x$。初始残差 $r_0$ 为：\n$$\nr_0 = r(x_0) = b - A x_0 = b - A \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} = b = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n$$\nGMRES的第一次迭代结果 $x_1$ 定义为在仿射空间 $x_0 + \\mathcal{K}_1(A, r_0)$ 中使残差范数 $\\|r(x)\\|$ 最小化的向量。第一个克雷洛夫子空间 $\\mathcal{K}_1(A, r_0)$ 是由初始残差向量张成的空间，即 $\\mathcal{K}_1(A, r_0) = \\text{span}\\{r_0\\}$。\n因此，$x_1$ 可以表示为：\n$$\nx_1 = x_0 + \\alpha r_0 = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} + \\alpha \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\alpha \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n$$\n其中 $\\alpha \\in \\mathbb{R}$ 为某个标量。\n\n为了找到最优的 $\\alpha$，我们必须最小化相应残差的范数，即 $r(x_1) = b - A x_1$。\n代入 $x_1$ 的表达式并使用 $b=r_0$，我们得到：\n$$\nr(x_1) = b - A (\\alpha r_0) = r_0 - \\alpha (A r_0)\n$$\n我们需要找到使欧几里得范数的平方 $\\|r_0 - \\alpha A r_0\\|^2$ 最小化的 $\\alpha$。这是一个标准的线性最小二乘问题，其解是 $r_0$ 在 $A r_0$ 上的正交投影。系数 $\\alpha$ 由下式给出：\n$$\n\\alpha = \\frac{\\langle r_0, A r_0 \\rangle}{\\|A r_0\\|^2}\n$$\n我们计算向量 $A r_0$：\n$$\nA r_0 = \\begin{pmatrix} 1  10 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1 \\cdot 1 + 10 \\cdot 1 \\\\ 0 \\cdot 1 + 1 \\cdot 1 \\end{pmatrix} = \\begin{pmatrix} 11 \\\\ 1 \\end{pmatrix}\n$$\n现在，我们计算内积和范数的平方：\n$$\n\\langle r_0, A r_0 \\rangle = (1)(11) + (1)(1) = 12\n$$\n$$\n\\|A r_0\\|^2 = 11^2 + 1^2 = 121 + 1 = 122\n$$\n代入这些值，我们求得 $\\alpha$：\n$$\n\\alpha = \\frac{12}{122} = \\frac{6}{61}\n$$\n利用这个 $\\alpha$ 值，第一次GMRES迭代结果为：\n$$\nx_1 = \\frac{6}{61} r_0 = \\frac{6}{61} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 6/61 \\\\ 6/61 \\end{pmatrix}\n$$\n现在我们计算误差向量 $e_0 = x - x_0$ 和 $e_1 = x - x_1$ 及其范数。\n初始误差为：\n$$\ne_0 = x - x_0 = \\begin{pmatrix} -9 \\\\ 1 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -9 \\\\ 1 \\end{pmatrix}\n$$\n初始误差的范数为：\n$$\n\\|e_0\\| = \\|x - x_0\\| = \\sqrt{(-9)^2 + 1^2} = \\sqrt{81 + 1} = \\sqrt{82}\n$$\n第一次迭代后的误差为：\n$$\ne_1 = x - x_1 = \\begin{pmatrix} -9 \\\\ 1 \\end{pmatrix} - \\begin{pmatrix} 6/61 \\\\ 6/61 \\end{pmatrix} = \\begin{pmatrix} -9 - \\frac{6}{61} \\\\ 1 - \\frac{6}{61} \\end{pmatrix} = \\begin{pmatrix} -\\frac{549+6}{61} \\\\ \\frac{61-6}{61} \\end{pmatrix} = \\begin{pmatrix} -555/61 \\\\ 55/61 \\end{pmatrix}\n$$\n该误差向量的范数为：\n$$\n\\|e_1\\| = \\|x - x_1\\| = \\sqrt{\\left(-\\frac{555}{61}\\right)^2 + \\left(\\frac{55}{61}\\right)^2} = \\frac{1}{61}\\sqrt{(-555)^2 + 55^2} = \\frac{1}{61}\\sqrt{308025 + 3025} = \\frac{\\sqrt{311050}}{61}\n$$\n最后，我们计算所要求的比值：\n$$\n\\frac{\\|x - x_1\\|}{\\|x - x_0\\|} = \\frac{\\sqrt{311050}/61}{\\sqrt{82}} = \\sqrt{\\frac{311050}{61^2 \\cdot 82}} = \\sqrt{\\frac{311050}{3721 \\cdot 82}} = \\sqrt{\\frac{311050}{305122}}\n$$\n我们现在对这个表达式进行数值计算：\n$$\n\\frac{\\|x - x_1\\|}{\\|x - x_0\\|} \\approx \\sqrt{1.0194280} \\approx 1.00966727\n$$\n问题要求答案四舍五入到四位有效数字。将 $1.00966727$ 四舍五入后得到 $1.010$。当GMRES应用于像本问题中给出的这种高度非正规矩阵时，误差范数增大的现象是已知的。虽然残差范数保证是单调不增的，但误差范数并非如此。",
            "answer": "$$\\boxed{1.010}$$"
        }
    ]
}