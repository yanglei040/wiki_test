{
    "hands_on_practices": [
        {
            "introduction": "Many physical systems involve not just internal transport but also exchange with an environment. This first practice extends the basic heat equation to model a thin rod that loses heat to its surroundings, a common scenario in thermal engineering. Performing a stability analysis here  demonstrates how to handle the zero-order term that represents this heat loss, showing its direct impact on the maximum stable time step.",
            "id": "2441840",
            "problem": "A thin homogeneous rod of length $L$ exchanges heat laterally with a surrounding environment at constant temperature $u_{\\mathrm{env}}$. The temperature field $u(x,t)$ within the rod evolves according to the linear parabolic model\n$$\nu_{t} = D\\,u_{xx} - h\\big(u - u_{\\mathrm{env}}\\big),\n$$\nfor $0  x  L$ and $t > 0$, where $D > 0$ is the thermal diffusivity and $h \\ge 0$ is the lateral heat-loss coefficient.\n\nOn a uniform spatial grid $x_{j} = j\\,\\Delta x$ with $j \\in \\{0,1,\\dots,N\\}$ and time levels $t^{n} = n\\,\\Delta t$ with $n \\in \\mathbb{N}$, let $u_{j}^{n}$ denote the approximation to $u(x_{j},t^{n})$. Consider the fully explicit finite difference scheme that uses a forward difference in time and a centered second-order difference in space, and that evaluates the lateral loss term explicitly at time level $t^{n}$:\n$$\nu_{j}^{n+1} = u_{j}^{n} + \\Delta t\\left[ D\\,\\frac{u_{j+1}^{n} - 2u_{j}^{n} + u_{j-1}^{n}}{(\\Delta x)^{2}} - h\\left(u_{j}^{n} - u_{\\mathrm{env}}\\right) \\right].\n$$\n\nDetermine, as a closed-form analytic expression in terms of $D$, $h$, and $\\Delta x$, the largest time step $\\Delta t_{\\max}$ such that this explicit scheme is stable in the sense that no discrete Fourier error mode increases in magnitude from time level $t^{n}$ to $t^{n+1}$.\n\nProvide your final answer as a single analytic expression for $\\Delta t_{\\max}$. Do not provide an inequality or an equation. No numerical rounding is required. Express the time step in seconds.",
            "solution": "The problem requires the determination of the maximum permissible time step, $\\Delta t_{\\max}$, for a given explicit finite difference scheme to be stable. The stability will be assessed using the von Neumann stability analysis method, which examines the amplification of discrete Fourier error modes.\n\nTo perform the von Neumann analysis, we study the propagation of a generic error component, $\\epsilon_{j}^{n}$, which is the difference between the numerical solution and the exact solution at the grid point $(x_j, t^n)$. Since the finite difference scheme is linear, the error must satisfy the homogeneous form of the difference equation. The constant term $h u_{\\mathrm{env}}$ does not affect the error propagation dynamics. The error evolution equation is:\n$$\n\\epsilon_{j}^{n+1} = \\epsilon_{j}^{n} + \\Delta t\\left[ D\\,\\frac{\\epsilon_{j+1}^{n} - 2\\epsilon_{j}^{n} + \\epsilon_{j-1}^{n}}{(\\Delta x)^{2}} - h\\epsilon_{j}^{n} \\right]\n$$\nThis can be rearranged as:\n$$\n\\epsilon_{j}^{n+1} = \\epsilon_{j}^{n} \\left(1 - \\frac{2 D \\Delta t}{(\\Delta x)^2} - h \\Delta t \\right) + \\frac{D \\Delta t}{(\\Delta x)^2} \\left( \\epsilon_{j+1}^{n} + \\epsilon_{j-1}^{n} \\right)\n$$\nWe consider a single Fourier mode of the error, represented in complex form as:\n$$\n\\epsilon_{j}^{n} = G^{n} \\exp(i k x_{j}) = G^{n} \\exp(i k j \\Delta x)\n$$\nwhere $k$ is the wave number, $i = \\sqrt{-1}$, and $G$ is the amplification factor from one time step to the next. Stability requires that the magnitude of the amplification factor $|G| \\le 1$ for all possible wave numbers $k$.\n\nSubstituting the Fourier mode into the error equation gives:\n$$\nG^{n+1} \\exp(i k j \\Delta x) = G^{n} \\exp(i k j \\Delta x) + \\Delta t\\left[ D\\,\\frac{G^{n} \\exp(i k (j+1) \\Delta x) - 2G^{n} \\exp(i k j \\Delta x) + G^{n} \\exp(i k (j-1) \\Delta x)}{(\\Delta x)^{2}} - h G^{n} \\exp(i k j \\Delta x) \\right]\n$$\nDividing by $G^{n} \\exp(i k j \\Delta x)$, we obtain an expression for the amplification factor $G = G^{n+1}/G^n$:\n$$\nG = 1 + \\Delta t\\left[ D\\,\\frac{\\exp(i k \\Delta x) - 2 + \\exp(-i k \\Delta x)}{(\\Delta x)^{2}} - h \\right]\n$$\nUsing the identity $\\exp(i\\theta) + \\exp(-i\\theta) = 2\\cos(\\theta)$, the term in the numerator becomes $2\\cos(k\\Delta x) - 2$. This can be further simplified using the half-angle identity $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$, which gives $2\\cos(k\\Delta x) - 2 = -2(1-\\cos(k\\Delta x)) = -4\\sin^2(k\\Delta x/2)$.\nSubstituting this back into the expression for $G$:\n$$\nG = 1 + \\frac{D \\Delta t}{(\\Delta x)^{2}} \\left( -4\\sin^2\\left(\\frac{k \\Delta x}{2}\\right) \\right) - h \\Delta t\n$$\n$$\nG = 1 - \\frac{4D \\Delta t}{(\\Delta x)^2} \\sin^2\\left(\\frac{k \\Delta x}{2}\\right) - h \\Delta t\n$$\nThe amplification factor $G$ is a real quantity. The stability condition $|G| \\le 1$ is equivalent to $-1 \\le G \\le 1$.\n\nLet us analyze the two inequalities separately.\n1. $G \\le 1$:\n$$\n1 - \\frac{4D \\Delta t}{(\\Delta x)^2} \\sin^2\\left(\\frac{k \\Delta x}{2}\\right) - h \\Delta t \\le 1\n$$\n$$\n- \\left( \\frac{4D \\Delta t}{(\\Delta x)^2} \\sin^2\\left(\\frac{k \\Delta x}{2}\\right) + h \\Delta t \\right) \\le 0\n$$\nSince $D > 0$, $h \\ge 0$, $\\Delta t > 0$, and $\\sin^2(\\cdot) \\ge 0$, this inequality is always satisfied. It imposes no upper bound on $\\Delta t$.\n\n2. $G \\ge -1$:\n$$\n1 - \\frac{4D \\Delta t}{(\\Delta x)^2} \\sin^2\\left(\\frac{k \\Delta x}{2}\\right) - h \\Delta t \\ge -1\n$$\n$$\n2 \\ge \\frac{4D \\Delta t}{(\\Delta x)^2} \\sin^2\\left(\\frac{k \\Delta x}{2}\\right) + h \\Delta t\n$$\n$$\n2 \\ge \\Delta t \\left( \\frac{4D}{(\\Delta x)^2} \\sin^2\\left(\\frac{k \\Delta x}{2}\\right) + h \\right)\n$$\nThis must hold for all wave numbers $k$. The most restrictive constraint on $\\Delta t$ occurs when the term multiplying it is at its maximum. The term $\\sin^2(k \\Delta x / 2)$ has a maximum value of $1$, which corresponds to the highest frequency modes representable on the grid (e.g., when $k\\Delta x = \\pi$).\nTo ensure stability for all modes, we must use this maximum value:\n$$\n2 \\ge \\Delta t \\left( \\frac{4D}{(\\Delta x)^2} (1) + h \\right)\n$$\nSolving for $\\Delta t$:\n$$\n\\Delta t \\le \\frac{2}{\\frac{4D}{(\\Delta x)^2} + h}\n$$\nThe largest time step, $\\Delta t_{\\max}$, for which the scheme is stable is the upper bound of this inequality:\n$$\n\\Delta t_{\\max} = \\frac{2}{\\frac{4D}{(\\Delta x)^2} + h}\n$$\nThis expression can be algebraically rearranged by multiplying the numerator and denominator by $(\\Delta x)^2$:\n$$\n\\Delta t_{\\max} = \\frac{2(\\Delta x)^2}{4D + h(\\Delta x)^2}\n$$\nThis is the final expression for the maximum stable time step. If the parameters $D$, $h$, and $\\Delta x$ are given in SI units (m$^2$/s, 1/s, and m, respectively), the resulting $\\Delta t_{\\max}$ will be in seconds.",
            "answer": "$$\n\\boxed{\\frac{2(\\Delta x)^{2}}{4D + h(\\Delta x)^{2}}}\n$$"
        },
        {
            "introduction": "Parabolic-type equations are not limited to second-order diffusion; phenomena like the relaxation of elastic beams or surface tension effects are often modeled by fourth-order equations. This exercise explores the stability of an explicit scheme for the biharmonic equation, $u_{t} = -\\kappa\\,\\partial^{4} u/\\partial x^{4}$. By working through this problem , you will discover how a higher-order spatial derivative dramatically tightens the stability constraint, a crucial lesson on the computational cost of resolving spatially 'stiff' problems.",
            "id": "2441811",
            "problem": "Consider the linear fourth-order parabolic equation\n$$u_{t} = -\\kappa\\,\\partial^{4} u/\\partial x^{4}$$\non a periodic domain $x \\in [0,L]$ with constant $\\kappa>0$. Let the spatial grid be uniform with spacing $\\Delta x$ and indexed by $i \\in \\mathbb{Z}$, and let time be advanced in steps of size $\\Delta t$ with index $n \\in \\mathbb{Z}_{\\ge 0}$. The explicit time-discrete, space-discrete scheme is\n$$\nu_{i}^{n+1} = u_{i}^{n} - r\\left(u_{i-2}^{n} - 4 u_{i-1}^{n} + 6 u_{i}^{n} - 4 u_{i+1}^{n} + u_{i+2}^{n}\\right),\n$$\nwhere $r \\equiv \\kappa\\,\\Delta t/(\\Delta x)^{4}$ and periodic boundary conditions are imposed.\n\nThe scheme is deemed stable if, for every discrete spatial Fourier mode on the periodic grid, the magnitude of its single-step amplification factor does not exceed $1$. Determine the largest admissible value of the nondimensional parameter $r$ such that the scheme is stable in this sense. Provide your final answer as a single real number with no rounding and do not include units.",
            "solution": "The problem requires the determination of the stability condition for a given explicit finite difference scheme for a linear fourth-order parabolic partial differential equation. The standard method for this analysis, applicable here due to the linearity of the equation and the periodic boundary conditions, is the von Neumann stability analysis.\n\nThe given partial differential equation is\n$$\n\\frac{\\partial u}{\\partial t} = -\\kappa \\frac{\\partial^4 u}{\\partial x^4}\n$$\nwhere $\\kappa$ is a positive constant. The computational domain is periodic.\n\nThe finite difference scheme provided is\n$$\nu_{i}^{n+1} = u_{i}^{n} - r\\left(u_{i-2}^{n} - 4 u_{i-1}^{n} + 6 u_{i}^{n} - 4 u_{i+1}^{n} + u_{i+2}^{n}\\right)\n$$\nwhere $u_i^n$ is the numerical approximation of the solution $u(x,t)$ at the grid point $x_i = i\\Delta x$ and time $t_n = n\\Delta t$. The parameter $r$ is defined as $r \\equiv \\kappa\\Delta t/(\\Delta x)^4$. The expression in the parentheses is the standard five-point stencil for the fourth spatial derivative, scaled by $(\\Delta x)^4$.\n\nFor the von Neumann analysis, we consider the behavior of a single spatial Fourier mode. We postulate a solution of the form\n$$\nu_i^n = G(k)^n e^{j k x_i}\n$$\nwhere $k$ is the wavenumber, $j \\equiv \\sqrt{-1}$ is the imaginary unit, and $G(k)$ is the amplification factor for a single time step $\\Delta t$. The scheme is stable if and only if the modulus of the amplification factor is less than or equal to one for all possible wavenumbers $k$: $|G(k)| \\le 1$.\n\nSubstituting the trial solution into the finite difference scheme, we have:\n$$\nG(k)^{n+1} e^{j k (i\\Delta x)} = G(k)^n e^{j k (i\\Delta x)} - r G(k)^n \\left(e^{j k (i-2)\\Delta x} - 4 e^{j k (i-1)\\Delta x} + 6 e^{j k (i\\Delta x)} - 4 e^{j k (i+1)\\Delta x} + e^{j k (i+2)\\Delta x}\\right)\n$$\nDividing the entire equation by $G(k)^n e^{j k (i\\Delta x)}$, we obtain an expression for the amplification factor $G \\equiv G(k)$:\n$$\nG = 1 - r \\left(e^{-2 j k \\Delta x} - 4 e^{-j k \\Delta x} + 6 - 4 e^{j k \\Delta x} + e^{2 j k \\Delta x}\\right)\n$$\nLet us define the dimensionless phase angle $\\theta \\equiv k\\Delta x$. The expression for $G$ becomes:\n$$\nG = 1 - r \\left(e^{-2j\\theta} - 4e^{-j\\theta} + 6 - 4e^{j\\theta} + e^{2j\\theta}\\right)\n$$\nWe can group the terms using Euler's formula, which states $e^{j\\phi} + e^{-j\\phi} = 2\\cos(\\phi)$:\n$$\nG = 1 - r \\left[ \\left(e^{2j\\theta} + e^{-2j\\theta}\\right) - 4\\left(e^{j\\theta} + e^{-j\\theta}\\right) + 6 \\right]\n$$\n$$\nG = 1 - r \\left[ 2\\cos(2\\theta) - 8\\cos(\\theta) + 6 \\right]\n$$\nTo simplify this further, we use the double-angle identity for the cosine function, $\\cos(2\\theta) = 2\\cos^2(\\theta) - 1$:\n$$\nG = 1 - r \\left[ 2\\left(2\\cos^2(\\theta) - 1\\right) - 8\\cos(\\theta) + 6 \\right]\n$$\n$$\nG = 1 - r \\left[ 4\\cos^2(\\theta) - 2 - 8\\cos(\\theta) + 6 \\right]\n$$\n$$\nG = 1 - r \\left[ 4\\cos^2(\\theta) - 8\\cos(\\theta) + 4 \\right]\n$$\nThe expression in the square brackets is a perfect square:\n$$\nG = 1 - 4r \\left[ \\cos^2(\\theta) - 2\\cos(\\theta) + 1 \\right] = 1 - 4r \\left(1 - \\cos(\\theta)\\right)^2\n$$\nUsing the half-angle identity $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$, we arrive at the final form for the amplification factor:\n$$\nG(\\theta) = 1 - 4r \\left( 2\\sin^2(\\frac{\\theta}{2}) \\right)^2 = 1 - 16r \\sin^4\\left(\\frac{\\theta}{2}\\right)\n$$\nThe stability condition is $|G(\\theta)| \\le 1$ for all $\\theta$. Since the amplification factor $G(\\theta)$ is a real number, this is equivalent to the two inequalities:\n$$\n-1 \\le G(\\theta) \\le 1\n$$\n$$\n-1 \\le 1 - 16r \\sin^4\\left(\\frac{\\theta}{2}\\right) \\le 1\n$$\nLet's analyze each inequality separately.\nFirst, the right inequality:\n$$\n1 - 16r \\sin^4\\left(\\frac{\\theta}{2}\\right) \\le 1\n$$\n$$\n-16r \\sin^4\\left(\\frac{\\theta}{2}\\right) \\le 0\n$$\nSince $r > 0$ and $\\sin^4(\\theta/2) \\ge 0$, the term $-16r\\sin^4(\\theta/2)$ is always non-positive. Thus, this inequality is always satisfied for any $r > 0$ and any $\\theta$.\n\nSecond, the left inequality:\n$$\n-1 \\le 1 - 16r \\sin^4\\left(\\frac{\\theta}{2}\\right)\n$$\n$$\n16r \\sin^4\\left(\\frac{\\theta}{2}\\right) \\le 2\n$$\n$$\nr \\sin^4\\left(\\frac{\\theta}{2}\\right) \\le \\frac{2}{16} = \\frac{1}{8}\n$$\nThis condition must hold for all possible values of the phase angle $\\theta$. The term $\\sin^4(\\theta/2)$ varies with $\\theta$. To ensure the inequality is satisfied universally, we must consider the \"worst-case\" scenario, which corresponds to the maximum possible value of $\\sin^4(\\theta/2)$. The range of the sine function is $[-1, 1]$, so the range of $\\sin^4(\\theta/2)$ is $[0, 1]$. The maximum value is $1$, which occurs when $\\theta/2 = \\pi/2 + n\\pi$ for any integer $n$, or $\\theta = \\pi + 2n\\pi$. The highest frequency mode resolvable on the grid corresponds to $\\theta=\\pi$.\n\nSubstituting the maximum value of the trigonometric term into our stability condition:\n$$\nr \\cdot \\max_{\\theta}\\left[\\sin^4\\left(\\frac{\\theta}{2}\\right)\\right] \\le \\frac{1}{8}\n$$\n$$\nr \\cdot 1 \\le \\frac{1}{8}\n$$\n$$\nr \\le \\frac{1}{8}\n$$\nTherefore, the largest admissible value of the non-dimensional parameter $r$ for which the scheme is stable is $\\frac{1}{8}$.",
            "answer": "$$\n\\boxed{\\frac{1}{8}}\n$$"
        },
        {
            "introduction": "Most real-world models are nonlinear, and analyzing their stability requires an extra step. This final practice applies our tools to a fun, practical example: modeling the Maillard reaction, or the browning of a slice of bread in a toaster . You will learn the essential technique of linearizing a nonlinear numerical scheme around a steady state to derive a local stability condition, a method that is broadly applicable across computational science.",
            "id": "2441809",
            "problem": "A thin rectangular slice of bread is idealized as a two-dimensional sheet. Let $b(x,y,t)$ denote a dimensionless browning index, with $b \\in [0,1]$. A minimal model for the evolution of $b$ couples in-plane diffusion of reactive precursors with an autocatalytic Maillard reaction. The governing Partial Differential Equation (PDE) is\n$$\n\\frac{\\partial b}{\\partial t} = D \\nabla^2 b + k\\, b\\,(1-b),\n$$\nwhere $D$ is the effective diffusion coefficient in $\\mathrm{m^2/s}$, and $k$ is a kinetic rate in $\\mathrm{s^{-1}}$. Consider a uniform square grid with spacing $h$ in $\\mathrm{m}$, a time step $\\Delta t$ in $\\mathrm{s}$, and the explicit forward Euler finite-difference scheme with the standard five-point stencil for the Laplacian:\n$$\nb_{i,j}^{n+1} = b_{i,j}^{n} + \\Delta t\\left[\\frac{D}{h^2}\\left(b_{i+1,j}^{n} + b_{i-1,j}^{n} + b_{i,j+1}^{n} + b_{i,j-1}^{n} - 4 b_{i,j}^{n}\\right) + k\\, b_{i,j}^{n}\\left(1 - b_{i,j}^{n}\\right)\\right].\n$$\nAnalyze the linear stability of this explicit scheme about the spatially uniform steady state $b^\\star = 1$ and determine the maximum allowable time step $\\Delta t_{\\max}$ in $\\mathrm{s}$ that guarantees stability of the linearized scheme for given $D$, $k$, and $h$. Your program must compute $\\Delta t_{\\max}$ for each parameter set in the test suite below and produce them as decimal numbers in seconds.\n\nTest suite (each case is a triple $(D,k,h)$ with $D$ in $\\mathrm{m^2/s}$, $k$ in $\\mathrm{s^{-1}}$, $h$ in $\\mathrm{m}$):\n- Case $1$: $(D,k,h) = \\left(1.0\\times 10^{-6},\\, 5.0\\times 10^{-1},\\, 1.0\\times 10^{-3}\\right)$.\n- Case $2$: $(D,k,h) = \\left(1.0\\times 10^{-6},\\, 0.0,\\, 1.0\\times 10^{-3}\\right)$.\n- Case $3$: $(D,k,h) = \\left(0.0,\\, 2.0,\\, 1.0\\times 10^{-3}\\right)$.\n- Case $4$: $(D,k,h) = \\left(1.0\\times 10^{-6},\\, 5.0\\times 10^{-1},\\, 5.0\\times 10^{-4}\\right)$.\n- Case $5$: $(D,k,h) = \\left(5.0\\times 10^{-7},\\, 2.0\\times 10^{-1},\\, 2.0\\times 10^{-3}\\right)$.\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with no spaces, in the order of the cases above, for example $[r_1,r_2,r_3,r_4,r_5]$, where each $r_i$ is $\\Delta t_{\\max}$ in $\\mathrm{s}$ as a decimal number.",
            "solution": "The objective is to determine the maximum allowable time step, $\\Delta t_{\\max}$, for the provided explicit finite-difference scheme by performing a linear stability analysis around the spatially uniform steady state $b^\\star = 1$.\n\nThe governing partial differential equation is:\n$$\n\\frac{\\partial b}{\\partial t} = D \\nabla^2 b + k\\, b\\,(1-b)\n$$\nThe explicit forward Euler scheme is given by:\n$$\nb_{i,j}^{n+1} = b_{i,j}^{n} + \\Delta t\\left[\\frac{D}{h^2}\\left(b_{i+1,j}^{n} + b_{i-1,j}^{n} + b_{i,j+1}^{n} + b_{i,j-1}^{n} - 4 b_{i,j}^{n}\\right) + k\\, b_{i,j}^{n}\\left(1 - b_{i,j}^{n}\\right)\\right]\n$$\nTo analyze the linear stability, we introduce a small perturbation $\\epsilon_{i,j}^n$ around the steady state $b^\\star = 1$, such that $b_{i,j}^n = b^\\star + \\epsilon_{i,j}^n = 1 + \\epsilon_{i,j}^n$.\n\nThe nonlinear reaction term $f(b) = k\\, b\\,(1-b)$ must be linearized around $b^\\star=1$. The first derivative is $f'(b) = k(1 - 2b)$. At the steady state, $f'(1) = k(1 - 2(1)) = -k$. The Taylor expansion of $f(b)$ around $b^\\star=1$ is $f(1+\\epsilon) = f(1) + f'(1)\\epsilon + \\mathcal{O}(\\epsilon^2)$. Since $f(1)=0$, for small $\\epsilon$, we have $k(1+\\epsilon)(1-(1+\\epsilon)) = k(1+\\epsilon)(-\\epsilon) = -k\\epsilon - k\\epsilon^2 \\approx -k\\epsilon$.\n\nSubstituting $b_{i,j}^n = 1 + \\epsilon_{i,j}^n$ into the numerical scheme and retaining only terms linear in $\\epsilon$ yields the evolution equation for the perturbation:\n$$\n1 + \\epsilon_{i,j}^{n+1} = 1 + \\epsilon_{i,j}^{n} + \\Delta t\\left[\\frac{D}{h^2}\\left(\\epsilon_{i+1,j}^{n} + \\epsilon_{i-1,j}^{n} + \\epsilon_{i,j+1}^{n} + \\epsilon_{i,j-1}^{n} - 4\\epsilon_{i,j}^{n}\\right) - k\\epsilon_{i,j}^{n}\\right]\n$$\nSubtracting $1$ from both sides, we obtain the linearized difference equation:\n$$\n\\epsilon_{i,j}^{n+1} = \\epsilon_{i,j}^{n} + \\frac{D\\Delta t}{h^2}\\left(\\epsilon_{i+1,j}^{n} + \\epsilon_{i-1,j}^{n} + \\epsilon_{i,j+1}^{n} + \\epsilon_{i,j-1}^{n} - 4\\epsilon_{i,j}^{n}\\right) - k\\Delta t\\epsilon_{i,j}^{n}\n$$\nWe now apply von Neumann stability analysis. We consider a single Fourier mode of the perturbation:\n$$\n\\epsilon_{i,j}^n = A^n e^{\\mathrm{i}(k_x i h + k_y j h)}\n$$\nwhere $A^n$ is the amplitude at time step $n$, $\\mathrm{i}$ is the imaginary unit, and $k_x, k_y$ are the wave numbers. Substituting this into the linearized equation and dividing by $e^{\\mathrm{i}(k_x i h + k_y j h)}$ gives the amplification factor $G = A^{n+1}/A^n$:\n$$\nG = 1 + \\frac{D\\Delta t}{h^2}\\left(e^{\\mathrm{i}k_x h} + e^{-\\mathrm{i}k_x h} + e^{\\mathrm{i}k_y h} + e^{-\\mathrm{i}k_y h} - 4\\right) - k\\Delta t\n$$\nUsing the identity $e^{\\mathrm{i}\\theta} + e^{-\\mathrm{i}\\theta} = 2\\cos(\\theta)$, we simplify the expression:\n$$\nG = 1 + \\frac{2D\\Delta t}{h^2}\\left(\\cos(k_x h) + \\cos(k_y h) - 2\\right) - k\\Delta t\n$$\nUsing the half-angle identity $1 - \\cos(\\theta) = 2\\sin^2(\\theta/2)$, we can rewrite this as:\n$$\nG = 1 - \\frac{4D\\Delta t}{h^2}\\left(\\sin^2\\left(\\frac{k_x h}{2}\\right) + \\sin^2\\left(\\frac{k_y h}{2}\\right)\\right) - k\\Delta t\n$$\nFor the scheme to be stable, the magnitude of the amplification factor must not exceed unity for all possible wave numbers, i.e., $|G| \\le 1$. Since $G$ is purely real, this condition is equivalent to $-1 \\le G \\le 1$.\n\nFirst condition: $G \\le 1$.\n$$\n1 - \\Delta t \\left[ \\frac{4D}{h^2}\\left(\\sin^2\\left(\\frac{k_x h}{2}\\right) + \\sin^2\\left(\\frac{k_y h}{2}\\right)\\right) + k \\right] \\le 1\n$$\n$$\n-\\Delta t \\left[ \\frac{4D}{h^2}\\left(\\sin^2\\left(\\frac{k_x h}{2}\\right) + \\sin^2\\left(\\frac{k_y h}{2}\\right)\\right) + k \\right] \\le 0\n$$\nGiven that $D \\ge 0$, $k \\ge 0$, $\\Delta t > 0$, and the term with sines is non-negative, this inequality is always satisfied. This condition imposes no restriction on $\\Delta t$.\n\nSecond condition: $G \\ge -1$.\n$$\n1 - \\Delta t \\left[ \\frac{4D}{h^2}\\left(\\sin^2\\left(\\frac{k_x h}{2}\\right) + \\sin^2\\left(\\frac{k_y h}{2}\\right)\\right) + k \\right] \\ge -1\n$$\n$$\n2 \\ge \\Delta t \\left[ k + \\frac{4D}{h^2}\\left(\\sin^2\\left(\\frac{k_x h}{2}\\right) + \\sin^2\\left(\\frac{k_y h}{2}\\right)\\right) \\right]\n$$\n$$\n\\Delta t \\le \\frac{2}{k + \\frac{4D}{h^2}\\left(\\sin^2\\left(\\frac{k_x h}{2}\\right) + \\sin^2\\left(\\frac{k_y h}{2}\\right)\\right)}\n$$\nThis inequality must hold for all wave numbers $(k_x, k_y)$. To find the most restrictive condition on $\\Delta t$, we must find the minimum value of the right-hand side. This occurs when the denominator is maximized. The term $S = \\sin^2\\left(\\frac{k_x h}{2}\\right) + \\sin^2\\left(\\frac{k_y h}{2}\\right)$ has a maximum value when $k_x h = \\pi$ and $k_y h = \\pi$, which corresponds to the highest frequency (checkerboard) modes. In this case, $S = \\sin^2(\\pi/2) + \\sin^2(\\pi/2) = 1 + 1 = 2$.\n\nSubstituting $S=2$ into the inequality gives the stability constraint for all modes:\n$$\n\\Delta t \\le \\frac{2}{k + \\frac{4D}{h^2}(2)}\n$$\nTherefore, the maximum allowable time step for the linearized scheme to be stable is:\n$$\n\\Delta t_{\\max} = \\frac{2}{k + \\frac{8D}{h^2}}\n$$\nThis formula correctly recovers the known stability limit for the $2$-dimensional heat equation, $\\Delta t \\le h^2/(4D)$, when $k=0$, and the limit for the logistic equation, $\\Delta t \\le 2/k$, when $D=0$. With this formula, we can compute the required values for the given test cases.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the maximum stable time step for a 2D reaction-diffusion\n    equation discretized with an explicit finite-difference scheme.\n    \"\"\"\n    # Test suite: each case is a tuple (D, k, h)\n    # D: diffusion coefficient in m^2/s\n    # k: kinetic rate in s^-1\n    # h: grid spacing in m\n    test_cases = [\n        (1.0e-6, 5.0e-1, 1.0e-3),\n        (1.0e-6, 0.0, 1.0e-3),\n        (0.0, 2.0, 1.0e-3),\n        (1.0e-6, 5.0e-1, 5.0e-4),\n        (5.0e-7, 2.0e-1, 2.0e-3),\n    ]\n\n    results = []\n    for D, k, h in test_cases:\n        # The stability condition for the linearized scheme is derived as:\n        # delta_t_max = 2 / (k + 8*D / h^2)\n        \n        # Check for division by zero, although not expected with given test cases.\n        # The denominator is zero only if both D and k are zero.\n        denominator = k + (8.0 * D) / (h**2)\n        \n        if denominator == 0:\n            # For D=0 and k=0, the equation is db/dt = 0, which is stable\n            # for any dt. The result is effectively infinite.\n            # However, this case is not in the test suite and the problem\n            # context implies a finite, positive denominator.\n            # We would need a problem-specific rule for this edge case.\n            # For now, we assume denominator  0.\n            pass\n\n        delta_t_max = 2.0 / denominator\n        results.append(delta_t_max)\n\n    # Format the output as a comma-separated list in brackets, with no spaces.\n    print(f\"[{','.join(f'{r:.17g}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}