{
    "hands_on_practices": [
        {
            "introduction": "This first exercise provides a concrete, hands-on walkthrough of representing a simple, physically relevant quantum state—the ground state of two interacting fermions—as a Matrix Product State (MPS). This practice is foundational for understanding how the abstract structure of an MPS directly encodes the coefficients and entanglement of a many-body wavefunction . By working through this example, you will develop the core skill of translating a state vector into the tensor network formalism.",
            "id": "2445466",
            "problem": "Consider a one-dimensional chain of $L=2$ spinless fermionic sites with open boundary conditions. The creation and annihilation operators $c_{j}^{\\dagger}$ and $c_{j}$ for site $j \\in \\{1,2\\}$ satisfy the canonical anticommutation relations $\\{c_{i},c_{j}^{\\dagger}\\}=\\delta_{ij}$ and $\\{c_{i},c_{j}\\}=0=\\{c_{i}^{\\dagger},c_{j}^{\\dagger}\\}$. The Hamiltonian is\n$$\nH \\;=\\; -\\,t\\,\\big(c_{1}^{\\dagger}c_{2}+c_{2}^{\\dagger}c_{1}\\big)\\,,\n$$\nwith $t0$. Work in the sector with total particle number $N=1$. Starting from the definitions above and no further assumptions, do the following:\n\n- Determine the unique normalized ground state $|\\psi_{0}\\rangle$ of $H$ in the $N=1$ sector and express it in the occupation basis $\\{|n_{1}n_{2}\\rangle\\}$ with $n_{j}\\in\\{0,1\\}$.\n- Represent $|\\psi_{0}\\rangle$ exactly as a Matrix Product State (MPS), that is, as\n$$\n|\\psi_{0}\\rangle \\;=\\; \\sum_{n_{1},n_{2}\\in\\{0,1\\}} A^{[1]}_{n_{1}}\\,A^{[2]}_{n_{2}}\\,|n_{1}n_{2}\\rangle\\,,\n$$\nwhere $A^{[1]}_{n_{1}}$ is a $1\\times \\chi$ row vector and $A^{[2]}_{n_{2}}$ is a $\\chi\\times 1$ column vector for some minimal bond dimension $\\chi$. Your MPS must reproduce exactly the amplitudes of $|\\psi_{0}\\rangle$ in the occupation basis.\n- Using your MPS, verify directly that the two-point correlator $\\langle \\psi_{0}|\\,c_{1}^{\\dagger}c_{2}\\,|\\psi_{0}\\rangle$ has the correct value implied by $|\\psi_{0}\\rangle$, and verify that the reduced density matrix of site $1$, $\\rho_{1}=\\mathrm{Tr}_{2}\\,|\\psi_{0}\\rangle\\langle\\psi_{0}|$, is properly normalized and positive semidefinite.\n\nAnswer specification:\n- Compute the von Neumann entanglement entropy across the bipartition $\\{1\\}|\\{2\\}$, defined by $S \\equiv -\\mathrm{Tr}\\big(\\rho_{1}\\,\\ln \\rho_{1}\\big)$, and provide this as your final answer.\n- No rounding is required; provide an exact closed-form analytic expression.\n- Do not include any units with your final answer; the entropy is to be reported in nats (natural logarithm).",
            "solution": "The problem posed is a standard exercise in quantum many-body physics and is well-defined, scientifically grounded, and objective. It contains all necessary information to determine a unique solution. Therefore, we proceed with a full analysis.\n\nThe system is a one-dimensional chain of $L=2$ spinless fermionic sites. We are restricted to the sector with total particle number $N=1$. The basis states for this sector are $|10\\rangle$, representing a fermion on site $1$ and none on site $2$, and $|01\\rangle$, representing a fermion on site $2$ and none on site $1$. The Hilbert space for this sector is thus two-dimensional.\n\nThe Hamiltonian is given by $H = -t(c_{1}^{\\dagger}c_{2}+c_{2}^{\\dagger}c_{1})$, where $t0$. We find the matrix representation of $H$ in the basis $\\{|10\\rangle, |01\\rangle\\}$. We apply $H$ to each basis state:\n$$\nH|10\\rangle = -t(c_{1}^{\\dagger}c_{2}+c_{2}^{\\dagger}c_{1})|10\\rangle = -t(c_{1}^{\\dagger}c_{2}|10\\rangle + c_{2}^{\\dagger}c_{1}|10\\rangle)\n$$\nSince site $2$ is empty in $|10\\rangle$, $c_{2}|10\\rangle = 0$. The operator $c_{1}$ annihilates a fermion on site $1$, resulting in the vacuum state $|00\\rangle$, so $c_{1}|10\\rangle = |00\\rangle$. Then, $c_{2}^{\\dagger}c_{1}|10\\rangle = c_{2}^{\\dagger}|00\\rangle = |01\\rangle$. Thus, $H|10\\rangle = -t|01\\rangle$.\n\nSimilarly, we apply $H$ to $|01\\rangle$:\n$$\nH|01\\rangle = -t(c_{1}^{\\dagger}c_{2}+c_{2}^{\\dagger}c_{1})|01\\rangle = -t(c_{1}^{\\dagger}c_{2}|01\\rangle + c_{2}^{\\dagger}c_{1}|01\\rangle)\n$$\nHere, $c_{1}|01\\rangle = 0$. We have $c_{2}|01\\rangle=|00\\rangle$, so $c_{1}^{\\dagger}c_{2}|01\\rangle = c_{1}^{\\dagger}|00\\rangle = |10\\rangle$. Thus, $H|01\\rangle = -t|10\\rangle$.\n\nIn the ordered basis $(|10\\rangle, |01\\rangle)$, the Hamiltonian matrix is:\n$$\n\\mathbf{H} = \\begin{pmatrix} \\langle 10|H|10\\rangle  \\langle 10|H|01\\rangle \\\\ \\langle 01|H|10\\rangle  \\langle 01|H|01\\rangle \\end{pmatrix} = \\begin{pmatrix} 0  -t \\\\ -t  0 \\end{pmatrix}\n$$\nThe eigenvalues $\\lambda$ are found from $\\det(\\mathbf{H} - \\lambda I) = \\lambda^2 - t^2 = 0$, which gives $\\lambda = \\pm t$. Since $t0$, the ground state energy is $E_0 = -t$. The corresponding eigenvector $(a, b)^T$ satisfies $(\\mathbf{H} - E_0 I)\\begin{pmatrix} a \\\\ b \\end{pmatrix} = 0$:\n$$\n\\begin{pmatrix} t  -t \\\\ -t  t \\end{pmatrix} \\begin{pmatrix} a \\\\ b \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} \\implies ta - tb = 0 \\implies a = b\n$$\nThe unnormalized ground state is $|10\\rangle + |01\\rangle$. Normalizing this state, we find the unique normalized ground state $|\\psi_0\\rangle$:\n$$\n|\\psi_0\\rangle = \\frac{1}{\\sqrt{2}} \\left( |10\\rangle + |01\\rangle \\right)\n$$\n\nNext, we represent $|\\psi_0\\rangle$ as a Matrix Product State (MPS). In the occupation basis $\\{|n_1 n_2\\rangle\\}$, the state is $|\\psi_0\\rangle = \\sum_{n_1,n_2} C_{n_1 n_2} |n_1 n_2\\rangle$. The coefficient matrix is:\n$$\nC = \\begin{pmatrix} C_{00}  C_{01} \\\\ C_{10}  C_{11} \\end{pmatrix} = \\begin{pmatrix} 0  \\frac{1}{\\sqrt{2}} \\\\ \\frac{1}{\\sqrt{2}}  0 \\end{pmatrix}\n$$\nThe minimal bond dimension $\\chi$ is the rank of this matrix, which is $\\chi=2$. The MPS representation is given by $C_{n_1 n_2} = A^{[1]}_{n_1} A^{[2]}_{n_2}$, where for each $n_1 \\in \\{0, 1\\}$, $A^{[1]}_{n_1}$ is a $1 \\times 2$ row vector, and for each $n_2 \\in \\{0, 1\\}$, $A^{[2]}_{n_2}$ is a $2 \\times 1$ column vector. We form a $2 \\times 2$ matrix $M_1$ from the rows $A^{[1]}_{n_1}$ and a $2 \\times 2$ matrix $M_2$ from the columns $A^{[2]}_{n_2}$, such that $C = M_1 M_2$. A valid and simple choice is $M_1 = C$ and $M_2 = I$:\n$$\nA^{[1]}_0 = \\begin{pmatrix} 0  \\frac{1}{\\sqrt{2}} \\end{pmatrix}, \\quad A^{[1]}_1 = \\begin{pmatrix} \\frac{1}{\\sqrt{2}}  0 \\end{pmatrix}\n$$\n$$\nA^{[2]}_0 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}, \\quad A^{[2]}_1 = \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}\n$$\nThis choice satisfies the conditions and reproduces the coefficients exactly.\n\nWe now verify the two-point correlator $\\langle \\psi_0 | c_1^\\dagger c_2 | \\psi_0 \\rangle$ using this MPS. First, from the exact state, we have $\\langle \\psi_0 | c_1^\\dagger c_2 | \\psi_0 \\rangle = \\frac{1}{2}(\\langle 10| + \\langle 01|)c_1^\\dagger c_2(|10\\rangle + |01\\rangle) = \\frac{1}{2}(\\langle 10| + \\langle 01|)c_1^\\dagger|00\\rangle = \\frac{1}{2}(\\langle 10| + \\langle 01|)|10\\rangle = \\frac{1}{2}$.\nTo calculate this with the MPS, we use the formula for a two-site operator $\\hat{O}_1 \\otimes \\hat{O}_2$:\n$$\n\\langle \\psi_0 | \\hat{O}_1 \\otimes \\hat{O}_2 | \\psi_0 \\rangle = \\sum_{n_1,m_1,n_2,m_2} (A^{[1]}_{m_1}A^{[2]}_{m_2})^* (\\hat{O}_1)_{m_1 n_1} (\\hat{O}_2)_{m_2 n_2} (A^{[1]}_{n_1}A^{[2]}_{n_2})\n$$\nThe expression can be rearranged as:\n$$\n\\langle \\psi_0 | \\hat{O}_1 \\otimes \\hat{O}_2 | \\psi_0 \\rangle = \\sum_{n_2, m_2} (\\hat{O}_2)_{m_2 n_2} (A^{[2]}_{m_2})^\\dagger \\left( \\sum_{n_1, m_1} (\\hat{O}_1)_{m_1 n_1} (A^{[1]}_{m_1})^\\dagger A^{[1]}_{n_1} \\right) A^{[2]}_{n_2}\n$$\nLet $\\tilde{E}_1 = \\sum_{n_1, m_1} \\langle m_1|\\hat{O}_1|n_1\\rangle (A^{[1]}_{m_1})^\\dagger A^{[1]}_{n_1}$. For $\\hat{O}_1 = c_1^\\dagger$, the only non-zero matrix element is $\\langle 1|c_1^\\dagger|0\\rangle=1$.\n$$\n\\tilde{E}_1 = (A^{[1]}_1)^\\dagger A^{[1]}_0 = \\begin{pmatrix} \\sqrt{2}^{-1} \\\\ 0 \\end{pmatrix} \\begin{pmatrix} 0  \\sqrt{2}^{-1} \\end{pmatrix} = \\begin{pmatrix} 0  \\frac{1}{2} \\\\ 0  0 \\end{pmatrix}\n$$\nThe expectation value is thus $\\sum_{n_2, m_2} \\langle m_2|\\hat{O}_2|n_2\\rangle (A^{[2]}_{m_2})^\\dagger \\tilde{E}_1 A^{[2]}_{n_2}$. For $\\hat{O}_2=c_2$, the non-zero matrix element is $\\langle 0|c_2|1\\rangle=1$.\n$$\n\\langle \\psi_0 | c_1^\\dagger c_2 | \\psi_0 \\rangle = (A^{[2]}_0)^\\dagger \\tilde{E}_1 A^{[2]}_1 = \\begin{pmatrix} 1  0 \\end{pmatrix} \\begin{pmatrix} 0  \\frac{1}{2} \\\\ 0  0 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 0  \\frac{1}{2} \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix} = \\frac{1}{2}\n$$\nThis confirms the correct value.\n\nFinally, we find the reduced density matrix $\\rho_1 = \\mathrm{Tr}_2(|\\psi_0\\rangle\\langle\\psi_0|)$. In the MPS formalism, this is related to the Schmidt decomposition derived from the SVD of the coefficient matrix $C = U S V^\\dagger$. The eigenvalues of $\\rho_1$ are the squares of the singular values of $C$. The singular values are the square roots of the eigenvalues of $C C^\\dagger = \\frac{1}{2}I$, which are $\\sigma_1^2 = \\sigma_2^2 = \\frac{1}{2}$. So the singular values are $s_1 = s_2 = \\frac{1}{\\sqrt{2}}$.\nThe eigenvalues of $\\rho_1$ are $\\lambda_{1,2} = s_{1,2}^2 = \\frac{1}{2}$. The eigenvectors of $\\rho_1$ are the corresponding Schmidt vectors, which are the rows of $U$. Since $C C^\\dagger$ is proportional to identity, we can choose $U=I$, giving eigenvectors $|0\\rangle$ and $|1\\rangle$.\n$$\n\\rho_1 = \\lambda_1 |0\\rangle\\langle 0| + \\lambda_2 |1\\rangle\\langle 1| = \\frac{1}{2}|0\\rangle\\langle 0| + \\frac{1}{2}|1\\rangle\\langle 1| = \\frac{1}{2} \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}\n$$\nNormalization: $\\mathrm{Tr}(\\rho_1) = \\frac{1}{2}+\\frac{1}{2}=1$. The matrix is properly normalized.\nPositive semidefiniteness: The eigenvalues $\\frac{1}{2}, \\frac{1}{2}$ are all non-negative. The matrix is positive semidefinite.\n\nThe von Neumann entanglement entropy is $S = -\\mathrm{Tr}(\\rho_1 \\ln \\rho_1)$. Using the eigenvalues $\\lambda_i$ of $\\rho_1$:\n$$\nS = -\\sum_i \\lambda_i \\ln \\lambda_i = -\\left( \\frac{1}{2}\\ln\\left(\\frac{1}{2}\\right) + \\frac{1}{2}\\ln\\left(\\frac{1}{2}\\right) \\right) = - (2) \\left( \\frac{1}{2}\\ln\\left(\\frac{1}{2}\\right) \\right) = -\\ln\\left(\\frac{1}{2}\\right) = \\ln(2)\n$$\nThe entanglement entropy is $\\ln(2)$ nats, which is the maximum possible for a bipartition into two-level systems, indicating maximal entanglement.",
            "answer": "$$\n\\boxed{\\ln(2)}\n$$"
        },
        {
            "introduction": "Building on the representation of states, this exercise tackles the representation of operators as Matrix Product Operators (MPOs), a crucial generalization of the MPS formalism. You will construct an MPO that projects onto a subspace with a fixed number of particles, a common task in condensed matter physics. This practice demonstrates the power of MPOs to encode non-trivial and even non-local operators by cleverly using the virtual bond indices to carry information .",
            "id": "2445471",
            "problem": "Consider an open chain of length $L$ with local Hilbert space $\\{|0\\rangle, |1\\rangle\\}$ at each site, representing the occupation basis of spinless fermions with number operator $n_i$ satisfying $n_i |0\\rangle = 0 |0\\rangle$ and $n_i |1\\rangle = 1 |1\\rangle$. The global Hilbert space is the tensor product of the $L$ local spaces. The projector onto the fixed-total-particle-number sector with total number $N$ is the operator that acts as the identity on states with $\\sum_{i=1}^{L} n_i = N$ and annihilates all other states.\n\nUsing only fundamental definitions of a Matrix Product Operator (MPO) and the occupation basis, construct an explicit MPO representation of this projector by introducing a virtual bond index that encodes the running particle count. Your MPO must be specified by:\n- A bond space spanned by states labeled by integers from $0$ to $N$.\n- Left and right boundary vectors that enforce the total count to be exactly $N$.\n- A local site tensor that enforces counting consistency and diagonality in the occupation basis.\n\nThen, using your construction and first principles (no pre-existing counting formulas), compute the trace of this projector as a closed-form analytic expression in terms of $L$ and $N$. Provide only the final expression for the trace as your answer. No numerical evaluation is required, and no units are involved.",
            "solution": "The problem statement is scientifically grounded, well-posed, objective, and contains sufficient information for a rigorous solution. We shall therefore proceed with the derivation.\n\nThe projector $P_N$ onto the subspace of states with a fixed total particle number $N$ is diagonal in the occupation number basis $\\{|s_1 s_2 \\dots s_L\\rangle\\}$, where $s_i \\in \\{0, 1\\}$ is the occupation number at site $i$. The operator can be written as:\n$$\nP_N = \\sum_{\\{s_i\\}} \\lambda(\\{s_i\\}) |s_1 \\dots s_L\\rangle \\langle s_1 \\dots s_L |\n$$\nwhere the eigenvalue $\\lambda(\\{s_i\\})$ is $1$ if the total particle number $\\sum_{i=1}^{L} s_i = N$, and $0$ otherwise.\n\nWe are tasked to construct a Matrix Product Operator (MPO) representation for $P_N$. In this representation, the eigenvalue $\\lambda(\\{s_i\\})$ is expressed as a product of matrices:\n$$\n\\lambda(\\{s_i\\}) = B_L M^{s_1} M^{s_2} \\cdots M^{s_L} B_R\n$$\nHere, $M^{s_i}$ is a matrix corresponding to the local physical state $|s_i\\rangle$, $B_L$ is a left boundary row vector, and $B_R$ is a right boundary column vector. The matrix products are taken over a virtual \"bond\" space.\n\nThe construction is based on a virtual index that tracks the running particle count.\n\n$1$. **Virtual Bond Space**:\nThe virtual bond space will be spanned by a basis of states $\\{|\\alpha\\rangle\\}$ where the index $\\alpha$ represents the number of particles counted so far. Since the total number of particles is fixed at $N$, the running count can range from $0$ to $N$. Any path where the running count exceeds $N$ is invalid. Thus, the virtual bond space has dimension $N+1$, with the index $\\alpha$ taking integer values from $0, 1, \\dots, N$.\n\n$2$. **Local Site Tensor**:\nThe local tensor at site $i$ is a collection of $(N+1) \\times (N+1)$ matrices, $\\{M^0, M^1\\}$, corresponding to the physical occupation states $|0\\rangle$ and $|1\\rangle$. The matrix elements $[M^s]_{\\alpha, \\beta}$ connect an incoming virtual state $|\\alpha\\rangle$ (representing the count up to site $i-1$) to an outgoing virtual state $|\\beta\\rangle$ (representing the count up to site $i$).\n- If site $i$ is unoccupied ($s_i=0$), the particle count does not change. Thus, the outgoing count $\\beta$ must equal the incoming count $\\alpha$. This defines the matrix $M^0$:\n$$\n[M^0]_{\\alpha, \\beta} = \\delta_{\\alpha, \\beta} \\quad \\text{for } \\alpha, \\beta \\in \\{0, 1, \\dots, N\\}\n$$\nThis matrix is the $(N+1) \\times (N+1)$ identity matrix, $I$.\n- If site $i$ is occupied ($s_i=1$), the particle count increases by one. The outgoing count $\\beta$ must be $\\alpha+1$. This defines the matrix $M^1$:\n$$\n[M^1]_{\\alpha, \\beta} = \\delta_{\\beta, \\alpha+1} \\quad \\text{for } \\alpha, \\beta \\in \\{0, 1, \\dots, N\\}\n$$\nThis matrix has elements equal to $1$ on the first upper sub-diagonal (i.e., $[M^1]_{k, k+1} = 1$) and zeros elsewhere. This is a nilpotent matrix, which we denote as $S_u$, the \"shift-up\" operator.\n\n$3$. **Boundary Vectors**:\n- The left boundary vector $B_L$ must enforce the initial condition that the particle count is $0$ before the first site. It is a $1 \\times (N+1)$ row vector that selects the virtual state $|\\alpha=0\\rangle$:\n$$\nB_L = \\begin{pmatrix} 1  0  \\dots  0 \\end{pmatrix} = e_0^T\n$$\n- The right boundary vector $B_R$ must enforce the final condition that the total particle count after the last site $L$ is exactly $N$. It is an $(N+1) \\times 1$ column vector that selects the virtual state $|\\alpha=N\\rangle$:\n$$\nB_R = \\begin{pmatrix} 0 \\\\ \\vdots \\\\ 0 \\\\ 1 \\end{pmatrix} = e_N\n$$\nWith this construction, the coefficient for any state $|\\{s_i\\}\\rangle$ is non-zero (and equal to $1$) if and only if the sequence of operators allows a path from virtual state $0$ to virtual state $N$. This occurs precisely when the number of $M^1$ matrices in the product equals $N$, corresponding to $\\sum s_i = N$.\n\nNow, we compute the trace of the projector, $\\text{Tr}(P_N)$. The trace is the sum of the diagonal elements over the entire physical Hilbert space:\n$$\n\\text{Tr}(P_N) = \\sum_{s_1=0}^1 \\sum_{s_2=0}^1 \\cdots \\sum_{s_L=0}^1 \\langle s_1 \\dots s_L | P_N | s_1 \\dots s_L \\rangle\n$$\nUsing the MPO form for the diagonal elements:\n$$\n\\text{Tr}(P_N) = \\sum_{\\{s_i\\}} (B_L M^{s_1} M^{s_2} \\cdots M^{s_L} B_R)\n$$\nDue to the structure of the sum, we can rearrange the terms:\n$$\n\\text{Tr}(P_N) = B_L \\left(\\sum_{s_1=0}^1 M^{s_1}\\right) \\left(\\sum_{s_2=0}^1 M^{s_2}\\right) \\cdots \\left(\\sum_{s_L=0}^1 M^{s_L}\\right) B_R\n$$\nLet us define the transfer matrix $T$ as the sum over local operators:\n$$\nT = \\sum_{s=0}^1 M^s = M^0 + M^1 = I + S_u\n$$\nThe trace is then given by the product:\n$$\n\\text{Tr}(P_N) = B_L T^L B_R = e_0^T (I+S_u)^L e_N\n$$\nThis expression corresponds to the matrix element at row $0$ and column $N$ of the matrix $(I+S_u)^L$.\nWe expand $(I+S_u)^L$ using the binomial theorem:\n$$\n(I+S_u)^L = \\sum_{k=0}^L \\binom{L}{k} I^{L-k} S_u^k = \\sum_{k=0}^L \\binom{L}{k} S_u^k\n$$\nThe matrix element is therefore:\n$$\n[ (I+S_u)^L ]_{0,N} = \\sum_{k=0}^L \\binom{L}{k} [S_u^k]_{0,N}\n$$\nLet us analyze the powers of the shift-up matrix $S_u$. The elements of $S_u$ are $[S_u]_{\\alpha, \\beta} = \\delta_{\\alpha, \\beta-1}$. The elements of its $k$-th power, $[S_u^k]_{\\alpha, \\beta}$, are given by:\n$$\n[S_u^k]_{\\alpha, \\beta} = \\delta_{\\alpha, \\beta-k}\n$$\nWe need the element $[S_u^k]_{0,N} = \\delta_{0, N-k}$. This element is $1$ if $k=N$ and $0$ otherwise.\nSubstituting this into the sum, only the term where $k=N$ survives:\n$$\n\\text{Tr}(P_N) = \\sum_{k=0}^L \\binom{L}{k} \\delta_{k,N} = \\binom{L}{N}\n$$\nThis result is valid for $0 \\le N \\le L$. If $N  L$, the condition $k=N$ is never met for $k \\in \\{0, \\dots, L\\}$, so the sum is zero, correctly reflecting that $\\binom{L}{N}=0$ in this case. The trace is the number of ways to choose $N$ sites out of $L$ to place the particles, which is the dimension of the projected-onto subspace.",
            "answer": "$$\\boxed{\\binom{L}{N}}$$"
        },
        {
            "introduction": "While some states can be represented exactly, an exact MPS representation is often not feasible for highly entangled systems, making approximation essential. This final exercise explores the concept of MPS compression by examining the fidelity loss when approximating the highly-entangled Greenberger–Horne–Zeilinger (GHZ) state with a low bond dimension . It provides critical intuition into the relationship between a state's entanglement structure, the required bond dimension $\\chi$, and the accuracy of its tensor network representation.",
            "id": "2445391",
            "problem": "You are given the Greenberger–Horne–Zeilinger (GHZ) state on a chain of $N$ qubits,\n$$\n\\lvert \\psi_{\\mathrm{GHZ}}^{(N)} \\rangle = \\frac{1}{\\sqrt{2}} \\left( \\lvert 0\\,0\\,\\dots 0 \\rangle + \\lvert 1\\,1\\,\\dots 1 \\rangle \\right),\n$$\nand the class of open-boundary Matrix Product States (MPS) with local physical dimension $2$ and maximum bond dimension $\\chi$. For any pair $(N,\\chi)$, define the compression of $\\lvert \\psi_{\\mathrm{GHZ}}^{(N)} \\rangle$ into this MPS class as the choice of a normalized MPS $\\lvert \\phi_{N,\\chi} \\rangle$ whose maximum virtual bond dimension does not exceed $\\chi$ and that maximizes the fidelity\n$$\nF(N,\\chi) \\equiv \\left| \\langle \\psi_{\\mathrm{GHZ}}^{(N)} \\vert \\phi_{N,\\chi} \\rangle \\right|^2.\n$$\nThe fidelity loss is then\n$$\nL(N,\\chi) \\equiv 1 - F(N,\\chi).\n$$\nYour task is to write a complete, runnable program that, for each $(N,\\chi)$ in the test suite below, computes the fidelity loss $L(N,\\chi)$ as a real number.\n\nAll states are dimensionless, and no physical units apply. Angles do not appear. The required answers are real numbers. Each output value must be rounded to exactly $6$ digits after the decimal point and expressed as a decimal.\n\nTest suite (each entry is a pair $(N,\\chi)$):\n- Case $1$: $N=1$, $\\chi=1$.\n- Case $2$: $N=2$, $\\chi=1$.\n- Case $3$: $N=3$, $\\chi=1$.\n- Case $4$: $N=5$, $\\chi=2$.\n- Case $5$: $N=10$, $\\chi=1$.\n- Case $6$: $N=20$, $\\chi=3$.\n\nFinal output format: Your program should produce a single line of output containing the $6$ fidelity losses, rounded as specified, in the order of the test suite, as a comma-separated list enclosed in square brackets (for example, $[\\ell_1,\\ell_2,\\ell_3,\\ell_4,\\ell_5,\\ell_6]$).",
            "solution": "The problem requires the calculation of the fidelity loss when compressing the $N$-qubit Greenberger–Horne–Zeilinger (GHZ) state into a Matrix Product State (MPS) with a maximum bond dimension $\\chi$.\n\nFirst, we must validate the problem statement.\n\n**Step 1: Extract Givens**\n- The $N$-qubit GHZ state is defined as $\\lvert \\psi_{\\mathrm{GHZ}}^{(N)} \\rangle = \\frac{1}{\\sqrt{2}} \\left( \\lvert 0\\,0\\,\\dots 0 \\rangle + \\lvert 1\\,1\\,\\dots 1 \\rangle \\right)$.\n- The target state class is an open-boundary MPS with physical dimension $d=2$ and maximum bond dimension $\\chi$.\n- The optimal compression $\\lvert \\phi_{N,\\chi} \\rangle$ is a normalized MPS within this class that maximizes the fidelity $F(N,\\chi) = \\left| \\langle \\psi_{\\mathrm{GHZ}}^{(N)} \\vert \\phi_{N,\\chi} \\rangle \\right|^2$.\n- The fidelity loss is $L(N,\\chi) = 1 - F(N,\\chi)$.\n- The task is to compute $L(N,\\chi)$ for the test cases: $(N=1, \\chi=1)$, $(N=2, \\chi=1)$, $(N=3, \\chi=1)$, $(N=5, \\chi=2)$, $(N=10, \\chi=1)$, and $(N=20, \\chi=3)$.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded in the fields of quantum information theory and computational physics. The GHZ state, MPS, and fidelity are all standard, well-defined concepts. The problem of finding the best low-rank MPS approximation to a given quantum state is a central and well-posed problem in tensor network theory. All terms are objective and precisely defined. There are no contradictions, missing information, or pseudoscientific claims. The problem is valid.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A complete solution will be provided.\n\n**Solution Derivation**\nThe solution is derived by analyzing the Schmidt decomposition of the GHZ state, which determines the structure of its exact MPS representation.\n\nThe minimum bond dimension required to represent a quantum state as an MPS is given by the maximum Schmidt rank across all possible bipartitions of the system. Let us perform a Schmidt decomposition of the $\\lvert \\psi_{\\mathrm{GHZ}}^{(N)} \\rangle$ state across an arbitrary cut between site $k$ and site $k+1$, where $k \\in \\{1, \\dots, N-1\\}$. The state can be written as:\n$$\n\\lvert \\psi_{\\mathrm{GHZ}}^{(N)} \\rangle = \\frac{1}{\\sqrt{2}} \\lvert 0 \\dots 0 \\rangle_{1 \\dots k} \\otimes \\lvert 0 \\dots 0 \\rangle_{k+1 \\dots N} + \\frac{1}{\\sqrt{2}} \\lvert 1 \\dots 1 \\rangle_{1 \\dots k} \\otimes \\lvert 1 \\dots 1 \\rangle_{k+1 \\dots N}\n$$\nThis expression is already in the form of a Schmidt decomposition, $\\lvert \\psi \\rangle = \\sum_{i=1}^{r} s_i \\lvert u_i \\rangle_A \\lvert v_i \\rangle_B$.\nThe Schmidt coefficients are $s_1 = 1/\\sqrt{2}$ and $s_2 = 1/\\sqrt{2}$. The orthonormal Schmidt basis states for the left partition are $\\{\\lvert 0 \\dots 0 \\rangle_{1 \\dots k}, \\lvert 1 \\dots 1 \\rangle_{1 \\dots k}\\}$ and for the right partition are $\\{\\lvert 0 \\dots 0 \\rangle_{k+1 \\dots N}, \\lvert 1 \\dots 1 \\rangle_{k+1 \\dots N}\\}$.\n\nSince there are two non-zero Schmidt coefficients, the Schmidt rank is $2$ for any bipartition of the chain (for $N \\ge 2$). The construction of an MPS from a state via sequential Schmidt decompositions implies that the bond dimension of the resulting MPS is equal to the Schmidt rank at each cut. Therefore, the exact MPS representation of the $N$-qubit GHZ state (for $N \\ge 2$) requires a minimum bond dimension of $\\chi=2$.\n\nWith this understanding, we can analyze the test cases.\n\n**Analysis for $\\chi \\ge 2$**\nFor any case where the allowed maximum bond dimension $\\chi$ is greater than or equal to $2$, the GHZ state can be represented exactly as an MPS. This means we can find a normalized MPS $\\lvert \\phi_{N,\\chi} \\rangle$ such that $\\lvert \\phi_{N,\\chi} \\rangle = \\lvert \\psi_{\\mathrm{GHZ}}^{(N)} \\rangle$.\nIn such cases, the maximum fidelity is:\n$$\nF(N,\\chi) = \\left| \\langle \\psi_{\\mathrm{GHZ}}^{(N)} \\vert \\psi_{\\mathrm{GHZ}}^{(N)} \\rangle \\right|^2 = 1^2 = 1\n$$\nThe corresponding fidelity loss is:\n$$\nL(N,\\chi) = 1 - F(N,\\chi) = 1 - 1 = 0\n$$\nThis applies to Case 4 $(N=5, \\chi=2)$ and Case 6 $(N=20, \\chi=3)$. Thus, $L(5,2) = 0$ and $L(20,3) = 0$.\n\n**Analysis for $\\chi = 1$**\nAn MPS with an open boundary and maximum bond dimension $\\chi=1$ is a pure product state:\n$$\n\\lvert \\phi \\rangle = \\bigotimes_{k=1}^N \\lvert \\phi_k \\rangle\n$$\nwhere each $\\lvert \\phi_k \\rangle = a_k \\lvert 0 \\rangle + b_k \\lvert 1 \\rangle$ is a normalized single-qubit state ($|a_k|^2 + |b_k|^2 = 1$). We must find the product state that maximizes the fidelity with the GHZ state. The overlap is:\n$$\n\\langle \\psi_{\\mathrm{GHZ}}^{(N)} \\vert \\phi \\rangle = \\frac{1}{\\sqrt{2}} \\left( \\langle 0\\dots0 \\vert + \\langle 1\\dots1 \\vert \\right) \\left( \\bigotimes_{k=1}^N \\lvert \\phi_k \\rangle \\right) = \\frac{1}{\\sqrt{2}} \\left( \\prod_{k=1}^N \\langle 0 \\vert \\phi_k \\rangle + \\prod_{k=1}^N \\langle 1 \\vert \\phi_k \\rangle \\right)\n$$\nSubstituting $\\langle 0 \\vert \\phi_k \\rangle = a_k^*$ and $\\langle 1 \\vert \\phi_k \\rangle = b_k^*$, the fidelity is:\n$$\nF(N,1) = \\frac{1}{2} \\left| \\prod_{k=1}^N a_k^* + \\prod_{k=1}^N b_k^* \\right|^2\n$$\nTo maximize this quantity, we can use the triangle inequality: $\\left| \\prod a_k^* + \\prod b_k^* \\right| \\le \\left| \\prod a_k^* \\right| + \\left| \\prod b_k^* \\right| = \\prod |a_k| + \\prod |b_k|$. The maximum is achieved when all phases are aligned. We can choose all $a_k$ and $b_k$ to be real and non-negative, $a_k=\\cos\\theta_k, b_k=\\sin\\theta_k$. We wish to maximize $g(\\theta_1, \\dots, \\theta_N) = \\prod \\cos\\theta_k + \\prod \\sin\\theta_k$.\nThis function is maximized at its boundaries. The two global maxima occur when either all $\\theta_k=0$ or all $\\theta_k=\\pi/2$.\n- If $\\theta_k=0$ for all $k$, then $a_k=1, b_k=0$. The state is $\\lvert \\phi \\rangle = \\lvert 00\\dots0 \\rangle$.\n- If $\\theta_k=\\pi/2$ for all $k$, then $a_k=0, b_k=1$. The state is $\\lvert \\phi \\rangle = \\lvert 11\\dots1 \\rangle$.\n\nFor either of these states, the overlap with $\\lvert \\psi_{\\mathrm{GHZ}}^{(N)} \\rangle$ is $1/\\sqrt{2}$. The maximum fidelity is:\n$$\nF(N,1) = \\left| \\frac{1}{\\sqrt{2}} \\right|^2 = \\frac{1}{2}\n$$\nThis holds for any $N \\ge 2$. The corresponding fidelity loss is:\n$$\nL(N,1) = 1 - F(N,1) = 1 - \\frac{1}{2} = 0.5\n$$\nThis applies to Case 2 $(N=2, \\chi=1)$, Case 3 $(N=3, \\chi=1)$, and Case 5 $(N=10, \\chi=1)$. Thus, $L(2,1) = 0.5$, $L(3,1) = 0.5$, and $L(10,1) = 0.5$.\n\n**Special Case: $N=1$**\nFor $N=1$, the GHZ state is $\\lvert \\psi_{\\mathrm{GHZ}}^{(1)} \\rangle = \\frac{1}{\\sqrt{2}} (\\lvert 0 \\rangle + \\lvert 1 \\rangle)$. This is a single-qubit state. An MPS for $N=1$ is simply a state vector in the Hilbert space. The concept of bond dimension is trivial; it can be taken as $1$. The state can be represented exactly.\n$$\n\\lvert \\phi_{1,1} \\rangle = \\lvert \\psi_{\\mathrm{GHZ}}^{(1)} \\rangle\n$$\nThe fidelity is $F(1,1)=1$, and the fidelity loss is $L(1,1)=0$. This solves Case 1.\n\n**Summary of Results**\n- Case 1: $(N=1, \\chi=1) \\implies L = 0.0$\n- Case 2: $(N=2, \\chi=1) \\implies L = 0.5$\n- Case 3: $(N=3, \\chi=1) \\implies L = 0.5$\n- Case 4: $(N=5, \\chi=2) \\implies L = 0.0$\n- Case 5: $(N=10, \\chi=1) \\implies L = 0.5$\n- Case 6: $(N=20, \\chi=3) \\implies L = 0.0$\n\nThe program must compute these values and format them as requested.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the fidelity loss for compressing the GHZ state into an MPS.\n    \"\"\"\n    # Define the test cases from the problem statement as (N, chi) pairs.\n    test_cases = [\n        (1, 1),   # Case 1\n        (2, 1),   # Case 2\n        (3, 1),   # Case 3\n        (5, 2),   # Case 4\n        (10, 1),  # Case 5\n        (20, 3),  # Case 6\n    ]\n\n    results = []\n    for N, chi in test_cases:\n        # The fidelity loss can be determined analytically based on N and chi.\n\n        # Case for N=1:\n        # The 1-qubit GHZ state is |psi = (1/sqrt(2))(|0 + |1).\n        # An MPS for N=1 is just a single qubit state vector.\n        # It can be represented exactly, so fidelity is 1 and loss is 0.\n        # The bond dimension is trivially 1.\n        if N == 1:\n            results.append(0.0)\n            continue\n\n        # Case for N  1:\n        # The Schmidt rank of the N-qubit GHZ state across any bipartition is 2.\n        # This implies the minimal bond dimension for an exact MPS representation is chi=2.\n\n        # If the allowed bond dimension is chi = 2, the state can be represented\n        # exactly. Fidelity is 1, and the fidelity loss is 0.\n        if chi = 2:\n            results.append(0.0)\n            continue\n        \n        # If the allowed bond dimension is chi = 1, the MPS is a product state.\n        # The best product-state approximation to the GHZ state is |0...0 or |1...1.\n        # The fidelity for this approximation is |GHZ|0...0|^2 = |1/sqrt(2)|^2 = 0.5.\n        # The fidelity loss is 1 - 0.5 = 0.5. This holds for any N = 2.\n        if chi == 1:\n            results.append(0.5)\n            continue\n            \n    # Format the results to exactly 6 digits after the decimal point\n    # and join them into the required string format.\n    formatted_results = [f\"{r:.6f}\" for r in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}