{
    "hands_on_practices": [
        {
            "introduction": "Before we can simulate quantum systems, we must choose a reliable numerical algorithm. The time-dependent Schrödinger equation is special because it describes unitary evolution, meaning the total probability (the norm of the wavefunction) must be conserved over time. This exercise challenges you to compare several common methods for solving partial differential equations and understand why some, like the simple Forward-Time Centered-Space (FTCS) scheme, fail spectacularly for the Schrödinger equation, while others, like the Crank-Nicolson and split-operator methods, preserve unitarity and provide stable solutions . Mastering these foundational concepts is the first step toward building accurate and meaningful quantum simulations.",
            "id": "2421331",
            "problem": "Consider the one-dimensional ($1$D) free-particle time-dependent Schrödinger equation\n$$\n\\mathrm{i}\\hbar\\,\\frac{\\partial \\psi(x,t)}{\\partial t} \\;=\\; -\\frac{\\hbar^2}{2m}\\,\\frac{\\partial^2 \\psi(x,t)}{\\partial x^2}\\,,\n$$\nposed on a periodic domain of length $L$ with $\\psi(x+L,t)=\\psi(x,t)$. Space is discretized with a uniform grid $x_j=j\\,\\Delta x$, $j=0,1,\\dots,N-1$, where $\\Delta x = L/N$, and time is stepped with $t^n = n\\,\\Delta t$, $n\\in\\mathbb{N}$. Let $\\psi_j^n$ denote the approximation to $\\psi(x_j,t^n)$. The discrete $\\ell^2$ norm is defined by\n$$\n\\|\\psi^n\\|_2^2 \\;=\\; \\sum_{j=0}^{N-1} |\\psi_j^n|^2\\,\\Delta x\\,.\n$$\nThree standard schemes are considered for advancing $\\psi_j^n$ in time:\n\n- Forward-Time Centered-Space (FTCS): the time derivative is approximated by a forward difference and the spatial second derivative by the centered second difference.\n- Crank–Nicolson: the implicit midpoint rule is applied to the semi-discrete system with the centered second difference Laplacian.\n- Split-operator (Strang splitting): for a general Hamiltonian $H=T+V$, one composes exact substeps for $T$ and $V$; for the free particle ($V\\equiv 0$), this reduces to applying the exact kinetic-energy propagator in Fourier space using the Discrete Fourier Transform (DFT) under periodic boundary conditions.\n\nIn the sense of Von Neumann (Fourier) stability for periodic grids, and with “unconditionally stable” meaning stability without any restriction coupling $\\Delta t$ and $\\Delta x$, which of the following statements correctly characterizes the numerical stability and discrete norm conservation of these schemes for the free-particle problem described above?\n\nA. FTCS is unconditionally unstable and does not conserve the discrete norm; both Crank–Nicolson and the spectral split-operator schemes are unconditionally stable and exactly conserve the discrete norm for any $\\Delta t$.\n\nB. All three schemes are conditionally stable with a time-step restriction of the form $\\Delta t \\le C\\,\\Delta x^2$, and all three conserve the discrete norm only in the limit $\\Delta t \\to 0$.\n\nC. FTCS and Crank–Nicolson are unconditionally stable but introduce artificial damping of high-wavenumber modes, while the split-operator scheme becomes unstable for large $\\Delta t$.\n\nD. FTCS can be made stable by choosing $\\Delta t$ proportional to $\\Delta x^2$; Crank–Nicolson is unconditionally stable but does not conserve the discrete norm exactly; the split-operator method is unconditionally stable and norm-preserving.",
            "solution": "The problem statement will first be validated for scientific soundness and consistency before a solution is attempted.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n- **Governing Equation**: The one-dimensional ($1$D) free-particle time-dependent Schrödinger equation (TDSE):\n$$\n\\mathrm{i}\\hbar\\,\\frac{\\partial \\psi(x,t)}{\\partial t} \\;=\\; -\\frac{\\hbar^2}{2m}\\,\\frac{\\partial^2 \\psi(x,t)}{\\partial x^2}\n$$\n- **Domain and Boundary Conditions**: A periodic domain of length $L$, with $\\psi(x+L,t)=\\psi(x,t)$.\n- **Discretization**:\n    - Space: uniform grid $x_j=j\\,\\Delta x$ for $j=0,1,\\dots,N-1$, with $\\Delta x = L/N$.\n    - Time: uniform steps $t^n = n\\,\\Delta t$ for $n\\in\\mathbb{N}$.\n    - Notation: $\\psi_j^n \\approx \\psi(x_j,t^n)$.\n- **Norm Definition**: The discrete $\\ell^2$ norm is defined as:\n$$\n\\|\\psi^n\\|_2^2 \\;=\\; \\sum_{j=0}^{N-1} |\\psi_j^n|^2\\,\\Delta x\n$$\n- **Numerical Schemes**:\n    1.  **Forward-Time Centered-Space (FTCS)**: Forward difference in time, centered second difference in space.\n    2.  **Crank–Nicolson (CN)**: Implicit midpoint rule on the semi-discretized system.\n    3.  **Split-operator (Strang splitting)**: For $V \\equiv 0$, this is described as applying the exact kinetic-energy propagator in Fourier space using the Discrete Fourier Transform (DFT).\n- **Question**: Characterize the Von Neumann stability and discrete norm conservation of these three schemes for the given problem. \"Unconditionally stable\" is defined as stability for any choice of $\\Delta t$ and $\\Delta x$.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientific Grounding**: The problem is set in the context of computational quantum mechanics, a standard subfield of computational physics. The TDSE is a fundamental equation of quantum mechanics. The numerical methods (FTCS, Crank-Nicolson, spectral methods via split-operator) are all standard, well-documented algorithms for solving such partial differential equations. The method for analysis (Von Neumann stability) is the canonical approach for linear PDEs with constant coefficients on periodic domains. The problem is scientifically and mathematically sound.\n- **Well-Posedness**: The problem asks for the stability properties of specific numerical schemes applied to a specific, well-defined mathematical model. The properties of these schemes are derivable and unique. The question is well-posed.\n- **Objectivity**: The problem is stated using precise, standard terminology from numerical analysis and physics. The definitions provided (e.g., discrete norm) are unambiguous. The problem is objective.\n- **Completeness and Consistency**: The problem provides all necessary information to perform a Von Neumann stability analysis for each scheme. There are no contradictions.\n\n**Step 3: Verdict and Action**\nThe problem statement is valid. It is a standard, well-posed question in computational physics. A solution will be derived.\n\n### Solution Derivation\n\nThe stability of the numerical schemes is assessed using Von Neumann stability analysis. We consider a single Fourier mode ansatz for the numerical solution:\n$$\n\\psi_j^n = G(k)^n e^{\\mathrm{i}kx_j}\n$$\nwhere $k$ is the wavenumber, and $G(k)$ is the amplification factor. The scheme is stable if $|G(k)| \\le 1$ for all relevant wavenumbers $k$. It is unconditionally stable if this condition holds for any choice of time step $\\Delta t$ and spatial step $\\Delta x$. The discrete $\\ell^2$ norm is conserved if and only if $|G(k)|=1$ for all $k$.\n\nThe standard centered second difference approximation for the spatial derivative is:\n$$\n\\frac{\\partial^2 \\psi}{\\partial x^2}\\bigg|_{x_j} \\approx \\frac{\\psi_{j+1} - 2\\psi_j + \\psi_{j-1}}{(\\Delta x)^2}\n$$\nApplying this operator to the Fourier mode $e^{\\mathrm{i}kx_j}$ yields:\n$$\n\\frac{e^{\\mathrm{i}k(x_j+\\Delta x)} - 2e^{\\mathrm{i}kx_j} + e^{\\mathrm{i}k(x_j-\\Delta x)}}{(\\Delta x)^2} = \\frac{e^{\\mathrm{i}kx_j}(e^{\\mathrm{i}k\\Delta x} - 2 + e^{-\\mathrm{i}k\\Delta x})}{(\\Delta x)^2} = e^{\\mathrm{i}kx_j} \\frac{2\\cos(k\\Delta x) - 2}{(\\Delta x)^2} = -e^{\\mathrm{i}kx_j} \\frac{4\\sin^2(k\\Delta x/2)}{(\\Delta x)^2}\n$$\nThe semi-discrete equation is $\\mathrm{i}\\hbar\\,\\frac{d\\psi_j}{dt} = \\hat{H}\\psi_j$, where $\\hat{H}$ is the discrete Hamiltonian operator.\n\n**1. Forward-Time Centered-Space (FTCS)**\nThe FTCS discretization of the TDSE is:\n$$\n\\mathrm{i}\\hbar\\,\\frac{\\psi_j^{n+1} - \\psi_j^n}{\\Delta t} = -\\frac{\\hbar^2}{2m}\\,\\frac{\\psi_{j+1}^n - 2\\psi_j^n + \\psi_{j-1}^n}{(\\Delta x)^2}\n$$\nSubstituting the Fourier mode $\\psi_j^n = G^n e^{\\mathrm{i}kx_j}$:\n$$\n\\mathrm{i}\\hbar\\,\\frac{G^{n+1} - G^n}{\\Delta t} e^{\\mathrm{i}kx_j} = -\\frac{\\hbar^2}{2m} G^n \\left( -e^{\\mathrm{i}kx_j} \\frac{4\\sin^2(k\\Delta x/2)}{(\\Delta x)^2} \\right)\n$$\nDividing by $G^n e^{\\mathrm{i}kx_j}$ and solving for $G = G^{n+1}/G^n$:\n$$\n\\mathrm{i}\\hbar\\,\\frac{G - 1}{\\Delta t} = \\frac{2\\hbar^2}{m(\\Delta x)^2} \\sin^2(k\\Delta x/2)\n$$\n$$\nG(k) = 1 - \\mathrm{i} \\frac{2\\hbar\\Delta t}{m(\\Delta x)^2} \\sin^2(k\\Delta x/2)\n$$\nThe squared magnitude of the amplification factor is:\n$$\n|G(k)|^2 = 1^2 + \\left(\\frac{2\\hbar\\Delta t}{m(\\Delta x)^2} \\sin^2(k\\Delta x/2)\\right)^2 = 1 + \\frac{4\\hbar^2(\\Delta t)^2}{m^2(\\Delta x)^4} \\sin^4(k\\Delta x/2)\n$$\nFor any $k$ such that $\\sin(k\\Delta x/2) \\neq 0$, and for any $\\Delta t > 0$, we have $|G(k)|^2 > 1$. The amplitude of the modes grows exponentially. Thus, the FTCS scheme is **unconditionally unstable** for the Schrödinger equation. Consequently, it does not conserve the norm.\n\n**2. Crank–Nicolson (CN)**\nThe CN scheme is an implicit method defined by:\n$$\n\\mathrm{i}\\hbar\\,\\frac{\\psi_j^{n+1} - \\psi_j^n}{\\Delta t} = \\frac{1}{2} \\left[ \\left(-\\frac{\\hbar^2}{2m}\\frac{\\partial^2}{\\partial x^2}\\right)\\psi^{n+1} + \\left(-\\frac{\\hbar^2}{2m}\\frac{\\partial^2}{\\partial x^2}\\right)\\psi^n \\right]_j\n$$\nUsing the discrete spatial operator, we substitute the Fourier mode:\n$$\n\\mathrm{i}\\hbar\\,\\frac{G - 1}{\\Delta t} = \\frac{1}{2} \\left[ G\\left(\\frac{2\\hbar^2}{m(\\Delta x)^2}\\sin^2(k\\Delta x/2)\\right) + \\left(\\frac{2\\hbar^2}{m(\\Delta x)^2}\\sin^2(k\\Delta x/2)\\right) \\right]\n$$\nLet $\\omega_k^{\\text{num}} = \\frac{2\\hbar}{m(\\Delta x)^2}\\sin^2(k\\Delta x/2)$. The equation for $G$ becomes:\n$$\n\\mathrm{i}\\hbar\\,\\frac{G - 1}{\\Delta t} = \\frac{1}{2} \\hbar\\omega_k^{\\text{num}} (G+1) \\implies \\mathrm{i}\\frac{G - 1}{\\Delta t} = \\frac{1}{2} \\omega_k^{\\text{num}} (G+1)\n$$\n$$\nG\\left( \\mathrm{i} - \\frac{\\Delta t \\omega_k^{\\text{num}}}{2} \\right) = \\left( \\mathrm{i} + \\frac{\\Delta t \\omega_k^{\\text{num}}}{2} \\right) \\implies G(k) = \\frac{\\mathrm{i} + \\Delta t \\omega_k^{\\text{num}}/2}{\\mathrm{i} - \\Delta t \\omega_k^{\\text{num}}/2} = \\frac{1 - \\mathrm{i}\\Delta t \\omega_k^{\\text{num}}/2}{1 + \\mathrm{i}\\Delta t \\omega_k^{\\text{num}}/2}\n$$\nThis expression is of the form $(1-\\mathrm{i}a)/(1+\\mathrm{i}a)$ where $a = \\Delta t \\omega_k^{\\text{num}}/2$ is a real number. The magnitude squared is:\n$$\n|G(k)|^2 = \\frac{|1-\\mathrm{i}a|^2}{|1+\\mathrm{i}a|^2} = \\frac{1+a^2}{1+a^2} = 1\n$$\nSince $|G(k)| = 1$ for all $k$, $\\Delta t$, and $\\Delta x$, the CN scheme is **unconditionally stable**. Furthermore, because $|G(k)| = 1$ identically, the scheme is unitary and **exactly conserves the discrete $\\ell^2$ norm** for any finite $\\Delta t$.\n\n**3. Split-operator / Spectral Method**\nFor a free particle ($V \\equiv 0$), the Hamiltonian is $H=T = -\\frac{\\hbar^2}{2m}\\frac{\\partial^2}{\\partial x^2}$. The split-operator method reduces to applying the exact propagator for $T$. This is most efficiently done in Fourier space.\nThe algorithm is:\n1.  Compute the DFT of the state $\\psi_j^n \\rightarrow \\hat{\\psi}_k^n$.\n2.  Propagate each Fourier component exactly for a time step $\\Delta t$:\n    The TDSE in Fourier space is $\\mathrm{i}\\hbar \\frac{\\partial \\hat{\\psi}(k,t)}{\\partial t} = \\frac{\\hbar^2k^2}{2m} \\hat{\\psi}(k,t)$.\n    The solution is $\\hat{\\psi}(k, t^n+\\Delta t) = e^{-\\mathrm{i}\\frac{\\hbar k^2}{2m}\\Delta t} \\hat{\\psi}(k,t^n)$.\n    So, the update rule for the discrete Fourier coefficients is $\\hat{\\psi}_k^{n+1} = e^{-\\mathrm{i}\\frac{\\hbar k_p^2}{2m}\\Delta t} \\hat{\\psi}_k^n$, where $k_p$ are the discrete wavenumbers corresponding to the grid.\n3.  Compute the Inverse DFT of $\\hat{\\psi}_k^{n+1}$ to get $\\psi_j^{n+1}$.\nThe amplification factor is thus $G(k_p) = e^{-\\mathrm{i}\\frac{\\hbar k_p^2}{2m}\\Delta t}$. Its magnitude is:\n$$\n|G(k_p)| = \\left|e^{-\\mathrm{i}\\frac{\\hbar k_p^2}{2m}\\Delta t}\\right| = 1\n$$\nfor all $k_p$ and any $\\Delta t$. This scheme is therefore **unconditionally stable**.\nFor norm conservation, we use Parseval's theorem for the DFT, which states that $\\sum_{j=0}^{N-1} |f_j|^2 = \\frac{1}{N}\\sum_{k=0}^{N-1} |\\hat{f}_k|^2$.\n$$\n\\|\\psi^{n+1}\\|_2^2 = \\sum_{j=0}^{N-1} |\\psi_j^{n+1}|^2 \\Delta x = \\Delta x \\left(\\frac{1}{N}\\sum_{k=0}^{N-1} |\\hat{\\psi}_k^{n+1}|^2\\right)\n$$\nSince $\\hat{\\psi}_k^{n+1} = G(k_p) \\hat{\\psi}_k^n$ and $|G(k_p)|=1$, we have $|\\hat{\\psi}_k^{n+1}|^2 = |\\hat{\\psi}_k^n|^2$.\n$$\n\\|\\psi^{n+1}\\|_2^2 = \\frac{\\Delta x}{N}\\sum_{k=0}^{N-1} |\\hat{\\psi}_k^n|^2 = \\|\\psi^n\\|_2^2\n$$\nThe scheme **exactly conserves the discrete $\\ell^2$ norm**.\n\n### Option-by-Option Analysis\n\n- **A. FTCS is unconditionally unstable and does not conserve the discrete norm; both Crank–Nicolson and the spectral split-operator schemes are unconditionally stable and exactly conserve the discrete norm for any $\\Delta t$.**\nThis statement aligns perfectly with the derivations above. FTCS is unconditionally unstable ($|G|>1$). Both CN and the spectral method are unconditionally stable and exactly norm-conserving ($|G|=1$).\nThis statement is **Correct**.\n\n- **B. All three schemes are conditionally stable with a time-step restriction of the form $\\Delta t \\le C\\,\\Delta x^2$, and all three conserve the discrete norm only in the limit $\\Delta t \\to 0$.**\nThis is incorrect. FTCS is unconditionally unstable. CN and the spectral method are unconditionally stable, not conditionally. CN and the spectral method conserve the norm exactly for any $\\Delta t > 0$, not only in the limit.\nThis statement is **Incorrect**.\n\n- **C. FTCS and Crank–Nicolson are unconditionally stable but introduce artificial damping of high-wavenumber modes, while the split-operator scheme becomes unstable for large $\\Delta t$.**\nThis is incorrect. FTCS is unconditionally unstable and causes amplification, not damping. CN is unconditionally stable but does not introduce damping; it is norm-preserving. The split-operator scheme is unconditionally stable.\nThis statement is **Incorrect**.\n\n- **D. FTCS can be made stable by choosing $\\Delta t$ proportional to $\\Delta x^2$; Crank–Nicolson is unconditionally stable but does not conserve the discrete norm exactly; the split-operator method is unconditionally stable and norm-preserving.**\nThis is incorrect. The FTCS scheme for the Schrödinger equation is always unstable, regardless of the choice of $\\Delta t$. The stability condition mentioned is for the diffusion equation. Crank–Nicolson does conserve the discrete norm exactly. While the last part about the split-operator method is correct, the first two parts are false.\nThis statement is **Incorrect**.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "The machinery for simulating time evolution can be ingeniously repurposed to find the ground state of a quantum system—its state of lowest possible energy. By making the mathematical substitution $t \\rightarrow -i\\tau$, known as a Wick rotation, the oscillatory Schrödinger equation transforms into a diffusion-like equation in \"imaginary time.\" As this equation evolves, any components of the wavefunction corresponding to higher energy states decay exponentially faster than the ground state component, which allows us to filter out everything else. This practice applies the stable split-operator spectral method to perform imaginary time evolution and efficiently calculate the ground state energy and wavefunction for a particle in a classic double-well potential .",
            "id": "2421305",
            "problem": "Consider the one-dimensional time-dependent Schrödinger equation (TDSE) for a particle of mass $m$ in a potential $V(x)$,\n$$\ni \\hbar \\,\\frac{\\partial \\psi(x,t)}{\\partial t} \\;=\\; \\left[-\\frac{\\hbar^2}{2m}\\frac{\\partial^2}{\\partial x^2} + V(x)\\right]\\psi(x,t).\n$$\nLet the potential be a symmetric double-well of the form\n$$\nV(x) \\;=\\; a \\,\\bigl(x^2 - b^2\\bigr)^2,\n$$\nwith parameters $a \\gt 0$ and $b \\ge 0$. Work in the unit system where $\\hbar = 1$ and $m=1$, so energies must be reported in the corresponding energy unit implied by these choices. You are to determine the ground-state wavefunction $\\psi_0(x)$ and the corresponding ground-state energy $E_0$ by solving the TDSE under the substitution $t \\rightarrow -i \\tau$, and by enforcing normalization of the evolving state at all times. The computational domain is the finite interval $x \\in [-L, L]$ with $L = 10$, discretized on a uniform grid of $N = 1024$ points. Use a square-integrable initial condition that is nonzero everywhere on the grid; specifically, initialize at $\\tau = 0$ with the normalized Gaussian\n$$\n\\psi(x,0) \\;\\propto\\; \\exp\\!\\left(-\\frac{x^2}{2\\sigma^2}\\right), \\quad \\sigma = 1.0.\n$$\nEvolve in imaginary time with a fixed step $\\Delta \\tau = 10^{-3}$ and continue until the change in the computed energy between successive convergence checks is less than $10^{-9}$ in absolute value, or until a maximum of $2\\times 10^4$ steps is reached. At convergence (or upon reaching the maximum number of steps), report the computed ground-state energy $E_0$.\n\nUnits and numerical conventions:\n- Use $\\hbar = 1$ and $m=1$; express all energies in these units.\n- Angle arguments to any trigonometric or exponential functions are in radians by mathematical convention.\n\nTest suite:\nCompute and report the ground-state energy $E_0$ for each of the following parameter pairs $(a,b)$:\n1. $(a,b) = (1.0,\\,1.0)$\n2. $(a,b) = (1.0,\\,1.5)$\n3. $(a,b) = (5.0,\\,1.0)$\n4. $(a,b) = (0.5,\\,0.0)$\n\nFinal output format:\nYour program should produce a single line of output containing the results as a comma-separated list of decimal numbers enclosed in square brackets and ordered exactly as the test suite above. Each number must be rounded to six decimal places. For example, a valid output line has the form\n$[e_1,e_2,e_3,e_4]$\nwith no spaces.",
            "solution": "The problem posed is a well-defined exercise in computational quantum mechanics and is therefore valid. It asks for the ground-state energy of a particle in a one-dimensional double-well potential by solving the Schrödinger equation in imaginary time. This is a standard and robust method for finding the ground state of a quantum system.\n\nThe fundamental equation is the time-dependent Schrödinger equation (TDSE):\n$$\ni \\hbar \\frac{\\partial \\psi(x,t)}{\\partial t} = H \\psi(x,t)\n$$\nwhere the Hamiltonian operator is $H = T + V$, with the kinetic energy operator $T = -\\frac{\\hbar^2}{2m}\\frac{\\partial^2}{\\partial x^2}$ and the potential energy operator $V = V(x)$. The problem specifies the units $\\hbar=1$ and $m=1$, and the potential $V(x) = a(x^2 - b^2)^2$.\n\nThe method of imaginary time evolution involves the substitution $t \\rightarrow -i\\tau$. The TDSE transforms into a diffusion-like equation in the imaginary time coordinate $\\tau$:\n$$\n\\frac{\\partial \\psi(x,\\tau)}{\\partial \\tau} = -H \\psi(x,\\tau)\n$$\nThe formal solution to this equation over a small time step $\\Delta\\tau$ is given by\n$$\n\\psi(x, \\tau + \\Delta\\tau) = e^{-H\\Delta\\tau} \\psi(x,\\tau).\n$$\nTo understand why this process yields the ground state, we expand an arbitrary initial state $\\psi(x,0)$ in the complete basis of energy eigenfunctions $\\{\\psi_n(x)\\}$ of the Hamiltonian $H$, for which $H\\psi_n = E_n\\psi_n$:\n$$\n\\psi(x,0) = \\sum_{n=0}^{\\infty} c_n \\psi_n(x)\n$$\nThe evolution in imaginary time is then\n$$\n\\psi(x,\\tau) = e^{-H\\tau} \\psi(x,0) = \\sum_{n=0}^{\\infty} c_n e^{-H\\tau} \\psi_n(x) = \\sum_{n=0}^{\\infty} c_n e^{-E_n\\tau} \\psi_n(x).\n$$\nThis can be rewritten as:\n$$\n\\psi(x,\\tau) = c_0 e^{-E_0\\tau} \\psi_0(x) + c_1 e^{-E_1\\tau} \\psi_1(x) + \\dots\n$$\nSince the ground-state energy $E_0$ is the lowest energy ($E_n > E_0$ for $n > 0$), the term $e^{-E_0\\tau}$ decays more slowly than all other terms $e^{-E_n\\tau}$. Consequently, as $\\tau \\rightarrow \\infty$, the wavefunction becomes dominated by the ground-state component, provided the initial state has a non-zero overlap with it ($c_0 \\neq 0$).\n$$\n\\lim_{\\tau\\to\\infty} \\psi(x,\\tau) \\propto \\psi_0(x)\n$$\nThe overall amplitude decays as $e^{-E_0\\tau}$. To extract the wavefunction $\\psi_0(x)$, the state must be renormalized at each step.\n\nThe numerical implementation of the evolution operator $e^{-H\\Delta\\tau}$ is achieved using the split-step Fourier method. Since the kinetic ($T$) and potential ($V$) operators do not commute, we cannot simply write $e^{-(T+V)\\Delta\\tau} = e^{-T\\Delta\\tau}e^{-V\\Delta\\tau}$. Instead, we use a symmetric second-order Trotter-Suzuki decomposition (Strang splitting), which is accurate to order $(\\Delta\\tau)^2$:\n$$\ne^{-H\\Delta\\tau} = e^{-(T+V)\\Delta\\tau} \\approx e^{-V\\Delta\\tau/2} e^{-T\\Delta\\tau} e^{-V\\Delta\\tau/2}\n$$\nThe algorithm for a single time step $\\Delta\\tau$ proceeds as follows:\n1.  Propagate the wavefunction by half a step under the potential operator. This is a simple multiplication in position space: $\\psi'(x) = e^{-V(x)\\Delta\\tau/2} \\psi(x)$.\n2.  Propagate by a full step under the kinetic operator. This operation is simple in momentum space, where the kinetic operator is diagonal. We transform the wavefunction to momentum space using the Fast Fourier Transform (FFT), $\\tilde{\\psi}'(k) = \\mathcal{F}\\{\\psi'(x)\\}$.\n3.  In momentum space, the propagation is a multiplication: $\\tilde{\\psi}''(k) = e^{-T(k)\\Delta\\tau} \\tilde{\\psi}'(k)$, where $T(k) = \\frac{\\hbar^2 k^2}{2m} = \\frac{k^2}{2}$ in the given units.\n4.  Transform the result back to position space using the inverse FFT: $\\psi''(x) = \\mathcal{F}^{-1}\\{\\tilde{\\psi}''(k)\\}$.\n5.  Propagate by the remaining half step under the potential operator: $\\psi(x, \\tau+\\Delta\\tau) = e^{-V(x)\\Delta\\tau/2} \\psi''(x)$.\n6.  Finally, re-normalize the wavefunction to unity: $\\psi \\leftarrow \\psi / \\sqrt{\\int |\\psi|^2 dx}$.\n\nThis sequence is repeated until the energy converges. The ground-state energy $E_0$ is the expectation value of the Hamiltonian for the converged ground-state wavefunction $\\psi_0$:\n$$\nE_0 = \\langle \\psi_0 | H | \\psi_0 \\rangle = \\int_{-\\infty}^{\\infty} \\psi_0^*(x) H \\psi_0(x) dx\n$$\nNumerically, the term $H\\psi_0$ is computed as $(T+V)\\psi_0$. The application of the kinetic operator $T\\psi_0 = -\\frac{1}{2}\\frac{\\partial^2\\psi_0}{\\partial x^2}$ is again efficiently performed in Fourier space: $T\\psi_0 = \\mathcal{F}^{-1} \\{ \\frac{k^2}{2} \\mathcal{F}\\{\\psi_0\\} \\}$. The integral is then computed as a sum over the discrete grid points. The process is terminated when the absolute difference between energy values from successive checks falls below the specified tolerance of $10^{-9}$.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve for the ground-state energy for the given test cases.\n    \"\"\"\n    test_cases = [\n        (1.0, 1.0),\n        (1.0, 1.5),\n        (5.0, 1.0),\n        (0.5, 0.0),\n    ]\n\n    results = []\n    for a, b in test_cases:\n        energy = find_ground_state_energy(a, b)\n        results.append(energy)\n\n    # Format the final output string as specified.\n    print(f\"[{','.join([f'{r:.6f}' for r in results])}]\")\n\ndef find_ground_state_energy(a, b):\n    \"\"\"\n    Calculates the ground-state energy for a given double-well potential V(x) = a(x^2 - b^2)^2.\n\n    The calculation uses the imaginary time evolution method with a split-step Fourier\n    transform algorithm to solve the time-dependent Schrödinger equation.\n\n    Args:\n        a (float): The 'a' parameter of the potential.\n        b (float): The 'b' parameter of the potential.\n\n    Returns:\n        float: The computed ground-state energy.\n    \"\"\"\n    # System parameters and constants (hbar=1, m=1)\n    L = 10.0\n    N = 1024\n    dx = 2 * L / N\n    x = np.linspace(-L, L, num=N, endpoint=False)\n    k = 2 * np.pi * np.fft.fftfreq(N, d=dx)\n\n    # Potential energy array\n    V = a * (x**2 - b**2)**2\n\n    # Kinetic energy in momentum space\n    T_k = k**2 / 2.0\n\n    # Imaginary time evolution parameters\n    dtau = 1.0e-3\n    max_steps = 20000\n    convergence_tol = 1.0e-9\n    check_interval = 100\n\n    # Initial wavefunction: a normalized Gaussian\n    sigma = 1.0\n    psi = np.exp(-x**2 / (2 * sigma**2))\n    norm = np.sqrt(np.sum(np.abs(psi)**2) * dx)\n    psi = psi / norm\n\n    # Split-step propagation operators\n    V_op_half = np.exp(-V * dtau / 2.0)\n    T_op = np.exp(-T_k * dtau)\n\n    E_old = 0.0\n    E_final = 0.0\n\n    for step in range(1, max_steps + 1):\n        # Strang splitting for one time step\n        # 1. Half step in potential\n        psi *= V_op_half\n        \n        # 2. Full step in kinetic (in momentum space)\n        psi_k = np.fft.fft(psi)\n        psi_k *= T_op\n        psi = np.fft.ifft(psi_k)\n        \n        # 3. Second half step in potential\n        psi *= V_op_half\n\n        # Normalize the wavefunction\n        norm = np.sqrt(np.sum(np.abs(psi)**2) * dx)\n        psi /= norm\n\n        # Check for convergence at specified intervals\n        if step % check_interval == 0:\n            # Calculate energy E = <psi|H|psi>\n            # H_psi = (T + V) * psi\n            # T*psi is computed using FFT: IFFT(T_k * FFT(psi))\n            psi_k = np.fft.fft(psi)\n            T_psi = np.fft.ifft(T_k * psi_k)\n            H_psi = T_psi + V * psi\n            \n            E_new = np.real(np.sum(np.conj(psi) * H_psi) * dx)\n\n            if np.abs(E_new - E_old)  convergence_tol:\n                E_final = E_new\n                break\n            \n            E_old = E_new\n    else:\n        # If the loop completes without converging, calculate the energy one last time.\n        psi_k = np.fft.fft(psi)\n        T_psi = np.fft.ifft(T_k * psi_k)\n        H_psi = T_psi + V * psi\n        E_final = np.real(np.sum(np.conj(psi) * H_psi) * dx)\n\n    return E_final\n    \nsolve()\n```"
        },
        {
            "introduction": "With a stable time-evolution method in hand, we can now simulate one of the most iconic and non-classical phenomena in quantum mechanics: quantum tunneling. This exercise asks you to investigate how a Gaussian wave packet interacts with a potential barrier that would be insurmountable for a classical particle with the same average energy. By numerically solving the time-dependent Schrödinger equation, we can watch the wave packet evolve, split into reflected and transmitted parts, and ultimately calculate the probability of tunneling . This practice provides a direct and visually intuitive way to understand how the properties of a wave packet, such as its momentum spread, influence its dynamic behavior.",
            "id": "2432557",
            "problem": "Consider a one-dimensional non-relativistic particle governed by the time-dependent Schrödinger equation in nondimensionalized units where Planck’s constant divided by $2\\pi$ is $1$ and the mass is $1$. The equation is\n$$\ni \\frac{\\partial \\psi(x,t)}{\\partial t} \\;=\\; -\\frac{1}{2}\\,\\frac{\\partial^2 \\psi(x,t)}{\\partial x^2} \\;+\\; V(x)\\,\\psi(x,t),\n$$\nwith a square barrier potential\n$$\nV(x) \\;=\\; \\begin{cases}\nV_0,  \\text{for } -\\frac{a}{2} \\le x \\le \\frac{a}{2} \\\\\n0,  \\text{otherwise}\n\\end{cases}\n$$\nThe barrier parameters are fixed to $V_0 = 5$ and $a = 1.5$. The initial state at time $t=0$ is a normalized Gaussian wave packet incident from the left with mean wave number $k_0 = 2.0$ and momentum spread (standard deviation) $\\Delta k  0$. In position representation, it is specified by\n$$\n\\psi(x,0) \\;=\\; \\frac{1}{(2\\pi \\sigma_x^2)^{1/4}} \\exp\\!\\Big(-\\frac{(x-x_0)^2}{4\\sigma_x^2}\\Big)\\,\\exp(i k_0 x),\n$$\nwith $\\Delta k = \\frac{1}{2\\sigma_x}$ and an arbitrary $x_0 \\ll -\\frac{a}{2}$ chosen so that the wave packet is initially well to the left of the barrier. The tunneling probability of the wave packet is defined as the total probability that is found for $x  \\frac{a}{2}$ in the long-time limit $t \\to \\infty$ after the scattering has fully completed. All quantities are dimensionless; the final answers should be pure numbers without units.\n\nTask: For each specified value of $\\Delta k$ in the test suite below, compute the tunneling probability of the wave packet through the barrier described above, assuming the barrier is static and the evolution is governed entirely by the Schrödinger dynamics given.\n\nTest suite (values of $\\Delta k$ to evaluate): $\\{0.05,\\;0.10,\\;0.20,\\;0.50,\\;0.70\\}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., [r1,r2,r3,r4,r5]), where each entry corresponds to the tunneling probability for the corresponding $\\Delta k$ in the order listed above. Each reported result must be a real number in the closed interval $[0,1]$.",
            "solution": "The problem statement is subjected to validation.\n\nStep 1: Extracted Givens\n- Governing Equation: One-dimensional time-dependent Schrödinger equation: $i \\frac{\\partial \\psi(x,t)}{\\partial t} = -\\frac{1}{2}\\frac{\\partial^2 \\psi(x,t)}{\\partial x^2} + V(x)\\psi(x,t)$.\n- Constants: $\\hbar = 1$, mass $m = 1$.\n- Potential: Square barrier, $V(x) = V_0$ for $-\\frac{a}{2} \\le x \\le \\frac{a}{2}$, and $V(x)=0$ otherwise.\n- Barrier Parameters: $V_0 = 5$, $a = 1.5$.\n- Initial State ($t=0$): A normalized Gaussian wave packet, $\\psi(x,0) = \\frac{1}{(2\\pi \\sigma_x^2)^{1/4}} \\exp(-\\frac{(x-x_0)^2}{4\\sigma_x^2})\\exp(i k_0 x)$.\n- Wave Packet Parameters: Mean wave number $k_0 = 2.0$, momentum spread $\\Delta k  0$.\n- Relation: $\\Delta k = \\frac{1}{2\\sigma_x}$.\n- Initial Position: $x_0 \\ll -a/2$.\n- Definition of Tunneling Probability: $P_{tunnel} = \\lim_{t \\to \\infty} \\int_{a/2}^{\\infty} |\\psi(x,t)|^2 dx$.\n- Task: Compute $P_{tunnel}$ for each $\\Delta k$ in the test suite.\n- Test Suite: $\\Delta k \\in \\{0.05, 0.10, 0.20, 0.50, 0.70\\}$.\n\nStep 2: Validation Using Extracted Givens\nThe problem is scientifically grounded, describing the quantum tunneling of a wave packet, a cornerstone of quantum mechanics. It is well-posed, with a specified governing equation, initial condition, and a clear definition for the quantity to be computed. The condition $x_0 \\ll -a/2$ is a standard requirement in scattering problems, ensuring the initial state does not overlap with the interaction region, and does not invalidate the problem. All parameters are clearly defined and physically consistent. The problem does not violate any of the invalidity criteria.\n\nStep 3: Verdict and Action\nThe problem is valid. A solution will be provided.\n\nThe task is to compute the probability that a quantum wave packet tunnels through a potential barrier. A direct numerical simulation of the time-dependent Schrödinger equation is possible, for instance, using a split-step Fourier method. However, for the given parameters, this approach is problematic. The wave packets corresponding to larger values of $\\Delta k$ are narrow in position space and will spread significantly during the long time evolution required for the scattering process to complete. This necessitates an exceptionally large spatial grid to prevent the wave function from reaching the boundaries and causing unphysical wrap-around effects, making the direct simulation computationally intensive and numerically delicate.\n\nA more robust and elegant method is to use the principles of stationary-state scattering theory. The initial wave packet $\\psi(x,0)$ can be represented as a superposition of plane waves (momentum eigenstates) via a Fourier transform. The momentum-space representation of the initial wave packet is also a Gaussian:\n$$\n\\phi(k) = \\mathcal{F}\\{\\psi(x,0)\\} \\propto \\exp\\left(-\\sigma_x^2 (k-k_0)^2\\right)\n$$\nThe corresponding probability distribution in momentum space is\n$$\n|\\phi(k)|^2 = \\frac{1}{\\sqrt{2\\pi(\\Delta k)^2}} \\exp\\left(-\\frac{(k-k_0)^2}{2(\\Delta k)^2}\\right)\n$$\nwhere $\\Delta k = 1/(2\\sigma_x)$ is the standard deviation of the momentum distribution, as given.\n\nEach momentum component $k$ of the wave packet corresponds to a plane wave with a definite energy $E(k) = \\frac{\\hbar^2 k^2}{2m}$. Since we work in units where $\\hbar=1$ and $m=1$, this simplifies to $E(k) = k^2/2$. For each such plane wave, the probability of transmission through a square barrier is given by a standard analytical formula, the transmission coefficient $T(E)$.\n\nFor an incident particle with energy $E$ and a square barrier of height $V_0$ and width $a$, the transmission coefficient $T(E)$ is given by:\n1. For $E  V_0$ (tunneling):\n$$ T(E) = \\left[ 1 + \\frac{V_0^2}{4E(V_0-E)} \\sinh^2(\\kappa a) \\right]^{-1}, \\quad \\text{where } \\kappa = \\sqrt{2m(V_0-E)}/\\hbar = \\sqrt{2(V_0-E)} $$\n2. For $E  V_0$ (over-barrier scattering):\n$$ T(E) = \\left[ 1 + \\frac{V_0^2}{4E(E-V_0)} \\sin^2(q a) \\right]^{-1}, \\quad \\text{where } q = \\sqrt{2m(E-V_0)}/\\hbar = \\sqrt{2(E-V_0)} $$\n3. For the special case $E = V_0$:\n$$ T(E=V_0) = \\left[ 1 + \\frac{m V_0 a^2}{2\\hbar^2} \\right]^{-1} = \\left[ 1 + \\frac{V_0 a^2}{2} \\right]^{-1} $$\n\nThe total tunneling probability for the entire wave packet is the expectation value of the transmission coefficient $T(E(k))$ over the momentum distribution of the wave packet. Since the wave packet is incident from the left, only components with positive momentum $k0$ are moving towards the barrier and can contribute to transmission. Thus, the integral is taken over $k \\in [0, \\infty)$:\n$$\nP_{tunnel} = \\int_{0}^{\\infty} |\\phi(k)|^2 \\, T(E(k)) \\, dk\n$$\nSubstituting the expressions for $|\\phi(k)|^2$ and $E(k)$, we obtain the integral to be computed:\n$$\nP_{tunnel} = \\int_{0}^{\\infty} \\frac{1}{\\sqrt{2\\pi(\\Delta k)^2}} \\exp\\left(-\\frac{(k-k_0)^2}{2(\\Delta k)^2}\\right) T\\left(\\frac{k^2}{2}\\right) \\, dk\n$$\nThis integral cannot be solved analytically due to the complexity of $T(E(k))$. However, it can be computed with high precision using numerical quadrature methods. This approach is computationally efficient and avoids the difficulties of a full time-dependent simulation.\n\nThe algorithm is as follows:\n1. For each value of $\\Delta k$ from the test suite $\\{0.05, 0.10, 0.20, 0.50, 0.70\\}$:\n2. Define the integrand function, which takes a momentum value $k$ and computes the product of the momentum probability density and the corresponding transmission coefficient $T(k^2/2)$.\n3. Use a numerical integration routine, such as `scipy.integrate.quad`, to compute the definite integral of this function from $k=0$ to a sufficiently large upper limit (e.g., $k_0 + 10 \\Delta k$, where the Gaussian tail is negligible).\n4. Store the resulting probability.\n5. Report the collected results in the specified format.\nThe fixed parameters are $V_0=5$, $a=1.5$, and $k_0=2.0$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import integrate\n\ndef solve():\n    \"\"\"\n    Solves the quantum tunneling problem for a Gaussian wave packet.\n\n    The solution calculates the tunneling probability by integrating the\n    energy-dependent transmission coefficient T(E) over the energy\n    distribution of the initial wave packet. This avoids a full\n    time-dependent simulation, which is computationally intensive and\n    numerically challenging for the given parameters.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    test_cases = [0.05, 0.10, 0.20, 0.50, 0.70]\n\n    # Fixed parameters of the physical system\n    V0 = 5.0     # Barrier height\n    a = 1.5      # Barrier width\n    k0 = 2.0     # Mean wave number of the packet\n    hbar = 1.0   # Reduced Planck constant\n    m = 1.0      # Particle mass\n\n    def transmission_coefficient(E, V0, a):\n        \"\"\"\n        Calculates the transmission coefficient T(E) for a square barrier.\n        Handles three cases: E  V0 (tunneling), E  V0 (scattering), and E = V0.\n        \"\"\"\n        # A particle with zero or negative energy cannot be incident from the left\n        # and reach the barrier, so its transmission probability is zero.\n        if E = 0:\n            return 0.0\n\n        # Case 1: E is exactly V0. This is the limit of the other two cases.\n        if np.isclose(E, V0):\n            return 1.0 / (1.0 + (m * V0 * a**2) / (2 * hbar**2))\n        \n        # Case 2: E  V0 (classical tunneling region)\n        elif E  V0:\n            kappa = np.sqrt(2 * m * (V0 - E)) / hbar\n            sinh_term = np.sinh(kappa * a)\n            denom = 1.0 + (V0**2 * sinh_term**2) / (4 * E * (V0 - E))\n            return 1.0 / denom\n        \n        # Case 3: E  V0 (classical over-barrier region)\n        else: # E  V0\n            q = np.sqrt(2 * m * (E - V0)) / hbar\n            sin_term = np.sin(q * a)\n            denom = 1.0 + (V0**2 * sin_term**2) / (4 * E * (E - V0))\n            return 1.0 / denom\n\n    results = []\n    for delta_k in test_cases:\n        \n        def integrand(k):\n            \"\"\"\n            The function to be integrated over momentum k.\n            It's the product of the momentum probability distribution and the\n            transmission coefficient T(E(k)).\n            \"\"\"\n            # Energy as a function of momentum k\n            E = (hbar**2 * k**2) / (2 * m)\n            \n            # Probability density of the momentum distribution (Gaussian)\n            norm_factor = 1.0 / (np.sqrt(2 * np.pi) * delta_k)\n            prob_density_k = norm_factor * np.exp(-((k - k0)**2) / (2 * delta_k**2))\n            \n            # Transmission coefficient for energy E\n            T_E = transmission_coefficient(E, V0, a)\n            \n            return prob_density_k * T_E\n\n        # The integration is performed from k=0 to infinity.\n        # We integrate from k=0 because only right-moving components (k0)\n        # can interact with the barrier.\n        # quad integrates from the lower limit to the upper limit (inf).\n        tunneling_probability, _ = integrate.quad(integrand, 0, np.inf)\n        \n        results.append(tunneling_probability)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{r:.10f}' for r in results)}]\")\n\nsolve()\n```"
        }
    ]
}