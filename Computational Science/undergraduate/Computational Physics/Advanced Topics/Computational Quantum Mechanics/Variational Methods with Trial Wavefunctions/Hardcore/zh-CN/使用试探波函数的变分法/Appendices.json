{
    "hands_on_practices": [
        {
            "introduction": "第一个练习为我们应用变分法奠定了基础。我们将使用一个带有可调参数 $a$ 的灵活试探波函数 $\\text{sech}^a(x)$，来估计 Pöschl-Teller 势的基态能量。这个练习  演示了核心工作流程：计算能量期望值作为参数的函数，然后通过最小化该函数来找到能量的最佳上限。",
            "id": "2448895",
            "problem": "考虑一个质量为 $m$ 的一维非相对论性量子粒子，其哈密顿算符为\n$$\n\\hat{H} \\;=\\; -\\frac{1}{2}\\,\\frac{d^{2}}{dx^{2}} \\;+\\; V(x),\n$$\n在约化普朗克常数 $\\hbar$ 等于 $1$ 且质量 $m$ 等于 $1$ 的单位制中。其势为 Pöschl–Teller 势\n$$\nV(x) \\;=\\; -\\frac{\\lambda(\\lambda-1)}{2\\,\\cosh^{2}(x)},\n$$\n其中实参数 $\\lambda>1$。使用变分法，并采用归一化的试探波函数\n$$\n\\psi_{a}(x) \\;=\\; \\mathcal{N}(a)\\,\\mathrm{sech}^{\\,a}(x),\n$$\n其中 $a>0$ 是一个实变分参数，$\\mathcal{N}(a)$ 是归一化常数。计算变分能量 $E(a)=\\langle \\psi_{a}|\\hat{H}|\\psi_{a}\\rangle$ 并对其关于 $a$ 进行最小化，以获得基态能量的最紧上界 $E_{\\mathrm{var}}(\\lambda)$。\n\n请以含 $\\lambda$ 的单个精确解析表达式的形式给出你的最终答案。不要提供不等式。无需进行数值四舍五入，除了指定的 $\\hbar=1$ 和 $m=1$ 之外，不应包含任何单位。",
            "solution": "变分原理指出，对于任意归一化的试探波函数 $\\psi_{a}(x)$，其期望值 $E(a)=\\langle \\psi_{a}|\\hat{H}|\\psi_{a}\\rangle$ 满足 $E(a)\\ge E_{0}$，其中 $E_{0}$ 是真实的基态能量。给定试探族 $\\psi_{a}(x)=\\mathcal{N}(a)\\,\\mathrm{sech}^{\\,a}(x)$，其中 $a>0$。我们首先计算归一化因子，然后计算动能和势能的期望值。\n\n归一化要求\n$$\n1 \\;=\\; \\int_{-\\infty}^{\\infty} |\\psi_{a}(x)|^{2}\\,dx \\;=\\; |\\mathcal{N}(a)|^{2}\\int_{-\\infty}^{\\infty}\\mathrm{sech}^{\\,2a}(x)\\,dx.\n$$\n定义\n$$\nI_{0}(a) \\;=\\; \\int_{-\\infty}^{\\infty}\\mathrm{sech}^{\\,2a}(x)\\,dx.\n$$\n一个标准积分给出，对于 $\\mu>0$，\n$$\n\\int_{-\\infty}^{\\infty}\\mathrm{sech}^{\\,\\mu}(x)\\,dx \\;=\\; \\sqrt{\\pi}\\,\\frac{\\Gamma\\!\\left(\\frac{\\mu}{2}\\right)}{\\Gamma\\!\\left(\\frac{1+\\mu}{2}\\right)}.\n$$\n令 $\\mu=2a$ 可得\n$$\nI_{0}(a) \\;=\\; \\sqrt{\\pi}\\,\\frac{\\Gamma(a)}{\\Gamma\\!\\left(a+\\frac{1}{2}\\right)}.\n$$\n因此 $|\\mathcal{N}(a)|^{2}=1/I_{0}(a)$。\n\n接下来，计算动能期望值。对于实数 $\\psi_{a}$ 且在给定单位制下，\n$$\n\\langle T\\rangle \\;=\\; \\frac{1}{2}\\int_{-\\infty}^{\\infty}\\left(\\frac{d\\psi_{a}}{dx}\\right)^{2}dx.\n$$\n对 $\\psi_{a}(x)$ 求导：\n$$\n\\frac{d}{dx}\\left[\\mathrm{sech}^{\\,a}(x)\\right] \\;=\\; -a\\,\\tanh(x)\\,\\mathrm{sech}^{\\,a}(x),\n$$\n所以\n$$\n\\frac{d\\psi_{a}}{dx} \\;=\\; -a\\,\\tanh(x)\\,\\psi_{a}(x),\n$$\n因此\n$$\n\\langle T\\rangle \\;=\\; \\frac{1}{2}\\,a^{2}\\int_{-\\infty}^{\\infty}\\tanh^{2}(x)\\,|\\psi_{a}(x)|^{2}\\,dx.\n$$\n引入\n$$\nI_{1}(a) \\;=\\; \\int_{-\\infty}^{\\infty}\\tanh^{2}(x)\\,\\mathrm{sech}^{\\,2a}(x)\\,dx,\\qquad\nI_{2}(a) \\;=\\; \\int_{-\\infty}^{\\infty}\\mathrm{sech}^{\\,2a+2}(x)\\,dx.\n$$\n使用 $\\tanh^{2}(x)=1-\\mathrm{sech}^{2}(x)$，我们有 $I_{1}(a)=I_{0}(a)-I_{2}(a)$。归一化后，动能期望值变为\n$$\n\\langle T\\rangle \\;=\\; \\frac{1}{2}\\,a^{2}\\,\\frac{I_{1}(a)}{I_{0}(a)} \\;=\\; \\frac{1}{2}\\,a^{2}\\left[1-\\frac{I_{2}(a)}{I_{0}(a)}\\right].\n$$\n\n势能期望值为\n$$\n\\langle V\\rangle \\;=\\; \\int_{-\\infty}^{\\infty}|\\psi_{a}(x)|^{2}V(x)\\,dx \\;=\\; -\\frac{\\lambda(\\lambda-1)}{2}\\int_{-\\infty}^{\\infty}\\mathrm{sech}^{2}(x)\\,|\\psi_{a}(x)|^{2}\\,dx\n\\;=\\; -\\frac{\\lambda(\\lambda-1)}{2}\\,\\frac{I_{2}(a)}{I_{0}(a)}.\n$$\n\n我们现在计算比率 $r(a)=I_{2}(a)/I_{0}(a)$。使用相同的标准积分，\n$$\nI_{2}(a) \\;=\\; \\int_{-\\infty}^{\\infty}\\mathrm{sech}^{\\,2a+2}(x)\\,dx \\;=\\; \\sqrt{\\pi}\\,\\frac{\\Gamma(a+1)}{\\Gamma\\!\\left(a+\\frac{3}{2}\\right)}.\n$$\n因此，\n$$\nr(a) \\;=\\; \\frac{I_{2}(a)}{I_{0}(a)} \\;=\\; \\frac{\\Gamma(a+1)}{\\Gamma(a)}\\cdot \\frac{\\Gamma\\!\\left(a+\\frac{1}{2}\\right)}{\\Gamma\\!\\left(a+\\frac{3}{2}\\right)} \\;=\\; \\frac{a}{a+\\frac{1}{2}} \\;=\\; \\frac{2a}{2a+1}.\n$$\n\n汇总各项，变分能量为\n$$\nE(a)\\;=\\;\\langle T\\rangle+\\langle V\\rangle \\;=\\; \\frac{1}{2}\\,a^{2}\\left[1-r(a)\\right] \\;-\\; \\frac{\\lambda(\\lambda-1)}{2}\\,r(a).\n$$\n利用 $r(a)=\\dfrac{2a}{2a+1}$ 和 $1-r(a)=\\dfrac{1}{2a+1}$，上式可化简为\n$$\nE(a) \\;=\\; \\frac{1}{2}\\,a^{2}\\,\\frac{1}{2a+1} \\;-\\; \\frac{\\lambda(\\lambda-1)}{2}\\,\\frac{2a}{2a+1}\n\\;=\\; \\frac{\\frac{1}{2}a^{2}-\\lambda(\\lambda-1)a}{2a+1}.\n$$\n\n为使 $E(a)$ 关于 $a>0$ 最小化，计算其导数并令其为零。将 $E(a)$ 写为 $E(a)=N(a)/D(a)$，其中 $N(a)=\\frac{1}{2}a^{2}-\\lambda(\\lambda-1)a$ 且 $D(a)=2a+1$。然后\n$$\n\\frac{dE}{da} \\;=\\; \\frac{N'(a)D(a)-N(a)D'(a)}{[D(a)]^{2}} \\;=\\; 0\n\\;\\;\\Longrightarrow\\;\\; N'(a)D(a)-N(a)D'(a)=0.\n$$\n计算\n$$\nN'(a)=a-\\lambda(\\lambda-1),\\qquad D'(a)=2,\n$$\n所以\n$$\n\\left[a-\\lambda(\\lambda-1)\\right](2a+1) - 2\\left(\\frac{1}{2}a^{2}-\\lambda(\\lambda-1)a\\right)=0.\n$$\n展开并化简可得\n$$\na^{2}+a-\\lambda(\\lambda-1)=0.\n$$\n解关于 $a$ 的二次方程，\n$$\na \\;=\\; \\frac{-1+\\sqrt{1+4\\lambda(\\lambda-1)}}{2}.\n$$\n由于 $\\lambda>1$，我们有 $\\sqrt{1+4\\lambda(\\lambda-1)}=\\sqrt{(2\\lambda-1)^{2}}=2\\lambda-1$，因此\n$$\na_{\\star} \\;=\\; \\lambda-1 \\;>\\; 0.\n$$\n\n将 $a_{\\star}$ 代入 $E(a)$：\n$$\nE_{\\mathrm{var}}(\\lambda) \\;=\\; E(\\lambda-1) \\;=\\; \\frac{\\frac{1}{2}(\\lambda-1)^{2}-\\lambda(\\lambda-1)(\\lambda-1)}{2(\\lambda-1)+1}\n\\;=\\; \\frac{(\\lambda-1)^{2}\\left(\\frac{1}{2}-\\lambda\\right)}{2\\lambda-1}.\n$$\n注意到 $2\\lambda-1=2\\left(\\lambda-\\frac{1}{2}\\right)$，我们得到\n$$\nE_{\\mathrm{var}}(\\lambda) \\;=\\; -\\frac{(\\lambda-1)^{2}}{2}.\n$$\n\n因此，使用给定的试探族，变分法得出了精确的闭式上界\n$$\nE_{\\mathrm{var}}(\\lambda) \\;=\\; -\\frac{(\\lambda-1)^{2}}{2}.\n$$",
            "answer": "$$\\boxed{-\\frac{(\\lambda-1)^{2}}{2}}$$"
        },
        {
            "introduction": "变分原理的应用不限于单粒子基态。这个练习  将处理一个双费米子体系，这要求波函数是反对称的，并展示了如何找到第一激发态能量的上限。其关键在于使用一个与已知基态明确正交的试探波函数，这是量子计算中的一项基本技术。",
            "id": "2448883",
            "problem": "两个质量为 $m$ 的相同无自旋费米子在一维宽度为 $L$ 的无限深方势阱中运动，其势能为 $V(x)=0$（对于 $0  x  L$）和 $V(x)=\\infty$（其他情况）。系统的双粒子哈密顿量为 $H = h(x_1) + h(x_2)$，其中 $h(x) = -\\frac{\\hbar^2}{2m}\\frac{d^2}{dx^2}$ 是单粒子哈密顿量。该系统已知的精确基态为 $\\psi_g(x_1, x_2) = \\frac{1}{\\sqrt{2}}(\\phi_1(x_1)\\phi_2(x_2) - \\phi_1(x_2)\\phi_2(x_1))$，其中 $\\phi_n(x) = \\sqrt{2/L}\\sin(n\\pi x/L)$ 是单粒子本征态。\n\n考虑一个归一化的试探波函数族 $\\psi(x_1, x_2; \\theta) = \\frac{1}{\\sqrt{2}}(A(x_1)B(x_2;\\theta) - A(x_2)B(x_1;\\theta))$，其中 $A(x) = \\phi_1(x)$ 且 $B(x;\\theta) = \\cos\\theta \\phi_2(x) + \\sin\\theta \\phi_3(x)$。\n应用变分原理，通过最小化能量期望值 $E(\\theta) = \\langle\\psi(\\theta)|H|\\psi(\\theta)\\rangle$ 来求出第一激发态能量的一个上界。这个最小化必须在约束条件 $\\langle\\psi(\\theta)|\\psi_g\\rangle=0$ 下进行，以确保试探波函数与基态正交。\n\n计算这个约束下的最小能量期望值。你的最终答案应该以一个包含物理常数 $m, L, \\hbar, \\pi$ 的解析表达式给出。",
            "solution": "该问题陈述已经过验证，被认为是科学上合理的、提法得当且内部一致的。它代表了量子力学中变分法的一个标准应用，用于确定双粒子系统第一激发态能量的一个上限。我们开始进行解答。\n\n问题要求在试探波函数 $\\psi(x_{1},x_{2};\\theta)$ 与基态 $\\psi_{g}$ 正交的约束下，最小化能量期望值 $E(\\theta) = \\langle\\psi(\\theta)|H|\\psi(\\theta)\\rangle$。\n\n试探波函数由下式给出\n$$\n\\psi(x_{1},x_{2};\\theta)=\\mathcal{N}\\big(A(x_{1})B(x_{2};\\theta)-A(x_{2})B(x_{1};\\theta)\\big)\n$$\n其中 $A(x) = \\phi_{1}(x)$ 且 $B(x;\\theta) = \\cos\\theta\\,\\phi_{2}(x)+\\sin\\theta\\,\\phi_{3}(x)$。单粒子本征函数 $\\phi_{n}(x)$ 构成一个标准正交集：$\\langle\\phi_{n}|\\phi_{m}\\rangle = \\int_{0}^{L} \\phi_{n}^{*}(x)\\phi_{m}(x)\\,dx = \\delta_{nm}$。\n\n首先，我们确定归一化常数 $\\mathcal{N}$。单粒子态 $A(x)$ 和 $B(x;\\theta)$ 本身是归一化的。\n$\\langle A|A \\rangle = \\langle\\phi_{1}|\\phi_{1}\\rangle = 1$。\n$\\langle B|B \\rangle = \\langle \\cos\\theta\\,\\phi_{2}+\\sin\\theta\\,\\phi_{3} | \\cos\\theta\\,\\phi_{2}+\\sin\\theta\\,\\phi_{3} \\rangle = \\cos^{2}\\theta\\langle\\phi_{2}|\\phi_{2}\\rangle + \\sin^{2}\\theta\\langle\\phi_{3}|\\phi_{3}\\rangle + 2\\cos\\theta\\sin\\theta\\langle\\phi_{2}|\\phi_{3}\\rangle = \\cos^{2}\\theta + \\sin^{2}\\theta = 1$。\n此外，态 $A(x)$ 和 $B(x;\\theta)$ 是正交的。\n$\\langle A|B \\rangle = \\langle\\phi_{1} | \\cos\\theta\\,\\phi_{2}+\\sin\\theta\\,\\phi_{3} \\rangle = \\cos\\theta\\langle\\phi_{1}|\\phi_{2}\\rangle + \\sin\\theta\\langle\\phi_{1}|\\phi_{3}\\rangle = 0$。\n\n$\\psi(\\theta)$ 的归一化条件是 $\\langle\\psi(\\theta)|\\psi(\\theta)\\rangle = 1$。\n$$\n\\langle\\psi(\\theta)|\\psi(\\theta)\\rangle = |\\mathcal{N}|^{2} \\left( \\langle A|A \\rangle \\langle B|B \\rangle - \\langle A|B \\rangle \\langle B|A \\rangle - \\langle B|A \\rangle \\langle A|B \\rangle + \\langle B|B \\rangle \\langle A|A \\rangle \\right)\n$$\n代入内积，我们得到 $|\\mathcal{N}|^{2}(1 \\cdot 1 - 0 - 0 + 1 \\cdot 1) = 2|\\mathcal{N}|^{2}$。\n为了归一化，$2|\\mathcal{N}|^{2} = 1$，这给出 $\\mathcal{N} = 1/\\sqrt{2}$（取实数正根）。\n归一化后的试探波函数是两个标准正交单粒子态 $A(x)$ 和 $B(x;\\theta)$ 的斯莱特行列式：\n$$\n\\psi(x_{1},x_{2};\\theta) = \\dfrac{1}{\\sqrt{2}}\\big(A(x_{1})B(x_{2};\\theta)-A(x_{2})B(x_{1};\\theta)\\big)\n$$\n\n接下来，我们应用正交约束 $\\langle\\psi(\\theta)|\\psi_{g}\\rangle = 0$。基态为 $\\psi_{g}(x_{1},x_{2}) = \\frac{1}{\\sqrt{2}}\\big(\\phi_{1}(x_{1})\\phi_{2}(x_{2})-\\phi_{1}(x_{2})\\phi_{2}(x_{1})\\big)$。\n由单粒子态 $(\\chi_{a}, \\chi_{b})$ 和 $(\\chi_{c}, \\chi_{d})$ 构建的两个斯莱特行列式的内积由 $\\det(\\mathbf{M})$ 给出，其中 $M_{ij} = \\langle\\chi_{i}|\\chi_{j}\\rangle$。\n对于 $\\langle\\psi(\\theta)|\\psi_{g}\\rangle$，我们有态对 $(A, B)$ 和 $(\\phi_{1}, \\phi_{2})$。\n$$\n\\langle\\psi(\\theta)|\\psi_{g}\\rangle = \\langle A|\\phi_{1} \\rangle \\langle B|\\phi_{2} \\rangle - \\langle A|\\phi_{2} \\rangle \\langle B|\\phi_{1} \\rangle\n$$\n我们计算所需的内积：\n$\\langle A|\\phi_{1} \\rangle = \\langle\\phi_{1}|\\phi_{1}\\rangle = 1$。\n$\\langle A|\\phi_{2} \\rangle = \\langle\\phi_{1}|\\phi_{2}\\rangle = 0$。\n$\\langle B|\\phi_{2} \\rangle = \\langle \\cos\\theta\\,\\phi_{2}+\\sin\\theta\\,\\phi_{3} | \\phi_{2} \\rangle = \\cos\\theta\\langle\\phi_{2}|\\phi_{2}\\rangle + \\sin\\theta\\langle\\phi_{3}|\\phi_{2}\\rangle = \\cos\\theta$。\n内积简化为 $\\langle\\psi(\\theta)|\\psi_{g}\\rangle = 1 \\cdot \\cos\\theta - 0 \\cdot \\langle B|\\phi_{1} \\rangle = \\cos\\theta$。\n因此，约束 $\\langle\\psi(\\theta)|\\psi_{g}\\rangle=0$ 意味着 $\\cos\\theta = 0$。\n\n现在，我们计算能量期望值 $E(\\theta)=\\langle\\psi(\\theta)|H|\\psi(\\theta)\\rangle$。哈密顿量为 $H = h(x_{1}) + h(x_{2})$。对于由标准正交单粒子态 $A$ 和 $B$ 构成的斯莱特行列式形式的双粒子态，总能量期望值是每个态的单粒子哈密顿量期望值之和：\n$$\nE(\\theta) = \\langle A|h|A \\rangle + \\langle B|h|B \\rangle\n$$\n单粒子态 $\\phi_{n}$ 是 $h$ 的本征态，本征值为 $E_{n} = \\frac{n^{2}\\pi^{2}\\hbar^{2}}{2mL^{2}}$，因此 $\\langle\\phi_{m}|h|\\phi_{n}\\rangle = E_{n}\\delta_{mn}$。\n第一项是 $\\langle A|h|A \\rangle = \\langle\\phi_{1}|h|\\phi_{1}\\rangle = E_{1}$。\n第二项是：\n$$\n\\langle B|h|B \\rangle = \\langle \\cos\\theta\\,\\phi_{2}+\\sin\\theta\\,\\phi_{3} | h | \\cos\\theta\\,\\phi_{2}+\\sin\\theta\\,\\phi_{3} \\rangle\n$$\n$$\n= \\cos^{2}\\theta \\langle\\phi_{2}|h|\\phi_{2}\\rangle + \\sin^{2}\\theta \\langle\\phi_{3}|h|\\phi_{3}\\rangle + 2\\cos\\theta\\sin\\theta\\langle\\phi_{2}|h|\\phi_{3}\\rangle\n$$\n使用 $\\langle\\phi_{m}|h|\\phi_{n}\\rangle = E_{n}\\delta_{mn}$，这简化为：\n$$\n\\langle B|h|B \\rangle = \\cos^{2}\\theta E_{2} + \\sin^{2}\\theta E_{3}\n$$\n总能量期望值为 $E(\\theta) = E_{1} + \\cos^{2}\\theta E_{2} + \\sin^{2}\\theta E_{3}$。\n\n最后，我们必须在约束 $\\cos\\theta=0$ 下找到 $E(\\theta)$ 的最小可能值。这个约束意味着 $\\cos^{2}\\theta = 0$ 且 $\\sin^{2}\\theta = 1$。将这些值代入 $E(\\theta)$ 的表达式中，唯一地确定了能量：\n$$\nE = E_{1} + (0) \\cdot E_{2} + (1) \\cdot E_{3} = E_{1} + E_{3}\n$$\n没有剩余的自由参数可供最小化；该约束固定了能量值。该值是在给定条件下的最小可能能量。\n代入单粒子能量的显式表达式：\n$E_{1} = \\dfrac{1^{2}\\pi^{2}\\hbar^{2}}{2mL^{2}} = \\dfrac{\\pi^{2}\\hbar^{2}}{2mL^{2}}$。\n$E_{3} = \\dfrac{3^{2}\\pi^{2}\\hbar^{2}}{2mL^{2}} = \\dfrac{9\\pi^{2}\\hbar^{2}}{2mL^{2}}$。\n能量的最小期望值为：\n$$\nE_{min} = E_{1} + E_{3} = \\dfrac{\\pi^{2}\\hbar^{2}}{2mL^{2}} + \\dfrac{9\\pi^{2}\\hbar^{2}}{2mL^{2}} = \\dfrac{10\\pi^{2}\\hbar^{2}}{2mL^{2}} = \\dfrac{5\\pi^{2}\\hbar^{2}}{mL^{2}}\n$$\n这个结果对应于第一激发双粒子态 $\\Psi_{1,3} = \\frac{1}{\\sqrt{2}}(\\phi_{1}\\phi_{3}-\\phi_{3}\\phi_{1})$ 的精确能量，这也是当 $\\cos\\theta=0$ 时 $\\psi(\\theta)$ 所采取的形式。",
            "answer": "$$\n\\boxed{\\frac{5\\pi^{2}\\hbar^{2}}{mL^{2}}}\n$$"
        },
        {
            "introduction": "对于那些难以找到简单解析试探函数的复杂势场，我们需要一种更系统的方法。这个练习  介绍了强大的里兹-里兹方法 (Rayleigh-Ritz method)，其中波函数被展开为一组基函数的线性组合。这将最小化能量泛函的问题转化为了求解一个矩阵本征值问题，这是现代计算量子物理学的基石。",
            "id": "2448914",
            "problem": "考虑一个质量为 $m$ 的非相对论量子粒子，被限制在 $x \\in [0,L]$ 的一维无限深势阱中，其哈密顿算符为 $H = -\\dfrac{\\hbar^2}{2m}\\dfrac{d^2}{dx^2} + V(x)$，狄利克雷边界条件 (Dirichlet boundary conditions) 为 $\\psi(0)=\\psi(L)=0$。在势阱内部，势是线性倾斜的：$V(x) = \\epsilon\\, x/L$，其中 $\\epsilon \\ge 0$ 是一个设定斜率大小的常数。使用瑞利-里兹变分法 (Rayleigh–Ritz variational method)，并采用截断的傅里叶正弦级数作为试探函数\n$$\\psi(x) = \\sum_{n=1}^{N} c_n \\sin\\!\\left(\\dfrac{n\\pi x}{L}\\right),$$ \n并确定系数 $\\{c_n\\}_{n=1}^N$，使得在归一化约束 $\\int_0^L |\\psi(x)|^2\\,dx = 1$ 下，能量期望值最小。\n\n从基本原理出发：不含时薛定谔方程 (time-independent Schrödinger equation) 以及变分原理，即对于任意归一化的 $\\psi$，能量泛函 $E[\\psi] = \\dfrac{\\langle \\psi|H|\\psi\\rangle}{\\langle \\psi|\\psi \\rangle}$ 提供了基态能量的一个上界。利用基函数 $b_n(x) = \\sin(n\\pi x/L)$，将关于系数 $c_n$ 的最小化问题转化为一个有限维的广义本征值问题。构建重叠矩阵 $S_{mn} = \\int_0^L b_m(x)\\,b_n(x)\\,dx$ 和哈密顿矩阵 $H_{mn} = \\int_0^L b_m(x)\\,H\\,b_n(x)\\,dx$。从第一性原理推导出所有所需积分的闭合形式表达式，包括：\n- 基于对 $b_n(x)$ 的微分得到的对 $H_{mn}$ 的动能贡献，\n- 通过精确计算 $\\int_0^L x\\,\\sin(\\cdot)\\sin(\\cdot)\\,dx$ 得到的对 $H_{mn}$ 的势能贡献，\n- 以及用矩阵 $S$ 表示的归一化条件。\n\n你的程序必须：\n- 使用你推导出的闭合形式积分精确地组装 $S$ 和 $H$，\n- 求解广义对称本征值问题，以获得最低本征值 $E_0$ 及其相关的本征向量 $c$，\n- 将本征向量归一化，使得 $\\int_0^L \\psi^2(x)\\,dx = 1$，等效于 $c^\\top S c = 1$，\n- 通过强制要求第一个（按索引顺序）绝对值大于一个很小阈值的系数为非负，来解决全局相位/符号的模糊性，\n- 并报告基态能量和前三个系数。\n\n使用以下单位约定：设 $\\hbar = 1$ 和 $m = 1$。在此约定下，能量将以这些选择所隐含的无量纲单位表示。每个测试都指定了长度 $L$，它在同一相干单位制中测量，因此能量的标度为 $1/L^2$。将所有能量和系数表示为四舍五入到 $6$ 位小数的十进制数。\n\n测试套件。你的程序必须运行以下情况：\n- A例 (理想情况): $N=6$, $L=1.0$, $\\epsilon=0.0$。\n- B例 (弱斜率): $N=6$, $L=1.0$, $\\epsilon=0.1$。\n- C例 (强斜率和更大的基): $N=12$, $L=1.0$, $\\epsilon=5.0$。\n- D例 (边界情况，最小基): $N=1$, $L=1.0$, $\\epsilon=1.0$。\n\n对于每种情况，在应用上述归一化和符号约定后，输出一个列表，其中包含基态能量和随后的前三个系数 $[E_0, c_1, c_2, c_3]$。如果 $N  3$，用零填充缺失的系数，以便每种情况仍然报告三个系数。你的程序应生成单行输出，其中包含 A-D 例的结果，形式为一个由这四个四元素列表组成的逗号分隔列表，并用方括号括起来，例如：[[x11,x12,x13,x14],[x21,x22,x23,x24],[x31,x32,x33,x34],[x41,x42,x43,x44]]，其中每个 $xij$ 是一个四舍五入到 $6$ 位小数的十进制数。",
            "solution": "所述问题是有效的。这是计算量子力学中的一项基本技术——瑞利-里兹变分法——在一个带线性微扰的一维无限深势阱中的粒子问题上的一个适定应用。该问题具有科学依据，是客观的，并且包含了在指定的有限基内获得唯一解所需的所有必要信息。我们继续进行推导和求解。\n\n问题的核心是为给定的哈密顿量，求解不含时薛定谔方程 $H\\psi = E\\psi$ 的近似基态解：\n$$H = -\\frac{\\hbar^2}{2m}\\frac{d^2}{dx^2} + \\frac{\\epsilon x}{L}$$\n在域 $x \\in [0, L]$上，边界条件为 $\\psi(0) = \\psi(L) = 0$。\n\n变分原理指出，对于任何归一化的试探波函数 $\\psi$，能量的期望值 $E[\\psi] = \\langle\\psi|H|\\psi\\rangle = \\int_0^L \\psi^*(x) H \\psi(x) dx$ 提供了真实基态能量 $E_0$ 的一个上界。我们给定一个试探波函数，它是基函数 $b_n(x)$ 的有限线性组合：\n$$\\psi(x) = \\sum_{n=1}^{N} c_n b_n(x), \\quad \\text{其中} \\quad b_n(x) = \\sin\\left(\\frac{n\\pi x}{L}\\right)$$\n这种基函数的选择正确地满足了边界条件。系数 $\\{c_n\\}$ 是实数，所以 $\\psi^*(x) = \\psi(x)$。\n\n用系数 $c_n$ 表示的能量泛函为：\n$$E(c_1, \\dots, c_N) = \\frac{\\langle \\sum_m c_m b_m | H | \\sum_n c_n b_n \\rangle}{\\langle \\sum_m c_m b_m | \\sum_n c_n b_n \\rangle} = \\frac{\\sum_{m,n=1}^N c_m c_n \\int_0^L b_m(x) H b_n(x) dx}{\\sum_{m,n=1}^N c_m c_n \\int_0^L b_m(x) b_n(x) dx}$$\n我们定义哈密顿矩阵元 $H_{mn} = \\int_0^L b_m(x) H b_n(x) dx$ 和重叠矩阵元 $S_{mn} = \\int_0^L b_m(x) b_n(x) dx$。能量泛函变为：\n$$E = \\frac{\\mathbf{c}^T H \\mathbf{c}}{\\mathbf{c}^T S \\mathbf{c}}$$\n为了找到使该能量最小化的系数，我们需要对所有 $k = 1, \\dots, N$ 满足 $\\frac{\\partial E}{\\partial c_k} = 0$。这个过程导出了广义本征值问题：\n$$H \\mathbf{c} = E S \\mathbf{c}$$\n该系统的最低本征值 $E$ 是基态能量的变分估计，而相应的本征向量 $\\mathbf{c}$ 给出了近似基态波函数的系数。我们现在从第一性原理推导矩阵元 $S_{mn}$ 和 $H_{mn}$。\n\n**重叠矩阵 $S_{mn}$**\n重叠矩阵的元素由以下积分给出：\n$$S_{mn} = \\int_0^L \\sin\\left(\\frac{m\\pi x}{L}\\right) \\sin\\left(\\frac{n\\pi x}{L}\\right) dx$$\n基函数在区间 $[0, L]$ 上是正交的。这个标准积分的计算结果是：\n$$S_{mn} = \\frac{L}{2} \\delta_{mn}$$\n其中 $\\delta_{mn}$ 是克罗内克 δ (Kronecker delta)。因此，重叠矩阵 $S$ 是一个对角矩阵。\n\n**哈密顿矩阵 $H_{mn}$**\n哈密顿矩阵元可以分解为动能和势能的贡献：$H_{mn} = T_{mn} + V_{mn}$。\n\n**动能项 $T_{mn}$**\n动能算符为 $T = -\\frac{\\hbar^2}{2m}\\frac{d^2}{dx^2}$。其矩阵元为：\n$$T_{mn} = \\int_0^L \\sin\\left(\\frac{m\\pi x}{L}\\right) \\left(-\\frac{\\hbar^2}{2m}\\frac{d^2}{dx^2}\\right) \\sin\\left(\\frac{n\\pi x}{L}\\right) dx$$\n基函数是二阶导数算符的本征函数：\n$$\\frac{d^2}{dx^2} \\sin\\left(\\frac{n\\pi x}{L}\\right) = -\\left(\\frac{n\\pi}{L}\\right)^2 \\sin\\left(\\frac{n\\pi x}{L}\\right)$$\n将此代入 $T_{mn}$ 的积分中：\n$$T_{mn} = \\frac{\\hbar^2}{2m} \\left(\\frac{n\\pi}{L}\\right)^2 \\int_0^L \\sin\\left(\\frac{m\\pi x}{L}\\right) \\sin\\left(\\frac{n\\pi x}{L}\\right) dx = \\frac{\\hbar^2 \\pi^2 n^2}{2mL^2} S_{mn}$$\n使用 $S_{mn}=\\frac{L}{2}\\delta_{mn}$ 和指定的单位 $\\hbar=1, m=1$：\n$$T_{mn} = \\frac{\\pi^2 n^2}{2L^2} \\left(\\frac{L}{2}\\delta_{mn}\\right) = \\frac{\\pi^2 n^2}{4L} \\delta_{mn}$$\n动能矩阵 $T$ 也是对角矩阵。\n\n**势能项 $V_{mn}$**\n势为 $V(x) = \\epsilon x / L$。其矩阵元为：\n$$V_{mn} = \\int_0^L \\sin\\left(\\frac{m\\pi x}{L}\\right) \\left(\\frac{\\epsilon x}{L}\\right) \\sin\\left(\\frac{n\\pi x}{L}\\right) dx = \\frac{\\epsilon}{L} \\int_0^L x \\sin\\left(\\frac{m\\pi x}{L}\\right) \\sin\\left(\\frac{n\\pi x}{L}\\right) dx$$\n为计算此积分，我们首先考虑对角元素，$m=n$：\n$$V_{nn} = \\frac{\\epsilon}{L} \\int_0^L x \\sin^2\\left(\\frac{n\\pi x}{L}\\right) dx = \\frac{\\epsilon}{L} \\int_0^L x \\frac{1}{2}\\left(1 - \\cos\\left(\\frac{2n\\pi x}{L}\\right)\\right) dx$$\n对于 $a = 2n\\pi/L$，积分 $\\int_0^L x \\cos(ax) dx$ 的值为零。因此，只有第一项有贡献：\n$$V_{nn} = \\frac{\\epsilon}{2L} \\int_0^L x dx = \\frac{\\epsilon}{2L} \\left[\\frac{x^2}{2}\\right]_0^L = \\frac{\\epsilon}{2L} \\frac{L^2}{2} = \\frac{\\epsilon L}{4}$$\n对于非对角元素，$m \\neq n$，我们使用恒等式 $\\sin A \\sin B = \\frac{1}{2}[\\cos(A-B) - \\cos(A+B)]$：\n$$V_{mn} = \\frac{\\epsilon}{2L} \\int_0^L x \\left[ \\cos\\left(\\frac{(m-n)\\pi x}{L}\\right) - \\cos\\left(\\frac{(m+n)\\pi x}{L}\\right) \\right] dx$$\n我们使用通过分部积分法计算的标准积分：\n$$\\int_0^L x \\cos\\left(\\frac{k\\pi x}{L}\\right) dx = \\frac{L^2}{(k\\pi)^2}(\\cos(k\\pi)-1) = \\frac{L^2}{(k\\pi)^2}((-1)^k-1)$$\n如果 $k$ 是偶数，该积分为零；如果 $k$ 是奇数，则为 $-2L^2/(k\\pi)^2$。\n对于 $m \\ne n$ 的 $V_{mn}$，整数 $k$ 为 $(m-n)$ 和 $(m+n)$。两者具有相同的奇偶性。\n如果 $(m-n)$ 是偶数，则两个积分都为零，因此 $V_{mn}=0$。\n如果 $(m-n)$ 是奇数，则两个积分都非零：\n\\begin{align*} V_{mn} = \\frac{\\epsilon}{2L} \\left[ \\frac{-2L^2}{((m-n)\\pi)^2} - \\frac{-2L^2}{((m+n)\\pi)^2} \\right] \\\\ = -\\frac{\\epsilon L}{\\pi^2} \\left[ \\frac{1}{(m-n)^2} - \\frac{1}{(m+n)^2} \\right] \\\\ = -\\frac{\\epsilon L}{\\pi^2} \\frac{(m+n)^2 - (m-n)^2}{(m^2-n^2)^2} \\\\ = -\\frac{\\epsilon L}{\\pi^2} \\frac{4mn}{(m^2-n^2)^2}\\end{align*}\n\n**矩阵元总结**\n在单位 $\\hbar=1, m=1$下：\n$S_{mn} = \\frac{L}{2}\\delta_{mn}$\n$H_{mn} = T_{mn} + V_{mn}$，其中\n对于 $m=n$：\n$$H_{nn} = \\frac{\\pi^2 n^2}{4L} + \\frac{\\epsilon L}{4}$$\n对于 $m \\ne n$：\n$$H_{mn} = \\begin{cases} 0  \\text{如果 } (m-n) \\text{ 是偶数} \\\\ -\\dfrac{4\\epsilon L}{\\pi^2} \\dfrac{mn}{(m^2-n^2)^2}  \\text{如果 } (m-n) \\text{ 是奇数} \\end{cases}$$\n\n构建这些矩阵并用于求解广义本征值问题 $H\\mathbf{c} = E S\\mathbf{c}$。最低本征值 $E_0$ 是基态能量的估计值。相应的本征向量 $\\mathbf{c}$ 被归一化，使得 $\\mathbf{c}^T S \\mathbf{c} = 1$，这等价于 $\\int_0^L \\psi^2(x)dx=1$。通过要求第一个不可忽略的系数 $c_n$ 为正来固定全局相位。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import eigh\n\ndef solve():\n    \"\"\"\n    Solves the variational problem for a particle in a 1D box with a linear potential.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (N, L, epsilon)\n        (6, 1.0, 0.0),   # Case A\n        (6, 1.0, 0.1),   # Case B\n        (12, 1.0, 5.0),  # Case C\n        (1, 1.0, 1.0),   # Case D\n    ]\n\n    results = []\n    for N, L, epsilon in test_cases:\n        # Assemble the overlap matrix S and Hamiltonian matrix H.\n        S = np.zeros((N, N))\n        H = np.zeros((N, N))\n\n        # Populate the matrices using 1-based indexing for n and m for clarity\n        # with the derived formulas.\n        for i in range(N):\n            for j in range(N):\n                n = i + 1\n                m = j + 1\n                \n                if i == j:\n                    S[i, j] = L / 2.0\n                    T_nn = (np.pi**2 * n**2) / (4.0 * L)\n                    V_nn = epsilon * L / 4.0\n                    H[i, j] = T_nn + V_nn\n                else:\n                    S[i, j] = 0.0\n                    # T_mn is zero for m != n\n                    # V_mn is non-zero only if (m-n) is odd\n                    if (m - n) % 2 != 0:\n                        V_mn = (-4.0 * epsilon * L / np.pi**2) * \\\n                               (m * n) / (m**2 - n**2)**2\n                        H[i, j] = V_mn\n                    else:\n                        H[i, j] = 0.0\n\n        # Solve the generalized eigenvalue problem Hc = ESc\n        # eigh returns eigenvalues in ascending order and corresponding eigenvectors\n        # that are S-orthonormal (c.T @ S @ c = 1).\n        eigenvalues, eigenvectors = eigh(H, S)\n\n        # The ground state energy is the lowest eigenvalue\n        E0 = eigenvalues[0]\n\n        # The coefficients are the first eigenvector\n        c = eigenvectors[:, 0]\n\n        # Fix the global sign ambiguity.\n        # Enforce that the first coefficient with magnitude greater than a small\n        # threshold is non-negative.\n        threshold = 1e-9\n        for k in range(N):\n            if abs(c[k]) > threshold:\n                if c[k]  0:\n                    c = -c\n                break\n        \n        # Extract the first three coefficients, padding with zeros if N  3.\n        c1 = c[0] if N >= 1 else 0.0\n        c2 = c[1] if N >= 2 else 0.0\n        c3 = c[2] if N >= 3 else 0.0\n\n        # Append the formatted result for this case.\n        results.append([E0, c1, c2, c3])\n\n    # Format the final output string exactly as specified.\n    # Each sublist is formatted, then joined by commas, and enclosed in brackets.\n    formatted_results = []\n    for res in results:\n        formatted_res = f\"[{res[0]:.6f},{res[1]:.6f},{res[2]:.6f},{res[3]:.6f}]\"\n        formatted_results.append(formatted_res)\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}