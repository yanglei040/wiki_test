{
    "hands_on_practices": [
        {
            "introduction": "Our exploration of the variational method begins with a compelling example that showcases its power and elegance. We will tackle the Pöschl-Teller potential, a system for which a cleverly chosen trial wavefunction allows us to find not just an upper bound, but the exact ground-state energy. This practice  is fundamental for building intuition on how to select an appropriate trial function and how to analytically minimize the energy with respect to a variational parameter.",
            "id": "2448895",
            "problem": "Consider a one-dimensional nonrelativistic quantum particle of mass $m$ governed by the Hamiltonian\n$$\n\\hat{H} \\;=\\; -\\frac{1}{2}\\,\\frac{d^{2}}{dx^{2}} \\;+\\; V(x),\n$$\nin units where the reduced Planck constant $\\hbar$ equals $1$ and the mass $m$ equals $1$. The potential is the Pöschl–Teller potential\n$$\nV(x) \\;=\\; -\\frac{\\lambda(\\lambda-1)}{2\\,\\cosh^{2}(x)},\n$$\nwith real parameter $\\lambda1$. Using the variational method with the normalized trial wavefunction\n$$\n\\psi_{a}(x) \\;=\\; \\mathcal{N}(a)\\,\\mathrm{sech}^{\\,a}(x),\n$$\nwhere $a0$ is a real variational parameter and $\\mathcal{N}(a)$ is the normalization constant, evaluate the variational energy $E(a)=\\langle \\psi_{a}|\\hat{H}|\\psi_{a}\\rangle$ and minimize it with respect to $a$ to obtain the tightest upper bound $E_{\\mathrm{var}}(\\lambda)$ for the ground-state energy.\n\nProvide your final answer as a single exact analytic expression in terms of $\\lambda$. Do not provide an inequality. No numerical rounding is required, and no units should be included beyond the specified choice $\\hbar=1$ and $m=1$.",
            "solution": "The variational principle states that for any normalized trial wavefunction $\\psi_{a}(x)$, the expectation value $E(a)=\\langle \\psi_{a}|\\hat{H}|\\psi_{a}\\rangle$ satisfies $E(a)\\ge E_{0}$, where $E_{0}$ is the true ground-state energy. We are given the trial family $\\psi_{a}(x)=\\mathcal{N}(a)\\,\\mathrm{sech}^{\\,a}(x)$ with $a0$. We first compute the normalization factor and then the expectation values of the kinetic and potential energies.\n\nNormalization requires\n$$\n1 \\;=\\; \\int_{-\\infty}^{\\infty} |\\psi_{a}(x)|^{2}\\,dx \\;=\\; |\\mathcal{N}(a)|^{2}\\int_{-\\infty}^{\\infty}\\mathrm{sech}^{\\,2a}(x)\\,dx.\n$$\nDefine\n$$\nI_{0}(a) \\;=\\; \\int_{-\\infty}^{\\infty}\\mathrm{sech}^{\\,2a}(x)\\,dx.\n$$\nA standard integral gives, for $\\mu0$,\n$$\n\\int_{-\\infty}^{\\infty}\\mathrm{sech}^{\\,\\mu}(x)\\,dx \\;=\\; \\sqrt{\\pi}\\,\\frac{\\Gamma\\!\\left(\\frac{\\mu}{2}\\right)}{\\Gamma\\!\\left(\\frac{1+\\mu}{2}\\right)}.\n$$\nSetting $\\mu=2a$ yields\n$$\nI_{0}(a) \\;=\\; \\sqrt{\\pi}\\,\\frac{\\Gamma(a)}{\\Gamma\\!\\left(a+\\frac{1}{2}\\right)}.\n$$\nThus $|\\mathcal{N}(a)|^{2}=1/I_{0}(a)$.\n\nNext, compute the kinetic energy expectation value. For real $\\psi_{a}$ and in the given units,\n$$\n\\langle T\\rangle \\;=\\; \\frac{1}{2}\\int_{-\\infty}^{\\infty}\\left(\\frac{d\\psi_{a}}{dx}\\right)^{2}dx.\n$$\nDifferentiate $\\psi_{a}(x)$:\n$$\n\\frac{d}{dx}\\left[\\mathrm{sech}^{\\,a}(x)\\right] \\;=\\; -a\\,\\tanh(x)\\,\\mathrm{sech}^{\\,a}(x),\n$$\nso\n$$\n\\frac{d\\psi_{a}}{dx} \\;=\\; -a\\,\\tanh(x)\\,\\psi_{a}(x),\n$$\nand therefore\n$$\n\\langle T\\rangle \\;=\\; \\frac{1}{2}\\,a^{2}\\int_{-\\infty}^{\\infty}\\tanh^{2}(x)\\,|\\psi_{a}(x)|^{2}\\,dx.\n$$\nIntroduce\n$$\nI_{1}(a) \\;=\\; \\int_{-\\infty}^{\\infty}\\tanh^{2}(x)\\,\\mathrm{sech}^{\\,2a}(x)\\,dx,\\qquad\nI_{2}(a) \\;=\\; \\int_{-\\infty}^{\\infty}\\mathrm{sech}^{\\,2a+2}(x)\\,dx.\n$$\nUsing $\\tanh^{2}(x)=1-\\mathrm{sech}^{2}(x)$, we have $I_{1}(a)=I_{0}(a)-I_{2}(a)$. With normalization, the kinetic expectation becomes\n$$\n\\langle T\\rangle \\;=\\; \\frac{1}{2}\\,a^{2}\\,\\frac{I_{1}(a)}{I_{0}(a)} \\;=\\; \\frac{1}{2}\\,a^{2}\\left[1-\\frac{I_{2}(a)}{I_{0}(a)}\\right].\n$$\n\nThe potential energy expectation is\n$$\n\\langle V\\rangle \\;=\\; \\int_{-\\infty}^{\\infty}|\\psi_{a}(x)|^{2}V(x)\\,dx \\;=\\; -\\frac{\\lambda(\\lambda-1)}{2}\\int_{-\\infty}^{\\infty}\\mathrm{sech}^{2}(x)\\,|\\psi_{a}(x)|^{2}\\,dx\n\\;=\\; -\\frac{\\lambda(\\lambda-1)}{2}\\,\\frac{I_{2}(a)}{I_{0}(a)}.\n$$\n\nWe now evaluate the ratio $r(a)=I_{2}(a)/I_{0}(a)$. Using the same standard integral,\n$$\nI_{2}(a) \\;=\\; \\int_{-\\infty}^{\\infty}\\mathrm{sech}^{\\,2a+2}(x)\\,dx \\;=\\; \\sqrt{\\pi}\\,\\frac{\\Gamma(a+1)}{\\Gamma\\!\\left(a+\\frac{3}{2}\\right)}.\n$$\nTherefore,\n$$\nr(a) \\;=\\; \\frac{I_{2}(a)}{I_{0}(a)} \\;=\\; \\frac{\\Gamma(a+1)}{\\Gamma(a)}\\cdot \\frac{\\Gamma\\!\\left(a+\\frac{1}{2}\\right)}{\\Gamma\\!\\left(a+\\frac{3}{2}\\right)} \\;=\\; \\frac{a}{a+\\frac{1}{2}} \\;=\\; \\frac{2a}{2a+1}.\n$$\n\nCollecting terms, the variational energy is\n$$\nE(a)\\;=\\;\\langle T\\rangle+\\langle V\\rangle \\;=\\; \\frac{1}{2}\\,a^{2}\\left[1-r(a)\\right] \\;-\\; \\frac{\\lambda(\\lambda-1)}{2}\\,r(a).\n$$\nWith $r(a)=\\dfrac{2a}{2a+1}$ and $1-r(a)=\\dfrac{1}{2a+1}$, this simplifies to\n$$\nE(a) \\;=\\; \\frac{1}{2}\\,a^{2}\\,\\frac{1}{2a+1} \\;-\\; \\frac{\\lambda(\\lambda-1)}{2}\\,\\frac{2a}{2a+1}\n\\;=\\; \\frac{\\frac{1}{2}a^{2}-\\lambda(\\lambda-1)a}{2a+1}.\n$$\n\nTo minimize $E(a)$ with respect to $a0$, compute the derivative and set it to zero. Write $E(a)=N(a)/D(a)$ with $N(a)=\\frac{1}{2}a^{2}-\\lambda(\\lambda-1)a$ and $D(a)=2a+1$. Then\n$$\n\\frac{dE}{da} \\;=\\; \\frac{N'(a)D(a)-N(a)D'(a)}{[D(a)]^{2}} \\;=\\; 0\n\\;\\;\\Longrightarrow\\;\\; N'(a)D(a)-N(a)D'(a)=0.\n$$\nEvaluate\n$$\nN'(a)=a-\\lambda(\\lambda-1),\\qquad D'(a)=2,\n$$\nso\n$$\n\\left[a-\\lambda(\\lambda-1)\\right](2a+1) - 2\\left(\\frac{1}{2}a^{2}-\\lambda(\\lambda-1)a\\right)=0.\n$$\nExpanding and simplifying gives\n$$\na^{2}+a-\\lambda(\\lambda-1)=0.\n$$\nSolving the quadratic for $a$,\n$$\na \\;=\\; \\frac{-1+\\sqrt{1+4\\lambda(\\lambda-1)}}{2}.\n$$\nSince $\\lambda1$, we have $\\sqrt{1+4\\lambda(\\lambda-1)}=\\sqrt{(2\\lambda-1)^{2}}=2\\lambda-1$, hence\n$$\na_{\\star} \\;=\\; \\lambda-1 \\;\\; 0.\n$$\n\nSubstitute $a_{\\star}$ into $E(a)$:\n$$\nE_{\\mathrm{var}}(\\lambda) \\;=\\; E(\\lambda-1) \\;=\\; \\frac{\\frac{1}{2}(\\lambda-1)^{2}-\\lambda(\\lambda-1)(\\lambda-1)}{2(\\lambda-1)+1}\n\\;=\\; \\frac{(\\lambda-1)^{2}\\left(\\frac{1}{2}-\\lambda\\right)}{2\\lambda-1}.\n$$\nNoting that $2\\lambda-1=2\\left(\\lambda-\\frac{1}{2}\\right)$, we obtain\n$$\nE_{\\mathrm{var}}(\\lambda) \\;=\\; -\\frac{(\\lambda-1)^{2}}{2}.\n$$\n\nThus the variational method with the given trial family yields the exact closed-form upper bound\n$$\nE_{\\mathrm{var}}(\\lambda) \\;=\\; -\\frac{(\\lambda-1)^{2}}{2}.\n$$",
            "answer": "$$\\boxed{-\\frac{(\\lambda-1)^{2}}{2}}$$"
        },
        {
            "introduction": "The utility of the variational principle extends beyond just the ground state. By imposing an orthogonality constraint with the known ground state, we can obtain a robust upper bound for the first excited state's energy. This exercise  demonstrates this powerful technique by examining a system of two identical fermions in a box, forcing us to also consider the crucial role of wavefunction antisymmetry in multi-particle quantum systems.",
            "id": "2448883",
            "problem": "Two identical spinless fermions of mass $m$ move in a one-dimensional infinite square well of width $L$, with potential $V(x)=0$ for $0xL$ and $V(x)=\\infty$ otherwise. The two-particle Hamiltonian is $H=h(x_{1})+h(x_{2})$ with $h(x)=-\\dfrac{\\hbar^{2}}{2m}\\dfrac{d^{2}}{dx^{2}}$ on the domain $0xL$ and hard-wall boundary conditions at $x=0$ and $x=L$. The single-particle eigenfunctions are $\\phi_{n}(x)=\\sqrt{\\dfrac{2}{L}}\\sin\\!\\left(\\dfrac{n\\pi x}{L}\\right)$ with corresponding single-particle energies $E_{n}=\\dfrac{n^{2}\\pi^{2}\\hbar^{2}}{2mL^{2}}$, for $n\\in\\mathbb{N}$. Because the particles are identical fermions with no spin degree of freedom, the spatial two-particle state must be antisymmetric under particle exchange.\n\nConsider the antisymmetric trial two-particle wavefunction of the form\n$$\n\\psi(x_{1},x_{2};\\theta)=\\mathcal{N}\\big(A(x_{1})B(x_{2};\\theta)-A(x_{2})B(x_{1};\\theta)\\big),\n$$\nwhere $A(x)=\\phi_{1}(x)$, $B(x;\\theta)=\\cos\\theta\\,\\phi_{2}(x)+\\sin\\theta\\,\\phi_{3}(x)$, and $\\mathcal{N}$ is a normalization constant chosen so that $\\int_{0}^{L}\\!\\!\\int_{0}^{L}|\\psi(x_{1},x_{2};\\theta)|^{2}\\,dx_{1}\\,dx_{2}=1$. Let the ground-state antisymmetric two-particle eigenstate be\n$$\n\\psi_{g}(x_{1},x_{2})=\\dfrac{1}{\\sqrt{2}}\\big(\\phi_{1}(x_{1})\\phi_{2}(x_{2})-\\phi_{1}(x_{2})\\phi_{2}(x_{1})\\big).\n$$\nUsing the variational principle with the orthogonality constraint $\\langle\\psi(\\theta)|\\psi_{g}\\rangle=0$, determine the minimal possible expectation value of the energy $E(\\theta)=\\langle\\psi(\\theta)|H|\\psi(\\theta)\\rangle$. Provide your final answer as a closed-form analytic expression in terms of $\\hbar$, $m$, and $L$. No numerical evaluation is required.",
            "solution": "The problem requires the minimization of the energy expectation value $E(\\theta) = \\langle\\psi(\\theta)|H|\\psi(\\theta)\\rangle$ for a trial wavefunction $\\psi(x_{1},x_{2};\\theta)$, subject to the constraint that this wavefunction is orthogonal to the ground state $\\psi_{g}$.\n\nThe trial wavefunction is given by\n$$\n\\psi(x_{1},x_{2};\\theta)=\\mathcal{N}\\big(A(x_{1})B(x_{2};\\theta)-A(x_{2})B(x_{1};\\theta)\\big)\n$$\nwhere $A(x) = \\phi_{1}(x)$ and $B(x;\\theta) = \\cos\\theta\\,\\phi_{2}(x)+\\sin\\theta\\,\\phi_{3}(x)$. The single-particle eigenfunctions $\\phi_{n}(x)$ form an orthonormal set: $\\langle\\phi_{n}|\\phi_{m}\\rangle = \\int_{0}^{L} \\phi_{n}^{*}(x)\\phi_{m}(x)\\,dx = \\delta_{nm}$.\n\nFirst, we determine the normalization constant $\\mathcal{N}$. The single-particle states $A(x)$ and $B(x;\\theta)$ are themselves normalized.\n$\\langle A|A \\rangle = \\langle\\phi_{1}|\\phi_{1}\\rangle = 1$.\n$\\langle B|B \\rangle = \\langle \\cos\\theta\\,\\phi_{2}+\\sin\\theta\\,\\phi_{3} | \\cos\\theta\\,\\phi_{2}+\\sin\\theta\\,\\phi_{3} \\rangle = \\cos^{2}\\theta\\langle\\phi_{2}|\\phi_{2}\\rangle + \\sin^{2}\\theta\\langle\\phi_{3}|\\phi_{3}\\rangle + 2\\cos\\theta\\sin\\theta\\langle\\phi_{2}|\\phi_{3}\\rangle = \\cos^{2}\\theta + \\sin^{2}\\theta = 1$.\nFurthermore, the states $A(x)$ and $B(x;\\theta)$ are orthogonal.\n$\\langle A|B \\rangle = \\langle\\phi_{1} | \\cos\\theta\\,\\phi_{2}+\\sin\\theta\\,\\phi_{3} \\rangle = \\cos\\theta\\langle\\phi_{1}|\\phi_{2}\\rangle + \\sin\\theta\\langle\\phi_{1}|\\phi_{3}\\rangle = 0$.\n\nThe normalization condition for $\\psi(\\theta)$ is $\\langle\\psi(\\theta)|\\psi(\\theta)\\rangle = 1$.\n$$\n\\langle\\psi(\\theta)|\\psi(\\theta)\\rangle = |\\mathcal{N}|^{2} \\left( \\langle A|A \\rangle \\langle B|B \\rangle - \\langle A|B \\rangle \\langle B|A \\rangle - \\langle B|A \\rangle \\langle A|B \\rangle + \\langle B|B \\rangle \\langle A|A \\rangle \\right)\n$$\nSubstituting the inner products, we have $|\\mathcal{N}|^{2}(1 \\cdot 1 - 0 - 0 + 1 \\cdot 1) = 2|\\mathcal{N}|^{2}$.\nFor normalization, $2|\\mathcal{N}|^{2} = 1$, which gives $\\mathcal{N} = 1/\\sqrt{2}$ (taking the real, positive root).\nThe normalized trial wavefunction is a Slater determinant of two orthonormal single-particle states $A(x)$ and $B(x;\\theta)$:\n$$\n\\psi(x_{1},x_{2};\\theta) = \\dfrac{1}{\\sqrt{2}}\\big(A(x_{1})B(x_{2};\\theta)-A(x_{2})B(x_{1};\\theta)\\big)\n$$\n\nNext, we apply the orthogonality constraint $\\langle\\psi(\\theta)|\\psi_{g}\\rangle = 0$. The ground state is $\\psi_{g}(x_{1},x_{2}) = \\frac{1}{\\sqrt{2}}\\big(\\phi_{1}(x_{1})\\phi_{2}(x_{2})-\\phi_{1}(x_{2})\\phi_{2}(x_{1})\\big)$.\nThe inner product of two Slater determinants constructed from single-particle states $(\\chi_{a}, \\chi_{b})$ and $(\\chi_{c}, \\chi_{d})$ is given by $\\det(\\mathbf{M})$, where $M_{ij} = \\langle\\chi_{i}|\\chi_{j}\\rangle$.\nFor $\\langle\\psi(\\theta)|\\psi_{g}\\rangle$, we have the state pairs $(A, B)$ and $(\\phi_{1}, \\phi_{2})$.\n$$\n\\langle\\psi(\\theta)|\\psi_{g}\\rangle = \\langle A|\\phi_{1} \\rangle \\langle B|\\phi_{2} \\rangle - \\langle A|\\phi_{2} \\rangle \\langle B|\\phi_{1} \\rangle\n$$\nWe compute the required inner products:\n$\\langle A|\\phi_{1} \\rangle = \\langle\\phi_{1}|\\phi_{1}\\rangle = 1$.\n$\\langle A|\\phi_{2} \\rangle = \\langle\\phi_{1}|\\phi_{2}\\rangle = 0$.\n$\\langle B|\\phi_{2} \\rangle = \\langle \\cos\\theta\\,\\phi_{2}+\\sin\\theta\\,\\phi_{3} | \\phi_{2} \\rangle = \\cos\\theta\\langle\\phi_{2}|\\phi_{2}\\rangle + \\sin\\theta\\langle\\phi_{3}|\\phi_{2}\\rangle = \\cos\\theta$.\nThe inner product simplifies to $\\langle\\psi(\\theta)|\\psi_{g}\\rangle = 1 \\cdot \\cos\\theta - 0 \\cdot \\langle B|\\phi_{1} \\rangle = \\cos\\theta$.\nThe constraint $\\langle\\psi(\\theta)|\\psi_{g}\\rangle=0$ therefore implies that $\\cos\\theta = 0$.\n\nNow, we calculate the energy expectation value $E(\\theta)=\\langle\\psi(\\theta)|H|\\psi(\\theta)\\rangle$. The Hamiltonian is $H = h(x_{1}) + h(x_{2})$. For a two-particle state formed as a Slater determinant of orthonormal single-particle states $A$ and $B$, the total energy expectation value is the sum of the expectation values of the single-particle Hamiltonian for each state:\n$$\nE(\\theta) = \\langle A|h|A \\rangle + \\langle B|h|B \\rangle\n$$\nThe single-particle states $\\phi_{n}$ are eigenstates of $h$ with eigenvalues $E_{n} = \\frac{n^{2}\\pi^{2}\\hbar^{2}}{2mL^{2}}$, so $\\langle\\phi_{m}|h|\\phi_{n}\\rangle = E_{n}\\delta_{mn}$.\nThe first term is $\\langle A|h|A \\rangle = \\langle\\phi_{1}|h|\\phi_{1}\\rangle = E_{1}$.\nThe second term is:\n$$\n\\langle B|h|B \\rangle = \\langle \\cos\\theta\\,\\phi_{2}+\\sin\\theta\\,\\phi_{3} | h | \\cos\\theta\\,\\phi_{2}+\\sin\\theta\\,\\phi_{3} \\rangle\n$$\n$$\n= \\cos^{2}\\theta \\langle\\phi_{2}|h|\\phi_{2}\\rangle + \\sin^{2}\\theta \\langle\\phi_{3}|h|\\phi_{3}\\rangle + 2\\cos\\theta\\sin\\theta\\langle\\phi_{2}|h|\\phi_{3}\\rangle\n$$\nUsing $\\langle\\phi_{m}|h|\\phi_{n}\\rangle = E_{n}\\delta_{mn}$, this simplifies to:\n$$\n\\langle B|h|B \\rangle = \\cos^{2}\\theta E_{2} + \\sin^{2}\\theta E_{3}\n$$\nThe total energy expectation value is $E(\\theta) = E_{1} + \\cos^{2}\\theta E_{2} + \\sin^{2}\\theta E_{3}$.\n\nFinally, we must find the minimal possible value of $E(\\theta)$ under the constraint $\\cos\\theta=0$. This constraint implies $\\cos^{2}\\theta = 0$ and $\\sin^{2}\\theta = 1$. Substituting these values into the expression for $E(\\theta)$ uniquely determines the energy:\n$$\nE = E_{1} + (0) \\cdot E_{2} + (1) \\cdot E_{3} = E_{1} + E_{3}\n$$\nThere are no free parameters left to minimize; the constraint fixes the energy value. This value is the minimal possible energy under the given conditions.\nSubstituting the explicit expressions for the single-particle energies:\n$E_{1} = \\dfrac{1^{2}\\pi^{2}\\hbar^{2}}{2mL^{2}} = \\dfrac{\\pi^{2}\\hbar^{2}}{2mL^{2}}$.\n$E_{3} = \\dfrac{3^{2}\\pi^{2}\\hbar^{2}}{2mL^{2}} = \\dfrac{9\\pi^{2}\\hbar^{2}}{2mL^{2}}$.\nThe minimal expectation value of the energy is:\n$$\nE_{min} = E_{1} + E_{3} = \\dfrac{\\pi^{2}\\hbar^{2}}{2mL^{2}} + \\dfrac{9\\pi^{2}\\hbar^{2}}{2mL^{2}} = \\dfrac{10\\pi^{2}\\hbar^{2}}{2mL^{2}} = \\dfrac{5\\pi^{2}\\hbar^{2}}{mL^{2}}\n$$\nThis result corresponds to the exact energy of the first excited two-particle state, $\\Psi_{1,3} = \\frac{1}{\\sqrt{2}}(\\phi_{1}\\phi_{3}-\\phi_{3}\\phi_{1})$, which is the form that $\\psi(\\theta)$ takes when $\\cos\\theta=0$.",
            "answer": "$$\n\\boxed{\\frac{5\\pi^{2}\\hbar^{2}}{mL^{2}}}\n$$"
        },
        {
            "introduction": "To tackle more complex problems where a simple analytical trial function is insufficient, we often express our ansatz as a linear combination of basis functions. In this scenario, the variational method transforms into the powerful Rayleigh-Ritz procedure, where minimizing the energy is equivalent to solving a matrix eigenvalue problem. This practice  provides hands-on experience in setting up the Hamiltonian and overlap matrices for a perturbed system and understanding how this matrix formulation serves as the foundation for modern computational quantum mechanics.",
            "id": "2448914",
            "problem": "Consider a non-relativistic quantum particle of mass $m$ confined to a one-dimensional infinite potential well spanning $x \\in [0,L]$, with Hamiltonian operator $H = -\\dfrac{\\hbar^2}{2m}\\dfrac{d^2}{dx^2} + V(x)$ and Dirichlet boundary conditions $\\psi(0)=\\psi(L)=0$. Inside the well, the potential is linearly sloped: $V(x) = \\epsilon\\, x/L$, where $\\epsilon \\ge 0$ is a constant that sets the slope scale. Use the Rayleigh–Ritz variational method with a truncated Fourier sine series trial function \n$$\\psi(x) = \\sum_{n=1}^{N} c_n \\sin\\!\\left(\\dfrac{n\\pi x}{L}\\right),$$ \nand determine the coefficients $\\{c_n\\}_{n=1}^N$ that minimize the energy expectation value subject to the normalization constraint $\\int_0^L |\\psi(x)|^2\\,dx = 1$.\n\nStart from fundamental principles: the time-independent Schrödinger equation and the variational principle that, for any normalized $\\psi$, the energy functional $E[\\psi] = \\dfrac{\\langle \\psi|H|\\psi\\rangle}{\\langle \\psi|\\psi \\rangle}$ provides an upper bound to the ground-state energy. Recast the minimization over the coefficients $c_n$ into a finite-dimensional generalized eigenvalue problem using the basis functions $b_n(x) = \\sin(n\\pi x/L)$. Construct the overlap matrix $S_{mn} = \\int_0^L b_m(x)\\,b_n(x)\\,dx$ and the Hamiltonian matrix $H_{mn} = \\int_0^L b_m(x)\\,H\\,b_n(x)\\,dx$. Derive closed-form expressions for all required integrals from first principles, including:\n- the kinetic-energy contribution to $H_{mn}$ based on differentiating $b_n(x)$,\n- the potential-energy contribution to $H_{mn}$ via exact evaluation of $\\int_0^L x\\,\\sin(\\cdot)\\sin(\\cdot)\\,dx$,\n- and the normalization condition expressed in terms of the matrix $S$.\n\nYour program must:\n- assemble $S$ and $H$ exactly using the closed-form integrals you derive,\n- solve the generalized symmetric eigenvalue problem to obtain the lowest eigenvalue $E_0$ and its associated eigenvector $c$,\n- normalize the eigenvector so that $\\int_0^L \\psi^2(x)\\,dx = 1$, equivalently $c^\\top S c = 1$,\n- fix the global phase/sign ambiguity by enforcing that the first coefficient $c_1$ that has magnitude greater than a small threshold is non-negative,\n- and report the ground-state energy and the first three coefficients.\n\nUse the following unit convention: set $\\hbar = 1$ and $m = 1$. Under this convention, energies are to be expressed in the dimensionless unit implied by these choices. The length $L$ is specified for each test and is measured in the same consistent unit system, so energy scales as $1/L^2$. Express all energies and coefficients as decimal numbers rounded to $6$ decimal places.\n\nTest suite. Your program must run the following cases:\n- Case A (happy path): $N=6$, $L=1.0$, $\\epsilon=0.0$.\n- Case B (weak slope): $N=6$, $L=1.0$, $\\epsilon=0.1$.\n- Case C (strong slope and larger basis): $N=12$, $L=1.0$, $\\epsilon=5.0$.\n- Case D (boundary case, minimal basis): $N=1$, $L=1.0$, $\\epsilon=1.0$.\n\nFor each case, output a list containing the ground-state energy followed by the first three coefficients $[E_0, c_1, c_2, c_3]$, after applying the normalization and sign convention described above. If $N  3$, pad the missing leading coefficients with zeros so that each case still reports three coefficients. Your program should produce a single line of output containing the results for Cases A–D as a comma-separated list of these four-element lists, enclosed in square brackets, for example: [[x11,x12,x13,x14],[x21,x22,x23,x24],[x31,x32,x33,x34],[x41,x42,x43,x44]], where each $xij$ is a decimal rounded to $6$ places.",
            "solution": "The problem as stated is valid. It is a well-posed application of the Rayleigh-Ritz variational method, a fundamental technique in computational quantum mechanics, to a particle in a one-dimensional infinite potential well with a linear perturbation. The problem is scientifically grounded, objective, and contains all necessary information for a unique solution within the specified finite basis. We proceed with the derivation and solution.\n\nThe core of the problem is to find an approximate ground state solution to the time-independent Schrödinger equation, $H\\psi = E\\psi$, for the given Hamiltonian:\n$$H = -\\frac{\\hbar^2}{2m}\\frac{d^2}{dx^2} + \\frac{\\epsilon x}{L}$$\non the domain $x \\in [0, L]$ with boundary conditions $\\psi(0) = \\psi(L) = 0$.\n\nThe variational principle states that for any normalized trial wavefunction $\\psi$, the expectation value of the energy, $E[\\psi] = \\langle\\psi|H|\\psi\\rangle = \\int_0^L \\psi^*(x) H \\psi(x) dx$, provides an upper bound to the true ground-state energy $E_0$. We are given a trial wavefunction which is a finite linear combination of basis functions $b_n(x)$:\n$$\\psi(x) = \\sum_{n=1}^{N} c_n b_n(x), \\quad \\text{where} \\quad b_n(x) = \\sin\\left(\\frac{n\\pi x}{L}\\right)$$\nThis choice of basis functions correctly satisfies the boundary conditions. The coefficients $\\{c_n\\}$ are real, so $\\psi^*(x) = \\psi(x)$.\n\nThe energy functional in terms of the coefficients $c_n$ is:\n$$E(c_1, \\dots, c_N) = \\frac{\\langle \\sum_m c_m b_m | H | \\sum_n c_n b_n \\rangle}{\\langle \\sum_m c_m b_m | \\sum_n c_n b_n \\rangle} = \\frac{\\sum_{m,n=1}^N c_m c_n \\int_0^L b_m(x) H b_n(x) dx}{\\sum_{m,n=1}^N c_m c_n \\int_0^L b_m(x) b_n(x) dx}$$\nWe define the Hamiltonian matrix elements $H_{mn} = \\int_0^L b_m(x) H b_n(x) dx$ and the overlap matrix elements $S_{mn} = \\int_0^L b_m(x) b_n(x) dx$. The energy functional becomes:\n$$E = \\frac{\\mathbf{c}^T H \\mathbf{c}}{\\mathbf{c}^T S \\mathbf{c}}$$\nTo find the coefficients that minimize this energy, we require $\\frac{\\partial E}{\\partial c_k} = 0$ for all $k = 1, \\dots, N$. This procedure leads to the generalized eigenvalue problem:\n$$H \\mathbf{c} = E S \\mathbf{c}$$\nThe lowest eigenvalue $E$ of this system is the variational estimate for the ground-state energy, and the corresponding eigenvector $\\mathbf{c}$ gives the coefficients of the approximate ground-state wavefunction. We now derive the matrix elements $S_{mn}$ and $H_{mn}$ from first principles.\n\n**Overlap Matrix $S_{mn}$**\nThe elements of the overlap matrix are given by the integral:\n$$S_{mn} = \\int_0^L \\sin\\left(\\frac{m\\pi x}{L}\\right) \\sin\\left(\\frac{n\\pi x}{L}\\right) dx$$\nThe basis functions are orthogonal on the interval $[0, L]$. The evaluation of this standard integral yields:\n$$S_{mn} = \\frac{L}{2} \\delta_{mn}$$\nwhere $\\delta_{mn}$ is the Kronecker delta. The overlap matrix $S$ is therefore a diagonal matrix.\n\n**Hamiltonian Matrix $H_{mn}$**\nThe Hamiltonian matrix elements can be separated into kinetic and potential energy contributions: $H_{mn} = T_{mn} + V_{mn}$.\n\n**Kinetic Energy Term $T_{mn}$**\nThe kinetic energy operator is $T = -\\frac{\\hbar^2}{2m}\\frac{d^2}{dx^2}$. Its matrix elements are:\n$$T_{mn} = \\int_0^L \\sin\\left(\\frac{m\\pi x}{L}\\right) \\left(-\\frac{\\hbar^2}{2m}\\frac{d^2}{dx^2}\\right) \\sin\\left(\\frac{n\\pi x}{L}\\right) dx$$\nThe basis functions are eigenfunctions of the second derivative operator:\n$$\\frac{d^2}{dx^2} \\sin\\left(\\frac{n\\pi x}{L}\\right) = -\\left(\\frac{n\\pi}{L}\\right)^2 \\sin\\left(\\frac{n\\pi x}{L}\\right)$$\nSubstituting this into the integral for $T_{mn}$:\n$$T_{mn} = \\frac{\\hbar^2}{2m} \\left(\\frac{n\\pi}{L}\\right)^2 \\int_0^L \\sin\\left(\\frac{m\\pi x}{L}\\right) \\sin\\left(\\frac{n\\pi x}{L}\\right) dx = \\frac{\\hbar^2 \\pi^2 n^2}{2mL^2} S_{mn}$$\nUsing $S_{mn}=\\frac{L}{2}\\delta_{mn}$ and the specified units $\\hbar=1, m=1$:\n$$T_{mn} = \\frac{\\pi^2 n^2}{2L^2} \\left(\\frac{L}{2}\\delta_{mn}\\right) = \\frac{\\pi^2 n^2}{4L} \\delta_{mn}$$\nThe kinetic energy matrix $T$ is also diagonal.\n\n**Potential Energy Term $V_{mn}$**\nThe potential is $V(x) = \\epsilon x / L$. Its matrix elements are:\n$$V_{mn} = \\int_0^L \\sin\\left(\\frac{m\\pi x}{L}\\right) \\left(\\frac{\\epsilon x}{L}\\right) \\sin\\left(\\frac{n\\pi x}{L}\\right) dx = \\frac{\\epsilon}{L} \\int_0^L x \\sin\\left(\\frac{m\\pi x}{L}\\right) \\sin\\left(\\frac{n\\pi x}{L}\\right) dx$$\nTo evaluate this integral, we first consider the diagonal elements, $m=n$:\n$$V_{nn} = \\frac{\\epsilon}{L} \\int_0^L x \\sin^2\\left(\\frac{n\\pi x}{L}\\right) dx = \\frac{\\epsilon}{L} \\int_0^L x \\frac{1}{2}\\left(1 - \\cos\\left(\\frac{2n\\pi x}{L}\\right)\\right) dx$$\nThe integral $\\int_0^L x \\cos(ax) dx$ evaluates to zero for $a = 2n\\pi/L$. Thus, only the first term contributes:\n$$V_{nn} = \\frac{\\epsilon}{2L} \\int_0^L x dx = \\frac{\\epsilon}{2L} \\left[\\frac{x^2}{2}\\right]_0^L = \\frac{\\epsilon}{2L} \\frac{L^2}{2} = \\frac{\\epsilon L}{4}$$\nFor the off-diagonal elements, $m \\neq n$, we use the identity $\\sin A \\sin B = \\frac{1}{2}[\\cos(A-B) - \\cos(A+B)]$:\n$$V_{mn} = \\frac{\\epsilon}{2L} \\int_0^L x \\left[ \\cos\\left(\\frac{(m-n)\\pi x}{L}\\right) - \\cos\\left(\\frac{(m+n)\\pi x}{L}\\right) \\right] dx$$\nWe use the standard integral, evaluated via integration by parts:\n$$\\int_0^L x \\cos\\left(\\frac{k\\pi x}{L}\\right) dx = \\frac{L^2}{(k\\pi)^2}(\\cos(k\\pi)-1) = \\frac{L^2}{(k\\pi)^2}((-1)^k-1)$$\nThis integral is zero if $k$ is an even integer, and $-2L^2/(k\\pi)^2$ if $k$ is an odd integer.\nFor $V_{mn}$ where $m \\ne n$, the integers $k$ are $(m-n)$ and $(m+n)$. Both have the same parity.\nIf $(m-n)$ is even, both integrals are zero, so $V_{mn}=0$.\nIf $(m-n)$ is odd, both integrals are non-zero:\n\\begin{align*} V_{mn} = \\frac{\\epsilon}{2L} \\left[ \\frac{-2L^2}{((m-n)\\pi)^2} - \\frac{-2L^2}{((m+n)\\pi)^2} \\right] \\\\ = -\\frac{\\epsilon L}{\\pi^2} \\left[ \\frac{1}{(m-n)^2} - \\frac{1}{(m+n)^2} \\right] \\\\ = -\\frac{\\epsilon L}{\\pi^2} \\frac{(m+n)^2 - (m-n)^2}{(m^2-n^2)^2} \\\\ = -\\frac{\\epsilon L}{\\pi^2} \\frac{4mn}{(m^2-n^2)^2}\\end{align*}\n\n**Summary of Matrix Elements**\nIn the units $\\hbar=1, m=1$:\n$S_{mn} = \\frac{L}{2}\\delta_{mn}$\n$H_{mn} = T_{mn} + V_{mn}$, where\nFor $m=n$:\n$$H_{nn} = \\frac{\\pi^2 n^2}{4L} + \\frac{\\epsilon L}{4}$$\nFor $m \\ne n$:\n$$H_{mn} = \\begin{cases} 0  \\text{if } (m-n) \\text{ is even} \\\\ -\\dfrac{4\\epsilon L}{\\pi^2} \\dfrac{mn}{(m^2-n^2)^2}  \\text{if } (m-n) \\text{ is odd} \\end{cases}$$\n\nThese matrices are constructed and used to solve the generalized eigenvalue problem $H\\mathbf{c} = E S\\mathbf{c}$. The lowest eigenvalue $E_0$ is the ground-state energy estimate. The corresponding eigenvector $\\mathbf{c}$ is normalized such that $\\mathbf{c}^T S \\mathbf{c} = 1$, which is equivalent to $\\int_0^L \\psi^2(x)dx=1$. The global phase is fixed by requiring the first non-negligible coefficient $c_n$ to be positive.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.linalg import eigh\n\ndef solve():\n    \"\"\"\n    Solves the variational problem for a particle in a 1D box with a linear potential.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (N, L, epsilon)\n        (6, 1.0, 0.0),   # Case A\n        (6, 1.0, 0.1),   # Case B\n        (12, 1.0, 5.0),  # Case C\n        (1, 1.0, 1.0),   # Case D\n    ]\n\n    results = []\n    for N, L, epsilon in test_cases:\n        # Assemble the overlap matrix S and Hamiltonian matrix H.\n        S = np.zeros((N, N))\n        H = np.zeros((N, N))\n\n        # Populate the matrices using 1-based indexing for n and m for clarity\n        # with the derived formulas.\n        for i in range(N):\n            for j in range(N):\n                n = i + 1\n                m = j + 1\n                \n                if i == j:\n                    S[i, j] = L / 2.0\n                    # With hbar=1, m=1, T_nn_contrib = (pi^2 * n^2) / (2 * L^2)\n                    # H_nn = T_nn_contrib * S_nn + V_nn\n                    # H_nn = [(pi^2*n^2)/(2*L^2)]*(L/2) + eps*L/4\n                    H[i, j] = (np.pi**2 * n**2) / (4.0 * L) + epsilon * L / 4.0\n                else:\n                    S[i, j] = 0.0\n                    # T_mn is zero for m != n\n                    # V_mn is non-zero only if (m-n) is odd\n                    if (m - n) % 2 != 0:\n                        V_mn = (-4.0 * epsilon * L / np.pi**2) * \\\n                               (m * n) / (m**2 - n**2)**2\n                        H[i, j] = V_mn\n                    else:\n                        H[i, j] = 0.0\n\n        # Solve the generalized eigenvalue problem Hc = ESc\n        # eigh returns eigenvalues in ascending order and corresponding eigenvectors.\n        # When S is specified, eigenvectors are S-orthonormal (c.T @ S @ c = I)\n        # We need to re-normalize them. The solver in scipy.linalg already normalizes\n        # them such that c.T @ S @ c = 1 for each eigenvector c.\n        eigenvalues, eigenvectors = eigh(H, S)\n\n        # The ground state energy is the lowest eigenvalue\n        E0 = eigenvalues[0]\n\n        # The coefficients are the first eigenvector\n        c = eigenvectors[:, 0]\n\n        # Fix the global sign ambiguity.\n        # Enforce that the first coefficient with magnitude greater than a small\n        # threshold is non-negative.\n        threshold = 1e-9\n        for k in range(N):\n            if abs(c[k]) > threshold:\n                if c[k]  0:\n                    c = -c\n                break\n        \n        # Extract the first three coefficients, padding with zeros if N  3.\n        c1 = c[0] if N >= 1 else 0.0\n        c2 = c[1] if N >= 2 else 0.0\n        c3 = c[2] if N >= 3 else 0.0\n\n        # Append the formatted result for this case.\n        results.append([E0, c1, c2, c3])\n\n    # Format the final output string exactly as specified.\n    # Each sublist is formatted, then joined by commas, and enclosed in brackets.\n    formatted_results = []\n    for res in results:\n        formatted_res = f\"[{res[0]:.6f},{res[1]:.6f},{res[2]:.6f},{res[3]:.6f}]\"\n        formatted_results.append(formatted_res)\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}