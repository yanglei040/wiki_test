{
    "hands_on_practices": [
        {
            "introduction": "任何电子结构计算的第一步，都是从真实空间晶格过渡到其倒易空间对应物。能带结构所绘制的布里渊区，正是在这个倒易晶格中构建的。本练习将让你实践石墨烯（一种具有巨大科学研究价值的材料）的基本数学变换，为所有后续分析提供必要的几何基础。",
            "id": "1774232",
            "problem": "一位凝聚态物理学家正在开发一个计算模型，以研究石墨烯的电子能带结构。石墨烯是一种由排列成六角晶格的碳原子组成的二维材料。一个关键的首要步骤是建立倒易晶格的几何结构，因为涉及电子波函数的计算依赖于在k空间（动量空间）中的分析。\n\n该物理学家定义了一个笛卡尔坐标系 $(\\hat{i}, \\hat{j})$，并使用以下原胞基矢来描述实空间布拉菲晶格，其中 $a$ 是恒定的碳-碳键长：\n$$\n\\vec{a}_1 = \\frac{a}{2}(3\\hat{i} + \\sqrt{3}\\hat{j})\n$$\n$$\n\\vec{a}_2 = \\frac{a}{2}(3\\hat{i} - \\sqrt{3}\\hat{j})\n$$\n倒易晶格原胞基矢，记作 $\\vec{b}_1$ 和 $\\vec{b}_2$，由基本关系式 $\\vec{a}_i \\cdot \\vec{b}_j = 2\\pi \\delta_{ij}$ 定义，其中 $i, j \\in \\{1, 2\\}$ 且 $\\delta_{ij}$ 是克罗内克δ函数。\n\n您的任务是确定这些倒易晶格原胞基矢的笛卡尔分量。将这些矢量表示为 $\\vec{b}_1 = b_{1x}\\hat{i} + b_{1y}\\hat{j}$ 和 $\\vec{b}_2 = b_{2x}\\hat{i} + b_{2y}\\hat{j}$。以键长 $a$ 的符号表达式形式，求出这四个分量（$b_{1x}, b_{1y}, b_{2x}, b_{2y}$）。",
            "solution": "该问题要求我们求出与给定的实空间原胞基矢 $\\vec{a}_1$ 和 $\\vec{a}_2$ 相对应的倒易晶格原胞基矢 $\\vec{b}_1$ 和 $\\vec{b}_2$。它们之间的关系由 $\\vec{a}_i \\cdot \\vec{b}_j = 2\\pi \\delta_{ij}$ 给出。\n\n我们将这些矢量以分量形式写出：\n$\\vec{a}_1 = \\left( \\frac{3a}{2}, \\frac{\\sqrt{3}a}{2} \\right)$\n$\\vec{a}_2 = \\left( \\frac{3a}{2}, -\\frac{\\sqrt{3}a}{2} \\right)$\n以及未知的倒易矢量：\n$\\vec{b}_1 = (b_{1x}, b_{1y})$\n$\\vec{b}_2 = (b_{2x}, b_{2y})$\n\n该定义关系给了我们一个包含四个方程的方程组：\n1. $\\vec{a}_1 \\cdot \\vec{b}_1 = 2\\pi$\n2. $\\vec{a}_1 \\cdot \\vec{b}_2 = 0$\n3. $\\vec{a}_2 \\cdot \\vec{b}_1 = 0$\n4. $\\vec{a}_2 \\cdot \\vec{b}_2 = 2\\pi$\n\n首先，我们使用方程（1）和（3）求解 $\\vec{b}_1$ 的分量。\n方程（3）为 $\\vec{a}_2 \\cdot \\vec{b}_1 = 0$:\n$$\n\\left( \\frac{3a}{2} \\right) b_{1x} + \\left( -\\frac{\\sqrt{3}a}{2} \\right) b_{1y} = 0\n$$\n$$\n\\frac{3a}{2} b_{1x} = \\frac{\\sqrt{3}a}{2} b_{1y}\n$$\n$$\n3 b_{1x} = \\sqrt{3} b_{1y} \\implies b_{1y} = \\sqrt{3} b_{1x}\n$$\n现在我们将此结果代入方程（1），$\\vec{a}_1 \\cdot \\vec{b}_1 = 2\\pi$:\n$$\n\\left( \\frac{3a}{2} \\right) b_{1x} + \\left( \\frac{\\sqrt{3}a}{2} \\right) b_{1y} = 2\\pi\n$$\n代入 $b_{1y} = \\sqrt{3} b_{1x}$:\n$$\n\\frac{3a}{2} b_{1x} + \\frac{\\sqrt{3}a}{2} (\\sqrt{3} b_{1x}) = 2\\pi\n$$\n$$\n\\frac{3a}{2} b_{1x} + \\frac{3a}{2} b_{1x} = 2\\pi\n$$\n$$\n3a b_{1x} = 2\\pi \\implies b_{1x} = \\frac{2\\pi}{3a}\n$$\n现在求 $b_{1y}$:\n$$\nb_{1y} = \\sqrt{3} b_{1x} = \\sqrt{3} \\left( \\frac{2\\pi}{3a} \\right) = \\frac{2\\sqrt{3}\\pi}{3a}\n$$\n所以，第一个倒易晶格矢量是 $\\vec{b}_1 = \\frac{2\\pi}{3a} \\hat{i} + \\frac{2\\sqrt{3}\\pi}{3a} \\hat{j}$。\n\n接下来，我们使用方程（2）和（4）求解 $\\vec{b}_2$ 的分量。\n方程（2）为 $\\vec{a}_1 \\cdot \\vec{b}_2 = 0$:\n$$\n\\left( \\frac{3a}{2} \\right) b_{2x} + \\left( \\frac{\\sqrt{3}a}{2} \\right) b_{2y} = 0\n$$\n$$\n\\frac{3a}{2} b_{2x} = -\\frac{\\sqrt{3}a}{2} b_{2y}\n$$\n$$\n3 b_{2x} = -\\sqrt{3} b_{2y} \\implies b_{2y} = -\\sqrt{3} b_{2x}\n$$\n现在我们将此结果代入方程（4），$\\vec{a}_2 \\cdot \\vec{b}_2 = 2\\pi$:\n$$\n\\left( \\frac{3a}{2} \\right) b_{2x} + \\left( -\\frac{\\sqrt{3}a}{2} \\right) b_{2y} = 2\\pi\n$$\n代入 $b_{2y} = -\\sqrt{3} b_{2x}$:\n$$\n\\frac{3a}{2} b_{2x} - \\frac{\\sqrt{3}a}{2} (-\\sqrt{3} b_{2x}) = 2\\pi\n$$\n$$\n\\frac{3a}{2} b_{2x} + \\frac{3a}{2} b_{2x} = 2\\pi\n$$\n$$\n3a b_{2x} = 2\\pi \\implies b_{2x} = \\frac{2\\pi}{3a}\n$$\n现在求 $b_{2y}$:\n$$\nb_{2y} = -\\sqrt{3} b_{2x} = -\\sqrt{3} \\left( \\frac{2\\pi}{3a} \\right) = -\\frac{2\\sqrt{3}\\pi}{3a}\n$$\n所以，第二个倒易晶格矢量是 $\\vec{b}_2 = \\frac{2\\pi}{3a} \\hat{i} - \\frac{2\\sqrt{3}\\pi}{3a} \\hat{j}$。\n\n这四个分量是：\n$b_{1x} = \\frac{2\\pi}{3a}$\n$b_{1y} = \\frac{2\\sqrt{3}\\pi}{3a}$\n$b_{2x} = \\frac{2\\pi}{3a}$\n$b_{2y} = -\\frac{2\\sqrt{3}\\pi}{3a}$",
            "answer": "$$\\boxed{\\begin{pmatrix} \\frac{2\\pi}{3a} & \\frac{2\\sqrt{3}\\pi}{3a} & \\frac{2\\pi}{3a} & -\\frac{2\\sqrt{3}\\pi}{3a} \\end{pmatrix}}$$"
        },
        {
            "introduction": "在引入真实的原子势之前，考虑“空晶格近似”极具启发性，即电子是自由的（$V(\\mathbf{r}) = 0$），但仍受晶格周期性的约束。本练习将引导你通过计算，将简单的自由电子抛物线 $E = \\hbar^2 k^2 / 2m$ “折叠”到面心立方（FCC）晶体的第一布里渊区中。这个实践揭示了能带结构的复杂外观如何纯粹源于底层的晶格几何，而尚未涉及电子与原子的相互作用。",
            "id": "2387885",
            "problem": "你需要编写一个完整的程序，通过将自由电子色散关系折叠到第一布里渊区，来计算面心立方晶体的空晶格能带能量。在空晶格近似下，具有晶格波矢 $\\mathbf{k}$ 的电子的能量由下式给出：\n$$\nE(\\mathbf{k}) \\;=\\; \\frac{\\hbar^2}{2 m_{\\mathrm{e}}}\\,\\lVert \\mathbf{k} + \\mathbf{G}\\rVert^2,\n$$\n其中 $\\hbar$ 是约化普朗克常数，$m_{\\mathrm{e}}$ 是电子质量，而 $\\mathbf{G}$ 是一个倒格矢。对于一个常规立方晶格参数为 $a$ 的面心立方正晶格，一组方便选择的原初正格矢是：\n$$\n\\mathbf{a}_1 \\;=\\; \\frac{a}{2}(0,1,1),\\quad\n\\mathbf{a}_2 \\;=\\; \\frac{a}{2}(1,0,1),\\quad\n\\mathbf{a}_3 \\;=\\; \\frac{a}{2}(1,1,0).\n$$\n相应的原初倒格矢 $\\mathbf{b}_i$ 由 $\\mathbf{b}_i\\cdot \\mathbf{a}_j = 2\\pi\\,\\delta_{ij}$ 定义，其具体形式为：\n$$\n\\mathbf{b}_1 \\;=\\; \\frac{2\\pi}{a}(-1,1,1),\\quad\n\\mathbf{b}_2 \\;=\\; \\frac{2\\pi}{a}(1,-1,1),\\quad\n\\mathbf{b}_3 \\;=\\; \\frac{2\\pi}{a}(1,1,-1).\n$$\n任何一个倒格矢都可以写成 $\\mathbf{G} = m\\,\\mathbf{b}_1 + n\\,\\mathbf{b}_2 + p\\,\\mathbf{b}_3$ 的形式，其中 $m,n,p$ 是整数。晶格波矢 $\\mathbf{k}$ 在沿常规立方晶轴的笛卡尔坐标系中指定，并以 $(2\\pi/a)$ 为单位，即 $\\mathbf{k} = (2\\pi/a)\\,(k_x,k_y,k_z)$，其中 $(k_x,k_y,k_z)$ 是一个无量纲三元组。\n\n请使用以下国际单位制（SI）中的物理常量：\n$$\n\\hbar = 1.054571817\\times 10^{-34}\\,\\mathrm{J\\cdot s},\\quad\nm_{\\mathrm{e}} = 9.1093837015\\times 10^{-31}\\,\\mathrm{kg},\\quad\ne = 1.602176634\\times 10^{-19}\\,\\mathrm{C}.\n$$\n使用晶格参数：\n$$\na = 5.43\\times 10^{-10}\\,\\mathrm{m}.\n$$\n\n对于下面测试套件中的每个晶格波矢 $\\mathbf{k}$，通过对所有由整数系数 $m,n,p$ 在闭区间 $[-2,2]$ 内（即 $m,n,p\\in\\{-2,-1,0,1,2\\}$）构成的倒格矢 $\\mathbf{G}$ 来计算 $E(\\mathbf{k})$，从而生成能带能量的集合，然后将得到的能量按升序排序。报告最低的 $M$ 个能量（$M = 8$），允许简并（即，不要对因不同 $\\mathbf{G}$ 而产生的相等值进行去重）。\n\n将最终能量除以 $e$ 以电子伏特为单位表示，并将每个报告值四舍五入到小数点后恰好 $6$ 位。\n\n测试套件（每个 $\\mathbf{k}$ 由以 $(2\\pi/a)$ 为单位的无量纲笛卡尔三元组 $(k_x,k_y,k_z)$ 给出）：\n- 情况1（内部点）：$(0.2,\\,0.3,\\,0.1)$。\n- 情况2（布里渊区中心 $\\Gamma$ 点）：$(0.0,\\,0.0,\\,0.0)$。\n- 情况3（边界 $X$ 点）：$(0.0,\\,1.0,\\,0.0)$。\n- 情况4（边界 $L$ 点）：$(0.5,\\,0.5,\\,0.5)$。\n- 情况5（边界 $W$ 点）：$(1.0,\\,0.5,\\,0.0)$。\n\n你的程序必须输出单行，其中包含所有五个情况的结果列表，并按照从情况1到情况5的顺序排列。每个情况的结果是一个包含 $M$ 个能量值（单位为电子伏特）的列表。最终的输出格式必须是单行，形式为一个用方括号括起来的、逗号分隔的列表，其中每个元素本身是一个包含 $M$ 个浮点数的列表，这些浮点数被四舍五入到小数点后恰好 $6$ 位。例如，\n$$\n[\\,[E_{1,1},E_{1,2},\\dots,E_{1,8}],\\,[E_{2,1},\\dots,E_{2,8}],\\,\\dots,\\,[E_{5,1},\\dots,E_{5,8}]\\,]\n$$\n不含任何额外文本。所有能量都必须以电子伏特为单位，并四舍五入到小数点后恰好 $6$ 位。本问题不涉及角度。最终列表的元素是浮点数，并且打印输出时必须保留嵌套列表结构。",
            "solution": "该问题要求计算面心立方（FCC）晶体的空晶格能带结构。解决方案在方法上必须是可靠的，并严格遵守固态物理学原理和计算的正确性。\n\n其基本物理原理是使用布洛赫波（Bloch waves）来表示周期性势场中的电子态，这些电子态由限制在第一布里渊区内的晶格波矢 $\\mathbf{k}$ 来表征。在空晶格近似中，周期性势场设为零，电子表现为自由粒子。它们的能量-动量关系是抛物线型的：$E = \\frac{\\hbar^2}{2m_{\\mathrm{e}}} q^2$，其中 $\\mathbf{q}$ 是自由电子波矢。然而，晶格的周期性要求相差一个倒格矢 $\\mathbf{G}$ 的波矢 $\\mathbf{q}$ 是等效的。这导致了自由电子抛物线型色散关系被“折叠”到第一布里渊区。因此，对于一个给定的晶格波矢 $\\mathbf{k}$，其能带由所有可能的自由电子波矢 $\\mathbf{k}+\\mathbf{G}$ 对应的能量集合给出：\n$$E(\\mathbf{k}) \\;=\\; \\frac{\\hbar^2}{2 m_{\\mathrm{e}}}\\,\\lVert \\mathbf{k} + \\mathbf{G}\\rVert^2$$\n这里，$\\hbar$ 是约化普朗克常数，$m_{\\mathrm{e}}$ 是电子静止质量，$\\mathbf{G}$ 是一个倒格矢。\n\n为了将该公式用于计算，我们必须在一致的坐标系中表示所有矢量，并管理好物理单位。问题在以因子 $\\frac{2\\pi}{a}$ 缩放的笛卡尔坐标系中指定了晶格波矢 $\\mathbf{k}$ 和倒格矢 $\\mathbf{G}$，其中 $a$ 是常规立方晶格参数。\n令无量纲晶格波矢为 $\\mathbf{k}' = (k_x,k_y,k_z)$，使得 $\\mathbf{k} = \\frac{2\\pi}{a}\\mathbf{k}'$。\n倒格矢 $\\mathbf{G}$ 是原初倒格矢 $\\mathbf{b}_i$ 的整数组合：\n$$\\mathbf{G} = m\\,\\mathbf{b}_1 + n\\,\\mathbf{b}_2 + p\\,\\mathbf{b}_3$$\n其中 $m, n, p$ 是整数。代入给定的面心立方（FCC）晶格的原初格矢：\n$$\\mathbf{G} = m\\,\\frac{2\\pi}{a}(-1,1,1) + n\\,\\frac{2\\pi}{a}(1,-1,1) + p\\,\\frac{2\\pi}{a}(1,1,-1)$$\n提出公因子 $\\frac{2\\pi}{a}$，我们定义一个无量纲倒格矢 $\\mathbf{G}'$：\n$$\\mathbf{G} = \\frac{2\\pi}{a}\\mathbf{G}' \\quad \\text{其中} \\quad \\mathbf{G}' = (-m+n+p, m-n+p, m+n-p)$$\n范数内的矢量和变为：\n$$\\mathbf{k} + \\mathbf{G} = \\frac{2\\pi}{a}(\\mathbf{k}' + \\mathbf{G}')$$\n将此代入能量方程得到：\n$$E(\\mathbf{k}) = \\frac{\\hbar^2}{2 m_{\\mathrm{e}}} \\left(\\frac{2\\pi}{a}\\right)^2 \\lVert \\mathbf{k}' + \\mathbf{G}'\\rVert^2$$\n该表达式将计算分为两部分：一个取决于基本常数和晶格参数的恒定预因子，以及一个无量纲的几何项 $\\lVert \\mathbf{k}' + \\mathbf{G}'\\rVert^2$。能量要求以电子伏特（eV）为单位。我们可以将从焦耳到电子伏特的转换因子（即基本电荷 $e$）包含在预因子中。最终以 eV 为单位的能量计算公式是：\n$$E_{\\text{eV}} = C_{\\text{eV}} \\cdot \\lVert \\mathbf{k}' + \\mathbf{G}'\\rVert^2, \\quad \\text{其中} \\quad C_{\\text{eV}} = \\frac{\\hbar^2}{2 m_{\\mathrm{e}}e} \\left(\\frac{2\\pi}{a}\\right)^2$$\n该预因子 $C_{\\text{eV}}$ 将使用提供的 $\\hbar$、$m_{\\mathrm{e}}$、$e$ 和 $a$ 的高精度值计算一次。\n\n算法步骤如下：\n1.  计算以 eV 为单位的能量预因子 $C_{\\text{eV}}$ 的数值。\n2.  通过遍历指定的整数范围 $m, n, p \\in \\{-2, -1, 0, 1, 2\\}$，生成所有无量纲倒格矢 $\\mathbf{G}'$ 的集合。这将产生 $5^3 = 125$ 个不同的矢量。\n3.  对于由无量纲晶格波矢 $\\mathbf{k}'$ 指定的每个测试用例：\n    a. 初始化一个空列表来存储能带能量。\n    b. 对于生成的集合中的 125 个矢量 $\\mathbf{G}'$ 中的每一个：\n        i. 计算矢量和 $\\mathbf{v} = \\mathbf{k}' + \\mathbf{G}'$。\n        ii. 计算结果矢量的欧几里得范数的平方，$\\lVert \\mathbf{v} \\rVert^2 = v_x^2 + v_y^2 + v_z^2$。\n        iii. 将范数的平方乘以预因子 $C_{\\text{eV}}$ 以获得以 eV 为单位的能量。\n        iv. 将计算出的能量附加到列表中。\n    c. 将 125 个能量的列表按升序排序。\n    d. 从排序后的列表中选择前 $M=8$ 个能量。\n    e. 将这 8 个值中的每一个四舍五入到恰好 6 位小数。\n4.  将所有测试用例的结果合并到一个最终的列表的列表中。然后根据输出规范将此结构格式化为单行字符串，确保每个数值都表示为小数点后恰好六位。此精度要求显式的字符串格式化。\n该实现将利用 `numpy` 库进行精确的数值运算和矢量代数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the empty-lattice band energies for a face-centered cubic crystal.\n    \"\"\"\n    # Define physical constants in SI units.\n    H_BAR = 1.054571817e-34  # J.s, reduced Planck constant\n    M_E = 9.1093837015e-31  # kg, electron mass\n    E_CHARGE = 1.602176634e-19  # C, elementary charge for eV conversion\n\n    # Define the lattice parameter for the FCC crystal.\n    A = 5.43e-10  # m\n\n    # Pre-calculate the energy prefactor in eV.\n    # The energy in eV is given by E_eV = C_eV * ||k' + G'||^2,\n    # where k' and G' are dimensionless vectors.\n    # The prefactor C_eV is (hbar^2 / (2 * m_e * e)) * (2*pi/a)^2.\n    C_eV = (H_BAR**2 / (2 * M_E * E_CHARGE)) * (2 * np.pi / A)**2\n\n    # Generate the set of dimensionless reciprocal lattice vectors G'.\n    # G' = (-m+n+p, m-n+p, m+n-p) for integers m, n, p.\n    g_vectors = []\n    integer_range = range(-2, 3)  # Integers from -2 to 2 inclusive.\n    for m in integer_range:\n        for n in integer_range:\n            for p in integer_range:\n                gx = -m + n + p\n                gy = m - n + p\n                gz = m + n - p\n                g_vectors.append(np.array([gx, gy, gz]))\n\n    # Define the test cases from the problem statement.\n    # Each k_prime is a dimensionless crystal wavevector k' = (kx, ky, kz).\n    test_cases = [\n        np.array([0.2, 0.3, 0.1]),  # Case 1 (interior)\n        np.array([0.0, 0.0, 0.0]),  # Case 2 (Gamma point)\n        np.array([0.0, 1.0, 0.0]),  # Case 3 (X point)\n        np.array([0.5, 0.5, 0.5]),  # Case 4 (L point)\n        np.array([1.0, 0.5, 0.0]),  # Case 5 (W point)\n    ]\n\n    M = 8  # Number of lowest energies to report.\n    all_results = []\n\n    for k_prime in test_cases:\n        # Main logic to calculate the result for one case goes here.\n        energies = []\n        for g_prime in g_vectors:\n            # Calculate the vector sum k' + G'.\n            v = k_prime + g_prime\n            \n            # Calculate the squared Euclidean norm ||k' + G'||^2.\n            norm_sq = np.dot(v, v)\n            \n            # Calculate the energy in eV.\n            energy = C_eV * norm_sq\n            energies.append(energy)\n        \n        # Sort the computed energies in ascending order.\n        energies.sort()\n        \n        # Select the lowest M energies.\n        lowest_m_energies = energies[:M]\n        \n        # The problem requires rounding, which is handled during formatting.\n        all_results.append(lowest_m_energies)\n\n    # Format the final output string according to the problem specification.\n    # Each energy must be formatted to exactly 6 decimal places.\n    # Each case's result is a list of M floats.\n    # The overall output is a list of these lists.\n    case_results_str = []\n    for result_list in all_results:\n        # Format each number to a string with 6 decimal places.\n        # This handles the \"exactly 6 digits\" requirement.\n        num_strs = [f\"{val:.6f}\" for val in result_list]\n        # Join numbers into a list string, e.g., \"[1.234567,2.345678]\"\n        case_str = '[' + ','.join(num_strs) + ']'\n        case_results_str.append(case_str)\n    \n    # Final print statement in the exact required format.\n    final_output_str = '[' + ','.join(case_results_str) + ']'\n    print(final_output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "在我们理解了晶格几何的基础上，现在可以应用紧束缚模型，这是一种描述真实材料中电子行为的强大方法。本实践将挑战你为石墨烯实现一个紧束缚模型，你将发现其在 K 点处著名的无带隙“狄拉克锥”。此外，你将通过打破晶格的子晶格对称性，主动地打开一个带隙——这是半导体的关键特征，从而展示了材料设计的一项基本原则。",
            "id": "2387847",
            "problem": "要求您实现一个石墨烯的最近邻紧束缚（TB）模型，并量化不等在位能如何通过破坏子晶格对称性在狄拉克点处打开带隙。在一个具有三角布拉菲晶格的二维蜂窝晶格上使用双原子基矢。设最近邻距离为无量纲值 $1$，以此定义长度单位。在倒易空间中进行计算，使得相位 $e^{i \\mathbf{k} \\cdot \\boldsymbol{\\delta}_j}$ 中的角度以弧度为单位。所有能量必须以电子伏特 (eV) 表示。\n\n蜂窝晶格由三角布拉菲晶格构成，其原胞矢量为\n$$\n\\mathbf{a}_1 = (\\sqrt{3}, \\, 0), \\quad \\mathbf{a}_2 = \\left(\\frac{\\sqrt{3}}{2}, \\, \\frac{3}{2}\\right).\n$$\n连接子晶格 $A$ 到子晶格 $B$ 的三个最近邻矢量为\n$$\n\\boldsymbol{\\delta}_1 = (0, \\, 1), \\quad \\boldsymbol{\\delta}_2 = \\left(\\frac{\\sqrt{3}}{2}, \\, -\\frac{1}{2}\\right), \\quad \\boldsymbol{\\delta}_3 = \\left(-\\frac{\\sqrt{3}}{2}, \\, -\\frac{1}{2}\\right).\n$$\n令 $\\mathbf{b}_1$ 和 $\\mathbf{b}_2$ 为倒易晶格矢量，由 $\\mathbf{a}_i \\cdot \\mathbf{b}_j = 2\\pi \\delta_{ij}$ 定义。定义狄拉克点\n$$\n\\mathbf{K} = \\frac{1}{3}\\left(\\mathbf{b}_1 + 2 \\mathbf{b}_2\\right).\n$$\n\n在最近邻紧束缚哈密顿量中，设子晶格 $A$ 和 $B$ 上的在位能分别为 $E_A$ 和 $E_B$，最近邻跃迁能为 $t$，则对于波矢 $\\mathbf{k}$ 的布洛赫哈密顿量是一个 $2\\times 2$ 的厄米矩阵\n$$\nH(\\mathbf{k}) = \\begin{pmatrix}\nE_A & -t \\, f(\\mathbf{k}) \\\\\n-t \\, f^*(\\mathbf{k}) & E_B\n\\end{pmatrix},\n$$\n其中\n$$\nf(\\mathbf{k}) = \\sum_{j=1}^{3} e^{i \\mathbf{k}\\cdot \\boldsymbol{\\delta}_j}.\n$$\n\n对于每组参数，计算作为 $H(\\mathbf{k})$ 的本征值 $E_{-}(\\mathbf{k}) \\le E_{+}(\\mathbf{k})$ 的两个能带，并评估在狄拉克点 $\\mathbf{K}$ 处的直接带隙，\n$$\n\\Delta_{\\mathbf{K}} = E_{+}(\\mathbf{K}) - E_{-}(\\mathbf{K}),\n$$\n以电子伏特 (eV) 表示。$\\mathbf{k}\\cdot\\boldsymbol{\\delta}_j$ 的角度单位必须是弧度。您的程序必须为以下参数集 $(t, E_A, E_B)$ 测试套件输出 $\\Delta_{\\mathbf{K}}$ 的值，所有量均以电子伏特为单位：\n- $(2.7, \\, 0.0, \\, 0.0)$,\n- $(2.7, \\, 0.1, \\, -0.1)$,\n- $(1.0, \\, 0.25, \\, 0.0)$,\n- $(0.0, \\, 0.3, \\, -0.3)$,\n- $(3.0, \\, 0.4, \\, 0.4)$.\n\n最终输出格式：您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔结果列表，每个带隙值以 eV 为单位四舍五入到 $6$ 位小数。例如，格式必须是\n$$\n[\\Delta_{\\mathbf{K}}^{(1)},\\Delta_{\\mathbf{K}}^{(2)},\\ldots,\\Delta_{\\mathbf{K}}^{(5)}]\n$$\n其中每个 $\\Delta_{\\mathbf{K}}^{(i)}$ 都精确显示小数点后 $6$ 位。",
            "solution": "问题陈述已经过验证，被认为是科学合理的、表述清晰且内容自洽的。它提出了计算凝聚态物理中的一个标准问题。我们将提供一个完整的解决方案。\n\n目标是计算由最近邻紧束缚模型描述的类石墨烯蜂窝晶格在狄拉克点 $\\mathbf{K}$ 处的直接带隙 $\\Delta_{\\mathbf{K}}$。带隙定义为在 $\\mathbf{k}=\\mathbf{K}$ 处计算的布洛赫哈密顿量 $H(\\mathbf{k})$ 的两个能量本征值之差。\n\n提供的布洛赫哈密顿量是一个 $2\\times 2$ 矩阵：\n$$\nH(\\mathbf{k}) = \\begin{pmatrix}\nE_A & -t \\, f(\\mathbf{k}) \\\\\n-t \\, f^*(\\mathbf{k}) & E_B\n\\end{pmatrix}\n$$\n其中 $E_A$ 和 $E_B$ 是两个子晶格的在位能，$t$ 是最近邻跃迁能，而 $f(\\mathbf{k}) = \\sum_{j=1}^{3} e^{i \\mathbf{k}\\cdot \\boldsymbol{\\delta}_j}$ 是涉及三个最近邻矢量 $\\boldsymbol{\\delta}_j$ 的几何结构因子。\n\n能量本征值 $E(\\mathbf{k})$ 通过求解特征方程 $\\det(H(\\mathbf{k}) - E I) = 0$ 得到：\n$$\n(E_A - E)(E_B - E) - |-t f(\\mathbf{k})|^2 = 0\n$$\n$$\nE^2 - (E_A + E_B)E + E_A E_B - t^2|f(\\mathbf{k})|^2 = 0\n$$\n能带 $E_{\\pm}(\\mathbf{k})$ 的解由二次公式给出：\n$$\nE_{\\pm}(\\mathbf{k}) = \\frac{E_A + E_B}{2} \\pm \\sqrt{\\left(\\frac{E_A - E_B}{2}\\right)^2 + t^2 |f(\\mathbf{k})|^2}\n$$\n在波矢 $\\mathbf{k}$ 处的直接带隙是这两个能带之差：\n$$\n\\Delta_{\\mathbf{k}} = E_{+}(\\mathbf{k}) - E_{-}(\\mathbf{k}) = 2\\sqrt{\\left(\\frac{E_A - E_B}{2}\\right)^2 + t^2 |f(\\mathbf{k})|^2} = \\sqrt{(E_A - E_B)^2 + 4t^2 |f(\\mathbf{k})|^2}\n$$\n为了评估狄拉克点 $\\mathbf{K}$ 处的带隙，我们必须首先确定 $\\mathbf{K}$ 的坐标。问题定义 $\\mathbf{K} = \\frac{1}{3}(\\mathbf{b}_1 + 2 \\mathbf{b}_2)$，其中 $\\mathbf{b}_1$ 和 $\\mathbf{b}_2$ 是对应于原胞晶格矢量 $\\mathbf{a}_1 = (\\sqrt{3}, 0)$ 和 $\\mathbf{a}_2 = (\\frac{\\sqrt{3}}{2}, \\frac{3}{2})$ 的倒易晶格矢量。倒易矢量由关系 $\\mathbf{a}_i \\cdot \\mathbf{b}_j = 2\\pi \\delta_{ij}$ 定义。\n\n实空间原胞的面积是 $A = |\\mathbf{a}_1 \\times \\mathbf{a}_2| = \\sqrt{3} \\cdot \\frac{3}{2} - 0 \\cdot \\frac{\\sqrt{3}}{2} = \\frac{3\\sqrt{3}}{2}$。倒易矢量则计算如下：\n$$\n\\mathbf{b}_1 = \\frac{2\\pi}{A} (a_{2y}, -a_{2x}) = \\frac{2\\pi}{3\\sqrt{3}/2} \\left(\\frac{3}{2}, -\\frac{\\sqrt{3}}{2}\\right) = \\left(\\frac{2\\pi}{\\sqrt{3}}, -\\frac{2\\pi}{3}\\right)\n$$\n$$\n\\mathbf{b}_2 = \\frac{2\\pi}{A} (-a_{1y}, a_{1x}) = \\frac{2\\pi}{3\\sqrt{3}/2} (0, \\sqrt{3}) = \\left(0, \\frac{4\\pi}{3}\\right)\n$$\n使用这些，我们找到狄拉克点 $\\mathbf{K}$ 的坐标：\n$$\n\\mathbf{K} = \\frac{1}{3}(\\mathbf{b}_1 + 2\\mathbf{b}_2) = \\frac{1}{3}\\left[\\left(\\frac{2\\pi}{\\sqrt{3}}, -\\frac{2\\pi}{3}\\right) + 2\\left(0, \\frac{4\\pi}{3}\\right)\\right] = \\frac{1}{3}\\left(\\frac{2\\pi}{\\sqrt{3}}, \\frac{6\\pi}{3}\\right) = \\left(\\frac{2\\pi}{3\\sqrt{3}}, \\frac{2\\pi}{3}\\right)\n$$\n下一步是评估结构因子 $f(\\mathbf{K})$。这需要计算给定最近邻矢量 $\\boldsymbol{\\delta}_1 = (0, 1)$、$\\boldsymbol{\\delta}_2 = (\\frac{\\sqrt{3}}{2}, -\\frac{1}{2})$ 和 $\\boldsymbol{\\delta}_3 = (-\\frac{\\sqrt{3}}{2}, -\\frac{1}{2})$ 与 $\\mathbf{K}$ 的点积 $\\mathbf{K} \\cdot \\boldsymbol{\\delta}_j$：\n$$\n\\mathbf{K} \\cdot \\boldsymbol{\\delta}_1 = \\left(\\frac{2\\pi}{3\\sqrt{3}}, \\frac{2\\pi}{3}\\right) \\cdot (0, 1) = \\frac{2\\pi}{3}\n$$\n$$\n\\mathbf{K} \\cdot \\boldsymbol{\\delta}_2 = \\left(\\frac{2\\pi}{3\\sqrt{3}}, \\frac{2\\pi}{3}\\right) \\cdot \\left(\\frac{\\sqrt{3}}{2}, -\\frac{1}{2}\\right) = \\frac{2\\pi}{3\\sqrt{3}}\\frac{\\sqrt{3}}{2} - \\frac{2\\pi}{3}\\frac{1}{2} = \\frac{\\pi}{3} - \\frac{\\pi}{3} = 0\n$$\n$$\n\\mathbf{K} \\cdot \\boldsymbol{\\delta}_3 = \\left(\\frac{2\\pi}{3\\sqrt{3}}, \\frac{2\\pi}{3}\\right) \\cdot \\left(-\\frac{\\sqrt{3}}{2}, -\\frac{1}{2}\\right) = -\\frac{2\\pi}{3\\sqrt{3}}\\frac{\\sqrt{3}}{2} - \\frac{2\\pi}{3}\\frac{1}{2} = -\\frac{\\pi}{3} - \\frac{\\pi}{3} = -\\frac{2\\pi}{3}\n$$\n现在，我们计算 $f(\\mathbf{K})$：\n$$\nf(\\mathbf{K}) = e^{i (\\mathbf{K} \\cdot \\boldsymbol{\\delta}_1)} + e^{i (\\mathbf{K} \\cdot \\boldsymbol{\\delta}_2)} + e^{i (\\mathbf{K} \\cdot \\boldsymbol{\\delta}_3)} = e^{i 2\\pi/3} + e^{i 0} + e^{-i 2\\pi/3}\n$$\n使用欧拉公式 $e^{i\\theta} = \\cos\\theta + i\\sin\\theta$：\n$$\nf(\\mathbf{K}) = \\left(\\cos\\frac{2\\pi}{3} + i\\sin\\frac{2\\pi}{3}\\right) + 1 + \\left(\\cos\\frac{-2\\pi}{3} + i\\sin\\frac{-2\\pi}{3}\\right)\n$$\n$$\nf(\\mathbf{K}) = \\left(-\\frac{1}{2} + i\\frac{\\sqrt{3}}{2}\\right) + 1 + \\left(-\\frac{1}{2} - i\\frac{\\sqrt{3}}{2}\\right) = \\left(-\\frac{1}{2} + 1 - \\frac{1}{2}\\right) + i\\left(\\frac{\\sqrt{3}}{2} - \\frac{\\sqrt{3}}{2}\\right) = 0\n$$\n结构因子 $f(\\mathbf{K}) = 0$ 的消失是石墨烯中狄拉克点的定义性特征。将此结果代入带隙的通用公式：\n$$\n\\Delta_{\\mathbf{K}} = \\sqrt{(E_A - E_B)^2 + 4t^2 |f(\\mathbf{K})|^2} = \\sqrt{(E_A - E_B)^2 + 4t^2|0|^2} = \\sqrt{(E_A - E_B)^2}\n$$\n$$\n\\Delta_{\\mathbf{K}} = |E_A - E_B|\n$$\n这表明，狄拉克点处的带隙恰好是两个子晶格在位能之差的绝对值。带隙与跃迁参数 $t$ 无关。如果子晶格对称性得到保持（$E_A = E_B$），则带隙为零，正如对本征石墨烯的预期。\n\n现在我们将这个简单的公式应用于给定的参数集，其中所有能量都以 eV 为单位。\n\n1.  $(t=2.7, E_A=0.0, E_B=0.0)$: $\\Delta_{\\mathbf{K}} = |0.0 - 0.0| = 0.0$ eV.\n2.  $(t=2.7, E_A=0.1, E_B=-0.1)$: $\\Delta_{\\mathbf{K}} = |0.1 - (-0.1)| = 0.2$ eV.\n3.  $(t=1.0, E_A=0.25, E_B=0.0)$: $\\Delta_{\\mathbf{K}} = |0.25 - 0.0| = 0.25$ eV.\n4.  $(t=0.0, E_A=0.3, E_B=-0.3)$: $\\Delta_{\\mathbf{K}} = |0.3 - (-0.3)| = 0.6$ eV.\n5.  $(t=3.0, E_A=0.4, E_B=0.4)$: $\\Delta_{\\mathbf{K}} = |0.4 - 0.4| = 0.0$ eV.\n\n以下程序将实现完整的计算，作为此推导的数值验证，并生成最终结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the tight-binding band gap of graphene at the Dirac point K\n    for several sets of parameters.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple (t, E_A, E_B) in electronvolts (eV).\n    test_cases = [\n        (2.7, 0.0, 0.0),\n        (2.7, 0.1, -0.1),\n        (1.0, 0.25, 0.0),\n        (0.0, 0.3, -0.3),\n        (3.0, 0.4, 0.4),\n    ]\n\n    results = []\n\n    # Define lattice vectors as per the problem statement.\n    # The nearest-neighbor distance is set to 1 (dimensionless).\n    # Primitive Bravais lattice vectors.\n    a1 = np.array([np.sqrt(3), 0.0])\n    a2 = np.array([np.sqrt(3) / 2.0, 3.0 / 2.0])\n\n    # Nearest-neighbor vectors from sublattice A to B.\n    delta1 = np.array([0.0, 1.0])\n    delta2 = np.array([np.sqrt(3) / 2.0, -1.0 / 2.0])\n    delta3 = np.array([-np.sqrt(3) / 2.0, -1.0 / 2.0])\n    deltas = [delta1, delta2, delta3]\n\n    # Calculate reciprocal lattice vectors b1, b2 from a1, a2.\n    # The relation is a_i . b_j = 2*pi*delta_ij.\n    # For 2D, b1 = 2*pi/A * (a2y, -a2x) and b2 = 2*pi/A * (-a1y, a1x),\n    # where A = a1x*a2y - a1y*a2x is the unit cell area.\n    unit_cell_area = a1[0] * a2[1] - a1[1] * a2[0]\n    b1 = (2 * np.pi / unit_cell_area) * np.array([a2[1], -a2[0]])\n    b2 = (2 * np.pi / unit_cell_area) * np.array([-a1[1], a1[0]])\n\n    # Define the Dirac point K in the Brillouin zone.\n    K_point = (1.0 / 3.0) * (b1 + 2.0 * b2)\n\n    for case in test_cases:\n        t, E_A, E_B = case\n\n        # Although the analytical result is simply |E_A - E_B|, we perform the full\n        # numerical calculation to rigorously implement the model as requested.\n        \n        # 1. Calculate the structure factor f(k) at k = K.\n        # f(K) = sum_{j=1 to 3} exp(i * K . delta_j)\n        f_K = np.sum([np.exp(1j * np.dot(K_point, d)) for d in deltas])\n        \n        # Due to the properties of the graphene lattice, f(K) should be zero.\n        # Numerically, it will be a complex number very close to zero.\n\n        # 2. Construct the 2x2 Bloch Hamiltonian H(K).\n        H_K = np.array([\n            [E_A, -t * f_K],\n            [-t * np.conj(f_K), E_B]\n        ], dtype=complex)\n\n        # 3. Calculate the eigenvalues of the Hermitian matrix H(K).\n        # np.linalg.eigvalsh is used for Hermitian matrices and returns sorted real eigenvalues.\n        eigenvalues = np.linalg.eigvalsh(H_K)\n        \n        # 4. The band gap is the difference between the two eigenvalues.\n        E_minus, E_plus = eigenvalues[0], eigenvalues[1]\n        band_gap = E_plus - E_minus\n        \n        results.append(band_gap)\n\n    # Final print statement in the exact required format.\n    # Each result is formatted to 6 decimal places.\n    print(f\"[{','.join([f'{r:.6f}' for r in results])}]\")\n\nsolve()\n```"
        }
    ]
}