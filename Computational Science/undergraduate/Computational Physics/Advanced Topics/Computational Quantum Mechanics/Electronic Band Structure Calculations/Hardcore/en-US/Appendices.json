{
    "hands_on_practices": [
        {
            "introduction": "The journey into electronic band structure begins not with energy, but with geometry. To describe waves, such as the quantum mechanical wavefunction of an electron, within a periodic crystal lattice, we must work in reciprocal space, or $\\mathbf{k}$-space. This exercise  is a fundamental first step, guiding you through the process of constructing the reciprocal lattice vectors from the real-space vectors of a crystal, a crucial transformation for any band structure calculation.",
            "id": "1774232",
            "problem": "A solid-state physicist is developing a computational model to investigate the electronic band structure of graphene, a two-dimensional material composed of carbon atoms arranged in a hexagonal lattice. A crucial first step is to establish the geometry of the reciprocal lattice, as calculations involving electron wavefunctions rely on analysis in k-space (momentum space).\n\nThe physicist defines a Cartesian coordinate system $(\\hat{i}, \\hat{j})$ and describes the real-space Bravais lattice using the following primitive vectors, where $a$ is the constant carbon-carbon bond length:\n$$\n\\vec{a}_1 = \\frac{a}{2}(3\\hat{i} + \\sqrt{3}\\hat{j})\n$$\n$$\n\\vec{a}_2 = \\frac{a}{2}(3\\hat{i} - \\sqrt{3}\\hat{j})\n$$\nThe primitive reciprocal lattice vectors, denoted $\\vec{b}_1$ and $\\vec{b}_2$, are defined by the fundamental relationship $\\vec{a}_i \\cdot \\vec{b}_j = 2\\pi \\delta_{ij}$, where $i, j \\in \\{1, 2\\}$ and $\\delta_{ij}$ is the Kronecker delta.\n\nYour task is to determine the Cartesian components of these primitive reciprocal lattice vectors. Represent the vectors as $\\vec{b}_1 = b_{1x}\\hat{i} + b_{1y}\\hat{j}$ and $\\vec{b}_2 = b_{2x}\\hat{i} + b_{2y}\\hat{j}$. Find the four components ($b_{1x}, b_{1y}, b_{2x}, b_{2y}$) as symbolic expressions in terms of the bond length $a$.",
            "solution": "The problem requires us to find the primitive reciprocal lattice vectors $\\vec{b}_1$ and $\\vec{b}_2$ corresponding to the given real-space primitive vectors $\\vec{a}_1$ and $\\vec{a}_2$. The relationship between them is given by $\\vec{a}_i \\cdot \\vec{b}_j = 2\\pi \\delta_{ij}$.\n\nLet's write the vectors in component form:\n$\\vec{a}_1 = \\left( \\frac{3a}{2}, \\frac{\\sqrt{3}a}{2} \\right)$\n$\\vec{a}_2 = \\left( \\frac{3a}{2}, -\\frac{\\sqrt{3}a}{2} \\right)$\nAnd the unknown reciprocal vectors:\n$\\vec{b}_1 = (b_{1x}, b_{1y})$\n$\\vec{b}_2 = (b_{2x}, b_{2y})$\n\nThe defining relationship gives us a system of four equations:\n1. $\\vec{a}_1 \\cdot \\vec{b}_1 = 2\\pi$\n2. $\\vec{a}_1 \\cdot \\vec{b}_2 = 0$\n3. $\\vec{a}_2 \\cdot \\vec{b}_1 = 0$\n4. $\\vec{a}_2 \\cdot \\vec{b}_2 = 2\\pi$\n\nFirst, we solve for the components of $\\vec{b}_1$ using equations (1) and (3).\nEquation (3) is $\\vec{a}_2 \\cdot \\vec{b}_1 = 0$:\n$$\n\\left( \\frac{3a}{2} \\right) b_{1x} + \\left( -\\frac{\\sqrt{3}a}{2} \\right) b_{1y} = 0\n$$\n$$\n\\frac{3a}{2} b_{1x} = \\frac{\\sqrt{3}a}{2} b_{1y}\n$$\n$$\n3 b_{1x} = \\sqrt{3} b_{1y} \\implies b_{1y} = \\sqrt{3} b_{1x}\n$$\nNow we use this result in Equation (1), $\\vec{a}_1 \\cdot \\vec{b}_1 = 2\\pi$:\n$$\n\\left( \\frac{3a}{2} \\right) b_{1x} + \\left( \\frac{\\sqrt{3}a}{2} \\right) b_{1y} = 2\\pi\n$$\nSubstitute $b_{1y} = \\sqrt{3} b_{1x}$:\n$$\n\\frac{3a}{2} b_{1x} + \\frac{\\sqrt{3}a}{2} (\\sqrt{3} b_{1x}) = 2\\pi\n$$\n$$\n\\frac{3a}{2} b_{1x} + \\frac{3a}{2} b_{1x} = 2\\pi\n$$\n$$\n3a b_{1x} = 2\\pi \\implies b_{1x} = \\frac{2\\pi}{3a}\n$$\nNow find $b_{1y}$:\n$$\nb_{1y} = \\sqrt{3} b_{1x} = \\sqrt{3} \\left( \\frac{2\\pi}{3a} \\right) = \\frac{2\\sqrt{3}\\pi}{3a}\n$$\nSo, the first reciprocal lattice vector is $\\vec{b}_1 = \\frac{2\\pi}{3a} \\hat{i} + \\frac{2\\sqrt{3}\\pi}{3a} \\hat{j}$.\n\nNext, we solve for the components of $\\vec{b}_2$ using equations (2) and (4).\nEquation (2) is $\\vec{a}_1 \\cdot \\vec{b}_2 = 0$:\n$$\n\\left( \\frac{3a}{2} \\right) b_{2x} + \\left( \\frac{\\sqrt{3}a}{2} \\right) b_{2y} = 0\n$$\n$$\n\\frac{3a}{2} b_{2x} = -\\frac{\\sqrt{3}a}{2} b_{2y}\n$$\n$$\n3 b_{2x} = -\\sqrt{3} b_{2y} \\implies b_{2y} = -\\sqrt{3} b_{2x}\n$$\nNow we use this result in Equation (4), $\\vec{a}_2 \\cdot \\vec{b}_2 = 2\\pi$:\n$$\n\\left( \\frac{3a}{2} \\right) b_{2x} + \\left( -\\frac{\\sqrt{3}a}{2} \\right) b_{2y} = 2\\pi\n$$\nSubstitute $b_{2y} = -\\sqrt{3} b_{2x}$:\n$$\n\\frac{3a}{2} b_{2x} - \\frac{\\sqrt{3}a}{2} (-\\sqrt{3} b_{2x}) = 2\\pi\n$$\n$$\n\\frac{3a}{2} b_{2x} + \\frac{3a}{2} b_{2x} = 2\\pi\n$$\n$$\n3a b_{2x} = 2\\pi \\implies b_{2x} = \\frac{2\\pi}{3a}\n$$\nNow find $b_{2y}$:\n$$\nb_{2y} = -\\sqrt{3} b_{2x} = -\\sqrt{3} \\left( \\frac{2\\pi}{3a} \\right) = -\\frac{2\\sqrt{3}\\pi}{3a}\n$$\nSo, the second reciprocal lattice vector is $\\vec{b}_2 = \\frac{2\\pi}{3a} \\hat{i} - \\frac{2\\sqrt{3}\\pi}{3a} \\hat{j}$.\n\nThe four components are:\n$b_{1x} = \\frac{2\\pi}{3a}$\n$b_{1y} = \\frac{2\\sqrt{3}\\pi}{3a}$\n$b_{2x} = \\frac{2\\pi}{3a}$\n$b_{2y} = -\\frac{2\\sqrt{3}\\pi}{3a}$",
            "answer": "$$\\boxed{\\begin{pmatrix} \\frac{2\\pi}{3a}  \\frac{2\\sqrt{3}\\pi}{3a}  \\frac{2\\pi}{3a}  -\\frac{2\\sqrt{3}\\pi}{3a} \\end{pmatrix}}$$"
        },
        {
            "introduction": "With the reciprocal space framework established, we can construct a model for the electron energies, $E(\\mathbf{k})$. This practice  introduces the nearest-neighbor tight-binding model, an intuitive yet powerful method for understanding the electronic structure of materials like graphene. You will see firsthand how breaking the crystal's inherent sublattice symmetry provides a direct mechanism for opening a band gap at the Dirac points, a key strategy in engineering new electronic devices.",
            "id": "2387847",
            "problem": "You are asked to implement a nearest-neighbor tight-binding (TB) model for graphene and to quantify how breaking the sublattice symmetry by unequal on-site energies opens a band gap at the Dirac points. Use a two-atom basis on a two-dimensional honeycomb lattice with a triangular Bravais lattice. Let the nearest-neighbor distance be set to the dimensionless value $1$ to define length units. Work in reciprocal space such that the phase $e^{i \\mathbf{k} \\cdot \\boldsymbol{\\delta}_j}$ uses angles in radians. All energies must be expressed in electronvolts (eV).\n\nThe honeycomb lattice is constructed from the triangular Bravais lattice with primitive vectors\n$$\n\\mathbf{a}_1 = (\\sqrt{3}, \\, 0), \\quad \\mathbf{a}_2 = \\left(\\frac{\\sqrt{3}}{2}, \\, \\frac{3}{2}\\right).\n$$\nThe three nearest-neighbor vectors connecting sublattice $A$ to sublattice $B$ are\n$$\n\\boldsymbol{\\delta}_1 = (0, \\, 1), \\quad \\boldsymbol{\\delta}_2 = \\left(\\frac{\\sqrt{3}}{2}, \\, -\\frac{1}{2}\\right), \\quad \\boldsymbol{\\delta}_3 = \\left(-\\frac{\\sqrt{3}}{2}, \\, -\\frac{1}{2}\\right).\n$$\nLet $\\mathbf{b}_1$ and $\\mathbf{b}_2$ be the reciprocal lattice vectors defined by $\\mathbf{a}_i \\cdot \\mathbf{b}_j = 2\\pi \\delta_{ij}$. Define the Dirac point\n$$\n\\mathbf{K} = \\frac{1}{3}\\left(\\mathbf{b}_1 + 2 \\mathbf{b}_2\\right).\n$$\n\nIn the nearest-neighbor tight-binding Hamiltonian, with on-site energies $E_A$ and $E_B$ on sublattices $A$ and $B$, and nearest-neighbor hopping energy $t$, the Bloch Hamiltonian for wave vector $\\mathbf{k}$ is the $2\\times 2$ Hermitian matrix\n$$\nH(\\mathbf{k}) = \\begin{pmatrix}\nE_A  -t \\, f(\\mathbf{k}) \\\\\n-t \\, f^*(\\mathbf{k})  E_B\n\\end{pmatrix},\n$$\nwhere\n$$\nf(\\mathbf{k}) = \\sum_{j=1}^{3} e^{i \\mathbf{k}\\cdot \\boldsymbol{\\delta}_j}.\n$$\n\nFor each parameter set, compute the two energy bands as the eigenvalues $E_{-}(\\mathbf{k}) \\le E_{+}(\\mathbf{k})$ of $H(\\mathbf{k})$ and evaluate the direct band gap at the Dirac point $\\mathbf{K}$,\n$$\n\\Delta_{\\mathbf{K}} = E_{+}(\\mathbf{K}) - E_{-}(\\mathbf{K}),\n$$\nexpressed in electronvolts (eV). The angle unit for $\\mathbf{k}\\cdot\\boldsymbol{\\delta}_j$ must be radians. Your program must output the values of $\\Delta_{\\mathbf{K}}$ for the following test suite of parameter sets $(t, E_A, E_B)$, with all quantities in electronvolts:\n- $(2.7, \\, 0.0, \\, 0.0)$,\n- $(2.7, \\, 0.1, \\, -0.1)$,\n- $(1.0, \\, 0.25, \\, 0.0)$,\n- $(0.0, \\, 0.3, \\, -0.3)$,\n- $(3.0, \\, 0.4, \\, 0.4)$.\n\nFinal output format: Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, with each gap value rounded to $6$ decimal places in eV. For example, the format must be\n$$\n[\\Delta_{\\mathbf{K}}^{(1)},\\Delta_{\\mathbf{K}}^{(2)},\\ldots,\\Delta_{\\mathbf{K}}^{(5)}]\n$$\nwith each $\\Delta_{\\mathbf{K}}^{(i)}$ shown with exactly $6$ digits after the decimal point.",
            "solution": "The problem statement has been validated and is found to be scientifically sound, well-posed, and self-contained. It presents a standard problem in computational solid-state physics. We will proceed with a complete solution.\n\nThe objective is to compute the direct band gap $\\Delta_{\\mathbf{K}}$ at the Dirac point $\\mathbf{K}$ for a graphene-like honeycomb lattice described by a nearest-neighbor tight-binding model. The band gap is defined as the difference between the two energy eigenvalues of the Bloch Hamiltonian $H(\\mathbf{k})$ evaluated at $\\mathbf{k}=\\mathbf{K}$.\n\nThe provided Bloch Hamiltonian is a $2\\times 2$ matrix:\n$$\nH(\\mathbf{k}) = \\begin{pmatrix}\nE_A  -t \\, f(\\mathbf{k}) \\\\\n-t \\, f^*(\\mathbf{k})  E_B\n\\end{pmatrix}\n$$\nwhere $E_A$ and $E_B$ are the on-site energies for the two sublattices, $t$ is the nearest-neighbor hopping energy, and $f(\\mathbf{k}) = \\sum_{j=1}^{3} e^{i \\mathbf{k}\\cdot \\boldsymbol{\\delta}_j}$ is the geometric structure factor involving the three nearest-neighbor vectors $\\boldsymbol{\\delta}_j$.\n\nThe energy eigenvalues $E(\\mathbf{k})$ are found by solving the characteristic equation $\\det(H(\\mathbf{k}) - E I) = 0$:\n$$\n(E_A - E)(E_B - E) - |-t f(\\mathbf{k})|^2 = 0\n$$\n$$\nE^2 - (E_A + E_B)E + E_A E_B - t^2|f(\\mathbf{k})|^2 = 0\n$$\nThe solutions for the energy bands, $E_{\\pm}(\\mathbf{k})$, are given by the quadratic formula:\n$$\nE_{\\pm}(\\mathbf{k}) = \\frac{E_A + E_B}{2} \\pm \\sqrt{\\left(\\frac{E_A - E_B}{2}\\right)^2 + t^2 |f(\\mathbf{k})|^2}\n$$\nThe direct band gap at a wave vector $\\mathbf{k}$ is the difference between these two energy bands:\n$$\n\\Delta_{\\mathbf{k}} = E_{+}(\\mathbf{k}) - E_{-}(\\mathbf{k}) = 2\\sqrt{\\left(\\frac{E_A - E_B}{2}\\right)^2 + t^2 |f(\\mathbf{k})|^2} = \\sqrt{(E_A - E_B)^2 + 4t^2 |f(\\mathbf{k})|^2}\n$$\nTo evaluate the gap at the Dirac point $\\mathbf{K}$, we must first determine the coordinates of $\\mathbf{K}$. The problem defines $\\mathbf{K} = \\frac{1}{3}(\\mathbf{b}_1 + 2 \\mathbf{b}_2)$, where $\\mathbf{b}_1$ and $\\mathbf{b}_2$ are the reciprocal lattice vectors corresponding to the primitive lattice vectors $\\mathbf{a}_1 = (\\sqrt{3}, 0)$ and $\\mathbf{a}_2 = (\\frac{\\sqrt{3}}{2}, \\frac{3}{2})$. The reciprocal vectors are defined by the relation $\\mathbf{a}_i \\cdot \\mathbf{b}_j = 2\\pi \\delta_{ij}$.\n\nThe area of the real-space unit cell is $A = |\\mathbf{a}_1 \\times \\mathbf{a}_2| = \\sqrt{3} \\cdot \\frac{3}{2} - 0 \\cdot \\frac{\\sqrt{3}}{2} = \\frac{3\\sqrt{3}}{2}$. The reciprocal vectors are then calculated as:\n$$\n\\mathbf{b}_1 = \\frac{2\\pi}{A} (a_{2y}, -a_{2x}) = \\frac{2\\pi}{3\\sqrt{3}/2} \\left(\\frac{3}{2}, -\\frac{\\sqrt{3}}{2}\\right) = \\left(\\frac{2\\pi}{\\sqrt{3}}, -\\frac{2\\pi}{3}\\right)\n$$\n$$\n\\mathbf{b}_2 = \\frac{2\\pi}{A} (-a_{1y}, a_{1x}) = \\frac{2\\pi}{3\\sqrt{3}/2} (0, \\sqrt{3}) = \\left(0, \\frac{4\\pi}{3}\\right)\n$$\nUsing these, we find the coordinates of the Dirac point $\\mathbf{K}$:\n$$\n\\mathbf{K} = \\frac{1}{3}(\\mathbf{b}_1 + 2\\mathbf{b}_2) = \\frac{1}{3}\\left[\\left(\\frac{2\\pi}{\\sqrt{3}}, -\\frac{2\\pi}{3}\\right) + 2\\left(0, \\frac{4\\pi}{3}\\right)\\right] = \\frac{1}{3}\\left(\\frac{2\\pi}{\\sqrt{3}}, \\frac{6\\pi}{3}\\right) = \\left(\\frac{2\\pi}{3\\sqrt{3}}, \\frac{2\\pi}{3}\\right)\n$$\nThe next step is to evaluate the structure factor $f(\\mathbf{K})$. This requires computing the dot products $\\mathbf{K} \\cdot \\boldsymbol{\\delta}_j$ with the given nearest-neighbor vectors $\\boldsymbol{\\delta}_1 = (0, 1)$, $\\boldsymbol{\\delta}_2 = (\\frac{\\sqrt{3}}{2}, -\\frac{1}{2})$, and $\\boldsymbol{\\delta}_3 = (-\\frac{\\sqrt{3}}{2}, -\\frac{1}{2})$:\n$$\n\\mathbf{K} \\cdot \\boldsymbol{\\delta}_1 = \\left(\\frac{2\\pi}{3\\sqrt{3}}, \\frac{2\\pi}{3}\\right) \\cdot (0, 1) = \\frac{2\\pi}{3}\n$$\n$$\n\\mathbf{K} \\cdot \\boldsymbol{\\delta}_2 = \\left(\\frac{2\\pi}{3\\sqrt{3}}, \\frac{2\\pi}{3}\\right) \\cdot \\left(\\frac{\\sqrt{3}}{2}, -\\frac{1}{2}\\right) = \\frac{2\\pi}{3\\sqrt{3}}\\frac{\\sqrt{3}}{2} - \\frac{2\\pi}{3}\\frac{1}{2} = \\frac{\\pi}{3} - \\frac{\\pi}{3} = 0\n$$\n$$\n\\mathbf{K} \\cdot \\boldsymbol{\\delta}_3 = \\left(\\frac{2\\pi}{3\\sqrt{3}}, \\frac{2\\pi}{3}\\right) \\cdot \\left(-\\frac{\\sqrt{3}}{2}, -\\frac{1}{2}\\right) = -\\frac{2\\pi}{3\\sqrt{3}}\\frac{\\sqrt{3}}{2} - \\frac{2\\pi}{3}\\frac{1}{2} = -\\frac{\\pi}{3} - \\frac{\\pi}{3} = -\\frac{2\\pi}{3}\n$$\nNow, we compute $f(\\mathbf{K})$:\n$$\nf(\\mathbf{K}) = e^{i (\\mathbf{K} \\cdot \\boldsymbol{\\delta}_1)} + e^{i (\\mathbf{K} \\cdot \\boldsymbol{\\delta}_2)} + e^{i (\\mathbf{K} \\cdot \\boldsymbol{\\delta}_3)} = e^{i 2\\pi/3} + e^{i 0} + e^{-i 2\\pi/3}\n$$\nUsing Euler's formula, $e^{i\\theta} = \\cos\\theta + i\\sin\\theta$:\n$$\nf(\\mathbf{K}) = \\left(\\cos\\frac{2\\pi}{3} + i\\sin\\frac{2\\pi}{3}\\right) + 1 + \\left(\\cos\\frac{-2\\pi}{3} + i\\sin\\frac{-2\\pi}{3}\\right)\n$$\n$$\nf(\\mathbf{K}) = \\left(-\\frac{1}{2} + i\\frac{\\sqrt{3}}{2}\\right) + 1 + \\left(-\\frac{1}{2} - i\\frac{\\sqrt{3}}{2}\\right) = \\left(-\\frac{1}{2} + 1 - \\frac{1}{2}\\right) + i\\left(\\frac{\\sqrt{3}}{2} - \\frac{\\sqrt{3}}{2}\\right) = 0\n$$\nThe vanishing of the structure factor, $f(\\mathbf{K}) = 0$, is the defining feature of the Dirac points in graphene. Substituting this result into the general formula for the band gap:\n$$\n\\Delta_{\\mathbf{K}} = \\sqrt{(E_A - E_B)^2 + 4t^2 |f(\\mathbf{K})|^2} = \\sqrt{(E_A - E_B)^2 + 4t^2|0|^2} = \\sqrt{(E_A - E_B)^2}\n$$\n$$\n\\Delta_{\\mathbf{K}} = |E_A - E_B|\n$$\nThis demonstrates that the band gap at the Dirac point is precisely the magnitude of the difference between the on-site energies of the two sublattices. The gap is independent of the hopping parameter $t$. If the sublattice symmetry is preserved ($E_A = E_B$), the gap is zero, as expected for pristine graphene.\n\nWe now apply this simple formula to the given parameter sets, where all energies are in units of eV.\n\n1.  $(t=2.7, E_A=0.0, E_B=0.0)$: $\\Delta_{\\mathbf{K}} = |0.0 - 0.0| = 0.0$ eV.\n2.  $(t=2.7, E_A=0.1, E_B=-0.1)$: $\\Delta_{\\mathbf{K}} = |0.1 - (-0.1)| = 0.2$ eV.\n3.  $(t=1.0, E_A=0.25, E_B=0.0)$: $\\Delta_{\\mathbf{K}} = |0.25 - 0.0| = 0.25$ eV.\n4.  $(t=0.0, E_A=0.3, E_B=-0.3)$: $\\Delta_{\\mathbf{K}} = |0.3 - (-0.3)| = 0.6$ eV.\n5.  $(t=3.0, E_A=0.4, E_B=0.4)$: $\\Delta_{\\mathbf{K}} = |0.4 - 0.4| = 0.0$ eV.\n\nThe following program will implement the full calculation as a numerical verification of this derivation and produce the final results.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the tight-binding band gap of graphene at the Dirac point K\n    for several sets of parameters.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple (t, E_A, E_B) in electronvolts (eV).\n    test_cases = [\n        (2.7, 0.0, 0.0),\n        (2.7, 0.1, -0.1),\n        (1.0, 0.25, 0.0),\n        (0.0, 0.3, -0.3),\n        (3.0, 0.4, 0.4),\n    ]\n\n    results = []\n\n    # Define lattice vectors as per the problem statement.\n    # The nearest-neighbor distance is set to 1 (dimensionless).\n    # Primitive Bravais lattice vectors.\n    a1 = np.array([np.sqrt(3), 0.0])\n    a2 = np.array([np.sqrt(3) / 2.0, 3.0 / 2.0])\n\n    # Nearest-neighbor vectors from sublattice A to B.\n    delta1 = np.array([0.0, 1.0])\n    delta2 = np.array([np.sqrt(3) / 2.0, -1.0 / 2.0])\n    delta3 = np.array([-np.sqrt(3) / 2.0, -1.0 / 2.0])\n    deltas = [delta1, delta2, delta3]\n\n    # Calculate reciprocal lattice vectors b1, b2 from a1, a2.\n    # The relation is a_i . b_j = 2*pi*delta_ij.\n    # For 2D, b1 = 2*pi/A * (a2y, -a2x) and b2 = 2*pi/A * (-a1y, a1x),\n    # where A = a1x*a2y - a1y*a2x is the unit cell area.\n    unit_cell_area = a1[0] * a2[1] - a1[1] * a2[0]\n    b1 = (2 * np.pi / unit_cell_area) * np.array([a2[1], -a2[0]])\n    b2 = (2 * np.pi / unit_cell_area) * np.array([-a1[1], a1[0]])\n\n    # Define the Dirac point K in the Brillouin zone.\n    K_point = (1.0 / 3.0) * (b1 + 2.0 * b2)\n\n    for case in test_cases:\n        t, E_A, E_B = case\n\n        # Although the analytical result is simply |E_A - E_B|, we perform the full\n        # numerical calculation to rigorously implement the model as requested.\n        \n        # 1. Calculate the structure factor f(k) at k = K.\n        # f(K) = sum_{j=1 to 3} exp(i * K . delta_j)\n        f_K = np.sum([np.exp(1j * np.dot(K_point, d)) for d in deltas])\n        \n        # Due to the properties of the graphene lattice, f(K) should be zero.\n        # Numerically, it will be a complex number very close to zero.\n\n        # 2. Construct the 2x2 Bloch Hamiltonian H(K).\n        H_K = np.array([\n            [E_A, -t * f_K],\n            [-t * np.conj(f_K), E_B]\n        ], dtype=complex)\n\n        # 3. Calculate the eigenvalues of the Hermitian matrix H(K).\n        # np.linalg.eigvalsh is used for Hermitian matrices and returns sorted real eigenvalues.\n        eigenvalues = np.linalg.eigvalsh(H_K)\n        \n        # 4. The band gap is the difference between the two eigenvalues.\n        E_minus, E_plus = eigenvalues[0], eigenvalues[1]\n        band_gap = E_plus - E_minus\n        \n        results.append(band_gap)\n\n    # Final print statement in the exact required format.\n    # Each result is formatted to 6 decimal places.\n    print(f\"[{','.join([f'{r:.6f}' for r in results])}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "A calculated band structure is far more than a static plot; it is a dynamic map governing electron behavior. This exercise  bridges the gap between the quantum energy landscape $E(\\mathbf{k})$ and the real-space motion of an electron using the semiclassical equations of motion. By tracing an electron's trajectory under external electric and magnetic fields, you will explore how the shape of the energy bands dictates the particle's response to forces, a core principle behind all electronic transport phenomena.",
            "id": "2387828",
            "problem": "Consider an electron constrained to a two-dimensional ($2$D) crystalline band characterized near the band minimum by the effective-mass energy surface\n$$\nE(k_x,k_y)=\\frac{\\hbar^2}{2}\\left(\\frac{k_x^2}{m_x}+\\frac{k_y^2}{m_y}\\right),\n$$\nwhere $\\hbar$ is the reduced Planck constant, $m_x$ and $m_y$ are constant effective masses along the $k_x$ and $k_y$ directions, and $(k_x,k_y)$ are the crystal wavevectors. In the absence of Berry curvature effects, the semiclassical dynamics of a Bloch electron with charge $-e$ (with $e0$ the elementary charge) under uniform and time-independent electric field $\\mathbf{E}$ and magnetic field $\\mathbf{B}$ are governed by\n$$\n\\hbar\\,\\frac{d\\mathbf{k}}{dt}=-e\\left(\\mathbf{E}+\\mathbf{v}(\\mathbf{k})\\times\\mathbf{B}\\right),\\qquad \\frac{d\\mathbf{r}}{dt}=\\mathbf{v}(\\mathbf{k}), \n$$\nwith band velocity\n$$\n\\mathbf{v}(\\mathbf{k})=\\frac{1}{\\hbar}\\nabla_{\\mathbf{k}}E(\\mathbf{k})=\\left(\\frac{\\hbar k_x}{m_x},\\,\\frac{\\hbar k_y}{m_y},\\,0\\right).\n$$\nAssume motion confined to the $x$-$y$ plane, $\\mathbf{r}(t)=(x(t),y(t),0)$, and a magnetic field perpendicular to the plane, $\\mathbf{B}=(0,0,B_z)$, so that $\\mathbf{v}(\\mathbf{k})\\times\\mathbf{B}=\\left(v_y B_z,\\,-v_x B_z,\\,0\\right)$. Take all quantities in the International System of Units (SI). Use the constants $\\hbar = 1.054571817 \\times 10^{-34} \\, \\mathrm{J \\cdot s}$, $e = 1.602176634 \\times 10^{-19} \\, \\mathrm{C}$, and electron rest mass $m_{\\mathrm{e}} = 9.1093837015 \\times 10^{-31} \\, \\mathrm{kg}$.\n\nStarting from these first-principles definitions, compute the electron trajectory $\\mathbf{r}(t)$ and crystal wavevector $\\mathbf{k}(t)$ for the following test suite of three cases. In every case, take the initial conditions $\\mathbf{r}(0)=(0,0,0)$ and $\\mathbf{k}(0)=(k_{x0},k_{y0},0)$, and use $m_x=m_y=m_{\\mathrm{e}}$.\n\nTest case $\\mathrm{A}$ (happy path): \n- Fields: $\\mathbf{E}=(\\,1.0\\times 10^{5},\\,0,\\,0\\,)$ $\\mathrm{V/m}$, $\\mathbf{B}=(\\,0,\\,0,\\,0\\,)$ $\\mathrm{T}$.\n- Initial wavevector: $(k_{x0},k_{y0})=(\\,0,\\,0\\,)$ $\\mathrm{m^{-1}}$.\n- Final time: $T=\\,$$1.0\\times 10^{-12}$ $\\mathrm{s}$.\n\nTest case $\\mathrm{B}$ (magnetic-only boundary): \n- Fields: $\\mathbf{E}=(\\,0,\\,0,\\,0\\,)$ $\\mathrm{V/m}$, $\\mathbf{B}=(\\,0,\\,0,\\,1.0\\,)$ $\\mathrm{T}$.\n- Initial wavevector: $(k_{x0},k_{y0})=(\\,1.0\\times 10^{9},\\,0\\,)$ $\\mathrm{m^{-1}}$.\n- Final time: one cyclotron period $T=\\,$$2\\pi\\,m_{\\mathrm{e}}/(e\\,|B_z|)$ $\\mathrm{s}$.\n\nTest case $\\mathrm{C}$ (crossed fields with drift):\n- Fields: $\\mathbf{E}=(\\,1.0\\times 10^{5},\\,0,\\,0\\,)$ $\\mathrm{V/m}$, $\\mathbf{B}=(\\,0,\\,0,\\,2.0\\,)$ $\\mathrm{T}$.\n- Initial wavevector: $(k_{x0},k_{y0})=(\\,1.0\\times 10^{9},\\,0\\,)$ $\\mathrm{m^{-1}}$.\n- Final time: five cyclotron periods $T=\\,$$5\\times 2\\pi\\,m_{\\mathrm{e}}/(e\\,|B_z|)$ $\\mathrm{s}$.\n\nRequired outputs and units:\n- For each test case, compute the Euclidean norm of the real-space displacement $||\\mathbf{r}(T)-\\mathbf{r}(0)||=\\sqrt{x(T)^2+y(T)^2}$, expressed in meters. Each answer must be a float in scientific notation with exactly $6$ significant digits.\n- Your program should produce a single line of output containing the results for the three test cases as a comma-separated list enclosed in square brackets, in the order $\\mathrm{A}$, $\\mathrm{B}$, $\\mathrm{C}$ (for example, $[\\text{result}_{\\mathrm{A}},\\text{result}_{\\mathrm{B}},\\text{result}_{\\mathrm{C}}]$).",
            "solution": "The problem presented is a standard exercise in computational solid-state physics, concerning the semiclassical dynamics of a Bloch electron. It is scientifically grounded, well-posed, and objective. All necessary parameters and initial conditions are provided, and there are no internal contradictions or ambiguities. Therefore, the problem is valid and a solution can be derived.\n\nThe analysis begins with the semiclassical equations of motion for an electron with charge $-e$ (where $e  0$ is the elementary charge) in a crystal, under the influence of an external electric field $\\mathbf{E}$ and magnetic field $\\mathbf{B}$:\n$$\n\\hbar\\,\\frac{d\\mathbf{k}}{dt}=-e\\left(\\mathbf{E}+\\mathbf{v}(\\mathbf{k})\\times\\mathbf{B}\\right)\n$$\n$$\n\\frac{d\\mathbf{r}}{dt}=\\mathbf{v}(\\mathbf{k})\n$$\nThe band structure is given by a simple parabolic dispersion relation, where we are instructed to use an isotropic effective mass $m_x=m_y=m_{\\mathrm{e}}=m$:\n$$\nE(\\mathbf{k})=\\frac{\\hbar^2 k^2}{2m}\n$$\nThe electron's group velocity is derived from the dispersion:\n$$\n\\mathbf{v}(\\mathbf{k})=\\frac{1}{\\hbar}\\nabla_{\\mathbf{k}}E(\\mathbf{k})=\\frac{\\hbar\\mathbf{k}}{m}\n$$\nSubstituting the velocity into the first equation of motion and considering a magnetic field $\\mathbf{B}=(0,0,B_z)$, we obtain the component-wise equations for the crystal wavevector $\\mathbf{k}=(k_x, k_y)$:\n$$\n\\hbar\\,\\frac{dk_x}{dt}=-e E_x -e B_z v_y = -e E_x - \\frac{e\\hbar B_z}{m} k_y\n$$\n$$\n\\hbar\\,\\frac{dk_y}{dt}=-e E_y +e B_z v_x = -e E_y + \\frac{e\\hbar B_z}{m} k_x\n$$\nDividing by $\\hbar$, we get a system of linear ordinary differential equations:\n$$\n\\frac{dk_x}{dt} = -\\frac{e E_x}{\\hbar} - \\omega_c k_y\n$$\n$$\n\\frac{dk_y}{dt} = -\\frac{e E_y}{\\hbar} + \\omega_c k_x\n$$\nwhere $\\omega_c = \\frac{eB_z}{m}$ is the cyclotron frequency. The solution depends on whether $B_z$ is zero or non-zero.\n\n**Case 1: No Magnetic Field ($B_z = 0$)**\n\nThis corresponds to Test Case A. With $B_z=0$, the equations for $\\mathbf{k}$ become uncoupled:\n$$\n\\frac{dk_x}{dt} = -\\frac{e E_x}{\\hbar} \\quad \\implies \\quad k_x(t) = k_{x0} - \\frac{e E_x}{\\hbar} t\n$$\n$$\n\\frac{dk_y}{dt} = -\\frac{e E_y}{\\hbar} \\quad \\implies \\quad k_y(t) = k_{y0} - \\frac{e E_y}{\\hbar} t\n$$\nwhere $\\mathbf{k}(0)=(k_{x0},k_{y0})$. The position vector $\\mathbf{r}(t)$ is found by integrating the velocity $\\mathbf{v}(t) = \\frac{\\hbar\\mathbf{k}(t)}{m}$ from the initial position $\\mathbf{r}(0)=\\mathbf{0}$:\n$$\nx(t) = \\int_0^t \\frac{\\hbar k_x(t')}{m} dt' = \\frac{\\hbar k_{x0}}{m}t - \\frac{e E_x}{2m}t^2\n$$\n$$\ny(t) = \\int_0^t \\frac{\\hbar k_y(t')}{m} dt' = \\frac{\\hbar k_{y0}}{m}t - \\frac{e E_y}{2m}t^2\n$$\nThis is the familiar trajectory of a particle with charge $-e$ and mass $m$ under a constant electric field.\n\n**Case 2: Non-Zero Magnetic Field ($B_z \\neq 0$)**\n\nThis corresponds to Test Cases B and C. The coupled ODEs for $\\mathbf{k}(t)$ describe a circular motion in k-space superimposed on a constant drift. The solution can be found by standard methods and is given by:\n$$\nk_x(t) = (k_{x0} - k_{dx}) \\cos(\\omega_c t) - (k_{y0} - k_{dy}) \\sin(\\omega_c t) + k_{dx}\n$$\n$$\nk_y(t) = (k_{x0} - k_{dx}) \\sin(\\omega_c t) + (k_{y0} - k_{dy}) \\cos(\\omega_c t) + k_{dy}\n$$\nHere, $\\mathbf{k}_d = (k_{dx}, k_{dy})$ is the center of the k-space orbit, defined by:\n$$\nk_{dx} = \\frac{m E_y}{\\hbar B_z}, \\quad k_{dy} = -\\frac{m E_x}{\\hbar B_z}\n$$\nIntegrating the velocity $\\mathbf{v}(t) = \\frac{\\hbar\\mathbf{k}(t)}{m}$ gives the real-space trajectory $\\mathbf{r}(t)$. The trajectory consists of two parts: a steady drift and a circular (cyclotron) orbit. The net displacement after an integer number of cyclotron periods, $T_n = n \\frac{2\\pi}{|\\omega_c|}$, is determined solely by the drift velocity $\\mathbf{v}_d = \\frac{\\hbar \\mathbf{k}_d}{m} = (\\frac{E_y}{B_z}, -\\frac{E_x}{B_z})$. The oscillatory part of the motion averages to zero over each full period. Therefore, for $t=T_n$:\n$$\n\\mathbf{r}(T_n) = \\mathbf{r}(0) + \\mathbf{v}_d T_n\n$$\n\nWe now apply these derived solutions to the three test cases.\n\n**Test Case A: Electric Field Only**\n- Fields: $\\mathbf{E}=(1.0\\times 10^{5}, 0, 0)\\,\\mathrm{V/m}$, $\\mathbf{B}=\\mathbf{0}\\,\\mathrm{T}$.\n- Initial wavevector: $(k_{x0}, k_{y0}) = (0, 0)\\,\\mathrm{m^{-1}}$.\n- Time: $T=1.0\\times 10^{-12}\\,\\mathrm{s}$.\nWe use the $B_z=0$ solution. With $k_{x0}=0$, $k_{y0}=0$, and $E_y=0$, the displacement is:\n$$\nx(T) = -\\frac{e E_x}{2m}T^2, \\quad y(T) = 0\n$$\nThe norm of the displacement is $|x(T)|$:\n$$\n||\\mathbf{r}(T)-\\mathbf{r}(0)|| = \\frac{e E_x T^2}{2m} = \\frac{(1.602176634\\times 10^{-19}\\,\\mathrm{C})(1.0\\times 10^{5}\\,\\mathrm{V/m})(1.0\\times 10^{-12}\\,\\mathrm{s})^2}{2(9.1093837015\\times 10^{-31}\\,\\mathrm{kg})} \\approx 8.79410\\times 10^{-9}\\,\\mathrm{m}\n$$\n\n**Test Case B: Magnetic Field Only**\n- Fields: $\\mathbf{E}=\\mathbf{0}\\,\\mathrm{V/m}$, $\\mathbf{B}=(0, 0, 1.0)\\,\\mathrm{T}$.\n- Initial wavevector: $(k_{x0}, k_{y0}) = (1.0\\times 10^{9}, 0)\\,\\mathrm{m^{-1}}$.\n- Time: $T = 2\\pi m/(e|B_z|)$.\nHere, $B_z = 1.0\\,\\mathrm{T}$. Since $\\mathbf{E}=\\mathbf{0}$, the drift velocity $\\mathbf{v}_d$ is zero. The motion is a pure cyclotron orbit. The final time $T$ is exactly one cyclotron period. Over one full period, the electron returns to its initial real-space position (relative to any drift, which is zero here).\n$$\n||\\mathbf{r}(T)-\\mathbf{r}(0)|| = 0\\,\\mathrm{m}\n$$\n\n**Test Case C: Crossed Electric and Magnetic Fields**\n- Fields: $\\mathbf{E}=(1.0\\times 10^{5}, 0, 0)\\,\\mathrm{V/m}$, $\\mathbf{B}=(0, 0, 2.0)\\,\\mathrm{T}$.\n- Initial wavevector: $(k_{x0}, k_{y0}) = (1.0\\times 10^{9}, 0)\\,\\mathrm{m^{-1}}$.\n- Time: $T = 5 \\times 2\\pi m/(e|B_z|)$.\nThe final time is exactly five cyclotron periods. The net displacement is therefore given by the drift displacement $\\mathbf{v}_d T$.\nThe drift velocity is:\n$$\n\\mathbf{v}_d = \\left(\\frac{E_y}{B_z}, -\\frac{E_x}{B_z}\\right) = \\left(\\frac{0}{2.0}, -\\frac{1.0\\times 10^{5}}{2.0}\\right) = (0, -5.0\\times 10^{4})\\,\\mathrm{m/s}\n$$\nThe displacement is $\\mathbf{r}(T) = \\mathbf{v}_d T$. The norm is:\n$$\n||\\mathbf{r}(T)-\\mathbf{r}(0)|| = ||\\mathbf{v}_d|| T = |v_{dy}| T = \\left(\\frac{E_x}{B_z}\\right) \\left(\\frac{10\\pi m}{e B_z}\\right) = \\frac{10\\pi m E_x}{e B_z^2}\n$$\n$$\n||\\mathbf{r}(T)-\\mathbf{r}(0)|| = \\frac{10\\pi (9.1093837015\\times 10^{-31}\\,\\mathrm{kg})(1.0\\times 10^{5}\\,\\mathrm{V/m})}{(1.602176634\\times 10^{-19}\\,\\mathrm{C})(2.0\\,\\mathrm{T})^2} \\approx 4.46540\\times 10^{-6}\\,\\mathrm{m}\n$$\nThese results are computed and formatted in the program below.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the electron trajectory displacement for three test cases\n    based on the semiclassical model of a Bloch electron.\n    \"\"\"\n    # Define physical constants in SI units.\n    hbar = 1.054571817e-34  # Reduced Planck constant (J*s)\n    e = 1.602176634e-19     # Elementary charge (C)\n    m_e = 9.1093837015e-31  # Electron rest mass (kg)\n\n    # --- Test Case A: Electric field only ---\n    E_A = np.array([1.0e5, 0.0])  # Electric field (V/m)\n    k0_A = np.array([0.0, 0.0])   # Initial wavevector (m^-1)\n    T_A = 1.0e-12                # Final time (s)\n    \n    # Using equation for pure electric field: r = v0*t - (e*E)/(2*m)*t^2\n    # Since k0 is zero, v0 is zero.\n    r_A_x = -(e * E_A[0] / (2 * m_e)) * T_A**2\n    r_A_y = -(e * E_A[1] / (2 * m_e)) * T_A**2\n    dist_A = np.sqrt(r_A_x**2 + r_A_y**2)\n\n    # --- Test Case B: Magnetic field only ---\n    B_B_z = 1.0  # Magnetic field (T)\n    \n    # The final time is one cyclotron period. In the absence of an electric field,\n    # the motion is a closed orbit. The net displacement after one period is zero.\n    dist_B = 0.0\n\n    # --- Test Case C: Crossed E and B fields ---\n    E_C = np.array([1.0e5, 0.0])  # Electric field (V/m)\n    B_C_z = 2.0                   # Magnetic field (T)\n    num_periods_C = 5             # Number of cyclotron periods\n    \n    # The final time is an integer number of cyclotron periods. The oscillatory part\n    # of the motion results in zero net displacement. The total displacement is\n    # due to the E x B drift velocity over the total time.\n    # T_C = num_periods_C * 2 * np.pi * m_e / (e * abs(B_C_z))\n    # v_drift_y = -E_C[0] / B_C_z\n    # dist_C = abs(v_drift_y * T_C)\n    # This simplifies to the following expression to avoid intermediate calculations:\n    dist_C = (num_periods_C * 2 * np.pi * m_e * E_C[0]) / (e * B_C_z**2)\n\n    # Compile results and format them to 6 significant digits in scientific notation.\n    results = [\n        f\"{dist_A:.5e}\",\n        f\"{dist_B:.5e}\",\n        f\"{dist_C:.5e}\"\n    ]\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}