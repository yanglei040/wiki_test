{
    "hands_on_practices": [
        {
            "introduction": "要真正掌握朗之万动力学，我们必须从理论走向实践。第一个练习将引导您分析完整的（包含惯性项的）欠阻尼朗之万方程。通过求解一个受到恒定外力和热涨落共同作用的粒子的运动，您将深入理解系统如何响应确定性驱动和随机力，并分析其瞬态动力学行为，例如速度如何趋于一个稳态的终端速度。 这项练习对于建立求解随机微分方程的解析直觉至关重要。",
            "id": "2457171",
            "problem": "考虑一个一维欠阻尼朗之万模型，用于描述一个质量为 $m$ 的粒子，该粒子受到一个系数为 $\\gamma$ 的粘性摩擦力，并浸润在绝对温度为 $T$ 的热浴中。随机力具有一个非零均值，代表一个恒定的外部推力。将朗之万方程写为\n$$ m \\frac{d v(t)}{d t} = -\\gamma \\, v(t) + R(t), \\quad \\frac{d x(t)}{d t} = v(t), $$\n其中\n$$ R(t) = F_0 + \\eta(t), $$\n$F_0$ 是一个恒定力，$\\eta(t)$ 是一个零均值高斯白噪声，其协方差为\n$$ \\langle \\eta(t) \\rangle = 0, \\quad \\langle \\eta(t) \\, \\eta(t') \\rangle = 2 \\gamma k_{\\mathrm{B}} T \\, \\delta(t-t'), $$\n$k_{\\mathrm{B}}$ 是玻尔兹曼常数。假设初始条件为 $x(0) = 0$（单位：米）和 $v(0) = 0$（单位：米/秒）。所有输入和输出均使用国际单位制 (SI)，其中 $k_{\\mathrm{B}} = 1.380649 \\times 10^{-23}$ J/K。\n\n对于下面测试套件中的每一组参数，计算在指定时间 $t$ 的以下量：\n- 期望速度 $\\langle v(t) \\rangle$，单位：米/秒，\n- 期望位置 $\\langle x(t) \\rangle$，单位：米，\n- 位置的方差 $\\mathrm{Var}[x(t)]$，单位：平方米。\n\n报告每个测试用例的所有三个量。所有输出均以 SI 单位表示，并将每个报告的数字四舍五入到六位有效数字。\n\n测试套件（每个用例是一个元组 $\\left(m,\\gamma,T,F_0,t\\right)$，单位为 SI 单位）：\n- 用例 1: $\\left(6.63 \\times 10^{-26}, \\; 2.00 \\times 10^{-11}, \\; 300, \\; 8.00 \\times 10^{-12}, \\; 1.00 \\times 10^{-9}\\right)$\n- 用例 2: $\\left(6.63 \\times 10^{-26}, \\; 2.00 \\times 10^{-11}, \\; 300, \\; 0, \\; 5.00 \\times 10^{-10}\\right)$\n- 用例 3: $\\left(6.63 \\times 10^{-26}, \\; 2.00 \\times 10^{-11}, \\; 300, \\; 1.00 \\times 10^{-13}, \\; 1.00 \\times 10^{-15}\\right)$\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表的结果，顺序如下\n$[\\langle v(t) \\rangle_1, \\langle x(t) \\rangle_1, \\mathrm{Var}[x(t)]_1, \\langle v(t) \\rangle_2, \\langle x(t) \\rangle_2, \\mathrm{Var}[x(t)]_2, \\langle v(t) \\rangle_3, \\langle x(t) \\rangle_3, \\mathrm{Var}[x(t)]_3]$,\n其中下标表示相应的测试用例。不要包含任何额外的文本或空格。",
            "solution": "该问题提法明确且具有科学依据。它描述了一个一维欠阻尼朗之万模型，这是统计物理和计算化学中描述粒子在摩擦力、随机热力和恒定外力影响下进行布朗运动的一个基本和标准模型。所提供的方程和参数是自洽且具有物理意义的。我们将进行解析求解。\n\n该系统由朗之万方程描述：\n$$ m \\frac{d v(t)}{d t} = -\\gamma v(t) + F_0 + \\eta(t) $$\n其中随机力 $\\eta(t)$ 是一个高斯白噪声，其性质为 $\\langle \\eta(t) \\rangle = 0$ 和 $\\langle \\eta(t) \\eta(t') \\rangle = 2 \\gamma k_{\\mathrm{B}} T \\delta(t-t')$。初始条件为 $v(0)=0$ 和 $x(0)=0$。\n\n首先，我们求解速度 $v(t)$。关于 $v(t)$ 的方程可以重写为一个一阶线性非齐次常微分方程：\n$$ \\frac{d v(t)}{d t} + \\frac{\\gamma}{m} v(t) = \\frac{F_0}{m} + \\frac{\\eta(t)}{m} $$\n定义速度弛豫时间 $\\tau_v = m/\\gamma$，方程变为：\n$$ \\frac{d v(t)}{d t} + \\frac{1}{\\tau_v} v(t) = \\frac{F_0}{m} + \\frac{\\eta(t)}{m} $$\n使用积分因子 $e^{t/\\tau_v}$，可以找到该方程在初始条件 $v(0)=0$ 下的形式解：\n$$ v(t) = v(0)e^{-t/\\tau_v} + \\int_0^t e^{-(t-t')/\\tau_v} \\left( \\frac{F_0}{m} + \\frac{\\eta(t')}{m} \\right) dt' $$\n代入 $v(0)=0$：\n$$ v(t) = \\frac{F_0}{m} \\int_0^t e^{-(t-t')/\\tau_v} dt' + \\frac{1}{m} \\int_0^t e^{-(t-t')/\\tau_v} \\eta(t') dt' $$\n进行第一个积分，我们得到 $v(t)$ 的完整解：\n$$ v(t) = \\frac{F_0}{\\gamma} \\left( 1 - e^{-t/\\tau_v} \\right) + \\frac{1}{m} \\int_0^t e^{-(t-t')/\\tau_v} \\eta(t') dt' $$\n\n为了找到期望速度 $\\langle v(t) \\rangle$，我们对上述表达式取期望值。由于期望算符是线性的且 $\\langle \\eta(t') \\rangle = 0$，积分项消失。\n$$ \\langle v(t) \\rangle = \\left\\langle \\frac{F_0}{\\gamma} \\left( 1 - e^{-t/\\tau_v} \\right) \\right\\rangle + \\frac{1}{m} \\int_0^t e^{-(t-t')/\\tau_v} \\langle \\eta(t') \\rangle dt' $$\n$$ \\langle v(t) \\rangle = \\frac{F_0}{\\gamma} \\left( 1 - e^{-\\gamma t/m} \\right) $$\n\n接下来，我们找到期望位置 $\\langle x(t) \\rangle$。位置通过对速度积分得到，$x(t) = x(0) + \\int_0^t v(t') dt'$。当 $x(0)=0$时，我们有 $\\langle x(t) \\rangle = \\int_0^t \\langle v(t') \\rangle dt'$。\n$$ \\langle x(t) \\rangle = \\int_0^t \\frac{F_0}{\\gamma} \\left( 1 - e^{-t'/\\tau_v} \\right) dt' $$\n$$ \\langle x(t) \\rangle = \\frac{F_0}{\\gamma} \\left[ t' + \\tau_v e^{-t'/\\tau_v} \\right]_0^t = \\frac{F_0}{\\gamma} \\left( (t + \\tau_v e^{-t/\\tau_v}) - (0 + \\tau_v) \\right) $$\n$$ \\langle x(t) \\rangle = \\frac{F_0}{\\gamma} \\left( t - \\tau_v (1 - e^{-t/\\tau_v}) \\right) = \\frac{F_0}{\\gamma} \\left( t - \\frac{m}{\\gamma} (1 - e^{-\\gamma t/m}) \\right) $$\n\n最后，我们计算位置的方差，$\\mathrm{Var}[x(t)] = \\langle (x(t) - \\langle x(t) \\rangle)^2 \\rangle$。位置的涨落部分 $\\delta x(t) = x(t) - \\langle x(t) \\rangle$ 由以下公式给出：\n$$ \\delta x(t) = \\int_0^t \\delta v(t') dt' = \\int_0^t \\left( \\frac{1}{m} \\int_0^{t'} e^{-(t'-t_1)/\\tau_v} \\eta(t_1) dt_1 \\right) dt' $$\n方差则为 $\\mathrm{Var}[x(t)] = \\langle (\\delta x(t))^2 \\rangle = \\int_0^t dt' \\int_0^t dt'' \\langle \\delta v(t') \\delta v(t'') \\rangle$。这需要涨落分量的速度自相关函数 $\\langle \\delta v(t') \\delta v(t'') \\rangle$。\n利用白噪声 $\\eta(t)$ 的性质，可以计算出该相关函数为：\n$$ \\langle \\delta v(t') \\delta v(t'') \\rangle = \\frac{k_{\\mathrm{B}} T}{m} \\left( e^{-|t'-t''|/\\tau_v} - e^{-(t'+t'')/\\tau_v} \\right) $$\n将此表达式对时间从 $0$ 到 $t$ 积分两次，即可得到位置方差。此计算的标准结果为：\n$$ \\mathrm{Var}[x(t)] = \\frac{2 k_B T m}{\\gamma^2} \\left( \\frac{\\gamma t}{m} - \\frac{3}{2} + 2e^{-\\gamma t/m} - \\frac{1}{2} e^{-2\\gamma t/m} \\right) $$\n当时间参数 $u = \\gamma t/m$ 很小时，此表达式可能会遭受灾难性抵消。使用 `expm1` 函数可以推导出一种数值稳定的形式，其中 $\\mathrm{expm1}(z) = e^z - 1$：\n$$ \\frac{\\gamma t}{m} - \\frac{3}{2} + 2e^{-\\gamma t/m} - \\frac{1}{2} e^{-2\\gamma t/m} = \\frac{\\gamma t}{m} + 2\\mathrm{expm1}(-\\gamma t/m) - \\frac{1}{2}\\mathrm{expm1}(-2\\gamma t/m) $$\n我们将在代码中实现此形式，以确保在所有时间尺度上的数值准确性。\n\n用于计算的公式总结：\n1. $\\langle v(t) \\rangle = \\frac{F_0}{\\gamma} (1 - e^{-\\gamma t/m})$\n2. $\\langle x(t) \\rangle = \\frac{F_0}{\\gamma} (t - \\frac{m}{\\gamma} (1 - e^{-\\gamma t/m}))$\n3. $\\mathrm{Var}[x(t)] = \\frac{2k_B T m}{\\gamma^2} \\left( \\frac{\\gamma t}{m} + 2(e^{-\\gamma t/m}-1) - \\frac{1}{2}(e^{-2\\gamma t/m}-1) \\right)$\n\n这些公式将应用于每个测试用例。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Langevin dynamics problem for the given test cases.\n    \"\"\"\n    \n    # Define physical constants\n    K_B = 1.380649e-23  # Boltzmann constant in J/K\n\n    # Test suite: (m, gamma, T, F0, t) in SI units\n    test_cases = [\n        (6.63e-26, 2.00e-11, 300, 8.00e-12, 1.00e-9),\n        (6.63e-26, 2.00e-11, 300, 0, 5.00e-10),\n        (6.63e-26, 2.00e-11, 300, 1.00e-13, 1.00e-15),\n    ]\n\n    def calculate_dynamics(m, gamma, T, F0, t):\n        \"\"\"\n        Calculates expected velocity, position, and position variance.\n        \n        Args:\n            m (float): Mass in kg\n            gamma (float): Friction coefficient in kg/s\n            T (float): Temperature in K\n            F0 (float): Constant force in N\n            t (float): Time in s\n            \n        Returns:\n            tuple: A tuple containing (expected_velocity, expected_position, position_variance).\n        \"\"\"\n        if gamma == 0 or m == 0:\n            return 0.0, 0.0, 0.0 # Avoid division by zero, though not expected in tests\n\n        # Calculate expectation of velocity\n        v_exp = (F0 / gamma) * (1 - np.exp(-gamma * t / m))\n\n        # Calculate expectation of position\n        x_exp = (F0 / gamma) * (t - (m / gamma) * (1 - np.exp(-gamma * t / m)))\n        \n        # Calculate position variance using the numerically stable form\n        u = gamma * t / m\n        var_term = u + 2 * np.expm1(-u) - 0.5 * np.expm1(-2 * u)\n        var_x = (2 * K_B * T * m / (gamma**2)) * var_term\n\n        return v_exp, x_exp, var_x\n\n    all_results = []\n    for params in test_cases:\n        m, gamma, T, F0, t = params\n        v_exp_val, x_exp_val, var_x_val = calculate_dynamics(m, gamma, T, F0, t)\n        all_results.extend([v_exp_val, x_exp_val, var_x_val])\n\n    # Format the output to six significant digits\n    formatted_results = [f\"{val:.6g}\" for val in all_results]\n    \n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "下一个练习将平衡态统计力学与非平衡动力学过程联系起来。我们设想一个最初被谐振子势阱束缚并处于热平衡的粒子，在势阱被瞬间移除后的演化过程。 这个思想实验将锻炼您应用能量均分定理等平衡态概念作为动力学初始条件的能力，并帮助您理解系统统计矩（如二阶矩）如何随时间演化。",
            "id": "2406370",
            "problem": "考虑一个一维过阻尼朗之万粒子，该粒子与温度为 $T$ 的热库接触，采用约化的无量纲单位，其中玻尔兹曼常数 $k_{\\mathrm{B}}=1$。粒子受到黏性阻尼，阻尼系数为 $\\gamma0$，并处在一个保守势 $U(x,t)$ 中。其动力学由随机微分方程（SDE）描述，无论是 Stratonovich 诠释还是 Itô 诠释（此处二者等价，因为噪声系数是常数），\n$$\n\\gamma \\,\\frac{dx}{dt} \\;=\\; -\\,\\frac{\\partial U(x,t)}{\\partial x} \\;+\\; \\sqrt{2\\,\\gamma\\,T}\\,\\eta(t),\n$$\n其中 $\\eta(t)$ 是标准高斯白噪声，其均值为零，并具有单位狄拉克δ相关性，\n$$\n\\langle \\eta(t)\\rangle=0,\\qquad \\langle \\eta(t)\\,\\eta(t')\\rangle=\\delta(t-t').\n$$\n在时间 $t0$ 时，粒子被束缚在一个劲度系数为 $k0$ 的谐振子势阱中，即 $U(x,t0)=\\tfrac{1}{2}k x^2$，且系统在温度 $T$ 下处于平衡状态。在 $t=0$ 时，势阱被瞬时完全移除，因此对于 $t\\ge 0$，势恒为零，$U(x,t\\ge 0)=0$。\n\n令 $x(0)$ 表示粒子在释放瞬间的位置。由于系统在 $t0$ 时处于平衡状态，$x(0)$ 的分布是对应于温度 $T$ 下谐振子势阱的正则分布。对于 $t\\ge 0$，粒子在上述过阻尼朗之万动力学下自由演化。\n\n对于每组指定的参数 $(\\gamma,k,T,t_{\\mathrm{f}})$，计算在末态时间 $t_{\\mathrm{f}}\\ge 0$ 时的精确系综二阶矩，\n$$\nM(t_{\\mathrm{f}})\\equiv \\mathbb{E}\\!\\left[x(t_{\\mathrm{f}})^2\\right],\n$$\n结果表示为无量纲数。使用所述的约化无量纲单位，并将所有答案表示为无量纲数。\n\n测试组：\n- 情况 1：$\\gamma=1.0$, $k=2.0$, $T=1.5$, $t_{\\mathrm{f}}=3.0$。\n- 情况 2：$\\gamma=0.5$, $k=4.0$, $T=2.0$, $t_{\\mathrm{f}}=0.0$。\n- 情况 3：$\\gamma=1.0$, $k=100.0$, $T=1.0$, $t_{\\mathrm{f}}=0.1$。\n- 情况 4：$\\gamma=0.1$, $k=1.0$, $T=0.5$, $t_{\\mathrm{f}}=1.0$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个逗号分隔的列表，用方括号括起来，每个 $M(t_{\\mathrm{f}})$ 精确到小数点后 $6$ 位，且不含空格，并按测试组情况的顺序排列。例如，四个情况的输出必须类似于\n$[m_1,m_2,m_3,m_4]$,\n其中每个 $m_i$ 是一个小数点后恰有 $6$ 位的小数。",
            "solution": "所述问题在科学上是合理的、自洽的且提法得当。所有参数和条件都已精确定义，从而可以进行严格的解析求解。这是统计物理领域中关于朗之万动力学的一个标准问题。我们开始求解。\n\n任务是计算一个经历过阻尼朗之万运动的粒子的系综二阶矩 $M(t_{\\mathrm{f}})\\equiv \\mathbb{E}[x(t_{\\mathrm{f}})^2]$。该过程包括两个步骤：首先，根据 $t0$ 时的平衡条件确定初始二阶矩 $\\mathbb{E}[x(0)^2]$；其次，利用给定的自由粒子的朗之万方程，使该矩随时间演化至 $t\\ge 0$。\n\n**步骤1：$t=0$ 时的初始二阶矩**\n\n在时间 $t0$ 时，粒子处于谐振子势 $U(x) = \\frac{1}{2}kx^2$ 中，并与温度为 $T$ 的热库处于热平衡状态。粒子位置 $x$ 的概率分布由正则玻尔兹曼分布给出。当玻尔兹曼常数 $k_{\\mathrm{B}}=1$ 时，概率密度函数为：\n$$\np(x) = \\frac{1}{Z} e^{-U(x)/T} = \\frac{1}{Z} e^{-kx^2/(2T)}\n$$\n其中 $Z$ 是确保归一化的配分函数。这是一个均值为零的高斯分布，$\\mathbb{E}[x]=0$。该分布的方差 $\\sigma^2_x = \\mathbb{E}[x^2] - (\\mathbb{E}[x])^2 = \\mathbb{E}[x^2]$，可以通过将指数与高斯分布的标准形式 $e^{-x^2/(2\\sigma^2_x)}$ 进行比较得出：\n$$\n\\frac{x^2}{2\\sigma^2_x} = \\frac{kx^2}{2T} \\implies \\sigma^2_x = \\frac{T}{k}\n$$\n因此，在势阱被释放的瞬间 $t=0$ 时的初始二阶矩为：\n$$\n\\mathbb{E}[x(0)^2] = \\frac{T}{k}\n$$\n这个结果也是能量均分定理的直接推论，该定理指出每个二次自由度对平均能量的贡献为 $\\frac{1}{2}k_{\\mathrm{B}}T$。对于势能 $\\mathbb{E}[U(x)] = \\mathbb{E}[\\frac{1}{2}kx^2] = \\frac{1}{2}k\\mathbb{E}[x^2]$，我们有：\n$$\n\\frac{1}{2}k\\mathbb{E}[x(0)^2] = \\frac{1}{2}T \\implies \\mathbb{E}[x(0)^2] = \\frac{T}{k}\n$$\n\n**步骤2：$t\\ge 0$ 时的含时演化**\n\n对于 $t\\ge 0$，势被移除，$U(x, t\\ge 0)=0$。朗之万方程简化为描述一个自由过阻尼粒子（自由布朗运动）：\n$$\n\\gamma \\frac{dx}{dt} = \\sqrt{2\\gamma T}\\,\\eta(t)\n$$\n正如问题所正确指出的，该随机微分方程的 Itô 和 Stratonovich 诠释是等价的，因为噪声系数 $\\sqrt{2\\gamma T}$ 是一个常数。我们可以将方程重写为：\n$$\ndx = \\sqrt{\\frac{2T}{\\gamma}}\\,\\eta(t)\\,dt\n$$\n我们将此方程从 $t=0$ 到末态时间 $t_{\\mathrm{f}}$ 进行形式上的积分：\n$$\n\\int_{x(0)}^{x(t_{\\mathrm{f}})} dx' = \\int_{0}^{t_{\\mathrm{f}}} \\sqrt{\\frac{2T}{\\gamma}}\\,\\eta(t')\\,dt'\n$$\n$$\nx(t_{\\mathrm{f}}) - x(0) = \\sqrt{\\frac{2T}{\\gamma}} \\int_{0}^{t_{\\mathrm{f}}} \\eta(t')\\,dt'\n$$\n因此，在时间 $t_{\\mathrm{f}}$ 时的位置是：\n$$\nx(t_{\\mathrm{f}}) = x(0) + \\sqrt{\\frac{2T}{\\gamma}} \\int_{0}^{t_{\\mathrm{f}}} \\eta(t')\\,dt'\n$$\n我们现在通过对 $x(t_{\\mathrm{f}})$ 的表达式进行平方并取期望值来计算系综二阶矩 $M(t_{\\mathrm{f}}) = \\mathbb{E}[x(t_{\\mathrm{f}})^2]$：\n$$\n\\mathbb{E}[x(t_{\\mathrm{f}})^2] = \\mathbb{E}\\left[ \\left( x(0) + \\sqrt{\\frac{2T}{\\gamma}} \\int_{0}^{t_{\\mathrm{f}}} \\eta(t')\\,dt' \\right)^2 \\right]\n$$\n展开平方项得到三项：\n$$\nM(t_{\\mathrm{f}}) = \\mathbb{E}[x(0)^2] \\;+\\; 2\\sqrt{\\frac{2T}{\\gamma}} \\mathbb{E}\\left[ x(0) \\int_{0}^{t_{\\mathrm{f}}} \\eta(t')\\,dt' \\right] \\;+\\; \\frac{2T}{\\gamma} \\mathbb{E}\\left[ \\left( \\int_{0}^{t_{\\mathrm{f}}} \\eta(t')\\,dt' \\right)^2 \\right]\n$$\n我们来逐项计算。\n1.  第一项是初始二阶矩，我们已经求得其值为 $\\mathbb{E}[x(0)^2] = \\frac{T}{k}$。\n2.  第二项是交叉项。初始位置 $x(0)$ 由系统在 $t0$ 时的演化决定。对于 $t'0$ 的白噪声 $\\eta(t')$ 与 $t=0$ 时的状态在因果上是独立的。因此，$x(0)$ 和 $\\eta(t')$ 是不相关的。我们可以将期望值分开：\n    $$\n    \\mathbb{E}\\left[ x(0) \\int_{0}^{t_{\\mathrm{f}}} \\eta(t')\\,dt' \\right] = \\mathbb{E}[x(0)] \\int_{0}^{t_{\\mathrm{f}}} \\mathbb{E}[\\eta(t')]\\,dt'\n    $$\n    由于噪声的均值为零，$\\mathbb{E}[\\eta(t')] = 0$，所以整个项为零。\n3.  第三项表示由自由扩散引起的均方位移。我们使用性质 $\\mathbb{E}[\\eta(t')\\eta(t'')] = \\delta(t'-t'')$：\n    $$\n    \\mathbb{E}\\left[ \\left( \\int_{0}^{t_{\\mathrm{f}}} \\eta(t')\\,dt' \\right)^2 \\right] = \\mathbb{E}\\left[ \\int_{0}^{t_{\\mathrm{f}}}dt' \\int_{0}^{t_{\\mathrm{f}}}dt''\\, \\eta(t')\\eta(t'') \\right]\n    $$\n    $$\n    = \\int_{0}^{t_{\\mathrm{f}}}dt' \\int_{0}^{t_{\\mathrm{f}}}dt''\\, \\mathbb{E}[\\eta(t')\\eta(t'')] = \\int_{0}^{t_{\\mathrm{f}}}dt' \\int_{0}^{t_{\\mathrm{f}}}dt''\\, \\delta(t'-t'')\n    $$\n    对 $t''$ 的内层积分在 $0 \\le t' \\le t_{\\mathrm{f}}$ 的条件下值为 $1$。\n    $$\n    = \\int_{0}^{t_{\\mathrm{f}}} 1 \\cdot dt' = t_{\\mathrm{f}}\n    $$\n    因此，第三项是 $\\frac{2T}{\\gamma} t_{\\mathrm{f}}$。\n\n结合这些结果，我们得到在时间 $t_{\\mathrm{f}}$ 时二阶矩的最终表达式：\n$$\nM(t_{\\mathrm{f}}) = \\mathbb{E}[x(t_{\\mathrm{f}})^2] = \\frac{T}{k} + 0 + \\frac{2Tt_{\\mathrm{f}}}{\\gamma}\n$$\n$$\nM(t_{\\mathrm{f}}) = T \\left( \\frac{1}{k} + \\frac{2t_{\\mathrm{f}}}{\\gamma} \\right)\n$$\n该公式表明，最终方差是谐振子束缚产生的初始方差与在时间区间 $[0, t_{\\mathrm{f}}]$ 内自由扩散累积的方差之和。这个解析结果将用于计算指定测试用例的值。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the exact ensemble second moment for a freely diffusing\n    Langevin particle that was initially confined in a harmonic trap.\n    \"\"\"\n    \n    # Define the test cases from the problem statement as a list of tuples.\n    # Each tuple contains (gamma, k, T, t_f).\n    test_cases = [\n        (1.0, 2.0, 1.5, 3.0),   # Case 1\n        (0.5, 4.0, 2.0, 0.0),   # Case 2\n        (1.0, 100.0, 1.0, 0.1),  # Case 3\n        (0.1, 1.0, 0.5, 1.0),   # Case 4\n    ]\n\n    results = []\n    for case in test_cases:\n        gamma, k, T, t_f = case\n        \n        # The exact analytical formula for the second moment M(t_f) is derived as:\n        # M(t_f) = E[x(t_f)^2] = T/k + 2*T*t_f / gamma\n        # This can be factored as M(t_f) = T * (1/k + 2*t_f/gamma)\n        \n        # Initial variance from the harmonic trap in equilibrium.\n        initial_variance = T / k\n        \n        # Variance accumulated from free diffusion.\n        diffusive_variance = (2.0 * T * t_f) / gamma\n        \n        # The total second moment is the sum of the initial variance and the\n        # variance gained through diffusion.\n        m_tf = initial_variance + diffusive_variance\n        \n        results.append(m_tf)\n\n    # Format the list of results into the required string format:\n    # A comma-separated list of numbers rounded to 6 decimal places,\n    # enclosed in square brackets.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    final_output_string = f\"[{','.join(formatted_results)}]\"\n    \n    # Final print statement must produce only the specified single-line format.\n    print(final_output_string)\n\nsolve()\n```"
        },
        {
            "introduction": "最后的练习是理论与计算实践的结合，这是计算物理学的核心。您将为一个在非平凡对数势中运动的粒子建立过阻尼朗之万动力学模拟。 该练习不仅要求您实现欧拉-丸山数值积分方案，还强调了通过与严格推导的解析解进行比较来验证模拟结果的重要性，从而完成从理论建模到数值实现再到结果验证的完整闭环。",
            "id": "2406383",
            "problem": "考虑一个单粒子在一维空间中运动的过阻尼朗之万动力学，其受到由 $V(x)=a \\ln\\!\\big(1+(x/x_0)^2\\big)$ 给出的限制性对数势的影响。假设该动力学由粘性摩擦和在绝对温度为 $T$ 的热浴中的热涨落之间的平衡所支配，其中玻尔兹曼常数 $k_{\\mathrm{B}}$ 设为 $1$，因此温度具有能量的单位。本问题中的所有量均为无量纲。\n\n你的任务如下，仅从基本原理和经过充分检验的事实出发：\n1) 从牛顿第二定律和涨落耗散关系（噪声均值为零，相关性与狄拉克δ函数成正比）出发，推导在势 $V(x)$ 下 $x(t)$ 的过阻尼朗之万方程。你必须得到一个形式为 $dx = \\mu(x)\\,dt + \\sigma\\,dW_t$ 的方程，其中 $W_t$ 是一个维纳过程，并用 $a$、$x_0$、$T$ 和摩擦系数 $\\gamma$ 来确定漂移 $\\mu(x)$ 和扩散振幅 $\\sigma$。\n2) 使用福克-普朗克方程，证明稳态分布（如果存在）是玻尔兹曼分布 $p_{\\mathrm{eq}}(x) \\propto \\exp\\!\\big(-\\beta V(x)\\big)$，其中 $\\beta=1/T$。确定参数 $\\nu=\\beta a$ 在何种条件下，该稳态分布在整个实轴上是可归一化的，并将未归一化的密度表示为 $p_{\\mathrm{unnorm}}(x)=(1+(x/x_0)^2)^{-\\nu}$ 的形式。\n3) 对于 $\\nu1/2$，通过计算 $\\int_{-\\infty}^{\\infty} (1+(x/x_0)^2)^{-\\nu} \\, dx$，使用伽马函数的标准积分恒等式，推导稳态分布 $p_{\\mathrm{eq}}(x)$ 的归一化常数 $Z(\\nu,x_0)$。以伽马函数的形式明确给出 $Z(\\nu,x_0)$ 的闭合形式。\n4) 考虑过阻尼朗之万方程的欧拉-丸山时间离散化，时间步长为 $\\Delta t$：\n$$\nx_{n+1} = x_n + \\mu(x_n)\\,\\Delta t + \\sigma \\sqrt{\\Delta t}\\,\\xi_n,\n$$\n其中 $\\xi_n$ 是独立同分布的标准正态随机变量，其均值为零，方差为一。设计一个模拟方案，通过并行演化许多独立粒子并在预烧阶段（burn-in stage）后收集样本来近似稳态分布。为确保数值稳定性和对原点附近最快确定性弛豫有足够的时间分辨率，将时间步长设置为\n$$\n\\Delta t = 0.005\\,\\frac{\\gamma x_0^2}{a}.\n$$\n这里，$\\gamma$ 是摩擦系数。使用 $N_{\\mathrm{p}}$ 个从 $x=0$ 初始化的独立粒子，将它们演化 $N_{\\mathrm{steps}}$ 步，并丢弃前 $N_{\\mathrm{burn}}$ 步作为预烧。为了可复现性，使用一个固定的伪随机数种子，等于 $12345$。\n5) 设目标区间（bin）为 $[-w/2,w/2]$，宽度为 $w = 0.5\\,x_0$。使用你在第3项中得到的归一化稳态分布，通过高精度的数值积分计算“精确”的稳态区间概率\n$$\nP_{\\mathrm{exact}} = \\frac{1}{Z(\\nu,x_0)} \\int_{-w/2}^{w/2} \\left(1+(x/x_0)^2\\right)^{-\\nu}\\,dx。\n$$\n使用你的欧拉-丸山模拟，将经验区间概率 $P_{\\mathrm{emp}}$ 估计为落在区间 $[-w/2,w/2]$ 内的样本比例（涵盖所有粒子和预烧后的所有时间步）。\n6) 对于下面测试套件中的每个参数集，报告相对误差 $\\varepsilon = |P_{\\mathrm{emp}}-P_{\\mathrm{exact}}|/P_{\\mathrm{exact}}$。\n\n你的程序应使用的模拟参数和输出规范：\n- 使用 $N_{\\mathrm{p}}=5000$，$N_{\\mathrm{steps}}=3000$，$N_{\\mathrm{burn}}=500$。\n- 使用伪随机数种子 $12345$。\n- 对于每个测试用例，通过具有足够严格公差的数值积分计算 $P_{\\mathrm{exact}}$，使其数值误差与抽样误差相比可以忽略不计。\n- 你的程序必须输出一行，其中包含下面测试套件的三个相对误差列表，格式为用方括号括起来的逗号分隔列表，并且每个数字都四舍五入到恰好 $6$ 位小数（例如，$[0.001234,0.056789,0.000010]$）。\n\n测试套件（所有量均为无量纲）：\n- 情况 A（强约束）：$a=2.0$，$x_0=1.0$，$\\gamma=1.0$，$T=2.0/3.0$，因此 $\\nu=\\beta a = 3.0$。\n- 情况 B（中等约束，重尾但可归一化）：$a=2.0$，$x_0=1.0$，$\\gamma=1.0$，$T=2.0$，因此 $\\nu=\\beta a = 1.0$。\n- 情况 C（接近可归一化阈值）：$a=2.0$，$x_0=1.0$，$\\gamma=1.0$，$T=10.0/3.0$，因此 $\\nu=\\beta a = 0.6$。\n\n最终输出格式：\n- 你的程序应生成一行输出，其中包含结果，格式为用方括号括起来的逗号分隔列表，严格按照 [情况 A 结果, 情况 B 结果, 情况 C 结果] 的顺序，每个数字都四舍五入到 $6$ 位小数。",
            "solution": "所述问题具有科学依据，提法恰当，客观，并包含了解决该问题所需的所有必要信息。它描述了统计物理学中的一个标准问题，即势场中粒子的过阻尼朗之万动力学，可以使用已建立的理论和数值方法进行分析。所有参数和步骤都得到了明确的规定。因此，我们着手求解。\n\n解答根据问题陈述中指定的六项任务进行组织。\n\n1. 过阻尼朗之万方程的推导\n\n我们从质量为 $m$ 的粒子在一维 $x$ 上的牛顿第二定律开始，该粒子受到势场力 $F_{\\mathrm{pot}}(x)$、粘性阻力 $F_{\\mathrm{fric}}$ 和随机热力 $\\eta(t)$ 的作用：\n$$m\\frac{d^2x}{dt^2} = F_{\\mathrm{pot}}(x) + F_{\\mathrm{fric}} + \\eta(t)$$\n势场力是保守的，$F_{\\mathrm{pot}}(x) = -V'(x)$。粘性阻力与速度成正比，$F_{\\mathrm{fric}} = -\\gamma \\frac{dx}{dt}$，其中 $\\gamma$ 是摩擦系数。运动方程是完整的朗之万方程：\n$$m\\frac{d^2x}{dt^2} = -V'(x) - \\gamma \\frac{dx}{dt} + \\eta(t)$$\n过阻尼极限考虑的是摩擦力主导惯性力的运动，这等价于取极限 $m \\to 0$。这在物理上对于高粘度介质中的运动或在远长于动量弛豫时间 $\\tau_p = m/\\gamma$ 的时间尺度上是合理的。在此极限下，惯性项 $m\\ddot{x}$ 被忽略：\n$$0 \\approx -V'(x) - \\gamma \\frac{dx}{dt} + \\eta(t)$$\n整理后得到过阻尼朗之万方程：\n$$\\gamma \\frac{dx}{dt} = -V'(x) + \\eta(t)$$\n随机力 $\\eta(t)$ 代表来自温度为 $T$ 的热浴的热涨落。涨落耗散定理决定了其统计特性：它是一个均值为零的高斯白噪声过程，其相关函数由下式给出：\n$$\\langle \\eta(t) \\rangle = 0$$\n$$\\langle \\eta(t)\\eta(t') \\rangle = 2\\gamma k_B T \\delta(t-t')$$\n鉴于问题陈述中 $k_B=1$，相关性为 $\\langle \\eta(t)\\eta(t') \\rangle = 2\\gamma T \\delta(t-t')$。\n\n为了将方程写成标准的伊东（Itô）形式 $dx = \\mu(x)\\,dt + \\sigma\\,dW_t$，我们两边除以 $\\gamma$：\n$$\\frac{dx}{dt} = -\\frac{1}{\\gamma}V'(x) + \\frac{1}{\\gamma}\\eta(t)$$\n这对应于一个伊东随机微分方程，其中 $dW_t$ 是维纳过程的增量。我们将噪声项 $\\frac{1}{\\gamma}\\eta(t)dt$ 与 $\\sigma dW_t$ 进行匹配。它们的方差必须相等。\n噪声项的方差是：\n$$\\left\\langle \\left(\\frac{1}{\\gamma}\\eta(t)dt\\right) \\left(\\frac{1}{\\gamma}\\eta(t')dt'\\right) \\right\\rangle = \\frac{1}{\\gamma^2}\\langle \\eta(t)\\eta(t') \\rangle dt dt' = \\frac{1}{\\gamma^2} (2\\gamma T \\delta(t-t')) dt dt' = \\frac{2T}{\\gamma} dt$$\n将此与伊东随机微分方程中随机项的方差 $\\langle (\\sigma dW_t)^2 \\rangle = \\sigma^2 dt$ 进行比较，我们确定：\n$$\\sigma^2 = \\frac{2T}{\\gamma} \\implies \\sigma = \\sqrt{\\frac{2T}{\\gamma}}$$\n方程的确定性部分给出了漂移项：\n$$\\mu(x) = -\\frac{1}{\\gamma}V'(x)$$\n对于给定的势 $V(x)=a \\ln(1+(x/x_0)^2)$，其导数为：\n$$V'(x) = a \\frac{1}{1+(x/x_0)^2} \\cdot \\frac{2x}{x_0^2} = \\frac{2ax}{x_0^2+x^2}$$\n因此，漂移和扩散系数为：\n$$\\mu(x) = -\\frac{2ax}{\\gamma(x_0^2+x^2)}, \\quad \\sigma = \\sqrt{\\frac{2T}{\\gamma}}$$\n扩散系数 $\\sigma$ 与位置 $x$ 无关。\n\n2. 福克-普朗克方程与稳态分布\n\n对于由 $dx = \\mu(x)\\,dt + \\sigma(x)\\,dW_t$ 描述的过程，其概率密度函数 $p(x,t)$ 的时间演化由福克-普朗克方程支配：\n$$\\frac{\\partial p}{\\partial t} = -\\frac{\\partial}{\\partial x} [\\mu(x)p(x,t)] + \\frac{1}{2}\\frac{\\partial^2}{\\partial x^2} [\\sigma^2(x)p(x,t)]$$\n代入我们得到的 $\\mu(x)$ 和常数 $\\sigma$ 的表达式：\n$$\\frac{\\partial p}{\\partial t} = -\\frac{\\partial}{\\partial x} \\left[-\\frac{1}{\\gamma}V'(x)p\\right] + \\frac{1}{2}\\frac{\\partial^2}{\\partial x^2} \\left[\\frac{2T}{\\gamma}p\\right] = \\frac{1}{\\gamma}\\frac{\\partial}{\\partial x} \\left[V'(x)p\\right] + \\frac{T}{\\gamma}\\frac{\\partial^2p}{\\partial x^2}$$\n稳态分布 $p_{\\mathrm{eq}}(x)$ 由条件 $\\frac{\\partial p_{\\mathrm{eq}}}{\\partial t}=0$ 定义。\n$$0 = \\frac{1}{\\gamma}\\frac{d}{dx} \\left[V'(x)p_{\\mathrm{eq}}\\right] + \\frac{T}{\\gamma}\\frac{d^2p_{\\mathrm{eq}}}{dx^2} \\implies \\frac{d}{dx} \\left[V'(x)p_{\\mathrm{eq}} + T\\frac{dp_{\\mathrm{eq}}}{dx}\\right] = 0$$\n方括号中的项是概率流，对于限制性势中的稳态，该流必须处处为零。\n$$V'(x)p_{\\mathrm{eq}} + T\\frac{dp_{\\mathrm{eq}}}{dx} = 0 \\implies \\frac{1}{p_{\\mathrm{eq}}}\\frac{dp_{\\mathrm{eq}}}{dx} = -\\frac{V'(x)}{T}$$\n对 $x$ 积分得到 $\\ln(p_{\\mathrm{eq}}) = -V(x)/T + C$，其中 $C$ 是积分常数。\n$$p_{\\mathrm{eq}}(x) = \\exp(C) \\exp\\left(-\\frac{V(x)}{T}\\right)$$\n令 $\\beta=1/T$，这就是玻尔兹曼分布 $p_{\\mathrm{eq}}(x) \\propto \\exp(-\\beta V(x))$，正如要求的那样。\n代入势 $V(x)=a \\ln(1+(x/x_0)^2)$ 并定义 $\\nu = \\beta a$：\n$$p_{\\mathrm{eq}}(x) \\propto \\exp\\left(-\\beta a \\ln(1+(x/x_0)^2)\\right) = \\exp\\left(-\\nu \\ln(1+(x/x_0)^2)\\right) = \\left(1+(x/x_0)^2\\right)^{-\\nu}$$\n未归一化的密度为 $p_{\\mathrm{unnorm}}(x) = (1+(x/x_0)^2)^{-\\nu}$。\n为使该分布可归一化，积分 $\\int_{-\\infty}^{\\infty} (1+(x/x_0)^2)^{-\\nu} dx$ 必须收敛。对于大的 $|x|$，被积函数的行为类似于 $( (x/x_0)^2 )^{-\\nu} \\propto |x|^{-2\\nu}$。积分 $\\int^{\\infty} |x|^{-p} dx$ 收敛当且仅当 $p1$。在这里，$p=2\\nu$，因此可归一化的条件是 $2\\nu1$，即 $\\nu  1/2$。\n\n3. 归一化常数\n\n对于 $\\nu  1/2$，我们必须计算归一化常数 $Z(\\nu, x_0) = \\int_{-\\infty}^{\\infty} (1+(x/x_0)^2)^{-\\nu} dx$。我们进行变量代换 $u=x/x_0$，因此 $dx = x_0 du$：\n$$Z(\\nu, x_0) = \\int_{-\\infty}^{\\infty} (1+u^2)^{-\\nu} x_0 du = x_0 \\int_{-\\infty}^{\\infty} (1+u^2)^{-\\nu} du$$\n由于被积函数是 $u$ 的偶函数，我们可以写成：\n$$Z(\\nu, x_0) = 2x_0 \\int_{0}^{\\infty} (1+u^2)^{-\\nu} du$$\n这个积分是与贝塔函数相关的标准形式，其表示为 $B(z_1, z_2) = 2\\int_0^{\\pi/2}(\\sin\\theta)^{2z_1-1}(\\cos\\theta)^{2z_2-1}d\\theta$。或者，一个更直接的关系使用表示式 $B(z_1, z_2) = \\int_0^{\\infty} \\frac{t^{z_1-1}}{(1+t)^{z_1+z_2}} dt$。\n令 $u^2=t$，则 $u=\\sqrt{t}$ 且 $du = \\frac{1}{2\\sqrt{t}}dt$。\n$$\\int_{0}^{\\infty} (1+u^2)^{-\\nu} du = \\int_{0}^{\\infty} (1+t)^{-\\nu} \\frac{1}{2\\sqrt{t}}dt = \\frac{1}{2}\\int_{0}^{\\infty} \\frac{t^{-1/2}}{(1+t)^{\\nu}} dt$$\n将其与贝塔函数积分比较，我们设 $z_1-1 = -1/2 \\implies z_1=1/2$，且 $z_1+z_2=\\nu \\implies 1/2+z_2=\\nu \\implies z_2=\\nu-1/2$。\n因此积分为 $\\frac{1}{2}B(1/2, \\nu-1/2)$。使用关系式 $B(z_1, z_2) = \\frac{\\Gamma(z_1)\\Gamma(z_2)}{\\Gamma(z_1+z_2)}$：\n$$\\int_{0}^{\\infty} (1+u^2)^{-\\nu} du = \\frac{1}{2} \\frac{\\Gamma(1/2)\\Gamma(\\nu-1/2)}{\\Gamma(1/2+\\nu-1/2)} = \\frac{1}{2} \\frac{\\Gamma(1/2)\\Gamma(\\nu-1/2)}{\\Gamma(\\nu)}$$\n由于 $\\Gamma(1/2)=\\sqrt{\\pi}$，归一化常数为：\n$$Z(\\nu, x_0) = 2x_0 \\left(\\frac{1}{2} \\frac{\\sqrt{\\pi}\\Gamma(\\nu-1/2)}{\\Gamma(\\nu)}\\right) = x_0\\sqrt{\\pi} \\frac{\\Gamma(\\nu-1/2)}{\\Gamma(\\nu)}$$\n\n4. 模拟方案\n\n过阻尼朗之万方程使用欧拉-丸山格式进行离散化，时间步长为 $\\Delta t$：\n$$x_{n+1} = x_n + \\mu(x_n)\\Delta t + \\sigma \\sqrt{\\Delta t}\\,\\xi_n$$\n其中 $\\xi_n$ 是从标准正态分布 $N(0,1)$ 中抽取的独立随机变量。参数规定如下：\n- 时间步长：$\\Delta t = 0.005\\,\\frac{\\gamma x_0^2}{a}$\n- 粒子数：$N_{\\mathrm{p}}=5000$\n- 步数：$N_{\\mathrm{steps}}=3000$\n- 预烧步数：$N_{\\mathrm{burn}}=500$\n- 初始条件：所有 $N_{\\mathrm{p}}$ 个粒子都从 $x_i(0)=0$ 开始。\n模拟过程是先将一个包含 $N_{\\mathrm{p}}$ 个粒子位置的向量初始化为零。然后，在 $N_{\\mathrm{steps}}$ 的每一步中，根据离散化方程并行更新位置。对于所有时间步 $n \\ge N_{\\mathrm{burn}}$，收集粒子位置 $x_i(t_n)$ 的样本。\n\n5. 概率计算\n\n在区间 $[-w/2, w/2]$（其中 $w=0.5x_0$）中找到粒子的精确概率由归一化稳态分布 $p_{\\mathrm{eq}}(x) = \\frac{1}{Z(\\nu,x_0)}p_{\\mathrm{unnorm}}(x)$ 的积分给出：\n$$P_{\\mathrm{exact}} = \\int_{-w/2}^{w/2} p_{\\mathrm{eq}}(x) dx = \\frac{1}{Z(\\nu,x_0)} \\int_{-w/2}^{w/2} \\left(1+\\left(\\frac{x}{x_0}\\right)^2\\right)^{-\\nu} dx$$\n该积分使用高精度数值积分计算。\n\n经验概率 $P_{\\mathrm{emp}}$ 是从模拟中估计的。丢弃预烧阶段后，我们总共有 $N_{\\mathrm{samples}} = N_{\\mathrm{p}} \\times (N_{\\mathrm{steps}}-N_{\\mathrm{burn}})$ 个位置样本。$P_{\\mathrm{emp}}$ 是这些样本中落在区间 $[-w/2, w/2]$ 内的比例。\n$$P_{\\mathrm{emp}} = \\frac{\\text{落在 } [-w/2, w/2] \\text{ 内的样本数}}{N_{\\mathrm{samples}}}$$\n\n6. 相对误差\n\n对于每个测试用例，经验概率和精确概率之间的相对误差 $\\varepsilon$ 计算如下：\n$$\\varepsilon = \\frac{|P_{\\mathrm{emp}}-P_{\\mathrm{exact}}|}{P_{\\mathrm{exact}}}$$\n为三个指定的参数集计算此量。最终的实现将为每个情况执行这些步骤并报告所得误差。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import special, integrate\n\ndef solve():\n    \"\"\"\n    Solves the Langevin dynamics problem for the three specified test cases.\n    It calculates the theoretical bin probability, runs a numerical simulation\n    to find the empirical probability, and computes the relative error.\n    \"\"\"\n    # Global simulation parameters\n    N_p = 5000\n    N_steps = 3000\n    N_burn = 500\n    seed = 12345\n\n    # Test suite: (a, x0, gamma, T)\n    test_cases = [\n        # Case A: Strong confinement (nu = 3.0)\n        (2.0, 1.0, 1.0, 2.0 / 3.0),\n        # Case B: Moderate confinement (nu = 1.0)\n        (2.0, 1.0, 1.0, 2.0),\n        # Case C: Near normalizability threshold (nu = 0.6)\n        (2.0, 1.0, 1.0, 10.0 / 3.0),\n    ]\n\n    results = []\n    for a, x0, gamma, T in test_cases:\n        # --- Theoretical Calculation ---\n        beta = 1.0 / T\n        nu = beta * a\n        w = 0.5 * x0\n\n        if nu = 0.5:\n            raise ValueError(f\"nu must be > 0.5 for normalizability, but got nu={nu}\")\n        \n        # Normalization constant Z(nu, x0)\n        Z = x0 * np.sqrt(np.pi) * special.gamma(nu - 0.5) / special.gamma(nu)\n\n        # Unnormalized stationary distribution p_unnorm(x)\n        def p_unnorm(x_val):\n            return (1.0 + (x_val / x0)**2)**(-nu)\n\n        # Exact probability P_exact\n        integral_val, _ = integrate.quad(p_unnorm, -w / 2.0, w / 2.0, epsabs=1e-12, epsrel=1e-12)\n        P_exact = integral_val / Z\n\n        # --- Numerical Simulation ---\n        dt = 0.005 * (gamma * x0**2) / a\n        sigma = np.sqrt(2.0 * T / gamma)\n        \n        def mu(x_vec):\n            # Drift term mu(x)\n            return -(2.0 * a * x_vec) / (gamma * (x0**2 + x_vec**2))\n\n        # Initialize simulation state\n        rng = np.random.default_rng(seed)\n        x_particles = np.zeros(N_p, dtype=np.float64)\n        \n        # Pre-allocate array for storing samples\n        num_samples_to_collect = (N_steps - N_burn) * N_p\n        all_samples = np.zeros(num_samples_to_collect, dtype=np.float64)\n        sample_idx_start = 0\n        \n        # Run simulation\n        for step in range(N_steps):\n            # Generate standard normal random variables\n            xi = rng.normal(size=N_p)\n            \n            # Update particle positions using Euler-Maruyama\n            x_particles += mu(x_particles) * dt + sigma * np.sqrt(dt) * xi\n            \n            # Collect samples after burn-in period\n            if step >= N_burn:\n                sample_idx_end = sample_idx_start + N_p\n                all_samples[sample_idx_start:sample_idx_end] = x_particles\n                sample_idx_start = sample_idx_end\n\n        # Empirical probability P_emp\n        N_in_bin = np.sum((all_samples >= -w / 2.0)  (all_samples = w / 2.0))\n        N_total = len(all_samples)\n        P_emp = N_in_bin / N_total\n\n        # --- Relative Error ---\n        relative_error = np.abs(P_emp - P_exact) / P_exact\n        results.append(relative_error)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join([f'{r:.6f}' for r in results])}]\")\n\nsolve()\n```"
        }
    ]
}