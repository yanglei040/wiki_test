## 引言
在[计算流体力学](@entry_id:747620)领域，直接求解[原始变量](@entry_id:753733)形式的[Navier-Stokes方程](@entry_id:161487)是分析[流体运动](@entry_id:182721)的常规途径。然而，对于[二维不可压缩流](@entry_id:136406)动，[流函数-涡量公式](@entry_id:755504)提供了一种更为优雅且计算高效的替代方案，它通过深刻的数学变换，将问题的核心聚焦于流体的旋转特性——[涡量](@entry_id:142747)。这种方法的核心优势在于它巧妙地绕开了原始变量法中处理[压力-速度耦合](@entry_id:155962)和保证[质量守恒](@entry_id:204015)的复杂性，将两个速度分量和一个压力未知数简化为两个标量场：流函数与[涡量](@entry_id:142747)。本文将系统地引导读者深入理解并应用这一强大工具。第一章“原理与机制”将奠定理论基础，详细推导[流函数](@entry_id:266505)与[涡量](@entry_id:142747)的定义、它们之间的[运动学](@entry_id:173318)关系（泊松方程）以及[涡量](@entry_id:142747)的动力学演化（[涡量输运方程](@entry_id:139098)），并探讨数值实现的关键技术。第二章“应用与交叉学科联系”将视野拓宽至真实世界，展示该公式如何分析从工程绕流到地球[海洋环流](@entry_id:180204)，乃至天体物理吸积盘等前沿科学问题，并揭示其与其他物理学科的深刻类比。最后，第三章“动手实践”将理论付诸行动，通过三个精心设计的编程练习，指导读者从零开始构建求解器，并解决日益复杂的物理问题。通过这三章的学习，读者不仅能掌握一种重要的计算方法，更能对涡量在[流体动力学](@entry_id:136788)中的核心地位形成全面而深刻的认识。

## 原理与机制

本章深入探讨[流函数-涡量](@entry_id:755503)方法的核心科学原理与计算机制。我们将首先建立[流函数](@entry_id:266505)（stream function）与[涡量](@entry_id:142747)（vorticity）的基本概念，揭示它们之间深刻的[运动学](@entry_id:173318)关系。随后，我们将推导[涡量输运方程](@entry_id:139098)，阐明[涡量](@entry_id:142747)场的动力学行为。最后，我们将详细讨论该方法的数值实现，包括离散化方案、边界条件处理、时间推进策略以及[泊松方程](@entry_id:143763)求解等关键技术环节，从而为读者提供一个将理论应用于实践的完整框架。

### [流函数-涡量公式](@entry_id:755504)化：一个基础视角

在[计算流体力学](@entry_id:747620)中，直接求解描述速度和压力的原始变量（primitive variable）的[Navier-Stokes方程](@entry_id:161487)是一种常见方法。然而，对于[二维不可压缩流](@entry_id:136406)动，[流函数-涡量](@entry_id:755503)（$\psi-\omega$）方法提供了一种极其优雅且高效的替代方案。该方法通过引入两个新的标量场——[流函数](@entry_id:266505)和[涡量](@entry_id:142747)——来重新表述控制方程，从而在根本上简化了问题的结构。

#### 引入流函数 ($\psi$)

[二维不可压缩流](@entry_id:136406)动的基本约束是[质量守恒](@entry_id:204015)，其[微分形式](@entry_id:146747)为[连续性方程](@entry_id:195013)：
$$ \frac{\partial u}{\partial x} + \frac{\partial v}{\partial y} = 0 $$
其中 $u$ 和 $v$ 分别是[速度矢量](@entry_id:269648) $\mathbf{u}$ 在 $x$ 和 $y$ 方向的分量。这个方程构成了一个对速度分量的约束，在数值求解中必须精确满足。

[流函数](@entry_id:266505) $\psi(x, y)$ 的引入，其目的正是为了自动地、恒等地满足这个约束。我们定义速度分量与流函数的关系如下：
$$ u = \frac{\partial \psi}{\partial y}, \quad v = - \frac{\partial \psi}{\partial x} $$
将这些定义代入[连续性方程](@entry_id:195013)，我们得到：
$$ \frac{\partial}{\partial x}\left(\frac{\partial \psi}{\partial y}\right) + \frac{\partial}{\partial y}\left(-\frac{\partial \psi}{\partial x}\right) = \frac{\partial^2 \psi}{\partial x \partial y} - \frac{\partial^2 \psi}{\partial y \partial x} \equiv 0 $$
对于任何足够光滑的函数 $\psi$，[混合偏导数](@entry_id:139334)的顺序无关（[Clairaut定理](@entry_id:139814)），因此上式恒等于零。这意味着，任何由流函数导出的速度场天然就是[无散度](@entry_id:190991)（divergence-free）的，即满足不可压缩连续性方程。

这种方法的主要优势在于它将两个未知速度分量（$u$ 和 $v$）合并成了一个单一的标量未知数 $\psi$ 。这不仅减少了变量的数量，更重要的是，它将一个约束方程（连续性方程）从求解系统中移除，代之以一个巧妙的定义。

流函数还具有直观的物理意义。在[二维流](@entry_id:266853)场中，**[流线](@entry_id:266815)（streamlines）**是处处与[速度矢量](@entry_id:269648)相切的曲线。可以证明，流函数 $\psi$ 为常数的等值线就是流场中的流线。此外，沿着任意一条不渗透的固体边界，法向速度为零，这意味着该边界本身就是一条流线。因此，在[流函数](@entry_id:266505)表述中，不渗透边界条件可以方便地设置为 $\psi = \text{常数}$ 。

#### 引入[涡量](@entry_id:142747) ($\omega$)

[涡量](@entry_id:142747)是一个描述流体微团局部旋转速率和方向的矢量场，定义为[速度场的旋度](@entry_id:183606)：
$$ \boldsymbol{\omega} = \nabla \times \mathbf{u} $$
对于在 $x-y$ 平面内的[二维流](@entry_id:266853)动，速度矢量为 $\mathbf{u} = (u, v, 0)$，[涡量矢量](@entry_id:187667)只有一个非零分量，即垂直于流动平面的 $z$ 分量：
$$ \omega_z = \frac{\partial v}{\partial x} - \frac{\partial u}{\partial y} $$
为简洁起见，在二维问题的讨论中，我们通常用标量 $\omega$ 来指代 $\omega_z$。涡量为正表示逆时针旋转，为负表示顺时针旋转。一个[无旋流动](@entry_id:159258)（irrotational flow）的[涡量](@entry_id:142747)处处为零。

#### [运动学](@entry_id:173318)关系：泊松方程

流函数和涡量这两个概念通过一个至关重要的运动学关系联系在一起。我们将[流函数](@entry_id:266505)的定义代入[涡量](@entry_id:142747)的表达式中：
$$ \omega = \frac{\partial}{\partial x}\left(-\frac{\partial \psi}{\partial x}\right) - \frac{\partial}{\partial y}\left(\frac{\partial \psi}{\partial y}\right) = -\left(\frac{\partial^2 \psi}{\partial x^2} + \frac{\partial^2 \psi}{\partial y^2}\right) $$
这引出了[流函数-涡量](@entry_id:755503)方法中的核心方程之一，一个[泊松方程](@entry_id:143763)（Poisson equation）：
$$ \nabla^2 \psi = -\omega $$
其中 $\nabla^2$ 是[拉普拉斯算子](@entry_id:146319)。这个关系是纯粹运动学的，不涉及任何动力学（如力或加速度）。它表明，给定一个涡量场[分布](@entry_id:182848) $\omega(x, y)$，原则上我们可以通过求解这个泊松方程来确定相应的流函数场 $\psi(x, y)$，进而求得整个无散速度场。

例如，考虑一个由流函数 $\psi(x, y) = K x^2 y^2$ 描述的流场，其中 $K$ 为常数。我们可以计算出其速度分量为 $u = 2Kx^2y$ 和 $v = -2Kxy^2$。进一步计算[涡量](@entry_id:142747)，我们得到 $\omega = \frac{\partial v}{\partial x} - \frac{\partial u}{\partial y} = (-2Ky^2) - (2Kx^2) = -2K(x^2+y^2)$。这与直接计算 $\psi$ 的[拉普拉斯算子](@entry_id:146319) $-\nabla^2\psi$ 的结果完全一致，验证了这个[运动学](@entry_id:173318)关系 。

### [涡量](@entry_id:142747)的动力学

我们已经建立了涡量和[流函数](@entry_id:266505)之间的静态联系。现在，我们需要一个描述涡量如何随[时间演化](@entry_id:153943)的方程，即[涡量](@entry_id:142747)的动力学方程。这个方程可以通过对[Navier-Stokes方程](@entry_id:161487)求旋度得到。对于一个密度为 $\rho$、[动力粘度](@entry_id:268228)为 $\mu$ 的不可压缩[牛顿流体](@entry_id:263796)，其[动量方程](@entry_id:197225)为：
$$ \frac{\partial \mathbf{u}}{\partial t} + (\mathbf{u} \cdot \nabla) \mathbf{u} = -\frac{1}{\rho}\nabla p + \frac{\mu}{\rho} \nabla^2 \mathbf{u} $$
其中 $p$ 是压力。对该方程两边取旋度 ($\nabla \times$)，并利用矢量恒等式，可以消去压力项（因为[梯度的旋度](@entry_id:274168)恒为零），最终得到**[涡量输运方程](@entry_id:139098)**：
$$ \frac{\partial \boldsymbol{\omega}}{\partial t} + (\mathbf{u} \cdot \nabla)\boldsymbol{\omega} = (\boldsymbol{\omega} \cdot \nabla)\mathbf{u} + \nu \nabla^2 \boldsymbol{\omega} $$
其中 $\nu = \mu/\rho$ 是**运动粘度（kinematic viscosity）**。

这个方程的各项具有明确的物理意义：
- $\frac{\partial \boldsymbol{\omega}}{\partial t}$: 涡量的当地时间变化率。
- $(\mathbf{u} \cdot \nabla)\boldsymbol{\omega}$: 涡量的**[对流](@entry_id:141806)（advection）**项，表示涡量场随流体一起运动。
- $(\boldsymbol{\omega} \cdot \nabla)\mathbf{u}$: **涡线拉伸与倾斜（vortex stretching and tilting）**项。在三维流动中，这个[源项](@entry_id:269111)至关重要，它描述了涡线因[速度梯度](@entry_id:261686)的作用而被拉伸或倾斜，从而改变涡量的强度。
- $\nu \nabla^2 \boldsymbol{\omega}$: 涡量的**粘性[扩散](@entry_id:141445)（viscous diffusion）**项。

#### [二维流](@entry_id:266853)动中的涡量动力学

在[二维流](@entry_id:266853)动中，[涡量输运方程](@entry_id:139098)得到了极大的简化。由于[涡量矢量](@entry_id:187667) $\boldsymbol{\omega} = (0, 0, \omega_z)$ 始终垂直于[速度矢量](@entry_id:269648)所在的 $x-y$ 平面，涡线拉伸项 $(\boldsymbol{\omega} \cdot \nabla)\mathbf{u} = \omega_z \frac{\partial}{\partial z}\mathbf{u}$ 恒为零，因为[二维流](@entry_id:266853)动的速度分量不随 $z$ 变化 。因此，二维[涡量输运方程](@entry_id:139098)变为：
$$ \frac{\partial \omega}{\partial t} + u\frac{\partial \omega}{\partial x} + v\frac{\partial \omega}{\partial y} = \nu \left( \frac{\partial^2 \omega}{\partial x^2} + \frac{\partial^2 \omega}{\partial y^2} \right) $$
或者写成更紧凑的形式：
$$ \frac{D\omega}{Dt} = \nu \nabla^2 \omega $$
其中 $\frac{D}{Dt}$ 是[物质导数](@entry_id:172646)。这个方程的形式是一个经典的[对流-扩散方程](@entry_id:144002)。它告诉我们，在[二维流](@entry_id:266853)动中，涡量就像一种[被动标量](@entry_id:191726)（passive scalar），它随着流体运动（[对流](@entry_id:141806)），同时由于粘性的作用而从高浓度区域向低浓度区域[扩散](@entry_id:141445)。

运动粘度 $\nu$ 在此扮演着**[动量扩散率](@entry_id:275614)（momentum diffusivity）**或**[涡量扩散](@entry_id:200917)率**的角色。它的单位是 $\mathrm{m^2/s}$，与热扩散率和[质量扩散](@entry_id:149532)率的单位相同。$\nu$ 的大小决定了涡量梯度被粘性抹平的速度 。粘性越小（雷诺数越高），[对流](@entry_id:141806)效应相对于[扩散](@entry_id:141445)效应就越占主导地位，[涡量](@entry_id:142747)场会倾向于形成更小尺度的结构。

### $\psi-\omega$ 方法：计算视角

[流函数-涡量](@entry_id:755503)方法将原始的[Navier-Stokes方程组](@entry_id:142275)（包含[动量方程](@entry_id:197225)和连续性方程）替换为以下两个耦合的标量方程：
1.  **[动力学方程](@entry_id:751029)（Dynamic Equation）**: [涡量输运方程](@entry_id:139098)，描述[涡量](@entry_id:142747) $\omega$ 如何演化。
2.  **[运动学方程](@entry_id:173032)（Kinematic Equation）**: [泊松方程](@entry_id:143763)，将 $\omega$ 与[流函数](@entry_id:266505) $\psi$ 联系起来。

#### 算法概览

一个典型的非定常[二维流](@entry_id:266853)动[数值模拟](@entry_id:137087)的时间步进循环如下：
1.  在时间步 $t^n$，已知该时刻的涡量场 $\omega^n$ 和流函数场 $\psi^n$（以及由 $\psi^n$ 导出的[速度场](@entry_id:271461) $\mathbf{u}^n$）。
2.  **求解动力学**: 利用[涡量输运方程](@entry_id:139098)，从 $\omega^n$ 计算出下一时刻的[涡量](@entry_id:142747)场 $\omega^{n+1}$。
3.  **求解[运动学](@entry_id:173318)**: 求解[泊松方程](@entry_id:143763) $\nabla^2 \psi^{n+1} = -\omega^{n+1}$，得到新的流函数场 $\psi^{n+1}$。
4.  利用新的[流函数](@entry_id:266505) $\psi^{n+1}$ 更新速度场 $\mathbf{u}^{n+1}$。
5.  更新边界条件（特别是[涡量](@entry_id:142747)边界条件，后文详述）。
6.  进入下一时间步，重复以上过程。

#### 相对于原始变量方法的优势

在二维问题中，$\psi-\omega$ 方法相比于求解速度-压力 $(u, v, p)$ 的原始变量方法，具有几个显著的计算优势 ：
- **变量更少**: 只需要求解两个[标量场](@entry_id:151443) ($\psi, \omega$)，而原始变量法需要三个 ($u, v, p$)。这通常意味着更低的内存占用。
- **自动满足连续性**: 如前所述，流函数的引入从根本上保证了[质量守恒](@entry_id:204015)，避免了[原始变量](@entry_id:753733)法中处理[压力-速度耦合](@entry_id:155962)和保证无散度场的复杂性（例如，无需使用[压力修正](@entry_id:753714)或投影算法）。
- **[计算效率](@entry_id:270255)**: 由于变量更少且方程结构可能更简单（例如，[压力泊松方程](@entry_id:137996)被[流函数](@entry_id:266505)[泊松方程](@entry_id:143763)取代），每个时间步的计算量在二维情况下通常更低。

#### 挑战与特殊考虑

尽管优势明显，该方法也面临独特的挑战，主要集中在边界条件和特定域的拓扑结构上。

- **涡量边界条件**: 物理边界条件通常是针对速度的（例如，在固壁上的[无滑移条件](@entry_id:275670) $u=0, v=0$），但[涡量输运方程](@entry_id:139098)需要[涡量](@entry_id:142747)的边界条件。如何从已知的速度（或[流函数](@entry_id:266505)）边界条件推导出正确的[涡量](@entry_id:142747)边界值，是该方法数值实现中最关键也最棘手的部分。

- **[多连通域](@entry_id:185277)（Multiply Connected Domains）**: 当流场区域存在内部“孔洞”（例如，绕机翼的流动）时，区域就变成了多连通的。在这种情况下，仅凭常规的边界条件，泊松方程 $\nabla^2 \psi = -\omega$ 的解不是唯一的。具体来说，解会相差一个与域拓扑相关的谐[波函数](@entry_id:147440)，导致物理上的不确定性。为了得到唯一的物理[可行解](@entry_id:634783)，必须施加一个额外的全局约束条件。这个条件就是绕内部边界（如机翼表面）的**环量（circulation）** $\Gamma = \oint \mathbf{u} \cdot d\mathbf{l}$ 的值 。环量的值通常由物理定律（如[Kutta条件](@entry_id:154337)）确定。

### 数值实现：机制

本节将讨论将连续的 $\psi-\omega$ 方程转化为可计算的[代数方程](@entry_id:272665)组的具体机制。

#### [空间离散化](@entry_id:172158)

[有限差分法](@entry_id:147158)（Finite Difference Method）是离散化这些[偏微分方程](@entry_id:141332)的常用工具。在一个均匀的方形网格上，网格点用索引 $(i, j)$ 表示，对应坐标 $(x_i, y_j) = (ih, jh)$，其中 $h$ 是网格间距。

[流函数](@entry_id:266505)[泊松方程](@entry_id:143763) $\nabla^2 \psi = -\omega$ 的离散化是核心步骤。使用标准的[二阶中心差分](@entry_id:170774)格式，在点 $(i, j)$ 处的拉普拉斯算子可以近似为：
$$ \nabla^2 \psi \bigg|_{(i,j)} \approx \frac{\psi_{i+1,j} + \psi_{i-1,j} + \psi_{i,j+1} + \psi_{i,j-1} - 4\psi_{i,j}}{h^2} $$
因此，离散的[泊松方程](@entry_id:143763)为：
$$ \frac{\psi_{i+1,j} + \psi_{i-1,j} + \psi_{i,j+1} + \psi_{i,j-1} - 4\psi_{i,j}}{h^2} = -\omega_{i,j} $$
这个方程将每个网格点上的[流函数](@entry_id:266505)值 $\psi_{i,j}$ 与其四个近邻点的[流函数](@entry_id:266505)值以及该点的[涡量](@entry_id:142747)值联系起来。如果 $\omega$ 已知，这就构成了一个大型的稀疏[线性方程组](@entry_id:148943) 。

类似地，[涡量输运方程](@entry_id:139098)中的[对流](@entry_id:141806)项和[扩散](@entry_id:141445)项也需要离散化。[扩散](@entry_id:141445)项 $\nu \nabla^2 \omega$ 通常也使用上述的五点[中心差分格式](@entry_id:747203)。[对流](@entry_id:141806)项 $\mathbf{u} \cdot \nabla \omega$ 的离散化则更为微妙，因为简单的中心差分在高雷诺数下可能导致[数值不稳定性](@entry_id:137058)。因此，常常采用**[一阶迎风格式](@entry_id:749417)（first-order upwind scheme）**或更高阶的格式来保证稳定性 。

#### [涡量](@entry_id:142747)边界条件的处理

这是实现 $\psi-\omega$ 方法的关键。考虑一个位于 $y=0$ 的静止固壁。无滑移和不渗透条件意味着 $u(x,0)=0$ 和 $v(x,0)=0$。
- $v=0 \implies -\partial_x\psi=0 \implies \psi(x,0)=\text{常数}$。我们可以方便地设 $\psi=0$。
- $u=0 \implies \partial_y\psi=0$。

我们需要的[壁面涡量](@entry_id:146608) $\omega_w$ 可由其定义得到：$\omega_w = -(\nabla^2 \psi)_w = -(\psi_{xx} + \psi_{yy})_w$。由于在壁面上 $\psi$ 是常数，$\psi_{xx}=0$，因此 $\omega_w = -(\psi_{yy})_w$。问题在于如何在离散框架下利用已知的 $\psi$ 值来计算这个二阶[法向导数](@entry_id:169511)。

这通常通过在壁面附近对 $\psi$ 进行泰勒展开来实现。多种近似公式由此产生，它们的精度和复杂性各不相同 。

- **Thom公式（[一阶精度](@entry_id:749410)）**: 这是最简单也最常用的公式。它只利用壁面和第一个内层网格点的[流函数](@entry_id:266505)值。对于 $y=0$ 的壁面，其形式为：
  $$ \omega_w = -\frac{2(\psi_1 - \psi_w)}{h^2} $$
  其中 $\psi_w$ 是壁面上的[流函数](@entry_id:266505)值（通常为0），$\psi_1$ 是距离壁面 $h$ 处的第一个内部网格点上的流函数值。这个公式虽然只有[一阶精度](@entry_id:749410)，但因其简单性和鲁棒性而被广泛使用 。

- **更高阶公式（[二阶精度](@entry_id:137876)）**: 为了提高整体解的精度，可以使用更高阶的[壁面涡量](@entry_id:146608)公式。
  - **[Jensen公式](@entry_id:172932)**: 该公式结合了Thom公式和第一个内部网格点的涡量值 $\omega_1$，通过[线性组合](@entry_id:154743)来消除一阶误差项。
  - **Woods公式**: 该公式不使用内部涡量，而是利用壁面外两层网格点的[流函数](@entry_id:266505)值（$\psi_1, \psi_2$）来构造一个二阶精度的差分格式。
  这些更高阶的公式可以显著改善解的准确性，但实现起来也更复杂 。

#### [时间离散化](@entry_id:169380)与稳定性

对于非定常问题，[涡量输运方程](@entry_id:139098)需要进行[时间离散化](@entry_id:169380)。常用的方法包括：
- **[显式欧拉法](@entry_id:141307)（Explicit Euler）**: 将所有空间导数都在已知时间层 $t^n$ 计算。这种方法实现简单，但受到严格的稳定性条件限制。对于[对流-扩散方程](@entry_id:144002)，时间步长 $\Delta t$ 必须同时满足基于[对流](@entry_id:141806)的[Courant-Friedrichs-Lewy (CFL) 条件](@entry_id:747986)和基于[扩散](@entry_id:141445)的条件：
  $$ \Delta t \le \min\left\{ \frac{h}{U_{\max}}, \frac{h^2}{2\nu} \right\} \quad (\text{在1D情况下}) $$
  在高[雷诺数](@entry_id:136372)（$\nu$ 很小）情况下，[对流](@entry_id:141806)[CFL条件](@entry_id:178032)通常是主导限制 。

- **[隐式方法](@entry_id:137073)（Implicit Methods）**: 例如，[Crank-Nicolson方法](@entry_id:748041)将空间导数在 $t^n$ 和 $t^{n+1}$ 两个时间层的平均值处进行计算。对于线性[扩散](@entry_id:141445)项，Crank-Nicolson是无条件稳定的，这意味着 $\Delta t$ 不受[扩散](@entry_id:141445)项的限制。这对于低雷诺数或需要精确解析粘性子层的情况非常有利。然而，如果[对流](@entry_id:141806)项仍然采用显式处理（一种半隐式方案），则整个方案的稳定性仍然受[CFL条件](@entry_id:178032)限制。因此，在[高雷诺数流](@entry_id:199822)动中，使用更复杂的[隐式格式](@entry_id:166484)在时间步长上带来的优势可能并不显著 。

#### 求解泊松方程

在每个时间步，最耗费计算资源的步骤通常是求解离散的[流函数](@entry_id:266505)[泊松方程](@entry_id:143763) $\nabla^2 \psi = -\omega$。这个方程构成了一个大型的、稀疏的线性代数方程组 $A\mathbf{x}=\mathbf{b}$，其中 $\mathbf{x}$ 是所有内部网格点上未知 $\psi$ 值的向量。求解这个[方程组](@entry_id:193238)的效率直接决定了整个模拟的性能。主要有两类求解器 ：

- **[迭代法](@entry_id:194857)（Iterative Methods）**: 如[Jacobi法](@entry_id:147508)、[Gauss-Seidel法](@entry_id:145727)、连续过松弛法（SOR）以及[共轭梯度法](@entry_id:143436)（CG）。这些方法从一个初始猜测开始，通过一系列迭代逐步逼近真实解。它们的优点是内存占用小，易于实现。缺点是[收敛速度](@entry_id:636873)可能很慢，特别是对于大规模问题，并且收敛所需的迭代次数通常随网格规模 $N$ 的增大而增加。例如，对于一个 $N \times N$ 的网格，使用[预处理共轭梯度法](@entry_id:753674)（PCG）的计算成本可能按 $O(N^3)$ 的比例增长。

- **直接法（Direct Methods）**: 如基于高斯消元的稀疏LU或[Cholesky分解](@entry_id:147066)。这些方法通过一次性的矩阵分解（例如，将矩阵 $A$ 分解为下三角和[上三角矩阵](@entry_id:150931)的乘积），然后通过快速的向前和向后替换来求解。对于一个固定的网格，矩阵 $A$ 不随时间变化，因此昂贵的分解步骤只需在模拟开始时执行一次。在随后的每个时间步中，只需要执行快速的替换求解。
  - **权衡**: 直接法具有高昂的初始分解成本（对于二维 $N \times N$ 网格，成本约为 $O(N^3)$），但每个时间步的求解成本非常低（约为 $O(N^2 \log N)$）。[迭代法](@entry_id:194857)则没有初始成本，但每个时间步的成本相对较高（约为 $O(N^3)$）。
  - **选择**: 因此，存在一个临界的模拟时间步数 $M^*$。如果总的模拟步数 $M$ 大于 $M^*$，那么分摊到每个时间步的分解成本就足够低，使得直接法的平均每步成本低于[迭代法](@entry_id:194857)。反之，对于短时模拟或只需要求解一次的问题（如[稳态](@entry_id:182458)问题的一次迭代），[迭代法](@entry_id:194857)通常更快 。当网格规模 $N$ 变得非常大时，如果模拟步数 $M$ 足够多，直接法的优越渐进扩展性（$O(N^2 \log N)$ vs $O(N^3)$）使其成为更快的选择。

综上所述，[流函数-涡量](@entry_id:755503)方法通过巧妙的数学变换，为[二维不可压缩流](@entry_id:136406)动提供了一个强大而高效的计算框架。然而，其成功的数值实现依赖于对一系列关键机制的深入理解和审慎处理，特别是[涡量](@entry_id:142747)边界条件的设定和大规模[线性方程组](@entry_id:148943)的高效求解。