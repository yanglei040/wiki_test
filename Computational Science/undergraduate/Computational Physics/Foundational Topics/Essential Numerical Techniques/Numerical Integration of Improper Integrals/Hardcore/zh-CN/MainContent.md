## 引言
在计算物理及诸多科学与工程领域中，积分是描述和量化累积效应的核心数学工具。然而，许多实际问题所导出的积分并非总是在有限区间上的良态函数，它们往往涉及无穷大的积分范围或在积分区间内存在[奇异点](@entry_id:199525)，这类积分被称为**[反常积分](@entry_id:145029)**。标准的[数值积分方法](@entry_id:141406)，如[梯形法则](@entry_id:145375)或[辛普森法则](@entry_id:142987)，在直接应用于这些问题时会失效或产生巨大误差，这构成了计算科学中的一个基本挑战。

本文旨在系统地解决这一问题，为读者提供一套处理[反常积分](@entry_id:145029)的强大数值工具箱。我们将深入探讨这些看似棘手的积分背后的数学原理，并学习如何通过巧妙的计算策略来精确、高效地求得其值。文章将分为三个核心部分：

首先，在“**原理与机制**”一章中，我们将详细剖析处理[无穷积分](@entry_id:145029)区间和函数[奇异点](@entry_id:199525)的核心技术，包括截断法、变量替换、[高斯求积](@entry_id:146011)以及[奇点](@entry_id:137764)移除等方法。接着，在“**应用与跨学科联系**”一章中，我们将通过来自经典力学、量子物理、统计学、[金融数学](@entry_id:143286)等多个领域的丰富案例，展示这些数值方法如何将抽象的理论模型转化为可计算、可验证的实际结果。最后，在“**动手实践**”部分，我们将通过一系列精心设计的编程练习，引导读者亲手实现并应用所学知识，从而将理论理解内化为真正的计算能力。

## 原理与机制

在上一章的引言中，我们了解了数值积分的基本概念及其在物理学中的广泛应用。然而，许[多源](@entry_id:170321)于物理模型的积分并非总是在有限区间上对光滑、[有界函数](@entry_id:176803)进行。当积分区间为无穷，或者当被积函数在积分区间内的某一点或端点处变得无界时，我们就遇到了所谓的**[反常积分](@entry_id:145029) (improper integrals)**。本章将深入探讨处理这些[反常积分](@entry_id:145029)的原理与核心机制。我们将看到，通过一系列精巧的分析和计算技巧，即便是那些看似难以处理的积分，也能够被精确、高效地数值求解。

### [第一类反常积分](@entry_id:160839)：无穷区间上的积分

物理学中，许多积分的定义域是无穷的，例如计算总能量、[总散射截面](@entry_id:168963)或某些[统计力](@entry_id:194984)学中的[配分函数](@entry_id:193625)。这类积分形式为 $\int_a^\infty f(x) dx$、$\int_{-\infty}^b f(x) dx$ 或 $\int_{-\infty}^\infty f(x) dx$。由于数值方法本质上只能处理有限区间，我们必须采用特定策略来应对无穷大的积分限。

#### 截断法：基本思想与[误差控制](@entry_id:169753)

处理无穷区间最直接的方法是**截断法 (truncation method)**。其核心思想是将无穷区间截断为一个有限区间和一个“尾部”，然后分别处理：
$$
\int_a^\infty f(x) dx = \int_a^T f(x) dx + \int_T^\infty f(x) dx
$$
其中，$T$ 是一个足够大的正数，称为**截断点 (cutoff point)**。第一项是在有限区间 $[a, T]$ 上的定积分，可以用标准的[数值积分方法](@entry_id:141406)（如自适应辛普森法或[高斯求积](@entry_id:146011)）来计算。第二项，即**尾部积分 (tail integral)**，构成了**[截断误差](@entry_id:140949) (truncation error)**。

此方法的关键在于如何选择截断点 $T$，以确保截断误差小于预设的容差 $\varepsilon_{\text{tail}}$。这通常需要对被积函数 $f(x)$ 在 $x \to \infty$ 时的行为进行分析。

作为一个具体的例子，考虑计算一个由函数 $y=\exp(-ax)$（其中 $a>0$）绕 $x$ 轴旋转所形成的旋转体的体积 。该体积由以下[反常积分](@entry_id:145029)给出：
$$
V = \int_0^\infty \pi [y(x)]^2 dx = \pi \int_0^\infty \exp(-2ax) dx
$$
为了数值计算此积分，我们将其截断在 $T$ 点。截断误差为尾部积分：
$$
E_{\text{tail}}(T) = \pi \int_T^\infty \exp(-2ax) dx
$$
尽管在设计数值算法时不应依赖于被积函数本身的原函数，但我们可以利用原函数来*分析*误差。此处的尾部积分可以解析地求出：
$$
E_{\text{tail}}(T) = \pi \left[ -\frac{1}{2a} \exp(-2ax) \right]_T^\infty = \frac{\pi}{2a} \exp(-2aT)
$$
如果我们要求截断误差的[绝对值](@entry_id:147688)不超过 $\varepsilon_{\text{tail}}$，即 $E_{\text{tail}}(T) \le \varepsilon_{\text{tail}}$，则可以解出对 $T$ 的要求：
$$
\frac{\pi}{2a} \exp(-2aT) \le \varepsilon_{\text{tail}} \implies T \ge \frac{1}{2a} \ln\left(\frac{\pi}{2a \varepsilon_{\text{tail}}}\right)
$$
通过选择满足此条件的最小 $T$，我们就可以将总误差预算的一部分精确地分配给[截断误差](@entry_id:140949)。随后，我们只需使用一个可靠的[自适应求积](@entry_id:144088)程序，在 $[0, T]$ 区间上计算积分，并保证其[数值误差](@entry_id:635587)小于另一部分误差预算。这种“[分而治之](@entry_id:273215)”的[误差控制](@entry_id:169753)策略是数值计算中的一个基本原则。

#### 利用渐近知识加速收敛：[理查森外推法](@entry_id:137237)

对于许多函数，特别是那些衰减速度不是非常快（例如，按多项式而非指数衰减）的函数，截断法可能需要非常大的 $T$ 值才能达到高精度，导致计算成本高昂。在这种情况下，如果我们知道截断误差 $E(T)$ 作为 $T \to \infty$ 的渐近形式，就可以使用**[理查森外推法](@entry_id:137237) (Richardson extrapolation)** 来显著加速收敛。

该方法的基本思想是，将数值计算得到的截断积分 $S(T) = \int_a^T f(x) dx$ 视为[真值](@entry_id:636547) $I$ 的一个近似，其误差可以表示为一个关于 $T$ 的[渐近级数](@entry_id:168392)：
$$
S(T) = I - E(T) \approx I - \left( c_1 \phi_1(T) + c_2 \phi_2(T) + \dots \right)
$$
其中 $\phi_i(T)$ 是已知的函数（称为[基函数](@entry_id:170178)），而 $c_i$ 是未知的常数。通过在几个不同的截断点 $T_1, T_2, \dots, T_n$ 处计算 $S(T_i)$，我们可以建立一个[线性方程组](@entry_id:148943)，求解出更精确的 $I$ 以及系数 $c_i$。

我们以高斯积分 $I = \int_0^\infty \exp(-x^2) dx$ 为例 。其截断积分为 $S(L) = \int_0^L \exp(-x^2) dx$。通过[分部积分](@entry_id:136350)可以证明，其截断误差 $E(L) = I - S(L)$ 具有如下的[渐近展开](@entry_id:173196)：
$$
E(L) = \int_L^\infty \exp(-x^2) dx \sim \frac{\exp(-L^2)}{2L} \left( 1 - \frac{1}{2L^2} + \frac{3}{4L^4} - \dots \right)
$$
因此，截断积分 $S(L)$ 可以近似地写成：
$$
S(L) \approx I - K_0 \frac{\exp(-L^2)}{L} - K_1 \frac{\exp(-L^2)}{L^3} - \dots
$$
如果我们只考虑前导误差项，[模型简化](@entry_id:171175)为 $S(L) \approx I - K_0 \frac{\exp(-L^2)}{L}$。通过在两个不同的截断点 $L_1$ 和 $L_2$ 计算 $S(L_1)$ 和 $S(L_2)$，我们得到一个关于两个未知数 $I$ 和 $K_0$ 的[线性方程组](@entry_id:148943)。求解该[方程组](@entry_id:193238)可以得到 $I$ 的一个更高精度的估计。如果使用更多的截断点和更多的误差项，就可以系统地消除更高阶的误差，获得更精确的结果。

[理查森外推法](@entry_id:137237)的一个更精妙的应用是处理那些本身发散、但其物理上有意义的量（如势能差）是有限的积分。例如，计算无限长带电直线的[静电势](@entry_id:188370)差 。单个点的[电势](@entry_id:267554)积分 $I(a) = \int_{-\infty}^\infty \frac{dx}{\sqrt{x^2+a^2}}$ 是对数发散的。然而，两个不同横向距离 $a_1$ 和 $a_2$ 处的势差是有限的。通过分析截断积分之差 $\Delta(T; a_1, a_2) = I(a_1; T) - I(a_2; T)$，可以发现其渐近行为为：
$$
\Delta(T; a_1, a_2) = \Delta_\infty + \frac{C}{T^2} + O(T^{-4})
$$
其中 $\Delta_\infty = \lim_{T\to\infty} \Delta(T; a_1, a_2)$ 是我们要求的有限势差。这种 $T^{-2}$ 的收敛行为使其成为理查森外推的理想应用场景，只需计算两个不同 $T$ 值的 $\Delta(T)$，即可得到一个对 $\Delta_\infty$ 的大大改进的估计。

#### 针对无穷区间的特殊积分方法

除了通用方法外，还存在为特定形式的无穷区间积分设计的专用[求积法则](@entry_id:753909)，即**[高斯求积](@entry_id:146011) (Gaussian quadrature)**。这类方法的核心思想是通过精心选择[积分节点和权重](@entry_id:146264)，来精确地计算被积函数与某个特定**权重函数 (weight function)** $W(x)$ 的乘积的积分。

- **[高斯-拉盖尔求积](@entry_id:142563) (Gauss-Laguerre quadrature)** 专门用于计算形如 $\int_0^\infty e^{-x} f(x) dx$ 的积分。它通过 $n$ 个节点和权重，可以精确计算所有次数不高于 $2n-1$ 的多项式 $f(x)$ 的积分。在物理问题中，如果被积函数包含一个指数衰减因子，通过[变量替换](@entry_id:141386)将其化为标准形式，使用[高斯-拉盖尔求积](@entry_id:142563)会异常高效。例如，在计算三维空间中带屏蔽的[库仑势](@entry_id:154276)的总积分 $\iiint \frac{e^{-r/a}}{r} dV$ 时 ，将积分分离变量后，径向部分会得到一个形如 $\int_0^\infty r e^{-r/a} dr$ 的积分。通过简单的变量替换 $x=r/a$，它就变成了 $a^2 \int_0^\infty x e^{-x} dx$，这正是[高斯-拉盖尔求积](@entry_id:142563)的用武之地。由于此处的 $f(x)=x$ 只是一个一次多项式，甚至仅用一个积分节点就能得到精确结果。

- **[高斯-埃尔米特求积](@entry_id:145090) (Gauss-Hermite quadrature)** 专门用于计算形如 $\int_{-\infty}^\infty e^{-x^2} f(x) dx$ 的积分。这在处理[高斯函数](@entry_id:261394)相关的积分时非常有用，例如在[高斯波包](@entry_id:151158)的演化、[量子谐振子](@entry_id:140678)或高斯[随机变量](@entry_id:195330)的[统计计算](@entry_id:637594)中。考虑计算[高斯函数的傅里叶变换](@entry_id:260759) ，其积分形式为 $\int_{-\infty}^\infty e^{-ax^2} \cos(kx) dx$。通过变量替换 $u = \sqrt{a}x$，积分可以化为 $\frac{1}{\sqrt{a}} \int_{-\infty}^\infty e^{-u^2} \cos(\frac{k}{\sqrt{a}}u) du$。被积函数 $f(u) = \cos(\frac{k}{\sqrt{a}}u)$ 是一个光滑的[解析函数](@entry_id:139584)，因此[高斯-埃尔米特求积](@entry_id:145090)对此类积分表现出指数级的收敛速度。然而，值得注意的是，当振荡频率（由参数 $k/\sqrt{a}$ 控制）增加时，为了保持固定的精度，所需的求积节点数 $n$ 必须与频率成正比增长，这是所有通用求积方法在处理[振荡](@entry_id:267781)函数时共同面临的挑战。

### [第二类反常积分](@entry_id:161424)：含[奇异点](@entry_id:199525)的积分

另一类[反常积分](@entry_id:145029)涉及在有限区间 $[a,b]$ 上对一个函数进行积分，但该函数在区间的某个或多个点（包括端点）上无界，即存在**[奇异点](@entry_id:199525) (singular point)**。

#### [奇异点](@entry_id:199525)的分类与收敛性判据

在处理[奇异积分](@entry_id:167381)之前，必须判断积分是否收敛。一个关键的工具是**p-判别法 (p-test)**：对于在 $x=a$ 附近行为类似于 $|x-a|^{-p}$ 的函数，其在包含 $a$ 点的区间上的[积分收敛](@entry_id:139742)当且仅当 $p  1$。
- 如果 $p \ge 1$，积分发散，数值方法无法求得一个有限值（除非在[柯西主值](@entry_id:192761)的意义下，但这超出了常规积分的范畴）。
- 如果 $p  1$，[积分收敛](@entry_id:139742)，称为**可积[奇异点](@entry_id:199525) (integrable singularity)**。我们的目标就是数值计算这些收敛的[奇异积分](@entry_id:167381)。

一个有趣的应用是，我们可以通过乘以因子 $(x-a)^k$ 来“驯服”一个奇异性 。如果一个函数 $f(x)$ 在 $x=a$ 处的奇异性为 $|x-a|^{-\alpha}$，那么积分 $\int (x-a)^k f(x) dx$ 的奇异性就变为 $|x-a|^{k-\alpha}$。根据 p-判别法，[积分收敛](@entry_id:139742)的条件是 $\alpha - k  1$，即 $k > \alpha - 1$。通过寻找满足此条件的最小非负整数 $k$，我们可以确定需要多强的“正则化”因子才能使[积分收敛](@entry_id:139742)。

#### 处理可去[奇异点](@entry_id:199525)

最简单的一类[奇异点](@entry_id:199525)是**可去[奇异点](@entry_id:199525) (removable singularities)**。此时，被积函数在[奇异点](@entry_id:199525) $x_0$ 处的极限存在且有限，即 $\lim_{x \to x_0} f(x) = L$。例如，函数 $f(x) = \frac{\sin x}{x}$ 在 $x=0$ 处，其极限为1。

表面上看，这类积分似乎没有问题。然而，在数值计算中直接对原始表达式求值可能会导致严重的数值不稳定性。当 $x$ 非常接近 $x_0$ 时，分子和分母可能同时趋于零，形成 $0/0$ 的[不定式](@entry_id:144301)。浮点运算的精度限制会导致**灾难性抵消 (catastrophic cancellation)**，产生巨大的相对误差。

考虑计算德拜函数 $D_n(x) = \frac{n}{x^n} \int_0^x \frac{t^n}{e^t-1} dt$ 。被积函数 $f(t) = \frac{t^n}{e^t-1}$ 在 $t=0$ 处是一个 $0/0$ 的[不定式](@entry_id:144301)。直接计算 $e^t-1$ 在 $t$ 很小时会损失精度。一个健壮的解决方法是利用函数在[奇异点](@entry_id:199525)附近的**泰勒级数展开**。对于 $e^t - 1 = t + \frac{t^2}{2!} + \dots$，我们可以得到 $\frac{t}{e^t-1} = 1 - \frac{t}{2} + \frac{t^2}{12} + \dots$。因此，$\frac{t^n}{e^t-1} = t^{n-1} - \frac{t^n}{2} + \dots$。当 $t$ 在一个靠近0的小区间内时，我们可以使用这个级数来计算函数值，从而避免不稳定的减法操作，保证[数值精度](@entry_id:173145)。这种基于[级数展开](@entry_id:142878)的局部近似是处理可去[奇异点](@entry_id:199525)的标准技巧。类似地，在计算某个正则化的[傅里叶变换](@entry_id:142120)时 ，也会遇到形如 $(\cos(kx)-1)/k$ 的项，其在 $k=0$ 处的极限为0，也需要通过级数展开来保证[数值稳定性](@entry_id:146550)。

#### 通过变量替换实现正则化

对于不可移除的（但可积的）代数[奇异点](@entry_id:199525)，例如 $x^{-1/2}$ 在 $x=0$ 处，最强大和通用的技术之一是通过**[变量替换](@entry_id:141386) (change of variables)** 来消除奇异性。其思想是设计一个新的[坐标系](@entry_id:156346)，使得变换的雅可比行列式恰好抵消被积函数的奇异部分。

考虑一类具有端点奇异性的积分 ：
$$
I = \int_a^b (x-a)^{\alpha-1} \psi(x) dx
$$
其中 $\alpha \in (0, 1)$ 导致在 $x=a$ 处有奇异性，而 $\psi(x)$ 是光滑函数。我们可以引入变量替换 $x-a = u^m$。那么 $dx = m u^{m-1} du$。被积函数的奇异部分变为：
$$
(x-a)^{\alpha-1} dx = (u^m)^{\alpha-1} (m u^{m-1} du) = m u^{m(\alpha-1)} u^{m-1} du = m u^{m\alpha - 1} du
$$
为了让变换后的被积函数在 $u=0$ 处是光滑的，我们希望指数 $m\alpha-1$ 为一个非负整数。最简单的选择是令其为0，即 $m\alpha-1 = 0 \implies m = 1/\alpha$。因此，采用[变量替换](@entry_id:141386) $x = a + u^{1/\alpha}$，原来的积分就变换为：
$$
I = \int_0^{(b-a)^\alpha} \psi(a+u^{1/\alpha}) \frac{1}{\alpha} du
$$
新的被积函数在 $u=0$ 处是完全光滑的，其值为 $\frac{1}{\alpha}\psi(a)$。现在，这个正则化的积分可以用任何标准的高阶求积方法（如[高斯-勒让德求积](@entry_id:138201)）高效地计算。这种技术是极其强大的，它将一个“坏”的被积函数变成了一个“好”的被积函数。

这种方法的有效性也可以从另一个角度理解。考虑计算自由度为1的卡方分布的均值 。其被积函数包含 $x^{1/2}$ 因子，其导数在 $x=0$ 处是奇异的。这破坏了辛普森等[高阶方法](@entry_id:165413)所依赖的[函数光滑性](@entry_id:161935)假设，导致收敛速度从理论上的 $O(N^{-4})$ 急剧下降到 $O(N^{-3/2})$。而通过变量替换 $x=z^2$，积分 $\int_0^\infty x^{1/2} e^{-x/2} dx$ 变换为与 $\int_{-\infty}^\infty z^2 e^{-z^2/2} dz$ 相关的形式。新的被积函数 $z^2 e^{-z^2/2}$ 在全域都是无限次可微的（$C^\infty$），因此[辛普森法](@entry_id:142987)可以恢复其 $O(N^{-4})$ 的高收敛阶。这清晰地表明，变量替换不仅消除了函数值的奇异性，更重要的是恢复了函数及其导数的光滑性，这是[高阶数值方法](@entry_id:142601)高效工作的关键。

许多高质量的[科学计算](@entry_id:143987)库（如 `scipy.integrate.quad`）在内部实现中就集成了类似的变量替换技术，使其能够自动处理许多常见的端点奇异性 。

#### 通过减去奇异项实现正则化

处理奇异性的另一种常用方法是**减去奇异项 (singularity subtraction)**。如果我们将被积函数 $f(x)$ 分解为一个我们能够解析积分的奇异部分 $f_{\text{sing}}(x)$ 和一个行为良好的剩余部分 $f_{\text{reg}}(x) = f(x) - f_{\text{sing}}(x)$，那么：
$$
\int_a^b f(x) dx = \int_a^b f_{\text{reg}}(x) dx + \int_a^b f_{\text{sing}}(x) dx
$$
我们可以数值计算第一项（现在是正则的），并解析地计算第二项。然而，这个方法有一个重大的数值陷阱。直接计算 $f(x) - f_{\text{sing}}(x)$ 可能会导致灾难性抵消，因为当 $x$ 接近[奇异点](@entry_id:199525)时，这两项都很大且几乎相等 。与处理可去[奇异点](@entry_id:199525)一样，正确的做法是利用泰勒展开来得到一个稳定的 $f_{\text{reg}}(x)$ 的表达式。例如，在处理积分 $\int_0^\pi \frac{x}{\sin x} dx$ 时，为了消除 $x=\pi$ 处的奇异性，我们减去 $\frac{\pi}{\pi-x}$。直接计算 $\frac{x}{\sin x} - \frac{\pi}{\pi-x}$ 在 $x \approx \pi$ 时会损失所有有效数字。而通过在 $t=\pi-x$ 附近展开，我们发现 $r(x) = -1 + \frac{\pi}{6}t + O(t^2)$，这是一个在 $t=0$ 附近稳定且精确的表达式。

#### 处理[间断点](@entry_id:144108)

**[跳跃间断](@entry_id:139886)点 (jump discontinuities)** 是最简单的非光滑行为之一。如果被积函数在某点 $c \in (a, b)$ 处有一个跳跃，正确的处理方法是**将积分区间在该点分割开来**：
$$
\int_a^b f(x) dx = \int_a^c f(x) dx + \int_c^b f(x) dx
$$
然后对两个子区间分别进行数值积分。一个典型的物理例子是计算硬球气体的第二维里系数 $B_2$ 。其对应的迈耶函数 $f(r)$ 在硬球直径 $r=\sigma$ 处从-1跳跃到0。因此，积分必须在 $r=\sigma$ 处分割，将一个无穷区间上的积分简化为一个在 $[0, \sigma]$ 上的简单[定积分](@entry_id:147612)。

#### 高级策略与[多维积分](@entry_id:184252)

当积分区间两端都有[奇异点](@entry_id:199525)时，例如 $\int_0^\pi (\sin x)^{-1/2} dx$ ，我们可以采用两种策略。一是将区间在中间点（如 $\pi/2$）分割，然后对每个子区间使用前面讨论的单端点[变量替换](@entry_id:141386)法（例如在 $[0, \pi/2]$ 上用 $x=u^2$ 的思想）。二是寻找一个全局的[变量替换](@entry_id:141386)，一次性处理掉两个[奇异点](@entry_id:199525)。对于这个例子，一个合适的全局替换是 $t = \cos^2 x$（或类似的[三角函数](@entry_id:178918)变换），可以将积分转化为一个具有[雅可比](@entry_id:264467)权重的积分，然后使用专用的**[高斯-雅可比求积](@entry_id:197831) (Gauss-Jacobi quadrature)** 来高效求解。

这些思想可以推广到[多维积分](@entry_id:184252)。一个常见的挑战是**顶点奇异性 (vertex singularity)**，例如在单位正方形上积分 $\iint \frac{g(x,y)}{\sqrt{x^2+y^2}} dx dy$ 。[奇异点](@entry_id:199525)在原点 $(0,0)$。一个强大的技术是所谓的**杜菲变换 (Duffy transformation)**。通过将积分区域（单位正方形）分割成两个三角形（例如沿 $y=x$ 分割），然后在每个三角形上应用不同的坐标变换（例如，在 $y \le x$ 的区域使用 $x=u, y=uv$），可以使变换的雅可比行列式（在这个例子中是 $u$）精确地消除奇异的分母 $\sqrt{x^2+y^2} \sim u$。这使得变换后的积分在新的坐标 $(u,v)$ 下是完全正则的，可以应用标准的多维[求积法则](@entry_id:753909)。

### 预处理的艺术：选择最佳积分表示

最后，必须强调的是，在启动任何[数值求积](@entry_id:136578)程序之前，进行明智的**代数预处理 (algebraic pre-processing)** 往往能起到事半功倍的效果。[数值积分](@entry_id:136578)的效率和准确性极大地依赖于被积函数的“友好”程度——即它的光滑性、非[振荡](@entry_id:267781)性和衰减速度。

一个绝佳的例子是计算积分 $I=\int_{0}^{\infty}\frac{\sin^{2}(x)}{x^{2}}\,dx$ 。通过[分部积分](@entry_id:136350)，可以将其变换为[狄利克雷积分](@entry_id:204256) $\int_0^\infty \frac{\sin(2x)}{x} dx$。然而，后者的被积函数衰减缓慢（$1/x$）且剧烈[振荡](@entry_id:267781)，对通用数值方法（如截断的辛普森法）非常不友好。相比之下，使用[三角恒等式](@entry_id:165065) $\sin^2(x) = \frac{1}{2}(1-\cos(2x))$ 并做[变量替换](@entry_id:141386)，会得到积分 $\int_0^\infty \frac{1-\cos u}{u^2} du$。这个新的被积函数是光滑的（在 $u=0$ 处[可去奇点](@entry_id:175597)）、非负的，并且以更快的 $1/u^2$ 速率衰减。因此，对后一种形式应用数值方法，将以远低于前一种形式的计算成本达到相同的精度。

另一个重要的原则是“能解析求解的就不要数值计算”。在验证[帕塞瓦尔定理](@entry_id:139215)的例子中 ，我们需要计算函数 $f(x)$ 及其[傅里叶变换](@entry_id:142120) $F(\omega)$ 的模方积分。如果试图通过嵌套数值积分来计算 $F(\omega)$ 本身，将会非常低效且充满误差。正确的做法是首先解析地求出 $f(x) = 1/(1+x^2)$ 的[傅里叶变换](@entry_id:142120)是 $F(\omega) = \pi \exp(-|\omega|)$。然后，我们只需分别数值计算两个行为良好（快速衰减）的单变量积分 $\int |f(x)|^2 dx$ 和 $\frac{1}{2\pi}\int |F(\omega)|^2 d\omega$，从而能够以极高的精度验证该定理。

总之，成功地进行[反常积分](@entry_id:145029)的数值计算，不仅是一项应用算法的技能，更是一门结合了[数学分析](@entry_id:139664)、对数值方法原理的深刻理解以及策略选择的艺术。