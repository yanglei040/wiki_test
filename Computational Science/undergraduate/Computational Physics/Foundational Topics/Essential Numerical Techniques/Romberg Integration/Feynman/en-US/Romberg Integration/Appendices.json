{
    "hands_on_practices": [
        {
            "introduction": "To truly grasp the mechanics of Romberg integration, it is essential to perform the calculations by hand. This first practice problem guides you through the foundational steps of constructing a Romberg tableau for a simple polynomial integral. By calculating the initial trapezoidal rule estimates, $R_{1,1}$ and $R_{2,1}$, and then applying the first level of Richardson extrapolation to find $R_{2,2}$, you will build a concrete understanding of how the algorithm generates increasingly accurate results .",
            "id": "2198730",
            "problem": "Romberg integration is a numerical method used to estimate the definite integral of a function by applying Richardson extrapolation to the results from the trapezoidal rule. The estimates are organized in a triangular array called the Romberg tableau, denoted by $R_{k,j}$. The first column, $R_{k,1}$ (for $k \\geq 1$), is generated using the composite trapezoidal rule with $n = 2^{k-1}$ subintervals. Subsequent entries are computed using the recursive formula:\n$$R_{k,j} = R_{k,j-1} + \\frac{1}{4^{j-1} - 1}(R_{k,j-1} - R_{k-1,j-1}) \\quad \\text{for } k \\geq j \\geq 2.$$\n\nConsider the definite integral of a polynomial function $f(x) = 4x^3 - 3x^2 + 5$ over the interval $[0, 2]$. Your task is to manually compute the first three entries of the Romberg tableau for this integral.\n\nCalculate the values of $R_{1,1}$, $R_{2,1}$, and $R_{2,2}$. Provide your answer as a row vector of the three numerical values $(R_{1,1}, R_{2,1}, R_{2,2})$ expressed as exact integers.",
            "solution": "We integrate $f(x)=4x^{3}-3x^{2}+5$ over $[a,b]=[0,2]$. The composite trapezoidal rule with $n$ subintervals of width $h=\\frac{b-a}{n}$ is\n$$\nT_{n}=\\frac{h}{2}\\left(f(a)+2\\sum_{i=1}^{n-1}f(a+ih)+f(b)\\right).\n$$\nBy definition, $R_{k,1}=T_{2^{\\,k-1}}$.\n\nFor $R_{1,1}$, take $n=1$ so $h=2$. Evaluate $f(0)=5$ and $f(2)=4\\cdot 2^{3}-3\\cdot 2^{2}+5=32-12+5=25$. Then\n$$\nR_{1,1}=T_{1}=\\frac{2}{2}\\left(f(0)+f(2)\\right)=1\\cdot(5+25)=30.\n$$\n\nFor $R_{2,1}$, take $n=2$ so $h=1$ with nodes $0,1,2$. Compute $f(1)=4-3+5=6$. Then\n$$\nR_{2,1}=T_{2}=\\frac{1}{2}\\left(f(0)+2f(1)+f(2)\\right)=\\frac{1}{2}\\left(5+2\\cdot 6+25\\right)=\\frac{42}{2}=21.\n$$\n\nRomberg extrapolation uses\n$$\nR_{k,j}=R_{k,j-1}+\\frac{1}{4^{\\,j-1}-1}\\left(R_{k,j-1}-R_{k-1,j-1}\\right), \\quad k\\geq j\\geq 2.\n$$\nThus,\n$$\nR_{2,2}=R_{2,1}+\\frac{1}{4^{1}-1}\\left(R_{2,1}-R_{1,1}\\right)=21+\\frac{1}{3}(21-30)=21-\\frac{9}{3}=18.\n$$\n\nAs a consistency check, the exact integral is\n$$\n\\int_{0}^{2}\\left(4x^{3}-3x^{2}+5\\right)\\,dx=\\left(x^{4}-x^{3}+5x\\right)\\bigg|_{0}^{2}=16-8+10=18,\n$$\nagreeing with $R_{2,2}$ as expected for a cubic.",
            "answer": "$$\\boxed{\\begin{pmatrix}30 & 21 & 18\\end{pmatrix}}$$"
        },
        {
            "introduction": "Romberg integration is not just an elegant mathematical procedure; it is a highly efficient algorithm that dramatically reduces computational cost. This exercise provides a striking quantitative comparison between the efficiency of Romberg integration and the basic composite trapezoidal rule for approximating the integral of a Gaussian function . You will see firsthand how a small number of function evaluations, when cleverly combined through extrapolation, can yield an accuracy that would otherwise require a much larger computational budget.",
            "id": "2198711",
            "problem": "A signal processing algorithm for analyzing Gaussian pulses requires the precise evaluation of the integral $I = \\int_0^1 \\exp(-x^2) dx$. The exact value of this integral is known to be approximately $I_{true} = 0.746824133$.\n\nTwo numerical methods are being considered for this task: Romberg integration and the composite trapezoidal rule.\n\nFirst, using Romberg integration, compute the approximation denoted as $R_{3,3}$.\n    \nNext, calculate the absolute error of this $R_{3,3}$ approximation with respect to $I_{true}$. Then, determine the minimum number of subintervals, let's call it $n_{trap}$, that the composite trapezoidal rule would need to guarantee an absolute error that is less than or equal to the error you found for $R_{3,3}$.\n\nWhat is the total number of unique function evaluations of $\\exp(-x^2)$ required to compute $R_{3,3}$, and what is the number of function evaluations ($n_{trap}+1$) required by the composite trapezoidal rule?\n\nState your answer as two integers: the number of evaluations for the Romberg method followed by the number of evaluations for the composite trapezoidal rule.",
            "solution": "The problem asks for two values: the number of function evaluations needed to compute the Romberg integral approximation $R_{3,3}$ for $I = \\int_0^1 \\exp(-x^2) dx$, and the number of function evaluations needed for the composite trapezoidal rule to achieve a comparable accuracy.\n\nFirst, we address the Romberg integration part. The calculation of $R_{3,3}$ requires the construction of a 3x3 Romberg table. The first column of this table, $R_{1,1}, R_{2,1}, R_{3,1}$, consists of approximations from the composite trapezoidal rule with $n=2^{1-1}=1$, $n=2^{2-1}=2$, and $n=2^{3-1}=4$ subintervals, respectively. The highest number of subintervals used is $n=4$. The composite trapezoidal rule with $n=4$ on the interval $[0,1]$ requires evaluating the function $f(x) = \\exp(-x^2)$ at the points $x_i = 0 + i \\cdot \\frac{1-0}{4}$ for $i=0, 1, 2, 3, 4$. These points are $0, 0.25, 0.5, 0.75, 1$. This constitutes a total of 5 unique function evaluations. Since the evaluations for $n=1$ and $n=2$ are subsets of these points, the total number of function evaluations for finding $R_{3,3}$ is 5.\n\nNow, we compute the values in the Romberg table. Let $f(x) = \\exp(-x^2)$.\nThe required function values are:\n$f(0) = \\exp(0) = 1$\n$f(0.25) = \\exp(-0.0625) \\approx 0.939413115$\n$f(0.5) = \\exp(-0.25) \\approx 0.778800783$\n$f(0.75) = \\exp(-0.5625) \\approx 0.569782825$\n$f(1) = \\exp(-1) \\approx 0.367879441$\n\nThe first column of the Romberg table ($R_{i,1}$) is calculated using the composite trapezoidal rule:\n$R_{1,1}$ (n=1, h=1): $\\frac{1}{2}(f(0) + f(1)) = \\frac{1}{2}(1 + 0.367879441) = 0.683939721$\n$R_{2,1}$ (n=2, h=0.5): $\\frac{0.5}{2}(f(0) + 2f(0.5) + f(1)) = 0.25(1 + 2(0.778800783) + 0.367879441) = 0.731370252$\n$R_{3,1}$ (n=4, h=0.25): $\\frac{0.25}{2}(f(0) + 2(f(0.25)+f(0.5)+f(0.75)) + f(1)) = 0.125(1 + 2(0.939413115+0.778800783+0.569782825) + 0.367879441) = 0.742984111$\n\nNext, we use Richardson's extrapolation formula, $R_{i,j} = R_{i, j-1} + \\frac{R_{i, j-1} - R_{i-1, j-1}}{4^{j-1}-1}$, to find the other entries.\nFor $j=2$:\n$R_{2,2} = R_{2,1} + \\frac{R_{2,1} - R_{1,1}}{4^{1}-1} = 0.731370252 + \\frac{0.731370252 - 0.683939721}{3} = 0.747180432$\n$R_{3,2} = R_{3,1} + \\frac{R_{3,1} - R_{2,1}}{4^{1}-1} = 0.742984111 + \\frac{0.742984111 - 0.731370252}{3} = 0.746855397$\n\nFor $j=3$:\n$R_{3,3} = R_{3,2} + \\frac{R_{3,2} - R_{2,2}}{4^{2}-1} = 0.746855397 + \\frac{0.746855397 - 0.747180432}{15} = 0.746833765$\n\nThe absolute error of the $R_{3,3}$ approximation is:\n$\\epsilon_{R_{3,3}} = |R_{3,3} - I_{true}| = |0.746833765 - 0.746824133| = 9.632 \\times 10^{-6}$.\n\nNext, we find the number of subintervals $n_{trap}$ needed for the composite trapezoidal rule to have an error no greater than $\\epsilon_{R_{3,3}}$. The error bound for the composite trapezoidal rule is $|E_T| \\le \\frac{(b-a)^3}{12n^2} \\max_{x \\in [a,b]} |f''(x)|$.\nHere, $a=0$, $b=1$, and $f(x) = \\exp(-x^2)$.\nWe need to find the second derivative, $f''(x)$:\n$f'(x) = -2x \\exp(-x^2)$\n$f''(x) = -2 \\exp(-x^2) + (-2x)(-2x \\exp(-x^2)) = (4x^2 - 2) \\exp(-x^2)$\n\nWe need to find the maximum value of $|f''(x)|$ on the interval $[0,1]$. Let's analyze $g(x) = f''(x)$. We check the critical points and endpoints.\nTo find critical points, we take the derivative of $f''(x)$:\n$f'''(x) = 8x \\exp(-x^2) + (4x^2 - 2)(-2x \\exp(-x^2)) = (8x - 8x^3 + 4x)\\exp(-x^2) = (12x - 8x^3)\\exp(-x^2)$.\nSetting $f'''(x)=0$ gives $x=0$ or $12 - 8x^2 = 0 \\implies x^2 = 3/2 \\implies x = \\sqrt{3/2} \\approx 1.225$, which is outside $[0,1]$.\nSo we only need to check the values of $|f''(x)|$ at the endpoints $x=0$ and $x=1$:\n$|f''(0)| = |(4(0)^2 - 2)\\exp(0)| = |-2| = 2$.\n$|f''(1)| = |(4(1)^2 - 2)\\exp(-1)| = |2e^{-1}| \\approx 0.7357$.\nThe maximum value of $|f''(x)|$ on $[0,1]$ is 2.\n\nNow we can set up the inequality for the error:\n$\\frac{(1-0)^3}{12n_{trap}^2} \\times 2 \\le \\epsilon_{R_{3,3}}$\n$\\frac{1}{6n_{trap}^2} \\le 9.632 \\times 10^{-6}$\n$n_{trap}^2 \\ge \\frac{1}{6 \\times 9.632 \\times 10^{-6}} \\approx 17303.4$\n$n_{trap} \\ge \\sqrt{17303.4} \\approx 131.54$\nSince $n_{trap}$ must be an integer, the minimum number of subintervals required is $n_{trap}=132$.\n\nThe number of function evaluations for the composite trapezoidal rule with $n_{trap}$ subintervals is $n_{trap}+1$.\nSo, the number of evaluations is $132 + 1 = 133$.\n\nIn conclusion, the number of function evaluations for the Romberg method ($R_{3,3}$) is 5, and the number of evaluations for the composite trapezoidal rule to achieve a similar error guarantee is 133.\nThe two integers for the answer are 5 and 133.",
            "answer": "$$\\boxed{\\begin{pmatrix} 5 & 133 \\end{pmatrix}}$$"
        },
        {
            "introduction": "The remarkable efficiency of Romberg integration is rooted in the Euler-Maclaurin formula, which assumes the integrand is a smooth function with several continuous derivatives. This practice problem tests the boundaries of the method by applying it to an integral of a function that is not smooth, specifically $f(x) = |3x - 1|$, which has a \"kink\" in the integration interval . Understanding how the method behaves in such scenarios is crucial for applying numerical techniques correctly and being aware of their underlying assumptions and limitations.",
            "id": "2198713",
            "problem": "Romberg integration is a numerical method for approximating a definite integral $I = \\int_a^b f(x) \\, dx$. It uses Richardson extrapolation to improve the accuracy of the composite trapezoidal rule. The entries of the Romberg table, denoted by $R_{k,j}$, are generated as follows:\n\nThe first column, $R_{k,1}$ for $k \\ge 1$, consists of approximations from the composite trapezoidal rule. Specifically, $R_{k,1}$ is the result of using $n=2^{k-1}$ equal subintervals. The formula for the composite trapezoidal rule with $n$ subintervals of width $h=(b-a)/n$ is:\n$$T_n = \\frac{h}{2} \\left( f(x_0) + 2\\sum_{i=1}^{n-1} f(x_i) + f(x_n) \\right)$$\nwhere $x_i = a + ih$.\n\nSubsequent columns ($j > 1$) are computed using the Richardson extrapolation formula:\n$$R_{k,j} = R_{k, j-1} + \\frac{R_{k, j-1} - R_{k-1, j-1}}{4^{j-1} - 1}$$\nfor $k \\ge j$.\n\nConsider the definite integral of the function $f(x) = |3x - 1|$ over the interval $[0, 1]$. Calculate the value of the Romberg table entry $R_{2,2}$. Report your answer as a real number rounded to four significant figures.",
            "solution": "We need $R_{2,2}$ for $I=\\int_{0}^{1}|3x-1|\\,dx$ using the Romberg scheme based on the composite trapezoidal rule.\n\nFirst column entries:\n- For $k=1$ (so $n=2^{0}=1$), $h=1$. The trapezoidal rule gives\n$$\nR_{1,1}=T_{1}=\\frac{h}{2}\\big(f(0)+f(1)\\big)=\\frac{1}{2}\\big(|-1|+|2|\\big)=\\frac{1}{2}(1+2)=\\frac{3}{2}.\n$$\n- For $k=2$ (so $n=2^{1}=2$), $h=\\frac{1}{2}$ and nodes $x_{0}=0$, $x_{1}=\\frac{1}{2}$, $x_{2}=1$. Then\n$$\nf(0)=1,\\quad f\\!\\left(\\frac{1}{2}\\right)=\\left| \\frac{3}{2}-1 \\right|=\\frac{1}{2},\\quad f(1)=2,\n$$\nso\n$$\nR_{2,1}=T_{2}=\\frac{h}{2}\\left(f(x_{0})+2f(x_{1})+f(x_{2})\\right)=\\frac{\\frac{1}{2}}{2}\\left(1+2\\cdot\\frac{1}{2}+2\\right)=\\frac{1}{4}(1+1+2)=1.\n$$\n\nSecond column via Richardson extrapolation for $j=2$:\n$$\nR_{2,2}=R_{2,1}+\\frac{R_{2,1}-R_{1,1}}{4^{1}-1}=1+\\frac{1-\\frac{3}{2}}{3}=1-\\frac{1}{6}=\\frac{5}{6}.\n$$\n\nRounded to four significant figures, $\\frac{5}{6} \\approx 0.8333$.",
            "answer": "$$\\boxed{0.8333}$$"
        }
    ]
}