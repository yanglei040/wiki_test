## 引言
间断伽辽金（Discontinuous Galerkin, DG）方法是现代计算科学与工程领域中求解偏微分方程，特别是[双曲守恒律](@entry_id:147752)，一种功能强大且日益普及的数值技术。传统数值方法，如[有限差分](@entry_id:167874)或连续有限元，在处理包含激波、[接触间断](@entry_id:194702)等[复杂流动](@entry_id:747569)现象时，往往难以兼顾[高阶精度](@entry_id:750325)、几何灵活性和计算并行性。DG方法通过允许解在计算单元边界上存在间断，并借助“[数值通量](@entry_id:752791)”的概念以弱形式耦合相邻单元，巧妙地克服了这些挑战，为高保真模拟提供了坚实的基础。

本文旨在为读者提供一个关于[DG方法](@entry_id:748369)求解守恒律的全面而深入的指南。我们将从其数学核心出发，逐步揭示其强大的应用潜力。在“原理与机制”一章中，我们将详细推导[DG方法](@entry_id:748369)的公式，阐明[数值通量](@entry_id:752791)的关键作用，并探讨处理间断的必要技术，如[斜率限制器](@entry_id:638003)。随后，在“应用与跨学科联系”一章中，我们将展示DG方法如何从经典的[计算流体力学](@entry_id:747620)扩展到地球物理、[半导体](@entry_id:141536)物理甚至社会科学等前沿领域，并介绍其在方法论上的演进，如可杂交DG（HDG）和时空方法。最后，“动手实践”部分提供了一系列引导性问题，旨在通过实践加深对核心概念的理解。通过本文的学习，读者将能够掌握[DG方法](@entry_id:748369)的精髓，并具备将其应用于解决实际科学与工程问题的能力。

## 原理与机制

本章旨在深入剖析间断伽辽金（Discontinuous Galerkin, DG）方法的核心原理与基本机制。在前一章介绍其背景与动机之后，我们将系统地构建[DG方法](@entry_id:748369)的理论框架。我们将从单个计算单元上的弱形式出发，阐明数值通量的中心作用，并探讨其如何将不连续的单元拼接成一个协调的整体。随后，我们将揭示[DG方法](@entry_id:748369)与其他经典数值方法（如有限体积法）的内在联系，并强调其公式构建为何与守恒律方程的[散度形式](@entry_id:748608)紧密相连。我们还将讨论时空离散化的策略，特别是DG方法在[显式时间积分](@entry_id:165797)方案中的独特优势。最后，本章将探讨处理[非线性](@entry_id:637147)问题与间断（如激波）时所面临的挑战，并介绍[斜率限制器](@entry_id:638003)和[熵稳定性](@entry_id:749023)等关键概念，这些是确保[DG方法](@entry_id:748369)在复杂应用中保持鲁棒性和物理真实性的核心技术。

### 间断伽辽金公式：局部视角与数值通量

间断伽辽金方法的基本思想是在求解域的每个单元（或元素）$K$ 上独立地构建近似解，允许解在单元边界上存在间断。这与连续伽辽金（Continuous Galerkin, CG）方法形成了鲜明对比，后者要求近似解在整个求解域上是全局连续的。这种局部化的处理方式是[DG方法](@entry_id:748369)诸多优越特性的根源。

我们从一个守恒律方程的通用形式出发：
$$
\partial_t u + \nabla \cdot \mathbf{f}(u) = 0
$$
为了推导DG方法的弱形式，我们在任意一个单元 $K$ 上，将此[偏微分方程](@entry_id:141332)（PDE）与一个**检验函数**（test function）$v_h$ 相乘，然后进行积分：
$$
\int_K (\partial_t u) v_h \, d\mathbf{x} + \int_K (\nabla \cdot \mathbf{f}(u)) v_h \, d\mathbf{x} = 0
$$
接下来是关键的一步：对通量项应用**[分部积分](@entry_id:136350)**（或高维的[散度定理](@entry_id:143110)）。这会将[微分算子](@entry_id:140145)从可能不光滑的解 $u$ 转移到通常是光滑多项式的检验函数 $v_h$ 上：
$$
\int_K (\nabla \cdot \mathbf{f}(u)) v_h \, d\mathbf{x} = \int_{\partial K} (\mathbf{f}(u) \cdot \mathbf{n}) v_h \, dS - \int_K \mathbf{f}(u) \cdot \nabla v_h \, d\mathbf{x}
$$
其中 $\partial K$ 是单元 $K$ 的边界，$\mathbf{n}$ 是指向单元外部的[单位法向量](@entry_id:178851)。将此式代回原[弱形式](@entry_id:142897)，我们得到单元 $K$ 上的[半离散格式](@entry_id:165671)：
$$
\frac{d}{dt} \int_K u_h v_h \, d\mathbf{x} + \int_{\partial K} (\mathbf{f}(u_h) \cdot \mathbf{n}) v_h \, dS - \int_K \mathbf{f}(u_h) \cdot \nabla v_h \, d\mathbf{x} = 0
$$
在这里，$u_h$ 是我们在DG[函数空间](@entry_id:143478)中寻找的近似解。

边界积分项 $\int_{\partial K} (\mathbf{f}(u_h) \cdot \mathbf{n}) v_h \, dS$ 正是[DG方法](@entry_id:748369)与CG方法的区别所在。在CG方法中，由于解 $u_h$ 和检验函数 $v_h$ 在单元间是连续的，当我们将所有单元的[弱形式](@entry_id:142897)相加时，任意一个内部界面上的通量项会因为[法向量](@entry_id:264185)相反（一个单元的流出等于相邻单元的流入）而精确抵消。因此，CG方法通过函数空间的**强约束**来施加连续性。

然而，在DG方法中，$u_h$ 在单元边界上是多值的。对于一个内部界面 $F$，它同时属于两个单元 $K^-$ 和 $K^+$。解在界面 $F$ 上有两个迹（trace）：来自 $K^-$ 内部的 $u_h^-$ 和来自 $K^+$ 内部的 $u_h^+$。此时，物理通量 $\mathbf{f}(u_h) \cdot \mathbf{n}$ 的定义变得模糊不清。我们不能简单地将相邻单元的边界积分项相加并期望它们抵消。

为了解决这个问题，[DG方法](@entry_id:748369)引入了**[数值通量](@entry_id:752791)**（numerical flux）的概念，记作 $\hat{\mathbf{f}}(u_h^-, u_h^+; \mathbf{n})$。[数值通量](@entry_id:752791)是一个单值函数，它依赖于界面两侧的解的状态 $(u_h^-, u_h^+)$ 和[法向量](@entry_id:264185) $\mathbf{n}$，其目的是在单元之间建立起唯一的、物理上合理的耦合。我们将模糊的物理通量替换为这个明确定义的数值通量，从而得到最终的[DG弱形式](@entry_id:748377)：
$$
\frac{d}{dt} \int_K u_h v_h \, d\mathbf{x} + \int_{\partial K} \hat{\mathbf{f}} v_h \, dS - \int_K \mathbf{f}(u_h) \cdot \nabla v_h \, d\mathbf{x} = 0
$$
通过[数值通量](@entry_id:752791)，[DG方法](@entry_id:748369)以一种**[弱形式](@entry_id:142897)**来施加界面上的物理条件（如连续性或激波关系）。这种灵活性是[DG方法](@entry_id:748369)的一大优势，它使得处理复杂几何、[非协调网格](@entry_id:752550)以及不同物理现象（如[对流](@entry_id:141806)主导问题和[扩散](@entry_id:141445)问题）变得更加容易。例如，在[固体力学](@entry_id:164042)等[椭圆问题](@entry_id:146817)中，可以通过在数值通量中加入惩罚项来弱化连续性，而在波动等双曲问题中，则可使用[迎风格式](@entry_id:756374)来捕捉[波的传播](@entry_id:144063)方向。

### 数值通量的性质

数值通量的选择对DG方法的稳定性、精度和守恒性至关重要。一个设计良好的[数值通量](@entry_id:752791)通常需要满足以下几个基本属性。

#### 一致性

**一致性**（Consistency）保证了当数值解在界面两侧没有跳变时，[数值通量](@entry_id:752791)能够退化为物理通量。也就是说，如果 $u^- = u^+ = u$，那么数值通量必须满足：
$$
\hat{\mathbf{f}}(u, u; \mathbf{n}) = \mathbf{f}(u) \cdot \mathbf{n}
$$
这个性质确保了当数值解趋向于一个光滑的精确解时，我们的离散格式确实是在逼近原始的[偏微分方程](@entry_id:141332)。例如，被广泛使用的**Lax-Friedrichs通量**（或称为[Rusanov通量](@entry_id:637224)）定义为：
$$
\hat{f}_{\mathrm{LF}}(u^-, u^+; \mathbf{n}) = \frac{1}{2}\big(\mathbf{f}(u^-) + \mathbf{f}(u^+)\big) \cdot \mathbf{n} - \frac{1}{2}\alpha(u^+ - u^-)
$$
其中 $\alpha$ 是一个耗散系数。很容易验证，当 $u^-=u^+=u$ 时，第二项消失，第一项变为 $\mathbf{f}(u) \cdot \mathbf{n}$，因此该通量是一致的。

#### 守恒性

**守恒性**（Conservativity）是求解守恒律方程的数值方法必须具备的关键性质。它确保了在整个计算域内（或在周期性边界条件下），被守恒的量（如质量、动量、能量）的总和不会因为数值离散而凭空产生或消失。在[DG方法](@entry_id:748369)中，这要求在任意一个内部界面上，从一个单元流出的通量必须等于流入相邻单元的通量。

如果我们规定[法向量](@entry_id:264185) $\mathbf{n}$ 由 $u^-$ 侧指向 $u^+$ 侧，那么从 $u^-$ 单元流出的通量是 $\hat{\mathbf{f}}(u^-, u^+; \mathbf{n})$。对于 $u^+$ 单元，其[法向量](@entry_id:264185)是 $-\mathbf{n}$，解的状态是 $(u^+, u^-)$，因此从该单元流出的通量是 $\hat{\mathbf{f}}(u^+, u^-; -\mathbf{n})$。为了守恒，这两个流出的通量之和必须为零，即满足[反对称关系](@entry_id:261979)：
$$
\hat{\mathbf{f}}(u^-, u^+; \mathbf{n}) + \hat{\mathbf{f}}(u^+, u^-; -\mathbf{n}) = 0
$$
这个单值通量的性质是离散守恒的核心。如果每个界面都满足这个条件，那么将所有单元的[弱形式](@entry_id:142897)（取检验函数 $v_h=1$）相加时，所有内部界面的通量项将像伸缩级数一样精确抵消，使得总量的变化只依赖于计算域边界的通量。

#### [单调性](@entry_id:143760)

对于[标量守恒律](@entry_id:754532)，**单调性**（Monotonicity）是一个更强的性质，它与保证解不产生非物理[振荡](@entry_id:267781)（如吉布斯现象）密切相关。一个单调的[数值通量](@entry_id:752791) $\hat{f}(u^-, u^+)$（此处为标量情况）是一个关于其第一个参数 $u^-$ 单调不减、关于第二个参数 $u^+$ 单调不增的函数。在可微的情况下，这意味着：
$$
\frac{\partial \hat{f}}{\partial u^-} \ge 0, \quad \frac{\partial \hat{f}}{\partial u^+} \le 0
$$
例如，Lax-Friedrichs通量，只有当耗散系数 $\alpha$ 足够大（通常需要大于或等于法向通量导数的最大[绝对值](@entry_id:147688)）时，才能满足[单调性](@entry_id:143760)。而简单的**[中心通量](@entry_id:747204)**（即 $\alpha=0$ 的Lax-Friedrichs通量）通常不满足单调性，因此在求解双曲问题时是不稳定的。**[Godunov通量](@entry_id:634733)**，即通过求解界面上的局部一维黎曼问题得到的通量，是保证单调性的经典选择。

### [DG方法](@entry_id:748369)的基本属性与内在联系

理解了数值通量的作用后，我们可以更深入地探讨DG方法的一些基本属性，以及它与其他数值方法的关联。

#### 与有限体积法的联系

[DG方法](@entry_id:748369)可以被看作是高阶的[有限体积法](@entry_id:749372)（Finite Volume Method, FVM）。当DG方法采用最低阶的 $p=0$ 次多项式（即在每个单元内解是分片常数）作为[基函数](@entry_id:170178)时，它就精确地退化为一个经典的有限体积格式。

具体来说，对于 $p=0$ 的[DG方法](@entry_id:748369)，单元 $K_j$ 内的解 $u_h(x, t) = u_j(t)$，其中 $u_j(t)$ 就是该单元的平均值。[选择检验](@entry_id:182706)函数 $v_h=1$（这是 $p=0$ 空间中唯一的[基函数](@entry_id:170178)），[DG弱形式](@entry_id:748377)中的体积积分项 $\int_K \mathbf{f}(u_h) \cdot \nabla v_h \, d\mathbf{x}$ 因为 $\nabla v_h = 0$ 而消失。弱形式简化为：
$$
\frac{d}{dt} \int_{K_j} u_j(t) \cdot 1 \, d\mathbf{x} + \hat{f}_{j+1/2} - \hat{f}_{j-1/2} = 0
$$
其中 $\hat{f}_{j\pm1/2}$ 是在单元边界 $x_{j\pm1/2}$ 上的数值通量。此式可重写为：
$$
\frac{du_j}{dt} = - \frac{1}{\Delta x} (\hat{f}_{j+1/2} - \hat{f}_{j-1/2})
$$
这正是[有限体积法](@entry_id:749372)的标准半离散形式，它描述了单元平均值 $u_j$ 的演化仅由边界通量差决定。因此，选择不同的[数值通量](@entry_id:752791)（如[Godunov通量](@entry_id:634733)或[迎风通量](@entry_id:143931)）的 $p=0$ [DG方法](@entry_id:748369)，就分别对应于经典的Godunov[有限体积法](@entry_id:749372)或[迎风](@entry_id:756372)[有限体积法](@entry_id:749372)。这个联系为我们理解[DG方法](@entry_id:748369)提供了一个重要的立足点。

#### [守恒形式](@entry_id:747710)的首要性

[DG方法](@entry_id:748369)的整个推导过程——从PDE出发，乘以[检验函数](@entry_id:166589)，再通过分部积分将体积散度项转化为边界通量项——都深刻地依赖于PDE的**[守恒形式](@entry_id:747710)**（或称[散度形式](@entry_id:748608)），即形如 $\partial_t u + \nabla \cdot \mathbf{f}(u) = 0$ 的结构。

考虑一个等价的[非守恒形式](@entry_id:752551)（或称拟[线性形式](@entry_id:276136)）的方程，如 $u_t + a(u)u_x=0$，其中 $a(u) = f'(u)$。如果一个间断解（激波）形成，这个[非守恒形式](@entry_id:752551)在间断处是无定义的，因为它涉及到一个[不连续函数](@entry_id:143848)与一个[分布](@entry_id:182848)（其导数）的乘积。只有守恒[形式的积分](@entry_id:158607)版本才能唯一地确定物理上正确的激波速度，这由著名的[Rankine-Hugoniot跳跃条件](@entry_id:139267)给出。

[Lax-Wendroff定理](@entry_id:751184)指出，一个[数值格式](@entry_id:752822)如果要收敛到物理正确的[弱解](@entry_id:161732)，它必须是[守恒格式](@entry_id:747715)。如果我们天真地对[非守恒形式](@entry_id:752551) $u_t + a(u)u_x=0$ 构建一个[DG格式](@entry_id:178043)，例如将其中的项 $a(u)u_x$ 视为一个新的通量 $g(u)=a(u)u$ 并应用标准DG流程，我们得到的实际上是一个对新守恒律 $u_t + (a(u)u)_x=0$ 的一致离散。这个新守恒律通常与原始的守恒律 $u_t + f(u)_x=0$ 不等价，因此会导致错误的激[波速](@entry_id:186208)度。

结论是，[DG方法](@entry_id:748369)必须建立在PDE的[守恒形式](@entry_id:747710)之上。这种结构保证了通过分部积分可以自然地产生边界通量，并通过守恒的数值通量确保离散解在全局意义上保持守恒，从而有能力捕捉到具有正确物理性质的间断解。

### 求解系统：线方法及其优势

DG空间离散将一个[偏微分方程](@entry_id:141332)转化为一个[常微分方程组](@entry_id:266774)（ODE），这一过程称为**线方法**（Method of Lines, MoL）。得到的ODE系统通常写成如下矩阵形式：
$$
\mathbf{M} \frac{d\mathbf{u}}{dt} = \mathbf{R}(\mathbf{u})
$$
其中 $\mathbf{u}$ 是包含所有单元上所有[基函数](@entry_id:170178)系数的全局自由度向量，$\mathbf{M}$ 是**[质量矩阵](@entry_id:177093)**（mass matrix），$\mathbf{R}(\mathbf{u})$ 是包含空间导数和边界通量贡献的**残差向量**（residual vector）。

#### DG[质量矩阵](@entry_id:177093)的优越性

[DG方法](@entry_id:748369)的一个显著计算优势在于其质量矩阵 $\mathbf{M}$ 的结构。[质量矩阵](@entry_id:177093)的元素由[基函数](@entry_id:170178)之间的 $L^2$ [内积](@entry_id:158127)定义：$M_{ij} = \int_\Omega \phi_i \phi_j \, d\mathbf{x}$。由于DG方法的[基函数](@entry_id:170178) $\phi_i$ 的支集严格限制在单个单元内部（即 $\text{supp}(\phi_i) \subset K_e$），因此，如果两个[基函数](@entry_id:170178) $\phi_i$ 和 $\phi_j$ 分属于不同的单元，它们的乘积在整个定义域上恒为零，故 $M_{ij}=0$。

这意味着全局质量矩阵 $\mathbf{M}$ 是一个**[块对角矩阵](@entry_id:145530)**：
$$
\mathbf{M} = \text{diag}(\mathbf{M}_1, \mathbf{M}_2, \dots, \mathbf{M}_E)
$$
其中每个对角块 $\mathbf{M}_e$ 是一个与单个单元 $K_e$ 相关的小尺寸局部[质量矩阵](@entry_id:177093)。与此相反，[连续伽辽金方法](@entry_id:747805)的[基函数](@entry_id:170178)在单元间有重叠，导致其[质量矩阵](@entry_id:177093)是耦合的、稀疏但非块对角的。

这个[块对角结构](@entry_id:746869)对于[显式时间积分](@entry_id:165797)方案（如[龙格-库塔法](@entry_id:140014)）来说是一个巨大的福音。显式方法在每个时间步中需要计算时间导数 $\frac{d\mathbf{u}}{dt} = \mathbf{M}^{-1} \mathbf{R}(\mathbf{u})$。由于 $\mathbf{M}$ 是块对角的，其[逆矩阵](@entry_id:140380) $\mathbf{M}^{-1}$ 也是块对角的，由各个局部[质量矩阵](@entry_id:177093)的逆 $\mathbf{M}_e^{-1}$ 组成。因此，求解 $\mathbf{M}^{-1}\mathbf{R}$ 的过程可以完全[解耦](@entry_id:637294)，在每个单元上独立地进行一次小规模的[矩阵求逆](@entry_id:636005)（或[求解线性系统](@entry_id:146035)），而无需进行任何全局的[线性系统](@entry_id:147850)求解。这使得[DG方法](@entry_id:748369)具有极高的[并行效率](@entry_id:637464)。

更有甚者，如果我们在参考单元上选择一组 $L^2$ 正交的[基函数](@entry_id:170178)（如归一化的勒让德多项式），并通过[仿射变换](@entry_id:144885)映射到物理单元，那么局部[质量矩阵](@entry_id:177093) $\mathbf{M}_e$ 甚至可以是[对角矩阵](@entry_id:637782)（或[单位矩阵](@entry_id:156724)乘以一个[雅可比行列式](@entry_id:137120)常数）。在这种情况下，求逆操作退化为简单的逐元素相除，计算成本极低。

#### [时间积分](@entry_id:267413)与稳定性

应用线方法后，我们需要一个合适的[常微分方程](@entry_id:147024)求解器来对[半离散系统](@entry_id:754680)进行时间推进。对于双曲问题，显式方法因其简单性和并行性而备受青睐。

然而，显式方法是有条件稳定的。其稳定性受到**[Courant-Friedrichs-Lewy (CFL) 条件](@entry_id:747986)**的限制，该条件要求时间步长 $\Delta t$ 必须足够小，以确保在一个时间步内信息传播的距离不超过一个网格单元的尺寸。对于[DG方法](@entry_id:748369)，这个条件不仅依赖于网格尺寸 $h$，还依赖于多项式次数 $p$。一个典型的[时间步长限制](@entry_id:756010)形如：
$$
\Delta t \le C_{\text{CFL}} \frac{h}{(2p+1)a_{\max}} \quad \text{或} \quad \Delta t \le C_{\text{CFL}} \frac{h}{p^2 a_{\max}}
$$
其中 $a_{\max}$ 是最大特征速度。这表明，提高多项式次数 $p$ 会带来更严格的[时间步长限制](@entry_id:756010)，这是使用高阶[DG方法](@entry_id:748369)时必须考虑的成本。

为了在保证[高阶精度](@entry_id:750325)的同时控制[非线性](@entry_id:637147)问题中的[数值振荡](@entry_id:163720)，**强稳定性保持（Strong Stability Preserving, SSP）**[时间积分方法](@entry_id:136323)应运而生。[SSP方法](@entry_id:755294)（如某些特定的[龙格-库塔法](@entry_id:140014)）的巧妙之处在于，它们可以将一个高阶时间步分解为一系列前向欧拉步的凸组合。这意味着，如果一个简单的前向欧拉步在某个[时间步长限制](@entry_id:756010)下能够保持某个强稳定性质（如总变差不增，TVD），那么一个[SSP方法](@entry_id:755294)也能在相应的（通常是缩放过的）[时间步长限制](@entry_id:756010)下保持同样的美好性质。这使得我们可以将对空间算子稳定性的分析（基于前向欧拉）与[高阶时间积分](@entry_id:750308)器的设计分离开来。

### 处理[非线性](@entry_id:637147)与间断

[双曲守恒律](@entry_id:147752)的解，即使从光滑的初值开始，也可能在有限时间内发展出间断，即**激波**（shock）。这对[高阶数值方法](@entry_id:142601)提出了严峻的挑战。

#### [斜率限制器](@entry_id:638003)的需求

根据Godunov定理，任何线性的、保证单调性（即不产生新极值）的[数值格式](@entry_id:752822)，其精度最高只能是一阶。DG方法当 $p \ge 1$ 时是高阶的线性格式，因此在遇到间断时，它们不可避免地会在间断附近产生非物理的过冲和下冲，即**[吉布斯振荡](@entry_id:749902)**。这些[振荡](@entry_id:267781)不仅影响解的质量，还可能导致[非线性](@entry_id:637147)迭代发散，使计算崩溃。

为了克服这一困难，必须引入某种[非线性](@entry_id:637147)机制来抑制[振荡](@entry_id:267781)。**[斜率限制器](@entry_id:638003)**（Slope limiter）或更广义的**限制器**（limiter）就是为此设计的。其基本思想是：

1.  **检测**：识别出那些解可能存在问题的“坏”单元（troubled cells），通常是梯度较大的区域。
2.  **限制**：在这些“坏”单元中，对高阶的解多项式进行修正，以消除或减弱[振荡](@entry_id:267781)。

一个关键的要求是，限制过程必须保持**守恒性**。在DG的模态表示中，单元平均值通常对应于最低阶的[模态系数](@entry_id:752057)（例如 $p=1$ 时的 $\hat{u}_{i,0}$）。为了保住守恒性，限制器只应修改那些控制解的形状（如斜率、曲率）的高阶[模态系数](@entry_id:752057)，而保持单元平均值不变。

#### [Minmod限制器](@entry_id:752002)实例

以一维 $p=1$ 的[DG方法](@entry_id:748369)为例，单元 $K_i$ 上的解为线性多项式 $u_h(x)$。在以单元中心为原点的参考坐标 $\xi \in [-1, 1]$ 中，解可以表示为 $u_h(\xi) = \bar{u}_i + \hat{u}_{i,1} \xi$，其中 $\bar{u}_i$ 是单元平均值，$\hat{u}_{i,1}$ 是斜率[模态系数](@entry_id:752057)。

为了防止[振荡](@entry_id:267781)，我们要求限制后的线性函数在单元内的值不应超过相邻单元的平均值。这可以通过比较单元内部的斜率与由相邻单元平均值定义的斜率来实现。**[Minmod限制器](@entry_id:752002)**正是执行这种比较的工具。对于斜率系数 $\hat{u}_{i,1}$，其限制后的值为：
$$
\hat{u}_{i,1}^{\text{new}} = \text{mm}\left( \hat{u}_{i,1}, \frac{1}{2}(\bar{u}_{i+1} - \bar{u}_i), \frac{1}{2}(\bar{u}_i - \bar{u}_{i-1}) \right)
$$
这里的 $\text{mm}(a,b,c)$ 函数，当其所有参数符号相同时，返回其中[绝对值](@entry_id:147688)最小的那个值；否则返回零。这个公式的逻辑是：如果单元内部的斜率、[前向差分](@entry_id:173829)斜率和[后向差分](@entry_id:637618)斜率“方向”一致，就取其中最平缓的一个作为新的斜率；否则，认为该处可能存在极值，直接将斜率设为零（退化为分片常数）。公式中的因子 $\frac{1}{2}$ 是因为 $\hat{u}_{i,1}$ 代表的是从单元中心到边界（半个单元宽度）的变化量，而 $\bar{u}_{i+1}-\bar{u}_i$ 代表的是两个单元中心之间（一个单元宽度）的平均值变化量，为了几何上的可比性，需要这个因子。

#### [熵稳定性](@entry_id:749023)

对于[非线性](@entry_id:637147)守恒律系统，仅仅抑制[振荡](@entry_id:267781)可能还不够。解可能收敛到满足[Rankine-Hugoniot条件](@entry_id:181986)的多个弱解中的一个，但只有一个是物理相关的。物理相关的解还需要满足**[熵条件](@entry_id:166346)**。

一个更高级和更严格的保证物理正确性的方法是设计**熵稳定**（entropy stable）的[DG格式](@entry_id:178043)。这需要引入一个**熵对** $(\eta, \mathbf{q})$，其中 $\eta$ 是关于[守恒变量](@entry_id:747720) $\mathbf{u}$ 的[凸函数](@entry_id:143075)（称为熵函数），$\mathbf{q}$ 是相应的熵通量。物理相关的解必须满足[熵不等式](@entry_id:184404) $\partial_t \eta(\mathbf{u}) + \nabla \cdot \mathbf{q}(\mathbf{u}) \le 0$，这意味着总熵是不会增加的。

一个熵稳定的[DG格式](@entry_id:178043)被设计用来在离散层面上满足这个不等式。这通常通过构造特殊的数值通量来实现，这些通量不仅要满足一致性和守恒性，还要能保证在单元界面上产生适量的[数值耗散](@entry_id:168584)，使得全局离散熵是非增的。一个熵稳定的[DG格式](@entry_id:178043)的半[离散熵不等式](@entry_id:748505)通常具有以下形式：
$$
\frac{d}{dt} \sum_{K \in \mathcal{T}_h} \int_K \eta(\mathbf{u}_h) \, d\mathbf{x} + \text{(界面耗散项)} + \text{(边界熵通量)} \le 0
$$
其中“界面耗散项”是一个非负项，代表了由于解在界面上的跳跃而产生的熵。这种方法为[DG方法](@entry_id:748369)在模拟复杂的[非线性系统](@entry_id:168347)（如[可压缩气体动力学](@entry_id:169361)）时提供了坚实的理论基础和鲁棒性保证。

### 计算效率探讨：h-refinement vs. p-refinement

[DG方法](@entry_id:748369)提供了两条提升解精度的路径：**h-refinement**（加密网格，即减小 $h$）和**p-refinement**（提高多项式次数，即增大 $p$）。如何选择最高效的路径取决于待求解问题的性质。

-   对于**光滑解**，[DG方法](@entry_id:748369)展现出所谓的“谱精度”，即误差随 $p$ 的增加呈指数级下降。在这种情况下，$p$-refinement 通常远比 $h$-refinement 高效。

-   然而，对于包含**激波等间断**的解，情况则截然不同。由于间断的存在，即使使用了限制器，高阶方法的[收敛阶](@entry_id:146394)也会退化。在 $L^1$ 范数下，误差的[收敛阶](@entry_id:146394)通常最多为一阶，即 $E(h,p) \approx C_s h^\alpha$（其中 $\alpha \in [1/2, 1]$），且这个收敛阶与多项式次数 $p$ 无关。换言之，一旦 $p \ge 1$，再继续提高 $p$ 并不能改善误差的收敛阶。

我们可以基于此建立一个简单的[计算成本模型](@entry_id:747607)来分析效率。总计算功 $W$ 正比于 (总时间步数) $\times$ (每步的计算量)。
-   总时间步数 $N_t \propto \frac{T}{\Delta t} \propto \frac{p}{h}$ （这里简化了 $2p+1$ 的依赖关系）。
-   每步计算量 $W_{\text{step}} \propto (\text{单元数}) \times (\text{每单元操作数}) \propto \frac{1}{h} \cdot p^2$ （在一维情况下）。
-   因此，总计算功 $W \propto \frac{p^3}{h^2}$。

为了达到目标精度 $\varepsilon$，我们需要的网格尺寸为 $h \propto \varepsilon^{1/\alpha}$。将此代入总功的表达式，得到：
$$
W(\varepsilon, p) \propto \frac{p^3}{(\varepsilon^{1/\alpha})^2} = \varepsilon^{-2/\alpha} p^3
$$
这个模型揭示了一个至关重要的结论：在固定目标精度 $\varepsilon$ 的情况下，计算成本 $W$ 随着 $p^3$ 增长。为了最小化计算成本，我们应当选择尽可能小的多项式次数 $p$（如 $p=1$ 或 $p=2$），然后通过加密网格（$h$-refinement）来达到所需的精度。对于包含激波的问题，盲目追求高阶多项式不仅不能带来精度上的好处，反而会因为更苛刻的[CFL条件](@entry_id:178032)和更大的单步计算量而导致计算成本急剧上升。