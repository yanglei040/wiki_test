{
    "hands_on_practices": [
        {
            "introduction": "在我们在子域之间进行迭代之前，我们必须首先理解如何在子域*上*定义问题。这个练习  将引导你完成推导局部有限元矩阵的基本过程，这些矩阵是全局问题及其分解的基石。理解这一步对于将“限制”这一抽象概念与有限元法 (Finite Element Method, FEM) 等离散化方法的具体数学联系起来至关重要。",
            "id": "2552503",
            "problem": "考虑开放区间 $\\Omega=(0,1)$ 上的标量扩散模型问题，在 $x=0$ 和 $x=1$ 处具有齐次狄利克雷边界条件，以及双线性形式 $a(u,v)=\\int_{0}^{1} u'(x)\\,v'(x)\\,dx$。将 $\\Omega$ 分割为两个不重叠的子域 $\\Omega_1=(0,\\tfrac{1}{2})$ 和 $\\Omega_2=(\\tfrac{1}{2},1)$，如同在 Finite Element Tearing and Interconnecting (FETI) 和 Balancing Domain Decomposition by Constraints (BDDC) 方法中一样。在每个子域上，使用定义在子域双节点网格上的单个 $P_1$ (连续、分段线性) 有限元，并使用与子域端点相关联的标准节点基函数。在 $\\Omega_1$ 上，按 $x$ 坐标递增顺序将局部节点编号为 $1 \\mapsto x=0$, $2 \\mapsto x=\\tfrac{1}{2}$；在 $\\Omega_2$ 上，编号为 $1 \\mapsto x=\\tfrac{1}{2}$, $2 \\mapsto x=1$。\n\n从有限元刚度贡献的弱形式定义以及从参考元到物理元的仿射映射出发，通过对基函数导数的乘积进行积分，推导出一个长度为 $h$ 的通用一维 $P_1$ 单元上的 $2\\times 2$ 局部刚度矩阵。将您的结果特化到每个子域，以获得 $\\Omega_1$ 上的显式局部刚度矩阵 $K^{(1)}$ 和 $\\Omega_2$ 上的 $K^{(2)}$。在每个子域的局部编号中，确定哪个局部自由度位于 $x=\\tfrac{1}{2}$ 处的界面上。\n\n将您的最终答案表示为一个单行矩阵，该矩阵按顺序依次列出：$K^{(1)}$ 的四个元素（按行主序），然后是 $K^{(2)}$ 的四个元素（按行主序），最后是 $\\Omega_1$ 和 $\\Omega_2$ 上的局部界面自由度索引。不要四舍五入；请使用精确值。不需要单位。",
            "solution": "问题陈述经分析有效。这是一个有限元方法中的标准、适定的问题，并作为诸如 FETI 和 BDDC 等域分解技术的基础步骤。我们着手进行推导。\n\n有限元 $e$ 的局部刚度矩阵 $K^{(e)}$ 由其元素 $K_{ij}^{(e)} = a(\\phi_j, \\phi_i)$ 定义，其中双线性形式 $a(\\cdot, \\cdot)$ 局限于单元域 $\\Omega_e$，而 $\\phi_i, \\phi_j$ 是局部基函数。对于给定问题，$a(u,v) = \\int_{\\Omega} u'(x)v'(x)dx$，因此对于一个跨越区间 $[x_1, x_2]$、长度为 $h$ 的单元，其局部刚度矩阵的元素由下式给出：\n$$ K_{ij}^{(e)} = \\int_{x_1}^{x_2} \\phi_i'(x)\\phi_j'(x)dx $$\n我们将为一个通用的一维 $P_1$ 单元推导此矩阵，然后将结果特化到子域 $\\Omega_1$ 和 $\\Omega_2$。\n\n首先，考虑标准参考元，即一个具有局部坐标 $\\xi$ 的区间 $\\hat{\\Omega} = [0, 1]$。此参考元上的 $P_1$ 基函数（帽函数）是由其节点值定义的线性多项式：\n$$ \\hat{\\phi}_1(\\xi) = 1 - \\xi $$\n$$ \\hat{\\phi}_2(\\xi) = \\xi $$\n它们关于参考坐标 $\\xi$ 的导数是常数：\n$$ \\frac{d\\hat{\\phi}_1}{d\\xi} = -1 $$\n$$ \\frac{d\\hat{\\phi}_2}{d\\xi} = 1 $$\n\n接下来，我们建立从参考坐标 $\\xi \\in [0, 1]$ 到长度为 $h = x_2 - x_1$ 的通用单元 $[x_1, x_2]$ 中物理坐标 $x$ 的仿射映射：\n$$ x(\\xi) = x_1 + (x_2 - x_1)\\xi = x_1 + h\\xi $$\n该变换的雅可比行列式为 $J = \\frac{dx}{d\\xi} = h$。其逆为 $\\frac{d\\xi}{dx} = \\frac{1}{h}$。\n\n物理基函数 $\\phi_i(x)$ 通过与逆映射的复合与参考基函数 $\\hat{\\phi}_i(\\xi)$ 相关：$\\phi_i(x) = \\hat{\\phi}_i(\\xi(x))$。我们使用链式法则求它们关于物理坐标 $x$ 的导数：\n$$ \\frac{d\\phi_i}{dx} = \\frac{d\\hat{\\phi}_i}{d\\xi} \\frac{d\\xi}{dx} = \\frac{1}{h} \\frac{d\\hat{\\phi}_i}{d\\xi} $$\n具体而言：\n$$ \\phi_1'(x) = \\frac{1}{h}(-1) = -\\frac{1}{h} $$\n$$ \\phi_2'(x) = \\frac{1}{h}(1) = \\frac{1}{h} $$\n这些导数在整个单元上是常数。\n\n现在我们可以计算通用 $2 \\times 2$ 局部刚度矩阵 $K^{(e)}$ 的元素。物理域上的积分使用 $dx = J d\\xi = h d\\xi$ 变换为参考域 $[0, 1]$ 上的积分：\n$$ K_{ij}^{(e)} = \\int_{x_1}^{x_2} \\phi_i'(x)\\phi_j'(x)dx = \\int_{0}^{1} \\left(\\frac{1}{h}\\frac{d\\hat{\\phi}_i}{d\\xi}\\right) \\left(\\frac{1}{h}\\frac{d\\hat{\\phi}_j}{d\\xi}\\right) (h d\\xi) = \\frac{1}{h} \\int_{0}^{1} \\frac{d\\hat{\\phi}_i}{d\\xi}\\frac{d\\hat{\\phi}_j}{d\\xi}d\\xi $$\n我们计算四个元素中的每一个：\n$$ K_{11}^{(e)} = \\frac{1}{h} \\int_{0}^{1} (-1)(-1) d\\xi = \\frac{1}{h} \\int_{0}^{1} 1 \\, d\\xi = \\frac{1}{h} [\\xi]_0^1 = \\frac{1}{h} $$\n$$ K_{12}^{(e)} = \\frac{1}{h} \\int_{0}^{1} (-1)(1) d\\xi = \\frac{1}{h} \\int_{0}^{1} -1 \\, d\\xi = -\\frac{1}{h} [\\xi]_0^1 = -\\frac{1}{h} $$\n$$ K_{21}^{(e)} = \\frac{1}{h} \\int_{0}^{1} (1)(-1) d\\xi = \\frac{1}{h} \\int_{0}^{1} -1 \\, d\\xi = -\\frac{1}{h} [\\xi]_0^1 = -\\frac{1}{h} $$\n$$ K_{22}^{(e)} = \\frac{1}{h} \\int_{0}^{1} (1)(1) d\\xi = \\frac{1}{h} \\int_{0}^{1} 1 \\, d\\xi = \\frac{1}{h} [\\xi]_0^1 = \\frac{1}{h} $$\n因此，长度为 $h$ 的一维 $P_1$ 单元的通用局部刚度矩阵为：\n$$ K^{(e)} = \\frac{1}{h} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} $$\n\n现在，我们将此结果特化到两个子域 $\\Omega_1$ 和 $\\Omega_2$。\n\n对于子域 $\\Omega_1 = (0, \\frac{1}{2})$，我们有一个节点位于 $x=0$ 和 $x=\\frac{1}{2}$ 的单元。此单元的长度为 $h_1 = \\frac{1}{2} - 0 = \\frac{1}{2}$。局部刚度矩阵 $K^{(1)}$ 为：\n$$ K^{(1)} = \\frac{1}{1/2} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} = 2 \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} = \\begin{pmatrix} 2  -2 \\\\ -2  2 \\end{pmatrix} $$\n按行主序排列的元素是 $2, -2, -2, 2$。\n\n对于子域 $\\Omega_2 = (\\frac{1}{2}, 1)$，我们有一个节点位于 $x=\\frac{1}{2}$ 和 $x=1$ 的单元。此单元的长度为 $h_2 = 1 - \\frac{1}{2} = \\frac{1}{2}$。局部刚度矩阵 $K^{(2)}$ 为：\n$$ K^{(2)} = \\frac{1}{1/2} \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} = 2 \\begin{pmatrix} 1  -1 \\\\ -1  1 \\end{pmatrix} = \\begin{pmatrix} 2  -2 \\\\ -2  2 \\end{pmatrix} $$\n按行主序排列的元素是 $2, -2, -2, 2$。\n\n最后，我们必须为每个子域确定位于界面 $x=\\frac{1}{2}$ 上的局部自由度 (DoF)。自由度的索引对应其局部节点编号。\n在子域 $\\Omega_1$ 上，局部节点编号为 $1 \\mapsto x=0$ 和 $2 \\mapsto x=\\frac{1}{2}$。界面位于 $x=\\frac{1}{2}$，对应局部节点索引 $2$。\n在子域 $\\Omega_2$ 上，局部节点编号为 $1 \\mapsto x=\\frac{1}{2}$ 和 $2 \\mapsto x=1$。界面位于 $x=\\frac{1}{2}$，对应局部节点索引 $1$。\n\n我们按照要求将这些结果组合成一个单行矩阵。各分量为：\n1. $K^{(1)}$ 的元素（行主序）：$2, -2, -2, 2$。\n2. $K^{(2)}$ 的元素（行主序）：$2, -2, -2, 2$。\n3. $\\Omega_1$ 上的界面自由度索引：$2$。\n4. $\\Omega_2$ 上的界面自由度索引：$1$。\n合并后的值列表为 $(2, -2, -2, 2, 2, -2, -2, 2, 2, 1)$。",
            "answer": "$$ \\boxed{ \\begin{pmatrix} 2  -2  -2  2  2  -2  -2  2  2  1 \\end{pmatrix} } $$"
        },
        {
            "introduction": "定义了子问题之后，我们如何交换信息以收敛到全局解？这个练习  将带你深入了解加性 Schwarz (Additive Schwarz) 迭代的单步过程。通过手动执行一个步骤并将其与经典的 Jacobi 迭代进行比较，你将对“限制-求解-扩展-相加”的工作流程有一个具体的理解，并体会到 Schwarz 方法作为强大预条件子的作用。",
            "id": "2552509",
            "problem": "考虑区间 $[0,6]$ 上的标量扩散问题 $-u''=f$，其具有齐次狄利克雷（Dirichlet）边界条件 $u(0)=u(6)=0$。在间距为 $h=1$ 的均匀网格上，使用连续分片线性有限元进行离散化，使得在 $5$ 个内部节点 $\\{1,2,3,4,5\\}$ 上组装的对称正定 (SPD) 刚度矩阵 $A\\in\\mathbb{R}^{5\\times 5}$ 是标准的三对角矩阵，其对角线元素为 $2$，第一条次对角线和超对角线元素为 $-1$。设右端项为向量 $b=e_{3}\\in\\mathbb{R}^{5}$，其中 $e_{3}$ 是在节点 $3$ 处为 $1$、其余位置为零的单位向量，并从初始猜测 $u^{0}=0$ 开始。\n\n定义一个重叠的三子域分解，其子域索引集为\n- $\\Omega_{1}=\\{1,2,3\\}$，\n- $\\Omega_{2}=\\{3,4,5\\}$，\n- $\\Omega_{3}=\\{2,3,4\\}$。\n\n对于每个子域 $\\Omega_{i}$，设 $R_{i}\\in\\mathbb{R}^{3\\times 5}$ 是按自然顺序提取 $\\Omega_{i}$ 上分量的布尔限制算子，并设局部算子为 $A_{i}=R_{i}AR_{i}^{\\top}\\in\\mathbb{R}^{3\\times 3}$。考虑经典的单层加性 Schwarz 稳态迭代（使用简单注入，无单位分解加权），\n$$\nu^{k+1}=u^{k}+\\sum_{i=1}^{3}R_{i}^{\\top}A_{i}^{-1}R_{i}\\,\\bigl(b-Au^{k}\\bigr),\n$$\n以及全局系统上的 Jacobi 迭代，\n$$\nu^{k+1}=u^{k}+D^{-1}\\bigl(b-Au^{k}\\bigr),\n$$\n其中 $D=\\operatorname{diag}(A)$ 是 $A$ 的对角部分。使用 $u^{0}=0$，对每种方法执行一次迭代以获得 $u_{\\mathrm{AS}}^{1}$ 和 $u_{\\mathrm{J}}^{1}$，并计算相应残差的欧几里得范数之比，\n$$\n\\frac{\\|b-Au_{\\mathrm{AS}}^{1}\\|_{2}}{\\|b-Au_{\\mathrm{J}}^{1}\\|_{2}}.\n$$\n\n请以单个精确表达式（无四舍五入，无小数）的形式给出你的答案。",
            "solution": "该问题陈述是数值线性代数中一个适定的练习，具体涉及求解由微分方程的有限元离散化产生的线性系统的迭代方法。它具有科学依据，定义明确，并包含进行求解所需的所有信息。不存在不一致或无效的前提。我们将继续进行计算。\n\n全局刚度矩阵 $A \\in \\mathbb{R}^{5\\times 5}$ 和右端项向量 $b \\in \\mathbb{R}^{5}$ 如下：\n$$\nA = \\begin{pmatrix} 2  -1  0  0  0 \\\\ -1  2  -1  0  0 \\\\ 0  -1  2  -1  0 \\\\ 0  0  -1  2  -1 \\\\ 0  0  0  -1  2 \\end{pmatrix}, \\quad b = e_{3} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n初始猜测为 $u^{0} = 0 \\in \\mathbb{R}^{5}$。\n\n首先，我们计算一次 Jacobi 方法的迭代。Jacobi 迭代定义为 $u^{k+1} = u^{k} + D^{-1}(b - Au^{k})$，其中 $D = \\operatorname{diag}(A)$。\n对于第一次迭代，当 $k=0$ 且 $u^{0} = 0$ 时，我们有：\n$$\nu_{\\mathrm{J}}^{1} = u^{0} + D^{-1}(b - Au^{0}) = D^{-1}b\n$$\n$A$ 的对角部分是 $D = \\operatorname{diag}(2, 2, 2, 2, 2) = 2I$，其中 $I$ 是 $5 \\times 5$ 的单位矩阵。因此，其逆矩阵为 $D^{-1} = \\frac{1}{2}I$。\n第一次 Jacobi 迭代的结果是：\n$$\nu_{\\mathrm{J}}^{1} = \\frac{1}{2}I b = \\frac{1}{2}b = \\frac{1}{2}e_{3} = \\begin{pmatrix} 0 \\\\ 0 \\\\ \\frac{1}{2} \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\n相应的残差是 $r_{\\mathrm{J}}^{1} = b - Au_{\\mathrm{J}}^{1}$。我们首先计算 $Au_{\\mathrm{J}}^{1}$：\n$$\nA u_{\\mathrm{J}}^{1} = A \\left(\\frac{1}{2}e_{3}\\right) = \\frac{1}{2} (A e_{3}) = \\frac{1}{2} \\begin{pmatrix} 0 \\\\ -1 \\\\ 2 \\\\ -1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ -\\frac{1}{2} \\\\ 1 \\\\ -\\frac{1}{2} \\\\ 0 \\end{pmatrix}\n$$\n然后残差为：\n$$\nr_{\\mathrm{J}}^{1} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ -\\frac{1}{2} \\\\ 1 \\\\ -\\frac{1}{2} \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ \\frac{1}{2} \\\\ 0 \\\\ \\frac{1}{2} \\\\ 0 \\end{pmatrix}\n$$\nJacobi 残差的欧几里得范数是：\n$$\n\\|r_{\\mathrm{J}}^{1}\\|_{2} = \\left\\| \\begin{pmatrix} 0 \\\\ \\frac{1}{2} \\\\ 0 \\\\ \\frac{1}{2} \\\\ 0 \\end{pmatrix} \\right\\|_{2} = \\sqrt{0^{2} + \\left(\\frac{1}{2}\\right)^{2} + 0^{2} + \\left(\\frac{1}{2}\\right)^{2} + 0^{2}} = \\sqrt{\\frac{1}{4} + \\frac{1}{4}} = \\sqrt{\\frac{1}{2}}\n$$\n\n接下来，我们计算一次单层加性 Schwarz 方法的迭代。该迭代为 $u^{k+1} = u^{k} + \\sum_{i=1}^{3} R_{i}^{\\top}A_{i}^{-1}R_{i}\\,(b - Au^{k})$。\n对于第一次迭代，当 $k=0$ 且 $u^{0}=0$ 时，我们有：\n$$\nu_{\\mathrm{AS}}^{1} = \\sum_{i=1}^{3} R_{i}^{\\top}A_{i}^{-1}R_{i}b\n$$\n我们分析每个子域的贡献。局部矩阵为 $A_{i} = R_{i}AR_{i}^{\\top}$。对于子域 $\\Omega_{1} = \\{1,2,3\\}$、$\\Omega_{2} = \\{3,4,5\\}$ 和 $\\Omega_{3} = \\{2,3,4\\}$，相应的局部刚度矩阵是 $A$ 的主子矩阵：\n$$\nA_{1} = A_{2} = A_{3} = \\begin{pmatrix} 2  -1  0 \\\\ -1  2  -1 \\\\ 0  -1  2 \\end{pmatrix}\n$$\n需要求该矩阵的逆。行列式为 $\\det(A_{1}) = 2(2 \\cdot 2 - (-1)(-1)) - (-1)(-1 \\cdot 2 - 0) = 2(3) - 2 = 4$。逆矩阵为：\n$$\nA_{1}^{-1} = A_{2}^{-1} = A_{3}^{-1} = \\frac{1}{4} \\begin{pmatrix} 3  2  1 \\\\ 2  4  2 \\\\ 1  2  3 \\end{pmatrix}\n$$\n现在我们进行局部求解。将右端项 $b=e_{3}$ 限制到每个子域上，得到局部向量 $b_{i} = R_{i}b$：\n$$\nb_{1} = R_{1}b = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}, \\quad b_{2} = R_{2}b = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}, \\quad b_{3} = R_{3}b = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}\n$$\n局部解为 $w_{i} = A_{i}^{-1}b_{i}$：\n$$\nw_{1} = A_{1}^{-1}b_{1} = \\frac{1}{4} \\begin{pmatrix} 3  2  1 \\\\ 2  4  2 \\\\ 1  2  3 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix} = \\frac{1}{4} \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix}\n$$\n$$\nw_{2} = A_{2}^{-1}b_{2} = \\frac{1}{4} \\begin{pmatrix} 3  2  1 \\\\ 2  4  2 \\\\ 1  2  3 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\frac{1}{4} \\begin{pmatrix} 3 \\\\ 2 \\\\ 1 \\end{pmatrix}\n$$\n$$\nw_{3} = A_{3}^{-1}b_{3} = \\frac{1}{4} \\begin{pmatrix} 3  2  1 \\\\ 2  4  2 \\\\ 1  2  3 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\frac{1}{4} \\begin{pmatrix} 2 \\\\ 4 \\\\ 2 \\end{pmatrix}\n$$\n使用 $R_{i}^{\\top}$ 将这些局部解延拓回全局向量空间并求和，以获得第一次加性 Schwarz 迭代的结果：\n$$\nu_{\\mathrm{AS}}^{1} = R_{1}^{\\top}w_{1} + R_{2}^{\\top}w_{2} + R_{3}^{\\top}w_{3} = \\frac{1}{4}\\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\\\ 0 \\\\ 0 \\end{pmatrix} + \\frac{1}{4}\\begin{pmatrix} 0 \\\\ 0 \\\\ 3 \\\\ 2 \\\\ 1 \\end{pmatrix} + \\frac{1}{4}\\begin{pmatrix} 0 \\\\ 2 \\\\ 4 \\\\ 2 \\\\ 0 \\end{pmatrix} = \\frac{1}{4}\\begin{pmatrix} 1 \\\\ 4 \\\\ 10 \\\\ 4 \\\\ 1 \\end{pmatrix}\n$$\n相应的残差是 $r_{\\mathrm{AS}}^{1} = b - Au_{\\mathrm{AS}}^{1}$。我们首先计算 $Au_{\\mathrm{AS}}^{1}$：\n$$\nAu_{\\mathrm{AS}}^{1} = \\frac{1}{4} \\begin{pmatrix} 2  -1  0  0  0 \\\\ -1  2  -1  0  0 \\\\ 0  -1  2  -1  0 \\\\ 0  0  -1  2  -1 \\\\ 0  0  0  -1  2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 4 \\\\ 10 \\\\ 4 \\\\ 1 \\end{pmatrix} = \\frac{1}{4} \\begin{pmatrix} 2-4 \\\\ -1+8-10 \\\\ -4+20-4 \\\\ -10+8-1 \\\\ -4+2 \\end{pmatrix} = \\frac{1}{4} \\begin{pmatrix} -2 \\\\ -3 \\\\ 12 \\\\ -3 \\\\ -2 \\end{pmatrix} = \\begin{pmatrix} -1/2 \\\\ -3/4 \\\\ 3 \\\\ -3/4 \\\\ -1/2 \\end{pmatrix}\n$$\n然后残差为：\n$$\nr_{\\mathrm{AS}}^{1} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\\\ 0 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} -1/2 \\\\ -3/4 \\\\ 3 \\\\ -3/4 \\\\ -1/2 \\end{pmatrix} = \\begin{pmatrix} 1/2 \\\\ 3/4 \\\\ -2 \\\\ 3/4 \\\\ 1/2 \\end{pmatrix}\n$$\n加性 Schwarz 残差的欧几里得范数是：\n$$\n\\|r_{\\mathrm{AS}}^{1}\\|_{2} = \\sqrt{\\left(\\frac{1}{2}\\right)^{2} + \\left(\\frac{3}{4}\\right)^{2} + (-2)^{2} + \\left(\\frac{3}{4}\\right)^{2} + \\left(\\frac{1}{2}\\right)^{2}} = \\sqrt{\\frac{1}{4} + \\frac{9}{16} + 4 + \\frac{9}{16} + \\frac{1}{4}}\n$$\n$$\n\\|r_{\\mathrm{AS}}^{1}\\|_{2} = \\sqrt{2\\left(\\frac{1}{4}\\right) + 2\\left(\\frac{9}{16}\\right) + 4} = \\sqrt{\\frac{1}{2} + \\frac{9}{8} + 4} = \\sqrt{\\frac{4}{8} + \\frac{9}{8} + \\frac{32}{8}} = \\sqrt{\\frac{45}{8}} = \\frac{3\\sqrt{5}}{2\\sqrt{2}} = \\frac{3\\sqrt{10}}{4}\n$$\n最后，我们计算所需的残差范数之比：\n$$\n\\frac{\\|b-Au_{\\mathrm{AS}}^{1}\\|_{2}}{\\|b-Au_{\\mathrm{J}}^{1}\\|_{2}} = \\frac{\\|r_{\\mathrm{AS}}^{1}\\|_{2}}{\\|r_{\\mathrm{J}}^{1}\\|_{2}} = \\frac{\\frac{3\\sqrt{10}}{4}}{\\sqrt{\\frac{1}{2}}} = \\frac{3\\sqrt{10}}{4} \\cdot \\sqrt{2} = \\frac{3\\sqrt{20}}{4} = \\frac{3 \\cdot 2\\sqrt{5}}{4} = \\frac{6\\sqrt{5}}{4} = \\frac{3\\sqrt{5}}{2}\n$$",
            "answer": "$$\n\\boxed{\\frac{3\\sqrt{5}}{2}}\n$$"
        },
        {
            "introduction": "在实际应用中，精确求解子域问题可能成本过高，特别是当子域本身也很大时。这个编程练习  探讨了一个关键的实用概念：非精确 Schwarz 方法 (inexact Schwarz method)。你将实现一个子问题只被近似求解的求解器，并研究这些内部求解的精度与外部 Schwarz 迭代的收敛速度之间的权衡。",
            "id": "2387028",
            "problem": "考虑在单位区间上，对带齐次狄利克雷边界条件的一维泊松方程进行标准中心有限差分格式离散化后得到的线性系统。连续问题为 $-u''(x) = g(x)$，其中 $x \\in (0,1)$，且 $u(0) = 0$ 和 $u(1) = 0$。将该区间离散为 $N$ 个内部点，均匀间距为 $h = 1/(N+1)$，从而得到对称正定线性系统 $A u = f$。其中 $A \\in \\mathbb{R}^{N \\times N}$ 的主对角线元素为 $2/h^2$，第一条次对角线和第一条超对角线上的元素为 $-1/h^2$，而 $f \\in \\mathbb{R}^{N}$ 是离散化后的右端项。在整个问题中，将 $f$ 设置为所有分量都等于 $1$ 的常数向量（无量纲）。目标是通过带有非精确子区域求解的双子区域乘性Schwarz方法来求解 $A u = f$。\n\n将未知量集合划分为两个可能重叠的连续子区域。定义中点索引 $m = \\lfloor N/2 \\rfloor$。对于给定的非负整数重叠参数 $o$，定义索引集\n$$\nI_1 = \\{0,1,\\dots,m+o-1\\}, \\quad I_2 = \\{m-o, m-o+1, \\dots, N-1\\},\n$$\n我们约定，$I_1$ 和 $I_2$ 需与 $\\{0,1,\\dots,N-1\\}$ 取交集，以确保索引在有效范围内。双子区域乘性Schwarz迭代定义如下：从一个全局迭代向量 $x^{(k)} \\in \\mathbb{R}^{N}$ 开始，依次执行\n$$\n\\text{在 } I_1 \\text{ 上求解}: \\quad A_{11} \\, \\delta x_1 = r_1, \\quad \\text{然后更新 } x_{I_1}^{(k+\\frac{1}{2})} = x_{I_1}^{(k)} + \\delta x_1,\n$$\n$$\n\\text{在 } I_2 \\text{ 上求解}: \\quad A_{22} \\, \\delta x_2 = r_2, \\quad \\text{然后更新 } x_{I_2}^{(k+1)} = x_{I_2}^{(k+\\frac{1}{2})} + \\delta x_2,\n$$\n此处，$A_{ii}$ 是 $A$ 限制在 $I_i$ 上的主子矩阵，$r_i$ 是限制残差，其包含了来自补集区域的固定值，定义为 $r_i = b_i - A_{i, I_i} x_{I_i}$，右端项为 $b_i = f_{I_i} - A_{i, \\overline{I_i}} x_{\\overline{I_i}}$。这里，$A_{i, I_i}$ 表示 $A$ 中行索引在 $I_i$、列索引也在 $I_i$ 的块，$A_{i, \\overline{I_i}}$ 表示行索引在 $I_i$、列索引在 $I_i$ 的补集中的块。\n\n在本问题中，子区域的求解不是精确的。而是通过对限制系统 $A_{ii} x_{I_i} = b_i$ 应用固定次数 $m_{\\text{in}} \\in \\mathbb{N}_0$ 的加权Jacobi迭代来非精确地执行，松弛权重为 $\\omega \\in (0,1)$。对 $A_{ii} x_{I_i} = b_i$ 的一次加权Jacobi扫掠具有以下形式\n$$\nx_{I_i}^{\\text{new}} = x_{I_i}^{\\text{old}} + \\omega D_{ii}^{-1} \\left(b_i - A_{ii} x_{I_i}^{\\text{old}}\\right),\n$$\n其中 $D_{ii}$ 是 $A_{ii}$ 的对角部分。每次子区域求解的初始猜测是当前全局迭代向量对应的子向量。经过 $m_{\\text{in}}$ 次扫掠后，子区域的子向量被注回到全局迭代向量中（覆盖该子区域上的分量）。一次完整的外迭代包括 $I_1$ 的更新和其后的 $I_2$ 的更新。\n\n定义全局残差 $r^{(k)} = f - A x^{(k)}$ 及其欧几里得范数 $\\|r^{(k)}\\|_2$。每次外迭代的观测收敛因子由几何平均值量化\n$$\n\\rho_{\\text{obs}} = \\exp\\left( \\frac{1}{K} \\sum_{k=1}^{K} \\log \\frac{\\|r^{(k)}\\|_2}{\\|r^{(k-1)}\\|_2} \\right),\n$$\n从 $x^{(0)} = 0$ 开始，经过 $K$ 次外迭代计算得出。\n\n任务：实现一个程序，针对下方的每个测试用例，按描述构造 $A$ 和 $f$，将索引划分为两个重叠度为 $o$ 的子区域，使用 $m_{\\text{in}}$ 次松弛权重为 $\\omega$ 的加权Jacobi扫掠进行非精确子区域求解，执行 $K$ 次外层乘性Schwarz迭代，并返回观测收敛因子 $\\rho_{\\text{obs}}$，结果四舍五入至六位小数。\n\n所有计算仅使用无量纲量。不涉及角度。没有需要报告的物理单位。\n\n测试套件（每个元组为 $(N, o, m_{\\text{in}}, \\omega, K)$）：\n-   用例 1：$(127, 2, 0, 2/3, 20)$。\n-   用例 2：$(127, 2, 1, 2/3, 20)$。\n-   用例 3：$(127, 2, 3, 2/3, 20)$。\n-   用例 4：$(127, 0, 10, 2/3, 20)$。\n-   用例 5：$(63, 1, 2, 0.8, 20)$。\n\n最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，每个收敛因子四舍五入到六位小数，不含任何其他文本，例如：“[0.950000,0.750000,0.500000]”。",
            "solution": "该问题已经过严格验证，并被确定为有效。它在计算工程和数值线性代数领域内构成了一个适定的、有科学依据的问题。任务是分析针对特定线性系统，采用非精确子区域求解的双子区域乘性Schwarz方法的收敛性。其表述没有歧义、矛盾或事实错误。现提供一个完整的解决方案。\n\n该方法将按照从问题陈述中推导出的精确步骤序列，以算法形式实现。\n\n1.  **系统构建**：问题定义在一个一维域上，离散为 $N$ 个内部点，网格间距为 $h = 1/(N+1)$。这导出一个线性系统 $A u = f$。矩阵 $A \\in \\mathbb{R}^{N \\times N}$ 是一个对称正定矩阵，表示负二阶导数算子的中心有限差分近似。它是一个三对角矩阵，其元素为：\n    $$\n    A_{ij} =\n    \\begin{cases}\n    2/h^2  \\text{若 } i = j \\\\\n    -1/h^2  \\text{若 } |i - j| = 1 \\\\\n    0  \\text{其他情况}\n    \\end{cases}\n    $$\n    右端向量 $f \\in \\mathbb{R}^{N}$ 是一个常数向量，其每个分量都为 $1$。\n\n2.  **区域分解**：将 $N$ 个索引的集合 $\\{0, 1, \\dots, N-1\\}$ 划分为两个重叠的子区域 $I_1$ 和 $I_2$。定义中点索引为 $m = \\lfloor N/2 \\rfloor$，并给定一个非负整数重叠参数 $o$，索引集为：\n    $$\n    I_1 = \\{i \\in \\mathbb{Z} \\mid 0 \\le i  m+o \\} \\cap \\{0, \\dots, N-1\\}\n    $$\n    $$\n    I_2 = \\{i \\in \\mathbb{Z} \\mid m-o \\le i  N \\} \\cap \\{0, \\dots, N-1\\}\n    $$\n    对于每个子区域 $I_i$，我们通过将 $A$ 限制在由 $I_i$ 索引的行和列上，来定义相应的主子矩阵 $A_{ii}$。\n\n3.  **带非精确求解的乘性Schwarz迭代**：问题的核心是从初始猜测 $x^{(0)} = 0$ 开始，对 $A u = f$ 进行迭代求解。一次从 $x^{(k)}$ 计算 $x^{(k+1)}$ 的外迭代包含两个顺序的乘性步骤。\n\n    a.  **子区域1求解**：首先，为子区域 $I_1$ 中的变量计算一个更新量。需要求解的系统是关于一个修正量 $\\delta x_1$ 的：\n        $$\n        A_{11} \\delta x_1 = r_1\n        $$\n        这里，$r_1$ 是限制在 $I_1$ 中索引上的全局残差 $r^{(k)} = f - A x^{(k)}$。此系统使用 $m_{\\text{in}}$ 次加权Jacobi方法迭代非精确求解，初始猜测为 $\\delta x_1 = 0$：\n        $$\n        (\\delta x_1)^{(j+1)} = (\\delta x_1)^{(j)} + \\omega D_{11}^{-1} (r_1 - A_{11} (\\delta x_1)^{(j)}) \\quad \\text{对于 } j=0, \\dots, m_{\\text{in}}-1\n        $$\n        其中 $D_{11}$ 是 $A_{11}$ 的对角部分，$\\omega$ 是松弛权重。最终的修正量用于更新解向量，得到一个中间解 $x^{(k+1/2)}$：\n        $$\n        x_{I_1}^{(k+1/2)} = x_{I_1}^{(k)} + \\delta x_1\n        $$\n        $x$ 在 $I_1$ 之外的分量保持不变。\n\n    b.  **子区域2求解**：其次，对子区域 $I_2$ 重复此过程。通过非精确求解以下方程来计算一个新的修正量 $\\delta x_2$：\n        $$\n        A_{22} \\delta x_2 = r_2\n        $$\n        其中 $r_2$ 是限制在 $I_2$ 上的新全局残差 $r^{(k+1/2)} = f - A x^{(k+1/2)}$。同样，使用 $m_{\\text{in}}$ 次加权Jacobi迭代。然后通过更新中间解来获得外迭代 $k+1$ 的最终解：\n        $$\n        x_{I_2}^{(k+1)} = x_{I_2}^{(k+1/2)} + \\delta x_2\n        $$\n\n4.  **收敛性分析**：迭代方法的有效性由观测收敛因子 $\\rho_{\\text{obs}}$ 来衡量。执行 $K$ 次外迭代后，我们得到一个残差范数序列 $\\|r^{(k)}\\|_2$，其中 $k=0, \\dots, K$。因子 $\\rho_{\\text{obs}}$ 是每次迭代缩减因子的几何平均值：\n    $$\n    \\rho_{\\text{obs}} = \\exp\\left( \\frac{1}{K} \\sum_{k=1}^{K} \\log \\frac{\\|r^{(k)}\\|_2}{\\|r^{(k-1)}\\|_2} \\right)\n    $$\n    该表达式在代数上可以简化为数值上更稳定的形式：\n    $$\n    \\rho_{\\text{obs}} = \\left( \\frac{\\|r^{(K)}\\|_2}{\\|r^{(0)}\\|_2} \\right)^{1/K}\n    $$\n    此公式将用于最终计算。对于 $m_{\\text{in}} = 0$ 的特殊情况，不执行任何Jacobi迭代，修正量 $\\delta x_i$ 始终为零，解永远不会改变。因此，残差范数保持不变，导致 $\\rho_{\\text{obs}} = 1$。",
            "answer": "```python\nimport numpy as np\nfrom scipy.sparse import diags\n\ndef solve():\n    \"\"\"\n    Computes the observed contraction factor for a two-subdomain multiplicative\n    Schwarz method with inexact solves for the 1D Poisson equation.\n    \"\"\"\n    test_cases = [\n        (127, 2, 0, 2/3, 20),  # Case 1\n        (127, 2, 1, 2/3, 20),  # Case 2\n        (127, 2, 3, 2/3, 20),  # Case 3\n        (127, 0, 10, 2/3, 20), # Case 4\n        (63, 1, 2, 0.8, 20),    # Case 5\n    ]\n\n    results = []\n    for N, o, m_in, omega, K in test_cases:\n        # Step 1: System Construction\n        h = 1.0 / (N + 1)\n        h2_inv = 1.0 / (h * h)\n        \n        main_diag = np.full(N, 2.0 * h2_inv)\n        off_diag = np.full(N - 1, -1.0 * h2_inv)\n        \n        A_sparse = diags(\n            [main_diag, off_diag, off_diag], \n            [0, -1, 1], \n            shape=(N, N), \n            format='csr'\n        )\n        A = A_sparse.toarray()\n        f = np.ones(N)\n\n        # Step 2: Domain Decomposition\n        m = N // 2\n        I1 = list(range(m + o))\n        I2 = list(range(m - o, N))\n        \n        A11 = A[np.ix_(I1, I1)]\n        A22 = A[np.ix_(I2, I2)]\n        \n        # The diagonal of A_ii is constant. D_ii_inv is a scalar.\n        D_inv_val = 1.0 / (2.0 * h2_inv)\n\n        # Initialize iteration\n        x = np.zeros(N)\n        residual_norms = []\n        \n        r_initial = f - A @ x\n        residual_norms.append(np.linalg.norm(r_initial))\n        \n        if m_in == 0:\n            # Special case: no inner iterations means no update to x.\n            # Residual norm remains constant, rho = 1.\n            rho_obs = 1.0\n            results.append(f\"{rho_obs:.6f}\")\n            continue\n\n        # Step 3: Multiplicative Schwarz Iterations\n        for _ in range(K):\n            # Subdomain 1 solve\n            r_global = f - A @ x\n            r1 = r_global[I1]\n            delta_x1 = np.zeros(len(I1))\n            for _ in range(m_in):\n                delta_x1 += omega * D_inv_val * (r1 - A11 @ delta_x1)\n            x[I1] += delta_x1\n            \n            # Subdomain 2 solve\n            r_global = f - A @ x\n            r2 = r_global[I2]\n            delta_x2 = np.zeros(len(I2))\n            for _ in range(m_in):\n                delta_x2 += omega * D_inv_val * (r2 - A22 @ delta_x2)\n            x[I2] += delta_x2\n            \n            r_final = f - A @ x\n            residual_norms.append(np.linalg.norm(r_final))\n\n        # Step 4: Convergence Analysis\n        rho_obs = (residual_norms[-1] / residual_norms[0])**(1.0 / K)\n        results.append(f\"{rho_obs:.6f}\")\n\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}