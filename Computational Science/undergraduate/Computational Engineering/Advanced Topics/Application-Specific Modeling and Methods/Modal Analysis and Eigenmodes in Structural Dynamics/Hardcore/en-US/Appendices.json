{
    "hands_on_practices": [
        {
            "introduction": "Transitioning from continuous analytical models to discrete numerical approximations is a foundational skill in computational engineering. This first practice bridges that gap by tackling the classic problem of a vibrating string . By comparing the exact solution to a Finite Element Method (FEM) model, you will gain a tangible understanding of discretization error and see firsthand how mesh refinement improves the accuracy of the computed natural frequencies and mode shapes.",
            "id": "2414089",
            "problem": "Consider an ideal taut string of length $L$ under constant tension $T$ with uniform linear mass density $\\mu$. The transverse displacement $u(x,t)$ satisfies the one-dimensional wave equation with fixed-fixed boundary conditions, namely $u(0,t)=0$ and $u(L,t)=0$. Treat the system as continuous to obtain the exact eigenfrequencies and eigenmodes, and also approximate it using a uniform, piecewise-linear finite element model to obtain discrete eigenfrequencies and eigenmodes.\n\nYour program must, for each specified test case, do the following from first principles:\n- For the continuous string, derive the exact $n$-th angular eigenfrequency $\\omega_n^{\\mathrm{exact}}$ and the corresponding normalized exact mode shape $\\phi_n^{\\mathrm{exact}}(x)$, where normalization is with respect to the Euclidean norm of the vector of nodal samples on a uniform mesh.\n- For the finite element discretization with $N_e$ uniform linear elements over $[0,L]$, assemble the exact global stiffness and mass matrices by integrating the weak form over each element, impose the fixed boundary conditions at $x=0$ and $x=L$, and solve the resulting generalized eigenvalue problem to obtain the $n$-th discrete angular eigenfrequency $\\omega_n^{\\mathrm{fem}}$ and the corresponding normalized discrete mode shape vector $\\phi_n^{\\mathrm{fem}}$ (normalized by the Euclidean norm of the full nodal vector, including the zero boundary nodes).\n- Compare the discrete mode shape to the exact mode shape sampled at the same mesh nodes by first aligning the sign of $\\phi_n^{\\mathrm{fem}}$ to maximize the dot product with the sampled exact mode vector, then computing the maximum absolute nodal error.\n- Compute two metrics for each test case: the relative angular frequency error $|\\omega_n^{\\mathrm{fem}}-\\omega_n^{\\mathrm{exact}}|/\\omega_n^{\\mathrm{exact}}$ (dimensionless) and the maximum absolute nodal mode shape error $\\max_i|\\phi_{n,i}^{\\mathrm{fem}}-\\phi_{n,i}^{\\mathrm{exact}}|$ (dimensionless), where $i$ ranges over all mesh nodes including the boundary nodes.\n\nUse the following physical parameters for all test cases: length $L=1\\,\\mathrm{m}$, tension $T=100\\,\\mathrm{N}$, and linear density $\\mu=0.01\\,\\mathrm{kg/m}$. Angular quantities must be in radians per second. Report all errors as dimensionless real numbers.\n\nTest suite (each test case is a pair $(N_e,n)$ of the number of uniform elements and the mode index):\n- Case $1$: $(N_e,n)=(2,1)$.\n- Case $2$: $(N_e,n)=(4,1)$.\n- Case $3$: $(N_e,n)=(8,2)$.\n- Case $4$: $(N_e,n)=(16,3)$.\n- Case $5$: $(N_e,n)=(8,7)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case result is itself a two-element list of real numbers $[\\text{frequency\\_relative\\_error},\\text{mode\\_shape\\_max\\_nodal\\_error}]$. For the five cases above, the final output format must be\n$[[e_{1,f},e_{1,s}],[e_{2,f},e_{2,s}],[e_{3,f},e_{3,s}],[e_{4,f},e_{4,s}],[e_{5,f},e_{5,s}]]$\nwhere $e_{k,f}$ is the relative angular frequency error and $e_{k,s}$ is the maximum absolute nodal mode shape error for case $k$.",
            "solution": "The problem presented is a well-defined exercise in computational structural dynamics, specifically the comparison of an analytical solution with a numerical approximation via the Finite Element Method (FEM). It is scientifically grounded, mathematically consistent, and all necessary parameters are provided. Therefore, the problem is valid and I will proceed with a full derivation and solution.\n\nThe analysis is divided into three parts: first, the derivation of the exact eigen-solution for the continuous system; second, the formulation and solution of the discrete finite element model; and third, the definition of error metrics for comparison.\n\n**1. Continuous System: Exact Analytical Solution**\n\nThe transverse displacement $u(x,t)$ of an ideal taut string is governed by the one-dimensional wave equation:\n$$\n\\mu \\frac{\\partial^2 u}{\\partial t^2} - T \\frac{\\partial^2 u}{\\partial x^2} = 0, \\quad x \\in [0, L]\n$$\nwhere $\\mu$ is the linear mass density, $T$ is the tension, $L$ is the length of the string, $x$ is the spatial coordinate, and $t$ is time. The boundary conditions are fixed-fixed, meaning $u(0,t) = 0$ and $u(L,t) = 0$.\n\nTo find the natural frequencies and mode shapes (the eigen-solution), we seek standing wave solutions using the method of separation of variables. We assume a solution of the form $u(x,t) = \\phi(x)q(t)$. Substituting this into the wave equation and rearranging yields:\n$$\n\\frac{1}{q(t)} \\frac{d^2 q}{dt^2} = \\frac{T}{\\mu} \\frac{1}{\\phi(x)} \\frac{d^2 \\phi}{dx^2}\n$$\nSince the left side depends only on $t$ and the right side only on $x$, both must be equal to a constant, which we denote as $-\\omega^2$. This yields two ordinary differential equations:\n$$\n\\frac{d^2 q}{dt^2} + \\omega^2 q = 0\n$$\n$$\n\\frac{d^2 \\phi}{dx^2} + k^2 \\phi = 0, \\quad \\text{where } k^2 = \\frac{\\mu \\omega^2}{T}\n$$\nThe spatial equation for the mode shape $\\phi(x)$ has the general solution:\n$$\n\\phi(x) = A \\sin(kx) + B \\cos(kx)\n$$\nApplying the boundary conditions:\n1.  $\\phi(0) = 0 \\implies A \\sin(0) + B \\cos(0) = 0 \\implies B = 0$.\n2.  $\\phi(L) = 0 \\implies A \\sin(kL) = 0$. For a non-trivial solution ($A \\neq 0$), we must have $\\sin(kL) = 0$.\n\nThis condition is satisfied when $kL = n\\pi$ for any integer $n=1, 2, 3, \\dots$. This quantizes the admissible wavenumbers $k_n$:\n$$\nk_n = \\frac{n\\pi}{L}\n$$\nSubstituting this back into the relation for $\\omega^2$, we find the discrete set of angular eigenfrequencies $\\omega_n^{\\mathrm{exact}}$:\n$$\n(\\omega_n^{\\mathrm{exact}})^2 = \\frac{T}{\\mu} k_n^2 = \\frac{T}{\\mu} \\left(\\frac{n\\pi}{L}\\right)^2 \\implies \\omega_n^{\\mathrm{exact}} = \\frac{n\\pi}{L} \\sqrt{\\frac{T}{\\mu}}\n$$\nThe corresponding mode shapes (eigenmodes) are given by:\n$$\n\\phi_n^{\\mathrm{exact}}(x) = \\sin\\left(\\frac{n\\pi x}{L}\\right)\n$$\nwhere the amplitude has been set to $1$ for simplicity, as it will be handled by normalization. For comparison with the FEM solution on a mesh with $N_e$ elements (and thus $N_e+1$ nodes), we sample this continuous function at the nodal coordinates $x_i = i \\cdot (L/N_e)$ for $i=0, 1, \\dots, N_e$. The resulting sampled vector must be normalized by its Euclidean norm, yielding the vector $\\boldsymbol{\\phi}_n^{\\mathrm{exact}}$.\n\n**2. Discrete System: Finite Element Method**\n\nWe begin with the weak form of the spatial governing equation, $-T u'' = \\omega^2 \\mu u$. For a test function $v(x)$ that satisfies the same homogeneous boundary conditions (i.e., $v(0)=v(L)=0$), the weak form is:\n$$\n\\int_0^L v(-T u'') dx = \\int_0^L v(\\omega^2 \\mu u) dx\n$$\nIntegrating the left side by parts gives:\n$$\n\\int_0^L T u' v' dx - [T u' v]_0^L = \\omega^2 \\int_0^L \\mu u v dx\n$$\nThe boundary term $[T u' v]_0^L$ vanishes because $v(0)=v(L)=0$. The weak form becomes:\n$$\n\\int_0^L T u' v' dx = \\omega^2 \\int_0^L \\mu u v dx\n$$\nWe discretize the domain $[0,L]$ into $N_e$ linear elements, each of length $h = L/N_e$. Within each element, the displacement is approximated by linear shape functions $N_1(\\xi), N_2(\\xi)$, where $\\xi \\in [0,h]$ is the local coordinate: $u^e(\\xi) = N_1(\\xi) d_1 + N_2(\\xi) d_2$. The shape functions are $N_1(\\xi) = 1-\\xi/h$ and $N_2(\\xi)=\\xi/h$.\n\nThe element stiffness matrix $k^e$ and mass matrix $m^e$ are derived by substituting the approximation into the weak form, integrating over one element:\n$$\nk_{ij}^e = \\int_0^h T N_i' N_j' d\\xi = \\frac{T}{h} \\begin{pmatrix} 1 & -1 \\\\ -1 & 1 \\end{pmatrix}\n$$\n$$\nm_{ij}^e = \\int_0^h \\mu N_i N_j d\\xi = \\frac{\\mu h}{6} \\begin{pmatrix} 2 & 1 \\\\ 1 & 2 \\end{pmatrix}\n$$\nThis is the consistent mass matrix formulation, as required for accurate eigen-analysis. The global matrices $K$ and $M$ of size $(N_e+1) \\times (N_e+1)$ are assembled by summing the contributions from all $N_e$ elements. This results in the global generalized eigenvalue problem:\n$$\nK\\boldsymbol{\\phi} = \\omega^2 M\\boldsymbol{\\phi}\n$$\nThe fixed boundary conditions $u(0)=0$ and $u(L)=0$ mean that the first and last nodal displacements are zero. We enforce this by removing the first and last rows and columns from $K$ and $M$, creating the reduced system $K_{red}\\boldsymbol{\\phi}_{red} = \\omega^2 M_{red}\\boldsymbol{\\phi}_{red}$ of size $(N_e-1) \\times (N_e-1)$ for the internal nodes.\n\nSolving this reduced eigenvalue problem yields $N_e-1$ pairs of eigenvalues $(\\omega_n^{\\mathrm{fem}})^2$ and eigenvectors $\\boldsymbol{\\phi}_{n,red}^{\\mathrm{fem}}$. The full mode shape vector $\\boldsymbol{\\phi}_n^{\\mathrm{fem}}$ is reconstructed by padding the reduced eigenvector with zeros at the boundaries. This full vector is then normalized by its Euclidean norm.\n\n**3. Error Computation**\n\nFor each test case $(N_e, n)$, we compute the two specified metrics:\n- **Relative Frequency Error**: The relative error between the $n$-th FEM eigenfrequency and the $n$-th exact eigenfrequency.\n$$\ne_f = \\frac{|\\omega_n^{\\mathrm{fem}} - \\omega_n^{\\mathrm{exact}}|}{\\omega_n^{\\mathrm{exact}}}\n$$\n- **Maximum Nodal Mode Shape Error**: First, we must align the sign of the numerically computed eigenvector. An eigenvector $\\boldsymbol{\\phi}$ and its negative $-\\boldsymbol{\\phi}$ are mathematically equivalent. We ensure a consistent comparison by multiplying $\\boldsymbol{\\phi}_n^{\\mathrm{fem}}$ by $\\text{sign}(\\boldsymbol{\\phi}_n^{\\mathrm{fem}} \\cdot \\boldsymbol{\\phi}_n^{\\mathrm{exact}})$, where $\\boldsymbol{\\phi}_n^{\\mathrm{exact}}$ is the vector of sampled exact mode shape values. After alignment, the error is the maximum absolute difference between the components of the normalized FEM and normalized exact mode vectors.\n$$\ne_s = \\max_i |\\phi_{n,i}^{\\mathrm{fem}} - \\phi_{n,i}^{\\mathrm{exact}}|\n$$\nThis procedure provides a rigorous quantification of the accuracy of the finite element model for both frequency and mode shape prediction. Higher-order modes and coarser meshes are expected to yield larger errors.",
            "answer": "```python\nimport numpy as np\nfrom scipy.linalg import eigh\n\ndef solve():\n    \"\"\"\n    Solves for the eigenfrequencies and eigenmodes of a taut string using both an\n    analytical continuous model and a discrete finite element model, and computes\n    the error between them for specified test cases.\n    \"\"\"\n    # Physical parameters\n    L = 1.0  # m\n    T = 100.0  # N\n    MU = 0.01  # kg/m\n\n    # Test suite: (Number of elements Ne, Mode index n)\n    test_cases = [\n        (2, 1),\n        (4, 1),\n        (8, 2),\n        (16, 3),\n        (8, 7),\n    ]\n\n    all_results = []\n\n    for Ne, n_mode in test_cases:\n        # --- 1. Exact Analytical Solution ---\n        # Exact angular eigenfrequency\n        omega_exact = (n_mode * np.pi / L) * np.sqrt(T / MU)\n\n        # Nodal coordinates for a mesh with Ne elements\n        num_nodes = Ne + 1\n        nodes = np.linspace(0, L, num_nodes)\n\n        # Sample the exact mode shape at the nodes\n        phi_exact_sampled = np.sin(n_mode * np.pi * nodes / L)\n        \n        # Normalize the sampled exact mode shape vector by its Euclidean norm\n        norm_exact = np.linalg.norm(phi_exact_sampled)\n        # Avoid division by zero if the mode shape is accidentally all zeros\n        phi_exact_normalized = phi_exact_sampled / norm_exact if norm_exact > 0 else phi_exact_sampled\n\n        # --- 2. Finite Element Method (FEM) Solution ---\n        h = L / Ne  # Element length\n\n        # Element stiffness matrix k^e\n        k_e = (T / h) * np.array([[1, -1], [-1, 1]])\n\n        # Element consistent mass matrix m^e\n        m_e = (MU * h / 6.0) * np.array([[2, 1], [1, 2]])\n\n        # Assemble global matrices K and M\n        K_global = np.zeros((num_nodes, num_nodes))\n        M_global = np.zeros((num_nodes, num_nodes))\n\n        for i in range(Ne):\n            # Assembly indices for the two nodes of element i\n            idx = np.array([i, i + 1])\n            K_global[np.ix_(idx, idx)] += k_e\n            M_global[np.ix_(idx, idx)] += m_e\n\n        # Apply fixed-fixed boundary conditions by reducing the system\n        # (remove first and last rows/columns, corresponding to nodes 0 and Ne)\n        internal_dofs = slice(1, Ne)\n        K_red = K_global[internal_dofs, internal_dofs]\n        M_red = M_global[internal_dofs, internal_dofs]\n\n        # Solve the generalized eigenvalue problem: K_red * v = lambda * M_red * v\n        # eigh returns eigenvalues in ascending order and corresponding eigenvectors\n        # The number of internal DoFs is Ne - 1.\n        # This will fail if n_mode > Ne - 1, as the model cannot capture that mode.\n        if n_mode > Ne - 1:\n            # This case is physically not representable by the mesh,\n            # though the problem setup avoids this.\n            all_results.append([np.inf, np.inf])\n            continue\n            \n        eigenvalues, eigenvectors = eigh(K_red, M_red)\n\n        # The n-th eigenvalue (_lambda) corresponds to omega^2\n        # Use (n_mode - 1) for 0-based indexing\n        _lambda = eigenvalues[n_mode - 1]\n        omega_fem = np.sqrt(_lambda)\n\n        # Get the corresponding eigenvector for the reduced system\n        phi_fem_red = eigenvectors[:, n_mode - 1]\n\n        # Reconstruct the full mode shape vector including boundary nodes\n        phi_fem_full = np.zeros(num_nodes)\n        phi_fem_full[internal_dofs] = phi_fem_red\n        \n        # Normalize the full FEM mode shape vector by its Euclidean norm\n        norm_fem = np.linalg.norm(phi_fem_full)\n        phi_fem_normalized = phi_fem_full / norm_fem if norm_fem > 0 else phi_fem_full\n\n        # --- 3. Comparison and Error Calculation ---\n\n        # Align sign of FEM eigenvector to match the exact one\n        if np.dot(phi_fem_normalized, phi_exact_normalized) < 0:\n            phi_fem_normalized *= -1.0\n\n        # Relative angular frequency error\n        freq_rel_error = np.abs(omega_fem - omega_exact) / omega_exact\n\n        # Maximum absolute nodal mode shape error\n        mode_shape_max_error = np.max(np.abs(phi_fem_normalized - phi_exact_normalized))\n\n        all_results.append([freq_rel_error, mode_shape_max_error])\n\n    # Format the final output string\n    output_str = \"[\" + \",\".join([f\"[{e[0]},{e[1]}]\" for e in all_results]) + \"]\"\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "Real-world structures often exhibit complex dynamic behaviors that simple models miss. This exercise explores the important phenomenon of structural coupling, where the asymmetric geometry of a beam causes its bending and torsional motions to become linked . Using a Lagrangian approach, you will derive the coupled equations of motion and discover how an offset between the mass centroid and shear center manifests as off-diagonal terms in the system's mass matrix, fundamentally altering its vibrational characteristics.",
            "id": "2414127",
            "problem": "A uniform straight beam of length $L$ with an open, asymmetric cross-section (for example, a C-channel) exhibits coupling between lateral bending and torsion due to the offset between the shear center and the mass centroid. Assume the beam is simply supported in bending and free in warping, with negligible rotary inertia in bending and no axial motion. Let the transverse displacement of the mass centroid be $w(x,t)$ and the twist about the beam axis be $\\varphi(x,t)$, both measured with respect to the shear center axis, and let the shear center be at a constant perpendicular offset $e$ from the mass centroid along the direction of $w$. Adopt the Euler–Bernoulli beam theory for bending and Saint-Venant theory for torsion, neglecting warping stiffness. Use a single-term assumed-mode approximation\n$$\nw(x,t) = q_1(t)\\sin\\left(\\frac{\\pi x}{L}\\right),\\quad \\varphi(x,t) = q_2(t)\\sin\\left(\\frac{\\pi x}{L}\\right),\n$$\nwhere $q_1(t)$ and $q_2(t)$ are generalized coordinates.\n\nStarting from first principles, namely the balance of energy and Lagrange’s equations derived from Newton’s laws, proceed as follows without invoking any specialized shortcut formulas:\n- Construct the total kinetic energy $T$ and the total potential energy $V$ of the beam segment using the above kinematic assumptions. The kinetic energy must include the translational kinetic energy of the mass centroid and the rotational kinetic energy due to torsion, explicitly capturing the coupling induced by the shear-center offset $e$. The potential energy must include bending strain energy and torsional strain energy. Assume the material density is $\\rho$, the cross-sectional area is $A$, the second moment of area for the bending axis of interest is $I_b$, the polar second moment of area (for mass) about the beam axis is $I_p$, Young’s modulus is $E$, the shear modulus is $G$, and the Saint-Venant torsion constant is $J$. Treat $\\rho$, $A$, $I_b$, $I_p$, $E$, $G$, $J$, $e$, and $L$ as positive constants. Use the angle unit radians for $\\varphi$.\n- Apply the assumed-mode distributions to evaluate the integrals over $x\\in[0,L]$ and assemble a $2\\times 2$ mass matrix $\\mathbf{M}$ and a $2\\times 2$ stiffness matrix $\\mathbf{K}$ such that the equations of motion take the form\n$$\n\\mathbf{M}\\,\\ddot{\\mathbf{q}}(t) + \\mathbf{K}\\,\\mathbf{q}(t) = \\mathbf{0},\\quad \\text{with } \\mathbf{q}(t) = \\begin{bmatrix} q_1(t) \\\\ q_2(t) \\end{bmatrix}.\n$$\n- Formulate the generalized, symmetric eigenvalue problem\n$$\n\\left(\\mathbf{K} - \\omega^2 \\mathbf{M}\\right)\\mathbf{\\Phi} = \\mathbf{0},\n$$\nand define the two natural circular frequencies $\\omega$ as the positive square roots of the two eigenvalues $\\omega^2$. Express the final answers in radians per second (rad/s).\n\nImplement a program that, for each test case below, computes the two natural circular frequencies, sorts them in ascending order, and rounds each to exactly $6$ decimal places. Your program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets, formed by concatenating the two frequencies from each test case in the order the cases are listed (a flattened list).\n\nUse International System of Units (SI) consistently. All inputs are given in SI units. Report the frequencies in rad/s.\n\nTest suite (each line defines one test case as a tuple $(\\rho, A, I_b, I_p, E, G, J, e, L)$):\n- Case $1$ (no coupling baseline): $(\\; \\rho = 7850,\\; A = 6\\times 10^{-4},\\; I_b = 8\\times 10^{-6},\\; I_p = 6\\times 10^{-6},\\; E = 2.10\\times 10^{11},\\; G = 8.0\\times 10^{10},\\; J = 1.5\\times 10^{-7},\\; e = 0.0,\\; L = 2.0 \\;)$.\n- Case $2$ (moderate coupling via $e$): $(\\; \\rho = 7850,\\; A = 6\\times 10^{-4},\\; I_b = 8\\times 10^{-6},\\; I_p = 6\\times 10^{-6},\\; E = 2.10\\times 10^{11},\\; G = 8.0\\times 10^{10},\\; J = 1.5\\times 10^{-7},\\; e = 0.03,\\; L = 2.0 \\;)$.\n- Case $3$ (stronger coupling and weaker torsion): $(\\; \\rho = 7850,\\; A = 6\\times 10^{-4},\\; I_b = 8\\times 10^{-6},\\; I_p = 6\\times 10^{-6},\\; E = 2.10\\times 10^{11},\\; G = 8.0\\times 10^{10},\\; J = 8.0\\times 10^{-8},\\; e = 0.05,\\; L = 2.0 \\;)$.\n- Case $4$ (length effect): $(\\; \\rho = 7850,\\; A = 6\\times 10^{-4},\\; I_b = 8\\times 10^{-6},\\; I_p = 6\\times 10^{-6},\\; E = 2.10\\times 10^{11},\\; G = 8.0\\times 10^{10},\\; J = 1.5\\times 10^{-7},\\; e = 0.03,\\; L = 1.0 \\;)$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $[\\omega_{1,\\text{case }1},\\omega_{2,\\text{case }1},\\omega_{1,\\text{case }2},\\omega_{2,\\text{case }2},\\dots]$, where each $\\omega$ is rounded to exactly $6$ decimal places and expressed in rad/s.",
            "solution": "The problem requires the derivation of the equations of motion for a beam with coupled bending-torsion dynamics using a Lagrangian approach and an assumed-mode discretization. The final goal is to compute the natural frequencies of the system.\n\nThe problem statement has a minor ambiguity in its definition of the kinematic variables. It defines $w(x,t)$ as \"the transverse displacement of the mass centroid\" but also states it is \"measured with respect to the shear center axis\". In standard formulations of this problem, the primary kinematic variables are the displacement of and rotation about the shear center, as this simplifies the potential energy expressions. The kinetic energy is then expressed in terms of these variables by considering the motion of the mass centroid. A literal interpretation leads to unnecessary complexity. Therefore, I will proceed under the standard, physically consistent assumption that $w(x,t)$ represents the transverse displacement of the shear center line and $\\varphi(x,t)$ is the angle of twist about the shear center line. This interpretation is consistent with the problem's reference to Euler-Bernoulli bending and Saint-Venant torsion, which are naturally formulated with respect to the shear center.\n\nThe governing equations for a conservative, linear system can be derived from the Lagrangian $\\mathcal{L} = T - V$, where $T$ is the total kinetic energy and $V$ is the total potential energy. For a system described by a set of generalized coordinates $\\mathbf{q}$, the equations of motion are given by Lagrange's equations:\n$$\n\\frac{d}{dt}\\left(\\frac{\\partial \\mathcal{L}}{\\partial \\dot{q}_k}\\right) - \\frac{\\partial \\mathcal{L}}{\\partial q_k} = 0\n$$\nFor small vibrations around equilibrium, the kinetic and potential energies can be expressed as quadratic forms:\n$$\nT = \\frac{1}{2}\\dot{\\mathbf{q}}^T \\mathbf{M} \\dot{\\mathbf{q}}, \\quad V = \\frac{1}{2}\\mathbf{q}^T \\mathbf{K} \\mathbf{q}\n$$\nwhere $\\mathbf{M}$ is the mass matrix and $\\mathbf{K}$ is the stiffness matrix. This leads to the matrix equation of motion $\\mathbf{M}\\ddot{\\mathbf{q}} + \\mathbf{K}\\mathbf{q} = \\mathbf{0}$.\n\nFirst, we construct the total kinetic energy $T$. The kinetic energy of a differential beam element of length $dx$ is the sum of the translational kinetic energy of its mass centroid and the rotational kinetic energy about its longitudinal axis. Let $\\rho$ be the material density and $A$ be the cross-sectional area. The mass per unit length is $m' = \\rho A$. The transverse velocity of the mass centroid, $\\dot{w}_c$, located at an offset $e$ from the shear center, is given by the kinematics of rigid cross-section motion:\n$$\n\\dot{w}_c(x,t) = \\frac{\\partial}{\\partial t} \\left( w(x,t) + e\\varphi(x,t) \\right) = \\dot{w}(x,t) + e\\dot{\\varphi}(x,t)\n$$\nThe mass polar moment of inertia per unit length about the shear center axis is $I'_p = \\rho I_p$. The differential kinetic energy $dT$ is:\n$$\ndT = \\frac{1}{2} (\\rho A) (\\dot{w}_c)^2 dx + \\frac{1}{2} (\\rho I_p) (\\dot{\\varphi})^2 dx\n$$\nSubstituting the expression for $\\dot{w}_c$:\n$$\ndT = \\frac{1}{2} \\rho A (\\dot{w} + e\\dot{\\varphi})^2 dx + \\frac{1}{2} \\rho I_p \\dot{\\varphi}^2 dx = \\frac{1}{2} \\left[ \\rho A \\dot{w}^2 + 2\\rho A e \\dot{w}\\dot{\\varphi} + \\rho(A e^2 + I_p)\\dot{\\varphi}^2 \\right] dx\n$$\nThe total kinetic energy $T$ is obtained by integrating $dT$ over the beam length $L$. We substitute the assumed modes $w(x,t) = q_1(t)\\sin(\\frac{\\pi x}{L})$ and $\\varphi(x,t) = q_2(t)\\sin(\\frac{\\pi x}{L})$ and their time derivatives:\n$$\nT = \\frac{1}{2} \\int_0^L \\left[ \\rho A \\dot{q}_1^2\\sin^2\\left(\\frac{\\pi x}{L}\\right) + 2\\rho A e \\dot{q}_1 \\dot{q}_2\\sin^2\\left(\\frac{\\pi x}{L}\\right) + \\rho(A e^2 + I_p) \\dot{q}_2^2\\sin^2\\left(\\frac{\\pi x}{L}\\right) \\right] dx\n$$\nUsing the definite integral $\\int_0^L \\sin^2(\\frac{\\pi x}{L}) dx = \\frac{L}{2}$, we obtain:\n$$\nT = \\frac{1}{2} \\left[ \\left(\\frac{\\rho A L}{2}\\right)\\dot{q}_1^2 + 2\\left(\\frac{\\rho A e L}{2}\\right)\\dot{q}_1 \\dot{q}_2 + \\left(\\frac{\\rho L(A e^2 + I_p)}{2}\\right)\\dot{q}_2^2 \\right]\n$$\nFrom this quadratic form, the symmetric $2 \\times 2$ mass matrix $\\mathbf{M}$ is identified as:\n$$\n\\mathbf{M} = \\begin{bmatrix} M_{11} & M_{12} \\\\ M_{21} & M_{22} \\end{bmatrix} = \\frac{\\rho L}{2} \\begin{bmatrix} A & A e \\\\ A e & A e^2 + I_p \\end{bmatrix}\n$$\n\nNext, we construct the total potential energy $V$. It is the sum of the bending strain energy $V_b$ and the torsional strain energy $V_t$. Based on Euler-Bernoulli beam theory, the bending energy is:\n$$\nV_b = \\frac{1}{2} \\int_0^L E I_b \\left(\\frac{\\partial^2 w}{\\partial x^2}\\right)^2 dx\n$$\nBased on Saint-Venant torsion theory (neglecting warping), the torsional energy is:\n$$\nV_t = \\frac{1}{2} \\int_0^L G J \\left(\\frac{\\partial \\varphi}{\\partial x}\\right)^2 dx\n$$\nThe total potential energy is $V = V_b + V_t$. We substitute the assumed modes and their spatial derivatives:\n$$\n\\frac{\\partial^2 w}{\\partial x^2} = -q_1(t)\\left(\\frac{\\pi}{L}\\right)^2 \\sin\\left(\\frac{\\pi x}{L}\\right), \\quad \\frac{\\partial \\varphi}{\\partial x} = q_2(t)\\left(\\frac{\\pi}{L}\\right) \\cos\\left(\\frac{\\pi x}{L}\\right)\n$$\n$$\nV = \\frac{1}{2} \\int_0^L E I_b \\left[-q_1\\left(\\frac{\\pi}{L}\\right)^2 \\sin\\left(\\frac{\\pi x}{L}\\right)\\right]^2 dx + \\frac{1}{2} \\int_0^L G J \\left[q_2\\left(\\frac{\\pi}{L}\\right) \\cos\\left(\\frac{\\pi x}{L}\\right)\\right]^2 dx\n$$\n$$\nV = \\frac{1}{2} E I_b q_1^2 \\left(\\frac{\\pi}{L}\\right)^4 \\int_0^L \\sin^2\\left(\\frac{\\pi x}{L}\\right) dx + \\frac{1}{2} G J q_2^2 \\left(\\frac{\\pi}{L}\\right)^2 \\int_0^L \\cos^2\\left(\\frac{\\pi x}{L}\\right) dx\n$$\nUsing the integrals $\\int_0^L \\sin^2(\\frac{\\pi x}{L}) dx = \\frac{L}{2}$ and $\\int_0^L \\cos^2(\\frac{\\pi x}{L}) dx = \\frac{L}{2}$:\n$$\nV = \\frac{1}{2} \\left[ \\left(\\frac{E I_b \\pi^4}{2L^3}\\right)q_1^2 + \\left(\\frac{G J \\pi^2}{2L}\\right)q_2^2 \\right]\n$$\nFrom this quadratic form, the symmetric $2 \\times 2$ stiffness matrix $\\mathbf{K}$ is identified as:\n$$\n\\mathbf{K} = \\begin{bmatrix} K_{11} & K_{12} \\\\ K_{21} & K_{22} \\end{bmatrix} = \\begin{bmatrix} \\frac{E I_b \\pi^4}{2L^3} & 0 \\\\ 0 & \\frac{G J \\pi^2}{2L} \\end{bmatrix}\n$$\n\nWith the mass and stiffness matrices derived, we formulate the generalized eigenvalue problem. Assuming harmonic motion of the form $\\mathbf{q}(t) = \\mathbf{\\Phi} e^{i\\omega t}$, where $\\mathbf{\\Phi}$ is the mode shape vector and $\\omega$ is the natural frequency, the equation of motion $\\mathbf{M}\\ddot{\\mathbf{q}} + \\mathbf{K}\\mathbf{q} = \\mathbf{0}$ becomes:\n$$\n(-\\omega^2 \\mathbf{M} + \\mathbf{K})\\mathbf{\\Phi} = \\mathbf{0} \\quad \\text{or} \\quad (\\mathbf{K} - \\omega^2 \\mathbf{M})\\mathbf{\\Phi} = \\mathbf{0}\n$$\nThis is a generalized eigenvalue problem for the eigenvalues $\\lambda = \\omega^2$ and eigenvectors $\\mathbf{\\Phi}$. For each given set of physical parameters, we construct the matrices $\\mathbf{M}$ and $\\mathbf{K}$ and solve for the two eigenvalues $\\lambda_1, \\lambda_2$. The two natural circular frequencies are then $\\omega_1 = \\sqrt{\\lambda_1}$ and $\\omega_2 = \\sqrt{\\lambda_2}$. The provided code implements this procedure to calculate the frequencies for each test case.",
            "answer": "```python\nimport numpy as np\nfrom scipy.linalg import eig\n\ndef solve():\n    \"\"\"\n    Computes the first two natural frequencies for a beam with coupled\n    bending-torsion vibrations based on a 2-DOF assumed-mode model.\n    \"\"\"\n\n    # Test suite: (rho, A, I_b, I_p, E, G, J, e, L)\n    test_cases = [\n        # Case 1 (no coupling baseline)\n        (7850, 6e-4, 8e-6, 6e-6, 2.10e11, 8.0e10, 1.5e-7, 0.0, 2.0),\n        # Case 2 (moderate coupling via e)\n        (7850, 6e-4, 8e-6, 6e-6, 2.10e11, 8.0e10, 1.5e-7, 0.03, 2.0),\n        # Case 3 (stronger coupling and weaker torsion)\n        (7850, 6e-4, 8e-6, 6e-6, 2.10e11, 8.0e10, 8.0e-8, 0.05, 2.0),\n        # Case 4 (length effect)\n        (7850, 6e-4, 8e-6, 6e-6, 2.10e11, 8.0e10, 1.5e-7, 0.03, 1.0),\n    ]\n\n    all_frequencies = []\n\n    for case in test_cases:\n        rho, A, I_b, I_p, E, G, J, e, L = case\n\n        # Construct the 2x2 mass matrix M\n        m_factor = rho * L / 2.0\n        M11 = m_factor * A\n        M12 = m_factor * A * e\n        M22 = m_factor * (A * e**2 + I_p)\n        M = np.array([[M11, M12], [M12, M22]])\n\n        # Construct the 2x2 stiffness matrix K\n        K11 = (E * I_b * np.pi**4) / (2.0 * L**3)\n        K22 = (G * J * np.pi**2) / (2.0 * L)\n        K = np.array([[K11, 0.0], [0.0, K22]])\n\n        # Solve the generalized eigenvalue problem (K - w^2 * M) * v = 0\n        # eig returns eigenvalues (w^2) and eigenvectors (v)\n        # We only need the eigenvalues\n        eigenvalues, _ = eig(K, M)\n\n        # The eigenvalues should be real and positive.\n        # Take the real part to handle potential small imaginary parts from numerics.\n        # Frequencies are the square roots of the eigenvalues.\n        frequencies = np.sqrt(np.real(eigenvalues))\n\n        # Sort frequencies in ascending order\n        frequencies.sort()\n\n        # Round to 6 decimal places and add to the final list\n        all_frequencies.extend(np.round(frequencies, 6))\n\n    # Format the final output as a comma-separated list in brackets\n    print(f\"[{','.join(map(str, all_frequencies))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "While undamped analysis provides a good first approximation, all real structures dissipate energy. This final practice introduces the effects of non-proportional damping, a realistic scenario where the system's damping properties are not aligned with its mass and stiffness distributions . You will solve a quadratic eigenvalue problem to find the resulting complex eigenvalues and eigenvectors, which describe vibrations as traveling waves with coupled amplitude and phase information, providing a deeper and more accurate understanding of damped structural dynamics.",
            "id": "2414124",
            "problem": "Consider a linear time-invariant three-degree-of-freedom structural model with generalized mass matrix $\\mathbf{M}$, stiffness matrix $\\mathbf{K}$, and viscous damping matrix $\\mathbf{C}$, governed by the second-order system $\\mathbf{M}\\,\\ddot{\\mathbf{x}}(t)+\\mathbf{C}\\,\\dot{\\mathbf{x}}(t)+\\mathbf{K}\\,\\mathbf{x}(t)=\\mathbf{0}$. The generalized mass matrix is $\\mathbf{M}=\\operatorname{diag}(1,1,1)$ (in consistent units), and the generalized stiffness matrix is $\\mathbf{K}=\\operatorname{diag}(9,9,16)$ (in consistent units), corresponding to three independent single-degree-of-freedom springs to ground with undamped natural frequencies $\\omega_{1}=\\omega_{2}=3$ and $\\omega_{3}=4$. Define a symmetric, positive-definite, non-proportional viscous damping matrix that couples only the first two degrees of freedom and leaves the third uncoupled as\n$$\n\\mathbf{C}=\\begin{bmatrix}\n1 & 0.6 & 0\\\\\n0.6 & 1 & 0\\\\\n0 & 0 & 0.8\n\\end{bmatrix}.\n$$\nStarting from the governing equations of motion, formulate the associated quadratic eigenvalue problem, determine the complex eigenvalues and corresponding displacement eigenvectors, and give a concise physical interpretation of each eigenmode in terms of the relative motion of the coordinates. Finally, what is the damped natural frequency (the magnitude of the imaginary part of the eigenvalue) of the out-of-phase mode associated with the first two degrees of freedom? Express the final answer in radians per second and round your answer to four significant figures.",
            "solution": "The problem will first be validated for scientific soundness, clarity, and completeness.\n\n### Step 1: Extract Givens\n- **Governing Equation**: $\\mathbf{M}\\,\\ddot{\\mathbf{x}}(t)+\\mathbf{C}\\,\\dot{\\mathbf{x}}(t)+\\mathbf{K}\\,\\mathbf{x}(t)=\\mathbf{0}$\n- **Generalized Mass Matrix**: $\\mathbf{M}=\\operatorname{diag}(1,1,1) = \\begin{bmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{bmatrix}$\n- **Generalized Stiffness Matrix**: $\\mathbf{K}=\\operatorname{diag}(9,9,16) = \\begin{bmatrix} 9 & 0 & 0 \\\\ 0 & 9 & 0 \\\\ 0 & 0 & 16 \\end{bmatrix}$\n- **Generalized Damping Matrix**: $\\mathbf{C}=\\begin{bmatrix} 1 & 0.6 & 0\\\\ 0.6 & 1 & 0\\\\ 0 & 0 & 0.8 \\end{bmatrix}$\n- **Task**: Formulate the quadratic eigenvalue problem, find complex eigenvalues and eigenvectors, interpret the modes, and find the damped natural frequency of the out-of-phase mode for the first two degrees of freedom. The final numerical answer must be rounded to four significant figures.\n\n### Step 2: Validate Using Extracted Givens\nThe problem is assessed against the required criteria.\n- **Scientifically Grounded**: The problem describes a linear time-invariant (LTI) multi-degree-of-freedom mechanical system with viscous damping. The governing equation and the subsequent modal analysis via a quadratic eigenvalue problem (QEP) are standard, fundamental concepts in structural dynamics and computational engineering. The problem is scientifically sound.\n- **Well-Posed**: The problem provides all necessary information. The mass matrix $\\mathbf{M}$ is the identity matrix, hence positive definite. The stiffness matrix $\\mathbf{K}$ is diagonal with positive entries, hence positive definite. The damping matrix $\\mathbf{C}$ is symmetric and its positive definiteness can be checked by its eigenvalues or Sylvester's criterion. The leading principal minors are $\\det(1)=1 > 0$ and $\\det\\begin{pmatrix} 1 & 0.6 \\\\ 0.6 & 1 \\end{pmatrix} = 1 - 0.36 = 0.64 > 0$, and $\\det(\\mathbf{C}) = 0.64 \\times 0.8 = 0.512 > 0$. Thus, $\\mathbf{C}$ is positive definite. A system with positive definite $\\mathbf{M}$, $\\mathbf{K}$, and $\\mathbf{C}$ matrices is well-behaved and leads to a well-posed eigenvalue problem.\n- **Objective**: The problem is stated using precise mathematical and engineering terminology, free from any subjectivity or ambiguity.\n\n### Step 3: Verdict and Action\nThe problem is valid. It is a standard, well-posed problem in structural dynamics. A complete solution will be provided.\n\n### Solution\nThe dynamics of the system are governed by the second-order matrix differential equation:\n$$\n\\mathbf{M}\\,\\ddot{\\mathbf{x}}(t)+\\mathbf{C}\\,\\dot{\\mathbf{x}}(t)+\\mathbf{K}\\,\\mathbf{x}(t)=\\mathbf{0}\n$$\nTo find the eigenmodes of the system, we assume a solution of the form $\\mathbf{x}(t) = \\mathbf{u} e^{\\lambda t}$, where $\\lambda$ is a complex eigenvalue and $\\mathbf{u}$ is the corresponding complex eigenvector. Substituting this into the governing equation yields:\n$$\n\\mathbf{M}(\\lambda^2 \\mathbf{u} e^{\\lambda t}) + \\mathbf{C}(\\lambda \\mathbf{u} e^{\\lambda t}) + \\mathbf{K}(\\mathbf{u} e^{\\lambda t}) = \\mathbf{0}\n$$\nSince $\\mathbf{u} e^{\\lambda t}$ cannot be the zero vector for a non-trivial solution, we can factor it out, which leads to the quadratic eigenvalue problem (QEP):\n$$\n(\\lambda^2 \\mathbf{M} + \\lambda \\mathbf{C} + \\mathbf{K}) \\mathbf{u} = \\mathbf{0}\n$$\nSubstituting the given matrices $\\mathbf{M}$, $\\mathbf{C}$, and $\\mathbf{K}$:\n$$\n\\left( \\lambda^2 \\begin{bmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{bmatrix} + \\lambda \\begin{bmatrix} 1 & 0.6 & 0 \\\\ 0.6 & 1 & 0 \\\\ 0 & 0 & 0.8 \\end{bmatrix} + \\begin{bmatrix} 9 & 0 & 0 \\\\ 0 & 9 & 0 \\\\ 0 & 0 & 16 \\end{bmatrix} \\right) \\mathbf{u} = \\mathbf{0}\n$$\nThis combines into the matrix polynomial $\\mathbf{P}(\\lambda)$:\n$$\n\\mathbf{P}(\\lambda) = \\begin{bmatrix} \\lambda^2 + \\lambda + 9 & 0.6\\lambda & 0 \\\\ 0.6\\lambda & \\lambda^2 + \\lambda + 9 & 0 \\\\ 0 & 0 & \\lambda^2 + 0.8\\lambda + 16 \\end{bmatrix}\n$$\nFor a non-trivial eigenvector $\\mathbf{u}$, the determinant of the matrix polynomial must be zero:\n$$\n\\det(\\mathbf{P}(\\lambda)) = 0\n$$\nDue to the block-diagonal structure of $\\mathbf{P}(\\lambda)$, the third degree of freedom is uncoupled from the first two. The determinant calculation simplifies to:\n$$\n(\\lambda^2 + 0.8\\lambda + 16) \\det \\begin{pmatrix} \\lambda^2 + \\lambda + 9 & 0.6\\lambda \\\\ 0.6\\lambda & \\lambda^2 + \\lambda + 9 \\end{pmatrix} = 0\n$$\nThis gives two separate characteristic equations:\n1. For the third degree of freedom: $\\lambda^2 + 0.8\\lambda + 16 = 0$\n2. For the first two coupled degrees of freedom: $(\\lambda^2 + \\lambda + 9)^2 - (0.6\\lambda)^2 = 0$\n\nFirst, we analyze the third degree of freedom. Its characteristic equation is:\n$$\n\\lambda^2 + 0.8\\lambda + 16 = 0\n$$\nThe eigenvalues are found using the quadratic formula:\n$$\n\\lambda_{1,2} = \\frac{-0.8 \\pm \\sqrt{0.8^2 - 4(1)(16)}}{2} = \\frac{-0.8 \\pm \\sqrt{0.64 - 64}}{2} = \\frac{-0.8 \\pm \\sqrt{-63.36}}{2} = -0.4 \\pm i\\sqrt{15.84}\n$$\nNumerically, $\\lambda_{1,2} \\approx -0.4 \\pm i3.9799$. The eigenvector for this mode is evidently $\\mathbf{u} \\propto [0, 0, 1]^T$. This mode represents a simple damped oscillation of the third mass, independent of the other two, with a damped natural frequency of $\\omega_{d,3} = \\sqrt{15.84}$ rad/s.\n\nNext, we analyze the coupled first and second degrees of freedom. The characteristic equation is a difference of squares:\n$$\n(\\lambda^2 + \\lambda + 9)^2 - (0.6\\lambda)^2 = 0\n$$\nThis equation can be factored into two separate quadratic equations:\n$$\n(\\lambda^2 + \\lambda + 9 - 0.6\\lambda) (\\lambda^2 + \\lambda + 9 + 0.6\\lambda) = 0\n$$\n$$\n(\\lambda^2 + 0.4\\lambda + 9) (\\lambda^2 + 1.6\\lambda + 9) = 0\n$$\nThis yields two sets of eigenvalues.\n\nCase A: $\\lambda^2 + 0.4\\lambda + 9 = 0$\n$$\n\\lambda_{3,4} = \\frac{-0.4 \\pm \\sqrt{0.4^2 - 4(1)(9)}}{2} = \\frac{-0.4 \\pm \\sqrt{0.16 - 36}}{2} = \\frac{-0.4 \\pm \\sqrt{-35.84}}{2} = -0.2 \\pm i\\sqrt{8.96}\n$$\nTo find the corresponding eigenvector shape for these eigenvalues, we return to the $2 \\times 2$ QEP sub-problem:\n$$\n\\begin{pmatrix} \\lambda^2 + \\lambda + 9 & 0.6\\lambda \\\\ 0.6\\lambda & \\lambda^2 + \\lambda + 9 \\end{pmatrix} \\begin{pmatrix} u_1 \\\\ u_2 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\nFrom the characteristic equation for this case, we have $\\lambda^2 + 0.4\\lambda + 9 = 0$, which implies $\\lambda^2 + \\lambda + 9 = 0.6\\lambda$. Substituting this into the matrix equation:\n$$\n\\begin{pmatrix} 0.6\\lambda & 0.6\\lambda \\\\ 0.6\\lambda & 0.6\\lambda \\end{pmatrix} \\begin{pmatrix} u_1 \\\\ u_2 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\nThis gives the relation $0.6\\lambda(u_1 + u_2) = 0$. Since $\\lambda \\neq 0$, we must have $u_1 + u_2 = 0$, or $u_1 = -u_2$. This corresponds to an **out-of-phase** motion. The eigenvector is of the form $\\mathbf{u} \\propto [1, -1, 0]^T$. The damped natural frequency for this mode is $\\omega_d = \\text{Im}(\\lambda) = \\sqrt{8.96}$ rad/s.\n\nCase B: $\\lambda^2 + 1.6\\lambda + 9 = 0$\n$$\n\\lambda_{5,6} = \\frac{-1.6 \\pm \\sqrt{1.6^2 - 4(1)(9)}}{2} = \\frac{-1.6 \\pm \\sqrt{2.56 - 36}}{2} = \\frac{-1.6 \\pm \\sqrt{-33.44}}{2} = -0.8 \\pm i\\sqrt{8.36}\n$$\nAgain, we find the eigenvector shape. From this characteristic equation, $\\lambda^2 + 1.6\\lambda + 9 = 0$, which implies $\\lambda^2 + \\lambda + 9 = -0.6\\lambda$. Substituting into the matrix equation:\n$$\n\\begin{pmatrix} -0.6\\lambda & 0.6\\lambda \\\\ 0.6\\lambda & -0.6\\lambda \\end{pmatrix} \\begin{pmatrix} u_1 \\\\ u_2 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\nThis gives the relation $0.6\\lambda(-u_1 + u_2) = 0$. Since $\\lambda \\neq 0$, we must have $u_1 = u_2$. This corresponds to an **in-phase** motion. The eigenvector is of the form $\\mathbf{u} \\propto [1, 1, 0]^T$. The damped natural frequency for this mode is $\\omega_d = \\text{Im}(\\lambda) = \\sqrt{8.36}$ rad/s.\n\nThe problem specifically asks for the damped natural frequency of the out-of-phase mode associated with the first two degrees of freedom. This corresponds to Case A. The damped natural frequency is the magnitude of the imaginary part of the eigenvalues $\\lambda_{3,4}$:\n$$\n\\omega_{d, \\text{out-of-phase}} = \\sqrt{8.96} \\text{ rad/s}\n$$\nNow, we compute the numerical value and round to four significant figures:\n$$\n\\omega_{d, \\text{out-of-phase}} = \\sqrt{8.96} \\approx 2.9933259... \\text{ rad/s}\n$$\nRounding to four significant figures, the result is $2.993$.",
            "answer": "$$\\boxed{2.993}$$"
        }
    ]
}