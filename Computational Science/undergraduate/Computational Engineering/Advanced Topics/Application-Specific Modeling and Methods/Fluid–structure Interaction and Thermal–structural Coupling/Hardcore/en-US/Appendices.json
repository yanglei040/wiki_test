{
    "hands_on_practices": [
        {
            "introduction": "Fluid-structure interaction can lead to powerful self-sustaining oscillations, a phenomenon at the heart of both aeroelastic flutter and the sound of an organ pipe. This practice models the pipe's labium as a simple oscillator driven by a time-delayed aerodynamic force, allowing you to explore the roots of this dynamic instability . Solving the system's characteristic equation will give you hands-on experience in stability analysis, a critical skill for predicting and controlling flow-induced vibrations.",
            "id": "2394077",
            "problem": "Consider a reduced-order model of fluid–structure interaction (FSI), where the labium of a flue organ pipe is approximated as a single-degree-of-freedom elastic oscillator subjected to an unsteady aerodynamic force induced by an impinging air jet. Let the labium tip displacement be $y(t)$, governed by Newton's second law\n$$\nm\\,\\ddot{y}(t) + c\\,\\dot{y}(t) + k\\,y(t) = F_{j}(t),\n$$\nwhere $m$ is the effective mass in $\\mathrm{kg}$, $c$ is the viscous damping in $\\mathrm{N\\,s/m}$, and $k$ is the linear stiffness in $\\mathrm{N/m}$. The unsteady jet–labium coupling is modeled by a convective time delay and a linear feedback gain so that\n$$\nF_{j}(t) = K_{j}\\,y\\!\\left(t-\\tau\\right),\n$$\nwith\n$$\nK_{j} = C_{f}\\,\\rho\\,U^{2}\\,b,\\qquad \\tau = \\frac{L}{\\alpha\\,U}.\n$$\nHere, $\\rho$ is the air density in $\\mathrm{kg/m^{3}}$, $U$ is the mean jet speed in $\\mathrm{m/s}$, $b$ is an effective jet width in $\\mathrm{m}$, $C_{f}$ is a dimensionless coupling coefficient, $L$ is the streamwise distance in $\\mathrm{m}$ from the jet origin to the labium, and $\\alpha$ is a dimensionless convective speed factor with $0<\\alpha<1$.\n\nAssuming solutions of the form $y(t)=\\Re\\{Y\\,e^{s t}\\}$ with complex growth rate $s\\in\\mathbb{C}$, the characteristic equation is\n$$\nm\\,s^{2} + c\\,s + k - K_{j}\\,e^{-s\\,\\tau}=0.\n$$\nFor a given parameter set, define the dominant mode as the root $s_{\\max}$ of the characteristic equation with the largest real part. Let the growth rate be $\\sigma=\\Re\\{s_{\\max}\\}$ in $\\mathrm{s^{-1}}$ and the oscillation frequency be $f=\\lvert\\Im\\{s_{\\max}\\}\\rvert/(2\\pi)$ in $\\mathrm{Hz}$. If $s_{\\max}$ is real, take $f=0$.\n\nYour task is to compute $(\\sigma,f)$ for each of the following test cases, using the physical constants exactly as provided. All outputs must be expressed in the specified units and rounded to six decimal places.\n\nTest suite (each line is one independent test case):\n\n- Case A (general stable case): $m=0.02\\,\\mathrm{kg}$, $c=0.2\\,\\mathrm{N\\,s/m}$, $k=200\\,\\mathrm{N/m}$, $\\rho=1.2\\,\\mathrm{kg/m^{3}}$, $b=0.005\\,\\mathrm{m}$, $C_{f}=1.0$, $\\alpha=0.4$, $L=0.010\\,\\mathrm{m}$, $U=40.0\\,\\mathrm{m/s}$.\n- Case B (higher jet speed): $m=0.02\\,\\mathrm{kg}$, $c=0.2\\,\\mathrm{N\\,s/m}$, $k=200\\,\\mathrm{N/m}$, $\\rho=1.2\\,\\mathrm{kg/m^{3}}$, $b=0.005\\,\\mathrm{m}$, $C_{f}=1.0$, $\\alpha=0.4$, $L=0.010\\,\\mathrm{m}$, $U=150.0\\,\\mathrm{m/s}$.\n- Case C (very high jet speed): $m=0.02\\,\\mathrm{kg}$, $c=0.2\\,\\mathrm{N\\,s/m}$, $k=200\\,\\mathrm{N/m}$, $\\rho=1.2\\,\\mathrm{kg/m^{3}}$, $b=0.005\\,\\mathrm{m}$, $C_{f}=1.0$, $\\alpha=0.4$, $L=0.010\\,\\mathrm{m}$, $U=200.0\\,\\mathrm{m/s}$.\n- Case D (zero delay edge case): $m=0.02\\,\\mathrm{kg}$, $c=0.2\\,\\mathrm{N\\,s/m}$, $k=200\\,\\mathrm{N/m}$, $\\rho=1.2\\,\\mathrm{kg/m^{3}}$, $b=0.005\\,\\mathrm{m}$, $C_{f}=1.0$, $\\alpha=0.4$, $L=0.000\\,\\mathrm{m}$, $U=200.0\\,\\mathrm{m/s}$.\n- Case E (low structural damping): $m=0.02\\,\\mathrm{kg}$, $c=0.02\\,\\mathrm{N\\,s/m}$, $k=200\\,\\mathrm{N/m}$, $\\rho=1.2\\,\\mathrm{kg/m^{3}}$, $b=0.005\\,\\mathrm{m}$, $C_{f}=1.0$, $\\alpha=0.4$, $L=0.015\\,\\mathrm{m}$, $U=150.0\\,\\mathrm{m/s}$.\n\nRequired final output format:\n- Your program should produce a single line of output containing a list of results, one per test case, in the same order as listed above. Each result must be the two-element list $[\\sigma,f]$ with $\\sigma$ in $\\mathrm{s^{-1}}$ and $f$ in $\\mathrm{Hz}$, both rounded to six decimal places.\n- Concretely, print a single line of the form\n$$\n\\bigl[[\\sigma_{A},f_{A}],[\\sigma_{B},f_{B}],[\\sigma_{C},f_{C}],[\\sigma_{D},f_{D}],[\\sigma_{E},f_{E}]\\bigr].\n$$\nNo other text must be printed.",
            "solution": "The problem requires the determination of the stability characteristics (growth rate $\\sigma$ and frequency $f$) of a simplified fluid-structure interaction model. This model represents the labium of an organ pipe as a single-degree-of-freedom damped harmonic oscillator driven by a time-delayed aerodynamic force.\n\nThe governing equation for the labium tip displacement $y(t)$ is given as a delay-differential equation (DDE):\n$$\nm\\,\\ddot{y}(t) + c\\,\\dot{y}(t) + k\\,y(t) = K_{j}\\,y\\!\\left(t-\\tau\\right)\n$$\nwhere the parameters $m$, $c$, and $k$ are the mass, damping, and stiffness, respectively. The aerodynamic coupling is characterized by a gain $K_{j} = C_{f}\\,\\rho\\,U^{2}\\,b$ and a time delay $\\tau = L/(\\alpha\\,U)$.\n\nBy assuming an exponential solution of the form $y(t) = \\Re\\{Y\\,e^{s t}\\}$ for a complex growth rate $s = \\sigma + i\\omega \\in \\mathbb{C}$, we derive the characteristic equation for the system's eigenvalues $s$:\n$$\nm\\,s^{2} + c\\,s + k - K_{j}\\,e^{-s\\,\\tau}=0\n$$\nThe stability of the system is determined by the dominant eigenvalue, $s_{\\max}$, which is the root of this equation with the largest real part, $\\sigma = \\Re\\{s_{\\max}\\}$. A positive growth rate, $\\sigma > 0$, signifies an unstable oscillation that grows exponentially in time, a phenomenon known as flutter. The oscillation frequency is given by $f = \\lvert\\Im\\{s_{\\max}\\}\\rvert/(2\\pi)$. If $s_{\\max}$ is a purely real number, the frequency is $f=0\\,\\mathrm{Hz}$.\n\nThe task is to find $(\\sigma, f)$ for several parameter sets. The characteristic equation is a transcendental equation, also known as a quasi-polynomial, which generally has an infinite number of roots in the complex plane. A numerical approach is required to find these roots.\n\nFirst, we consider the special case where the time delay $\\tau=0$, which occurs in Case D where $L=0\\,\\mathrm{m}$. In this instance, the characteristic equation simplifies from a transcendental equation to an algebraic one:\n$$\nm\\,s^{2} + c\\,s + (k - K_{j}) = 0\n$$\nThis is a quadratic equation whose roots can be found analytically using the quadratic formula:\n$$\ns = \\frac{-c \\pm \\sqrt{c^2 - 4m(k-K_{j})}}{2m}\n$$\nThe dominant root $s_{\\max}$ is the one with the algebraically largest real part. For this case, the two roots are real, and we select the larger of the two.\n\nFor the general case where $\\tau > 0$, we must find the roots of the complex-valued function $F(s) = m\\,s^{2} + c\\,s + k - K_{j}\\,e^{-s\\,\\tau}$ numerically. We employ the Newton-Raphson method for complex variables, which is well-suited for this task. The iterative formula for this method is:\n$$\ns_{n+1} = s_n - \\frac{F(s_n)}{F'(s_n)}\n$$\nwhere $F'(s)$ is the derivative of $F(s)$ with respect to $s$:\n$$\nF'(s) = 2ms + c + K_{j}\\tau\\,e^{-s\\,\\tau}\n$$\nThe primary challenge is not merely finding a root, but ensuring we find the dominant root $s_{\\max}$. The roots of a DDE are typically arranged in string-like patterns in the complex plane that recede towards $\\sigma \\rightarrow -\\infty$. A robust strategy is necessary to avoid converging to a sub-dominant, highly stable root.\n\nOur strategy is to perform a systematic search by initiating the Newton-Raphson algorithm from a grid of initial guesses $s_0 = \\sigma_0 + i\\omega_0$. The grid must be chosen to cover regions where the dominant root is likely to reside. A logical choice for the imaginary part of the guess, $\\omega_0$, is around the undamped natural frequency of the mechanical oscillator, $\\omega_n = \\sqrt{k/m}$, as this frequency often governs the primary mode of oscillation. The real part of the guess, $\\sigma_0$, should span from negative (stable) to positive (unstable) values.\n\nFor each test case with $\\tau > 0$, the following procedure is implemented:\n1.  Calculate the derived parameters $K_j$ and $\\tau$.\n2.  Define a set of initial guesses for $s$ in the complex plane. This set is formed by a grid of $\\sigma_{\\text{guess}}$ and $\\omega_{\\text{guess}}$ values, including $\\sigma_{\\text{guess}}$ ranging from negative to positive values and $\\omega_{\\text{guess}}$ values including $0$ (for real roots) and multiples of the natural frequency $\\omega_n$.\n3.  For each initial guess, apply the Newton-Raphson solver to find a root of $F(s)=0$. The solver is executed within a `try-except` block to handle cases of non-convergence.\n4.  Each successfully converged root is verified by checking if $|F(s)|$ is below a small tolerance. All unique verified roots are collected.\n5.  From the set of all found roots, the dominant root $s_{\\max}$ is identified as the one with the maximum real part.\n6.  The growth rate is computed as $\\sigma = \\Re\\{s_{\\max}\\}$. The frequency is $f = |\\Im\\{s_{\\max}\\}|/(2\\pi)$. If the imaginary part of $s_{\\max}$ is smaller than a numerical tolerance, it is considered a real root and the frequency is set to $f=0\\,\\mathrm{Hz}$.\n\nThis comprehensive search procedure provides high confidence in locating the correct dominant eigenvalue for each parameter set. The final results are rounded to six decimal places as specified.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.optimize import newton\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A: (m, c, k, rho, b, C_f, alpha, L, U)\n        (0.02, 0.2, 200.0, 1.2, 0.005, 1.0, 0.4, 0.010, 40.0),\n        # Case B\n        (0.02, 0.2, 200.0, 1.2, 0.005, 1.0, 0.4, 0.010, 150.0),\n        # Case C\n        (0.02, 0.2, 200.0, 1.2, 0.005, 1.0, 0.4, 0.010, 200.0),\n        # Case D\n        (0.02, 0.2, 200.0, 1.2, 0.005, 1.0, 0.4, 0.000, 200.0),\n        # Case E\n        (0.02, 0.02, 200.0, 1.2, 0.005, 1.0, 0.4, 0.015, 150.0),\n    ]\n\n    results = []\n    \n    for params in test_cases:\n        m, c, k, rho, b, Cf, alpha, L, U = params\n\n        if U <= 0:\n            Kj = 0.0\n            # tau would be infinite or undefined, but Kj=0 simplifies things.\n            # The system is just the passive oscillator.\n            tau = np.inf \n        else:\n            Kj = Cf * rho * U**2 * b\n            tau = L / (alpha * U)\n\n        if np.isclose(tau, 0.0):\n            # Case D: Analytical solution for the quadratic equation\n            # ms^2 + cs + (k - Kj) = 0\n            # Use complex sqrt to handle both positive and negative discriminant\n            discriminant = np.lib.scimath.sqrt(c**2 - 4 * m * (k - Kj))\n            s1 = (-c + discriminant) / (2 * m)\n            s2 = (-c - discriminant) / (2 * m)\n            \n            s_max = s1 if np.real(s1) > np.real(s2) else s2\n        \n        else:\n            # Transcendental equation for tau > 0\n            def F(s, m_p, c_p, k_p, Kj_p, tau_p):\n                return m_p * s**2 + c_p * s + k_p - Kj_p * np.exp(-s * tau_p)\n\n            def F_prime(s, m_p, c_p, k_p, Kj_p, tau_p):\n                return 2 * m_p * s + c_p + Kj_p * tau_p * np.exp(-s * tau_p)\n\n            # Define a grid of initial guesses to search for the dominant root\n            omega_n_undamped = np.sqrt(k / m)\n            \n            sigma_guesses = [-50.0, -10.0, -1.0, 0.0, 1.0, 10.0, 50.0, 100.0]\n            omega_guesses = [0.0, 0.5 * omega_n_undamped, omega_n_undamped, 1.5 * omega_n_undamped]\n\n            # Add frequencies related to the delay time\n            if tau > 1e-9:\n                omega_guesses.extend([np.pi / (2 * tau), 3*np.pi/(2*tau)])\n\n            found_roots = []\n\n            for sig_g in sigma_guesses:\n                for omg_g in omega_guesses:\n                    # Search with positive frequencies; conjugate is also a root\n                    guess = sig_g + 1j * omg_g\n                    try:\n                        root = newton(\n                            F, guess, \n                            fprime=F_prime, \n                            args=(m, c, k, Kj, tau),\n                            tol=1e-9, maxiter=100\n                        )\n                        # Verify that it is a valid root\n                        if np.abs(F(root, m, c, k, Kj, tau)) < 1e-7:\n                            is_new = True\n                            for r in found_roots:\n                                if np.allclose(root, r, atol=1e-4):\n                                    is_new = False\n                                    break\n                            if is_new:\n                                found_roots.append(root)\n                    except (RuntimeError, OverflowError):\n                        continue # Newton method failed to converge\n\n            # If no roots found with the grid, try the unforced system roots as guesses\n            if not found_roots:\n                discriminant_unforced = np.lib.scimath.sqrt(c**2 - 4 * m * k)\n                s_unforced = [(-c + discriminant_unforced) / (2 * m), (-c - discriminant_unforced) / (2 * m)]\n                for guess in s_unforced:\n                    try:\n                        root = newton( F, guess, fprime=F_prime, args=(m, c, k, Kj, tau), tol=1e-9, maxiter=100)\n                        if np.abs(F(root, m, c, k, Kj, tau)) < 1e-7:\n                           found_roots.append(root)\n                    except (RuntimeError, OverflowError):\n                        continue\n\n            if not found_roots:\n                raise RuntimeError(f\"Could not find a root for case with params: {params}\")\n\n            # Find the root with the maximum real part (dominant root)\n            s_max = found_roots[0]\n            for root in found_roots[1:]:\n                if np.real(root) > np.real(s_max):\n                    s_max = root\n\n        # Extract growth rate (sigma) and frequency (f)\n        sigma = np.real(s_max)\n        \n        # Per problem statement: if s_max is real, f=0.\n        # Numerically, this means the imaginary part is close to zero.\n        if np.abs(np.imag(s_max)) < 1e-6:\n            f = 0.0\n        else:\n            f = np.abs(np.imag(s_max)) / (2 * np.pi)\n        \n        results.append([round(sigma, 6), round(f, 6)])\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "Smart materials that respond to thermal stimuli are central to many modern technologies, from aerospace to biomedical devices. This exercise focuses on a Shape-Memory Alloy (SMA) wire, which acts as a powerful muscle when heated, demonstrating a classic thermal-structural coupling phenomenon . You will model the wire's actuation by coupling a transient thermal analysis with a quasi-static mechanical model that captures the material's temperature-induced phase transformation, providing insight into how multiphysics effects can be engineered for a desired function.",
            "id": "2394080",
            "problem": "A single straight Shape Memory Alloy (SMA) wire lifts a suspended mass as it is Joule-heated past its austenite transition temperature. Model the thermally driven contraction and the resulting upward displacement under quasi-static mechanical equilibrium using first principles of thermal energy balance and one-dimensional linear elasticity with a simple phase-fraction model. All independent and derived quantities must be handled in the International System of Units (SI). The final upward displacement must be expressed in meters, as decimal floats rounded to six decimals.\n\nAssumptions and definitions:\n- Consider a one-dimensional rod model of the SMA wire, with uniform cross-section, length, and properties. Let the wire length be $L$ and the circular cross-section have radius $r$ so that area $A = \\pi r^2$ and lateral surface area $A_{\\text{surf}} = 2 \\pi r L$.\n- Let the mass suspended by the wire be $m$. Gravity has magnitude $g$.\n- Let the ambient temperature be $T_{\\text{amb}}$. The wire is initially at $T(0) = T_{\\text{amb}}$ and is heated by a constant current $I$ from $t=0$ to $t=t_{\\text{end}}$.\n- Thermal energy balance (lumped capacitance) for the wire is governed by\n  $$ C_{\\text{th}} \\, \\frac{dT}{dt} = I^2 R - h A_{\\text{surf}} \\left( T - T_{\\text{amb}} \\right), $$\n  where $C_{\\text{th}} = \\rho c A L$ is the thermal capacitance, $\\rho$ is density, $c$ is specific heat, $h$ is the convective heat transfer coefficient, and $R$ is the electrical resistance of the wire. Assume constant electrical resistivity $\\rho_e$ so that $R = \\rho_e \\, \\dfrac{L}{A}$.\n- The austenite volume fraction $\\xi(T)$ is approximated as a piecewise linear function of temperature:\n  $$ \\xi(T) = \\begin{cases}\n  0, & T \\le A_s,\\\\\n  \\dfrac{T - A_s}{A_f - A_s}, & A_s < T < A_f,\\\\\n  1, & T \\ge A_f,\n  \\end{cases} $$\n  where $A_s$ is the austenite start temperature and $A_f$ is the austenite finish temperature.\n- The effective Young’s modulus is a linear mixture,\n  $$ E(T) = \\xi(T) \\, E_A + \\left(1 - \\xi(T)\\right) E_M, $$\n  with $E_A$ the austenite modulus and $E_M$ the martensite modulus.\n- The recoverable transformation strain is modeled as\n  $$ \\varepsilon_{\\text{tr}}(T) = \\left(1 - \\xi(T)\\right) \\, \\varepsilon_L, $$\n  where $\\varepsilon_L$ is the maximum recoverable strain in fully martensitic state.\n- Under quasi-static mechanical equilibrium for a one-dimensional rod, the tensile stress is $\\sigma = \\dfrac{m g}{A}$, and the elastic strain is $\\varepsilon_{\\text{el}}(T) = \\dfrac{\\sigma}{E(T)}$.\n- The total axial strain relative to the stress-free austenite reference length is\n  $$ \\varepsilon_{\\text{tot}}(T) = \\varepsilon_{\\text{tr}}(T) + \\varepsilon_{\\text{el}}(T). $$\n  The upward displacement of the mass relative to the initial state at $T(0) = T_{\\text{amb}}$ is the reduction in wire length,\n  $$ u_{\\uparrow} = L \\left[ \\varepsilon_{\\text{tot}}\\left(T(0)\\right) - \\varepsilon_{\\text{tot}}\\left(T(t_{\\text{end}})\\right) \\right]. $$\n  You must compute $T(t_{\\text{end}})$ from the thermal energy balance, then evaluate $\\xi(T)$, $E(T)$, $\\varepsilon_{\\text{tr}}(T)$, and $\\varepsilon_{\\text{el}}(T)$ accordingly. Treat the entire process as quasi-static mechanically at each temperature.\n\nGiven constants (use these values exactly):\n- Geometry and gravity: $L = 0.1$ m, $r = 2.5 \\times 10^{-4}$ m, $g = 9.81$ m/s$^2$.\n- Thermal and electrical: $\\rho = 6450$ kg/m$^3$, $c = 837$ J/(kg K), $\\rho_e = 7.6 \\times 10^{-7}$ $\\Omega \\cdot$ m, $h = 30$ W/(m$^2$ K).\n- Phase transformation and elasticity: $A_s = 333$ K, $A_f = 353$ K, $E_M = 28 \\times 10^9$ Pa, $E_A = 70 \\times 10^9$ Pa, $\\varepsilon_L = 0.04$.\n\nTest suite:\nFor each tuple $(m, I, t_{\\text{end}}, T_{\\text{amb}})$ below, compute the upward displacement $u_{\\uparrow}$ in meters, rounded to six decimals.\n\n- Case $1$: $(0.2, 2.0, 5.0, 293.0)$.\n- Case $2$: $(0.2, 0.4, 5.0, 293.0)$.\n- Case $3$: $(0.2, 0.8, 50.0, 293.0)$.\n- Case $4$: $(2.0, 2.0, 5.0, 293.0)$.\n\nRequirements for your program:\n- Implement the solution using the laws and definitions above. Solve the thermal ordinary differential equation to obtain $T(t_{\\text{end}})$ and then evaluate the displacement $u_{\\uparrow}$ from first principles.\n- All inputs are fixed by the test suite; there is no user input.\n- Final output format: produce a single line containing a Python-style list of the four rounded results in order, as a comma-separated list enclosed in square brackets. For example, output of the form $[x_1,x_2,x_3,x_4]$ where each $x_i$ is a decimal float rounded to six decimals in meters.",
            "solution": "The problem statement has been subjected to rigorous validation and is deemed to be valid. It is scientifically grounded, well-posed, objective, and provides a self-contained set of definitions, constants, and equations for modeling the thermo-mechanical behavior of a Shape Memory Alloy (SMA) wire. The model is based on established principles of heat transfer and solid mechanics. We may now proceed with the formal solution.\n\nThe problem requires us to determine the upward displacement $u_{\\uparrow}$ of a mass $m$ suspended by an SMA wire of length $L$, which contracts upon Joule heating. The solution is partitioned into two main stages: a thermal analysis to find the wire's temperature over time, and a mechanical analysis to compute the strain and resulting displacement.\n\nFirst, we analyze the thermal behavior. The temperature $T(t)$ of the wire is governed by the lumped capacitance model, a first-order linear ordinary differential equation (ODE):\n$$ C_{\\text{th}} \\, \\frac{dT}{dt} = I^2 R - h A_{\\text{surf}} \\left( T - T_{\\text{amb}} \\right) $$\nwhere $C_{\\text{th}} = \\rho c A L$ is the thermal capacitance, $R = \\rho_e L / A$ is the electrical resistance, and $A_{\\text{surf}} = 2 \\pi r L$ is the lateral surface area of the wire. The other parameters are: current $I$, convective heat transfer coefficient $h$, ambient temperature $T_{\\text{amb}}$, density $\\rho$, specific heat $c$, and electrical resistivity $\\rho_e$. The wire has a circular cross-section of radius $r$, so its area is $A = \\pi r^2$.\n\nTo solve this ODE, we rearrange it into standard form:\n$$ \\frac{dT}{dt} + \\frac{h A_{\\text{surf}}}{C_{\\text{th}}} \\left( T - T_{\\text{amb}} \\right) = \\frac{I^2 R}{C_{\\text{th}}} $$\n$$ \\frac{dT}{dt} + \\frac{h A_{\\text{surf}}}{C_{\\text{th}}} T = \\frac{I^2 R}{C_{\\text{th}}} + \\frac{h A_{\\text{surf}}}{C_{\\text{th}}} T_{\\text{amb}} $$\nLet us define the characteristic time constant $\\tau$ and the steady-state temperature $T_{ss}$:\nThe coefficient of $T$ is $\\frac{1}{\\tau} = \\alpha = \\frac{h A_{\\text{surf}}}{C_{\\text{th}}}$. Substituting the expressions for $A_{\\text{surf}}$ and $C_{\\text{th}}$:\n$$ \\alpha = \\frac{h (2 \\pi r L)}{\\rho c (\\pi r^2) L} = \\frac{2h}{\\rho c r} $$\nThe steady-state temperature $T_{ss}$ is reached when $\\frac{dT}{dt} = 0$, which gives:\n$$ I^2 R = h A_{\\text{surf}} (T_{ss} - T_{\\text{amb}}) \\implies T_{ss} = T_{\\text{amb}} + \\frac{I^2 R}{h A_{\\text{surf}}} $$\nThe ODE can now be written as:\n$$ \\frac{dT}{dt} + \\alpha T = \\alpha T_{ss} $$\nThis is a first-order linear ODE with the general solution $T(t) = C e^{-\\alpha t} + T_{ss}$. We use the initial condition $T(0) = T_{\\text{amb}}$ to find the integration constant $C$:\n$$ T(0) = C e^0 + T_{ss} = C + T_{ss} = T_{\\text{amb}} \\implies C = T_{\\text{amb}} - T_{ss} $$\nThus, the particular solution for the temperature of the wire as a function of time $t$ is:\n$$ T(t) = T_{ss} + \\left( T_{\\text{amb}} - T_{ss} \\right) e^{-\\alpha t} $$\nWe must compute the final temperature $T(t_{\\text{end}})$ for each test case using this equation.\n\nSecond, we analyze the mechanical behavior under the quasi-static assumption. The total strain $\\varepsilon_{\\text{tot}}(T)$ at a given temperature $T$ is the sum of the transformation strain $\\varepsilon_{\\text{tr}}(T)$ and the elastic strain $\\varepsilon_{\\text{el}}(T)$.\n$$ \\varepsilon_{\\text{tot}}(T) = \\varepsilon_{\\text{tr}}(T) + \\varepsilon_{\\text{el}}(T) $$\nThe austenite volume fraction, $\\xi(T)$, is a piecewise linear function:\n$$ \\xi(T) = \\begin{cases}\n0, & T \\le A_s \\\\\n\\frac{T - A_s}{A_f - A_s}, & A_s < T < A_f \\\\\n1, & T \\ge A_f\n\\end{cases} $$\nwhere $A_s$ and $A_f$ are the austenite start and finish temperatures, respectively.\n\nThe transformation strain $\\varepsilon_{\\text{tr}}(T)$ is defined relative to the austenite phase and depends on the martensite fraction $(1 - \\xi(T))$:\n$$ \\varepsilon_{\\text{tr}}(T) = (1 - \\xi(T)) \\varepsilon_L $$\nwhere $\\varepsilon_L$ is the maximum recoverable strain of the fully martensitic wire.\n\nThe elastic strain $\\varepsilon_{\\text{el}}(T)$ is given by Hooke's law, $\\varepsilon_{\\text{el}}(T) = \\sigma / E(T)$, where the stress $\\sigma = mg/A$ is due to the suspended mass $m$. The effective Young's modulus $E(T)$ is determined by a linear rule of mixtures:\n$$ E(T) = \\xi(T) E_A + (1 - \\xi(T)) E_M $$\nwhere $E_A$ and $E_M$ are the moduli of austenite and martensite, respectively.\n\nThe upward displacement $u_{\\uparrow}$ is the total contraction of the wire from its initial state at $t=0$ (where $T(0) = T_{\\text{amb}}$) to its final state at $t=t_{\\text{end}}$. This is given by the change in total strain multiplied by the original length $L$:\n$$ u_{\\uparrow} = L \\left[ \\varepsilon_{\\text{tot}}(T(0)) - \\varepsilon_{\\text{tot}}(T(t_{\\text{end}})) \\right] $$\nSubstituting $T(0) = T_{\\text{amb}}$:\n$$ u_{\\uparrow} = L \\left[ \\varepsilon_{\\text{tot}}(T_{\\text{amb}}) - \\varepsilon_{\\text{tot}}(T(t_{\\text{end}})) \\right] $$\nFor each test case $(m, I, t_{\\text{end}}, T_{\\text{amb}})$, the computational procedure is as follows:\n1.  Calculate geometry-dependent constants: $A = \\pi r^2$, $A_{\\text{surf}} = 2 \\pi r L$.\n2.  Calculate material-dependent constants: $R = \\rho_e L / A$, $\\alpha = 2h / (\\rho c r)$.\n3.  Calculate the steady-state temperature $T_{ss} = T_{\\text{amb}} + I^2 R / (h A_{\\text{surf}})$.\n4.  Calculate the final temperature $T(t_{\\text{end}})$ using the derived analytical solution.\n5.  Determine the total strain at the initial temperature, $\\varepsilon_{\\text{tot}}(T_{\\text{amb}})$. This requires computing $\\xi(T_{\\text{amb}})$, $E(T_{\\text{amb}})$, $\\varepsilon_{\\text{tr}}(T_{\\text{amb}})$, and $\\varepsilon_{\\text{el}}(T_{\\text{amb}})$.\n6.  Determine the total strain at the final temperature, $\\varepsilon_{\\text{tot}}(T(t_{\\text{end}}))$. This requires computing $\\xi(T(t_{\\text{end}}))$, $E(T(t_{\\text{end}}))$, $\\varepsilon_{\\text{tr}}(T(t_{\\text{end}}))$, and $\\varepsilon_{\\text{el}}(T(t_{\\text{end}}))$.\n7.  Compute the final upward displacement $u_{\\uparrow} = L (\\varepsilon_{\\text{tot}}(T_{\\text{amb}}) - \\varepsilon_{\\text{tot}}(T(t_{\\text{end}})))$.\n\nThis rigorous, step-by-step procedure, founded upon first principles, will be implemented to solve the problem for the given test suite.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the upward displacement of a mass suspended by a Shape Memory Alloy (SMA) wire.\n    The wire contracts when heated by an electrical current. The model combines a lumped\n    capacitance thermal model with a one-dimensional quasi-static mechanical model.\n    \"\"\"\n\n    # --- Given constants (SI units) ---\n    # Geometry and gravity\n    L = 0.1  # m\n    r = 2.5e-4  # m\n    g = 9.81  # m/s^2\n\n    # Thermal and electrical properties\n    rho = 6450.0  # kg/m^3\n    c = 837.0  # J/(kg*K)\n    rho_e = 7.6e-7  # Ohm*m\n    h = 30.0  # W/(m^2*K)\n\n    # Phase transformation and elasticity\n    A_s = 333.0  # K (Austenite start)\n    A_f = 353.0  # K (Austenite finish)\n    E_M = 28.0e9  # Pa (Martensite modulus)\n    E_A = 70.0e9  # Pa (Austenite modulus)\n    epsilon_L = 0.04  # Dimensionless (Max recoverable strain)\n\n    # --- Derived constants ---\n    A = np.pi * r**2  # Cross-sectional area (m^2)\n    A_surf = 2 * np.pi * r * L  # Lateral surface area (m^2)\n    R = rho_e * L / A  # Electrical resistance (Ohm)\n    alpha = (2 * h) / (rho * c * r)  # Thermal decay constant (1/s)\n\n    # --- Helper functions for the constitutive model ---\n    def get_austenite_fraction(T):\n        \"\"\"Calculates the austenite volume fraction xi(T).\"\"\"\n        if T <= A_s:\n            return 0.0\n        elif T >= A_f:\n            return 1.0\n        else:\n            return (T - A_s) / (A_f - A_s)\n\n    def get_total_strain(T, m):\n        \"\"\"Calculates the total strain epsilon_tot(T, m).\"\"\"\n        xi_T = get_austenite_fraction(T)\n        \n        # Transformation strain\n        eps_tr = (1.0 - xi_T) * epsilon_L\n        \n        # Effective Young's modulus\n        E_T = xi_T * E_A + (1.0 - xi_T) * E_M\n        \n        # Stress\n        sigma = (m * g) / A\n        \n        # Elastic strain\n        eps_el = sigma / E_T\n        \n        return eps_tr + eps_el\n\n    # --- Test suite ---\n    test_cases = [\n        (0.2, 2.0, 5.0, 293.0),  # Case 1: (m, I, t_end, T_amb)\n        (0.2, 0.4, 5.0, 293.0),  # Case 2\n        (0.2, 0.8, 50.0, 293.0), # Case 3\n        (2.0, 2.0, 5.0, 293.0),  # Case 4\n    ]\n\n    results = []\n    for case in test_cases:\n        m, I, t_end, T_amb = case\n\n        # --- Thermal Analysis ---\n        # 1. Calculate steady-state temperature\n        joule_heating = I**2 * R\n        convective_cooling_rate = h * A_surf\n        T_ss = T_amb + joule_heating / convective_cooling_rate\n        \n        # 2. Calculate wire temperature at t_end\n        T_final = T_ss + (T_amb - T_ss) * np.exp(-alpha * t_end)\n\n        # --- Mechanical Analysis ---\n        # 3. Calculate initial total strain at T_amb\n        epsilon_tot_initial = get_total_strain(T_amb, m)\n\n        # 4. Calculate final total strain at T_final\n        epsilon_tot_final = get_total_strain(T_final, m)\n\n        # 5. Calculate upward displacement\n        u_upward = L * (epsilon_tot_initial - epsilon_tot_final)\n        \n        # 6. Round and store result\n        results.append(round(u_upward, 6))\n\n    # --- Final Output ---\n    # Convert results to strings for joining\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Modeling large-scale, flexible systems like architectural domes or deployable space structures requires integrating multiple physical domains simultaneously. This capstone practice challenges you to simulate the complete inflation of an elastic spherical membrane, providing a hands-on example of fully coupled fluid-structure-thermal interaction . By deriving and solving a transient model based on the conservation of mass and energy for the internal fluid coupled with the structural equilibrium of the shell, you will tackle a problem representative of real-world computational engineering analysis.",
            "id": "2394098",
            "problem": "You are asked to build, from first principles, a zero-dimensional (lumped-parameter) fluid–structure interaction and thermal–structural coupling model for the dynamic inflation of a spherical architectural inflatable (a thin, elastic spherical membrane enclosing air), subject to a mass inflow from a supply through a linear valve and convective heat exchange with the ambient. The structural dynamics are assumed quasi-static so that the membrane is always in membrane equilibrium. The model must be implemented as a program that integrates a system of ordinary differential equations in time and outputs a single aggregated result for a provided test suite.\n\nYour model must be derived using only the following base principles and definitions:\n- Conservation of mass for the control volume of the interior air.\n- Conservation of energy (first law of thermodynamics) for an open system containing an ideal gas, including flow work and heat transfer.\n- Ideal gas law for air.\n- Thin spherical membrane force equilibrium under uniform internal pressure and linear elasticity with small strains.\n- A linear valve law for mass inflow as an engineering approximation.\nAll symbols, variables, functions, operators, and numbers appearing in equations must be treated with standard mathematical meaning.\n\nAssumptions:\n- The interior is filled with air modeled as an ideal gas with specific gas constant $R = 287\\,\\mathrm{J/(kg\\cdot K)}$, constant isobaric specific heat $c_p = 1005\\,\\mathrm{J/(kg\\cdot K)}$, and constant isochoric specific heat $c_v = 718\\,\\mathrm{J/(kg\\cdot K)}$, with $c_p - c_v = R$.\n- The membrane is a thin spherical shell of initial (undeformed) radius $R_0$, thickness $t$, Young’s modulus $E$, and Poisson’s ratio $\\nu$, surrounding the gas. The exterior ambient pressure is constant at $p_\\mathrm{ext}$, and the ambient temperature is $T_\\mathrm{amb}$.\n- The inflow temperature is $T_\\mathrm{in}$ and the mass inflow rate is governed by a linear valve law $\\dot{m}_\\mathrm{in} = C_f \\max\\{0, p_\\mathrm{sup} - p\\}$, where $p_\\mathrm{sup}$ is the supply pressure and $C_f$ is a valve coefficient.\n- There is no mass outflow.\n- There is a convective heat transfer between the gas and ambient through the membrane characterized by a heat transfer coefficient $h$ and the instantaneous membrane area on the gas side.\n\nStarting points for derivation:\n- Mass conservation for the interior gas: $\\dfrac{d m}{d t} = \\dot{m}_\\mathrm{in}$.\n- Energy conservation for the interior gas modeled as an open system with one inlet and no outlet: $\\dfrac{d}{d t}(m c_v T) = \\dot{m}_\\mathrm{in} c_p T_\\mathrm{in} + \\dot{Q} - p \\dfrac{d V}{d t}$, with $\\dot{Q}$ representing the net heat transfer into the gas.\n- Ideal gas law: $p V = m R T$.\n- Thin spherical membrane equilibrium and linear elasticity: relate the internal overpressure and membrane stress state to the meridional and circumferential strains, and relate those strains to the change in radius.\n- Convective heat transfer: $\\dot{Q} = - h A (T - T_\\mathrm{amb})$, where $A$ is the interior surface area and $T$ is the interior gas temperature.\n\nGoal:\n- Derive a closed set of coupled ordinary differential equations for the time evolution of the interior gas mass $m(t)$ and temperature $T(t)$, coupled to the structure through the volume $V(t)$ determined by quasi-static membrane equilibrium. The pressure $p(t)$ must satisfy the ideal gas law and the structural equilibrium relation at each time. You may eliminate variables or introduce algebraic relations as needed to obtain a numerically integrable system.\n- Implement a numerically stable time integrator with a fixed time step to simulate up to the final times requested in the test suite for each case. Any consistent high-order explicit method is acceptable if you respect the coupling exactly at each time stage by enforcing both the ideal gas relation and the membrane equilibrium.\n- For each test case, report the final interior absolute pressure $p(t_\\mathrm{final})$ in pascals, rounded to the nearest integer.\n\nTest suite:\nUse the following physically consistent test cases. In all cases, initialize the dome at ambient conditions $p(0) = p_\\mathrm{ext}$ and $T(0) = T_\\mathrm{amb}$ with the initial interior mass $m(0)$ set by the ideal gas law at volume $V(0) = \\dfrac{4}{3}\\pi R_0^3$. The membrane area is $A(t) = 4\\pi R(t)^2$. For each case, simulate with a fixed time step $\\Delta t = 0.01\\,\\mathrm{s}$ until the specified $t_\\mathrm{final}$.\n\n- Case 1 (baseline inflation with heat loss): \n  $R_0 = 2.0\\,\\mathrm{m}$, $t = 0.002\\,\\mathrm{m}$, $E = 2.0\\times 10^8\\,\\mathrm{Pa}$, $\\nu = 0.3$, $p_\\mathrm{ext} = 101325\\,\\mathrm{Pa}$, $T_\\mathrm{amb} = 293.15\\,\\mathrm{K}$, $T_\\mathrm{in} = 300.0\\,\\mathrm{K}$, $h = 5.0\\,\\mathrm{W/(m^2\\cdot K)}$, $C_f = 5.0\\times 10^{-7}\\,\\mathrm{kg/(s\\cdot Pa)}$, $p_\\mathrm{sup} = 200000\\,\\mathrm{Pa}$, $t_\\mathrm{final} = 60.0\\,\\mathrm{s}$.\n\n- Case 2 (adiabatic-like inflation): \n  $R_0 = 2.0\\,\\mathrm{m}$, $t = 0.002\\,\\mathrm{m}$, $E = 2.0\\times 10^8\\,\\mathrm{Pa}$, $\\nu = 0.3$, $p_\\mathrm{ext} = 101325\\,\\mathrm{Pa}$, $T_\\mathrm{amb} = 293.15\\,\\mathrm{K}$, $T_\\mathrm{in} = 300.0\\,\\mathrm{K}$, $h = 0.0\\,\\mathrm{W/(m^2\\cdot K)}$, $C_f = 5.0\\times 10^{-7}\\,\\mathrm{kg/(s\\cdot Pa)}$, $p_\\mathrm{sup} = 200000\\,\\mathrm{Pa}$, $t_\\mathrm{final} = 60.0\\,\\mathrm{s}$.\n\n- Case 3 (nearly rigid shell): \n  $R_0 = 2.0\\,\\mathrm{m}$, $t = 0.002\\,\\mathrm{m}$, $E = 1.0\\times 10^{12}\\,\\mathrm{Pa}$, $\\nu = 0.3$, $p_\\mathrm{ext} = 101325\\,\\mathrm{Pa}$, $T_\\mathrm{amb = 293.15\\,\\mathrm{K}}$, $T_\\mathrm{in} = 300.0\\,\\mathrm{K}$, $h = 5.0\\,\\mathrm{W/(m^2\\cdot K)}$, $C_f = 5.0\\times 10^{-7}\\,\\mathrm{kg/(s\\cdot Pa)}$, $p_\\mathrm{sup} = 200000\\,\\mathrm{Pa}$, $t_\\mathrm{final} = 60.0\\,\\mathrm{s}$.\n\n- Case 4 (small inflow, slower inflation): \n  $R_0 = 2.0\\,\\mathrm{m}$, $t = 0.002\\,\\mathrm{m}$, $E = 2.0\\times 10^8\\,\\mathrm{Pa}$, $\\nu = 0.3$, $p_\\mathrm{ext} = 101325\\,\\mathrm{Pa}$, $T_\\mathrm{amb} = 293.15\\,\\mathrm{K}$, $T_\\mathrm{in} = 300.0\\,\\mathrm{K}$, $h = 5.0\\,\\mathrm{W/(m^2\\cdot K)}$, $C_f = 1.0\\times 10^{-7}\\,\\mathrm{kg/(s\\cdot Pa)}$, $p_\\mathrm{sup} = 200000\\,\\mathrm{Pa}$, $t_\\mathrm{final} = 60.0\\,\\mathrm{s}$.\n\nOutput requirement:\n- For each case, compute the final interior absolute pressure $p(t_\\mathrm{final})$ in pascals.\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the same order as the cases above, with each entry rounded to the nearest integer and expressed in $\\mathrm{Pa}$, for example, $\\left[\\dots\\right]$.",
            "solution": "The problem statement is scrutinized and found to be valid. It is scientifically grounded in the principles of continuum mechanics, thermodynamics, and solid mechanics. It is well-posed as an initial value problem for a system of coupled ordinary differential equations (ODEs), with all necessary parameters and initial conditions provided. The language is objective and precise.\n\nThe objective is to derive and implement a lumped-parameter model for the inflation of a spherical elastic membrane. The state of the system at any time $t$ is described by the mass $m(t)$ and temperature $T(t)$ of the air inside the membrane. A system of two coupled ODEs for these state variables must be formulated.\n\nFirst, we establish the algebraic relationships that couple the fluid and structural domains. The system involves three key physical laws that must be simultaneously satisfied at all times under the quasi-static assumption:\n1.  Ideal Gas Law: The pressure $p$, volume $V$, mass $m$, and temperature $T$ of the interior air are related by $p V = m R_{gas} T$, where $R_{gas}$ is the specific gas constant for air. The volume of the sphere is $V = \\frac{4}{3}\\pi R^3$, where $R$ is the instantaneous radius.\n2.  Thin Spherical Membrane Equilibrium: The gauge pressure $\\Delta p = p - p_\\mathrm{ext}$ is supported by the membrane stress $\\sigma$. The equilibrium equation is $\\Delta p = \\frac{2 \\sigma t}{R}$, where $t$ is the membrane thickness.\n3.  Linear Elasticity: For a thin spherical shell under uniform biaxial tension, the stress is related to the strain $\\epsilon$ by $\\sigma = \\frac{E}{1-\\nu}\\epsilon$, where $E$ is Young's modulus and $\\nu$ is Poisson's ratio. The strain is given by the change in radius: $\\epsilon = \\frac{R - R_0}{R_0}$, where $R_0$ is the initial, undeformed radius.\n\nBy combining the structural equations, we obtain a relationship between pressure and radius:\n$$p(R) = p_\\mathrm{ext} + \\frac{2t}{R} \\left( \\frac{E}{1-\\nu} \\frac{R-R_0}{R_0} \\right) = p_\\mathrm{ext} + K_s \\left(1 - \\frac{R_0}{R}\\right)$$\nwhere we define a structural stiffness parameter $K_s = \\frac{2Et}{(1-\\nu)R_0}$.\n\nEquating the pressure from the ideal gas law, $p = \\frac{m R_{gas} T}{V} = \\frac{3 m R_{gas} T}{4\\pi R^3}$, with the pressure from the structural equilibrium gives a single non-linear algebraic equation for the radius $R$ as a function of the state variables $m$ and $T$:\n$$g(R; m, T) = \\frac{3 m R_{gas} T}{4 \\pi R^3} - p_\\mathrm{ext} - K_s \\left( 1 - \\frac{R_0}{R} \\right) = 0$$\nThis equation must be solved for $R$ at each instant in time. Since it is non-linear, a numerical root-finding method, such as Newton-Raphson, is required.\n\nNext, we derive the system of ODEs for the state variables $m(t)$ and $T(t)$.\n\n1.  **Mass Conservation**: The rate of change of mass is given by the net mass flow rate. With only inflow, this is:\n    $$\\frac{dm}{dt} = \\dot{m}_\\mathrm{in}$$\n    The mass inflow rate $\\dot{m}_\\mathrm{in}$ is governed by the linear valve law:\n    $$\\dot{m}_\\mathrm{in} = C_f \\max\\{0, p_\\mathrm{sup} - p\\}$$\n    where $p_\\mathrm{sup}$ is the supply pressure, $C_f$ is the valve coefficient, and $p$ is the internal pressure, which depends on the state $(m, T)$ through the algebraic coupling.\n\n2.  **Energy Conservation**: The first law of thermodynamics for the open system (the interior air) is:\n    $$\\frac{d}{dt}(m c_v T) = c_p T_\\mathrm{in} \\dot{m}_\\mathrm{in} + \\dot{Q} - p \\frac{dV}{dt}$$\n    where $c_v$ and $c_p$ are the specific heats at constant volume and pressure, $T_\\mathrm{in}$ is the inflow temperature, and $\\dot{Q}$ is the heat transfer rate. The heat transfer is convective: $\\dot{Q} = -hA(T - T_\\mathrm{amb})$, where $h$ is the heat transfer coefficient, $A=4\\pi R^2$ is the membrane area, and $T_\\mathrm{amb}$ is the ambient temperature. The term $p \\frac{dV}{dt}$ represents the rate of work done by the gas on the expanding membrane.\n\nThe term $\\frac{dV}{dt}$ makes the equation implicit. To obtain an explicit ODE for $T$, we manipulate the energy equation. Differentiating the ideal gas law $pV=mR_{gas}T$ gives $p\\frac{dV}{dt} + V\\frac{dp}{dt} = R_{gas}(m\\frac{dT}{dt} + T\\frac{dm}{dt})$. Substituting $p\\frac{dV}{dt}$ and using $R_{gas} = c_p - c_v$, the energy equation can be rewritten as:\n$$m c_p \\frac{dT}{dt} = \\dot{m}_\\mathrm{in} c_p (T_\\mathrm{in} - T) - h A (T - T_\\mathrm{amb}) + V \\frac{dp}{dt}$$\nThis form contains $\\frac{dp}{dt}$. Since $p$ is an algebraic function of the state variables $(m, T)$ via the radius $R(m, T)$, we can use the chain rule: $\\frac{dp}{dt} = \\frac{\\partial p}{\\partial m}\\frac{dm}{dt} + \\frac{\\partial p}{\\partial T}\\frac{dT}{dt}$. Substituting this into the energy equation and solving for $\\frac{dT}{dt}$ yields:\n$$\\frac{dT}{dt} = \\frac{\\dot{m}_\\mathrm{in} \\left[ c_p (T_\\mathrm{in} - T) + V \\frac{\\partial p}{\\partial m} \\right] - h A (T - T_\\mathrm{amb})}{m c_p - V \\frac{\\partial p}{\\partial T}}$$\nThe partial derivatives $\\frac{\\partial p}{\\partial m}$ and $\\frac{\\partial p}{\\partial T}$ are found by implicit differentiation of the algebraic constraint $g(R; m, T)=0$. This yields:\n$$\\frac{\\partial p}{\\partial m} = \\frac{\\partial p}{\\partial R} \\frac{\\partial R}{\\partial m} = \\frac{K_s R_0 p / m}{3pR + K_s R_0} \\quad \\text{and} \\quad \\frac{\\partial p}{\\partial T} = \\frac{\\partial p}{\\partial R} \\frac{\\partial R}{\\partial T} = \\frac{K_s R_0 p / T}{3pR + K_s R_0}$$\nThis completes the formulation of the ODE system.\n\nThe system is integrated numerically using the 4th-order Runge-Kutta (RK4) method with a fixed time step $\\Delta t$. At each stage of the RK4 integrator, the algebraic equation for $R$ is solved using Newton's method to ensure the coupling between the fluid and structure is accurately enforced.\n\nThe initial conditions at $t=0$ are:\n$T(0) = T_\\mathrm{amb}$\n$p(0) = p_\\mathrm{ext}$ (implying $R(0) = R_0$)\n$m(0) = \\frac{p_\\mathrm{ext} V_0}{R_{gas} T_\\mathrm{amb}}$, where $V_0 = \\frac{4}{3}\\pi R_0^3$.\n\nThe implementation will follow this procedure for each test case, simulating up to $t_\\mathrm{final}$ and reporting the final pressure $p(t_\\mathrm{final})$, rounded to the nearest integer.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the fluid-structure interaction problem for a set of test cases.\n    \"\"\"\n    \n    # Define physical constants\n    R_gas = 287.0  # J/(kg.K)\n    c_p = 1005.0   # J/(kg.K)\n\n    test_cases = [\n        # Case 1: baseline inflation with heat loss\n        {'R0': 2.0, 't_mem': 0.002, 'E': 2.0e8, 'nu': 0.3, 'p_ext': 101325.0, 'T_amb': 293.15, 'T_in': 300.0, 'h': 5.0, 'Cf': 5.0e-7, 'p_sup': 200000.0, 't_final': 60.0},\n        # Case 2: adiabatic-like inflation\n        {'R0': 2.0, 't_mem': 0.002, 'E': 2.0e8, 'nu': 0.3, 'p_ext': 101325.0, 'T_amb': 293.15, 'T_in': 300.0, 'h': 0.0, 'Cf': 5.0e-7, 'p_sup': 200000.0, 't_final': 60.0},\n        # Case 3: nearly rigid shell\n        {'R0': 2.0, 't_mem': 0.002, 'E': 1.0e12, 'nu': 0.3, 'p_ext': 101325.0, 'T_amb': 293.15, 'T_in': 300.0, 'h': 5.0, 'Cf': 5.0e-7, 'p_sup': 200000.0, 't_final': 60.0},\n        # Case 4: small inflow, slower inflation\n        {'R0': 2.0, 't_mem': 0.002, 'E': 2.0e8, 'nu': 0.3, 'p_ext': 101325.0, 'T_amb': 293.15, 'T_in': 300.0, 'h': 5.0, 'Cf': 1.0e-7, 'p_sup': 200000.0, 't_final': 60.0},\n    ]\n    \n    dt = 0.01\n    results = []\n\n    for case in test_cases:\n        p_final = run_simulation(case, dt, R_gas, c_p)\n        results.append(str(int(round(p_final))))\n\n    print(f\"[{','.join(results)}]\")\n\ndef run_simulation(params, dt, R_gas, c_p):\n    \"\"\"\n    Runs a single simulation case.\n    \"\"\"\n    # Unpack parameters\n    R0, t_mem, E, nu, p_ext, T_amb = params['R0'], params['t_mem'], params['E'], params['nu'], params['p_ext'], params['T_amb']\n    T_in, h, Cf, p_sup, t_final = params['T_in'], params['h'], params['Cf'], params['p_sup'], params['t_final']\n\n    # Structural constant\n    K_s = (2.0 * E * t_mem) / ((1.0 - nu) * R0)\n\n    # Initial conditions\n    V0 = (4.0 / 3.0) * np.pi * R0**3\n    T0 = T_amb\n    m0 = (p_ext * V0) / (R_gas * T0)\n    \n    y = np.array([m0, T0])\n    R_current = R0\n\n    def get_derivatives(y_state, R_guess, p_dict):\n        m, T = y_state\n\n        # 1. Solve for Radius R using Newton's method\n        R = R_guess\n        for _ in range(10):\n            R2, R3 = R**2, R**3\n            p_gas_term = (3.0 * m * R_gas * T) / (4.0 * np.pi * R3)\n            g_R = p_gas_term - p_dict['p_ext'] - p_dict['K_s'] * (1.0 - p_dict['R0'] / R)\n            g_prime_R = -3.0 * p_gas_term / R - p_dict['K_s'] * p_dict['R0'] / R2\n            \n            if abs(g_prime_R) < 1e-12: break\n            delta_R = -g_R / g_prime_R\n            R = R + delta_R\n            if abs(delta_R) < 1e-9 * R: break\n\n        # 2. Calculate algebraic quantities\n        p = p_dict['p_ext'] + p_dict['K_s'] * (1.0 - p_dict['R0'] / R)\n        V = (4.0 / 3.0) * np.pi * R**3\n        A = 4.0 * np.pi * R**2\n        m_dot_in = p_dict['Cf'] * max(0, p_dict['p_sup'] - p)\n        \n        # 3. Calculate ODE derivatives dy/dt\n        dm_dt = m_dot_in\n        \n        D_denom = 3.0 * p * R + p_dict['K_s'] * p_dict['R0']\n        if abs(D_denom) < 1e-9 or m < 1e-9 or T < 1e-9:\n            dp_dm, dp_dT = 0.0, 0.0\n        else:\n            dp_dm = (p_dict['K_s'] * p_dict['R0'] * p / m) / D_denom\n            dp_dT = (p_dict['K_s'] * p_dict['R0'] * p / T) / D_denom\n\n        num_dT_dt = m_dot_in * (c_p * (p_dict['T_in'] - T) + V * dp_dm) - p_dict['h'] * A * (T - p_dict['T_amb'])\n        den_dT_dt = m * c_p - V * dp_dT\n        \n        dT_dt = num_dT_dt / den_dT_dt if abs(den_dT_dt) > 1e-9 else 0.0\n        \n        return np.array([dm_dt, dT_dt]), R\n\n    param_dict = {\n        'R0': R0, 'K_s': K_s, 'p_ext': p_ext, 'T_in': T_in,\n        'h': h, 'Cf': Cf, 'p_sup': p_sup, 'T_amb': T_amb\n    }\n\n    num_steps = int(t_final / dt)\n    for _ in range(num_steps):\n        # 4th-order Runge-Kutta (RK4)\n        k1, R1 = get_derivatives(y, R_current, param_dict)\n        k2, R2 = get_derivatives(y + 0.5 * dt * k1, R1, param_dict)\n        k3, R3 = get_derivatives(y + 0.5 * dt * k2, R2, param_dict)\n        k4, _ = get_derivatives(y + dt * k3, R3, param_dict)\n        \n        y += (dt / 6.0) * (k1 + 2.0 * k2 + 2.0 * k3 + k4)\n        \n        # Update R_current as an initial guess for the next step's Newton solver\n        _, R_current = get_derivatives(y, R_current, param_dict)\n\n    # Final pressure calculation\n    m_final, T_final = y\n    \n    # Solve for final radius R_final\n    R_final = R_current\n    for _ in range(10):\n        R_f2, R_f3 = R_final**2, R_final**3\n        p_gas_term = (3.0 * m_final * R_gas * T_final) / (4.0 * np.pi * R_f3)\n        g_R = p_gas_term - p_ext - K_s * (1.0 - R0 / R_final)\n        g_prime_R = -3.0 * p_gas_term / R_final - K_s * R0 / R_f2\n        if abs(g_prime_R) < 1e-12: break\n        delta_R = -g_R / g_prime_R\n        R_final += delta_R\n        if abs(delta_R) < 1e-9 * R_final: break\n            \n    p_final = p_ext + K_s * (1.0 - R0 / R_final)\n    return p_final\n\nif __name__ == '__main__':\n    solve()\n```"
        }
    ]
}