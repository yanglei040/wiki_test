{
    "hands_on_practices": [
        {
            "introduction": "要真正理解一个数值方法，最好的方式就是亲手计算。这个入门练习旨在让你熟悉休恩（Heun）方法的预测-校正两步流程。通过为一个给定的常微分方程（ODE）手动计算一个步长，你将亲身体验初始预测值是如何被校正步骤所改进的，从而为更复杂的应用打下坚实的基础。",
            "id": "2202828",
            "problem": "考虑由 $y'(t) = \\sin(t) - \\frac{y(t)}{t+1}$ 给出的一阶常微分方程(ODE)，该方程描述了一个具有时变输入和时变衰减率的系统。给定初始条件 $y(0) = 2$。我们希望使用单步Heun方法来近似 $y(0.1)$ 的值。正弦函数的参数以弧度为单位。\n\nHeun方法是一种用于求解形式为 $y' = f(t,y)$，初值为 $y(t_0) = y_0$ 的初值问题的预测-校正算法。对于给定的步长 $h$，下一个时间步的近似值 $y_1 \\approx y(t_0+h)$ 通过两个阶段计算：\n\n1.  **预测步**：使用Euler方法估计一个中间值 $\\tilde{y}_1$：\n    $$ \\tilde{y}_1 = y_0 + h f(t_0, y_0) $$\n2.  **校正步**：最终的近似值 $y_1$ 是通过对初始点 $(t_0, y_0)$ 的斜率和估计点 $(t_1, \\tilde{y}_1)$ 的斜率求平均来计算的，其中 $t_1 = t_0 + h$：\n    $$ y_1 = y_0 + \\frac{h}{2} \\left[ f(t_0, y_0) + f(t_1, \\tilde{y}_1) \\right] $$\n\n使用单步计算 $y(0.1)$ 的数值近似值。将最终答案四舍五入到四位有效数字。",
            "solution": "我们已知常微分方程 $y'(t)=\\sin(t)-\\dfrac{y(t)}{t+1}$，初始条件为 $y(0)=2$，并使用步长 $h=0.1$ 的单步Heun方法求解 $y(0.1)$。定义 $f(t,y)=\\sin(t)-\\dfrac{y}{t+1}$。\n\n在初始点 $(t_{0},y_{0})=(0,2)$，计算斜率：\n$$\nf(t_{0},y_{0})=f(0,2)=\\sin(0)-\\frac{2}{0+1}=0-2=-2.\n$$\n\n预测步 (Euler方法)：\n$$\n\\tilde{y}_{1}=y_{0}+h\\,f(t_{0},y_{0})=2+0.1\\cdot(-2)=1.8.\n$$\n\n在点 $(t_{1},\\tilde{y}_{1})$ 处计算斜率，其中 $t_{1}=t_{0}+h=0.1$：\n$$\nf(t_{1},\\tilde{y}_{1})=f(0.1,1.8)=\\sin(0.1)-\\frac{1.8}{1.1}.\n$$\n使用弧度制，$\\sin(0.1)\\approx 0.0998334166468$ 且 $\\dfrac{1.8}{1.1}\\approx 1.63636363636$，所以\n$$\nf(t_{1},\\tilde{y}_{1})\\approx 0.0998334166468-1.63636363636\\approx -1.5365302197168.\n$$\n\n校正步：\n$$\ny_{1}=y_{0}+\\frac{h}{2}\\Big(f(t_{0},y_{0})+f(t_{1},\\tilde{y}_{1})\\Big)\n=2+0.05\\left(-2-1.5365302197168\\right)\\approx 2-0.1768265109858\\approx 1.8231734890142.\n$$\n\n四舍五入到四位有效数字，得到 $y(0.1)\\approx 1.823$。",
            "answer": "$$\\boxed{1.823}$$"
        },
        {
            "introduction": "“校正”这一术语通常意味着精度的提升，但事实总是如此吗？这个练习将引导你探索计算科学中的一个核心概念：数值稳定性。通过一个精心挑选的刚性（stiff）微分方程和一个较大的步长 $h$，你将会发现一个“校正”步骤反而增大了误差的反直觉情景。这个例子深刻地揭示了，任何数值方法的有效性都是有条件的，盲目应用可能会导致错误的结果。",
            "id": "2428207",
            "problem": "考虑常微分方程 (ODE) 的初值问题\n$$\\frac{dy}{dt}=-10\\,y,\\qquad y(0)=1.$$\n使用步长 $h=0.5$ 的单步两阶段显式梯形预测-校正法（Heun 法）将解从 $t=0$推进到 $t=0.5$。令 $y_{E}$ 表示在 $t=0.5$ 时得到的前向欧拉预测值，令 $y_{H}$ 表示应用梯形校正后在 $t=0.5$ 时的校正值。令 $y^{\\ast}$ 表示在 $t=0.5$ 时的精确解。计算比率\n$$r=\\frac{|y_{H}-y^{\\ast}|}{|y_{E}-y^{\\ast}|}.$$\n将最终答案四舍五入至四位有效数字。不包含单位。",
            "solution": "该问题经验证是自洽的、有科学依据且适定的。我们继续进行求解。\n\n该初值问题由常微分方程 (ODE) 给出\n$$ \\frac{dy}{dt} = f(t, y) = -10y $$\n初始条件为 $y(0) = 1$。\n我们的任务是使用大小为 $h = 0.5$ 的一个步长，从 $t_0 = 0$ 和 $y_0 = 1$ 开始，求出在 $t_1 = 0.5$ 时的数值解。最终目标是计算误差之比。\n\n首先，我们必须确定精确解，记为 $y^{\\ast}(t)$。该常微分方程是一个线性的、一阶的、可分离方程。\n$$ \\frac{dy}{y} = -10 dt $$\n对两边积分得到：\n$$ \\int \\frac{dy}{y} = \\int (-10) dt $$\n$$ \\ln|y| = -10t + C $$\n其中 $C$ 是积分常数。对两边取指数得到：\n$$ y(t) = A \\exp(-10t) $$\n其中 $A = \\exp(C)$。我们使用初始条件 $y(0) = 1$ 来求 $A$：\n$$ 1 = A \\exp(-10 \\cdot 0) \\implies A = 1 $$\n因此，精确解为：\n$$ y^{\\ast}(t) = \\exp(-10t) $$\n在 $t=0.5$ 时，精确值为：\n$$ y^{\\ast} = y^{\\ast}(0.5) = \\exp(-10 \\cdot 0.5) = \\exp(-5) $$\n\n接下来，我们计算在 $t_1 = 0.5$ 时的前向欧拉预测值 $y_{E}$。前向欧拉法由以下公式给出：\n$$ y_{n+1} = y_n + h f(t_n, y_n) $$\n对于我们的问题，$n=0$，$y_0=1$，$t_0=0$ 且 $h=0.5$。函数为 $f(t_0, y_0) = -10y_0 = -10(1) = -10$。\n因此，预测值为：\n$$ y_{E} = y_0 + h f(t_0, y_0) = 1 + (0.5)(-10) = 1 - 5 = -4 $$\n\n现在，我们使用 Heun 法（一种两阶段显式梯形预测-校正法）计算校正值 $y_{H}$。该方法定义如下：\n1. 预测步：$\\tilde{y}_{n+1} = y_n + h f(t_n, y_n)$\n2. 校正步：$y_{n+1} = y_n + \\frac{h}{2} \\left[ f(t_n, y_n) + f(t_{n+1}, \\tilde{y}_{n+1}) \\right]$\n\n预测步与前向欧拉步相同，所以我们有 $\\tilde{y}_1 = y_E = -4$。\n对于校正步，我们需要使用预测值 $\\tilde{y}_1 = -4$ 在新的时间 $t_1 = 0.5$ 处计算函数 $f$。\n- 区间开始处的斜率为 $k_1 = f(t_0, y_0) = f(0, 1) = -10(1) = -10$。\n- 使用预测值估计的区间末端斜率为 $k_2 = f(t_1, \\tilde{y}_1) = f(0.5, -4) = -10(-4) = 40$。\n那么校正值 $y_H$ 为：\n$$ y_{H} = y_0 + \\frac{h}{2} (k_1 + k_2) = 1 + \\frac{0.5}{2} (-10 + 40) = 1 + (0.25)(30) = 1 + 7.5 = 8.5 $$\n\n最后，我们计算绝对误差之比 $r$。\n校正值的误差为 $|y_{H} - y^{\\ast}|$。\n$$ |y_{H} - y^{\\ast}| = |8.5 - \\exp(-5)| $$\n预测（欧拉）值的误差为 $|y_{E} - y^{\\ast}|$。\n$$ |y_{E} - y^{\\ast}| = |-4 - \\exp(-5)| = |- (4 + \\exp(-5))| = 4 + \\exp(-5) $$\n比率 $r$ 为：\n$$ r = \\frac{|y_{H} - y^{\\ast}|}{|y_{E} - y^{\\ast}|} = \\frac{|8.5 - \\exp(-5)|}{4 + \\exp(-5)} $$\n为了获得数值，我们使用 $\\exp(-5) \\approx 0.006737947$。\n$$ r = \\frac{8.5 - 0.006737947}{4 + 0.006737947} = \\frac{8.493262053}{4.006737947} \\approx 2.1197368 $$\n将结果四舍五入至四位有效数字，我们得到：\n$$ r \\approx 2.120 $$\n这个大于 $1$ 的大比率表明，对于这个大步长，校正步相对于预测步并没有提高精度，反而增大了误差。这是一个已知的结果，即对于一个刚性问题，当使用的显式方法的步长超出了绝对稳定域时会出现这种情况。",
            "answer": "$$\\boxed{2.120}$$"
        },
        {
            "introduction": "在掌握了休恩方法的基本操作并了解了其局限性之后，我们可以提出一个更深刻的问题：是否存在某一类问题，使得休恩方法能够给出完全精确的解析解？这个高级练习挑战你超越简单的公式应用，去探索常微分方程本身的结构与数值方法内在特性之间的根本联系。解决这个问题将揭示出该方法截断误差完全为零的条件，加深你对数值精度来源的理解。",
            "id": "2428172",
            "problem": "考虑一个常微分方程 (ODE) 的初值问题，其形式为 $y^{\\prime}(t)=f(t,y(t))$，并带有任意初始条件 $y(0)=y_{0}$。构造一个特定的函数 $f(t,y)$，使得当该系统使用休恩法（显式梯形预估-校正格式）以任意步长 $h>0$ 进行时间推进时，对于所有 $y_{0}$ 和所有 $h>0$ 的选择，网格点上的数值解都与解析解完全吻合。\n\n请以 $f(t,y)$ 的单个显式表达式（例如，一个关于 $t$ 和 $y$ 的表达式）的形式给出您的答案，而不是一个方程。无需四舍五入。",
            "solution": "所述问题是有效的。这是一个数值分析领域中适定 (well-posed) 的数学问题。不存在科学或逻辑上的缺陷。\n\n设初值问题为 $y^{\\prime}(t) = f(t, y(t))$，初始条件为 $y(t_0) = y_0$。休恩法使用预估-校正格式计算下一个网格点 $t_{n+1} = t_n + h$ 处的数值解。设 $y_n$ 是 $y(t_n)$ 的近似值。\n预估步是一个显式欧拉步：\n$$ \\tilde{y}_{n+1} = y_n + h f(t_n, y_n) $$\n校正步使用区间起点和预估终点处斜率的平均值：\n$$ y_{n+1} = y_n + \\frac{h}{2} [f(t_n, y_n) + f(t_{n+1}, \\tilde{y}_{n+1})] $$\n问题要求对于任意步长 $h>0$ 和任意初始条件 $y_0$，数值解都与解析解完全吻合。这意味着如果我们从真实解析曲线上的一个点开始一个步骤，即 $y_n = y(t_n)$，则该方法必须在下一个点产生精确值，即 $y_{n+1} = y(t_{n+1})$。\n\n在 $t_{n+1}$ 处的解析解可以通过对常微分方程积分来表示：\n$$ y(t_{n+1}) = y(t_n) + \\int_{t_n}^{t_{n+1}} f(s, y(s)) ds $$\n因此，精确性的条件是，对于从解曲线上开始的任何一步，休恩法都能完美地表示这个积分：\n$$ \\int_{t_n}^{t_{n+1}} f(s, y(s)) ds = \\frac{h}{2} [f(t_n, y(t_n)) + f(t_{n+1}, y(t_n) + h f(t_n, y(t_n)))] $$\n这个恒等式必须对任何解曲线上的所有 $t_n$ 以及所有 $h>0$ 都成立。为简单起见，我们用 $(t, y(t))$ 表示起始点。该恒等式为：\n$$ \\int_{t}^{t+h} f(s, y(s)) ds = \\frac{h}{2} [f(t, y(t)) + f(t+h, y(t) + h f(t, y(t)))] $$\n让我们分析一些关于 $f(t,y)$ 结构的情况。\n\n情况1：$f(t,y)$ 与 $y$ 无关。\n设 $f(t, y) = g(t)$。预估步对于函数 $f$ 的求值变得无关紧要，因为它只依赖于时间。该恒等式简化为：\n$$ \\int_{t}^{t+h} g(s) ds = \\frac{h}{2} [g(t) + g(t+h)] $$\n这个方程表明，对于任意长度为 $h>0$ 的区间，用于对函数 $g(t)$ 积分的梯形法则都是精确的。应用于积分 $\\int_a^b g(s) ds$ 的梯形法则的误差项由 $-\\frac{(b-a)^3}{12} g''(\\xi)$ 给出，其中某个 $\\xi \\in (a, b)$。为了使这个误差对于任意区间 $[t, t+h]$ 都为零，被积函数的二阶导数必须恒为零，即对于所有 $s$，都有 $g''(s) = 0$。\n$g''(s) = 0$ 的通解是 $s$ 的一个线性函数：\n$$ g(s) = as + c $$\n其中 $a$ 和 $c$ 是任意常数。因此，任何形式为 $f(t,y) = at+c$ 的函数都是一个候选解。\n\n情况2：$f(t,y)$ 是 $t$ 和 $y$ 的一个通用线性函数。\n设 $f(t, y) = at + by + c$。为了使休恩法对任意 $h>0$ 都精确，数值解的泰勒级数必须与解析解的泰勒级数在 $h$ 的幂次上完全匹配。\n解析解 $y(t+h)$ 在 $t$ 附近展开为：\n$$ y(t+h) = y(t) + h y'(t) + \\frac{h^2}{2} y''(t) + \\frac{h^3}{6} y'''(t) + O(h^4) $$\n导数为：\n$y' = at+by+c = f$\n$y'' = \\frac{d}{dt}(at+by+c) = a + by' = a + b f$\n$y''' = \\frac{d}{dt}(a+bf) = bf' = b(a+bf) = b(y'')$\n$y^{(k)} = b^{k-2} y''$ for $k \\ge 2$。\n\n休恩法步骤给出：\n$y_{num}(t+h) = y(t) + \\frac{h}{2} [f(t,y) + f(t+h, y + hf(t,y))] $\n$= y(t) + \\frac{h}{2} [f + (a(t+h) + b(y+hf) + c)] $\n$= y(t) + \\frac{h}{2} [f + (at+by+c) + ah + bhf] $\n$= y(t) + \\frac{h}{2} [2f + ah + bhf] $\n$= y(t) + hf + \\frac{h^2}{2}(a+bf) $\n$= y(t) + hy'(t) + \\frac{h^2}{2}y''(t)$\n\n将解析展开与数值结果进行比较：\n解析解： $y(t) + hy' + \\frac{h^2}{2}y'' + \\frac{h^3}{6}y''' + ...$\n数值解： $y(t) + hy' + \\frac{h^2}{2}y''$\n为了使这两者对所有 $h>0$ 都相同，解析展开中的所有高阶项都必须为零。这要求对于所有 $t$ 和任何解曲线 $y(t)$（即，对于任何初始条件 $y_0$），都有 $y'''(t) = 0$。\n条件 $y'''(t) = 0$ 意味着 $b y''(t) = 0$。\n如果 $b \\neq 0$，那么我们必须有 $y''(t) = 0$。这意味着 $a+bf=0$，所以 $f = y' = -a/b$，是一个常数。如果 $y'$ 是常数，那么 $y(t)$ 是 $t$ 的一个线性函数。将 $y'(t)=-a/b$ 代入常微分方程 $y'=at+by+c$ 得出 $-a/b = at+by(t)+c$。这必须对所有 $t$ 和任何 $y_0$ 都成立。这只在 $a=0$ 和 $b=0$ 时才可能，但这与我们的假设 $b \\neq 0$ 相矛盾。通过 $y(t)$ 对 $y_0$ 的依赖性也要求 $b=0$。\n因此，我们必须得出结论 $b=0$。\n\n两种推理思路都导向相同的结论：函数 $f(t,y)$ 不能依赖于 $y$。它必须是 $t$ 的一个线性函数。\n$$ f(t,y) = at+c $$\n其中 $a$ 和 $c$ 是某些常数。问题要求一个特定的函数。我们可以为 $a$ 和 $c$ 选择任何值。一个简单的非平凡选择是 $a=1$ 和 $c=0$。\n让我们验证 $f(t,y)=t$。\n常微分方程是 $y'=t$，所以解析解是 $y(t)=\\frac{1}{2}t^2+y_0$。\n休恩法给出：\n$y_{n+1} = y_n + \\frac{h}{2}[f(t_n,y_n) + f(t_{n+1}, \\tilde{y}_{n+1})]$\n由于 $f(t,y)=t$，这变成 $y_{n+1} = y_n + \\frac{h}{2}[t_n + t_{n+1}]$。\n精确解满足 $y(t_{n+1}) - y(t_n) = (\\frac{1}{2}t_{n+1}^2+y_0) - (\\frac{1}{2}t_n^2+y_0) = \\frac{1}{2}(t_{n+1}^2 - t_n^2)$。\n由于 $t_{n+1}=t_n+h$，这是 $\\frac{1}{2}(t_n+h-t_n)(t_n+h+t_n) = \\frac{h}{2}(t_{n+1}+t_n)$。\n所以我们有 $y(t_{n+1}) - y(t_n) = \\frac{h}{2}(t_{n+1}+t_n)$。\n如果我们假设 $y_n = y(t_n)$，休恩法给出 $y_{n+1} = y(t_n) + \\frac{h}{2}(t_n+t_{n+1}) = y(t_n) + (y(t_{n+1}) - y(t_n)) = y(t_{n+1})$。\n通过归纳法，数值解在所有网格点上都是精确的。这对任何 $y_0$ 和 $h>0$ 都成立。\n因此，$f(t,y)$ 的一个简单的、特定的表达式是 $t$。",
            "answer": "$$\n\\boxed{t}\n$$"
        }
    ]
}