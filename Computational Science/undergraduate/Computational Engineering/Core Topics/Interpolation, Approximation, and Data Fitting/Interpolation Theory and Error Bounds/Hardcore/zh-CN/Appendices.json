{
    "hands_on_practices": [
        {
            "introduction": "工程师和科学家常常需要根据有限的离散数据点来近似一个未知的或复杂的函数。本练习将此过程置于一个实际的物理情境中：利用多项式插值来模拟放射性同位素的衰变。通过这个练习，你将亲手构建一个拉格朗日插值多项式，并应用标准的插值误差公式，从而直观地理解当底层函数性质良好时，理论误差界限与实际误差之间的关系 。",
            "id": "2404756",
            "problem": "一个放射性同位素样品的核衰变可以用核物理中的基本一级速率定律很好地建模，这意味着活度 $A(t)$ 满足方程 $\\frac{dA}{dt}=-\\lambda A(t)$，其解为 $A(t)=A(0)\\exp(-\\lambda t)$，其中 $\\lambda>0$ 是衰变常数。一个理想探测器在 $t=0,1,5$ 天时记录了活度，得到了以下精确测量值：$A(0)=1000$ 次/秒，$A(1)=1000\\cdot 2^{-2/5}$ 次/秒，以及 $A(5)=250$ 次/秒。\n\n- 仅使用这三个测量值，构建经过数据点 $(0,A(0))$、$(1,A(1))$ 和 $(5,A(5))$ 的唯一二次插值多项式 $p_{2}(t)$，并计算 $p_{2}(3)$。\n- 独立地，使用物理指数衰变模型以及在 $t=0$ 和 $t=5$ 时的端点测量值来确定衰变常数 $\\lambda$，并预测在 $t=3$ 天时的活度 $A(3)$。\n- 从第一性原理出发，不使用任何快捷公式，通过将基于 $A^{(3)}(t)$ 的余项估计与从指数衰变模型在区间 $[0,5]$ 上获得的 $|A^{(3)}(t)|$ 的界相结合，推導在 $t=3$ 处插值误差的一个上界，形式为 $|A(3)-p_{2}(3)|\\leq B$。请给出你得到的显式界 $B$。\n\n最后，计算绝对差异 $|p_{2}(3)-A(3)|$ 并报告其值。将你的答案四舍五入到四位有效数字，并以“次/秒”为单位表示。只提供这个单一的数值作为你的最终答案。此问题不涉及角度。",
            "solution": "首先对所提供的问题进行验证。\n\n**步骤 1：提取已知条件**\n- 活度 $A(t)$ 的控制微分方程为 $\\frac{dA}{dt}=-\\lambda A(t)$。\n- 活度的物理模型为 $A(t) = A(0)\\exp(-\\lambda t)$，其中衰变常数 $\\lambda > 0$。\n- 在特定时间的精确测量值为：\n  - $t_0=0$ 天，$y_0 = A(0) = 1000$ 次/秒。\n  - $t_1=1$ 天，$y_1 = A(1) = 1000 \\cdot 2^{-2/5}$ 次/秒。\n  - $t_2=5$ 天，$y_2 = A(5) = 250$ 次/秒。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题具有科学依据，采用了核物理中标准的一级指数衰变模型。它是适定的，因为它要求一系列特定的、可计算的量。其客观性从所使用的精确数学语言中可以清楚地看出。为确保一致性，给定的数据点必须对同一个 $\\lambda$ 值满足物理模型。使用端点 $t_0=0$ 和 $t_2=5$：\n$A(5) = A(0) \\exp(-5\\lambda) \\implies 250 = 1000 \\exp(-5\\lambda)$。\n这得到 $\\exp(-5\\lambda) = \\frac{250}{1000} = \\frac{1}{4}$。由此，$-5\\lambda = \\ln(\\frac{1}{4}) = -\\ln(4) = -2\\ln(2)$，所以 $\\lambda = \\frac{2\\ln(2)}{5}$。该值为正，因此在物理上是有效的。\n现在，我们用这个常数验证在 $t_1=1$ 处的数据点：\n$A(1) = A(0)\\exp(-\\lambda \\cdot 1) = 1000 \\exp(-\\frac{2\\ln(2)}{5}) = 1000 \\cdot (\\exp(\\ln(2)))^{-2/5} = 1000 \\cdot 2^{-2/5}$。\n这与给定的 $A(1)$ 值相同。因此，该问题是自洽、一致且科学合理的。\n\n**步骤 3：结论与行动**\n问题有效。现在推导完整解。\n\n**第一部分：构建二次插值多项式 $p_2(t)$**\n对数据点 $(0, y_0)$、$(1, y_1)$、$(5, y_2)$进行插值的唯一二次多项式 $p_2(t)$ 可使用拉格朗日形式构建：\n$p_2(t) = y_0 L_0(t) + y_1 L_1(t) + y_2 L_2(t)$，其中拉格朗日基多项式 $L_i(t)$ 为：\n$L_0(t) = \\frac{(t-1)(t-5)}{(0-1)(0-5)} = \\frac{1}{5}(t-1)(t-5)$。\n$L_1(t) = \\frac{(t-0)(t-5)}{(1-0)(1-5)} = -\\frac{1}{4}t(t-5)$。\n$L_2(t) = \\frac{(t-0)(t-1)}{(5-0)(5-1)} = \\frac{1}{20}t(t-1)$。\n\n我们必须计算 $p_2(t)$ 在 $t=3$ 处的值。首先，我们计算基多项式在 $t=3$ 处的值：\n$L_0(3) = \\frac{(3-1)(3-5)}{5} = \\frac{(2)(-2)}{5} = -\\frac{4}{5}$。\n$L_1(3) = -\\frac{3(3-5)}{4} = -\\frac{3(-2)}{4} = \\frac{6}{4} = \\frac{3}{2}$。\n$L_2(3) = \\frac{3(3-1)}{20} = \\frac{3(2)}{20} = \\frac{6}{20} = \\frac{3}{10}$。\n\n现在我们可以计算 $p_2(3)$：\n$p_2(3) = y_0 L_0(3) + y_1 L_1(3) + y_2 L_2(3)$\n$p_2(3) = (1000)(-\\frac{4}{5}) + (1000 \\cdot 2^{-2/5})(\\frac{3}{2}) + (250)(\\frac{3}{10})$\n$p_2(3) = -800 + 1500 \\cdot 2^{-2/5} + 75 = 1500 \\cdot 2^{-2/5} - 725$。\n\n**第二部分：基于物理模型的预测**\n在验证过程中，衰变常数 $\\lambda$ 已确定为 $\\lambda = \\frac{2\\ln(2)}{5}$。我们用它来预测真实的活度 $A(3)$：\n$A(3) = A(0)\\exp(-3\\lambda) = 1000\\exp(-3 \\cdot \\frac{2\\ln(2)}{5}) = 1000\\exp(-\\frac{6}{5}\\ln(2))$。\n使用恒等式 $\\exp(c \\ln a) = a^c$：\n$A(3) = 1000 \\cdot 2^{-6/5}$。\n\n**第三部分：插值误差界的推导**\n多项式插值的误差由 $A(t) - p_n(t) = \\frac{A^{(n+1)}(\\xi)}{(n+1)!} \\prod_{i=0}^{n} (t-t_i)$ 给出，其中 $\\xi$ 位于包含节点和 $t$ 的区间内。对于我们的二次情况（$n=2$），在 $t=3$ 处的误差为：\n$A(3) - p_2(3) = \\frac{A^{(3)}(\\xi)}{3!}(3-t_0)(3-t_1)(3-t_2) = \\frac{A^{(3)}(\\xi)}{6}(3-0)(3-1)(3-5)$, for some $\\xi \\in (0,5)$.\n$A(3) - p_2(3) = \\frac{A^{(3)}(\\xi)}{6}(3)(2)(-2) = -2 A^{(3)}(\\xi)$。\n\n绝对误差为 $|A(3) - p_2(3)| = 2|A^{(3)}(\\xi)|$。\n为建立上界 $B$，我们必须找到 $|A^{(3)}(t)|$ 在区间 $[0,5]$ 上的最大值。首先，我们计算 $A(t) = A_0 \\exp(-\\lambda t)$ 的三阶导数：\n$A'(t) = -\\lambda A_0 \\exp(-\\lambda t)$\n$A''(t) = \\lambda^2 A_0 \\exp(-\\lambda t)$\n$A'''(t) = -\\lambda^3 A_0 \\exp(-\\lambda t)$。\n所以，$|A'''(t)| = \\lambda^3 A_0 \\exp(-\\lambda t)$。由于 $\\lambda0$，该函数对于 $t \\ge 0$ 是单调递减的。它在 $[0,5]$ 上的最大值出现在 $t=0$ 处：\n$\\max_{t \\in [0,5]} |A'''(t)| = |A'''(0)| = \\lambda^3 A_0 \\exp(0) = \\lambda^3 A_0$。\n\n因此，误差大小的一个上界 $B$ 为：\n$|A(3) - p_2(3)| \\leq 2 \\max_{\\xi \\in [0,5]} |A^{(3)}(\\xi)| = 2 \\lambda^3 A_0$。\n代入 $A_0 = 1000$ 和 $\\lambda = \\frac{2\\ln(2)}{5}$：\n$B = 2 \\left(\\frac{2\\ln(2)}{5}\\right)^3 (1000) = 2 \\cdot \\frac{8(\\ln(2))^3}{125} \\cdot 1000 = \\frac{16(\\ln(2))^3}{125} \\cdot (1000) = 16(\\ln(2))^3 \\cdot 8 = 128(\\ln(2))^3$。\n\n**第四部分：绝对差异的计算**\n最后，我们计算 $|p_2(3) - A(3)|$ 的数值：\n$|p_2(3) - A(3)| = |(1500 \\cdot 2^{-2/5} - 725) - (1000 \\cdot 2^{-6/5})|$。\n使用数值计算：\n$2^{-2/5} = 2^{-0.4} \\approx 0.75785828$\n$2^{-6/5} = 2^{-1.2} \\approx 0.43527530$\n\n$p_2(3) \\approx 1500(0.75785828) - 725 = 1136.78742 - 725 = 411.78742$。\n$A(3) \\approx 1000(0.43527530) = 435.27530$。\n\n绝对差异为：\n$|411.78742 - 435.27530| = |-23.48788| \\approx 23.48788$。\n四舍五入到四位有效数字得到 $23.49$。",
            "answer": "$$\\boxed{23.49}$$"
        },
        {
            "introduction": "上一个练习展示了如何估计误差，但我们能否更巧妙地进行近似呢？这个问题将引导你探索插值理论中一个更深刻的方面：插值误差的结构。你将发现，插值误差并非随机分布，其形式与插值节点的选取密切相关。通过这个练习，你将揭示插值误差项与著名的切比雪夫多项式之间的联系，初步窥见为何某些节点布局在抑制误差方面表现更优 。",
            "id": "2404709",
            "problem": "设 $x_{1}, x_{2}, \\dots, x_{10}$ 是区间 $(-1,1)$ 内的 $10$ 个不同节点，其定义为 $10$ 次第一类切比雪夫多项式的零点，其中 $T_{10}(x)$ 定义为 $T_{10}(x) = \\cos(10\\,\\arccos(x))$。考虑函数 $f(x) = \\exp(x)$ 和 $g(x) = f(x) + \\alpha \\prod_{k=1}^{10} (x - x_{k})$，其中 $\\alpha$ 是一个实常数。\n\n仅使用多项式插值的基本性质和上面给出的 $T_{10}(x)$ 的定义，证明在节点 $\\{x_{k}\\}_{k=1}^{10}$ 处，$f(x)$ 和 $g(x)$ 具有相同的唯一的 $9$ 次插值多项式。然后确定 $\\alpha$ 的唯一正值，使得\n$$\\max_{x \\in [-1,1]} |g(x) - f(x)| = \\frac{1}{8}.$$\n\n将 $\\alpha$ 的值作为你的最终答案。无需四舍五入。",
            "solution": "首先必须验证问题陈述的科学性、适定性和客观性。\n\n**步骤1：提取已知条件**\n- 节点：$x_{1}, x_{2}, \\dots, x_{10}$ 是区间 $(-1,1)$ 内的 $10$ 个不同节点。\n- 节点定义：节点 $\\{x_k\\}_{k=1}^{10}$ 是 $10$ 次第一类切比雪夫多项式 $T_{10}(x)$ 的零点。\n- 切比雪夫多项式定义：$T_{10}(x) = \\cos(10 \\arccos(x))$。\n- 函数定义：$f(x) = \\exp(x)$ 和 $g(x) = f(x) + \\alpha \\prod_{k=1}^{10} (x - x_{k})$，其中 $\\alpha$ 是一个实常数。\n- 条件：必须确定 $\\alpha$ 的唯一正值，使得 $\\max_{x \\in [-1,1]} |g(x) - f(x)| = \\frac{1}{8}$。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题属于计算工程领域，具体涉及插值理论。\n1.  **科学或事实不健全性**：该问题建立在多项式插值和切比雪夫多项式的标准定义和性质之上。所定义的函数是标准的初等函数。没有违反数学逻辑或科学原理的地方。\n2.  **非形式化或不相关**：该问题是一个形式化的数学练习，与插值和逼近理论的主题直接相关。\n3.  **不完整或矛盾的设置**：该问题是自洽的。所有必要的信息都已提供。\n4.  **不切实际或不可行**：这些条件在数学上是合理的，不代表任何物理或科学上的不可能性。\n5.  **不适定或结构不良**：对于给定数量的不同点，给定次数的插值多项式的存在性和唯一性是数值分析的一个基本定理。各项术语定义明确。\n6.  **超出科学可验证性**：其主张和结果可以通过直接的数学推导来验证。\n\n**步骤3：结论与行动**\n该问题被认定为有效。将提供解答。\n\n该问题包含两部分。首先，我们必须证明在指定节点处，$f(x)$ 和 $g(x)$ 共享相同的唯一的 $9$ 次插值多项式。其次，我们必须确定正常数 $\\alpha$。\n\n令 $P_{9}(x)$ 表示在 $10$ 个不同节点 $\\{x_k\\}_{k=1}^{10}$ 上对一个函数进行插值的唯一的次数至多为 $9$ 的多项式。\n对于函数 $f(x)$，其插值多项式，我们称之为 $P_{f}(x)$，必须满足以下条件：\n$$P_{f}(x_k) = f(x_k) \\quad \\text{for } k = 1, 2, \\dots, 10.$$\n对于函数 $g(x)$，其插值多项式，我们称之为 $P_{g}(x)$，必须满足以下条件：\n$$P_{g}(x_k) = g(x_k) \\quad \\text{for } k = 1, 2, \\dots, 10.$$\n函数 $g(x)$ 定义为 $g(x) = f(x) + \\alpha \\prod_{j=1}^{10} (x - x_{j})$。让我们在每个插值节点 $x_k$ 处计算 $g(x)$ 的值：\n$$g(x_k) = f(x_k) + \\alpha \\prod_{j=1}^{10} (x_k - x_{j}).$$\n当索引 $j$ 等于 $k$ 时，连乘项 $\\prod_{j=1}^{10} (x_k - x_{j})$ 包含因子 $(x_k - x_k)$。该因子等于 $0$。因此，整个连乘积为零。\n因此，对于每个节点 $x_k$：\n$$g(x_k) = f(x_k) + \\alpha \\cdot 0 = f(x_k).$$\n这表明，在这 $10$ 个不同的插值节点上，函数 $f(x)$ 和 $g(x)$ 的值相同。因此，它们各自的插值多项式必须满足：\n$$P_{g}(x_k) = g(x_k) = f(x_k) = P_{f}(x_k) \\quad \\text{for } k = 1, 2, \\dots, 10.$$\n考虑差分多项式 $\\Delta(x) = P_{f}(x) - P_{g}(x)$。由于 $P_{f}(x)$ 和 $P_{g}(x)$ 都是次数至多为 $9$ 的多项式，它们的差 $\\Delta(x)$ 也是一个次数至多为 $9$ 的多项式。\n我们已经证明，对于所有 $10$ 个不同的节点 $\\{x_k\\}$，有 $\\Delta(x_k) = P_{f}(x_k) - P_{g}(x_k) = 0$。一个次数至多为 $9$ 的多项式若有 $10$ 个不同的根，则它必定是零多项式。\n因此，对所有 $x$，$\\Delta(x) = 0$，这意味着 $P_{f}(x) = P_{g}(x)$。这就完成了问题的第一部分：$f(x)$ 和 $g(x)$ 具有相同的唯一的 $9$ 次插值多项式。\n\n接下来，我们必须根据以下条件确定 $\\alpha$ 的值：\n$$\\max_{x \\in [-1,1]} |g(x) - f(x)| = \\frac{1}{8}.$$\n让我们分析这个等式的左边。根据 $g(x)$ 的定义，我们有：\n$$g(x) - f(x) = \\left( f(x) + \\alpha \\prod_{k=1}^{10} (x - x_{k}) \\right) - f(x) = \\alpha \\prod_{k=1}^{10} (x - x_{k}).$$\n该条件变为：\n$$\\max_{x \\in [-1,1]} \\left| \\alpha \\prod_{k=1}^{10} (x - x_{k}) \\right| = \\frac{1}{8}.$$\n由于 $\\alpha$ 是一个常数，我们可以将其写为：\n$$|\\alpha| \\max_{x \\in [-1,1]} \\left| \\prod_{k=1}^{10} (x - x_{k}) \\right| = \\frac{1}{8}.$$\n节点 $\\{x_k\\}_{k=1}^{10}$ 是切比雪夫多项式 $T_{10}(x)$ 的零点。多项式 $\\prod_{k=1}^{10} (x - x_{k})$ 是一个以这些点为零点的 $10$ 次首一多项式。\n$n$ 次第一类切比雪夫多项式 $T_n(x)$，当 $n \\ge 1$ 时，其首项系数为 $2^{n-1}$。对于 $n=10$，首项系数为 $2^{10-1} = 2^9$。\n因此，$T_{10}(x)$ 可以写成其因式分解形式：\n$$T_{10}(x) = 2^9 \\prod_{k=1}^{10} (x - x_{k}).$$\n由此，我们可以表示出连乘项：\n$$\\prod_{k=1}^{10} (x - x_{k}) = \\frac{T_{10}(x)}{2^9}.$$\n将此代入我们的方程，得到：\n$$|\\alpha| \\max_{x \\in [-1,1]} \\left| \\frac{T_{10}(x)}{2^9} \\right| = \\frac{1}{8}.$$\n$$|\\alpha| \\frac{1}{2^9} \\max_{x \\in [-1,1]} |T_{10}(x)| = \\frac{1}{8}.$$\n第一类切比雪夫多项式 $T_n(x) = \\cos(n \\arccos(x))$ 的一个基本性质是，它在区间 $[-1, 1]$ 上的最大绝对值为 $1$。这是因为函数 $\\cos(\\theta)$ 在 $-1$ 和 $1$ 之间振荡。\n所以，$\\max_{x \\in [-1,1]} |T_{10}(x)| = 1$。\n方程简化为：\n$$|\\alpha| \\frac{1}{2^9} \\cdot 1 = \\frac{1}{8}.$$\n$$|\\alpha| \\frac{1}{512} = \\frac{1}{8}.$$\n求解 $|\\alpha|$：\n$$|\\alpha| = \\frac{512}{8} = 64.$$\n问题要求 $\\alpha$ 的唯一正值。因此，我们选择正解。\n$$\\alpha = 64.$$\n推导至此完成。",
            "answer": "$$\\boxed{64}$$"
        },
        {
            "introduction": "现在，我们将前一个练习的理论洞见应用于计算实践中。我们将处理一个“棘手”的函数 $f(x)=|x|$，它在原点处缺乏光滑性，对标准理论提出了挑战。这项编程任务要求你使用理论上更优的切比雪夫节点来实现插值，并推导出一个严格的误差上界，然后将其与观测到的计算误差进行比较 。这个综合性练习将理论（如勒贝格常数和最佳逼近误差）与实际计算相结合，巩固从基本公式到高级计算分析的整个学习过程。",
            "id": "2404724",
            "problem": "考虑区间 $[-1,1]$ 上的函数 $f(x)=|x|$。对于整数 $n \\ge 1$，通过 $x_j=\\cos\\left(\\dfrac{j\\pi}{n}\\right)$（其中 $j=0,1,\\dots,n$）定义第二类切比雪夫节点（角度以弧度为单位）。令 $p_n$ 表示在这些节点上对 $f$ 进行插值的唯一的 $n$ 次多项式，即对所有 $j=0,1,\\dots,n$ 均有 $p_n(x_j)=f(x_j)$。您的任务是设计一个程序，该程序针对多个 $n$ 值，在一个精细网格上计算一致（最大）插值误差，并利用插值理论和逼近理论的基础结果，从第一性原理出发，计算此误差的一个严格的解析上界。\n\n您必须基于以下基础进行操作：\n- 拉格朗日插值多项式定义为在 $n+1$ 个互异节点 $\\{x_j\\}_{j=0}^n$ 上满足 $p_n(x_j)=f(x_j)$ 的唯一的次数至多为 $n$ 的多项式 $p_n$。\n- 对于一组节点 $\\{x_j\\}_{j=0}^n$，勒贝格常数 $\\Lambda_n$ 定义为在 $x\\in[-1,1]$ 上，拉格朗日基多项式在 $x$ 处取值的绝对值之和的最大值。\n- 最佳一致逼近误差 $E_n(f):=\\inf\\{\\|f-q\\|_\\infty: q \\text{ 是次数 }\\le n \\text{ 的多项式}\\}$ 的概念，以及将插值误差、勒贝格常数和最佳逼近误差联系起来的不等式（不提供任何特殊情况的简化公式）。\n- 切比雪夫多项式 $T_k(x)$ 在 $[-1,1]$ 上构成一个系统，且对所有 $x\\in[-1,1]$ 都有 $|T_k(x)|\\le 1$。\n\n您的程序必须为每个测试的 $n$ 实现以下计算步骤：\n1. 在 $[-1,1]$ 上构造切比雪夫节点 $\\{x_j\\}_{j=0}^n$ 和相应的数据值 $y_j=f(x_j)$。\n2. 构建拉格朗日插值多项式 $p_n$，并在 $[-1,1]$ 上的一个包含 $m=10001$ 个点的均匀网格上对其求值。计算在此网格 $\\mathcal{G}$ 上的观测到的最大范数插值误差 $\\max_{x\\in\\mathcal{G}} |f(x)-p_n(x)|$。\n3. 从第一性原理出发，推导并计算一个严格的解析上界 $B_n$，该上界满足 $\\|f - p_n\\|_\\infty \\le B_n$。此推导需结合：\n   - 通过将 $f$ 表示为切比雪夫级数并仅使用上述事实（包括 $|T_k(x)|\\le 1$）来界定级数尾部，从而获得的最佳一致逼近误差 $E_n(f)$ 的一个界。\n   - 一个以第二类切比雪夫节点的勒贝格常数 $\\Lambda_n$ 表示的界。\n   最终的界 $B_n$ 必须表示为一个关于 $n$ 的具体的显式公式，该公式无需任何渐近表示法即可进行数值计算，并且对所有 $n\\ge 1$ 均有效。\n4. 对每个测试的 $n$，报告观测到的误差和推导出的界。\n\n角度说明：所有角度均以弧度为单位。\n\n测试套件：\n- 使用次数 $n\\in\\{1,2,3,4,8,16\\}$。\n\n输出规格：\n- 对每个测试的 $n$，您的程序必须生成一个三元列表 $[n, e_{\\text{obs}}, B_n]$，其中 $e_{\\text{obs}}$ 是在指定网格上观测到的最大误差，而 $B_n$ 是推导出的解析上界。\n- 最终的程序输出必须是包含这些三元列表的单行列表，按测试套件中 $n$ 值的顺序排列，并以方括号括起来的逗号分隔列表形式打印（例如，$[[n_1,e_{\\text{obs},1},B_{n_1}],[n_2,e_{\\text{obs},2},B_{n_2}],\\dots]$）。所有报告的数字必须是标准浮点形式，不带任何单位。",
            "solution": "问题陈述经评估有效。它具有科学依据、提法恰当、客观且完整。这是数值分析和逼近理论中的一个标准问题。因此，我们将着手提供一个完整的解决方案。\n\n目标是计算函数 $f(x)=|x|$ 在区间 $[-1,1]$ 上，使用在第二类切比雪夫节点上插值的 $n$ 次多项式插值函数 $p_n(x)$ 所产生的观测最大插值误差，并为此误差推导和计算一个严格的解析上界。\n\n将插值误差与最佳逼近误差联系起来的基本定理由以下不等式给出：\n$$ \\|f - p_n\\|_{\\infty} \\le (1 + \\Lambda_n) E_n(f) $$\n其中 $\\| \\cdot \\|_{\\infty}$ 是在 $[-1,1]$ 上的一致范数，$p_n$ 是在给定的 $n+1$ 个节点上对函数 $f$ 进行插值的次数至多为 $n$ 的多项式，$\\Lambda_n$ 是这些节点的勒贝格常数，$E_n(f)$ 是用次数至多为 $n$ 的多项式对 $f$ 进行最佳一致逼近的误差。\n\n令 $q_n^*$ 为对 $f$ 的次数 $\\le n$ 的最佳逼近多项式，因此 $\\|f - q_n^*\\|_{\\infty} = E_n(f)$。由于 $p_n$ 在节点 $\\{x_j\\}_{j=0}^n$ 上对 $f$ 进行插值，我们有 $p_n(x_j) = f(x_j)$。多项式 $p_n - q_n^*$ 的次数至多为 $n$，并且在节点 $\\{x_j\\}$ 处对函数 $f - q_n^*$ 进行插值。根据拉格朗日插值算子 $L_n$ 的定义，我们可以写出 $p_n - q_n^* = L_n(f - q_n^*)$。取其一致范数，我们得到：\n$$ \\|p_n - q_n^*\\|_{\\infty} = \\|L_n(f - q_n^*)\\|_{\\infty} \\le \\|L_n\\| \\|f - q_n^*\\|_{\\infty} = \\Lambda_n E_n(f) $$\n使用三角不等式，总误差的界为：\n$$ \\|f - p_n\\|_{\\infty} = \\|f - q_n^* - (p_n - q_n^*)\\|_{\\infty} \\le \\|f - q_n^*\\|_{\\infty} + \\|p_n - q_n^*\\|_{\\infty} \\le E_n(f) + \\Lambda_n E_n(f) = (1+\\Lambda_n)E_n(f) $$\n我们的解析误差上界 $B_n$ 将是 $(1 + \\Lambda_n)$ 和 $E_n(f)$ 的上界之积。\n\n**1. 勒贝格常数 $\\Lambda_n$ 的界**\n对于第二类切比雪夫节点 $x_j = \\cos\\left(\\frac{j\\pi}{n}\\right)$（其中 $j=0, 1, \\dots, n$），勒贝格常数 $\\Lambda_n$ 的一个紧密且公认的上界是（例如，参见 T.J. Rivlin 的著作《The Chebyshev Polynomials》）：\n$$ \\Lambda_n \\le \\frac{2}{\\pi} \\ln(n+1) + 1 $$\n该界对所有 $n \\ge 1$ 均有效。我们将在最终公式中使用这个界。\n\n**2. 对 $f(x)=|x|$ 的最佳逼近误差 $E_n(f)$ 的界**\n为了界定 $E_n(f)$，我们利用 $f(x)=|x|$ 的切比雪夫级数展开。由于 $f(x)$ 是 $[-1,1]$ 上的偶函数，其切比雪夫展开仅包含偶数索引的切比雪夫多项式 $T_{2k}(x)$：\n$$ |x| = \\frac{c_0}{2} + \\sum_{k=1}^{\\infty} c_{2k} T_{2k}(x) $$\n系数 $c_k$ 由公式 $c_k = \\frac{2}{\\pi} \\int_{-1}^{1} \\frac{f(x)T_k(x)}{\\sqrt{1-x^2}} dx$ 给出。\n对于奇数 $k$，被积函数 $|x|T_k(x)$ 是奇函数，所以 $c_k = 0$。\n对于 $k=0$，$T_0(x)=1$：\n$$ c_0 = \\frac{4}{\\pi} \\int_0^1 \\frac{x}{\\sqrt{1-x^2}} dx = \\frac{4}{\\pi} [-\\sqrt{1-x^2}]_0^1 = \\frac{4}{\\pi} $$\n对于偶数索引 $k=2m$（其中 $m \\ge 1$），我们进行替换 $x=\\cos\\theta$：\n$$ c_{2m} = \\frac{4}{\\pi} \\int_0^{\\pi/2} \\cos\\theta \\cos(2m\\theta) d\\theta = \\frac{2}{\\pi} \\int_0^{\\pi/2} (\\cos((2m-1)\\theta) + \\cos((2m+1)\\theta)) d\\theta $$\n$$ c_{2m} = \\frac{2}{\\pi} \\left[ \\frac{\\sin((2m-1)\\theta)}{2m-1} + \\frac{\\sin((2m+1)\\theta)}{2m+1} \\right]_0^{\\pi/2} $$\n$$ c_{2m} = \\frac{2}{\\pi} \\left( \\frac{\\sin(m\\pi - \\pi/2)}{2m-1} + \\frac{\\sin(m\\pi + \\pi/2)}{2m+1} \\right) = \\frac{2}{\\pi} \\left( \\frac{(-1)^{m+1}}{2m-1} + \\frac{(-1)^m}{2m+1} \\right) $$\n$$ c_{2m} = \\frac{2}{\\pi}(-1)^{m+1} \\left( \\frac{1}{2m-1} - \\frac{1}{2m+1} \\right) = \\frac{2}{\\pi}(-1)^{m+1} \\frac{2}{4m^2-1} = \\frac{4(-1)^{m+1}}{\\pi(4m^2-1)} $$\n最佳逼近误差 $E_n(f)$ 受截断切比雪夫级数 $S_n(x) = \\frac{c_0}{2} + \\sum_{k=1}^n c_k T_k(x)$ 的误差所界定。\n$$ E_n(f) \\le \\|f - S_n\\|_{\\infty} = \\left\\|\\sum_{k=n+1}^{\\infty} c_k T_k(x)\\right\\|_{\\infty} \\le \\sum_{k=n+1}^{\\infty} |c_k| $$\n由于对于奇数 $k$，$c_k=0$，所以该和是关于偶数索引 $2m \\ge n+1$ 的。设 $M$ 是满足 $2m \\ge n+1$ 的最小整数 $m$，即 $M = \\lceil (n+1)/2 \\rceil$。\n$$ E_n(f) \\le \\sum_{m=M}^{\\infty} |c_{2m}| = \\sum_{m=M}^{\\infty} \\frac{4}{\\pi(4m^2-1)} = \\frac{4}{\\pi} \\sum_{m=M}^{\\infty} \\frac{1}{(2m-1)(2m+1)} $$\n使用部分分式分解 $\\frac{1}{(2m-1)(2m+1)} = \\frac{1}{2}\\left(\\frac{1}{2m-1} - \\frac{1}{2m+1}\\right)$，该和成为一个伸缩级数：\n$$ \\sum_{m=M}^{\\infty} \\frac{1}{2}\\left(\\frac{1}{2m-1} - \\frac{1}{2m+1}\\right) = \\frac{1}{2} \\frac{1}{2M-1} $$\n因此，最佳逼近误差的界为：\n$$ E_n(f) \\le \\frac{4}{\\pi} \\cdot \\frac{1}{2(2M-1)} = \\frac{2}{\\pi(2\\lceil (n+1)/2 \\rceil - 1)} $$\n如果 $n$ 是偶数，$n=2k$，则 $M=\\lceil(2k+1)/2\\rceil = k+1$。界为 $\\frac{2}{\\pi(2(k+1)-1)} = \\frac{2}{\\pi(2k+1)} = \\frac{2}{\\pi(n+1)}$。\n如果 $n$ 是奇数，$n=2k-1$，则 $M=\\lceil(2k)/2\\rceil = k$。界为 $\\frac{2}{\\pi(2k-1)} = \\frac{2}{\\pi n}$。\n一个涵盖两种情况的统一公式是 $E_n(f) \\le \\frac{2}{\\pi(n + 1 - (n \\pmod 2))}$，该公式对所有 $n \\ge 1$ 均有效。\n\n**3. 最终解析误差上界 $B_n$**\n结合 $\\Lambda_n$ 和 $E_n(f)$ 的界，我们构建了总体误差上界 $B_n$：\n$$ B_n = \\left(1 + \\Lambda_n^{\\text{bound}}\\right) E_n(f)^{\\text{bound}} = \\left(1 + \\left(\\frac{2}{\\pi} \\ln(n+1) + 1\\right)\\right) \\left(\\frac{2}{\\pi(n + 1 - (n \\pmod 2))}\\right) $$\n$$ B_n = \\left(2 + \\frac{2}{\\pi} \\ln(n+1)\\right) \\frac{2}{\\pi(n + 1 - (n \\pmod 2))} $$\n这是我们最终的、显式的、可计算的插值误差上界公式。\n\n**4. 计算步骤**\n对每个给定的次数 $n$，执行以下步骤：\n1. 生成 $n+1$ 个第二类切比雪夫节点 $x_j$ 和相应的函数值 $y_j=|x_j|$。\n2. 构建拉格朗日插值多项式 $p_n(x)$。为了实现稳定高效的求值，我们使用重心插值公式。`scipy.interpolate.BarycentricInterpolator` 函数适用于此目的。\n3. 在 $[-1,1]$ 上创建一个包含 $m=10001$ 个点的精细均匀网格 $\\mathcal{G}$。\n4. 在网格 $\\mathcal{G}$ 上对多项式 $p_n(x)$ 和函数 $f(x)=|x|$ 求值。计算观测到的最大误差为 $e_{\\text{obs}} = \\max_{x \\in \\mathcal{G}} |f(x) - p_n(x)|$。\n5. 使用上面推导的公式计算解析上界 $B_n$。\n为每个测试用例收集结果 $[n, e_{\\text{obs}}, B_n]$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.interpolate import BarycentricInterpolator\n\ndef solve():\n    \"\"\"\n    Computes the interpolation error for f(x)=|x| using Chebyshev nodes\n    and calculates a rigorous analytic error bound.\n    \"\"\"\n\n    test_cases = [1, 2, 3, 4, 8, 16]\n    m_grid = 10001\n    x_grid = np.linspace(-1.0, 1.0, m_grid)\n    f_grid = np.abs(x_grid)\n\n    results = []\n\n    for n in test_cases:\n        # Step 1: Construct Chebyshev nodes and data values\n        # Chebyshev nodes of the second kind (extrema of T_n)\n        j = np.arange(n + 1)\n        x_nodes = np.cos(j * np.pi / n)\n        y_nodes = np.abs(x_nodes)\n\n        # Step 2: Build and evaluate the Lagrange interpolant\n        # Scipy's BarycentricInterpolator is a robust implementation of Lagrange interpolation\n        poly = BarycentricInterpolator(x_nodes, y_nodes)\n        pn_grid = poly(x_grid)\n\n        # Compute the observed maximum-norm interpolation error\n        observed_error = np.max(np.abs(f_grid - pn_grid))\n\n        # Step 3: Compute the rigorous analytic upper bound B_n\n        # The bound is derived from B_n = (1 + Lambda_n_bound) * E_n_bound\n        # where Lambda_n_bound is a bound for the Lebesgue constant and\n        # E_n_bound is a bound for the best approximation error.\n\n        # Bound on the Lebesgue constant for Chebyshev nodes of the 2nd kind:\n        # Lambda_n = (2/pi) * log(n+1) + 1 for n>=1\n        lambda_n_bound = (2 / np.pi) * np.log(n + 1) + 1\n\n        # Bound on the best uniform approximation error E_n(f) for f(x)=|x|\n        # E_n(f) = 2 / (pi * (n + 1 - (n mod 2))) for n >= 1\n        e_n_bound = (2 / np.pi) / (n + 1 - (n % 2))\n\n        # Combine bounds to get the final analytic bound B_n\n        # B_n = (1 + Lambda_n_bound) * E_n(f)_bound\n        analytic_bound = (1 + lambda_n_bound) * e_n_bound\n\n        # Step 4: Report the results\n        results.append([n, observed_error, analytic_bound])\n\n    # Final print statement in the exact required format.\n    # e.g., [[1,0.5,1.27],[2,0.2...]]\n    list_of_strings = []\n    for res in results:\n        list_of_strings.append(f\"[{res[0]},{res[1]},{res[2]}]\")\n    final_output = f\"[{','.join(list_of_strings)}]\"\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}