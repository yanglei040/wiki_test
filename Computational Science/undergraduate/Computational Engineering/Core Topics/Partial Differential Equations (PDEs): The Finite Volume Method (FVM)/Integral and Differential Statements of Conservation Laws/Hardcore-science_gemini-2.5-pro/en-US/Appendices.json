{
    "hands_on_practices": [
        {
            "introduction": "This exercise grounds the integral form of the conservation law in a concrete, steady-state diffusion problem. By applying the principle that flux must be constant in a one-dimensional system at steady state, you will derive a powerful analogy between diffusion and electrical circuits. This \"resistance-in-series\" model, where concentration differences act as potentials and material properties define resistances, is a crucial problem-solving tool in transport phenomena and chemical engineering. ",
            "id": "2404179",
            "problem": "A solute diffuses in a long, straight channel of constant cross-sectional area. Let the axial coordinate be $x$, with the left boundary at $x=-L_1$ and the right boundary at $x=+L_2$, where $L_10$ and $L_20$. The region $-L_1 \\le x  0$ is filled with a medium of constant diffusivity $D_10$, and the region $0  x \\le L_2$ is filled with a different medium of constant diffusivity $D_20$. At $x=0$ there is an idealized semi-permeable membrane of negligible thickness whose normal molar flux per unit area is linearly proportional to the concentration jump across it. Specifically, if $c(0^-)$ and $c(0^+)$ denote the limiting concentrations approaching the membrane from the left and right, respectively, then the membrane flux law is\n$$\nJ = P\\big(c(0^-) - c(0^+)\\big),\n$$\nwith membrane permeability $P0$. There are no volumetric sources or sinks of solute, and the system is at steady state. The boundary concentrations are fixed at $c(-L_1)=c_1$ and $c(L_2)=c_2$, where $c_1$ and $c_2$ are given constants.\n\nAssume one-dimensional transport, conservation of mass, and Fickâ€™s law of diffusion within each homogeneous region. Define the positive direction for flux to be from left to right. Determine a closed-form symbolic expression for the steady-state molar flux per unit area $J$ in terms of $c_1$, $c_2$, $L_1$, $L_2$, $D_1$, $D_2$, and $P$. Provide your answer as a single analytic expression for $J$ without substituting numerical values and do not include units in your final expression.",
            "solution": "The problem statement must first undergo a rigorous validation process to ensure it is scientifically sound, well-posed, and objective.\n\nStep 1: Extract Givens\nThe following information is provided in the problem statement:\n- Domain: A one-dimensional channel along coordinate $x$, from $x=-L_1$ to $x=+L_2$, where $L_10$ and $L_20$.\n- Region 1: $-L_1 \\le x  0$, with constant diffusivity $D_10$.\n- Region 2: $0  x \\le L_2$, with constant diffusivity $D_20$.\n- Interface at $x=0$: A semi-permeable membrane of negligible thickness.\n- Membrane Flux Law: The molar flux per unit area across the membrane is $J = P\\big(c(0^-) - c(0^+)\\big)$, where $P0$ is the membrane permeability, and $c(0^-)$ and $c(0^+)$ are the limiting concentrations from the left and right of the membrane, respectively.\n- Volumetric Sources/Sinks: None.\n- System State: Steady state.\n- Boundary Conditions: Fixed concentrations $c(-L_1)=c_1$ and $c(L_2)=c_2$.\n- Governing Physics: One-dimensional transport, conservation of mass, and Fick's law of diffusion within each homogeneous region.\n- Objective: Determine a closed-form symbolic expression for the steady-state molar flux per unit area, $J$.\n\nStep 2: Validate Using Extracted Givens\nThe problem is evaluated against the required criteria:\n- **Scientifically Grounded**: The problem is based on the fundamental principles of mass transport, specifically Fickian diffusion and the concept of mass conservation. The use of a semi-permeable membrane with a defined permeability is a standard and physically realistic construct in transport phenomena and chemical engineering. The setup is a classic one-dimensional, steady-state diffusion problem.\n- **Well-Posed**: The problem is well-posed. It describes a second-order ordinary differential equation (the diffusion equation at steady state) in two separate domains. To find a unique solution, four conditions are required. The problem provides two external boundary conditions ($c(-L_1)=c_1$ and $c(L_2)=c_2$) and two interface conditions at $x=0$ (the membrane flux law and the continuity of flux). This is a sufficient set of conditions to determine the constants of integration and the unknown flux, leading to a unique and stable solution.\n- **Objective**: The problem is stated in precise, quantitative, and unambiguous language. All parameters ($L_1$, $L_2$, $D_1$, $D_2$, $P$, $c_1$, $c_2$) are clearly defined.\n\nThe problem does not violate any of the invalidity criteria. It is scientifically sound, fully formalizable, internally consistent, physically plausible, and well-structured.\n\nStep 3: Verdict and Action\nThe problem is valid. A solution will be derived.\n\nThe fundamental principle is the conservation of mass. For a one-dimensional system at steady state with no volumetric sources or sinks, the differential form of the mass conservation law is:\n$$\n\\frac{dJ}{dx} = 0\n$$\nThis equation implies that the molar flux per unit area, $J$, is constant throughout the entire domain, from $x = -L_1$ to $x = L_2$.\n\nWithin each homogeneous region, the flux is described by Fick's first law of diffusion.\nFor Region 1 ($-L_1 \\le x  0$):\n$$\nJ = -D_1 \\frac{dc}{dx}\n$$\nFor Region 2 ($0  x \\le L_2$):\n$$\nJ = -D_2 \\frac{dc}{dx}\n$$\nSince $J$, $D_1$, and $D_2$ are constants, the concentration gradient $\\frac{dc}{dx}$ is also constant within each region. The concentration profiles $c(x)$ are therefore linear in each region. Integrating the equations for a constant flux $J$ yields:\nFor Region 1: $c(x) = -\\frac{J}{D_1}x + A_1$\nFor Region 2: $c(x) = -\\frac{J}{D_2}x + A_2$\nwhere $A_1$ and $A_2$ are constants of integration.\n\nWe use the given boundary and interface conditions to determine the unknowns $A_1$, $A_2$, and the flux $J$.\nThe boundary conditions at the outer edges are:\n1. $c(-L_1) = c_1 \\implies c_1 = -\\frac{J}{D_1}(-L_1) + A_1 = \\frac{JL_1}{D_1} + A_1$\n2. $c(L_2) = c_2 \\implies c_2 = -\\frac{J}{D_2}(L_2) + A_2 = -\\frac{JL_2}{D_2} + A_2$\n\nFrom these two equations, we can express the integration constants in terms of the flux $J$:\nFrom (1): $A_1 = c_1 - \\frac{JL_1}{D_1}$\nFrom (2): $A_2 = c_2 + \\frac{JL_2}{D_2}$\n\nThe concentrations at the interface $x=0$ are found by taking the limits of the concentration profiles:\n$c(0^-) = \\lim_{x \\to 0^-} c(x) = A_1$\n$c(0^+) = \\lim_{x \\to 0^+} c(x) = A_2$\n\nWe now use the third condition, the membrane flux law, which relates the flux to the concentration jump across the membrane:\n3. $J = P\\big(c(0^-) - c(0^+)\\big) = P(A_1 - A_2)$\n\nSubstitute the expressions for $A_1$ and $A_2$ into this equation:\n$$\nJ = P \\left[ \\left(c_1 - \\frac{JL_1}{D_1}\\right) - \\left(c_2 + \\frac{JL_2}{D_2}\\right) \\right]\n$$\nWe now solve this algebraic equation for $J$.\n$$\nJ = P(c_1 - c_2) - P\\frac{JL_1}{D_1} - P\\frac{JL_2}{D_2}\n$$\nGroup all terms containing $J$ on the left-hand side:\n$$\nJ + \\frac{PJL_1}{D_1} + \\frac{PJL_2}{D_2} = P(c_1 - c_2)\n$$\nFactor out $J$:\n$$\nJ \\left( 1 + \\frac{PL_1}{D_1} + \\frac{PL_2}{D_2} \\right) = P(c_1 - c_2)\n$$\nIsolating $J$ yields the expression:\n$$\nJ = \\frac{P(c_1 - c_2)}{1 + \\frac{PL_1}{D_1} + \\frac{PL_2}{D_2}}\n$$\nThis expression is correct. For a more physically insightful representation, we can divide the numerator and denominator by the permeability $P$:\n$$\nJ = \\frac{c_1 - c_2}{\\frac{1}{P} + \\frac{L_1}{D_1} + \\frac{L_2}{D_2}}\n$$\nThis form shows an analogy to Ohm's law, where the flux $J$ (current) is driven by a potential difference ($c_1 - c_2$) and is inversely proportional to the total resistance. The total resistance is the sum of the resistances of the three components in series: the diffusive resistance of medium 1 ($\\frac{L_1}{D_1}$), the diffusive resistance of medium 2 ($\\frac{L_2}{D_2}$), and the resistance of the membrane ($\\frac{1}{P}$). This is the final expression.",
            "answer": "$$\n\\boxed{\\frac{c_1 - c_2}{\\frac{L_1}{D_1} + \\frac{L_2}{D_2} + \\frac{1}{P}}}\n$$"
        },
        {
            "introduction": "This practice explores the fundamental field generated by a point source, a concept central to many areas of physics and engineering. It demonstrates the unique power of the integral form of the conservation law, which gracefully handles singularities like the Dirac delta function where the differential form can be ambiguous. Determining this fundamental solution, or Green's function, is a key skill, as it describes the system's elementary response to a perfectly localized input. ",
            "id": "2404130",
            "problem": "A scalar concentration field $c(\\vec{x})$ diffuses in an unbounded, quiescent three-dimensional medium with constant diffusivity $D$. A steady point source of strength $S_{0}$ is located at position $\\vec{x}_{0}$, modeled by the Dirac delta function as $S(\\vec{x}) = S_{0}\\,\\delta(\\vec{x}-\\vec{x}_{0})$. The steady conservation of mass for $c(\\vec{x})$ is expressed in integral form for any bounded control volume $V$ with outward unit normal $\\vec{n}$ on its boundary $\\partial V$ as\n$$\n\\int_{\\partial V} \\left(-D\\,\\nabla c\\right)\\cdot \\vec{n}\\, \\mathrm{d}A \\;=\\; \\int_{V} S(\\vec{x})\\, \\mathrm{d}V,\n$$\nand in differential form (in the sense of distributions) as\n$$\n- D\\,\\nabla^{2} c \\;=\\; S(\\vec{x}).\n$$\nAway from the source location $\\vec{x}_{0}$, the field satisfies $\\nabla^{2} c = 0$ and decays to zero at spatial infinity. It is known that the unique spherically symmetric solution about $\\vec{x}_{0}$ that decays at infinity has the form $c(\\vec{x}) = A/r$ for $r = \\|\\vec{x}-\\vec{x}_{0}\\|  0$, where $A$ is a constant.\n\nDetermine the constant $A$ in terms of $S_{0}$ and $D$ such that the solution is consistent with both the integral and differential statements of conservation. Express your final answer as a closed-form analytic expression. No numerical approximation is required.",
            "solution": "The problem statement is assessed and found to be valid. It is a well-posed problem in mathematical physics, specifically concerning the fundamental solution (or Green's function) for the Laplacian operator in three dimensions, which is a cornerstone of potential theory and transport phenomena. The problem is scientifically grounded, self-contained, and uses precise mathematical language. We proceed with the solution.\n\nThe objective is to determine the constant $A$ in the proposed solution $c(\\vec{x}) = A/r$, where $r = \\|\\vec{x}-\\vec{x}_{0}\\|$, such that it satisfies the steady conservation of mass for a scalar concentration $c(\\vec{x})$ in the presence of a point source $S(\\vec{x}) = S_{0}\\,\\delta(\\vec{x}-\\vec{x}_{0})$. We will use the integral form of the conservation law, as it naturally handles the singularity of the point source.\n\nThe integral conservation law is given for an arbitrary control volume $V$ as:\n$$\n\\int_{\\partial V} \\left(-D\\,\\nabla c\\right)\\cdot \\vec{n}\\, \\mathrm{d}A \\;=\\; \\int_{V} S(\\vec{x})\\, \\mathrm{d}V\n$$\nLet us choose a convenient control volume. Due to the spherical symmetry of the solution form about the source at $\\vec{x}_{0}$, we select $V$ to be a sphere of an arbitrary radius $R  0$ centered at $\\vec{x}_{0}$. The boundary of this sphere is $\\partial V$.\n\nFirst, we evaluate the right-hand side (RHS) of the equation, which represents the total source strength within the volume $V$.\n$$\n\\text{RHS} = \\int_{V} S(\\vec{x})\\, \\mathrm{d}V = \\int_{V} S_{0}\\,\\delta(\\vec{x}-\\vec{x}_{0})\\, \\mathrm{d}V\n$$\nBy the sifting property of the Dirac delta function, this integral evaluates to $S_{0}$ because the point $\\vec{x}_{0}$ is contained within any sphere $V$ of radius $R0$ centered at $\\vec{x}_{0}$.\n$$\n\\text{RHS} = S_{0}\n$$\n\nNext, we evaluate the left-hand side (LHS) of the equation, which represents the total flux of the scalar quantity out of the control volume.\n$$\n\\text{LHS} = \\int_{\\partial V} \\left(-D\\,\\nabla c\\right)\\cdot \\vec{n}\\, \\mathrm{d}A\n$$\nThe quantity $\\vec{J} = -D\\,\\nabla c$ is the diffusive flux vector. We must first compute the gradient of the concentration field $c(\\vec{x}) = A/r$. It is most convenient to work in a spherical coordinate system centered at $\\vec{x}_{0}$, where $r$ is the radial coordinate. The gradient of a spherically symmetric function $f(r)$ is given by $\\nabla f(r) = \\frac{\\mathrm{d}f}{\\mathrm{d}r}\\hat{e}_{r}$, where $\\hat{e}_{r}$ is the unit vector in the radial direction.\nFor $c(r) = A/r = Ar^{-1}$, the derivative with respect to $r$ is:\n$$\n\\frac{\\mathrm{d}c}{\\mathrm{d}r} = -A r^{-2} = -\\frac{A}{r^{2}}\n$$\nThus, the gradient of the concentration field is:\n$$\n\\nabla c = -\\frac{A}{r^{2}}\\hat{e}_{r}\n$$\nThe diffusive flux vector is then:\n$$\n\\vec{J} = -D\\,\\nabla c = -D \\left(-\\frac{A}{r^{2}}\\hat{e}_{r}\\right) = \\frac{DA}{r^{2}}\\hat{e}_{r}\n$$\nOn the boundary of our control volume $\\partial V$, which is a sphere of radius $r=R$, the outward unit normal vector $\\vec{n}$ is identical to the radial unit vector $\\hat{e}_{r}$. Therefore, the dot product in the integrand becomes:\n$$\n\\vec{J} \\cdot \\vec{n} = \\left(\\frac{DA}{r^{2}}\\hat{e}_{r}\\right) \\cdot \\hat{e}_{r} = \\frac{DA}{r^{2}}\n$$\nOn the surface $\\partial V$, we have $r=R$, so the integrand is constant over the entire surface:\n$$\n\\left.\\left(\\vec{J} \\cdot \\vec{n}\\right)\\right|_{r=R} = \\frac{DA}{R^{2}}\n$$\nNow, we can compute the surface integral for the LHS:\n$$\n\\text{LHS} = \\int_{\\partial V} \\frac{DA}{R^{2}} \\, \\mathrm{d}A = \\frac{DA}{R^{2}} \\int_{\\partial V} \\mathrm{d}A\n$$\nThe integral $\\int_{\\partial V} \\mathrm{d}A$ is the surface area of the sphere of radius $R$, which is $4\\pi R^{2}$.\n$$\n\\text{LHS} = \\frac{DA}{R^{2}} (4\\pi R^{2}) = 4\\pi DA\n$$\nThe result for the LHS is independent of the radius $R$ of the control volume, which is a necessary condition for consistency.\n\nFinally, we equate the LHS and RHS:\n$$\n4\\pi DA = S_{0}\n$$\nSolving for the constant $A$, we find:\n$$\nA = \\frac{S_{0}}{4\\pi D}\n$$\nThis result is consistent with both the integral and differential forms. For completeness, we verify this with the differential form, $-D\\,\\nabla^{2}c = S(\\vec{x})$. It is a standard result from the theory of distributions that the Laplacian of the function $1/r$ in three dimensions is $\\nabla^{2}(1/r) = -4\\pi\\delta(\\vec{x}-\\vec{x}_{0})$.\nSubstituting $c = A/r$ into the differential equation gives:\n$$\n-D\\,\\nabla^{2}\\left(\\frac{A}{r}\\right) = S_{0}\\,\\delta(\\vec{x}-\\vec{x}_{0})\n$$\n$$\n-DA\\,\\nabla^{2}\\left(\\frac{1}{r}\\right) = S_{0}\\,\\delta(\\vec{x}-\\vec{x}_{0})\n$$\n$$\n-DA(-4\\pi\\,\\delta(\\vec{x}-\\vec{x}_{0})) = S_{0}\\,\\delta(\\vec{x}-\\vec{x}_{0})\n$$\n$$\n4\\pi DA\\,\\delta(\\vec{x}-\\vec{x}_{0}) = S_{0}\\,\\delta(\\vec{x}-\\vec{x}_{0})\n$$\nFor this equality to hold, the coefficients must be equal: $4\\pi DA = S_{0}$, which yields the same expression for $A$. The solution is therefore fully consistent.",
            "answer": "$$\n\\boxed{\\frac{S_{0}}{4\\pi D}}\n$$"
        },
        {
            "introduction": "This computational exercise brings conservation laws into the practical realm of numerical simulation. It highlights the critical difference between the conservative and non-conservative forms of a PDE; while they may be analytically equivalent, their numerical discretizations are not. By implementing a non-conservative scheme, you will directly observe and quantify how it can artificially create or destroy mass, providing a compelling demonstration of why robust numerical methods must be built upon the integral statement of conservation. ",
            "id": "2404137",
            "problem": "Consider the one-dimensional scalar conservation law in conservative form on a periodic domain $[0,1]$:\n$$\\frac{\\partial \\phi}{\\partial t} + \\frac{\\partial}{\\partial x}\\left(u(x)\\,\\phi\\right) = 0,$$\nwhere $u(x)$ is a prescribed, smooth, spatially varying velocity, and $\\phi(x,t)$ is a transported scalar. For periodic boundary conditions, the integral conservation statement implies that the total amount of $\\phi$,\n$$M(t) = \\int_0^1 \\phi(x,t)\\,dx,$$\nsatisfies $\\frac{d}{dt} M(t) = 0$, so that $M(t)$ is constant in time for the exact solution.\n\nYou will analyze the artificial creation or destruction of $\\phi$ introduced by a non-conservative explicit update on a uniform grid that does not enforce flux differencing. Let the grid have $N$ points, grid spacing $\\Delta x = 1/N$, node positions $x_i = i\\,\\Delta x$ for $i\\in\\{0,1,\\dots,N-1\\}$, and periodic indexing. Let the velocity be\n$$u(x) = 1 + \\tfrac{1}{2}\\,\\sin^2(2\\pi x),$$\nwhich is strictly positive on $[0,1]$. Define the following explicit, pointwise, non-conservative update for a time step $\\Delta t$:\n$$\\phi_i^{n+1} = \\phi_i^{n} - \\frac{\\Delta t}{\\Delta x}\\,u(x_i)\\,\\left(\\phi_i^{n} - \\phi_{i-1}^{n}\\right),$$\nwith periodic indexing $\\phi_{-1}^{n} \\equiv \\phi_{N-1}^{n}$.\n\nFor each simulation, define the discrete total amount\n$$M^n = \\Delta x \\sum_{i=0}^{N-1} \\phi_i^n,$$\nand quantify the artificial creation or destruction of $\\phi$ over the simulation time as the difference\n$$\\Delta M = M^{n_{\\text{final}}} - M^{0},$$\nwhere $n_{\\text{final}} = T/\\Delta t$ is an integer number of time steps. A positive $\\Delta M$ indicates artificial creation; a negative $\\Delta M$ indicates artificial destruction.\n\nUse the periodic domain $[0,1]$ with the two initial conditions specified below:\n- Mixed smooth initial condition:\n$$\\phi_0^{\\text{mixed}}(x) = \\exp\\!\\left(-100\\,(x-0.3)^2\\right) + \\tfrac{1}{2}\\,\\sin(2\\pi x).$$\n- Constant initial condition:\n$$\\phi_0^{\\text{const}}(x) = 1.$$\n\nTest suite. For each test case, run the simulation for total time $T$ using time step $\\Delta t$ and grid size $N$ exactly as given, starting from the specified initial condition, and report $\\Delta M$:\n- Test $1$: $N=64$, $\\Delta t=0.001$, $T=0.2$, initial condition $\\phi_0^{\\text{mixed}}$.\n- Test $2$: $N=64$, $\\Delta t=0.004$, $T=0.2$, initial condition $\\phi_0^{\\text{mixed}}$.\n- Test $3$: $N=128$, $\\Delta t=0.001$, $T=1.0$, initial condition $\\phi_0^{\\text{mixed}}$.\n- Test $4$: $N=16$, $\\Delta t=0.002$, $T=0.2$, initial condition $\\phi_0^{\\text{mixed}}$.\n- Test $5$: $N=64$, $\\Delta t=0.001$, $T=0.0$, initial condition $\\phi_0^{\\text{mixed}}$.\n- Test $6$: $N=64$, $\\Delta t=0.001$, $T=0.5$, initial condition $\\phi_0^{\\text{const}}$.\n\nAll quantities are nondimensional; no physical units are required. Angles in trigonometric functions are in radians.\n\nFinal output format. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the tests above, where each entry is the floating-point value of $\\Delta M$ rounded to $12$ significant digits in scientific notation. For example, a valid output would have the form\n$$[\\text{a}_1,\\text{a}_2,\\text{a}_3,\\text{a}_4,\\text{a}_5,\\text{a}_6],$$\nwith each $\\text{a}_k$ a number like $1.23456789012\\text{e}{-03}$.",
            "solution": "The problem statement has been rigorously validated and is determined to be valid. It is scientifically grounded, well-posed, objective, and complete. It presents a standard problem in numerical analysis: the study of a discrete scheme's conservation properties for a scalar conservation law. All parameters, initial conditions, and governing equations are specified without ambiguity or contradiction. We may proceed with the solution.\n\nThe core of this problem is to analyze the non-conservative nature of the provided numerical scheme. The governing partial differential equation (PDE) is a one-dimensional scalar conservation law:\n$$\n\\frac{\\partial \\phi}{\\partial t} + \\frac{\\partial F(\\phi, x)}{\\partial x} = 0,\n$$\nwhere the flux is $F(\\phi, x) = u(x)\\phi$. An essential property of this equation on a periodic domain $[0,1]$ is the conservation of the total amount of the scalar $\\phi$, denoted by $M(t) = \\int_0^1 \\phi(x,t)\\,dx$. The time rate of change of $M(t)$ is:\n$$\n\\frac{dM(t)}{dt} = \\frac{d}{dt}\\int_0^1 \\phi(x,t)\\,dx = \\int_0^1 \\frac{\\partial \\phi}{\\partial t}\\,dx = -\\int_0^1 \\frac{\\partial F}{\\partial x}\\,dx = -[F]_0^1.\n$$\nDue to the periodic boundary conditions, $F(1, t) = F(0, t)$, which means $[F]_0^1 = 0$. Thus, $\\frac{dM(t)}{dt}=0$, and the total amount $M(t)$ is conserved for the exact solution.\n\nThe provided numerical scheme is an explicit update on a uniform grid with $N$ points $x_i = i\\Delta x$ for $i \\in \\{0, 1, \\dots, N-1\\}$:\n$$\n\\phi_i^{n+1} = \\phi_i^{n} - \\frac{\\Delta t}{\\Delta x}\\,u(x_i)\\,\\left(\\phi_i^{n} - \\phi_{i-1}^{n}\\right).\n$$\nHere, $\\phi_i^n$ is the numerical approximation of $\\phi(x_i, n\\Delta t)$, and periodic indexing $\\phi_{-1}^n \\equiv \\phi_{N-1}^n$ is used. This scheme discretizes the advective (or non-conservative) form of the PDE, $\\frac{\\partial \\phi}{\\partial t} + u(x)\\frac{\\partial \\phi}{\\partial x} = 0$, by using a first-order backward difference for the spatial derivative $\\frac{\\partial \\phi}{\\partial x}$. The correct conservative form is $\\frac{\\partial \\phi}{\\partial t} + \\frac{\\partial(u\\phi)}{\\partial x} = \\frac{\\partial \\phi}{\\partial t} + u\\frac{\\partial \\phi}{\\partial x} + \\phi\\frac{\\partial u}{\\partial x} = 0$. The scheme omits the term corresponding to $\\phi\\frac{\\partial u}{\\partial x}$, which is the source of the non-conservation when the velocity $u(x)$ is not constant.\n\nTo demonstrate this defect, we analyze the evolution of the discrete total amount, $M^n = \\Delta x \\sum_{i=0}^{N-1} \\phi_i^n$. Summing the numerical scheme over all grid points $i$ from $0$ to $N-1$ gives:\n$$\n\\sum_{i=0}^{N-1} \\phi_i^{n+1} = \\sum_{i=0}^{N-1} \\phi_i^{n} - \\frac{\\Delta t}{\\Delta x} \\sum_{i=0}^{N-1} u_i (\\phi_i^{n} - \\phi_{i-1}^{n}),\n$$\nwhere $u_i = u(x_i)$. Multiplying by $\\Delta x$ yields the relation between $M^{n+1}$ and $M^n$:\n$$\nM^{n+1} = M^n - \\Delta t \\sum_{i=0}^{N-1} u_i (\\phi_i^{n} - \\phi_{i-1}^{n}).\n$$\nThe change in total amount over one time step is $\\Delta M^{n+1} = M^{n+1} - M^n = -\\Delta t \\sum_{i=0}^{N-1} u_i (\\phi_i^{n} - \\phi_{i-1}^{n})$. For the scheme to be conservative, this sum must be zero. We can re-index the sum to analyze its structure:\n$$\n\\sum_{i=0}^{N-1} u_i (\\phi_i^{n} - \\phi_{i-1}^{n}) = \\sum_{i=0}^{N-1} u_i \\phi_i^n - \\sum_{i=0}^{N-1} u_i \\phi_{i-1}^n.\n$$\nBy re-grouping terms by $\\phi_i^n$ and using periodicity ($u_0$ and $\\phi_{N-1}^n$ terms), this becomes:\n$$\n\\sum_{i=0}^{N-1} u_i \\phi_i^n - \\sum_{i=0}^{N-1} u_{i+1} \\phi_i^n = \\sum_{i=0}^{N-1} \\phi_i^n (u_i - u_{i+1}).\n$$\nThis sum is not a telescoping sum that evaluates to zero unless $u_i$ is constant. Instead, it approximates an integral:\n$$\n\\sum_{i=0}^{N-1} \\phi_i^n (u_i - u_{i+1}) = \\sum_{i=0}^{N-1} \\phi_i^n \\left(-\\frac{u_{i+1}-u_i}{\\Delta x}\\right) \\Delta x \\approx -\\int_0^1 \\phi(x,t^n) \\frac{du}{dx} dx.\n$$\nThus, the rate of change of the discrete total mass is approximately:\n$$\n\\frac{M^{n+1} - M^n}{\\Delta t} \\approx \\int_0^1 \\phi(x,t^n) \\frac{du}{dx} dx.\n$$\nThis is non-zero in general, leading to an artificial creation or destruction of $\\phi$, which is calculated as $\\Delta M = M^{n_{\\text{final}}} - M^0$.\n\nTwo special cases in the test suite result in zero mass change, $\\Delta M = 0$:\n1.  Test $5$: $T=0$. This implies $n_{\\text{final}}=0$ time steps. The simulation does not run, so trivially $M^{n_{\\text{final}}} = M^0$ and $\\Delta M = 0$.\n2.  Test $6$: The initial condition is constant, $\\phi_0^{\\text{const}}(x) = 1$, so $\\phi_i^0 = 1$ for all $i$. The spatial difference term in the update rule is $\\phi_i^0 - \\phi_{i-1}^0 = 1 - 1 = 0$. Therefore, $\\phi_i^1 = \\phi_i^0$. By induction, $\\phi_i^n = 1$ for all steps $n$. The discrete quantity $M^n$ remains constant, and $\\Delta M = 0$. This is also consistent with our derived expression, as for a constant $\\phi_i^n = c$, the sum $\\sum_i c(u_i - u_{i+1}) = c \\sum_i (u_i - u_{i+1})$ is a telescoping sum that equals zero due to periodicity.\n\nThe algorithm to compute $\\Delta M$ for each test case is as follows:\n1.  For a given grid size $N$, define the grid spacing $\\Delta x = 1/N$ and the node positions $x_i = i\\Delta x$.\n2.  Discretize the velocity profile $u(x)$ onto the grid, yielding the array $u_i$.\n3.  Discretize the specified initial condition $\\phi_0(x)$ onto the grid to get the initial state $\\phi_i^0$.\n4.  Calculate the initial total amount $M^0 = \\Delta x \\sum_{i=0}^{N-1} \\phi_i^0$.\n5.  Determine the total number of time steps $n_{\\text{final}} = T/\\Delta t$.\n6.  Iterate from $n=0$ to $n_{\\text{final}}-1$. In each step, compute the next state $\\phi^{n+1}$ from the current state $\\phi^n$ using the vectorized update rule. The periodic shift for $\\phi_{i-1}^n$ is efficiently implemented using a circular shift operation on the array representing $\\phi^n$.\n7.  After the final time step, calculate the final total amount $M^{n_{\\text{final}}} = \\Delta x \\sum_{i=0}^{N-1} \\phi_i^{n_{\\text{final}}}$.\n8.  The result is the difference $\\Delta M = M^{n_{\\text{final}}} - M^0$.\nThis procedure will be implemented for each test case to produce the required results.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef phi0_mixed(x):\n    \"\"\"\n    Computes the mixed smooth initial condition.\n    phi(x) = exp(-100*(x-0.3)^2) + 0.5*sin(2*pi*x)\n    \"\"\"\n    return np.exp(-100.0 * (x - 0.3)**2) + 0.5 * np.sin(2.0 * np.pi * x)\n\ndef phi0_const(x):\n    \"\"\"\n    Computes the constant initial condition.\n    phi(x) = 1\n    \"\"\"\n    return np.ones_like(x)\n\ndef run_simulation(N, dt, T, ic_func):\n    \"\"\"\n    Runs one simulation case for the non-conservative scheme and returns Delta M.\n\n    Args:\n        N (int): Number of grid points.\n        dt (float): Time step size.\n        T (float): Total simulation time.\n        ic_func (function): Function to generate the initial condition.\n\n    Returns:\n        float: The artificial change in total mass, Delta M.\n    \"\"\"\n    # Handle the trivial case of T=0, where no steps are taken.\n    if T == 0.0:\n        return 0.0\n\n    # 1. Define grid and velocity\n    dx = 1.0 / N\n    x = np.arange(N) * dx\n    u = 1.0 + 0.5 * np.sin(2.0 * np.pi * x)**2\n\n    # 2. Set initial condition\n    phi = ic_func(x)\n\n    # 3. Calculate initial total mass M^0\n    M0 = dx * np.sum(phi)\n\n    # 4. Determine number of time steps\n    # The problem statement guarantees this is an integer.\n    # Using round() for robustness against floating-point representation issues.\n    n_final = int(round(T / dt))\n\n    # Handle the case where the initial condition is constant.\n    # The update term will be zero, so Delta M is zero.\n    if ic_func == phi0_const:\n        return 0.0\n\n    # 5. Time-stepping loop\n    for _ in range(n_final):\n        # phi_{i-1} with periodic boundary condition\n        phi_prev = np.roll(phi, 1)\n        \n        # Apply the explicit non-conservative update rule\n        # phi_i^{n+1} = phi_i^n - (dt/dx) * u_i * (phi_i^n - phi_{i-1}^n)\n        phi = phi - (dt / dx) * u * (phi - phi_prev)\n\n    # 6. Calculate final total mass M^n_final\n    M_final = dx * np.sum(phi)\n\n    # 7. Compute the change in total mass\n    delta_M = M_final - M0\n    \n    return delta_M\n\ndef solve():\n    \"\"\"\n    Defines and runs the test suite, then prints the formatted results.\n    \"\"\"\n    # Test suite parameters: (N, dt, T, initial_condition_function)\n    test_cases = [\n        (64, 0.001, 0.2, phi0_mixed),\n        (64, 0.004, 0.2, phi0_mixed),\n        (128, 0.001, 1.0, phi0_mixed),\n        (16, 0.002, 0.2, phi0_mixed),\n        (64, 0.001, 0.0, phi0_mixed),\n        (64, 0.001, 0.5, phi0_const),\n    ]\n\n    results = []\n    for case in test_cases:\n        N, dt, T, ic_func = case\n        result = run_simulation(N, dt, T, ic_func)\n        results.append(result)\n\n    # Format results to 12 significant digits in scientific notation\n    # and print in the specified single-line format.\n    formatted_results = [f\"{res:.11e}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}