{
    "hands_on_practices": [
        {
            "introduction": "在工程和科学计算中，我们经常遇到无法解析求解的积分。这个练习模拟了一个典型场景：需要对一个没有初等原函数的被积函数进行数值积分。通过直接比较梯形法则和辛普森法则的计算结果与高精度参考值，你将亲身体验到辛普森法则在相同计算成本下通常具有的显著精度优势 。",
            "id": "2202278",
            "problem": "一位天线工程师正在分析一个新设计设备的辐射图样。在一个简化的一维模型中，天线辐射的角功率密度 $P(\\theta)$ 由函数 $P(\\theta) = \\frac{\\sin(\\theta)}{\\theta}$（对于 $\\theta > 0$）描述，其中 $\\theta$ 是与主轴的夹角（单位为弧度），功率密度以瓦特/弧度 (W/rad) 为单位。在从 $\\theta_a = 1$ 弧度到 $\\theta_b = 2$ 弧度的角区间内辐射的总功率 $W_{total}$ 由积分 $W_{total} = \\int_{1}^{2} \\frac{\\sin(\\theta)}{\\theta} d\\theta$ 给出。\n\n由于正弦积分函数的性质，该积分没有初等闭式解。该工程师决定比较两种数值近似方法：梯形法则和辛普森1/3法则。为了进行比较，两种方法都将使用总共 $n=4$ 个子区间。\n\n从高性能计算集群获得的总功率的一个高精度参考值为 $W_{ref} = 0.65932991$ W。\n\n设 $W_T$ 是使用梯形法则对 $W_{total}$ 的近似值，$W_S$ 是使用辛普森1/3法则的近似值。每种方法的绝对误差分别由 $E_T = |W_T - W_{ref}|$ 和 $E_S = |W_S - W_{ref}|$ 给出。\n\n计算这两个误差之间的绝对差 $|E_T - E_S|$。将您的最终答案以瓦特 (W) 为单位表示，并四舍五入到三位有效数字。",
            "solution": "我们需要用复合梯形法则和辛普森1/3法则，在 $[1,2]$ 区间上取 $n=4$ 个子区间，来近似定积分\n$$\nW_{total}=\\int_{1}^{2}\\frac{\\sin(\\theta)}{\\theta}\\,d\\theta\n$$\n然后将其绝对误差与给定的参考值 $W_{ref}=0.65932991$ 进行比较。\n\n当 $n=4$ 时，均匀步长为\n$$\nh=\\frac{2-1}{4}=\\frac{1}{4}.\n$$\n节点为\n$$\n\\theta_{i}=1+ih,\\quad i=0,1,2,3,4,\n$$\n即 $\\theta_{0}=1$, $\\theta_{1}=1.25$, $\\theta_{2}=1.5$, $\\theta_{3}=1.75$, $\\theta_{4}=2$。定义 $f(\\theta)=\\frac{\\sin(\\theta)}{\\theta}$。数值计算如下：\n$$\n\\begin{aligned}\nf(\\theta_{0})=\\frac{\\sin(1)}{1}\\approx 0.8414709848078965,\\\\\nf(\\theta_{1})=\\frac{\\sin(1.25)}{1.25}\\approx \\frac{0.9489846171708334}{1.25}\\approx 0.7591876937366667,\\\\\nf(\\theta_{2})=\\frac{\\sin(1.5)}{1.5}\\approx \\frac{0.9974949866040544}{1.5}\\approx 0.6649966577360363,\\\\\nf(\\theta_{3})=\\frac{\\sin(1.75)}{1.75}\\approx \\frac{0.9839859468735364}{1.75}\\approx 0.5622776839277350,\\\\\nf(\\theta_{4})=\\frac{\\sin(2)}{2}\\approx \\frac{0.9092974268256817}{2}\\approx 0.45464871341284085.\n\\end{aligned}\n$$\n\n当 $n=4$ 时的复合梯形法则是\n$$\nW_{T}=\\frac{h}{2}\\left[f(\\theta_{0})+2\\sum_{i=1}^{3}f(\\theta_{i})+f(\\theta_{4})\\right].\n$$\n计算内部和\n$$\n\\sum_{i=1}^{3}f(\\theta_{i})=0.7591876937366667+0.6649966577360363+0.5622776839277350=1.9864620354004380,\n$$\n因此\n$$\n\\begin{aligned}\nW_{T}=\\frac{1/4}{2}\\left[0.8414709848078965+2(1.9864620354004380)+0.45464871341284085\\right]\\\\\n=\\frac{1}{8}\\left[0.8414709848078965+3.9729240708008760+0.45464871341284085\\right]\\\\\n=\\frac{1}{8}\\left[5.26904376902161335\\right]\\approx 0.6586304711277017.\n\\end{aligned}\n$$\n\n当 $n=4$ 时的复合辛普森1/3法则是\n$$\nW_{S}=\\frac{h}{3}\\left[f(\\theta_{0})+4\\big(f(\\theta_{1})+f(\\theta_{3})\\big)+2f(\\theta_{2})+f(\\theta_{4})\\right].\n$$\n计算\n$$\n\\begin{aligned}\nf(\\theta_{1})+f(\\theta_{3})=0.7591876937366667+0.5622776839277350=1.3214653776644017,\\\\\n4\\big(f(\\theta_{1})+f(\\theta_{3})\\big)=5.2858615106576068,\\\\\n2f(\\theta_{2})=1.3299933154720726,\n\\end{aligned}\n$$\n所以\n$$\n\\begin{aligned}\nW_{S}=\\frac{1/4}{3}\\left[0.8414709848078965+5.2858615106576068+1.3299933154720726+0.45464871341284085\\right]\\\\\n=\\frac{1}{12}\\left[7.91197452435041675\\right]\\approx 0.6593312103625347.\n\\end{aligned}\n$$\n\n使用 $W_{ref}=0.65932991$，绝对误差为\n$$\nE_{T}=|W_{T}-W_{ref}|=|0.6586304711277017-0.65932991|\\approx 6.994388722983\\times 10^{-4},\n$$\n$$\nE_{S}=|W_{S}-W_{ref}|=|0.6593312103625347-0.65932991|\\approx 1.3003625347\\times 10^{-6}.\n$$\n因此，所求的绝对差为\n$$\n|E_{T}-E_{S}|\\approx 6.981385097637\\times 10^{-4}.\n$$\n四舍五入到三位有效数字，结果是\n$$\n6.98\\times 10^{-4}.\n$$",
            "answer": "$$\\boxed{6.98\\times 10^{-4}}$$"
        },
        {
            "introduction": "实际问题中的函数并不总是完美无瑕的。这个练习引入了一个在工程领域（如信号处理和光学）中非常常见的函数 $\\frac{\\sin(x)}{x}$，它在原点处存在一个可去奇点。你需要先通过取极限的方式对函数进行“正则化”处理，然后才能安全地应用数值积分法则，这凸显了在编程计算前进行数学分析的重要性 。",
            "id": "2377381",
            "problem": "考虑如下看似瑕积分的积分\n$$I=\\int_{0}^{1}\\frac{\\sin(x)}{x}\\,dx,$$\n其中被积函数在 $x=0$ 处有一个可去奇点。通过在原点的连续性来定义被积函数，使其在闭区间 $[0,1]$ 上有良好定义。\n\n在 $[0,1]$ 上使用包含 $N=4$ 个子区间的均匀剖分，计算：\n- 复化梯形法则的近似值，以及\n- 复化辛普森法则的近似值，\n\n两者均应用于相同网格上的正则化被积函数。所有三角函数求值均使用弧度。仅报告复化辛普森法则的近似值作为最终结果。将答案四舍五入至 $6$ 位有效数字。最终答案是无量纲的。",
            "solution": "问题是使用数值方法来近似计算积分 $I = \\int_{0}^{1} \\frac{\\sin(x)}{x} \\, dx$。被积函数是 $f(x) = \\frac{\\sin(x)}{x}$。这个函数在 $x=0$ 处未定义，但这是一个可去奇点。我们通过取极限来定义该点的函数值：\n$$f(0) = \\lim_{x \\to 0} \\frac{\\sin(x)}{x} = 1$$\n这是微积分中的一个基本极限。因此，我们实际上是在对定义在 $[0, 1]$ 上的连续函数 $g(x)$ 进行积分：\n$$g(x) = \\begin{cases} \\frac{\\sin(x)}{x}  \\text{若 } x \\in (0, 1] \\\\ 1  \\text{若 } x = 0 \\end{cases}$$\n为简单起见，我们将 $g(x)$ 记作 $f(x)$。\n\n积分区间为 $[a, b] = [0, 1]$，子区间数量为 $N=4$。对于均匀剖分，步长 $h$ 是一个常数：\n$$h = \\frac{b-a}{N} = \\frac{1-0}{4} = 0.25$$\n网格点 $x_i = a + i \\cdot h$（其中 $i = 0, 1, 2, 3, 4$）为：\n$x_0 = 0$\n$x_1 = 0.25$\n$x_2 = 0.5$\n$x_3 = 0.75$\n$x_4 = 1.0$\n\n我们在这些网格点上计算函数 $f(x)$ 的值。所有三角函数的参数都以弧度为单位。\n$f(x_0) = f(0) = 1$\n$f(x_1) = f(0.25) = \\frac{\\sin(0.25)}{0.25} \\approx 0.98961584$\n$f(x_2) = f(0.5) = \\frac{\\sin(0.5)}{0.5} \\approx 0.95885108$\n$f(x_3) = f(0.75) = \\frac{\\sin(0.75)}{0.75} \\approx 0.90885168$\n$f(x_4) = f(1.0) = \\frac{\\sin(1.0)}{1.0} \\approx 0.84147098$\n\n首先，我们计算复化梯形法则的近似值 $I_T$。其公式为：\n$$I_T = \\frac{h}{2} \\left[ f(x_0) + 2\\sum_{i=1}^{N-1} f(x_i) + f(x_N) \\right]$$\n对于 $N=4$，公式变为：\n$$I_T = \\frac{h}{2} \\left[ f(x_0) + 2(f(x_1) + f(x_2) + f(x_3)) + f(x_4) \\right]$$\n代入数值：\n$$I_T \\approx \\frac{0.25}{2} \\left[ 1 + 2(0.98961584 + 0.95885108 + 0.90885168) + 0.84147098 \\right]$$\n$$I_T \\approx 0.125 \\left[ 1 + 2(2.85731860) + 0.84147098 \\right]$$\n$$I_T \\approx 0.125 \\left[ 1 + 5.71463720 + 0.84147098 \\right]$$\n$$I_T \\approx 0.125 \\left[ 7.55610818 \\right]$$\n$$I_T \\approx 0.94451352$$\n\n接下来，我们计算复化辛普森法则的近似值 $I_S$。区间数 $N=4$ 是偶数，这是该法则的一个要求。其公式为：\n$$I_S = \\frac{h}{3} \\left[ f(x_0) + 4\\sum_{i=1,3,...}^{N-1} f(x_i) + 2\\sum_{i=2,4,...}^{N-2} f(x_i) + f(x_N) \\right]$$\n对于 $N=4$，奇数索引的求和包括 $i=1, 3$，偶数索引的求和包括 $i=2$。公式简化为：\n$$I_S = \\frac{h}{3} \\left[ f(x_0) + 4(f(x_1) + f(x_3)) + 2f(x_2) + f(x_4) \\right]$$\n代入数值：\n$$I_S \\approx \\frac{0.25}{3} \\left[ 1 + 4(0.98961584 + 0.90885168) + 2(0.95885108) + 0.84147098 \\right]$$\n$$I_S \\approx \\frac{0.25}{3} \\left[ 1 + 4(1.89846752) + 1.91770216 + 0.84147098 \\right]$$\n$$I_S \\approx \\frac{0.25}{3} \\left[ 1 + 7.59387008 + 1.91770216 + 0.84147098 \\right]$$\n$$I_S \\approx \\frac{0.25}{3} \\left[ 11.35304322 \\right]$$\n$$I_S \\approx 0.94608693$$\n\n问题要求报告复化辛普森法则的近似值，并四舍五入至 $6$ 位有效数字。\n计算值为 $I_S \\approx 0.94608693$。前六位有效数字是 $9, 4, 6, 0, 8, 6$。第七位数字是 $9$，由于 $9 \\geq 5$，所以我们将第六位数字向上舍入。\n四舍五入后的值为 $0.946087$。",
            "answer": "$$\\boxed{0.946087}$$"
        },
        {
            "introduction": "在多次见证辛普森法则的优越性之后，我们很容易形成一个思维定式：高阶方法总是更优。这个练习旨在打破这种直觉，它提供了一个特殊构造的光滑函数，在该函数上，阶数较低的梯形法则反而给出了比辛普森法则更精确的结果。这个反直觉的例子将促使你更深入地思考误差的来源，以及采样点位置与函数行为之间的微妙关系 。",
            "id": "2377352",
            "problem": "设函数 $f(x) = \\cos\\!\\left(\\tfrac{3\\pi}{2}\\,x\\right)$ 定义在区间 $[-1,1]$ 上，其中所有三角函数参数的单位均为弧度。该函数 $f(x)$ 是光滑且非多项式的。考虑定积分 $I = \\int_{-1}^{1} f(x)\\,dx$。使用 $n=2$ 个子区间，根据标准定义计算 $I$ 的复合梯形近似值 $T_{2}$ 和复合辛普森近似值 $S_{2}$。定义绝对误差 $E_{T} = |T_{2} - I|$ 和 $E_{S} = |S_{2} - I|$。最后，计算单值 $\\Delta = E_{S} - E_{T}$。以精确值形式给出 $\\Delta$，不进行四舍五入。",
            "solution": "所考虑的函数是 $f(x) = \\cos\\left(\\frac{3\\pi}{2}x\\right)$，积分区间为 $[-1, 1]$。定积分 $I$ 由下式给出：\n$$I = \\int_{-1}^{1} \\cos\\left(\\frac{3\\pi}{2}x\\right) dx$$\n为求 $I$ 的精确值，我们计算被积函数的反导数：\n$$I = \\left[ \\frac{1}{\\frac{3\\pi}{2}} \\sin\\left(\\frac{3\\pi}{2}x\\right) \\right]_{-1}^{1} = \\left[ \\frac{2}{3\\pi} \\sin\\left(\\frac{3\\pi}{2}x\\right) \\right]_{-1}^{1}$$\n在积分上下限 $a = -1$ 和 $b = 1$ 处求值：\n$$I = \\frac{2}{3\\pi} \\left[ \\sin\\left(\\frac{3\\pi}{2}(1)\\right) - \\sin\\left(\\frac{3\\pi}{2}(-1)\\right) \\right] = \\frac{2}{3\\pi} \\left[ \\sin\\left(\\frac{3\\pi}{2}\\right) - \\sin\\left(-\\frac{3\\pi}{2}\\right) \\right]$$\n使用恒等式 $\\sin(-u) = -\\sin(u)$，表达式简化为：\n$$I = \\frac{2}{3\\pi} \\left[ \\sin\\left(\\frac{3\\pi}{2}\\right) - \\left(-\\sin\\left(\\frac{3\\pi}{2}\\right)\\right) \\right] = \\frac{2}{3\\pi} \\left[ 2\\sin\\left(\\frac{3\\pi}{2}\\right) \\right] = \\frac{4}{3\\pi} \\sin\\left(\\frac{3\\pi}{2}\\right)$$\n由于 $\\sin\\left(\\frac{3\\pi}{2}\\right) = -1$，积分的精确值为：\n$$I = \\frac{4}{3\\pi} (-1) = -\\frac{4}{3\\pi}$$\n现在，我们计算数值近似值。问题指定了 $n=2$ 个子区间。每个子区间的宽度为 $h$：\n$$h = \\frac{b-a}{n} = \\frac{1 - (-1)}{2} = \\frac{2}{2} = 1$$\n用于近似的网格点为 $x_0 = -1$，$x_1 = 0$ 和 $x_2 = 1$。我们在这些点上计算函数 $f(x)$ 的值：\n$$f(x_0) = f(-1) = \\cos\\left(-\\frac{3\\pi}{2}\\right) = 0$$\n$$f(x_1) = f(0) = \\cos(0) = 1$$\n$$f(x_2) = f(1) = \\cos\\left(\\frac{3\\pi}{2}\\right) = 0$$\n对于 $n=2$ 个子区间的复合梯形法则由以下公式给出：\n$$T_2 = \\frac{h}{2} [f(x_0) + 2f(x_1) + f(x_2)]$$\n代入我们已计算出的值：\n$$T_2 = \\frac{1}{2} [0 + 2(1) + 0] = \\frac{2}{2} = 1$$\n对于 $n=2$ 个子区间的复合辛普森法则，它对应于在整个区间上单次应用基本辛普森 $1/3$ 法则，其公式为：\n$$S_2 = \\frac{h}{3} [f(x_0) + 4f(x_1) + f(x_2)]$$\n代入函数值：\n$$S_2 = \\frac{1}{3} [0 + 4(1) + 0] = \\frac{4}{3}$$\n接下来，我们确定绝对误差 $E_T$ 和 $E_S$。\n梯形近似的绝对误差为：\n$$E_T = |T_2 - I| = \\left|1 - \\left(-\\frac{4}{3\\pi}\\right)\\right| = \\left|1 + \\frac{4}{3\\pi}\\right|$$\n由于 $1 > 0$ 且 $\\frac{4}{3\\pi} > 0$，其和为正，因此绝对值运算是多余的。\n$$E_T = 1 + \\frac{4}{3\\pi}$$\n辛普森近似的绝对误差为：\n$$E_S = |S_2 - I| = \\left|\\frac{4}{3} - \\left(-\\frac{4}{3\\pi}\\right)\\right| = \\left|\\frac{4}{3} + \\frac{4}{3\\pi}\\right|$$\n同样，两项均为正，因此它们的和也为正。\n$$E_S = \\frac{4}{3} + \\frac{4}{3\\pi}$$\n最后，我们计算所需的量 $\\Delta = E_S - E_T$：\n$$\\Delta = \\left(\\frac{4}{3} + \\frac{4}{3\\pi}\\right) - \\left(1 + \\frac{4}{3\\pi}\\right)$$\n$$\\Delta = \\frac{4}{3} + \\frac{4}{3\\pi} - 1 - \\frac{4}{3\\pi}$$\n表达式中的项 $\\frac{4}{3\\pi}$ 被消去。\n$$\\Delta = \\frac{4}{3} - 1 = \\frac{4}{3} - \\frac{3}{3} = \\frac{1}{3}$$\n最终值是一个精确的有理数。",
            "answer": "$$\\boxed{\\frac{1}{3}}$$"
        }
    ]
}