{
    "hands_on_practices": [
        {
            "introduction": "第一个练习展示了主元选择的根本原因。我们将看到，一个看似无害的微小主元如何在LU分解过程中导致灾难性的大误差。通过比较使用和不使用部分主元法的结果，我们可以直观地观察到该策略是如何保持数值稳定性的。",
            "id": "1383205",
            "problem": "考虑矩阵 $A$ 定义如下：\n$$\nA = \\begin{pmatrix} \\epsilon  2 \\\\ 1  3 \\end{pmatrix}\n$$\n其中 $\\epsilon = 10^{-8}$ 是一个很小的正常数。\n\n我们将对矩阵 $A$ 进行两种类型的 LU 分解。\n\n首先，求 $A$ 的标准 LU 分解，使得 $A = LU$。在此分解中，$L$ 是一个单位下三角矩阵（主对角线上的元素为1），$U$ 是一个上三角矩阵。设矩阵 $U$ 的第二行第二列的元素为 $u_{22}$。\n\n其次，使用部分主元法求 $A$ 的 LU 分解。该策略得到形如 $PA = L'U'$ 的分解，其中 $P$ 是一个置换矩阵，选择它以最大化每列主元的绝对值，$L'$ 是一个单位下三角矩阵，$U'$ 是一个上三角矩阵。设矩阵 $U'$ 的第二行第二列的元素为 $u'_{22}$。\n\n计算和 $u_{22} + u'_{22}$ 的数值。",
            "solution": "我们使用杜利特尔 LU 分解法，先不使用主元法，然后使用部分主元法。\n\n不使用主元法，记 $A=LU$，其中\n$$\nL=\\begin{pmatrix}1 & 0\\\\ \\ell_{21} & 1\\end{pmatrix},\\quad\nU=\\begin{pmatrix}u_{11} & u_{12}\\\\ 0 & u_{22}\\end{pmatrix}.\n$$\n匹配 $A=\\begin{pmatrix}\\epsilon & 2\\\\ 1 & 3\\end{pmatrix}$ 给出标准关系：\n$$\nu_{11}=a_{11}=\\epsilon,\\quad u_{12}=a_{12}=2,\\quad \\ell_{21}=\\frac{a_{21}}{u_{11}}=\\frac{1}{\\epsilon},\n$$\n以及\n$$\nu_{22}=a_{22}-\\ell_{21}u_{12}=3-\\frac{1}{\\epsilon}\\cdot 2=3-\\frac{2}{\\epsilon}.\n$$\n\n使用部分主元法，因为 $|1|>|\\epsilon|$，我们首先交换行，得到\n$$\nPA=\\begin{pmatrix}1 & 3\\\\ \\epsilon & 2\\end{pmatrix}.\n$$\n分解 $PA=L'U'$，其中\n$$\nL'=\\begin{pmatrix}1 & 0\\\\ \\ell'_{21} & 1\\end{pmatrix},\\quad\nU'=\\begin{pmatrix}u'_{11} & u'_{12}\\\\ 0 & u'_{22}\\end{pmatrix}.\n$$\n则\n$$\nu'_{11}=1,\\quad u'_{12}=3,\\quad \\ell'_{21}=\\frac{\\epsilon}{u'_{11}}=\\epsilon,\n$$\n以及\n$$\nu'_{22}=2-\\ell'_{21}u'_{12}=2-3\\epsilon.\n$$\n\n因此，\n$$\nu_{22}+u'_{22}=\\left(3-\\frac{2}{\\epsilon}\\right)+(2-3\\epsilon)=5-\\frac{2}{\\epsilon}-3\\epsilon.\n$$\n代入 $\\epsilon=10^{-8}$：\n$$\n\\frac{2}{\\epsilon}=2\\times 10^{8},\\qquad 3\\epsilon=3\\times 10^{-8},\n$$\n所以\n$$\nu_{22}+u'_{22}=5-2\\times 10^{8}-3\\times 10^{-8}=-199999995.00000003.\n$$",
            "answer": "$$\\boxed{-199999995.00000003}$$"
        },
        {
            "introduction": "人们常常将矩阵的“病态”与计算过程的不稳定混淆，而这个问题澄清了两者之间的区别。我们将分析一个条件数很小，因而本身是良态的矩阵，但对其进行无主元选择的高斯消去法却极其不稳定。这个练习强调了主元选择的必要性与算法的稳定性有关，而不仅仅是矩阵的内在属性。",
            "id": "2424543",
            "problem": "考虑线性系统 $A_{\\delta} x = b$，其中\n$$\nA_{\\delta}=\\begin{pmatrix}\n\\delta  1 \\\\\n1  1\n\\end{pmatrix},\\quad\nb=\\begin{pmatrix}\n1 \\\\\n2\n\\end{pmatrix},\n$$\n其中 $\\delta=10^{-8}$。矩阵 $A_{\\delta}$ 是对称实矩阵。矩阵的 2-范数条件数定义为 $\\kappa_{2}(A_{\\delta})=\\dfrac{\\sigma_{\\max}(A_{\\delta})}{\\sigma_{\\min}(A_{\\delta})}$，其中 $\\sigma_{\\max}(A_{\\delta})$ 和 $\\sigma_{\\min}(A_{\\delta})$ 分别是 $A_{\\delta}$ 的最大和最小奇异值。$A_{\\delta}$ 的无主元 LU 分解对应于对 $A_{\\delta}$ 应用一步高斯消去法（不进行行交换）以产生一个上三角因子 $U$。\n\n使用第一性原理（奇异值和高斯消去法的定义），证明对于给定的 $\\delta$，$\\kappa_{2}(A_{\\delta})$ 是小的，并计算由下式定义的无主元高斯消去法增长因子 $\\rho$：\n$$\n\\rho=\\frac{\\max_{i,j}\\left|U_{ij}\\right|}{\\max_{i,j}\\left|A_{\\delta,ij}\\right|},\n$$\n其中 $U$ 是对 $A_{\\delta}$ 应用无主元高斯消去法产生的上三角因子。\n\n答案规格：\n- 提供当 $\\delta=10^{-8}$ 时 $\\rho$ 的精确值。\n- 无需单位。",
            "solution": "首先必须严格验证所陈述的问题。\n\n步骤 1：提取已知条件\n提供了以下数据：\n- 线性系统为 $A_{\\delta} x = b$。\n- 矩阵为 $A_{\\delta} = \\begin{pmatrix} \\delta  1 \\\\ 1  1 \\end{pmatrix}$。\n- 向量为 $b = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}$。\n- 参数为 $\\delta = 10^{-8}$。\n- 矩阵 $A_{\\delta}$ 是对称实矩阵。\n- 条件数定义为 $\\kappa_{2}(A_{\\delta})=\\dfrac{\\sigma_{\\max}(A_{\\delta})}{\\sigma_{\\min}(A_{\\delta})}$，其中 $\\sigma_{\\max}(A_{\\delta})$ 和 $\\sigma_{\\min}(A_{\\delta})$ 分别是 $A_{\\delta}$ 的最大和最小奇异值。\n- 上三角因子 $U$ 是通过对 $A_{\\delta}$ 进行无主元高斯消去法得到的。\n- 增长因子定义为 $\\rho=\\dfrac{\\max_{i,j}\\left|U_{ij}\\right|}{\\max_{i,j}\\left|A_{\\delta,ij}\\right|}$。\n- 任务是证明对于给定的 $\\delta$，$\\kappa_{2}(A_{\\delta})$ 是小的，并计算 $\\rho$ 的精确值。\n\n步骤 2：使用提取的已知条件进行验证\n该问题具有科学依据，是适定且客观的。它涉及计算工程和数值分析中的基本概念，特别是矩阵条件数、主元选择策略以及求解线性系统时的数值稳定性之间的关系。所有术语都是标准的且定义精确。所有必要的数据都已提供，以获得唯一解。对于 $\\delta = 10^{-8}$，矩阵 $A_{\\delta}$ 是可逆的，因为其行列式为 $\\det(A_{\\delta}) = \\delta \\cdot 1 - 1 \\cdot 1 = \\delta - 1 = 10^{-8} - 1 \\neq 0$。问题的前提不违反任何科学原理或数学逻辑。\n\n步骤 3：结论与行动\n问题有效。将提供完整解答。\n\n根据要求，解答分为两部分。\n\n第一部分：条件数 $\\kappa_{2}(A_{\\delta})$ 的论证\n2-范数条件数定义为 $\\kappa_{2}(A_{\\delta}) = \\sigma_{\\max}(A_{\\delta}) / \\sigma_{\\min}(A_{\\delta})$。对于像 $A_{\\delta}$ 这样的实对称矩阵，奇异值是其特征值的绝对值。我们必须首先通过求解特征方程 $\\det(A_{\\delta} - \\lambda I) = 0$ 来找到 $A_{\\delta}$ 的特征值 $\\lambda$。\n$$\n\\det\\left(\\begin{pmatrix} \\delta  1 \\\\ 1  1 \\end{pmatrix} - \\lambda \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}\\right) = 0\n$$\n$$\n\\det\\begin{pmatrix} \\delta - \\lambda  1 \\\\ 1  1 - \\lambda \\end{pmatrix} = 0\n$$\n$$\n(\\delta - \\lambda)(1 - \\lambda) - 1 = 0\n$$\n$$\n\\lambda^2 - (1+\\delta)\\lambda + (\\delta - 1) = 0\n$$\n使用二次公式，特征值为：\n$$\n\\lambda_{1,2} = \\frac{(1+\\delta) \\pm \\sqrt{(1+\\delta)^2 - 4(\\delta - 1)}}{2} = \\frac{1+\\delta \\pm \\sqrt{1 + 2\\delta + \\delta^2 - 4\\delta + 4}}{2}\n$$\n$$\n\\lambda_{1,2} = \\frac{1+\\delta \\pm \\sqrt{\\delta^2 - 2\\delta + 5}}{2}\n$$\n$\\delta$ 的值为 $10^{-8}$。这是一个非常小的正数。我们来分析平方根下的项：$\\delta^2 - 2\\delta + 5$。对于 $\\delta = 10^{-8}$，该项为 $10^{-16} - 2 \\times 10^{-8} + 5$，这是一个非常接近 $5$ 的正数。\n两个特征值是：\n$$\n\\lambda_1 = \\frac{1+\\delta + \\sqrt{\\delta^2 - 2\\delta + 5}}{2}\n$$\n$$\n\\lambda_2 = \\frac{1+\\delta - \\sqrt{\\delta^2 - 2\\delta + 5}}{2}\n$$\n由于 $\\delta$ 很小，$\\sqrt{\\delta^2 - 2\\delta + 5} \\approx \\sqrt{5} > 1+\\delta$。因此，$\\lambda_1 > 0$ 且 $\\lambda_2 < 0$。\n奇异值为 $\\sigma_1 = |\\lambda_1| = \\lambda_1$ 和 $\\sigma_2 = |\\lambda_2| = -\\lambda_2$。\n最大奇异值为 $\\sigma_{\\max} = \\lambda_1$，最小奇异值为 $\\sigma_{\\min} = -\\lambda_2$。\n条件数为：\n$$\n\\kappa_{2}(A_{\\delta}) = \\frac{\\sigma_{\\max}}{\\sigma_{\\min}} = \\frac{\\lambda_1}{-\\lambda_2} = \\frac{1+\\delta + \\sqrt{\\delta^2 - 2\\delta + 5}}{-(1+\\delta - \\sqrt{\\delta^2 - 2\\delta + 5})} = \\frac{1+\\delta + \\sqrt{\\delta^2 - 2\\delta + 5}}{\\sqrt{\\delta^2 - 2\\delta + 5} - (1+\\delta)}\n$$\n在 $\\delta \\to 0$ 的极限下，我们有：\n$$\n\\lim_{\\delta \\to 0} \\kappa_{2}(A_{\\delta}) = \\frac{1 + \\sqrt{5}}{\\sqrt{5} - 1} = \\frac{(1 + \\sqrt{5})(\\sqrt{5} + 1)}{(\\sqrt{5} - 1)(\\sqrt{5} + 1)} = \\frac{1 + 2\\sqrt{5} + 5}{5 - 1} = \\frac{6 + 2\\sqrt{5}}{4} = \\frac{3 + \\sqrt{5}}{2}\n$$\n这个值大约是 $\\frac{3 + 2.236}{2} \\approx 2.618$。对于 $\\delta = 10^{-8}$，条件数将非常接近这个值。数量级为 $1$ 的条件数被认为是小的，表明矩阵 $A_{\\delta}$ 是良态的。这证明了问题中的陈述。\n\n第二部分：增长因子 $\\rho$ 的计算\n增长因子定义为 $\\rho = \\frac{\\max_{i,j}|U_{ij}|}{\\max_{i,j}|A_{\\delta,ij}|}$。\n首先，我们找到 $A_{\\delta}$ 的最大绝对值元素：\n$$\nA_{\\delta} = \\begin{pmatrix} 10^{-8}  1 \\\\ 1  1 \\end{pmatrix}\n$$\n元素为 $\\delta = 10^{-8}$、$1$ 和 $1$。它们绝对值的最大值为 $\\max_{i,j}|A_{\\delta,ij}| = 1$。\n\n接下来，我们对 $A_{\\delta}$ 进行无主元高斯消去法以找到上三角矩阵 $U$。第一步是消去元素 $A_{\\delta,21}$。主元是 $A_{\\delta,11} = \\delta$。乘数是 $l_{21} = \\frac{A_{\\delta,21}}{A_{\\delta,11}} = \\frac{1}{\\delta}$。\n我们将第二行 $R_2$ 更新为 $R_2' = R_2 - l_{21} R_1$：\n$$\nR_2' = \\begin{pmatrix} 1  1 \\end{pmatrix} - \\frac{1}{\\delta} \\begin{pmatrix} \\delta  1 \\end{pmatrix} = \\begin{pmatrix} 1  1 \\end{pmatrix} - \\begin{pmatrix} 1  \\frac{1}{\\delta} \\end{pmatrix} = \\begin{pmatrix} 0  1 - \\frac{1}{\\delta} \\end{pmatrix}\n$$\n得到的上三角矩阵 $U$ 是：\n$$\nU = \\begin{pmatrix} \\delta  1 \\\\ 0  1 - \\frac{1}{\\delta} \\end{pmatrix}\n$$\n现在，我们找到当 $\\delta = 10^{-8}$ 时 $U$ 的最大绝对值元素。$U$ 的元素是：\n$U_{11} = \\delta = 10^{-8}$\n$U_{12} = 1$\n$U_{21} = 0$\n$U_{22} = 1 - \\frac{1}{\\delta} = 1 - \\frac{1}{10^{-8}} = 1 - 10^8 = -99999999$\n\n非零元素的绝对值为 $|U_{11}| = 10^{-8}$、$|U_{12}| = 1$ 和 $|U_{22}| = |1 - 10^8| = 10^8 - 1 = 99999999$。\n这些值的最大值是 $\\max_{i,j}|U_{ij}| = 10^8 - 1$。\n\n最后，我们计算增长因子 $\\rho$：\n$$\n\\rho = \\frac{\\max_{i,j}|U_{ij}|}{\\max_{i,j}|A_{\\delta,ij}|} = \\frac{10^8 - 1}{1} = 10^8 - 1\n$$\n这个大的增长因子表明，尽管矩阵是良态的，但由于小主元 $\\delta$ 的存在，无主元高斯消去法在数值上是不稳定的，导致矩阵元素数量级的急剧增加。这体现了主元选择策略的至关重要性。\n精确值为 $99999999$。",
            "answer": "$$\n\\boxed{10^{8} - 1}\n$$"
        },
        {
            "introduction": "一旦我们知道需要进行主元选择，那么应该使用哪种策略呢？本练习将使用一个特殊设计的矩阵，让两种流行的方法——部分主元法和比例主元法——进行比较。通过对两种方法执行完整的消去过程并计算各自的“增长因子”，我们将更深入地理解如何衡量和比较不同主元策略在控制误差传播方面的有效性。",
            "id": "2424512",
            "problem": "在使用高斯消元法（GE）求解线性方程组 $A\\boldsymbol{x}=\\boldsymbol{b}$ 时，每一步主元行的选择对数值稳定性有至关重要的影响。两种标准策略是部分主元法（PP）和比例主元法（SPP）。在PP中，在第 $k$ 步，选择使 $|a_{ik}|$ 最大的行 $i\\geq k$ 作为主元，并将其与第 $k$ 行交换。在SPP中，首先计算比例因子向量 $\\boldsymbol{s}$，其元素为 $s_i=\\max_{1\\leq j\\leq n}|a_{ij}|$，然后在第 $k$ 步，使用与原始行相关联的固定比例因子 $s_i$，选择使 $|a_{ik}|/s_i$ 最大的行 $i\\geq k$ 作为主元。\n\n考虑一个特意构造的矩阵\n$$\nA=\\begin{pmatrix}\n\\frac{1}{2}  1  1\\\\\n9  1  1\\\\\n10  1  1000\n\\end{pmatrix},\n$$\n该矩阵被设计成使得PP和SPP会做出不同的主元选择。仅从PP和SPP的定义以及高斯消元法的基本消元步骤出发，完成以下任务：\n\n1. 对于PP，基于每一步列中最大绝对值项进行主元选择来执行高斯消元。记录每一步主元选取时执行的行交换，并计算上三角因子 $U_{\\mathrm{PP}}$。\n2. 对于SPP，从原始矩阵 $A$ 计算一次比例因子向量 $\\boldsymbol{s}$，然后基于每一步的最大比率 $|a_{ik}|/s_i$ 进行主元选择来执行高斯消元。记录所执行的行交换，并计算上三角因子 $U_{\\mathrm{SPP}}$。\n3. 使用高斯消元的增长因子定义，即比率 $\\rho=\\max_{i,j}|u_{ij}|\\,/\\,\\max_{i,j}|a_{ij}|$，计算与这两种策略相关的两个增长因子 $\\rho_{\\mathrm{PP}}$ 和 $\\rho_{\\mathrm{SPP}}$。\n4. 最后，计算单个实数\n$$\nr=\\frac{\\rho_{\\mathrm{PP}}}{\\rho_{\\mathrm{SPP}}}.\n$$\n\n将您对 $r$ 的最终答案表示为精确分数。不要四舍五入。不需要物理单位。",
            "solution": "首先将对问题陈述进行严格验证。\n\n步骤1：提取已知条件。\n已知条件如下：\n矩阵 $A$：\n$$\nA=\\begin{pmatrix}\n\\frac{1}{2}  1  1\\\\\n9  1  1\\\\\n10  1  1000\n\\end{pmatrix}\n$$\n部分主元法（PP）的定义：在第 $k$ 步，选择主元行 $i \\geq k$ 以最大化 $|a_{ik}|$。\n比例主元法（SPP）的定义：在第 $k$ 步，选择主元行 $i \\geq k$ 以最大化 $|a_{ik}|/s_i$，其中 $s_i = \\max_{1\\leq j\\leq n}|a_{ij}|$ 是从原始矩阵 $A$ 计算得出的。\n增长因子 $\\rho$ 的定义：\n$$\n\\rho = \\frac{\\max_{i,j}|u_{ij}|}{\\max_{i,j}|a_{ij}|}\n$$\n其中 $U$ 是最终的上三角矩阵。\n待计算的目标量是 $r = \\rho_{\\mathrm{PP}} / \\rho_{\\mathrm{SPP}}$。\n\n步骤2：使用提取的已知条件进行验证。\n该问题具有科学依据，因为高斯消元和主元选取策略是计算工程和数值分析中的基本概念。该问题是适定的；它提供了计算唯一解所需的所有必要数据和定义。语言客观而精确。问题是自洽的、一致的，并且需要直接应用所定义的算法。其表述没有缺陷。\n\n步骤3：结论与行动。\n问题是有效的。我们将继续进行完整解答。\n\n解答是按照四个指定的任务构建的。\n\n1. 使用部分主元法（PP）的高斯消元\n\n我们从矩阵 $A$ 开始：\n$$\nA^{(0)} = \\begin{pmatrix}\n\\frac{1}{2}  1  1 \\\\\n9  1  1 \\\\\n10  1  1000\n\\end{pmatrix}\n$$\n第 $k=1$ 步：我们检查第一列向量 $[ \\frac{1}{2}, 9, 10 ]^T$。绝对值最大的元素是 $a_{31} = 10$。因此，我们必须交换第1行和第3行。\n行交换为 $(R_1 \\leftrightarrow R_3)$。矩阵变为：\n$$\nA' = \\begin{pmatrix}\n10  1  1000 \\\\\n9  1  1 \\\\\n\\frac{1}{2}  1  1\n\\end{pmatrix}\n$$\n现在，我们进行消元。乘子是 $l_{21} = \\frac{9}{10}$ 和 $l_{31} = \\frac{1/2}{10} = \\frac{1}{20}$。\n第2行变为 $R_2 - l_{21} R_1$：$[9, 1, 1] - \\frac{9}{10} [10, 1, 1000] = [0, 1-\\frac{9}{10}, 1-900] = [0, \\frac{1}{10}, -899]$。\n第3行变为 $R_3 - l_{31} R_1$：$[\\frac{1}{2}, 1, 1] - \\frac{1}{20} [10, 1, 1000] = [0, 1-\\frac{1}{20}, 1-50] = [0, \\frac{19}{20}, -49]$。\n第一步消元后的矩阵是：\n$$\nA^{(1)} = \\begin{pmatrix}\n10  1  1000 \\\\\n0  \\frac{1}{10}  -899 \\\\\n0  \\frac{19}{20}  -49\n\\end{pmatrix}\n$$\n第 $k=2$ 步：我们检查从第2行开始的第二列。我们比较 $|a_{22}^{(1)}|=|\\frac{1}{10}|=0.1$ 和 $|a_{32}^{(1)}|=|\\frac{19}{20}|=0.95$。项 $\\frac{19}{20}$ 具有更大的绝对值。因此，我们必须交换第2行和第3行。\n行交换为 $(R_2 \\leftrightarrow R_3)$。矩阵变为：\n$$\nA'' = \\begin{pmatrix}\n10  1  1000 \\\\\n0  \\frac{19}{20}  -49 \\\\\n0  \\frac{1}{10}  -899\n\\end{pmatrix}\n$$\n我们进行消元。乘子是 $l_{32} = \\frac{a_{32}''}{a_{22}''} = \\frac{1/10}{19/20} = \\frac{1}{10} \\cdot \\frac{20}{19} = \\frac{2}{19}$。\n第3行变为 $R_3 - l_{32} R_2$：$[0, \\frac{1}{10}, -899] - \\frac{2}{19} [0, \\frac{19}{20}, -49] = [0, \\frac{1}{10}-\\frac{1}{10}, -899 - \\frac{2}{19}(-49)] = [0, 0, -899 + \\frac{98}{19}]$。\n最终的元素是 $u_{33} = -899 + \\frac{98}{19} = \\frac{-899 \\cdot 19 + 98}{19} = \\frac{-17081 + 98}{19} = -\\frac{16983}{19}$。\nPP的上三角矩阵是：\n$$\nU_{\\mathrm{PP}} = \\begin{pmatrix}\n10  1  1000 \\\\\n0  \\frac{19}{20}  -49 \\\\\n0  0  -\\frac{16983}{19}\n\\end{pmatrix}\n$$\n在 $k=1$ 时进行了行交换 $(R_1 \\leftrightarrow R_3)$，在 $k=2$ 时进行了行交换 $(R_2 \\leftrightarrow R_3)$。\n\n2. 使用比例主元法（SPP）的高斯消元\n\n首先，我们从原始矩阵 $A$ 计算比例因子向量 $\\boldsymbol{s}$：\n$s_1 = \\max(|\\frac{1}{2}|, |1|, |1|) = 1$\n$s_2 = \\max(|9|, |1|, |1|) = 9$\n$s_3 = \\max(|10|, |1|, |1000|) = 1000$\n所以，$\\boldsymbol{s} = [1, 9, 1000]^T$。\n\n第 $k=1$ 步：我们计算比率 $\\frac{|a_{i1}|}{s_i}$ 对于 $i=1, 2, 3$：\n对于第1行：$\\frac{|1/2|}{s_1} = \\frac{1/2}{1} = \\frac{1}{2} = 0.5$\n对于第2行：$\\frac{|9|}{s_2} = \\frac{9}{9} = 1$\n对于第3行：$\\frac{|10|}{s_3} = \\frac{10}{1000} = \\frac{1}{100} = 0.01$\n最大比率为 $1$，对应于第2行。我们必须交换第1行和第2行。\n行交换为 $(R_1 \\leftrightarrow R_2)$。矩阵变为：\n$$\nA' = \\begin{pmatrix}\n9  1  1 \\\\\n\\frac{1}{2}  1  1 \\\\\n10  1  1000\n\\end{pmatrix}\n$$\n我们进行消元。乘子是 $l_{21} = \\frac{1/2}{9} = \\frac{1}{18}$ 和 $l_{31} = \\frac{10}{9}$。\n第2行变为 $R_2 - l_{21} R_1$：$[\\frac{1}{2}, 1, 1] - \\frac{1}{18} [9, 1, 1] = [0, 1-\\frac{1}{18}, 1-\\frac{1}{18}] = [0, \\frac{17}{18}, \\frac{17}{18}]$。\n第3行变为 $R_3 - l_{31} R_1$：$[10, 1, 1000] - \\frac{10}{9} [9, 1, 1] = [0, 1-\\frac{10}{9}, 1000-\\frac{10}{9}] = [0, -\\frac{1}{9}, \\frac{8990}{9}]$。\n第一步消元后的矩阵是：\n$$\nA^{(1)} = \\begin{pmatrix}\n9  1  1 \\\\\n0  \\frac{17}{18}  \\frac{17}{18} \\\\\n0  -\\frac{1}{9}  \\frac{8990}{9}\n\\end{pmatrix}\n$$\n第 $k=2$ 步：我们计算比率 $\\frac{|a_{i2}^{(1)}|}{s_i'}$ 对于 $i=2, 3$，其中 $s_i'$ 是现在位于第2和第3位置的原始行的比例因子。当前第2行是原始第1行（$s_1=1$），当前第3行是原始第3行（$s_3=1000$）。\n对于第2行：$\\frac{|17/18|}{s_1} = \\frac{17/18}{1} = \\frac{17}{18} \\approx 0.944$\n对于第3行：$\\frac{|-1/9|}{s_3} = \\frac{1/9}{1000} = \\frac{1}{9000} \\approx 0.00011$\n最大比率为 $\\frac{17}{18}$，对应于当前第2行。不需要行交换。\n我们进行消元。乘子是 $l_{32} = \\frac{a_{32}^{(1)}}{a_{22}^{(1)}} = \\frac{-1/9}{17/18} = -\\frac{1}{9} \\cdot \\frac{18}{17} = -\\frac{2}{17}$。\n第3行变为 $R_3 - l_{32} R_2$：$[0, -\\frac{1}{9}, \\frac{8990}{9}] - (-\\frac{2}{17}) [0, \\frac{17}{18}, \\frac{17}{18}] = [0, -\\frac{1}{9}+\\frac{1}{9}, \\frac{8990}{9}+\\frac{1}{9}] = [0, 0, \\frac{8991}{9}]$。\n最终的元素是 $u_{33} = \\frac{8991}{9} = 999$。\nSPP的上三角矩阵是：\n$$\nU_{\\mathrm{SPP}} = \\begin{pmatrix}\n9  1  1 \\\\\n0  \\frac{17}{18}  \\frac{17}{18} \\\\\n0  0  999\n\\end{pmatrix}\n$$\n唯一的行交换是在 $k=1$ 时的 $(R_1 \\leftrightarrow R_2)$。\n\n3. 增长因子的计算\n\n原始矩阵 $A$ 中的最大绝对值为 $\\max_{i,j}|a_{ij}| = |1000| = 1000$。\n\n对于PP：我们找到 $U_{\\mathrm{PP}}$ 中的最大绝对值。\n$$\nU_{\\mathrm{PP}} = \\begin{pmatrix}\n10  1  1000 \\\\\n0  \\frac{19}{20}  -49 \\\\\n0  0  -\\frac{16983}{19}\n\\end{pmatrix}\n$$\n矩阵的元素是 $10$, $1$, $1000$, $\\frac{19}{20}=0.95$, $-49$, 和 $-\\frac{16983}{19}$。\n我们必须比较 $|1000|$ 和 $|-\\frac{16983}{19}|$。由于 $16983  19000$，所以 $\\frac{16983}{19}  1000$。\n因此，$\\max_{i,j}|u_{ij}| = 1000$。\nPP的增长因子是：\n$$\n\\rho_{\\mathrm{PP}} = \\frac{\\max_{i,j}|u_{ij}|}{\\max_{i,j}|a_{ij}|} = \\frac{1000}{1000} = 1\n$$\n\n对于SPP：我们找到 $U_{\\mathrm{SPP}}$ 中的最大绝对值。\n$$\nU_{\\mathrm{SPP}} = \\begin{pmatrix}\n9  1  1 \\\\\n0  \\frac{17}{18}  \\frac{17}{18} \\\\\n0  0  999\n\\end{pmatrix}\n$$\n矩阵的元素是 $9$, $1$, $1$, $\\frac{17}{18} \\approx 0.944$, 和 $999$。\n最大绝对值显然是 $\\max_{i,j}|u_{ij}| = 999$。\nSPP的增长因子是：\n$$\n\\rho_{\\mathrm{SPP}} = \\frac{\\max_{i,j}|u_{ij}|}{\\max_{i,j}|a_{ij}|} = \\frac{999}{1000}\n$$\n\n4. 最终比率计算\n\n最后，我们计算比率 $r$：\n$$\nr = \\frac{\\rho_{\\mathrm{PP}}}{\\rho_{\\mathrm{SPP}}} = \\frac{1}{\\frac{999}{1000}} = \\frac{1000}{999}\n$$\n这个结果展示了一个场景，其中更简单的部分主元法策略导致的增长因子略大于更复杂的比例主元法，后者正确地识别了具有不良缩放比例的行并避免将其用作主元。",
            "answer": "$$\\boxed{\\frac{1000}{999}}$$"
        }
    ]
}