{
    "hands_on_practices": [
        {
            "introduction": "While Gaussian elimination is a powerful tool, its naive application can lead to significant numerical errors, even for simple, invertible matrices. This foundational exercise illustrates the core motivation for pivoting strategies. By performing an LU decomposition on a simple $2 \\times 2$ matrix with a very small pivot element, you will directly observe how numerical instability arises and then see how partial pivoting effectively resolves the issue by reordering the matrix rows to ensure a more stable computation. ",
            "id": "1383205",
            "problem": "Consider the matrix $A$ defined as:\n$$\nA = \\begin{pmatrix} \\epsilon  2 \\\\ 1  3 \\end{pmatrix}\n$$\nwhere $\\epsilon = 10^{-8}$ is a small positive constant.\n\nWe will perform two types of LU decomposition on matrix $A$.\n\nFirst, find the standard LU decomposition of $A$, such that $A = LU$. In this decomposition, $L$ is a unit lower triangular matrix (with ones on the main diagonal) and $U$ is an upper triangular matrix. Let the entry in the second row and second column of matrix $U$ be denoted by $u_{22}$.\n\nSecond, find the LU decomposition of $A$ using a partial pivoting strategy. This strategy results in a factorization of the form $PA = L'U'$, where $P$ is a permutation matrix chosen to maximize the absolute value of the pivot in each column, $L'$ is a unit lower triangular matrix, and $U'$ is an upper triangular matrix. Let the entry in the second row and second column of matrix $U'$ be denoted by $u'_{22}$.\n\nCalculate the numerical value of the sum $u_{22} + u'_{22}$.",
            "solution": "We use the Doolittle LU factorization without pivoting and then with partial pivoting.\n\nWithout pivoting, write $A=LU$ with\n$$\nL=\\begin{pmatrix}10\\\\ \\ell_{21}1\\end{pmatrix},\\quad\nU=\\begin{pmatrix}u_{11}u_{12}\\\\ 0u_{22}\\end{pmatrix}.\n$$\nMatching $A=\\begin{pmatrix}\\epsilon2\\\\ 13\\end{pmatrix}$ gives the standard relations:\n$$\nu_{11}=a_{11}=\\epsilon,\\quad u_{12}=a_{12}=2,\\quad \\ell_{21}=\\frac{a_{21}}{u_{11}}=\\frac{1}{\\epsilon},\n$$\nand\n$$\nu_{22}=a_{22}-\\ell_{21}u_{12}=3-\\frac{1}{\\epsilon}\\cdot 2=3-\\frac{2}{\\epsilon}.\n$$\n\nWith partial pivoting, we first swap rows because $|1||\\,\\epsilon\\,|$, yielding\n$$\nPA=\\begin{pmatrix}13\\\\ \\epsilon2\\end{pmatrix}.\n$$\nFactor $PA=L'U'$ with\n$$\nL'=\\begin{pmatrix}10\\\\ \\ell'_{21}1\\end{pmatrix},\\quad\nU'=\\begin{pmatrix}u'_{11}u'_{12}\\\\ 0u'_{22}\\end{pmatrix}.\n$$\nThen\n$$\nu'_{11}=1,\\quad u'_{12}=3,\\quad \\ell'_{21}=\\frac{\\epsilon}{u'_{11}}=\\epsilon,\n$$\nand\n$$\nu'_{22}=2-\\ell'_{21}u'_{12}=2-3\\epsilon.\n$$\n\nTherefore,\n$$\nu_{22}+u'_{22}=\\left(3-\\frac{2}{\\epsilon}\\right)+(2-3\\epsilon)=5-\\frac{2}{\\epsilon}-3\\epsilon.\n$$\nSubstitute $\\epsilon=10^{-8}$:\n$$\n\\frac{2}{\\epsilon}=2\\times 10^{8},\\qquad 3\\epsilon=3\\times 10^{-8},\n$$\nso\n$$\nu_{22}+u'_{22}=5-2\\times 10^{8}-3\\times 10^{-8}=-199999995.00000003.\n$$",
            "answer": "$$\\boxed{-199999995.00000003}$$"
        },
        {
            "introduction": "Having established the necessity of pivoting, we can explore more nuanced strategies for selecting the optimal pivot element. This practice moves beyond the basic idea of just choosing the largest element in a column by comparing partial pivoting with scaled partial pivoting. You will analyze a specially designed matrix where the largest element in the first column is part of a row with overall large entries, demonstrating why a scaled approach can provide a more reliable choice for the pivot. ",
            "id": "1383197",
            "problem": "In numerical linear algebra, pivoting strategies are crucial for maintaining stability when performing matrix decompositions, such as the Lower-Upper (LU) decomposition. Consider the following $3 \\times 3$ matrix $A$:\n\n$$\nA = \\begin{pmatrix}\n2  -20  50 \\\\\n-10  1  1000 \\\\\n5  1  -2\n\\end{pmatrix}\n$$\n\nWe will compare two common pivoting strategies to select the first pivot element for the LU decomposition of $A$. The \"first pivot element\" is the element in the top-left position of the matrix after the first row interchange is performed.\n\n1.  **Partial Pivoting**: In the first step (for the first column), identify the entry in the first column with the largest absolute value. Swap the row containing this entry with the first row. The element now at the $(1,1)$ position is the pivot.\n\n2.  **Scaled Partial Pivoting**: First, for each row $i$, determine a scale factor $s_i$ which is the maximum absolute value of any element in that row. Then, for the first step, choose the row index $p$ (where $p \\in \\{1, 2, 3\\}$) that maximizes the ratio $\\frac{|a_{p1}|}{s_p}$. Swap row $p$ with the first row. The element now at the $(1,1)$ position is the pivot.\n\nLet $p_1$ be the value of the first pivot element selected using the partial pivoting strategy, and let $p_2$ be the value of the first pivot element selected using the scaled partial pivoting strategy.\n\nWhich of the following options represents the ordered pair $(p_1, p_2)$?\n\nA. $(-10, 5)$\n\nB. $(5, -10)$\n\nC. $(2, 5)$\n\nD. $(-10, -10)$\n\nE. $(5, 5)$",
            "solution": "For partial pivoting, examine the first column entries $a_{11}=2$, $a_{21}=-10$, $a_{31}=5$. Their absolute values are $|2|=2$, $|-10|=10$, $|5|=5$. The maximum is $10$ at row $2$, so swap row $2$ with row $1$. The new $(1,1)$ entry (first pivot) is $p_{1}=-10$.\n\nFor scaled partial pivoting, compute the scale factors $s_{i}=\\max_{j}|a_{ij}|$ for each row:\n$$\ns_{1}=\\max\\{2,20,50\\}=50,\\quad s_{2}=\\max\\{10,1,1000\\}=1000,\\quad s_{3}=\\max\\{5,1,2\\}=5.\n$$\nCompute the ratios $\\frac{|a_{i1}|}{s_{i}}$:\n$$\n\\frac{|a_{11}|}{s_{1}}=\\frac{2}{50},\\quad \\frac{|a_{21}|}{s_{2}}=\\frac{10}{1000},\\quad \\frac{|a_{31}|}{s_{3}}=\\frac{5}{5}=1.\n$$\nThe maximum ratio is $1$ at row $3$, so swap row $3$ with row $1$. The new $(1,1)$ entry (first pivot) is $p_{2}=5$.\n\nThus $(p_{1},p_{2})=(-10,5)$, which corresponds to option A.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "A critical concept in numerical analysis is distinguishing between an ill-posed problem and an unstable algorithm. This exercise formalizes this distinction by introducing the matrix condition number, $\\kappa(A)$, which measures the intrinsic sensitivity of a matrix, and the growth factor, $\\rho$, which quantifies the stability of the Gaussian elimination process. You will work with a matrix that is well-conditioned (small $\\kappa(A)$), yet demonstrates a very large growth factor when solved without pivoting, proving that pivoting is essential for algorithmic stability regardless of the problem's inherent sensitivity. ",
            "id": "2424543",
            "problem": "Consider the linear system $A_{\\delta} x = b$ with\n$$\nA_{\\delta}=\\begin{pmatrix}\n\\delta  1 \\\\\n1  1\n\\end{pmatrix},\\quad\nb=\\begin{pmatrix}\n1 \\\\\n2\n\\end{pmatrix},\n$$\nwhere $\\delta=10^{-8}$. The matrix $A_{\\delta}$ is symmetric and real. The condition number in the matrix $2$-norm is defined as $\\kappa_{2}(A_{\\delta})=\\dfrac{\\sigma_{\\max}(A_{\\delta})}{\\sigma_{\\min}(A_{\\delta})}$, where $\\sigma_{\\max}(A_{\\delta})$ and $\\sigma_{\\min}(A_{\\delta})$ are the largest and smallest singular values of $A_{\\delta}$, respectively. The no-pivoting Lowerâ€“Upper (LU) decomposition of $A_{\\delta}$ corresponds to applying one step of Gaussian elimination without row exchanges to produce an upper-triangular factor $U$.\n\nUsing first principles (definitions of singular values and Gaussian elimination), justify that $\\kappa_{2}(A_{\\delta})$ is small for the given $\\delta$ and compute the no-pivoting Gaussian elimination growth factor $\\rho$ defined by\n$$\n\\rho=\\frac{\\max_{i,j}\\left|U_{ij}\\right|}{\\max_{i,j}\\left|A_{\\delta,ij}\\right|},\n$$\nwhere $U$ is the upper-triangular factor produced by Gaussian elimination without pivoting applied to $A_{\\delta}$.\n\nAnswer specification:\n- Provide the exact value of $\\rho$ for $\\delta=10^{-8}$.\n- No units are required.",
            "solution": "The problem as stated must first be rigorously validated.\n\nStep 1: Extract Givens\nThe following data are provided:\n- The linear system is $A_{\\delta} x = b$.\n- The matrix $A_{\\delta} = \\begin{pmatrix} \\delta  1 \\\\ 1  1 \\end{pmatrix}$.\n- The vector $b = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}$.\n- The parameter $\\delta = 10^{-8}$.\n- The matrix $A_{\\delta}$ is symmetric and real.\n- The condition number is defined as $\\kappa_{2}(A_{\\delta})=\\dfrac{\\sigma_{\\max}(A_{\\delta})}{\\sigma_{\\min}(A_{\\delta})}$, where $\\sigma_{\\max}(A_{\\delta})$ and $\\sigma_{\\min}(A_{\\delta})$ are the largest and smallest singular values of $A_{\\delta}$.\n- The upper-triangular factor $U$ is obtained from no-pivoting Gaussian elimination on $A_{\\delta}$.\n- The growth factor is defined as $\\rho=\\dfrac{\\max_{i,j}\\left|U_{ij}\\right|}{\\max_{i,j}\\left|A_{\\delta,ij}\\right|}$.\n- The tasks are to justify that $\\kappa_{2}(A_{\\delta})$ is small for the given $\\delta$ and to compute the exact value of $\\rho$.\n\nStep 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, well-posed, and objective. It concerns fundamental concepts in computational engineering and numerical analysis, specifically the relationship between matrix conditioning, pivoting strategies, and numerical stability in solving linear systems. All terms are standard and precisely defined. All necessary data are provided for a unique solution. The matrix $A_{\\delta}$ is invertible for $\\delta = 10^{-8}$, as its determinant is $\\det(A_{\\delta}) = \\delta \\cdot 1 - 1 \\cdot 1 = \\delta - 1 = 10^{-8} - 1 \\neq 0$. The premises do not violate any scientific principles or mathematical logic.\n\nStep 3: Verdict and Action\nThe problem is valid. A complete solution will be provided.\n\nThe solution proceeds in two parts as requested.\n\nPart 1: Justification of the condition number $\\kappa_{2}(A_{\\delta})$\nThe condition number in the $2$-norm is defined as $\\kappa_{2}(A_{\\delta}) = \\sigma_{\\max}(A_{\\delta}) / \\sigma_{\\min}(A_{\\delta})$. For a real symmetric matrix such as $A_{\\delta}$, the singular values are the absolute values of the eigenvalues. We must first find the eigenvalues, $\\lambda$, of $A_{\\delta}$ by solving the characteristic equation $\\det(A_{\\delta} - \\lambda I) = 0$.\n$$\n\\det\\left(\\begin{pmatrix} \\delta  1 \\\\ 1  1 \\end{pmatrix} - \\lambda \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}\\right) = 0\n$$\n$$\n\\det\\begin{pmatrix} \\delta - \\lambda  1 \\\\ 1  1 - \\lambda \\end{pmatrix} = 0\n$$\n$$\n(\\delta - \\lambda)(1 - \\lambda) - 1 = 0\n$$\n$$\n\\lambda^2 - (1+\\delta)\\lambda + (\\delta - 1) = 0\n$$\nUsing the quadratic formula, the eigenvalues are:\n$$\n\\lambda_{1,2} = \\frac{(1+\\delta) \\pm \\sqrt{(1+\\delta)^2 - 4(\\delta - 1)}}{2} = \\frac{1+\\delta \\pm \\sqrt{1 + 2\\delta + \\delta^2 - 4\\delta + 4}}{2}\n$$\n$$\n\\lambda_{1,2} = \\frac{1+\\delta \\pm \\sqrt{\\delta^2 - 2\\delta + 5}}{2}\n$$\nThe value of $\\delta$ is given as $10^{-8}$. This is a very small positive number. Let's analyze the term under the square root: $\\delta^2 - 2\\delta + 5$. For $\\delta = 10^{-8}$, this is $10^{-16} - 2 \\times 10^{-8} + 5$, which is a positive number very close to $5$.\nThe two eigenvalues are:\n$$\n\\lambda_1 = \\frac{1+\\delta + \\sqrt{\\delta^2 - 2\\delta + 5}}{2}\n$$\n$$\n\\lambda_2 = \\frac{1+\\delta - \\sqrt{\\delta^2 - 2\\delta + 5}}{2}\n$$\nSince $\\delta$ is small, $\\sqrt{\\delta^2 - 2\\delta + 5} \\approx \\sqrt{5}  1+\\delta$. Therefore, $\\lambda_1  0$ and $\\lambda_2  0$.\nThe singular values are $\\sigma_1 = |\\lambda_1| = \\lambda_1$ and $\\sigma_2 = |\\lambda_2| = -\\lambda_2$.\nThe largest singular value is $\\sigma_{\\max} = \\lambda_1$, and the smallest is $\\sigma_{\\min} = -\\lambda_2$.\nThe condition number is:\n$$\n\\kappa_{2}(A_{\\delta}) = \\frac{\\sigma_{\\max}}{\\sigma_{\\min}} = \\frac{\\lambda_1}{-\\lambda_2} = \\frac{1+\\delta + \\sqrt{\\delta^2 - 2\\delta + 5}}{-(1+\\delta - \\sqrt{\\delta^2 - 2\\delta + 5})} = \\frac{1+\\delta + \\sqrt{\\delta^2 - 2\\delta + 5}}{\\sqrt{\\delta^2 - 2\\delta + 5} - (1+\\delta)}\n$$\nIn the limit as $\\delta \\to 0$, we have:\n$$\n\\lim_{\\delta \\to 0} \\kappa_{2}(A_{\\delta}) = \\frac{1 + \\sqrt{5}}{\\sqrt{5} - 1} = \\frac{(1 + \\sqrt{5})(\\sqrt{5} + 1)}{(\\sqrt{5} - 1)(\\sqrt{5} + 1)} = \\frac{1 + 2\\sqrt{5} + 5}{5 - 1} = \\frac{6 + 2\\sqrt{5}}{4} = \\frac{3 + \\sqrt{5}}{2}\n$$\nThis value is approximately $\\frac{3 + 2.236}{2} \\approx 2.618$. For $\\delta = 10^{-8}$, the condition number will be extremely close to this value. A condition number of order $1$ is considered small, indicating that the matrix $A_{\\delta}$ is well-conditioned. This justifies the statement in the problem.\n\nPart 2: Computation of the growth factor $\\rho$\nThe growth factor is defined as $\\rho = \\frac{\\max_{i,j}|U_{ij}|}{\\max_{i,j}|A_{\\delta,ij}|}$.\nFirst, we find the maximum absolute element of $A_{\\delta}$:\n$$\nA_{\\delta} = \\begin{pmatrix} 10^{-8}  1 \\\\ 1  1 \\end{pmatrix}\n$$\nThe elements are $\\delta = 10^{-8}$, $1$, and $1$. The maximum of their absolute values is $\\max_{i,j}|A_{\\delta,ij}| = 1$.\n\nNext, we perform Gaussian elimination without pivoting on $A_{\\delta}$ to find the upper-triangular matrix $U$. The first step is to eliminate the element $A_{\\delta,21}$. The pivot is $A_{\\delta,11} = \\delta$. The multiplier is $l_{21} = \\frac{A_{\\delta,21}}{A_{\\delta,11}} = \\frac{1}{\\delta}$.\nWe update the second row $R_2$ to $R_2' = R_2 - l_{21} R_1$:\n$$\nR_2' = \\begin{pmatrix} 1  1 \\end{pmatrix} - \\frac{1}{\\delta} \\begin{pmatrix} \\delta  1 \\end{pmatrix} = \\begin{pmatrix} 1  1 \\end{pmatrix} - \\begin{pmatrix} 1  \\frac{1}{\\delta} \\end{pmatrix} = \\begin{pmatrix} 0  1 - \\frac{1}{\\delta} \\end{pmatrix}\n$$\nThe resulting upper-triangular matrix $U$ is:\n$$\nU = \\begin{pmatrix} \\delta  1 \\\\ 0  1 - \\frac{1}{\\delta} \\end{pmatrix}\n$$\nNow, we find the maximum absolute element of $U$ for $\\delta = 10^{-8}$. The elements of $U$ are:\n$U_{11} = \\delta = 10^{-8}$\n$U_{12} = 1$\n$U_{21} = 0$\n$U_{22} = 1 - \\frac{1}{\\delta} = 1 - \\frac{1}{10^{-8}} = 1 - 10^8 = -99999999$\n\nThe absolute values of the non-zero elements are $|U_{11}| = 10^{-8}$, $|U_{12}| = 1$, and $|U_{22}| = |1 - 10^8| = 10^8 - 1 = 99999999$.\nThe maximum of these is $\\max_{i,j}|U_{ij}| = 10^8 - 1$.\n\nFinally, we compute the growth factor $\\rho$:\n$$\n\\rho = \\frac{\\max_{i,j}|U_{ij}|}{\\max_{i,j}|A_{\\delta,ij}|} = \\frac{10^8 - 1}{1} = 10^8 - 1\n$$\nThis large growth factor indicates that despite the matrix being well-conditioned, the process of Gaussian elimination without pivoting is numerically unstable due to the small pivot $\\delta$, leading to a massive increase in the magnitude of the matrix elements. This exemplifies the critical importance of pivoting strategies.\nThe exact value is $99999999$.",
            "answer": "$$\n\\boxed{10^{8} - 1}\n$$"
        }
    ]
}