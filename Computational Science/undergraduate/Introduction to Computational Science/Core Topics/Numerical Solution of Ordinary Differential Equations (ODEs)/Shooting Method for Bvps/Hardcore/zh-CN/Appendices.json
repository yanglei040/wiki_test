{
    "hands_on_practices": [
        {
            "introduction": "虽然打靶法通常是一种数值技术，但某些特殊构造的问题允许我们找到精确的解析解。这个练习  提供了一个绝佳的机会，让我们可以在没有数值近似复杂性的情况下，掌握寻找正确初始斜率 $s$ 的核心思想。通过一个巧妙的代换，我们可以直接求解一个非线性边值问题，这为我们更复杂的数值探索奠定了坚实的直观基础。",
            "id": "558739",
            "problem": "打靶法是一种强大的技术，通过将边值问题（BVP）重新表述为初值问题（IVP）来求解它们。对于一个形如 $u'' = f(x, u, u')$ 的二阶常微分方程，其边界条件为 $u(x_0) = \\alpha$ 和 $u(x_1) = \\beta$，我们将初始斜率 $s = u'(x_0)$ 视为一个参数。初值问题的解（记为 $u(x; s)$）将取决于 $s$ 的这个选择。目标是找到 $s$ 的特定值，使得第二个边界条件得到满足，即 $u(x_1; s) = \\beta$。假设 $u(x_1; s)$ 是 $s$ 的一个连续函数，那么根据介值定理，通常可以保证存在这样的 $s$。\n\n虽然这个过程通常是数值计算，但某些特殊构造的非线性 BVP 也可以求得精确的解析解。考虑以下在区间 $x \\in [0, 1]$ 上的 BVP：\n$$\nu'' = \\frac{\\pi^2}{8}(u + u^3)\n$$\n其边界条件为 $u(0) = 0$ 和 $u(1) = 1$。\n\n请确定初始斜率 $s = u'(0)$ 的精确正值，使得相应初值问题的解也能满足在 $x=1$ 处的边界条件。",
            "solution": "我们寻求非线性 BVP 的一个精确解\n$$u''=\\frac{\\pi^2}{8}(u+u^3),\\quad u(0)=0,\\;u(1)=1.$$\n1. 拟设：假设\n$$u(x)=\\tan(kx).$$\n则\n$$u'(x)=k\\sec^2(kx),$$\n$$u''(x)=k^2\\cdot2\\sec^2(kx)\\tan(kx)=2k^2\\bigl(u+u^3\\bigr).$$\n2. 与给定的常微分方程（ODE）匹配要求\n$$2k^2=\\frac{\\pi^2}{8}\n\\quad\\Longrightarrow\\quad\nk^2=\\frac{\\pi^2}{16},\n\\quad k=\\frac{\\pi}{4}.$$\n3. 当 $k=\\pi/4$ 时，边界条件为\n$$u(0)=\\tan(0)=0,\\quad\nu(1)=\\tan\\!\\bigl(\\tfrac{\\pi}{4}\\bigr)=1.$$\n4. 初始斜率为\n$$s=u'(0)=k\\sec^2(0)=k=\\frac{\\pi}{4}.$$",
            "answer": "$$\\boxed{\\frac{\\pi}{4}}$$"
        },
        {
            "introduction": "掌握任何数值方法的关键在于理解其局限性。这个问题  深入探讨了一个经典场景，在该场景下，标准的打靶法会失效。通过分析一个同时也是特征值问题的线性边值问题，我们可以理解为什么初始斜率 $s$ 会变得不确定，以及这种情况为何会导致数值求根算法（如牛顿法）的崩溃。这种认识对于在实践中稳健地应用打靶法至关重要。",
            "id": "3192307",
            "problem": "考虑在区间 $[0,\\pi]$ 上的一个二阶线性常微分方程 (ODE) 的两点边值问题 (BVP)：$y'' + y = 0$，其狄利克雷边界条件 (Dirichlet boundary conditions) 为 $y(0) = 0$ 和 $y(\\pi) = 0$。在打靶法中，我们将该边值问题转换为一个初值问题 (IVP)，通过选择一个初始斜率（打靶角度）$s = y'(0)$，并从 $x = 0$ 向前积分到 $x = \\pi$ 以检验终端边界条件。根据控制方程、其线性性质以及在这些边界条件下的解的结构，判断下列哪些陈述是正确的：\n\nA. 对于任意实数打靶角度 $s = y'(0)$，该初值问题的解都满足 $y(\\pi) = 0$，因此无论 $s$ 取何值，$x = \\pi$ 处的边界条件都会被满足。\n\nB. $x = \\pi$ 处的边界条件被满足当且仅当 $s = 0$ 时。\n\nC. $s$ 的无关性是因为点对 $\\{y'' + y = 0,\\, y(0) = 0,\\, y(\\pi) = 0\\}$ 构成了一个特征值问题，其中 $\\lambda = 1$ 是在 $[0,\\pi]$ 上的一个特征值，其产生的特征函数与 $\\sin x$ 成正比，并且该函数在两个边界处自动为零。\n\nD. 如果定义打靶残差为 $R(s) = y(\\pi; s) - 0$，并对 $s$ 应用牛顿法更新，那么 $\\mathrm{d}R/\\mathrm{d}s$ 恒等于 $0$，因此更新步骤无法改变 $s$。\n\nE. 将 $y'' + y$ 替换为 $y'' + (1 + \\varepsilon)y$，对于任意小的正数 $\\varepsilon$，会保持 $y(\\pi; s) = 0$ 对所有 $s$ 成立的性质。\n\nF. 满足两个边界条件的函数空间是一维的，且由 $\\{A \\sin x : A \\in \\mathbb{R}\\}$ 给出，因此 $s$ 扮演了自由振幅参数的角色。\n\n选择所有正确的选项。",
            "solution": "为了分析该问题，我们首先求解由打靶法定义的初值问题（IVP）。\n\n### IVP 的解\n\n该 IVP 由以下部分组成：\n-   **常微分方程 (ODE)**: $y'' + y = 0$\n-   **初始条件 (IC)**: $y(0) = 0$ 和 $y'(0) = s$\n\n这是一个二阶线性齐次常系数 ODE。其特征方程为 $r^2 + 1 = 0$，根为 $r = \\pm i$。因此，通解的形式为：\n$$y(x) = C_1 \\cos(x) + C_2 \\sin(x)$$\n我们应用初始条件来确定常数 $C_1$ 和 $C_2$。\n由 $y(0) = 0$ 得：\n$$y(0) = C_1 \\cos(0) + C_2 \\sin(0) = C_1 \\cdot 1 + C_2 \\cdot 0 = C_1$$\n所以，$C_1 = 0$。解简化为 $y(x) = C_2 \\sin(x)$。\n\n接着，我们使用第二个初始条件 $y'(0) = s$。首先，我们求 $y(x)$ 的导数：\n$$y'(x) = C_2 \\cos(x)$$\n在 $x=0$ 处应用该条件：\n$$y'(0) = C_2 \\cos(0) = C_2 \\cdot 1 = C_2$$\n所以，$C_2 = s$。\n\n将 $C_1$ 和 $C_2$ 的值代回通解，我们得到对于给定初始斜率 $s$ 的 IVP 的唯一解：\n$$y(x; s) = s \\sin(x)$$\n现在，我们检查该解在 $x = \\pi$ 处是否满足终端边界条件 $y(\\pi) = 0$：\n$$y(\\pi; s) = s \\sin(\\pi) = s \\cdot 0 = 0$$\n这个结果表明，对于**任何**实数值的打靶参数 $s$，终端边界条件 $y(\\pi) = 0$ 都会被满足。\n\n### 各选项分析\n\n**A. 对于任意实数打靶角度 $s = y'(0)$，该初值问题的解都满足 $y(\\pi) = 0$，因此无论 $s$ 取何值，$x = \\pi$ 处的边界条件都会被满足。**\n我们的推导表明 $y(\\pi; s) = 0$ 对所有实数 $s$ 成立。因此，该陈述正确。\n\n**B. $x = \\pi$ 处的边界条件被满足当且仅当 $s = 0$ 时。**\n这与我们的发现相矛盾，即边界条件对所有 $s$ 都满足。$s=0$ 产生平凡解 $y(x) = 0$，但任何非零的 $s$ 也能产生有效的非平凡解，如 $s=1$ 时的 $y(x) = \\sin(x)$。因此，该陈述不正确。\n\n**C. $s$ 的无关性是因为点对 $\\{y'' + y = 0,\\, y(0) = 0,\\, y(\\pi) = 0\\}$ 构成了一个特征值问题，其中 $\\lambda = 1$ 是在 $[0,\\pi]$ 上的一个特征值，其产生的特征函数与 $\\sin x$ 成正比，并且该函数在两个边界处自动为零。**\n该 BVP 是一个 Sturm-Liouville 特征值问题，形式为 $-y'' = \\lambda y$，边界条件为 $y(0)=0$ 和 $y(\\pi)=0$。我们的方程 $y''+y=0$ 可写为 $-y'' = 1 \\cdot y$，对应于 $\\lambda=1$。该特征值问题的特征值为 $\\lambda_n = n^2$ ($n=1, 2, \\dots$)，对应的特征函数为 $\\sin(nx)$。当 $n=1$ 时，我们得到特征值 $\\lambda_1 = 1$，其特征函数为 $\\sin(x)$。这意味着 BVP 的任何解都必须是特征函数的倍数，即 $y(x) = A \\sin(x)$。由于 $A$ 可以是任何常数，因此解不是唯一的。我们的 IVP 解 $y(x;s) = s \\sin(x)$ 正是这种形式，其中 $s$ 扮演了任意常数 $A$ 的角色。因此，该陈述正确地解释了 $s$ 无关性的根本原因。\n\n**D. 如果定义打靶残差为 $R(s) = y(\\pi; s) - 0$，并对 $s$ 应用牛顿法更新，那么 $\\mathrm{d}R/\\mathrm{d}s$ 恒等于 $0$，因此更新步骤无法改变 $s$。**\n残差函数为 $R(s) = y(\\pi; s) = 0$。这是一个常数函数，其导数 $\\frac{\\mathrm{d}R}{\\mathrm{d}s}$ 恒等于 $0$。牛顿法的更新步骤为 $s_{k+1} = s_k - R(s_k) / (\\mathrm{d}R/\\mathrm{d}s)$。在我们的情况下，这变成了 $s_{k+1} = s_k - 0/0$，这是一个未定义的表达式。因此，牛顿法失效。该陈述准确。\n\n**E. 将 $y'' + y$ 替换为 $y'' + (1 + \\varepsilon)y$，对于任意小的正数 $\\varepsilon$，会保持 $y(\\pi; s) = 0$ 对所有 $s$ 成立的性质。**\n考虑扰动问题 $y'' + (1 + \\varepsilon)y = 0$，其中 $\\varepsilon  0$。令 $\\omega^2 = 1+\\varepsilon$。IVP 的解为 $y(x; s) = \\frac{s}{\\omega} \\sin(\\omega x)$。在 $x=\\pi$ 处，我们有 $y(\\pi; s) = \\frac{s}{\\sqrt{1+\\varepsilon}} \\sin(\\pi\\sqrt{1+\\varepsilon})$。要使该式对所有 $s$ 都为零，我们需要 $\\sin(\\pi\\sqrt{1+\\varepsilon}) = 0$。但这要求 $\\sqrt{1+\\varepsilon}$ 是一个整数。对于小的正数 $\\varepsilon$，$\\sqrt{1+\\varepsilon}$ 略大于 1 但不是整数。因此，$\\sin(\\pi\\sqrt{1+\\varepsilon}) \\neq 0$，这意味着 $y(\\pi; s) = 0$ 仅当 $s=0$ 时成立。该性质没有被保持。该陈述不正确。\n\n**F. 满足两个边界条件的函数空间是一维的，且由 $\\{A \\sin x : A \\in \\mathbb{R}\\}$ 给出，因此 $s$ 扮演了自由振幅参数的角色。**\n如选项 C 的分析所示，满足 BVP 的解空间是由基函数 $\\sin(x)$ 张成的一维向量空间。IVP 的解 $y(x; s) = s \\sin(x)$ 表明，初始斜率 $s$ 直接对应于解的振幅 $A$。由于任何振幅都产生一个有效解，所以 $s$ 是一个自由参数。该陈述正确。",
            "answer": "$$\\boxed{ACDF}$$"
        },
        {
            "introduction": "现在，我们将理论洞察与实际编程技能相结合，来解决一个更具普遍性和挑战性的非线性问题 。这个练习要求我们从头开始实现打靶法，这不仅涉及数值积分和选择稳健的求根算法，还需要处理非线性动力学中常见的实际问题，例如解在有限时间内“爆破”（blow-up）。这个综合性实践将巩固你对打靶法全过程的理解，是从理论走向实际应用的关键一步。",
            "id": "3192271",
            "problem": "考虑区间 $[0,1]$ 上的标量函数 $y(x)$ 的边值问题 (BVP)，该问题由二阶常微分方程 $y''(x)=y(x)^3$ 和边界条件 $y(0)=0$ 及 $y(1)=B$ 给出，其中 $B$ 是一个实数参数。打靶法将此 BVP 简化为求解一个具有未知初始斜率 $s=y'(0)$ 的初值问题，并定义一个残差映射 $F(s)=y(1;s)-B$，其中 $y(x;s)$ 表示初值问题 $y''=y^3$, $y(0)=0$, $y'(0)=s$ 的解。BVP 的一个解对应于 $F(s)=0$ 的一个根。从常微分方程和打靶法的基本定义出发，并利用微积分中经过充分检验的事实（从可分离形式推导出的能量积分和单调性），推导映射 $s\\mapsto y(1;s)$ 对于非线性方程 $y''=y^3$ 的定性行为。特别地，讨论对于一个固定的 $B$，是否可以有多个不同的 $s$ 值满足 $y(1)=B$，并探讨一个鲁棒的求根算法如何处理可能的多解分支。\n\n你的程序必须：\n- 通过数值积分初值问题 $y'(x)=v(x)$、$v'(x)=y(x)^3$（其中 $y(0)=0$ 和 $v(0)=s$）到 $x=1$ 来实现打靶法，并计算 $F(s)=y(1;s)-B$。\n- 使用一个基于区间划定的求根器来求解 $F(s)=0$ 以得到 $s$，并自适应地扩展区间以确保符号改变。\n- 对于下面指定的每个测试用例，计算满足 $x=1$ 处边界条件的初始斜率 $s$ 的数值近似值。\n\n此问题不涉及物理单位。不使用角度。所有数值答案必须是浮点数。\n\n测试套件：\n1. $B=0$ (边界情况)。\n2. $B=0.5$ (正幅值，一般情况)。\n3. $B=-0.5$ (负幅值，对称分支)。\n4. $B=2.0$ (较大幅值)。\n5. $B=-2.0$ (较大负幅值)。\n\n最终输出格式：\n- 你的程序应生成单行输出，其中包含五个测试用例计算出的 $s$ 值，形式为逗号分隔的列表，并用方括号括起来，每个值四舍五入到六位小数 (例如, $[s_1,s_2,s_3,s_4,s_5]$)。",
            "solution": "本题要求对边值问题 $y''(x) = y(x)^3$, $y(0)=0$, $y(1)=B$ 进行分析和数值求解。核心在于理解打靶函数 $g(s) = y(1;s)$ 的性质，该函数将初始斜率 $s=y'(0)$ 映射到最终位置 $y(1;s)$。\n\n#### 映射 $s \\mapsto y(1;s)$ 的定性分析\n\n**1. 能量积分和符号行为**\n我们可以通过将 ODE $y'' = y^3$ 乘以 $y'$ 并对 $x$ 从 $0$ 积分到 $x$ 来推导其第一积分（能量积分）：\n$$ \\int_0^x y'(\\tau) y''(\\tau) d\\tau = \\int_0^x y(\\tau)^3 y'(\\tau) d\\tau $$\n$$ \\frac{1}{2}(y'(x))^2 - \\frac{1}{2}(y'(0))^2 = \\frac{1}{4}y(x)^4 - \\frac{1}{4}y(0)^4 $$\n利用初始条件 $y(0)=0$ 和 $y'(0)=s$，我们得到“能量守恒”定律：\n$$ (y'(x))^2 = \\frac{1}{2}y(x)^4 + s^2 $$\n从这个关系中，我们可以推断解 $y(x;s)$ 的符号：\n-   如果 $s=0$，则 $(y')^2 = \\frac{1}{2}y^4$。在初始条件 $y(0)=0, y'(0)=0$ 下，唯一解是平凡解 $y(x;0) = 0$。因此，$g(0) = y(1;0) = 0$。\n-   如果 $s > 0$，则 $y'(0) > 0$。由于 $\\frac{1}{2}y^4 + s^2$ 始终为正，$y'(x)$ 永远不能为零，因此保持其初始的正号。所以，对于 $s>0$，$y'(x)>0$ 对所有 $x$ 成立。这意味着 $y(x;s)$ 是严格递增的，且对于 $x>0$，$y(x;s) > 0$。因此，$g(s) = y(1;s) > 0$。\n-   如果 $s  0$，则 $y'(0)  0$。同样，$y'(x)$ 必须保持负值，函数 $y(x;s)$ 严格递减，且对于 $x>0$，$y(x;s)  0$。因此，$g(s) = y(1;s)  0$。\n总结：函数 $g(s)$ 与 $s$ 具有相同的符号。\n\n**2. 单调性和解的唯一性**\n为了确定是否存在多个 $s$ 值可以导致相同的 $y(1)=B$，我们分析 $g(s)$ 的导数 $g'(s) = \\frac{d}{ds}y(1;s)$。令 $z(x;s) = \\frac{\\partial y}{\\partial s}(x;s)$。我们可以通过对原始 IVP 关于 $s$ 求导来得到 $z$ 所满足的变分方程：\n-   **ODE**: $\\frac{\\partial}{\\partial s}(y'' - y^3) = 0 \\implies z'' - 3y^2 z = 0$，即 $z''(x) = 3y(x;s)^2 z(x)$。\n-   **初始条件**: $z(0) = \\frac{\\partial}{\\partial s}y(0;s) = 0$，$z'(0) = \\frac{\\partial}{\\partial s}y'(0;s) = 1$。\n这是一个关于 $z(x)$ 的线性齐次 ODE。其系数 $3y(x;s)^2$ 始终是非负的。由于 $z(0)=0$ 和 $z'(0)=1$，$z(x)$ 从零点以正斜率开始。对于 $x > 0$，只要 $z(x)>0$，则 $z''(x) \\ge 0$，表明 $z(x)$ 是凸函数。一个从 0 开始且初始斜率为正的凸函数，对于所有 $x>0$ 必为正。因此，$z(x;s) > 0$ 对所有 $x>0$ 成立。\n特别地，在 $x=1$ 处，我们有 $g'(s) = z(1;s) > 0$。由于 $g(s)$ 的导数始终为正，函数 $g(s)=y(1;s)$ 在其定义域上是严格单调递增的。\n**结论**: 对于任何给定的实数 $B$，方程 $y(1;s)=B$ 最多只有一个解 $s$。不存在多解分支。\n\n**3. 有限时间爆破与鲁棒求根**\n能量积分可分离为 $dx = \\frac{dy}{\\sqrt{\\frac{1}{2}y^4+s^2}}$ (对于 $s>0$)。达到状态 $y$ 所需的时间 $x(y) = \\int_0^y \\frac{d\\tilde{y}}{\\sqrt{\\frac{1}{2}\\tilde{y}^4+s^2}}$。当 $y \\to \\infty$ 时，该积分收敛到一个有限值 $x_{bu}(s)$，这意味着解在有限的 $x$ 处会爆破（blow-up）到无穷大。$|s|$ 越大，解增长越快，$x_{bu}(s)$ 就越小。\n这意味着存在一个临界值 $|s_{crit}|$ 使得 $x_{bu}(|s_{crit}|)=1$。对于任何 $|s| \\ge |s_{crit}|$，IVP 的解在 $x=1$ 或之前发散。因此，$g(s)$ 的定义域是开区间 $(-s_{crit}, s_{crit})$。在此定义域内，$g(s)$ 从 $-\\infty$ 严格递增到 $+\\infty$。这确保了对于任何有限的 $B$，都存在且仅存在一个 $s$ 值满足 $y(1;s)=B$。\n一个鲁棒的求根算法应能处理 $g(s)$ 的有限定义域。当数值积分失败时，可以将其解释为 $y(1;s)$ 是无穷大，这有助于界定根的范围。\n\n**4. 对称性**\n令 $u(x)$ 是 IVP $u''=u^3, u(0)=0, u'(0)=-s$ 的解。令 $v(x) = -u(x)$。则 $v(0)=0$，$v'(0)=-u'(0)=s$，且 $v''(x) = -u''(x) = -u^3(x) = -(-v(x))^3 = v^3(x)$。因此，$v(x)$ 与 $y(x;s)$ 求解的是同一个 IVP。根据解的唯一性，$y(x;s)=v(x)=-u(x)$。由于 $u(x)$ 根据定义是 $y(x;-s)$，我们有恒等式 $y(x;s) = -y(x;-s)$。在 $x=1$ 处，这给出 $g(s) = -g(-s)$，表明 $g(s)$ 是一个奇函数。这意味着如果 $s_B$ 是 $y(1)=B$ 的解，那么 $-s_B$ 就是 $y(1)=-B$ 的解。\n\n#### 数值实现\n基于此分析，数值方法如下：\n1.  将二阶 ODE 表示为一个一阶系统：令 $\\mathbf{u} = [y, v]^T = [y, y']^T$。则 $\\mathbf{u}' = [v, y^3]^T$。初始条件为 $\\mathbf{u}(0) = [0, s]^T$。\n2.  对于给定的 $B$，定义残差函数 $F(s) = y(1;s) - B$。该函数使用数值积分器（如 `scipy.integrate.solve_ivp`）来计算 $y(1;s)$。\n3.  实现一个自适应的区间搜索来寻找包含根的区间 $[s_a, s_b]$。搜索必须能正确处理积分失败（爆破）的情况。\n4.  使用一个鲁棒的区间求根器，如 Brent 方法（`scipy.optimize.root_scalar` 并设置 `method='brentq'`），在确定的区间内找到唯一的根。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\nfrom scipy.optimize import root_scalar\n\ndef solve():\n    \"\"\"\n    Computes the initial slope 's' for a BVP using the shooting method\n    for several boundary values 'B'.\n    \"\"\"\n    test_cases = [0.0, 0.5, -0.5, 2.0, -2.0]\n    results = []\n\n    for B in test_cases:\n        # For the trivial boundary condition B=0, the solution is y(x)=0,\n        # which corresponds to an initial slope s=0.\n        if B == 0.0:\n            results.append(0.0)\n            continue\n\n        def residual_map(s, B_val):\n            \"\"\"\n            Computes the residual F(s) = y(1;s) - B.\n            This function defines the shooting problem to be solved.\n            \"\"\"\n            # For s=0, we know y(1;0)=0 without integration.\n            if s == 0.0:\n                y_at_1 = 0.0\n            else:\n                # Define the ODE system for the integrator.\n                # Let u = [y, y'], so u' = [y', y''] = [y', y^3].\n                def ode_system(t, u):\n                    return [u[1], u[0]**3]\n\n                u0 = [0.0, s]  # Initial conditions: y(0)=0, y'(0)=s\n                t_span = [0.0, 1.0]\n\n                # Numerically integrate the IVP from x=0 to x=1.\n                sol = solve_ivp(\n                    ode_system,\n                    t_span,\n                    u0,\n                    method='RK45',\n                    atol=1e-9,  # Use tight tolerances for accuracy.\n                    rtol=1e-9,\n                    max_step=0.01  # Prevent solver from stepping over singularity.\n                )\n                \n                # If integration fails, it implies a finite-time blow-up.\n                # We treat y(1) as infinite, helping to bound the root.\n                if sol.status != 0:\n                    return np.sign(s) * np.inf\n                \n                y_at_1 = sol.y[0, -1]\n\n            return y_at_1 - B_val\n\n        # --- Adaptive Bracketing Strategy ---\n        # Based on the qualitative analysis, s must have the same sign as B.\n        s_a, s_b = None, None\n        \n        if B > 0:\n            # We need an s > 0. The bracket will be [0, s_b].\n            # F(0, B) = -B  0.\n            s_a = 0.0\n            s_b_guess = 0.1  # Start with a small positive guess for s.\n            max_iter = 20\n            for _ in range(max_iter):\n                f_b = residual_map(s_b_guess, B)\n                # Success if f_b is positive (or +inf, meaning we passed the blow-up point).\n                if f_b > 0:\n                    s_b = s_b_guess\n                    break\n                s_b_guess *= 2.0  # Expand the search interval.\n            else:\n                raise RuntimeError(f\"Could not find an upper bracket for B={B}\")\n        \n        else:  # B  0\n            # We need an s  0. The bracket will be [s_a, 0].\n            # F(0, B) = -B > 0.\n            s_b = 0.0\n            s_a_guess = -0.1 # Start with a small negative guess for s.\n            max_iter = 20\n            for _ in range(max_iter):\n                f_a = residual_map(s_a_guess, B)\n                # Success if f_a is negative (or -inf).\n                if f_a  0:\n                    s_a = s_a_guess\n                    break\n                s_a_guess *= 2.0\n            else:\n                raise RuntimeError(f\"Could not find a lower bracket for B={B}\")\n        \n        # Use a robust bracketing root-finder (Brent's method).\n        sol_root = root_scalar(residual_map, args=(B,), bracket=[s_a, s_b], method='brentq')\n        results.append(sol_root.root)\n\n    # Format and print the final output as a single-line list.\n    print(f\"[{','.join([f'{r:.6f}' for r in results])}]\")\n\nsolve()\n\n```"
        }
    ]
}