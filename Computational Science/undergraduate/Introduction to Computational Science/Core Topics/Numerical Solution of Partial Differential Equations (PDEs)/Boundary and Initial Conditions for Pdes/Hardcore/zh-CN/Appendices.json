{
    "hands_on_practices": [
        {
            "introduction": "偏微分方程的解不仅要满足方程本身，还必须符合其边界约束。本练习将通过经典的一维热传导方程，让您亲身体验如何通过施加狄利克雷边界条件（固定边界温度）来确定解的关键参数。这项实践清晰地展示了物理系统的边界如何“筛选”出特定的解（即模态），这是理解许多物理现象的基础。",
            "id": "945",
            "problem": "考虑一维热方程，它描述了热量 $u(x, t)$ 在一根细长均匀杆中随时间的分布：\n$$\n\\frac{\\partial u}{\\partial t} = \\alpha \\frac{\\partial^2 u}{\\partial x^2}\n$$\n其中，$u(x, t)$ 是位置 $x$ 和时间 $t$ 处的温度，$\\alpha$ 是杆的常数热扩散率。杆的长度有限，为 $L$，从 $x=0$ 延伸到 $x=L$。\n\n在所有时间 $t \\ge 0$ 内，杆的两端保持恒定的零温度。这被称为齐次狄利克雷边界条件：\n1.  $u(0, t) = 0$\n2.  $u(L, t) = 0$\n\n一个提出的关于温度分布的非平凡解具有以下形式：\n$$\nu(x, t) = A \\exp(-\\lambda t) \\sin(kx)\n$$\n其中 $A$、$\\lambda$ 和 $k$ 是正常数，且 $A \\neq 0$。\n\n你的任务是求解该解的基模所对应的衰减常数 $\\lambda$ 的具体值。基模对应于满足给定边界条件的最小可能正波数 $k$。\n\n推导 $\\lambda$ 关于热扩散率 $\\alpha$ 和杆长 $L$ 的表达式。",
            "solution": "问题要求解在一维热方程的特定狄利克雷边界条件下，一个提出的解的基模所对应的衰减常数 $\\lambda$ 的值。推导过程主要分为三个部分：首先，确保函数满足偏微分方程（PDE），以找到常数之间的关系；其次，应用边界条件来确定 $k$ 的允许值；第三，结合这些结果来找到 $\\lambda$ 的具体值。\n\n**第一部分：满足热方程**\n\n我们从提出的解开始：\n$$\nu(x, t) = A \\exp(-\\lambda t) \\sin(kx)\n$$\n我们需要计算它关于 $t$ 和 $x$ 的偏导数，并将它们代入热方程 $\\frac{\\partial u}{\\partial t} = \\alpha \\frac{\\partial^2 u}{\\partial x^2}$。\n\n首先，关于时间 $t$ 的偏导数是：\n$$\n\\frac{\\partial u}{\\partial t} = \\frac{\\partial}{\\partial t} \\left[ A e^{-\\lambda t} \\sin(kx) \\right] = -A\\lambda e^{-\\lambda t} \\sin(kx)\n$$\n\n接下来，我们计算关于位置 $x$ 的偏导数。一阶偏导数是：\n$$\n\\frac{\\partial u}{\\partial x} = \\frac{\\partial}{\\partial x} \\left[ A e^{-\\lambda t} \\sin(kx) \\right] = Ak e^{-\\lambda t} \\cos(kx)\n$$\n\n关于 $x$ 的二阶偏导数是：\n$$\n\\frac{\\partial^2 u}{\\partial x^2} = \\frac{\\partial}{\\partial x} \\left[ Ak e^{-\\lambda t} \\cos(kx) \\right] = -Ak^2 e^{-\\lambda t} \\sin(kx)\n$$\n\n现在，我们将这些导数代入热方程：\n$$\n\\frac{\\partial u}{\\partial t} = \\alpha \\frac{\\partial^2 u}{\\partial x^2}\n$$\n$$\n-A\\lambda e^{-\\lambda t} \\sin(kx) = \\alpha \\left( -Ak^2 e^{-\\lambda t} \\sin(kx) \\right)\n$$\n\n对于非平凡解，$A \\neq 0$。项 $e^{-\\lambda t} \\sin(kx)$ 并非对所有 $x$ 和 $t$ 都为零。因此，我们可以将等式两边同除以 $-A e^{-\\lambda t} \\sin(kx)$：\n$$\n\\lambda = \\alpha k^2\n$$\n这就是给定函数成为热方程解时，$\\lambda$ 和 $k$ 之间所需满足的关系。\n\n**第二部分：应用边界条件**\n\n现在我们应用狄利克雷边界条件来找到 $k$ 的允许值。\n\n第一个边界条件是 $u(0, t) = 0$：\n$$\nu(0, t) = A e^{-\\lambda t} \\sin(k \\cdot 0) = A e^{-\\lambda t} \\sin(0) = A e^{-\\lambda t} \\cdot 0 = 0\n$$\n对于 $A$、$\\lambda$ 和 $k$ 的任何值，此条件都满足。\n\n第二个边界条件是 $u(L, t) = 0$：\n$$\nu(L, t) = A e^{-\\lambda t} \\sin(kL) = 0\n$$\n因为我们寻找的是非平凡解，所以必须有 $A \\neq 0$。指数项 $e^{-\\lambda t}$ 对于所有有限的 $t$ 也非零。因此，要使方程成立，唯一的途径是正弦项为零：\n$$\n\\sin(kL) = 0\n$$\n\n正弦函数在其参数为 $\\pi$ 的整数倍时为零。因此：\n$$\nkL = n\\pi, \\quad \\text{for } n \\in \\mathbb{Z}\n$$\n解出 $k$，我们得到：\n$$\nk = \\frac{n\\pi}{L}\n$$\n由于 $k$ 是一个正常数，所以 $n$ 必须是正整数，即 $n = 1, 2, 3, \\ldots$。$n=0$ 的情况将意味着 $k=0$，这会使 $u(x,t)=0$，即一个平凡解。\n\n**第三部分：求解基模的 $\\lambda$**\n\n问题要求的是与基模相对应的 $\\lambda$，基模是具有最小可能正值 $k$ 的模式。从表达式 $k = \\frac{n\\pi}{L}$ 可知，$k$ 的最小正值出现在 $n$ 取最小正整数值时，即 $n=1$。\n\n我们称这个基波波数为 $k_1$：\n$$\nk_1 = \\frac{(1)\\pi}{L} = \\frac{\\pi}{L}\n$$\n\n最后，我们使用在第一部分中推导出的关系 $\\lambda = \\alpha k^2$ 来找到对应的 $\\lambda$ 值。代入 $k = k_1 = \\frac{\\pi}{L}$：\n$$\n\\lambda = \\alpha \\left(\\frac{\\pi}{L}\\right)^2\n$$\n$$\n\\lambda = \\frac{\\alpha \\pi^2}{L^2}\n$$\n这就是该解的基模所对应的衰减常数的值。",
            "answer": "$$\\boxed{\\frac{\\alpha \\pi^2}{L^2}}$$"
        },
        {
            "introduction": "与依赖持续边界约束的扩散问题不同，波动现象的演化在很大程度上由其初始状态决定。本练习将运用求解一维波动方程的强大工具——达朗贝尔公式，来处理一个初始值问题。通过对给定的初始速度分布进行积分，您将精确计算出系统在未来某一特定时刻的状态，从而加深对初始条件如何决定波的传播和演化的理解。",
            "id": "934",
            "problem": "考虑函数 $u(x,t)$ 的一维波动方程：\n$$\n\\frac{\\partial^2 u}{\\partial t^2} = c^2 \\frac{\\partial^2 u}{\\partial x^2}\n$$\n该方程描述了一根无限长振动弦的位移。在无限域 ($-\\infty  x  \\infty$) 上的一个初值问题的通解由 d'Alembert 公式给出：\n$$\nu(x,t) = \\frac{1}{2}[f(x+ct) + f(x-ct)] + \\frac{1}{2c} \\int_{x-ct}^{x+ct} g(s) \\, ds\n$$\n其中 $f(x) = u(x,0)$ 是初始位移，$g(x) = u_t(x,0)$ 是初始速度。\n\n假设波速为 $c=1$。弦最初处于其平衡位置，即对所有 $x$ 都有 $f(x)=0$。给弦一个由 $g(x) = 2\\cos(x)$ 描述的初始速度分布。\n\n推导弦在任意位置 $x$ 和特定时间 $t=\\pi$ 时的位移。也就是说，求出 $u(x, \\pi)$ 的表达式。",
            "solution": "我们从 d'Alembert 公式开始，其中 $c=1$，$f(x)=0$，$g(x)=2\\cos x$：\n$$\nu(x,t)\n= \\frac12\\bigl[f(x+t)+f(x-t)\\bigr]\n  + \\frac1{2}\\int_{\\,x-t}^{\\,x+t}g(s)\\,ds\n= \\frac1{2}\\int_{x-t}^{x+t}2\\cos s\\,ds.\n$$\n计算该积分，\n$$\nu(x,t)\n= \\int_{x-t}^{x+t}\\cos s\\,ds\n= \\sin s\\Big|_{s=x-t}^{s=x+t}\n= \\sin(x+t)-\\sin(x-t).\n$$\n使用和差化积公式，\n$$\n\\sin(x+t)-\\sin(x-t)\n= 2\\cos\\bigl(\\tfrac{(x+t)+(x-t)}2\\bigr)\\,\n  \\sin\\bigl(\\tfrac{(x+t)-(x-t)}2\\bigr)\n= 2\\cos x\\,\\sin t.\n$$\n因此，当 $t=\\pi$ 时，\n$$\nu(x,\\pi)=2\\cos x\\,\\sin\\pi=2\\cos x\\cdot 0=0.\n$$",
            "answer": "$$\\boxed{0}$$"
        },
        {
            "introduction": "当解析解不可行时，数值方法成为求解偏微分方程的关键，而正确处理边界条件是保证计算精度的核心。本练习要求您分析并对比两种主流的数值方法——有限体积法和有限差分法——在处理诺伊曼边界条件（即指定边界梯度或通量）时的差异。通过推导，您将揭示不同的离散化策略对质量守恒这一基本物理原则的影响，这是构建可靠计算模型时必须掌握的关键技能。",
            "id": "3103155",
            "problem": "考虑空间区间 $[0,L]$ 上的一维对流扩散偏微分方程（PDE），其中对流速度 $a0$ 和扩散系数 $D0$ 为常数，\n$$\nu_t + a\\,u_x = D\\,u_{xx},\n$$\n该方程满足光滑的初始条件 $u(x,0) = u_0(x)$ 和与时间相关的 Neumann 边界条件 $u_x(0,t) = g_0(t)$ 及 $u_x(L,t) = g_L(t)$。此处，$u(x,t)$ 表示守恒标量场，$g_0(t)$ 和 $g_L(t)$ 分别是在 $x=0$ 和 $x=L$ 处给定的边界法向梯度。该方程的守恒律形式为 $u_t + F_x = 0$，其中物理通量为 $F(x,t) = a\\,u(x,t) - D\\,u_x(x,t)$。\n\n用包含 $N$ 个单元的均匀网格对区域进行离散化，网格间距为 $\\Delta x = L/N$，并定义离散总质量 $M(t) = \\Delta x \\sum_{i=1}^{N} u_i(t)$。\n\n考虑两种半离散方法：\n\n- 有限体积法（FV）：有限体积法（FV）使用单元平均值 $u_i(t)$ 和面通量 $F_{i+1/2}$。对于内部面，使用 $F_{i+1/2} = a\\,u^{\\mathrm{up}}_{i+1/2} - D\\,\\frac{u_{i+1} - u_i}{\\Delta x}$，其中迎风状态 $u^{\\mathrm{up}}_{i+1/2}$ 与 $a0$ 一致。在左边界的面，设 $F_{1/2}(t) = a\\,u_{\\mathrm{in}}(t) - D\\,g_0(t)$，其中 $u_{\\mathrm{in}}(t)$ 是在 $x=0$ 处提供的入流值。在右边界的面，设 $F_{N+1/2}(t) = a\\,u_N(t) - D\\,g_L(t)$。半离散的 FV 更新格式为 $\\Delta x\\,\\frac{d}{dt}u_i + \\left(F_{i+1/2} - F_{i-1/2}\\right) = 0$。\n\n- 有限差分法（FD）：有限差分法（FD）使用内部网格点上的点值 $u_i(t)$，并对对流和扩散项使用中心差分，\n$$\n\\frac{d}{dt}u_i = -a\\,\\frac{u_{i+1} - u_{i-1}}{2\\,\\Delta x} + D\\,\\frac{u_{i+1} - 2\\,u_i + u_{i-1}}{\\Delta x^2}, \\quad i=1,\\dots,N.\n$$\n使用一阶虚拟单元（ghost-cell）封闭来实施 Neumann 边界条件：$u_0(t) = u_1(t) - \\Delta x\\,g_0(t)$ 和 $u_{N+1}(t) = u_N(t) + \\Delta x\\,g_L(t)$。\n\n假设 FV 的入流状态被选择为与第一个内部值相匹配，即 $u_{\\mathrm{in}}(t) = u_1(t)$。从守恒律基础 $u_t + F_x = 0$ 和给定的离散定义出发，推导 FV 和 FD 两种方法的边界通量和半离散总质量变化率 $\\frac{d}{dt}M(t)$。然后，根据所述假设，计算差异\n$$\n\\Delta \\equiv \\left(\\frac{d}{dt}M\\right)_{\\mathrm{FD}} - \\left(\\frac{d}{dt}M\\right)_{\\mathrm{FV}}\n$$\n的闭式表达式，用 $a$、$\\Delta x$、$g_0(t)$ 和 $g_L(t)$ 表示。提供 $\\Delta$ 的最终表达式作为您的答案。",
            "solution": "任务是推导 $\\Delta \\equiv \\left(\\frac{d}{dt}M\\right)_{\\mathrm{FD}} - \\left(\\frac{d}{dt}M\\right)_{\\mathrm{FV}}$ 的表达式。这需要分别为每种方法计算离散总质量的变化率 $\\frac{dM}{dt}$。\n\n离散总质量的定义是 $M(t) = \\Delta x \\sum_{i=1}^{N} u_i(t)$。其时间导数为：\n$$\n\\frac{dM}{dt} = \\frac{d}{dt} \\left( \\Delta x \\sum_{i=1}^{N} u_i(t) \\right) = \\Delta x \\sum_{i=1}^{N} \\frac{du_i}{dt}\n$$\n\n**1. 有限体积法 (FV) 的推导**\n\n半离散 FV 方程由 $\\Delta x\\,\\frac{d}{dt}u_i = -(F_{i+1/2} - F_{i-1/2})$ 给出。我们将其代入 $\\frac{dM}{dt}$ 的表达式中：\n$$\n\\left(\\frac{dM}{dt}\\right)_{\\mathrm{FV}} = \\sum_{i=1}^{N} \\left( \\Delta x \\frac{du_i}{dt} \\right) = \\sum_{i=1}^{N} -(F_{i+1/2} - F_{i-1/2})\n$$\n这个和是一个伸缩级数：\n$$\n\\sum_{i=1}^{N} -(F_{i+1/2} - F_{i-1/2}) = -[(F_{3/2} - F_{1/2}) + (F_{5/2} - F_{3/2}) + \\dots + (F_{N+1/2} - F_{N-1/2})]\n$$\n所有内部通量 $F_{i+1/2}$（对于 $i=1, \\dots, N-1$）相互抵消，只剩下边界通量：\n$$\n\\left(\\frac{dM}{dt}\\right)_{\\mathrm{FV}} = -(F_{N+1/2} - F_{1/2}) = F_{1/2}(t) - F_{N+1/2}(t)\n$$\n这证明了 FV 格式的精确守恒性质，即总质量的变化仅由通过区域边界的通量引起。现在，我们代入给定的边界通量表达式，$F_{1/2}(t) = a\\,u_{\\mathrm{in}}(t) - D\\,g_0(t)$ 和 $F_{N+1/2}(t) = a\\,u_N(t) - D\\,g_L(t)$。我们还应用给定的假设，即入流值为 $u_{\\mathrm{in}}(t) = u_1(t)$：\n$$\nF_{1/2}(t) = a\\,u_1(t) - D\\,g_0(t)\n$$\n因此，FV 法的总质量变化率为：\n$$\n\\left(\\frac{dM}{dt}\\right)_{\\mathrm{FV}} = [a\\,u_1(t) - D\\,g_0(t)] - [a\\,u_N(t) - D\\,g_L(t)]\n$$\n$$\n\\left(\\frac{dM}{dt}\\right)_{\\mathrm{FV}} = a\\,(u_1(t) - u_N(t)) - D\\,(g_0(t) - g_L(t))\n$$\n\n**2. 有限差分法 (FD) 的推导**\n\n我们再次从 $\\frac{dM}{dt}$ 的定义出发，代入半离散 FD 更新规则：\n$$\n\\left(\\frac{dM}{dt}\\right)_{\\mathrm{FD}} = \\Delta x \\sum_{i=1}^{N} \\frac{du_i}{dt} = \\Delta x \\sum_{i=1}^{N} \\left( -a\\,\\frac{u_{i+1} - u_{i-1}}{2\\,\\Delta x} + D\\,\\frac{u_{i+1} - 2\\,u_i + u_{i-1}}{\\Delta x^2} \\right)\n$$\n分配求和符号和 $\\Delta x$：\n$$\n\\left(\\frac{dM}{dt}\\right)_{\\mathrm{FD}} = - \\frac{a}{2} \\sum_{i=1}^{N} (u_{i+1} - u_{i-1}) + \\frac{D}{\\Delta x} \\sum_{i=1}^{N} (u_{i+1} - 2 u_i + u_{i-1})\n$$\n我们分别计算这两个和。\n对于对流项的和：\n$$\n\\sum_{i=1}^{N} (u_{i+1} - u_{i-1}) = (u_2 - u_0) + (u_3 - u_1) + \\dots + (u_N - u_{N-2}) + (u_{N+1} - u_{N-1})\n$$\n通过重排项，我们看到大多数内部点值都抵消了。剩余的项来自求和序列的边界：\n$$\n\\sum_{i=1}^{N} (u_{i+1} - u_{i-1}) = \\left(\\sum_{i=1}^{N} u_{i+1}\\right) - \\left(\\sum_{i=1}^{N} u_{i-1}\\right) = (u_N + u_{N+1}) - (u_0 + u_1)\n$$\n对于扩散项的和，我们认识到它是一个二阶差分的和，这是一个伸缩级数：\n$$\n\\sum_{i=1}^{N} (u_{i+1} - 2 u_i + u_{i-1}) = \\sum_{i=1}^{N} [(u_{i+1} - u_i) - (u_i - u_{i-1})]\n$$\n这个和伸缩为 $(u_{N+1} - u_N) - (u_1 - u_0)$。\n现在，代入虚拟单元封闭关系：$u_0(t) = u_1(t) - \\Delta x\\,g_0(t)$ 和 $u_{N+1}(t) = u_N(t) + \\Delta x\\,g_L(t)$。\n\n对流项对 $\\frac{dM}{dt}$ 的贡献是：\n$$\n- \\frac{a}{2} [ (u_N + u_{N+1}) - (u_0 + u_1) ] = - \\frac{a}{2} [ u_N + (u_N + \\Delta x\\,g_L(t)) - (u_1 - \\Delta x\\,g_0(t)) - u_1 ]\n$$\n$$\n= - \\frac{a}{2} [ 2\\,u_N - 2\\,u_1 + \\Delta x\\,(g_0(t) + g_L(t)) ] = a\\,(u_1(t) - u_N(t)) - \\frac{a\\,\\Delta x}{2} (g_0(t) + g_L(t))\n$$\n扩散项对 $\\frac{dM}{dt}$ 的贡献是：\n$$\n\\frac{D}{\\Delta x} [ (u_{N+1} - u_N) - (u_1 - u_0) ] = \\frac{D}{\\Delta x} [ (u_N(t) + \\Delta x\\,g_L(t) - u_N(t)) - (u_1(t) - (u_1(t) - \\Delta x\\,g_0(t))) ]\n$$\n$$\n= \\frac{D}{\\Delta x} [ \\Delta x\\,g_L(t) - \\Delta x\\,g_0(t) ] = D\\,(g_L(t) - g_0(t)) = -D\\,(g_0(t) - g_L(t))\n$$\n结合这两项贡献，我们得到 FD 法的总变化率：\n$$\n\\left(\\frac{dM}{dt}\\right)_{\\mathrm{FD}} = a\\,(u_1(t) - u_N(t)) - \\frac{a\\,\\Delta x}{2} (g_0(t) + g_L(t)) - D\\,(g_0(t) - g_L(t))\n$$\n\n**3. 计算差异 $\\Delta$**\n\n最后，我们计算差值 $\\Delta = (\\frac{dM}{dt})_{\\mathrm{FD}} - (\\frac{dM}{dt})_{\\mathrm{FV}}$：\n$$\n\\Delta = \\left[ a\\,(u_1(t) - u_N(t)) - \\frac{a\\,\\Delta x}{2} (g_0(t) + g_L(t)) - D\\,(g_0(t) - g_L(t)) \\right] - \\left[ a\\,(u_1(t) - u_N(t)) - D\\,(g_0(t) - g_L(t)) \\right]\n$$\n$a\\,(u_1(t) - u_N(t))$ 和 $- D\\,(g_0(t) - g_L(t))$ 项在两个表达式中都存在，并在相减时抵消。唯一剩下的项是：\n$$\n\\Delta = - \\frac{a\\,\\Delta x}{2} (g_0(t) + g_L(t))\n$$\n这个结果表明，两种格式之间总质量变化率的差异通常不为零。它源于对流项的中心差分近似与边界条件的一阶虚拟单元实现相结合时所表现出的非守恒性。而 FV 法，根据其构造，是完全守恒的。",
            "answer": "$$\n\\boxed{- \\frac{a\\,\\Delta x}{2} (g_0(t) + g_L(t))}\n$$"
        }
    ]
}