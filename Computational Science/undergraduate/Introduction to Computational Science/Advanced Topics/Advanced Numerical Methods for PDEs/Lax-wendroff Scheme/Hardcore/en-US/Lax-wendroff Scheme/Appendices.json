{
    "hands_on_practices": [
        {
            "introduction": "The linear advection equation describes a conservation law, meaning the total amount of the quantity $u$ in a periodic domain is constant over time. A good numerical scheme should respect this property. This first practice  investigates this fundamental concept of numerical conservation for both the Lax-Wendroff and first-order upwind schemes, leading to a crucial insight into the nature of numerical error analysis.",
            "id": "2422965",
            "problem": "Consider the one-dimensional linear advection equation $u_t + a\\,u_x = 0$ on the periodic domain $x \\in [0,1]$ with constant wave speed $a  0$. Let $u(x,t)$ be advected under periodic boundary conditions, and define the continuous conserved quantity $M(t) = \\int_0^1 u(x,t)\\,dx$, which satisfies $M(t) = M(0)$ for all $t \\ge 0$.\n\nYou will study how the error in the conserved quantity scales with the spatial grid spacing $\\Delta x$ for two explicit finite difference schemes on a uniform, cell-centered grid with nodes $x_i = (i + 0.5)\\,\\Delta x$, $i = 0,1,\\dots,N-1$, and $\\Delta x = 1/N$. Time is advanced to a fixed final time $T  0$ using a constant Courant–Friedrichs–Lewy (CFL) number $\\nu = a\\,\\Delta t/\\Delta x$ chosen below. The numerical integral is defined by the composite midpoint rule $M_h(T) = \\Delta x \\sum_{i=0}^{N-1} u_i^n$, where $u_i^n$ approximates $u(x_i, n\\,\\Delta t)$ and $n$ is the final time index. The error in the conserved quantity is $E(\\Delta x) = \\left| M_h(T) - \\int_0^1 u(x,0)\\,dx \\right|$.\n\nUse the following two fully specified schemes with periodic indexing (so that $u_{-1}^n \\equiv u_{N-1}^n$ and $u_{N}^n \\equiv u_0^n$):\n- First-order upwind for $a0$:\n$$\nu_i^{n+1} = u_i^n - \\nu \\left(u_i^n - u_{i-1}^n\\right).\n$$\n- Second-order Lax–Wendroff:\n$$\nu_i^{n+1} = u_i^n - \\frac{\\nu}{2}\\left(u_{i+1}^n - u_{i-1}^n\\right) + \\frac{\\nu^2}{2}\\left(u_{i+1}^n - 2u_i^n + u_{i-1}^n\\right).\n$$\n\nInitialize $u(x,0)$ with each of the following profiles (all functions of $x \\in [0,1]$), and advance the solution to time $T$:\n- Smooth Gaussian: $u(x,0) = \\exp\\!\\left(-\\frac{(x-\\mu)^2}{2\\sigma^2}\\right)$ with $\\mu = 0.5$ and $\\sigma = 0.07$. Its exact integral over $[0,1]$ is\n$$\n\\int_0^1 \\exp\\!\\left(-\\frac{(x-\\mu)^2}{2\\sigma^2}\\right)\\,dx \\;=\\; \\sqrt{\\frac{\\pi}{2}}\\,\\sigma\\,\\left[ \\operatorname{erf}\\!\\left(\\frac{1-\\mu}{\\sqrt{2}\\,\\sigma}\\right) - \\operatorname{erf}\\!\\left(\\frac{-\\mu}{\\sqrt{2}\\,\\sigma}\\right) \\right].\n$$\n- Discontinuous top-hat: $u(x,0) = 1$ for $|x - x_c| \\le w/2$ and $u(x,0)=0$ otherwise, with $x_c = 0.5$ and $w = 0.23$. Its exact integral over $[0,1]$ is\n$$\n\\int_0^1 u(x,0)\\,dx \\;=\\; w.\n$$\n\nUse the following fixed parameters for all runs: $a = 1.0$, $T = 0.3$, and target CFL number $\\nu_\\star = 0.8$. For a given $N$, set $\\Delta x = 1/N$, choose an initial time step $\\Delta t = \\nu_\\star \\Delta x / a$, then set the number of steps $n_{\\text{steps}} = \\lceil T / \\Delta t \\rceil$, and finally use $\\Delta t = T / n_{\\text{steps}}$ in the actual time stepping so that the final time is exactly $T$. The resulting CFL is $\\nu = a\\,\\Delta t/\\Delta x$.\n\nFor each initial condition, compute $E(\\Delta x)$ for grid sizes $N \\in \\{48,96,192,384\\}$ for both schemes. For each initial condition and for each scheme, estimate the observed order $p$ by a least-squares fit of $\\log(E)$ versus $\\log(\\Delta x)$ over the four grid sizes; $p$ is the best-fit slope.\n\nTest suite:\n- Case $1$: Smooth Gaussian with $\\mu=0.5$, $\\sigma=0.07$; $a=1.0$; $T=0.3$; $\\nu_\\star=0.8$; $N \\in \\{48,96,192,384\\}$.\n- Case $2$: Discontinuous top-hat with $x_c=0.5$, $w=0.23$; $a=1.0$; $T=0.3$; $\\nu_\\star=0.8$; $N \\in \\{48,96,192,384\\}$.\n\nYour program must produce four floating-point outputs in the following order:\n$[p_{\\text{upwind,Gaussian}}, p_{\\text{LW,Gaussian}}, p_{\\text{upwind,TopHat}}, p_{\\text{LW,TopHat}}]$,\nrounded to two decimal places.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $[1.23,2.01,0.99,2.00]$). There are no physical units in this problem, and no angles are involved.",
            "solution": "The problem statement is subjected to validation and is found to be valid. It is scientifically grounded, well-posed, and contains all necessary information for a unique solution. The problem is an investigation into the numerical conservation properties of finite difference schemes for a hyperbolic conservation law.\n\nThe governing partial differential equation is the linear advection equation,\n$$\n\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = 0\n$$\nwhere the wave speed $a$ is a positive constant. This equation describes a quantity $u(x,t)$ that is transported with velocity $a$ without changing its shape. A direct consequence of this for a periodic domain $x \\in [0,1]$ is the conservation of the total mass or integral of $u$,\n$$\nM(t) = \\int_0^1 u(x,t)\\,dx\n$$\nwhich remains constant in time, i.e., $dM/dt = 0$, so $M(t) = M(0)$ for all $t \\ge 0$.\n\nThe problem provides two explicit finite difference schemes for numerical solution: the first-order upwind scheme and the second-order Lax-Wendroff scheme. A critical property of a numerical scheme for a conservation law is whether it is itself \"conservative\". A scheme is conservative if it can be written in the flux-difference form:\n$$\nu_i^{n+1} = u_i^n - \\frac{\\Delta t}{\\Delta x} \\left( f_{i+1/2}^n - f_{i-1/2}^n \\right)\n$$\nwhere $f_{i+1/2}^n$ is the numerical flux between cell $i$ and cell $i+1$.\n\nLet us verify this property for the given schemes.\nFor the first-order upwind scheme with $a0$:\n$$\nu_i^{n+1} = u_i^n - \\nu \\left(u_i^n - u_{i-1}^n\\right) = u_i^n - \\frac{a \\Delta t}{\\Delta x} \\left(u_i^n - u_{i-1}^n\\right)\n$$\nThis corresponds to a numerical flux $f_{i+1/2}^n = a u_i^n$. The scheme is conservative.\n\nFor the second-order Lax-Wendroff scheme:\n$$\nu_i^{n+1} = u_i^n - \\frac{\\nu}{2}\\left(u_{i+1}^n - u_{i-1}^n\\right) + \\frac{\\nu^2}{2}\\left(u_{i+1}^n - 2u_i^n + u_{i-1}^n\\right)\n$$\nThis scheme can also be written in flux-difference form with the numerical flux\n$$\nf_{i+1/2}^n = \\frac{a}{2}\\left(u_i^n + u_{i+1}^n\\right) - \\frac{a^2 \\Delta t}{2 \\Delta x}\\left(u_{i+1}^n - u_i^n\\right)\n$$\nThus, the Lax-Wendroff scheme is also conservative.\n\nFor any conservative scheme on a periodic domain, the discrete total mass is exactly conserved. To show this, we sum the update rule over all grid points $i = 0, \\dots, N-1$:\n$$\n\\sum_{i=0}^{N-1} u_i^{n+1} = \\sum_{i=0}^{N-1} u_i^n - \\frac{\\Delta t}{\\Delta x} \\sum_{i=0}^{N-1} \\left( f_{i+1/2}^n - f_{i-1/2}^n \\right)\n$$\nThe second sum on the right-hand side is a telescoping series. Due to the specified periodic boundary conditions ($u_N^n \\equiv u_0^n$, $u_{-1}^n \\equiv u_{N-1}^n$), the numerical flux is also periodic on the dual grid, so $f_{N-1+1/2}^n = f_{N+1/2}^n \\equiv f_{1/2}^n$ and $f_{0-1/2}^n = f_{-1/2}^n \\equiv f_{N-1/2}^n$. The sum evaluates to zero:\n$$\n\\sum_{i=0}^{N-1} \\left( f_{i+1/2}^n - f_{i-1/2}^n \\right) = (f_{1/2} - f_{-1/2}) + (f_{3/2} - f_{1/2}) + \\dots + (f_{N+1/2} - f_{N-1/2}) = 0\n$$\nTherefore, $\\sum_{i=0}^{N-1} u_i^{n+1} = \\sum_{i=0}^{N-1} u_i^n$. Multiplying by the constant grid spacing $\\Delta x$, we find that the numerical integral $M_h(t) = \\Delta x \\sum_{i=0}^{N-1} u_i^n$ is invariant in time.\n$$\nM_h(T) = M_h((n_{\\text{steps}})\\Delta t) = M_h(0)\n$$\nThe problem asks for the error $E(\\Delta x) = \\left| M_h(T) - \\int_0^1 u(x,0)\\,dx \\right|$. Based on the above analysis, this simplifies to:\n$$\nE(\\Delta x) = \\left| M_h(0) - \\int_0^1 u(x,0)\\,dx \\right|\n$$\nThis reveals a crucial insight: the error being measured is solely the error committed during the initial discretization. It is the error of the composite midpoint rule used to approximate the continuous integral of the initial condition, $M(0) = \\int_0^1 u(x,0)\\,dx$, with its discrete counterpart, $M_h(0) = \\Delta x \\sum_{i=0}^{N-1} u(x_i, 0)$. The choice of time-stepping scheme (upwind vs. Lax-Wendroff), the final time $T$, wave speed $a$, and CFL number $\\nu$ have no influence on this particular error metric.\n\nThe analysis thus reduces to determining the order of convergence $p$ for the composite midpoint rule for the two given initial conditions. The error $E(\\Delta x)$ is expected to scale as $E(\\Delta x) \\propto (\\Delta x)^p$.\n\nCase 1: Smooth Gaussian Initial Condition\nThe function $u(x,0) = \\exp\\!\\left(-\\frac{(x-\\mu)^2}{2\\sigma^2}\\right)$ is infinitely differentiable ($C^\\infty$) on the domain. For a sufficiently smooth function, the error of the composite midpoint rule is known to be of second order in the grid spacing.\n$$\nE(\\Delta x) = \\left| \\Delta x \\sum_{i=0}^{N-1} f(x_i) - \\int_0^1 f(x) dx \\right| = O(\\Delta x^2)\n$$\nTherefore, the expected order of convergence for the Gaussian profile is $p=2$ for both numerical schemes.\n\nCase 2: Discontinuous Top-hat Initial Condition\nThe function $u(x,0)$ is piecewise constant with two jump discontinuities. The standard error analysis for numerical quadrature, which assumes smoothness, does not apply. For a function with jump discontinuities, the error of any Riemann-type sum, including the midpoint rule, is dominated by the cells containing the discontinuities. The error contribution from these cells is proportional to the cell width $\\Delta x$. Therefore, the total error scales linearly with the grid spacing.\n$$\nE(\\Delta x) = O(\\Delta x)\n$$\nThe expected order of convergence for the top-hat profile is $p=1$ for both numerical schemes.\n\nIn conclusion, a theoretical analysis predicts the orders of convergence to be $p_{\\text{upwind,Gaussian}} = 2$, $p_{\\text{LW,Gaussian}} = 2$, $p_{\\text{upwind,TopHat}} = 1$, and $p_{\\text{LW,TopHat}} = 1$. The program below will perform the full numerical simulation as specified in the problem statement to verify these theoretical predictions.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import erf\n\ndef solve():\n    \"\"\"\n    Computes the observed order of convergence for the error in a numerically\n    conserved quantity for two finite difference schemes applied to the\n    linear advection equation.\n    \"\"\"\n\n    # --- Problem Parameters ---\n    a = 1.0\n    T = 0.3\n    nu_star = 0.8\n    N_list = [48, 96, 192, 384]\n\n    # --- Initial Condition Definitions ---\n    # Gaussian\n    mu_gauss = 0.5\n    sigma_gauss = 0.07\n\n    def ic_gaussian(x):\n        return np.exp(-((x - mu_gauss)**2) / (2 * sigma_gauss**2))\n\n    def integral_gaussian():\n        arg1 = (1.0 - mu_gauss) / (np.sqrt(2.0) * sigma_gauss)\n        arg2 = (-mu_gauss) / (np.sqrt(2.0) * sigma_gauss)\n        return np.sqrt(np.pi / 2.0) * sigma_gauss * (erf(arg1) - erf(arg2))\n\n    # Top-hat\n    xc_tophat = 0.5\n    w_tophat = 0.23\n\n    def ic_tophat(x):\n        return np.where(np.abs(x - xc_tophat) = w_tophat / 2.0, 1.0, 0.0)\n\n    def integral_tophat():\n        return w_tophat\n    \n    initial_conditions = [\n        {\"name\": \"Gaussian\", \"func\": ic_gaussian, \"integral\": integral_gaussian()},\n        {\"name\": \"TopHat\", \"func\": ic_tophat, \"integral\": integral_tophat()}\n    ]\n\n    # --- Scheme Definitions ---\n    def step_upwind(u, nu):\n        u_prev = np.roll(u, 1)\n        return u - nu * (u - u_prev)\n\n    def step_lax_wendroff(u, nu):\n        u_prev = np.roll(u, 1)\n        u_next = np.roll(u, -1)\n        term1 = - (nu / 2.0) * (u_next - u_prev)\n        term2 = (nu**2 / 2.0) * (u_next - 2.0 * u + u_prev)\n        return u + term1 + term2\n\n    schemes = [\n        {\"name\": \"Upwind\", \"func\": step_upwind},\n        {\"name\": \"Lax-Wendroff\", \"func\": step_lax_wendroff}\n    ]\n\n    results = []\n\n    # --- Main Loop ---\n    for ic in initial_conditions:\n        for scheme in schemes:\n            dx_vals = []\n            error_vals = []\n\n            for N in N_list:\n                # Grid and time step setup\n                dx = 1.0 / N\n                x = (np.arange(N) + 0.5) * dx\n                \n                # Time-stepping must result in final time T exactly\n                dt_initial = nu_star * dx / a\n                n_steps = int(np.ceil(T / dt_initial))\n                dt = T / n_steps\n                nu = a * dt / dx\n\n                # Set initial condition\n                u = ic[\"func\"](x)\n                \n                # Time evolution\n                for _ in range(n_steps):\n                    u = scheme[\"func\"](u, nu)\n                \n                # Calculate final numerical integral\n                m_h_T = dx * np.sum(u)\n                \n                # Calculate error\n                exact_integral = ic[\"integral\"]\n                error = np.abs(m_h_T - exact_integral)\n                \n                dx_vals.append(dx)\n                error_vals.append(error)\n\n            # Perform least-squares fit on log-log data to find order p\n            log_dx = np.log(np.array(dx_vals))\n            log_error = np.log(np.array(error_vals))\n            \n            # The slope of the line is the order of convergence\n            p, _ = np.polyfit(log_dx, log_error, 1)\n            results.append(p)\n\n    # Format the final output string\n    output_str = f\"[{','.join([f'{p:.2f}' for p in results])}]\"\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "While the Lax-Wendroff scheme is second-order accurate for smooth solutions, it struggles near sharp gradients or discontinuities. This exercise  dives into this critical weakness, where the scheme produces non-physical oscillations, or \"wiggles,\" around jumps in the data. By quantifying the overshoot, undershoot, and total variation, you will gain a tangible understanding of the dispersive errors that limit the applicability of high-order linear schemes.",
            "id": "2393549",
            "problem": "Consider the one-dimensional linear advection equation $u_t + a\\,u_x = 0$ on the periodic domain $x \\in [0,1)$ with constant advection speed $a  0$. Let $a = 1$. The initial condition is the discontinuous step\n$$\nu(x,0) = \\begin{cases}\n1,  x \\ge 0.5,\\\\\n0,  x  0.5.\n\\end{cases}\n$$\nDiscretize space with $N$ uniform cell-centered points $x_j = (j + 0.5)\\,\\Delta x$ for $j \\in \\{0,1,\\dots,N-1\\}$, where $\\Delta x = 1/N$, and impose periodicity. Evolve the discrete solution using the Lax–Wendroff finite difference scheme defined by the update\n$$\nu_j^{n+1} = u_j^n - \\tfrac{1}{2}\\sigma\\left(u_{j+1}^n - u_{j-1}^n\\right) + \\tfrac{1}{2}\\sigma^2\\left(u_{j+1}^n - 2u_j^n + u_{j-1}^n\\right),\n$$\nwith periodic indexing, where the Courant–Friedrichs–Lewy (CFL) number $\\sigma$ is $\\sigma = a\\,\\Delta t / \\Delta x$ and $\\Delta t$ is the time step. For each case below, use the specified $N$, $\\sigma$, and terminal time $t_{\\mathrm{end}}$ to construct $\\Delta t = \\sigma\\,\\Delta x/a$ and evolve for the largest integer number of steps $n$ such that $t_n = n\\,\\Delta t \\le t_{\\mathrm{end}}$. Denote this evolution time by $t_n$.\n\nTo quantify Gibbs-like oscillations near the advected discontinuity, define the theoretical discontinuity location at time $t_n$ as $x_d(t_n) = \\mathrm{mod}(0.5 + a\\,t_n,\\,1)$. Extract a symmetric spatial window of half-width $w_x = 0.1$ centered at $x_d(t_n)$, that is, all grid points $x_j$ satisfying the shortest periodic distance to $x_d(t_n)$ not exceeding $w_x$. Within this window, compute the following three quantities for the discrete solution at time $t_n$:\n- The overshoot amplitude $O = \\max\\{0,\\,\\max_{\\text{window}} u - 1\\}$.\n- The undershoot amplitude $U = \\max\\{0,\\,0 - \\min_{\\text{window}} u\\}$.\n- The total-variation ratio $R = \\mathrm{TV}(u(\\cdot,t_n)) / \\mathrm{TV}(u(\\cdot,0))$, where the discrete total variation is $\\mathrm{TV}(v) = \\sum_{j=0}^{N-1} |v_{j+1} - v_j|$ with periodic indexing.\n\nYour program must evaluate $(O,U,R)$ for each of the following five test cases:\n1. $N=200$, $\\sigma=0.5$, $t_{\\mathrm{end}}=0.2$.\n2. $N=200$, $\\sigma=0.9$, $t_{\\mathrm{end}}=0.2$.\n3. $N=50$, $\\sigma=0.5$, $t_{\\mathrm{end}}=0.2$.\n4. $N=200$, $\\sigma=0.2$, $t_{\\mathrm{end}}=0.2$.\n5. $N=800$, $\\sigma=0.5$, $t_{\\mathrm{end}}=0.2$.\n\nAll quantities are dimensionless. Your program should produce a single line of output containing the results as a comma-separated list of lists, where the $k$-th inner list is $[O_k,U_k,R_k]$ for test case $k$, and each floating-point number is rounded to exactly six decimal places. For example, the required format is\n$$\n[\\,[O_1,U_1,R_1],\\,[O_2,U_2,R_2],\\,\\dots,\\,[O_5,U_5,R_5]\\,].\n$$",
            "solution": "The problem requires the numerical solution of the one-dimensional linear advection equation using the Lax-Wendroff finite difference scheme. The primary objective is to quantify the numerical artifacts, specifically the Gibbs-like oscillations, that arise when applying this second-order, non-monotonic scheme to a discontinuous initial profile.\n\nThe governing partial differential equation is the linear advection equation:\n$$\n\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = 0\n$$\nwhere $u(x, t)$ is the conserved quantity, $x \\in [0, 1)$ is the spatial coordinate with periodic boundary conditions, $t$ is time, and $a$ is the constant advection speed, given as $a=1$. The analytical solution to this equation is a simple translation of the initial profile, $u(x,t) = u_0(x-at)$, where $u_0(x) = u(x,0)$. For the given step-function initial condition:\n$$\nu(x,0) = \\begin{cases}\n1,  x \\ge 0.5 \\\\\n0,  x  0.5\n\\end{cases}\n$$\nthe discontinuity initially at $x=0.5$ advects with speed $a=1$, and its theoretical location at time $t$ is $x_d(t) = \\mathrm{mod}(0.5 + at, 1)$.\n\nThe computational domain is discretized into $N$ uniform cell-centered grid points $x_j = (j + 0.5)\\Delta x$ for $j \\in \\{0, 1, \\dots, N-1\\}$, with a spatial step size of $\\Delta x = 1/N$. Periodicity implies that the indices are treated modulo $N$, so that $x_{j+N} = x_j$.\n\nThe time evolution is governed by the explicit Lax-Wendroff scheme, which is second-order accurate in both space and time. The discrete update formula for the solution $u_j^n \\approx u(x_j, t_n)$ is given by:\n$$\nu_j^{n+1} = u_j^n - \\frac{1}{2}\\sigma(u_{j+1}^n - u_{j-1}^n) + \\frac{1}{2}\\sigma^2(u_{j+1}^n - 2u_j^n + u_{j-1}^n)\n$$\nHere, $\\sigma = a\\Delta t / \\Delta x$ is the Courant-Friedrichs-Lewy (CFL) number, which relates the time step $\\Delta t$, the spatial step $\\Delta x$, and the advection speed $a$. The scheme is stable for $|\\sigma| \\le 1$. The problem specifies $\\Delta t = \\sigma \\Delta x / a$. The simulation runs for the largest integer number of steps, $n_{\\text{steps}}$, such that the total evolution time $t_n = n_{\\text{steps}} \\Delta t$ does not exceed a given terminal time $t_{\\mathrm{end}}$.\n\nThe Lax-Wendroff scheme achieves second-order accuracy by incorporating a term proportional to the second spatial derivative, which counteracts the numerical diffusion of a first-order upwind scheme. However, this introduces numerical dispersion, causing non-physical oscillations (overshoots and undershoots) near sharp gradients or discontinuities, a phenomenon related to the Gibbs effect.\n\nTo quantify these oscillations, we analyze the numerical solution $u_j^{n}$ at the final time $t_n$. A spatial window of half-width $w_x = 0.1$ is defined around the theoretical location of the advected discontinuity, $x_d(t_n)$. This window contains all grid points $x_j$ such that the shortest periodic distance to $x_d(t_n)$, given by $\\min(|x_j - x_d(t_n)|, 1 - |x_j - x_d(t_n)|)$, is no more than $w_x$. Within this window, we compute:\n1.  The overshoot amplitude $O = \\max\\{0, \\max_{\\text{window}} u - 1\\}$. This measures the maximum value of the solution in the window that exceeds the initial maximum of $1$.\n2.  The undershoot amplitude $U = \\max\\{0, 0 - \\min_{\\text{window}} u\\}$. This measures the maximum value by which the solution in the window drops below the initial minimum of $0$.\n\nAdditionally, we evaluate the growth of oscillations by computing the ratio of the total variation (TV) at time $t_n$ to the initial total variation. The discrete total variation of a grid function $v$ is defined as $\\mathrm{TV}(v) = \\sum_{j=0}^{N-1} |v_{j+1} - v_j|$, with periodic indexing $v_N = v_0$. The initial condition is a step function on a periodic domain, which has two jumps (from $0$ to $1$ and from $1$ back to $0$), so its theoretical total variation is $\\mathrm{TV}(u(\\cdot,0)) = 2$. The ratio is $R = \\mathrm{TV}(u(\\cdot,t_n)) / \\mathrm{TV}(u(\\cdot,0))$. For a scheme that is not total variation diminishing (TVD), like Lax-Wendroff, this ratio is expected to be greater than $1$, indicating the creation of new extrema, i.e., oscillations.\n\nThe algorithmic procedure for each test case is as follows:\n1.  Initialize parameters: $N, \\sigma, t_{\\mathrm{end}}$, with $a=1$ and $w_x=0.1$.\n2.  Calculate simulation parameters: $\\Delta x = 1/N$, $\\Delta t = \\sigma \\Delta x / a$, and $n_{\\text{steps}} = \\lfloor t_{\\mathrm{end}} / \\Delta t \\rfloor$. The final time is $t_n = n_{\\text{steps}} \\Delta t$.\n3.  Set up the grid $x_j$ and the initial condition $u^0$, where $u_j^0 = 1$ if $x_j \\ge 0.5$ and $u_j^0 = 0$ otherwise.\n4.  Calculate the initial total variation, $\\mathrm{TV}(u^0)$.\n5.  Iteratively apply the Lax-Wendroff update formula for $n_{\\text{steps}}$ to obtain the final numerical solution $u^{n_{\\text{steps}}}$. Vectorized array operations are used for efficiency, employing circular shifts to handle periodic boundary conditions.\n6.  Determine the theoretical discontinuity location $x_d(t_n) = (0.5 + a t_n) \\pmod 1$.\n7.  Identify the grid points lying within the analysis window of half-width $w_x$ around $x_d(t_n)$.\n8.  Compute the maximum and minimum of the solution within this window to find the overshoot $O$ and undershoot $U$.\n9.  Compute the total variation of the final solution, $\\mathrm{TV}(u^{n_{\\text{steps}}})$, and the ratio $R$.\n10. Store the computed triplet $(O, U, R)$ for the case.\nThis process is repeated for all five specified test cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the 1D linear advection equation using the Lax-Wendroff scheme for\n    multiple test cases and quantifies numerical oscillations.\n    \"\"\"\n    test_cases = [\n        (200, 0.5, 0.2),\n        (200, 0.9, 0.2),\n        (50, 0.5, 0.2),\n        (200, 0.2, 0.2),\n        (800, 0.5, 0.2),\n    ]\n\n    results = []\n    a = 1.0  # Advection speed\n    w_x = 0.1  # Window half-width for analysis\n\n    for N, sigma, t_end in test_cases:\n        # 1. Setup simulation parameters\n        dx = 1.0 / N\n        dt = sigma * dx / a\n        if dt == 0:\n            num_steps = 0\n        else:\n            num_steps = int(t_end / dt)\n        t_n = num_steps * dt\n\n        # 2. Initialize grid and solution\n        x = (np.arange(N) + 0.5) * dx\n        u = np.where(x = 0.5, 1.0, 0.0)\n\n        # 3. Calculate initial total variation\n        # TV(v) = sum(|v_{j+1} - v_j|) with periodic indexing\n        # np.roll(u, -1) gives u_{j+1} at index j\n        tv_initial = np.sum(np.abs(np.roll(u, -1) - u))\n        if tv_initial == 0: tv_initial = 1.0 # Avoid division by zero, though not expected here.\n\n        # 4. Time evolution loop (Lax-Wendroff)\n        for _ in range(num_steps):\n            u_jp1 = np.roll(u, -1)  # u_{j+1}\n            u_jm1 = np.roll(u, 1)   # u_{j-1}\n            \n            # Central difference term (first derivative)\n            term1 = -0.5 * sigma * (u_jp1 - u_jm1)\n            \n            # Central difference term (second derivative)\n            term2 = 0.5 * sigma**2 * (u_jp1 - 2.0 * u + u_jm1)\n            \n            u = u + term1 + term2\n        \n        u_final = u\n\n        # 5. Analyze the final solution\n        # Theoretical discontinuity location\n        x_d = (0.5 + a * t_n) % 1.0\n\n        # Identify the analysis window\n        dist = np.abs(x - x_d)\n        periodic_dist = np.minimum(dist, 1.0 - dist)\n        window_mask = periodic_dist = w_x\n        \n        u_window = u_final[window_mask]\n\n        # Handle case where window might be empty, though unlikely with given params\n        if u_window.size  0:\n            max_u_window = np.max(u_window)\n            min_u_window = np.min(u_window)\n        else:\n            max_u_window = 1.0\n            min_u_window = 0.0\n\n        # Calculate overshoot and undershoot\n        overshoot = max(0.0, max_u_window - 1.0)\n        undershoot = max(0.0, 0.0 - min_u_window)\n\n        # Calculate total variation ratio\n        tv_final = np.sum(np.abs(np.roll(u_final, -1) - u_final))\n        tv_ratio = tv_final / tv_initial\n        \n        results.append([overshoot, undershoot, tv_ratio])\n\n    # 6. Format and print the final output\n    formatted_results = []\n    for O, U, R in results:\n        formatted_results.append(f\"[{O:.6f},{U:.6f},{R:.6f}]\")\n    \n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "How can we harness the accuracy of the Lax-Wendroff scheme in smooth regions while avoiding its damaging oscillations near shocks? This practice  guides you through building a modern solution: a hybrid scheme. You will engineer a \"shock detector\" that senses sharp gradients and dynamically switches the numerical method from the high-accuracy Lax-Wendroff scheme to a more robust first-order upwind scheme, creating a powerful and practical shock-capturing solver.",
            "id": "2407729",
            "problem": "You are to design and implement a hybrid finite-volume solver for the scalar linear advection equation that uses the Lax–Wendroff scheme in smooth regions and switches to a first-order upwind scheme near shocks (or strong gradients) detected by a local gradient sensor. Your implementation must be a complete, runnable program that produces the specified outputs for the test suite below.\n\nThe mathematical model is the one-dimensional scalar linear advection equation\n$$\n\\frac{\\partial u}{\\partial t} + a \\frac{\\partial u}{\\partial x} = 0,\n$$\nposed on the periodic domain $[0,1)$ with constant advection speed $a \\in \\mathbb{R}$. The conserved quantity is $u(x,t)$. The problem is to derive, implement, and test a hybrid conservative update rule that blends second-order accuracy in smooth regions with robustness near discontinuities.\n\nYour derivation must start from the following fundamental base:\n- The conservation law form $$\\frac{d}{dt}\\int_{x_{j-1/2}}^{x_{j+1/2}} u(x,t)\\,dx = -\\left(F_{j+1/2}(t)-F_{j-1/2}(t)\\right),$$ where $F$ is a consistent numerical flux.\n- A uniform grid with cell centers $x_j = j\\,\\Delta x$ for $j \\in \\{0,1,\\dots,N-1\\}$, periodic indexing, and time steps $t^n = n\\,\\Delta t$ for $n \\in \\mathbb{N}$.\n- A Courant–Friedrichs–Lewy (CFL) number $C = a\\,\\Delta t/\\Delta x$ satisfying $|C| \\le 1$ for stability of the Lax–Wendroff scheme in this setting.\n\nYou must obtain, from first principles and without using any pre-stated target formulas, a conservative Lax–Wendroff numerical flux for the linear advection equation and a first-order upwind numerical flux consistent with the sign of $a$. You must also define a boolean switching rule at each cell interface based on a local gradient sensor. The sensor must be the dimensionless, translation-invariant quantity\n$$\nS_j = \\frac{\\left|u_{j+1} - 2u_j + u_{j-1}\\right|}{\\left|u_{j+1}\\right| + 2\\left|u_j\\right| + \\left|u_{j-1}\\right| + \\varepsilon},\n$$\nwith $\\varepsilon = 10^{-12}$ used only to avoid division by zero. The interface $x_{j+1/2}$ is flagged as non-smooth if either of the adjacent cells satisfies $S_j  \\tau$ or $S_{j+1}  \\tau$ for a specified threshold $\\tau  0$. In smooth regions (interfaces not flagged), you must use your derived Lax–Wendroff flux; in non-smooth regions, you must use your derived first-order upwind flux. The update must be in conservative form\n$$\nu_j^{n+1} = u_j^n - \\frac{\\Delta t}{\\Delta x}\\left(F_{j+1/2}^n - F_{j-1/2}^n\\right),\n$$\nwith periodic boundary conditions.\n\nDefine the following exact solutions for verification (with periodic wrap-around on $[0,1)$):\n- A smooth Gaussian with center $x_0$ and width $\\sigma$:\n$$\nu(x,0) = \\exp\\!\\left(-\\left(\\frac{x-x_0}{\\sigma}\\right)^2\\right), \\quad u(x,t) = u\\big((x - a t)\\ \\mathrm{mod}\\ 1, 0\\big).\n$$\n- A discontinuous square pulse (top-hat) with left edge $x_\\ell$ and right edge $x_r$, height $1$ elsewhere $0$:\n$$\nu(x,0) = \n\\begin{cases}\n1,  x \\in [x_\\ell,x_r) \\ (\\mathrm{mod}\\ 1),\\\\\n0,  \\text{otherwise},\n\\end{cases}\n\\quad u(x,t) = u\\big((x - a t)\\ \\mathrm{mod}\\ 1, 0\\big).\n$$\n- A smooth sinusoid with wavenumber $k$:\n$$\nu(x,0) = \\sin(2\\pi k x), \\quad u(x,t) = \\sin\\!\\big(2\\pi k \\big((x - a t)\\ \\mathrm{mod}\\ 1\\big)\\big).\n$$\n\nYour program must:\n- Implement the hybrid scheme as stated, with periodic boundary conditions, and a time step chosen from a target CFL number $C_{\\mathrm{target}}$ by setting $\\Delta t = T/n_{\\mathrm{steps}}$ with $n_{\\mathrm{steps}} = \\lceil T / (C_{\\mathrm{target}}\\,\\Delta x/|a|) \\rceil$ and thereby an actual CFL number $C = |a|\\,\\Delta t/\\Delta x \\le C_{\\mathrm{target}}$.\n- For smooth cases, report the discrete root-mean-square error defined by\n$$\nE_2 = \\sqrt{\\frac{1}{N}\\sum_{j=0}^{N-1} \\left(u_j^{\\mathrm{num}} - u_j^{\\mathrm{exact}}\\right)^2 }.\n$$\n- For the discontinuous square pulse, report the overshoot magnitude beyond the physically admissible interval $[0,1]$:\n$$\nE_{\\mathrm{over}} = \\max\\left(\\max_j(u_j^{\\mathrm{num}} - 1), \\max_j(-u_j^{\\mathrm{num}}), 0\\right).\n$$\n\nTest suite. Use the following parameter sets, designed to test smooth transport, behavior near discontinuities, and near-CFL boundary conditions:\n- Case A (smooth Gaussian, happy path): $N = 400$, $a = 1$, $C_{\\mathrm{target}} = 0.8$, $T = 0.5$, $\\tau = 0.05$, $x_0 = 0.3$, $\\sigma = 0.05$. Output $E_2$ as a float.\n- Case B (discontinuous square pulse, shock sensor effectiveness): $N = 400$, $a = 1$, $C_{\\mathrm{target}} = 0.8$, $T = 0.5$, $\\tau = 0.05$, $x_\\ell = 0.2$, $x_r = 0.4$. Output $E_{\\mathrm{over}}$ as a float.\n- Case C (smooth sinusoid, near-CFL boundary): $N = 200$, $a = 1$, $C_{\\mathrm{target}} = 0.99$, $T = 1.0$, $\\tau = 0.05$, $k = 1$. Output $E_2$ as a float.\n\nFinal output format. Your program should produce a single line of output containing the three results in the order of Cases A, B, C as a comma-separated list enclosed in square brackets, for example\n[rA,rB,rC].",
            "solution": "We begin from the scalar linear advection equation $\\partial_t u + a\\,\\partial_x u = 0$ with constant $a \\in \\mathbb{R}$. The conservation law interpretation over a cell $[x_{j-1/2}, x_{j+1/2}]$ implies\n$$\n\\frac{d}{dt} \\int_{x_{j-1/2}}^{x_{j+1/2}} u(x,t)\\,dx = -\\left(F_{j+1/2}(t) - F_{j-1/2}(t)\\right),\n$$\nwhere $F_{j+1/2}$ is the physical flux crossing the cell face. On a uniform grid with cell-averaged unknowns $u_j^n \\approx \\frac{1}{\\Delta x}\\int_{x_{j-1/2}}^{x_{j+1/2}} u(x,t^n)\\,dx$, a consistent conservative update is\n$$\nu_j^{n+1} = u_j^n - \\frac{\\Delta t}{\\Delta x}\\left(F_{j+1/2}^n - F_{j-1/2}^n\\right),\n$$\nwhere $F_{j+1/2}^n$ is a numerical flux depending on the states adjacent to the interface.\n\nDerivation of the Lax–Wendroff flux for linear advection. The Lax–Wendroff idea is to achieve second-order accuracy in time via a Taylor expansion and then use the partial differential equation to replace time derivatives by space derivatives. For linear advection,\n$$\nu(x,t+\\Delta t) = u(x,t) + \\Delta t\\,\\partial_t u(x,t) + \\frac{(\\Delta t)^2}{2}\\,\\partial_{tt} u(x,t) + \\mathcal{O}((\\Delta t)^3).\n$$\nUsing the equation $\\partial_t u = -a\\,\\partial_x u$ and differentiating in time once more yields $\\partial_{tt} u = -a\\,\\partial_t \\partial_x u = a^2 \\partial_{xx} u$. Substituting,\n$$\nu(x,t+\\Delta t) = u(x,t) - a\\,\\Delta t\\,\\partial_x u(x,t) + \\frac{a^2 (\\Delta t)^2}{2}\\,\\partial_{xx} u(x,t) + \\mathcal{O}((\\Delta t)^3).\n$$\nDiscretizing derivatives by centered finite differences at cell centers $x_j$,\n$$\n\\partial_x u \\approx \\frac{u_{j+1}^n - u_{j-1}^n}{2\\Delta x},\\quad \\partial_{xx} u \\approx \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{(\\Delta x)^2},\n$$\nwe obtain the standard Lax–Wendroff update\n$$\nu_j^{n+1} = u_j^n - \\frac{a\\,\\Delta t}{2\\Delta x}\\left(u_{j+1}^n - u_{j-1}^n\\right) + \\frac{a^2 (\\Delta t)^2}{2(\\Delta x)^2}\\left(u_{j+1}^n - 2u_j^n + u_{j-1}^n\\right).\n$$\nFor conservative implementations and for hybridization at interfaces, it is convenient to recast this update in flux-difference form. Define the Lax–Wendroff numerical flux at interface $x_{j+1/2}$ as\n$$\nF^{\\mathrm{LW}}_{j+1/2} = a \\left( \\frac{u_j^n + u_{j+1}^n}{2} - \\frac{C}{2}\\left(u_{j+1}^n - u_j^n\\right) \\right),\n$$\nwhere $C = a\\,\\Delta t/\\Delta x$ is the Courant–Friedrichs–Lewy number. A direct algebraic manipulation verifies that using\n$$\nu_j^{n+1} = u_j^n - \\frac{\\Delta t}{\\Delta x}\\left(F^{\\mathrm{LW}}_{j+1/2} - F^{\\mathrm{LW}}_{j-1/2}\\right)\n$$\nis equivalent to the Taylor-expanded Lax–Wendroff update above. This form is conservative and uses only nearest-neighbor information.\n\nDerivation of the first-order upwind flux. For linear advection with constant speed $a$, the characteristic information propagates to the right if $a0$ and to the left if $a0$. A consistent, monotone first-order upwind flux is\n$$\nF^{\\mathrm{UP}}_{j+1/2} =\n\\begin{cases}\na\\,u_j^n,  a \\ge 0,\\\\\na\\,u_{j+1}^n,  a  0.\n\\end{cases}\n$$\nUsing this flux in the conservative update yields the classical upwind scheme, which is stable under $|C| \\le 1$ but only first order accurate.\n\nShock or gradient sensor and hybridization. High-order centered schemes such as Lax–Wendroff can produce oscillations near discontinuities (dispersive Gibbs-like ripples). To mitigate this, we define a local, dimensionless smoothness indicator\n$$\nS_j = \\frac{\\left|u_{j+1}^n - 2u_j^n + u_{j-1}^n\\right|}{\\left|u_{j+1}^n\\right| + 2\\left|u_j^n\\right| + \\left|u_j^n\\right| + \\varepsilon},\n$$\nwith $\\varepsilon = 10^{-12}$ to avoid division by zero. This compares a discrete second derivative magnitude to a local amplitude scale and is insensitive to uniform shifts and scaling. An interface $x_{j+1/2}$ is declared non-smooth if $S_j  \\tau$ or $S_{j+1}  \\tau$ for a prescribed threshold $\\tau  0$. The hybrid flux is then chosen as\n$$\nF_{j+1/2}^n =\n\\begin{cases}\nF^{\\mathrm{LW}}_{j+1/2},  \\text{if } \\max(S_j, S_{j+1}) \\le \\tau,\\\\\nF^{\\mathrm{UP}}_{j+1/2},  \\text{otherwise}.\n\\end{cases}\n$$\nThe update remains conservative:\n$$\nu_j^{n+1} = u_j^n - \\frac{\\Delta t}{\\Delta x}\\left(F_{j+1/2}^n - F_{j-1/2}^n\\right).\n$$\n\nTime step selection and stability. We prescribe a target Courant–Friedrichs–Lewy number $C_{\\mathrm{target}} \\in (0,1]$ and set an initial time step $\\Delta t^\\star = C_{\\mathrm{target}}\\,\\Delta x/|a|$. To hit a desired final time $T$ exactly, we choose\n$$\nn_{\\mathrm{steps}} = \\left\\lceil \\frac{T}{\\Delta t^\\star} \\right\\rceil,\\quad \\Delta t = \\frac{T}{n_{\\mathrm{steps}}},\\quad C = \\frac{|a|\\,\\Delta t}{\\Delta x} \\le C_{\\mathrm{target}}.\n$$\nThis ensures the Lax–Wendroff component remains stable under $|C| \\le 1$.\n\nExact solutions and error metrics. Because the equation is linear with constant speed, the solution is a rigid translation by $a\\,t$ modulo $1$:\n- For the Gaussian $u(x,0) = \\exp(-((x-x_0)/\\sigma)^2)$, the exact at time $t$ is $u((x-a t)\\ \\mathrm{mod}\\ 1, 0)$.\n- For the square pulse, translation preserves discontinuities and height.\n- For the sinusoid $\\sin(2\\pi k x)$, translation keeps the amplitude and shape.\n\nWe compute:\n- The discrete root-mean-square error\n$$\nE_2 = \\sqrt{\\frac{1}{N}\\sum_{j=0}^{N-1} \\left(u_j^{\\mathrm{num}} - u_j^{\\mathrm{exact}}\\right)^2 }.\n$$\n- The overshoot magnitude\n$$\nE_{\\mathrm{over}} = \\max\\left(\\max_j(u_j^{\\mathrm{num}} - 1), \\max_j(-u_j^{\\mathrm{num}}), 0\\right),\n$$\nwhich is zero if all numerical values lie within $[0,1]$ and positive otherwise.\n\nAlgorithmic structure:\n- Initialize grid with $N$ cells on $[0,1)$, $\\Delta x = 1/N$, periodic indexing.\n- Set final time $T$, speed $a$, threshold $\\tau$, and $C_{\\mathrm{target}}$; compute $\\Delta t$ and $n_{\\mathrm{steps}}$ as above.\n- Initialize $u_j^0$ according to the specified initial condition.\n- For each time step:\n  - Compute $S_j$ from $u_{j-1}^n, u_j^n, u_{j+1}^n$.\n  - For each interface, decide smooth/non-smooth from $S_j, S_{j+1}$ and assemble $F_{j+1/2}^n$ by choosing between $F^{\\mathrm{LW}}_{j+1/2}$ and $F^{\\mathrm{UP}}_{j+1/2}$.\n  - Update $u_j^{n+1}$ conservatively with periodic wrap-around.\n- After advancing to $T$, construct the exact solution on the grid and compute the requested metric.\n\nTest suite coverage:\n- Case A exercises second-order accuracy in a smooth region, so the sensor should remain inactive and $E_2$ should be small.\n- Case B stresses the sensor near discontinuities; the hybrid should suppress oscillations, yielding a small $E_{\\mathrm{over}}$ compared to pure Lax–Wendroff.\n- Case C uses $C$ near $1$ with a smooth wave to test stability and phase accuracy over one full period (translation by an integer wavelength), resulting in a small $E_2$.\n\nThe final program implements these steps and prints the results in the required single-line format.",
            "answer": "```python\nimport numpy as np\n\ndef initial_condition(x, ic_type, params):\n    if ic_type == \"gaussian\":\n        x0 = params[\"x0\"]\n        sigma = params[\"sigma\"]\n        return np.exp(-((x - x0) / sigma) ** 2)\n    elif ic_type == \"square\":\n        xl = params[\"xl\"] % 1.0\n        xr = params[\"xr\"] % 1.0\n        u = np.zeros_like(x)\n        if xl  xr:\n            mask = (x = xl)  (x  xr)\n            u[mask] = 1.0\n        else:\n            # wrap-around case\n            mask = (x = xl) | (x  xr)\n            u[mask] = 1.0\n        return u\n    elif ic_type == \"sine\":\n        k = params[\"k\"]\n        return np.sin(2.0 * np.pi * k * x)\n    else:\n        raise ValueError(\"Unknown initial condition type.\")\n\ndef exact_solution(x, t, a, ic_type, params):\n    # periodic shift by a*t modulo 1\n    x_shift = (x - a * t) % 1.0\n    return initial_condition(x_shift, ic_type, params)\n\ndef hybrid_lw_upwind(u0, a, dx, dt, nsteps, tau):\n    \"\"\"\n    Hybrid LW in smooth regions, first-order upwind near non-smooth interfaces.\n    Periodic boundary conditions.\n    \"\"\"\n    u = u0.copy()\n    cfl = a * dt / dx\n    eps = 1e-12\n    for _ in range(nsteps):\n        u_ip1 = np.roll(u, -1)\n        u_im1 = np.roll(u, 1)\n\n        # Smoothness indicator per cell\n        num = np.abs(u_ip1 - 2.0 * u + u_im1)\n        den = np.abs(u_ip1) + 2.0 * np.abs(u) + np.abs(u_im1) + eps\n        S = num / den\n\n        # Interface flags: interface j+1/2 uses cells j and j+1\n        S_right = np.roll(S, -1)\n        non_smooth_iface = (S  tau) | (S_right  tau)\n\n        # Lax–Wendroff flux at interfaces j+1/2\n        F_lw = a * (0.5 * (u + u_ip1) - 0.5 * cfl * (u_ip1 - u))\n\n        # First-order upwind flux at interfaces j+1/2\n        if a = 0:\n            F_up = a * u\n        else:\n            F_up = a * u_ip1\n\n        # Hybrid selection\n        F = np.where(non_smooth_iface, F_up, F_lw)\n\n        # Conservative update\n        F_imh = np.roll(F, 1)  # F_{j-1/2}\n        u = u - (dt / dx) * (F - F_imh)\n    return u\n\ndef run_case(ic_type, N, a, C_target, T, tau, ic_params):\n    # Grid and time step\n    L = 1.0\n    dx = L / N\n    # initial guess for dt from target CFL\n    dt_star = C_target * dx / abs(a) if a != 0 else T\n    nsteps = int(np.ceil(T / dt_star)) if T  0 else 0\n    if nsteps = 0:\n        dt = 0.0\n    else:\n        dt = T / nsteps\n\n    x = (np.arange(N) + 0.5) * dx  # cell centers\n    u0 = initial_condition(x, ic_type, ic_params)\n    u_num = hybrid_lw_upwind(u0, a, dx, dt, nsteps, tau)\n    u_ex = exact_solution(x, T, a, ic_type, ic_params)\n\n    if ic_type in (\"gaussian\", \"sine\"):\n        # RMS error\n        E2 = np.sqrt(np.mean((u_num - u_ex) ** 2))\n        return float(E2)\n    elif ic_type == \"square\":\n        # Overshoot beyond [0,1]\n        overshoot = max(float(np.max(u_num - 1.0)), float(np.max(-u_num)), 0.0)\n        return overshoot\n    else:\n        raise ValueError(\"Unknown IC type for metric.\")\n\ndef solve():\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case A: Smooth Gaussian\n        (\"gaussian\",\n         {\"N\": 400, \"a\": 1.0, \"C_target\": 0.8, \"T\": 0.5, \"tau\": 0.05,\n          \"ic_params\": {\"x0\": 0.3, \"sigma\": 0.05}}),\n        # Case B: Discontinuous square pulse\n        (\"square\",\n         {\"N\": 400, \"a\": 1.0, \"C_target\": 0.8, \"T\": 0.5, \"tau\": 0.05,\n          \"ic_params\": {\"xl\": 0.2, \"xr\": 0.4}}),\n        # Case C: Smooth sinusoid near CFL=1\n        (\"sine\",\n         {\"N\": 200, \"a\": 1.0, \"C_target\": 0.99, \"T\": 1.0, \"tau\": 0.05,\n          \"ic_params\": {\"k\": 1}}),\n    ]\n\n    results = []\n    for ic_type, params in test_cases:\n        res = run_case(ic_type=ic_type,\n                       N=params[\"N\"],\n                       a=params[\"a\"],\n                       C_target=params[\"C_target\"],\n                       T=params[\"T\"],\n                       tau=params[\"tau\"],\n                       ic_params=params[\"ic_params\"])\n        results.append(res)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}