{
    "hands_on_practices": [
        {
            "introduction": "任何间断 Galerkin (DG) 方法的实现都始于在标准“参考单元”上的计算。本练习提供了计算基本质量矩阵和刚度矩阵的实践经验，这些矩阵是任何 DG 求解器的核心构建块。通过使用正交的勒让德多项式作为基函数，你将亲手验证这些矩阵的结构，并加深对 DG 方法离散化核心思想的理解。",
            "id": "3119017",
            "problem": "考虑一个一维空间中的参考单元，其区间为 $[-1,1]$。在模态间断伽辽金 (DG) 方法中，通常选择一个在 $[-1,1]$ 上关于标准 $L^{2}$ 内积正交的多项式基。设基函数为 $n$ 次勒让德多项式 $P_{n}(x)$，其中 $n=0,1,\\dots,p$，且 $P_{0}(x)=1$、$P_{1}(x)=x$ 以及 $P_{2}(x)=\\frac{1}{2}(3x^{2}-1)$。定义与扩散问题的对称内部双线性形式相关联的单元质量矩阵 $\\mathbf{M}$ 和单元刚度矩阵 $\\mathbf{K}$ 如下：\n$$\nM_{ij}=\\int_{-1}^{1} P_{i}(x)\\,P_{j}(x)\\,\\mathrm{d}x,\\quad\nK_{ij}=\\int_{-1}^{1} \\frac{\\mathrm{d}P_{i}}{\\mathrm{d}x}(x)\\,\\frac{\\mathrm{d}P_{j}}{\\mathrm{d}x}(x)\\,\\mathrm{d}x,\n$$\n其中 $i,j=0,1,\\dots,p$。从 $L^{2}$ 内积和 $[-1,1]$ 上勒让德多项式基的基本定义出发，显式计算多项式次数为 $p=1$ 和 $p=2$ 时的 $\\mathbf{M}$ 和 $\\mathbf{K}$。然后，对于这些 $p$ 的选择，仅使用基本原理验证 $\\mathbf{M}$ 结构中所反映的正交性。\n\n最后，考虑在同一参考单元上，当 $p=2$ 时的广义单元特征值问题 $\\mathbf{K}\\mathbf{v}=\\lambda\\,\\mathbf{M}\\mathbf{v}$。根据你计算出的矩阵，确定最大特征值 $\\lambda_{\\max}$。将你的最终答案表示为单个实数。无需四舍五入。",
            "solution": "出发点是在 $[-1,1]$ 上为标量函数 $u(x)$ 和 $v(x)$ 定义的 $L^{2}$ 内积：\n$$\n(u,v)_{L^{2}(-1,1)}=\\int_{-1}^{1} u(x)\\,v(x)\\,\\mathrm{d}x.\n$$\n在单个参考单元 $[-1,1]$上，对于选定的基 $\\{P_{n}\\}_{n=0}^{p}$，单元质量矩阵 $\\mathbf{M}$ 和刚度矩阵 $\\mathbf{K}$ 定义为：\n$$\nM_{ij}=\\int_{-1}^{1} P_{i}(x)\\,P_{j}(x)\\,\\mathrm{d}x,\\quad\nK_{ij}=\\int_{-1}^{1} P'_{i}(x)\\,P'_{j}(x)\\,\\mathrm{d}x,\n$$\n其中 $P'_{i}(x)=\\frac{\\mathrm{d}P_{i}}{\\mathrm{d}x}(x)$ 表示 $P_{i}$ 的导数。\n\n我们将使用显式的低次勒让德多项式：\n$$\nP_{0}(x)=1,\\quad P_{1}(x)=x,\\quad P_{2}(x)=\\frac{1}{2}(3x^{2}-1).\n$$\n它们的导数是：\n$$\nP'_{0}(x)=0,\\quad P'_{1}(x)=1,\\quad P'_{2}(x)=3x.\n$$\n\n步骤 $1$：计算 $p=1$ 时的 $\\mathbf{M}$ 并验证其正交性。\n\n对于 $p=1$，基为 $\\{P_{0},P_{1}\\}$。质量矩阵的元素为：\n$$\nM_{00}=\\int_{-1}^{1} 1\\cdot 1\\,\\mathrm{d}x=\\int_{-1}^{1} 1\\,\\mathrm{d}x=2,\n$$\n$$\nM_{01}=\\int_{-1}^{1} 1\\cdot x\\,\\mathrm{d}x=\\int_{-1}^{1} x\\,\\mathrm{d}x=0 \\quad\\text{（对称区间上的奇被积函数）},\n$$\n$$\nM_{11}=\\int_{-1}^{1} x\\cdot x\\,\\mathrm{d}x=\\int_{-1}^{1} x^{2}\\,\\mathrm{d}x=\\left[\\frac{x^{3}}{3}\\right]_{-1}^{1}=\\frac{1}{3}-\\left(-\\frac{1}{3}\\right)=\\frac{2}{3}.\n$$\n因此，\n$$\n\\mathbf{M}_{p=1}=\\begin{pmatrix}\n2  0\\\\\n0  \\frac{2}{3}\n\\end{pmatrix}.\n$$\n非对角元素 $M_{01}=0$ 证明了 $P_{0}$ 和 $P_{1}$ 在 $[-1,1]$ 上的 $L^{2}$ 内积中是正交的。\n\n刚度矩阵的元素为：\n$$\nK_{00}=\\int_{-1}^{1} 0\\cdot 0\\,\\mathrm{d}x=0,\\quad K_{01}=\\int_{-1}^{1} 0\\cdot 1\\,\\mathrm{d}x=0,\\quad K_{11}=\\int_{-1}^{1} 1\\cdot 1\\,\\mathrm{d}x=2.\n$$\n因此，\n$$\n\\mathbf{K}_{p=1}=\\begin{pmatrix}\n0  0\\\\\n0  2\n\\end{pmatrix}.\n$$\n\n步骤 $2$：计算 $p=2$ 时的 $\\mathbf{M}$ 并验证其正交性。\n\n对于 $p=2$，基为 $\\{P_{0},P_{1},P_{2}\\}$。质量矩阵的元素涉及这些多项式的乘积：\n$$\nM_{00}=\\int_{-1}^{1} 1\\cdot 1\\,\\mathrm{d}x=2,\n$$\n$$\nM_{01}=\\int_{-1}^{1} 1\\cdot x\\,\\mathrm{d}x=0 \\quad\\text{（奇被积函数）},\n$$\n$$\nM_{02}=\\int_{-1}^{1} 1\\cdot \\frac{1}{2}(3x^{2}-1)\\,\\mathrm{d}x=\\frac{1}{2}\\left(3\\int_{-1}^{1} x^{2}\\,\\mathrm{d}x-\\int_{-1}^{1} 1\\,\\mathrm{d}x\\right)=\\frac{1}{2}\\left(3\\cdot\\frac{2}{3}-2\\right)=0,\n$$\n$$\nM_{11}=\\int_{-1}^{1} x\\cdot x\\,\\mathrm{d}x=\\frac{2}{3},\n$$\n$$\nM_{12}=\\int_{-1}^{1} x\\cdot \\frac{1}{2}(3x^{2}-1)\\,\\mathrm{d}x=\\frac{1}{2}\\left(3\\int_{-1}^{1} x^{3}\\,\\mathrm{d}x-\\int_{-1}^{1} x\\,\\mathrm{d}x\\right)=\\frac{1}{2}\\left(0-0\\right)=0 \\quad\\text{（奇被积函数）},\n$$\n$$\nM_{22}=\\int_{-1}^{1} \\left[\\frac{1}{2}(3x^{2}-1)\\right]^{2}\\,\\mathrm{d}x=\\int_{-1}^{1} \\frac{1}{4}\\left(9x^{4}-6x^{2}+1\\right)\\,\\mathrm{d}x=\\frac{1}{4}\\left(9\\cdot\\frac{2}{5}-6\\cdot\\frac{2}{3}+2\\right)=\\frac{1}{4}\\left(\\frac{18}{5}-4+2\\right)=\\frac{1}{4}\\cdot\\frac{8}{5}=\\frac{2}{5}.\n$$\n因此，\n$$\n\\mathbf{M}_{p=2}=\\begin{pmatrix}\n2  0  0\\\\\n0  \\frac{2}{3}  0\\\\\n0  0  \\frac{2}{5}\n\\end{pmatrix}.\n$$\n所有非对角元素均为零，验证了 $\\{P_{0},P_{1},P_{2}\\}$ 在 $L^{2}$ 内积中的正交性。这源于勒让德多项式在 $[-1,1]$ 上的奇偶性和正交性，并与内积的基本定义一致。\n\n刚度矩阵的元素使用导数：\n$$\nK_{00}=\\int_{-1}^{1} 0\\cdot 0\\,\\mathrm{d}x=0,\\quad K_{01}=\\int_{-1}^{1} 0\\cdot 1\\,\\mathrm{d}x=0,\\quad K_{02}=\\int_{-1}^{1} 0\\cdot 3x\\,\\mathrm{d}x=0,\n$$\n$$\nK_{11}=\\int_{-1}^{1} 1\\cdot 1\\,\\mathrm{d}x=2,\\quad K_{12}=\\int_{-1}^{1} 1\\cdot 3x\\,\\mathrm{d}x=3\\int_{-1}^{1} x\\,\\mathrm{d}x=0 \\quad\\text{（奇被积函数）},\n$$\n$$\nK_{22}=\\int_{-1}^{1} 3x\\cdot 3x\\,\\mathrm{d}x=9\\int_{-1}^{1} x^{2}\\,\\mathrm{d}x=9\\cdot\\frac{2}{3}=6.\n$$\n因此，\n$$\n\\mathbf{K}_{p=2}=\\begin{pmatrix}\n0  0  0\\\\\n0  2  0\\\\\n0  0  6\n\\end{pmatrix}.\n$$\n\n步骤 $3$：计算 $p=2$ 时广义问题 $\\mathbf{K}\\mathbf{v}=\\lambda\\,\\mathbf{M}\\mathbf{v}$ 的最大特征值。\n\n因为对于索引 $i\\geq 1$，$\\mathbf{K}_{p=2}$ 和 $\\mathbf{M}_{p=2}$ 都是对角矩阵，且对角线元素为正，所以广义特征值由下式给出：\n$$\n\\lambda_{i}=\\frac{K_{ii}}{M_{ii}},\\quad i=0,1,2.\n$$\n我们得到\n$$\n\\lambda_{0}=\\frac{0}{2}=0,\\quad \\lambda_{1}=\\frac{2}{2/3}=3,\\quad \\lambda_{2}=\\frac{6}{2/5}=15.\n$$\n因此，最大特征值为\n$$\n\\lambda_{\\max}=15.\n$$\n无需四舍五入。",
            "answer": "$$\\boxed{15}$$"
        },
        {
            "introduction": "间断 Galerkin 方法的“间断”特性要求使用一种特殊的“数值通量”来在单元之间传递信息，这是该方法最独特的方面。本练习通过一个关于静止激波的巧妙思想实验，深刻揭示了数值通量的作用 。你将看到，一个精心选择的通量（如 Godunov 通量）如何能使数值格式精确地捕捉问题的物理特性，从而建立对 DG 方法工作原理的直观认识。",
            "id": "2386810",
            "problem": "考虑一维域 $x \\in [-1,1]$ 和时间 $t \\ge 0$ 上的标量守恒律，\n$$\n\\partial_t u(x,t) + \\partial_x\\!\\left(\\tfrac{1}{2}u(x,t)^2\\right) = 0,\n$$\n其初始数据为\n$$\nu(x,0) = \\begin{cases}\na, & x  0,\\\\\n-a,  x > 0,\n\\end{cases}\n$$\n其中 $a0$ 是一个给定的常数。在 $x=-1$ 和 $x=1$ 处施加与传入特征线上的常数状态一致的边界条件。使用与间断对齐的网格 $\\{I_j\\}_{j=1}^N$ 对区域进行离散化，即在 $x=0$ 处存在一个界面。考虑多项式次数为 $p=0$（单元常数）和精确空间积分的半离散间断伽辽金 (DG) 方法。在每个界面上使用 Godunov 数值通量，其定义为给定守恒律在该界面处相关黎曼问题的精确自相似解所对应的界面通量。\n\n在这些条件下，论证半离散 DG 解是否对所有 $t \\ge 0$ 都与精确弱解一致。然后，计算静止界面 $x=0$ 处的 Godunov 数值通量值，用 $a$ 表示。请以 $a$ 的单个简化解析表达式的形式给出最终答案。无需四舍五入，也不包含单位。",
            "solution": "首先必须验证问题陈述的科学合理性、适定性和客观性。\n\n第一步：提取已知条件\n- 守恒律：$\\partial_t u(x,t) + \\partial_x (\\frac{1}{2}u(x,t)^2) = 0$。这是无粘性 Burgers 方程，其通量为 $f(u) = \\frac{1}{2}u^2$。\n- 区域：$x \\in [-1,1]$ 且 $t \\ge 0$。\n- 初始数据：对于 $x0$，$u(x,0) = a$；对于 $x>0$，$u(x,0) = -a$，其中 $a>0$。\n- 边界条件：与传入特征线上的常数状态一致。\n- 数值方法：多项式次数为 $p=0$ 的半离散间断伽辽金 (DG) 方法。\n- 网格：与 $x=0$ 处的间断对齐。\n- 空间积分：精确。\n- 数值通量：所有界面处使用 Godunov 数值通量。\n- 任务：论证半离散 DG 解是否对所有 $t \\ge 0$ 都与精确弱解一致。计算界面 $x=0$ 处的 Godunov 数值通量值。\n\n第二步：使用提取的已知条件进行验证\n- **科学性**：该问题涉及无粘性 Burgers 方程，这是流体动力学中的一个基本模型。带有 Godunov 通量的间断伽辽金方法是求解此类双曲守恒律的标准且经过充分研究的数值技术。初始数据描述了一个导致静止激波的黎曼问题。这些概念在计算物理和数学中都是标准的。该问题具有科学合理性。\n- **适定性**：该问题提供了一个定义明确的偏微分方程，其初始数据容许唯一的满足熵条件的弱解。数值格式已完全指定。所提问题精确且有确切答案。\n- **客观性**：该问题以纯粹的数学和计算术语陈述，没有任何主观性或模糊性。\n- **完整性和一致性**：所有必要信息均已提供。条件一致且互不矛盾。\n\n第三步：结论与行动\n该问题有效。可以构建一个严格的解。\n\n首先，我们分析给定黎曼问题的精确弱解。守恒律为 $\\partial_t u + \\partial_x f(u) = 0$，其中 $f(u) = \\frac{1}{2}u^2$。初始条件在 $x=0$ 处指定了一个间断，左状态为 $u_L = a$，右状态为 $u_R = -a$。由于 $a0$，我们有 $u_L  u_R$。对于像 $f(u) = \\frac{1}{2}u^2$ 这样的凸通量函数（因为 $f''(u) = 1  0$），条件 $u_L  u_R$ 意味着解是一个激波，前提是满足熵条件。\n\n此激波的速度 $s$ 由 Rankine-Hugoniot 条件确定：\n$$\ns = \\frac{f(u_L) - f(u_R)}{u_L - u_R} = \\frac{\\frac{1}{2}a^2 - \\frac{1}{2}(-a)^2}{a - (-a)} = \\frac{\\frac{1}{2}a^2 - \\frac{1}{2}a^2}{2a} = \\frac{0}{2a} = 0\n$$\n激波速度为零，意味着激波是静止的，并保持在 $x=0$ 处。Lax 熵条件要求特征线流入激波，即 $f'(u_L)  s  f'(u_R)$。由于 $f'(u) = u$，该条件变为 $a  0  -a$，对于 $a0$ 这是成立的。因此，精确弱解是一个静止的、满足熵条件的激波：\n$$\nu(x,t) = u(x,0) = \\begin{cases}\na,  x  0 \\\\\n-a,  x > 0\n\\end{cases} \\quad \\forall t \\ge 0\n$$\n\n接下来，我们分析半离散 DG 格式。对于多项式次数 $p=0$，DG 方法等价于有限体积格式。未知解 $u_h(x,t)$ 由一个分片常数函数近似，在每个网格单元 $I_j = [x_{j-1/2}, x_{j+1/2}]$ 上的值为 $U_j(t)$。单元平均值 $U_j$ 的半离散方程为：\n$$\n\\frac{dU_j}{dt} = -\\frac{1}{\\Delta x_j} (\\hat{f}_{j+1/2} - \\hat{f}_{j-1/2})\n$$\n其中 $\\Delta x_j$ 是单元 $I_j$ 的宽度，$\\hat{f}_{j+1/2} = \\hat{f}(U_j, U_{j+1})$ 是界面 $x_{j+1/2}$ 处的数值通量。\n\n问题陈述说明网格与 $x=0$ 处的间断对齐。这意味着存在一个界面，比如 $x_{k+1/2}$，使得 $x_{k+1/2}=0$。初始 DG 解是精确初始数据在分片常数空间上的投影。对于完全位于 $x0$ 的任何单元 $I_j$，$U_j(0)=a$。对于完全位于 $x>0$ 的任何单元 $I_j$，$U_j(0)=-a$。因此，对于 $j \\le k$ 有 $U_j(0)=a$，对于 $j \\ge k+1$ 有 $U_j(0)=-a$。这种离散表示对于分片常数解是精确的。\n\n半离散解在所有时间上都与精确解一致，当且仅当它保持静止，即对所有 $j$ 都有 $\\frac{dU_j}{dt}=0$。这要求每个单元的净通量为零：$\\hat{f}_{j+1/2} = \\hat{f}_{j-1/2}$。\n- 对于 $j  k$ 的任何单元 $I_j$，其两个界面都位于状态为 $a$ 的区域。因此 $U_{j-1}=U_j=U_{j+1}=a$。根据数值通量的一致性，$\\hat{f}(u,u)=f(u)$，我们有 $\\hat{f}_{j+1/2} = f(a)$ 和 $\\hat{f}_{j-1/2} = f(a)$，所以 $\\frac{dU_j}{dt}=0$。\n- 类似地，对于 $j  k+1$ 的任何单元 $I_j$，$U_{j-1}=U_j=U_{j+1}=-a$，所以 $\\hat{f}_{j+1/2} = f(-a)$ 和 $\\hat{f}_{j-1/2} = f(-a)$，得到 $\\frac{dU_j}{dt}=0$。\n- 对于紧邻激波左侧的单元 $I_k$，通量平衡为 $\\hat{f}_{k+1/2} = \\hat{f}_{k-1/2}$。这意味着 $\\hat{f}(U_k, U_{k+1}) = \\hat{f}(U_{k-1}, U_k)$，即 $\\hat{f}(a, -a) = \\hat{f}(a,a) = f(a) = \\frac{1}{2}a^2$。\n- 对于紧邻激波右側的单元 $I_{k+1}$，通量平衡为 $\\hat{f}_{k+3/2} = \\hat{f}_{k+1/2}$。这意味着 $\\hat{f}(U_{k+1}, U_{k+2}) = \\hat{f}(U_k, U_{k+1})$，即 $\\hat{f}(-a, -a) = \\hat{f}(a,-a)$，或者 $f(-a) = \\hat{f}(a,-a)$。由于 $f(-a) = \\frac{1}{2}(-a)^2 = \\frac{1}{2}a^2$，这给出了相同的条件。\n因此，离散解保持静止，当且仅当激波界面 $x=0$ 处的数值通量为 $\\hat{f}(a, -a) = \\frac{1}{2}a^2$。\n\n问题指定了 Godunov 通量。Godunov 通量 $\\hat{f}^G(u_L, u_R)$ 是从局部黎曼问题的精确解中获得的。对于凸通量函数 $f(u)$，Godunov 通量的一般公式为：\n$$\n\\hat{f}^G(u_L, u_R) =\n\\begin{cases}\n\\min_{u \\in [u_L, u_R]} f(u)  \\text{若 } u_L \\leq u_R \\text{ （稀疏波情况）} \\\\\n\\max_{u \\in [u_R, u_L]} f(u)  \\text{若 } u_L  u_R \\text{ （激波情况）}\n\\end{cases}\n$$\n在我们的例子中，$u_L=a$ 且 $u_R=-a$，因此 $u_L  u_R$。我们必须在区间 $[u_R, u_L] = [-a, a]$ 上找到 $f(u)=\\frac{1}{2}u^2$ 的最大值。函数 $f(u)$ 是一个开口向上的抛物线，因此它在对称区间 $[-a,a]$ 上的最大值必然出现在端点处。\n$$\n\\hat{f}^G(a,-a) = \\max_{u \\in [-a, a]} \\left(\\frac{1}{2}u^2\\right) = \\frac{1}{2}a^2\n$$\n由于 Godunov 通量 $\\hat{f}^G(a,-a) = \\frac{1}{2}a^2$ 满足静止条件，我们可以得出结论，半离散 DG 解不會从其初始状态演化。初始 DG 解是精确弱解的分片常数表示。因此，半离散 DG 解对所有 $t \\ge 0$ 都与精确弱解一致。\n\n问题的第二部分要求计算静止界面 $x=0$ 处的 Godunov 数值通量的值。如上所计算，该值为 $\\frac{1}{2}a^2$。",
            "answer": "$$\n\\boxed{\\frac{1}{2}a^{2}}\n$$"
        },
        {
            "introduction": "在构建了单元矩阵并通过数值通量将它们耦合之后，我们如何评估整个数值格式的性能？本综合练习将引导你实现一个完整的 DG 格式，并运用强大的傅里叶分析技术来量化其在求解波动问题时的表现 。通过计算数值色散和耗散，你将学会评估数值解的质量，这是计算科学中一项至关重要的技能。",
            "id": "3118954",
            "problem": "考虑一维线性平流偏微分方程 (PDE) $u_t + a\\,u_x = 0$，定义在周期性域 $x \\in [0,L]$上，其中 $a$ 是一个恒定的平流速度。使用带有迎风数值通量的间断 Galerkin (DG) 方法，在每个单元上使用 $p$ 次多项式基，于具有 $N$ 个尺寸为 $h = L/N$ 的单元的均匀网格上，推导并实现其半离散格式。然后，进行 Fourier (von Neumann) 分析，以获得对于每个无量纲的单元间相位 $\\theta \\in [0,2\\pi)$ 的半离散块符号及其特征值。从这些特征值中，提取数值色散关系 $k^\\ast(\\theta)$ 和数值耗散率。\n\n基本依据：\n- 从守恒律 $u_t + a\\,u_x = 0$ 开始。\n- 在单个单元 $K_j = [x_{j-\\frac{1}{2}}, x_{j+\\frac{1}{2}}]$ 上使用 DG 弱形式：乘以一个在 $K_j$ 上有支撑的测试函数 $v$，进行分部积分，并施加迎风数值通量。对于 $a0$，界面处的迎风状态等于来自左侧的迹。\n- 通过 $x = x_j + \\frac{h}{2}\\,\\xi$ 将每个单元映射到参考区间 $\\hat{K} = [-1,1]$，因此 $\\partial_x = \\frac{2}{h}\\,\\partial_\\xi$。\n- 在 $\\hat{K}$ 上选择一个线性无关的局部基 $\\{\\phi_n(\\xi)\\}_{n=0}^p$（例如，单项式 $\\phi_n(\\xi) = \\xi^n$）。令 $u_h|_{K_j}(\\xi,t) = \\sum_{n=0}^p U_{j,n}(t)\\,\\phi_n(\\xi)$。\n- 从下式推导单元质量矩阵 $M \\in \\mathbb{R}^{(p+1)\\times(p+1)}$ 和体矩阵 $D \\in \\mathbb{R}^{(p+1)\\times(p+1)}$：\n  $$M_{mn} = \\int_{K_j} \\phi_m\\,\\phi_n\\,dx = \\frac{h}{2}\\int_{-1}^{1} \\phi_m(\\xi)\\,\\phi_n(\\xi)\\,d\\xi,$$\n  $$D_{mn} = \\int_{K_j} \\phi_n\\,\\partial_x \\phi_m\\,dx = \\int_{-1}^{1} \\phi_n(\\xi)\\,\\partial_\\xi\\phi_m(\\xi)\\,d\\xi.$$\n- 对于 $a0$，迎风通量贡献了涉及单元面上基函数值的界面项。将在右侧面上的基函数迹向量表示为 $\\boldsymbol{\\phi}^R$，其元素为 $\\phi_m(+1)$；在左侧面上的表示为 $\\boldsymbol{\\phi}^L$，其元素为 $\\phi_m(-1)$。在单元 $j$ 右侧面上 $u_h$ 的标量求值为 $\\sum_{n=0}^p U_{j,n}\\,\\phi_n(+1)$。面贡献矩阵可以组装为：\n  $$B_r = \\boldsymbol{\\phi}^R\\,(\\boldsymbol{\\phi}^R)^{\\top}, \\quad B_l = \\boldsymbol{\\phi}^L\\,(\\boldsymbol{\\phi}^R)^{\\top}.$$\n- 单元 $j$ 上的半离散 DG 常微分方程 (ODE) 可以写作：\n  $$M\\,\\frac{d\\mathbf{U}_j}{dt} = a\\left(D\\,\\mathbf{U}_j - B_r\\,\\mathbf{U}_j + B_l\\,\\mathbf{U}_{j-1}\\right),$$\n  其中 $\\mathbf{U}_j \\in \\mathbb{R}^{p+1}$ 汇集了单元 $j$ 上的系数。周期性边界条件将单元索引以 $N$ 为模耦合起来。\n\nFourier 分析：\n- 假设一个跨单元的 Fourier 模式，形式为 $\\mathbf{U}_j(t) = \\mathbf{v}\\,e^{i j \\theta}\\,e^{\\lambda t}$，其中 $\\theta \\in [0,2\\pi)$ 是无量纲的单元间相位，$\\lambda(\\theta)$ 是时间增长率。代入此拟设可得到块符号：\n  $$G(\\theta) = M^{-1}\\,a\\left(D - B_r + e^{-i\\theta} B_l\\right) \\in \\mathbb{C}^{(p+1)\\times(p+1)}.$$\n- $G(\\theta)$ 的特征值 $\\lambda_m(\\theta)$ 提供了半离散的色散和耗散信息。将具有最大实部（最接近零耗散）的特征值定义为数值物理分支。对于该分支，定义：\n  $$k^\\ast(\\theta) = -\\frac{\\operatorname{Im}(\\lambda(\\theta))}{a}, \\quad \\sigma(\\theta) = -\\operatorname{Re}(\\lambda(\\theta)),$$\n  其中 $k^\\ast(\\theta)$ 是数值波数，$\\sigma(\\theta)$ 是耗散率。请注意，$k^\\ast$ 的单位是长度的倒数，$\\sigma$ 的单位是时间的倒数。所有角度都必须使用弧度。\n\n你的任务：\n- 实现一个程序，该程序对于给定的参数，在参考单元上使用多项式基 $\\phi_n(\\xi) = \\xi^n$ 构造 $M$、$D$、$B_r$ 和 $B_l$，计算 $G(\\theta)$，获得其特征值，选择物理分支（具有最大实部的特征值），并为指定的测试用例返回 $k^\\ast(\\theta)$ 和 $\\sigma(\\theta)$。\n- 使用对次数至少为 $2p+1$ 的多项式精确的高斯求积法来组装 $M$ 和 $D$。\n- 使用如前所述的 $a0$ 迎风格式。所有角度都必须使用弧度。\n\n单位：\n- 将 $k^\\ast$ 以 $\\text{m}^{-1}$ 表示，$\\sigma$ 以 $\\text{s}^{-1}$ 表示。将所有浮点输出四舍五入到 8 位小数。\n\n测试套件：\n- 使用 $L = 1$ 米，$a = 1$ 米/秒，以及 $N = 40$ 个单元，因此 $h = L/N$ 米。\n- 评估以下 $(p,\\theta)$ 对：\n  1. $p = 0$，$\\theta = \\pi/6$。\n  2. $p = 0$，$\\theta = \\pi$。\n  3. $p = 1$，$\\theta = 0$。\n  4. $p = 1$，$\\theta = \\pi/6$。\n  5. $p = 1$，$\\theta = \\pi/2$。\n  6. $p = 1$，$\\theta = \\pi$。\n\n要求的最终输出格式：\n- 你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。对于每个测试用例，按顺序附加两个浮点数：首先是 $k^\\ast(\\theta)$（单位为 $\\text{m}^{-1}$），然后是 $\\sigma(\\theta)$（单位为 $\\text{s}^{-1}$）。因此，总体输出应包含 12 个数字，按照上面列出的测试用例的顺序排列，每个数字都四舍五入到 8 位小数。示例格式（仅用于说明）：$[k^\\ast_1,\\sigma_1,k^\\ast_2,\\sigma_2,\\ldots,k^\\ast_6,\\sigma_6]$。",
            "solution": "该问题要求对周期性域 $x \\in [0,L]$ 上的一维线性平流方程 $u_t + a\\,u_x = 0$ 的半离散间断 Galerkin (DG) 格式进行 Fourier 分析。该分析旨在针对给定的多项式次数 $p$ 和单元间相位角 $\\theta$，找到数值色散关系 $k^\\ast(\\theta)$ 和耗散率 $\\sigma(\\theta)$。\n\nDG 方法从单元 $K_j = [x_{j-\\frac{1}{2}}, x_{j+\\frac{1}{2}}]$ 上的弱形式开始。将 PDE 乘以一个测试函数 $v$ 并在 $K_j$ 上进行分部积分，得到：\n$$\n\\int_{K_j} v u_t \\,dx + [a v u]_{x_{j-\\frac{1}{2}}}^{x_{j+\\frac{1}{2}}} - \\int_{K_j} a (\\partial_x v) u \\,dx = 0\n$$\n单元界面处的通量项 $[a v u]$ 被数值通量所替代。对于 $a0$ 的迎风通量，界面处的状态 $u$ 取自迎风（左）侧。令 $u_h(x,t)$ 为 $u(x,t)$ 的多项式近似。弱形式变为：\n$$\n\\int_{K_j} v u_{h,t} \\,dx + a v(x_{j+\\frac{1}{2}}) u_h(x_{j+\\frac{1}{2}}^-) - a v(x_{j-\\frac{1}{2}}) u_h(x_{j-\\frac{1}{2}}^-) - \\int_{K_j} a (\\partial_x v) u_h \\,dx = 0\n$$\n局部解和测试函数通过映射 $x = x_j + \\frac{h}{2}\\xi$ 在参考单元 $\\hat{K}=[-1,1]$ 上的一个基 $\\{\\phi_n\\}_{n=0}^p$ 中展开，其中 $h=L/N$ 是单元尺寸。我们使用单项式基 $\\phi_n(\\xi) = \\xi^n$。近似解为 $u_h|_{K_j}(\\xi,t) = \\sum_{n=0}^p U_{j,n}(t)\\phi_n(\\xi)$，测试函数为 $v = \\phi_m(\\xi)$，$m=0, \\dots, p$。\n\n将这些代入弱形式，并进行变量替换 $dx = \\frac{h}{2}d\\xi$ 和 $\\partial_x = \\frac{2}{h}\\partial_\\xi$，我们得到了关于单元 $j$ 上系数 $\\mathbf{U}_j = [U_{j,0}, \\dots, U_{j,p}]^T$ 的一个常微分方程组 (ODEs)。各项被识别为矩阵-向量乘积：\n\n1.  时间导数项给出质量矩阵 $M$：\n    $$M_{mn} = \\int_{K_j} \\phi_m \\phi_n \\,dx = \\frac{h}{2}\\int_{-1}^{1} \\phi_m(\\xi)\\phi_n(\\xi)\\,d\\xi$$\n2.  体积分给出类刚度矩阵 $S$：\n    $$S_{mn} = \\int_{K_j} \\phi_n (\\partial_x \\phi_m) \\,dx = \\int_{-1}^{1} \\phi_n(\\xi)(\\partial_\\xi \\phi_m(\\xi))\\,d\\xi = D_{mn}$$\n    注意，问题将 $D$ 定义为此矩阵 $S$。ODE 中的项是 $-a \\mathbf{S} \\mathbf{U}_j = -a \\mathbf{D} \\mathbf{U}_j$。\n3.  界面通量项涉及在边界 $\\xi = \\pm 1$ 处计算基函数的值。在右边界 $x_{j+\\frac{1}{2}}$ (其中 $\\xi=+1$) 处的项是 $a \\phi_m(1) \\sum_n U_{j,n} \\phi_n(1)$。令 $\\boldsymbol{\\phi}^R$ 为元素为 $\\phi_m(1)$ 的列向量。此项变为 $a (\\boldsymbol{\\phi}^R \\boldsymbol{\\phi}^{R,T}) \\mathbf{U}_j = a \\mathbf{B}_r \\mathbf{U}_j$。在左边界 $x_{j-\\frac{1}{2}}$ (其中 $\\xi=-1$) 处的项依赖于相邻单元 $j-1$ 的解，具体为 $u_h(x_{j-\\frac{1}{2}}^-) = u_h(x_{(j-1)+\\frac{1}{2}}^-)$。此项为 $-a \\phi_m(-1) \\sum_n U_{j-1,n} \\phi_n(1)$。令 $\\boldsymbol{\\phi}^L$ 为元素为 $\\phi_m(-1)$ 的列向量。此项变为 $-a (\\boldsymbol{\\phi}^L \\boldsymbol{\\phi}^{R,T}) \\mathbf{U}_{j-1} = -a \\mathbf{B}_l \\mathbf{U}_{j-1}$。\n\n组合这些项，我们得到 $\\mathbf{M} \\frac{d\\mathbf{U}_j}{dt} + a \\mathbf{B}_r \\mathbf{U}_j - a \\mathbf{B}_l \\mathbf{U}_{j-1} - a \\mathbf{D} \\mathbf{U}_j = 0$，这可以重新排列成问题中给出的形式：\n$$\n\\mathbf{M} \\frac{d\\mathbf{U}_j}{dt} = a(\\mathbf{D}\\mathbf{U}_j - \\mathbf{B}_r \\mathbf{U}_j + \\mathbf{B}_l \\mathbf{U}_{j-1})\n$$\n矩阵 $M$ 和 $D$ 使用 $p+1$ 个点的高斯求积法进行组装，该方法对次数高达 $2(p+1)-1 = 2p+1$ 的多项式是精确的。这满足了问题的要求。\n\n对于 Fourier 分析，我们代入拟设 $\\mathbf{U}_j(t) = \\mathbf{v} e^{i j \\theta} e^{\\lambda t}$，其中 $\\theta$ 是无量纲波数或单元间相位角，$\\lambda$ 是复时间增长率。\n$$\n\\lambda \\mathbf{M} \\mathbf{v} e^{i j \\theta} e^{\\lambda t} = a(\\mathbf{D}\\mathbf{v} e^{i j \\theta} e^{\\lambda t} - \\mathbf{B}_r \\mathbf{v} e^{i j \\theta} e^{\\lambda t} + \\mathbf{B}_l \\mathbf{v} e^{i (j-1) \\theta} e^{\\lambda t})\n$$\n两边除以 $e^{i j \\theta} e^{\\lambda t}$ 得到广义特征值问题：\n$$\n\\lambda \\mathbf{M} \\mathbf{v} = a(\\mathbf{D} - \\mathbf{B}_r + e^{-i\\theta} \\mathbf{B}_l) \\mathbf{v}\n$$\n这等价于标准特征值问题 $\\lambda \\mathbf{v} = G(\\theta) \\mathbf{v}$，其中 $G(\\theta)$ 是块符号：\n$$\nG(\\theta) = a \\mathbf{M}^{-1} (\\mathbf{D} - \\mathbf{B}_r + e^{-i\\theta} \\mathbf{B}_l)\n$$\n$G(\\theta)$ 的特征值 $\\lambda_m(\\theta)$ 表征了数值格式的行为。物理分支对应于应该传播的波模式。它被识别为具有代数上最大实部的特征值。如果多个特征值共享这个最大实部，则需要一个决胜规则。我们选择其虚部最接近精确色散关系 $\\lambda_{\\text{exact}} = -ika = -i(\\theta/h)a$ 的特征值。\n\n从选定的物理特征值 $\\lambda(\\theta)$，数值波数 $k^\\ast(\\theta)$ 和耗散率 $\\sigma(\\theta)$ 定义为：\n$$\nk^\\ast(\\theta) = -\\frac{\\operatorname{Im}(\\lambda(\\theta))}{a}, \\quad \\sigma(\\theta) = -\\operatorname{Re}(\\lambda(\\theta))\n$$\n该实现将为每个给定的 $p$ 构造矩阵，为每个给定的 $\\theta$ 形成 $G(\\theta)$，求解其特征值，选择物理分支，并计算得到的 $k^\\ast$ 和 $\\sigma$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef compute_dg_k_sigma(p, theta, L, a, N):\n    \"\"\"\n    Computes numerical wavenumber and dissipation for the DG scheme.\n\n    Args:\n        p (int): Polynomial degree of the basis.\n        theta (float): Cell-to-cell phase angle in radians.\n        L (float): Domain length.\n        a (float): Advection speed.\n        N (int): Number of elements.\n\n    Returns:\n        tuple[float, float]: A tuple containing the numerical wavenumber k*\n                             and the dissipation rate sigma.\n    \"\"\"\n    h = L / N\n    dim = p + 1\n\n    # Use Gaussian quadrature that is exact for polynomials of degree up to 2p+1.\n    # A rule with Nq points is exact for polynomials of degree up to 2*Nq - 1.\n    # We require 2*Nq - 1 >= 2p + 1, which implies Nq >= p + 1.\n    # We choose the minimum required number of points, Nq = p + 1.\n    num_quad_points = p + 1\n    xi_q, w_q = np.polynomial.legendre.leggauss(num_quad_points)\n\n    # Initialize element matrices\n    M = np.zeros((dim, dim))\n    D = np.zeros((dim, dim))\n\n    # Assemble Mass (M) and Volume (D) matrices using quadrature\n    for m in range(dim):\n        for n in range(dim):\n            # Integrand for mass matrix: phi_m * phi_n = xi^m * xi^n\n            m_integrand = xi_q**m * xi_q**n\n            \n            # Integrand for volume matrix: phi_n * d(phi_m)/d(xi) = xi^n * m*xi^(m-1)\n            if m > 0:\n                d_integrand = xi_q**n * m * xi_q**(m - 1)\n            else:  # for m=0, the derivative of phi_0=1 is 0\n                d_integrand = np.zeros_like(xi_q)\n\n            M[m, n] = (h / 2.0) * np.sum(w_q * m_integrand)\n            D[m, n] = np.sum(w_q * d_integrand)\n\n    # Assemble face matrices (Br, Bl)\n    # Basis traces at right (+1) and left (-1) faces\n    phi_R = np.ones(dim)\n    phi_L = np.array([(-1)**m for m in range(dim)])\n\n    Br = np.outer(phi_R, phi_R)\n    Bl = np.outer(phi_L, phi_R)\n    \n    # Invert the mass matrix\n    M_inv = np.linalg.inv(M)\n    \n    # Factor from Fourier ansatz on the neighboring cell\n    z = np.exp(-1j * theta)\n    \n    # Assemble the intermediate matrix and the block symbol G(theta)\n    H_theta = D - Br + z * Bl\n    G_theta = a * (M_inv @ H_theta)\n\n    # Compute eigenvalues of the block symbol\n    eigvals = np.linalg.eigvals(G_theta)\n\n    # Select the physical branch eigenvalue\n    real_parts = np.real(eigvals)\n    max_real = np.max(real_parts)\n    \n    # Find all eigenvalues with the maximal real part\n    candidates = eigvals[np.isclose(real_parts, max_real)]\n    \n    if len(candidates) == 1:\n        lambda_phys = candidates[0]\n    else:\n        # Tie-breaking rule for degenerate cases:\n        # Choose the eigenvalue whose imaginary part is closest to the \n        # imaginary part of the exact dispersion relation, lambda_exact = -ika.\n        # The wavenumber for a phase theta is k = theta/h.\n        imag_target = -theta * a / h\n        imag_parts = np.imag(candidates)\n        best_idx = np.argmin(np.abs(imag_parts - imag_target))\n        lambda_phys = candidates[best_idx]\n\n    # Calculate numerical wavenumber and dissipation rate\n    k_star = -np.imag(lambda_phys) / a\n    sigma = -np.real(lambda_phys)\n    \n    return k_star, sigma\n\ndef solve():\n    # Define parameters from the problem statement.\n    L = 1.0   # meters\n    a = 1.0   # meters per second\n    N = 40    # number of elements\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (0, np.pi/6),\n        (0, np.pi),\n        (1, 0.0),\n        (1, np.pi/6),\n        (1, np.pi/2),\n        (1, np.pi),\n    ]\n\n    results = []\n    for p, theta in test_cases:\n        k_star, sigma = compute_dg_k_sigma(p, theta, L, a, N)\n        results.append(round(k_star, 8))\n        results.append(round(sigma, 8))\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}