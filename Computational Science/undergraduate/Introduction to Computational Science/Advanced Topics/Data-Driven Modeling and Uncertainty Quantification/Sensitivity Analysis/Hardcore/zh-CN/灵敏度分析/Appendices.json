{
    "hands_on_practices": [
        {
            "introduction": "理解敏感性的最直接方法之一是通过解析计算。本练习将探讨一个物理系统（RLC 串联电路）的关键特性（谐振频率）对其组件参数（电容）变化的响应。通过推导谐振频率 $\\omega_{0}$ 对电容 $C$ 的归一化灵敏度 $S_{C}$，你将亲身体验如何从第一性原理出发量化这种依赖关系，并得出一个简洁而富有洞察力的结果。",
            "id": "3272518",
            "problem": "一个电阻–电感–电容（RLC）串联电路由一个角频率为 $\\omega$ 的电源驱动，工作在正弦稳态。电感器的阻抗为 $j \\omega L$，电容器的阻抗为 $\\frac{1}{j \\omega C}$，电阻器的阻抗为 $R$，其中 $j$ 表示虚数单位，$L$ 是电感值，$C$ 是电容值，$R$ 是电阻值。在串联RLC网络的通常工程意义上，谐振角频率 $\\omega_{0}$ 被定义为净电抗为零时的频率，此时阻抗为纯实数。\n\n电容器的制造公差意味着实际电容值为 $C + \\delta C$，其中 $|\\delta C| \\ll C$。使用基本原理（阻抗定义和谐振条件），推导谐振角频率 $\\omega_{0}$ 作为 $L$ 和 $C$ 的函数，然后根据全微分定义 $\\omega_{0}$ 相对于 $C$ 的归一化灵敏度为\n$$\nS_{C} \\equiv \\frac{C}{\\omega_{0}} \\frac{\\partial \\omega_{0}}{\\partial C}.\n$$\n计算 $S_{C}$，将最终答案表示为单个实数。无需四舍五入，最终答案不带单位。",
            "solution": "该问题经核实具有科学依据、提法明确且客观。这是一个电路分析和灵敏度理论中的标准问题。我们可以开始求解。\n\n串联RLC电路的总阻抗 $Z$ 是电阻器（$R$）、电感器（$L$）和电容器（$C$）各自阻抗的总和。各阻抗分别为 $Z_R = R$，$Z_L = j \\omega L$ 和 $Z_C = \\frac{1}{j \\omega C}$，其中 $j$ 是满足 $j^2 = -1$ 的虚数单位。\n\n总阻抗作为角频率 $\\omega$ 的函数为：\n$$\nZ(\\omega) = Z_R + Z_L + Z_C = R + j \\omega L + \\frac{1}{j \\omega C}\n$$\n利用属性 $\\frac{1}{j} = -j$，我们可以将阻抗重写为：\n$$\nZ(\\omega) = R + j \\omega L - \\frac{j}{\\omega C} = R + j \\left(\\omega L - \\frac{1}{\\omega C}\\right)\n$$\n阻抗 $Z(\\omega)$ 是一个复数，其包含实部（电阻）和虚部（电抗）。实部为 $\\text{Re}(Z) = R$，虚部或净电抗为 $\\text{Im}(Z) = X(\\omega) = \\omega L - \\frac{1}{\\omega C}$。\n\n题目将谐振角频率 $\\omega_0$ 定义为净电抗为零时的频率。这个条件意味着总阻抗的虚部为零：\n$$\n\\text{Im}(Z(\\omega_0)) = 0\n$$\n代入电抗的表达式，我们得到：\n$$\n\\omega_0 L - \\frac{1}{\\omega_0 C} = 0\n$$\n为了解出 $\\omega_0$，我们重排该方程：\n$$\n\\omega_0 L = \\frac{1}{\\omega_0 C}\n$$\n$$\n\\omega_0^2 = \\frac{1}{LC}\n$$\n由于角频率必须为正值，我们取正平方根：\n$$\n\\omega_0 = \\frac{1}{\\sqrt{LC}} = (LC)^{-1/2}\n$$\n这就是谐振角频率作为电感 $L$ 和电容 $C$ 函数的表达式。\n\n接下来，我们必须计算 $\\omega_0$ 相对于 $C$ 的归一化灵敏度，其定义为：\n$$\nS_{C} \\equiv \\frac{C}{\\omega_{0}} \\frac{\\partial \\omega_{0}}{\\partial C}\n$$\n为了计算这个值，我们首先需要求出 $\\omega_0$ 相对于 $C$ 的偏导数。我们将 $L$ 视为常数。\n$$\n\\omega_0(C) = L^{-1/2} C^{-1/2}\n$$\n使用求导的幂法则 $\\frac{d}{dx}(x^n) = nx^{n-1}$，我们得到：\n$$\n\\frac{\\partial \\omega_0}{\\partial C} = L^{-1/2} \\left(-\\frac{1}{2} C^{-1/2 - 1}\\right) = L^{-1/2} \\left(-\\frac{1}{2} C^{-3/2}\\right)\n$$\n$$\n\\frac{\\partial \\omega_0}{\\partial C} = -\\frac{1}{2} L^{-1/2} C^{-3/2}\n$$\n现在，我们将 $\\omega_0$ 和 $\\frac{\\partial \\omega_0}{\\partial C}$ 的表达式代入灵敏度公式：\n$$\nS_C = \\frac{C}{\\omega_0} \\left( -\\frac{1}{2} L^{-1/2} C^{-3/2} \\right)\n$$\n代入 $\\omega_0 = (LC)^{-1/2} = L^{-1/2}C^{-1/2}$：\n$$\nS_C = \\frac{C}{L^{-1/2}C^{-1/2}} \\left( -\\frac{1}{2} L^{-1/2} C^{-3/2} \\right)\n$$\n我们可以通过合并各项来简化这个表达式：\n$$\nS_C = -\\frac{1}{2} \\cdot \\frac{C}{L^{-1/2}C^{-1/2}} \\cdot L^{-1/2} C^{-3/2}\n$$\n与 $L$ 相关的项 ($L^{-1/2}$)会相互消去。\n$$\nS_C = -\\frac{1}{2} \\cdot \\frac{C}{C^{-1/2}} \\cdot C^{-3/2}\n$$\n现在，合并 $C$ 的幂：\n$$\nS_C = -\\frac{1}{2} \\cdot C^{1 - (-1/2) - 3/2} = -\\frac{1}{2} \\cdot C^{1 + 1/2 - 3/2} = -\\frac{1}{2} \\cdot C^{3/2 - 3/2} = -\\frac{1}{2} \\cdot C^0\n$$\n因为任何非零量的0次幂都为1，我们有：\n$$\nS_C = -\\frac{1}{2}\n$$\n谐振角频率相对于电容的归一化灵敏度是一个常数，其值为 $-\\frac{1}{2}$。这表示电容值的微小相对增加会导致谐振频率的相对减小，其减小幅度为电容增幅的一半。例如，$C$ 增加 $1\\%$ 会导致 $\\omega_0$ 近似减少 $0.5\\%$。",
            "answer": "$$\\boxed{-\\frac{1}{2}}$$"
        },
        {
            "introduction": "在掌握了敏感性的基本定义后，下一个练习将引导你深入探索数值算法中一个更为精妙的方面。它旨在区分“问题”本身的灵敏度（即其“条件数”）和解决该问题的“算法”对输入的敏感性。通过分析牛顿法在求解具有单根与重根的方程时的表现差异，你将深刻理解为何某些问题本质上就更难精确求解，以及算法的性能如何在病态问题中发生变化。",
            "id": "3272508",
            "problem": "一个标量非线性方程将用牛顿法求解。设 $f:\\mathbb{R}\\to\\mathbb{R}$ 在根 $x=r$ 附近是二次连续可微的，且 $f(r)=0$。牛顿迭代定义为 $x_{k+1}=x_k-\\dfrac{f(x_k)}{f'(x_k)}$。如果 $f'(r)\\neq 0$，则根 $x=r$ 称为单根；如果 $f'(r)=0$ 且 $f''(r)\\neq 0$，则称为二重根。在此背景下，考虑敏感性的两个方面：\n\n- 解对​​方程中微小加性扰动的敏感性：求解 $f(x)+\\varepsilon=0$，其中 $\\varepsilon\\in\\mathbb{R}$ 很小。敏感性通过受扰动的根 $x=r(\\varepsilon)$ 的大小如何随 $\\varepsilon$ 变化来量化。\n- 牛顿法对初始猜测值扰动的敏感性：从 $x_0=r+e_0$ 开始，其中 $e_0$ 很小，并量化单步误差 $e_1=x_{1}-r$ 如何依赖于 $e_0$。\n\n假设该设定是局部适定的，因此当 $f'(r)=0$ 时，$f$ 是充分光滑的且 $f''(r)\\neq 0$。当该方法应用于二重根与单根附近时，哪个选项最能描述敏感性的变化？\n\nA. 在单根附近，方程 $f(x)+\\varepsilon=0$ 的解的根位移为 $\\mathcal{O}(\\varepsilon)$ 阶，牛顿法的单步误差满足 $e_1=\\mathcal{O}(e_0^2)$；在二重根附近，方程 $f(x)+\\varepsilon=0$ 的解的根位移为 $\\mathcal{O}(\\sqrt{|\\varepsilon|})$ 阶，牛顿法的单步误差满足 $e_1=\\mathcal{O}(e_0)$（具体来说，$e_1\\approx \\dfrac{1}{2}e_0$）。\n\nB. 在单根附近，方程 $f(x)+\\varepsilon=0$ 的解的根位移为 $\\mathcal{O}(\\sqrt{|\\varepsilon|})$ 阶，牛顿法的单步误差满足 $e_1=\\mathcal{O}(e_0)$；在二重根附近，方程 $f(x)+\\varepsilon=0$ 的解的根位移为 $\\mathcal{O}(\\varepsilon)$ 阶，牛顿法的单步误差满足 $e_1=\\mathcal{O}(e_0^2)$。\n\nC. 在单根和二重根两种情况下，方程 $f(x)+\\varepsilon=0$ 的解的根位移均为 $\\mathcal{O}(\\varepsilon)$ 阶，牛顿法的单步误差均满足 $e_1=\\mathcal{O}(e_0^2)$。\n\nD. 在二重根附近，方程 $f(x)+\\varepsilon=0$ 的解的根位移为 $\\mathcal{O}(\\varepsilon)$ 阶，牛顿法在一步内完全消除初始误差，即对于所有足够小的 $e_0$，$e_1=0$。",
            "solution": "首先评估问题陈述的有效性。\n\n### 步骤 1：提取已知条件\n- 一个标量非线性方程将用牛顿法求解。\n- 函数 $f:\\mathbb{R}\\to\\mathbb{R}$ 在根 $x=r$ 附近是二次连续可微的。\n- 根的条件是 $f(r)=0$。\n- 牛顿迭代为 $x_{k+1}=x_k-\\dfrac{f(x_k)}{f'(x_k)}$。\n- 单根定义为 $f'(r)\\neq 0$。\n- 二重根定义为 $f'(r)=0$ 且 $f''(r)\\neq 0$。\n- 根的敏感性通过求解扰动方程 $f(x)+\\varepsilon=0$（其中 $\\varepsilon\\in\\mathbb{R}$ 很小）并量化根 $r(\\varepsilon)$ 的变化来分析。\n- 牛顿法的敏感性通过从 $x_0=r+e_0$ 开始（其中 $e_0$ 很小）并量化单步误差 $e_1=x_1-r$ 来分析。\n- 假设问题是局部适定的，且当 $f'(r)=0$ 时 $f''(r)\\neq 0$。\n- 问题要求描述当该方法应用于二重根与单根附近时敏感性的变化。\n\n### 步骤 2：使用提取的已知条件进行验证\n问题陈述是科学合理的、适定的和客观的。这是数值分析入门中的一个标准问题，用于说明问题条件数和算法收敛速度的概念。单根和二重根的定义是标准的。两种类型的敏感性分析（问题敏感性 vs. 方法敏感性）定义明确。所有必要的假设，例如二重根的二阶导数不为零，都已提供。该问题是可形式化的，并要求基于泰勒级数展开进行可验证的数学推导，这是该领域的核心技术。\n\n1.  **科学/事实不健全**：无。该问题基于微积分和数值分析的基本原理。\n2.  **不可形式化或不相关**：无。该问题与数值方法中的敏感性分析直接相关。\n3.  **设置不完整或矛盾**：无。所有必要的定义和条件都已提供并且是一致的。\n4.  **不切实际或不可行**：无。该问题在标准数学框架内进行操作。\n5.  **不适定或结构不良**：无。该问题结构良好，并能导出一个唯一的、可推导的结论。\n6.  **伪深刻、琐碎或同义反复**：无。该问题需要一个非平凡的推导，突显了数值分析中的关键概念。\n7.  **超出科学可验证性范围**：无。结果可以通过数学方法证明。\n\n### 步骤 3：结论和行动\n问题陈述是**有效的**。将推导一个完整的解。\n\n### 推导\n\n我们分析单根和二重根两种情况下的敏感性。这需要使用函数 $f(x)$ 在根 $x=r$ 附近的泰勒级数展开。\n\n**第 1 部分：单根分析**\n单根 $x=r$ 的特征是 $f(r)=0$ 和 $f'(r)\\neq 0$。\n\n**1.1. 解的敏感性**\n我们分析扰动方程 $f(x) + \\varepsilon = 0$。设新根为 $x(\\varepsilon) = r + \\delta r$。我们假设当 $\\varepsilon$ 很小时，$\\delta r$ 也很小。\n我们将 $x=r+\\delta r$ 代入方程：\n$$f(r+\\delta r) + \\varepsilon = 0$$\n我们在 $r$ 附近对 $f(r+\\delta r)$ 进行泰勒展开：\n$$f(r) + f'(r)\\delta r + \\mathcal{O}((\\delta r)^2) + \\varepsilon = 0$$\n由于 $f(r)=0$，这简化为：\n$$f'(r)\\delta r + \\mathcal{O}((\\delta r)^2) + \\varepsilon = 0$$\n对于小的 $\\varepsilon$，$\\delta r$ 也很小，因此我们可以忽略高阶项：\n$$f'(r)\\delta r \\approx -\\varepsilon$$\n求解根的扰动 $\\delta r$：\n$$\\delta r \\approx -\\frac{\\varepsilon}{f'(r)}$$\n由于 $f'(r)$ 是一个非零常数，根的扰动 $\\delta r$ 与 $\\varepsilon$ 成正比。因此，根位移是 $\\mathcal{O}(\\varepsilon)$ 阶。这表明该问题是适定的（well-conditioned）。\n\n**1.2. 牛顿法的敏感性（单步误差）**\n设初始猜测值为 $x_0 = r + e_0$，其中 $e_0$ 是初始误差。第一次迭代得到 $x_1 = x_0 - \\frac{f(x_0)}{f'(x_0)}$。新的误差是 $e_1 = x_1 - r$。\n$$e_1 = (x_0 - r) - \\frac{f(x_0)}{f'(x_0)} = e_0 - \\frac{f(r+e_0)}{f'(r+e_0)}$$\n我们在 $r$ 附近对分子和分母使用泰勒展开：\n$$f(r+e_0) = f(r) + f'(r)e_0 + \\frac{f''(r)}{2!}e_0^2 + \\mathcal{O}(e_0^3) = f'(r)e_0 + \\frac{f''(r)}{2}e_0^2 + \\mathcal{O}(e_0^3)$$\n$$f'(r+e_0) = f'(r) + f''(r)e_0 + \\mathcal{O}(e_0^2)$$\n将这些代入 $e_1$ 的表达式中：\n$$e_1 = e_0 - \\frac{f'(r)e_0 + \\frac{1}{2}f''(r)e_0^2 + \\mathcal{O}(e_0^3)}{f'(r) + f''(r)e_0 + \\mathcal{O}(e_0^2)}$$\n从分母中提出因子 $f'(r)$：\n$$e_1 = e_0 - \\frac{f'(r)e_0 + \\frac{1}{2}f''(r)e_0^2 + \\dots}{f'(r) \\left(1 + \\frac{f''(r)}{f'(r)}e_0 + \\dots\\right)}$$\n对于小的 $z = \\frac{f''(r)}{f'(r)}e_0$，使用几何级数近似 $\\frac{1}{1+z} \\approx 1-z$：\n$$e_1 \\approx e_0 - \\frac{1}{f'(r)} \\left(f'(r)e_0 + \\frac{1}{2}f''(r)e_0^2\\right) \\left(1 - \\frac{f''(r)}{f'(r)}e_0\\right)$$\n展开并保留到 $e_0^2$ 阶的项：\n$$e_1 \\approx e_0 - \\frac{1}{f'(r)} \\left(f'(r)e_0 + \\frac{1}{2}f''(r)e_0^2 - f'(r)\\frac{f''(r)}{f'(r)}e_0^2\\right)$$\n$$e_1 \\approx e_0 - \\frac{1}{f'(r)} \\left(f'(r)e_0 - \\frac{1}{2}f''(r)e_0^2\\right)$$\n$$e_1 \\approx e_0 - \\left(e_0 - \\frac{f''(r)}{2f'(r)}e_0^2\\right) = \\frac{f''(r)}{2f'(r)}e_0^2$$\n误差 $e_1$ 与前一个误差 $e_0$ 的平方成正比。因此，$e_1 = \\mathcal{O}(e_0^2)$，这是二次收敛的标志。\n\n**第 2 部分：二重根分析**\n二重根 $x=r$ 的特征是 $f(r)=0$，$f'(r)=0$，和 $f''(r)\\neq 0$。\n\n**2.1. 解的敏感性**\n我们再次分析扰动方程 $f(x) + \\varepsilon = 0$，其中 $x(\\varepsilon) = r + \\delta r$。\n$$f(r+\\delta r) + \\varepsilon = 0$$\n$f(r+\\delta r)$ 在 $r$ 附近的泰勒展开为：\n$$f(r) + f'(r)\\delta r + \\frac{f''(r)}{2!}(\\delta r)^2 + \\mathcal{O}((\\delta r)^3) + \\varepsilon = 0$$\n使用二重根的条件，这变成：\n$$0 + 0 \\cdot \\delta r + \\frac{f''(r)}{2}(\\delta r)^2 + \\mathcal{O}((\\delta r)^3) + \\varepsilon = 0$$\n对于小的 $\\varepsilon$ 和 $\\delta r$，我们忽略高阶项：\n$$\\frac{f''(r)}{2}(\\delta r)^2 \\approx -\\varepsilon$$\n求解 $\\delta r$：\n$$(\\delta r)^2 \\approx -\\frac{2\\varepsilon}{f''(r)} \\implies |\\delta r| \\approx \\sqrt{\\left|-\\frac{2\\varepsilon}{f''(r)}\\right|}$$\n根扰动的大小 $|\\delta r|$ 与 $\\sqrt{|\\varepsilon|}$ 成正比。因此，根位移是 $\\mathcal{O}(\\sqrt{|\\varepsilon|})$ 阶。平方根依赖关系表明寻找二重根的问题是病态的（ill-conditioned）。\n\n**2.2. 牛顿法的敏感性（单步误差）**\n和之前一样，$e_1 = e_0 - \\frac{f(r+e_0)}{f'(r+e_0)}$。我们使用适用于二重根的泰勒展开：\n$$f(r+e_0) = f(r) + f'(r)e_0 + \\frac{f''(r)}{2}e_0^2 + \\mathcal{O}(e_0^3) = \\frac{f''(r)}{2}e_0^2 + \\mathcal{O}(e_0^3)$$\n$$f'(r+e_0) = f'(r) + f''(r)e_0 + \\frac{f'''(r)}{2}e_0^2 + \\mathcal{O}(e_0^3) = f''(r)e_0 + \\mathcal{O}(e_0^2)$$\n将这些代入 $e_1$ 的表达式中：\n$$e_1 = e_0 - \\frac{\\frac{1}{2}f''(r)e_0^2 + \\mathcal{O}(e_0^3)}{f''(r)e_0 + \\mathcal{O}(e_0^2)}$$\n为了找到小 $e_0$ 的主导行为，我们考虑首项的比率：\n$$e_1 \\approx e_0 - \\frac{\\frac{1}{2}f''(r)e_0^2}{f''(r)e_0}$$\n由于 $f''(r)\\neq 0$ 且我们假设 $e_0\\neq 0$，我们可以简化：\n$$e_1 \\approx e_0 - \\frac{1}{2}e_0 = \\frac{1}{2}e_0$$\n误差 $e_1$ 与前一个误差 $e_0$ 成线性比例，比例常数约为 $\\frac{1}{2}$。因此，$e_1 = \\mathcal{O}(e_0)$，这表示线性收敛。\n\n### 结果总结与选项评估\n- **单根**：\n    - 解的敏感性：$\\delta r = \\mathcal{O}(\\varepsilon)$。\n    - 方法的敏感性：$e_1 = \\mathcal{O}(e_0^2)$。\n- **二重根**：\n    - 解的敏感性：$|\\delta r| = \\mathcal{O}(\\sqrt{|\\varepsilon|})$。\n    - 方法的敏感性：$e_1 \\approx \\frac{1}{2}e_0$，所以 $e_1 = \\mathcal{O}(e_0)$。\n\n现在我们根据这个总结来评估给出的选项。\n\n**A. 在单根附近，方程 $f(x)+\\varepsilon=0$ 的解的根位移为 $\\mathcal{O}(\\varepsilon)$ 阶，牛顿法的单步误差满足 $e_1=\\mathcal{O}(e_0^2)$；在二重根附近，方程 $f(x)+\\varepsilon=0$ 的解的根位移为 $\\mathcal{O}(\\sqrt{|\\varepsilon|})$ 阶，牛顿法的单步误差满足 $e_1=\\mathcal{O}(e_0)$（具体来说，$e_1\\approx \\dfrac{1}{2}e_0$）。**\n该选项与我们推导出的结果的四个部分完全匹配。\n**结论：正确。**\n\n**B. 在单根附近，方程 $f(x)+\\varepsilon=0$ 的解的根位移为 $\\mathcal{O}(\\sqrt{|\\varepsilon|})$ 阶，牛顿法的单步误差满足 $e_1=\\mathcal{O}(e_0)$；在二重根附近，方程 $f(x)+\\varepsilon=0$ 的解的根位移为 $\\mathcal{O}(\\varepsilon)$ 阶，牛顿法的单步误差满足 $e_1=\\mathcal{O}(e_0^2)$。**\n该选项将单根和二重根的结果互换了。\n**结论：错误。**\n\n**C. 在单根和二重根两种情况下，方程 $f(x)+\\varepsilon=0$ 的解的根位移均为 $\\mathcal{O}(\\varepsilon)$ 阶，牛顿法的单步误差均满足 $e_1=\\mathcal{O}(e_0^2)$。**\n该选项错误地声称二重根的行为与单根相同。我们的推导表明，在解的敏感性和方法收敛性方面都存在显著差异。\n**结论：错误。**\n\n**D. 在二重根附近，方程 $f(x)+\\varepsilon=0$ 的解的根位移为 $\\mathcal{O}(\\varepsilon)$ 阶，牛顿法在一步内完全消除初始误差，即对于所有足够小的 $e_0$，$e_1=0$。**\n该选项对二重根的情况提出了两个不正确的论断。根位移是 $\\mathcal{O}(\\sqrt{|\\varepsilon|})$，而不是 $\\mathcal{O}(\\varepsilon)$。牛顿法是线性收敛的（$e_1 \\approx \\frac{1}{2}e_0$），而不是一步收敛（$e_1=0$）。\n**结论：错误。**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "对于许多由微分方程描述的复杂系统，我们往往无法得到解析解，此时必须借助计算方法来评估其灵敏度。本练习将演示如何量化一个偏微分方程（PDE）的解对其边界条件变化的敏感程度。你将利用线性叠加原理来简化问题，然后应用有限差分法这一核心数值技术，通过编写代码来实际计算这种灵敏度。",
            "id": "3191044",
            "problem": "要求您量化和计算线性偏微分方程（PDE）解相对于狄利克雷（Dirichlet）边界数据扰动的灵敏度。考虑定义域 $\\Omega = (0,L)$ 上的一维稳态扩散-反应方程：\n$$\n-\\,k\\,\\frac{d^2 u}{dx^2} + c\\,u = f \\quad \\text{on } (0,L),\n$$\n其狄利克雷边界条件为\n$$\nu(0) = g_0 + \\delta g_0, \\quad u(L) = g_L + \\delta g_L,\n$$\n其中 $k > 0$ 是扩散系数，$c \\ge 0$ 是反应系数，$f$ 是给定的源项，$(\\delta g_0,\\delta g_L)$ 是微小的边界扰动。所有量均为无量纲。定义 $u(\\delta g)$ 为对应于扰动后边界 $(g_0+\\delta g_0, g_L+\\delta g_L)$ 的解，而 $u(0)$ 为对应于 $(\\delta g_0,\\delta g_L) = (0,0)$ 的基线解。对边界扰动的灵敏度由以下比率衡量\n$$\n\\alpha = \\frac{\\|u(\\delta g) - u(0)\\|}{\\|(\\delta g_0,\\delta g_L)\\|},\n$$\n其中分子是定义域 $(0,L)$ 上的 $L^2$ 范数，分母是边界数据向量的欧几里得范数。\n\n您的任务是：\n- 从线性偏微分方程的线性叠加原理出发，构建差分场 $w = u(\\delta g) - u(0)$。该差分场满足齐次方程和非齐次狄利克雷边界数据。\n- 使用具有 $N$ 个内部节点的二阶中心有限差分（FD）离散化方法对 $w$ 进行数值近似。使用步长为 $h = L/(N+1)$ 的均匀网格。对于算子 $-k\\,u'' + c\\,u$，内部节点索引 $i \\in \\{1,\\dots,N\\}$ 的标准有限差分格式为\n$$\n-\\,k\\,\\frac{w_{i-1} - 2w_i + w_{i+1}}{h^2} + c\\,w_i = 0,\n$$\n其中狄利克雷值 $w_0 = \\delta g_0$ 和 $w_{N+1} = \\delta g_L$ 分别进入第一个和最后一个内部方程的右侧。\n- 使用内部节点上的离散 $L^2$ 范数来近似分子：\n$$\n\\|w\\|_{L^2(0,L)} \\approx \\left( h \\sum_{i=1}^{N} w_i^2 \\right)^{1/2}.\n$$\n- 使用欧几里得范数计算边界扰动的大小：\n$$\n\\|(\\delta g_0,\\delta g_L)\\| = \\left( (\\delta g_0)^2 + (\\delta g_L)^2 \\right)^{1/2}.\n$$\n- 计算下面每个测试用例的灵敏度比率 $\\alpha$。\n\n实现要求：\n- 使用线性系统求解器计算内部节点的值 $(w_1,\\dots,w_N)$。\n- 仅使用如上所述的二阶中心有限差分法。\n- 所有量均为无量纲；不需要物理单位。\n- 将每个灵敏度比率 $\\alpha$ 报告为四舍五入到 $6$ 位小数的浮点数。\n\n测试套件：\n对于每个元组 $(L,k,c,N,\\delta g_0,\\delta g_L)$，计算相应的灵敏度比率 $\\alpha$：\n- 测试 $1$：$(L,k,c,N,\\delta g_0,\\delta g_L) = (\\,1.0,\\,1.0,\\,0.0,\\,200,\\,0.1,\\,-0.05\\,)$。\n- 测试 $2$：$(L,k,c,N,\\delta g_0,\\delta g_L) = (\\,5.0,\\,1.0,\\,0.0,\\,200,\\,0.1,\\,-0.05\\,)$。\n- 测试 $3$：$(L,k,c,N,\\delta g_0,\\delta g_L) = (\\,1.0,\\,1.0,\\,1.0,\\,200,\\,0.1,\\,-0.05\\,)$。\n- 测试 $4$：$(L,k,c,N,\\delta g_0,\\delta g_L) = (\\,0.25,\\,1.0,\\,10.0,\\,100,\\,0.0,\\,0.2\\,)$。\n- 测试 $5$：$(L,k,c,N,\\delta g_0,\\delta g_L) = (\\,2.0,\\,0.5,\\,0.0,\\,300,\\,0.05,\\,0.05\\,)$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个逗号分隔的列表，列表内容为按测试顺序排列的 5 个四舍五入后的灵敏度比率，并用方括号括起来，例如，“[a,b,c,d,e]”。每个条目必须四舍五入到 6 位小数，并以标准十进制表示法打印，不使用科学记数法。\n\n注意：您必须提供一个完整的、可运行的程序，该程序需按规定实现有限差分法，并以所述的精确格式输出结果。不要读取任何输入；请将测试套件硬编码到您的程序中。",
            "solution": "经评估，用户提供的问题是有效的。它在科学上是合理的、适定的，并且为完整的数值求解提供了所有必要的参数。该问题要求计算线性偏微分方程（PDE）相对于边界条件扰动的灵敏度比率，这是计算科学中灵敏度分析的标准流程。\n\n求解过程包括四个基本步骤：\n1.  推导解的差值所满足的控制方程。\n2.  使用有限差分法对该方程进行离散化。\n3.  建立并求解所得的线性方程组。\n4.  使用离散范数计算灵敏度比率。\n\n**1. 叠加原理与差分场**\n控制性偏微分方程是一个线性二阶常微分方程：\n$$\n-\\,k\\,\\frac{d^2 u}{dx^2} + c\\,u = f \\quad \\text{for } x \\in (0,L)\n$$\n我们将线性微分算子表示为 $\\mathcal{L}u = -k\\,u'' + c\\,u$。该问题涉及一个基线解 $u(0)$（对应于边界条件 $u(0) = g_0$ 和 $u(L) = g_L$）和一个扰动解 $u(\\delta g)$（对应于边界条件 $u(0) = g_0 + \\delta g_0$ 和 $u(L) = g_L + \\delta g_L$）。\n\n这两种情况的方程为：\n$$\n\\mathcal{L}u(0) = f, \\quad \\text{with B.C.s } u(0)(0) = g_0, u(0)(L) = g_L\n$$\n$$\n\\mathcal{L}u(\\delta g) = f, \\quad \\text{with B.C.s } u(\\delta g)(0) = g_0 + \\delta g_0, u(\\delta g)(L) = g_L + \\delta g_L\n$$\n我们关心的是定义为 $w = u(\\delta g) - u(0)$ 的差分场。由于算子 $\\mathcal{L}$ 的线性特性，我们可以写出：\n$$\n\\mathcal{L}w = \\mathcal{L}(u(\\delta g) - u(0)) = \\mathcal{L}u(\\delta g) - \\mathcal{L}u(0) = f - f = 0\n$$\n因此，差分场 $w$ 满足原偏微分方程的齐次形式：\n$$\n-\\,k\\,\\frac{d^2 w}{dx^2} + c\\,w = 0\n$$\n通过从扰动后的边界条件中减去基线边界条件，可以得到 $w$ 的边界条件：\n$$\nw(0) = u(\\delta g)(0) - u(0)(0) = (g_0 + \\delta g_0) - g_0 = \\delta g_0\n$$\n$$\nw(L) = u(\\delta g)(L) - u(0)(L) = (g_L + \\delta g_L) - g_L = \\delta g_L\n$$\n此推导证实，解对边界扰动的灵敏度可以通过求解一个更简单的、以扰动本身作为新边界条件的齐次偏微分方程来分析，该方程的解即为差分场 $w$。\n\n**2. 有限差分离散化**\n为了数值求解 $w(x)$，我们使用一个包含 $N$ 个内部节点的均匀网格对定义域 $(0,L)$ 进行离散化。网格点为 $x_i = i h$，其中 $i = 0, 1, \\dots, N+1$，网格步长为 $h = L/(N+1)$。在这些节点上的离散解记为 $w_i \\approx w(x_i)$。\n\n在内部节点 $x_i$ 处的二阶导数 $w''(x_i)$ 使用二阶中心有限差分公式进行近似：\n$$\n\\frac{d^2 w}{dx^2}\\bigg|_{x=x_i} \\approx \\frac{w_{i-1} - 2w_i + w_{i+1}}{h^2}\n$$\n将此式代入 $w$ 的齐次偏微分方程，得到每个内部节点 $i \\in \\{1, 2, \\dots, N\\}$ 的离散方程：\n$$\n-\\,k\\,\\frac{w_{i-1} - 2w_i + w_{i+1}}{h^2} + c\\,w_i = 0\n$$\n重新整理该方程，将包含未知值 $w_1, \\dots, w_N$ 的项组合到左侧，得到：\n$$\n-\\frac{k}{h^2}w_{i-1} + \\left(\\frac{2k}{h^2} + c\\right)w_i - \\frac{k}{h^2}w_{i+1} = 0\n$$\n\n**3. 线性系统的建立与求解**\n这 $N$ 个离散方程构成一个线性方程组，可以写成矩阵形式 $A\\mathbf{w} = \\mathbf{b}$，其中 $\\mathbf{w} = [w_1, w_2, \\dots, w_N]^T$ 是内部节点上未知解值的向量。\n\n边界值 $w_0 = \\delta g_0$ 和 $w_{N+1} = \\delta g_L$ 是已知量。它们被整合到第一个（$i=1$）和最后一个（$i=N$）内部节点的方程中：\n\n对于 $i=1$：\n$$\n-\\frac{k}{h^2}w_0 + \\left(\\frac{2k}{h^2} + c\\right)w_1 - \\frac{k}{h^2}w_2 = 0 \\implies \\left(\\frac{2k}{h^2} + c\\right)w_1 - \\frac{k}{h^2}w_2 = \\frac{k}{h^2}w_0 = \\frac{k}{h^2}\\delta g_0\n$$\n\n对于 $i=N$：\n$$\n-\\frac{k}{h^2}w_{N-1} + \\left(\\frac{2k}{h^2} + c\\right)w_N - \\frac{k}{h^2}w_{N+1} = 0 \\implies -\\frac{k}{h^2}w_{N-1} + \\left(\\frac{2k}{h^2} + c\\right)w_N = \\frac{k}{h^2}w_{N+1} = \\frac{k}{h^2}\\delta g_L\n$$\n由此得到的 $N \\times N$ 矩阵 $A$ 是一个具有以下结构的对称三对角矩阵：\n-   主对角线元素：$A_{ii} = \\frac{2k}{h^2} + c$\n-   次对角线和超对角线元素：$A_{i,i-1} = A_{i,i+1} = -\\frac{k}{h^2}$\n\n右侧向量 $\\mathbf{b}$ 的大小为 $N \\times 1$：\n$$\n\\mathbf{b} = \\begin{bmatrix} (k/h^2)\\delta g_0 \\\\ 0 \\\\ \\vdots \\\\ 0 \\\\ (k/h^2)\\delta g_L \\end{bmatrix}\n$$\n这个线性系统 $A\\mathbf{w}=\\mathbf{b}$ 使用标准的线性代数求解器求解向量 $\\mathbf{w}$。对于给定的参数（$k>0, c \\ge 0$），矩阵 $A$ 是严格对角占优的，这保证了唯一解的存在。\n\n**4. 灵敏度比率的计算**\n灵敏度比率 $\\alpha$ 定义为输出差值与输入扰动的范数之比：\n$$\n\\alpha = \\frac{\\|w\\|_{L^2(0,L)}}{\\|(\\delta g_0,\\delta g_L)\\|}\n$$\n分子使用离散 $L^2$ 范数进行近似，这涉及对计算出的内部解值 $w_i$ 进行求和：\n$$\n\\|w\\|_{L^2(0,L)} \\approx \\left( h \\sum_{i=1}^{N} w_i^2 \\right)^{1/2}\n$$\n分母是边界扰动向量的标准欧几里得范数：\n$$\n\\|(\\delta g_0,\\delta g_L)\\| = \\sqrt{(\\delta g_0)^2 + (\\delta g_L)^2}\n$$\n通过已求解的向量 $\\mathbf{w}$ 和给定的扰动 $(\\delta g_0, \\delta g_L)$ 计算这两个范数，就可以为每个测试用例计算出灵敏度比率 $\\alpha$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the sensitivity ratio for a series of test cases based on a\n    finite difference discretization of a diffusion-reaction PDE.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (L, k, c, N, delta_g0, delta_gL)\n        (1.0, 1.0, 0.0, 200, 0.1, -0.05),\n        (5.0, 1.0, 0.0, 200, 0.1, -0.05),\n        (1.0, 1.0, 1.0, 200, 0.1, -0.05),\n        (0.25, 1.0, 10.0, 100, 0.0, 0.2),\n        (2.0, 0.5, 0.0, 300, 0.05, 0.05),\n    ]\n\n    results = []\n    for L, k, c, N, delta_g0, delta_gL in test_cases:\n        # Main logic to calculate the result for one case goes here.\n        alpha = compute_sensitivity(L, k, c, N, delta_g0, delta_gL)\n        results.append(alpha)\n\n    # Final print statement in the exact required format.\n    # Each value is rounded to 6 decimal places.\n    print(f\"[{','.join(f'{r:.6f}' for r in results)}]\")\n\ndef compute_sensitivity(L: float, k: float, c: float, N: int, delta_g0: float, delta_gL: float) -> float:\n    \"\"\"\n    Solves for the difference field w and computes the sensitivity ratio alpha.\n\n    Args:\n        L: Domain length.\n        k: Diffusion coefficient.\n        c: Reaction coefficient.\n        N: Number of interior nodes.\n        delta_g0: Perturbation at the x=0 boundary.\n        delta_gL: Perturbation at the x=L boundary.\n\n    Returns:\n        The computed sensitivity ratio alpha.\n    \"\"\"\n    # 1. Setup grid and constants\n    h = L / (N + 1)\n    k_over_h2 = k / (h**2)\n\n    # 2. Assemble the linear system A*w = b\n    # A is an N x N tridiagonal matrix\n    main_diag = (2 * k_over_h2 + c) * np.ones(N)\n    off_diag = -k_over_h2 * np.ones(N - 1)\n    \n    A = np.diag(main_diag) + np.diag(off_diag, k=1) + np.diag(off_diag, k=-1)\n    \n    # b is the N x 1 right-hand side vector\n    b = np.zeros(N)\n    b[0] = k_over_h2 * delta_g0\n    b[N - 1] = k_over_h2 * delta_gL\n\n    # 3. Solve the linear system for the interior solution w\n    w = np.linalg.solve(A, b)\n\n    # 4. Compute norms and the sensitivity ratio alpha\n    # Numerator: Discrete L2 norm of the solution difference w\n    # ||w||_L2 ≈ sqrt(h * sum(w_i^2))\n    norm_w_l2 = np.sqrt(h * np.sum(np.square(w)))\n\n    # Denominator: Euclidean norm of the boundary perturbations\n    norm_delta_g = np.sqrt(delta_g0**2 + delta_gL**2)\n\n    # Handle the case of zero perturbation to avoid division by zero\n    if norm_delta_g == 0:\n        return 0.0\n\n    alpha = norm_w_l2 / norm_delta_g\n    \n    return alpha\n\nsolve()\n```"
        }
    ]
}