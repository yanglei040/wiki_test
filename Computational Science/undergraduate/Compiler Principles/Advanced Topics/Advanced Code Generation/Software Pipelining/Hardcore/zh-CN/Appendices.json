{
    "hands_on_practices": [
        {
            "introduction": "软件流水线性能的第一个基本限制来自处理器有限的硬件资源。本练习将通过一个具体案例，教你如何计算资源约束下的最小启动间隔（ResMII），这是确定循环性能瓶颈的关键一步。通过这个计算，你将学会识别哪些功能单元限制了循环的执行速度。",
            "id": "3670535",
            "problem": "一个编译器使用软件流水线技术为一个超长指令字（VLIW）处理器调度一个循环。该处理器每种类型都有多个相同的功能单元。假设循环和机器满足以下条件：\n\n- 机器拥有 $U_{\\text{ALU}} = 4$ 个算术逻辑单元（ALU）、$U_{\\text{MUL}} = 2$ 个乘法单元、$U_{\\text{MEM}} = 1$ 个内存单元和 $U_{\\text{SFU}} = 1$ 个特殊功能单元（SFU）。\n- 每种类型的操作在发出时都精确地占用一个相应的单元一个周期。忽略所有延迟、循环携带相关、旁路限制以及除单元数量外的结构性冒险。假设寄存器数量无限，并且每次迭代都必须执行所述类型的规定数量的操作。\n- 每次迭代的循环体包含 $11$ 个ALU操作、$3$ 个乘法操作、$4$ 个内存操作（加载或存储）和 $1$ 个SFU操作。\n\n仅考虑资源因素，确定资源受限的最小启动间隔（ResMII），其定义为由有限的资源数量所施加的启动间隔的最紧下界。同时，指出在此下界下哪些单元类型是资源瓶颈。为了评分，请仅提供 $\\text{ResMII}$ 的数值作为最终答案；在您的计算过程中请包含关于瓶颈的推理。提供一个精确的整数值；无需四舍五入。",
            "solution": "用户希望确定在一个VLIW处理器上，一个经过软件流水线优化的循环的资源受限最小启动间隔（$\\text{ResMII}$）。\n\n这个问题是编译器理论和计算机体系结构原理的一个经典应用，特别涉及到指令级并行和资源调度。该问题具有科学依据，定义明确，客观，并包含得出唯一解所需的所有信息。忽略延迟和相关性的简化假设是一种标准的教学工具，用以分离出资源约束的影响。因此，该问题被认为是 **有效的**。\n\n启动间隔，记为 $II$，是在软件流水线循环中，连续两次迭代开始之间相隔的时钟周期数。在稳态下，每 $II$ 个周期启动一个完整的循环迭代。\n\n对于任何给定的功能单元类型 $R$，设 $U_R$ 是可用单元的数量，$N_R$ 是单次循环迭代所需的该类型操作的数量。在启动间隔为 $II$ 的稳态执行中，$II$ 个周期内可用于类型 $R$ 的总操作槽位数量为 $U_R \\times II$。为了维持循环，这个容量必须足以容纳每次迭代所需的 $N_R$ 个操作。这导致了每种资源类型 $R$ 的基本资源约束不等式：\n$$N_R \\le U_R \\times II$$\n这个不等式可以重新整理，以找到由资源类型 $R$ 施加的启动间隔的下界：\n$$II \\ge \\frac{N_R}{U_R}$$\n由于启动间隔必须是整数个时钟周期，所以资源类型 $R$ 的最小启动间隔（记为 $MII_R$）是满足此条件的最小整数。这可以通过对该比率取上限（ceiling）得到：\n$$MII_R = \\left\\lceil \\frac{N_R}{U_R} \\right\\rceil$$\n总的资源受限最小启动间隔 $\\text{ResMII}$ 是这些单独下界中最严格的一个。也就是说，它是所有资源类型的 $MII_R$ 值中的最大值，因为循环的执行速度只能与最受限的资源允许的速度一样快。\n$$\\text{ResMII} = \\max_{R} (MII_R)$$\n题目提供了以下数据：\n- 每次迭代所需的ALU操作数：$N_{\\text{ALU}} = 11$\n- 可用ALU数量：$U_{\\text{ALU}} = 4$\n- 每次迭代所需的乘法操作数：$N_{\\text{MUL}} = 3$\n- 可用乘法单元数量：$U_{\\text{MUL}} = 2$\n- 每次迭代所需的内存操作数：$N_{\\text{MEM}} = 4$\n- 可用内存单元数量：$U_{\\text{MEM}} = 1$\n- 每次迭代所需的SFU操作数：$N_{\\text{SFU}} = 1$\n- 可用SFU数量：$U_{\\text{SFU}} = 1$\n\n我们现在为每种资源类型计算最小启动间隔：\n对于算术逻辑单元（ALU）：\n$$MII_{\\text{ALU}} = \\left\\lceil \\frac{N_{\\text{ALU}}}{U_{\\text{ALU}}} \\right\\rceil = \\left\\lceil \\frac{11}{4} \\right\\rceil = \\lceil 2.75 \\rceil = 3$$\n对于乘法单元（MUL）：\n$$MII_{\\text{MUL}} = \\left\\lceil \\frac{N_{\\text{MUL}}}{U_{\\text{MUL}}} \\right\\rceil = \\left\\lceil \\frac{3}{2} \\right\\rceil = \\lceil 1.5 \\rceil = 2$$\n对于内存单元（MEM）：\n$$MII_{\\text{MEM}} = \\left\\lceil \\frac{N_{\\text{MEM}}}{U_{\\text{MEM}}} \\right\\rceil = \\left\\lceil \\frac{4}{1} \\right\\rceil = \\lceil 4 \\rceil = 4$$\n对于特殊功能单元（SFU）：\n$$MII_{\\text{SFU}} = \\left\\lceil \\frac{N_{\\text{SFU}}}{U_{\\text{SFU}}} \\right\\rceil = \\left\\lceil \\frac{1}{1} \\right\\rceil = \\lceil 1 \\rceil = 1$$\n总的 $\\text{ResMII}$ 是这些单独值的最大值：\n$$\\text{ResMII} = \\max(\\{MII_{\\text{ALU}}, MII_{\\text{MUL}}, MII_{\\text{MEM}}, MII_{\\text{SFU}}\\})$$\n$$\\text{ResMII} = \\max(\\{3, 2, 4, 1\\}) = 4$$\n决定 $\\text{ResMII}$ 值的资源类型即为瓶颈。在本例中，$MII_{\\text{MEM}} = 4$，是最大值。因此，内存单元是资源瓶颈，因为它对循环的执行速率施加了最严格的约束。所需的 $\\text{ResMII}$ 是 $4$ 个周期。",
            "answer": "$$\\boxed{4}$$"
        },
        {
            "introduction": "除了硬件资源，循环自身的数据依赖关系也构成了对流水线性能的另一个重要约束。此练习将聚焦于循环携带的依赖，并阐释它如何决定了另一种最小启动间隔，即递推约束最小启动间隔（RecMII）。理解这种依赖约束是正确调度和优化循环的关键。",
            "id": "3670523",
            "problem": "考虑一个简单的循环，其循环体包含一个单一操作 $x$，该操作产生的值用于计算跨迭代的下一个 $x$ 实例。具体来说，假设一个形式为 $x(i) = f(x(i-2))$ 的循环，其中计算 $f$ 由单个延迟为 $l = 5$ 个周期的操作 $x$ 实现，并且循环携带相关距离为 $d = 2$。一个编译器尝试使用软件流水线技术为此循环构建一个模调度，在一个启动间隔 (Initiation Interval, II) 的核心(kernel)内为操作 $x$ 分配一个固定的周期偏移量 $t(x)$，其中启动间隔 (II) 是两个连续循环迭代开始之间的周期数。该相关性是从 $x(i-2)$ 到 $x(i)$ 的自相关，距离为 $d = 2$，延迟为 $l = 5$。\n\n仅使用相关距离 $d$、延迟 $l$ 和启动间隔 (II) 的基本定义，以及模调度为核心(kernel)内的每个操作分配一个与迭代索引无关的单一固定偏移量 $t(x)$ 这一事实，判断下列哪个陈述是正确的。\n\nA. 此循环的递归下界强制要求 $II \\ge \\lceil l/d \\rceil = \\lceil 5/2 \\rceil = 3$，因为对这个单一自相关环路上的时间差约束求和得出 $0 \\ge l - d \\cdot II$。\n\nB. 一个 $II = 2$ 的模调度仍然可以通过选择偏移量使得 $t(x,i) - t(x,i-2) = 1$ 来满足相关性，从而使 $x(i-2)$ 和 $x(i)$ 之间的经过时间等于 $5$ 个周期。\n\nC. 一个有效的最小调度模式是 $II = 3$ 且 $t(x) = 0$，因此 $x$ 的连续实例在周期 $\\{0, 3, 6, \\dots\\}$ 开始；从 $x(i-2)$ 到 $x(i)$ 的经过时间为 $2 \\cdot II = 6 \\ge l = 5$，满足了相关性。\n\nD. 当 $II = 3$ 时，一个交错模式 $t(x,i) = (i \\bmod 3)$ 是有效的并且可以减少寄存器压力，因为相关性不等式允许对于不同的迭代偏移量存在正的松弛量。\n\nE. 如果资源约束允许，任何 $II \\ge 3$ 都满足相关性，并且当 $II = 3$ 时，任何固定的偏移量选择 $t(x) \\in \\{0, 1, 2\\}$ 都会产生一个正确的调度，因为自相关性得到了满足。\n\nF. 最小启动间隔与 $d$ 无关；只有延迟 $l$ 有影响，所以最小 $II$ 是 $\\lceil 5/1 \\rceil = 5$。",
            "solution": "对问题陈述的有效性进行分析。\n\n**步骤1：提取已知条件**\n- 循环体由单个操作组成，记为 $x$。\n- 循环计算 $x(i) = f(x(i-2))$。\n- 操作 $x$ 的延迟为 $l = 5$ 个周期。\n- 循环携带相关是从 $x(i-2)$ 到 $x(i)$ 的自相关。\n- 相关距离为 $d = 2$ 次迭代。\n- 调度方法是软件流水线，构建一个模调度。\n- 操作 $x$ 在一个核心(kernel)内被分配一个固定的周期偏移量 $t(x)$。\n- 启动间隔 $II$ 是两个连续循环迭代开始之间的周期数。\n- 偏移量 $t(x)$ 与迭代索引 $i$ 无关。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据：** 该问题是编译器理论中的一个标准练习，特别是关于软件流水线的模调度。延迟 ($l$)、相关距离 ($d$) 和启动间隔 ($II$) 的概念是该领域的基础。该问题在已确立的编译器优化原则框架内被正确地提出。\n- **适定性：** 该问题是适定的。它提供了所有必要的参数（$l=5$, $d=2$）来确定启动间隔 $II$ 的约束条件。问题是具体的，并且有一个基于理论的、唯一的、可验证的答案。\n- **客观性：** 语言技术性强、精确，且没有主观成分。\n- **不完整或矛盾的设置：** 设置是自洽且完整的。关系 $x(i) = f(x(i-2))$ 被一致地描述为距离 $d=2$ 的自相关。\n- **不适定或结构不良：** 在编译器设计的背景下，所用术语是标准的且无歧义的。问题清楚地定义了其术语（例如，“固定的周期偏移量 $t(x)$ …… 与迭代索引无关”）。\n\n**步骤3：结论与行动**\n问题陈述是有效的。将推导解决方案并评估各个选项。\n\n**基本约束的推导**\n\n模调度的核心原则是满足所有数据相关性。设 $T(op, i)$ 是操作 `op` 在迭代 $i$ 中的绝对开始时间。在一个具有固定操作偏移量 $t(op)$ 和启动间隔 $II$ 的模调度中，该开始时间由下式给出：\n$$T(op, i) = t(op) + i \\cdot II$$\n其中，不失一般性地，我们可以将第一次迭代的核心(kernel)的开始时间设置为周期 0。\n\n该问题描述了操作 $x$ 的一个循环携带自相关。在迭代 $i-d$ 中由操作 $x$ 产生的值，被迭代 $i$ 中的操作 $x$ 消耗。\n- 生产者操作实例是来自迭代 $i-d$ 的 $x$。它在时间 $T(x, i-d) = t(x) + (i-d) \\cdot II$ 开始。\n- 该操作的结果在其延迟 $l$ 之后可用。因此，该值在时间 $T(x, i-d) + l$ 准备就绪。\n- 消费者操作实例是来自迭代 $i$ 的 $x$。它在时间 $T(x, i) = t(x) + i \\cdot II$ 开始。\n\n为了满足相关性，消费者必须在值准备好之后才能开始：\n$$T(x, i) \\ge T(x, i-d) + l$$\n代入开始时间的表达式：\n$$t(x) + i \\cdot II \\ge (t(x) + (i-d) \\cdot II) + l$$\n项 $t(x)$ 和 $i \\cdot II$ 出现在两侧，可以简化：\n$$i \\cdot II \\ge i \\cdot II - d \\cdot II + l$$\n这可以简化为模调度中自相关的基本递归约束：\n$$d \\cdot II \\ge l$$\n文献中常见的另一种等效表述是，对于从操作 $u$ 到 $v$，距离为 $d$，延迟为 $l$ 的相关性，其偏移量必须满足 $t(v) - t(u) \\ge l - d \\cdot II$。对于自相关，$u=v=x$，所以 $t(x) - t(x) = 0$，得出 $0 \\ge l - d \\cdot II$，这与 $d \\cdot II \\ge l$ 相同。\n\n使用给定值 $l=5$ 和 $d=2$：\n$$2 \\cdot II \\ge 5$$\n$$II \\ge \\frac{5}{2} = 2.5$$\n由于启动间隔 $II$ 必须是整数个周期，因此 $II$ 的最小可能值为：\n$$II_{min} = \\lceil 2.5 \\rceil = 3$$\n这个下界被称为递归约束的最小启动间隔 ($RecMII$)。总体的最小启动间隔 ($MII$) 是 $RecMII$ 和资源约束的最小启动间隔 ($ResMII$) 中的最大值。由于循环体只有一个操作，资源约束是最小的（如果至少有一个用于 $x$ 的功能单元，则 $ResMII=1$），因此递归是限制因素。因此，最小 $II$ 为 $3$。\n\n**逐项分析**\n\n**A. 此循环的递归下界强制要求 $II \\ge \\lceil l/d \\rceil = \\lceil 5/2 \\rceil = 3$，因为对这个单一自相关环路上的时间差约束求和得出 $0 \\ge l - d \\cdot II$。**\n该陈述以 $0 \\ge l - d \\cdot II$ 的形式给出了基本不等式，这与上面推导出的 $d \\cdot II \\ge l$ 是等价的。它正确地代入了 $l=5$ 和 $d=2$ 的值得到 $II \\ge 5/2$，然后正确地取上取整以找到最小整数 $II$，即 $3$。其推理和结果完全正确。\n**结论：正确**\n\n**B. 一个 $II = 2$ 的模调度仍然可以通过选择偏移量使得 $t(x,i) - t(x,i-2) = 1$ 来满足相关性，从而使 $x(i-2)$ 和 $x(i)$ 之间的经过时间等于 $5$ 个周期。**\n该陈述不正确，原因有二。首先，根据推导，任何有效的调度都必须满足 $II \\ge 3$。$II$ 为 $2$ 违反了递归约束 ($2 \\cdot 2 = 4 \\not\\ge 5$)。其次，问题明确定义了模调度具有“与迭代索引无关的单一固定偏移量 $t(x)$”。该选项提议使用一个依赖于迭代的偏移量，记作 $t(x,i)$，这与所使用的调度模型的定义相矛盾。\n**结论：不正确**\n\n**C. 一个有效的最小调度模式是 $II = 3$ 且 $t(x) = 0$，因此 $x$ 的连续实例在周期 $\\{0, 3, 6, \\dots\\}$ 开始；从 $x(i-2)$ 到 $x(i)$ 的经过时间为 $2 \\cdot II = 6 \\ge l = 5$，满足了相关性。**\n该陈述提出了一个具体的、有效的调度。最小 $II$ 确实是 $3$。固定偏移量 $t(x)=0$ 是一个有效的选择。当 $t(x)=0$ 且 $II=3$ 时，实例 $i$ 的开始时间为 $T(x,i) = 0 + i \\cdot 3 = 3i$，从而得到开始时间序列 $\\{0, 3, 6, \\dots\\}$。在迭代 $i-2$ 和迭代 $i$ 中，操作 $x$ 开始之间经过的时间是 $T(x,i) - T(x,i-2) = 3i - 3(i-2) = 6$。或者说，这个经过的时间总是 $d \\cdot II = 2 \\cdot 3 = 6$ 个周期。由于这个经过的时间（$6$ 个周期）大于或等于延迟（$l=5$ 个周期），所以相关性得到满足。该陈述是一个有效最小调度的正确且具体的例证。\n**结论：正确**\n\n**D. 当 $II = 3$ 时，一个交错模式 $t(x,i) = (i \\bmod 3)$ 是有效的并且可以减少寄存器压力，因为相关性不等式允许对于不同的迭代偏移量存在正的松弛量。**\n该陈述与选项 B 类似，提出了一个偏移量依赖于迭代索引 $i$ 的调度方案。这并不是问题中定义的标准模调度（“一个单一的固定偏移量 $t(x)$”）。尽管这类“交错”或“摆动”模调度作为更高级的技术确实存在（并且可能确实会影响寄存器压力），但该选项在问题指定的约束条件下错误地将其标记为一种有效的模式。\n**结论：不正确**\n\n**E. 如果资源约束允许，任何 $II \\ge 3$ 都满足相关性，并且当 $II = 3$ 时，任何固定的偏移量选择 $t(x) \\in \\{0, 1, 2\\}$ 都会产生一个正确的调度，因为自相关性得到了满足。**\n该陈述由两部分组成。第一部分，“任何 $II \\ge 3$ 都满足相关性”。相关性不等式为 $2 \\cdot II \\ge 5$。对于任何整数 $II \\ge 3$，该不等式都成立（例如，如果 $II=3$, $6 \\ge 5$；如果 $II=4$, $8 \\ge 5$，等等）。这部分是正确的。第二部分，“当 $II = 3$ 时，任何固定的偏移量选择 $t(x) \\in \\{0, 1, 2\\}$ 都会产生一个正确的调度”。如推导所示，对于自相关，固定偏移量 $t(x)$ 在不等式中被消去（$t(x) - t(x) \\ge l - d \\cdot II$）。这意味着 $t(x)$ 的选择不影响递归约束是否被满足。因此，任何固定偏移量的选择对于满足此特定相关性都是有效的。集合 $\\{0, 1, 2\\}$ 代表了模 $II=3$ 的所有可能的偏移量。这部分也是正确的。\n**结论：正确**\n\n**F. 最小启动间隔与 $d$ 无关；只有延迟 $l$ 有影响，所以最小 $II$ 是 $\\lceil 5/1 \\rceil = 5$。**\n该陈述根本上是错误的。推导 $d \\cdot II \\ge l$ 清楚地表明，最小 $II$ 同时取决于延迟 $l$ 和相关距离 $d$。该陈述声称 $II$ “与 $d$ 无关”是不正确的。然后，它通过错误地假设 $d=1$ 来计算最小 $II$，这与给定的信息 $d=2$ 相矛盾。\n**结论：不正确**",
            "answer": "$$\\boxed{ACE}$$"
        },
        {
            "introduction": "尽管软件流水线可以显著提升性能，但它并非总是最优选择，尤其对于循环次数很少的循环。本练习将引导你分析软件流水线的开销，包括流水线建立（prologue）和排空（epilogue）阶段的成本，并计算出流水线优化开始产生效益的“盈亏平衡”迭代次数。这有助于你理解何时应用此项技术是真正有效的。",
            "id": "3670545",
            "problem": "编译器应用软件流水线技术来重叠连续循环迭代中的操作。考虑一个简化的机器模型，该模型具有单发射、顺序执行和固定的指令延迟。循环体包含两个独立的加载操作、一个乘法操作和一个更新循环携带累加器的加法操作。推理的基本依据是模调度（modulo scheduling）中启动间隔（II）的定义，以及流水线化循环的总执行时间是序章（prologue）开销、与启动间隔成正比的稳态（steady-state）开销以及尾声（epilogue）开销之和这一事实。在没有流水线的情况下，假设每次迭代的非重叠调度需要固定的周期数，等于关键路径长度加上循环控制开销。\n\n您将分析两个循环，并通过计算收支平衡迭代次数 $N$ 来判断对于非常短的循环，软件流水线何时会适得其反。收支平衡迭代次数是指流水线版本的执行时间首次等于或优于非流水线版本时的迭代次数。\n\n定义和假设：\n- 启动间隔 $II$ 是在模调度中，连续迭代开始之间的稳态周期数。\n- 序章开销 $P$（以周期为单位）是在达到稳态之前填充流水线所需的时间。\n- 尾声开销 $E$（以周期为单位）是在最后一次稳态迭代后排空流水线所需的时间。\n- 由于寄存器压力导致的寄存器溢出（register spills），流水线核心中可能会产生每次迭代的额外开销 $r$（以周期为单位）；如果存在，它会增加每次迭代的稳态周期数。\n- 非流水线化的每次迭代成本 $C_{u}$（以周期为单位）是当迭代不重叠时所需的周期数。\n\n循环 A：\n- 指令延迟：加载 $L_{\\mathrm{ld}}=3$，乘法 $L_{\\mathrm{mul}}=4$，加法 $L_{\\mathrm{add}}=2$。\n- 非流水线化的每次迭代成本 $C_{u} = L_{\\mathrm{ld}} + L_{\\mathrm{mul}} + L_{\\mathrm{add}} + 1$（+1 是循环控制开销）。\n- 由于累加器上存在循环携带依赖，递归约束（recurrence constraint）设定 $II=2$。\n- 序章和尾声开销：$P=8$, $E=4$。\n- 核心中无溢出开销：$r=0$。\n\n循环 B：\n- 指令延迟：加载 $L_{\\mathrm{ld}}=4$，乘法 $L_{\\mathrm{mul}}=5$，加法 $L_{\\mathrm{add}}=3$。\n- 非流水线化的每次迭代成本 $C_{u} = L_{\\mathrm{ld}} + L_{\\mathrm{mul}} + L_{\\mathrm{add}} + 0$（假设在一个计数循环中，由于直通执行（fall-through），循环控制被提前，净开销为零）。\n- 递归约束得出 $II=3$。\n- 序章和尾声开销：$P=12$, $E=12$。\n- 每次稳态迭代的溢出开销：$r=1$。\n\n任务：\n1. 从这些定义出发，推导收支平衡迭代次数 $N$ 的通用表达式，在该迭代次数下，流水线循环的总周期数等于非流水线循环的总周期数，并说明在何种条件下，软件流水线对任何 $N$ 都无益。\n2. 使用为循环 A 和循环 B 给定的参数，计算每个循环的最小整数收支平衡迭代次数，分别表示为 $N_{\\mathrm{A}}$ 和 $N_{\\mathrm{B}}$。将您的最终答案以包含 $N_{\\mathrm{A}}$ 和 $N_{\\mathrm{B}}$（按此顺序）的行矩阵形式报告。\n\n无需四舍五入。将最终答案表示为不带单位的整数。",
            "solution": "核心原理是，在模调度（软件流水线化）的循环中，总周期数由三部分组成：填充流水线的序章 $P$、稳态核心（其每次迭代的成本是启动间隔 $II$ 加上可能的每次迭代额外开销 $r$）以及排空流水线的尾声 $E$。因此，对于 $N$ 次迭代，\n$$\nT_{\\mathrm{sp}}(N) \\;=\\; P \\;+\\; (II + r)\\,N \\;+\\; E.\n$$\n相比之下，当迭代不重叠时（非流水线化），总周期数随每次迭代成本 $C_{u}$ 线性增长：\n$$\nT_{u}(N) \\;=\\; C_{u}\\,N.\n$$\n收支平衡迭代次数 $N^{\\star}$ 由等式 $T_{\\mathrm{sp}}(N^{\\star}) = T_{u}(N^{\\star})$ 定义，可得\n$$\nP + (II + r)\\,N^{\\star} + E \\;=\\; C_{u}\\,N^{\\star}.\n$$\n求解 $N^{\\star}$ 可得\n$$\nN^{\\star} \\;=\\; \\frac{P + E}{C_{u} - (II + r)}.\n$$\n由于 $N$ 必须是整数迭代次数才有意义，因此使流水线循环不慢于非流水线循环的最小整数 $N$ 是\n$$\nN^{\\star}_{\\min} \\;=\\; \\left\\lceil \\frac{P + E}{C_{u} - (II + r)} \\right\\rceil.\n$$\n如果分母非正，即 $C_{u} \\leq II + r$，那么流水线化稳态的每次迭代成本不低于非流水线化成本；在这种情况下，不存在有限的 $N$ 能使软件流水线有益，并且对于所有循环长度它都是适得其反的。\n\n我们现在为每个循环代入参数。\n\n循环 A：\n- 根据定义，\n$$\nC_{u} = L_{\\mathrm{ld}} + L_{\\mathrm{mul}} + L_{\\mathrm{add}} + 1 = 3 + 4 + 2 + 1 = 10.\n$$\n- 给定值为 $II = 2$, $P = 8$, $E = 4$ 和 $r = 0$。\n- 分母为 $C_{u} - (II + r) = 10 - (2 + 0) = 8$，是正数，因此存在有限的收支平衡点。\n- 收支平衡次数是\n$$\nN^{\\star}_{\\min,\\mathrm{A}} = \\left\\lceil \\frac{P + E}{C_{u} - (II + r)} \\right\\rceil = \\left\\lceil \\frac{8 + 4}{8} \\right\\rceil = \\left\\lceil \\frac{12}{8} \\right\\rceil = \\left\\lceil 1.5 \\right\\rceil = 2.\n$$\n\n循环 B：\n- 根据定义，\n$$\nC_{u} = L_{\\mathrm{ld}} + L_{\\mathrm{mul}} + L_{\\mathrm{add}} + 0 = 4 + 5 + 3 + 0 = 12.\n$$\n- 给定值为 $II = 3$, $P = 12$, $E = 12$ 和 $r = 1$。\n- 分母为 $C_{u} - (II + r) = 12 - (3 + 1) = 8$，是正数，因此存在有限的收支平衡点。\n- 收支平衡次数是\n$$\nN^{\\star}_{\\min,\\mathrm{B}} = \\left\\lceil \\frac{P + E}{C_{u} - (II + r)} \\right\\rceil = \\left\\lceil \\frac{12 + 12}{8} \\right\\rceil = \\left\\lceil \\frac{24}{8} \\right\\rceil = \\left\\lceil 3 \\right\\rceil = 3.\n$$\n\n关于对极短循环的适得其反效果的解释：对于循环 A，当 $N  2$ 时软件流水线是适得其反的；对于循环 B，当 $N  3$ 时也是如此，因为在如此小的迭代次数下，序章和尾声的开销占主导地位。此外，如果 $C_{u} \\leq II + r$ 成立，那么软件流水线对所有 $N$ 都将是适得其反的。\n\n因此，所求的收支平衡迭代次数为 $N_{\\mathrm{A}} = 2$ 和 $N_{\\mathrm{B}} = 3$。",
            "answer": "$$\\boxed{\\begin{pmatrix}2  3\\end{pmatrix}}$$"
        }
    ]
}