{
    "hands_on_practices": [
        {
            "introduction": "We begin by revisiting familiar territory: the ring axioms of integer arithmetic. This exercise  illustrates how a compiler can leverage fundamental algebraic identities to transform a complex-looking expression into a much simpler one. By applying properties like distributivity, you will see firsthand how optimization can drastically reduce the number of computational steps required at runtime.",
            "id": "3676900",
            "problem": "You are given the arithmetic assignment $p := (x - y) \\times (x + y) + y^{2}$, where $x$ and $y$ denote mathematical integers and all arithmetic is over the ring of integers with no overflow or wrap-around. Assume the usual translation of expressions to Three-Address Code (TAC), where each TAC instruction has at most one operator on the right-hand side and uses temporaries as needed, and where the operators are pure (no side effects). Assume that semantics-preserving optimizations are permitted prior to code generation, including but not limited to common subexpression elimination and algebraic simplifications justified solely by the ring axioms of integers (associativity, commutativity, and distributivity of $+$ and $\\times$; existence of additive inverses; and the multiplicative identity).\n\nTasks:\n- First, derive a straightforward TAC sequence that implements the given assignment without applying any algebraic simplification to the source expression.\n- Next, using only the allowed algebraic properties listed (and no properties that rely on machine-specific overflow or rounding behavior), simplify the source expression to an equivalent form that minimizes the algebraic complexity prior to code generation.\n\nProvide your final answer as the single, simplest closed-form algebraic expression for $p$ in terms of $x$ and $y$. Do not provide any code or intermediate steps in the final answer. No rounding is necessary, and no units are involved. The final answer must be a single expression.",
            "solution": "The problem requires a two-part analysis of the arithmetic assignment $p := (x - y) \\times (x + y) + y^{2}$. First, a direct translation into Three-Address Code (TAC) without algebraic simplifications is to be derived. Second, the expression is to be simplified using the ring axioms of integers to find its minimal equivalent form.\n\nThe first task is to derive a straightforward, unoptimized TAC sequence. This process involves breaking down the expression into elementary operations, each corresponding to a single TAC instruction. We introduce temporary variables, denoted by $t_i$, to store intermediate results. The translation proceeds according to the standard order of operations.\n\n1.  The subtraction within the first parenthesis is evaluated:\n    $t_1 := x - y$\n2.  The addition within the second parenthesis is evaluated:\n    $t_2 := x + y$\n3.  The product of the results of the parenthetical expressions is computed:\n    $t_3 := t_1 \\times t_2$\n4.  The exponentiation term $y^{2}$ is evaluated as a multiplication:\n    $t_4 := y \\times y$\n5.  The sum of the product and the squared term is calculated:\n    $t_5 := t_3 + t_4$\n6.  The final result is assigned to the variable $p$:\n    $p := t_5$\n\nThis sequence of instructions constitutes a valid, unoptimized TAC representation of the original assignment.\n\nThe second task is to simplify the source expression using the specified algebraic properties: the ring axioms for integers (associativity, commutativity, distributivity, existence of additive inverses, and multiplicative identity). We begin with the initial expression for $p$:\n$$p = (x - y) \\times (x + y) + y^{2}$$\n\nWe expand the product term $(x - y) \\times (x + y)$ by applying the distributive property of multiplication over addition, which states that $a \\times (b + c) = (a \\times b) + (a \\times c)$. Let us treat the term $(x - y)$ as a single entity and distribute it across the sum $(x + y)$:\n$$ (x - y) \\times (x + y) = (x - y) \\times x + (x - y) \\times y $$\n\nNext, we apply the distributive property again to each of the two resulting terms. For the first term, $(x - y) \\times x$, we may use the commutativity of multiplication to write it as $x \\times (x - y)$ and then distribute:\n$$ x \\times (x - y) = x \\times x + x \\times (-y) = x^{2} - (x \\times y) $$\n\nFor the second term, $(x - y) \\times y$, we distribute $y$:\n$$ (x - y) \\times y = x \\times y + (-y) \\times y = (x \\times y) - y^{2} $$\n\nSubstituting these expanded forms back into the expression for the product gives:\n$$ (x - y) \\times (x + y) = (x^{2} - (x \\times y)) + ((x \\times y) - y^{2}) $$\n\nNow, we substitute this result back into the original expression for $p$:\n$$ p = \\left( (x^{2} - (x \\times y)) + ((x \\times y) - y^{2}) \\right) + y^{2} $$\n\nBy the associativity of addition ($(a+b)+c = a+(b+c)$), we can remove the inner parentheses. Furthermore, the commutativity and associativity of addition allow us to reorder and regroup the terms:\n$$ p = x^{2} + (-(x \\times y) + (x \\times y)) + (-y^{2} + y^{2}) $$\n\nThe axiom of additive inverses states that for any element $a$, there is an element $-a$ such that $a + (-a) = 0$. Applying this axiom to the grouped terms:\n$$ -(x \\times y) + (x \\times y) = 0 $$\n$$ -y^{2} + y^{2} = 0 $$\n\nSubstituting these values of $0$ back into the expression for $p$:\n$$ p = x^{2} + 0 + 0 $$\n\nFinally, by the property of the additive identity ($a + 0 = a$):\n$$ p = x^{2} $$\n\nThis derivation shows that the expression $p := (x - y) \\times (x + y) + y^{2}$ is algebraically equivalent to $p := x^{2}$ under the ring axioms of integers. This is the simplest closed-form expression.",
            "answer": "$$\\boxed{x^{2}}$$"
        },
        {
            "introduction": "Algebraic simplification becomes more nuanced when dealing with functions that have restricted domains, such as powers with real exponents. This problem  challenges you to simplify an expression involving various powers by first determining the maximal valid domain for the input variable $x$. It's a crucial lesson in how compilers must perform careful domain analysis to ensure that simplifications like $x^{a} x^{b} = x^{a+b}$ are applied safely and correctly.",
            "id": "3621037",
            "problem": "A compiler’s algebraic simplifier operates on expressions in an Intermediate Representation (IR) that includes a real-valued power operator. The simplifier must preserve observational equivalence on the maximal domain of definition of the original expression: two expressions are considered equivalent if they yield the same real value for every input where the original expression is defined; behavior outside this domain is not required to match. The IR uses the following mathematical semantics as its fundamental base:\n- For an integer exponent $n \\in \\mathbb{Z}$ and base $x \\in \\mathbb{R}$ with $x \\neq 0$, the value $x^{n}$ is defined by repeated multiplication for $n \\geq 0$ and by the relation $x^{-n} = \\frac{1}{x^{n}}$ for $n  0$.\n- For a real exponent $y \\in \\mathbb{R}$ and base $x  0$, the value $x^{y}$ is defined by $x^{y} = \\exp\\!\\big(y \\ln x\\big)$, where $\\exp$ is the exponential function and $\\ln$ is the natural logarithm. No value is defined for $x \\leq 0$ in this case.\n\nConsider the IR expression\n$$\nE(x) \\;=\\; x^{7} \\cdot x^{\\frac{3}{2}} \\cdot \\big(x^{\\sqrt{2}}\\big)^{4} \\,\\Big/\\, x^{-3}.\n$$\nUsing only the fundamental base above and the requirement of equivalence on the original expression’s maximal domain of definition, derive a single-power form $x^{K}$ that the simplifier may legally produce for $E(x)$. Provide your final simplified expression in closed form. Do not assume any additional domain constraints beyond those forced by the given semantics. Your final answer must be a single analytic expression; no rounding is required.",
            "solution": "The core of the task is to find a simplified expression $x^K$ that is equivalent to $E(x)$ on the maximal domain where $E(x)$ is defined. The first step is to determine this domain.\n\n**1. Determine the Maximal Domain of Definition for $E(x)$**\n\nThe expression is $E(x) = \\frac{x^{7} \\cdot x^{\\frac{3}{2}} \\cdot (x^{\\sqrt{2}})^{4}}{x^{-3}}$. We must find the set of all $x \\in \\mathbb{R}$ for which every sub-expression is defined.\n\n-   **Term $x^{7}$**: The exponent is the integer $7$. According to the provided IR semantics, the base $x$ must be non-zero. Thus, this term requires $x \\neq 0$.\n-   **Term $x^{\\frac{3}{2}}$**: The exponent $\\frac{3}{2}$ is a real number but not an integer. According to the IR semantics, the base $x$ must be strictly positive. Thus, this term requires $x > 0$.\n-   **Term $(x^{\\sqrt{2}})^{4}$**: This is a composite term.\n    -   First, consider the inner expression $x^{\\sqrt{2}}$. The exponent $\\sqrt{2}$ is a real number but not an integer. This requires the base $x$ to be strictly positive, i.e., $x > 0$.\n    -   Let $u = x^{\\sqrt{2}}$. For $x > 0$, $u = \\exp(\\sqrt{2} \\ln x)$ is always a positive real number.\n    -   The outer expression is $u^{4}$. The exponent is the integer $4$. This requires the base $u$ to be non-zero. Since we established that $u$ is always positive, this condition is satisfied.\n    -   Therefore, the entire term $(x^{\\sqrt{2}})^{4}$ is defined for $x > 0$.\n-   **Term $x^{-3}$ (in the denominator)**: The exponent is the integer $-3$. This requires the base $x$ to be non-zero, i.e., $x \\neq 0$. Furthermore, as this term is in the denominator, its value cannot be zero. For $x \\neq 0$, $x^{-3} = \\frac{1}{x^{3}}$ is never zero.\n\nTo find the maximal domain for $E(x)$, we must find the intersection of the domains of all its constituent parts. The requirements are:\n-   From $x^7$: $x \\in \\mathbb{R} \\setminus \\{0\\}$\n-   From $x^{\\frac{3}{2}}$: $x \\in (0, \\infty)$\n-   From $(x^{\\sqrt{2}})^4$: $x \\in (0, \\infty)$\n-   From $x^{-3}$: $x \\in \\mathbb{R} \\setminus \\{0\\}$\n\nThe intersection of these sets is $(0, \\infty)$. Therefore, the maximal domain of definition for $E(x)$ is $x > 0$.\n\n**2. Simplify the Expression $E(x)$ on its Domain**\n\nThe requirement is for the simplified expression to be equivalent to $E(x)$ for all $x > 0$. On this domain, the general rule $x^y = \\exp(y \\ln x)$ holds for all real exponents. This definition validates the standard laws of exponents:\n-   $x^a \\cdot x^b = x^{a+b}$\n-   $x^a / x^b = x^{a-b}$\n-   $(x^a)^b = x^{ab}$\n\nWe can now apply these laws to simplify $E(x)$ for $x > 0$.\n\n$$\nE(x) \\;=\\; x^{7} \\cdot x^{\\frac{3}{2}} \\cdot \\big(x^{\\sqrt{2}}\\big)^{4} \\,\\Big/\\, x^{-3}\n$$\n\nFirst, simplify the term $(x^{\\sqrt{2}})^{4}$ using the rule $(x^a)^b = x^{ab}$:\n$$\n\\big(x^{\\sqrt{2}}\\big)^{4} = x^{4\\sqrt{2}}\n$$\n\nSubstitute this back into the expression for $E(x)$:\n$$\nE(x) \\;=\\; \\frac{x^{7} \\cdot x^{\\frac{3}{2}} \\cdot x^{4\\sqrt{2}}}{x^{-3}}\n$$\n\nNext, simplify the numerator using the rule $x^a \\cdot x^b = x^{a+b}$:\n$$\nx^{7} \\cdot x^{\\frac{3}{2}} \\cdot x^{4\\sqrt{2}} = x^{7 + \\frac{3}{2} + 4\\sqrt{2}}\n$$\n\nNow, simplify the entire expression using the rule $x^a / x^b = x^{a-b}$:\n$$\nE(x) = x^{\\left(7 + \\frac{3}{2} + 4\\sqrt{2}\\right) - (-3)}\n$$\n\nThe final exponent $K$ is the value of the expression in the superscript. We calculate this value:\n$$\nK = 7 + \\frac{3}{2} + 4\\sqrt{2} - (-3)\n$$\n$$\nK = 7 + \\frac{3}{2} + 4\\sqrt{2} + 3\n$$\n$$\nK = 10 + \\frac{3}{2} + 4\\sqrt{2}\n$$\n\nTo combine the rational terms, we use a common denominator:\n$$\nK = \\frac{20}{2} + \\frac{3}{2} + 4\\sqrt{2}\n$$\n$$\nK = \\frac{23}{2} + 4\\sqrt{2}\n$$\n\nThus, for all $x > 0$, the expression $E(x)$ simplifies to $x^{\\frac{23}{2} + 4\\sqrt{2}}$. This expression is of the form $x^K$, where $K = \\frac{23}{2} + 4\\sqrt{2}$. Since the simplified form is identical to the original form on the maximal domain of definition $(0, \\infty)$, it is a legal simplification according to the problem's criteria.\n\nThe final simplified expression is $x^{\\frac{23}{2} + 4\\sqrt{2}}$.",
            "answer": "$$\n\\boxed{x^{\\frac{23}{2} + 4\\sqrt{2}}}\n$$"
        },
        {
            "introduction": "Not all arithmetic is created equal; many systems, like those for digital signal processing, use non-standard forms such as saturating arithmetic. This exercise  explores how fundamental identities like cancellation ($x + y - y = x$) can fail in such systems due to overflow handling. It underscores a vital principle for compiler designers: optimizations must be proven correct under the specific, sometimes counter-intuitive, semantics of the target hardware.",
            "id": "3620985",
            "problem": "A compiler’s Intermediate Representation (IR) for a numeric domain uses signed $8$-bit saturating arithmetic for addition and subtraction. In this setting, addition and subtraction are not the standard integer operations but are defined via a saturating clamp to the representable range. Formally, for any integers $x$ and $y$, define the clamp function $\\operatorname{sat}:\\mathbb{Z}\\to\\mathbb{Z}$ by\n$$\n\\operatorname{sat}(z) = \n\\begin{cases}\n-2^{7}  \\text{if } z  -2^{7},\\\\\nz  \\text{if } -2^{7} \\le z \\le 2^{7}-1,\\\\\n2^{7}-1  \\text{if } z  2^{7}-1,\n\\end{cases}\n$$\nso the representable range is $[-2^{7},2^{7}-1] = [-128,127]$. The IR’s addition and subtraction are then\n$$\nx + y := \\operatorname{sat}(x + y) \\quad \\text{and} \\quad x - y := \\operatorname{sat}(x - y),\n$$\nwhere the $+$ and $-$ on the right-hand sides are the ordinary mathematical operations in $\\mathbb{Z}$ and the left-hand sides denote the IR’s saturating operations.\n\nAn optimization pass considers algebraic simplification rules to reduce expression trees while preserving semantics. Two candidate rewrites are the identity with zero and cancellation:\n- Identity with zero: replace $x + 0$ by $x$.\n- Cancellation: replace $x + y - y$ by $x$.\n\nWhich of the following statements about the soundness of these rewrites under the above saturating semantics are correct?\n\nA. In signed $8$-bit saturating arithmetic, the rewrite $x + 0 \\to x$ is semantics-preserving for all $x$.\n\nB. In signed $8$-bit saturating arithmetic, the rewrite $x + y - y \\to x$ is semantics-preserving for all $x,y$.\n\nC. In signed $8$-bit saturating arithmetic, the rewrite $x + y - y \\to x$ is semantics-preserving provided the optimizer proves the ordinary mathematical sum $x + y$ lies in $[-128,127]$ (so the intermediate addition does not saturate).\n\nD. In signed $8$-bit saturating arithmetic, the rewrite $x + y - y \\to x$ is semantics-preserving provided the optimizer proves $x \\ge 0$ and $y \\ge 0$.\n\nE. In unsigned $8$-bit saturating arithmetic with representable range $[0,255]$, the rewrite $x + y - y \\to x$ is semantics-preserving for all $x,y$.",
            "solution": "Let the representable range be $R = [-128, 127]$. All variables $x, y$ are integers such that $x, y \\in R$. Let us denote the IR's saturating addition by $\\oplus$ and saturating subtraction by $\\ominus$. The problem statement uses the standard symbols $+$ and $-$ for these operations in the context of the rewrites. We will adhere to that, keeping in mind they represent the saturating operations:\n$x + y$ in the rewrite rule means $x \\oplus y = \\operatorname{sat}(x +_{\\mathbb{Z}} y)$.\n$x - y$ in the rewrite rule means $x \\ominus y = \\operatorname{sat}(x -_{\\mathbb{Z}} y)$.\nThe expression $x + y - y$ is interpreted as $(x \\oplus y) \\ominus y$.\n\n**Analysis of Option A**\n\nStatement: In signed $8$-bit saturating arithmetic, the rewrite $x + 0 \\to x$ is semantics-preserving for all $x$.\n\nTo check if this rewrite is semantics-preserving, we must verify if $x \\oplus 0 = x$ for all $x \\in R$.\nBy definition, $x \\oplus 0 = \\operatorname{sat}(x +_{\\mathbb{Z}} 0)$.\nThe ordinary integer addition $x +_{\\mathbb{Z}} 0$ is simply $x$.\nSo, we have $x \\oplus 0 = \\operatorname{sat}(x)$.\nThe variable $x$ represents a value stored in the IR, so it is already within the representable range $R = [-128, 127]$.\nAccording to the definition of the $\\operatorname{sat}$ function, if its argument $z$ is in the range $[-128, 127]$, then $\\operatorname{sat}(z)=z$.\nSince $x \\in [-128, 127]$, it follows that $\\operatorname{sat}(x) = x$.\nTherefore, $x \\oplus 0 = x$ for all $x \\in R$. The rewrite is semantics-preserving.\n\n**Verdict for A:** **Correct**.\n\n**Analysis of Option B**\n\nStatement: In signed $8$-bit saturating arithmetic, the rewrite $x + y - y \\to x$ is semantics-preserving for all $x,y$.\n\nTo check this, we must verify if $(x \\oplus y) \\ominus y = x$ for all $x, y \\in R$.\nLet's look for a counterexample where the intermediate calculation $x \\oplus y$ saturates.\nLet $x = 100$ and $y = 100$. Both values are in $R$.\nFirst, calculate $x \\oplus y$:\n$x \\oplus y = \\operatorname{sat}(100 +_{\\mathbb{Z}} 100) = \\operatorname{sat}(200)$.\nSince $200 > 127$, the result saturates to the maximum value: $\\operatorname{sat}(200) = 127$.\nSo, $x \\oplus y = 127$.\nNext, calculate $(x \\oplus y) \\ominus y$:\n$(x \\oplus y) \\ominus y = 127 \\ominus 100 = \\operatorname{sat}(127 -_{\\mathbb{Z}} 100) = \\operatorname{sat}(27)$.\nSince $-128 \\le 27 \\le 127$, the result does not saturate: $\\operatorname{sat}(27) = 27$.\nThe final result of the expression $x+y-y$ is $27$.\nThe original value of $x$ was $100$.\nSince $27 \\ne 100$, the rewrite $x + y - y \\to x$ is not semantics-preserving. The identity does not hold for all $x,y$.\n\n**Verdict for B:** **Incorrect**.\n\n**Analysis of Option C**\n\nStatement: In signed $8$-bit saturating arithmetic, the rewrite $x + y - y \\to x$ is semantics-preserving provided the optimizer proves the ordinary mathematical sum $x + y$ lies in $[-128,127]$ (so the intermediate addition does not saturate).\n\nThe condition is that for any given $x, y \\in R$, the ordinary sum $x +_{\\mathbb{Z}} y$ is within the range $R = [-128, 127]$.\nLet's evaluate the expression $(x \\oplus y) \\ominus y$ under this condition.\nFirst, $x \\oplus y = \\operatorname{sat}(x +_{\\mathbb{Z}} y)$.\nGiven the condition $x +_{\\mathbb{Z}} y \\in [-128, 127]$, the $\\operatorname{sat}$ function is an identity. So, $x \\oplus y = x +_{\\mathbb{Z}} y$.\nNext, we evaluate $(x \\oplus y) \\ominus y$. This becomes $(x +_{\\mathbb{Z}} y) \\ominus y$.\nBy definition, this is equal to $\\operatorname{sat}((x +_{\\mathbb{Z}} y) -_{\\mathbb{Z}} y)$.\nThe ordinary integer arithmetic simplifies inside the $\\operatorname{sat}$ function: $(x +_{\\mathbb{Z}} y) -_{\\mathbb{Z}} y = x$.\nSo, the expression becomes $\\operatorname{sat}(x)$.\nSince $x$ is a value in the IR, it is already in the representable range $R = [-128, 127]$.\nTherefore, $\\operatorname{sat}(x) = x$.\nThus, under the given condition, $(x \\oplus y) \\ominus y = x$. The rewrite is semantics-preserving.\n\n**Verdict for C:** **Correct**.\n\n**Analysis of Option D**\n\nStatement: In signed $8$-bit saturating arithmetic, the rewrite $x + y - y \\to x$ is semantics-preserving provided the optimizer proves $x \\ge 0$ and $y \\ge 0$.\n\nThis condition is not sufficient to prevent saturation. The counterexample used for Option B demonstrates this.\nLet $x = 100$ and $y = 100$.\nThe condition $x \\ge 0$ and $y \\ge 0$ is satisfied, as $100 \\ge 0$.\nAs calculated for Option B, the expression $x + y - y$ evaluates to $27$, while $x$ is $100$.\nSince $27 \\ne 100$, the rewrite is not semantics-preserving even with this condition.\n\n**Verdict for D:** **Incorrect**.\n\n**Analysis of Option E**\n\nStatement: In unsigned $8$-bit saturating arithmetic with representable range $[0,255]$, the rewrite $x + y - y \\to x$ is semantics-preserving for all $x,y$.\n\nThis option changes the context to unsigned $8$-bit arithmetic.\nThe representable range is $R_u = [0, 255]$.\nThe saturation function, let's call it $\\operatorname{sat}_u$, clamps to this range.\nWe need to check if $(x \\oplus_u y) \\ominus_u y = x$ for all $x, y \\in R_u$.\nLet's use a counterexample similar to the one in Option B. We need the intermediate sum to saturate.\nLet $x = 200$ and $y = 100$. Both values are in $R_u$.\nFirst, calculate $x \\oplus_u y$:\n$x \\oplus_u y = \\operatorname{sat}_u(200 +_{\\mathbb{Z}} 100) = \\operatorname{sat}_u(300)$.\nSince $300 > 255$, the result saturates to the maximum value: $\\operatorname{sat}_u(300) = 255$.\nSo, $x \\oplus_u y = 255$.\nNext, calculate $(x \\oplus_u y) \\ominus_u y$:\n$(x \\oplus_u y) \\ominus_u y = 255 \\ominus_u 100 = \\operatorname{sat}_u(255 -_{\\mathbb{Z}} 100) = \\operatorname{sat}_u(155)$.\nSince $0 \\le 155 \\le 255$, the result does not saturate: $\\operatorname{sat}_u(155) = 155$.\nThe final result is $155$. The original value of $x$ was $200$.\nSince $155 \\ne 200$, the rewrite is not semantics-preserving for all $x,y$ in the unsigned $8$-bit case either. The logic of failure due to saturation is identical to the signed case.\n\n**Verdict for E:** **Incorrect**.",
            "answer": "$$\\boxed{AC}$$"
        }
    ]
}