{
    "hands_on_practices": [
        {
            "introduction": "这个练习模拟了一个经典的通信场景：从带有噪声的重复观测中推断原始信号。通过计算在收到两个“标称”信号后，系统处于“标称”状态的后验概率，你将亲身体会贝叶斯规则如何利用冗余信息来显著提高我们对真实状态的信心。这个原理是构建可靠通信系统的基石。",
            "id": "1603696",
            "problem": "一个深空探测器正在监测一个关键子系统。它将该子系统的状态总结为一个二进制数字 $X$，其中 $X=0$ 表示“正常运行”，$X=1$ 表示“警报状态”。根据大量的测试和运行历史，已知该子系统处于正常状态的先验概率为 $p_0 = 0.95$。\n\n为确保在到地球的遥远距离上进行可靠通信，探测器通过同一通信信道连续两次传输状态位 $X$。该信道会受到噪声影响，可以精确地建模为一个二进制对称信道 (BSC)，即传输的比特以一个恒定的概率 $\\epsilon = 0.10$ 发生翻转（即，发送的 0 被接收为 1，或发送的 1 被接收为 0）。每次传输都是一个独立事件。\n\n地球上任务控制中心的一位分析师接收到序列为 $(0, 0)$ 的两个比特。根据这一观察结果，计算探测器子系统处于“正常运行”状态的更新概率。\n\n请将您的答案以小数形式表示，并四舍五入到四位有效数字。",
            "solution": "令 $X \\in \\{0,1\\}$ 表示子系统状态，其先验概率为 $P(X=0)=p_{0}$ 和 $P(X=1)=1-p_{0}$。令 $Y_{1},Y_{2} \\in \\{0,1\\}$ 为两个接收到的比特，它们通过一个交叉概率为 $\\epsilon$ 的二进制对称信道独立传输。对于一个 BSC，$P(Y_{i}=y \\mid X=x)=1-\\epsilon$ 如果 $y=x$，而 $P(Y_{i}=y \\mid X=x)=\\epsilon$ 如果 $y \\neq x$。传输的条件独立性给出 $P(Y_{1}=y_{1},Y_{2}=y_{2} \\mid X=x)=\\prod_{i=1}^{2}P(Y_{i}=y_{i} \\mid X=x)$。\n\n给定观察结果 $(Y_{1},Y_{2})=(0,0)$，似然函数为\n$$\nP(Y_{1}=0,Y_{2}=0 \\mid X=0)=(1-\\epsilon)^{2}, \\quad P(Y_{1}=0,Y_{2}=0 \\mid X=1)=\\epsilon^{2}.\n$$\n根据贝叶斯定理，\n$$\nP(X=0 \\mid Y_{1}=0,Y_{2}=0)=\\frac{p_{0}(1-\\epsilon)^{2}}{p_{0}(1-\\epsilon)^{2}+(1-p_{0})\\epsilon^{2}}.\n$$\n代入 $p_{0}=0.95$ 和 $\\epsilon=0.10$，\n$$\nP(X=0 \\mid Y_{1}=0,Y_{2}=0)=\\frac{0.95 \\times 0.90^{2}}{0.95 \\times 0.90^{2}+0.05 \\times 0.10^{2}}=\\frac{0.7695}{0.7695+0.0005}=\\frac{0.7695}{0.7700}.\n$$\n因此，\n$$\nP(X=0 \\mid Y_{1}=0,Y_{2}=0)=0.999350649\\dots \\approx 0.9994 \\text{ (精确到四位有效数字)}.\n$$",
            "answer": "$$\\boxed{0.9994}$$"
        },
        {
            "introduction": "现实世界中的许多系统涉及多级串联的随机过程。本练习将信号通过两级中继站的场景抽象为一个马尔可夫链 $X \\to Y \\to Z$，要求你根据最终的观测结果推断初始信号的来源。通过解决这个问题，你将学会如何将贝叶斯推理应用于更复杂的链式模型中，这对于信号处理、生物信息学和金融建模等领域至关重要。",
            "id": "1603695",
            "problem": "一个数字通信系统涉及通过一个两级中继过程来发送信号。在源头，一个信源生成三种可能的信号类型之一，我们称之为类型1、类型2和类型3。初始信号由随机变量 $X \\in \\{1, 2, 3\\}$ 表示，其生成具有以下先验概率：\n$P(X=1) = 0.5$， $P(X=2) = 0.3$，以及 $P(X=3) = 0.2$。\n\n该信号随后通过第一个噪声中继。该中继的输出是信号 $Y \\in \\{1, 2, 3\\}$。此阶段噪声的概率特性由条件概率矩阵 $T_{Y|X}$ 捕捉，其中条目 $(T_{Y|X})_{ij} = P(Y=i|X=j)$ 是在原始信号为类型 $j$ 的情况下，在第一个中继处观测到信号类型 $i$ 的概率。该矩阵为：\n$$ T_{Y|X} = \\begin{pmatrix} 0.8  0.1  0.2 \\\\ 0.1  0.7  0.3 \\\\ 0.1  0.2  0.5 \\end{pmatrix} $$\n\n信号 $Y$ 接着被发送通过第二个噪声中继，产生最终信号 $Z \\in \\{1, 2, 3\\}$。在给定中间信号 $Y$ 的条件下，这第二步传输与原始信号 $X$ 无关，从而形成一个马尔可夫链 $X \\to Y \\to Z$。第二个中继的噪声特性由矩阵 $T_{Z|Y}$ 给出，其中 $(T_{Z|Y})_{ij} = P(Z=i|Y=j)$：\n$$ T_{Z|Y} = \\begin{pmatrix} 0.9  0.2  0.1 \\\\ 0.05  0.6  0.2 \\\\ 0.05  0.2  0.7 \\end{pmatrix} $$\n\n接收端的工程师观察到最终信号为类型3，即 $Z=3$。基于此观测，原始信号类型 $X$ 的后验概率分布是什么？计算概率 $P(X=1|Z=3)$、$P(X=2|Z=3)$ 和 $P(X=3|Z=3)$。\n\n将您的答案表示为一个行矩阵，按顺序包含这三个概率 $[P(X=1|Z=3), P(X=2|Z=3), P(X=3|Z=3)]$。将最终答案中的每个概率四舍五入到四位有效数字。",
            "solution": "我们应用贝叶斯定理以及马尔可夫性质 $X \\to Y \\to Z$。对于 $j \\in \\{1,2,3\\}$，\n$$\nP(X=j \\mid Z=3) = \\frac{P(Z=3 \\mid X=j) P(X=j)}{P(Z=3)}.\n$$\n根据全概率公式和条件独立性，\n$$\nP(Z=3 \\mid X=j) = \\sum_{y=1}^{3} P(Z=3 \\mid Y=y) P(Y=y \\mid X=j).\n$$\n使用给定的矩阵，$T_{Z \\mid Y}$ 中对应于 $Z=3$ 的行为 $[0.05, 0.2, 0.7]$，而 $T_{Y \\mid X}$ 中对应于 $X=1,2,3$ 的列分别为 $[0.8, 0.1, 0.1]^{\\top}$、$[0.1, 0.7, 0.2]^{\\top}$ 和 $[0.2, 0.3, 0.5]^{\\top}$。因此，\n$$\n\\begin{aligned}\nP(Z=3 \\mid X=1) = 0.05 \\cdot 0.8 + 0.2 \\cdot 0.1 + 0.7 \\cdot 0.1 = 0.13, \\\\\nP(Z=3 \\mid X=2) = 0.05 \\cdot 0.1 + 0.2 \\cdot 0.7 + 0.7 \\cdot 0.2 = 0.285, \\\\\nP(Z=3 \\mid X=3) = 0.05 \\cdot 0.2 + 0.2 \\cdot 0.3 + 0.7 \\cdot 0.5 = 0.42.\n\\end{aligned}\n$$\n证据项为\n$$\nP(Z=3) = \\sum_{j=1}^{3} P(Z=3 \\mid X=j) P(X=j) = 0.13 \\cdot 0.5 + 0.285 \\cdot 0.3 + 0.42 \\cdot 0.2 = 0.2345.\n$$\n因此，\n$$\n\\begin{aligned}\nP(X=1 \\mid Z=3) = \\frac{0.13 \\cdot 0.5}{0.2345} = \\frac{0.065}{0.2345} \\approx 0.2771855, \\\\\nP(X=2 \\mid Z=3) = \\frac{0.285 \\cdot 0.3}{0.2345} = \\frac{0.0855}{0.2345} \\approx 0.3646055, \\\\\nP(X=3 \\mid Z=3) = \\frac{0.42 \\cdot 0.2}{0.2345} = \\frac{0.084}{0.2345} \\approx 0.3582089.\n\\end{aligned}\n$$\n将每个概率四舍五入到四位有效数字，得到\n$$\n\\begin{pmatrix}\n0.2772  0.3646  0.3582\n\\end{pmatrix}.\n$$",
            "answer": "$$\\boxed{\\begin{pmatrix}0.2772  0.3646  0.3582\\end{pmatrix}}$$"
        },
        {
            "introduction": "贝叶斯规则的威力远不止于推断单个未知事件。在这个更高级的练习中，我们将探讨如何学习一个数据源本身的基本参数。你将为一个未知参数 $p$（比特“1”出现的概率）设定一个先验分布，然后根据观测到的数据序列来更新这个分布，并计算该参数的期望值。这种方法是贝叶斯参数估计的核心，它让我们能够从数据中“学习”模型，是现代机器学习和统计推断的基石。",
            "id": "1603712",
            "problem": "一位工程师的任务是描述一种新型二进制内存源的特性。该源生成一个比特序列（0和1）。假设每个比特的生成是一个独立事件。任何给定比特为“1”的概率是一个未知常数 $p$。因此，其为“0”的概率是 $1-p$。\n\n由于制造过程的原因，参数 $p$ 在所有此类源中并非固定不变，但可以建模为一个随机变量。根据设计规范，工程师对 $p$ 分布的初始信念由一个参数为 $\\alpha=2$ 和 $\\beta=2$ 的贝塔概率密度函数描述。该概率密度函数由下式给出：\n$$f(p) = \\frac{p^{\\alpha-1}(1-p)^{\\beta-1}}{B(\\alpha, \\beta)}$$\n对于 $0  p  1$，其中 $B(\\alpha, \\beta)$ 是作为归一化常数的贝塔函数。\n\n为了完善这个模型，工程师观察了一个特定源生成的包含 $100$ 个比特的测试序列。发现该序列恰好包含 $70$ 个1和 $30$ 个0。\n\n给定这些新数据，计算概率参数 $p$ 的更新后的期望值。将您的答案表示为保留三位有效数字的小数。",
            "solution": "我们将比特序列建模为成功概率为 $p$ 的独立伯努利试验。$p$ 的先验分布为 $\\operatorname{Beta}(\\alpha,\\beta)$，其中 $\\alpha=2$ 和 $\\beta=2$，其密度函数为\n$$\nf(p)=\\frac{p^{\\alpha-1}(1-p)^{\\beta-1}}{B(\\alpha,\\beta)}, \\quad 0  p  1.\n$$\n观察到的数据包括 $S=70$ 个“1”（成功）和 $F=30$ 个“0”（失败），总共 $N=100$ 次试验。似然函数是二项分布 $L(p \\mid D) \\propto p^S(1-p)^F$。\n后验分布 $f(p \\mid D)$ 与先验和似然的乘积成正比：\n$$\nf(p \\mid D) \\propto p^{\\alpha-1}(1-p)^{\\beta-1} p^S(1-p)^F = p^{\\alpha+S-1}(1-p)^{\\beta+F-1}.\n$$\n这可以被识别为 $\\operatorname{Beta}(\\alpha+S, \\beta+F)$ 分布。\n代入值，后验分布为\n$$\np \\mid D \\sim \\operatorname{Beta}(2+70, 2+30) = \\operatorname{Beta}(72,32).\n$$\n对于一个 $\\operatorname{Beta}(\\alpha_{\\text{post}}, \\beta_{\\text{post}})$ 分布，其期望值为 $E[p \\mid D] = \\frac{\\alpha_{\\text{post}}}{\\alpha_{\\text{post}}+\\beta_{\\text{post}}}$。\n因此，更新后的期望值为\n$$\nE[p \\mid D] = \\frac{72}{72+32} = \\frac{72}{104} \\approx 0.692307\\dots\n$$\n保留三位有效数字，我们得到 $0.692$。",
            "answer": "$$\\boxed{0.692}$$"
        }
    ]
}