{
    "hands_on_practices": [
        {
            "introduction": "理解数据压缩的第一步是认识到并非所有序列都以相同的概率出现。信息论告诉我们，对于一个给定的信息源，绝大多数可能产生的长序列都属于一个被称为“典型集”的小得多的集合。这个练习将带你亲手计算这个典型集的大小，这是一个基本技能，它揭示了为什么数据压缩是可能的：我们只需要为典型序列设计编码方案即可。",
            "id": "1611193",
            "problem": "一个生物信息学家团队正在研究一个病毒基因组的高度保守区域。他们将该区域建模为一个核酸碱基序列，其中可能的碱基字母表为 $\\mathcal{X} = \\{\\text{A, C, G, T}\\}$。基于来自数千个病毒样本的大量数据，他们为任意位置上每个碱基的出现建立了一个平稳概率模型。该模型假设序列中的每个碱基都是一个独立同分布的随机变量。每个碱基的既定概率如下：\n-   腺嘌呤 (A) 的概率：$p_A = \\frac{1}{2}$\n-   鸟嘌呤 (G) 的概率：$p_G = \\frac{1}{4}$\n-   胞嘧啶 (C) 的概率：$p_C = \\frac{1}{8}$\n-   胸腺嘧啶 (T) 的概率：$p_T = \\frac{1}{8}$\n\n该团队正在开发一种计算工具，用于识别“统计典型”的基因组序列以进行分析。该工具的一个关键组成部分是一个函数，用于估计给定长度的此类典型序列的总数。对于一个长度为 $L$ 的足够长的序列，典型序列的数量 $N_{typical}$ 可以通过 $2^{L \\cdot H(X)}$ 精确近似，其中 $H(X)$ 是单个碱基源的香农熵，以比特为单位。\n\n对于一个长度为 $L = 64$ 个碱基的基因组序列，计算统计典型序列的近似数量 $N_{typical}$。将您的答案以科学记数法表示，并四舍五入到三位有效数字。",
            "solution": "给定一个在 $\\mathcal{X}=\\{\\text{A,C,G,T}\\}$ 上的独立同分布（i.i.d.）信源，其概率为 $p_{A}=\\frac{1}{2}$，$p_{G}=\\frac{1}{4}$，$p_{C}=\\frac{1}{8}$，$p_{T}=\\frac{1}{8}$。以比特为单位的香农熵是\n$$\nH(X)=-\\sum_{x\\in\\mathcal{X}} p_{x}\\log_{2} p_{x}.\n$$\n计算每一项：\n- 对于 $p_{A}=\\frac{1}{2}$：$-\\frac{1}{2}\\log_{2}\\!\\left(\\frac{1}{2}\\right)=\\frac{1}{2}$。\n- 对于 $p_{G}=\\frac{1}{4}$：$-\\frac{1}{4}\\log_{2}\\!\\left(\\frac{1}{4}\\right)=\\frac{1}{2}$。\n- 对于 $p_{C}=p_{T}=\\frac{1}{8}$：每一项的贡献为 $-\\frac{1}{8}\\log_{2}\\!\\left(\\frac{1}{8}\\right)=\\frac{3}{8}$，所以两者相加为 $\\frac{3}{8}+\\frac{3}{8}=\\frac{3}{4}$。\n因此\n$$\nH(X)=\\frac{1}{2}+\\frac{1}{2}+\\frac{3}{4}=\\frac{7}{4}\\ \\text{bits}.\n$$\n对于序列长度 $L=64$，典型集的大小近似为\n$$\nN_{\\text{typical}}\\approx 2^{L H(X)}=2^{64\\cdot \\frac{7}{4}}=2^{112}.\n$$\n要将 $2^{112}$ 表示为科学记数法，我们写作 $2^{112}=10^{112\\log_{10} 2}$。使用 $\\log_{10} 2\\approx 0.30103$，\n$$\n\\log_{10} N_{\\text{typical}}=112\\log_{10} 2\\approx 33.71536,\n$$\n所以\n$$\nN_{\\text{typical}}\\approx 10^{0.71536}\\times 10^{33}\\approx 5.19\\times 10^{33},\n$$\n四舍五入到三位有效数字。",
            "answer": "$$\\boxed{5.19 \\times 10^{33}}$$"
        },
        {
            "introduction": "知道了典型序列有多少之后，下一个自然的问题是：典型序列“长什么样”？这个练习将带你深入探索典型序列的内部结构，揭示它们的经验统计特性必须接近于信源本身的统计特性。通过将典型集的抽象概率定义与序列中符号的具体数量联系起来，你将更好地理解渐近均分特性（Asymptotic Equipartition Property, AEP）的实际意义。",
            "id": "1611198",
            "problem": "一个信息源从字母表 $\\mathcal{X}=\\{\\text{'a'},\\text{'b'}\\}$ 中生成一个符号流。这些符号是独立生成的，其概率为 $P(\\text{'a'}) = 0.8$ 和 $P(\\text{'b'}) = 0.2$。\n如果一个序列的属性接近于该信源的长期平均行为，则该序列被认为是“统计代表性”的。对于一个长度为 $n=100$ 的序列 $x^n$，这个条件通过其出现概率 $p(x^n)$ 在数学上表示如下：\n$$ \\left| \\frac{-\\log_2(p(x^n))}{n} - H \\right| \\le \\epsilon $$\n在此表达式中，$H$ 是信源的香农熵，由 $H = -\\sum_{i \\in \\mathcal{X}} P(i) \\log_2(P(i))$ 给出，而 $\\epsilon$ 是一个小的容差因子。\n\n给定 $n=100$ 和 $\\epsilon=0.05$，请找出一个长度为100的符号序列要被归类为统计代表性序列，符号 'a' 在其中可以出现的最小和最大次数。你的答案必须包含两个整数。",
            "solution": "令 $p \\triangleq P(\\text{'a'}) = \\frac{4}{5}$ 且 $q \\triangleq P(\\text{'b'}) = \\frac{1}{5}$。对于一个长度为 $n$ 的序列，其中包含 $k$ 次 $\\text{'a'}$ 和 $n-k$ 次 $\\text{'b'}$，其概率为\n$$\np(x^{n}) = p^{k} q^{n-k}.\n$$\n定义经验分数 $f \\triangleq \\frac{k}{n}$。那么\n$$\n- \\frac{1}{n} \\log_{2} p(x^{n}) = -\\left( f \\log_{2} p + (1-f) \\log_{2} q \\right).\n$$\n当 $p=\\frac{4}{5}$ 且 $q=\\frac{1}{5}$ 时，注意到\n$$\n\\log_{2}\\!\\left(\\frac{4}{5}\\right) = 2 - \\log_{2} 5, \\quad \\log_{2}\\!\\left(\\frac{1}{5}\\right) = - \\log_{2} 5,\n$$\n所以\n$$\n- \\frac{1}{n} \\log_{2} p(x^{n}) = -\\left[ f(2 - \\log_{2} 5) + (1-f)(- \\log_{2} 5) \\right] = \\log_{2} 5 - 2f.\n$$\n香农熵为\n$$\nH = -\\left( p \\log_{2} p + q \\log_{2} q \\right) = -\\left( \\frac{4}{5} \\log_{2}\\!\\frac{4}{5} + \\frac{1}{5} \\log_{2}\\!\\frac{1}{5} \\right)\n= \\log_{2} 5 - \\frac{8}{5}.\n$$\n典型性条件\n$$\n\\left| - \\frac{1}{n} \\log_{2} p(x^{n}) - H \\right| \\le \\epsilon\n$$\n变为\n$$\n\\left| (\\log_{2} 5 - 2f) - \\left(\\log_{2} 5 - \\frac{8}{5}\\right) \\right| \\le \\epsilon\n\\;\\;\\Longleftrightarrow\\;\\;\n|\\,2f - \\tfrac{8}{5}\\,| \\le \\epsilon.\n$$\n因此\n$$\n\\frac{8}{5} - \\epsilon \\le 2f \\le \\frac{8}{5} + \\epsilon\n\\;\\;\\Longleftrightarrow\\;\\;\n\\frac{4}{5} - \\frac{\\epsilon}{2} \\le f \\le \\frac{4}{5} + \\frac{\\epsilon}{2}.\n$$\n当 $n=100$ 且 $\\epsilon = 0.05$ 时，我们得到\n$$\n\\frac{4}{5} - \\frac{0.05}{2} \\le f \\le \\frac{4}{5} + \\frac{0.05}{2}\n\\;\\;\\Longleftrightarrow\\;\\;\n0.8 - 0.025 \\le f \\le 0.8 + 0.025\n\\;\\;\\Longleftrightarrow\\;\\;\n0.775 \\le f \\le 0.825.\n$$\n两边乘以 $n=100$ 得到 $k$ 的允许范围：\n$$\n77.5 \\le k \\le 82.5.\n$$\n由于 $k$ 必须是整数，\n$$\nk_{\\min} = \\lceil 77.5 \\rceil = 78, \\quad k_{\\max} = \\lfloor 82.5 \\rfloor = 82.\n$$\n因此，符号 $\\text{'a'}$ 可以出现的最小和最大次数分别为 $78$ 和 $82$。",
            "answer": "$$\\boxed{\\begin{pmatrix}78  82\\end{pmatrix}}$$"
        },
        {
            "introduction": "典型序列的概念不仅是理论上的，它在实践中也有着广泛应用，例如在异常检测和系统监控中。这个练习模拟了一个实时的质量控制系统，该系统通过监测产出序列的经验熵是否偏离理论熵来判断生产过程是否正常。这个动态过程生动地展示了大数定律的威力——随着序列变长，其经验熵会收敛到真实的信源熵，而任何显著的偏离都可能预示着异常的发生。",
            "id": "1611204",
            "problem": "一个异常检测系统被设计用于监控一个生产微芯片流的制造过程。该过程旨在作为一个离散无记忆信源运行，产生三种类型的芯片，由字母表 $\\mathcal{X} = \\{A, B, C\\}$ 表示，其概率分别为 $p(A) = \\frac{1}{2}$，$p(B) = \\frac{1}{4}$ 和 $p(C) = \\frac{1}{4}$。\n\n该系统的异常测试是顺序操作的。在每个时间步 $k$ 生产出芯片 $x_k$ 后，系统会计算观测序列 $x_1, \\dots, x_k$ 的运行经验熵 $H_k$。经验熵定义为 $H_k = - \\sum_{i \\in \\mathcal{X}} \\hat{p}_k(i) \\log_2(\\hat{p}_k(i))$，其中 $\\hat{p}_k(i)$ 是前 $k$ 个输出中芯片类型 $i$ 的观测频率。使用约定 $0 \\log_2(0) = 0$。\n\n当经验熵 $H_k$ 与信源的设计熵 $H(X)$ 之间的绝对差首次超过一个随时间变化的容差 $\\delta(k)$ 时（时间步 $k \\ge 1$），系统会标记异常并停止生产线。设计熵为 $H(X) = - \\sum_{i \\in \\mathcal{X}} p(i) \\log_2(p(i))$，容差由函数 $\\delta(k) = \\frac{1.6}{\\sqrt{k}}$ 给出。\n\n假设系统观察到一次生产运行的开始，其芯片序列如下：\n`A, B, C, C, C, C, C, C, C, C`\n\n系统在哪个时间步 $k$ 停止生产？请提供 $k$ 的整数值。",
            "solution": "信源分布为 $p(A)=\\frac{1}{2}$，$p(B)=\\frac{1}{4}$，$p(C)=\\frac{1}{4}$。设计熵为\n$$\nH(X)=-\\sum_{i\\in\\{A,B,C\\}}p(i)\\log_{2}p(i)=-\\left(\\tfrac{1}{2}\\log_{2}\\tfrac{1}{2}+\\tfrac{1}{4}\\log_{2}\\tfrac{1}{4}+\\tfrac{1}{4}\\log_{2}\\tfrac{1}{4}\\right)=\\tfrac{3}{2}=1.5.\n$$\n顺序容差为 $\\delta(k)=\\frac{1.6}{\\sqrt{k}}$。在每个芯片 $x_{k}$ 之后，根据经验分布 $\\hat{p}_{k}$，经验熵为 $H_{k}=-\\sum_{i}\\hat{p}_{k}(i)\\log_{2}\\hat{p}_{k}(i)$，系统将在第一个满足 $|H_{k}-H(X)|\\delta(k)$ 的 $k$ 值处停止。\n\n逐步处理观测序列 A, B, C, C, C, C, C, C, C, C：\n\n- $k=1$：计数为 $(1,0,0)$，因此 $\\hat{p}_{1}=(1,0,0)$ 且 $H_{1}=0$。则 $|H_{1}-H(X)|=1.5$ 且 $\\delta(1)=1.6$。由于 $1.5  1.6$，不停止。\n\n- $k=2$：计数为 $(1,1,0)$，因此 $\\hat{p}_{2}=\\left(\\tfrac{1}{2},\\tfrac{1}{2},0\\right)$ 且 $H_{2}=-2\\cdot\\tfrac{1}{2}\\log_{2}\\tfrac{1}{2}=1$。则 $|H_{2}-H(X)|=0.5$ 且 $\\delta(2)=\\tfrac{1.6}{\\sqrt{2}}\\approx 1.131$，不停止。\n\n- $k=3$：计数为 $(1,1,1)$，因此 $\\hat{p}_{3}=\\left(\\tfrac{1}{3},\\tfrac{1}{3},\\tfrac{1}{3}\\right)$ 且 $H_{3}=\\log_{2}3\\approx 1.585$。则 $|H_{3}-H(X)|\\approx 0.085$ 且 $\\delta(3)=\\tfrac{1.6}{\\sqrt{3}}\\approx 0.924$，不停止。\n\n- $k=4$：计数为 $(1,1,2)$，因此 $\\hat{p}_{4}=\\left(\\tfrac{1}{4},\\tfrac{1}{4},\\tfrac{1}{2}\\right)$ 且 $H_{4}=H(X)=1.5$。则 $|H_{4}-H(X)|=0$ 且 $\\delta(4)=\\tfrac{1.6}{2}=0.8$，不停止。\n\n- $k=5$：计数为 $(1,1,3)$，因此 $\\hat{p}_{5}=\\left(\\tfrac{1}{5},\\tfrac{1}{5},\\tfrac{3}{5}\\right)$ 且\n$$\nH_{5}=-\\left(\\tfrac{2}{5}\\log_{2}\\tfrac{1}{5}+\\tfrac{3}{5}\\log_{2}\\tfrac{3}{5}\\right)\\approx 1.371.\n$$\n则 $|H_{5}-H(X)|\\approx 0.129$ 且 $\\delta(5)=\\tfrac{1.6}{\\sqrt{5}}\\approx 0.716$，不停止。\n\n- $k=6$：计数为 $(1,1,4)$，因此 $\\hat{p}_{6}=\\left(\\tfrac{1}{6},\\tfrac{1}{6},\\tfrac{2}{3}\\right)$ 且\n$$\nH_{6}=-\\left(\\tfrac{2}{6}\\log_{2}\\tfrac{1}{6}+\\tfrac{2}{3}\\log_{2}\\tfrac{2}{3}\\right)\\approx 1.252.\n$$\n则 $|H_{6}-H(X)|\\approx 0.248$ 且 $\\delta(6)=\\tfrac{1.6}{\\sqrt{6}}\\approx 0.653$，不停止。\n\n- $k=7$：计数为 $(1,1,5)$，因此 $\\hat{p}_{7}=\\left(\\tfrac{1}{7},\\tfrac{1}{7},\\tfrac{5}{7}\\right)$ 且\n$$\nH_{7}=-\\left(\\tfrac{2}{7}\\log_{2}\\tfrac{1}{7}+\\tfrac{5}{7}\\log_{2}\\tfrac{5}{7}\\right)\\approx 1.149.\n$$\n则 $|H_{7}-H(X)|\\approx 0.351$ 且 $\\delta(7)=\\tfrac{1.6}{\\sqrt{7}}\\approx 0.604$，不停止。\n\n- $k=8$：计数为 $(1,1,6)$，因此 $\\hat{p}_{8}=\\left(\\tfrac{1}{8},\\tfrac{1}{8},\\tfrac{3}{4}\\right)$ 且\n$$\nH_{8}=-\\left(\\tfrac{1}{4}\\log_{2}\\tfrac{1}{8}+\\tfrac{3}{4}\\log_{2}\\tfrac{3}{4}\\right)= -\\left(\\tfrac{1}{4}(-3)+\\tfrac{3}{4}(\\log_{2}3-2)\\right)\\approx 1.061.\n$$\n则 $|H_{8}-H(X)|\\approx 0.439$ 且 $\\delta(8)=\\tfrac{1.6}{\\sqrt{8}}\\approx 0.566$，不停止。\n\n- $k=9$：计数为 $(1,1,7)$，因此 $\\hat{p}_{9}=\\left(\\tfrac{1}{9},\\tfrac{1}{9},\\tfrac{7}{9}\\right)$ 且\n$$\nH_{9}=-\\left(\\tfrac{2}{9}\\log_{2}\\tfrac{1}{9}+\\tfrac{7}{9}\\log_{2}\\tfrac{7}{9}\\right)\\approx 1.014.\n$$\n则 $|H_{9}-H(X)|\\approx 0.486$ 且 $\\delta(9)=\\tfrac{1.6}{3}\\approx 0.533$，不停止。\n\n- $k=10$：计数为 $(1,1,8)$，因此 $\\hat{p}_{10}=\\left(\\tfrac{1}{10},\\tfrac{1}{10},\\tfrac{4}{5}\\right)$ 且\n$$\nH_{10}=-\\left(\\tfrac{1}{5}\\log_{2}\\tfrac{1}{10}+\\tfrac{4}{5}\\log_{2}\\tfrac{4}{5}\\right)\\approx 0.922.\n$$\n则 $|H_{10}-H(X)|\\approx 1.5-0.922=0.578$ 且 $\\delta(10)=\\tfrac{1.6}{\\sqrt{10}}\\approx 0.506$。由于 $0.578 > 0.506$，停止条件满足。\n\n因此，首次超过阈值的时间步是 $k=10$。",
            "answer": "$$\\boxed{10}$$"
        }
    ]
}