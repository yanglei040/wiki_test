{
    "hands_on_practices": [
        {
            "introduction": "这个 foundational 练习将引导你完成一个最典型的MAP译码场景。你将为一个具有不均匀先验概率的二进制信源，在一个经典的二进制对称信道（BSC）中，推导出完整的MAP决策规则。这个实践的价值在于让你亲手计算并比较后验概率，从而真正理解MAP译码是如何利用信源的统计特性来超越仅依赖似然性的ML译码，并最终量化其性能——即平均错误概率 。",
            "id": "1639810",
            "problem": "一个远程环境监测系统使用一个二进制传感器来传输其探测结果。传感器的状态由一个二进制随机变量 $X$ 表示，其中 $X=0$ 表示“正常”状况，$X=1$ 表示“警报”状况。长期数据显示，“正常”状态更为常见，其先验概率为 $P(X=0) = 0.7$ 和 $P(X=1) = 0.3$。\n\n传感器的状态通过一个表现为二元对称信道 (BSC) 的嘈杂通信链路传输到基站。BSC 由一个单一参数，即交叉概率 $p$ 来表征，该概率是指传输的比特被错误接收的概率（即，'0' 被接收为 '1' 或 '1' 被接收为 '0'）。对于这个特定信道，交叉概率为 $p = 0.1$。\n\n在基站，一个解码器接收到一个符号 $Y \\in \\{0, 1\\}$，并且必须对原始传输的符号 $X$ 做出一个估计 $\\hat{X}$。为了达到最低的错误判决率，采用了最大后验 (MAP) 判决准则。\n\n你的任务是确定具体的 MAP 判决准则以及由此产生的平均错误概率 $P_e = P(\\hat{X} \\neq X)$。该判决准则由输出对 $(\\hat{X}(Y=0), \\hat{X}(Y=1))$ 完全描述，它为每个可能接收到的符号指定了估计值。\n\n以下哪个选项正确地陈述了 MAP 判决准则和相应的平均错误概率？\n\nA. 准则是 $(\\hat{X}(Y=0), \\hat{X}(Y=1)) = (0, 1)$，且 $P_e = 0.10$。\n\nB. 准则是 $(\\hat{X}(Y=0), \\hat{X}(Y=1)) = (0, 0)$，且 $P_e = 0.30$。\n\nC. 准则是 $(\\hat{X}(Y=0), \\hat{X}(Y=1)) = (0, 1)$，且 $P_e = 0.07$。\n\nD. 准则是 $(\\hat{X}(Y=0), \\hat{X}(Y=1)) = (0, 0)$，且 $P_e = 0.10$。\n\nE. 准则是 $(\\hat{X}(Y=0), \\hat{X}(Y=1)) = (1, 0)$，且 $P_e = 0.90$。",
            "solution": "我们给定一个二进制信源，其先验概率为 $P(X=0)=0.7$ 和 $P(X=1)=0.3$，以及一个交叉概率为 $p=0.1$ 的二元对称信道 (BSC)。接收到的符号是 $Y \\in \\{0,1\\}$。MAP 准则为每个接收到的 $y$ 选择能使后验概率 $P(X=x \\mid Y=y)$ 最大化的假设 $x \\in \\{0,1\\}$，这等价于最大化乘积 $P(Y=y \\mid X=x)P(X=x)$。\n\n对于BSC，似然概率为\n$$\nP(Y=y \\mid X=x)=\\begin{cases}\n1-p, & y=x,\\\\\np, & y \\neq x.\n\\end{cases}\n$$\n\n对于 $Y=0$ 的判决：比较 $(1-p)P(X=0)$ 和 $p P(X=1)$。\n$$\n(1-p)P(X=0) \\overset{?}{\\ge} p P(X=1).\n$$\n代入给定值，\n$$\n(1-0.1)\\cdot 0.7 = 0.63 \\quad \\text{和} \\quad 0.1 \\cdot 0.3 = 0.03,\n$$\n所以 $(1-p)P(X=0) > p P(X=1)$，MAP 判决为 $\\hat{X}(Y=0)=0$。\n\n对于 $Y=1$ 的判决：比较 $p P(X=0)$ 和 $(1-p)P(X=1)$。\n$$\np P(X=0) \\overset{?}{\\ge} (1-p) P(X=1).\n$$\n代入数值，\n$$\n0.1 \\cdot 0.7 = 0.07 \\quad \\text{和} \\quad (1-0.1)\\cdot 0.3 = 0.27,\n$$\n所以 $p P(X=0) < (1-p)P(X=1)$，MAP 判决为 $\\hat{X}(Y=1)=1$。\n\n因此，MAP 准则是 $(\\hat{X}(Y=0), \\hat{X}(Y=1))=(0,1)$。\n\n接下来，计算在此准则下的平均错误概率：\n$$\nP_{e} = P(X=0) P(\\hat{X} \\neq X \\mid X=0) + P(X=1) P(\\hat{X} \\neq X \\mid X=1).\n$$\n根据该准则，发生错误当且仅当信道翻转了比特：\n$$\nP(\\hat{X} \\neq X \\mid X=0) = P(Y=1 \\mid X=0)=p, \\quad P(\\hat{X} \\neq X \\mid X=1) = P(Y=0 \\mid X=1)=p.\n$$\n因此，\n$$\nP_{e} = P(X=0)\\,p + P(X=1)\\,p = p\\big(P(X=0)+P(X=1)\\big) = p = 0.1.\n$$\n等价地，使用 $P_{e} = 1 - \\sum_{y} \\max_{x} P(X=x, Y=y)$，\n$$\n\\sum_{y} \\max_{x} P(X=x, Y=y) = (1-p)P(X=0) + (1-p)P(X=1) = (1-p),\n$$\n所以 $P_{e} = 1 - (1-p) = p = 0.1$，证实了该结果。\n\n因此，正确的选项是准则 $(0,1)$ 且 $P_{e}=0.10$。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "在掌握了基础之后，让我们来处理一个更复杂的场景。本练习将问题从二进制信源扩展到三元信源，并且信道模型也变得更加贴近实际：编码后的不同比特位经历着各自独立的、具有不同错误率的信道。这个练习的核心挑战在于，当接收到的序列并非任何一个有效码字时，你将学会如何运用MAP准则，通过结合先验概率和各个比特的独立似然度，来找出最可能的原始信息，这充分展示了MAP译码在处理现实世界中不完美信号时的强大能力 。",
            "id": "1639840",
            "problem": "一个专门的数据存储系统处理三种类型的数据包，分别标记为 A、B 和 C。遇到每种数据包类型的先验概率由 $P(X=A) = \\frac{1}{2}$、$P(X=B) = \\frac{1}{3}$ 和 $P(X=C) = \\frac{1}{6}$ 给出，其中 $X$ 是表示数据包类型的随机变量。在存储之前，每个数据包被编码成一个 2 比特的码字，规则如下：\n- 数据包 A 被编码为 `00`。\n- 数据包 B 被编码为 `01`。\n- 数据包 C 被编码为 `11`。\n\n码字的两个比特被存储在两个独立的、分离的内存模块中。第一个比特存储在模块 1 中，第二个比特存储在模块 2 中。两个模块都会发生比特翻转错误，并且可以被建模为通信信道。模块 1 的行为像一个二进制对称信道 (BSC)，其交叉概率（比特翻转的概率）为 $p_1 = 0.1$。模块 2 不太可靠，并被建模为一个 BSC，其交叉概率为 $p_2 = 0.2$。\n\n假设在检索时，从内存模块中读出的 2 比特序列为 $Y = `10`$。根据这个观测结果，哪种原始数据包类型最有可能被存储？您的任务是确定原始数据包 $X$ 的最大后验 (MAP) 估计。\n\n以下哪一项代表了原始数据包的 MAP 估计？\n\nA. A\n\nB. B\n\nC. C\n\nD. B 和 C 等可能，且比 A 的可能性更大。\n\nE. 从给定信息中无法确定。",
            "solution": "我们要求解最大后验 (MAP) 估计，其定义为\n$$\n\\hat{x}_{\\text{MAP}}=\\arg\\max_{x\\in\\{A,B,C\\}} P(X=x\\mid Y=10),\n$$\n这等价于最大化后验概率，而后验概率与先验概率乘以似然函数的乘积成正比：\n$$\nP(X=x\\mid Y=10)\\propto P(Y=10\\mid X=x)P(X=x).\n$$\n编码是确定性的：$A\\mapsto 00$，$B\\mapsto 01$，$C\\mapsto 11$。两个内存模块是独立的二进制对称信道，第一个比特的交叉概率为 $p_{1}$，第二个比特的交叉概率为 $p_{2}$。对于一个 BSC，不发生翻转的概率是 $1-p$，发生翻转的概率是 $p$。由于模块对两个比特的作用是独立的，似然函数可以分解为\n$$\nP(Y=10\\mid X=x)=P(Y_{1}=1\\mid \\text{bit}_{1}(x))\\cdot P(Y_{2}=0\\mid \\text{bit}_{2}(x)).\n$$\n计算每种情况的似然函数：\n- 对于 $X=A$ (码字`00`)：第一个比特翻转 ($0\\to 1$) 的概率为 $p_{1}$，第二个比特不翻转 ($0\\to 0$) 的概率为 $1-p_{2}$，因此\n$$\nP(Y=10\\mid X=A)=p_{1}(1-p_{2}).\n$$\n- 对于 $X=B$ (码字`01`)：第一个比特翻转 ($0\\to 1$) 的概率为 $p_{1}$，第二个比特翻转 ($1\\to 0$) 的概率为 $p_{2}$，因此\n$$\nP(Y=10\\mid X=B)=p_{1}p_{2}.\n$$\n- 对于 $X=C$ (码字`11`)：第一个比特不翻转 ($1\\to 1$) 的概率为 $1-p_{1}$，第二个比特翻转 ($1\\to 0$) 的概率为 $p_{2}$，因此\n$$\nP(Y=10\\mid X=C)=(1-p_{1})p_{2}.\n$$\n乘以先验概率得到未归一化的后验概率：\n$$\nS_{A}=P(X=A)P(Y=10\\mid X=A)=\\frac{1}{2}\\,p_{1}(1-p_{2}),\n$$\n$$\nS_{B}=P(X=B)P(Y=10\\mid X=B)=\\frac{1}{3}\\,p_{1}p_{2},\n$$\n$$\nS_{C}=P(X=C)P(Y=10\\mid X=C)=\\frac{1}{6}\\,(1-p_{1})p_{2}.\n$$\n代入 $p_{1}=\\frac{1}{10}$ 和 $p_{2}=\\frac{1}{5}$：\n$$\nS_{A}=\\frac{1}{2}\\cdot \\frac{1}{10}\\cdot \\left(1-\\frac{1}{5}\\right)=\\frac{1}{2}\\cdot \\frac{1}{10}\\cdot \\frac{4}{5}=\\frac{1}{25},\n$$\n$$\nS_{B}=\\frac{1}{3}\\cdot \\frac{1}{10}\\cdot \\frac{1}{5}=\\frac{1}{150},\n$$\n$$\nS_{C}=\\frac{1}{6}\\cdot \\left(1-\\frac{1}{10}\\right)\\cdot \\frac{1}{5}=\\frac{1}{6}\\cdot \\frac{9}{10}\\cdot \\frac{1}{5}=\\frac{3}{100}.\n$$\n比较：\n$$\n\\frac{1}{25}>\\frac{3}{100}>\\frac{1}{150}.\n$$\n因此，MAP 估计为 $X=A$，对应于选项 A。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "现实世界中的许多数据，如文本、语音或时间序列信号，都不是独立同分布的，而是具有内在的关联性。这个高级练习引入了一个具有“记忆”的信源，即一阶马尔可夫链，来模拟这种依赖关系。你的任务是执行序贯MAP估计，即根据截至当前时刻的所有观测值，递归地更新对当前信源符号的后验概率。这个过程是隐马尔可夫模型（HMMs）和维特比算法等高级技术的基础，通过这个练习，你将对动态系统中的最优估计问题建立起初步但坚实的直觉 。",
            "id": "1639803",
            "problem": "考虑一个数据存储系统的简化模型，其中二进制比特由随机变量序列 $\\{X_k\\}_{k=1,2,3,...}$（$X_k \\in \\{0, 1\\}$）表示，并按顺序存储。由于相邻存储单元之间的物理相互作用，该系统表现为一阶二进制马尔可夫源。对于 $k \\ge 2$，转移概率由 $P(X_k = 1 | X_{k-1} = 0) = 0.2$ 和 $P(X_k = 0 | X_{k-1} = 1) = 0.3$ 给出。对于第一个比特，概率是相等的，即 $P(X_1=0) = P(X_1=1) = 0.5$。\n\n当读取数据时，该过程会受到噪声的干扰，这被建模为一个无记忆的二进制对称信道 (BSC)。BSC 的交叉概率为 $\\epsilon = 0.1$，意味着在读出过程中比特被翻转的概率是 $0.1$。令 $\\{Y_k\\}_{k=1,2,3,...}$ 为从存储系统中读出的比特序列。\n\n一个操作员从设备中读出前三个比特，并获得序列 $Y_1=1, Y_2=0, Y_3=1$。为了执行逐比特最优的最大后验概率 (MAP) 决策，操作员需要计算每个传输比特在给定截至该点的观测序列下的后验概率。\n\n计算后验概率 $P(X_3=1 | Y_1=1, Y_2=0, Y_3=1)$。将您的最终答案四舍五入到四位有效数字。",
            "solution": "我们将隐藏比特建模为一阶二进制马尔可夫链，其转移概率为\n$$\nP(X_{k}=1\\mid X_{k-1}=0)=0.2,\\quad P(X_{k}=0\\mid X_{k-1}=1)=0.3,\n$$\n所以\n$$\nP(X_{k}=0\\mid X_{k-1}=0)=0.8,\\quad P(X_{k}=1\\mid X_{k-1}=1)=0.7,\n$$\n初始分布为\n$$\nP(X_{1}=0)=P(X_{1}=1)=\\frac{1}{2}.\n$$\n观测值通过一个交叉概率为 $\\epsilon=0.1$ 的无记忆二进制对称信道得到，因此对于每个 $k$，\n$$\nP(Y_{k}=y\\mid X_{k}=x)=\\begin{cases}\n0.9,& y=x,\\\\\n0.1,& y\\neq x.\n\\end{cases}\n$$\n定义前向变量 $\\alpha_{k}(x)=P(X_{k}=x,Y_{1}=y_{1},\\ldots,Y_{k}=y_{k})$。则\n$$\n\\alpha_{1}(x_{1})=P(Y_{1}=y_{1}\\mid X_{1}=x_{1})P(X_{1}=x_{1}),\n$$\n对于 $k\\geq 2$，\n$$\n\\alpha_{k}(x_{k})=P(Y_{k}=y_{k}\\mid X_{k}=x_{k})\\sum_{x_{k-1}\\in\\{0,1\\}}P(X_{k}=x_{k}\\mid X_{k-1}=x_{k-1})\\,\\alpha_{k-1}(x_{k-1}).\n$$\n\n给定 $y_{1}=1$，我们有\n$$\n\\alpha_{1}(1)=0.9\\cdot\\frac{1}{2}=\\frac{9}{20},\\qquad \\alpha_{1}(0)=0.1\\cdot\\frac{1}{2}=\\frac{1}{20}.\n$$\n\n给定 $y_{2}=0$，计算到时间 $2$ 的预测：\n$$\n\\sum_{x_{1}}P(X_{2}=0\\mid X_{1}=x_{1})\\alpha_{1}(x_{1})=0.8\\cdot\\frac{1}{20}+0.3\\cdot\\frac{9}{20}=\\frac{7}{40},\n$$\n$$\n\\sum_{x_{1}}P(X_{2}=1\\mid X_{1}=x_{1})\\alpha_{1}(x_{1})=0.2\\cdot\\frac{1}{20}+0.7\\cdot\\frac{9}{20}=\\frac{13}{40}.\n$$\n然后\n$$\n\\alpha_{2}(0)=0.9\\cdot\\frac{7}{40}=\\frac{63}{400},\\qquad \\alpha_{2}(1)=0.1\\cdot\\frac{13}{40}=\\frac{13}{400}.\n$$\n\n给定 $y_{3}=1$，计算到时间 $3$ 的预测：\n$$\n\\sum_{x_{2}}P(X_{3}=0\\mid X_{2}=x_{2})\\alpha_{2}(x_{2})=0.8\\cdot\\frac{63}{400}+0.3\\cdot\\frac{13}{400}=\\frac{543}{4000},\n$$\n$$\n\\sum_{x_{2}}P(X_{3}=1\\mid X_{2}=x_{2})\\alpha_{2}(x_{2})=0.2\\cdot\\frac{63}{400}+0.7\\cdot\\frac{13}{400}=\\frac{217}{4000}.\n$$\n因此\n$$\n\\alpha_{3}(1)=0.9\\cdot\\frac{217}{4000}=\\frac{1953}{40000},\\qquad \\alpha_{3}(0)=0.1\\cdot\\frac{543}{4000}=\\frac{543}{40000}.\n$$\n\n所求的后验概率为\n$$\nP(X_{3}=1\\mid Y_{1}=1,Y_{2}=0,Y_{3}=1)=\\frac{\\alpha_{3}(1)}{\\alpha_{3}(0)+\\alpha_{3}(1)}=\\frac{1953/40000}{(1953+543)/40000}=\\frac{1953}{2496}=\\frac{651}{832}.\n$$\n数值上，\n$$\n\\frac{651}{832}\\approx 0.782451923\\ldots,\n$$\n四舍五入到四位有效数字是 $0.7825$。",
            "answer": "$$\\boxed{0.7825}$$"
        }
    ]
}