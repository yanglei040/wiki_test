{
    "hands_on_practices": [
        {
            "introduction": "本练习旨在帮助你将完美保密的数学定义直接应用于一个具体的密码系统。通过计算后验概率 $P(M=m|C=c)$ 并将其与先验概率 $P(M=m)$ 进行比较，你将亲手验证一个系统是否满足香农(Shannon)的严格标准。这项实践强调了，如果观察到某个密文能够为我们提供任何关于明文的额外信息，那么该系统的保密性就会被攻破。",
            "id": "1657890",
            "problem": "一个极简的安全消息系统被设计用于传输两个关键命令之一：'HOLD' 或 'PROCEED'。该系统的规格如下：\n\n- 消息空间为 $\\mathcal{M} = \\{m_0, m_1\\}$，其中 $m_0$ 代表 'HOLD'，$m_1$ 代表 'PROCEED'。\n- 由于操作环境的原因，发送 'HOLD' 的先验概率为 $P(M=m_0) = \\frac{1}{3}$，发送 'PROCEED' 的概率为 $P(M=m_1) = \\frac{2}{3}$。\n- 密钥空间为 $\\mathcal{K} = \\{k_A, k_B\\}$。每次传输都会均匀随机地选择一个密钥，即 $P(K=k_A) = P(K=k_B) = \\frac{1}{2}$。密钥的选择与消息的选择是独立的。\n- 密文根据以下加密表生成，其中行代表密钥，列代表明文消息，单元格包含来自空间 $\\mathcal{C} = \\{c_X, c_Y, c_Z\\}$ 的结果密文。\n\n| $E(k,m)$      | $m_0$ ('HOLD') | $m_1$ ('PROCEED') |\n| :-----------: | :------------: | :---------------: |\n| $\\mathbf{k_A}$| $c_X$          | $c_Y$             |\n| $\\mathbf{k_B}$| $c_Y$          | $c_Z$             |\n\n如果观察到密文没有提供关于明文消息的任何信息，则称该加密系统具有完美保密性。在数学上，这当且仅当对于所有消息 $m \\in \\mathcal{M}$ 和所有满足 $P(C=c)  0$ 的密文 $c \\in \\mathcal{C}$，都有 $P(M=m | C=c) = P(M=m)$。\n\n根据这个定义，对于所描述的系统，以下哪个陈述是正确的？\n\nA. 是的，该系统具有完美保密性，因为密钥的数量等于消息的数量。\n\nB. 是的，该系统具有完美保密性，因为对于每个消息，都有多种可能的密文。\n\nC. 不，该系统不具有完美保密性，因为观察到密文 $c_X$ 会泄露明文消息。\n\nD. 不，该系统不具有完美保密性，因为消息的概率不是均匀的。",
            "solution": "我们使用完美保密性的定义：对于所有满足 $P(C=c)0$ 的密文 $c$ 和所有消息 $m$，完美保密性要求 $P(M=m \\mid C=c)=P(M=m)$。\n\n在 $M$ 和 $K$ 独立以及确定性加密 $C=E(K,M)$ 的条件下，我们通过对 $K$ 进行平均来计算 $P(C=c \\mid M=m)$：\n$$\nP(C=c \\mid M=m)=\\sum_{k \\in \\mathcal{K}} P(C=c \\mid M=m,K=k) P(K=k),\n$$\n其中，如果 $E(k,m)=c$，则 $P(C=c \\mid M=m,K=k)=1$，否则为 $0$。\n\n从表中可知：\n- 对于 $c_{X}$：$E(k_{A},m_{0})=c_{X}$，没有其他组合会产生 $c_{X}$。\n- 对于 $c_{Y}$：$E(k_{A},m_{1})=c_{Y}$ 且 $E(k_{B},m_{0})=c_{Y}$。\n- 对于 $c_{Z}$：$E(k_{B},m_{1})=c_{Z}$，没有其他组合会产生 $c_{Z}$。\n\n计算 $c_{X}$ 的情况：\n- $P(C=c_{X} \\mid M=m_{0})=P(K=k_{A})=\\frac{1}{2}$，且 $P(C=c_{X} \\mid M=m_{1})=0$。\n- 根据全概率定律，\n$$\nP(C=c_{X})=\\sum_{m \\in \\mathcal{M}} P(C=c_{X} \\mid M=m) P(M=m)=\\frac{1}{2}\\cdot \\frac{1}{3}+0 \\cdot \\frac{2}{3}=\\frac{1}{6}.\n$$\n- 根据贝叶斯法则，\n$$\nP(M=m_{0} \\mid C=c_{X})=\\frac{P(C=c_{X} \\mid M=m_{0})P(M=m_{0})}{P(C=c_{X})}=\\frac{\\frac{1}{2}\\cdot \\frac{1}{3}}{\\frac{1}{6}}=1,\n$$\n$$\nP(M=m_{1} \\mid C=c_{X})=\\frac{P(C=c_{X} \\mid M=m_{1})P(M=m_{1})}{P(C=c_{X})}=0.\n$$\n由于 $P(M=m_{0})=\\frac{1}{3} \\neq 1$ 且 $P(M=m_{1})=\\frac{2}{3} \\neq 0$，我们有 $P(M=m \\mid C=c_{X}) \\neq P(M=m)$。因此，该系统不具有完美保密性。\n\n为完整起见，类似地，$c_{Z}$ 会揭示 $m_{1}$，后验概率为 $1$，而 $c_{Y}$ 产生的后验概率等于先验概率。然而，完美保密性要求等式对所有具有正概率的密文都成立；$c_{X}$ 的情况不成立就足以得出该系统不具有完美保密性的结论。\n\n因此，正确的陈述是观察到密文 $c_{X}$ 会泄露明文消息。",
            "answer": "$$\\boxed{C}$$"
        },
        {
            "introduction": "这项练习将我们的关注点从“验证”一个给定的系统转向“设计”一个安全的系统。我们以经典的凯撒密码为例，探讨实现完美保密性的一个基本条件：密钥的概率分布必须满足什么特性。通过这个练习，你将揭示香农的一个核心洞见：为了隐藏明文本身可能存在的非均匀分布，密钥的选择必须是完全随机和均匀的，且密钥空间要足够大。",
            "id": "1657898",
            "problem": "在一个密码学场景中，一个通信系统使用简单的凯撒密码来加密消息。明文、密文和密钥的字母表是整数集合 $\\mathcal{S} = \\{0, 1, \\dots, 25\\}$，这对应于26个英文字母。使用密钥 $k \\in \\mathcal{S}$ 对明文符号 $m \\in \\mathcal{S}$ 进行加密，产生密文符号 $c$ 的规则是 $c = (m + k) \\pmod{26}$。\n\n已知明文消息的来源具有非均匀的概率分布。任何给定明文符号 $m$ 出现的概率为 $P(M=m) = p_m$，其中已知对于所有 $m \\in \\mathcal{S}$ 都有 $p_m  0$ 且 $\\sum_{m=0}^{25} p_m = 1$。\n\n为了使密码安全，目标是实现完美保密。如果观察密文不能提供任何关于明文的信息，则称该密码系统具有完美保密性。这被形式化地定义为：对于任何明文符号 $m$ 和任何密文符号 $c$，在给定密文为 $c$ 的条件下明文为 $m$ 的条件概率等于明文为 $m$ 的先验概率。即，$P(M=m|C=c) = P(M=m)$。\n\n为实现这一点，必须根据一个特定的概率分布 $P(K=k)$ 从 $\\mathcal{S}$ 中随机选择密钥 $k$。确定对于任何密钥 $k \\in \\mathcal{S}$ 所需的概率 $P(K=k)$。将你的答案表示为一个单独的数值分数。",
            "solution": "设明文、密钥和密文字母表为 $\\mathcal{S}=\\{0,1,\\dots,25\\}$，加密方式为 $c=(m+k)\\bmod 26$。完美保密性要求对于所有的 $m,c$ 都有 $P(M=m\\mid C=c)=P(M=m)$。根据贝叶斯法则，\n$$\nP(M=m\\mid C=c)=\\frac{P(C=c\\mid M=m)P(M=m)}{P(C=c)}.\n$$\n因此，对于所有 $P(M=m)0$ 的 $m$，完美保密性意味着\n$$\nP(C=c\\mid M=m)=P(C=c)\\quad\\text{对于所有 }m,c.\n$$\n给定 $M=m$，当且仅当 $K=(c-m)\\bmod 26$ 时，密文 $C$ 等于 $c$，所以\n$$\nP(C=c\\mid M=m)=P\\bigl(K=(c-m)\\bmod 26\\bigr).\n$$\n因此，完美保密条件变为\n$$\nP\\bigl(K=(c-m)\\bmod 26\\bigr)=P(C=c)\\quad\\text{对于所有 }m,c.\n$$\n固定任意 $c$ 并取两个明文 $m$ 和 $m'$；则\n$$\nP\\bigl(K=(c-m)\\bmod 26\\bigr)=P\\bigl(K=(c-m')\\bmod 26\\bigr).\n$$\n因为对于固定的 $c$，集合 $\\{(c-m)\\bmod 26:m\\in\\mathcal{S}\\}$ 等于整个 $\\mathcal{S}$，所以对于所有 $k\\in\\mathcal{S}$，$P(K=k)$ 是同一个常数。设这个常数为 $q$。使用 $\\sum_{k=0}^{25}P(K=k)=1$ 可得 $26q=1$，因此 $q=\\frac{1}{26}$。所以\n$$\nP(K=k)=\\frac{1}{26}\\quad\\text{对于所有 }k\\in\\mathcal{S}.\n$$\n这个选择也得出对于所有 $m,c$ 都有 $P(C=c\\mid M=m)=\\frac{1}{26}$，所以 $P(M=m\\mid C=c)=P(M=m)$，对于任何 $p_m0$ 的 $\\{p_m\\}$ 都能实现完美保密。",
            "answer": "$$\\boxed{\\frac{1}{26}}$$"
        },
        {
            "introduction": "完美的保密性是极其脆弱的。本练习通过一个警示性的案例，展示了对一个理论上安全的系统（一次性密码本）进行微小改动可能带来的灾难性后果。你将分析一个引入了特殊加密规则的系统，并发现这个看似无害的例外情况是如何完全破坏其保密性的。这个思想实验强调了在密码学设计中遵循严格原则的重要性。",
            "id": "1657844",
            "problem": "为设计一个安全的通信信道，一位工程师提出了一种新的加密方案，用于加密固定长度为 $L$ 的消息。消息空间 $\\mathcal{M}$、密钥空间 $\\mathcal{K}$ 和密文空间 $\\mathcal{C}$ 都是长度为 $L$ 的二进制字符串集合，即 $\\{0,1\\}^L$。\n\n密钥 $K$ 总是从 $\\mathcal{K}$ 中均匀随机选择，并且与消息 $M$ 统计独立。消息的分布满足：发送全零消息 $m_0 = (0, 0, \\dots, 0)$ 的概率不为零，即 $P(M=m_0)  0$，同时也小于 1，即 $P(M=m_0)  1$。\n\n所提出的加密规则是标准一次性密码本的修改版：\n1. 如果消息 $M$ 是全零字符串 $m_0$，则无论选择的密钥 $K$ 是什么，生成的密文 $C$ 也是全零字符串 $m_0$。\n2. 对于任何其他消息 $M \\neq m_0$，密文计算为 $C = M \\oplus K$，其中 $\\oplus$ 表示按位异或操作。\n\n该加密系统是否提供完全保密性？\n\nA. 是的，该系统在所有条件下都提供完全保密性。\n\nB. 不，该系统不提供完全保密性。\n\nC. 当且仅当消息在所有非零消息上均匀分布时，该系统才提供完全保密性。\n\nD. 在不知道 $P(M=m_0)$ 的确切值的情况下，无法确定该系统的安全性。",
            "solution": "令 $\\mathcal{M}=\\mathcal{K}=\\mathcal{C}=\\{0,1\\}^{L}$，并令 $m_{0}$ 表示全零字符串。令 $p_{0}=P(M=m_{0})$，其中 $0p_{0}1$。密钥 $K$ 在 $\\mathcal{K}$ 上均匀分布，因此对于任何 $k \\in \\mathcal{K}$，$P(K=k)=1/|\\mathcal{K}|=1/2^{L}$。\n\n如果系统提供完美保密性，那么对于任何 $m \\in \\mathcal{M}$ 和 $c \\in \\mathcal{C}$，必须有 $P(M=m \\mid C=c)=P(M=m)$。\n\n让我们考虑当观察到密文是全零字符串 $c=m_0$ 时会发生什么。我们计算 $P(M=m_{0} \\mid C=m_{0})$。根据贝叶斯定理，\n$$\nP(M=m_{0} \\mid C=m_{0}) = \\frac{P(C=m_{0} \\mid M=m_{0})P(M=m_{0})}{P(C=m_{0})}.\n$$\n首先，我们计算 $P(C=m_{0})$。根据全概率定律，\n$$\nP(C=m_{0}) = P(C=m_{0} \\mid M=m_{0})P(M=m_{0}) + P(C=m_{0} \\mid M \\neq m_{0})P(M \\neq m_{0}).\n$$\n根据加密规则：\n- 如果 $M=m_0$，则 $C$ 总是 $m_0$，因此 $P(C=m_0 \\mid M=m_0)=1$。\n- 如果 $M=m \\neq m_0$，则 $C=m \\oplus K$。要使 $C=m_0$，我们必须有 $m \\oplus K = m_0$，这意味着 $K=m$。由于密钥是均匀分布的，因此这种情况发生的概率是 $P(K=m)=1/2^L$。因此，$P(C=m_0 \\mid M=m)=1/2^L$ 对于任何 $m \\neq m_0$。\n\n我们可以将 $P(C=m_0 \\mid M \\neq m_0)$ 写成\n$$\nP(C=m_0 \\mid M \\neq m_0) = \\sum_{m \\neq m_0} P(C=m_0 \\mid M=m)P(M=m \\mid M \\neq m_0) = \\frac{1}{2^L}.\n$$\n因此，\n$$\nP(C=m_0) = 1 \\cdot p_0 + \\frac{1}{2^L} (1-p_0).\n$$\n现在，我们可以计算后验概率：\n$$\nP(M=m_0 \\mid C=m_0) = \\frac{1 \\cdot p_0}{p_0 + \\frac{1-p_0}{2^L}}.\n$$\n为了使系统具有完美保密性，这个后验概率必须等于先验概率 $p_0$。\n$$\n\\frac{p_0}{p_0 + \\frac{1-p_0}{2^L}} = p_0.\n$$\n由于我们知道 $p_0  0$，我们可以将两边都除以 $p_0$：\n$$\n\\frac{1}{p_0 + \\frac{1-p_0}{2^L}} = 1,\n$$\n这意味着 $p_0 + \\frac{1-p_0}{2^L} = 1$。\n假设 $L \\ge 1$，那么 $2^L > 1$。\n该方程可以重写为 $p_0 \\cdot 2^L + 1 - p_0 = 2^L$，即 $p_0(2^L-1) = 2^L-1$。\n由于 $2^L-1 \\neq 0$，我们可以得出 $p_0=1$。\n然而，问题陈述中规定 $p_0  1$。这个矛盾表明，对于 $0  p_0  1$，完美保密性的条件没有得到满足。\n\n事实上，由于 $p_0 + \\frac{1-p_0}{2^L}  p_0 + (1-p_0) = 1$（只要 $L \\ge 1$ 且 $p_0  1$），我们有 $\\frac{p_0}{p_0 + \\frac{1-p_0}{2^L}} > p_0$。这意味着观察到全零密文会增加我们对明文是全零的信心，从而泄露了信息。\n\n因此，该系统不提供完美保密性。",
            "answer": "$$\\boxed{B}$$"
        }
    ]
}