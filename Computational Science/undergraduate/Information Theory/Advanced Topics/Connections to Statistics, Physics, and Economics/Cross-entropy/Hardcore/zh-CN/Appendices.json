{
    "hands_on_practices": [
        {
            "introduction": "这个首次实践提供了一个计算交叉熵的基础练习。我们将一个已知的真实分布（相当于一枚均匀的硬币）与一个简单的、有偏差的预测模型进行比较。这个练习  有助于巩固对交叉熵公式的理解，并将其值解释为当使用一个次优模型来编码来自真实分布的信息时，所产生的额外“成本”或低效率的度量。",
            "id": "1615167",
            "problem": "一位数据科学家正在评估一个用于二元随机过程的预测模型。已知其真实的潜在过程是完全随机的，等同于抛掷一枚均匀的硬币，其结果集为 {结果 A, 结果 B}。设这个真实概率分布用 $P$ 表示。\n\n然而，这个预测模型产生了偏差。它根据一个不同的概率分布来预测结果，该分布用 $Q$ 表示。该模型将 0.9 的概率分配给‘结果 A’，将 0.1 的概率分配给‘结果 B’。\n\n计算真实分布 $P$ 和模型分布 $Q$ 之间的交叉熵 $H(P, Q)$。答案以比特为单位，并四舍五入到四位有效数字。",
            "solution": "题目要求我们计算一个均匀二元过程的真实分布 $P$ 与模型分布 $Q$（其中 $Q(\\text{A})=0.9$ 且 $Q(\\text{B})=0.1$）之间的交叉熵（以比特为单位）。\n\n根据定义，对于结果为 $x$ 的离散分布，其真实概率为 $P(x)$，模型概率为 $Q(x)$，则交叉熵（以比特为单位）为\n$$\nH(P,Q) \\equiv - \\sum_{x} P(x)\\,\\log_{2}\\big(Q(x)\\big).\n$$\n对于一个均匀过程，有 $P(\\text{A})=\\frac{1}{2}$ 和 $P(\\text{B})=\\frac{1}{2}$。因此，\n$$\nH(P,Q) = -\\left[\\frac{1}{2}\\log_{2}(0.9) + \\frac{1}{2}\\log_{2}(0.1)\\right]\n= -\\frac{1}{2}\\left[\\log_{2}(0.9)+\\log_{2}(0.1)\\right]\n= -\\frac{1}{2}\\log_{2}\\big(0.9\\times 0.1\\big)\n= -\\frac{1}{2}\\log_{2}(0.09).\n$$\n进行数值计算（以比特为单位），\n$$\n\\log_{2}(0.9) \\approx -0.152003093445049,\\quad \\log_{2}(0.1) \\approx -3.321928094887362,\n$$\n所以\n$$\nH(P,Q) \\approx -\\frac{1}{2}\\big(-0.152003093445049-3.321928094887362\\big)\n= -\\frac{1}{2}\\big(-3.473931188332411\\big)\n= 1.736965594166206.\n$$\n四舍五入到四位有效数字，得到 $1.737$ 比特。",
            "answer": "$$\\boxed{1.737}$$"
        },
        {
            "introduction": "在基础计算之上，这个实践探讨了一个关键的边界情况。我们将分析一个确定性模型，它对某些可能发生的事件赋予了零概率。这个场景  揭示了交叉熵的一个重要特性：它会严厉惩罚那些过于自信且完全错误的预测，导致交叉熵的值变为无穷大，这突显了在预测建模中避免赋予零概率给任何可能事件的重要性。",
            "id": "1615201",
            "problem": "一位数据科学家正在评估两个用于预测特定城市天气的计算模型。可能的天气结果集合为{晴天, 多云, 雨天}。基于大量的历史数据，这些结果的真实概率分布 $P$ 是已知的：\n- $P(\\text{晴天}) = 0.5$\n- $P(\\text{多云}) = 0.3$\n- $P(\\text{雨天}) = 0.2$\n\n第一个模型，Model A，是一个概率性预测器，它为第二天的天气提供了自己的概率分布 $Q_A$：\n- $Q_A(\\text{晴天}) = 0.7$\n- $Q_A(\\text{多云}) = 0.2$\n- $Q_A(\\text{雨天}) = 0.1$\n\n第二个模型，Model B，是一个简单的确定性模型，它总是预测“晴天”。因此，其预测的概率分布 $Q_B$ 为：\n- $Q_B(\\text{晴天}) = 1$\n- $Q_B(\\text{多云}) = 0$\n- $Q_B(\\text{雨天}) = 0$\n\n为了评估每个模型的预测与真实分布的吻合程度，该数据科学家计算了以比特为单位的交叉熵 $H(P, Q)$。交叉熵的公式为 $H(P, Q) = -\\sum_{x} P(x) \\log_2(Q(x))$，其中总和是对所有可能的结果 $x$ 进行的。\n\n确定 Model A 相对于真实分布的交叉熵 $H(P, Q_A)$，以及 Model B 相对于真实分布的交叉熵 $H(P, Q_B)$。选择正确报告了这两个值的选项。\n\nA. $H(P, Q_A) = 1.485$；$H(P, Q_B) = 0$\n\nB. $H(P, Q_A) = 1.122$；$H(P, Q_B)$ 未定义\n\nC. $H(P, Q_A) = 1.618$；$H(P, Q_B)$ 为无穷大\n\nD. $H(P, Q_A) = 1.618$；$H(P, Q_B) = 0$\n\nE. $H(P, Q_A) = 1.280$；$H(P, Q_B)$ 为无穷大",
            "solution": "我们使用以比特为单位的交叉熵定义：\n$$H(P,Q)=-\\sum_{x}P(x)\\log_{2}\\bigl(Q(x)\\bigr).$$\n\n对于 Model A，\n$$H(P,Q_{A})=-\\Bigl[0.5\\,\\log_{2}(0.7)+0.3\\,\\log_{2}(0.2)+0.2\\,\\log_{2}(0.1)\\Bigr].$$\n使用换底公式 $\\log_{2}(x)=\\frac{\\ln x}{\\ln 2}$ 来获取数值：\n$$\\log_{2}(0.7)\\approx-0.5145731728,\\quad \\log_{2}(0.2)=-2.3219280949,\\quad \\log_{2}(0.1)=-3.3219280949.$$\n因此，\n$$0.5\\,\\log_{2}(0.7)\\approx-0.2572865864,\\quad 0.3\\,\\log_{2}(0.2)\\approx-0.6965784285,\\quad 0.2\\,\\log_{2}(0.1)\\approx-0.6643856190,$$\n所以括号内的和约等于 $-1.6182506339$，因此\n$$H(P,Q_{A})\\approx 1.6182506339\\ \\text{bits}\\approx 1.618.$$\n\n对于 Model B，\n$$H(P,Q_{B})=-\\Bigl[0.5\\,\\log_{2}(1)+0.3\\,\\log_{2}(0)+0.2\\,\\log_{2}(0)\\Bigr].$$\n由于 $\\log_{2}(1)=0$ 且 $\\log_{2}(0)=-\\infty$，并且权重 $0.3$ 和 $0.2$ 为正，交叉熵发散：\n$$H(P,Q_{B})=+\\infty.$$\n\n因此，正确的选项是报告 $H(P,Q_{A})=1.618$ 且 $H(P,Q_{B})$ 为无穷大的选项，即选项C。",
            "answer": "$$\\boxed{C}$$"
        },
        {
            "introduction": "最后的这个实践展示了交叉熵在机器学习中最强大的应用：作为模型优化的损失函数。我们将处理一个依赖于可调参数 $\\theta$ 的模型，并运用微积分知识来寻找能使模型分布与真实分布之间交叉熵最小化的最优参数值。这个练习  直接阐释了在实践中如何通过最小化交叉熵来“训练”一个模型，使其尽可能地逼近现实世界的数据生成过程。",
            "id": "1615207",
            "problem": "在高能物理领域，机器学习模型常被用来对探测器记录的事件进行分类。考虑一个简化情景，其中粒子对撞机实验产生的事件属于三个不同类别之一：类别1、类别2或类别3。根据一个成熟的理论框架，一个事件属于各个类别的真实概率分布 $P$ 由 $P = (p_1, p_2, p_3) = (1/2, 1/3, 1/6)$ 给出。\n\n一位数据科学家提出了一个新的、计算成本低的模型 $Q_\\theta$ 来近似这个真实分布。该模型的概率依赖于单个可调参数 $\\theta$，并由 $Q_\\theta = (q_1(\\theta), q_2(\\theta), q_3(\\theta)) = (\\theta, 1 - 2\\theta, \\theta)$ 给出。为使 $Q_\\theta$ 表示一个有效的概率分布，参数 $\\theta$ 必须在范围 $[0, 1/2]$ 内。\n\n为了找到该模型的最佳版本，该科学家决定通过最小化真实分布 $P$ 与模型分布 $Q_\\theta$ 之间的交叉熵 $H(P, Q_\\theta)$ 来调整 $\\theta$。交叉熵是衡量在使用为分布 $Q_\\theta$ 优化的编码方案时，对来自 $P$ 的事件进行编码所需的平均比特数。\n\n确定能使交叉熵 $H(P, Q_\\theta)$ 最小化的参数 $\\theta$ 的精确值。请用分数表示你的答案。",
            "solution": "以比特为单位的交叉熵定义为\n$$H_{2}(P,Q_{\\theta})=-\\sum_{i=1}^{3}p_{i}\\log_{2}q_{i}.$$\n由于 $\\log_{2}x=\\ln x/\\ln 2$，最小化关于 $\\theta$ 的 $H_{2}(P,Q_{\\theta})$ 等价于最小化\n$$F(\\theta)=-\\sum_{i=1}^{3}p_{i}\\ln q_{i}.$$\n已知 $P=(\\frac{1}{2},\\frac{1}{3},\\frac{1}{6})$ 且对于 $\\theta\\in[0,\\frac{1}{2}]$ 有 $Q_{\\theta}=(\\theta,1-2\\theta,\\theta)$，我们得到\n$$F(\\theta)=-\\left(\\frac{1}{2}\\ln\\theta+\\frac{1}{3}\\ln(1-2\\theta)+\\frac{1}{6}\\ln\\theta\\right)=-\\left(\\frac{2}{3}\\ln\\theta+\\frac{1}{3}\\ln(1-2\\theta)\\right).$$\n在开区间 $(0,\\frac{1}{2})$ 上求导：\n$$F'(\\theta)=-\\left(\\frac{2}{3}\\frac{1}{\\theta}+\\frac{1}{3}\\cdot\\frac{-2}{1-2\\theta}\\right)=-\\frac{2}{3}\\left(\\frac{1}{\\theta}-\\frac{1}{1-2\\theta}\\right).$$\n令 $F'(\\theta)=0$ 以寻找驻点：\n$$\\frac{1}{\\theta}-\\frac{1}{1-2\\theta}=0\\;\\;\\Longrightarrow\\;\\;\\frac{1}{\\theta}=\\frac{1}{1-2\\theta}\\;\\;\\Longrightarrow\\;\\;1-2\\theta=\\theta\\;\\;\\Longrightarrow\\;\\;\\theta=\\frac{1}{3}.$$\n计算二阶导数以确认是最小值点：\n$$F''(\\theta)=-\\frac{2}{3}\\left(-\\frac{1}{\\theta^{2}}-\\frac{2}{(1-2\\theta)^{2}}\\right)=\\frac{2}{3}\\left(\\frac{1}{\\theta^{2}}+\\frac{2}{(1-2\\theta)^{2}}\\right)>0,$$\n因此 $F$ 在 $(0,\\frac{1}{2})$ 上是严格凸的，该驻点是唯一的全局最小值点。端点 $\\theta=0$ 和 $\\theta=\\frac{1}{2}$ 对于最小化是无效的，因为当 $\\theta\\to 0^{+}$ 或 $\\theta\\to(\\frac{1}{2})^{-}$ 时，由于 $\\ln 0$ 的存在，$F(\\theta)\\to+\\infty$。因此，在 $[0,\\frac{1}{2}]$ 内的最小值点是\n$$\\theta^{\\ast}=\\frac{1}{3}.$$",
            "answer": "$$\\boxed{\\frac{1}{3}}$$"
        }
    ]
}