{
    "hands_on_practices": [
        {
            "introduction": "一个长序列的经验分布，或称“型”，为其统计特性提供了一个强有力的总结。本练习展示了一个基础应用：利用“型”来进行假设检验。你将建立一个决策规则，以判断两个可能的信源中哪一个更可能生成了观测到的序列，从而将抽象的“型”概念与具体的统计推断联系起来。",
            "id": "1641267",
            "problem": "一个深空探测器以来自字母表 $\\mathcal{X} = \\{0, 1\\}$ 的二进制数字序列的形式传输数据。已知该发射器工作在两种不同模式之一：模式1或模式2。在任一模式下，数字都由一个无记忆信源生成。\n\n- 在模式1中，该信源是一个伯努利过程，以概率 $p_1$ 生成“1”。\n- 在模式2中，该信源是一个伯努利过程，以概率 $p_2$ 生成“1”。\n\n已知 $0  p_2  p_1  1$。\n\n一位分析师接收到一个非常长的数字序列 $x^n = (x_1, x_2, \\dots, x_n)$，并且知道该序列完全是由这两种模式中的一种生成的。为了确定序列的来源，分析师计算其经验分布，该分布完全由 $\\hat{p}$（序列中符号“1”的观测频率）表征。\n\n判断哪个信源更可能是序列来源的决策导出了一个简单的阈值规则。存在一个临界阈值 $T$，使得如果观测频率 $\\hat{p}$ 大于 $T$，则模式1是更可能的信源；而如果 $\\hat{p}$ 小于 $T$，则模式2更可能。\n\n确定这个阈值 $T$ 作为 $p_1$ 和 $p_2$ 的函数的解析表达式。在你的最终表达式中使用自然对数。",
            "solution": "我们将此问题建模为一个二元假设检验，其假设为 $H_{1}: p = p_{1}$ 和 $H_{2}: p = p_{2}$。一个长度为 $n$、包含 $k$ 个 '1'（因此 $\\hat{p} = k/n$）的序列 $x^{n}$，在假设 $H_{i}$ 下的似然由 $L_{i} = p_{i}^{k} (1 - p_{i})^{n - k}$ 给出（$i \\in \\{1, 2\\}$）。序列在模式1下比在模式2下更可能，当且仅当 $L_{1}  L_{2}$，等价于当且仅当对数似然比为正：\n$$\n\\ln\\left(\\frac{L_{1}}{L_{2}}\\right) \\;=\\; k \\ln\\left(\\frac{p_{1}}{p_{2}}\\right) + (n - k) \\ln\\left(\\frac{1 - p_{1}}{1 - p_{2}}\\right).\n$$\n代入 $k = n \\hat{p}$ 并两边除以 $n  0$，得到不等式\n$$\n\\hat{p} \\ln\\left(\\frac{p_{1}}{p_{2}}\\right) + (1 - \\hat{p}) \\ln\\left(\\frac{1 - p_{1}}{1 - p_{2}}\\right)  0.\n$$\n该不等式对于 $\\hat{p}$ 是线性的，因此决策简化为将 $\\hat{p}$ 与一个阈值 $T$ 进行比较，该阈值可通过将左侧表达式设为零来获得：\n$$\n\\hat{p} \\ln\\left(\\frac{p_{1}}{p_{2}}\\right) + (1 - \\hat{p}) \\ln\\left(\\frac{1 - p_{1}}{1 - p_{2}}\\right) = 0.\n$$\n整理得，\n$$\n\\hat{p} \\left[ \\ln\\left(\\frac{p_{1}}{p_{2}}\\right) - \\ln\\left(\\frac{1 - p_{1}}{1 - p_{2}}\\right) \\right] = - \\ln\\left(\\frac{1 - p_{1}}{1 - p_{2}}\\right),\n$$\n所以\n$$\nT \\;=\\; \\hat{p} \\;=\\; \\frac{ - \\ln\\left(\\frac{1 - p_{1}}{1 - p_{2}}\\right) }{ \\ln\\left(\\frac{p_{1}}{p_{2}}\\right) - \\ln\\left(\\frac{1 - p_{1}}{1 - p_{2}}\\right) } \\;=\\; \\frac{ \\ln\\left(\\frac{1 - p_{2}}{1 - p_{1}}\\right) }{ \\ln\\left(\\frac{ p_{1} (1 - p_{2}) }{ p_{2} (1 - p_{1}) }\\right) }.\n$$\n给定 $0  p_2  p_1  1$，分母为正，这确保了阈值的唯一性。“如果 $\\hat{p}  T$ 则选择模式1，如果 $\\hat{p}  T$ 则选择模式2”这一规则之所以成立，是因为在对数似然比表达式中 $\\hat{p}$ 的系数为正。",
            "answer": "$$\\boxed{\\frac{\\ln\\left(\\frac{1 - p_{2}}{1 - p_{1}}\\right)}{\\ln\\left(\\frac{p_{1}(1 - p_{2})}{p_{2}(1 - p_{1})}\\right)}}$$"
        },
        {
            "introduction": "虽然一个给定“型”类中的所有序列共享相同的经验分布，但它们的内部结构可能有所不同。本练习深入探讨了“型”类本身的统计特性，要求你计算交替游程的期望数量。这将帮助你理解，“型”类不仅仅是一个集合，更是一个具有可预测平均特征的丰富统计系综。",
            "id": "1641277",
            "problem": "考虑一个二元字母表 $\\mathcal{X} = \\{0, 1\\}$。一个序列 $x^n = (x_1, x_2, \\dots, x_n)$ 的*类型*（type）是其经验概率分布，定义为 $P_{x^n}(a) = \\frac{1}{n} N(a|x^n)$，其中 $a \\in \\mathcal{X}$，$N(a|x^n)$ 是符号 $a$ 在序列 $x^n$ 中出现的次数。\n\n设 $P$ 是 $\\mathcal{X}$ 上的一个特定概率分布，由 $P(1) = p$ 和 $P(0) = 1-p$ 给出，其中 $0 \\leq p \\leq 1$。$P$ 的*类型类*（type class），记作 $T_P^{(n)}$，是所有类型为 $P$ 的长度为 $n$ 的二元序列的集合。为了使类型类有良好定义且非空，我们假设 $np$ 是一个整数。\n\n序列中的*交替游程*（alternating run）是指由相同符号组成的连续子序列。例如，序列 `11101100` 包含四个交替游程：`111`、`0`、`11` 和 `00`。\n\n假设从类型类 $T_P^{(n)}$ 中均匀随机地选择一个序列 $X^n$。确定序列 $X^n$ 中交替游程的期望数量。请用 $n$ 和 $p$ 的闭式解析表达式表示你的最终答案。",
            "solution": "令 $k = np$ 表示类型类中 1 的数量（假设为整数），因此有 $n-k$ 个 0。对于任何二元序列 $x^{n}$，交替游程的数量可以写为\n$$\nR(x^{n}) = 1 + \\sum_{i=1}^{n-1} \\mathbf{1}\\{x_{i} \\neq x_{i+1}\\}.\n$$\n对类型类 $T_{P}^{(n)}$ 上的均匀分布取期望，并利用期望的线性性质，可得\n$$\n\\mathbb{E}[R(X^{n})] = 1 + \\sum_{i=1}^{n-1} \\Pr\\{X_{i} \\neq X_{i+1}\\}.\n$$\n由于在具有 $k$ 个 1 和 $n-k$ 个 0 的多重集的排列上的均匀分布具有对称性，$\\Pr\\{X_{i} \\neq X_{i+1}\\}$ 对所有 $i$ 都是相同的，因此将此概率记为 $q$。于是有\n$$\n\\mathbb{E}[R(X^{n})] = 1 + (n-1)q.\n$$\n为了计算 $q$，注意到相邻对 $(X_{i},X_{i+1})$ 的分布与从一个装有 $k$ 个 1 和 $n-k$ 个 0 的罐子中无放回地抽取两个球的分布相同。因此\n$$\n\\Pr\\{X_{i} \\neq X_{i+1}\\} = \\Pr\\{01\\} + \\Pr\\{10\\}\n= \\frac{n-k}{n}\\cdot\\frac{k}{n-1} + \\frac{k}{n}\\cdot\\frac{n-k}{n-1}\n= \\frac{2k(n-k)}{n(n-1)}.\n$$\n所以，\n$$\n\\mathbb{E}[R(X^{n})] = 1 + (n-1)\\cdot \\frac{2k(n-k)}{n(n-1)} = 1 + \\frac{2k(n-k)}{n}.\n$$\n代入 $k = np$ 得\n$$\n\\mathbb{E}[R(X^{n})] = 1 + \\frac{2(np)\\big(n - np\\big)}{n} = 1 + 2n p(1 - p).\n$$\n该表达式对所有满足 $np$ 为整数的 $0 \\leq p \\leq 1$ 均有效，并且它满足边界情况 $p=0$ 或 $p=1$，此时序列是恒定的，期望游程数为 $1$。",
            "answer": "$$\\boxed{1 + 2 n p (1 - p)}$$"
        },
        {
            "introduction": "“型”方法是通用信源编码的基石，而这个问题将让你扮演系统设计者的角色。你将确定一个码本所需的最小尺寸，以确保任何可能的信源序列都能在指定的失真容限内被表示。这个练习阐释了对“型”空间进行量化这一强大概念，这是现代数据压缩中的一项关键技术。",
            "id": "1641276",
            "problem": "考虑一个为二进制数据通用有损压缩而设计的系统。该系统处理长度为 $n=1200$ 的数据块。该压缩方案基于类型方法。对于任意二进制序列 $x^n = (x_1, x_2, \\dots, x_n)$，其经验概率分布，即其“类型”，由 $P_{x^n} = (\\frac{N_0}{n}, \\frac{N_1}{n})$ 给出，其中 $N_0$ 和 $N_1$ 分别是序列中 0 和 1 的数量。一个类型由 1 的比例唯一确定，记为 $\\pi = N_1/n$。\n\n该系统使用一个包含 $M$ 个重构类型的固定码本 $\\mathcal{C} = \\{\\hat{\\pi}_1, \\hat{\\pi}_2, \\dots, \\hat{\\pi}_M\\}$。每个重构类型 $\\hat{\\pi}_j$ 也必须对应一个长度为 $n$ 的有效二进制序列，这意味着每个 $\\hat{\\pi}_j$ 都必须是 $k/n$ 的形式，其中 $k$ 是某个整数 $k \\in \\{0, 1, \\dots, n\\}$。\n\n源类型 $\\pi_s$ 和重构类型 $\\pi_r$ 之间的失真定义为其 1 的比例的绝对差：$d(\\pi_s, \\pi_r) = |\\pi_s - \\pi_r|$。\n\n您的任务是确定码本中所需的最少重构类型数量 $M$，以确保对于任何可能的源序列 $x^n$，至少存在一个重构类型 $\\hat{\\pi}_j \\in \\mathcal{C}$，使得失真在最大容差 $\\delta = 0.03$ 之内。换句话说，对于任何可能的源类型 $\\pi$，必须存在某个 $\\hat{\\pi}_j \\in \\mathcal{C}$ 满足 $d(\\pi, \\hat{\\pi}_j) \\le \\delta$。\n\n最终答案必须是一个整数。",
            "solution": "令所有可能的源类型集合为 $\\{\\pi_{k} : \\pi_{k} = k/n,\\ k \\in \\{0,1,\\dots,n\\}\\}$；共有 $n+1$ 种这样的类型。一个重构类型也具有形式 $\\hat{\\pi} = k_{r}/n$，其中 $k_{r} \\in \\{0,1,\\dots,n\\}$。\n\n对于一个源类型 $\\pi_{s} = k_{s}/n$ 和一个重构类型 $\\pi_{r} = k_{r}/n$，失真为\n$$\nd(\\pi_{s},\\pi_{r}) = \\left|\\frac{k_{s}}{n} - \\frac{k_{r}}{n}\\right| = \\frac{|k_{s} - k_{r}|}{n}.\n$$\n要求 $d(\\pi_{s},\\pi_{r}) \\le \\delta$ 等价于\n$$\n|k_{s} - k_{r}| \\le n\\delta.\n$$\n由于 $k_{s}$ 和 $k_{r}$ 是整数，定义 $t \\triangleq \\lfloor n\\delta \\rfloor$。那么，任何一个码本中心 $k_{r}$ 可以覆盖所有源索引 $k_{s} \\in [k_{r} - t,\\, k_{r} + t] \\cap \\{0,1,\\dots,n\\}$，这最多是 $2t+1$ 个索引。因此，要覆盖所有 $n+1$ 个索引，任何码本必须有\n$$\nM \\ge \\left\\lceil \\frac{n+1}{2t+1} \\right\\rceil.\n$$\n\n通过贪婪地放置中心可以达到这个界限。选择中心位于\n$$\nk_{j} = t + (j-1)(2t+1)\\quad \\text{对于 } j=1,2,\\dots,J-1,\n$$\n只要 $k_{j} \\le n - t$ 成立，并最终将最后一个中心放置在 $k_{J} = n - t$。这将覆盖大小为 $2t+1$ 的连续块，并且如果需要，最后会有一个重叠块直到 $n$，从而得到 $J = \\left\\lceil \\frac{n+1}{2t+1} \\right\\rceil$ 个中心。\n\n现在代入给定参数 $n=1200$ 和 $\\delta = 0.03$。那么\n$$\nn\\delta = 1200 \\times 0.03 = 36 \\quad \\Rightarrow \\quad t = \\lfloor 36 \\rfloor = 36,\\quad 2t+1 = 73,\\quad n+1 = 1201.\n$$\n因此\n$$\nM_{\\min} = \\left\\lceil \\frac{1201}{73} \\right\\rceil = 17.\n$$\n这是可以实现的，例如，通过将中心设置在 $k_{j} = 36 + (j-1)\\cdot 73$（对于 $j=1,\\dots,16$）和 $k_{17} = 1164$，它们共同覆盖了所有在索引距离 36 以内的 $k \\in \\{0,1,\\dots,1200\\}$。",
            "answer": "$$\\boxed{17}$$"
        }
    ]
}