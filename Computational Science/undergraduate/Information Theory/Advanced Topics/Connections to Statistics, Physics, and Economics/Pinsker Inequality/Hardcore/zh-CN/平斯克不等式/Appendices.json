{
    "hands_on_practices": [
        {
            "introduction": "为了将抽象的理论付诸实践，我们从一个基础练习开始。在这个练习中，我们将使用两个简单的伯努利分布，并直接计算它们之间的KL散度和总变差距离。通过这个具体的计算，我们可以亲手验证平斯克不等式确实成立，从而为这两种度量以及它们之间的关系建立起直观的认识。",
            "id": "1646398",
            "problem": "在一个数字化制造过程中，一个组件被设计为处于两种状态之一，标记为0和1。理想的制造规范规定，一个组件处于状态1的概率恰好为 $p$。这可以用一个伯努利分布来建模，我们称之为 $P$，其概率质量函数为 $P(1) = p$ 和 $P(0) = 1-p$。\n\n经过一段时间的运行，一次质量控制检查显示该过程发生了偏移。现在，这些组件遵循一个不同的伯努利分布 $Q$，其概率质量函数为 $Q(1) = q$ 和 $Q(0) = 1-q$。\n\n为了量化理想分布 $P$ 和实际分布 $Q$ 之间的统计差异，使用了两个来自信息论的重要度量指标：\n\n1.  全变差距离，定义为 $\\delta(P, Q) = \\frac{1}{2} \\sum_{x \\in \\{0, 1\\}} |P(x) - Q(x)|$。\n2.  Kullback-Leibler (KL) 散度，定义为 $D_{KL}(P \\| Q) = \\sum_{x \\in \\{0, 1\\}} P(x) \\ln\\left(\\frac{P(x)}{Q(x)}\\right)$。\n\n这两个度量通过平斯克不等式相关联，该不等式表明 $D_{KL}(P \\| Q) \\ge 2[\\delta(P, Q)]^2$。项 $2[\\delta(P, Q)]^2$ 作为KL散度的理论下界。\n\n假设理想规范是 $p=0.5$，但实际观测到的过程已偏移至 $q=0.8$。计算实际KL散度与平斯克不等式给出的理论下界之间的比值。也就是说，计算比值 $R = \\frac{D_{KL}(P \\| Q)}{2[\\delta(P, Q)]^2}$ 的值。\n\n将您的最终答案四舍五入到三位有效数字。",
            "solution": "两个参数为 $p$ 和 $q$ 的伯努利分布之间的全变差距离是\n$$\n\\delta(P,Q)=\\frac{1}{2}\\left(|p-q|+|(1-p)-(1-q)|\\right)=\\frac{1}{2}\\left(|p-q|+|q-p|\\right)=|p-q|.\n$$\n对于 $p=\\frac{1}{2}$ 和 $q=\\frac{4}{5}$，\n$$\n\\delta(P,Q)=\\left|\\frac{1}{2}-\\frac{4}{5}\\right|=\\left|\\frac{5-8}{10}\\right|=\\frac{3}{10}.\n$$\n平斯克下界是\n$$\n2[\\delta(P,Q)]^{2}=2\\left(\\frac{3}{10}\\right)^{2}=2\\cdot\\frac{9}{100}=\\frac{9}{50}.\n$$\n伯努利分布的Kullback-Leibler散度是\n$$\nD_{KL}(P\\|Q)=p\\ln\\!\\left(\\frac{p}{q}\\right)+(1-p)\\ln\\!\\left(\\frac{1-p}{1-q}\\right).\n$$\n代入 $p=\\frac{1}{2}$ 和 $q=\\frac{4}{5}$ 可得\n$$\nD_{KL}(P\\|Q)=\\frac{1}{2}\\ln\\!\\left(\\frac{\\frac{1}{2}}{\\frac{4}{5}}\\right)+\\frac{1}{2}\\ln\\!\\left(\\frac{\\frac{1}{2}}{\\frac{1}{5}}\\right)=\\frac{1}{2}\\left[\\ln\\!\\left(\\frac{5}{8}\\right)+\\ln\\!\\left(\\frac{5}{2}\\right)\\right]=\\frac{1}{2}\\ln\\!\\left(\\frac{25}{16}\\right)=\\ln\\!\\left(\\frac{5}{4}\\right).\n$$\n因此，该比值为\n$$\nR=\\frac{D_{KL}(P\\|Q)}{2[\\delta(P,Q)]^{2}}=\\frac{\\ln\\!\\left(\\frac{5}{4}\\right)}{\\frac{9}{50}}=\\frac{50}{9}\\ln\\!\\left(\\frac{5}{4}\\right)\\approx 1.239686\\ldots\n$$\n四舍五入到三位有效数字， $R=1.24$。",
            "answer": "$$\\boxed{1.24}$$"
        },
        {
            "introduction": "在掌握了基础验证后，我们将概念扩展到包含两个以上结果的场景。这个练习将平斯克不等式重新表述为一个寻找总变差距离上限的工具，在许多实际问题中，直接计算总变差距离可能比计算KL散度更为复杂。这突显了该不等式的一个重要实际应用：利用一个量（KL散度）来约束另一个量（总变差距离）。",
            "id": "1646410",
            "problem": "一个离散随机变量 $X$ 可以从集合 $\\mathcal{X} = \\{o_1, o_2, o_3\\}$ 中取三个可能的结果之一。我们有两个不同的概率分布 $P$ 和 $Q$ 来为这个变量建模：\n-   分布 $P$：$P(X=o_1) = 0.6$，$P(X=o_2) = 0.3$，$P(X=o_3) = 0.1$。\n-   分布 $Q$：$Q(X=o_1) = 0.1$，$Q(X=o_2) = 0.3$，$Q(X=o_3) = 0.6$。\n\n在信息论中，使用两种重要的度量来比较概率分布。第一种是全变差距离 (TVD)，对于离散分布，其定义为 $d_{TV}(P, Q) = \\frac{1}{2} \\sum_{x \\in \\mathcal{X}} |P(x) - Q(x)|$。第二种是 Kullback-Leibler (KL) 散度，其定义为 $D_{KL}(P \\| Q) = \\sum_{x \\in \\mathcal{X}} P(x) \\ln\\left(\\frac{P(x)}{Q(x)}\\right)$，其中 $\\ln$ 表示自然对数。\n\n这两种度量通过一个基本结果联系在一起，该结果通常被称为 Pinsker 不等式，它用 KL 散度给出了 TVD 的一个上界：\n$$d_{TV}(P, Q) \\le \\sqrt{\\frac{1}{2} D_{KL}(P \\| Q)}$$\n\n您的任务是计算给定分布 $P$ 和 $Q$ 的这个上界的数值。将您的结果报告为一个无量纲数，并四舍五入到四位有效数字。",
            "solution": "给定在 $\\mathcal{X} = \\{o_{1}, o_{2}, o_{3}\\}$ 上的离散分布 $P$ 和 $Q$，其中\n$P(o_{1}) = 0.6$，$P(o_{2}) = 0.3$，$P(o_{3}) = 0.1$ 且 $Q(o_{1}) = 0.1$，$Q(o_{2}) = 0.3$，$Q(o_{3}) = 0.6$。\n平斯克不等式表明\n$$\nd_{TV}(P,Q) \\le \\sqrt{\\frac{1}{2} D_{KL}(P \\| Q)}.\n$$\n首先使用其定义计算 Kullback-Leibler 散度\n$$\nD_{KL}(P \\| Q) = \\sum_{x \\in \\mathcal{X}} P(x)\\,\\ln\\!\\left(\\frac{P(x)}{Q(x)}\\right).\n$$\n逐项计算，\n$$\n\\begin{aligned}\nx=o_{1}:\\quad 0.6\\,\\ln\\!\\left(\\frac{0.6}{0.1}\\right) = 0.6\\,\\ln(6),\\\\\nx=o_{2}:\\quad 0.3\\,\\ln\\!\\left(\\frac{0.3}{0.3}\\right) = 0.3\\,\\ln(1) = 0,\\\\\nx=o_{3}:\\quad 0.1\\,\\ln\\!\\left(\\frac{0.1}{0.6}\\right) = 0.1\\,\\ln\\!\\left(\\frac{1}{6}\\right) = -0.1\\,\\ln(6).\n\\end{aligned}\n$$\n将这些项相加，得到\n$$\nD_{KL}(P \\| Q) = \\left(0.6 - 0.1\\right)\\ln(6) = \\frac{1}{2}\\ln(6).\n$$\n因此，平斯克上界的计算结果为\n$$\n\\sqrt{\\frac{1}{2} D_{KL}(P \\| Q)} = \\sqrt{\\frac{1}{2}\\cdot \\frac{1}{2}\\ln(6)} = \\sqrt{\\frac{1}{4}\\ln(6)} = \\frac{1}{2}\\sqrt{\\ln(6)}.\n$$\n数值上，\n$$\n\\ln(6) \\approx 1.791759469,\\quad \\sqrt{\\ln(6)} \\approx 1.338566287,\\quad \\frac{1}{2}\\sqrt{\\ln(6)} \\approx 0.6692831435.\n$$\n四舍五入到四位有效数字，上界为 $0.6693$，这是一个无量纲数。",
            "answer": "$$\\boxed{0.6693}$$"
        },
        {
            "introduction": "最后的练习将引导我们从简单的验证转向更深入的分析，并提出一个更微妙的问题：平斯克不等式的界限有多“紧”？通过研究两个非常相似的伯努利分布的KL散度与总变差距离平方之间的关系，我们可以运用微积分来理解该界限的局部行为。这个过程揭示了不等式的系数与基础概率分布的内在属性（即费雪信息）之间的深刻联系。",
            "id": "1646421",
            "problem": "在信息论和统计学中，各种度量被用来量化两个概率分布之间的“差异”。其中最基本的两个是Kullback-Leibler散度和全变差距离。本问题探讨对于伯努利分布族，这两种度量之间的局部关系。\n\n设一个二元随机变量 $X \\in \\{0, 1\\}$ 的伯努利分布（记作 `Bern(p)`）由概率质量函数 $P(X=1) = p$ 和 $P(X=0) = 1-p$ 定义，其中参数 $p \\in (0, 1)$。\n\n从一个离散概率分布 $Q$ 到另一个分布 $P$（两者均定义在样本空间 $\\Omega$ 上）的Kullback-Leibler (KL) 散度定义为：\n$$ D_{KL}(P \\| Q) = \\sum_{x \\in \\Omega} P(x) \\ln\\left(\\frac{P(x)}{Q(x)}\\right) $$\n两个定义在样本空间 $\\Omega$ 上的离散概率分布 $P$ 和 $Q$ 之间的全变差 (TV) 距离定义为：\n$$ \\text{TV}(P, Q) = \\frac{1}{2} \\sum_{x \\in \\Omega} |P(x) - Q(x)| $$\n\n考虑一个固定的参考分布 $P_0 = \\text{Bern}(p_0)$ 和一个可变分布 $P_p = \\text{Bern}(p)$。我们定义以下两个关于 $p$ 的函数：\n1.  $g(p) = D_{KL}(P_0 \\| P_p)$\n2.  $f(p) = \\left( \\text{TV}(P_0, P_p) \\right)^2$\n\n这两个函数都度量了两个分布之间的差异，并且当 $p = p_0$ 时它们的值都为零。我们感兴趣的是，当 $p$ 开始偏离 $p_0$ 时，比较这两个函数的增长速度。\n\n对于参数为 $p_0 = 0.25$ 的参考分布，计算以下极限的值：\n$$ L = \\lim_{p \\to p_0} \\frac{g(p)}{f(p)} $$\n以实数形式给出 $L$ 的值。将最终答案保留到四位有效数字。",
            "solution": "我们处理 $P_{0}=\\text{Bern}(p_{0})$ 和 $P_{p}=\\text{Bern}(p)$，其中 $p_{0}=0.25$。根据定义，\n$$\ng(p)=D_{KL}(P_{0}\\|P_{p})=p_{0}\\ln\\!\\left(\\frac{p_{0}}{p}\\right)+(1-p_{0})\\ln\\!\\left(\\frac{1-p_{0}}{1-p}\\right).\n$$\n对于伯努利分布，全变差距离为\n$$\n\\text{TV}(P_{0},P_{p})=\\frac{1}{2}\\sum_{x\\in\\{0,1\\}}|P_{0}(x)-P_{p}(x)|=\\frac{1}{2}\\left(|p_{0}-p|+|(1-p_{0})-(1-p)|\\right)=|p-p_{0}|,\n$$\n所以\n$$\nf(p)=\\left(\\text{TV}(P_{0},P_{p})\\right)^{2}=(p-p_{0})^{2}.\n$$\n\n我们将 $g(p)$ 在 $p=p_{0}$ 附近展开。求导：\n$$\ng'(p)=\\frac{d}{dp}\\left[-p_{0}\\ln p-(1-p_{0})\\ln(1-p)\\right]=-\\,\\frac{p_{0}}{p}+\\frac{1-p_{0}}{1-p},\n$$\n所以\n$$\ng'(p_{0})=-\\,\\frac{p_{0}}{p_{0}}+\\frac{1-p_{0}}{1-p_{0}}=-1+1=0.\n$$\n二阶导数：\n$$\ng''(p)=\\frac{p_{0}}{p^{2}}+\\frac{1-p_{0}}{(1-p)^{2}},\n$$\n因此\n$$\ng''(p_{0})=\\frac{p_{0}}{p_{0}^{2}}+\\frac{1-p_{0}}{(1-p_{0})^{2}}=\\frac{1}{p_{0}}+\\frac{1}{1-p_{0}}=\\frac{1}{p_{0}(1-p_{0})}.\n$$\n根据泰勒展开，并考虑到 $g'(p_{0})=0$，我们有\n$$\ng(p)=\\frac{1}{2}g''(p_{0})(p-p_{0})^{2}+o\\!\\left((p-p_{0})^{2}\\right).\n$$\n因此，\n$$\nL=\\lim_{p\\to p_{0}}\\frac{g(p)}{f(p)}=\\lim_{p\\to p_{0}}\\frac{\\frac{1}{2}g''(p_{0})(p-p_{0})^{2}+o\\!\\left((p-p_{0})^{2}\\right)}{(p-p_{0})^{2}}=\\frac{1}{2}g''(p_{0})=\\frac{1}{2p_{0}(1-p_{0})}.\n$$\n当 $p_{0}=0.25$ 时，我们有 $p_{0}(1-p_{0})=\\frac{1}{4}\\cdot\\frac{3}{4}=\\frac{3}{16}$，所以\n$$\nL=\\frac{1}{2\\cdot\\frac{3}{16}}=\\frac{1}{\\frac{3}{8}}=\\frac{8}{3}\\approx 2.666666\\ldots\n$$\n保留四位有效数字，得到 $L=2.667$。",
            "answer": "$$\\boxed{2.667}$$"
        }
    ]
}