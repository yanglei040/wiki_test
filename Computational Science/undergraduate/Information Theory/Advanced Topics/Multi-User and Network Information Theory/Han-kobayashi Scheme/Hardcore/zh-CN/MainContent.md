## 引言
在[多用户通信](@entry_id:262688)系统中，干扰是限制[网络性能](@entry_id:268688)的核心挑战。如何在共享信道中有效管理来自其他用户的信号，是信息论与无线通信领域一个持久的根本问题。传统的干扰处理方法，如简单地将干扰视为噪声或尝试完全解码干扰，往往因其局限性而无法达到最优性能。Han-Kobayashi (HK) 方案正是在这一背景下提出的里程碑式理论，它通过一种精巧的“部分解码、部分视为噪声”的[混合策略](@entry_id:145261)，为干扰管理提供了强大而通用的框架。

本文旨在系统性地剖析Han-Kobayashi方案。我们将从其核心思想出发，在“原理与机制”一章中深入探讨速率分裂、[叠加编码](@entry_id:275923)和逐次[干扰消除](@entry_id:273045)等关键机制。随后，在“应用与[交叉](@entry_id:147634)学科联系”一章中，我们将展示该方案如何应用于不同信道模型，并与速率分割多址接入（RSMA）、信息安[全等](@entry_id:273198)前沿领域产生联系。最后，通过“动手实践”部分的练习，读者将有机会巩固和应用所学知识。

## 原理与机制

在[干扰信道](@entry_id:266326)中，多个发射机-接收机对同时共享一个通信媒介，不可避免地会产生相互干扰。一个简单但通常次优的策略是将所有干扰视为纯粹的噪声。另一种极端策略是完全解码并消除所有干扰信号，但这通常是不可能实现的，因为干扰信号对于非目标接收机来说可能过弱而无法解码。Han-Kobayashi (HK) 方案提供了一种精妙的中间道路，它通过一种称为**速率分裂 (rate-splitting)** 的强大思想，实现了对干扰的精细化管理。本章将深入探讨 Han-Kobayashi 方案的核心原理与机制，从其策略基础到其编码和解码过程，最终落脚于其信息论的数学形式化。

### 核心策略：通过速率分裂管理干扰

Han-Kobayashi 方案的基石是将每个用户的消息分为两部分：一个**公共消息 (common message)** 和一个**私有消息 (private message)**。这种划分并非基于消息内容的语义，而是基于一种编码和解码策略的意图。

**公共消息**，以用户1的公共消息 $W_{1c}$ 为例，其对应的信号部分被设计为足够鲁棒，以至于**所有**接收机（即目标接收机1和干扰接收机2）都能成功解码。设立这样一个公共部分的首要信息论目的是为了让非目标接收机能够执行**[干扰消除](@entry_id:273045) (interference cancellation)**。当接收机2解码了来自用户1的公共消息 $W_{1c}$ 后，它就可以完美地重构出该消息对应的信号波形，并从其接收到的总信号中减去这一部分。这一过程显著改善了解码其自身目标消息的[信噪比](@entry_id:185071) 。

**私有消息**，例如用户1的私有消息 $W_{1p}$，则采取了相反的策略。它被编码为仅能由其**目标**接收机（接收机1）解码。对于所有其他接收机（如接收机2），这个私有信号部分在设计上就是无法解码的，因此只能被当作**非结构化噪声 (unstructured noise)** 来处理 。

因此，HK方案的智慧在于它不对干扰进行“全或无”的处理。它将干扰[信号分解](@entry_id:145846)为“可解码”和“不可解码”两个部分。通过主动解码干扰的公共部分并将其消除，接收机能够在一个更“干净”的信道上解码自己的消息，只需对抗 residual interference（残余干扰），即来自其他用户私有消息的干扰。

### 编码机制：[叠加编码](@entry_id:275923)

为了将公共消息和私有消息嵌入单个发射信号中，HK方案采用了**[叠加编码](@entry_id:275923) (superposition coding)** 的方法。我们可以通过一个形象的比喻来理解这个过程：**云中心与卫星 (cloud centers and satellites)**。

首先，为了编码公共消息 $W_{1c}$，我们构建一个辅助码本。这个码本包含 $2^{nR_{1c}}$ 个码字，其中 $R_{1c}$ 是公共消息的速率，$n$ 是码长。每个码字，表示为 $U^n(w_{1c})$，可以被看作是编码空间中的一个“云中心”。这些 $U^n$ 序列通常由独立同分布 (i.i.d.) 的[随机变量生成](@entry_id:756434)，遵循某个[概率分布](@entry_id:146404) $p(u)$。

接下来，对于每一个确定的“云中心” $U^n(w_{1c})$，我们围绕它生成一个“卫星”码本，用于编码私有消息 $W_{1p}$。这个私有码本包含 $2^{nR_{1p}}$ 个码字，表示为 $X^n(w_{1p} | w_{1c})$。这些 $X^n$ 序列是最终要被发送到信道中的实际信号。它们的生成过程在概率上依赖于对应的云中心。具体来说，序列 $X^n$ 的每一个符号 $X_t$ 都是根据一个**[条件概率分布](@entry_id:163069) $p(x|u)$** 生成的，其中的[条件变量](@entry_id:747671) $u$ 就是云中心序列 $U^n$ 在同一时刻 $t$ 的符号 $U_t$ 。

因此，当发射机1要发送消息对 $(w_{1c}, w_{1p})$ 时，它首先根据 $w_{1c}$ 选择云中心码字 $U^n(w_{1c})$，然后根据 $w_{1p}$ 在围绕该云中心的卫星码本中选择最终的发射码字 $X^n(w_{1p} | w_{1c})$。用户2也遵循同样的过程。

这种编码结构需要多个码本。在一个双用户场景中，一种典型的码本结构是：一个联合的公共层码本，其码字由公共消息对 $(w_{1c}, w_{2c})$ 索引；以及两个独立的私有层码本，分别由 $w_{1p}$ 和 $w_{2p}$ 索引。如果各消息集合的大小分别为 $M_{1c}, M_{1p}, M_{2c}, M_{2p}$，那么总共需要存储的码字数量为 $M_{1c} M_{2c} + M_{1p} + M_{2p}$ 个 。

### 解码机制：逐次[干扰消除](@entry_id:273045)

在接收端，HK方案的精髓体现在一个多阶段的解码过程中，这个过程被称为**逐次[干扰消除](@entry_id:273045) (Successive Interference Cancellation, SIC)**。让我们以接收机1为例，其目标是恢复完整的消息 $W_1 = (W_{1c}, W_{1p})$。它接收到的信号是来自用户1和用户2所有四个消息部分（$W_{1c}, W_{1p}, W_{2c}, W_{2p}$）信号的叠加。

一个典型且强大的HK解码流程如下  ：

1.  **阶段一：解码公共消息。** 接收机1首先尝试联合解码**两个**公共消息，即它自己的公共消息 $W_{1c}$ 和来自干扰者的公共消息 $W_{2c}$。在这一阶段，两个用户的私有信号部分（对应于 $W_{1p}$ 和 $W_{2p}$）因为无法预知，所以都被当作噪声处理。

2.  **阶段二：重构并消除公共干扰。** 一旦成功解码出 $(\hat{W}_{1c}, \hat{W}_{2c})$，接收机1就可以利用码本知识，完美地重构出这两个消息对应的信号波形 $X_{1c}$ 和 $X_{2c}$。然后，它从原始接收信号中减去这两个已知的信号成分。

3.  **阶段三：解码私有消息。** 经过消除操作后，剩余的信号主要包含三个成分：期望的私有信号（来自 $W_{1p}$）、来自干扰者的私有信号（来自 $W_{2p}$）以及信道本身的噪声。此时，接收机1尝试解码自己的私有消息 $W_{1p}$。根据HK方案的设计，干扰者的私有信号 $W_{2p}$ 是不可解码的，因此在这一步它被视为唯一的残余干扰噪声。

4.  **阶段四：验证。** 在信息论的[随机编码](@entry_id:142786)证明中，最后一步是验证解码出的消息元组 $(\hat{W}_{1c}, \hat{W}_{1p}, \hat{W}_{2c})$ 是否与接收到的[信号序列](@entry_id:143660) $Y_1^n$ 联合典型。这是确保解码[错误概率](@entry_id:267618)随码长 $n$ 任意小的关键步骤。

这个逐层“剥离”干扰的解码过程，是HK方案能够超越简单地将所有干扰视为噪声的策略的根本原因。即使在一个非常简单的确定性信道模型中，例如 $Y_1=X_1$ 和 $Y_2 = X_1 \lor X_2$，我们也能看到SIC思想的威力。在这个模型中，如果接收机2采用SIC策略，它首先解码用户1的完整消息 $X_1$。一旦知道了 $X_1$，它就能利用 $Y_2 = X_1 \lor X_2$ 来解码自己的消息 $X_2$。例如，如果 $X_1=0$，那么 $Y_2=X_2$，信道变得无干扰。如果 $X_1=1$，则 $Y_2=1$ 恒成立，虽然无法传递信息，但这个例子清晰地展示了“解码干扰以改善自身通信”的核心思想。在这种特定策略下，用户2能达到的最大速率由[条件互信息](@entry_id:139456) $I(X_2; Y_2 | X_1)$ 决定，计算可得为 $0.5$ 比特/信道使用 。

### [可达速率](@entry_id:273343)区域：形式化界定

上述的编码和解码策略的有效性最终体现在一个[可达速率](@entry_id:273343)区域的数学描述上。HK方案的[可达速率](@entry_id:273343)区域由一系列[互信息](@entry_id:138718)不等式定义，这些不等式正是对解码过程中每个阶段成功解码条件的量化。

例如，在接收机2处成功解码用户1的公共消息 $W_{1c}$ 的能力，限制了 $W_{1c}$ 的速率 $R_{1c}$。在HK方案的完整形式中，这个约束由以下不等式给出：
$$
R_{1c} \le I(U_1; Y_2 | U_2, Q)
$$
这里，$U_1$ 是编码 $W_{1c}$ 的辅助[随机变量](@entry_id:195330)，$Y_2$ 是接收机2的输出，$U_2$ 是编码 $W_{2c}$ 的辅助[随机变量](@entry_id:195330)。条件化于 $U_2$ 反映了两个公共消息是联合解码的，而 $Q$ 是一个**时间共享 (time-sharing)** [随机变量](@entry_id:195330)，我们稍后会讨论 。类似地，解码 $W_{1p}$ 的速率 $R_{1p}$ 会受限于 $I(X_1; Y_1 | U_1, U_2, Q)$ （在公共消息已知后）等一系列更复杂的互信息表达式。

将所有这些速率约束（包括用户1和用户2的私有速率、公共速率以及它们的各种和速率）集合在一起，对于一组固定的输入[概率分布](@entry_id:146404) $p(q, u_1, u_2, x_1, x_2)$，就定义了一个[可达速率](@entry_id:273343)对 $(R_1, R_2)$ 的区域。

为了获得最广为人知的HK可達区域，我们需要考虑所有可能的输入[概率分布](@entry_id:146404)。将所有这些[分布](@entry_id:182848)产生的可达区域取并集，得到一个可能形状复杂且非凸的集合。为了使最终的区域是凸的，信息论中引入了时间共享的概念。在物理实现上，时间共享是指系统可以在不同的编码策略之间切换。例如，用 $\alpha$ 比例的时间使用策略A（达到速率对 $(R_{1A}, R_{2A})$），用 $1-\alpha$ 比例的时间使用策略B（达到速率对 $(R_{1B}, R_{2B})$），那么长期来看，[平均速率](@entry_id:147100)对 $(\alpha R_{1A} + (1-\alpha)R_{1B}, \alpha R_{2A} + (1-\alpha)R_{2B})$ 是可达的。这对应于连接两个原始速率点的线段上的所有点。

数学上，这个操作等价于对所有基础策略产生的速率点集合取**凸包 (convex hull)** 。时间共享[随机变量](@entry_id:195330) $Q$ 正是这个过程的形式化工具：$Q$ 的[概率分布](@entry_id:146404) $p(q)$ 代表了使用由 $q$ 索引的特定策略的时间比例 。

最后，需要强调的是，尽管Han-Kobayashi方案极其强大，但它给出的[可达速率](@entry_id:273343)区域是一个**内界 (inner bound)**。这意味着所有HK区域内的速率对都是可达的，但我们不能断言该区域之外的速率对一定不可达。对于一般的[干扰信道](@entry_id:266326)，其确切的[容量区](@entry_id:271060)域（即所有[可达速率](@entry_id:273343)对的集合）至今仍是一个开放问题。HK内界和已知的各种**外界 (outer bound)** 之间通常存在一个“不确定性区域”，这代表了我们在完全理解[干扰信道](@entry_id:266326)容量方面的现有知识空白 。尽管如此，Han-Kobayashi方案仍然是多用户信息论中一个里程碑式的成就，为现代[无线通信](@entry_id:266253)中的干扰管理技术（如速率分裂多址接入 RSMA）提供了坚实的理论基础。