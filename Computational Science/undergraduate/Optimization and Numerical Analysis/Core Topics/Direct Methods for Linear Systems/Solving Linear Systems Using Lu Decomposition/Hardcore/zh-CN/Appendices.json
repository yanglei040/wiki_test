{
    "hands_on_practices": [
        {
            "introduction": "掌握LU分解后，求解线性方程组的核心在于执行两个简单的步骤：前向替换和后向替换。这个练习旨在让你熟练掌握这一基本流程，当你已经拥有矩阵的$L$和$U$因子时，通过将一个复杂的线性系统$A\\mathbf{x} = \\mathbf{b}$拆分为两个易于处理的三角系统$L\\mathbf{y} = \\mathbf{b}$和$U\\mathbf{x} = \\mathbf{y}$，从而高效地求出解。这是应用LU分解解决实际问题的基础技能。",
            "id": "2204086",
            "problem": "一个线性方程组由矩阵方程 $A\\mathbf{x}=\\mathbf{b}$ 给出。矩阵 $A$ 已被分解为一个下三角矩阵 $L$ 和一个上三角矩阵 $U$ 的乘积，使得 $A=LU$。这种特定类型的 LU 分解是一种上三角矩阵 $U$ 的主对角线元素均为1的分解。\n\n给定矩阵 $L$、$U$ 和向量 $\\mathbf{b}$ 如下：\n$$\nL = \\begin{pmatrix} 2 & 0 & 0 \\\\ -1 & 3 & 0 \\\\ 4 & -2 & 1 \\end{pmatrix}, \\quad U = \\begin{pmatrix} 1 & 2 & -1 \\\\ 0 & 1 & 3 \\\\ 0 & 0 & 1 \\end{pmatrix}, \\quad \\text{和} \\quad \\mathbf{b} = \\begin{pmatrix} -4 \\\\ 5 \\\\ -9 \\end{pmatrix}\n$$\n求解解向量 $\\mathbf{x} = \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\end{pmatrix}$。",
            "solution": "我们已知 $A=LU$，其中 $L$ 是下三角矩阵，$U$ 是主对角线元素为1的上三角矩阵，我们必须求解 $A\\mathbf{x}=\\mathbf{b}$。定义 $\\mathbf{y}=U\\mathbf{x}$。那么可以通过前向替换求解 $L\\mathbf{y}=\\mathbf{b}$，然后通过后向替换求解 $U\\mathbf{x}=\\mathbf{y}$。\n\n首先求解 $L\\mathbf{y}=\\mathbf{b}$，其中\n$$\nL=\\begin{pmatrix} 2 & 0 & 0 \\\\ -1 & 3 & 0 \\\\ 4 & -2 & 1 \\end{pmatrix},\\quad\n\\mathbf{y}=\\begin{pmatrix}y_{1}\\\\y_{2}\\\\y_{3}\\end{pmatrix},\\quad\n\\mathbf{b}=\\begin{pmatrix}-4\\\\5\\\\-9\\end{pmatrix}.\n$$\n写出方程组：\n$$\n2y_{1}=-4,\\quad -y_{1}+3y_{2}=5,\\quad 4y_{1}-2y_{2}+y_{3}=-9.\n$$\n由第一个方程可得，\n$$\ny_{1}=\\frac{-4}{2}=-2.\n$$\n代入第二个方程：\n$$\n-(-2)+3y_{2}=5\\;\\Rightarrow\\;2+3y_{2}=5\\;\\Rightarrow\\;3y_{2}=3\\;\\Rightarrow\\;y_{2}=1.\n$$\n将 $y_{1}$ 和 $y_{2}$ 代入第三个方程：\n$$\n4(-2)-2(1)+y_{3}=-9\\;\\Rightarrow\\;-8-2+y_{3}=-9\\;\\Rightarrow\\;-10+y_{3}=-9\\;\\Rightarrow\\;y_{3}=1.\n$$\n因此，\n$$\n\\mathbf{y}=\\begin{pmatrix}-2\\\\1\\\\1\\end{pmatrix}.\n$$\n\n接下来求解 $U\\mathbf{x}=\\mathbf{y}$，其中\n$$\nU=\\begin{pmatrix} 1 & 2 & -1 \\\\ 0 & 1 & 3 \\\\ 0 & 0 & 1 \\end{pmatrix},\\quad\n\\mathbf{x}=\\begin{pmatrix}x_{1}\\\\x_{2}\\\\x_{3}\\end{pmatrix},\\quad\n\\mathbf{y}=\\begin{pmatrix}-2\\\\1\\\\1\\end{pmatrix}.\n$$\n写出方程组：\n$$\nx_{1}+2x_{2}-x_{3}=-2,\\quad x_{2}+3x_{3}=1,\\quad x_{3}=1.\n$$\n由第三行可得，\n$$\nx_{3}=1.\n$$\n由第二行可得，\n$$\nx_{2}+3(1)=1\\;\\Rightarrow\\;x_{2}=-2.\n$$\n由第一行可得，\n$$\nx_{1}+2(-2)-1=-2\\;\\Rightarrow\\;x_{1}-4-1=-2\\;\\Rightarrow\\;x_{1}-5=-2\\;\\Rightarrow\\;x_{1}=3.\n$$\n因此，解向量为 $\\mathbf{x}=\\begin{pmatrix}3\\\\-2\\\\1\\end{pmatrix}$。",
            "answer": "$$\\boxed{\\begin{pmatrix} 3 \\\\ -2 \\\\ 1 \\end{pmatrix}}$$"
        },
        {
            "introduction": "在理想情况下，我们可以直接对矩阵$A$进行LU分解，但实际应用中，高斯消元过程可能会因为主元位置出现零而失败。为了解决这个问题，我们引入了“部分选主”（partial pivoting）的策略，通过行交换来避免除以零，这在矩阵运算中等价于左乘一个置换矩阵$P$。这个练习将引导你处理更为普遍的$PA = LU$分解形式，这是数值计算中保证算法稳定性和普适性的关键一步。",
            "id": "2204103",
            "problem": "在数值线性代数中，求解方程组 $A\\mathbf{x}=\\mathbf{b}$ 通常首先对矩阵 $A$ 进行分解。然而，对于某些矩阵，由于在高斯消去法过程中出现零主元，直接进行LU分解是不可能的。这个问题可以通过对矩阵的行进行置换来解决，这等价于左乘一个置换矩阵 $P$。然后可以对置换后的矩阵进行LU分解，即 $PA=LU$。这被称为带部分主元选择的LU分解。\n\n考虑下面给出的矩阵 $A$ 和置换矩阵 $P$：\n$$A = \\begin{pmatrix} 2 & 1 & 5 \\\\ 4 & 2 & -1 \\\\ -6 & 1 & 0 \\end{pmatrix}, \\quad P = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 0 & 1 \\\\ 0 & 1 & 0 \\end{pmatrix}$$\n\n对矩阵乘积 $PA$ 进行Doolittle LU分解，使得 $PA = LU$。在Doolittle分解中，矩阵 $L$ 是一个主对角线上元素为1的下三角矩阵，而 $U$ 是一个上三角矩阵。\n\n你的任务是求出矩阵和 $L+U$。",
            "solution": "首先计算置换矩阵 $PA$，通过将 $P$ 左乘 $A$ 来实现，这将交换 $A$ 的第二行和第三行：\n$$\nPA=\\begin{pmatrix} 2 & 1 & 5 \\\\ -6 & 1 & 0 \\\\ 4 & 2 & -1 \\end{pmatrix}.\n$$\n对 $PA=LU$ 进行Doolittle LU分解，其中 $L$ 是单位下三角矩阵， $U$ 是上三角矩阵。\n\n对 $PA$ 使用高斯消去法来确定乘数和 $U$ 的元素：\n- 主元在 $(1,1)$ 位置：$u_{11}=2$，并设\n$$\n\\ell_{21}=\\frac{-6}{2}=-3,\\quad \\ell_{31}=\\frac{4}{2}=2.\n$$\n在第一个主元下方进行消元：\n$$\n\\text{Row }2 \\leftarrow \\text{Row }2 - \\ell_{21}\\,\\text{Row }1 = \\begin{pmatrix} 0 & 4 & 15 \\end{pmatrix},\\quad\n\\text{Row }3 \\leftarrow \\text{Row }3 - \\ell_{31}\\,\\text{Row }1 = \\begin{pmatrix} 0 & 0 & -11 \\end{pmatrix}.\n$$\n因此，$U$ 的第一行是 $[2,1,5]$，在第一步消元后，子矩阵为\n$$\n\\begin{pmatrix} 0 & 4 & 15 \\\\ 0 & 0 & -11 \\end{pmatrix}.\n$$\n- 主元在 $(2,2)$ 位置：$u_{22}=4$，并设\n$$\n\\ell_{32}=\\frac{0}{4}=0.\n$$\n在第二个主元下方进行消元：\n$$\n\\text{Row }3 \\leftarrow \\text{Row }3 - \\ell_{32}\\,\\text{Row }2 = \\begin{pmatrix} 0 & 0 & -11 \\end{pmatrix},\n$$\n所以 $u_{23}=15$ 且 $u_{33}=-11$。\n\n因此，\n$$\nL=\\begin{pmatrix} 1 & 0 & 0 \\\\ -3 & 1 & 0 \\\\ 2 & 0 & 1 \\end{pmatrix},\\quad\nU=\\begin{pmatrix} 2 & 1 & 5 \\\\ 0 & 4 & 15 \\\\ 0 & 0 & -11 \\end{pmatrix}.\n$$\n计算矩阵和 $L+U$：\n$$\nL+U=\\begin{pmatrix} 1+2 & 0+1 & 0+5 \\\\ -3+0 & 1+4 & 0+15 \\\\ 2+0 & 0+0 & 1+(-11) \\end{pmatrix}\n=\\begin{pmatrix} 3 & 1 & 5 \\\\ -3 & 5 & 15 \\\\ 2 & 0 & -10 \\end{pmatrix}.\n$$",
            "answer": "$$\\boxed{\\begin{pmatrix} 3 & 1 & 5 \\\\ -3 & 5 & 15 \\\\ 2 & 0 & -10 \\end{pmatrix}}$$"
        },
        {
            "introduction": "LU分解的真正威力在于其计算效率，尤其是在需要多次求解相关线性系统时。考虑求解形如$A^2\\mathbf{x} = \\mathbf{b}$的方程，直接计算$A^2$的成本非常高。这个练习展示了一种更巧妙的方法：通过重复使用$A$的LU因子，将问题转化为求解两个相继的、但形式简单的$A\\mathbf{y} = \\mathbf{b}$和$A\\mathbf{x} = \\mathbf{y}$系统，从而凸显出矩阵分解在复杂计算模型中的巨大优势。",
            "id": "2204064",
            "problem": "在一个机械系统的计算模型中，稳态位移向量 $\\mathbf{x}$ 是通过求解一个形如 $A^2\\mathbf{x} = \\mathbf{b}$ 的矩阵方程来确定的。为避免计算成本高昂的矩阵乘法 $A^2$，可以通过利用矩阵 $A$ 的 LU 分解来找到一个高效的解。\n\n给定一个 $3 \\times 3$ 矩阵 $A$ 的 LU 分解，使得 $A=LU$。矩阵 $L$ 是一个单位下三角矩阵，而 $U$ 是一个上三角矩阵。具体的矩阵和向量 $\\mathbf{b}$ 如下：\n\n$L = \\begin{pmatrix} 1 & 0 & 0 \\\\ 2 & 1 & 0 \\\\ -1 & 3 & 1 \\end{pmatrix}$，$U = \\begin{pmatrix} 2 & 1 & -1 \\\\ 0 & 3 & 1 \\\\ 0 & 0 & -2 \\end{pmatrix}$，以及 $\\mathbf{b} = \\begin{pmatrix} -3 \\\\ -45 \\\\ -90 \\end{pmatrix}$\n\n你的任务是求解向量 $\\mathbf{x} = \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\end{pmatrix}$。\n\n请将你的最终答案表示为行矩阵的形式 $\\begin{pmatrix} x_1 & x_2 & x_3 \\end{pmatrix}$。",
            "solution": "我们需要求解 $A^{2}\\mathbf{x}=\\mathbf{b}$，其中 $A=LU$。引入辅助向量 $\\mathbf{y}$，定义为 $\\mathbf{y}=A\\mathbf{x}$。那么有 $A\\mathbf{y}=\\mathbf{b}$。因此，我们可以利用矩阵 $A$ 的 LU 分解来求解两个具有相同系数矩阵 $A$ 的连续线性系统：\n1) 求解 $A\\mathbf{y}=\\mathbf{b}$。\n2) 求解 $A\\mathbf{x}=\\mathbf{y}$。\n\n由于 $A=LU$，每次求解 $A\\mathbf{w}=\\mathbf{r}$ 都通过以下步骤完成：首先求解 $L\\mathbf{z}=\\mathbf{r}$ (前向代入)，然后求解 $U\\mathbf{w}=\\mathbf{z}$ (回代)。\n\n首先求解 $A\\mathbf{y}=\\mathbf{b}$，其中 $L=\\begin{pmatrix} 1 & 0 & 0 \\\\ 2 & 1 & 0 \\\\ -1 & 3 & 1 \\end{pmatrix}$，$U=\\begin{pmatrix} 2 & 1 & -1 \\\\ 0 & 3 & 1 \\\\ 0 & 0 & -2 \\end{pmatrix}$，以及 $\\mathbf{b}=\\begin{pmatrix} -3 \\\\ -45 \\\\ -90 \\end{pmatrix}$。\n\n对 $L\\mathbf{z}=\\mathbf{b}$ 进行前向代入：\n$$\n\\begin{cases}\nz_{1}=-3,\\\\\n2z_{1}+z_{2}=-45 \\;\\Rightarrow\\; z_{2}=-39,\\\\\n-z_{1}+3z_{2}+z_{3}=-90 \\;\\Rightarrow\\; z_{3}=24,\n\\end{cases}\n$$\n所以 $\\mathbf{z}=\\begin{pmatrix}-3\\\\-39\\\\24\\end{pmatrix}$。\n\n对 $U\\mathbf{y}=\\mathbf{z}$ 进行回代：\n$$\n\\begin{cases}\n-2y_{3}=24 \\;\\Rightarrow\\; y_{3}=-12,\\\\\n3y_{2}+y_{3}=-39 \\;\\Rightarrow\\; y_{2}=-9,\\\\\n2y_{1}+y_{2}-y_{3}=-3 \\;\\Rightarrow\\; y_{1}=-3,\n\\end{cases}\n$$\n所以 $\\mathbf{y}=\\begin{pmatrix}-3\\\\-9\\\\-12\\end{pmatrix}$。\n\n接下来求解 $A\\mathbf{x}=\\mathbf{y}$。\n\n对 $L\\mathbf{t}=\\mathbf{y}$ 进行前向代入：\n$$\n\\begin{cases}\nt_{1}=-3,\\\\\n2t_{1}+t_{2}=-9 \\;\\Rightarrow\\; t_{2}=-3,\\\\\n-t_{1}+3t_{2}+t_{3}=-12 \\;\\Rightarrow\\; t_{3}=-6,\n\\end{cases}\n$$\n所以 $\\mathbf{t}=\\begin{pmatrix}-3\\\\-3\\\\-6\\end{pmatrix}$。\n\n对 $U\\mathbf{x}=\\mathbf{t}$ 进行回代：\n$$\n\\begin{cases}\n-2x_{3}=-6 \\;\\Rightarrow\\; x_{3}=3,\\\\\n3x_{2}+x_{3}=-3 \\;\\Rightarrow\\; x_{2}=-2,\\\\\n2x_{1}+x_{2}-x_{3}=-3 \\;\\Rightarrow\\; x_{1}=1,\n\\end{cases}\n$$\n所以 $\\mathbf{x}=\\begin{pmatrix}1\\\\-2\\\\3\\end{pmatrix}$。\n\n因此，所求的行矩阵是 $\\begin{pmatrix}1 & -2 & 3\\end{pmatrix}$。",
            "answer": "$$\\boxed{\\begin{pmatrix} 1 & -2 & 3 \\end{pmatrix}}$$"
        }
    ]
}