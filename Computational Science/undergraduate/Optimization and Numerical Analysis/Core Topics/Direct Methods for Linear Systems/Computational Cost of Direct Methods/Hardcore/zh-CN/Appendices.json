{
    "hands_on_practices": [
        {
            "introduction": "直接法求解稠密线性方程组的计算成本通常与矩阵维度的三次方成正比，即 $O(N^3)$。理解这种“立方”关系对于规划和预测大规模科学计算所需的时间至关重要。本练习将通过一个实际的工程问题，帮助你直观地感受当问题规模扩大时，计算时间是如何急剧增加的 。",
            "id": "2160731",
            "problem": "一名工程专业的学生正在使用一款自研的有限元法（FEM）软件进行结构分析。模拟的核心是求解一个大型稠密线性方程组 $A\\mathbf{x} = \\mathbf{b}$，其中方阵 $A$ 的大小为 $N \\times N$。该软件使用直接求解器，对于此类方法，已知所需计算时间与矩阵维度 $N$ 的立方成正比。\n\n为了进行初步分析，该学生运行了一个具有 $N_1 = 8,000$ 个自由度的粗糙模型。在她的工作站上，求解器耗时 $T_1 = 10.0$ 秒完成计算。为了在最终报告中获得更精确的结果，她必须运行一个具有 $N_2 = 12,000$ 个自由度的精细模型。\n\n假设计算性能完全由这种关系决定，且所有其他因素都可以忽略不计，请估算求解器运行精细模型所需的时间。答案以秒为单位，并四舍五入到三位有效数字。",
            "solution": "问题陈述计算时间 $T$ 与矩阵维度 $N$ 的立方成正比。我们可以将此关系用数学公式表示为：\n$$T = C N^{3}$$\n其中 $C$ 是一个比例常数，其值取决于具体的硬件和软件实现。\n\n我们有两种情况：一个粗糙模型和一个精细模型。我们用下标 1 表示粗糙模型的参数，用下标 2 表示精细模型的参数。\n\n对于粗糙模型，我们有：\n$$T_1 = C N_1^{3}$$\n\n对于精细模型，我们有：\n$$T_2 = C N_2^{3}$$\n\n已知 $T_1 = 10.0$ 秒，$N_1 = 8,000$，$N_2 = 12,000$。我们需要求出 $T_2$。为了消去未知常数 $C$，我们可以将两个方程相除：\n$$\\frac{T_2}{T_1} = \\frac{C N_2^{3}}{C N_1^{3}} = \\left(\\frac{N_2}{N_1}\\right)^{3}$$\n\n现在，我们可以解出 $T_2$：\n$$T_2 = T_1 \\left(\\frac{N_2}{N_1}\\right)^{3}$$\n\n我们将给定值代入此方程。首先，我们计算维度的比率：\n$$\\frac{N_2}{N_1} = \\frac{12,000}{8,000} = \\frac{12}{8} = \\frac{3}{2} = 1.5$$\n\n现在，我们将这个比率和 $T_1$ 的值代入 $T_2$ 的方程中：\n$$T_2 = 10.0 \\times (1.5)^{3}$$\n\n我们计算 $(1.5)^{3}$ 的值：\n$$(1.5)^{3} = 1.5 \\times 1.5 \\times 1.5 = 2.25 \\times 1.5 = 3.375$$\n\n最后，我们计算 $T_2$：\n$$T_2 = 10.0 \\times 3.375 = 33.75$$\n\n问题要求答案四舍五入到三位有效数字。计算值为 $33.75$。前三位有效数字是 3、3 和 7。下一位数字是 5，所以我们对最后一位有效数字进行四舍五入。\n$$T_2 \\approx 33.8$$\n精细模型的估算时间为 33.8 秒。",
            "answer": "$$\\boxed{33.8}$$"
        },
        {
            "introduction": "尽管通用直接法的 $O(N^3)$ 成本可能看起来很高，但当矩阵具有特殊结构时，我们可以设计出更高效的算法。三对角矩阵是常出现在物理和工程模拟中的一种典型稀疏矩阵。本练习将引导你逐一计算专门针对三对角系统的算法中的每一步算术运算，从而揭示利用矩阵结构能够将计算成本从 $O(N^3)$ 大幅降低到 $O(N)$ 的原因 。",
            "id": "2160762",
            "problem": "考虑求解线性方程组 $A\\mathbf{x} = \\mathbf{d}$ 的问题，其中 $A$ 是一个非奇异的 $n \\times n$ 三对角矩阵，$\\mathbf{x}$ 和 $\\mathbf{d}$ 是大小为 $n$ 的列向量。三对角矩阵是指只有主对角线、第一下对角线（主对角线正下方）和第一上对角线（主对角线正上方）上的元素非零的矩阵。\n\n求解此类系统的一个高效算法包括两个阶段：\n\n1.  **前向消元（Forward Elimination）：** 此阶段将矩阵 $A$ 转换为一个上双对角矩阵（非零元素仅在主对角线和上对角线上）。这是通过从第二行（$i=2$）迭代到最后一行（$i=n$）来实现的。对于每一行 $i$，算法执行一次行操作以消除下对角线元素 $A_{i, i-1}$。具体做法是，基于元素 $A_{i, i-1}$ 和前一行（可能已被修改）的主对角线元素 $A_{i-1, i-1}$ 计算一个乘数，然后从第 $i$ 行中减去第 $i-1$ 行的该倍数。此操作会修改主对角线元素 $A_{i,i}$ 和右侧向量中对应的元素 $d_i$。在此过程中，上对角线元素不会被修改。\n\n2.  **回代（Backward Substitution）：** 然后求解得到的上双对角系统以得到向量 $\\mathbf{x}$。首先计算最后一个分量 $x_n$，然后从 $i = n-1$ 向下迭代到 $1$ 以求解 $\\mathbf{x}$ 的其余分量。\n\n您的任务是确定使用此特定算法求解该系统所需的基本算术运算（即加、减、乘、除）的确切总数。假设不会遇到除以零的情况。\n\n请用一个关于 $n$ 的封闭形式解析表达式给出您的答案。",
            "solution": "设三对角矩阵的下对角线元素为 $\\{a_{i}\\}_{i=2}^{n}$，主对角线元素为 $\\{b_{i}\\}_{i=1}^{n}$，上对角线元素为 $\\{c_{i}\\}_{i=1}^{n-1}$，右侧向量为 $\\{d_{i}\\}_{i=1}^{n}$。\n\n前向消元过程对 $i=2,3,\\dots,n$ 如下进行。首先计算乘数\n$$\nm_{i}=\\frac{a_{i}}{b_{i-1}},\n$$\n这需要一次除法运算。然后更新主对角线元素和右侧向量：\n$$\nb_{i}\\leftarrow b_{i}-m_{i}c_{i-1},\\qquad d_{i}\\leftarrow d_{i}-m_{i}d_{i-1}.\n$$\n这两项更新各需要一次乘法和一次减法。上对角线元素 $c_{i}$ 不被修改。因此，对于每个 $i$，共有 $1$ 次除法、$2$ 次乘法和 $2$ 次减法，总计 $5$ 次运算。由于此循环从 $i=2$ 到 $n$ 运行，前向消元的成本为\n$$\n5(n-1).\n$$\n\n回代过程求解得到的上双对角系统。首先计算\n$$\nx_{n}=\\frac{d_{n}}{b_{n}},\n$$\n这需要一次除法。然后对 $i=n-1,n-2,\\dots,1$ 计算\n$$\nx_{i}=\\frac{d_{i}-c_{i}x_{i+1}}{b_{i}},\n$$\n这需要一次乘法（$c_{i}x_{i+1}$）、一次减法（$d_{i}-c_{i}x_{i+1}$）和一次除以 $b_{i}$ 的除法，即每个索引需要 $3$ 次运算。因此，这个回代过程的成本为\n$$\n1+3(n-1)=3n-2\n$$\n次运算。\n\n将两个阶段的运算次数相加，得到基本算术运算的确切总数：\n$$\n5(n-1)+(3n-2)=8n-7.\n$$\n\n此算法中没有明确的加法运算；减法、乘法和除法如上所述单独计数。该计数对所有 $n\\geq 1$ 均有效，并与边界情况相符（例如，当 $n=1$ 时，只执行一次除法）。",
            "answer": "$$\\boxed{8n-7}$$"
        },
        {
            "introduction": "现实世界中的数值任务往往涉及多个步骤，需要将不同的计算模块组合起来。本练习以机器学习中常用的岭回归问题为例，要求你分析一个完整算法的总计算成本。你将需要综合考虑矩阵乘法、Cholesky 分解以及前后代入等多个阶段的开销，从而为整个算法制定一份“计算预算”。",
            "id": "2160711",
            "problem": "在机器学习领域，岭回归是一种常用于解决线性模型中过拟合问题的技术。它在数学上等价于求解一个 Tikhonov 正则化最小二乘问题。对于一个给定的超定线性方程组 $Ax=b$，其中 $A$ 是一个 $m \\times n$ 的稠密输入特征矩阵（包含 $m$ 个样本和 $n$ 个特征，且 $m > n$），$b$ 是一个 $m \\times 1$ 的观测向量，参数向量 $x$ 的正则化解可以通过求解以下正规方程得到：\n$$\n(A^T A + \\lambda I)x = A^T b\n$$\n此处，$\\lambda$ 是一个正标量正则化参数，$I$ 是 $n \\times n$ 的单位矩阵。\n\n考虑一种求解该系统的直接法，其按以下顺序进行：\n1.  计算矩阵 $M = A^T A$。\n2.  计算向量 $c = A^T b$。\n3.  构造矩阵 $B = M + \\lambda I$。\n4.  求解线性系统 $Bx = c$，首先计算 $B$ 的 Cholesky 分解（即 $B = L L^T$），然后通过一次前向替换和一次后向替换求解 $x$。\n\n你的任务是确定这整个过程的总计算成本。在你的计算中，给定了基本操作的以下标准成本，其中“浮点运算”（flop）定义为单个浮点加法、减法、乘法或除法。\n\n-   一个 $p \\times q$ 矩阵乘以一个 $q \\times r$ 矩阵的成本是 $2pqr$ 次浮点运算。然而，如果得到的 $p \\times r$ 矩阵已知是对称的且 $p=r$，则通过只计算唯一的元素，成本可以减少到 $pqr$ 次浮点运算。\n-   计算一个对称正定的 $k \\times k$ 矩阵的 Cholesky 分解的成本大约是 $\\frac{1}{3}k^3$ 次浮点运算。\n-   求解一个 $k \\times k$ 三角系统（即前向或后向替换）的成本大约是 $k^2$ 次浮点运算。\n-   你可以忽略矩阵加法的计算成本，例如构造 $B = M + \\lambda I$。\n\n将总浮点运算次数表示为关于 $m$ 和 $n$ 的多项式表达式。",
            "solution": "我们通过对每个步骤的成本求和来计算总浮点运算次数，使用给定的成本模型并在适用的地方利用对称性。\n\n首先，计算 $M = A^{T}A$。这里，$A^{T}$ 是 $n \\times m$ 矩阵，$A$ 是 $m \\times n$ 矩阵，所以朴素的矩阵乘法成本将是 $2 n m n = 2 m n^{2}$ 次浮点运算。然而，由于 $A^{T}A$ 是对称的，并且结果是 $n \\times n$ 矩阵，我们可以通过只计算唯一的元素将成本降低到 $n m n = m n^{2}$ 次浮点运算。\n\n其次，计算 $c = A^{T} b$。这是一个 $n \\times m$ 矩阵乘以一个 $m \\times 1$ 向量，成本为 $2 n m = 2 m n$ 次浮点运算。\n\n第三，构造 $B = M + \\lambda I$。问题陈述允许我们忽略此矩阵加法的成本，因此我们为此步骤计算 $0$ 次浮点运算。\n\n第四，执行 Cholesky 分解 $B = L L^{T}$，其中 $B$ 是 $n \\times n$ 的对称正定矩阵。成本大约是 $\\frac{1}{3} n^{3}$ 次浮点运算。\n\n第五，求解两个三角系统 $L y = c$（前向替换）和 $L^{T} x = y$（后向替换）。每个三角系统的求解成本大约为 $n^{2}$ 次浮点运算，总共为 $2 n^{2}$ 次浮点运算。\n\n将所有贡献相加，得到总计算成本：\n$$\nm n^{2} + 2 m n + \\frac{1}{3} n^{3} + 2 n^{2}.\n$$\n这是一个关于 $m$ 和 $n$ 的多项式，符合要求。",
            "answer": "$$\\boxed{\\frac{1}{3}n^{3}+mn^{2}+2n^{2}+2mn}$$"
        }
    ]
}