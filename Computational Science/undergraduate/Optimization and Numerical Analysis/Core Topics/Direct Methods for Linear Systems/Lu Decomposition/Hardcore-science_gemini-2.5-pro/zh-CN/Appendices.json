{
    "hands_on_practices": [
        {
            "introduction": "LU 分解是数值线性代数中的一项基本技能，它将一个矩阵分解为一个下三角矩阵 $L$ 和一个上三角矩阵 $U$ 的乘积。这个过程类似于将一个整数分解为质因数，为我们提供了一种更简单、更高效地处理矩阵问题的方法。通过这个练习 ，你将亲手操作一个 $3 \\times 3$ 矩阵，通过高斯消元法的步骤，一步步计算出 Doolittle 分解中的 $L$ 和 $U$ 矩阵，从而掌握 LU 分解的核心计算过程。",
            "id": "2186375",
            "problem": "在数值线性代数中，将一个矩阵分解为一个下三角矩阵和一个上三角矩阵的乘积是一项基本运算。这种分解被称为LU分解，并用于各种算法中，例如求解线性方程组。\n\n考虑矩阵 $A$ 如下：\n$$\nA = \\begin{pmatrix} 3  -1  2 \\\\ 6  1  9 \\\\ -9  5  -5 \\end{pmatrix}\n$$\n该矩阵可以唯一地分解为乘积 $A = LU$，其中 $L$ 是一个单位下三角矩阵（即对角线元素为1），$U$ 是一个上三角矩阵。这两个 $3 \\times 3$ 矩阵的一般形式为：\n$$\nL = \\begin{pmatrix} 1  0  0 \\\\ l_{21}  1  0 \\\\ l_{31}  l_{32}  1 \\end{pmatrix}, \\quad U = \\begin{pmatrix} u_{11}  u_{12}  u_{13} \\\\ 0  u_{22}  u_{23} \\\\ 0  0  u_{33} \\end{pmatrix}\n$$\n对于给定的矩阵 $A$，确定矩阵 $L$ 的非对角线元素和矩阵 $U$ 的所有元素的数值。将你的最终答案表示为一个单行矩阵，其中包含按特定顺序 $(l_{21}, l_{31}, l_{32}, u_{11}, u_{12}, u_{13}, u_{22}, u_{23}, u_{33})$排列的这九个值。将所有分数值表示为其最简形式。",
            "solution": "我们使用Doolittle LU分解法，其中 $L$ 是单位下三角矩阵，$U$ 是上三角矩阵，满足 $A=LU$。对于\n$$\nL = \\begin{pmatrix} 1  0  0 \\\\ l_{21}  1  0 \\\\ l_{31}  l_{32}  1 \\end{pmatrix},\\quad\nU = \\begin{pmatrix} u_{11}  u_{12}  u_{13} \\\\ 0  u_{22}  u_{23} \\\\ 0  0  u_{33} \\end{pmatrix},\n$$\n乘积 $LU$ 按行给出：\n- 第1行：$[u_{11},u_{12},u_{13}]=[3,-1,2]$，因此 $u_{11}=3$, $u_{12}=-1$, $u_{13}=2$。\n- 第2行，第1列：$l_{21}u_{11}=a_{21}=6$，所以 $l_{21}=\\frac{a_{21}}{u_{11}}=\\frac{6}{3}=2$。\n- 第3行，第1列：$l_{31}u_{11}=a_{31}=-9$，所以 $l_{31}=\\frac{a_{31}}{u_{11}}=\\frac{-9}{3}=-3$。\n- 第2行，第2列：$l_{21}u_{12}+u_{22}=a_{22}=1$，所以 $u_{22}=a_{22}-l_{21}u_{12}=1-2(-1)=3$。\n- 第2行，第3列：$l_{21}u_{13}+u_{23}=a_{23}=9$，所以 $u_{23}=a_{23}-l_{21}u_{13}=9-2\\cdot 2=5$。\n- 第3行，第2列：$l_{31}u_{12}+l_{32}u_{22}=a_{32}=5$，所以 $l_{32}=\\frac{a_{32}-l_{31}u_{12}}{u_{22}}=\\frac{5-(-3)(-1)}{3}=\\frac{5-3}{3}=\\frac{2}{3}$。\n- 第3行，第3列：$l_{31}u_{13}+l_{32}u_{23}+u_{33}=a_{33}=-5$，所以\n$$\nu_{33}=a_{33}-l_{31}u_{13}-l_{32}u_{23}=-5-(-3\\cdot 2)-\\left(\\frac{2}{3}\\cdot 5\\right)=-5+6-\\frac{10}{3}=1-\\frac{10}{3}=-\\frac{7}{3}.\n$$\n\n因此，按要求的顺序 $(l_{21}, l_{31}, l_{32}, u_{11}, u_{12}, u_{13}, u_{22}, u_{23}, u_{33})$，这些值为\n$$\n\\begin{pmatrix}\n2  -3  \\frac{2}{3}  3  -1  2  3  5  -\\frac{7}{3}\n\\end{pmatrix}.\n$$",
            "answer": "$$\\boxed{\\begin{pmatrix}2  -3  \\frac{2}{3}  3  -1  2  3  5  -\\frac{7}{3}\\end{pmatrix}}$$"
        },
        {
            "introduction": "虽然标准的 LU 分解很强大，但当主元位置（对角线元素）为零或非常小时，算法可能会失败或导致数值不稳定。为了解决这个问题，我们引入了部分选主元（partial pivoting）的策略，即在消元前通过行交换将绝对值最大的元素作为主元。这个练习  将通过一个简单的 $2 \\times 2$ 矩阵，展示为何以及如何进行 pivoting，并引入置換矩阵 $P$ 的概念，最终得到更稳健的 $PA=LU$ 分解形式。",
            "id": "2186343",
            "problem": "考虑矩阵 $A$ 如下：\n$$A = \\begin{pmatrix} 0  -3 \\\\ 2  6 \\end{pmatrix}$$\n矩阵的基本分解方法之一是带部分主元法的LU分解（Lower-Upper decomposition）。该过程找到一个置换矩阵 $P$、一个单位下三角矩阵 $L$（对角线元素为1）和一个上三角矩阵 $U$，使得它们满足方程 $PA = LU$。\n\n对于给定的矩阵 $A$，以下哪个选项正确地给出了矩阵三元组 $(P, L, U)$？\n\nA. $P = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}$, $L = \\begin{pmatrix} 1  0 \\\\ 1  1 \\end{pmatrix}$, $U = \\begin{pmatrix} 2  6 \\\\ 0  -3 \\end{pmatrix}$\n\nB. $P = \\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix}$, $L = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}$, $U = \\begin{pmatrix} 2  6 \\\\ 0  -3 \\end{pmatrix}$\n\nC. $P = \\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix}$, $L = \\begin{pmatrix} 1  0 \\\\ 3  1 \\end{pmatrix}$, $U = \\begin{pmatrix} 2  6 \\\\ 0  -3 \\end{pmatrix}$\n\nD. $P = \\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix}$, $L = \\begin{pmatrix} 1  0 \\\\ 0  1 \\end{pmatrix}$, $U = \\begin{pmatrix} 2  6 \\\\ 0  3 \\end{pmatrix}$",
            "solution": "我们对矩阵\n$$\nA=\\begin{pmatrix}0  -3 \\\\ 2  6\\end{pmatrix}\n$$\n执行带部分主元法的LU分解。\n部分主元法在第一列中选择绝对值最大的元素所在行作为主元行。第一列的元素是 $|0|$ 和 $|2|$，因此主元在第2行。所以，我们交换第1行和第2行来构造 $PA$，其中置换矩阵为\n$$\nP=\\begin{pmatrix}0  1 \\\\ 1  0\\end{pmatrix}, \\quad PA = P A = \\begin{pmatrix}2  6 \\\\ 0  -3\\end{pmatrix}.\n$$\n现在，我们将 $PA$ 分解为 $LU$，其中 $L$ 是单位下三角矩阵，$U$ 是上三角矩阵，此步不再进行主元选择。对于一个 $2\\times 2$ 矩阵，乘数为\n$$\n\\ell_{21}=\\frac{(PA)_{21}}{(PA)_{11}}=\\frac{0}{2}=0.\n$$\n因此\n$$\nL=\\begin{pmatrix}1  0 \\\\ 0  1\\end{pmatrix}, \\quad U=\\begin{pmatrix}2  6 \\\\ 0  -3\\end{pmatrix}.\n$$\n它们满足 $PA=LU$：\n$$\n\\begin{pmatrix}0  1 \\\\ 1  0\\end{pmatrix}\\begin{pmatrix}0  -3 \\\\ 2  6\\end{pmatrix}\n=\\begin{pmatrix}2  6 \\\\ 0  -3\\end{pmatrix}\n=\\begin{pmatrix}1  0 \\\\ 0  1\\end{pmatrix}\\begin{pmatrix}2  6 \\\\ 0  -3\\end{pmatrix}.\n$$\n与选项比较，这对应于选项B。选项A和C中列出的 $P$、$L$、$U$ 不满足 $PA=LU$，而选项D中 $U$ 的 $(2,2)$ 位置元素的符号不正确。",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "LU 分解的主要应用之一是高效求解线性方程组 $Ax=b$。一旦我们将 $A$ 分解为 $LU$，原问题就转化为两个更简单的三角系统：$Ly=b$ 和 $Ux=y$。这个练习  专注于第一步，即“前向替换法”（forward substitution），它用于求解下三角系统 $Ly=b$。通过分析伪代码，你将从算法的层面理解如何利用 $L$ 矩阵的结构来高效地计算中间向量 $y$，这是将理论付诸实践的关键一步。",
            "id": "2186371",
            "problem": "在数值线性代数中，LU分解（Lower-Upper decomposition）是求解线性方程组的一种常用方法。一个方阵 $A$ 被分解为一个下三角矩阵 $L$ 和一个上三角矩阵 $U$ 的乘积，使得 $A=LU$。为了求解方程组 $Ax=b$，首先求解 $Ly=b$ 得到一个中间向量 $y$（这个过程称为前向替换），然后求解 $Ux=y$ 得到最终解 $x$（这个过程称为后向替换）。\n\n考虑求解方程组 $Ly = b$ 的前向替换步骤。给定一个非奇异的 $n \\times n$ 下三角矩阵 $L$ 和一个 $n \\times 1$ 的列向量 $b$。目标是计算未知的 $n \\times 1$ 列向量 $y$。矩阵和向量的分量使用基于1的索引表示，即 $L_{ij}$、$b_i$ 和 $y_i$，其中索引 $i$ 和 $j$ 的范围是从1到 $n$。\n\n下面是为计算向量 $y$ 提出的四段不同的伪代码。以下哪个选项正确地实现了前向替换算法？\n\nA.\n```\nfor i from 1 to n:\n  y[i] = b[i] / L[i,i]\n  for j from 1 to i-1:\n    y[i] = y[i] - L[i,j] * y[j]\n```\n\nB.\n```\nfor i from n down to 1:\n  sum = 0\n  for j from i+1 to n:\n    sum = sum + L[i,j] * y[j]\n  y[i] = (b[i] - sum) / L[i,i]\n```\n\nC.\n```\nfor i from 1 to n:\n  sum = b[i]\n  for j from 1 to i-1:\n    sum = sum - L[i,j] * y[j]\n  y[i] = sum / L[i,i]\n```\n\nD.\n```\nfor i from 1 to n:\n  sum = b[i]\n  for j from 1 to i-1:\n    sum = sum - L[i,j] * b[j]\n  y[i] = sum / L[i,i]\n```",
            "solution": "我们要求解下三角方程组 $Ly=b$，其中 $L$ 是非奇异的。因为 $L$ 是下三角矩阵，对于每个行索引 $i$，其非零元素满足当 $ji$ 时 $L_{ij}=0$。$Ly=b$ 的第 $i$ 个方程因此是\n$$\n\\sum_{j=1}^{i} L_{ij} y_{j} = b_{i}.\n$$\n这可以写成\n$$\nL_{ii} y_{i} + \\sum_{j=1}^{i-1} L_{ij} y_{j} = b_{i}.\n$$\n由于 $L_{ii} \\neq 0$（非奇异性），我们可以解出 $y_i$：\n$$\ny_{i} = \\frac{b_{i} - \\sum_{j=1}^{i-1} L_{ij} y_{j}}{L_{ii}}.\n$$\n这个递推关系表明 $y_i$ 仅依赖于先前已计算出的 $y_j$（其中 $ji$）。因此，我们可以按顺序从 $i=1$ 到 $n$ 计算 $y_i$。\n\n让我们分析一下伪代码选项：\n- **A**: 此代码首先将 `y[i]` 设置为 `b[i] / L[i,i]`，然后从中减去项。这是不正确的，因为 `y[j]` 还没有乘以 `L[i,j]` 并从 `b[i]` 中减去 *之前* 进行除法。\n- **B**: 此代码从 `n` 向下迭代到 `1`。这是后向替换的循环结构，用于求解上三角系统，不适用于前向替换。\n- **C**: 此代码从 `i=1` 到 `n` 迭代。对于每个 `i`，它初始化一个 `sum` 为 `b[i]`。然后，内循环从 `j=1` 到 `i-1`，从 `sum` 中减去 `L[i,j] * y[j]`。这正确地计算了分子 $b_{i} - \\sum_{j=1}^{i-1} L_{ij} y_{j}$。最后，它用 `L[i,i]` 来除以这个和，得到 `y[i]`。这与上面的公式完全匹配。\n- **D**: 此代码在内循环中使用 `b[j]` 而不是 `y[j]`。这是错误的，因为计算 $y_i$ 需要先前计算出的 $y_j$ 值，而不是 $b$ 的分量。\n\n因此，选项C是前向替换算法的正确实现。",
            "answer": "$$\\boxed{C}$$"
        }
    ]
}