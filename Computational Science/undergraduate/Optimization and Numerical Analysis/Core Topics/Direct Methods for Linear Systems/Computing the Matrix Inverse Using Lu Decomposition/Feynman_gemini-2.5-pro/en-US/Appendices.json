{
    "hands_on_practices": [
        {
            "introduction": "In many scientific and engineering applications, we only need a specific column of a matrix's inverse, not the entire inverse matrix. Calculating the full inverse is computationally expensive and often unnecessary. A much more efficient approach is to solve the linear system $A\\mathbf{x} = \\mathbf{e}_j$ to find the $j$-th column, $\\mathbf{x}$. This exercise demonstrates how a pre-computed $LU$ decomposition makes this task remarkably simple, reducing it to a sequence of forward and backward substitutions. ",
            "id": "2160990",
            "problem": "An invertible $3 \\times 3$ matrix $A$ has a known Lower-Upper (LU) decomposition, $A = LU$, where the matrices $L$ (unit lower triangular) and $U$ (upper triangular) are given by:\n$$\nL = \\begin{pmatrix} 1 & 0 & 0 \\\\ 2 & 1 & 0 \\\\ -1 & 3 & 1 \\end{pmatrix}, \\quad U = \\begin{pmatrix} 2 & 1 & 3 \\\\ 0 & -1 & 1 \\\\ 0 & 0 & 4 \\end{pmatrix}\n$$\nDetermine the third column of the inverse matrix $A^{-1}$. Your answer should be presented as a column vector.",
            "solution": "To find the third column of $A^{-1}$, solve $A x = e_{3}$, where $e_{3} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}$. Using the LU factorization $A = L U$, we solve in two stages: first $L z = e_{3}$ (forward substitution), then $U x = z$ (back substitution).\n\nLet $z = \\begin{pmatrix} z_{1} \\\\ z_{2} \\\\ z_{3} \\end{pmatrix}$. From\n$$\nL z = \\begin{pmatrix} 1 & 0 & 0 \\\\ 2 & 1 & 0 \\\\ -1 & 3 & 1 \\end{pmatrix} \\begin{pmatrix} z_{1} \\\\ z_{2} \\\\ z_{3} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix},\n$$\nthe equations are\n$$\nz_{1} = 0,\\quad 2 z_{1} + z_{2} = 0 \\implies z_{2} = 0,\\quad -z_{1} + 3 z_{2} + z_{3} = 1 \\implies z_{3} = 1.\n$$\nThus $z = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}$.\n\nNow solve $U x = z$ with $x = \\begin{pmatrix} x_{1} \\\\ x_{2} \\\\ x_{3} \\end{pmatrix}$:\n$$\nU x = \\begin{pmatrix} 2 & 1 & 3 \\\\ 0 & -1 & 1 \\\\ 0 & 0 & 4 \\end{pmatrix} \\begin{pmatrix} x_{1} \\\\ x_{2} \\\\ x_{3} \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 1 \\end{pmatrix}.\n$$\nBack substitution gives\n$$\n4 x_{3} = 1 \\implies x_{3} = \\frac{1}{4},\\quad -x_{2} + x_{3} = 0 \\implies x_{2} = \\frac{1}{4},\\quad 2 x_{1} + x_{2} + 3 x_{3} = 0 \\implies 2 x_{1} + 1 = 0 \\implies x_{1} = -\\frac{1}{2}.\n$$\nTherefore, the third column of $A^{-1}$ is\n$$\n\\begin{pmatrix} -\\frac{1}{2} \\\\ \\frac{1}{4} \\\\ \\frac{1}{4} \\end{pmatrix}.\n$$",
            "answer": "$$\\boxed{\\begin{pmatrix}-\\frac{1}{2}\\\\\\frac{1}{4}\\\\\\frac{1}{4}\\end{pmatrix}}$$"
        },
        {
            "introduction": "While the LU decomposition provides an elegant method for solving linear systems, it can suffer from numerical instability if a pivot element (a diagonal entry of $U$) is zero or very small. To ensure a robust and accurate solution, practical algorithms employ pivoting, which involves reordering the matrix rows to use a larger pivot. This practice extends our understanding by incorporating a permutation matrix $P$ into the factorization, leading to the form $PA=LU$, and shows how to adapt the two-step solving process accordingly. ",
            "id": "2161048",
            "problem": "In many large-scale scientific computing applications, calculating the full inverse of a matrix $A$ is computationally expensive and unnecessary. Often, only specific columns of the inverse $A^{-1}$ are required. The LU decomposition with partial pivoting provides an efficient method to find these columns by solving systems of linear equations.\n\nConsider a non-singular 3x3 matrix $A$, which has been factorized into the form $PA = LU$, where $P$ is a permutation matrix, $L$ is a unit lower triangular matrix, and $U$ is an upper triangular matrix. The specific matrices for this factorization are given as:\n\n$$\nP = \\begin{pmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ 1 & 0 & 0 \\end{pmatrix}, \\quad\nL = \\begin{pmatrix} 1 & 0 & 0 \\\\ 2 & 1 & 0 \\\\ -1 & 3 & 1 \\end{pmatrix}, \\quad\nU = \\begin{pmatrix} 2 & -1 & 4 \\\\ 0 & 3 & 1 \\\\ 0 & 0 & -2 \\end{pmatrix}\n$$\n\nYour task is to determine the third column vector of the inverse matrix, $A^{-1}$. Present your answer as a 3x1 column vector.",
            "solution": "We seek the third column of $A^{-1}$, which is the unique solution $x$ of $A x = e_{3}$, where $e_{3} = (0,0,1)^{T}$.\n\nGiven the LU factorization with partial pivoting $PA = LU$, to solve $A x = b$ we use $PA x = P b$, hence $LU x = P b$. We then solve successively:\n1) $L y = P b$ by forward substitution,\n2) $U x = y$ by back substitution.\n\nHere, $b = e_{3}$, so first compute $P e_{3}$. Since the third column of\n$$\nP = \\begin{pmatrix} 0 & 1 & 0 \\\\ 0 & 0 & 1 \\\\ 1 & 0 & 0 \\end{pmatrix}\n$$\nis $\\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}$, we have\n$$\nP e_{3} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}.\n$$\n\nSolve $L y = P e_{3}$ with\n$$\nL = \\begin{pmatrix} 1 & 0 & 0 \\\\ 2 & 1 & 0 \\\\ -1 & 3 & 1 \\end{pmatrix}, \\quad y = \\begin{pmatrix} y_{1} \\\\ y_{2} \\\\ y_{3} \\end{pmatrix}.\n$$\nThe system is\n$$\n\\begin{cases}\ny_{1} = 0, \\\\\n2 y_{1} + y_{2} = 1, \\\\\n- y_{1} + 3 y_{2} + y_{3} = 0.\n\\end{cases}\n$$\nFrom the first equation $y_{1} = 0$, then $y_{2} = 1$, and finally $y_{3} = -3$. Thus\n$$\ny = \\begin{pmatrix} 0 \\\\ 1 \\\\ -3 \\end{pmatrix}.\n$$\n\nNext solve $U x = y$ with\n$$\nU = \\begin{pmatrix} 2 & -1 & 4 \\\\ 0 & 3 & 1 \\\\ 0 & 0 & -2 \\end{pmatrix}, \\quad x = \\begin{pmatrix} x_{1} \\\\ x_{2} \\\\ x_{3} \\end{pmatrix}.\n$$\nBack substitution gives\n$$\n-2 x_{3} = -3 \\;\\Rightarrow\\; x_{3} = \\frac{3}{2},\n$$\n$$\n3 x_{2} + x_{3} = 1 \\;\\Rightarrow\\; 3 x_{2} + \\frac{3}{2} = 1 \\;\\Rightarrow\\; x_{2} = -\\frac{1}{6},\n$$\n$$\n2 x_{1} - x_{2} + 4 x_{3} = 0 \\;\\Rightarrow\\; 2 x_{1} + \\frac{1}{6} + 6 = 0 \\;\\Rightarrow\\; 2 x_{1} + \\frac{37}{6} = 0 \\;\\Rightarrow\\; x_{1} = -\\frac{37}{12}.\n$$\n\nTherefore, the third column of $A^{-1}$ is\n$$\n\\begin{pmatrix} -\\frac{37}{12} \\\\ -\\frac{1}{6} \\\\ \\frac{3}{2} \\end{pmatrix}.\n$$",
            "answer": "$$\\boxed{\\begin{pmatrix}-\\frac{37}{12}\\\\-\\frac{1}{6}\\\\\\frac{3}{2}\\end{pmatrix}}$$"
        },
        {
            "introduction": "Even with robust methods, solutions to linear systems can contain small errors due to finite-precision floating-point arithmetic. Iterative refinement is a powerful technique for improving the accuracy of an approximate solution. This exercise showcases a key advantage of the $LU$ decomposition: once computed, it can be efficiently reused to solve for a correction vector, allowing you to systematically refine your result with minimal additional computational cost. ",
            "id": "2161022",
            "problem": "A numerical analyst is working on a problem that requires finding the second column of the inverse of a given 3x3 matrix $A$. The matrix is defined as:\n$$\nA = \\begin{pmatrix} 2 & -1 & 3 \\\\ 6 & 1 & 10 \\\\ -2 & -7 & -7 \\end{pmatrix}\n$$\nThe analyst has already computed the Lower-Upper (LU) decomposition of $A$ such that $A=LU$, where $L$ is a unit lower triangular matrix and $U$ is an upper triangular matrix. The matrices are:\n$$\nL = \\begin{pmatrix} 1 & 0 & 0 \\\\ 3 & 1 & 0 \\\\ -1 & -2 & 1 \\end{pmatrix}, \\quad U = \\begin{pmatrix} 2 & -1 & 3 \\\\ 0 & 4 & 1 \\\\ 0 & 0 & -2 \\end{pmatrix}\n$$\nAn initial, low-precision computation has yielded an approximate solution for the second column of $A^{-1}$, denoted as $x^{(0)}$:\n$$\nx^{(0)} = \\begin{pmatrix} 1.7 \\\\ 0.6 \\\\ -1.1 \\end{pmatrix}\n$$\nTo improve this approximation, the analyst applies one step of an iterative refinement procedure. For an approximation $x^{(k)}$, the next approximation $x^{(k+1)}$ is found by the following steps:\n1. Compute the residual vector $r = e_2 - A x^{(k)}$, where $e_2$ is the standard basis vector $\\begin{pmatrix} 0 & 1 & 0 \\end{pmatrix}^T$.\n2. Solve the linear system $A \\delta = r$ for the correction vector $\\delta$.\n3. Update the solution: $x^{(k+1)} = x^{(k)} + \\delta$.\n\nYour task is to calculate the first component of the refined vector, $x^{(1)}$, obtained by applying this procedure once to the initial approximation $x^{(0)}$. Use the provided LU decomposition to efficiently solve the linear system in step 2.\n\nRound your final answer to four significant figures.",
            "solution": "We are refining the approximation to the solution of $A x = e_{2}$, where\n$$\nA = \\begin{pmatrix} 2 & -1 & 3 \\\\ 6 & 1 & 10 \\\\ -2 & -7 & -7 \\end{pmatrix}, \\quad L = \\begin{pmatrix} 1 & 0 & 0 \\\\ 3 & 1 & 0 \\\\ -1 & -2 & 1 \\end{pmatrix}, \\quad U = \\begin{pmatrix} 2 & -1 & 3 \\\\ 0 & 4 & 1 \\\\ 0 & 0 & -2 \\end{pmatrix}, \\quad x^{(0)} = \\begin{pmatrix} 1.7 \\\\ 0.6 \\\\ -1.1 \\end{pmatrix}, \\quad e_{2}=\\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}.\n$$\nStep 1 (residual): Compute $r = e_{2} - A x^{(0)}$.\nFirst compute $A x^{(0)}$:\n$$\nA x^{(0)} = \\begin{pmatrix}\n2\\cdot 1.7 + (-1)\\cdot 0.6 + 3\\cdot (-1.1) \\\\\n6\\cdot 1.7 + 1\\cdot 0.6 + 10\\cdot (-1.1) \\\\\n-2\\cdot 1.7 + (-7)\\cdot 0.6 + (-7)\\cdot (-1.1)\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n-0.5 \\\\ -0.2 \\\\ 0.1\n\\end{pmatrix}.\n$$\nThus\n$$\nr = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} - \\begin{pmatrix} -0.5 \\\\ -0.2 \\\\ 0.1 \\end{pmatrix} = \\begin{pmatrix} 0.5 \\\\ 1.2 \\\\ -0.1 \\end{pmatrix}.\n$$\nStep 2 (solve $A\\delta=r$ using $LU$): Solve $L y = r$, then $U \\delta = y$.\nForward substitution $L y = r$:\n$$\ny_{1} = 0.5,\\quad 3 y_{1} + y_{2} = 1.2 \\Rightarrow y_{2} = -0.3,\\quad -y_{1} - 2 y_{2} + y_{3} = -0.1 \\Rightarrow y_{3} = -0.2.\n$$\nSo $y = \\begin{pmatrix} 0.5 \\\\ -0.3 \\\\ -0.2 \\end{pmatrix}$.\nBack substitution $U \\delta = y$:\n$$\n-2 \\delta_{3} = -0.2 \\Rightarrow \\delta_{3} = 0.1,\\quad 4 \\delta_{2} + \\delta_{3} = -0.3 \\Rightarrow \\delta_{2} = -0.1,\n$$\n$$\n2 \\delta_{1} - \\delta_{2} + 3 \\delta_{3} = 0.5 \\Rightarrow 2 \\delta_{1} + 0.1 + 0.3 = 0.5 \\Rightarrow \\delta_{1} = 0.05.\n$$\nThus\n$$\n\\delta = \\begin{pmatrix} 0.05 \\\\ -0.1 \\\\ 0.1 \\end{pmatrix}.\n$$\nStep 3 (update): $x^{(1)} = x^{(0)} + \\delta$ gives\n$$\nx^{(1)} = \\begin{pmatrix} 1.7 \\\\ 0.6 \\\\ -1.1 \\end{pmatrix} + \\begin{pmatrix} 0.05 \\\\ -0.1 \\\\ 0.1 \\end{pmatrix} = \\begin{pmatrix} 1.75 \\\\ 0.5 \\\\ -1.0 \\end{pmatrix}.\n$$\nThe first component is $1.75$, which rounded to four significant figures is $1.750$.",
            "answer": "$$\\boxed{1.750}$$"
        }
    ]
}