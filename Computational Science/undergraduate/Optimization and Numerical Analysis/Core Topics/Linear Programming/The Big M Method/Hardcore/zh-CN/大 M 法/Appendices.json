{
    "hands_on_practices": [
        {
            "introduction": "大 M 法的核心在于通过在目标函数中引入一个巨大的惩罚项 $M$ 来处理人工变量。正确构建初始单纯形表，特别是目标函数所在的第 0 行，是确保算法正确启动的关键。这个练习将检验你是否能够为一个最小化问题正确设置初始单纯形表，这需要准确理解如何计算和表示与大 $M$ 相关的惩罚成本 。",
            "id": "2209163",
            "problem": "一位运筹学分析师的任务是使用大M法求解以下线性规划（LP）问题。\n\n最小化 $Z = 4x_1 + x_2$\n\n约束条件为：\n1.  $3x_1 + x_2 = 3$\n2.  $4x_1 + 3x_2 \\ge 6$\n3.  $x_1 + 2x_2 \\le 4$\n4.  $x_1, x_2 \\ge 0$\n\n通过引入一个剩余变量 $s_1$、一个松弛变量 $s_2$ 和人工变量 $a_1$、$a_2$ 将问题转换为标准形式后，该分析师提出了以下初始单纯形表。目标函数在第0行中以 $Z + \\sum(z_j - c_j)x_j = Z_0$ 的形式表示，其中 $M$ 是一个非常大的正数。各列分别对应变量 $Z, x_1, x_2, s_1, s_2, a_1, a_2$ 和右端项（RHS）。\n\n| 基 | Z | $x_1$ | $x_2$ | $s_1$ | $s_2$ | $a_1$ | $a_2$ | 右端项 |\n| :---: |:-:|:-----------:|:-----------:|:-----:|:-----:|:-----:|:-----:|:------:|\n| 第0行 | 1 | $-(7M+4)$ | $-(4M+1)$ | $M$ | $0$ | $0$ | $0$ | $-9M$ |\n| $a_1$ | 0 | $3$ | $1$ | $0$ | $0$ | $1$ | $0$ | $3$ |\n| $a_2$ | 0 | $4$ | $3$ | $-1$ | $0$ | $0$ | $1$ | $6$ |\n| $s_2$ | 0 | $1$ | $2$ | $0$ | $1$ | $0$ | $0$ | $4$ |\n\n下列哪个陈述对所提出的初始单纯形表提供了最准确的评价？\n\nA. 该单纯形表为单纯形法的第一步迭代正确设置。\n\nB. 目标函数行不正确，因为剩余变量 $s_1$ 的系数应为 $0$。\n\nC. 目标函数行不正确，因为决策变量 ($x_1, x_2$) 的系数和右端项的值是使用适用于最大化问题的罚函数逻辑计算的，而非最小化问题。\n\nD. 该单纯形表不正确，因为初始基变量应为 $x_1, x_2,$ 和 $s_2$。\n\nE. 目标函数行的右端项值不正确；在任何迭代之前它应该为 $0$。",
            "solution": "我们从这个最小化问题开始\n$$\\min Z=4x_{1}+x_{2}$$\n约束条件为\n$$3x_{1}+x_{2}=3,$$\n$$4x_{1}+3x_{2}\\ge 6,$$\n$$x_{1}+2x_{2}\\le 4,$$\n$$x_{1},x_{2}\\ge 0.$$\n\n通过为等式约束引入一个人工变量，为大于等于不等式引入一个剩余变量和一个人工变量，以及为小于等于约束引入一个松弛变量，将约束转换为标准形式：\n- 等式：$3x_{1}+x_{2}+a_{1}=3$。\n- 大于等于：$4x_{1}+3x_{2}-s_{1}+a_{2}=6$。\n- 小于等于：$x_{1}+2x_{2}+s_{2}=4$。\n\n因此，每行的约束矩阵列 $(x_{1},x_{2},s_{1},s_{2},a_{1},a_{2})$ 分别是\n- $a_{1}$ 行：$(3,1,0,0,1,0)$，右端项为 $3$，\n- $a_{2}$ 行：$(4,3,-1,0,0,1)$，右端项为 $6$，\n- $s_{2}$ 行：$(1,2,0,1,0,0)$，右端项为 $4$。\n\n对于最小化问题中的大M法，人工变量带有一个大的正惩罚项。增广的目标函数是\n$$\\min Z=4x_{1}+x_{2}+0\\cdot s_{1}+0\\cdot s_{2}+M a_{1}+M a_{2}.$$\n初始基为 $\\{a_{1},a_{2},s_{2}\\}$，基成本向量为 $c_{B}=(M,M,0)$。第0行以上述形式书写\n$$Z+\\sum_{j}(z_{j}-c_{j})x_{j}=Z_{0},$$\n其中 $z_{j}=\\sum_{i}c_{B,i}\\,a_{ij}$ 且 $Z_{0}=\\sum_{i}c_{B,i}\\,b_{i}$。\n\n计算每一列的 $z_{j}$：\n- 对于 $x_{1}$：$z_{x_{1}}=M\\cdot 3+M\\cdot 4+0\\cdot 1=7M$。\n- 对于 $x_{2}$：$z_{x_{2}}=M\\cdot 1+M\\cdot 3+0\\cdot 2=4M$。\n- 对于 $s_{1}$：$z_{s_{1}}=M\\cdot 0+M\\cdot(-1)+0\\cdot 0=-M$。\n- 对于 $s_{2}$：$z_{s_{2}}=M\\cdot 0+M\\cdot 0+0\\cdot 1=0$。\n- 对于 $a_{1}$：$z_{a_{1}}=M\\cdot 1+M\\cdot 0+0\\cdot 0=M$。\n- 对于 $a_{2}$：$z_{a_{2}}=M\\cdot 0+M\\cdot 1+0\\cdot 0=M$。\n- 对于右端项：$Z_{0}=M\\cdot 3+M\\cdot 6+0\\cdot 4=9M$。\n\n减去原始目标函数系数 $c_{j}$，其中 $(c_{x_{1}},c_{x_{2}},c_{s_{1}},c_{s_{2}},c_{a_{1}},c_{a_{2}})=(4,1,0,0,M,M)$，得到第0行的系数：\n- $x_{1}$：$z_{x_{1}}-c_{x_{1}}=7M-4$，\n- $x_{2}$：$z_{x_{2}}-c_{x_{2}}=4M-1$，\n- $s_{1}$：$z_{s_{1}}-c_{s_{1}}=-M$，\n- $s_{2}$：$z_{s_{2}}-c_{s_{2}}=0$，\n- $a_{1}$：$z_{a_{1}}-c_{a_{1}}=0$，\n- $a_{2}$：$z_{a_{2}}-c_{a_{2}}=0$，\n- 右端项：$Z_{0}=9M$。\n\n因此，在所述的第0行形式中，一个最小化大M法设置的正确系数应该是：$x_{1}$ 为 $7M-4$，$x_{2}$ 为 $4M-1$，$s_{1}$ 为 $-M$，$s_{2}$ 为 $0$，$a_{1}$ 为 $0$，$a_{2}$ 为 $0$，右端项为 $9M$。\n\n然而，所提出的单纯形表第0行的条目是：$x_{1}$ 为 $-(7M+4)$，$x_{2}$ 为 $-(4M+1)$，$s_{1}$ 为 $M$，右端项为 $-9M$。这与指定人工变量成本为 $-M$（最大化问题的惩罚约定）时得到的结果完全一致，因为当 $c_{B}=(-M,-M,0)$ 时，我们得到：\n- $z_{x_{1}}-c_{x_{1}}=-7M-4$，\n- $z_{x_{2}}-c_{x_{2}}=-4M-1$，\n- $z_{s_{1}}-c_{s_{1}}=M$，\n- $Z_{0}=-9M$。\n\n因此，所提出的第0行是使用适用于最大化问题的罚函数逻辑计算的，而不是针对给定的最小化问题。此外，$s_{1}$ 的系数应为 $-M$ 而不是 $0$，所以陈述B不正确；给定的初始基是正确的，所以D不正确；并且当人工变量在基中时，右端项 $Z_{0}$ 是 $9M$，而不是 $0$，所以E不正确。最准确的评价是陈述C。",
            "answer": "$$\\boxed{C}$$"
        },
        {
            "introduction": "单纯形法的每一步迭代在几何上对应于从可行域的一个顶点移动到另一个相邻的顶点。然而，当使用大 M 法时，算法的起点实际上是在原始问题的可行域之外的一个“人工”顶点。这个练习将帮助你将抽象的代数运算与具体的几何路径联系起来，通过追踪算法在二维平面上访问的顶点序列，直观地理解大 M 法是如何从一个不可行的初始解“导航”到可行域，并最终找到最优解的 。",
            "id": "2209152",
            "problem": "一家制造公司生产两种产品，P1 和 P2。P1 的单位利润为 3 美元，P2 的单位利润为 5 美元。生产过程受到几个约束条件的限制。一项质量控制标准要求 P1 的单位数与 P2 单位数的三倍之和至少为 3 个单位。资源限制规定生产的总单位数（P1 和 P2 之和）不能超过 4 个单位。设 $x_1$ 为 P1 的单位数，$x_2$ 为 P2 的单位数。公司的目标是最大化其总利润 $Z$。该问题由以下线性规划模型表示：\n\n最大化 $Z = 3x_1 + 5x_2$\n约束条件为：\n1. $x_1 + 3x_2 \\ge 3$\n2. $x_1 + x_2 \\le 4$\n3. $x_1, x_2 \\ge 0$\n\n当使用单纯形法的标准实现来解决此问题时，会在 $(x_1, x_2)$ 平面中追踪一条经过一系列角点（顶点）的路径。该路径从原点 $(0,0)$ 开始，这对应于决策变量为非基变量的初始状态。确定算法访问的所有顶点的坐标 $(x_1, x_2)$ 序列，从原点开始，到提供最优解的顶点结束。\n\n将您的答案表示为一个矩阵，其中每一行代表一个被访问顶点的坐标 $(x_1, x_2)$，并按访问顺序排列。",
            "solution": "我们给定的线性规划问题是：\n最大化 $Z = 3x_{1} + 5x_{2}$，约束条件为\n$x_{1} + 3x_{2} \\geq 3$，$x_{1} + x_{2} \\leq 4$，以及 $x_{1}, x_{2} \\geq 0$。\n\n带有 $\\geq$ 约束的单纯形法标准实现通过两阶段法进行。为第一个约束引入一个剩余变量 $s_{1} \\geq 0$ 和一个人工变量 $a_{1} \\geq 0$，为第二个约束引入一个松弛变量 $s_{2} \\geq 0$：\n$$x_{1} + 3x_{2} - s_{1} + a_{1} = 3,$$\n$$x_{1} + x_{2} + s_{2} = 4.$$\n第一阶段最小化 $W = a_{1}$。增广空间中的初始基本可行解是通过将决策变量设为非基变量得到的：$x_{1} = 0$，$x_{2} = 0$，$s_{1} = 0$。由第一个方程得到 $a_{1} = 3$，由第二个方程得到 $s_{2} = 4$。这对应于 $(x_{1}, x_{2})$ 平面中的起始点 $(x_{1}, x_{2}) = (0,0)$。\n\n使用 $a_{1} = 3 - x_{1} - 3x_{2} + s_{1}$ 将 $W$ 表示为非基变量的函数，因此\n$$W = 3 - x_{1} - 3x_{2} + s_{1}.$$\n为了减小 $W$，选择具有最负系数的入基变量：$x_{2}$（系数为 $-3$）入基。对基变量进行比率检验，以确定在保持 $a_{1}, s_{2} \\geq 0$ 且 $x_{1} = 0, s_{1} = 0$ 的情况下，$x_{2}$ 可以增加多少：\n$$a_{1} = 3 - 3x_{2} \\geq 0 \\implies x_{2} \\leq 1,$$\n$$s_{2} = 4 - x_{2} \\geq 0 \\implies x_{2} \\leq 4.$$\n最紧的界限是 $x_{2} = 1$，因此 $a_{1}$ 离基，我们到达点 $(x_{1}, x_{2}) = (0,1)$。\n\n此时 $a_{1} = 0$，第一阶段完成；我们进入第二阶段，使用原始目标函数 $Z = 3x_{1} + 5x_{2}$。当前的基是 $\\{x_{2}, s_{2}\\}$，非基变量是 $\\{x_{1}, s_{1}\\}$。将约束方程中的基变量用非基变量表示：\n由 $x_{1} + 3x_{2} - s_{1} = 3$ 和 $x_{1} + x_{2} + s_{2} = 4$，其中 $\\{x_{2}, s_{2}\\}$ 是基变量，$\\{x_{1}, s_{1}\\}$ 是非基变量，我们得到\n$$x_{2} = \\frac{3 - x_{1} + s_{1}}{3}, \\quad s_{2} = 3 - \\frac{2}{3}x_{1} - \\frac{1}{3}s_{1}.$$\n将 $Z$ 表示为非基变量的函数：\n$$Z = 3x_{1} + 5x_{2} = 3x_{1} + 5\\left(\\frac{3 - x_{1} + s_{1}}{3}\\right) = 5 + \\frac{4}{3}x_{1} + \\frac{5}{3}s_{1}.$$\n根据 Dantzig 的最大化规则，入基变量是具有最大正检验数的非基变量；这里 $s_{1}$（系数为 $\\frac{5}{3}$）入基。在 $x_{1}$ 固定为 $0$ 的情况下，从 $0$ 开始增加 $s_{1}$ 并应用比率检验以保持基变量为非负：\n$$x_{2} = 1 + \\frac{s_{1}}{3} \\geq 0 \\quad \\text{(对 } s_{1} \\geq 0\\text{ 恒成立)},$$\n$$s_{2} = 3 - \\frac{s_{1}}{3} \\geq 0 \\implies s_{1} \\leq 9.$$\n因此 $s_{2}$ 在 $s_{1} = 9$ 时首先达到 $0$，得到 $x_{2} = 1 + 9/3 = 4$ 和 $x_{1} = 0$。这是顶点 $(0,4)$，它是最优解，因为在所有可行顶点中，它使 $Z$ 最大化。\n\n因此，在 $(x_{1}, x_{2})$ 平面中，从原点开始到最优解结束，访问的顶点序列是：\n- $(0,0)$,\n- $(0,1)$,\n- $(0,4)$。",
            "answer": "$$\\boxed{\\begin{pmatrix}\n0  0 \\\\\n0  1 \\\\\n0  4\n\\end{pmatrix}}$$"
        },
        {
            "introduction": "大 M 法不仅能找到最优解，还能有效地判断原始线性规划问题是否存在可行解。算法的最终状态——特别是人工变量是否仍留在基中——为我们提供了关键信息。这个练习探讨了一种重要的最终情景：当单纯形法终止，但一个人工变量以正值留在最优基中时，我们应该如何解读这个结果，并对原始问题的可行性做出明确的结论 。",
            "id": "2209121",
            "problem": "考虑一个标准的线性规划（LP）问题，其形式如下：\n最大化 $Z = \\mathbf{c}^T \\mathbf{x}$\n约束条件为：\n$A\\mathbf{x} \\le \\mathbf{b}$\n$\\mathbf{x} \\ge \\mathbf{0}$\n\n为了求解此问题，您需要通过添加松弛变量将其转换为标准形式。对于原始形式为‘$\\ge$’或‘$=$’的约束，您需要使用大M法。这涉及到为这些特定约束添加人工变量，并在目标函数中引入一个非常大的正数$M$，作为这些人工变量的惩罚项。对于最大化问题，修改后的目标函数形式为 $Z' = \\mathbf{c}^T \\mathbf{x} - M \\sum a_i$，其中$a_i$是人工变量。\n\n在对修改后的问题进行若干次单纯形算法迭代后，您得到了一个最终的单纯形表。此单纯形表满足最大化问题的最优性条件：目标函数行（Z行或第0行）中对应于非基变量的所有系数均为非负。然而，您观察到至少有一个人工变量以严格为正的值留在了基中。\n\n基于这一特定结果，关于原始线性规划问题，您可以得出什么确定性的结论？\n\nA. 原始问题不可行（即，其可行域为空）。\n\nB. 原始问题有无界解。\n\nC. 原始问题有唯一最优可行解。\n\nD. 原始问题有多个（或备选的）最优可行解。\n\nE. 单纯形计算中出现了错误，因为人工变量不应出现在最终最优单纯形表的基中。",
            "solution": "考虑标准形式下的大M法重构。为所有类型为$\\le$的约束引入松弛变量，并为每个$=$或$\\ge$的约束引入一个人工变量。令$\\mathbf{s}$表示松弛变量，$\\mathbf{a}$表示人工变量。由此产生的等式系统可以抽象地写为\n$$\n\\tilde{A}\\mathbf{x} + B\\mathbf{s} + C\\mathbf{a} = \\mathbf{b}, \\quad \\mathbf{x} \\ge \\mathbf{0}, \\ \\mathbf{s} \\ge \\mathbf{0}, \\ \\mathbf{a} \\ge \\mathbf{0}.\n$$\n对于一个最大化问题，大M法的目标函数是\n$$\nZ' = \\mathbf{c}^{T}\\mathbf{x} - M \\sum_{i} a_{i},\n$$\n其中$M  0$被选为足够大。\n\n大M法的关键性质：如果原始问题是可行的，那么重构后的问题存在一个可行解，其中所有人工变量都等于零。实际上，原始约束的任何可行解$(\\mathbf{x},\\mathbf{s})$都可以通过设置$\\mathbf{a}=\\mathbf{0}$扩展为重构约束的一个可行解$(\\mathbf{x},\\mathbf{s},\\mathbf{a})$。反之，任何满足$\\sum_{i} a_{i}  0$的可行解，相对于具有相同$(\\mathbf{x},\\mathbf{s})$且$\\mathbf{a}=\\mathbf{0}$的解，会使$Z'$严格减少$M \\sum_{i} a_{i}$。因此，对于足够大的$M$，大M问题的任何最优解（如果存在一个$\\mathbf{a}=\\mathbf{0}$的解），在最优时都将满足$\\mathbf{a}=\\mathbf{0}$：\n$$\n\\max \\{Z' : \\tilde{A}\\mathbf{x} + B\\mathbf{s} + C\\mathbf{a} = \\mathbf{b}, \\ \\mathbf{x},\\mathbf{s},\\mathbf{a} \\ge \\mathbf{0}\\}\n=\n\\max \\{\\mathbf{c}^{T}\\mathbf{x} : A\\mathbf{x} \\le \\mathbf{b}, \\ \\mathbf{x} \\ge \\mathbf{0}\\},\n$$\n并且只要原始问题是可行的，这个最大值就可以在$\\mathbf{a}=\\mathbf{0}$时达到。\n\n现在假设单纯形算法已经在一个满足最大化最优性条件（$Z$行中所有非基变量的检验数均为非负）的单纯形表处终止，但至少有一个人工变量，比如$a_k$，以严格为正的值留在基中，\n$$\na_{k}^{*}  0.\n$$\n为导出矛盾，假设原始问题是可行的。那么，大M问题存在一个可行解，其中$\\mathbf{a}=\\mathbf{0}$，其目标函数值为\n$$\nZ' = \\mathbf{c}^{T}\\mathbf{x}.\n$$\n当前的基本可行解的目标函数值为\n$$\nZ'^{*} = \\mathbf{c}^{T}\\mathbf{x}^{*} - M \\sum_{i} a_{i}^{*} \\le \\mathbf{c}^{T}\\mathbf{x}^{*} - M a_{k}^{*}  \\mathbf{c}^{T}\\mathbf{x}^{*}.\n$$\n因为$M  0$且$a_{k}^{*}  0$，当$M$选择得足够大时，任何$\\mathbf{a}=\\mathbf{0}$的可行解都优于$Z'^{*}$。因此，在最终最优单纯形表中存在一个严格为正的人工变量，与存在任何$\\mathbf{a}=\\mathbf{0}$的可行解相矛盾。因此，这样的解不存在，原始可行集为空。\n\n无界性会表现为存在一个检验数为负的非基变量（对于最大化问题），且没有出基变量（即，一个可以无限改进的方向），但这里情况并非如此。在终止时存在一个正的人工变量不是计算错误；它是在大M法框架下证明不可行性的正确凭证。因此，确定性的结论是原始线性规划问题是不可行的。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}