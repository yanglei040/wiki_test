{
    "hands_on_practices": [
        {
            "introduction": "创建自然三次样条的第一步是确定内部节点上的二阶导数值。这个练习将指导你直接应用核心公式，为一组给定的数据点建立控制这些二阶导数值的线性方程组。掌握这个过程是所有样条插值计算的基石 。",
            "id": "2193878",
            "problem": "在计算建模中，三次样条是一种用平滑曲线对一组数据点进行插值的强大工具。如果一个函数 $s(x)$ 是一个分段三次多项式，它穿过所有 $n+1$ 个数据点 $(x_0, y_0), (x_1, y_1), \\dots, (x_n, y_n)$，并且在内点 $x_1, \\dots, x_{n-1}$ 处具有连续的一阶和二阶导数，那么它就是一个三次样条。\n\n令 $M_i = s''(x_i)$ 为样条在点 $x_i$ 处的二阶导数，并令 $h_i = x_{i+1} - x_i$ 为连续点之间的间距。对于内点（$i=1, \\dots, n-1$），$M_i$ 的值通过以下线性方程组相关联：\n$$ \\frac{h_{i-1}}{6} M_{i-1} + \\frac{h_{i-1} + h_i}{3} M_i + \\frac{h_i}{6} M_{i+1} = \\frac{y_{i+1} - y_i}{h_i} - \\frac{y_i - y_{i-1}}{h_{i-1}} $$\n“自然”三次样条由附加的边界条件 $M_0 = 0$ 和 $M_n = 0$ 定义。这些条件在物理上对应于柔性梁的两端没有弯矩。\n\n考虑寻找一个自然三次样条来插值以下四个数据点：$(0, 1)$, $(1, 3)$, $(3, 2)$, 和 $(4, 4)$。这些条件为未知的内部二阶导数 $M_1$ 和 $M_2$ 导出了一个线性方程组。该系统可以写成矩阵形式 $A \\mathbf{M} = \\mathbf{b}$，其中 $\\mathbf{M} = \\begin{pmatrix} M_1 \\\\ M_2 \\end{pmatrix}$，$A$ 是一个 $2 \\times 2$ 的系数矩阵，$\\mathbf{b}$ 是一个 $2 \\times 1$ 的常数向量。\n\n确定矩阵 $A = \\begin{pmatrix} a_{11}  a_{12} \\\\ a_{21}  a_{22} \\end{pmatrix}$ 和向量 $\\mathbf{b} = \\begin{pmatrix} b_1 \\\\ b_2 \\end{pmatrix}$ 中元素的数值。将你的最终答案表示为一个单行矩阵，其中包含按顺序 $(a_{11}, a_{12}, a_{21}, a_{22}, b_1, b_2)$排列的六个值。将所有值表示为精确的分数或整数。",
            "solution": "我们已知内点的三次样条三对角关系式：\n$$\\frac{h_{i-1}}{6}M_{i-1}+\\frac{h_{i-1}+h_{i}}{3}M_{i}+\\frac{h_{i}}{6}M_{i+1}=\\frac{y_{i+1}-y_{i}}{h_{i}}-\\frac{y_{i}-y_{i-1}}{h_{i-1}},$$\n对于点 $(x_{0},y_{0})=(0,1)$、$(x_{1},y_{1})=(1,3)$、$(x_{2},y_{2})=(3,2)$、$(x_{3},y_{3})=(4,4)$，有自然边界条件 $M_{0}=0$ 和 $M_{3}=0$。\n\n首先计算间距：\n$$h_{0}=x_{1}-x_{0}=1,\\quad h_{1}=x_{2}-x_{1}=2,\\quad h_{2}=x_{3}-x_{2}=1.$$\n\n对于 $i=1$：\n$$\\frac{h_{0}}{6}M_{0}+\\frac{h_{0}+h_{1}}{3}M_{1}+\\frac{h_{1}}{6}M_{2}=\\frac{y_{2}-y_{1}}{h_{1}}-\\frac{y_{1}-y_{0}}{h_{0}}.$$\n代入数值：\n$$\\frac{1}{6}M_{0}+\\frac{1+2}{3}M_{1}+\\frac{2}{6}M_{2}=\\frac{2-3}{2}-\\frac{3-1}{1},$$\n$$0+1\\cdot M_{1}+\\frac{1}{3}M_{2}=-\\frac{1}{2}-2=-\\frac{5}{2}.$$\n因此第一行为 $a_{11}=1$，$a_{12}=\\frac{1}{3}$ 且 $b_{1}=-\\frac{5}{2}$。\n\n对于 $i=2$：\n$$\\frac{h_{1}}{6}M_{1}+\\frac{h_{1}+h_{2}}{3}M_{2}+\\frac{h_{2}}{6}M_{3}=\\frac{y_{3}-y_{2}}{h_{2}}-\\frac{y_{2}-y_{1}}{h_{1}}.$$\n代入数值：\n$$\\frac{2}{6}M_{1}+\\frac{2+1}{3}M_{2}+\\frac{1}{6}M_{3}=\\frac{4-2}{1}-\\frac{2-3}{2},$$\n$$\\frac{1}{3}M_{1}+1\\cdot M_{2}+0=2-(-\\frac{1}{2})=\\frac{5}{2}.$$\n因此第二行为 $a_{21}=\\frac{1}{3}$，$a_{22}=1$ 且 $b_{2}=\\frac{5}{2}$。\n\n因此，\n$$A=\\begin{pmatrix}1  \\frac{1}{3} \\\\ \\frac{1}{3}  1\\end{pmatrix},\\quad \\mathbf{b}=\\begin{pmatrix}-\\frac{5}{2} \\\\ \\frac{5}{2}\\end{pmatrix},$$\n所以所要求的单行矩阵为 $\\begin{pmatrix}1  \\frac{1}{3}  \\frac{1}{3}  1  -\\frac{5}{2}  \\frac{5}{2}\\end{pmatrix}$。",
            "answer": "$$\\boxed{\\begin{pmatrix}1  \\frac{1}{3}  \\frac{1}{3}  1  -\\frac{5}{2}  \\frac{5}{2}\\end{pmatrix}}$$"
        },
        {
            "introduction": "尽管样条曲线以其平滑性著称，但它们并不总能完美保持原始数据的形状特征，比如单调性。本练习通过一个精心设计的场景，揭示了样条插值中一个重要的“过冲”现象：即使数据点是单调递增的，生成的样条曲线也可能出现意外的波动。理解这一点对于在实际应用中批判性地使用样条至关重要 。",
            "id": "2189238",
            "problem": "在计算机辅助几何设计和数据可视化等应用中，通常希望插值曲线能保持数据的形状。例如，如果一组数据点是单调递增的，人们可能希望插值曲线也是单调的。然而，使用像三次样条这样的标准方法并不总能保证这一点。\n\n考虑四个点 $(x_0, y_0), (x_1, y_1), (x_2, y_2), (x_3, y_3)$，其纵坐标 $y_0, y_1, y_2, y_3$ 严格递增。使用一个记为 $S(x)$ 的自然三次样条来对这些点进行插值。自然三次样条是一个分段三次多项式，它穿过给定的点，并且其二阶导数在插值区间的端点处为零。\n\n设节点固定在 $x_0=0, x_1=1, x_2=2,$ 和 $x_3=3$。前三个点的纵坐标为 $y_0=0, y_1=10,$ 和 $y_2=11.5$。第四个点的纵坐标是一个参数，$y_3=k$，其中 $k$ 是一个实数，使得数据保持严格递增（即 $k > 11.5$）。\n\n研究发现，对于某一范围内的 $k$ 值，所得到的样条 $S(x)$ 在节点 $x_2$ 附近表现出非单调行为（“过冲”）。确定 $k$ 的具体值，使得样条在节点 $x_2=2$ 处的导数恰好为零，即 $S'(2)=0$。\n\n将你的答案表示为一个精确的分数。",
            "solution": "令 $M_{i}=S''(x_{i})$ 为样条在节点处的二阶导数。对于节点间距均匀（$h_{i}=x_{i+1}-x_{i}=1$）的自然三次样条，内部节点的二阶导数满足以下方程（对于 $i=1,2$）：\n$$\nh_{i-1}M_{i-1}+2(h_{i-1}+h_{i})M_{i}+h_{i}M_{i+1}\n=6\\left(\\frac{y_{i+1}-y_{i}}{h_{i}}-\\frac{y_{i}-y_{i-1}}{h_{i-1}}\\right),\n$$\n且 $M_{0}=M_{3}=0$。\n\n这里 $x_{0}=0,x_{1}=1,x_{2}=2,x_{3}=3$，$y_{0}=0$, $y_{1}=10$, $y_{2}=\\frac{23}{2}$, $y_{3}=k$, 并且 $h_{0}=h_{1}=h_{2}=1$。因此，方程组变为：\n$$\n4M_{1}+M_{2}=6\\left(\\frac{23}{2}-10-(10-0)\\right)=6\\left(\\frac{3}{2}-10\\right)=-51,\n$$\n$$\nM_{1}+4M_{2}=6\\left(k-\\frac{23}{2}-\\left(\\frac{23}{2}-10\\right)\\right)=6(k-13)=6k-78,\n$$\n且 $M_{0}=M_{3}=0$。\n\n求解该方程组，从第一个方程得到 $M_{2}=-51-4M_{1}$。代入第二个方程，\n$$\nM_{1}+4(-51-4M_{1})=6k-78\n\\;\\Rightarrow\\;\n-15M_{1}=6k+126\n\\;\\Rightarrow\\;\nM_{1}=-\\frac{2k+42}{5}.\n$$\n于是\n$$\nM_{2}=-51-4\\left(-\\frac{2k+42}{5}\\right)=\\frac{8k-87}{5}.\n$$\n\n在节点 $x_{i+1}$ 处，从左侧（区间 $[x_{i},x_{i+1}]$）计算的导数为\n$$\nS'(x_{i+1}) = \\frac{y_{i+1}-y_{i}}{h_i} + \\frac{h_i}{6}M_i + \\frac{h_i}{3}M_{i+1}.\n$$\n在 $x_{2}$ 处（即 $i=1$），由于 $h_1=1$ 这得到：\n$$\nS'(2)=(y_{2}-y_{1})+\\frac{M_{1}}{6}+\\frac{M_{2}}{3}.\n$$\n使用 $y_{2}-y_{1}=\\frac{23}{2}-10=\\frac{3}{2}$ 以及 $M_{1},M_{2}$ 的表达式，\n$$\n0=S'(2)=\\frac{3}{2}+\\frac{1}{6}\\left(-\\frac{2k+42}{5}\\right)+\\frac{1}{3}\\left(\\frac{8k-87}{5}\\right)\n=\\frac{3}{2}-\\frac{k+21}{15}+\\frac{8k-87}{15}\n=\\frac{3}{2}+\\frac{7k-108}{15}.\n$$\n两边乘以 $30$，\n$$\n45+14k-216=0 \\;\\Rightarrow\\; 14k=171 \\;\\Rightarrow\\; k=\\frac{171}{14}.\n$$\n这个值满足 $k>11.5$，因此数据点保持严格递增。",
            "answer": "$$\\boxed{\\frac{171}{14}}$$"
        },
        {
            "introduction": "我们为什么称之为“自然”样条，它又为何被认为是“最平滑”的？本练习将揭示其背后深刻的优化原理：自然样条是最小化总弯曲能 $\\int (S''(x))^2 dx$ 的插值曲线。通过将一个数据点视为变量，你将推导出其最佳值以创建最平滑的曲线，这会让你对样条的变分本质有更深的理解 。",
            "id": "2189239",
            "problem": "一组五个数据点 $(x_i, y_i)$（其中 $i=0, 1, 2, 3, 4$）用于插值。节点位于等间距位置，$x_i = x_0 + i h$，其中 $x_0$ 为某个初始点，$h$ 为一个恒定的正步长。纵坐标 $y_0, y_1, y_3$ 和 $y_4$ 是已知的，但中心点的纵坐标 $y_2$ 是一个可以自由选择的变量。\n\n构建一个自然三次样条，记为 $S(x)$，来对这五个点进行插值。一个在区间 $[x_0, x_4]$ 上定义的函数 $S(x)$ 是一个自然三次样条，如果它满足以下条件：\n1. 在每个子区间 $[x_{i-1}, x_i]$ (其中 $i=1, 2, 3, 4$) 上，$S(x)$ 是一个三次多项式。\n2. $S(x)$ 及其一阶导数 $S'(x)$ 和二阶导数 $S''(x)$ 在整个区间 $[x_0, x_4]$ 上都是连续的。\n3. 对于每个 $i \\in \\{0, 1, 2, 3, 4\\}$，$S(x_i) = y_i$。\n4. 满足“自然”边界条件：$S''(x_0) = 0$ 和 $S''(x_4) = 0$。\n\n样条的总弯曲能由积分 $E = \\int_{x_0}^{x_4} [S''(x)]^2 dx$ 定义。你的任务是找到使该总弯曲能最小化的未知纵坐标 $y_2$ 的值。\n\n将你的答案 $y_2$ 表示为由已知纵坐标 $y_0, y_1, y_3$ 和 $y_4$ 构成的符号表达式。",
            "solution": "令 $M_{i} := S''(x_{i})$，其中 $i=0,1,2,3,4$。对于均匀间距 $h$ 和自然边界条件 $M_{0}=M_{4}=0$，三次样条的矩满足（对于 $i=1,2,3$）：\n$$\nM_{i-1} + 4 M_{i} + M_{i+1} = \\frac{6}{h^{2}}\\left(y_{i+1} - 2 y_{i} + y_{i-1}\\right).\n$$\n定义 $k := \\frac{6}{h^{2}}$ 和离散二阶差分\n$$\nr_{1} := y_{2} - 2 y_{1} + y_{0},\\quad r_{2} := y_{3} - 2 y_{2} + y_{1},\\quad r_{3} := y_{4} - 2 y_{3} + y_{2}.\n$$\n那么，该方程组为\n$$\n4 M_{1} + M_{2} = k r_{1},\\quad M_{1} + 4 M_{2} + M_{3} = k r_{2},\\quad M_{2} + 4 M_{3} = k r_{3}.\n$$\n解此三对角系统可得\n$$\nM_{1} = \\frac{k}{56}\\left(15 r_{1} - 4 r_{2} + r_{3}\\right),\\quad\nM_{2} = \\frac{k}{14}\\left(- r_{1} + 4 r_{2} - r_{3}\\right),\\quad\nM_{3} = \\frac{k}{56}\\left(r_{1} - 4 r_{2} + 15 r_{3}\\right).\n$$\n在每个子区间 $[x_{i-1},x_{i}]$ 上，$S''(x)$ 是 $M_{i-1}$ 和 $M_{i}$ 之间的线性插值，因此\n$$\nS''(x) = M_{i-1}(1-t) + M_{i} t,\\quad t := \\frac{x - x_{i-1}}{h}\\in[0,1].\n$$\n因此，来自区间 $[x_{i-1},x_{i}]$ 对弯曲能的贡献是\n$$\n\\int_{x_{i-1}}^{x_{i}} \\left(S''(x)\\right)^{2} dx\n= h \\int_{0}^{1} \\left((1-t) M_{i-1} + t M_{i}\\right)^{2} dt\n= \\frac{h}{3}\\left(M_{i-1}^{2} + M_{i-1} M_{i} + M_{i}^{2}\\right).\n$$\n对 $i=1,2,3,4$ 求和并使用 $M_{0}=M_{4}=0$ 可得\n$$\nE = \\frac{h}{3}\\left(2 M_{1}^{2} + M_{1} M_{2} + 2 M_{2}^{2} + M_{2} M_{3} + 2 M_{3}^{2}\\right).\n$$\n只有 $y_{2}$ 是变量；因此 $r_{1}, r_{2}, r_{3}$ 以及 $M_{1}, M_{2}, M_{3}$ 线性依赖于 $y_{2}$。将 $E$ 对 $y_{2}$ 求导。令 $X := y_{2}$。用 $M_{1}', M_{2}', M_{3}'$ 表示关于 $X$ 的导数，则该二次型的导数为\n$$\n\\frac{dE}{dX} = \\frac{h}{3}\\left(4 M_{1} M_{1}' + M_{1}' M_{2} + M_{1} M_{2}' + 4 M_{2} M_{2}' + M_{2}' M_{3} + M_{2} M_{3}' + 4 M_{3} M_{3}'\\right).\n$$\n根据显式公式，\n$$\nM_{1}' = \\frac{k}{56}(15(1) - 4(-2) + 1) = \\frac{24k}{56},\\quad M_{2}' = \\frac{k}{14}(-1 + 4(-2) - 1) = -\\frac{10k}{14},\\quad M_{3}' = \\frac{k}{56}(1 - 4(-2) + 15) = \\frac{24k}{56}.\n$$\n使用这些常数重新整理导数可得\n$$\n\\frac{dE}{dX} = \\frac{h}{3}\\left[ \\frac{24k}{56}\\left(4 M_{1} + M_{2}\\right) + \\frac{24k}{56}\\left(M_{2} + 4 M_{3}\\right) - \\frac{10k}{14}\\left(M_{1} + 4 M_{2} + M_{3}\\right) \\right].\n$$\n使用样条矩方程，\n$$\n4 M_{1} + M_{2} = k r_{1},\\quad M_{1} + 4 M_{2} + M_{3} = k r_{2},\\quad M_{2} + 4 M_{3} = k r_{3},\n$$\n我们得到\n$$\n\\frac{dE}{dX} = \\frac{h k^{2}}{3}\\left( \\frac{24}{56}r_1 + \\frac{24}{56}r_3 - \\frac{10}{14}r_2 \\right) = \\frac{h k^{2}}{21}\\left(3(r_{1}+r_{3}) - 5 r_{2}\\right).\n$$\n令 $\\frac{dE}{dX}=0$ 得到最小化的充分必要条件（因为该二次型是正定的），即\n$$\n3(r_{1}+r_{3}) - 5 r_{2} = 0.\n$$\n代入 $r_{1} = y_{2} - 2 y_{1} + y_{0}$，$r_{2} = y_{3} - 2 y_{2} + y_{1}$，$r_{3} = y_{4} - 2 y_{3} + y_{2}$：\n$$\n3\\left((y_2 - 2y_1 + y_0) + (y_4 - 2y_3 + y_2)\\right) - 5\\left(y_{3} - 2 y_{2} + y_{1}\\right) = 0.\n$$\n化简得，\n$$\n16 y_{2} - 11 y_{1} - 11 y_{3} + 3 y_{0} + 3 y_{4} = 0,\n$$\n因此，使总弯曲能最小化的纵坐标是\n$$\ny_{2} = \\frac{11 y_{1} + 11 y_{3} - 3 y_{0} - 3 y_{4}}{16}.\n$$",
            "answer": "$$\\boxed{\\frac{11 y_{1} + 11 y_{3} - 3 y_{0} - 3 y_{4}}{16}}$$"
        }
    ]
}