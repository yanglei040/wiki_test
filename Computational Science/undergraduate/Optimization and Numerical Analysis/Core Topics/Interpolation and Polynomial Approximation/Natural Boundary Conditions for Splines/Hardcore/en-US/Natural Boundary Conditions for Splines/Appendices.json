{
    "hands_on_practices": [
        {
            "introduction": "The first step in constructing a natural cubic spline is to determine the second derivatives at each interior data point, which are often called the 'moments' of the spline. This exercise provides a concrete set of data and guides you through setting up the system of linear equations that defines these crucial values. Mastering this process  is fundamental, as it forms the algebraic backbone from which the entire smooth curve is built.",
            "id": "2193878",
            "problem": "In computational modeling, a cubic spline is a powerful tool for interpolating a set of data points with a smooth curve. A function $s(x)$ is a cubic spline that interpolates the $n+1$ data points $(x_0, y_0), (x_1, y_1), \\dots, (x_n, y_n)$ if it is a piecewise cubic polynomial that passes through all the points and has continuous first and second derivatives at the interior points $x_1, \\dots, x_{n-1}$.\n\nLet $M_i = s''(x_i)$ be the second derivative of the spline at the point $x_i$, and let $h_i = x_{i+1} - x_i$ be the spacing between consecutive points. The values of $M_i$ for the interior points ($i=1, \\dots, n-1$) are related by the following system of linear equations:\n$$ \\frac{h_{i-1}}{6} M_{i-1} + \\frac{h_{i-1} + h_i}{3} M_i + \\frac{h_i}{6} M_{i+1} = \\frac{y_{i+1} - y_i}{h_i} - \\frac{y_i - y_{i-1}}{h_{i-1}} $$\nA \"natural\" cubic spline is defined by the additional boundary conditions $M_0 = 0$ and $M_n = 0$. These conditions physically correspond to the ends of a flexible beam being free from bending moments.\n\nConsider the task of finding a natural cubic spline that interpolates the following four data points: $(0, 1)$, $(1, 3)$, $(3, 2)$, and $(4, 4)$. The conditions give rise to a system of linear equations for the unknown internal second derivatives, $M_1$ and $M_2$. This system can be written in matrix form as $A \\mathbf{M} = \\mathbf{b}$, where $\\mathbf{M} = \\begin{pmatrix} M_1 \\\\ M_2 \\end{pmatrix}$, $A$ is a $2 \\times 2$ coefficient matrix, and $\\mathbf{b}$ is a $2 \\times 1$ constant vector.\n\nDetermine the numerical values for the entries of the matrix $A = \\begin{pmatrix} a_{11}  a_{12} \\\\ a_{21}  a_{22} \\end{pmatrix}$ and the vector $\\mathbf{b} = \\begin{pmatrix} b_1 \\\\ b_2 \\end{pmatrix}$. Present your final answer as a single row matrix containing the six values in the order $(a_{11}, a_{12}, a_{21}, a_{22}, b_1, b_2)$. Express all values as exact fractions or integers.",
            "solution": "We are given the cubic spline tridiagonal relation for interior points:\n$$\\frac{h_{i-1}}{6}M_{i-1}+\\frac{h_{i-1}+h_{i}}{3}M_{i}+\\frac{h_{i}}{6}M_{i+1}=\\frac{y_{i+1}-y_{i}}{h_{i}}-\\frac{y_{i}-y_{i-1}}{h_{i-1}},$$\nwith natural boundary conditions $M_{0}=0$ and $M_{3}=0$ for the points $(x_{0},y_{0})=(0,1)$, $(x_{1},y_{1})=(1,3)$, $(x_{2},y_{2})=(3,2)$, $(x_{3},y_{3})=(4,4)$.\n\nFirst compute the spacings:\n$$h_{0}=x_{1}-x_{0}=1,\\quad h_{1}=x_{2}-x_{1}=2,\\quad h_{2}=x_{3}-x_{2}=1.$$\n\nFor $i=1$:\n$$\\frac{h_{0}}{6}M_{0}+\\frac{h_{0}+h_{1}}{3}M_{1}+\\frac{h_{1}}{6}M_{2}=\\frac{y_{2}-y_{1}}{h_{1}}-\\frac{y_{1}-y_{0}}{h_{0}}.$$\nSubstitute values:\n$$\\frac{1}{6}M_{0}+\\frac{1+2}{3}M_{1}+\\frac{2}{6}M_{2}=\\frac{2-3}{2}-\\frac{3-1}{1},$$\n$$0+1\\cdot M_{1}+\\frac{1}{3}M_{2}=-\\frac{1}{2}-2=-\\frac{5}{2}.$$\nThus the first row is $a_{11}=1$, $a_{12}=\\frac{1}{3}$ and $b_{1}=-\\frac{5}{2}$.\n\nFor $i=2$:\n$$\\frac{h_{1}}{6}M_{1}+\\frac{h_{1}+h_{2}}{3}M_{2}+\\frac{h_{2}}{6}M_{3}=\\frac{y_{3}-y_{2}}{h_{2}}-\\frac{y_{2}-y_{1}}{h_{1}}.$$\nSubstitute values:\n$$\\frac{2}{6}M_{1}+\\frac{2+1}{3}M_{2}+\\frac{1}{6}M_{3}=\\frac{4-2}{1}-\\frac{2-3}{2},$$\n$$\\frac{1}{3}M_{1}+1\\cdot M_{2}+0=2-(-\\frac{1}{2})=\\frac{5}{2}.$$\nThus the second row is $a_{21}=\\frac{1}{3}$, $a_{22}=1$ and $b_{2}=\\frac{5}{2}$.\n\nTherefore,\n$$A=\\begin{pmatrix}1  \\frac{1}{3} \\\\ \\frac{1}{3}  1\\end{pmatrix},\\quad \\mathbf{b}=\\begin{pmatrix}-\\frac{5}{2} \\\\ \\frac{5}{2}\\end{pmatrix},$$\nso the requested single row matrix is $\\begin{pmatrix}1  \\frac{1}{3}  \\frac{1}{3}  1  -\\frac{5}{2}  \\frac{5}{2}\\end{pmatrix}$.",
            "answer": "$$\\boxed{\\begin{pmatrix}1  \\frac{1}{3}  \\frac{1}{3}  1  -\\frac{5}{2}  \\frac{5}{2}\\end{pmatrix}}$$"
        },
        {
            "introduction": "A common goal in interpolation is for the curve to preserve the shape of the data, such as its monotonicity. However, cubic splines can sometimes introduce oscillations or 'overshoots' that are not suggested by the original discrete points. This practice problem  provides a striking demonstration of this critical concept, asking you to find the exact condition under which a spline passing through strictly increasing data points develops a horizontal tangent, signaling a loss of monotonicity.",
            "id": "2189238",
            "problem": "In applications such as computer-aided geometric design and data visualization, it is often desirable that an interpolating curve preserves the shape of the data. For instance, if a set of data points is monotonically increasing, one might hope the interpolating curve is also monotonic. However, this is not always guaranteed with standard methods like cubic splines.\n\nConsider four points $(x_0, y_0), (x_1, y_1), (x_2, y_2), (x_3, y_3)$ with strictly increasing ordinates $y_0  y_1  y_2  y_3$. A natural cubic spline, denoted by $S(x)$, is used to interpolate these points. A natural cubic spline is a piecewise cubic polynomial that passes through the given points and has its second derivative equal to zero at the endpoints of the interpolation interval.\n\nLet the knots be fixed at $x_0=0, x_1=1, x_2=2,$ and $x_3=3$. The first three ordinates are given as $y_0=0, y_1=10,$ and $y_2=11.5$. The fourth ordinate is a parameter, $y_3=k$, where $k$ is a real number such that the data remains strictly increasing (i.e., $k  11.5$).\n\nIt is found that for a certain range of $k$, the resulting spline $S(x)$ exhibits non-monotonic behavior (an \"overshoot\") in the vicinity of the knot $x_2$. Determine the specific value of $k$ for which the spline's derivative at the knot $x_2=2$ is exactly zero, i.e., $S'(2)=0$.\n\nExpress your answer as an exact fraction.",
            "solution": "Let $M_{i}=S''(x_{i})$ be the splineâ€™s second derivatives at the knots. For a natural cubic spline with uniform spacing $h_{i}=x_{i+1}-x_{i}=1$, the interior moments satisfy, for $i=1,2$,\n$$\nh_{i-1}M_{i-1}+2(h_{i-1}+h_{i})M_{i}+h_{i}M_{i+1}\n=6\\left(\\frac{y_{i+1}-y_{i}}{h_{i}}-\\frac{y_{i}-y_{i-1}}{h_{i-1}}\\right),\n$$\nwith $M_{0}=M_{3}=0$.\n\nHere $x_{0}=0,x_{1}=1,x_{2}=2,x_{3}=3$, $y_{0}=0$, $y_{1}=10$, $y_{2}=\\frac{23}{2}$, $y_{3}=k$, and $h_{0}=h_{1}=h_{2}=1$. Thus the system becomes\n$$\n4M_{1}+M_{2}=6\\left(\\frac{23}{2}-10- (10-0)\\right)=6\\left(\\frac{3}{2}-10\\right)=-51,\n$$\n$$\nM_{1}+4M_{2}=6\\left(k-\\frac{23}{2}-\\left(\\frac{23}{2}-10\\right)\\right)=6\\left(k-13\\right)=6k-78,\n$$\nwith $M_{0}=M_{3}=0$.\n\nSolving, from the first equation $M_{2}=-51-4M_{1}$. Substituting into the second,\n$$\nM_{1}+4(-51-4M_{1})=6k-78\n\\;\\Rightarrow\\;\n-15M_{1}=6k+126\n\\;\\Rightarrow\\;\nM_{1}=-\\frac{2k+42}{5}.\n$$\nThen\n$$\nM_{2}=-51-4\\left(-\\frac{2k+42}{5}\\right)=\\frac{8k-87}{5}.\n$$\n\nThe derivative of the cubic spline at an interior knot $x_{i+1}$ from the left (interval $[x_{i},x_{i+1}]$) is\n$$\nS'(x_{i+1}^{-})=(y_{i+1}-y_{i})+\\frac{M_{i}}{6}+\\frac{M_{i+1}}{3}.\n$$\nAt $x_{2}$ (i.e., $i=1$), this gives\n$$\nS'(2)=(y_{2}-y_{1})+\\frac{M_{1}}{6}+\\frac{M_{2}}{3}.\n$$\nUsing $y_{2}-y_{1}=\\frac{23}{2}-10=\\frac{3}{2}$ and the expressions for $M_{1},M_{2}$,\n$$\n0=S'(2)=\\frac{3}{2}+\\frac{1}{6}\\left(-\\frac{2k+42}{5}\\right)+\\frac{1}{3}\\left(\\frac{8k-87}{5}\\right)\n=\\frac{3}{2}-\\frac{k+21}{15}+\\frac{8k-87}{15}\n=\\frac{3}{2}+\\frac{7k-108}{15}.\n$$\nMultiplying by $30$,\n$$\n45+14k-216=0 \\;\\Rightarrow\\; 14k=171 \\;\\Rightarrow\\; k=\\frac{171}{14}.\n$$\nThis value satisfies $k11.5$, so the data remain strictly increasing.",
            "answer": "$$\\boxed{\\frac{171}{14}}$$"
        },
        {
            "introduction": "The 'natural' boundary condition, where the second derivatives at the endpoints are zero, is not an arbitrary choice; it is deeply connected to a principle of optimal smoothness. It corresponds to minimizing the spline's total 'bending energy,' defined as the integral of the squared second derivative, $\\int [S''(x)]^2 dx$. In this capstone exercise , you will use calculus to prove this remarkable property for a specific case, discovering for yourself how to choose a data point that results in the smoothest possible curve.",
            "id": "2189239",
            "problem": "A set of five data points $(x_i, y_i)$ for $i=0, 1, 2, 3, 4$ is used for interpolation. The knots are located at equally spaced positions, $x_i = x_0 + i h$ for some initial point $x_0$ and a constant positive step size $h$. The ordinates $y_0, y_1, y_3,$ and $y_4$ are known, but the central ordinate $y_2$ is a variable that can be chosen freely.\n\nA natural cubic spline, denoted by $S(x)$, is constructed to interpolate these five points. A function $S(x)$ defined on the interval $[x_0, x_4]$ is a natural cubic spline if it satisfies the following conditions:\n1. On each subinterval $[x_{i-1}, x_i]$ for $i=1, 2, 3, 4$, $S(x)$ is a cubic polynomial.\n2. $S(x)$, its first derivative $S'(x)$, and its second derivative $S''(x)$ are all continuous on the entire interval $[x_0, x_4]$.\n3. $S(x_i) = y_i$ for each $i \\in \\{0, 1, 2, 3, 4\\}$.\n4. The \"natural\" boundary conditions are met: $S''(x_0) = 0$ and $S''(x_4) = 0$.\n\nThe total bending energy of the spline is defined by the integral $E = \\int_{x_0}^{x_4} [S''(x)]^2 dx$. Your task is to find the value of the unknown ordinate $y_2$ that minimizes this total bending energy.\n\nExpress your answer for $y_2$ as a symbolic expression in terms of the known ordinates $y_0, y_1, y_3$, and $y_4$.",
            "solution": "Let $M_{i} := S''(x_{i})$ for $i=0,1,2,3,4$. For uniform spacing $h$ and natural boundary conditions $M_{0}=M_{4}=0$, the cubic spline moments satisfy, for $i=1,2,3$,\n$$\nM_{i-1} + 4 M_{i} + M_{i+1} = \\frac{6}{h^{2}}\\left(y_{i+1} - 2 y_{i} + y_{i-1}\\right).\n$$\nDefine $k := \\frac{6}{h^{2}}$ and the discrete second differences\n$$\nr_{1} := y_{2} - 2 y_{1} + y_{0},\\quad r_{2} := y_{3} - 2 y_{2} + y_{1},\\quad r_{3} := y_{4} - 2 y_{3} + y_{2}.\n$$\nThen the system is\n$$\n4 M_{1} + M_{2} = k r_{1},\\quad M_{1} + 4 M_{2} + M_{3} = k r_{2},\\quad M_{2} + 4 M_{3} = k r_{3}.\n$$\nSolving this tridiagonal system gives\n$$\nM_{1} = \\frac{k}{56}\\left(15 r_{1} + r_{3} - 4 r_{2}\\right),\\quad\nM_{2} = \\frac{k}{14}\\left(- r_{1} + 4 r_{2} - r_{3}\\right),\\quad\nM_{3} = \\frac{k}{56}\\left(15 r_{3} + r_{1} - 4 r_{2}\\right).\n$$\nOn each subinterval $[x_{i-1},x_{i}]$, $S''(x)$ is the linear interpolation between $M_{i-1}$ and $M_{i}$, so\n$$\nS''(x) = M_{i-1}(1-t) + M_{i} t,\\quad t := \\frac{x - x_{i-1}}{h}\\in[0,1].\n$$\nTherefore, the contribution to the bending energy from $[x_{i-1},x_{i}]$ is\n$$\n\\int_{x_{i-1}}^{x_{i}} \\left(S''(x)\\right)^{2} dx\n= h \\int_{0}^{1} \\left((1-t) M_{i-1} + t M_{i}\\right)^{2} dt\n= \\frac{h}{3}\\left(M_{i-1}^{2} + M_{i-1} M_{i} + M_{i}^{2}\\right).\n$$\nSumming over $i=1,2,3,4$ and using $M_{0}=M_{4}=0$ gives\n$$\nE = \\frac{h}{3}\\left(2 M_{1}^{2} + M_{1} M_{2} + 2 M_{2}^{2} + M_{2} M_{3} + 2 M_{3}^{2}\\right).\n$$\nOnly $y_{2}$ is variable; hence $r_{1}, r_{2}, r_{3}$ and thus $M_{1}, M_{2}, M_{3}$ depend linearly on $y_{2}$. Differentiate $E$ with respect to $y_{2}$. Let $X := y_{2}$. With $M_{1}', M_{2}', M_{3}'$ denoting derivatives with respect to $X$, the derivative of the quadratic form is\n$$\n\\frac{dE}{dX} = \\frac{h}{3}\\left(4 M_{1} M_{1}' + 4 M_{3} M_{3}' + M_{1}' M_{2} + M_{1} M_{2}' + 4 M_{2} M_{2}' + M_{2}' M_{3} + M_{2} M_{3}'\\right).\n$$\nFrom the explicit formulas,\n$$\nM_{1}' = \\frac{24k}{56},\\quad M_{2}' = \\frac{-10k}{14},\\quad M_{3}' = \\frac{24k}{56}.\n$$\nRearranging the derivative using these constants yields\n$$\n\\frac{dE}{dX} = \\frac{h}{3}\\left[ \\frac{24k}{56}\\left(4 M_{1} + M_{2}\\right) + \\frac{24k}{56}\\left(4 M_{3} + M_{2}\\right) - \\frac{10k}{14}\\left(M_{1} + 4 M_{2} + M_{3}\\right) \\right].\n$$\nUsing the spline moment equations,\n$$\n4 M_{1} + M_{2} = k r_{1},\\quad M_{1} + 4 M_{2} + M_{3} = k r_{2},\\quad 4 M_{3} + M_{2} = k r_{3},\n$$\nwe obtain\n$$\n\\frac{dE}{dX} = \\frac{h k^{2}}{3}\\cdot \\frac{1}{7}\\left(3(r_{1}+r_{3}) - 5 r_{2}\\right).\n$$\nSetting $\\frac{dE}{dX}=0$ gives the necessary and sufficient condition for minimization (the quadratic form is positive definite), namely\n$$\n3(r_{1}+r_{3}) - 5 r_{2} = 0.\n$$\nSubstitute $r_{1} = y_{2} - 2 y_{1} + y_{0}$, $r_{2} = y_{3} - 2 y_{2} + y_{1}$, $r_{3} = y_{4} - 2 y_{3} + y_{2}$:\n$$\n3\\left(2 y_{2} - 2 y_{1} - 2 y_{3} + y_{0} + y_{4}\\right) - 5\\left(y_{3} - 2 y_{2} + y_{1}\\right) = 0.\n$$\nSimplifying,\n$$\n16 y_{2} - 11 y_{1} - 11 y_{3} + 3 y_{0} + 3 y_{4} = 0,\n$$\nso the minimizing ordinate is\n$$\ny_{2} = \\frac{11 y_{1} + 11 y_{3} - 3 y_{0} - 3 y_{4}}{16}.\n$$",
            "answer": "$$\\boxed{\\frac{11 y_{1} + 11 y_{3} - 3 y_{0} - 3 y_{4}}{16}}$$"
        }
    ]
}