{
    "hands_on_practices": [
        {
            "introduction": "要真正掌握一个数学工具，第一步是熟悉其基本运算。本练习将引导您完成一个直接的计算，应用一个给定的Householder矩阵来变换一个向量。通过这个过程，您将直观地理解向量是如何通过由特定法向量定义的超平面进行反射的。",
            "id": "2178061",
            "problem": "在数值线性代数中，Householder变换是一种线性变换，它描述了关于一个包含原点的超平面的镜像反射。对于一个给定的非零向量 $v \\in \\mathbb{R}^n$，相应的Householder矩阵由以下公式给出：\n$$H = I - 2 \\frac{v v^T}{v^T v}$$\n其中 $I$ 是 $n \\times n$ 的单位矩阵。\n\n考虑$\\mathbb{R}^3$中的向量 $v = \\begin{pmatrix} 1 \\\\ 0 \\\\ 1 \\end{pmatrix}$ 和 $u = \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix}$。\n\n计算将由向量 $v$ 生成的Householder变换应用于向量 $u$ 所得到的向量。请将您的答案表示为列向量。",
            "solution": "我们使用Householder变换 $H = I - 2 \\dfrac{v v^{T}}{v^{T} v}$ 并将其应用于 $u$：\n$$Hu = \\left(I - 2 \\frac{v v^{T}}{v^{T} v}\\right) u.$$\n计算分母：\n$$v^{T} v = 1^{2} + 0^{2} + 1^{2} = 2,$$\n所以\n$$Hu = \\left(I - \\frac{2}{2} v v^{T}\\right) u = (I - v v^{T}) u.$$\n利用性质 $(v v^{T}) u = v (v^{T} u)$，我们得到\n$$Hu = u - v (v^{T} u).$$\n计算标量\n$$v^{T} u = 1 \\cdot 1 + 0 \\cdot 2 + 1 \\cdot 3 = 4,$$\n因此\n$$Hu = u - 4 v = \\begin{pmatrix} 1 \\\\ 2 \\\\ 3 \\end{pmatrix} - 4 \\begin{pmatrix} 1 \\\\ 0 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1 - 4 \\\\ 2 - 0 \\\\ 3 - 4 \\end{pmatrix} = \\begin{pmatrix} -3 \\\\ 2 \\\\ -1 \\end{pmatrix}.$$",
            "answer": "$$\\boxed{\\begin{pmatrix}-3 \\\\ 2 \\\\ -1\\end{pmatrix}}$$"
        },
        {
            "introduction": "在掌握了如何应用变换之后，下一步是学习如何构建它以实现特定目标。这个练习要求您构建一个特定的Householder矩阵，该矩阵能将一个向量 $x$ 映射到另一个等范数的向量 $y$。这项技能是许多重要数值算法（如QR分解）的核心。",
            "id": "2178069",
            "problem": "在数值线性代数中，Householder变换是一种线性变换，它执行关于一个包含原点的超平面的反射。此类变换在像QR分解这样的算法中是基础性的。给定$\\mathbb{R}^n$中的两个具有相同欧几里得范数（$\\|x\\|_2 = \\|y\\|_2$）的向量$x$和$y$，可以构造一个Householder矩阵$H$，使得$Hx = y$。\n\n考虑向量 $x = \\begin{pmatrix} 1 \\\\ 2 \\\\ 2 \\end{pmatrix}$ 和 $y = \\begin{pmatrix} 0 \\\\ 3 \\\\ 0 \\end{pmatrix}$。\n确定将向量$x$映射到向量$y$的Householder矩阵$H$。将你的答案表示为一个元素为有理数的$3 \\times 3$矩阵。",
            "solution": "题目要求我们找到一个Householder矩阵$H$，使得对于$x=\\begin{pmatrix}1 \\\\ 2 \\\\ 2\\end{pmatrix}$和$y=\\begin{pmatrix}0 \\\\ 3 \\\\ 0\\end{pmatrix}$，有$Hx=y$。当$\\|x\\|_{2}=\\|y\\|_{2}$时，将$x$映射到$y$的Householder反射矩阵由下式给出：\n$$\nH=I-\\frac{2}{u^{T}u}\\,uu^{T},\n$$\n其中$u=x-y$，$I$是单位矩阵。这个选择对应于关于与$u$正交且经过中点$\\frac{x+y}{2}$的超平面进行反射；由于$\\|x\\|_{2}=\\|y\\|_{2}$，这个超平面包含该中点，且该反射将$x$映射到$y$。\n\n首先计算$u$：\n$$\nu=x-y=\\begin{pmatrix}1 \\\\ 2 \\\\ 2\\end{pmatrix}-\\begin{pmatrix}0 \\\\ 3 \\\\ 0\\end{pmatrix}=\\begin{pmatrix}1 \\\\ -1 \\\\ 2\\end{pmatrix}.\n$$\n然后计算标量$u^{T}u$和矩阵$uu^{T}$：\n$$\nu^{T}u=1^{2}+(-1)^{2}+2^{2}=6,\n$$\n$$\nuu^{T}=\\begin{pmatrix}1 \\\\ -1 \\\\ 2\\end{pmatrix}\\begin{pmatrix}1  -1  2\\end{pmatrix}=\\begin{pmatrix}\n1  -1  2 \\\\\n-1  1  -2 \\\\\n2  -2  4\n\\end{pmatrix}.\n$$\n因此，\n$$\nH=I-\\frac{2}{6}uu^{T}=I-\\frac{1}{3}\\begin{pmatrix}\n1  -1  2 \\\\\n-1  1  -2 \\\\\n2  -2  4\n\\end{pmatrix}.\n$$\n从单位矩阵中减去，\n$$\nH=\\begin{pmatrix}\n1  0  0 \\\\\n0  1  0 \\\\\n0  0  1\n\\end{pmatrix}-\\begin{pmatrix}\n\\frac{1}{3}  -\\frac{1}{3}  \\frac{2}{3} \\\\\n-\\frac{1}{3}  \\frac{1}{3}  -\\frac{2}{3} \\\\\n\\frac{2}{3}  -\\frac{2}{3}  \\frac{4}{3}\n\\end{pmatrix}\n=\\begin{pmatrix}\n\\frac{2}{3}  \\frac{1}{3}  -\\frac{2}{3} \\\\\n\\frac{1}{3}  \\frac{2}{3}  \\frac{2}{3} \\\\\n-\\frac{2}{3}  \\frac{2}{3}  -\\frac{1}{3}\n\\end{pmatrix}.\n$$\n直接检验可证实$Hx=y$：\n$$\n\\begin{pmatrix}\n\\frac{2}{3}  \\frac{1}{3}  -\\frac{2}{3} \\\\\n\\frac{1}{3}  \\frac{2}{3}  \\frac{2}{3} \\\\\n-\\frac{2}{3}  \\frac{2}{3}  -\\frac{1}{3}\n\\end{pmatrix}\n\\begin{pmatrix}1 \\\\ 2 \\\\ 2\\end{pmatrix}\n=\n\\begin{pmatrix}0 \\\\ 3 \\\\ 0\\end{pmatrix}=y.\n$$\n因此，所求的元素为有理数的Householder矩阵如上所示。",
            "answer": "$$\\boxed{\\begin{pmatrix}\\frac{2}{3}  \\frac{1}{3}  -\\frac{2}{3} \\\\ \\frac{1}{3}  \\frac{2}{3}  \\frac{2}{3} \\\\ -\\frac{2}{3}  \\frac{2}{3}  -\\frac{1}{3}\\end{pmatrix}}$$"
        },
        {
            "introduction": "在数值计算中，理论上等价的公式在实际应用中可能表现出截然不同的性能。这个高级练习探讨了在构建Householder向量时，一个看似微不足道的符号选择为何至关重要。通过分析，您将揭示“灾难性抵消”错误的根源，并理解如何选择数值上更稳健的方案，这是设计可靠算法的关键一步。",
            "id": "2402000",
            "problem": "考虑实对称矩阵\n$$\nA(\\delta)=\n\\begin{pmatrix}\n2  1  \\delta  0\\\\\n1  3  0  0\\\\\n\\delta  0  4  0\\\\\n0  0  0  5\n\\end{pmatrix},\n$$\n其中 $\\delta>0$ 是一个实参数，且 $\\delta \\ll 1$。在Householder三对角化的第一步中，我们构造一个Householder反射 $H=I-2uu^T$ 作用于后随的 $(n-1)$ 维子空间，以消去对角线下方的第一列元素。令 $x\\in\\mathbb{R}^{3}$ 表示由 $A(\\delta)$ 第一列中 $(1,1)$ 位置下方的元素构成的子向量，即 $x=A(\\delta)_{2:4,1}$。Householder向量的标准构造方法是使用 $v=x\\pm \\alpha e_1$，其中 $\\alpha=\\|x\\|_2$ 且 $e_1=(1,0,0)^T$，然后进行归一化 $u=v/\\|v\\|_2$。这里，两种符号的选择对应于两个代数上等价但在数值上不同的反射。\n\n定义 $v_{\\text{right}}=x+\\alpha e_1$ 和 $v_{\\text{wrong}}=x-\\alpha e_1$。计算下式的精确、闭式解析表达式：\n$$\n\\kappa(\\delta)=\\frac{\\left| \\left(v_{\\text{wrong}}\\right)_1 \\right|}{\\left| \\left(v_{\\text{right}}\\right)_1 \\right|},\n$$\n其中 $\\left(v\\right)_1$ 表示向量 $v$ 的第一个分量。你的最终答案必须是仅含 $\\delta$ 的单个简化解析表达式，不得进行数值近似。",
            "solution": "给定的矩阵是\n$$\nA(\\delta)=\n\\begin{pmatrix}\n2  1  \\delta  0\\\\\n1  3  0  0\\\\\n\\delta  0  4  0\\\\\n0  0  0  5\n\\end{pmatrix}\n$$\n其中 $\\delta > 0$ 是一个实参数。\n\nHouseholder三对角化的第一步针对矩阵的第一列。构造反射所需的向量 $x$ 是 $A(\\delta)$ 第一列中位于主对角线元素 $A(\\delta)_{1,1}$ 下方的子向量。$A(\\delta)$ 的第一列是 $(2, 1, \\delta, 0)^T$。因此，子向量 $x \\in \\mathbb{R}^3$ 为\n$$\nx = \\begin{pmatrix} 1 \\\\ \\delta \\\\ 0 \\end{pmatrix}.\n$$\nHouseholder向量 $v$ 的构造基于 $v = x \\pm \\alpha e_1$，其中 $\\alpha = \\|x\\|_2$ 且 $e_1$ 是 $\\mathbb{R}^3$ 中的第一个标准基向量，$e_1 = (1, 0, 0)^T$。首先，我们计算向量 $x$ 的欧几里得范数 $\\alpha$：\n$$\n\\alpha = \\|x\\|_2 = \\sqrt{1^2 + \\delta^2 + 0^2} = \\sqrt{1 + \\delta^2}.\n$$\n问题为未归一化的Householder向量定义了两种可能的选择：\n$$\nv_{\\text{right}} = x + \\alpha e_1\n$$\n$$\nv_{\\text{wrong}} = x - \\alpha e_1\n$$\n在数值算法中，标准的“正确”选择是，在 $x \\pm \\alpha e_1$ 中选择与 $x$ 的第一个分量符号相同的符号，以避免相消误差。由于 $(x)_1 = 1 > 0$，数值上稳定的选择是 $v_{\\text{right}}$。问题要求计算一个涉及两种选择的比率。\n\n我们来明确地构造这些向量：\n$$\nv_{\\text{right}} = \\begin{pmatrix} 1 \\\\ \\delta \\\\ 0 \\end{pmatrix} + \\sqrt{1 + \\delta^2} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 + \\sqrt{1 + \\delta^2} \\\\ \\delta \\\\ 0 \\end{pmatrix}\n$$\n$$\nv_{\\text{wrong}} = \\begin{pmatrix} 1 \\\\ \\delta \\\\ 0 \\end{pmatrix} - \\sqrt{1 + \\delta^2} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 1 - \\sqrt{1 + \\delta^2} \\\\ \\delta \\\\ 0 \\end{pmatrix}\n$$\n我们需要计算比率 $\\kappa(\\delta)$，其定义为\n$$\n\\kappa(\\delta)=\\frac{\\left| \\left(v_{\\text{wrong}}\\right)_1 \\right|}{\\left| \\left(v_{\\text{right}}\\right)_1 \\right|}.\n$$\n第一个分量分别是 $(v_{\\text{right}})_1 = 1 + \\sqrt{1 + \\delta^2}$ 和 $(v_{\\text{wrong}})_1 = 1 - \\sqrt{1 + \\delta^2}$。\n\n我们计算这些分量的绝对值。由于 $\\delta > 0$，我们有 $\\delta^2 > 0$，这意味着 $1 + \\delta^2 > 1$，因此 $\\sqrt{1 + \\delta^2} > 1$。\n项 $(v_{\\text{right}})_1 = 1 + \\sqrt{1 + \\delta^2}$ 是严格为正的，所以其绝对值就是它本身：\n$$\n\\left| \\left(v_{\\text{right}}\\right)_1 \\right| = 1 + \\sqrt{1 + \\delta^2}.\n$$\n项 $(v_{\\text{wrong}})_1 = 1 - \\sqrt{1 + \\delta^2}$ 是严格为负的。其绝对值是该项的相反数：\n$$\n\\left| \\left(v_{\\text{wrong}}\\right)_1 \\right| = - (1 - \\sqrt{1 + \\delta^2}) = \\sqrt{1 + \\delta^2} - 1.\n$$\n现在，我们可以写出 $\\kappa(\\delta)$ 的表达式：\n$$\n\\kappa(\\delta) = \\frac{\\sqrt{1 + \\delta^2} - 1}{\\sqrt{1 + \\delta^2} + 1}.\n$$\n这个表达式是正确的，但可以进一步简化，特别是为了获得一个在 $\\delta$ 很小（如 $\\delta \\ll 1$ 所暗示的）时进行数值计算更为稳健的形式。这可以通过分子有理化来实现。我们将分子和分母同乘以分子的共轭项，即 $(\\sqrt{1 + \\delta^2} + 1)$：\n$$\n\\kappa(\\delta) = \\left( \\frac{\\sqrt{1 + \\delta^2} - 1}{\\sqrt{1 + \\delta^2} + 1} \\right) \\times \\left( \\frac{\\sqrt{1 + \\delta^2} + 1}{\\sqrt{1 + \\delta^2} + 1} \\right).\n$$\n分子简化为平方差：\n$$\n(\\sqrt{1 + \\delta^2} - 1)(\\sqrt{1 + \\delta^2} + 1) = (\\sqrt{1 + \\delta^2})^2 - 1^2 = (1 + \\delta^2) - 1 = \\delta^2.\n$$\n分母变成一个平方：\n$$\n(\\sqrt{1 + \\delta^2} + 1)(\\sqrt{1 + \\delta^2} + 1) = (\\sqrt{1 + \\delta^2} + 1)^2.\n$$\n结合这些结果，得到 $\\kappa(\\delta)$ 的最终、简化的闭式表达式：\n$$\n\\kappa(\\delta) = \\frac{\\delta^2}{(\\sqrt{1 + \\delta^2} + 1)^2}.\n$$\n这种形式避免了中间表达式分子中存在的相消误差，而这正是区分 $v_{\\text{right}}$ 和 $v_{\\text{wrong}}$ 的全部意义所在。",
            "answer": "$$\\boxed{\\frac{\\delta^2}{\\left(\\sqrt{1 + \\delta^2} + 1\\right)^2}}$$"
        }
    ]
}