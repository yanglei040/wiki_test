{
    "hands_on_practices": [
        {
            "introduction": "要真正掌握龙贝格积分法，最好的方式就是亲手计算一遍。这个练习将引导你完成计算龙贝格表（Romberg tableau）初始项的基本步骤。通过对一个简单的多项式函数进行积分，你将具体地体会到理查森外推法（Richardson extrapolation）是如何逐步提高数值积分精度的。",
            "id": "2198730",
            "problem": "龙贝格积分法是一种数值方法，它通过对梯形法则的结果应用理查森外推法来估计函数的定积分。这些估计值被组织在一个称为龙贝格积分表的三角形阵列中，记为 $R_{k,j}$。第一列 $R_{k,1}$（对于 $k \\geq 1$）是使用具有 $n = 2^{k-1}$ 个子区间的复化梯形法则生成的。后续的项使用以下递推公式计算：\n$$R_{k,j} = R_{k,j-1} + \\frac{1}{4^{j-1} - 1}(R_{k,j-1} - R_{k-1,j-1}) \\quad \\text{for } k \\geq j \\geq 2.$$\n\n考虑多项式函数 $f(x) = 4x^3 - 3x^2 + 5$ 在区间 $[0, 2]$ 上的定积分。你的任务是为这个积分手动计算龙贝格积分表的前三项。\n\n计算 $R_{1,1}$、$R_{2,1}$ 和 $R_{2,2}$ 的值。以包含三个数值 $(R_{1,1}, R_{2,1}, R_{2,2})$ 的行向量形式提供你的答案，结果表示为精确整数。",
            "solution": "我们对函数 $f(x)=4x^{3}-3x^{2}+5$ 在区间 $[a,b]=[0,2]$ 上进行积分。具有 $n$ 个子区间且步长为 $h=\\frac{b-a}{n}$ 的复化梯形法则为\n$$\nT_{n}=\\frac{h}{2}\\left(f(a)+2\\sum_{i=1}^{n-1}f(a+ih)+f(b)\\right).\n$$\n根据定义，$R_{k,1}=T_{2^{\\,k-1}}$。\n\n对于 $R_{1,1}$，取 $n=1$，则 $h=2$。计算 $f(0)=5$ 和 $f(2)=4\\cdot 2^{3}-3\\cdot 2^{2}+5=32-12+5=25$。那么\n$$\nR_{1,1}=T_{1}=\\frac{2}{2}\\left(f(0)+f(2)\\right)=1\\cdot(5+25)=30.\n$$\n\n对于 $R_{2,1}$，取 $n=2$，则 $h=1$，节点为 $0,1,2$。计算 $f(1)=4-3+5=6$。那么\n$$\nR_{2,1}=T_{2}=\\frac{1}{2}\\left(f(0)+2f(1)+f(2)\\right)=\\frac{1}{2}\\left(5+2\\cdot 6+25\\right)=\\frac{42}{2}=21.\n$$\n\n龙贝格外推法使用\n$$\nR_{k,j}=R_{k,j-1}+\\frac{1}{4^{\\,j-1}-1}\\left(R_{k,j-1}-R_{k-1,j-1}\\right), \\quad k\\geq j\\geq 2.\n$$\n因此，\n$$\nR_{2,2}=R_{2,1}+\\frac{1}{4^{1}-1}\\left(R_{2,1}-R_{1,1}\\right)=21+\\frac{1}{3}(21-30)=21-\\frac{9}{3}=18.\n$$\n\n作为一致性检验，精确积分为\n$$\n\\int_{0}^{2}\\left(4x^{3}-3x^{2}+5\\right)\\,dx=\\left(x^{4}-x^{3}+5x\\right)\\bigg|_{0}^{2}=16-8+10=18,\n$$\n这与 $R_{2,2}$ 的值一致，正如对三次多项式所预期的那样。",
            "answer": "$$\\boxed{\\begin{pmatrix}30  21  18\\end{pmatrix}}$$"
        },
        {
            "introduction": "在第一个练习中，你可能已经注意到龙贝格积分对于多项式函数表现出了惊人的准确性。这个练习将从“如何计算”转向“为何有效”，探究该方法精度背后的理论。通过确定哪一列能够精确积分一个5次多项式，你将更深刻地理解龙贝格算法是如何系统性地消除误差项，并达到更高阶的精度。",
            "id": "2198758",
            "problem": "龙贝格积分是一种用于估算函数定积分的数值方法，它将理查森外推法逐级应用于复化梯形法则的结果。结果通常被组织成一个称为龙贝格积分表的三角形阵列，其表项记为 $T_{m,k}$。\n\n第一列，$T_{m,0}$（其中 $m = 0, 1, 2, \\ldots$），包含使用 $2^m$ 个子区间的复化梯形法则得到的近似值。后续各列由以下递推关系生成：\n$$\nT_{m, k} = T_{m, k-1} + \\frac{T_{m, k-1} - T_{m-1, k-1}}{4^k - 1} \\quad \\text{for } k \\ge 1\n$$\n每一列 $k$ 代表了更高阶的精度。对于一个足够光滑的函数，表中的值会收敛到积分的真值。\n\n考虑对一个任意的5次多项式进行积分的任务。存在一个最小的列标 $k$，使得对于任何足够大的行标 $m$，$T_{m,k}$ 的结果不再是近似值，而成为积分的精确值。这个最小的 $k$ 值是多少？\n\nA. 1\n\nB. 2\n\nC. 3\n\nD. 4\n\nE. 5",
            "solution": "设积分为 $I=\\int_{a}^{b} f(x)\\,dx$，并设 $h=(b-a)/2^{m}$。步长为 $h$ 的复化梯形法则是 $T(h)=T_{m,0}$。根据专用于梯形法则的欧拉-麦克劳林展开式，\n$$\nI=T(h)+\\sum_{n=1}^{\\infty}\\frac{B_{2n}}{(2n)!}h^{2n}\\left(f^{(2n-1)}(b)-f^{(2n-1)}(a)\\right),\n$$\n其中 $B_{2n}$ 是伯努利数。如果 $f$ 是一个5次多项式，那么对于 $k\\geq 6$ 有 $f^{(k)}\\equiv 0$。特别地，该级数在 $n=3$ 之后（即 $h^{6}$ 项）截断。此外，当 $n=3$ 时，有 $f^{(5)}$ 为常数，因此 $f^{(5)}(b)-f^{(5)}(a)=0$，所以 $h^6$ 项恒等于零。因此，对于5次多项式，该展开式是精确的，并化简为\n$$\nI=T(h)+c_{2}h^{2}+c_{4}h^{4},\n$$\n其中 $c_{2}=\\frac{B_{2}}{2!}\\left(f'(b)-f'(a)\\right)$ 且 $c_{4}=\\frac{B_{4}}{4!}\\left(f^{(3)}(b)-f^{(3)}(a)\\right)$。\n\n对步长 $2h$ 写出相同的公式：\n$$\nI=T(2h)+c_{2}(2h)^{2}+c_{4}(2h)^{4}.\n$$\n因此\n$$\nT(h)-T(2h)=\\left[I-c_{2}h^{2}-c_{4}h^{4}\\right]-\\left[I-c_{2}(2h)^{2}-c_{4}(2h)^{4}\\right]\n=3c_{2}h^{2}+15c_{4}h^{4}.\n$$\n第一次龙贝格外推（列 $k=1$）为\n$$\nT_{m,1}=T(h)+\\frac{T(h)-T(2h)}{4-1}\n=I-c_{2}h^{2}-c_{4}h^{4}+\\left(c_{2}h^{2}+5c_{4}h^{4}\\right)\n=I+4c_{4}h^{4},\n$$\n于是 $h^{2}$ 项被消去，剩余误差为 $O(h^{4})$。\n\n对 $2h$ 应用相同的方法进行第二次外推。我们有\n$$\nT_{m-1,1}=T(2h)+\\frac{T(2h)-T(4h)}{4-1}=I+4c_{4}(2h)^{4}=I+64c_{4}h^{4}.\n$$\n因此第二次龙贝格外推（列 $k=2$）为\n$$\nT_{m,2}=T_{m,1}+\\frac{T_{m,1}-T_{m-1,1}}{4^{2}-1}\n=\\left(I+4c_{4}h^{4}\\right)+\\frac{\\left(I+4c_{4}h^{4}\\right)-\\left(I+64c_{4}h^{4}\\right)}{16-1}\n=I+4c_{4}h^{4}-\\frac{60c_{4}h^{4}}{15}\n=I.\n$$\n因此，对于任意5次多项式，$T_{m,2}$ 等于精确积分值（对于任何使这些量有定义的 $m$；因此“足够大的 $m$”这一说法是满足的）。等价地，龙贝格积分的第 $k$ 列具有 $2k+1$ 的代数精度，因此 $k=2$ 可以精确地对所有次数不超过5的多项式进行积分。\n\n因此最小的 $k$ 是 $2$。",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "理论和教科书中的例子通常处理的是误差项呈现偶数次幂规律的“良好”函数。然而，实际问题可能更为复杂，这个练习模拟了一个非标准情景：梯形法则的误差不符合通常的规律。这要求你不能再简单套用标准公式，而是需要回归理查森外推法的基本原理，推导出一个修正的算法，这对于培养解决实际问题的能力至关重要。",
            "id": "2198771",
            "problem": "一位工程师正在一个长度为 $L$ 的区间上，对一个专有的非平凡函数 $f(x)$ 测试一个新的数值积分库。他们使用复合梯形法则，并试图使用龙贝格（Romberg）外推法来提高精度。使用 $N=2^{i-1}$ 个子区间的梯形法则近似值记为 $R_{i,0}$。此近似的步长为 $h_i = L/2^{i-1}$。龙贝格表的第一列计算得出为：\n\n$R_{1,0} = 2.79159265$\n$R_{2,0} = 2.85096765$\n$R_{3,0} = 2.97030359$\n$R_{4,0} = 3.04905115$\n\n该工程师观察到，其收敛不是二次的，这与对非常光滑的函数的预期不符。对被积函数 $f(x)$ 的理论分析表明，梯形法则近似的误差 $E(h_i) = I - R_{i,0}$（其中 $I$ 是积分的真值），具有一个以步长 $h_i$ 的整数次幂表示的完整渐近展开式。也就是说，$E(h_i) \\sim \\sum_{k=1}^{\\infty} C_k h_i^k$ 对于某些非零系数 $C_k$，而不是一个仅包含 $h_i$ 偶数次幂的展开式。\n\n基于此信息，确定构建龙贝格表的正确外推流程。使用此流程根据给定数据计算积分的最精确估计值，该值对应于 $R_{4,3}$。\n\n将您的最终答案表示为一个舍入到五位有效数字的实数。",
            "solution": "复合梯形近似值为 $R_{i,0}$，步长为 $h_{i} = L/2^{i-1}$。误差满足一个以所有整数次幂展开的渐近展开式，\n$$\nR_{i,0} = I + \\sum_{k=1}^{\\infty} C_{k} h_{i}^{k}, \\quad C_{k} \\neq 0 \\text{ in general}.\n$$\n由于 $h_{i-1} = 2 h_{i}$，两个相继的近似值展开为\n$$\nR_{i,0} = I + C_{1} h_{i} + C_{2} h_{i}^{2} + C_{3} h_{i}^{3} + \\cdots,\n$$\n$$\nR_{i-1,0} = I + C_{1} (2 h_{i}) + C_{2} (2 h_{i})^{2} + C_{3} (2 h_{i})^{3} + \\cdots = I + \\sum_{k=1}^{\\infty} C_{k} 2^{k} h_{i}^{k}.\n$$\n为消除首项 $h_{i}^{1}$，构造因子为2的理查森（Richardson）组合：\n$$\nR_{i,1} = \\frac{2 R_{i,0} - R_{i-1,0}}{2 - 1} = 2 R_{i,0} - R_{i-1,0}.\n$$\n其误差从 $O(h_{i}^{2})$ 开始。重复此逻辑，经过 $j-1$ 次外推后，首项误差为 $O(h_{i}^{j})$，因此下一次消除使用因子 $2^{j}$。因此，对于一个以所有整数次幂展开的误差，正确的类龙贝格递推关系为\n$$\nR_{i,j} = \\frac{2^{j} R_{i,j-1} - R_{i-1,j-1}}{2^{j} - 1}, \\quad j \\geq 1.\n$$\n\n使用给定的第一列：\n$$\nR_{1,0} = 2.79159265,\\quad R_{2,0} = 2.85096765,\\quad R_{3,0} = 2.97030359,\\quad R_{4,0} = 3.04905115,\n$$\n计算该表：\n\n第一次外推 ($j=1$):\n$$\nR_{2,1} = 2 R_{2,0} - R_{1,0} = 2.91034265,\n$$\n$$\nR_{3,1} = 2 R_{3,0} - R_{2,0} = 3.08963953,\n$$\n$$\nR_{4,1} = 2 R_{4,0} - R_{3,0} = 3.12779871.\n$$\n\n第二次外推 ($j=2$):\n$$\nR_{3,2} = \\frac{4 R_{3,1} - R_{2,1}}{3} = \\frac{4 \\cdot 3.08963953 - 2.91034265}{3} = 3.1494051566666667,\n$$\n$$\nR_{4,2} = \\frac{4 R_{4,1} - R_{3,1}}{3} = \\frac{4 \\cdot 3.12779871 - 3.08963953}{3} = 3.1405184366666667.\n$$\n\n第三次外推 ($j=3$):\n$$\nR_{4,3} = \\frac{8 R_{4,2} - R_{3,2}}{7} = \\frac{8 \\cdot 3.1405184366666667 - 3.1494051566666667}{7} = 3.139249048095238.\n$$\n\n因此，从给定数据得到的最精确估计值为 $R_{4,3} \\approx 3.139249048095238$，舍入到五位有效数字为 $3.1392$。",
            "answer": "$$\\boxed{3.1392}$$"
        }
    ]
}