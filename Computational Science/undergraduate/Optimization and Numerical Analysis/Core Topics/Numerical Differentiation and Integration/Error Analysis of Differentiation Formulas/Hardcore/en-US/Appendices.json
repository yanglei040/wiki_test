{
    "hands_on_practices": [
        {
            "introduction": "Before we analyze the error in numerical formulas, it's enlightening to see how they are constructed. This first practice invites you to derive the well-known central difference formula using the method of undetermined coefficients. By requiring the formula to be exact for polynomials up to a certain degree, we can systematically solve for the coefficients, giving us insight into the origins of the formula's structure and its inherent accuracy .",
            "id": "2169453",
            "problem": "Consider the task of approximating the first derivative, $f'(x)$, of a sufficiently smooth function $f(x)$ using a linear combination of its values at three equally spaced points: $x-h$, $x$, and $x+h$, where $h$ is a small positive step size. The proposed approximation has the general form:\n$$ f'(x) \\approx A f(x-h) + B f(x) + C f(x+h) $$\nYour goal is to determine the coefficients $A$, $B$, and $C$ as functions of the step size $h$. These coefficients must be chosen such that the formula yields the exact value of the derivative for any arbitrary polynomial of degree two or less.\n\nPresent your answer as a row matrix containing the symbolic expressions for the coefficients $A$, $B$, and $C$, in that order.",
            "solution": "We assume $f$ is sufficiently smooth and expand $f(x\\pm h)$ about $x$ using the Taylor series:\n$$\nf(x+h)=f(x)+h f'(x)+\\frac{h^{2}}{2} f''(x)+\\frac{h^{3}}{6} f^{(3)}(x)+\\cdots,\n$$\n$$\nf(x-h)=f(x)-h f'(x)+\\frac{h^{2}}{2} f''(x)-\\frac{h^{3}}{6} f^{(3)}(x)+\\cdots.\n$$\nForm the linear combination $A f(x-h)+B f(x)+C f(x+h)$.\nSubstituting the Taylor expansions and collecting like terms yields\n$$\n(A+B+C)f(x)+(C-A)h f'(x)+(A+C)\\frac{h^{2}}{2} f''(x)+(C-A)\\frac{h^{3}}{6} f^{(3)}(x)+\\cdots.\n$$\nTo reproduce $f'(x)$ exactly for any polynomial of degree at most two, we must match the coefficients of $f(x)$, $f'(x)$, and $f''(x)$ to give\n$$\nA+B+C=0,\\qquad (C-A)h=1,\\qquad (A+C)\\frac{h^{2}}{2}=0.\n$$\nFrom $A+C=0$ we have $C=-A$. Substituting into $(C-A)h=1$ gives $(-A-A)h=-2Ah=1$, so $A=-\\frac{1}{2h}$ and hence $C=\\frac{1}{2h}$. Finally, from $A+B+C=0$ we get $B=0$.\n\nTherefore, the coefficients are $A=-\\frac{1}{2h}$, $B=0$, and $C=\\frac{1}{2h}$, which yield the centered difference formula exact for polynomials up to degree two.",
            "answer": "$$\\boxed{\\begin{pmatrix}-\\frac{1}{2h} & 0 & \\frac{1}{2h}\\end{pmatrix}}$$"
        },
        {
            "introduction": "Once a numerical differentiation formula is established, the next critical step is to understand its limitations by analyzing its truncation error. This exercise uses the power of Taylor series expansions to dissect the central difference formula and derive the precise leading term of its error. This analytical approach provides a theoretical foundation for the formula's convergence rate, revealing how the error depends on both the step size $h$ and the higher-order derivatives of the function itself .",
            "id": "2169420",
            "problem": "In numerical analysis, the central difference formula is a common method for approximating the derivative of a function. For a sufficiently smooth function $f(x)$, the first derivative $f'(x)$ can be approximated using the formula:\n$$\nD(h) = \\frac{f(x+h) - f(x-h)}{2h}\n$$\nwhere $h$ is a small step size. The truncation error of this approximation is defined as $E(x, h) = D(h) - f'(x)$. For small values of $h$, this error can be expressed as a power series in $h$, with the leading term dominating the behavior. This leading term is of the form $C(x)h^p$ for some integer $p$ and a function $C(x)$ that depends on the properties of $f(x)$.\n\nConsider the specific function $f(x) = \\alpha x^4$, where $\\alpha$ is a non-zero constant. It is known that for the central difference formula, the approximation is second-order accurate, meaning the leading error term has $p=2$. Your task is to determine the exact expression for the function $C(x)$ in the leading error term, which takes the form $C(x)h^2$.",
            "solution": "We start with the central difference approximation for the first derivative,\n$$\nD(h) = \\frac{f(x+h) - f(x-h)}{2h},\n$$\nand define the truncation error as $E(x,h) = D(h) - f'(x)$. Using Taylor expansions of $f(x \\pm h)$ about $x$,\n$$\nf(x+h) = f(x) + f'(x)h + \\frac{f''(x)}{2}h^{2} + \\frac{f^{(3)}(x)}{6}h^{3} + \\frac{f^{(4)}(x)}{24}h^{4} + \\frac{f^{(5)}(x)}{120}h^{5} + \\cdots,\n$$\n$$\nf(x-h) = f(x) - f'(x)h + \\frac{f''(x)}{2}h^{2} - \\frac{f^{(3)}(x)}{6}h^{3} + \\frac{f^{(4)}(x)}{24}h^{4} - \\frac{f^{(5)}(x)}{120}h^{5} + \\cdots.\n$$\nSubtracting and dividing by $2h$ gives\n$$\nD(h) = f'(x) + \\frac{f^{(3)}(x)}{6}h^{2} + \\frac{f^{(5)}(x)}{120}h^{4} + \\cdots,\n$$\nso the leading truncation error term is\n$$\nE(x,h) = \\frac{f^{(3)}(x)}{6}h^{2} + O(h^{4}).\n$$\nFor $f(x) = \\alpha x^{4}$, we compute derivatives:\n$f'(x) = 4\\alpha x^{3}$, $f''(x) = 12\\alpha x^{2}$, $f^{(3)}(x) = 24\\alpha x$, $f^{(5)}(x) = 0$.\nTherefore,\n$$\nE(x,h) = \\frac{24\\alpha x}{6}h^{2} = 4\\alpha x h^{2},\n$$\nwhich shows that the leading error term has $p=2$ with\n$$\nC(x) = 4\\alpha x.\n$$\nAs a consistency check, compute $D(h)$ exactly for this polynomial:\n$$\nf(x+h) - f(x-h) = \\alpha\\big((x+h)^{4} - (x-h)^{4}\\big) = \\alpha\\big(8x^{3}h + 8x h^{3}\\big),\n$$\nso\n$$\nD(h) = \\frac{\\alpha(8x^{3}h + 8x h^{3})}{2h} = 4\\alpha x^{3} + 4\\alpha x h^{2},\n$$\nand hence $E(x,h) = 4\\alpha x h^{2}$, confirming $C(x) = 4\\alpha x$.",
            "answer": "$$\\boxed{4\\alpha x}$$"
        },
        {
            "introduction": "Theoretical analysis gives us the expected behavior of an approximation, but numerical verification provides concrete confirmation. In this final practice, you will bridge the gap between theory and computation by applying the central difference formula to a specific trigonometric function. By calculating the actual error for a small step size $h$, you can numerically estimate the constant $C$ in the leading error term $Ch^2$, thereby demonstrating in a practical scenario the $O(h^2)$ accuracy that we predict with analytical methods .",
            "id": "2169444",
            "problem": "A student in a numerical analysis course is investigating the error associated with the central difference formula for approximating the first derivative of a function. The central difference approximation, $D_h(f, x_0)$, for the derivative of a function $f(x)$ at a point $x_0$ with a small step size $h$ is given by:\n$$D_h(f, x_0) = \\frac{f(x_0+h) - f(x_0-h)}{2h}$$\nFor a sufficiently smooth function, the absolute error of this approximation, defined as $E(h) = |D_h(f, x_0) - f'(x_0)|$, is expected to scale with the square of the step size. This relationship can be expressed as $E(h) \\approx C h^2$ for some non-zero constant $C$ when $h$ is small.\n\nYour task is to compute a numerical estimate for this constant $C$ for the function $f(x) = \\cos(2x)$ at the point $x_0 = \\frac{\\pi}{6}$. To do this, use a step size of $h = 0.01$ and the formula $C \\approx \\frac{E(h)}{h^2}$.\n\nEnsure all trigonometric calculations are performed in radians. Round your final answer to four significant figures.",
            "solution": "We are given $f(x)=\\cos(2x)$, $x_{0}=\\frac{\\pi}{6}$, and $h=0.01$. The central difference is\n$$\nD_{h}(f, x_{0})=\\frac{f(x_{0}+h)-f(x_{0}-h)}{2h}\n=\\frac{\\cos(2x_{0}+2h)-\\cos(2x_{0}-2h)}{2h}.\n$$\nUsing $\\cos A-\\cos B=-2\\sin\\left(\\frac{A+B}{2}\\right)\\sin\\left(\\frac{A-B}{2}\\right)$ with $A=2x_{0}+2h$ and $B=2x_{0}-2h$ gives\n$$\nD_{h}(f, x_{0})=\\frac{-2\\sin(2x_{0})\\sin(2h)}{2h}\n=-\\frac{\\sin(2x_{0})}{h}\\sin(2h).\n$$\nThe exact derivative is $f'(x)=-2\\sin(2x)$, so\n$$\nf'(x_{0})=-2\\sin(2x_{0}).\n$$\nAt $x_{0}=\\frac{\\pi}{6}$, we have $2x_{0}=\\frac{\\pi}{3}$ and $\\sin\\!\\left(\\frac{\\pi}{3}\\right)=\\frac{\\sqrt{3}}{2}$, hence\n$$\nD_{h}(f, x_{0})=-\\frac{\\sqrt{3}}{2}\\,\\frac{\\sin(2h)}{h},\n\\qquad\nf'(x_{0})=-\\sqrt{3}.\n$$\nTherefore the absolute error is\n$$\nE(h)=\\left|D_{h}(f, x_{0})-f'(x_{0})\\right|\n=\\sqrt{3}\\left|1-\\frac{1}{2}\\frac{\\sin(2h)}{h}\\right|.\n$$\nWith $h=0.01$ (radians), we have $2h=0.02$. Using the Taylor series $\\sin x=x-\\frac{x^{3}}{3!}+\\frac{x^{5}}{5!}-\\frac{x^{7}}{7!}+\\cdots$, we compute\n$$\n\\sin(0.02)\\approx 0.02-\\frac{0.02^{3}}{6}+\\frac{0.02^{5}}{120}-\\frac{0.02^{7}}{5040}\n=0.01999866669333308.\n$$\nThen\n$$\n\\frac{1}{2}\\frac{\\sin(0.02)}{0.01}=50\\sin(0.02)\\approx 0.999933334666654,\n$$\nso\n$$\n\\left|1-\\frac{1}{2}\\frac{\\sin(2h)}{h}\\right|\n=\\left|1-50\\sin(0.02)\\right|\\approx 6.6665333346\\times 10^{-5}.\n$$\nThus\n$$\nE(h)\\approx \\sqrt{3}\\times 6.6665333346\\times 10^{-5}\\approx 1.154677444\\times 10^{-4}.\n$$\nThe requested estimate is\n$$\nC\\approx \\frac{E(h)}{h^{2}}=\\frac{1.154677444\\times 10^{-4}}{(0.01)^{2}}\n\\approx 1.154677444.\n$$\nRounding to four significant figures gives $C\\approx 1.155$.",
            "answer": "$$\\boxed{1.155}$$"
        }
    ]
}