{
    "hands_on_practices": [
        {
            "introduction": "数值微分公式并非凭空而来；它们是通过系统性的方法构建的，以在特定假设下达到最佳精度。这个练习将引导你使用待定系数法——一种强大技术，通过强制公式对简单函数（如多项式）精确成立来推导公式系数。通过完成这个练习，你将亲手构建出最常见和最准确的数值微分公式之一：中心差分公式。",
            "id": "2169453",
            "problem": "考虑使用一个足够光滑的函数 $f(x)$ 在三个等距点 $x-h$、$x$ 和 $x+h$ 处的函数值的线性组合来逼近其一阶导数 $f'(x)$ 的任务，其中 $h$ 是一个小的正步长。所提出的逼近具有以下一般形式：\n$$ f'(x) \\approx A f(x-h) + B f(x) + C f(x+h) $$\n你的目标是确定系数 $A$、$B$ 和 $C$ 作为步长 $h$ 的函数。选择这些系数时，必须使得该公式对于任何二次或更低次的多项式都能得出其导数的精确值。\n\n将你的答案表示为一个行矩阵，其中按顺序包含系数 $A$、$B$ 和 $C$ 的符号表达式。",
            "solution": "我们假设 $f$ 足够光滑，并使用泰勒级数将 $f(x\\pm h)$ 在 $x$ 点展开：\n$$\nf(x+h)=f(x)+h f'(x)+\\frac{h^{2}}{2} f''(x)+\\frac{h^{3}}{6} f^{(3)}(x)+\\cdots,\n$$\n$$\nf(x-h)=f(x)-h f'(x)+\\frac{h^{2}}{2} f''(x)-\\frac{h^{3}}{6} f^{(3)}(x)+\\cdots.\n$$\n构造线性组合：\n$$\nA f(x-h)+B f(x)+C f(x+h).\n$$\n代入泰勒展开式并合并同类项可得\n$$\nA f(x-h)+B f(x)+C f(x+h)=(A+B+C)f(x)+(C-A)h f'(x)+(A+C)\\frac{h^{2}}{2} f''(x)+(C-A)\\frac{h^{3}}{6} f^{(3)}(x)+\\cdots.\n$$\n为了使该公式对任意次数至多为二的多项式都能精确地得到 $f'(x)$，我们必须匹配 $f(x)$、$f'(x)$ 和 $f''(x)$ 的系数，使其满足\n$$\nA+B+C=0,\\qquad (C-A)h=1,\\qquad (A+C)\\frac{h^{2}}{2}=0.\n$$\n由 $A+C=0$ 可得 $C=-A$。将其代入 $(C-A)h=1$ 可得 $(-A-A)h=-2Ah=1$，所以 $A=-\\frac{1}{2h}$，因此 $C=\\frac{1}{2h}$。最后，由 $A+B+C=0$ 可得 $B=0$。\n\n因此，系数为 $A=-\\frac{1}{2h}$、$B=0$ 和 $C=\\frac{1}{2h}$，这得到了中心差分公式，该公式对次数最高为二的多项式是精确的。",
            "answer": "$$\\boxed{\\begin{pmatrix}-\\frac{1}{2h}  0  \\frac{1}{2h}\\end{pmatrix}}$$"
        },
        {
            "introduction": "推导出公式后，下一个关键问题是：“它的误差有多大？” 这个练习深入探讨了截断误差的分析根源，即由用有限差分代替无限小导数而产生的误差。通过对一个简单的多项式函数应用泰勒级数展开，你将精确地推导出中心差分公式的主导误差项，从而揭示误差如何依赖于函数本身及其步长 $h$。",
            "id": "2169420",
            "problem": "在数值分析中，中心差分公式是近似函数导数的一种常用方法。对于一个足够光滑的函数 $f(x)$，其一阶导数 $f'(x)$ 可以用以下公式来近似：\n$$\nD(h) = \\frac{f(x+h) - f(x-h)}{2h}\n$$\n其中 $h$ 是一个很小的步长。该近似的截断误差定义为 $E(x, h) = D(h) - f'(x)$。对于较小的 $h$ 值，这个误差可以表示为 $h$ 的幂级数，其中主项决定了其行为。该主项的形式为 $C(x)h^p$，其中 $p$ 是某个整数，$C(x)$ 是一个依赖于 $f(x)$ 性质的函数。\n\n考虑具体函数 $f(x) = \\alpha x^4$，其中 $\\alpha$ 是一个非零常数。已知对于中心差分公式，该近似是二阶精度的，这意味着主误差项的 $p=2$。你的任务是确定主误差项 $C(x)h^2$ 中函数 $C(x)$ 的精确表达式。",
            "solution": "我们从一阶导数的中心差分近似开始，\n$$\nD(h) = \\frac{f(x+h) - f(x-h)}{2h},\n$$\n并将截断误差定义为 $E(x,h) = D(h) - f'(x)$。使用 $f(x \\pm h)$ 在 $x$ 点的泰勒展开，\n$$\nf(x+h) = f(x) + f'(x)h + \\frac{f''(x)}{2}h^{2} + \\frac{f^{(3)}(x)}{6}h^{3} + \\frac{f^{(4)}(x)}{24}h^{4} + \\frac{f^{(5)}(x)}{120}h^{5} + \\cdots,\n$$\n$$\nf(x-h) = f(x) - f'(x)h + \\frac{f''(x)}{2}h^{2} - \\frac{f^{(3)}(x)}{6}h^{3} + \\frac{f^{(4)}(x)}{24}h^{4} - \\frac{f^{(5)}(x)}{120}h^{5} + \\cdots.\n$$\n相减后除以 $2h$ 得到\n$$\nD(h) = f'(x) + \\frac{f^{(3)}(x)}{6}h^{2} + \\frac{f^{(5)}(x)}{120}h^{4} + \\cdots,\n$$\n因此，主截断误差项为\n$$\nE(x,h) = \\frac{f^{(3)}(x)}{6}h^{2} + O(h^{4}).\n$$\n对于 $f(x) = \\alpha x^{4}$，我们计算其导数：\n$$\nf'(x) = 4\\alpha x^{3}, \\quad f''(x) = 12\\alpha x^{2}, \\quad f^{(3)}(x) = 24\\alpha x, \\quad f^{(5)}(x) = 0.\n$$\n因此，\n$$\nE(x,h) = \\frac{24\\alpha x}{6}h^{2} = 4\\alpha x\\, h^{2},\n$$\n这表明主误差项的 $p=2$，且\n$$\nC(x) = 4\\alpha x.\n$$\n作为一致性检验，我们对这个多项式精确地计算 $D(h)$：\n$$\nf(x+h) - f(x-h) = \\alpha\\big((x+h)^{4} - (x-h)^{4}\\big) = \\alpha\\big(8x^{3}h + 8x h^{3}\\big),\n$$\n所以\n$$\nD(h) = \\frac{\\alpha(8x^{3}h + 8x h^{3})}{2h} = 4\\alpha x^{3} + 4\\alpha x h^{2},\n$$\n因此 $E(x,h) = 4\\alpha x h^{2}$，这证实了 $C(x) = 4\\alpha x$。",
            "answer": "$$\\boxed{4\\alpha x}$$"
        },
        {
            "introduction": "理论分析为我们提供了误差行为的预期，但数值实验是验证这些理论是否适用于更复杂函数的关键。在这个练习中，你将把理论付诸实践，通过为一个超越函数（三角函数）计算中心差分近似，并验证其截断误差确实如理论预测的那样与步长的平方 ($h^2$) 成正比。这有力地连接了抽象的误差公式与具体的计算结果。",
            "id": "2169444",
            "problem": "一位数值分析课程的学生正在研究使用中心差分公式近似函数一阶导数时产生的误差。对于一个函数 $f(x)$ 在点 $x_0$ 处的导数，使用一个小的步长 $h$ 的中心差分近似 $D_h(f, x_0)$ 由下式给出：\n$$D_h(f, x_0) = \\frac{f(x_0+h) - f(x_0-h)}{2h}$$\n对于一个足够光滑的函数，此近似的绝对误差，定义为 $E(h) = |D_h(f, x_0) - f'(x_0)|$，预期与步长的平方成正比。当 $h$ 很小时，这种关系可以表示为 $E(h) \\approx C h^2$，其中 $C$ 是某个非零常数。\n\n你的任务是为函数 $f(x) = \\cos(2x)$ 在点 $x_0 = \\frac{\\pi}{6}$ 处计算这个常数 $C$ 的数值估计。为此，请使用步长 $h = 0.01$ 和公式 $C \\approx \\frac{E(h)}{h^2}$。\n\n确保所有三角函数计算都以弧度为单位进行。将你的最终答案四舍五入到四位有效数字。",
            "solution": "我们已知 $f(x)=\\cos(2x)$，$x_{0}=\\frac{\\pi}{6}$，以及 $h=0.01$。中心差分为\n$$\nD_{h}(f,x_{0})=\\frac{f(x_{0}+h)-f(x_{0}-h)}{2h}\n=\\frac{\\cos(2x_{0}+2h)-\\cos(2x_{0}-2h)}{2h}.\n$$\n使用公式 $\\cos A-\\cos B=-2\\sin\\left(\\frac{A+B}{2}\\right)\\sin\\left(\\frac{A-B}{2}\\right)$，并令 $A=2x_{0}+2h$ 和 $B=2x_{0}-2h$，得到\n$$\nD_{h}(f,x_{0})=\\frac{-2\\sin(2x_{0})\\sin(2h)}{2h}\n=-\\frac{\\sin(2x_{0})}{h}\\sin(2h).\n$$\n精确导数为 $f'(x)=-2\\sin(2x)$，所以\n$$\nf'(x_{0})=-2\\sin(2x_{0}).\n$$\n在 $x_{0}=\\frac{\\pi}{6}$ 处，$2x_{0}=\\frac{\\pi}{3}$ 且 $\\sin\\!\\left(\\frac{\\pi}{3}\\right)=\\frac{\\sqrt{3}}{2}$，因此\n$$\nD_{h}(f,x_{0})=-\\frac{\\sqrt{3}}{2}\\,\\frac{\\sin(2h)}{h},\n\\qquad\nf'(x_{0})=-\\sqrt{3}.\n$$\n因此，绝对误差为\n$$\nE(h)=\\left|D_{h}(f,x_{0})-f'(x_{0})\\right|\n=\\sqrt{3}\\left|1-\\frac{1}{2}\\frac{\\sin(2h)}{h}\\right|.\n$$\n当 $h=0.01$ (弧度)，$2h=0.02$ 时，使用泰勒级数 $\\sin x=x-\\frac{x^{3}}{3!}+\\frac{x^{5}}{5!}-\\frac{x^{7}}{7!}+\\cdots$，我们计算\n$$\n\\sin(0.02)\\approx 0.02-\\frac{0.02^{3}}{6}+\\frac{0.02^{5}}{120}-\\frac{0.02^{7}}{5040}\n=0.01999866669333308.\n$$\n接着\n$$\n\\frac{1}{2}\\frac{\\sin(0.02)}{0.01}=50\\sin(0.02)\\approx 0.999933334666654,\n$$\n所以\n$$\n\\left|1-\\frac{1}{2}\\frac{\\sin(2h)}{h}\\right|\n=\\left|1-50\\sin(0.02)\\right|\\approx 6.6665333346\\times 10^{-5}.\n$$\n于是\n$$\nE(h)\\approx \\sqrt{3}\\times 6.6665333346\\times 10^{-5}\\approx 1.154677444\\times 10^{-4}.\n$$\n所求的估计值为\n$$\nC\\approx \\frac{E(h)}{h^{2}}=\\frac{1.154677444\\times 10^{-4}}{(0.01)^{2}}\n\\approx 1.154677444.\n$$\n四舍五入到四位有效数字，得到 $C\\approx 1.155$。",
            "answer": "$$\\boxed{1.155}$$"
        }
    ]
}