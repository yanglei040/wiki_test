{
    "hands_on_practices": [
        {
            "introduction": "One of the most practical questions in numerical integration is determining the computational effort required to achieve a desired level of accuracy. The theoretical error bounds for quadrature rules provide the answer. This exercise  guides you through using the error formula for the composite Trapezoidal Rule to find the minimum number of subintervals needed to guarantee that your approximation is within a specified tolerance, a fundamental skill for any computational scientist.",
            "id": "2180744",
            "problem": "A numerical analyst is tasked with approximating the definite integral $I = \\int_{0}^{\\pi} \\exp(\\cos(x)) dx$ using the composite Trapezoidal Rule. The goal is to ensure that the absolute error of the approximation is no more than a specified tolerance of $\\epsilon = 5.0 \\times 10^{-3}$.\n\nThe error bound for the composite Trapezoidal Rule when approximating $\\int_{a}^{b} f(x) dx$ with $n$ uniform subintervals is given by the inequality:\n$$|E_T| \\leq \\frac{K(b-a)^3}{12n^2}$$\nwhere $K$ is a constant such that $|f''(x)| \\leq K$ for all $x$ in the interval $[a, b]$.\n\nFor the specific function $f(x) = \\exp(\\cos(x))$ on the interval $[0, \\pi]$, it is given that the second derivative is bounded by K, where a valid upper bound is the constant $K=e$, Euler's number.\n\nDetermine the minimum number of subintervals, $n$, required to guarantee that the absolute error of the approximation is less than or equal to the specified tolerance $\\epsilon$. The final answer must be an integer.",
            "solution": "We require the composite Trapezoidal Rule error bound to be at most the tolerance. The error bound is\n$$|E_{T}| \\leq \\frac{K(b-a)^{3}}{12 n^{2}}.$$\nTo guarantee $|E_{T}| \\leq \\epsilon$, it suffices to impose\n$$\\frac{K(b-a)^{3}}{12 n^{2}} \\leq \\epsilon.$$\nSolving for $n$ gives\n$$n^{2} \\geq \\frac{K(b-a)^{3}}{12\\,\\epsilon}, \\quad \\text{so} \\quad n \\geq \\sqrt{\\frac{K(b-a)^{3}}{12\\,\\epsilon}}.$$\nFor $f(x)=\\exp(\\cos x)$ on $[0,\\pi]$, we are given $K=\\exp(1)$, $a=0$, $b=\\pi$, and $\\epsilon=5.0 \\times 10^{-3}$. Substituting,\n$$n \\geq \\sqrt{\\frac{\\exp(1)\\,\\pi^{3}}{12\\,(5.0 \\times 10^{-3})}}.$$\nSince $12\\,(5.0 \\times 10^{-3})=6.0 \\times 10^{-2}=\\frac{3}{50}$, this simplifies to\n$$n \\geq \\sqrt{\\frac{\\exp(1)\\,\\pi^{3}}{3/50}}=\\sqrt{\\frac{50}{3}\\,\\exp(1)\\,\\pi^{3}}.$$\nNumerically,\n$$\\exp(1)\\,\\pi^{3} \\approx 84.283798678,\\quad \\frac{50}{3}\\,\\exp(1)\\,\\pi^{3} \\approx 1404.72997797,$$\nso\n$$n \\geq \\sqrt{1404.72997797} \\approx 37.4797.$$\nTherefore, the minimum integer $n$ that guarantees the error tolerance is met is\n$$n_{\\min}=\\lceil 37.4797 \\rceil=38.$$",
            "answer": "$$\\boxed{38}$$"
        },
        {
            "introduction": "Textbook examples of composite rules often use a number of intervals that is a perfect multiple for the chosen rule. In practice, however, data or problem constraints might give you an arbitrary number of subintervals. This problem  demonstrates a flexible and powerful strategy: combining different quadrature rules (Simpson's 1/3 and 3/8 rules) to handle an interval that cannot be covered by either rule alone.",
            "id": "2180764",
            "problem": "A common task in scientific computing is to evaluate definite integrals of functions that do not have simple antiderivatives. Consider the integral of the function $f(x) = (x+1)\\ln(x+1)$ over a specific interval:\n$$I = \\int_{0}^{4} (x+1)\\ln(x+1) \\, dx$$\nYou are to approximate this integral by dividing the interval $[0, 4]$ into five equal subintervals. To perform the numerical integration, you must use a composite strategy. Apply Simpson's 1/3 rule to the first two subintervals and Simpson's 3/8 rule to the remaining three subintervals.\n\nCalculate the approximate value of the integral $I$. Round your final answer to five significant figures.",
            "solution": "We partition $[0,4]$ into $5$ equal subintervals, so the step size is $h=\\frac{4-0}{5}=0.8$. The nodes are $x_{0}=0$, $x_{1}=0.8$, $x_{2}=1.6$, $x_{3}=2.4$, $x_{4}=3.2$, $x_{5}=4$. Let $f(x)=(x+1)\\ln(x+1)$ and define $f_{i}=f(x_{i})$.\n\nCompute the function values using $y_{i}=x_{i}+1$:\n$$y_{0}=1,\\ y_{1}=1.8,\\ y_{2}=2.6,\\ y_{3}=3.4,\\ y_{4}=4.2,\\ y_{5}=5,$$\n$$f_{0}=1\\cdot \\ln 1=0,$$\n$$f_{1}=1.8\\ln(1.8)\\approx 1.0580159968236,$$\n$$f_{2}=2.6\\ln(2.6)\\approx 2.4843297570702,$$\n$$f_{3}=3.4\\ln(3.4)\\approx 4.1608364675148,$$\n$$f_{4}=4.2\\ln(4.2)\\approx 6.0273550062138,$$\n$$f_{5}=5\\ln(5)\\approx 8.0471895621700.$$\n\nApply Simpson’s $1/3$ rule to the first two subintervals $[x_{0},x_{2}]$:\n$$I_{0\\to 2}\\approx \\frac{h}{3}\\left[f_{0}+4f_{1}+f_{2}\\right]=\\frac{0.8}{3}\\left[0+4(1.0580159968236)+2.4843297570702\\right]\\approx 1.791038331831.$$\n\nApply Simpson’s $3/8$ rule to the remaining three subintervals $[x_{2},x_{5}]$:\n$$I_{2\\to 5}\\approx \\frac{3h}{8}\\left[f_{2}+3f_{3}+3f_{4}+f_{5}\\right]=\\frac{3(0.8)}{8}\\left[2.4843297570702+3(4.1608364675148)+3(6.0273550062138)+8.0471895621700\\right]\\approx 12.328828122128.$$\n\nThe composite approximation is\n$$I\\approx I_{0\\to 2}+I_{2\\to 5}\\approx 1.791038331831+12.328828122128=14.119866453959.$$\n\nRounding to five significant figures gives $14.120$.",
            "answer": "$$\\boxed{14.120}$$"
        },
        {
            "introduction": "Standard numerical integration methods perform best on smooth, well-behaved functions. When an integrand has a singularity, as is common in physics and engineering models, these methods can become slow and inaccurate. This advanced exercise  introduces a sophisticated technique known as product integration, where you will derive a custom quadrature rule specifically designed to handle a singular integrand by approximating only its smooth component.",
            "id": "2180738",
            "problem": "Consider the numerical approximation of integrals of the form $I = \\int_0^1 x^{-1/2} g(x) dx$, where $g(x)$ is a smooth function defined on the interval $[0, 1]$. Standard quadrature methods can be inefficient for such integrals due to the singularity of the term $x^{-1/2}$ at the lower limit of integration.\n\nAn alternative approach, known as a product integration rule, can be constructed. In this method, the smooth part of the integrand, $g(x)$, is replaced by an interpolating polynomial, and the resulting expression is integrated analytically.\n\nYour task is to derive a two-point product integration rule for this integral. Specifically, approximate $g(x)$ with a linear polynomial $P_1(x)$ that interpolates $g(x)$ at the nodes $x_1 = 1/4$ and $x_2 = 3/4$. The quadrature rule that approximates the integral will have the form $w_1 g(x_1) + w_2 g(x_2)$.\n\nDetermine the values of the weights $w_1$ and $w_2$. Express your final answer as a pair of exact fractions, with $w_1$ first and $w_2$ second.",
            "solution": "We approximate $I=\\int_{0}^{1} x^{-1/2} g(x)\\, dx$ by replacing $g(x)$ with its linear interpolant $P_{1}(x)$ through $x_{1}=\\frac{1}{4}$ and $x_{2}=\\frac{3}{4}$. Using the Lagrange basis,\n$$\nP_{1}(x)=g(x_{1})L_{1}(x)+g(x_{2})L_{2}(x),\\quad\nL_{1}(x)=\\frac{x-x_{2}}{x_{1}-x_{2}},\\quad L_{2}(x)=\\frac{x-x_{1}}{x_{2}-x_{1}}.\n$$\nWith $x_{1}=\\frac{1}{4}$ and $x_{2}=\\frac{3}{4}$, we have $x_{1}-x_{2}=-\\frac{1}{2}$ and $x_{2}-x_{1}=\\frac{1}{2}$, hence\n$$\nL_{1}(x)=\\frac{x-\\frac{3}{4}}{-\\frac{1}{2}}=-2x+\\frac{3}{2},\\qquad\nL_{2}(x)=\\frac{x-\\frac{1}{4}}{\\frac{1}{2}}=2x-\\frac{1}{2}.\n$$\nThe product integration rule is\n$$\nI \\approx \\int_{0}^{1} x^{-1/2} P_{1}(x)\\, dx\n= g(x_{1}) \\int_{0}^{1} x^{-1/2} L_{1}(x)\\, dx + g(x_{2}) \\int_{0}^{1} x^{-1/2} L_{2}(x)\\, dx,\n$$\nso the weights are\n$$\nw_{1}=\\int_{0}^{1} x^{-1/2} L_{1}(x)\\, dx=\\int_{0}^{1} x^{-1/2}\\left(-2x+\\frac{3}{2}\\right) dx,\n\\qquad\nw_{2}=\\int_{0}^{1} x^{-1/2} L_{2}(x)\\, dx=\\int_{0}^{1} x^{-1/2}\\left(2x-\\frac{1}{2}\\right) dx.\n$$\nUsing the antiderivatives $\\int x^{-1/2} dx=2 x^{1/2}$ and $\\int x^{1/2} dx=\\frac{2}{3} x^{3/2}$, we obtain\n$$\nw_{1}=-2 \\int_{0}^{1} x^{1/2} dx + \\frac{3}{2} \\int_{0}^{1} x^{-1/2} dx\n=-2 \\cdot \\frac{2}{3} + \\frac{3}{2} \\cdot 2\n=-\\frac{4}{3}+3=\\frac{5}{3},\n$$\n$$\nw_{2}=2 \\int_{0}^{1} x^{1/2} dx - \\frac{1}{2} \\int_{0}^{1} x^{-1/2} dx\n=2 \\cdot \\frac{2}{3} - \\frac{1}{2} \\cdot 2\n=\\frac{4}{3}-1=\\frac{1}{3}.\n$$\nTherefore, the two-point product integration rule is $w_{1} g\\!\\left(\\frac{1}{4}\\right)+w_{2} g\\!\\left(\\frac{3}{4}\\right)$ with $w_{1}=\\frac{5}{3}$ and $w_{2}=\\frac{1}{3}$.",
            "answer": "$$\\boxed{\\begin{pmatrix} \\frac{5}{3}  \\frac{1}{3} \\end{pmatrix}}$$"
        }
    ]
}