{
    "hands_on_practices": [
        {
            "introduction": "数值微分公式并非凭空而来，而是通过严谨的数学方法构建的。本练习将引导你使用泰勒级数和待定系数法，从零开始推导一个前向差分公式。通过这个过程，你将理解这些公式的构造原理，并掌握一种设计高精度数值格式的强大工具。",
            "id": "2191768",
            "problem": "在数值分析中，函数 $f(x)$ 在点 $x$ 处的导数可以使用有限差分公式进行近似。考虑一个形式如下的前向差分公式：\n$$\nf'(x) \\approx A f(x) + B f(x+h) + C f(x+2h)\n$$\n其中 $h > 0$ 是一个很小的步长，而 $A$、$B$ 和 $C$ 是可能依赖于 $h$ 的系数。您的任务是找到具体的系数，使得该近似对于尽可能高阶的多项式都是精确的。\n\n请确定系数 $A$、$B$ 和 $C$ 关于 $h$ 的表达式。请将您的答案表示为一个包含三个系数的行矩阵，顺序为 $[A, B, C]$。",
            "solution": "我们寻求系数 $A$、$B$ 和 $C$，使得前向差分组合 $A f(x) + B f(x+h) + C f(x+2h)$ 对于尽可能高阶的多项式能精确地再现 $f'(x)$。使用关于 $x$ 的泰勒展开，我们有\n$$\nf(x+h) = f(x) + h f'(x) + \\frac{h^{2}}{2} f''(x) + \\frac{h^{3}}{6} f^{(3)}(x) + \\cdots,\n$$\n$$\nf(x+2h) = f(x) + 2h f'(x) + \\frac{(2h)^{2}}{2} f''(x) + \\frac{(2h)^{3}}{6} f^{(3)}(x) + \\cdots.\n$$\n代入 $A f(x) + B f(x+h) + C f(x+2h)$ 并收集关于 $f$ 的各阶导数的项：\n$$\nA f(x) + B f(x+h) + C f(x+2h) = (A + B + C) f(x) + h(B + 2C) f'(x) + h^{2}\\!\\left(\\frac{B}{2} + 2C\\right) f''(x) + \\frac{h^{3}}{6} (B + 8C) f^{(3)}(x) + \\cdots.\n$$\n为了让该公式对于具有三个系数的尽可能高阶的多项式精确匹配 $f'(x)$，我们要求 $f(x)$ 和 $f''(x)$ 的系数为零，而 $f'(x)$ 的系数为 1：\n$$\nA + B + C = 0, \\quad h(B + 2C) = 1, \\quad h^{2}\\!\\left(\\frac{B}{2} + 2C\\right) = 0.\n$$\n求解上述方程组，第三个方程给出 $B = -4C$。代入第二个方程得到 $-4C + 2C = \\frac{1}{h}$，所以 $C = -\\frac{1}{2h}$，因此 $B = \\frac{2}{h}$。从第一个方程，我们得到 $A = -B - C = -\\frac{3}{2h}$。\n\n使用这些系数，余项从 $h^2$ 阶开始：\n$$\n\\frac{h^{3}}{6}(B + 8C) f^{(3)}(x) = \\frac{h^{3}}{6}\\!\\left(\\frac{2}{h} - \\frac{8}{2h}\\right) f^{(3)}(x) = -\\frac{h^{2}}{3} f^{(3)}(x),\n$$\n因此该公式对于所有次数至多为 2 的多项式都是精确的，这是在给定三个系数的情况下可能达到的最高次数。\n\n因此，所求系数为 $A = -\\frac{3}{2h}$，$B = \\frac{2}{h}$ 和 $C = -\\frac{1}{2h}$，按顺序 $[A, B, C]$ 排列的行矩阵如下所示。",
            "answer": "$$\\boxed{\\begin{pmatrix}-\\frac{3}{2h}  \\frac{2}{h}  -\\frac{1}{2h}\\end{pmatrix}}$$"
        },
        {
            "introduction": "当我们有多种数值微分公式可选时，一个关键问题是：哪种方法更优？本练习将通过一个具体函数，让你亲手计算并比较前向、后向和中心差分这三种基本方法的误差。通过定量的比较，你将直观地理解为什么中心差分等高阶方法通常因其卓越的精度而备受青睐。",
            "id": "2191753",
            "problem": "考虑函数 $f(x) = x \\exp(-x)$。我们希望在点 $x_0 = 1$ 处近似其导数 $f'(x)$。近似的质量由其绝对误差来衡量，绝对误差定义为近似值与导数真值之间的绝对差。\n\n您需要比较三种常用的近似导数的有限差分公式：\n1.  **前向差分近似**：$D_f(x_0, h) = \\frac{f(x_0+h) - f(x_0)}{h}$\n2.  **后向差分近似**：$D_b(x_0, h) = \\frac{f(x_0) - f(x_0-h)}{h}$\n3.  **中心差分近似**：$D_c(x_0, h) = \\frac{f(x_0+h) - f(x_0-h)}{2h}$\n\n设 $E_f$、$E_b$ 和 $E_c$ 分别是当步长 $h = 0.1$ 时，对应于前向、后向和中心差分近似的绝对误差。\n\n计算比率 $R = \\frac{E_f + E_b}{E_c}$ 的值。将您的最终答案四舍五入到三位有效数字。",
            "solution": "我们从函数 $f(x) = x \\exp(-x)$ 开始。其导数可通过乘法法则求得：\n$$\nf'(x) = \\exp(-x) + x \\frac{d}{dx}\\big(\\exp(-x)\\big) = \\exp(-x) - x \\exp(-x) = \\exp(-x)\\,(1 - x).\n$$\n在 $x_{0} = 1$ 处，这得到\n$$\nf'(1) = \\exp(-1)\\,(1 - 1) = 0.\n$$\n因此，对于任何有限差分近似 $D$，在 $x_{0}=1$ 处的绝对误差就是该近似值的绝对值：\n$$\nE_{f} = |D_{f}(1,h)|,\\quad E_{b} = |D_{b}(1,h)|,\\quad E_{c} = |D_{c}(1,h)|.\n$$\n\n当 $h = 0.1$ 时，使用 $f(x) = x \\exp(-x)$ 计算三个有限差分：\n- 前向差分：\n$$\nD_{f}(1,h) = \\frac{f(1+h) - f(1)}{h} = \\frac{(1.1)\\exp(-1.1) - \\exp(-1)}{0.1}.\n$$\n- 后向差分：\n$$\nD_{b}(1,h) = \\frac{f(1) - f(1-h)}{h} = \\frac{\\exp(-1) - (0.9)\\exp(-0.9)}{0.1}.\n$$\n- 中心差分：\n$$\nD_{c}(1,h) = \\frac{f(1+h) - f(1-h)}{2h} = \\frac{(1.1)\\exp(-1.1) - (0.9)\\exp(-0.9)}{0.2}.\n$$\n\n通过将 $\\exp(-1.1) = \\exp(-1)\\exp(-0.1)$ 和 $\\exp(-0.9) = \\exp(-1)\\exp(0.1)$ 写作，来提出因子 $\\exp(-1)$。定义 $t = \\exp(0.1)$，因此 $\\exp(-0.1) = 1/t$。然后\n$$\nD_{f}(1,h) = \\frac{\\exp(-1)}{0.1}\\left(1.1\\,\\frac{1}{t} - 1 \\right),\\quad\nD_{b}(1,h) = \\frac{\\exp(-1)}{0.1}\\left(1 - 0.9\\,t \\right),\n$$\n$$\nD_{c}(1,h) = \\frac{\\exp(-1)}{0.2}\\left(1.1\\,\\frac{1}{t} - 0.9\\,t \\right).\n$$\n设\n$$\nA = 1.1\\,\\frac{1}{t} - 1,\\quad B = 1 - 0.9\\,t,\\quad C = 1.1\\,\\frac{1}{t} - 0.9\\,t.\n$$\n则\n$$\nE_{f} = \\frac{\\exp(-1)}{0.1}\\,|A|,\\quad E_{b} = \\frac{\\exp(-1)}{0.1}\\,|B|,\\quad E_{c} = \\frac{\\exp(-1)}{0.2}\\,|C|.\n$$\n因此，该比率简化为\n$$\nR = \\frac{E_{f} + E_{b}}{E_{c}} = \\frac{\\frac{\\exp(-1)}{0.1}(|A|+|B|)}{\\frac{\\exp(-1)}{0.2}|C|} = 2\\,\\frac{|A|+|B|}{|C|}.\n$$\n\n数值上，使用 $t = \\exp(0.1) \\approx 1.1051701859880927$ 和 $1/t = \\exp(-0.1) \\approx 0.9048374180359596$，\n$$\nA = 1.1\\cdot 0.9048374180359596 - 1 \\approx -0.00467884016044447,\\quad |A| \\approx 0.00467884016044447,\n$$\n$$\nB = 1 - 0.9\\cdot 1.1051701859880927 \\approx 0.00534683261071661,\\quad |B| \\approx 0.00534683261071661,\n$$\n$$\nC = 1.1\\cdot 0.9048374180359596 - 0.9\\cdot 1.1051701859880927 \\approx 0.000667992450272143,\\quad |C| \\approx 0.000667992450272143.\n$$\n因此，\n$$\nR = 2\\,\\frac{0.00467884016044447 + 0.00534683261071661}{0.000667992450272143} \\approx \\frac{0.02005134554232216}{0.000667992450272143} \\approx 30.0173.\n$$\n四舍五入到三位有效数字，\n\n$R \\approx 30.0$.",
            "answer": "$$\\boxed{30.0}$$"
        },
        {
            "introduction": "除了推导更复杂的公式外，我们还有更巧妙的方法来提升计算精度。理查森外推法 (Richardson extrapolation) 就是一种强大的技术，它能将一个低阶方法在不同步长下的计算结果组合起来，从而得到一个更高阶的近似值。本练习将向你展示如何将两个一阶精度的结果，融合成一个更精确的二阶精度结果。",
            "id": "2191783",
            "problem": "一位工程师正在尝试估计一个由光滑函数 $f(x)$ 描述的物理量在特定点 $x_0$ 处的瞬时变化率。他们使用一种基于一阶向前差分公式的计算方法，对于给定的步长 $h$，该方法提供了真实导数 $f'(x_0)$ 的一个近似值 $N_1(h)$。已知该方法的误差具有以下结构：\n$$f'(x_0) = N_1(h) + K_1 h + K_2 h^2 + O(h^3)$$\n其中 $K_1$ 和 $K_2$ 是与步长 $h$ 无关的未知常数。\n\n使用步长 $h = 0.4$，工程师计算出近似值 $N_1(0.4) = 2.7836$。\n然后，通过将步长减半至 $h/2 = 0.2$，他们计算出一个新的近似值 $N_1(0.2) = 2.9152$。\n\n通过组合这两个一阶近似值 $N_1(0.4)$ 和 $N_1(0.2)$，为 $f'(x_0)$ 构建一个改进的、二阶精确的近似值，我们称之为 $N_2(h)$。计算这个改进近似值的数值。将你的最终答案四舍五入到四位有效数字。",
            "solution": "给定的一阶向前差分近似的误差模型是\n$$f'(x_{0})=N_{1}(h)+K_{1}h+K_{2}h^{2}+O(h^{3}).$$\n对于减半的步长，这给出\n$$f'(x_{0})=N_{1}\\!\\left(\\frac{h}{2}\\right)+K_{1}\\frac{h}{2}+K_{2}\\frac{h^{2}}{4}+O(h^{3}).$$\n寻求一个二阶精确的线性组合 $N_{2}(h)=A\\,N_{1}\\!\\left(\\frac{h}{2}\\right)+B\\,N_{1}(h)$。施加该组合与 $f'(x_{0})$ 匹配并消去 $O(h)$ 项的条件，得到\n$$A+B=1,\\qquad \\frac{A}{2}+B=0.$$\n求解得到 $A=2$ 和 $B=-1$，因此\n$$N_{2}(h)=2\\,N_{1}\\!\\left(\\frac{h}{2}\\right)-N_{1}(h).$$\n其误差为 $O(h^{2})$，因为\n$$2N_{1}\\!\\left(\\frac{h}{2}\\right)-N_{1}(h)=f'(x_{0})+\\frac{K_{2}}{2}h^{2}+O(h^{3}).$$\n使用给定数据，当 $h=0.4$ 时，\n$$N_{2}(0.4)=2\\,N_{1}(0.2)-N_{1}(0.4)=2\\cdot 2.9152-2.7836=3.0468.$$\n四舍五入到四位有效数字，结果是 $3.047$。",
            "answer": "$$\\boxed{3.047}$$"
        }
    ]
}