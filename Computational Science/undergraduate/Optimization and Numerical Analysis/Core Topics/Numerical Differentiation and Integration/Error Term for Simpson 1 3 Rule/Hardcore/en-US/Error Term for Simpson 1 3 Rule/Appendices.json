{
    "hands_on_practices": [
        {
            "introduction": "This first practice serves as a direct verification of the error formula for Simpson's 1/3 rule. By integrating a polynomial of degree four, we encounter a special case where the theoretical error bound is not just an upper limit, but the exact value of the actual error. This exercise  provides a satisfying confirmation of the theory and builds a solid foundation for understanding how the error term relates to the properties of the function being integrated.",
            "id": "2170172",
            "problem": "A student in a numerical analysis course is tasked with evaluating the performance of Simpson's 1/3 rule for a specific polynomial function. The integral in question is $I = \\int_{0}^{1} x^{4} dx$. The student uses Simpson's 1/3 rule with $n=2$ subintervals to find an approximation, which we will call $S_2$.\n\nThe student is then asked to perform an error analysis. This analysis involves two parts:\n1.  Calculating the magnitude of the actual error, $E_{actual} = |I - S_2|$.\n2.  Calculating the theoretical error bound, $E_{bound}$, using the standard formula for Simpson's rule:\n    $$E_{bound} = \\frac{(b-a)^5}{180n^4} M$$\n    where $[a, b]$ is the interval of integration, $n$ is the number of subintervals (which must be even), and $M$ is the maximum value of the absolute fourth derivative of the integrand on the interval, i.e., $M = \\max_{x \\in [a, b]} |f^{(4)}(x)|$.\n\nCalculate the values of the actual error, $E_{actual}$, and the theoretical error bound, $E_{bound}$. Present your final answer as a pair of exact fractions in a row matrix, $(E_{actual}, E_{bound})$.",
            "solution": "Let $f(x)=x^4$ on $[a,b]=[0,1]$. The exact integral is\n$$\nI=\\int_{0}^{1} x^{4}\\,dx=\\left.\\frac{x^{5}}{5}\\right|_{0}^{1}=\\frac{1}{5}.\n$$\nUsing Simpson's $1/3$ rule with $n=2$ subintervals, the step size is $h=\\frac{b-a}{n}=\\frac{1}{2}$ and the nodes are $x_0=0$, $x_1=\\frac{1}{2}$, and $x_2=1$. The Simpson approximation is\n$$\nS_{2}=\\frac{h}{3}\\big(f(x_{0})+4f(x_{1})+f(x_{2})\\big)=\\frac{1/2}{3}\\left(f(0)+4f\\left(\\frac{1}{2}\\right)+f(1)\\right).\n$$\nEvaluating $f$ at the nodes gives $f(0)=0$, $f(\\frac{1}{2})=(\\frac{1}{2})^4=\\frac{1}{16}$, and $f(1)=1$. Hence\n$$\nS_{2}=\\frac{1}{6}\\left(0+4\\cdot\\frac{1}{16}+1\\right)=\\frac{1}{6}\\left(\\frac{1}{4}+1\\right)=\\frac{1}{6}\\cdot\\frac{5}{4}=\\frac{5}{24}.\n$$\nThe actual error is\n$$\nE_{\\text{actual}}=\\left|I-S_{2}\\right|=\\left|\\frac{1}{5}-\\frac{5}{24}\\right|=\\left|\\frac{24}{120}-\\frac{25}{120}\\right|=\\frac{1}{120}.\n$$\nFor the theoretical error bound, compute the fourth derivative: $f'(x)=4x^3$, $f''(x)=12x^2$, $f^{(3)}(x)=24x$, and $f^{(4)}(x)=24$. Therefore\n$$\nM=\\max_{x\\in[0,1]}|f^{(4)}(x)|=24.\n$$\nUsing the Simpson error bound formula\n$$\nE_{\\text{bound}}=\\frac{(b-a)^{5}}{180\\,n^{4}}\\,M=\\frac{1^{5}}{180\\cdot 2^{4}}\\cdot 24=\\frac{24}{2880}=\\frac{1}{120}.\n$$\nThus, both the actual error and the theoretical error bound are $\\frac{1}{120}$.",
            "answer": "$$\\boxed{\\begin{pmatrix}\\frac{1}{120} & \\frac{1}{120}\\end{pmatrix}}$$"
        },
        {
            "introduction": "Beyond just calculating the magnitude of error, a robust understanding of a numerical method involves predicting its behavior. This exercise  challenges you to use the structure of the Simpson's rule error term, $E_S = -\\frac{(b-a)^5}{180 n^4} f^{(4)}(\\xi)$, to determine whether the approximation will be an overestimate or an underestimate. By analyzing the sign of the fourth derivative, you can gain qualitative insights into the approximation's accuracy without performing the full numerical integration.",
            "id": "2170168",
            "problem": "The error term for Simpson's 1/3 rule, which approximates an integral $\\int_a^b f(x) \\,dx$ using an even number of subintervals $n$, is given by the formula:\n$$E_S = -\\frac{(b-a)^5}{180 n^4} f^{(4)}(\\xi)$$\nwhere $f^{(4)}(x)$ is the fourth derivative of the function $f(x)$, and $\\xi$ is some value within the interval of integration $(a, b)$. The error is defined as the true value of the integral minus the approximated value, i.e., $E_S = (\\int_a^b f(x) \\,dx) - S_n$, where $S_n$ is the Simpson's rule approximation.\n\nConsider the definite integral $I = \\int_0^1 \\exp(x) \\,dx$. Without performing the numerical integration or calculating the exact value of the integral, determine whether Simpson's 1/3 rule will overestimate or underestimate the true value of $I$ for any even number of subintervals $n$. Choose the option that correctly states the outcome and provides the correct reasoning.\n\nA. Simpson's rule will overestimate the integral because the fourth derivative of $\\exp(x)$ is always negative on the interval $(0, 1)$.\n\nB. Simpson's rule will underestimate the integral because the fourth derivative of $\\exp(x)$ is always positive on the interval $(0, 1)$.\n\nC. Simpson's rule will overestimate the integral because the fourth derivative of $\\exp(x)$ is always positive on the interval $(0, 1)$.\n\nD. Simpson's rule will underestimate the integral because the fourth derivative of $\\exp(x)$ is always negative on the interval $(0, 1)$.\n\nE. Whether the integral is overestimated or underestimated depends on the specific choice of $n$, and cannot be determined in general.",
            "solution": "We are given the Simpson’s rule error formula for an even number of subintervals $n$:\n$$\nE_{S} \\equiv \\left(\\int_{a}^{b} f(x)\\,dx\\right) - S_{n} = -\\frac{(b-a)^{5}}{180\\,n^{4}}\\,f^{(4)}(\\xi), \\quad \\xi \\in (a,b).\n$$\nFor the integral $I=\\int_{0}^{1} \\exp(x)\\,dx$, we identify $f(x)=\\exp(x)$. The derivatives of $\\exp(x)$ satisfy $f^{(k)}(x)=\\exp(x)$ for every integer $k\\geq 0$, hence in particular\n$$\nf^{(4)}(x)=\\exp(x).\n$$\nOn the interval $(0,1)$, we have $\\exp(x)>0$ for all $x\\in(0,1)$, so\n$$\nf^{(4)}(\\xi)>0 \\quad \\text{for all } \\xi\\in(0,1).\n$$\nIn the error prefactor, $(b-a)^5>0$ and $n^4>0$ for any even $n$, and the explicit sign is negative. Therefore,\n$$\nE_{S}=-\\frac{(b-a)^{5}}{180\\,n^{4}}\\,f^{(4)}(\\xi)<0.\n$$\nSince $E_S=I-S_n$ and $E_S<0$, it follows that\n$$\nI-S_n<0 \\implies S_n>I.\n$$\nThus Simpson’s rule overestimates the integral for any even number of subintervals $n$. The reason is that $f^{(4)}(x)$ is positive on $(0,1)$. Therefore the correct choice is that Simpson’s rule will overestimate because the fourth derivative is positive.",
            "answer": "$$\\boxed{C}$$"
        },
        {
            "introduction": "In practical applications, we often need to guarantee a certain level of accuracy while minimizing computational cost. This problem  places you in the role of a numerical analyst who must decide on the computational effort needed for a specific task. You will use the error bound formula to determine the minimum number of subintervals $n$ required to approximate an integral to within a desired tolerance, a core skill in designing efficient numerical computations.",
            "id": "2170216",
            "problem": "A numerical analyst is tasked with approximating the value of the natural logarithm of 2, which is given by the definite integral $\\int_1^2 \\frac{1}{x} dx$. To achieve this, the composite Simpson's 1/3 rule will be used to numerically evaluate the integral. Determine the minimum even number of subintervals, $n$, required to guarantee that the absolute error of the approximation is at most $10^{-6}$.",
            "solution": "We approximate $\\int_{1}^{2} \\frac{1}{x} \\, dx = \\ln(2)$ using the composite Simpson's $1/3$ rule on $[1,2]$ with an even number $n$ of subintervals and step size $h = \\frac{b-a}{n} = \\frac{1}{n}$. For a function $f$ with a continuous fourth derivative on $[a,b]$, the composite Simpson error satisfies\n$$\nE_{S} = -\\frac{b-a}{180} h^{4} f^{(4)}(\\xi)\n$$\nfor some $\\xi \\in (a,b)$, and thus\n$$\n|E_{S}| \\leq \\frac{b-a}{180} h^{4} \\max_{x \\in [a,b]} |f^{(4)}(x)|.\n$$\n\nHere $f(x) = x^{-1}$ on $[1,2]$. We compute derivatives:\n$$\nf'(x) = -x^{-2}, \\quad f''(x) = 2 x^{-3}, \\quad f^{(3)}(x) = -6 x^{-4}, \\quad f^{(4)}(x) = 24 x^{-5}.\n$$\nHence,\n$$\n|f^{(4)}(x)| = 24 x^{-5},\n$$\nwhich is decreasing on $[1,2]$ and attains its maximum at $x=1$, giving\n$$\nM := \\max_{x \\in [1,2]} |f^{(4)}(x)| = 24.\n$$\n\nWith $b-a = 1$ and $h = \\frac{1}{n}$, the error bound becomes\n$$\n|E_{S}| \\leq \\frac{1}{180} \\left(\\frac{1}{n}\\right)^{4} \\cdot 24 = \\frac{24}{180 n^{4}} = \\frac{2}{15 n^{4}}.\n$$\nTo guarantee $|E_{S}| \\leq 1 \\times 10^{-6}$, we require\n$$\n\\frac{2}{15 n^{4}} \\leq 1 \\times 10^{-6}\n\\;\\;\\Longleftrightarrow\\;\\;\nn^{4} \\geq \\frac{2}{15} \\times 10^{6}.\n$$\nThus\n$$\nn \\geq \\left(\\frac{2}{15} \\times 10^{6}\\right)^{1/4}.\n$$\nEvaluating against nearby integers, $19^{4} = 130321$ and $20^{4} = 160000$. Since\n$$\n\\frac{2}{15} \\cdot \\frac{1}{20^{4}} = \\frac{2}{15} \\cdot \\frac{1}{160000} = \\frac{1}{1200000}  1 \\times 10^{-6},\n$$\nwhile $18$ is smaller and $19$ is not even, the minimal even integer $n$ satisfying the bound is $20$.",
            "answer": "$$\\boxed{20}$$"
        }
    ]
}