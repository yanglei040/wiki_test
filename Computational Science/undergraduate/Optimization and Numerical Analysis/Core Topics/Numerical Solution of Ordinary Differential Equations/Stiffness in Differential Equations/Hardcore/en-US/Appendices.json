{
    "hands_on_practices": [
        {
            "introduction": "This practice builds the theoretical foundation for understanding stiff solvers. We will analyze why implicit methods, like the Backward Euler method, are robust choices for stiff systems by applying them to the Dahlquist test equation, $y' = \\lambda y$. By deriving the method's amplification factor, you will algebraically demonstrate its unconditional stability for decaying solutions, a key property that explicit methods lack .",
            "id": "2206441",
            "problem": "When analyzing the stability of numerical methods for solving Ordinary Differential Equations (ODEs), a standard procedure is to apply the method to the Dahlquist test equation, $y'(t) = \\lambda y(t)$, where $\\lambda$ is a complex constant. For a given method with a fixed step size $h > 0$, this application results in a recurrence relation of the form $y_{n+1} = G(z) y_n$, where $z = \\lambda h$ and the function $G(z)$ is called the amplification factor. The stability of the method for a particular choice of $h$ and $\\lambda$ is determined by the magnitude of this factor; the method is considered stable if $|G(z)| \\le 1$.\n\nThe Backward Euler method is an implicit, one-step method defined by the formula $y_{n+1} = y_n + h f(t_{n+1}, y_{n+1})$, where $y'(t) = f(t, y(t))$.\n\nLet the complex number $z = \\lambda h$ be represented by its real and imaginary parts as $z = x + iy$. Your task is to derive an expression for the square of the magnitude of the amplification factor, $|G(z)|^2$, for the Backward Euler method. The final expression must be written purely in terms of the real part $x$ and the imaginary part $y$ of $z$.",
            "solution": "We start from the Dahlquist test equation $y'(t)=\\lambda y(t)$ and apply the Backward Euler method $y_{n+1}=y_{n}+h f(t_{n+1},y_{n+1})$. With $f(t,y)=\\lambda y$, this gives\n$$\ny_{n+1}=y_{n}+h\\lambda y_{n+1}.\n$$\nRearranging terms,\n$$\n(1-h\\lambda)y_{n+1}=y_{n}.\n$$\nIntroducing $z=\\lambda h$, we obtain\n$$\n(1-z)y_{n+1}=y_{n}\\quad\\Longrightarrow\\quad y_{n+1}=G(z)y_{n},\\qquad G(z)=\\frac{1}{1-z}.\n$$\nThe squared magnitude of the amplification factor is therefore\n$$\n|G(z)|^{2}=\\left|\\frac{1}{1-z}\\right|^{2}=\\frac{1}{|1-z|^{2}}.\n$$\nWriting $z=x+iy$ with real $x$ and $y$, we have $1-z=(1-x)-iy$. For a complex number $a+ib$, $|a+ib|^{2}=a^{2}+b^{2}$, hence\n$$\n|1-z|^{2}=(1-x)^{2}+y^{2}.\n$$\nTherefore,\n$$\n|G(z)|^{2}=\\frac{1}{(1-x)^{2}+y^{2}}.\n$$\nThis expression is written purely in terms of $x$ and $y$ as required.",
            "answer": "$$\\boxed{\\frac{1}{(1-x)^{2}+y^{2}}}$$"
        },
        {
            "introduction": "Moving from theory to practical diagnosis, this exercise presents a common scenario that every computational scientist should recognize. It teaches you how to spot potential stiffness without analyzing the system's equations directly, simply by observing how an adaptive solver's workload responds to changes in accuracy tolerance. This skill is crucial for efficiently troubleshooting numerical integrations .",
            "id": "2206398",
            "problem": "An undergraduate student is tasked with numerically solving a system of first-order Ordinary Differential Equations (ODEs) that models the concentration of two interacting chemical species over a time interval from $t=0$ to $t=T$. The student uses a standard adaptive explicit Runge-Kutta method of order $p=4$. The solver adjusts its step size, $h$, to keep the estimated local error below a user-specified tolerance, $\\epsilon$.\n\nThe student performs two simulations:\n\n1.  **Run 1:** With a tolerance of $\\epsilon_1 = 10^{-5}$, the solver successfully integrates the system to $t=T$, requiring a total of $N_1 = 5,200$ steps.\n2.  **Run 2:** The student refines the tolerance to $\\epsilon_2 = 10^{-6}$ and runs the simulation again over the same interval. This time, the solver requires a total of $N_2 = 985,000$ steps to reach $t=T$.\n\nThe student is surprised by the dramatic increase in the number of steps, which is far greater than the modest change in tolerance would suggest for a well-behaved problem. Without performing a formal analysis of the system's Jacobian matrix, which of the following is the most likely explanation for the observed behavior?\n\nA. The solution to the ODE system is highly oscillatory, causing the solver to require smaller steps to resolve the oscillations.\n\nB. The ODE system is numerically stiff.\n\nC. The order of the numerical method ($p=4$) is too low for this class of problem.\n\nD. A bug exists in the solver's time-stepping algorithm, causing it to malfunction at lower tolerances.\n\nE. The solution to the ODE system possesses a singularity within the integration interval $[0, T]$.",
            "solution": "We consider an adaptive explicit Runge–Kutta method of order $p=4$ with a local error control tolerance $\\epsilon$. For an order-$p$ method, the local truncation error per step satisfies\n$$\n\\mathrm{LTE} \\approx C h^{p+1},\n$$\nfor some problem-dependent constant $C$. To keep the estimated local error below $\\epsilon$, the step size is adjusted so that\n$$\nC h^{p+1} \\approx \\epsilon \\quad \\Longrightarrow \\quad h_{\\mathrm{acc}} \\propto \\epsilon^{\\frac{1}{p+1}}.\n$$\nOver a fixed interval of length $T$, the number of steps is therefore\n$$\nN \\approx \\frac{T}{h_{\\mathrm{acc}}} \\propto \\epsilon^{-\\frac{1}{p+1}}.\n$$\nWith $p=4$, this predicts the scaling\n$$\n\\frac{N_{2}}{N_{1}} \\approx \\left(\\frac{\\epsilon_{2}}{\\epsilon_{1}}\\right)^{-\\frac{1}{5}} = \\left(\\frac{\\epsilon_{1}}{\\epsilon_{2}}\\right)^{\\frac{1}{5}}.\n$$\nSince $\\epsilon_{2} = \\epsilon_{1}/10$, the expected factor is $10^{\\frac{1}{5}}$, i.e., a modest increase. However, the observed ratio $N_{2}/N_{1}$ is far larger than $10^{\\frac{1}{5}}$, indicating that the step size is not primarily limited by accuracy.\n\nFor explicit Runge–Kutta methods applied to stiff systems, stability constraints dominate the step size selection. Specifically, stability of the method requires\n$$\nh \\lesssim h_{\\mathrm{stab}} \\approx \\frac{\\kappa}{|\\lambda_{\\max}|},\n$$\nwhere $\\lambda_{\\max}$ is an eigenvalue of the Jacobian with the largest magnitude (typically with negative real part for dissipative stiff modes), and $\\kappa$ is a method-dependent constant determined by the stability region. In this regime, the step size is constrained by stability rather than by the accuracy tolerance, and tightening $\\epsilon$ can produce behavior such as:\n- order reduction, so that the effective accuracy order drops and the controller drastically reduces $h$;\n- excessive step rejections and very small accepted steps to damp stiff modes;\n- dominance of fast decaying modes in the error estimate, which forces $h$ well below $h_{\\mathrm{stab}}$ to meet the tighter tolerance.\n\nThese effects together can produce a dramatic increase in the number of steps far beyond the $10^{\\frac{1}{5}}$ factor predicted for nonstiff, accuracy-limited integration.\n\nBy contrast:\n- Highly oscillatory but nonstiff dynamics would impose a resolution limit that is largely independent of $\\epsilon$, so a tenfold decrease in tolerance would not cause an increase by orders of magnitude in $N$.\n- A singularity in $[0,T]$ would typically prevent reaching $T$ (or cause failure in both runs), which is not observed.\n- Using order $p=4$ is not by itself a cause of such a disproportionate change; increasing the order helps efficiency but does not explain the discontinuity in $N$ versus $\\epsilon$.\n- A software bug is possible, but the phenomenon described is a classic symptom of stiffness for explicit solvers, and chemical kinetics models are well known to be stiff due to disparate time scales of reactions.\n\nTherefore, the most likely explanation is that the ODE system is numerically stiff, and the explicit method’s step sizes are governed by stability and stiffness-induced order reduction rather than the nominal accuracy tolerance.",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "Once stiffness is identified, its impact can be quantified. This problem introduces a practical \"Stiffness Factor\" by comparing the computational effort of an explicit solver versus an implicit one on a chemical kinetics model, a classic source of stiff ODEs. By calculating this ratio, you will gain a concrete appreciation for the dramatic performance difference and the importance of selecting the appropriate solver for the problem at hand .",
            "id": "2206397",
            "problem": "In a simplified model of a catalytic converter, a toxic gas species $A$ is adsorbed onto a catalytic surface and slowly converts to an intermediate species $B$. This intermediate species $B$ is highly unstable and rapidly transforms into a non-toxic gas species $C$. The concentrations of these species, denoted by $y_A(t)$, $y_B(t)$, and $y_C(t)$, can be modeled by the following system of first-order ordinary differential equations:\n\n$$\n\\begin{align*}\n\\frac{dy_A}{dt} &= -k_1 y_A \\\\\n\\frac{dy_B}{dt} &= k_1 y_A - k_2 y_B \\\\\n\\frac{dy_C}{dt} &= k_2 y_B\n\\end{align*}\n$$\n\nThe rate constants are given as $k_1 = 0.8 \\text{ s}^{-1}$ and $k_2 = 200 \\text{ s}^{-1}$. At time $t=0$, the initial concentrations are $y_A(0) = 1.0 \\text{ mol/L}$, $y_B(0) = 0$, and $y_C(0) = 0$.\n\nTo analyze the \"stiffness\" of this system, it is integrated from $t=0$ to $t=4.0$ seconds using two different numerical methods with adaptive step-size control. Both methods are configured to achieve the same final accuracy.\n\n1.  An **adaptive explicit solver** (based on a Runge-Kutta method) is used. To meet the accuracy target over the integration interval, it required a total of $318,550$ evaluations of the system's right-hand-side function.\n2.  An **adaptive implicit solver** (based on Backward Differentiation Formulas) is used. To meet the same accuracy target, it required a total of $472$ evaluations of the system's right-hand-side function.\n\nA quantitative \"Stiffness Factor\" for a given problem can be defined as the ratio of the computational effort of the explicit solver to that of the implicit solver. Using the number of function evaluations as a proxy for computational effort, calculate this Stiffness Factor.\n\nRound your final answer to three significant figures.",
            "solution": "The stiffness factor is defined as the ratio of the computational effort of the explicit solver to that of the implicit solver, using the number of right-hand-side evaluations as the measure of effort. Denote this factor by $S$. With $N_{\\text{exp}}=318{,}550$ and $N_{\\text{imp}}=472$, we have\n$$\nS=\\frac{N_{\\text{exp}}}{N_{\\text{imp}}}=\\frac{318{,}550}{472}.\n$$\nFactor the denominator as $472=8\\cdot 59$ and perform Euclidean division on the numerator by $59$:\n$$\n\\frac{318{,}550}{59}=5{,}399+\\frac{9}{59}.\n$$\nThus,\n$$\nS=\\frac{5{,}399+\\frac{9}{59}}{8}=\\frac{5{,}399}{8}+\\frac{9}{472}=674.875+\\frac{9}{472}.\n$$\nSince $\\frac{9}{472}\\approx 0.0190677966$, it follows that\n$$\nS\\approx 674.8940677966\\ldots\n$$\nRounding to three significant figures gives\n$$\nS\\approx 675.\n$$",
            "answer": "$$\\boxed{675}$$"
        }
    ]
}