{
    "hands_on_practices": [
        {
            "introduction": "隐式方法的核心是在每个时间步求解一个代数方程来确定下一个状态。本练习将通过一个简单的线性常微分方程和隐式中点法，引导你完成这一基本过程。掌握这种基本的代数变换 ，是理解和实现更复杂隐式格式的第一步。",
            "id": "2178584",
            "problem": "在计算物理学中，许多问题需要对常微分方程（ODE）进行数值求解。考虑一个电子元件温度 $y(t)$ 随时间变化的简化模型。其温度的变化率由以下线性一阶常微分方程描述：\n$$ \\frac{dy}{dt} = ay + b $$\n其中 $y_n$ 表示在时间 $t_n$ 的已知温度，$a$ 和 $b$ 是由元件的物理特性及其环境决定的实常数。\n\n为了数值近似求解，我们可以使用隐式方法。其中一种方法是隐式中点法，它使用以下公式计算下一个时间步的状态 $y_{n+1} = y(t_n + h)$：\n$$ y_{n+1} = y_n + h f\\left(t_n + \\frac{h}{2}, \\frac{y_n + y_{n+1}}{2}\\right) $$\n这里，$h$ 是恒定的时间步长，$f(t,y)$ 是定义该常微分方程的函数，即 $f(t,y) = \\frac{dy}{dt}$。\n\n通过对给定的常微分方程应用单步隐式中点法，推导出 $y_{n+1}$ 关于 $y_n$、$h$、$a$ 和 $b$ 的显式解析表达式。",
            "solution": "我们从常微分方程 $ \\frac{dy}{dt} = a y + b $ 开始，并应用隐式中点法\n$$\ny_{n+1} = y_n + h f\\left(t_n + \\frac{h}{2}, \\frac{y_n + y_{n+1}}{2}\\right).\n$$\n这里 $f(t,y) = a y + b$ 是自治的（不依赖于 $t$），所以\n$$\nf\\left(t_n + \\frac{h}{2}, \\frac{y_n + y_{n+1}}{2}\\right) = a \\left(\\frac{y_n + y_{n+1}}{2}\\right) + b.\n$$\n代入更新公式可得\n$$\ny_{n+1} = y_n + h \\left[ a \\left(\\frac{y_n + y_{n+1}}{2}\\right) + b \\right].\n$$\n展开并合并关于 $y_{n+1}$ 的项，\n$$\ny_{n+1} = y_n + \\frac{a h}{2} y_n + \\frac{a h}{2} y_{n+1} + h b,\n$$\n这意味着\n$$\n\\left(1 - \\frac{a h}{2}\\right) y_{n+1} = \\left(1 + \\frac{a h}{2}\\right) y_n + h b.\n$$\n求解 $y_{n+1}$ 得到显式解析表达式\n$$\ny_{n+1} = \\frac{\\left(1 + \\frac{a h}{2}\\right) y_n + h b}{1 - \\frac{a h}{2}}.\n$$",
            "answer": "$$\\boxed{\\frac{\\left(1 + \\frac{a h}{2}\\right) y_n + h b}{1 - \\frac{a h}{2}}}$$"
        },
        {
            "introduction": "建立了代数方程之后，下一个问题是如何求解它，特别是当方程无法轻易手动求解时。这个练习探讨了一种常见的求解方法——简单定点迭代法，并揭示了其在应用于刚性方程时的一个关键限制。理解这个限制  对于领会为何刚性问题需要更复杂的数值技术（如牛顿法）至关重要。",
            "id": "2178627",
            "problem": "考虑一个一阶常微分方程 (ODE) 的数值解，该方程模拟了一个系统状态 $y(t)$，它会快速调整以适应一个时变的外部信号 $g(t)$。其动力学由以下方程描述：\n$$ y'(t) = \\alpha (g(t) - y(t)) $$\n这里，$\\alpha$ 是一个很大的正常数，这使得该方程是“刚性的”。\n\n为了数值求解这个 ODE，我们应用后向欧拉法，这是一种由下式定义的隐式格式：\n$$ y_{n+1} = y_n + h f(t_{n+1}, y_{n+1}) $$\n其中 $y_n \\approx y(t_n)$，$h$ 是时间步长，且 $f(t,y) = \\alpha (g(t) - y)$。\n\n为了在每个时间步求解关于 $y_{n+1}$ 的隐式方程，使用了一种简单的不动点迭代法。从一个初始猜测值 $y_{n+1}^{(0)}$ 开始，迭代过程如下：\n$$ y_{n+1}^{(k+1)} = y_n + h \\alpha (g(t_{n+1}) - y_{n+1}^{(k)}) $$\n其中 $k=0, 1, 2, \\dots$ 是迭代指数。\n\n为保证该不动点迭代对任意初始猜测值都能收敛到 $y_{n+1}$ 的正确值，步长 $h$ 必须严格小于某个临界值，我们称之为 $h_{crit}$。这个临界值取决于系统的参数。\n\n确定这个临界步长 $h_{crit}$ 用参数 $\\alpha$ 表示的表达式。",
            "solution": "我们从 ODE $y'(t)=\\alpha\\left(g(t)-y(t)\\right)$ 的后向欧拉步开始：\n$$\ny_{n+1}=y_{n}+h\\,\\alpha\\left(g(t_{n+1})-y_{n+1}\\right).\n$$\n将迭代中使用的不动点映射定义为\n$$\nF(y):=y_{n}+h\\,\\alpha\\left(g(t_{n+1})-y\\right)=y_{n}+h\\,\\alpha\\,g(t_{n+1})-h\\,\\alpha\\,y.\n$$\n不动点迭代为 $y_{n+1}^{(k+1)}=F\\!\\left(y_{n+1}^{(k)}\\right)$，且不动点 $y_{n+1}^{\\ast}$ 满足\n$$\ny_{n+1}^{\\ast}=F\\!\\left(y_{n+1}^{\\ast}\\right).\n$$\n为确保对任意初始猜测值都收敛，$F$ 必须是 $\\mathbb{R}$ 上的一个压缩映射。根据 Banach 不动点定理，一个充分（且在此线性情况下，必要）条件是 $F$ 的 Lipschitz 常数 $L$ 满足 $L  1$。由于 $F$ 关于 $y$ 是可微且线性的，我们计算\n$$\nF'(y)=-h\\,\\alpha,\n$$\n所以 Lipschitz 常数是\n$$\nL=\\sup_{y\\in\\mathbb{R}}|F'(y)|=|{-h\\,\\alpha}|=h\\,\\alpha.\n$$\n因此，迭代对任意初始猜测值收敛的充要条件是\n$$\nh\\alpha  1.\n$$\n等价地，临界步长是 $h_{\\text{crit}}=\\frac{1}{\\alpha}$，收敛要求是 $h  1/\\alpha$。",
            "answer": "$$\\boxed{\\frac{1}{\\alpha}}$$"
        },
        {
            "introduction": "隐式方法因其优越的稳定性而成为求解刚性问题的首选，但并非所有隐式方法都具有相同的性质。本练习在一个经典的振荡系统测试问题上，比较了两种流行的方法：后向欧拉法和梯形法则。通过分析每种方法如何处理解的模长 ，我们可以深入了解数值耗散和守恒性等关键定性性质，从而指导我们为特定的物理问题选择合适的数值格式。",
            "id": "2178599",
            "problem": "在常微分方程 (ODE) 数值方法的稳定性分析中，一个用于振荡系统的关键测试问题是方程 $y'(t) = i\\omega y(t)$，其初始条件为 $y(0) = y_0$。这里，$y(t)$ 是一个复值函数，$i = \\sqrt{-1}$，$\\omega$ 是一个代表角频率的实正常数。该方程的精确解为 $y(t) = y_0 \\exp(i\\omega t)$，其幅值 $|y(t)|$ 对所有时间 $t$ 保持恒定。\n\n对于此类问题，一个理想的数值方法应该能保持这种幅值恒定的性质。考虑用常数时间步长 $h  0$ 求解此 ODE 的两种隐式数值方法。\n\n方法 A（后向欧拉法）：该格式由以下关系定义\n$$y_{n+1} = y_n + h (i\\omega y_{n+1})$$\n\n方法 B（梯形法则）：该格式由以下关系定义\n$$y_{n+1} = y_n + \\frac{h}{2} (i\\omega y_n + i\\omega y_{n+1})$$\n\n令 $|y_n^{(A)}|$ 和 $|y_n^{(B)}|$ 分别表示由方法 A 和方法 B 在时间 $t_n = n h$ 生成的数值解的幅值。对于任意选择的步长 $h  0$ 和频率 $\\omega  0$，以下哪个陈述正确描述了这些幅值的演变？\n\nA. $|y_{n+1}^{(A)}|  |y_n^{(A)}|$ 且 $|y_{n+1}^{(B)}|  |y_n^{(B)}|$\n\nB. $|y_{n+1}^{(A)}|  |y_n^{(A)}|$ 且 $|y_{n+1}^{(B)}| = |y_n^{(B)}|$\n\nC. $|y_{n+1}^{(A)}| = |y_n^{(A)}|$ 且 $|y_{n+1}^{(B)}|  |y_n^{(B)}|$\n\nD. $|y_{n+1}^{(A)}|  |y_n^{(A)}|$ 且 $|y_{n+1}^{(B)}| = |y_n^{(B)}|$\n\nE. $|y_{n+1}^{(A)}|  |y_n^{(A)}|$ 且 $|y_{n+1}^{(B)}|  |y_n^{(B)}|$\n\nF. $|y_{n+1}^{(A)}| = |y_n^{(A)}|$ 且 $|y_{n+1}^{(B)}|  |y_n^{(B)}|$",
            "solution": "我们分析两种单步隐式方法在线性测试 ODE $y'(t)=i\\omega y(t)$ 下的表现，每种方法都会产生一个形式为 $y_{n+1}=G y_n$ 的线性递推关系，其中 $G$ 是一个复增长因子。幅值的行为由 $|G|$ 决定。\n\n对于方法 A（后向欧拉法），其更新关系为\n$$\ny_{n+1}=y_n+h(i\\omega y_{n+1}).\n$$\n整理可得\n$$\n(1-i\\omega h)\\,y_{n+1}=y_n \\quad\\Rightarrow\\quad y_{n+1}=\\frac{1}{1-i\\omega h}\\,y_n.\n$$\n因此，增长因子为\n$$\nG_{A}=\\frac{1}{1-i\\omega h}.\n$$\n其模为\n$$\n|G_{A}|^{2}=G_{A}\\overline{G_{A}}=\\frac{1}{(1-i\\omega h)(1+i\\omega h)}=\\frac{1}{1+(\\omega h)^{2}},\n$$\n所以\n$$\n|G_{A}|=\\frac{1}{\\sqrt{1+(\\omega h)^{2}}}  1 \\quad\\text{for}\\quad h0,\\ \\omega0.\n$$\n因此，\n$$\n|y_{n+1}^{(A)}|=|G_{A}|\\,|y_{n}^{(A)}|  |y_{n}^{(A)}|.\n$$\n\n对于方法 B（梯形法则），其更新关系为\n$$\ny_{n+1}=y_n+\\frac{h}{2}\\big(i\\omega y_n+i\\omega y_{n+1}\\big).\n$$\n整理可得\n$$\n\\big(1-\\tfrac{i\\omega h}{2}\\big)y_{n+1}=\\big(1+\\tfrac{i\\omega h}{2}\\big)y_n \\quad\\Rightarrow\\quad y_{n+1}=\\frac{1+\\tfrac{i\\omega h}{2}}{1-\\tfrac{i\\omega h}{2}}\\,y_n.\n$$\n因此，增长因子为\n$$\nG_{B}=\\frac{1+\\tfrac{i\\omega h}{2}}{1-\\tfrac{i\\omega h}{2}}.\n$$\n分子和分母的模相等：\n$$\n\\left|1+\\tfrac{i\\omega h}{2}\\right|=\\sqrt{1+\\left(\\tfrac{\\omega h}{2}\\right)^{2}}=\\left|1-\\tfrac{i\\omega h}{2}\\right|,\n$$\n因此\n$$\n|G_{B}|=1,\n$$\n所以\n$$\n|y_{n+1}^{(B)}|=|y_{n}^{(B)}|.\n$$\n\n综合这些结果，对于任意 $h0$ 和 $\\omega0$，后向欧拉法会严格减小幅值，而梯形法则能精确地保持幅值不变。这对应于选项 B。",
            "answer": "$$\\boxed{B}$$"
        }
    ]
}