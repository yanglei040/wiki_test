{
    "hands_on_practices": [
        {
            "introduction": "掌握新方法的第一步是将其应用于一个简单的场景。本练习  将引导你使用休恩方法（Heun's Method）解决一个初值问题，其中变化率仅与时间有关。这个练习将帮助你熟悉该方法的预测-校正流程，并为更复杂的应用打下坚实的基础。",
            "id": "2200949",
            "problem": "一个遥控探测器在直线轨道上的速度被观测到与其启动后所经过的时间成反比。该关系具体由 $v(t) = \\frac{k}{t}$ 给出，其中 $v$ 是以米/秒 (m/s) 为单位的速度，$t$ 是以秒为单位的时间。对于这个特定的探测器，常数 $k$ 被确定为恰好是 $1 \\text{ m}$。探测器在时间 $t=1 \\text{ s}$ 时从坐标系原点开始运动，意味着其初始位置为 $x(1) = 0 \\text{ m}$。一位工程师想要估计探测器在时间 $t=1.2 \\text{ s}$ 时的位置。使用休恩法，通过单个时间步长，计算探测器的近似位置。将你的答案表示为以米 (m) 为单位的位置，并四舍五入到三位有效数字。",
            "solution": "我们通过一阶常微分方程来模拟探测器的位置，该方程由速度是位置对时间导数的物理关系得到：\n$$\n\\frac{dx}{dt}=v(t).\n$$\n给定 $v(t)=\\frac{k}{t}$ 且 $k=1$，我们有\n$$\n\\frac{dx}{dt}=\\frac{1}{t}, \\quad x(1)=0.\n$$\n我们应用休恩法（改进的欧拉法），从 $t_{0}=1$ 到 $t_{1}=1.2$ 进行单步计算，步长为 $h=t_{1}-t_{0}=0.2$。$x$ 的休恩法更新公式为\n$$\nx_{1}=x_{0}+\\frac{h}{2}\\left[f(t_{0},x_{0})+f\\bigl(t_{1},x_{0}+h f(t_{0},x_{0})\\bigr)\\right],\n$$\n其中 $f(t,x)=\\frac{1}{t}$。由于 $f$ 不依赖于 $x$，该公式简化为\n$$\nx_{1}=x_{0}+\\frac{h}{2}\\left[f(t_{0})+f(t_{1})\\right].\n$$\n计算斜率：\n$$\nf(t_{0})=\\frac{1}{1}=1, \\quad f(t_{1})=\\frac{1}{1.2}=\\frac{5}{6}.\n$$\n因此，\n$$\nx(1.2)=x_{1}=0+\\frac{0.2}{2}\\left(1+\\frac{5}{6}\\right)=0.1\\cdot\\frac{11}{6}=\\frac{11}{60}\\approx 0.183333\\ldots\n$$\n四舍五入到三位有效数字，近似位置为 $0.183$。",
            "answer": "$$\\boxed{0.183}$$"
        },
        {
            "introduction": "在掌握了基本步骤后，下一步是处理更贴近现实世界的场景，即变化率同时依赖于时间和系统当前状态。本练习  要求你迭代应用休恩方法，解决一个微分方程，其右侧函数 $f(t, y)$ 同时依赖于 $t$ 和 $y$。通过执行连续的两个步骤，你将体验到数值方法如何逐步构建出解的近似轨迹。",
            "id": "2200989",
            "problem": "在许多科学和工程模型中，我们会遇到难以或无法解析求解的一阶常微分方程（ODE）。考虑一个由此定义的初值问题：\n$$ \\frac{dy}{dt} = t - 2y, \\quad y(0) = 3 $$\n你的任务是近似求解在点 $t = 0.2$ 处解 $y(t)$ 的值。为此，你将使用休恩（Heun）方法。使用步长 $h=0.1$ 进行两个连续的步骤。\n\n对于形式为 $\\frac{dy}{dt} = f(t,y)$ 的常微分方程，从 $(t_i, y_i)$ 到 $(t_{i+1}, y_{i+1})$ 的休恩方法的单步计算采用预测-校正方法：\n1.  预测斜率：$k_1 = f(t_i, y_i)$\n2.  校正斜率：$k_2 = f(t_i + h, y_i + h k_1)$\n3.  组合：$y_{i+1} = y_i + \\frac{h}{2}(k_1 + k_2)$\n\n使用此方案，求 $y(0.2)$ 的值。将你的最终答案四舍五入到四位有效数字。",
            "solution": "给定初值问题 $y^{\\prime}=f(t,y)=t-2y$ 及 $y(0)=3$，要求使用步长为 $h=0.1$ 的休恩方法，通过两步计算来近似 $y(0.2)$。\n\n从 $(t_{i},y_{i})$ 到 $(t_{i+1},y_{i+1})$ 的休恩方法使用以下公式：\n$$\nk_{1}=f(t_{i},y_{i}), \\quad\nk_{2}=f(t_{i}+h,\\,y_{i}+h k_{1}), \\quad\ny_{i+1}=y_{i}+\\frac{h}{2}\\left(k_{1}+k_{2}\\right).\n$$\n\n第1步：从 $t_{0}=0$ 到 $t_{1}=0.1$，初始值为 $y_{0}=3$。\n计算\n$$\nk_{1}=f(0,3)=0-2\\cdot 3=-6,\n$$\n$$\nk_{2}=f\\!\\left(0.1,\\,3+0.1(-6)\\right)=f(0.1,\\,2.4)=0.1-2\\cdot 2.4=-4.7,\n$$\n$$\ny_{1}=3+\\frac{0.1}{2}\\left(-6+(-4.7)\\right)=3+0.05(-10.7)=3-0.535=2.465.\n$$\n\n第2步：从 $t_{1}=0.1$ 到 $t_{2}=0.2$，初始值为 $y_{1}=2.465$。\n计算\n$$\nk_{1}=f(0.1,2.465)=0.1-2\\cdot 2.465=-4.83,\n$$\n$$\nk_{2}=f\\!\\left(0.2,\\,2.465+0.1(-4.83)\\right)=f(0.2,\\,1.982)=0.2-2\\cdot 1.982=-3.764,\n$$\n$$\ny_{2}=2.465+\\frac{0.1}{2}\\left(-4.83+(-3.764)\\right)=2.465+0.05(-8.594)=2.465-0.4297=2.0353.\n$$\n\n因此，在 $t=0.2$ 处，通过休恩方法得到的近似值为 $y(0.2)\\approx 2.0353$，保留四位有效数字为 $2.035$。",
            "answer": "$$\\boxed{2.035}$$"
        },
        {
            "introduction": "任何数值方法都有其精度和局限性，理解这些是成为一个优秀问题解决者的关键。本练习  挑战你跳出纯粹的计算，从分析的角度思考休恩方法的准确性。通过探究该方法在何种情况下能给出精确解，你将揭示其与梯形积分法则的深刻联系，从而深化对二阶龙格-库塔方法本质的理解。",
            "id": "2200981",
            "problem": "Heun 法，也称为改进的欧拉法，是一种二阶 Runge-Kutta 方法，用于数值求解形式为 $y'(t) = f(t, y)$、初始条件为 $y(t_0) = y_0$ 的一阶常微分方程。将解从时间 $t_i$ 推进到 $t_{i+1} = t_i + h$（其中 $h$ 为步长）的迭代公式由以下两步过程给出：\n\n1.  **预测步：** 计算下一个值的初步估计值 $y_{i+1}^*$。\n    $$y_{i+1}^* = y_i + h f(t_i, y_i)$$\n2.  **校正步：** 使用区间起点和终点斜率的平均值来计算最终值 $y_{i+1}$。\n    $$y_{i+1} = y_i + \\frac{h}{2} \\left[ f(t_i, y_i) + f(t_{i+1}, y_{i+1}^*) \\right]$$\n\n虽然数值方法通常在每一步都会引入一些误差，但对于函数 $f(t,y)$ 的某些特定形式，Heun 法可以得到精确解。\n\n对于函数 $f(t,y)$ 的下列哪种形式，Heun 法能保证对任意初始条件 $y(t_0) = y_0$ 和任意非零步长 $h$ 都能得到精确的解析解？（假设 $a$ 和 $b$ 是非零实常数）。\n\nA. $f(t, y) = at + b$\n\nB. $f(t, y) = ay$\n\nC. $f(t, y) = at^2$\n\nD. $f(t, y) = \\sin(t)$\n\nE. $f(t, y) = e^y$",
            "solution": "我们将 Heun 更新与每种给定形式的 $f(t,y)$ 的精确单步解进行比较。\n\n从 $t_{i}$ 到 $t_{i+1}=t_{i}+h$ 的精确单步解是\n$$\ny(t_{i+1})=y(t_{i})+\\int_{t_{i}}^{t_{i+1}} f\\big(t,y(t)\\big)\\,dt.\n$$\nHeun 法计算\n$$\ny_{i+1}=y_{i}+\\frac{h}{2}\\left[f(t_{i},y_{i})+f\\!\\left(t_{i+1},y_{i+1}^{*}\\right)\\right],\n$$\n其中预测值为\n$$\ny_{i+1}^{*}=y_{i}+h f(t_{i},y_{i}).\n$$\n\n情况 A：$f(t,y)=at+b$（与 $y$ 无关，关于 $t$ 线性）。\n则 $f(t_{i},y_{i})=a t_{i}+b$ 且 $f(t_{i+1},y_{i+1}^{*})=a t_{i+1}+b$（不依赖于 $y$）。Heun 法简化为梯形法则：\n$$\ny_{i+1}=y_{i}+\\frac{h}{2}\\big[(a t_{i}+b)+(a t_{i+1}+b)\\big].\n$$\n$at+b$ 在 $[t_{i},t_{i+1}]$ 上的精确积分为\n$$\n\\int_{t_{i}}^{t_{i}+h} (a t+b)\\,dt=\\frac{a}{2}\\big((t_{i}+h)^{2}-t_{i}^{2}\\big)+b h\n=\\frac{h}{2}\\big(a(t_{i}+t_{i+1})+2b\\big),\n$$\n这与前面的表达式完全相同。因此，对于任意 $h\\neq 0$ 和任意初始条件，当 $f(t,y)=at+b$ 时，Heun 法能得到精确的解析解。\n\n情况 B：$f(t,y)=a y$。\n预测值：$y_{i+1}^{*}=y_{i}+h a y_{i}=(1+a h)y_{i}$。\n校正值：\n$$\ny_{i+1}=y_{i}+\\frac{h}{2}\\left[a y_{i}+a y_{i+1}^{*}\\right]\n=y_{i}+\\frac{h}{2}a\\left[y_{i}+(1+a h)y_{i}\\right]\n=\\left(1+a h+\\frac{(a h)^{2}}{2}\\right)y_{i}.\n$$\n精确的单步解是 $y(t_{i+1})=\\exp(a h)y_{i}$，对于一般的 $h$，这不等于 $1+a h+(a h)^{2}/2$。因此通常不是精确的。\n\n情况 C：$f(t,y)=a t^{2}$（与 $y$ 无关，关于 $t$ 二次）。\nHeun 法给出\n$$\ny_{i+1}=y_{i}+\\frac{h}{2}\\left[a t_{i}^{2}+a(t_{i}+h)^{2}\\right]\n=y_{i}+a h t_{i}^{2}+a h^{2} t_{i}+\\frac{a h^{3}}{2}.\n$$\n精确积分为\n$$\n\\int_{t_{i}}^{t_{i}+h} a t^{2}\\,dt=a\\left[\\frac{(t_{i}+h)^{3}-t_{i}^{3}}{3}\\right]\n=a\\left(t_{i}^{2}h+t_{i}h^{2}+\\frac{h^{3}}{3}\\right).\n$$\n差值为 $a h^{3}\\left(\\frac{1}{2}-\\frac{1}{3}\\right)=\\frac{a h^{3}}{6}\\neq 0$（对于 $h\\neq 0$），因此不精确。\n\n情况 D：$f(t,y)=\\sin(t)$（与 $y$ 无关，但关于 $t$ 非线性）。\nHeun 法得到\n$$\ny_{i+1}-y_{i}=\\frac{h}{2}\\big[\\sin(t_{i})+\\sin(t_{i}+h)\\big]\n=h\\,\\sin\\!\\left(t_{i}+\\frac{h}{2}\\right)\\cos\\!\\left(\\frac{h}{2}\\right).\n$$\n精确积分为\n$$\n\\int_{t_{i}}^{t_{i}+h}\\sin t\\,dt=\\cos(t_{i})-\\cos(t_{i}+h)\n=2\\sin\\!\\left(\\frac{h}{2}\\right)\\sin\\!\\left(t_{i}+\\frac{h}{2}\\right).\n$$\n它们的差值为\n$$\n\\sin\\!\\left(t_{i}+\\frac{h}{2}\\right)\\left[h\\cos\\!\\left(\\frac{h}{2}\\right)-2\\sin\\!\\left(\\frac{h}{2}\\right)\\right],\n$$\n对于任意 $h$ 不恒为零，因此不精确。\n\n情况 E：$f(t,y)=\\exp(y)$（关于 $y$ 非线性）。\nHeun 是一种二阶方法，对于一般的非线性函数 $f$，其局部截断误差为 $h^{3}$ 阶。当 $f$ 非线性地依赖于 $y$ 时，对于一般的 $h$，该方法不是精确的。一个简单的对比是：对于 $f(t,y)=a y$（一个更简单的关于 $y$ 线性的情况），如情况 B 所示，Heun 法已经不是精确的；因此，对于更非线性的 $f(t,y)=\\exp(y)$，它也不可能是精确的。\n\n因此，只有当 $f$ 与 $y$ 无关且关于 $t$ 线性，即 $f(t,y)=at+b$ 时，Heun 法才能对任意初始条件和任意非零步长给出精确的解析解。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}