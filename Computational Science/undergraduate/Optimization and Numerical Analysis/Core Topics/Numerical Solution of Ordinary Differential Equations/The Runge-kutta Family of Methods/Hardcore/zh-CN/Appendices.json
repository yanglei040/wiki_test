{
    "hands_on_practices": [
        {
            "introduction": "经典的四阶龙格-库塔 (RK4) 方法是求解常微分方程的“主力军”。其强大之处在于它能在积分区间内巧妙地选取四个不同点来评估斜率，从而得到一个高精度的加权平均值。本练习将一个 RK4 步骤分解为这四个核心的“阶段” ($k_1, k_2, k_3, k_4$)，帮助你从内部构建对该方法工作原理的深刻理解 ()。",
            "id": "2219964",
            "problem": "考虑由下式给出的一阶常微分方程 (ODE)：\n$$\n\\frac{dy}{dt} = \\sin(t) - y^{2}\n$$\n其初始条件为 $y(0) = 0.5$。\n\n我们希望使用经典的四阶龙格-库塔 (RK4) 方法来近似其解。该方法的第一步涉及计算四个中间斜率值，或称为“级”，记为 $k_1, k_2, k_3$ 和 $k_4$。对于形式为 $\\frac{dy}{dt} = f(t, y)$ 的常微分方程，从点 $(t_n, y_n)$ 开始，步长为 $h$，这些级定义如下：\n\\begin{align*}\nk_1 = f(t_n, y_n) \\\\\nk_2 = f\\left(t_n + \\frac{h}{2}, y_n + h\\frac{k_1}{2}\\right) \\\\\nk_3 = f\\left(t_n + \\frac{h}{2}, y_n + h\\frac{k_2}{2}\\right) \\\\\nk_4 = f(t_n + h, y_n + h k_3)\n\\end{align*}\n\n请计算从给定初始条件开始的单步中，四个级 $k_1, k_2, k_3$ 和 $k_4$ 的值，使用的步长为 $h = 0.2$。假设正弦函数的参数以弧度为单位。\n\n按顺序给出 $k_1, k_2, k_3$ 和 $k_4$ 的四个数值作为答案，每个数值需四舍五入到四位有效数字。",
            "solution": "我们有常微分方程 $y' = f(t,y) = \\sin(t) - y^{2}$，其初始条件为 $(t_{0},y_{0})=(0,0.5)$，步长 $h=0.2$。RK4的各级为\n$$\nk_{1}=f(t_{0},y_{0}),\\quad\nk_{2}=f\\left(t_{0}+\\frac{h}{2},\\,y_{0}+\\frac{h}{2}k_{1}\\right),\\quad\nk_{3}=f\\left(t_{0}+\\frac{h}{2},\\,y_{0}+\\frac{h}{2}k_{2}\\right),\\quad\nk_{4}=f\\left(t_{0}+h,\\,y_{0}+h\\,k_{3}\\right).\n$$\n计算每一级：\n1) $k_{1} = \\sin(0) - (0.5)^{2} = 0 - 0.25 = -0.25$。\n\n2) 对于 $k_{2}$，使用 $t_{0}+\\frac{h}{2}=0.1$ 和 $y_{0}+\\frac{h}{2}k_{1}=0.5+\\frac{0.2}{2}(-0.25)=0.475$，因此\n$$\nk_{2}=\\sin(0.1) - (0.475)^{2} = 0.09983341664682815 - 0.225625 = -0.12579158335317182.\n$$\n\n3) 对于 $k_{3}$，使用 $t_{0}+\\frac{h}{2}=0.1$ 和 $y_{0}+\\frac{h}{2}k_{2}=0.5+0.1(-0.12579158335317182)=0.4874208416646828$，因此\n$$\n(0.4874208416646828)^{2} \\approx 0.23757907690468282,\n$$\n所以\n$$\nk_{3}=\\sin(0.1) - (0.4874208416646828)^{2} = 0.09983341664682815 - 0.23757907690468282 = -0.13774566025785467.\n$$\n\n4) 对于 $k_{4}$，使用 $t_{0}+h=0.2$ 和 $y_{0}+h\\,k_{3}=0.5+0.2(-0.13774566025785467)=0.47245086794842906$，因此\n$$\n(0.47245086794842906)^{2} \\approx 0.22321002262447222,\\quad \\sin(0.2)=0.19866933079506122,\n$$\n所以\n$$\nk_{4}=\\sin(0.2) - (0.47245086794842906)^{2} = 0.19866933079506122 - 0.22321002262447222 = -0.02454069182941100.\n$$\n\n四舍五入到四位有效数字：\n$$\nk_{1}=-0.2500,\\quad k_{2}=-0.1258,\\quad k_{3}=-0.1377,\\quad k_{4}=-0.02454.\n$$",
            "answer": "$$\\boxed{\\begin{pmatrix}-0.2500  -0.1258  -0.1377  -0.02454\\end{pmatrix}}$$"
        },
        {
            "introduction": "一个好的数值方法不僅僅是追求计算结果的准确性，还应尽可能地尊重问题背后的物理定律。本练习将探讨一个简谐振子系统，在理想情况下其总能量是守恒的。我们将通过动手计算，亲眼见证像前向欧拉法这样的简单方法是如何系统性地破坏能量守恒定律的 ()，这突显了为特定问题选择合适数值方法的重要性，并揭示了数值穩定性和定性行为等核心概念。",
            "id": "2219992",
            "problem": "考虑一个简谐振子，其运动由以下一阶常微分方程组描述：\n$$\n\\frac{dx}{dt} = v\n$$\n$$\n\\frac{dv}{dt} = -x\n$$\n其中 $x$ 是振子的位置，$v$ 是振子的速度。系统的总机械能定义为 $E = \\frac{1}{2}(x^2 + v^2)$。\n\n假设系统在时间 $t=0$ 时处于初始状态 $(x_0, v_0)$，初始能量为 $E_0$。我们希望使用前向欧拉法的单步来近似系统在稍后时间 $t=h$ 的状态。对于系统 $\\frac{d\\mathbf{y}}{dt} = \\mathbf{f}(t, \\mathbf{y})$，前向欧拉法使用公式 $\\mathbf{y}_{n+1} = \\mathbf{y}_n + h \\cdot \\mathbf{f}(t_n, \\mathbf{y}_n)$ 将解从 $\\mathbf{y}_n$推进到 $\\mathbf{y}_{n+1}$，其中 $h$ 是时间步长，且我们假设 $h  0$。\n\n令新状态为 $(x_1, v_1)$，对应的能量为 $E_1$。求比值 $\\frac{E_1}{E_0}$，假设初始状态不是原点（即 $E_0 \\neq 0$）。你的答案应仅用步长 $h$ 表示。",
            "solution": "我们将该系统写成向量形式 $\\mathbf{y} = \\begin{pmatrix} x \\\\ v \\end{pmatrix}$，其中 $\\mathbf{f}(\\mathbf{y}) = \\begin{pmatrix} v \\\\ -x \\end{pmatrix}$。从 $(x_{0}, v_{0})$ 开始，使用步长为 $h$ 的单步前向欧拉法，得到\n$$\nx_{1} = x_{0} + h v_{0}, \\quad v_{1} = v_{0} + h(-x_{0}) = v_{0} - h x_{0}.\n$$\n第 $n$ 步的能量定义为 $E_{n} = \\frac{1}{2}(x_{n}^{2} + v_{n}^{2})$。因此，\n$$\nE_{1} = \\frac{1}{2}\\left(x_{1}^{2} + v_{1}^{2}\\right) = \\frac{1}{2}\\left((x_{0} + h v_{0})^{2} + (v_{0} - h x_{0})^{2}\\right).\n$$\n展开每个平方项并求和，\n$$\n(x_{0} + h v_{0})^{2} = x_{0}^{2} + 2 h x_{0} v_{0} + h^{2} v_{0}^{2}, \\quad (v_{0} - h x_{0})^{2} = v_{0}^{2} - 2 h x_{0} v_{0} + h^{2} x_{0}^{2},\n$$\n所以\n$$\nx_{1}^{2} + v_{1}^{2} = x_{0}^{2} + v_{0}^{2} + h^{2}(x_{0}^{2} + v_{0}^{2}).\n$$\n因此，\n$$\nE_{1} = \\frac{1}{2}(1 + h^{2})(x_{0}^{2} + v_{0}^{2}) = (1 + h^{2}) E_{0}.\n$$\n由于 $E_{0} \\neq 0$，该比值为\n$$\n\\frac{E_{1}}{E_{0}} = 1 + h^{2}.\n$$",
            "answer": "$$\\boxed{1 + h^{2}}$$"
        },
        {
            "introduction": "并非所有的龙格-库塔方法都像我们之前看到的 RK4 方法那样是“显式”的，可以直接计算出下一步的结果。本练习将引导我们进入“隐式”方法的世界，以隐式中点法为例。你将发现，隐式方法在每一步都需要我们求解一个代数方程，这虽然计算成本更高，但对于处理某些困难的“刚性”问题时却能提供巨大的稳定性优势 ()。这个练习的核心任务是推导出这个需要求解的具体方程，从而揭示隐式方法在实现上的根本区别。",
            "id": "2219962",
            "problem": "在数值分析中，求解常微分方程（ODEs）的隐式方法通常需要在每个时间步求解一个代数方程。考虑由 Riccati 微分方程 $y'(t) = (y(t))^2 - t$ 定义的初值问题。\n\n我们希望使用隐式中点法（一种单步数值积分法）来近似求解此常微分方程。该方法将解从时间 $t_n$ 推进到 $t_{n+1} = t_n + h$，其中 $h$ 是步长。设 $y_n$ 是 $y(t_n)$ 的数值近似值，$y_{n+1}$ 是 $y(t_{n+1})$ 的近似值。\n\n对于应用于给定 Riccati 方程的隐式中点法，每个步骤都需要求解一个关于 $y_{n+1}$ 的非线性代数方程的根。这个方程可以表示为标准多项式形式 $F(y_{n+1}) = 0$。\n\n确定函数 $F(y_{n+1})$ 的表达式。您的表达式应为变量 $y_{n+1}$ 的多项式，其系数可以依赖于 $y_n$、$t_n$ 和 $h$。为保持一致性，请确保 $y_{n+1}$ 最高次幂的系数恰好为 $h$。",
            "solution": "任务是找出函数 $F(y_{n+1})$ 的表达式，该函数定义了将隐式中点法应用于常微分方程 $y'(t) = f(t,y) = y^2 - t$ 时，在每个步骤中需要求解的非线性代数方程。\n\n首先，我们陈述隐式中点法的通用公式。该方法是 Runge-Kutta 方法族的一员，由以下更新规则定义：\n$$y_{n+1} = y_n + h f\\left(t_n + \\frac{h}{2}, \\frac{y_n + y_{n+1}}{2}\\right)$$\n此处，$y_n$ 是在时间 $t_n$ 的已知近似值，$h$ 是步长，$y_{n+1}$ 是在下一个时间步 $t_{n+1} = t_n + h$ 的未知近似值。函数 $f(t,y)$ 是常微分方程 $y'(t) = f(t,y)$ 的右端项。\n\n对于给定问题，Riccati 方程为 $y'(t) = y(t)^2 - t$。因此，我们的函数 $f(t,y)$ 是：\n$$f(t,y) = y^2 - t$$\n\n要应用隐式中点法，我们需要在中点参数 $t = t_n + \\frac{h}{2}$ 和 $y = \\frac{y_n + y_{n+1}}{2}$ 处计算 $f$ 的值。将这些代入 $f(t,y)$ 的表达式中：\n$$f\\left(t_n + \\frac{h}{2}, \\frac{y_n + y_{n+1}}{2}\\right) = \\left(\\frac{y_n + y_{n+1}}{2}\\right)^2 - \\left(t_n + \\frac{h}{2}\\right)$$\n\n现在，我们将此结果代回隐式中点法公式：\n$$y_{n+1} = y_n + h \\left[ \\left(\\frac{y_n + y_{n+1}}{2}\\right)^2 - \\left(t_n + \\frac{h}{2}\\right) \\right]$$\n\n题目要求我们找到函数 $F(y_{n+1})$ 使得 $F(y_{n+1}) = 0$。为此，我们必须将上述方程重排成所有项都在一侧的标准多项式形式。让我们展开各项：\n$$y_{n+1} = y_n + h \\left[ \\frac{(y_n + y_{n+1})^2}{4} - t_n - \\frac{h}{2} \\right]$$\n$$y_{n+1} = y_n + h \\left[ \\frac{y_n^2 + 2y_n y_{n+1} + y_{n+1}^2}{4} - t_n - \\frac{h}{2} \\right]$$\n\n为了消去分母中的分数，我们可以将整个方程乘以4：\n$$4y_{n+1} = 4y_n + h(y_n^2 + 2y_n y_{n+1} + y_{n+1}^2) - 4ht_n - 2h^2$$\n\n现在，我们将所有项移到一边，使方程等于零。我们将 $4y_{n+1}$ 项移到右边：\n$$0 = 4y_n - 4y_{n+1} + h(y_n^2 + 2y_n y_{n+1} + y_{n+1}^2) - 4ht_n - 2h^2$$\n\n接下来，我们展开并根据 $y_{n+1}$ 的幂次对各项进行分组：\n$$0 = 4y_n - 4y_{n+1} + hy_n^2 + 2hy_n y_{n+1} + hy_{n+1}^2 - 4ht_n - 2h^2$$\n\n按 $y_{n+1}$ 的幂次合并同类项：\n$$0 = (h)y_{n+1}^2 + (2hy_n - 4)y_{n+1} + (hy_n^2 + 4y_n - 4ht_n - 2h^2)$$\n\n此方程的形式为 $F(y_{n+1}) = 0$。$y_{n+1}$ 的最高次幂（即 $y_{n+1}^2$）的系数为 $h$，与题目要求一致。\n\n因此，函数 $F(y_{n+1})$ 的表达式为：\n$$F(y_{n+1}) = h y_{n+1}^2 + (2h y_n - 4) y_{n+1} + h y_n^2 + 4y_n - 4h t_n - 2h^2$$",
            "answer": "$$\\boxed{h y_{n+1}^{2} + (2h y_{n} - 4) y_{n+1} + h y_{n}^{2} + 4y_{n} - 4h t_{n} - 2h^{2}}$$"
        }
    ]
}