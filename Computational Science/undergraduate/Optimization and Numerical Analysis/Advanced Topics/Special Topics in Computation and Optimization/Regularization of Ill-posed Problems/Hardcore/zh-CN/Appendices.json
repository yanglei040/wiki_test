{
    "hands_on_practices": [
        {
            "introduction": "许多科学和工程问题可以被建模为线性方程组。当方程的数量少于未知数的数量时，我们会遇到一个“欠定”系统，它拥有无穷多组解。这个练习旨在介绍正则化的核心思想：通过引入一个额外的标准来从无限的解中选择一个唯一的、“最优”的解。具体来说，我们将探索吉洪诺夫（Tikhonov）正则化如何通过最小化解向量的欧几里得范数（即 $L_2$ 范数），来找到那个离原点最近的解，这在几何上直观，在物理上通常对应着能量最低的稳定状态。",
            "id": "2197177",
            "problem": "一个资源分配系统的简化模型涉及两个控制变量 $x_1$ 和 $x_2$。为达到目标输出，这些变量必须满足线性约束方程 $3x_1 + 2x_2 = 10$。该系统被设计为以最小的能量消耗运行。运行成本（用 $L$ 表示）与控制变量的平方和成正比，这意味着需要最小化 $L = x_1^2 + x_2^2$。\n\n从满足约束条件的无限多对 $(x_1, x_2)$ 中，确定唯一能使成本函数 $L$ 最小化的那对值。请以一对值 $(x_1, x_2)$ 的形式给出你的答案。",
            "solution": "该问题要求我们找到在满足线性约束条件 $3x_1 + 2x_2 = 10$ 的前提下，使目标函数 $L(x_1, x_2) = x_1^2 + x_2^2$ 最小化的 $x_1$ 和 $x_2$ 的值。这是一个约束优化问题。\n\n首先，我们可以利用约束方程将一个变量用另一个变量表示。让我们求解约束方程得到 $x_2$：\n$$3x_1 + 2x_2 = 10$$\n$$2x_2 = 10 - 3x_1$$\n$$x_2 = 5 - \\frac{3}{2}x_1$$\n\n现在，我们可以将这个 $x_2$ 的表达式代入目标函数 $L$。这将 $L$ 转换为一个单变量 $x_1$ 的函数。\n$$L(x_1) = x_1^2 + \\left(5 - \\frac{3}{2}x_1\\right)^2$$\n\n为了找到使 $L$ 最小化的 $x_1$ 的值，我们首先展开 $L(x_1)$ 的表达式：\n$$L(x_1) = x_1^2 + \\left(5^2 - 2(5)\\left(\\frac{3}{2}x_1\\right) + \\left(\\frac{3}{2}x_1\\right)^2\\right)$$\n$$L(x_1) = x_1^2 + 25 - 15x_1 + \\frac{9}{4}x_1^2$$\n\n合并包含 $x_1^2$ 的项：\n$$L(x_1) = \\left(1 + \\frac{9}{4}\\right)x_1^2 - 15x_1 + 25$$\n$$L(x_1) = \\frac{13}{4}x_1^2 - 15x_1 + 25$$\n\n这是一个关于 $x_1$ 的二次函数，其图像开口向上（因为系数 $\\frac{13}{4}$ 为正），因此它有唯一的最小值。为了找到最小值，我们对 $L(x_1)$ 关于 $x_1$ 求导，并令其等于零。\n$$\\frac{dL}{dx_1} = \\frac{d}{dx_1}\\left(\\frac{13}{4}x_1^2 - 15x_1 + 25\\right)$$\n$$\\frac{dL}{dx_1} = 2 \\cdot \\frac{13}{4}x_1 - 15$$\n$$\\frac{dL}{dx_1} = \\frac{13}{2}x_1 - 15$$\n\n将导数设为零以找到临界点：\n$$\\frac{13}{2}x_1 - 15 = 0$$\n$$\\frac{13}{2}x_1 = 15$$\n$$x_1 = 15 \\cdot \\frac{2}{13}$$\n$$x_1 = \\frac{30}{13}$$\n\n现在我们得到了 $x_1$ 的值，可以将其代回从约束条件中导出的 $x_2$ 的表达式中：\n$$x_2 = 5 - \\frac{3}{2}x_1$$\n$$x_2 = 5 - \\frac{3}{2}\\left(\\frac{30}{13}\\right)$$\n$$x_2 = 5 - \\frac{90}{26}$$\n$$x_2 = 5 - \\frac{45}{13}$$\n\n为了进行分数减法，我们通分：\n$$x_2 = \\frac{5 \\cdot 13}{13} - \\frac{45}{13}$$\n$$x_2 = \\frac{65 - 45}{13}$$\n$$x_2 = \\frac{20}{13}$$\n\n因此，满足约束条件并使成本函数最小化的控制变量对是 $(x_1, x_2) = \\left(\\frac{30}{13}, \\frac{20}{13}\\right)$。",
            "answer": "$$\\boxed{\\left(\\frac{30}{13}, \\frac{20}{13}\\right)}$$"
        },
        {
            "introduction": "在掌握了正则化可以帮助我们从众多可能解中进行选择的基本概念后，一个自然的问题是：我们应该使用哪种正则化方法？不同的正则化项会导致性质迥异的解。本练习将直接对比两种最常见的正则化技术：吉洪诺夫正则化（使用 $L_2$ 范数）和 LASSO（最小绝对收缩和选择算子，使用 $L_1$ 范数）。通过解决一个简单的欠定问题，你将亲身体验到 $L_2$ 正则化倾向于产生“稠密”解（所有分量都较小），而 $L_1$ 正则化则能产生“稀疏”解（部分分量恰好为零），这一特性在特征选择和模型简化中至关重要。",
            "id": "2197169",
            "problem": "考虑一个欠定线性系统 $Ax = b$，其中解向量为 $x = \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix} \\in \\mathbb{R}^2$，矩阵为 $A = \\begin{pmatrix} 2  1 \\end{pmatrix}$，右端项为标量 $b=4$。该系统代表了单个方程 $2x_1 + x_2 = 4$，有无穷多解。为了选择一个唯一且理想的解，我们可以采用正则化技术。\n\n本问题探究两种常见的正则化方法：\n\n1.  **Tikhonov 正则化 (L2 范数)：** Tikhonov 正则化解，记作 $x_T$，是使目标函数 $F(x) = \\|Ax-b\\|_2^2 + \\lambda \\|x\\|_2^2$ 最小化的向量 $x$。此处，$\\|v\\|_2 = \\sqrt{\\sum_i v_i^2}$ 是向量 $v$ 的标准欧几里得范数（或 L2 范数）。\n\n2.  **LASSO 正则化 (L1 范数)：** LASSO 解，记作 $x_L$，是使目标函数 $G(x) = \\|Ax-b\\|_2^2 + \\lambda \\|x\\|_1$ 最小化的向量 $x$。此处，$\\|v\\|_1 = \\sum_i |v_i|$ 是向量 $v$ 的出租车范数（或 L1 范数）。首字母缩写 LASSO 代表最小绝对值收缩和选择算子 (Least Absolute Shrinkage and Selection Operator)。\n\n对两种方法均使用正则化参数 $\\lambda = 4$，计算两个所得解向量的 L1 范数之比 $\\frac{\\|x_T\\|_1}{\\|x_L\\|_1}$。\n\n请将您的答案表示为最简精确分数形式。",
            "solution": "我们有 $A=\\begin{pmatrix}2  1\\end{pmatrix}$，$b=4$ 及 $x=\\begin{pmatrix}x_{1} \\\\ x_{2}\\end{pmatrix}$。\n\n对于参数为 $\\lambda=4$ 的 Tikhonov 正则化，我们最小化 $F(x)=\\|Ax-b\\|_{2}^{2}+4\\|x\\|_{2}^{2}$。岭回归的一阶最优性条件为\n$$(A^{T}A+\\lambda I)x=A^{T}b.$$\n计算\n$$A^{T}A=\\begin{pmatrix}4  2 \\\\ 2  1\\end{pmatrix},\\quad \\lambda I=\\begin{pmatrix}4  0 \\\\ 0  4\\end{pmatrix},\\quad A^{T}b=\\begin{pmatrix}8 \\\\ 4\\end{pmatrix}.$$\n因此\n$$\\begin{pmatrix}8  2 \\\\ 2  5\\end{pmatrix}x=\\begin{pmatrix}8 \\\\ 4\\end{pmatrix}.$$\n求解得，\n$$\\det=8\\cdot 5-2\\cdot 2=36,\\quad x_{T}=\\frac{1}{36}\\begin{pmatrix}5  -2 \\\\ -2  8\\end{pmatrix}\\begin{pmatrix}8 \\\\ 4\\end{pmatrix}=\\frac{1}{36}\\begin{pmatrix}32 \\\\ 16\\end{pmatrix}=\\begin{pmatrix}\\frac{8}{9} \\\\ \\frac{4}{9}\\end{pmatrix}.$$\n因此\n$$\\|x_{T}\\|_{1}=\\left|\\frac{8}{9}\\right|+\\left|\\frac{4}{9}\\right|=\\frac{12}{9}=\\frac{4}{3}.$$\n\n对于 $\\lambda=4$ 的 LASSO，我们最小化 $G(x)=\\|Ax-b\\|_{2}^{2}+4\\|x\\|_{1}$。令 $r=Ax-b=2x_{1}+x_{2}-4$。次梯度最优性条件为\n$$2A^{T}(Ax-b)+\\lambda z=0,\\quad z\\in\\partial\\|x\\|_{1}.$$\n由于 $A^{T}(Ax-b)=\\begin{pmatrix}2r \\\\ r\\end{pmatrix}$，我们得到\n$$\\begin{pmatrix}4r \\\\ 2r\\end{pmatrix}+4\\begin{pmatrix}z_{1} \\\\ z_{2}\\end{pmatrix}=0\\quad\\Rightarrow\\quad z_{1}=-r,\\; z_{2}=-\\frac{r}{2}.$$\n可行性要求 $z_{i}\\in\\partial|x_{i}|$：如果 $x_{i}\\neq 0$，则 $z_{i}=\\operatorname{sign}(x_{i})\\in\\{\\pm 1\\}$；如果 $x_{i}=0$，则 $z_{i}\\in[-1,1]$。\n\n- 如果 $x_{1}\\neq 0$ 且 $x_{2}\\neq 0$，那么 $z_{1},z_{2}\\in\\{\\pm 1\\}$，这将同时要求 $-r\\in\\{\\pm 1\\}$ 和 $-r/2\\in\\{\\pm 1\\}$；不存在满足这两个等式的 $r$，因此这种情况不可能。\n\n- 如果 $x_{1}=0$ 且 $x_{2}\\neq 0$，那么 $z_{1}=-r\\in[-1,1]$ 意味着 $r\\in[-1,1]$，但 $z_{2}=-r/2=\\operatorname{sign}(x_{2})\\in\\{\\pm 1\\}$ 要求 $r\\in\\{-2,2\\}$，这是一个矛盾。\n\n- 如果 $x_{2}=0$ 且 $x_{1}\\neq 0$，那么 $z_{1}=-r=\\operatorname{sign}(x_{1})\\in\\{\\pm 1\\}$ 意味着 $r\\in\\{-1,1\\}$，并且 $z_{2}=-r/2\\in[-1,1]$ 对这两个 $r$ 值都自动成立。检查与 $r=2x_{1}-4$ 的一致性：\n  - 如果 $r=-1$，则 $2x_{1}-4=-1$ 得到 $x_{1}=\\frac{3}{2}$，这与 $\\operatorname{sign}(x_{1})=+1$ 相符，因此 $z_{1}=-r=1$。\n  - 如果 $r=1$，则 $2x_{1}-4=1$ 得到 $x_{1}=\\frac{5}{2}$，这将要求 $z_{1}=-1$，与 $\\operatorname{sign}(x_{1})=+1$ 矛盾。\n\n因此 LASSO 最小化解为\n$$x_{L}=\\begin{pmatrix}\\frac{3}{2} \\\\ 0\\end{pmatrix},\\quad \\|x_{L}\\|_{1}=\\frac{3}{2}.$$\n\n最后，所求的比率为\n$$\\frac{\\|x_{T}\\|_{1}}{\\|x_{L}\\|_{1}}=\\frac{\\frac{4}{3}}{\\frac{3}{2}}=\\frac{4}{3}\\cdot\\frac{2}{3}=\\frac{8}{9}.$$",
            "answer": "$$\\boxed{\\frac{8}{9}}$$"
        },
        {
            "introduction": "在应用正则化方法时，最关键也最具挑战性的步骤之一是选择合适的正则化参数 $\\lambda$。这个参数控制着模型对数据的拟合程度与解的“简单性”（由罚项定义）之间的权衡。一个太大的 $\\lambda$ 会导致解过于平滑而忽略数据中的重要特征，而一个太小的 $\\lambda$ 则可能无法有效抑制不稳定性。本练习将介绍一种强大的自动化技术——广义交叉验证（Generalized Cross-Validation, GCV），用于在不预先知道噪声水平的情况下选择最优的 $\\lambda$。你将通过计算一个具体反卷积问题中的 GCV 函数值，来理解这一数据驱动方法是如何工作的。",
            "id": "2197162",
            "problem": "一位工程师正在致力于恢复一个被模糊和噪声污染的信号。该问题被表述为一个一维 (1D) 离散反卷积问题，由线性系统 $y = Kx + \\epsilon$ 描述，其中 $y \\in \\mathbb{R}^3$ 是观测数据向量，$K \\in \\mathbb{R}^{3 \\times 3}$ 是模糊矩阵，$x \\in \\mathbb{R}^3$ 是未知的真实信号，$\\epsilon$ 是一个加性噪声向量。\n\n为了找到一个稳定解，采用了 Tikhonov 正则化方法。最优正则化参数 $\\lambda$ 是通过广义交叉验证 (GCV) 方法确定的，该方法在不预先知道噪声水平的情况下，最小化 GCV 函数 $V(\\lambda)$。\n\n该分析是使用矩阵 $K$ 的奇异值分解 (SVD) 进行的。在这个基下，对于一个大小为 $N$ 的系统，GCV 函数可以写成：\n$$ V(\\lambda) = N \\frac{\\sum_{i=1}^{N} \\left( \\frac{\\lambda^2 y'_i}{\\sigma_i^2 + \\lambda^2} \\right)^2}{\\left( \\sum_{i=1}^{N} \\frac{\\lambda^2}{\\sigma_i^2 + \\lambda^2} \\right)^2} $$\n其中 $\\{\\sigma_i\\}$ 是 $K$ 的奇异值，$\\{y'_i\\}$ 是数据向量 $y$ 投影到 $K$ 的左奇异向量基上的分量。\n\n对于这个具体问题，系统大小为 $N=3$。矩阵 $K$ 的奇异值已被计算为：\n$$ \\sigma_1 = 10, \\quad \\sigma_2 = 1, \\quad \\sigma_3 = 0.1 $$\n变换后数据向量的分量为：\n$$ y'_1 = 10, \\quad y'_2 = 2, \\quad y'_3 = 1 $$\n\n你的任务是通过找出最小化 GCV 函数 $V(\\lambda)$ 的值，从以下候选值集合中确定最优正则化参数 $\\lambda$。\n\nA. $0.01$\n\nB. $0.1$\n\nC. $1$\n\nD. $10$",
            "solution": "我们已知 SVD 基下的 GCV 函数为：\n$$\nV(\\lambda) = N \\frac{\\sum_{i=1}^{N} \\left( \\frac{\\lambda^{2} y'_{i}}{\\sigma_{i}^{2} + \\lambda^{2}} \\right)^{2}}{\\left( \\sum_{i=1}^{N} \\frac{\\lambda^{2}}{\\sigma_{i}^{2} + \\lambda^{2}} \\right)^{2}},\n$$\n其中 $N=3$，奇异值为 $\\sigma_{1}=10$, $\\sigma_{2}=1$, $\\sigma_{3}= \\frac{1}{10}$，变换后的数据为 $y'_{1}=10$, $y'_{2}=2$, $y'_{3}=1$。\n\n对每个 $\\lambda$ 定义：\n$$\na_{i}(\\lambda) := \\frac{\\lambda^{2}}{\\sigma_{i}^{2}+\\lambda^{2}}, \\quad S(\\lambda) := \\sum_{i=1}^{3} y_{i}^{\\prime 2} a_{i}(\\lambda)^{2}, \\quad T(\\lambda) := \\left(\\sum_{i=1}^{3} a_{i}(\\lambda)\\right)^{2}.\n$$\n那么\n$$\nV(\\lambda) = 3 \\frac{S(\\lambda)}{T(\\lambda)}.\n$$\n我们对这些候选值计算 $V(\\lambda)$。\n\n情况 A：$\\lambda = \\frac{1}{100}$，因此 $\\lambda^{2}=\\frac{1}{10000}$ 且 $\\sigma_{1}^{2}=100$, $\\sigma_{2}^{2}=1$, $\\sigma_{3}^{2}=\\frac{1}{100}$。\n计算\n$$\na_{1}=\\frac{\\frac{1}{10000}}{100+\\frac{1}{10000}}=\\frac{1}{1000001}, \\quad\na_{2}=\\frac{\\frac{1}{10000}}{1+\\frac{1}{10000}}=\\frac{1}{10001}, \\quad\na_{3}=\\frac{\\frac{1}{10000}}{\\frac{1}{100}+\\frac{1}{10000}}=\\frac{1}{101}.\n$$\n因此\n$$\nS=\\frac{100}{(1000001)^{2}}+\\frac{4}{(10001)^{2}}+\\frac{1}{101^{2}}, \\quad\nT=\\left(\\frac{1}{1000001}+\\frac{1}{10001}+\\frac{1}{101}\\right)^{2}.\n$$\n数值上，\n$$\nS \\approx 9.8069366091 \\times 10^{-5}, \\quad T \\approx 1.00039604 \\times 10^{-4},\n$$\n所以\n$$\nV\\left(\\tfrac{1}{100}\\right) \\approx 3 \\times \\frac{9.8069 \\times 10^{-5}}{1.0004 \\times 10^{-4}} \\approx 2.941.\n$$\n\n情况 B：$\\lambda = \\frac{1}{10}$，因此 $\\lambda^{2}=\\frac{1}{100}$。\n计算\n$$\na_{1}=\\frac{\\frac{1}{100}}{100+\\frac{1}{100}}=\\frac{1}{10001}, \\quad\na_{2}=\\frac{\\frac{1}{100}}{1+\\frac{1}{100}}=\\frac{1}{101}, \\quad\na_{3}=\\frac{\\frac{1}{100}}{\\frac{1}{100}+\\frac{1}{100}}=\\frac{1}{2}.\n$$\n因此\n$$\nS=\\frac{100}{(10001)^{2}}+\\frac{4}{101^{2}}+\\frac{1}{4}, \\quad\nT=\\left(\\frac{1}{10001}+\\frac{1}{101}+\\frac{1}{2}\\right)^{2}.\n$$\n数值上，\n$$\nS \\approx 0.2503931169, \\quad T \\approx 0.2601020197,\n$$\n所以\n$$\nV\\left(\\tfrac{1}{10}\\right) \\approx 3 \\times \\frac{0.2503931169}{0.2601020197} \\approx 2.888.\n$$\n\n情况 C：$\\lambda = 1$，因此 $\\lambda^{2}=1$。\n计算\n$$\na_{1}=\\frac{1}{100+1}=\\frac{1}{101}, \\quad\na_{2}=\\frac{1}{1+1}=\\frac{1}{2}, \\quad\na_{3}=\\frac{1}{\\frac{1}{100}+1}=\\frac{100}{101}.\n$$\n那么\n$$\nS = 100\\left(\\frac{1}{101}\\right)^{2} + 4\\left(\\frac{1}{2}\\right)^{2} + 1\\left(\\frac{100}{101}\\right)^{2}\n= \\frac{100}{10201} + 1 + \\frac{10000}{10201}.\n$$\n合并分式项：\n$$\n\\frac{100}{10201} + \\frac{10000}{10201} = \\frac{10100}{10201} = 1 - \\frac{101}{10201} = 1 - \\frac{1}{101}.\n$$\n因此\n$$\nS = 1 + \\left(1 - \\frac{1}{101}\\right) = 2 - \\frac{1}{101} = \\frac{201}{101}.\n$$\n另外\n$$\n\\sum_{i=1}^{3} a_{i} = \\frac{1}{101} + \\frac{1}{2} + \\frac{100}{101} = 1 + \\frac{1}{2} = \\frac{3}{2},\n$$\n所以\n$$\nT = \\left(\\frac{3}{2}\\right)^{2} = \\frac{9}{4}.\n$$\n因此\n$$\nV(1) = 3 \\cdot \\frac{\\frac{201}{101}}{\\frac{9}{4}} = 3 \\cdot \\frac{201}{101} \\cdot \\frac{4}{9} = \\frac{268}{101} \\approx 2.653465.\n$$\n\n情况 D：$\\lambda = 10$，因此 $\\lambda^{2}=100$。\n计算\n$$\na_{1}=\\frac{100}{100+100}=\\frac{1}{2}, \\quad\na_{2}=\\frac{100}{1+100}=\\frac{100}{101}, \\quad\na_{3}=\\frac{100}{\\frac{1}{100}+100}=\\frac{10000}{10001}.\n$$\n因此\n$$\nS = 100\\left(\\frac{1}{2}\\right)^{2} + 4\\left(\\frac{100}{101}\\right)^{2} + 1\\left(\\frac{10000}{10001}\\right)^{2}\n= 25 + \\frac{40000}{10201} + \\frac{100000000}{100020001},\n$$\n并且\n$$\nT = \\left(\\frac{1}{2} + \\frac{100}{101} + \\frac{10000}{10001}\\right)^{2}.\n$$\n数值上，\n$$\nS \\approx 29.920976, \\quad T \\approx 6.2000,\n$$\n所以\n$$\nV(10) \\approx 3 \\times \\frac{29.920976}{6.2000} \\approx 14.5.\n$$\n\n比较这四个值，我们得到 $V\\left(\\tfrac{1}{100}\\right) \\approx 2.941$，$V\\left(\\tfrac{1}{10}\\right) \\approx 2.888$，$V(1) = \\frac{268}{101} \\approx 2.653$ 以及 $V(10) \\approx 14.5$。在 $\\lambda=1$ 处达到最小值。",
            "answer": "$$\\boxed{C}$$"
        }
    ]
}