{
    "hands_on_practices": [
        {
            "introduction": "理论学习之后，最好的巩固方式就是实践。本节将通过一系列精心设计的问题，帮助你将数值多重积分的理论应用于实际计算中。我们将从一个基本的三维积分问题开始，它将帮助你练习在一个简单的立方体区域上应用复合中点法则，这是掌握网格法的基础。",
            "id": "2191981",
            "problem": "一个标量场在三维区域中由函数 $f(x,y,z) = x^2 y \\exp(z)$ 定义。我们感兴趣的是该函数在由不等式 $0 \\le x \\le 1$、$0 \\le y \\le 1$ 和 $0 \\le z \\le 1$ 定义的立方体区域 $R$ 上的三重积分的值。\n\n使用复合中点法则来估计积分 $I = \\iiint_R f(x,y,z) \\,dV$ 的值。该估计应基于将区域 $R$ 划分为更小的相同立方体，其中沿 x 轴、y 轴和 z 轴分别有 2 个划分。\n\n将积分的估计值以单一的闭式解析表达式的形式给出。",
            "solution": "我们应用三维复合中点法则。将单位立方体 $R=[0,1]^{3}$ 划分为 $2 \\times 2 \\times 2$ 个相同的子立方体。步长分别为 $h_{x}=\\frac{1}{2}$，$h_{y}=\\frac{1}{2}$ 和 $h_{z}=\\frac{1}{2}$，因此每个子立方体的体积为 $\\Delta V=h_{x}h_{y}h_{z}=\\frac{1}{8}$。每个坐标轴上的中点为 $x^{*} \\in \\{\\frac{1}{4},\\frac{3}{4}\\}$，$y^{*} \\in \\{\\frac{1}{4},\\frac{3}{4}\\}$ 和 $z^{*} \\in \\{\\frac{1}{4},\\frac{3}{4}\\}$。\n\n复合中点法则给出\n$$\nI \\approx \\sum_{i=1}^{2}\\sum_{j=1}^{2}\\sum_{k=1}^{2} f\\!\\left(x_{i}^{*},y_{j}^{*},z_{k}^{*}\\right)\\,\\Delta V.\n$$\n由于 $f(x,y,z)=x^{2}y\\exp(z)$ 是可分离的，该和式可以分解因式：\n$$\n\\sum_{i,j,k} f\\!\\left(x_{i}^{*},y_{j}^{*},z_{k}^{*}\\right)\n=\\left(\\sum_{i=1}^{2} \\left(x_{i}^{*}\\right)^{2}\\right)\\left(\\sum_{j=1}^{2} y_{j}^{*}\\right)\\left(\\sum_{k=1}^{2} \\exp\\!\\left(z_{k}^{*}\\right)\\right).\n$$\n计算每个因子：\n$$\n\\sum_{i=1}^{2} \\left(x_{i}^{*}\\right)^{2}\n=\\left(\\frac{1}{4}\\right)^{2}+\\left(\\frac{3}{4}\\right)^{2}\n=\\frac{1}{16}+\\frac{9}{16}\n=\\frac{10}{16}\n=\\frac{5}{8},\n$$\n$$\n\\sum_{j=1}^{2} y_{j}^{*}\n=\\frac{1}{4}+\\frac{3}{4}\n=1,\n$$\n$$\n\\sum_{k=1}^{2} \\exp\\!\\left(z_{k}^{*}\\right)\n=\\exp\\!\\left(\\frac{1}{4}\\right)+\\exp\\!\\left(\\frac{3}{4}\\right).\n$$\n因此，\n$$\nI \\approx \\Delta V \\cdot \\frac{5}{8} \\cdot 1 \\cdot \\left(\\exp\\!\\left(\\frac{1}{4}\\right)+\\exp\\!\\left(\\frac{3}{4}\\right)\\right)\n=\\frac{1}{8}\\cdot \\frac{5}{8}\\left(\\exp\\!\\left(\\frac{1}{4}\\right)+\\exp\\!\\left(\\frac{3}{4}\\right)\\right)\n=\\frac{5}{64}\\left(\\exp\\!\\left(\\frac{1}{4}\\right)+\\exp\\!\\left(\\frac{3}{4}\\right)\\right).\n$$",
            "answer": "$$\\boxed{\\frac{5}{64}\\left(\\exp\\left(\\frac{1}{4}\\right)+\\exp\\left(\\frac{3}{4}\\right)\\right)}$$"
        },
        {
            "introduction": "现实世界中的许多问题涉及的积分区域并非简单的矩形或立方体。这个问题引入了一种强大而优雅的技术——变量替换。通过构建一个合适的仿射变换，你可以将一个不规则的平行四边形区域映射到一个标准的单位正方形上，从而将复杂的积分问题转化为可以在简单区域上解决的问题。这个练习将让你深入理解雅可比行列式在坐标变换中的关键作用。",
            "id": "2191987",
            "problem": "考虑函数 $f(x,y) = (x-y)^2$ 在 $xy$-平面内一个平行四边形区域 $R$ 上的积分。该平行四边形 $R$ 的顶点为点 $V_1 = (1, 2)$、$V_2 = (4, 3)$、$V_3 = (2, 6)$ 和 $V_4 = (5, 7)$。\n\n你的任务是近似计算二重积分 $I = \\iint_R f(x,y) \\,dA$。\n\n为此，首先确定一个仿射变换 $T(u,v) = (x(u,v), y(u,v))$，它将 $uv$-平面中的单位正方形 $S = [0,1] \\times [0,1]$ 的顶点 $(0,0), (1,0), (0,1), (1,1)$ 分别映射到平行四边形 $R$ 的顶点 $V_1, V_2, V_3, V_4$。然后，使用此变换将积分变量从 $(x,y)$ 更改为 $(u,v)$。\n\n最后，使用基于 $2 \\times 2$ 均匀子正方形网格的复合中点法则，来近似计算在单位正方形 $S$ 上的积分。\n\n计算此近似的数值。将你的最终答案四舍五入到四位有效数字。",
            "solution": "问题要求对积分 $I = \\iint_R (x-y)^2 \\,dA$ 进行数值近似，其中 $R$ 是一个顶点为 $V_1=(1,2)$、$V_2=(4,3)$、$V_3=(2,6)$ 和 $V_4=(5,7)$ 的平行四边形。近似计算需要将积分变换到单位正方形 $S = [0,1] \\times [0,1]$ 上，然后在一个 $2 \\times 2$ 的网格上应用复合中点法则。\n\n首先，我们求出将 $uv$-平面中的单位正方形 $S$ 映射到 $xy$-平面中的平行四边形 $R$ 的仿射变换 $T(u,v) = (x(u,v), y(u,v))$。仿射变换具有以下一般形式：\n$x(u,v) = x_0 + au + cv$\n$y(u,v) = y_0 + bu + dv$\n\n我们使用给定的顶点映射关系：\n1.  $T(0,0) = (1,2)$:\n    $x(0,0) = x_0 = 1$\n    $y(0,0) = y_0 = 2$\n2.  $T(1,0) = (4,3)$:\n    $x(1,0) = x_0 + a(1) + c(0) = 1 + a = 4 \\implies a = 3$\n    $y(1,0) = y_0 + b(1) + d(0) = 2 + b = 3 \\implies b = 1$\n3.  $T(0,1) = (2,6)$:\n    $x(0,1) = x_0 + a(0) + c(1) = 1 + c = 2 \\implies c = 1$\n    $y(0,1) = y_0 + b(0) + d(1) = 2 + d = 6 \\implies d = 4$\n\n因此，仿射变换为：\n$x(u,v) = 1 + 3u + v$\n$y(u,v) = 2 + u + 4v$\n\n我们可以用第四个顶点进行验证：$T(1,1) = (1+3+1, 2+1+4) = (5,7)$，这是正确的。\n\n接下来，我们应用二重积分的变量替换公式：\n$I = \\iint_R f(x,y) \\,dx\\,dy = \\iint_S f(x(u,v), y(u,v)) \\left| \\det(J) \\right| \\,du\\,dv$\n其中 $J$ 是变换 $T$ 的雅可比矩阵。\n$$J = \\begin{pmatrix} \\frac{\\partial x}{\\partial u} & \\frac{\\partial x}{\\partial v} \\\\ \\frac{\\partial y}{\\partial u} & \\frac{\\partial y}{\\partial v} \\end{pmatrix} = \\begin{pmatrix} 3 & 1 \\\\ 1 & 4 \\end{pmatrix}$$\n雅可比矩阵的行列式为 $\\det(J) = (3)(4) - (1)(1) = 12 - 1 = 11$。\n其绝对值为 $|\\det(J)| = 11$。由于这是一个常数，平行四边形的面积是单位正方形面积的11倍。\n\n现在，我们变换被积函数 $f(x,y) = (x-y)^2$：\n$x - y = (1 + 3u + v) - (2 + u + 4v) = -1 + 2u - 3v$\n所以，$f(x(u,v), y(u,v)) = (-1 + 2u - 3v)^2$。\n\n积分变为：\n$I = \\int_0^1 \\int_0^1 (-1 + 2u - 3v)^2 \\cdot 11 \\,du\\,dv$\n令新的被积函数为 $g(u,v) = 11(-1 + 2u - 3v)^2$。\n\n我们要在一个 $2 \\times 2$ 的网格上使用复合中点法则来近似这个积分。单位正方形 $S$ 被划分为四个子正方形，每个子正方形的面积为 $\\Delta A = 0.5 \\times 0.5 = 0.25$。这些子正方形的中点是：\n$(u_1, v_1) = (0.25, 0.25)$\n$(u_2, v_2) = (0.75, 0.25)$\n$(u_3, v_3) = (0.25, 0.75)$\n$(u_4, v_4) = (0.75, 0.75)$\n\n积分的近似值由下式给出：\n$I \\approx \\sum_{i=1}^{4} g(u_i,v_i) \\Delta A = 0.25 \\left[ g(0.25, 0.25) + g(0.75, 0.25) + g(0.25, 0.75) + g(0.75, 0.75) \\right]$\n\n我们在每个中点处计算 $g(u,v)$ 的值：\n1.  $g(0.25, 0.25) = 11(-1 + 2(0.25) - 3(0.25))^2 = 11(-1 + 0.5 - 0.75)^2 = 11(-1.25)^2 = 11(1.5625) = 17.1875$\n2.  $g(0.75, 0.25) = 11(-1 + 2(0.75) - 3(0.25))^2 = 11(-1 + 1.5 - 0.75)^2 = 11(-0.25)^2 = 11(0.0625) = 0.6875$\n3.  $g(0.25, 0.75) = 11(-1 + 2(0.25) - 3(0.75))^2 = 11(-1 + 0.5 - 2.25)^2 = 11(-2.75)^2 = 11(7.5625) = 83.1875$\n4.  $g(0.75, 0.75) = 11(-1 + 2(0.75) - 3(0.75))^2 = 11(-1 + 1.5 - 2.25)^2 = 11(-1.75)^2 = 11(3.0625) = 33.6875$\n\n现在，我们将这些值相加并乘以 $\\Delta A$：\n$I \\approx 0.25 (17.1875 + 0.6875 + 83.1875 + 33.6875) = 0.25 (134.75) = 33.6875$\n\n最后，我们将结果四舍五入到四位有效数字。\n$I \\approx 33.69$。",
            "answer": "$$\\boxed{33.69}$$"
        },
        {
            "introduction": "除了变量替换，处理非矩形区域的另一个重要策略是采用嵌套求积的方法，特别是当内层积分的积分限是外层积分变量的函数时。这个问题将指导你使用嵌套的梯形法则来处理一个典型的变限二重积分。这种将一个二维问题分解为一系列一维问题来求解的思路，是计算科学中一种非常实用和常见的模式。",
            "id": "2191953",
            "problem": "在计算科学中，一个常见的任务是计算定积分，而其被积函数本身也是由一个积分定义的。考虑以下二重积分：\n$$I = \\int_{0}^{1} \\left( \\int_{0}^{x} \\exp(y^{2}) \\,dy \\right) \\,dx$$\n该积分无法使用初等解析方法求解。你的任务是找到 $I$ 的一个数值近似值。\n\n为此，你将采用复合梯形法则的嵌套应用。用于在 $n$ 个子区间上近似积分 $\\int_a^b f(z) \\,dz$ 的复合梯形法则由下式给出：\n$$ \\int_a^b f(z) \\,dz \\approx \\frac{h}{2} [f(z_0) + 2f(z_1) + \\dots + 2f(z_{n-1}) + f(z_n)] $$\n其中 $h = (b-a)/n$ 且 $z_k = a + k h$，$k=0, 1, \\dots, n$。\n\n令内层积分为 $F(x) = \\int_{0}^{x} \\exp(y^{2}) \\,dy$。首先，使用复合梯形法则和 $n_x = 4$ 个子区间来近似外层积分 $I = \\int_0^1 F(x) \\,dx$。外层积分节点上所需的 $F(x)$ 值本身也必须通过近似计算得到。对于每个所需的 $F(x_k)$ 值，你必须通过对内层积分应用复合梯形法则（使用 $n_y = 4$ 个子区间）来近似它。\n\n使用此过程计算积分 $I$ 的数值。将你的最终答案四舍五入到四位有效数字。",
            "solution": "问题要求使用嵌套梯形法则方法对二重积分 $I = \\int_{0}^{1} \\left( \\int_{0}^{x} \\exp(y^{2}) \\,dy \\right) \\,dx$ 进行数值计算。\n\n令 $F(x) = \\int_{0}^{x} \\exp(y^{2}) \\,dy$ 且 $g(y) = \\exp(y^2)$。总积分为 $I = \\int_0^1 F(x) \\,dx$。\n\n**第一步：建立外层积分的近似。**\n我们使用复合梯形法则（$n_x=4$）来近似 $I = \\int_0^1 F(x) \\,dx$。\n步长为 $h_x = (1-0)/4 = 0.25$。\n节点为 $x_0 = 0$, $x_1 = 0.25$, $x_2 = 0.5$, $x_3 = 0.75$, 和 $x_4 = 1$。\n外层积分的梯形法则是：\n$$ I \\approx \\frac{h_x}{2} [F(x_0) + 2F(x_1) + 2F(x_2) + 2F(x_3) + F(x_4)] $$\n$$ I \\approx \\frac{0.25}{2} [F(0) + 2F(0.25) + 2F(0.5) + 2F(0.75) + F(1)] $$\n\n**第二步：使用内层积分近似法计算每个节点上的 $F(x)$。**\n对于每个 $x_k$，我们必须使用梯形法则（$n_y=4$）计算 $F(x_k) = \\int_{0}^{x_k} g(y) \\,dy = \\int_{0}^{x_k} \\exp(y^2) \\,dy$。\n\n*   **对于 $x_0 = 0$：**\n    $F(0) = \\int_0^0 \\exp(y^2) \\,dy = 0$。这是一个精确值。\n\n*   **对于 $x_1 = 0.25$：**\n    我们近似计算 $F(0.25) = \\int_0^{0.25} \\exp(y^2) \\,dy$。\n    步长为 $h_y = (0.25-0)/4 = 0.0625$。\n    节点为 $y_0=0$, $y_1=0.0625$, $y_2=0.125$, $y_3=0.1875$, $y_4=0.25$。\n    函数值为：\n    $g(0) = \\exp(0) = 1$\n    $g(0.0625) = \\exp(0.0625^2) \\approx 1.003914$\n    $g(0.125) = \\exp(0.125^2) \\approx 1.015753$\n    $g(0.1875) = \\exp(0.1875^2) \\approx 1.035783$\n    $g(0.25) = \\exp(0.25^2) \\approx 1.064494$\n    $F(0.25) \\approx \\frac{0.0625}{2} [1 + 2(1.003914) + 2(1.015753) + 2(1.035783) + 1.064494]$\n    $F(0.25) \\approx 0.03125 [1 + 2.007828 + 2.031506 + 2.071566 + 1.064494] = 0.03125 [8.175394] \\approx 0.255481$\n\n*   **对于 $x_2 = 0.5$：**\n    我们近似计算 $F(0.5) = \\int_0^{0.5} \\exp(y^2) \\,dy$。\n    步长为 $h_y = (0.5-0)/4 = 0.125$。\n    节点为 $y_0=0$, $y_1=0.125$, $y_2=0.25$, $y_3=0.375$, $y_4=0.5$。\n    函数值为：\n    $g(0) = 1$\n    $g(0.125) \\approx 1.015753$\n    $g(0.25) \\approx 1.064494$\n    $g(0.375) = \\exp(0.375^2) \\approx 1.150993$\n    $g(0.5) = \\exp(0.5^2) \\approx 1.284025$\n    $F(0.5) \\approx \\frac{0.125}{2} [1 + 2(1.015753) + 2(1.064494) + 2(1.150993) + 1.284025]$\n    $F(0.5) \\approx 0.0625 [1 + 2.031506 + 2.128988 + 2.301986 + 1.284025] = 0.0625 [8.746505] \\approx 0.546657$\n\n*   **对于 $x_3 = 0.75$：**\n    我们近似计算 $F(0.75) = \\int_0^{0.75} \\exp(y^2) \\,dy$。\n    步长为 $h_y = (0.75-0)/4 = 0.1875$。\n    节点为 $y_0=0$, $y_1=0.1875$, $y_2=0.375$, $y_3=0.5625$, $y_4=0.75$。\n    函数值为：\n    $g(0) = 1$\n    $g(0.1875) \\approx 1.035783$\n    $g(0.375) \\approx 1.150993$\n    $g(0.5625) = \\exp(0.5625^2) \\approx 1.372190$\n    $g(0.75) = \\exp(0.75^2) \\approx 1.755055$\n    $F(0.75) \\approx \\frac{0.1875}{2} [1 + 2(1.035783) + 2(1.150993) + 2(1.372190) + 1.755055]$\n    $F(0.75) \\approx 0.09375 [1 + 2.071566 + 2.301986 + 2.744380 + 1.755055] = 0.09375 [9.872987] \\approx 0.925593$\n\n*   **对于 $x_4 = 1$：**\n    我们近似计算 $F(1) = \\int_0^1 \\exp(y^2) \\,dy$。\n    步长为 $h_y = (1-0)/4 = 0.25$。\n    节点为 $y_0=0$, $y_1=0.25$, $y_2=0.5$, $y_3=0.75$, $y_4=1$。\n    函数值为：\n    $g(0) = 1$\n    $g(0.25) \\approx 1.064494$\n    $g(0.5) \\approx 1.284025$\n    $g(0.75) \\approx 1.755055$\n    $g(1) = \\exp(1^2) = e \\approx 2.718282$\n    $F(1) \\approx \\frac{0.25}{2} [1 + 2(1.064494) + 2(1.284025) + 2(1.755055) + 2.718282]$\n    $F(1) \\approx 0.125 [1 + 2.128988 + 2.568050 + 3.510110 + 2.718282] = 0.125 [11.92543] \\approx 1.490679$\n\n**第三步：合并结果以求得 I 的最终值。**\n现在将近似的 $F(x_k)$ 值代回外层积分的公式中：\n$$ I \\approx \\frac{0.25}{2} [F(0) + 2F(0.25) + 2F(0.5) + 2F(0.75) + F(1)] $$\n$$ I \\approx 0.125 [0 + 2(0.255481) + 2(0.546657) + 2(0.925593) + 1.490679] $$\n$$ I \\approx 0.125 [0 + 0.510962 + 1.093314 + 1.851186 + 1.490679] $$\n$$ I \\approx 0.125 [4.946141] $$\n$$ I \\approx 0.618267625 $$\n\n**第四步：对最终答案进行四舍五入。**\n问题要求将答案四舍五入到四位有效数字。\n$I \\approx 0.6183$。",
            "answer": "$$\\boxed{0.6183}$$"
        }
    ]
}