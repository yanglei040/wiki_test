{
    "hands_on_practices": [
        {
            "introduction": "To truly grasp how an adaptive quadrature algorithm works, there is no substitute for tracing its steps by hand. This exercise walks you through the core decision-making process of a simple adaptive method based on the trapezoidal rule. By manually calculating the approximations and applying the error criterion, you will see firsthand how the algorithm decides whether to accept a result or to refine the interval for greater accuracy .",
            "id": "2153105",
            "problem": "An adaptive quadrature algorithm refines its calculation mesh to meet a desired error tolerance. Consider the following recursive algorithm designed to approximate the definite integral $I = \\int_a^b f(x) \\,dx$.\n\n**Adaptive Integration Algorithm:**\nThe function `AdaptiveIntegrate(f, a, b, ε)` takes a function $f$, an interval $[a, b]$, and a tolerance $\\epsilon$ as input.\n\n1.  Calculate $S_1$, the approximation from the trapezoidal rule using a single interval of width $h_1 = b-a$. The formula is $S_1 = \\frac{h_1}{2}(f(a) + f(b))$.\n2.  Let $c = (a+b)/2$ be the midpoint of the interval. Calculate $S_2$, the approximation from the composite trapezoidal rule using two subintervals $[a, c]$ and $[c, b]$, each of width $h_2 = (b-a)/2$. The formula is $S_2 = \\frac{h_2}{2}(f(a) + f(c)) + \\frac{h_2}{2}(f(c) + f(b))$.\n3.  An estimate for the error in the more accurate approximation $S_2$ is based on the difference between the two approximations. The stopping criterion is $|S_2 - S_1| < 3\\epsilon$.\n4.  If the criterion is met, the procedure for this interval terminates and returns the value of $S_2$.\n5.  If the criterion is not met, the algorithm refines the interval. It recursively calls itself on the two subintervals, halving the tolerance for each. The result for the interval $[a, b]$ is the sum of the results from these two calls:\n    `AdaptiveIntegrate(f, a, c, ε/2) + AdaptiveIntegrate(f, c, b, ε/2)`\n\nYour task is to manually trace this algorithm to find the numerical approximation of the integral\n$$ I = \\int_0^4 x^2 \\,dx $$\nwith an initial tolerance of $\\epsilon = 2$.\n\nCalculate the final numerical approximation for the integral returned by the algorithm. Provide your answer as an exact integer or fraction.",
            "solution": "We apply the given adaptive trapezoidal algorithm to $f(x)=x^{2}$ on $[0,4]$ with initial tolerance $\\epsilon=2$. The trapezoidal approximation on $[a,b]$ with one panel is $S_{1}=\\frac{h_{1}}{2}\\left(f(a)+f(b)\\right)$ where $h_{1}=b-a$, and with two panels is\n$$\nS_{2}=\\frac{h_{2}}{2}\\left(f(a)+f(c)\\right)+\\frac{h_{2}}{2}\\left(f(c)+f(b)\\right),\n$$\nwhere $c=\\frac{a+b}{2}$ and $h_{2}=\\frac{b-a}{2}$. The stopping criterion for an interval is $\\left|S_{2}-S_{1}\\right|<3\\epsilon$. If not met, we recurse on $[a,c]$ and $[c,b]$ with tolerance $\\epsilon/2$ each and sum the returned values.\n\nTop-level interval $[0,4]$ with $\\epsilon=2$:\n- Compute $h_{1}=4$, $S_{1}=\\frac{4}{2}\\left(f(0)+f(4)\\right)=2\\left(0+16\\right)=32$.\n- Midpoint $c=2$, $h_{2}=2$, and\n$$\nS_{2}=\\frac{2}{2}\\left(f(0)+f(2)\\right)+\\frac{2}{2}\\left(f(2)+f(4)\\right)=1\\left(0+4\\right)+1\\left(4+16\\right)=4+20=24.\n$$\n- Error check: $\\left|S_{2}-S_{1}\\right|=\\left|24-32\\right|=8$, while $3\\epsilon=3\\cdot 2=6$. Since $8\\not<6$, we recurse on $[0,2]$ and $[2,4]$ with tolerance $\\epsilon/2=1$ each.\n\nSubinterval $[0,2]$ with $\\epsilon=1$:\n- Compute $h_{1}=2$, $S_{1}=\\frac{2}{2}\\left(f(0)+f(2)\\right)=1\\left(0+4\\right)=4$.\n- Midpoint $c=1$, $h_{2}=1$, and\n$$\nS_{2}=\\frac{1}{2}\\left(f(0)+f(1)\\right)+\\frac{1}{2}\\left(f(1)+f(2)\\right)=\\frac{1}{2}\\left(0+1\\right)+\\frac{1}{2}\\left(1+4\\right)=\\frac{1}{2}+\\frac{5}{2}=3.\n$$\n- Error check: $\\left|S_{2}-S_{1}\\right|=\\left|3-4\\right|=1$, while $3\\epsilon=3\\cdot 1=3$. Since $1<3$, accept $S_{2}=3$ for $[0,2]$.\n\nSubinterval $[2,4]$ with $\\epsilon=1$:\n- Compute $h_{1}=2$, $S_{1}=\\frac{2}{2}\\left(f(2)+f(4)\\right)=1\\left(4+16\\right)=20$.\n- Midpoint $c=3$, $h_{2}=1$, and\n$$\nS_{2}=\\frac{1}{2}\\left(f(2)+f(3)\\right)+\\frac{1}{2}\\left(f(3)+f(4)\\right)=\\frac{1}{2}\\left(4+9\\right)+\\frac{1}{2}\\left(9+16\\right)=\\frac{13}{2}+\\frac{25}{2}=19.\n$$\n- Error check: $\\left|S_{2}-S_{1}\\right|=\\left|19-20\\right|=1$, while $3\\epsilon=3$. Since $1<3$, accept $S_{2}=19$ for $[2,4]$.\n\nFinally, the top-level call returns the sum of the accepted subinterval results:\n$$\n\\text{Result} = 3+19=22.\n$$\nThis is the final numerical approximation returned by the algorithm.",
            "answer": "$$\\boxed{22}$$"
        },
        {
            "introduction": "A key advantage of adaptive quadrature is its efficiency, which stems from intelligently reusing previous work. When an interval is subdivided, the algorithm does not restart its calculations from scratch. This problem asks you to analyze the refinement step for an adaptive Simpson's rule to determine exactly how many *new* function evaluations are needed, revealing the computational savings built into the method's design .",
            "id": "2153098",
            "problem": "In numerical analysis, adaptive quadrature methods are algorithms for computing definite integrals numerically to a desired precision. These methods are more efficient than non-adaptive methods because they concentrate computational effort on the parts of the domain where the integrand is most difficult to approximate.\n\nConsider an adaptive scheme based on Simpson's rule. For a function $f(x)$ over an interval $[a, b]$, the basic Simpson's rule approximation, which we will call the coarse approximation $S_1$, is given by:\n$$S_1 = \\frac{b-a}{6} \\left[ f(a) + 4f\\left(\\frac{a+b}{2}\\right) + f(b) \\right]$$\nThis calculation requires evaluating the function at three points: the endpoints $a$ and $b$, and the midpoint $c = \\frac{a+b}{2}$.\n\nThe core of an adaptive strategy involves a refinement step. If the initial approximation is not accurate enough, the interval $[a, b]$ is divided into two subintervals of equal length, $[a, c]$ and $[c, b]$. Simpson's rule is then applied to each of these subintervals, and the results are summed to get a new, more refined approximation, $S_2$. The approximation for the left subinterval $[a, c]$ is $S_L$, and for the right subinterval $[c, b]$ is $S_R$, such that $S_2 = S_L + S_R$.\n\nAn essential aspect of this method's efficiency is reusing previous computations. Assuming the values $f(a)$, $f(c)$, and $f(b)$ have already been computed and stored for the initial coarse approximation $S_1$, how many *additional* function evaluations are necessary to compute the refined approximation $S_2$?\n\nA. 1\n\nB. 2\n\nC. 3\n\nD. 4\n\nE. 5",
            "solution": "We begin with the coarse Simpson approximation over $[a,b]$:\n$$S_{1}=\\frac{b-a}{6}\\left[f(a)+4f\\left(c\\right)+f(b)\\right],\\quad c=\\frac{a+b}{2}.$$\nBy assumption, the function values $f(a)$, $f(c)$, and $f(b)$ have already been computed.\n\nFor the refinement, we split $[a,b]$ at $c$ into $[a,c]$ and $[c,b]$. Applying Simpson’s rule on $[a,c]$ requires the values at $a$, $c$, and the midpoint of $[a,c]$, which is\n$$m_{L}=\\frac{a+c}{2}.$$\nThus,\n$$S_{L}=\\frac{c-a}{6}\\left[f(a)+4f\\left(m_{L}\\right)+f(c)\\right].$$\nSimilarly, applying Simpson’s rule on $[c,b]$ requires the values at $c$, $b$, and the midpoint of $[c,b]$, which is\n$$m_{R}=\\frac{c+b}{2}.$$\nThus,\n$$S_{R}=\\frac{b-c}{6}\\left[f(c)+4f\\left(m_{R}\\right)+f(b)\\right].$$\nThe refined approximation is $S_{2}=S_{L}+S_{R}$.\n\nThe set of function values needed to compute $S_{2}$ is $\\{f(a),f(c),f(b),f(m_{L}),f(m_{R})\\}$. Since $f(a)$, $f(c)$, and $f(b)$ are already known, the only additional evaluations are at the two new midpoints $m_{L}$ and $m_{R}$. Therefore, exactly $2$ additional function evaluations are required.",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "While powerful, adaptive algorithms are not infallible; they rely on an error estimate that can sometimes be misleading. This exercise challenges you to think critically about the algorithm's limitations by finding a function that \"tricks\" the error estimation mechanism based on Simpson's rule. By understanding how an algorithm can fail, you gain a deeper appreciation for its underlying assumptions and learn to use it more wisely .",
            "id": "2153040",
            "problem": "An adaptive quadrature algorithm is designed to numerically approximate the definite integral $I = \\int_a^b f(x)\\,dx$ for a continuous function $f(x)$ up to a desired tolerance $\\epsilon > 0$. The algorithm, based on Simpson's rule, operates as follows on any given interval $[u, v]$:\n\n1.  Calculate a coarse approximation using Simpson's rule over the entire interval:\n    $$S_1 = \\frac{v-u}{6}\\left(f(u) + 4f\\left(\\frac{u+v}{2}\\right) + f(v)\\right)$$\n2.  Calculate a more refined approximation by summing the Simpson's rule results from the two half-intervals, $[u, w]$ and $[w, v]$, where $w = (u+v)/2$:\n    $$S_2 = \\frac{w-u}{6}\\left(f(u) + 4f\\left(\\frac{u+w}{2}\\right) + f(w)\\right) + \\frac{v-w}{6}\\left(f(w) + 4f\\left(\\frac{w+v}{2}\\right) + f(v)\\right)$$\n3.  Estimate the error of the refined approximation $S_2$ using the formula:\n    $$E = \\frac{1}{15}|S_2 - S_1|$$\n4.  If the estimated error $E$ is less than the tolerance allocated for the interval $[u,v]$, the algorithm terminates for this interval and returns $S_2$ as its value. Otherwise, the algorithm is applied recursively to the sub-intervals $[u, w]$ and $[w, v]$, each with half of the previous tolerance.\n\nConsider the task of evaluating the integral of a function over the interval $[-1, 1]$. Which of the following continuous functions would cause this algorithm to terminate on its very first check (i.e., without any recursion) and return an incorrect value of 0? Assume the initial tolerance $\\epsilon$ is any small positive number.\n\nA. $f(x) = 3x^2 - 1$\n\nB. $f(x) = \\sin(\\pi x)$\n\nC. $f(x) = \\cos\\left(\\frac{\\pi}{2} x\\right)$\n\nD. $f(x) = 16x^6 - 20x^4 + x^2 + 1$\n\nE. $f(x) = x^5 - x^3 + x$",
            "solution": "For the algorithm to terminate on its very first check for any small positive tolerance $\\epsilon$, the estimated error must be exactly zero on the initial interval. With $[u,v]=[-1,1]$ and $w=0$, the two Simpson approximations are\n$$\nS_{1}=\\frac{1}{3}\\left(f(-1)+4f(0)+f(1)\\right),\n$$\n$$\nS_{2}=\\frac{1}{6}\\left(f(-1)+4f\\left(-\\frac{1}{2}\\right)+f(0)\\right)+\\frac{1}{6}\\left(f(0)+4f\\left(\\frac{1}{2}\\right)+f(1)\\right)\n=\\frac{1}{6}\\left(f(-1)+f(1)+2f(0)+4f\\left(-\\frac{1}{2}\\right)+4f\\left(\\frac{1}{2}\\right)\\right).\n$$\nThe error estimate is\n$$\nE=\\frac{1}{15}|S_{2}-S_{1}|.\n$$\nTo terminate for any $\\epsilon>0$, we need $E=0$, i.e., $S_{2}=S_{1}$. For the algorithm to return the incorrect value $0$, we must also have $S_{2}=0$ while the true integral $\\int_{-1}^{1}f(x)\\,dx\\neq 0$.\n\nEvaluate $S_{1}$ and $S_{2}$ for each option:\n\nA. $f(x)=3x^{2}-1$. Compute $f(-1)=2$, $f(0)=-1$, $f(1)=2$, and $f\\left(\\pm\\frac{1}{2}\\right)=3\\cdot\\frac{1}{4}-1=-\\frac{1}{4}$. Then\n$$\nS_{1}=\\frac{1}{3}(2+4(-1)+2)=0,\\quad\nS_{2}=\\frac{1}{6}\\left(2+2+2(-1)+4\\left(-\\frac{1}{4}\\right)+4\\left(-\\frac{1}{4}\\right)\\right)=0.\n$$\nMoreover, $\\int_{-1}^{1}(3x^{2}-1)\\,dx=\\left[x^{3}-x\\right]_{-1}^{1}=0$, so returning $0$ would be correct, not incorrect.\n\nB. $f(x)=\\sin(\\pi x)$. Compute $f(-1)=0$, $f(0)=0$, $f(1)=0$, $f\\left(-\\frac{1}{2}\\right)=-1$, $f\\left(\\frac{1}{2}\\right)=1$. Then\n$$\nS_{1}=0,\\quad S_{2}=\\frac{1}{6}\\left(0+0+0+4(-1)+4(1)\\right)=0,\n$$\nand $\\int_{-1}^{1}\\sin(\\pi x)\\,dx=0$ (odd integrand), so returning $0$ is correct.\n\nC. $f(x)=\\cos\\left(\\frac{\\pi}{2}x\\right)$. Compute $f(-1)=0$, $f(0)=1$, $f(1)=0$, $f\\left(\\pm\\frac{1}{2}\\right)=\\cos\\left(\\pm\\frac{\\pi}{4}\\right)=\\frac{\\sqrt{2}}{2}$. Then\n$$\nS_{1}=\\frac{1}{3}(0+4\\cdot 1+0)=\\frac{4}{3},\\quad\nS_{2}=\\frac{1}{6}\\left(0+0+2\\cdot 1+4\\cdot\\frac{\\sqrt{2}}{2}+4\\cdot\\frac{\\sqrt{2}}{2}\\right)=\\frac{1}{6}\\left(2+4\\sqrt{2}\\right)=\\frac{1}{3}\\left(1+2\\sqrt{2}\\right)\\neq 0,\n$$\nso the algorithm would not return $0$.\n\nD. $f(x)=16x^{6}-20x^{4}+x^{2}+1$. Compute $f(-1)=-2$, $f(0)=1$, $f(1)=-2$, and $f\\left(\\pm\\frac{1}{2}\\right)=16\\left(\\frac{1}{64}\\right)-20\\left(\\frac{1}{16}\\right)+\\frac{1}{4}+1=\\frac{1}{4}$. Then\n$$\nS_{1}=\\frac{1}{3}(-2+4\\cdot 1-2)=0,\\quad\nS_{2}=\\frac{1}{6}\\left(-2-2+2\\cdot 1+4\\cdot\\frac{1}{4}+4\\cdot\\frac{1}{4}\\right)=\\frac{1}{6}(-4+2+1+1)=0.\n$$\nThus $E=0$ and the algorithm terminates immediately, returning $0$. The true integral is\n$$\n\\int_{-1}^{1}\\left(16x^{6}-20x^{4}+x^{2}+1\\right)dx\n=2\\int_{0}^{1}\\left(16x^{6}-20x^{4}+x^{2}+1\\right)dx\n=2\\left(\\frac{16}{7}-4+\\frac{1}{3}+1\\right)\n=2\\left(\\frac{16}{7}-\\frac{8}{3}\\right)\n=-\\frac{16}{21}\\neq 0,\n$$\nso the returned value $0$ is incorrect.\n\nE. $f(x)=x^{5}-x^{3}+x$ is odd, so $S_{1}=0$, $S_{2}=0$ (by symmetry of nodes and weights), and $\\int_{-1}^{1}f(x)\\,dx=0$, hence returning $0$ is correct.\n\nOnly option D meets the requirement: immediate termination with $E=0$, returning $0$, while the true integral is nonzero.",
            "answer": "$$\\boxed{D}$$"
        }
    ]
}