{
    "hands_on_practices": [
        {
            "introduction": "我们将通过一个基础练习开启我们的实践之旅。这个问题要求你将前向有限差分法应用于一个熟悉的场景：将极坐标转换为笛卡尔坐标。这个练习将巩固你对如何为一个给定的向量函数逐个元素地构建雅可比矩阵近似的理解。",
            "id": "2171159",
            "problem": "一个二维向量函数 $F: \\mathbb{R}^2 \\rightarrow \\mathbb{R}^2$ 表示从极坐标系 $(r, \\theta)$ 到笛卡尔坐标系 $(x, y)$ 的变换。该函数定义为：\n$$\nF(r, \\theta) = \\begin{pmatrix} x(r, \\theta) \\\\ y(r, \\theta) \\end{pmatrix} = \\begin{pmatrix} r\\cos\\theta \\\\ r\\sin\\theta \\end{pmatrix}\n$$\n你的任务是使用前向有限差分法对每个偏导数进行计算，从而求出 $F$ 在通用点 $(r, \\theta)$ 处的雅可比矩阵的近似值。令 $h$ 表示在有限差分计算中使用的小的正步长。角度 $\\theta$ 以弧度为单位。\n\n请以 2x2 矩阵的形式给出你的答案，其元素用 $r$、$\\theta$ 和 $h$ 表示。",
            "solution": "给定 $F(r,\\theta)=(x(r,\\theta),y(r,\\theta))$，其中 $x(r,\\theta)=r\\cos\\theta$ 且 $y(r,\\theta)=r\\sin\\theta$。雅可比矩阵为\n$$\nJ_{F}(r,\\theta)=\\begin{pmatrix}\n\\frac{\\partial x}{\\partial r}  & \\frac{\\partial x}{\\partial \\theta} \\\\\n\\frac{\\partial y}{\\partial r}  & \\frac{\\partial y}{\\partial \\theta}\n\\end{pmatrix}.\n$$\n对于标量函数 $g(r,\\theta)$，使用前向有限差分近似，\n$$\n\\frac{\\partial g}{\\partial r}(r,\\theta)\\approx \\frac{g(r+h,\\theta)-g(r,\\theta)}{h},\\qquad\n\\frac{\\partial g}{\\partial \\theta}(r,\\theta)\\approx \\frac{g(r,\\theta+h)-g(r,\\theta)}{h},\n$$\n我们计算每个元素。\n\n对于 $x(r,\\theta)=r\\cos\\theta$：\n$$\n\\frac{\\partial x}{\\partial r}(r,\\theta)\\approx \\frac{(r+h)\\cos\\theta-r\\cos\\theta}{h}=\\cos\\theta,\n$$\n$$\n\\frac{\\partial x}{\\partial \\theta}(r,\\theta)\\approx \\frac{r\\cos(\\theta+h)-r\\cos\\theta}{h}\n=\\frac{r\\left(\\cos(\\theta+h)-\\cos\\theta\\right)}{h}.\n$$\n\n对于 $y(r,\\theta)=r\\sin\\theta$：\n$$\n\\frac{\\partial y}{\\partial r}(r,\\theta)\\approx \\frac{(r+h)\\sin\\theta-r\\sin\\theta}{h}=\\sin\\theta,\n$$\n$$\n\\frac{\\partial y}{\\partial \\theta}(r,\\theta)\\approx \\frac{r\\sin(\\theta+h)-r\\sin\\theta}{h}\n=\\frac{r\\left(\\sin(\\theta+h)-\\sin\\theta\\right)}{h}.\n$$\n\n因此，雅可比矩阵在 $(r,\\theta)$ 处的前向有限差分近似为\n$$\n\\begin{pmatrix}\n\\cos\\theta  & \\frac{r\\left(\\cos(\\theta+h)-\\cos\\theta\\right)}{h} \\\\\n\\sin\\theta  & \\frac{r\\left(\\sin(\\theta+h)-\\sin\\theta\\right)}{h}\n\\end{pmatrix}.\n$$",
            "answer": "$$\\boxed{\\begin{pmatrix}\n\\cos\\theta  & \\frac{r\\left(\\cos(\\theta+h)-\\cos\\theta\\right)}{h} \\\\\n\\sin\\theta  & \\frac{r\\left(\\sin(\\theta+h)-\\sin\\theta\\right)}{h}\n\\end{pmatrix}}$$"
        },
        {
            "introduction": "当应用于具有尖锐特征的函数时，数值方法常常会暴露出其微妙之处。本练习通过比较一个包含不可微部分（绝对值函数）的函数的前向和后向差分近似来探讨这一点。通过解决这个问题，你将深入了解有限差分格式的选择如何显著影响结果，尤其是在非光滑点附近。",
            "id": "2171184",
            "problem": "在数值优化中，向量值函数的雅可比矩阵通常使用有限差分来近似，特别是在解析导数难以计算时。考虑向量值函数 $F: \\mathbb{R}^2 \\to \\mathbb{R}^2$ 定义为：\n$$\nF(\\mathbf{x}) = F(x, y) = \\begin{pmatrix} f_1(x, y) \\\\ f_2(x, y) \\end{pmatrix} = \\begin{pmatrix} \\sqrt{x^2 + 1} \\\\ |y| \\end{pmatrix}\n$$\n我们想要近似该函数在点 $\\mathbf{x}_0 = (0, 0)$ 处的雅可比矩阵。\n\n前向差分雅可比矩阵近似 $J_F$ 的第 $(i,j)$ 个元素由下式给出：\n$$\n[J_F]_{ij} = \\frac{f_i(\\mathbf{x}_0 + h \\mathbf{e}_j) - f_i(\\mathbf{x}_0)}{h}\n$$\n后向差分雅可比矩阵近似 $J_B$ 的第 $(i,j)$ 个元素由下式给出：\n$$\n[J_B]_{ij} = \\frac{f_i(\\mathbf{x}_0) - f_i(\\mathbf{x}_0 - h \\mathbf{e}_j)}{h}\n$$\n此处，$h$ 是一个小的正标量，$\\mathbf{e}_1 = (1, 0)$ 和 $\\mathbf{e}_2 = (0, 1)$ 是 $\\mathbb{R}^2$ 中的标准基向量。\n\n下列哪一对正确表示了函数 $F$ 在 $\\mathbf{x}_0 = (0,0)$ 处的前向差分雅可比矩阵 ($J_F$) 和后向差分雅可比矩阵 ($J_B$)？\n\nA. $J_F = \\begin{pmatrix} 0  & 0 \\\\ 0  & 1 \\end{pmatrix}, \\quad J_B = \\begin{pmatrix} 0  & 0 \\\\ 0  & -1 \\end{pmatrix}$\n\nB. $J_F = \\begin{pmatrix} \\frac{\\sqrt{h^2+1}-1}{h}  & 0 \\\\ 0  & 1 \\end{pmatrix}, \\quad J_B = \\begin{pmatrix} -\\frac{\\sqrt{h^2+1}-1}{h}  & 0 \\\\ 0  & -1 \\end{pmatrix}$\n\nC. $J_F = \\begin{pmatrix} \\frac{\\sqrt{h^2+1}-1}{h}  & 0 \\\\ 0  & -1 \\end{pmatrix}, \\quad J_B = \\begin{pmatrix} -\\frac{\\sqrt{h^2+1}-1}{h}  & 0 \\\\ 0  & 1 \\end{pmatrix}$\n\nD. $J_F = \\begin{pmatrix} 0  & \\frac{\\sqrt{h^2+1}-1}{h} \\\\ 1  & 0 \\end{pmatrix}, \\quad J_B = \\begin{pmatrix} 0  & -\\frac{\\sqrt{h^2+1}-1}{h} \\\\ -1  & 0 \\end{pmatrix}$\n\nE. $J_F = \\begin{pmatrix} \\frac{\\sqrt{h^2+1}}{h}  & 0 \\\\ 0  & 1 \\end{pmatrix}, \\quad J_B = \\begin{pmatrix} -\\frac{\\sqrt{h^2+1}}{h}  & 0 \\\\ 0  & -1 \\end{pmatrix}$",
            "solution": "我们在点 $\\mathbf{x}_{0}=(0,0)$ 处，使用步长 $h>0$ 和标准基向量 $\\mathbf{e}_{1}=(1,0)$ 及 $\\mathbf{e}_{2}=(0,1)$，按分量形式应用前向和后向差分定义：\n$$\n[J_{F}]_{ij}=\\frac{f_{i}(\\mathbf{x}_{0}+h\\mathbf{e}_{j})-f_{i}(\\mathbf{x}_{0})}{h},\\qquad\n[J_{B}]_{ij}=\\frac{f_{i}(\\mathbf{x}_{0})-f_{i}(\\mathbf{x}_{0}-h\\mathbf{e}_{j})}{h}.\n$$\n函数为 $F(x,y)=\\begin{pmatrix}\\sqrt{x^{2}+1}\\\\ |y|\\end{pmatrix}$，所以 $f_{1}(x,y)=\\sqrt{x^{2}+1}$ 仅依赖于 $x$，而 $f_{2}(x,y)=|y|$ 仅依赖于 $y$。计算所需的值：\n- 在基准点：$f_{1}(0,0)=\\sqrt{0+1}=1$, $f_{2}(0,0)=|0|=0$。\n- 沿 $+\\mathbf{e}_{1}$ 方向：$f_{1}(h,0)=\\sqrt{h^{2}+1}$, $f_{2}(h,0)=|0|=0$。\n- 沿 $+\\mathbf{e}_{2}$ 方向：$f_{1}(0,h)=\\sqrt{0+1}=1$, $f_{2}(0,h)=|h|=h$。\n- 沿 $-\\mathbf{e}_{1}$ 方向：$f_{1}(-h,0)=\\sqrt{(-h)^{2}+1}=\\sqrt{h^{2}+1}$, $f_{2}(-h,0)=|0|=0$。\n- 沿 $-\\mathbf{e}_{2}$ 方向：$f_{1}(0,-h)=\\sqrt{0+1}=1$, $f_{2}(0,-h)=|-h|=h$。\n\n计算前向差分的元素：\n$$\n[J_{F}]_{11}=\\frac{\\sqrt{h^{2}+1}-1}{h},\\quad [J_{F}]_{12}=\\frac{1-1}{h}=0,\n$$\n$$\n[J_{F}]_{21}=\\frac{0-0}{h}=0,\\quad [J_{F}]_{22}=\\frac{h-0}{h}=1.\n$$\n因此\n$$\nJ_{F}=\\begin{pmatrix}\n\\frac{\\sqrt{h^{2}+1}-1}{h}  & 0\\\\\n0  & 1\n\\end{pmatrix}.\n$$\n\n计算后向差分的元素：\n$$\n[J_{B}]_{11}=\\frac{1-\\sqrt{h^{2}+1}}{h}=-\\frac{\\sqrt{h^{2}+1}-1}{h},\\quad [J_{B}]_{12}=\\frac{1-1}{h}=0,\n$$\n$$\n[J_{B}]_{21}=\\frac{0-0}{h}=0,\\quad [J_{B}]_{22}=\\frac{0-h}{h}=-1.\n$$\n因此\n$$\nJ_{B}=\\begin{pmatrix}\n-\\frac{\\sqrt{h^{2}+1}-1}{h}  & 0\\\\\n0  & -1\n\\end{pmatrix}.\n$$\n\n与选项比较，这对应于选项 B。",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "除了简单地计算近似值，理解其精度也至关重要。这个问题将引导你从计算转向分析，研究中心差分法的收敛速度。通过分析近似误差如何随着步长 $h$ 的减小而变化，你将揭示这种常用方法的二阶精度（$O(h^2)$），这是使其在实践中非常强大的一个关键理论性质。",
            "id": "2171195",
            "problem": "在一个新型二自由度执行器的简化模型中，输出状态向量与输入控制向量 $(q_1, q_2)$ 之间的关系由函数 $F: \\mathbb{R}^2 \\to \\mathbb{R}^2$ 描述，定义如下：\n$$ F(q_1, q_2) = \\begin{pmatrix} F_1(q_1, q_2) \\\\ F_2(q_1, q_2) \\end{pmatrix} = \\begin{pmatrix} \\exp(q_1 + q_2) \\\\ \\cos(q_1 - q_2) \\end{pmatrix} $$\n该系统的控制依赖于其雅可比矩阵 $J(q_1, q_2)$，其元素为 $J_{ij} = \\frac{\\partial F_i}{\\partial q_j}$。\n\n在实际应用中，雅可比矩阵通过数值方法进行近似。雅可比矩阵的中心差分近似（记为 $J_h(q_1, q_2)$）是通过使用以下公式来近似每个偏导数而构建的：\n$$ \\frac{\\partial F_i}{\\partial q_j} \\approx \\frac{F_i(\\mathbf{q} + h\\mathbf{e}_j) - F_i(\\mathbf{q} - h\\mathbf{e}_j)}{2h} $$\n其中 $\\mathbf{q} = (q_1, q_2)$ 是求值点，$h$ 是一个很小的步长，$\\mathbf{e}_j$ 是第 $j$ 个标准基向量（例如，$\\mathbf{e}_1 = (1, 0)$）。\n\n该近似的精度由误差矩阵 $E_h = J(q_1, q_2) - J_h(q_1, q_2)$ 来衡量。该误差的大小使用弗罗贝尼乌斯范数进行量化，对于一个通用的 $m \\times n$ 矩阵 $A$，其定义为 $\\|A\\|_F = \\sqrt{\\sum_{i=1}^m \\sum_{j=1}^n |A_{ij}|^2}$。令 $\\mathcal{E}(h) = \\|E_h\\|_F$ 表示给定步长 $h$ 时的误差。\n\n为了理解该方法的收敛行为，我们分析当步长减小时误差如何变化。计算当步长减半时近似误差的理论比率。具体来说，对于雅可比矩阵良定义且非零的任何状态 $(q_1, q_2)$，计算以下极限的值：\n$$ R = \\lim_{h \\to 0} \\frac{\\mathcal{E}(h)}{\\mathcal{E}(h/2)} $$\n请将最终答案表示为精确的整数或分数。",
            "solution": "给定函数 $F(q_{1},q_{2}) = \\begin{pmatrix} \\exp(q_{1}+q_{2}) \\\\ \\cos(q_{1}-q_{2}) \\end{pmatrix}$ 及其雅可比矩阵 $J(q_{1},q_{2})$，其元素为 $J_{ij} = \\partial_{q_{j}} F_{i}$。$\\partial_{q_{j}} F_{i}$ 在点 $\\mathbf{q}=(q_{1},q_{2})$ 处、步长为 $h$ 的中心差分近似为\n$$\n\\frac{F_{i}(\\mathbf{q}+h\\mathbf{e}_{j}) - F_{i}(\\mathbf{q}-h\\mathbf{e}_{j})}{2h}.\n$$\n固定 $i$ 和 $j$，考虑单变量函数 $\\varphi(t) = F_{i}(\\mathbf{q} + t \\mathbf{e}_{j})$。在 $t=0$ 处进行泰勒展开可得\n$$\nF_{i}(\\mathbf{q} + h \\mathbf{e}_{j}) = F_{i}(\\mathbf{q}) + h\\,\\partial_{q_{j}} F_{i}(\\mathbf{q}) + \\frac{h^{2}}{2}\\,\\partial_{q_{j}q_{j}} F_{i}(\\mathbf{q}) + \\frac{h^{3}}{6}\\,\\partial_{q_{j}q_{j}q_{j}} F_{i}(\\mathbf{q}) + O(h^{4}),\n$$\n$$\nF_{i}(\\mathbf{q} - h \\mathbf{e}_{j}) = F_{i}(\\mathbf{q}) - h\\,\\partial_{q_{j}} F_{i}(\\mathbf{q}) + \\frac{h^{2}}{2}\\,\\partial_{q_{j}q_{j}} F_{i}(\\mathbf{q}) - \\frac{h^{3}}{6}\\,\\partial_{q_{j}q_{j}q_{j}} F_{i}(\\mathbf{q}) + O(h^{4}).\n$$\n两式相减再除以 $2h$ 得到带有截断误差的中心差分公式\n$$\n\\frac{F_{i}(\\mathbf{q}+h\\mathbf{e}_{j}) - F_{i}(\\mathbf{q}-h\\mathbf{e}_{j})}{2h} = \\partial_{q_{j}} F_{i}(\\mathbf{q}) + \\frac{h^{2}}{6}\\,\\partial_{q_{j}q_{j}q_{j}} F_{i}(\\mathbf{q}) + O(h^{4}).\n$$\n因此，雅可比矩阵的每个元素的误差为\n$$\nE_{ij}(h) = J_{ij} - (J_{h})_{ij} = -\\frac{h^{2}}{6}\\,\\partial_{q_{j}q_{j}q_{j}} F_{i}(\\mathbf{q}) + O(h^{4}).\n$$\n以矩阵形式表示，存在一个常数矩阵 $A$，其元素为 $A_{ij} = -\\tfrac{1}{6}\\,\\partial_{q_{j}q_{j}q_{j}} F_{i}(\\mathbf{q})$，使得\n$$\nE_{h} = h^{2} A + O(h^{4}).\n$$\n因此，根据弗罗贝尼乌斯范数的齐次性和连续性，\n$$\n\\mathcal{E}(h) = \\|E_{h}\\|_{F} = \\|h^{2}A + O(h^{4})\\|_{F} = h^{2}\\|A\\|_{F} + O(h^{4}).\n$$\n对于给定的函数 $F$，沿坐标轴方向的三阶偏导数为\n$$\n\\partial_{q_{1}q_{1}q_{1}} F_{1} = \\exp(q_{1}+q_{2}), \\quad \\partial_{q_{2}q_{2}q_{2}} F_{1} = \\exp(q_{1}+q_{2}),\n$$\n$$\n\\partial_{q_{1}q_{1}q_{1}} F_{2} = \\sin(q_{1}-q_{2}), \\quad \\partial_{q_{2}q_{2}q_{2}} F_{2} = -\\sin(q_{1}-q_{2}).\n$$\n因此，由于 $\\exp(q_{1}+q_{2}) \\neq 0$，对于所有的 $(q_{1},q_{2})$ 矩阵 $A$ 都是非零的，这保证了 $\\|A\\|_{F} > 0$，并确立了主阶行为 $\\mathcal{E}(h) = C h^{2} + O(h^{4})$，其中 $C = \\|A\\|_{F} > 0$。\n\n现在计算当 $h \\to 0$ 时的比率：\n$$\n\\frac{\\mathcal{E}(h)}{\\mathcal{E}(h/2)} = \\frac{h^{2}\\|A\\|_{F} + O(h^{4})}{(h/2)^{2}\\|A\\|_{F} + O(h^{4})} = \\frac{h^{2}\\|A\\|_{F}\\left(1 + O(h^{2})\\right)}{\\tfrac{h^{2}}{4}\\|A\\|_{F}\\left(1 + O(h^{2})\\right)} \\to 4 \\quad \\text{as } h \\to 0.\n$$\n因此，理论比率 $R=4$，这反映了中心差分雅可比近似方法关于 $h$ 的二阶精度。",
            "answer": "$$\\boxed{4}$$"
        }
    ]
}