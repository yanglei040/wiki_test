{
    "hands_on_practices": [
        {
            "introduction": "The journey into the GMRES method begins with a single, crucial calculation: the initial residual. This vector, defined as $r_0 = b - A x_0$, measures how far our initial guess $x_0$ is from satisfying the system $A x = b$. This exercise  provides hands-on practice in computing this foundational quantity, which serves as the starting point for building the Krylov subspace.",
            "id": "2214791",
            "problem": "The Generalized Minimal Residual (GMRES) method is a popular iterative algorithm for solving large, sparse, non-symmetric linear systems of equations of the form $Ax=b$. A crucial first step in the algorithm is to compute the initial residual based on an initial guess for the solution vector $x$.\n\nConsider the linear system $Ax=b$ where the matrix $A$ and the vector $b$ are given by:\n$$\nA = \\begin{pmatrix} 4  -1 \\\\ 5  2 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 10 \\\\ 3 \\end{pmatrix}\n$$\nSuppose we start the GMRES algorithm with an initial guess $x_0$ given by:\n$$\nx_0 = \\begin{pmatrix} 1 \\\\ -2 \\end{pmatrix}\n$$\nCalculate the initial residual vector, $r_0$. Express your answer as a row matrix with two components.",
            "solution": "In GMRES, the initial residual is defined as the difference between the right-hand side vector and the product of the matrix with the initial guess:\n$$\nr_{0} = b - A x_{0}.\n$$\nGiven\n$$\nA = \\begin{pmatrix} 4  -1 \\\\ 5  2 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 10 \\\\ 3 \\end{pmatrix}, \\quad x_{0} = \\begin{pmatrix} 1 \\\\ -2 \\end{pmatrix},\n$$\nfirst compute the matrix-vector product $A x_{0}$:\n$$\nA x_{0} = \\begin{pmatrix} 4  -1 \\\\ 5  2 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ -2 \\end{pmatrix}\n= \\begin{pmatrix} 4 \\cdot 1 + (-1) \\cdot (-2) \\\\ 5 \\cdot 1 + 2 \\cdot (-2) \\end{pmatrix}\n= \\begin{pmatrix} 6 \\\\ 1 \\end{pmatrix}.\n$$\nThen compute the residual:\n$$\nr_{0} = b - A x_{0} = \\begin{pmatrix} 10 \\\\ 3 \\end{pmatrix} - \\begin{pmatrix} 6 \\\\ 1 \\end{pmatrix}\n= \\begin{pmatrix} 4 \\\\ 2 \\end{pmatrix}.\n$$\nExpressed as a row matrix with two components, this is\n$$\n\\begin{pmatrix} 4  2 \\end{pmatrix}.\n$$",
            "answer": "$$\\boxed{\\begin{pmatrix} 4  2 \\end{pmatrix}}$$"
        },
        {
            "introduction": "Having established the initial residual, the next logical step is to perform one full iteration of the GMRES algorithm. This practice  walks you through finding the new approximate solution $x_1$ by minimizing the residual's norm over the first Krylov subspace. This process reveals the fundamental principle of GMRES: finding the optimal solution within an expanding search space, one dimension at a time.",
            "id": "2214790",
            "problem": "The Generalized Minimum Residual (GMRES) method is an iterative algorithm used to find an approximate solution to a system of linear equations $Ax=b$. Consider the linear system defined by the matrix $A$ and the vector $b$:\n$$\nA = \\begin{pmatrix} 2  1 \\\\ -1  3 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}\n$$\nStarting with an initial guess of $x_0 = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$, apply one step of the GMRES algorithm to find the first approximate solution, $x_1$. Express your answer as a column vector with rational components.",
            "solution": "GMRES minimizes the 2-norm of the residual over the affine space $x_{0}+\\mathcal{K}_{1}(A,r_{0})$, where $r_{0}=b-Ax_{0}$ and $\\mathcal{K}_{1}(A,r_{0})=\\mathrm{span}\\{r_{0}\\}$. With $x_{0}=\\begin{pmatrix}0\\\\0\\end{pmatrix}$ we have\n$$\nr_{0}=b=\\begin{pmatrix}1\\\\2\\end{pmatrix}.\n$$\nAfter one GMRES step, $x_{1}$ has the form $x_{1}=x_{0}+\\alpha r_{0}$, where $\\alpha$ is chosen to minimize\n$$\n\\|b-A(x_{0}+\\alpha r_{0})\\|_{2}=\\|r_{0}-\\alpha A r_{0}\\|_{2}.\n$$\nLet $w=A r_{0}$. Then the minimization problem is $\\min_{\\alpha}\\|r_{0}-\\alpha w\\|_{2}^{2}$. Using the Euclidean inner product, define\n$$\n\\phi(\\alpha)=(r_{0}-\\alpha w)^{T}(r_{0}-\\alpha w)=r_{0}^{T}r_{0}-2\\alpha w^{T}r_{0}+\\alpha^{2}w^{T}w.\n$$\nSetting $\\frac{d\\phi}{d\\alpha}=0$ gives\n$$\n-2\\,w^{T}r_{0}+2\\alpha\\,w^{T}w=0 \\quad\\Rightarrow\\quad \\alpha=\\frac{w^{T}r_{0}}{w^{T}w}.\n$$\nCompute $w$ and the needed inner products:\n$$\nw=A r_{0}=A b=\\begin{pmatrix}2  1\\\\ -1  3\\end{pmatrix}\\begin{pmatrix}1\\\\2\\end{pmatrix}=\\begin{pmatrix}4\\\\5\\end{pmatrix},\\quad\nw^{T}r_{0}=\\begin{pmatrix}4  5\\end{pmatrix}\\begin{pmatrix}1\\\\2\\end{pmatrix}=14,\\quad\nw^{T}w=4^{2}+5^{2}=41.\n$$\nTherefore\n$$\n\\alpha=\\frac{14}{41},\\qquad x_{1}=x_{0}+\\alpha r_{0}=\\frac{14}{41}\\begin{pmatrix}1\\\\2\\end{pmatrix}=\\begin{pmatrix}\\frac{14}{41}\\\\ \\frac{28}{41}\\end{pmatrix}.\n$$\nThis $x_{1}$ is the GMRES(1) iterate, i.e., the minimizer over $x_{0}+\\mathrm{span}\\{r_{0}\\}$ of the residual norm.",
            "answer": "$$\\boxed{\\begin{pmatrix}\\frac{14}{41}\\\\ \\frac{28}{41}\\end{pmatrix}}$$"
        },
        {
            "introduction": "The GMRES method is guaranteed to minimize the norm of the residual at each step, but does this also guarantee that our approximation gets closer to the true solution? This exercise  explores this critical question through a fascinating hypothetical scenario. By analyzing a system with a non-normal matrix, you will uncover the important distinction between minimizing the residual and minimizing the true error, a key insight into the behavior of GMRES.",
            "id": "2398705",
            "problem": "Consider the linear system $A x = b$ with the $2 \\times 2$ matrix\n$$\nA = \\begin{pmatrix}\n1  10 \\\\\n0  1\n\\end{pmatrix},\n$$\nthe right-hand side $b = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}$, and the initial guess $x_{0} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$. Let $\\|\\cdot\\|$ denote the Euclidean norm. The residual for any $x$ is $r(x) = b - A x$. The Generalized Minimal Residual (GMRES) method defines the first iterate $x_{1}$ as the unique vector in the affine space $x_{0} + \\mathcal{K}_{1}(A, r_{0})$, where $r_{0} = r(x_{0})$, that minimizes $\\|r(x)\\|$.\n\nCompute the ratio\n$$\n\\frac{\\|x - x_{1}\\|}{\\|x - x_{0}\\|},\n$$\nwhere $x$ is the exact solution of $A x = b$, using the Euclidean norm. Round your answer to four significant figures.",
            "solution": "The objective is to compute the ratio $\\frac{\\|x - x_{1}\\|}{\\|x - x_{0}\\|}$, where $x$ is the exact solution of the linear system $A x = b$, $x_{0}$ is the given initial guess, and $x_{1}$ is the first iterate generated by the GMRES method. The norm is the Euclidean norm.\n\nFirst, we determine the exact solution $x$. The linear system is given by:\n$$\nA x = b \\implies \\begin{pmatrix} 1  10 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} x_a \\\\ x_b \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n$$\nUsing back substitution, the second row gives $0 \\cdot x_a + 1 \\cdot x_b = 1$, which implies $x_b = 1$.\nSubstituting $x_b=1$ into the first row gives $1 \\cdot x_a + 10 \\cdot (1) = 1$, which yields $x_a = 1 - 10 = -9$.\nThus, the exact solution is $x = \\begin{pmatrix} -9 \\\\ 1 \\end{pmatrix}$.\n\nNext, we calculate the initial residual, $r_0$. The initial guess is $x_0 = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$.\nThe residual is defined as $r(x) = b - A x$. The initial residual $r_0$ is:\n$$\nr_0 = r(x_0) = b - A x_0 = b - A \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} = b = \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n$$\nThe first GMRES iterate, $x_1$, is defined as the vector in the affine space $x_0 + \\mathcal{K}_1(A, r_0)$ that minimizes the norm of the residual $\\|r(x)\\|$. The first Krylov subspace, $\\mathcal{K}_1(A, r_0)$, is the space spanned by the initial residual vector, $\\mathcal{K}_1(A, r_0) = \\text{span}\\{r_0\\}$.\nTherefore, $x_1$ can be expressed as:\n$$\nx_1 = x_0 + \\alpha r_0 = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} + \\alpha \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\alpha \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix}\n$$\nfor some scalar $\\alpha \\in \\mathbb{R}$.\n\nTo find the optimal $\\alpha$, we must minimize the norm of the corresponding residual, $r(x_1) = b - A x_1$.\nSubstituting the expression for $x_1$ and using $b=r_0$, we get:\n$$\nr(x_1) = b - A (\\alpha r_0) = r_0 - \\alpha (A r_0)\n$$\nWe need to find $\\alpha$ that minimizes the squared Euclidean norm $\\|r_0 - \\alpha A r_0\\|^2$. This is a standard linear least-squares problem, whose solution is the orthogonal projection of $r_0$ onto $A r_0$. The coefficient $\\alpha$ is given by:\n$$\n\\alpha = \\frac{\\langle r_0, A r_0 \\rangle}{\\|A r_0\\|^2}\n$$\nWe compute the vector $A r_0$:\n$$\nA r_0 = \\begin{pmatrix} 1  10 \\\\ 0  1 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 1 \\cdot 1 + 10 \\cdot 1 \\\\ 0 \\cdot 1 + 1 \\cdot 1 \\end{pmatrix} = \\begin{pmatrix} 11 \\\\ 1 \\end{pmatrix}\n$$\nNow, we compute the inner product and the squared norm:\n$$\n\\langle r_0, A r_0 \\rangle = (1)(11) + (1)(1) = 12\n$$\n$$\n\\|A r_0\\|^2 = 11^2 + 1^2 = 121 + 1 = 122\n$$\nSubstituting these values, we find $\\alpha$:\n$$\n\\alpha = \\frac{12}{122} = \\frac{6}{61}\n$$\nWith this value of $\\alpha$, the first GMRES iterate is:\n$$\nx_1 = \\frac{6}{61} r_0 = \\frac{6}{61} \\begin{pmatrix} 1 \\\\ 1 \\end{pmatrix} = \\begin{pmatrix} 6/61 \\\\ 6/61 \\end{pmatrix}\n$$\nNow we compute the error vectors $e_0 = x - x_0$ and $e_1 = x - x_1$, and their norms.\nThe initial error is:\n$$\ne_0 = x - x_0 = \\begin{pmatrix} -9 \\\\ 1 \\end{pmatrix} - \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -9 \\\\ 1 \\end{pmatrix}\n$$\nThe norm of the initial error is:\n$$\n\\|e_0\\| = \\|x - x_0\\| = \\sqrt{(-9)^2 + 1^2} = \\sqrt{81 + 1} = \\sqrt{82}\n$$\nThe error after the first iteration is:\n$$\ne_1 = x - x_1 = \\begin{pmatrix} -9 \\\\ 1 \\end{pmatrix} - \\begin{pmatrix} 6/61 \\\\ 6/61 \\end{pmatrix} = \\begin{pmatrix} -9 - \\frac{6}{61} \\\\ 1 - \\frac{6}{61} \\end{pmatrix} = \\begin{pmatrix} -\\frac{549+6}{61} \\\\ \\frac{61-6}{61} \\end{pmatrix} = \\begin{pmatrix} -555/61 \\\\ 55/61 \\end{pmatrix}\n$$\nThe norm of this error vector is:\n$$\n\\|e_1\\| = \\|x - x_1\\| = \\sqrt{\\left(-\\frac{555}{61}\\right)^2 + \\left(\\frac{55}{61}\\right)^2} = \\frac{1}{61}\\sqrt{(-555)^2 + 55^2} = \\frac{1}{61}\\sqrt{308025 + 3025} = \\frac{\\sqrt{311050}}{61}\n$$\nFinally, we compute the required ratio:\n$$\n\\frac{\\|x - x_1\\|}{\\|x - x_0\\|} = \\frac{\\sqrt{311050}/61}{\\sqrt{82}} = \\sqrt{\\frac{311050}{61^2 \\cdot 82}} = \\sqrt{\\frac{311050}{3721 \\cdot 82}} = \\sqrt{\\frac{311050}{305122}}\n$$\nWe now evaluate this expression numerically:\n$$\n\\frac{\\|x - x_1\\|}{\\|x - x_0\\|} \\approx \\sqrt{1.0194280} \\approx 1.00966727\n$$\nThe problem asks for the answer to be rounded to four significant figures. Rounding $1.00966727$ gives $1.010$. The fact that the error norm increases is a known phenomenon for GMRES when applied to highly non-normal matrices, such as the one given in this problem. While the residual norm is guaranteed to be monotonically non-increasing, the error norm is not.",
            "answer": "$$\\boxed{1.010}$$"
        }
    ]
}