{
    "hands_on_practices": [
        {
            "introduction": "要真正理解 QR 算法，最好的方法就是亲手执行一次迭代。这个练习  将引导你对一个简单的 $2 \\times 2$ 对称矩阵进行一个完整的无位移 QR 迭代步骤。通过这个过程，你将掌握 QR 分解（例如，通过 Gram-Schmidt 方法）和逆序相乘这两个核心操作，为后续更复杂的应用打下坚实的基础。",
            "id": "2219215",
            "problem": "无位移QR算法是一种用于计算矩阵特征值的迭代数值方法。该过程始于一个矩阵 $A_0 = A$。在每次迭代 $k$（从 $k=0$ 开始）中，矩阵 $A_k$ 被分解为乘积 $A_k = Q_k R_k$，其中 $Q_k$ 是一个正交矩阵，$R_k$ 是一个上三角矩阵。下一次迭代的矩阵则计算为 $A_{k+1} = R_k Q_k$。\n\n考虑由下式给出的初始实对称矩阵 $A_0$：\n$$A_0 = \\begin{pmatrix} 5 & 2 \\\\ 2 & 2 \\end{pmatrix}$$\n执行一次完整的无位移QR算法迭代，求出矩阵 $A_1$。你的最终答案应该是矩阵 $A_1$，其元素以精确分数形式表示。",
            "solution": "我们对 $A_{0}=\\begin{pmatrix} 5 & 2 \\\\ 2 & 2 \\end{pmatrix}$ 应用一步无位移QR算法。\n第一步是计算QR分解 $A_{0}=Q_{0}R_{0}$。我们将使用Gram-Schmidt方法，并将$A_0$的列向量表示为 $a_{1}=\\begin{pmatrix} 5 \\\\ 2 \\end{pmatrix}$ 和 $a_{2}=\\begin{pmatrix} 2 \\\\ 2 \\end{pmatrix}$。\n1.  计算第一列：\n    $r_{11} = \\|a_1\\|_2 = \\sqrt{5^2 + 2^2} = \\sqrt{29}$\n    $q_1 = \\frac{a_1}{r_{11}} = \\frac{1}{\\sqrt{29}}\\begin{pmatrix} 5 \\\\ 2 \\end{pmatrix}$\n2.  计算第二列：\n    $r_{12} = q_1^T a_2 = \\frac{1}{\\sqrt{29}}(5 \\cdot 2 + 2 \\cdot 2) = \\frac{14}{\\sqrt{29}}$\n    $u_2 = a_2 - r_{12}q_1 = \\begin{pmatrix} 2 \\\\ 2 \\end{pmatrix} - \\frac{14}{\\sqrt{29}} \\frac{1}{\\sqrt{29}}\\begin{pmatrix} 5 \\\\ 2 \\end{pmatrix} = \\begin{pmatrix} 2 - \\frac{70}{29} \\\\ 2 - \\frac{28}{29} \\end{pmatrix} = \\begin{pmatrix} -\\frac{12}{29} \\\\ \\frac{30}{29} \\end{pmatrix}$\n    $r_{22} = \\|u_2\\|_2 = \\sqrt{(-\\frac{12}{29})^2 + (\\frac{30}{29})^2} = \\frac{1}{29}\\sqrt{144 + 900} = \\frac{\\sqrt{1044}}{29} = \\frac{\\sqrt{36 \\cdot 29}}{29} = \\frac{6\\sqrt{29}}{29} = \\frac{6}{\\sqrt{29}}$\n    $q_2 = \\frac{u_2}{r_{22}} = \\frac{1}{6/\\sqrt{29}}\\begin{pmatrix} -12/29 \\\\ 30/29 \\end{pmatrix} = \\frac{\\sqrt{29}}{6 \\cdot 29}\\begin{pmatrix} -12 \\\\ 30 \\end{pmatrix} = \\frac{1}{\\sqrt{29}}\\begin{pmatrix} -2 \\\\ 5 \\end{pmatrix}$\n\n因此，QR分解为：\n$$ Q_0 = \\frac{1}{\\sqrt{29}}\\begin{pmatrix} 5 & -2 \\\\ 2 & 5 \\end{pmatrix}, \\quad R_0 = \\begin{pmatrix} \\sqrt{29} & \\frac{14}{\\sqrt{29}} \\\\ 0 & \\frac{6}{\\sqrt{29}} \\end{pmatrix} $$\n第二步是计算下一个迭代矩阵 $A_1 = R_0 Q_0$：\n$$\n\\begin{align*}\nA_1 &= R_0 Q_0 = \\begin{pmatrix} \\sqrt{29} & \\frac{14}{\\sqrt{29}} \\\\ 0 & \\frac{6}{\\sqrt{29}} \\end{pmatrix} \\frac{1}{\\sqrt{29}}\\begin{pmatrix} 5 & -2 \\\\ 2 & 5 \\end{pmatrix} \\\\\n&= \\frac{1}{29} \\begin{pmatrix} 29 & 14 \\\\ 0 & 6 \\end{pmatrix} \\begin{pmatrix} 5 & -2 \\\\ 2 & 5 \\end{pmatrix} \\\\\n&= \\frac{1}{29} \\begin{pmatrix} 29 \\cdot 5 + 14 \\cdot 2 & 29 \\cdot (-2) + 14 \\cdot 5 \\\\ 0 \\cdot 5 + 6 \\cdot 2 & 0 \\cdot (-2) + 6 \\cdot 5 \\end{pmatrix} \\\\\n&= \\frac{1}{29} \\begin{pmatrix} 145 + 28 & -58 + 70 \\\\ 12 & 30 \\end{pmatrix} \\\\\n&= \\frac{1}{29} \\begin{pmatrix} 173 & 12 \\\\ 12 & 30 \\end{pmatrix}\n\\end{align*}\n$$\n于是，\n$$ A_1 = \\begin{pmatrix} \\frac{173}{29} & \\frac{12}{29} \\\\ \\frac{12}{29} & \\frac{30}{29} \\end{pmatrix} $$",
            "answer": "$$\\boxed{\\begin{pmatrix}\\frac{173}{29} & \\frac{12}{29} \\\\ \\frac{12}{29} & \\frac{30}{29}\\end{pmatrix}}$$"
        },
        {
            "introduction": "QR 算法的目标是将矩阵变换为上三角形式，其对角线上的元素即为特征值。那么，如果算法一开始就作用于一个已经是理想形式（对角矩阵）的矩阵会发生什么呢？通过这个练习 ，我们将发现对角矩阵是该算法迭代过程中的一个“不动点”，从而加深对算法收敛目标的理解。",
            "id": "2219204",
            "problem": "基本QR算法是一种用于近似计算矩阵特征值的迭代方法。对于给定的方阵 $A_k$，算法的一次迭代包含两个步骤：\n\n1.  对矩阵进行QR分解，将其表示为乘积 $A_k = Q_k R_k$，其中 $Q_k$ 是一个正交矩阵，而 $R_k$ 是一个上三角矩阵。\n2.  通过颠倒乘法顺序计算序列中的下一个矩阵：$A_{k+1} = R_k Q_k$。\n\n考虑初始矩阵 $A_0 = \\begin{pmatrix} 3 & 0 \\\\ 0 & -1 \\end{pmatrix}$。\n\n将基本QR算法对 $A_0$ 应用一次完整迭代后得到的矩阵 $A_1$ 是什么？\n\nA) $\\begin{pmatrix} 3 & 0 \\\\ 0 & 1 \\end{pmatrix}$\n\nB) $\\begin{pmatrix} 1 & 0 \\\\ 0 & -1 \\end{pmatrix}$\n\nC) $\\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix}$\n\nD) $\\begin{pmatrix} -1 & 0 \\\\ 0 & 3 \\end{pmatrix}$\n\nE) $\\begin{pmatrix} 3 & 0 \\\\ 0 & -1 \\end{pmatrix}$",
            "solution": "我们对给定矩阵 $A_{0} = \\begin{pmatrix} 3 & 0 \\\\ 0 & -1 \\end{pmatrix}$ 应用一次基本QR算法的迭代。\n\n第一步是计算QR分解 $A_{0} = Q_{0} R_{0}$。对于对角矩阵，其QR分解并不唯一。然而，一个常见的约定是要求上三角矩阵 $R_0$ 的对角线元素为正。为了满足此条件，我们可以将 $A_0$ 的负对角线元素-1的符号吸收到正交矩阵 $Q_0$ 中。\n令\n$$\nQ_{0} = \\begin{pmatrix} 1 & 0 \\\\ 0 & -1 \\end{pmatrix}, \\quad R_{0} = \\begin{pmatrix} 3 & 0 \\\\ 0 & 1 \\end{pmatrix}\n$$\n我们可以验证这个分解是正确的：\n$Q_0$ 是正交的，因为 $Q_0^T Q_0 = \\begin{pmatrix} 1 & 0 \\\\ 0 & -1 \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\\\ 0 & -1 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ 0 & 1 \\end{pmatrix} = I$。\n$R_0$ 是上三角矩阵且对角线元素为正。\n$Q_0 R_0 = \\begin{pmatrix} 1 & 0 \\\\ 0 & -1 \\end{pmatrix} \\begin{pmatrix} 3 & 0 \\\\ 0 & 1 \\end{pmatrix} = \\begin{pmatrix} 3 & 0 \\\\ 0 & -1 \\end{pmatrix} = A_0$。\n\nQR迭代的第二步是计算 $A_{1} = R_{0} Q_{0}$：\n$$\nA_{1} = R_{0} Q_{0} = \\begin{pmatrix} 3 & 0 \\\\ 0 & 1 \\end{pmatrix} \\begin{pmatrix} 1 & 0 \\\\ 0 & -1 \\end{pmatrix} = \\begin{pmatrix} 3 & 0 \\\\ 0 & -1 \\end{pmatrix}.\n$$\n因此，$A_{1} = A_{0}$。这表明该对角矩阵是QR迭代的一个不动点（在给定 $R_0$ 对角线为正的条件下）。\n\n这对应于选项 E。",
            "answer": "$$\\boxed{E}$$"
        },
        {
            "introduction": "基础 QR 算法虽然原理清晰，但在处理具有几乎相等特征值的矩阵时会面临收敛缓慢的挑战。这个练习  通过分析一个接近于不可对角化的若尔当块的矩阵，揭示了这种现象。通过计算迭代后次对角线元素的变化，你将直观地理解为何在实际应用中必须引入位移等加速技巧。",
            "id": "2219199",
            "problem": "无位移QR算法是计算矩阵特征值的一种基本方法。该算法从 $A_0 = A$ 开始，生成一个矩阵序列 $\\{A_k\\}$。每一步包括计算当前矩阵的QR分解 $A_k = Q_k R_k$，然后反转因子以形成下一个矩阵 $A_{k+1} = R_k Q_k$。其中，$Q_k$ 是一个正交矩阵，$R_k$ 是一个上三角矩阵。为了得到唯一的分解，我们强制要求 $R_k$ 的对角元必须为正。\n\n众所周知，对于特征值大小相近的矩阵，该算法的收敛速度较慢。对于接近不可对角化（亏损）的矩阵，这种现象尤其明显。亏损矩阵的一个典型例子是若尔当块。\n\n考虑矩阵 $A$，它是一个若尔当块的微小扰动：\n$$\nA = \\begin{pmatrix} \\lambda & 1 \\\\ \\delta^2 & \\lambda \\end{pmatrix}\n$$\n其中 $\\lambda$ 是一个正实数，$\\delta$ 是一个实参数，满足 $0  |\\delta| \\ll \\lambda$。当 $\\delta \\to 0$ 时，该矩阵趋近于一个在 $\\lambda$ 处具有二重特征值的亏损若尔当块。\n\n令 $A_0 = A$。执行一次无位移QR算法的完整迭代以获得矩阵 $A_1$。次对角元 $(A_1)_{2,1}$ 是算法在寻找特征值方面进展的关键指标。请确定该元素 $(A_1)_{2,1}$ 作为 $\\lambda$ 和 $\\delta$ 的函数其精确表达式。",
            "solution": "我们将 $A$ 按列写为 $A=[a_1, a_2]$，其中 $a_1=\\begin{pmatrix}\\lambda\\\\ \\delta^{2}\\end{pmatrix}$，$a_2=\\begin{pmatrix}1\\\\ \\lambda\\end{pmatrix}$。我们通过Gram-Schmidt方法计算QR分解 $A=QR$，并要求 $R$ 的对角元为正。\n\n1.  计算第一列：\n    $r_{11} = \\|a_1\\|_2 = \\sqrt{\\lambda^2 + \\delta^4}$ (由于 $\\lambda > 0$, $r_{11}>0$)\n    $q_1 = \\frac{a_1}{r_{11}} = \\frac{1}{\\sqrt{\\lambda^2+\\delta^4}}\\begin{pmatrix}\\lambda\\\\ \\delta^{2}\\end{pmatrix}$\n\n2.  计算第二列：\n    $r_{12} = q_1^T a_2 = \\frac{1}{\\sqrt{\\lambda^2+\\delta^4}}(\\lambda \\cdot 1 + \\delta^2 \\cdot \\lambda) = \\frac{\\lambda(1+\\delta^2)}{\\sqrt{\\lambda^2+\\delta^4}}$\n    $u_2 = a_2 - r_{12}q_1 = \\begin{pmatrix}1\\\\ \\lambda\\end{pmatrix} - \\frac{\\lambda(1+\\delta^2)}{\\lambda^2+\\delta^4}\\begin{pmatrix}\\lambda\\\\ \\delta^2\\end{pmatrix} = \\frac{1}{\\lambda^2+\\delta^4}\\begin{pmatrix}(\\lambda^2+\\delta^4) - \\lambda^2(1+\\delta^2) \\\\ \\lambda(\\lambda^2+\\delta^4) - \\lambda\\delta^2(1+\\delta^2)\\end{pmatrix} = \\frac{\\lambda^2-\\delta^2}{\\lambda^2+\\delta^4}\\begin{pmatrix}-\\delta^2\\\\ \\lambda\\end{pmatrix}$\n    $r_{22} = \\|u_2\\|_2 = \\left|\\frac{\\lambda^2-\\delta^2}{\\lambda^2+\\delta^4}\\right| \\sqrt{(-\\delta^2)^2+\\lambda^2} = \\frac{|\\lambda^2-\\delta^2|}{\\lambda^2+\\delta^4}\\sqrt{\\lambda^2+\\delta^4} = \\frac{|\\lambda^2-\\delta^2|}{\\sqrt{\\lambda^2+\\delta^4}}$\n    由于 $0  |\\delta| \\ll \\lambda$, 我们有 $\\lambda^2 > \\delta^2$, 所以 $\\lambda^2-\\delta^2 > 0$。因此 $r_{22} = \\frac{\\lambda^2-\\delta^2}{\\sqrt{\\lambda^2+\\delta^4}} > 0$。\n\n我们现在有了 $Q = [q_1, q_2]$ 和 $R = \\begin{pmatrix}r_{11}  r_{12} \\\\ 0  r_{22}\\end{pmatrix}$。下一个迭代矩阵是 $A_1 = RQ$。我们想要求解其次对角元 $(A_1)_{2,1}$。\n$$ (A_1)_{2,1} = R_{21} Q_{11} + R_{22} Q_{21} $$\n其中 $Q_{ij}$ 是矩阵 $Q$ 的元素。由于 $R$ 是上三角矩阵，$R_{21}=0$。所以：\n$$ (A_1)_{2,1} = R_{22} Q_{21} $$\n$Q_{21}$ 是矩阵 $Q$ 在第二行第一列的元素，它等于向量 $q_1$ 的第二个分量。\n$$ Q_{21} = \\frac{\\delta^2}{\\sqrt{\\lambda^2+\\delta^4}} $$\n将 $r_{22}$ 和 $Q_{21}$ 的表达式代入，得到：\n$$ (A_1)_{2,1} = \\frac{\\lambda^2-\\delta^2}{\\sqrt{\\lambda^2+\\delta^4}} \\cdot \\frac{\\delta^2}{\\sqrt{\\lambda^2+\\delta^4}} = \\frac{\\delta^2(\\lambda^2-\\delta^2)}{\\lambda^2+\\delta^4} $$",
            "answer": "$$\\boxed{\\frac{\\delta^{2}\\left(\\lambda^{2}-\\delta^{2}\\right)}{\\lambda^{2}+\\delta^{4}}}$$"
        }
    ]
}