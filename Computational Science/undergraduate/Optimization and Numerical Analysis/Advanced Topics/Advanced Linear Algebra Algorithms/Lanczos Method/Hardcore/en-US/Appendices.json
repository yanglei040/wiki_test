{
    "hands_on_practices": [
        {
            "introduction": "To truly understand an algorithm, there is no substitute for working through it by hand. This first practice guides you through the fundamental steps of the Lanczos recursion . By manually computing the first few entries of the tridiagonal matrix $T_k$, you will build a concrete understanding of how the algorithm uses matrix-vector products and orthogonalization to project a large matrix into a much smaller, manageable form.",
            "id": "2184053",
            "problem": "Let a real symmetric matrix $A$ and a vector $b$ be defined as:\n$$\nA = \\begin{pmatrix} 4  1  1 \\\\ 1  2  0 \\\\ 1  0  3 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\nThe Lanczos algorithm is used to generate a sequence of tridiagonal matrices $T_k$ that approximate the eigenvalues of $A$. Using the vector $b$ as the starting vector for the algorithm, determine the $2 \\times 2$ tridiagonal matrix $T_2$ that is produced after two full iterations.",
            "solution": "We apply the Lanczos algorithm as described in the main text. The recurrence relation is $\\beta_{j+1} q_{j+1} = A q_j - \\alpha_j q_j - \\beta_j q_{j-1}$, with $\\alpha_j = q_j^T A q_j$. The resulting tridiagonal matrix is $T_k$ with diagonal entries $\\alpha_j$ and off-diagonal entries $\\beta_{j+1}$.\n\n**Initialization:**\nFirst, normalize the starting vector $b = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}$. Since its norm is $\\|b\\|_2 = 1$, we set $q_1 = b$. For the first iteration, we define $\\beta_1 = 0$ and $q_0 = \\mathbf{0}$.\n\n**First Iteration (j=1):**\n1.  Compute the vector $Aq_1$:\n    $$ A q_1 = \\begin{pmatrix} 4  1  1 \\\\ 1  2  0 \\\\ 1  0  3 \\end{pmatrix} \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 4 \\\\ 1 \\\\ 1 \\end{pmatrix} $$\n2.  Compute the diagonal element $\\alpha_1$:\n    $$ \\alpha_1 = q_1^T (A q_1) = \\begin{pmatrix} 1  0  0 \\end{pmatrix} \\begin{pmatrix} 4 \\\\ 1 \\\\ 1 \\end{pmatrix} = 4 $$\n3.  Compute the unnormalized next vector $w'_1$:\n    $$ w'_1 = A q_1 - \\alpha_1 q_1 - \\beta_1 q_0 = \\begin{pmatrix} 4 \\\\ 1 \\\\ 1 \\end{pmatrix} - 4 \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix} - \\mathbf{0} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 1 \\end{pmatrix} $$\n4.  Compute the off-diagonal element $\\beta_2$:\n    $$ \\beta_2 = \\|w'_1\\|_2 = \\sqrt{0^2 + 1^2 + 1^2} = \\sqrt{2} $$\n5.  Compute the next orthonormal vector $q_2$:\n    $$ q_2 = \\frac{w'_1}{\\beta_2} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 0 \\\\ 1 \\\\ 1 \\end{pmatrix} $$\n\n**Second Iteration (j=2):**\n1.  Compute the vector $Aq_2$:\n    $$ A q_2 = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 4  1  1 \\\\ 1  2  0 \\\\ 1  0  3 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ 1 \\end{pmatrix} = \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 2 \\\\ 2 \\\\ 3 \\end{pmatrix} $$\n2.  Compute the diagonal element $\\alpha_2$:\n    $$ \\alpha_2 = q_2^T (A q_2) = \\left( \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 0  1  1 \\end{pmatrix} \\right) \\left( \\frac{1}{\\sqrt{2}} \\begin{pmatrix} 2 \\\\ 2 \\\\ 3 \\end{pmatrix} \\right) = \\frac{1}{2} (0 + 2 + 3) = \\frac{5}{2} $$\n\nAfter two iterations, the coefficients for the tridiagonal matrix $T_2$ are $\\alpha_1 = 4$, $\\alpha_2 = 5/2$, and $\\beta_2 = \\sqrt{2}$. The matrix is:\n$$\nT_2 = \\begin{pmatrix} \\alpha_1  \\beta_2 \\\\ \\beta_2  \\alpha_2 \\end{pmatrix} = \\begin{pmatrix} 4  \\sqrt{2} \\\\ \\sqrt{2}  \\frac{5}{2} \\end{pmatrix}\n$$",
            "answer": "$$\\boxed{\\begin{pmatrix} 4  \\sqrt{2} \\\\ \\sqrt{2}  \\frac{5}{2} \\end{pmatrix}}$$"
        },
        {
            "introduction": "The Lanczos algorithm exhibits fascinating behavior in special cases. This exercise explores the important phenomenon of 'early termination', which happens when the starting vector lies within an invariant subspace of the matrix $A$ . By observing how the off-diagonal element $\\beta_j$ becomes zero, you will see how the algorithm can perfectly capture a portion of the matrix's eigenspectrum with fewer iterations than the matrix dimension.",
            "id": "2184051",
            "problem": "Consider the Lanczos tridiagonalization algorithm for a real symmetric matrix $A$ and a non-zero starting vector $b$, as described in the main text.\n\nYou are given the following $3 \\times 3$ symmetric matrix $A$ and starting vector $b$:\n$$ A = \\begin{pmatrix} 7  -3  0 \\\\ -3  7  0 \\\\ 0  0  10 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} $$\n\nApply the Lanczos algorithm to this matrix and starting vector. Determine the numerical value of the second diagonal element, $\\alpha_2$.",
            "solution": "The problem asks for the value of $\\alpha_2$, the second diagonal element of the tridiagonal matrix generated by the Lanczos algorithm for the given matrix $A$ and vector $b$. We will follow the steps of the algorithm as described in the main text.\n\n**Initialization:**\nThe starting vector is $b = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}$.\nFirst, we compute its norm: $\\|b\\|_2 = \\sqrt{0^2 + 1^2 + 0^2} = 1$.\nThe first orthonormal vector is $q_1 = \\frac{b}{\\|b\\|_2} = \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix}$.\nWe set $\\beta_1 = 0$ and $q_0 = \\mathbf{0}$.\n\n**First Iteration (j=1):**\n1.  Compute $A q_1$:\n    $$ A q_1 = \\begin{pmatrix} 7  -3  0 \\\\ -3  7  0 \\\\ 0  0  10 \\end{pmatrix} \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -3 \\\\ 7 \\\\ 0 \\end{pmatrix} $$\n2.  Compute the first diagonal element $\\alpha_1 = q_1^T (A q_1)$:\n    $$ \\alpha_1 = \\begin{pmatrix} 0  1  0 \\end{pmatrix} \\begin{pmatrix} -3 \\\\ 7 \\\\ 0 \\end{pmatrix} = 7 $$\n3.  Compute the unnormalized residual vector $w'_1 = A q_1 - \\alpha_1 q_1 - \\beta_1 q_0$:\n    $$ w'_1 = \\begin{pmatrix} -3 \\\\ 7 \\\\ 0 \\end{pmatrix} - 7 \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -3 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n4.  Compute the first off-diagonal element $\\beta_2 = \\|w'_1\\|_2$:\n    $$ \\beta_2 = \\sqrt{(-3)^2 + 0^2 + 0^2} = 3 $$\n5.  Since $\\beta_2 \\neq 0$, the algorithm continues. We compute the next orthonormal vector $q_2$:\n    $$ q_2 = \\frac{w'_1}{\\beta_2} = \\frac{1}{3} \\begin{pmatrix} -3 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -1 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n\n**Second Iteration (j=2):**\n1.  Compute $A q_2$:\n    $$ A q_2 = \\begin{pmatrix} 7  -3  0 \\\\ -3  7  0 \\\\ 0  0  10 \\end{pmatrix} \\begin{pmatrix} -1 \\\\ 0 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -7 \\\\ 3 \\\\ 0 \\end{pmatrix} $$\n2.  Compute the second diagonal element $\\alpha_2 = q_2^T (A q_2)$. This is the value requested by the problem.\n    $$ \\alpha_2 = \\begin{pmatrix} -1  0  0 \\end{pmatrix} \\begin{pmatrix} -7 \\\\ 3 \\\\ 0 \\end{pmatrix} = (-1)(-7) + (0)(3) + (0)(0) = 7 $$\n\nThe value of the second diagonal element is $\\alpha_2=7$.\n\nFor completeness, we can check if the algorithm terminates here.\n3. Compute $w'_2 = A q_2 - \\alpha_2 q_2 - \\beta_2 q_1$:\n   $$ w'_2 = \\begin{pmatrix} -7 \\\\ 3 \\\\ 0 \\end{pmatrix} - 7 \\begin{pmatrix} -1 \\\\ 0 \\\\ 0 \\end{pmatrix} - 3 \\begin{pmatrix} 0 \\\\ 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} -7 - (-7) \\\\ 3 - 3 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\\\ 0 \\end{pmatrix} $$\n4. Compute $\\beta_3 = \\|w'_2\\|_2 = 0$.\nSince $\\beta_3=0$, the algorithm terminates. The resulting tridiagonal matrix is $T_2 = \\begin{pmatrix} \\alpha_1  \\beta_2 \\\\ \\beta_2  \\alpha_2 \\end{pmatrix} = \\begin{pmatrix} 7  3 \\\\ 3  7 \\end{pmatrix}$.\nThe required value is $\\alpha_2$.",
            "answer": "$$\\boxed{7}$$"
        },
        {
            "introduction": "The Lanczos algorithm's elegance and efficiency rely on a critical assumption: the matrix $A$ must be symmetric. This practice challenges you to investigate what happens when this rule is broken . By applying the symmetric Lanczos procedure to a non-symmetric matrix, you will discover which of its theoretical properties fail, reinforcing why symmetry is essential for guaranteeing the tridiagonal structure of the projection.",
            "id": "2184074",
            "problem": "Consider applying the symmetric Lanczos algorithm, as described in the main text, to the following non-symmetric $2 \\times 2$ matrix:\n$$A = \\begin{pmatrix} 1  -1 \\\\ 2  1 \\end{pmatrix}$$\nUse the starting vector $q_1 = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$.\n\nAfter performing one full step of the algorithm to generate the scalars $\\alpha_1$, $\\beta_2$ and the vector $q_2$, determine which of the following fundamental properties, that is guaranteed to hold for a symmetric matrix, fails in this case.\n\nA. The newly generated vector $q_2$ is not orthogonal to the starting vector $q_1$; i.e., $q_1^T q_2 \\neq 0$.\n\nB. The $(1,2)$ entry of the projected matrix $Q^TAQ$ does not match the corresponding entry in the generated symmetric tridiagonal matrix $T$; i.e., $q_1^T A q_2 \\neq \\beta_2$.\n\nC. The algorithm cannot proceed because the generated vector $q_2$ is identical to $q_1$.\n\nD. The algorithm terminates prematurely because the residual vector $w'_1$ is the zero vector.\n\nE. The second diagonal entry of the projected matrix $Q^TAQ$ is not equal to the computed $\\alpha_2$; i.e., $q_2^T A q_2 \\neq \\alpha_2$.",
            "solution": "We are given the non-symmetric matrix\n$$\nA=\\begin{pmatrix}1-1\\\\21\\end{pmatrix},\n$$\nwith starting vector\n$$\nq_{1}=\\begin{pmatrix}1\\\\0\\end{pmatrix},\\quad \\|q_{1}\\|_{2}=1,\n$$\nand initializations $\\beta_{1}=0$ and $q_{0}=\\mathbf{0}$.\n\nWe apply the Lanczos step for $j=1$:\n1.  Compute $A q_1$:\n    $$\n    A q_{1}=\\begin{pmatrix}1\\\\2\\end{pmatrix}.\n    $$\n2.  Compute $\\alpha_1 = q_1^T (A q_1)$:\n    $$\n    \\alpha_{1}=q_{1}^{T}(A q_1)= \\begin{pmatrix}10\\end{pmatrix}\\begin{pmatrix}1\\\\2\\end{pmatrix}=1.\n    $$\n3.  Form the residual $w'_1 = A q_1 - \\alpha_1 q_1 - \\beta_1 q_0$:\n    $$\n    w_{1}'=A q_1 - \\alpha_{1}q_{1} - \\beta_{1}q_{0}=\\begin{pmatrix}1\\\\2\\end{pmatrix}-1\\begin{pmatrix}1\\\\0\\end{pmatrix}-0\\cdot \\mathbf{0}=\\begin{pmatrix}0\\\\2\\end{pmatrix}.\n    $$\n4.  Compute its norm, $\\beta_2 = \\|w'_1\\|_2$:\n    $$\n    \\beta_{2}=\\|w_{1}'\\|_{2}=\\sqrt{0^{2}+2^{2}}=2.\n    $$\n    Since $\\beta_2 \\neq 0$, the algorithm does not terminate.\n5.  Normalize to obtain $q_2 = w'_1 / \\beta_2$:\n    $$\n    q_{2}=\\frac{w_{1}'}{\\beta_{2}}=\\frac{1}{2}\\begin{pmatrix}0\\\\2\\end{pmatrix}=\\begin{pmatrix}0\\\\1\\end{pmatrix}.\n    $$\n\nNow we check the listed properties:\n\n- Orthogonality of $q_2$ to $q_1$:\n$$\nq_{1}^{T}q_{2}=\\begin{pmatrix}10\\end{pmatrix}\\begin{pmatrix}0\\\\1\\end{pmatrix}=0,\n$$\nso $q_2$ is orthogonal to $q_1$. Thus A does not fail.\n\n- Off-diagonal match in the projection: The projected matrix is $Q^T A Q$, where $Q = [q_1 | q_2]$. The generated tridiagonal matrix is $T_2 = \\begin{pmatrix} \\alpha_1  \\beta_2 \\\\ \\beta_2  \\alpha_2 \\end{pmatrix}$. For a symmetric matrix, we must have $Q^T A Q = T_2$. Let's check the $(1,2)$ entry: $q_1^T A q_2$.\n$$\nq_{1}^{T}A q_{2}=\\begin{pmatrix}10\\end{pmatrix}\\left(A\\begin{pmatrix}0\\\\1\\end{pmatrix}\\right)=\\begin{pmatrix}10\\end{pmatrix}\\begin{pmatrix}-1\\\\1\\end{pmatrix}=-1.\n$$\nWe have already computed $\\beta_2=2$. Since $q_1^T A q_2 = -1 \\neq \\beta_2=2$, the property that the projected matrix is tridiagonal with the computed coefficients fails. Thus B fails.\n\n- Identity of $q_2$ and $q_1$:\n$$\nq_{2}=\\begin{pmatrix}0\\\\1\\end{pmatrix}\\neq \\begin{pmatrix}1\\\\0\\end{pmatrix}=q_{1},\n$$\nso C does not fail.\n\n- Premature termination:\n$$\nw_{1}'=\\begin{pmatrix}0\\\\2\\end{pmatrix}\\neq \\mathbf{0},\n$$\nso D does not fail.\n\n- Diagonal entry consistency for the second vector: We need to compute $\\alpha_2$.\n$$\n\\alpha_2 = q_2^T A q_2 = \\begin{pmatrix}01\\end{pmatrix} A \\begin{pmatrix}0\\\\1\\end{pmatrix} = \\begin{pmatrix}01\\end{pmatrix} \\begin{pmatrix}-1\\\\1\\end{pmatrix} = 1.\n$$\nThe property is $q_2^T A q_2 = \\alpha_2$. By definition of how $\\alpha_2$ is computed, this identity holds. Thus E does not fail.\n\nHence, the fundamental property that fails is the off-diagonal equality $q_{1}^{T}A q_{2}=\\beta_{2}$, i.e., option B.\n\nFor completeness, note that although $q_1^T A q_2 \\neq \\beta_2$, one still has $q_2^T A q_1 = \\beta_2$ from the construction:\n$$\nq_2^T (A q_1) = q_2^T (\\alpha_1 q_1 + \\beta_2 q_2) = \\alpha_1 (q_2^T q_1) + \\beta_2 (q_2^T q_2) = 0 + \\beta_2 = \\beta_2.\n$$\nNumerically, $q_2^T A q_1 = \\begin{pmatrix}01\\end{pmatrix}\\begin{pmatrix}1\\\\2\\end{pmatrix}=2 = \\beta_2$.\nThe failure arises because for a non-symmetric matrix, $q_1^T A q_2 \\neq (A q_1)^T q_2 = q_1^T A^T q_2$. The symmetric Lanczos algorithm relies on this equality.",
            "answer": "$$\\boxed{B}$$"
        }
    ]
}