{
    "hands_on_practices": [
        {
            "introduction": "任何信赖域方法的出发点都是构建一个目标函数的局部近似模型。这个模型，通常是一个二次函数，如同当前点周围的一张“局部地图”，指导我们寻找下一个迭代点。本练习  将引导你完成构建该模型的关键第一步，即利用函数的梯度和Hessian矩阵来构造其二次近似。",
            "id": "2224506",
            "problem": "在无约束优化领域，信赖域方法是一类用于解决非线性规划问题的迭代算法。在每次迭代 $k$ 中，这些方法会构建一个更简单的模型函数 $m_k(p)$，该模型在当前点 $x_k$ 的一个邻域（即“信赖域”）内近似真实的目标函数 $f(x)$。然后通过在信赖域内最小化该模型来找到步长 $p$。一个常见的模型选择是基于 $f(x)$ 在 $x_k$ 处的二阶泰勒展开得到的二次函数。\n\n考虑由下式定义的目标函数 $f: \\mathbb{R}^2 \\to \\mathbb{R}$：\n$$f(x_1, x_2) = \\sin(x_1) + x_2^2$$\n确定该函数在点 $x_k = (0, 1)$ 处的二次模型 $m_k(p)$，其中 $p = (p_1, p_2)$ 是从 $x_k$ 出发的步长。将您的答案表示为关于 $p_1$ 和 $p_2$ 的多项式。",
            "solution": "基于 $f$ 在 $x_k$ 处的二阶泰勒展开的二次信赖域模型为\n$$m_{k}(p) = f(x_{k}) + \\nabla f(x_{k})^{\\top} p + \\frac{1}{2} p^{\\top} \\nabla^{2} f(x_{k}) p,$$\n其中 $p = (p_{1}, p_{2})$。\n\n给定 $f(x_{1}, x_{2}) = \\sin(x_{1}) + x_{2}^{2}$，计算其梯度和Hessian矩阵：\n$$\\nabla f(x_{1}, x_{2}) = \\begin{pmatrix} \\cos(x_{1}) \\\\ 2 x_{2} \\end{pmatrix}, \\quad \\nabla^{2} f(x_{1}, x_{2}) = \\begin{pmatrix} -\\sin(x_{1})  0 \\\\ 0  2 \\end{pmatrix}.$$\n\n在点 $x_{k} = (0, 1)$ 处计算这些值：\n$$f(x_{k}) = \\sin(0) + 1^{2} = 1,$$\n$$\\nabla f(x_{k}) = \\begin{pmatrix} \\cos(0) \\\\ 2 \\cdot 1 \\end{pmatrix} = \\begin{pmatrix} 1 \\\\ 2 \\end{pmatrix}, \\quad \\nabla^{2} f(x_{k}) = \\begin{pmatrix} -\\sin(0)  0 \\\\ 0  2 \\end{pmatrix} = \\begin{pmatrix} 0  0 \\\\ 0  2 \\end{pmatrix}.$$\n\n设 $p = (p_{1}, p_{2})$，计算一次项和二次项：\n$$\\nabla f(x_{k})^{\\top} p = 1 \\cdot p_{1} + 2 \\cdot p_{2} = p_{1} + 2 p_{2},$$\n$$p^{\\top} \\nabla^{2} f(x_{k}) p = \\begin{pmatrix} p_{1}  p_{2} \\end{pmatrix} \\begin{pmatrix} 0  0 \\\\ 0  2 \\end{pmatrix} \\begin{pmatrix} p_{1} \\\\ p_{2} \\end{pmatrix} = 2 p_{2}^{2}.$$\n\n因此，\n$$m_{k}(p) = 1 + \\left(p_{1} + 2 p_{2}\\right) + \\frac{1}{2} \\left(2 p_{2}^{2}\\right) = 1 + p_{1} + 2 p_{2} + p_{2}^{2}.$$",
            "answer": "$$\\boxed{1 + p_{1} + 2 p_{2} + p_{2}^{2}}$$"
        },
        {
            "introduction": "在理想情况下，我们的二次模型是凸的（形如碗状），但现实中的优化问题常常呈现出更复杂的地形，导致模型可能是非凸的。本练习  探讨了当二次模型为凹函数（向下弯曲）时的情景，此时模型本身不存在无约束最小值。你将通过这个案例发现信赖域约束如何发挥其核心作用，即使在这样的“棘手地形”上，也能确保算法找到一个有效的下降方向，这正是信赖域方法稳健性的体现。",
            "id": "2224539",
            "problem": "在无约束优化的背景下，信赖域方法围绕当前迭代点 $x_k$ 迭代地构建目标函数 $f(x)$ 的一个二次模型 $m_k(p)$。下一步的步长 $p_k$ 是通过在半径为 $\\Delta_k$ 的“信赖域”内最小化该模型来找到的。该模型在一维情况下定义为：\n$$m_k(p) = f(x_k) + f'(x_k)p + \\frac{1}{2}f''(x_k)p^2$$\n其中 $p$ 是从 $x_k$ 出发的步长。步长 $p_k$ 是以下子问题的解：\n$$\\min_{p} m_k(p) \\quad \\text{subject to} \\quad |p| \\le \\Delta_k$$\n\n考虑一维目标函数 $f(x) = -\\frac{1}{3}x^3 + 2x^2 - x$。假设我们处于迭代点 $x_k = 5$，且信赖域半径为 $\\Delta_k = 2$。\n\n确定对于本次迭代，求解该信赖域子问题的步长 $p_k$ 的值。",
            "solution": "我们在 $x_{k}=5$ 处构建一维二次模型：\n$$m_{k}(p)=f(x_{k})+f'(x_{k})p+\\frac{1}{2}f''(x_{k})p^{2}.$$\n给定 $f(x)=-\\frac{1}{3}x^{3}+2x^{2}-x$，其导数为\n$$f'(x)=-x^{2}+4x-1,\\qquad f''(x)=-2x+4.$$\n在 $x_{k}=5$ 处求值可得\n$$g_{k}=f'(5)=-25+20-1=-6,\\qquad B_{k}=f''(5)=-10+4=-6.$$\n因此模型简化为\n$$m_{k}(p)=f(x_{k})-6p+\\frac{1}{2}(-6)p^{2}=f(x_{k})-6p-3p^{2}.$$\n信赖域子问题是\n$$\\min_{p} \\, m_{k}(p)\\quad \\text{subject to}\\quad |p|\\le \\Delta_{k}=2.$$\n由于 $B_{k}  0$，二次函数 $m_{k}(p)$ 是关于 $p$ 的凹函数。其驻点满足 $m_{k}'(p)=g_{k}+B_{k}p=0$，解得\n$$p^{\\ast}=-\\frac{g_{k}}{B_{k}}=-\\frac{-6}{-6}=-1,$$\n由于函数是凹的，该点是极大值点。因此，在闭区间 $\\{|p|\\le 2\\}$ 上的最小值在边界点 $p=\\pm 2$ 之一处取得。计算模型在端点处的值：\n$$m_{k}(2)=f(x_{k})-12-12=f(x_{k})-24,\\qquad m_{k}(-2)=f(x_{k})+12-12=f(x_{k}).$$\n因此 $m_{k}(2)  m_{k}(-2)$，子问题的解为 $p_{k}=2$。",
            "answer": "$$\\boxed{2}$$"
        },
        {
            "introduction": "在实际应用中，精确求解信赖域子问题可能计算成本高昂，尤其是在高维空间中。因此，实用的算法通常采用高效的近似策略，其中“狗腿法”(dogleg method)是一种经典技术。本练习  将带你探索狗腿法计算出的近似解与子问题的精确最优解之间的差异，从而让你更深入地理解算法设计中精度与效率之间的重要权衡。",
            "id": "2224515",
            "problem": "在无约束优化领域，信赖域方法是用于寻找函数最小值的一类强大算法。在每次迭代中，它们求解一个子问题，该子问题在一个“信赖域”内最小化目标函数的二次模型。这个信赖域通常是围绕当前点的一个半径为 $\\Delta$ 的球。该子问题定义如下：\n$$\n\\min_{p \\in \\mathbb{R}^n} m(p) = f_k + g_k^T p + \\frac{1}{2} p^T B_k p \\quad \\text{subject to} \\quad \\|p\\|_2 \\le \\Delta_k\n$$\n一种流行且高效的近似求解该子问题的方法是狗腿法 (dogleg method)。\n\n考虑在迭代点 $x_k$ 处一个特定的二维信赖域子问题，其二次模型定义如下，其中 $p = (p_1, p_2)^T$：\n$$\nm(p_1, p_2) = -p_1 - p_2 + \\frac{1}{2}(p_1^2 + 100 p_2^2)\n$$\n信赖域半径设置为 $\\Delta = \\sqrt{0.1}$。设 $p_D$ 是使用狗腿法找到的近似解步长，设 $p^*$ 是该子问题的精确最优解。下列哪个陈述是正确的？\n\nA. 狗腿步 $p_D$ 位于从原点到无约束 Cauchy 点的路径段上。\n\nB. 狗腿步的第一个分量 $p_{D1}$ 大于精确解的第一个分量 $p_{1}^*$。\n\nC. 狗腿步的第二个分量 $p_{D2}$ 大于精确解的第二个分量 $p_{2}^*$。\n\nD. 狗腿步 $p_D$ 与精确解 $p^*$ 相同。\n\nE. 狗腿步的第一个分量 $p_{D1}$ 等于精确解的第一个分量 $p_{1}^*$。",
            "solution": "给定二次模型\n$$\nm(p) = -p_{1} - p_{2} + \\frac{1}{2}\\left(p_{1}^{2} + 100\\,p_{2}^{2}\\right),\n$$\n因此，在原点处的梯度和 Hessian 矩阵为\n$$\ng = \\nabla m(0) = \\begin{pmatrix}-1 \\\\ -1\\end{pmatrix}, \\quad B = \\begin{pmatrix}1  0 \\\\ 0  100\\end{pmatrix},\n$$\n信赖域半径为\n$$\n\\Delta = \\sqrt{0.1} = \\frac{1}{\\sqrt{10}}.\n$$\n\n计算完整的 Newton 步：\n$$\np_{N} = -B^{-1}g = \\begin{pmatrix}1 \\\\ \\frac{1}{100}\\end{pmatrix},\n$$\n其范数满足\n$$\n\\|p_{N}\\|_{2}^{2} = 1 + \\left(\\frac{1}{100}\\right)^{2}  \\Delta^{2} = \\frac{1}{10},\n$$\n所以 $p_{N}$ 位于信赖域之外。\n\n计算 Cauchy 点（沿 $-g$ 的最速下降方向）。沿着 $p = -\\alpha g = \\alpha\\begin{pmatrix}1 \\\\ 1\\end{pmatrix}$，最小化步长为\n$$\n\\alpha_{C} = \\frac{\\|g\\|_{2}^{2}}{g^{T}Bg} = \\frac{2}{101},\n$$\n所以\n$$\np_{U} = -\\alpha_{C} g = \\frac{2}{101}\\begin{pmatrix}1 \\\\ 1\\end{pmatrix} = \\begin{pmatrix}a \\\\ a\\end{pmatrix}, \\quad a := \\frac{2}{101}.\n$$\n其范数为\n$$\n\\|p_{U}\\|_{2}^{2} = 2a^{2} = \\frac{8}{10201}  \\frac{1}{10},\n$$\n因此 $p_{U}$ 严格位于信赖域内部。因为 $\\|p_{U}\\|_{2}  \\Delta  \\|p_{N}\\|_{2}$，狗腿步 $p_{D}$ 位于从 $p_{U}$ 到 $p_{N}$ 的线段上，且在与边界 $\\|p\\|_{2}=\\Delta$ 的交点处。\n\n参数化狗腿段：\n$$\np(\\tau) = p_{U} + \\tau(p_{N} - p_{U}), \\quad \\tau \\in [0,1].\n$$\n当 $a=\\frac{2}{101}$ 时，\n$$\np_{N} - p_{U} = \\begin{pmatrix}1 - a \\\\ \\frac{1}{100} - a\\end{pmatrix} = \\begin{pmatrix}\\frac{99}{101} \\\\ -\\frac{99}{10100}\\end{pmatrix}.\n$$\n因此 $p(\\tau)$ 的分量为\n$$\np_{1}(\\tau) = a + \\tau\\frac{99}{101}, \\quad p_{2}(\\tau) = a - \\tau\\frac{99}{10100}.\n$$\n在 $\\tau=1$ 处，\n$$\np_{2}(1) = a - \\frac{99}{10100} = \\frac{2}{101} - \\frac{99}{10100} = \\frac{200 - 99}{10100} = \\frac{1}{100}.\n$$\n由于 $\\|p_{U}\\|_{2}  \\Delta  \\|p_{N}\\|_{2}$，边界会在某个唯一的 $\\tau \\in (0,1)$ 处达到，因此对于狗腿步 $p_{D} = p(\\tau)$，我们有\n$$\np_{D2} = a - \\tau\\frac{99}{10100}  a - \\frac{99}{10100} = \\frac{1}{100}.\n$$\n\n现在计算精确的信赖域解 $p^{*}$。因为 $B$ 是正定的，并且无约束最小化点 $p_{N}$ 在信赖域之外，所以最优解满足带有一个有效约束的 KKT 条件：\n$$\n(B + \\lambda I)p^{*} = -g = \\begin{pmatrix}1 \\\\ 1\\end{pmatrix}, \\quad \\lambda  0, \\quad \\|p^{*}\\|_{2} = \\Delta.\n$$\n因此\n$$\np_{1}^{*} = \\frac{1}{1 + \\lambda}, \\quad p_{2}^{*} = \\frac{1}{100 + \\lambda}.\n$$\n由于 $\\lambda  0$，可得\n$$\np_{2}^{*} = \\frac{1}{100 + \\lambda}  \\frac{1}{100}.\n$$\n\n比较第二个分量，我们已经确定\n$$\np_{D2}  \\frac{1}{100}  p_{2}^{*},\n$$\n所以狗腿步的第二个分量严格大于精确解的第二个分量。因此陈述 C 是正确的。\n\n其余选项错误的原因如下：\n- A 是错误的，因为 Cauchy 点严格位于信赖域内部，而狗腿步位于从 $p_{U}$ 到 $p_{N}$ 的线段上并与边界相交，而不是在从原点到 Cauchy 点的线段上。\n- D 是错误的，因为 $p_{D2} \\ne p_{2}^{*}$ (实际上 $p_{D2}  p_{2}^{*}$)，所以 $p_{D} \\ne p^{*}$。\n- E 是错误的，因为 $p_{D2}  p_{2}^{*}$ 并且 $p_{D}$ 和 $p^{*}$ 都位于同一个圆 $\\|p\\|_{2}=\\Delta$ 上，这意味着 $p_{D1}  p_{1}^{*}$，而非相等；因此 B 也是错误的。\n因此，唯一正确的陈述是 C。",
            "answer": "$$\\boxed{C}$$"
        }
    ]
}