{
    "hands_on_practices": [
        {
            "introduction": "将偏微分方程转化为可解的代数方程组，是实现 Crank-Nicolson 方法的第一步。本练习将通过一个具体实例，指导你为一维热方程构建 Crank-Nicolson 格式的核心矩阵。掌握这一技能是理解该方法并将其付诸代码实践的基础。",
            "id": "2139888",
            "problem": "考虑一维热方程 $u_t = \\alpha u_{xx}$，其中函数 $u(x, t)$ 定义在空间域 $x \\in [0, L]$ 和时间 $t \\geq 0$ 上。该方程满足齐次狄利克雷（Dirichlet）边界条件，$u(0, t) = u(L, t) = 0$。\n\n我们希望使用克兰克-尼科尔森（Crank-Nicolson）方法对该方程进行数值求解。空间域被离散化为一个均匀网格，步长为 $\\Delta x$，使得恰好有三个内部网格点。设 $\\Delta t$ 为时间步长。该方法得到一个形如 $A\\mathbf{u}^{n+1} = B\\mathbf{u}^{n}$ 的矩阵系统，其中 $\\mathbf{u}^{k}$ 是在时间步长 $k$ 时，三个内部网格点上数值解的列向量。\n\n设参数 $\\lambda$ 定义为 $\\lambda = \\frac{\\alpha \\Delta t}{(\\Delta x)^2}$。\n\n以下哪个选项正确地表示了 $3 \\times 3$ 矩阵 $A$ 和 $B$？\n\nA. $A = \\begin{pmatrix} 1+\\lambda & -\\frac{\\lambda}{2} & 0 \\\\ -\\frac{\\lambda}{2} & 1+\\lambda & -\\frac{\\lambda}{2} \\\\ 0 & -\\frac{\\lambda}{2} & 1+\\lambda \\end{pmatrix}$, $B = \\begin{pmatrix} 1-\\lambda & \\frac{\\lambda}{2} & 0 \\\\ \\frac{\\lambda}{2} & 1-\\lambda & \\frac{\\lambda}{2} \\\\ 0 & \\frac{\\lambda}{2} & 1-\\lambda \\end{pmatrix}$\n\nB. $A = \\begin{pmatrix} 1-\\lambda & \\frac{\\lambda}{2} & 0 \\\\ \\frac{\\lambda}{2} & 1-\\lambda & \\frac{\\lambda}{2} \\\\ 0 & \\frac{\\lambda}{2} & 1-\\lambda \\end{pmatrix}$, $B = \\begin{pmatrix} 1+\\lambda & -\\frac{\\lambda}{2} & 0 \\\\ -\\frac{\\lambda}{2} & 1+\\lambda & -\\frac{\\lambda}{2} \\\\ 0 & -\\frac{\\lambda}{2} & 1+\\lambda \\end{pmatrix}$\n\nC. $A = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}$, $B = \\begin{pmatrix} 1-2\\lambda & \\lambda & 0 \\\\ \\lambda & 1-2\\lambda & \\lambda \\\\ 0 & \\lambda & 1-2\\lambda \\end{pmatrix}$\n\nD. $A = \\begin{pmatrix} 1+2\\lambda & -\\lambda & 0 \\\\ -\\lambda & 1+2\\lambda & -\\lambda \\\\ 0 & -\\lambda & 1+2\\lambda \\end{pmatrix}$, $B = \\begin{pmatrix} 1 & 0 & 0 \\\\ 0 & 1 & 0 \\\\ 0 & 0 & 1 \\end{pmatrix}$",
            "solution": "我们将空间区间用均匀步长 $\\Delta x$ 进行离散化，并记内部索引为 $i=1,2,3$。齐次狄利克雷边界条件要求对所有 $n$ 都有 $u_{0}^{n}=0$ 和 $u_{4}^{n}=0$。\n\n设 $u_{i}^{n}$ 是 $u(x_{i}, t^{n})$ 的近似值。在内部点 $i$ 处，方程 $u_{t}=\\alpha u_{xx}$ 的克兰克-尼科尔森（Crank–Nicolson）离散格式为\n$$\n\\frac{u_{i}^{n+1}-u_{i}^{n}}{\\Delta t}\n=\\frac{\\alpha}{2}\\left(\\frac{u_{i+1}^{n}-2u_{i}^{n}+u_{i-1}^{n}}{(\\Delta x)^{2}}+\\frac{u_{i+1}^{n+1}-2u_{i}^{n+1}+u_{i-1}^{n+1}}{(\\Delta x)^{2}}\\right).\n$$\n令 $\\lambda=\\frac{\\alpha\\Delta t}{(\\Delta x)^{2}}$，两边同乘以 $\\Delta t$ 得到\n$$\nu_{i}^{n+1}-u_{i}^{n}\n=\\frac{\\lambda}{2}\\left[(u_{i+1}^{n}-2u_{i}^{n}+u_{i-1}^{n})+(u_{i+1}^{n+1}-2u_{i}^{n+1}+u_{i-1}^{n+1})\\right].\n$$\n重新整理，将未知的时间层 $n+1$ 的项收集到左边，时间层 $n$ 的项收集到右边，得到\n$$\n\\left(1+\\lambda\\right)u_{i}^{n+1}-\\frac{\\lambda}{2}u_{i+1}^{n+1}-\\frac{\\lambda}{2}u_{i-1}^{n+1}\n=\\left(1-\\lambda\\right)u_{i}^{n}+\\frac{\\lambda}{2}u_{i+1}^{n}+\\frac{\\lambda}{2}u_{i-1}^{n}.\n$$\n由于边界值为零，没有出现额外的边界项。将 $i=1,2,3$ 的这个系统写成矩阵形式 $A\\mathbf{u}^{n+1}=B\\mathbf{u}^{n}$，其中 $\\mathbf{u}^{k}=(u_{1}^{k},u_{2}^{k},u_{3}^{k})^{T}$，矩阵为\n$$\nA=\\begin{pmatrix}\n1+\\lambda & -\\frac{\\lambda}{2} & 0 \\\\\n-\\frac{\\lambda}{2} & 1+\\lambda & -\\frac{\\lambda}{2} \\\\\n0 & -\\frac{\\lambda}{2} & 1+\\lambda\n\\end{pmatrix},\\quad\nB=\\begin{pmatrix}\n1-\\lambda & \\frac{\\lambda}{2} & 0 \\\\\n\\frac{\\lambda}{2} & 1-\\lambda & \\frac{\\lambda}{2} \\\\\n0 & \\frac{\\lambda}{2} & 1-\\lambda\n\\end{pmatrix}.\n$$\n这与选项A相匹配。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "虽然 Crank-Nicolson 方法是无条件稳定的，但这并不意味着它在所有情况下都能产生完全符合物理直觉的结果。本练习模拟了一个尖锐的初始脉冲在较大时间步长下的演化，旨在揭示该方法在处理非光滑初值时可能产生的非物理振荡。理解这一现象对于批判性地评估数值解的质量至关重要。",
            "id": "2139894",
            "problem": "考虑一维热方程 $u_t = \\alpha u_{xx}$，定义在空间域 $x \\in [0, L]$ 上。杆受到齐次狄利克雷边界条件的约束，使得对于所有时间 $t \\ge 0$，都有 $u(0, t) = u(L, t) = 0$。\n\n该方程将使用 Crank-Nicolson 有限差分格式进行数值求解。空间域被离散化为 $N_x$ 个大小为 $\\Delta x = L/N_x$ 的相等区间，网格点标记为 $x_j = j \\Delta x$，其中 $j=0, 1, \\dots, N_x$。时间以恒定的步长 $\\Delta t$ 进行离散化，时间层级为 $t_n = n \\Delta t$。解 $u(x_j, t_n)$ 的数值近似值记为 $u_j^n$。\n\nCrank-Nicolson 格式由下式给出：\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} = \\frac{\\alpha}{2} \\left( \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{(\\Delta x)^2} + \\frac{u_{j+1}^{n+1} - 2u_j^{n+1} + u_{j-1}^{n+1}}{(\\Delta x)^2} \\right)\n$$\n\n对于本问题，使用以下参数：\n-   杆的长度，$L = 1.0$。\n-   热扩散系数，$\\alpha = 1.0$。\n-   空间区间数，$N_x = 4$。这会产生三个内部网格点。\n-   在 $t=0$ 时的初始条件是一个尖锐的局部脉冲，在网格上通过将中心内部点的温度设置为 $u_2^0 = 2.0$，并将所有其他内部点的温度设置为零来近似。\n-   计算网格比设置为 $r = \\frac{\\alpha \\Delta t}{(\\Delta x)^2} = 10.0$。这对应于一个大的时间步长，选择该值是为了研究该方法在这种条件下的行为。\n\n你的任务是计算第一个时间步后，中心内部网格点处的解的值 $u_2^1$。请将你的答案表示为最简分数形式。",
            "solution": "我们使用 Crank-Nicolson 格式对具有齐次狄利克雷边界条件的 $x\\in[0,L]$ 上的热方程 $u_{t}=\\alpha u_{xx}$ 进行离散化。设网格比为 $r=\\alpha \\Delta t/(\\Delta x)^{2}$，则内部节点的 Crank-Nicolson 更新公式为\n$$\nu_{j}^{n+1}-u_{j}^{n}=\\frac{r}{2}\\Big[(u_{j+1}^{n}-2u_{j}^{n}+u_{j-1}^{n})+(u_{j+1}^{n+1}-2u_{j}^{n+1}+u_{j-1}^{n+1})\\Big].\n$$\n重新整理，将 $n+1$ 的项收集到左边，对于 $j=1,2,3$ 可得，\n$$\n-\\frac{r}{2}u_{j-1}^{n+1}+(1+r)u_{j}^{n+1}-\\frac{r}{2}u_{j+1}^{n+1}=(1-r)u_{j}^{n}+\\frac{r}{2}(u_{j-1}^{n}+u_{j+1}^{n}),\n$$\n其中 $u_{0}^{n}=u_{4}^{n}=0$。\n\n当 $N_{x}=4$ 时，第一步的内部未知数是 $u_{1}^{1},u_{2}^{1},u_{3}^{1}$，初始条件为 $u_{1}^{0}=0$，$u_{2}^{0}=2$，$u_{3}^{0}=0$。将这些值和边界值代入右侧，得到以下线性系统\n$$\n(1+r)u_{1}^{1}-\\frac{r}{2}u_{2}^{1}=r,\n$$\n$$\n-\\frac{r}{2}u_{1}^{1}+(1+r)u_{2}^{1}-\\frac{r}{2}u_{3}^{1}=2-2r,\n$$\n$$\n-\\frac{r}{2}u_{2}^{1}+(1+r)u_{3}^{1}=r.\n$$\n根据对称性，$u_{1}^{1}=u_{3}^{1}$；记 $a=u_{1}^{1}=u_{3}^{1}$ 且 $b=u_{2}^{1}$。该系统简化为\n$$\n(1+r)a-\\frac{r}{2}b=r,\n$$\n$$\n-ra+(1+r)b=2-2r.\n$$\n由第一个方程可得，$a=\\big(r+\\frac{r}{2}b\\big)/(1+r)$。代入第二个方程得到\n$$\n-\\frac{r\\big(r+\\frac{r}{2}b\\big)}{1+r}+(1+r)b=2-2r.\n$$\n两边同乘以 $(1+r)$ 并合并 $b$ 项，\n$$\n-r^{2}-\\frac{r^{2}}{2}b+(1+2r+r^{2})b=2-2r^{2},\n$$\n$$\n\\Big(1+2r+\\frac{r^{2}}{2}\\Big)b=2-r^{2}.\n$$\n因此，\n$$\nb=\\frac{2-r^{2}}{1+2r+\\frac{r^{2}}{2}}=\\frac{4-2r^{2}}{r^{2}+4r+2}.\n$$\n给定网格比 $r=10$，可得\n$$\nu_{2}^{1}=b=\\frac{4-2\\cdot 100}{100+40+2}=\\frac{-196}{142}=-\\frac{98}{71}.\n$$\n因此，第一个时间步后中心内部网格点的值为 $-\\frac{98}{71}$。",
            "answer": "$$\\boxed{-\\frac{98}{71}}$$"
        },
        {
            "introduction": "任何隐式格式的核心计算挑战都在于求解在每个时间步长产生的线性方程组。本练习将量化分析对于 Crank-Nicolson 方法生成的三对角系统，使用专门的托马斯算法 (Thomas algorithm, TDMA) 相较于标准高斯消元法所带来的计算优势。理解这种效率上的差异对于开发大规模问题的高效模拟程序至关重要。",
            "id": "2139847",
            "problem": "当一维热传导方程 $u_t = \\alpha u_{xx}$ 在具有 $N$ 个内部网格点的空间域上使用克兰克-尼科尔森有限差分法进行离散化时，求解每个时间步长的解的问题就简化为求解一个包含 $N$ 个未知数的 $N$ 个线性方程组。该方程组可以写成矩阵形式 $A \\mathbf{u} = \\mathbf{d}$，其中 $A$ 是一个 $N \\times N$ 的常数、稀疏、三对角矩阵，而 $\\mathbf{d}$ 是一个依赖于前一个时间步长解的向量。\n\n求解此类方程组的两种常用方法是标准高斯消元法和托马斯算法，后者是专门用于求解三对角系统的直接求解器，也称为三对角矩阵算法 (TDMA)。您的任务是量化使用该专门算法的计算优势。\n\n设计算成本定义为求解该系统所需的乘法和除法运算的总次数。对于非常大的内部点数 $N$，确定标准高斯消元法与托马斯算法的主阶计算成本之比，并表示为 $N$ 的函数。",
            "solution": "我们考虑一个大小为 $N\\times N$ 的线性系统 $A\\mathbf{u}=\\mathbf{d}$，其中 $A$ 是三对角矩阵。计算成本定义为求解 $\\mathbf{u}$ 所需的乘法和除法总次数。\n\n首先，我们计算利用了三对角性的托马斯算法 (TDMA) 的运算次数。使用标准的前向消元/回代形式：\n\n对于 $i=2,\\dots,N$ 的前向消元：\n- 计算 $w_{i}=a_{i}/b_{i-1}$：$1$ 次除法。\n- 更新 $b_{i}\\leftarrow b_{i}-w_{i}c_{i-1}$：$1$ 次乘法。\n- 更新 $d_{i}\\leftarrow d_{i}-w_{i}d_{i-1}$：$1$ 次乘法。\n\n这意味着每个 $i$ 需要 $3$ 次乘法/除法，总共为 $3(N-1)$ 次。\n\n回代：\n- 计算 $u_{N}=d_{N}/b_{N}$：$1$ 次除法。\n- 对于 $i=N-1,\\dots,1$：$u_{i}=(d_{i}-c_{i}u_{i+1})/b_{i}$，每个 $i$ 需要 $1$ 次乘法和 $1$ 次除法，共计 $2(N-1)$ 次运算。\n\n因此，托马斯算法的成本为\n$$\nC_{T}(N)=3(N-1)+\\bigl[1+2(N-1)\\bigr]=5N-4.\n$$\n\n接下来，我们计算标准高斯消元法的运算次数，将矩阵视为稠密矩阵（即不利用其三对角性）。\n\n消元阶段：对于每一列 $k=1,\\dots,N-1$，\n- 计算乘子 $m_{ik}=a_{ik}/a_{kk}$，对于 $i=k+1,\\dots,N$：需要 $(N-k)$ 次除法。\n- 更新行元素 $a_{ij}\\leftarrow a_{ij}-m_{ik}a_{kj}$，对于 $j=k+1,\\dots,N$：每行需要 $(N-k)$ 次乘法，共 $(N-k)$ 行，总计 $(N-k)^{2}$ 次乘法。\n\n对 $k$ 求和，\n- 消元阶段乘法次数：$\\sum_{k=1}^{N-1}(N-k)^{2}=\\sum_{m=1}^{N-1}m^{2}=\\dfrac{(N-1)N(2N-1)}{6}$。\n- 消元阶段除法次数：$\\sum_{k=1}^{N-1}(N-k)=\\sum_{m=1}^{N-1}m=\\dfrac{(N-1)N}{2}$。\n\n回代：\n- $u_{N}=b_{N}/a_{NN}$：$1$ 次除法。\n- 对于 $i=N-1,\\dots,1$，计算 $u_{i}=(b_{i}-\\sum_{j=i+1}^{N}a_{ij}u_{j})/a_{ii}$，每个 $i$ 需要 $(N-i)$ 次乘法和 $1$ 次除法。\n\n求和，\n- 回代阶段乘法次数：$\\sum_{i=1}^{N-1}(N-i)=\\dfrac{(N-1)N}{2}$。\n- 回代阶段除法次数：$N$。\n\n因此，总的乘法和除法次数为\n$$\n\\text{乘法次数：} \\frac{(N-1)N(2N-1)}{6}+\\frac{(N-1)N}{2}\n= \\frac{1}{3}N^{3}-\\frac{1}{3}N,\n$$\n$$\n\\text{除法次数：} \\frac{(N-1)N}{2}+N=\\frac{1}{2}N^{2}+\\frac{1}{2}N.\n$$\n因此，标准高斯消元法的总成本为\n$$\nC_{G}(N)=\\left(\\frac{1}{3}N^{3}-\\frac{1}{3}N\\right)+\\left(\\frac{1}{2}N^{2}+\\frac{1}{2}N\\right)\n=\\frac{1}{3}N^{3}+\\frac{1}{2}N^{2}+\\frac{1}{6}N.\n$$\n\n对于非常大的 $N$，主阶成本之比比较的是主导项：$C_{G}$ 中的 $N^{3}$ 项和 $C_{T}$ 中的 $N$ 项。因此，\n$$\n\\frac{C_{G,\\text{lead}}(N)}{C_{T,\\text{lead}}(N)}=\\frac{\\left(\\frac{1}{3}N^{3}\\right)}{5N}=\\frac{1}{15}N^{2}.\n$$\n因此，对于大的 $N$，托马斯算法相对于标准高斯消元法的计算优势因子按 $\\dfrac{N^{2}}{15}$ 的级别增长。",
            "answer": "$$\\boxed{\\frac{N^{2}}{15}}$$"
        }
    ]
}