{
    "hands_on_practices": [
        {
            "introduction": "经典微分方程在处理像集中力这样的物理模型时可能会遇到困难，因为这些力在数学上可能表现为不连续或奇异的函数。变分公式通过将微分方程转化为积分形式，为我们提供了一个更强大的框架。这个练习将指导你为一个在一根弦的中点施加了集中力的物理问题推导出弱形式，让你亲身体会到这种方法如何优雅地处理奇异源项。",
            "id": "2225027",
            "problem": "考虑一个简化模型，用于描述一根沿 x 轴从 $x=0$ 到 $x=1$ 拉伸的拉紧弹性弦的静态垂直位移 $u(x)$。该弦两端固定，因此其在端点的位移为零。在位于 $x=1/2$ 的弦中点处施加一个集中点力。\n\n位移 $u(x)$ 的控制方程是一维泊松方程，由以下边值问题（强形式）给出：\n$$ -u''(x) = f(x) \\quad \\text{for } x \\in (0, 1) $$\n边界条件为 $u(0) = 0$ 和 $u(1) = 0$。代表集中力的源项 $f(x)$ 由狄拉克δ函数 $f(x) = \\delta(x-1/2)$ 建模。\n\n该问题的弱形式是在一个函数空间 $V$ 中寻找一个解 $u$，使得一个积分方程对所有来自同一空间 $V$ 的检验函数 $v$ 都成立。对于这个问题，合适的空间是索博列夫空间 $H_0^1(0,1)$，它由满足边界条件 $v(0)=0$ 和 $v(1)=0$ 的平方可积且其一阶导数也平方可积的函数组成。\n\n以下哪一项代表了该问题的正确弱形式？\n\nA. 求 $u \\in V$ 使得 $\\int_0^1 u'(x)v'(x) \\,dx = v(1/2)$ 对所有 $v \\in V$ 成立。\n\nB. 求 $u \\in V$ 使得 $\\int_0^1 u'(x)v'(x) \\,dx = v'(1/2)$ 对所有 $v \\in V$ 成立。\n\nC. 求 $u \\in V$ 使得 $-\\int_0^1 u'(x)v'(x) \\,dx = v(1/2)$ 对所有 $v \\in V$ 成立。\n\nD. 求 $u \\in V$ 使得 $\\int_0^1 u''(x)v(x) \\,dx = v(1/2)$ 对所有 $v \\in V$ 成立。\n\nE. 求 $u \\in V$ 使得 $\\int_0^1 u'(x)v'(x) \\,dx - u'(1)v(1) + u'(0)v(0) = v(1/2)$ 对所有 $v \\in V$ 成立。",
            "solution": "我们从边值问题的强形式开始：\n$$\n-u''(x)=\\delta(x-\\tfrac{1}{2}) \\quad \\text{for } x\\in(0,1), \\quad u(0)=0, \\quad u(1)=0.\n$$\n为推导弱形式，我们将方程乘以一个任意的检验函数 $v\\in V$，其中 $V=H_{0}^{1}(0,1)$，并在 $(0,1)$ 上积分：\n$$\n\\int_{0}^{1}\\left(-u''(x)\\right)v(x)\\,dx=\\int_{0}^{1}\\delta(x-\\tfrac{1}{2})\\,v(x)\\,dx.\n$$\n右侧是狄拉克δ分布对 $v$ 的作用，得到\n$$\n\\int_{0}^{1}\\delta(x-\\tfrac{1}{2})\\,v(x)\\,dx = v\\!\\left(\\tfrac{1}{2}\\right).\n$$\n对于左侧，我们使用分部积分法（格林恒等式），并利用 $v\\in H_{0}^{1}(0,1)$ 满足 $v(0)=v(1)=0$：\n$$\n\\int_{0}^{1}\\left(-u''(x)\\right)v(x)\\,dx\n=\\left[-u'(x)v(x)\\right]_{0}^{1}+\\int_{0}^{1}u'(x)v'(x)\\,dx\n=\\int_{0}^{1}u'(x)v'(x)\\,dx,\n$$\n因为 $v(0)=v(1)=0$ 使得边界项消失。因此，弱形式为：\n$$\n\\int_{0}^{1}u'(x)v'(x)\\,dx = v\\!\\left(\\tfrac{1}{2}\\right) \\quad \\text{for all } v\\in H_{0}^{1}(0,1).\n$$\n这与选项 A 匹配。\n\n为什么其他选项不正确：\n- B 是不正确的，因为狄拉克δ函数作用于函数值 $v(\\tfrac{1}{2})$，而不是导数 $v'(\\tfrac{1}{2})$。\n- C 的符号是错误的；在齐次狄利克雷边界条件下，分部积分产生的左侧 $\\int u'v'$ 是正的。\n- D 不是一个正确的弱形式，因为它要求 $u''$ 对 $v$ 可积，而弱解 $u$ 属于 $H_{0}^{1}(0,1)$，其二阶导数 $u''$ 不需要作为 $L^{2}$ 函数存在。\n- E 包含了涉及 $u'(0)$ 和 $u'(1)$ 的边界项，对于 $u\\in H_{0}^{1}(0,1)$ 来说，这些不一定是良定义的迹；此外，由于 $v(0)=v(1)=0$，这样的项不应出现在一个良定的弱形式中。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "在推导出弱形式之后，下一个关键问题是：我们应该在哪个函数集合中寻找解？函数空间的选择并非随意的，它必须包含问题的基本物理约束，例如边界条件。本练习通过一个简单的反例——一个非零常数函数——来阐明，为什么一个不满足这些基本约束的函数，即使本身非常平滑，也不能成为问题的有效弱解。这凸显了为边值问题选择正确索博列夫空间 $H_0^1$ 的重要性。",
            "id": "2225003",
            "problem": "考虑具有齐次狄利克雷边界条件的一维泊松方程：\n$$\n-u''(x) = f(x) \\quad \\text{for } x \\in (0, 1)\n$$\n$$\nu(0) = 0, \\quad u(1) = 0\n$$\n其中 $f(x)$ 是平方可积函数空间 $L^2(0,1)$ 中的一个函数。\n\n该问题的弱形式是寻找一个函数 $u$（在索博列夫空间 $H_0^1(0,1)$ 中），使得对于所有检验函数 $v$（在 $H_0^1(0,1)$ 中），以下方程成立：\n$$\n\\int_{0}^{1} u'(x)v'(x) \\, dx = \\int_{0}^{1} f(x)v(x) \\, dx\n$$\n空间 $H_0^1(0,1)$ 是定义在区间 $[0,1]$ 上的函数空间，这些函数在边界上为零（即 $u(0)=u(1)=0$），并且其弱导数在 $(0,1)$ 上是平方可积的。\n\n我们来考察一个候选函数 $u_c(x) = C$，其中 $C$ 是一个非零实常数。下列哪个陈述提供了最根本的原因，说明为什么 $u_c(x)$ 不能是这个边值问题的弱解？\n\nA. 常数函数的弱导数 $u_c'(x)=0$ 在 $(0,1)$ 上不是一个平方可积函数。\n\nB. 函数 $u_c(x) = C$ 不属于所要求的解空间 $H_0^1(0,1)$。\n\nC. 弱形式左侧的积分 $\\int_{0}^{1} u_c'(x)v'(x) \\, dx$ 的值为零，这对于任意函数 $f(x)$ 是不可能的。\n\nD. 常数函数不是二次可微的，所以 $-u''(x)$ 未定义。\n\nE. 对于一个不是二次连续可微的函数，方程 $\\int_{0}^{1} u'(x)v'(x) \\, dx = \\int_{0}^{1} f(x)v(x) \\, dx$ 不能从 $-u''=f$ 推导出来。",
            "solution": "题目询问常数函数 $u_{c}(x)=C$（其中 $C\\neq 0$）能否作为具有齐次狄利克雷边界条件的泊松问题的弱解。弱形式要求找到 $u\\in H_{0}^{1}(0,1)$，使得对于所有 $v\\in H_{0}^{1}(0,1)$，\n$$\n\\int_{0}^{1} u'(x)v'(x)\\,dx=\\int_{0}^{1} f(x)v(x)\\,dx.\n$$\n\n步骤1：确定所要求的解空间。根据定义，$H_{0}^{1}(0,1)$ 由 $H^{1}(0,1)$ 中在端点处迹为零的函数组成，即 $u(0)=0$ 和 $u(1)=0$。\n\n步骤2：检查 $u_{c}$ 是否属于 $H_{0}^{1}(0,1)$。对于 $u_{c}(x)=C$ 且 $C\\neq 0$，我们有\n$$\nu_{c}(0)=C\\neq 0,\\qquad u_{c}(1)=C\\neq 0.\n$$\n因此，$u_{c}$ 不满足迹意义下的齐次狄利克雷边界条件，故\n$$\nu_{c}\\notin H_{0}^{1}(0,1).\n$$\n因此，$u_{c}$ 不能是弱解，因为它甚至不是解空间中的一个容许函数。\n\n步骤3：简要评估其他选项的正确性。\n- 对于选项A：常数函数的弱导数是 $u_{c}'=0$，并且 $0\\in L^{2}(0,1)$，所以声称它不是平方可积的是错误的。\n- 对于选项C：如果忽略空间要求并将 $u_{c}$ 代入弱形式，左侧将是\n$$\n\\int_{0}^{1} u_{c}'(x)v'(x)\\,dx=\\int_{0}^{1} 0\\cdot v'(x)\\,dx=0,\n$$\n这意味着对于所有 $v\\in H_{0}^{1}(0,1)$，都有 $0=\\int_{0}^{1} f(x)v(x)\\,dx$，这迫使 $f=0$ 在 $L^{2}(0,1)$ 中成立。虽然这显示了与任意 $f$ 的不相容性，但这不如 $u_{c}$ 未能位于 $H_{0}^{1}(0,1)$ 这一直接失败来得根本。\n- 对于选项D：常数函数是二次可微的，且 $u_{c}''=0$，所以该论断是错误的。\n- 对于选项E：弱形式对于 $u\\in H_{0}^{1}(0,1)$ 是有效的，并且不要求二次连续可微性；此外，$u_{c}$ 是光滑的，所以该陈述是错误的。\n\n最根本的原因是，由于边界条件，$u_{c}$ 不在所要求的解空间 $H_{0}^{1}(0,1)$ 中。",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "变分公式的巨大成功不仅在于其理论的完备性，更在于它为数值计算提供了坚实的基础，其中最著名的就是有限元法(FEM)。该方法的核心思想是在一个有限维的函数空间中寻找原问题的近似解。这个练习将带你从抽象的理论迈向具体的计算，通过为两个简单的分片线性“帽子”基函数计算“刚度矩阵”，让你了解如何将微分算子离散化为一个计算机可以求解的线性代数系统。",
            "id": "2225051",
            "problem": "考虑定义在区间 $[0, 1]$ 上的两个连续分段线性函数 $\\phi_1(x)$ 和 $\\phi_2(x)$。这些函数是基于将区间划分为三个相等的子区间而构建的，节点位于 $x_0=0$, $x_1=1/3$, $x_2=2/3$ 和 $x_3=1$。\n\n函数 $\\phi_1(x)$ 定义如下：\n$$\n\\phi_1(x) =\n\\begin{cases}\n3x  \\text{当 } 0 \\le x \\le 1/3 \\\\\n-3x + 2  \\text{当 } 1/3 \\le x \\le 2/3 \\\\\n0  \\text{当 } 2/3 \\le x \\le 1\n\\end{cases}\n$$\n\n函数 $\\phi_2(x)$ 定义如下：\n$$\n\\phi_2(x) =\n\\begin{cases}\n0  \\text{当 } 0 \\le x \\le 1/3 \\\\\n3x - 1  \\text{当 } 1/3 \\le x \\le 2/3 \\\\\n-3x + 3  \\text{当 } 2/3 \\le x \\le 1\n\\end{cases}\n$$\n\n你的任务是计算 $2 \\times 2$ 矩阵 $A$，其元素 $A_{ij}$ 由以下公式给出：\n$$\nA_{ij} = \\int_{0}^{1} \\frac{d\\phi_i}{dx}(x) \\frac{d\\phi_j}{dx}(x) \\,dx\n$$\n对于 $i, j \\in \\{1, 2\\}$。请将最终答案以 $2 \\times 2$ 矩阵的形式给出。",
            "solution": "我们首先计算分段线性基函数的导数。由于在孤立点处的导数不影响积分，我们在开子区间上指定导数，并注意到节点处的值对于积分是无关的。\n\n根据 $\\phi_{1}(x)$ 的定义，其导数为：\n$$\n\\frac{d\\phi_{1}}{dx}(x)=\n\\begin{cases}\n3   \\text{当 } 0  x  1/3 \\\\\n-3  \\text{当 } 1/3  x  2/3 \\\\\n0   \\text{当 } 2/3  x  1\n\\end{cases}\n$$\n根据 $\\phi_{2}(x)$ 的定义，其导数为：\n$$\n\\frac{d\\phi_{2}}{dx}(x)=\n\\begin{cases}\n0   \\text{当 } 0  x  1/3 \\\\\n3   \\text{当 } 1/3  x  2/3 \\\\\n-3  \\text{当 } 2/3  x  1\n\\end{cases}\n$$\n现在我们计算矩阵 $A$ 的元素 $A_{ij} = \\int_{0}^{1} \\phi_i'(x) \\phi_j'(x) \\,dx$。\n\n**对角元素:**\n-   $A_{11} = \\int_{0}^{1} (\\phi_1'(x))^2 dx = \\int_{0}^{1/3} (3)^2 dx + \\int_{1/3}^{2/3} (-3)^2 dx + \\int_{2/3}^{1} (0)^2 dx = 9 \\cdot (1/3) + 9 \\cdot (1/3) + 0 = 3 + 3 = 6$.\n-   $A_{22} = \\int_{0}^{1} (\\phi_2'(x))^2 dx = \\int_{0}^{1/3} (0)^2 dx + \\int_{1/3}^{2/3} (3)^2 dx + \\int_{2/3}^{1} (-3)^2 dx = 0 + 9 \\cdot (1/3) + 9 \\cdot (1/3) = 3 + 3 = 6$.\n\n**非对角元素:**\n-   $A_{12} = \\int_{0}^{1} \\phi_1'(x) \\phi_2'(x) dx$。由于导数的支撑区重叠部分仅在区间 $(1/3, 2/3)$，我们只需在此区间上积分：\n$A_{12} = \\int_{1/3}^{2/3} (-3)(3) dx = -9 \\cdot (1/3) = -3$.\n-   由于矩阵是对称的（因为 $A_{ij} = A_{ji}$），我们有 $A_{21} = A_{12} = -3$。\n\n因此，矩阵 $A$ 是：\n$$\nA = \\begin{pmatrix} 6  -3 \\\\ -3  6 \\end{pmatrix}\n$$",
            "answer": "$$\\boxed{\\begin{pmatrix}6  -3 \\\\ -3  6\\end{pmatrix}}$$"
        }
    ]
}