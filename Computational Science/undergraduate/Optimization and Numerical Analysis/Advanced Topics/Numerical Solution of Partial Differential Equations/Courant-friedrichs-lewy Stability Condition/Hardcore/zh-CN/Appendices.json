{
    "hands_on_practices": [
        {
            "introduction": "在数值模拟中，特别是在使用显式方法时，我们常常面临一个权衡。为了提高精度，我们希望使用更精细的网格，但这会带来由稳定性条件决定的计算成本。本练习  将探讨热方程这一经典扩散问题中的基本关系，展示一个看似简单的提高空间分辨率的决定，将如何显著影响所需的时间步长。",
            "id": "2164681",
            "problem": "一位工程师正在为一种新的微电子设备开发热管理模拟。沿一维薄硅互连线的散热可以用一维热传导方程来建模：\n$$\n\\frac{\\partial T}{\\partial t} = \\alpha \\frac{\\partial^2 T}{\\partial x^2}\n$$\n其中 $T$ 是温度，$t$ 是时间，$x$ 是沿互连线的位置，$\\alpha$ 是硅的热扩散率。\n\n为了数值求解该方程，该工程师使用前向时间中心空间 (FTCS) 显式格式。在时间步长 $n+1$ 和位置索引 $j$ 处的温度，是根据前一个时间步长 $n$ 的温度，通过以下离散化方式更新的：\n$$\nT_j^{n+1} = T_j^n + s (T_{j+1}^n - 2T_j^n + T_{j-1}^n)\n$$\n其中 $\\Delta t$ 是时间步长，$\\Delta x$ 是空间步长，$s = \\frac{\\alpha \\Delta t}{(\\Delta x)^2}$ 是无量纲稳定性参数。软件文档指出，为使此模拟保持数值稳定并避免非物理振荡，稳定性参数必须满足条件 $s \\le \\frac{1}{2}$。\n\n该工程师最初使用空间步长 $\\Delta x_{old}$ 和时间步长 $\\Delta t_{old}$ 进行了一次稳定的模拟，选择了能保证稳定性的最大可能时间步长。为了提高温度分布的精度，工程师决定通过将空间步长减半来加密模拟网格（即新的空间步长 $\\Delta x_{new} = \\frac{1}{2}\\Delta x_{old}$）。\n\n为了在这种加密网格下保持计算效率最高且稳定的模拟，新的允许的最大时间步长 $\\Delta t_{new}$ 和原始时间步长 $\\Delta t_{old}$ 之间必须满足什么关系？\n\nA. $\\Delta t_{new} = \\frac{1}{4} \\Delta t_{old}$\n\nB. $\\Delta t_{new} = \\frac{1}{2} \\Delta t_{old}$\n\nC. $\\Delta t_{new} = \\Delta t_{old}$\n\nD. $\\Delta t_{new} = 2 \\Delta t_{old}$\n\nE. $\\Delta t_{new} = 4 \\Delta t_{old}$",
            "solution": "FTCS 格式使用由下式定义的稳定性参数 $s$：\n$$\ns=\\frac{\\alpha \\Delta t}{(\\Delta x)^{2}}, \\quad s \\le \\frac{1}{2}.\n$$\n对于原始网格，最大的稳定时间步长满足：\n$$\ns_{old}=\\frac{\\alpha \\Delta t_{old}}{(\\Delta x_{old})^{2}}=\\frac{1}{2}.\n$$\n在将网格加密以使 $\\Delta x_{new}=\\frac{1}{2}\\Delta x_{old}$ 后，效率最高的稳定选择再次设定：\n$$\ns_{new}=\\frac{\\alpha \\Delta t_{new}}{(\\Delta x_{new})^{2}}=\\frac{1}{2}.\n$$\n代入 $\\Delta x_{new}=\\frac{1}{2}\\Delta x_{old}$ 得：\n$$\n\\frac{\\alpha \\Delta t_{new}}{\\left(\\frac{1}{2}\\Delta x_{old}\\right)^{2}}=\\frac{1}{2}\n\\;\\;\\Longrightarrow\\;\\;\n\\frac{4\\alpha \\Delta t_{new}}{(\\Delta x_{old})^{2}}=\\frac{1}{2}.\n$$\n与 $\\frac{\\alpha \\Delta t_{old}}{(\\Delta x_{old})^{2}}=\\frac{1}{2}$ 相比较，我们得到：\n$$\n4\\Delta t_{new}=\\Delta t_{old}\n\\;\\;\\Longrightarrow\\;\\;\n\\Delta t_{new}=\\frac{1}{4}\\Delta t_{old}.\n$$\n因此，正确选项是 A。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "真实世界的现象通常涉及多种物理过程的同时作用。本练习  模拟了污染物的输运过程，该过程既包括随水流移动的平流，也包括自身扩散。我们将看到每个过程如何对模拟施加各自的稳定性限制，以及我们必须如何识别其中最严格的限制，以确保获得可靠的结果。",
            "id": "2164744",
            "problem": "一位环境科学家正在创建一个数值模拟，以模拟特定污染物在一条长直水道中的输运过程。该过程由一维对流扩散方程控制，该方程描述了污染物浓度如何随空间和时间变化。该科学家采用一种称为前向时间中心空间 (FTCS) 格式的特定数值算法来近似求解。\n\n为使此 FTCS 格式保持数值稳定并产生可靠的预测，所选择的时间步长 $\\Delta t$ 和空间网格间距 $\\Delta x$ 必须满足两个基于系统物理性质的独立数学约束条件。该污染物的特征是输运速度（平流）$c$ 和扩散系数 $D$。这两个稳定性条件是：\n\n1.  一个与扩散相关的条件：\n    $$ \\frac{2D \\Delta t}{(\\Delta x)^2} \\le 1 $$\n2.  一个防止因平流引起非物理振荡的条件：\n    $$ \\frac{c^2 \\Delta t}{2D} \\le 1 $$\n\n模拟必须同时满足这两个条件。科学家使用以下参数设置了模型：\n-   输运速度，$c = 0.800 \\text{ m/s}$\n-   扩散系数，$D = 0.0500 \\text{ m}^2/\\text{s}$\n-   空间网格间距，$\\Delta x = 2.00 \\text{ m}$\n\n计算在此模拟中为保持数值稳定性可以使用的最大可能时间步长 $\\Delta t$。答案以秒 (s) 为单位表示，并四舍五入到三位有效数字。",
            "solution": "一维对流扩散的 FTCS 稳定性约束条件由以下公式给出：\n$$\\frac{2D\\Delta t}{(\\Delta x)^{2}} \\le 1 \\quad \\Rightarrow \\quad \\Delta t \\le \\frac{(\\Delta x)^{2}}{2D}$$\n$$\\frac{c^{2}\\Delta t}{2D} \\le 1 \\quad \\Rightarrow \\quad \\Delta t \\le \\frac{2D}{c^{2}}$$\n为了同时满足这两个条件，所允许的最大时间步长是两个上限中的较小者：\n$$\\Delta t_{\\max}=\\min\\!\\left(\\frac{(\\Delta x)^{2}}{2D},\\,\\frac{2D}{c^{2}}\\right)$$\n代入给定值 $c=0.800\\,\\text{m/s}$、$D=0.0500\\,\\text{m}^{2}\\!/\\text{s}$ 和 $\\Delta x=2.00\\,\\text{m}$：\n$$\\frac{(\\Delta x)^{2}}{2D}=\\frac{(2.00)^{2}}{2(0.0500)}=\\frac{4.00}{0.100}=40.0\\,\\text{s}$$\n$$\\frac{2D}{c^{2}}=\\frac{2(0.0500)}{(0.800)^{2}}=\\frac{0.100}{0.640}=0.15625\\,\\text{s}$$\n因此，\n$$\\Delta t_{\\max}=\\min(40.0,\\,0.15625)=0.15625\\,\\text{s}$$\n四舍五入到三位有效数字，最大时间步长为 $0.156\\,\\text{s}$。",
            "answer": "$$\\boxed{0.156}$$"
        },
        {
            "introduction": "数值格式的选择不仅仅是个人偏好问题，它对模拟的稳定性有着深远的影响。本练习  通过比较中心差分格式和迎风格式，深入探讨了平流问题数值稳定性的核心。通过分析每种格式如何放大或抑制数值误差，我们可以从理论上理解迎风格式为何如此稳健。",
            "id": "2164718",
            "problem": "一位科学家正在使用线性平流方程对一维通道中示踪剂的输运进行数值模拟：\n$$ \\frac{\\partial \\phi}{\\partial t} + v \\frac{\\partial \\phi}{\\partial x} = 0 $$\n其中 $\\phi(x,t)$ 是示踪剂浓度，$v$ 是恒定的正流速。该模拟使用间距为 $\\Delta x$ 的均匀空间网格和恒定的时间步长 $\\Delta t$。正在测试两种不同的数值算法，两者都在时间上使用前向差分。\n- **算法 C (中心差分):** 对空间导数 $\\frac{\\partial \\phi}{\\partial x}$ 使用中心差分近似。\n- **算法 U (迎风格式):** 对空间导数 $\\frac{\\partial \\phi}{\\partial x}$ 使用一阶迎风（因为 $v0$，所以是后向差分）近似。\n\n示踪剂浓度的初始状态是一个正弦波。为了分析数值稳定性，科学家关注解的单个傅里叶模式分量。在时间步 $n$ 和网格点 $j$，该分量记为 $\\phi_j^n$。算法根据规则 $\\phi_j^{n+1} = G \\cdot \\phi_j^n$ 来演化此模式，其中 $G$ 是复数放大因子，它取决于算法、傅里叶模式的波数和模拟参数。\n\n考虑一个特定的傅里叶模式，其波长是网格间距的四倍 ($\\lambda = 4 \\Delta x$)。模拟运行的参数使得库朗数（定义为 $\\nu = \\frac{v \\Delta t}{\\Delta x}$）恰好为 $0.5$。\n\n设 $|G_C|$ 为算法 C 的放大因子模，设 $|G_U|$ 为算法 U 的放大因子模，两者均针对指定的傅里叶模式和库朗数计算。\n\n计算比率 $\\frac{|G_C|}{|G_U|}$。将您的答案以实数形式报告，并四舍五入到三位有效数字。",
            "solution": "我们对每种格式进行 von Neumann 分析。设库朗数为 $\\nu = \\frac{v \\Delta t}{\\Delta x}$，并考虑一个傅里叶模式 $\\phi_{j}^{n} = \\hat{\\phi}\\, G^{n} \\exp(i j \\theta)$，其中 $\\theta = k \\Delta x$ 且 $k = \\frac{2 \\pi}{\\lambda}$。\n\n对于算法 C（时间前向，空间中心），离散格式为\n$$\n\\frac{\\phi_{j}^{n+1} - \\phi_{j}^{n}}{\\Delta t} + v \\frac{\\phi_{j+1}^{n} - \\phi_{j-1}^{n}}{2 \\Delta x} = 0,\n$$\n这给出\n$$\n\\phi_{j}^{n+1} = \\phi_{j}^{n} - \\nu \\frac{\\phi_{j+1}^{n} - \\phi_{j-1}^{n}}{2}.\n$$\n代入 $\\phi_{j\\pm 1}^{n} = \\phi_{j}^{n} \\exp(\\pm i \\theta)$ 以获得放大因子\n$$\nG_{C} = 1 - i \\nu \\sin \\theta.\n$$\n因此，\n$$\n|G_{C}| = \\sqrt{1 + \\nu^{2} \\sin^{2}\\theta}.\n$$\n\n对于算法 U（时间前向，对于 $v0$ 为迎风/后向空间），离散格式为\n$$\n\\frac{\\phi_{j}^{n+1} - \\phi_{j}^{n}}{\\Delta t} + v \\frac{\\phi_{j}^{n} - \\phi_{j-1}^{n}}{\\Delta x} = 0,\n$$\n这给出\n$$\n\\phi_{j}^{n+1} = \\phi_{j}^{n} - \\nu \\left(\\phi_{j}^{n} - \\phi_{j-1}^{n}\\right).\n$$\n代入 $\\phi_{j-1}^{n} = \\phi_{j}^{n} \\exp(-i \\theta)$ 以获得\n$$\nG_{U} = 1 - \\nu \\left(1 - \\exp(-i \\theta)\\right) = 1 - \\nu + \\nu \\exp(-i \\theta).\n$$\n于是，\n$$\n|G_{U}|^{2} = \\left[1 - \\nu \\left(1 - \\cos \\theta\\right)\\right]^{2} + \\left(\\nu \\sin \\theta\\right)^{2}.\n$$\n\n对于指定的模式，$\\lambda = 4 \\Delta x$ 给出 $k = \\frac{2 \\pi}{\\lambda} = \\frac{\\pi}{2 \\Delta x}$，因此 $\\theta = k \\Delta x = \\frac{\\pi}{2}$。当 $\\nu = 0.5$ 时，我们有 $\\sin \\theta = 1$ 和 $\\cos \\theta = 0$。因此，\n$$\n|G_{C}| = \\sqrt{1 + \\nu^{2} \\sin^{2}\\theta} = \\sqrt{1 + \\left(\\frac{1}{2}\\right)^{2}} = \\sqrt{\\frac{5}{4}} = \\frac{\\sqrt{5}}{2},\n$$\n$$\n|G_{U}|^{2} = \\left[1 - \\nu (1 - \\cos \\theta)\\right]^{2} + (\\nu \\sin \\theta)^{2} = \\left(1 - \\frac{1}{2}\\right)^{2} + \\left(\\frac{1}{2}\\right)^{2} = \\frac{1}{2},\n$$\n所以\n$$\n|G_{U}| = \\sqrt{\\frac{1}{2}} = \\frac{1}{\\sqrt{2}}.\n$$\n该比率为\n$$\n\\frac{|G_{C}|}{|G_{U}|} = \\frac{\\frac{\\sqrt{5}}{2}}{\\frac{1}{\\sqrt{2}}} = \\frac{\\sqrt{10}}{2} \\approx 1.58113883\\ldots\n$$\n四舍五入到三位有效数字，该比率为 $1.58$。",
            "answer": "$$\\boxed{1.58}$$"
        }
    ]
}