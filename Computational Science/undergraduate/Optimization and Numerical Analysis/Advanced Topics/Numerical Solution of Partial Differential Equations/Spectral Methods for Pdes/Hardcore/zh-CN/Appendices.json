{
    "hands_on_practices": [
        {
            "introduction": "谱方法的核心思想是用一组已知的、性质良好的基函数（如正弦、余弦或多项式）来近似表示一个复杂的函数。这个练习将带你实践一项基本技能：计算一个函数在傅里叶正弦级数下的展开系数。这不仅是傅里叶分析的经典问题，也是用谱方法求解定义在有限区间上、具有特定边界条件的偏微分方程的第一步。",
            "id": "2204923",
            "problem": "在物理系统的分析中，例如弦的振动或杆中的热传导，将初始状态表示为一系列正弦函数通常很有用。这种方法是求解偏微分方程的谱方法的基础。\n\n考虑一个定义在区间 $x \\in [0, 1]$ 上的函数 $f(x)$。该函数描述了一个初始剖面，并由以下分段定义给出：\n$$\nf(x) = \\begin{cases} \n2x  \\text{for } 0 \\le x \\le 1/2 \\\\\n2(1-x)  \\text{for } 1/2  x \\le 1 \n\\end{cases}\n$$\n这个函数可以在区间 $[0, 1]$ 上用其傅里叶正弦级数表示，其形式如下：\n$$\nf(x) = \\sum_{n=1}^{\\infty} b_n \\sin(n\\pi x)\n$$\n确定此级数展开中前三个非零系数 $b_n$ 的精确值。请将您的答案以一个行矩阵的形式呈现，其中包含这三个系数，并按其索引 $n$ 的递增顺序排列。",
            "solution": "对于 $[0,1]$ 上的傅里叶正弦级数，其系数由 $\\{\\sin(n\\pi x)\\}_{n\\ge 1}$ 的正交性给出：\n$$\nb_{n} = 2 \\int_{0}^{1} f(x)\\,\\sin(n\\pi x)\\,dx.\n$$\n根据给定的分段函数 $f(x)$，将积分拆分为：\n$$\nb_{n} = 2\\left[\\int_{0}^{1/2} 2x\\,\\sin(n\\pi x)\\,dx + \\int_{1/2}^{1} 2(1-x)\\,\\sin(n\\pi x)\\,dx\\right] = 4\\left[I_{1}+I_{2}\\right],\n$$\n其中\n$$\nI_{1} = \\int_{0}^{1/2} x\\,\\sin(n\\pi x)\\,dx,\\qquad I_{2} = \\int_{1/2}^{1} (1-x)\\,\\sin(n\\pi x)\\,dx.\n$$\n在 $I_{2}$ 中使用换元法 $u=1-x$，并利用恒等式 $\\sin(n\\pi(1-u)) = \\sin(n\\pi)\\cos(n\\pi u) - \\cos(n\\pi)\\sin(n\\pi u) = (-1)^{n+1}\\sin(n\\pi u)$，可得\n$$\nI_{2} = (-1)^{n+1}\\int_{0}^{1/2} u\\,\\sin(n\\pi u)\\,du = (-1)^{n+1} I_{1}.\n$$\n因此\n$$\nb_{n} = 4\\left[1 + (-1)^{n+1}\\right] I_{1}.\n$$\n因此，对于偶数 $n$，$b_{n}=0$；对于奇数 $n$，我们有 $b_{n} = 8 I_{1}$。接下来计算 $I_{1}$：\n$$\nI_{1} = \\int_{0}^{1/2} x\\,\\sin(n\\pi x)\\,dx.\n$$\n使用分部积分法，令 $u=x$，$dv=\\sin(n\\pi x)\\,dx$，则 $du=dx$ 且 $v=-\\cos(n\\pi x)/(n\\pi)$。于是\n$$\nI_{1} = \\left[-\\frac{x\\cos(n\\pi x)}{n\\pi} + \\frac{\\sin(n\\pi x)}{(n\\pi)^{2}}\\right]_{0}^{1/2}\n= -\\frac{1}{2n\\pi}\\cos\\!\\left(\\frac{n\\pi}{2}\\right) + \\frac{1}{(n\\pi)^{2}}\\sin\\!\\left(\\frac{n\\pi}{2}\\right).\n$$\n对于奇数 $n$，$\\cos(n\\pi/2)=0$ 且 $\\sin(n\\pi/2)=(-1)^{(n-1)/2}$，所以\n$$\nb_{n} = 8 I_{1} = \\frac{8}{(n\\pi)^{2}} \\sin\\!\\left(\\frac{n\\pi}{2}\\right), \\quad \\text{for odd } n.\n$$\n因此，前三个非零系数对应于 $n=1,3,5$：\n$$\nb_{1} = \\frac{8}{\\pi^{2}},\\qquad b_{3} = -\\frac{8}{9\\pi^{2}},\\qquad b_{5} = \\frac{8}{25\\pi^{2}}.\n$$\n按 $n$ 递增的顺序排列成行矩阵，结果是\n$$\n\\begin{pmatrix}\n\\frac{8}{\\pi^{2}}  -\\frac{8}{9\\pi^{2}}  \\frac{8}{25\\pi^{2}}\n\\end{pmatrix}.\n$$",
            "answer": "$$\\boxed{\\begin{pmatrix}\\frac{8}{\\pi^{2}}  -\\frac{8}{9\\pi^{2}}  \\frac{8}{25\\pi^{2}}\\end{pmatrix}}$$"
        },
        {
            "introduction": "谱方法的真正威力在于它们处理导数的方式，通过将问题转换到谱空间（即系数空间），微分运算可以简化为简单的代数运算。本练习将通过求解热传导方程来展示这一过程，你将推导出一个完整的数值格式，该格式结合了空间上的谱方法和时间上的简单前向欧拉法。理解这个过程是掌握如何应用谱方法求解含时演化偏微分方程的关键。",
            "id": "2204882",
            "problem": "考虑一个周长为 $L$ 的细的、绝热的金属环中的热扩散过程。在环上位置 $x$ 和时间 $t \\geq 0$ 处的温度分布 $u(x, t)$ 由一维热方程控制，这是一种偏微分方程 (PDE)：\n$$ \\frac{\\partial u}{\\partial t} = \\alpha \\frac{\\partial^2 u}{\\partial x^2} $$\n其中 $\\alpha$ 是金属的恒定热扩散率。环的几何形状在定义域 $x \\in [0, L]$上施加了周期性边界条件。\n\n为了数值求解此偏微分方程，对空间维度采用傅里叶谱方法。温度函数表示为一个复傅里叶级数：\n$$ u(x, t) = \\sum_{k=-\\infty}^{\\infty} \\hat{u}_k(t) \\exp\\left(i \\frac{2\\pi k x}{L}\\right) $$\n此处，$i = \\sqrt{-1}$，$k$ 是代表波数的整数，$\\hat{u}_k(t)$ 是随时间变化的傅里叶系数。\n\n对于时间积分，使用前向欧拉法，时间步长为常数 $\\Delta t$。在时间 $t_n = n \\Delta t$ 时系数 $\\hat{u}_k$ 的近似值用 $\\hat{u}_k^n$ 表示。对时间导数的前向欧拉近似由 $\\frac{d\\hat{u}_k}{dt} \\approx \\frac{\\hat{u}_k^{n+1} - \\hat{u}_k^n}{\\Delta t}$ 给出。\n\n基于此数值格式，推导下一时间步的傅里叶系数 $\\hat{u}_k^{n+1}$ 的全离散更新表达式，该表达式用其在当前时间步的值 $\\hat{u}_k^n$ 以及物理和数值参数 $\\alpha$、$L$、$k$ 和 $\\Delta t$ 来表示。",
            "solution": "我们从 $x \\in [0, L]$ 上带有周期性边界条件的热方程开始：\n$$\n\\frac{\\partial u}{\\partial t} = \\alpha \\frac{\\partial^{2} u}{\\partial x^{2}}.\n$$\n将 $u(x,t)$ 表示为其复傅里叶级数：\n$$\nu(x,t) = \\sum_{k=-\\infty}^{\\infty} \\hat{u}_{k}(t) \\exp\\!\\left(i \\frac{2\\pi k x}{L}\\right).\n$$\n对时间逐项微分：\n$$\n\\frac{\\partial u}{\\partial t} = \\sum_{k=-\\infty}^{\\infty} \\frac{d \\hat{u}_{k}}{dt}(t) \\exp\\!\\left(i \\frac{2\\pi k x}{L}\\right).\n$$\n对空间微分两次。一阶导数是\n$$\n\\frac{\\partial u}{\\partial x} = \\sum_{k=-\\infty}^{\\infty} \\hat{u}_{k}(t)\\, i \\frac{2\\pi k}{L} \\exp\\!\\left(i \\frac{2\\pi k x}{L}\\right),\n$$\n而二阶导数是\n$$\n\\frac{\\partial^{2} u}{\\partial x^{2}} = \\sum_{k=-\\infty}^{\\infty} \\hat{u}_{k}(t)\\, \\left(i \\frac{2\\pi k}{L}\\right)^{2} \\exp\\!\\left(i \\frac{2\\pi k x}{L}\\right) = - \\sum_{k=-\\infty}^{\\infty} \\hat{u}_{k}(t)\\, \\left(\\frac{2\\pi k}{L}\\right)^{2} \\exp\\!\\left(i \\frac{2\\pi k x}{L}\\right),\n$$\n因为 $i^{2} = -1$。将其代入偏微分方程，并令正交傅里叶模态的系数相等，对于每个整数 $k$，可得：\n$$\n\\frac{d \\hat{u}_{k}}{dt}(t) = - \\alpha \\left(\\frac{2\\pi k}{L}\\right)^{2} \\hat{u}_{k}(t).\n$$\n在时间 $t_{n} = n \\Delta t$ 处，使用时间步长为 $\\Delta t$ 的前向欧拉法对时间进行离散化：\n$$\n\\frac{\\hat{u}_{k}^{n+1} - \\hat{u}_{k}^{n}}{\\Delta t} = - \\alpha \\left(\\frac{2\\pi k}{L}\\right)^{2} \\hat{u}_{k}^{n}.\n$$\n解出 $\\hat{u}_{k}^{n+1}$，得到全离散更新表达式：\n$$\n\\hat{u}_{k}^{n+1} = \\left[1 - \\alpha \\Delta t \\left(\\frac{2\\pi k}{L}\\right)^{2}\\right] \\hat{u}_{k}^{n}.\n$$",
            "answer": "$$\\boxed{\\hat{u}_{k}^{n+1}=\\left[1-\\alpha\\,\\Delta t\\,\\left(\\frac{2\\pi k}{L}\\right)^{2}\\right]\\hat{u}_{k}^{n}}$$"
        },
        {
            "introduction": "任何数值方法的成功都取决于其基本假设的合理性，谱方法也不例外。本练习探讨了谱方法中一个至关重要的概念性问题：当所选的解空间（由基函数张成的空间）无法表示问题的某个关键部分（例如驱动项）时会发生什么。通过分析一个看似简单却失败的计算案例，你将深刻理解基函数集的正交性和完备性对于获得正确解是何等重要。",
            "id": "2204920",
            "problem": "一位数值分析师的任务是求解一维泊松方程 $u_{xx}(x) = f(x)$，定义域为 $x \\in [0, 1]$，并满足齐次狄利克雷边界条件 $u(0)=0$ 和 $u(1)=0$。该问题的特定强迫函数由 $f(x) = \\sin(8\\pi x)$ 给出。\n\n分析师选择使用谱伽辽金方法。他们提出了一个近似解 $u_N(x)$，作为基函数的有限线性组合：\n$$u_N(x) = \\sum_{k=1}^{N} c_k \\phi_k(x)$$\n所选的基函数是该定义域上拉普拉斯算子的正弦本征函数，即 $\\phi_k(x) = \\sin(k\\pi x)$，这些函数自动满足边界条件。在此次特定尝试中，分析师将基函数的数量设置为 $N=7$。\n\n伽辽金方法的核心原理是要求方程的残差 $R(x) = u_{N,xx}(x) - f(x)$ 与所选集合中的每一个基函数都正交。也就是说，对于所有的 $j=1, 2, \\dots, N$，都有 $\\int_0^1 R(x) \\phi_j(x) dx = 0$。这个过程产生了一个关于未知系数 $c_k$ 的线性方程组。\n\n当分析师使用 $N=7$ 实现此方法时，计算返回的解为 $u_7(x) = 0$ (对所有 $x$ 成立)。这显然是错误的，因为将 $u(x)=0$ 代入原始微分方程得到 $0 = \\sin(8\\pi x)$，而这是不成立的。\n\n下列哪个陈述为此特定数值实现失败提供了正确的基本原因？\n\nA. 强迫函数 $f(x)$ 与集合 $\\{\\sin(k\\pi x)\\}_{k=1}^{7}$ 中的每个基函数都正交。因此，$f(x)$ 在这些基函数张成的空间上的投影为零，导致计算出的平凡解为 $u_7(x)=0$。\n\nB. 关于系数 $c_k$ 的线性方程组是奇异的，因为系数矩阵的行列式为零，表明基函数不是线性无关的。\n\nC. 正弦基仅适用于具有偶数索引强迫函数的问题，例如 $\\sin(2n\\pi x)$。奇数索引的强迫函数 $\\sin(8\\pi x)$ (因为 $k=8$ 不是2的幂) 需要余弦基。\n\nD. 所选基函数的数量 $N=7$ 太小，无法分辨强迫项的振荡。根据奈奎斯特-香农采样定理，稳定的解至少需要 $2 \\times 8 = 16$ 个基函数。\n\nE. 该方法失败是因为边界条件 $u(0)=u(1)=0$ 与在边界处也为零的强迫函数不兼容。这造成了一个不适定问题。",
            "solution": "我们考虑使用基函数 $\\phi_{k}(x)=\\sin(k\\pi x)$ (其中 $k=1,\\dots,N$, 此处 $N=7$) 的谱伽辽金近似。近似解为 $u_{N}(x)=\\sum_{k=1}^{N}c_{k}\\sin(k\\pi x)$，所以其二阶导数为\n$$\nu_{N,xx}(x)=\\sum_{k=1}^{N}c_{k}\\phi_{k}''(x)=\\sum_{k=1}^{N}c_{k}\\left(-k^{2}\\pi^{2}\\sin(k\\pi x)\\right).\n$$\n当 $f(x)=\\sin(8\\pi x)$ 且残差为 $R(x)=u_{N,xx}(x)-f(x)$ 时，伽辽金条件为\n$$\n\\int_{0}^{1}R(x)\\,\\sin(j\\pi x)\\,dx=0,\\quad j=1,\\dots,N.\n$$\n代入 $R$ 可得\n$$\n\\int_{0}^{1}\\left(\\sum_{k=1}^{N}c_{k}\\left(-k^{2}\\pi^{2}\\sin(k\\pi x)\\right)-\\sin(8\\pi x)\\right)\\sin(j\\pi x)\\,dx=0.\n$$\n使用正交关系\n$$\n\\int_{0}^{1}\\sin(k\\pi x)\\sin(j\\pi x)\\,dx=\\begin{cases}\n0, j\\neq k,\\\\\n\\frac{1}{2}, j=k,\n\\end{cases}\n$$\n每个伽辽金方程解耦为\n$$\n-\\,j^{2}\\pi^{2}c_{j}\\int_{0}^{1}\\sin^{2}(j\\pi x)\\,dx=\\int_{0}^{1}\\sin(8\\pi x)\\sin(j\\pi x)\\,dx,\\quad j=1,\\dots,7,\n$$\n即，\n$$\n-\\,j^{2}\\pi^{2}c_{j}\\left(\\frac{1}{2}\\right)=\\int_{0}^{1}\\sin(8\\pi x)\\sin(j\\pi x)\\,dx,\\quad j=1,\\dots,7.\n$$\n根据正交性，对于每个 $j=1,\\dots,7$，右侧都为零，因为除非 $j=8$，否则 $\\sin(8\\pi x)$ 与 $\\sin(j\\pi x)$ 正交。因此，\n$$\n-\\,j^{2}\\pi^{2}c_{j}\\left(\\frac{1}{2}\\right)=0\\quad\\Rightarrow\\quad c_{j}=0,\\quad j=1,\\dots,7,\n$$\n这导致 $u_{7}(x)=0$。\n\n这揭示了根本原因：强迫函数完全位于模式 $k=8$ 中，而该模式不包含在 $\\{\\sin(k\\pi x)\\}_{k=1}^{7}$ 的张成空间中。因此，其在该子空间上的投影为零，并且伽辽金系统的右侧为零，而刚度矩阵是对角且可逆的：\n$$\na_{jk}=\\int_{0}^{1}\\phi_{k}''(x)\\phi_{j}(x)\\,dx=\\int_{0}^{1}\\left(-k^{2}\\pi^{2}\\sin(k\\pi x)\\right)\\sin(j\\pi x)\\,dx=-\\,\\frac{1}{2}k^{2}\\pi^{2}\\,\\delta_{jk},\n$$\n所以不存在奇异性。如果 $N$ 包含8，则会得到 $c_{8}=-1/(8^{2}\\pi^{2})$ 并恢复精确解。对于此边值问题，援引余弦基、奈奎斯特-香农采样或与边界条件不兼容的解释都是不正确的。正确的选择是强迫函数与所选子空间正交。\n\n因此，正确选项是A。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}