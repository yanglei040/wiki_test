{
    "hands_on_practices": [
        {
            "introduction": "要真正掌握罚函数法，最好的方式莫过于亲手实践。这个练习将引导你处理一个典型的等式约束优化问题：在满足一个线性等式约束的条件下，最小化一个二次函数。通过这个练习，你将学习如何构建二次罚函数，并通过求解梯度为零的方程组来解析地推导出近似最优解，从而深入理解罚函数法的核心思想。",
            "id": "2193291",
            "problem": "考虑一个约束优化问题，其目标是最小化函数 $f(x_1, x_2) = (x_1 - a)^2 + (x_2 - b)^2$，并满足线性约束 $h(x_1, x_2) = x_1 + x_2 - c = 0$。此处，$a, b,$ 和 $c$ 是实值常数。\n\n这类问题可以使用二次惩罚法来解决。该方法涉及创建一个无约束目标函数，称为惩罚函数，定义为 $P(x_1, x_2; \\mu) = f(x_1, x_2) + \\frac{\\mu}{2}[h(x_1, x_2)]^2$，其中 $\\mu  0$ 是一个大的正常数，称为惩罚参数。原始约束问题的解可以通过找到 $P(x_1, x_2; \\mu)$ 的最小化点来近似。当 $\\mu$ 趋于无穷大时，这个最小化点收敛到约束问题的真实解。\n\n确定无约束惩罚函数 $P(x_1, x_2; \\mu)$ 的最小化点 $(x_1^*(\\mu), x_2^*(\\mu))$。将您的答案表示为一个含两个分量的向量，其中每个分量都是用参数 $a, b, c$ 和 $\\mu$ 表示的解析表达式。",
            "solution": "我们给定的惩罚函数为\n$$\nP(x_{1},x_{2};\\mu)= (x_{1}-a)^{2}+(x_{2}-b)^{2}+\\frac{\\mu}{2}\\left(x_{1}+x_{2}-c\\right)^{2},\n$$\n其中 $\\mu0$。为了找到其无约束最小化点，我们将梯度设为零。偏导数为\n$$\n\\frac{\\partial P}{\\partial x_{1}}=2(x_{1}-a)+\\mu(x_{1}+x_{2}-c),\n$$\n$$\n\\frac{\\partial P}{\\partial x_{2}}=2(x_{2}-b)+\\mu(x_{1}+x_{2}-c).\n$$\n将它们设为零，得到线性系统\n$$\n2(x_{1}-a)+\\mu(x_{1}+x_{2}-c)=0,\\qquad 2(x_{2}-b)+\\mu(x_{1}+x_{2}-c)=0.\n$$\n等价地，\n$$\n(2+\\mu)x_{1}+\\mu x_{2}=2a+\\mu c,\\qquad \\mu x_{1}+(2+\\mu)x_{2}=2b+\\mu c.\n$$\n以矩阵形式表示，\n$$\n\\begin{pmatrix}\n2+\\mu  \\mu\\\\\n\\mu  2+\\mu\n\\end{pmatrix}\n\\begin{pmatrix}\nx_{1}\\\\\nx_{2}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n2a+\\mu c\\\\\n2b+\\mu c\n\\end{pmatrix}.\n$$\n系数矩阵的行列式为 $(2+\\mu)^{2}-\\mu^{2}=4(1+\\mu)$，对于 $\\mu0$ 其为正，因此解是唯一的。使用克莱姆法则，\n$$\nx_{1}=\\frac{(2a+\\mu c)(2+\\mu)-\\mu(2b+\\mu c)}{4(1+\\mu)}=\\frac{2a+\\mu(a-b+c)}{2(1+\\mu)},\n$$\n$$\nx_{2}=\\frac{(2+\\mu)(2b+\\mu c)-\\mu(2a+\\mu c)}{4(1+\\mu)}=\\frac{2b+\\mu(b-a+c)}{2(1+\\mu)}.\n$$\n当 $\\mu\\to\\infty$ 时，这些解收敛到精确的约束解 $(\\frac{a-b+c}{2},\\frac{b-a+c}{2})$，这与在直线 $x_{1}+x_{2}=c$ 上的投影一致。",
            "answer": "$$\\boxed{\\begin{pmatrix} \\frac{2a + \\mu(a-b+c)}{2(1+\\mu)} \\\\ \\frac{2b + \\mu(b-a+c)}{2(1+\\mu)} \\end{pmatrix}}$$"
        },
        {
            "introduction": "现实世界中的优化问题常常包含不等式约束，例如资源消耗不能超过某个上限。这个练习将探讨罚函数法如何扩展以处理不等式约束 $g(x) \\le 0$，特别是通过引入 $\\max(0, g(x))$ 项。此外，本题通过对比正确和错误处理不等式约束的两种方法，能够帮助你更深刻地理解罚函数仅在约束被违反时才“激活”的本质，从而避免常见的概念混淆。",
            "id": "2193329",
            "problem": "考虑一个一维约束优化问题，即最小化目标函数 $f(x) = (x-c)^2$，其中变量为 $x \\in \\mathbb{R}$。该最小化问题受单个不等式约束 $x \\le b$ 的限制。参数 $c$ 和 $b$ 是固定的实常数，满足条件 $c  b$。\n\n本问题将使用二次惩罚法进行分析，其中惩罚参数记为 $\\mu > 0$。对于一个最小化 $f(x)$ 且受不等式约束 $g(x) \\le 0$ 的一般问题，其惩罚目标函数由下式给出：\n$$P(x; \\mu) = f(x) + \\frac{1}{2\\mu} \\left( \\max(0, g(x)) \\right)^2$$\n\n首先，设 $x_I^*(\\mu)$ 是使给定不等式约束问题的正确构造的惩罚目标函数最小化的 $x$ 值。\n\n接下来，考虑一个常见的概念性错误，即分析者错误地将不等式约束 $x \\le b$ 视为等式约束 $x=b$。对于一个最小化 $f(x)$ 且受等式约束 $h(x) = 0$ 的一般问题，其惩罚目标函数由下式给出：\n$$P(x; \\mu) = f(x) + \\frac{1}{2\\mu} \\left( h(x) \\right)^2$$\n设 $x_E^*(\\mu)$ 是在这种不正确的等式构造下，使惩罚目标函数最小化的 $x$ 值。\n\n你的任务是确定当惩罚变得无限严格时，这两种方法之间差异的极限值。具体来说，计算极限 $\\lim_{\\mu \\to 0^+} \\left( x_E^*(\\mu) - x_I^*(\\mu) \\right)$ 的值。你的最终答案应该是一个用常数 $b$ 和 $c$ 表示的表达式。",
            "solution": "我们给定 $f(x)=(x-c)^{2}$ 和不等式约束 $x\\le b$，其中 $c  b$。\n\n**方法一：正确的不等式惩罚**\n\n正确的惩罚函数为 $P_I(x; \\mu) = (x-c)^2 + \\frac{1}{2\\mu} (\\max(0, x-b))^2$。\n由于 $c  b$，无约束最优解 $x=c$ 满足约束 $x \\le b$。对于任何满足约束的点（即 $x \\le b$），$\\max(0, x-b) = 0$，因此惩罚项为零。惩罚函数简化为 $P_I(x; \\mu) = (x-c)^2$。这个函数在 $x=c$ 处达到最小值。因此，对于任意 $\\mu > 0$，最优解为 $x_I^*(\\mu) = c$。\n\n**方法二：错误的等式惩罚**\n\n不正确的惩罚函数为 $P_E(x; \\mu) = (x-c)^2 + \\frac{1}{2\\mu}(x-b)^2$。\n为了找到最小值，我们对 $x$ 求导并设为零：\n$$\n\\frac{d P_E}{dx} = 2(x-c) + \\frac{1}{\\mu}(x-b) = 0\n$$\n$$\n2\\mu(x-c) + x - b = 0\n$$\n$$\n(2\\mu+1)x = 2\\mu c + b\n$$\n$$\nx_E^*(\\mu) = \\frac{2\\mu c + b}{2\\mu+1}\n$$\n\n**计算极限**\n\n我们需要计算极限 $\\lim_{\\mu \\to 0^+} (x_E^*(\\mu) - x_I^*(\\mu))$。\n$$\n\\lim_{\\mu \\to 0^+} \\left( \\frac{2\\mu c + b}{2\\mu+1} - c \\right) = \\frac{0 \\cdot c + b}{0+1} - c = b - c\n$$\n因此，极限值为 $b-c$。",
            "answer": "$$\\boxed{b-c}$$"
        },
        {
            "introduction": "罚函数法虽然强大，但也并非没有挑战。为了精确地满足约束，罚参数 $\\mu$ 需要取非常大的值，但这往往会导致数值计算上的困难。最后一个练习将带你深入探讨一个关键的实际问题：病态性（ill-conditioning）。你将分析随着罚参数 $\\mu$ 的增大，罚函数的海森矩阵（Hessian matrix）条件数是如何变化的，这有助于你理解为什么这种方法在实践中可能需要更高级的数值策略来保证稳定性和精度。",
            "id": "2193316",
            "problem": "一个材料科学研究团队正在设计一种新合金。该合金的稳定性取决于两个浓度参数 $x_1$ 和 $x_2$。该团队的目标是最小化一个由 $f(x_1, x_2) = x_1^2 + 4x_2^2$ 给出的成本函数。为使合金可行，其浓度必须满足严格线性约束 $g(x_1, x_2) = x_1 + x_2 - 1 = 0$。\n\n为了解决这个约束优化问题，该团队探索了一种非传统的罚函数法。他们定义了一个依赖于正罚参数 $\\mu$ 的惩罚目标函数 $P(x_1, x_2; \\mu)$：\n$$ P(x_1, x_2; \\mu) = f(x_1, x_2) + \\frac{\\mu}{4} [g(x_1, x_2)]^4 $$\n对于任意给定的 $\\mu  0$，他们求出 $P(x_1, x_2; \\mu)$ 的唯一极小值点 $x(\\mu) = (x_1(\\mu), x_2(\\mu))$。\n\n在数值优化中，一个关键的问题是问题的条件。众所周知，当 $\\mu$ 变得非常大时，在极小值点 $x(\\mu)$ 处计算的海森矩阵 $\\nabla^2 P$ 的条件数 $\\kappa(\\mu)$ 通常会增长，这可能导致数值不稳定性。理论分析表明，对于大的 $\\mu$，这种增长遵循幂律关系：$\\kappa(\\mu) \\approx C \\mu^{\\gamma}$，其中 $C$ 和 $\\gamma$ 是正常数。\n\n确定该特定问题中指数 $\\gamma$ 的精确值。请用分数表示你的答案。",
            "solution": "给定 $f(x_{1},x_{2})=x_{1}^{2}+4x_{2}^{2}$ 和 $g(x_{1},x_{2})=x_{1}+x_{2}-1$，惩罚目标函数为\n$$\nP(x_{1},x_{2};\\mu)=x_{1}^{2}+4x_{2}^{2}+\\frac{\\mu}{4}\\left(x_{1}+x_{2}-1\\right)^{4},\n$$\n其中 $\\mu0$。为简洁起见，令 $\\phi:=g(x_{1},x_{2})=x_{1}+x_{2}-1$。\n\n首先，计算 $P$ 的梯度和海森矩阵。由于 $\\nabla f=[2x_{1},\\,8x_{2}]^{\\top}$ 且 $\\nabla\\left(\\frac{\\mu}{4}\\phi^{4}\\right)=\\mu\\phi^{3}\\nabla\\phi=\\mu\\phi^{3}[1,\\,1]^{\\top}$，在极小值点 $x(\\mu)=(x_{1}(\\mu),x_{2}(\\mu))$ 处的平稳条件为\n$$\n\\begin{cases}\n2x_{1}+\\mu\\phi^{3}=0,\\\\\n8x_{2}+\\mu\\phi^{3}=0.\n\\end{cases}\n$$\n两式相减得到 $8x_{2}-2x_{1}=0$，因此 $x_{1}=4x_{2}$。利用 $\\phi=x_{1}+x_{2}-1=5x_{2}-1$，我们得到 $x_{2}=(\\phi+1)/5$ 和 $x_{1}=4(\\phi+1)/5$。将其代入 $2x_{1}+\\mu\\phi^{3}=0$ 得到关于 $\\phi$ 的标量方程：\n$$\n\\mu\\phi^{3}+\\frac{8}{5}(\\phi+1)=0.\n$$\n对于大的 $\\mu$，解满足 $\\phi\\to 0$，根据主导平衡 $\\mu\\phi^{3}+\\frac{8}{5}\\approx 0$，得到渐近标度关系\n$$\n\\phi(\\mu)\\sim -\\left(\\frac{8}{5}\\right)^{\\frac{1}{3}}\\mu^{-\\frac{1}{3}} \\quad \\text{as} \\quad \\mu\\to\\infty.\n$$\n\n接下来，计算海森矩阵。由于 $\\nabla^{2}f=\\mathrm{diag}(2,8)$，对于惩罚项\n$$\n\\nabla^{2}\\left(\\frac{\\mu}{4}\\phi^{4}\\right)=\\mu\\cdot 3\\phi^{2}\\,(\\nabla\\phi)(\\nabla\\phi)^{\\top}=3\\mu\\phi^{2}\\begin{bmatrix} 1  1 \\\\ 1  1 \\end{bmatrix},\n$$\n在 $x(\\mu)$ 处的海森矩阵是\n$$\nH(\\mu):=\\nabla^{2}P(x(\\mu);\\mu)=\\begin{bmatrix} 2  0 \\\\ 0  8 \\end{bmatrix}+t(\\mu)\\begin{bmatrix} 1  1 \\\\ 1  1 \\end{bmatrix},\n$$\n其中 $t(\\mu):=3\\mu\\phi(\\mu)^{2}$。利用 $\\phi(\\mu)$ 的标度关系，我们有\n$$\nt(\\mu)=3\\mu\\phi(\\mu)^{2}\\sim 3\\left(\\frac{8}{5}\\right)^{\\frac{2}{3}}\\mu^{\\frac{1}{3}} \\quad \\text{as} \\quad \\mu\\to\\infty.\n$$\n\n$H(\\mu)$ 的特征值可以精确求出。记 $A=\\mathrm{diag}(2,8)$ 和 $J=\\begin{bmatrix} 1  1 \\\\ 1  1 \\end{bmatrix}$，我们有 $H=A+tJ$。其特征多项式为\n$$\n\\det\\!\\left(\\begin{bmatrix} 2+t-\\lambda  t \\\\ t  8+t-\\lambda \\end{bmatrix}\\right)=0\n\\;\\Longleftrightarrow\\;\n\\lambda^{2}-(10+2t)\\lambda+(16+10t)=0,\n$$\n所以特征值为\n$$\n\\lambda_{\\pm}(t)=5+t\\pm\\sqrt{9+t^{2}}.\n$$\n对于大的 $t$，\n$$\n\\sqrt{9+t^{2}}=t\\sqrt{1+\\frac{9}{t^{2}}}=t+\\frac{9}{2t}+O(t^{-3}),\n$$\n因此\n$$\n\\lambda_{+}(t)=5+2t+\\frac{9}{2t}+O(t^{-3}),\\qquad\n\\lambda_{-}(t)=5-\\frac{9}{2t}+O(t^{-3}).\n$$\n因此，2-范数下的谱条件数为\n$$\n\\kappa(\\mu)=\\frac{\\lambda_{\\max}}{\\lambda_{\\min}}=\\frac{\\lambda_{+}(t(\\mu))}{\\lambda_{-}(t(\\mu))}\n=\\frac{5+2t(\\mu)+\\frac{9}{2t(\\mu)}+O(t(\\mu)^{-3})}{5-\\frac{9}{2t(\\mu)}+O(t(\\mu)^{-3})}\n=\\frac{2}{5}t(\\mu)+O\\!\\left(\\frac{1}{t(\\mu)}\\right).\n$$\n由于 $t(\\mu)\\sim \\text{const}\\cdot \\mu^{\\frac{1}{3}}$，可得\n$$\n\\kappa(\\mu)\\sim C\\,\\mu^{\\frac{1}{3}} \\quad \\text{as} \\quad \\mu\\to\\infty,\n$$\n其中 $C$ 为某个正常数。因此指数为\n$$\n\\gamma=\\frac{1}{3}.\n$$",
            "answer": "$$\\boxed{\\frac{1}{3}}$$"
        }
    ]
}