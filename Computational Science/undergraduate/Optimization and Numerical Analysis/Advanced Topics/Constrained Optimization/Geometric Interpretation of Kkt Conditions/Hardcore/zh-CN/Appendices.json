{
    "hands_on_practices": [
        {
            "introduction": "我们从一个简单的一维问题开始，建立对KKT条件的基本直观理解。这个问题  将优化问题类比为一个物理系统：一个粒子在受限区间内寻找其势能最低点。通过这个例子，我们可以清晰地看到KKT条件的核心几何思想——在边界上的最优点，目标函数的负梯度（将粒子拉向可行域内部的“力”）必须与活动约束的梯度（边界施加的“接触力”）方向相反且大小成比例。",
            "id": "2175825",
            "problem": "一个粒子被约束在闭区间 $[0, 2]$ 内沿 x 轴运动。该粒子处在一个势能场中，其势能函数为 $U(x) = (x-a)^2$，其中常数 $a=5$。粒子会自然地停留在区间内能使其势能最小化的平衡位置 $x^*$。\n\n在此平衡位置，由势能场产生的力（定义为 $F_{pot} = -\\frac{dU}{dx}$）与区间边界施加的力相平衡。只有当粒子紧靠边界时，边界才会施加一个非零的“接触”力。\n\n计算在平衡位置 $x^*$ 处，活动边界对粒子施加的接触力的大小。",
            "solution": "势能为 $U(x)=(x-a)^{2}$，其中 $a=5$。无约束的平衡位置满足 $F_{pot}=-\\frac{dU}{dx}=0$，即要求 $\\frac{dU}{dx}=0$。计算其导数：\n$$\n\\frac{dU}{dx}=2(x-a)=2(x-5).\n$$\n令 $\\frac{dU}{dx}=0$ 得到 $x=5$，该值不在允许的区间 $[0,2]$ 内。在区间 $[0,2]$ 上，由于对于 $x\\in[0,2]$ 有 $x-50$，因此\n$$\n\\frac{dU}{dx}=2(x-5)0,\n$$\n所以 $U(x)$ 在 $[0,2]$ 上是严格递减的。因此，有约束的最小值点在区间的右边界处：\n$$\nx^{*}=2.\n$$\n由势能产生的力为\n$$\nF_{pot}=-\\frac{dU}{dx}=-2(x-5)=10-2x.\n$$\n在 $x^{*}=2$ 处，\n$$\nF_{pot}(2)=10-2\\cdot 2=6.\n$$\n在有活动边界的平衡状态下，来自边界的接触力 $F_{c}$ 与势能力相平衡，使得合力为零：\n$$\nF_{c}+F_{pot}=0 \\quad \\Rightarrow \\quad F_{c}=-F_{pot}.\n$$\n因此接触力的大小为\n$$\n|F_{c}|=|F_{pot}(2)|=6.\n$$",
            "answer": "$$\\boxed{6}$$"
        },
        {
            "introduction": "现在，我们将一维的直观理解扩展到二维空间。当最优点位于可行域的角落时，可能会有多个约束同时起作用。这个问题  要求我们将一个外部点投影到一个矩形区域上，它极好地展示了这种情形下的几何关系。我们将看到，最优解的负梯度向量必须落在由活动约束的梯度向量所张成的“锥”（称为法锥）之内，这是KKT条件最核心的几何图像之一。",
            "id": "2175840",
            "problem": "考虑一个二维空间中的优化问题。其目标是在一个特定的可行域内，找到一个点 $\\mathbf{x} = (x_1, x_2)$，使其与一个给定的外部点在标准欧几里得距离下最近。\n\n可行域（记为 $C$）是一个由以下约束定义的闭合矩形区域：\n$$-2 \\le x_1 \\le 2$$\n$$-1 \\le x_2 \\le 1$$\n\n外部点为 $\\mathbf{p} = (3, 5)$。\n\n该问题可正式表述为：\n$$ \\text{Minimize} \\quad f(\\mathbf{x}) = \\|\\mathbf{x} - \\mathbf{p}\\|_2^2 $$\n$$ \\text{Subject to} \\quad \\mathbf{x} \\in C $$\n\n这是一个凸优化问题，其解可以通过 Karush-Kuhn-Tucker (KKT) 条件来刻画。定义区域 $C$ 的约束可以写成四个不等式约束 $g_i(\\mathbf{x}) \\le 0$。在最优解 $\\mathbf{x}^*$ 处，KKT 的平稳性条件表明，目标函数的负梯度 $-\\nabla f(\\mathbf{x}^*)$ 可以表示为有效约束梯度的非负线性组合：\n$$-\\nabla f(\\mathbf{x}^*) = \\sum_{i \\in \\mathcal{A}(\\mathbf{x}^*)} \\mu_i \\nabla g_i(\\mathbf{x}^*)$$\n其中 $\\mathcal{A}(\\mathbf{x}^*)$ 是有效约束的索引集（即 $g_i(\\mathbf{x}^*) = 0$），而 $\\mu_i \\ge 0$ 是相应的 KKT 乘子。\n\n您的任务是确定此优化问题的所有非零 KKT 乘子之和 $\\sum \\mu_i$。请以一个实数的形式提供最终答案。",
            "solution": "我们将外部点 $\\mathbf{p}=(3,5)$ 投影到闭合矩形 $C=\\{(x_{1},x_{2}): -2 \\leq x_{1} \\leq 2,\\,-1 \\leq x_{2} \\leq 1\\}$ 上。因为到盒(box)上的欧几里得投影是通过将每个坐标限制在其区间内得到的，所以最优点是\n$$\nx_{1}^{*}=\\min\\{\\max\\{3,-2\\},2\\}=2,\\quad x_{2}^{*}=\\min\\{\\max\\{5,-1\\},1\\}=1,\n$$\n因此 $\\mathbf{x}^{*}=(2,1)$。\n\n目标函数为 $f(\\mathbf{x})=\\|\\mathbf{x}-\\mathbf{p}\\|_{2}^{2}=(x_{1}-3)^{2}+(x_{2}-5)^{2}$，其梯度为\n$$\n\\nabla f(\\mathbf{x})=2\\begin{pmatrix}x_{1}-3\\\\ x_{2}-5\\end{pmatrix}.\n$$\n在 $\\mathbf{x}^{*}$ 处，可得\n$$\n\\nabla f(\\mathbf{x}^{*})=2\\begin{pmatrix}2-3\\\\ 1-5\\end{pmatrix}=2\\begin{pmatrix}-1\\\\ -4\\end{pmatrix}=\\begin{pmatrix}-2\\\\ -8\\end{pmatrix},\\quad -\\nabla f(\\mathbf{x}^{*})=\\begin{pmatrix}2\\\\ 8\\end{pmatrix}.\n$$\n\n将四个不等式约束写为\n$$\ng_{1}(\\mathbf{x})=x_{1}-2\\leq 0,\\quad g_{2}(\\mathbf{x})=-x_{1}-2\\leq 0,\\quad g_{3}(\\mathbf{x})=x_{2}-1\\leq 0,\\quad g_{4}(\\mathbf{x})=-x_{2}-1\\leq 0.\n$$\n在 $\\mathbf{x}^{*}=(2,1)$ 处，有效约束为 $g_{1}(\\mathbf{x}^{*})=0$ 和 $g_{3}(\\mathbf{x}^{*})=0$，而 $g_{2}(\\mathbf{x}^{*})0$ 和 $g_{4}(\\mathbf{x}^{*})0$。它们的梯度是\n$$\n\\nabla g_{1}(\\mathbf{x}^{*})=\\begin{pmatrix}1\\\\ 0\\end{pmatrix},\\quad \\nabla g_{3}(\\mathbf{x}^{*})=\\begin{pmatrix}0\\\\ 1\\end{pmatrix},\\quad \\nabla g_{2}(\\mathbf{x}^{*})=\\begin{pmatrix}-1\\\\ 0\\end{pmatrix},\\quad \\nabla g_{4}(\\mathbf{x}^{*})=\\begin{pmatrix}0\\\\ -1\\end{pmatrix}.\n$$\n\n根据 KKT 平稳性条件，以及乘子 $\\mu_{i}\\geq 0$ 和互补松弛性，我们有 $\\mu_{2}=\\mu_{4}=0$ 和\n$$\n-\\nabla f(\\mathbf{x}^{*})=\\mu_{1}\\nabla g_{1}(\\mathbf{x}^{*})+\\mu_{3}\\nabla g_{3}(\\mathbf{x}^{*}).\n$$\n因此\n$$\n\\begin{pmatrix}2\\\\ 8\\end{pmatrix}=\\mu_{1}\\begin{pmatrix}1\\\\ 0\\end{pmatrix}+\\mu_{3}\\begin{pmatrix}0\\\\ 1\\end{pmatrix}=\\begin{pmatrix}\\mu_{1}\\\\ \\mu_{3}\\end{pmatrix},\n$$\n这得出 $\\mu_{1}=2$ 和 $\\mu_{3}=8$。因此，所有非零 KKT 乘子之和为\n$$\n\\mu_{1}+\\mu_{3}=2+8=10.\n$$",
            "answer": "$$\\boxed{10}$$"
        },
        {
            "introduction": "在理解了线性约束下的几何原理后，我们来挑战一个更具一般性的非线性问题。这个问题  的可行域由两条抛物线界定，边界是弯曲的。尽管几何形状变得复杂，但KKT条件的基本逻辑依然适用：在最优点，目标函数的梯度必须能够表示为活动约束梯度的非负线性组合。解决这个问题需要我们系统地运用完整的KKT条件，通过分类讨论来确定最终的解。",
            "id": "2175829",
            "problem": "一个粒子在二维平面中的位置 $(x_1, x_2)$ 被限制在由不等式 $2x_1^2 \\le x_2$ 和 $x_2 \\le x_1^2 + 1$ 定义的区域内。我们要寻找该允许区域内距离固定观测点 $P=(0, 2)$ 最近的点。为简化计算，你需要最小化粒子与点 $P$ 之间欧几里得距离的平方。\n\n如果有多个点满足此条件，请提供 $x_1$ 坐标为正的点的坐标。你的最终答案应该是一对精确的解析形式的数 $(x_1, x_2)$。",
            "solution": "问题是在一组约束条件下，找到使得到点 $P=(0,2)$ 的欧几里得距离平方最小的点 $(x_1, x_2)$。\n\n首先，我们构建优化问题。要最小化的目标函数是从 $(x_1, x_2)$ 到 $(0, 2)$ 的距离平方：\n$$f(x_1, x_2) = (x_1 - 0)^2 + (x_2 - 2)^2 = x_1^2 + (x_2 - 2)^2$$\n\n可行域由两个不等式约束定义。我们将它们写成标准形式 $g_i(x_1, x_2) \\le 0$：\n1.  $2x_1^2 \\le x_2 \\implies g_1(x_1, x_2) = 2x_1^2 - x_2 \\le 0$\n2.  $x_2 \\le x_1^2 + 1 \\implies g_2(x_1, x_2) = x_2 - x_1^2 - 1 \\le 0$\n\n这是一个非线性规划问题，可以用 Karush-Kuhn-Tucker (KKT) 条件来求解。我们用拉格朗日乘子 $\\mu_1$ 和 $\\mu_2$ 定义拉格朗日函数 $L(x_1, x_2, \\mu_1, \\mu_2)$：\n$$L(x_1, x_2, \\mu_1, \\mu_2) = f(x_1, x_2) + \\mu_1 g_1(x_1, x_2) + \\mu_2 g_2(x_1, x_2)$$\n$$L(x_1, x_2, \\mu_1, \\mu_2) = x_1^2 + (x_2 - 2)^2 + \\mu_1(2x_1^2 - x_2) + \\mu_2(x_2 - x_1^2 - 1)$$\n\n在 $(x_1^*, x_2^*)$ 处取得最小值的 KKT 条件如下：\n1.  **平稳性**：拉格朗日函数关于 $x_1$ 和 $x_2$ 的梯度必须为零。\n    - $\\frac{\\partial L}{\\partial x_1} = 2x_1 + 4\\mu_1 x_1 - 2\\mu_2 x_1 = 2x_1(1 + 2\\mu_1 - \\mu_2) = 0$\n    - $\\frac{\\partial L}{\\partial x_2} = 2(x_2 - 2) - \\mu_1 + \\mu_2 = 0$\n2.  **原始可行性**：该点必须满足原始约束条件。\n    - $2x_1^2 - x_2 \\le 0$\n    - $x_2 - x_1^2 - 1 \\le 0$\n3.  **对偶可行性**：不等式约束的拉格朗日乘子必须为非负。\n    - $\\mu_1 \\ge 0$\n    - $\\mu_2 \\ge 0$\n4.  **互补松弛性**：每个乘子与其对应约束函数的乘积必须为零。\n    - $\\mu_1(2x_1^2 - x_2) = 0$\n    - $\\mu_2(x_2 - x_1^2 - 1) = 0$\n\n我们分析平稳性条件。从 $\\frac{\\partial L}{\\partial x_1} = 0$，我们得到两种情况：\n\n**情况 1：$x_1 = 0$**\n如果 $x_1 = 0$，原始可行性约束变为 $0 \\le x_2$ 和 $x_2 \\le 1$。因此，$x_2$ 在区间 $[0, 1]$ 内。\n目标函数变为 $f(0, x_2) = (x_2-2)^2$。我们需要在 $x_2 \\in [0,1]$ 上求此函数的最小值。函数 $(x_2-2)^2$ 是一个顶点（最小值点）在 $x_2=2$ 的抛物线。由于该点在区间 $[0,1]$ 之外，所以区间上的最小值将在离 $x_2=2$ 最近的边界点取得，即 $x_2=1$。\n因此，最优点的候选点之一是 $(0, 1)$。我们来检查它是否满足其他 KKT 条件。\n在点 $(x_1, x_2) = (0, 1)$ 处：\n- $g_1(0, 1) = 2(0)^2 - 1 = -1  0$。第一个约束是非激活的。\n- $g_2(0, 1) = 1 - 0^2 - 1 = 0$。第二个约束是激活的。\n根据互补松弛性，由于 $g_1  0$，我们必须有 $\\mu_1 = 0$。\n现在我们使用第二个平稳性条件：$2(x_2 - 2) - \\mu_1 + \\mu_2 = 0$。\n代入 $(x_1, x_2) = (0, 1)$ 和 $\\mu_1 = 0$：\n$2(1 - 2) - 0 + \\mu_2 = 0 \\implies -2 + \\mu_2 = 0 \\implies \\mu_2 = 2$。\n乘子为 $\\mu_1 = 0$ 和 $\\mu_2 = 2$。两者都满足对偶可行性（$\\ge 0$）。所有 KKT 条件均得到满足。\n点 $(0, 1)$ 是一个 KKT 点。目标函数的值为 $f(0, 1) = 0^2 + (1-2)^2 = 1$。\n\n**情况 2：$1 + 2\\mu_1 - \\mu_2 = 0$**\n这意味着 $\\mu_2 = 1 + 2\\mu_1$。由于 $\\mu_1 \\ge 0$（对偶可行性），可得 $\\mu_2 \\ge 1$。\n因为 $\\mu_2 > 0$，互补松弛性条件 $\\mu_2(x_2 - x_1^2 - 1) = 0$ 要求第二个约束必须是激活的：$x_2 - x_1^2 - 1 = 0$，即 $x_2 = x_1^2 + 1$。\n\n现在，我们考虑第一个约束 $g_1 = 2x_1^2 - x_2 \\le 0$。\n- **子情况 2a：$g_1$ 是非激活的（$2x_1^2 - x_2  0$）。**\n根据互补松弛性，这意味着 $\\mu_1 = 0$。\n使用本情况中的关系式，$\\mu_2 = 1 + 2\\mu_1 = 1 + 2(0) = 1$。\n现在，将 $\\mu_1=0, \\mu_2=1$ 代入第二个平稳性条件：\n$2(x_2 - 2) - 0 + 1 = 0 \\implies 2x_2 - 4 + 1 = 0 \\implies 2x_2 = 3 \\implies x_2 = \\frac{3}{2}$。\n因为我们处于 $g_2$ 激活的子情况中，我们使用 $x_2 = x_1^2 + 1$：\n$\\frac{3}{2} = x_1^2 + 1 \\implies x_1^2 = \\frac{1}{2} \\implies x_1 = \\pm \\frac{1}{\\sqrt{2}} = \\pm \\frac{\\sqrt{2}}{2}$。\n我们来检验我们的假设，即 $g_1$ 对于这些点是非激活的：\n$g_1 = 2x_1^2 - x_2 = 2\\left(\\frac{1}{2}\\right) - \\frac{3}{2} = 1 - \\frac{3}{2} = -\\frac{1}{2}  0$。该假设成立。\n因此我们又得到了两个 KKT 点：$(\\frac{\\sqrt{2}}{2}, \\frac{3}{2})$ 和 $(-\\frac{\\sqrt{2}}{2}, \\frac{3}{2})$。\n这些点的目标函数值为：\n$f(\\pm\\frac{\\sqrt{2}}{2}, \\frac{3}{2}) = (\\pm\\frac{\\sqrt{2}}{2})^2 + (\\frac{3}{2} - 2)^2 = \\frac{2}{4} + (-\\frac{1}{2})^2 = \\frac{1}{2} + \\frac{1}{4} = \\frac{3}{4}$。\n\n- **子情况 2b：$g_1$ 是激活的（$2x_1^2 - x_2 = 0$）。**\n在此子情况中，两个约束都是激活的：$x_2=2x_1^2$ 和 $x_2=x_1^2+1$。\n解这个方程组得到 $2x_1^2 = x_1^2 + 1 \\implies x_1^2 = 1 \\implies x_1 = \\pm 1$。那么 $x_2 = 2(1)^2=2$。\n这些点是 $(1, 2)$ 和 $(-1, 2)$。\n我们来检查平稳性条件。我们有 $\\mu_2 = 1 + 2\\mu_1$。\n当 $x_2=2$ 时，第二个平稳性方程为：\n$2(2 - 2) - \\mu_1 + \\mu_2 = 0 \\implies \\mu_2 = \\mu_1$。\n将此代入 $\\mu_2 = 1 + 2\\mu_1$ 得到 $\\mu_1 = 1 + 2\\mu_1 \\implies -\\mu_1 = 1 \\implies \\mu_1 = -1$。\n这违反了对偶可行性条件 $\\mu_1 \\ge 0$。因此，该子情况不产生任何有效解。\n\n**候选点的比较**\n我们已经找到了三个 KKT 点及其对应的目标函数值：\n1.  $(0, 1)$，其 $f(0, 1) = 1$。\n2.  $(\\frac{\\sqrt{2}}{2}, \\frac{3}{2})$，其 $f(\\frac{\\sqrt{2}}{2}, \\frac{3}{2}) = \\frac{3}{4}$。\n3.  $(-\\frac{\\sqrt{2}}{2}, \\frac{3}{2})$，其 $f(-\\frac{\\sqrt{2}}{2}, \\frac{3}{2}) = \\frac{3}{4}$。\n\n目标函数的最小值是 $\\frac{3}{4}$，在两个点上取得：$(\\frac{\\sqrt{2}}{2}, \\frac{3}{2})$ 和 $(-\\frac{\\sqrt{2}}{2}, \\frac{3}{2})$。\n问题要求提供 $x_1$ 坐标为正的点。这个点是 $(\\frac{\\sqrt{2}}{2}, \\frac{3}{2})$。\n\n最终答案是坐标 $(x_1, x_2) = (\\frac{\\sqrt{2}}{2}, \\frac{3}{2})$。",
            "answer": "$$\\boxed{\\begin{pmatrix} \\frac{\\sqrt{2}}{2}  \\frac{3}{2} \\end{pmatrix}}$$"
        }
    ]
}