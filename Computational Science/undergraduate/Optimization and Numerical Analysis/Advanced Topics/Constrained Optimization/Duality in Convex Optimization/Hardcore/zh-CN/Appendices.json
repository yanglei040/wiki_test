{
    "hands_on_practices": [
        {
            "introduction": "掌握对偶理论的第一步是学习如何从给定的原始问题构建其对偶问题。本练习将通过一个简单但基础的一维二次规划问题，引导你完成这一关键过程。你将学习如何构建拉格朗日函数，并通过将其对原始变量最小化来推导出对偶函数，这是运用对偶方法解决更复杂问题的基础。",
            "id": "2167425",
            "problem": "考虑最小化函数 $f(x) = c x^2$ 的优化问题，其中 $x$ 为实变量。该函数由一个正常数 $c$ 参数化。该优化受限于约束条件，即 $x$ 必须位于闭区间 $[a, b]$ 内，其中 $a$ 和 $b$ 是满足 $a  b$ 的实常数。\n\n你的任务是构建此问题的拉格朗日对偶形式。具体而言，求对偶函数 $g(\\lambda, \\mu)$，其中 $\\lambda$ 是与约束 $a \\le x$ 相关联的拉格朗日乘子，$\\mu$ 是与约束 $x \\le b$ 相关联的拉格朗日乘子。将你的答案 $g(\\lambda, \\mu)$ 表示为关于参数 $a, b, c$ 和对偶变量 $\\lambda, \\mu$ 的函数。",
            "solution": "我们将约束重写为标准不等式形式 $g_{1}(x) = a - x \\le 0$ 和 $g_{2}(x) = x - b \\le 0$。将拉格朗日乘子 $\\lambda \\ge 0$ 与 $g_{1}$ 关联，$\\mu \\ge 0$ 与 $g_{2}$ 关联。拉格朗日函数是\n$$\nL(x,\\lambda,\\mu) = c x^{2} + \\lambda(a - x) + \\mu(x - b) = c x^{2} + (\\mu - \\lambda)x + \\lambda a - \\mu b.\n$$\n对偶函数为 $g(\\lambda,\\mu) = \\inf_{x \\in \\mathbb{R}} L(x,\\lambda,\\mu)$。由于 $c > 0$，$L$ 是关于 $x$ 的严格凸函数。其最小值点满足一阶条件\n$$\n\\frac{\\partial L}{\\partial x} = 2 c x + (\\mu - \\lambda) = 0 \\quad \\Rightarrow \\quad x^{\\ast} = \\frac{\\lambda - \\mu}{2 c}.\n$$\n将 $x^{\\ast}$ 代入 $L$ 中得到\n$$\ng(\\lambda,\\mu) = c \\left(\\frac{\\lambda - \\mu}{2 c}\\right)^{2} + (\\mu - \\lambda)\\left(\\frac{\\lambda - \\mu}{2 c}\\right) + \\lambda a - \\mu b = - \\frac{(\\mu - \\lambda)^{2}}{4 c} + \\lambda a - \\mu b,\n$$\n此式在 $\\lambda \\ge 0$ 和 $\\mu \\ge 0$ 时成立。",
            "answer": "$$\\boxed{-\\frac{(\\mu - \\lambda)^{2}}{4 c} + \\lambda a - \\mu b}$$"
        },
        {
            "introduction": "凸优化问题的解可以被理解为拉格朗日函数的一个鞍点，在该点上，拉格朗日函数在原始变量上达到最小值，在对偶变量上达到最大值。本练习  将帮助你掌握寻找鞍点的方法，并展示它与 Karush-Kuhn-Tucker (KKT) 条件的紧密联系，这些条件是验证和寻找最优解的强大工具。",
            "id": "2167418",
            "problem": "在一个简化的机器学习场景中，与模型参数 $x$ 相关的成本由二次函数 $f(x) = \\frac{1}{2}x^2$ 描述。为防止欠拟合并确保模型具有最低程度的复杂性，一位领域专家施加了一个约束，要求参数 $x$ 必须至少为 2。这导致了一个约束优化问题。\n\n该问题的拉格朗日函数定义为 $L(x, \\lambda) = f(x) + \\lambda g(x)$，其中 $g(x) \\le 0$ 代表不等式约束，$\\lambda \\ge 0$ 是拉格朗日乘子。\n\n你的任务是找到拉格朗日函数的鞍点 $(x^*, \\lambda^*)$。该点对应于在约束条件下最小化成本函数的最优参数值 $x^*$，以及相关的最优拉格朗日乘子 $\\lambda^*$。\n\n将鞍点以有序对 $(x^*, \\lambda^*)$ 的形式报告。",
            "solution": "给定凸二次目标函数 $f(x) = \\frac{1}{2}x^{2}$ 和不等式约束 $x \\geq 2$。为将其表示为标准形式 $g(x) \\leq 0$，定义 $g(x) = 2 - x$，则约束为 $g(x) \\leq 0$。拉格朗日函数为\n$$\nL(x, \\lambda) = \\frac{1}{2}x^{2} + \\lambda(2 - x),\n$$\n对偶可行性条件为 $\\lambda \\geq 0$。\n\n对于带有仿射约束的凸问题，卡鲁什-库恩-塔克 (KKT) 条件是取得最优性和刻画鞍点的充要条件。KKT 条件如下：\n- 原始可行性：$g(x^{*}) \\leq 0$，即 $x^{*} \\geq 2$。\n- 对偶可行性：$\\lambda^{*} \\geq 0$。\n- 平稳性：$\\frac{\\partial L}{\\partial x}(x^{*}, \\lambda^{*}) = 0$。\n- 互补松弛性：$\\lambda^{*} g(x^{*}) = 0$。\n\n计算平稳性条件：\n$$\n\\frac{\\partial L}{\\partial x} = x - \\lambda \\quad \\Rightarrow \\quad x^{*} - \\lambda^{*} = 0 \\quad \\Rightarrow \\quad x^{*} = \\lambda^{*}.\n$$\n应用互补松弛性：\n$$\n\\lambda^{*}(2 - x^{*}) = 0.\n$$\n考虑以下情况：\n- 如果 $\\lambda^{*} = 0$，根据平稳性条件 $x^{*} = 0$，这违反了原始可行性 $x^{*} \\geq 2$；因此排除此情况。\n- 因此 $2 - x^{*} = 0 \\Rightarrow x^{*} = 2$。然后根据平稳性条件 $\\lambda^{*} = x^{*} = 2$，这满足 $\\lambda^{*} \\geq 0$ 和 $x^{*} \\geq 2$。\n\n因此，唯一的 KKT 点是 $(x^{*}, \\lambda^{*}) = (2, 2)$。由于该问题是带有仿射约束的凸问题，这个 KKT 点就是拉格朗日函数的鞍点。等价地，验证鞍点性质：$L(x, 2)$ 在 $x=2$ 处取得最小值，且对于所有 $\\lambda \\geq 0$，有 $L(2, \\lambda) = 2$，对偶问题的最大值在 $\\lambda^{*} = 2$ 处取得。",
            "answer": "$$\\boxed{\\begin{pmatrix} 2  2 \\end{pmatrix}}$$"
        },
        {
            "introduction": "许多实际优化问题涉及多个变量以及等式和不等式约束的组合。本练习  将前面学到的概念应用到一个更贴近实际的场景中。通过解决这个多变量问题，你将学会如何系统地运用拉格朗日函数和 KKT 条件来找到满足所有约束的最优解，从而体会到对偶理论的实际应用价值。",
            "id": "2167392",
            "problem": "考虑一个由两个相互作用的组件组成的系统，其状态由变量 $x_1$ 和 $x_2$ 描述。该系统的运营成本是这些状态的函数，由 $C(x_1, x_2) = (x_1 - 4)^2 + (x_2 - 3)^2$ 给出。该系统受到两个运营约束。首先，一个严格的资源共享协议要求状态之和等于一个常数值，即 $x_1 + x_2 = 5$。其次，一项安全规定对组合状态的大小施加了限制，要求状态的平方和不超过阈值 $M=13$，即 $x_1^2 + x_2^2 \\le 13$。\n\n你的任务是确定最优状态 $(x_1^*, x_2^*)$，该状态在满足两个约束条件的同时最小化运营成本 $C(x_1, x_2)$。\n\n将你的答案表示为 $\\begin{pmatrix} x_1^*  x_2^* \\end{pmatrix}$ 形式的行矩阵。",
            "solution": "我们在凸约束条件下最小化凸二次成本函数。由于可行集是仿射集 $x_{1}+x_{2}=5$ 与圆盘 $x_{1}^{2}+x_{2}^{2}\\leq 13$ 的交集，因此它是凸且非空的。在仿射集上最小化成本函数且位于圆盘内的点是全局最小值点。\n\n首先，我们使用拉格朗日乘子 $\\lambda$ 在等式约束 $x_{1}+x_{2}=5$ 下最小化 $C(x_{1},x_{2})=(x_{1}-4)^{2}+(x_{2}-3)^{2}$。定义\n$$\nL(x_{1},x_{2},\\lambda)=(x_{1}-4)^{2}+(x_{2}-3)^{2}+\\lambda(x_{1}+x_{2}-5).\n$$\n平稳性条件和可行性条件给出\n$$\n\\frac{\\partial L}{\\partial x_{1}}=2(x_{1}-4)+\\lambda=0,\\quad \\frac{\\partial L}{\\partial x_{2}}=2(x_{2}-3)+\\lambda=0,\\quad \\frac{\\partial L}{\\partial \\lambda}=x_{1}+x_{2}-5=0.\n$$\n将前两个方程相减得到\n$$\n2(x_{1}-4)-2(x_{2}-3)=0 \\;\\;\\Rightarrow\\;\\; x_{1}-x_{2}=1.\n$$\n结合 $x_{1}+x_{2}=5$，求解得到\n$$\nx_{1}=\\frac{(x_{1}+x_{2})+(x_{1}-x_{2})}{2}=\\frac{5+1}{2}=3,\\quad x_{2}=\\frac{(x_{1}+x_{2})-(x_{1}-x_{2})}{2}=\\frac{5-1}{2}=2.\n$$\n现在检查不等式约束：\n$$\nx_{1}^{2}+x_{2}^{2}=3^{2}+2^{2}=9+4=13\\leq 13,\n$$\n因此 $(3,2)$ 对两个约束都是可行的。\n\n因为目标函数是严格凸的，且可行集是凸的，所以KKT条件是全局最优性的充分条件。点 $(3,2)$ 也满足完整问题的KKT条件，例如，取不等式乘子 $\\mu=0$：\n- 完整拉格朗日函数 $L=(x_{1}-4)^{2}+(x_{2}-3)^{2}+\\lambda(x_{1}+x_{2}-5)+\\mu(x_{1}^{2}+x_{2}^{2}-13)$ 的平稳性条件：当 $\\mu=0$ 时，该条件简化为只有等式约束的情况，并由 $(3,2)$ 满足。\n- 原始可行性成立：$x_{1}+x_{2}=5$ 且 $x_{1}^{2}+x_{2}^{2}-13=0\\leq 0$。\n- 互补松弛性成立：$\\mu(x_{1}^{2}+x_{2}^{2}-13)=0$。\n- 对偶可行性成立：$\\mu=0\\geq 0$。\n\n因此，唯一的最优状态是 $(x_{1}^{*},x_{2}^{*})=(3,2)$。",
            "answer": "$$\\boxed{\\begin{pmatrix} 3  2 \\end{pmatrix}}$$"
        }
    ]
}