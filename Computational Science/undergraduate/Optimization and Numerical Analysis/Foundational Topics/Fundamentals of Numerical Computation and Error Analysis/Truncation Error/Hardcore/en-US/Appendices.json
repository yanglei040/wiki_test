{
    "hands_on_practices": [
        {
            "introduction": "In many scientific and engineering problems, we need to find the rate of change of a function, but we may only have its values at discrete points. This is where numerical differentiation comes in. This first practice  introduces the forward difference formula, a straightforward method for approximating a derivative. By calculating the difference between the true derivative and the numerical estimate, you will get a tangible feel for what truncation error is and how it arises from simplifying a continuous process.",
            "id": "2224228",
            "problem": "In numerical methods, the derivative of a function at a point can be estimated using finite difference formulas. The forward difference formula provides an approximation for the first derivative of a function $f(x)$ at a point $x$ using a small step size $h$, and is given by the expression:\n$$\nf'(x) \\approx \\frac{f(x+h) - f(x)}{h}\n$$\nThe truncation error is defined as the absolute difference between the true value of the derivative and the value obtained from the numerical approximation.\n\nConsider the function $f(x) = \\exp(2x)$. Your task is to calculate the truncation error when approximating the derivative $f'(x)$ at the point $x=0$, using the forward difference formula with a step size of $h=0.1$.\n\nRound your final answer to four significant figures.",
            "solution": "We are asked to compute the truncation error of the forward difference approximation for the derivative of $f(x)=\\exp(2x)$ at $x=0$ with step size $h=0.1$. The forward difference approximation is\n$$\nf'(x) \\approx \\frac{f(x+h)-f(x)}{h}.\n$$\nThe truncation error is the absolute difference between the true derivative and the approximation:\n$$\n\\text{TE}=\\left|f'(x)-\\frac{f(x+h)-f(x)}{h}\\right|.\n$$\nFor $f(x)=\\exp(2x)$, the exact derivative is\n$$\nf'(x)=2\\exp(2x),\n$$\nso at $x=0$,\n$$\nf'(0)=2\\exp(0)=2.\n$$\nThe forward difference approximation at $x=0$ with $h=0.1$ is\n$$\n\\frac{f(0.1)-f(0)}{0.1}=\\frac{\\exp(2\\cdot 0.1)-\\exp(0)}{0.1}=\\frac{\\exp(0.2)-1}{0.1}=10\\left(\\exp(0.2)-1\\right).\n$$\nTherefore, the truncation error is\n$$\n\\text{TE}=\\left|2-10\\left(\\exp(0.2)-1\\right)\\right|.\n$$\nEvaluating numerically,\n$$\n\\exp(0.2)\\approx 1.2214027581601699,\n$$\nso\n$$\n10\\left(\\exp(0.2)-1\\right)\\approx 10\\cdot 0.2214027581601699=2.214027581601699,\n$$\nand hence\n$$\n\\text{TE}\\approx |2-2.214027581601699|=0.214027581601699.\n$$\nRounding to four significant figures gives\n$$\n0.2140.\n$$",
            "answer": "$$\\boxed{0.2140}$$"
        },
        {
            "introduction": "Just as we approximate derivatives, we often need to compute definite integrals for functions that are difficult or impossible to integrate analytically. This exercise  shifts our focus to numerical integration, specifically using the well-known Simpson's 1/3 rule. Here, you will investigate a fascinating aspect of truncation error: for certain classes of functions, the error is exactly zero. Understanding why this happens provides key insights into the accuracy and limitations of numerical methods.",
            "id": "2224250",
            "problem": "In numerical analysis, Simpson's 1/3 rule is a method for approximating the definite integral of a function. The single-panel Simpson's 1/3 rule approximates the integral of a function $f(x)$ over the interval $[a, b]$ using the following formula:\n$$\n\\int_a^b f(x) \\,dx \\approx \\frac{b-a}{6} \\left[ f(a) + 4f\\left(\\frac{a+b}{2}\\right) + f(b) \\right]\n$$\nThe rule is considered \"exact\" for a given function if the approximation yields the true value of the integral, resulting in a truncation error of zero.\n\nDetermine the degree $N$ of the highest-degree polynomial $P(x)$ for which the single-panel Simpson's 1/3 rule is guaranteed to be exact for any choice of interval $[a, b]$.\n\nA. 1\n\nB. 2\n\nC. 3\n\nD. 4\n\nE. 5",
            "solution": "We use the definition of algebraic degree of exactness: a quadrature rule is exact for all polynomials up to degree $N$ if, for every polynomial $p$ with $\\deg(p) \\le N$, the quadrature output equals the exact integral on any interval $[a,b]$, and it fails for at least one polynomial of degree $N+1$.\n\nLet $m = \\frac{a+b}{2}$. The single-panel Simpson's rule is\n$$S[f] = \\frac{b-a}{6}\\left(f(a) + 4 f(m) + f(b)\\right).$$\nBy linearity, it suffices to test monomials $f(x) = x^k$.\n\n1) For $f(x)=1$:\nExact integral:\n$$ \\int_{a}^{b} 1 \\, dx = b - a. $$\nSimpson:\n$$ S[1] = \\frac{b-a}{6}\\left(1 + 4 \\cdot 1 + 1\\right) = b - a. $$\nExact.\n\n2) For $f(x)=x$:\nExact integral:\n$$ \\int_{a}^{b} x \\, dx = \\frac{b^2-a^2}{2} = \\frac{(b-a)(a+b)}{2}. $$\nSimpson (with $m=\\frac{a+b}{2}$):\n$$ S[x] = \\frac{b-a}{6}\\left(a + 4 m + b\\right) = \\frac{b-a}{6}\\left(a + 2(a+b) + b\\right) = \\frac{b-a}{6}\\left(3a+3b\\right) = \\frac{(b-a)(a+b)}{2}. $$\nExact.\n\n3) For $f(x)=x^2$:\nExact integral:\n$$ \\int_{a}^{b} x^2 \\, dx = \\frac{b^3-a^3}{3} = \\frac{b-a}{3}\\left(a^2 + ab + b^2\\right). $$\nSimpson (with $m^2=\\left(\\frac{a+b}{2}\\right)^2=\\frac{a^2+2ab+b^2}{4}$):\n$$\nS[x^2] = \\frac{b-a}{6}\\left(a^2 + 4 m^2 + b^2\\right) = \\frac{b-a}{6}\\left(a^2 + (a^2+2ab+b^2) + b^2\\right) = \\frac{b-a}{6}\\left(2a^2+2ab+2b^2\\right)\n$$\n$$\n= \\frac{b-a}{3}\\left(a^2+ab+b^2\\right).\n$$\nExact.\n\n4) For $f(x)=x^3$:\nExact integral:\n$$ \\int_{a}^{b} x^3 \\, dx = \\frac{b^4-a^4}{4} = \\frac{b-a}{4}\\left(a^3+a^2b+ab^2+b^3\\right). $$\nSimpson (with $m^3=\\left(\\frac{a+b}{2}\\right)^3=\\frac{a^3+3a^2b+3ab^2+b^3}{8}$):\n$$\nS[x^3] = \\frac{b-a}{6}\\left(a^3 + 4 m^3 + b^3\\right) = \\frac{b-a}{6}\\left(a^3 + \\frac{a^3+3a^2b+3ab^2+b^3}{2} + b^3\\right)\n$$\n$$\n= \\frac{b-a}{6}\\cdot \\frac{3}{2}\\left(a^3+a^2b+ab^2+b^3\\right) = \\frac{b-a}{4}\\left(a^3+a^2b+ab^2+b^3\\right).\n$$\nExact.\n\n5) For $f(x)=x^4$:\nExact integral:\n$$ \\int_{a}^{b} x^4 \\, dx = \\frac{b^5-a^5}{5} = \\frac{b-a}{5}\\left(a^4+a^3b+a^2b^2+ab^3+b^4\\right). $$\nSimpson (with $m^4=\\left(\\frac{a+b}{2}\\right)^4=\\frac{a^4+4a^3b+6a^2b^2+4ab^3+b^4}{16}$):\n$$\nS[x^4] = \\frac{b-a}{6}\\left(a^4 + 4 m^4 + b^4\\right) = \\frac{b-a}{6}\\left(a^4 + \\frac{a^4+4a^3b+6a^2b^2+4ab^3+b^4}{4} + b^4\\right)\n$$\n$$\n= \\frac{b-a}{6}\\left(\\frac{5}{4}(a^4+b^4) + a^3b + \\frac{3}{2}a^2b^2 + ab^3\\right).\n$$\nThis differs from $\\frac{b-a}{5}\\left(a^4+a^3b+a^2b^2+ab^3+b^4\\right)$ in the coefficients (for instance, the coefficient of $a^2b^2$ is $\\frac{3}{2}$ in the Simpson expression but $1$ in the exact integral), hence it is not generally exact for degree $4$.\n\nTherefore, Simpson's one-panel $1/3$ rule is exact for all polynomials up to degree $3$, and not for degree $4$. The highest degree is $N=3$, corresponding to option C.",
            "answer": "$$\\boxed{C}$$"
        },
        {
            "introduction": "Our final practice moves from analyzing error to proactively controlling it, a common task in computational science and software engineering. When approximating functions like $\\cos(x)$ using a series expansion, we must decide how many terms to use to achieve a desired accuracy without wasting computational resources. This problem  guides you through using the theoretical bounds on truncation error to determine the minimum complexity needed to guarantee a specific level of precision, a fundamental skill for building reliable numerical tools.",
            "id": "2224270",
            "problem": "A scientific computing library is being developed to perform high-precision calculations. One of its core functions needs to compute the cosine of a small angle, $\\cos(x)$, by using its Maclaurin series expansion. To optimize for speed while maintaining a specified accuracy, the function will be implemented using a fixed number of terms from the series.\n\nYour task is to determine the minimum number of non-zero terms of the Maclaurin series for $\\cos(x)$ that are required to approximate the value of $\\cos(0.5)$ such that the absolute value of the truncation error is guaranteed to be less than $10^{-7}$.",
            "solution": "The Maclaurin series for the cosine function is\n$$\n\\cos(x)=\\sum_{n=0}^{\\infty}(-1)^{n}\\frac{x^{2n}}{(2n)!}.\n$$\nLet the partial sum with the first $m+1$ non-zero terms be $S_m(x)$ and the remainder be $R_m(x)$:\n$$\nS_m(x)=\\sum_{n=0}^{m}(-1)^{n}\\frac{x^{2n}}{(2n)!},\\quad R_m(x)=\\cos(x)-S_m(x).\n$$\nFor $x=\\frac{1}{2}$, the terms $a_n=\\frac{(1/2)^{2n}}{(2n)!}$ form a positive, strictly decreasing sequence because\n$$\n\\frac{a_{n+1}}{a_n}=\\frac{(1/2)^2}{(2n+2)(2n+1)}=\\frac{1}{4(2n+2)(2n+1)}<1 \\quad \\text{for all } n\\geq 0.\n$$\nThus, by the Alternating Series Remainder Theorem,\n$$\n|R_m(1/2)| \\le a_{m+1} = \\frac{(1/2)^{2(m+1)}}{(2(m+1))!}.\n$$\nWe seek the smallest integer $m$ such that $a_{m+1}  1 \\times 10^{-7}$. Compute successive candidates for $a_{m+1}$:\nFor $m=2$ (3 terms used), the error is bounded by the next term, $a_3$:\n$$\na_3 = \\frac{(1/2)^6}{6!} = \\frac{1}{64\\cdot 720} = \\frac{1}{46080}.\n$$\nSince $46080  10^7$, it follows that\n$$\na_3 = \\frac{1}{46080} > \\frac{1}{10^7} = 1 \\times 10^{-7},\n$$\nso $m=2$ (three terms) is not sufficient. Next, for $m=3$ (4 terms used), the error is bounded by $a_4$:\n$$\na_4 = \\frac{(1/2)^8}{8!} = \\frac{1}{256\\cdot 40320} = \\frac{1}{10321920}.\n$$\nSince $10321920 > 10^7$, it follows that\n$$\na_4 = \\frac{1}{10321920}  \\frac{1}{10^7} = 1 \\times 10^{-7}.\n$$\nTherefore, using the terms up to $m=3$ guarantees $|R_3(1/2)|  1 \\times 10^{-7}$. Because $m=2$ fails while $m=3$ succeeds, the minimum number of non-zero terms required is $m+1=4$.",
            "answer": "$$\\boxed{4}$$"
        }
    ]
}