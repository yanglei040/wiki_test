{
    "hands_on_practices": [
        {
            "introduction": "One of the most intuitive ways to check if an iterative solver is finished is to measure the size of the residual vector, $r_k = b - Ax_k$. If the residual is small, it seems the equation is nearly satisfied. This exercise  challenges that simple intuition by exploring a critical weakness: the absolute residual norm is not scale-invariant. You will see firsthand how simply multiplying a linear system by a constant, an algebraically trivial operation, can change whether the stopping criterion is met, motivating the need for more robust, relative measures.",
            "id": "2206933",
            "problem": "In the field of numerical linear algebra, iterative methods are often used to find approximate solutions to a system of linear equations of the form $Ax = b$. A crucial part of these algorithms is the stopping criterion, which determines when the approximate solution is \"good enough.\"\n\nConsider a linear system defined by the matrix $A$ and the vector $b$:\n$$\nA = \\begin{pmatrix} 3  -1 \\\\ 1  2 \\end{pmatrix}, \\quad b = \\begin{pmatrix} 5 \\\\ 5 \\end{pmatrix}\n$$\nAn iterative solver has produced an approximate solution $x_k$:\n$$\nx_k = \\begin{pmatrix} 2.1 \\\\ 1.2 \\end{pmatrix}\n$$\nA common stopping criterion is based on the Euclidean norm (L2-norm) of the residual vector, $r_k = b - Ax_k$. The iteration stops if $\\|r_k\\|_2  \\epsilon$, where the Euclidean norm of a vector $v = (v_1, v_2, \\dots, v_n)^T$ is defined as $\\|v\\|_2 = \\sqrt{v_1^2 + v_2^2 + \\dots + v_n^2}$. For this problem, let the tolerance be $\\epsilon = 0.4$.\n\nNow, consider a second linear system, $A'x = b'$, which is derived by scaling the original system by a factor of $c=5$. Thus, $A' = cA$ and $b' = cb$. We will test the same approximate solution $x_k$ against this scaled system using the same stopping criterion, $\\|r'_k\\|_2  \\epsilon$, where $r'_k = b' - A'x_k$.\n\nWhich of the following statements is true regarding the application of the stopping criterion to these two systems with the approximate solution $x_k$?\n\nA. The criterion is met for the original system but is not met for the scaled system.\n\nB. The criterion is not met for the original system but is met for the scaled system.\n\nC. The criterion is met for both the original system and the scaled system.\n\nD. The criterion is not met for either the original system or the scaled system.\n\nE. The outcome is identical for both systems, as scaling does not affect whether the criterion is met.",
            "solution": "We compute the residual for the original system. With $A=\\begin{pmatrix} 3  -1 \\\\ 1  2 \\end{pmatrix}$, $b=\\begin{pmatrix} 5 \\\\ 5 \\end{pmatrix}$, and $x_{k}=\\begin{pmatrix} 2.1 \\\\ 1.2 \\end{pmatrix}=\\begin{pmatrix} \\frac{21}{10} \\\\ \\frac{6}{5} \\end{pmatrix}$, first evaluate\n$$\nA x_{k}\n=\n\\begin{pmatrix}\n3  -1 \\\\\n1  2\n\\end{pmatrix}\n\\begin{pmatrix}\n\\frac{21}{10} \\\\\n\\frac{6}{5}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n3\\cdot\\frac{21}{10}-1\\cdot\\frac{6}{5} \\\\\n1\\cdot\\frac{21}{10}+2\\cdot\\frac{6}{5}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\frac{63}{10}-\\frac{12}{10} \\\\\n\\frac{21}{10}+\\frac{24}{10}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n\\frac{51}{10} \\\\\n\\frac{45}{10}\n\\end{pmatrix}.\n$$\nThus the residual is\n$$\nr_{k}=b-Ax_{k}\n=\n\\begin{pmatrix}\n5 \\\\\n5\n\\end{pmatrix}\n-\n\\begin{pmatrix}\n\\frac{51}{10} \\\\\n\\frac{45}{10}\n\\end{pmatrix}\n=\n\\begin{pmatrix}\n-\\frac{1}{10} \\\\\n\\frac{1}{2}\n\\end{pmatrix}.\n$$\nIts Euclidean norm satisfies\n$$\n\\|r_{k}\\|_{2}^{2}=\\left(-\\frac{1}{10}\\right)^{2}+\\left(\\frac{1}{2}\\right)^{2}=\\frac{1}{100}+\\frac{1}{4}=\\frac{26}{100}=\\frac{13}{50},\n$$\nso\n$$\n\\|r_{k}\\|_{2}=\\sqrt{\\frac{13}{50}}.\n$$\nWith tolerance $\\epsilon=0.4=\\frac{2}{5}$, compare squares:\n$$\n\\|r_{k}\\|_{2}^{2}=\\frac{13}{50} \\quad\\text{and}\\quad \\epsilon^{2}=\\left(\\frac{2}{5}\\right)^{2}=\\frac{4}{25}=\\frac{8}{50}.\n$$\nSince $\\frac{13}{50}\\frac{8}{50}$, it follows that $\\|r_{k}\\|_{2}\\epsilon$, so the stopping criterion is not met for the original system.\n\nFor the scaled system with $c=5$, we have $A'=cA$ and $b'=cb$. The residual is\n$$\nr'_{k}=b'-A'x_{k}=cb-cAx_{k}=c(b-Ax_{k})=c\\,r_{k},\n$$\nhence the norm scales linearly:\n$$\n\\|r'_{k}\\|_{2}=|c|\\,\\|r_{k}\\|_{2}=5\\sqrt{\\frac{13}{50}}.\n$$\nBecause $5\\sqrt{\\frac{13}{50}}\\sqrt{\\frac{13}{50}}\\frac{2}{5}$, the stopping criterion is also not met for the scaled system. Therefore, the correct choice is that the criterion is not met for either system.",
            "answer": "$$\\boxed{D}$$"
        },
        {
            "introduction": "When an algorithm converges, we expect our iterate $x_k$ to get closer to the true root $x^*$, and we expect the function value $f(x_k)$ to get closer to zero. But what happens when the function is extremely steep near its root? This practice  presents a scenario where a small step size $|x_k - x_{k-1}|$ and a small residual $|f(x_k)|$ can tell conflicting stories about convergence. This forces us to consider what we truly mean by \"close enough\" and to appreciate the distinct roles of step-size-based and residual-based criteria.",
            "id": "2206929",
            "problem": "In numerical analysis, iterative methods are used to approximate solutions to equations. A crucial aspect of these methods is the stopping criterion, which determines when the algorithm has found a sufficiently accurate answer. Different criteria can behave differently depending on the nature of the problem. This problem explores the behavior of two common stopping criteria for a function with a rapidly changing slope near its root.\n\nConsider the task of finding the root of the function $f(x) = \\exp(10x) - 1000$ using Newton's method, which is defined by the iterative formula $x_{k+1} = x_k - \\frac{f(x_k)}{f'(x_k)}$. Start with an initial guess of $x_0 = 1.0$.\n\nTwo different stopping criteria are proposed:\n- **Criterion A (Residual-based)**: The algorithm stops if $|f(x_k)|  10.0$.\n- **Criterion B (Step size-based)**: The algorithm stops if $|x_k - x_{k-1}|  0.001$. This criterion is checked starting from $k=1$.\n\nThe algorithm terminates at the first iteration $k \\ge 1$ for which a criterion is met. Determine the iteration number at which each criterion is satisfied and select the correct statement from the options below.\n\nA. Criterion A stops at $k=5$, and Criterion B stops at $k=6$. Criterion A stops first.\n\nB. Criterion A stops at $k=6$, and Criterion B stops at $k=5$. Criterion B stops first.\n\nC. Both criteria stop at $k=5$.\n\nD. Both criteria stop at $k=6$.\n\nE. Criterion A stops at $k=4$, and Criterion B stops at $k=7$. Criterion A stops first.",
            "solution": "We are solving for a root of $f(x)=\\exp(10x)-1000$ by Newtonâ€™s method\n$$\nx_{k+1}=x_{k}-\\frac{f(x_{k})}{f'(x_{k})},\\quad f'(x)=10\\exp(10x).\n$$\nHence the explicit iteration is\n$$\nx_{k+1}=x_{k}-\\frac{\\exp(10x_{k})-1000}{10\\exp(10x_{k})}\n=x_{k}-\\frac{1}{10}+\\frac{100}{\\exp(10x_{k})}.\n$$\nThe exact root is $x^{\\star}=\\frac{3\\ln 10}{10}$ since $\\exp(10x^{\\star})=1000$.\n\nWe start with $x_{0}=1.0$ and iterate, evaluating the two stopping criteria:\n- Criterion A: stop at the first $k\\geq 1$ with $|f(x_{k})|10$.\n- Criterion B: stop at the first $k\\geq 1$ with $|x_{k}-x_{k-1}|0.001$.\nNote that the Newton step is $s_{k}:=x_{k+1}-x_{k}=-\\frac{f(x_{k})}{f'(x_{k})}=-\\frac{1}{10}+\\frac{100}{\\exp(10x_{k})}$.\n\nStep from $k=0$ to $k=1$:\n$$\nx_{1}=x_{0}-\\frac{1}{10}+100\\exp(-10)\\approx 1-\\frac{1}{10}+0.004539992976\\approx 0.904539992976.\n$$\nThen $|x_{1}-x_{0}|\\approx 9.5460007024\\times 10^{-2}0.001$, and\n$$\nf(x_{1})=\\exp(10x_{1})-1000\\approx 8.479442089\\times 10^{3}-1000\\approx 7.479442089\\times 10^{3}10.\n$$\nNeither criterion is satisfied at $k=1$.\n\nStep from $k=1$ to $k=2$:\n$$\nx_{2}=x_{1}-\\frac{1}{10}+\\frac{100}{\\exp(10x_{1})}\\approx 0.904539992976-0.1+\\frac{100}{8.479442089\\times 10^{3}}\\approx 0.816333970.\n$$\nThen $|x_{2}-x_{1}|\\approx 8.8206023\\times 10^{-2}0.001$, and\n$$\nf(x_{2})\\approx \\exp(8.163339699)-1000\\approx 3.509899\\times 10^{3}-1000\\approx 2.509899\\times 10^{3}10.\n$$\nNeither criterion is satisfied at $k=2$.\n\nStep from $k=2$ to $k=3$:\n$$\nx_{3}=x_{2}-\\frac{1}{10}+\\frac{100}{\\exp(10x_{2})}\\approx 0.816333970-0.1+\\frac{100}{3.509899\\times 10^{3}}\\approx 0.744826870.\n$$\nThen $|x_{3}-x_{2}|\\approx 7.15071\\times 10^{-2}0.001$, and\n$$\nf(x_{3})\\approx \\exp(7.4482687)-1000\\approx 1.71686\\times 10^{3}-1000\\approx 7.1686\\times 10^{2}10.\n$$\nNeither criterion is satisfied at $k=3$.\n\nStep from $k=3$ to $k=4$:\n$$\nx_{4}=x_{3}-\\frac{1}{10}+\\frac{100}{\\exp(10x_{3})}\\approx 0.744826870-0.1+\\frac{100}{1.71686\\times 10^{3}}\\approx 0.703078870.\n$$\nThen $|x_{4}-x_{3}|\\approx 4.1748\\times 10^{-2}0.001$, and\n$$\nf(x_{4})\\approx \\exp(7.0307887)-1000\\approx 1.1309226\\times 10^{3}-1000\\approx 1.309226\\times 10^{2}10.\n$$\nNeither criterion is satisfied at $k=4$.\n\nStep from $k=4$ to $k=5$:\n$$\nx_{5}=x_{4}-\\frac{1}{10}+\\frac{100}{\\exp(10x_{4})}\\approx 0.703078870-0.1+\\frac{100}{1.1309226\\times 10^{3}}\\approx 0.691501970.\n$$\nTo evaluate Criterion A precisely, write $10x_{5}=6.9150197$ and note $\\ln(1000)=3\\ln 10\\approx 6.907755278982137$. Hence\n$$\nd:=10x_{5}-\\ln(1000)\\approx 0.007264421,\\quad \\exp(10x_{5})=1000\\,\\exp(d),\n$$\nso\n$$\nf(x_{5})=1000(\\exp(d)-1)\\approx 1000\\left(d+\\frac{d^{2}}{2}+\\frac{d^{3}}{6}\\right)\\approx 1000\\left(0.007264421+2.6396\\times 10^{-5}+6.4\\times 10^{-8}\\right)\\approx 7.29088.\n$$\nThus $|f(x_{5})|\\approx 7.2908810$, so Criterion A is satisfied at $k=5$. Meanwhile $|x_{5}-x_{4}|=|s_{4}|\\approx 1.15769\\times 10^{-2}0.001$, so Criterion B is not yet met at $k=5$.\n\nStep from $k=5$ to $k=6$ (for Criterion B):\nUsing $s_{5}=-\\frac{f(x_{5})}{f'(x_{5})}$ with $f'(x_{5})=10\\exp(10x_{5})\\approx 10\\times 1000\\exp(d)\\approx 10072.9088$, we get\n$$\n|x_{6}-x_{5}|=|s_{5}|=\\left|\\frac{f(x_{5})}{f'(x_{5})}\\right|\\approx \\frac{7.29088}{10072.9088}\\approx 7.23\\times 10^{-4}0.001.\n$$\nTherefore Criterion B is satisfied at $k=6$.\n\nConclusion: Criterion A first holds at $k=5$, and Criterion B first holds at $k=6$. Thus the correct option is A.",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "A fundamental assumption of many stopping criteria is that the algorithm is, in fact, approaching a single, stable solution. But what happens if it doesn't? This exercise  explores a common failure mode where an iterative process falls into a period-2 cycle, alternating indefinitely between two distinct states. You will see why the standard criterion, $|P_k - P_{k-1}|  \\epsilon$, is insufficient here and learn how to design a simple, effective check to detect this oscillatory behavior and prevent an infinite loop.",
            "id": "2206874",
            "problem": "An engineering team is designing an automated inventory management system for a manufacturing company. The system adjusts the weekly production quantity, denoted by $P_k$ for week $k$, based on a complex predictive model of sales and supply chain dynamics. The production for week $k+1$ is determined by a function of the production in week $k$, following the iterative rule $P_{k+1} = f(P_k)$, starting from an initial production plan $P_0$.\n\nThe system is intended to run until the production level stabilizes, meaning the sequence of iterates $P_k$ converges to a steady-state value. The standard termination condition for this is $|P_k - P_{k-1}|  \\epsilon$ for a given small tolerance $\\epsilon > 0$.\n\nHowever, during testing, the team observes that for certain market parameters, the algorithm fails to converge. Instead, it enters a stable period-2 cycle, where the production level alternates indefinitely between two distinct values, $P_A$ and $P_B$ (i.e., the sequence of iterates becomes $\\dots, P_A, P_B, P_A, P_B, \\dots$). This oscillatory behavior is undesirable as it can lead to inefficient resource allocation.\n\nTo prevent the system from running indefinitely in such a loop, a new termination criterion must be added to the algorithm. Which of the following logical conditions, when checked at each step $k$ (for $k \\geq 2$), would correctly identify that the process has entered a period-2 cycle and allow the algorithm to halt?\n\nA. Terminate if $|P_k - P_{k-2}|  \\epsilon$.\n\nB. Terminate if $|P_k - P_{k-1}|  \\epsilon$.\n\nC. Terminate if $|P_k + P_{k-1}|  \\epsilon$.\n\nD. Terminate if $|P_{k-1} - P_{k-2}|  \\epsilon$.\n\nE. Modify the state by setting $P_k \\leftarrow \\frac{1}{2}(P_k + P_{k-1})$ and continue the iteration.",
            "solution": "We consider the iteration defined by $P_{k+1}=f(P_k)$ starting from $P_0$. A fixed point $P^{\\ast}$ satisfies $f(P^{\\ast})=P^{\\ast}$, and the usual convergence termination checks $|P_k-P_{k-1}|\\epsilon$ detect approach to such a fixed point.\n\nA period-2 cycle occurs when there exist distinct values $P_A$ and $P_B$ such that\n$$\nf(P_A)=P_B,\\quad f(P_B)=P_A,\\quad P_A\\ne P_B.\n$$\nIf the sequence enters this 2-cycle, then it alternates as $P_A,P_B,P_A,P_B,\\ldots$, which implies for all $k\\geq 2$,\n$$\nP_k=P_{k-2}.\n$$\nTherefore, an exact period-2 cycle is characterized by $|P_k-P_{k-2}|=0$, and in a numerical implementation with tolerance $\\epsilon0$, a correct detection condition is\n$$\n|P_k-P_{k-2}|\\epsilon.\n$$\n\nWe now evaluate the options:\n- Option A checks $|P_k-P_{k-2}|\\epsilon$, which precisely detects a period-2 alternation since in a 2-cycle $P_k=P_{k-2}$ holds. This also (harmlessly) triggers in the fixed-point case because then $P_k\\approx P_{k-1}\\approx P_{k-2}$.\n- Option B checks $|P_k-P_{k-1}|\\epsilon$, which is the fixed-point criterion; in a period-2 cycle $|P_k-P_{k-1}|=|P_A-P_B|$, which need not be small and thus will typically fail to detect the 2-cycle.\n- Option C checks $|P_k+P_{k-1}|\\epsilon$, which would only detect a special case where $P_B\\approx -P_A$ with equal magnitudes; this is not a general property of period-2 cycles.\n- Option D checks $|P_{k-1}-P_{k-2}|\\epsilon$, equivalent to option B but one step earlier; it detects fixed-point convergence and not a generic 2-cycle.\n- Option E modifies the iteration by averaging $P_k$ and $P_{k-1}$; it is not a detection or termination condition and does not directly identify a 2-cycle.\n\nHence, the correct termination condition to detect entry into a period-2 cycle is option A.",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}