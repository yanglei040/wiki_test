{
    "hands_on_practices": [
        {
            "introduction": "This first exercise provides a foundational workout in applying the formal definition of a relative condition number. We will analyze the problem of computing $x$ from a given measurement $y$ based on the model $y = \\exp(x)$, which is equivalent to computing $x = \\ln(y)$. By deriving the condition number from first principles, you will gain a concrete understanding of how a problem's sensitivity is not uniform but depends critically on the input value, leading to the practical concept of ill-conditioning .",
            "id": "3216377",
            "problem": "A scalar measurement-to-solution problem is given by the model $y = \\exp(x)$ with $y > 0$, where the computational task is to determine $x$ from a given $y$. Using the definition of the relative condition number based on first-order perturbation analysis, derive an explicit expression for the relative condition number $\\kappa(y)$ of the mapping $y \\mapsto x$. Clearly state the domain where your expression applies, and identify for which values of $y$ this problem is ill-conditioned in the sense that small relative perturbations in $y$ can cause large relative perturbations in $x$. Give your final answer as a single symbolic expression for $\\kappa(y)$.",
            "solution": "The problem requires the derivation of the relative condition number for the computational task of determining $x$ from a given $y$, based on the model $y = \\exp(x)$.\n\nFirst, we must formalize the problem. The task is to compute $x$ as a function of $y$. We can express the relationship as $x = f(y)$. From the given model $y = \\exp(x)$, we can solve for $x$ by taking the natural logarithm of both sides:\n$$x = \\ln(y)$$\nThus, the function we are analyzing is $f(y) = \\ln(y)$. The domain of this function is $y > 0$, which is consistent with the problem statement.\n\nThe relative condition number, $\\kappa(y)$, of a problem $x = f(y)$ is defined based on first-order perturbation analysis. It quantifies the sensitivity of the relative error in the output $x$ to the relative error in the input $y$. For a small perturbation $\\delta y$ in the input, the corresponding perturbation in the output $\\delta x$ is approximated by $\\delta x \\approx f'(y) \\delta y$. The relative condition number is the magnitude of the ratio of the relative change in the output to the relative change in the input, in the limit of infinitesimal perturbations:\n$$ \\kappa(y) = \\frac{|\\delta x / x|}{|\\delta y / y|} = \\left| \\frac{\\delta x}{\\delta y} \\frac{y}{x} \\right| $$\nIn the limit $\\delta y \\to 0$, the ratio $\\frac{\\delta x}{\\delta y}$ becomes the derivative $f'(y)$. Substituting $x = f(y)$, the formula becomes:\n$$ \\kappa(y) = \\left| f'(y) \\frac{y}{f(y)} \\right| = \\left| \\frac{y f'(y)}{f(y)} \\right| $$\nTo apply this formula, we need to compute the derivative of $f(y) = \\ln(y)$. The derivative is:\n$$ f'(y) = \\frac{d}{dy}(\\ln(y)) = \\frac{1}{y} $$\nNow we substitute $f(y) = \\ln(y)$ and $f'(y) = \\frac{1}{y}$ into the expression for the condition number:\n$$ \\kappa(y) = \\left| \\frac{y \\left(\\frac{1}{y}\\right)}{\\ln(y)} \\right| $$\nSimplifying the expression in the numerator gives:\n$$ \\kappa(y) = \\left| \\frac{1}{\\ln(y)} \\right| $$\nThis is the explicit expression for the relative condition number of the mapping $y \\mapsto x$.\n\nThe domain where this expression applies is determined by the domains of the functions involved. The function $f(y) = \\ln(y)$ is defined for all $y > 0$. The expression for $\\kappa(y)$ has $\\ln(y)$ in the denominator, so it is undefined when $\\ln(y) = 0$. This occurs at $y = 1$. Therefore, the domain of the expression for $\\kappa(y)$ is $y \\in (0, 1) \\cup (1, \\infty)$.\n\nA problem is considered ill-conditioned if its condition number is very large, i.e., $\\kappa(y) \\gg 1$. This implies that small relative perturbations in the input $y$ can cause large relative perturbations in the output $x$. We must identify the values of $y$ for which $\\kappa(y)$ is large.\n$$ \\kappa(y) = \\left| \\frac{1}{\\ln(y)} \\right| $$\nThe value of $\\kappa(y)$ is large when the magnitude of its denominator, $|\\ln(y)|$, is small (close to $0$). The function $\\ln(y)$ approaches $0$ as $y$ approaches $1$.\n$$ \\lim_{y \\to 1} \\kappa(y) = \\lim_{y \\to 1} \\left| \\frac{1}{\\ln(y)} \\right| = \\infty $$\nTherefore, the problem is ill-conditioned for values of $y$ that are close to $1$. For such values, a small relative error in the measurement $y$ will be significantly amplified in the computed value of $x = \\ln(y)$. This makes intuitive sense: when $y$ is close to $1$, $x$ is close to $0$. The relative error in $x$, which is $\\frac{\\delta x}{x}$, becomes very sensitive to any non-zero absolute error $\\delta x$ when $x$ is near $0$.",
            "answer": "$$\\boxed{\\left| \\frac{1}{\\ln(y)} \\right|}$$"
        },
        {
            "introduction": "Building on the foundational concept of conditioning, this practice explores the crucial distinction between an ill-conditioned *problem* and an unstable *algorithm*. You will analyze the evaluation of the function $f(x) = \\sqrt{1+x}-1$ for values of $x$ near zero. This exercise will guide you to discover that while the problem itself is inherently well-conditioned, a naive computational approach leads to catastrophic loss of accuracy, demonstrating the vital importance of choosing a numerically stable algorithm for computation .",
            "id": "3216339",
            "problem": "Consider the scalar computational problem of evaluating the function $f(x)=\\sqrt{1+x}-1$ for inputs $x$ in the domain $x>-1$ with $x$ near $0$. Your goal is to assess how sensitive the problem is to small perturbations in $x$ and to identify an algebraically equivalent formulation that mitigates loss of significance due to subtractive cancellation. Work from first principles: use the definition of conditioning as the ratio between relative output change and relative input change in the limit of vanishing perturbations, and use the differential relationship between small changes in input and output. Do not assume any pre-derived condition-number formula.\n\nTasks:\n- Derive the absolute conditioning of the problem at a point $x$ by relating an infinitesimal change $\\mathrm{d}x$ in the input to the corresponding change $\\mathrm{d}f$ in the output.\n- Derive the relative conditioning of the problem at a point $x$ by forming the ratio of relative output change to relative input change in the limit $\\mathrm{d}x \\to 0$.\n- Explain why the direct expression $f(x)=\\sqrt{1+x}-1$ suffers from catastrophic cancellation for small $x$, and construct an algebraically equivalent expression for $f(x)$ that avoids subtracting nearly equal numbers. Justify your construction by referencing elementary algebraic identities.\n- Using the standard first-order floating-point error model with unit roundoff $u$ (that is, each basic arithmetic operation on real numbers returns a result of the exact value multiplied by a factor $(1+\\delta)$ with $|\\delta|\\le u$), compare the leading-order behavior of the relative forward error of the direct expression and of your stable expression as $x \\to 0$.\n- As your final answer, provide the simplified closed-form expression for the relative condition number as a function of $x$.\n\nNo numerical approximation is required; express your final answer as a single exact analytic expression with no units.",
            "solution": "First, we derive the absolute conditioning of the problem. Absolute conditioning relates an absolute change in the input to the corresponding absolute change in the output. For a differentiable scalar function $f(x)$, an infinitesimal change in input, $\\mathrm{d}x$, leads to an infinitesimal change in output, $\\mathrm{d}f$, given by the first-order approximation $\\mathrm{d}f = f'(x) \\mathrm{d}x$. The absolute condition number, $\\kappa_{abs}(x)$, is the magnitude of the sensitivity of the output to this change, which is $|f'(x)|$.\nThe function is $f(x) = (1+x)^{1/2} - 1$. Its derivative with respect to $x$ is:\n$$ f'(x) = \\frac{\\mathrm{d}}{\\mathrm{d}x} \\left( (1+x)^{1/2} - 1 \\right) = \\frac{1}{2} (1+x)^{-1/2} = \\frac{1}{2\\sqrt{1+x}} $$\nSince the domain is $x > -1$, the term $\\sqrt{1+x}$ is real and positive, so we do not need an absolute value for $f'(x)$.\nThe absolute condition number is:\n$$ \\kappa_{abs}(x) = |f'(x)| = \\frac{1}{2\\sqrt{1+x}} $$\nFor $x$ near $0$, $\\kappa_{abs}(x) \\approx \\frac{1}{2}$. This indicates that small absolute errors in $x$ are not amplified significantly, suggesting the problem is well-conditioned in an absolute sense.\n\nNext, we derive the relative conditioning of the problem. The relative condition number, $\\kappa_{rel}(x)$, is defined as the limiting ratio of the relative change in the output to the relative change in the input.\n$$ \\kappa_{rel}(x) = \\lim_{\\Delta x \\to 0} \\frac{|\\Delta f / f(x)|}{|\\Delta x / x|} = \\frac{|\\mathrm{d}f / f(x)|}{|\\mathrm{d}x / x|} = \\left| \\frac{\\mathrm{d}f}{\\mathrm{d}x} \\cdot \\frac{x}{f(x)} \\right| = |f'(x)| \\left| \\frac{x}{f(x)} \\right| $$\nSubstituting the expressions for $f'(x)$ and $f(x)$:\n$$ \\kappa_{rel}(x) = \\left| \\frac{1}{2\\sqrt{1+x}} \\cdot \\frac{x}{\\sqrt{1+x}-1} \\right| $$\nThis expression is indeterminate for $x=0$ and appears to grow large for small $x$. However, we can simplify it by multiplying the numerator and denominator by the conjugate of the term in the denominator, which is $\\sqrt{1+x}+1$:\n$$ \\kappa_{rel}(x) = \\left| \\frac{1}{2\\sqrt{1+x}} \\cdot \\frac{x}{\\sqrt{1+x}-1} \\cdot \\frac{\\sqrt{1+x}+1}{\\sqrt{1+x}+1} \\right| = \\left| \\frac{x(\\sqrt{1+x}+1)}{2\\sqrt{1+x} \\left( (\\sqrt{1+x})^2 - 1^2 \\right)} \\right| $$\n$$ \\kappa_{rel}(x) = \\left| \\frac{x(\\sqrt{1+x}+1)}{2\\sqrt{1+x} (1+x-1)} \\right| = \\left| \\frac{x(\\sqrt{1+x}+1)}{2x\\sqrt{1+x}} \\right| $$\nFor $x \\neq 0$, we can cancel the factor of $x$:\n$$ \\kappa_{rel}(x) = \\left| \\frac{\\sqrt{1+x}+1}{2\\sqrt{1+x}} \\right| $$\nSince $x > -1$, both the numerator and denominator are positive, so the absolute value is redundant. The final simplified form for the relative condition number is:\n$$ \\kappa_{rel}(x) = \\frac{\\sqrt{1+x}+1}{2\\sqrt{1+x}} $$\nTo evaluate the conditioning near $x=0$, we take the limit:\n$$ \\lim_{x \\to 0} \\kappa_{rel}(x) = \\lim_{x \\to 0} \\frac{\\sqrt{1+x}+1}{2\\sqrt{1+x}} = \\frac{\\sqrt{1+0}+1}{2\\sqrt{1+0}} = \\frac{1+1}{2} = 1 $$\nA relative condition number of approximately $1$ indicates that the problem of computing $f(x)$ is inherently well-conditioned for $x$ near $0$. The relative error in the output should be about the same magnitude as the relative error in the input.\n\nThe issue of \"loss of significance\" arises not from the problem's conditioning but from the specific computational algorithm used. The direct expression $f(x) = \\sqrt{1+x}-1$ suffers from catastrophic cancellation when evaluated in floating-point arithmetic for $x$ near $0$. In this case, $1+x$ is slightly greater than $1$, so $\\sqrt{1+x}$ is a number very close to $1$. The subtraction $\\sqrt{1+x}-1$ involves two nearly equal numbers. In floating-point representation, the leading significant digits of these two numbers are identical and cancel out, leaving a result dominated by the less significant digits, which are contaminated by rounding errors from the previous steps (like computing the square root). This leads to a severe loss of relative accuracy.\n\nTo create a stable algorithm, we must find an algebraically equivalent expression that avoids this subtraction. The simplification used to derive the condition number provides such an expression. By multiplying by the conjugate, we found:\n$$ f(x) = (\\sqrt{1+x}-1) \\cdot \\frac{\\sqrt{1+x}+1}{\\sqrt{1+x}+1} = \\frac{(1+x)-1}{\\sqrt{1+x}+1} = \\frac{x}{\\sqrt{1+x}+1} $$\nThis alternate form, let's call it $g(x) = \\frac{x}{\\sqrt{1+x}+1}$, is algebraically equivalent to $f(x)$ for all $x \\in (-1, \\infty)$. Computationally, it is far superior for small $x$. For $x \\approx 0$, the denominator $\\sqrt{1+x}+1$ is approximately $2$. The expression involves an addition and a division, neither of which causes loss of significance in this context.\n\nFinally, we compare the forward error propagation. Let $\\text{fl}(\\cdot)$ denote the result of a floating-point computation, and let $u$ be the unit roundoff. Each basic arithmetic operation introduces a relative error of at most $u$.\n\nFor the unstable form $f(x) = \\sqrt{1+x}-1$, the main error comes from evaluating the square root and then the subtraction. Let the computed value of the square root be $\\hat{y} = \\text{fl}(\\sqrt{1+x}) = \\sqrt{1+x}(1+\\epsilon)$, where $|\\epsilon| \\lesssim u$. The final computed result is $\\hat{f}(x) = \\text{fl}(\\hat{y}-1) = (\\hat{y}-1)(1+\\delta) = (\\sqrt{1+x}(1+\\epsilon)-1)(1+\\delta)$, where $|\\delta| \\le u$.\n$$ \\hat{f}(x) = (\\sqrt{1+x}-1 + \\epsilon\\sqrt{1+x})(1+\\delta) \\approx f(x) + \\epsilon\\sqrt{1+x} $$\nThe absolute error is $\\hat{f}(x)-f(x) \\approx \\epsilon\\sqrt{1+x}$. The relative forward error is:\n$$ \\frac{|\\hat{f}(x)-f(x)|}{|f(x)|} \\approx \\frac{|\\epsilon\\sqrt{1+x}|}{|f(x)|} $$\nFor small $x$, we know $f(x) \\approx x/2$ and $\\sqrt{1+x} \\approx 1$. Thus, the relative error behaves as:\n$$ \\frac{|\\epsilon \\cdot 1|}{|x/2|} = \\frac{2|\\epsilon|}{|x|} $$\nSince $|\\epsilon|$ is on the order of $u$, the relative error is of order $O(u/|x|)$. As $x \\to 0$, this error grows without bound, demonstrating the instability of the algorithm.\n\nFor the stable form $g(x) = \\frac{x}{\\sqrt{1+x}+1}$, the computation proceeds as $\\hat{d} = \\text{fl}(\\text{fl}(\\sqrt{1+x})+1)$ and then $\\hat{g}(x) = \\text{fl}(x/\\hat{d})$. Following a similar analysis, the total relative error accumulates from several stable operations.\nLet $\\hat{d} = (\\sqrt{1+x}(1+\\epsilon_1)+1)(1+\\epsilon_2) = (\\sqrt{1+x}+1)(1+\\frac{\\epsilon_1\\sqrt{1+x}}{\\sqrt{1+x}+1})(1+\\epsilon_2)$.\nThe final computed value is $\\hat{g}(x) = \\frac{x}{\\hat{d}}(1+\\epsilon_3) \\approx \\frac{x}{(\\sqrt{1+x}+1)} \\frac{1+\\epsilon_3}{(1+\\epsilon_2)(1+\\frac{\\epsilon_1\\sqrt{1+x}}{\\sqrt{1+x}+1})}$.\n$$ \\hat{g}(x) \\approx g(x) (1+\\epsilon_3-\\epsilon_2 - \\frac{\\epsilon_1\\sqrt{1+x}}{\\sqrt{1+x}+1}) $$\nThe relative error is $\\frac{|\\hat{g}(x)-g(x)|}{|g(x)|} \\approx |\\epsilon_3-\\epsilon_2 - \\frac{\\epsilon_1\\sqrt{1+x}}{\\sqrt{1+x}+1}|$.\nAs $x \\to 0$, this error approaches $|\\epsilon_3-\\epsilon_2 - \\epsilon_1/2|$, which is bounded by a small multiple of the unit roundoff $u$. The relative error does not grow as $x \\to 0$, demonstrating that this algorithm is stable.\n\nThe final answer requested is the closed-form expression for the relative condition number.",
            "answer": "$$ \\boxed{\\frac{\\sqrt{1+x} + 1}{2\\sqrt{1+x}}} $$"
        },
        {
            "introduction": "This final practice moves from analytical derivation to computational exploration, revealing the dramatic consequences of severe ill-conditioning in a famous case study. You will investigate the Wilkinson polynomial, where the problem of finding polynomial roots from its coefficients is notoriously sensitive. By writing a program to perturb a single coefficient by a minuscule amount, you will empirically witness how this small change can lead to massive, non-intuitive shifts in the roots, transforming the abstract concept of a condition number into a tangible and memorable computational result .",
            "id": "3216312",
            "problem": "Consider the polynomial root-finding problem for the Wilkinson polynomial defined by $p(x) = \\prod_{i=1}^{20} (x - i)$, where the input is the coefficient vector and the output is the vector of roots. Start from the foundational definition of the condition number of a problem: for a mapping $F$ from inputs to outputs, the (relative) condition number at an input $u$ quantifies the limiting ratio of the relative output change to the relative input change under arbitrarily small perturbations of $u$. Using this principle, analyze how perturbations of a single coefficient of $p(x)$ affect the roots of the polynomial.\n\nYour task is to implement a program that empirically estimates the relative condition number of the root-finding problem for $p(x)$ with respect to perturbations of the coefficient of $x^{19}$. The analysis should adhere to the following requirements:\n\n1. Construct the coefficients of $p(x)$ from its exact roots $[1,2,\\dots,20]$. Let the coefficient vector be $(c_{20}, c_{19}, \\dots, c_{0})$ in descending powers of $x$, where $c_{20} = 1$ and $c_{19}$ is the coefficient of $x^{19}$.\n\n2. For a perturbation $\\varepsilon$ applied to the $x^{19}$ coefficient, form the perturbed polynomial $q_\\varepsilon(x)$ whose coefficient vector is identical to that of $p(x)$ except that the $x^{19}$ coefficient is $c_{19} + \\varepsilon$.\n\n3. Compute the roots of $q_\\varepsilon(x)$ numerically. Since the exact, unperturbed roots are the integers $1,2,\\dots,20$, pair each perturbed root to one of these integers by minimizing the absolute difference $|r_\\varepsilon - i|$, ensuring a one-to-one matching.\n\n4. For each matched root $i \\in \\{1,2,\\dots,20\\}$ and its paired perturbed root $r_{\\varepsilon,i}$, compute the empirical relative change in the root as $|r_{\\varepsilon,i} - i| / |i|$. Compute the relative change in the coefficient as $|\\varepsilon| / |c_{19}|$. Define the empirical relative condition number estimate for root $i$ under perturbation $\\varepsilon$ as\n$$\n\\kappa_i(\\varepsilon) = \\frac{|r_{\\varepsilon,i} - i| / |i|}{|\\varepsilon| / |c_{19}|}.\n$$\n\n5. For each $\\varepsilon$, report the maximum empirical relative condition number over the $20$ roots, $\\max_{i} \\kappa_i(\\varepsilon)$.\n\nUse the following test suite of perturbations to probe different regimes:\n- A \"happy path\" small perturbation: $\\varepsilon = 10^{-10}$.\n- A larger perturbation to expose more dramatic sensitivity: $\\varepsilon = 10^{-8}$.\n- A negative small perturbation to test sign sensitivity: $\\varepsilon = -10^{-10}$.\n\nYour program should produce a single line of output containing the three resulting maximum empirical relative condition numbers as a comma-separated list enclosed in square brackets, in the order of the test suite, for example, $[k_1,k_2,k_3]$, where each $k_j$ is a float corresponding to the respective $\\varepsilon$ listed above. No physical units are involved; all quantities are dimensionless by construction.",
            "solution": "The Wilkinson polynomial, $p(x) = \\prod_{i=1}^{20} (x - i)$, is a canonical example used to illustrate that the problem of finding polynomial roots from its coefficients can be severely ill-conditioned. The task is to empirically estimate this ill-conditioning by following a precise and formal procedure.\n\nThe core principle is the definition of the relative condition number of a problem. For a function $F$ that maps an input $x$ to an output $y = F(x)$, the relative condition number $\\kappa(x)$ at a point $x$ is defined as the limit of the ratio of the relative change in the output to the relative change in the input, as the input perturbation tends to zero:\n$$\n\\kappa(x) = \\lim_{\\delta \\to 0} \\sup_{\\|\\delta x\\| \\le \\delta \\|x\\|} \\frac{\\|F(x+\\delta x) - F(x)\\| / \\|F(x)\\|}{\\|\\delta x\\| / \\|x\\|}\n$$\nIn our context, the problem is the function $F$ that maps a polynomial's coefficient vector $\\mathbf{c} = (c_{20}, c_{19}, \\dots, c_0)$ to its vector of roots $\\mathbf{r} = (r_1, r_2, \\dots, r_{20})$. We are interested in the sensitivity of the roots to a perturbation in a single coefficient, $c_{19}$. The problem provides a formula for an empirical estimate of the condition number for a specific root $i$ and a finite perturbation $\\varepsilon$ applied to $c_{19}$:\n$$\n\\kappa_i(\\varepsilon) = \\frac{\\Delta r_i^{(rel)}}{\\Delta c_{19}^{(rel)}} = \\frac{|r_{\\varepsilon,i} - i| / |i|}{|\\varepsilon| / |c_{19}|}\n$$\nHere, $r_{\\varepsilon,i}$ is the perturbed root corresponding to the original root $i$, and $|\\varepsilon|/|c_{19}|$ is the relative perturbation of the coefficient of $x^{19}$. Our goal is to compute $\\max_i \\kappa_i(\\varepsilon)$ for several given values of $\\varepsilon$.\n\nThe procedure is as follows:\n\n1.  **Define the Exact Roots and Coefficients**: The exact roots of the Wilkinson polynomial are the integers $r_i = i$ for $i \\in \\{1, 2, \\dots, 20\\}$. The polynomial is $p(x) = \\prod_{i=1}^{20} (x - i)$. From these roots, we can construct the coefficient vector $\\mathbf{c} = (c_{20}, c_{19}, \\dots, c_0)$, where $p(x) = \\sum_{k=0}^{20} c_k x^k$. The coefficient $c_{20}$ is $1$. From Vieta's formulas, the coefficient $c_{19}$ is the negative sum of the roots:\n    $$\n    c_{19} = -\\sum_{i=1}^{20} i = -\\frac{20(20+1)}{2} = -210\n    $$\n\n2.  **Apply Perturbation**: For each given perturbation value $\\varepsilon$ from the test suite ($\\varepsilon \\in \\{10^{-10}, 10^{-8}, -10^{-10}\\}$), we form a new, perturbed coefficient vector $\\mathbf{c}_\\varepsilon$. This vector is identical to $\\mathbf{c}$ except for the coefficient of $x^{19}$, which becomes $c_{19, \\varepsilon} = c_{19} + \\varepsilon$. This defines the perturbed polynomial $q_\\varepsilon(x)$.\n\n3.  **Compute and Match Roots**: We numerically compute the roots of $q_\\varepsilon(x)$, denoted as the set $\\{r_{\\varepsilon,j}\\}_{j=1}^{20}$. Although the original roots are all real, small perturbations to the coefficients can result in complex roots. The problem specifies that we must pair each original root $i$ with a perturbed root $r_{\\varepsilon,i}$ by minimizing the distance $|r_{\\varepsilon,j} - i|$ while ensuring a one-to-one mapping. For the small perturbations considered, the perturbed roots remain close to their original positions. Sorting the computed roots by their real part and pairing them with the naturally sorted original roots ($1, 2, \\dots, 20$) provides a robust and correct matching.\n\n4.  **Calculate Maximum Empirical Condition Number**: For each original root $i$ and its matched perturbed root $r_{\\varepsilon,i}$, we calculate the empirical condition number estimate $\\kappa_i(\\varepsilon)$ using the provided formula. The final result for a given $\\varepsilon$ is the maximum value found across all $20$ roots:\n    $$\n    \\kappa(\\varepsilon) = \\max_{i \\in \\{1, 2, \\dots, 20\\}} \\kappa_i(\\varepsilon)\n    $$\n\nThis procedure is executed for each value of $\\varepsilon$ in the test suite to observe how the magnitude of the perturbation affects the measured sensitivity of the roots. The implementation will use numerical libraries to handle polynomial coefficient generation and root-finding.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Empirically estimates the condition number of the root-finding problem\n    for the Wilkinson polynomial with respect to perturbations of the x^19 coefficient.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        1e-10,  # \"happy path\" small perturbation\n        1e-8,   # larger perturbation\n        -1e-10, # negative small perturbation\n    ]\n\n    # 1. Construct the polynomial from its exact roots.\n    # The exact roots are the integers from 1 to 20.\n    exact_roots = np.arange(1, 21, dtype=float)\n\n    # numpy.poly returns coefficients in descending order of power.\n    # For roots r_1, ..., r_n, it returns coeffs for (x-r_1)...(x-r_n).\n    # The first coefficient (for x^20) is 1.\n    p_coeffs = np.poly(exact_roots)\n\n    # The coefficient of x^19 is the second element of the array.\n    # From Vieta's formulas, c_19 = -sum(roots) = -210.\n    c19 = p_coeffs[1]\n\n    results = []\n    for eps in test_cases:\n        # 2. Form the perturbed polynomial q_eps(x).\n        q_coeffs = p_coeffs.copy()\n        # The perturbation is applied to the coefficient of x^19.\n        q_coeffs[1] += eps\n\n        # 3. Compute the roots of the perturbed polynomial.\n        # numpy.roots returns complex roots.\n        perturbed_roots = np.roots(q_coeffs)\n\n        # 3. Match perturbed roots to original roots.\n        # For small perturbations, the roots stay ordered by their real part.\n        # Sorting both sets of roots ensures a correct one-to-one matching.\n        # The exact roots are already sorted. We sort the perturbed roots.\n        # numpy.sort on a complex array sorts lexicographically (real then imag part).\n        perturbed_roots.sort()\n\n        # 4. Compute the empirical relative condition number for each root.\n        kappa_i_values = []\n        for i in range(len(exact_roots)):\n            exact_root = exact_roots[i]\n            perturbed_root = perturbed_roots[i]\n            \n            # The problem defines kappa_i relative to the original root i.\n            # abs() on a complex number computes its modulus.\n            rel_change_root = abs(perturbed_root - exact_root) / abs(exact_root)\n            \n            # The relative change in the coefficient is wrt to its original value.\n            rel_change_coeff = abs(eps) / abs(c19)\n            \n            # Handle the case where the relative change in coeff is zero, though\n            # test cases prevent this.\n            if rel_change_coeff == 0:\n                kappa_i = 0.0\n            else:\n                kappa_i = rel_change_root / rel_change_coeff\n            \n            kappa_i_values.append(kappa_i)\n\n        # 5. Report the maximum empirical relative condition number over the 20 roots.\n        max_kappa = np.max(kappa_i_values)\n        results.append(max_kappa)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        }
    ]
}