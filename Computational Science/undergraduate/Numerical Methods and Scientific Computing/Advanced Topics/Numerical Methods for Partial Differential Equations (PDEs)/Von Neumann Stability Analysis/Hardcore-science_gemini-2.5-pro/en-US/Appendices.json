{
    "hands_on_practices": [
        {
            "introduction": "The best way to understand the power and necessity of stability analysis is to examine a case where an intuitive scheme fails spectacularly. This exercise explores the Forward-Time, Centered-Space (FTCS) scheme for the linear advection equation, a method that is famously unconditionally unstable. By not only proving its instability but also identifying the specific Fourier mode that grows fastest, you will gain a deeper appreciation for how numerical errors can selectively amplify, a crucial first step in learning to control them .",
            "id": "2225581",
            "problem": "Consider the one-dimensional linear advection equation, which describes the transport of a quantity $u(x,t)$ at a constant positive speed $c$:\n$$ \\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} = 0 $$\nAn engineer attempts to solve this equation numerically on a uniform grid with spatial step size $\\Delta x$ and time step size $\\Delta t$. They employ the Forward-in-Time, Centered-in-Space (FTCS) scheme, which is given by the following finite difference equation:\n$$ \\frac{u_j^{n+1} - u_j^n}{\\Delta t} + c \\frac{u_{j+1}^n - u_{j-1}^n}{2\\Delta x} = 0 $$\nwhere $u_j^n$ is the numerical approximation of $u(j\\Delta x, n\\Delta t)$.\n\nThis scheme is known to be unconditionally unstable, causing any initial round-off errors to grow over time. The error can be decomposed into a superposition of Fourier modes. The evolution of a single Fourier mode with wavenumber $k$ from one time step to the next is governed by a complex amplification factor, $G(k)$. The mode that corresponds to the largest magnitude of this factor, $|G(k)|$, will grow most rapidly and eventually dominate the numerical solution.\n\nYour task is to identify the specific wavenumber $k$ of the Fourier mode that experiences the fastest growth. Express this wavenumber $k$ as a symbolic expression in terms of the spatial grid spacing $\\Delta x$.",
            "solution": "Consider the FTCS scheme\n$$\\frac{u_{j}^{n+1}-u_{j}^{n}}{\\Delta t}+c\\,\\frac{u_{j+1}^{n}-u_{j-1}^{n}}{2\\Delta x}=0.$$\nPerform a von Neumann analysis by inserting a single Fourier mode\n$$u_{j}^{n}=\\hat{u}^{n}\\exp(i j \\theta),\\quad \\theta=k\\Delta x,$$\nand define the amplification factor by $u_{j}^{n+1}=G\\,u_{j}^{n}$. Substituting gives\n$$\\frac{G-1}{\\Delta t}+c\\,\\frac{\\exp(i\\theta)-\\exp(-i\\theta)}{2\\Delta x}=0.$$\nUsing $\\exp(i\\theta)-\\exp(-i\\theta)=2i\\sin\\theta$, we obtain\n$$\\frac{G-1}{\\Delta t}+c\\,\\frac{i\\sin\\theta}{\\Delta x}=0 \\quad\\Longrightarrow\\quad G=1-iC\\sin\\theta,$$\nwhere $C=\\frac{c\\,\\Delta t}{\\Delta x}$ is the Courant number. The magnitude of the amplification factor is\n$$|G|=\\sqrt{1+C^{2}\\sin^{2}\\theta}.$$\nFor fixed $C$, the growth per time step is maximized when $|G|$ is maximized, which occurs when $|\\sin\\theta|$ is maximal. Since $|\\sin\\theta|$ attains its maximum value $1$ at\n$$\\theta=\\frac{\\pi}{2}+m\\pi,\\quad m\\in\\mathbb{Z},$$\nthe corresponding wavenumbers satisfy\n$$k\\Delta x=\\frac{\\pi}{2}+m\\pi \\quad\\Longrightarrow\\quad k=\\frac{(2m+1)\\pi}{2\\Delta x}.$$\nRestricting to the principal wavenumber in the first Brillouin zone yields the specific fastest-growing mode\n$$k=\\frac{\\pi}{2\\Delta x}.$$",
            "answer": "$$\\boxed{\\frac{\\pi}{2\\Delta x}}$$"
        },
        {
            "introduction": "Having seen how a simple scheme can fail, we now explore a common and powerful technique for correcting such instabilities: the introduction of artificial viscosity. This practice modifies the original advection equation with a diffusion term, which has a stabilizing effect on the FTCS scheme . Your task is to use von Neumann analysis to derive the precise conditions on the Courant and diffusion numbers that guarantee stability, illustrating how a flawed method can be systematically transformed into a robust and usable one.",
            "id": "2225609",
            "problem": "In computational fluid dynamics, it is sometimes necessary to introduce an \"artificial viscosity\" term into a hyperbolic partial differential equation to control instabilities in numerical solutions. Consider the one-dimensional linear advection equation, modified with such a term:\n$$\n\\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} = \\epsilon \\frac{\\partial^2 u}{\\partial x^2}\n$$\nHere, $u(x,t)$ is a scalar quantity, $c$ is the constant advection speed, and $\\epsilon$ is the coefficient of artificial viscosity, with both $c$ and $\\epsilon$ being positive real constants.\n\nTo solve this equation numerically, we use a grid with spacing $\\Delta x$ in space and $\\Delta t$ in time. We denote the numerical approximation of $u(j\\Delta x, n\\Delta t)$ as $u_j^n$. A common explicit finite difference method is the Forward-Time Central-Space (FTCS) scheme. For the given equation, the FTCS discretization is:\n$$\n\\frac{u_j^{n+1} - u_j^n}{\\Delta t} + c \\left( \\frac{u_{j+1}^n - u_{j-1}^n}{2\\Delta x} \\right) = \\epsilon \\left( \\frac{u_{j+1}^n - 2u_j^n + u_{j-1}^n}{(\\Delta x)^2} \\right)\n$$\nThe stability of this scheme depends on two dimensionless parameters: the Courant number $C = \\frac{c \\Delta t}{\\Delta x}$ and the diffusion number $r = \\frac{\\epsilon \\Delta t}{(\\Delta x)^2}$.\n\nThrough von Neumann stability analysis, it can be shown that for the scheme to be stable for all wave numbers, two distinct conditions must be met. The first condition places an upper limit on the diffusion number itself, of the form $r \\le r_{max}$. The second condition establishes a relationship between the Courant number and the diffusion number, taking the form $C^2 \\le g(r)$.\n\nYour task is to determine the function $g(r)$.",
            "solution": "We apply von Neumann stability analysis. Assume a Fourier mode $u_{j}^{n}=\\zeta^{n}\\exp(i j \\theta)$, where $\\zeta$ is the amplification factor and $\\theta$ is the nondimensional wave number. Substitute this into the FTCS scheme\n$$\n\\frac{u_{j}^{n+1}-u_{j}^{n}}{\\Delta t}+c\\frac{u_{j+1}^{n}-u_{j-1}^{n}}{2\\Delta x}=\\epsilon\\frac{u_{j+1}^{n}-2u_{j}^{n}+u_{j-1}^{n}}{(\\Delta x)^{2}},\n$$\nuse $C=\\frac{c\\Delta t}{\\Delta x}$ and $r=\\frac{\\epsilon\\Delta t}{(\\Delta x)^{2}}$, and the identities\n$$\n\\frac{u_{j+1}^{n}-u_{j-1}^{n}}{2\\Delta x}\\mapsto \\frac{\\exp(i\\theta)-\\exp(-i\\theta)}{2\\Delta x}=\\frac{i}{\\Delta x}\\sin\\theta,\n$$\n$$\n\\frac{u_{j+1}^{n}-2u_{j}^{n}+u_{j-1}^{n}}{(\\Delta x)^{2}}\\mapsto \\frac{\\exp(i\\theta)-2+\\exp(-i\\theta)}{(\\Delta x)^{2}}=\\frac{-4}{(\\Delta x)^{2}}\\sin^{2}\\!\\left(\\frac{\\theta}{2}\\right).\n$$\nThis gives the amplification factor\n$$\n\\zeta=1-iC\\sin\\theta-4r\\sin^{2}\\!\\left(\\frac{\\theta}{2}\\right).\n$$\nStability requires $|\\zeta|^{2}\\leq 1$ for all $\\theta$. Compute\n$$\n|\\zeta|^{2}=\\left(1-4r\\sin^{2}\\!\\left(\\frac{\\theta}{2}\\right)\\right)^{2}+C^{2}\\sin^{2}\\theta.\n$$\nLet $s=\\sin^{2}\\!\\left(\\frac{\\theta}{2}\\right)\\in[0,1]$, so $\\sin^{2}\\theta=4s(1-s)$. Then\n$$\n|\\zeta|^{2}= \\left(1-4rs\\right)^{2}+4C^{2}s(1-s),\n$$\nand the stability condition $|\\zeta|^{2}\\leq 1$ becomes\n$$\n\\left(1-4rs\\right)^{2}+4C^{2}s(1-s)\\leq 1,\\quad \\forall s\\in[0,1].\n$$\nSubtracting $1$ and expanding yields\n$$\n\\left(1-4rs\\right)^{2}+4C^{2}s(1-s)-1 = s\\left[(-8r+4C^{2})+s(16r^{2}-4C^{2})\\right]\\leq 0.\n$$\nSince $s\\geq 0$, this inequality for all $s\\in[0,1]$ is equivalent to requiring the linear function\n$$\nh(s)=(-8r+4C^{2})+s(16r^{2}-4C^{2})\n$$\nto satisfy $h(s)\\leq 0$ for all $s\\in[0,1]$. For a linear function, this is equivalent to $h(0)\\leq 0$ and $h(1)\\leq 0$. These give\n$$\nh(0)\\leq 0 \\;\\Longrightarrow\\; -8r+4C^{2}\\leq 0 \\;\\Longrightarrow\\; C^{2}\\leq 2r,\n$$\n$$\nh(1)\\leq 0 \\;\\Longrightarrow\\; -8r+16r^{2}\\leq 0 \\;\\Longrightarrow\\; r\\leq \\frac{1}{2}.\n$$\nThus, the two stability conditions are $r\\leq \\frac{1}{2}$ and $C^{2}\\leq 2r$. Therefore, the function relating the Courant and diffusion numbers is\n$$\ng(r)=2r.\n$$",
            "answer": "$$\\boxed{2r}$$"
        },
        {
            "introduction": "An alternative to adding artificial terms to the equation is to design a more sophisticated numerical scheme from the outset. This problem introduces the Richtmyer method, a two-step scheme for the linear advection equation, which achieves stability without artificial diffusion. Analyzing this multi-step process will expand your skills in applying von Neumann analysis to more complex algorithms and reveal the trade-offs involved in designing schemes that are both accurate and stable .",
            "id": "2225605",
            "problem": "An electrical engineer is modeling the propagation of a voltage pulse, $u(x, t)$, along a lossless transmission line. The behavior is governed by the one-dimensional linear advection equation:\n$$ \\frac{\\partial u}{\\partial t} + c \\frac{\\partial u}{\\partial x} = 0 $$\nwhere $c$ is the constant speed of signal propagation. To solve this equation numerically, a two-step finite difference scheme, known as the Richtmyer method, is proposed. Let $u_j^n$ be the numerical approximation of the voltage at position $x_j = j\\Delta x$ and time $t_n = n\\Delta t$, where $\\Delta x$ is the spatial grid spacing and $\\Delta t$ is the time step.\n\nThe scheme is defined by two sequential steps:\n1.  A provisional value is calculated at a half-time step and a mid-grid point:\n    $$ u_{j+1/2}^{n+1/2} = \\frac{1}{2}(u_{j+1}^n + u_j^n) - \\frac{c\\Delta t}{2\\Delta x}(u_{j+1}^n - u_j^n) $$\n2.  The final value at the next full time step is computed using these provisional values:\n    $$ u_j^{n+1} = u_j^n - \\frac{c\\Delta t}{\\Delta x}(u_{j+1/2}^{n+1/2} - u_{j-1/2}^{n+1/2}) $$\n\nTo ensure that numerical errors do not grow uncontrollably, the scheme must be stable. By performing a von Neumann stability analysis, determine the stability condition for the Courant number, $C = \\frac{c\\Delta t}{\\Delta x}$.\n\nWhich of the following inequalities represents the necessary condition for this scheme to be numerically stable?\n\nA. $|C| \\le 2$\n\nB. $|C| \\le \\frac{1}{2}$\n\nC. $|C| \\le 1$\n\nD. $|C| \\le \\sqrt{2}$\n\nE. The scheme is unconditionally unstable.\n\nF. The scheme is unconditionally stable.",
            "solution": "We perform a von Neumann stability analysis by assuming a single Fourier mode of the form $u_{j}^{n}=\\hat{u}^{n}\\exp(i\\theta j)$, where $\\theta=k\\Delta x$ and $k$ is the wavenumber. Then $u_{j+1}^{n}=\\hat{u}^{n}\\exp(i\\theta(j+1))=\\hat{u}^{n}\\exp(i\\theta j)\\exp(i\\theta)$ and $u_{j-1}^{n}=\\hat{u}^{n}\\exp(i\\theta(j-1))=\\hat{u}^{n}\\exp(i\\theta j)\\exp(-i\\theta)$.\n\nDefine the Courant number $C=\\frac{c\\Delta t}{\\Delta x}$. The provisional half-step value is\n$$\nu_{j+1/2}^{n+1/2}=\\frac{1}{2}\\left(u_{j+1}^{n}+u_{j}^{n}\\right)-\\frac{C}{2}\\left(u_{j+1}^{n}-u_{j}^{n}\\right).\n$$\nSubstituting the Fourier mode and factoring $\\hat{u}^{n}\\exp(i\\theta j)$ gives\n$$\nu_{j+1/2}^{n+1/2}=\\hat{u}^{n}\\exp(i\\theta j)\\left[\\frac{1}{2}\\left(\\exp(i\\theta)+1\\right)-\\frac{C}{2}\\left(\\exp(i\\theta)-1\\right)\\right].\n$$\nSimilarly,\n$$\nu_{j-1/2}^{n+1/2}=\\frac{1}{2}\\left(u_{j}^{n}+u_{j-1}^{n}\\right)-\\frac{C}{2}\\left(u_{j}^{n}-u_{j-1}^{n}\\right)\n=\\hat{u}^{n}\\exp(i\\theta j)\\left[\\frac{1}{2}\\left(1+\\exp(-i\\theta)\\right)-\\frac{C}{2}\\left(1-\\exp(-i\\theta)\\right)\\right].\n$$\nThe update to the next time level is\n$$\nu_{j}^{n+1}=u_{j}^{n}-C\\left(u_{j+1/2}^{n+1/2}-u_{j-1/2}^{n+1/2}\\right).\n$$\nWriting $u_{j}^{n}=\\hat{u}^{n}\\exp(i\\theta j)$ and $u_{j}^{n+1}=\\hat{u}^{n+1}\\exp(i\\theta j)$, the amplification factor $G$ defined by $\\hat{u}^{n+1}=G\\,\\hat{u}^{n}$ is\n$$\nG=1-C\\left\\{\\left[\\frac{1}{2}\\left(\\exp(i\\theta)+1\\right)-\\frac{C}{2}\\left(\\exp(i\\theta)-1\\right)\\right]-\\left[\\frac{1}{2}\\left(1+\\exp(-i\\theta)\\right)-\\frac{C}{2}\\left(1-\\exp(-i\\theta)\\right)\\right]\\right\\}.\n$$\nCompute the bracketed difference:\n$$\n\\frac{1}{2}\\left(\\exp(i\\theta)+1\\right)-\\frac{1}{2}\\left(1+\\exp(-i\\theta)\\right)=\\frac{1}{2}\\left(\\exp(i\\theta)-\\exp(-i\\theta)\\right)=i\\sin\\theta,\n$$\n$$\n-\\frac{C}{2}\\left[\\left(\\exp(i\\theta)-1\\right)-\\left(1-\\exp(-i\\theta)\\right)\\right]=-\\frac{C}{2}\\left(\\exp(i\\theta)+\\exp(-i\\theta)-2\\right)=-C\\left(\\cos\\theta-1\\right)=C\\left(1-\\cos\\theta\\right).\n$$\nHence\n$$\nG=1-C\\left[i\\sin\\theta+C\\left(1-\\cos\\theta\\right)\\right]=1-iC\\sin\\theta-C^{2}\\left(1-\\cos\\theta\\right).\n$$\nThe squared modulus is\n$$\n|G|^{2}=\\left[1-C^{2}\\left(1-\\cos\\theta\\right)\\right]^{2}+\\left[C\\sin\\theta\\right]^{2}.\n$$\nLet $S=\\sin\\theta$ and $Cos=\\cos\\theta$. Using $S^{2}=1-Cos^{2}$,\n$$\n|G|^{2}=1-2C^{2}(1-Cos)+C^{4}(1-2Cos+Cos^{2})+C^{2}(1-Cos^{2}).\n$$\nCombine the $C^{2}$ terms:\n$$\n(1-Cos^{2})-2(1-Cos)=-\\left(1-2Cos+Cos^{2}\\right)=-(1-Cos)^{2},\n$$\nand note $(1-2Cos+Cos^{2})=(1-Cos)^{2}$. Therefore\n$$\n|G|^{2}=1-C^{2}(1-Cos)^{2}+C^{4}(1-Cos)^{2}=1+(1-Cos)^{2}C^{2}\\left(C^{2}-1\\right).\n$$\nSince $(1-Cos)^{2}\\geq 0$ for all $\\theta$, the necessary and sufficient condition for $|G|\\leq 1$ for all $\\theta$ is\n$$\nC^{2}\\left(C^{2}-1\\right)\\leq 0 \\quad \\Longleftrightarrow \\quad C^{2}\\leq 1 \\quad \\Longleftrightarrow \\quad |C|\\leq 1.\n$$\nThus the scheme is stable if and only if $|C|\\leq 1$, corresponding to option C.",
            "answer": "$$\\boxed{C}$$"
        }
    ]
}