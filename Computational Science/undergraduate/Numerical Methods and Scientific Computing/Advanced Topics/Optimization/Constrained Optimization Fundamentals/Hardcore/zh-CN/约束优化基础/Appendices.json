{
    "hands_on_practices": [
        {
            "introduction": "约束优化的基石是 Karush-Kuhn-Tucker (KKT) 条件。这个练习提供了一个理想的场景来应用这些条件，将一个向量投影到概率单纯形上——这是机器学习和统计学中的一个核心问题。你将看到这些结合了梯度和约束的条件，不仅可以用来验证解，更可以用来推导出解的显式结构。",
            "id": "3217521",
            "problem": "考虑将向量 $v \\in \\mathbb{R}^{n}$ 欧几里得投影到概率单纯形上，该单纯形定义为集合 $\\Delta^{n} = \\{ x \\in \\mathbb{R}^{n} : x_{i} \\ge 0 \\text{ for all } i, \\ \\sum_{i=1}^{n} x_{i} = 1 \\}$。该投影是以下优化问题的解\n$$\n\\min_{x \\in \\mathbb{R}^{n}} \\ \\frac{1}{2} \\| x - v \\|^{2} \\quad \\text{subject to} \\quad x_{i} \\ge 0 \\ \\text{for all } i, \\ \\sum_{i=1}^{n} x_{i} = 1.\n$$\n从凸优化的基本原理出发，使用 Karush–Kuhn–Tucker (KKT) 条件推导此问题的充要最优性条件。具体而言，为等式约束引入一个拉格朗日乘子，为非负约束引入适当的乘子，然后利用互补松弛性消去不等式乘子，从而获得最优解关于 $v$ 和一个标量阈值的显式结构形式。\n\n然后，将您的推导应用于 $n=6$ 且\n$$\nv = \\begin{pmatrix} 1.2 \\\\ 0.9 \\\\ 0.7 \\\\ 0.4 \\\\ 0.05 \\\\ -0.2 \\end{pmatrix}.\n$$\n的特定情况。\n计算在您的显式形式中强制执行单纯形约束的等式约束乘子（即标量阈值）的值。请提供精确值。您的最终答案必须是一个实数。",
            "solution": "我们从凸优化的基本原理开始。目标函数 $f(x) = \\frac{1}{2} \\| x - v \\|^{2}$ 是严格凸的，因为其Hessian矩阵是单位矩阵，而单位矩阵是正定的。约束 $x_{i} \\ge 0$ (对所有 $i$) 和 $\\sum_{i=1}^{n} x_{i} = 1$ 是仿射的，因此是凸的。因此，该问题是一个具有严格凸目标函数和仿射约束的凸优化问题，Karush–Kuhn–Tucker (KKT) 条件是最优性的充要条件。\n\n构造拉格朗日函数，其中为等式约束引入单个乘子 $\\nu \\in \\mathbb{R}$，为非负约束引入乘子 $\\lambda_{i} \\ge 0$：\n$$\n\\mathcal{L}(x,\\nu,\\lambda) = \\frac{1}{2} \\sum_{i=1}^{n} (x_{i} - v_{i})^{2} + \\nu \\left( \\sum_{i=1}^{n} x_{i} - 1 \\right) - \\sum_{i=1}^{n} \\lambda_{i} x_{i}.\n$$\nKKT 条件如下：\n- 原始可行性：$x_{i} \\ge 0$ (对所有 $i$)，且 $\\sum_{i=1}^{n} x_{i} = 1$。\n- 对偶可行性：$\\lambda_{i} \\ge 0$ (对所有 $i$)。\n- 互补松弛性：$\\lambda_{i} x_{i} = 0$ (对所有 $i$)。\n- 驻点条件：$\\nabla_{x} \\mathcal{L} = 0$，其分量形式为\n$$\n\\frac{\\partial \\mathcal{L}}{\\partial x_{i}} = x_{i} - v_{i} + \\nu - \\lambda_{i} = 0 \\quad \\Longrightarrow \\quad x_{i} = v_{i} - \\nu + \\lambda_{i}.\n$$\n\n使用互补松弛性来消去 $\\lambda_{i}$。对于每个索引 $i$，存在两种情况：\n- 如果 $x_{i} > 0$，那么互补松弛性意味着 $\\lambda_{i} = 0$，因此 $x_{i} = v_{i} - \\nu$，从而 $v_{i} > \\nu$。\n- 如果 $x_{i} = 0$，那么驻点条件给出 $\\lambda_{i} = \\nu - v_{i}$，而对偶可行性意味着 $\\nu - v_{i} \\ge 0$，因此 $v_{i} \\le \\nu$。\n\n综合这些情况，最优解具有显式形式\n$$\nx_{i}^{\\star} = \\max(v_{i} - \\nu, 0).\n$$\n令 $\\tau := \\nu$ 表示标量阈值。施加等式约束 $\\sum_{i=1}^{n} x_{i}^{\\star} = 1$ 可得标量方程\n$$\n\\sum_{i=1}^{n} \\max(v_{i} - \\tau, 0) = 1.\n$$\n等价地，如果 $A = \\{ i : v_{i} > \\tau \\}$ 是 $x_{i}^{\\star} > 0$ 的索引的激活集，那么\n$$\n\\sum_{i \\in A} (v_{i} - \\tau) = 1 \\quad \\Longrightarrow \\quad \\tau = \\frac{\\sum_{i \\in A} v_{i} - 1}{|A|},\n$$\n并满足一致性条件：对于 $i \\in A$，有 $v_{i} > \\tau$；对于 $j \\notin A$，有 $v_{j} \\le \\tau$。\n\n我们现在将此方法应用于 $n=6$ 且\n$$\nv = \\begin{pmatrix} 1.2 \\\\ 0.9 \\\\ 0.7 \\\\ 0.4 \\\\ 0.05 \\\\ -0.2 \\end{pmatrix}.\n$$\n的给定实例。\n将 $v$ 的分量按非增序排列，以测试可能的激活集大小 $k \\in \\{1,2,\\dots,6\\}$：\n$$\nv_{(1)} = 1.2, \\quad v_{(2)} = 0.9, \\quad v_{(3)} = 0.7, \\quad v_{(4)} = 0.4, \\quad v_{(5)} = 0.05, \\quad v_{(6)} = -0.2.\n$$\n对于每个 $k$，定义\n$$\n\\tau_{k} = \\frac{\\sum_{i=1}^{k} v_{(i)} - 1}{k},\n$$\n并检查一致性条件 $v_{(k)} > \\tau_{k} \\ge v_{(k+1)}$（约定 $v_{(7)} = -\\infty$）。\n\n计算候选值：\n- 对于 $k = 1$：$\\tau_{1} = \\frac{1.2 - 1}{1} = 0.2$。检查 $v_{(1)} > \\tau_{1}$ 即 $1.2 > 0.2$ (真)，但 $\\tau_{1} \\ge v_{(2)}$ 要求 $0.2 \\ge 0.9$ (假)。所以 $k=1$ 无效。\n- 对于 $k = 2$：$\\tau_{2} = \\frac{1.2 + 0.9 - 1}{2} = \\frac{1.1}{2} = 0.55$。检查 $v_{(2)} > \\tau_{2}$ 即 $0.9 > 0.55$ (真)，但 $\\tau_{2} \\ge v_{(3)}$ 要求 $0.55 \\ge 0.7$ (假)。所以 $k=2$ 无效。\n- 对于 $k = 3$：$\\tau_{3} = \\frac{1.2 + 0.9 + 0.7 - 1}{3} = \\frac{2.8 - 1}{3} = \\frac{1.8}{3} = 0.6$。检查 $v_{(3)} > \\tau_{3}$ 即 $0.7 > 0.6$ (真)，且 $\\tau_{3} \\ge v_{(4)}$ 即 $0.6 \\ge 0.4$ (真)。因此 $k=3$ 是一致的。\n\n因此，等式约束乘子（阈值）为 $\\tau = \\tau_{3} = 0.6$。这通过 $x_{i}^{\\star} = \\max(v_{i} - 0.6, 0)$ 唯一地确定了投影，并且正数部分的总和确实为1：\n$$\n(1.2 - 0.6) + (0.9 - 0.6) + (0.7 - 0.6) = 0.6 + 0.3 + 0.1 = 1.\n$$\n因此，所求的标量阈值恰好是 $0.6$。",
            "answer": "$$\\boxed{0.6}$$"
        },
        {
            "introduction": "在我们理解了最优性条件之后，现在我们来探究算法如何利用这些条件在可行域中进行搜索。这个练习让你扮演积极集方法（一种经典的二次规划算法）的决策者。你将通过计算一个非最优点处的拉格朗日乘子，来决定应该放开哪个约束，从而具体地理解算法是如何朝着最小值前进的。",
            "id": "3217327",
            "problem": "考虑凸二次规划问题\n最小化 $x \\in \\mathbb{R}^2$ 上的函数：$f(x) = \\dfrac{1}{2} x^\\top x$\n其满足三个线性不等式约束：\n$1)$ $x_1 \\ge 0$，\n$2)$ $x_2 \\ge 0$，\n$3)$ $x_1 + x_2 \\ge 1$。\n假设应用了二次规划的活动集方法。初始可行点为 $x^{(0)} = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}$。初始工作集被选为 $\\mathcal{W}^{(0)} = \\{1, 3\\}$，即在 $x^{(0)}$ 点，约束 $x_1 \\ge 0$ 和 $x_1 + x_2 \\ge 1$ 被作为等式强制执行。\n\n仅使用凸二次规划的基本定义和 Karush–Kuhn–Tucker (KKT) 条件，确定从 $x^{(0)}$ 和 $\\mathcal{W}^{(0)}$ 开始的经典可行活动集迭代的下一步正确操作。特别地，判断是否必须从工作集中移除一个约束以严格改进目标函数，如果是，是哪一个。\n\n选择一个恰当的选项：\n\nA. 在 $x^{(0)}$ 处宣告最优，因为与工作集 $\\mathcal{W}^{(0)}$ 中活动约束相关的所有拉格朗日乘子都是非负的；不应移除任何约束。\n\nB. 移除约束 $1$（即约束 $x_1 \\ge 0$），然后计算保持 $x_1 + x_2 = 1$ 的等式约束搜索方向，并沿该方向移动以严格减小 $f(x)$，达到 $x = \\begin{bmatrix} \\tfrac{1}{2} \\\\ \\tfrac{1}{2} \\end{bmatrix}$。\n\nC. 移除约束 $3$（即约束 $x_1 + x_2 \\ge 1$），然后计算保持 $x_1 = 0$ 的等式约束搜索方向，并沿该方向移动以严格减小 $f(x)$。\n\nD. 将两个约束都保留在工作集中，并沿着活动约束的一维零空间进行非零下降步长，以严格减小 $f(x)$ 而不修改工作集。",
            "solution": "## 问题验证\n\n### 步骤1：提取已知信息\n问题陈述提供了以下信息：\n- **目标函数**：最小化 $x \\in \\mathbb{R}^2$ 上的 $f(x) = \\dfrac{1}{2} x^\\top x$。\n- **约束条件**：\n    1. $x_1 \\ge 0$\n    2. $x_2 \\ge 0$\n    3. $x_1 + x_2 \\ge 1$\n- **方法**：二次规划的活动集方法。\n- **初始可行点**：$x^{(0)} = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}$。\n- **初始工作集**：$\\mathcal{W}^{(0)} = \\{1, 3\\}$，对应于将约束 $x_1 \\ge 0$ 和 $x_1 + x_2 \\ge 1$ 视为等式。\n\n### 步骤2：使用提取的已知信息进行验证\n该问题是一个标准的凸二次规划 (QP) 问题。\n- **科学依据**：该问题在数学上是明确定义的。目标函数 $f(x) = \\frac{1}{2} x^\\top x$ 的Hessian矩阵是 $H = I$（单位矩阵），该矩阵是正定的。这使得目标函数是严格凸的。约束是线性的，定义了一个凸可行域。因此，这是一个凸优化问题，保证了局部最小值也是全局最小值。活动集方法是解决此类问题的经典标准算法。该问题在数学优化理论中有坚实的基础。\n- **适定性**：可行域非空（例如，$x^{(0)}$ 是一个可行点）且闭合。目标函数是严格凸的，并且当 $\\|x\\| \\to \\infty$ 时无界增长。因此，存在唯一解。\n- **明确性**：问题使用精确的数学语言陈述，没有歧义或主观因素。\n\n初始点 $x^{(0)} = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}$ 是可行的：\n- $x_1^{(0)} = 0 \\ge 0$\n- $x_2^{(0)} = 1 \\ge 0$\n- $x_1^{(0)} + x_2^{(0)} = 0 + 1 = 1 \\ge 1$\n在 $x^{(0)}$ 处起作用的约束是 $x_1=0$（约束 $1$）和 $x_1+x_2=1$（约束 $3$）。指定的初始工作集 $\\mathcal{W}^{(0)} = \\{1, 3\\}$ 与初始点一致。\n\n### 步骤3：结论与行动\n问题陈述是有效的。这是一个在数值优化领域中适定、自洽且科学合理的问题。我们可以开始求解。\n\n## 求解过程推导\n\n问题要求在经典可行活动集迭代中的下一步操作。当前迭代点是 $x^{(0)} = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}$，工作集是 $\\mathcal{W}^{(0)} = \\{1, 3\\}$。工作集中的约束被视为等式：\n$x_1 = 0$\n$x_1 + x_2 = 1$\n点 $x^{(0)}$ 是这个方程组的唯一解。在活动集方法中，当迭代点满足工作集的等式约束，并且不存在保持这些等式（即活动约束矩阵的零空间是平凡的）的可行下降方向时，我们必须检查拉格朗日乘子的符号，以确定我们是否处于最优点，或者是否应该移除一个约束。\n\n由工作集定义的等式约束子问题的 Karush-Kuhn-Tucker (KKT) 系统的平稳性条件规定，目标函数的梯度必须是活动约束梯度的线性组合。让我们将约束写成 $c_i(x) \\ge 0$ 的形式：\n$c_1(x) = x_1 \\ge 0$\n$c_2(x) = x_2 \\ge 0$\n$c_3(x) = x_1 + x_2 - 1 \\ge 0$\n\n目标函数的梯度是 $\\nabla f(x) = x$。\n约束的梯度是：\n$\\nabla c_1(x) = \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix}$\n$\\nabla c_2(x) = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}$\n$\\nabla c_3(x) = \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}$\n\n在点 $x^{(0)} = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix}$ 处，平稳性条件是 $\\nabla f(x^{(0)}) = \\sum_{i \\in \\mathcal{W}^{(0)}} \\lambda_i \\nabla c_i(x^{(0)})$，其中 $\\lambda_i$ 是拉格朗日乘子。对于我们的工作集 $\\mathcal{W}^{(0)} = \\{1, 3\\}$，这变为：\n$$\n\\nabla f(x^{(0)}) = \\lambda_1 \\nabla c_1(x^{(0)}) + \\lambda_3 \\nabla c_3(x^{(0)})\n$$\n代入数值：\n$$\n\\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix} = \\lambda_1 \\begin{bmatrix} 1 \\\\ 0 \\end{bmatrix} + \\lambda_3 \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}\n$$\n这个向量方程等价于以下关于 $\\lambda_1$ 和 $\\lambda_3$ 的两个线性方程组：\n1. $0 = \\lambda_1 + \\lambda_3$\n2. $1 = (0)\\lambda_1 + \\lambda_3$\n\n从方程（2），我们立即得到 $\\lambda_3 = 1$。\n将此代入方程（1），我们得到 $0 = \\lambda_1 + 1$，这给出 $\\lambda_1 = -1$。\n\n计算出的活动约束的拉格朗日乘子是 $\\lambda_1 = -1$ 和 $\\lambda_3 = 1$。原始不等式约束问题的 KKT 最优性条件要求所有拉格朗日乘子都是非负的（对于所有活动约束 $i$，$\\lambda_i \\ge 0$）。因为 $\\lambda_1 = -1  0$，所以点 $x^{(0)}$ 不是最优解。\n\n活动集策略规定，如果一个或多个拉格朗日乘子为负，我们应该从工作集中移除一个相应的约束，以允许一个能够改进目标函数的可行下降方向。通常，选择与最负乘子相关联的约束。在这种情况下，$\\lambda_1 = -1$ 是唯一的负乘子，所以我们必须从工作集中移除约束 $1$（$x_1 \\ge 0$）。\n\n新的工作集是 $\\mathcal{W}^{(1)} = \\{3\\}$。下一步是从 $x^{(0)}$ 计算一个搜索方向 $p$，该方向在保持在由 $\\mathcal{W}^{(1)}$ 中单个活动约束定义的超平面上（即 $x_1 + x_2 = 1$）的同时，最小化目标函数。\n\n目标是找到 $x = x^{(0)} + p$ 来最小化 $f(x)$，约束条件是 $x_1 + x_2 = 1$。这等价于找到直线上 $x_1 + x_2 = 1$ 离原点最近的点。该子问题的解是原点到该直线的正交投影。\n令 $x^*_{\\text{sub}}$ 为该子问题的解。这个新的等式约束问题的 KKT 条件是：\n$\\nabla f(x^*_{\\text{sub}}) = \\mu_3 \\nabla c_3(x^*_{\\text{sub}})$\n$\\begin{bmatrix} x_1^* \\\\ x_2^* \\end{bmatrix} = \\mu_3 \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix}$，这意味着 $x_1^* = x_2^* = \\mu_3$。\n该点还必须满足约束：$x_1^* + x_2^* = 1$。\n将 $x_1^* = x_2^*$ 代入约束得到 $2x_1^* = 1$，所以 $x_1^* = \\frac{1}{2}$。因此，$x_2^* = \\frac{1}{2}$。\n子问题的最小化点是 $x^*_{\\text{sub}} = \\begin{bmatrix} \\frac{1}{2} \\\\ \\frac{1}{2} \\end{bmatrix}$。\n\n搜索方向是 $p = x^*_{\\text{sub}} - x^{(0)} = \\begin{bmatrix} \\frac{1}{2} \\\\ \\frac{1}{2} \\end{bmatrix} - \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix} = \\begin{bmatrix} \\frac{1}{2} \\\\ -\\frac{1}{2} \\end{bmatrix}$。\n新的迭代点将是 $x^{(1)} = x^{(0)} + \\alpha p$。步长 $\\alpha$ 被选为 $1$（到达子问题最小化点的步长）和不违反任何非活动约束的最大可行步长中的较小者。\n非活动约束是 $c_2(x) = x_2 \\ge 0$。\n我们需要 $x_2(\\alpha) = 1 + \\alpha(-\\frac{1}{2}) \\ge 0 \\implies 1 \\ge \\frac{\\alpha}{2} \\implies \\alpha \\le 2$。\n最大可行步长是 $\\alpha_{\\text{max}} = 2$。\n到达子问题最小化点的步长是 $\\alpha = 1$。\n由于 $1  2$，没有新的约束变为活动约束。我们采取完整步长，$\\alpha=1$。\n新的点是 $x^{(1)} = x^{(0)} + 1 \\cdot p = \\begin{bmatrix} 0 \\\\ 1 \\end{bmatrix} + \\begin{bmatrix} \\frac{1}{2} \\\\ -\\frac{1}{2} \\end{bmatrix} = \\begin{bmatrix} \\frac{1}{2} \\\\ \\frac{1}{2} \\end{bmatrix}$。\n目标函数值从 $f(x^{(0)}) = \\frac{1}{2}(0^2+1^2) = \\frac{1}{2}$ 减少到 $f(x^{(1)}) = \\frac{1}{2}((\\frac{1}{2})^2+(\\frac{1}{2})^2) = \\frac{1}{2}(\\frac{1}{4}+\\frac{1}{4}) = \\frac{1}{4}$。\n\n## 逐项分析\n\n**A. 在 $x^{(0)}$ 处宣告最优，因为与工作集 $\\mathcal{W}^{(0)}$ 中活动约束相关的所有拉格朗日乘子都是非负的；不应移除任何约束。**\n我们的计算表明，约束 $1$ 的拉格朗日乘子是 $\\lambda_1 = -1$，是负数。因此，这个选项的前提是错误的。点 $x^{(0)}$ 不是最优点。\n**结论：不正确。**\n\n**B. 移除约束 $1$（即约束 $x_1 \\ge 0$），然后计算保持 $x_1 + x_2 = 1$ 的等式约束搜索方向，并沿该方向移动以严格减小 $f(x)$，达到 $x = \\begin{bmatrix} \\tfrac{1}{2} \\\\ \\tfrac{1}{2} \\end{bmatrix}$。**\n我们的分析表明，因为 $\\lambda_1 = -1  0$，必须移除约束 $1$。新的子问题涉及在剩余的活动约束 $x_1 + x_2 = 1$ 下最小化 $f(x)$。该子问题的解确实是 $x = \\begin{bmatrix} \\frac{1}{2} \\\\ \\frac{1}{2} \\end{bmatrix}$。从 $x^{(0)}$ 到这个新点的移动构成了活动集方法的一次迭代，包括一个搜索方向和一个 $\\alpha=1$ 的完整步长。这个选项正确地描述了这次迭代的整个操作序列。\n**结论：正确。**\n\n**C. 移除约束 $3$（即约束 $x_1 + x_2 \\ge 1$），然后计算保持 $x_1 = 0$ 的等式约束搜索方向，并沿该方向移动以严格减小 $f(x)$。**\n与约束 $3$ 相关的拉格朗日乘子是 $\\lambda_3 = 1$，是非负的。标准的活动集方法不会移除一个具有非负乘子的约束。因此，这个操作是不正确的。\n**结论：不正确。**\n\n**D. 将两个约束都保留在工作集中，并沿着活动约束的一维零空间进行非零下降步长，以严格减小 $f(x)$ 而不修改工作集。**\n活动约束是 $x_1=0$ 和 $x_1+x_2=1$。活动约束梯度的矩阵是 $A = \\begin{bmatrix} \\nabla c_1^\\top \\\\ \\nabla c_3^\\top \\end{bmatrix} = \\begin{bmatrix} 1  0 \\\\ 1  1 \\end{bmatrix}$。在 $\\mathbb{R}^2$ 中，这两个梯度是线性无关的。$A$ 的零空间包含向量 $p$ 使得 $Ap=0$。由于 $A$ 是可逆的，唯一的解是 $p=0$。零空间是零维的（它只包含零向量）。因此，在保持两个约束都活动的情况下，不能采取非零下降步长。\n**结论：不正确。**",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "前面的练习直接处理约束，而这个最后的实践将探讨将约束问题转化为一系列无约束问题的替代策略。通过比较二次罚函数法和更精妙的增广拉格朗日法，你将揭示数值病态这一关键问题。这将让你亲眼看到，现代优化算法是如何在强制执行约束的同时保持数值稳定性的，这突显了数值优化中的实际挑战与巧妙解决方案。",
            "id": "3217528",
            "problem": "考虑一个等式约束优化问题，其目标是最小化一个二次函数，并服从一个线性约束：\n最小化 $f(x) = \\tfrac{1}{2} x_1^2 + \\tfrac{1}{2} x_2^2$，约束条件为 $c(x) = x_1 - 1 = 0$，其中 $x = (x_1, x_2) \\in \\mathbb{R}^2$。你将研究两种经典方法：标准二次罚函数法和增广拉格朗日方法。\n\n根据基本原理，约束极小值点 $(x^\\star, \\lambda^\\star)$ 满足 Karush-Kuhn-Tucker (KKT) 条件，对于等式约束，这些条件是平稳性条件和可行性条件\n$\\nabla f(x^\\star) + \\lambda^\\star \\nabla c(x^\\star) = 0$ 和 $c(x^\\star) = 0$，\n其中 $\\lambda^\\star$ 是拉格朗日乘子。\n\n二次罚函数法求解一系列形式为\n$\\min_x \\, \\phi_\\rho(x) = f(x) + \\tfrac{\\rho}{2} \\, c(x)^2$ 的无约束问题，其中罚参数 $\\rho  0$。\n增广拉格朗日方法求解一系列形式为\n$\\min_x \\, \\mathcal{L}_\\rho(x, \\lambda) = f(x) + \\lambda \\, c(x) + \\tfrac{\\rho}{2} \\, c(x)^2$ 的子问题，其中使用一个固定的、大小适中的 $\\rho  0$，同时通过 $\\lambda_{k+1} = \\lambda_k + \\rho \\, c(x_k)$ 更新乘子。\n\n假设你希望约束违反度 $|c(x)| = |x_1 - 1|$ 至多为容差 $t = 10^{-8}$。对于罚函数法，令 $x_\\rho$ 表示 $\\phi_\\rho$ 的精确极小值点。对于增广拉格朗日方法，考虑一个固定的 $\\rho = 10$ 和每次迭代中 $\\mathcal{L}_\\rho(\\cdot, \\lambda)$ 的精确极小值点 $x(\\lambda)$，并使用乘子更新规则 $\\lambda_{k+1} = \\lambda_k + \\rho \\, c(x(\\lambda_k))$。\n\n下列哪个陈述是正确的？\n\nA. 在罚函数法中，要达到 $|x_{1,\\rho} - 1| \\le t$ 需要 $\\rho \\ge 10^8$，这使得 $\\phi_\\rho$ 的 Hessian 矩阵等于 $\\nabla^2 \\phi_\\rho(x) = \\begin{pmatrix} 1 + \\rho  0 \\\\ 0  1 \\end{pmatrix}$，并产生条件数 $\\kappa(\\nabla^2 \\phi_\\rho) \\approx 10^8$，导致病态问题；相比之下，增广拉格朗日方法中，当 $\\rho = 10$ 时，子问题的 Hessian 矩阵为 $\\nabla^2_x \\mathcal{L}_\\rho = \\begin{pmatrix} 1 + \\rho  0 \\\\ 0  1 \\end{pmatrix}$，条件数 $\\kappa \\approx 11$，并且乘子更新使误差在每次迭代中以因子 $1/(1+\\rho) = 1/11$ 缩减，因此它能稳健收敛。\n\nB. 罚函数法和增广拉格朗日方法都需要通过令 $\\rho \\to \\infty$ 来使 $|x_1 - 1| \\to 0$，因此两种方法的 Hessian 矩阵都必然会变得严重病态。\n\nC. 二次罚函数法产生的 Hessian 矩阵与 $\\rho$ 无关，因此不会出现病态问题；而增广拉格朗日方法的 Hessian 矩阵随着 $\\rho$ 的增大而变得病态，使其稳健性较差。\n\nD. 增广拉格朗日方法不能处理线性等式约束；在这种情况下只有罚函数法适用。\n\n选择正确的选项。",
            "solution": "用户提供了一个约束优化问题，要求对二次罚函数法和增广拉格朗日方法进行比较分析。\n\n### 步骤 1：问题验证\n\n分析问题陈述的有效性。\n\n-   **提取的已知条件**：\n    -   目标函数：$f(x) = \\tfrac{1}{2} x_1^2 + \\tfrac{1}{2} x_2^2$\n    -   约束函数：$c(x) = x_1 - 1 = 0$\n    -   定义域：$x = (x_1, x_2) \\in \\mathbb{R}^2$\n    -   KKT 条件：$\\nabla f(x^\\star) + \\lambda^\\star \\nabla c(x^\\star) = 0$ 和 $c(x^\\star) = 0$\n    -   二次罚函数：$\\phi_\\rho(x) = f(x) + \\tfrac{\\rho}{2} \\, c(x)^2$\n    -   增广拉格朗日函数：$\\mathcal{L}_\\rho(x, \\lambda) = f(x) + \\lambda \\, c(x) + \\tfrac{\\rho}{2} \\, c(x)^2$\n    -   增广拉格朗日乘子更新：$\\lambda_{k+1} = \\lambda_k + \\rho \\, c(x_k)$\n    -   约束违反度容差：$t = 10^{-8}$\n    -   增广拉格朗日罚参数：$\\rho = 10$\n\n-   **有效性评估**：\n    -   该问题具有**科学依据**且是**客观的**。它提出了一个来自数值优化领域的标准、典型问题，该领域是数值方法和科学计算的一个分支学科。\n    -   这些方法（二次罚函数法、增广拉格朗日方法）和分析工具（KKT 条件）的定义是正确且标准的。\n    -   该问题是**适定的**和**自洽的**。目标函数是严格凸的，约束是线性的，这保证了唯一解的存在。所有必要的数据和定义都已提供。\n    -   该问题没有违反任何科学原理，不基于错误的假设，并且不包含任何歧义。\n\n-   **结论**：问题陈述有效。可以继续进行分析。\n\n### 步骤 2：推导精确解\n\n首先，我们使用 Karush-Kuhn-Tucker (KKT) 条件来求解该约束问题的精确解 $(x^\\star, \\lambda^\\star)$。目标函数和约束函数的梯度为：\n$$\n\\nabla f(x) = \\begin{pmatrix} x_1 \\\\ x_2 \\end{pmatrix}, \\quad \\nabla c(x) = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}\n$$\nKKT 条件是：\n1.  **可行性**：$c(x^\\star) = x_1^\\star - 1 = 0 \\implies x_1^\\star = 1$。\n2.  **平稳性**：$\\nabla f(x^\\star) + \\lambda^\\star \\nabla c(x^\\star) = 0 \\implies \\begin{pmatrix} x_1^\\star \\\\ x_2^\\star \\end{pmatrix} + \\lambda^\\star \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}$。\n\n从平稳性条件，我们得到两个标量方程：\n$x_1^\\star + \\lambda^\\star = 0$\n$x_2^\\star = 0$\n\n使用可行性条件得到的 $x_1^\\star = 1$，我们求得 $\\lambda^\\star = -x_1^\\star = -1$。\n因此，唯一的极小值点是 $x^\\star = (1, 0)$，对应的拉格朗日乘子是 $\\lambda^\\star = -1$。\n\n### 步骤 3：二次罚函数法分析\n\n二次罚函数法涉及求解一系列关于 $\\min_x \\phi_\\rho(x)$ 的无约束问题，其中：\n$$\n\\phi_\\rho(x) = f(x) + \\frac{\\rho}{2} c(x)^2 = \\frac{1}{2} x_1^2 + \\frac{1}{2} x_2^2 + \\frac{\\rho}{2} (x_1 - 1)^2\n$$\n通过将 $\\phi_\\rho(x)$ 的梯度设为零来找到极小值点 $x_\\rho$：\n$$\n\\nabla \\phi_\\rho(x) = \\begin{pmatrix} x_1 + \\rho(x_1 - 1) \\\\ x_2 \\end{pmatrix} = \\begin{pmatrix} (1+\\rho)x_1 - \\rho \\\\ x_2 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n求解该方程组得到极小值点 $x_\\rho = (x_{1,\\rho}, x_{2,\\rho})$：\n$x_{1,\\rho} = \\frac{\\rho}{1+\\rho}$\n$x_{2,\\rho} = 0$\n\n此时的约束违反度为：\n$$\nc(x_\\rho) = x_{1,\\rho} - 1 = \\frac{\\rho}{1+\\rho} - 1 = \\frac{\\rho - (1+\\rho)}{1+\\rho} = -\\frac{1}{1+\\rho}\n$$\n为了满足容差要求 $|c(x_\\rho)| \\le t = 10^{-8}$：\n$$\n\\left| -\\frac{1}{1+\\rho} \\right| = \\frac{1}{1+\\rho} \\le 10^{-8} \\implies 1+\\rho \\ge 10^8 \\implies \\rho \\ge 10^8 - 1\n$$\n这证实了为了达到高精度，罚参数 $\\rho$ 必须非常大（约为 $10^8$）。\n\n现在，我们通过计算 $\\phi_\\rho(x)$ 的 Hessian 矩阵来分析子问题的条件：\n$$\n\\nabla^2 \\phi_\\rho(x) = \\begin{pmatrix} 1+\\rho  0 \\\\ 0  1 \\end{pmatrix}\n$$\n该 Hessian 矩阵的特征值为 $\\mu_1 = 1+\\rho$ 和 $\\mu_2 = 1$。条件数是最大特征值与最小特征值的比值：\n$$\n\\kappa(\\nabla^2 \\phi_\\rho) = \\frac{\\mu_{\\text{max}}}{\\mu_{\\text{min}}} = \\frac{1+\\rho}{1} = 1+\\rho\n$$\n对于 $\\rho \\ge 10^8 - 1$，条件数 $\\kappa(\\nabla^2 \\phi_\\rho) \\ge 10^8$。这个极大的条件数表明，随着 $\\rho \\to \\infty$，无约束最小化子问题变得严重病态。\n\n### 步骤 4：增广拉格朗日方法分析\n\n增广拉格朗日方法求解一系列形式为 $\\min_x \\mathcal{L}_\\rho(x, \\lambda)$ 的子问题，使用一个固定的、大小适中的 $\\rho  0$，然后进行乘子更新。此处，$\\rho = 10$。\n$$\n\\mathcal{L}_\\rho(x, \\lambda) = f(x) + \\lambda c(x) + \\frac{\\rho}{2} c(x)^2 = \\frac{1}{2} x_1^2 + \\frac{1}{2} x_2^2 + \\lambda(x_1 - 1) + \\frac{\\rho}{2}(x_1 - 1)^2\n$$\n令 $x_k = x(\\lambda_k)$ 为 $\\mathcal{L}_\\rho(x, \\lambda_k)$ 的极小值点。我们通过将其关于 $x$ 的梯度设为零来找到它：\n$$\n\\nabla_x \\mathcal{L}_\\rho(x, \\lambda_k) = \\begin{pmatrix} x_1 + \\lambda_k + \\rho(x_1 - 1) \\\\ x_2 \\end{pmatrix} = \\begin{pmatrix} (1+\\rho)x_1 - \\rho + \\lambda_k \\\\ x_2 \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n求解 $x_{1,k}$ 和 $x_{2,k}$：\n$x_{1,k} = \\frac{\\rho - \\lambda_k}{1+\\rho}$\n$x_{2,k} = 0$\n\n乘子更新规则是 $\\lambda_{k+1} = \\lambda_k + \\rho c(x_k)$。在 $x_k$ 处的约束值为：\n$$\nc(x_k) = x_{1,k} - 1 = \\frac{\\rho - \\lambda_k}{1+\\rho} - 1 = \\frac{\\rho - \\lambda_k - (1+\\rho)}{1+\\rho} = \\frac{-1 - \\lambda_k}{1+\\rho}\n$$\n将此代入更新规则：\n$$\n\\lambda_{k+1} = \\lambda_k + \\rho \\left( \\frac{-1 - \\lambda_k}{1+\\rho} \\right) = \\frac{(1+\\rho)\\lambda_k - \\rho(1+\\lambda_k)}{1+\\rho} = \\frac{\\lambda_k - \\rho}{1+\\rho}\n$$\n为了分析收敛性，我们考察误差 $\\lambda_k - \\lambda^\\star = \\lambda_k - (-1) = \\lambda_k + 1$：\n$$\n\\lambda_{k+1} + 1 = \\frac{\\lambda_k - \\rho}{1+\\rho} + 1 = \\frac{\\lambda_k - \\rho + 1 + \\rho}{1+\\rho} = \\frac{\\lambda_k + 1}{1+\\rho}\n$$\n这表明拉格朗日乘子估计的误差 $(\\lambda_k - \\lambda^\\star)$ 在每次迭代中都以因子 $\\frac{1}{1+\\rho}$ 缩减。当 $\\rho=10$ 时，收缩因子为 $\\frac{1}{11}$。这证明了该方法线性收敛到真实乘子 $\\lambda^\\star = -1$，而无需 $\\rho \\to \\infty$。因此，约束违反度 $c(x_k) = -\\frac{1}{1+\\rho}(\\lambda_k+1)$ 也线性收敛到 $0$。\n\n现在，我们分析增广拉格朗日方法的子问题的条件。$\\mathcal{L}_\\rho(x, \\lambda)$ 关于 $x$ 的 Hessian 矩阵是：\n$$\n\\nabla^2_x \\mathcal{L}_\\rho(x, \\lambda) = \\begin{pmatrix} 1+\\rho  0 \\\\ 0  1 \\end{pmatrix}\n$$\n这与罚函数法的 Hessian 矩阵形式相同。然而，关键区别在于 $\\rho$ 是一个固定的、大小适中的常数。对于 $\\rho = 10$：\n$$\n\\nabla^2_x \\mathcal{L}_{10}(x, \\lambda) = \\begin{pmatrix} 11  0 \\\\ 0  1 \\end{pmatrix}\n$$\n特征值为 $\\mu_1 = 11$ 和 $\\mu_2 = 1$。条件数是：\n$$\n\\kappa(\\nabla^2_x \\mathcal{L}_{10}) = \\frac{11}{1} = 11\n$$\n这是一个小的、常数的条件数，意味着子问题是良态的并且可以稳健地求解。\n\n### 步骤 5：逐项分析选项\n\n-   **A. 在罚函数法中，要达到 $|x_{1,\\rho} - 1| \\le t$ 需要 $\\rho \\ge 10^8$，这使得 $\\phi_\\rho$ 的 Hessian 矩阵等于 $\\nabla^2 \\phi_\\rho(x) = \\begin{pmatrix} 1 + \\rho  0 \\\\ 0  1 \\end{pmatrix}$，并产生条件数 $\\kappa(\\nabla^2 \\phi_\\rho) \\approx 10^8$，导致病态问题；相比之下，增广拉格朗日方法中，当 $\\rho = 10$ 时，子问题的 Hessian 矩阵为 $\\nabla^2_x \\mathcal{L}_\\rho = \\begin{pmatrix} 1 + \\rho  0 \\\\ 0  1 \\end{pmatrix}$，条件数 $\\kappa \\approx 11$，并且乘子更新使误差在每次迭代中以因子 $1/(1+\\rho) = 1/11$ 缩减，因此它能稳健收敛。**\n    -   该陈述准确地总结了我们分析的发现。罚函数法需要 $\\rho \\approx 10^8$，导致条件数约为 $10^8$。增广拉格朗日方法使用固定的 $\\rho=10$，得到一个条件数为 $\\kappa=11$ 的良态 Hessian 矩阵，并通过乘子更新收敛，误差收缩因子为 $1/11$。\n    -   结论：**正确**。\n\n-   **B. 罚函数法和增广拉格朗日方法都需要通过令 $\\rho \\to \\infty$ 来使 $|x_1 - 1| \\to 0$，因此两种方法的 Hessian 矩阵都必然会变得严重病态。**\n    -   这是不正确的。增广拉格朗日方法通过更新拉格朗日乘子估计值，在固定的、有限的 $\\rho$ 值下实现收敛。它不需要 $\\rho \\to \\infty$。因此，其 Hessian 矩阵不一定会变得病态。\n    -   结论：**不正确**。\n\n-   **C. 二次罚函数法产生的 Hessian 矩阵与 $\\rho$ 无关，因此不会出现病态问题；而增广拉格朗日方法的 Hessian 矩阵随着 $\\rho$ 的增大而变得病态，使其稳健性较差。**\n    -   这是不正确的。罚函数法的 Hessian 矩阵 $\\nabla^2 \\phi_\\rho$ 直接依赖于 $\\rho$，并且随着 $\\rho \\to \\infty$ 而变得病态。虽然增广拉格朗日方法的 Hessian 矩阵也依赖于 $\\rho$，但该方法的设计使得 $\\rho$ 不需要增大。该陈述颠倒了两种方法的性质。\n    -   结论：**不正确**。\n\n-   **D. 增广拉格朗日方法不能处理线性等式约束；在这种情况下只有罚函数法适用。**\n    -   这在事实上是错误的。增广拉格朗日方法是专门为等式约束问题设计的，并且对它们非常有效，包括那些具有线性约束的问题，正如我们的分析所证明的。\n    -   结论：**不正确**。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}