{
    "hands_on_practices": [
        {
            "introduction": "To truly master the Composite Trapezoidal Rule, we must move from theory to practice. A fundamental task in computational science is not just to compute an answer, but to ensure it meets a required level of accuracy. This first practice problem  places you in the role of a biomedical engineer who needs to guarantee the error of a calculation is within a specific tolerance. You will use the theoretical error bound as a powerful predictive tool to determine the minimum number of subintervals needed, a crucial planning step in any serious numerical task.",
            "id": "2210520",
            "problem": "In a pharmacokinetic study, the concentration of a new drug in a patient's bloodstream is modeled as a function of time, $t$, by the equation $C(t) = C_0 \\exp(-kt^2)$. Here, $t$ is the time in hours after injection, $C_0 = 50$ mg/L is the initial concentration, and $k = 0.5 \\text{ hr}^{-2}$ is a constant related to the drug's elimination rate.\n\nTo assess the total drug exposure over the first two hours, a biomedical engineer needs to calculate the Area Under the Curve (AUC), which is given by the definite integral $A = \\int_{0}^{T} C(t) dt$ with $T=2$ hours.\n\nThe engineer uses a numerical approximation method. The time interval $[0, T]$ is divided into $n$ equal subintervals, and the value of the integral is approximated by summing the areas of the trapezoids formed by connecting the points $(t_i, C(t_i))$ and $(t_{i+1}, C(t_{i+1}))$ for each subinterval.\n\nFor this specific numerical method, the absolute error, $|E_n|$, is known to be bounded by the inequality:\n$$|E_n| \\le \\frac{M(T-0)^3}{12n^2}$$\nwhere $M$ is the maximum absolute value of the second derivative of the concentration function, $M = \\max_{t \\in [0, T]} |C''(t)|$.\n\nDetermine the minimum integer number of subintervals, $n$, that the engineer must use to guarantee that the absolute error in the calculated AUC is less than $10^{-3}$ mgÂ·hr/L.",
            "solution": "We are given $C(t) = C_{0}\\exp(-k t^{2})$ with $C_{0} = 50$ and $k = 0.5$, and the trapezoidal rule error bound\n$$|E_{n}| \\le \\frac{M(T-0)^{3}}{12 n^{2}}, \\quad M = \\max_{t \\in [0,T]} |C''(t)|, \\quad T=2.$$\n\nFirst compute $C''(t)$. Differentiating,\n$$C'(t) = C_{0}\\exp(-k t^{2})(-2 k t),$$\n$$C''(t) = C_{0}\\exp(-k t^{2})\\left(-2k + 4k^{2} t^{2}\\right) = 2k C_{0}\\exp(-k t^{2})\\left(-1 + 2k t^{2}\\right).$$\nThus\n$$|C''(t)| = 2k C_{0}\\exp(-k t^{2})\\left| -1 + 2k t^{2} \\right|.$$\n\nLet $t_{0} = \\frac{1}{\\sqrt{2k}}$. For $t \\in [0,t_{0}]$, we have $-1 + 2k t^{2} \\le 0$, so\n$$|C''(t)| = 2k C_{0}\\exp(-k t^{2})\\left(1 - 2k t^{2}\\right).$$\nDefine $h_{1}(t) = 2k C_{0}\\exp(-k t^{2})(1 - 2k t^{2})$. Its derivative is\n$$h_{1}'(t) = 4 k^{2} C_{0} t \\exp(-k t^{2})\\left(-3 + 2k t^{2}\\right).$$\nOn $(0,t_{0}]$, since $t_{0}^{2} = \\frac{1}{2k}$, we have $-3 + 2k t^{2} \\le -3 + 1 = -2  0$, hence $h_{1}'(t)  0$. Therefore $h_{1}$ is decreasing on $[0,t_{0}]$ and attains its maximum at $t=0$:\n$$h_{1}(0) = 2k C_{0}.$$\n\nFor $t \\in [t_{0},T]$, we have $-1 + 2k t^{2} \\ge 0$, so\n$$|C''(t)| = 2k C_{0}\\exp(-k t^{2})\\left(-1 + 2k t^{2}\\right).$$\nDefine $h_{2}(t) = 2k C_{0}\\exp(-k t^{2})(-1 + 2k t^{2})$. Its derivative is\n$$h_{2}'(t) = 4 k^{2} C_{0} t \\exp(-k t^{2})\\left(3 - 2k t^{2}\\right).$$\nCritical points in $[t_{0},T]$ occur at $t = \\sqrt{\\frac{3}{2k}}$ if this lies in the interval. With $k = 0.5$, we have $t_{0} = 1$, $T=2$, and $\\sqrt{\\frac{3}{2k}} = \\sqrt{3} \\in [1,2]$. Evaluate $h_{2}$ at candidates:\n- At $t = t_{0}$, $h_{2}(t_{0}) = 0$.\n- At $t = \\sqrt{\\frac{3}{2k}}$, since $2k t^{2} = 3$,\n$$h_{2}\\!\\left(\\sqrt{\\frac{3}{2k}}\\right) = 2k C_{0} \\cdot 2 \\cdot \\exp\\!\\left(-\\frac{3}{2}\\right) = 4k C_{0}\\exp\\!\\left(-\\frac{3}{2}\\right).$$\n- At $t = T=2$,\n$$h_{2}(2) = 2k C_{0}\\left(-1 + 8k\\right)\\exp(-4k).$$\n\nCompare these to $2k C_{0}$. Note that\n$$4k C_{0}\\exp\\!\\left(-\\frac{3}{2}\\right) = 2k C_{0}\\cdot 2\\exp\\!\\left(-\\frac{3}{2}\\right)  2k C_{0}$$\nbecause $\\exp\\!\\left(\\frac{3}{2}\\right)  2$, hence $2\\exp(-\\frac{3}{2})  1$. Also $h_{2}(2)$ is smaller than $2k C_{0}$ for $k=0.5$. Therefore the maximum over $[0,2]$ is attained at $t=0$:\n$$M = \\max_{t \\in [0,2]} |C''(t)| = 2k C_{0} = 2 \\cdot 0.5 \\cdot 50 = 50.$$\n\nApply the error bound with $T=2$:\n$$|E_{n}| \\le \\frac{M T^{3}}{12 n^{2}} = \\frac{50 \\cdot 2^{3}}{12 n^{2}} = \\frac{100}{3 n^{2}}.$$\nRequire $|E_{n}|  10^{-3}$:\n$$\\frac{100}{3 n^{2}}  10^{-3} \\quad \\Longleftrightarrow \\quad n^{2}  \\frac{100}{3 \\cdot 10^{-3}} = \\frac{100000}{3}.$$\nThus $n  \\sqrt{\\frac{100000}{3}} \\approx 182.57$. The minimal integer $n$ satisfying the inequality is\n$$n = 183.$$",
            "answer": "$$\\boxed{183}$$"
        },
        {
            "introduction": "While planning a calculation is essential, we can also improve our results after the fact. This exercise  introduces Richardson extrapolation, a clever and powerful technique for enhancing the accuracy of our estimates. By combining two approximations made with different step sizes ($h$ and $\\frac{h}{2}$), we can strategically cancel out the dominant error term. This practice demonstrates a fundamental concept in numerical analysis: understanding the structure of the error allows us to eliminate it.",
            "id": "2210511",
            "problem": "A research satellite is designed to measure a specific type of cosmic radiation as it passes through a planetary nebula. The measured radiation flux, $F(t)$, varies as a function of time $t$ according to the model:\n$$F(t) = F_0 \\exp\\left(-\\frac{t^2}{\\tau^2}\\right) \\cos(\\omega t)$$\nThe total energy per unit area received by the satellite's detector over an observation period, known as the fluence $\\Phi$, is given by the time integral of the flux.\n\nGiven the following parameters for the observation:\n-   Peak flux, $F_0 = 100.0 \\, \\text{J/(m}^2 \\cdot \\text{s)}$\n-   Characteristic time, $\\tau = 2.0 \\, \\text{s}$\n-   Angular frequency, $\\omega = 0.5 \\, \\text{rad/s}$\n\nYou are tasked with estimating the total fluence from $t=0$ s to $t=2.0$ s. To do this, first, compute two approximations for the integral using the composite trapezoidal rule: one with $n=2$ subintervals and another with $2n=4$ subintervals. Then, use these two approximations to perform a single step of Richardson extrapolation to find a more accurate value for the fluence.\n\nCalculate the final extrapolated value for the total fluence $\\Phi$. Express your answer in Joules per square meter (J/m$^2$), rounded to four significant figures.",
            "solution": "The fluence is the time integral of the flux over the observation window:\n$$\n\\Phi=\\int_{0}^{2}F(t)\\,dt=\\int_{0}^{2}F_{0}\\exp\\left(-\\frac{t^{2}}{\\tau^{2}}\\right)\\cos(\\omega t)\\,dt.\n$$\nUsing the composite trapezoidal rule with $n$ subintervals and step size $h=\\frac{b-a}{n}$,\n$$\nT_{n}=h\\left[\\frac{F(a)+F(b)}{2}+\\sum_{i=1}^{n-1}F(a+ih)\\right],\n$$\nwith $a=0$ and $b=2$.\n\nFor $n=2$, $h=1$, the nodes are $t_{0}=0$, $t_{1}=1$, $t_{2}=2$. With $F_{0}=100$, $\\tau=2$, $\\omega=0.5$,\n$$\nF(t)=100\\,\\exp\\left(-\\frac{t^{2}}{4}\\right)\\cos\\left(0.5\\,t\\right).\n$$\nEvaluate:\n$$\nF(0)=100,\n$$\n$$\nF(1)=100\\,\\exp\\left(-\\frac{1}{4}\\right)\\cos\\left(0.5\\right)\\approx 68.3461986304491,\n$$\n$$\nF(2)=100\\,\\exp(-1)\\cos(1)\\approx 19.8766110346413.\n$$\nThus,\n$$\nT_{2}=1\\left[\\frac{100+19.8766110346413}{2}+68.3461986304491\\right]\\approx 128.28450414776973.\n$$\n\nFor $n=4$, $h=0.5$, the nodes are $t=0,0.5,1.0,1.5,2.0$. Evaluate the additional points:\n$$\nF(0.5)=100\\,\\exp\\left(-\\frac{(0.5)^{2}}{4}\\right)\\cos\\left(0.25\\right)\\approx 91.0208985544476,\n$$\n$$\nF(1.5)=100\\,\\exp\\left(-\\frac{(1.5)^{2}}{4}\\right)\\cos\\left(0.75\\right)\\approx 41.69037505318272.\n$$\nThen,\n$$\nT_{4}=0.5\\left[\\frac{100+19.8766110346413}{2}+91.0208985544476+68.3461986304491+41.69037505318272\\right]\\approx 130.49788887770003.\n$$\n\nFor the trapezoidal rule, the error expansion has the form $T(h)=I+C h^{2}+O(h^{4})$, so a single Richardson extrapolation step gives\n$$\n\\Phi \\approx \\frac{4T(h/2)-T(h)}{3}=\\frac{4T_{4}-T_{2}}{3}.\n$$\nSubstituting the computed values,\n$$\n\\frac{4\\cdot 130.49788887770003-128.28450414776973}{3}\\approx 131.23568378767678.\n$$\nRounding to four significant figures yields $131.2$ in J/m$^{2}$.",
            "answer": "$$\\boxed{131.2}$$"
        },
        {
            "introduction": "Our final exercise explores a more sophisticated and efficient approach to numerical integration. Using a uniform grid of points can be wasteful, especially for functions that vary rapidly in some regions and are nearly flat in others. This problem  introduces the core concept of adaptive quadrature, an algorithm that intelligently allocates computational effort. By estimating the error locally and subdividing intervals only where needed, this method provides a glimpse into the smart strategies that power modern numerical solvers.",
            "id": "2210489",
            "problem": "An engineer is analyzing the thermal performance of a new processing unit cooled by a one-meter-long heat sink. The rate of heat dissipation, a form of power, varies along the length of the sink. This power density, $P(x)$, is given in Watts per meter (W/m) by the function\n$$P(x) = 10 \\exp(-50(x-0.2)^2)$$\nwhere $x$ is the position along the sink from $x=0$ to $x=1$ meter. To determine the total power dissipated by the sink, one must compute the integral $P_{total} = \\int_{0}^{1} P(x) dx$.\n\nYou are tasked with approximating this integral using a specific adaptive trapezoidal quadrature algorithm. The algorithm proceeds as follows:\n\n1.  For any given subinterval $[x_i, x_{i+1}]$ of width $h = x_{i+1} - x_i$, two approximations for the integral over that subinterval are calculated:\n    a.  The one-panel trapezoidal approximation: $T_1 = \\frac{h}{2}(P(x_i) + P(x_{i+1}))$.\n    b.  The two-panel trapezoidal approximation: $T_2 = \\frac{h}{4}(P(x_i) + 2P(x_i + \\frac{h}{2}) + P(x_{i+1}))$.\n2.  A local error estimate is computed as $E_{local} = |T_2 - T_1|$.\n3.  This error estimate is compared against a local tolerance, defined as $\\epsilon_{local} = \\texttt{TOL} \\times \\frac{h}{b-a}$, where $\\texttt{TOL}$ is the global error tolerance and $[a,b]$ is the total integration interval.\n4.  If $E_{local}  \\epsilon_{local}$, the subinterval is deemed \"unresolved\" and must be subdivided into two equal halves for more detailed analysis. If $E_{local} \\le \\epsilon_{local}$, the subinterval is \"resolved,\" and the more accurate estimate, $T_2$, is accepted as the value of the integral for that subinterval.\n\nYour task is to execute this procedure with a global tolerance of $\\texttt{TOL} = 0.2$ over the total interval $[a,b]=[0,1]$.\nBegin with the single interval $[0, 1]$. If it is unresolved, subdivide it into $[0, 0.5]$ and $[0.5, 1]$ and analyze each of these new subintervals. Do not perform any further subdivisions. The final approximation for the total power is the sum of the $T_2$ approximations calculated for all subintervals present at the finest level of subdivision reached in your analysis (in this case, the level with intervals $[0, 0.5]$ and $[0.5, 1]$ if the initial interval is subdivided).\n\nCalculate the final approximation for the total power, $P_{total}$. Express your answer in Watts, rounded to four significant figures.",
            "solution": "We are to approximate $P_{total}=\\int_{0}^{1} P(x)\\,dx$ with $P(x)=10\\exp\\!\\left(-50(x-0.2)^{2}\\right)$ using the specified adaptive trapezoidal scheme with $\\texttt{TOL}=0.2$ on $[a,b]=[0,1]$. The total length is $b-a=1$, so the local tolerance on a subinterval of width $h$ is $\\epsilon_{local}=0.2\\,h$.\n\nStart with the single interval $[0,1]$ so $h=1$. Compute the needed function values:\n$$\nP(0)=10\\exp(-2)=1.353352832366127,\\quad\nP\\!\\left(\\tfrac{1}{2}\\right)=10\\exp(-4.5)=0.11108996538242306,\\quad\nP(1)=10\\exp(-32)=1.2664165549094176\\times 10^{-13}.\n$$\nCompute the trapezoidal approximations on $[0,1]$:\n$$\nT_{1,[0,1]}=\\frac{h}{2}\\big(P(0)+P(1)\\big)=\\frac{1}{2}\\big(1.353352832366127+1.2664165549094176\\times 10^{-13}\\big)=0.6766764161831619,\n$$\n$$\nT_{2,[0,1]}=\\frac{h}{4}\\big(P(0)+2P\\!\\left(\\tfrac{1}{2}\\right)+P(1)\\big)=\\frac{1}{4}\\big(1.353352832366127+2\\cdot 0.11108996538242306+1.2664165549094176\\times 10^{-13}\\big)=0.3938831907827433.\n$$\nThe local error estimate and tolerance are\n$$\nE_{local,[0,1]}=\\left|T_{2,[0,1]}-T_{1,[0,1]}\\right|=0.2827932254004186,\\qquad \\epsilon_{local,[0,1]}=0.2.\n$$\nSince $E_{local,[0,1]}\\epsilon_{local,[0,1]}$, the interval $[0,1]$ is unresolved, so we subdivide into $[0,0.5]$ and $[0.5,1]$. No further subdivisions are performed.\n\nAnalyze $[0,0.5]$ with $h=0.5$. We need $P(0.25)=10\\exp(-0.125)=8.824969025845954$ in addition to the previously computed $P(0)$ and $P(0.5)$. Then\n$$\nT_{1,[0,0.5]}=\\frac{h}{2}\\big(P(0)+P(0.5)\\big)=\\frac{0.5}{2}\\big(1.353352832366127+0.11108996538242306\\big)=0.3661106994371375,\n$$\n$$\nT_{2,[0,0.5]}=\\frac{h}{4}\\big(P(0)+2P(0.25)+P(0.5)\\big)=\\frac{0.5}{4}\\big(1.353352832366127+2\\cdot 8.824969025845954+0.11108996538242306\\big)=2.3892976061800573.\n$$\nThe local error and tolerance are\n$$\nE_{local,[0,0.5]}=\\left|T_{2,[0,0.5]}-T_{1,[0,0.5]}\\right|=2.0231869067429198,\\qquad \\epsilon_{local,[0,5]}=0.2\\cdot 0.5=0.1.\n$$\nThis subinterval would be unresolved by the criterion, but we do not subdivide further per instructions.\n\nAnalyze $[0.5,1]$ with $h=0.5$. We need $P(0.75)=10\\exp(-15.125)=2.6995785033631346\\times 10^{-6}$ in addition to the previously computed $P(0.5)$ and $P(1)$. Then\n$$\nT_{1,[0.5,1]}=\\frac{h}{2}\\big(P(0.5)+P(1)\\big)=\\frac{0.5}{2}\\big(0.11108996538242306+1.2664165549094176\\times 10^{-13}\\big)=0.02777249134560589,\n$$\n$$\nT_{2,[0.5,1]}=\\frac{h}{4}\\big(P(0.5)+2P(0.75)+P(1)\\big)=\\frac{0.5}{4}\\big(0.11108996538242306+2\\cdot 2.6995785033631346\\times 10^{-6}+1.2664165549094176\\times 10^{-13}\\big)=0.013886920567444553.\n$$\nThe local error and tolerance are\n$$\nE_{local,[0.5,1]}=\\left|T_{2,[0.5,1]}-T_{1,[0.5,1]}\\right|=0.013885570778161336,\\qquad \\epsilon_{local,[0.5,1]}=0.1,\n$$\nso this subinterval is resolved.\n\nBecause the initial interval was unresolved and we made exactly one subdivision, the final approximation is the sum of the $T_{2}$ values on the two subintervals at this finest level:\n$$\nP_{total}\\approx T_{2,[0,0.5]}+T_{2,[0.5,1]}=2.3892976061800573+0.013886920567444553=2.4031845267475018.\n$$\nRounded to four significant figures, this is $2.403$ Watts.",
            "answer": "$$\\boxed{2.403}$$"
        }
    ]
}