{
    "hands_on_practices": [
        {
            "introduction": "掌握任何数值方法的第一步，不仅是学会如何应用它，更是要理解其精确度如何。本练习将通过一个具体实例，让你亲手计算一个积分的近似值，并将其与真实值比较，从而得到“实际误差”。同时，你还将计算理论“误差上界”，这有助于你直观地理解误差界限公式的意义——它为我们的计算提供了一个误差不会超过的保证。",
            "id": "2210486",
            "problem": "一位数值分析家正在研究使用复合梯形法则来近似定积分 $I = \\int_1^2 \\frac{1}{x} dx$ 的精度。该近似计算使用 $n=4$ 个等宽子区间。\n\n已知该积分的精确值为 $I = \\ln(2)$。复合梯形法则的理论误差界由不等式 $|E_T| \\le \\frac{M(b-a)^3}{12n^2}$ 给出，其中 $[a, b]$ 是积分区间，而 $M$ 是一个常数，使得对于所有在 $[a, b]$ 内的 $x$，都有 $|f''(x)| \\le M$。\n\n计算理论最大绝对误差（即误差界，使用 $M$ 的最小可能值）与近似计算的实际绝对误差之间的差值。在此计算中，使用数值 $\\ln(2) \\approx 0.69314718$。\n\n将你的最终答案表示为一个四舍五入到六位有效数字的实数。",
            "solution": "我们使用复合梯形法则和 $n=4$ 个子区间来近似计算 $I=\\int_{1}^{2}\\frac{1}{x}\\,dx$。步长为\n$$\nh=\\frac{b-a}{n}=\\frac{2-1}{4}=\\frac{1}{4}\n$$\n节点为 $x_{0}=1$，$x_{1}=1+\\frac{1}{4}=\\frac{5}{4}$，$x_{2}=1+\\frac{2}{4}=\\frac{3}{2}$，$x_{3}=1+\\frac{3}{4}=\\frac{7}{4}$，$x_{4}=2$。\n\n复合梯形近似值为\n$$\nT=\\frac{h}{2}\\left[f(x_{0})+2\\sum_{k=1}^{n-1}f(x_{k})+f(x_{n})\\right]\n$$\n当 $f(x)=\\frac{1}{x}$ 时，我们有\n$$\nf(x_{0})=1,\\quad f(x_{1})=\\frac{4}{5},\\quad f(x_{2})=\\frac{2}{3},\\quad f(x_{3})=\\frac{4}{7},\\quad f(x_{4})=\\frac{1}{2}\n$$\n计算加权和：\n$$\nS=f(x_{0})+2\\big(f(x_{1})+f(x_{2})+f(x_{3})\\big)+f(x_{4})\n=1+2\\left(\\frac{4}{5}+\\frac{2}{3}+\\frac{4}{7}\\right)+\\frac{1}{2}\n$$\n括号内通分，公分母为 $105$，\n$$\n\\frac{4}{5}+\\frac{2}{3}+\\frac{4}{7}=\\frac{84+70+60}{105}=\\frac{214}{105}\n$$\n所以\n$$\nS=1+2\\cdot\\frac{214}{105}+\\frac{1}{2}\n=\\frac{1171}{210}\n$$\n因此\n$$\nT=\\frac{h}{2}S=\\frac{1/4}{2}\\cdot\\frac{1171}{210}=\\frac{1}{8}\\cdot\\frac{1171}{210}=\\frac{1171}{1680}\n$$\n\n使用 $\\ln(2)\\approx 0.69314718$，实际绝对误差为\n$$\nE_{\\text{actual}}=\\left|\\,\\ln(2)-T\\,\\right|=\\left|\\;0.69314718-\\frac{1171}{1680}\\;\\right|\n$$\n因为 $\\frac{1171}{1680}0.69314718$，所以\n$$\nE_{\\text{actual}} = \\frac{1171}{1680}-0.69314718\n$$\n将 $0.69314718$ 写成 $\\frac{34657359}{50000000}$，\n$$\nE_{\\text{actual}}=\\frac{1171}{1680}-\\frac{34657359}{50000000}\n=\\frac{1171\\cdot 50000000-1680\\cdot 34657359}{1680\\cdot 50000000}\n=\\frac{58550000000-58224363120}{84000000000}\n=\\frac{325636880}{84000000000}\n$$\n约去因子 $80$ 得\n$$\nE_{\\text{actual}}=\\frac{4070461}{1050000000}\\approx 0.0038766295238095\n$$\n\n对于梯形法则的误差界，\n$$\n|E_{T}|\\le \\frac{M(b-a)^{3}}{12n^{2}},\n$$\n由于 $f''(x)=\\frac{2}{x^{3}}$，所以在 $[1,2]$ 上满足 $|f''(x)|\\le M$ 的最小可能值 $M$ 是 $M=2$。当 $b-a=1$ 且 $n=4$ 时，我们得到\n$$\nE_{\\text{bound}}=\\frac{2\\cdot 1^{3}}{12\\cdot 4^{2}}=\\frac{2}{192}=\\frac{1}{96}\\approx 0.0104166666667\n$$\n\n所求的差值（误差界减去实际绝对误差）是\n$$\nD=E_{\\text{bound}}-E_{\\text{actual}}=\\frac{1}{96}-\\frac{4070461}{1050000000}\n$$\n使用公分母 $1050000000$，\n$$\nD=\\frac{10937500-4070461}{1050000000}=\\frac{6867039}{1050000000}\\approx 0.00654003714285714\n$$\n四舍五入到六位有效数字，得\n$$\nD\\approx 0.00654004\n$$",
            "answer": "$$\\boxed{0.00654004}$$"
        },
        {
            "introduction": "在了解了基本误差之后，一个自然而然的问题是：我们如何获得更精确的结果？除了简单地增加子区间数量（即“暴力”计算）之外，我们还可以运用更巧妙的技巧。本练习将介绍理查德森外推法，这是一种强大的技术，它通过组合两次不同步长的近似计算来消除主误差项，从而用很少的额外计算量换取更高的精度。",
            "id": "2210511",
            "problem": "一颗研究卫星被设计用于测量其在穿过一个行星状星云时所接收到的一种特定类型的宇宙辐射。测得的辐射通量 $F(t)$ 随时间 $t$ 的变化遵循以下模型：\n$$F(t) = F_0 \\exp\\left(-\\frac{t^2}{\\tau^2}\\right) \\cos(\\omega t)$$\n卫星探测器在观测期间单位面积上接收到的总能量，即注量 $\\Phi$，由辐射通量的时间积分给出。\n\n给定以下观测参数：\n-   峰值通量，$F_0 = 100.0 \\, \\text{J/(m}^2 \\cdot \\text{s)}$\n-   特征时间，$\\tau = 2.0 \\, \\text{s}$\n-   角频率，$\\omega = 0.5 \\, \\text{rad/s}$\n\n您的任务是估算从 $t=0$ s 到 $t=2.0$ s 的总注量。为此，首先使用复合梯形法则计算该积分的两个近似值：一个使用 $n=2$ 个子区间，另一个使用 $2n=4$ 个子区间。然后，使用这两个近似值进行一步理查森外推，以获得更精确的注量值。\n\n计算总注量 $\\Phi$ 的最终外推值。请以焦耳/平方米 (J/m$^2$) 为单位给出答案，并四舍五入到四位有效数字。",
            "solution": "注量是在观测窗口内通量的时间积分：\n$$\n\\Phi=\\int_{0}^{2}F(t)\\,dt=\\int_{0}^{2}F_{0}\\exp\\left(-\\frac{t^{2}}{\\tau^{2}}\\right)\\cos(\\omega t)\\,dt\n$$\n使用复合梯形法则，对于 $n$ 个子区间且步长为 $h=\\frac{b-a}{n}$，\n$$\nT_{n}=h\\left[\\frac{F(a)+F(b)}{2}+\\sum_{i=1}^{n-1}F(a+ih)\\right],\n$$\n其中 $a=0$ 且 $b=2$。\n\n当 $n=2$ 时，$h=1$，节点为 $t_{0}=0$, $t_{1}=1$, $t_{2}=2$。当 $F_{0}=100$，$\\tau=2$，$\\omega=0.5$ 时，\n$$\nF(t)=100\\,\\exp\\left(-\\frac{t^{2}}{4}\\right)\\cos\\left(0.5\\,t\\right)\n$$\n计算：\n$$\nF(0)=100,\n$$\n$$\nF(1)=100\\,\\exp\\left(-\\frac{1}{4}\\right)\\cos\\left(0.5\\right)\\approx 68.3461986304491,\n$$\n$$\nF(2)=100\\,\\exp(-1)\\cos(1)\\approx 19.8766110346413\n$$\n因此，\n$$\nT_{2}=1\\left[\\frac{100+19.8766110346413}{2}+68.3461986304491\\right]\\approx 128.28450414776973\n$$\n\n当 $n=4$ 时，$h=0.5$，节点为 $t=0,0.5,1.0,1.5,2.0$。计算额外的点：\n$$\nF(0.5)=100\\,\\exp\\left(-\\frac{(0.5)^{2}}{4}\\right)\\cos\\left(0.25\\right)\\approx 91.0208985544476,\n$$\n$$\nF(1.5)=100\\,\\exp\\left(-\\frac{(1.5)^{2}}{4}\\right)\\cos\\left(0.75\\right)\\approx 41.69037505318272\n$$\n那么，\n$$\nT_{4}=0.5\\left[\\frac{100+19.8766110346413}{2}+91.0208985544476+68.3461986304491+41.69037505318272\\right]\\approx 130.49788887770003\n$$\n\n对于梯形法则，误差展开式具有 $T(h)=I+C h^{2}+O(h^{4})$ 的形式，因此一步理查森外推法给出\n$$\n\\Phi \\approx \\frac{4T(h/2)-T(h)}{3}=\\frac{4T_{4}-T_{2}}{3}\n$$\n代入计算出的值，\n$$\n\\frac{4\\cdot 130.49788887770003-128.28450414776973}{3}\\approx 131.23568378767678\n$$\n四舍五入到四位有效数字，结果为 $131.2$ J/m$^{2}$。",
            "answer": "$$\\boxed{131.2}$$"
        },
        {
            "introduction": "最后的练习将带你一窥真实世界中数值积分软件的工作原理。对于那些在某些区域变化剧烈、在其他区域则很平缓的函数，使用统一的步长效率低下。本练习将介绍自适应积分法的概念，即算法智能地仅在需要的地方加密网格。通过这个动手实践，你将了解到自适应算法内部的决策过程，从而将教科书中的公式与高效的实际计算联系起来。",
            "id": "2210489",
            "problem": "一位工程师正在分析一个由一米长散热器冷却的新型处理单元的热性能。散热速率（功率的一种形式）沿着散热器的长度变化。该功率密度 $P(x)$（单位为瓦特/米 (W/m)）由以下函数给出\n$$P(x) = 10 \\exp(-50(x-0.2)^2)$$\n其中 $x$ 是沿散热器的位置，范围从 $x=0$ 米到 $x=1$ 米。为确定散热器耗散的总功率，必须计算积分 $P_{total} = \\int_{0}^{1} P(x) dx$。\n\n你的任务是使用一种特定的自适应梯形求积算法来近似计算这个积分。该算法按以下步骤进行：\n\n1.  对于任何给定的宽度为 $h = x_{i+1} - x_i$ 的子区间 $[x_i, x_{i+1}]$，计算该子区间上积分的两个近似值：\n    a.  单板梯形近似：$T_1 = \\frac{h}{2}(P(x_i) + P(x_{i+1}))$。\n    b.  双板梯形近似：$T_2 = \\frac{h}{4}(P(x_i) + 2P(x_i + \\frac{h}{2}) + P(x_{i+1}))$。\n2.  局部误差估计计算为 $E_{local} = |T_2 - T_1|$。\n3.  将此误差估计与局部容差进行比较，局部容差定义为 $\\epsilon_{local} = \\texttt{TOL} \\times \\frac{h}{b-a}$，其中 $\\texttt{TOL}$ 是全局误差容差，$[a,b]$ 是总积分区间。\n4.  如果 $E_{local}  \\epsilon_{local}$，则该子区间被视为“未解析”，必须将其细分为两个相等的一半以进行更详细的分析。如果 $E_{local} \\le \\epsilon_{local}$，则该子区间被视为“已解析”，并接受更精确的估计值 $T_2$ 作为该子区间上的积分值。\n\n你的任务是在总区间 $[a,b]=[0,1]$ 上，以全局容差 $\\texttt{TOL} = 0.2$ 执行此过程。\n从单个区间 $[0, 1]$ 开始。如果它未解析，则将其细分为 $[0, 0.5]$ 和 $[0.5, 1]$，并分析每个新的子区间。不要执行任何进一步的细分。总功率的最终近似值是您分析中达到的最细划分层级上所有子区间的 $T_2$ 近似值之和（在本例中，如果初始区间被细分，则为包含区间 $[0, 0.5]$ 和 $[0.5, 1]$ 的层级）。\n\n计算总功率 $P_{total}$ 的最终近似值。答案以瓦特为单位，并四舍五入到四位有效数字。",
            "solution": "我们要使用指定的自适应梯形方案，在 $[a,b]=[0,1]$ 上以 $\\texttt{TOL}=0.2$ 近似计算 $P_{total}=\\int_{0}^{1} P(x)\\,dx$，其中 $P(x)=10\\exp\\!\\left(-50(x-0.2)^{2}\\right)$。总长度为 $b-a=1$，因此宽度为 $h$ 的子区间上的局部容差为 $$\\epsilon_{local}=0.2\\,h$$。\n\n从单个区间 $[0,1]$ 开始，此时 $h=1$。计算所需的函数值：\n$$\nP(0)=10\\exp(-2)=1.353352832366127,\\quad\nP\\!\\left(\\tfrac{1}{2}\\right)=10\\exp(-4.5)=0.11108996538242306,\\quad\nP(1)=10\\exp(-32)=1.2664165549094176\\times 10^{-13}\n$$\n计算在 $[0,1]$ 上的梯形近似值：\n$$\nT_{1,[0,1]}=\\frac{h}{2}\\big(P(0)+P(1)\\big)=\\frac{1}{2}\\big(1.353352832366127+1.2664165549094176\\times 10^{-13}\\big)=0.6766764161831619,\n$$\n$$\nT_{2,[0,1]}=\\frac{h}{4}\\big(P(0)+2P\\!\\left(\\tfrac{1}{2}\\right)+P(1)\\big)=\\frac{1}{4}\\big(1.353352832366127+2\\cdot 0.11108996538242306+1.2664165549094176\\times 10^{-13}\\big)=0.3938831907827433\n$$\n局部误差估计和容差为\n$$\nE_{local,[0,1]}=\\left|T_{2,[0,1]}-T_{1,[0,1]}\\right|=0.2827932254004186,\\qquad \\epsilon_{local,[0,1]}=0.2\n$$\n由于 $E_{local,[0,1]}\\epsilon_{local,[0,1]}$，区间 $[0,1]$ 是未解析的，所以我们将其细分为 $[0,0.5]$ 和 $[0.5,1]$。不再进行进一步的细分。\n\n分析 $[0,0.5]$，此时 $h=0.5$。除了先前计算的 $P(0)$ 和 $P(0.5)$，我们还需要 $$P(0.25)=10\\exp(-0.125)=8.824969025845954$$。于是\n$$\nT_{1,[0,0.5]}=\\frac{h}{2}\\big(P(0)+P(0.5)\\big)=\\frac{0.5}{2}\\big(1.353352832366127+0.11108996538242306\\big)=0.3661106994371375,\n$$\n$$\nT_{2,[0,0.5]}=\\frac{h}{4}\\big(P(0)+2P(0.25)+P(0.5)\\big)=\\frac{0.5}{4}\\big(1.353352832366127+2\\cdot 8.824969025845954+0.11108996538242306\\big)=2.3892976061800573\n$$\n局部误差和容差为\n$$\nE_{local,[0,0.5]}=\\left|T_{2,[0,0.5]}-T_{1,[0,0.5]}\\right|=2.0231869067429198,\\qquad \\epsilon_{local,[0,0.5]}=0.1\n$$\n根据标准，该子区间将是未解析的，但根据指示，我们不再进一步细分。\n\n分析 $[0.5,1]$，此时 $h=0.5$。除了先前计算的 $P(0.5)$ 和 $P(1)$，我们还需要 $$P(0.75)=10\\exp(-15.125)=2.6995785033631346\\times 10^{-6}$$。于是\n$$\nT_{1,[0.5,1]}=\\frac{h}{2}\\big(P(0.5)+P(1)\\big)=\\frac{0.5}{2}\\big(0.11108996538242306+1.2664165549094176\\times 10^{-13}\\big)=0.02777249134560589,\n$$\n$$\nT_{2,[0.5,1]}=\\frac{h}{4}\\big(P(0.5)+2P(0.75)+P(1)\\big)=\\frac{0.5}{4}\\big(0.11108996538242306+2\\cdot 2.6995785033631346\\times 10^{-6}+1.2664165549094176\\times 10^{-13}\\big)=0.013886920567444553\n$$\n局部误差和容差为\n$$\nE_{local,[0.5,1]}=\\left|T_{2,[0.5,1]}-T_{1,[0.5,1]}\\right|=0.013885570778161336,\\qquad \\epsilon_{local,[0.5,1]}=0.1,\n$$\n所以该子区间是已解析的。\n\n因为初始区间是未解析的，并且我们只进行了一次细分，所以最终的近似值是这个最细层级上两个子区间的 $T_{2}$ 值之和：\n$$\nP_{total}\\approx T_{2,[0,0.5]}+T_{2,[0.5,1]}=2.3892976061800573+0.013886920567444553=2.4031845267475018\n$$\n四舍五入到四位有效数字，结果是 $2.403$ 瓦特。",
            "answer": "$$\\boxed{2.403}$$"
        }
    ]
}