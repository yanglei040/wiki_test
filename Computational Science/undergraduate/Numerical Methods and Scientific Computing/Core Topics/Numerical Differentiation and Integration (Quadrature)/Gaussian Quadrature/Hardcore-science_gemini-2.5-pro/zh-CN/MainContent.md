## 引言
[数值积分](@entry_id:136578)是科学与工程计算中的一项基本任务，其核心在于用有限个函数采样点的加权和来近似一个[定积分](@entry_id:147612)的值。然而，一个根本性的问题是：我们应如何选择这些采样点（节点）和对应的权重，才能以最少的计算量换取最高的精度？高斯求积（Gaussian Quadrature）为这一挑战提供了最优美的解答，它揭示了积分节点与[正交多项式](@entry_id:146918)零点之间深刻的内在联系。本文旨在全面解析高斯求积的原理、应用与实践。在接下来的内容中，读者将首先在“原理与机制”一章中探索高斯求积如何达到理论上的最高精度阶；接着，在“应用与交叉学科联系”一章中，我们将见证这一方法在物理、工程、金融乃至机器学习等领域的强大威力；最后，通过“动手实践”部分的指导，读者将有机会亲手实现并应用高斯求积，从而将理论知识转化为实际的计算能力。

## 原理与机制

在上一章引言中，我们确立了[数值积分](@entry_id:136578)的核心任务：用一个形如 $\sum_{i=1}^{n} w_i f(x_i)$ 的加权和来近似[定积分](@entry_id:147612) $\int_{a}^{b} f(x) w(x) dx$ 的值。这个求和式被称为**求积公式**（quadrature rule），其中 $x_i$ 称为**节点**（nodes），$w_i$ 称为**权重**（weights）。一个自然而深刻的问题随之而来：我们应如何选择这些节点和权重，才能使这个近似尽可能精确？本章将深入探讨高斯求积（Gaussian Quadrature）的原理与机制，它为这个问题提供了一个优雅而强大的答案。高斯求积并非随意选取节点，而是通过一种系统性的方法，将节点与正交多项式的零点联系起来，从而在给定节点数的情况下，达到理论上最高的积分精度。

### 精度的极限：高斯求积的核心思想

一个 $n$ 点求积公式包含 $n$ 个节点和 $n$ 个权重，共计 $2n$ 个自由参数。我们可以利用这些自由度来强制该公式对尽可能多的函数精确成立。在数值分析中，衡量一个求积公式性能的标准是其**[精度阶](@entry_id:145189)**（degree of precision），定义为该公式能够精确积分的最高次多项式的次数。

让我们思考一下，利用这 $2n$ 个自由参数，我们最高能达到多高的精度阶？直观上，每个自由参数似乎可以用来满足一个约束条件。例如，我们可以要求该公式对多项式基 $f(x) = x^k$ 对于 $k=0, 1, 2, \dots$ 精确成立。

考虑一个简单的两点 ($n=2$) [求积公式](@entry_id:753909)来近似积分 $\int_{-1}^{1} f(x) dx$：
$$ \int_{-1}^{1} f(x) dx \approx w_1 f(x_1) + w_2 f(x_2) $$
这里有四个待定参数：$x_1, x_2, w_1, w_2$。我们可以建立一个[方程组](@entry_id:193238)，要求该公式对 $f(x) = 1, x, x^2, x^3$ 精确成立：
\begin{align*}
f(x)=1: \quad  \int_{-1}^{1} 1 \,dx = 2 = w_1 + w_2 \\
f(x)=x: \quad  \int_{-1}^{1} x \,dx = 0 = w_1 x_1 + w_2 x_2 \\
f(x)=x^2: \quad  \int_{-1}^{1} x^2 \,dx = \frac{2}{3} = w_1 x_1^2 + w_2 x_2^2 \\
f(x)=x^3: \quad  \int_{-1}^{1} x^3 \,dx = 0 = w_1 x_1^3 + w_2 x_2^3
\end{align*}
通过求解这个非线性方程组（利用对称性可简化求解，设 $x_1 = -\xi, x_2 = \xi$ 且 $w_1 = w_2 = w$），我们可以得到一组解：$w_1=w_2=1$ 和 $x_1 = -1/\sqrt{3}, x_2 = 1/\sqrt{3}$。这意味着，通过精心选择这四个参数，我们能够使一个两点公式精确地积分所有次数不超过 $3$ 的多项式。也就是说，其精度阶为 $3$ 。

这个结果令人振奋。我们用了 $2n=4$ 个自由度，实现了 $2n-1=3$ 的[精度阶](@entry_id:145189)。这是否是一个普遍规律？更重要的是，这个精度阶是否是上限？

答案是肯定的。对于任意一个 $n$ 点求积公式，其精度阶 $d$ 不可能超过 $2n-1$。证明这个上限非常直观：考虑一个 $2n$ 次的多项式 $P(x) = \prod_{i=1}^{n} (x-x_i)^2$。显然，$P(x)$ 在积分区间上非负，且不恒为零，因此其积分 $\int_{a}^{b} P(x) w(x) dx$ 必为正数。然而，当我们应用求积公式时，由于 $P(x)$ 在所有节点 $x_i$ 处均为零，求积和为 $\sum_{i=1}^{n} w_i P(x_i) = \sum_{i=1}^{n} w_i \cdot 0 = 0$。由于积分值与近似值不相等，该公式无法精确积分这个 $2n$ 次多项式。因此，任何 $n$ 点求积公式的精度阶必然满足 $d \le 2n-1$ 。

**高斯求积的根本目标**，就是构造出一类求积公式，使其能够达到这个理论上的最高精度阶 $2n-1$。

### [正交多项式](@entry_id:146918)：寻找最优节点的关键

我们如何系统性地找到那些能够实现最高精度阶的“神奇”节点呢？答案在于数学中一个深刻而优美的领域：**[正交多项式](@entry_id:146918)**（orthogonal polynomials）。

一个定义在区间 $[a,b]$ 上，关于非负权函数 $w(x)$ 的[内积](@entry_id:158127)可以表示为 $\langle f, g \rangle = \int_{a}^{b} f(x)g(x)w(x)dx$。一个多项式序列 $\{p_k(x)\}_{k=0}^{\infty}$（其中 $p_k(x)$ 的次数为 $k$）如果满足 $\langle p_j, p_k \rangle = 0$ 对所有 $j \neq k$，则称其为关于该[内积](@entry_id:158127)的正交多项式族。

高斯求积的中心定理指出：**一个 $n$ 点求积公式 $\sum_{i=1}^{n} w_i f(x_i)$ 能够达到 $2n-1$ 的精度阶，当且仅当其节点 $\{x_i\}$ 是 $n$ 次正交多项式 $p_n(x)$ 的 $n$ 个根。**

这个定理的证明揭示了高斯求积的精妙机制  。考虑任意一个次数不超过 $2n-1$ 的多项式 $f(x)$。我们可以用 $n$ 次正交多项式 $p_n(x)$ 对 $f(x)$ 进行[多项式除法](@entry_id:151800)，得到：
$$ f(x) = q(x) p_n(x) + r(x) $$
其中商 $q(x)$ 和余数 $r(x)$ 的次数都最多为 $n-1$。

现在，我们分别对等式两边进行积分和求积运算。

首先看积分：
$$ \int_{a}^{b} f(x) w(x) dx = \int_{a}^{b} q(x)p_n(x)w(x) dx + \int_{a}^{b} r(x) w(x) dx $$
由于 $q(x)$ 是一个次数不超过 $n-1$ 的多项式，它可以表示为正交多项式基 $\{p_0(x), \dots, p_{n-1}(x)\}$ 的线性组合。根据正交性定义， $p_n(x)$ 与所有次数低于 $n$ 的多项式（包括 $q(x)$）正交。因此，第一项积分为零：
$$ \int_{a}^{b} q(x)p_n(x)w(x) dx = \langle q, p_n \rangle = 0 $$
于是，我们得到 $I(f) = \int_{a}^{b} f(x) w(x) dx = \int_{a}^{b} r(x) w(x) dx = I(r)$。

再看求积和：
$$ \sum_{i=1}^{n} w_i f(x_i) = \sum_{i=1}^{n} w_i \left( q(x_i)p_n(x_i) + r(x_i) \right) = \sum_{i=1}^{n} w_i q(x_i)p_n(x_i) + \sum_{i=1}^{n} w_i r(x_i) $$
如果我们选择 $p_n(x)$ 的 $n$ 个根作为求积节点 $\{x_i\}$，那么 $p_n(x_i) = 0$ 对所有 $i$ 成立。这使得第一项求和为零。于是，求积和也简化为 $Q(f) = \sum w_i f(x_i) = \sum w_i r(x_i) = Q(r)$。

至此，证明 $I(f) = Q(f)$ 的问题被转化为了证明 $I(r) = Q(r)$。而 $r(x)$ 是一个次数不超过 $n-1$ 的多项式。我们有 $n$ 个权重 $w_i$ 作为自由参数，足以通过求解一个 $n \times n$ 的线性方程组（例如，通过对多项式基 $1, x, \dots, x^{n-1}$ 强制精确）来确定这 $n$ 个权重，从而保证公式对所有次数不超过 $n-1$ 的多项式精确成立。

综上所述，通过将节点选为 $n$ 次正交多项式的根，并恰当地选择权重，我们便构建了一个对所有次数不超过 $2n-1$ 的多项式都精确的求积公式，从而达到了理论精度上限。这些作为节点的根具有非常好的性质：它们都是实数、互不相同，并且严格位于积分区间 $(a, b)$ 内部，这使得它们成为稳定而有效的采样点 。

### 一个构造性实例：三点[高斯-勒让德求积](@entry_id:138201)

为了将上述抽象理论具体化，我们来亲手构造一个三点 ($n=3$) 的高斯求积规则 。我们将处理最常见的情况：在区间 $[-1, 1]$ 上对一个无权函数（即 $w(x)=1$）进行积分。此时，对应的[正交多项式](@entry_id:146918)族是**勒让德多项式**（Legendre polynomials），因此这种求积规则被称为**[高斯-勒让德求积](@entry_id:138201)**（Gauss-Legendre Quadrature）。

**第一步：确定节点**

我们需要找到三次勒让德多项式 $P_3(x)$。我们可以通过对基 $\{1, x, x^2, x^3\}$ 进行 Gram-Schmidt 正交化来构造它，[内积](@entry_id:158127)定义为 $\langle f, g \rangle = \int_{-1}^{1} f(x)g(x)dx$。
- $P_0(x) = 1$
- $P_1(x) = x$ （因为 $\langle x, 1 \rangle = 0$）
- $P_2(x) = x^2 - \frac{\langle x^2, 1 \rangle}{\langle 1, 1 \rangle} P_0(x) = x^2 - \frac{2/3}{2} = x^2 - \frac{1}{3}$
- $P_3(x) = x^3 - \frac{\langle x^3, x \rangle}{\langle x, x \rangle} P_1(x) = x^3 - \frac{2/5}{2/3} x = x^3 - \frac{3}{5}x$

节点就是 $P_3(x)$（或其任意非零常数倍）的根。令 $x^3 - \frac{3}{5}x = x(x^2 - \frac{3}{5}) = 0$，解得根为 $x=0, \pm\sqrt{3/5}$。因此，三个节点按升序[排列](@entry_id:136432)为：
$$ \xi_1 = -\sqrt{\frac{3}{5}}, \quad \xi_2 = 0, \quad \xi_3 = \sqrt{\frac{3}{5}} $$

**第二步：确定权重**

有了节点，我们通过强制公式对低次多项式（例如，次数不超过 $n-1=2$ 的多项式）精确来求解权重 $w_1, w_2, w_3$。
- 对于 $f(x)=1$： $\int_{-1}^{1} 1 dx = 2 = w_1(1) + w_2(1) + w_3(1) = w_1+w_2+w_3$
- 对于 $f(x)=x$： $\int_{-1}^{1} x dx = 0 = w_1(-\sqrt{3/5}) + w_2(0) + w_3(\sqrt{3/5})$，这表明 $w_1=w_3$。
- 对于 $f(x)=x^2$： $\int_{-1}^{1} x^2 dx = \frac{2}{3} = w_1(-\sqrt{3/5})^2 + w_2(0)^2 + w_3(\sqrt{3/5})^2 = \frac{3}{5}(w_1+w_3)$。

联立求解这个[线性方程组](@entry_id:148943)，我们得到：
$$ w_1 = \frac{5}{9}, \quad w_2 = \frac{8}{9}, \quad w_3 = \frac{5}{9} $$

**最终的规则**

我们已经构造出三点[高斯-勒让德求积](@entry_id:138201)公式：
$$ \int_{-1}^{1} f(x) dx \approx \frac{5}{9}f\left(-\sqrt{\frac{3}{5}}\right) + \frac{8}{9}f(0) + \frac{5}{9}f\left(\sqrt{\frac{3}{5}}\right) $$
根据我们的理论，这个公式的精度阶为 $2n-1 = 2(3)-1=5$。我们可以将节点和权重整理为一个有序集合：$(\xi_1, \xi_2, \xi_3, w_1, w_2, w_3) = \begin{pmatrix} -\sqrt{\frac{3}{5}}  0  \sqrt{\frac{3}{5}}  \frac{5}{9}  \frac{8}{9}  \frac{5}{9} \end{pmatrix}$ 。

### 高斯求积的家族：处理不同的积分形式

[高斯-勒让德求积](@entry_id:138201)是为标准积分 $\int_{-1}^{1} f(x) dx$ 设计的。然而，高斯求积的原理具有普适性，可以应用于任何带权积分 $\int_a^b w(x)f(x)dx$。只需将[勒让德多项式](@entry_id:141510)替换为与特定区间 $[a,b]$ 和权函数 $w(x)$ 相对应的[正交多项式](@entry_id:146918)族即可。这催生了高斯求积的一个庞大家族，其中一些最著名的成员包括：

- **高斯-切比雪夫求积（第一类）**：用于形如 $\int_{-1}^{1} \frac{f(x)}{\sqrt{1-x^2}} dx$ 的积分，其权函数为 $w(x) = (1-x^2)^{-1/2}$。这种方法与[第一类切比雪夫多项式](@entry_id:185845) $T_n(x)$ 相关 。

- **[高斯-拉盖尔求积](@entry_id:142563)**：用于处理半无限区间上的积分，形如 $\int_{0}^{\infty} e^{-x} f(x) dx$。其权函数为 $w(x) = e^{-x}$，关联的是[拉盖尔多项式](@entry_id:200702) $L_n(x)$。

- **[高斯-埃尔米特求积](@entry_id:145090)**：用于处理全[实轴](@entry_id:148276)上的积分，形如 $\int_{-\infty}^{\infty} e^{-x^2} f(x) dx$，常见于量子力学和概率论。其权函数为 $w(x) = e^{-x^2}$，关联的是[埃尔米特多项式](@entry_id:153594) $H_n(x)$ 。

对于非经典的权函数，我们同样可以应用高斯求积的原理。例如，对于积分 $\int_{-1}^{1} f(x)|x| dx$，我们可以通过构造在 $[-1,1]$ 上关于权函数 $w(x)=|x|$ 正交的多项式，来推导出相应的最优节点和权重，从而定制一个高效的求积规则 。

### 实践中的高斯求积

在实际应用中，有几个关键的实践问题需要考虑。

**区间变换**

现实世界中的积分区间很少恰好是 $[-1,1]$ 或其他标准形式。为了应用标准的高斯求积公式，我们需要先进行一个线性变量替换。对于任意积分 $\int_a^b \phi(t) dt$，我们可以通过变换 $t = \frac{b-a}{2}x + \frac{a+b}{2}$ 将其映射到以 $x$ 为变量的 $[-1,1]$ 区间上。此时 $dt = \frac{b-a}{2}dx$，积分变为：
$$ \int_a^b \phi(t) dt = \int_{-1}^{1} \phi\left(\frac{b-a}{2}x + \frac{a+b}{2}\right) \frac{b-a}{2} dx $$
这样，我们就得到了一个可以应用标准[高斯-勒让德求积](@entry_id:138201)的新函数 $g(x) = \frac{b-a}{2} \phi\left(\frac{b-a}{2}x + \frac{a+b}{2}\right)$。例如，要计算 $\int_0^2 \sin(t) dt$，这里 $a=0, b=2$，变换为 $t=x+1$，则积分变为 $\int_{-1}^1 \sin(x+1) dx$ 。

**正确使用求积规则**

一个非常重要但容易被忽视的要点是：**一个为权函数 $w(x)$ 设计的高斯求积规则，其近似的是带权积分 $\int w(x)f(x)dx$，而不是无权积分 $\int f(x)dx$**。求积和 $\sum c_i f(x_i)$ 中的权重 $c_i$ 已经将权函数 $w(x)$ 的影响“吸收”了。

如果在计算无权积分 $\int_0^1 f(x)dx$ 时，错误地使用了为权函数 $w_2(x)=x$ 设计的高斯规则 $\mathcal{G}_{x,n}$，那么求积和 $\sum c_i f(x_i)$ 实际上是在精确逼近另一个积分 $\int_0^1 x \cdot \left(\frac{f(x)}{x}\right) dx$。当 $f(x)$ 是一个低阶多项式时，这个求积和的值会收敛到 $\int_0^1 x f(x) dx$，而不是 $\int_0^1 f(x) dx$。因此，得到的误差将是 $\left| \int_0^1 f(x)dx - \int_0^1 x f(x)dx \right|$，这完全偏离了我们的初衷 。务必确保所选用的高斯求积规则的权函数与待积问题中的权函数相匹配。

**误差估计与[自适应求积](@entry_id:144088)：高斯-克龙罗德方法**

在实际计算中，我们如何知道一个 $n$ 点高斯求积的结果是否足够精确？一个可靠的策略是计[算两次](@entry_id:152987)积分，一次用 $n$ 点规则得到结果 $G_n$，另一次用一个更高阶的规则得到结果 $Q_{higher}$，然后用它们的差 $|Q_{higher} - G_n|$ 作为误差的估计。

为了使这个过程尽可能高效，我们希望在计算 $Q_{higher}$ 时能重用计算 $G_n$ 时已经得到的函数值 $f(x_i)$。**高斯-克龙罗德（Gauss-Kronrod）规则**正是为此目的而设计的精妙方法 。

其核心思想是构造一个**嵌入式规则对**（embedded pair of rules）。它从一个 $n$ 点高斯规则 $G_n$ 出发，通过巧妙地添加 $n+1$ 个新的节点（称为克龙罗德节点），与原有的 $n$ 个高斯节点一起，构成一个总共 $2n+1$ 个节点的扩展规则 $K_{2n+1}$ [@problem_id:3233903, option A, F]。这些新节点的位置和所有 $2n+1$ 个新权重都经过重新优化，以最大化 $K_{2n+1}$ 的[精度阶](@entry_id:145189)，通常可以达到 $3n+1$ 或更高。

这种方法的计算效率极高。我们首先计算 $n$ 点[高斯近似](@entry_id:636047) $G_n[f]$，这需要 $n$ 次函数求值。然后，为了计算更高精度的克龙罗德近似 $K_{2n+1}[f]$，我们只需在 $n+1$ 个新节点上额外计算函数值，因为在原有高斯节点上的函数值已经被计算过了 [@problem_id:3233903, option C]。因此，我们总共只需 $n + (n+1) = 2n+1$ 次函数求值，就能同时得到一个高精度的近似值 $K_{2n+1}[f]$ 和一个可靠的[误差估计](@entry_id:141578) $|K_{2n+1}[f] - G_n[f]|$。这种方法构成了许多现代[科学计算](@entry_id:143987)软件中[自适应求积](@entry_id:144088)算法的核心。

总之，高斯求积通过深刻利用[正交多项式](@entry_id:146918)的性质，提供了一种在给定函数求值次数下实现最高积分精度的方法。从其优美的数学原理到强大的实际应用，它无疑是[数值分析](@entry_id:142637)和[科学计算](@entry_id:143987)领域的一块重要基石。