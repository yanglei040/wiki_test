{
    "hands_on_practices": [
        {
            "introduction": "在生物信息学中，我们常常需要同时检验成千上万个假设，例如在全基因组关联研究中检验每个基因是否与疾病相关。这种大规模检验带来了一个严峻的挑战：即使单个检验的显著性水平（$\\alpha$值）很低，仅仅由于偶然性，我们观察到至少一个假阳性结果的概率也会急剧膨胀。本练习将通过一个直接的计算，让你亲身体会这一“多重比较问题”的严重性，并理解为何必须对$p$值进行校正 。",
            "id": "2430505",
            "problem": "在一项计算生物学中对转录因子结合位点预测器的验证性研究中，一名研究人员使用染色质免疫沉淀后测序（ChIP-seq）的阴性对照区域来估计在没有真实信号的情况下，统计检验流程的行为。假设该研究人员对 $m = 20$ 个独立的阴性对照区域进行假设检验，其中每次检验均在单次检验显著性水平 $\\alpha = 0.05$ 下进行。假设所有 $m$ 个原假设都为真，并且各检验相互独立。那么，至少有一次检验纯粹由偶然性导致被判定为显著的概率是多少？请将您的答案表示为小数，并四舍五入到 $4$ 位有效数字。",
            "solution": "对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- 独立假设检验的数量：$m = 20$。\n- 检验在阴性对照区域上进行，意味着所有原假设都被假定为真。\n- 单次检验的显著性水平（单个检验的第一类错误率）：$\\alpha = 0.05$。\n- 各检验相互独立。\n- 需要计算的量是至少有一个检验被判定为显著的概率。\n- 最终答案必须是四舍五入到 $4$ 位有效数字的小数。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题具有科学依据。它涉及总体错误率（Family-Wise Error Rate, FWER）的概念，这是多重假设检验中的一个基本主题，也是生物信息学和计算生物学中的一个关键领域。所描述的情景——使用阴性对照评估统计特性——是一种标准且有效的方法论。该问题提法明确，提供了所有必要的参数（$m$, $\\alpha$）和假设（独立性，原假设为真），以得出一个唯一的、有意义的解。问题没有内部矛盾、歧义或依赖于非科学的前提。该问题是概率论在现实科学背景下的直接应用。\n\n**步骤3：结论与行动**\n该问题被判定为有效。将制定解决方案。\n\n**解决方案的构建**\n该问题要求计算在进行 $m$ 次独立假设检验时，当所有原假设都为真时，观察到至少一个统计显著结果的概率。这是一个多重比较中的经典问题。\n\n设 $H_{0,i}$ 为第 $i$ 次检验的原假设，其中 $i$ 的范围从 $1$ 到 $m$。已知所有 $H_{0,i}$ 都为真。\n显著性水平 $\\alpha$ 是单次检验中犯第一类错误的概率。当一个为真的原假设被错误地拒绝时，就会发生第一类错误。因此，对于任何单次检验 $i$，宣布结果显著（即拒绝 $H_{0,i}$）的概率由下式给出：\n$$P(\\text{test } i \\text{ is significant}) = \\alpha$$\n\n已知 $\\alpha = 0.05$。\n\n其互补事件是单次检验*不*被判定为显著。此事件的概率为：\n$$P(\\text{test } i \\text{ is not significant}) = 1 - \\alpha$$\n\n问题陈述所有 $m = 20$ 次检验都是相互独立的。我们想求*至少有一次*检验是显著的概率。设 $A$ 为 $m$ 次检验中至少有一次显著的事件。计算上更简单的是先计算其互补事件 $A^c$ 的概率，即*所有*检验都不显著的事件。\n\n由于各检验是独立的，所有 $m$ 次检验都不显著的概率是它们各自概率的乘积：\n$$P(A^c) = P(\\text{test 1 is not significant} \\cap \\text{test 2 is not significant} \\cap \\dots \\cap \\text{test } m \\text{ is not significant})$$\n$$P(A^c) = \\prod_{i=1}^{m} P(\\text{test } i \\text{ is not significant})$$\n$$P(A^c) = (1 - \\alpha)^m$$\n\n那么，事件 $A$（至少有一次检验显著）的概率由互补法则给出：\n$$P(A) = 1 - P(A^c)$$\n$$P(A) = 1 - (1 - \\alpha)^m$$\n\n这个量在完全原假设下被称为总体错误率（FWER）。\n\n现在，我们将给定的值代入这个公式：\n- 检验次数, $m = 20$。\n- 显著性水平, $\\alpha = 0.05$。\n\n$$P(A) = 1 - (1 - 0.05)^{20}$$\n$$P(A) = 1 - (0.95)^{20}$$\n\n为了获得数值，我们计算 $(0.95)^{20}$：\n$$(0.95)^{20} \\approx 0.358485922$$\n\n现在，我们求最终的概率：\n$$P(A) \\approx 1 - 0.358485922$$\n$$P(A) \\approx 0.641514078$$\n\n问题要求答案四舍五入到 $4$ 位有效数字。前四位有效数字是 $6$、$4$、$1$ 和 $5$。第五位数字是 $1$，小于 $5$，因此我们向下舍入。\n最终结果是 $0.6415$。\n这个结果揭示了一个关键概念：即使单次检验的错误率很小（$5\\%$），随着检验次数的增加，犯至少一次错误发现的概率也会迅速膨胀。对于 $20$ 次检验，至少出现一个假阳性结果的概率超过 $64\\%$。",
            "answer": "$$\\boxed{0.6415}$$"
        },
        {
            "introduction": "多重检验问题不仅仅存在于同时分析多个基因，它也潜藏在分析流程的选择中，这是一种更隐蔽的“$p$值操纵”（p-hacking）形式。当研究者尝试多种数据预处理或分析方法，并只报告“最好”的结果时，他们实际上在没有进行相应校正的情况下增加了假阳性的风险。这项练习要求你批判性地评估一个常见但有缺陷的生物信息学工作流程，并思考如何通过严谨的统计方法（如数据拆分或重采样）来修正这一问题 。",
            "id": "2430523",
            "problem": "一位计算生物学家分析一个单一的RNA测序（RNA-seq）数据集，以检测两种条件下 $m$ 个基因的差异表达。该团队考虑了 $10$ 种不同的预处理流程（例如，不同的比对器、归一化方案和筛选规则），然后在每个流程的下游应用相同的基因水平检验，为每个流程中的每个基因生成一个 $p$ 值。然后，他们只报告产生最多基因 $p$ 值低于名义阈值（例如 $p0.05$）的那个流程，并呈现这些 $p$ 值，就好像只尝试了那一个流程一样。\n\n从第一性原理出发，回想一下，在一个真实的零假设和一个正确指定的连续检验下，$p$ 值在 $[0,1]$ 上均匀分布，并且I类错误控制是根据实际采用的程序来定义的。考虑关于此工作流程的以下批评和补救措施。为具体起见，假设对于一个给定的零基因，在零假设下，来自 $10$ 个流程的特定 $p$ 值是可交换的且近似独立的。\n\n下列哪个陈述是正确的？\n\nA. 为每个基因选择最小化 $p$ 值的流程会夸大每个基因的I类错误：在零假设下，当尝试 $10$ 个流程时，所选的（最小）$p$ 值至多为 $0.05$ 的概率约等于 $0.40$。有效的推断需要考虑这种选择，例如通过对 $10$ 个流程进行调整，或者通过使用一个留出数据集将流程选择与检验分开。\n\nB. 如果所选流程应用 Benjamini–Hochberg 程序将错误发现率（FDR）控制在 $q=0.05$，那么先前对 $10$ 个流程的搜索不会影响错误率，因此报告的发现无需进一步调整仍然有效。\n\nC. 如果这 $10$ 个流程的输出高度相关，那么选择最有利的一个对I类错误的影响是微不足道的，可以忽略。\n\nD. 只要透明地披露了其他 $9$ 个尝试过的流程，报告具有最显著结果的流程是可以接受的；不需要额外的统计校正，因为透明度解决了偏差问题。\n\nE. 一个有效的补救措施是使用重采样方案（例如零假设下的置换或自助法），在每次重采样中重复整个选择过程，即，在每次重采样中重新运行所有 $10$ 个流程并选择最好的一个，以获得所选统计量的零分布；这在计算 $p$ 值时考虑了数据依赖的流程选择。",
            "solution": "对问题陈述进行验证。\n\n### 步骤1：提取已知信息\n- 使用一个单一的RNA测序数据集。\n- 该分析旨在寻找两种条件下差异表达的基因。\n- 基因数量为 $m$。\n- 使用了 $10$ 种不同的预处理流程。\n- 每个流程后都应用一个基因水平的统计检验，为每个流程中的每个基因产生一个 $p$ 值。\n- 报告标准如下：选择产生“$p$ 值低于名义阈值（例如，$p0.05$）的基因数量最多”的单一流程。\n- 来自这个选定流程的 $p$ 值被报告，就好像只执行了这一个分析一样。\n- 在一个真实的零假设 ($H_0$) 和一个正确指定的连续检验下，$p$ 值是一个在区间 $[0,1]$ 上服从均匀分布的随机变量。\n- 必须针对实际使用的*整个程序*来评估I类错误控制。\n- 假设：对于一个零基因，来自 $10$ 个不同流程的 $p$ 值是可交换且近似独立的。\n\n### 步骤2：使用提取的已知信息进行验证\n- **科学依据：**该问题描述了“p值操纵”（p-hacking）或利用“研究者自由度”的情景，这是应用统计学中，尤其是在生物信息学领域，一个有据可查且关键的问题。所引用的原则（零假设下p值的均匀性，I类错误的定义）是频率派统计推断的基石。该设置在科学上是现实的。\n- **问题明确：**问题陈述清晰。它描述了一个数据分析工作流程，并要求评估关于其统计特性和潜在补救措施的几个陈述。所提供的假设（p值的独立性和可交换性）允许对选项进行定量和逻辑评估。\n- **客观性：**语言技术性强且精确。情景和评估陈述没有主观或含糊的术语。\n\n### 步骤3：结论和行动\n问题陈述在科学上是合理的、明确的且客观的。它没有违反任何无效标准。因此，该问题是**有效的**。将推导出一个完整的解决方案。\n\n### 统计程序的分析\n\n问题的核心在于分析流程的数据依赖性选择。报告的 $p$ 值并非来自预先指定的分析计划，而是来自一个因其产生了最“显著”结果而被特别选择的流程。这构成了多重检验的一种形式，但不是在基因水平上，而是在整个分析流程的水平上。这个选择过程使得报告的 $p$ 值的名义统计特性失效。具体来说，对于一个零假设为真的基因，报告的 $p$ 值不服从 $U[0,1]$ 分布。相反，它的分布偏向于较小的值，导致I类错误率的大幅膨胀。“实际采用的程序”不仅仅是“运行流程 $k$”，而是“运行流程 $1$ 到 $10$，根据一个标准选择最好的一个，并报告其结果”。任何有效的统计推断都必须考虑这整个复杂的程序。\n\n### 逐项评估\n\n**A. 为每个基因选择最小化 $p$ 值的流程会夸大每个基因的I类错误：在零假设下，当尝试 $10$ 个流程时，所选的（最小）$p$ 值至多为 $0.05$ 的概率约等于 $0.40$。有效的推断需要考虑这种选择，例如通过对 $10$ 个流程进行调整，或者通过使用一个留出数据集将流程选择与检验分开。**\n\n该陈述批评了挑选有利结果（cherry-picking）的一般性问题。它将问题中描述的流程选择规则简化为对每个基因选择最小的 $p$ 值。让我们分析这个简化程序的计算。对于单个零基因，设其来自 $10$ 个独立流程的 $p$ 值为 $P_1, P_2, \\dots, P_{10}$。在零假设下，每个 $P_i \\sim U[0,1]$。所选的 $p$ 值为 $P_{\\min} = \\min(P_1, \\dots, P_{10})$。在名义水平 $\\alpha = 0.05$ 下，I类错误的概率为：\n$$ P(P_{\\min} \\le \\alpha) = 1 - P(P_{\\min}  \\alpha) $$\n鉴于独立性：\n$$ P(P_{\\min}  \\alpha) = P(P_1  \\alpha, P_2  \\alpha, \\dots, P_{10}  \\alpha) = \\prod_{i=1}^{10} P(P_i  \\alpha) $$\n由于对于均匀分布 $P(P_i  \\alpha) = 1 - \\alpha$：\n$$ P(P_{\\min} \\le \\alpha) = 1 - (1 - \\alpha)^{10} $$\n对于 $\\alpha = 0.05$：\n$$ P(P_{\\min} \\le 0.05) = 1 - (1 - 0.05)^{10} = 1 - (0.95)^{10} \\approx 1 - 0.5987 = 0.4013 $$\n对于其所描述的程序，这个计算是正确的。虽然这个程序与问题陈述中的程序不完全相同，但它有力且有效地说明了由这种选择效应引起的I类错误的严重膨胀。问题中的实际程序也夸大了I类错误，因为它偏向于选择包含伪小 $p$ 值的流程。\n此外，该陈述提出了有效的补救措施：“对 $10$ 个流程进行调整”（例如，使用 Bonferroni 型校正）或使用“留出数据集”（数据分割），这两种都是标准的、正确的缓解此类偏差的方法。该陈述正确地指出了病理，说明了其严重性，并提出了适当的解决方案类别。因此，它代表了一个正确的批评。\n\n**结论：正确**\n\n**B. 如果所选流程应用 Benjamini–Hochberg 程序将错误发现率（FDR）控制在 $q=0.05$，那么先前对 $10$ 个流程的搜索不会影响错误率，因此报告的发现无需进一步调整仍然有效。**\n\n这个陈述是根本错误的。用于控制FDR的 Benjamini-Hochberg (BH) 程序依赖于输入 $p$ 值有效的假设。具体来说，在零假设下，它们必须在 $[0,1]$ 上均匀分布（或者随机地大于等于一个 $U[0,1]$ 变量）。问题中描述的选择过程使这个假设失效。来自所选流程的一组 $p$ 值富含小值，这意味着零假设下的 $p$ 值不再是均匀分布的。将 BH 程序应用于这组有偏的 $p$ 值将导致实际的FDR高于名义控制水平 $q$。流程选择是整个程序的一部分，任何错误控制方法都必须考虑到这一点。\n\n**结论：不正确**\n\n**C. 如果这 $10$ 个流程的输出高度相关，那么选择最有利的一个对I类错误的影响是微不足道的，可以忽略。**\n\n这个陈述是不正确的。虽然流程输出之间的高度相关性会*减轻*I类错误的膨胀，但它并不会使影响变得“微不足道”以至于“可以被忽略”。在完全相关 ($\\rho=1$) 的极端情况下，所有流程都会产生相同的 $p$ 值，选择将是任意的，没有效果。然而，对于任何小于完全相关的相关性，都会存在一些变异，从而允许选择一个有利偏差的流程，这反过来又会导致错误率的某种程度的膨胀。例如，错误率从名义的 $\\alpha=0.05$ 膨胀到实际的 $\\alpha=0.06$，相对增加了 $20\\%$，这在严谨的科学工作中不被认为是微不足道的。声称这种影响可以“被忽略”是认可了统计上不健全的做法。\n\n**结论：不正确**\n\n**D. 只要透明地披露了其他 $9$ 个尝试过的流程，报告具有最显著结果的流程是可以接受的；不需要额外的统计校正，因为透明度解决了偏差问题。**\n\n这个陈述混淆了科学透明度与统计有效性。透明度是合乎伦理的研究行为的必要组成部分；它允许他人看到所做的工作并进行批判性评估。然而，披露一个有缺陷的方法并不能纠正这个缺陷。报告的 $p$ 值仍然是有偏的，不具备其声称的统计特性。一个被告知此事的读者会明白结果可能被夸大了，但数字本身仍然未经校正，对于正式的推断是无效的。要提出有效的显著性声明，仍然需要进行统计校正。\n\n**结论：不正确**\n\n**E. 一个有效的补救措施是使用重采样方案（例如零假设下的置换或自助法），在每次重采样中重复整个选择过程，即，在每次重采样中重新运行所有 $10$ 个流程并选择最好的一个，以获得所选统计量的零分布；这在计算 $p$ 值时考虑了数据依赖的流程选择。**\n\n这个陈述描述了一种统计上严谨且有效的方法来解决选择偏差。为了获得一个统计量的正确零分布，必须模拟该统计量生成的整个过程。在这个问题中，该过程包括运行所有 $10$ 个流程并应用选择规则。通过置换样本标签（以在零假设下生成数据），然后多次重新运行整个程序（所有 $10$ 个流程加上选择步骤），可以经验性地构建检验统计量（例如，来自“最佳”流程的 $p$ 值）的正确零分布。然后可以将原始数据的观测统计量与这个经验得出的零分布进行比较，以计算出适当调整的、$考虑了选择偏差的 $p$ 值。对于这种复杂、数据依赖的程序，这是一种黄金标准方法。\n\n**结论：正确**",
            "answer": "$$\\boxed{AE}$$"
        },
        {
            "introduction": "在强调了$p$值的潜在陷阱之后，我们转向一个建设性的主题：如何整合来自不同研究的证据。单个研究可能因为样本量不足而无法得出确定性的结论（例如，得到一个“临界”的$p$值，如 $p=0.1$）。然而，统计学提供了强大的荟萃分析（meta-analysis）方法，可以将来自多个独立研究的$p$值进行合并，从而获得更强的统计效力。本练习将向你展示如何运用一个经典的方法来合并$p$值，揭示单个研究中不明显的潜在效应 。",
            "id": "2430501",
            "problem": "在两个独立的RNA测序 (RNA-seq) 队列中，评估了一个生物标志物在两个表型组之间的差异表达。每个队列都对同一个原假设（即真实平均表达差异为零）进行了有效检验，得出了独立的 p 值 $p_1$ 和 $p_2$。观测值为 $p_1 = 0.1$ 和 $p_2 = 0.1$。该研究预注册的荟萃分析计划指定了一个合并规则，即当 p 值的乘积足够小时拒绝原假设：定义检验统计量 $T = p_1 p_2$，并将合并 p 值定义为 $\\Pr\\!\\left(U_1 U_2 \\leq T \\mid H_0\\right)$，其中在原假设 $H_0$ 下，p 值 $U_1$ 和 $U_2$ 独立同分布于 $\\mathrm{Uniform}(0,1)$。\n\n计算观测数据的精确合并 p 值。答案四舍五入到四位有效数字。回答中不要包含任何单位。",
            "solution": "在原假设 $H_0$ 下，p 值 $U_1$ 和 $U_2$ 独立同分布于 $\\mathrm{Uniform}(0,1)$。由乘积法则定义的合并 p 值是在观测值 $t = p_1 p_2$ 处计算的尾部概率\n$$\n\\Pr\\!\\left(U_1 U_2 \\leq t\\right),\n$$\n为了根据基本原理推导，我们计算 $T = U_1 U_2$ 在 $t \\in (0,1)$ 时的累积分布函数，利用 $(U_1,U_2)$ 的联合密度（在单位正方形上为 1）：\n$$\nF_T(t) \\equiv \\Pr\\!\\left(U_1 U_2 \\leq t\\right) = \\iint_{\\{(u_1,u_2)\\in(0,1)^2: u_1 u_2 \\leq t\\}} 1 \\,\\mathrm{d}u_2\\,\\mathrm{d}u_1.\n$$\n对于一个固定的 $u_1 \\in (0,1)$，条件 $u_1 u_2 \\leq t$ 等价于 $u_2 \\leq t/u_1$。当 $u_1 \\in (0,t)$ 时，$t/u_1 \\geq 1$，所以关于 $u_2$ 的内层积分覆盖整个区间 $(0,1)$；当 $u_1 \\in [t,1)$ 时，内层积分覆盖区间 $(0, t/u_1)$。因此，\n$$\nF_T(t) = \\int_{0}^{t} \\left(\\int_{0}^{1} 1 \\,\\mathrm{d}u_2\\right) \\mathrm{d}u_1 + \\int_{t}^{1} \\left(\\int_{0}^{t/u_1} 1 \\,\\mathrm{d}u_2\\right) \\mathrm{d}u_1\n= \\int_{0}^{t} 1 \\,\\mathrm{d}u_1 + \\int_{t}^{1} \\frac{t}{u_1} \\,\\mathrm{d}u_1.\n$$\n计算这些积分可得\n$$\nF_T(t) = t + t \\int_{t}^{1} \\frac{1}{u_1} \\,\\mathrm{d}u_1 = t + t\\left[\\ln(1) - \\ln(t)\\right] = t - t \\ln(t),\n$$\n对于 $t \\in (0,1)$。对于观测数据，$p_1 = 0.1$ 且 $p_2 = 0.1$，所以 $t = p_1 p_2 = 0.01$。因此，合并 p 值为\n$$\nF_T(0.01) = 0.01 - 0.01 \\ln(0.01) = 0.01 \\left(1 - \\ln(0.01)\\right).\n$$\n使用自然对数，$\\ln(0.01) = -\\ln(100) = -2 \\ln(10) \\approx -4.605170186$，因此\n$$\nF_T(0.01) \\approx 0.01 \\left(1 + 4.605170186\\right) = 0.01 \\times 5.605170186 = 0.05605170186.\n$$\n四舍五入到四位有效数字，得到 $0.05605$。\n\n这个精确的合并 p 值大于 $0.05$，在常用的显著性水平 $\\alpha = 0.05$ 下不被认为是统计上显著的，但题目要求输出的是 p 值本身。",
            "answer": "$$\\boxed{0.05605}$$"
        }
    ]
}