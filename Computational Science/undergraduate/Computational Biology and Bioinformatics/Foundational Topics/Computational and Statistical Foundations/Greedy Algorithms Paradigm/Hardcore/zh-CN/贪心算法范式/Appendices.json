{
    "hands_on_practices": [
        {
            "introduction": "贪心算法的一个经典教学案例是“换零钱问题”。在这个练习中，我们将这个抽象问题置于一个生物信息学背景下：为限制性酶切实验设计方案。这个简单的计算练习  有力地揭示了，一个局部最优的选择（每次都切除最大可能的片段）并不保证能得到一个全局最优的解决方案（使用最少的酶切次数）。这是理解贪心策略局限性的一个基础概念。",
            "id": "2396137",
            "problem": "在一个为脱氧核糖核酸（DNA）工作流程中的限制性酶切设计所做的计算机模拟规划练习中，请考虑以下抽象的找零模型。您有一个合成骨架，其中包含标准化的、串联重复的大小模块。每个模块对应一个可被特定限制性内切酶切除的片段。应用任何一种酶都会精确地切除一个固定大小的模块，并产生 $1$ 个单位的货币成本。酶可以被应用任意次数，模块可以按任意顺序被切除。目标是切除总长度等于目标长度 $L$ 的模块，从而留下所需的剩余构建体。可用的模块大小（单位为千碱基对 (kbp)）如下：\n- $1$ kbp,\n- $3$ kbp,\n- $4$ kbp.\n\n设目标长度为 $L = 6$ kbp。在这种情况下，一个常用的贪心策略是在每一步选择不超过待切除剩余长度的、可用的最大模块。\n\n根据以上定义，确定此贪心策略产生的总成本，以及此实例在所有有效切除序列中的最小可能总成本。请以单个数字报告差值（贪心总成本）$-$（最优最小总成本）。最终答案以不带单位的整数表示。",
            "solution": "首先验证问题陈述的科学性和逻辑合理性。\n\n**1. 提取已知条件：**\n- 问题类型：一个源于生物信息学背景（限制性酶切）的抽象找零模型。\n- 可用模块大小（面额）：$\\{1, 3, 4\\}$ 千碱基对 (kbp)。\n- 成本：每次切除（选择模块）成本为 $1$ 个单位。\n- 目标长度 ($L$)：$L = 6$ kbp。\n- 贪心策略定义：在每一步，选择不超过待切除剩余长度的最大可用模块。\n- 目标：计算贪心策略产生的总成本与最小可能总成本（最优解）之间的差值。\n\n**2. 验证：**\n- 科学依据：该问题是限制性酶切图谱绘制的计算抽象，这是分子生物学中的一个有效概念。它在数学上等同于经典的找零问题，这是计算机科学和算法中的一个基本课题。该问题在科学上和数学上都是合理的。\n- 良置性与客观性：该问题是良置的，所有必要参数（$L$、模块大小、成本函数和贪心算法定义）都已明确说明。术语精确且客观。存在唯一的贪心解和至少一个最优解。\n- 结论：该问题有效。这是一个算法分析的标准练习。\n\n**求解过程：**\n该问题需要计算两个量：使用给定面额集合为目标值 $L$ 找零时，特定贪心算法的成本和最优解的成本。成本定义为所用物品（模块）的数量。\n\n设可用模块大小的集合为 $S = \\{1, 3, 4\\}$。目标长度为 $L = 6$。\n\n**第1部分：计算贪心策略的成本**\n贪心策略规定，在每一步中，我们必须从 $S$ 中选择小于或等于剩余长度的最大模块大小。\n\n设 $L_{rem}$ 为待切除的剩余长度。初始时，$L_{rem} = 6$。\n\n- **步骤 1：** 当前剩余长度为 $L_{rem} = 6$。可用模块大小为 $\\{1, 3, 4\\}$。小于或等于 $6$ 的最大模块大小是 $4$。\n  - 我们切除一个大小为 $4$ kbp 的模块。\n  - 新的剩余长度为 $L_{rem} = 6 - 4 = 2$。\n  - 到目前为止产生的成本为 $1$。\n\n- **步骤 2：** 当前剩余长度为 $L_{rem} = 2$。可用模块大小为 $\\{1, 3, 4\\}$。小于或等于 $2$ 的最大模块大小是 $1$。\n  - 我们切除一个大小为 $1$ kbp 的模块。\n  - 新的剩余长度为 $L_{rem} = 2 - 1 = 1$。\n  - 总成本现在是 $1 + 1 = 2$。\n\n- **步骤 3：** 当前剩余长度为 $L_{rem} = 1$。可用模块大小为 $\\{1, 3, 4\\}$。小于或等于 $1$ 的最大模块大小是 $1$。\n  - 我们切除一个大小为 $1$ kbp 的模块。\n  - 新的剩余长度为 $L_{rem} = 1 - 1 = 0$。\n  - 总成本现在是 $2 + 1 = 3$。\n\n由于剩余长度为 $0$，过程终止。根据贪心策略，切除的模块序列为 $(4, 1, 1)$。总成本，即切除的模块数量，为 $3$。设此成本为 $C_{greedy}$。\n$$C_{greedy} = 3$$\n\n**第2部分：计算最优（最小）成本**\n最优解对应于找到模块大小的一个线性组合，其总和为 $L$，同时使项数最小化。我们在寻找非负整数 $n_1, n_3, n_4$，使得：\n$$1 \\cdot n_1 + 3 \\cdot n_3 + 4 \\cdot n_4 = 6$$\n并且总成本 $C = n_1 + n_3 + n_4$ 被最小化。\n\n我们可以通过系统地检查总和为 $6$ 的可用模块大小的组合来找到最优解。\n- **组合 1：** 使用两个大小为 $3$ kbp 的模块。\n  - 总长度：$3 + 3 = 6$。\n  - 总成本（模块数量）：$2$。这是一个有效解。\n- **组合 2：** 使用一个大小为 $4$ kbp 的模块。\n  - 待覆盖的剩余长度：$6 - 4 = 2$。\n  - 组成长度为 $2$ 的唯一方法是使用两个大小为 $1$ kbp 的模块。\n  - 完整的组合是 $(4, 1, 1)$。\n  - 总长度：$4 + 1 + 1 = 6$。\n  - 总成本：$3$。这是前面找到的贪心解。\n- **组合 3：** 仅使用大小为 $1$ kbp 的模块。\n  - 组合是 $(1, 1, 1, 1, 1, 1)$。\n  - 总成本：$6$。\n- **组合 4：** 使用一个大小为 $3$ kbp 的模块。\n  - 剩余长度：$6 - 3 = 3$。\n  - 这可以用一个大小为 $3$ kbp 的模块（即组合 1）或三个大小为 $1$ kbp 的模块来填充。\n  - 后者的组合是 $(3, 1, 1, 1)$。\n  - 总成本：$4$。\n\n通过比较所有有效组合的成本，我们得到：\n- $(3, 3)$ 的成本是 $2$。\n- $(4, 1, 1)$ 的成本是 $3$。\n- $(1, 1, 1, 1, 1, 1)$ 的成本是 $6$。\n- $(3, 1, 1, 1)$ 的成本是 $4$。\n\n最小成本是 $2$。设此成本为 $C_{optimal}$。\n$$C_{optimal} = 2$$\n这证明了一个众所周知的性质，即贪心算法对于一般的找零问题并非总是最优的。\n\n**第3部分：最终计算**\n问题要求计算贪心成本与最优成本之间的差值。\n$$\\text{Difference} = C_{greedy} - C_{optimal} = 3 - 2 = 1$$\n差值为 $1$。",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "在掌握了组合问题中的基本概念后，我们现在转向一个空间路径规划问题。轴突导向是神经发育中的一个关键生物学过程，生长中的轴突会跟随化学信号到达其预定目标。将此过程建模为在化学浓度梯度场上的“贪心行走”是一种有效的简化方法。这个练习  展示了贪心算法如何被“困”在局部最优解中，从而无法找到真正的全局最优目标，这是该算法范式的一种常见失败模式。",
            "id": "2396175",
            "problem": "在神经发育过程中的轴突导向中，生长锥会对细胞外的化学信号做出反应，倾向于沿净化学引诱梯度向上移动。考虑一个简化的离散模型，其中轴突生长锥被建模为图上的一种贪婪行走。设环境为一个网格图 $G=(V,E)$，其中 $V=\\{p_{x,y}\\mid x,y\\in\\{0,1,2\\}\\}$，$p_{x,y}$ 表示在整数坐标 $x$ 和 $y$ 处的格点。当且仅当 $|x-x'|+|y-y'|=1$（四邻域连通性）时，存在一条无向边 $\\{p_{x,y},p_{x',y'}\\}\\in E$。一个标量场 $U:V\\to\\mathbb{R}$ 编码了净导向势（越高的 $U$ 值越具吸引力），这可以解释为多种引诱物和排斥物在生长锥处经过受体加权后的综合效应。\n\n贪婪行走规则是：从 $S=p_{0,1}$ 开始，在节点 $x\\in V$ 的每一步，从其邻居 $N(x)=\\{v\\in V\\mid \\{x,v\\}\\in E\\}$ 中，选择一个节点 $v^\\star\\in N(x)$，该节点在满足 $U(v)U(x)$ 的条件下最大化增量 $\\Delta U=U(v)-U(x)$；然后移动到 $v^\\star$。如果没有邻居满足 $U(v)U(x)$，则停止（生长锥停在 $U$ 的一个局部最大值点）。\n\n有两个特殊节点：正确目标 $C=p_{2,2}$ 和错误目标 $W=p_{2,0}$。你的任务是分析四个候选势能图（$U$ 值的分配方案），并确定哪一个方案会使得从 $S$ 开始的贪婪轴突终止于错误目标 $W$ 而不是正确目标 $C$，即便 $C$ 是 $U$ 在 $V$ 上的唯一全局最大值点。\n\n选择一个选项。\n\nA. 图 $\\mathcal{M}_A$:\n- $U(p_{0,1})=0$ (起点 $S$), $U(p_{1,1})=1$, $U(p_{0,0})=3$, $U(p_{0,2})=2$。\n- $U(p_{1,0})=5$, $U(p_{2,0})=8$ (错误目标 $W$), $U(p_{2,1})=7$。\n- $U(p_{1,2})=6$, $U(p_{2,2})=10$ (正确目标 $C$)。\n\nB. 图 $\\mathcal{M}_B$:\n- $U(p_{0,1})=0$ (起点 $S$), $U(p_{1,1})=3$, $U(p_{0,0})=1$, $U(p_{0,2})=4$。\n- $U(p_{1,0})=2$, $U(p_{2,0})=6$ (错误目标 $W$), $U(p_{2,1})=8$。\n- $U(p_{1,2})=7$, $U(p_{2,2})=10$ (正确目标 $C$)。\n\nC. 图 $\\mathcal{M}_C$:\n- $U(p_{0,1})=0$ (起点 $S$), $U(p_{1,1})=1$, $U(p_{0,0})=3$, $U(p_{0,2})=2$。\n- $U(p_{1,0})=5$, $U(p_{2,0})=12$ (错误目标 $W$), $U(p_{2,1})=7$。\n- $U(p_{1,2})=6$, $U(p_{2,2})=10$ (正确目标 $C$)。\n\nD. 图 $\\mathcal{M}_D$:\n- $U(p_{0,1})=0$ (起点 $S$), $U(p_{1,1})=4$, $U(p_{0,0})=2$, $U(p_{0,2})=3$。\n- $U(p_{1,0})=1$, $U(p_{2,0})=8$ (错误目标 $W$), $U(p_{2,1})=5$。\n- $U(p_{1,2})=2$, $U(p_{2,2})=10$ (正确目标 $C$)。\n\n哪个图满足所述条件？",
            "solution": "在尝试解答之前，对问题陈述进行验证。\n\n首先，我们逐字提取给定的信息：\n- 图是一个网格图 $G=(V,E)$，其顶点为 $V=\\{p_{x,y}\\mid x,y\\in\\{0,1,2\\}\\}$。\n- 当且仅当 $|x-x'|+|y-y'|=1$ 时，存在一条边 $\\{p_{x,y},p_{x',y'}\\}\\in E$。\n- 在顶点上定义了一个标量势场 $U:V\\to\\mathbb{R}$。\n- 起始节点是 $S=p_{0,1}$。\n- 贪婪行走规则：从一个节点 $x$ 出发，移动到一个邻居 $v^\\star$，该邻居在满足约束 $U(v)U(x)$ 的前提下，最大化增量 $\\Delta U=U(v)-U(x)$。如果没有这样的邻居，行走停止。\n- 正确目标是 $C=p_{2,2}$。\n- 错误目标是 $W=p_{2,0}$。\n- 任务是找出四个指定的势能图中，哪一个会导致贪婪行走终止于 $W$，条件是 $C$ 是 $U$ 的唯一全局最大值点。\n\n接下来，我们根据既定标准验证问题陈述。\n- **科学依据**：该问题提出了一个高度简化但在概念上合理的轴突导向模型。使用离散图、势场和贪婪算法来模拟趋化性是计算生物学中的一种标准方法，也是一种可接受的抽象。它并非基于伪科学。\n- **良构性**：图的结构、起始点和贪婪行走规则都有明确的定义。该规则是确定性的，保证了对于任何给定的势能图，都存在唯一的路径和终止点。问题是精确的，并且允许一个可验证的单一答案。\n- **客观性**：问题以形式化的数学语言陈述，没有主观或模糊的术语。\n- **完整性**：为进行分析提供了所有必要的数据（每个图的势能值）。问题是自洽的。\n\n问题陈述被认定为有效。这是一个图论和算法中的良构问题，与计算生物学相关。我们可以继续进行解答。\n\n该问题要求我们确定哪个势能图 $\\mathcal{M}$ 同时满足两个条件：\n1. 从 $S=p_{0,1}$ 开始的贪婪行走终止于错误目标 $W=p_{2,0}$。\n2. 正确目标 $C=p_{2,2}$ 是势 $U$ 在顶点集 $V$ 上的唯一全局最大值点。\n\n我们将分析四个候选图中的每一个。顶点集为 $V = \\{p_{0,0}, p_{0,1}, p_{0,2}, p_{1,0}, p_{1,1}, p_{1,2}, p_{2,0}, p_{2,1}, p_{2,2}\\}$。\n\n**对图 $\\mathcal{M}_A$ 的分析**\n势能值为：\n$U(p_{0,1})=0$, $U(p_{1,1})=1$, $U(p_{0,0})=3$, $U(p_{0,2})=2$。\n$U(p_{1,0})=5$, $U(p_{2,0})=8$, $U(p_{2,1})=7$。\n$U(p_{1,2})=6$, $U(p_{2,2})=10$。\n\n首先，我们检查全局最大值条件。最大势能值是 $U(p_{2,2})=10$。该值在所有顶点中是唯一的。因此，$C=p_{2,2}$ 是唯一的全局最大值点。此条件满足。\n\n接下来，我们追踪贪婪行走：\n- **步骤1：** 从 $S=p_{0,1}$ 开始，此处 $U(p_{0,1})=0$。其邻居为 $p_{0,0}$、$p_{1,1}$ 和 $p_{0,2}$。\n  - $U(p_{0,0})=3$，所以 $\\Delta U = 3-0=3$。\n  - $U(p_{1,1})=1$，所以 $\\Delta U = 1-0=1$。\n  - $U(p_{0,2})=2$，所以 $\\Delta U = 2-0=2$。\n  最大增量为 $\\Delta U = 3$，对应移动到 $p_{0,0}$。路径开始为：$p_{0,1} \\to p_{0,0}$。\n\n- **步骤2：** 当前节点为 $p_{0,0}$，其 $U(p_{0,0})=3$。邻居为 $p_{0,1}$ 和 $p_{1,0}$。\n  - $U(p_{0,1})=0$，小于 $U(p_{0,0})=3$。此移动不允许。\n  - $U(p_{1,0})=5$，所以 $\\Delta U = 5-3=2$。\n  唯一有效的移动是到 $p_{1,0}$。路径现在是：$p_{0,1} \\to p_{0,0} \\to p_{1,0}$。\n\n- **步骤3：** 当前节点为 $p_{1,0}$，其 $U(p_{1,0})=5$。邻居为 $p_{0,0}$、$p_{1,1}$ 和 $p_{2,0}$。\n  - $U(p_{0,0})=3  5$。\n  - $U(p_{1,1})=1  5$。\n  - $U(p_{2,0})=8$，所以 $\\Delta U = 8-5=3$。\n  唯一有效的移动是到 $p_{2,0}$。路径为：$p_{0,1} \\to p_{0,0} \\to p_{1,0} \\to p_{2,0}$。\n\n- **步骤4：** 当前节点为 $p_{2,0}=W$，其 $U(p_{2,0})=8$。邻居为 $p_{1,0}$ 和 $p_{2,1}$。\n  - $U(p_{1,0})=5  8$。\n  - $U(p_{2,1})=7  8$。\n  没有邻居 $v$ 满足 $U(v)U(p_{2,0})$。行走在 $p_{2,0}$ 处停止。\n\n行走终止于 $W=p_{2,0}$。图 $\\mathcal{M}_A$ 满足两个条件。\n选项A的结论：**正确**。\n\n**对图 $\\mathcal{M}_B$ 的分析**\n势能值为：\n$U(p_{0,1})=0$, $U(p_{1,1})=3$, $U(p_{0,0})=1$, $U(p_{0,2})=4$。\n$U(p_{1,0})=2$, $U(p_{2,0})=6$, $U(p_{2,1})=8$。\n$U(p_{1,2})=7$, $U(p_{2,2})=10$。\n\n最大势能为 $U(p_{2,2})=10$，是唯一的。全局最大值条件满足。\n\n我们追踪贪婪行走：\n- **步骤1：** 从 $S=p_{0,1}$ 开始，此处 $U(p_{0,1})=0$。邻居为 $p_{0,0}$、$p_{1,1}$、$p_{0,2}$。\n  - $U(p_{0,0})=1$, $\\Delta U=1$。\n  - $U(p_{1,1})=3$, $\\Delta U=3$。\n  - $U(p_{0,2})=4$, $\\Delta U=4$。\n  最大增量为 $\\Delta U = 4$，移动到 $p_{0,2}$。路径：$p_{0,1} \\to p_{0,2}$。\n\n- **步骤2：** 当前节点为 $p_{0,2}$，$U(p_{0,2})=4$。邻居为 $p_{0,1}$ 和 $p_{1,2}$。\n  - $U(p_{0,1})=0  4$。\n  - $U(p_{1,2})=7$，所以 $\\Delta U = 7-4=3$。\n  移动到 $p_{1,2}$。路径：$p_{0,1} \\to p_{0,2} \\to p_{1,2}$。\n\n- **步骤3：** 当前节点为 $p_{1,2}$，$U(p_{1,2})=7$。邻居为 $p_{0,2}$、$p_{1,1}$、$p_{2,2}$。\n  - $U(p_{0,2})=4  7$。\n  - $U(p_{1,1})=3  7$。\n  - $U(p_{2,2})=10$，所以 $\\Delta U = 10-7=3$。\n  移动到 $p_{2,2}$。路径：$p_{0,1} \\to p_{0,2} \\to p_{1,2} \\to p_{2,2}$。\n\n- **步骤4：** 当前节点为 $p_{2,2}=C$，$U(p_{2,2})=10$。这是全局最大值，所以没有邻居有更高的势能。行走停止。\n\n行走终止于 $C=p_{2,2}$，而不是 $W$。\n选项B的结论：**不正确**。\n\n**对图 $\\mathcal{M}_C$ 的分析**\n势能值为：\n$U(p_{0,1})=0$, $U(p_{1,1})=1$, $U(p_{0,0})=3$, $U(p_{0,2})=2$。\n$U(p_{1,0})=5$, $U(p_{2,0})=12$, $U(p_{2,1})=7$。\n$U(p_{1,2})=6$, $U(p_{2,2})=10$。\n\n我们检查全局最大值条件。势能值为 $\\{0, 1, 2, 3, 5, 6, 7, 10, 12\\}$。最大值是 $U(p_{2,0})=12$。问题要求 $C=p_{2,2}$ 是唯一的全局最大值点，但在此图中 $U(p_{2,2})=10$ 不是最大值。全局最大值点实际上是 $W=p_{2,0}$。该图违反了问题的一个基本前提。因此，这个选项不可能是正确答案。\n选项C的结论：**不正确**。\n\n**对图 $\\mathcal{M}_D$ 的分析**\n势能值为：\n$U(p_{0,1})=0$, $U(p_{1,1})=4$, $U(p_{0,0})=2$, $U(p_{0,2})=3$。\n$U(p_{1,0})=1$, $U(p_{2,0})=8$, $U(p_{2,1})=5$。\n$U(p_{1,2})=2$, $U(p_{2,2})=10$。\n\n最大势能为 $U(p_{2,2})=10$，是唯一的。全局最大值条件满足。\n\n我们追踪贪婪行走：\n- **步骤1：** 从 $S=p_{0,1}$ 开始，此处 $U(p_{0,1})=0$。邻居为 $p_{0,0}$、$p_{1,1}$、$p_{0,2}$。\n  - $U(p_{0,0})=2$, $\\Delta U=2$。\n  - $U(p_{1,1})=4$, $\\Delta U=4$。\n  - $U(p_{0,2})=3$, $\\Delta U=3$。\n  最大增量为 $\\Delta U = 4$，移动到 $p_{1,1}$。路径：$p_{0,1} \\to p_{1,1}$。\n\n- **步骤2：** 当前节点为 $p_{1,1}$，$U(p_{1,1})=4$。邻居为 $p_{0,1}, p_{1,0}, p_{2,1}, p_{1,2}$。\n  - $U(p_{0,1})=0  4$。\n  - $U(p_{1,0})=1  4$。\n  - $U(p_{2,1})=5$，所以 $\\Delta U = 5-4=1$。\n  - $U(p_{1,2})=2  4$。\n  唯一有效的移动是到 $p_{2,1}$。路径：$p_{0,1} \\to p_{1,1} \\to p_{2,1}$。\n\n- **步骤3：** 当前节点为 $p_{2,1}$，$U(p_{2,1})=5$。邻居为 $p_{1,1}, p_{2,0}, p_{2,2}$。\n  - $U(p_{1,1})=4  5$。\n  - $U(p_{2,0})=8$，所以 $\\Delta U = 8-5=3$。\n  - $U(p_{2,2})=10$，所以 $\\Delta U = 10-5=5$。\n  最大增量为 $\\Delta U = 5$，移动到 $p_{2,2}$。路径：$p_{0,1} \\to p_{1,1} \\to p_{2,1} \\to p_{2,2}$。\n\n- **步骤4：** 当前节点为 $p_{2,2}=C$，$U(p_{2,2})=10$。这是全局最大值，所以行走停止。\n\n行走终止于 $C=p_{2,2}$，而不是 $W$。\n选项D的结论：**不正确**。\n\n结论：只有图 $\\mathcal{M}_A$ 能引导贪婪行走至错误目标 $W$，同时满足正确目标 $C$ 是唯一全局最大值点的条件。在 $W$ 处存在的局部最大值使贪婪算法陷入了陷阱。",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "前面的例子展示了静态问题中的贪心策略。现在我们引入一个动态系统，其中贪心选择会随时间产生深远影响。在许多生物系统中，例如抗药性的演化，今天的决策会改变系统未来的状态。这个模拟练习  演示了一个短视的贪心策略——总是使用当下最有效的杀虫剂——如何无意中筛选出抗性害虫，从长远来看可能导致更糟糕的结果。",
            "id": "2396125",
            "problem": "给定一个离散时间模型，用于描述一个异质性害虫种群在固定数量的季节内，连续施用一系列农药的情况。该种群包含由 $g \\in \\{0,1,\\dots,G-1\\}$ 索引的基因型和由 $p \\in \\{0,1,\\dots,P-1\\}$ 索引的农药。季节由 $t \\in \\{1,2,\\dots,T\\}$ 索引。在季节 $t$ 开始时，基因型 $g$ 的丰度为 $N_g^{(t)} \\ge 0$，农药 $p$ 的效力（对完全易感害虫的最大杀伤比例）为 $b_p \\in [0,1]$，基因型 $g$ 对农药 $p$ 的抗性水平为 $R_{g,p}^{(t)} \\in [0,1]$。每个基因型 $g$ 都有一个季节性的倍增生长因子 $r_g  0$，该因子在季节内农药效应之后应用。每种农药 $p$ 都有一个适应速率 $a_p \\ge 0$，用于控制在使用该农药后其抗性增加的速度。\n\n季节内决策规则：对于每种农药 $p$，定义其在季节 $t$ 的瞬时预期杀伤量为\n$$\nK_p^{(t)} = \\sum_{g=0}^{G-1} N_g^{(t)} \\, b_p \\, \\bigl(1 - R_{g,p}^{(t)}\\bigr).\n$$\n在季节 $t$ 内，选择施用的农药 $\\hat p^{(t)}$ 以最大化 $K_p^{(t)}$。如果多种农药达到相同的最大值，则选择索引最小的那一种。\n\n季节内动态：给定所选农药 $\\hat p^{(t)}$，处理后基因型 $g$ 的存活数量为\n$$\nS_g^{(t)} = N_g^{(t)} \\,\\Bigl(1 - b_{\\hat p^{(t)}} \\bigl(1 - R_{g,\\hat p^{(t)}}^{(t)}\\bigr)\\Bigr),\n$$\n总存活数量为 $S^{(t)} = \\sum_{g=0}^{G-1} S_g^{(t)}$。对所施用农药的抗性根据存活者的构成进行更新：\n$$\nR_{g,\\hat p^{(t)}}^{(t+1)} = \\begin{cases} \\min\\left\\{1, R_{g,\\hat p^{(t)}}^{(t)} + a_{\\hat p^{(t)}} \\frac{S_g^{(t)}}{S^{(t)}}\\right\\},  \\text{若 } S^{(t)} > 0 \\\\[8pt] R_{g,\\hat p^{(t)}}^{(t)},  \\text{若 } S^{(t)} = 0 \\end{cases}\n$$\n而对所有未施用农药的抗性在本季节内保持不变，即对于所有 $p \\ne \\hat p^{(t)}$ 都有 $R_{g,p}^{(t+1)} = R_{g,p}^{(t)}$。然后种群进行繁殖：\n$$\nN_g^{(t+1)} = S_g^{(t)} \\, r_g.\n$$\n初始条件 $N_g^{(1)}$ 和 $R_{g,p}^{(1)}$ 已给出。在 $T$ 个季节后，报告最终的总丰度\n$$\nN_{\\text{total}}^{(T+1)} = \\sum_{g=0}^{G-1} N_g^{(T+1)}.\n$$\n\n索引：农药索引和基因型索引都是从零开始的，即最小索引为 $0$。\n\n任务：实现一个程序，精确执行上述动态过程，并为下面每个独立的测试用例返回最终的总丰度 $N_{\\text{total}}^{(T+1)}$。将每个报告值四舍五入到 $6$ 位小数。不涉及物理单位。\n\n测试套件（每个测试用例都明确列出 $G$、$P$、$T$、初始丰度向量 $N^{(1)}$、生长因子 $r$、效力向量 $b$、形状为 $G \\times P$ 的初始抗性矩阵 $R^{(1)}$ 以及适应速率 $a$）：\n\n- 测试用例 1（一般情况）：\n  - $G = 3$, $P = 2$, $T = 8$。\n  - $N^{(1)} = [\\,500.0,\\;300.0,\\;200.0\\,]$。\n  - $r = [\\,1.2,\\;1.1,\\;1.05\\,]$。\n  - $b = [\\,0.6,\\;0.4\\,]$。\n  - $$ R^{(1)} = \\begin{bmatrix} 0.1  0.2 \\\\[4pt] 0.0  0.5 \\\\[4pt] 0.3  0.1 \\end{bmatrix} $$。\n  - $a = [\\,0.2,\\;0.15\\,]$。\n\n- 测试用例 2（平局打破与无适应）：\n  - $G = 2$, $P = 2$, $T = 3$。\n  - $N^{(1)} = [\\,100.0,\\;100.0\\,]$。\n  - $r = [\\,1.0,\\;1.0\\,]$。\n  - $b = [\\,0.5,\\;0.5\\,]$。\n  - $$ R^{(1)} = \\begin{bmatrix} 0.0  0.0 \\\\[4pt] 0.0  0.0 \\end{bmatrix} $$。\n  - $a = [\\,0.0,\\;0.0\\,]$。\n\n- 测试用例 3（对更强的农药具有初始高抗性）：\n  - $G = 2$, $P = 2$, $T = 5$。\n  - $N^{(1)} = [\\,1000.0,\\;10.0\\,]$。\n  - $r = [\\,1.05,\\;0.9\\,]$。\n  - $b = [\\,0.7,\\;0.3\\,]$。\n  - $$ R^{(1)} = \\begin{bmatrix} 0.9  0.0 \\\\[4pt] 0.9  0.0 \\end{bmatrix} $$。\n  - $a = [\\,0.1,\\;0.05\\,]$。\n\n- 测试用例 4（下降的增长和几乎无效的农药）：\n  - $G = 1$, $P = 3$, $T = 4$。\n  - $N^{(1)} = [\\,50.0\\,]$。\n  - $r = [\\,0.8\\,]$。\n  - $b = [\\,0.9,\\;0.2,\\;0.0\\,]$。\n  - $$ R^{(1)} = \\begin{bmatrix} 0.0  0.5  0.0 \\end{bmatrix} $$。\n  - $a = [\\,0.3,\\;0.0,\\;0.0\\,]$。\n\n最终输出格式：您的程序应生成单行输出，其中包含按顺序排列的四个结果，四舍五入到 $6$ 位小数，形式为方括号内以逗号分隔的列表；例如，形如 $[x_1,x_2,x_3,x_4]$ 的输出，其中每个 $x_i$ 是一个四舍五入到 $6$ 位小数的实数。",
            "solution": "对问题陈述进行验证。\n\n步骤 1：提取给定条件\n该问题描述了一个在农药压力下的害虫种群的离散时间模型。\n- 季节 $t$ 开始时的状态变量：\n  - $N_g^{(t)}$：基因型 $g$ 的丰度。\n  - $R_{g,p}^{(t)}$：基因型 $g$ 对农药 $p$ 的抗性水平。\n- 索引：\n  - 基因型：$g \\in \\{0, 1, \\dots, G-1\\}$。\n  - 农药：$p \\in \\{0, 1, \\dots, P-1\\}$。\n  - 季节：$t \\in \\{1, 2, \\dots, T\\}$。\n- 参数：\n  - $r_g$：基因型 $g$ 的倍增生长因子。\n  - $b_p$：农药 $p$ 的效力。\n  - $a_p$：农药 $p$ 的适应速率。\n- 初始条件：$N_g^{(1)}$ 和 $R_{g,p}^{(1)}$ 已给出。\n- 季节 $t$ 中农药选择的决策规则：\n  - 所选农药 $\\hat p^{(t)}$ 是使瞬时预期杀伤量 $K_p^{(t)}$ 最大化的那一个。\n  - $K_p^{(t)} = \\sum_{g=0}^{G-1} N_g^{(t)} \\, b_p \\, (1 - R_{g,p}^{(t)})$。\n  - 平局打破：如果多种农药产生相同的最大 $K_p^{(t)}$，则选择索引 $p$ 最小的那一个。\n- 季节 $t$ 内的动态：\n  - 基因型 $g$ 的存活数量：$S_g^{(t)} = N_g^{(t)} \\,(1 - b_{\\hat p^{(t)}} (1 - R_{g,\\hat p^{(t)}}^{(t)}))$。\n  - 总存活数量：$S^{(t)} = \\sum_{g=0}^{G-1} S_g^{(t)}$。\n- 季节 $t+1$ 的更新规则：\n  - 对所施用农药 $\\hat p^{(t)}$ 的抗性更新：\n    $$\n    R_{g,\\hat p^{(t)}}^{(t+1)} =\n    \\begin{cases}\n    \\min\\left\\{1, R_{g,\\hat p^{(t)}}^{(t)} + a_{\\hat p^{(t)}} \\frac{S_g^{(t)}}{S^{(t)}}\\right\\},  \\text{若 } S^{(t)} > 0 \\\\\n    R_{g,\\hat p^{(t)}}^{(t)},  \\text{若 } S^{(t)} = 0\n    \\end{cases}\n    $$\n  - 对未施用农药 $p \\ne \\hat p^{(t)}$ 的抗性保持不变：$R_{g,p}^{(t+1)} = R_{g,p}^{(t)}$。\n  - 种群更新：$N_g^{(t+1)} = S_g^{(t)} \\cdot r_g$。\n- 最终输出：\n  - 计算 $T$ 个季节后的总丰度：$N_{\\text{total}}^{(T+1)} = \\sum_{g=0}^{G-1} N_g^{(T+1)}$。\n  - 报告此值，四舍五入到 $6$ 位小数。\n- 测试用例：提供了四组特定的参数（$G, P, T, N^{(1)}, r, b, R^{(1)}, a$）。\n\n步骤 2：使用提取的条件进行验证\n根据既定标准对问题进行评估：\n- **科学依据**：该模型是一个标准的、尽管简化的离散时间种群动态模型。指数增长、剂量反应（通过效力 $b_p$ 和抗性 $R_{g,p}^{(t)}$）以及选择驱动的抗性演化等概念是种群遗传学和生态学的基本原理。该模型是科学合理的。\n- **良态性**：该问题为系统演化提供了一整套初始条件和确定性规则。农药选择规则也是确定性的，包括明确的平局打破条件。这确保了对于给定的输入集，存在唯一的解。对于总存活数量为零（$S^{(t)} = 0$）可能导致除以零的特殊情况，也进行了明确且正确的处理。该问题是良态的。\n- **客观性**：该问题以精确的数学语言陈述，没有歧义、主观性或基于观点的论断。所有术语都得到了明确定义。\n- **缺陷分析**：\n  1. 不存在科学上或事实上的不合理之处。\n  2. 该问题是可形式化的。最大化瞬时杀伤量的农药选择规则是贪心算法的直接应用。因此，该问题与*计算生物学*背景下的*贪心算法范式*直接相关。\n  3. 设置是完整的且内部一致的。为每个测试用例提供了所有必要的数据。\n  4. 模型参数在物理上合理的范围内（例如，$b_p, R_{g,p} \\in [0,1]$）。没有不切实际或不可行的要求。\n  5. 问题没有不良设定或结构混乱。\n  6. 结果是可通过计算验证的。\n\n步骤 3：结论与操作\n该问题有效。将通过实现所述动态过程的模拟来提供解决方案。\n\n该解决方案涉及在 $T$ 个离散时间步（季节）上模拟种群和抗性动态。在任何季节 $t$ 开始时，系统的状态由基因型丰度向量 $N^{(t)}$ 和基因型-农药抗性矩阵 $R^{(t)}$ 定义。模拟过程如下，对从 $1$ 到 $T$ 的每个季节 $t$ 进行：\n\n1.  **贪心农药选择**：对于每种可用的农药 $p \\in \\{0, \\dots, P-1\\}$，计算其总瞬时杀伤量 $K_p^{(t)}$。这个量代表如果在季节 $t$ 施用农药 $p$，预计将被消灭的个体数量。\n    $$K_p^{(t)} = \\sum_{g=0}^{G-1} N_g^{(t)} \\, b_p \\, (1 - R_{g,p}^{(t)})$$\n    选择使该值最大化的农药 $\\hat p^{(t)}$。这是一种“贪心”选择，因为它优化了瞬时结果，而没有考虑未来的后果，例如抗性的演化。如果出现平局，则选择索引最小的农药。\n\n2.  **种群动态**：施用所选农药 $\\hat p^{(t)}$。根据农药的效力 $b_{\\hat p^{(t)}}$ 和基因型特定的抗性 $R_{g,\\hat p^{(t)}}^{(t)}$，计算每个基因型 $g$ 的存活数量，记为 $S_g^{(t)}$。\n    $$S_g^{(t)} = N_g^{(t)} \\, \\left(1 - b_{\\hat p^{(t)}} \\left(1 - R_{g,\\hat p^{(t)}}^{(t)}\\right)\\right)$$\n\n3.  **状态更新**：更新状态变量以反映下一季节 $t+1$ 开始时的条件。\n    - 存活者的种群进行繁殖。通过将存活数量乘以基因型特定的生长因子 $r_g$，找到每个基因型的新丰度。\n      $$N_g^{(t+1)} = S_g^{(t)} \\cdot r_g$$\n    - 对所施用农药 $\\hat p^{(t)}$ 的抗性发生演化。抗性的变化与适应速率 $a_{\\hat p^{(t)}}$ 以及该基因型在存活者中的相对频率 $S_g^{(t)}/S^{(t)}$ 成正比，其中 $S^{(t)} = \\sum S_g^{(t)}$。新的抗性上限为 $1$。对所有其他农药的抗性保持不变。\n      $$R_{g,\\hat p^{(t)}}^{(t+1)} = \\min\\left\\{1, R_{g,\\hat p^{(t)}}^{(t)} + a_{\\hat p^{(t)}} \\frac{S_g^{(t)}}{S^{(t)}}\\right\\} \\quad (\\text{对于 } S^{(t)} > 0)$$\n      $$R_{g,p}^{(t+1)} = R_{g,p}^{(t)} \\quad (\\text{对于 } p \\ne \\hat p^{(t)})$$\n\n此迭代过程重复 $T$ 个季节。在季节 $T$ 的动态过程完成后，获得种群的最终状态 $N^{(T+1)}$。要求的输出是最终总丰度 $\\sum_{g=0}^{G-1} N_g^{(T+1)}$。该实现将利用数值库来高效地执行这些向量和矩阵运算。",
            "answer": "$$\n\\boxed{\\text{[1085.166416, 25.000000, 1051.879555, 14.680064]}}\n$$"
        }
    ]
}