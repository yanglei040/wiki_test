{
    "hands_on_practices": [
        {
            "introduction": "The power of a Position-Specific Scoring Matrix (PSSM) lies in its use of log-odds scores, which evaluate the likelihood of a sequence originating from a motif versus a background model. This practice problem provides a concrete example to illustrate a crucial concept: why a sequence that seems less probable under a simple Position Weight Matrix (PWM) might receive a higher, more significant score from a PSSM. By working through this calculation , you will gain a deeper intuition for how background frequencies critically shape motif discovery.",
            "id": "2415079",
            "problem": "Consider a DNA motif of length $2$ represented by the following Position Weight Matrix (PWM; probabilities) over the alphabet $\\{A,C,G,T\\}$:\n\nPosition $1$: $P(A)=0.5$, $P(C)=0.2$, $P(G)=0.2$, $P(T)=0.1$.\n\nPosition $2$: $P(A)=0.4$, $P(C)=0.3$, $P(G)=0.2$, $P(T)=0.1$.\n\nAssume the background nucleotide frequencies are $b(A)=0.7$, $b(C)=0.1$, $b(G)=0.1$, $b(T)=0.1$.\n\nLet sequence $\\mathcal{A}$ be the dinucleotide with letters $A$ at both positions (i.e., $A$-$A$), and let sequence $\\mathcal{B}$ be the dinucleotide with letters $C$ at both positions (i.e., $C$-$C$).\n\nUsing the standard definition of a Position-Specific Scoring Matrix (PSSM; log-odds), the log-odds score of a sequence $s=s_1s_2$ is\n$$\nS(s)=\\sum_{i=1}^{2}\\ln\\!\\left(\\frac{P_i(s_i)}{b(s_i)}\\right),\n$$\nwhere $P_i(x)$ is the PWM probability of letter $x$ at position $i$, $b(x)$ is the background frequency of $x$, and $\\ln$ denotes the natural logarithm.\n\nCompute the difference $\\Delta=S(\\mathcal{B})-S(\\mathcal{A})$. Round your answer to $4$ significant figures.",
            "solution": "The problem is subjected to validation before any solution is attempted.\n\nFirst, we extract the givens from the problem statement.\nThe motif length is $2$.\nThe alphabet is $\\{A, C, G, T\\}$.\nThe Position Weight Matrix (PWM) probabilities are:\nFor position $i=1$: $P_1(A)=0.5$, $P_1(C)=0.2$, $P_1(G)=0.2$, $P_1(T)=0.1$.\nFor position $i=2$: $P_2(A)=0.4$, $P_2(C)=0.3$, $P_2(G)=0.2$, $P_2(T)=0.1$.\nThe background nucleotide frequencies are: $b(A)=0.7$, $b(C)=0.1$, $b(G)=0.1$, $b(T)=0.1$.\nSequence $\\mathcal{A}$ is defined as the dinucleotide $AA$.\nSequence $\\mathcal{B}$ is defined as the dinucleotide $CC$.\nThe log-odds score for a sequence $s=s_1s_2$ is defined by the formula:\n$$S(s)=\\sum_{i=1}^{2}\\ln\\!\\left(\\frac{P_i(s_i)}{b(s_i)}\\right)$$\nThe task is to compute the difference $\\Delta=S(\\mathcal{B})-S(\\mathcal{A})$ and round the answer to $4$ significant figures.\n\nNext, we validate the problem statement.\nThe problem is scientifically grounded. It utilizes standard concepts from bioinformatics, namely Position Weight Matrices (PWMs) and Position-Specific Scoring Matrices (PSSMs), and the correct log-odds scoring function. All probabilities and background frequencies are non-negative and sum to $1$ where appropriate ($0.5+0.2+0.2+0.1=1.0$, $0.4+0.3+0.2+0.1=1.0$, $0.7+0.1+0.1+0.1=1.0$). The problem is well-posed, as all necessary information for a unique numerical solution is provided. The language is objective and precise. There are no contradictions, missing data, or ambiguities. The problem is therefore deemed valid. We proceed with the solution.\n\nThe log-odds score $S(s)$ for a sequence $s = s_1s_2$ is given by the sum of scores at each position:\n$$S(s) = \\ln\\left(\\frac{P_1(s_1)}{b(s_1)}\\right) + \\ln\\left(\\frac{P_2(s_2)}{b(s_2)}\\right)$$\n\nFirst, we calculate the score for sequence $\\mathcal{A} = AA$. For this sequence, $s_1 = A$ and $s_2 = A$.\nThe score $S(\\mathcal{A})$ is:\n$$S(\\mathcal{A}) = \\ln\\left(\\frac{P_1(A)}{b(A)}\\right) + \\ln\\left(\\frac{P_2(A)}{b(A)}\\right)$$\nSubstituting the given values:\n$$S(\\mathcal{A}) = \\ln\\left(\\frac{0.5}{0.7}\\right) + \\ln\\left(\\frac{0.4}{0.7}\\right)$$\nUsing the property of logarithms $\\ln(x) + \\ln(y) = \\ln(xy)$:\n$$S(\\mathcal{A}) = \\ln\\left(\\frac{0.5}{0.7} \\times \\frac{0.4}{0.7}\\right) = \\ln\\left(\\frac{0.2}{0.49}\\right)$$\n\nNext, we calculate the score for sequence $\\mathcal{B} = CC$. For this sequence, $s_1 = C$ and $s_2 = C$.\nThe score $S(\\mathcal{B})$ is:\n$$S(\\mathcal{B}) = \\ln\\left(\\frac{P_1(C)}{b(C)}\\right) + \\ln\\left(\\frac{P_2(C)}{b(C)}\\right)$$\nSubstituting the given values:\n$$S(\\mathcal{B}) = \\ln\\left(\\frac{0.2}{0.1}\\right) + \\ln\\left(\\frac{0.3}{0.1}\\right) = \\ln(2) + \\ln(3)$$\nUsing the property of logarithms again:\n$$S(\\mathcal{B}) = \\ln(2 \\times 3) = \\ln(6)$$\n\nWe are required to compute the difference $\\Delta = S(\\mathcal{B}) - S(\\mathcal{A})$.\n$$\\Delta = \\ln(6) - \\ln\\left(\\frac{0.2}{0.49}\\right)$$\nUsing the property of logarithms $\\ln(x) - \\ln(y) = \\ln(x/y)$:\n$$\\Delta = \\ln\\left(\\frac{6}{0.2/0.49}\\right) = \\ln\\left(\\frac{6 \\times 0.49}{0.2}\\right)$$\nCalculation of the argument of the logarithm:\n$$\\frac{6 \\times 0.49}{0.2} = \\frac{2.94}{0.2} = 14.7$$\nSo, the exact value of the difference is:\n$$\\Delta = \\ln(14.7)$$\nNow, we compute the numerical value and round it to $4$ significant figures.\n$$\\Delta \\approx 2.687847387...$$\nRounding to $4$ significant figures gives $2.688$.\nThis is the final result.",
            "answer": "$$\\boxed{2.688}$$"
        },
        {
            "introduction": "While PSSMs are powerful tools, applying them naively to real genomic sequences can lead to misleading results. Genomes are not uniform collections of nucleotides; they contain regions of biased composition, such as simple repeats or AT-rich segments. This exercise  will guide you to understand why these low-complexity regions can generate a large number of high-scoring, yet spurious, hits, underscoring the importance of masking them to ensure the statistical integrity of a motif search.",
            "id": "2415063",
            "problem": "You are scanning deoxyribonucleic acid (DNA) for a transcription factor binding motif using a Position-Specific Scoring Matrix (PSSM). The PSSM is defined by position-specific nucleotide probabilities for motif length $4$ as follows (rows are positions $1$ through $4$; columns list probabilities for A, C, G, T in that order):\n\n- Position $1$: $(0.70,\\;0.10,\\;0.05,\\;0.15)$\n- Position $2$: $(0.25,\\;0.10,\\;0.05,\\;0.60)$\n- Position $3$: $(0.65,\\;0.10,\\;0.05,\\;0.20)$\n- Position $4$: $(0.15,\\;0.10,\\;0.05,\\;0.70)$\n\nAssume a genome-wide background where each nucleotide has probability $0.25$, and assume log-likelihood ratio scoring uses the natural logarithm (units: nats). Consider scanning the following two genomic segments with a sliding window of length $4$:\n\n- AT-rich segment $S_{\\mathrm{AT}}$: 5'- TTTATATATTTAAAATAT -3' (length $18$)\n- Compositionally balanced control $S_{\\mathrm{ctrl}}$: 5'- CGTACGCGTACG -3' (length $12$)\n\nWhich of the following statements are correct?\n\nA. Masking low-complexity or simple-repeat regions prior to PSSM scanning reduces false positives because local compositional bias causes many windows to obtain elevated scores under the log-odds model even without true motif instances.\n\nB. Among the windows “ATAT”, “TATA”, “TTAA”, and “ACGT” that occur in the sequences above, “ATAT” achieves the largest log-odds score under the given PSSM and background, providing an example of a high-scoring but potentially spurious hit in the AT-rich segment.\n\nC. The main purpose of masking low-complexity regions is to speed up scanning; masking has negligible impact on the expected number of false positives at any fixed score threshold.\n\nD. If low-complexity regions are not masked, the null distribution of PSSM scores is biased by local base composition, and reported $P$-values or $E$-values for A/T-rich matches tend to be too small (anti-conservative).\n\nE. PSSMs inherently correct for local base composition at each genomic locus, so repeats and low-complexity segments neither inflate scores nor bias statistical significance.",
            "solution": "We begin with a critical validation of the problem statement.\n\n### Step 1: Extract Givens\n\n-   **Motif Model**: A Position-Specific Scoring Matrix (PSSM) for a motif of length $L=4$. The probabilities of observing nucleotide $N \\in \\{A, C, G, T\\}$ at each position $i \\in \\{1, 2, 3, 4\\}$ are as follows:\n    -   Position $1$: $P(N_1) = (0.70, 0.10, 0.05, 0.15)$ for $(A, C, G, T)$.\n    -   Position $2$: $P(N_2) = (0.25, 0.10, 0.05, 0.60)$ for $(A, C, G, T)$.\n    -   Position $3$: $P(N_3) = (0.65, 0.10, 0.05, 0.20)$ for $(A, C, G, T)$.\n    -   Position $4$: $P(N_4) = (0.15, 0.10, 0.05, 0.70)$ for $(A, C, G, T)$.\n\n-   **Background Model**: A uniform background where the probability of each nucleotide is $P_{bg}(N) = 0.25$.\n\n-   **Scoring Scheme**: Log-likelihood ratio scoring using the natural logarithm ($\\ln$), with scores in units of nats. The score for a sequence $S = s_1s_2s_3s_4$ is $Score(S) = \\sum_{i=1}^{4} \\ln\\left(\\frac{P(s_i \\text{ at position } i)}{P_{bg}(s_i)}\\right)$.\n\n-   **Sequences for Scanning**:\n    -   $S_{\\mathrm{AT}}$: 5'- TTTATATATTTAAAATAT -3'. The problem states its length is $19$, but a direct count shows it is $18$ nucleotides long. This is a minor inconsistency.\n    -   $S_{\\mathrm{ctrl}}$: 5'- CGTACGCGTACG -3', with length $12$.\n\n### Step 2: Validate Using Extracted Givens\n\n-   **Scientific Grounding**: The problem is firmly grounded in computational biology and bioinformatics. PSSMs, log-odds scoring, background models, compositional bias, and masking low-complexity regions are all standard and fundamental concepts in motif finding.\n-   **Well-Posed**: The problem is well-posed. It provides all necessary data (PSSM probabilities, background model) to calculate scores and evaluate the conceptual statements.\n-   **Objective**: The problem is stated using precise, objective, and technical language.\n-   **Inconsistencies**: There is a minor factual error regarding the length of sequence $S_{\\mathrm{AT}}$ being stated as $19$ instead of its actual length of $18$. However, this typo does not impede the core task, which involves calculating scores for specific $4$-mer windows and evaluating general principles of PSSM scanning. The logic of the problem is not compromised.\n\n### Step 3: Verdict and Action\n\nThe problem is **valid**. The minor inconsistency noted is trivial and does not affect the scientific or logical integrity of the question. We may proceed to a full solution.\n\n### Solution Derivation\n\nThe score for a sequence $S = s_1s_2s_3s_4$ is calculated as the sum of log-odds scores for each position:\n$$Score(S) = \\sum_{i=1}^{4} \\ln\\left(\\frac{P_M(s_i, i)}{P_{bg}(s_i)}\\right)$$\nwhere $P_M(s_i, i)$ is the probability of nucleotide $s_i$ at position $i$ from the motif model, and $P_{bg}(s_i) = 0.25$ is the background probability.\n\nLet us pre-calculate the log-odds scoring matrix, which we denote as $M$. The entry $M_{i,N}$ is the score for nucleotide $N$ at position $i$.\n\n-   **Position $1$**:\n    -   $M_{1,A} = \\ln(0.70/0.25) = \\ln(2.8) \\approx 1.0296$\n    -   $M_{1,C} = \\ln(0.10/0.25) = \\ln(0.4) \\approx -0.9163$\n    -   $M_{1,G} = \\ln(0.05/0.25) = \\ln(0.2) \\approx -1.6094$\n    -   $M_{1,T} = \\ln(0.15/0.25) = \\ln(0.6) \\approx -0.5108$\n\n-   **Position $2$**:\n    -   $M_{2,A} = \\ln(0.25/0.25) = \\ln(1) = 0$\n    -   $M_{2,C} = \\ln(0.10/0.25) = \\ln(0.4) \\approx -0.9163$\n    -   $M_{2,G} = \\ln(0.05/0.25) = \\ln(0.2) \\approx -1.6094$\n    -   $M_{2,T} = \\ln(0.60/0.25) = \\ln(2.4) \\approx 0.8755$\n\n-   **Position $3$**:\n    -   $M_{3,A} = \\ln(0.65/0.25) = \\ln(2.6) \\approx 0.9555$\n    -   $M_{3,C} = \\ln(0.10/0.25) = \\ln(0.4) \\approx -0.9163$\n    -   $M_{3,G} = \\ln(0.05/0.25) = \\ln(0.2) \\approx -1.6094$\n    -   $M_{3,T} = \\ln(0.20/0.25) = \\ln(0.8) \\approx -0.2231$\n\n-   **Position $4$**:\n    -   $M_{4,A} = \\ln(0.15/0.25) = \\ln(0.6) \\approx -0.5108$\n    -   $M_{4,C} = \\ln(0.10/0.25) = \\ln(0.4) \\approx -0.9163$\n    -   $M_{4,G} = \\ln(0.05/0.25) = \\ln(0.2) \\approx -1.6094$\n    -   $M_{4,T} = \\ln(0.70/0.25) = \\ln(2.8) \\approx 1.0296$\n\nNow, we evaluate each statement.\n\n**A. Masking low-complexity or simple-repeat regions prior to PSSM scanning reduces false positives because local compositional bias causes many windows to obtain elevated scores under the log-odds model even without true motif instances.**\n\nThe log-odds score is predicated on a null model of a uniform, random background. Genomic regions with low complexity (e.g., AT-rich regions, homopolymer runs) violate this assumption; their local nucleotide composition is highly skewed. The provided PSSM is biased towards `A` and `T`. When scanning an AT-rich region, windows are more likely to contain `A`s and `T`s simply due to the local composition. Since the PSSM assigns high scores to `A` and `T` at most positions, random windows from this region will achieve systematically higher scores than random windows from a compositionally balanced region. This leads to an increased rate of high-scoring hits that do not represent true functional binding sites, i.e., an increase in false positives. Masking these regions—excluding them from the scan—is a standard and necessary procedure to mitigate this statistical artifact and reduce the false positive rate. The statement is a correct description of a fundamental issue in sequence analysis.\n**Verdict: Correct**\n\n**B. Among the windows “ATAT”, “TATA”, “TTAA”, and “ACGT” that occur in the sequences above, “ATAT” achieves the largest log-odds score under the given PSSM and background, providing an example of a high-scoring but potentially spurious hit in the AT-rich segment.**\n\nWe must calculate the score for each specified $4$-mer.\n-   $Score(\\text{ATAT}) = M_{1,A} + M_{2,T} + M_{3,A} + M_{4,T} = \\ln(2.8) + \\ln(2.4) + \\ln(2.6) + \\ln(2.8) \\approx 1.0296 + 0.8755 + 0.9555 + 1.0296 = 3.8902$\n-   $Score(\\text{TATA}) = M_{1,T} + M_{2,A} + M_{3,T} + M_{4,A} = \\ln(0.6) + \\ln(1) + \\ln(0.8) + \\ln(0.6) \\approx -0.5108 + 0 - 0.2231 - 0.5108 = -1.2447$\n-   $Score(\\text{TTAA}) = M_{1,T} + M_{2,T} + M_{3,A} + M_{4,A} = \\ln(0.6) + \\ln(2.4) + \\ln(2.6) + \\ln(0.6) \\approx -0.5108 + 0.8755 + 0.9555 - 0.5108 = 0.8094$\n-   $Score(\\text{ACGT}) = M_{1,A} + M_{2,C} + M_{3,G} + M_{4,T} = \\ln(2.8) + \\ln(0.4) + \\ln(0.2) + \\ln(2.8) \\approx 1.0296 - 0.9163 - 1.6094 + 1.0296 = -0.4665$\n\nComparing the scores, $3.8902 > 0.8094 > -0.4665 > -1.2447$. The sequence `ATAT` indeed has the largest score. This sequence occurs in the AT-rich segment $S_{\\mathrm{AT}}$. As explained for option A, such a high score in a compositionally biased region that matches the bias of the PSSM is a classic example of a potentially spurious hit. The high score arises from the confluence of the motif's preference and the background's composition, not necessarily from a specific, biologically functional sequence pattern.\n**Verdict: Correct**\n\n**C. The main purpose of masking low-complexity regions is to speed up scanning; masking has negligible impact on the expected number of false positives at any fixed score threshold.**\n\nThis statement is factually incorrect. While masking does reduce the total length of sequence to be scanned and thus offers a computational speedup, this is a secondary benefit. The primary, and scientifically critical, purpose is to improve the statistical validity of the search by removing regions where the background model is grossly violated, thereby preventing a flood of false positives. The impact on the number of false positives is far from negligible; for PSSMs that are themselves compositionally biased (like the one given), the effect can be dramatic, reducing false positives by orders of magnitude.\n**Verdict: Incorrect**\n\n**D. If low-complexity regions are not masked, the null distribution of PSSM scores is biased by local base composition, and reported $P$-values or $E$-values for A/T-rich matches tend to be too small (anti-conservative).**\n\nThe null distribution of scores, from which $P$-values and $E$-values are calculated, is theoretically derived assuming the background model is correct (i.e., uniform i.i.d. nucleotides with $P=0.25$). In a compositionally biased region (e.g., AT-rich), the empirical distribution of scores will be shifted relative to this theoretical null. Specifically, for an AT-biased PSSM in an AT-rich region, scores will be systematically inflated. A high score observed in such a region might seem highly significant (have a very small $P$-value) when compared to the theoretical null distribution. However, the probability of observing such a score by chance *given the local AT-rich composition* is much higher. Thus, the $P$-value calculated using the global, uniform background model is artificially small (an underestimate of the true local significance), which is the definition of an anti-conservative statistical test. It leads to an overestimation of significance. This statement is a precise and correct description of the statistical problem.\n**Verdict: Correct**\n\n**E. PSSMs inherently correct for local base composition at each genomic locus, so repeats and low-complexity segments neither inflate scores nor bias statistical significance.**\n\nThis statement is fundamentally false. A standard PSSM, as defined in this problem, uses a single, fixed background model ($P_{bg}$) for the entire scan. It does not dynamically adjust $P_{bg}$ to reflect the local nucleotide composition at each position being scanned. Because the PSSM formalism is \"unaware\" of local compositional changes, it does not and cannot \"inherently correct\" for them. It is precisely this lack of correction that leads to the score inflation and biased statistics described in options A and D. While advanced methods exist to address this (e.g., using adaptive background models), this is not an inherent feature of the basic PSSM itself.\n**Verdict: Incorrect**",
            "answer": "$$\\boxed{ABD}$$"
        },
        {
            "introduction": "A key step in any motif search is setting a score threshold to separate true binding sites from random background sequences. It seems intuitive that lowering this threshold would find more true sites at the cost of including more false positives. This coding exercise demonstrates a \"thresholding paradox\" : in genomes with biased composition, lowering the threshold can sometimes trigger such a massive influx of false positives that the overall precision of your predictions plummets, making your results less reliable.",
            "id": "2415093",
            "problem": "You are given a fixed Position-Specific Scoring Matrix (PSSM) for a deoxyribonucleic acid (DNA) motif and three synthetic genomes. The goal is to evaluate whether lowering a score threshold can reduce overall precision when scanning genomes with biased composition, using only first principles.\n\nDefinitions and setup:\n\n- A Position-Specific Scoring Matrix (PSSM) of length $L$ assigns, for each position $j \\in \\{1,\\dots,L\\}$ and nucleotide $b \\in \\{\\text{A},\\text{C},\\text{G},\\text{T}\\}$, an emission probability $p(b,j)$ and uses a background nucleotide frequency $q(b)$. The log-odds score of a length-$L$ word $x_1 x_2 \\dots x_L$ is\n  $$S(x_1\\dots x_L) \\;=\\; \\sum_{j=1}^{L} \\ln\\!\\left(\\frac{p(x_j,j)}{q(x_j)}\\right),$$\n  where $\\ln$ denotes the natural logarithm.\n\n- For a genome string $G$ of length $N$ over $\\{\\text{A},\\text{C},\\text{G},\\text{T}\\}$ and a fixed motif length $L$, scan all start indices $i \\in \\{0,1,\\dots,N-L\\}$ and compute $S(G[i:i+L])$. For a threshold $\\tau$, declare a predicted motif at start $i$ if and only if $S(G[i:i+L]) \\ge \\tau$.\n\n- Let the ground-truth set of motif starts for a genome $G$ be a given set $\\mathcal{T} \\subseteq \\{0,1,\\dots,N-L\\}$. Define the set of predicted starts at threshold $\\tau$ as $\\mathcal{P}_\\tau \\subseteq \\{0,1,\\dots,N-L\\}$. Define true positives $\\mathrm{TP}_\\tau = |\\mathcal{P}_\\tau \\cap \\mathcal{T}|$ and false positives $\\mathrm{FP}_\\tau = |\\mathcal{P}_\\tau \\setminus \\mathcal{T}|$. Define the precision at threshold $\\tau$ as\n  $$\\mathrm{Prec}(\\tau) \\;=\\; \\begin{cases}\n  \\dfrac{\\mathrm{TP}_\\tau}{\\mathrm{TP}_\\tau + \\mathrm{FP}_\\tau}, & \\text{if } |\\mathcal{P}_\\tau| > 0, \\\\\n  0, & \\text{if } |\\mathcal{P}_\\tau| = 0.\n  \\end{cases}$$\n\n- The PSSM to be used in all cases has length $L=5$ with emission probabilities $p(b,j)$ given by the following columns (each column lists $p(\\text{A},j),p(\\text{C},j),p(\\text{G},j),p(\\text{T},j)$ in that order):\n  - Position $j=1$: $(0.85,\\,0.05,\\,0.05,\\,0.05)$\n  - Position $j=2$: $(0.85,\\,0.05,\\,0.05,\\,0.05)$\n  - Position $j=3$: $(0.85,\\,0.05,\\,0.05,\\,0.05)$\n  - Position $j=4$: $(0.70,\\,0.10,\\,0.10,\\,0.10)$\n  - Position $j=5$: $(0.85,\\,0.05,\\,0.05,\\,0.05)$\n\n  The background frequencies are uniform: $q(\\text{A})=q(\\text{C})=q(\\text{G})=q(\\text{T})=\\dfrac{1}{4}$.\n\n- The two thresholds to be compared are $\\tau_\\text{high}=4.5$ and $\\tau_\\text{low}=3.0$.\n\nTest suite:\n\nFor each test case, you are given a genome string $G$ and a ground-truth set $\\mathcal{T}$ of motif start indices (zero-based). Use the PSSM and thresholds above without modification.\n\n- Test Case $1$ (biased genome, A-rich):\n  - Genome $G_1$ (length $N_1=39$): the exact string\n    GCAAAAACAACAACAACAACAACGAAAAATAACAACAAC\n  - Ground truth $\\mathcal{T}_1=\\{2,\\,24\\}$.\n\n- Test Case $2$ (balanced genome, planted near-threshold true sites, no exact-consensus site):\n  - Genome $G_2$ (length $N_2=32$): the exact string\n    ACGTACGTAAACACGTACGTAAAACACGT\n  - Ground truth $\\mathcal{T}_2=\\{8,\\,21\\}$.\n\n- Test Case $3$ (boundary, genome shorter than motif):\n  - Genome $G_3$ (length $N_3=4$): the exact string\n    CGTC\n  - Ground truth $\\mathcal{T}_3=\\emptyset$.\n\nTask:\n\nFor each test case $k \\in \\{1,2,3\\}$, compute $\\mathrm{Prec}_k^\\text{high}=\\mathrm{Prec}(\\tau_\\text{high})$ and $\\mathrm{Prec}_k^\\text{low}=\\mathrm{Prec}(\\tau_\\text{low})$ using the definitions above. Then, for each test case, output a boolean indicating whether lowering the threshold strictly decreases precision, that is, whether $\\mathrm{Prec}_k^\\text{low} < \\mathrm{Prec}_k^\\text{high}$.\n\nFinal output format:\n\nYour program should produce a single line of output containing the three boolean results for Test Cases $1,2,3$ in order, formatted as a comma-separated list of lowercase literals enclosed in square brackets (for example, $\\texttt{[true,false,true]}$).",
            "solution": "The problem as stated is valid. It is a well-posed computational task based on standard, sound principles of bioinformatics. All necessary data and definitions are provided, and there are no internal contradictions or scientific inaccuracies. We proceed to a full solution.\n\nThe objective is to determine, for three distinct test cases, whether lowering a score threshold for motif detection from $\\tau_\\text{high}=4.5$ to $\\tau_\\text{low}=3.0$ results in a strict decrease in precision. This requires a systematic application of the provided definitions for PSSM scoring and precision calculation.\n\nFirst, we construct the log-odds scoring matrix. The score for a nucleotide $b$ at position $j$ is given by $S(b,j) = \\ln(p(b,j)/q(b))$, where $p(b,j)$ are the emission probabilities of the motif and $q(b)$ are the background frequencies. Given a uniform background $q(b)=0.25$ for $b \\in \\{\\text{A,C,G,T}\\}$, the scoring matrix elements are calculated as follows. Let the mapping be A$\\to 0$, C$\\to 1$, G$\\to 2$, T$\\to 3$. The emission probabilities $p(b,j)$ are provided for $j \\in \\{1, \\dots, 5\\}$.\n\nThe required values for $\\ln(p/q)$ are:\n-   For $p=0.85$, score is $\\ln(0.85/0.25) = \\ln(3.4) \\approx 1.2238$.\n-   For $p=0.70$, score is $\\ln(0.70/0.25) = \\ln(2.8) \\approx 1.0296$.\n-   For $p=0.10$, score is $\\ln(0.10/0.25) = \\ln(0.4) \\approx -0.9163$.\n-   For $p=0.05$, score is $\\ln(0.05/0.25) = \\ln(0.2) \\approx -1.6094$.\n\nThis yields the $L \\times 4$ log-odds score matrix $S(j,b)$, where $j$ is the zero-indexed position from $0$ to $4$:\n$$\nS = \\begin{pmatrix}\n1.2238 & -1.6094 & -1.6094 & -1.6094 \\\\\n1.2238 & -1.6094 & -1.6094 & -1.6094 \\\\\n1.2238 & -1.6094 & -1.6094 & -1.6094 \\\\\n1.0296 & -0.9163 & -0.9163 & -0.9163 \\\\\n1.2238 & -1.6094 & -1.6094 & -1.6094\n\\end{pmatrix}\n$$\nThe score for a length-$L$ sequence $x_0 \\dots x_{L-1}$ is $\\sum_{j=0}^{L-1} S(j, \\text{map}(x_j))$. We now analyze each test case.\n\n**Test Case 1**\n-   Genome $G_1$ (length $N_1=39$): `GCAAAAACAACAACAACAACAACGAAAAATAACAACAAC`\n-   Ground truth $\\mathcal{T}_1=\\{2, 24\\}$\n-   Motif length $L=5$. Scan indices $i \\in \\{0, \\dots, 34\\}$.\n\nWe scan $G_1$ and compute scores. The consensus sequence for this PSSM is `AAAAA`, which scores $4 \\times 1.2238 + 1.0296 = 5.9248$. The genome $G_1$ contains two instances of `AAAAA` at indices $i=2$ and $i=24$. Other sequences with high 'A' content also yield high scores, for instance `AAAAC` at $i=3$ scores $3 \\times 1.2238 + 1.0296 - 1.6094 = 3.0916$. A full scan reveals all sites scoring above $\\tau_\\text{low}=3.0$. These are at indices $\\{1, 2, 3, 4, 5, 8, 11, 14, 17, 23, 24, 25, 26, 27, 30, 33\\}$.\n\n-   **Evaluation with $\\tau_\\text{high}=4.5$:**\n    The predicted starts are $\\mathcal{P}_\\text{high} = \\{i \\mid S(G_1[i:i+L]) \\ge 4.5\\}$. Only the two `AAAAA` sites exceed this threshold, with a score of $5.9248$. Thus, $\\mathcal{P}_\\text{high} = \\{2, 24\\}$.\n    -   True Positives: $\\mathrm{TP}_\\text{high} = |\\mathcal{P}_\\text{high} \\cap \\mathcal{T}_1| = |\\{2, 24\\} \\cap \\{2, 24\\}| = 2$.\n    -   False Positives: $\\mathrm{FP}_\\text{high} = |\\mathcal{P}_\\text{high} \\setminus \\mathcal{T}_1| = |\\{2, 24\\} \\setminus \\{2, 24\\}| = 0$.\n    -   Precision: $\\mathrm{Prec}_1^\\text{high} = \\mathrm{TP}_\\text{high} / (\\mathrm{TP}_\\text{high} + \\mathrm{FP}_\\text{high}) = 2 / (2+0) = 1.0$.\n\n-   **Evaluation with $\\tau_\\text{low}=3.0$:**\n    The predicted starts are $\\mathcal{P}_\\text{low} = \\{i \\mid S(G_1[i:i+L]) \\ge 3.0\\}$. This set is $\\{1, 2, 3, 4, 5, 8, 11, 14, 17, 23, 24, 25, 26, 27, 30, 33\\}$, so $|\\mathcal{P}_\\text{low}| = 16$.\n    -   True Positives: $\\mathrm{TP}_\\text{low} = |\\mathcal{P}_\\text{low} \\cap \\mathcal{T}_1| = |\\{..., 2, ..., 24, ...\\} \\cap \\{2, 24\\}| = 2$.\n    -   False Positives: $\\mathrm{FP}_\\text{low} = |\\mathcal{P}_\\text{low}| - \\mathrm{TP}_\\text{low} = 16 - 2 = 14$.\n    -   Precision: $\\mathrm{Prec}_1^\\text{low} = \\mathrm{TP}_\\text{low} / (\\mathrm{TP}_\\text{low} + \\mathrm{FP}_\\text{low}) = 2 / (2+14) = 2/16 = 0.125$.\n\n-   **Comparison:** $\\mathrm{Prec}_1^\\text{low} = 0.125 < \\mathrm{Prec}_1^\\text{high} = 1.0$. The condition is met. The result is **true**.\n\n**Test Case 2**\n-   Genome $G_2$ (length $N_2=32$): `ACGTACGTAAACACGTACGTAAAACACGT`\n-   Ground truth $\\mathcal{T}_2=\\{8, 21\\}$\n-   Motif length $L=5$. Scan indices $i \\in \\{0, \\dots, 27\\}$.\n\nThe true sites at $i=8$ and $i=21$ both correspond to the sequence `AAACA`. The score is $S(\\text{AAACA}) = S(1,\\text{A}) + S(2,\\text{A}) + S(3,\\text{A}) + S(4,\\text{C}) + S(5,\\text{A}) = 1.2238 + 1.2238 + 1.2238 - 0.9163 + 1.2238 = 3.9789$. Other windows, composed mainly of `C`, `G`, `T` against a PSSM favoring `A`, score very low. A full scan confirms that only sites $i=8$ and $i=21$ have a score greater than $\\tau_\\text{low}=3.0$.\n\n-   **Evaluation with $\\tau_\\text{high}=4.5$:**\n    The predicted starts are $\\mathcal{P}_\\text{high} = \\{i \\mid S(G_2[i:i+L]) \\ge 4.5\\}$. The maximum score in the genome is $3.9789$, which is less than $4.5$. Thus, $\\mathcal{P}_\\text{high} = \\emptyset$.\n    -   $|\\mathcal{P}_\\text{high}|=0$.\n    -   Precision: By definition, $\\mathrm{Prec}_2^\\text{high} = 0$.\n\n-   **Evaluation with $\\tau_\\text{low}=3.0$:**\n    The predicted starts are $\\mathcal{P}_\\text{low} = \\{i \\mid S(G_2[i:i+L]) \\ge 3.0\\}$. The sites at $i=8$ and $i=21$ have scores of $3.9789 \\ge 3.0$. Thus, $\\mathcal{P}_\\text{low} = \\{8, 21\\}$.\n    -   True Positives: $\\mathrm{TP}_\\text{low} = |\\mathcal{P}_\\text{low} \\cap \\mathcal{T}_2| = |\\{8, 21\\} \\cap \\{8, 21\\}| = 2$.\n    -   False Positives: $\\mathrm{FP}_\\text{low} = |\\mathcal{P}_\\text{low} \\setminus \\mathcal{T}_2| = 0$.\n    -   Precision: $\\mathrm{Prec}_2^\\text{low} = \\mathrm{TP}_\\text{low} / (\\mathrm{TP}_\\text{low} + \\mathrm{FP}_\\text{low}) = 2 / (2+0) = 1.0$.\n\n-   **Comparison:** $\\mathrm{Prec}_2^\\text{low} = 1.0 \\not< \\mathrm{Prec}_2^\\text{high} = 0$. The condition is not met. The result is **false**.\n\n**Test Case 3**\n-   Genome $G_3$ (length $N_3=4$): `CGTC`\n-   Ground truth $\\mathcal{T}_3=\\emptyset$\n-   Motif length $L=5$.\n\nThe valid starting indices for scanning are $i \\in \\{0, \\dots, N-L\\} = \\{0, \\dots, 4-5\\} = \\{0, \\dots, -1\\}$. This is an empty set. No scanning is possible.\n\n-   **Evaluation with $\\tau_\\text{high}=4.5$ and $\\tau_\\text{low}=3.0$:**\n    Since no windows can be formed, the set of predicted starts is empty for any threshold: $\\mathcal{P}_\\text{high} = \\emptyset$ and $\\mathcal{P}_\\text{low} = \\emptyset$.\n    -   $|\\mathcal{P}_\\text{high}|=0$, so $\\mathrm{Prec}_3^\\text{high} = 0$.\n    -   $|\\mathcal{P}_\\text{low}|=0$, so $\\mathrm{Prec}_3^\\text{low} = 0$.\n\n-   **Comparison:** $\\mathrm{Prec}_3^\\text{low} = 0 \\not< \\mathrm{Prec}_3^\\text{high} = 0$. The condition is not met. The result is **false**.\n\nIn summary, the boolean results for the three test cases are: true, false, false.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the PSSM precision evaluation problem for three test cases.\n    \"\"\"\n    \n    # Define problem parameters using standard scientific constants and variables.\n    L = 5  # Motif length\n    \n    # Emission probability matrix p(b, j) as a numpy array.\n    # Rows correspond to positions j=1..5, columns to nucleotides A, C, G, T.\n    p_matrix = np.array([\n        [0.85, 0.05, 0.05, 0.05],  # Position j=1\n        [0.85, 0.05, 0.05, 0.05],  # Position j=2\n        [0.85, 0.05, 0.05, 0.05],  # Position j=3\n        [0.70, 0.10, 0.10, 0.10],  # Position j=4\n        [0.85, 0.05, 0.05, 0.05],  # Position j=5\n    ])\n    \n    # Uniform background nucleotide frequencies q(b).\n    q_vector = np.array([0.25, 0.25, 0.25, 0.25])\n    \n    # Score thresholds.\n    tau_high = 4.5\n    tau_low = 3.0\n    \n    # Test cases with genome strings and ground-truth sets.\n    test_cases = [\n        {\"genome\": \"GCAAAAACAACAACAACAACAACGAAAAATAACAACAAC\", \"truth\": {2, 24}},\n        {\"genome\": \"ACGTACGTAAACACGTACGTAAAACACGT\", \"truth\": {8, 21}},\n        {\"genome\": \"CGTC\", \"truth\": set()},\n    ]\n\n    # Map nucleotides to indices for matrix lookup.\n    nuc_map = {'A': 0, 'C': 1, 'G': 2, 'T': 3}\n\n    # Pre-compute the log-odds score matrix S(j, b).\n    # Broadcasting q_vector across the rows of p_matrix.\n    score_matrix = np.log(p_matrix / q_vector)\n\n    final_results = []\n    for case in test_cases:\n        genome = case[\"genome\"]\n        truth_set = case[\"truth\"]\n        N = len(genome)\n        \n        # Scan the genome to compute scores for all L-mers.\n        indices, scores = [], []\n        if N >= L:\n            for i in range(N - L + 1):\n                window = genome[i:i+L]\n                score = 0.0\n                for j, nucleotide in enumerate(window):\n                    nuc_idx = nuc_map[nucleotide]\n                    score += score_matrix[j, nuc_idx]\n                indices.append(i)\n                scores.append(score)\n\n        # Function to calculate precision for a given set of predictions.\n        def calculate_precision(predicted_indices, true_indices):\n            predicted_set = set(predicted_indices)\n            true_set = set(true_indices)\n            \n            if not predicted_set:\n                return 0.0\n            \n            tp = len(predicted_set.intersection(true_set))\n            # Precision is TP / (TP + FP), which is TP / |Predicted Set|\n            precision = tp / len(predicted_set)\n            return precision\n\n        # --- Evaluation for tau_high ---\n        pred_indices_high = [idx for idx, s in zip(indices, scores) if s >= tau_high]\n        prec_high = calculate_precision(pred_indices_high, truth_set)\n\n        # --- Evaluation for tau_low ---\n        pred_indices_low = [idx for idx, s in zip(indices, scores) if s >= tau_low]\n        prec_low = calculate_precision(pred_indices_low, truth_set)\n        \n        # Determine if precision strictly decreased.\n        final_results.append(prec_low < prec_high)\n\n    # Format the output as a comma-separated list of lowercase booleans.\n    print(f\"[{','.join(map(str, final_results))}]\".lower())\n\nsolve()\n```"
        }
    ]
}