{
    "hands_on_practices": [
        {
            "introduction": "要真正掌握剖面HMM，核心在于理解其作为生成模型的概率基础。本练习将带您深入研究HMM的状态转换网络，通过计算仅包含插入和删除状态的特定路径类型的总概率，来巩固您对状态转移和概率计算的理解。这是一个基础但至关重要的练习，它能帮助您具象化序列是如何在模型内部“生成”的，并掌握处理马尔可夫链路径分析的核心技能 。",
            "id": "2418513",
            "problem": "考虑一个用于蛋白质家族 (Pfam) 数据库中某个具有两个匹配位置的蛋白质家族的剖面隐马尔可夫模型 (profile Hidden Markov Model, profile HMM)。隐状态集由标准的剖面HMM 拓扑状态组成：一个开始状态 $B$，匹配状态 $M_1$ 和 $M_2$，插入状态 $I_0$、$I_1$ 和 $I_2$，删除状态 $D_1$ 和 $D_2$，以及一个结束状态 $E$。该过程从 $B$ 开始，在进入 $E$ 时终止。非匹配状态之间的非零转移概率规定如下；任何未明确列出的转移概率均为 $0$。\n\n- 从 $B$：$B \\to M_1$ 的概率为 $\\frac{1}{2}$，$B \\to I_0$ 的概率为 $\\frac{3}{10}$，以及 $B \\to D_1$ 的概率为 $\\frac{1}{5}$。\n- 从 $I_0$：$I_0 \\to I_0$ 的概率为 $\\frac{2}{5}$，$I_0 \\to D_1$ 的概率为 $\\frac{1}{5}$，以及 $I_0 \\to M_1$ 的概率为 $\\frac{2}{5}$。\n- 从 $D_1$：$D_1 \\to D_2$ 的概率为 $\\frac{1}{2}$，$D_1 \\to I_1$ 的概率为 $\\frac{3}{10}$，以及 $D_1 \\to M_2$ 的概率为 $\\frac{1}{5}$。\n- 从 $I_1$：$I_1 \\to I_1$ 的概率为 $\\frac{1}{2}$，$I_1 \\to D_2$ 的概率为 $\\frac{1}{4}$，以及 $I_1 \\to M_2$ 的概率为 $\\frac{1}{4}$。\n- 从 $D_2$：$D_2 \\to E$ 的概率为 $\\frac{3}{5}$ 以及 $D_2 \\to I_2$ 的概率为 $\\frac{2}{5}$。\n- 从 $I_2$：$I_2 \\to I_2$ 的概率为 $\\frac{1}{2}$ 以及 $I_2 \\to E$ 的概率为 $\\frac{1}{2}$。\n\n定义事件 $\\mathcal{S}$ 为从 $B$ 到 $E$ 的隐状态路径在 $B$ 和 $E$ 之间只包含插入状态和删除状态；也就是说，该路径从不访问任何匹配状态 $M_1$ 或 $M_2$。在模型自身的隐状态路径生成过程下，计算概率 $\\mathbb{P}(\\mathcal{S})$。将你的最终答案表示为最简分数。",
            "solution": "必须首先对问题陈述进行严格验证。\n\n**步骤1：提取已知条件**\n- **状态集**：$\\{B, M_1, M_2, I_0, I_1, I_2, D_1, D_2, E\\}$。\n- **过程**：从 $B$ 开始，在 $E$ 结束。\n- **转移概率（非零，从非匹配状态）**：\n  - 从 $B$：$\\mathbb{P}(M_1|B) = \\frac{1}{2}$，$\\mathbb{P}(I_0|B) = \\frac{3}{10}$，$\\mathbb{P}(D_1|B) = \\frac{1}{5}$。\n  - 从 $I_0$：$\\mathbb{P}(I_0|I_0) = \\frac{2}{5}$，$\\mathbb{P}(D_1|I_0) = \\frac{1}{5}$，$\\mathbb{P}(M_1|I_0) = \\frac{2}{5}$。\n  - 从 $D_1$：$\\mathbb{P}(D_2|D_1) = \\frac{1}{2}$，$\\mathbb{P}(I_1|D_1) = \\frac{3}{10}$，$\\mathbb{P}(M_2|D_1) = \\frac{1}{5}$。\n  - 从 $I_1$：$\\mathbb{P}(I_1|I_1) = \\frac{1}{2}$，$\\mathbb{P}(D_2|I_1) = \\frac{1}{4}$，$\\mathbb{P}(M_2|I_1) = \\frac{1}{4}$。\n  - 从 $D_2$：$\\mathbb{P}(E|D_2) = \\frac{3}{5}$，$\\mathbb{P}(I_2|D_2) = \\frac{2}{5}$。\n  - 从 $I_2$：$\\mathbb{P}(I_2|I_2) = \\frac{1}{2}$，$\\mathbb{P}(E|I_2) = \\frac{1}{2}$。\n- **事件 $\\mathcal{S}$ 的条件**：从 $B$ 到 $E$ 的隐状态路径只包含集合 $\\{I_0, I_1, I_2, D_1, D_2\\}$ 中的状态作为中间状态。路径不能访问 $M_1$ 或 $M_2$。\n- **目标**：计算 $\\mathbb{P}(\\mathcal{S})$。\n\n**步骤2：使用提取的已知条件进行验证**\n1.  **科学依据**：该问题描述了一个剖面隐马尔可夫模型，这是计算生物学中用于蛋白质家族分类的一个标准且科学合理的工具。其状态拓扑和转移结构与已建立的模型一致。该问题牢固地建立在概率论及其在生物信息学中的应用之上。\n2.  **适定性**：该问题要求在一个完全指定的概率模型（一个有限状态马尔可夫链）中计算一个明确定义的事件 $\\mathcal{S}$ 的概率。存在唯一解。\n3.  **完整性与一致性**：对于列出转移的每个状态，所有出向转移的概率之和为 $1$。\n    - 从 $B$：$\\frac{1}{2} + \\frac{3}{10} + \\frac{1}{5} = \\frac{5+3+2}{10} = 1$。\n    - 从 $I_0$：$\\frac{2}{5} + \\frac{1}{5} + \\frac{2}{5} = \\frac{5}{5} = 1$。\n    - 从 $D_1$：$\\frac{1}{2} + \\frac{3}{10} + \\frac{1}{5} = \\frac{5+3+2}{10} = 1$。\n    - 从 $I_1$：$\\frac{1}{2} + \\frac{1}{4} + \\frac{1}{4} = \\frac{2+1+1}{4} = 1$。\n    - 从 $D_2$：$\\frac{3}{5} + \\frac{2}{5} = 1$。\n    - 从 $I_2$：$\\frac{1}{2} + \\frac{1}{2} = 1$。\n    问题是自洽的且没有矛盾。来自匹配状态（$M_1, M_2$）的转移没有被指定，但它们与计算无关，因为事件 $\\mathcal{S}$ 明确禁止访问这些状态。\n\n**步骤3：结论与行动**\n该问题具有科学依据、适定且内部一致。因此它是有效的。我将继续进行求解。\n\n该问题要求在一个由马尔可夫链定义的生成过程中，计算特定事件 $\\mathcal{S}$ 的概率。事件 $\\mathcal{S}$ 指的是从状态 $B$ 开始的路径仅通过插入（$I_k$）和删除（$D_k$）状态到达状态 $E$。\n\n设 $\\pi_S$ 表示从状态 $S$ 开始的路径在不访问任何匹配状态（$M_1$ 或 $M_2$）的情况下最终到达结束状态 $E$ 的概率。我们需要求解的是 $\\pi_B = \\mathbb{P}(\\mathcal{S})$。\n\n这个问题可以通过为相关状态 $S \\in \\{I_0, D_1, I_1, D_2, I_2\\}$ 的概率 $\\pi_S$ 建立一个线性方程组来解决。这种方法被称为首步分析法。概率 $\\pi_S$ 是转移到每个可能的下一状态 $S'$ 的概率与从该状态 $S'$ 成功到达目标的概率 $\\pi_{S'}$ 相乘，然后求和。\n一般方程为：\n$$ \\pi_S = \\sum_{S'} \\mathbb{P}(S \\to S') \\pi_{S'} $$\n根据定义，到达状态 $E$ 的路径已经成功，所以 $\\pi_E=1$。进入匹配状态的路径未能满足事件 $\\mathcal{S}$ 的条件，因此我们可以将从匹配状态开始的成功概率定义为零：$\\pi_{M_1} = 0$ 且 $\\pi_{M_2} = 0$。\n\n我们通过从结束状态 $E$ 向后推导来求解这些概率。\n\n1.  **从状态 $I_2$ 开始的概率**：\n    从 $I_2$ 的可能转移是到 $I_2$ 或 $E$。两者都不是匹配状态。\n    $\\pi_{I_2} = \\mathbb{P}(I_2 \\to I_2) \\pi_{I_2} + \\mathbb{P}(I_2 \\to E) \\pi_E$\n    $\\pi_{I_2} = \\frac{1}{2} \\pi_{I_2} + \\frac{1}{2}(1)$\n    $(1 - \\frac{1}{2}) \\pi_{I_2} = \\frac{1}{2}$\n    $\\frac{1}{2} \\pi_{I_2} = \\frac{1}{2} \\implies \\pi_{I_2} = 1$。\n\n2.  **从状态 $D_2$ 开始的概率**：\n    从 $D_2$ 的转移是到 $E$ 或 $I_2$。\n    $\\pi_{D_2} = \\mathbb{P}(D_2 \\to E) \\pi_E + \\mathbb{P}(D_2 \\to I_2) \\pi_{I_2}$\n    $\\pi_{D_2} = \\frac{3}{5}(1) + \\frac{2}{5}(1) = 1$。\n\n3.  **从状态 $I_1$ 开始的概率**：\n    从 $I_1$ 的转移是到 $I_1$、$D_2$ 或 $M_2$。到 $M_2$ 的转移是失败。\n    $\\pi_{I_1} = \\mathbb{P}(I_1 \\to I_1) \\pi_{I_1} + \\mathbb{P}(I_1 \\to D_2) \\pi_{D_2} + \\mathbb{P}(I_1 \\to M_2) \\pi_{M_2}$\n    $\\pi_{I_1} = \\frac{1}{2} \\pi_{I_1} + \\frac{1}{4}(1) + \\frac{1}{4}(0)$\n    $(1 - \\frac{1}{2}) \\pi_{I_1} = \\frac{1}{4}$\n    $\\frac{1}{2} \\pi_{I_1} = \\frac{1}{4} \\implies \\pi_{I_1} = \\frac{1}{2}$。\n\n4.  **从状态 $D_1$ 开始的概率**：\n    从 $D_1$ 的转移是到 $D_2$、$I_1$ 或 $M_2$。到 $M_2$ 的转移是失败。\n    $\\pi_{D_1} = \\mathbb{P}(D_1 \\to D_2) \\pi_{D_2} + \\mathbb{P}(D_1 \\to I_1) \\pi_{I_1} + \\mathbb{P}(D_1 \\to M_2) \\pi_{M_2}$\n    $\\pi_{D_1} = \\frac{1}{2}(1) + \\frac{3}{10}(\\frac{1}{2}) + \\frac{1}{5}(0)$\n    $\\pi_{D_1} = \\frac{1}{2} + \\frac{3}{20} = \\frac{10}{20} + \\frac{3}{20} = \\frac{13}{20}$。\n\n5.  **从状态 $I_0$ 开始的概率**：\n    从 $I_0$ 的转移是到 $I_0$、$D_1$ 或 $M_1$。到 $M_1$ 的转移是失败。\n    $\\pi_{I_0} = \\mathbb{P}(I_0 \\to I_0) \\pi_{I_0} + \\mathbb{P}(I_0 \\to D_1) \\pi_{D_1} + \\mathbb{P}(I_0 \\to M_1) \\pi_{M_1}$\n    $\\pi_{I_0} = \\frac{2}{5} \\pi_{I_0} + \\frac{1}{5}(\\frac{13}{20}) + \\frac{2}{5}(0)$\n    $(1 - \\frac{2}{5}) \\pi_{I_0} = \\frac{13}{100}$\n    $\\frac{3}{5} \\pi_{I_0} = \\frac{13}{100} \\implies \\pi_{I_0} = \\frac{13}{100} \\cdot \\frac{5}{3} = \\frac{13}{60}$。\n\n6.  **从状态 $B$ 开始的概率**：\n    最后，我们计算 $\\pi_B$。从 $B$ 的转移是到 $M_1$、$I_0$ 或 $D_1$。到 $M_1$ 的转移是失败。\n    $\\pi_B = \\mathbb{P}(B \\to M_1) \\pi_{M_1} + \\mathbb{P}(B \\to I_0) \\pi_{I_0} + \\mathbb{P}(B \\to D_1) \\pi_{D_1}$\n    $\\pi_B = \\frac{1}{2}(0) + \\frac{3}{10}(\\frac{13}{60}) + \\frac{1}{5}(\\frac{13}{20})$\n    $\\pi_B = \\frac{39}{600} + \\frac{13}{100}$\n    为了将这些分数相加，我们找到一个公分母，即 $600$。\n    $\\pi_B = \\frac{39}{600} + \\frac{13 \\cdot 6}{100 \\cdot 6} = \\frac{39}{600} + \\frac{78}{600}$\n    $\\pi_B = \\frac{39 + 78}{600} = \\frac{117}{600}$\n\n最后一步是化简分数。必须找到 $117$ 和 $600$ 的最大公约数。\n$117 = 3 \\times 39 = 3 \\times 3 \\times 13 = 3^2 \\times 13$。\n$600 = 6 \\times 100 = 2 \\times 3 \\times 10^2 = 2 \\times 3 \\times (2 \\times 5)^2 = 2^3 \\times 3 \\times 5^2$。\n最大公约数是 $3$。\n$\\pi_B = \\frac{117 \\div 3}{600 \\div 3} = \\frac{39}{200}$。\n这个分数是其最简形式，因为 $39 = 3 \\times 13$ 和 $200 = 2^3 \\times 5^2$ 没有共同因子。\n\n事件 $\\mathcal{S}$ 的概率是 $\\frac{39}{200}$。",
            "answer": "$$ \\boxed{\\frac{39}{200}} $$"
        },
        {
            "introduction": "构建了剖面HMM之后，我们通常希望得到一个能代表整个蛋白家族的“共有序列”。然而，这个看似简单的概念背后存在着微妙的差别。本练习旨在辨析两种常见的概括性序列：一种是通过简单地选取每个匹配状态下最可能的氨基酸构成的，另一种则是通过维特比算法找到的全局最优路径所生成的序列。通过对比这两种序列，您将深刻理解转移概率在决定最终序列中的关键作用，以及“局部最优”与“全局最优”之间的重要区别 。",
            "id": "2418536",
            "problem": "在蛋白质家族数据库 (Pfam) 中，一个剖面隐马尔可夫模型 (HMM) 被用来表示一个蛋白质家族，它由一系列匹配状态 $\\{M_1,\\dots,M_L\\}$ 以及相关的插入状态 $\\{I_0,\\dots,I_L\\}$ 和删除状态 $\\{D_1,\\dots,D_L\\}$ 组成。每个匹配状态 $M_i$ 根据一个关于 $x \\in \\mathcal{A}$ 的位置特异性分布 $e_{M_i}(x)$ 发射一个来自字母表 $\\mathcal{A}$ 的氨基酸，而删除状态是静默的，插入状态则根据 $e_{I_i}(x)$ 发射。一条状态路径 $\\pi_0,\\pi_1,\\dots,\\pi_K$ 的概率等于沿该路径的转移概率之积，而沿该路径发射出的序列 $x_1,\\dots,x_K$ 的联合概率等于路径概率与发射状态下的发射概率之积。\n\n一个剖面HMM通常报告的“共有”序列旨在总结模型在每个匹配位置上的偏好残基。另外，可以定义“最可能发射序列”为通过单一最可能状态路径（即，在所有路径和序列上最大化路径和发射的联合概率的路径）获得的序列，这通常通过维特比算法找到。\n\n哪个陈述最好地描述了如何从一个剖面HMM生成“共有”序列，以及这与最可能发射序列有何不同？\n\nA. 共有序列是通过在每个匹配状态 $M_i$ 处取残基 $x_i=\\arg\\max_{x \\in \\mathcal{A}} e_{M_i}(x)$（可选择性地通过一个独立的占有率规则省略某些位置）而形成的，这仅取决于每个位置的发射分布，而不取决于转移概率；相比之下，最可能发射序列是沿着在转移和发射上最大化联合概率的单一状态路径所发射的序列，并且可能通过删除转移跳过匹配状态或包含插入发射，因此这两个序列可能不同。\n\nB. 每当每个 $M_i$ 都有一个唯一的 $e_{M_i}(x)$ 最大化子时，共有序列和最可能发射序列是相同的，因为转移概率不能改变发射哪个残基。\n\nC. 共有序列通过对所有状态路径求和来最大化边际序列概率 $P(x_{1:L}\\mid\\text{model})$，而最可能发射序列则最大化与发射无关的后验路径概率 $P(\\pi\\mid\\text{model})$。\n\nD. 共有序列是通过前向-后向算法计算以获得每个位置的后验残基，而最可能发射序列则是在不考虑转移的情况下，在每个位置独立选择 $\\arg\\max_{x \\in \\mathcal{A}} e_{M_i}(x)$ 来计算的。",
            "solution": "首先将验证问题陈述的科学性和逻辑完整性。\n\n### 步骤1：提取已知信息\n- **模型**：一个剖面隐马尔可夫模型 (HMM) 表示一个蛋白质家族。\n- **状态**：该HMM由匹配状态 {$M_1, \\dots, M_L$}、插入状态 {$I_0, \\dots, I_L$} 和删除状态 {$D_1, \\dots, D_L$} 组成。\n- **发射**：\n    - 匹配状态 $M_i$ 以概率 $e_{M_i}(x)$ 发射来自字母表 $\\mathcal{A}$ 的氨基酸 $x$。\n    - 插入状态 $I_i$ 以概率 $e_{I_i}(x)$ 发射氨基酸 $x$。\n    - 删除状态 $D_i$ 是静默的（不发射）。\n- **概率**：\n    - 一条状态路径 $\\pi_0, \\pi_1, \\dots, \\pi_K$ 的概率是沿该路径的转移概率之积。\n    - 一个发射序列 $x_1, \\dots, x_K$ 和一条状态路径的联合概率是路径概率与发射状态下的发射概率之积。\n- **定义**：\n    - **“共有”序列**：“旨在总结模型在每个匹配位置上的偏好残基。”\n    - **“最可能发射序列”**：“通过单一最可能状态路径（即，在所有路径和序列上最大化路径和发射的联合概率的路径）获得的序列，这通常通过维特比算法找到。”\n- **问题**：描述“共有”序列的生成方式，并将其与“最可能发射序列”进行对比。\n\n### 步骤2：使用提取的已知信息进行验证\n问题陈述描述了生物信息学中使用的剖面HMM的标准架构，例如在Pfam数据库中。所呈现的所有概念——匹配、插入和删除状态；发射和转移概率；路径和序列的联合概率——都是HMM理论的基本且正确陈述的组成部分。给出的“最可能发射序列”（作为维特比路径的产物）和“共有序列”（作为匹配位置上偏好残基的总结）的定义在该领域是标准的。该问题具有科学依据，表述清晰，客观。它没有矛盾、歧义或事实错误。\n\n### 步骤3：结论与行动\n问题陈述有效。现在将推导解决方案。\n\n### 推导\n设剖面HMM由一组参数 $\\theta = \\{a_{kl}, e_k(x)\\}$ 表示，其中 $a_{kl}$ 是从状态 $k$ 到状态 $l$ 的转移概率，而 $e_k(x)$ 是从状态 $k$ 发射符号 $x$ 的发射概率。\n\n1.  **共有序列的生成**：问题文本将其描述为总结“每个匹配位置上的偏好残基”。对此最直接和普遍的解释是独立考虑每个匹配状态 $M_i$，并选择具有最高发射概率的氨基酸。对于每个位置 $i \\in \\{1, \\dots, L\\}$，共有残基 $c_i$ 由以下公式确定：\n    $$ c_i = \\arg\\max_{x \\in \\mathcal{A}} e_{M_i}(x) $$\n    完整的共有序列是 $c_1c_2 \\dots c_L$ 的串联。这个过程仅依赖于匹配状态的发射概率 $e_{M_i}(x)$。它完全忽略了任何状态之间的转移概率 $a_{kl}$。它也忽略了插入状态的发射。这个序列的长度正好是 $L$。\n\n2.  **最可能发射序列的生成**：这被明确定义为来自单一最可能状态路径的发射序列。这条路径 $\\pi^*$ 是最大化路径和发射序列的联合概率 $P(x, \\pi | \\theta)$ 的路径。\n    $$ (\\pi^*, x^*) = \\arg\\max_{\\pi, x} P(x, \\pi | \\theta) $$\n    这个问题可以通过维特比算法高效解决。维特比算法在每一步动态计算到达每个状态的最高概率路径，同时考虑到达该状态的转移概率和观测符号的发射概率。最终路径 $\\pi^*$ 是一个全局最优解。这条路径可能包含到删除状态的转移（例如，$M_{i-1} \\to D_i \\to M_{i+1}$），这会导致位置 $i$ 被跳过，或者到插入状态的转移（例如，$M_i \\to I_i \\to M_{i+1}$），这会增加额外的残基。因此，得到的序列 $x^*$ 不保证长度为 $L$，其组成的残基也不一定是在孤立考虑下相应匹配状态的最可能发射。路径的选择，以及因此产生的序列，是转移概率 $a_{kl}$ 和发射概率 $e_k(x)$ 两者的函数。\n\n**结论**：共有序列是一个仅基于 $e_{M_i}(x)$ 的局部的、按位置构建的结构，而最可能发射序列是基于路径的全局优化，依赖于 $e_k(x)$ 和 $a_{kl}$。它们在根本上是不同的，并且通常不期望是相同的。\n\n### 逐项分析\n\n**A. 共有序列是通过在每个匹配状态 $M_i$ 处取残基 $x_i=\\arg\\max_{x \\in \\mathcal{A}} e_{M_i}(x)$（可选择性地通过一个独立的占有率规则省略某些位置）而形成的，这仅取决于每个位置的发射分布，而不取决于转移概率；相比之下，最可能发射序列是沿着在转移和发射上最大化联合概率的单一状态路径所发射的序列，并且可能通过删除转移跳过匹配状态或包含插入发射，因此这两个序列可能不同。**\n\n这个陈述准确地描述了两种过程。共有序列的生成被正确地识别为匹配状态发射概率的按位置最大化，与转移无关。关于占有率的可选规则是一个正确的实践细节。对最可能发射序列的描述，即作为维特比路径的输出，最大化联合概率并依赖于转移和发射，也是正确的。其对比指出了维特比路径可以使用删除和插入状态，从而导致序列差异，这是关键区别。\n**结论：正确。**\n\n**B. 每当每个 $M_i$ 都有一个唯一的 $e_{M_i}(x)$ 最大化子时，共有序列和最可能发射序列是相同的，因为转移概率不能改变发射哪个残基。**\n\n这个陈述有根本性错误。其前提“转移概率不能改变发射哪个残基”是错误的。转移概率决定了所采取的状态路径。如果进入删除状态 $D_i$ 的转移概率足够高，维特比路径将绕过匹配状态 $M_i$，并且不会为该列发射任何残基。这直接改变了最终的序列。例如，如果 $a_{M_{i-1}, D_i} \\cdot a_{D_i, M_{i+1}}$ 足够高，使得访问 $D_i$ 比通过 $M_i$ 的路径（即 $a_{M_{i-1}, M_i} \\cdot e_{M_i}(x_i) \\cdot a_{M_i, M_{i+1}}$）更可能，那么维特比路径将使用删除。这两个序列就会不同。\n**结论：错误。**\n\n**C. 共有序列通过对所有状态路径求和来最大化边际序列概率 $P(x_{1:L}\\mid\\text{model})$，而最可能发射序列则最大化与发射无关的后验路径概率 $P(\\pi\\mid\\text{model})$。**\n\n这个陈述错误地描述了两种序列。最大化边际序列概率 $P(x | \\text{model}) = \\sum_{\\pi} P(x, \\pi | \\text{model})$ 是一个不同的、计算上困难的问题，其解不是简单的共有序列。简单的共有序列并不最大化任何关于序列的全局概率函数。此外，维特比算法（用于“最可能发射序列”）最大化的是*联合*概率 $P(x, \\pi | \\text{model})$，而不是后验路径概率 $P(\\pi | \\text{model})$，更不是“与发射无关”的概率。发射是联合概率计算中不可或缺的一部分。\n**结论：错误。**\n\n**D. 共有序列是通过前向-后向算法计算以获得每个位置的后验残基，而最可能发射序列则是在不考虑转移的情况下，在每个位置独立选择 $\\arg\\max_{x \\in \\mathcal{A}} e_{M_i}(x)$ 来计算的。**\n\n这个陈述颠倒了定义。为最可能发射序列描述的方法（“独立选择 $\\arg\\max_{x \\in \\mathcal{A}} e_{M_i}(x)$”）实际上是生成简单共有序列的方法。为共有序列描述的方法（“通过前向-后向算法计算”）定义了另一种解码类型，即“后验解码”，它计算给定一个观测序列时每个位置最可能的状态，这与维特比路径和简单共有序列都不同。简单共有序列通常不是使用前向-后向算法计算的，也不需要一个给定的序列。\n**结论：错误。**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "任何模型都有其适用范围和局限性，认识到这一点对于成为一名优秀的生物信息学家至关重要。本练习将您置于一个真实的生物学情境中：如何在一个剖面HMM中表示一个必需的二硫键，这种结构性约束涉及到两个遥远位置之间的依赖关系。标准的剖面HMM由于其固有的条件独立性假设，无法直接对这种成对依赖进行建模。这个挑战将促使您思考模型的底层假设，并评估在实践中用以强制实现这类真实世界约束的各种策略，例如后处理过滤器或使用更高级的模型 。",
            "id": "2418528",
            "problem": "一位策展人正在为蛋白质家族数据库（Pfam）中的一个蛋白质家族构建一个剖面隐马尔可夫模型（HMM）。该家族的核心结构域在位置 $i$ 和 $j$（其中 $i \\neq j$）处有两个比对列，根据结构和生化数据，已知这两个位置在功能性同源蛋白中会形成一个必需的二硫键。策展人的目标是确保被分类为该结构域成员的序列在位置 $i$ 和 $j$ 上都具有半胱氨酸残基，并且在比对中这两个位置都未被删除，同时这种方式要正确地遵循 Pfam 风格的剖面HMM 所能和所不能表示的内容。以下哪种策略是满足此要求的有效方法？选择所有适用选项。\n\nA. 手动编辑剖面HMM，使得位置 $i$ 和 $j$ 的匹配状态以概率 $1$ 发射半胱氨酸，并将位置 $i$ 和 $j$ 的删除转移概率设置为 $0$。仅此一项就能在剖面HMM 内部完全强制执行二硫键约束。\n\nB. 将位置 $i$ 和 $j$ 的匹配状态的发射进行关联，使得位置 $i$ 的发射依赖于位置 $j$ 的发射，从而确保两者都是半胱氨酸；HMMER 风格的剖面HMM 支持这种做法。\n\nC. 为该家族使用一个标准的 Pfam 风格的剖面HMM，并应用一个比对后过滤器，该过滤器会拒绝任何其最优比对结果未能在位置 $i$ 和 $j$ 上同时放置半胱氨酸（且未删除任一位置）的序列。\n\nD. 用一个支持显式成对耦合的模型类别（如马尔可夫随机场（MRF））替换或增强剖面HMM，以编码位置 $i$ 和 $j$ 之间的依赖关系，同时指出 Pfam 的剖面HMM 无法表示此类耦合。\n\nE. 将模型转换为剖面随机上下文无关文法（SCFG），并通过成对发射产生式来强制实现长程配对；据称标准工具原生支持这种方法处理蛋白质二硫键。",
            "solution": "我们首先分析 Pfam 风格的剖面隐马尔可夫模型（HMM）能够表示哪些序列约束，哪些不能，然后评估每个选项。\n\n基本原理：剖面HMM 通过沿一条路径的状态转移概率和状态发射概率的乘积来定义序列上的一个概率分布。如果 $x_1, x_2, \\ldots, x_L$ 表示与匹配状态 $M_1, M_2, \\ldots, M_L$ 对齐的序列符号，而 $s$ 表示状态路径，则联合概率可分解为\n$$\nP(x, s) \\;=\\; \\left(\\prod_{t} P(s_t \\mid s_{t-1})\\right) \\left(\\prod_{t \\in \\text{emitting}} P(x_t \\mid s_t)\\right).\n$$\n关键在于，在给定状态路径的条件下，不同匹配位置的发射是独立的；不存在形如 $\\phi_{ij}(x_i, x_j)$ 这样能将两个不同匹配状态的发射耦合起来的项。因此，标准的剖面HMM 无法编码一种直接强制执行两个位置残基之间关系的依赖性（例如，确保两者都是半胱氨酸的成对约束，因为它们之间形成了二硫键）。然而，HMM 可以通过设置发射概率来强烈偏好或要求在单个位置出现特定残基，并可以通过调整转移概率来偏好或禁止在特定位置发生删除。要强制执行真正的成对依赖性，通常需要一个具有显式耦合的模型类别（例如，马尔可夫随机场（MRF））。作为替代方案，可以将基于 HMM 的比对与一个后置的确定性过滤器相结合，该过滤器检查指定列上是否有所需的残基。\n\n基于以上理解，我们评估每个选项：\n\nA 选项：手动编辑位置 $i$ 和 $j$ 的匹配状态，使其以概率 $1$ 发射半胱氨酸，并将位置 $i$ 和 $j$ 的删除转移概率设置为 $0$；声称：仅此一项就能在剖面HMM 内部完全强制执行二硫键约束。\n- 在位置 $i$ 和 $j$ 将半胱氨酸的发射概率设为 $1$ 并将删除转移概率设为 $0$，会强制任何通过这些匹配状态进行比对的序列在这两个位置上都具有半胱氨酸，并且必须访问这些位置（无删除）。从这种狭隘的、局部的意义上说，它强制了两个列上都存在半胱氨酸。然而，声称这“在剖面HMM 内部完全强制执行二硫键约束”是夸大其词。首先，剖面HMM 不会也无法编码成对依赖性或结构键；它只能编码每个位置的发射和转移结构。其次，Pfam 避免使用硬性的 0/1 概率，因为这会破坏典型的统计训练和校准过程；HMMER 使用狄利克雷混合先验进行训练时，其 hmmbuild 工具本身不支持精确的 0/1 约束，而硬性的零转移概率对于稳健的打分和比对可能存在问题。在操作上，Pfam 不会实施这种手动硬性约束来强制执行结构键；最多只能用高概率来近似。因此，虽然这种操作强制了局部残基，但它并未“完全”模拟二硫键，也不是在 Pfam 工作流程中编码这种结构约束的标准、有原则或受支持的方法。结论：不正确。\n\nB 选项：将位置 $i$ 和 $j$ 的匹配状态的发射进行关联，使得位置 $i$ 的发射依赖于位置 $j$ 的发射；声称：HMMER 风格的剖面HMM 支持这种做法。\n- 跨越不同匹配状态的关联或耦合发射违反了剖面HMM 的条件独立性结构。HMMER 风格的剖面HMM 不支持跨列的关联发射或成对发射因子。因此，这种做法不受支持。结论：不正确。\n\nC 选项：使用标准的 Pfam 风格剖面HMM，并应用一个比对后过滤器，拒绝那些最优比对结果未能在位置 $i$ 和 $j$ 同时包含半胱氨酸（且未删除任一位置）的序列。\n- 这种方法将 HMM 保持在其预定范围内（在独立性假设下对比对进行评分），并在比对后确定性地强制执行生化要求。这是一种有效、实用的方法，可以确保被接受的序列在位置 $i$ 和 $j$ 上都具有半胱氨酸且不删除它们，而无需声称 HMM 本身编码了这种成对依赖性。结论：正确。\n\nD 选项：用一个支持显式成对耦合的模型（如马尔可夫随机场（MRF））替换或增强剖面HMM，以编码 $i$ 和 $j$ 之间的依赖关系；并指出 Pfam 的剖面HMM 无法表示此类耦合。\n- 马尔可夫随机场（MRF）或波茨模型包含形如 $\\phi_{ij}(x_i, x_j)$ 的成对项，原则上可以编码和评分位置间的成对约束，包括对半胱氨酸-半胱氨酸对的强烈偏好。这直接解决了剖面HMM 独立性假设的局限性。关于 Pfam 的剖面HMM 无法表示此类耦合的说法是正确的。尽管 Pfam 目前没有在策展中使用 MRF，但从方法论上讲，该策略是模拟这种依赖关系的有效方法。结论：正确。\n\nE 选项：转换为剖面随机上下文无关文法（SCFG），并通过成对发射产生式来强制实现配对；声称标准工具原生支持这种方法处理蛋白质二硫键。\n- 剖面SCFG（协方差模型）是 RNA 的标准模型，其中嵌套的碱基配对可以通过成对发射来建模。没有标准的、广泛使用的工具包能够原生应用 SCFG 的成对发射机制来在轮廓模型中强制执行蛋白质二硫键，而且蛋白质的接触模式不一定是上下文无关或嵌套的。因此，在 Pfam/蛋白质的背景下，这不是一个合适或受支持的途径。结论：不正确。\n\n因此，在给定的选项中，有效的策略是使用标准剖面HMM 并结合一个比对后过滤器（选项 C），以及转换或增强为支持成对耦合的模型，如 MRF（选项 D），同时承认 Pfam 的剖面HMM 内部无法编码此类耦合。",
            "answer": "$$\\boxed{CD}$$"
        }
    ]
}