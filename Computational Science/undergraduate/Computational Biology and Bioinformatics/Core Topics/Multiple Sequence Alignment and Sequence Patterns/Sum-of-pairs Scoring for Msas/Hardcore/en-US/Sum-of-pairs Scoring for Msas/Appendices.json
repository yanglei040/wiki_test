{
    "hands_on_practices": [
        {
            "introduction": "Let's begin with the simplest possible alignment: a set of identical, gap-free sequences. This exercise establishes a baseline for understanding how the SP score scales with the number of sequences in a perfectly conserved alignment. By deriving the score for this ideal case, you will see how the combinatorial nature of pairwise scoring—summing over all $\\binom{N}{2}$ pairs—is a fundamental component of the total score. ",
            "id": "2432594",
            "problem": "Consider a Multiple Sequence Alignment (MSA) of $N$ sequences, where Multiple Sequence Alignment (MSA) refers to an arrangement of sequences into $L$ aligned columns. Let the sequences be $N$ identical copies of a single sequence $X = x_{1} x_{2} \\dots x_{L}$ over an alphabet $\\Sigma$, and assume the alignment is gap-free so that the $N$ identical copies are stacked columnwise. Let the pairwise scoring function be $s : \\left(\\Sigma \\cup \\{-\\}\\right) \\times \\left(\\Sigma \\cup \\{-\\}\\right) \\to \\mathbb{R}$, where $-$ denotes a gap symbol, and suppose $s$ is defined for all arguments in its domain.\n\nThe sum-of-pairs score of an MSA is defined as\n$$\n\\mathrm{SP} = \\sum_{1 \\le i  j \\le N} \\sum_{c=1}^{L} s\\!\\left(A_{i,c}, A_{j,c}\\right),\n$$\nwhere $A_{i,c}$ denotes the character in row $i$ and column $c$ of the aligned matrix.\n\nFor the described gap-free MSA of $N$ identical copies of $X$, express the sum-of-pairs score as a closed-form analytic expression in terms of $N$, $L$, the sequence characters $x_{1},\\dots,x_{L}$, and the scoring function $s$. Provide the exact expression; no numerical approximation or rounding is required.",
            "solution": "The problem as stated is valid. It is scientifically grounded in the principles of computational biology, specifically the evaluation of multiple sequence alignments, and is mathematically well-posed. All terms are clearly defined, and sufficient information is provided to derive a unique, analytical solution.\n\nThe problem asks for the sum-of-pairs ($\\mathrm{SP}$) score for a Multiple Sequence Alignment (MSA) composed of $N$ identical, gap-free sequences. Let the single underlying sequence be $X = x_{1} x_{2} \\dots x_{L}$, where $L$ is the length of the sequence and each character $x_{c}$ belongs to an alphabet $\\Sigma$. The MSA is represented as a matrix $A$ of size $N \\times L$. Since all sequences are identical and aligned without gaps, the character at any given row $i$ and column $c$, denoted $A_{i,c}$, is simply the character $x_{c}$ from the sequence $X$. That is, for all $i \\in \\{1, \\dots, N\\}$ and $c \\in \\{1, \\dots, L\\}$, we have:\n$$\nA_{i,c} = x_{c}\n$$\nThe sum-of-pairs score is defined as the sum of pairwise scores over all distinct pairs of sequences, summed over all columns of the alignment. The formula is given as:\n$$\n\\mathrm{SP} = \\sum_{1 \\le i  j \\le N} \\sum_{c=1}^{L} s(A_{i,c}, A_{j,c})\n$$\nwhere $s$ is the pairwise scoring function.\n\nWe substitute the value of $A_{i,c}$ into this definition. Since $A_{i,c} = x_{c}$ and $A_{j,c} = x_{c}$ for any pair of rows $i$ and $j$, the scoring term becomes $s(x_{c}, x_{c})$.\n$$\n\\mathrm{SP} = \\sum_{1 \\le i  j \\le N} \\sum_{c=1}^{L} s(x_{c}, x_{c})\n$$\nObserve that the term $s(x_{c}, x_{c})$ depends only on the column index $c$, and not on the row indices $i$ and $j$. The order of summation for finite sums can be interchanged. Therefore, we can rewrite the expression as:\n$$\n\\mathrm{SP} = \\sum_{c=1}^{L} \\sum_{1 \\le i  j \\le N} s(x_{c}, x_{c})\n$$\nFor a fixed column $c$, the term $s(x_{c}, x_{c})$ is a constant with respect to the inner summation over the indices $i$ and $j$. We can thus factor it out of the inner sum:\n$$\n\\mathrm{SP} = \\sum_{c=1}^{L} \\left( s(x_{c}, x_{c}) \\sum_{1 \\le i  j \\le N} 1 \\right)\n$$\nThe inner summation, $\\sum_{1 \\le i  j \\le N} 1$, counts the number of distinct pairs of rows $(i, j)$ that can be selected from a total of $N$ rows. This is a standard combinatorial problem of choosing $2$ items from a set of $N$, which is given by the binomial coefficient $\\binom{N}{2}$.\n$$\n\\sum_{1 \\le i  j \\le N} 1 = \\binom{N}{2} = \\frac{N(N-1)}{2}\n$$\nSubstituting this result back into the expression for the $\\mathrm{SP}$ score:\n$$\n\\mathrm{SP} = \\sum_{c=1}^{L} s(x_{c}, x_{c}) \\frac{N(N-1)}{2}\n$$\nThe term $\\frac{N(N-1)}{2}$ is a constant with respect to the summation over columns $c$. We can factor this term out of the entire summation:\n$$\n\\mathrm{SP} = \\frac{N(N-1)}{2} \\sum_{c=1}^{L} s(x_{c}, x_{c})\n$$\nThis is the final closed-form expression for the sum-of-pairs score of an MSA consisting of $N$ identical, gap-free copies of a sequence $X$. It is expressed in terms of the number of sequences $N$, the scoring function $s$, and the characters $x_{1}, \\dots, x_{L}$ of the sequence, as required. The length $L$ is implicitly present as the upper limit of the summation.",
            "answer": "$$\n\\boxed{\\frac{N(N-1)}{2} \\sum_{c=1}^{L} s(x_{c}, x_{c})}\n$$"
        },
        {
            "introduction": "Now, let's zoom in on a single column of an alignment to see how residue composition affects the score. This problem asks you to calculate the SP score for a column with a specific mix of two different amino acids. This practice will solidify your understanding of how the total score of a column is a weighted sum, determined by the number of matching and mismatching pairs and the values from the substitution matrix. ",
            "id": "2432583",
            "problem": "Consider a single alignment column from a Multiple Sequence Alignment (MSA) of $N$ homologous protein sequences, where $N$ is a positive even integer. The column contains exactly $N/2$ residues of Alanine ($\\mathrm{A}$) and $N/2$ residues of Glycine ($\\mathrm{G}$), with no gap characters. The sum-of-pairs (SP) score of a column is defined as the sum, over all unordered pairs of sequences $ij$, of a substitution scoring function $S(x_{i},x_{j})$ applied to the residues $x_{i}$ and $x_{j}$ in that column. Assume $S$ is symmetric, and denote $S(\\mathrm{A},\\mathrm{A})=s_{AA}$, $S(\\mathrm{G},\\mathrm{G})=s_{GG}$, and $S(\\mathrm{A},\\mathrm{G})=S(\\mathrm{G},\\mathrm{A})=s_{AG}$. Derive a closed-form expression for the SP score of this column as a function of $N$, $s_{AA}$, $s_{GG}$, and $s_{AG}$. Provide your final answer as a single simplified analytic expression. No rounding is required.",
            "solution": "The problem statement is subjected to validation.\n\nStep 1: Extract Givens.\n- A multiple sequence alignment (MSA) of $N$ sequences is considered.\n- $N$ is a positive even integer.\n- A single alignment column is analyzed.\n- The column contains $N/2$ residues of Alanine ($\\mathrm{A}$).\n- The column contains $N/2$ residues of Glycine ($\\mathrm{G}$).\n- There are no gap characters in the column.\n- The sum-of-pairs (SP) score is defined as the sum over all unordered pairs of sequences $ij$ of $S(x_i, x_j)$, where $x_i$ and $x_j$ are the residues in the column for sequences $i$ and $j$.\n- The substitution scoring function $S$ is symmetric.\n- The scores are given as $S(\\mathrm{A},\\mathrm{A}) = s_{AA}$, $S(\\mathrm{G},\\mathrm{G}) = s_{GG}$, and $S(\\mathrm{A},\\mathrm{G}) = s_{AG}$.\n\nStep 2: Validate Using Extracted Givens.\n- **Scientifically Grounded**: The problem is based on the standard sum-of-pairs scoring method, a fundamental concept in computational biology for evaluating the quality of a multiple sequence alignment. The setup is a simplified but realistic scenario.\n- **Well-Posed**: The problem is self-contained and provides all necessary information to derive a unique solution. The composition of the alignment column is precisely specified, the scoring function is defined, and the objective is to find a closed-form expression. The condition that $N$ is an even integer ensures that $N/2$ is an integer, making the problem consistent.\n- **Objective**: The problem is stated in precise, mathematical language, free from any subjectivity or ambiguity.\n\nStep 3: Verdict and Action.\nThe problem is deemed valid as it is scientifically grounded, well-posed, objective, and does not violate any of the criteria for invalidity. A solution will be derived.\n\nThe problem requires the calculation of the sum-of-pairs (SP) score for a single column of a multiple sequence alignment. The alignment consists of $N$ sequences. The total number of sequences is an even integer. The column under consideration contains $n_A = N/2$ Alanine residues and $n_G = N/2$ Glycine residues.\n\nThe SP score is the sum of scores over all distinct pairs of sequences in the alignment. The total number of such pairs is given by the binomial coefficient $\\binom{N}{2}$.\nThe pairs of residues in the column can be partitioned into three types: Alanine-Alanine ($\\mathrm{A}$, $\\mathrm{A}$), Glycine-Glycine ($\\mathrm{G}$, $\\mathrm{G}$), and Alanine-Glycine ($\\mathrm{A}$, $\\mathrm{G}$). The total SP score is the sum of the scores contributed by each type of pair.\n\n$SP_{total} = (\\text{Number of A-A pairs}) \\times s_{AA} + (\\text{Number of G-G pairs}) \\times s_{GG} + (\\text{Number of A-G pairs}) \\times s_{AG}$\n\nWe must now determine the number of pairs for each type.\n\n1.  Number of Alanine-Alanine pairs:\n    There are $n_A = N/2$ Alanine residues in the column. The number of ways to choose an unordered pair of two distinct Alanine residues is given by the binomial coefficient $\\binom{n_A}{2}$.\n    $$ \\text{Number of A-A pairs} = \\binom{N/2}{2} $$\n    The binomial coefficient $\\binom{n}{r}$ is defined as $\\frac{n!}{r!(n-r)!}$. For $r=2$, this simplifies to $\\frac{n(n-1)}{2}$.\n    $$ \\binom{N/2}{2} = \\frac{(N/2)(N/2 - 1)}{2} = \\frac{(N/2)(\\frac{N-2}{2})}{2} = \\frac{N(N-2)}{8} $$\n\n2.  Number of Glycine-Glycine pairs:\n    Similarly, there are $n_G = N/2$ Glycine residues. The number of ways to choose an unordered pair of two distinct Glycine residues is $\\binom{n_G}{2}$.\n    $$ \\text{Number of G-G pairs} = \\binom{N/2}{2} = \\frac{N(N-2)}{8} $$\n\n3.  Number of Alanine-Glycine pairs:\n    To form an Alanine-Glycine pair, we must choose one Alanine residue from the $n_A = N/2$ available Alanines and one Glycine residue from the $n_G = N/2$ available Glycines. The number of ways to do this is the product of the number of choices for each.\n    $$ \\text{Number of A-G pairs} = n_A \\times n_G = (N/2) \\times (N/2) = \\frac{N^2}{4} $$\n    Since the scoring function $S$ is symmetric, $S(\\mathrm{A},\\mathrm{G}) = S(\\mathrm{G},\\mathrm{A})$, so we do not need to distinguish the order.\n\nNow, we substitute these quantities back into the expression for the total SP score. Let the total score be denoted by $\\Sigma$.\n$$ \\Sigma = \\left(\\frac{N(N-2)}{8}\\right) s_{AA} + \\left(\\frac{N(N-2)}{8}\\right) s_{GG} + \\left(\\frac{N^2}{4}\\right) s_{AG} $$\n\nThis expression can be simplified by factoring out common terms. We can factor $\\frac{N(N-2)}{8}$ from the first two terms.\n$$ \\Sigma = \\frac{N(N-2)}{8} (s_{AA} + s_{GG}) + \\frac{N^2}{4} s_{AG} $$\n\nThis is the final, closed-form expression for the SP score of the column as a function of $N$, $s_{AA}$, $s_{GG}$, and $s_{AG}$. The derivation is complete and logically sound.",
            "answer": "$$\n\\boxed{\\frac{N(N-2)}{8} (s_{AA} + s_{GG}) + \\frac{N^2}{4} s_{AG}}\n$$"
        },
        {
            "introduction": "Real-world alignment algorithms often build up an MSA by adding sequences one at a time. This exercise explores the dynamics of this process by asking you to derive the change in the total SP score when a new sequence is added. This reveals how the score change depends on the new sequence's similarity to all pre-existing sequences, providing insight into the computational basis of progressive alignment methods. ",
            "id": "2432588",
            "problem": "Consider a Multiple Sequence Alignment (MSA) of $N$ sequences with aligned length $L$. Let the aligned character at row $i$ and column $c$ be $x_{i,c} \\in \\Sigma \\cup \\{-\\}$, where $\\Sigma$ is a finite residue alphabet (e.g., amino acids) and $-$ denotes a gap. Let $s: \\left(\\Sigma \\cup \\{-\\}\\right) \\times \\left(\\Sigma \\cup \\{-\\}\\right) \\to \\mathbb{R}$ be a symmetric pairwise scoring function, and let the total sum-of-pairs (SP) score be defined by\n$$\nS = \\sum_{1 \\le i  j \\le N} \\sum_{c=1}^{L} s\\!\\left(x_{i,c}, x_{j,c}\\right).\n$$\nA new MSA is formed by adding a $(N+1)$-st sequence that is exactly identical, column-by-column, to an existing sequence with index $k \\in \\{1,\\dots,N\\}$, i.e., $x_{N+1,c} = x_{k,c}$ for all $c \\in \\{1,\\dots,L\\}$. Denote the new total SP score by $S'$. Derive a closed-form analytic expression for the change in total SP score $\\Delta S = S' - S$ in terms of $N$, $L$, $s(\\cdot,\\cdot)$, the symbols $x_{i,c}$, and the index $k$. Provide your final answer as a single simplified expression. No numerical evaluation is required.",
            "solution": "The problem statement is critically examined and found to be valid. It is scientifically grounded in the principles of computational biology, specifically multiple sequence alignment scoring. The problem is well-posed, objective, and contains all necessary information for a unique mathematical derivation. We shall proceed with the solution.\n\nLet the original number of sequences be $N$ and the aligned length be $L$. The character at row $i$ and column $c$ is $x_{i,c}$. The original sum-of-pairs (SP) score, $S$, is defined over all unique pairs of sequences $(i,j)$ where $1 \\le i  j \\le N$. The formula is:\n$$\nS = \\sum_{1 \\le i  j \\le N} \\sum_{c=1}^{L} s\\!\\left(x_{i,c}, x_{j,c}\\right)\n$$\nA new, $(N+1)$-st sequence is added to the alignment, bringing the total number of sequences to $N+1$. The new total SP score, denoted by $S'$, is the sum over all unique pairs of sequences in the expanded alignment. The indices for the pairs $(i,j)$ now satisfy $1 \\le i  j \\le N+1$. The expression for $S'$ is:\n$$\nS' = \\sum_{1 \\le i  j \\le N+1} \\sum_{c=1}^{L} s\\!\\left(x_{i,c}, x_{j,c}\\right)\n$$\nThe objective is to find the change in the score, $\\Delta S = S' - S$. To do this, we decompose the summation for $S'$. The set of all pairs $(i,j)$ with $1 \\le i  j \\le N+1$ can be partitioned into two disjoint subsets:\n1. Pairs where both sequences are from the original alignment, for which the indices satisfy $1 \\le i  j \\le N$.\n2. Pairs that include the newly added $(N+1)$-st sequence. These are of the form $(i, N+1)$ for $1 \\le i \\le N$.\n\nBased on this partitioning, we can rewrite the expression for $S'$ as the sum of contributions from these two subsets of pairs:\n$$\nS' = \\left( \\sum_{1 \\le i  j \\le N} \\sum_{c=1}^{L} s\\!\\left(x_{i,c}, x_{j,c}\\right) \\right) + \\left( \\sum_{i=1}^{N} \\sum_{c=1}^{L} s\\!\\left(x_{i,c}, x_{N+1,c}\\right) \\right)\n$$\nThe first term in the above expression is identical to the definition of the original score, $S$. Thus, we can write:\n$$\nS' = S + \\sum_{i=1}^{N} \\sum_{c=1}^{L} s\\!\\left(x_{i,c}, x_{N+1,c}\\right)\n$$\nThe change in score, $\\Delta S$, is the difference $S' - S$. From the previous equation, this difference is clearly the second term:\n$$\n\\Delta S = S' - S = \\sum_{i=1}^{N} \\sum_{c=1}^{L} s\\!\\left(x_{i,c}, x_{N+1,c}\\right)\n$$\nThis expression represents the sum of the pairwise scores between the new sequence $(N+1)$ and all of the original $N$ sequences.\n\nThe problem provides the crucial piece of information that the new sequence is an exact duplicate of an existing sequence with index $k \\in \\{1, \\dots, N\\}$. This is stated as $x_{N+1,c} = x_{k,c}$ for all columns $c \\in \\{1, \\dots, L\\}$. We substitute this identity into our expression for $\\Delta S$:\n$$\n\\Delta S = \\sum_{i=1}^{N} \\sum_{c=1}^{L} s\\!\\left(x_{i,c}, x_{k,c}\\right)\n$$\nThis is the final closed-form analytic expression for the change in the total SP score. It can be interpreted as the sum of column-wise scores between sequence $k$ and every sequence $i$ in the original alignment, including the score of sequence $k$ against itself (for the case $i=k$). The expression is fully determined by the specified input parameters and requires no further simplification. The symmetry of the scoring function $s(\\cdot, \\cdot)$ is consistent with this result but was not strictly necessary for this derivation, as the ordering of indices is fixed by the summation bounds.",
            "answer": "$$\n\\boxed{\\sum_{i=1}^{N} \\sum_{c=1}^{L} s\\left(x_{i,c}, x_{k,c}\\right)}\n$$"
        }
    ]
}