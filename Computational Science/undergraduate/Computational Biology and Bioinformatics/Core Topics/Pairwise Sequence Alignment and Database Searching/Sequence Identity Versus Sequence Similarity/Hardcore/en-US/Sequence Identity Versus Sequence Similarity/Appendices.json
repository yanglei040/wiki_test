{
    "hands_on_practices": [
        {
            "introduction": "To appreciate why sequence similarity is a more powerful concept than sequence identity, we must first establish a statistical baseline. What level of identity might we expect to find between two completely random, unrelated sequences? This exercise guides you through a foundational thought experiment  to calculate the expected values for both identity and a properly normalized similarity score. By working through this problem, you will discover why a score of zero for normalized similarity represents the random background, making any positive score a potentially meaningful signal of homology.",
            "id": "2428749",
            "problem": "Two independent amino acid sequences of length $L=100$ are generated by sampling each position independently and identically from the $20$ canonical amino acids with uniform probability $p(a)=\\frac{1}{20}$ for every amino acid $a$. The sequences are aligned in register without gaps (position $i$ aligned to position $i$ for all $i=1,\\dots,100$).\n\nDefine the sequence identity $I$ as the fraction of aligned positions at which the amino acids are exactly identical:\n$$\nI \\;=\\; \\frac{1}{L}\\sum_{i=1}^{L} \\mathbf{1}\\{A_i=B_i\\},\n$$\nwhere $\\mathbf{1}\\{\\cdot\\}$ is the indicator function and $A_i$ and $B_i$ denote the residues at position $i$ in the first and second sequence, respectively.\n\nLet $s(a,b)$ denote the BLOSUM62 substitution score for amino acids $a$ and $b$. Define the normalized similarity $S_{\\mathrm{norm}}$ of the aligned pair as the average of per-position normalized substitution scores:\n$$\nS_{\\mathrm{norm}} \\;=\\; \\frac{1}{L}\\sum_{i=1}^{L} \\frac{s(A_i,B_i)-\\mu}{E_{\\mathrm{self}}-\\mu},\n$$\nwhere\n$$\n\\mu \\;=\\; \\sum_{x}\\sum_{y} p(x)\\,p(y)\\,s(x,y)\n\\quad\\text{and}\\quad\nE_{\\mathrm{self}} \\;=\\; \\sum_{x} p(x)\\, s(x,x),\n$$\nwith $p(x)=\\frac{1}{20}$ for all amino acids $x$. This normalization uses the BLOSUM62 matrix through $s(\\cdot,\\cdot)$ and the uniform background $p(\\cdot)$.\n\nCompute the expected value of the difference $I - S_{\\mathrm{norm}}$ for this random $100$-residue sequence pair. Express your final answer as a decimal and round to four significant figures. No units are required.",
            "solution": "The problem statement is first subjected to a rigorous validation process.\n\nStep 1: Extract Givens\n- Two independent amino acid sequences, $A$ and $B$, of length $L=100$.\n- Sequences are generated by sampling each position independently and identically from a set of $20$ canonical amino acids.\n- The probability of sampling any amino acid $a$ is uniform: $p(a) = \\frac{1}{20}$.\n- The alignment is in register without gaps.\n- Sequence identity definition: $I = \\frac{1}{L}\\sum_{i=1}^{L} \\mathbf{1}\\{A_i=B_i\\}$, where $\\mathbf{1}\\{\\cdot\\}$ is the indicator function.\n- Normalized similarity definition: $S_{\\mathrm{norm}} = \\frac{1}{L}\\sum_{i=1}^{L} \\frac{s(A_i,B_i)-\\mu}{E_{\\mathrm{self}}-\\mu}$.\n- The scoring function $s(a,b)$ is the BLOSUM62 substitution score.\n- The mean score is defined as $\\mu = \\sum_{x}\\sum_{y} p(x)p(y)s(x,y)$.\n- The mean self-score is defined as $E_{\\mathrm{self}} = \\sum_{x} p(x)s(x,x)$.\n- The task is to compute the expected value of the difference $I - S_{\\mathrm{norm}}$.\n- The final answer must be a decimal rounded to four significant figures.\n\nStep 2: Validate Using Extracted Givens\nThe problem is assessed for validity.\n- **Scientifically Grounded:** The problem is based on fundamental concepts in computational biology and bioinformatics, namely, random sequence models, sequence identity, and substitution scoring matrices (BLOSUM62). The normalization of similarity scores is a standard technique. The setup is scientifically sound.\n- **Well-Posed:** All terms are precisely defined with mathematical rigor. The generation process for the random sequences is explicitly stated. The objective is to compute an expected value, which is a well-defined mathematical problem. The information provided is sufficient to derive a unique solution without requiring the explicit values of the BLOSUM62 matrix.\n- **Objective:** The problem is stated in objective, formal language, free from any subjective or ambiguous terms.\n\nThe problem does not exhibit any flaws such as scientific unsoundness, incompleteness, contradiction, or ambiguity. It is a well-posed problem in statistical sequence analysis.\n\nStep 3: Verdict and Action\nThe problem is valid. A solution will be derived.\n\nThe quantity to be computed is the expected value of the difference between the sequence identity $I$ and the normalized similarity $S_{\\mathrm{norm}}$. We use the linearity of the expectation operator:\n$$\nE[I - S_{\\mathrm{norm}}] = E[I] - E[S_{\\mathrm{norm}}]\n$$\nWe will compute each term separately.\n\nFirst, we compute the expectation of the sequence identity, $E[I]$.\nThe definition of $I$ is $I = \\frac{1}{L}\\sum_{i=1}^{L} \\mathbf{1}\\{A_i=B_i\\}$.\nBy linearity of expectation:\n$$\nE[I] = E\\left[\\frac{1}{L}\\sum_{i=1}^{L} \\mathbf{1}\\{A_i=B_i\\}\\right] = \\frac{1}{L}\\sum_{i=1}^{L} E[\\mathbf{1}\\{A_i=B_i\\}]\n$$\nThe expectation of an indicator function is the probability of the event it indicates. Thus, $E[\\mathbf{1}\\{A_i=B_i\\}] = P(A_i = B_i)$.\nThe amino acids $A_i$ and $B_i$ at any position $i$ are chosen independently and uniformly from a set of $20$ possibilities. The probability of a match at position $i$ is the sum of probabilities of matching each specific amino acid type $x$:\n$$\nP(A_i = B_i) = \\sum_{x} P(A_i = x \\text{ and } B_i = x)\n$$\nDue to independence, $P(A_i = x \\text{ and } B_i = x) = P(A_i=x)P(B_i=x)$. We are given that $P(A_i=x) = p(x) = \\frac{1}{20}$ and $P(B_i=x) = p(x) = \\frac{1}{20}$ for any amino acid $x$.\nTherefore, for any position $i$:\n$$\nP(A_i = B_i) = \\sum_{x} p(x) \\cdot p(x) = \\sum_{x} \\left(\\frac{1}{20}\\right)^2\n$$\nThe sum is over all $20$ canonical amino acids.\n$$\nP(A_i = B_i) = 20 \\times \\left(\\frac{1}{20}\\right)^2 = 20 \\times \\frac{1}{400} = \\frac{1}{20}\n$$\nSince this probability is the same for all positions $i=1, \\dots, L$, the expectation of $I$ is:\n$$\nE[I] = \\frac{1}{L}\\sum_{i=1}^{L} \\frac{1}{20} = \\frac{1}{L} \\cdot L \\cdot \\frac{1}{20} = \\frac{1}{20}\n$$\n\nNext, we compute the expectation of the normalized similarity, $E[S_{\\mathrm{norm}}]$.\nThe definition of $S_{\\mathrm{norm}}$ is $S_{\\mathrm{norm}} = \\frac{1}{L}\\sum_{i=1}^{L} \\frac{s(A_i,B_i)-\\mu}{E_{\\mathrm{self}}-\\mu}$.\nAgain, by linearity of expectation:\n$$\nE[S_{\\mathrm{norm}}] = E\\left[\\frac{1}{L}\\sum_{i=1}^{L} \\frac{s(A_i,B_i)-\\mu}{E_{\\mathrm{self}}-\\mu}\\right] = \\frac{1}{L(E_{\\mathrm{self}}-\\mu)} \\sum_{i=1}^{L} E[s(A_i,B_i)-\\mu]\n$$\nThe terms $E_{\\mathrm{self}}$ and $\\mu$ are constants. We focus on the expectation $E[s(A_i,B_i)-\\mu]$.\n$$\nE[s(A_i,B_i)-\\mu] = E[s(A_i,B_i)] - E[\\mu] = E[s(A_i,B_i)] - \\mu\n$$\nThe expectation $E[s(A_i,B_i)]$ is computed by summing over all possible pairs of amino acids $(x, y)$, weighted by their joint probability:\n$$\nE[s(A_i,B_i)] = \\sum_{x}\\sum_{y} P(A_i=x, B_i=y) s(x,y)\n$$\nSince $A_i$ and $B_i$ are independent and drawn with probabilities $p(x)$ and $p(y)$ respectively:\n$$\nP(A_i=x, B_i=y) = P(A_i=x)P(B_i=y) = p(x)p(y)\n$$\nSubstituting this into the expression for the expectation gives:\n$$\nE[s(A_i,B_i)] = \\sum_{x}\\sum_{y} p(x)p(y) s(x,y)\n$$\nThis is precisely the definition of $\\mu$ provided in the problem statement. Thus, $E[s(A_i,B_i)] = \\mu$.\nTherefore, for any position $i$:\n$$\nE[s(A_i,B_i)-\\mu] = \\mu - \\mu = 0\n$$\nSubstituting this result back into the expression for $E[S_{\\mathrm{norm}}]$:\n$$\nE[S_{\\mathrm{norm}}] = \\frac{1}{L(E_{\\mathrm{self}}-\\mu)} \\sum_{i=1}^{L} 0 = 0\n$$\nThis result is by design; the score normalization is constructed to yield an expected score of $0$ for random, unrelated sequences under the specified background probability distribution. The denominator $E_{\\mathrm{self}}-\\mu$ is non-zero for any non-trivial scoring matrix such as BLOSUM62.\n\nFinally, we combine the two results to find the required expectation:\n$$\nE[I - S_{\\mathrm{norm}}] = E[I] - E[S_{\\mathrm{norm}}] = \\frac{1}{20} - 0 = \\frac{1}{20}\n$$\nThe problem requires the answer as a decimal rounded to four significant figures.\n$$\n\\frac{1}{20} = 0.05\n$$\nTo express $0.05$ with four significant figures, we write it as $0.05000$.",
            "answer": "$$\\boxed{0.05000}$$"
        },
        {
            "introduction": "This practice moves from statistical theory to a direct, hands-on demonstration of the power of similarity scores. Is it possible for an alignment algorithm to detect a significant relationship ($S^\\star > 0$) between two sequences even if they share no identical residues in the aligned region? This coding exercise  challenges you to construct such a case using the Smith-Waterman algorithm, vividly illustrating that similarity captures biochemical relationships that raw identity misses entirely.",
            "id": "2428720",
            "problem": "You must write a complete program that, from first principles, constructs pairs of protein sequences over the uppercase English alphabet used for amino acids and evaluates whether the following property can be satisfied under specified local alignment scoring models: a Smith–Waterman (SW) local alignment between the two sequences has a strictly positive optimal score while the identity within the aligned region is equal to the decimal $0$. Your program must implement the Smith–Waterman dynamic programming recurrence with a linear gap penalty. The definitions and evaluation rules below must be followed exactly.\n\nDefinitions. Let $X = x_1 x_2 \\dots x_n$ and $Y = y_1 y_2 \\dots y_m$ be two sequences over a specified finite alphabet. A scoring function $s(\\cdot,\\cdot)$ assigns an integer similarity score to any aligned pair of letters. A linear gap penalty of magnitude $d \\ge 0$ subtracts $d$ for each gap character introduced. The Smith–Waterman dynamic programming matrix $H \\in \\mathbb{Z}^{(n+1)\\times(m+1)}$ is defined by the base conditions $H_{0,j} = 0$ for all $j \\in \\{0,1,\\dots,m\\}$ and $H_{i,0} = 0$ for all $i \\in \\{0,1,\\dots,n\\}$, and by the recurrence for all $i \\in \\{1,\\dots,n\\}$ and $j \\in \\{1,\\dots,m\\}$:\n$$\nH_{i,j} \\;=\\; \\max\\Big\\{\\, 0,\\; H_{i-1,j-1} + s(x_i,y_j),\\; H_{i-1,j} - d,\\; H_{i,j-1} - d \\,\\Big\\}.\n$$\nThe optimal Smith–Waterman local alignment score is $S^\\star(X,Y) = \\max_{0 \\le i \\le n,\\; 0 \\le j \\le m} H_{i,j}$. One optimal aligned region is any alignment recovered by a valid traceback path that starts at a cell $(i^\\star,j^\\star)$ attaining the maximum $S^\\star(X,Y)$ and proceeds by choosing at each step one predecessor that realizes the $\\max$ until a cell with value $0$ is reached. Define the aligned columns as the positions on the traceback path that correspond to diagonal steps; each diagonal step aligns one letter from $X$ to one letter from $Y$. Let $L$ be the total number of aligned columns (that is, the number of diagonal steps). Define the identity in the aligned region to be\n$$\n\\mathrm{Id}(X,Y) \\;=\\; \n\\begin{cases}\n\\frac{M}{L}, & \\text{if } L > 0,\\\\\n0, & \\text{if } L = 0,\n\\end{cases}\n$$\nwhere $M$ is the number of aligned columns among the $L$ diagonal steps for which the two letters are identical. The identity must be expressed as a decimal in the interval $[0,1]$ and for this task must equal the decimal $0$.\n\nScoring models. Your program must handle the following scoring models, each constituting one test case. For each test case, you may construct any sequences that satisfy the stated alphabet constraints and any additional length constraints. Your output for each test case must be a boolean that is true if and only if you construct sequences $X$ and $Y$ such that $S^\\star(X,Y) > 0$ and $\\mathrm{Id}(X,Y) = 0$, and false otherwise.\n\n- Test case 1 (happy path, hydrophobic similarity). Alphabet restricted to the amino acids $\\{ \\mathrm{I}, \\mathrm{L}, \\mathrm{V}, \\mathrm{M} \\}$. Use the Blocks Substitution Matrix $62$ (BLOSUM$62$) scores for this $4 \\times 4$ subset, with $s(a,b)$ specified as:\n  $s(\\mathrm{I},\\mathrm{I}) = 4$, $s(\\mathrm{I},\\mathrm{L}) = 2$, $s(\\mathrm{I},\\mathrm{V}) = 3$, $s(\\mathrm{I},\\mathrm{M}) = 1$;\n  $s(\\mathrm{L},\\mathrm{I}) = 2$, $s(\\mathrm{L},\\mathrm{L}) = 4$, $s(\\mathrm{L},\\mathrm{V}) = 1$, $s(\\mathrm{L},\\mathrm{M}) = 2$;\n  $s(\\mathrm{V},\\mathrm{I}) = 3$, $s(\\mathrm{V},\\mathrm{L}) = 1$, $s(\\mathrm{V},\\mathrm{V}) = 4$, $s(\\mathrm{V},\\mathrm{M}) = 1$;\n  $s(\\mathrm{M},\\mathrm{I}) = 1$, $s(\\mathrm{M},\\mathrm{L}) = 2$, $s(\\mathrm{M},\\mathrm{V}) = 1$, $s(\\mathrm{M},\\mathrm{M}) = 5$.\n  Use a linear gap penalty $d = 5$. There is no length constraint beyond $n \\ge 1$ and $m \\ge 1$.\n\n- Test case 2 (boundary length, zero gap penalty). Same BLOSUM$62$ subset and alphabet as in test case $1$, but use a linear gap penalty $d = 0$. Enforce the boundary condition that $n = 1$ and $m = 1$.\n\n- Test case 3 (impossible regime under identity-only scoring). Use the full uppercase amino acid alphabet. Use a match/mismatch scoring model defined by $s(a,b) = 2$ if $a=b$ and $s(a,b) = -1$ if $a \\ne b$. Use a linear gap penalty $d = 2$. There is no length constraint beyond $n \\ge 1$ and $m \\ge 1$.\n\nYour task. For each test case $t \\in \\{1,2,3\\}$, construct any pair of sequences $(X_t,Y_t)$ that complies with the stated alphabet and length constraints for that test case and evaluate $S^\\star(X_t,Y_t)$ and $\\mathrm{Id}(X_t,Y_t)$ using the definitions above. Your program must produce a single line of output containing the results as a comma-separated list enclosed in square brackets of length $3$, where the $t$-th element is a boolean that is true if and only if both $S^\\star(X_t,Y_t) > 0$ and $\\mathrm{Id}(X_t,Y_t) = 0$ hold, and false otherwise. For example, your program must print a line of the form $[\\text{result}_1,\\text{result}_2,\\text{result}_3]$.\n\nTest suite summary that you must implement and evaluate:\n- Test $1$: BLOSUM$62$ subset on $\\{\\mathrm{I},\\mathrm{L},\\mathrm{V},\\mathrm{M}\\}$ with $d=5$.\n- Test $2$: BLOSUM$62$ subset on $\\{\\mathrm{I},\\mathrm{L},\\mathrm{V},\\mathrm{M}\\}$ with $d=0$ and $n=m=1$.\n- Test $3$: Match $+2$ and mismatch $-1$ with $d=2$ on the amino acid alphabet.\n\nAll answers are unitless. Identity must be handled as a decimal in $[0,1]$. Your single-line output must be exactly the boolean list as specified, with no additional characters or lines.",
            "solution": "The problem statement is subjected to rigorous validation before any attempt at a solution is made.\n\n### Step 1: Extract Givens\n\nThe givens are extracted verbatim from the problem statement:\n-   **Sequences**: $X = x_1 x_2 \\dots x_n$ and $Y = y_1 y_2 \\dots y_m$.\n-   **Scoring function**: $s(\\cdot,\\cdot)$ assigns an integer score.\n-   **Linear gap penalty**: magnitude $d \\ge 0$.\n-   **Smith-Waterman (SW) matrix**: $H \\in \\mathbb{Z}^{(n+1)\\times(m+1)}$.\n-   **Base conditions**: $H_{0,j} = 0$ for all $j \\in \\{0,1,\\dots,m\\}$ and $H_{i,0} = 0$ for all $i \\in \\{0,1,\\dots,n\\}$.\n-   **SW recurrence**: for all $i \\in \\{1,\\dots,n\\}$ and $j \\in \\{1,\\dots,m\\}$:\n    $$\n    H_{i,j} \\;=\\; \\max\\Big\\{\\, 0,\\; H_{i-1,j-1} + s(x_i,y_j),\\; H_{i-1,j} - d,\\; H_{i,j-1} - d \\,\\Big\\}.\n    $$\n-   **Optimal score**: $S^\\star(X,Y) = \\max_{0 \\le i \\le n,\\; 0 \\le j \\le m} H_{i,j}$.\n-   **Traceback**: Starts at a cell $(i^\\star,j^\\star)$ with score $S^\\star$, ends at a cell with score $0$.\n-   **Aligned columns**: Diagonal steps on the traceback path. $L$ is their total count.\n-   **Identity**:\n    $$\n    \\mathrm{Id}(X,Y) \\;=\\; \n    \\begin{cases}\n    \\frac{M}{L}, & \\text{if } L > 0,\\\\\n    0, & \\text{if } L = 0,\n    \\end{cases}\n    $$\n    where $M$ is the count of identical pairs among the $L$ aligned columns.\n-   **Property to evaluate**: Whether there exist sequences $X, Y$ such that $S^\\star(X,Y) > 0$ and $\\mathrm{Id}(X,Y)$ is equal to the decimal $0$.\n\n-   **Test Case 1**: Alphabet $\\{\\mathrm{I}, \\mathrm{L}, \\mathrm{V}, \\mathrm{M}\\}$, BLOSUM$62$ subset scores as provided, gap penalty $d=5$, length constraints $n \\ge 1, m \\ge 1$.\n-   **Test Case 2**: Same alphabet and scoring as Case $1$, gap penalty $d=0$, length constraints $n=1, m=1$.\n-   **Test Case 3**: Full uppercase amino acid alphabet, scoring $s(a,b) = 2$ if $a=b$ and $s(a,b)=-1$ if $a \\ne b$, gap penalty $d=2$, length constraints $n \\ge 1, m \\ge 1$.\n\n### Step 2: Validate Using Extracted Givens\n\n-   **Scientifically Grounded**: The problem is based on the Smith-Waterman algorithm, a foundational concept in bioinformatics. The scoring models (BLOSUM matrix, match/mismatch scheme) and linear gap penalties are standard. The provided definitions are mathematically and algorithmically correct. The problem is sound.\n-   **Well-Posed**: The problem is structured as three distinct test cases, each with fully specified parameters. For each case, it asks for the existence of sequences satisfying a precisely defined property. This is a well-posed question which has a definite boolean answer (true or false).\n-   **Objective**: The problem is stated in objective, formal language, free of ambiguity or subjective claims.\n\nThe problem does not exhibit any flaws such as scientific unsoundness, incompleteness, contradiction, or ill-posed structure.\n\n### Step 3: Verdict and Action\n\nThe problem is valid. A solution will be provided.\n\n### Principle-Based Solution Design\n\nThe core task is to determine, for each of the three scoring models, if it is possible to construct two sequences $X$ and $Y$ that satisfy two conditions simultaneously:\n$1$. The optimal local alignment score $S^\\star(X,Y)$ is strictly positive.\n$2$. The identity of the optimal local alignment, $\\mathrm{Id}(X,Y)$, is exactly $0$.\n\nThe condition $\\mathrm{Id}(X,Y) = 0$ implies that within the region of optimal local alignment, there are no matching characters. For this to be non-trivial, the alignment length $L$ (number of diagonal steps in traceback) must be greater than $0$, which in turn means the number of matches $M$ must be $0$. If $L=0$, the alignment is empty, its score is $0$, and the condition $S^\\star > 0$ is violated. Therefore, we seek an alignment path with at least one diagonal step ($L \\ge 1$), where all such steps are mismatches.\n\nThe score of a local alignment is determined by the sum of scores of its constituent operations (matches, mismatches, and gaps). For $S^\\star > 0$, there must exist an alignment path starting from a score of $0$ that accumulates a positive total score.\n\n**Test Case 1: BLOSUM$62$ subset, $d=5$**\n\nThe alphabet is $\\{\\mathrm{I}, \\mathrm{L}, \\mathrm{V}, \\mathrm{M}\\}$. The scoring matrix provided assigns positive scores to substitutions between these similar hydrophobic amino acids. For instance, the score for aligning Isoleucine (I) with Valine (V) is $s(\\mathrm{I},\\mathrm{V}) = 3$. Let us construct the simplest possible non-trivial sequences: $X = \\text{\"I\"}$ and $Y = \\text{\"V\"}$. Here, $n=1, m=1$.\n\nThe Smith-Waterman matrix $H$ is of size $2 \\times 2$. The only non-trivial entry to compute is $H_{1,1}$:\n$$H_{1,1} = \\max\\{0, H_{0,0} + s(\\text{'I'},\\text{'V'}), H_{0,1} - 5, H_{1,0} - 5\\}$$\n$$H_{1,1} = \\max\\{0, 0 + 3, 0 - 5, 0 - 5\\} = \\max\\{0, 3, -5, -5\\} = 3$$\nThe optimal score is $S^\\star = 3 > 0$.\nTo find the identity, we trace back from the cell $(1,1)$. The score $3$ was obtained from the diagonal predecessor $H_{0,0}$. This constitutes one diagonal step, so $L=1$. The alignment is $\\text{'I'}$ with $\\text{'V'}$. Since these are different, the number of matches $M=0$.\nThe identity is $\\mathrm{Id} = M/L = 0/1 = 0$.\nBoth conditions ($S^\\star > 0$ and $\\mathrm{Id}=0$) are satisfied. Thus, the property is satisfiable for this case. The answer is `True`.\n\n**Test Case 2: BLOSUM$62$ subset, $d=0, n=m=1$**\n\nThis case uses the same scoring as Case 1, but with a zero gap penalty and a strict length constraint of $n=1$ and $m=1$. The logic from Case $1$ is directly applicable. Let us again choose $X = \\text{\"I\"}$ and $Y = \\text{\"V\"}$.\nThe score calculation is:\n$$H_{1,1} = \\max\\{0, H_{0,0} + s(\\text{'I'},\\text{'V'}), H_{0,1} - 0, H_{1,0} - 0\\}$$\n$$H_{1,1} = \\max\\{0, 0 + 3, 0 - 0, 0 - 0\\} = \\max\\{0, 3, 0, 0\\} = 3$$\nThe optimal score is $S^\\star = 3 > 0$. The alignment consists of one mismatch, so $L=1, M=0$, and $\\mathrm{Id}=0$. Both conditions are satisfied. The answer is `True`.\n\n**Test Case 3: Identity-only scoring, $d=2$**\n\nThe scoring model is $s(a,a) = 2$ (match) and $s(a,b) = -1$ for $a \\ne b$ (mismatch). The gap penalty is $d=2$.\nTo achieve $\\mathrm{Id}=0$, an alignment path must be composed entirely of mismatches and gaps.\nLet's analyze the score contribution of each possible step in such an alignment:\n-   A mismatch contributes a score of $-1$.\n-   A gap (insertion or deletion) contributes a score of $-d = -2$.\n\nAny alignment path starting from a score of $0$ and consisting of a sequence of these operations will accumulate a total score. Let the path have $k_d$ mismatches and $k_g$ gaps. For the identity to be defined as specified and the alignment to be non-empty, we require $L = k_d > 0$. The total score of this alignment path is:\n$$\\text{Score} = k_d \\times (-1) + k_g \\times (-2) = -k_d - 2k_g$$\nSince $k_d \\ge 1$ and $k_g \\ge 0$, this score is always strictly negative (e.g., $\\le -1$).\nThe Smith-Waterman recurrence is $H_{i,j} = \\max\\{0, \\dots\\}$. This means that if the score of extending any existing alignment or starting a new one is negative, the resulting cell value $H_{i,j}$ will be set to $0$. An alignment consisting solely of mismatches and gaps will always produce a non-positive score path. Consequently, the maximum score in the entire matrix, $S^\\star$, can never be strictly positive. It will be $0$.\nTherefore, it is impossible to satisfy $S^\\star > 0$ and $\\mathrm{Id}=0$ simultaneously under this scoring model. The property is not satisfiable. The answer is `False`.\n\n**Algorithmic Implementation**\n\nThe solution is implemented in Python. A function, `run_sw_and_evaluate`, encapsulates the logic for a single test case. It constructs the specified sequences, scoring function, and gap penalty. It then calls a `smith_waterman` function which implements the algorithm from first principles using `numpy` for the dynamic programming matrix. This function calculates the optimal score $S^\\star$ and, if $S^\\star > 0$, performs a traceback to compute the alignment identity $\\mathrm{Id}$. The main `solve` function iterates through the three test cases, calls `run_sw_and_evaluate` for each, and appends the resulting boolean to a list. Finally, it prints the list in the specified format. The chosen sequences for test cases $1$ and $2$ are simple pairs demonstrating positive mismatch scores, as reasoned above. For test case $3$, a simple mismatch pair is used, which correctly yields a score of $0$, leading to a `False` result, consistent with the proof of impossibility.",
            "answer": "```python\nimport numpy as np\n\ndef smith_waterman(X: str, Y: str, score_func, d: int):\n    \"\"\"\n    Implements the Smith-Waterman algorithm from first principles.\n\n    Args:\n        X: The first sequence.\n        Y: The second sequence.\n        score_func: A function s(a, b) that returns the score of aligning characters a and b.\n        d: The linear gap penalty (a positive integer).\n\n    Returns:\n        A tuple (max_score, identity) where max_score is the optimal local\n        alignment score and identity is the fraction of matches in the\n        optimal alignment.\n    \"\"\"\n    n = len(X)\n    m = len(Y)\n    H = np.zeros((n + 1, m + 1), dtype=int)\n    \n    max_score = 0\n    max_pos = (0, 0)\n\n    for i in range(1, n + 1):\n        for j in range(1, m + 1):\n            match_score = H[i - 1, j - 1] + score_func(X[i - 1], Y[j - 1])\n            delete_score = H[i - 1, j] - d\n            insert_score = H[i, j - 1] - d\n            \n            H[i, j] = max(0, match_score, delete_score, insert_score)\n\n            if H[i, j] > max_score:\n                max_score = H[i, j]\n                max_pos = (i, j)\n\n    if max_score == 0:\n        return 0, 0.0\n\n    # Traceback to calculate identity\n    i, j = max_pos\n    L, M = 0, 0\n    \n    while H[i, j] > 0:\n        current_score = H[i, j]\n        \n        # Check diagonal predecessor\n        if i > 0 and j > 0 and current_score == H[i - 1, j - 1] + score_func(X[i - 1], Y[j - 1]):\n            L += 1\n            if X[i - 1] == Y[j - 1]:\n                M += 1\n            i, j = i - 1, j - 1\n        # Check up predecessor (gap in Y)\n        elif i > 0 and current_score == H[i - 1, j] - d:\n            i -= 1\n        # Check left predecessor (gap in X)\n        elif j > 0 and current_score == H[i, j - 1] - d:\n            j -= 1\n        else:\n            # Should not be reached if traceback starts from a cell > 0.\n            # This indicates the alignment started at this cell.\n            break\n            \n    identity = M / L if L > 0 else 0.0\n    return max_score, identity\n\ndef solve():\n    \"\"\"\n    Defines and runs the three test cases specified in the problem.\n    \"\"\"\n    \n    # Test Case 1: BLOSUM62 subset, d=5\n    blosum62_subset = {\n        'I': {'I': 4, 'L': 2, 'V': 3, 'M': 1},\n        'L': {'I': 2, 'L': 4, 'V': 1, 'M': 2},\n        'V': {'I': 3, 'V': 4, 'L': 1, 'M': 1},\n        'M': {'I': 1, 'L': 2, 'V': 1, 'M': 5}\n    }\n    score_func_1 = lambda a, b: blosum62_subset[a][b]\n    # We choose two different amino acids with a positive substitution score.\n    X1, Y1 = \"I\", \"V\" \n    d1 = 5\n    \n    # Test Case 2: BLOSUM62 subset, d=0, n=m=1\n    score_func_2 = score_func_1\n    X2, Y2 = \"I\", \"V\"\n    d2 = 0\n\n    # Test Case 3: Match/mismatch, d=2\n    score_func_3 = lambda a, b: 2 if a == b else -1\n    # We choose any two different amino acids to form a mismatch.\n    X3, Y3 = \"A\", \"R\"\n    d3 = 2\n    \n    test_cases = [\n        (X1, Y1, score_func_1, d1),\n        (X2, Y2, score_func_2, d2),\n        (X3, Y3, score_func_3, d3),\n    ]\n\n    results = []\n    for X, Y, score_func, d in test_cases:\n        s_star, identity = smith_waterman(X, Y, score_func, d)\n        condition_met = (s_star > 0 and identity == 0.0)\n        results.append(condition_met)\n    \n    # Python's str(bool) produces \"True\" and \"False\".\n    # The problem asks for a boolean, and this is the standard representation.\n    # The example [result_1, ...] suggests a comma-separated list.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "Our final exercise synthesizes these concepts into a practical optimization problem. If you were to design a new sequence that is exactly $0.5$ identical to a reference sequence, how would you choose which residues to change in order to maximize the overall similarity score? This practice  requires a clever greedy algorithm that weighs the score contribution of keeping a residue versus making the most 'conservative' substitution possible. It provides a deeper appreciation for the quantitative information embedded in substitution matrices like BLOSUM62 and sharpens your algorithmic thinking.",
            "id": "2428729",
            "problem": "You are given a reference protein sequence over the standard $20$ amino acids $\\{ \\mathrm{A}, \\mathrm{R}, \\mathrm{N}, \\mathrm{D}, \\mathrm{C}, \\mathrm{Q}, \\mathrm{E}, \\mathrm{G}, \\mathrm{H}, \\mathrm{I}, \\mathrm{L}, \\mathrm{K}, \\mathrm{M}, \\mathrm{F}, \\mathrm{P}, \\mathrm{S}, \\mathrm{T}, \\mathrm{W}, \\mathrm{Y}, \\mathrm{V} \\}$. Let the reference sequence be denoted by $S = (a_1, a_2, \\dots, a_n)$ of length $n$, where $n$ is even. Consider constructing a new protein sequence $T = (b_1, b_2, \\dots, b_n)$ of the same length such that exactly one half of the positions are identical to the reference, that is, exactly $n/2$ indices $i$ satisfy $b_i = a_i$. There are no insertions or deletions. The BLOcks SUbstitution Matrix (BLOSUM62) defines a substitution score $s(x,y)$ for any pair of amino acids $x$ and $y$. The total sequence-to-sequence similarity score is the sum of per-position scores:\n$$\n\\text{Score}(S,T) = \\sum_{i=1}^{n} s(a_i, b_i).\n$$\nYour task is to compute, for each provided reference sequence $S$, the maximum possible value of $\\text{Score}(S,T)$ over all sequences $T$ with exactly $n/2$ positions identical to $S$, using the canonical BLOSUM62 substitution scores and allowing any amino acid choice at non-identical positions. All sequences are over the $20$ standard amino acids and contain no ambiguous letters. No gaps are permitted, and all comparisons are position-wise.\n\nTest suite:\n- Case $1$ (general repeated residue): $S = \\text{\"AAAAAA\"}$.\n- Case $2$ (general repeated residue with high diagonal): $S = \\text{\"WWWWWW\"}$.\n- Case $3$ (general repeated residue with neutral off-diagonal): $S = \\text{\"GGGG\"}$.\n- Case $4$ (alternating residues probing per-position tradeoffs): $S = \\text{\"ACACACAC\"}$.\n- Case $5$ (boundary length): $S = \\text{\"AA\"}$.\n\nFor each case, compute a single integer: the maximal value of $\\text{Score}(S,T)$ achievable by any $T$ with exactly $n/2$ identities. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., \"[x1,x2,x3,x4,x5]\"), in the same order as the test suite above. There are no physical units involved in this problem. The fraction of identical positions must be expressed as exactly one half, i.e., $n/2$ or $0.5$ of the positions, not a percentage.",
            "solution": "The problem as stated is a constrained optimization problem within the domain of computational biology. We are asked to find the maximum similarity score between a given reference protein sequence $S$ and a target sequence $T$ of the same length, under the specific constraint that exactly half of the positions in $T$ are identical to those in $S$.\n\nLet the reference sequence be $S = (a_1, a_2, \\dots, a_n)$ of even length $n$ over the alphabet of $20$ standard amino acids. We seek to construct a sequence $T = (b_1, b_2, \\dots, b_n)$ that maximizes the total similarity score, defined as:\n$$\n\\text{Score}(S,T) = \\sum_{i=1}^{n} s(a_i, b_i)\n$$\nwhere $s(x,y)$ is the substitution score given by the BLOSUM62 matrix.\n\nThe construction of $T$ is subject to a critical constraint: the number of positions $i$ where $b_i = a_i$ must be exactly $n/2$. Let us partition the set of sequence indices $\\{1, 2, \\dots, n\\}$ into two disjoint subsets:\n1.  The set of identical positions, $I = \\{i \\mid b_i = a_i\\}$, with cardinality $|I| = n/2$.\n2.  The set of mutated positions, $M = \\{i \\mid b_i \\neq a_i\\}$, with cardinality $|M| = n/2$.\n\nThe total score can be decomposed into sums over these two sets:\n$$\n\\text{Score}(S,T) = \\sum_{i \\in I} s(a_i, a_i) + \\sum_{i \\in M} s(a_i, b_i)\n$$\n\nTo maximize this total score, we must make optimal choices for both the partition $(I, M)$ and the specific amino acids $b_i$ for all $i \\in M$. The choices of $b_i$ for $i \\in M$ are independent of each other and of the partition. For any given position $i$ that is designated as a mutation site (i.e., $i \\in M$), the score contribution $s(a_i, b_i)$ is maximized by choosing the amino acid $b_i$ (where $b_i \\neq a_i$) that has the highest substitution score with $a_i$.\n\nLet us define two quantities for each position $i$ in the reference sequence $S$:\n1.  The **identity score**, $\\delta_{id}(i)$, is the score contribution if position $i$ is chosen to be identical. This is simply the diagonal element of the BLOSUM62 matrix for the amino acid $a_i$:\n    $$\n    \\delta_{id}(i) = s(a_i, a_i)\n    $$\n2.  The **maximum mutation score**, $\\delta_{mut}(i)$, is the maximum possible score contribution if position $i$ is chosen to be a mutation site. This is found by taking the maximum non-diagonal score in the BLOSUM62 matrix for the amino acid $a_i$:\n    $$\n    \\delta_{mut}(i) = \\max_{x \\in \\mathcal{A}, x \\neq a_i} s(a_i, x)\n    $$\n    where $\\mathcal{A}$ is the set of the $20$ standard amino acids.\n\nWith these definitions, the maximum achievable score for a fixed partition $(I, M)$ is:\n$$\n\\text{Score}_{max}(I, M) = \\sum_{i \\in I} \\delta_{id}(i) + \\sum_{i \\in M} \\delta_{mut}(i)\n$$\n\nOur task is now reduced to finding the optimal partition $(I, M)$ that maximizes this sum. We can reformulate the expression to isolate the terms dependent on the choice of partition. Since $I \\cup M = \\{1, \\dots, n\\}$ and $I \\cap M = \\emptyset$, we can write $\\sum_{i \\in M} \\delta_{mut}(i) = \\sum_{j=1}^{n} \\delta_{mut}(j) - \\sum_{j \\in I} \\delta_{mut}(j)$. Substituting this into the score equation gives:\n$$\n\\text{Score}_{max}(I) = \\sum_{i \\in I} \\delta_{id}(i) + \\left( \\sum_{j=1}^{n} \\delta_{mut}(j) - \\sum_{j \\in I} \\delta_{mut}(j) \\right)\n$$\n$$\n\\text{Score}_{max}(I) = \\left( \\sum_{j=1}^{n} \\delta_{mut}(j) \\right) + \\sum_{i \\in I} (\\delta_{id}(i) - \\delta_{mut}(i))\n$$\n\nThe first term, $\\sum_{j=1}^{n} \\delta_{mut}(j)$, is a constant for a given reference sequence $S$; it does not depend on the choice of the set $I$. Therefore, to maximize the total score, we must maximize the second term. Let us define the **identity advantage** for each position $i$ as:\n$$\n\\Delta_i = \\delta_{id}(i) - \\delta_{mut}(i)\n$$\nThis quantity, $\\Delta_i$, represents the net gain in score obtained by choosing position $i$ to be an identity site ($i \\in I$) rather than an optimal mutation site ($i \\in M$).\n\nThe problem is now to choose a set $I$ of size $n/2$ that maximizes $\\sum_{i \\in I} \\Delta_i$. This is a classic selection problem. The optimal strategy is a greedy one: compute the advantage $\\Delta_i$ for all positions $i=1, \\dots, n$, and then select the $n/2$ positions that have the largest advantage values to form the set $I$.\n\nThe algorithm is as follows:\n1.  For the given reference sequence $S = (a_1, \\dots, a_n)$, pre-compute and store the values of $\\delta_{id}(a)$ and $\\delta_{mut}(a)$ for each of the $20$ standard amino acids $a$, using the canonical BLOSUM62 matrix.\n2.  For each position $i \\in \\{1, \\dots, n\\}$, determine the amino acid $a_i$ and retrieve its corresponding values, $\\delta_{id}(a_i)$ and $\\delta_{mut}(a_i)$.\n3.  Calculate the list of mutation scores $M_{scores} = [\\delta_{mut}(a_1), \\dots, \\delta_{mut}(a_n)]$ and the list of advantages $\\text{Advantages} = [\\Delta_1, \\dots, \\Delta_n]$, where $\\Delta_i = \\delta_{id}(a_i) - \\delta_{mut}(a_i)$.\n4.  Sort the `Advantages` list in descending order.\n5.  The maximum total score is the sum of all maximum mutation scores plus the sum of the top $n/2$ advantages:\n    $$\n    \\text{Score}_{max} = \\left( \\sum_{i=1}^{n} \\delta_{mut}(a_i) \\right) + \\left( \\sum_{j=1}^{n/2} \\text{sorted\\_Advantages}_j \\right)\n    $$\nThis method yields the exact maximum score because the score contributions of individual positions are additive and their optimization is decoupled, allowing a greedy selection of the set of identities $I$.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the protein sequence scoring problem based on a greedy optimization strategy.\n    \n    The problem is to maximize the BLOSUM62 score of a sequence T against a \n    reference sequence S, where T has exactly n/2 identical residues to S.\n\n    The logic is as follows:\n    1. For each position in S, we can either keep it identical or mutate it.\n    2. The score for an identical position `i` is `s(a_i, a_i)`.\n    3. The best possible score for a mutated position `i` is `max(s(a_i, x))` for all `x != a_i`.\n    4. The \"advantage\" of keeping a position identical is the difference: \n       `s(a_i, a_i) - max(s(a_i, x))`.\n    5. To maximize the total score, we should choose the `n/2` positions with the highest\n       \"advantage\" to be identical. The rest will be optimally mutated.\n    6. The final score is the sum of scores from the chosen identical positions and the\n       optimally mutated positions. This is equivalent to summing all optimal mutation\n       scores and adding the sum of the top `n/2` advantages.\n    \"\"\"\n\n    # The canonical 20 amino acids as per the problem.\n    # The order must match the BLOSUM62 matrix below.\n    AA_ORDER = 'ARNDCQEGHILKMFPSTWYV'\n    \n    # Standard BLOSUM62 substitution matrix for the 20 amino acids.\n    # Source: NCBI\n    BLOSUM62 = np.array([\n        # A, R, N, D, C, Q, E, G, H, I, L, K, M, F, P, S, T, W, Y, V\n        [ 4,-1,-2,-2, 0,-1,-1, 0,-2,-1,-1,-1,-1,-2,-1, 1, 0,-3,-2, 0], # A\n        [-1, 5, 0,-2,-3, 1, 0,-2, 0,-3,-2, 2,-1,-3,-2,-1,-1,-3,-2,-3], # R\n        [-2, 0, 6, 1,-3, 0, 0, 0, 1,-3,-3, 0,-2,-3,-2, 1, 0,-4,-2,-3], # N\n        [-2,-2, 1, 6,-3, 0, 2,-1,-1,-3,-4,-1,-3,-3,-1, 0,-1,-4,-3,-3], # D\n        [ 0,-3,-3,-3, 9,-3,-4,-3,-3,-1,-1,-3,-1,-2,-3,-1,-1,-2,-2,-1], # C\n        [-1, 1, 0, 0,-3, 5, 2,-2, 0,-3,-2, 1, 0,-3,-1, 0,-1,-2,-1,-2], # Q\n        [-1, 0, 0, 2,-4, 2, 5,-2, 0,-3,-3, 1,-2,-3,-1, 0,-1,-3,-2,-2], # E\n        [ 0,-2, 0,-1,-3,-2,-2, 6,-2,-4,-4,-2,-3,-3,-2, 0,-2,-2,-3,-3], # G\n        [-2, 0, 1,-1,-3, 0, 0,-2, 8,-3,-3,-1,-2,-1,-2,-1,-2,-2, 2,-3], # H\n        [-1,-3,-3,-3,-1,-3,-3,-4,-3, 4, 2,-3, 1, 0,-3,-2,-1,-3,-1, 3], # I\n        [-1,-2,-3,-4,-1,-2,-3,-4,-3, 2, 4,-2, 2, 0,-3,-2,-1,-2,-1, 1], # L\n        [-1, 2, 0,-1,-3, 1, 1,-2,-1,-3,-2, 5,-1,-3,-1, 0,-1,-3,-2,-2], # K\n        [-1,-1,-2,-3,-1, 0,-2,-3,-2, 1, 2,-1, 5, 0,-2,-1,-1,-1,-1, 1], # M\n        [-2,-3,-3,-3,-2,-3,-3,-3,-1, 0, 0,-3, 0, 6,-4,-2,-2, 1, 3,-1], # F\n        [-1,-2,-2,-1,-3,-1,-1,-2,-2,-3,-3,-1,-2,-4, 7,-1,-1,-4,-3,-2], # P\n        [ 1,-1, 1, 0,-1, 0, 0, 0,-1,-2,-2, 0,-1,-2,-1, 4, 1,-3,-2,-2], # S\n        [ 0,-1, 0,-1,-1,-1,-1,-2,-2,-1,-1,-1,-1,-2,-1, 1, 5,-2,-2, 0], # T\n        [-3,-3,-4,-4,-2,-2,-3,-2,-2,-3,-2,-3,-1, 1,-4,-3,-2,11, 2,-3], # W\n        [-2,-2,-2,-3,-2,-1,-2,-3, 2,-1,-1,-2,-1, 3,-3,-2,-2, 2, 7,-1], # Y\n        [ 0,-3,-3,-3,-1,-2,-2,-3,-3, 3, 1,-2, 1,-1,-2,-2, 0,-3,-1, 4]  # V\n    ])\n    \n    # Map amino acid characters to their index in the matrix\n    AA_MAP = {aa: i for i, aa in enumerate(AA_ORDER)}\n\n    # Pre-calculate identity scores and max mutation scores for each amino acid\n    delta_cache = {}\n    for aa, idx in AA_MAP.items():\n        row = BLOSUM62[idx]\n        delta_id = row[idx]\n        # Max mutation score is the max of the row excluding the identity score\n        delta_mut = np.max(np.delete(row, idx))\n        delta_cache[aa] = (delta_id, delta_mut)\n\n    test_cases = [\n        \"AAAAAA\",     # Case 1\n        \"WWWWWW\",     # Case 2\n        \"GGGG\",       # Case 3\n        \"ACACACAC\",   # Case 4\n        \"AA\"          # Case 5\n    ]\n\n    results = []\n    for seq in test_cases:\n        n = len(seq)\n        num_identities = n // 2\n        \n        advantages = []\n        mut_scores_sum = 0\n        \n        for aa_char in seq:\n            delta_id, delta_mut = delta_cache[aa_char]\n            advantage = delta_id - delta_mut\n            advantages.append(advantage)\n            mut_scores_sum += delta_mut\n            \n        # Sort advantages in descending order to find the top n/2\n        advantages.sort(reverse=True)\n        \n        # The total score is the sum of all optimal mutation scores plus the sum of the\n        # advantages for the positions we choose to keep identical.\n        top_advantages_sum = sum(advantages[:num_identities])\n        \n        max_score = mut_scores_sum + top_advantages_sum\n        results.append(max_score)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}