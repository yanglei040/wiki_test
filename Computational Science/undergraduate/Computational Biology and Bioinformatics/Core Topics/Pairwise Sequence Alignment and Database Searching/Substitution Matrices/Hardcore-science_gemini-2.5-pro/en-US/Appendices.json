{
    "hands_on_practices": [
        {
            "introduction": "The most fundamental skill in sequence analysis is scoring an alignment. This practice provides a direct, hands-on opportunity to apply a standard substitution matrix, BLOSUM62, to quantify the similarity between two peptide sequences. Mastering this core calculation  is the first step toward understanding how bioinformatic tools evaluate evolutionary, structural, and functional relationships.",
            "id": "2136014",
            "problem": "In the field of bioinformatics, sequence alignment is a fundamental method for comparing protein or nucleotide sequences to identify regions of similarity that may be a consequence of functional, structural, or evolutionary relationships. The quality of an alignment is quantified by a score, calculated using a substitution matrix and gap penalties.\n\nConsider the following gapped alignment of two short peptide sequences, Seq1 and Seq2:\n\nSeq1: `F E S A G K D E`\nSeq2: `F R S - G K T E`\n\nCalculate the total alignment score using the BLOcks SUbstitution Matrix 62 (BLOSUM62) and a linear gap penalty. A linear gap penalty means that each gap character, represented by a hyphen (`-`), incurs a fixed negative score, regardless of its length or position. For this problem, the linear gap penalty is $-8$.\n\nThe relevant substitution scores from the BLOSUM62 matrix are provided below:\n- Score(F, F) = 6\n- Score(E, R) = 0\n- Score(S, S) = 4\n- Score(G, G) = 6\n- Score(K, K) = 5\n- Score(D, T) = -1\n- Score(E, E) = 5\n\nProvide the total score as an integer.",
            "solution": "An alignment score with a substitution matrix and a linear gap penalty is computed by summing the substitution score for each aligned residue pair and adding the gap penalty for each gap character. Let $s(x,y)$ denote the BLOSUM62 substitution score and let the linear gap penalty be $g=-8$ per gap character.\n\nFor the given alignment across 8 columns, the contributions are:\n$$\ns(F,F)=6,\\quad s(E,R)=0,\\quad s(S,S)=4,\\quad \\text{gap}=g=-8,\\quad s(G,G)=6,\\quad s(K,K)=5,\\quad s(D,T)=-1,\\quad s(E,E)=5.\n$$\n\nTherefore, the total alignment score $S$ is\n$$\nS=6+0+4+(-8)+6+5+(-1)+5=17.\n$$",
            "answer": "$$\\boxed{17}$$"
        },
        {
            "introduction": "Substitution matrix scores are not arbitrary; they are derived from empirical data. This exercise takes you behind the scenes to calculate a score for a custom-designed matrix based on the log-odds principle. By working through this problem , you will see how observed substitution frequencies in a specific biological context—in this case, a hypothetical matrix for cytosolic proteins—are transformed into the meaningful scores used for alignment.",
            "id": "2136035",
            "problem": "A team of computational biologists is developing a specialized substitution matrix, which they have named \"CytoBLOSUM.\" This matrix is intended for the accurate alignment of protein sequences that are known to exist exclusively within the highly reducing environment of a cell's cytosol. The matrix is being derived using the same fundamental principles as the widely used Blocks Substitution Matrix (BLOSUM) family.\n\nThe score ($S_{ij}$) for substituting amino acid $i$ with amino acid $j$ in such a matrix is determined by the log-odds ratio of observed versus expected frequencies. The score is calculated using the following formula:\n$$S_{ij} = \\frac{2}{\\ln(2)} \\ln\\left(\\frac{p_{ij}}{q_i q_j}\\right)$$\nHere, $p_{ij}$ represents the observed frequency of the amino acid pair $(i, j)$ appearing aligned in the source protein blocks, while $q_i$ and $q_j$ are the individual background frequencies of the amino acids $i$ and $j$ in the dataset. The scaling factor $\\frac{2}{\\ln(2)}$ is used to express the final score in units of \"half-bits.\"\n\nYou are tasked with calculating the self-alignment score for the amino acid Cysteine (Cys) in this new CytoBLOSUM matrix. Cysteine is biochemically notable for its ability to form structural disulfide bonds, a process that occurs predominantly in oxidizing environments outside the cytosol. The frequency analysis of the team's cytosolic protein alignment data has yielded the following values for Cysteine:\n- Background frequency of Cys, $q_{C,cyto} = 0.018$\n- Observed pair frequency of Cys-Cys, $p_{CC,cyto} = 0.0010$\n\nUsing the provided formula and data, calculate the Cys-Cys diagonal score ($S_{CC}$) for the CytoBLOSUM matrix. Round your final answer to three significant figures.",
            "solution": "The substitution score is defined as the scaled log-odds ratio:\n$$S_{ij} = \\frac{2}{\\ln(2)} \\ln\\left(\\frac{p_{ij}}{q_{i} q_{j}}\\right).$$\nFor the Cys-Cys diagonal entry, set $i=j=C$, giving\n$$S_{CC} = \\frac{2}{\\ln(2)} \\ln\\left(\\frac{p_{CC}}{q_{C}^{2}}\\right).$$\nInsert the given frequencies $p_{CC} = 0.0010$ and $q_{C} = 0.018$:\n$$q_{C}^{2} = (0.018)^{2} = 0.000324,$$\n$$\\frac{p_{CC}}{q_{C}^{2}} = \\frac{0.0010}{0.000324} = \\frac{1000}{324} = \\frac{250}{81}.$$\nTherefore,\n$$S_{CC} = \\frac{2}{\\ln(2)} \\ln\\left(\\frac{250}{81}\\right).$$\nFor a numerical value,\n$$\\ln\\left(\\frac{250}{81}\\right) \\approx \\ln(3.086419753) \\approx 1.127011775,$$\n$$\\frac{2}{\\ln 2} \\approx 2.885390082,$$\nso\n$$S_{CC} \\approx 2.885390082 \\times 1.127011775 \\approx 3.251868564.$$\nRounded to three significant figures, the Cys-Cys score is $3.25$ (in half-bits).",
            "answer": "$$\\boxed{3.25}$$"
        },
        {
            "introduction": "Beyond individual substitution preferences, a well-designed substitution matrix must possess specific statistical properties to be effective. This advanced practice explores how a matrix can be calibrated to ensure that high scores are statistically significant. By adjusting scores to achieve a zero expected score for random alignments , you will engage with the principles that underpin the statistical rigor of modern sequence comparison algorithms.",
            "id": "2432249",
            "problem": "A protein alignment scoring scheme over a reduced amino acid alphabet consisting of aspartate (D), glutamate (E), tryptophan (W), and glycine (G) uses a symmetric substitution matrix of natural-log odds scores (nats). The rows and columns are ordered as D, E, W, G, and the baseline matrix is\n$$\nS \\;=\\;\n\\begin{bmatrix}\n0.6  0.3  -0.7  -0.2 \\\\\n0.3  0.6  -0.8  -0.3 \\\\\n-0.7  -0.8  1.2  -1.5 \\\\\n-0.2  -0.3  -1.5  0.2\n\\end{bmatrix}.\n$$\nIn the sequence population, the background probabilities for independent draws of residues are $\\pi_{\\mathrm{D}}=0.25$, $\\pi_{\\mathrm{E}}=0.25$, $\\pi_{\\mathrm{W}}=0.10$, and $\\pi_{\\mathrm{G}}=0.40$, and only these four residues appear.\n\nA modified matrix $S'$ is constructed to reward a “conservative” substitution between D and E and to penalize a “radical” substitution between W and G, by setting\n- $S'_{\\mathrm{DE}} = S_{\\mathrm{DE}} + \\beta$ and $S'_{\\mathrm{ED}} = S_{\\mathrm{ED}} + \\beta$,\n- $S'_{\\mathrm{WG}} = S_{\\mathrm{WG}} - \\gamma$ and $S'_{\\mathrm{GW}} = S_{\\mathrm{GW}} - \\gamma$,\nwith all other entries unchanged from $S$. Here $\\beta$ is an unknown bonus (in nats) and $\\gamma$ is a fixed penalty magnitude (in nats). Take $\\gamma = 0.3$.\n\nDetermine the value of $\\beta$ that makes the expected substitution score for a random pair of independently drawn residues (according to the given background probabilities) exactly zero when scored with $S'$. Report a single real number. No rounding is required.",
            "solution": "The problem requires the determination of a parameter $\\beta$ such that the expected substitution score for a random pair of independently drawn amino acids is zero, when scored with a modified substitution matrix $S'$.\n\nLet the set of amino acids be $\\mathcal{A} = \\{\\text{D, E, W, G}\\}$. The background probability of drawing an amino acid $i \\in \\mathcal{A}$ is denoted by $\\pi_i$. The score for substituting amino acid $i$ with $j$ is given by the matrix entry $S'_{ij}$. For a pair of residues $(i, j)$ drawn independently from the background distribution, the probability of observing this pair is $\\pi_i \\pi_j$.\n\nThe expected substitution score, $E[S']$, is the sum of scores for all possible pairs, weighted by their probabilities:\n$$\nE[S'] = \\sum_{i \\in \\mathcal{A}} \\sum_{j \\in \\mathcal{A}} \\pi_i \\pi_j S'_{ij}\n$$\nThe problem states that this expected score must be zero.\n\nThe modified matrix $S'$ is related to the baseline matrix $S$ by $S' = S + \\Delta S$, where $\\Delta S = S' - S$ is the matrix of changes. Due to the linearity of the expectation, we can write:\n$$\nE[S'] = E[S] + E[\\Delta S]\n$$\nWe are required to find $\\beta$ such that $E[S'] = 0$, which implies $E[S] + E[\\Delta S] = 0$. We will calculate each term separately.\n\nFirst, we determine the expected value of the changes, $E[\\Delta S]$. The matrix $\\Delta S$ is defined by the modifications:\n$S'_{\\mathrm{DE}} = S_{\\mathrm{DE}} + \\beta$ and $S'_{\\mathrm{ED}} = S_{\\mathrm{ED}} + \\beta$\n$S'_{\\mathrm{WG}} = S_{\\mathrm{WG}} - \\gamma$ and $S'_{\\mathrm{GW}} = S_{\\mathrm{GW}} - \\gamma$\nAll other entries of $\\Delta S$ are zero. Thus, the $\\Delta S$ matrix is:\n$$\n\\Delta S =\n\\begin{pmatrix}\n0  \\beta  0  0 \\\\\n\\beta  0  0  0 \\\\\n0  0  0  -\\gamma \\\\\n0  0  -\\gamma  0\n\\end{pmatrix}\n$$\nThe expected value $E[\\Delta S]$ is:\n$$\nE[\\Delta S] = \\sum_{i \\in \\mathcal{A}} \\sum_{j \\in \\mathcal{A}} \\pi_i \\pi_j (\\Delta S)_{ij}\n$$\nSince only four off-diagonal elements are non-zero and the matrix is symmetric, this simplifies to:\n$$\nE[\\Delta S] = 2\\pi_{\\mathrm{D}}\\pi_{\\mathrm{E}}(\\Delta S)_{\\mathrm{DE}} + 2\\pi_{\\mathrm{W}}\\pi_{\\mathrm{G}}(\\Delta S)_{\\mathrm{WG}} = 2\\pi_{\\mathrm{D}}\\pi_{\\mathrm{E}}\\beta - 2\\pi_{\\mathrm{W}}\\pi_{\\mathrm{G}}\\gamma\n$$\nSubstituting the given probabilities $\\pi_{\\mathrm{D}}=0.25$, $\\pi_{\\mathrm{E}}=0.25$, $\\pi_{\\mathrm{W}}=0.10$, $\\pi_{\\mathrm{G}}=0.40$ and the penalty $\\gamma=0.3$:\n$$\nE[\\Delta S] = 2(0.25)(0.25)\\beta - 2(0.10)(0.40)(0.3) = 0.125\\beta - 0.08(0.3) = 0.125\\beta - 0.024\n$$\n\nNext, we calculate the expected score for the baseline matrix, $E[S]$. Given the symmetry of $S$, we can write:\n$$\nE[S] = \\sum_{i \\in \\mathcal{A}} \\pi_i^2 S_{ii} + \\sum_{ij} 2\\pi_i\\pi_j S_{ij}\n$$\nThe contribution from the diagonal elements is:\n$$\nT_{\\text{diag}} = \\pi_{\\mathrm{D}}^2 S_{\\mathrm{DD}} + \\pi_{\\mathrm{E}}^2 S_{\\mathrm{EE}} + \\pi_{\\mathrm{W}}^2 S_{\\mathrm{WW}} + \\pi_{\\mathrm{G}}^2 S_{\\mathrm{GG}}\n$$\n$$\nT_{\\text{diag}} = (0.25)^2(0.6) + (0.25)^2(0.6) + (0.10)^2(1.2) + (0.40)^2(0.2)\n$$\n$$\nT_{\\text{diag}} = (0.0625)(0.6) + (0.0625)(0.6) + (0.01)(1.2) + (0.16)(0.2) = 0.0375 + 0.0375 + 0.012 + 0.032 = 0.119\n$$\nThe contribution from the off-diagonal elements is:\n$$\nT_{\\text{off-diag}} = 2\\pi_{\\mathrm{D}}\\pi_{\\mathrm{E}}S_{\\mathrm{DE}} + 2\\pi_{\\mathrm{D}}\\pi_{\\mathrm{W}}S_{\\mathrm{DW}} + 2\\pi_{\\mathrm{D}}\\pi_{\\mathrm{G}}S_{\\mathrm{DG}} + 2\\pi_{\\mathrm{E}}\\pi_{\\mathrm{W}}S_{\\mathrm{EW}} + 2\\pi_{\\mathrm{E}}\\pi_{\\mathrm{G}}S_{\\mathrm{EG}} + 2\\pi_{\\mathrm{W}}\\pi_{\\mathrm{G}}S_{\\mathrm{WG}}\n$$\n$$\nT_{\\text{off-diag}} = 2(0.25)(0.25)(0.3) + 2(0.25)(0.10)(-0.7) + 2(0.25)(0.40)(-0.2) + 2(0.25)(0.10)(-0.8) + 2(0.25)(0.40)(-0.3) + 2(0.10)(0.40)(-1.5)\n$$\n$$\nT_{\\text{off-diag}} = (0.125)(0.3) + (0.05)(-0.7) + (0.2)(-0.2) + (0.05)(-0.8) + (0.2)(-0.3) + (0.08)(-1.5)\n$$\n$$\nT_{\\text{off-diag}} = 0.0375 - 0.035 - 0.04 - 0.04 - 0.06 - 0.12 = -0.2575\n$$\nThe total expected score for the baseline matrix is:\n$$\nE[S] = T_{\\text{diag}} + T_{\\text{off-diag}} = 0.119 - 0.2575 = -0.1385\n$$\n\nNow, we impose the condition that the total expected score with the modified matrix is zero:\n$$\nE[S'] = E[S] + E[\\Delta S] = 0\n$$\nSubstituting the calculated values:\n$$\n-0.1385 + (0.125\\beta - 0.024) = 0\n$$\n$$\n0.125\\beta - (0.1385 + 0.024) = 0\n$$\n$$\n0.125\\beta - 0.1625 = 0\n$$\nSolving for $\\beta$:\n$$\n0.125\\beta = 0.1625\n$$\n$$\n\\beta = \\frac{0.1625}{0.125} = \\frac{1625}{1250} = \\frac{325}{250} = \\frac{65}{50} = \\frac{13}{10} = 1.3\n$$\nThe required value of the bonus $\\beta$ is $1.3$ nats.",
            "answer": "$$\\boxed{1.3}$$"
        }
    ]
}