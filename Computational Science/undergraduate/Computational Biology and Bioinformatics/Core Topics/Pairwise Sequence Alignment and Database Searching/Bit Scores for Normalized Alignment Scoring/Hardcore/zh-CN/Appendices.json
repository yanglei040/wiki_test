{
    "hands_on_practices": [
        {
            "introduction": "如果我们简单地将一个像 BLOSUM62 这样的打分矩阵中的所有数值都加倍，会发生什么呢？这个练习将揭示标准化的基本原理。我们将看到原始分和统计参数如何变化，但作为衡量显著性的真正标准的比特分却保持不变，这突显了为何比特分对于比较使用不同系统评分的序列联配至关重要。",
            "id": "2375719",
            "problem": "考虑两条长度为 $m$ 和 $n$ 的独立同分布 (i.i.d.) 随机蛋白质序列之间的局部、无空位比对。对于残基 $a$ 和 $b$，其背景氨基酸频率分别为 $\\{p_{a}\\}$ 和 $\\{q_{b}\\}$。设比对残基 $a$ 和 $b$ 的替换得分为 $s(a,b)$，取自 BLOSUM62 矩阵。对于一个特定的固定比对，其原始比对得分是所有比对上的残基对的替换得分之和，记为 $S$。在 Karlin–Altschul 局部比对框架下，得分统计量由参数 $\\lambda$ 和 $K$ 表征，它们满足以下条件：尺度参数 $\\lambda$ 是方程\n$$\n\\sum_{a,b} p_{a} q_{b} \\exp\\!\\big(\\lambda\\, s(a,b)\\big) \\;=\\; 1,\n$$\n的唯一正解，并且，得分至少为 $x$ 的高分片段对 (HSPs) 的期望数量 $E(x)$ 遵循渐近形式\n$$\nE(x) \\;\\approx\\; K\\, m n\\, \\exp(-\\lambda x).\n$$\n与原始得分 $S$ 相关联的比特得分 $S'$ 定义为\n$$\nS' \\;=\\; \\frac{\\lambda S - \\ln K}{\\ln 2}.\n$$\n\n现在，通过将 BLOSUM62 矩阵的每个条目乘以一个正数 $c=2$ 来构建一个新的评分系统，同时保持背景频率 $\\{p_{a}\\}$ 和 $\\{q_{b}\\}$ 不变，并且仍然考虑局部、无空位比对。将新的原始得分、$\\lambda$ 参数和 $K$ 参数分别记为 $S_{\\mathrm{new}}$、$\\lambda_{\\mathrm{new}}$ 和 $K_{\\mathrm{new}}$，并将新的比特得分记为 $S'_{\\mathrm{new}}$。\n\n通过计算以下四元组，确定这种缩放对得分和统计参数的影响：\n$$\n\\left(\\frac{S_{\\mathrm{new}}}{S},\\, S'_{\\mathrm{new}} - S',\\, \\frac{\\lambda_{\\mathrm{new}}}{\\lambda},\\, \\frac{K_{\\mathrm{new}}}{K}\\right).\n$$\n\n以单行矩阵的形式提供最终答案。不需要四舍五入，也不需要单位。",
            "solution": "首先，考虑新的原始得分 $S_{\\mathrm{new}}$。根据定义，原始得分是给定比对中残基对的替换得分之和。对于相同的固定比对，新的原始得分 $S_{\\mathrm{new}}$ 为：\n$$\nS_{\\mathrm{new}} = \\sum_{\\text{aligned pairs}} s_{\\mathrm{new}}(a,b) = \\sum_{\\text{aligned pairs}} c \\cdot s(a,b) = c \\left( \\sum_{\\text{aligned pairs}} s(a,b) \\right) = cS\n$$\n因此，新的原始得分与旧的原始得分之比为：\n$$\n\\frac{S_{\\mathrm{new}}}{S} = c = 2\n$$\n\n接下来，我们确定新的尺度参数 $\\lambda_{\\mathrm{new}}$。它是以下方程的唯一正解：\n$$\n\\sum_{a,b} p_{a} q_{b} \\exp(\\lambda_{\\mathrm{new}} s_{\\mathrm{new}}(a,b)) = 1\n$$\n将 $s_{\\mathrm{new}}(a,b) = c \\cdot s(a,b)$ 代入此方程，得到：\n$$\n\\sum_{a,b} p_{a} q_{b} \\exp(\\lambda_{\\mathrm{new}} (c \\cdot s(a,b))) = \\sum_{a,b} p_{a} q_{b} \\exp((c\\lambda_{\\mathrm{new}}) s(a,b)) = 1\n$$\n原始参数 $\\lambda$ 被定义为 $\\sum_{a,b} p_{a} q_{b} \\exp(\\lambda s(a,b)) = 1$ 的唯一正解。通过比较这两个方程并利用解的唯一性，我们可以令指数中 $s(a,b)$ 的系数相等：\n$$\n\\lambda = c\\lambda_{\\mathrm{new}} \\implies \\lambda_{\\mathrm{new}} = \\frac{\\lambda}{c}\n$$\n新的 $\\lambda$ 参数与旧的 $\\lambda$ 参数之比为：\n$$\n\\frac{\\lambda_{\\mathrm{new}}}{\\lambda} = \\frac{1}{c} = \\frac{1}{2}\n$$\n\n现在我们考虑比特得分 $S'$ 和 $S'_{\\mathrm{new}}$，以及统计参数 $K$ 和 $K_{\\mathrm{new}}$。比特得分的目的是提供一个标准化的比对统计显著性度量，该度量独立于底层评分矩阵的任意尺度。给定比对的显著性是一个内在属性，不应仅仅因为评分矩阵乘以一个常数因子而改变。因此，特定比对的比特得分在此缩放变换下必须是不变的。这是归一化方案的一个基本原则。因此，我们必须有：\n$$\nS'_{\\mathrm{new}} = S'\n$$\n由此，可以立即确定元组中的第二个元素：\n$$\nS'_{\\mathrm{new}} - S' = 0\n$$\n\n最后，我们使用比特得分的不变性来确定 $K_{\\mathrm{new}}$ 和 $K$ 之间的关系。比特得分的定义是：\n$$\nS' = \\frac{\\lambda S - \\ln K}{\\ln 2}\n$$\n$$\nS'_{\\mathrm{new}} = \\frac{\\lambda_{\\mathrm{new}} S_{\\mathrm{new}} - \\ln K_{\\mathrm{new}}}{\\ln 2}\n$$\n因为 $S'_{\\mathrm{new}} = S'$，我们可以令这两个表达式相等：\n$$\n\\frac{\\lambda S - \\ln K}{\\ln 2} = \\frac{\\lambda_{\\mathrm{new}} S_{\\mathrm{new}} - \\ln K_{\\mathrm{new}}}{\\ln 2}\n$$\n$$\n\\lambda S - \\ln K = \\lambda_{\\mathrm{new}} S_{\\mathrm{new}} - \\ln K_{\\mathrm{new}}\n$$\n我们已经确定 $S_{\\mathrm{new}} = cS$ 且 $\\lambda_{\\mathrm{new}} = \\lambda/c$。将它们代入方程的右侧：\n$$\n\\lambda_{\\mathrm{new}} S_{\\mathrm{new}} = \\left(\\frac{\\lambda}{c}\\right) (cS) = \\lambda S\n$$\n乘积 $\\lambda S$ 本身在缩放变换下是不变的。将此结果代回等式中：\n$$\n\\lambda S - \\ln K = \\lambda S - \\ln K_{\\mathrm{new}}\n$$\n这可以简化为：\n$$\n-\\ln K = -\\ln K_{\\mathrm{new}} \\implies \\ln K = \\ln K_{\\mathrm{new}}\n$$\n对两边取指数，得到：\n$$\nK = K_{\\mathrm{new}}\n$$\n因此，参数 $K$ 在此缩放变换下也是不变的。其比值为：\n$$\n\\frac{K_{\\mathrm{new}}}{K} = 1\n$$\n\n总之，所要求的四个量是：\n1.  $\\frac{S_{\\mathrm{new}}}{S} = 2$\n2.  $S'_{\\mathrm{new}} - S' = 0$\n3.  $\\frac{\\lambda_{\\mathrm{new}}}{\\lambda} = \\frac{1}{2}$\n4.  $\\frac{K_{\\mathrm{new}}}{K} = 1$\n\n将这些组合成指定的四元组，即可得到最终答案。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} 2 & 0 & \\frac{1}{2} & 1 \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "直觉可能会告诉我们，更高的原始联配分数总是意味着更显著的结果。本练习通过一个实例挑战了这一假设，其中一个评分系统为一个联配给出了更高的原始分，但另一个系统虽然给出的原始分较低，其比特分却更高，也即统计上更显著。通过这个练习，你将牢固地理解由参数 $\\lambda$ 和 $K$ 捕捉的统计背景对于解释联配分数的至关重要性。",
            "id": "2375737",
            "problem": "考虑以下两个脱氧核糖核酸 (DNA) 序列的固定成对序列比对（连字符表示主体序列中的一个空格字符）：\n\n查询序列： A C G T A G C T A A C\n\n主体序列： A C G T A - C T G A C\n\n使用以下两种不同的计分系统进行局部比对计分。在这两种系统中，原始比对分数（表示为 $S$）是所有比对列的碱基对替换分数与每个空格字符的指定线性罚分之和。线性罚分为 $-d$ 意味着每个空格字符对 $S$ 的贡献为 $-d$。\n\n- 计分系统A：\n  - 替换矩阵：匹配得 $+5$ 分，错配得 $-4$ 分（适用于所有核苷酸对）。\n  - 线性罚分：每个空格字符罚 $-3$ 分。\n  - Karlin–Altschul 参数：$\\lambda_{A} = 0.18$ 和 $K_{A} = 0.40$。\n\n- 计分系统B：\n  - 替换矩阵：匹配得 $+3$ 分，错配得 $-1$ 分（适用于所有核苷酸对）。\n  - 线性罚分：每个空格字符罚 $-1$ 分。\n  - Karlin–Altschul 参数：$\\lambda_{B} = 0.35$ 和 $K_{B} = 0.10$。\n\n根据定义，在给定的计分系统（参数为 $\\lambda$ 和 $K$）下，局部比对的比特分数 $S'$ 为\n$$\nS' \\;=\\; \\frac{\\lambda S - \\ln K}{\\ln 2}.\n$$\n\n分别计算在计分系统A和计分系统B下该比对的原始分数 $S_{A}$ 和 $S_{B}$，然后计算相应的比特分数 $S'_{A}$ 和 $S'_{B}$。最后，报告 $S'_{B} - S'_{A}$ 的值。将最终答案四舍五入到四位有效数字。最终答案中不要包含任何单位。",
            "solution": "第一步是分析给定的比对，以确定匹配、错配和空格的数量。所提供的比对如下：\n查询序列：   $A \\ C \\ G \\ T \\ A \\ G \\ C \\ T \\ A \\ A \\ C$\n主体序列： $A \\ C \\ G \\ T \\ A \\ - \\ C \\ T \\ G \\ A \\ C$\n\n逐列检查这 $11$ 个位置，得出：\n- 匹配数 ($N_{m}$): $9$ (在位置 $1, 2, 3, 4, 5, 7, 8, 10, 11$)\n- 错配数 ($N_{mm}$): $1$ (在位置 $9$，查询序列的核苷酸是 $A$，主体序列的核苷酸是 $G$)\n- 空格数 ($N_{g}$): $1$ (在位置 $6$，一个空格字符 `'-'` 与核苷酸 $G$ 对齐)\n\n接下来，我们为每个计分系统计算原始比对分数 $S$。原始分数定义为替换分数和空格罚分之和。对于一个匹配分数为 $s_{m}$，错配分数为 $s_{mm}$，线性罚分为 $-d$ 的系统，此比对的原始分数 $S$ 由下式给出：\n$$S = N_{m} \\cdot s_{m} + N_{mm} \\cdot s_{mm} + N_{g} \\cdot (-d)$$\n\n对于计分系统A，参数为：匹配的替换分数为 $s_{m,A} = +5$，错配的替换分数为 $s_{mm,A} = -4$，每个空格的线性罚分为 $-3$。\n原始分数 $S_{A}$ 为：\n$$S_A = (9)(5) + (1)(-4) + (1)(-3) = 45 - 4 - 3 = 38$$\n\n对于计分系统B，参数为：匹配的替换分数为 $s_{m,B} = +3$，错配的替换分数为 $s_{mm,B} = -1$，每个空格的线性罚分为 $-1$。\n原始分数 $S_B$ 为：\n$$S_B = (9)(3) + (1)(-1) + (1)(-1) = 27 - 1 - 1 = 25$$\n\n现在，我们使用给定的公式计算比特分数 $S'_{A}$ 和 $S'_{B}$。对于原始分数为 $S$、Karlin-Altschul 参数为 $\\lambda$ 和 $K$ 的比特分数 $S'$，其公式为：\n$$S' = \\frac{\\lambda S - \\ln K}{\\ln 2}$$\n\n对于计分系统A，参数为 $\\lambda_{A} = 0.18$ 和 $K_{A} = 0.40$。原始分数为 $S_A = 38$。\n比特分数 $S'_{A}$ 为：\n$$S'_{A} = \\frac{\\lambda_{A} S_{A} - \\ln K_{A}}{\\ln 2} = \\frac{(0.18)(38) - \\ln(0.40)}{\\ln 2} = \\frac{6.84 - (-0.9162907...)}{\\ln(2)} = \\frac{7.7562907...}{0.6931472...} \\approx 11.18990$$\n\n对于计分系统B，参数为 $\\lambda_{B} = 0.35$ 和 $K_{B} = 0.10$。原始分数为 $S_B = 25$。\n比特分数 $S'_{B}$ 为：\n$$S'_{B} = \\frac{\\lambda_{B} S_{B} - \\ln K_{B}}{\\ln 2} = \\frac{(0.35)(25) - \\ln(0.10)}{\\ln 2} = \\frac{8.75 - (-2.302585...)}{\\ln(2)} = \\frac{11.052585...}{0.6931472...} \\approx 15.94551$$\n\n最后的任务是计算差值 $S'_{B} - S'_{A}$。\n$$S'_{B} - S'_{A} \\approx 15.94551 - 11.18990 = 4.75561$$\n或者，我们可以直接计算表达式：\n$$S'_{B} - S'_{A} = \\frac{(\\lambda_B S_B - \\ln K_B) - (\\lambda_A S_A - \\ln K_A)}{\\ln 2}$$\n$$S'_{B} - S'_{A} = \\frac{( (0.35)(25) - (0.18)(38) ) - (\\ln(0.10) - \\ln(0.40))}{\\ln 2}$$\n$$S'_{B} - S'_{A} = \\frac{(8.75 - 6.84) - \\ln\\left(\\frac{0.10}{0.40}\\right)}{\\ln 2}$$\n$$S'_{B} - S'_{A} = \\frac{1.91 - \\ln(0.25)}{\\ln 2} = \\frac{1.91 - (-1.386294...)}{0.693147...} = \\frac{3.296294...}{0.693147...} \\approx 4.7556155$$\n\n题目要求将最终答案四舍五入到四位有效数字。计算出的值约为 $4.7556155$。前四位有效数字是 $4$、$7$、$5$ 和 $5$。第五位有效数字是 $6$，大于或等于 $5$，所以我们将第四位有效数字向上舍入。\n结果是 $4.756$。",
            "answer": "$$\\boxed{4.756}$$"
        },
        {
            "introduction": "比特分提供了一个标准化的显著性度量，但一个联配需要达到多高的原始分才开始具有统计意义呢？在这个问题中，我们将运用 Karlin-Altschul 框架来确定能够产生正比特分（$S' > 0$）的最小整数原始分 $S$。这个计算练习在联配算法的原始输出与其统计学解释之间建立了切实的联系。",
            "id": "2375728",
            "problem": "考虑两条独立同分布的核苷酸序列之间的无空位局部比对，这两条序列具有相同的组成，其中每个核苷酸出现的概率为 $0.25$。计分系统为匹配分配 $+1$ 分，为错配分配 $-3$ 分，原始比对分数 $S$ 为整数。根据 Karlin–Altschul 极值理论，原始分数至少为 $S$ 的高分片段对 (HSP) 的期望数 $E(S)$ 由以下模型给出\n$$E(S) \\;=\\; K \\, m \\, n \\, \\exp(-\\lambda S),$$\n其中 $m$ 和 $n$ 是序列长度，$\\lambda$ 和 $K$ 是仅取决于计分系统和背景字符频率的尺度参数。参数 $\\lambda$ 由以下方程隐式定义\n$$\\sum_{i,j} p_i \\, q_j \\, \\exp\\!\\big(\\lambda \\, s_{ij}\\big) \\;=\\; 1,$$\n其中 $p_i$ 和 $q_j$ 是两条序列中字符的背景频率，$s_{ij}$ 是替换分数。比特分数 $S'$ 由以下恒等式定义\n$$E(S) \\;=\\; m \\, n \\, 2^{-S'}.$$\n对于此具有均匀背景的计分系统，参数 $K$ 已通过经验确定为 $K = 0.711$。\n\n仅使用上述定义和数据，确定使比特分数严格为正（即 $S' > 0$）的最小整数原始分数 $S_{\\min}$。请以单个整数形式提供最终答案，不带单位。",
            "solution": "问题要求找到最小的整数原始分数 $S_{\\min}$，使得对应的比特分数 $S'$ 严格为正。\n\n为找到原始分数 $S$ 和比特分数 $S'$ 之间的关系，我们将给定的两个 HSP 期望数 $E(S)$ 的表达式相等：\n$$K \\, m \\, n \\, \\exp(-\\lambda S) = m \\, n \\, 2^{-S'}$$\n假设序列长度 $m$ 和 $n$ 为正，我们可以将两边同除以 $m \\, n$：\n$$K \\, \\exp(-\\lambda S) = 2^{-S'}$$\n问题要求比特分数 $S'$ 严格为正，即 $S' > 0$。\n如果 $S' > 0$，那么 $-S' < 0$，因此 $2^{-S'} < 2^0 = 1$。\n将此代入我们的方程，条件 $S' > 0$ 等价于：\n$$K \\, \\exp(-\\lambda S) < 1$$\n我们可以重新整理这个不等式以求解 $S$。\n$$\\exp(-\\lambda S) < \\frac{1}{K}$$\n对两边取自然对数：\n$$-\\lambda S < \\ln\\left(\\frac{1}{K}\\right)$$\n$$-\\lambda S < -\\ln(K)$$\n两边乘以 $-1$ 会反转不等号：\n$$\\lambda S > \\ln(K)$$\n要继续进行，我们必须确定参数 $\\lambda$ 和 $\\ln(K)$ 的符号。\n参数 $K$ 已知为 $K = 0.711$。由于 $0 < K < 1$，其自然对数 $\\ln(K)$ 为负。\n参数 $\\lambda$ 是方程 $\\sum_{i,j} p_i \\, q_j \\, \\exp(\\lambda \\, s_{ij}) = 1$ 的非平凡正解。\n我们为给定系统构建这个方程。字母表是核苷酸 $\\{A, C, G, T\\}$。有 $4 \\times 4 = 16$ 种可能的字母对。所有 $i,j$ 的背景频率均为 $p_i = q_j = 0.25$。因此，对于任何一对，$p_i q_j = (0.25)^2 = 1/16$。\n该求和包含 $4$ 个匹配项（其中 $s_{ij} = +1$）和 $12$ 个错配项（其中 $s_{ij} = -3$）。\n$$\\sum_{i,j} \\frac{1}{16} \\exp(\\lambda s_{ij}) = 1$$\n$$4 \\times \\frac{1}{16} \\exp(\\lambda \\cdot 1) + 12 \\times \\frac{1}{16} \\exp(\\lambda \\cdot (-3)) = 1$$\n$$\\frac{1}{4} \\exp(\\lambda) + \\frac{3}{4} \\exp(-3\\lambda) = 1$$\n两边乘以 $4$，我们得到：\n$$\\exp(\\lambda) + 3\\exp(-3\\lambda) = 4$$\n为了使 Karlin-Altschul 统计适用，随机比对的期望分数必须为负，这确保了 $\\lambda$ 存在唯一的正解。期望分数为 $E[\\text{score}] = P(\\text{match})s_{\\text{match}} + P(\\text{mismatch})s_{\\text{mismatch}} = (\\frac{1}{4})(+1) + (\\frac{3}{4})(-3) = \\frac{1}{4} - \\frac{9}{4} = -2$。由于期望分数为负，存在唯一的 $\\lambda > 0$。\n\n因为 $\\lambda > 0$，我们可以用 $\\lambda$ 除不等式 $\\lambda S > \\ln(K)$ 的两边而不改变其方向：\n$$S > \\frac{\\ln(K)}{\\lambda}$$\n由于 $\\ln(K) < 0$ 且 $\\lambda > 0$，比率 $\\frac{\\ln(K)}{\\lambda}$ 是一个负数。我们需要找到满足此条件的最小整数 $S$。\n\n我们来测试 $S$ 的整数值，从 $S=0$ 开始。\n对于 $S=0$，不等式 $S' > 0$ 变为 $K \\exp(-\\lambda \\cdot 0) < 1$，简化为 $K < 1$。\n已知 $K = 0.711$，条件 $0.711 < 1$ 是成立的。因此，对于原始分数 $S=0$，比特分数是严格为正的。\n\n现在我们必须检查是否有更小的整数，即 $S < 0$，也能满足该条件。我们来测试 $S=-1$。\n对于 $S=-1$， $S' > 0$ 的条件变为 $K \\exp(-\\lambda \\cdot (-1)) < 1$，即 $K \\exp(\\lambda) < 1$。\n这等价于 $\\exp(\\lambda) < \\frac{1}{K}$。\n我们来计算 $\\frac{1}{K} = \\frac{1}{0.711} \\approx 1.4065$。\n所以条件是 $\\exp(\\lambda) < 1.4065$。\n\n为了验证这一点，我们必须估计 $\\exp(\\lambda)$。令 $x = \\exp(\\lambda)$。关于 $\\lambda$ 的方程变为：\n$$x + 3x^{-3} = 4$$\n$$x^4 + 3 = 4x^3 \\implies x^4 - 4x^3 + 3 = 0$$\n我们可以观察到 $x=1$ 是一个根（$1-4+3=0$），这对应于平凡解 $\\lambda = 0$。通过多项式除法因式分解出 $(x-1)$ 得到：\n$$(x-1)(x^3 - 3x^2 - 3x - 3) = 0$$\n具有物理意义的解对应于 $g(x) = x^3 - 3x^2 - 3x - 3 = 0$ 在 $x > 1$ 时的根。\n我们可以在不显式求解三次方程的情况下定位这个根。让我们在整数点上评估 $g(x)$：\n$g(3) = 3^3 - 3(3^2) - 3(3) - 3 = 27 - 27 - 9 - 3 = -12$。\n$g(4) = 4^3 - 3(4^2) - 3(4) - 3 = 64 - 48 - 12 - 3 = 1$。\n因为 $g(3) < 0$ 且 $g(4) > 0$，并且 $g(x)$ 是连续的，所以根 $x$ 必定位于区间 $(3, 4)$ 内。\n因此，$\\exp(\\lambda) = x \\in (3, 4)$。\n\n现在我们回到 $S=-1$ 的条件：$\\exp(\\lambda) < 1.4065$。\n既然我们发现 $\\exp(\\lambda) > 3$，那么条件 $\\exp(\\lambda) < 1.4065$ 是不成立的。\n因此，对于 $S=-1$，比特分数 $S'$ 不是正数。\n联系 $S$ 和 $S'$ 的函数是 $S' = \\frac{\\lambda S - \\ln(K)}{\\ln(2)}$。这是一个关于 $S$ 的线性函数，其斜率 $\\frac{\\lambda}{\\ln(2)}$ 为正。这意味着 $S'(S)$ 是 $S$ 的单调递增函数。\n由于 $S'(-1) \\le 0$，因此对于任何整数 $S_{int} \\le -1$，都有 $S'(S_{int}) \\le S'(-1) \\le 0$。\n因此，没有负整数原始分数可以产生严格为正的比特分数。\n\n我们已经证明了 $S=0$ 会导致 $S' > 0$，而任何整数 $S < 0$ 会导致 $S' \\le 0$。\n因此，使 $S' > 0$ 的最小整数原始分数 $S_{\\min}$ 是 $0$。",
            "answer": "$$\\boxed{0}$$"
        }
    ]
}