{
    "hands_on_practices": [
        {
            "introduction": "密码子适应指数（CAI）是一个广泛使用的度量标准，用于量化一个基因的密码子使用模式与高表达基因参考集的匹配程度。这个实践问题  提供了一个直接的计算练习，旨在巩固您对 CAI 公式的理解，要求您为一个包含模糊核苷酸的序列确定 CAI 值的可能范围。通过这个练习，您将具体地感受到单个密码子的选择如何共同决定一个基因的高表达潜力。",
            "id": "2381997",
            "problem": "我们使用密码子适应指数 (CAI) 来分析一个固定阅读框中某个基因组片段的密码子使用偏好。根据定义，对于一个在固定阅读框中长度为 $L$ 个密码子的编码序列，其 CAI 是其密码子相对适应性权重 $w_{c}$ 的几何平均值：\n$$\\mathrm{CAI}=\\left(\\prod_{i=1}^{L} w_{c_i}\\right)^{1/L}.$$\n每个 $w_{c}$ 是一个在区间 $(0,1]$ 内的无量纲相对适应性权重，它是相对于一个固定的参考集定义的。考虑 DNA 序列（阅读框从第一个碱基开始）：\nATGGCNCGNTTNCCN\n其中模糊字符 $\\mathrm{N}$ 表示 $\\{\\mathrm{A},\\mathrm{C},\\mathrm{G},\\mathrm{T}\\}$ 中的任意一个核苷酸，且在每个位置上是独立的。该阅读框将此序列划分为 $L=5$ 个密码子：$\\mathrm{ATG}$、$\\mathrm{GCN}$、$\\mathrm{CGN}$、$\\mathrm{TTN}$、$\\mathrm{CCN}$。根据构造，在此阅读框中，由这些模糊位置产生的所有可能密码子都不是终止密码子。\n\n在此阅读框中可能出现的所有密码子的相对适应性权重 $w_{c}$ 如下：\n- $w(\\mathrm{ATG})=1$。\n- 对于 $\\mathrm{GCN}$：$w(\\mathrm{GCA})=0.2$，$w(\\mathrm{GCC})=1$，$w(\\mathrm{GCG})=0.7$，$w(\\mathrm{GCT})=0.4$。\n- 对于 $\\mathrm{CGN}$：$w(\\mathrm{CGA})=0.1$，$w(\\mathrm{CGC})=1$，$w(\\mathrm{CGG})=0.8$，$w(\\mathrm{CGT})=0.6$。\n- 对于 $\\mathrm{TTN}$：$w(\\mathrm{TTA})=0.05$，$w(\\mathrm{TTC})=1$，$w(\\mathrm{TTG})=0.1$，$w(\\mathrm{TTT})=0.5$。\n- 对于 $\\mathrm{CCN}$：$w(\\mathrm{CCA})=0.3$，$w(\\mathrm{CCC})=1$，$w(\\mathrm{CCG})=0.9$，$w(\\mathrm{CCT})=0.6$。\n\n在遵循固定阅读框的情况下，对于 $\\mathrm{N}$ 的所有可能的核苷酸分配，确定此序列可能的最小和最大 CAI 值。以有序对（最小值，最大值）的形式报告你的答案。将你的答案四舍五入到四位有效数字。CAI 是无量纲的；不要包含单位。",
            "solution": "所提出的问题定义明确，且基于计算生物学的原理。我们将直接进行求解。\n\n对于一个长度为 $L$ 个密码子的编码序列，其密码子适应指数 (CAI) 定义为其组成密码子的相对适应性权重 $w_{c_i}$ 的几何平均值：\n$$ \\mathrm{CAI} = \\left(\\prod_{i=1}^{L} w_{c_i}\\right)^{1/L} $$\n给定的 DNA 序列是 $\\mathrm{ATGGCNCGNTTNCCN}$。阅读框从第一个碱基开始，该序列被划分为 $L=5$ 个密码子：\n$c_1 = \\mathrm{ATG}$，$c_2 = \\mathrm{GCN}$，$c_3 = \\mathrm{CGN}$，$c_4 = \\mathrm{TTN}$，$c_5 = \\mathrm{CCN}$。\n\n第一个密码子的权重给定为 $w(\\mathrm{ATG})=1$。这是一个常数因子。随后的密码子包含模糊核苷酸 $\\mathrm{N}$，它可以是 $\\mathrm{A}$、$\\mathrm{C}$、$\\mathrm{G}$ 或 $\\mathrm{T}$ 中的任意一个。每个模糊位置上 N 的选择是独立的。\n因此，CAI 的表达式为：\n$$ \\mathrm{CAI} = \\left( w(\\mathrm{ATG}) \\cdot w(\\mathrm{GCN}) \\cdot w(\\mathrm{CGN}) \\cdot w(\\mathrm{TTN}) \\cdot w(\\mathrm{CCN}) \\right)^{1/5} $$\n$$ \\mathrm{CAI} = \\left( 1 \\cdot w(\\mathrm{GCN}) \\cdot w(\\mathrm{CGN}) \\cdot w(\\mathrm{TTN}) \\cdot w(\\mathrm{CCN}) \\right)^{1/5} $$\n函数 $f(x) = x^{1/5}$ 对于正参数 $x$ 是一个严格递增函数。由于所有给定的权重 $w_c$ 都在区间 $(0, 1]$ 内，它们的乘积也将是一个正数。因此，要找到 CAI 可能的最小值和最大值，我们必须找到权重乘积 $\\prod_{i=1}^{5} w_{c_i}$ 的最小值和最大值。\n由于每个 N 的核苷酸选择是独立的，总乘积可以通过选择使每个单独权重最大化的密码子序列来达到最大化，并通过选择使每个单独权重最小化的密码子序列来达到最小化。\n\n首先，我们确定可能的最大 CAI。这要求我们为每个 N 选择核苷酸，以使相应的密码子权重达到最大。我们检查为每个模糊密码子家族提供的权重：\n- 对于 $c_2 = \\mathrm{GCN}$：可用权重为 $w(\\mathrm{GCA})=0.2$，$w(\\mathrm{GCC})=1$，$w(\\mathrm{GCG})=0.7$ 和 $w(\\mathrm{GCT})=0.4$。最大权重是 $w_{\\max}(\\mathrm{GCN}) = 1$。\n- 对于 $c_3 = \\mathrm{CGN}$：可用权重为 $w(\\mathrm{CGA})=0.1$，$w(\\mathrm{CGC})=1$，$w(\\mathrm{CGG})=0.8$ 和 $w(\\mathrm{CGT})=0.6$。最大权重是 $w_{\\max}(\\mathrm{CGN}) = 1$。\n- 对于 $c_4 = \\mathrm{TTN}$：可用权重为 $w(\\mathrm{TTA})=0.05$，$w(\\mathrm{TTC})=1$，$w(\\mathrm{TTG})=0.1$ 和 $w(\\mathrm{TTT})=0.5$。最大权重是 $w_{\\max}(\\mathrm{TTN}) = 1$。\n- 对于 $c_5 = \\mathrm{CCN}$：可用权重为 $w(\\mathrm{CCA})=0.3$，$w(\\mathrm{CCC})=1$，$w(\\mathrm{CCG})=0.9$ 和 $w(\\mathrm{CCT})=0.6$。最大权重是 $w_{\\max}(\\mathrm{CCN}) = 1$。\n\n可能的最大权重乘积是：\n$$ P_{\\max} = w(\\mathrm{ATG}) \\cdot w_{\\max}(\\mathrm{GCN}) \\cdot w_{\\max}(\\mathrm{CGN}) \\cdot w_{\\max}(\\mathrm{TTN}) \\cdot w_{\\max}(\\mathrm{CCN}) $$\n$$ P_{\\max} = 1 \\cdot 1 \\cdot 1 \\cdot 1 \\cdot 1 = 1 $$\n最大 CAI 是该乘积的五次方根：\n$$ \\mathrm{CAI}_{\\max} = (1)^{1/5} = 1 $$\n由于问题要求四舍五入到四位有效数字，最大值为 $1.000$。\n\n接下来，我们确定可能的最小 CAI。这要求为每个 N 选择导致最小密码子权重的核苷酸。\n- 对于 $c_2 = \\mathrm{GCN}$：最小权重是 $w_{\\min}(\\mathrm{GCN}) = \\min\\{0.2, 1, 0.7, 0.4\\} = 0.2$。\n- 对于 $c_3 = \\mathrm{CGN}$：最小权重是 $w_{\\min}(\\mathrm{CGN}) = \\min\\{0.1, 1, 0.8, 0.6\\} = 0.1$。\n- 对于 $c_4 = \\mathrm{TTN}$：最小权重是 $w_{\\min}(\\mathrm{TTN}) = \\min\\{0.05, 1, 0.1, 0.5\\} = 0.05$。\n- 对于 $c_5 = \\mathrm{CCN}$：最小权重是 $w_{\\min}(\\mathrm{CCN}) = \\min\\{0.3, 1, 0.9, 0.6\\} = 0.3$。\n\n可能的最小权重乘积是：\n$$ P_{\\min} = w(\\mathrm{ATG}) \\cdot w_{\\min}(\\mathrm{GCN}) \\cdot w_{\\min}(\\mathrm{CGN}) \\cdot w_{\\min}(\\mathrm{TTN}) \\cdot w_{\\min}(\\mathrm{CCN}) $$\n$$ P_{\\min} = 1 \\cdot 0.2 \\cdot 0.1 \\cdot 0.05 \\cdot 0.3 $$\n$$ P_{\\min} = 0.02 \\cdot 0.05 \\cdot 0.3 = 0.001 \\cdot 0.3 = 0.0003 $$\n最小 CAI 是该乘积的五次方根：\n$$ \\mathrm{CAI}_{\\min} = (0.0003)^{1/5} $$\n为了找到数值，我们计算：\n$$ \\mathrm{CAI}_{\\min} = (3 \\times 10^{-4})^{1/5} \\approx 0.19743286 $$\n四舍五入到四位有效数字，最小值为 $0.1974$。\n\n问题要求提供 (最小值, 最大值) 的 CAI 值有序对。该有序对为 $(0.1974, 1.000)$。",
            "answer": "$$\n\\boxed{(0.1974, 1.000)}\n$$"
        },
        {
            "introduction": "除了像 CAI 这样的特定指数，信息论为分析序列特性提供了一个强大而通用的框架。这个练习  引入了香农熵作为一种工具，来衡量密码子使用分布的随机性或偏好性。您将比较一个假设基因与基因组背景的熵，从而理解更低的熵值如何意味着更强的偏好性，而这正是许多高表达基因的一个标志性特征。",
            "id": "2382006",
            "problem": "您将执行一项正式的比较任务，涉及用于基因预测的密码子使用偏好。设 $\\mathcal{A}$ 为标准遗传密码中所有有义密码子的集合，定义为字母表 $\\{ \\text{A}, \\text{C}, \\text{G}, \\text{T} \\}$ 上所有长度为 $3$ 的字符串，但不包括三个终止密码子 $\\{\\text{TAA}, \\text{TAG}, \\text{TGA}\\}$。因此 $|\\mathcal{A}| = 61$。给定一个在 $\\{ \\text{A}, \\text{C}, \\text{G}, \\text{T} \\}$ 上的编码序列 $S$，其长度可被 $3$ 整除，通过从第一个位置（阅读框始于第一个核苷酸）将 $S$ 解析为连续不重叠的三联体来定义其密码子组成，仅计算 $\\mathcal{A}$ 中的密码子。对于每个密码子 $i \\in \\mathcal{A}$，其计数为 $c_i \\ge 0$，定义经验密码子概率为 $p_i = c_i / \\sum_{j \\in \\mathcal{A}} c_j$。对于 $\\mathcal{A}$ 上的任何概率分布 $R = (r_i)_{i \\in \\mathcal{A}}$，以比特为单位的香农熵定义为\n$$\nH(R) = - \\sum_{i \\in \\mathcal{A}} r_i \\log_2 r_i,\n$$\n约定 $0 \\log_2 0 = 0$。\n\n您的任务是为以下每个测试用例计算：源自单个高表达基因（其编码序列如下指定）的密码子分布 $P$ 的熵 $H(P)$，同一字母表 $\\mathcal{A}$ 上指定的基因组范围密码子分布 $Q$ 的熵 $H(Q)$，以及它们的差值\n$$\nD = H(Q) - H(P).\n$$\n所有熵都必须以比特（以 2 为底的对数）为单位进行计算。\n\n测试套件（三个用例）：\n\n- 用例 1（富含鸟嘌呤-胞嘧啶 (GC) 的基因和富含 GC 的基因组）：\n  - 基因序列 $S_1$：将 $\\mathcal{A}$ 中第三个核苷酸为 $\\text{C}$ 或 $\\text{G}$ 的所有密码子按字典序连接起来，然后将该块精确重复两次（无分隔符），形成序列。这将产生一个包含 62 个密码子的序列。\n  - 基因组范围分布 $Q_1$：对于每个密码子 $i \\in \\mathcal{A}$，如果 $i$ 的第三个核苷酸在 $\\{\\text{C}, \\text{G}\\}$ 中，则分配权重 $w_i = 2$，否则分配权重 $w_i = 1$；然后设置 $q_i = w_i / \\sum_{j \\in \\mathcal{A}} w_j$。\n\n- 用例 2（极度偏好的基因和均匀分布的基因组）：\n  - 基因序列 $S_2$：密码子 $\\text{GCT}$ 重复 $120$ 次，产生 $120$ 个密码子。\n  - 基因组范围分布 $Q_2$：在 $\\mathcal{A}$ 上均匀分布，即对于所有 $i \\in \\mathcal{A}$，有 $q_i = 1/61$。\n\n- 用例 3（均匀分布的基因和高度倾斜的基因组）：\n  - 基因序列 $S_3$：将 $\\mathcal{A}$ 中的每个密码子按字典序精确连接一次，产生 61 个密码子。\n  - 基因组范围分布 $Q_3$：分配概率 $q_{\\text{GCT}} = 1/2$，并将其余的概率质量平均分配给其他 60 个密码子，即对于 $i \\ne \\text{GCT}$，设置 $q_i = \\frac{1/2}{60}$。\n\n对于每个用例，计算 $D = H(Q) - H(P)$。所有对数必须以 2 为底，结果必须以比特为单位表示。最终的程序输出必须是单行，包含按用例 1-3 顺序排列的三个 $D$ 值列表，每个值四舍五入到小数点后六位。\n\n最终输出格式要求：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如，“[result1,result2,result3]”），其中每个结果都是一个格式化为小数点后恰好六位的浮点数。",
            "solution": "该问题要求计算基因组范围的密码子频率分布 $Q$ 与特定基因的密码子频率分布 $P$ 之间的香农熵差值 $D = H(Q) - H(P)$。这个量是生物信息学中分析密码子使用偏好的一个基本概念。高熵值表示密码子的使用是均匀的或无偏好的，而低熵值表示分布是倾斜的，即某些密码子被强烈偏好。$D$ 为正值表明该基因的密码子使用（$P$）比基因组平均水平（$Q$）更具偏好性（熵更低），这是高表达基因的一个共同特征。\n\n离散概率分布 $R = (r_i)_{i \\in \\mathcal{A}}$ 的香农熵（以比特为单位）由以下公式给出：\n$$\nH(R) = - \\sum_{i \\in \\mathcal{A}} r_i \\log_2 r_i\n$$\n其中求和遍及集合 $\\mathcal{A}$ 中所有 61 个有义密码子。按照惯例，$0 \\log_2 0 = 0$。\n\n我们现在将系统地解决这三个测试用例。\n\n首先，我们确定有义密码子集合 $\\mathcal{A}$。遗传密码由 $4^3 = 64$ 个可能的密码子组成。三个终止密码子是 $\\text{TAA}$、$\\text{TAG}$ 和 $\\text{TGA}$。因此，有义密码子集合 $\\mathcal{A}$ 有 $|\\mathcal{A}| = 61$ 个成员。\n\n**用例 1：富含 GC 的基因和富含 GC 的基因组**\n\n-   **基因分布 $P_1$**：\n    基因序列 $S_1$ 由 $\\mathcal{A}$ 中第三个核苷酸为 'C' 或 'G' 的密码子构成。设这个密码子子集为 $\\mathcal{A}_{GC3}$。以 'C' 结尾的有义密码子有 16 个，以 'G' 结尾的有义密码子有 15 个（$\\text{TAG}$ 是终止密码子）。因此，$\\mathcal{A}_{GC3}$ 的总大小为 $|\\mathcal{A}_{GC3}| = 16 + 15 = 31$。\n    序列 $S_1$ 由这 31 个密码子连接而成，重复两次。序列中的密码子总数为 $N_1 = 31 \\times 2 = 62$。每个密码子 $i \\in \\mathcal{A}_{GC3}$ 出现两次，因此其经验概率为 $p_i = 2/62 = 1/31$。不在 $\\mathcal{A}_{GC3}$ 中的密码子概率为 0。这构成了在 $\\mathcal{A}_{GC3}$ 中 31 个密码子上的均匀分布。\n    该分布的熵为：\n    $$\n    H(P_1) = - \\sum_{i \\in \\mathcal{A}_{GC3}} \\frac{1}{31} \\log_2\\left(\\frac{1}{31}\\right) = -31 \\left(\\frac{1}{31} \\log_2\\left(\\frac{1}{31}\\right)\\right) = -\\log_2\\left(\\frac{1}{31}\\right) = \\log_2(31)\n    $$\n\n-   **基因组分布 $Q_1$**：\n    对于每个密码子 $i \\in \\mathcal{A}_{GC3}$（大小为 31），权重为 $w_i = 2$。对于其余的 $61 - 31 = 30$ 个密码子，权重为 $w_i = 1$。所有权重的总和为 $\\sum_{j \\in \\mathcal{A}} w_j = (31 \\times 2) + (30 \\times 1) = 62 + 30 = 92$。\n    概率为：对于 $i \\in \\mathcal{A}_{GC3}$，$q_i = 2/92$；对于 $i \\notin \\mathcal{A}_{GC3}$，$q_i = 1/92$。熵为：\n    $$\n    H(Q_1) = - \\left( \\sum_{i \\in \\mathcal{A}_{GC3}} \\frac{2}{92} \\log_2\\left(\\frac{2}{92}\\right) + \\sum_{i \\in \\mathcal{A} \\setminus \\mathcal{A}_{GC3}} \\frac{1}{92} \\log_2\\left(\\frac{1}{92}\\right) \\right)\n    $$\n    $$\n    H(Q_1) = - \\left( 31 \\cdot \\frac{2}{92} \\log_2\\left(\\frac{2}{92}\\right) + 30 \\cdot \\frac{1}{92} \\log_2\\left(\\frac{1}{92}\\right) \\right)\n    $$\n\n-   **差值 $D_1$**：$D_1 = H(Q_1) - H(P_1)$。\n\n**用例 2：极度偏好的基因和均匀分布的基因组**\n\n-   **基因分布 $P_2$**：\n    序列 $S_2$ 由密码子 $\\text{GCT}$ 重复 120 次组成。这导致一个确定性分布，其中 $p_{\\text{GCT}} = 1$，而所有其他 60 个密码子的 $p_i = 0$。一个没有不确定性的分布的熵为零。\n    $$\n    H(P_2) = - \\left( 1 \\cdot \\log_2(1) + \\sum_{i=1}^{60} 0 \\cdot \\log_2(0) \\right) = 0\n    $$\n\n-   **基因组分布 $Q_2$**：\n    这是一个在所有 61 个有义密码子上的均匀分布，因此对于所有 $i \\in \\mathcal{A}$，有 $q_i = 1/61$。对于一个 61 状态的系统，熵是最大的：\n    $$\n    H(Q_2) = - \\sum_{i \\in \\mathcal{A}} \\frac{1}{61} \\log_2\\left(\\frac{1}{61}\\right) = -61 \\left(\\frac{1}{61} \\log_2\\left(\\frac{1}{61}\\right)\\right) = \\log_2(61)\n    $$\n\n-   **差值 $D_2$**：$D_2 = H(Q_2) - H(P_2) = \\log_2(61) - 0 = \\log_2(61)$。\n\n**用例 3：均匀分布的基因和高度倾斜的基因组**\n\n-   **基因分布 $P_3$**：\n    序列 $S_3$ 包含 61 个有义密码子各一次。这导致一个均匀分布，其中对于所有 $i \\in \\mathcal{A}$，有 $p_i = 1/61$。其熵与前一个用例中的 $H(Q_2)$ 相同。\n    $$\n    H(P_3) = \\log_2(61)\n    $$\n\n-   **基因组分布 $Q_3$**：\n    这个分布是高度倾斜的：$q_{\\text{GCT}} = 1/2$，而对于其他 60 个密码子，$q_i = \\frac{1/2}{60} = 1/120$。熵为：\n    $$\n    H(Q_3) = - \\left( \\frac{1}{2} \\log_2\\left(\\frac{1}{2}\\right) + \\sum_{i \\in \\mathcal{A} \\setminus \\{\\text{GCT}\\}} \\frac{1}{120} \\log_2\\left(\\frac{1}{120}\\right) \\right)\n    $$\n    $$\n    H(Q_3) = - \\left( \\frac{1}{2}(-1) + 60 \\cdot \\frac{1}{120} \\log_2\\left(\\frac{1}{120}\\right) \\right) = \\frac{1}{2} - \\frac{1}{2} \\log_2\\left(\\frac{1}{120}\\right) = \\frac{1}{2} (1 + \\log_2(120))\n    $$\n\n-   **差值 $D_3$**：$D_3 = H(Q_3) - H(P_3) = \\frac{1}{2}(1 + \\log_2(120)) - \\log_2(61)$。\n\n将计算数值并按要求进行格式化。",
            "answer": "[0.971320,5.930737,-1.964361]"
        },
        {
            "introduction": "基于内容的基因预测算法通过识别区分编码区与非编码 DNA 的统计特征来工作。这个高级实践  挑战您逆向应用这一逻辑，要求您构建一个根据简单定义是“非编码”的，但仍被统计模型错误分类为基因的序列。成功完成这项任务表明您深刻理解了这些分类器的工作原理，并揭示了它们固有的假设和潜在的弱点。",
            "id": "2382027",
            "problem": "给定一个基于密码子使用偏好的内容基因预测的简化设置。在此设置中，一个基因发现分类器仅使用一个用于“基因”模型的 $64$ 元素密码子概率向量和另一个用于“背景”模型的 $64$ 元素密码子概率向量。对于固定的阅读框和窗口长度，分类器将序列视为一个无重叠密码子袋，并使用自然对数比较观察到的密码子计数在这两个模型下的可能性。脱氧核糖核酸 (DNA) 以称为密码子的三联体形式读取，因此长度为 $L$ 的窗口在固定框架中贡献 $\\lfloor L/3 \\rfloor$ 个密码子。在此设置中，起始密码子是 $\\text{ATG}$。一个开放阅读框 (ORF) 是指没有终止密码子的连续同框密码子序列；然而，在本问题中，我们将使用下面定义的最小非编码代理约束。\n\n基本碱基和数据：\n- 该分类器是一个基于 $64$ 种密码子的多项式模型。它评估阅读框 $0$（从索引 $0$ 开始）中的窗口，并使用对数似然差异比较两个模型。对数似然比 (LLR) 使用自然对数计算，并且是无量纲的。\n- 基因模型在 $64$ 种密码子上的概率 $\\mathbf{P}$ 生成如下。设单核苷酸权重为 $w(\\text{A}) = 0.15$，$w(\\text{C}) = 0.35$，$w(\\text{G}) = 0.35$，$w(\\text{T}) = 0.15$。对于任何密码子 $\\text{X}_1\\text{X}_2\\text{X}_3$，分配一个未归一化的权重 $W(\\text{X}_1\\text{X}_2\\text{X}_3) = w(\\text{X}_1)\\, w(\\text{X}_2)\\, w(\\text{X}_3)$。对于三个终止密码子 $\\{\\text{TAA}, \\text{TAG}, \\text{TGA}\\}$，将其未归一化的权重乘以一个终止密码子缩放因子 $s_{\\text{gene}} = 10^{-3}$，以反映编码区强烈避免内部终止密码子。然后将所有 $64$ 个权重归一化，使其总和为 $1$，从而得到 $\\mathbf{P}$。\n- 每个背景模型 $\\mathbf{Q}$ 均由其自身的单核苷酸权重 $v(\\cdot)$ 类似地生成，但终止密码子缩放因子为 $s_{\\text{bg}} = 1$（对终止密码子无特殊抑制），然后归一化为 $64$ 种密码子上的概率分布。\n\n本问题的非编码约束：\n- 如果一个构建的DNA序列在阅读框 $0$ 中不包含同框起始密码子 $\\text{ATG}$，则该序列被认为是非编码的。此代理约束仅用于本练习，并非生物学上对非编码的全面定义。\n\n分类规则：\n- 对于一个长度为 $L$ 的窗口，分类器在阅读框 $0$ 中对密码子进行计数，并使用多项式似然和自然对数计算基因模型 $\\mathbf{P}$ 与背景模型 $\\mathbf{Q}$ 之间的对数似然差异。如果计算出的 LLR 超过给定阈值 $\\tau$，分类器就宣布为“基因”。\n\n你的任务：\n- 构建一个长度为 $L = 1000$ 个核苷酸的DNA序列，该序列满足上述非编码约束，但对于下面测试套件中指定的每个背景模型，都会被分类器错误地分类为基因（即，其 LLR 超过阈值）。分类器仅使用阅读框 $0$，并忽略任何不能构成完整密码子的尾随核苷酸；你必须只计算从位置 $0$ 开始的 $\\lfloor L/3 \\rfloor = 333$ 个完整密码子。\n- 你可以以任何方式构建序列，只要它遵守非编码约束并与上述定义自洽即可。在所有计算中使用自然对数。不涉及角度或物理单位。任何比例必须以小数表示。\n\n测试套件：\n- 使用如上所述的基因模型 $\\mathbf{P}$，其中 $w(\\text{A}) = 0.15$，$w(\\text{C}) = 0.35$，$w(\\text{G}) = 0.35$，$w(\\text{T}) = 0.15$，以及 $s_{\\text{gene}} = 10^{-3}$。\n- 提供三种背景情况，每种情况都有其自己的单核苷酸权重 $v(\\cdot)$ 和阈值 $\\tau$：\n  1. 情况 1：$v_1(\\text{A}) = 0.25$，$v_1(\\text{C}) = 0.25$，$v_1(\\text{G}) = 0.25$，$v_1(\\text{T}) = 0.25$，阈值 $\\tau_1 = 60.0$。\n  2. 情况 2：$v_2(\\text{A}) = 0.18$，$v_2(\\text{C}) = 0.32$，$v_2(\\text{G}) = 0.32$，$v_2(\\text{T}) = 0.18$，阈值 $\\tau_2 = 7.0$。\n  3. 情况 3：$v_3(\\text{A}) = 0.40$，$v_3(\\text{C}) = 0.10$，$v_3(\\text{G}) = 0.10$，$v_3(\\text{T}) = 0.40$，阈值 $\\tau_3 = 400.0$。\n\n需要遵守的实现细节：\n- 阅读框：始终使用阅读框 $0$。\n- 窗口长度：$L = 1000$，因此从头开始精确计算 $333$ 个密码子，并忽略任何剩余的尾随核苷酸。\n- 任何内部数据结构的密码子排序可采用字典序，在每个位置上 $\\text{A} \\lt \\text{C} \\lt \\text{G} \\lt \\text{T}$。\n- 所有似然计算必须使用自然对数。\n- 你的构建必须确保在这 $333$ 个密码子中，同框密码子 $\\text{ATG}$ 永不出现（非编码代理约束）。\n- 终止密码子为 $\\{\\text{TAA}, \\text{TAG}, \\text{TGA}\\}$。\n\n要求的程序输出：\n- 对于上面列出的三种背景情况，评估你构建的单一序列是否在满足非编码约束的同时被错误地分类为基因。对于每种情况 $k \\in \\{1,2,3\\}$，输出一个布尔值，该值当且仅当以下两个条件同时成立时为真：(i) 针对背景 $\\mathbf{Q}_k$ 计算的 LLR 超过 $\\tau_k$ 并且 (ii) 阅读框 $0$ 的密码子列表中不包含 $\\text{ATG}$。\n- 你的程序应该生成一行输出，其中包含一个用方括号括起来的逗号分隔列表的结果（例如，“[True,False,True]”）。\n\n你的解决方案必须是一个完整的、可运行的程序，它执行指定的构建和三次评估，并以要求的格式精确打印一行输出。",
            "solution": "我们的目标是构建一个长度为 1000 个核苷酸的单一 DNA 序列，该序列需要满足两个条件：(1) 它符合问题的“非编码”定义，即在阅读框 0 中不包含起始密码子 ATG；(2) 对于测试套件中的所有三种情况，它都被分类器错误地识别为“基因”。\n\n分类器基于对数似然比（LLR）进行决策。对于一个包含 $N=333$ 个密码子、其中各种密码子类型的计数为 $\\{n_i\\}$ 的序列，其 LLR 的计算公式为：\n$$LLR_k = \\sum_{i=1}^{64} n_i \\ln\\left(\\frac{P_i}{Q_{i,k}}\\right)$$\n其中 $\\mathbf{P}$ 是基因模型的概率向量，$\\mathbf{Q}_k$ 是第 $k$ 个背景模型的概率向量。如果 $LLR_k > \\tau_k$，则序列被分类为基因。\n\n要构建一个能够同时通过所有三个测试的序列，我们需要找到一组密码子计数 $\\{n_i\\}$（满足 $\\sum n_i = 333$ 和 $n_{\\text{ATG}} = 0$），使得对所有 $k \\in \\{1,2,3\\}$，上述不等式 $LLR_k > \\tau_k$ 都成立。\n\n一个简单而有效的策略是，用一个单一类型的“最佳”密码子 $c^*$ 重复 $N=333$ 次来构建序列。这样，LLR 的计算就简化为：\n$$LLR_k = N \\times \\ln\\left(\\frac{P(c^*)}{Q_k(c^*)}\\right)$$\n我们的任务是找到一个密码子 $c^* \\neq \\text{ATG}$，它能同时满足所有三个阈值条件：\n1. $333 \\times \\ln(P(c^*)/Q_1(c^*)) > 60.0$\n2. $333 \\times \\ln(P(c^*)/Q_2(c^*)) > 7.0$\n3. $333 \\times \\ln(P(c^*)/Q_3(c^*)) > 400.0$\n\n为了最大化所有三个 LLR 值，我们应该寻找一个在基因模型 $\\mathbf{P}$ 中概率高，而在所有三个背景模型 $\\mathbf{Q}_k$ 中概率都相对较低的密码子 $c^*$。\n\n通过分析给定的权重可以发现：\n- **基因模型 ($\\mathbf{P}$):** 对 G 和 C 有强烈的偏好 ($w(\\text{C})=w(\\text{G})=0.35$)。\n- **背景模型 ($\\mathbf{Q}_k$):**\n  - Case 1: 对所有碱基均等偏好 ($v_1=0.25$)。\n  - Case 2: 对 G/C 的偏好弱于基因模型 ($v_2(\\text{C,G})=0.32$)。\n  - Case 3: 强烈偏好 A/T，不偏好 G/C ($v_3(\\text{C,G})=0.10$)。\n\n这个模式表明，一个富含 G 和 C 的密码子是理想的候选者。让我们以密码子 $\\text{CGC}$ 为例。它在基因模型中会有很高的概率，而在所有背景模型中概率都较低，尤其是在强烈偏好 A/T 的背景模型 3 中。\n\n我们可以计算出使用 $\\text{CGC}$ 构建序列时的 LLR 值：\n- 概率：$P(\\text{CGC}) \\approx 0.0437$, $Q_1(\\text{CGC}) \\approx 0.0156$, $Q_2(\\text{CGC}) \\approx 0.0328$, $Q_3(\\text{CGC}) = 0.001$。\n- LLR 计算：\n  - $LLR_1 = 333 \\times \\ln(0.0437/0.0156) \\approx 342.5 > 60.0$ (通过)\n  - $LLR_2 = 333 \\times \\ln(0.0437/0.0328) \\approx 95.9 > 7.0$ (通过)\n  - $LLR_3 = 333 \\times \\ln(0.0437/0.001) \\approx 1257.9 > 400.0$ (通过)\n\n由于密码子 $\\text{CGC}$ 满足所有三个条件，我们可以通过重复 $\\text{CGC}$ 333次（并附加一个任意核苷酸以达到1000的总长度）来构建我们的序列。这个序列不包含同框的 $\\text{ATG}$，并且在所有三种情况下都会被错误地分类为基因。因此，对所有三种情况的评估结果都应为真。",
            "answer": "[True,True,True]"
        }
    ]
}