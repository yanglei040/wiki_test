{
    "hands_on_practices": [
        {
            "introduction": "在变异识别中，等位基因平衡（Allele Balance, AB）——即支持变异等位基因的测序读段（reads）所占的比例——是判断基因型的关键指标。然而，真实的测序数据远比理想情况复杂，测序错误和拷贝数变异（Copy Number Variations, CNVs）等因素都可能影响我们对等位基因平衡的解读。本练习将引导你运用统计模型，在考虑这些混杂因素的情况下，评估哪种基因型假说最能解释观测到的数据，从而深入理解变异识别的统计基础。",
            "id": "2439432",
            "problem": "一项针对胚系样本的全基因组短读长测序实验报告了一个候选单核苷酸多态性（SNP），该位点的总深度为 $n = 50$，有 $k = 45$ 条读段支持备择等位基因，因此等位基因平衡为 $AB = k/n = 0.9$。假设每碱基测序错误率为 $\\epsilon = 0.01$，比对无偏，且各读段相互独立。设支持备择等位基因的读段的期望分数由潜在的等位基因拷贝数比例和测序错误决定：如果由于拷贝数变异（CNV），该位点有 $a$ 个备择等位基因拷贝和 $r$ 个参考等位基因拷贝，那么真实的备择等位基因比例为 $p = a/(a+r)$，并且一条读段支持备择碱基的概率为 $p_{\\mathrm{eff}} = p(1-\\epsilon) + (1-p)\\epsilon$。该样本为胚系样本，并且已知该位点的总拷贝数在 $\\{1,2,3,4\\}$ 集合中。\n\n在这些假设下，哪种解释与观测到的等位基因平衡 $AB = 0.9$ 最为一致？\n\nA. 二倍体区域（无CNV）中的一个纯合备择变异，即 $a = 2$, $r = 0$。\n\nB. 总拷贝数为 $3$ 的区域中的一个杂合变异，其中 $a = 2$，$r = 1$。\n\nC. 总拷贝数为 $4$ 的区域中的一个杂合变异，其中 $a = 3$，$r = 1$。\n\nD. 不存在真正的变异；$k = 45$ 条备择读段完全由随机测序错误（错误率为 $\\epsilon = 0.01$）产生。\n\n选择唯一最佳选项。",
            "solution": "问题陈述已经过验证，被认为是科学上合理、定义明确、客观且信息自足的。所提供的数据是现实的，足以进行严谨的分析。我们现在开始进行解答。\n\n任务是确定四个提出的场景中，哪一个与实验观察到的总测序深度 $n=50$ 中有 $k=45$ 条读段支持备择等位基因的结果最一致。因此，观察到的等位基因平衡为 $AB = k/n = 45/50 = 0.9$。一致性将从统计学意义上进行评估，这意味着我们必须找出在哪种场景下，观察到的数据最可能出现，即具有最高的似然性。\n\n支持备择等位基因的读段数 $k$ 可以建模为一个服从二项分布的随机变量，$k \\sim \\mathrm{Binomial}(n, p_{\\mathrm{eff}})$，其中 $p_{\\mathrm{eff}}$ 是单条读段支持备择等位基因的有效概率。在 $n$ 条读段的样本中观察到 $k$ 条备择读段的似然由二项概率质量函数给出：\n$$L(p_{\\mathrm{eff}} | k, n) = P(k | n, p_{\\mathrm{eff}}) = \\binom{n}{k} (p_{\\mathrm{eff}})^k (1-p_{\\mathrm{eff}})^{n-k}$$\n由于项 $\\binom{n}{k} = \\binom{50}{45}$ 对所有场景都是一个常数，我们只需要比较每个选项的 $(p_{\\mathrm{eff}})^k (1-p_{\\mathrm{eff}})^{n-k}$ 的值。为了数值稳定性和方便起见，比较对数似然通常更简单。需要最大化的项与对数似然成正比：\n$$\\ln(L) \\propto k \\ln(p_{\\mathrm{eff}}) + (n-k) \\ln(1 - p_{\\mathrm{eff}})$$\n代入观察值 $k=45$ 和 $n=50$，我们计算该表达式：\n$$45 \\ln(p_{\\mathrm{eff}}) + 5 \\ln(1 - p_{\\mathrm{eff}})$$\n$p_{\\mathrm{eff}}$ 的值取决于真实的潜在等位基因比例 $p = a/(a+r)$ 和测序错误率 $\\epsilon = 0.01$，根据给定的公式：\n$$p_{\\mathrm{eff}} = p(1-\\epsilon) + (1-p)\\epsilon$$\n我们现在将为四个选项中的每一个计算 $p_{\\mathrm{eff}}$ 和相应的对数似然项。\n\n**选项 A：二倍体区域（无CNV）中的一个纯合备择变异，即 $a = 2$, $r = 0$。**\n在这种情况下，真实的备择等位基因比例为 $p = a/(a+r) = 2/(2+0) = 1$。\n观察到备择等位基因的有效概率是：\n$$p_{\\mathrm{eff,A}} = 1(1-0.01) + (1-1)(0.01) = 1(0.99) + 0(0.01) = 0.99$$\n对数似然项为：\n$$\\ln(L_A) \\propto 45 \\ln(0.99) + 5 \\ln(1-0.99) = 45 \\ln(0.99) + 5 \\ln(0.01)$$\n$$\\ln(L_A) \\propto 45(-0.01005) + 5(-4.60517) = -0.45225 - 23.02585 = -23.4781$$\n观察到的等位基因平衡 $0.9$ 与期望的 $0.99$ 有偏差。如果测序到参考等位基因的概率仅为 $1-p_{\\mathrm{eff,A}} = 0.01$，那么观察到五条支持参考等位基因的读段是极不可能的。\n\n**选项 B：总拷贝数为 $3$ 的区域中的一个杂合变异，其中 $a = 2$，$r = 1$。**\n在这里，真实的备择等位基因比例为 $p = a/(a+r) = 2/(2+1) = 2/3$。\n观察到备择等位基因的有效概率是：\n$$p_{\\mathrm{eff,B}} = \\frac{2}{3}(1-0.01) + \\left(1-\\frac{2}{3}\\right)(0.01) = \\frac{2}{3}(0.99) + \\frac{1}{3}(0.01) = \\frac{1.98 + 0.01}{3} = \\frac{1.99}{3} \\approx 0.6633$$\n对数似然项为：\n$$\\ln(L_B) \\propto 45 \\ln\\left(\\frac{1.99}{3}\\right) + 5 \\ln\\left(1-\\frac{1.99}{3}\\right) = 45 \\ln\\left(\\frac{1.99}{3}\\right) + 5 \\ln\\left(\\frac{1.01}{3}\\right)$$\n$$\\ln(L_B) \\propto 45(-0.41050) + 5(-1.08864) = -18.4725 - 5.4432 = -23.9157$$\n这个对数似然值比选项 A 的更低（负得更多），表明它与数据的一致性更差。\n\n**选项 C：总拷贝数为 $4$ 的区域中的一个杂合变异，其中 $a = 3$，$r = 1$。**\n真实的备择等位基因比例为 $p = a/(a+r) = 3/(3+1) = 3/4 = 0.75$。\n观察到备择等位基因的有效概率是：\n$$p_{\\mathrm{eff,C}} = \\frac{3}{4}(1-0.01) + \\left(1-\\frac{3}{4}\\right)(0.01) = 0.75(0.99) + 0.25(0.01) = 0.7425 + 0.0025 = 0.745$$\n对数似然项为：\n$$\\ln(L_C) \\propto 45 \\ln(0.745) + 5 \\ln(1-0.745) = 45 \\ln(0.745) + 5 \\ln(0.255)$$\n$$\\ln(L_C) \\propto 45(-0.29440) + 5(-1.36649) = -13.2480 - 6.83245 = -20.08045$$\n这个对数似然值是迄今为止所有选项中最高的（负得最少）。表面分析可能会倾向于选项 A，因为其期望的等位基因平衡（$0.99$）在算术上比选项 C 的（$0.745$）更接近观察到的 $0.9$。然而，这是不正确的。二项似然函数 $L(p) \\propto p^{45}(1-p)^5$ 在其最大值点 $p=0.9$ 附近是高度不对称的。由于 $(1-p)^5$ 项的存在，对于 $p0.9$ 的偏差惩罚要严重得多。观察到 5 条期望概率为 $0.01$ 的读段（选项 A）远比观察到 45 条期望概率为 $0.745$ 的读段（选项 C）更不可能。\n\n**选项 D：不存在真正的变异。**\n这意味着一个纯合参考基因型。假设这是一个二倍体区域（$a=0, r=2$），那么真实的备择等位基因比例为 $p = 0/(0+2) = 0$。\n观察到备择等位基因的有效概率完全来自于测序错误：\n$$p_{\\mathrm{eff,D}} = 0(1-0.01) + (1-0)(0.01) = 0.01$$\n对数似然项为：\n$$\\ln(L_D) \\propto 45 \\ln(0.01) + 5 \\ln(0.99)$$\n$$\\ln(L_D) \\propto 45(-4.60517) + 5(-0.01005) = -207.23265 - 0.05025 = -207.2829$$\n这个对数似然值极低，表明当备择读段预期仅由错误产生时，观察到 45 条备择读段是几乎不可能的。这是迄今为止最不合理的场景，差距巨大。\n\n**结论：**\n比较所有选项的对数似然项：\n- 选项 A：$-23.4781$\n- 选项 B：$-23.9157$\n- 选项 C：$-20.08045$\n- 选项 D：$-207.2829$\n\n最高的对数似然值对应于选项 C。因此，与观察数据最一致的解释是，这是一个位于总拷贝数为 4 的区域中的杂合变异，拥有三个备择等位基因拷贝和一个参考等位基因拷贝。\n\n**逐项结论：**\n- A: **错误**。虽然期望的等位基因平衡 $0.99$ 似乎接近于观察值 $0.9$，但在该模型下观察到 5 条参考读段的似然性极低，使其比选项 C 的合理性更低。\n- B: **错误**。约 $0.663$ 的期望等位基因平衡与观察值相差甚远，其相应的似然性低于选项 A 和 C。\n- C: **正确**。在给定选项中，此场景使得观察数据的似然性最大化。统计证据强烈支持此解释而非其他解释。\n- D: **错误**。观察到的 45 条备择读段无法仅用随机测序错误来合理解释。该场景的似然性小到可以忽略不计。",
            "answer": "$$\\boxed{C}$$"
        },
        {
            "introduction": "为了从海量变异数据中筛选出高质量的结果，自动化过滤是不可或缺的步骤。QualByDepth (QD) 是一个广泛使用的质量控制指标，它通过测序深度对变异置信度进行归一化处理。本练习将揭示一个QD指标可能失效的关键边缘案例，从而教会我们理解生物信息学工具背后假设与局限性的重要性，并培养对结果的批判性思维。",
            "id": "2439414",
            "problem": "一个实验室使用硬过滤规则，移除任何 QualByDepth (QD) 注释低于固定阈值的已检出变异。QualByDepth (QD) 的定义是 Phred 标度上的变异置信度除以该位点的未过滤覆盖深度，即 $QD = QUAL / DP$，其中 $QUAL$ 是 Phred 标度的变异置信度，$DP$ 是未过滤的覆盖深度。Phred 标度的定义为 $Q = -10 \\log_{10} p$，其中 $p$ 是检出的错误概率。该实验室设置了一个硬过滤器，以移除 $QD  2.0$ 的变异。考虑以下四种情景。在每种情景中，假设变异检出软件和比对软件都已正确配置，并且读段的碱基质量和比对质量对于现代短读长测序是典型的。选择最能例证低 $QD$ 过滤会移除一个真阳性变异的边缘案例的选项。\n\nA. 对一个已知的种系杂合单核苷酸多态性 (SNP) 进行靶向扩增子测序。该位点被极深地捕获，未过滤深度 $DP = 4000$。变异检出软件在内部进行降采样以限制用于基因型似然的证据，从而基于一个有效的读段子集得出一个变异置信度 $QUAL = 350$。在非重复、高质量的读段中，等位基因平衡与杂合子一致，并且正交验证证实该 SNP 是真实的。\n\nB. 以约 $30\\times$ 的典型覆盖度进行全基因组测序。一个种系杂合 SNP 的未过滤深度为 $DP = 30$，变异置信度为 $QUAL = 200$，备选等位基因比例接近 $0.5$。独立验证证实该 SNP 是真实的。\n\nC. 覆盖度变异性适中的全外显子组测序。一个种系杂合插入/缺失 (indel) 检出由未过滤深度 $DP = 8$ 支持，变异置信度为 $QUAL = 30$，并且在两条链上都有平衡的等位基因计数。独立的长读长测序证实该 indel 是真实的。\n\nD. 一个低复杂性区域中的短均聚物区域显示出一个表观上的 indel，未过滤深度为 $DP = 120$，但变异置信度为 $QUAL = 20$。该信号出现在跨不同批次处理的许多不相关样本中，表明这是一个复发性的测序或比对伪影，而不是一个真正的生物学变异。\n\n哪个选项最符合一个基于低 $QD$ 的过滤器会移除一个真阳性变异的边缘案例？\n\n答案选项：\n- A\n- B\n- C\n- D",
            "solution": "该问题要求从四个选项中找出一个特定情景，该情景最能例证一个真阳性变异被低的 QualByDepth (QD) 阈值错误地过滤掉的边缘案例。过滤标准定义为移除任何 $QD  2.0$ 的变异。QualByDepth 指标本身的定义是 Phred 标度的变异置信度 ($QUAL$) 与未过滤的覆盖深度 ($DP$) 之比，即 $QD = QUAL / DP$。真阳性是指一个生物学上真实存在且被变异检出软件正确识别的变异。因此，任务是找到描述一个已确认的真实变异的选项，其中计算出的 $QD$ 值低于 $2.0$ 的阈值，导致其被错误地移除。\n\n让我们系统地分析每种情景。\n\n首先，我们确定过滤规则：如果 $QD  2.0$，则移除变异。\n\n选项 A：对一个已知的种系杂合单核苷酸多态性 (SNP) 进行靶向扩增子测序。\n- 已知条件：未过滤深度为 $DP = 4000$。由于内部降采样限制，变异置信度为 $QUAL = 350$。该变异被确认为真阳性（“正交验证证实该 SNP 是真实的”）。\n- $QD$ 的计算：\n$$QD = \\frac{QUAL}{DP} = \\frac{350}{4000} = \\frac{35}{400} = \\frac{7}{80} = 0.0875$$\n- 评估：计算出的 $QD$ 值为 $0.0875$。由于 $0.0875  2.0$，该变异将被硬过滤器移除。问题明确指出这是一个真阳性变异。此情景代表了 $QD$ 指标的一个典型失败模式。在覆盖度极高的区域，例如由扩增子测序产生的区域，分母 $DP$ 会变得非常大。即使绝对变异置信度 $QUAL$ 极高（$QUAL$ 为 $350$ 对应于 $10^{-35}$ 的极小错误概率），$QD$ 比率也可能被人为地压低。变异检出软件通常会在这种高深度区域对读段进行降采样，以保持计算上的可行性，这会限制可达到的最大 $QUAL$ 分数。封顶的 $QUAL$ 和极大的 $DP$ 相结合，导致了低的 $QD$ 值，从而错误地拒绝了一个高置信度的真阳性检出。这种情况精确地匹配了 $QD$ 过滤的有问题的边缘案例的描述。\n- 结论：**正确**。该选项完美地例证了一个基于低 $QD$ 的过滤器移除一个真阳性变异的边缘案例。\n\n选项 B：以典型覆盖度进行全基因组测序。\n- 已知条件：未过滤深度为 $DP = 30$。变异置信度为 $QUAL = 200$。该变异是一个已确认的真阳性 SNP。\n- $QD$ 的计算：\n$$QD = \\frac{QUAL}{DP} = \\frac{200}{30} \\approx 6.67$$\n- 评估：计算出的 $QD$ 值约为 $6.67$。由于 $6.67  2.0$，该变异*不会*被过滤器移除。此情景描述了一个高质量的真阳性变异被过滤器正确通过的情况。它没有说明过滤器的失败。\n- 结论：**不正确**。\n\n选项 C：覆盖度适中的全外显子组测序。\n- 已知条件：未过滤深度为 $DP = 8$。变异置信度为 $QUAL = 30$。该变异是一个已确认的真阳性 indel。\n- $QD$ 的计算：\n$$QD = \\frac{QUAL}{DP} = \\frac{30}{8} = 3.75$$\n- 评估：计算出的 $QD$ 值为 $3.75$。由于 $3.75  2.0$，该变异*不会*被过滤器移除。虽然深度较低，但置信度相对于深度而言足够高，从而产生了一个良好的 $QD$ 分数。这是一个真阳性检出被过滤器正确通过的例子。\n- 结论：**不正确**。\n\n选项 D：一个低复杂性区域中的表观 indel。\n- 已知条件：未过滤深度为 $DP = 120$。变异置信度为 $QUAL = 20$。问题文本指出，该信号是一个“复发性的测序或比对伪影，而不是一个真正的生物学变异”。这意味着它是一个假阳性。\n- 主要目标是找到一个*真阳性*被过滤的例子。由于此情景描述的是一个可能的*假阳性*，因此无论 $QD$ 值如何，它都不可能是正确答案。\n- 为完整起见，我们计算 $QD$：\n$$QD = \\frac{QUAL}{DP} = \\frac{20}{120} = \\frac{1}{6} \\approx 0.167$$\n- 评估：计算出的 $QD$ 约为 $0.167$。由于 $0.167  2.0$，该变异将被过滤。然而，由于该变异被描述为伪影（假阳性），其移除代表了过滤策略的*成功*，而非失败。相对于 $120$ 的高深度，$20$ 的低 $QUAL$ 分数正是 $QD$ 指标旨在检测和过滤掉的那种低质量信号。\n- 结论：**不正确**。\n\n结论：只有情景 A 描述了一个已确认的真阳性变异被 $QD  2.0$ 规则过滤掉的情况。这是由于在测序深度极高的边缘案例中，$QD$ 计算存在伪影，这是此特定过滤指标的一个已知局限性。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}