{
    "hands_on_practices": [
        {
            "introduction": "掌握任何计算模型的第一步是理解其基本构建规则。本练习将通过一个高度简化的重复基因组，引导你亲手将一个DNA序列转换为其对应的德布鲁因图。通过这个过程，你将清晰地看到节点（$(k-1)$-mer）和边（$k$-mer）是如何生成的，并揭示$k$值的选择以及线性染色体的末端效应对图结构的影响，从而引入平衡节点和欧拉路径等核心概念。",
            "id": "2384050",
            "problem": "一个线性基因组 $G$ 定义为 $4$-核苷酸模式 $\\text{ATCG}$ 的 $N$ 次重复串联，即 $G = (\\text{ATCG})^N$，其中 $N \\ge 2$。考虑用于基因组组装的 $k$ 阶 de Bruijn 图 (dBG)，其定义如下：顶点集由 $G$ 中作为子串出现的所有不同 $(k-1)$-mer 组成，对于 $G$ 中 $k$-mer $\\alpha_1 \\alpha_2 \\cdots \\alpha_k$ 的每一次出现，都添加一条有向边，从对应其 $(k-1)$-前缀 $\\alpha_1 \\cdots \\alpha_{k-1}$ 的顶点指向对应其 $(k-1)$-后缀 $\\alpha_2 \\cdots \\alpha_k$ 的顶点。边的重数等于 $G$ 中相应 $k$-mer 的出现次数。该基因组是线性的，因此不会在 $G$ 的两端之间添加环绕子串。\n\n哪个选项正确描述了 $k=4$、$k=5$ 和 $k=3$ 时 dBG 的结构？\n\nA. 对于 $k \\in \\{3,4,5\\}$，dBG 是一个单一的有向 4-环，其中所有顶点的入度和出度相等（每种情况下都是一个欧拉环）。\n\nB. 对于 $k=4$，顶点是 $\\text{ATC}$、$\\text{TCG}$、$\\text{CGA}$、$\\text{GAT}$，它们之间的四条边中的每一条都恰好出现 $N$ 次；对于 $k=5$，顶点是 $\\text{ATCG}$、$\\text{TCGA}$、$\\text{CGAT}$、$\\text{GATC}$，它们之间的每条有向边都恰好出现 $N$ 次；对于 $k=3$，顶点是 $\\text{AT}$、$\\text{TC}$、$\\text{CG}$、$\\text{GA}$，它们之间的四条边中的每一条都恰好出现 $N$ 次。因此这三种情况都是欧拉环。\n\nC. 对于 $k=4$，顶点是 $\\text{ATC}$、$\\text{TCG}$、$\\text{CGA}$、$\\text{GAT}$，排列成一个单一的有向 4-环，边的重数如下：$\\text{ATC} \\to \\text{TCG}$ 出现 $N$ 次，而 $\\text{TCG} \\to \\text{CGA}$、$\\text{CGA} \\to \\text{GAT}$ 和 $\\text{GAT} \\to \\text{ATC}$ 各出现 $N-1$ 次；只有 $\\text{ATC}$ 和 $\\text{TCG}$ 不平衡，差值为 $\\pm 1$，所以存在一条从 $\\text{ATC}$ 到 $\\text{TCG}$ 的唯一欧拉路径。对于 $k=5$，顶点是 $\\text{ATCG}$、$\\text{TCGA}$、$\\text{CGAT}$、$\\text{GATC}$，位于一个单一的有向 4-环中，四条边中的每一条都出现 $N-1$ 次；所有顶点都是平衡的，所以存在一个欧拉环。对于 $k=3$，顶点是 $\\text{AT}$、$\\text{TC}$、$\\text{CG}$、$\\text{GA}$，位于一个单一的有向 4-环中，边的重数如下：$\\text{AT} \\to \\text{TC}$ 和 $\\text{TC} \\to \\text{CG}$ 出现 $N$ 次，而 $\\text{CG} \\to \\text{GA}$ 和 $\\text{GA} \\to \\text{AT}$ 出现 $N-1$ 次；只有 $\\text{AT}$ 和 $\\text{CG}$ 不平衡，差值为 $\\pm 1$，所以存在一条从 $\\text{AT}$ 到 $\\text{CG}$ 的唯一欧拉路径。\n\nD. 对于 $k=3$，重复的$2$-mers导致分支：顶点 $\\text{AT}$、$\\text{TC}$、$\\text{CG}$、$\\text{GA}$ 的出度为 2；对于 $k=4$ 和 $k=5$，dBG 是一个没有环形结构的简单有向路径。",
            "solution": "对问题陈述进行验证。\n\n**步骤 1：提取已知条件**\n- 基因组为 $G = (\\text{ATCG})^N$。\n- 重复次数 $N \\ge 2$。\n- 基因组是线性的，没有环绕连接。\n- 构建一个 $k$ 阶 de Bruijn 图 (dBG)。\n- 顶点是 $G$ 中所有不同的 $(k-1)$-mer 的集合。\n- 如果 $(k-1)$-mer $u$ 是 $G$ 中某个 $k$-mer 的前缀，并且 $(k-1)$-mer $v$ 是其后缀，则存在一条从顶点 $u$ 到顶点 $v$ 的有向边。\n- 边的重数是 $G$ 中对应 $k$-mer 的出现次数。\n- 任务是描述 $k=3$、$k=4$ 和 $k=5$ 时的 dBG 结构。\n\n**步骤 2：使用提取的已知条件进行验证**\n- 问题具有科学依据。de Bruijn 图的定义在计算生物学中是标准的。该基因组序列虽然是人工合成的，但对于此分析而言是一个有效的数学对象。\n- 问题是定义明确的。所有术语都有明确的定义。参数 $G$、$N$ 和 $k$ 唯一地确定了图的结构。\n- 问题是客观且自足的。不需要外部信息或主观解释。\n\n**步骤 3：结论和行动**\n问题陈述被认定为 **有效**。将推导出解答。\n\n分析将通过为每个指定的 $k$ 值构建 de Bruijn 图来进行。基因组 $G = (\\text{ATCG})^N$ 是一个长度为 $4N$ 的线性序列。$G$ 中 $k$-mer 的数量为 $(4N - k + 1)$。\n\n**情况 1：对 $k=4$ 进行分析**\n\ndBG 的顶点是不同的 $(k-1)$-mer，即 3-mer。$G$ 的周期性只产生四种不同的 3-mer：$\\text{ATC}$、$\\text{TCG}$、$\\text{CGA}$ 和 $\\text{GAT}$。因此，顶点集为 $V_4 = \\{\\text{ATC}, \\text{TCG}, \\text{CGA}, \\text{GAT}\\}$。\n\n边由 $G$ 中的 4-mer 决定。不同的 4-mer 是 $\\text{ATCG}$、$\\text{TCGA}$、$\\text{CGAT}$ 和 $\\text{GATC}$。这些对应于以下边：\n1. $\\text{ATCG}$：从 $\\text{ATC}$ 到 $\\text{TCG}$ 的边。\n2. $\\text{TCGA}$：从 $\\text{TCG}$ 到 $\\text{CGA}$ 的边。\n3. $\\text{CGAT}$：从 $\\text{CGA}$ 到 $\\text{GAT}$ 的边。\n4. $\\text{GATC}$：从 $\\text{GAT}$ 到 $\\text{ATC}$ 的边。\n这四条边形成一个单一的有向 4-环。\n\n现在我们必须通过计算线性序列 $G$ 中相应 4-mer 的出现次数来计算每条边的重数。一个起始于位置 $i$ 的 $k$-mer 必须满足 $i+k-1 \\le 4N$，对于 $k=4$ 来说，即 $i \\le 4N-3$。\n- $\\text{ATCG}$ 的出现：起始于位置 $1, 5, \\dots, 4(N-1)+1$。最后一个起始位置是 $4N-3$，是有效的。因此，有 $N$ 次出现。边 $\\text{ATC} \\to \\text{TCG}$ 的重数为 $N$。\n- $\\text{TCGA}$ 的出现：起始于位置 $2, 6, \\dots, 4(j)+2$。我们需要 $4j+2 \\le 4N-3$，所以 $4j \\le 4N-5$，意味着 $j \\le N-2$。所以 $j$ 的范围是从 $0$ 到 $N-2$，得到 $N-1$ 次出现。边 $\\text{TCG} \\to \\text{CGA}$ 的重数为 $N-1$。\n- $\\text{CGAT}$ 的出现：起始于位置 $3, 7, \\dots, 4(j)+3$。我们需要 $4j+3 \\le 4N-3$，所以 $4j \\le 4N-6$，意味着 $j \\le N-2$。这得到 $N-1$ 次出现。边 $\\text{CGA} \\to \\text{GAT}$ 的重数为 $N-1$。\n- $\\text{GATC}$ 的出现：起始于位置 $4, 8, \\dots, 4(j)+4$。我们需要 $4j+4 \\le 4N-3$，所以 $4j \\le 4N-7$，意味着 $j \\le N-2$。这得到 $N-1$ 次出现。边 $\\text{GAT} \\to \\text{ATC}$ 的重数为 $N-1$。\n\n顶点度数：\n- 顶点 $\\text{ATC}$：$\\text{out-degree} = N$，$\\text{in-degree} = N-1$。不平衡度为 $+1$。\n- 顶点 $\\text{TCG}$：$\\text{out-degree} = N-1$，$\\text{in-degree} = N$。不平衡度为 $-1$。\n- 顶点 $\\text{CGA}$：$\\text{out-degree} = N-1$，$\\text{in-degree} = N-1$。平衡。\n- 顶点 $\\text{GAT}$：$\\text{out-degree} = N-1$，$\\text{in-degree} = N-1$。平衡。\n\n一个图存在欧拉路径当且仅当它是连通的，并且最多有一个顶点的 $\\text{out-degree} - \\text{in-degree} = 1$，最多有一个顶点的 $\\text{in-degree} - \\text{out-degree} = 1$。该图满足这些条件，存在一条从 $\\text{ATC}$ 到 $\\text{TCG}$ 的唯一欧拉路径。\n\n**情况 2：对 $k=5$ 进行分析**\n\n顶点是不同的 4-mer：$V_5 = \\{\\text{ATCG}, \\text{TCGA}, \\text{CGAT}, \\text{GATC}\\}$。\n边由 5-mer 决定。不同的 5-mer 是 $\\text{ATCGA}$、$\\text{TCGAT}$、$\\text{CGATC}$ 和 $\\text{GATCG}$。这些形成一个有向 4-环：$\\text{ATCG} \\to \\text{TCGA} \\to \\text{CGAT} \\to \\text{GATC} \\to \\text{ATCG}$。\n\n一个起始于位置 $i$ 的 5-mer 必须满足 $i \\le 4N-4$。\n- $\\text{ATCGA}$ 的出现（起始于 $4j+1$）：$4j+1 \\le 4N-4 \\Rightarrow j \\le N-2$。总共 $N-1$ 次出现。\n- $\\text{TCGAT}$ 的出现（起始于 $4j+2$）：$4j+2 \\le 4N-4 \\Rightarrow j \\le N-2$。总共 $N-1$ 次出现。\n- $\\text{CGATC}$ 的出现（起始于 $4j+3$）：$4j+3 \\le 4N-4 \\Rightarrow j \\le N-2$。总共 $N-1$ 次出现。\n- $\\text{GATCG}$ 的出现（起始于 $4j+4$）：$4j+4 \\le 4N-4 \\Rightarrow j \\le N-2$。总共 $N-1$ 次出现。\n\n环中的所有四条边都有 $N-1$ 的重数。因此，对于每个顶点，入度等于出度（均为 $N-1$）。该图是强连通的，并且每个顶点都是平衡的。因此，该图包含一个欧拉环。\n\n**情况 3：对 $k=3$ 进行分析**\n\n顶点是不同的 2-mer：$V_3 = \\{\\text{AT}, \\text{TC}, \\text{CG}, \\text{GA}\\}$。\n边由 3-mer 决定：$\\text{ATC}$、$\\text{TCG}$、$\\text{CGA}$ 和 $\\text{GAT}$。这些形成一个有向 4-环：$\\text{AT} \\to \\text{TC} \\to \\text{CG} \\to \\text{GA} \\to \\text{AT}$。\n\n一个起始于位置 $i$ 的 3-mer 必须满足 $i \\le 4N-2$。\n- $\\text{ATC}$ 的出现（起始于 $4j+1$）：$4j+1 \\le 4N-2 \\Rightarrow j \\le N-1$。总共 $N$ 次出现。边 $\\text{AT} \\to \\text{TC}$。\n- $\\text{TCG}$ 的出现（起始于 $4j+2$）：$4j+2 \\le 4N-2 \\Rightarrow j \\le N-1$。总共 $N$ 次出现。边 $\\text{TC} \\to \\text{CG}$。\n- $\\text{CGA}$ 的出现（起始于 $4j+3$）：$4j+3 \\le 4N-2 \\Rightarrow j \\le N-2$。总共 $N-1$ 次出现。边 $\\text{CG} \\to \\text{GA}$。\n- $\\text{GAT}$ 的出现（起始于 $4j+4$）：$4j+4 \\le 4N-2 \\Rightarrow j \\le N-2$。总共 $N-1$ 次出现。边 $\\text{GA} \\to \\text{AT}$。\n\n顶点度数：\n- 顶点 $\\text{AT}$：$\\text{out-degree} = N$，$\\text{in-degree} = N-1$。不平衡度为 $+1$。\n- 顶点 $\\text{TC}$：$\\text{out-degree} = N$，$\\text{in-degree} = N$。平衡。\n- 顶点 $\\text{CG}$：$\\text{out-degree} = N-1$，$\\text{in-degree} = N$。不平衡度为 $-1$。\n- 顶点 $\\text{GA}$：$\\text{out-degree} = N-1$，$\\text{in-degree} = N-1$。平衡。\n\n该图有一个不平衡度为 $+1$ 的顶点（$\\text{AT}$）和一个不平衡度为 $-1$ 的顶点（$\\text{CG}$）。因此，存在一条从 $\\text{AT}$ 到 $\\text{CG}$ 的唯一欧拉路径。\n\n**评估选项**\n\nA. 对于 $k \\in \\{3,4,5\\}$，dBG 是一个单一的有向 4-环，其中所有顶点的入度和出度相等（每种情况下都是一个欧拉环）。\n**不正确**。这个陈述对于 $k=3$ 和 $k=4$ 是错误的，在这两种情况下，由于基因组的线性性质，顶点是不平衡的。只有在 $k=5$ 时，所有顶点才是平衡的。\n\nB. 对于 $k=4$，顶点是 $\\text{ATC}$、$\\text{TCG}$、$\\text{CGA}$、$\\text{GAT}$，它们之间的四条边中的每一条都恰好出现 $N$ 次；对于 $k=5$，顶点是 $\\text{ATCG}$、$\\text{TCGA}$、$\\text{CGAT}$、$\\text{GATC}$，它们之间的每条有向边都恰好出现 $N$ 次；对于 $k=3$，顶点是 $\\text{AT}$、$\\text{TC}$、$\\text{CG}$、$\\text{GA}$，它们之间的四条边中的每一条都恰好出现 $N$ 次。因此这三种情况都是欧拉环。\n**不正确**。该选项对所有三种情况都给出了错误的重数。对于 $k=4$，重数是 $N, N-1, N-1, N-1$。对于 $k=5$，重数都是 $N-1$。对于 $k=3$，重数是 $N, N, N-1, N-1$。因此，三种情况都是欧拉环的结论是有缺陷的。\n\nC. 对于 $k=4$，顶点是 $\\text{ATC}$、$\\text{TCG}$、$\\text{CGA}$、$\\text{GAT}$，排列成一个单一的有向 4-环，边的重数如下：$\\text{ATC} \\to \\text{TCG}$ 出现 $N$ 次，而 $\\text{TCG} \\to \\text{CGA}$、$\\text{CGA} \\to \\text{GAT}$ 和 $\\text{GAT} \\to \\text{ATC}$ 各出现 $N-1$ 次；只有 $\\text{ATC}$ 和 $\\text{TCG}$ 不平衡，差值为 $\\pm 1$，所以存在一条从 $\\text{ATC}$ 到 $\\text{TCG}$ 的唯一欧拉路径。对于 $k=5$，顶点是 $\\text{ATCG}$、$\\text{TCGA}$、$\\text{CGAT}$、$\\text{GATC}$，位于一个单一的有向 4-环中，四条边中的每一条都出现 $N-1$ 次；所有顶点都是平衡的，所以存在一个欧拉环。对于 $k=3$，顶点是 $\\text{AT}$、$\\text{TC}$、$\\text{CG}$、$\\text{GA}$，位于一个单一的有向 4-环中，边的重数如下：$\\text{AT} \\to \\text{TC}$ 和 $\\text{TC} \\to \\text{CG}$ 出现 $N$ 次，而 $\\text{CG} \\to \\text{GA}$ 和 $\\text{GA} \\to \\text{AT}$ 出现 $N-1$ 次；只有 $\\text{AT}$ 和 $\\text{CG}$ 不平衡，差值为 $\\pm 1$，所以存在一条从 $\\text{AT}$ 到 $\\text{CG}$ 的唯一欧拉路径。\n**正确**。该选项精确地描述了所有三种情况下的顶点、边的重数、顶点平衡性以及由此产生的图遍历属性（欧拉路径或欧拉环），与我们从第一性原理出发的推导一致。\n\nD. 对于 $k=3$，重复的 $2$-mers 导致分支：顶点 $\\text{AT}$、$\\text{TC}$、$\\text{CG}$、$\\text{GA}$ 的出度为 2；对于 $k=4$ 和 $k=5$，dBG 是一个没有环形结构的简单有向路径。\n**不正确**。分析表明，在所有情况下，图都是一个单一的有向 4-环。不存在分支；任何顶点的出度（忽略重数）都是 1。对于 $k=4$ 和 $k=5$，图是环状的，而不是简单路径。该选项在拓扑结构的描述上根本就是错误的。",
            "answer": "$$\\boxed{C}$$"
        },
        {
            "introduction": "从理论走向实践，在真正开始组装基因组之前，我们可以从原始测序数据中提取出宝贵的信息。本练习模拟了一个真实世界中的生物信息学任务：根据$k$-mer频率直方图估算基因组大小。这个实践将教你如何识别并过滤掉测序错误产生的$k$-mer，并利用覆盖深度的概念来进行稳健的估算，这是任何基因组学项目中的关键预备步骤。",
            "id": "2384041",
            "problem": "您会获得一个通过鸟枪法测序得到的核苷酸 $k$-mer 多重集，该多重集由 $k$-mer 多重性的直方图表示。考虑一个 $k$ 阶有向 de Bruijn 图 (DBG)，其顶点是 $(k-1)$-mer，有向边是 $k$-mer。低丰度的 $k$-mer 主要由测序错误引起，在估算时应将其排除。在排除了多重性低于指定阈值的易错 $k$-mer 后，请估算以碱基对为单位的基因组大小 $G$。\n\n形式上，对于每个测试用例，您将获得：\n- 一个正整数 $k$（$k$-mer 的长度）。\n- 一个正整数 $\\tau$（多重性阈值）。只有观测到的多重性大于或等于 $\\tau$ 的 $k$-mer 才被认为是可信的。\n- 一个以有限配对集合 $\\{(i, H[i])\\}$ 形式给出的直方图，其中 $i$ 是一个正整数多重性，$H[i]$ 是观测到恰好 $i$ 次的不同 $k$-mer 的数量。如果某个多重性 $i$ 未被列出，则解释为 $H[i]=0$。\n\n您的估算必须满足以下基于第一性原理的条件：\n- 令 $S=\\sum_{i \\ge \\tau} i \\cdot H[i]$ 为可信 $k$-mer 的观测总数。\n- 令 $c_{\\text{peak}}$ 为在所有可信多重性中，使 $H[i]$ 达到最大值的多重性 $i \\ge \\tau$。如果存在多个这样的 $i$，则使用最小的那个 $i$。\n- 估算的基因组中不同 $k$-mer 的数量为 $S / c_{\\text{peak}}$。\n- 对于一个线性单倍体基因组，以碱基对为单位的基因组大小估算为 $G \\approx S / c_{\\text{peak}} + k - 1$。\n- 如果没有可信的 $k$-mer（即 $\\sum_{i \\ge \\tau} H[i] = 0$），则将估算值定义为 $0$ 碱基对。\n\n将每个估算的基因组大小（以碱基对 bp 为单位）表示为一个四舍五入到小数点后3位的浮点数。输出不得包含单位符号。\n\n测试套件。请使用以下5个测试用例。每个用例都是一个三元组 $(k, \\tau, \\{(i, H[i])\\})$：\n- 用例1：$k = 21$，$\\tau = 4$，直方图数据对\n  $(1, 120)$, $(2, 90)$, $(3, 60)$, $(25, 150)$, $(26, 180)$, $(27, 220)$, $(28, 240)$, $(29, 260)$, $(30, 250)$, $(31, 230)$, $(32, 200)$。\n- 用例2：$k = 31$，$\\tau = 2$，直方图数据对\n  $(1, 300)$, $(2, 700)$, $(3, 350)$, $(4, 120)$。\n- 用例3：$k = 17$，$\\tau = 5$，直方图数据对\n  $(1, 1000)$, $(2, 500)$, $(3, 200)$, $(4, 100)$。\n- 用例4：$k = 25$，$\\tau = 5$，直方图数据对\n  $(1, 400)$, $(2, 300)$, $(3, 200)$, $(4, 150)$, $(55, 180)$, $(56, 200)$, $(57, 220)$, $(58, 240)$, $(59, 260)$, $(60, 280)$, $(61, 270)$, $(62, 250)$, $(63, 230)$。\n- 用例5：$k = 19$，$\\tau = 5$，直方图数据对\n  $(1, 300)$, $(2, 250)$, $(3, 200)$, $(4, 150)$, $(18, 100)$, $(19, 150)$, $(20, 200)$, $(21, 220)$, $(22, 210)$, $(38, 120)$, $(39, 180)$, $(40, 240)$, $(41, 200)$, $(42, 160)$。\n\n最终输出格式。您的程序应生成单行输出，其中包含5个测试用例的结果，形式为方括号括起来的逗号分隔列表，顺序与上面列出的一致。例如，输出必须具有 $[r_1,r_2,r_3,r_4,r_5]$ 的形式，其中每个 $r_j$ 是按规定四舍五入的浮点估算值。",
            "solution": "从测序数据估算基因组大小是生物信息学中的一项基础任务。所提供的问题陈述概述了一种基于 $k$-mer 多重性直方图分析的有效、良定且有科学依据的方法。该方法是与鸟枪法测序覆盖度相关的​​第一性原理的直接应用。\n\n该问题的有效性验证如下：\n- **科学依据**：该方法是 Lander-Waterman 模型的一种简化形式，该模型假定对于随机的鸟枪法测序，基因组中某个碱基被测序的次数遵循泊松分布。$k$-mer 直方图的峰值（不包括错误峰）提供了平均覆盖度的估算。长度为 $G$ 的基因组中 $k$-mer 的总数约为 $G$。如果每个基因组 $k$-mer 平均被测序 $c_{\\text{peak}}$ 次，那么观测到的基因组 $k$-mer 总数约为 $G \\cdot c_{\\text{peak}}$。问题将此重新表述为 $G \\approx N_k$，其中 $N_k$ 是基因组中不同 $k$-mer 的数量。观测到的可信 $k$-mer 总数为 $S$。因此，平均覆盖度通过 $c_{\\text{peak}}$ 估算，而基因组中不同 $k$-mer 的数量估算为 $N_k \\approx S / c_{\\text{peak}}$。对于线性染色体，最终的基因组大小估算公式 $G \\approx N_k + k - 1$ 正确地将不同 $k$-mer 的数量与序列长度关联起来。这整个过程在逻辑上和科学上都是合理的。\n- **良定性**：问题为所有计算提供了明确的公式和无歧义的规则，包括处理 $c_{\\text{peak}}$ 的平局情况以及无可信 $k$-mer 的边界情况。输入被清晰地定义。\n- **客观性**：问题以精确的数学和计算术语陈述，没有任何主观或模糊的语言。\n\n因此，该问题是有效的。我们现在通过将指定算法应用于每个测试用例来求解。\n\n基因组大小估算的核心公式是：\n$$\nG \\approx \\frac{S}{c_{\\text{peak}}} + k - 1\n$$\n其中 $k$ 是 $k$-mer 的长度，$S = \\sum_{i \\ge \\tau} i \\cdot H[i]$ 是可信 $k$-mer 观测的总数（其中 $\\tau$ 是多重性阈值），$c_{\\text{peak}}$ 是对应于 $i \\ge \\tau$ 的最高频率 $H[i]$ 的多重性。\n\n**用例1：**\n- 给定：$k = 21$，$\\tau = 4$。\n- 直方图提供了数据对 $(i, H[i])$。我们只考虑多重性 $i \\ge 4$ 的数据。\n- 可信的直方图条目是：$\\{(25, 150), (26, 180), (27, 220), (28, 240), (29, 260), (30, 250), (31, 230), (32, 200)\\}$。\n- 对于 $i \\ge 4$，$H[i]$ 的最大值是 $260$，出现在 $i = 29$ 处。因此，$c_{\\text{peak}} = 29$。\n- 可信 $k$-mer 的观测总数 $S$ 计算如下：\n$$\nS = (25 \\cdot 150) + (26 \\cdot 180) + (27 \\cdot 220) + (28 \\cdot 240) + (29 \\cdot 260) + (30 \\cdot 250) + (31 \\cdot 230) + (32 \\cdot 200)\n$$\n$$\nS = 3750 + 4680 + 5940 + 6720 + 7540 + 7500 + 7130 + 6400 = 49660\n$$\n- 估算的基因组大小 $G$ 是：\n$$\nG \\approx \\frac{49660}{29} + 21 - 1 \\approx 1712.41379 + 20 \\approx 1732.414 \\text{ 碱基对}\n$$\n\n**用例2：**\n- 给定：$k = 31$，$\\tau = 2$。\n- 可信的直方图条目是：$\\{(2, 700), (3, 350), (4, 120)\\}$。\n- 对于 $i \\ge 2$，$H[i]$ 的最大值是 $700$，出现在 $i = 2$ 处。因此，$c_{\\text{peak}} = 2$。\n- 可信 $k$-mer 的观测总数 $S$ 是：\n$$\nS = (2 \\cdot 700) + (3 \\cdot 350) + (4 \\cdot 120) = 1400 + 1050 + 480 = 2930\n$$\n- 估算的基因组大小 $G$ 是：\n$$\nG \\approx \\frac{2930}{2} + 31 - 1 = 1465 + 30 = 1495.000 \\text{ 碱基对}\n$$\n\n**用例3：**\n- 给定：$k = 17$，$\\tau = 5$。\n- 提供的直方图条目是 $\\{(1, 1000), (2, 500), (3, 200), (4, 100)\\}$。\n- 没有多重性 $i \\ge \\tau = 5$ 的条目。可信 $k$-mer 的集合为空。\n- 根据问题定义，如果 $\\sum_{i \\ge \\tau} H[i] = 0$，则估算值为 $G = 0$。\n- 估算的基因组大小：$G = 0.000 \\text{ 碱基对}$。\n\n**用例4：**\n- 给定：$k = 25$，$\\tau = 5$。\n- 可信的直方图条目是：$\\{(55, 180), (56, 200), (57, 220), (58, 240), (59, 260), (60, 280), (61, 270), (62, 250), (63, 230)\\}$。\n- 对于 $i \\ge 5$，$H[i]$ 的最大值是 $280$，出现在 $i = 60$ 处。因此，$c_{\\text{peak}} = 60$。\n- 可信 $k$-mer 的观测总数 $S$ 是：\n$$\nS = (55 \\cdot 180) + (56 \\cdot 200) + (57 \\cdot 220) + (58 \\cdot 240) + (59 \\cdot 260) + (60 \\cdot 280) + (61 \\cdot 270) + (62 \\cdot 250) + (63 \\cdot 230)\n$$\n$$\nS = 9900 + 11200 + 12540 + 13920 + 15340 + 16800 + 16470 + 15500 + 14490 = 126160\n$$\n- 估算的基因组大小 $G$ 是：\n$$\nG \\approx \\frac{126160}{60} + 25 - 1 \\approx 2102.6666... + 24 \\approx 2126.667 \\text{ 碱基对}\n$$\n\n**用例5：**\n- 给定：$k = 19$，$\\tau = 5$。\n- 可信的直方图条目是：$\\{(18, 100), (19, 150), (20, 200), (21, 220), (22, 210), (38, 120), (39, 180), (40, 240), (41, 200), (42, 160)\\}$。可信 $k$-mer 的分布是双峰的。\n- 对于 $i \\ge 5$，$H[i]$ 的最大值是 $240$，出现在 $i = 40$ 处。因此，$c_{\\text{peak}} = 40$。\n- 可信 $k$-mer 的观测总数 $S$ 是：\n$$\nS = (18 \\cdot 100) + (19 \\cdot 150) + (20 \\cdot 200) + (21 \\cdot 220) + (22 \\cdot 210) + (38 \\cdot 120) + (39 \\cdot 180) + (40 \\cdot 240) + (41 \\cdot 200) + (42 \\cdot 160)\n$$\n$$\nS = 1800 + 2850 + 4000 + 4620 + 4620 + 4560 + 7020 + 9600 + 8200 + 6720 = 53990\n$$\n- 估算的基因组大小 $G$ 是：\n$$\nG \\approx \\frac{53990}{40} + 19 - 1 = 1349.75 + 18 = 1367.750 \\text{ 碱基对}\n$$",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport scipy as sp\n\ndef solve():\n    \"\"\"\n    Calculates the estimated genome size for a series of test cases based on k-mer histograms.\n    \"\"\"\n    test_cases = [\n        (21, 4, {1: 120, 2: 90, 3: 60, 25: 150, 26: 180, 27: 220, 28: 240, 29: 260, 30: 250, 31: 230, 32: 200}),\n        (31, 2, {1: 300, 2: 700, 3: 350, 4: 120}),\n        (17, 5, {1: 1000, 2: 500, 3: 200, 4: 100}),\n        (25, 5, {1: 400, 2: 300, 3: 200, 4: 150, 55: 180, 56: 200, 57: 220, 58: 240, 59: 260, 60: 280, 61: 270, 62: 250, 63: 230}),\n        (19, 5, {1: 300, 2: 250, 3: 200, 4: 150, 18: 100, 19: 150, 20: 200, 21: 220, 22: 210, 38: 120, 39: 180, 40: 240, 41: 200, 42: 160})\n    ]\n\n    results = []\n    for k, tau, hist in test_cases:\n        # Filter the histogram to include only trusted k-mers (multiplicity >= tau)\n        trusted_hist = {i: h for i, h in hist.items() if i >= tau}\n\n        # If there are no trusted k-mers, the estimated genome size is 0.\n        if not trusted_hist:\n            G = 0.0\n        else:\n            # Calculate S, the total number of trusted k-mer observations.\n            s_total = sum(i * h for i, h in trusted_hist.items())\n\n            # Find c_peak, the multiplicity at which H[i] is maximum for trusted k-mers.\n            # If there's a tie, the smallest multiplicity is chosen.\n            max_h_val = max(trusted_hist.values())\n            c_peak = min(i for i, h in trusted_hist.items() if h == max_h_val)\n\n            # Estimate genome size G using the provided formula.\n            G = (s_total / c_peak) + k - 1\n        \n        # Format the result to 3 decimal places.\n        results.append(f\"{G:.3f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "掌握德布鲁因图后，我们需要将其置于基因组组装算法的更广阔背景下进行审视。虽然德布鲁因图十分强大，但它并非唯一的方法，理解其固有的优缺点对于计算生物学家至关重要。本练习要求你深入比较德布鲁因图模型与重叠图（Overlap Graph）模型，重点分析将长读长（reads）分解为短$k$-mer时所丢失的信息。这将帮助你理解为何某些基因组特征（如长重复序列和单倍型定相）对基于德布鲁因图的组装器构成了独特的挑战。",
            "id": "2384010",
            "problem": "给定一组从二倍体基因组中抽样的、无错误、长度均一为 $L$ 的单端测序读段。考虑基于这些读段构建的两种组装图模型：(i) 在重叠-布局-一致性 (OLC) 范式下的重叠图，其中每个读段是一个顶点，有向边表示读段之间显著的后缀-前缀重叠；以及 (ii) 一个具有固定 $k$-mer 大小 $k$（其中 $1 \\ll k \\ll L$）的 de Bruijn 图，其中顶点是 $(k-1)$-mer，有向边对应于观测到的 $k$-mer。假设没有可用的双端或长读段信息，并且覆盖度足以使所有真实的 $k$-mer 都存在。请分析从重叠图模型转向 de Bruijn 图模型所带来的影响，重点关注当读段被分解为 $k$-mer 时，哪些基因组特征受信息损失（未被明确保留的信息）的影响最大。\n\n从重叠图转向 de Bruijn 图时，下列哪些基因组特征会因信息损失而受到最显著的影响？选择所有适用选项。\n\nA. 区分一个精确散在重复序列的多个拷贝，该重复序列的重复单元长度严格介于 $k+1$ 和 $L$ 之间，且出现在不同的侧翼序列环境中。\n\nB. 对同一条染色体上的两个杂合单核苷酸变异进行定相，这两个变异相隔的基因组距离 $d$ 满足 $k  d \\leq L$。\n\nC. 识别位于唯一基因组区域内的单核苷酸变异，其中 $k \\ll L$。\n\nD. 重建一个长的唯一重叠群 (contig)，其内部片段都是唯一的且长度远大于 $k$。\n\nE. 解析一个串联重复序列阵列的拷贝数和位置，其重复单元长度 $r$ 满足 $r  k$，但其总阵列长度严格介于 $k+1$ 和 $L$ 之间。",
            "solution": "我们从图的定义开始分析。在重叠-布局-一致性 (OLC) 范式下的重叠图中，顶点是长度为 $L$ 的完整读段，边连接那些后缀-前缀重叠超过阈值的读段，从而在长达 $L$ 的范围内保留了读段水平的连贯性。相比之下，一个 $k$-mer 大小为 $k$ 的 de Bruijn 图将观测到的 $k$-mer 表示为 $(k-1)$-mer 顶点之间的边，从而丢失了明确的读段身份以及每个读段内部超出 $(k-1)$ 个碱基的长程连接信息。因此，任何需要追踪哪些 $k$-mer 在同一读段内跨越超过 $k$ 个碱基的范围内共现的区分能力，在 de Bruijn 图的表示中都可能丢失或被大大削弱。\n\n我们根据这些原则来评估每个选项。\n\n选项 A: 区分一个精确散在重复序列的多个拷贝，该重复序列的重复单元长度严格介于 $k+1$ 和 $L$ 之间，且出现在不同的侧翼序列环境中。\n如果重复序列的长度  $k$，那么该重复序列内部的所有 $k$-mer 将在其所有拷贝之间共享。在 de Bruijn 图中，这会为该重复序列生成一条单一的塌缩路径，抹去了不同拷贝之间的区别，并且仅在侧翼的唯一序列环境处产生分支点。在重叠图中，只要 $L$ 超过重复单元的长度并且两侧有足够的唯一序列，那么从唯一侧翼延伸到重复序列内部的长度为 $L$ 的读段就可以通过重叠关系串联起来，从而保留了哪个唯一侧翼连接到哪个重复序列实例的信息。因此，区分具有不同侧翼的重复序列拷贝所需的信息在重叠图中得以保留，但在 de Bruijn 图中则大部分被塌缩了。结论：正确。\n\n选项 B: 对同一条染色体上的两个杂合单核苷酸变异进行定相，这两个变异相隔 $d$ 个碱基，且 $k  d \\leq L$。\n定相需要知道这两个变异是否在同一条读段路径内共现于同一个单倍型上。在 de Bruijn 图中，如果两个位点之间的路径片段由两个单倍型共享的 $k$-mer 组成，那么该路径片段就会塌缩；图本身并不能保留哪些 $k$-mer 是由同一条读段在超过 $k$ 的距离上遍历的。在重叠图中，当 $d \\leq L$ 时，单个跨越这两个位点的长度为 $L$ 的读段（或一串重叠的读段）会保留这种连接信息，从而可以进行定相。因此，当 $k  d \\leq L$ 时，转向 de Bruijn 图会移除对定相至关重要的读段水平的连接信息。结论：正确。\n\n选项 C: 识别位于唯一基因组区域内的单核苷酸变异，其中 $k \\ll L$。\n唯一序列中的单核苷酸变异在 de Bruijn 图中通常表现为一个简单的“气泡”结构：两条局部不同的可替代 $k$-mer 路径，这是许多变异检测工具使用的一个标志性特征。重叠图也通过重叠区域内的不匹配来捕捉这一点。由于两种表示方法都支持检测，因此对于这个特征而言，从重叠图转向 de Bruijn 图并没有特定的重大信息损失。结论：错误。\n\n选项 D: 重建一个长的唯一重叠群 (contig)，其内部片段都是唯一的且长度远大于 $k$。\n在唯一序列中，de Bruijn 图和重叠图基本上都是线性的。de Bruijn 图的压缩是忠实的，对于组装这些区域没有关键信息的损失。因此，相对于重叠图，这不会因信息损失而受到显著影响。结论：错误。\n\n选项 E: 解析一个串联重复序列阵列的拷贝数和位置，其重复单元长度 $r  k$，但总阵列长度严格介于 $k+1$ 和 $L$ 之间。\n即使当 $r  k$ 时，一个足够长的串联阵列由于其周期性也会产生许多相同的 $k$-mer，这导致 de Bruijn 图将该阵列塌缩成一个短的环或路径，无法编码拷贝数，通常需要借助丰度启发式算法。在重叠图中，跨越整个阵列并连接两侧唯一侧翼的长度为 $L$ 的读段可以保留阵列的长度和位置信息，因为重叠关系在整个重复序列上保持了读段的连贯性。由于阵列长度介于 $k+1$ 和 $L$ 之间，重叠图原则上可以解析它，而 de Bruijn 图通常仅凭拓扑结构是无法做到的。结论：正确。\n\n总而言之，对于那些需要保留跨越大于 $k$ 的距离的读段水平连接信息的特征，信息损失最为显著，特别是存在于不同环境中的长精确重复序列、变异的长程定相，以及总长度超过 $k$ 但可被读段跨越的串联重复阵列。",
            "answer": "$$\\boxed{ABE}$$"
        }
    ]
}