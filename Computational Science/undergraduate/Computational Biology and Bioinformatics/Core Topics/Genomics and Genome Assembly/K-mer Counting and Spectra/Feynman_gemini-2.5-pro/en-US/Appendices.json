{
    "hands_on_practices": [
        {
            "introduction": "The overall shape of a $k$-mer spectrum provides a fingerprint of a genome's fundamental characteristics, such as its size and repeat content. This exercise guides you through interpreting a hypothetical spectrum to quantify genomic complexity, a critical factor in genome assembly and analysis . By calculating a \"Repeat Complexity Index\" from the areas under the 'haploid' and 'repeat' peaks, you will practice extracting meaningful biological metrics directly from raw $k$-mer count data.",
            "id": "2400957",
            "problem": "A k-mer histogram is constructed by counting the number of distinct length-$k$ substrings (k-mers) from sequencing reads and tabulating how many times each distinct k-mer occurs in the reads. After excluding low-frequency error k-mers, the remaining non-error k-mer multiplicities for a diploid genome typically form a dominant haploid peak (unique sequence) near the average coverage and secondary peaks at higher multiplicities corresponding to repeats. Consider a non-overlapping binning of the non-error k-mer spectrum from a deeply sequenced diploid genome with $k=31$. The bins have been chosen to isolate two peaks: a haploid peak centered near coverage $c \\approx 40$ and a repeat peak centered near coverage $c \\approx 80$. For each listed coverage value $c$, you are given the number of distinct k-mers recorded at that multiplicity.\n\nHaploid-peak coverage values and counts (coverage $c$; distinct k-mer count in that bin):\n- $c = 32$: $2.40 \\times 10^{5}$\n- $c = 36$: $4.80 \\times 10^{5}$\n- $c = 40$: $6.00 \\times 10^{5}$\n- $c = 44$: $4.50 \\times 10^{5}$\n- $c = 48$: $2.00 \\times 10^{5}$\n\nRepeat-peak coverage values and counts (coverage $c$; distinct k-mer count in that bin):\n- $c = 68$: $1.00 \\times 10^{5}$\n- $c = 72$: $2.50 \\times 10^{5}$\n- $c = 76$: $4.00 \\times 10^{5}$\n- $c = 80$: $4.50 \\times 10^{5}$\n- $c = 84$: $4.00 \\times 10^{5}$\n- $c = 88$: $2.80 \\times 10^{5}$\n- $c = 92$: $1.20 \\times 10^{5}$\n\nDefine the Repeat Complexity Index $R$ as the ratio of the area under the repeat peak to the area under the haploid peak, where each peak’s area is defined as the sum of the listed distinct k-mer counts across its coverage bins. Compute $R$. Round your answer to four significant figures.",
            "solution": "The k-mer histogram records, for each multiplicity $c$, the number of distinct k-mers observed exactly $c$ times. When peak intervals are non-overlapping and chosen to isolate a peak, the area under a peak is obtained by summing the distinct k-mer counts across the bins in that interval. By the definition in the problem, the Repeat Complexity Index $R$ is\n$$\nR \\equiv \\frac{A_{\\text{repeat}}}{A_{\\text{haploid}}},\n$$\nwhere $A_{\\text{repeat}}$ is the sum of the repeat-peak counts and $A_{\\text{haploid}}$ is the sum of the haploid-peak counts.\n\nFirst, compute the haploid peak area, $A_{\\text{haploid}}$, by summing the distinct k-mer counts for its bins:\n\n$$\nA_{\\text{haploid}} = (2.40 + 4.80 + 6.00 + 4.50 + 2.00) \\times 10^{5}\n$$\n$$\nA_{\\text{haploid}} = 19.70 \\times 10^{5} = 1.97 \\times 10^{6}.\n$$\n\nNext, compute the repeat peak area, $A_{\\text{repeat}}$:\n\n$$\nA_{\\text{repeat}} = (1.00 + 2.50 + 4.00 + 4.50 + 4.00 + 2.80 + 1.20) \\times 10^{5}\n$$\n$$\nA_{\\text{repeat}} = 20.00 \\times 10^{5} = 2.00 \\times 10^{6}.\n$$\n\nFinally, form the ratio to find the Repeat Complexity Index $R$:\n\n$$\nR = \\frac{A_{\\text{repeat}}}{A_{\\text{haploid}}} = \\frac{2.00 \\times 10^{6}}{1.97 \\times 10^{6}} = \\frac{2.00}{1.97}\n$$\n\nEvaluating the ratio:\n\n$$\nR \\approx 1.015228426\\ldots\n$$\n\nRounded to four significant figures, the result is:\n\n$$\nR = 1.015.\n$$",
            "answer": "$$\\boxed{1.015}$$"
        },
        {
            "introduction": "$K$-mer spectra are invaluable in clinical and cancer genomics for analyzing complex biological samples. This practice delves into a common scenario in cancer research by modeling a mixed tumor-normal tissue sample . You will apply first principles of sample purity and read depth to calculate the expected frequency of $k$-mers containing a heterozygous somatic mutation, predicting the precise location of the mutation's signature peak within the spectrum.",
            "id": "2401000",
            "problem": "A whole-genome sequencing experiment is performed on a tissue sample that is a mixture of normal cells and tumor cells. The tumor cell fraction (tumor purity) is $0.15$. Sequencing is unbiased so that the expected fraction of reads originating from tumor cells equals the tumor cell fraction. The genome is diploid and copy-number neutral at all loci considered. Reads are long relative to the chosen $k$ so that the expected multiplicity of a unique $k$-mer equals the expected read depth at its genomic locus. Sequencing errors have been filtered so that erroneous $k$-mers are negligible, and $k$ is large enough that $k$-mers overlapping a single-nucleotide somatic mutation are unique in the genome.\n\nLet the mean per-base read depth across the mixture be $D = 80$. Consider $k$-mers that uniquely span heterozygous somatic point mutations present only in tumor cells. Under the assumptions above, at what expected multiplicity $x$ (the mode location of the peak in the $k$-mer multiplicity spectrum for these mutation-bearing $k$-mers) would you expect these $k$-mers to appear? Provide $x$ as a single real number. No rounding is necessary and no units should be included in your answer.",
            "solution": "The objective is to calculate the expected multiplicity, $x$, of $k$-mers that contain a heterozygous somatic mutation found only in tumor cells. This multiplicity is equivalent to the expected read depth of the mutated allele.\n\nLet $D$ be the total mean read depth across the sample mixture, given as $D = 80$.\nLet $p$ be the tumor purity, or the fraction of tumor cells in the sample, given as $p = 0.15$.\n\nThe total read depth $D$ is composed of reads originating from normal cells and tumor cells. The expected depth contribution from tumor cells is $D_{tumor} = D \\times p$.\n\nThe mutation is somatic and heterozygous, present only in tumor cells. Therefore, reads supporting the mutant allele can only originate from the tumor cell population. Within this population, the allele frequency of the heterozygous mutation is 0.5.\n\nThe expected depth of the mutated allele, which equals the expected multiplicity $x$, is the product of the total depth from tumor cells and the allele's frequency within those cells.\n$$\nx = D_{tumor} \\times (\\text{frequency of mutant allele in tumor cells})\n$$\n$$\nx = (D \\times p) \\times 0.5\n$$\nSubstituting the given numerical values:\n$$\nx = (80 \\times 0.15) \\times 0.5\n$$\n$$\nx = 12 \\times 0.5\n$$\n$$\nx = 6\n$$\nThe expected multiplicity for $k$-mers spanning the heterozygous somatic mutation is 6.",
            "answer": "$$\\boxed{6}$$"
        },
        {
            "introduction": "While high-count peaks in a $k$-mer spectrum represent reliable information, the vast number of $k$-mers that appear only once are often dismissed as sequencing errors. This advanced practice challenges that assumption and introduces a powerful statistical method to probe for genuine biological signal hidden within this noisy data . By implementing a hypothesis test based on a Poisson model for random collisions, you will learn to distinguish statistically significant $k$-mer recurrence from the expected random background noise.",
            "id": "2400981",
            "problem": "You are given short DNA read sets and integers specifying the substring length parameter $k$. Denote a $k$-mer as any contiguous substring of length $k$ over the alphabet $\\{A,C,G,T\\}$. For each test case, the read set is partitioned deterministically into two disjoint halves by read index parity: reads at even indices (starting from index $0$) form half $1$, and reads at odd indices form half $2$. For any half $h \\in \\{1,2\\}$, let $S_h$ be the set of $k$-mers that occur with count exactly $1$ within that half (that is, singletons with respect to that half). Define $N_h = |S_h|$, define $M = |S_1 \\cap S_2|$, and define $U = 4^k$.\n\nConsider the null hypothesis that all $k$-mers that are singletons within a half arise from random independent sequencing errors and are equally likely to be any of the $U$ possible $k$-mers. Under this null, the overlap $M$ between $S_1$ and $S_2$ can be modeled by a Poisson random variable with rate parameter\n$$\n\\lambda \\;=\\; \\frac{N_1 \\cdot N_2}{U}.\n$$\nUse a one-sided test that rejects the null hypothesis for large values of $M$, with $p$-value computed as\n$$\np \\;=\\; \\mathbb{P}\\big[X \\ge M \\,\\big|\\, X \\sim \\mathrm{Poisson}(\\lambda)\\big].\n$$\nFix the significance level $\\alpha = 0.01$. If $\\lambda = 0$ and $M = 0$, set $p = 1$ by definition. Your program must compute, for each test case, a decision boolean indicating whether to reject the null hypothesis (that all singletons are errors), and an estimate of the fraction of biologically real singletons among the pooled singleton set $S = S_1 \\cup S_2$. Define the estimator\n$$\n\\widehat{f} \\;=\\; \\max\\!\\left(0,\\; \\frac{M - \\lambda}{|S|}\\right),\n$$\nwith the convention that if $|S| = 0$ then $\\widehat{f} = 0$. Report $\\widehat{f}$ rounded to six decimal places (rounding ties to nearest even). Here, “biologically real” is operationalized as $k$-mers whose recurrence across the two independent halves exceeds the random-collision level predicted under the null.\n\nFor each test case below:\n- Extract all $k$-mers from each half by sliding a window of length $k$ across each read in that half.\n- Count $k$-mers within each half to determine $S_1$ and $S_2$.\n- Compute $N_1$, $N_2$, $M$, $\\lambda$, the one-sided $p$-value, the rejection decision at $\\alpha = 0.01$, and $\\widehat{f}$.\n\nTest suite (three cases):\n1. Case A (structured overlap, $k=5$). Reads (index $0$ to $3$): \n   - index $0$: \"ACGTTGCATG\"\n   - index $1$: \"GCATGTCAGT\"\n   - index $2$: \"TCAGTACGAT\"\n   - index $3$: \"ACGATGACCT\"\n   Use $k=5$.\n2. Case B (disjoint composition, $k=7$). Reads (index $0$ to $1$): \n   - index $0$: \"AACCAACCA\"\n   - index $1$: \"GGTTGGTTG\"\n   Use $k=7$.\n3. Case C (boundary with no $k$-mers, $k=5$). Reads (index $0$ to $3$): \n   - index $0$: \"ACGT\"\n   - index $1$: \"TGCA\"\n   - index $2$: \"GATC\"\n   - index $3$: \"CTAG\"\n   Use $k=5$.\n\nFinal output format:\n- Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. Each test case’s result should be a two-element list $[d, \\widehat{f}]$ where $d$ is a boolean and $\\widehat{f}$ is a float rounded to six decimal places. For example, a three-case output should look like \n  \"[[True,0.123456],[False,0.000000],[False,0.500000]]\".",
            "solution": "The problem posed is a well-defined exercise in computational statistics as applied to bioinformatics. It requires the implementation of a specific hypothesis test to distinguish between random sequencing errors and potentially genuine biological signals within DNA sequencing data. The problem statement is scientifically grounded, logically consistent, and provides all necessary parameters and definitions. It is therefore deemed valid. We shall proceed with the solution.\n\nThe core of the problem is a statistical comparison between two sets of unique, low-count substrings ($k$-mers), derived from two independent partitions of a DNA read dataset. The null hypothesis, $H_0$, posits that all $k$-mers occurring exactly once (singletons) in a data partition are the result of random sequencing errors. If this is true, the set of singleton $k$-mers $S_h$ for a given partition (half) $h$ can be modeled as a random sample of size $N_h = |S_h|$ drawn from the universe of all possible $k$-mers, of size $U = 4^k$.\n\nUnder this model of random sampling, the number of common elements, $M = |S_1 \\cap S_2|$, between the two singleton sets $S_1$ and $S_2$ is expected to be small. The problem specifies modeling this overlap count $M$ with a Poisson distribution. The rate parameter $\\lambda$ of this distribution represents the expected number of overlaps. It is derived as follows: for any given $k$-mer in $S_1$, the probability of it also being in $S_2$ (if $S_2$ were a random sample) is $p_{overlap} = N_2 / U$. Since there are $N_1$ such $k$-mers in $S_1$, the expected total number of overlaps is $\\mathbb{E}[M] = N_1 \\cdot p_{overlap} = N_1 N_2 / U$. Thus, we have the specified rate parameter $\\lambda = \\frac{N_1 N_2}{U}$.\n\nThe statistical test is a one-sided test on the observed overlap count $M$. A value of $M$ significantly larger than its expectation $\\lambda$ would provide evidence against the null hypothesis, suggesting that something other than random chance is causing the same singletons to appear in both independent partitions. We compute the $p$-value, which is the probability of observing an overlap count of $M$ or more, assuming $H_0$ is true. This is given by the survival function of the Poisson distribution:\n$$\np \\;=\\; \\mathbb{P}\\big[X \\ge M \\,\\big|\\, X \\sim \\mathrm{Poisson}(\\lambda)\\big] \\;=\\; \\sum_{i=M}^{\\infty} \\frac{e^{-\\lambda}\\lambda^i}{i!}\n$$\nIf this $p$-value is less than or equal to the significance level $\\alpha = 0.01$, we reject the null hypothesis.\n\nFinally, we are asked to estimate the fraction of \"biologically real\" singletons, $\\widehat{f}$. The quantity $M - \\lambda$ represents the number of observed overlaps in excess of what is expected by random chance. This excess is taken as an estimate for the number of true biological $k$-mers that are singletons in both partitions. The denominator, $|S| = |S_1 \\cup S_2|$, is the total number of unique singletons observed across both halves. The estimator is thus:\n$$\n\\widehat{f} \\;=\\; \\max\\!\\left(0,\\; \\frac{M - \\lambda}{|S|}\\right)\n$$\nThe $\\max(0, \\cdot)$ function ensures the fraction is non-negative, as a negative fraction is meaningless.\n\nWe now apply this procedure to each test case.\n\n**Case A:**\n1.  **Input:** $k=5$. Reads are partitioned into Half 1: `[\"ACGTTGCATG\", \"TCAGTACGAT\"]` and Half 2: `[\"GCATGTCAGT\", \"ACGATGACCT\"]`.\n2.  **$k$-mer Sets:** We extract all $5$-mers.\n    - Half 1 yields $12$ distinct $5$-mers, each with a count of $1$. Thus, $S_1$ contains these $12$ $k$-mers and $N_1 = 12$.\n    - Half 2 yields $12$ distinct $5$-mers, each with a count of $1$. Thus, $S_2$ contains these $12$ $k$-mers and $N_2 = 12$.\n3.  **Statistics:** The intersection is $S_1 \\cap S_2 = \\{$`\"GCATG\"`, `\"TCAGT\"`, `\"ACGAT\"`$\\}$, so $M = 3$. The total number of unique singletons is $|S| = |S_1 \\cup S_2| = N_1 + N_2 - M = 12 + 12 - 3 = 21$.\n4.  **Hypothesis Test:** The total number of possible $5$-mers is $U = 4^5 = 1024$. The Poisson rate is $\\lambda = \\frac{12 \\cdot 12}{1024} = \\frac{144}{1024} = 0.140625$. We compute the $p$-value for observing $M = 3$ overlaps from a $\\mathrm{Poisson}(0.140625)$ distribution:\n    $p = \\mathbb{P}[X \\ge 3] \\approx 0.000316$.\n    Since $p \\approx 0.000316 \\le 0.01$, we reject the null hypothesis. The decision is `True`.\n5.  **Estimator:** The fraction of real singletons is estimated as:\n    $\\widehat{f} = \\max\\left(0, \\frac{3 - 0.140625}{21}\\right) = \\frac{2.859375}{21} \\approx 0.1361607$. Rounded to six decimal places, $\\widehat{f} = 0.136161$.\n\n**Case B:**\n1.  **Input:** $k=7$. Reads are partitioned into Half 1: `[\"AACCAACCA\"]` and Half 2: `[\"GGTTGGTTG\"]`.\n2.  **$k$-mer Sets:** We extract all $7$-mers.\n    - Half 1 yields $3$ distinct $7$-mers, each with a count of $1$. So, $N_1 = 3$.\n    - Half 2 yields $3$ distinct $7$-mers, each with a count of $1$. So, $N_2 = 3$.\n3.  **Statistics:** The two sets of $k$-mers are disjoint. $S_1 \\cap S_2 = \\emptyset$, so $M = 0$. The total number of unique singletons is $|S| = N_1 + N_2 - M = 3 + 3 - 0 = 6$.\n4.  **Hypothesis Test:** The total number of possible $7$-mers is $U = 4^7 = 16384$. The Poisson rate is $\\lambda = \\frac{3 \\cdot 3}{16384} = \\frac{9}{16384} \\approx 0.000549$. We compute the $p$-value for observing $M = 0$:\n    $p = \\mathbb{P}[X \\ge 0] = 1$.\n    Since $p = 1 > 0.01$, we do not reject the null hypothesis. The decision is `False`.\n5.  **Estimator:** The fraction of real singletons is estimated as:\n    $\\widehat{f} = \\max\\left(0, \\frac{0 - 9/16384}{6}\\right) = 0$. Rounded to six decimal places, $\\widehat{f} = 0.000000$.\n\n**Case C:**\n1.  **Input:** $k=5$. The four reads, `[\"ACGT\", \"TGCA\", \"GATC\", \"CTAG\"]`, all have length $4$.\n2.  **$k$-mer Sets:** It is impossible to extract a substring of length $k=5$ from a string of length $4$. Therefore, both halves yield zero $k$-mers. $S_1 = \\emptyset$ and $S_2 = \\emptyset$.\n3.  **Statistics:** From the empty sets, we have $N_1 = 0$, $N_2 = 0$, $M = 0$, and $|S|=0$.\n4.  **Hypothesis Test:** The Poisson rate is $\\lambda = \\frac{0 \\cdot 0}{1024} = 0$. The problem defines that for the case $\\lambda = 0$ and $M=0$, we must set $p=1$.\n    Since $p = 1 > 0.01$, we do not reject the null hypothesis. The decision is `False`.\n5.  **Estimator:** The problem defines that if $|S|=0$, then $\\widehat{f}=0$. Therefore, $\\widehat{f} = 0.000000$.",
            "answer": "[[True,0.136161],[False,0.000000],[False,0.000000]]"
        }
    ]
}