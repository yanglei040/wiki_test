{
    "hands_on_practices": [
        {
            "introduction": "在比较两个基因组时，我们遇到的第一个基本问题是：我们观察到的相似性是具有生物学意义，还是仅仅是随机产生的？本练习将通过一个理想化的思想实验，带你深入探讨序列比对的统计学基础。你将推导出一个公式，用于计算在两个完全随机的基因组中，找到一个给定长度和相似度的“同源区块”的概率（$p$ 值），从而为理解 BLAST 等工具报告的期望值（E-value）和得分的统计意义奠定坚实的基础 。",
            "id": "2440822",
            "problem": "两个长度相等的基因组（长度为 $N$ 个核苷酸）在以下零模型下生成：在每个位置上，每个基因组独立地从字母表 $\\{A, C, G, T\\}$ 中均匀随机抽取一个核苷酸。仅考虑正向链（忽略反向互补和倒位）。对于任何一对起始索引 $(i, j)$（其中 $1 \\leq i \\leq N - L + 1$ 且 $1 \\leq j \\leq N - L + 1$），从每个基因组中各取一个长度为 $L$ 的连续子串，形成一个子串对，并计算它们的汉明距离。汉明距离定义为两个子串在对应位置上核苷酸不同的位置数。将长度为 $L$ 的“同线性区块”定义为任何这样一对正向链上的子串。设 $k$ 是一个满足 $0 \\leq k \\leq L$ 的整数。\n\n在所述的零模型下，并额外假设与不同起始索引对 $(i, j)$ 相关的事件是独立的，推导一个闭式解析表达式，用于计算在两个基因组之间观测到至少一个长度为 $L$、汉明距离至多为 $k$ 的同线性区块的概率值（p值）。你的最终答案必须是仅含 $N$、$L$ 和 $k$ 的单个表达式。不要代入数值。请用闭式解析表达式表示最终答案。无需单位。",
            "solution": "首先对问题陈述进行验证。\n\n**步骤1：提取已知条件**\n- 两个长度为 $N$ 个核苷酸的等长基因组。\n- 零模型：在每个位置，每个基因组独立地从字母表 $\\{A, C, G, T\\}$ 中均匀随机抽取一个核苷酸。\n- 仅考虑正向链。\n- 从起始索引 $(i, j)$（其中 $1 \\leq i \\leq N - L + 1$ 且 $1 \\leq j \\leq N - L + 1$）形成一对长度为 $L$ 的连续子串。\n- 两个子串之间的汉明距离是核苷酸不同的位置数。\n- “同线性区块”是一对长度为 $L$ 的正向链上的子串。\n- 给定一个整数 $k$，满足 $0 \\leq k \\leq L$。\n- 假设与不同起始索引对 $(i, j)$ 相关的事件是独立的。\n- 目标是推导一个闭式解析表达式，用于计算观测到至少一个长度为 $L$、汉明距离至多为 $k$ 的同线性区块的p值。\n\n**步骤2：使用提取的已知条件进行验证**\n该问题是生物信息学和计算统计学中一个定义明确的标准练习题。它在科学上基于序列比对和零模型下的统计显著性检验原理。零模型虽然是对生物学现实的简化，但其定义清晰且在数学上是可处理的。汉明距离、核苷酸均匀分布和p值的概念都是标准的。问题陈述提供了所有必要的信息和定义。问题明确指出了一个关键假设，即不同区块对之间的事件是独立的，这个假设虽然对于重叠区块来说在生物学上不现实，但它使问题变得可解且内部一致。问题没有矛盾、歧义或事实错误。该问题是可形式化的，并与其指定领域直接相关。\n\n**步骤3：结论与行动**\n问题被判定为有效。将推导解答。\n\n问题要求计算观测到至少一个长度为 $L$、汉明距离至多为 $k$ 的同线性区块对的概率。这是一个经典的“至少一次成功”问题，最有效的解法是计算其互补事件的概率——即*没有*这样的区块对存在——然后用 $1$ 减去该概率。\n\n设 $P_{hit}$ 为单个随机选择的长度为 $L$ 的同线性区块对的汉明距离 $H \\leq k$ 的概率。设 $M$ 为两个基因组之间可以形成的所有此类区块对的总数。问题陈述指出，每个区块对的事件是独立的。因此，所有 $M$ 个区块对都不满足标准（即，所有的汉明距离都 $H > k$）的概率是 $(1 - P_{hit})^M$。我们寻求的p值是至少有一次命中的概率，即：\n$$ p\\text{-value} = 1 - (1 - P_{hit})^M $$\n\n我们现在必须确定 $P_{hit}$ 和 $M$ 的表达式。\n\n首先，我们确定 $M$，即同线性区块对的总数。第一个基因组的长度为 $N$。长度为 $L$ 的区块的可能起始位置为 $i=1, 2, \\dots, N-L+1$。此类起始位置的数量为 $N-L+1$。同样，第二个基因组中长度为 $L$ 的区块的起始位置数量也是 $N-L+1$。由于第一个基因组中的任何区块都可以与第二个基因组中的任何区块配对，因此总的区块对数量为：\n$$ M = (N-L+1) \\times (N-L+1) = (N-L+1)^2 $$\n这假设 $N \\geq L$，这是长度为 $L$ 的区块存在的必要条件。\n\n接下来，我们确定 $P_{hit}$。这是一个区块对的汉明距离 $H$ 小于或等于 $k$ 的概率。汉明距离是错配的数量。我们可以用二项分布来对此建模。我们首先计算单个位置上发生错配的概率。\n\n字母表为 $\\Sigma = \\{A, C, G, T\\}$，因此其大小为 $|\\Sigma| = 4$。在零模型下，每个位置的每个核苷酸都是独立且均匀随机抽取的。任何特定核苷酸（例如‘A’）的概率为 $p_A = p_C = p_G = p_T = \\frac{1}{4}$。\n在给定位置上匹配的概率是两个序列具有相同核苷酸的概率。根据独立性：\n$$ P(\\text{match}) = \\sum_{n \\in \\Sigma} P(\\text{nuc}_1 = n \\text{ and } \\text{nuc}_2 = n) = \\sum_{n \\in \\Sigma} P(\\text{nuc}_1 = n) P(\\text{nuc}_2 = n) $$\n$$ P(\\text{match}) = 4 \\times \\left(\\frac{1}{4} \\times \\frac{1}{4}\\right) = 4 \\times \\frac{1}{16} = \\frac{1}{4} $$\n设 $p_m = P(\\text{match}) = \\frac{1}{4}$。因此，错配的概率 $p_{mm}$ 为：\n$$ p_{mm} = 1 - p_m = 1 - \\frac{1}{4} = \\frac{3}{4} $$\n一对区块的长度为 $L$。这 $L$ 个位置中的每一个都可以视为一次独立的伯努利试验，其中“成功”定义为一次错配。汉明距离 $H$ 是这 $L$ 次试验中错配的总数。因此，$H$ 服从参数为 $L$ 和 $p_{mm}$ 的二项分布：\n$$ H \\sim \\text{Binomial}(L, p_{mm}) $$\n观测到恰好 $d$ 次错配的概率由二项分布的概率质量函数给出：\n$$ P(H=d) = \\binom{L}{d} (p_{mm})^d (1-p_{mm})^{L-d} = \\binom{L}{d} \\left(\\frac{3}{4}\\right)^d \\left(\\frac{1}{4}\\right)^{L-d} $$\n概率 $P_{hit}$ 是汉明距离至多为 $k$ 的概率，即累积概率 $P(H \\leq k)$。这通过对 $d=0, 1, \\dots, k$ 的概率求和得到：\n$$ P_{hit} = P(H \\leq k) = \\sum_{d=0}^{k} P(H=d) = \\sum_{d=0}^{k} \\binom{L}{d} \\left(\\frac{3}{4}\\right)^d \\left(\\frac{1}{4}\\right)^{L-d} $$\n\n现在，我们将 $M$ 和 $P_{hit}$ 的表达式代入我们最初的p值公式中。\n$$ p\\text{-value} = 1 - (1 - P_{hit})^M = 1 - \\left(1 - \\sum_{d=0}^{k} \\binom{L}{d} \\left(\\frac{3}{4}\\right)^d \\left(\\frac{1}{4}\\right)^{L-d} \\right)^{(N-L+1)^2} $$\n这个表达式就是用给定参数 $N$、$L$ 和 $k$ 表示的闭式解。请注意，该求和是二项随机变量累积分布函数的标准表示，在此上下文中被视为闭式形式。",
            "answer": "$$\n\\boxed{1 - \\left(1 - \\sum_{d=0}^{k} \\binom{L}{d} \\left(\\frac{3}{4}\\right)^d \\left(\\frac{1}{4}\\right)^{L-d} \\right)^{(N-L+1)^2}}\n$$"
        },
        {
            "introduction": "现代全基因组比对工具通常不直接进行端到端的序列比对，而是采用一种更高效的“锚定-链化”策略。它们首先识别出两个基因组之间简短而高度保守的片段（锚点），然后将这些锚点连接成共线性的长链，以勾勒出宏观的同源区域。本练习将让你亲手实现锚点链算法的核心动态规划过程，并探索不同类型的间隔罚分（gap penalty）函数，例如仿射罚分 $c_{\\mathrm{aff}}(g)$ 和对数罚分 $c(g)$，如何影响最终同源链的构建，这对于理解和处理基因组间的插入、缺失等结构变异至关重要 。",
            "id": "2440835",
            "problem": "给定一个用于全基因组比对 (WGA) 的锚定链形式化模型。考虑一个由 $i \\in \\{1,\\dots,n\\}$ 索引的锚点集合，已按 $x$ 坐标排序 ($x_1  x_2  \\dots  x_n$)。每个锚点 $i$ 具有整数坐标 $(x_i, y_i)$ 和一个正权重 $w_i \\in \\mathbb{R}_{>0}$。一个链是锚点的一个子序列 $i_1  i_2  \\dots  i_k$，该子序列在 $y$ 坐标上也保持严格单调递增，即 $y_{i_1}  y_{i_2}  \\dots  y_{i_k}$。一个链的得分定义为所包含锚点权重的总和，减去连续锚点之间每次转换所付出的间隙罚分。对于链中的连续一对锚点 $(i, j)$，间隙长度定义为 $g(i,j) = (x_j - x_i - 1) + (y_j - y_i - 1)$。\n\n请考虑两种不同的间隙罚分函数：\n1. 非线性对数罚分：当 $g \\ge 1$ 时为 $c(g) = a + b \\log(g)$，当 $g=0$ 时为 $c(0)=0$。\n2. 仿射罚分：当 $g \\ge 1$ 时为 $c_{\\mathrm{aff}}(g) = \\alpha + \\beta g$，当 $g=0$ 时为 $c_{\\mathrm{aff}}(0)=0$。\n\n对于以下提供的四个测试用例，请使用动态规划计算在两种罚分模型下的最优链得分 $S_{\\mathrm{nl}}$ 和 $S_{\\mathrm{aff}}$，并报告它们的差值 $\\Delta = S_{\\mathrm{nl}} - S_{\\mathrm{aff}}$。将您的答案四舍五入到小数点后三位，并按顺序提供结果。\n\n**测试用例 1:**\n- 锚点: `[(1, 1, 2.0), (3, 3, 2.0), (4, 4, 1.0), (6, 6, 2.0)]`\n- 非线性参数 (a, b): `(1.0, 0.5)`\n- 仿射参数 (α, β): `(1.5, 0.4)`\n\n**测试用例 2:**\n- 锚点: `[(1, 1, 2.0), (2, 2, 2.0), (10, 10, 3.0), (11, 11, 2.0)]`\n- 非线性参数 (a, b): `(1.0, 0.5)`\n- 仿射参数 (α, β): `(1.5, 0.3)`\n\n**测试用例 3:**\n- 锚点: `[(1, 1, 3.0), (2, 3, 2.0), (3, 4, 2.0), (10, 11, 4.0)]`\n- 非线性参数 (a, b): `(0.0, 1.0)`\n- 仿射参数 (α, β): `(0.5, 0.2)`\n\n**测试用例 4:**\n- 锚点: `[(1, 1, 1.0), (5, 5, 5.0), (20, 20, 4.0)]`\n- 非线性参数 (a, b): `(0.8, 0.0)`\n- 仿射参数 (α, β): `(0.8, 0.15)`",
            "solution": "所提出的问题是计算生物学领域内一个明确定义的优化任务，具体涉及全基因组比对。它要求在两种不同的间隙罚分模型下，计算基因组锚定点的最高得分链。该问题具有科学依据，在数学上是一致的，并且其所有组成部分都得到了足够精确的说明。因此，这是一个有效的问题，可以使用成熟的算法技术来解决。\n\n问题的核心是找到一个最优的锚定点子序列（或链），以最大化一个得分函数。得分定义为链中锚定点的权重总和，并减去连续锚定点之间间隙的成本作为惩罚。这种结构是可用动态规划解决的问题的典型特征。\n\n设给定的锚定点从 $j=1$ 到 $n$ 进行索引。我们将 $S_j^*$ 定义为以锚定点 $j$ 结尾的链可能取得的最大得分。一个以锚定点 $j$ 结尾的链可以是以下两种类型之一：\n1. 只包含单个锚定点 $j$ 的链。这种链的得分是其权重 $w_j$。\n2. 通过将锚定点 $j$ 附加到一个以先前锚定点 $i$（其中 $1 \\le i  j$）结尾的较短最优链上形成的链。这种链的得分是：以 $i$ 结尾的最优链的得分（即 $S_i^*$），加上锚定点 $j$ 的权重，再减去锚定点 $i$ 和 $j$ 之间间隙的罚分。\n\n通过考虑所有可能的前驱 $i  j$，我们可以为 $S_j^*$ 建立一个递推关系。以 $j$ 结尾的链的最优得分是单个锚定点链 $\\{j\\}$ 的得分与从所有可能的前驱 $\\{i\\}$ 延伸而来的链的得分中的最大值。在数学上，这表示为：\n$$\nS_j^* = \\max \\left( w_j,\\; \\max_{1 \\le i  j} \\{ S_i^* + w_j - \\text{penalty}(i,j) \\} \\right)\n$$\n其中 `penalty(i,j)` 是与锚定点 $i$ 和 $j$ 之间间隙相关的成本。这个关系可以通过提取因子 $w_j$ 来重写：\n$$\nS_j^* = w_j + \\max \\left( 0,\\; \\max_{1 \\le i  j \\text{ and } y_i  y_j} \\{ S_i^* - \\text{penalty}(i,j) \\} \\right)\n$$\n最大化中的项 $0$ 对应于在锚定点 $j$ 处开始一个新链比延伸任何先前的链更有利的情况。这种情况发生在对于所有有效的前驱 $i$，得分 $S_i^*$ 都小于罚分 `penalty(i,j)`，从而使得延伸得分 $S_i^* - \\text{penalty}(i,j)$ 为负值。\n\n我们所寻求的任何可能链的总体最优得分，是所有以任意锚定点 $j \\in \\{1, \\dots, n\\}$ 结尾的最优链得分中的最大值。\n$$\nS_{\\text{optimal}} = \\max_{1 \\le j \\le n} \\{ S_j^* \\}\n$$\n\n为了实现这一点，我们可以从 $j=1$ 到 $n$ 迭代计算 $S_j^*$ 的值。一个大小为 $n$ 的一维数组（例如 `dp`）可以用来存储计算出的 $S_j^*$ 值。对于每个 $j$，我们遍历所有先前的索引 $i  j$ 来找到 $\\{S_i^* - \\text{penalty}(i,j)\\}$ 的最大值，该值决定了 $S_j^*$。这是一个时间复杂度为 $O(n^2)$ 的算法，对于测试用例中指定的小数量锚定点来说是高效的。\n\n`penalty(i,j)` 是基于间隙长度 $g(i,j) = (x_j - x_i - 1) + (y_j - y_i - 1)$ 计算的。给出了两个罚分函数：\n1. 非线性罚分：当 $g \\ge 1$ 时为 $c(g) = a + b \\log(g)$，当 $g=0$ 时为 $c(0) = 0$。\n2. 仿射罚分：当 $g \\ge 1$ 时为 $c_{\\mathrm{aff}}(g) = \\alpha + \\beta g$，当 $g=0$ 时为 $c_{\\mathrm{aff}}(0) = 0$。\n\n对于每个测试用例，该过程执行两次：一次使用非线性罚分函数 $c(g)$ 计算最优得分 $S_{\\mathrm{nl}}$，第二次使用仿射罚分函数 $c_{\\mathrm{aff}}(g)$ 计算 $S_{\\mathrm{aff}}$。然后计算差值 $\\Delta = S_{\\mathrm{nl}} - S_{\\mathrm{aff}}$。最终结果按要求四舍五入到 $3$ 位小数。",
            "answer": "```\n1.307\n1.536\n0.203\n3.050\n```"
        },
        {
            "introduction": "理论和算法最终要服务于解决真实的生物学问题。本练习将你置于一个复杂但非常实际的场景中：如何将一个单倍体真菌病原体的基因组与它的二倍体植物宿主的基因组进行比对。你需要综合运用关于比对算法、重复序列屏蔽、杂合性以及等位基因与旁系同源基因区分的知识，设计出一套稳健的分析策略。这不仅是对你技术能力的考验，更是对你作为计算生物学家制定研究方案、进行批判性思维能力的综合训练 。",
            "id": "2440880",
            "problem": "给定一个高质量的单倍体真菌病原体基因组组装，其总大小为 $S_{\\mathrm{fungus}} = 42\\,\\text{Mb}$，以及其植物宿主基因组的高质量组装。该植物组装代表一个二倍体 ($2n$) 个体，由两套重叠群（contigs）组成：一个主单倍型集 $P_1$ 和一个备用单倍型集 $P_2$，每个集合都几乎跨越了整个基因组。该植物基因组的估计杂合度为 $h \\approx 1.0\\%$，散在重复序列含量为 $r \\approx 55\\%$，而片段重复占组装长度的比例不到 $5\\%$。您的任务是生成真菌与植物之间的全基因组同线性区块，这些区块将用于量化基因顺序的保守性，并识别谱系特异性的重复和重排。具体来说，交付成果必须 (i) 避免将 $P_1$ 和 $P_2$ 中的等位基因拷贝计为旁系同源重复，(ii) 对重复序列具有鲁棒性，以及 (iii) 在单倍体和二倍体基因组之间适当地提供 $1$对$1$ 的共线性锚点。\n\n在所述约束条件下，以下哪种策略最适合构建这些同线性区块？\n\nA. 对植物基因组中的转座元件和简单重复序列进行软屏蔽或硬屏蔽，使用能容忍大约 $h$ 的分歧度的参数，将真菌组装分别与 $P_1$ 和 $P_2$ 进行全基因组比对，在每个单倍型上计算局部比对的共线性链，然后，对于每个真菌位点 $x$，在 $\\{P_1,P_2\\}$ 中选择一个得分最高的链（使用互惠最佳或得分优势标准）以合并等位基因匹配；最后，从保留的链中构建 $1$对$1$ 的同线性区块，并将剩余的 $1$对$k$ ($k \\ge 2$) 映射视为候选的旁系同源重复。\n\nB. 将 $P_1$ 和 $P_2$ 合并成一个单一的嵌合共有序列（例如，通过比对上的重叠群进行多数表决）以减少冗余，将真菌基因组与这个合并后的植物参考序列进行一次比对，并将真菌位点在植物内的任何次要比对解释为旁系同源。\n\nC. 使用短读长比对工具将真菌短读长序列映射到二倍体植物组装上，检测单核苷酸多态性 (SNPs)，并通过识别两个物种间 SNP 密度低的区域作为同线性区域，而 SNP 密度高的区域作为重排区域来推断同线性。\n\nD. 在计算机中（in silico）复制真菌基因组以创建一个大小为 $2 \\times S_{\\mathrm{fungus}}$ 的伪二倍体参考序列，仅将此复制的真菌参考序列与主单倍型 $P_1$ 进行比对，并将与每个植物位点最佳比对的两个真菌拷贝解释为代表两个植物单倍型；使用这些比对来定义同线性。\n\nE. 仅将分析限制在预测的编码序列上：将真菌蛋白质组与植物蛋白质组进行比对，通过互惠最佳匹配来定义直系同源基因，并仅根据直系同源基因的顺序来推断同线性，忽略非编码区、基因间区以及基因组坐标上的共线性约束。",
            "solution": "目标是根据全基因组比对和二倍体条件下同线性的基本原则推导出一个策略。同线性定义为基因组间基因顺序的保守性或直系同源位点的共线性。单倍体和二倍体组装之间的全基因组比对引入了一个特有的复杂问题：对于二倍体植物中每个真正的直系同源位点，可能存在两个等位基因拷贝，一个在单倍型 $P_1$ 上，另一个在 $P_2$ 上，它们的序列差异约为杂合度 $h \\approx 1.0\\%$。如果我们将一个单倍体查询序列与两个单倍型进行比对，每个真菌位点 $x$ 都可以产生两个高质量的比对，与 $P_1$ 的一致性为 $I_1(x)$，与 $P_2$ 的一致性为 $I_2(x)$。这些匹配是等位基因的，而不是旁系同源的。一个有原则的同线性构建必须 (i) 防止重复序列产生虚假的局部比对和链，通常通过屏蔽重复序列或使用能识别重复序列的种子（seeding）来实现；(ii) 允许序列分歧度高达约 $h$，以便两个等位基因都能被比对上；以及 (iii) 在构建 $1$对$1$ 共线性同线性区块之前，通过为每个真菌位点选择至多一个植物单倍型靶标来合并等位基因冗余。\n\n形式上，设 $\\mathcal{A}_1$ 和 $\\mathcal{A}_2$ 分别是真菌基因组与 $P_1$ 和 $P_2$ 进行重复序列屏蔽后的局部比对集。设 $\\mathcal{C}_1$ 和 $\\mathcal{C}_2$ 是在每个单倍型上通过最大化一致局部比对的加性得分 $S = \\sum_{i} w_i$ 计算出的共线性链，其中权重 $w_i$ 来自于匹配长度和一致性。对于每个真菌位点 $x$，将跨单倍型的最佳链定义为 $C^\\ast(x) = \\arg\\max\\{S(C) : C \\in \\mathcal{C}_1 \\cup \\mathcal{C}_2 \\text{ covering } x\\}$。仅保留 $C^\\ast(x)$ 以将两个等位基因靶标合并为一个代表性映射，可以选择性地强制执行互惠性，以确保所选的植物区间不能被另一个不同的真菌位点更好地解释。在这次合并之后，可以对链进行筛选（netted）以去除重叠，并将其转换为 $1$对$1$ 的同线性区块。在跨单倍型合并后，任何仍然具有 $1$对$k$ ($k \\ge 2$) 映射的真菌位点，都是由真正的重复而非等位基因现象引起的候选旁系同源基因。\n\n有了这个框架，我们可以评估各个选项：\n\nA. 这个选项明确包含了三个必要的原则。首先，它通过屏蔽转座元件来控制由重复序列驱动的噪声，这在重复序列含量高达 $r \\approx 55\\%$ 时至关重要。其次，它分别对 $P_1$ 和 $P_2$ 进行全基因组比对，参数容忍度约为 $h \\approx 1.0\\%$ 的分歧，确保两个等位基因都能被匹配上。第三，它通过为每个真菌位点在不同单倍型间选择一个得分最高的链 $C^\\ast(x)$ 来合并等位基因冗余，使用互惠最佳或得分优势标准，从而使 $P_1$ 和 $P_2$ 中的等位基因拷贝不会被重复计算。最后，它从保留的链中构建 $1$对$1$ 的同线性区块，并将剩余的 $1$对$k$ ($k \\ge 2$) 映射标记为候选的旁系同源性。这直接满足了 (i)、(ii) 和 (iii) 的要求，是合适的策略。结论 — 正确。\n\nB. 通过多数表决将 $P_1$ 和 $P_2$ 合并成一个单一的嵌合共有序列会破坏单倍型特异性的连锁信息（phase），并产生可能引入人为断点和错配的嵌合序列。与这样一个嵌合序列进行比对，会将分化的等位基因合并到单个轨迹中，并会导致真菌的次要比对被误解为旁系同源，这违反了避免将等位基因计为旁系同源基因的要求。它还有可能掩盖结构性杂合。结论 — 错误。\n\nC. 将真菌短读长序列映射到植物基因组并使用单核苷酸多态性 (SNP) 密度来定义同线性，混淆了物种内变异（植物内部杂合性）和物种间分歧。物种间的 SNP 密度不是一个有原则的共线性代表指标，而且短读长映射不适合替代具有不同基因组组织的物种间的全基因组比对。这不能产生 $1$对$1$ 的共线性锚点，也忽略了等位基因合并的要求。结论 — 错误。\n\nD. 在计算机中复制真菌基因组并不能模拟植物的等位基因现象。将一个复制的真菌参考序列仅与 $P_1$ 进行比对，无法捕捉到 $P_2$ 上的等位基因变异。此外，将与单个植物位点最佳比对的两个真菌拷贝解释为代表植物单倍型，颠倒了真实的生物学关系，并将查询序列中的重复与靶标序列中的等位基因现象混为一谈。这未能解决重复序列问题，也无法产生一个有效的 $1$对$1$ 同线性框架。结论 — 错误。\n\nE. 限制在编码序列和互惠最佳蛋白质匹配上可以找回直系同源基因，但丢弃了非编码区和基因间区的共线性，而这对稳健的同线性分析很重要，并且该方法对注释质量和基因移动高度敏感。它也没有明确解决跨 $P_1$ 和 $P_2$ 的等位基因合并问题。因此，它无法满足生成全基因组 $1$对$1$ 共线性锚点以及在重复序列背景下稳健区分等位基因现象和旁系同源性的要求。结论 — 错误。\n\n因此，在所述约束条件下，最合适的策略是选项A中描述的，即结合了重复序列控制和跨单倍型等位基因合并的、能识别单倍型的全基因组比对。",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}