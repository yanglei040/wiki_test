## 引言
[古DNA](@entry_id:142895)（aDNA）研究彻底改变了我们探索生命历史的方式，使我们能够直接从数万甚至数十万年前的生物遗骸中读取遗传信息。然而，这些古老的DNA分子并非完好无损。在生物体死亡后，DNA会经历缓慢而持续的降解过程，导致其高度片段化并积累大量的化学损伤。这一现象构成了[古基因组学](@entry_id:165899)研究中的核心矛盾：DNA损伤既是证实样本古老性的“黄金标准”，又是导致数据分析产生严重偏差的根本原因。如何准确地识别、量化并利用这些损伤模式，是从珍贵的古代样本中提取可靠生物学信息的关键所在。

本文旨在系统性地阐述古[DNA损伤](@entry_id:185566)的建模理论与实践。我们将超越将损伤视为单纯“噪音”的传统视角，揭示其作为信息源的丰富内涵。通过本文的学习，你将掌握从化学原理到计算应用的全套知识体系。在“原理与机制”一章中，我们将深入探讨DNA降解的化学基础，并介绍量化其特征（如片段化和$C \to T$替换）的数学模型。接着，在“应用与交叉学科联系”一章中，我们将展示这些模型如何在真实性认证、进化分析、古[表观遗传学](@entry_id:138103)乃至考古学和艺术史等领域发挥关键作用。最后，在“动手实践”部分，你将通过具体的编程练习，亲手实现损伤模式的量化、分析和校正，将理论知识转化为解决实际问题的能力。

## 原理与机制

在上一章中，我们介绍了[古DNA](@entry_id:142895)研究的广阔前景和独特挑战。现在，我们将深入探讨控制[古DNA](@entry_id:142895)存留、降解和分析的核心科学原理。本章的目标是系统性地阐述[古DNA](@entry_id:142895)降解的化学基础，描述其在测[序数](@entry_id:150084)据中呈现的特征性模式，并介绍用于量化、验证和利用这些模式的[计算模型](@entry_id:152639)。理解这些原理与机制，是准确解读古基因组数据、从珍贵样本中提取可靠生物学信息的基石。

### DNA降解的化学基础

生物体死亡后，其细胞内的DNA分子不再受到精密的细胞修复系统的保护，开始暴露在各种物理和化学应力之下。在数千至数万年的时间尺度上，主导DNA降解的是自发的水解反应。这些缓慢但持续的[化学变化](@entry_id:144473)，是塑造我们今天所能观察到的[古DNA](@entry_id:142895)分子特征的根本原因。

最重要的两种水解反应是**脱嘌呤（depurination）**和**胞嘧啶脱氨（cytosine deamination）**。

**脱嘌呤与[DNA片段化](@entry_id:170520)**
脱嘌呤是DNA糖苷键（N-glycosidic bond）的水解断裂，导致嘌呤碱基（腺嘌呤A或鸟嘌呤G）从脱氧核糖骨架上脱落，形成一个**脱碱基位点（abasic site, AP site）**。虽然脱嘧啶（depyrimidination）也会发生，但其速率远低于脱嘌呤。脱碱基位点在化学上极不稳定，它会迅速导致磷酸二酯键骨架的断裂。

这一过程对[古DNA](@entry_id:142895)产生了最直观的影响：**片段化（fragmentation）**。可以设想，在漫长的地质时期中，DNA链上随机发生着独立的骨架断裂事件。如果我们将这些断裂事件建模为一个泊松过程（Poisson process），其在每对碱基上的发生率为 $\beta$，那么最终产生的DNA片段长度[分布](@entry_id:182848)将遵循指数分布。一个长度为 $l$ 的片段的[概率密度](@entry_id:175496)可以表示为：
$$
p(l) = \beta \exp(-\beta l)
$$
这个模型的直接推论是，绝大多数[古DNA](@entry_id:142895)片段都非常短，通常平均长度在50-100个碱基对（bp）之间，并且很少有超过150 bp的片段。这种偏向极短片段的长度[分布](@entry_id:182848)，是[古DNA](@entry_id:142895)样本真实性的一个关键标志，与现代DNA在提取过程中因机械剪切产生的较长且[分布](@entry_id:182848)更均匀的片段形成鲜明对比。

**胞嘧啶脱氨与错码损伤**
第二种关键的水解反应是胞嘧啶（C）的[脱氨作用](@entry_id:170839)，它会将胞嘧啶转化为尿嘧啶（U）。在活细胞中，尿嘧啶会被DNA修复酶识别并移除。但在死后样本中，这些尿嘧啶会累积下来。在古[DNA测序](@entry_id:140308)文库的扩增过程中（例如PCR），[DNA聚合酶](@entry_id:147287)会将尿嘧啶识别为[胸腺](@entry_id:182637)嘧啶（T）。因此，原始序列中的一个C碱基，在最终的测序读段（read）中会表现为一个T碱基。这就是[古DNA](@entry_id:142895)中最具特征性的**错码损伤（miscoding lesion）**：$C \to T$ 替换。

### 古[DNA损伤](@entry_id:185566)的[特征模式](@entry_id:747279)

源于上述化学过程，古[DNA测[](@entry_id:140308)序数](@entry_id:150084)据呈现出两种标志性特征：极短的片段长度和末端富集的碱基替换。

**片段长度[分布](@entry_id:182848)**
如前所述，由于脱嘌呤等反应导致的[DNA骨架](@entry_id:166241)随机断裂，真实的[古DNA](@entry_id:142895)文库呈现出一种向短片段严重倾斜的长度[分布](@entry_id:182848)，这可以被指数分布很好地近似。这是区别于现代DNA污染（通常片段更长）的首要特征。

**碱基错码损伤图谱**
胞嘧啶脱氨反应在单链DNA（ssDNA）中发生的[速率比](@entry_id:164491)在双链DNA（dsDNA）中高出一到两个[数量级](@entry_id:264888)。[古DNA](@entry_id:142895)片段的末端常常因为磨损而形成单链悬垂（single-stranded overhangs）。因此，脱氨损伤主要集中在这些悬垂区域。

当我们将测序[读段比对](@entry_id:265329)到[参考基因组](@entry_id:269221)上时，这种损伤模式表现为：
- 在读段的**5'端**，我们观察到大量的 $C \to T$ 替换。
- 由于DNA的双链互补性，原始DNA分子另一条链的5'端悬垂（对应于测序读段的3'端）上的鸟嘌呤（G）如果位于一个胞嘧啶对面，其互补链上的胞嘧啶脱氨会使该链的G在测序中呈现为腺嘌呤（A）。因此，在读段的**3'端**，我们观察到大量的 $G \to A$ 替换。

这种替换频率随离[末端距](@entry_id:175986)离增加而迅速衰减的模式，可以通过所谓的**损伤图谱（damage plot）**进行可视化。损伤图谱是[古DNA](@entry_id:142895)真实性的“黄金标准”，伪造这种模式极其困难。

值得注意的是，不同的化学过程会留下不同的损伤指纹。例如，脱嘌呤过程本身除了导致断裂，还可能在聚合酶复制时导致错误掺入。当聚合酶遇到一个脱嘌呤位点时，它倾向于优先插入一个腺嘌呤（A），这被称为“A规则”（A-rule）。这意味着，如果原始碱基是鸟嘌呤（G），脱嘌呤后可能导致一个 $G \to A$ 的替换。通过统计比较不同类型替换（如 $G \to A$ 与 $C \to T$）的频率，并结合统计模型选择方法（如[似然比检验](@entry_id:268070)），研究者可以推断特定样本中哪种损伤机制占主导地位。

### 损伤模式的量化建模

为了在分析中客观地使用这些损伤特征，我们需要将它们形式化为数学模型。

**片段化模型**
如前所述，片段长度 $L$ 的[分布](@entry_id:182848)通常被建模为[指数分布](@entry_id:273894) $p(L) = \beta \exp(-\beta L)$，其中 $\beta$ 是每碱基对的断裂率。更复杂的模型可能会考虑断裂率并非在所有基因组位置都恒定。例如，DNA的断裂速率可能受局部[核苷酸](@entry_id:275639)组成（如[GC含量](@entry_id:275315)）的影响。我们可以将断裂率建模为[GC含量](@entry_id:275315) $c$ 的函数，例如 $\lambda(c) = \lambda_0 + \alpha c$。在这种情况下，要计算整个文库的性质，就需要对 $c$ 的[分布](@entry_id:182848)进行积分平均。

**末端损伤模型**
末端富集的 $C \to T$ 和 $G \to A$ 替换频率，可以被一个指数衰减函数很好地描述。在距离5'端（或3'端）为 $d$ 的位置，发生特定损伤替换的概率 $P(d)$ 可以建模为：
$$
P(d) = \mu + \delta \exp(-\rho d)
$$
其中，$\mu$ 代表背景错误率（包括测序错误和非末端损伤），$\delta$ 是末端损伤的额外振幅（即在第1个碱基处发生损伤的概率），$\rho$ 是损伤概率随距离衰减的速率。这个模型简洁地捕捉了损伤图谱的核心特征。

研究者有时也会设计专门的**摘要统计量**来捕捉损伤图谱的特定方面。例如，为了量化5'端 $C \to T$ 损伤和3'端 $G \to A$ 损伤之间的不对称性，可以定义一个加权比率统计量 $\Psi$。这种量化使得比较不同样本或不同处理条件下的损伤模式成为可能。

### 损伤模型的应用

对古DNA损伤的精确建模不仅仅是为了鉴定样本真伪，它在下游的生物学分析中也扮演着至关重要的角色。

**样本真实性评估与污染区分**
损伤特征是区分内源性[古DNA](@entry_id:142895)与现代DNA污染的有力工具。我们可以构建一个贝叶斯分类框架来正式评估一个DNA片段的来源。例如，对于一个给定的DNA片段，我们可以根据其**片段长度 $L$** 和是否在**末端观察到 $C \to T$ 损伤**这两个特征，计算其来自古代来源（A）的后验概率。根据贝叶斯定理，该[后验概率](@entry_id:153467)为：
$$
P(A \mid L, \text{损伤}) = \frac{P(\text{损伤} \mid A) f_A(L) P(A)}{P(\text{损伤} \mid A) f_A(L) P(A) + P(\text{损伤} \mid M) f_M(L) P(M)}
$$
其中，$P(A)$ 是先验概率， $f_A(L)$ 和 $f_M(L)$ 分别是古代和现代DNA的长度[分布](@entry_id:182848)模型（如指数分布），$P(\text{损伤} \mid A)$ 和 $P(\text{损伤} \mid M)$ 是在古代和现代DNA上观察到损伤的概率。这个公式将多个证据来源整合在一起，提供了一个量化的、概率性的真实性评估。

**缓解分析中的偏见**
古DNA损伤会引入碱基替换，如果不对其进行处理，会被错误地解读为真实的生物学变异。更严重的是，它会导致**参考基因组偏见（reference bias）**。当一个携带非参考等位基因的[古DNA](@entry_id:142895)[读段比对](@entry_id:265329)到参考基因组时，它本身就至少有一个错配。如果这个读段同时还带有损伤引起的 $C \to T$ 错配，它的总错配数就会增加，导致比对得分降低，甚至可能无法成功比对。这会使得非参考等位基因在比对后的数据中被低估，从而影响群体遗传学等分析的准确性。

为了解决这个问题，研究者开发了生化和计算两种策略：
1.  **UDG处理**：使用**[尿嘧啶DNA糖基化酶](@entry_id:187473)（Uracil-DNA Glycosylase, UDG）**可以在文库构建过程中特异性地切除尿嘧啶，从而消除大部分 $C \to T$ 损伤。**完全UDG处理（full UDG）**能有效去除损伤、降低转换/[颠换](@entry_id:270979)比率（Ti/Tv ratio），并显著减轻参考偏见。然而，它也移除了作为真实性标志的损伤信号。作为折中，**部分UDG处理（partial UDG, pUDG）**被设计用于去除片段内部的损伤，同时保留末端1-2个碱基的损伤信号，实现了真实性评估和偏见缓解的平衡。
2.  **损伤感知的统计模型**：另一种策略是在计算层面解决问题。我们可以构建能够区分真实变异、损伤和测序错误的[统计模型](@entry_id:165873)。例如，在计算一个[二倍体](@entry_id:268054)位点的**基因型似然（genotype likelihood）**时，标准的模型只考虑测序错误。而一个损伤感知的模型会为 $C \to T$（或 $G \to A$）的损伤过程引入一个独立的概率项 $d_i$。对于一个给定的观测碱基 $x_i$，其源于真实碱基 $a$ 的概率需要综合考虑未发生损伤和发生损伤两种情况，并对两条[染色体](@entry_id:276543)上的等位基因进行平均。这种方法能够更准确地估计基因型，尤其是在低覆盖度的[古DNA](@entry_id:142895)数据中。此外，研究者还开发了基于似然比的**PMD分数（PMD score）**，用于评估每个读段与预期损伤模式的匹配程度，并据此过滤掉可能是污染的读段。

### 高级应用：重建古代[表观基因组](@entry_id:272005)

古[DNA损伤](@entry_id:185566)不仅是一个需要校正的麻烦，它本身也蕴含着宝贵的生物学信息，最引人注目的例子就是**古代甲基化组（methylome）**的重建。

这个方法的原理在于胞嘧啶（C）和其甲基化形式——[5-甲基胞嘧啶](@entry_id:193056)（5mC）——在脱氨后会产生不同的产物：
- 未甲基化的胞嘧啶（C）脱氨后变成尿嘧啶（U）。
- [5-甲基胞嘧啶](@entry_id:193056)（5mC）脱氨后变成[胸腺](@entry_id:182637)嘧啶（T）。

[UDG酶](@entry_id:195124)只能识别并切除尿嘧啶（U），但对[胸腺](@entry_id:182637)嘧啶（T）[无能](@entry_id:201612)为力。这一生化差异为我们区分C和5mC提供了可能。通过比较**UDG处理**和**非UDG处理**的文库，我们可以推断原始DNA的甲基化状态：
- 在**非UDG文库**中，C $\to$ U和5mC $\to$ T两种损伤最终都被读为 $C \to T$ 替换。在CpG位点观察到的总 $C \to T$ 频率 $f_{\mathrm{CpG}}$ 是两种信号的混合：$f_{\mathrm{CpG}} \approx m \cdot \alpha + (1-m) \cdot \beta$，其中 $m$ 是甲基化水平，$\alpha$ 和 $\beta$ 分别是5mC和C的脱氨率。
- 在**UDG处理的文库**中，C $\to$ U信号被清除了，因此观察到的 $C \to T$ 频率几乎完全来自5mC $\to$ T的转换：$f_{\mathrm{CpG}} \approx m \cdot \alpha$。

为了求解这些方程，我们需要估计背景脱氨率 $\beta$。在哺乳动物的大多数体细胞中，CpG位点外的胞嘧啶（即CpH位点，H=A, C, T）甲基化水平极低。因此，我们可以利用CpH位点的 $C \to T$ 频率来估计 $\beta$。这种巧妙的设计，将古DNA损伤从一个噪音源转变为探索古代[基因调控](@entry_id:143507)和[表观遗传](@entry_id:186440)的强大工具。

### 综合框架：[古DNA](@entry_id:142895)读段的生成模型

最后，我们可以将本章讨论的所有原理和机制整合到一个统一的**[生成模型](@entry_id:177561)（generative model）**中，该模型可以模拟产生古DNA测序读段的全过程。这不仅是理解各组分如何协同作用的绝佳方式，也是开发复杂推断算法的基础。一个完整且真实的[生成模型](@entry_id:177561)通常遵循以下因果顺序：

1.  **来源抽样**：首先，根据一个污染比例 $\pi$，决定该片段是来自内源性古基因组还是现代污染源基因组。
2.  **片段化**：从选定的源基因组中，根据一个[概率分布](@entry_id:146404)（如[几何分布](@entry_id:154371)，作为连续指数分布的离散模拟）抽取片段的长度 $L$，并随机选择其在基因组上的起始位置 $X$。
3.  **模板提取**：根据 $L$ 和 $X$ 从源基因组中提取出原始的、未损伤的DNA序列模板 $\mathbf{B}$。
4.  **施加死后损伤**：根据末端[指数衰减模型](@entry_id:634765)，在模板序列 $\mathbf{B}$ 的每个位置上，以特定的概率施加 $C \to T$ 和 $G \to A$ 损伤，生成一个携带损伤的模板序列 $\mathbf{M}$。
5.  **模拟测序过程**：最后，根据测序仪每个循环的Phred质量分数 $Q_i$（定义了错误率 $e_i = 10^{-Q_i/10}$），在损伤模板 $\mathbf{M}$ 的每个碱基上引入测序错误，最终生成我们观测到的读段序列 $\mathbf{R}$。

这个[生成模型](@entry_id:177561)清晰地展示了从古生物遗骸中的DNA分子到我们计算机屏幕上的测序数据的完整旅程。它囊括了片段化、化学损伤、污染和技术误差等所有核心要素，为我们理解和分析复杂的[古DNA](@entry_id:142895)数据提供了坚实的理论框架。