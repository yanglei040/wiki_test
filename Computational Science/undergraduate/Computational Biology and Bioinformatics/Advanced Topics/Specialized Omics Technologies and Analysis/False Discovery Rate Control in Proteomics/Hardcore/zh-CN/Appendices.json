{
    "hands_on_practices": [
        {
            "introduction": "要想真正理解为何错误发现率（FDR）控制在蛋白质组学中不可或缺，我们首先从一个基础计算开始。这个练习将要求你计算在一个典型的大规模实验中，如果简单地采用 $p \\lt 0.05$ 这个常见的统计阈值，会产生多少预期的假阳性结果。通过这个思想实验，你将对多重检验问题获得一个具体的认识，并亲眼见证为何我们需要更复杂的统计方法来确保蛋白质鉴定的可靠性。",
            "id": "2389430",
            "problem": "对一份人类细胞裂解液进行了鸟枪法自下而上蛋白质组学数据库搜索。对于参考数据库中的每一个蛋白质条目，都会进行一次假设检验，输出一个针对“该蛋白质不存在”这一零假设的、经过校准的逐蛋白 $p$ 值。参考数据库包含 $20{,}100$ 个不同的蛋白质条目。在该实验的真实情况中，样本中确实存在 $3{,}100$ 种蛋白质；其余条目对应不存在的蛋白质。假设逐蛋白检验是有效且独立的，并且在零假设下，$p$ 值独立同分布于 $\\mathrm{Uniform}(0,1)$。一位分析师简单地将一个蛋白质声明为已鉴定，如果其报告的 $p$ 值满足 $p  0.05$。\n\n仅使用以上信息和基本原理，计算在这种简单的阈值设定下，假阳性蛋白质鉴定的期望数量。请以一个不带单位的实数报告你的答案。不要四舍五入。",
            "solution": "问题陈述已经过严格验证，被认为是有效的。它具有科学依据、问题良定、客观，并包含推导出唯一解所需的所有信息。其前提在统计生物信息学领域中用于分析蛋白质组学数据是标准的。我们现在可以开始求解。\n\n令 $M$ 表示参考数据库中不同蛋白质条目的总数。根据问题陈述，我们有 $M = 20,100$。\n令 $S$ 为样本中真实存在的蛋白质数量。我们有 $S = 3,100$。\n数据库中剩余的蛋白质是真实不存在的。对于这些蛋白质，“蛋白质不存在”的零假设为真。令 $M_0$ 为这类蛋白质的数量。\n$$M_0 = M - S = 20,100 - 3,100 = 17,000$$\n如果一个蛋白质相关的 $p$ 值小于给定阈值 $\\alpha$，则该蛋白质被声明为已鉴定。问题指定此阈值为 $\\alpha = 0.05$。\n当一个真实不存在的蛋白质（即 $M_0$ 个蛋白质中的一个）被错误地声明为存在时，就发生了“假阳性”鉴定。如果一个真实不存在的蛋白质的 $p$ 值小于 $\\alpha$，就会发生这种情况。\n\n我们被要求计算假阳性蛋白质鉴定的期望数量。让我们用随机变量 $V$ 表示假阳性的总数。\n对于 $M_0$ 个真实不存在的蛋白质中的每一个，我们定义一个指示随机变量 $X_i$，其中 $i = 1, 2, \\dots, M_0$。\n$$\nX_i = \n\\begin{cases} \n1  \\text{如果蛋白质 } i \\text{ 是一个假阳性} \\\\\n0  \\text{否则} \n\\end{cases}\n$$\n假阳性的总数 $V$ 是对所有零假设为真的蛋白质的这些指示变量求和：\n$$V = \\sum_{i=1}^{M_0} X_i$$\n我们要求解 $V$ 的期望，记为 $E[V]$。根据期望的线性性，我们有：\n$$E[V] = E\\left[\\sum_{i=1}^{M_0} X_i\\right] = \\sum_{i=1}^{M_0} E[X_i]$$\n一个指示变量的期望是它所指示事件的概率。因此，对于每个 $i$：\n$$E[X_i] = P(X_i = 1)$$\n当第 $i$ 个零假设蛋白质的 $p$ 值（我们称之为 $p_i$）满足 $p_i  \\alpha$ 时，事件 $X_i=1$ 发生。\n$$E[X_i] = P(p_i  \\alpha)$$\n问题陈述指出，在零假设下，蛋白质的 $p$ 值独立同分布于 $\\mathrm{Uniform}(0,1)$。\n对于一个随机变量 $P \\sim \\mathrm{Uniform}(0,1)$，其概率密度函数 (PDF) 为当 $p \\in [0, 1]$ 时 $f(p) = 1$，否则 $f(p) = 0$。概率 $P(P  \\alpha)$ 由 PDF 从 $0$ 到 $\\alpha$ 的积分给出：\n$$P(P  \\alpha) = \\int_{0}^{\\alpha} f(p) \\,dp = \\int_{0}^{\\alpha} 1 \\,dp = [p]_{0}^{\\alpha} = \\alpha$$\n因此，对于 $M_0$ 个零假设蛋白质中的每一个，其成为假阳性的概率是 $\\alpha$。\n$$E[X_i] = \\alpha = 0.05 \\quad \\text{对于所有 } i=1, \\dots, M_0$$\n由于所有 $M_0$ 个蛋白质的期望 $E[X_i]$ 都相同，我们可以写出：\n$$E[V] = \\sum_{i=1}^{M_0} \\alpha = M_0 \\cdot \\alpha$$\n代入 $M_0$ 和 $\\alpha$ 的已知值：\n$$E[V] = 17,000 \\times 0.05$$\n$$E[V] = 17,000 \\times \\frac{5}{100} = 170 \\times 5 = 850$$\n因此，假阳性蛋白质鉴定的期望数量是 $850$。这个结果直接源于 $p$ 值的定义及其在零假设下的理论分布性质。在 $\\alpha$ 处进行简单的阈值设定，会导致期望有 $M_0 \\cdot \\alpha$ 个错误发现，这是多重假设检验中的一个基本概念。",
            "answer": "$$\\boxed{850}$$"
        },
        {
            "introduction": "明确了FDR控制的必要性之后，我们现在来探究蛋白质组学中的主流方法——目标-诱饵策略（target-decoy strategy）的内部机制。本练习探讨了一个关键的理论特性：在固定的FDR水平下，改变诱饵数据库的大小对鉴定到的肽段数量有何影响？通过分析所提供的数学模型，你将揭示为何经过适当校正的目标-诱饵方法具有稳健性，无论使用多少诱饵都能提供稳定的结果。",
            "id": "2389468",
            "problem": "在鸟枪法蛋白质组学实验中，通过将串联质谱与级联的目标-伪迹数据库进行比对来鉴定肽谱匹配（PSM），以控制假发现率（FDR）。令伪迹多样性为 $m$，定义为每个目标条目对应的伪迹条目数。在得分阈值为 $\\tau$ 时，令 $T_m(\\tau)$ 表示接受的目标PSM数量，$D_m(\\tau)$ 表示接受的伪迹PSM数量。在阈值 $\\tau$ 处的估计FDR定义为\n$$\n\\widehat{\\mathrm{FDR}}_{m}(\\tau) \\equiv \\frac{D_{m}(\\tau)}{m\\,T_{m}(\\tau)}.\n$$\n假设标准的目标-伪迹建模假设：对于每个 $\\tau$，无效（不正确）的匹配在目标和每个伪迹条目之间是可交换的，并且独立于 $m$，而真实目标PSM的得分分布不受 $m$ 的影响。在这些假设下，存在函数 $S(\\tau)$（得分至少为 $\\tau$ 的真实目标PSM数量）和 $F(\\tau)$（得分至少为 $\\tau$ 的错误目标PSM数量），使得在期望上，\n$$\n\\mathbb{E}[T_{m}(\\tau)] = S(\\tau) + F(\\tau), \\quad \\mathbb{E}[D_{m}(\\tau)] = m\\,F(\\tau).\n$$\n对于一个固定的目标FDR水平 $q = 0.01$（以小数表示），将选择阈值 $\\tau_m$ 定义为满足 $\\widehat{\\mathrm{FDR}}_m(\\tau_m) \\le q$ 的最大阈值。\n\n您首先在每个目标对应 $m=1$ 个伪迹的情况下进行搜索，并相应地选择 $\\tau_1$。然后，您在每个目标对应 $m=2$ 个伪迹的情况下重复搜索，并相应地选择 $\\tau_2$。在上述假设下，计算乘法因子\n$$\nR \\equiv \\frac{\\mathbb{E}[T_{2}(\\tau_{2})]}{\\mathbb{E}[T_{1}(\\tau_{1})]}.\n$$\n将您的最终答案表示为一个不带单位的实数。无需四舍五入。",
            "solution": "目标是确定当选择阈值设定为将假发现率（FDR）控制在固定水平 $q=0.01$ 时，将伪迹条目数量加倍如何影响接受的目标肽谱匹配（PSM）的期望数量。\n\n根据在阈值 $\\tau$ 和伪迹多样性为 $m$ 时估计的假发现率的定义，\n$$\n\\widehat{\\mathrm{FDR}}_{m}(\\tau) = \\frac{D_{m}(\\tau)}{m\\,T_{m}(\\tau)}.\n$$\n在所述假设下，存在独立于 $m$ 的函数 $S(\\tau)$ 和 $F(\\tau)$，使得在期望上\n$$\n\\mathbb{E}[T_{m}(\\tau)] = S(\\tau) + F(\\tau), \\quad \\mathbb{E}[D_{m}(\\tau)] = m\\,F(\\tau).\n$$\n因此，在阈值 $\\tau$ 处的期望估计FDR为\n$$\n\\mathbb{E}\\big[\\widehat{\\mathrm{FDR}}_{m}(\\tau)\\big] = \\mathbb{E}\\!\\left[\\frac{D_{m}(\\tau)}{m\\,T_{m}(\\tau)}\\right].\n$$\n利用期望的比例性（以及 $S(\\tau)$ 和 $F(\\tau)$ 不依赖于 $m$ 的事实），我们分析通过代入期望得到的确定性对应部分：\n$$\n\\frac{\\mathbb{E}[D_{m}(\\tau)]}{m\\,\\mathbb{E}[T_{m}(\\tau)]} = \\frac{m\\,F(\\tau)}{m\\,(S(\\tau) + F(\\tau))} = \\frac{F(\\tau)}{S(\\tau) + F(\\tau)}.\n$$\n这个表达式与 $m$ 无关。选择阈值 $\\tau_m$ 被定义为满足 $\\widehat{\\mathrm{FDR}}_m(\\tau) \\le q$ 的最大 $\\tau$。在期望上，该标准变为\n$$\n\\frac{F(\\tau)}{S(\\tau) + F(\\tau)} \\le q,\n$$\n这不涉及 $m$。因此，满足期望FDR约束的阈值对于所有 $m$ 都是相同的，即，\n$$\n\\tau_2 = \\tau_1 \\quad \\text{(in expectation)}.\n$$\n在这个共同的阈值下，接受的目标PSM的期望数量是\n$$\n\\mathbb{E}[T_{m}(\\tau_{m})] = S(\\tau_{m}) + F(\\tau_{m}),\n$$\n这也与 $m$ 无关。因此，\n$$\nR \\equiv \\frac{\\mathbb{E}[T_{2}(\\tau_{2})]}{\\mathbb{E}[T_{1}(\\tau_{1})]} = \\frac{S(\\tau_{1}) + F(\\tau_{1})}{S(\\tau_{1}) + F(\\tau_{1})} = 1.\n$$\n因此，理论上并且在期望中，当基于伪迹的FDR估计器被伪迹多样性 $m$ 适当缩放时，将伪迹条目数量加倍并不会改变在固定FDR下接受的目标PSM数量。",
            "answer": "$$\\boxed{1}$$"
        },
        {
            "introduction": "真正的专家不仅知道如何使用工具，更懂得其局限性。最后的这个练习将通过评估一个有缺陷的实验设计，挑战你对目标-诱饵方法核心假设的批判性思维。通过思考使用来自远缘物种的“伪诱饵”数据库这一情景，你将学会识别当方法的基本原则被违背时出现的那些微妙但严重的陷阱，从而增强你正确设计和解读蛋白质组学实验的能力。",
            "id": "2389441",
            "problem": "您正在计划对人类细胞裂解物进行一次鸟枪法液相色谱-串联质谱实验，并希望在肽谱匹配（PSM）水平上控制假发现率（FDR）。一位同事建议，不要使用传统的反向或随机化伪库，而是将完整的酿酒酵母（Saccharomyces cerevisiae）蛋白质组附加到人类参考蛋白质组中，并将酵母视为“伪诱饵库”（pseudo-decoy），通过靶标-伪库竞争来估计和控制FDR。假设采用标准特异性的胰蛋白酶消化，典型的质量容差，并且酵母蛋白质组在蛋白质数量上大约是人类蛋白质组的 $1/3$。请考虑数据库搜索的一般行为：不正确的PSM倾向于分布在可用的肽段搜索空间中，并且一些胰蛋白酶肽段在远缘物种之间是保守的。没有提供明确的公式，您必须从第一性原理（FDR的定义和基于伪库估计的特性）进行推理。\n\n以下哪项陈述最能描述一个合理的实验设计以及这种“伪诱饵库”方法的严重缺陷？选择所有适用选项。\n\nA. 使用远缘物种的“伪诱饵库”作为唯一的伪库，打破了靶标-伪库竞争的“等机会”前提，因为伪诱饵库的肽段空间和组成与人类靶标不同。如果伪诱饵库远小于靶标库，那么在不正确的匹配中观察到的伪诱饵库PSM数量将大致与搜索空间大小成比例减少，这会倾向于低估PSM水平的FDR，除非应用了明确且准确的搜索空间缩放校正。\n\nB. 由于人类和酵母之间的一些胰蛋白酶肽段是保守的或高度相似的，一部分真实的人类谱图可能会与酵母条目获得最高分，并在竞争中被标记为伪库匹配。这会用真实的信号夸大伪诱饵库的匹配数量，导致FDR估计过于保守，并损失灵敏度。\n\nC. 一个更具说服力的设计是，为组合的靶标（人类）和“诱捕”（entrapment，酵母）数据库保留一个标准的反向（或随机化）伪库，使用这些合成伪库通过传统的靶标-伪库竞争来控制PSM水平的FDR，然后使用分配给酵母靶标的已接受PSM的比例，作为FDR的经验性“诱捕”校准检查。这提供了一种检测由数据库或打分不匹配引起的校准错误的方法。\n\nD. 使用酵母作为伪诱饵库消除了蛋白质推断的模糊性，因为在典型的质量容差内，人类和酵母不共享任何质量相同的胰蛋白酶肽段，因此共享肽段问题不再出现。\n\nE. 如果酵母数据库大约比人类数据库小 $3$ 倍，那么将FDR估计为酵母匹配数与人类匹配数之比的 $3$ 倍，可以保证无偏的FDR估计，因为仅数据库大小就决定了伪库的行为，而与序列组成和同源肽段无关。",
            "solution": "问题陈述描述了一种用于蛋白质组学中假发现率（FDR）控制的方法，该方法建议用一个源自远缘物种酿酒酵母（*Saccharomyces cerevisiae*）蛋白质组的“伪诱饵库”来替代标准的合成伪库（例如，反向序列库），用于分析人类样本。必须根据靶标-伪库竞争（TDC）的基本原则来评估这个提议。\n\n用于FDR估计的TDC核心原则是，对于任何一个并非源自样本中真实肽段的实验谱图（即零假设情况），其与靶标数据库中序列匹配的概率等于其与伪库中序列匹配的概率。为了实现这一“等机会”前提，标准的伪库构建时应与靶标库具有相同的大小、氨基酸组成和母离子质量分布。这通常通过反向或随机化靶标蛋白质的序列来实现。所提出的方法在几个关键方面违反了这一基本前提。\n\n设 $T$ 表示人类靶标数据库，$D_{pseudo}$ 表示酵母“伪诱饵”数据库。样本仅含有人类肽段。\n\n$1$. **数据库大小和组成不匹配**：问题陈述指出，酵母蛋白质组在蛋白质数量上大约是人类蛋白质组的 $\\frac{1}{3}$，这意味着其肽段搜索空间显著更小，即 $|D_{pseudo}| \\approx \\frac{1}{3} |T|$。由于错误的肽谱匹配（PSM）被假定为在可用的肽段搜索空间中大致随机分布，一个错误的谱图在较大的人类数据库中找到虚假匹配的可能性大约是在较小的酵母数据库中的 $3$ 倍。此外，酵母的氨基酸组成及由此产生的胰蛋白酶肽段特性（如长度、电荷、疏水性）也与人类不同。这意味着针对酵母肽段的错误匹配的得分分布将与针对人类肽段的错误匹配不同。大小和组成的差异都打破了TDC的“等机会”前提。\n\n$2$. **保守肽段的存在**：进化上保守的蛋白质（例如，组蛋白、肌动蛋白、代谢酶）在人类和酵母之间共享相同或几乎相同的胰蛋白酶肽段序列。来自一个在酵母中保守的人类肽段的真实谱图，可以与酵母肽段序列高分匹配。在竞争性搜索中，如果与酵母肽段的匹配是得分最高的匹配，那么这个来自人类样本的真实信号将被错误地归类为“伪库”匹配。\n\n基于这些原则，我们评估每个选项。\n\n**A. 使用远缘物种的“伪诱饵库”作为唯一的伪库，打破了靶标-伪库竞争的“等机会”前提，因为伪诱饵库的肽段空间和组成与人类靶标不同。如果伪诱饵库远小于靶标库，那么在不正确的匹配中观察到的伪诱饵库PSM数量将大致与搜索空间大小成比例减少，这会倾向于低估PSM水平的FDR，除非应用了明确且准确的搜索空间缩放校正。**\n\n该陈述正确且精确地描述了主要缺陷之一。它正确地指出，数据库大小和组成的差异打破了TDC的基本“等机会”前提。由于 $|D_{pseudo}|  |T|$，在伪诱饵库中找到的零匹配数 $N_{D_{pseudo}}$ 将按比例小于在靶标库中找到的零匹配数 $N_{T, \\text{FP}}$。若不加校正地使用 $N_{D_{pseudo}}$ 作为靶标列表中假阳性数 $N_{T, \\text{FP}}$ 的估计量，将导致对真实FDR的严重低估。例如，一个简单的估计可能是 $\\text{FDR}_{\\text{est}} = N_{D_{pseudo}} / N_T$，而真实的FDR更接近于 $(|T|/|D_{pseudo}|) \\times (N_{D_{pseudo}} / N_T)$。这种低估会使得数量多到无法接受的假阳性通过筛选。\n**结论：正确。**\n\n**B. 由于人类和酵母之间的一些胰蛋白酶肽段是保守的或高度相似的，一部分真实的人类谱图可能会与酵母条目获得最高分，并在竞争中被标记为伪库匹配。这会用真实的信号夸大伪诱饵库的匹配数量，导致FDR估计过于保守，并损失灵敏度。**\n\n该陈述准确地描述了第二个主要陷阱。来自在酵母中保守的人类肽段的真实信号可能被错误地归类为伪库匹配。这夸大了观察到的伪诱饵库匹配数 $N_{D_{pseudo}}$。当这个被夸大的数字被用于FDR计算的分子时（例如 $\\text{FDR} \\propto N_{D_{pseudo}}$），对于任何给定的得分阈值，得到的FDR都会被高估。为了达到一个目标FDR（例如 $1\\%$），就需要应用一个比实际需要严格得多的得分阈值。这会丢弃许多低于这个被人为抬高的阈值的真阳性PSM，从而导致灵敏度损失（即正确的鉴定数量减少）。因此，该估计过于保守。\n**结论：正确。**\n\n**C. 一个更具说服力的设计是，为组合的靶标（人类）和“诱捕”（entrapment，酵母）数据库保留一个标准的反向（或随机化）伪库，使用这些合成伪库通过传统的靶标-伪库竞争来控制PSM水平的FDR，然后使用分配给酵母靶标的已接受PSM的比例，作为FDR的经验性“诱捕”校准检查。这提供了一种检测由数据库或打分不匹配引起的校准错误的方法。**\n\n该陈述描述了一种有效且强大的质量控制方法，称为“诱捕数据库”（entrapment database）法。在这种设计中，酵母数据库不被用作*伪库*，而是作为*靶标*数据库中已知为阴性的部分。为“人类+酵母”的组合靶标数据库创建一个合适的合成伪库（例如，反向库）。这允许使用标准的TDC进行有效的FDR计算。在目标FDR（例如 $1\\%$）下筛选PSM后，可以对分配给酵母肽段的已接受匹配进行计数。由于样本中不含酵母蛋白，所有这些匹配根据定义都是假阳性。这些“诱捕匹配”在所有已接受匹配中的比率，可作为对实际FDR的经验性测量。如果该经验比率接近目标FDR，则结果可信度高。如果差异显著，则表明分析存在问题，需要进行调查。这是一个优秀且可靠的实验设计。\n**结论：正确。**\n\n**D. 使用酵母作为伪诱饵库消除了蛋白质推断的模糊性，因为在典型的质量容差内，人类和酵母不共享任何质量相同的胰蛋白酶肽段，因此共享肽段问题不再出现。**\n\n这个陈述在事实上是错误的。其核心前提，“人类和酵母不共享任何质量相同的胰蛋白酶肽段”，是错误的。许多基础蛋白质在真核生物中高度保守，导致大量相同或同量异位（isobaric）的胰蛋白酶肽段。因此，共享肽段问题（该问题使从已鉴定肽段推断蛋白质的过程变得复杂）并未被消除，甚至可能因为向搜索空间中添加了大量同源蛋白质而加剧。\n**结论：错误。**\n\n**E. 如果酵母数据库大约比人类数据库小 $3$ 倍，那么将FDR估计为酵母匹配数与人类匹配数之比的 $3$ 倍，可以保证无偏的FDR估计，因为仅数据库大小就决定了伪库的行为，而与序列组成和同源肽段无关。**\n\n该陈述为数据库大小差异提出了一个简单的校正方法，$\\text{FDR}_{\\text{est}} = 3 \\times (N_{D_{pseudo}} / N_T)$。虽然对大小进行校正是朝正确方向迈出的一步，但该陈述提出了两个致命的强硬论断。首先，它断言这种校正“保证了无偏的FDR估计”。这是错误的，因为它忽略了另外两个关键的混杂因素：($1$) 人类和酵母之间序列组成的差异，这会影响零匹配的得分分布；以及 ($2$) 如选项B所述，由于保守的真实人类肽段导致酵母匹配数量的膨胀，这会使估计向相反方向产生偏差。这些相互竞争的偏差的净效应是未知的，并且肯定不能保证是无偏的。其次，它错误地声称“仅数据库大小就决定了伪库的行为”。这是一个严重的过度简化，与TDC的原则相矛盾。\n**结论：错误。**",
            "answer": "$$\\boxed{ABC}$$"
        }
    ]
}