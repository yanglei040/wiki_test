{
    "hands_on_practices": [
        {
            "introduction": "在宏基因组学中，尤其是基于16S rRNA基因扩增子测序的研究中，我们获得的原始读数（read counts）并不总是能直接反映微生物群落中各种细菌的真实细胞丰度。一个关键的混杂因素是不同物种基因组中16S rRNA操纵子的拷贝数不同。这个练习将指导您完成一个基础但至关重要的计算，通过应用校正因子来解释这种拷贝数变异，从而获得对群落组成的更准确估计 。掌握这种数据校正方法是进行可靠的下游分析（如α-多样性计算）的必备技能。",
            "id": "2405533",
            "problem": "在一个包含四个细菌分类单元的单一样本16S核糖体核糖核酸（rRNA）扩增子数据集中，设分类单元 $i$ 的观测读取计数为 $n_i$，每个基因组的16S rRNA操纵子拷贝数为 $c_i$。假设一个抽样模型，其中期望的读取计数满足 $n_i \\propto a_i \\, c_i$，其中 $a_i$ 是分类单元 $i$ 的真实细胞丰度。定义一个应用于每个分类单元的乘法校正因子 $f_i$，在将观测计数 $n_i$ 转换为相对丰度之前应用于它们，目标是在所述模型下，得到的相对丰度与 $a_i$ 成正比。使用您选择的 $f_i$ 和以下数据，计算校正后组成的香农多样性指数 $H'$，其中 $H' = -\\sum_{i=1}^{4} p_i \\ln p_i$，$p_i$ 是校正后的相对丰度，$\\ln$ 是自然对数。\n\n样本包含：\n- 分类单元 $1$：观测读取数 $n_1 = 4800$，16S拷贝数 $c_1 = 1$。\n- 分类单元 $2$：观测读取数 $n_2 = 3200$，16S拷贝数 $c_2 = 2$。\n- 分类单元 $3$：观测读取数 $n_3 = 1600$，16S拷贝数 $c_3 = 4$。\n- 分类单元 $4$：观测读取数 $n_4 = 400$，16S拷贝数 $c_4 = 8$。\n\n使用自然对数（单位为奈特）报告 $H'$。将最终数值答案四舍五入到四位有效数字。在最终的方框答案中不要包含单位。",
            "solution": "首先必须验证问题陈述的科学合理性、完整性和客观性。\n\n**步骤1：提取已知条件**\n- 系统由一个包含4个细菌分类单元的单一样本组成。\n- 分类单元 $i$ 的观测读取计数为 $n_i$。\n- 分类单元 $i$ 的16S rRNA操纵子拷贝数为 $c_i$。\n- 分类单元 $i$ 的真实细胞丰度为 $a_i$。\n- 给定一个抽样模型：$n_i \\propto a_i \\, c_i$。\n- 应用一个乘法校正因子 $f_i$ 于 $n_i$ 以获得校正后的计数 $n'_i = f_i n_i$。\n- 校正的目标是使得到的校正后计数与真实细胞丰度成正比：$n'_i \\propto a_i$。\n- 香农多样性指数定义为 $H' = -\\sum_{i=1}^{4} p_i \\ln p_i$，其中 $p_i$ 是校正后的相对丰度。\n- 提供的数据如下：\n  - 分类单元 $1$：$n_1 = 4800$，$c_1 = 1$。\n  - 分类单元 $2$：$n_2 = 3200$，$c_2 = 2$。\n  - 分类单元 $3$：$n_3 = 1600$，$c_3 = 4$。\n  - 分类单元 $4$：$n_4 = 400$，$c_4 = 8$。\n- $H'$ 的最终答案需要使用自然对数计算，并四舍五入到四位有效数字。\n\n**步骤2：使用提取的已知条件进行验证**\n- **科学依据：** 该问题基于16S rRNA基因扩增子测序分析中一个标准且公认的问题：由可变操纵子拷贝数引入的偏差。模型 $n_i \\propto a_i \\, c_i$ 是对这种偏差的一个简化但基本正确的表示。校正方法和香农多样性指数的使用是计算生物学和微生物生态学中的标准程序。该问题具有科学合理性。\n- **适定性：** 该问题提供了得出唯一解所需的所有必要数据和定义。选择校正因子 $f_i$ 的指令受到结果丰度必须与 $a_i$ 成正比的条件约束，这唯一地确定了 $f_i$ 的函数形式。\n- **客观性：** 问题陈述使用了精确、定量和无偏见的语言。\n\n**步骤3：结论与行动**\n该问题被认为是有效的，因为它具有科学依据、适定、客观和完整。将推导解答。\n\n**解答推导**\n问题要求我们在校正16S rRNA基因拷贝数变异后，计算一个细菌群落的香农多样性指数 $H'$。\n\n首先，我们必须确定校正因子 $f_i$ 的形式。\n观测读取计数的模型以比例关系给出：\n$$n_i \\propto a_i \\, c_i$$\n我们可以用一个比例常数 $k$ 将其表示为一个方程，该常数假定在样本中的所有分类单元中是统一的：\n$$n_i = k \\, a_i \\, c_i$$\n校正后的计数 $n'_i$ 是通过将乘法因子 $f_i$ 应用于观测计数 $n_i$ 得到的：\n$$n'_i = f_i \\, n_i$$\n代入 $n_i$ 的表达式，我们得到：\n$$n'_i = f_i \\, (k \\, a_i \\, c_i)$$\n问题要求这些校正后的计数与真实细胞丰度 $a_i$ 成正比：\n$$n'_i \\propto a_i$$\n为了使这个比例关系成立，在 $n'_i$ 的表达式中乘以 $a_i$ 的项必须在所有分类单元中是常数。即：\n$$f_i \\, k \\, c_i = \\text{常数}$$\n由于 $k$ 已经是常数，这可以简化为：\n$$f_i \\, c_i = \\text{常数}$$\n这意味着校正因子 $f_i$ 必须与拷贝数 $c_i$ 成反比：\n$$f_i \\propto \\frac{1}{c_i}$$\n校正因子的最简单和最直接的选择是将其设置为拷贝数的倒数。任何其他选择，例如对于某个常数 $\\lambda$ 的 $f_i = \\lambda/c_i$，都会导致校正后的计数 $n'_i$ 按 $\\lambda$ 缩放，但这个缩放因子在计算相对丰度时会被抵消。因此，我们选择：\n$$f_i = \\frac{1}{c_i}$$\n校正后的计数 $n'_i$ 现在与真实细胞丰度 $a_i$ 成正比，计算如下：\n$$n'_i = \\frac{n_i}{c_i}$$\n使用提供的数据：\n- 对于分类单元 $1$：$n'_1 = \\frac{n_1}{c_1} = \\frac{4800}{1} = 4800$\n- 对于分类单元 $2$：$n'_2 = \\frac{n_2}{c_2} = \\frac{3200}{2} = 1600$\n- 对于分类单元 $3$：$n'_3 = \\frac{n_3}{c_3} = \\frac{1600}{4} = 400$\n- 对于分类单元 $4$：$n'_4 = \\frac{n_4}{c_4} = \\frac{400}{8} = 50$\n\n接下来，我们通过对各个校正后的计数求和来计算总校正计数 $N'$：\n$$N' = \\sum_{i=1}^{4} n'_i = 4800 + 1600 + 400 + 50 = 6850$$\n然后通过将每个校正后的计数 $n'_i$ 除以总校正计数 $N'$ 来计算校正后的相对丰度 $p_i$：\n$$p_i = \\frac{n'_i}{N'}$$\n- $p_1 = \\frac{4800}{6850} = \\frac{480}{685} = \\frac{96}{137}$\n- $p_2 = \\frac{1600}{6850} = \\frac{160}{685} = \\frac{32}{137}$\n- $p_3 = \\frac{400}{6850} = \\frac{40}{685} = \\frac{8}{137}$\n- $p_4 = \\frac{50}{6850} = \\frac{5}{685} = \\frac{1}{137}$\n我们验证相对丰度之和为$1$：$\\frac{96+32+8+1}{137} = \\frac{137}{137} = 1$。\n\n最后，我们使用公式 $H' = -\\sum_{i=1}^{4} p_i \\ln p_i$ 计算香农多样性指数 $H'$：\n$$H' = -\\left( p_1 \\ln p_1 + p_2 \\ln p_2 + p_3 \\ln p_3 + p_4 \\ln p_4 \\right)$$\n代入 $p_i$ 的值：\n$$H' = -\\left( \\frac{96}{137} \\ln\\left(\\frac{96}{137}\\right) + \\frac{32}{137} \\ln\\left(\\frac{32}{137}\\right) + \\frac{8}{137} \\ln\\left(\\frac{8}{137}\\right) + \\frac{1}{137} \\ln\\left(\\frac{1}{137}\\right) \\right)$$\n我们现在数值计算这个表达式：\n- $\\frac{96}{137} \\ln\\left(\\frac{96}{137}\\right) \\approx (0.70073) \\times (-0.35567) \\approx -0.249214$\n- $\\frac{32}{137} \\ln\\left(\\frac{32}{137}\\right) \\approx (0.23358) \\times (-1.45424) \\approx -0.339714$\n- $\\frac{8}{137} \\ln\\left(\\frac{8}{137}\\right) \\approx (0.05839) \\times (-2.84055) \\approx -0.165859$\n- $\\frac{1}{137} \\ln\\left(\\frac{1}{137}\\right) \\approx (0.00730) \\times (-4.91998) \\approx -0.035915$\n\n将这些项相加：\n$$\\sum p_i \\ln p_i \\approx -0.249214 - 0.339714 - 0.165859 - 0.035915 = -0.790702$$\n因此，香农多样性指数为：\n$$H' = -(-0.790702) = 0.790702$$\n根据要求将结果四舍五入到四位有效数字，我们得到 $0.7907$。",
            "answer": "$$\n\\boxed{0.7907}\n$$"
        },
        {
            "introduction": "在获得了能准确反映群落组成的丰度数据后，下一步通常是量化样本内部的物种多样性，即α-多样性。香农指数（Shannon index）和辛普森指数（Simpson index）是两种最常用的α-多样性度量指标，但它们对群落结构的不同方面各有侧重。这个练习将通过一个精心设计的计算实验，让您亲手揭示这两种指数的核心差异 。您将通过编程模拟向群落中添加稀有物种的过程，并观察这对两种指数值的影响，从而直观地理解它们在衡量物种丰富度（richness）和均匀度（evenness）方面的不同敏感性。",
            "id": "2405536",
            "problem": "在16S核糖体RNA（16S rRNA）扩增子数据或全基因组鸟枪法数据的宏基因组分析中，样本内的多样性通常通过基于观测到的分类单元的经验相对丰度的指数来总结。考虑一个由非负整数读数计数有限列表 $\\mathbf{c} = [c_1,c_2,\\dots,c_S]$ 表示的群落，其总数为 $N = \\sum_{i=1}^{S} c_i$，相应的相对丰度为 $p_i = c_i / N$，其中 $i \\in \\{1,\\dots,S\\}$。将香农指数（自然对数）定义为 $H = -\\sum_{i=1}^{S} p_i \\ln p_i$，将辛普森集中度指数定义为 $D = \\sum_{i=1}^{S} p_i^2$。少量额外稀有分类单元的流入会增加丰富度，同时对均匀度的改变极小。\n\n您必须编写一个程序，通过将指定整数数量的读数 $m$ 从一个指定的现有分类单元重新分配到 $k$ 个新的分类单元，每个新分类单元恰好接收 $m/k$ 个读数，从而为每个提供的基线群落构建一个确定性的合成扰动，以使总读数计数保持不变。对于给定的测试用例，其参数为 $(\\mathbf{c}, j, m, k)$，其中 $j$ 是一个基于1的索引，用于标识要移出读数的现有分类单元，扰动后的群落 $\\mathbf{c}'$ 通过以下方式获得：\n- 将 $c_j$ 替换为 $c_j - m$。\n- 追加 $k$ 个新的分类单元，每个的计数为 $m/k$。\n- 保持所有其他计数不变。\n\n假设 $m$ 和 $k$ 是正整数，且 $k$ 能整除 $m$，并且 $c_j \\ge m$，以确保所有计数保持非负。对于每个测试用例，计算扰动前后的 $H$ 和 $D$，并报告陈述 $\\lvert H' - H \\rvert > \\lvert D' - D \\rvert$ 的布尔值，其中 $H'$ 和 $D'$ 是 $\\mathbf{c}'$ 的指数，而 $H$ 和 $D$ 是 $\\mathbf{c}$ 的指数。\n\n请使用以下测试套件，它涵盖了一系列真实的宏基因组组成和扰动：\n- 测试用例A（不均匀的类扩增子群落）：$\\mathbf{c} = [7000,2000,800,150,50]$，$j = 1$，$m = 100$，$k = 10$。\n- 测试用例B（均匀群落）：$\\mathbf{c} = [2000,2000,2000,2000,2000]$，$j = 1$，$m = 100$，$k = 10$。\n- 测试用例C（高度优势的类鸟枪法群落）：$\\mathbf{c} = [9500,500]$，$j = 1$，$m = 50$，$k = 50$。\n- 测试用例D（最小单稀有分类单元添加）：$\\mathbf{c} = [999,1]$，$j = 1$，$m = 1$，$k = 1$。\n\n所有对数必须是自然对数，所有计算都是无量纲的。您的程序必须生成单行输出，其中包含按A、B、C、D顺序排列的测试用例的布尔结果，形式为逗号分隔的列表并用方括号括起来（例如， $[{\\tt True},{\\tt False},{\\tt True},{\\tt True}]$）。所需的最终输出是布尔值，不应打印任何其他文本。",
            "solution": "我们通过一个具有读数计数 $\\mathbf{c} = [c_1,\\dots,c_S]$ 和总数 $N=\\sum_{i=1}^{S} c_i$ 的有限分类单元集合来模拟一个微生物群落。分类单元 $i$ 的经验相对丰度是 $p_i = c_i/N$。香农指数是 $H = -\\sum_{i=1}^{S} p_i \\ln p_i$，它源于信息论，是 $\\{p_i\\}$ 导出的分类分布的熵。辛普森集中度指数是 $D = \\sum_{i=1}^{S} p_i^2$，表示从相对丰度分布中不放回抽取（但近似为独立抽取）的两个独立读数属于同一分类单元的概率；它强调丰度高的分类单元，因为平方运算会增加大的 $p_i$ 的权重。\n\n为了形式化增加丰富度的扰动，我们固定整数 $m>0$ 和 $k>0$ 以及一个基于1的索引 $j \\in \\{1,\\dots,S\\}$，该索引标识源分类单元。我们通过从 $c_j$ 中减去 $m$ 并追加 $k$ 个新的分类单元（每个计数为 $m/k$）来构建 $\\mathbf{c}'$。这保持了总计数不变 $N' = N - m + k \\cdot (m/k) = N$。新的相对丰度为 $p'_i = c'_i/N$。因为每个新分类单元的概率质量为 $f/k$（其中 $f = m/N$），当 $f$ 很小时，它们对 $H$ 和 $D$ 的贡献很小，反映了其稀有性。\n\n为了比较敏感度，定义香农指数的绝对变化为 $\\Delta_H = \\lvert H' - H \\rvert$，辛普森集中度指数的绝对变化为 $\\Delta_D = \\lvert D' - D \\rvert$。从分析上看，当一部分质量 $f$ 从一个概率为 $p_j$ 的分类单元均匀地转移到 $k$ 个新分类单元时，一阶近似给出：\n- $\\Delta_D \\approx 2 f p_j$（主导项来自 $p_j^2$ 的导数），\n- $\\Delta_H \\approx f \\left[\\ln\\!\\left(\\frac{p_j k}{f}\\right) + 1 \\right]$（来自供体分类单元的 $-p \\ln p$ 的导数以及 $k$ 个新分类单元增加的熵）。\n对于小的 $f$ 和中等的 $k$，对数项 $\\ln(p_j k / f)$ 通常很大，因此 $\\Delta_H$ 常常超过 $\\Delta_D$，这表明香农指数对稀有分类单元比辛普森集中度指数更敏感。\n\n我们现在通过以下步骤，从第一性原理为指定的测试套件精确计算这些量：\n- 通过 $p_i = c_i/N$ 将整数计数转换为概率。\n- 按定义计算 $H$ 和 $D$。\n- 应用确定性扰动 $(\\mathbf{c}, j, m, k) \\mapsto \\mathbf{c}'$，其中 $c'_j = c_j - m$ 并追加 $k$ 个计数等于 $m/k$ 的项。\n- 重新计算 $H'$ 和 $D'$ 并评估布尔值 $\\Delta_H > \\Delta_D$。\n\n对于每个测试用例：\n- 测试用例A使用 $\\mathbf{c} = [7000,2000,800,150,50]$，$N = 7000 + 2000 + 800 + 150 + 50 = 10000$，其中 $j = 1$，$m = 100$，$k = 10$。这里 $f = m/N = 100/10000 = 0.01$。扰动从最丰富的分类单元中移出读数，并创建10个稀有分类单元。\n- 测试用例B使用 $\\mathbf{c} = [2000,2000,2000,2000,2000]$，$N = 10000$，$j = 1$，$m = 100$，$k = 10$，表示一个均匀群落受到相同的扰动。\n- 测试用例C使用 $\\mathbf{c} = [9500,500]$，$N = 10000$，$j = 1$，$m = 50$，$k = 50$，即 $f = 0.005$ 并且添加了许多单例。\n- 测试用例D使用 $\\mathbf{c} = [999,1]$，$N = 1000$，$j = 1$，$m = 1$，$k = 1$，添加一个单一的新稀有分类单元。\n\n在所有情况下，计算结果均为 $\\Delta_H > \\Delta_D$，这与香农指数对因稀有分类单元引起的丰富度变化比辛普森集中度指数更敏感的原理相一致。程序将精确实现这些定义和转换，使用自然对数，并以要求的单行格式输出 $[{\\tt True},{\\tt True},{\\tt True},{\\tt True}]$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef shannon_index(probabilities: np.ndarray) -> float:\n    # Compute H = -sum p_i ln p_i with natural logarithm\n    p = probabilities\n    # Mask to avoid log(0); by construction we will not have zeros for present taxa\n    mask = p > 0\n    return float(-np.sum(p[mask] * np.log(p[mask])))\n\ndef simpson_concentration(probabilities: np.ndarray) -> float:\n    # Compute D = sum p_i^2\n    p = probabilities\n    return float(np.sum(p * p))\n\ndef to_probabilities(counts: np.ndarray) -> np.ndarray:\n    total = np.sum(counts)\n    return counts.astype(float) / float(total)\n\ndef perturb_counts(counts: np.ndarray, j_one_based: int, m: int, k: int) -> np.ndarray:\n    # Deterministic perturbation: subtract m from taxon j (1-based), append k taxa with m/k each\n    counts = counts.astype(int).copy()\n    j = j_one_based - 1  # convert to 0-based index\n    if m % k != 0:\n        raise ValueError(\"m must be divisible by k\")\n    if counts[j]  m:\n        raise ValueError(\"Insufficient counts to debit m from selected taxon\")\n    counts[j] -= m\n    # Append k new taxa, each with m/k counts\n    new_counts = np.concatenate([counts, np.full(k, m // k, dtype=int)])\n    return new_counts\n\ndef evaluate_case(counts_list, j_idx, m, k) -> bool:\n    counts = np.array(counts_list, dtype=int)\n    p_before = to_probabilities(counts)\n    H_before = shannon_index(p_before)\n    D_before = simpson_concentration(p_before)\n\n    counts_after = perturb_counts(counts, j_idx, m, k)\n    p_after = to_probabilities(counts_after)\n    H_after = shannon_index(p_after)\n    D_after = simpson_concentration(p_after)\n\n    delta_H = abs(H_after - H_before)\n    delta_D = abs(D_after - D_before)\n\n    return delta_H > delta_D\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each case: (counts_list, j_one_based, m, k)\n    test_cases = [\n        ([7000, 2000, 800, 150, 50], 1, 100, 10),   # Test case A\n        ([2000, 2000, 2000, 2000, 2000], 1, 100, 10),  # Test case B\n        ([9500, 500], 1, 50, 50),                   # Test case C\n        ([999, 1], 1, 1, 1),                        # Test case D\n    ]\n\n    results = []\n    for counts_list, j_idx, m, k in test_cases:\n        result = evaluate_case(counts_list, j_idx, m, k)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        },
        {
            "introduction": "宏基因组分析的威力不仅在于描述单个样本，更在于比较不同环境或状态下的微生物群落，例如比较健康个体与患者的肠道菌群。这种样本间的比较分析被称为β-多样性分析。本练习将聚焦于β-多样性分析的基石——Bray-Curtis相异度（Bray-Curtis dissimilarity） 。您将通过编写代码，从零开始实现Bray-Curtis相异度的计算公式，并将其应用于一系列典型的假设场景，包括两个群落完全相同、完全不同以及存在一个超高丰度物种等情况。这个过程将加深您对该度量如何量化群落差异的理解，并揭示优势物种如何影响最终的比较结果。",
            "id": "2405539",
            "problem": "给定两个非负整数值的群落丰度向量，它们代表了通过16S核糖体核糖核酸（rRNA）基因扩增子测序或鸟枪法宏基因组测序获得的特定分类单元的读数计数。对于两个群落，其丰度向量为 $\\mathbf{x} = (x_1, x_2, \\dots, x_K)$ 和 $\\mathbf{y} = (y_1, y_2, \\dots, y_K)$，它们基于相同的 $K$ 个分类单元的有序列表，Bray–Curtis相异度 $D_{\\mathrm{BC}}(\\mathbf{x}, \\mathbf{y})$ 定义为\n$$\nD_{\\mathrm{BC}}(\\mathbf{x}, \\mathbf{y}) = \\frac{\\sum_{i=1}^{K} \\lvert x_i - y_i \\rvert}{\\sum_{i=1}^{K} (x_i + y_i)} \\, .\n$$\n这个量是无量纲的，当分母不为零时，其值位于闭区间 $[0,1]$ 内。\n\n请编写一个完整的程序，使用上述定义，为以下每个测试群落对计算Bray–Curtis相异度。对于每一对，每个群落向量都基于相同的固定分类单元顺序指定。所有条目均为非负整数，代表读数计数。\n\n测试套件（每一项都是一对 $(\\mathbf{x}, \\mathbf{y})$）：\n- 案例A（一般情况）：$\\mathbf{x} = (12, 3, 0, 5)$ 和 $\\mathbf{y} = (10, 5, 0, 3)$。\n- 案例B（相同群落）：$\\mathbf{x} = (7, 0, 4)$ 和 $\\mathbf{y} = (7, 0, 4)$。\n- 案例C（分类单元间组成不相交）：$\\mathbf{x} = (0, 9, 0, 0)$ 和 $\\mathbf{y} = (0, 0, 0, 9)$。\n- 案例D（一个群落无观测读数，而另一个有）：$\\mathbf{x} = (0, 0, 0)$ 和 $\\mathbf{y} = (5, 0, 0)$。\n- 案例E（超高丰度的共享生物占主导）：$\\mathbf{x} = (10000, 1, 1, 1)$ 和 $\\mathbf{y} = (10000, 0, 2, 1)$。\n\n对于每个案例，请完全按照给定的公式计算 $D_{\\mathrm{BC}}(\\mathbf{x}, \\mathbf{y})$。如果分母 $\\sum_{i=1}^{K} (x_i + y_i)$ 等于 $0$，则相异度未定义；所提供的测试案例均不属于这种未定义情况。\n\n最终输出格式：您的程序应生成单行输出，其中包含案例A到E的结果，按顺序排列，为四舍五入到恰好 $6$ 位小数的十进制数，并聚合成一个用方括号括起来的逗号分隔列表。例如，输出必须看起来像 $[a,b,c,d,e]$，其中 $a, b, c, d, e$ 分别是案例A、B、C、D和E的四舍五入值，不带任何附加文本。",
            "solution": "问题陈述已经过验证，被认为是可接受并可解决的。它具有科学依据，提法明确且客观。它要求将计算生物学中一个标准的、明确定义的公式——Bray-Curtis相异度，直接应用于几个明确的测试案例。我们继续进行计算。\n\n两个群落丰度向量 $\\mathbf{x} = (x_1, x_2, \\dots, x_K)$ 和 $\\mathbf{y} = (y_1, y_2, \\dots, y_K)$ 之间的Bray-Curtis相异度 $D_{\\mathrm{BC}}$ 定义为：\n$$\nD_{\\mathrm{BC}}(\\mathbf{x}, \\mathbf{y}) = \\frac{\\sum_{i=1}^{K} \\lvert x_i - y_i \\rvert}{\\sum_{i=1}^{K} (x_i + y_i)}\n$$\n该指标量化了两个样本之间的组成相异度。值为 $0$ 表示组成相同，而值为 $1$ 表示没有共享的分类单元。我们现在将为每个指定的案例计算这个值。\n\n案例A：一般情况\n给定 $\\mathbf{x} = (12, 3, 0, 5)$ 和 $\\mathbf{y} = (10, 5, 0, 3)$。\n分子中绝对差之和为：\n$$\n\\sum_{i=1}^{4} \\lvert x_i - y_i \\rvert = \\lvert 12 - 10 \\rvert + \\lvert 3 - 5 \\rvert + \\lvert 0 - 0 \\rvert + \\lvert 5 - 3 \\rvert = 2 + 2 + 0 + 2 = 6\n$$\n分母中丰度之和为：\n$$\n\\sum_{i=1}^{4} (x_i + y_i) = (12 + 10) + (3 + 5) + (0 + 0) + (5 + 3) = 22 + 8 + 0 + 8 = 38\n$$\n相异度为：\n$$\nD_{\\mathrm{BC}}(\\mathbf{x}, \\mathbf{y}) = \\frac{6}{38} \\approx 0.1578947...\n$$\n\n案例B：相同群落\n给定 $\\mathbf{x} = (7, 0, 4)$ 和 $\\mathbf{y} = (7, 0, 4)$。\n分子为：\n$$\n\\sum_{i=1}^{3} \\lvert x_i - y_i \\rvert = \\lvert 7 - 7 \\rvert + \\lvert 0 - 0 \\rvert + \\lvert 4 - 4 \\rvert = 0 + 0 + 0 = 0\n$$\n由于分子为 $0$ 且分母不为零，相异度为 $0$。\n$$\nD_{\\mathrm{BC}}(\\mathbf{x}, \\mathbf{y}) = 0\n$$\n\n案例C：组成不相交\n给定 $\\mathbf{x} = (0, 9, 0, 0)$ 和 $\\mathbf{y} = (0, 0, 0, 9)$。\n分子为：\n$$\n\\sum_{i=1}^{4} \\lvert x_i - y_i \\rvert = \\lvert 0 - 0 \\rvert + \\lvert 9 - 0 \\rvert + \\lvert 0 - 0 \\rvert + \\lvert 0 - 9 \\rvert = 0 + 9 + 0 + 9 = 18\n$$\n分母为：\n$$\n\\sum_{i=1}^{4} (x_i + y_i) = (0 + 0) + (9 + 0) + (0 + 0) + (0 + 9) = 0 + 9 + 0 + 9 = 18\n$$\n相异度为：\n$$\nD_{\\mathrm{BC}}(\\mathbf{x}, \\mathbf{y}) = \\frac{18}{18} = 1\n$$\n\n案例D：一个空群落\n给定 $\\mathbf{x} = (0, 0, 0)$ 和 $\\mathbf{y} = (5, 0, 0)$。请注意，$\\mathbf{x}$ 并非真正的空群落，因为它是与拥有分类单元的 $\\mathbf{y}$ 进行比较的；更确切地说，$\\mathbf{x}$ 在所有考虑的分类单元上的观测计数均为零。\n分子为：\n$$\n\\sum_{i=1}^{3} \\lvert x_i - y_i \\rvert = \\lvert 0 - 5 \\rvert + \\lvert 0 - 0 \\rvert + \\lvert 0 - 0 \\rvert = 5 + 0 + 0 = 5\n$$\n分母为：\n$$\n\\sum_{i=1}^{3} (x_i + y_i) = (0 + 5) + (0 + 0) + (0 + 0) = 5 + 0 + 0 = 5\n$$\n相异度为：\n$$\nD_{\\mathrm{BC}}(\\mathbf{x}, \\mathbf{y}) = \\frac{5}{5} = 1\n$$\n\n案例E：超高丰度的共享生物\n给定 $\\mathbf{x} = (10000, 1, 1, 1)$ 和 $\\mathbf{y} = (10000, 0, 2, 1)$。\n分子为：\n$$\n\\sum_{i=1}^{4} \\lvert x_i - y_i \\rvert = \\lvert 10000 - 10000 \\rvert + \\lvert 1 - 0 \\rvert + \\lvert 1 - 2 \\rvert + \\lvert 1 - 1 \\rvert = 0 + 1 + 1 + 0 = 2\n$$\n分母为：\n$$\n\\sum_{i=1}^{4} (x_i + y_i) = (10000 + 10000) + (1 + 0) + (1 + 2) + (1 + 1) = 20000 + 1 + 3 + 2 = 20006\n$$\n相异度为：\n$$\nD_{\\mathrm{BC}}(\\mathbf{x}, \\mathbf{y}) = \\frac{2}{20006} = \\frac{1}{10003} \\approx 0.00009997...\n$$\n\n最终结果，按要求四舍五入到 $6$ 位小数，如下所示：\n- 案例A：$0.157895$\n- 案例B：$0.000000$\n- 案例C：$1.000000$\n- 案例D：$1.000000$\n- 案例E：$0.000100$",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the Bray-Curtis dissimilarity for a test suite of community abundance vectors.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple containing two NumPy arrays (x, y).\n    test_cases = [\n        # Case A: General case\n        (np.array([12, 3, 0, 5]), np.array([10, 5, 0, 3])),\n        # Case B: Identical communities\n        (np.array([7, 0, 4]), np.array([7, 0, 4])),\n        # Case C: Disjoint composition\n        (np.array([0, 9, 0, 0]), np.array([0, 0, 0, 9])),\n        # Case D: One community with no observed reads\n        (np.array([0, 0, 0]), np.array([5, 0, 0])),\n        # Case E: Hyper-abundant shared organism\n        (np.array([10000, 1, 1, 1]), np.array([10000, 0, 2, 1])),\n    ]\n\n    results = []\n    for x, y in test_cases:\n        # The Bray-Curtis dissimilarity is defined as:\n        # D_BC(x, y) = sum(|x_i - y_i|) / sum(x_i + y_i)\n\n        # Calculate the numerator: sum of absolute differences between corresponding elements.\n        numerator = np.sum(np.abs(x - y))\n\n        # Calculate the denominator: sum of all elements in both vectors.\n        denominator = np.sum(x + y)\n\n        # Calculate the dissimilarity. The problem guarantees the denominator is non-zero.\n        if denominator == 0:\n            # This case is stated not to occur in the test suite.\n            # If it did, the dissimilarity would be undefined.\n            # We would handle it here, perhaps by appending a specific value like 'nan'.\n            # For this problem, we assume bray_curtis is always calculable.\n            # A common convention is to define it as 0, but we follow the problem.\n            bray_curtis = 0.0\n        else:\n            bray_curtis = numerator / denominator\n        \n        results.append(bray_curtis)\n\n    # Format the results to exactly 6 decimal places, as specified.\n    # The \"{:.6f}\".format() method ensures rounding and padding with zeros.\n    formatted_results = [\"{:.6f}\".format(r) for r in results]\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}