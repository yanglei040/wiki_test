{
    "hands_on_practices": [
        {
            "introduction": "To truly grasp how normalization methods work, it's helpful to work backwards from a normalized value to the raw data. This exercise challenges you to do just that, by calculating the original number of reads for a gene given its final Fragments Per Kilobase per Million mapped reads (FPKM) value . This practice reinforces the direct relationship between raw counts, gene length, and total library size, which are the core components of this normalization strategy.",
            "id": "2424935",
            "problem": "A transcriptomics experiment quantifies expression using Fragments Per Kilobase per Million mapped reads (FPKM). By definition, FPKM normalizes the number of sequenced fragments mapping to a transcript by the transcript length in kilobases and by the total number of mapped fragments in millions. A researcher reports that a particular gene has an FPKM of $0.1$. The gene’s exonic length is $2\\,\\text{kb}$, and the sequencing library contains $20$ million reads. Assume single-end sequencing so that each sequenced read corresponds to one fragment, and assume all reads are uniquely mapped so that the total number of mapped reads is $20$ million. Under these assumptions, what is the number of raw reads that would map to this gene to yield the reported FPKM? Provide your answer as an integer with no units.",
            "solution": "The problem requires the calculation of the raw number of sequencing reads mapping to a specific gene, given its Fragments Per Kilobase per Million mapped reads (FPKM) value, its length, and the total size of the sequencing library. The problem statement is scientifically sound and well-posed.\n\nFirst, we must formalize the definition of FPKM. FPKM is a normalized measure of gene expression. It is defined as the number of fragments ($C$) that map to a gene, normalized by the gene's length in kilobases ($L$) and the total number of mapped fragments in the experiment in millions ($N / 10^6$). The formula is:\n$$\nFPKM = \\frac{\\text{Number of Mapped Fragments}}{(\\text{Gene Length in kb}) \\times (\\text{Total Mapped Fragments in Millions})}\n$$\nSymbolically, for a gene $i$, this is expressed as:\n$$\nFPKM_i = \\frac{C_i}{L_i \\cdot \\frac{N}{10^6}}\n$$\nwhere:\n- $C_i$ is the number of fragments mapped to gene $i$.\n- $L_i$ is the exonic length of gene $i$ in kilobases (kb).\n- $N$ is the total number of mapped fragments in the sequencing library.\n\nThe problem provides the following data for the gene in question:\n- The FPKM value is $FPKM_{gene} = 0.1$.\n- The exonic length of the gene is $L_{gene} = 2\\,\\text{kb}$.\n- The total number of sequenced reads is $20$ million. The problem states to assume single-end sequencing, where one read corresponds to one fragment. It also states to assume all reads are uniquely mapped. Therefore, the total number of mapped fragments is $N = 20 \\times 10^6$.\n\nOur objective is to determine $C_{gene}$, the number of raw reads (fragments) that map to this gene. To do this, we rearrange the FPKM formula to solve for $C_{gene}$:\n$$\nFPKM_{gene} = \\frac{C_{gene}}{L_{gene} \\cdot \\frac{N}{10^6}}\n$$\nMultiplying both sides by the denominator gives:\n$$\nC_{gene} = FPKM_{gene} \\cdot L_{gene} \\cdot \\frac{N}{10^6}\n$$\nNow, we substitute the given numerical values into this equation:\n- $FPKM_{gene} = 0.1$\n- $L_{gene} = 2$\n- $N = 20 \\times 10^6$\n\nThe term $\\frac{N}{10^6}$ represents the total number of mapped fragments in millions:\n$$\n\\frac{N}{10^6} = \\frac{20 \\times 10^6}{10^6} = 20\n$$\nSubstituting these values into the rearranged formula for $C_{gene}$:\n$$\nC_{gene} = 0.1 \\cdot 2 \\cdot 20\n$$\nPerforming the multiplication:\n$$\nC_{gene} = 0.2 \\cdot 20\n$$\n$$\nC_{gene} = 4\n$$\nThus, the number of raw reads that would map to this gene to produce the reported FPKM value is $4$. This is a discrete, integer value, which is consistent with the physical reality of counting sequencing reads.",
            "answer": "$$\\boxed{4}$$"
        },
        {
            "introduction": "A primary goal of read count normalization is to enable fair comparisons of gene expression across different samples, which may have been sequenced to different depths. This problem provides a classic scenario where raw read counts can be misleading . By calculating the fold-change using the Reads Per Kilobase of transcript per Million mapped reads (RPKM) method, you will see firsthand how normalizing for library size is essential for drawing accurate conclusions about expression changes.",
            "id": "2424950",
            "problem": "An RNA sequencing experiment profiles a single gene across two samples. In Sample A, the gene receives $1$ uniquely mapped read out of $10 \\times 10^{6}$ total uniquely mapped reads. In Sample B, the gene receives $2$ uniquely mapped reads out of $20 \\times 10^{6}$ total uniquely mapped reads. The gene’s length is $1$ kilobase (kb). Reads per kilobase of transcript per million mapped reads (RPKM) is defined as the number of reads assigned to a gene, normalized by the gene’s length in kilobases and by the total number of mapped reads in millions.\n\nCompute the expression fold-change of this gene measured by RPKM, defined as the ratio of the gene’s RPKM in Sample B to its RPKM in Sample A. Report your answer as a pure number (unitless) and round your answer to three significant figures.",
            "solution": "The problem statement will first be subjected to rigorous validation.\n\n**Step 1: Extract Givens**\n- Sample A: Gene receives $1$ uniquely mapped read.\n- Sample A: Total uniquely mapped reads are $10 \\times 10^{6}$.\n- Sample B: Gene receives $2$ uniquely mapped reads.\n- Sample B: Total uniquely mapped reads are $20 \\times 10^{6}$.\n- Gene length: $1$ kilobase (kb).\n- Definition of RPKM (Reads Per Kilobase of transcript per Million mapped reads): the number of reads assigned to a gene, normalized by the gene’s length in kilobases and by the total number of mapped reads in millions.\n- Required computation: Fold-change, defined as the ratio of the gene’s RPKM in Sample B to its RPKM in Sample A.\n- Required format: Pure number, rounded to three significant figures.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is evaluated against the required criteria.\n- **Scientifically Grounded**: The problem describes a standard, fundamental calculation in RNA sequencing data analysis. RPKM is a well-established, though now often superseded, metric for normalizing gene expression. The values provided are plausible for a real experiment. The problem is scientifically sound.\n- **Well-Posed**: All necessary data and definitions are provided. The objective is clear and leads to a unique, stable solution. The problem is well-posed.\n- **Objective**: The problem is stated using precise, quantitative, and unbiased language. It is free of subjective or opinion-based claims.\n\n**Step 3: Verdict and Action**\nThe problem is valid. It is scientifically grounded, well-posed, objective, and complete. A solution will now be derived.\n\nThe problem requires the computation of a fold-change in gene expression between two samples, where expression is quantified using the Reads Per Kilobase of transcript per Million mapped reads (RPKM) metric.\n\nLet us define the variables from the problem statement:\n- $C_A$: number of reads mapped to the gene in Sample A, $C_A = 1$.\n- $N_A$: total number of mapped reads in Sample A, $N_A = 10 \\times 10^{6}$.\n- $C_B$: number of reads mapped to the gene in Sample B, $C_B = 2$.\n- $N_B$: total number of mapped reads in Sample B, $N_B = 20 \\times 10^{6}$.\n- $L$: length of the gene in kilobases (kb), $L = 1$.\n\nThe definition of RPKM is given as:\n$$ \\text{RPKM} = \\frac{\\text{Number of reads}}{(\\text{Gene length in kb}) \\times (\\text{Total reads in millions})} $$\nThis can be formulated mathematically. The total number of reads in millions is the total read count divided by $10^6$.\n$$ \\text{RPKM} = \\frac{C}{L \\times (N / 10^6)} $$\nwhere $C$ is the read count for the gene, $L$ is the gene length in kb, and $N$ is the total library size (total mapped reads).\n\nFirst, we calculate the RPKM for Sample A ($\\text{RPKM}_A$):\n$$ \\text{RPKM}_A = \\frac{C_A}{L \\times (N_A / 10^6)} $$\nSubstituting the given values:\n$$ \\text{RPKM}_A = \\frac{1}{1 \\times (10 \\times 10^6 / 10^6)} = \\frac{1}{1 \\times 10} = 0.1 $$\n\nNext, we calculate the RPKM for Sample B ($\\text{RPKM}_B$):\n$$ \\text{RPKM}_B = \\frac{C_B}{L \\times (N_B / 10^6)} $$\nSubstituting the given values:\n$$ \\text{RPKM}_B = \\frac{2}{1 \\times (20 \\times 10^6 / 10^6)} = \\frac{2}{1 \\times 20} = \\frac{2}{20} = 0.1 $$\n\nThe problem asks for the fold-change (FC), defined as the ratio of $\\text{RPKM}_B$ to $\\text{RPKM}_A$.\n$$ \\text{FC} = \\frac{\\text{RPKM}_B}{\\text{RPKM}_A} $$\nSubstituting the calculated RPKM values:\n$$ \\text{FC} = \\frac{0.1}{0.1} = 1 $$\n\nAlternatively, we can compute the fold-change symbolically first, which is a more robust method.\n$$ \\text{FC} = \\frac{\\text{RPKM}_B}{\\text{RPKM}_A} = \\frac{\\frac{C_B}{L \\times (N_B / 10^6)}}{\\frac{C_A}{L \\times (N_A / 10^6)}} $$\nThe gene length $L$ and the scaling factor $10^6$ are common to both the numerator and the denominator, and thus they cancel out:\n$$ \\text{FC} = \\frac{C_B / N_B}{C_A / N_A} = \\frac{C_B}{C_A} \\times \\frac{N_A}{N_B} $$\nThis expression shows that the RPKM fold-change is the ratio of raw read counts, corrected by the inverse ratio of the total library sizes. Now, we substitute the numerical values into this simplified expression:\n$$ \\text{FC} = \\frac{2}{1} \\times \\frac{10 \\times 10^6}{20 \\times 10^6} = 2 \\times \\frac{10}{20} = 2 \\times \\frac{1}{2} = 1 $$\n\nThe result is exactly $1$. The problem requires the answer to be rounded to three significant figures. To express $1$ with three significant figures, we write it as $1.00$. This indicates that the value is precise to the hundredths place.\nThe doubling of the raw read count (from $1$ to $2$) is perfectly offset by the doubling of the sequencing depth (from $10$ million to $20$ million reads), resulting in an identical normalized expression value and thus a fold-change of $1$.",
            "answer": "$$\n\\boxed{1.00}\n$$"
        },
        {
            "introduction": "While RPKM is useful for between-sample comparisons, comparing the expression levels of different genes *within* the same sample presents its own challenges, primarily due to variations in gene length. The Transcripts Per Million (TPM) method was developed to address this, ensuring the sum of all expression values in a sample is constant. This exercise demonstrates the power of TPM for within-sample analysis, asking you to determine which of two genes—one long and one short—is truly more abundant . This will highlight how raw read counts can be a poor indicator of relative transcript abundance.",
            "id": "2424999",
            "problem": "An RNA sequencing experiment yields uniquely mapped read counts for two single-isoform genes measured in the same sample. Gene $\\mathcal{A}$ has length $500$ base pairs (bp) and has $50$ mapped reads. Gene $\\mathcal{B}$ has length $5000$ bp and has $450$ mapped reads. Transcripts Per Million (TPM) is defined as a within-sample expression measure obtained by first normalizing each gene’s read count by its transcript length in kilobases and then scaling the resulting values so that their sum across all genes in the sample equals one million.\n\nUsing only the information above and the definition of TPM, determine which gene is more highly expressed in this sample by computing the ratio $\\mathrm{TPM}_{\\mathcal{A}} / \\mathrm{TPM}_{\\mathcal{B}}$. Express your answer as an exact fraction with no units. The final answer must be a single real-valued number.",
            "solution": "The problem requires the calculation of the ratio of Transcripts Per Million ($\\mathrm{TPM}$) for two genes, $\\mathcal{A}$ and $\\mathcal{B}$, from a single RNA sequencing sample.\n\nFirst, we must rigorously formalize the definition of $\\mathrm{TPM}$ as provided. Let $C_i$ be the number of uniquely mapped reads for a gene $i$, and let $L_i$ be the length of gene $i$ in base pairs (bp). The definition involves two steps.\n\nStep 1: Normalize the read count by gene length in kilobases (kb).\nThe length of gene $i$ in kilobases, denoted $L_{i, \\text{kb}}$, is given by $L_{i, \\text{kb}} = \\frac{L_i}{1000}$.\nThe length-normalized read count, which we will call $R_i$, is the ratio of the read count to the gene length in kilobases:\n$$R_i = \\frac{C_i}{L_{i, \\text{kb}}} = \\frac{C_i}{L_i / 1000}$$\n\nStep 2: Scale these normalized counts so that their sum across all genes in the sample equals one million ($10^6$).\nLet $\\mathcal{G}$ represent the set of all genes in the sample. The sum of all length-normalized read counts is given by the scaling factor $S$:\n$$S = \\sum_{j \\in \\mathcal{G}} R_j$$\nThe $\\mathrm{TPM}$ value for an individual gene $i$ is then calculated as:\n$$\\mathrm{TPM}_i = \\left( \\frac{R_i}{S} \\right) \\times 10^6$$\n\nWe are given the following data:\nFor gene $\\mathcal{A}$:\n- Read count: $C_{\\mathcal{A}} = 50$\n- Length: $L_{\\mathcal{A}} = 500$ bp\n\nFor gene $\\mathcal{B}$:\n- Read count: $C_{\\mathcal{B}} = 450$\n- Length: $L_{\\mathcal{B}} = 5000$ bp\n\nWe now apply Step 1 to each gene.\nFor gene $\\mathcal{A}$, the length in kilobases is $L_{\\mathcal{A}, \\text{kb}} = \\frac{500}{1000} = 0.5$ kb.\nThe length-normalized read count for gene $\\mathcal{A}$ is:\n$$R_{\\mathcal{A}} = \\frac{C_{\\mathcal{A}}}{L_{\\mathcal{A}, \\text{kb}}} = \\frac{50}{0.5} = 100$$\n\nFor gene $\\mathcal{B}$, the length in kilobases is $L_{\\mathcal{B}, \\text{kb}} = \\frac{5000}{1000} = 5$ kb.\nThe length-normalized read count for gene $\\mathcal{B}$ is:\n$$R_{\\mathcal{B}} = \\frac{C_{\\mathcal{B}}}{L_{\\mathcal{B}, \\text{kb}}} = \\frac{450}{5} = 90$$\n\nThe problem asks for the ratio $\\frac{\\mathrm{TPM}_{\\mathcal{A}}}{\\mathrm{TPM}_{\\mathcal{B}}}$. Using the formula for $\\mathrm{TPM}$, we can write this ratio as:\n$$\\frac{\\mathrm{TPM}_{\\mathcal{A}}}{\\mathrm{TPM}_{\\mathcal{B}}} = \\frac{\\left( \\frac{R_{\\mathcal{A}}}{S} \\right) \\times 10^6}{\\left( \\frac{R_{\\mathcal{B}}}{S} \\right) \\times 10^6}$$\n\nThe per-million scaling factor, $10^6$, and the total sum of normalized reads, $S$, are identical for both genes as they are measured in the same sample. Therefore, these terms cancel out from the ratio:\n$$\\frac{\\mathrm{TPM}_{\\mathcal{A}}}{\\mathrm{TPM}_{\\mathcal{B}}} = \\frac{R_{\\mathcal{A}}}{R_{\\mathcal{B}}}$$\nThis shows that the ratio of $\\mathrm{TPM}$ values between two genes in the same sample depends only on their respective read counts and lengths, not on any other genes in the library.\n\nSubstituting the calculated values for $R_{\\mathcal{A}}$ and $R_{\\mathcal{B}}$:\n$$\\frac{\\mathrm{TPM}_{\\mathcal{A}}}{\\mathrm{TPM}_{\\mathcal{B}}} = \\frac{100}{90}$$\nSimplifying this fraction gives the final result:\n$$\\frac{\\mathrm{TPM}_{\\mathcal{A}}}{\\mathrm{TPM}_{\\mathcal{B}}} = \\frac{10}{9}$$\nSince the ratio $\\frac{10}{9} > 1$, it is evident that $\\mathrm{TPM}_{\\mathcal{A}} > \\mathrm{TPM}_{\\mathcal{B}}$, which means gene $\\mathcal{A}$ is more highly expressed than gene $\\mathcal{B}$ in this sample. The problem asks for the numerical value of this ratio.",
            "answer": "$$\\boxed{\\frac{10}{9}}$$"
        }
    ]
}