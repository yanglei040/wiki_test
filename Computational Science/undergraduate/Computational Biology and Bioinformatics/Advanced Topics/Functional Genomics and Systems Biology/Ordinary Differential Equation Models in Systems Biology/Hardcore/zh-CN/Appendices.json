{
    "hands_on_practices": [
        {
            "introduction": "在为细胞过程建立模型时，一个常被忽略但至关重要的因素是细胞自身的生长。本练习将引导你从第一性原理出发，推导在一个体积呈指数增长的细胞中，分子浓度所遵循的常微分方程。通过这个实践，你将掌握如何将生化反应动力学与因细胞体积膨胀引起的稀释效应结合起来，这是对任何生长系统进行精确建模的基础。",
            "id": "2411220",
            "problem": "您的任务是在系统生物学背景下，为一个体积本身是动态变量的指数增长细胞，构建并模拟一个机理性的常微分方程（ODE）模型。该模型必须根据分子守恒和体积增长引起的稀释的第一性原理推导得出，然后针对指定的测试套件进行评估。\n\n考虑一个体积为 $V(t)$ 的混合均匀的单个细胞，其根据微分方程呈指数增长\n$$\n\\frac{dV}{dt} = g \\, V,\n$$\n其中 $g$ 是比增长速率。设 $A(t)$ 和 $B(t)$ 表示两种物质 $A$ 和 $B$ 的细胞内浓度（单位为微摩尔，$\\mu \\mathrm{M}$）。假设每单位体积发生以下生化过程：\n- 物质 $A$ 以恒定速率 $q_A$（单位为 $\\mu \\mathrm{M} \\cdot \\mathrm{h}^{-1}$）产生。\n- 物质 $A$ 以一级动力学转化为 $B$，速率常数为 $k_1$（单位为 $\\mathrm{h}^{-1}$）。\n- 物质 $B$ 以一级动力学降解，速率常数为 $k_2$（单位为 $\\mathrm{h}^{-1}$）。\n\n假设细胞内浓度因体积增长而被稀释。从定义 $C_i(t) = N_i(t)/V(t)$ 出发，其中 $N_i(t)$ 是物质 $i$ 的分子数量，对 $\\frac{d}{dt}(N_i/V)$ 应用商法则，推导在上述反应方案下 $A(t)$ 和 $B(t)$ 的常微分方程，并包含生长稀释效应。使用初始条件 $A(0) = A_0$、$B(0) = B_0$ 和 $V(0) = V_0$。时间 $t$ 的单位为小时，体积 $V$ 的单位为飞升（fL），浓度 $A$ 和 $B$ 的单位为微摩尔（$\\mu \\mathrm{M}$）。\n\n您的程序必须针对每个测试用例，在给定的参数 $g$、$q_A$、$k_1$、$k_2$ 和初始条件 $A_0$、$B_0$、$V_0$ 的情况下，计算在指定的最终时间 $T$（单位为小时）时的三元组 $[A(T), B(T), V(T)]$。所有报告的浓度单位必须是 $\\mu \\mathrm{M}$，细胞体积单位必须是 $\\mathrm{fL}$。每个测试用例的结果必须四舍五入到 $4$ 位小数。\n\n测试套件（每个元组为 $(g, q_A, k_1, k_2, T, A_0, B_0, V_0)$，单位为 $(\\mathrm{h}^{-1}, \\mu \\mathrm{M}\\cdot\\mathrm{h}^{-1}, \\mathrm{h}^{-1}, \\mathrm{h}^{-1}, \\mathrm{h}, \\mu \\mathrm{M}, \\mu \\mathrm{M}, \\mathrm{fL})$）：\n- 案例1（一般情况）：$(0.2, 10.0, 1.0, 0.5, 5.0, 0.0, 0.0, 1.0)$。\n- 案例2（无增长，边界情况）：$(0.0, 10.0, 1.0, 0.5, 5.0, 0.0, 0.0, 1.0)$。\n- 案例3（无生产，带有预载池的边缘情况）：$(0.3, 0.0, 0.7, 0.4, 4.0, 5.0, 2.0, 1.5)$。\n- 案例4（快速增长，强稀释）：$(1.0, 10.0, 1.0, 0.5, 3.0, 0.0, 0.0, 2.0)$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。列表中的每个元素本身又是一个包含三个浮点数的列表 $[A(T),B(T),V(T)]$，使用指定单位，且每个值都四舍五入到 $4$ 位小数。例如，一个包含两个案例的有效输出格式为 $[[a_1,b_1,v_1],[a_2,b_2,v_2]]$，不含空格。",
            "solution": "问题陈述已经过严格验证，被认为是有效的。它在科学上基于化学动力学和系统生物学原理，作为一个可解的初值问题，其提法是适定的，并且没有歧义或矛盾。\n\n这个问题的核心是推导并求解一个常微分方程组（ODEs），该方程组描述了一个体积 $V(t)$ 呈指数增长的单个细胞内两种分子物质 $A$ 和 $B$ 的浓度。\n\n**1. 控制方程的推导**\n\n在变化的体积 $V$ 中，控制物质 $i$ 的浓度 $C_i$ 的基本原理源于质量守恒。浓度定义为分子总数 $N_i$ 除以体积 $V$，即 $C_i(t) = N_i(t) / V(t)$。对时间 $t$ 应用商法则求导可得：\n$$\n\\frac{dC_i}{dt} = \\frac{d}{dt}\\left(\\frac{N_i}{V}\\right) = \\frac{1}{V}\\frac{dN_i}{dt} - \\frac{N_i}{V^2}\\frac{dV}{dt}\n$$\n问题陈述中指出，体积呈指数增长，$\\frac{dV}{dt} = gV$，其中 $g$ 是比增长速率。将此式与 $C_i = N_i/V$ 代入方程，可得：\n$$\n\\frac{dC_i}{dt} = \\frac{1}{V}\\frac{dN_i}{dt} - \\frac{C_i V}{V^2}(gV) = \\frac{1}{V}\\frac{dN_i}{dt} - gC_i\n$$\n该方程是增长系统建模的基石。项 $\\frac{1}{V}\\frac{dN_i}{dt}$ 表示由生化反应引起的浓度变化率，而项 $-gC_i$ 表示因体积膨胀导致的物质稀释。\n\n问题以浓度速率（每单位体积）的形式指定了反应动力学：\n- 对于物质 $A$：以恒定速率 $q_A$ 产生，并以速率 $-k_1 A$ 进行一级反应转化为 $B$。\n- 对于物质 $B$：以速率 $k_1 A$ 由 $A$ 产生，并以速率 $-k_2 B$ 进行一级反应降解。\n\n这些对应于反应项 $\\frac{1}{V}\\frac{dN_i}{dt}$。现在我们可以构建完整的常微分方程组。\n\n对于体积 $V(t)$：\n$$\n\\frac{dV}{dt} = gV, \\quad V(0) = V_0\n$$\n对于浓度 $A(t)$：\n$$\n\\frac{dA}{dt} = \\underbrace{(q_A - k_1 A)}_{\\text{反应}} - \\underbrace{gA}_{\\text{稀释}} = q_A - (k_1 + g)A, \\quad A(0) = A_0\n$$\n对于浓度 $B(t)$：\n$$\n\\frac{dB}{dt} = \\underbrace{(k_1 A - k_2 B)}_{\\text{反应}} - \\underbrace{gB}_{\\text{稀释}} = k_1 A - (k_2 + g)B, \\quad B(0) = B_0\n$$\n这是一个由三个具有常系数的线性一阶常微分方程组成的方程组。该系统适合采用精确的解析解法，这种方法优于数值积分，因为它没有近似误差。\n\n**2. ODE系统的解析解**\n\n这些方程是解耦的，或者可以依次求解。\n\n**体积 $V(t)$：**\n方程 $\\frac{dV}{dt} = gV$ 通过分离变量法求解，得到标准的指数增长公式：\n$$\nV(t) = V_0 e^{gt}\n$$\n\n**浓度 $A(t)$：**\n令 $K_A = k_1 + g$。ODE为 $\\frac{dA}{dt} + K_A A = q_A$。这是一个线性一阶ODE。假设 $K_A \\neq 0$（对于所有测试用例均为真，因为 $k_1 > 0$ 或 $g > 0$），解为：\n$$\nA(t) = \\frac{q_A}{K_A} + \\left(A_0 - \\frac{q_A}{K_A}\\right)e^{-K_A t}\n$$\n项 $\\frac{q_A}{K_A}$ 代表当时间趋于无穷时将达到的稳态浓度 $A_{ss}$。\n\n**浓度 $B(t)$：**\n令 $K_B = k_2 + g$。ODE为 $\\frac{dB}{dt} + K_B B = k_1 A(t)$。这是另一个线性一阶ODE，但它是一个带有随时间变化的强迫项 $k_1A(t)$ 的非齐次方程。我们代入 $A(t)$ 的解并进行求解。\n\n求解方法取决于 $K_A = K_B$ 是否成立（即 $k_1 = k_2$）。对于所有给定的测试用例，$k_1 \\neq k_2$，因此 $K_A \\neq K_B$。这种情况下的通解可以使用积分因子或等效方法（如“参数变易法”或“待定系数法”）推导。解的形式为 $B(t) = B_p(t) + B_h(t)$，其中 $B_h(t)$ 是齐次解，$B_p(t)$ 是特解。\n\n$B(t)$ 的最终解析解为：\n$$\nB(t) = C_1 + C_2 e^{-K_A t} + C_3 e^{-K_B t}\n$$\n其中系数 $C_1$、$C_2$ 和 $C_3$ 是由参数和初始条件决定的常数：\n$$\nC_1 = \\frac{k_1 q_A}{K_A K_B} = \\frac{k_1 q_A}{(k_1+g)(k_2+g)}\n$$\n$$\nC_2 = \\frac{k_1(A_0 - q_A/K_A)}{K_B - K_A} = \\frac{k_1(A_0(k_1+g) - q_A)}{(k_1+g)(k_2-k_1)}\n$$\n$$\nC_3 = B_0 - C_1 - C_2\n$$\n\n**3. 算法实现**\n\n程序将实现这些精确的解析解。对每个测试用例，执行以下步骤：\n1.  提取参数 $g, q_A, k_1, k_2, T$ 和初始条件 $A_0, B_0, V_0$。\n2.  使用其解析公式计算 $V(T)$。\n3.  定义常数 $K_A = k_1 + g$ 和 $K_B = k_2 + g$。\n4.  使用其解析公式计算 $A(T)$。为增强鲁棒性，加入了对 $K_A=0$ 的检查，尽管测试套件中并未要求。\n5.  计算 $B(t)$ 解的系数 $C_1$、$C_2$ 和 $C_3$。\n6.  使用其解析公式计算 $B(T)$。所有测试用例都满足 $k_1 \\neq k_2$，因此严格来说不需要 $k_1 = k_2$ 的特定公式，但考虑它是一种良好的实践。\n7.  将计算出的 $A(T)$、$B(T)$ 和 $V(T)$ 的值四舍五入到4位小数。\n8.  收集所有测试用例的结果，并按照问题要求格式化为单个字符串。\n\n这种方法确保了最高的精度和计算效率。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Constructs and simulates a mechanistic ODE model for an exponentially growing cell.\n    The solution is derived analytically and implemented to compute the state of the system\n    [A(T), B(T), V(T)] at a final time T for a suite of test cases.\n    \"\"\"\n\n    test_cases = [\n        # (g, q_A, k_1, k_2, T, A_0, B_0, V_0)\n        (0.2, 10.0, 1.0, 0.5, 5.0, 0.0, 0.0, 1.0),\n        (0.0, 10.0, 1.0, 0.5, 5.0, 0.0, 0.0, 1.0),\n        (0.3, 0.0, 0.7, 0.4, 4.0, 5.0, 2.0, 1.5),\n        (1.0, 10.0, 1.0, 0.5, 3.0, 0.0, 0.0, 2.0),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        g, q_A, k_1, k_2, T, A_0, B_0, V_0 = case\n\n        # 1. Solve for V(T)\n        V_T = V_0 * np.exp(g * T)\n\n        # 2. Solve for A(T)\n        K_A = k_1 + g\n        if K_A == 0:\n            # Handles the case g=0 and k1=0. A(t) grows linearly.\n            A_T = A_0 + q_A * T\n        else:\n            A_ss = q_A / K_A\n            A_T = A_ss + (A_0 - A_ss) * np.exp(-K_A * T)\n\n        # 3. Solve for B(T)\n        K_B = k_2 + g\n        \n        # Check for the special case k1 = k2, which implies K_A = K_B\n        if abs(k_1 - k_2)  1e-9: # Use a tolerance for float comparison\n            if K_A == 0: # This implies k1=k2=g=0\n                # A(t) = A_0 + q_A*t\n                # dB/dt = 0, because k1=0\n                B_T = B_0\n            else:\n                A_ss = q_A / K_A\n                term1 = B_0 * np.exp(-K_A * T)\n                term2 = (k_1 * A_ss / K_A) * (1 - np.exp(-K_A * T))\n                term3 = k_1 * (A_0 - A_ss) * T * np.exp(-K_A * T)\n                B_T = term1 + term2 + term3\n        else:\n            # General case k1 != k2\n            if K_A == 0 or K_B == 0:\n                # This logic is more complex and not required by test cases.\n                # A full implementation would handle these edge cases.\n                # For this problem, we rely on test cases not hitting this.\n                # For instance, if K_A=0, A(t) is linear, integral for B is different.\n                # If K_B=0, integrating factor metod for B changes.\n                pass\n            \n            C1 = (k_1 * q_A) / (K_A * K_B)\n            # Denominator is K_B - K_A = (k2+g) - (k1+g) = k2 - k1\n            C2 = (k_1 * (A_0 - q_A / K_A)) / (k_2 - k_1)\n            C3 = B_0 - C1 - C2\n            \n            B_T = C1 + C2 * np.exp(-K_A * T) + C3 * np.exp(-K_B * T)\n            \n        # Round results to 4 decimal places\n        A_T_rounded = round(A_T, 4)\n        B_T_rounded = round(B_T, 4)\n        V_T_rounded = round(V_T, 4)\n\n        results.append([A_T_rounded, B_T_rounded, V_T_rounded])\n\n    # Format the final output string to exactly match the requirement,\n    # which is a list of lists with no spaces.\n    # str(results) produces \"'[[...], [...]]'\", replace(\" \", \"\") removes spaces.\n    final_output_string = str(results).replace(\" \", \"\")\n    print(final_output_string)\n\nsolve()\n```"
        },
        {
            "introduction": "生物系统通过复杂的调控网络实现特定的功能。本练习将带你进入合成生物学的世界，探索如何通过基因线路设计，构建一个“带通滤波器”，使其仅对中等强度的输入信号产生强烈响应。你将使用希尔函数来描述基因表达的非线性调控，并分析一个常见网络基序（非相干前馈环路）如何巧妙地实现这种复杂的信号处理功能。",
            "id": "2411191",
            "problem": "一个合成基因线路被设计用于实现带通滤波器功能：报告物种仅对外源输入 $I$ 的中等水平产生强响应，而对极低或极高的 $I$ 水平响应较弱。考虑以下具有三个状态变量的常微分方程（ODE）模型：$A(t)$（激活物）、$R(t)$（阻遏物）和 $Y(t)$（报告物）。输入 $I$ 是一个恒定的外源信号。所有浓度单位均为纳摩尔（nM），时间单位为分钟（min）。参数单位如下：生成速率为 nM/min，降解速率为 $1/\\text{min}$，希尔常数为 nM，希尔系数无量纲。\n\n模型如下\n$$\n\\frac{dA}{dt} \\;=\\; k_a \\,\\frac{I^{n}}{K_a^{n} + I^{n}} \\;-\\; d_a\\,A,\n$$\n$$\n\\frac{dR}{dt} \\;=\\; k_r \\,\\frac{I^{m}}{K_r^{m} + I^{m}} \\;-\\; d_r\\,R,\n$$\n$$\n\\frac{dY}{dt} \\;=\\; k_y \\,\\frac{A^{p}}{K_y^{p} + A^{p}} \\;\\cdot\\; \\frac{K_i^{q}}{K_i^{q} + R^{q}} \\;-\\; d_y\\,Y.\n$$\n\n在此模型中，$I$ 通过指数分别为 $n$ 和 $m$ 的S型希尔函数激活 $A$ 和 $R$，$A$ 以希尔指数 $p$ 激活 $Y$，$R$ 通过一个递减的希尔因子以希尔指数 $q$ 阻遏 $Y$。假设初始条件为 $A(0)=0\\,\\text{nM}$、$R(0)=0\\,\\text{nM}$ 和 $Y(0)=0\\,\\text{nM}$。对于任意固定的常数 $I$，将稳态报告物浓度 $Y^\\ast(I)$ 定义为当 $t \\to \\infty$ 时 $Y(t)$ 的极限。\n\n您的任务是，对下面列出的每个参数集，在一个指定的输入值网格上确定稳态报告物响应 $Y^\\ast(I)$，并提取表征带通行为的汇总统计数据。您必须使用以下输入网格\n$$\nI \\in \\{\\,0,10,20,\\dots,500\\,\\}\\ \\text{nM},\n$$\n即从 $0$ 到 $500$ nM（包含两端）的 $51$ 个等间距点。\n\n对于每个参数集，计算：\n- 网格上每个 $I$ 对应的稳态值 $Y^\\ast(I)$，\n- 网格内使 $Y^\\ast(I)$ 最大化的输入值 $I_{\\text{peak}}$（单位 nM）（如果在数值精度范围内有多个值达到相同的最大值，则选择网格上最小的 $I$），\n- 相应的最大值 $Y_{\\text{peak}} = \\max_I Y^\\ast(I)$（单位 nM），\n- $Y^\\ast(0)$ 和 $Y^\\ast(500)$ 的值（单位 nM）。\n\n使用以下参数集测试套件（单位如上所述）：\n\n- 测试用例 1：\n  - $k_a = 50$, $d_a = 1$, $K_a = 50$, $n = 2$;\n  - $k_r = 40$, $d_r = 1$, $K_r = 80$, $m = 2$;\n  - $k_y = 120$, $d_y = 1$, $K_y = 30$, $p = 2$;\n  - $K_i = 60$, $q = 2$.\n\n- 测试用例 2：\n  - $k_a = 50$, $d_a = 1$, $K_a = 40$, $n = 2$;\n  - $k_r = 120$, $d_r = 1.5$, $K_r = 50$, $m = 3$;\n  - $k_y = 120$, $d_y = 1$, $K_y = 25$, $p = 2$;\n  - $K_i = 30$, $q = 2$.\n\n- 测试用例 3：\n  - $k_a = 60$, $d_a = 1$, $K_a = 40$, $n = 2$;\n  - $k_r = 10$, $d_r = 1$, $K_r = 100$, $m = 2$;\n  - $k_y = 120$, $d_y = 1$, $K_y = 30$, $p = 2$;\n  - $K_i = 10000$, $q = 1$.\n\n所有报告的值中，浓度的单位必须为纳摩尔（nM），输入 $I$ 的单位也为纳摩尔（nM）。将最终输出中的每个数字四舍五入到 $3$ 位小数。\n\n最终输出格式：您的程序应生成单行内容，该内容为一个包含在方括号内的、由逗号分隔的扁平列表。该列表必须按顺序包含测试用例 1、测试用例 2、测试用例 3 的四元组\n$$\n\\big[\\,I_{\\text{peak}},\\ Y_{\\text{peak}},\\ Y^\\ast(0),\\ Y^\\ast(500)\\,\\big]\n$$\n按顺序为每个测试连接成一个扁平列表。例如，输出必须如下所示\n$$\n[\\ I_{\\text{peak},1},\\ Y_{\\text{peak},1},\\ Y^\\ast_1(0),\\ Y^\\ast_1(500),\\ I_{\\text{peak},2},\\ \\dots,\\ I_{\\text{peak},3},\\ \\dots\\ ],\n$$\n其中每个数字都四舍五入到 $3$ 位小数，且不含额外文本。",
            "solution": "对该问题进行验证。\n\n**步骤 1：提取已知条件**\n- **模型方程：**\n$$\n\\frac{dA}{dt} \\;=\\; k_a \\,\\frac{I^{n}}{K_a^{n} + I^{n}} \\;-\\; d_a\\,A\n$$\n$$\n\\frac{dR}{dt} \\;=\\; k_r \\,\\frac{I^{m}}{K_r^{m} + I^{m}} \\;-\\; d_r\\,R\n$$\n$$\n\\frac{dY}{dt} \\;=\\; k_y \\,\\frac{A^{p}}{K_y^{p} + A^{p}} \\;\\cdot\\; \\frac{K_i^{q}}{K_i^{q} + R^{q}} \\;-\\; d_y\\,Y\n$$\n- **状态变量和输入：** $A(t)$、$R(t)$、$Y(t)$ 以及一个恒定输入 $I$。\n- **初始条件：** $A(0)=0$、$R(0)=0$、$Y(0)=0$。\n- **目标：** 对于一个固定的 $I$，求稳态浓度 $Y^\\ast(I) = \\lim_{t \\to \\infty} Y(t)$。\n- **输入网格：** $I \\in \\{0, 10, 20, \\dots, 500\\}$。\n- **任务：** 对每个参数集，计算 $I_{\\text{peak}}$、$Y_{\\text{peak}}$、$Y^\\ast(0)$ 和 $Y^\\ast(500)$。\n- **参数集：** 提供了三个不同的测试用例，包含所有必要的参数值（$k_a, d_a, K_a, n, k_r, d_r, K_r, m, k_y, d_y, K_y, p, K_i, q$）。\n\n**步骤 2：使用提取的已知条件进行验证**\n该问题具有科学依据，采用基于希尔动力学的标准常微分方程（ODE）模型，这是系统生物学中描述基因调控的基石。该模型代表了I型非相干前馈环，这是一种被广泛研究的网络基序。该问题是适定的：任务是计算系统的稳态，该稳态由从ODE导出的代数方程组唯一确定，然后对这些稳态值在一个离散输入网格上进行简单分析。该问题是客观、独立且内部一致的，提供了所有必要的参数和规范。这些参数在合成生物学的物理合理范围内。未发现缺陷。\n\n**步骤 3：结论与操作**\n该问题是**有效**的。将提供一个解决方案。\n\n问题的核心是确定物种 $A$、$R$ 和 $Y$ 的稳态浓度作为输入信号 $I$ 的函数。稳态由所有时间导数均为零的条件定义。\n设 $\\frac{dA}{dt} = 0$、$\\frac{dR}{dt} = 0$ 和 $\\frac{dY}{dt} = 0$，我们得到一个关于稳态浓度（表示为 $A^\\ast$、$R^\\ast$ 和 $Y^\\ast$）的代数方程组。\n\n从 $A$ 的方程中，我们得到：\n$$\nk_a \\,\\frac{I^{n}}{K_a^{n} + I^{n}} \\;-\\; d_a\\,A^\\ast = 0 \\quad \\implies \\quad A^\\ast(I) = \\frac{k_a}{d_a} \\frac{I^{n}}{K_a^{n} + I^{n}}\n$$\n类似地，从 $R$ 的方程中：\n$$\nk_r \\,\\frac{I^{m}}{K_r^{m} + I^{m}} \\;-\\; d_r\\,R^\\ast = 0 \\quad \\implies \\quad R^\\ast(I) = \\frac{k_r}{d_r} \\frac{I^{m}}{K_r^{m} + I^{m}}\n$$\n$A^\\ast$ 和 $R^\\ast$ 的稳态表达式仅依赖于输入 $I$ 及其各自的参数。这些可以代入 $Y$ 的稳态方程中：\n$$\nk_y \\,\\frac{(A^\\ast)^{p}}{K_y^{p} + (A^\\ast)^{p}} \\;\\cdot\\; \\frac{K_i^{q}}{K_i^{q} + (R^\\ast)^{q}} \\;-\\; d_y\\,Y^\\ast = 0\n$$\n解出 $Y^\\ast$ 得到其对 $A^\\ast$ 和 $R^\\ast$ 的依赖关系，从而间接依赖于 $I$：\n$$\nY^\\ast(I) = \\frac{k_y}{d_y} \\left( \\frac{(A^\\ast(I))^{p}}{K_y^{p} + (A^\\ast(I))^{p}} \\right) \\left( \\frac{K_i^{q}}{K_i^{q} + (R^\\ast(I))^{q}} \\right)\n$$\n这些代数方程提供了一种直接且计算高效的方法，用于计算任何给定输入 $I$ 的稳态响应 $Y^\\ast$，从而无需对ODE进行数值积分。\n\n计算策略如下：\n1.  对于三个测试用例中的每一个，使用给定的参数集。\n2.  按规定生成 $I$ 的输入网格：$I = \\{0, 10, 20, \\dots, 500\\}$。\n3.  对于网格中的每个 $I$ 值，使用导出的代数公式计算稳态浓度 $A^\\ast(I)$、$R^\\ast(I)$ 和 $Y^\\ast(I)$。为提高效率，此过程采用矢量化操作实现。\n4.  分析得到的 $Y^\\ast$ 值数组，以找到所需的统计数据：\n    -   $Y_{\\text{peak}}$ 是 $Y^\\ast$ 数组中的最大值。\n    -   $I_{\\text{peak}}$ 是网格中对应于首次出现 $Y_{\\text{peak}}$ 的 $I$ 值。\n    -   $Y^\\ast(0)$ 是 $Y^\\ast$ 数组的第一个元素，对应于 $I=0$。\n    -   $Y^\\ast(500)$ 是 $Y^\\ast$ 数组的最后一个元素，对应于 $I=500$。\n5.  将每个测试用例得到的四个值——$I_{\\text{peak}}$、$Y_{\\text{peak}}$、$Y^\\ast(0)$、$Y^\\ast(500)$——收集起来，并格式化为单个扁平列表，数值四舍五入到三位小数。\n\n此过程是确定性的，并直接满足问题陈述的所有要求。该模型的结构（一个非相干前馈环）预计在阻遏臂足够强且在比激活臂更高的输入水平下被激活的参数集（测试用例1和2）中会产生带通行为。对于测试用例3，阻遏作用被设计为可忽略不计（$K_i$ 非常大），这应导致一个简单的低通（饱和）响应，其中峰值输出出现在最大输入水平。这为实现提供了一个逻辑检验。当 $I=0$ 时，$A^\\ast(0)=0$ 且 $R^\\ast(0)=0$，这导致所有情况下 $Y^\\ast(0) = 0$，因为 $Y$ 的激活项变为零。这可作为另一个基本检验。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the synthetic gene circuit problem by calculating steady-state responses\n    for three different parameter sets and extracting summary statistics.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Test Case 1\n        {\n            # k_a, d_a, K_a, n\n            'activator': (50.0, 1.0, 50.0, 2.0),\n            # k_r, d_r, K_r, m\n            'repressor': (40.0, 1.0, 80.0, 2.0),\n            # k_y, d_y, K_y, p\n            'reporter':  (120.0, 1.0, 30.0, 2.0),\n            # K_i, q\n            'inhibition': (60.0, 2.0)\n        },\n        # Test Case 2\n        {\n            'activator': (50.0, 1.0, 40.0, 2.0),\n            'repressor': (120.0, 1.5, 50.0, 3.0),\n            'reporter':  (120.0, 1.0, 25.0, 2.0),\n            'inhibition': (30.0, 2.0)\n        },\n        # Test Case 3\n        {\n            'activator': (60.0, 1.0, 40.0, 2.0),\n            'repressor': (10.0, 1.0, 100.0, 2.0),\n            'reporter':  (120.0, 1.0, 30.0, 2.0),\n            'inhibition': (10000.0, 1.0)\n        }\n    ]\n\n    # Define the input grid for I.\n    I_grid = np.arange(0, 501, 10, dtype=float)\n    \n    # Store all results in a flat list.\n    all_results = []\n\n    for params in test_cases:\n        # Unpack parameters for clarity.\n        k_a, d_a, K_a, n = params['activator']\n        k_r, d_r, K_r, m = params['repressor']\n        k_y, d_y, K_y, p = params['reporter']\n        K_i, q = params['inhibition']\n\n        # --- Calculate steady-state concentrations using vectorized numpy operations ---\n        \n        # Calculate A*(I)\n        I_n = np.power(I_grid, n)\n        Ka_n = K_a**n\n        # Add a small epsilon to the denominator to prevent division by zero at I=0 if K_a=0\n        A_ss = (k_a / d_a) * (I_n / (Ka_n + I_n + 1e-12))\n        \n        # Calculate R*(I)\n        I_m = np.power(I_grid, m)\n        Kr_m = K_r**m\n        R_ss = (k_r / d_r) * (I_m / (Kr_m + I_m + 1e-12))\n        \n        # Calculate Y*(I)\n        A_ss_p = np.power(A_ss, p)\n        Ky_p = K_y**p\n        activation_term = A_ss_p / (Ky_p + A_ss_p + 1e-12)\n\n        R_ss_q = np.power(R_ss, q)\n        Ki_q = K_i**q\n        repression_term = Ki_q / (Ki_q + R_ss_q + 1e-12)\n        \n        Y_ss_values = (k_y / d_y) * activation_term * repression_term\n\n        # --- Extract summary statistics ---\n        \n        # Find Y_peak and I_peak. np.argmax returns the index of the first maximum.\n        Y_peak = np.max(Y_ss_values)\n        peak_index = np.argmax(Y_ss_values)\n        I_peak = I_grid[peak_index]\n\n        # Get Y*(0) and Y*(500) from the computed array.\n        Y_ss_0 = Y_ss_values[0]\n        Y_ss_500 = Y_ss_values[-1]\n\n        # Append the quadruple to the list of all results.\n        all_results.extend([I_peak, Y_peak, Y_ss_0, Y_ss_500])\n\n    # Final print statement in the exact required format.\n    formatted_results = [f\"{x:.3f}\" for x in all_results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "生物系统的动态行为并非总是稳定地趋向一个平衡点，有时它们会表现出振荡等复杂行为。本练习通过经典的 Rosenzweig-MacArthur 捕食者-被捕食者模型，揭示了著名的“富集悖论”。你将分析当增加被捕食者的环境承载力时，系统如何从一个稳定的共存平衡点失稳，并转变为周期性的种群振荡，从而深入理解生物系统中分岔和极限环等关键概念。",
            "id": "2411240",
            "problem": "考虑带有 Holling II 型功能性响应的 Rosenzweig–MacArthur 捕食者-猎物模型，这是一个标准的常微分方程（ODE）模型，在系统生物学中用于研究营养相互作用和“富集悖论”。该模型由以下方程组给出：\n$$\n\\frac{dR}{dt} = r\\,R\\left(1 - \\frac{R}{K}\\right) - \\frac{a\\,R}{1 + a h R}\\,P,\\qquad\n\\frac{dP}{dt} = e\\,\\frac{a\\,R}{1 + a h R}\\,P - m\\,P,\n$$\n其中，$R$ 表示猎物（资源）密度，$P$ 表示捕食者密度，$r$ 是猎物内禀增长率，$K$ 是猎物环境承载力，$a$ 是捕食者攻击率，$h$ 是捕食者处理时间，$e$ 是转化效率，$m$ 是捕食者死亡率。所有参数均为正且无量纲。\n\n对于固定的参数\n$$\nr = 1.0,\\quad a = 1.0,\\quad h = 0.5,\\quad e = 0.5,\\quad m = 0.2,\n$$\n以及对每个指定的 $K$ 值，判断唯一的正共存平衡点（如果存在）在动力系统意义上是否是局部渐近稳定的。如果对于给定的 $K$ 值，正共存平衡点不存在，则该情况的答案视为非局部渐近稳定。\n\n测试套件：\n- 按此确切顺序使用以下四个 $K$ 值：\n$$\nK \\in \\{1.0,\\ 3.0,\\ 5.0,\\ 0.5\\}.\n$$\n\n你的程序必须为测试套件中的每个 $K$ 值计算一个布尔值，指示正共存平衡点（如果存在）是否局部渐近稳定（输出 $True$）或不是（输出 $False$）。如果正共存平衡点不存在，则该情况输出 $False$。\n\n最终输出格式：\n- 你的程序应生成一行输出，其中包含一个用方括号括起来的逗号分隔的布尔值列表（例如，“[result1,result2,result3,result4]”），其顺序与上面给出的 $K$ 值相同。输出行中不应出现空格。\n- 由于所有参数都是无量纲的，因此不需要物理单位。不涉及角度。任何地方都不要使用百分比；所有数值输出均为指定的布尔值。",
            "solution": "问题陈述需经过验证。\n\n**步骤 1：提取已知条件**\n- **模型：** Rosenzweig–MacArthur 捕食者-猎物模型由以下常微分方程组给出：\n$$\n\\frac{dR}{dt} = r\\,R\\left(1 - \\frac{R}{K}\\right) - \\frac{a\\,R}{1 + a h R}\\,P\n$$\n$$\n\\frac{dP}{dt} = e\\,\\frac{a\\,R}{1 + a h R}\\,P - m\\,P\n$$\n- **变量：** $R$ 是猎物密度，$P$ 是捕食者密度。\n- **参数：** $r$（猎物增长率），$K$（猎物环境承载力），$a$（捕食者攻击率），$h$（捕食者处理时间），$e$（转化效率），$m$（捕食者死亡率）。所有参数均为正且无量纲。\n- **固定参数值：** $r = 1.0$，$a = 1.0$，$h = 0.5$，$e = 0.5$，$m = 0.2$。\n- **测试套件：** 环境承载力 $K$ 从集合 $\\{1.0, 3.0, 5.0, 0.5\\}$ 中取值。\n- **任务：** 对每个 $K$ 值，判断唯一的正共存平衡点是否局部渐近稳定。如果此平衡点不存在，则答案为 `False`。\n\n**步骤 2：使用提取的已知条件进行验证**\n- **科学依据：** Rosenzweig–MacArthur 模型是理论生态学和系统生物学中一个经典的、公认的模型。它具有科学合理性。\n- **良态性：** 该问题是一个动力系统的标准稳定性分析。其定义清晰，提供了所有必要的参数和条件，以便为每种情况找到唯一答案。\n- **客观性：** 该问题使用精确的数学语言和定量数据进行陈述。它不含主观论断。\n\n**步骤 3：结论与行动**\n该问题有效。这是一个定义明确、有科学依据的动力系统稳定性分析练习，与计算生物学相关。将提供完整的解决方案。\n\n**求解推导**\n\n主要任务是确定给定系统的正共存平衡点 $(R^*, P^*)$（其中 $R^*0$ 且 $P^*0$）的局部渐近稳定性。\n\n首先，我们通过将时间导数设为零来求平衡点：\n$$\nR\\left(r\\left(1 - \\frac{R}{K}\\right) - \\frac{a\\,P}{1 + a h R}\\right) = 0\n$$\n$$\nP\\left(e\\,\\frac{a\\,R}{1 + a h R} - m\\right) = 0\n$$\n第二个方程得出 $P=0$ 或 $e\\,\\frac{a\\,R}{1 + a h R} - m = 0$。对于共存平衡点，我们要求 $P^* > 0$。因此，对于猎物密度 $R^*$，必须满足非平凡条件：\n$$\ne\\,\\frac{a\\,R^*}{1 + a h R^*} = m\n$$\n求解 $R^*$：\n$$\ne a R^* = m (1 + a h R^*) \\implies R^*(ea - mah) = m \\implies R^* = \\frac{m}{a(e - mh)}\n$$\n为了使 $R^*$ 为正，鉴于 $a, m, h$ 均为正，分母必须为正：$e - mh > 0$。使用所给参数：$e=0.5$, $m=0.2$, $h=0.5$，我们检查此条件：$0.5 - (0.2)(0.5) = 0.5 - 0.1 = 0.4 > 0$。条件满足。\n我们计算 $R^*$ 的数值：\n$$\nR^* = \\frac{0.2}{1.0 \\times (0.5 - 0.2 \\times 0.5)} = \\frac{0.2}{0.4} = 0.5\n$$\n现在，我们使用第一个平衡方程来求 $P^*$。由于 $R^* > 0$，我们可以除以 $R$：\n$$\nr\\left(1 - \\frac{R^*}{K}\\right) - \\frac{a\\,P^*}{1 + a h R^*} = 0\n$$\n求解 $P^*$：\n$$\nP^* = \\frac{r(1 + a h R^*)}{a} \\left(1 - \\frac{R^*}{K}\\right)\n$$\n为了使 $P^*$ 为正，由于所有参数和 $R^*$ 均为正，我们必须有 $1 - \\frac{R^*}{K} > 0$，这意味着 $K > R^*$。\n因此，当且仅当 $K > R^*$ 时，存在唯一的正共存平衡点。如果 $K \\le R^*$，则不存在这样的平衡点，根据问题定义，该情况被认为是不稳定的。\n\n接下来，我们使用在 $(R^*, P^*)$ 处求值的系统雅可比矩阵来分析此平衡点的局部稳定性。设系统为 $\\frac{dR}{dt}=f(R,P)$ 和 $\\frac{dP}{dt}=g(R,P)$。雅可比矩阵为：\n$$\nJ = \\begin{pmatrix} \\frac{\\partial f}{\\partial R}  \\frac{\\partial f}{\\partial P} \\\\ \\frac{\\partial g}{\\partial R}  \\frac{\\partial g}{\\partial P} \\end{pmatrix}_{(R^*, P^*)}\n$$\n偏导数是：\n$$\n\\frac{\\partial f}{\\partial R} = r - \\frac{2rR}{K} - \\frac{aP}{(1+ahR)^2}\n$$\n$$\n\\frac{\\partial f}{\\partial P} = -\\frac{aR}{1+ahR}\n$$\n$$\n\\frac{\\partial g}{\\partial R} = \\frac{eaP}{(1+ahR)^2}\n$$\n$$\n\\frac{\\partial g}{\\partial P} = \\frac{eaR}{1+ahR} - m\n$$\n在平衡点 $(R^*, P^*)$ 处，根据用于求 $R^*$ 的条件，$\\frac{\\partial g}{\\partial P}$ 项简化为零。\n在平衡点处求值的其他项是：\n$J_{11} = \\frac{\\partial f}{\\partial R}\\Big|_{(R^*, P^*)} = r - \\frac{2rR^*}{K} - \\frac{aP^*}{(1+ahR^*)^2}$\n$J_{12} = \\frac{\\partial f}{\\partial P}\\Big|_{(R^*, P^*)} = -\\frac{aR^*}{1+ahR^*}$\n$J_{21} = \\frac{\\partial g}{\\partial R}\\Big|_{(R^*, P^*)} = \\frac{eaP^*}{(1+ahR^*)^2}$\n$J_{22} = \\frac{\\partial g}{\\partial P}\\Big|_{(R^*, P^*)} = 0$\n\n稳定性由 $J$ 的特征值决定，这些特征值是特征方程 $\\lambda^2 - \\mathrm{Tr}(J)\\lambda + \\mathrm{Det}(J) = 0$ 的根。对于局部渐近稳定性，Routh-Hurwitz 判据要求两个特征值都具有负实部，这对于一个 $2 \\times 2$ 系统等价于 $\\mathrm{Tr}(J)  0$ 和 $\\mathrm{Det}(J) > 0$。\n\n让我们计算行列式：\n$$\n\\mathrm{Det}(J) = J_{11}J_{22} - J_{12}J_{21} = 0 - \\left(-\\frac{aR^*}{1+ahR^*}\\right)\\left(\\frac{eaP^*}{(1+ahR^*)^2}\\right) = \\frac{ea^2R^*P^*}{(1+ahR^*)^3}\n$$\n由于所有参数均为正，并且我们假设存在共存平衡点（$R^*0, P^*0$），我们有 $\\mathrm{Det}(J) > 0$。因此，稳定性条件简化为 $\\mathrm{Tr}(J)  0$。\n\n迹为 $\\mathrm{Tr}(J) = J_{11} + J_{22} = J_{11}$。我们简化 $J_{11}$：\n$$\nJ_{11} = r - \\frac{2rR^*}{K} - \\frac{aP^*}{(1+ahR^*)^2}\n$$\n从 $P^*$ 的平衡条件，我们有 $\\frac{aP^*}{1+ahR^*} = r(1-\\frac{R^*}{K})$。代入此式：\n$$\nJ_{11} = r - \\frac{2rR^*}{K} - \\frac{1}{1+ahR^*} \\frac{aP^*}{1+ahR^*} = r - \\frac{2rR^*}{K} - \\frac{r}{1+ahR^*}\\left(1-\\frac{R^*}{K}\\right)\n$$\n$$\nJ_{11} = \\left(r - \\frac{rR^*}{K}\\right) - \\frac{rR^*}{K} - \\frac{r}{1+ahR^*} + \\frac{rR^*}{K(1+ahR^*)}\n$$\n$$\nJ_{11} = \\frac{ahR^*r}{1+ahR^*} - \\frac{rR^*}{K}\\left(\\frac{1+2ahR^*}{1+ahR^*}\\right) = \\frac{rR^*}{1+ahR^*}\\left(ah - \\frac{1+2ahR^*}{K}\\right)\n$$\n由于 $\\frac{rR^*}{1+ahR^*} > 0$，条件 $\\mathrm{Tr}(J)  0$ 变为：\n$$\nah - \\frac{1+2ahR^*}{K}  0 \\implies ahK  1+2ahR^* \\implies K(ah) - 1  2ahR^*\n$$\n这个不等式给出了局部渐近稳定性的条件。当迹为零时，发生 Hopf 分岔，此时系统失去稳定性并出现极限环。这种分岔是“富集悖论”的特征。\n\n总之，对于给定的 $K$，当且仅当同时满足以下两个条件时，正共存平衡点是局部渐近稳定的：\n1. 存在性：$K > R^*$\n2. 稳定性：$ahK  1+2ahR^*$\n\n我们使用计算出的值 $R^* = 0.5$ 和其他参数 $a=1.0, h=0.5 \\implies ah=0.5$ 将这些条件应用于测试套件。\n\n稳定性条件变为：$0.5 K  1 + 2(0.5)(0.5) \\implies 0.5 K  1.5 \\implies K  3$。\n存在性条件是 $K > 0.5$。\n结合这两个条件，如果 $0.5  K  3$，则平衡点存在且稳定。\n\n我们现在评估每种情况：\n- 对于 $K = 1.0$：我们检查是否 $0.5  1.0  3$。这是成立的。平衡点存在且稳定。结果是 `True`。\n- 对于 $K = 3.0$：我们检查是否 $0.5  3.0  3$。这是不成立的，因为 $3.0$ 并不严格小于 $3$。在此值处，$Tr(J) = 0$，系统处于稳定性阈值（Hopf 分岔），但不是渐近稳定的。结果是 `False`。\n- 对于 $K = 5.0$：我们检查是否 $0.5  5.0  3$。这是不成立的。平衡点存在但不稳定。结果是 `False`。\n- 对于 $K = 0.5$：我们检查是否 $0.5  0.5  3$。这是不成立的，因为 $0.5$ 并不严格大于 $0.5$。在此值处，$P^*=0$，因此不存在正共存平衡点。结果是 `False`。\n\n结果序列是 `True`、`False`、`False`、`False`。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Rosenzweig-MacArthur stability problem for a given set of parameters\n    and a test suite of K values.\n    \"\"\"\n    \n    # Define fixed parameters as specified in the problem statement.\n    # All parameters are dimensionless.\n    r = 1.0  # intrinsic prey growth rate\n    a = 1.0  # predator attack rate\n    h = 0.5  # predator handling time\n    e = 0.5  # conversion efficiency\n    m = 0.2  # predator mortality rate\n    \n    # Define the test suite for the carrying capacity K.\n    test_cases_K = [1.0, 3.0, 5.0, 0.5]\n    \n    results = []\n\n    # Check the condition for a physically meaningful prey equilibrium density R*.\n    # R* must be positive, which requires e - m*h > 0.\n    if e - m * h = 0:\n        # If this condition is not met, R* would be non-positive or undefined.\n        # This would mean no positive coexistence equilibrium can exist for any K.\n        # For the given parameters, e - m*h = 0.5 - 0.2*0.5 = 0.4 > 0, so this path is not taken.\n        results = [False] * len(test_cases_K)\n    else:\n        # Calculate the positive equilibrium density of the prey, R*.\n        R_star = m / (a * (e - m * h))\n        \n        # Loop through each provided value of K to determine stability.\n        for K in test_cases_K:\n            # Condition 1: Existence of a positive coexistence equilibrium.\n            # This requires the predator equilibrium density P* to be positive.\n            # P* > 0 requires K > R*.\n            exists = K > R_star\n            \n            if not exists:\n                # If a positive coexistence equilibrium does not exist, the answer is False\n                # as per the problem specification.\n                results.append(False)\n                continue\n                \n            # Condition 2: Local asymptotic stability of the equilibrium.\n            # This is determined by the trace of the Jacobian matrix: Tr(J)  0.\n            # The condition Tr(J)  0 simplifies to ahK  1 + 2ahR*.\n            is_stable = (a * h * K)  (1 + 2 * a * h * R_star)\n            \n            results.append(is_stable)\n\n    # Format the final output as a comma-separated list of booleans\n    # enclosed in square brackets, with no spaces.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}