{
    "hands_on_practices": [
        {
            "introduction": "在我们的第一个动手实践中，我们将从基础开始，探索一个核心的基因调控模块。我们将建立一个包含“启动子泄漏”这一现实因素的基因激活模型，并推导出一个关键的实验可测量参数——半最大效应输入浓度 $u_{50}$ 。这个练习将帮助你理解模型参数如何与生物系统的宏观响应特性相关联，并展示数学分析在量化基因调控中的力量。",
            "id": "2409958",
            "problem": "单输入模块是一种常见的基因调控网络基序，其中一个转录因子调控一组具有相似启动子结构的靶基因。考虑一个其启动子表现出基础渗漏的单一靶基因。设输入转录因子浓度用 $u$ 表示，并假设其激活过程由一个带基础活性的希尔函数描述。蛋白质浓度 $x(t)$ 服从以下确定性常微分方程\n$$\n\\frac{dx}{dt} \\;=\\; \\alpha \\;+\\; \\beta \\,\\frac{u^{n}}{K^{n} + u^{n}} \\;-\\; \\gamma\\, x,\n$$\n其中 $\\alpha0$ 是启动子渗漏（在没有输入时基础生产速率），$\\beta0$ 是在基础速率之上的最大激活增强生产， $K0$ 是激活解离常数（在没有渗漏的情况下，希尔函数值等于 $1/2$ 时的输入水平），$n0$ 是希尔系数，$\\gamma0$ 是一阶降解-稀释速率常数。\n\n将对固定输入 $u$ 的稳态响应定义为 $x^{\\ast}(u)$，并令 $x^{\\ast}_{\\max}$ 表示当 $u \\to \\infty$ 时达到的渐近最大稳态水平。在许多实验方案中，“半最大输入”在操作上被定义为使得稳态输出等于最大稳态输出一半的输入 $u_{50}$，即\n$$\nx^{\\ast}\\!\\left(u_{50}\\right) \\;=\\; \\frac{x^{\\ast}_{\\max}}{2}.\n$$\n假设 $0  \\alpha  \\beta$ 以确保该操作性定义能够产生唯一的 $u_{50}$。\n\n推导 $u_{50}$ 关于 $\\alpha$、$\\beta$、$K$ 和 $n$ 的闭式解析表达式。将您的最终答案表示为单个简化的符号表达式。不需要数值近似，最终表达式中也不应包含单位。",
            "solution": "首先对问题陈述进行验证。\n\n步骤1：提取已知条件\n- 蛋白质浓度 $x(t)$ 的微分方程：$\\frac{dx}{dt} = \\alpha + \\beta \\frac{u^{n}}{K^{n} + u^{n}} - \\gamma x$。\n- $u$：输入转录因子浓度。\n- $x(t)$：蛋白质浓度。\n- $\\alpha > 0$：启动子渗漏（基础生产速率）。\n- $\\beta > 0$：最大激活增强生产速率。\n- $K > 0$：激活解离常数。\n- $n > 0$：希尔系数。\n- $\\gamma > 0$：一阶降解-稀释速率常数。\n- $x^{\\ast}(u)$：对固定输入 $u$ 的稳态响应。\n- $x^{\\ast}_{\\max}$：当 $u \\to \\infty$ 时的渐近最大稳态水平。\n- 半最大输入 $u_{50}$ 的定义：$x^{\\ast}(u_{50}) = \\frac{x^{\\ast}_{\\max}}{2}$。\n- 条件：$0  \\alpha  \\beta$。\n\n步骤2：使用提取的已知条件进行验证\n该问题具有科学依据，因为它基于系统生物学和合成生物学中一个标准的、成熟的基因表达确定性常微分方程模型。该模型包含了用于激活的希尔动力学和一个用于基础表达的项，这些都是常见的生物物理现象。该问题是适定的；它提供了所有必要的参数和一个清晰、明确的目标。明确给出了条件 $0  \\alpha  \\beta$，以确保存在一个唯一的、具有物理意义的解，这可以防止问题变得不适定。所用术语在计算生物学领域是精确且标准的。不存在科学、逻辑或事实上的缺陷。\n\n步骤3：结论与行动\n问题有效。将推导一个完整的解。\n\n第一步是确定对于一个恒定输入 $u$ 的稳态蛋白质浓度 $x^{\\ast}(u)$。在稳态下，蛋白质浓度的变化率为零，即 $\\frac{dx}{dt} = 0$。将给定的常微分方程设为零，得到：\n$$\n0 = \\alpha + \\beta \\frac{u^{n}}{K^{n} + u^{n}} - \\gamma x^{\\ast}(u)\n$$\n解出 $x^{\\ast}(u)$，我们得到稳态响应函数：\n$$\nx^{\\ast}(u) = \\frac{1}{\\gamma} \\left( \\alpha + \\beta \\frac{u^{n}}{K^{n} + u^{n}} \\right)\n$$\n接下来，我们确定渐近最大稳态水平 $x^{\\ast}_{\\max}$，它被定义为当输入 $u$ 趋于无穷大时 $x^{\\ast}(u)$ 的极限。\n$$\nx^{\\ast}_{\\max} = \\lim_{u \\to \\infty} x^{\\ast}(u) = \\lim_{u \\to \\infty} \\frac{1}{\\gamma} \\left( \\alpha + \\beta \\frac{u^{n}}{K^{n} + u^{n}} \\right)\n$$\n为了计算这个极限，我们分析当 $u \\to \\infty$ 时希尔函数项：\n$$\n\\lim_{u \\to \\infty} \\frac{u^{n}}{K^{n} + u^{n}} = \\lim_{u \\to \\infty} \\frac{1}{\\frac{K^{n}}{u^{n}} + 1} = \\frac{1}{0 + 1} = 1\n$$\n将此结果代回 $x^{\\ast}_{\\max}$ 的表达式中，我们发现：\n$$\nx^{\\ast}_{\\max} = \\frac{1}{\\gamma} (\\alpha + \\beta(1)) = \\frac{\\alpha + \\beta}{\\gamma}\n$$\n问题将半最大输入 $u_{50}$ 定义为使得稳态输出是其最大值一半时的输入水平：\n$$\nx^{\\ast}(u_{50}) = \\frac{x^{\\ast}_{\\max}}{2}\n$$\n将 $x^{\\ast}(u)$ 和 $x^{\\ast}_{\\max}$ 的表达式代入此定义方程中：\n$$\n\\frac{1}{\\gamma} \\left( \\alpha + \\beta \\frac{u_{50}^{n}}{K^{n} + u_{50}^{n}} \\right) = \\frac{1}{2} \\left( \\frac{\\alpha + \\beta}{\\gamma} \\right)\n$$\n因子 $\\frac{1}{\\gamma}$ 出现在等式两边，并且由于 $\\gamma > 0$ 可以被消去。\n$$\n\\alpha + \\beta \\frac{u_{50}^{n}}{K^{n} + u_{50}^{n}} = \\frac{\\alpha + \\beta}{2}\n$$\n我们现在必须解这个方程以求得 $u_{50}$。首先，我们分离出含有 $u_{50}$ 的项：\n$$\n\\beta \\frac{u_{50}^{n}}{K^{n} + u_{50}^{n}} = \\frac{\\alpha + \\beta}{2} - \\alpha = \\frac{\\alpha + \\beta - 2\\alpha}{2} = \\frac{\\beta - \\alpha}{2}\n$$\n因为 $\\beta > 0$，我们可以在等式两边同除以 $\\beta$：\n$$\n\\frac{u_{50}^{n}}{K^{n} + u_{50}^{n}} = \\frac{\\beta - \\alpha}{2\\beta}\n$$\n所给定的条件 $0  \\alpha  \\beta$ 确保了等式右边为正且小于 $\\frac{1}{2}$，这对于 $u_{50}$ 存在实正解是必要的。\n令 $Z = u_{50}^{n}$。方程变为：\n$$\n\\frac{Z}{K^{n} + Z} = \\frac{\\beta - \\alpha}{2\\beta}\n$$\n我们解出 $Z$：\n$$\n2\\beta Z = (\\beta - \\alpha)(K^{n} + Z)\n$$\n$$\n2\\beta Z = (\\beta - \\alpha)K^{n} + (\\beta - \\alpha)Z\n$$\n$$\n(2\\beta - (\\beta - \\alpha))Z = (\\beta - \\alpha)K^{n}\n$$\n$$\n(\\beta + \\alpha)Z = (\\beta - \\alpha)K^{n}\n$$\n因为 $\\alpha > 0$ 且 $\\beta > 0$，项 $\\beta+\\alpha$ 非零，所以我们可以用它来除：\n$$\nZ = K^{n} \\frac{\\beta - \\alpha}{\\beta + \\alpha}\n$$\n代回 $Z = u_{50}^{n}$：\n$$\nu_{50}^{n} = K^{n} \\frac{\\beta - \\alpha}{\\beta + \\alpha}\n$$\n最后，我们对等式两边取 $n$ 次根来求 $u_{50}$。由于 $u_{50}$ 代表浓度，我们取实正根：\n$$\nu_{50} = \\left( K^{n} \\frac{\\beta - \\alpha}{\\beta + \\alpha} \\right)^{\\frac{1}{n}} = K \\left( \\frac{\\beta - \\alpha}{\\beta + \\alpha} \\right)^{\\frac{1}{n}}\n$$\n这就是 $u_{50}$ 的闭式解析表达式。",
            "answer": "$$\n\\boxed{K \\left( \\frac{\\beta - \\alpha}{\\beta + \\alpha} \\right)^{\\frac{1}{n}}}\n$$"
        },
        {
            "introduction": "现在，我们从静态响应转向动态行为。这个练习将探讨生物学中最迷人的模体之一：三节点负反馈环，也被称为“压控振荡器”（repressilator）。通过运用动力系统理论，我们将精确地确定该网络结构在何种条件下能够作为一个生物钟，产生持续的振荡。这个分析揭示了网络拓扑结构与其动态功能之间的深刻联系。",
            "id": "2409935",
            "problem": "一个转录调控网络基序由一个三节点环构成，其中每个基因抑制下一个基因：基因$1$抑制基因$2$，基因$2$抑制基因$3$，基因$3$抑制基因$1$。设 $x_{i}(t)$ 表示在时间 $t$ 时基因 $i$ 的蛋白质产物的浓度，其中 $i \\in \\{1,2,3\\}$。假设具有相同的时间常数 $\\tau0$ 的线性降解和相同的合成过程，该合成过程由一个抑制性希尔函数描述，其最大速率为 $\\alpha0$，解离常数为 $K_{d}0$，希尔系数为 $n1$。描述这个三节点负反馈回路的机理性常微分方程（ODE）模型为\n$$\n\\frac{d x_{1}}{d t} \\;=\\; -\\frac{x_{1}}{\\tau} \\;+\\; \\frac{\\alpha}{1 + \\left(\\frac{x_{3}}{K_{d}}\\right)^{n}},\\qquad\n\\frac{d x_{2}}{d t} \\;=\\; -\\frac{x_{2}}{\\tau} \\;+\\; \\frac{\\alpha}{1 + \\left(\\frac{x_{1}}{K_{d}}\\right)^{n}},\\qquad\n\\frac{d x_{3}}{d t} \\;=\\; -\\frac{x_{3}}{\\tau} \\;+\\; \\frac{\\alpha}{1 + \\left(\\frac{x_{2}}{K_{d}}\\right)^{n}}.\n$$\n假设存在一个对称稳态 $(x_{1},x_{2},x_{3}) = (x^{*},x^{*},x^{*})$，其中 $x^{*}0$。定义合成函数 $f(x) = \\dfrac{\\alpha}{1 + \\left(\\dfrac{x}{K_{d}}\\right)^{n}}$，并令 $f'(x^{*})0$ 表示其在 $x^{*}$ 处的导数。引入无量纲单级增益 $g = |f'(x^{*})|\\,\\tau$。\n\n分析该对称稳态附近的局部动力学，并确定一对共轭复特征值首次穿过虚轴（即可能发生局部霍普夫分岔）时的精确临界值 $g_{\\mathrm{crit}}$。将 $g_{\\mathrm{crit}}$ 以纯数形式报告。无需四舍五入。最终答案必须是单个实数。",
            "solution": "该问题要求确定一个三耦合常微分方程（ODE）系统中霍普夫分岔发生的临界参数值。该系统模拟了一个遗传抑制振荡器。该系统由以下方程给出：\n$$\n\\frac{d x_{1}}{d t} \\;=\\; -\\frac{x_{1}}{\\tau} \\;+\\; f(x_{3})\n$$\n$$\n\\frac{d x_{2}}{d t} \\;=\\; -\\frac{x_{2}}{\\tau} \\;+\\; f(x_{1})\n$$\n$$\n\\frac{d x_{3}}{d t} \\;=\\; -\\frac{x_{3}}{\\tau} \\;+\\; f(x_{2})\n$$\n其中 $x_{i}(t)$ 是蛋白质 $i$ 的浓度，$\\tau  0$ 是降解时间常数，$f(x) = \\frac{\\alpha}{1 + \\left(\\frac{x}{K_{d}}\\right)^{n}}$ 是抑制性合成函数。已知存在一个对称稳态 $(x^{*}, x^{*}, x^{*})$，其中 $x^{*}  0$。\n\n为分析此稳态的局部稳定性，我们对系统进行线性化。这需要计算在稳态处求值的雅可比矩阵 $J$。雅可比矩阵的元素由 $J_{ij} = \\frac{\\partial}{\\partial x_{j}} \\left( \\frac{dx_{i}}{dt} \\right)$ 给出。\n向量场为 $\\mathbf{F}(\\mathbf{x}) = (F_{1}, F_{2}, F_{3})^{T}$，其中\n$F_{1}(x_{1}, x_{2}, x_{3}) = -x_{1}/\\tau + f(x_{3})$，\n$F_{2}(x_{1}, x_{2}, x_{3}) = -x_{2}/\\tau + f(x_{1})$，\n$F_{3}(x_{1}, x_{2}, x_{3}) = -x_{3}/\\tau + f(x_{2})$。\n\n偏导数为：\n$$\n\\frac{\\partial F_{1}}{\\partial x_{1}} = -\\frac{1}{\\tau}, \\quad \\frac{\\partial F_{1}}{\\partial x_{2}} = 0, \\quad \\frac{\\partial F_{1}}{\\partial x_{3}} = f'(x_{3})\n$$\n$$\n\\frac{\\partial F_{2}}{\\partial x_{1}} = f'(x_{1}), \\quad \\frac{\\partial F_{2}}{\\partial x_{2}} = -\\frac{1}{\\tau}, \\quad \\frac{\\partial F_{2}}{\\partial x_{3}} = 0\n$$\n$$\n\\frac{\\partial F_{3}}{\\partial x_{1}} = 0, \\quad \\frac{\\partial F_{3}}{\\partial x_{2}} = f'(x_{2}), \\quad \\frac{\\partial F_{3}}{\\partial x_{3}} = -\\frac{1}{\\tau}\n$$\n在稳态 $(x^{*}, x^{*}, x^{*})$ 处对这些偏导数求值，得到雅可比矩阵：\n$$\nJ =\n\\begin{pmatrix}\n-\\frac{1}{\\tau}  0  f'(x^{*}) \\\\\nf'(x^{*})  -\\frac{1}{\\tau}  0 \\\\\n0  f'(x^{*})  -\\frac{1}{\\tau}\n\\end{pmatrix}\n$$\n局部动力学由该矩阵的特征值 $\\lambda$ 决定，这些特征值是特征方程 $\\det(J - \\lambda I) = 0$ 的根，其中 $I$ 是 $3 \\times 3$ 的单位矩阵。\n$$\n\\det\n\\begin{pmatrix}\n-\\frac{1}{\\tau} - \\lambda  0  f'(x^{*}) \\\\\nf'(x^{*})  -\\frac{1}{\\tau} - \\lambda  0 \\\\\n0  f'(x^{*})  -\\frac{1}{\\tau} - \\lambda\n\\end{pmatrix}\n= 0\n$$\n沿第一行展开行列式：\n$$\n\\left(-\\frac{1}{\\tau} - \\lambda\\right) \\left[ \\left(-\\frac{1}{\\tau} - \\lambda\\right)^{2} - 0 \\right] - 0 + f'(x^{*}) \\left[ f'(x^{*}) \\cdot f'(x^{*}) - 0 \\right] = 0\n$$\n这可以简化为：\n$$\n\\left(-\\frac{1}{\\tau} - \\lambda\\right)^{3} + \\left(f'(x^{*})\\right)^{3} = 0\n$$\n$$\n\\left(\\lambda + \\frac{1}{\\tau}\\right)^{3} = \\left(f'(x^{*})\\right)^{3}\n$$\n让我们定义一个新变量 $z = \\lambda + \\frac{1}{\\tau}$ 并设 $A = f'(x^{*})$。方程变为 $z^{3} = A^{3}$。$z$ 的解是 $A^3$ 的立方根，即 $A \\cdot \\exp(i\\frac{2\\pi k}{3})$，其中 $k \\in \\{0, 1, 2\\}$。\n三个根是：\n$z_{0} = A \\cdot \\exp(0) = A$\n$z_{1} = A \\cdot \\exp(i\\frac{2\\pi}{3}) = A \\left( \\cos(\\frac{2\\pi}{3}) + i\\sin(\\frac{2\\pi}{3}) \\right) = A \\left(-\\frac{1}{2} + i\\frac{\\sqrt{3}}{2}\\right)$\n$z_{2} = A \\cdot \\exp(i\\frac{4\\pi}{3}) = A \\left( \\cos(\\frac{4\\pi}{3}) + i\\sin(\\frac{4\\pi}{3}) \\right) = A \\left(-\\frac{1}{2} - i\\frac{\\sqrt{3}}{2}\\right)$\n\n现在，我们求解特征值 $\\lambda = z - \\frac{1}{\\tau}$：\n$\\lambda_{1} = A - \\frac{1}{\\tau} = f'(x^{*}) - \\frac{1}{\\tau}$\n$\\lambda_{2} = A \\left(-\\frac{1}{2} + i\\frac{\\sqrt{3}}{2}\\right) - \\frac{1}{\\tau} = -\\frac{f'(x^{*})}{2} - \\frac{1}{\\tau} + i \\frac{\\sqrt{3}}{2}f'(x^{*})$\n$\\lambda_{3} = A \\left(-\\frac{1}{2} - i\\frac{\\sqrt{3}}{2}\\right) - \\frac{1}{\\tau} = -\\frac{f'(x^{*})}{2} - \\frac{1}{\\tau} - i \\frac{\\sqrt{3}}{2}f'(x^{*})$\n\n当一对共轭复特征值穿过虚轴时，发生霍普夫分岔。这要求它们的实部为零，而虚部不为零。特征值 $\\lambda_{2}$ 和 $\\lambda_{3}$ 构成了这样的一对。\n虚部为 $\\pm \\frac{\\sqrt{3}}{2}f'(x^{*})$。因为给定 $n > 1$，所以对于 $x0$，$f(x)$ 是一个严格递减函数，因此 $f'(x^{*})  0$。所以，虚部不为零。\n分岔条件是这对特征值的实部变为零：\n$$\n\\text{Re}(\\lambda_{2,3}) = -\\frac{f'(x^{*})}{2} - \\frac{1}{\\tau} = 0\n$$\n这给出：\n$$\n-f'(x^{*}) = \\frac{2}{\\tau}\n$$\n问题定义了无量纲单级增益 $g = |f'(x^{*})|\\tau$。因为我们知道 $f'(x^{*})  0$，所以有 $|f'(x^{*})| = -f'(x^{*})$。因此，$g$ 的定义是 $g = -f'(x^{*})\\tau$。\n我们可以将其重新整理，将 $-f'(x^{*})$ 表示为 $\\frac{g}{\\tau}$。\n将此代入分岔条件：\n$$\n\\frac{g}{\\tau} = \\frac{2}{\\tau}\n$$\n由于 $\\tau  0$，我们可以在等式两边同乘以 $\\tau$ 来求得 $g$ 的临界值：\n$$\ng_{\\mathrm{crit}} = 2\n$$\n在这个值上，复特征值的实部为零，表明持续振荡的开始。第一个特征值 $\\lambda_1 = f'(x^*) - 1/\\tau$ 的实部总是负的，因为 $f'(x^*)0$ 且 $1/\\tau > 0$，所以它对应一个稳定模式，不参与分岔。\n因此，增益的临界值恰好是 $2$。",
            "answer": "$$\\boxed{2}$$"
        },
        {
            "introduction": "我们的最终实践将带领我们进入*计算机模拟实验*（*in silico* experimentation）的领域。我们将构建一个更复杂的网络计算模型——一个相干前馈环与一个负自调控的组合。通过编写程序来模拟其动态响应，你将亲手发现，增加一条调控边如何能够显著地塑造系统的动态性能，例如加快其响应速度。这个练习突显了计算方法在揭示复杂生物网络设计原理方面的重要性。",
            "id": "2409950",
            "problem": "要求您量化在一个具有与逻辑门的一致性前馈环 (FFL) 中，为中间节点 $B$ 添加一个自抑制（负向自动调节）边如何影响输出节点 $C$ 的动态行为。从基因调控动力学的核心定义开始：由一阶降解平衡的产生过程，以及由S形Hill函数建模的转录调控。考虑一个具有有向边 $A \\to B \\to C$ 和 $A \\to C$ 的三基因网络，并作出以下假设：\n\n- 每个节点 $X \\in \\{A,B,C\\}$ 是一个非负无量纲浓度 $X(t) \\ge 0$，由以下形式的一阶微分方程控制\n$$\n\\frac{dX}{dt} \\;=\\; \\frac{P_X(\\cdot) - X}{\\tau_X},\n$$\n其中 $P_X(\\cdot)$ 是无量纲产生项，$\\tau_X  0$ 是以降分钟为单位的降解时间常数。\n- $A$ 的输入是一个阶跃函数 $u(t)$，在时间 $t=0$ 时从 $u(0^-)=0$ 变为 $u(0^+)=1$。$A$ 的产生项为 $P_A(u)=u(t)$，因此\n$$\n\\frac{dA}{dt} \\;=\\; \\frac{u(t) - A}{\\tau_A}.\n$$\n- 激活Hill函数为\n$$\nH_{\\mathrm{act}}(x;K,n) \\;=\\; \\frac{x^n}{K^n + x^n},\n$$\n抑制Hill函数为\n$$\nH_{\\mathrm{rep}}(x;K,n) \\;=\\; \\frac{K^n}{K^n + x^n} \\;=\\; \\frac{1}{1+(x/K)^n}.\n$$\n- 无自抑制时 $B$ 的产生项为\n$$\nP_B^{(0)}(A) \\;=\\; \\alpha_B \\, H_{\\mathrm{act}}(A;K_{AB},n_{AB}),\n$$\n带有负向自动调节（自抑制）时，其产生项为\n$$\nP_B^{(-)}(A,B) \\;=\\; \\alpha_B \\, H_{\\mathrm{act}}(A;K_{AB},n_{AB}) \\, H_{\\mathrm{rep}}(B;K_{BB},n_{BB}).\n$$\n- $C$ 的产生使用一个与逻辑门，实现为来自 $A$ 和 $B$ 的激活作用的乘积：\n$$\nP_C(A,B) \\;=\\; \\alpha_C \\, H_{\\mathrm{act}}(A;K_{AC},n_{AC}) \\, H_{\\mathrm{act}}(B;K_{BC},n_{BC}).\n$$\n\n您的任务是编写一个程序，对每个测试用例的两种情景进行数值模拟，以响应阶跃输入：$B$ 无自抑制（基线情景）和 $B$ 有自抑制（负向自动调节情景）。对于每种情景，计算输出 $C(t)$ 的以下三个量化指标：\n\n- 半上升时间 $t_{50}$，定义为满足 $C(t) \\ge 0.5 \\, C_{\\infty}$ 的最早时间 $t$，其中 $C_{\\infty}$ 是给定情景下 $C$ 的稳态值。\n- 过冲比 $r_{\\mathrm{ov}}$，定义为 $r_{\\mathrm{ov}} = \\max_t C(t) / C_{\\infty} - 1$，以小数形式表示（非百分比）。\n- 峰值时间 $t_{\\mathrm{peak}}$，定义为 $C(t)$ 达到其最大值的时间。\n\n然后，对每个测试用例，报告以下差异\n$$\n\\Delta t_{50} = t_{50}^{(-)} - t_{50}^{(0)}, \\quad \\Delta r_{\\mathrm{ov}} = r_{\\mathrm{ov}}^{(-)} - r_{\\mathrm{ov}}^{(0)}, \\quad \\Delta t_{\\mathrm{peak}} = t_{\\mathrm{peak}}^{(-)} - t_{\\mathrm{peak}}^{(0)},\n$$\n其中上标 $(0)$ 和 $(-)$ 分别表示基线情景和负向自动调节情景。所有时间必须以分钟报告。过冲比是无量纲的，必须以小数形式报告。\n\n为确保通用性和可复现性的实现细节：\n\n- 使用四阶龙格-库塔方法，在均匀网格 $t=0, \\Delta t, 2\\Delta t, \\dots, T_{\\max}$ 上进行定步长数值积分，步长 $\\Delta t = 0.01$ 分钟，最终时间 $T_{\\max}=100$ 分钟。\n- 初始条件为 $A(0)=0$, $B(0)=0$, $C(0)=0$。\n- 将 $C_{\\infty}$ 估计为在 $t=T_{\\max}$ 时的最终模拟值。\n\n测试套件：对于每个测试，模拟两种情景（基线和负向自动调节）。下面未明确列出的参数在同一测试用例的两种情景中是相同的。\n\n- 测试 1 (正常路径):\n  - $\\tau_A=1$, $\\tau_B=2$, $\\tau_C=5$; $\\alpha_B=1$, $\\alpha_C=1$.\n  - $K_{AB}=0.5$, $n_{AB}=2$; $K_{AC}=0.5$, $n_{AC}=2$; $K_{BC}=0.5$, $n_{BC}=2$.\n  - 负向自动调节参数: $K_{BB}=0.5$, $n_{BB}=2$.\n- 测试 2 (弱自抑制边界):\n  - $\\tau_A=1$, $\\tau_B=2$, $\\tau_C=5$; $\\alpha_B=1$, $\\alpha_C=1$.\n  - $K_{AB}=0.5$, $n_{AB}=2$; $K_{AC}=0.5$, $n_{AC}=2$; $K_{BC}=0.5$, $n_{BC}=2$.\n  - 负向自动调节参数: $K_{BB}=5.0$, $n_{BB}=2$.\n- 测试 3 (强自抑制与快速B):\n  - $\\tau_A=1$, $\\tau_B=0.5$, $\\tau_C=5$; $\\alpha_B=1$, $\\alpha_C=1$.\n  - $K_{AB}=0.5$, $n_{AB}=2$; $K_{AC}=0.5$, $n_{AC}=2$; $K_{BC}=0.5$, $n_{BC}=2$.\n  - 负向自动调节参数: $K_{BB}=0.2$, $n_{BB}=3$.\n- 测试 4 (慢速B动力学):\n  - $\\tau_A=1$, $\\tau_B=10$, $\\tau_C=5$; $\\alpha_B=1$, $\\alpha_C=1$.\n  - $K_{AB}=0.5$, $n_{AB}=2$; $K_{AC}=0.5$, $n_{AC}=2$; $K_{BC}=0.5$, $n_{BC}=2$.\n  - 负向自动调节参数: $K_{BB}=0.5$, $n_{BB}=2$.\n\n必需的最终输出格式：您的程序应生成单行输出，包含一个用方括号括起来的逗号分隔列表。每个测试用例贡献一个三元素列表 $[\\Delta t_{50}, \\Delta r_{\\mathrm{ov}}, \\Delta t_{\\mathrm{peak}}]$。因此，最终输出必须是以下形式的单行\n$[\\,[\\Delta t_{50}^{(1)},\\Delta r_{\\mathrm{ov}}^{(1)},\\Delta t_{\\mathrm{peak}}^{(1)}],\\,[\\Delta t_{50}^{(2)},\\Delta r_{\\mathrm{ov}}^{(2)},\\Delta t_{\\mathrm{peak}}^{(2)}],\\,[\\Delta t_{50}^{(3)},\\Delta r_{\\mathrm{ov}}^{(3)},\\Delta t_{\\mathrm{peak}}^{(3)}],\\,[\\Delta t_{50}^{(4)},\\Delta r_{\\mathrm{ov}}^{(4)},\\Delta t_{\\mathrm{peak}}^{(4)}]\\,]$, 所有时间以分钟为单位，过冲比为小数。",
            "solution": "该问题是有效的。它提出了一个定义明确的常微分方程组，该方程组为一个常见的生物网络基序——一致性前馈环 (FFL) ——建模，并要求在有和无负向自动调节两种条件下对其动态响应进行定量分析。该公式基于系统生物学的既定原则，采用一阶降解动力学和Hill函数进行转录调控。所有参数、初始条件和数值积分规范都已提供，使得该问题自成体系、客观且有科学依据。\n\n所研究的系统是一个由基因 $A$、$B$ 和 $C$ 组成的三节点基因调控网络。其产物的浓度由无量纲变量 $A(t)$、$B(t)$ 和 $C(t)$ 表示，根据以下耦合常微分方程组演化：\n$$\n\\frac{dA}{dt} = \\frac{u(t) - A}{\\tau_A}\n$$\n$$\n\\frac{dB}{dt} = \\frac{P_B - B}{\\tau_B}\n$$\n$$\n\\frac{dC}{dt} = \\frac{P_C(A,B) - C}{\\tau_C}\n$$\n其中 $\\tau_X  0$ 是物种 $X$ 的降解时间常数。该系统由外部输入信号 $u(t)$ 驱动，该信号是一个从 $u(0^-)=0$ 变为 $u(0^+)=1$ 的阶跃函数。系统的初始状态为 $A(0)=0$, $B(0)=0$ 和 $C(0)=0$。\n\n产生项 $P_B$ 和 $P_C$ 描述了调控相互作用。问题对比了两种关于基因 $B$ 调控的情景：\n$1$. 基线情景（上标 $(0)$），其中 $B$ 仅受 $A$ 调控：\n$$\nP_B^{(0)}(A) = \\alpha_B \\, H_{\\mathrm{act}}(A;K_{AB},n_{AB})\n$$\n$2$. 负向自动调节情景（上标 $(-)$），其中 $B$ 抑制自身的产生：\n$$\nP_B^{(-)}(A,B) = \\alpha_B \\, H_{\\mathrm{act}}(A;K_{AB},n_{AB}) \\, H_{\\mathrm{rep}}(B;K_{BB},n_{BB})\n$$\n这里，$\\alpha_B$ 是最大产生速率，$H_{\\mathrm{act}}$ 和 $H_{\\mathrm{rep}}$ 分别是用于激活和抑制的标准S形Hill函数：\n$$\nH_{\\mathrm{act}}(x;K,n) = \\frac{x^n}{K^n + x^n}, \\quad H_{\\mathrm{rep}}(x;K,n) = \\frac{K^n}{K^n + x^n} = \\frac{1}{1+(x/K)^n}\n$$\n参数 $K$ 和 $n$ 分别代表激活/抑制阈值和Hill系数（响应的陡峭程度）。\n\n$C$ 的产生由 $A$ 和 $B$ 通过一个与逻辑门共同控制，数学上实现为它们各自激活影响的乘积：\n$$\nP_C(A,B) = \\alpha_C \\, H_{\\mathrm{act}}(A;K_{AC},n_{AC}) \\, H_{\\mathrm{act}}(B;K_{BC},n_{BC})\n$$\n这种具有有向边 $A \\to B \\to C$ 和 $A \\to C$ 的结构定义了一个1型一致性前馈环。与逻辑要求 $A$ 和 $B$ 同时存在才能强力激活 $C$。已知这种网络拓扑结构可作为一种符号敏感的延迟元件，对持续的输入信号作出响应，但会滤除短暂的瞬时脉冲。\n\n为了求解该系统，我们必须进行数值积分。问题指定了在区间 $[0, T_{\\max}=100]$ 上使用四阶龙格-库塔 (RK4) 方法，固定时间步长为 $\\Delta t = 0.01$ 分钟。设状态向量为 $\\mathbf{y}(t) = [A(t), B(t), C(t)]^T$。该常微分方程组可写作 $\\frac{d\\mathbf{y}}{dt} = \\mathbf{F}(\\mathbf{y})$，其中对于 $t \\ge 0$，$u(t)=1$，系统是自治的：\n$$\n\\mathbf{F}(\\mathbf{y}) = \\begin{pmatrix} (1 - y_1) / \\tau_A \\\\ (P_B(y_1, y_2) - y_2) / \\tau_B \\\\ (P_C(y_1, y_2) - y_3) / \\tau_C \\end{pmatrix}\n$$\n从时间 $t_k$ 到 $t_{k+1} = t_k + \\Delta t$ 的 RK4 积分步骤计算如下：\n$$\n\\mathbf{y}_{k+1} = \\mathbf{y}_k + \\frac{\\Delta t}{6} (\\mathbf{k}_1 + 2\\mathbf{k}_2 + 2\\mathbf{k}_3 + \\mathbf{k}_4)\n$$\n增量为：\n$$\n\\begin{aligned}\n\\mathbf{k}_1 = \\mathbf{F}(\\mathbf{y}_k) \\\\\n\\mathbf{k}_2 = \\mathbf{F}(\\mathbf{y}_k + \\frac{\\Delta t}{2} \\mathbf{k}_1) \\\\\n\\mathbf{k}_3 = \\mathbf{F}(\\mathbf{y}_k + \\frac{\\Delta t}{2} \\mathbf{k}_2) \\\\\n\\mathbf{k}_4 = \\mathbf{F}(\\mathbf{y}_k + \\Delta t \\, \\mathbf{k}_3)\n\\end{aligned}\n$$\n从初始条件 $\\mathbf{y}_0 = [0, 0, 0]^T$ 开始重复此过程，直到 $t=T_{\\max}$。\n\n在获得 $C(t)$ 的时间序列后，我们提取三个关键指标来表征输出动态：\n$1$. 半上升时间 $t_{50}$：$C(t)$ 达到其最终稳态值 $C_{\\infty}$ 的 $50\\%$ 所需的时间。我们估计 $C_{\\infty} \\approx C(T_{\\max})$。然后 $t_{50}$ 是第一个满足 $C(t) \\ge 0.5 \\, C_{\\infty}$ 的时间 $t$。已知负向自动调节可以加速转录因子的响应，因此我们预计 $t_{50}^{(-)}  t_{50}^{(0)}$，从而导致负的 $\\Delta t_{50}$。\n$2$. 过冲比 $r_{\\mathrm{ov}}$：高于稳态值的最大相对过冲，定义为 $r_{\\mathrm{ov}} = [\\max_t C(t) / C_{\\infty}] - 1$。由于通往 $C$ 的两条路径中的延迟相互作用，该系统中可能会出现过冲。\n$3$. 峰值时间 $t_{\\mathrm{peak}}$：$C(t)$ 达到其最大值 $C_{\\mathrm{peak}} = \\max_t C(t)$ 的时间。如果存在过冲，这对应于最大过冲发生的时间。如果没有发生过冲，则 $t_{\\mathrm{peak}} = T_{\\max}$。\n\n对于每个测试用例，我们执行此模拟和分析两次——一次针对基线系统（情景 $(0)$），一次针对节点 $B$ 上有负向自动调节的系统（情景 $(-)$）——并计算差异 $\\Delta t_{50} = t_{50}^{(-)} - t_{50}^{(0)}$，$\\Delta r_{\\mathrm{ov}} = r_{\\mathrm{ov}}^{(-)} - r_{\\mathrm{ov}}^{(0)}$ 和 $\\Delta t_{\\mathrm{peak}} = t_{\\mathrm{peak}}^{(-)} - t_{\\mathrm{peak}}^{(0)}$。这使得能够在这种 FFL 背景下直接量化负向自动调节的功能作用。\n\n提供的Python代码实现了这整个过程。它为Hill动力学定义了辅助函数，为两种情景设置了常微分方程组，实现了RK4积分器，并包含一个循环来处理每个测试用例、计算指标、计算它们的差异，并按规定格式化最终输出。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all test cases.\n    \"\"\"\n    \n    # Define test cases with all parameters.\n    test_cases = [\n        # Test 1: happy path\n        {\n            'tau_A': 1.0, 'tau_B': 2.0, 'tau_C': 5.0, 'alpha_B': 1.0, 'alpha_C': 1.0,\n            'K_AB': 0.5, 'n_AB': 2.0, 'K_AC': 0.5, 'n_AC': 2.0, 'K_BC': 0.5, 'n_BC': 2.0,\n            'K_BB': 0.5, 'n_BB': 2.0\n        },\n        # Test 2: weak self-inhibition\n        {\n            'tau_A': 1.0, 'tau_B': 2.0, 'tau_C': 5.0, 'alpha_B': 1.0, 'alpha_C': 1.0,\n            'K_AB': 0.5, 'n_AB': 2.0, 'K_AC': 0.5, 'n_AC': 2.0, 'K_BC': 0.5, 'n_BC': 2.0,\n            'K_BB': 5.0, 'n_BB': 2.0\n        },\n        # Test 3: strong self-inhibition with fast B\n        {\n            'tau_A': 1.0, 'tau_B': 0.5, 'tau_C': 5.0, 'alpha_B': 1.0, 'alpha_C': 1.0,\n            'K_AB': 0.5, 'n_AB': 2.0, 'K_AC': 0.5, 'n_AC': 2.0, 'K_BC': 0.5, 'n_BC': 2.0,\n            'K_BB': 0.2, 'n_BB': 3.0\n        },\n        # Test 4: slow B dynamics\n        {\n            'tau_A': 1.0, 'tau_B': 10.0, 'tau_C': 5.0, 'alpha_B': 1.0, 'alpha_C': 1.0,\n            'K_AB': 0.5, 'n_AB': 2.0, 'K_AC': 0.5, 'n_AC': 2.0, 'K_BC': 0.5, 'n_BC': 2.0,\n            'K_BB': 0.5, 'n_BB': 2.0\n        }\n    ]\n\n    # Simulation parameters\n    dt = 0.01\n    T_max = 100.0\n    time_points = np.arange(0, T_max + dt, dt)\n    num_steps = len(time_points)\n\n    def H_act(x, K, n):\n        \"\"\"Activation Hill function.\"\"\"\n        if x == 0: return 0.0\n        xn = x**n\n        Kn = K**n\n        return xn / (Kn + xn)\n\n    def H_rep(x, K, n):\n        \"\"\"Repression Hill function.\"\"\"\n        if K == 0: return 0.0\n        return 1.0 / (1.0 + (x / K)**n)\n\n    def odes(y, params, nar):\n        \"\"\"System of ODEs. y = [A, B, C].\"\"\"\n        A, B, C = y\n        p = params\n        \n        # dA/dt\n        dA_dt = (1.0 - A) / p['tau_A']\n        \n        # dB/dt\n        P_B_act = p['alpha_B'] * H_act(A, p['K_AB'], p['n_AB'])\n        if nar:\n            P_B = P_B_act * H_rep(B, p['K_BB'], p['n_BB'])\n        else:\n            P_B = P_B_act\n        dB_dt = (P_B - B) / p['tau_B']\n        \n        # dC/dt\n        P_C = p['alpha_C'] * H_act(A, p['K_AC'], p['n_AC']) * H_act(B, p['K_BC'], p['n_BC'])\n        dC_dt = (P_C - C) / p['tau_C']\n        \n        return np.array([dA_dt, dB_dt, dC_dt])\n\n    def rk4_solver(params, nar, dt, num_steps):\n        \"\"\"Fourth-order Runge-Kutta solver.\"\"\"\n        y = np.zeros((num_steps, 3))\n        y[0,:] = [0.0, 0.0, 0.0]\n        \n        for i in range(num_steps - 1):\n            k1 = odes(y[i], params, nar)\n            k2 = odes(y[i] + 0.5 * dt * k1, params, nar)\n            k3 = odes(y[i] + 0.5 * dt * k2, params, nar)\n            k4 = odes(y[i] + dt * k3, params, nar)\n            y[i+1] = y[i] + (dt / 6.0) * (k1 + 2*k2 + 2*k3 + k4)\n        return y\n\n    def analyze_results(C_t, time_points):\n        \"\"\"Calculates metrics t50, r_ov, and t_peak.\"\"\"\n        C_inf = C_t[-1]\n        \n        if C_inf == 0:\n            return 0.0, 0.0, 0.0\n\n        # Half-rise time t50\n        half_rise_idx = np.argmax(C_t = 0.5 * C_inf)\n        t50 = time_points[half_rise_idx]\n\n        # Overshoot ratio r_ov and peak time t_peak\n        C_peak_idx = np.argmax(C_t)\n        C_peak = C_t[C_peak_idx]\n        t_peak = time_points[C_peak_idx]\n        r_ov = C_peak / C_inf - 1.0\n        \n        return t50, r_ov, t_peak\n\n    all_results = []\n    for params in test_cases:\n        # Scenario 0: Baseline (no NAR)\n        solution_0 = rk4_solver(params, nar=False, dt=dt, num_steps=num_steps)\n        C_t_0 = solution_0[:, 2]\n        t50_0, rov_0, tpeak_0 = analyze_results(C_t_0, time_points)\n        \n        # Scenario (-): With Negative Autoregulation\n        solution_neg = rk4_solver(params, nar=True, dt=dt, num_steps=num_steps)\n        C_t_neg = solution_neg[:, 2]\n        t50_neg, rov_neg, tpeak_neg = analyze_results(C_t_neg, time_points)\n        \n        # Calculate differences\n        delta_t50 = t50_neg - t50_0\n        delta_rov = rov_neg - rov_0\n        delta_tpeak = tpeak_neg - tpeak_0\n        \n        all_results.append([delta_t50, delta_rov, delta_tpeak])\n\n    # Format output string exactly as required\n    inner_strings = []\n    for r in all_results:\n        # Format each number to avoid unnecessary trailing decimals\n        s_t50 = f\"{r[0]:.10f}\".rstrip('0').rstrip('.')\n        s_rov = f\"{r[1]:.10f}\".rstrip('0').rstrip('.')\n        s_tpeak = f\"{r[2]:.10f}\".rstrip('0').rstrip('.')\n        inner_strings.append(f\"[{s_t50},{s_rov},{s_tpeak}]\")\n        \n    final_output = f\"[{','.join(inner_strings)}]\"\n    print(final_output)\n\nsolve()\n```"
        }
    ]
}