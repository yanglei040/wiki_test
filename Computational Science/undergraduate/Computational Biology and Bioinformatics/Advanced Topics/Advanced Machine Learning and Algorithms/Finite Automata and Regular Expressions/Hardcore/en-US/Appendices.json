{
    "hands_on_practices": [
        {
            "introduction": "The genetic code is read in three-nucleotide units called codons, a fundamental principle that can be modeled using a deterministic finite automaton (DFA). This exercise  challenges you to design a DFA that recognizes any DNA sequence whose length is a multiple of three, thereby ensuring it can be perfectly partitioned into codons. This foundational practice connects an abstract machine to a core biological concept by using states to remember a simple property: the length of an input string modulo $3$.",
            "id": "2390456",
            "problem": "In computational genomics, messenger ribonucleic acid (mRNA) is translated in triplets of nucleotides called codons. Consider the deoxyribonucleic acid (DNA) alphabet $\\Sigma = \\{A,C,G,T\\}$. Let $L$ be the language of all strings over $\\Sigma$ whose length is a multiple of $3$, representing sequences that can be partitioned into complete codons without a partial codon at the end.\n\nDesign a deterministic finite automaton (DFA) that recognizes $L$ and is minimal with respect to the number of states. Then, let $a_n$ denote the number of strings in $L$ of length $n$, and define the ordinary generating function $G(z)$ by\n$$\nG(z) = \\sum_{n=0}^{\\infty} a_n z^n.\n$$\nProvide $G(z)$ as a single closed-form analytic expression. Your final answer must be this expression only. No rounding is required.",
            "solution": "The problem statement must first be subjected to rigorous validation.\n\nStep 1: Extract Givens\nThe givens are:\n- Alphabet: $\\Sigma = \\{A,C,G,T\\}$.\n- Language: $L$ is the set of all strings over $\\Sigma$ whose length is a multiple of $3$.\n- Sequence: $a_n$ is the number of strings in $L$ of length $n$.\n- Generating Function: $G(z) = \\sum_{n=0}^{\\infty} a_n z^n$.\n- Objective: Design a minimal deterministic finite automaton (DFA) for $L$ and provide the closed-form expression for $G(z)$.\n\nStep 2: Validate Using Extracted Givens\nThe problem is evaluated against the required criteria.\n- **Scientifically Grounded**: The problem is based on established principles of computational biology (DNA alphabet, codons), formal language theory (regular languages, DFAs), and combinatorics (generating functions). The premise that genetic information is read in triplets (codons) is a fundamental fact of molecular biology, providing a sound scientific context for the formal problem. The problem is a standard exercise in automata theory.\n- **Well-Posed**: The language $L$ is unambiguously defined. The tasks of constructing a minimal DFA and finding a corresponding generating function are well-defined mathematical problems with unique solutions.\n- **Objective**: The problem statement is precise, quantitative, and free of any subjective or ambiguous language.\n\nThe problem does not exhibit any of the flaws listed for invalidation. It is scientifically sound, well-posed, and objective.\n\nStep 3: Verdict and Action\nThe problem is valid. A complete solution will now be furnished.\n\nThe first task is to construct a minimal DFA that recognizes the language $L$. The language $L$ consists of all strings $w$ over the alphabet $\\Sigma = \\{A,C,G,T\\}$ such that the length of the string, $|w|$, is a multiple of $3$. This can be expressed as $|w| \\equiv 0 \\pmod 3$.\n\nThis property suggests a DFA with states that track the length of the input string modulo $3$. We define a DFA $M = (Q, \\Sigma, \\delta, q_0, F)$ with three states:\n- $Q = \\{q_0, q_1, q_2\\}$, where the machine is in state $q_i$ if the length of the string read so far is congruent to $i \\pmod 3$.\n- $\\Sigma = \\{A, C, G, T\\}$ is the input alphabet. The size of the alphabet is $|\\Sigma| = 4$.\n- $q_0$ is the start state. This is appropriate because the empty string $\\epsilon$ has length $0$, and $0 \\equiv 0 \\pmod 3$.\n- $F = \\{q_0\\}$ is the set of accepting states, since the language consists of strings whose length is a multiple of $3$.\n- The transition function $\\delta: Q \\times \\Sigma \\to Q$ is defined as follows. For any symbol $s \\in \\Sigma$:\n  - $\\delta(q_0, s) = q_1$, because if a string has length $n \\equiv 0 \\pmod 3$, appending one symbol results in a string of length $n+1 \\equiv 1 \\pmod 3$.\n  - $\\delta(q_1, s) = q_2$, because if a string has length $n \\equiv 1 \\pmod 3$, appending one symbol results in a string of length $n+1 \\equiv 2 \\pmod 3$.\n  - $\\delta(q_2, s) = q_0$, because if a string has length $n \\equiv 2 \\pmod 3$, appending one symbol results in a string of length $n+1 \\equiv 3 \\equiv 0 \\pmod 3$.\n\nTo prove this $3$-state DFA is minimal, we must show that all pairs of states are distinguishable.\n- The pair $(q_0, q_1)$ is distinguishable because $q_0 \\in F$ and $q_1 \\notin F$. Similarly, $(q_0, q_2)$ is distinguishable.\n- To distinguish between $q_1$ and $q_2$, we must find a string $w$ such that one of $\\delta(q_1, w)$ and $\\delta(q_2, w)$ is in $F$ and the other is not. Let's choose a string of length one, for instance $w = A$.\n  - From state $q_1$, reading 'A' leads to state $\\delta(q_1, A) = q_2$, which is not a final state.\n  - From state $q_2$, reading 'A' leads to state $\\delta(q_2, A) = q_0$, which is a final state.\nSince the outcomes are different (one accepting, one not), the states $q_1$ and $q_2$ are distinguishable. As all pairs of states $(q_0, q_1)$, $(q_0, q_2)$, and $(q_1, q_2)$ are distinguishable, the DFA is minimal.\n\nThe second task is to find the ordinary generating function $G(z) = \\sum_{n=0}^{\\infty} a_n z^n$, where $a_n$ is the number of strings in $L$ of length $n$.\nA string is in $L$ if and only if its length $n$ is a non-negative multiple of $3$.\nFor a given length $n$, the number of possible strings over the alphabet $\\Sigma$ of size $4$ is $4^n$.\nTherefore, the sequence $a_n$ is described as:\n- If $n$ is a multiple of $3$ (i.e., $n = 3k$ for some integer $k \\ge 0$), then $a_n = 4^n$.\n- If $n$ is not a multiple of $3$, then $a_n = 0$.\n\nWe can now write the generating function $G(z)$ by substituting this definition of $a_n$:\n$$\nG(z) = \\sum_{n=0}^{\\infty} a_n z^n = a_0 z^0 + a_3 z^3 + a_6 z^6 + \\dots\n$$\nThe terms for $n$ not divisible by $3$ are zero. We are left with terms where $n=3k$ for $k = 0, 1, 2, \\dots$:\n$$\nG(z) = \\sum_{k=0}^{\\infty} a_{3k} z^{3k}\n$$\nSubstituting $a_{3k} = 4^{3k}$:\n$$\nG(z) = \\sum_{k=0}^{\\infty} 4^{3k} z^{3k} = \\sum_{k=0}^{\\infty} (4^3 z^3)^k = \\sum_{k=0}^{\\infty} (64 z^3)^k\n$$\nThis is a standard geometric series of the form $\\sum_{k=0}^{\\infty} r^k$ with the common ratio $r = 64 z^3$. The sum of such a series is given by the formula $\\frac{1}{1-r}$, provided $|r|  1$.\nThus, the closed-form expression for the generating function is:\n$$\nG(z) = \\frac{1}{1 - 64z^3}\n$$\nThis result can be verified using the transfer matrix method on the derived DFA. Let $G_i(z)$ be the generating function for strings that take the machine from the start state $q_0$ to state $q_i$. We have the following system of linear equations, where the term $1$ in the equation for $G_0(z)$ accounts for the empty string:\n\\begin{align*}\nG_0(z) = 1 + 4z G_2(z) \\\\\nG_1(z) = 4z G_0(z) \\\\\nG_2(z) = 4z G_1(z)\n\\end{align*}\nThe language's generating function is $G(z) = G_0(z)$ as $q_0$ is the only accepting state. Substituting the second equation into the third gives $G_2(z) = 4z (4z G_0(z)) = 16z^2 G_0(z)$. Substituting this into the first equation:\n$$\nG_0(z) = 1 + 4z (16z^2 G_0(z)) = 1 + 64z^3 G_0(z)\n$$\nSolving for $G_0(z)$:\n$$\nG_0(z) (1 - 64z^3) = 1 \\implies G_0(z) = \\frac{1}{1 - 64z^3}\n$$\nThis confirms the result obtained through direct combinatorial counting.",
            "answer": "$$\n\\boxed{\\frac{1}{1 - 64z^3}}\n$$"
        },
        {
            "introduction": "Many biological patterns are defined by specific rules, such as starting with a particular residue and avoiding others. This practice  explores how to design the most efficient automaton to recognize such a language, in this case, amino acid sequences that start with Methionine ($\\mathrm{M}$) but lack Cysteine ($\\mathrm{C}$). You will apply principles of state distinguishability to determine the minimal number of states required, a key concept in creating computationally efficient recognizers by identifying the essential \"memory\" a machine needs: a start state, a valid accepting state, and a trap state for invalid sequences.",
            "id": "2390533",
            "problem": "In computational biology, an amino acid sequence can be modeled as a finite string over the alphabet $\\Sigma$ of the $20$ standard amino acid one-letter codes. Let $\\Sigma = \\{ \\mathrm{A}, \\mathrm{C}, \\mathrm{D}, \\mathrm{E}, \\mathrm{F}, \\mathrm{G}, \\mathrm{H}, \\mathrm{I}, \\mathrm{K}, \\mathrm{L}, \\mathrm{M}, \\mathrm{N}, \\mathrm{P}, \\mathrm{Q}, \\mathrm{R}, \\mathrm{S}, \\mathrm{T}, \\mathrm{V}, \\mathrm{W}, \\mathrm{Y} \\}$. Consider the language $L \\subseteq \\Sigma^{*}$ consisting of exactly those sequences that start with $\\mathrm{M}$ and contain no $\\mathrm{C}$ anywhere.\n\nDesign a Deterministic Finite Automaton (DFA) that recognizes $L$. Then, determine the minimal number of states required by any DFA over $\\Sigma$ that recognizes $L$. Provide your final answer as a single integer. No rounding is needed.",
            "solution": "The problem requires the determination of the minimal number of states for a Deterministic Finite Automaton (DFA) that recognizes a given language $L$ over the alphabet $\\Sigma$ of the $20$ standard amino acids.\n\nThe alphabet is given as $\\Sigma = \\{ \\mathrm{A}, \\mathrm{C}, \\mathrm{D}, \\mathrm{E}, \\mathrm{F}, \\mathrm{G}, \\mathrm{H}, \\mathrm{I}, \\mathrm{K}, \\mathrm{L}, \\mathrm{M}, \\mathrm{N}, \\mathrm{P}, \\mathrm{Q}, \\mathrm{R}, \\mathrm{S}, \\mathrm{T}, \\mathrm{V}, \\mathrm{W}, \\mathrm{Y} \\}$. The size of the alphabet is $|\\Sigma| = 20$.\n\nThe language $L$ is a subset of $\\Sigma^*$, the set of all finite strings over $\\Sigma$. A string $w \\in \\Sigma^*$ belongs to $L$ if and only if it satisfies two conditions:\n1. The string must start with the symbol $\\mathrm{M}$.\n2. The string must not contain the symbol $\\mathrm{C}$ anywhere.\n\nTo find the minimum number of states for a DFA recognizing $L$, we utilize the Myhill-Nerode theorem. This theorem establishes a direct correspondence between the states of the minimal DFA for a regular language and the equivalence classes of the indistinguishability relation $R_L$. Two strings $x$ and $y$ from $\\Sigma^*$ are indistinguishable, written $x \\ R_L \\ y$, if for all strings $z \\in \\Sigma^*$, the string $xz$ is in $L$ if and only if $yz$ is in $L$.  The number of states in the minimal DFA is precisely the number of distinct equivalence classes of $R_L$.\n\nWe proceed by identifying these equivalence classes by considering the properties of prefixes of strings in $L$.\n\n1.  **Equivalence Class 1: The initial condition.**\n    This class corresponds to the state of having read no input symbols, represented by the empty string, $\\epsilon$. To determine which other strings belong to this class, we analyze the condition for a string $z$ to be a valid \"continuation.\" For the prefix $\\epsilon$, the string $\\epsilon z = z$ is in $L$ if and only if $z$ itself is in $L$. This means $z$ must start with $\\mathrm{M}$ and contain no $\\mathrm{C}$. Let us denote this equivalence class by $C_0 = [\\epsilon]_{R_L}$. This class will correspond to the start state of our DFA. This state is non-accepting because $\\epsilon \\notin L$.\n\n2.  **Equivalence Class 2: The valid, accepting condition.**\n    This class contains prefixes that represent valid strings in $L$ and can be extended to form other valid strings. Let's consider the simplest string in $L$, which is $x_1 = \\mathrm{M}$. What are its valid continuations? For a string $z \\in \\Sigma^*$, the concatenated string $x_1 z = \\mathrm{M}z$ is in $L$ if and only if $z$ contains no symbol $\\mathrm{C}$. The set of valid continuations for $x_1 = \\mathrm{M}$ is $\\{ z \\in \\Sigma^* \\mid \\mathrm{C} \\notin z \\}$, which is different from the set of valid continuations for $\\epsilon$. For instance, the string $z = \\mathrm{A}$ is a valid continuation for $x_1=\\mathrm{M}$ (making $\\mathrm{MA} \\in L$), but not for $x_0=\\epsilon$ (as $\\mathrm{A} \\notin L$). Thus, $\\epsilon$ and $\\mathrm{M}$ are distinguishable, and $[\\epsilon]_{R_L} \\neq [\\mathrm{M}]_{R_L}$.\n    This new equivalence class, $C_1 = [\\mathrm{M}]_{R_L}$, contains all strings that start with $\\mathrm{M}$ and contain no $\\mathrm{C}$. Any string in this class is, by definition, a member of $L$. Hence, the corresponding state in the DFA must be an accepting state.\n\n3.  **Equivalence Class 3: The invalid, trap condition.**\n    This class comprises all prefixes that can never be completed into a string in $L$, regardless of the suffix. Such a prefix is \"dead.\" A prefix $x$ falls into this class if it violates at least one of the conditions for membership in $L$.\n    a) The prefix does not start with $\\mathrm{M}$. For example, consider $x = \\mathrm{A}$. For any suffix $z \\in \\Sigma^*$, the string $xz = \\mathrm{A}z$ will not begin with $\\mathrm{M}$, so $xz \\notin L$.\n    b) The prefix contains the symbol $\\mathrm{C}$. For example, consider $x = \\mathrm{MC}$. For any suffix $z \\in \\Sigma^*$, the string $xz = \\mathrm{MC}z$ contains $\\mathrm{C}$, so $xz \\notin L$.\n    All such prefixes are equivalent with respect to $R_L$ because for any such prefix $x$, there is no suffix $z$ that can make $xz \\in L$. The set of valid continuations is the empty set, $\\emptyset$.\n    This class, let us call it $C_2$, is distinct from both $C_0$ and $C_1$.\n    - To distinguish $C_2$ from $C_0$, take $x_2 = \\mathrm{A} \\in C_2$ and $x_0 = \\epsilon \\in C_0$. The suffix $z = \\mathrm{M}$ distinguishes them: $x_0 z = \\mathrm{M} \\in L$, but $x_2 z = \\mathrm{AM} \\notin L$.\n    - To distinguish $C_2$ from $C_1$, take $x_2 = \\mathrm{A} \\in C_2$ and $x_1 = \\mathrm{M} \\in C_1$. The suffix $z = \\epsilon$ distinguishes them: $x_1 z = \\mathrm{M} \\in L$, but $x_2 z = \\mathrm{A} \\notin L$.\n\nWe have identified exactly three distinct equivalence classes:\n- $C_0$: The class containing prefixes that have not yet determined the validity or invalidity of the string (only $\\epsilon$).\n- $C_1$: The class containing prefixes that satisfy the conditions of $L$.\n- $C_2$: The class containing prefixes that have violated the conditions of $L$.\n\nAccording to the Myhill-Nerode theorem, the number of states in the minimal DFA is equal to the number of these equivalence classes. Therefore, the minimal number of states required is $3$.\n\nFor completeness, we can describe the minimal DFA, $(Q, \\Sigma, \\delta, q_0, F)$:\n- Set of states: $Q = \\{q_0, q_1, q_2\\}$, where $q_0$ corresponds to $C_0$, $q_1$ to $C_1$, and $q_2$ to $C_2$.\n- Alphabet: $\\Sigma = \\{ \\mathrm{A}, \\mathrm{C}, \\dots, \\mathrm{Y} \\}$.\n- Start state: $q_0$.\n- Set of final states: $F = \\{q_1\\}$.\n- Transition function $\\delta: Q \\times \\Sigma \\to Q$:\n  - $\\delta(q_0, \\mathrm{M}) = q_1$\n  - $\\delta(q_0, \\mathrm{C}) = q_2$\n  - $\\delta(q_0, s) = q_2$ for any $s \\in \\Sigma \\setminus \\{\\mathrm{M}, \\mathrm{C}\\}$\n  - $\\delta(q_1, \\mathrm{C}) = q_2$\n  - $\\delta(q_1, s) = q_1$ for any $s \\in \\Sigma \\setminus \\{\\mathrm{C}\\}$\n  - $\\delta(q_2, s) = q_2$ for any $s \\in \\Sigma$\n\nThis construction demonstrates a DFA with $3$ states. As established by the Myhill-Nerode analysis, no DFA with fewer states can recognize the language $L$. Thus, the minimal number of states is $3$.",
            "answer": "$$\\boxed{3}$$"
        },
        {
            "introduction": "In bioinformatics, exact matches are rare; we are often interested in sequences that are 'close' to a reference. This exercise  uses the conceptual framework of a DFA to tackle the problem of approximate string matching. Your task is to count the number of DNA sequences that differ from a reference by at most $k$ mismatches, bridging the abstract model of an automaton with the practical, combinatorial problem of quantifying sequence similarity within a defined error tolerance.",
            "id": "2390545",
            "problem": "A short-read aligner for deoxyribonucleic acid (DNA) must decide whether an incoming read of fixed length $n$ should be accepted as a candidate match to a fixed reference sequence $R \\in \\Sigma^{n}$ over the DNA alphabet $\\Sigma=\\{\\mathrm{A},\\mathrm{C},\\mathrm{G},\\mathrm{T}\\}$, given a maximum allowed number of mismatches $k$. Using only the core definitions of deterministic finite automaton (DFA) and Hamming distance, consider the following design constraint: the DFAâ€™s states encode exactly two integers $(i,j)$, where $j$ is the number of symbols read so far (prefix length), and $i$ is the number of mismatches observed so far, with $0 \\leq i \\leq k$ and $0 \\leq j \\leq n$. Any transition on a symbol equal to the $(j+1)$-th symbol of $R$ increments $j$ and leaves $i$ unchanged, while any transition on a different symbol increments both $i$ and $j$; once $i$ would exceed $k$, the DFA moves to a dead state that rejects all remaining input. The DFA accepts if and only if it halts after reading exactly $n$ symbols and has observed at most $k$ mismatches.\n\nStarting from these definitions, and without invoking any pre-stated counting formulas, derive a closed-form expression in terms of $n$ and $k$ for the total number of length-$n$ strings over $\\Sigma$ that this DFA accepts. Your final answer must be a single closed-form analytic expression in $n$ and $k$ only. No numerical evaluation is required and no rounding should be performed.",
            "solution": "The problem statement has been subjected to rigorous validation and is determined to be valid. It is scientifically grounded, well-posed, objective, and self-contained. The problem describes a simplified but correct model of DNA read alignment, formalizing the acceptance criteria via a deterministic finite automaton (DFA) whose behavior is equivalent to calculating the Hamming distance between an input string and a reference sequence. The task is to derive from first principles the number of strings accepted by this automaton.\n\nThe problem asks for the total number of distinct strings of length $n$ over the alphabet $\\Sigma=\\{\\mathrm{A},\\mathrm{C},\\mathrm{G},\\mathrm{T}\\}$ that are accepted by the described DFA. The size of the alphabet is $|\\Sigma| = 4$. A string is accepted if, upon completion of reading all $n$ symbols, the total number of mismatches with respect to the reference sequence $R$ is no more than $k$. This is equivalent to finding the number of strings $S \\in \\Sigma^n$ such that their Hamming distance from $R$, denoted $d_H(S, R)$, satisfies the inequality $d_H(S, R) \\le k$.\n\nTo find the total number of such strings, we can calculate the number of strings with exactly $i$ mismatches for each possible integer value of $i$ from $0$ to $k$, and then sum these counts. Let $N_i$ be the number of strings with exactly $i$ mismatches with respect to the reference $R$. The total number of accepted strings, $N_{total}$, will be the sum:\n$$N_{total} = \\sum_{i=0}^{k} N_i$$\n\nLet us derive an expression for $N_i$. A string with exactly $i$ mismatches is constructed by selecting $i$ positions out of the total $n$ positions to be different from the reference $R$, and ensuring the remaining $n-i$ positions are identical to $R$. This derivation follows from fundamental combinatorial principles.\n\nFirst, we must choose the $i$ positions where the mismatches will occur. The number of ways to choose $i$ distinct positions from a set of $n$ available positions is given by the binomial coefficient, which is defined as:\n$$\\binom{n}{i} = \\frac{n!}{i! (n-i)!}$$\nThis represents the number of distinct sets of mismatch positions.\n\nSecond, for each of the $i$ chosen mismatch positions, we must select a character from $\\Sigma$ that is different from the character in the reference string $R$ at that same position. Since the alphabet size is $|\\Sigma| = 4$, for any given character in $R$, there are $4 - 1 = 3$ other characters that can be chosen to create a mismatch. Because the choice of character at each of the $i$ mismatch positions is independent, the total number of ways to assign mismatching characters to these $i$ positions is:\n$$ (4-1)^i = 3^i $$\n\nThird, for the remaining $n-i$ positions, the characters in the string must match the characters in the reference $R$. For each of these positions, there is only $1$ possible character choice. The total number of ways to assign matching characters to these $n-i$ positions is:\n$$ 1^{n-i} = 1 $$\n\nBy the multiplication principle of counting, the total number of strings $N_i$ with exactly $i$ mismatches is the product of the number of ways to complete each step.\n$$N_i = \\binom{n}{i} \\times 3^i \\times 1 = \\binom{n}{i} 3^i$$\n\nFinally, to find the total number of accepted strings, we sum $N_i$ for all allowed numbers of mismatches, which is from $i=0$ to $i=k$.\n$$N_{total} = \\sum_{i=0}^{k} N_i = \\sum_{i=0}^{k} \\binom{n}{i} 3^i$$\n\nThis expression is a partial sum of the binomial expansion of $(1+3)^n$. However, since the summation only goes up to $k$, there is no simpler general closed-form expression in terms of elementary functions. The derived sum is the required analytical expression in terms of $n$ and $k$.",
            "answer": "$$ \\boxed{\\sum_{i=0}^{k} \\binom{n}{i} 3^i} $$"
        }
    ]
}