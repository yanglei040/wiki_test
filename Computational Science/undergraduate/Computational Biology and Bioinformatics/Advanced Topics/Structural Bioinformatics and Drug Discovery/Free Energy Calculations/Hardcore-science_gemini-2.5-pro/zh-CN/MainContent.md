## 引言
在分子科学的核心，理解并预测蛋白质折叠、药物结合等过程的[自发性与平衡](@entry_id:173928)至关重要。吉布斯自由能（Gibbs free energy）的变化（ΔG）是量化这些过程驱动力的关键指标，然而，精确地从计算上预测它是一项巨大的挑战。本文旨在系统性地介绍自由能计算的理论基础、核心方法及其在生物学问题中的广泛应用，填补理论概念与实际计算之间的知识鸿沟。

在接下来的内容中，我们将分三个章节展开：第一章“原理与机制”将深入探讨自由能的[热力学](@entry_id:141121)基础、[平均力势](@entry_id:137947)（PMF）的概念，并详细阐述物理途径与炼金术途径这两大类计算策略，包括[自由能微扰](@entry_id:165589)（FEP）、[热力学积分](@entry_id:156321)（TI）等核心算法。第二章“应用与[交叉](@entry_id:147634)学科联系”将展示这些理论和方法如何在[药物发现](@entry_id:261243)、[蛋白质工程](@entry_id:150125)、[离子通道选择性](@entry_id:170109)等前沿领域中发挥关键作用。最后，在“动手实践”部分，读者将有机会通过具体问题来应用所学知识。

让我们首先从驱动所有分子过程的基本[热力学原理](@entry_id:142232)开始，进入自由能计算的核心世界。

## 原理与机制

### 自由能的[热力学](@entry_id:141121)基础

在分子科学领域，理解和预测分子过程（如蛋白质折叠、[配体结合](@entry_id:147077)或[化学反应](@entry_id:146973)）的自发性和平衡性是核心目标。吉布斯自由能（$G$）是决定这些过程方向和程度的关键[热力学](@entry_id:141121)量。自由能的变化（$\Delta G$）代表了在恒定温度和压力下，一个系统可以做的最大[非体积功](@entry_id:137402)。一个过程若要自发进行，其[吉布斯自由能](@entry_id:146774)必须降低，即 $\Delta G  0$。

对于一个可逆的分子过程，例如药物分子（$D$）与靶点蛋白（$P$）结合形成复合物（$DP$），其平衡状态由平衡常数（$K_{eq}$）描述：
$D + P \rightleftharpoons DP$

[标准吉布斯自由能变](@entry_id:168647)（$\Delta G^{\circ}$）与平衡常数之间存在一个基本关系：
$$ \Delta G^{\circ} = - R T \ln K_{eq} $$
其中，$R$ 是[理想气体](@entry_id:200096)常数，$T$ 是绝对温度。这个方程是连接宏观[热力学](@entry_id:141121)测量与微观分子行为的桥梁。从该方程可以清楚地看出，当一个反应在平衡时产物占优（即 $K_{eq} > 1$），对数项 $\ln K_{eq}$ 为正，因此 $\Delta G^{\circ}$ 必须为负。这意味着该过程在标准条件下是[热力学](@entry_id:141121)有利的 。

在[药物发现](@entry_id:261243)等实际应用中，实验技术如等温滴定[量热法](@entry_id:145378)（ITC）可以直接测量结合常数（通常是结合常数 $K_a$，即 $K_{eq}$）。例如，若在 $298 \, \text{K}$ 下测得某抑制剂与其靶酶的结合常数 $K_a$ 为 $1.00 \times 10^7 \, \text{M}^{-1}$，我们可以利用上述公式计算其标准[结合自由能](@entry_id:166006)。将 $R = 8.314 \, \text{J}\,\text{mol}^{-1}\,\text{K}^{-1}$ 代入，可得：
$$ \Delta G^{\circ} = - (8.314 \, \text{J}\,\text{mol}^{-1}\,\text{K}^{-1}) (298 \, \text{K}) \ln(1.00 \times 10^7) \approx -39.9 \, \text{kJ}\,\text{mol}^{-1} $$
这个负值表明结合过程具有很强的驱动力 。

为了更深入地理解驱动分子过程的力，$\Delta G$ 可以被分解为其焓（$\Delta H$）和熵（$\Delta S$）的贡献：
$$ \Delta G = \Delta H - T\Delta S $$
**焓变**（$\Delta H$）反映了过程中[化学键形成](@entry_id:149227)和破坏的能量变化，例如[氢键](@entry_id:142832)和[范德华力](@entry_id:145564)的形成通常会释放热量，导致负的[焓变](@entry_id:147639)（[放热过程](@entry_id:147168)）。**[熵变](@entry_id:138294)**（$\Delta S$）则衡量了系统无序度的变化。例如，当一个柔性的[配体](@entry_id:146449)[分子结合](@entry_id:200964)到刚性的蛋白质口袋中时，其[平动](@entry_id:187700)、转动和构象自由度受到限制，会导致熵的减少（$\Delta S  0$），这对结合是不利的（$-T\Delta S > 0$）。然而，结合过程也可能因为释放了束缚在蛋白质和[配体](@entry_id:146449)表面的有序水分子而导致总[熵增](@entry_id:138799)加，这种“[疏水效应](@entry_id:146085)”是许多[分子识别](@entry_id:151970)过程的主要驱动力。

通过实验测量（如ITC），我们可以同时得到 $\Delta G$ 和 $\Delta H$。例如，如果一个结合过程的 $\Delta G = -8.6 \, \text{kcal/mol}$，而 $\Delta H = -12.3 \, \text{kcal/mol}$，我们可以计算出熵的贡献 $-T\Delta S$：
$$ -T\Delta S = \Delta G - \Delta H = (-8.6) - (-12.3) = 3.7 \, \text{kcal/mol} $$
这个正值表明，尽管该结合过程在焓上是有利的（$\Delta H$ 为负），但在熵上是不利的，这可能是由于[配体](@entry_id:146449)在结合时丧失了构象灵活性。对这些[热力学](@entry_id:141121)分量的分析，为我们优化[分子相互作用](@entry_id:263767)提供了宝贵的物理化学见解 。

### 作为景观的自由能：[平均力势](@entry_id:137947)

虽然宏观的 $\Delta G$ 值告诉我们过程的最终结果，但它没有描述从初始态到最终态的路径。为了理解分子过程的机制，我们需要一个更精细的视角，即自由能如何沿着一个或多个描述过程进展的**[集体变量](@entry_id:165625)**（collective variables）或**[反应坐标](@entry_id:156248)**（reaction coordinates）变化。这个[自由能函数](@entry_id:749582)被称为**[平均力势](@entry_id:137947)**（Potential of Mean Force, PMF），记为 $W(q)$，其中 $q$ 是我们感兴趣的[集体变量](@entry_id:165625)（例如，两个分子间的距离，或一个分子的[二面角](@entry_id:185221)）。

PMF $W(q)$ 描述了将系统的[集体变量](@entry_id:165625) $q$ 可逆地从一个参考值改变到特定值时所需要做的功。重要的是要理解，PMF **不是**一个简单的[势能](@entry_id:748988)（$U(q)$），而是一个**吉布斯自由能**（$G(q)$）（在恒温恒压（NPT）系综中）。这背后有两个互补的解释 ：

1.  **从[热力学](@entry_id:141121)角度看**：根据热力学第二定律，在恒定温度（$T$）和压力（$P$）下，一个系统所做的可逆[非体积功](@entry_id:137402)等于其[吉布斯自由能](@entry_id:146774)的变化（$dG = \delta W_{\text{non-PV}}$）。PMF被定义为在这些条件下改变坐标 $q$ 所做的可逆功，因此它直接对应于[吉布斯自由能](@entry_id:146774)的变化。这意味着 $W(q)$ 不仅包含了底层的[势能](@entry_id:748988)变化，还包含了当 $q$ 改变时，系统其他所有自由度（如溶剂分子位置、蛋白质侧[链构象](@entry_id:199194)）的平均效应。这些平均效应体现为熵的贡献以及体系平均体积的变化（$P\Delta V$ 项）。

2.  **从[统计力](@entry_id:194984)学角度看**：在[NPT系综](@entry_id:143530)中，观察到特定微观状态（构象 $\mathbf{x}$ 和体积 $V$）的概率 $P(\mathbf{x}, V)$ 与其[玻尔兹曼因子](@entry_id:141054)成正比：$P(\mathbf{x}, V) \propto \exp(-\beta[U(\mathbf{x}) + PV])$，其中 $\beta = (k_B T)^{-1}$。特定[集体变量](@entry_id:165625)值 $q$ 的概率 $P(q)$ 是通过对所有满足 $q(\mathbf{x})=q$ 约束的微观状态进行积分（或求和）得到的。PMF与这个[概率分布](@entry_id:146404)直接相关：
    $$ W(q) = -k_B T \ln P(q) + C $$
    其中 $C$ 是一个任意的常数。这个定义揭示了PMF的本质：$W(q)$ 低的区域是系统在[热平衡](@entry_id:141693)下最可能被发现的区域。因为 $P(q)$ 是通过对除 $q$ 之外的所有自由度进行积分得到的，这个积分过程自然地包含了熵的贡献。因此，$W(q)$ 是一个自由能[曲面](@entry_id:267450)，它为我们提供了稳定态（自由能极小值点）、过渡态（自由能[鞍点](@entry_id:142576)）以及它们之间的能垒（激活自由能）的完整图像。

### 计算自由能差异的途径

计算自由能是分子模拟领域的核心挑战之一，因为它需要对广阔的构象空间进行充分采样。直接计算一个状态的绝对自由能（即其[配分函数](@entry_id:193625)）通常是不可行的。因此，几乎所有的计算方法都专注于计算两个状态之间的**自由能差**，$\Delta G$。

一个常见的误解是，自由能差可以通过简单地计算两个状态的平均势能差来获得，即 $\Delta \langle U \rangle = \langle U_B \rangle_B - \langle U_A \rangle_A$。这是错误的，因为它完全忽略了熵变的贡献（$\Delta G = \Delta \langle U \rangle - T\Delta S$）。为了正确计算自由能，我们需要使用更严谨的[统计力](@entry_id:194984)学方法，这些方法巧妙地利用了自由能是**[状态函数](@entry_id:137683)**的特性——即其变化只取决于初末状态，而与连接它们的路径无关。这使得我们可以设计计算上更易于处理的路径来评估自由能差。

主要有两种策略来实现这一点：**物理途径**和**炼金术途径** 。

#### 物理途径

物理途径方法试图模拟分子过程的真实物理路径。例如，为了计算[配体](@entry_id:146449)与蛋白质的[结合自由能](@entry_id:166006)，我们可以选择[配体](@entry_id:146449)与蛋白质[质心](@entry_id:265015)之间的距离 $r$ 作为[反应坐标](@entry_id:156248)。然后，通过使用诸如[伞形采样](@entry_id:169754)（Umbrella Sampling）或[元动力学](@entry_id:176772)（Metadynamics）等增强采样技术，在 $r$ 的一系列值上进行模拟，从而构建出沿着该坐标的PMF，$W(r)$。[结合自由能](@entry_id:166006)就可以从PMF的极小值（结合态）和平台区（解离态）的高度差中得到。

这种方法的优点是直观，因为它模拟了一个“真实”的物理过程。然而，它也面临着严峻的挑战：
-   **高能垒**：物理上的解离或构象变化路径往往涉及巨大的能量壁垒，这使得可逆的、充分的采样极为困难。
-   **[反应坐标](@entry_id:156248)选择**：方法的成功严重依赖于反应坐标的选择。如果重要的慢自由度（如蛋白质某个环区的开闭）与所选的反应坐标是正交的，那么模拟可能无法正确地对这些慢运动进行采样，导致计算结果出现滞后效应和偏差。
-   **标准态校正**：从PMF得到的微观自由能差需要进行校正，才能得到与实验可比的宏观标准[结合自由能](@entry_id:166006) $\Delta G^\circ$。这个校正必须考虑[配体](@entry_id:146449)在结合时损失的[平动](@entry_id:187700)和转动熵，其计算本身也非易事。

#### 炼金术途径

与模拟真实物理路径不同，炼金术途径（Alchemical pathways）构建了一个非物理的、但[热力学](@entry_id:141121)上有效的路径。这个名字来源于古代炼金术士试图将一种元素转变为另一种元素的想法。在计算中，我们通过一个[耦合参数](@entry_id:747983) $\lambda$（通常从0到1）平滑地改变系统的[哈密顿量](@entry_id:172864)（即[势能函数](@entry_id:200753)），从而将一个分子“炼金”成另一个分子，或者将一个分子的相互作用“凭空”开启或关闭。

例如，为了计算[配体](@entry_id:146449) $L$ 的[结合自由能](@entry_id:166006)，我们可以设计一个**热力学循环** ：

1.  **物理过程（上）**：我们感兴趣的真实过程，即[配体](@entry_id:146449)在溶液中与蛋白质结合：$R+L \rightarrow RL$。其自由能变为 $\Delta G_{\text{bind}}^\circ$。
2.  **炼金术过程（左）**：在[蛋白质结合](@entry_id:191552)口袋中，将完全相互作用的[配体](@entry_id:146449) $L$（$\lambda=1$）炼金术般地转变为一个不与环境相互作用的“幽灵”分子（$\lambda=0$）。这个过程的自由能变为 $\Delta G_{\text{decouple, site}}$。
3.  **炼金术过程（右）**：在纯溶剂中，进行相同的炼金术转变，将[配体](@entry_id:146449) $L$ 转变为“幽灵”分子。其自由能变为 $\Delta G_{\text{decouple, solvent}}$。

由于自由能是状态函数，沿循环一周的总自由能变为零。因此，$\Delta G_{\text{bind}}^\circ + \Delta G_{\text{decouple, solvent}} - \Delta G_{\text{decouple, site}} = 0$，我们可以得到：
$$ \Delta G_{\text{bind}}^\circ = \Delta G_{\text{decouple, site}} - \Delta G_{\text{decouple, solvent}} $$
这种方法的巨大优势在于，炼金术路径（步骤2和3）不需要克服物理结合/解离路径上的高能垒。我们可以在一系列固定的中间 $\lambda$ 值上分别进行平衡模拟，从而计算总的自由能变化。这通常比沿着物理路径进行采样要高效得多，尤其是在存在复杂[构象变化](@entry_id:185671)的系统中。

### 关键的[炼金术计算](@entry_id:176497)方法

一旦确定了炼金术路径 $U(\mathbf{x}; \lambda)$，我们就需要具体的算法来计算沿着这条路径的自由能差。最核心的方法包括[自由能微扰](@entry_id:165589)（FEP）和[热力学积分](@entry_id:156321)（TI）。

#### [自由能微扰](@entry_id:165589) (FEP)

[自由能微扰](@entry_id:165589)方法源于Zwanzig在1954年推导出的一个精确关系式。它直接关联了两个状态（例如，由 $\lambda_A$ 和 $\lambda_B$ 定义）的自由能差：
$$ \Delta G_{A \to B} = -k_B T \ln \left\langle \exp\left(-\frac{U_B - U_A}{k_B T}\right) \right\rangle_A $$
这个方程（**[Zwanzig方程](@entry_id:176184)**）表明，我们可以通过在状态 $A$ 的系综中进行采样，并计算能量差的[指数平均](@entry_id:749182)值，来得到 $A$ 和 $B$ 之间的自由能差。

然而，FEP的成功应用有一个严格的前提：状态 $A$ 和 $B$ 的**相空间**必须有显著的重叠。如果从状态 $A$ 采样的构象在状态 $B$ 的[势能函数](@entry_id:200753)下能量非常高（即在状态 $B$ 中是极小概率事件），那么指数项 $\exp(-\beta \Delta U)$ 将会对绝大多数样本都接近于零，而仅由极少数偶然采样到的、$\Delta U$ 较小的“幸运”构象主导。这会导致计算结果的[方差](@entry_id:200758)极大，收敛性极差。

在实践中，为了确保相空间重叠，整个炼金术路径（从 $\lambda=0$ 到 $\lambda=1$）会被划分为许多个小的、离散的窗口（$\lambda_0, \lambda_1, ..., \lambda_N$），然后在每个窗口之间应用FEP，最后将所有窗口的自由能差累加起来。

此外，FEP估计量存在一个固有的[统计偏差](@entry_id:275818) 。根据**[詹森不等式](@entry_id:144269)**（Jensen's inequality），对于任何凸函数 $f(x)$，都有 $\mathbb{E}[f(X)] \ge f(\mathbb{E}[X])$。函数 $f(x) = e^x$ 是一个[凸函数](@entry_id:143075)，因此 $\langle e^{-\beta \Delta U} \rangle \ge e^{-\beta \langle \Delta U \rangle}$。这导致了一个著名的结论：$\Delta G \le \langle \Delta U \rangle_A$，即用初始态的平均能量差来近似自由能差会系统性地高估真实值。更重要的是，在有限样本的FEP计算中，由于 $\ln(x)$ 函数是[凹函数](@entry_id:274100)（或 $-\ln(x)$ 是凸函数），再次应用[詹森不等式](@entry_id:144269)可知，基于有限样本的FEP估计值 $\widehat{\Delta G}_n$ 的[期望值](@entry_id:153208)会系统性地高于真实的 $\Delta G$。这种正向偏差只有在样本数量 $n \to \infty$ 时才会消失。

#### [热力学积分](@entry_id:156321) (TI)

与FEP直接计算离散状态间的自由能差不同，[热力学积分](@entry_id:156321)（TI）通过对[耦合参数](@entry_id:747983) $\lambda$ 的连续积分来计算总的自由能差。其基本公式为：
$$ \Delta G = \int_0^1 \frac{dG(\lambda)}{d\lambda} d\lambda = \int_0^1 \left\langle \frac{\partial U(\mathbf{x}; \lambda)}{\partial \lambda} \right\rangle_\lambda d\lambda $$
这里，$\langle \cdot \rangle_\lambda$ 表示在由中间[哈密顿量](@entry_id:172864) $U(\mathbf{x}; \lambda)$ 定义的系综中进行的系综平均。

TI和FEP的根本区别在于它们处理炼金术路径的方式 ：
-   **TI** 计算的是[哈密顿量](@entry_id:172864)对 $\lambda$ 的导数（一种“广义的力”）的系综平均值，然后将这些平均值沿着 $\lambda$ 路径进行[数值积分](@entry_id:136578)（例如，使用梯形法则或高斯求积）。因此，TI必须在多个中间 $\lambda$ 点上运行模拟以评估被积函数。
-   **FEP**（在多窗口应用中）计算的是相邻 $\lambda$ 状态之间的[势能](@entry_id:748988)差的[指数平均](@entry_id:749182)值。

在许多情况下，TI的收敛性比FEP更稳定，因为它是对一个系综平均值的积分，而不是对一个[指数平均](@entry_id:749182)值的求和，后者对[采样误差](@entry_id:182646)更为敏感。

#### 双向和最优估计：[Bennett接受率](@entry_id:175184) (BAR)

单向FEP方法（如 $A \to B$）只利用了其中一个系综的采样信息。一个显而易见的改进是同时进行正向（$A \to B$）和反向（$B \to A$）的计算，并以某种方式结合结果。[Bennett接受率](@entry_id:175184)方法（BAR）正是为此而生，它被证明是结合正向和反向采样数据时[方差](@entry_id:200758)最小的[无偏估计](@entry_id:756289)器 。

BAR的核心思想不是简单地平均正向和反向的FEP结果，而是通过一个[隐式方程](@entry_id:177636)来求解 $\Delta G$：
$$ \left\langle \frac{1}{1 + \exp(\beta(\Delta U - \Delta G))} \right\rangle_A = \left\langle \frac{1}{1 + \exp(-\beta(\Delta U - \Delta G))} \right\rangle_B $$
（这里假设样本数相等）。方程中的函数是**[逻辑斯谛函数](@entry_id:634233)**（或费米函数），它的作用是给每个样本一个权重。这个权重函数会有效地放大那些处于两个系综**相空间重叠区域**的构象的贡献，同时抑制那些仅在一个系综中常见的“尾部”构象。通过聚焦于信息最丰富的重叠区域，BAR显著提高了计算效率和统计精度，成为现代自由能计算的黄金标准之一。

### [炼金术计算](@entry_id:176497)中的实际挑战与高级主题

尽管炼金术方法功能强大，但在实际应用中会遇到一系列挑战，理解这些挑战对于获得可靠的结果至关重要。

#### 绝对与[相对结合自由能](@entry_id:172459)

在药物设计中，我们往往更关心一个候选药物（如分子 $B$）相对于一个已知参考药物（分子 $A$）的[结合能](@entry_id:143405)力差异，即**[相对结合自由能](@entry_id:172459)** $\Delta\Delta G_{\text{bind}}^\circ = \Delta G_{\text{bind}}^\circ(B) - \Delta G_{\text{bind}}^\circ(A)$。计算 $\Delta\Delta G$ 通常比计算**绝对[结合自由能](@entry_id:166006)** $\Delta G^\circ$ 更容易、更精确 。

原因可以通过热力学循环清晰地说明：
-   计算**绝对**自由能 $\Delta G^\circ(A)$，需要将分子 $A$ 的相互作用完全“关闭”（从 $A$ 到“幽灵”）。这是一个巨大的扰动，涉及的能量变化很大，需要非常多的中间 $\lambda$ 窗口才能保证相空间重叠，计算成本高昂且[方差](@entry_id:200758)大。此外，它还需要复杂的标准态校正来处理[平动](@entry_id:187700)和转动熵的损失。
-   计算**相对**自由能 $\Delta\Delta G^\circ$，我们只需在一个热力学循环中计算两个炼金术腿：1）在蛋白质口袋中将 $A$ 突变为 $B$（$\Delta G_{\text{mut, site}}$）；2）在溶剂中将 $A$ 突变为 $B$（$\Delta G_{\text{mut, solv}}$）。则 $\Delta\Delta G = \Delta G_{\text{mut, site}} - \Delta G_{\text{mut, solv}}$。如果 $A$ 和 $B$ 的化学结构相似（例如，仅相差一个甲基），那么 $A \to B$ 的突变就是一个微小的扰动。这带来了两大好处：
    1.  **相空间重叠度高**：小扰动意味着初始态和终末态的相空间高度重叠，FEP或BAR等方法可以快速收敛，[统计误差](@entry_id:755391)小。
    2.  **[误差抵消](@entry_id:749073)**：由于 $A$ 和 $B$ 的大部分结构是相同的，许多系统性误差（如[力场](@entry_id:147325)的不完善、[有限尺寸效应](@entry_id:155681)）在两个炼金术腿的计算中会相似地出现，并在最终相减时被抵消。同样，复杂的标准态校正项也因相似而相互抵消。

因此，[相对结合自由能](@entry_id:172459)计算是[药物化学](@entry_id:178806)领域中一种强大且应用广泛的工具。

#### 端点灾难

在使用[线性缩放](@entry_id:197235)的炼金术路径时，一个经典的问题是**端点灾难**（endpoint catastrophe），尤其是在相互作用即将完全消失的端点（$\lambda \to 0$）。其物理根源在于，当一个分子的排斥体积（由[Lennard-Jones势](@entry_id:143105)的 $r^{-12}$ 项产生）随着 $\lambda$ 减弱时，周围的溶剂分子就有可能与其发生空间重叠。

在一个 $\lambda$ 极小但非零的模拟中，系统大部分时间表现得像一个“幽灵”分子，允许溶剂进入其空间。然而，一旦溶剂分子与该炼金术分子的距离 $r$ 变得极小，即使是一个微小的残余相互作用（由 $\lambda$ 缩放）也会因为 $r^{-12}$（对于[Lennard-Jones势](@entry_id:143105)）或 $r^{-1}$（对于库仑势）项而变得巨大，导致[势能](@entry_id:748988)或力的计算出现无穷大。这使得系综平均值（如TI中的 $\langle \partial U/\partial \lambda \rangle$）的[方差](@entry_id:200758)爆炸，无法收敛。

解决这个问题的方法是修改[势能函数](@entry_id:200753)，使用所谓的**[软核势](@entry_id:191962)**（soft-core potentials）。这些势函数经过特殊设计，当 $\lambda  1$ 时，即使在 $r \to 0$ 的情况下，势能及其导数也保持有限，从而避免了端点灾难，使得[炼金术计算](@entry_id:176497)在整个 $\lambda$ 范围内都表现良好。

#### [拓扑变化](@entry_id:136654)

标准炼金术方法的一个基本限制是它们无法直接处理**分子拓扑结构**发生变化的变换，例如将一个线性分子环化形成一个环状分子 。

问题在于，线性[状态和](@entry_id:193625)环状状态的构象空间在本质上是**不相交**的。[线性分子](@entry_id:166760)的两端可以自由运动，相距很远；而环状分子的两端则被[共价键](@entry_id:141465)约束在一个很小的距离内。任何一个典型的线性构象，在施加环状约束的[势能函数](@entry_id:200753)下，其能量都会是天文数字。反之亦然。

这意味着，在从线性态（$\lambda=0$）到环状态（$\lambda=1$）的炼金术路径中，不存在任何一个中间 $\lambda$ 值能让系统同时有效地采样“类线性”和“类环状”的构象。两个态的玻尔兹曼分布几乎没有重叠。因此，FEP的[指数平均](@entry_id:749182)会因为找不到任何有意义的[重叠构象](@entry_id:180121)而彻底失败。对于TI，其被积函数 $\langle \partial U/\partial \lambda \rangle$ 会在某个临界 $\lambda$ 值附近表现出类似[相变](@entry_id:147324)的急剧跳变，使得[数值积分](@entry_id:136578)无法进行。

要解决这类问题，需要超越简单的炼金术插值，采用更高级的策略。例如，可以引入额外的几何约束（restraints），首先强制将线性分子的两端拉近，计算这个过程的自由能，然后再在两端被约束住的状态下进行键的形成，从而将一个无法逾越的拓扑鸿沟分解为一系列计算上可行的步骤。