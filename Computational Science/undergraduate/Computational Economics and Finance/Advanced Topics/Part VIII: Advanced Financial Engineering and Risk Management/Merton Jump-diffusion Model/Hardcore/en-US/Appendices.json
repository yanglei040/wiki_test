{
    "hands_on_practices": [
        {
            "introduction": "Why do we even need jump-diffusion models when the Black-Scholes model exists? This practice answers that question by diving into one of the most important statistical features of financial returns: \"fat tails,\" or kurtosis. You will derive and compute the excess kurtosis directly from the Merton model's parameters, providing a concrete link between the model's jump component and its ability to capture the sudden, large market movements that simpler models miss . This exercise reveals the fundamental reason for the model's invention and its enduring relevance.",
            "id": "2410121",
            "problem": "Consider the Merton jump-diffusion model for an asset price process, where the logarithmic return over horizon $T$, denoted $X_T = \\ln(S_T/S_0)$, is modeled as the sum of an independent Brownian-driven diffusion and a compound Poisson jump component. Specifically, assume that\n- the diffusion component has volatility parameter $\\sigma > 0$,\n- jump arrivals follow a Poisson process with intensity $\\lambda \\ge 0$,\n- jump sizes in logarithms are independent and identically distributed as $Y \\sim \\mathcal{N}(m, \\delta^2)$, where $m \\in \\mathbb{R}$ and $\\delta > 0$,\n- the diffusion and jump components are independent.\n\nYou are asked to analyze the term structure of implied excess kurtosis of $X_T$ under this model as a function of maturity $T$, for different jump parameters.\n\nStarting only from the following fundamental base:\n- the moment generating function of a sum of independent random variables equals the product of their individual moment generating functions,\n- the cumulant generating function is the natural logarithm of the moment generating function,\n- cumulants add for independent sums,\n- the cumulant generating function of a compound Poisson sum with intensity $\\lambda$ and jump-size moment generating function $M_Y(u)$ is $\\lambda T \\left(M_Y(u) - 1\\right)$,\n- the second central moment (variance) and fourth central moment can be obtained from cumulants, and the excess kurtosis is the standardized fourth cumulant,\n\nderive a formula for the excess kurtosis of $X_T$ as a function of $(\\lambda, m, \\delta, \\sigma, T)$. Then implement a program to compute its value for the parameter sets below.\n\nDefinition to use for this task:\n- Excess kurtosis of a random variable with variance $\\operatorname{Var}(X)$ and fourth cumulant $\\kappa_4$ is defined as $\\gamma_2 = \\kappa_4 / \\operatorname{Var}(X)^2$ (a dimensionless quantity).\n\nImportant notes:\n- The drift of $X_T$ does not affect the variance or excess kurtosis, so you must not assume or use any specific drift parameter beyond what is required by the above base.\n- Angles do not appear in this problem.\n- No physical units are involved; all outputs are pure real numbers.\n\nTest suite to implement and evaluate:\n- Parameter set $1$: $(\\lambda, m, \\delta, \\sigma) = (0.5, -0.1, 0.2, 0.2)$ with maturities $T \\in \\{0.1, 0.5, 1.0, 2.0\\}$ (years).\n- Parameter set $2$: $(\\lambda, m, \\delta, \\sigma) = (0.0, -0.1, 0.2, 0.2)$ with maturities $T \\in \\{0.1, 0.5, 1.0, 2.0\\}$ (years).\n- Parameter set $3$: $(\\lambda, m, \\delta, \\sigma) = (1.0, 0.0, 0.4, 0.15)$ with maturities $T \\in \\{0.01, 0.1, 1.0, 5.0\\}$ (years).\n\nYour program must:\n- compute the excess kurtosis $\\gamma_2$ for each $(\\lambda, m, \\delta, \\sigma, T)$ combination in the test suite, using only the base principles listed above,\n- round each result to exactly $6$ decimal places,\n- aggregate all results into a single list in the following order: iterate parameter sets in the order $1$, $2$, $3$, and within each parameter set iterate maturities $T$ in the order specified above,\n- produce a single line of output containing the results as a comma-separated list enclosed in square brackets (e.g., $[r_1,r_2,\\dots,r_n]$), with no spaces.\n\nYour output must be a single list of real numbers (floats) rounded to six decimals, with no additional text or formatting.",
            "solution": "The problem statement is scientifically grounded, well-posed, and objective. It presents a standard problem in computational finance based on the established Merton jump-diffusion model and fundamental principles of probability theory. All necessary parameters and definitions are provided, and there are no internal contradictions or ambiguities. Therefore, the problem is valid, and a solution will be derived.\n\nThe objective is to derive a formula for the excess kurtosis of the logarithmic return $X_T = \\ln(S_T/S_0)$ over a time horizon $T$ in the Merton model, and then to compute its value for specific parameter sets. The derivation will proceed from the base principles provided.\n\nThe log-return $X_T$ is modeled as the sum of two independent random components: a diffusion component, which we denote as $D_T$, and a compound Poisson jump component, denoted as $J_T$. Thus, $X_T = D_T + J_T$.\n\nAccording to the provided principles, the cumulant generating function (CGF) of a sum of independent random variables is the sum of their individual CGFs. Let $K_{X_T}(u)$, $K_{D_T}(u)$, and $K_{J_T}(u)$ be the CGFs of $X_T$, $D_T$, and $J_T$ respectively. Then, $K_{X_T}(u) = K_{D_T}(u) + K_{J_T}(u)$.\n\nFirst, we characterize the CGF of the diffusion component, $D_T$. The problem states its volatility is $\\sigma > 0$. The diffusion part of the log-return over an interval of length $T$, ignoring drift as it does not affect central moments, is a scaled Wiener process, $D_T = \\sigma W_T$, where $W_T \\sim \\mathcal{N}(0, T)$. Consequently, $D_T$ follows a normal distribution, $D_T \\sim \\mathcal{N}(0, \\sigma^2 T)$. The CGF of a normal random variable with mean $\\mu$ and variance $\\nu^2$ is $\\mu u + \\frac{1}{2}\\nu^2 u^2$. For $D_T$, with $\\mu = 0$ and $\\nu^2 = \\sigma^2 T$, the CGF is:\n$$ K_{D_T}(u) = \\frac{1}{2}\\sigma^2 T u^2 $$\n\nSecond, we characterize the CGF of the jump component, $J_T$. As stated in the problem, for a compound Poisson process with arrival intensity $\\lambda$ and jump size random variable $Y$, the CGF is $K_{J_T}(u) = \\lambda T (M_Y(u) - 1)$, where $M_Y(u)$ is the moment generating function (MGF) of the jump size $Y$. The jump sizes are given to be normally distributed, $Y \\sim \\mathcal{N}(m, \\delta^2)$. The MGF of a normal random variable $Y$ is $M_Y(u) = E[e^{uY}] = \\exp(mu + \\frac{1}{2}\\delta^2 u^2)$. Substituting this into the expression for $K_{J_T}(u)$:\n$$ K_{J_T}(u) = \\lambda T \\left(\\exp\\left(mu + \\frac{1}{2}\\delta^2 u^2\\right) - 1\\right) $$\n\nThe total CGF for the log-return $X_T$ is the sum of the CGFs of the two components:\n$$ K_{X_T}(u) = \\frac{1}{2}\\sigma^2 T u^2 + \\lambda T \\left(\\exp\\left(mu + \\frac{1}{2}\\delta^2 u^2\\right) - 1\\right) $$\n\nThe cumulants, $\\kappa_n$, of a random variable are obtained from its CGF by differentiation: $\\kappa_n = \\frac{d^n K(u)}{du^n}\\Big|_{u=0}$. A more direct approach is to use the additivity of cumulants for independent variables: $\\kappa_n(X_T) = \\kappa_n(D_T) + \\kappa_n(J_T)$.\n\nFor the normal diffusion component $D_T \\sim \\mathcal{N}(0, \\sigma^2 T)$, the only non-zero cumulant is the second one, the variance: $\\kappa_2(D_T) = \\sigma^2 T$. All other cumulants, including the fourth, are zero, i.e., $\\kappa_4(D_T) = 0$.\n\nFor the compound Poisson jump component $J_T$, its $n$-th cumulant is given by $\\kappa_n(J_T) = \\lambda T E[Y^n]$, where $E[Y^n]$ is the $n$-th raw moment of the jump size $Y \\sim \\mathcal{N}(m, \\delta^2)$. We require the second and fourth cumulants.\nThe second raw moment of $Y$ is $E[Y^2] = \\operatorname{Var}(Y) + (E[Y])^2 = \\delta^2 + m^2$.\nThe fourth raw moment of $Y$ is $E[Y^4] = E[(Y-m+m)^4]$. Let $Z = Y-m \\sim \\mathcal{N}(0, \\delta^2)$, for which $E[Z^k]=0$ for odd $k$ and $E[Z^2]=\\delta^2$, $E[Z^4]=3\\delta^4$. Then $E[Y^4] = E[(Z+m)^4] = E[Z^4 + 4mZ^3 + 6m^2Z^2 + 4m^3Z + m^4] = E[Z^4] + 6m^2E[Z^2] + m^4 = 3\\delta^4 + 6m^2\\delta^2 + m^4$.\nThe required cumulants for the jump part are therefore:\n$$ \\kappa_2(J_T) = \\lambda T E[Y^2] = \\lambda T (m^2 + \\delta^2) $$\n$$ \\kappa_4(J_T) = \\lambda T E[Y^4] = \\lambda T (m^4 + 6m^2\\delta^2 + 3\\delta^4) $$\n\nWe can now find the total cumulants for $X_T$.\nThe variance of $X_T$ is the second cumulant, $\\kappa_2(X_T)$:\n$$ \\operatorname{Var}(X_T) = \\kappa_2(X_T) = \\kappa_2(D_T) + \\kappa_2(J_T) = \\sigma^2 T + \\lambda T (m^2 + \\delta^2) $$\nThe fourth cumulant of $X_T$ is $\\kappa_4(X_T)$:\n$$ \\kappa_4(X_T) = \\kappa_4(D_T) + \\kappa_4(J_T) = 0 + \\lambda T (m^4 + 6m^2\\delta^2 + 3\\delta^4) = \\lambda T (m^4 + 6m^2\\delta^2 + 3\\delta^4) $$\n\nThe excess kurtosis, $\\gamma_2$, is defined as the standardized fourth cumulant, $\\gamma_2 = \\kappa_4 / \\operatorname{Var}(X)^2 = \\kappa_4 / \\kappa_2^2$. Substituting our derived expressions for $\\kappa_2(X_T)$ and $\\kappa_4(X_T)$:\n$$ \\gamma_2 = \\frac{\\lambda T (m^4 + 6m^2\\delta^2 + 3\\delta^4)}{\\left[\\sigma^2 T + \\lambda T (m^2 + \\delta^2)\\right]^2} $$\nFactoring out $T$ from the denominator:\n$$ \\gamma_2 = \\frac{\\lambda T (m^4 + 6m^2\\delta^2 + 3\\delta^4)}{T^2 \\left[\\sigma^2 + \\lambda (m^2 + \\delta^2)\\right]^2} $$\nThis simplifies to the final formula for excess kurtosis as a function of the model parameters and time horizon $T$:\n$$ \\gamma_2(\\lambda, m, \\delta, \\sigma, T) = \\frac{\\lambda (m^4 + 6m^2\\delta^2 + 3\\delta^4)}{T \\left(\\sigma^2 + \\lambda (m^2 + \\delta^2)\\right)^2} $$\n\nThis formula shows that excess kurtosis is inversely proportional to maturity $T$, and is generated entirely by the jump component (as $\\gamma_2 = 0$ if $\\lambda = 0$). We now implement this formula to compute the required values for the given test suite.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the excess kurtosis for the Merton jump-diffusion model for several\n    parameter sets and maturities.\n    \"\"\"\n    \n    # Test cases are structured as:\n    # (lambda, m, delta, sigma, list_of_T)\n    test_cases = [\n        (0.5, -0.1, 0.2, 0.2, [0.1, 0.5, 1.0, 2.0]),\n        (0.0, -0.1, 0.2, 0.2, [0.1, 0.5, 1.0, 2.0]),\n        (1.0, 0.0, 0.4, 0.15, [0.01, 0.1, 1.0, 5.0]),\n    ]\n\n    results = []\n\n    for case in test_cases:\n        lambda_val, m, delta, sigma, T_list = case\n\n        # The formula for excess kurtosis is:\n        # gamma_2 = [lambda * E(Y^4)] / (T * (Var(X_T)/T)^2)\n        # where E(Y^4) = m^4 + 6*m^2*delta^2 + 3*delta^4\n        # and Var(X_T)/T = sigma^2 + lambda * (m^2 + delta^2)\n        \n        # Pre-compute parts of the formula that are independent of T.\n        # Handle the case where lambda is 0, which implies no jumps and zero excess kurtosis.\n        if lambda_val == 0.0:\n            for T in T_list:\n                results.append(\"0.000000\")\n            continue\n\n        # Numerator term from the formula, related to jump size moments\n        jump_moment_term = lambda_val * (m**4 + 6 * m**2 * delta**2 + 3 * delta**4)\n\n        # Denominator term (squared), representing the variance per unit time\n        variance_per_unit_time = sigma**2 + lambda_val * (m**2 + delta**2)\n        \n        # The part of the formula that is constant with respect to T\n        kurtosis_constant_C = jump_moment_term / (variance_per_unit_time**2)\n\n        for T in T_list:\n            # Excess kurtosis is inversely proportional to T\n            gamma_2 = kurtosis_constant_C / T\n            \n            # Format the result to exactly 6 decimal places as a string.\n            # Using string formatting handles rounding and ensures trailing zeros.\n            results.append(f\"{gamma_2:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Building on our understanding of the model's components, we now apply it to a practical pricing problem. This exercise asks you to determine the fair price of a variance swap, a derivative whose payoff depends on the realized volatility of an asset . You will discover how the total variance priced into the swap is a clean sum of the continuous diffusion variance and the variance contributed by the stochastic jumps, making the abstract model components tangible and economically meaningful.",
            "id": "2410146",
            "problem": "A stock price process is modeled under the risk-neutral measure as a Merton jump-diffusion. Let $S_t$ denote the stock price, and let $X_t = \\ln S_t$ denote the logarithm of the stock price. The risk-neutral dynamics of $S_t$ are given by\n$$\n\\frac{dS_t}{S_{t-}} = \\left(r - q - \\lambda \\kappa \\right) dt + \\sigma \\, dW_t + (J - 1) \\, dN_t,\n$$\nwhere $r$ is the continuously compounded risk-free rate, $q$ is the continuous dividend yield, $\\sigma \\ge 0$ is the diffusion volatility, $W_t$ is a standard Brownian motion, $N_t$ is a Poisson process with intensity $\\lambda \\ge 0$, $J$ is the multiplicative jump size with $\\ln J \\sim \\mathcal{N}(\\mu_J, \\delta_J^2)$ independent of $W_t$ and $N_t$, and $\\kappa = \\mathbb{E}[J - 1] = e^{\\mu_J + \\tfrac{1}{2}\\delta_J^2} - 1$. All parameters are constants. Assume that all expectations are taken under the risk-neutral measure.\n\nA variance swap with maturity $T$ pays at time $T$ the payoff based on the annualized realized variance of log-returns:\n$$\n\\text{Payoff} = N_{\\text{var}} \\left( \\frac{1}{T} [X]_T - K \\right),\n$$\nwhere $[X]_T$ is the quadratic variation of $X_t$ over $[0,T]$, $K$ is the agreed variance strike (as a decimal, not a percentage), and $N_{\\text{var}}$ is the variance notional. The time-$0$ price is the risk-neutral discounted expectation of this payoff at rate $r$.\n\nTask:\n1) Starting only from the model definition above and well-tested facts about quadratic variation and moments of a Poisson process, derive an expression for the fair annualized variance swap strike $K_{\\text{var}}$ in terms of the model parameters $(\\sigma, \\lambda, \\mu_J, \\delta_J)$.\n\n2) Use your derived expression to write a program that computes:\n- the fair strike $K_{\\text{var}}$, and\n- the time-$0$ present value $\\text{PV}_0$ of a variance swap with given agreed strike $K$ and variance notional $N_{\\text{var}}$, using the risk-neutral discount factor $e^{-rT}$, where the payoff is $N_{\\text{var}} \\left( \\frac{1}{T} [X]_T - K \\right)$.\n\nAll inputs related to rates, volatilities, intensities, and strikes must be provided as decimals (for example, input $\\sigma = 0.2$ for a $20$ percent diffusion volatility). No physical units or angles are involved. All outputs must be rounded to $10$ decimal places.\n\nTest suite:\nUse the following five parameter sets, each specified as $(\\sigma, \\lambda, \\mu_J, \\delta_J, T, r, q, K, N_{\\text{var}})$, with all entries as decimals:\n- Case A: $(0.2, 0.5, -0.1, 0.2, 1.0, 0.03, 0.0, 0.06, 10000)$\n- Case B: $(0.3, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.09, 7500)$\n- Case C: $(0.0, 1.2, 0.05, 0.3, 0.5, 0.01, 0.0, 0.12, 5000)$\n- Case D: $(0.25, 0.05, -0.2, 0.0, 1.5, 0.05, 0.0, 0.0645, 8000)$\n- Case E: $(0.15, 0.4, -0.02, 0.1, 3.0, 0.07, 0.02, 0.02, 12000)$\n\nOutput specification:\nYour program should produce a single line of output containing the results for all test cases as a comma-separated list enclosed in square brackets, where each test case result is itself a two-element list of floats $[K_{\\text{var}}, \\text{PV}_0]$, both rounded to $10$ decimal places. For example:\n\"[[Kvar_A,PV_A],[Kvar_B,PV_B],[Kvar_C,PV_C],[Kvar_D,PV_D],[Kvar_E,PV_E]]\".",
            "solution": "The problem statement is subjected to validation.\n\n### Step 1: Extract Givens\n- **Model**: Merton jump-diffusion model for stock price $S_t$ under the risk-neutral measure.\n- **Stock Price Dynamics**:\n$$\n\\frac{dS_t}{S_{t-}} = \\left(r - q - \\lambda \\kappa \\right) dt + \\sigma \\, dW_t + (J - 1) \\, dN_t\n$$\n- **Log-Price**: $X_t = \\ln S_t$.\n- **Parameters**:\n  - $r$: continuously compounded risk-free rate.\n  - $q$: continuous dividend yield.\n  - $\\sigma \\ge 0$: diffusion volatility.\n  - $W_t$: standard Brownian motion.\n  - $N_t$: Poisson process with intensity $\\lambda \\ge 0$.\n  - $J$: multiplicative jump size, with $\\ln J \\sim \\mathcal{N}(\\mu_J, \\delta_J^2)$.\n  - $\\kappa = \\mathbb{E}[J - 1] = e^{\\mu_J + \\tfrac{1}{2}\\delta_J^2} - 1$.\n- **Assumptions**: $J$ is independent of $W_t$ and $N_t$. All expectations are under the risk-neutral measure. All parameters are constants.\n- **Variance Swap Payoff**: $N_{\\text{var}} \\left( \\frac{1}{T} [X]_T - K \\right)$ at maturity $T$.\n  - $[X]_T$: quadratic variation of $X_t$ over $[0,T]$.\n  - $K$: agreed variance strike.\n  - $N_{\\text{var}}$: variance notional.\n- **Task 1**: Derive an expression for the fair annualized variance swap strike $K_{\\text{var}}$ in terms of $(\\sigma, \\lambda, \\mu_J, \\delta_J)$.\n- **Task 2**: Write a program to compute $K_{\\text{var}}$ and the time-$0$ present value $\\text{PV}_0$ of the variance swap.\n- **Test Suite**: Five parameter sets are provided: $(\\sigma, \\lambda, \\mu_J, \\delta_J, T, r, q, K, N_{\\text{var}})$.\n  - Case A: $(0.2, 0.5, -0.1, 0.2, 1.0, 0.03, 0.0, 0.06, 10000)$\n  - Case B: $(0.3, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.09, 7500)$\n  - Case C: $(0.0, 1.2, 0.05, 0.3, 0.5, 0.01, 0.0, 0.12, 5000)$\n  - Case D: $(0.25, 0.05, -0.2, 0.0, 1.5, 0.05, 0.0, 0.0645, 8000)$\n  - Case E: $(0.15, 0.4, -0.02, 0.1, 3.0, 0.07, 0.02, 0.02, 12000)$\n\n### Step 2: Validate Using Extracted Givens\nThe problem is evaluated against the validation criteria.\n- **Scientifically Grounded**: The Merton jump-diffusion model is a cornerstone of modern quantitative finance. The definition of a variance swap, its payoff structure based on the quadratic variation of log-returns, and risk-neutral pricing are all standard and well-established concepts. The problem is firmly rooted in financial mathematics.\n- **Well-Posed**: The problem provides a complete set of model parameters and asks for the derivation of specific, well-defined quantities ($K_{\\text{var}}$ and $\\text{PV}_0$). The tasks are clear and a unique solution exists based on standard theory.\n- **Objective**: The problem is stated in precise, formal mathematical language, devoid of any subjectivity or ambiguity.\n- **Consistency and Completeness**: The model is fully specified. The definition of the compensator term $\\lambda \\kappa$ is consistent with the requirement that the discounted asset price is a martingale under the risk-neutral measure. All parameters required for the calculation are provided in the test suite. The problem is self-contained and internally consistent.\n\n### Step 3: Verdict and Action\nThe problem is deemed **valid**. It is a standard, well-posed problem in computational finance that requires a rigorous derivation based on stochastic calculus. A solution will be provided.\n\n### Derivation and Solution\nThe solution is developed in three stages: first, we derive the dynamics of the log-price $X_t$; second, we derive the expected quadratic variation of $X_t$ to find the fair variance strike $K_{\\text{var}}$; third, we derive the present value of the variance swap.\n\n**1. Dynamics of the Log-Price $X_t$**\n\nWe start with the SDE for the stock price $S_t$:\n$$\ndS_t = S_{t-} \\left(r - q - \\lambda \\kappa \\right) dt + S_{t-} \\sigma \\, dW_t + S_{t-} (J - 1) \\, dN_t\n$$\nTo find the dynamics of $X_t = \\ln S_t$, we apply Itô's lemma for jump-diffusion processes. For a function $f(S_t)$, the dynamics are given by:\n$$\ndf(S_t) = \\frac{\\partial f}{\\partial S_{t-}} dS_t^c + \\frac{1}{2} \\frac{\\partial^2 f}{\\partial S_{t-}^2} (dS_t^c)^2 + \\left[ f(S_t) - f(S_{t-}) \\right] dN_t\n$$\nHere, $f(S) = \\ln S$, so $\\frac{\\partial f}{\\partial S} = \\frac{1}{S}$ and $\\frac{\\partial^2 f}{\\partial S^2} = -\\frac{1}{S^2}$. The continuous part of the dynamics is $dS_t^c = S_{t-}(r - q - \\lambda \\kappa) dt + S_{t-} \\sigma dW_t$. The quadratic variation of the continuous part is $(dS_t^c)^2 = (S_{t-} \\sigma dW_t)^2 = S_{t-}^2 \\sigma^2 dt$.\n\nAt a jump, the price changes from $S_{t-}$ to $S_t = S_{t-} J$. The change in log-price is $\\Delta X_t = \\ln(S_t) - \\ln(S_{t-}) = \\ln(S_{t-}J) - \\ln(S_{t-}) = \\ln J$.\n\nSubstituting these into Itô's formula:\n$$\ndX_t = \\frac{1}{S_{t-}} \\left[ S_{t-} \\left(r - q - \\lambda \\kappa \\right) dt + S_{t-} \\sigma \\, dW_t \\right] + \\frac{1}{2} \\left( -\\frac{1}{S_{t-}^2} \\right) S_{t-}^2 \\sigma^2 dt + \\ln J \\, dN_t\n$$\nSimplifying the expression gives the SDE for the log-price $X_t$:\n$$\ndX_t = \\left( r - q - \\lambda \\kappa - \\frac{1}{2}\\sigma^2 \\right) dt + \\sigma dW_t + \\ln J \\, dN_t\n$$\n\n**2. Fair Variance Strike $K_{\\text{var}}$**\n\nThe fair variance strike, $K_{\\text{var}}$, is the value of $K$ that makes the swap's initial value zero. This is equivalent to the risk-neutral expected annualized realized variance:\n$$\nK_{\\text{var}} = \\frac{1}{T} \\mathbb{E} \\left[ [X]_T \\right]\n$$\nThe quadratic variation, $[X]_T$, of the jump-diffusion process $X_t$ is the sum of the quadratic variation from the continuous (Brownian) part and the sum of the squared jumps:\n$$\n[X]_T = \\left[ \\int_0^T \\sigma dW_t \\right]_T + \\left[ \\sum_{i=1}^{N_T} \\ln J_i \\right]_T = \\int_0^T \\sigma^2 dt + \\sum_{i=1}^{N_T} (\\ln J_i)^2\n$$\nSince $\\sigma$ is a constant, this simplifies to:\n$$\n[X]_T = \\sigma^2 T + \\sum_{i=1}^{N_T} (\\ln J_i)^2\n$$\nNow, we take the expectation under the risk-neutral measure. By linearity of expectation:\n$$\n\\mathbb{E} \\left[ [X]_T \\right] = \\mathbb{E}[\\sigma^2 T] + \\mathbb{E}\\left[ \\sum_{i=1}^{N_T} (\\ln J_i)^2 \\right] = \\sigma^2 T + \\mathbb{E}\\left[ \\sum_{i=1}^{N_T} (\\ln J_i)^2 \\right]\n$$\nThe second term is the expectation of a random sum. Using the law of total expectation (conditioning on $N_T$), where the jump sizes $(\\ln J_i)^2$ are independent of the number of jumps $N_T$:\n$$\n\\mathbb{E}\\left[ \\sum_{i=1}^{N_T} (\\ln J_i)^2 \\right] = \\mathbb{E}[N_T] \\mathbb{E}[(\\ln J)^2]\n$$\nFor a Poisson process with intensity $\\lambda$, $\\mathbb{E}[N_T] = \\lambda T$.\nFor the jump component, we are given $\\ln J \\sim \\mathcal{N}(\\mu_J, \\delta_J^2)$. The second moment of a normal random variable $Z \\sim \\mathcal{N}(\\mu, \\sigma^2)$ is $\\mathbb{E}[Z^2] = \\text{Var}(Z) + (\\mathbb{E}[Z])^2 = \\sigma^2 + \\mu^2$.\nTherefore, $\\mathbb{E}[(\\ln J)^2] = \\delta_J^2 + \\mu_J^2$.\n\nSubstituting these results back:\n$$\n\\mathbb{E} \\left[ [X]_T \\right] = \\sigma^2 T + (\\lambda T) (\\mu_J^2 + \\delta_J^2)\n$$\nFinally, we find the fair annualized variance strike $K_{\\text{var}}$ by dividing by $T$:\n$$\nK_{\\text{var}} = \\frac{1}{T} \\left( \\sigma^2 T + \\lambda T (\\mu_J^2 + \\delta_J^2) \\right)\n$$\n$$\nK_{\\text{var}} = \\sigma^2 + \\lambda (\\mu_J^2 + \\delta_J^2)\n$$\nThis expression is independent of $T$, $r$, and $q$, as expected for a fair variance strike under this model.\n\n**3. Present Value of the Variance Swap $\\text{PV}_0$**\n\nThe time-$0$ price, or present value $\\text{PV}_0$, of the variance swap is the discounted risk-neutral expectation of its payoff:\n$$\n\\text{PV}_0 = e^{-rT} \\mathbb{E} \\left[ N_{\\text{var}} \\left( \\frac{1}{T} [X]_T - K \\right) \\right]\n$$\nUsing the linearity of expectation and factoring out constants:\n$$\n\\text{PV}_0 = e^{-rT} N_{\\text{var}} \\left( \\frac{1}{T} \\mathbb{E} \\left[ [X]_T \\right] - K \\right)\n$$\nWe have already shown that $\\frac{1}{T} \\mathbb{E} \\left[ [X]_T \\right] = K_{\\text{var}}$. Therefore, the present value is:\n$$\n\\text{PV}_0 = e^{-rT} N_{\\text{var}} (K_{\\text{var}} - K)\n$$\n\nThese derived formulae will be implemented in the program.\n- Fair Strike: $K_{\\text{var}} = \\sigma^2 + \\lambda (\\mu_J^2 + \\delta_J^2)$\n- Present Value: $\\text{PV}_0 = N_{\\text{var}} (K_{\\text{var}} - K) e^{-rT}$",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the fair variance strike and present value of a variance swap\n    under the Merton jump-diffusion model for a suite of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (sigma, lam, mu_J, delta_J, T, r, q, K, N_var)\n    test_cases = [\n        (0.2, 0.5, -0.1, 0.2, 1.0, 0.03, 0.0, 0.06, 10000),     # Case A\n        (0.3, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.09, 7500),      # Case B\n        (0.0, 1.2, 0.05, 0.3, 0.5, 0.01, 0.0, 0.12, 5000),    # Case C\n        (0.25, 0.05, -0.2, 0.0, 1.5, 0.05, 0.0, 0.0645, 8000),# Case D\n        (0.15, 0.4, -0.02, 0.1, 3.0, 0.07, 0.02, 0.02, 12000),   # Case E\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack the parameters for the current test case.\n        # The dividend yield 'q' is part of the model definition but does not\n        # affect the quadratic variation of the log-price, so it is not used in the final formulas.\n        sigma, lam, mu_J, delta_J, T, r, q, K, N_var = case\n\n        # 1. Calculate the fair annualized variance swap strike (K_var).\n        # The formula is K_var = sigma^2 + lambda * (mu_J^2 + delta_J^2).\n        # This represents the annualized expected quadratic variation of log-returns.\n        # It is the sum of the variance from the continuous diffusion part (sigma^2)\n        # and the variance from the jump part (lambda * E[(ln J)^2]).\n        \n        # contribution from jumps is jump frequency * expected squared log-jump size\n        jump_variance_contribution = lam * (mu_J**2 + delta_J**2)\n        \n        # fair strike is sum of diffusion variance and jump variance\n        k_var = sigma**2 + jump_variance_contribution\n\n        # 2. Calculate the time-0 present value (PV_0) of the variance swap.\n        # The formula is PV_0 = N_var * (K_var - K) * exp(-r*T).\n        # This is the discounted risk-neutral expectation of the swap's payoff.\n        \n        pv_0 = N_var * (k_var - K) * np.exp(-r * T)\n\n        # Round the results to 10 decimal places as required.\n        k_var_rounded = round(k_var, 10)\n        pv_0_rounded = round(pv_0, 10)\n        \n        results.append([k_var_rounded, pv_0_rounded])\n\n    # Final print statement in the exact required format.\n    # The str() representation of a list is used to format each pair.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "The Merton model is not just a tool for pricing derivatives; it also provides a framework for making optimal investment decisions under uncertainty. In this final practice, you will solve for the optimal portfolio allocation between a risky asset, whose price is subject to sudden jumps, and a risk-free asset . This challenging exercise demonstrates how to incorporate the distinct risk of market crashes or spikes into portfolio theory, a critical consideration in modern risk management.",
            "id": "2410147",
            "problem": "An investor with constant relative risk aversion (CRRA) utility chooses a constant portfolio weight in a market with one risk-free asset and one risky asset whose price follows a jump-diffusion process. The investor’s utility over terminal wealth is CRRA with coefficient of relative risk aversion equal to $1$ (log utility), that is, $U(W) = \\ln(W)$. The risk-free asset grows at a continuously compounded rate $r$. The risky asset price $S_t$ evolves according to the Merton jump-diffusion specification\n$$\n\\frac{dS_t}{S_{t-}} = \\mu\\,dt + \\sigma\\,dB_t + y\\,dN_t,\n$$\nwhere $B_t$ is a standard Brownian motion, $N_t$ is a Poisson process with intensity $\\lambda$ independent of $B_t$, and $y$ is a constant jump size with $-1<y<\\infty$ so that at each jump the asset price is multiplied by $(1+y)$. The investor allocates a constant fraction $w$ of wealth to the risky asset (and the remainder to the risk-free asset), with no consumption and no transaction costs, and wealth must remain positive almost surely at all times.\n\nGiven the parameter values $r = 0.02$, $\\mu = 0.10$, $\\sigma = 0.20$, $\\lambda = 0.10$, and $y = -0.20$, determine the optimal constant portfolio weight $w^{\\star}$ that maximizes expected utility of terminal wealth under these dynamics, subject to the requirement that wealth remains positive at jump times. Round your answer to four significant figures. Express your final answer as a decimal with no units.",
            "solution": "The problem requires the determination of the optimal constant portfolio weight $w^{\\star}$ that maximizes the expected utility of terminal wealth for an investor with logarithmic utility, $U(W) = \\ln(W)$. The market consists of a risk-free asset with a constant rate of return $r$ and a risky asset whose price $S_t$ follows Merton's jump-diffusion model.\n\nFirst, we must validate the problem.\nStep 1: Extract Givens.\n- Utility function: $U(W) = \\ln(W)$, corresponding to a coefficient of relative risk aversion $\\gamma=1$.\n- Risk-free rate: $r$.\n- Risky asset price dynamics: $\\frac{dS_t}{S_{t-}} = \\mu\\,dt + \\sigma\\,dB_t + y\\,dN_t$.\n- $B_t$ is a standard Brownian motion.\n- $N_t$ is a Poisson process with intensity $\\lambda$, independent of $B_t$.\n- $y$ is the constant jump size, with $-1 < y < \\infty$.\n- $w$ is the constant fraction of wealth in the risky asset.\n- Constraint: Wealth $W_t$ must remain positive almost surely.\n- Parameter values: $r = 0.02$, $\\mu = 0.10$, $\\sigma = 0.20$, $\\lambda = 0.10$, $y = -0.20$.\n- Objective: Find the optimal weight $w^{\\star}$ and round the result to four significant figures.\n\nStep 2: Validate Using Extracted Givens.\nThe problem is scientifically grounded, rooted in the established theory of portfolio optimization under jump-diffusion processes developed by Robert C. Merton. It is well-posed, providing a clear objective function (maximization of expected log-utility) and all necessary parameters. The language is objective and precise. The constraints are clearly defined and standard for this class of problem. Therefore, the problem is valid.\n\nStep 3: Verdict and Action.\nThe problem is valid. A solution will be derived.\n\nThe wealth process $W_t$ evolves according to the stochastic differential equation (SDE) that combines the returns from the risk-free and risky assets. The fraction of wealth in the risky asset is $w$, and in the risk-free asset is $1-w$. The differential of wealth $dW_t$ is given by:\n$$\ndW_t = W_t (1-w) (r dt) + W_t w \\frac{dS_t}{S_{t-}}\n$$\nSubstituting the SDE for the risky asset, we get the wealth dynamics:\n$$\n\\frac{dW_t}{W_{t-}} = (1-w) r dt + w (\\mu dt + \\sigma dB_t + y dN_t)\n$$\n$$\n\\frac{dW_t}{W_{t-}} = ((1-w)r + w\\mu) dt + w\\sigma dB_t + wy dN_t\n$$\nAt a jump time $\\tau$, the wealth changes from $W_{\\tau-}$ to $W_{\\tau} = W_{\\tau-} + W_{\\tau-}wy = W_{\\tau-}(1+wy)$. The problem states that wealth must remain positive almost surely. This implies that at any jump time, $W_{\\tau} > 0$. Since $W_{\\tau-} > 0$, we must have the condition:\n$$\n1 + wy > 0\n$$\nGiven the parameter $y = -0.20$, this imposes a constraint on the portfolio weight $w$:\n$$\n1 + w(-0.20) > 0 \\implies 1 > 0.20w \\implies w < \\frac{1}{0.20} \\implies w < 5\n$$\nThis constraint is critical for finding the correct solution.\n\nThe investor's objective is to maximize $E[U(W_T)] = E[\\ln(W_T)]$. To do this, we apply Ito's Lemma for jump-diffusion processes to the function $f(W_t) = \\ln(W_t)$. The SDE for $\\ln(W_t)$ is:\n$$\nd\\ln(W_t) = \\left( \\frac{\\partial \\ln(W)}{\\partial W} \\mu_W + \\frac{1}{2} \\frac{\\partial^2 \\ln(W)}{\\partial W^2} \\sigma_W^2 \\right) dt + \\frac{\\partial \\ln(W)}{\\partial W} \\sigma_W dB_t + (\\ln(W_{t-}(1+wy)) - \\ln(W_{t-})) dN_t\n$$\nwhere $\\mu_W = W_{t-}((1-w)r + w\\mu)$ is the drift of wealth and $\\sigma_W = W_{t-}w\\sigma$ is the diffusion term of wealth. The derivatives are $\\frac{\\partial \\ln(W)}{\\partial W} = \\frac{1}{W}$ and $\\frac{\\partial^2 \\ln(W)}{\\partial W^2} = -\\frac{1}{W^2}$. Substituting these into the formula yields:\n$$\nd\\ln(W_t) = \\left( \\frac{1}{W_{t-}} W_{t-}((1-w)r + w\\mu) - \\frac{1}{2} \\frac{1}{W_{t-}^2} (W_{t-}w\\sigma)^2 \\right) dt + \\frac{1}{W_{t-}} (W_{t-}w\\sigma) dB_t + \\ln(1+wy) dN_t\n$$\nSimplifying this expression gives:\n$$\nd\\ln(W_t) = \\left( r + w(\\mu-r) - \\frac{1}{2}w^2\\sigma^2 \\right) dt + w\\sigma dB_t + \\ln(1+wy) dN_t\n$$\nIntegrating from $t=0$ to $t=T$ and taking the expectation:\n$$\nE[\\ln(W_T)] = \\ln(W_0) + \\int_0^T E[ d\\ln(W_t) ]\n$$\n$$\nE[\\ln(W_T)] = \\ln(W_0) + \\int_0^T \\left( r + w(\\mu-r) - \\frac{1}{2}w^2\\sigma^2 \\right) dt + E\\left[\\int_0^T w\\sigma dB_t\\right] + E\\left[\\int_0^T \\ln(1+wy) dN_t\\right]\n$$\nUsing the properties $E[dB_t] = 0$ and $E[dN_t] = \\lambda dt$, we get:\n$$\nE[\\ln(W_T)] = \\ln(W_0) + T \\left( r + w(\\mu-r) - \\frac{1}{2}w^2\\sigma^2 + \\lambda\\ln(1+wy) \\right)\n$$\nTo maximize expected terminal log-utility, we must maximize the time-independent growth rate term, which we define as $g(w)$:\n$$\ng(w) = r + w(\\mu-r) - \\frac{1}{2}w^2\\sigma^2 + \\lambda\\ln(1+wy)\n$$\nThe optimization problem is $\\max_{w} g(w)$ subject to $w < 5$. We find the optimal weight $w^{\\star}$ using the first-order condition (FOC), $\\frac{dg}{dw} = 0$:\n$$\n\\frac{dg}{dw} = (\\mu-r) - w\\sigma^2 + \\frac{\\lambda y}{1+wy} = 0\n$$\nThe second-order condition (SOC) for a maximum is $\\frac{d^2g}{dw^2} < 0$:\n$$\n\\frac{d^2g}{dw^2} = -\\sigma^2 - \\frac{\\lambda y^2}{(1+wy)^2}\n$$\nSince $\\sigma^2 > 0$, $\\lambda > 0$, and $y^2 > 0$, the SOC is always satisfied for any $w$ where $1+wy \\ne 0$. Thus, a solution to the FOC will yield a global maximum within the domain.\n\nWe now solve the FOC for $w$. Let's substitute the given parameters: $r = 0.02$, $\\mu = 0.10$, $\\sigma = 0.20$, $\\lambda = 0.10$, $y = -0.20$. This gives $\\mu-r = 0.08$ and $\\sigma^2 = 0.04$.\n$$\n0.08 - w(0.04) + \\frac{0.10(-0.20)}{1+w(-0.20)} = 0\n$$\n$$\n0.08 - 0.04w - \\frac{0.02}{1-0.20w} = 0\n$$\nMultiply the entire equation by $(1-0.20w)$ to clear the denominator:\n$$\n(0.08 - 0.04w)(1 - 0.20w) - 0.02 = 0\n$$\n$$\n0.08 - 0.016w - 0.04w + 0.008w^2 - 0.02 = 0\n$$\n$$\n0.008w^2 - 0.056w + 0.06 = 0\n$$\nTo simplify, multiply by $1000$ and divide by $4$:\n$$\n8w^2 - 56w + 60 = 0\n$$\n$$\n2w^2 - 14w + 15 = 0\n$$\nWe solve this quadratic equation for $w$ using the quadratic formula, $w = \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}$, with $a=2$, $b=-14$, $c=15$:\n$$\nw = \\frac{14 \\pm \\sqrt{(-14)^2 - 4(2)(15)}}{2(2)} = \\frac{14 \\pm \\sqrt{196 - 120}}{4} = \\frac{14 \\pm \\sqrt{76}}{4}\n$$\nSince $\\sqrt{76} = \\sqrt{4 \\times 19} = 2\\sqrt{19}$, the solutions are:\n$$\nw = \\frac{14 \\pm 2\\sqrt{19}}{4} = \\frac{7 \\pm \\sqrt{19}}{2}\n$$\nThis provides two potential roots:\n$$\nw_1 = \\frac{7 + \\sqrt{19}}{2} \\quad \\text{and} \\quad w_2 = \\frac{7 - \\sqrt{19}}{2}\n$$\nWe must check these solutions against the positivity constraint $w < 5$.\nNumerically, $\\sqrt{19} \\approx 4.3589$.\n$$\nw_1 \\approx \\frac{7 + 4.3589}{2} \\approx \\frac{11.3589}{2} \\approx 5.679\n$$\n$$\nw_2 \\approx \\frac{7 - 4.3589}{2} \\approx \\frac{2.6411}{2} \\approx 1.32055\n$$\nThe solution $w_1 \\approx 5.679$ violates the constraint $w < 5$. Therefore, it is not an admissible solution.\nThe solution $w_2 \\approx 1.32055$ satisfies the constraint $w < 5$ and is the unique optimal weight $w^{\\star}$.\nThe problem requires the answer to be rounded to four significant figures.\n$$\nw^{\\star} = 1.32055\\ldots \\approx 1.321\n$$\nThis is the optimal fraction of wealth to be allocated to the risky asset.",
            "answer": "$$\\boxed{1.321}$$"
        }
    ]
}