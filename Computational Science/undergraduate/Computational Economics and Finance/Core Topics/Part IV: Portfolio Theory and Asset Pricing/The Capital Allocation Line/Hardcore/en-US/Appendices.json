{
    "hands_on_practices": [
        {
            "introduction": "The standard Capital Allocation Line model often simplifies reality by assuming asset returns are independent and identically distributed over time. This exercise  moves beyond that assumption by introducing first-order autocorrelation, a feature commonly observed in real financial data. By working through this problem, you will learn how to adjust the calculation of multi-period portfolio risk to account for time-series dependencies, providing a more realistic understanding of the risk-return trade-off represented by the CAL's slope.",
            "id": "2438505",
            "problem": "An investor evaluates a risky asset whose one-day arithmetic return, denoted by $r_{t}$ for day $t$, is covariance-stationary with $\\mathbb{E}[r_{t}] = \\mu_{d}$, $\\operatorname{Var}(r_{t}) = \\sigma_{d}^{2}$, and first-order autocorrelation $\\operatorname{Corr}(r_{t}, r_{t-1}) = \\rho$. Assume $\\operatorname{Cov}(r_{t}, r_{t-k}) = 0$ for all $k \\geq 2$. The investor’s single decision period is $n$ trading days, and for mean-variance analysis the one-period arithmetic return of the risky asset is defined as the $n$-day cumulative arithmetic return\n$$\nR_{n} \\equiv \\sum_{t=1}^{n} r_{t}.\n$$\nThe $n$-day risk-free simple return is a known constant $R_{f,n}$. The investor forms a portfolio by investing a fraction $y$ of wealth in the risky asset and $1-y$ in the risk-free asset for this one period. The capital allocation line (CAL) for this risky asset and the risk-free asset is the set of attainable pairs $\\big(\\sigma_{p}(y), \\mathbb{E}[R_{p}(y)]\\big)$ as $y$ varies, where $R_{p}(y)$ is the one-period portfolio arithmetic return and $\\sigma_{p}(y)$ is its standard deviation.\n\nGiven the parameters\n- $\\mu_{d} = 5 \\times 10^{-4}$,\n- $\\sigma_{d} = 10^{-2}$,\n- $\\rho = 0.2$,\n- $n = 20$,\n- $R_{f,n} = 2 \\times 10^{-3}$,\n\ncompute the slope of the capital allocation line, defined as\n$$\nS \\equiv \\frac{\\mathbb{E}[R_{n}] - R_{f,n}}{\\sigma_{n}},\n$$\nwhere $\\sigma_{n} \\equiv \\sqrt{\\operatorname{Var}(R_{n})}$ is the standard deviation of the $n$-day cumulative arithmetic return adjusted for the given autocorrelation.\n\nExpress the final numerical value of $S$ as a decimal and round your answer to four significant figures.",
            "solution": "The capital allocation line (CAL) describes all linear combinations of a risky asset and a risk-free asset over a single decision period. With one risky asset and one risk-free asset, the one-period portfolio arithmetic return is $R_{p}(y) = y R_{n} + (1-y) R_{f,n}$, so $\\mathbb{E}[R_{p}(y)] = R_{f,n} + y\\big(\\mathbb{E}[R_{n}] - R_{f,n}\\big)$ and $\\sigma_{p}(y) = |y|\\,\\sigma_{n}$ because the risk-free return is nonrandom. Therefore, the CAL has slope equal to the Sharpe ratio of the risky asset over the period:\n$$\nS = \\frac{\\mathbb{E}[R_{n}] - R_{f,n}}{\\sigma_{n}}.\n$$\n\nTo adjust for autocorrelation in the calculation of $\\sigma_{n}$, we start from the variance of a sum in a covariance-stationary process. By definition,\n$$\nR_{n} = \\sum_{t=1}^{n} r_{t}, \\quad \\mathbb{E}[R_{n}] = \\sum_{t=1}^{n} \\mathbb{E}[r_{t}] = n \\mu_{d}.\n$$\nThe variance is\n$$\n\\operatorname{Var}(R_{n}) = \\operatorname{Var}\\!\\Big(\\sum_{t=1}^{n} r_{t}\\Big) = \\sum_{t=1}^{n} \\operatorname{Var}(r_{t}) + 2 \\sum_{1 \\leq i < j \\leq n} \\operatorname{Cov}(r_{i}, r_{j}).\n$$\nLet $\\gamma_{k} \\equiv \\operatorname{Cov}(r_{t}, r_{t-k})$ for $k \\geq 0$. Under covariance stationarity, $\\gamma_{0} = \\sigma_{d}^{2}$ and, by the given assumptions, $\\gamma_{1} = \\rho \\sigma_{d}^{2}$ and $\\gamma_{k} = 0$ for all $k \\geq 2$. Then only lag-$0$ and lag-$1$ terms contribute:\n- There are $n$ lag-$0$ terms, summing to $n \\sigma_{d}^{2}$.\n- There are $(n-1)$ distinct lag-$1$ pairs $(i,j)$ with $j=i+1$ and each appears twice in the double sum due to symmetry across $(i,j)$ and $(j,i)$, contributing $2(n-1)\\gamma_{1} = 2(n-1)\\rho \\sigma_{d}^{2}$.\n\nTherefore,\n$$\n\\operatorname{Var}(R_{n}) = n \\sigma_{d}^{2} + 2(n-1)\\rho \\sigma_{d}^{2} = \\sigma_{d}^{2}\\Big[n + 2(n-1)\\rho\\Big],\n$$\nand\n$$\n\\sigma_{n} = \\sigma_{d}\\,\\sqrt{n + 2(n-1)\\rho}.\n$$\n\nNow substitute the given values:\n- $\\mu_{d} = 5 \\times 10^{-4}$,\n- $\\sigma_{d} = 10^{-2}$,\n- $\\rho = 0.2$,\n- $n = 20$,\n- $R_{f,n} = 2 \\times 10^{-3}$.\n\nCompute the mean:\n$$\n\\mathbb{E}[R_{n}] = n \\mu_{d} = 20 \\times 5 \\times 10^{-4} = 1.0 \\times 10^{-2}.\n$$\nCompute the standard deviation:\n$$\n\\sigma_{n} = 10^{-2} \\sqrt{20 + 2 \\times 19 \\times 0.2} = 10^{-2} \\sqrt{20 + 7.6} = 10^{-2} \\sqrt{27.6}.\n$$\nThus,\n$$\nS = \\frac{1.0 \\times 10^{-2} - 2 \\times 10^{-3}}{10^{-2} \\sqrt{27.6}} = \\frac{8.0 \\times 10^{-3}}{10^{-2} \\sqrt{27.6}} = \\frac{0.8}{\\sqrt{27.6}}.\n$$\nEvaluate numerically:\n$$\n\\sqrt{27.6} \\approx 5.2536,\\quad S \\approx \\frac{0.8}{5.2536} \\approx 0.1523.\n$$\nRounded to four significant figures, $S = 0.1523$.",
            "answer": "$$\\boxed{0.1523}$$"
        },
        {
            "introduction": "The straight-line geometry of the Capital Allocation Line is a direct consequence of combining a risky portfolio with a truly risk-free asset. This thought experiment  probes that fundamental assumption: what happens to our investment opportunity set if the \"safest\" available asset still carries a non-zero probability of default? Answering this question reveals the underlying principles of portfolio construction, forcing you to reason about combining two risky assets and understand precisely why the standard CAL is a special, idealized case.",
            "id": "2438516",
            "problem": "In Modern Portfolio Theory (MPT), the Capital Allocation Line (CAL) is the set of mean–standard deviation pairs of portfolios formed by combining a risk-free asset and a given risky portfolio. Suppose the asset typically regarded as risk-free is actually subject to a small but non-zero probability of default $p_d \\in (0,1)$, so its return is a random variable with positive variance. Consider an investor who can allocate wealth between this defaultable “cash” asset and a given risky portfolio. In the mean–variance plane, what is the qualitative effect of $p_d>0$ on the CAL?\n\nA. The CAL is unchanged: it remains a straight line through the risk-free rate because a small $p_d$ only lowers the expected return but does not affect the geometry.\n\nB. The CAL remains a straight line and simply shifts to start at the expected return of the defaultable asset, with the same slope as before.\n\nC. The CAL ceases to be a straight line: with $p_d>0$ the “cash” asset has positive variance and generally non-zero covariance with the risky portfolio, so the set of attainable mean–standard deviation pairs from mixing the two is curved; there is no zero-variance intercept, and the attainable set shifts inward relative to the true risk-free case.\n\nD. The CAL becomes steeper because the default risk adds a spread to the “risk-free” asset’s expected return that dominates the added variance.\n\nE. The CAL becomes a straight line with a kink at the tangency portfolio due to default risk, but still intercepts the vertical axis at the defaultable asset’s expected return.",
            "solution": "The problem statement must first be validated for scientific and logical integrity.\n\n### Step 1: Extract Givens\n- **Context**: Modern Portfolio Theory (MPT).\n- **Object of Study**: Capital Allocation Line (CAL), which is the set of mean-standard deviation pairs for portfolios combining a risk-free asset and a single risky portfolio.\n- **Modification**: The asset typically considered risk-free is now a \"defaultable 'cash' asset\".\n- **Properties of the Modified Asset**:\n    - It has a small but non-zero probability of default, $p_d \\in (0,1)$.\n    - Its return is a random variable, implying its variance is positive.\n- **Investor's Action**: Allocate capital between this defaultable asset and a given risky portfolio.\n- **Question**: What is the qualitative effect of $p_d > 0$ on the shape of the CAL in the mean-variance (or mean-standard deviation) plane?\n\n### Step 2: Validate Using Extracted Givens\n- **Scientific Grounding**: The problem is well-grounded in financial economics. The concept of a risk-free asset being subject to default risk (e.g., sovereign credit risk for government bonds) is a standard and important extension of the basic MPT models. It is scientifically sound.\n- **Well-Posedness**: The problem is well-posed. It asks for the qualitative change in the geometry of the investment opportunity set when a core assumption (existence of a truly risk-free asset) is relaxed. The new geometry is uniquely determined by the principles of portfolio mathematics.\n- **Objectivity**: The problem is stated in precise, objective, and technical language common to finance and economics. There is no ambiguity or subjectivity.\n\n### Step 3: Verdict and Action\nThe problem statement is valid. It presents a clear, consistent, and scientifically sound question within the domain of computational economics and finance. A rigorous derivation can proceed.\n\n### Derivation\n\nLet us first establish the baseline case, which is the standard Capital Allocation Line (CAL). Let $R_f$ be the return of a truly risk-free asset, so its expected return is $E[R_f] = r_f$ and its variance is $\\text{Var}(R_f) = \\sigma_f^2 = 0$. Let $P$ be a risky portfolio with expected return $E[R_P] = \\mu_P$ and standard deviation $\\text{StdDev}(R_P) = \\sigma_P > 0$.\n\nA new portfolio, $N$, is constructed with a weight $w$ in the risky portfolio $P$ and $(1-w)$ in the risk-free asset.\nThe expected return of this portfolio is:\n$$ \\mu_N = w \\mu_P + (1-w) r_f $$\nThe variance of the portfolio is:\n$$ \\sigma_N^2 = w^2 \\sigma_P^2 + (1-w)^2 \\sigma_f^2 + 2w(1-w)\\text{Cov}(R_P, R_f) $$\nSince the risk-free asset has zero variance, $\\sigma_f = 0$, and its covariance with any other asset is also zero. The expression simplifies to:\n$$ \\sigma_N^2 = w^2 \\sigma_P^2 \\implies \\sigma_N = |w| \\sigma_P $$\nAssuming the investor takes a long position in the risky asset ($w \\ge 0$), we have $w = \\sigma_N / \\sigma_P$. Substituting this into the expected return equation:\n$$ \\mu_N = r_f + \\frac{\\sigma_N}{\\sigma_P}(\\mu_P - r_f) = r_f + \\left( \\frac{\\mu_P - r_f}{\\sigma_P} \\right) \\sigma_N $$\nThis is the equation of a straight line in the $(\\sigma, \\mu)$ plane, with a vertical-axis intercept at $(0, r_f)$. This line is the CAL.\n\nNow, we introduce the modification described in the problem. The \"risk-free\" asset is replaced by a defaultable \"cash\" asset, which we will call $C$. Let its return be the random variable $R_C$. The problem states it has a default probability $p_d \\in (0,1)$ and thus a positive variance. Let's formalize this. Suppose the asset yields a return $r_{ok}$ in the no-default state (with probability $1-p_d$) and a lower return $r_{fail}$ in the default state (with probability $p_d$).\nThe expected return is $\\mu_C = E[R_C] = (1-p_d)r_{ok} + p_d r_{fail}$.\nThe variance is $\\sigma_C^2 = \\text{Var}(R_C) = p_d(1-p_d)(r_{ok} - r_{fail})^2$. Since $p_d \\in (0,1)$ and $r_{ok} \\neq r_{fail}$ for the risk to be meaningful, it is clear that $\\sigma_C^2 > 0$.\n\nThus, the investor is now combining two risky assets: the portfolio $P$ (with characteristics $\\mu_P, \\sigma_P$) and the defaultable asset $C$ (with characteristics $\\mu_C, \\sigma_C > 0$).\nLet's form a new portfolio, $N'$, with weight $w$ in $P$ and $(1-w)$ in $C$.\nThe expected return is:\n$$ \\mu_{N'} = w \\mu_P + (1-w) \\mu_C $$\nThe variance is:\n$$ \\sigma_{N'}^2 = w^2 \\sigma_P^2 + (1-w)^2 \\sigma_C^2 + 2w(1-w)\\rho_{PC}\\sigma_P\\sigma_C $$\nwhere $\\rho_{PC}$ is the correlation coefficient between the returns of $P$ and $C$. Default risk is typically a component of systematic risk, so it is reasonable to assume $\\rho_{PC}$ is not zero.\n\nThis is the standard formulation for a portfolio of two risky assets. The set of attainable $(\\sigma_{N'}, \\mu_{N'})$ pairs, as the weight $w$ is varied, traces out a hyperbola in the mean-standard deviation plane. It is not a straight line unless in the degenerate case where $\\rho_{PC} = \\pm 1$.\n\nKey consequences are:\n1.  **Curvature**: The opportunity set is no longer linear. It is a curve (a branch of a hyperbola).\n2.  **No Zero-Risk Intercept**: The defaultable asset $C$ itself has a positive standard deviation $\\sigma_C > 0$. The portfolio consisting of $100\\%$ of asset $C$ is represented by the point $(\\sigma_C, \\mu_C)$. The minimum-variance portfolio that can be formed by combining $P$ and $C$ will also have a positive variance (unless $\\rho_{PC}=-1$ and weights are precisely chosen, which is a specific case and not a general property). Therefore, the new opportunity set does not touch the vertical axis where $\\sigma=0$.\n3.  **Dominated by Original CAL**: The original CAL represented the best possible risk-return trade-offs. Introducing an imperfection (risk in the \"risk-free\" asset) must result in a strictly worse set of investment opportunities. The new curved frontier will lie \"inward\" from the original straight-line CAL, meaning for any given level of risk $\\sigma > \\sigma_C$, the achievable expected return $\\mu_{N'}$ will be lower than the return on the original CAL.\n\n### Option-by-Option Analysis\n\n**A. The CAL is unchanged: it remains a straight line through the risk-free rate because a small $p_d$ only lowers the expected return but does not affect the geometry.**\nThis is **Incorrect**. The presence of default risk, $p_d > 0$, fundamentally changes the nature of the \"cash\" asset from risk-free to risky ($\\sigma_C > 0$). The combination of two risky assets yields a curved (hyperbolic) opportunity set, not a straight line. The geometry is profoundly affected.\n\n**B. The CAL remains a straight line and simply shifts to start at the expected return of the defaultable asset, with the same slope as before.**\nThis is **Incorrect**. It makes two errors. First, the opportunity set is not a straight line. Second, it cannot \"start\" on the vertical axis, as the defaultable asset itself has positive risk, $\\sigma_C > 0$.\n\n**C. The CAL ceases to be a straight line: with $p_d>0$ the “cash” asset has positive variance and generally non-zero covariance with the risky portfolio, so the set of attainable mean–standard deviation pairs from mixing the two is curved; there is no zero-variance intercept, and the attainable set shifts inward relative to the true risk-free case.**\nThis is **Correct**. This option accurately summarizes all the consequences of the modification.\n- \"ceases to be a straight line... is curved\": Correct, it becomes a hyperbola.\n- \"`cash` asset has positive variance\": Correct, as derived $\\sigma_C^2 > 0$.\n- \"generally non-zero covariance\": Correct, as default events are typically linked to broader market conditions.\n- \"no zero-variance intercept\": Correct, the minimum variance portfolio has $\\sigma_{min} > 0$.\n- \"attainable set shifts inward\": Correct, the new opportunity set is dominated by the original CAL.\n\n**D. The CAL becomes steeper because the default risk adds a spread to the “risk-free” asset’s expected return that dominates the added variance.**\nThis is **Incorrect**. The primary flaw is that the opportunity set is no longer a line, so describing its \"slope\" as \"steeper\" is meaningless. The premise that default risk adds a spread to the expected return is also a confusing statement in this context; if anything, for a given promised return, default risk lowers the expected return.\n\n**E. The CAL becomes a straight line with a kink at the tangency portfolio due to default risk, but still intercepts the vertical axis at the defaultable asset’s expected return.**\nThis is **Incorrect**. A kinked line is not the correct shape; the shape is a smooth hyperbola. Furthermore, the set does not intercept the vertical axis. The premise is flawed on multiple counts.",
            "answer": "$$\\boxed{C}$$"
        },
        {
            "introduction": "Theoretical concepts in finance gain their true power when applied to complex, real-world scenarios. This final hands-on practice  bridges the gap between abstract theory and computational implementation. You will write a program to find the optimal tangency portfolio and construct the resulting Capital Market Line from a universe of fifty assets, translating the mathematical formulas of portfolio optimization into a practical and powerful computational tool.",
            "id": "2438483",
            "problem": "You are given a universe of $50$ risky assets. Let $R$ denote the $50 \\times 50$ correlation matrix of asset returns, $\\sigma \\in \\mathbb{R}^{50}$ the vector of asset standard deviations, $\\mu \\in \\mathbb{R}^{50}$ the vector of expected returns (all expressed as decimals, not percentages), and $\\Sigma = D R D$ the covariance matrix with $D = \\operatorname{diag}(\\sigma)$. A risk-free rate $r_f \\in \\mathbb{R}$ is available (also expressed as a decimal). Consider the Capital Allocation Line (CAL), also known in equilibrium as the Capital Market Line (CML), formed by combinations of the risk-free asset and the tangency portfolio.\n\nDefine the tangency portfolio $w^\\star \\in \\mathbb{R}^{50}$ as the solution to the optimization problem that maximizes the Sharpe ratio, with short sales allowed and budget constraint:\n- maximize $(\\mu^\\top w - r_f)/\\sqrt{w^\\top \\Sigma w}$ over $w \\in \\mathbb{R}^{50}$,\n- subject to $\\mathbf{1}^\\top w = 1$, where $\\mathbf{1}$ is the vector of ones in $\\mathbb{R}^{50}$.\n\nLet the slope of the Capital Allocation Line (CAL) be $S = (\\mu^\\top w^\\star - r_f)/\\sqrt{(w^\\star)^\\top \\Sigma w^\\star}$. For any target standard deviation $\\bar{\\sigma} \\ge 0$, the expected return on the CAL is $E_{\\text{CAL}}(\\bar{\\sigma}) = r_f + S \\, \\bar{\\sigma}$.\n\nFor each test case below, you must:\n- construct $R$, $\\sigma$, $\\mu$, and $\\Sigma$ as specified;\n- compute the tangency portfolio $w^\\star$ for the given $r_f$ under the constraint $\\mathbf{1}^\\top w^\\star = 1$ with short selling allowed;\n- compute the CAL slope $S$ and the CAL expected returns $E_{\\text{CAL}}(\\bar{\\sigma})$ for the target standard deviations $\\bar{\\sigma} \\in \\{0.0, 0.05, 0.15\\}$.\n\nAll returns and standard deviations are unit-free decimals. Report all floating-point outputs rounded to $6$ decimal places.\n\nTest suite and data construction for each case:\n- For a given seed $s \\in \\mathbb{Z}$, define a random number generator using that seed. Generate a matrix $A \\in \\mathbb{R}^{50 \\times 50}$ with independent standard normal entries. Let $M = A A^\\top$. Define the correlation matrix by $R_{ij} = M_{ij}/\\sqrt{M_{ii} M_{jj}}$ for all $i,j$. Independently draw $\\sigma_i$ from the continuous uniform distribution on $[0.05, 0.35]$ for each $i \\in \\{1,\\dots,50\\}$. Independently draw $\\mu_i$ from the continuous uniform distribution on $[0.02, 0.18]$ for each $i \\in \\{1,\\dots,50\\}$. Set $D = \\operatorname{diag}(\\sigma)$ and $\\Sigma = D R D$.\n- Use the following test cases:\n    1. Case $1$: seed $s=7$, risk-free rate $r_f = 0.02$.\n    2. Case $2$: seed $s=11$, risk-free rate $r_f = 0.00$.\n    3. Case $3$: seed $s=13$, risk-free rate $r_f = -0.01$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For each test case, output the list $[S, E_{\\text{CAL}}(0.0), E_{\\text{CAL}}(0.05), E_{\\text{CAL}}(0.15)]$ with each entry rounded to $6$ decimal places. The overall output must be a single list containing the three test case results in order. For example, the final output format must be:\n[[S1,E1_0.0,E1_0.05,E1_0.15],[S2,E2_0.0,E2_0.05,E2_0.15],[S3,E3_0.0,E3_0.05,E3_0.15]].",
            "solution": "The problem statement is validated as scientifically sound, well-posed, objective, and self-contained. It describes a standard problem in modern portfolio theory: the determination of the Capital Allocation Line (CAL). We shall proceed with a full derivation and computational solution.\n\nThe fundamental task is to find the \"tangency portfolio,\" which is the portfolio of risky assets that, when combined with a risk-free asset, offers the best risk-return trade-off. This portfolio is located at the point of tangency between the efficient frontier of risky assets and the line originating from the risk-free rate on the expected return-standard deviation plane. This line is the Capital Allocation Line. The slope of the CAL is the Sharpe ratio of the tangency portfolio.\n\nLet $w \\in \\mathbb{R}^{50}$ be the vector of weights for the $50$ risky assets, such that the weights sum to one: $\\mathbf{1}^\\top w = 1$, where $\\mathbf{1}$ is a vector of ones. Short selling is permitted, so $w_i \\in \\mathbb{R}$. The expected return of such a portfolio is $E[R_p] = \\mu^\\top w$ and its variance is $\\sigma_p^2 = w^\\top \\Sigma w$, where $\\mu$ is the vector of expected returns, and $\\Sigma$ is the covariance matrix of asset returns.\n\nThe objective is to maximize the Sharpe ratio, $S_p$, of a portfolio of risky assets:\n$$ \\text{maximize}_{w} \\quad S_p(w) = \\frac{\\mu^\\top w - r_f}{\\sqrt{w^\\top \\Sigma w}} $$\nsubject to the budget constraint:\n$$ \\mathbf{1}^\\top w = 1 $$\nwhere $r_f$ is the risk-free rate of return.\n\nLet $\\mu_e = \\mu - r_f \\mathbf{1}$ be the vector of excess expected returns over the risk-free rate. The objective function becomes maximizing $(\\mu_e^\\top w)/\\sqrt{w^\\top \\Sigma w}$. It is a known result in portfolio theory that the solution to this problem is a portfolio whose weights $w$ are proportional to $\\Sigma^{-1} \\mu_e$. This can be formally shown by solving an equivalent optimization problem: minimize the variance $\\frac{1}{2} w^\\top \\Sigma w$ for a fixed level of excess return $\\mu_e^\\top w = C$ (for some constant $C > 0$). The Lagrangian for this equivalent problem is $\\mathcal{L}(w, \\lambda) = \\frac{1}{2} w^\\top \\Sigma w - \\lambda (\\mu_e^\\top w - C)$.\nTaking the derivative with respect to $w$ and setting it to zero gives the first-order condition:\n$$ \\frac{\\partial \\mathcal{L}}{\\partial w} = \\Sigma w - \\lambda \\mu_e = 0 $$\nAssuming $\\Sigma$ is invertible (which it will be with probability $1$ by the specified construction), we find that any such optimal portfolio's weights are of the form:\n$$ w = \\lambda \\Sigma^{-1} \\mu_e $$\nThis implies that the weights of the tangency portfolio, $w^\\star$, are proportional to the vector we shall denote $w_{\\text{unscaled}} = \\Sigma^{-1} \\mu_e$.\n\nTo find the specific weights $w^\\star$ that satisfy the budget constraint $\\mathbf{1}^\\top w^\\star = 1$, we must normalize this unscaled weight vector. Let $k = \\mathbf{1}^\\top w_{\\text{unscaled}}$ be the sum of the unscaled weights. The normalized tangency portfolio weights are then:\n$$ w^\\star = \\frac{w_{\\text{unscaled}}}{k} = \\frac{\\Sigma^{-1} \\mu_e}{\\mathbf{1}^\\top (\\Sigma^{-1} \\mu_e)} = \\frac{\\Sigma^{-1} (\\mu - r_f \\mathbf{1})}{\\mathbf{1}^\\top \\Sigma^{-1} (\\mu - r_f \\mathbf{1})} $$\nComputationally, it is more numerically stable to solve the linear system $\\Sigma w_{\\text{unscaled}} = \\mu_e$ for $w_{\\text{unscaled}}$ rather than computing the inverse of $\\Sigma$ directly.\n\nOnce the tangency portfolio weights $w^\\star$ are determined, we can calculate its expected return $\\mu_p^\\star = \\mu^\\top w^\\star$ and standard deviation $\\sigma_p^\\star = \\sqrt{(w^\\star)^\\top \\Sigma w^\\star}$.\n\nThe slope of the Capital Allocation Line, $S$, is the Sharpe ratio of this tangency portfolio:\n$$ S = \\frac{\\mu_p^\\star - r_f}{\\sigma_p^\\star} = \\frac{\\mu^\\top w^\\star - r_f}{\\sqrt{(w^\\star)^\\top \\Sigma w^\\star}} $$\n\nFinally, the expected return on the CAL for a given target standard deviation $\\bar{\\sigma} \\ge 0$ is given by the linear relationship:\n$$ E_{\\text{CAL}}(\\bar{\\sigma}) = r_f + S \\cdot \\bar{\\sigma} $$\nThis formula describes the expected return of a complete portfolio formed by allocating a certain fraction of capital to the tangency portfolio and the remainder to the risk-free asset. For $\\bar{\\sigma} = 0.0$, the portfolio is $100\\%$ in the risk-free asset, and $E_{\\text{CAL}}(0.0) = r_f$.\n\nThe algorithm for each test case is as follows:\n1.  Initialize a random number generator with the given seed $s$.\n2.  Generate a $50 \\times 50$ matrix $A$ of standard normal random variates from $\\mathcal{N}(0, 1)$.\n3.  Compute $M = A A^\\top$.\n4.  Construct the correlation matrix $R$ where $R_{ij} = M_{ij} / \\sqrt{M_{ii} M_{jj}}$.\n5.  Generate the vector of standard deviations $\\sigma$ from $U(0.05, 0.35)$ and the vector of expected returns $\\mu$ from $U(0.02, 0.18)$.\n6.  Construct the covariance matrix $\\Sigma = D R D$, where $D = \\operatorname{diag}(\\sigma)$.\n7.  Compute the excess return vector $\\mu_e = \\mu - r_f \\mathbf{1}$.\n8.  Solve the linear system $\\Sigma w_{\\text{unscaled}} = \\mu_e$ for $w_{\\text{unscaled}}$.\n9.  Normalize the weights: $w^\\star = w_{\\text{unscaled}} / (\\mathbf{1}^\\top w_{\\text{unscaled}})$.\n10. Calculate the CAL slope $S = (\\mu^\\top w^\\star - r_f) / \\sqrt{(w^\\star)^\\top \\Sigma w^\\star}$.\n11. Calculate $E_{\\text{CAL}}(\\bar{\\sigma}) = r_f + S \\cdot \\bar{\\sigma}$ for $\\bar{\\sigma} \\in \\{0.0, 0.05, 0.15\\}$.\n12. Collate and round the results to $6$ decimal places.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the Capital Allocation Line slope and expected returns for several test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (seed, risk-free rate)\n        (7, 0.02),\n        (11, 0.00),\n        (13, -0.01),\n    ]\n\n    target_sigmas = [0.0, 0.05, 0.15]\n    all_results = []\n    \n    for case in test_cases:\n        s, r_f = case\n        \n        # --- Start of calculation for one case ---\n        N = 50  # Number of assets\n        rng = np.random.default_rng(seed=s)\n\n        # Step 1: Generate asset parameters\n        # Generate random matrix A and use it to construct a valid correlation matrix R\n        A = rng.standard_normal((N, N))\n        M = A @ A.T\n\n        # R_ij = M_ij / sqrt(M_ii * M_jj)\n        diag_M = np.diag(M)\n        diag_M_inv_sqrt = np.diag(1.0 / np.sqrt(diag_M))\n        R = diag_M_inv_sqrt @ M @ diag_M_inv_sqrt\n\n        # Generate vectors for standard deviation and expected return\n        sigma_vec = rng.uniform(0.05, 0.35, N)\n        mu_vec = rng.uniform(0.02, 0.18, N)\n\n        # Construct covariance matrix Sigma = D * R * D\n        D = np.diag(sigma_vec)\n        Sigma = D @ R @ D\n\n        # Step 2: Compute the tangency portfolio\n        # Vector of excess returns over the risk-free rate\n        mu_e = mu_vec - r_f\n        \n        # Solve the linear system Sigma * w_unscaled = mu_e for unscaled weights.\n        # This is more numerically stable than inverting Sigma.\n        w_unscaled = np.linalg.solve(Sigma, mu_e)\n\n        # Normalize weights to sum to 1 to get the tangency portfolio weights\n        w_star = w_unscaled / np.sum(w_unscaled)\n\n        # Step 3: Compute the CAL slope S\n        # Calculate expected return and standard deviation of the tangency portfolio\n        mu_p_star = mu_vec.T @ w_star\n        sigma_p_star = np.sqrt(w_star.T @ Sigma @ w_star)\n\n        # The slope S is the Sharpe ratio of the tangency portfolio\n        S = (mu_p_star - r_f) / sigma_p_star\n\n        # Step 4: Compute CAL expected returns for target standard deviations\n        E_cal_values = [r_f + S * ts for ts in target_sigmas]\n        \n        # Collect the results for the current case: [S, E_CAL(0.0), E_CAL(0.05), E_CAL(0.15)]\n        case_result_list = [S] + E_cal_values\n        \n        # --- End of calculation for one case ---\n        all_results.append(case_result_list)\n\n    # Final print statement in the exact required format.\n    # Format: [[S1,E1_0.0,E1_0.05,E1_0.15],[S2,...],[S3,...]]\n    outer_parts = []\n    for res_list in all_results:\n        # Format each number to 6 decimal places\n        inner_parts = [f\"{val:.6f}\" for val in res_list]\n        outer_parts.append(f\"[{','.join(inner_parts)}]\")\n    \n    final_output_str = f\"[{','.join(outer_parts)}]\"\n\n    print(final_output_str)\n\nsolve()\n\n```"
        }
    ]
}