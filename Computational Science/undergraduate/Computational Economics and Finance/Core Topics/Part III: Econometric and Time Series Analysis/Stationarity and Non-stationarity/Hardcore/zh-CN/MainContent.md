## 引言
在经济、金融乃至更广泛科学领域的数据分析中，时间序列无处不在。然而，要从这些按时间顺序[排列](@entry_id:136432)的数据点中提取有意义的洞见，我们必须首先理解其最根本的统计特性之一：[平稳性](@entry_id:143776)。[平稳性](@entry_id:143776)描述了一个过程的统计规律是否随时间推移而保持不变。这一概念看似简单，却是整个时间序列计量经济学大厦的基石。一个序列是否平稳，决定了我们能否对其进行可靠的建模和预测，一个冲击对其影响是暂时的还是永久的，以及我们对未来的预测不确定性是有限的还是会无限发散。

然而，现实世界中的许多重要经济和金融序列，如GDP、股票价格和汇率，恰恰表现出非平稳的特征。忽视这种[非平稳性](@entry_id:180513)会引导我们走[向错](@entry_id:161223)误的结论，其中最臭名昭著的便是“[伪回归](@entry_id:139052)”陷阱。因此，理解平稳性与[非平稳性](@entry_id:180513)之间的区别，并掌握识别和处理它们的方法，是任何定量分析师的必备技能。本文旨在系统性地阐述这一核心主题，为读者构建一个坚实的理论与实践框架。

在接下来的内容中，我们将分三步深入探索这个领域。首先，在“原理与机制”一章中，我们将剖析[平稳性](@entry_id:143776)的精确定义，介绍产生平稳与非[平稳序列](@entry_id:144560)的核心模型（如[AR模型](@entry_id:189434)和[随机游走](@entry_id:142620)），并揭示忽视[非平稳性](@entry_id:180513)所带来的严重后果。接着，在“应用与跨学科联系”一章，我们将把理论付诸实践，通过大量来自经济、金融、社会乃至[气候科学](@entry_id:161057)的真实案例，展示平稳性分析如何被用来检验重要的经济假说、评估政策效果以及理解复杂的系统动态。最后，在“动手实践”部分，你将有机会通过解决具体问题，亲手运用这些知识来分析和转换时间序列，从而巩固所学。

## 原理与机制

在[时间序列分析](@entry_id:178930)领域，**[平稳性](@entry_id:143776) (stationarity)** 是一个核心概念，它构成了大部分理论和建模实践的基石。一个平稳的序列具有不随时间变化的统计特性，这使得我们能够对其行为进行建模和预测。相反，非[平稳序列](@entry_id:144560)的统计特性会随时间演变，这给分析带来了重大挑战，但也揭示了系统潜在的结构性动态，如趋势、周期和结构性变化。本章将深入探讨平稳性与[非平稳性](@entry_id:180513)的基本原理和关键机制。

### 平稳性的基础：严格平稳与弱平稳

一个[随机过程](@entry_id:159502)的平稳性可以通过两种主要方式来定义：严格平稳和弱平稳。

**[严格平稳性](@entry_id:260913) (Strict Stationarity)** 是最强的[平稳性](@entry_id:143776)定义。如果一个时间序列 $\{X_t\}$ 是严格平稳的，那么对于任意的时间点集合 $t_1, t_2, \dots, t_k$ 和任意的[时间平移](@entry_id:261541) $h$，其[联合概率分布](@entry_id:171550)都与平移后的时间点集合 $t_1+h, t_2+h, \dots, t_k+h$ 的[联合概率分布](@entry_id:171550)相同。换言之，该过程的整个概率结构都对[时间平移](@entry_id:261541)具有[不变性](@entry_id:140168)。这是一个非常强的条件，在实践中难以验证，且对于许多应用而言过于严苛。

因此，经济和金融学中的大部分分析都依赖于一个更宽松的条件，即 **[弱平稳性](@entry_id:171204) (Weak Stationarity)** 或 **协[方差](@entry_id:200758)平稳性 (Covariance Stationarity)**。一个时间序列 $\{X_t\}$ 被认为是弱平稳的，如果它满足以下三个条件：
1.  **均值恒定**: 过程的[期望值](@entry_id:153208) $\mathbb{E}[X_t] = \mu$ 是一个不依赖于时间 $t$ 的常数。
2.  **[方差](@entry_id:200758)恒定**: 过程的[方差](@entry_id:200758) $\operatorname{Var}(X_t) = \mathbb{E}[(X_t - \mu)^2] = \sigma^2$ 是一个不依赖于时间 $t$ 的有限常数。
3.  **[自协方差](@entry_id:270483)仅依赖于时间差**: 任意两个时间点 $t$ 和 $t+h$ 之间值的协[方差](@entry_id:200758) $\operatorname{Cov}(X_t, X_{t+h}) = \gamma(h)$ 仅依赖于时间间隔（或称**滞后 (lag)**）$h$，而不依赖于具体的时间点 $t$。

[严格平稳性](@entry_id:260913)意味着[弱平稳性](@entry_id:171204)（只要一阶和二阶矩存在），但反之不成立。我们可以通过一个精巧的构造来揭示这两种平稳性之间的差异 。考虑一个由独立同分布 (i.i.d.) [随机变量](@entry_id:195330)构成的基础过程 $\{Y_t\}$，其[分布](@entry_id:182848)为 $\mathbb{P}(Y_t=2)=\frac{1}{3}$ 且 $\mathbb{P}(Y_t=-1)=\frac{2}{3}$。该过程的[期望值](@entry_id:153208)为 $\mathbb{E}[Y_t] = 2(\frac{1}{3}) - 1(\frac{2}{3}) = 0$，二阶矩为 $\mathbb{E}[Y_t^2] = 2^2(\frac{1}{3}) + (-1)^2(\frac{2}{3}) = 2$。现在，我们定义一个新的过程 $X_t = (-1)^t Y_t$。

让我们来检验 $\{X_t\}$ 的弱[平稳性条件](@entry_id:191085)：
-   **均值**: $\mathbb{E}[X_t] = \mathbb{E}[(-1)^t Y_t] = (-1)^t \mathbb{E}[Y_t] = (-1)^t \cdot 0 = 0$。均值恒为零。
-   **[方差](@entry_id:200758)**: $\mathbb{E}[X_t^2] = \mathbb{E}[((-1)^t Y_t)^2] = \mathbb{E}[Y_t^2] = 2$。因此，$\operatorname{Var}(X_t) = \mathbb{E}[X_t^2] - (\mathbb{E}[X_t])^2 = 2 - 0^2 = 2$。[方差](@entry_id:200758)恒为2。
-   **[自协方差](@entry_id:270483)**: 对于滞后 $h \neq 0$，$\operatorname{Cov}(X_t, X_{t+h}) = \mathbb{E}[X_t X_{t+h}] = \mathbb{E}[(-1)^t Y_t (-1)^{t+h} Y_{t+h}] = (-1)^{2t+h} \mathbb{E}[Y_t Y_{t+h}]$。由于 $\{Y_t\}$ 是独立同分布的且均值为零，$\mathbb{E}[Y_t Y_{t+h}] = \mathbb{E}[Y_t]\mathbb{E}[Y_{t+h}] = 0$。因此，对于 $h \neq 0$，[自协方差](@entry_id:270483)为零。对于 $h=0$，[自协方差](@entry_id:270483)就是[方差](@entry_id:200758)，为2。[自协方差函数](@entry_id:262114) $\gamma_X(h)$ 可以写为 $\gamma_X(h) = 2\delta_{h,0}$（其中 $\delta_{h,0}$ 是克罗内克函数），它显然只依赖于 $h$。

由于所有三个条件都满足，过程 $\{X_t\}$ 是弱平稳的。然而，它是否是严格平稳的呢？我们来比较一下 $X_0$ 和 $X_1$ 的[分布](@entry_id:182848)。$X_0 = Y_0$，其取值为 $\{-1, 2\}$。而 $X_1 = -Y_1$，其取值为 $\{1, -2\}$。由于这两个[随机变量](@entry_id:195330)的[分布](@entry_id:182848)（甚至支撑集）都不同，该过程的[联合概率分布](@entry_id:171550)显然不是[时间平移](@entry_id:261541)不变的。因此，$\{X_t\}$ 不是严格平稳的。这个例子清晰地表明，一个过程可以具有不随时间变化的均值和协[方差](@entry_id:200758)结构，但其完整的[概率分布](@entry_id:146404)可能仍然依赖于时间。在实践中，[弱平稳性](@entry_id:171204)为我们提供了一个强大且足够灵活的框架来进行时间序列建模。

### 核心时间序列模型：自回归与[随机游走过程](@entry_id:171699)

理解平稳性的一个有效途径是研究生成这些序列的典型模型。其中最基础的是 **自回归 (Autoregressive, AR)** 模型。

一个[一阶自回归过程](@entry_id:746502)，记为 **AR(1)**，其定义如下：
$$X_t = c + \phi X_{t-1} + \varepsilon_t$$
其中，$X_t$ 是过程在时间 $t$ 的值，$c$ 是一个常数，$\phi$ 是自[回归系数](@entry_id:634860)，$\varepsilon_t$ 是一个**[白噪声](@entry_id:145248) (white noise)** 过程，即一列均值为0、[方差](@entry_id:200758)为 $\sigma^2$ 且序列不相关的[随机变量](@entry_id:195330)。

AR(1) 过程是否平稳，完全取决于自[回归系数](@entry_id:634860) $\phi$ 的值。该过程是弱平稳的当且仅当 $|\phi|  1$。为什么这个条件如此关键？我们可以通过考察过程的[方差](@entry_id:200758)来理解其背后的机制 。假设过程从 $X_0 = 0$ 开始，通过反复代入，我们可以将 $X_t$ 表示为过去所有冲击的加权和：
$$X_t = (1+\phi+\dots+\phi^{t-1})c + \sum_{k=0}^{t-1} \phi^k \varepsilon_{t-k}$$
为了简化，我们设 $c=0$。由于 $\varepsilon_t$ 是序列不相关的，过程的[方差](@entry_id:200758)为：
$$\operatorname{Var}(X_t) = \operatorname{Var}\left(\sum_{k=0}^{t-1} \phi^k \varepsilon_{t-k}\right) = \sum_{k=0}^{t-1} (\phi^k)^2 \operatorname{Var}(\varepsilon_{t-k}) = \sigma^2 \sum_{k=0}^{t-1} (\phi^2)^k$$
这是一个几何级数求和。
-   如果 $|\phi|  1$，那么当 $t \to \infty$ 时，这个和收敛到一个有限的常数：$\operatorname{Var}(X_t) \to \frac{\sigma^2}{1-\phi^2}$。[方差](@entry_id:200758)是恒定的，满足弱[平稳性条件](@entry_id:191085)。
-   如果 $|\phi| > 1$，级数 $\sum (\phi^2)^k$ 会随着 $t$ 的增加而指数级爆炸。[方差](@entry_id:200758)是时变的且会发散到无穷大，这违背了[平稳性](@entry_id:143776)。
-   如果 $|\phi| = 1$，那么 $\sum_{k=0}^{t-1} 1 = t$。[方差](@entry_id:200758)为 $\operatorname{Var}(X_t) = t\sigma^2$。此时，[方差](@entry_id:200758)随时间线性增长，过程同样是非平稳的。

这个 $|\phi| = 1$ 的临界情况引出了另一个基本模型：**[随机游走](@entry_id:142620) (Random Walk)**。一个简单的[随机游走过程](@entry_id:171699)定义为：
$$Y_t = Y_{t-1} + \varepsilon_t$$
通过与 AR(1) 模型的形式进行比较，我们立刻可以发现，[随机游走过程](@entry_id:171699)其实就是一个 AR(1) 过程的特例，其中常数项 $c=0$ 且自[回归系数](@entry_id:634860) $\phi=1$ 。因为 $\phi=1$ 不满足[平稳性条件](@entry_id:191085) $|\phi|1$，所以[随机游走](@entry_id:142620)是**非平稳的**。系数为1的 AR 模型在文献中通常被称为具有一个**[单位根](@entry_id:143302) (unit root)**。[单位根](@entry_id:143302)过程的一个标志性特征是，过去的冲击会永久性地影响过程的未来水平，而不会像[平稳过程](@entry_id:196130)中那样衰减。

这些抽象的模型可以在经济学中找到具体的应用。例如，我们可以构建一个模型来描述公司在不同市场结构下的市场份额动态 。在一个进入壁垒高、仅有两家公司竞争的**双寡头市场**中，竞争压力可能会使一家的市场份额向某个[长期均衡](@entry_id:139043)水平**均值回归 (mean-reverting)**。这种行为可以用一个平稳的 AR(1) 过程来描述，其中 $|\phi|1$。然而，在一个进入壁垒低、新公司可以自由进入的市场中，一家公司的市场份额可能会像[随机游走](@entry_id:142620)一样无目的地漂移，因为不断有新的、不可预测的竞争冲击出现。这种情况就对应于一个[单位根](@entry_id:143302)过程。因此，平稳性与[非平稳性](@entry_id:180513)不仅仅是数学上的分类，它们还反映了系统深层的经济机制。

### [非平稳性](@entry_id:180513)的危害：[伪回归](@entry_id:139052)

如果未能正确识别和处理[非平稳性](@entry_id:180513)，我们将面临严重的建模风险。其中最著名的问题是**[伪回归](@entry_id:139052) (Spurious Regression)**。当我们将一个[非平稳时间序列](@entry_id:165500)对另一个独立的[非平稳时间序列](@entry_id:165500)进行回归时，即使两者之间没有任何真实的因果关系，也常常会得到看似非常显著的统计结果。

为了揭示这一现象，我们可以进行一个[蒙特卡洛](@entry_id:144354)实验 。考虑两个完全独立的[随机游走过程](@entry_id:171699) $x_t$ 和 $y_t$，它们分别由独立的白噪声冲击生成。由于它们是[相互独立](@entry_id:273670)的，我们知道 $x_t$ 对 $y_t$ 的真实[回归系数](@entry_id:634860)为零。然而，如果我们运行一个标准的普通最小二乘 (OLS) 回归：
$$y_t = \beta_0 + \beta_1 x_t + u_t$$
我们会观察到一些惊人的结果。在大量的模拟中，我们发现：
1.  **虚高的显著性**: 用于检验“$\beta_1=0$”这一真实原假设的 $t$ 统计量，其[绝对值](@entry_id:147688)往往非常大，导致我们以极高的频率错误地拒绝[原假设](@entry_id:265441)。例如，在[显著性水平](@entry_id:170793)设为 $0.05$ 时，我们期望有 $5\%$ 的概率犯[第一类错误](@entry_id:163360)（即错误地拒绝真实的[原假设](@entry_id:265441)）。但在[伪回归](@entry_id:139052)中，这个拒绝率可能高达 $70\%-80\%$ 或更高，并且随着样本量的增加，问题会变得更加严重。
2.  **虚高的[拟合优度](@entry_id:637026)**: 回归的[判定系数](@entry_id:168150) $R^2$ 通常会很高，给人一种模型拟合得很好的假象。

[伪回归](@entry_id:139052)问题的根源在于，两个独立的[随机游走](@entry_id:142620)序列由于其内在的随机趋势，可能在样本内偶然地表现出相似的运动轨迹。标准的 OLS 理论假设回归的残差项 $u_t$ 是平稳的，但在这种情况下，残差项本身也是一个[非平稳过程](@entry_id:269756)，这使得所有经典的统计推断（如 $t$ 检验和 $F$ 检验）都失效了。

幸运的是，解决[伪回归](@entry_id:139052)问题的方法非常直接：对序列进行**差分 (differencing)**。对于一个[随机游走过程](@entry_id:171699) $Y_t = Y_{t-1} + \varepsilon_t$，其[一阶差分](@entry_id:275675) $\Delta Y_t = Y_t - Y_{t-1} = \varepsilon_t$ 是一个平稳的[白噪声过程](@entry_id:146877)。因此，如果我们对原始的回归方程中的变量进行[一阶差分](@entry_id:275675)，转而估计：
$$\Delta y_t = \beta_0 + \beta_1 \Delta x_t + v_t$$
由于 $\Delta y_t$ 和 $\Delta x_t$ 都是平稳的，这个回归是有效的。在我们的模拟实验中，对差分后的序列进行回归，原假设的拒绝率会恢复到名义的[显著性水平](@entry_id:170793)（例如 $5\%$），而 $R^2$ 会骤降至接近于零，这正确地反映了两个序列之间没有真实关系的事实。

### [非平稳性](@entry_id:180513)的正式检测：[单位根检验](@entry_id:142963)

鉴于[非平稳性](@entry_id:180513)带来的严重后果，我们需要一种正式的方法来检测它。在实践中，最常用的工具是**[单位根检验](@entry_id:142963) (unit root test)**，例如 **[增广迪基-福勒检验](@entry_id:141151) (Augmented Dickey-Fuller, ADF)**。

与大多数统计检验不同，[单位根检验](@entry_id:142963)的原假设 ($H_0$) 是“序列存在一个单位根”，即序列是**非平稳的**。其备择假设 ($H_1$) 是“序列是平稳的”。这意味着，只有当我们有足够强的证据拒绝原假设时，我们才能得出序列是平稳的结论。

在应用中，我们通常会关注检验输出的 p-value。假设一位经济学家正在分析通货膨胀率序列，并进行了一个 ADF 检验，[显著性水平](@entry_id:170793)设为 $\alpha=0.05$ 。如果检验结果的 p-value 非常大，例如 $0.91$，这意味着什么？由于 p-value  $\alpha$，我们**无法拒绝[原假设](@entry_id:265441)**。这并不意味着检验是“不确定的”，而是表明数据与存在[单位根](@entry_id:143302)的[原假设](@entry_id:265441)是一致的。因此，最稳妥的做法是接受[原假设](@entry_id:265441)的结论，将该序列**视为非平稳的**。

根据标准的 **Box-Jenkins 建模方法**，如果在原始序列中发现了单位根，下一步就是对其进行差分（通常是[一阶差分](@entry_id:275675)），然后对差分后的序列再次进行[单位根检验](@entry_id:142963)。如果差分后的序列被检验为平稳，那么我们就称原始序列是**一阶单整 (integrated of order 1)**，记为 $I(1)$。这个过程（检验-差分-再检验）是构建 **ARIMA (自回归单整移动平均)** 模型的关键第一步。

### [非平稳性](@entry_id:180513)分析中的高级主题与陷阱

虽然单位根和差分的概念构成了基础，但在实际应用中，我们会遇到更复杂的情形。

#### 季节性与差分

许多经济时间序列，如零售销售额或能源消耗，表现出强烈的**季节性 (seasonality)**。这种季节性有时也可能是非平稳的，表现为**季节性[单位根](@entry_id:143302) (seasonal unit root)**。例如，一个季度数据的过程如果遵循 $X_t = X_{t-4} + \varepsilon_t$，那么它就包含一个周期为4的季节性[单位根](@entry_id:143302)。此时，简单的[一阶差分](@entry_id:275675) $\Delta X_t$ 无法消除这种[非平稳性](@entry_id:180513)。正确的处理方法是进行**季节性差分**，即计算 $X_t - X_{t-s}$，其中 $s$ 是季节周期 (例如，对于季度数据 $s=4$)。在差分算子 $L$（满足 $L X_t = X_{t-1}$）的表示下，这对应于应用算子 $(1-L^s)$。有时，一个序列可能同时包含一个普通单位根和一个季节性单位根，这时就需要同时进行两种差分，即应用 $(1-L)(1-L^s)$，才能使其平稳 。

#### [方差](@entry_id:200758)的[非平稳性](@entry_id:180513)：GARCH 和 IGARCH

[非平稳性](@entry_id:180513)不仅可以体现在序列的均值（趋势）上，也可以体现在其[方差](@entry_id:200758)上。金融资产的收益率序列通常表现出**[条件异方差](@entry_id:141394)性 (conditional heteroskedasticity)**，即波动的聚集现象：大波动的时期之后往往是更大的波动，而[小波](@entry_id:636492)动的时期之后则是更小的波动。**GARCH (广义[自回归条件异方差](@entry_id:137546))** 模型是描述这种现象的标准工具。一个 GARCH(1,1) 模型将今天的[条件方差](@entry_id:183803) $\sigma_t^2$ 建模为常数、昨天的冲击平方 $\varepsilon_{t-1}^2$ 和昨天的[条件方差](@entry_id:183803) $\sigma_{t-1}^2$ 的函数：
$$\sigma_t^2 = \omega + \alpha \varepsilon_{t-1}^2 + \beta \sigma_{t-1}^2$$
当参数 $\alpha + \beta  1$ 时，GARCH 过程的无[条件方差](@entry_id:183803)是有限且恒定的，可以认为是平稳的。但当 $\alpha + \beta = 1$ 时，冲击对[条件方差](@entry_id:183803)的影响是永久性的，这种情况被称为 **IGARCH (整合型GARCH)**，代表了[方差](@entry_id:200758)过程中的[非平稳性](@entry_id:180513)。

一个自然的疑问是：我们能否通过对收益率的残差平方项 $\hat{\varepsilon}_t^2$ 进行标准的[单位根检验](@entry_id:142963)来检测 IGARCH？答案是否定的 。虽然在 IGARCH 模型下，$\varepsilon_t^2$ 序列确实遵循一个具有单位根的 ARMA(1,1) 过程，但 ADF 这类标准[单位根检验](@entry_id:142963)的一个关键假设是其回归方程中的误差项是同[方差](@entry_id:200758)的。然而，在 GARCH 框架下，这个误差项本身的[方差](@entry_id:200758)是时变的（即异[方差](@entry_id:200758)的），这使得标准[单位根检验](@entry_id:142963)的临界值变得无效。检测 ARCH/GARCH 效应的正确方法是使用 **ARCH-LM 检验**，而检测 IGARCH 的标准方法是先估计 GARCH 模型，然后对参数施加约束 $\alpha + \beta = 1$ 进行检验（例如使用 Wald 检验）。

#### 结构性断点与[单位根](@entry_id:143302)

在现实世界的数据中，一个序列的均值或趋势可能会因为政策改变、技术革新或金融危机等事件而发生突然的、持久性的变化，这被称为**结构性断点 (structural break)**。一个原本平稳的序列，如果在其均值上发生了一次断点，其外观会非常像一个非平稳的[单位根](@entry_id:143302)过程。标准的[单位根检验](@entry_id:142963)（如 ADF）很难区分这两种情况，并且倾向于将带有结构性断点的[平稳序列](@entry_id:144560)错误地判断为单位根过程。

为了解决这个问题，研究者们开发了对结构性断点稳健的[平稳性](@entry_id:143776)检验。例如，KPSS 检验的原假设是序列是平稳的。一个对其的改进是，在检验之前，先从数据中滤除一个估计出的均值断点 。其基本逻辑是：首先，在所有可能的断点位置上进行搜索，找到那个能使分段常数均值模型拟合得最好的断点 $\hat{\tau}$。然后，从原始序列中减去这个估计的分段均值，得到残差序列。最后，对这个残差序列应用 KPSS 检验。如果检验结果不拒绝[平稳性](@entry_id:143776)，我们就得出结论：原始序列是围绕一个发生断点的均值平稳的。这种方法强调了在得出非平稳结论之前，考虑结构性断点作为替代解释的重要性。我们甚至可以从一个不同的视角来理解这一点：在一个**递归图 (recurrence plot)** 中，平稳的混沌序列会产生均匀复杂的图案，而一个非平稳的[随机游走过程](@entry_id:171699)则会导致点集中在主对角线附近 ；一个结构性断点则会表现为图像密度的突然变化，形成独特的视觉特征。

#### 确定性混沌与单位根

最后，一个更深刻的陷阱是区分随机的[非平稳性](@entry_id:180513)与**确定性混沌 (deterministic chaos)**。像逻辑斯蒂映射 $x_{t+1} = r x_t (1-x_t)$ （当参数 $r$ 足够大时，如 $r=4$）这样的简单[非线性方程](@entry_id:145852)可以生成看似随机的序列。然而，这些序列是完全确定性的，并且是**平稳的**（它们的值被限制在一个有限的区间内）。

尽管如此，由于混沌序列可以表现出很强的短期相关性，其行为在小样本中可能与[随机游走](@entry_id:142620)非常相似。因此，当对一个混沌序列应用[单位根检验](@entry_id:142963)时，结果可能具有误导性 。在一个小样本中（例如 $T=64$），ADF 检验很可能无法拒绝[单位根](@entry_id:143302)的[原假设](@entry_id:265441)，从而错误地将一个平稳的确定性过程归类为非平稳的[随机过程](@entry_id:159502)。只有在样本量足够大时（例如 $T=2000$），检验的[统计功效](@entry_id:197129)才足以正确地识别出其平稳性。这个例子是一个强有力的警示：统计检验是强大的工具，但它们并非万无一失，其结果的解释必须结合对数据生成系统背后物理或经济机制的理解。对一个由混沌序列累加（积分）而成的序列进行检验，会正确地识别其为[非平稳过程](@entry_id:269756)，这进一步凸显了积分操作在产生[非平稳性](@entry_id:180513)中的核心作用。