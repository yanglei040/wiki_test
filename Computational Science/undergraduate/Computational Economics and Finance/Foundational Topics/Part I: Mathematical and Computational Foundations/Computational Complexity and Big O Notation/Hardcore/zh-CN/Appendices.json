{
    "hands_on_practices": [
        {
            "introduction": "这个练习旨在让你直接、具体地理解算法复杂度如何影响性能要求。通过研究一个具有立方复杂度的常见金融任务，我们可以量化处理更大问题规模所需的硬件提升，从而将 $O(N^3)$ 这样的抽象符号转化为一个具体的倍数。",
            "id": "2380750",
            "problem": "一位投资组合经理通过对 $N \\times N$ 协方差矩阵求逆来构建一个包含 $N$ 个资产的均值-方差最优投资组合，该求逆过程使用一个直接线性代数程序，其最坏情况下的运行时间复杂度为 $O(N^{3})$。假设运行时间模型中的比例常数不依赖于 $N$，并且您可以改变的唯一硬件特性是中央处理器（CPU）的速度，该速度以每秒浮点运算次数（FLOPS）来衡量。\n\n如果资产数量从 $N$ 翻倍到 $2N$，并且您要求完成投资组合构建的挂钟时间保持不变，那么CPU速度必须增加的最小乘数因子是多少？\n\n答案规格：\n- 以单一实数形式提供您的答案，表示速度必须增加的因子（无单位）。\n- 无需四舍五入；提供精确值。",
            "solution": "首先对问题陈述进行验证。\n\n第1步：提取已知条件\n- 在 $N$ 个资产上构建一个投资组合。\n- 构建过程涉及对一个 $N \\times N$ 的协方差矩阵求逆。\n- 矩阵求逆程序的最坏情况运行时间复杂度为 $O(N^3)$。\n- 运行时间模型中的比例常数不依赖于 $N$。\n- 唯一可以改变的硬件特性是CPU速度，以FLOPS为单位。\n- 资产数量从 $N$ 翻倍到 $2N$。\n- 完成构建的挂钟时间必须保持不变。\n- 目标是找到CPU速度必须增加的最小乘数因子。\n\n第2步：使用提取的已知条件进行验证\n根据验证标准对问题进行评估。\n- **科学依据**：该问题基于计算复杂度和线性代数，这两者是计算金融学的基础。使用 $O(N^3)$ 的复杂度进行矩阵求逆对应于高斯消元法等标准算法。这是一个用于分析算法性能的有效且典型的模型。\n- **适定性**：该问题是适定的。它提供了问题规模（$N$）、计算复杂度（$O(N^3)$）和执行时间之间的清晰关系，并要求一个具体可计算的因子。存在唯一解。\n- **客观性**：问题以精确、定量和客观的术语陈述。\n\n该问题没有表现出任何指定的缺陷。它在科学上是合理的、可形式化的、完整的且结构良好。\n\n第3步：结论与行动\n该问题有效。将推导解决方案。\n\n执行计算所需的挂钟时间 $T$ 是浮点运算总数 $C$ 除以处理器速度 $S$（以每秒浮点运算次数FLOPS为单位）。该关系由下式给出：\n$$T = \\frac{C}{S}$$\n\n问题指出，运行时间与操作数成正比，其复杂度为 $O(N^3)$，其中 $N$ 是资产数量。我们可以将操作数 $C$ 表示为 $N$ 的函数：\n$$C(N) = k N^3$$\n其中 $k$ 是一个比例常数，如题所述，它不依赖于 $N$。\n\n让我们定义两种情况。\n情况1：初始情况。\n- 资产数量：$N_1 = N$\n- 操作数：$C_1 = C(N_1) = k N_1^3 = k N^3$\n- CPU速度：$S_1$\n这种情况下的挂钟时间为：\n$$T_1 = \\frac{C_1}{S_1} = \\frac{k N^3}{S_1}$$\n\n情况2：资产数量增加的情况。\n- 资产数量：$N_2 = 2N$\n- 操作数：$C_2 = C(N_2) = k (2N)^3 = k (8 N^3) = 8 k N^3$\n- CPU速度：$S_2$\n这种情况下的挂钟时间为：\n$$T_2 = \\frac{C_2}{S_2} = \\frac{8 k N^3}{S_2}$$\n\n问题要求两种情况下的挂钟时间保持不变，即 $T_1 = T_2$。\n$$\\frac{k N^3}{S_1} = \\frac{8 k N^3}{S_2}$$\n\n我们被要求找到CPU速度必须增加的乘数因子，即比率 $\\frac{S_2}{S_1}$。为了找到这个比率，我们可以重新整理方程。假设 $k > 0$ 和 $N > 0$，我们可以将方程两边同时除以非零量 $k N^3$：\n$$\\frac{1}{S_1} = \\frac{8}{S_2}$$\n\n现在，我们求解比率 $\\frac{S_2}{S_1}$：\n$$S_2 = 8 S_1$$\n$$\\frac{S_2}{S_1} = 8$$\n\n因此，CPU速度必须增加8倍的乘数因子。",
            "answer": "$$\\boxed{8}$$"
        },
        {
            "introduction": "现实世界中的金融模型很少是单一、独立的算法，它们通常是由多个部分组成的顺序流程。这个问题将演示如何通过组合其各个部分的复杂度来分析这样一个系统的总体复杂度，这是识别计算瓶颈的一项关键技能。",
            "id": "2380831",
            "problem": "一家银行经营 $D$ 个业务部门，每个部门持有一本包含 $N$ 个头寸的账簿。为了进行监管报告，该银行会为每个部门计算部门风险指标，然后将这些部门指标汇总成一个全公司范围的数值。假设以下成本模型基于基本算法操作：\n\n- 对于一个给定的部门，本地风险计算会扫描所有无序的头寸对以评估相互作用，然后执行常数次额外的线性时间遍历以进行缩放和归一化。因此，单个部门的最坏情况操作计数可以用 $a N^{2} + b N + c$ 作为上界，其中 $a$、$b$ 和 $c$ 为正常数，所以其复杂度为 $O(N^{2})$。\n\n- 在所有 $D$ 个部门的指标计算完毕后，企业聚合器通过读取每个部门的数值一次，应用一个常数时间的转换，然后求和，从而用固定的权重对它们进行线性组合。聚合成本的上界为 $k D$，其中 $k$ 是一个正常数，因此其复杂度为 $O(D)$。\n\n假设各部门在单个计算线程上顺序处理，部门之间没有记忆化或复用，且 $N \\ge 1$，$D \\ge 1$。仅使用渐进上界（大O符号）的基本定义和顺序组合会增加成本的原则，推导出生成全公司风险数值的总体时间复杂度，表示为关于 $N$ 和 $D$ 的单一简化的 $O(\\cdot)$ 表达式。你的最终答案必须是一个单一的封闭形式 $O(\\cdot)$ 表达式。不需要四舍五入，也不需要报告单位。",
            "solution": "首先将对问题陈述进行严格的验证过程。\n\n**第1步：提取已知条件**\n- 业务部门数量：$D$\n- 每个部门的头寸数量：$N$\n- 单个部门风险计算的最坏情况操作计数的上界为 $a N^{2} + b N + c$。\n- 常数 $a$、$b$ 和 $c$ 均为正。\n- 单个部门的复杂度为 $O(N^{2})$。\n- 企业聚合的成本上界为 $k D$。\n- 常数 $k$ 为正。\n- 聚合的复杂度为 $O(D)$。\n- 处理模型：在单个线程上顺序执行。\n- 部门间的计算没有记忆化或复用。\n- 约束条件：$N \\ge 1$ 且 $D \\ge 1$。\n- 目标：推导总体时间复杂度，表示为关于 $N$ 和 $D$ 的单一简化的 $O(\\cdot)$ 表达式。\n\n**第2步：使用提取的已知条件进行验证**\n根据所需标准对问题进行评估。\n\n- **科学依据**：该问题是计算复杂性理论（大O表示法）在一个简化但合理的金融风险计算模型中的应用。用于成对交互和线性遍历的成本模型 $a N^{2} + b N + c$ 在算法分析中是标准的。它完全符合计算机科学的原理。\n- **适定性**：该问题是适定的。它提供了所有必要的组成部分：子问题的成本函数、它们的组合方法（顺序相加）以及变量的约束。可以推导出一个唯一的、有意义的解。\n- **客观性**：该问题以精确、客观和量化的术语陈述。“无序对”、“线性时间遍历”和“在单个计算线程上顺序”等术语是明确的。\n\n**第3步：结论与行动**\n该问题是**有效的**。这是一个直接、定义明确的算法分析练习。我现在将着手解决。\n\n设 $T_{dept}(N)$ 表示计算单个拥有 $N$ 个头寸的部门的风险指标所需的时间。根据问题陈述，其上界为一个关于 $N$ 的多项式，使得：\n$$T_{dept}(N) \\le a N^{2} + b N + c$$\n其中 $a > 0$、$b > 0$ 和 $c > 0$ 是常数。这对应于单个部门的时间复杂度为 $O(N^{2})$。\n\n银行有 $D$ 个这样的部门，它们是顺序处理的。顺序组合原则指出，一系列操作的总时间是每个单独操作时间的总和。由于部门之间没有计算复用，处理所有 $D$ 个部门所需的总时间（我们称之为 $T_{all\\_depts}(N, D)$）是 $D$ 个相同计算成本的总和。\n$$T_{all\\_depts}(N, D) = \\sum_{i=1}^{D} T_{dept}(N) = D \\cdot T_{dept}(N)$$\n因此，此计算阶段的上界是：\n$$D \\cdot (a N^{2} + b N + c)$$\n\n在部门计算之后，执行一个企业聚合步骤。设此聚合的时间为 $T_{agg}(D)$。问题陈述其上界为 $D$ 的一个线性函数：\n$$T_{agg}(D) \\le k D$$\n其中 $k > 0$ 是一个常数。这对应于时间复杂度为 $O(D)$。\n\n整个过程包括所有部门的计算，然后是最终的聚合。再次应用顺序组合原则，全公司风险计算的总时间 $T_{total}(N, D)$ 是这两个阶段时间的总和。总时间的上界是：\n$$T_{total}(N, D) \\le T_{all\\_depts}(N, D) + T_{agg}(D)$$\n$$T_{total}(N, D) \\le D(a N^{2} + b N + c) + k D$$\n展开此表达式可得：\n$$T_{total}(N, D) \\le a D N^{2} + b D N + c D + k D$$\n$$T_{total}(N, D) \\le a D N^{2} + b D N + (c+k)D$$\n\n为了确定总的渐进时间复杂度，我们必须在这个关于 $N$ 和 $D$ 的多项式表达式中，为大的 $N$ 和 $D$ 值确定主导项。这些项是 $a D N^{2}$、$b D N$ 和 $(c+k)D$。根据大O符号的定义，我们需要找到常数 $C > 0$、$N_{0} \\ge 1$ 和 $D_{0} \\ge 1$，使得对于所有 $N \\ge N_{0}$ 和 $D \\ge D_{0}$，以下不等式成立：\n$$a D N^{2} + b D N + (c+k)D \\le C \\cdot g(N, D)$$\n其中 $g(N,D)$ 是表征增长率的最简函数。\n\n让我们选择 $g(N, D) = D N^{2}$。我们必须证明 $a D N^{2} + b D N + (c+k)D \\in O(D N^{2})$。\n给定问题约束，$N \\ge 1$ 和 $D \\ge 1$。\n对于 $N \\ge 1$，我们有 $N \\le N^{2}$，因此 $b D N \\le b D N^{2}$。\n类似地，对于 $N \\ge 1$，我们有 $1 \\le N^{2}$，这意味着 $D \\le D N^{2}$，所以 $(c+k)D \\le (c+k)D N^{2}$。\n\n将这些不等式代回总时间表达式中：\n$$a D N^{2} + b D N + (c+k)D \\le a D N^{2} + b D N^{2} + (c+k)D N^{2}$$\n$$a D N^{2} + b D N + (c+k)D \\le (a + b + c + k) D N^{2}$$\n令 $C = a + b + c + k$。由于 $a, b, c, k$ 都是正常数，所以 $C$ 也是一个正常数。该不等式对所有 $N \\ge 1$ 和 $D \\ge 1$ 均成立。\n因此，根据大O表示法的正式定义，总时间复杂度的上界为 $C \\cdot D N^{2}$。\n\n总体时间复杂度为 $O(D N^{2})$。",
            "answer": "$$\\boxed{O(D N^{2})}$$"
        },
        {
            "introduction": "计算效率不仅关乎执行时间（时间复杂度），也关乎内存使用（空间复杂度）。最后一个练习将探讨计算金融学中的一个经典权衡：对于一个大型协方差矩阵，何时使用专门的稀疏存储格式比使用简单的密集格式更节省内存？通过计算这个平衡点，你将学会如何基于数据来做出关于数据结构的选择。",
            "id": "2380822",
            "problem": "考虑一个包含 $N = 5000$ 支股票的总体中的样本协方差矩阵。该矩阵是对称实数矩阵。有两种存储方案可供选择，每种方案都利用对称性，只存储包括对角线在内的上三角部分。\n\n密集存储：\n- 将每个上三角项（包括对角线）存储为 $64$ 位浮点数，每个存储的数字使用 $8$ 字节。\n\n稀疏存储：\n- 对上三角部分（包括对角线）使用压缩稀疏行（CSR）格式。对于每个存储的非零元，使用 $8$ 字节存储其值，并使用一个 $4$ 字节的 $32$ 位整数存储其列索引。此外，还需存储一个长度为 $N+1$ 的行指针数组，其中每个条目是一个 $4$ 字节的 $32$ 位整数。\n\n设 $k$ 表示完整的 $N \\times N$ 协方差矩阵中每行的平均非零元数量，其中每项资产的对角线方差计为一个非零元，并假设矩阵对称，因此非对角线上的非零元是镜像的。假设两种表示方法都只存储上三角项（包括对角线），并且 $32$ 位索引足够使用。\n\n将 $k^{\\ast}$ 定义为稀疏表示所需的总字节数等于密集表示所需的总字节数时的 $k$ 值。确定当 $N=5000$ 时的 $k^{\\ast}$。将您的答案四舍五入到四位有效数字。以纯数字形式表示您的答案，不带单位。",
            "solution": "在尝试进行任何解答之前，需要对所述问题进行验证。\n\n步骤 1：提取已知条件。\n- 资产（股票）数量为 $N = 5000$。\n- 协方差矩阵是对称实数矩阵，大小为 $N \\times N$。\n- 存储方案利用对称性，只存储包括对角线在内的上三角部分。\n- 密集存储：每个条目是一个 $64$ 位浮点数，需要 $8$ 字节。\n- 稀疏存储（压缩稀疏行，CSR）：\n  - 对于每个存储的非零条目：其值需要 $8$ 字节，其列索引需要一个 $32$ 位整数（$4$ 字节）。\n  - 另外还存储一个长度为 $N+1$ 的行指针数组，其中每个条目是一个 $32$ 位整数（$4$ 字节）。\n- $k$ 被定义为完整的 $N \\times N$ 矩阵中每行的平均非零条目数。\n- 对角线方差计为非零。\n- $k^{\\ast}$ 是稀疏方案的总存储成本（以字节为单位）等于密集方案的总存储成本时的特定 $k$ 值。\n- 任务是确定当 $N=5000$ 时 $k^{\\ast}$ 的值，并四舍五入到四位有效数字。\n\n步骤 2：使用提取的已知条件进行验证。\n该问题具有科学依据，涉及矩阵存储的标准方法（密集与稀疏格式如CSR），这些方法是计算线性代数及其应用（包括计算金融）的基础。该问题是适定的，提供了足够的信息来构建一个可解的代数方程。语言客观而精确。所有术语对于该领域的专业人士都有充分的定义。所提供的值对于大规模金融应用是现实的。$32$ 位索引足够使用的条件与 $N=5000$ 一致，因为 $5000  2^{31}-1$。问题陈述没有违反任何基本原则，不基于错误的前提，不是比喻性的，是自洽的，并且是科学可验证的。\n\n步骤 3：结论和行动。\n该问题被认为是有效的。现在将推导一个正式的解法。\n\n首先，我们确定密集存储表示所需的总存储字节数，记为 $B_{\\text{dense}}$。一个 $N \\times N$ 矩阵的上三角部分（包括主对角线）的元素数量由总和 $1 + 2 + \\dots + N = \\frac{N(N+1)}{2}$ 给出。这些元素中的每一个都存储为 $8$ 字节的浮点数。因此，总存储成本为：\n$$B_{\\text{dense}} = 8 \\times \\frac{N(N+1)}{2} = 4N(N+1)$$\n\n接下来，我们确定稀疏 CSR 表示所需的总存储字节数 $B_{\\text{sparse}}$。这个成本取决于所存储的非零元素的数量，我们必须从参数 $k$ 推导出这个数量。参数 $k$ 表示完整的对称 $N \\times N$ 矩阵中每行的平均非零元数量。因此，完整矩阵中的非零元总数为 $NNZ_{\\text{full}} = Nk$。\n这些非零元包括 $N$ 个对角线元素（假设为非零）和 $Nk - N$ 个非对角线元素。由于矩阵是对称的，非对角线上的非零元成对存在。稀疏存储方案只考虑上三角部分（包括对角线）。这个上三角部分中的非零元数量 $NNZ_{\\text{upper}}$ 是 $N$ 个对角线元素与一半非对角线元素之和。\n$$NNZ_{\\text{upper}} = N + \\frac{Nk - N}{2} = \\frac{2N + Nk - N}{2} = \\frac{N(k+1)}{2}$$\n对于这些 $NNZ_{\\text{upper}}$ 个条目中的每一个，我们存储其值（$8$ 字节）和其列索引（$4$ 字节），每个条目共计 $8+4=12$ 字节。这些条目的存储量为 $12 \\times NNZ_{\\text{upper}}$。\n此外，CSR 格式需要一个长度为 $N+1$ 的行指针数组，其中每个条目是一个 $4$ 字节的整数。该数组的存储量为 $4(N+1)$ 字节。\n稀疏方案的总存储量是这两个部分的总和：\n$$B_{\\text{sparse}} = 12 \\times NNZ_{\\text{upper}} + 4(N+1) = 12 \\left(\\frac{N(k+1)}{2}\\right) + 4(N+1) = 6N(k+1) + 4(N+1)$$\n\n问题将 $k^{\\ast}$ 定义为存储成本相等时的 $k$ 值：$B_{\\text{dense}} = B_{\\text{sparse}}$。我们使用 $k^{\\ast}$ 建立方程：\n$$4N(N+1) = 6N(k^{\\ast}+1) + 4(N+1)$$\n现在我们必须解这个方程求出 $k^{\\ast}$。\n$$4N(N+1) = 6Nk^{\\ast} + 6N + 4N + 4$$\n$$4N(N+1) = 6Nk^{\\ast} + 10N + 4$$\n重新整理以分离出含有 $k^{\\ast}$ 的项：\n$$6Nk^{\\ast} = 4N(N+1) - (10N + 4) = 4N^2 + 4N - 10N - 4$$\n$$6Nk^{\\ast} = 4N^2 - 6N - 4$$\n除以 $6N$ 来求解 $k^{\\ast}$：\n$$k^{\\ast} = \\frac{4N^2 - 6N - 4}{6N} = \\frac{4N^2}{6N} - \\frac{6N}{6N} - \\frac{4}{6N}$$\n$$k^{\\ast} = \\frac{2}{3}N - 1 - \\frac{2}{3N}$$\n现在，我们代入给定值 $N=5000$：\n$$k^{\\ast} = \\frac{2}{3}(5000) - 1 - \\frac{2}{3(5000)} = \\frac{10000}{3} - 1 - \\frac{2}{15000}$$\n计算各项：\n$$\\frac{10000}{3} \\approx 3333.3333...$$\n$$\\frac{2}{15000} \\approx 0.000133...$$\n将这些值代回 $k^{\\ast}$ 的表达式中：\n$$k^{\\ast} \\approx 3333.333333 - 1 - 0.000133 = 3332.3332$$\n问题要求答案四舍五入到四位有效数字。值 $3332.3332$ 的前四位有效数字是 $3$、$3$、$3$ 和 $2$。第五位有效数字是 $3$。由于 $3  5$，我们向下取整（截断）。\n$k^{\\ast}$ 的结果值为 $3332$。",
            "answer": "$$\\boxed{3332}$$"
        }
    ]
}