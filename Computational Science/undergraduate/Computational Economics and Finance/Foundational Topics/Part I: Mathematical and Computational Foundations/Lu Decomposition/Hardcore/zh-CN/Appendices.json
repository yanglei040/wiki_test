{
    "hands_on_practices": [
        {
            "introduction": "理论是实践的基础。要掌握LU分解在计算经济学和金融领域的应用，我们首先需要理解其核心计算过程。这个练习将引导你手动完成一个$3 \\times 3$矩阵的LU分解，让你亲手体验如何将一个矩阵系统地分解为下三角矩阵$L$和上三角矩阵$U$。通过这个基础练习，你将为理解更复杂的数值方法和应用打下坚实的基础。",
            "id": "2186375",
            "problem": "在数值线性代数中，将一个矩阵分解为一个下三角矩阵和一个上三角矩阵的乘积是一项基本运算。这种分解被称为LU分解，并用于各种算法中，例如求解线性方程组。\n\n考虑矩阵 $A$ 如下：\n$$\nA = \\begin{pmatrix} 3  -1  2 \\\\ 6  1  9 \\\\ -9  5  -5 \\end{pmatrix}\n$$\n该矩阵可以唯一分解为乘积 $A = LU$，其中 $L$ 是一个单位下三角矩阵（即主对角线上的元素都为1），$U$ 是一个上三角矩阵。这两个 $3 \\times 3$ 矩阵的一般形式为：\n$$\nL = \\begin{pmatrix} 1  0  0 \\\\ l_{21}  1  0 \\\\ l_{31}  l_{32}  1 \\end{pmatrix}, \\quad U = \\begin{pmatrix} u_{11}  u_{12}  u_{13} \\\\ 0  u_{22}  u_{23} \\\\ 0  0  u_{33} \\end{pmatrix}\n$$\n确定给定矩阵 $A$ 的矩阵 $L$ 的非对角线元素和矩阵 $U$ 的所有元素的数值。将您的最终答案表示为一个单行矩阵，其中包含这九个值，顺序为 $(l_{21}, l_{31}, l_{32}, u_{11}, u_{12}, u_{13}, u_{22}, u_{23}, u_{33})$。将所有分数值表示为其最简形式。",
            "solution": "我们使用 Doolittle LU分解法，其中 $L$ 是单位下三角矩阵，$U$ 是上三角矩阵，满足 $A=LU$。其中\n$$\nL=\\begin{pmatrix}1  0  0\\\\ l_{21}  1  0\\\\ l_{31}  l_{32}  1\\end{pmatrix},\\quad\nU=\\begin{pmatrix}u_{11}  u_{12}  u_{13}\\\\ 0  u_{22}  u_{23}\\\\ 0  0  u_{33}\\end{pmatrix},\n$$\n乘积 $LU$ 逐行计算如下：\n- 第1行：$[u_{11},u_{12},u_{13}]=[3,-1,2]$，因此 $u_{11}=3$，$u_{12}=-1$，$u_{13}=2$。\n- 第2行，第1列：$l_{21}u_{11}=a_{21}=6$，所以 $l_{21}=\\frac{a_{21}}{u_{11}}=\\frac{6}{3}=2$。\n- 第3行，第1列：$l_{31}u_{11}=a_{31}=-9$，所以 $l_{31}=\\frac{a_{31}}{u_{11}}=\\frac{-9}{3}=-3$。\n- 第2行，第2列：$l_{21}u_{12}+u_{22}=a_{22}=1$，所以 $u_{22}=a_{22}-l_{21}u_{12}=1-2(-1)=3$。\n- 第2行，第3列：$l_{21}u_{13}+u_{23}=a_{23}=9$，所以 $u_{23}=a_{23}-l_{21}u_{13}=9-2\\cdot 2=5$。\n- 第3行，第2列：$l_{31}u_{12}+l_{32}u_{22}=a_{32}=5$，所以 $l_{32}=\\frac{a_{32}-l_{31}u_{12}}{u_{22}}=\\frac{5-(-3)(-1)}{3}=\\frac{5-3}{3}=\\frac{2}{3}$。\n- 第3行，第3列：$l_{31}u_{13}+l_{32}u_{23}+u_{33}=a_{33}=-5$，所以\n$$\nu_{33}=a_{33}-l_{31}u_{13}-l_{32}u_{23}=-5-(-3\\cdot 2)-\\left(\\frac{2}{3}\\cdot 5\\right)=-5+6-\\frac{10}{3}=1-\\frac{10}{3}=-\\frac{7}{3}.\n$$\n\n因此，按照要求的顺序 $(l_{21}, l_{31}, l_{32}, u_{11}, u_{12}, u_{13}, u_{22}, u_{23}, u_{33})$，这些值为\n$$\n\\begin{pmatrix}\n2  -3  \\frac{2}{3}  3  -1  2  3  5  -\\frac{7}{3}\n\\end{pmatrix}.\n$$",
            "answer": "$$\\boxed{\\begin{pmatrix}2  -3  \\frac{2}{3}  3  -1  2  3  5  -\\frac{7}{3}\\end{pmatrix}}$$"
        },
        {
            "introduction": "掌握了LU分解的计算方法后，下一步是将其应用于核心任务：求解线性方程组。这个练习展示了LU分解的威力，它将一个复杂的求解问题$A\\mathbf{x} = \\mathbf{b}$转化为两个简单的三角系统问题：$L\\mathbf{y} = \\mathbf{b}$和$U\\mathbf{x} = \\mathbf{y}$。通过解决这个实际问题，你将体会到为何LU分解是数值线性代数中一个如此高效和基础的工具。",
            "id": "12944",
            "problem": "一个线性方程组可以表示为矩阵形式 $A\\mathbf{x} = \\mathbf{b}$。求解此类方程组的一个有效方法是LU分解，即将矩阵 $A$ 分解为一个下三角矩阵 $L$ 和一个上三角矩阵 $U$ 的乘积，使得 $A = LU$。\n\n原始方程组 $A\\mathbf{x} = \\mathbf{b}$ 于是可以改写为 $LU\\mathbf{x} = \\mathbf{b}$。该方程可以通过以下两个步骤求解：\n1.  定义一个中间向量 $\\mathbf{y} = U\\mathbf{x}$。\n2.  首先，使用正向代入法求解方程组 $L\\mathbf{y} = \\mathbf{b}$ 得到 $\\mathbf{y}$。\n3.  然后，使用反向代入法求解方程组 $U\\mathbf{x} = \\mathbf{y}$ 得到 $\\mathbf{x}$。\n\n考虑以下线性方程组：\n$$\n\\begin{align*}\n2x_1 + x_2 + x_3 = 5 \\\\\n4x_1 - 6x_2 = -2 \\\\\n-2x_1 + 7x_2 + 2x_3 = 9\n\\end{align*}\n$$\n该方程组可以写作 $A\\mathbf{x} = \\mathbf{b}$，其中：\n$$\nA = \\begin{pmatrix} 2  1  1 \\\\ 4  -6  0 \\\\ -2  7  2 \\end{pmatrix}, \\quad \\mathbf{x} = \\begin{pmatrix} x_1 \\\\ x_2 \\\\ x_3 \\end{pmatrix}, \\quad \\mathbf{b} = \\begin{pmatrix} 5 \\\\ -2 \\\\ 9 \\end{pmatrix}\n$$\n首先，求矩阵 $A$ 的LU分解，其中 $L$ 是一个对角线上元素为1的下三角矩阵（Doolittle分解），$U$ 是一个上三角矩阵。然后，利用此分解求解向量 $\\mathbf{x}$。\n\n你的任务是推导表达式 $x_1 + 2x_2 + 3x_3$ 的值。",
            "solution": "我们寻求满足 $A=LU$ 的 $L,U$，其中\n$$L=\\begin{pmatrix}1  0  0\\\\l_{21}  1  0\\\\l_{31}  l_{32}  1\\end{pmatrix},\\quad\nU=\\begin{pmatrix}u_{11}  u_{12}  u_{13}\\\\0  u_{22}  u_{23}\\\\0  0  u_{33}\\end{pmatrix}。$$\n\n匹配 $A=\\begin{pmatrix}2  1  1\\\\4  -6  0\\\\-2  7  2\\end{pmatrix}$：\n\n1. $U$ 的第一行：\n$$u_{11}=2,\\quad u_{12}=1,\\quad u_{13}=1.$$\n\n2. $L$ 的第一列：\n$$l_{21}=\\frac{a_{21}}{u_{11}}=\\frac{4}{2}=2,\\quad\nl_{31}=\\frac{a_{31}}{u_{11}}=\\frac{-2}{2}=-1.$$\n\n3. 第二行/列：\n$$u_{22}=a_{22}-l_{21}u_{12}=-6-2\\cdot1=-8,\\quad\nu_{23}=a_{23}-l_{21}u_{13}=0-2\\cdot1=-2.$$\n$$l_{32}=\\frac{a_{32}-l_{31}u_{12}}{u_{22}}=\\frac{7-(-1)\\cdot1}{-8}=\\frac{8}{-8}=-1.$$\n\n4. 最后一个对角线元素：\n$$u_{33}=a_{33}-l_{31}u_{13}-l_{32}u_{23}\n=2-(-1)\\cdot1-(-1)\\cdot(-2)=2+1-2=1.$$\n\n因此\n$$L=\\begin{pmatrix}1  0  0\\\\2  1  0\\\\-1  -1  1\\end{pmatrix},\\quad\nU=\\begin{pmatrix}2  1  1\\\\0  -8  -2\\\\0  0  1\\end{pmatrix}。$$\n\n接下来通过正向代入法求解 $L\\mathbf y=\\mathbf b$，其中 $\\mathbf b=(5,-2,9)^T$：\n$$y_1=5,\\quad\ny_2=-2-2\\,y_1=-2-10=-12,\\quad\ny_3=9-(-1)\\,y_1-(-1)\\,y_2=9+5-12=2.$$\n\n然后通过反向代入法求解 $U\\mathbf x=\\mathbf y$：\n$$x_3=2,\\quad\n-8x_2-2x_3=-12\\implies-8x_2-4=-12\\implies x_2=1,$$\n$$2x_1+x_2+x_3=5\\implies2x_1+1+2=5\\implies x_1=1.$$\n\n最后，\n$$x_1+2x_2+3x_3=1+2\\cdot1+3\\cdot2=9.$$",
            "answer": "$$\\boxed{9}$$"
        },
        {
            "introduction": "从手动计算到计算机编程是应用数值方法的关键一步。这个综合性练习要求你使用标准的数值计算库来解决一系列线性系统，这些系统模拟了经济学中的均衡模型。你将不仅要实现求解过程，还要面对实际计算中常见的挑战，例如处理可能导致数值不稳定的“病态”矩阵()。这个练习旨在锻炼你将理论知识转化为可靠代码的实践能力。",
            "id": "2407888",
            "problem": "考虑由静态竞争均衡条件产生的线性系统，其线性化形式表示为矩阵方程 $A x = b$，其中 $A \\in \\mathbb{R}^{n \\times n}$ 是非奇异矩阵，$b \\in \\mathbb{R}^{n}$ 是给定的净需求冲击向量。对于每个系统，假设存在一个置换矩阵 $P \\in \\mathbb{R}^{n \\times n}$、一个单位下三角矩阵 $L \\in \\mathbb{R}^{n \\times n}$ 和一个上三角矩阵 $U \\in \\mathbb{R}^{n \\times n}$，使得 $P A = L U$。您的任务是针对以下每个测试用例，计算满足 $A x = b$ 的唯一解 $x \\in \\mathbb{R}^{n}$。\n\n测试套件：\n1. 情况 $1$ (一般可逆系统, $n = 3$):\n   $$A_1 = \\begin{bmatrix}\n   4  1  -1\\\\\n   2  5  1\\\\\n   1  -1  3\n   \\end{bmatrix}, \\quad\n   b_1 = \\begin{bmatrix}\n   10\\\\\n   10\\\\\n   10\n   \\end{bmatrix}.$$\n\n2. 情况 $2$ (病态但非奇异系统, $n = 3$):\n   $$A_2 = \\begin{bmatrix}\n   10^{-4}  1  1\\\\\n   1  1  1\\\\\n   1  1  1.0001\n   \\end{bmatrix}, \\quad\n   b_2 = \\begin{bmatrix}\n   1\\\\\n   2\\\\\n   3\n   \\end{bmatrix}.$$\n\n3. 情况 $3$ (更大型的稀疏对角占优系统, $n = 5$):\n   $$A_3 = \\begin{bmatrix}\n   10  2  0  0  1\\\\\n   3  9  1  0  0\\\\\n   0  1  7  2  0\\\\\n   0  0  3  4  1\\\\\n   1  0  0  2  8\n   \\end{bmatrix}, \\quad\n   b_3 = \\begin{bmatrix}\n   7\\\\\n   8\\\\\n   9\\\\\n   10\\\\\n   11\n   \\end{bmatrix}.$$\n\n对于每种情况 $k \\in \\{1,2,3\\}$，计算满足 $A_k x_k = b_k$ 的向量 $x_k \\in \\mathbb{R}^{n_k}$。您的程序必须对每个 $A_k$ 使用由标准数值库提供的 $P_k A_k = L_k U_k$ 形式的分解，并通过求解该分解所隐含的相关三角线性系统来获得 $x_k$。\n\n最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的、以逗号分隔的结果列表。每个结果必须是一个内部列表，表示四舍五入到恰好 $6$ 位小数的 $x_k$ 的各项，输出中不含任何空格。例如，如果有两个解为 $\\begin{bmatrix} 1 \\\\ 2 \\end{bmatrix}$ 和 $\\begin{bmatrix} 3 \\\\ 4 \\end{bmatrix}$ 的情况，则要求的输出为 \"[[1.000000,2.000000],[3.000000,4.000000]]\"。",
            "solution": "问题陈述已解析和验证。\n\n已知条件：\n问题是求解三个不同情况下的线性系统 $A x = b$。\n指定的方法是使用 $P A = L U$ 分解，其中 $P$ 是一个置换矩阵，$L$ 是一个单位下三角矩阵，$U$ 是一个上三角矩阵。\n\n情况 $1$：$n=3$。\n$$A_1 = \\begin{bmatrix}\n4  1  -1\\\\\n2  5  1\\\\\n1  -1  3\n\\end{bmatrix}, \\quad\nb_1 = \\begin{bmatrix}\n10\\\\\n10\\\\\n10\n\\end{bmatrix}.$$\n\n情况 $2$：$n=3$。\n$$A_2 = \\begin{bmatrix}\n10^{-4}  1  1\\\\\n1  1  1\\\\\n1  1  1.0001\n\\end{bmatrix}, \\quad\nb_2 = \\begin{bmatrix}\n1\\\\\n2\\\\\n3\n\\end{bmatrix}.$$\n\n情况 $3$：$n=5$。\n$$A_3 = \\begin{bmatrix}\n10  2  0  0  1\\\\\n3  9  1  0  0\\\\\n0  1  7  2  0\\\\\n0  0  3  4  1\\\\\n1  0  0  2  8\n\\end{bmatrix}, \\quad\nb_3 = \\begin{bmatrix}\n7\\\\\n8\\\\\n9\\\\\n10\\\\\n11\n\\end{bmatrix}.$$\n\n验证：\n该问题具有科学依据、适定、客观且自洽。它描述了数值线性代数中的一个标准任务，在计算经济学和金融学中有直接应用。给定的矩阵都是非奇异的，确保每种情况都存在唯一解。$A_1$ 的行列式为 $66$，$A_2$ 的行列式约为 $-10^{-4}$，$A_3$ 是一个不可约对角占优矩阵，这保证了它是非奇异的。情况 $2$ 被指出是病态的，这是测试数值算法鲁棒性的一个有效且重要的场景。该问题不违反任何科学原理，其结构保证了唯一的、有意义的解。\n\n结论：\n问题被认为是有效的。将提供一个解决方案。\n\n求解原理：\n任务是对于给定的非奇异矩阵 $A \\in \\mathbb{R}^{n \\times n}$ 和向量 $b \\in \\mathbb{R}^{n}$，找到满足线性矩阵方程 $A x = b$ 的向量 $x \\in \\mathbb{R}^{n}$。指定的方法是带部分主元法的 LU 分解。这种分解的形式为 $P A = L U$，其中 $P$ 是一个编码行交换的置换矩阵，$L$ 是一个单位下三角矩阵，$U$ 是一个上三角矩阵。\n\n步骤如下：\n$1$。从系统 $A x = b$ 开始。\n$2$。用置换矩阵 $P$ 左乘，得到 $P A x = P b$。\n$3$。将分解式 $P A = L U$ 代入方程：$L U x = P b$。\n$4$。此方程通过一个两阶段过程求解。首先，定义一个中间向量 $y = U x$。系统变为 $L y = P b$。\n$5$。求解 $y$。由于 $L$ 是一个下三角矩阵，该系统可以使用前向代入法高效求解。$y$ 的元素按顺序计算：\n$$y_i = ( (P b)_i - \\sum_{j=1}^{i-1} L_{ij} y_j ) / L_{ii}$$\n由于 $L$ 是单位下三角矩阵，因此对所有 $i$ 都有 $L_{ii} = 1$。\n\n$6$。一旦确定了 $y$，就求解系统 $U x = y$ 以获得最终解向量 $x$。由于 $U$ 是一个上三角矩阵，这可以通过后向代入法高效求解。$x$ 的元素以相反的顺序计算：\n$$x_i = ( y_i - \\sum_{j=i+1}^{n} U_{ij} x_j ) / U_{ii}$$\n\n使用部分主元法（$P$ 矩阵）对于数值稳定性至关重要。它确保在执行高斯消去法以找到因子 $L$ 和 $U$ 时，主元（对角元素 $U_{kk}$）是其所在列（对角线下方）中最大的元素。这减轻了舍入误差的放大，这对于病态系统（如情况 $2$ 中所示）尤为关键。\n\n对于情况 $2$，矩阵 $A_2$ 是严重病态的。标准的双精度浮点运算（例如 `float64`）可能不足以精确地求解，即使使用了主元法。可能会发生灾难性抵消，导致计算出的解具有较大的残差。严谨的方法需要更高精度的算术来获得正确的结果。这展示了数值分析的一个基本原理：算法稳定性、机器精度和问题条件之间的相互作用。\n\n对于情况 $3$，矩阵 $A_3$ 是对角占优的。这类矩阵天然是良态的，LU 分解对它们来说是一种非常稳定且高效的方法。\n\n该实现将使用一个标准的数值库，该库提供用于带主元法的 LU 分解和求解所得三角系统的鲁棒函数。这直接对应于所描述的理论过程。对于病态情况，将以编程方式采用更高的算术精度来确保结果的正确性。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy import linalg\n\ndef solve_system(A, b):\n    \"\"\"\n    Solves the linear system Ax = b using LU decomposition with partial pivoting.\n    \n    This function explicitly uses the method described in the problem:\n    1. Factor PA = LU using a library function.\n    2. Solve Ly = Pb and Ux = y using a library function that takes the LU factors.\n    \n    For ill-conditioned matrices, higher precision arithmetic is necessary to\n    obtain a correct result.\n    \"\"\"\n    try:\n        # First attempt with standard double precision (float64)\n        lu, piv = linalg.lu_factor(A.astype(np.float64))\n        x = linalg.lu_solve((lu, piv), b.astype(np.float64))\n        # Verify the residual for ill-conditioned case. If it's large, redo with higher precision.\n        if np.linalg.norm(A @ x - b) > 1e-4:\n             raise np.linalg.LinAlgError(\"High residual, retrying with long double.\")\n    except (np.linalg.LinAlgError, FloatingPointError):\n        # Fallback to higher precision (longdouble) if standard precision fails\n        # or produces a result with a large error, which is characteristic of\n        # ill-conditioned systems like Case 2.\n        A_high_prec = A.astype(np.longdouble)\n        b_high_prec = b.astype(np.longdouble)\n        lu, piv = linalg.lu_factor(A_high_prec)\n        x = linalg.lu_solve((lu, piv), b_high_prec)\n        \n    return x\n\ndef solve():\n    \"\"\"\n    Defines and solves the test cases provided in the problem statement.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        (\n            np.array([\n                [4, 1, -1],\n                [2, 5, 1],\n                [1, -1, 3]\n            ]),\n            np.array([10, 10, 10])\n        ),\n        (\n            np.array([\n                [1e-4, 1, 1],\n                [1, 1, 1],\n                [1, 1, 1.0001]\n            ]),\n            np.array([1, 2, 3])\n        ),\n        (\n            np.array([\n                [10, 2, 0, 0, 1],\n                [3, 9, 1, 0, 0],\n                [0, 1, 7, 2, 0],\n                [0, 0, 3, 4, 1],\n                [1, 0, 0, 2, 8]\n            ]),\n            np.array([7, 8, 9, 10, 11])\n        ),\n    ]\n\n    # Store results for final printing.\n    formatted_results = []\n    \n    for A, b in test_cases:\n        # Calculate the solution vector x for the current case.\n        solution_vector = solve_system(A, b)\n        \n        # Format the solution vector to exactly 6 decimal places.\n        formatted_vector = [f\"{val:.6f}\" for val in solution_vector]\n        \n        # Enclose the formatted vector in brackets as a string.\n        formatted_results.append(f\"[{','.join(formatted_vector)}]\")\n\n    # Final print statement in the exact required format.\n    # e.g., [[1.0,2.0],[3.0,4.0]]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n\n```"
        }
    ]
}