{
    "hands_on_practices": [
        {
            "introduction": "The path integral formalism represents a single quantum particle as a classical \"ring polymer,\" where each bead corresponds to a point on an imaginary-time path. This first exercise provides a quantitative foundation for this powerful analogy. By calculating key structural properties of the ring polymer for a simple free particle, such as its radius of gyration ($R_g^2$), you will gain a tangible understanding of quantum delocalization and explore its dependence on mass, temperature, and the number of beads $P$.",
            "id": "2459892",
            "problem": "A single quantum particle of mass $m$ in $d$ spatial dimensions at absolute temperature $T$ can be represented by a $P$-bead ring polymer arising from the imaginary-time (Path Integral) discretization of the quantum canonical partition function. For a free particle, the bead positions $\\{\\mathbf{x}_i\\}_{i=1}^P$, with periodic indexing $\\mathbf{x}_{P+1} \\equiv \\mathbf{x}_1$, are distributed according to the Gaussian density proportional to\n$$\n\\exp\\!\\left(-\\sum_{i=1}^{P} \\frac{m P}{2 \\beta \\hbar^2}\\,\\lVert \\mathbf{x}_i - \\mathbf{x}_{i+1} \\rVert^2\\right),\n$$\nwhere $\\beta = 1/(k_B T)$ is the inverse thermal energy, $k_B$ is the Boltzmann constant, and $\\hbar$ is the reduced Planck constant. Define the centroid $\\mathbf{x}_c = \\frac{1}{P} \\sum_{i=1}^{P} \\mathbf{x}_i$ and the squared radius of gyration\n$$\nR_g^2(d;m,T,P) = \\frac{1}{P}\\sum_{i=1}^{P} \\left\\langle \\lVert \\mathbf{x}_i - \\mathbf{x}_c \\rVert^2 \\right\\rangle,\n$$\nwhere $\\langle \\cdot \\rangle$ denotes the expectation with respect to the above Gaussian density. Also define the mean-squared nearest-neighbor bond length\n$$\nb^2(d;m,T,P) = \\left\\langle \\lVert \\mathbf{x}_i - \\mathbf{x}_{i+1} \\rVert^2 \\right\\rangle,\n$$\nwhich is independent of $i$ by symmetry. Finally, define the dimensionless scaled size per spatial dimension\n$$\ns(d;m,T,P) = \\frac{m k_B T}{\\hbar^2}\\,\\frac{R_g^2(d;m,T,P)}{d}.\n$$\nYour task is to write a program that, for each parameter set in the test suite below, computes and returns the triple $[R_g^2, b^2, s]$.\n\nUse the following physical constants (in SI units) exactly as given:\n- $k_B = 1.380649\\times 10^{-23}\\ \\mathrm{J/K}$,\n- $\\hbar = 1.054571817\\times 10^{-34}\\ \\mathrm{J\\cdot s}$.\n\nAll inputs use SI units: $m$ in kilograms ($\\mathrm{kg}$), $T$ in kelvin ($\\mathrm{K}$). You must express $R_g^2$ and $b^2$ in square meters ($\\mathrm{m}^2$) and $s$ as a pure number (dimensionless). Do not perform any rounding beyond standard floating-point representation.\n\nTest Suite (each test case is a tuple $(d,m,T,P)$):\n- Case 1 (typical): $(d,m,T,P) = (\\,1,\\ 1.67262192369\\times 10^{-27},\\ 300.0,\\ 4\\,)$.\n- Case 2 (lower temperature, more beads): $(d,m,T,P) = (\\,1,\\ 1.67262192369\\times 10^{-27},\\ 10.0,\\ 32\\,)$.\n- Case 3 (three dimensions, heavier particle): $(d,m,T,P) = (\\,3,\\ 3.3435837724\\times 10^{-27},\\ 50.0,\\ 64\\,)$.\n- Case 4 (very low temperature, much heavier particle): $(d,m,T,P) = (\\,3,\\ 2.6566962\\times 10^{-26},\\ 1.0,\\ 128\\,)$.\n- Case 5 (boundary, single bead): $(d,m,T,P) = (\\,1,\\ 1.67262192369\\times 10^{-27},\\ 5.0,\\ 1\\,)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets. For each test case, output the list $[R_g^2,b^2,s]$ in the same order as the test suite. For example, your output must look like\n\"[ [R_g^2_case1,b^2_case1,s_case1], [R_g^2_case2,b^2_case2,s_case2], ... ]\"\nwith numerical values in place of the symbols.\n\nNotes on evaluation focus:\n- Your results must be computed from first principles implied by the given Gaussian distribution, not by lookup.\n- The outputs are uniquely determined real numbers.\n- The test suite includes a \"happy path\" (moderate $T$, small $P$), low-temperature and larger-$P$ scenarios, a three-dimensional case, a very low temperature with heavy mass, and a boundary case $P=1$.",
            "solution": "The problem as stated is scientifically grounded, well-posed, and objective. It is based on fundamental principles of statistical mechanics and the path integral formulation of quantum mechanics. All terms are defined unambiguously, and the necessary physical constants and parameters are provided. The problem is therefore deemed valid and a formal solution can be derived from first principles.\n\nThe task is to compute the squared radius of gyration $R_g^2$, the mean-squared bond length $b^2$, and a dimensionless size parameter $s$ for a free quantum particle described by a $P$-bead ring polymer. The derivation proceeds in three main steps.\n\nFirst, we exploit the separability of the problem. The Gaussian probability density is a product of identical distributions for each of the $d$ spatial dimensions. Let $\\mathbf{x}_i = (x_{i,1}, \\dots, x_{i,d})$ be the coordinate vector of the $i$-th bead. The exponent in the distribution is a sum over the spatial dimensions $k$:\n$$\n\\sum_{i=1}^{P} \\frac{m P}{2 \\beta \\hbar^2}\\,\\lVert \\mathbf{x}_i - \\mathbf{x}_{i+1} \\rVert^2 = \\sum_{k=1}^{d} \\left( \\sum_{i=1}^{P} \\frac{m P}{2 \\beta \\hbar^2}\\,(x_{i,k} - x_{i+1,k})^2 \\right)\n$$\nThis implies that expectation values of quantities that are sums over spatial dimensions, such as squared norms, can be calculated by solving a one-dimensional problem and multiplying the result by $d$. By symmetry, the expectation value for each Cartesian component is identical.\nFor the squared radius of gyration and mean-squared bond length, we have:\n$$\nR_g^2(d;m,T,P) = \\sum_{k=1}^{d} \\frac{1}{P}\\sum_{i=1}^{P} \\left\\langle (x_{i,k} - x_{c,k})^2 \\right\\rangle = d \\cdot R_{g,1D}^2\n$$\n$$\nb^2(d;m,T,P) = \\sum_{k=1}^{d} \\left\\langle (x_{i,k} - x_{i+1,k})^2 \\right\\rangle = d \\cdot b_{1D}^2\n$$\nwhere $R_{g,1D}^2$ and $b_{1D}^2$ are the corresponding quantities for a one-dimensional system ($d=1$). The dimensionless parameter $s$ is defined with a factor of $1/d$, so it will be independent of the dimensionality. Our primary task is thus reduced to solving the $1D$ problem.\n\nSecond, we analyze the $1D$ problem by transforming to normal modes. The probability distribution for the $1D$ bead positions $\\{x_i\\}_{i=1}^P$ is\n$$\np(x_1, \\dots, x_P) \\propto \\exp\\left(-\\frac{\\alpha}{2} \\sum_{i=1}^{P} (x_i - x_{i+1})^2\\right)\n$$\nwhere $\\alpha = \\frac{mP}{\\beta\\hbar^2}$ and $\\beta = 1/(k_B T)$. The quadratic form in the exponent can be diagonalized by a discrete Fourier transform. We define the normal mode coordinates $q_k$ as:\n$$\nq_k = \\frac{1}{\\sqrt{P}} \\sum_{j=1}^P x_j e^{-i 2\\pi k(j-1)/P}, \\quad k=0, 1, \\dots, P-1\n$$\nIn terms of these modes, the sum becomes:\n$$\n\\sum_{j=1}^P (x_j - x_{j+1})^2 = \\sum_{k=0}^{P-1} \\lambda_k |q_k|^2\n$$\nwhere $\\lambda_k = 4\\sin^2(\\pi k/P)$ are the eigenvalues of the ring connectivity matrix.\nThe mode $q_0 = \\frac{1}{\\sqrt{P}}\\sum_j x_j = \\sqrt{P} x_c$ corresponds to the centroid motion. Its eigenvalue is $\\lambda_0=0$, so the probability distribution is independent of $q_0$. This reflects the translational invariance of the free particle system, which leads to a non-normalizable distribution over the full coordinate space. However, the quantities $R_g^2$ and $b^2$ are translationally invariant. We can compute their expectation values by fixing the centroid, for example at $x_c=0$, which is equivalent to setting $q_0=0$.\nFor the other modes ($k=1, \\dots, P-1$), the distribution is a product of independent Gaussians. The average squared amplitude for each mode in $1D$ is found to be:\n$$\n\\left\\langle |q_k|^2 \\right\\rangle = \\frac{1}{\\alpha \\lambda_k} \\quad \\text{for } k=1, \\dots, P-1\n$$\n\nThird, we compute the desired quantities. With the centroid fixed at $x_c=0$, the squared radius of gyration in $1D$ is $R_{g,1D}^2 = \\frac{1}{P} \\sum_j \\langle x_j^2 \\rangle$. By symmetry, $\\langle x_j^2 \\rangle$ is the same for all $j$. We can calculate $\\langle x_1^2 \\rangle$ by expressing $x_1$ in terms of normal modes ($x_1 = \\frac{1}{\\sqrt{P}}\\sum_{k=0}^{P-1} q_k$) and using the orthogonality of the modes ($\\langle q_k q_l^* \\rangle = \\delta_{kl} \\langle |q_k|^2 \\rangle$):\n$$\nR_{g,1D}^2 = \\langle x_1^2 \\rangle = \\left\\langle \\left( \\frac{1}{\\sqrt{P}} \\sum_{k=1}^{P-1} q_k \\right) \\left( \\frac{1}{\\sqrt{P}} \\sum_{l=1}^{P-1} q_l^* \\right) \\right\\rangle = \\frac{1}{P} \\sum_{k=1}^{P-1} \\langle |q_k|^2 \\rangle\n$$\nSubstituting the expression for $\\langle |q_k|^2 \\rangle$:\n$$\nR_{g,1D}^2 = \\frac{1}{P} \\sum_{k=1}^{P-1} \\frac{1}{\\alpha \\lambda_k} = \\frac{1}{P \\alpha} \\sum_{k=1}^{P-1} \\frac{1}{4\\sin^2(\\pi k/P)}\n$$\nUsing the standard summation identity $\\sum_{k=1}^{N-1} \\csc^2(\\pi k/N) = \\frac{N^2-1}{3}$, we obtain:\n$$\nR_{g,1D}^2 = \\frac{1}{4P\\alpha} \\frac{P^2-1}{3} = \\frac{P^2-1}{12 P \\alpha} = \\frac{P^2-1}{12 P} \\frac{\\beta\\hbar^2}{mP} = \\frac{\\beta\\hbar^2}{m} \\frac{P^2-1}{12P^2}\n$$\nFor the mean-squared bond length in $1D$, we compute $b_{1D}^2 = \\langle(x_1-x_2)^2\\rangle$. Expressing the difference in normal modes:\n$$\nx_1 - x_2 = \\frac{1}{\\sqrt{P}} \\sum_{k=1}^{P-1} q_k (1 - e^{-i2\\pi k/P})\n$$\nThe expectation value is:\n$$\nb_{1D}^2 = \\frac{1}{P} \\sum_{k=1}^{P-1} \\langle |q_k|^2 \\rangle |1 - e^{-i2\\pi k/P}|^2 = \\frac{1}{P} \\sum_{k=1}^{P-1} \\frac{1}{\\alpha \\lambda_k} (2 - 2\\cos(2\\pi k/P))\n$$\nSince $2 - 2\\cos(2\\pi k/P) = \\lambda_k$, the terms cancel:\n$$\nb_{1D}^2 = \\frac{1}{P} \\sum_{k=1}^{P-1} \\frac{1}{\\alpha} = \\frac{P-1}{P\\alpha} = \\frac{P-1}{P} \\frac{\\beta\\hbar^2}{mP} = \\frac{\\beta\\hbar^2}{m} \\frac{P-1}{P^2}\n$$\nFinally, we can write the expressions for the $d$-dimensional case:\n$$\nR_g^2(d,m,T,P) = d \\frac{\\hbar^2}{m k_B T} \\frac{P^2-1}{12P^2}\n$$\n$$\nb^2(d,m,T,P) = d \\frac{\\hbar^2}{m k_B T} \\frac{P-1}{P^2}\n$$\nThe dimensionless size $s$ is then:\n$$\ns(d,m,T,P) = \\frac{m k_B T}{\\hbar^2}\\,\\frac{R_g^2}{d} = \\frac{m k_B T}{\\hbar^2d} \\left( d \\frac{\\hbar^2}{m k_B T} \\frac{P^2-1}{12P^2} \\right) = \\frac{P^2-1}{12P^2}\n$$\nThese formulae provide the exact analytical solution to the problem. The special case $P=1$ correctly yields $R_g^2=0$, $b^2=0$, and $s=0$, which corresponds to the classical limit of a point particle. The provided program will implement these final expressions.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes path integral properties for a free quantum particle.\n    \"\"\"\n    \n    # Physical constants in SI units, given in the problem statement.\n    KB = 1.380649e-23  # Boltzmann constant (J/K)\n    HBAR = 1.054571817e-34  # Reduced Planck constant (J*s)\n\n    # Test suite of parameters (d, m, T, P)\n    # d: spatial dimensions (dimensionless)\n    # m: mass (kg)\n    # T: temperature (K)\n    # P: number of path integral beads (dimensionless)\n    test_cases = [\n        # Case 1 (typical): (d, m, T, P)\n        (1, 1.67262192369e-27, 300.0, 4),\n        # Case 2 (lower temperature, more beads):\n        (1, 1.67262192369e-27, 10.0, 32),\n        # Case 3 (three dimensions, heavier particle):\n        (3, 3.3435837724e-27, 50.0, 64),\n        # Case 4 (very low temperature, much heavier particle):\n        (3, 2.6566962e-26, 1.0, 128),\n        # Case 5 (boundary, single bead):\n        (1, 1.67262192369e-27, 5.0, 1),\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        d, m, T, P = case\n        \n        # The case P=1 is a special limit handled correctly by the general formulas.\n        # If P is 1, P-1=0 and P^2-1=0, so Rg2 and b2 will be zero.\n        P = float(P) # Use floating point for calculations to avoid integer division issues.\n\n        # Common pre-factor for Rg2 and b2, with units of m^2\n        # C = hbar^2 / (m * k_B * T)\n        common_factor = (HBAR**2) / (m * KB * T)\n\n        # Squared radius of gyration (m^2)\n        # Rg^2 = d * C * (P^2 - 1) / (12 * P^2)\n        if P == 0: # Avoid division by zero, although not in test cases\n            rg2 = 0.0\n        else:\n            rg2 = d * common_factor * (P**2 - 1.0) / (12.0 * P**2)\n\n        # Mean-squared nearest-neighbor bond length (m^2)\n        # b^2 = d * C * (P - 1) / P^2\n        if P == 0:\n            b2 = 0.0\n        else:\n             b2 = d * common_factor * (P - 1.0) / P**2\n\n        # Dimensionless scaled size per spatial dimension\n        # s = (P^2 - 1) / (12 * P^2)\n        if P == 0:\n            s_val = 0.0\n        else:\n             s_val = (P**2 - 1.0) / (12.0 * P**2)\n            \n        results.append([rg2, b2, s_val])\n\n    # Format the output string exactly as required.\n    # e.g., \"[[r1_1,r1_2,r1_3],[r2_1,r2_2,r2_3]]\"\n    formatted_results = [f\"[{r[0]},{r[1]},{r[2]}]\" for r in results]\n    final_output_string = f\"[{','.join(formatted_results)}]\"\n    \n    print(final_output_string)\n\nsolve()\n```"
        },
        {
            "introduction": "Moving from a free particle to one influenced by an external potential, a critical practical question arises: how many beads ($P$) are sufficient to accurately capture the relevant quantum effects? This exercise tackles this central issue of numerical convergence in a chemically important model system, the double-well potential, which is a prototype for tunneling phenomena. You will implement a common convergence criterion based on the potential's curvature to determine the minimum $P$ required, revealing how simulation parameters are dictated by the underlying physics of the system.",
            "id": "2459887",
            "problem": "A single quantum nucleus of mass $m$ moves in one spatial dimension $x$ in a double-well potential described by the quartic form $V(x) = a \\left(x^{2} - b^{2}\\right)^{2} + c x$, where $a$, $b$, and $c$ are real parameters and $c$ controls the asymmetry of the wells. Consider the canonical partition function at temperature $T$ represented by the imaginary-time Feynman path integral discretized into $P$ time slices (also called beads) as used in Path Integral Molecular Dynamics (PIMD). Work in reduced units where the reduced Planck constant $\\hbar$, the Boltzmann constant $k_{\\mathrm{B}}$, and the mass $m$ are all equal to $1$ (that is, $\\hbar = 1$, $k_{\\mathrm{B}} = 1$, $m = 1$), so that the inverse temperature is $\\beta = 1/T$ and the imaginary-time slice is $\\Delta \\tau = \\beta / P$.\n\nDefine the following absolute curvature frequencies that control the resolution of tunneling-relevant fluctuations:\n- The barrier-top magnitude $|\\omega_{b}|$ obtained from the stationary point $x_{b}$ with negative curvature $V''(x_{b})  0$ via $|\\omega_{b}| = \\sqrt{\\left|V''(x_{b})\\right|/m}$.\n- The well frequencies $\\omega_{L}$ and $\\omega_{R}$ obtained from the two minima $x_{L}$ and $x_{R}$ with positive curvatures $V''(x_{L}) > 0$ and $V''(x_{R}) > 0$ via $\\omega_{L} = \\sqrt{V''(x_{L})/m}$ and $\\omega_{R} = \\sqrt{V''(x_{R})/m}$.\n\nThe curvature is $V''(x) = 12 a x^{2} - 4 a b^{2}$ for the given potential. The stationary points are the real solutions of $V'(x) = 4 a x \\left(x^{2} - b^{2}\\right) + c = 0$. For a double-well shape, there must be exactly three real stationary points: two minima and one maximum.\n\nAdopt the following convergence criterion for the imaginary-time discretization to resolve tunneling properties: the smallest positive integer $P$ is deemed sufficient if the inequality\n$$\n\\Delta \\tau \\, \\max\\!\\left(\\omega_{L}, \\, \\omega_{R}, \\, |\\omega_{b}|\\right) \\le \\varepsilon\n$$\nholds, where $\\varepsilon > 0$ is a prescribed dimensionless tolerance. In reduced units, this is equivalent to $P \\ge \\beta \\, \\max\\!\\left(\\omega_{L}, \\, \\omega_{R}, \\, |\\omega_{b}|\\right) / \\varepsilon$.\n\nYour task is to write a complete program that, for each parameter set in the test suite below, determines the minimal integer $P$ that satisfies the above inequality. All quantities are to be interpreted in the specified reduced units. The output for each test case must be a single integer. Your program must aggregate all test case results into a single line of output containing the results as a comma-separated list enclosed in square brackets, with no spaces.\n\nTest suite (each tuple is $(a, b, c, T, \\varepsilon)$ in reduced units):\n- Case $1$ (symmetric, low temperature): $(1.0, \\, 1.0, \\, 0.0, \\, 0.2, \\, 0.05)$\n- Case $2$ (asymmetric, small bias): $(1.0, \\, 1.0, \\, 0.5, \\, 0.2, \\, 0.05)$\n- Case $3$ (symmetric, high temperature): $(1.0, \\, 1.0, \\, 0.0, \\, 100.0, \\, 0.1)$\n- Case $4$ (asymmetric, near coalescence threshold): $(1.0, \\, 1.0, \\, 1.5, \\, 1.0, \\, 0.1)$\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $[P_{1},P_{2},P_{3},P_{4}]$.",
            "solution": "The problem statement has been rigorously validated and is determined to be scientifically sound, well-posed, and objective. It presents a clear task in the context of computational chemistry, specifically regarding the numerical parameters for path integral molecular dynamics (PIMD) simulations. All provided data and conditions are consistent and sufficient for deriving a unique, meaningful solution.\n\nThe problem requires the determination of the minimum number of path integral beads, $P$, for a quantum particle of mass $m=1$ in a one-dimensional potential $V(x) = a \\left(x^{2} - b^{2}\\right)^{2} + c x$. This is a canonical model for asymmetric double-well systems. The solution is based on a common heuristic convergence criterion used in PIMD, which relates the imaginary-time step $\\Delta \\tau = \\beta / P$ to the characteristic frequencies of the potential energy surface. Here, $\\beta = 1/(k_{\\mathrm{B}}T)$ is the inverse temperature, and we work in reduced units where $\\hbar=1$, $k_{\\mathrm{B}}=1$, and $m=1$.\n\nThe required number of beads $P$ must be the smallest positive integer that satisfies the inequality:\n$$\n\\Delta \\tau \\, \\max\\!\\left(\\omega_{L}, \\, \\omega_{R}, \\, |\\omega_{b}|\\right) \\le \\varepsilon\n$$\nwhere $\\varepsilon$ is a given tolerance, and $\\omega_{L}$, $\\omega_{R}$, and $|\\omega_{b}|$ are the harmonic frequencies associated with the potential's stationary points.\n\nThe procedural steps to calculate $P$ for each parameter set $(a, b, c, T, \\varepsilon)$ are as follows:\n\n1.  **Determine System Parameters**: The inverse temperature is calculated as $\\beta = 1/T$. The mass is given as $m=1$.\n\n2.  **Find Stationary Points**: The stationary points of the potential, which correspond to the locations of the two minima ($x_{L}$, $x_{R}$) and the intervening barrier maximum ($x_{b}$), are the real roots of the first derivative of the potential, $V'(x) = 0$.\n    $$\n    V'(x) = \\frac{d}{dx} \\left[ a \\left(x^{2} - b^{2}\\right)^{2} + c x \\right] = 4a x \\left(x^{2} - b^{2}\\right) + c = 0\n    $$\n    This simplifies to the cubic polynomial equation:\n    $$\n    4ax^3 - 4ab^2x + c = 0\n    $$\n    For a double-well potential to exist, this equation must have three distinct real roots. The condition for this is $64a^2b^6 > 27c^2$, which is satisfied by all provided test cases. These roots will be determined numerically.\n\n3.  **Calculate Curvatures**: The nature of each stationary point $x_s$ is determined by the sign of the second derivative of the potential (the curvature) at that point.\n    $$\n    V''(x) = \\frac{d^2}{dx^2} V(x) = 12ax^2 - 4ab^2\n    $$\n    -   Minima ($x_L, x_R$): $V''(x) > 0$.\n    -   Maximum ($x_b$): $V''(x)  0$.\n\n4.  **Compute Characteristic Frequencies**: The frequencies are derived from these curvatures. With mass $m=1$, the formulas simplify.\n    -   The well frequencies are $\\omega_{L} = \\sqrt{V''(x_L)}$ and $\\omega_{R} = \\sqrt{V''(x_R)}$.\n    -   The magnitude of the imaginary frequency at the barrier top is $|\\omega_b| = \\sqrt{|V''(x_b)|} = \\sqrt{-V''(x_b)}$.\n    These frequencies define the essential time scales of the quantum dynamics within the given potential.\n\n5.  **Determine the Minimum Number of Beads ($P$)**: The convergence criterion can be rearranged to give a lower bound for $P$:\n    $$\n    \\frac{\\beta}{P} \\max\\!\\left(\\omega_{L}, \\, \\omega_{R}, \\, |\\omega_{b}|\\right) \\le \\varepsilon \\implies P \\ge \\frac{\\beta}{\\varepsilon} \\max\\!\\left(\\omega_{L}, \\, \\omega_{R}, \\, |\\omega_{b}|\\right)\n    $$\n    Let $\\omega_{\\max} = \\max\\!\\left(\\omega_{L}, \\, \\omega_{R}, \\, |\\omega_{b}|\\right)$. The smallest positive integer $P$ that satisfies this condition is found using the ceiling function:\n    $$\n    P_{\\min} = \\left\\lceil \\frac{\\beta \\, \\omega_{\\max}}{\\varepsilon} \\right\\rceil\n    $$\n    This calculation is performed for each test case to yield the final results.\n\nThis systematic procedure combines analytical formulation with numerical root-finding to solve the problem as stated.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the minimum number of PIMD beads 'P' required to satisfy a\n    convergence criterion for a particle in a quartic double-well potential.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple is (a, b, c, T, epsilon) in reduced units.\n    test_cases = [\n        (1.0, 1.0, 0.0, 0.2, 0.05),    # Case 1 (symmetric, low temperature)\n        (1.0, 1.0, 0.5, 0.2, 0.05),    # Case 2 (asymmetric, small bias)\n        (1.0, 1.0, 0.0, 100.0, 0.1),   # Case 3 (symmetric, high temperature)\n        (1.0, 1.0, 1.5, 1.0, 0.1),     # Case 4 (asymmetric, near coalescence)\n    ]\n\n    results = []\n    for case in test_cases:\n        a, b, c, T, epsilon = case\n\n        # Step 1: Calculate inverse temperature beta (k_B = 1)\n        beta = 1.0 / T\n\n        # Step 2: Find stationary points by solving V'(x) = 0.\n        # V'(x) = 4*a*x^3 - 4*a*b^2*x + c\n        # Coefficients for the cubic polynomial: p[0]x^3 + p[1]x^2 + p[2]x + p[3]\n        coeffs = [4.0 * a, 0.0, -4.0 * a * b**2, c]\n        stationary_points = np.roots(coeffs)\n\n        # The problem setup ensures three real roots. We take the real part to handle\n        # potential floating point inaccuracies from the numerical solver.\n        real_stationary_points = stationary_points.real\n\n        # Step 3  4: Calculate curvatures and characteristic frequencies.\n        # V''(x) = 12*a*x^2 - 4*a*b^2. Mass m=1.\n        curvatures = 12.0 * a * real_stationary_points**2 - 4.0 * a * b**2\n        \n        frequencies = []\n        for curvature in curvatures:\n            # For minima, curvature > 0.\n            if curvature > 0:\n                frequencies.append(np.sqrt(curvature))\n            # For the barrier top, curvature  0.\n            else:\n                frequencies.append(np.sqrt(np.abs(curvature)))\n\n        # Find the maximum frequency among all stationary points.\n        omega_max = np.max(frequencies)\n\n        # Step 5: Determine the minimal integer P.\n        # P must be a positive integer.\n        P_min_float = (beta * omega_max) / epsilon\n        P_min = int(np.ceil(P_min_float))\n        \n        # In the edge case where the result is 0, the problem asks for the\n        # smallest *positive* integer, which would be 1. However, for the given\n        # test cases, all parameters are positive, guaranteeing P_min >= 1.\n        \n        results.append(P_min)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "This exercise illuminates the profound connection between the path integral representation and the fundamental tenets of quantum mechanics. For a particle on a ring, the collective configuration of the polymer beads can be described by a \"winding number,\" which counts how many times the path wraps around the ring. You will demonstrate that this seemingly classical, topological property is directly related to the quantization of angular momentum, providing a beautiful and concrete example of how PIMD configurations encode quantum reality.",
            "id": "2459882",
            "problem": "You are to write a complete, runnable program that, for a single quantum particle of mass $m$ constrained to move on a one-dimensional ring of radius $R$ (so the dynamical coordinate is an angle $\\theta$ with identification $\\theta \\equiv \\theta + 2\\pi$), analyzes how Path Integral Molecular Dynamics (PIMD) bead configurations encode the quantization of angular momentum at low temperatures. The moment of inertia is $I = m R^2$. The quantum Hamiltonian has energy eigenvalues $E_n = \\hbar^2 n^2 / (2 I)$ indexed by integer angular momentum quantum numbers $n \\in \\mathbb{Z}$. The canonical inverse temperature is $\\beta = 1/(k_B T)$, where $T$ is the absolute temperature. The PIMD representation of the partition function can be organized into topological sectors labeled by the integer winding number $w \\in \\mathbb{Z}$, which counts how many times the imaginary-time path wraps around the ring; the sector weights follow from the Euclidean action of a free rotor with boundary condition $\\theta(\\beta \\hbar) - \\theta(0) = 2\\pi w$. All angles must be treated in radians, all masses in kilograms, all radii in meters, all temperatures in kelvin, and all energies in joules.\n\nYour program must, for each specified test case (a tuple $(m,R,T)$), compute the following four quantities and return them as real numbers:\n- The normalized canonical probability $p_n(n=0)$ of the quantum angular momentum state $n=0$, obtained from the discrete Boltzmann distribution over all $n \\in \\mathbb{Z}$ based on the exact quantum energy spectrum $E_n$ at inverse temperature $\\beta$.\n- The normalized probability $p_w(w=0)$ of zero winding number, obtained from the topological-sector weights determined by the Euclidean action with $\\theta(\\beta \\hbar) - \\theta(0) = 2\\pi w$ at the same inverse temperature $\\beta$.\n- The ratio $\\mathcal{R} \\equiv Z_n / Z_w$ between the quantum partition function $Z_n = \\sum_{n \\in \\mathbb{Z}} \\exp[-\\beta E_n]$ and the path-integral sector-summed partition function $Z_w$ that uses the exact continuum prefactor implied by the free-rotor Euclidean action and sums over all winding sectors $w \\in \\mathbb{Z}$.\n- The expected absolute winding number $\\mathbb{E}[|w|]$ with respect to the normalized winding-number distribution.\n\nYour outputs must be expressed as dimensionless decimal numbers. Angles are in radians. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each test case contributes a sub-list in order, i.e., a single line of the form \"[[x_1,x_2,x_3,x_4],[x_1,x_2,x_3,x_4],...]\", with no additional text.\n\nPhysical constants to be used are Planckâ€™s reduced constant $\\hbar = 1.054571817\\times 10^{-34}\\ \\mathrm{J\\cdot s}$ and the Boltzmann constant $k_B = 1.380649\\times 10^{-23}\\ \\mathrm{J/K}$. Use these exact values.\n\nTest Suite (each tuple is $(m,R,T)$ with $m$ in kilograms, $R$ in meters, and $T$ in kelvin):\n- Case $1$: $m = 1.67262192369\\times 10^{-27}$, $R = 1.0\\times 10^{-10}$, $T = 300.0$.\n- Case $2$: $m = 1.67262192369\\times 10^{-27}$, $R = 1.0\\times 10^{-10}$, $T = 5.0$.\n- Case $3$: $m = 9.1093837015\\times 10^{-31}$, $R = 1.0\\times 10^{-10}$, $T = 5.0$.\n- Case $4$: $m = 1.67262192369\\times 10^{-27}$, $R = 5.0\\times 10^{-10}$, $T = 300.0$.\n\nFinal Output Format requirement:\n- Your program should produce a single line of output containing the list of results for the test suite in the exact format \"[[r_{1,1},r_{1,2},r_{1,3},r_{1,4}],[r_{2,1},r_{2,2},r_{2,3},r_{2,4}],[r_{3,1},r_{3,2},r_{3,3},r_{3,4}],[r_{4,1},r_{4,2},r_{4,3},r_{4,4}]]\", where each $r_{i,j}$ is a floating-point number.\n\nAll answers must be computed using the definitions above. No further inputs are provided at runtime. The final output is unitless decimal numbers as specified, in a single line.",
            "solution": "The problem as stated is subjected to validation and is found to be valid. It is scientifically sound, well-posed, objective, and contains all necessary information for a unique solution. The physical model of a quantum rotor and its analysis using both canonical quantum statistics and the path integral formalism are standard and correct exercises in theoretical and computational chemistry.\n\nThe calculation proceeds from first principles. We are given the particle mass $m$, ring radius $R$, and absolute temperature $T$. From these, we define two key physical quantities: the moment of inertia $I = mR^2$ and the inverse temperature $\\beta = 1/(k_B T)$, where $k_B$ is the Boltzmann constant.\n\nFirst, we analyze the system from the perspective of its quantum energy eigenstates. The Hamiltonian for a free rotor has energy eigenvalues $E_n = \\frac{\\hbar^2 n^2}{2I}$, where $n \\in \\mathbb{Z}$ is the angular momentum quantum number and $\\hbar$ is the reduced Planck constant. The canonical partition function, which I denote $Z_n$, is the sum over all states of their Boltzmann factors:\n$$\nZ_n = \\sum_{n=-\\infty}^{\\infty} e^{-\\beta E_n} = \\sum_{n=-\\infty}^{\\infty} \\exp\\left(-\\frac{\\beta \\hbar^2 n^2}{2I}\\right)\n$$\nThis sum can be rewritten by separating the $n=0$ term and exploiting symmetry for $n \\to -n$:\n$$\nZ_n = 1 + 2 \\sum_{n=1}^{\\infty} \\exp\\left(-\\frac{\\beta \\hbar^2 n^2}{2I}\\right)\n$$\nThe probability $p_n(n)$ of finding the system in the state with quantum number $n$ is given by its Boltzmann factor normalized by the partition function: $p_n(n) = e^{-\\beta E_n} / Z_n$. For the ground state $n=0$, we have $E_0=0$, and thus $e^{-\\beta E_0} = 1$. The required probability is therefore:\n$$\np_n(n=0) = \\frac{1}{Z_n} = \\frac{1}{1 + 2 \\sum_{n=1}^{\\infty} \\exp\\left(-\\frac{\\beta \\hbar^2 n^2}{2I}\\right)}\n$$\nThis quantity will be computed by numerically summing the rapidly convergent series.\n\nSecond, we consider the path integral formulation in imaginary time. The partition function can be expressed as a sum over topological sectors, each labeled by an integer winding number $w \\in \\mathbb{Z}$. The contribution of each sector is determined by the path integral over paths that wind $w$ times around the ring in imaginary time $\\beta\\hbar$. For a free rotor, the Euclidean action for a path $\\theta(\\tau)$ is $S_E[\\theta] = \\int_0^{\\beta\\hbar} \\frac{1}{2} I \\dot{\\theta}(\\tau)^2 d\\tau$. The path that minimizes this action for a given winding $w$ (i.e., the classical path) has an action of $S_w = \\frac{2 \\pi^2 I w^2}{\\beta\\hbar}$. The weight of the winding sector $w$ is proportional to $\\exp(-S_w/\\hbar)$. The normalized probability of a winding number $w$ is:\n$$\np_w(w) = \\frac{\\exp\\left(-\\frac{2 \\pi^2 I w^2}{\\beta\\hbar^2}\\right)}{\\sum_{k=-\\infty}^{\\infty} \\exp\\left(-\\frac{2 \\pi^2 I k^2}{\\beta\\hbar^2}\\right)}\n$$\nFor the case of zero winding, $w=0$, the exponential term is $1$. The probability simplifies to:\n$$\np_w(w=0) = \\frac{1}{\\sum_{k=-\\infty}^{\\infty} \\exp\\left(-\\frac{2 \\pi^2 I k^2}{\\beta\\hbar^2}\\right)} = \\frac{1}{1 + 2 \\sum_{k=1}^{\\infty} \\exp\\left(-\\frac{2 \\pi^2 I k^2}{\\beta\\hbar^2}\\right)}\n$$\nThis is also computed by numerical summation.\n\nThird, we must determine the ratio $\\mathcal{R} = Z_n / Z_w$. Here, $Z_n$ is the canonical partition function defined above. The quantity $Z_w$ is defined as the \"path-integral sector-summed partition function that uses the exact continuum prefactor\". The correct and full path-integral representation of the partition function is given by the trace of the imaginary-time propagator, $\\mathrm{Tr}[e^{-\\beta \\hat{H}}]$. For a particle on a ring, this trace evaluates to:\n$$\nZ_{PI} = \\int_0^{2\\pi} d\\theta \\sum_{w=-\\infty}^{\\infty} K(\\theta+2\\pi w, \\beta\\hbar; \\theta, 0)\n$$\nwhere $K$ is the propagator. For a free rotor, this calculation yields:\n$$\nZ_{PI} = 2\\pi \\sqrt{\\frac{I}{2\\pi\\beta\\hbar^2}} \\sum_{w=-\\infty}^{\\infty} \\exp\\left(-\\frac{2 \\pi^2 I w^2}{\\beta\\hbar^2}\\right) = \\sqrt{\\frac{2\\pi I}{\\beta\\hbar^2}} \\sum_{w=-\\infty}^{\\infty} \\exp\\left(-\\frac{2 \\pi^2 I w^2}{\\beta\\hbar^2}\\right)\n$$\nIt is a fundamental result, derivable via the Poisson summation formula, that the two representations of the partition function are mathematically identical: $Z_n \\equiv Z_{PI}$. Assuming the problem uses the correct physical definition of the path-integral partition function for $Z_w$, it must be that $Z_w = Z_{PI} = Z_n$. Consequently, their ratio must be unity.\n$$\n\\mathcal{R} = \\frac{Z_n}{Z_w} = 1\n$$\nThis result is exact and independent of the system parameters. Any other result would imply a non-standard or physically incomplete definition of the partition function.\n\nFourth, we calculate the expected absolute winding number, $\\mathbb{E}[|w|]$. This is the average of $|w|$ over the winding number probability distribution $p_w(w)$:\n$$\n\\mathbb{E}[|w|] = \\sum_{w=-\\infty}^{\\infty} |w| p_w(w) = \\frac{\\sum_{w=-\\infty}^{\\infty} |w| \\exp\\left(-\\frac{2 \\pi^2 I w^2}{\\beta\\hbar^2}\\right)}{\\sum_{k=-\\infty}^{\\infty} \\exp\\left(-\\frac{2 \\pi^2 I k^2}{\\beta\\hbar^2}\\right)}\n$$\nExploiting the symmetry of the summand and the fact that the $w=0$ term is zero, this becomes:\n$$\n\\mathbb{E}[|w|] = \\frac{2 \\sum_{w=1}^{\\infty} w \\exp\\left(-\\frac{2 \\pi^2 I w^2}{\\beta\\hbar^2}\\right)}{1 + 2 \\sum_{k=1}^{\\infty} \\exp\\left(-\\frac{2 \\pi^2 I k^2}{\\beta\\hbar^2}\\right)}\n$$\nThe numerator and denominator will be computed via numerical summation.\n\nThe implementation will consist of a function that, for each given set of parameters $(m, R, T)$, computes these four quantities by evaluating the series expressions to a high degree of precision.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the path integral molecular dynamics problem for a particle on a ring.\n    \"\"\"\n    # Physical constants as specified in the problem statement.\n    hbar = 1.054571817e-34  # J*s\n    kb = 1.380649e-23      # J/K\n\n    # Test suite: (m in kg, R in m, T in K)\n    test_cases = [\n        (1.67262192369e-27, 1.0e-10, 300.0),\n        (1.67262192369e-27, 1.0e-10, 5.0),\n        (9.1093837015e-31, 1.0e-10, 5.0),\n        (1.67262192369e-27, 5.0e-10, 300.0),\n    ]\n\n    # This helper function computes the sum of a series of the form\n    # sum_{k=1 to inf} f(k) * exp(-A * k^2).\n    # The summation stops when terms become negligible or max_iter is reached.\n    def sum_series(A, func, max_iter=2000, tol=1e-18):\n        total = 0.0\n        for k in range(1, max_iter + 1):\n            term = func(k) * np.exp(-A * float(k)**2)\n            if term  tol:\n                break\n            total += term\n        return total\n\n    results = []\n    for m, R, T in test_cases:\n        # Step 1: Calculate primary physical parameters.\n        I = m * R**2\n        beta = 1.0 / (kb * T)\n\n        # Step 2: Calculate p_n(n=0), the probability of the zero angular momentum state.\n        alpha_n = (beta * hbar**2) / (2.0 * I)\n        sum_n_series = sum_series(alpha_n, lambda k: 1.0)\n        Z_n = 1.0 + 2.0 * sum_n_series\n        p_n0 = 1.0 / Z_n\n\n        # Step 3: Calculate p_w(w=0), the probability of the zero winding number sector.\n        # It is numerically more stable to calculate alpha_w from alpha_n.\n        # alpha_w = (2.0 * np.pi**2 * I) / (beta * hbar**2)\n        # alpha_n * alpha_w = (beta*hbar^2/2I) * (2*pi^2*I/beta*hbar^2) = pi^2\n        alpha_w = np.pi**2 / alpha_n\n        \n        sum_w_series = sum_series(alpha_w, lambda k: 1.0)\n        Dw = 1.0 + 2.0 * sum_w_series\n        p_w0 = 1.0 / Dw\n\n        # Step 4: Calculate the ratio R = Z_n / Z_w.\n        # As derived, the two partition function representations are identical, so their ratio is 1.\n        R_ratio = 1.0\n\n        # Step 5: Calculate E[|w|], the expected absolute winding number.\n        numerator_Ew_series = sum_series(alpha_w, lambda k: float(k))\n        numerator_Ew = 2.0 * numerator_Ew_series\n        E_abs_w = numerator_Ew / Dw\n        \n        results.append([p_n0, p_w0, R_ratio, E_abs_w])\n\n    # Format the results into the required string format \"[[r1,r2,...],[...],...]\"\n    # without any extra whitespace.\n    output_str = \"[\" + \",\".join([f\"[{','.join(map(str, r))}]\" for r in results]) + \"]\"\n    print(output_str)\n\nsolve()\n```"
        }
    ]
}