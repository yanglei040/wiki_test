## 引言
在探索分子与光相互作用的微观世界中，理解电子激发态的性质与动力学至关重要。然而，直接求解[含时薛定谔方程](@entry_id:137898)来描述这一过程，对于大多数真[实化](@entry_id:266794)学体系而言，其计算复杂度是难以承受的。[含时密度泛函理论](@entry_id:200019)（Time-dependent Density Functional Theory, TD-DFT）应运而生，它将基态密度泛函理论的成功思想推广至时变领域，提供了一条在计算成本和精度之间取得精妙平衡的有效途径。该方法以相对简单的电子密度取代极其复杂的[多体波函数](@entry_id:203043)作为核心变量，为从第一性原理出发研究[光化学](@entry_id:140933)和[光物理过程](@entry_id:154565)打开了大门。

本文将带领读者系统地学习TD-DFT。在第一章“原理与机制”中，我们将深入其理论基石（[Runge-Gross定理](@entry_id:272222)），剖析核心的计算框架（含时[Kohn-Sham方法](@entry_id:263733)），并揭示关键近似（[绝热近似](@entry_id:143074)）的物理内涵与影响。随后的第二章“应用与交叉学科联系”将通过丰富的实例，展示TD-DFT如何在化学、[材料科学](@entry_id:152226)、生物学等领域中预测[电子光谱](@entry_id:154403)、阐明反应机理[并指](@entry_id:276731)导[功能材料](@entry_id:194894)设计，彰显理论与实验的紧密结合。最后，在“动手实践”部分，我们提供了一系列精心设计的问题，旨在帮助读者巩固理论知识，并亲身体验TD-DFT在解决实际问题中的威力与局限性。通过这一结构化的学习路径，您将全面掌握TD-DFT这一现代计算化学的强大工具。

## 原理与机制

在理解了[含时密度泛函理论](@entry_id:200019) (Time-dependent Density Functional Theory, TD-DFT) 的基本目标之后，我们现在深入探讨其核心的理论原理与工作机制。本章将系统地阐述 TD-DFT 的理论基石、实际计算中所采用的关键近似，以及这些理论在模拟分子[光谱](@entry_id:185632)和动力学中的具体应用方法。

### 理论基石：Runge-Gross 定理

量子力学中，一个多电子体系的完整信息蕴含在其含时[多体波函数](@entry_id:203043) $\Psi(\mathbf{r}_1, \dots, \mathbf{r}_N, t)$ 中，该[波函数](@entry_id:147440)遵循[含时薛定谔方程](@entry_id:137898)。然而，由于[波函数](@entry_id:147440)对所有电子坐标的依赖性，直接求解该方程的计算成本会随着电子数的增加而急剧增长，这使得对大多数真[实化](@entry_id:266794)学体系的计算变得不切实际。

TD-DFT 提供了一条摆脱[波函数](@entry_id:147440)复杂性的途径，其理论基础是 **Runge-Gross (RG) 定理** 。该定理是[基态](@entry_id:150928) DFT 中 Hohenberg-Kohn 定理在含时领域的推广。RG 定理的核心论断是：对于一个给定的初始[量子态](@entry_id:146142)，体系的含时电子密度 $\rho(\mathbf{r}, t)$ 与产生该密度演化的外部势 $v(\mathbf{r}, t)$ 之间存在[一一对应](@entry_id:143935)的关系（在相差一个仅与时间相关的函数 $c(t)$ 的意义上）。

这个映射的唯一性至关重要。它意味着，对于一个确定的体系，其含时电子密度 $\rho(\mathbf{r}, t)$——一个仅仅是三维空间和时间坐标的函数——唯一地决定了外部势 $v(\mathbf{r}, t)$。由于外部势和电子间的相互作用势共同决定了体系的[哈密顿量](@entry_id:172864)，因此，含时电子密度实际上蕴含了体系演化的全部信息。这为使用相对简单的电子密度作为基本变量来替代极其复杂的[多体波函数](@entry_id:203043)提供了严格的理论依据。RG 定理的确立，标志着 TD-DFT 成为一个在形式上精确的理论。

### 含时 Kohn-Sham 方法

尽管 RG 定理在理论上证明了密度的核心地位，但它并未直接给出从密度计算物理可观测量的方法。为此，我们需要引入一个巧妙的计算框架——**含时 Kohn-Sham (TDKS) 方法**。

TDKS 方法的核心思想是构建一个虚拟的、无相互作用的电子体系（即 **Kohn-Sham 体系**），并要求这个虚拟体系在演化过程中，其电子密度在任意时刻都与真实的、有相互作用的体系的电子密度完全相同 。由于 KS 体系中的电子是无相互作用的，它们的行为可以通过一组单电子的[含时薛定谔方程](@entry_id:137898)（即含时 KS 方程）来描述：

$$
\mathrm{i}\frac{\partial}{\partial t}\phi_{j}(\mathbf{r},t) = \left[-\frac{1}{2}\nabla^{2} + v_{\mathrm{KS}}(\mathbf{r},t)\right]\phi_{j}(\mathbf{r},t)
$$

其中 $\phi_{j}(\mathbf{r},t)$ 是第 $j$ 个 KS [轨道](@entry_id:137151)。这个方程的关键在于**有效势** $v_{\mathrm{KS}}(\mathbf{r}, t)$。为了使 KS 体系的密度 $\rho_{\mathrm{KS}}(\mathbf{r},t) = \sum_{j}^{\mathrm{occ}}|\phi_{j}(\mathbf{r},t)|^{2}$ 等于真实体系的密度 $\rho(\mathbf{r},t)$，这个有效势必须被精心设计。它通常被分解为三个部分：

$$
v_{\mathrm{KS}}(\mathbf{r},t) = v_{\mathrm{ext}}(\mathbf{r},t) + v_{\mathrm{H}}[\rho](\mathbf{r},t) + v_{\mathrm{xc}}[\rho, \Psi_{0}, \Phi_{0}](\mathbf{r},t)
$$

这里，$v_{\mathrm{ext}}(\mathbf{r},t)$ 是真实的外部势（例如来自[原子核](@entry_id:167902)或外加[电场](@entry_id:194326)），$v_{\mathrm{H}}(\mathbf{r},t)$ 是**哈特里 (Hartree) 势**，它描述了电子密度[分布](@entry_id:182848)产生的经典[静电排斥](@entry_id:162128)。最重要的部分是**含时交换关联 (exchange-correlation, xc) 势** $v_{\mathrm{xc}}(\mathbf{r},t)$。这个势囊括了所有非经典的、复杂的量子效应，包括[泡利不相容原理](@entry_id:141850)引起的交换作用以及电子运动的关联效应。原则上，精确的 $v_{\mathrm{xc}}$ 是一个复杂的泛函，它不仅依赖于瞬时密度，还依赖于密度的整个历史（即“记忆效应”）以及体系的初始状态。

### [绝热近似](@entry_id:143074)：一个关键的简化

精确的含时交换关联势 $v_{\mathrm{xc}}$ 的“记忆效应”使其在实际计算中难以处理。为了使 TD-DFT 成为一个实用的计算工具，必须引入近似。其中最基本、最广泛应用的近似是**[绝热近似](@entry_id:143074) (adiabatic approximation)** 。

[绝热近似](@entry_id:143074)的核心假设是：体系的交换关联势在任意时刻 $t$ 只依赖于该时刻的瞬时电子密度 $\rho(\mathbf{r}, t)$，而与之前的密度历史无关。更进一步，它假设这种依赖关系与[基态](@entry_id:150928) DFT 中所使用的交换关联势泛函形式完全相同。数学上，这可以表示为：

$$
v_{xc}^{\mathrm{adia}}(\mathbf{r}, t) \approx v_{xc}^{\mathrm{GS}}[\rho(t)](\mathbf{r})
$$

其中 $v_{xc}^{\mathrm{GS}}$ 是为静态密度设计的[基态](@entry_id:150928)交换关联势泛函。这个近似极大地简化了问题，因为它消除了对密度历史的依赖，使体系的响应变得“瞬时”。

这一近似对描述体系响应性质的**交换关联核 (exchange-correlation kernel)** $f_{xc}$ 产生了直接影响。交换关联核定义为 $v_{xc}$ 对密度的泛函导数，$f_{xc}(\mathbf{r}, t, \mathbf{r}', t') = \delta v_{xc}(\mathbf{r}, t) / \delta \rho(\mathbf{r}', t')$。在[绝热近似](@entry_id:143074)下，由于 $v_{xc}$ 只依赖于瞬时密度，其核函数在时间上变成局域的，即：

$$
f_{xc}^{\mathrm{adia}}(\mathbf{r}, t, \mathbf{r}', t') = f_{xc}^{\mathrm{GS}}[\rho(t)](\mathbf{r}, \mathbf{r}') \delta(t-t')
$$

这里的 $\delta(t-t')$ 是狄拉克函数，它表明体系对密度变化的响应是瞬时的，没有任何记忆。虽然[绝热近似](@entry_id:143074)在许多情况下表现出色，但我们将在后续章节看到，正是这种对“[记忆效应](@entry_id:266709)”的忽略，导致了该方法在某些特定问题上的系统性失败。

### 计算方法：[实时传播](@entry_id:199067)与线性响应

基于 TDKS 框架和[绝热近似](@entry_id:143074)，研究者发展了两种主流的计算方法来模拟分子的电子动力学和[光谱](@entry_id:185632)性质 。

1.  **实时 (Real-Time, RT) 传播方法**：该方法直接在时间域中求解含时 KS 方程。计算从一个初始状态（通常是[基态](@entry_id:150928)）开始，然后施加一个含时的外部微扰（例如一个短促的[电场](@entry_id:194326)脉冲），并逐步跟踪体系的演化。该方法的主要原始输出是随时间变化的[物理可观测量](@entry_id:154692)，例如体系的总偶极矩 $\boldsymbol{\mu}(t)$。为了获得吸收光谱，需要对 $\boldsymbol{\mu}(t)$ 的时间信号进行[傅里叶变换](@entry_id:142120)等后处理操作。[RT-TDDFT](@entry_id:198643) 对于模拟强场下的[非线性](@entry_id:637147)效应和复杂的动力学过程特别有用。

2.  **[线性响应](@entry_id:146180) (Linear-Response, LR) 方法**：该方法在频率域中工作，它计算的是体系对一个微弱、周期性[振荡](@entry_id:267781)的外部微扰的线性响应。与实时跟踪整个[演化过程](@entry_id:175749)不同，LR-TDDFT 直接求解一个[本征值方程](@entry_id:192306)，其[本征值](@entry_id:154894)直接对应于体系的**电子激发能** $\omega_I$，而相应的[本征向量](@entry_id:151813)则可以用来计算**[振子强度](@entry_id:147221)** $f_I$ 等跃迁性质。因此，LR-TDDFT 的原始输出是一组离散的“[谱线](@entry_id:193408)”（即[激发能](@entry_id:190368)和对应的强度），非常适合直接用于模拟和解释紫外-可见[吸收光谱](@entry_id:144611)。

### 深入[线性响应理论](@entry_id:145737)：Casida 方程

由于 LR-TDDFT 在计算[电子光谱](@entry_id:154403)中的核心地位，我们有必要更深入地剖析其工作机制。

LR-TDDFT 的核心思想是，体系的激发能对应于其密度响应[函数的极点](@entry_id:189069)。理论上，真实相互作用体系的[响应函数](@entry_id:142629) $\chi$ 与无相互作用的 KS 体系的[响应函数](@entry_id:142629) $\chi_s$ 通过一个 Dyson 型方程联系起来：

$$
\chi(\omega) = \chi_s(\omega) + \chi_s(\omega) (f_H + f_{xc}(\omega)) \chi(\omega)
$$

这里的核心是[相互作用核](@entry_id:193790) $f_H + f_{xc}$，其中 $f_H$ 是哈特里核（即库仑作用 $1/|\mathbf{r}-\mathbf{r}'|$），$f_{xc}$ 是交换关联核。这个核描述了[电子-空穴对](@entry_id:142506)之间的有效相互作用。事实上，正是这个[相互作用核](@entry_id:193790)的存在，使得真实体系的响应与虚拟的 KS 体系的响应产生差异。例如，在计算分子的[极化率](@entry_id:143513) $\alpha(\omega)$ 时，KS 体系的响应 $\alpha_{KS}(\omega)$ 会忽略由密度变化引起的感应场。而完整的 TD-DFT 计算得到的 $\alpha_{TDDFT}(\omega)$ 则包含了这个感应场（通过[相互作用核](@entry_id:193790)）对外部[电场](@entry_id:194326)的**屏蔽效应**，导致其响应通常小于裸的 KS 响应，即 $\alpha_{TDDFT}(\omega) \lt \alpha_{KS}(\omega)$ 。

在这个[相互作用核](@entry_id:193790)中，哈特里核 $f_H$ 描述了激发的电子与留下的空穴之间的经典静电相互作用。而**交换关联核 $f_{xc}$ 的关键作用，是引入所有非经典的量子力学效应** 。这包括了因[泡利不相容原理](@entry_id:141850)产生的交换作用，以及电子之间为躲避彼此而产生的复杂关联运动。这些效应对于准确定位[激发态](@entry_id:261453)能量至关重要，例如，[单重态和三重态](@entry_id:148894)激发能的分裂就主要源于交换作用的贡献，而这一贡献正是通过 $f_{xc}$ 被引入的。

在实践中，上述 Dyson 型方程被转化为一个矩阵[本征值问题](@entry_id:142153)，即著名的 **Casida 方程**：

$$
\begin{pmatrix} \mathbf{A}  \mathbf{B} \\ \mathbf{B}^*  \mathbf{A}^* \end{pmatrix} \begin{pmatrix} \mathbf{X} \\ \mathbf{Y} \end{pmatrix} = \omega \begin{pmatrix} \mathbf{1}  \mathbf{0} \\ \mathbf{0}  -\mathbf{1} \end{pmatrix} \begin{pmatrix} \mathbf{X} \\ \mathbf{Y} \end{pmatrix}
$$

这是一个 $2N \times 2N$ 的非厄米广义本征值问题，其中 $N$ 是考虑的单电子跃迁（从占据[轨道](@entry_id:137151) $i$ 到未占[轨道](@entry_id:137151) $a$）的数目。矩阵 $\mathbf{A}$ 和 $\mathbf{B}$ 的元素由 KS [轨道能级](@entry_id:151753)差以及[相互作用核](@entry_id:193790)的积分构成。这两个矩阵有着明确的物理意义 ：

*   **A 矩阵** 描述了不同**激发过程**之间的耦合。其对角元代表了独立的单电子跃迁能量（[轨道能级](@entry_id:151753)差），非对角元则混合了不同的激发组态（例如 $i \to a$ 和 $j \to b$）。
*   **B 矩阵** 则描述了**激发过程**与**退激发过程**（即从未占[轨道](@entry_id:137151)回到占据[轨道](@entry_id:137151)）之间的耦合。

由于求解这个非厄米问题计算成本较高，且有时会遇到不稳定性问题，一个常用的简化是**Tamm-Dancoff 近似 (TDA)** 。TDA 的核心是完全忽略退激发耦合，即令 $\mathbf{B} = 0$。这使得复杂的 Casida 方程简化为一个 $N \times N$ 的标准厄米本征值问题：

$$
\mathbf{A} \mathbf{X} = \omega \mathbf{X}
$$

TDA 不仅简化了计算，还对结果产生系统性影响。由于 $\mathbf{B}$ 矩阵的贡献通常会降低[激发能](@entry_id:190368)，TDA 计算的[激发能](@entry_id:190368)普遍高于完整的 LR-TDDFT。这个效应在单重态上尤为明显，因为其 $\mathbf{B}$ 矩阵的库仑项贡献较大。因此，TDA 通常会**增大单重态-三重态的能量分裂**，并有助于缓解完整 TD-DFT 中可能出现的“[三重态不稳定性](@entry_id:181992)”问题。

### 绝热 TD-DFT 的局限性

尽管 TD-DFT 取得了巨大成功，但基于[绝热近似](@entry_id:143074)的标准方法存在一些众所周知的系统性缺陷。这些缺陷根源于近似本身。

#### [电荷转移](@entry_id:155270) (Charge-Transfer, CT) 激发

对于一个由电子给体 (D) 和受体 (A) 组成且两者空间分离较远的分子体系，其最低的 CT 激发能 $E_{\text{CT}}$ 在大距离 $R$ 下的渐进行为应为：

$$
E_{\text{CT}}(R) \approx I_{\text{D}} - A_{\text{A}} - \frac{1}{R}
$$

其中 $I_{\text{D}}$ 是给体的[电离能](@entry_id:136678)，$A_{\text{A}}$ 是受体的电子亲和能，而 $-1/R$ 项是分离后的电子和空穴之间的库仑吸引能。然而，当使用标准的局域或半局域交换关联泛函（如 LDA, GGA）进行绝热 TD-DFT 计算时，结果会严重低估真实的 CT 激发能 。

失败的根本原因在于**标准交换关联泛函的短程性**。这些泛函的交换关联势和核函数随距离衰减过快，无法正确描述长程的 $-1/R$ 库仑相互作用。结果，TD-DFT 计算出的 CT [激发能](@entry_id:190368)几乎完全丢失了电子-空穴的吸引能，其值错误地趋近于给体的 HOMO 和受体的 LUMO 之间的[轨道能级](@entry_id:151753)差。这一缺陷催生了长程修正泛函 (long-range corrected functionals) 的发展。

#### 双[电子激发](@entry_id:190531)

另一个显著的失败案例是描述具有显著**双电子激发 (double-excitation) 特征**的[激发态](@entry_id:261453) 。一个双[电子激发](@entry_id:190531)态是指相对于[基态](@entry_id:150928)，有两个电子同时被提升到未占[轨道](@entry_id:137151)。

标准的绝热 LR-TDDFT 几乎完全无法描述这类[激发态](@entry_id:261453)。其根本原因在于该理论的构造方式。LR-TDDFT 是在一个由**单电子激发**（即单个粒子-空穴对）构成的空间中描述体系的响应。从[基态](@entry_id:150928)出发，一个[单体](@entry_id:136559)微扰算符（如光与物质的相互作用）在微扰论的一阶只能直接产生单[电子激发](@entry_id:190531)态。要形成双[电子激发](@entry_id:190531)态，需要更复杂的机制，例如通过单电子激发态之间的耦合。然而，[绝热近似](@entry_id:143074)下的交换关联核 $f_{xc}$ 是频率无关的（没有记忆），它无法有效地提供这种耦合机制。因此，在绝热 LR-TDDFT 的谱中，纯粹的双电子激发态是“不可见的”。要正确描述这类态，需要超越[绝热近似](@entry_id:143074)，引入具有频率依赖性的交换关联核，或者采用更高级的多参考态方法。