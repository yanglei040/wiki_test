{
    "hands_on_practices": [
        {
            "introduction": "理解分子偶极矩的第一步是认识到它是一个矢量。本练习以二氟二氮烯（$\\text{N}_2\\text{F}_2$）的异构体为经典案例，展示了分子几何如何通过各个键偶极的矢量和来决定总偶极矩。通过亲手计算*顺式*异构体的偶极矩，你将对决定分子极性的结构-性质关系建立起基本而直观的理解。",
            "id": "2235982",
            "problem": "二氟二氮烯（$\\text{N}_2\\text{F}_2$）是一种化学化合物，根据氟原子相对于中心氮-氮双键（$\\text{N=N}$）的排列方式，它以*顺式*和*反式*两种平面几何异构体形式存在。在*顺式*异构体中，两个氟原子位于$\\text{N=N}$键的同一侧，而在*反式*异构体中，它们位于相对两侧。\n\n根据实验数据，每个氮原子周围的几何构型由一个$\\text{F-N=N}$键角 $\\theta = 114^\\circ$ 所表征。单个$\\text{N-F}$键偶极矩 $\\mu_{N-F}$ 的大小为 0.553 D (德拜)。\n\n假设分子的总偶极矩完全来自两个独立的$\\text{N-F}$键偶极的矢量和（即，忽略氮原子上孤对电子的贡献），计算*顺式*-$\\text{N}_2\\text{F}_2$异构体的分子偶极矩的大小。\n\n以德拜 (D) 为单位表示您的答案，并四舍五入到三位有效数字。",
            "solution": "将每个 N-F 键偶极子建模为位于分子平面内、大小为 $\\mu_{N\\text{-}F}$ 的矢量。设 $\\text{N=N}$ 键定义为 $x$ 轴，左边的 N 位于 $x<0$ 处，右边的 N 位于 $x>0$ 处。给定的 F-N=N 键角 $\\theta$ 是每个 N-F 键与该氮原子处的 N=N 键之间的夹角。\n\n对于顺式异构体，两个 F 原子（因此两个键偶极子）都位于 $\\text{N=N}$ 轴的同一侧。因此，两个 N-F 偶极矢量的方向（从 $+x$ 轴测量）分别为 $\\theta$（在左边的 N 处，N=N 键指向 $+x$ 方向）和 $180^{\\circ}-\\theta$（在右边的 N 处，N=N 键指向 $-x$ 方向，但 F 位于同一侧）。\n\n将这两个偶极矢量写为分量形式：\n$$\n\\vec{\\mu}_{L}=\\mu_{N\\text{-}F}\\left(\\cos\\theta,\\ \\sin\\theta\\right),\\qquad\n\\vec{\\mu}_{R}=\\mu_{N\\text{-}F}\\left(\\cos(180^{\\circ}-\\theta),\\ \\sin(180^{\\circ}-\\theta)\\right).\n$$\n利用 $\\cos(180^{\\circ}-\\theta)=-\\cos\\theta$ 和 $\\sin(180^{\\circ}-\\theta)=\\sin\\theta$，它们的和为：\n$$\n\\vec{\\mu}_{\\text{cis}}=\\vec{\\mu}_{L}+\\vec{\\mu}_{R}\n=\\mu_{N\\text{-}F}\\left(\\cos\\theta-\\cos\\theta,\\ \\sin\\theta+\\sin\\theta\\right)\n=\\left(0,\\ 2\\mu_{N\\text{-}F}\\sin\\theta\\right).\n$$\n因此，顺式异构体的分子偶极矩的大小为：\n$$\n|\\vec{\\mu}_{\\text{cis}}|=2\\,\\mu_{N\\text{-}F}\\,\\sin\\theta.\n$$\n代入给定值 $\\mu_{N\\text{-}F}=0.553$ D 和 $\\theta=114^{\\circ}$：\n$$\n|\\vec{\\mu}_{\\text{cis}}|=2\\,(0.553)\\,\\sin(114^{\\circ}).\n$$\n由于 $\\sin(114^{\\circ})=\\sin(66^{\\circ})\\approx 0.913545$，我们得到：\n$$\n|\\vec{\\mu}_{\\text{cis}}|\\approx 2\\times 0.553\\times 0.913545\\approx 1.01038\\ \\text{D}.\n$$\n四舍五入到三位有效数字，结果为 $1.01$ D。",
            "answer": "$$\\boxed{1.01}$$"
        },
        {
            "introduction": "从定性原理走向定量预测，我们可以运用计算模型。本练习为氨分子（$\\text{NH}_3$）建立了一个简明的点电荷模型，旨在探索计算化学中的一个关键问题：计算性质对输入几何构型的敏感性。通过比较基于实验测定几何构型和理论优化几何构型计算出的偶极矩，你将亲身体会到为何精确的结构信息对于可靠的性质预测至关重要。",
            "id": "2451471",
            "problem": "您将实现一个程序，使用点电荷模型计算氨的分子偶极矩大小，一次使用实验几何构型，一次使用理论几何构型，然后评估其边界和标度行为。请从偶极矩作为电荷加权位置矢量和的第一性原理定义出发进行计算。使用一个电中性的、以原子为中心的点电荷模型，其中氮原子的电荷为 $q_{\\mathrm{N}} = -0.84\\,e$，每个氢原子的电荷为 $q_{\\mathrm{H}} = +0.28\\,e$，$e$ 是元电荷。将氮原子置于原点。对于一个三角锥形的$\\text{NH}_3$分子，其具有三个等效的 N–H 键，键长为 $r$，氢-氮-氢夹角为 $\\psi$，三个氢原子围绕主对称轴对称排列。设 $\\theta$ 表示每个 N–H 键与穿过氮原子的对称轴所成的角；$\\psi$ 和 $\\theta$ 通过以下精确恒等式关联：\n$$\n\\cos \\psi \\;=\\; \\frac{3\\cos^2 \\theta - 1}{2}.\n$$\n在每种情况下，使用此关系式计算 $\\theta$。然后，在固定的 $r$ 值下构建氢原子的坐标，方法是将它们放置在相对于正对称轴的极角 $\\theta' = \\pi - \\arccos(\\cos\\theta)$ 处，以及方位角 $0^\\circ$、$120^\\circ$ 和 $240^\\circ$ 处，从而使三个氢原子位于围绕对称轴的同一圆锥面上。总偶极矩矢量为\n$$\n\\boldsymbol{\\mu} \\;=\\; \\sum_i q_i \\,\\mathbf{r}_i,\n$$\n其大小应以德拜 (Debye) 为单位报告。最终答案以德拜 (Debye) 为单位表示，并四舍五入到六位小数。明确使用以下物理常数：元电荷 $e = 1.602176634\\times 10^{-19}\\,\\mathrm{C}$，$1\\,\\text{\\AA} = 1.0\\times 10^{-10}\\,\\mathrm{m}$，以及 $1\\,\\text{Debye} = 3.33564\\times 10^{-30}\\,\\mathrm{C\\,m}$。角度以度为单位提供。\n\n测试套件（所有情况均使用上述给定的相同电荷）：\n- 情况 A (实验几何构型): $r = 1.012\\,\\text{\\AA}$, $\\psi = 106.7^\\circ$。\n- 情况 B (理论优化几何构型): $r = 1.020\\,\\text{\\AA}$, $\\psi = 107.5^\\circ$。\n- 情况 C (平面边界几何构型): $r = 1.012\\,\\text{\\AA}$, $\\psi = 120.0^\\circ$。\n- 情况 D (压缩键): $r = 0.500\\,\\text{\\AA}$, $\\psi = 106.7^\\circ$。\n- 情况 E (派生度量): 情况 B 和情况 A 的偶极矩大小（单位为德拜）的绝对差值。\n\n您的程序必须生成单行输出，包含五个结果，格式为用方括号括起来的逗号分隔列表，顺序为 [情况 A, 情况 B, 情况 C, 情况 D, 情况 E]，例如，\"[1.234567,1.234567,0.000000,0.123456,0.001111]\"。所有五个值都必须是以德拜为单位、四舍五入到六位小数的浮点数。不要打印任何额外文本。",
            "solution": "该问题要求使用点电荷模型计算氨（$\\text{NH}_3$）在不同几何构型下的分子偶极矩大小。我们必须首先验证问题陈述的有效性，然后从第一性原理出发推导解决方案。\n\n该问题具有科学依据，提法明确且客观。它基于电偶极矩的基本定义，并采用了一个标准的、尽管是简化的点电荷模型。所有必要的参数，包括电荷、几何排列和物理常数，都已提供，且内部没有矛盾。问题中给出的 H-N-H 键角 $\\psi$ 与 N-H 键和对称轴之间的夹角 $\\theta$ 之间的关系，对于三角锥体结构是一个正确的几何恒等式。坐标构建的说明中包含一个可能涉及角度 $\\theta'$ 的模糊步骤，但如下所示，这种模糊性不影响所需输出——偶极矩大小的计算。因此，该问题被认定为有效。\n\n对于一组位于位置 $\\mathbf{r}_i$ 处的点电荷 $q_i$，其电偶极矩矢量 $\\boldsymbol{\\mu}$ 定义为：\n$$\n\\boldsymbol{\\mu} = \\sum_i q_i \\mathbf{r}_i\n$$\n该问题为$\\text{NH}_3$指定了一个电中性的点电荷模型，其中氮原子 (N) 位于原点 $\\mathbf{r}_N = \\mathbf{0}$。氮原子的电荷为 $q_N = -0.84\\,e$，三个氢原子 (H) 的电荷均为 $q_H = +0.28\\,e$，$e$ 是元电荷。总电荷为 $q_{total} = q_N + 3 q_H = -0.84\\,e + 3(0.28\\,e) = 0$，证实了该体系是电中性的。对于电中性体系，计算出的偶极矩与原点的选择无关。将氮原子置于原点是一个方便的选择，可以简化计算。\n\n当 $\\mathbf{r}_N = \\mathbf{0}$ 时，氮原子电荷对总和的贡献为零，因此偶极矩的表达式变为：\n$$\n\\boldsymbol{\\mu} = q_H (\\mathbf{r}_{H1} + \\mathbf{r}_{H2} + \\mathbf{r}_{H3})\n$$\n其中 $\\mathbf{r}_{Hi}$ 是三个氢原子的位置矢量。\n\n我们建立一个坐标系，使分子的主对称轴与 $z$ 轴对齐。三个氢原子围绕该轴对称排列。我们可以使用球坐标 $(r, \\theta_p, \\phi)$ 来描述它们的位置，其中 $r$ 是 N-H 键长，$\\theta_p$ 是相对于 $z$ 轴正向的极角，$\\phi$ 是方位角。三个氢原子被放置在方位角 $\\phi_1 = 0$、$\\phi_2 = 2\\pi/3$ 弧度 ($120^\\circ$) 和 $\\phi_3 = 4\\pi/3$ 弧度 ($240^\\circ$) 处。氢原子的笛卡尔坐标为：\n$$\n\\mathbf{r}_{Hi} = (r \\sin\\theta_p \\cos\\phi_i, r \\sin\\theta_p \\sin\\phi_i, r \\cos\\theta_p)\n$$\n需要计算位置矢量之和 $\\sum_{i=1}^3 \\mathbf{r}_{Hi}$。我们逐分量地计算这个和：\n$x$ 分量的和正比于 $\\sum \\cos\\phi_i = \\cos(0) + \\cos(2\\pi/3) + \\cos(4\\pi/3) = 1 - 1/2 - 1/2 = 0$。\n$y$ 分量的和正比于 $\\sum \\sin\\phi_i = \\sin(0) + \\sin(2\\pi/3) + \\sin(4\\pi/3) = 0 + \\sqrt{3}/2 - \\sqrt{3}/2 = 0$。\n$z$ 分量的和为 $\\sum z_i = r\\cos\\theta_p + r\\cos\\theta_p + r\\cos\\theta_p = 3r\\cos\\theta_p$。\n\n由于对称性，总偶极矩的 $x$ 和 $y$ 分量为零。所得偶极矩矢量与 $z$ 轴对齐：\n$$\n\\boldsymbol{\\mu} = (0, 0, 3 q_H r \\cos\\theta_p)\n$$\n偶极矩的大小 $\\mu$ 是非零分量的绝对值：\n$$\n\\mu = |\\boldsymbol{\\mu}| = |3 q_H r \\cos\\theta_p|\n$$\n由于 $q_H = +0.28\\,e$ 是正值，而 $r$ 是长度，我们有 $\\mu = 3 q_H r |\\cos\\theta_p|$。\n\n接下来，我们必须将 $|\\cos\\theta_p|$ 与给定的 H-N-H 键角 $\\psi$ 关联起来。我们使用两个氢原子的位置矢量（例如 $\\mathbf{r}_{H1}$ 和 $\\mathbf{r}_{H2}$）之间的点积：\n$$\n\\mathbf{r}_{H1} \\cdot \\mathbf{r}_{H2} = |\\mathbf{r}_{H1}| |\\mathbf{r}_{H2}| \\cos\\psi = r^2 \\cos\\psi\n$$\n从笛卡尔坐标显式计算点积：\n$$\n\\mathbf{r}_{H1} \\cdot \\mathbf{r}_{H2} = (r\\sin\\theta_p \\cos\\phi_1)(r\\sin\\theta_p \\cos\\phi_2) + (r\\sin\\theta_p \\sin\\phi_1)(r\\sin\\theta_p \\sin\\phi_2) + (r\\cos\\theta_p)(r\\cos\\theta_p)\n$$\n$$\n= r^2\\sin^2\\theta_p(\\cos\\phi_1\\cos\\phi_2 + \\sin\\phi_1\\sin\\phi_2) + r^2\\cos^2\\theta_p = r^2\\sin^2\\theta_p\\cos(\\phi_1 - \\phi_2) + r^2\\cos^2\\theta_p\n$$\n代入 $\\phi_1=0$ 和 $\\phi_2=2\\pi/3$，我们得到 $\\cos(\\phi_1-\\phi_2) = \\cos(-2\\pi/3) = -1/2$。\n$$\n\\mathbf{r}_{H1} \\cdot \\mathbf{r}_{H2} = r^2\\sin^2\\theta_p(-1/2) + r^2\\cos^2\\theta_p = r^2\\left(-\\frac{1}{2}(1-\\cos^2\\theta_p) + \\cos^2\\theta_p\\right) = r^2\\left(\\frac{3}{2}\\cos^2\\theta_p - \\frac{1}{2}\\right)\n$$\n将点积的两个表达式相等，就得到了问题陈述中提供的恒等式，其中 $\\theta$ 对应于我们的 $\\theta_p$：\n$$\nr^2 \\cos\\psi = r^2\\frac{3\\cos^2\\theta_p - 1}{2} \\implies \\cos\\psi = \\frac{3\\cos^2\\theta_p - 1}{2}\n$$\n解出 $|\\cos\\theta_p|$：\n$$\n\\cos^2\\theta_p = \\frac{2\\cos\\psi + 1}{3} \\implies |\\cos\\theta_p| = \\sqrt{\\frac{2\\cos\\psi + 1}{3}}\n$$\n这个表达式从角度 $\\psi$ 唯一地确定了 $|\\cos\\theta_p|$ 的大小。将其代回到偶极矩大小的公式中：\n$$\n\\mu = 3 q_H r \\sqrt{\\frac{2\\cos\\psi + 1}{3}}\n$$\n这是用于计算的最终公式。计算步骤如下：\n1. 将输入的键长 $r$ 从埃（Ångströms）转换为米 ($1\\,\\text{\\AA} = 1.0 \\times 10^{-10}\\,\\mathrm{m}$)。\n2. 将输入的角度 $\\psi$ 从度转换为弧度，以便在余弦函数中使用。\n3. 以库仑为单位计算电荷 $q_H$：$q_H = 0.28 \\times e$，使用 $e = 1.602176634 \\times 10^{-19}\\,\\mathrm{C}$。\n4. 将这些值代入推导出的公式中，以获得国际单位制 (SI units) 下的 $\\mu$（单位为 $C \\cdot m$）。\n5. 使用换算因子 $1\\,D = 3.33564 \\times 10^{-30}\\,C \\cdot m$，将结果从 $C \\cdot m$ 转换为德拜 (Debye, D)。\n6. 对每个测试情况应用该公式。对于情况 C，其中 $\\psi=120^\\circ$，$\\cos\\psi = -0.5$，平方根下的项变为零，对于平面几何构型正确地得出 $\\mu = 0$。情况 E 是情况 B 和情况 A 的偶极矩大小之间的绝对差值。\n7. 将所有最终值四舍五入到六位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the molecular dipole moment of ammonia for several geometries\n    based on a point-charge model.\n    \"\"\"\n\n    # --- Givens and Constants ---\n    \n    # Physical constants\n    e_charge = 1.602176634e-19  # Elementary charge in Coulombs (C)\n    A_to_m = 1.0e-10             # Angstrom to meter conversion factor\n    D_to_Cm = 3.33564e-30        # Debye to Coulomb-meter conversion factor\n\n    # Model parameters\n    q_H_e = 0.28  # Charge on Hydrogen in units of elementary charge e\n\n    # Charge on Hydrogen in Coulombs\n    q_H_C = q_H_e * e_charge\n\n    # Test suite from the problem statement\n    # Each case is a tuple: (bond_length_in_A, hnh_angle_in_deg)\n    test_cases_params = [\n        (1.012, 106.7),  # Case A: experimental geometry\n        (1.020, 107.5),  # Case B: theory-optimized geometry\n        (1.012, 120.0),  # Case C: planar boundary geometry\n        (0.500, 106.7),  # Case D: compressed bonds\n    ]\n    \n    def calculate_dipole_magnitude(r_A, psi_deg):\n        \"\"\"\n        Calculates the dipole moment magnitude in Debye.\n\n        Args:\n            r_A (float): N-H bond length in Angstroms.\n            psi_deg (float): H-N-H bond angle in degrees.\n\n        Returns:\n            float: The magnitude of the molecular dipole moment in Debye.\n        \"\"\"\n        # 1. Convert inputs to SI units\n        r_m = r_A * A_to_m\n        psi_rad = np.deg2rad(psi_deg)\n\n        # 2. Calculate the geometric factor |cos(theta)|\n        cos_psi = np.cos(psi_rad)\n        \n        # Handle potential floating point inaccuracies for the planar case\n        # where the argument to sqrt should be exactly zero.\n        cos2_theta_arg = (2 * cos_psi + 1) / 3\n        if cos2_theta_arg < 0:\n             # This can happen if psi > 120 due to float precision.\n             # Physically, the angle cannot exceed 120 for this geometry.\n             # For psi=120, this term is 0.\n            abs_cos_theta = 0.0\n        else:\n            abs_cos_theta = np.sqrt(cos2_theta_arg)\n\n        # 3. Calculate dipole moment magnitude in SI units (C*m)\n        # Formula: mu = 3 * q_H * r * |cos(theta)|\n        mu_si = 3 * q_H_C * r_m * abs_cos_theta\n        \n        # 4. Convert to Debye\n        mu_D = mu_si / D_to_Cm\n        \n        return mu_D\n\n    # --- Calculation for all cases ---\n    \n    # Calculate results for cases A, B, C, D\n    results_abcd = []\n    for r_A, psi_deg in test_cases_params:\n        result = calculate_dipole_magnitude(r_A, psi_deg)\n        results_abcd.append(result)\n        \n    mu_A = results_abcd[0]\n    mu_B = results_abcd[1]\n    \n    # Calculate Case E: absolute difference between B and A\n    mu_E = abs(mu_B - mu_A)\n\n    # Combine all results\n    final_results = results_abcd + [mu_E]\n    \n    # Round all results to six decimal places\n    rounded_results = [round(res, 6) for res in final_results]\n    \n    # Format for printing\n    output_str = f\"[{','.join(f'{res:.6f}' for res in rounded_results)}]\"\n    \n    # Final print statement in the exact required format.\n    print(output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "许多分子并非刚性结构，而是以多种不同构象异构体动态集合的形式存在。这项高阶实践练习旨在连接单分子性质与宏观的、依赖于温度的可观测量。以正丁烷（$n$-butane）为模型体系，你将计算其*反式*和*旁式*构象的能量和偶极矩，然后应用玻尔兹曼统计来预测样品在不同温度下的平均偶极矩。本练习揭示了计算化学如何从微观系综的行为出发，解释宏观物质的性质。",
            "id": "2451507",
            "problem": "一个由四个碳位点组成的中性分子被用来近似正丁烷（$n$-butane）的构象性质。考虑了两种构象异构体：反式构象异构体，其中心 $\\mathrm{C}-\\mathrm{C}$ 键的二面角为 $\\phi_{\\text{anti}} = 180^{\\circ}$；以及邻位交叉构象异构体，其二面角为 $\\phi_{\\text{gauche}} = 60^{\\circ}$。对于这两种构象异构体，四个碳原子核的位置由内坐标按如下方式构建。\n\n设碳-碳键长为 $r_{\\mathrm{CC}}$ (单位为 $\\mathrm{\\AA}$)，碳-碳-碳键角为 $\\theta$ (单位为度)。在笛卡尔空间中定义前三个碳的位置如下：\n- $\\mathbf{r}_1 = (0,0,0)$,\n- $\\mathbf{r}_2 = (r_{\\mathrm{CC}},0,0)$,\n- $\\mathbf{r}_3 = \\mathbf{r}_2 + \\mathbf{d}_{23}$，其中 $\\mathbf{d}_{23} = \\left(r_{\\mathrm{CC}}\\cos(\\pi - \\theta_{\\mathrm{rad}}),\\; r_{\\mathrm{CC}}\\sin(\\pi - \\theta_{\\mathrm{rad}}),\\; 0\\right)$,\n\n其中 $\\theta_{\\mathrm{rad}}$ 是 $\\theta$ 转换成的弧度。第四个碳的位置 $\\mathbf{r}_4$ 是根据相对于 $(\\mathbf{r}_1,\\mathbf{r}_2,\\mathbf{r}_3)$ 的内坐标 $(r_{\\mathrm{CC}}, \\theta, \\phi)$ 构建的，公式如下：\n$$\n\\begin{aligned}\n\\mathbf{e}_1 &= \\frac{\\mathbf{r}_2 - \\mathbf{r}_3}{\\lVert \\mathbf{r}_2 - \\mathbf{r}_3 \\rVert},\\quad\n\\mathbf{e}_2^{\\prime} = \\frac{\\mathbf{r}_1 - \\mathbf{r}_2}{\\lVert \\mathbf{r}_1 - \\mathbf{r}_2 \\rVert},\\quad\n\\mathbf{n} = \\frac{\\mathbf{e}_2^{\\prime} \\times \\mathbf{e}_1}{\\lVert \\mathbf{e}_2^{\\prime} \\times \\mathbf{e}_1 \\rVert},\\quad\n\\mathbf{e}_2 = \\mathbf{n} \\times \\mathbf{e}_1, \\\\\n\\theta_{\\mathrm{rad}} &= \\theta \\times \\frac{\\pi}{180},\\quad \\phi_{\\mathrm{rad}} = \\phi \\times \\frac{\\pi}{180}, \\\\\n\\mathbf{r}_4 &= \\mathbf{r}_3 + r_{\\mathrm{CC}}\\left(-\\cos\\theta_{\\mathrm{rad}}\\,\\mathbf{e}_1 + \\sin\\theta_{\\mathrm{rad}} \\left(\\cos\\phi_{\\mathrm{rad}}\\,\\mathbf{e}_2 + \\sin\\phi_{\\mathrm{rad}}\\,\\mathbf{n}\\right)\\right).\n\\end{aligned}\n$$\n\n使用位于碳位点上的四个点电荷来近似每个构象异构体的永久电偶极矩 $\\boldsymbol{\\mu}$。偏电荷（以基本电荷 $e$ 为单位）为 $\\left[q_1,q_2,q_3,q_4\\right] = \\left[+\\delta,-\\delta,-\\delta,+\\delta\\right]$，因此净电荷为零。偶极矩矢量为\n$$\n\\boldsymbol{\\mu} = \\sum_{i=1}^{4} q_i\\,\\mathbf{r}_i,\n$$\n单位为 $e\\cdot\\mathrm{\\AA}$。其大小以德拜（Debye）为单位，由下式给出：\n$$\n\\mu\\,(\\mathrm{D}) = \\lVert \\boldsymbol{\\mu} \\rVert \\times \\left(4.80320427\\,\\frac{\\mathrm{D}}{e\\cdot\\mathrm{\\AA}}\\right).\n$$\n\n构象能量作为二面角 $\\phi$（以弧度为单位）的函数，由截断的傅里叶扭转势建模：\n$$\nE(\\phi) = V_1 \\cos\\phi + V_2 \\cos(2\\phi) + V_3 \\cos(3\\phi),\n$$\n其中 $V_1$、$V_2$ 和 $V_3$ 的单位是 $\\mathrm{kcal}\\,\\mathrm{mol}^{-1}$。使用 $1\\,\\mathrm{kcal}\\,\\mathrm{mol}^{-1} = 4.184\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$ 将能量转换为 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$。\n\n令 $E_{\\text{anti}} = E(\\phi_{\\text{anti}})$ 和 $E_{\\text{gauche}} = E(\\phi_{\\text{gauche}})$。需要报告的能量差为\n$$\n\\Delta E = E_{\\text{gauche}} - E_{\\text{anti}}\n$$\n单位为 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$。\n\n假设一个热系综，绝对温度为 $T$（单位为开尔文），其中只包含反式构象异构体和两个简并的邻位交叉构象异构体（$\\phi = +60^{\\circ}$ 和 $\\phi = -60^{\\circ}$）。简并度为 $g_{\\text{anti}} = 1$ 和 $g_{\\text{gauche}} = 2$。使用理想气体常数 $R = 8.314462618\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$ 和以 $\\mathrm{J}\\,\\mathrm{mol}^{-1}$ 为单位的能量，定义玻尔兹曼概率：\n$$\np_{\\text{anti}}(T) = \\frac{g_{\\text{anti}}\\,e^{-E_{\\text{anti}}/(RT)}}{g_{\\text{anti}}\\,e^{-E_{\\text{anti}}/(RT)} + g_{\\text{gauche}}\\,e^{-E_{\\text{gauche}}/(RT)}},\\quad\np_{\\text{gauche}}(T) = \\frac{g_{\\text{gauche}}\\,e^{-E_{\\text{gauche}}/(RT)}}{g_{\\text{anti}}\\,e^{-E_{\\text{anti}}/(RT)} + g_{\\text{gauche}}\\,e^{-E_{\\text{gauche}}/(RT)}}.\n$$\n\n此处，样品的表观偶极矩大小定义为均方根偶极矩，\n$$\n\\mu_{\\mathrm{rms}}(T) = \\sqrt{p_{\\text{anti}}(T)\\,\\mu_{\\text{anti}}^2 + p_{\\text{gauche}}(T)\\,\\mu_{\\text{gauche}}^2},\n$$\n单位为德拜。角度在指定时必须使用度；在需要时转换为弧度。能量必须以 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$ 报告，偶极矩大小以德拜（D）报告，温度以开尔文报告。\n\n测试套件。对于下面的每一组参数，计算：\n- 能量差 $\\Delta E$，单位为 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$，\n- 偶极矩大小 $\\mu_{\\text{anti}}$ 和 $\\mu_{\\text{gauche}}$，单位为德拜，\n- 表观偶极矩大小 $\\mu_{\\mathrm{rms}}(200\\,\\mathrm{K})$ 和 $\\mu_{\\mathrm{rms}}(500\\,\\mathrm{K})$，单位为德拜。\n\n参数集：\n1) $\\delta = 0.10$, $r_{\\mathrm{CC}} = 1.540\\,\\mathrm{\\AA}$, $\\theta = 112.0^{\\circ}$, $V_1 = 0.0$, $V_2 = -0.4$, $V_3 = 0.6$ （所有 $V_i$ 的单位均为 $\\mathrm{kcal}\\,\\mathrm{mol}^{-1}$）。\n2) $\\delta = 0.00$, $r_{\\mathrm{CC}} = 1.540\\,\\mathrm{\\AA}$, $\\theta = 112.0^{\\circ}$, $V_1 = 0.0$, $V_2 = -0.4$, $V_3 = 0.6$ （所有 $V_i$ 的单位均为 $\\mathrm{kcal}\\,\\mathrm{mol}^{-1}$）。\n3) $\\delta = 0.20$, $r_{\\mathrm{CC}} = 1.540\\,\\mathrm{\\AA}$, $\\theta = 110.0^{\\circ}$, $V_1 = 0.0$, $V_2 = -0.2$, $V_3 = 0.4$ （所有 $V_i$ 的单位均为 $\\mathrm{kcal}\\,\\mathrm{mol}^{-1}$）。\n\n最终输出格式。您的程序应生成单行输出，其中包含结果，形式为一个逗号分隔的列表，内含三个五元列表，每个列表对应一组参数，每组内元素的顺序必须完全如下：\n$$\n[\\Delta E,\\ \\mu_{\\text{anti}},\\ \\mu_{\\text{gauche}},\\ \\mu_{\\mathrm{rms}}(200\\,\\mathrm{K}),\\ \\mu_{\\mathrm{rms}}(500\\,\\mathrm{K})].\n$$\n对于整个测试套件，打印单行：\n$$\n\\big[ [\\cdot,\\cdot,\\cdot,\\cdot,\\cdot],\\ [\\cdot,\\cdot,\\cdot,\\cdot,\\cdot],\\ [\\cdot,\\cdot,\\cdot,\\cdot,\\cdot] \\big].\n$$\n所有浮点数必须以上述指定单位表示。",
            "solution": "该任务要求从内坐标构建构象异构体的几何结构，从点电荷计算构象异构体的偶极矩，从扭转势评估构象异构体的能量，然后根据玻尔兹曼统计预测随温度变化的表观偶极矩大小。\n\n几何构建。将 $\\mathbf{r}_1$ 置于 $(0,0,0)$，$\\mathbf{r}_2$ 置于 $(r_{\\mathrm{CC}},0,0)$。第三个碳原子 $\\mathbf{r}_3$ 位于由前两个原子定义的 $xy$ 平面内，相对于 $\\mathrm{C}_1-\\mathrm{C}_2-\\mathrm{C}_3$ 键角为 $\\theta$。使用 $\\theta_{\\mathrm{rad}} = \\theta \\pi/180$，\n$$\n\\mathbf{d}_{23} = \\left(r_{\\mathrm{CC}}\\cos(\\pi - \\theta_{\\mathrm{rad}}),\\ r_{\\mathrm{CC}}\\sin(\\pi - \\theta_{\\mathrm{rad}}),\\ 0\\right) = \\left(-r_{\\mathrm{CC}}\\cos\\theta_{\\mathrm{rad}},\\ r_{\\mathrm{CC}}\\sin\\theta_{\\mathrm{rad}},\\ 0\\right).\n$$\n那么 $\\mathbf{r}_3 = \\mathbf{r}_2 + \\mathbf{d}_{23}$。第四个碳的位置 $\\mathbf{r}_4$ 通过标准的内坐标到笛卡尔坐标映射来构建。定义沿键方向和平面法线的单位矢量：\n$$\n\\mathbf{e}_1 = \\frac{\\mathbf{r}_2 - \\mathbf{r}_3}{\\lVert \\mathbf{r}_2 - \\mathbf{r}_3 \\rVert},\\quad\n\\mathbf{e}_2^{\\prime} = \\frac{\\mathbf{r}_1 - \\mathbf{r}_2}{\\lVert \\mathbf{r}_1 - \\mathbf{r}_2 \\rVert},\\quad\n\\mathbf{n} = \\frac{\\mathbf{e}_2^{\\prime} \\times \\mathbf{e}_1}{\\lVert \\mathbf{e}_2^{\\prime} \\times \\mathbf{e}_1 \\rVert},\\quad\n\\mathbf{e}_2 = \\mathbf{n} \\times \\mathbf{e}_1.\n$$\n对于给定的键长 $r_{\\mathrm{CC}}$、键角 $\\theta$ 和二面角 $\\phi$（其中两个角度都转换为弧度），位置为\n$$\n\\mathbf{r}_4 = \\mathbf{r}_3 + r_{\\mathrm{CC}}\\left(-\\cos\\theta_{\\mathrm{rad}}\\,\\mathbf{e}_1 + \\sin\\theta_{\\mathrm{rad}} \\left(\\cos\\phi_{\\mathrm{rad}}\\,\\mathbf{e}_2 + \\sin\\phi_{\\mathrm{rad}}\\,\\mathbf{n}\\right)\\right).\n$$\n选择 $\\phi_{\\text{anti}} = \\pi$ 和 $\\phi_{\\text{gauche}} = \\pi/3$ 分别得到平面的反式构象和扭转的邻位交叉构象几何结构。\n\n偶极矩。对于偏电荷 $\\left[q_1,q_2,q_3,q_4\\right] = \\left[+\\delta,-\\delta,-\\delta,+\\delta\\right]$（以基本电荷为单位），分子偶极矩矢量（单位为 $e\\cdot\\mathrm{\\AA}$）是\n$$\n\\boldsymbol{\\mu} = \\sum_{i=1}^{4} q_i\\,\\mathbf{r}_i.\n$$\n因为总电荷为零，$\\boldsymbol{\\mu}$ 与坐标原点的选择无关。以德拜为单位的大小是\n$$\n\\mu\\,(\\mathrm{D}) = \\lVert \\boldsymbol{\\mu} \\rVert \\times 4.80320427.\n$$\n对于反式构象异构体，当其几何结构由相等的键长和键角构建时，在内键的中点存在一个反演中心，电荷分布在反演操作下保持不变，导致 $\\boldsymbol{\\mu} \\approx \\mathbf{0}$。邻位交叉构象异构体缺少反演对称性，会产生一个非零的 $\\mu$，其大小随 $\\delta$ 增大而增大，并依赖于几何结构。\n\n构象异构体能量与能量差。扭转势定义为\n$$\nE(\\phi) = V_1 \\cos\\phi + V_2 \\cos(2\\phi) + V_3 \\cos(3\\phi),\n$$\n其中 $V_i$ 的单位是 $\\mathrm{kcal}\\,\\mathrm{mol}^{-1}$。计算在 $\\phi_{\\text{anti}}$ 和 $\\phi_{\\text{gauche}}$ 处的能量，通过乘以 $4.184$ 将其转换为 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$，然后报告其差值\n$$\n\\Delta E = E_{\\text{gauche}} - E_{\\text{anti}}\n$$\n以 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$ 为单位报告。所选参数会产生 $E_{\\text{anti}} < E_{\\text{gauche}}$ 的结果，这是一种典型的类似烷烃的反式构象异构体稳定化效应。\n\n热布居与表观偶极矩。在温度 $T$ 下，使用简并度 $g_{\\text{anti}}=1$ 和 $g_{\\text{gauche}}=2$ 来表示两个等价的邻位交叉状态，这些状态的配分函数是\n$$\nZ = g_{\\text{anti}}\\,e^{-E_{\\text{anti}}/(RT)} + g_{\\text{gauche}}\\,e^{-E_{\\text{gauche}}/(RT)},\n$$\n概率为\n$$\np_{\\text{anti}} = \\frac{g_{\\text{anti}}\\,e^{-E_{\\text{anti}}/(RT)}}{Z},\\quad\np_{\\text{gauche}} = \\frac{g_{\\text{gauche}}\\,e^{-E_{\\text{gauche}}/(RT)}}{Z}.\n$$\n因为系综是各向同性的，矢量平均偶极矩为零，与取向平均可观测量相关的表观大小是均方根偶极矩\n$$\n\\mu_{\\mathrm{rms}}(T) = \\sqrt{p_{\\text{anti}}(T)\\,\\mu_{\\text{anti}}^2 + p_{\\text{gauche}}(T)\\,\\mu_{\\text{gauche}}^2}.\n$$\n\n算法实现。对于每个测试用例：为 $\\phi_{\\text{anti}}$ 和 $\\phi_{\\text{gauche}}$ 构建 $\\mathbf{r}_1、\\mathbf{r}_2、\\mathbf{r}_3$ 然后是 $\\mathbf{r}_4$；根据电荷和位置计算 $\\mu_{\\text{anti}}$ 和 $\\mu_{\\text{gauche}}$；评估 $E_{\\text{anti}}$ 和 $E_{\\text{gauche}}$，将其转换为 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$，并计算 $\\Delta E$；使用 $R=8.314462618\\,\\mathrm{J}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$ 和转换为 $\\mathrm{J}\\,\\mathrm{mol}^{-1}$ 的能量，计算在 $T=200\\,\\mathrm{K}$ 和 $T=500\\,\\mathrm{K}$ 时的 $p_{\\text{anti}}(T)$ 和 $p_{\\text{gauche}}(T)$；最后计算在这两个温度下的 $\\mu_{\\mathrm{rms}}(T)$。为每个测试用例报告五元组 $[\\Delta E,\\ \\mu_{\\text{anti}},\\ \\mu_{\\text{gauche}},\\ \\mu_{\\mathrm{rms}}(200\\,\\mathrm{K}),\\ \\mu_{\\mathrm{rms}}(500\\,\\mathrm{K})]$，使用指定单位，并将它们汇总成单行列表。",
            "answer": "```python\nimport numpy as np\n\n# Constants\nDEBYE_PER_E_ANG = 4.80320427  # 1 e*Angstrom = 4.80320427 Debye\nKCAL_TO_KJ = 4.184            # 1 kcal/mol = 4.184 kJ/mol\nR_J_PER_MOLK = 8.314462618    # Gas constant in J/(mol*K)\n\ndef deg2rad(deg: float) -> float:\n    return deg * np.pi / 180.0\n\ndef unit(v: np.ndarray) -> np.ndarray:\n    n = np.linalg.norm(v)\n    if n == 0.0:\n        return v\n    return v / n\n\ndef build_initial_three(r_cc: float, theta_deg: float):\n    # r1 at origin, r2 on x-axis, r3 in xy-plane\n    r1 = np.array([0.0, 0.0, 0.0])\n    r2 = np.array([r_cc, 0.0, 0.0])\n    theta = deg2rad(theta_deg)\n    d23 = np.array([r_cc * np.cos(np.pi - theta), r_cc * np.sin(np.pi - theta), 0.0])\n    r3 = r2 + d23\n    return r1, r2, r3\n\ndef place_fourth(r1: np.ndarray, r2: np.ndarray, r3: np.ndarray,\n                 r_cc: float, theta_deg: float, dihedral_deg: float) -> np.ndarray:\n    theta = deg2rad(theta_deg)\n    phi = deg2rad(dihedral_deg)\n    e1 = unit(r2 - r3)\n    e2p = unit(r1 - r2)\n    n = unit(np.cross(e2p, e1))\n    # Handle potential collinearity by adjusting n if needed\n    if np.linalg.norm(n) == 0.0:\n        # In rare degenerate cases, pick an arbitrary perpendicular\n        # Choose a vector not parallel to e1\n        tmp = np.array([1.0, 0.0, 0.0])\n        if abs(np.dot(e1, tmp)) > 0.99:\n            tmp = np.array([0.0, 1.0, 0.0])\n        n = unit(np.cross(tmp, e1))\n    e2 = np.cross(n, e1)\n    r4 = r3 + r_cc * (-np.cos(theta) * e1 + np.sin(theta) * (np.cos(phi) * e2 + np.sin(phi) * n))\n    return r4\n\ndef dipole_magnitude_debye(positions: np.ndarray, charges_e: np.ndarray) -> float:\n    # positions: (N,3), charges: (N,)\n    mu_vec_eA = (charges_e[:, None] * positions).sum(axis=0)\n    mu_mag_debye = np.linalg.norm(mu_vec_eA) * DEBYE_PER_E_ANG\n    return mu_mag_debye\n\ndef torsion_energy_kj_per_mol(phi_deg: float, V1_kcal: float, V2_kcal: float, V3_kcal: float) -> float:\n    phi = deg2rad(phi_deg)\n    E_kcal = V1_kcal * np.cos(phi) + V2_kcal * np.cos(2.0 * phi) + V3_kcal * np.cos(3.0 * phi)\n    return E_kcal * KCAL_TO_KJ\n\ndef boltzmann_populations(E_anti_kJ: float, E_gauche_kJ: float, T: float):\n    # Include degeneracy: g_anti=1, g_gauche=2\n    g_anti = 1.0\n    g_gauche = 2.0\n    # Convert energies to J/mol\n    Ea = E_anti_kJ * 1000.0\n    Eg = E_gauche_kJ * 1000.0\n    beta = 1.0 / (R_J_PER_MOLK * T)\n    wa = g_anti * np.exp(-beta * Ea)\n    wg = g_gauche * np.exp(-beta * Eg)\n    Z = wa + wg\n    pa = wa / Z\n    pg = wg / Z\n    return pa, pg\n\ndef compute_case(delta_e: float, r_cc: float, theta_deg: float, V1: float, V2: float, V3: float):\n    # Build coordinates for anti and gauche\n    r1, r2, r3 = build_initial_three(r_cc, theta_deg)\n    r4_anti = place_fourth(r1, r2, r3, r_cc, theta_deg, 180.0)\n    r4_gauche = place_fourth(r1, r2, r3, r_cc, theta_deg, 60.0)\n    # Charges on carbons\n    charges = np.array([+delta_e, -delta_e, -delta_e, +delta_e])\n    # Positions arrays\n    pos_anti = np.vstack([r1, r2, r3, r4_anti])\n    pos_gauche = np.vstack([r1, r2, r3, r4_gauche])\n    # Dipoles\n    mu_anti = dipole_magnitude_debye(pos_anti, charges)\n    mu_gauche = dipole_magnitude_debye(pos_gauche, charges)\n    # Energies\n    E_anti_kJ = torsion_energy_kj_per_mol(180.0, V1, V2, V3)\n    E_gauche_kJ = torsion_energy_kj_per_mol(60.0, V1, V2, V3)\n    deltaE_kJ = E_gauche_kJ - E_anti_kJ\n    # Apparent dipoles at 200 K and 500 K\n    results = []\n    for T in (200.0, 500.0):\n        p_anti, p_gauche = boltzmann_populations(E_anti_kJ, E_gauche_kJ, T)\n        mu_rms = np.sqrt(p_anti * (mu_anti ** 2) + p_gauche * (mu_gauche ** 2))\n        results.append(mu_rms)\n    mu_rms_200, mu_rms_500 = results\n    return [deltaE_kJ, mu_anti, mu_gauche, mu_rms_200, mu_rms_500]\n\ndef solve():\n    # Define the test cases from the problem statement.\n    # Each tuple: (delta, r_cc, theta_deg, V1, V2, V3)\n    test_cases = [\n        (0.10, 1.540, 112.0, 0.0, -0.4, 0.6),\n        (0.00, 1.540, 112.0, 0.0, -0.4, 0.6),\n        (0.20, 1.540, 110.0, 0.0, -0.2, 0.4),\n    ]\n\n    results = []\n    for case in test_cases:\n        delta, r_cc, theta_deg, V1, V2, V3 = case\n        res = compute_case(delta, r_cc, theta_deg, V1, V2, V3)\n        # Format to a reasonable number of decimals for readability\n        res_fmt = [float(f\"{x:.6f}\") for x in res]\n        results.append(res_fmt)\n\n    # Final print statement in the exact required format.\n    print(f\"{results}\")\n\nif __name__ == \"__main__\":\n    solve()\n```"
        }
    ]
}