{
    "hands_on_practices": [
        {
            "introduction": "To truly grasp the Franck-Condon principle, we begin with a foundational pen-and-paper exercise. This practice requires you to derive the analytical expression for the $0 \\to 0$ transition's Franck-Condon factor, starting from the basic wavefunctions of two displaced harmonic oscillators. By working through the Gaussian integrals , you will connect the abstract concept of wavefunction overlap to a concrete formula dependent on key physical parameters like mass, frequency, and displacement, revealing how molecular geometry directly governs spectroscopic intensity.",
            "id": "2466970",
            "problem": "Consider a single normal mode of nuclear motion along a one-dimensional coordinate $x$ with reduced mass $m$. The lower and upper electronic states are both modeled as harmonic potentials with the same angular frequency $\\omega$ but different equilibrium positions. Specifically, the ground-state potential is $V_{\\mathrm{g}}(x) = \\tfrac{1}{2} m \\omega^{2} x^{2}$ and the excited-state potential is $V_{\\mathrm{e}}(x) = \\tfrac{1}{2} m \\omega^{2} (x - \\Delta x)^{2}$, where $\\Delta x$ is a constant displacement. Assume the Born–Oppenheimer (BO) approximation and the Condon approximation (the electronic transition dipole moment is independent of $x$), and neglect any Duschinsky rotation so that the normal mode is common to both electronic states.\n\nLet $|v=0\\rangle$ denote the vibrational ground state in $V_{\\mathrm{g}}(x)$ and $|v'=0\\rangle$ denote the vibrational ground state in $V_{\\mathrm{e}}(x)$. The Franck–Condon factor is defined as the squared magnitude of the overlap integral between these vibrational states, $F_{00} = |\\langle v'=0 \\mid v=0 \\rangle|^{2}$.\n\nStarting from the time-independent Schrödinger equation for each harmonic potential and the requirement that bound-state wavefunctions are square-integrable and normalized, derive a closed-form analytic expression for $F_{00}$ as a function of $m$, $\\omega$, $\\hbar$, and $\\Delta x$.\n\nYour final answer must be a single, closed-form analytic expression. No numerical evaluation or rounding is required. The Franck–Condon factor is dimensionless; do not include units in your final expression.",
            "solution": "The problem statement is subjected to validation.\n\nStep 1: Extract Givens\n- System: A single normal mode of nuclear motion along a one-dimensional coordinate $x$.\n- Reduced mass: $m$.\n- Ground-state potential: $V_{\\mathrm{g}}(x) = \\frac{1}{2} m \\omega^{2} x^{2}$.\n- Excited-state potential: $V_{\\mathrm{e}}(x) = \\frac{1}{2} m \\omega^{2} (x - \\Delta x)^{2}$.\n- Angular frequency: $\\omega$, identical for both electronic states.\n- Displacement: $\\Delta x$, a constant.\n- Approximations: Born-Oppenheimer (BO) approximation, Condon approximation, no Duschinsky rotation.\n- Vibrational states: $|v=0\\rangle$ is the vibrational ground state in $V_{\\mathrm{g}}(x)$; $|v'=0\\rangle$ is the vibrational ground state in $V_{\\mathrm{e}}(x)$.\n- Definition: The Franck–Condon factor is $F_{00} = |\\langle v'=0 \\mid v=0 \\rangle|^{2}$.\n- Objective: Derive a closed-form analytic expression for $F_{00}$ as a function of $m$, $\\omega$, $\\hbar$, and $\\Delta x$.\n\nStep 2: Validate Using Extracted Givens\nThe problem is scientifically grounded, as it concerns the standard and fundamental model of vibronic transitions between harmonic potential energy surfaces, a cornerstone of molecular spectroscopy and computational chemistry. It is well-posed, providing all necessary physical parameters ($m$, $\\omega$, $\\Delta x$) and established theoretical approximations (BO, Condon) to uniquely determine the Franck-Condon factor. The problem is stated with objective and precise language. It contains no scientific or logical contradictions, no missing information, and no ambiguities. It is a canonical problem in quantum mechanics.\n\nStep 3: Verdict and Action\nThe problem is valid. A rigorous solution will now be derived.\n\nThe derivation begins with the time-independent Schrödinger equation for a one-dimensional harmonic oscillator with reduced mass $m$, angular frequency $\\omega$, and equilibrium position $x_0$:\n$$\n-\\frac{\\hbar^2}{2m} \\frac{d^2\\psi(x)}{dx^2} + \\frac{1}{2}m\\omega^2(x-x_0)^2 \\psi(x) = E \\psi(x)\n$$\nThe normalized ground-state ($v=0$) wavefunction solution to this equation is a Gaussian function:\n$$\n\\psi_{v=0}(x; x_0) = \\left(\\frac{m\\omega}{\\pi\\hbar}\\right)^{1/4} \\exp\\left(-\\frac{m\\omega}{2\\hbar}(x-x_0)^2\\right)\n$$\nIn this problem, we have two such potentials.\n\nFor the ground electronic state, the potential is $V_{\\mathrm{g}}(x) = \\frac{1}{2} m \\omega^{2} x^{2}$, which is centered at $x_0 = 0$. The corresponding vibrational ground-state wavefunction, which we denote as $\\psi_0(x) \\equiv \\langle x | v=0 \\rangle$, is:\n$$\n\\psi_0(x) = \\left(\\frac{m\\omega}{\\pi\\hbar}\\right)^{1/4} \\exp\\left(-\\frac{m\\omega}{2\\hbar}x^2\\right)\n$$\nFor the excited electronic state, the potential is $V_{\\mathrm{e}}(x) = \\frac{1}{2} m \\omega^{2} (x - \\Delta x)^{2}$, which is centered at $x_0 = \\Delta x$. The corresponding vibrational ground-state wavefunction, which we denote as $\\psi'_{0}(x) \\equiv \\langle x | v'=0 \\rangle$, is:\n$$\n\\psi'_{0}(x) = \\left(\\frac{m\\omega}{\\pi\\hbar}\\right)^{1/4} \\exp\\left(-\\frac{m\\omega}{2\\hbar}(x-\\Delta x)^2\\right)\n$$\nThe Franck–Condon factor $F_{00}$ is the squared magnitude of the overlap integral between these two wavefunctions. The overlap integral, $S_{00} = \\langle v'=0 \\mid v=0 \\rangle$, is calculated in the position representation as:\n$$\nS_{00} = \\int_{-\\infty}^{\\infty} \\left(\\psi'_{0}(x)\\right)^* \\psi_0(x) \\,dx\n$$\nSince the wavefunctions are real, the complex conjugate $(\\psi'_{0}(x))^*$ is simply $\\psi'_{0}(x)$. Substituting the expressions for the wavefunctions yields:\n$$\nS_{00} = \\int_{-\\infty}^{\\infty} \\left[ \\left(\\frac{m\\omega}{\\pi\\hbar}\\right)^{1/4} \\exp\\left(-\\frac{m\\omega}{2\\hbar}(x-\\Delta x)^2\\right) \\right] \\left[ \\left(\\frac{m\\omega}{\\pi\\hbar}\\right)^{1/4} \\exp\\left(-\\frac{m\\omega}{2\\hbar}x^2\\right) \\right] \\,dx\n$$\nCombining the normalization constants and the exponential terms, we have:\n$$\nS_{00} = \\left(\\frac{m\\omega}{\\pi\\hbar}\\right)^{1/2} \\int_{-\\infty}^{\\infty} \\exp\\left[ -\\frac{m\\omega}{2\\hbar} \\left( (x-\\Delta x)^2 + x^2 \\right) \\right] \\,dx\n$$\nThe argument of the exponent must be simplified. We expand the quadratic terms:\n$$\n(x-\\Delta x)^2 + x^2 = (x^2 - 2x\\Delta x + (\\Delta x)^2) + x^2 = 2x^2 - 2x\\Delta x + (\\Delta x)^2\n$$\nTo solve the integral, we complete the square for the terms involving $x$:\n$$\n2x^2 - 2x\\Delta x + (\\Delta x)^2 = 2\\left(x^2 - x\\Delta x\\right) + (\\Delta x)^2 = 2\\left( \\left(x - \\frac{\\Delta x}{2}\\right)^2 - \\left(\\frac{\\Delta x}{2}\\right)^2 \\right) + (\\Delta x)^2\n$$\n$$\n= 2\\left(x - \\frac{\\Delta x}{2}\\right)^2 - \\frac{(\\Delta x)^2}{2} + (\\Delta x)^2 = 2\\left(x - \\frac{\\Delta x}{2}\\right)^2 + \\frac{(\\Delta x)^2}{2}\n$$\nSubstituting this back into the integral for $S_{00}$:\n$$\nS_{00} = \\left(\\frac{m\\omega}{\\pi\\hbar}\\right)^{1/2} \\int_{-\\infty}^{\\infty} \\exp\\left[ -\\frac{m\\omega}{2\\hbar} \\left( 2\\left(x - \\frac{\\Delta x}{2}\\right)^2 + \\frac{(\\Delta x)^2}{2} \\right) \\right] \\,dx\n$$\nThe term independent of $x$ can be factored out of the integral:\n$$\nS_{00} = \\left(\\frac{m\\omega}{\\pi\\hbar}\\right)^{1/2} \\exp\\left(-\\frac{m\\omega(\\Delta x)^2}{4\\hbar}\\right) \\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{m\\omega}{\\hbar}\\left(x - \\frac{\\Delta x}{2}\\right)^2\\right) \\,dx\n$$\nThe remaining integral is a standard Gaussian integral of the form $\\int_{-\\infty}^{\\infty} \\exp(-a(x-b)^2) \\,dx = \\sqrt{\\frac{\\pi}{a}}$. In our case, $a = \\frac{m\\omega}{\\hbar}$ and $b = \\frac{\\Delta x}{2}$. Therefore, the value of the integral is:\n$$\n\\int_{-\\infty}^{\\infty} \\exp\\left(-\\frac{m\\omega}{\\hbar}\\left(x - \\frac{\\Delta x}{2}\\right)^2\\right) \\,dx = \\sqrt{\\frac{\\pi}{m\\omega/\\hbar}} = \\sqrt{\\frac{\\pi\\hbar}{m\\omega}}\n$$\nSubstituting this result back into the expression for $S_{00}$:\n$$\nS_{00} = \\left(\\frac{m\\omega}{\\pi\\hbar}\\right)^{1/2} \\exp\\left(-\\frac{m\\omega(\\Delta x)^2}{4\\hbar}\\right) \\left(\\frac{\\pi\\hbar}{m\\omega}\\right)^{1/2}\n$$\nThe pre-factors cancel, leaving a remarkably simple expression for the overlap integral:\n$$\nS_{00} = \\exp\\left(-\\frac{m\\omega(\\Delta x)^2}{4\\hbar}\\right)\n$$\nFinally, the Franck-Condon factor $F_{00}$ is the squared magnitude of $S_{00}$. Since $S_{00}$ is a real quantity:\n$$\nF_{00} = |S_{00}|^2 = S_{00}^2 = \\left[ \\exp\\left(-\\frac{m\\omega(\\Delta x)^2}{4\\hbar}\\right) \\right]^2\n$$\nUsing the property $(\\exp(u))^2 = \\exp(2u)$, we obtain the final expression:\n$$\nF_{00} = \\exp\\left(-2 \\cdot \\frac{m\\omega(\\Delta x)^2}{4\\hbar}\\right) = \\exp\\left(-\\frac{m\\omega(\\Delta x)^2}{2\\hbar}\\right)\n$$\nThis is the closed-form analytic expression for the Franck-Condon factor for the $0-0$ transition between two displaced but otherwise identical harmonic oscillators.",
            "answer": "$$\\boxed{\\exp\\left(-\\frac{m\\omega(\\Delta x)^{2}}{2\\hbar}\\right)}$$"
        },
        {
            "introduction": "Moving from analytical theory to computational practice, we often work with wavefunctions that are not neat equations but numerical data on a grid. This exercise  challenges you to implement a numerical method to calculate the Franck-Condon factor from such grid-based wavefunctions. Mastering this technique is essential, as it mirrors how overlap integrals are computed in many real-world quantum chemistry programs and provides a robust tool for analyzing systems beyond simple analytical models.",
            "id": "2467014",
            "problem": "A one-dimensional (1D) vibrational coordinate $R$ is represented on a uniform grid by $N$ points $\\{R_k\\}_{k=0}^{N-1}$ spanning an interval $[R_{\\min},R_{\\max}]$. Two real-valued vibrational wavefunctions $\\chi_i(R)$ and $\\chi_f(R)$ are given on this grid as arrays $\\{\\chi_i(R_k)\\}$ and $\\{\\chi_f(R_k)\\}$. The Franck-Condon (FC) factor is the absolute square of the overlap integral,\n$$\nF = \\left|\\int_{R_{\\min}}^{R_{\\max}} \\chi_f^*(R)\\,\\chi_i(R)\\,dR\\right|^2,\n$$\nwhich, for real-valued functions, reduces to\n$$\nF = \\left(\\int_{R_{\\min}}^{R_{\\max}} \\chi_f(R)\\,\\chi_i(R)\\,dR\\right)^2.\n$$\nAssume that $\\chi_i(R)$ and $\\chi_f(R)$ are normalized over the real line in the sense of the usual $L^2$ norm. All quantities in this problem are dimensionless.\n\nYou are to write a complete, runnable program that numerically evaluates $F$ for a set of test cases where the vibrational wavefunctions are those of the dimensionless one-dimensional quantum harmonic oscillator (QHO). For a nonnegative integer quantum number $n$ and a displacement $\\Delta$, the normalized eigenfunction is\n$$\n\\psi_n(R;\\Delta) \\equiv \\frac{1}{\\sqrt{2^n\\,n!\\,\\sqrt{\\pi}}}\\,H_n(R-\\Delta)\\,e^{-\\frac{(R-\\Delta)^2}{2}},\n$$\nwhere $H_n(\\cdot)$ is the physicists’ Hermite polynomial of degree $n$. For each test case, take $\\chi_i(R)=\\psi_{n_i}(R;\\Delta_i)$ and $\\chi_f(R)=\\psi_{n_f}(R;\\Delta_f)$ sampled on the specified uniform grid.\n\nYour program must compute, for each test case, the Franck-Condon factor\n$$\nF = \\left|\\int_{R_{\\min}}^{R_{\\max}} \\chi_f(R)\\,\\chi_i(R)\\,dR\\right|^2\n$$\nby appropriately using the fact that the functions are given on a uniform grid. The final answers are pure numbers (no physical units). Express each reported result as a decimal rounded to $10$ decimal places.\n\nTest Suite (each case specifies $(R_{\\min},R_{\\max},N,n_i,\\Delta_i,n_f,\\Delta_f)$):\n- Case $1$: $(-10,\\,10,\\,20001,\\,0,\\,0,\\,0,\\,0)$.\n- Case $2$: $(-10,\\,10,\\,20001,\\,0,\\,0,\\,1,\\,0)$.\n- Case $3$: $(-10,\\,10,\\,20001,\\,0,\\,0,\\,0,\\,1)$.\n- Case $4$: $(-10,\\,10,\\,20001,\\,1,\\,0,\\,0,\\,1)$.\n- Case $5$: $(-12,\\,12,\\,24001,\\,0,\\,0,\\,0,\\,4)$.\n- Case $6$: $(-10,\\,10,\\,20001,\\,2,\\,1.5,\\,2,\\,1.5)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order of the cases above. For example, the output format must be\n$$\n[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4,\\text{result}_5,\\text{result}_6],\n$$\nwith each $\\text{result}_k$ rounded to $10$ decimal places. No other text should be printed.",
            "solution": "The problem statement is subjected to validation and is found to be scientifically grounded, well-posed, objective, and complete. It describes a standard computational task in theoretical spectroscopy: the calculation of Franck-Condon factors for displaced harmonic oscillators. All required parameters are specified, and the physical and mathematical formalism is correct. Therefore, a solution is warranted.\n\nThe central task is to compute the Franck-Condon ($FC$) factor, $F$, between an initial vibrational state $\\chi_i(R)$ and a final vibrational state $\\chi_f(R)$ along a one-dimensional coordinate $R$. The $FC$ factor is defined as the absolute square of the overlap integral between the two wavefunctions:\n$$ F = \\left| \\int \\chi_f^*(R) \\chi_i(R) dR \\right|^2 $$\nThe problem specifies that the wavefunctions are real-valued, which simplifies the expression to:\n$$ F = \\left( \\int \\chi_f(R) \\chi_i(R) dR \\right)^2 $$\nThe vibrational states are modeled as the eigenfunctions of the dimensionless one-dimensional quantum harmonic oscillator (QHO). The normalized wavefunction $\\psi_n(R; \\Delta)$ for a given integer quantum number $n \\ge 0$ and potential energy minimum displacement $\\Delta$ is given by:\n$$ \\psi_n(R; \\Delta) = \\frac{1}{\\sqrt{2^n n! \\sqrt{\\pi}}} H_n(R - \\Delta) e^{-\\frac{(R - \\Delta)^2}{2}} $$\nwhere $H_n(\\cdot)$ represents the physicists' Hermite polynomial of degree $n$. The initial and final states are thus $\\chi_i(R) = \\psi_{n_i}(R; \\Delta_i)$ and $\\chi_f(R) = \\psi_{n_f}(R; \\Delta_f)$, respectively.\n\nThe integral is evaluated numerically over a specified finite domain $[R_{\\min}, R_{\\max}]$, which is a valid approximation because the QHO wavefunctions decay exponentially to zero as $|R| \\to \\infty$. For the specified integration ranges and parameters, the contribution to the integral from outside the domain is negligible.\n\nThe numerical procedure is as follows:\n$1$. **Grid Generation**: For each test case defined by $(R_{\\min}, R_{\\max}, N, n_i, \\Delta_i, n_f, \\Delta_f)$, a uniform grid of $N$ points, denoted $\\{R_k\\}$, is constructed over the interval $[R_{\\min}, R_{\\max}]$. The grid spacing is $\\Delta R = (R_{\\max} - R_{\\min}) / (N - 1)$.\n\n$2$. **Wavefunction Evaluation**: The initial state $\\chi_i(R)$ and final state $\\chi_f(R)$ are evaluated at each point $R_k$ on the grid. This requires computing the Hermite polynomials $H_{n_i}$ and $H_{n_f}$, the corresponding normalization constants, and the exponential factors. The standard scientific library function `scipy.special.hermite` provides the necessary polynomials.\n\n$3$. **Numerical Integration**: The overlap integral, $I = \\int_{R_{\\min}}^{R_{\\max}} \\chi_f(R) \\chi_i(R) dR$, is computed numerically. First, the integrand array is formed by the element-wise product of the $\\chi_f$ and $\\chi_i$ arrays. Then, the trapezoidal rule is applied to this integrand array. This method is well-suited for a uniformly sampled function and is implemented efficiently in the `numpy.trapz` function. The integral is approximated as:\n$$ I \\approx \\sum_{k=0}^{N-2} \\frac{\\chi_f(R_{k+1})\\chi_i(R_{k+1}) + \\chi_f(R_k)\\chi_i(R_k)}{2} (R_{k+1} - R_k) $$\n\n$4$. **Final Calculation**: The Franck-Condon factor $F$ is obtained by squaring the result of the numerical integration, $F = I^2$. The result for each test case is then rounded to $10$ decimal places as required.\n\nThis entire procedure is implemented in the provided Python program. A helper function is defined to generate the QHO wavefunctions, and a main loop iterates through the test cases, performing the calculation for each one and collecting the results. The final output is formatted into a single line as specified.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import hermite, factorial\n\ndef solve():\n    \"\"\"\n    Solves the Franck-Condon factor problem for a given set of test cases.\n    \"\"\"\n\n    def qho_wavefunction(n: int, delta: float, r_grid: np.ndarray) -> np.ndarray:\n        \"\"\"\n        Calculates the normalized 1D Quantum Harmonic Oscillator (QHO) wavefunction.\n\n        Args:\n            n: The integer quantum number.\n            delta: The displacement of the oscillator potential.\n            r_grid: The 1D grid of points R.\n\n        Returns:\n            A numpy array representing the wavefunction values on the grid.\n        \"\"\"\n        # Physicists' Hermite polynomial of degree n\n        hermite_poly = hermite(n)\n        \n        # Argument for the polynomial and exponential\n        x = r_grid - delta\n        \n        # Use np.longdouble for precision in intermediate calculations for the constant\n        # Normalization constant squared is (2^n * n! * sqrt(pi))\n        norm_const_sq = np.power(np.longdouble(2), n) * factorial(n, exact=False) * np.sqrt(np.pi)\n        norm_const = 1.0 / np.sqrt(norm_const_sq)\n        \n        # Wavefunction psi_n(R; delta)\n        psi = norm_const * hermite_poly(x) * np.exp(-x**2 / 2.0)\n        \n        return psi.astype(np.float64)\n\n    # Test Suite (R_min, R_max, N, n_i, delta_i, n_f, delta_f)\n    test_cases = [\n        (-10, 10, 20001, 0, 0, 0, 0),\n        (-10, 10, 20001, 0, 0, 1, 0),\n        (-10, 10, 20001, 0, 0, 0, 1),\n        (-10, 10, 20001, 1, 0, 0, 1),\n        (-12, 12, 24001, 0, 0, 0, 4),\n        (-10, 10, 20001, 2, 1.5, 2, 1.5),\n    ]\n\n    results = []\n    for case in test_cases:\n        R_min, R_max, N, n_i, delta_i, n_f, delta_f = case\n        \n        # Create the uniform 1D grid for the coordinate R\n        R_grid = np.linspace(R_min, R_max, N, dtype=np.float64)\n        \n        # Generate the initial and final state wavefunctions on the grid\n        chi_i = qho_wavefunction(n_i, delta_i, R_grid)\n        chi_f = qho_wavefunction(n_f, delta_f, R_grid)\n        \n        # The integrand is the product of the final and initial wavefunctions\n        integrand = chi_f * chi_i\n        \n        # Calculate the overlap integral using the trapezoidal rule.\n        # np.trapz(y, x) is the most robust way to perform the integration.\n        overlap_integral = np.trapz(integrand, x=R_grid)\n        \n        # The Franck-Condon factor is the square of the overlap integral\n        fc_factor = overlap_integral**2\n        \n        # Round the result to 10 decimal places as required\n        results.append(f\"{fc_factor:.10f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Efficiency and numerical stability are paramount in computational science. While direct numerical integration is a general approach, for the common model of displaced harmonic oscillators, a far more elegant and efficient method exists. This practice  guides you to implement a recurrence relation that leverages the underlying Poissonian statistics of the Franck-Condon progression. This approach avoids the pitfalls of large numbers in factorials and powers, demonstrating how exploiting the mathematical structure of a problem leads to superior computational algorithms.",
            "id": "2467001",
            "problem": "A diatomic molecule is modeled as a single one-dimensional quantum harmonic oscillator along a single normal mode in two electronic states. The lower electronic state has vibrational eigenstates denoted by $|v\\rangle$, and the upper electronic state has vibrational eigenstates denoted by $|v'\\rangle$. Assume the following physical model: the harmonic frequencies in the two electronic states are identical, there is no mode mixing, and the Born-Oppenheimer and Condon approximations apply. The upper-state potential energy surface is displaced relative to the lower-state surface along the same normal coordinate by a real displacement that corresponds to a Huang–Rhys factor $S$ defined by $S = \\dfrac{m \\omega \\Delta Q^{2}}{2 \\hbar}$, where $m$ is the reduced mass, $\\omega$ is the angular frequency, $\\Delta Q$ is the displacement along the mass-weighted normal coordinate, and $\\hbar$ is the reduced Planck constant. Under these assumptions, the Franck–Condon factor for the vertical transition from the lower-state ground vibrational level $|v = 0\\rangle$ to an upper-state level $|v'\\rangle$ is $F_{v'} = |\\langle v'|0\\rangle|^2$.\n\nYour task is to write a complete program that, for each test case, takes as input a dimensionless Huang–Rhys factor $S$ and a nonnegative integer $N_{\\max}$, and returns the complete Franck–Condon progression $\\{F_{v'}\\}_{v' = 0}^{N_{\\max}}$, that is, all Franck–Condon factors from $v' = 0$ through $v' = N_{\\max}$ inclusive. All outputs must be real numbers and must be rounded to exactly $10$ decimal places. No physical units are required because $S$ is dimensionless.\n\nTest suite:\n- Case $1$: $S = 0.0$, $N_{\\max} = 8$.\n- Case $2$: $S = 0.75$, $N_{\\max} = 10$.\n- Case $3$: $S = 5.0$, $N_{\\max} = 14$.\n\nThe required final output format is a single line containing a list of lists, where the $k$-th inner list contains the sequence $\\big[F_{0}, F_{1}, \\dots, F_{N_{\\max}}\\big]$ for the $k$-th test case in the order listed above. Each number must be formatted as a decimal with exactly $10$ digits after the decimal point. For example, the output should have the form\n$[\\,[F_{0}^{(1)}, F_{1}^{(1)}, \\dots, F_{N_{\\max}^{(1)}}^{(1)}],[F_{0}^{(2)}, \\dots],[F_{0}^{(3)}, \\dots]\\,]$\nwith commas separating all entries and square brackets delimiting lists. The program must print exactly this single line as its only output.",
            "solution": "The problem requires the calculation of Franck–Condon factors, $F_{v'}$, for a vibronic transition between the ground vibrational level $|v=0\\rangle$ of a lower electronic state and a series of vibrational levels $|v'\\rangle$ of an upper electronic state. The system is modeled as a one-dimensional quantum harmonic oscillator.\n\nThe problem statement provides a set of simplifying, but standard, assumptions: the Born-Oppenheimer approximation, the Condon approximation, and identical harmonic frequencies ($\\omega' = \\omega$) for the two electronic states. The only structural difference between the two potential energy surfaces is a geometric displacement, $\\Delta Q$, along the normal coordinate. This displacement is quantified by the dimensionless Huang–Rhys factor, $S = \\frac{m \\omega \\Delta Q^2}{2 \\hbar}$.\n\nThe Franck–Condon factor for the transition $|0\\rangle \\to |v'\\rangle$ is defined by the squared modulus of the overlap integral between the initial and final vibrational wavefunctions:\n$$F_{v'} = |\\langle v'|0\\rangle|^2$$\nHere, $|0\\rangle$ is the ground state eigenfunction of the lower-state (undisplaced) harmonic oscillator, and $|v'\\rangle$ is the $v'$-th eigenfunction of the upper-state (displaced) harmonic oscillator.\n\nTo evaluate this overlap integral, we employ the operator formalism of quantum mechanics. Let the annihilation and creation operators for the lower-state oscillator be $a$ and $a^\\dagger$, respectively. The position operator is $\\hat{Q} = \\sqrt{\\frac{\\hbar}{2m\\omega}}(a + a^\\dagger)$. The upper-state potential is centered at $Q = \\Delta Q$. Its eigenstates, $|v'\\rangle$, are therefore displaced versions of the lower-state eigenstates, $|v\\rangle$. This spatial displacement is generated by the displacement operator, $D(\\alpha)$, where $\\alpha$ is a dimensionless parameter.\nThe relationship between the state vectors is $|v'\\rangle = D(\\alpha) |v'\\rangle_0$, where $|v'\\rangle_0$ denotes the eigenstate of the undisplaced Hamiltonian with quantum number $v'$. The displacement operator is given by:\n$$D(\\alpha) = \\exp(\\alpha a^\\dagger - \\alpha^* a)$$\nThe displacement parameter $\\alpha$ is related to the physical displacement $\\Delta Q$ by $\\alpha = \\sqrt{\\frac{m\\omega}{2\\hbar}}\\Delta Q$. Given that $\\Delta Q$ is a real-valued displacement, $\\alpha$ is also real. We can relate $\\alpha$ to the Huang–Rhys factor $S$:\n$$S = \\frac{m \\omega \\Delta Q^2}{2 \\hbar} = \\left(\\sqrt{\\frac{m\\omega}{2\\hbar}}\\Delta Q\\right)^2 = \\alpha^2$$\nThus, for a real displacement, we have $\\alpha = \\sqrt{S}$.\n\nThe overlap integral is now written as:\n$$\\langle v'|0\\rangle = \\langle v'|_0 D^\\dagger(\\alpha) |0\\rangle_0 = \\langle v'|_0 D(-\\alpha) |0\\rangle_0$$\nThe state $D(-\\alpha)|0\\rangle_0$ is a coherent state, denoted $|-\\alpha\\rangle$. The expansion of a coherent state $|\\beta\\rangle$ in the number-state basis $\\{|n\\rangle_0\\}$ is:\n$$|\\beta\\rangle = e^{-|\\beta|^2/2} \\sum_{n=0}^{\\infty} \\frac{\\beta^n}{\\sqrt{n!}} |n\\rangle_0$$\nSubstituting $\\beta = -\\alpha = -\\sqrt{S}$, we get:\n$$D(-\\alpha)|0\\rangle_0 = |-\\sqrt{S}\\rangle = e^{-S/2} \\sum_{n=0}^{\\infty} \\frac{(-\\sqrt{S})^n}{\\sqrt{n!}} |n\\rangle_0$$\nTaking the inner product with $\\langle v'|_0$ and using the orthonormality of the number states, $\\langle v'|_0 |n\\rangle_0 = \\delta_{v'n}$, we isolate the term for $n=v'$:\n$$\\langle v'|0\\rangle = e^{-S/2} \\frac{(-\\sqrt{S})^{v'}}{\\sqrt{v'!}}$$\nThe Franck–Condon factor is the squared magnitude of this amplitude:\n$$F_{v'} = \\left| e^{-S/2} \\frac{(-\\sqrt{S})^{v'}}{\\sqrt{v'!}} \\right|^2 = e^{-S} \\frac{S^{v'}}{v'!}$$\nThis result shows that the intensities of the vibronic progression follow a Poisson distribution with mean $S$. This is a fundamental result for the displaced harmonic oscillator model.\n\nFor computational implementation, directly calculating $S^{v'}$, $v'!$, and $e^{-S}$ is numerically unstable and inefficient, particularly for large $S$ or $v'$. A superior method is to use the recurrence relation derived from the formula for $F_{v'}$:\n$$F_{v'} = \\frac{e^{-S} S^{v'}}{v'!} = \\left(\\frac{e^{-S} S^{v'-1}}{(v'-1)!}\\right) \\frac{S}{v'} = F_{v'-1} \\cdot \\frac{S}{v'}$$\nThe progression can be calculated starting with the initial value for $v'=0$:\n$$F_0 = e^{-S} \\frac{S^0}{0!} = e^{-S}$$\nThen, for $v' = 1, 2, \\dots, N_{\\max}$, each subsequent factor is computed using $F_{v'} = F_{v'-1} \\cdot S/v'$. This iterative approach avoids large intermediate values and is both numerically stable and computationally efficient. The special case of $S=0$ yields $F_0 = 1$ and $F_{v'>0} = 0$, which is correctly handled by the recurrence.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates Franck-Condon progressions for given Huang-Rhys factors.\n    The Franck-Condon factor for a transition from v=0 to v' within the\n    displaced harmonic oscillator model (with equal frequencies) is given by\n    a Poisson distribution: F_v' = exp(-S) * S^v' / v'!, where S is the\n    Huang-Rhys factor.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (Huang-Rhys factor S, max vibrational quantum number N_max)\n        (0.0, 8),\n        (0.75, 10),\n        (5.0, 14),\n    ]\n\n    all_results = []\n    for s_factor, n_max in test_cases:\n        fc_progression = []\n        \n        # Calculate the progression using a stable recurrence relation:\n        # F_v' = F_{v'-1} * S / v'\n        # This avoids calculating large factorials and powers directly.\n        \n        # Initial term for v'=0\n        # F_0 = exp(-S) * S^0 / 0! = exp(-S)\n        current_f = np.exp(-s_factor)\n        fc_progression.append(current_f)\n        \n        # Iteratively calculate terms for v' = 1, 2, ..., N_max\n        if n_max > 0:\n            for v_prime in range(1, n_max + 1):\n                # The case S=0 is implicitly handled. If S=0, current_f will\n                # become 0 for v_prime=1 and remain 0.\n                current_f = current_f * s_factor / v_prime\n                fc_progression.append(current_f)\n        \n        all_results.append(fc_progression)\n\n    # Format the final output string according to the problem specification.\n    # The output must be a single line string representing a list of lists,\n    # with each number formatted to exactly 10 decimal places.\n    outer_list_strs = []\n    for result_list in all_results:\n        inner_list_strs = [f\"{val:.10f}\" for val in result_list]\n        outer_list_strs.append(f\"[{','.join(inner_list_strs)}]\")\n    \n    final_output_str = f\"[{','.join(outer_list_strs)}]\"\n    \n    # The program must print exactly this single line as its only output.\n    print(final_output_str)\n\nsolve()\n```"
        }
    ]
}