{
    "hands_on_practices": [
        {
            "introduction": "牵引分子动力学（SMD）的一个核心应用是从非平衡过程中提取平衡态的热力学性质。Jarzynski恒等式为此提供了坚实的理论基础，它将模拟中测得的不可逆功（$W$）与体系的平衡自由能变（$\\Delta G$）精确地联系起来。本练习将指导你如何直接应用这一定理，通过处理一组模拟产生的功的数据，来计算蛋白质去折叠过程中的自由能变化。",
            "id": "2455770",
            "problem": "给定一组旨在估算蛋白质可逆去折叠自由能变化的引导分子动力学拉伸功值。假设测量值代表在绝对温度 $T$ 下，每摩尔的可逆功，作为随机功的独立实现，记为 $W$。令可逆自由能差为 $\\Delta G$。对于每摩尔能量，连接非平衡功与平衡自由能的基本关系是由摩尔气体常数 $R$ 书写的 Jarzynski 等式：\n$$\ne^{-\\Delta G/(R\\,T)} \\;=\\; \\left\\langle e^{-W/(R\\,T)} \\right\\rangle,\n$$\n其中 $\\langle \\cdot \\rangle$ 表示对 $W$ 的所有实现的算术平均值。在本问题中，所有功值均以千焦每摩尔（$W$ 单位为 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$）给出，温度以开尔文（$T$ 单位为 $\\mathrm{K}$）给出。使用摩尔气体常数 $R = 8.31446261815324\\times 10^{-3}\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$。\n\n根据第一性原理，使用上述定义计算每种情况下的 $\\Delta G$。将每个 $\\Delta G$ 以 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$ 为单位表示，并精确到六位小数。\n\n测试集（每一项都是一个配对 $(T,\\{W_i\\})$）：\n- 情况 1：$T = 300\\,\\mathrm{K}$，$\\{W_i\\} = [\\,7.6,\\,8.1,\\,8.0,\\,7.9,\\,8.2,\\,7.8,\\,8.0,\\,8.1,\\,7.7,\\,8.0\\,]$ $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$。\n- 情况 2：$T = 300\\,\\mathrm{K}$，$\\{W_i\\} = [\\,18.0,\\,15.5,\\,16.2,\\,17.1,\\,14.8,\\,19.3,\\,13.9,\\,21.0,\\,12.5,\\,20.2,\\,11.0,\\,22.5\\,]$ $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$。\n- 情况 3：$T = 310\\,\\mathrm{K}$，$\\{W_i\\} = [\\,5.5\\,]$ $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$。\n- 情况 4：$T = 150\\,\\mathrm{K}$，$\\{W_i\\} = [\\,2.0,\\,2.5,\\,3.0,\\,2.2,\\,2.8\\,]$ $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$。\n- 情况 5：$T = 350\\,\\mathrm{K}$，$\\{W_i\\} = [\\,7.2,\\,7.2,\\,7.2,\\,7.2,\\,7.2,\\,7.2,\\,7.2,\\,7.2\\,]$ $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$。\n\n要求的最终输出格式：您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表。该列表必须按顺序包含上述五种情况的 $\\Delta G$ 值，每个值都格式化为小数点后恰好有六位数字的小数（例如，“[1.234000,2.000000,3.141593,4.000000,5.500000]”）。",
            "solution": "所提出的问题是 Jarzynski 等式的一个标准应用，这是非平衡统计力学中的一个基本结果。该问题在科学上是合理的、提法得当，并包含了解决该问题所需的所有信息。我将继续进行推导和求解。\n\n该问题要求从一组非平衡功测量值 $W$ 中计算平衡自由能差 $\\Delta G$。其主导原理是 Jarzynski 等式：\n$$\ne^{-\\Delta G/(R\\,T)} = \\left\\langle e^{-W/(R\\,T)} \\right\\rangle\n$$\n这里，$T$ 是绝对温度，$R$ 是摩尔气体常数。项 $\\langle \\cdot \\rangle$ 表示对非平衡过程所有可能实现的理论系综平均。在实际应用中，如此问题所提供的，该系综平均由 $N$ 个独立功测量值 $\\{W_1, W_2, \\ldots, W_N\\}$ 的有限样本的算术平均值来估计。因此，该等式的运算形式为：\n$$\ne^{-\\Delta G/(R\\,T)} \\approx \\frac{1}{N} \\sum_{i=1}^{N} e^{-W_i/(R\\,T)}\n$$\n为了求得 $\\Delta G$，我们必须解这个方程。推导过程很简单。首先，我们对两边取自然对数：\n$$\n\\ln\\left(e^{-\\Delta G/(R\\,T)}\\right) = \\ln\\left( \\frac{1}{N} \\sum_{i=1}^{N} e^{-W_i/(R\\,T)} \\right)\n$$\n简化后得到：\n$$\n-\\frac{\\Delta G}{R\\,T} = \\ln\\left( \\frac{1}{N} \\sum_{i=1}^{N} e^{-W_i/(R\\,T)} \\right)\n$$\n最后，两边乘以 $-RT$ 即可分离出 $\\Delta G$：\n$$\n\\Delta G = -R\\,T \\ln\\left( \\frac{1}{N} \\sum_{i=1}^{N} e^{-W_i/(R\\,T)} \\right)\n$$\n这就是计算自由能差的工作方程。\n\n注意到 $\\Delta G$ 和平均功 $\\langle W \\rangle = \\frac{1}{N} \\sum_{i=1}^{N} W_i$ 之间的关系是很有启发性的。因为指数函数 $f(x) = e^x$ 是凸函数，根据 Jensen 不等式，我们有 $\\langle e^x \\rangle \\ge e^{\\langle x \\rangle}$。将此应用于我们的情景，令 $x = -W/(RT)$，我们得到 $\\left\\langle e^{-W/(RT)} \\right\\rangle \\ge e^{\\langle -W/(RT) \\rangle} = e^{-\\langle W \\rangle/(RT)}$。将此代入 Jarzynski 等式，得出 $e^{-\\Delta G/(RT)} \\ge e^{-\\langle W \\rangle/(RT)}$，这意味着 $\\Delta G \\le \\langle W \\rangle$。自由能变总是小于或等于所做的平均功。等式 $\\Delta G = \\langle W \\rangle$ 仅在可逆过程的极限下成立，此时所有功值 $W_i$ 都是相同的。在情况 3 和情况 5 中可以观察到这一点。在所有其他情况下，过程是耗散的，并且 $\\Delta G  \\langle W \\rangle$。\n\n每个测试用例的计算过程如下：\n$1$. 给定温度 $T$ 和一组功值 $\\{W_i\\}$。摩尔气体常数的值固定为 $R = 8.31446261815324\\times 10^{-3}\\,\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\mathrm{K}^{-1}$。\n$2$. 计算热能积 $RT$。\n$3$. 对于集合中的每个功值 $W_i$，计算项 $e^{-W_i/(R\\,T)}$。\n$4$. 计算这些指数项的算术平均值。\n$5$. 计算该平均值的自然对数。\n$6$. 将结果乘以 $-RT$，得到以 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$ 为单位的 $\\Delta G$。\n$7$. 最终数值必须按要求四舍五入到六位小数。\n\n现在将实施此过程，以解决所提供的五种情况下的 $\\Delta G$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the reversible free energy change Delta G using the Jarzynski equality\n    for a given set of test cases.\n    \"\"\"\n    # Define the molar gas constant in kJ/(mol*K) as specified.\n    R_GAS_CONSTANT = 8.31446261815324e-3\n\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Case 1: T in K, list of W_i in kJ/mol\n        (300.0, [7.6, 8.1, 8.0, 7.9, 8.2, 7.8, 8.0, 8.1, 7.7, 8.0]),\n        # Case 2\n        (300.0, [18.0, 15.5, 16.2, 17.1, 14.8, 19.3, 13.9, 21.0, 12.5, 20.2, 11.0, 22.5]),\n        # Case 3\n        (310.0, [5.5]),\n        # Case 4\n        (150.0, [2.0, 2.5, 3.0, 2.2, 2.8]),\n        # Case 5\n        (350.0, [7.2, 7.2, 7.2, 7.2, 7.2, 7.2, 7.2, 7.2]),\n    ]\n\n    results = []\n    for T, W_values in test_cases:\n        # Convert work values to a NumPy array for vectorized operations.\n        W_array = np.array(W_values, dtype=np.float64)\n        \n        # Calculate the thermal energy product RT.\n        RT = R_GAS_CONSTANT * T\n        \n        # Jarzynski equality states: exp(-DeltaG / RT) ="
        },
        {
            "introduction": "除了热力学性质，SMD模拟还能揭示分子相互作用的动力学信息。实验中测得的破裂力（rupture force）与施加外力的速率有关，而Bell-Evans模型精确描述了这一关系。该模型使我们能够从不同拉伸速度下的力谱数据中，外推出零力作用下的解离速率（$k_{\\mathrm{off}}$），这是一个关键的动力学参数。本练习将引导你应用该模型，从模拟数据中提取配体结合的内在动力学信息。",
            "id": "2463111",
            "problem": "在引导分子动力学（SMD）模拟中，一个配体被一个劲度系数为 $k_{s}$ 的谐波导向势以恒定速度 $v$ 从结合口袋中拉出。模拟温度为 $T$，玻尔兹曼常数为 $k_{B}$。对于恒加载率 $r = k_{s} v$ 的变力条件，Bell–Evans 模型指出，对于越过距离过渡态为 $x^{\\ddagger}$ 处单个能垒的逃逸，其最可几断裂力 $F^{\\ast}$ 和零力脱离速率 $k_{\\mathrm{off}}$ 满足\n$$\nF^{\\ast} = \\frac{k_{B} T}{x^{\\ddagger}} \\ln\\!\\left(\\frac{r\\, x^{\\ddagger}}{k_{B} T\\, k_{\\mathrm{off}}}\\right).\n$$\n假设在所探测的加载率范围内 $x^{\\ddagger}$ 是恒定的。\n\n你进行了两组SMD拉伸实验，使用相同的弹簧劲度系数 $k_{s}$ 但不同的平台速度 $v$，并通过多次重复实验确定了每个速度下的最可几断裂力。参数如下：\n- $k_{s} = 0.05\\,\\mathrm{N\\,m^{-1}}$，\n- $T = 300\\,\\mathrm{K}$，\n- $k_{B} = 1.380649\\times 10^{-23}\\,\\mathrm{J\\,K^{-1}}$，\n- 在 $v_{1} = 1.0\\times 10^{-7}\\,\\mathrm{m\\,s^{-1}}$ 时，最可几断裂力为 $F_{1}^{\\ast} = 45\\,\\mathrm{pN}$，\n- 在 $v_{2} = 1.0\\times 10^{-6}\\,\\mathrm{m\\,s^{-1}}$ 时，最可几断裂力为 $F_{2}^{\\ast} = 55\\,\\mathrm{pN}$。\n\n使用 Bell–Evans 模型，计算零力脱离速率 $k_{\\mathrm{off}}$。将最终答案四舍五入至三位有效数字，并以 $\\mathrm{s^{-1}}$ 为单位表示。",
            "solution": "所述问题具有科学依据，是适定且客观的。它基于已建立的用于分析力致断裂事件的 Bell–Evans 模型，这是计算化学和生物物理学领域的标准方法。所有提供的数据在物理上都是现实的，并且量纲一致。因此，该问题被认为是有效的，并将提供解答。\n\n最可几断裂力 $F^{\\ast}$ 由 Bell–Evans 模型给出：\n$$\nF^{\\ast} = \\frac{k_{B} T}{x^{\\ddagger}} \\ln\\!\\left(\\frac{r\\, x^{\\ddagger}}{k_{B} T\\, k_{\\mathrm{off}}}\\right)\n$$\n其中加载率 $r = k_{s} v$。问题提供了两组测量值 $(v_1, F_1^{\\ast})$ 和 $(v_2, F_2^{\\ast})$，该方程对这两组值都必须成立。这产生了一个包含两个未知数（到过渡态的距离 $x^{\\ddagger}$ 和零力脱离速率 $k_{\\mathrm{off}}$）的二元方程组。具体方程如下：\n$$\nF_{1}^{\\ast} = \\frac{k_{B} T}{x^{\\ddagger}} \\ln\\!\\left(\\frac{k_{s} v_1 x^{\\ddagger}}{k_{B} T\\, k_{\\mathrm{off}}}\\right) \\quad (1)\n$$\n$$\nF_{2}^{\\ast} = \\frac{k_{B} T}{x^{\\ddagger}} \\ln\\!\\left(\\frac{k_{s} v_2 x^{\\ddagger}}{k_{B} T\\, k_{\\mathrm{off}}}\\right) \\quad (2)\n$$\n为求解该方程组，我们首先消去 $k_{\\mathrm{off}}$ 以求出 $x^{\\ddagger}$。我们通过分离对数项来重排两个方程：\n$$\n\\frac{F_{1}^{\\ast} x^{\\ddagger}}{k_{B} T} = \\ln\\!\\left(\\frac{k_{s} v_1 x^{\\ddagger}}{k_{B} T\\, k_{\\mathrm{off}}}\\right)\n$$\n$$\n\\frac{F_{2}^{\\ast} x^{\\ddagger}}{k_{B} T} = \\ln\\!\\left(\\frac{k_{s} v_2 x^{\\ddagger}}{k_{B} T\\, k_{\\mathrm{off}}}\\right)\n$$\n将第一个重排后的方程从第二个中减去，得到：\n$$\n\\frac{(F_{2}^{\\ast} - F_{1}^{\\ast}) x^{\\ddagger}}{k_{B} T} = \\ln\\!\\left(\\frac{k_{s} v_2 x^{\\ddagger}}{k_{B} T\\, k_{\\mathrm{off}}}\\right) - \\ln\\!\\left(\\frac{k_{s} v_1 x^{\\ddagger}}{k_{B} T\\, k_{\\mathrm{off}}}\\right)\n$$\n使用对数性质 $\\ln(a) - \\ln(b) = \\ln(a/b)$，右侧简化为：\n$$\n\\frac{(F_{2}^{\\ast} - F_{1}^{\\ast}) x^{\\ddagger}}{k_{B} T} = \\ln\\!\\left(\\frac{k_{s} v_2 x^{\\ddagger} / (k_{B} T\\, k_{\\mathrm{off}})}{k_{s} v_1 x^{\\ddagger} / (k_{B} T\\, k_{\\mathrm{off}})}\\right) = \\ln\\!\\left(\\frac{v_2}{v_1}\\right)\n$$\n现在我们可以直接解出 $x^{\\ddagger}$，因为已假设其为常数：\n$$\nx^{\\ddagger} = \\frac{k_{B} T}{F_{2}^{\\ast} - F_{1}^{\\ast}} \\ln\\!\\left(\\frac{v_2}{v_1}\\right)\n$$\n有了 $x^{\\ddagger}$ 的表达式，我们就可以求解 $k_{\\mathrm{off}}$。我们重排方程 $(1)$ 以分离出 $k_{\\mathrm{off}}$，首先对其重排后的形式两边取指数：\n$$\n\\exp\\left(\\frac{F_{1}^{\\ast} x^{\\ddagger}}{k_{B} T}\\right) = \\frac{k_{s} v_1 x^{\\ddagger}}{k_{B} T\\, k_{\\mathrm{off}}}\n$$\n$$\nk_{\\mathrm{off}} = \\frac{k_{s} v_1 x^{\\ddagger}}{k_{B} T} \\exp\\left(-\\frac{F_{1}^{\\ast} x^{\\ddagger}}{k_{B} T}\\right)\n$$\n代入推导出的 $x^{\\ddagger}$ 表达式：\n$$\nk_{\\mathrm{off}} = \\frac{k_{s} v_1}{k_{B} T} \\left( \\frac{k_{B} T}{F_{2}^{\\ast} - F_{1}^{\\ast}} \\ln\\!\\left(\\frac{v_2}{v_1}\\right) \\right) \\exp\\left( -\\frac{F_{1}^{\\ast}}{k_{B} T} \\left( \\frac{k_{B} T}{F_{2}^{\\ast} - F_{1}^{\\ast}} \\ln\\!\\left(\\frac{v_2}{v_1}\\right) \\right) \\right)\n$$\n简化此表达式可得到 $k_{\\mathrm{off}}$ 的最终解析形式：\n$$\nk_{\\mathrm{off}} = \\frac{k_{s} v_1}{F_{2}^{\\ast} - F_{1}^{\\ast}} \\ln\\!\\left(\\frac{v_2}{v_1}\\right) \\exp\\left( -\\frac{F_{1}^{\\ast}}{F_{2}^{\\ast} - F_{1}^{\\ast}} \\ln\\!\\left(\\frac{v_2}{v_1}\\right) \\right)\n$$\n该表达式也可以更紧凑地写为：\n$$\nk_{\\mathrm{off}} = \\frac{k_{s} v_1 \\ln(v_2/v_1)}{F_{2}^{\\ast} - F_{1}^{\\ast}} \\left(\\frac{v_2}{v_1}\\right)^{-\\frac{F_{1}^{\\ast}}{F_{2}^{\\ast} - F_{1}^{\\ast}}}\n$$\n现在我们代入给定的数值，确保所有单位均为国际单位制（SI）：\n$k_{s} = 0.05\\,\\mathrm{N\\,m^{-1}}$\n$v_1 = 1.0 \\times 10^{-7}\\,\\mathrm{m\\,s^{-1}}$\n$v_2 = 1.0 \\times 10^{-6}\\,\\mathrm{m\\,s^{-1}}$\n$F_1^{\\ast} = 45\\,\\mathrm{pN} = 45 \\times 10^{-12}\\,\\mathrm{N}$\n$F_2^{\\ast} = 55\\,\\mathrm{pN} = 55 \\times 10^{-12}\\,\\mathrm{N}$\n\n我们计算必要的组成部分：\n$F_{2}^{\\ast} - F_{1}^{\\ast} = (55 - 45) \\times 10^{-12}\\,\\mathrm{N} = 10 \\times 10^{-12}\\,\\mathrm{N} = 10^{-11}\\,\\mathrm{N}$\n$\\frac{v_2}{v_1} = \\frac{1.0 \\times 10^{-6}}{1.0 \\times 10^{-7}} = 10$\n$\\frac{F_{1}^{\\ast}}{F_{2}^{\\ast} - F_{1}^{\\ast}} = \\frac{45 \\times 10^{-12}}{10 \\times 10^{-12}} = 4.5$\n\n将这些值代入 $k_{\\mathrm{off}}$ 的表达式中：\n$$\nk_{\\mathrm{off}} = \\frac{(0.05\\,\\mathrm{N\\,m^{-1}}) (1.0 \\times 10^{-7}\\,\\mathrm{m\\,s^{-1}})}{10^{-11}\\,\\mathrm{N}} \\ln(10) \\left(10\\right)^{-4.5}\n$$\n$$\nk_{\\mathrm{off}} = \\frac{5 \\times 10^{-9}}{10^{-11}} \\ln(10) \\cdot 10^{-4.5} \\,\\mathrm{s^{-1}}\n$$\n$$\nk_{\\mathrm{off}} = 500 \\cdot \\ln(10) \\cdot 10^{-4.5} \\,\\mathrm{s^{-1}}\n$$\n我们计算其数值：\n$$\nk_{\\mathrm{off}} = 500 \\times (2.302585...) \\times (3.162277... \\times 10^{-5}) \\,\\mathrm{s^{-1}}\n$$\n$$\nk_{\\mathrm{off}} \\approx 1151.29 \\times 3.162277 \\times 10^{-5} \\,\\mathrm{s^{-1}} \\approx 0.036423\\,\\mathrm{s^{-1}}\n$$\n根据题目要求，将结果四舍五入至三位有效数字，我们得到：\n$$\nk_{\\mathrm{off}} \\approx 3.64 \\times 10^{-2}\\,\\mathrm{s^{-1}}\n$$",
            "answer": "$$\n\\boxed{3.64 \\times 10^{-2}}\n$$"
        },
        {
            "introduction": "SMD模拟结果的可靠性在很大程度上取决于模拟方案的设置，尤其是拉伸速度。本练习将让你从数据分析者转变为模拟构建者，通过一个简化的模型亲手实现SMD过程。通过在不同速度下拉伸一个处于莫尔斯势阱中的粒子，你将直接观察到过快的拉伸速度如何导致“破裂力伪影”——此时测得的力主要反映的是粘滞阻力，而非体系内在的结合能。理解这一点对于设计和解读任何SMD实验都至关重要。",
            "id": "2463081",
            "problem": "单一集体坐标 $x(t)$ 描述了配体沿拉伸轴与受体分离的过程。配体受到一个内在的结合势 $U(x)$ 以及一个随时间变化的外加载荷，该载荷来自于一个谐振子弹簧，其锚点以恒定速度 $v$ 移动。在零温度（确定性极限）的朗之万动力学过阻尼极限下，$x(t)$ 的演化由力平衡方程决定\n$$\n\\gamma \\,\\frac{dx}{dt} \\;=\\; -\\,\\frac{dU}{dx}(x) \\;-\\; k_s\\bigl(x - x_s(t)\\bigr),\n$$\n其中 $\\gamma$ 是摩擦系数，$k_s$ 是弹簧常数，$x_s(t) = v\\,t$ 是拉伸平台的位置。测得的力是弹簧力\n$$\nF_{\\text{spring}}(t) \\;=\\; k_s\\,\\bigl(x(t) - x_s(t)\\bigr),\n$$\n其大小 $\\lvert F_{\\text{spring}}(t)\\rvert$ 在拉伸过程中通常会显示一个峰值（“断裂力”）。\n\n你将使用深度为 $\\varepsilon$、范围参数为 $a$ 的莫尔斯势阱来模拟结合势，\n$$\nU(x) \\;=\\; \\varepsilon\\left[\\left(1 - e^{-a x}\\right)^2 - 1\\right],\n$$\n该势在 $x = 0$ 处有最小值 $U(0) = -\\varepsilon$，并且当 $x\\to +\\infty$ 时 $U(x)\\to 0$。根据此定义，结合态最小值与未结合态基线之间的平衡结合自由能差为 $\\Delta F = \\varepsilon$。\n\n从过阻尼力平衡和弹簧力的定义出发，推导一个适用于零温度过阻尼条件下稳定时间步长的数值方案，并实现一个程序来完成以下任务。\n\n1) 使用以下物理上一致的参数和单位：\n- 长度单位为纳米（nm），时间单位为皮秒（ps），力单位为皮牛（pN），能量单位为 pN·nm。\n- 温度固定在 $0$ K（确定性极限）。\n- 摩擦系数 $\\gamma = 5000$ pN·ps/nm。\n- 弹簧常数 $k_s = 100$ pN/nm。\n- 莫尔斯范围参数 $a = 6$ nm$^{-1}$。\n- 结合深度 $\\varepsilon \\in \\{\\varepsilon_i\\}_{i=1}^{4}$，其值为 $\\varepsilon_1 = 10$ pN·nm, $\\varepsilon_2 = 20$ pN·nm, $\\varepsilon_3 = 30$ pN·nm, $\\varepsilon_4 = 40$ pN·nm。\n- 初始条件 $x(0) = 0$ nm 且 $x_s(0) = 0$ nm。\n- 时间步长 $\\Delta t = 0.001$ ps，总模拟时间 $T = 50$ ps。\n\n2) 对于每个深度 $\\varepsilon_i$，对运动方程进行积分以获得 $x(t)$，并计算整个轨迹上弹簧力的最大值，\n$$\nF_{\\max}(v;\\varepsilon_i) \\;=\\; \\max_{t\\in[0,T]} \\lvert F_{\\text{spring}}(t)\\rvert.\n$$\n\n3) 考虑包含三种拉伸速度 $v$ 的测试套件：\n- 准绝热情况 $v_1 = 0.01$ nm/ps（慢速），\n- 非平衡情况 $v_2 = 0.05$ nm/ps（中速），\n- 强非平衡情况 $v_3 = 0.50$ nm/ps（快速）。\n\n对于每个 $v_j$，评估平衡结合自由能列表 $\\bigl[\\Delta F_i\\bigr]_{i=1}^{4} = \\bigl[\\varepsilon_i\\bigr]_{i=1}^{4}$ 与相应断裂力列表 $\\bigl[F_{\\max}(v_j;\\varepsilon_i)\\bigr]_{i=1}^{4}$ 之间的皮尔逊线性相关系数。\n\n4) 你的程序必须输出一行，其中包含 $v_1$、$v_2$ 和 $v_3$ 的三个相关系数，按此顺序排列，形式为用方括号括起来的逗号分隔列表。例如，打印的行应类似于“[c1,c2,c3]”，其中每个 $c_j$ 是一个浮点数。不应有多余的空格或文本。输出中不应出现百分比；相关系数是无单位的纯数字。\n\n科学真实性要求：\n- 你的推导应基于过阻尼极限下的牛顿力学和弹簧的胡克定律。莫尔斯势是具有单极小值的短程结合的标准选择。所选参数与计算化学中使用的纳米–皮秒–皮牛顿单位系统一致。\n- 数值积分必须从控制方程中得到合理解释，并且在量纲上保持一致。\n- 将最终的相关系数表示为无量纲的浮点数。\n\n测试套件覆盖要求：\n- 慢速情况 $v_1$ 作为“理想路径”，更接近可逆拉伸，其中 $\\lvert F_{\\max}\\rvert$ 应受 $\\Delta F$ 影响。\n- 中速情况 $v_2$ 探测一个过渡区域。\n- 快速情况 $v_3$ 是一个旨在展示“断裂力伪影”的边缘案例，其中 $\\lvert F_{\\max}\\rvert$ 可能由粘性项主导，并失去与 $\\Delta F$ 的相关性。\n\n程序应生成一行输出，包含三个相关系数，形式为用方括号括起来的逗号分隔列表。输出中不应出现百分比；相关系数是无单位的纯数字。",
            "solution": "问题陈述已经过验证，被认为是科学上合理、问题明确且完整的。它描述了确定性过阻尼极限下力探针分子动力学的经典模型。我们现在将推导数值解法。\n\n该问题要求在内在势 $U(x)$ 和随时间变化的外部谐波约束的影响下，对集体坐标 $x(t)$ 的运动方程进行数值积分。在零温度的过阻尼状态下，控制方程由力平衡给出：\n$$\n\\gamma \\frac{dx}{dt} = F_{\\text{intrinsic}}(x) + F_{\\text{external}}(x, t)\n$$\n其中 $\\gamma$ 是摩擦系数。力的分量是：\n1.  源自莫尔斯势的内禀力，$F_{\\text{intrinsic}}(x) = -\\frac{dU}{dx}(x)$。\n2.  来自移动弹簧的外力，$F_{\\text{external}}(x, t) = -k_s(x - x_s(t))$。\n\n莫尔斯势给出为 $U(x) = \\varepsilon\\left[\\left(1 - e^{-a x}\\right)^2 - 1\\right]$。它对 $x$ 的导数是：\n$$\n\\frac{dU}{dx}(x) = \\varepsilon \\cdot 2(1 - e^{-ax}) \\cdot \\frac{d}{dx}(1 - e^{-ax}) = 2a\\varepsilon(e^{-ax} - e^{-2ax})\n$$\n外部弹簧的锚点以恒定速度 $v$ 移動，因此其位置为 $x_s(t) = v t$。将这些表达式代入运动方程可得：\n$$\n\\gamma \\frac{dx}{dt} = -2a\\varepsilon(e^{-ax} - e^{-2ax}) - k_s(x - vt)\n$$\n为了便于数值积分，我们将此一阶常微分方程重排为标准形式 $\\frac{dx}{dt} = f(x, t)$：\n$$\n\\frac{dx}{dt} = \\frac{1}{\\gamma} \\left[ -2a\\varepsilon(e^{-ax} - e^{-2ax}) - k_s(x - vt) \\right]\n$$\n我们将使用前向欧拉法来求解此方程，这是一种简单且显式的时间步进格式。对于一个时间步长 $\\Delta t$，时刻 $t + \\Delta t$ 的位置可以通过时刻 $t$ 的位置和速度来近似：\n$$\nx(t + \\Delta t) \\approx x(t) + \\Delta t \\cdot \\frac{dx}{dt}\\bigg|_t\n$$\n令 $x_i = x(t_i)$，其中 $t_i = i\\Delta t$。更新规则为：\n$$\nx_{i+1} = x_i + \\frac{\\Delta t}{\\gamma} \\left[ -2a\\varepsilon(e^{-ax_i} - e^{-2ax_i}) - k_s(x_i - v t_i) \\right]\n$$\n该方案的稳定性取决于 $\\Delta t$ 相对于系统特征弛豫时间的大小。总势能 $U_{\\text{tot}}(x, t) = U(x) + \\frac{1}{2}k_s(x-vt)^2$ 的有效刚度为 $k_{\\text{eff}} = \\frac{d^2 U}{dx^2} + k_s$。莫尔斯势的刚度 $\\frac{d^2 U}{dx^2} = 2a^2\\varepsilon(2e^{-2ax} - e^{-ax})$ 在 $x=0$ 处达到最大值，即 $k_{\\text{morse,max}} = 2a^2\\varepsilon$。对于最大值 $\\varepsilon = 40$ pN·nm 和 $a = 6$ nm$^{-1}$，该值为 $k_{\\text{morse,max}} = 2 \\cdot (6)^2 \\cdot 40 = 2880$ pN/nm。总刚度约为 $k_{\\text{eff,max}} \\approx 2880 + k_s = 2880 + 100 = 2980$ pN/nm。因此，系统中最快的弛豫时间为 $\\tau_{\\text{min}} = \\gamma / k_{\\text{eff,max}} \\approx 5000 / 2980 \\approx 1.68$ ps。指定的时间步长 $\\Delta t = 0.001$ ps 比这个最快的时间尺度小三个数量级以上（$\\Delta t \\ll \\tau_{\\text{min}}$）。因此，前向欧拉法对于此问题保证是稳定和准确的。\n\n模拟协议如下。对于每个拉伸速度 $v \\in \\{0.01, 0.05, 0.50\\}$ nm/ps，我们进行一系列模拟，每个结合能 $\\varepsilon \\in \\{10, 20, 30, 40\\}$ pN·nm 对应一次模拟。\n对于每一对 $(v, \\varepsilon)$：\n1.  在 $t=0$ 时初始化系统，令 $x(0)=0$。\n2.  从 $t=0$ 到 $T=50$ ps，以时间步长 $\\Delta t = 0.001$ ps 进行迭代。在每一步 $i$ 中：\n    a. 计算当前时间 $t_i = i \\Delta t$。\n    b. 使用上面推导的欧拉公式将粒子位置从 $x_i$ 更新到 $x_{i+1}$。\n    c. 计算新位置和新时间的弹簧力：$F_{\\text{spring}}(t_{i+1}) = k_s(x_{i+1} - v t_{i+1})$。\n3.  生成轨迹后，确定弹簧力的最大值：$F_{\\max}(v; \\varepsilon) = \\max_{t \\in [0, T]} |F_{\\text{spring}}(t)|$。\n\n在获得给定速度 $v$ 下的断裂力列表 $[F_{\\max}(v; \\varepsilon_1), F_{\\max}(v; \\varepsilon_2), F_{\\max}(v; \\varepsilon_3), F_{\\max}(v; \\varepsilon_4)]$ 后，我们计算此列表与相应结合自由能列表 $[\\Delta F_i] = [\\varepsilon_i]$ 之间的皮尔逊线性相关系数 $\\rho$。具有 $N$ 个样本的两个变量 $X$ 和 $Y$ 之间的皮尔逊相关系数定义为：\n$$\n\\rho_{X,Y} = \\frac{\\sum_{i=1}^N (X_i - \\bar{X})(Y_i - \\bar{Y})}{\\sqrt{\\sum_{i=1}^N (X_i - \\bar{X})^2} \\sqrt{\\sum_{i=1}^N (Y_i - \\bar{Y})^2}}\n$$\n其中 $\\bar{X}$ 和 $\\bar{Y}$ 是样本均值。对三种拉伸速度中的每一种重复此过程，从而得到三个相关系数。整个过程的实现见下一节。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the steered molecular dynamics problem to find the correlation\n    between binding energy and rupture force at different pulling speeds.\n    \"\"\"\n    \n    # 1) Define physically consistent parameters and units\n    # Length in nm, time in ps, force in pN, energy in pN·nm\n    gamma = 5000.0  # Friction coefficient (pN·ps/nm)\n    k_s = 100.0     # Spring constant (pN/nm)\n    a = 6.0         # Morse range parameter (nm⁻¹)\n    \n    # Binding depths epsilon (pN·nm)\n    epsilons = np.array([10.0, 20.0, 30.0, 40.0])\n    \n    # Time parameters\n    dt = 0.001      # Time step (ps)\n    T = 50.0        # Total simulation time (ps)\n    \n    # Initial conditions\n    x0 = 0.0        # Initial position (nm)\n    \n    # 3) Test suite of pulling speeds\n    velocities = [0.01, 0.05, 0.50]  # Pulling speeds (nm/ps)\n\n    # List to store the correlation coefficients\n    correlation_results = []\n    \n    # Calculate number of steps\n    num_steps = int(T / dt)\n    \n    # Main simulation loop\n    for v in velocities:\n        max_forces = []\n        \n        for epsilon in epsilons:\n            # Initialize arrays for position and time\n            x = np.zeros(num_steps + 1)\n            t = np.linspace(0, T, num_steps + 1)\n            \n            x[0] = x0\n            \n            # Array to store spring force magnitude\n            spring_force_magnitudes = np.zeros(num_steps + 1)\n            # Initial spring force is zero\n            spring_force_magnitudes[0] = 0.0\n            \n            # 2) Integrate the equation of motion\n            for i in range(num_steps):\n                # Force from Morse potential\n                force_morse = -2.0 * a * epsilon * (np.exp(-a * x[i]) - np.exp(-2.0 * a * x[i]))\n                \n                # Position of the spring anchor\n                x_s = v * t[i]\n                \n                # Force from the spring on the particle\n                force_spring_on_particle = -k_s * (x[i] - x_s)\n                \n                # Total force on the particle\n                total_force = force_morse + force_spring_on_particle\n                \n                # Update position using Forward Euler method\n                x[i+1] = x[i] + (total_force / gamma) * dt\n                \n                # Calculate the measured spring force F_spring(t) = k_s * (x(t) - x_s(t))\n                # Note: t[i+1] corresponds to the time for x[i+1]\n                x_s_next = v * t[i+1]\n                f_spring = k_s * (x[i+1] - x_s_next)\n                \n                # Store its magnitude\n                spring_force_magnitudes[i+1] = np.abs(f_spring)\n\n            # Find the maximum magnitude of the spring force (rupture force)\n            F_max = np.max(spring_force_magnitudes)\n            max_forces.append(F_max)\n        \n        # 3) Evaluate the Pearson linear correlation coefficient\n        # Note: binding free energy Delta_F is equal to epsilon\n        correlation_matrix = np.corrcoef(epsilons, max_forces)\n        correlation = correlation_matrix[0, 1]\n        correlation_results.append(correlation)\n        \n    # 4) Output the results in the specified format\n    # Example format: \"[c1,c2,c3]\"\n    print(f\"[{','.join(map(str, correlation_results))}]\")\n\nsolve()\n```"
        }
    ]
}