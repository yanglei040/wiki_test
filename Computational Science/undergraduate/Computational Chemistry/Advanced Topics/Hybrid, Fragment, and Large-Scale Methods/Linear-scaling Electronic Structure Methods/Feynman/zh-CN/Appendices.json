{
    "hands_on_practices": [
        {
            "introduction": "线性标度方法的核心思想是通过忽略对整体结果影响微乎其微的相互作用来降低计算成本。对于传统的 Hartree-Fock 方法，计算瓶颈在于处理数量上以 $O(N^4)$ 增长的双电子积分。这个练习将带你亲手体验一个简化的积分筛选过程，通过一个基于距离的直观规则，你将决定在一个简单的四氢原子模型中哪些积分是重要的，哪些可以被安全地忽略，从而对线性标度方法中的“筛选”技术建立起具体而深入的理解 。",
            "id": "2457312",
            "problem": "考虑一个受线性标度电子结构方法启发的模型筛选程序，该程序应用于一个在定域 $1s$ 原子轨道 (AO) 最小基组中描述的正方形 $\\text{H}_4$ 团簇。四个氢原子核固定在笛卡尔坐标（长度单位任意）$\\mathbf{R}_1=(0,0,0)$、$\\mathbf{R}_2=(L,0,0)$、$\\mathbf{R}_3=(L,L,0)$ 和 $\\mathbf{R}_4=(0,L,0)$ 处，其中 $L>0$。令 $(\\mu\\nu|\\lambda\\sigma)$ 表示一个采用化学家记法的双电子库仑排斥积分，该积分涉及以 $\\mu,\\nu,\\lambda,\\sigma \\in \\{1,2,3,4\\}$ 为索引的原子核为中心的原子轨道。\n\n你需要将以下纯粹基于距离的筛选规则应用于所有 $(\\mu\\nu|\\lambda\\sigma)$ 积分的完整有序列表（即全部 $4^4$ 个有序四元组）：\n\n1. 电子对紧凑性条件：对于一对原子轨道指数 $(\\mu,\\nu)$，定义其中心间距为 $d_{\\mu\\nu}=\\|\\mathbf{R}_\\mu-\\mathbf{R}_\\nu\\|$。如果 $d_{\\mu\\nu}\\le r_p$，其中 $r_p=L$，则该电子对 $(\\mu,\\nu)$ 被认为是紧凑的。类似地定义 $(\\lambda,\\sigma)$ 的紧凑性。\n\n2. 电子对质心分离条件：对于一个电子对 $(\\mu,\\nu)$，定义其质心为 $\\mathbf{C}_{\\mu\\nu}=\\tfrac{1}{2}(\\mathbf{R}_\\mu+\\mathbf{R}_\\nu)$。给定两个电子对 $(\\mu,\\nu)$ 和 $(\\lambda,\\sigma)$，定义其电子对质心分离度为 $D_{\\mu\\nu,\\lambda\\sigma}=\\|\\mathbf{C}_{\\mu\\nu}-\\mathbf{C}_{\\lambda\\sigma}\\|$。仅当 $D_{\\mu\\nu,\\lambda\\sigma}\\le R_c$ (其中 $R_c=\\tfrac{L}{2}$) 时，双电子积分 $(\\mu\\nu|\\lambda\\sigma)$ 才被保留。\n\n一个双电子积分 $(\\mu\\nu|\\lambda\\sigma)$ 被筛选保留，当且仅当两个电子对紧凑性条件和电子对质心分离条件都得到满足。请根据其有序指数 $(\\mu,\\nu,\\lambda,\\sigma)$ 将所有保留的积分作为不同项进行计数；不要使用任何置换对称性。\n\n请问被此筛选规则保留的有序双电子积分 $(\\mu\\nu|\\lambda\\sigma)$ 的总数是多少？请以单个整数形式给出你的答案。无需四舍五入。",
            "solution": "题目要求我们计算被一个特定的三部分筛选规则所保留的有序双电子积分 $(\\mu\\nu|\\lambda\\sigma)$ 的总数，其中指数 $\\mu, \\nu, \\lambda, \\sigma$ 的取值范围均为 1 到 4。一个积分被保留，当且仅当以下三个条件全部满足：\n1. 电子对 $(\\mu,\\nu)$ 是紧凑的：$d_{\\mu\\nu} = \\|\\mathbf{R}_\\mu - \\mathbf{R}_\\nu\\| \\le r_p$，其中 $r_p=L$。\n2. 电子对 $(\\lambda,\\sigma)$ 是紧凑的：$d_{\\lambda\\sigma} = \\|\\mathbf{R}_\\lambda - \\mathbf{R}_\\sigma\\| \\le r_p$，其中 $r_p=L$。\n3. 电子对质心分离度足够小：$D_{\\mu\\nu,\\lambda\\sigma} = \\|\\mathbf{C}_{\\mu\\nu} - \\mathbf{C}_{\\lambda\\sigma}\\| \\le R_c$，其中 $R_c = \\frac{L}{2}$。\n\n解题过程遵循一系列逻辑步骤：首先，我们找出满足紧凑性条件的所有原子轨道指数对。其次，我们计算这些紧凑电子对的质心。第三，利用紧凑电子对及其质心的集合，我们枚举出所有满足电子对质心分离条件的电子对组合 $((\\mu,\\nu), (\\lambda,\\sigma))$。\n\n四个氢原子核位于 $xy$ 平面内一个正方形的顶点上：$\\mathbf{R}_1=(0,0,0)$、$\\mathbf{R}_2=(L,0,0)$、$\\mathbf{R}_3=(L,L,0)$ 和 $\\mathbf{R}_4=(0,L,0)$。\n\n步骤 1：确定紧凑电子对的集合 $S_p$。\n我们必须找出所有有序对 $(\\mu,\\nu)$，使其距离 $d_{\\mu\\nu} = \\|\\mathbf{R}_\\mu - \\mathbf{R}_\\nu\\|$ 小于或等于 $L$。让我们计算相关的平方距离 $d_{\\mu\\nu}^2$：\n- 对于 $\\mu=\\nu$：$d_{\\mu\\mu}^2 = 0$。距离为 $d_{\\mu\\mu}=0$。由于 $0 \\le L$，所有 4 个形如 $(\\mu,\\mu)$ 的电子对都是紧凑的：$(1,1), (2,2), (3,3), (4,4)$。\n- 对于相邻的原子核（正方形的边）：$d_{12}^2 = L^2$，$d_{23}^2 = L^2$，$d_{34}^2 = L^2$，$d_{41}^2 = L^2$。在这些情况下，距离为 $d_{\\mu\\nu}=L$。由于 $L \\le L$，这些电子对是紧凑的。这给了我们 $(1,2), (2,1), (2,3), (3,2), (3,4), (4,3), (4,1), (1,4)$ 这几对，总共 8 对。\n- 对于对角线上的原子核（正方形的对角线）：$d_{13}^2 = L^2+L^2 = 2L^2$ 和 $d_{24}^2 = L^2+L^2 = 2L^2$。距离为 $d_{\\mu\\nu}=L\\sqrt{2}$。由于 $L\\sqrt{2} > L$（因为 $L>0$），这些电子对不是紧凑的。\n\n因此，紧凑电子对的集合 $S_p$ 包含 $4+8=12$ 对：\n$S_p = \\{ (1,1), (2,2), (3,3), (4,4), (1,2), (2,1), (2,3), (3,2), (3,4), (4,3), (1,4), (4,1) \\}$。\n\n步骤 2：确定所有紧凑电子对的质心。\n电子对 $(\\mu,\\nu)$ 的质心是 $\\mathbf{C}_{\\mu\\nu} = \\frac{1}{2}(\\mathbf{R}_\\mu + \\mathbf{R}_\\nu)$。我们发现与紧凑电子对对应的质心有两种不同类型：\n- 对于形如 $(\\mu,\\mu)$ 的电子对，其质心就是原子核自身的位置：$\\mathbf{C}_{\\mu\\mu} = \\mathbf{R}_\\mu$。这些是正方形的 4 个顶点，我们称之为“顶点质心”。\n    - $\\mathbf{C}_{11} = (0,0,0)$\n    - $\\mathbf{C}_{22} = (L,0,0)$\n    - $\\mathbf{C}_{33} = (L,L,0)$\n    - $\\mathbf{C}_{44} = (0,L,0)$\n    每个顶点质心恰好对应 1 个紧凑电子对。\n- 对于相邻原子核的电子对 $(\\mu,\\nu)$，其质心是连接它们的边的中点。请注意 $\\mathbf{C}_{\\mu\\nu} = \\mathbf{C}_{\\nu\\mu}$。这些是正方形 4 条边的中点，我们称之为“中点质心”。\n    - $\\mathbf{C}_{12} = \\mathbf{C}_{21} = (\\frac{L}{2}, 0, 0)$\n    - $\\mathbf{C}_{23} = \\mathbf{C}_{32} = (L, \\frac{L}{2}, 0)$\n    - $\\mathbf{C}_{34} = \\mathbf{C}_{43} = (\\frac{L}{2}, L, 0)$\n    - $\\mathbf{C}_{41} = \\mathbf{C}_{14} = (0, \\frac{L}{2}, 0)$\n    每个中点质心恰好对应 2 个紧凑电子对。\n\n步骤 3：应用电子对质心分离条件并计数积分。\n保留的积分总数 $N$ 是对所有初始紧凑对 $(\\mu,\\nu) \\in S_p$ 进行求和，求和项为满足 $\\|\\mathbf{C}_{\\mu\\nu} - \\mathbf{C}_{\\lambda\\sigma}\\| \\le \\frac{L}{2}$ 的末态紧凑对 $(\\lambda,\\sigma) \\in S_p$ 的数量。\n让我们分析质心之间的距离。\n- 例如，一个顶点质心与其相邻的中点质心之间的距离是 $\\|\\mathbf{C}_{11} - \\mathbf{C}_{12}\\| = \\|(0,0,0) - (\\frac{L}{2},0,0)\\| = \\frac{L}{2}$。这个距离满足条件。根据对称性，任何一个顶点质心都与它的两个相邻中点质心相距 $\\frac{L}{2}$。\n- 任何两个不同顶点质心之间的距离至少为 $L$，大于 $\\frac{L}{2}$。\n- 任何两个不同中点质心之间的距离至少为 $\\frac{L\\sqrt{2}}{2} \\approx 0.707L$，大于 $\\frac{L}{2}$。\n- 一个质心到其自身的距离为 0，满足条件。\n\n因此，一个给定的质心 $\\mathbf{C}$ 只与它自身以及它在质心集合中的最近邻“相连”（即满足分离条件）。具体来说：\n- 一个顶点质心与它自身以及 2 个相邻的中点质心相连。\n- 一个中点质心与它自身以及 2 个相邻的顶点质心相连。\n\n现在我们可以通过考虑两种类型的初始对 $(\\mu,\\nu)$ 来计算积分总数。\n\n情况 A：初始对 $(\\mu,\\nu)$ 具有顶点质心。\n在 $S_p$ 中有 4 个这样的电子对：$(1,1), (2,2), (3,3), (4,4)$。让我们考虑 $(\\mu,\\nu)=(1,1)$，其质心为 $\\mathbf{C}_{11}=(0,0,0)$。末态对 $(\\lambda,\\sigma)$ 的质心必须在 $\\mathbf{C}_{11}$ 的 $\\frac{L}{2}$ 距离范围内。这些质心是 $\\mathbf{C}_{11}$ 本身，以及相邻的中点质心 $\\mathbf{C}_{12}$ 和 $\\mathbf{C}_{41}$。\n- 质心为 $\\mathbf{C}_{11}$ 的电子对数量：1 对，即 $(1,1)$。\n- 质心为 $\\mathbf{C}_{12}$ 的电子对数量：2 对，即 $(1,2)$ 和 $(2,1)$。\n- 质心为 $\\mathbf{C}_{41}$ 的电子对数量：2 对，即 $(1,4)$ 和 $(4,1)$。\n对于一个初始对具有顶点质心的情况，有 $1+2+2=5$ 个有效的末态对。\n由于有 4 个这样的初始对，这部分对总数的贡献是 $4 \\times 5 = 20$。\n\n情况 B：初始对 $(\\mu,\\nu)$ 具有中点质心。\n在 $S_p$ 中有 8 个这样的电子对。让我们考虑 $(\\mu,\\nu)=(1,2)$，其质心为 $\\mathbf{C}_{12}=(\\frac{L}{2},0,0)$。末态对 $(\\lambda,\\sigma)$ 的质心必须在 $\\mathbf{C}_{12}$ 的 $\\frac{L}{2}$ 距离范围内。这些质心是 $\\mathbf{C}_{12}$ 本身，以及相邻的顶点质心 $\\mathbf{C}_{11}$ 和 $\\mathbf{C}_{22}$。\n- 质心为 $\\mathbf{C}_{12}$ 的电子对数量：2 对，即 $(1,2)$ 和 $(2,1)$。\n- 质心为 $\\mathbf{C}_{11}$ 的电子对数量：1 对，即 $(1,1)$。\n- 质心为 $\\mathbf{C}_{22}$ 的电子对数量：1 对，即 $(2,2)$。\n对于一个初始对具有中点质心的情况，有 $2+1+1=4$ 个有效的末态对。\n由于有 8 个这样的初始对，这部分对总数的贡献是 $8 \\times 4 = 32$。\n\n最后，保留的积分总数是两种情况贡献的总和。\n$N = 20 + 32 = 52$。",
            "answer": "$$\n\\boxed{52}\n$$"
        },
        {
            "introduction": "为什么我们可以忽略遥远原子间的相互作用？其物理基础是 Walter Kohn 提出的“电子近视性原理”，该原理指出在具有非零能隙的体系中，单粒子密度矩阵的元 $P_{ij}$ 会随原子间距离的增加而指数衰减。这个编程练习将指导你通过一个紧束缚模型来量化验证这一原理，你将亲手计算并比较完整密度矩阵和截断后密度矩阵所给出的物理量，并探索能隙大小与“近视性”程度之间的深刻联系 。",
            "id": "2457332",
            "problem": "你的任务是形式化并实现一个在紧束缚模型内，对有限一维分子的电子近视性的定量测试。考虑一个实对称紧束缚哈密顿矩阵 $H \\in \\mathbb{R}^{N \\times N}$，该矩阵由位于 $\\{\\mathbf{r}_i\\}_{i=1}^N \\subset \\mathbb{R}^3$（单位为埃）位置的一组 $N$ 个原子位点构建。哈密顿量由以下第一性原理规范定义：\n\n1. 在位项：对于位点索引 $i$，在位能为 $\\varepsilon_i \\in \\mathbb{R}$。对角元满足 $H_{ii} = \\varepsilon_i$。\n\n2. 跃迁项：对于不同的位点 $i \\neq j$，定义位点间的欧几里得距离 $d_{ij} = \\|\\mathbf{r}_i - \\mathbf{r}_j\\|_2$（单位为埃）。令 $d_0$ 表示最小非零位点间距。固定一个容差因子 $\\eta = 0.05$。如果 $d_{ij} \\in [d_0(1-\\eta),\\, d_0(1+\\eta)]$，则非对角矩阵元 $H_{ij}$ 等于一个恒定的跃迁能 $t \\in \\mathbb{R}$（单位为电子伏特）；否则 $H_{ij}=0$。\n\n对于逆温度 $\\beta > 0$（单位为逆电子伏特）和化学势 $\\mu$（单位为电子伏特），单粒子密度矩阵 $P \\in \\mathbb{R}^{N \\times N}$ 被定义为哈密顿量的费米-狄拉克函数，\n$$\nP \\;=\\; \\bigl(I + \\exp\\bigl(\\beta\\,(H - \\mu I)\\bigr)\\bigr)^{-1}.\n$$\n给定一个实空间截断半径 $r_c > 0$（单位为埃），通过以下方式定义截断密度矩阵 $P_c \\in \\mathbb{R}^{N \\times N}$：\n$$\n(P_c)_{ij} \\;=\\; \\begin{cases}\nP_{ij}, & \\text{如果 } d_{ij} \\le r_c,\\\\\n0, & \\text{如果 } d_{ij} > r_c,\n\\end{cases}\n$$\n并约定对于所有 $i$，$d_{ii} = 0$。\n\n定义能带能 $E_{\\text{band}}$ 和电子数 $N_e$ 如下：\n$$\nE_{\\text{band}} \\;=\\; \\mathrm{Tr}(P\\,H), \\qquad N_e \\;=\\; \\mathrm{Tr}(P),\n$$\n并类似地定义\n$$\nE_{\\text{band}}^{(c)} \\;=\\; \\mathrm{Tr}(P_c\\,H), \\qquad N_e^{(c)} \\;=\\; \\mathrm{Tr}(P_c).\n$$\n当且仅当以下两个定量精度标准都成立时，一个分子对于截断半径 $r_c$ 才是“足够近视”的：\n$$\n\\frac{\\bigl|E_{\\text{band}} - E_{\\text{band}}^{(c)}\\bigr|}{\\bigl|E_{\\text{band}}\\bigr|} \\;\\le\\; \\varepsilon_E\n\\quad\\text{且}\\quad\n\\bigl|N_e - N_e^{(c)}\\bigr| \\;\\le\\; \\varepsilon_N,\n$$\n其中 $\\varepsilon_E > 0$ 是一个相对能量容差（无量纲），$\\varepsilon_N > 0$ 是一个绝对电子数容差（无量纲）。\n\n对于下面的所有测试用例，使用半填充的无自旋电子，化学势为 $\\mu = 0\\,\\text{eV}$。几何结构是一个由 $N$ 个原子组成的线性链，沿 $x$ 轴以均匀间距 $a$（单位为埃）排列，具体位置为 $\\mathbf{r}_i = ( (i-1)\\,a,\\, 0,\\, 0 )$，其中 $i = 1,2,\\dots,N$。在位能交替变化：对于偶数 $i$，$\\varepsilon_i = (+\\Delta)$；对于奇数 $i$，$\\varepsilon_i = (-\\Delta)$，其中 $\\Delta \\ge 0$（单位为电子伏特）。跃迁常数 $t$ 是均匀的（单位为电子伏特）且为负值。\n\n你的任务是编写一个完整、可运行的程序，对于每个测试用例，构造 $H$，计算 $P$ 和 $P_c$，计算上述两种误差，并返回一个布尔值，指示该分子对于指定的截断半径 $r_c$ 和容差是否“足够近视”。所有能量必须以电子伏特处理，所有距离必须以埃处理。逆温度 $\\beta$ 必须以逆电子伏特处理。最终输出必须是单行文本，包含一个布尔结果列表，每个测试用例一个结果，按所给顺序排列，格式化为一个用方括号括起来、无空格的逗号分隔列表，例如，“[True,False,True]”。\n\n使用以下测试套件，其中每个案例由 $(N, a, t, \\Delta, \\beta, r_c, \\varepsilon_E, \\varepsilon_N)$ 指定：\n\n- 案例 1（有带隙，预期在短程精确）：$(\\,N=12,\\; a=1.40\\,\\text{\\AA},\\; t=-2.5\\,\\text{eV},\\; \\Delta=1.0\\,\\text{eV},\\; \\beta=40\\,\\text{eV}^{-1},\\; r_c=4.20\\,\\text{\\AA},\\; \\varepsilon_E=1.0\\times 10^{-2},\\; \\varepsilon_N=1.0\\times 10^{-2}\\,)$。\n\n- 案例 2（金属性，预期在相同短程下不精确）：$(\\,N=12,\\; a=1.40\\,\\text{\\AA},\\; t=-2.5\\,\\text{eV},\\; \\Delta=0.0\\,\\text{eV},\\; \\beta=40\\,\\text{eV}^{-1},\\; r_c=2.10\\,\\text{\\AA},\\; \\varepsilon_E=1.0\\times 10^{-2},\\; \\varepsilon_N=1.0\\times 10^{-2}\\,)$。\n\n- 案例 3（小带隙，短截断半径，可能不精确）：$(\\,N=12,\\; a=1.40\\,\\text{\\AA},\\; t=-2.5\\,\\text{eV},\\; \\Delta=0.2\\,\\text{eV},\\; \\beta=40\\,\\text{eV}^{-1},\\; r_c=3.00\\,\\text{\\AA},\\; \\varepsilon_E=1.0\\times 10^{-2},\\; \\varepsilon_N=1.0\\times 10^{-2}\\,)$。\n\n- 案例 4（小带隙，长截断半径，可能精确）：$(\\,N=12,\\; a=1.40\\,\\text{\\AA},\\; t=-2.5\\,\\text{eV},\\; \\Delta=0.2\\,\\text{eV},\\; \\beta=40\\,\\text{eV}^{-1},\\; r_c=7.00\\,\\text{\\AA},\\; \\varepsilon_E=1.0\\times 10^{-2},\\; \\varepsilon_N=1.0\\times 10^{-2}\\,)$。\n\n你的程序应产生单行输出，包含一个用方括号括起来的逗号分隔列表形式的结果（例如，“[result1,result2,result3,result4]”），其中每个结果根据该测试用例是否同时满足两个接受标准而为 True 或 False。",
            "solution": "这个问题陈述经过验证，被确定为科学上合理、定义明确且完整。所有必要的物理参数、数学定义和数值容差都已提供。该模型是一维分子链的标准紧束缚表示，而电子近视性是计算化学和凝聚态物理中的一个基本原理。我们着手进行求解。\n\n该问题要求对有限一维 $N$ 原子链的电子近视性进行定量测试。物理系统由一个紧束缚哈密顿量 $H$ 建模。问题的核心是计算单粒子密度矩阵 $P$，在实空间中对其进行截断以获得 $P_c$，然后比较从 $P$ 和 $P_c$ 推导出的物理可观测量。\n\n首先，我们构造哈密顿矩阵 $H \\in \\mathbb{R}^{N \\times N}$。几何结构是一个均匀间距为 $a$ 的线性链，因此原子位置为 $\\mathbf{r}_i = ((i-1)a, 0, 0)$，其中 $i=1, \\dots, N$。位点 $i$ 和 $j$ 之间的距离为 $d_{ij} = |i-j|a$。最小非零距离为 $d_0 = a$。跃迁项 $H_{ij} = t$ 仅在 $d_{ij} \\in [a(1-\\eta), a(1+\\eta)]$ 时非零。当 $\\eta=0.05$ 时，此范围为 $[0.95a, 1.05a]$。对于 $d_{ij}=|i-j|a$，该条件变为 $0.95 \\le |i-j| \\le 1.05$。由于 $|i-j|$ 必须是整数，这仅在 $|i-j|=1$ 时满足。因此，哈密顿量仅包含最近邻跃迁。在位能 $\\varepsilon_i$ 交替变化：对于奇数 $i$，$\\varepsilon_i = -\\Delta$；对于偶数 $i$，$\\varepsilon_i = +\\Delta$。给定的化学势为 $\\mu = 0\\,\\text{eV}$。\n\n因此，哈密顿矩阵元为：\n$$\nH_{ij} = \\begin{cases}\n-\\Delta, & \\text{如果 } i=j \\text{ 且 } i \\text{ 为奇数} \\\\\n+\\Delta, & \\text{如果 } i=j \\text{ 且 } i \\text{ 为偶数} \\\\\nt, & \\text{如果 } |i-j| = 1 \\\\\n0, & \\text{其它情况}\n\\end{cases}\n$$\n\n接下来，我们计算单粒子密度矩阵 $P$。它被定义为哈密顿量的函数：\n$$\nP = \\left(I + \\exp\\left(\\beta(H - \\mu I)\\right)\\right)^{-1}\n$$\n当 $\\mu=0$ 时，这简化为 $P = (I + \\exp(\\beta H))^{-1}$。计算此矩阵函数最数值稳定和高效的方法是通过 $H$ 的特征分解。由于 $H$ 是实对称矩阵，它可以被对角化为 $H = U \\Lambda U^T$，其中 $\\Lambda$ 是实特征值 $\\lambda_k$ 的对角矩阵，$U$ 是相应特征向量的正交矩阵。则密度矩阵由下式给出：\n$$\nP = U f(\\Lambda) U^T\n$$\n其中 $f(\\Lambda)$ 是一个对角矩阵，其元素为 $(f(\\Lambda))_{kk} = f(\\lambda_k) = (1 + \\exp(\\beta \\lambda_k))^{-1}$。这些值 $f(\\lambda_k)$是单粒子能级 $\\lambda_k$ 的费米-狄拉克占据数。\n\n利用特征系统，可以高效地计算能带能 $E_{\\text{band}}$ 和电子数 $N_e$。利用迹的循环性质 $\\mathrm{Tr}(ABC)=\\mathrm{Tr}(BCA)$：\n$$\nE_{\\text{band}} = \\mathrm{Tr}(P H) = \\mathrm{Tr}(U f(\\Lambda) U^T U \\Lambda U^T) = \\mathrm{Tr}(f(\\Lambda) \\Lambda) = \\sum_{k=1}^N f(\\lambda_k) \\lambda_k\n$$\n$$\nN_e = \\mathrm{Tr}(P) = \\mathrm{Tr}(U f(\\Lambda) U^T) = \\mathrm{Tr}(f(\\Lambda)) = \\sum_{k=1}^N f(\\lambda_k)\n$$\n\n下一步是构造截断密度矩阵 $P_c$。其元素定义为：\n$$\n(P_c)_{ij} = \\begin{cases}\nP_{ij}, & \\text{如果 } d_{ij} \\le r_c \\\\\n0, & \\text{如果 } d_{ij} > r_c\n\\end{cases}\n$$\n其中 $d_{ij} = |i-j|a$。为了实现这一点，我们首先计算完整的密度矩阵 $P = U f(\\Lambda) U^T$。然后，我们构造一个二元掩码矩阵 $M$，其中如果 $|i-j|a \\le r_c$，则 $M_{ij}=1$，否则 $M_{ij}=0$。$P_c$ 则是 $P$ 和 $M$ 的逐元素乘积。\n\n与截断密度矩阵对应的可观测量计算如下：\n$$\nE_{\\text{band}}^{(c)} = \\mathrm{Tr}(P_c H) \\qquad \\text{和} \\qquad N_e^{(c)} = \\mathrm{Tr}(P_c)\n$$\n此处必须对 $N_e^{(c)}$ 作一个关键观察。迹是对角元素之和。对角元素 $(P_c)_{ii}$ 的截断条件取决于距离 $d_{ii}$。按照约定，$d_{ii}=0$。由于所有测试用例都使用正的截断半径 $r_c > 0$，因此条件 $d_{ii} \\le r_c$ 对所有对角元素始终成立。因此，对于所有 $i=1, \\dots, N$，$(P_c)_{ii} = P_{ii}$。这导出一个恒等式：\n$$\nN_e^{(c)} = \\mathrm{Tr}(P_c) = \\sum_{i=1}^N (P_c)_{ii} = \\sum_{i=1}^N P_{ii} = \\mathrm{Tr}(P) = N_e\n$$\n因此，绝对电子数误差 $|N_e - N_e^{(c)}|$ 恒等于零。因此，对于任何 $\\varepsilon_N > 0$，近视性的第二个标准 $|N_e - N_e^{(c)}| \\le \\varepsilon_N$ 自然满足。近视性的测试简化为仅能量标准：\n$$\n\\frac{\\left|E_{\\text{band}} - E_{\\text{band}}^{(c)}\\right|}{\\left|E_{\\text{band}}\\right|} \\le \\varepsilon_E\n$$\n$E_{\\text{band}}^{(c)} = \\mathrm{Tr}(P_c H)$ 的值必须通过显式矩阵乘法和求迹来计算，因为 $P_c$ 和 $H$ 通常不可交换。\n\n判断一个分子是否“足够近视”的算法如下：\n1. 对于给定的一组参数 $(N, a, t, \\Delta, \\beta, r_c, \\varepsilon_E, \\varepsilon_N)$，构造 $N \\times N$ 的哈密顿矩阵 $H$。\n2. 计算 $H$ 的特征值 $\\lambda_k$ 和特征向量（矩阵 $U$）。\n3. 计算费米-狄拉克占据数 $f_k = (1 + \\exp(\\beta \\lambda_k))^{-1}$。\n4. 计算精确的能带能 $E_{\\text{band}} = \\sum_k f_k \\lambda_k$。\n5. 构造完整的密度矩阵 $P = U \\mathrm{diag}(f_k) U^T$。\n6. 构造距离矩阵 $D$，其元素为 $d_{ij} = |i-j|a$。\n7. 通过在 $d_{ij} > r_c$ 处将元素 $(P_c)_{ij}$ 设为 0 来创建截断密度矩阵 $P_c$。\n8. 计算截断能带能 $E_{\\text{band}}^{(c)} = \\mathrm{Tr}(P_c H)$。\n9. 计算相对能量误差 $\\delta_E = |E_{\\text{band}} - E_{\\text{band}}^{(c)}| / |E_{\\text{band}}|$。\n10. 如果 $\\delta_E \\le \\varepsilon_E$，则满足条件。电子数条件总是满足的。最终结果是这个单一测试的布尔结果。\n\n此过程将应用于每个测试用例，以生成最终的布尔结果列表。其背后的物理原理是，对于有带隙的系统（$\\Delta > 0$），元素 $P_{ij}$ 随距离 $d_{ij}$ 指数衰减，因此截断误差很小。对于无带隙（金属性）系统（$\\Delta = 0$），衰减更慢（代数衰减），预期截断误差会很显著。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# No other libraries are needed for this problem.\n\ndef is_nearsighted(N, a, t, Delta, beta, r_c, eps_E, eps_N):\n    \"\"\"\n    Checks if a molecule is \"nearsighted enough\" based on a tight-binding model.\n\n    Args:\n        N (int): Number of atoms.\n        a (float): Uniform spacing in Angstroms.\n        t (float): Hopping energy in eV.\n        Delta (float): On-site energy staggering in eV.\n        beta (float): Inverse temperature in eV^-1.\n        r_c (float): Real-space cutoff in Angstroms.\n        eps_E (float): Relative energy tolerance.\n        eps_N (float): Absolute electron number tolerance.\n\n    Returns:\n        bool: True if both accuracy criteria are met, False otherwise.\n    \"\"\"\n    # 1. Construct the Hamiltonian matrix H\n    # H is an N x N matrix. Indices k, l are 0-based (0 to N-1).\n    H = np.zeros((N, N))\n\n    # On-site terms (diagonal elements)\n    for k in range(N):\n        # i = k + 1. If i is odd (k is even), energy is -Delta.\n        # If i is even (k is odd), energy is +Delta.\n        if k % 2 == 0:\n            H[k, k] = -Delta\n        else:\n            H[k, k] = Delta\n    \n    # Hopping terms (off-diagonal elements for nearest neighbors)\n    for k in range(N - 1):\n        H[k, k + 1] = t\n        H[k + 1, k] = t\n\n    # 2. Diagonalize H to get eigenvalues (e_vals) and eigenvectors (e_vecs)\n    # numpy.linalg.eigh is suitable for real symmetric matrices.\n    e_vals, e_vecs = np.linalg.eigh(H)\n    \n    # 3. Calculate Fermi-Dirac occupation numbers\n    # Chemical potential mu is 0.\n    f_k = 1.0 / (1.0 + np.exp(beta * e_vals))\n\n    # 4. Calculate exact band energy and electron number\n    E_band = np.sum(f_k * e_vals)\n    N_e = np.sum(f_k)\n    \n    # 5. Construct the full density matrix P\n    # P = U * diag(f_k) * U_transpose\n    P = e_vecs @ np.diag(f_k) @ e_vecs.T\n\n    # 6. Construct the cutoff-truncated density matrix P_c\n    # First, create the distance matrix D\n    indices = np.arange(N)\n    dist_matrix = np.abs(indices[:, np.newaxis] - indices) * a\n    \n    # Create a mask based on the cutoff radius r_c\n    mask = dist_matrix <= r_c\n    \n    # Apply the mask to P to get P_c\n    P_c = P * mask\n    \n    # 7. Calculate truncated observables\n    E_band_c = np.trace(P_c @ H)\n    N_e_c = np.trace(P_c) # As derived, this equals N_e\n    \n    # 8. Check the accuracy criteria\n    # Avoid division by zero, although E_band is not expected to be zero here.\n    if np.abs(E_band) < 1e-12:\n        # If E_band is effectively zero, relative error is not well-defined.\n        # Define error as absolute difference in this case.\n        # Problem constraints ensure this is not an issue.\n        rel_energy_error = np.abs(E_band - E_band_c)\n    else:\n        rel_energy_error = np.abs(E_band - E_band_c) / np.abs(E_band)\n        \n    abs_electron_error = np.abs(N_e - N_e_c)\n\n    # 9. Return boolean result\n    is_accurate_E = rel_energy_error <= eps_E\n    is_accurate_N = abs_electron_error <= eps_N\n    \n    return is_accurate_E and is_accurate_N\n\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print results.\n    \"\"\"\n    # Each test case is a tuple: (N, a, t, Delta, beta, r_c, eps_E, eps_N)\n    test_cases = [\n        # Case 1: gapped, expected to be accurate at short range\n        (12, 1.40, -2.5, 1.0, 40.0, 4.20, 1.0e-2, 1.0e-2),\n        # Case 2: metallic, expected to be inaccurate at the same short range\n        (12, 1.40, -2.5, 0.0, 40.0, 2.10, 1.0e-2, 1.0e-2),\n        # Case 3: small gap, short cutoff, likely inaccurate\n        (12, 1.40, -2.5, 0.2, 40.0, 3.00, 1.0e-2, 1.0e-2),\n        # Case 4: small gap, longer cutoff, likely accurate\n        (12, 1.40, -2.5, 0.2, 40.0, 7.00, 1.0e-2, 1.0e-2),\n    ]\n\n    results = []\n    for case in test_cases:\n        result = is_nearsighted(*case)\n        results.append(result)\n\n    # Format the final output as specified\n    # map(str, ...) converts boolean True/False to strings \"True\"/\"False\"\n    print(f\"[{','.join(map(str, results))}]\")\n\n# Execute the solver\nsolve()\n\n```"
        },
        {
            "introduction": "虽然利用稀疏性是线性标度方法成功的关键，但简单粗暴的阈值截断有时会导致灾难性的失败。这个思想实验揭示了一个看似无害的近似——忽略一个数值很小的远程相互作用——如何导致定性上完全错误的物理图像，例如将一个离域的电子态错误地描述为定域在单一碎片上。通过分析这个案例，你将学到一个至关重要的教训：在应用近似之前，必须理解其物理前提，特别要注意简并或近简并电子态可能带来的挑战 。",
            "id": "2457296",
            "problem": "一个线性标度的 Hartree–Fock (HF) 计算采用了矩阵元阈值筛选：任何大小小于截断值 $\\tau$ 的非对角 Fock 矩阵元 $F_{\\mu\\nu}$ 都会被置为 $0$，以强制稀疏性。考虑一个单电子体系，由两个相同的、分离很远的片段 $A$ 和 $B$ 组成，它们沿 $x$ 轴排列，分别以 $x_A=-R/2$ 和 $x_B=+R/2$ 为中心，其中 $R$ 很大。在正交归一的局域基 $\\{\\phi_A,\\phi_B\\}$ 中进行计算，基函数的电荷密度空间重叠可以忽略不计。在精确（无阈值筛选）的计算中，此子空间中的单电子 Fock 矩阵具有如下形式\n$$\n\\mathbf{F} \\;=\\;\n\\begin{pmatrix}\n\\epsilon & V \\\\\nV & \\epsilon\n\\end{pmatrix},\n$$\n其中 $|V| \\ll |\\epsilon|$ 且 $|V| < \\tau$，因此线性标度代码在对角化之前将 $F_{AB}=F_{BA}=0$。假设沿分子轴的偶极矩算符为 $\\hat{\\mu} = q\\,\\hat{x}$，其中 $q$ 是电子电荷，并将原点置于 $A$ 和 $B$ 的中点。没有外场存在，并且由于体系只有一个电子，因此没有双电子项。\n\n哪个选项最能描述丢弃这个数值虽小但长程的 Fock 矩阵元 $V$ 所带来的物理和数值后果？\n\nA. 基态能量误差与 $|V|$ 呈线性关系（损失了大小为 $|V|$ 的稳定化能），并且预测的偶极矩大小从约 $0$ 变为约 $|q|R/2$，因为当 $V$ 被置为 $0$ 时，电子局域在了其中一个片段上。\n\nB. 基态能量误差按 $\\mathcal{O}(V^2)$ 平方尺度变化，因为只有二阶混合受到影响，并且即使 $V$ 被置为 $0$，由于残余对称性，偶极矩仍保持约 $0$。\n\nC. 自洽场 (SCF) 过程变得非厄米且变分不稳定，因为将 $F_{AB}$ 置为 $0$ 会破坏厄米性，从而导致发散，而不是能量或偶极矩的物理误差。\n\nD. 对能量或偶极矩都没有显著影响，因为根据设定 $|V|<\\tau$，所以阈值筛选保证了其物理影响可以忽略不计。\n\nE. 尽管初始对角化忽略了 $V$，但自洽场 (SCF) 迭代会通过密度矩阵重新生成有效的耦合，使得最终状态保持离域，并且能量误差被限制在 $\\mathcal{O}(V^2)$ 内。",
            "solution": "必须首先验证问题陈述的科学和逻辑完整性。\n\n### 步骤 1：提取已知条件\n- **体系**：一个单电子体系，由两个相同的、分离很远的片段 $A$ 和 $B$ 组成。\n- **几何构型**：片段位于 $x$ 轴上，中心分别为 $x_A = -R/2$ 和 $x_B = +R/2$，其中 $R$ 很大。\n- **基组**：一个正交归一的局域基 $\\{\\phi_A, \\phi_B\\}$。\n- **重叠**：电荷密度的空间重叠可忽略，意味着 $\\phi_A^2(r)\\phi_B^2(r) \\approx 0$。鉴于基组是正交归一的，重叠积分为 $\\langle \\phi_A|\\phi_B \\rangle = S_{AB} = 0$。\n- **精确 Fock 矩阵**：在给定基组中，单电子 Fock 矩阵为 $\\mathbf{F} = \\begin{pmatrix} \\epsilon & V \\\\ V & \\epsilon \\end{pmatrix}$。由于只有一个电子，这也是核哈密顿矩阵。\n- **参数**：$|V| \\ll |\\epsilon|$ 且 $|V| < \\tau$，其中 $\\tau$ 是一个数值阈值。\n- **近似**：线性标度方法将任何大小小于 $\\tau$ 的非对角 Fock 矩阵元 $F_{\\mu\\nu}$ 置为 $0$。由于 $|V| < \\tau$，近似的 Fock 矩阵变为 $\\mathbf{F}' = \\begin{pmatrix} \\epsilon & 0 \\\\ 0 & \\epsilon \\end{pmatrix}$。\n- **可观测量**：沿分子轴的偶极矩算符为 $\\hat{\\mu} = q\\hat{x}$，原点位于 $A$ 和 $B$ 的中点。$q$ 是电子电荷。\n- **条件**：无外场，单电子体系（无双电子相互作用，因此无自洽场 (SCF) 循环）。\n\n### 步骤 2：使用提取的已知条件进行验证\n该问题描述了一个二能级量子体系，这是物理学和化学中用于研究基本概念的一个标准且有效的模型。\n- **科学依据**：在原子轨道线性组合 (LCAO) 和 Hartree-Fock 理论的框架内，该问题是对分子体系的一个简化但正确的表述。矩阵元阈值筛选的概念是线性标度方法的核心。对其后果的分析是一个合理的科学问题。该模型是可靠的。\n- **问题的适定性**：问题定义清晰。它要求比较从两个不同的哈密顿量（由 $\\mathbf{F}$ 和 $\\mathbf{F}'$ 表示）得到的基态性质（能量、偶极矩）。可以推导出一个唯一且有意义的解。\n- **客观性**：语言精确，使用了量子化学中标准、无歧义的术语。\n- **无缺陷**：设定是自洽的，不含科学或逻辑上的矛盾。对于该模型而言，参数和条件在物理上是合理的。\n\n### 步骤 3：结论和行动\n问题是有效的。我现在将着手推导解决方案。\n\n### 推导\n让我们分析阈值筛选近似前后的体系。\n\n**1. 精确（无阈值筛选）体系**\n哈密顿量由矩阵 $\\mathbf{F} = \\begin{pmatrix} \\epsilon & V \\\\ V & \\epsilon \\end{pmatrix}$ 表示。我们求解矩阵形式的定态薛定谔方程，对于正交归一基，这是一个本征值问题 $\\mathbf{F}\\mathbf{c} = E\\mathbf{c}$。\n本征值（轨道能量）是特征方程 $\\det(\\mathbf{F} - E\\mathbf{I}) = 0$ 的根：\n$$\n\\det\\begin{pmatrix} \\epsilon - E & V \\\\ V & \\epsilon - E \\end{pmatrix} = (\\epsilon - E)^2 - V^2 = 0\n$$\n这给出 $\\epsilon - E = \\pm V$，因此能量为 $E_1 = \\epsilon - |V|$ 和 $E_2 = \\epsilon + |V|$。\n基态能量为 $E_{GS} = \\epsilon - |V|$，相对于片段轨道能量 $\\epsilon$，这表示一个大小为 $|V|$ 的稳定化。\n\n基态 $E_{GS}$ 的本征向量 $\\mathbf{c}_{GS}$ 通过求解 $(\\mathbf{F} - E_{GS}\\mathbf{I})\\mathbf{c}_{GS} = 0$ 得到：\n$$\n\\begin{pmatrix} \\epsilon - (\\epsilon - |V|) & V \\\\ V & \\epsilon - (\\epsilon - |V|) \\end{pmatrix} \\begin{pmatrix} c_A \\\\ c_B \\end{pmatrix} = \\begin{pmatrix} |V| & V \\\\ V & |V| \\end{pmatrix} \\begin{pmatrix} c_A \\\\ c_B \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n这得出了条件 $|V|c_A + Vc_B = 0$。\n- 如果 $V < 0$，那么 $-Vc_A + Vc_B = 0 \\implies c_A = c_B$。\n- 如果 $V > 0$，那么 $Vc_A + Vc_B = 0 \\implies c_A = -c_B$。\n在任何一种情况下，归一化 ($c_A^2 + c_B^2 = 1$) 给出 $|c_A| = |c_B| = 1/\\sqrt{2}$。基态分子轨道是 $\\psi_{GS} = \\frac{1}{\\sqrt{2}}(\\phi_A \\pm \\phi_B)$。这个状态是跨越两个片段**离域**的。概率密度 $|\\psi_{GS}|^2 = \\frac{1}{2}(\\phi_A^2 + \\phi_B^2 \\pm 2\\phi_A\\phi_B)$ 相对于原点是对称的（因为 $\\phi_A$ 和 $\\phi_B$ 通过反演互为镜像），因为在密度显著的区域，交叉项 $\\phi_A\\phi_B$ 可以忽略不计。\n\n偶极矩的期望值为：\n$$\n\\langle \\mu \\rangle_{exact} = \\langle \\psi_{GS} | q\\hat{x} | \\psi_{GS} \\rangle = \\frac{q}{2} \\langle \\phi_A \\pm \\phi_B | \\hat{x} | \\phi_A \\pm \\phi_B \\rangle\n= \\frac{q}{2} \\left[ \\langle \\phi_A|\\hat{x}|\\phi_A \\rangle + \\langle \\phi_B|\\hat{x}|\\phi_B \\rangle \\pm 2\\langle \\phi_A|\\hat{x}|\\phi_B \\rangle \\right]\n$$\n基函数分别以 $x_A = -R/2$ 和 $x_B = +R/2$ 为中心。因此，$\\langle \\phi_A|\\hat{x}|\\phi_A \\rangle \\approx -R/2$ 且 $\\langle \\phi_B|\\hat{x}|\\phi_B \\rangle \\approx +R/2$。由于重叠极小，项 $\\langle \\phi_A|\\hat{x}|\\phi_B \\rangle$ 可以忽略不计。\n$$\n\\langle \\mu \\rangle_{exact} \\approx \\frac{q}{2} \\left( -\\frac{R}{2} + \\frac{R}{2} \\right) = 0\n$$\n精确计算正确地预测了一个由于体系对称性而具有零偶极矩的离域状态。\n\n**2. 近似（有阈值筛选）体系**\n阈值筛选将 $V=0$，得到近似的 Fock 矩阵 $\\mathbf{F}' = \\begin{pmatrix} \\epsilon & 0 \\\\ 0 & \\epsilon \\end{pmatrix}$。\n本征值显然是 $E'_1 = E'_2 = \\epsilon$。基态能量是简并的。$\\phi_A$ 和 $\\phi_B$ 的任何线性组合都是能量为 $\\epsilon$ 的本征态。\n在数值计算中，当本征求解器面对一个完全简并的子空间时，由于舍入误差或算法选择，它通常会返回其中一个原始基向量作为本征向量。它不会自发地形成一个对称的线性组合。让我们假设算法返回的本征向量是 $\\mathbf{c}'_{GS} = \\begin{pmatrix} 1 \\\\ 0 \\end{pmatrix}$，这对应于分子轨道 $\\psi'_{GS} = \\phi_A$。这表示电子完全**局域**在片段 $A$ 上。\n\n近似的基态能量是 $E'_{GS} = \\epsilon$。\n能量误差为 $\\Delta E = E'_{GS} - E_{GS} = \\epsilon - (\\epsilon - |V|) = |V|$。这是一个一阶误差，与 $|V|$ 呈线性关系。\n\n这个局域态 $\\psi'_{GS} = \\phi_A$ 的偶极矩为：\n$$\n\\langle \\mu \\rangle' = \\langle \\phi_A | q\\hat{x} | \\phi_A \\rangle \\approx qx_A = -qR/2\n$$\n如果求解器选择了 $\\psi'_{GS} = \\phi_B$，偶极矩将是 $+qR/2$。无论哪种情况，偶极矩的大小都约为 $|\\langle \\mu \\rangle'| \\approx |q|R/2$。对于一个大的间距 $R$，这是一个非常大的偶极矩，与正确的数值 $0$ 相比，这是一个定性上的灾难性错误。\n\n### 逐项分析\n\n**A. 基态能量误差与 $|V|$ 呈线性关系（损失了大小为 $|V|$ 的稳定化能），并且预测的偶极矩大小从约 $0$ 变为约 $|q|R/2$，因为当 $V$ 被置为 $0$ 时，电子局域在了其中一个片段上。**\n这个陈述完美地总结了我们的推导。能量误差是 $\\Delta E = |V|$。精确的稳定化能被损失了。偶极矩从 $0$ 变为大小为 $|q|R/2$。其物理原因是，强制离域化的耦合 $V$ 被移除，导致电子被人为地局域化到单个片段上。\n**判定：正确。**\n\n**B. 基态能量误差按 $\\mathcal{O}(V^2)$ 平方尺度变化，因为只有二阶混合受到影响，并且即使 $V$ 被置为 $0$，由于残余对称性，偶极矩仍保持约 $0$。**\n能量误差为 $|V|$，即 $\\mathcal{O}(|V|)$，而不是 $\\mathcal{O}(V^2)$。$\\mathcal{O}(V^2)$ 误差是二阶微扰理论的特征，但这在此处不适用，因为未微扰体系（$\\mathbf{F}'$）是简并的。偶极矩不会保持为 $0$；数值解破坏了对称性。\n**判定：错误。**\n\n**C. 自洽场 (SCF) 过程变得非厄米且变分不稳定，因为将 $F_{AB}$ 置为 $0$ 会破坏厄米性，从而导致发散，而不是能量或偶极矩的物理误差。**\n将 $F_{AB}=F_{BA}=0$ 保持了 Fock 矩阵的厄米性。近似矩阵 $\\mathbf{F}'$ 是实对角矩阵，因此是厄米矩阵。此外，这是一个单电子体系，因此没有 SCF 过程。这个选项的前提存在根本性缺陷。\n**判定：错误。**\n\n**D. 对能量或偶极矩都没有显著影响，因为根据设定 $|V|<\\tau$，所以阈值筛选保证了其物理影响可以忽略不计。**\n这个选项代表了对问题的天真误解。虽然被丢弃的矩阵元 $V$ 在数值上很小，但它的移除导致了物理性质的定性变化（从离域到局域），因为它造成了人为的简并。对偶极矩的影响是灾难性的，而不是可以忽略的。\n**判定：错误。**\n\n**E. 尽管初始对角化忽略了 $V$，但自洽场 (SCF) 迭代会通过密度矩阵重新生成有效的耦合，使得最终状态保持离域，并且能量误差被限制在 $\\mathcal{O}(V^2)$ 内。**\n该问题涉及一个单电子体系，其 Fock 矩阵是恒定的，没有 SCF 迭代。此选项不适用。即使在多电子体系中，也不能保证 SCF 迭代会纠正人为的局域化；实际上，SCF 可能会陷入这种对称破缺解中。\n**判定：错误。**",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}