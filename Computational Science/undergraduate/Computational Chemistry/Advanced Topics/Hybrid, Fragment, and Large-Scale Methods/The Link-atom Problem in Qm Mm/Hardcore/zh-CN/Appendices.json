{
    "hands_on_practices": [
        {
            "introduction": "连接原子方法引入了一个人为的化学键（例如，C-H键），其键长通常是一个固定的参数。这个由用户选择的键长可能会在体系中引入不自然的机械应变，从而影响计算结果。本练习  使用一个简谐振子模型，来量化这个看似随意的参数选择如何系统性地改变一个关键的化学可观测量——反应能垒。通过这个练习，你将亲身体会到QM/MM计算结果对边界参数的敏感性。",
            "id": "2465050",
            "problem": "在一个采用连接原子方法的量子力学/分子力学 (QM/MM) 混合计算中，一个氢原子被用来在边界处封端一个被切断的碳-碳键，形成一个人工的碳-氢键，其长度通过构造固定为一个选定的值 $r_{\\mathrm{L}}$，单位为埃（$\\text{Å}$）。考虑一个简单且具有物理基础的模型，其中在给定的分子结构下，这个封端键对总势能的能量贡献由一个围绕内禀的、依赖于状态的平衡距离 $r_{\\mathrm{eq}}$ 的一维谐振子近似来描述，\n$$\nE_{\\mathrm{link}} = \\tfrac{1}{2}\\,k\\,(r_{\\mathrm{L}} - r_{\\mathrm{eq}})^2,\n$$\n其中 $k$ 是力常数，单位为 $\\mathrm{kJ\\,mol^{-1}\\,\\text{Å}^{-2}}$，$r_{\\mathrm{L}}$ 是施加的连接原子碳-氢键长，单位为 $\\text{Å}$，而 $r_{\\mathrm{eq}}$ 是在该几何构型（反应物或过渡态）下，与量子区域的电子态相适应的平衡键长，单位为 $\\text{Å}$。假设反应物和过渡态的内禀（未封端）Born–Oppenheimer 能量不依赖于 $r_{\\mathrm{L}}$，因此计算出的反应能垒的任何变化仅源于过渡态和反应物之间 $E_{\\mathrm{link}}$ 的差异。\n\n将给定 $r_{\\mathrm{L}}$ 选择下的计算能垒定义为\n$$\n\\Delta G^\\ddagger_{\\text{comp}}(r_{\\mathrm{L}}) = \\left[E_0(\\text{TS}) - E_0(\\text{R})\\right] + \\left[E_{\\mathrm{link}}(\\text{TS}; r_{\\mathrm{L}}) - E_{\\mathrm{link}}(\\text{R}; r_{\\mathrm{L}})\\right],\n$$\n其中 $E_0(\\text{TS})$ 和 $E_0(\\text{R})$ 是不依赖于 $r_{\\mathrm{L}}$ 的内禀态能量。当 $r_{\\mathrm{L}}$ 从 $r_{\\mathrm{L},1}$ 变为 $r_{\\mathrm{L},2}$ 时，对计算能垒的影响即为差值\n$$\n\\Delta_{\\mathrm{barrier}} = \\Delta G^\\ddagger_{\\text{comp}}(r_{\\mathrm{L},2}) - \\Delta G^\\ddagger_{\\text{comp}}(r_{\\mathrm{L},1}) = \\left[E_{\\mathrm{link}}(\\text{TS}; r_{\\mathrm{L},2}) - E_{\\mathrm{link}}(\\text{R}; r_{\\mathrm{L},2})\\right] - \\left[E_{\\mathrm{link}}(\\text{TS}; r_{\\mathrm{L},1}) - E_{\\mathrm{link}}(\\text{R}; r_{\\mathrm{L},1})\\right].\n$$\n\n使用上述模型，编写一个程序，为下面的每个测试用例计算当连接原子键长从 $r_{\\mathrm{L},1} = 1.0$ $\\text{Å}$ 变为 $r_{\\mathrm{L},2} = 1.1$ $\\text{Å}$ 这一特定变化下 $\\Delta_{\\mathrm{barrier}}$ 的值，单位为 $\\mathrm{kJ\\,mol^{-1}}$。对于每种状态，请使用所提供的力常数 $k$ 以及内禀平衡距离 $r_{\\mathrm{eq}}(\\text{R})$ 和 $r_{\\mathrm{eq}}(\\text{TS})$。\n\n测试组（每项给出 $(k, r_{\\mathrm{eq}}(\\text{R}), r_{\\mathrm{eq}}(\\text{TS}))$）：\n- 情况 1：$(k = 1500,\\ r_{\\mathrm{eq}}(\\text{R}) = 1.09,\\ r_{\\mathrm{eq}}(\\text{TS}) = 1.08)$。\n- 情况 2：$(k = 1500,\\ r_{\\mathrm{eq}}(\\text{R}) = 1.09,\\ r_{\\mathrm{eq}}(\\text{TS}) = 1.09)$。\n- 情况 3：$(k = 1500,\\ r_{\\mathrm{eq}}(\\text{R}) = 1.10,\\ r_{\\mathrm{eq}}(\\text{TS}) = 1.06)$。\n- 情况 4：$(k = 500,\\ r_{\\mathrm{eq}}(\\text{R}) = 1.09,\\ r_{\\mathrm{eq}}(\\text{TS}) = 1.08)$。\n- 情况 5：$(k = 1500,\\ r_{\\mathrm{eq}}(\\text{R}) = 1.07,\\ r_{\\mathrm{eq}}(\\text{TS}) = 1.09)$。\n\n要求：\n- 对所有情况，使用 $r_{\\mathrm{L},1} = 1.0$ $\\text{Å}$ 和 $r_{\\mathrm{L},2} = 1.1$ $\\text{Å}$。\n- 将每个结果 $\\Delta_{\\mathrm{barrier}}$ 以 $\\mathrm{kJ\\,mol^{-1}}$ 为单位表示，并四舍五入到三位小数。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表（例如 `[x_1,x_2,x_3,x_4,x_5]`），其中每个 $x_i$ 对应于上面所列顺序中情况 $i$ 的结果。",
            "solution": "所述问题需要经过验证。\n\n**第1步：提取已知条件**\n\n*   封端键的能量贡献：$E_{\\mathrm{link}} = \\tfrac{1}{2}\\,k\\,(r_{\\mathrm{L}} - r_{\\mathrm{eq}})^2$。\n*   $k$：力常数，单位为 $\\mathrm{kJ\\,mol^{-1}\\,\\text{Å}^{-2}}$。\n*   $r_{\\mathrm{L}}$：施加的连接原子键长，单位为 $\\text{Å}$。\n*   $r_{\\mathrm{eq}}$：内禀的、依赖于状态的平衡键长，单位为 $\\text{Å}$。\n*   计算的反应能垒：$\\Delta G^\\ddagger_{\\text{comp}}(r_{\\mathrm{L}}) = \\left[E_0(\\text{TS}) - E_0(\\text{R})\\right] + \\left[E_{\\mathrm{link}}(\\text{TS}; r_{\\mathrm{L}}) - E_{\\mathrm{link}}(\\text{R}; r_{\\mathrm{L}})\\right]$。\n*   计算能垒的变化：$\\Delta_{\\mathrm{barrier}} = \\Delta G^\\ddagger_{\\text{comp}}(r_{\\mathrm{L},2}) - \\Delta G^\\ddagger_{\\text{comp}}(r_{\\mathrm{L},1}) = \\left[E_{\\mathrm{link}}(\\text{TS}; r_{\\mathrm{L},2}) - E_{\\mathrm{link}}(\\text{R}; r_{\\mathrm{L},2})\\right] - \\left[E_{\\mathrm{link}}(\\text{TS}; r_{\\mathrm{L},1}) - E_{\\mathrm{link}}(\\text{R}; r_{\\mathrm{L},1})\\right]$。\n*   固定的连接原子长度：$r_{\\mathrm{L},1} = 1.0$ $\\text{Å}$ 和 $r_{\\mathrm{L},2} = 1.1$ $\\text{Å}$。\n*   测试组为 $(k, r_{\\mathrm{eq}}(\\text{R}), r_{\\mathrm{eq}}(\\text{TS}))$：\n    *   情况 1：$(1500, 1.09, 1.08)$\n    *   情况 2：$(1500, 1.09, 1.09)$\n    *   情况 3：$(1500, 1.10, 1.06)$\n    *   情况 4：$(500, 1.09, 1.08)$\n    *   情况 5：$(1500, 1.07, 1.09)$\n\n**第2步：使用提取的已知条件进行验证**\n\n1.  **科学上合理**：该问题利用谐势来模拟共价键，这是一种标准且物理上合理的近似方法（类比于键的胡克定律）。这是一个简化但成熟的模型，在计算化学中用于分析 QM/MM 计算中连接原子方案引入的人为效应。所提供的物理量——C-H 键长约为 $1.1$ $\\text{Å}$，力常数为 $1500$ $\\mathrm{kJ\\,mol^{-1}\\,\\text{Å}^{-2}}$——在物理上是现实的。该问题是合理的。\n2.  **定义明确**：该问题以数学精度进行了规定。它为待计算量 $\\Delta_{\\mathrm{barrier}}$ 提供了明确的公式，并提供了所有必要的数值输入。存在唯一解且可求。\n3.  **客观性**：该问题以客观、定量的术语陈述，没有歧义或主观内容。\n4.  **完整且一致**：该问题是自洽的。所有变量（$k$、$r_{\\mathrm{L}}$、$r_{\\mathrm{eq}}$）均已定义，并且为每次计算提供了它们的值。没有矛盾之处。\n\n**第3步：结论与行动**\n\n该问题在科学上合理、定义明确且内部一致。因此被判定为**有效**。将推导解答。\n\n需要计算的量是当固定的连接原子键长从 $r_{\\mathrm{L},1}$ 变为 $r_{\\mathrm{L},2}$ 时，计算出的反应能垒的变化量 $\\Delta_{\\mathrm{barrier}}$。提供的表达式为：\n$$\n\\Delta_{\\mathrm{barrier}} = \\left[E_{\\mathrm{link}}(\\text{TS}; r_{\\mathrm{L},2}) - E_{\\mathrm{link}}(\\text{R}; r_{\\mathrm{L},2})\\right] - \\left[E_{\\mathrm{link}}(\\text{TS}; r_{\\mathrm{L},1}) - E_{\\mathrm{link}}(\\text{R}; r_{\\mathrm{L},1})\\right]\n$$\n此处，`TS` 表示过渡态，`R` 表示反应物。问题陈述意味着对于给定的测试用例，力常数 $k$ 对于反应物和过渡态模型是相同的。在进行数值计算之前，可以对表达式进行解析简化。这是一个关于正确代数操作的练习，而不仅仅是暴力计算。\n\n我们首先按状态对各项重新分组：\n$$\n\\Delta_{\\mathrm{barrier}} = \\left[E_{\\mathrm{link}}(\\text{TS}; r_{\\mathrm{L},2}) - E_{\\mathrm{link}}(\\text{TS}; r_{\\mathrm{L},1})\\right] - \\left[E_{\\mathrm{link}}(\\text{R}; r_{\\mathrm{L},2}) - E_{\\mathrm{link}}(\\text{R}; r_{\\mathrm{L},1})\\right]\n$$\n现在，代入连接原子能量的定义 $E_{\\mathrm{link}}(S; r_{\\mathrm{L}}) = \\frac{1}{2} k (r_{\\mathrm{L}} - r_{\\mathrm{eq}}(S))^2$，其中 $S$ 是 `R` 或 `TS`：\n$$\n\\Delta_{\\mathrm{barrier}} = \\left[ \\frac{1}{2}k(r_{\\mathrm{L},2} - r_{\\mathrm{eq}}(\\text{TS}))^2 - \\frac{1}{2}k(r_{\\mathrm{L},1} - r_{\\mathrm{eq}}(\\text{TS}))^2 \\right] - \\left[ \\frac{1}{2}k(r_{\\mathrm{L},2} - r_{\\mathrm{eq}}(\\text{R}))^2 - \\frac{1}{2}k(r_{\\mathrm{L},1} - r_{\\mathrm{eq}}(\\text{R}))^2 \\right]\n$$\n提出公因式 $\\frac{1}{2}k$：\n$$\n\\Delta_{\\mathrm{barrier}} = \\frac{1}{2}k \\left( \\left[ (r_{\\mathrm{L},2} - r_{\\mathrm{eq}}(\\text{TS}))^2 - (r_{\\mathrm{L},1} - r_{\\mathrm{eq}}(\\text{TS}))^2 \\right] - \\left[ (r_{\\mathrm{L},2} - r_{\\mathrm{eq}}(\\text{R}))^2 - (r_{\\mathrm{L},1} - r_{\\mathrm{eq}}(\\text{R}))^2 \\right] \\right)\n$$\n我们应用平方差恒等式 $a^2 - b^2 = (a-b)(a+b)$。对于任意状态 $S$，令 $a = r_{\\mathrm{L},2} - r_{\\mathrm{eq}}(S)$ 和 $b = r_{\\mathrm{L},1} - r_{\\mathrm{eq}}(S)$。\n那么 $a-b = (r_{\\mathrm{L},2} - r_{\\mathrm{eq}}(S)) - (r_{\\mathrm{L},1} - r_{\\mathrm{eq}}(S)) = r_{\\mathrm{L},2} - r_{\\mathrm{L},1}$。\n并且 $a+b = (r_{\\mathrm{L},2} - r_{\\mathrm{eq}}(S)) + (r_{\\mathrm{L},1} - r_{\\mathrm{eq}}(S)) = r_{\\mathrm{L},2} + r_{\\mathrm{L},1} - 2 r_{\\mathrm{eq}}(S)$。\n因此，平方差项为 $(r_{\\mathrm{L},2} - r_{\\mathrm{L},1})(r_{\\mathrm{L},2} + r_{\\mathrm{L},1} - 2 r_{\\mathrm{eq}}(S))$。\n\n将此代回 $\\Delta_{\\mathrm{barrier}}$ 的表达式中：\n$$\n\\Delta_{\\mathrm{barrier}} = \\frac{1}{2}k \\left( (r_{\\mathrm{L},2} - r_{\\mathrm{L},1})(r_{\\mathrm{L},2} + r_{\\mathrm{L},1} - 2 r_{\\mathrm{eq}}(\\text{TS})) - (r_{\\mathrm{L},2} - r_{\\mathrm{L},1})(r_{\\mathrm{L},2} + r_{\\mathrm{L},1} - 2 r_{\\mathrm{eq}}(\\text{R})) \\right)\n$$\n提出公因式 $(r_{\\mathrm{L},2} - r_{\\mathrm{L},1})$：\n$$\n\\Delta_{\\mathrm{barrier}} = \\frac{1}{2}k (r_{\\mathrm{L},2} - r_{\\mathrm{L},1}) \\left( (r_{\\mathrm{L},2} + r_{\\mathrm{L},1} - 2 r_{\\mathrm{eq}}(\\text{TS})) - (r_{\\mathrm{L},2} + r_{\\mathrm{L},1} - 2 r_{\\mathrm{eq}}(\\text{R})) \\right)\n$$\n大括号内的项可以大幅简化：\n$$\n(r_{\\mathrm{L},2} + r_{\\mathrm{L},1} - 2 r_{\\mathrm{eq}}(\\text{TS})) - (r_{\\mathrm{L},2} + r_{\\mathrm{L},1} - 2 r_{\\mathrm{eq}}(\\text{R})) = -2 r_{\\mathrm{eq}}(\\text{TS}) + 2 r_{\\mathrm{eq}}(\\text{R}) = 2(r_{\\mathrm{eq}}(\\text{R}) - r_{\\mathrm{eq}}(\\text{TS}))\n$$\n这导出了最终的、简洁的表达式：\n$$\n\\Delta_{\\mathrm{barrier}} = \\frac{1}{2}k (r_{\\mathrm{L},2} - r_{\\mathrm{L},1}) \\left[ 2(r_{\\mathrm{eq}}(\\text{R}) - r_{\\mathrm{eq}}(\\text{TS})) \\right]\n$$\n$$\n\\Delta_{\\mathrm{barrier}} = k (r_{\\mathrm{L},2} - r_{\\mathrm{L},1}) (r_{\\mathrm{eq}}(\\text{R}) - r_{\\mathrm{eq}}(\\text{TS}))\n$$\n必须实现的就是这个简化公式。它揭示了能垒的变化与力常数 $k$、连接原子长度的变化 $(r_{\\mathrm{L},2} - r_{\\mathrm{L},1})$ 以及反应物和过渡态之间内禀平衡键长的变化 $(r_{\\mathrm{eq}}(\\text{R}) - r_{\\mathrm{eq}}(\\text{TS}))$ 成正比。\n\n对于所有测试用例，连接原子长度的变化是恒定的：\n$$\nr_{\\mathrm{L},2} - r_{\\mathrm{L},1} = 1.1 \\, \\text{Å} - 1.0 \\, \\text{Å} = 0.1 \\, \\text{Å}\n$$\n因此，每个测试用例的计算都使用以下公式进行：\n$$\n\\Delta_{\\mathrm{barrier}} [\\mathrm{kJ\\,mol^{-1}}] = k \\times (0.1) \\times (r_{\\mathrm{eq}}(\\text{R}) - r_{\\mathrm{eq}}(\\text{TS}))\n$$\n单位是一致的：$(\\mathrm{kJ\\,mol^{-1}\\,\\text{Å}^{-2}}) \\times (\\text{Å}) \\times (\\text{Å}) = \\mathrm{kJ\\,mol^{-1}}$。数值结果将按要求四舍五入到三位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the change in the computed QM/MM reaction barrier due to a change\n    in the link-atom bond length, based on a harmonic potential model.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each tuple contains (k [kJ/mol/Å^2], r_eq(R) [Å], r_eq(TS) [Å]).\n    test_cases = [\n        (1500, 1.09, 1.08),  # Case 1\n        (1500, 1.09, 1.09),  # Case 2\n        (1500, 1.10, 1.06),  # Case 3\n        (500, 1.09, 1.08),   # Case 4\n        (1500, 1.07, 1.09),  # Case 5\n    ]\n    \n    # Imposed link-atom bond lengths in Ångströms.\n    r_L1 = 1.0\n    r_L2 = 1.1\n\n    # The analytical derivation simplifies the formula for the change in barrier to:\n    # delta_barrier = k * (r_L2 - r_L1) * (r_eq(R) - r_eq(TS))\n    # Pre-calculate the change in link-atom length.\n    delta_r_L = r_L2 - r_L1\n    \n    results = []\n    for case in test_cases:\n        k, req_R, req_TS = case\n        \n        # Calculate the change in equilibrium bond length between Reactant and TS.\n        delta_req = req_R - req_TS\n        \n        # Calculate the change in the computed barrier.\n        delta_barrier = k * delta_r_L * delta_req\n        \n        # Format the result to three decimal places and append to the list.\n        # Using format string to ensure trailing zeros are included.\n        results.append(f\"{delta_barrier:.3f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "除了机械应变，连接原子还会引入静电伪影。连接原子自身携带的部分电荷会产生一个电场，这个电场会人为地极化QM区域的电子密度，这种效应被称为“过极化”。本练习  使用一个极简模型，将QM区域看作一个可极化的点，来分离并研究这种静电效应。通过计算连接原子模型与更真实的参考模型之间的极化能差异，你将对这种静电伪影的大小建立起定量的认识。",
            "id": "2465055",
            "problem": "在混合量子力学/分子力学 (QM/MM) 计算中，跨越量子区域和经典区域边界的共价键通常被切断，并引入一个“连接原子”以满足化合价。连接原子可以通过其与经典点电荷的静电相互作用，人为地极化量子区域。考虑以下最小化的、第一性原理的数值测试，以量化这种由连接原子引起的人为极化。\n\n将量子区域建模为位于原点的各向同性线性可极化点，其标量极化率为 $\\alpha$（单位为原子单位，$\\text{玻尔}^3$）。外部静电环境由位于位置 $\\mathbf{R}_i$、电荷为 $q_i$（单位为基本电荷）的点电荷，以及一个位于位置 $\\mathbf{r}_{\\mathrm{LA}}$ 的连接原子电荷 $q_{\\mathrm{LA}}$ 组成。所有距离以玻尔为单位，所有电荷以基本电荷为单位。完全在原子单位下进行计算，因此库仑常数为 1，感应偶极矩的单位是 $ea_0$，极化能的单位是哈特里。\n\n令 $\\mathbf{E}(\\{\\,(q_j,\\mathbf{R}_j)\\,\\})$ 表示由一组点电荷 $\\{(q_j,\\mathbf{R}_j)\\}$ 在原点产生的电场，在原子单位下定义为\n$$\n\\mathbf{E} = \\sum_j q_j \\frac{\\mathbf{R}_j}{\\lVert \\mathbf{R}_j \\rVert^3}.\n$$\n在线性响应下，感应偶极矩为 $\\boldsymbol{\\mu} = \\alpha \\mathbf{E}$，极化能为\n$$\nU_{\\mathrm{pol}} = -\\tfrac{1}{2}\\,\\alpha\\,\\lVert \\mathbf{E} \\rVert^2.\n$$\n定义两种情景：\n- LA-on：将连接原子作为位于 $\\mathbf{r}_{\\mathrm{LA}}$ 的点电荷，与分子力学 (MM) 点电荷一起明确地包含在计算中。\n- Reference (charge-shift)：从 $\\mathbf{r}_{\\mathrm{LA}}$ 移除连接原子电荷，并将其放置在与被切断的键共线的边界重原子位置 $\\mathbf{r}_{\\mathrm{B}}$；MM 电荷保持不变。\n\n定义人为极化度量 $\\Delta U$ 为\n$$\n\\Delta U \\equiv \\left| U_{\\mathrm{pol}}^{(\\mathrm{on})} - U_{\\mathrm{pol}}^{(\\mathrm{ref})} \\right| = \\tfrac{1}{2}\\,\\alpha\\,\\left| \\lVert \\mathbf{E}_{\\mathrm{on}} \\rVert^2 - \\lVert \\mathbf{E}_{\\mathrm{ref}} \\rVert^2 \\right|.\n$$\n\n使用上述定义，为以下测试案例集计算 $\\Delta U$。对于每个案例，给定 $\\alpha$、$q_{\\mathrm{LA}}$、$\\mathbf{r}_{\\mathrm{LA}}$、$\\mathbf{r}_{\\mathrm{B}}$ 以及一个 MM 电荷列表 $\\{(q_i,\\mathbf{R}_i)\\}$。\n\n所有距离以玻尔为单位，电荷以基本电荷为单位，$\\Delta U$ 的要求输出单位是哈特里。您的程序必须输出四舍五入到六位小数的结果。\n\n测试集：\n1. 一般非对称环境：\n   - $\\alpha = 10.0$\n   - $q_{\\mathrm{LA}} = 0.3$\n   - $\\mathbf{r}_{\\mathrm{LA}} = (2.06,\\,0.00,\\,0.00)$\n   - $\\mathbf{r}_{\\mathrm{B}} = (-2.91,\\,0.00,\\,0.00)$\n   - MM 电荷: $\\{(0.5,\\,(8.00,\\,0.00,\\,0.00)),\\,(-0.4,\\,(-7.00,\\,2.00,\\,0.00))\\}$\n\n2. 在连接原子侧有强的邻近 MM 电荷：\n   - $\\alpha = 10.0$\n   - $q_{\\mathrm{LA}} = 0.3$\n   - $\\mathbf{r}_{\\mathrm{LA}} = (2.06,\\,0.00,\\,0.00)$\n   - $\\mathbf{r}_{\\mathrm{B}} = (-2.91,\\,0.00,\\,0.00)$\n   - MM 电荷: $\\{(0.8,\\,(3.00,\\,0.00,\\,0.00))\\}$\n\n3. 零极化率的边界条件：\n   - $\\alpha = 0.0$\n   - $q_{\\mathrm{LA}} = 0.3$\n   - $\\mathbf{r}_{\\mathrm{LA}} = (2.06,\\,0.00,\\,0.00)$\n   - $\\mathbf{r}_{\\mathrm{B}} = (-2.91,\\,0.00,\\,0.00)$\n   - MM 电荷: $\\{(0.8,\\,(3.00,\\,0.00,\\,0.00))\\}$\n\n4. 零连接原子电荷的边界条件：\n   - $\\alpha = 10.0$\n   - $q_{\\mathrm{LA}} = 0.0$\n   - $\\mathbf{r}_{\\mathrm{LA}} = (2.06,\\,0.00,\\,0.00)$\n   - $\\mathbf{r}_{\\mathrm{B}} = (-2.91,\\,0.00,\\,0.00)$\n   - MM 电荷: $\\{(0.8,\\,(3.00,\\,0.00,\\,0.00))\\}$\n\n5. 对称正 MM 电荷与负连接原子：\n   - $\\alpha = 10.0$\n   - $q_{\\mathrm{LA}} = -0.3$\n   - $\\mathbf{r}_{\\mathrm{LA}} = (2.06,\\,0.00,\\,0.00)$\n   - $\\mathbf{r}_{\\mathrm{B}} = (-2.91,\\,0.00,\\,0.00)$\n   - MM 电荷: $\\{(0.6,\\,(4.00,\\,1.00,\\,0.00)),\\,(0.6,\\,(-4.00,\\,-1.00,\\,0.00))\\}$\n\n要求的最终输出格式：您的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的十进制数列表的结果，单位为哈特里，四舍五入到六位小数，每个测试案例一个数字，按给定顺序排列（例如，`[0.123456,0.000001,0.543210,0.000000,0.111111]`）。",
            "solution": "所述问题具有科学依据、问题明确、客观且内部一致。它提出了一个来自计算化学的简化但有效的模型，用于研究混合 QM/MM 模拟中连接原子方案的人为效应。所有变量、常数和函数形式的定义都足够严谨，可以得出一个唯一且稳定的解。因此，有必要进行全面的分析和求解。\n\n目标是计算人为极化能 $\\Delta U$，它量化了在两种不同的连接原子处理方法下，量子力学 (QM) 区域的极化能差异。QM 区域被建模为位于原点、标量极化率为 $\\alpha$ 的一个点。在外部电场 $\\mathbf{E}$ 中，极化能 $U_{\\mathrm{pol}}$ 由以下公式给出：\n$$\nU_{\\mathrm{pol}} = -\\frac{1}{2}\\,\\alpha\\,\\lVert \\mathbf{E} \\rVert^2\n$$\n其中所有量都使用原子单位。根据问题定义，矢量场 $\\mathbf{E}$ 是对位于位置 $\\{\\mathbf{R}_j\\}$ 的所有外部点电荷 $\\{q_j\\}$ 的求和：\n$$\n\\mathbf{E} = \\sum_j q_j \\frac{\\mathbf{R}_j}{\\lVert \\mathbf{R}_j \\rVert^3}\n$$\n根据其构造，该矢量是原点处标准电场的负值。然而，由于能量表达式取决于范数的平方 $\\lVert \\mathbf{E} \\rVert^2$，这个非标准的符号约定不会影响最终的能量，我们将继续使用给定的定义。\n\n度量 $\\Delta U$ 被定义为两种情景下极化能之间的绝对差值：\n1.  **LA-on ($\\mathrm{on}$)**：总场 $\\mathbf{E}_{\\mathrm{on}}$ 由分子力学 (MM) 电荷集 $\\{(q_i, \\mathbf{R}_i)\\}$ 加上位于位置 $\\mathbf{r}_{\\mathrm{LA}}$ 的连接原子电荷 $q_{\\mathrm{LA}}$ 产生。\n2.  **Reference ($\\mathrm{ref}$)**：总场 $\\mathbf{E}_{\\mathrm{ref}}$ 由相同的 MM 电荷集加上移动到边界原子位置 $\\mathbf{r}_{\\mathrm{B}}$ 的连接原子电荷 $q_{\\mathrm{LA}}$ 产生。\n\n因此，该度量计算如下：\n$$\n\\Delta U \\equiv \\left| U_{\\mathrm{pol}}^{(\\mathrm{on})} - U_{\\mathrm{pol}}^{(\\mathrm{ref})} \\right| = \\left| \\left(-\\frac{1}{2}\\,\\alpha\\,\\lVert \\mathbf{E}_{\\mathrm{on}} \\rVert^2\\right) - \\left(-\\frac{1}{2}\\,\\alpha\\,\\lVert \\mathbf{E}_{\\mathrm{ref}} \\rVert^2\\right) \\right| = \\frac{1}{2}\\,\\alpha\\,\\left| \\lVert \\mathbf{E}_{\\mathrm{on}} \\rVert^2 - \\lVert \\mathbf{E}_{\\mathrm{ref}} \\rVert^2 \\right|\n$$\n为了计算 $\\Delta U$，我们必须首先构建矢量 $\\mathbf{E}_{\\mathrm{on}}$ 和 $\\mathbf{E}_{\\mathrm{ref}}$。让我们将仅由 MM 电荷产生的场贡献定义为 $\\mathbf{E}_{\\mathrm{MM}}$：\n$$\n\\mathbf{E}_{\\mathrm{MM}} = \\sum_{i} q_i \\frac{\\mathbf{R}_i}{\\lVert \\mathbf{R}_i \\rVert^3}\n$$\n两种情景下的场则通过矢量加法给出：\n$$\n\\mathbf{E}_{\\mathrm{on}} = \\mathbf{E}_{\\mathrm{MM}} + q_{\\mathrm{LA}} \\frac{\\mathbf{r}_{\\mathrm{LA}}}{\\lVert \\mathbf{r}_{\\mathrm{LA}} \\rVert^3}\n$$\n$$\n\\mathbf{E}_{\\mathrm{ref}} = \\mathbf{E}_{\\mathrm{MM}} + q_{\\mathrm{LA}} \\frac{\\mathbf{r}_{\\mathrm{B}}}{\\lVert \\mathbf{r}_{\\mathrm{B}} \\rVert^3}\n$$\n每个测试案例的计算步骤如下：\n1.  读取输入参数：$\\alpha$、$q_{\\mathrm{LA}}$、$\\mathbf{r}_{\\mathrm{LA}}$、$\\mathbf{r}_{\\mathrm{B}}$，以及 MM 电荷和位置集 $\\{(q_i, \\mathbf{R}_i)\\}$。\n2.  处理平凡情况。如果 $\\alpha=0$ 或 $q_{\\mathrm{LA}}=0$，则 $\\Delta U = 0$。如果 $\\alpha=0$，前置因子为零。如果 $q_{\\mathrm{LA}}=0$，场 $\\mathbf{E}_{\\mathrm{on}}$ 和 $\\mathbf{E}_{\\mathrm{ref}}$ 变得相同（$\\mathbf{E}_{\\mathrm{on}} = \\mathbf{E}_{\\mathrm{ref}} = \\mathbf{E}_{\\mathrm{MM}}$），导致它们的范数平方差为零。\n3.  对于非平凡情况，通过对所有 MM 点电荷的贡献求和来计算矢量 $\\mathbf{E}_{\\mathrm{MM}}$。在给定的测试案例中，该项对于两种情景都是恒定的。\n4.  将位于 $\\mathbf{r}_{\\mathrm{LA}}$ 的连接原子的贡献加到 $\\mathbf{E}_{\\mathrm{MM}}$ 上，计算总场矢量 $\\mathbf{E}_{\\mathrm{on}}$。\n5.  将位于 $\\mathbf{r}_{\\mathrm{B}}$ 的连接原子的贡献加到 $\\mathbf{E}_{\\mathrm{MM}}$ 上，计算总场矢量 $\\mathbf{E}_{\\mathrm{ref}}$。\n6.  计算 $\\mathbf{E}_{\\mathrm{on}}$ 和 $\\mathbf{E}_{\\mathrm{ref}}$ 的范数平方（矢量分量的平方和）。\n7.  将这些值以及 $\\alpha$ 代入 $\\Delta U$ 的公式中，以获得以哈特里为单位的最终结果。\n\n对所提供的五个测试案例均实施此算法。所有矢量算术和范数均进行数值处理。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the artificial polarization metric Delta U for a series of QM/MM test cases.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"alpha\": 10.0,\n            \"q_la\": 0.3,\n            \"r_la\": np.array([2.06, 0.00, 0.00]),\n            \"r_b\": np.array([-2.91, 0.00, 0.00]),\n            \"mm_charges\": [\n                (0.5, np.array([8.00, 0.00, 0.00])),\n                (-0.4, np.array([-7.00, 2.00, 0.00]))\n            ]\n        },\n        {\n            \"alpha\": 10.0,\n            \"q_la\": 0.3,\n            \"r_la\": np.array([2.06, 0.00, 0.00]),\n            \"r_b\": np.array([-2.91, 0.00, 0.00]),\n            \"mm_charges\": [\n                (0.8, np.array([3.00, 0.00, 0.00]))\n            ]\n        },\n        {\n            \"alpha\": 0.0,\n            \"q_la\": 0.3,\n            \"r_la\": np.array([2.06, 0.00, 0.00]),\n            \"r_b\": np.array([-2.91, 0.00, 0.00]),\n            \"mm_charges\": [\n                (0.8, np.array([3.00, 0.00, 0.00]))\n            ]\n        },\n        {\n            \"alpha\": 10.0,\n            \"q_la\": 0.0,\n            \"r_la\": np.array([2.06, 0.00, 0.00]),\n            \"r_b\": np.array([-2.91, 0.00, 0.00]),\n            \"mm_charges\": [\n                (0.8, np.array([3.00, 0.00, 0.00]))\n            ]\n        },\n        {\n            \"alpha\": 10.0,\n            \"q_la\": -0.3,\n            \"r_la\": np.array([2.06, 0.00, 0.00]),\n            \"r_b\": np.array([-2.91, 0.00, 0.00]),\n            \"mm_charges\": [\n                (0.6, np.array([4.00, 1.00, 0.00])),\n                (0.6, np.array([-4.00, -1.00, 0.00]))\n            ]\n        }\n    ]\n\n    results = []\n\n    for case in test_cases:\n        alpha = case[\"alpha\"]\n        q_la = case[\"q_la\"]\n        r_la = case[\"r_la\"]\n        r_b = case[\"r_b\"]\n        mm_charges = case[\"mm_charges\"]\n\n        # Trivial cases: If alpha is 0, no polarization occurs.\n        # If q_la is 0, the 'on' and 'ref' scenarios are identical.\n        if alpha == 0.0 or q_la == 0.0:\n            results.append(f\"{0.0:.6f}\")\n            continue\n\n        # Calculate the electric field contribution from the MM charges\n        e_mm = np.zeros(3)\n        for q_i, R_i in mm_charges:\n            norm_R_i = np.linalg.norm(R_i)\n            if norm_R_i > 1e-9: # Avoid division by zero\n                e_mm += q_i * R_i / (norm_R_i**3)\n\n        # Calculate the field for the 'LA-on' scenario\n        norm_r_la = np.linalg.norm(r_la)\n        e_field_la_on = q_la * r_la / (norm_r_la**3)\n        e_on = e_mm + e_field_la_on\n        norm_e_on_sq = np.dot(e_on, e_on)\n        \n        # Calculate the field for the 'reference' scenario\n        norm_r_b = np.linalg.norm(r_b)\n        e_field_la_ref = q_la * r_b / (norm_r_b**3)\n        e_ref = e_mm + e_field_la_ref\n        norm_e_ref_sq = np.dot(e_ref, e_ref)\n\n        # Calculate the artificial polarization metric Delta U\n        delta_u = 0.5 * alpha * np.abs(norm_e_on_sq - norm_e_ref_sq)\n        \n        # Append the formatted result\n        results.append(f\"{delta_u:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在分别探讨了孤立的机械和静电伪影之后，这最后一个练习将考察它们的综合效应对一个动态属性——分子扭转势能面——的影响。本练习  使用丁烷旋转的傅里叶级数模型，其中诸如电子耦合减弱和空间/静电不匹配等伪影被明确地参数化。通过比较QM/MM势能面与完整的QM参考势能面，你将看到连接原子误差如何扭曲整个势能面的形状，从而影响能量最低点、最高点以及旋转能垒。",
            "id": "2465054",
            "problem": "给定一个用于描述丁烷中中心碳-碳键旋转的一维扭转势能模型，该模型可作为量子力学 (QM) 参考和量子力学/分子力学 (QM/MM) 连接原子方案的代理。扭转角用 $\\varphi$ 表示，定义在 $[0,2\\pi)$ 区间上，单位为弧度。所有能量必须以千卡/摩尔 (kcal/mol) 为单位表示。\n\n作为扭转角 $\\varphi$ 的函数，完整的量子力学 (QM) 参考势由以下傅里叶级数指定\n$$\nV_{\\mathrm{QM}}(\\varphi) = c_1 \\left(1+\\cos \\varphi \\right) + c_2 \\left(1-\\cos 2\\varphi \\right) + c_3 \\left(1+\\cos 3\\varphi \\right),\n$$\n其系数固定为\n$$\nc_1 = 0.6 \\;\\;\\text{kcal/mol},\\quad c_2 = 0.3 \\;\\;\\text{kcal/mol},\\quad c_3 = 2.7 \\;\\;\\text{kcal/mol}.\n$$\n\n一个在中心键处切断分子的简化量子力学/分子力学 (QM/MM) 连接原子模型的定义如下。跨边界的三重项振幅通过一个因子 $\\alpha$ 进行缩放，以解释连接原子引起的耦合减弱，同时一个额外的一重伪影项用于模拟连接原子引入的残余失配。QM/MM 势定义为\n$$\nV_{\\mathrm{QM/MM}}(\\varphi;\\,\\alpha,\\,C_{\\mathrm{art}}) = c_1 \\left(1+\\cos \\varphi \\right) + c_2 \\left(1-\\cos 2\\varphi \\right) + \\alpha\\,c_3 \\left(1+\\cos 3\\varphi \\right) + C_{\\mathrm{art}}\\left(1-\\cos \\varphi \\right),\n$$\n其中 $\\alpha$ 是无量纲的，$C_{\\mathrm{art}}$ 的单位是千卡/摩尔。\n\n对于任意扭转势 $V(\\varphi)$，旋转势垒 $\\Delta E$ 定义为\n$$\n\\Delta E = \\max_{\\varphi \\in [0,2\\pi)} V(\\varphi) - \\min_{\\varphi \\in [0,2\\pi)} V(\\varphi).\n$$\n\n任务：\n1. 计算完整量子力学势 $V_{\\mathrm{QM}}(\\varphi)$ 的旋转势垒 $\\Delta E_{\\mathrm{QM}}$。\n2. 对于量子力学/分子力学势 $V_{\\mathrm{QM/MM}}(\\varphi;\\,\\alpha,\\,C_{\\mathrm{art}})$，计算下方测试集中每个参数对 $(\\alpha, C_{\\mathrm{art}})$ 对应的旋转势垒 $\\Delta E_{\\mathrm{QM/MM}}$。\n\n测试集（角度单位为弧度，能量单位为千卡/摩尔）：\n- 情况1（边界一致性）：$\\alpha = 1.0$，$C_{\\mathrm{art}} = 0.0$。\n- 情况2（耦合减弱与伪影）：$\\alpha = 0.75$，$C_{\\mathrm{art}} = 0.2$。\n- 情况3（解耦极限与伪影）：$\\alpha = 0.0$，$C_{\\mathrm{art}} = 0.2$。\n- 情况4（过耦合与小伪影）：$\\alpha = 1.1$，$C_{\\mathrm{art}} = 0.1$。\n\n所需输出：\n- 一个列表，包含五个浮点数（单位为千卡/摩尔），按以下顺序排列，每个数值四舍五入到三位小数：\n  1. $\\Delta E_{\\mathrm{QM}}$，\n  2. 情况1的 $\\Delta E_{\\mathrm{QM/MM}}$，\n  3. 情况2的 $\\Delta E_{\\mathrm{QM/MM}}$，\n  4. 情况3的 $\\Delta E_{\\mathrm{QM/MM}}$，\n  5. 情况4的 $\\Delta E_{\\mathrm{QM/MM}}$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，`[x1,x2,x3,x4,x5]`），每个值都四舍五入到三位小数，并以千卡/摩尔为单位表示。",
            "solution": "所提出的问题是计算化学中一个定义明确的练习，涉及一维扭转势能面的分析。它要求计算一个参考量子力学 (QM) 势和一个简化的量子力学/分子力学 (QM/MM) 连接原子模型的旋转势垒。该问题具有科学依据，数学上一致，并且所有必要的参数都已提供。因此，该问题被认为是有效的，并将提供解答。\n\n我们的目标是确定给定扭转势 $V(\\varphi)$ 的旋转势垒 $\\Delta E$，其定义为：\n$$\n\\Delta E = \\max_{\\varphi \\in [0,2\\pi)} V(\\varphi) - \\min_{\\varphi \\in [0,2\\pi)} V(\\varphi)\n$$\n为了找到像 $V(\\varphi)$ 这样的连续可微函数的最大值和最小值，我们必须找到其临界点。临界点是势能对角度 $\\varphi$ 的一阶导数为零的点：\n$$\n\\frac{dV(\\varphi)}{d\\varphi} = 0\n$$\n函数的极值将出现在这些临界点上。势能以余弦项的傅里叶级数形式给出，在区间 $[0, 2\\pi)$ 上是周期性的。\n\n首先，让我们分析完整的量子力学势 $V_{\\mathrm{QM}}(\\varphi)$：\n$$\nV_{\\mathrm{QM}}(\\varphi) = c_1 (1+\\cos \\varphi) + c_2 (1-\\cos 2\\varphi) + c_3 (1+\\cos 3\\varphi)\n$$\n其中 $c_1 = 0.6$，$c_2 = 0.3$，$c_3 = 2.7$（单位均为 kcal/mol）。为了找到临界点，我们计算其导数：\n$$\n\\frac{dV_{\\mathrm{QM}}}{d\\varphi} = -c_1 \\sin \\varphi + 2c_2 \\sin 2\\varphi - 3c_3 \\sin 3\\varphi = 0\n$$\n使用三角恒等式 $\\sin 2\\varphi = 2\\sin\\varphi\\cos\\varphi$ 和 $\\sin 3\\varphi = \\sin\\varphi(4\\cos^2\\varphi-1)$，我们可以将方程重写为：\n$$\n\\sin\\varphi (-c_1 + 4c_2\\cos\\varphi - 3c_3(4\\cos^2\\varphi - 1)) = 0\n$$\n如果 $\\sin\\varphi = 0$（对应于 $\\varphi=0$ 和 $\\varphi=\\pi$），或者括号中的项为零，则该方程成立。令 $x = \\cos\\varphi$。第二个条件变为一个关于 $x$ 的二次方程：\n$$\n-12c_3 x^2 + 4c_2 x + (-c_1 + 3c_3) = 0\n$$\n代入给定的系数：\n$$\n-12(2.7)x^2 + 4(0.3)x + (-0.6 + 3(2.7)) = 0\n$$\n$$\n-32.4x^2 + 1.2x + 7.5 = 0\n$$\n$x = \\cos\\varphi$ 的解为 $x_1 = 0.5$ 和 $x_2 \\approx -0.46296$。两个解都在有效范围 $[-1, 1]$ 内。因此，临界点为 $\\varphi = 0$，$\\varphi=\\pi$，$\\varphi=\\arccos(0.5)=\\pi/3$ 和 $\\varphi=\\arccos(-0.46296) \\approx 2.051$ rad。\n\n在这些临界点上计算 $V_{\\mathrm{QM}}(\\varphi)$ 的值可得：\n-   $V_{\\mathrm{QM}}(0) = c_1(2) + c_2(0) + c_3(2) = 2(0.6+2.7) = 6.6$ kcal/mol。\n-   $V_{\\mathrm{QM}}(\\pi) = c_1(0) + c_2(0) + c_3(0) = 0.0$ kcal/mol。\n-   $V_{\\mathrm{QM}}(\\pi/3) = c_1(1.5) + c_2(1.5) + c_3(0) = 1.5(0.6+0.3) = 1.35$ kcal/mol。\n-   对于 $x \\approx -0.46296$，$V_{\\mathrm{QM}} \\approx 6.172$ kcal/mol。\n\n最大值为 $V_{\\mathrm{max}} = 6.6$ kcal/mol（在 $\\varphi=0$ 处），最小值为 $V_{\\mathrm{min}} = 0.0$ kcal/mol（在 $\\varphi=\\pi$ 处）。\n因此，QM 势的旋转势垒为：\n$$\n\\Delta E_{\\mathrm{QM}} = 6.6 - 0.0 = 6.6 \\;\\text{kcal/mol}\n$$\n\n接下来，我们将相同的步骤应用于 QM/MM 势：\n$$\nV_{\\mathrm{QM/MM}}(\\varphi;\\,\\alpha,\\,C_{\\mathrm{art}}) = c_1 \\left(1+\\cos \\varphi \\right) + c_2 \\left(1-\\cos 2\\varphi \\right) + \\alpha\\,c_3 \\left(1+\\cos 3\\varphi \\right) + C_{\\mathrm{art}}\\left(1-\\cos \\varphi \\right)\n$$\n这可以重写为标准形式 $V(\\varphi) = k_0 + k_1\\cos\\varphi + k_2\\cos 2\\varphi + k_3\\cos 3\\varphi$，其系数为：\n-   $k_1 = c_1 - C_{\\mathrm{art}}$\n-   $k_2 = -c_2$\n-   $k_3 = \\alpha c_3$\n\n导数分析得出与从 $\\sin\\varphi=0$（即 $\\varphi=0, \\pi$）和关于 $x = \\cos\\varphi$ 的二次方程相同的临界点集：\n$$\n12k_3 x^2 + 4k_2 x + (k_1 - 3k_3) = 0\n$$\n$$\n12(\\alpha c_3) x^2 + 4(-c_2)x + (c_1 - C_{\\mathrm{art}} - 3\\alpha c_3) = 0\n$$\n虽然这种解析方法是严谨的，但对于计算实现而言，通过在从 $0$ 到 $2\\pi$ 的 $\\varphi$ 值精细网格上评估势能，来进行数值搜索以找到最大值和最小值，是更直接和稳健的方法。每种情况的结果都通过此方法确定。\n\n情况1：$\\alpha = 1.0$, $C_{\\mathrm{art}} = 0.0$。\n在这种情况下，$V_{\\mathrm{QM/MM}}(\\varphi) = V_{\\mathrm{QM}}(\\varphi)$。逻辑上，势垒必须相同。\n$V_{\\mathrm{max}} = 6.6$ kcal/mol，$V_{\\mathrm{min}} = 0.0$ kcal/mol。\n$\\Delta E_{\\mathrm{QM/MM}} = 6.6 - 0.0 = 6.6$ kcal/mol。\n\n情况2：$\\alpha = 0.75$, $C_{\\mathrm{art}} = 0.2$。\n在其临界点上评估势能可得：\n$V_{\\mathrm{max}} \\approx 5.25$ kcal/mol（在 $\\varphi=0$ 处）。\n$V_{\\mathrm{min}} \\approx 0.40$ kcal/mol（在 $\\varphi=\\pi$ 处）。\n$\\Delta E_{\\mathrm{QM/MM}} = 5.25 - 0.40 = 4.85$ kcal/mol。\n\n情况3：$\\alpha = 0.0$, $C_{\\mathrm{art}} = 0.2$。\n在这里，$\\cos 3\\varphi$ 项消失了。势能变成一个关于 $x = \\cos\\varphi$ 的简单二次函数。\n$$V(\\varphi) = -0.6(\\cos\\varphi)^2 + 0.4\\cos\\varphi + 1.4$$\n最大值出现在 $\\cos\\varphi = 1/3$ 处，得到 $V_{\\mathrm{max}} \\approx 1.467$ kcal/mol。\n最小值出现在 $\\cos\\varphi = -1$（$\\varphi = \\pi$）处，得到 $V_{\\mathrm{min}} = 0.4$ kcal/mol。\n$\\Delta E_{\\mathrm{QM/MM}} = 1.466... - 0.4 = 1.066... \\approx 1.067$ kcal/mol。\n\n情况4：$\\alpha = 1.1$, $C_{\\mathrm{art}} = 0.1$。\n在其临界点上评估势能可得：\n$V_{\\mathrm{max}} \\approx 7.14$ kcal/mol（在 $\\varphi=0$ 处）。\n$V_{\\mathrm{min}} \\approx 0.20$ kcal/mol（在 $\\varphi=\\pi$ 处）。\n$\\Delta E_{\\mathrm{QM/MM}} = 7.14 - 0.20 = 6.94$ kcal/mol。\n\n要求的结果是 QM 情况的势垒，后跟四种 QM/MM 情况的势垒。\n1. $\\Delta E_{\\mathrm{QM}} = 6.600$ kcal/mol\n2. $\\Delta E_{\\mathrm{QM/MM}}$ (情况1) = $6.600$ kcal/mol\n3. $\\Delta E_{\\mathrm{QM/MM}}$ (情况2) = $4.850$ kcal/mol\n4. $\\Delta E_{\\mathrm{QM/MM}}$ (情况3) = $1.067$ kcal/mol\n5. $\\Delta E_{\\mathrm{QM/MM}}$ (情况4) = $6.940$ kcal/mol\n这些值将由所提供的程序计算和格式化。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the torsional potential problem by calculating rotational barriers\n    for the QM and QM/MM models.\n    \"\"\"\n\n    # Fixed coefficients from the problem statement (in kcal/mol)\n    c1 = 0.6\n    c2 = 0.3\n    c3 = 2.7\n\n    # Define a fine grid for the torsion angle phi from 0 to 2*pi.\n    # A grid of 10000 points is sufficient for an accurate numerical search\n    # of the extrema for these smooth functions.\n    phi = np.linspace(0, 2 * np.pi, 10000, endpoint=False)\n\n    # --- Task 1: Compute the rotational barrier for the QM potential ---\n    \n    # Calculate the QM potential V_QM(phi) using Fourier series\n    # V_QM = c1*(1+cos(phi)) + c2*(1-cos(2*phi)) + c3*(1+cos(3*phi))\n    cos_phi = np.cos(phi)\n    cos_2phi = np.cos(2 * phi)\n    cos_3phi = np.cos(3 * phi)\n\n    v_qm = c1 * (1 + cos_phi) + c2 * (1 - cos_2phi) + c3 * (1 + cos_3phi)\n\n    # The rotational barrier is the difference between the max and min potential energy\n    delta_e_qm = np.max(v_qm) - np.min(v_qm)\n\n    results = [delta_e_qm]\n\n    # --- Task 2: Compute rotational barriers for the QM/MM potential cases ---\n\n    # Test suite of parameters (alpha, C_art) for the QM/MM model\n    test_cases = [\n        # Case 1 (boundary consistency)\n        (1.0, 0.0),\n        # Case 2 (reduced coupling with artifact)\n        (0.75, 0.2),\n        # Case 3 (decoupled limit with artifact)\n        (0.0, 0.2),\n        # Case 4 (overcoupling with small artifact)\n        (1.1, 0.1),\n    ]\n\n    for alpha, C_art in test_cases:\n        # Calculate the QM/MM potential V_QM/MM(phi; alpha, C_art)\n        # V_QM/MM = V_QM_base + link_atom_terms\n        # V_QM/MM = c1*(1+cos(phi)) + c2*(1-cos(2*phi)) + alpha*c3*(1+cos(3*phi)) + C_art*(1-cos(phi))\n        \n        v_qmmm = (\n            c1 * (1 + cos_phi)\n            + c2 * (1 - cos_2phi)\n            + alpha * c3 * (1 + cos_3phi)\n            + C_art * (1 - cos_phi)\n        )\n        \n        # Calculate the barrier and add to results\n        delta_e_qmmm = np.max(v_qmmm) - np.min(v_qmmm)\n        results.append(delta_e_qmmm)\n\n    # Format the results to three decimal places and print in the specified format.\n    formatted_results = [f\"{res:.3f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}