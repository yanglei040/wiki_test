{
    "hands_on_practices": [
        {
            "introduction": "要真正掌握内禀反应坐标 (IRC) 的概念，最好从其基本定义入手。第一个练习将剥离数值计算的复杂性，邀请您为一个简单的一维势能面解析地推导出IRC路径，从而将抽象的微分方程与具体解联系起来。通过解决这个问题 ，您将通过观察路径长度 $s$ 如何直接与系统坐标建立联系，从而打下坚实的理论基础。",
            "id": "2899955",
            "problem": "考虑一个由函数 $V(x) = (x^{2}-1)^{2}/4$ 定义的一维模型势能面，其原子质量参数为 $m=1$。位于 $x=0$ 处的驻点是过渡态，极小值点位于 $x=\\pm 1$。在内禀反应坐标（IRC）的形式体系中，路径被定义为在用质量加权坐标表示时，势能面上的最陡下降曲线。令 $q=\\sqrt{m}\\,x$ 表示质量加权坐标，令 $s$ 表示由线元 $\\mathrm{d}s^{2}=\\mathrm{d}q^{2}$ 定义的弧长参数，从而使得切向量满足 $|\\mathrm{d}q/\\mathrm{d}s|=1$，并且路径方向处处与 $V$ 在 $q$ 坐标系下的负梯度对齐。\n\n仅从这些定义和给定的 $V(x)$ 出发，推导出一维情况下控制IRC的微分方程，并使用初始条件 $x(0)=0$ 对其进行积分，以获得连接过渡态与两个极小值点 $x=\\pm 1$ 的两个分支的显式表达式 $x(s)$。然后，将路径长度 $s$ 表示为笛卡尔坐标 $x$ 的函数，证明对于 $m=1$ 的情况，它与 $x$ 的绝对值相符，仅相差一个常数因子，并确定该常数。\n\n以适用于两个分支的 $s(x)$ 的单个封闭形式表达式给出您的最终答案。无需单位。不要四舍五入。",
            "solution": "首先验证问题，以确保其科学性、适定性和客观性。所给的问题陈述描述了理论化学中一个关于内禀反应坐标（IRC）的标准练习。它提供了一个一维势能面 $V(x) = (x^{2}-1)^{2}/4$，一个原子质量参数 $m=1$，以及对质量加权坐标 $q=\\sqrt{m}\\,x$ 和路径弧长 $s$ 的清晰定义。将IRC定义为质量加权坐标下的最陡下降路径是标准做法。所有提供的信息都是自洽且一致的。未发现科学或逻辑上的缺陷。因此，该问题被认为是**有效的**，并将推导求解。\n\n内禀反应坐标（IRC）被定义为在质量加权坐标下追踪的势能面上的最陡下降路径。此路径的切向量 $\\mathrm{d}\\mathbf{q}/\\mathrm{d}s$（其中 $\\mathbf{q}$ 是质量加权坐标的向量，$s$ 是弧长）与势能梯度的负值 $-\\nabla_q V$ 对齐。弧长 $s$ 的定义使得切向量为单位向量，即 $|\\mathrm{d}\\mathbf{q}/\\mathrm{d}s|=1$。这导出了IRC的基本方程：\n$$\n\\frac{\\mathrm{d}\\mathbf{q}}{\\mathrm{d}s} = -\\frac{\\nabla_q V}{|\\nabla_q V|}\n$$\n对于一维系统，向量变成标量，梯度 $\\nabla_q$ 变成导数 $\\mathrm{d}/\\mathrm{d}q$。方程简化为：\n$$\n\\frac{\\mathrm{d}q}{\\mathrm{d}s} = -\\frac{\\mathrm{d}V/\\mathrm{d}q}{|\\mathrm{d}V/\\mathrm{d}q|} = -\\mathrm{sgn}\\left(\\frac{\\mathrm{d}V}{\\mathrm{d}q}\\right)\n$$\n其中 $\\mathrm{sgn}(\\cdot)$ 是符号函数。\n\n质量加权坐标 $q$ 通过 $q = \\sqrt{m}x$ 与笛卡尔坐标 $x$ 相关。势 $V$ 必须表示为 $q$ 的函数。将 $x=q/\\sqrt{m}$ 代入 $V(x)$ 的表达式中：\n$$\nV(q) = \\frac{1}{4} \\left( \\left(\\frac{q}{\\sqrt{m}}\\right)^{2} - 1 \\right)^{2} = \\frac{1}{4} \\left( \\frac{q^{2}}{m} - 1 \\right)^{2}\n$$\n接下来，我们计算 $V$ 对 $q$ 的导数：\n$$\n\\frac{\\mathrm{d}V}{\\mathrm{d}q} = \\frac{1}{4} \\cdot 2 \\left( \\frac{q^{2}}{m} - 1 \\right) \\cdot \\frac{2q}{m} = \\frac{q}{m} \\left( \\frac{q^{2}}{m} - 1 \\right) = \\frac{q(q^{2}-m)}{m^{2}}\n$$\n由于 $m^{2}$ 恒为正，$\\mathrm{d}V/\\mathrm{d}q$ 的符号由项 $q(q^{2}-m)$ 决定。用笛卡尔坐标 $x$ 表示，该项为 $\\sqrt{m}x(m x^{2} - m) = m^{3/2}x(x^{2}-1)$。由于 $m>0$，$\\mathrm{d}V/\\mathrm{d}q$ 的符号与 $x(x^{2}-1)$ 的符号相同。\n因此，此特定问题中IRC的微分方程为：\n$$\n\\frac{\\mathrm{d}q}{\\mathrm{d}s} = -\\mathrm{sgn}(x(x^{2}-1))\n$$\n将 $q=\\sqrt{m}x$ 代入左侧，得到 $\\mathrm{d}(\\sqrt{m}x)/\\mathrm{d}s = \\sqrt{m}(\\mathrm{d}x/\\mathrm{d}s)$。方程变为：\n$$\n\\sqrt{m}\\frac{\\mathrm{d}x}{\\mathrm{d}s} = -\\mathrm{sgn}(x(x^{2}-1))\n$$\n我们现在必须求解这个方程，对于从过渡态 $x=0$ 出发的两个分支，按照惯例，我们在该点设置弧长 $s=0$。\n\n分支1：从过渡态（$x=0$）到极小值点 $x=1$ 的路径。沿着这条路径，坐标 $x$ 位于区间 $0 < x < 1$ 内。在这个区间内，$x>0$ 且 $x^{2}-1<0$，所以乘积 $x(x^{2}-1)$ 为负。\n$$\n\\mathrm{sgn}(x(x^{2}-1)) = -1\n$$\n该分支的微分方程为：\n$$\n\\sqrt{m}\\frac{\\mathrm{d}x}{\\mathrm{d}s} = -(-1) = 1\n$$\n这是一个可分离的微分方程：$\\sqrt{m}\\,\\mathrm{d}x = \\mathrm{d}s$。我们从初始条件 $(x,s) = (0,0)$ 积分到路径上的一个点 $(x,s)$：\n$$\n\\int_{0}^{x} \\sqrt{m} \\, \\mathrm{d}x' = \\int_{0}^{s} \\mathrm{d}s' \\implies \\sqrt{m}x = s\n$$\n路径的显式表达式为 $x(s) = s/\\sqrt{m}$，路径长度作为坐标的函数是 $s(x) = \\sqrt{m}x$。\n\n分支2：从过渡态（$x=0$）到极小值点 $x=-1$ 的路径。沿着这条路径，坐标 $x$ 位于区间 $-1 < x < 0$ 内。在这个区间内，$x<0$ 且 $x^{2}-1<0$，所以乘积 $x(x^{2}-1)$ 为正。\n$$\n\\mathrm{sgn}(x(x^{2}-1)) = +1\n$$\n该分支的微分方程为：\n$$\n\\sqrt{m}\\frac{\\mathrm{d}x}{\\mathrm{d}s} = -(+1) = -1\n$$\n分离变量得到 $\\sqrt{m}\\,\\mathrm{d}x = -\\mathrm{d}s$。从初始条件 $(x,s) = (0,0)$ 积分：\n$$\n\\int_{0}^{x} \\sqrt{m} \\, \\mathrm{d}x' = \\int_{0}^{s} (-1) \\, \\mathrm{d}s' \\implies \\sqrt{m}x = -s\n$$\n路径的显式表达式为 $x(s) = -s/\\sqrt{m}$，路径长度作为坐标的函数是 $s(x) = -\\sqrt{m}x$。\n\n结合两个分支的结果，我们可以将路径长度 $s$ 表示为坐标 $x$ 的单个函数：\n对于 $x \\ge 0$，$s(x) = \\sqrt{m}x$。\n对于 $x < 0$，$s(x) = -\\sqrt{m}x$。\n这等价于紧凑表达式：\n$$\ns(x) = \\sqrt{m}|x|\n$$\n这个结果表明，路径长度 $s$ 与笛卡尔坐标的绝对值 $|x|$ 相符，仅相差一个常数因子 $\\sqrt{m}$。\n\n问题明确指出质量参数为 $m=1$。将此值代入我们推导出的 $s(x)$ 表达式中：\n$$\ns(x) = \\sqrt{1} |x| = |x|\n$$\n因此，对于指定的质量 $m=1$，常数因子为 $1$。最终答案是适用于 $m=1$ 时两个分支的 $s(x)$ 的封闭形式表达式。",
            "answer": "$$\n\\boxed{|x|}\n$$"
        },
        {
            "introduction": "IRC 常被描述为一个球从鞍点滚下的路径。但是，如果我们给它的初始推动方向与最陡下降方向不完全一致，会发生什么呢？这个数值实验  正是探讨了这个问题，揭示了势能面上“分水岭”（dividing surface）的关键性质，并阐明了为何以正确的过渡态振动向量开始IRC计算对于找到真实的反应路径至关重要。",
            "id": "2456634",
            "problem": "考虑一个定义在坐标 $x$ 和 $y$ 上的二维模型势能面，其势能为\n$$\nV(x,y) \\;=\\; \\tfrac{1}{4}x^{4} \\;-\\; \\tfrac{1}{2}x^{2} \\;+\\; \\tfrac{1}{2}y^{2} \\;+\\; d\\,x^{2}y^{2},\n$$\n其中 $d$ 是一个固定的正参数。点 $(x,y)=(0,0)$ 是一个一阶鞍点（过渡态），两个对称相关的极小值点位于 $x$ 轴上 $x$ 不为零的位置。假设所有坐标的质量均为单位质量。内禀反应坐标（IRC）被定义为质量加权坐标中的曲线 $\\mathbf{R}(s)=(x(s),y(s))$，它从过渡态出发，沿着Hessian矩阵的负曲率特征向量方向，遵循势能的最速下降路径。在单位质量下，最速下降流遵循以下常微分方程\n$$\n\\frac{d\\mathbf{R}}{ds} \\;=\\; -\\,\\nabla V\\big(\\mathbf{R}(s)\\big),\n$$\n其中 $s$ 是一个标量路径参数。梯度流的性质意味着\n$$\n\\frac{d}{ds}V\\big(\\mathbf{R}(s)\\big)\\;=\\; \\nabla V\\cdot\\frac{d\\mathbf{R}}{ds} \\;=\\; -\\,\\|\\nabla V\\|^{2}\\,\\le\\,0.\n$$\n过渡态处的Hessian矩阵是在 $(x,y)=(0,0)$ 点计算的 $V(x,y)$ 的二阶导数矩阵。真正的过渡向量是与该Hessian矩阵的唯一负特征值相关联的特征向量。在这个模型中，这个真正的过渡向量指向 $x$ 轴方向（$+x$ 或 $-x$）。\n\n你的任务是编写一个完整的程序，从偏离过渡态的一个小位移开始，沿着一个与真实过渡向量成给定角度旋转的初始单位向量，对最速下降方程进行积分，然后确定轨迹的终点。请使用以下精确规范。\n\n1) 势及其导数：使用 $d=0.5$。势为\n$$\nV(x,y) \\;=\\; \\tfrac{1}{4}x^{4} \\;-\\; \\tfrac{1}{2}x^{2} \\;+\\; \\tfrac{1}{2}y^{2} \\;+\\; 0.5\\,x^{2}y^{2}.\n$$\n其梯度分量为\n$$\n\\frac{\\partial V}{\\partial x} \\;=\\; x^{3} - x + x\\,y^{2},\\qquad\n\\frac{\\partial V}{\\partial y} \\;=\\; y + x^{2}y,\n$$\n其Hessian分量为\n$$\n\\frac{\\partial^{2} V}{\\partial x^{2}} \\;=\\; 3x^{2} - 1 + y^{2},\\quad\n\\frac{\\partial^{2} V}{\\partial y^{2}} \\;=\\; 1 + x^{2},\\quad\n\\frac{\\partial^{2} V}{\\partial x\\,\\partial y} \\;=\\; 2xy.\n$$\n2) 初始条件构建：设过渡态位于 $(x,y)=(0,0)$，真实过渡向量沿 $+x$ 方向。对于给定的角度 $\\theta$（单位为度），定义单位方向 $\\mathbf{u}(\\theta) = (\\cos\\theta,\\,\\sin\\theta)$，其中角度是相对于 $+x$ 方向以通常的逆时针方向解释的。从以下位置开始轨迹\n$$\n\\mathbf{R}(0) \\;=\\; \\delta\\,\\mathbf{u}(\\theta),\n$$\n其中固定的小位移大小为 $\\delta = 10^{-3}$。\n\n3) 作为梯度流的IRC追踪：积分\n$$\n\\frac{d\\mathbf{R}}{ds} \\;=\\; -\\,\\nabla V(\\mathbf{R}),\n$$\n从 $s=0$ 开始直到收敛，收敛定义为 $\\|\\nabla V(\\mathbf{R})\\|\\le \\varepsilon_{\\text{grad}}$ (其中 $\\varepsilon_{\\text{grad}} = 10^{-8}$)，或者直到超过最大路径参数 $s_{\\max}$ (其中 $s_{\\max}=200$）。\n\n4) 终点分类：当满足梯度范数收敛标准时，通过计算终点处的Hessian特征值来对终点 $(x_{\\text{end}},y_{\\text{end}})$ 进行分类。如果所有Hessian特征值都严格为正（在数值容差范围内），则将终点分类为极小值点；如果 $x_{\\text{end}}>0$ 返回整数标签 $2$，如果 $x_{\\text{end}}<0$ 返回 $1$。如果至少有一个Hessian特征值为负（在数值容差范围内）且梯度范数很小，则将其分类为靠近过渡态的一阶鞍点，并返回整数标签 $0$。如果积分在 $s_{\\max}$ 内未达到梯度范数收敛，你仍必须返回一个整数；在这种情况下，如果终点Hessian矩阵有一个负特征值，则返回 $0$，否则如果 $x_{\\text{end}}<0$ 返回 $1$，如果 $x_{\\text{end}}>0$ 返回 $2$。所有数值比较都应使用与上述尺度一致的合理容差。\n\n5) 角度单位：下面提供的所有角度 $\\theta$ 均以度为单位。此问题不涉及物理单位。\n\n6) 测试组：对以下五个测试角度运行程序，使用固定的位移大小 $\\delta = 10^{-3}$ 和上述指定的参数：\n- $\\theta = 0$,\n- $\\theta = 180$,\n- $\\theta = 90$,\n- $\\theta = 80$,\n- $\\theta = 100$.\n\n7) 要求的最终输出格式：你的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔的整数列表，其顺序与上面的测试角度相同。例如，一个可接受的格式是\n$$\n[\\ell_{1},\\ell_{2},\\ell_{3},\\ell_{4},\\ell_{5}],\n$$\n其中每个 $\\ell_{k}$ 是由终点分类规则定义的整数 $0$、$1$ 或 $2$ 之一。\n\n你的实现必须对指定的最速下降方程进行数值积分，并应用所述的分类逻辑。目标是通过算法回答：如果在过渡态处，初始方向从真实过渡向量旋转90度，轨迹会去向何方，以及这与其他旋转相比有何不同？",
            "solution": "该问题要求数值确定二维势能面上从过渡态附近开始的最速下降路径的终点。这是计算化学中一个与内禀反应坐标（IRC）概念相关的经典问题。IRC在形式上连接了过渡态与其相邻的极小值点。\n\n势能面（PES）由以下函数给出：\n$$ V(x,y) = \\tfrac{1}{4}x^{4} - \\tfrac{1}{2}x^{2} + \\tfrac{1}{2}y^{2} + d\\,x^{2}y^{2} $$\n参数 $d = 0.5$。该PES的驻点，即梯度 $\\nabla V = (\\partial V / \\partial x, \\partial V / \\partial y)$ 为零的点，被发现在 $(0,0)$、$(1,0)$ 和 $(-1,0)$。对二阶导数的Hessian矩阵\n$$ \\mathbf{H} = \\begin{pmatrix} \\partial^2 V / \\partial x^2 & \\partial^2 V / \\partial x \\partial y \\\\ \\partial^2 V / \\partial y \\partial x & \\partial^2 V / \\partial y^2 \\end{pmatrix}, $$\n的分析揭示了它们的特性。点 $(0,0)$ 是一个一阶鞍点（一个过渡态），有一个负特征值和一个正特征值。点 $(1,0)$ 和 $(-1,0)$ 是极小值点，其Hessian矩阵的两个特征值都为正。这些点代表了由反应路径连接的稳定反应物和产物态。\n\nIRC路径由最速下降轨迹 $\\mathbf{R}(s) = (x(s), y(s))$ 近似，该轨迹沿着势能梯度的负方向。这由以下常微分方程组（ODEs）描述：\n$$ \\frac{d\\mathbf{R}}{ds} = -\\nabla V(\\mathbf{R}(s)) $$\n其中 $s$ 是路径参数。我们被给予了梯度分量的解析表达式：\n$$ \\nabla V(x,y) = \\begin{pmatrix} x^{3} - x + x y^{2} \\\\ y + x^{2}y \\end{pmatrix} $$\n\n积分不是从过渡态本身开始，因为它是一个不稳定的平衡点，而是从距离它一个小位移 $\\delta = 10^{-3}$ 的地方开始。初始方向由单位向量 $\\mathbf{u}(\\theta) = (\\cos\\theta, \\sin\\theta)$ 指定，其中 $\\theta$ 是相对于 $+x$ 轴的角度（单位为度），$+x$ 轴对应于鞍点的不稳定模式（过渡向量）的方向。因此，初始条件为：\n$$ \\mathbf{R}(0) = \\delta\\,\\mathbf{u}(\\theta) $$\n\n数值解是通过使用一个稳健的算法，例如 `scipy.integrate.solve_ivp` 中实现的算法，来对该常微分方程组进行积分得到的。积分一直进行，直到满足以下两个条件之一：\n$1.$ 路径收敛到一个驻点，这是在梯度范数低于一个阈值时检测到的：$\\|\\nabla V\\| \\le \\varepsilon_{\\text{grad}} = 10^{-8}$。\n$2.$ 路径参数 $s$ 达到允许的最大值，$s_{\\max} = 200$。\n\n终止后，必须对轨迹的终点进行分类。这是通过分析终点 $\\mathbf{R}_{\\text{end}} = (x_{\\text{end}}, y_{\\text{end}})$ 的性质来实现的。计算Hessian矩阵 $\\mathbf{H}(\\mathbf{R}_{\\text{end}})$ 的特征值。\n- 如果任何特征值为负（在数值容差内，取为 $-10^{-8}$），则终点被分类为处于鞍点区域，得到标签 $0$。对于返回到过渡态附近的轨迹，预期会得到此结果，例如从完全沿稳定 $y$ 方向（$\\theta = 90^\\circ$）开始的路径。\n- 如果所有特征值都为非负，则终点位于对应于极小值点的势阱中。然后通过 $x$ 坐标的符号来区分终点：\n  - 如果 $x_{\\text{end}} < 0$，则分配标签 $1$，对应于 $(-1,0)$ 处的极小值点。\n  - 如果 $x_{\\text{end}} > 0$，则分配标签 $2$，对应于 $(1,0)$ 处的极小值点。\n\n无论收敛是由于梯度范数标准还是达到最大路径长度，都应用此分类逻辑。系统的行为预计会显示出分岔；对于在 $0^\\circ$ 附近范围内的初始角度 $\\theta$，轨迹将导致位于 $(1,0)$ 的极小值点，而对于 $180^\\circ$ 附近的角度，它将导致位于 $(-1,0)$ 的极小值点。临界角 $\\theta = 90^\\circ$ 位于两个吸引盆之间的分界（“分水岭”）上，从那里开始的轨迹预计会回落到过渡态。使用 $\\theta=80^\\circ$ 和 $\\theta=100^\\circ$ 的测试用例旨在探查这种分岔行为。\n\n该程序实现了这整个过程。它定义了势的梯度和Hessian矩阵的函数，为每个测试角度设置初始条件，使用事件处理器进行数值积分以检测收敛，并对每条轨迹的终点应用指定的分类规则。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import solve_ivp\n\n# --- Problem-specific constants ---\nD_PARAM = 0.5  # Parameter d in the potential\nDELTA = 1e-3  # Initial displacement magnitude\nEPS_GRAD = 1e-8  # Gradient norm for convergence\nS_MAX = 200.0  # Maximum integration path parameter\nNEG_EIG_TOL = -1e-8 # Tolerance for checking for negative Hessian eigenvalues\n\ndef get_gradient(R):\n    \"\"\"\n    Computes the gradient of the potential V(x,y).\n    R is a 2-element array [x, y].\n    \"\"\"\n    x, y = R\n    x2 = x * x\n    y2 = y * y\n    grad_x = x**3 - x + x * y2\n    grad_y = y + x2 * y\n    return np.array([grad_x, grad_y])\n\ndef get_hessian(R):\n    \"\"\"\n    Computes the Hessian matrix of the potential V(x,y).\n    R is a 2-element array [x, y].\n    \"\"\"\n    x, y = R\n    x2 = x * x\n    y2 = y * y\n    \n    # Hessian components from problem statement.\n    # V(x,y) = 0.25*x^4 - 0.5*x^2 + 0.5*y^2 + 0.5*x^2*y^2\n    # dV/dx = x^3 - x + x*y^2\n    # dV/dy = y + x^2*y\n    # d2V/dx2 = 3x^2 - 1 + y^2\n    # d2V/dy2 = 1 + x^2\n    # d2V/dxdy = 2xy\n    \n    h_xx_correct = 3.0 * x2 - 1.0 + y2\n    h_yy_correct = 1.0 + x2\n    h_xy_correct = 2.0 * x * y\n    \n    return np.array([[h_xx_correct, h_xy_correct], [h_xy_correct, h_yy_correct]])\n\n\ndef classify_trajectory_destination(theta_deg):\n    \"\"\"\n    Integrates a trajectory for a given initial angle and classifies the endpoint.\n    \"\"\"\n    # 1. Set up the initial condition\n    theta_rad = np.deg2rad(theta_deg)\n    R0 = np.array([DELTA * np.cos(theta_rad), DELTA * np.sin(theta_rad)])\n\n    # 2. Define the ODE system for the integrator (dR/ds = -grad(V))\n    def ode_func(s, R):\n        grad = get_gradient(R)\n        return -grad\n\n    # 3. Define the convergence event\n    def convergence_event(s, R):\n        grad_norm = np.linalg.norm(get_gradient(R))\n        return grad_norm - EPS_GRAD\n    convergence_event.terminal = True\n    convergence_event.direction = -1 # Event triggers when value goes from positive to negative\n\n    # 4. Perform the numerical integration\n    sol = solve_ivp(\n        ode_func,\n        t_span=(0, S_MAX),\n        y0=R0,\n        method='DOP853',\n        events=convergence_event,\n        dense_output=True,\n        atol=1e-10,\n        rtol=1e-10\n    )\n\n    # 5. Determine the final point of the trajectory\n    # If the integration was terminated by the event, use the state at the event time.\n    if sol.status == 1 and sol.y_events[0].size > 0:\n        R_end = sol.y_events[0][0, :]\n    else: # Otherwise, use the last point of the integration.\n        R_end = sol.y[:, -1]\n\n    # 6. Classify the destination\n    x_end = R_end[0]\n    hessian_end = get_hessian(R_end)\n    eigenvalues = np.linalg.eigvalsh(hessian_end)\n\n    # If any eigenvalue is negative, it's a saddle-like point (label 0).\n    if np.any(eigenvalues  NEG_EIG_TOL):\n        return 0\n    else: # Otherwise, it's a minimum. Classify by the sign of x.\n        if x_end > 0:\n            return 2\n        else:\n            return 1\n\ndef solve():\n    \"\"\"\n    Main function to run the test suite and print the results.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        0,   # theta = 0 degrees\n        180, # theta = 180 degrees\n        90,  # theta = 90 degrees\n        80,  # theta = 80 degrees\n        100, # theta = 100 degrees\n    ]\n\n    results = []\n    for theta in test_cases:\n        label = classify_trajectory_destination(theta)\n        results.append(label)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "现在我们已经探讨了理论和概念基础，是时候通过构建您自己的IRC追踪程序来将知识付诸实践了。本练习  将指导您实现一个最速下降算法，以追踪一个模型 $\\mathrm{S_N2}$ 反应的IRC。您还将研究改变底层势能面（模拟在量子化学中使用不同基组）如何影响预测的反应路径和能量，这是计算研究中的一项常见任务。",
            "id": "2456650",
            "problem": "要求您为二维模型势能面 (PES) 实现一个内禀反应坐标 (IRC) 跟踪算法，该势能面定性地表示一个 $\\mathrm{S_N2}$ 反应。IRC 定义为在质量加权坐标下，连接一阶鞍点（过渡态）与反应物和产物极小点的最陡下降路径。您的程序应计算并比较由两种不同 PES 参数化预测的 IRC 路径，这两种参数化分别模拟了最小基组 (STO-3G) 和一个更大的基组 (6-311+G**)。\n\n使用的基本原理：\n- 坐标 $\\mathbf{q}$ 上的势能面 (PES) $V(\\mathbf{q})$ 通过负梯度 $-\\nabla V$ 定义力。\n- 过渡态 (TS) 是 Hessian 矩阵具有一个负特征值的驻点，即一阶鞍点：在过渡态处 $\\nabla V = \\mathbf{0}$，且 Hessian 矩阵恰好有一个负特征值。\n- 在单位质量的质量加权坐标中，IRC 路径是从过渡态沿不稳定简正模方向的最陡下降路径，通过沿着负梯度方向并强制执行固定的弧长参数化来获得。\n\n模型 PES：\n使用以下具有坐标 $\\mathbf{q} = (x,y)$ 的二维 PES：\n$$\nV(x,y) \\;=\\; a\\,x^4 \\;-\\; b\\,x^2 \\;+\\; c\\,y^2 \\;+\\; d\\,x\\,y^2 \\;+\\; e\\,x^3,\n$$\n其过渡态位于 $(x,y)=(0,0)$。提供了两套参数，以模拟 ab initio 计算中的不同基组：\n- STO-3G-like 参数：$a=0.40$, $b=1.00$, $c=0.60$, $d=0.05$, $e=0.20$。\n- 6-311+G**-like 参数：$a=0.50$, $b=1.10$, $c=0.70$, $d=0.04$, $e=0.15$。\n\n假设和单位：\n- 在原子单位下工作，质量为单位质量，因此质量加权坐标与笛卡尔坐标重合。能量单位为 Hartree，长度（包括沿路径的弧长）单位为 Bohr。任何涉及 Hessian 矩阵的曲率代理的单位为 $\\sqrt{\\text{Hartree}}/\\text{Bohr}$。\n- 本问题不使用角度。\n\n需要从第一性原理实现的核心任务：\n1. 解析地计算梯度 $\\nabla V$ 和 Hessian 矩阵 $\\nabla^2 V$。\n2. 通过检查梯度为 $\\mathbf{0}$ 且 Hessian 矩阵恰好有一个负特征值，来验证对于每套参数，$(x,y)=(0,0)$ 都是一个一阶鞍点。\n3. 通过对角化 $(0,0)$ 处的 Hessian 矩阵并选择与负特征值对应的特征向量，来确定过渡态处的不稳定简正模。调整该特征向量的方向，使其 $x$ 分量为正。\n4. 通过从过渡态沿不稳定特征向量的 $\\pm$ 方向位移一个微小距离 $\\epsilon$，为前向和后向 IRC 积分生成初始点。\n5. 在单位质量加权坐标中，使用固定的名义弧长步长 $ds$ 并通过回溯来确保能量单调递减，从而沿最陡下降路径进行跟踪。在从 $\\mathbf{q}_k$ 出发的每一步，沿 $-\\nabla V(\\mathbf{q}_k)$ 的单位长度归一化方向移动，并且仅当步长能使 $V$ 减小时才接受。累积所接受步长的实际弧长。当范数 $\\|\\nabla V\\|$ 低于容差 $\\mathrm{tol}$ 或达到最大步数时停止。\n6. 对于每套参数以及前向（朝向产物）和后向（朝向反应物）两个方向，记录沿 IRC 的点序列、总路径长度以及达到的最终最小能量。\n\n需要计算的比较指标：\n对于每个测试案例，计算以下四个标量，比较大基组参数化 (6-311+G**) 与最小基组参数化 (STO-3G)：\n- 过渡态处的曲率代理差异：令 $\\lambda_-$ 表示过渡态处 Hessian 矩阵的负特征值。为每套参数定义一个曲率代理 $\\kappa = \\sqrt{|\\lambda_-|}$，并报告 $\\kappa_{\\text{6-311+G**}} - \\kappa_{\\text{STO-3G}}$，单位为 $\\sqrt{\\text{Hartree}}/\\text{Bohr}$。\n- 前向路径长度差异：$L^{\\text{fwd}}_{\\text{6-311+G**}} - L^{\\text{fwd}}_{\\text{STO-3G}}$，单位为 Bohr。\n- 产物最小能量差异：$E^{\\text{prod}}_{\\text{6-311+G**}} - E^{\\text{prod}}_{\\text{STO-3G}}$，单位为 Hartree。\n- 最大前向路径偏差：使用各自总长度上的等弧长间隔，将两个前向 IRC 路径重采样为各 $N=50$ 个点，然后计算两个重采样路径上对应点之间的最大欧几里得距离。以 Bohr 为单位报告此最大值。\n\n需要实现的数值细节：\n- 使用 $\\nabla V$ 和 $\\nabla^2 V$ 的解析表达式。\n- 使用回溯线搜索，将尝试步长减半，直到能量下降为止，步长设有下限以防止无限循环。\n- 使用 $\\epsilon$ 作为从过渡态沿不稳定特征向量位移的初始幅度。\n- 收敛准则：当 $\\|\\nabla V\\|  \\mathrm{tol}$ 或当接受的步数等于 $\\text{max\\_steps}$ 时停止。\n- 重采样应通过沿每条路径的累积弧长坐标进行线性插值来完成。\n\n测试套件：\n为以下三个测试案例运行您的程序，每个案例指定为一个元组 $(ds, \\mathrm{tol}, \\text{max\\_steps}, \\epsilon)$，其中 $ds$ 和 $\\epsilon$ 的单位为 Bohr，$\\mathrm{tol}$ 的单位为 Hartree/Bohr，$\\text{max\\_steps}$ 是无量纲的：\n- 案例 1 (理想路径): $(0.05, 1\\times 10^{-6}, 400, 1\\times 10^{-3})$。\n- 案例 2 (更严的容差，更小的步长): $(0.02, 1\\times 10^{-7}, 800, 5\\times 10^{-4})$。\n- 案例 3 (更粗的步长): $(0.08, 1\\times 10^{-6}, 500, 1\\times 10^{-3})$。\n\n要求的最终输出格式：\n- 您的程序应生成一个单行输出，其中包含一个结果列表，每个测试案例一个结果，而每个结果本身是按“需要计算的比较指标”部分给出的顺序排列的四个浮点数列表。所有浮点数必须四舍五入到六位小数。例如，输出应如下所示：\n`\"[ [v11,v12,v13,v14],[v21,v22,v23,v24],[v31,v32,v33,v34] ]\"`\n其中每个 $v_{ij}$ 是一个小数点后有六位数字的浮点数，能量单位为 Hartree，长度单位为 Bohr，曲率代理单位为 $\\sqrt{\\text{Hartree}}/\\text{Bohr}$。",
            "solution": "用户提出了一个计算化学问题，要求实现并应用内禀反应坐标 (IRC) 跟踪算法。对问题陈述进行彻底验证是强制性的第一步。\n\n### 问题验证\n\n**第 1 步：提取的已知信息**\n- **势能面 (PES)**：$V(x,y) = a\\,x^4 - b\\,x^2 + c\\,y^2 + d\\,x\\,y^2 + e\\,x^3$。\n- **过渡态 (TS)**：位于 $(x,y)=(0,0)$。\n- **PES 参数集**：\n    - STO-3G-like：$a=0.40$, $b=1.00$, $c=0.60$, $d=0.05$, $e=0.20$。\n    - 6-311+G**-like：$a=0.50$, $b=1.10$, $c=0.70$, $d=0.04$, $e=0.15$。\n- **假设**：原子单位，单位质量（质量加权坐标与笛卡尔坐标相同）。\n- **核心算法**：从过渡态开始的最陡下降路径跟踪，使用解析梯度和 Hessian 矩阵，采用固定的名义弧长步长 $ds$ 和回溯法确保能量下降。\n- **初始条件**：从过渡态沿不稳定简正模特征向量方向位移 $\\pm\\epsilon$。\n- **终止条件**：当梯度范数 $\\|\\nabla V\\|$ 小于容差 $\\mathrm{tol}$ 或达到最大步数 $\\text{max\\_steps}$ 时，路径积分停止。\n- **比较指标**：\n    1. 曲率代理差异：$\\kappa_{\\text{6-311+G**}} - \\kappa_{\\text{STO-3G}}$，其中 $\\kappa = \\sqrt{|\\lambda_-|}$。\n    2. 前向路径长度差异：$L^{\\text{fwd}}_{\\text{6-311+G**}} - L^{\\text{fwd}}_{\\text{STO-3G}}$。\n    3. 产物最小能量差异：$E^{\\text{prod}}_{\\text{6-311+G**}} - E^{\\text{prod}}_{\\text{STO-3G}}$。\n    4. 将两条路径都重采样为 $N=50$ 个等距点后的最大前向路径偏差。\n- **测试案例**：提供了三组 $(ds, \\mathrm{tol}, \\text{max\\_steps}, \\epsilon)$。\n- **输出格式**：一个特定的字符串格式 `\"[ [v11,v12,v13,v14],[v21,v22,v23,v24],[v31,v32,v33,v34] ]\"`，浮点数四舍五入到六位小数。\n\n**第 2 步：使用提取的已知信息进行验证**\n- **科学依据**：该问题在计算化学和物理化学原理方面有充分的依据。IRC 的概念、其与 PES 的关系、过渡态、Hessian 矩阵和简正模都是标准且描述正确的。使用多项式模型 PES 是一种常见的教学和研究工具。\n- **适定性**：问题陈述具有高度的精确性。它提供了数学模型、所有必需的参数、要实现的算法（包括如回溯和终止准则等数值细节），以及对所需输出指标的清晰定义。这确保了存在唯一且可计算的解。\n- **客观性**：问题以客观、技术性的语言陈述，没有歧义、主观性或个人观点。\n\n**第 3 步：结论与行动**\n问题陈述在科学上是合理的、适定的和客观的。它不包含可辨别的缺陷、矛盾或缺失信息。因此，该问题被判定为有效。我将继续进行完整的求解。\n\n### 基于原理的求解设计\n\n核心任务是追踪内禀反应坐标 (IRC)，它代表了势能面 (PES) 上连接过渡态与反应物和产物的最小能量路径。\n\n**1. 势能面的解析表示**\n\nPES 由以下函数给出：\n$$\nV(x,y) = a\\,x^4 - b\\,x^2 + c\\,y^2 + d\\,x\\,y^2 + e\\,x^3\n$$\n在一点 $\\mathbf{q}=(x,y)$ 作用于系统的力由势的负梯度 $-\\nabla V(\\mathbf{q})$ 给出。梯度向量 $\\nabla V$ 是路径跟踪算法所必需的。其分量是 $V$ 的偏导数：\n$$\n\\nabla V(x,y) = \\begin{pmatrix} \\frac{\\partial V}{\\partial x} \\\\ \\frac{\\partial V}{\\partial y} \\end{pmatrix} = \\begin{pmatrix} 4ax^3 - 2bx + dy^2 + 3ex^2 \\\\ 2cy + 2dxy \\end{pmatrix}\n$$\nPES 的局部曲率由 Hessian 矩阵 $\\nabla^2 V$ 描述，该矩阵包含二阶偏导数：\n$$\n\\nabla^2 V(x,y) = \\begin{pmatrix} \\frac{\\partial^2 V}{\\partial x^2}  \\frac{\\partial^2 V}{\\partial x \\partial y} \\\\ \\frac{\\partial^2 V}{\\partial y \\partial x}  \\frac{\\partial^2 V}{\\partial y^2} \\end{pmatrix} = \\begin{pmatrix} 12ax^2 - 2b + 6ex  2dy \\\\ 2dy  2c + 2dx \\end{pmatrix}\n$$\n这些解析表达式是后续分析的基础，将被直接实现。\n\n**2. 过渡态表征**\n\n过渡态 (TS) 是一阶驻点。这要求在过渡态坐标 $\\mathbf{q}_{TS}$ 处满足两个条件：\n1. 梯度必须为零：$\\nabla V(\\mathbf{q}_{TS}) = \\mathbf{0}$。\n2. Hessian 矩阵 $\\nabla^2 V(\\mathbf{q}_{TS})$ 必须恰好有一个负特征值。\n\n问题陈述过渡态位于 $\\mathbf{q}_{TS} = (0,0)$。让我们来验证这一点。\n在 $(0,0)$ 处计算梯度：\n$$\n\\nabla V(0,0) = \\begin{pmatrix} 4a(0)^3 - 2b(0) + d(0)^2 + 3e(0)^2 \\\\ 2c(0) + 2d(0)(0) \\end{pmatrix} = \\begin{pmatrix} 0 \\\\ 0 \\end{pmatrix}\n$$\n第一个条件得到满足。现在，在 $(0,0)$ 处计算 Hessian 矩阵：\n$$\n\\nabla^2 V(0,0) = \\begin{pmatrix} 12a(0)^2 - 2b + 6e(0)  2d(0) \\\\ 2d(0)  2c + 2d(0) \\end{pmatrix} = \\begin{pmatrix} -2b  0 \\\\ 0  2c \\end{pmatrix}\n$$\n这是一个对角矩阵，因此其特征值就是对角元素：$\\lambda_1 = -2b$ 和 $\\lambda_2 = 2c$。对于给定的两套参数，$b  0$ 且 $c  0$。因此，我们有一个负特征值（$\\lambda_-$）和一个正特征值（$\\lambda_+$），证实 $(0,0)$ 是一个一阶鞍点。\n\n与负特征值 $\\lambda_- = -2b$ 关联的特征向量是不稳定简正模，它定义了过渡态处的反应路径方向。对于对角 Hessian 矩阵，该特征向量显然是 $\\mathbf{v}_- = (1, 0)^T$。问题要求调整此向量的方向，使其 x 分量为正，这已经满足了。前向反应路径将从过渡态沿 $+\\mathbf{v}_-$ 方向开始移动，而后向路径将沿 $-\\mathbf{v}_-$ 方向开始移动。\n\n**3. IRC 路径跟踪算法**\n\nIRC 是从过渡态出发的最陡下降路径。我们用一系列离散点 $\\mathbf{q}_k$ 来近似这条连续路径。\n\n- **初始化**：积分从一个沿不稳定模式从过渡态微小位移的点开始。前向路径始于 $\\mathbf{q}_0 = \\mathbf{q}_{TS} + \\epsilon \\mathbf{v}_-$，后向路径始于 $\\mathbf{q}_0 = \\mathbf{q}_{TS} - \\epsilon \\mathbf{v}_-$。\n- **迭代**：从点 $\\mathbf{q}_k$ 出发，通过在归一化的负梯度方向 $\\mathbf{u}_k = -\\nabla V(\\mathbf{q}_k) / \\|\\nabla V(\\mathbf{q}_k)\\|$ 上迈出一步来找到下一个点 $\\mathbf{q}_{k+1}$。\n- **步长控制**：使用一个名义步长 $ds$。一个试验点被提议为 $\\mathbf{q}_{\\text{trial}} = \\mathbf{q}_k + s \\mathbf{u}_k$，初始试验步长为 $s = ds$。\n- **回溯线搜索**：为确保路径能量单调下降，我们检查是否 $V(\\mathbf{q}_{\\text{trial}})  V(\\mathbf{q}_k)$。如果不满足此条件，则步长 $s$ 减半，并测试一个新的 $\\mathbf{q}_{\\text{trial}}$。重复此过程，直到找到一个能量降低的步长，或者步长变得小于机器精度阈值，此时路径终止。\n- **终止**：当梯度范数 $\\|\\nabla V(\\mathbf{q}_k)\\|$ 下降到给定的容差 $\\mathrm{tol}$ 以下，或已执行了最大步数 $\\text{max\\_steps}$ 时，算法停止。\n- **路径长度**：路径的总弧长 $L$ 是每次迭代中实际接受的步长之和。\n\n**4. 比较分析指标**\n\n目的是比较不同的 PES 模型。\n- **曲率代理差异**：值 $\\kappa = \\sqrt{|\\lambda_-|} = \\sqrt{2b}$ 可作为反应势垒曲率的代理。差异 $\\kappa_{\\text{6-311+G**}} - \\kappa_{\\text{STO-3G}}$ 量化了第二个基组模型如何改变过渡态处的势垒锐度。这与 IRC 积分参数无关。\n- **路径长度和能量差异**：总前向路径长度 $L^{\\text{fwd}}$ 和产物极小点的最终能量 $E^{\\text{prod}}$ 的差异，直接比较了两种 PES 模型预测的几何和能量结果。\n- **最大前向路径偏差**：该指标量化了两条反应路径的几何差异性。两条前向路径都被重采样为相同数量（$N=50$）的点，每点之间按其路径总弧长的等分间隔分布。这是通过相对于累积弧长对路径坐标进行线性插值来实现的。然后计算两条重采样路径上相应点之间的最大欧几里得距离。这揭示了两种预测的反应机理之间最大的几何分歧。\n\n实现将遵循这些原则，以解决给定的测试案例并报告四个指定的比较指标。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the IRC following problem for the given test cases and prints the results.\n    \"\"\"\n\n    class PES:\n        \"\"\"\n        Represents the 2D potential energy surface, providing methods for\n        energy, gradient, and Hessian evaluation.\n        \"\"\"\n        def __init__(self, a, b, c, d, e):\n            self.a = a\n            self.b = b\n            self.c = c\n            self.d = d\n            self.e = e\n\n        def V(self, q):\n            \"\"\"Computes the potential energy V at a point q=(x,y).\"\"\"\n            x, y = q\n            return self.a * x**4 - self.b * x**2 + self.c * y**2 + self.d * x * y**2 + self.e * x**3\n\n        def gradV(self, q):\n            \"\"\"Computes the gradient of the potential at a point q=(x,y).\"\"\"\n            x, y = q\n            gx = 4*self.a*x**3 - 2*self.b*x + self.d*y**2 + 3*self.e*x**2\n            gy = 2*self.c*y + 2*self.d*x*y\n            return np.array([gx, gy])\n\n        def hessV(self, q):\n            \"\"\"Computes the Hessian matrix of the potential at a point q=(x,y).\"\"\"\n            x, y = q\n            h_xx = 12*self.a*x**2 - 2*self.b + 6*self.e*x\n            h_yy = 2*self.c + 2*self.d*x\n            h_xy = 2*self.d*y\n            return np.array([[h_xx, h_xy], [h_xy, h_yy]])\n\n    def find_irc_path(pes, start_pos, ds, tol, max_steps, min_step_backtrack=1e-12):\n        \"\"\"\n        Finds an IRC path using a steepest-descent algorithm with backtracking.\n        \n        Returns:\n            - A list of coordinates along the path.\n            - The total arc length of the path.\n            - The final energy at the end of the path.\n        \"\"\"\n        path_coords = [start_pos]\n        q_current = np.copy(start_pos)\n        total_length = 0.0\n        \n        for _ in range(max_steps):\n            grad = pes.gradV(q_current)\n            grad_norm = np.linalg.norm(grad)\n\n            if grad_norm  tol:\n                break\n\n            direction = -grad / grad_norm\n            \n            # Backtracking line search\n            current_s = ds\n            energy_current = pes.V(q_current)\n            \n            while current_s > min_step_backtrack:\n                q_trial = q_current + current_s * direction\n                if pes.V(q_trial)  energy_current:\n                    q_current = q_trial\n                    total_length += current_s\n                    path_coords.append(q_current)\n                    break\n                current_s /= 2.0\n            \n            if current_s = min_step_backtrack: # Could not find a downhill step\n                break\n\n        return np.array(path_coords), total_length, pes.V(q_current)\n\n    def resample_and_compare(path1_coords, path2_coords, n_points=50):\n        \"\"\"\n        Resamples two paths to a common number of points based on arc length\n        and computes the maximum Euclidean deviation between them.\n        \"\"\"\n        if len(path1_coords)  2 or len(path2_coords)  2:\n            return 0.0 # Not enough points to define a path\n\n        # Calculate cumulative arc lengths for each path\n        lengths1 = np.cumsum(np.linalg.norm(np.diff(path1_coords, axis=0), axis=1))\n        lengths1 = np.insert(lengths1, 0, 0)\n        total_len1 = lengths1[-1]\n\n        lengths2 = np.cumsum(np.linalg.norm(np.diff(path2_coords, axis=0), axis=1))\n        lengths2 = np.insert(lengths2, 0, 0)\n        total_len2 = lengths2[-1]\n        \n        if total_len1 == 0 or total_len2 == 0:\n            return 0.0\n        \n        # Create new equidistant arc-length grids\n        new_lengths1 = np.linspace(0, total_len1, n_points)\n        new_lengths2 = np.linspace(0, total_len2, n_points)\n\n        # Interpolate coordinates onto the new grids\n        x1_resampled = np.interp(new_lengths1, lengths1, path1_coords[:, 0])\n        y1_resampled = np.interp(new_lengths1, lengths1, path1_coords[:, 1])\n        resampled_path1 = np.vstack((x1_resampled, y1_resampled)).T\n\n        x2_resampled = np.interp(new_lengths2, lengths2, path2_coords[:, 0])\n        y2_resampled = np.interp(new_lengths2, lengths2, path2_coords[:, 1])\n        resampled_path2 = np.vstack((x2_resampled, y2_resampled)).T\n\n        # Calculate maximum Euclidean deviation\n        deviations = np.linalg.norm(resampled_path1 - resampled_path2, axis=1)\n        return np.max(deviations)\n\n    # --- Main execution ---\n    \n    # Define PES parameter sets\n    params_sto3g = {'a': 0.40, 'b': 1.00, 'c': 0.60, 'd': 0.05, 'e': 0.20}\n    params_6311g = {'a': 0.50, 'b': 1.10, 'c': 0.70, 'd': 0.04, 'e': 0.15}\n    \n    pes_sto3g = PES(**params_sto3g)\n    pes_6311g = PES(**params_6311g)\n    \n    # Define test cases\n    test_cases = [\n        (0.05, 1e-6, 400, 1e-3),   # Case 1\n        (0.02, 1e-7, 800, 5e-4),  # Case 2\n        (0.08, 1e-6, 500, 1e-3),   # Case 3\n    ]\n    \n    all_results = []\n\n    # Transition state analysis (common for all test cases)\n    ts_pos = np.array([0.0, 0.0])\n    \n    # Unstable mode eigenvector at TS (analytically determined)\n    ts_hess_sto3g = pes_sto3g.hessV(ts_pos)\n    evals_sto3g, evecs_sto3g = np.linalg.eigh(ts_hess_sto3g)\n    neg_lambda_sto3g = evals_sto3g[0]\n\n    ts_hess_6311g = pes_6311g.hessV(ts_pos)\n    evals_6311g, evecs_6311g = np.linalg.eigh(ts_hess_6311g)\n    neg_lambda_6311g = evals_6311g[0]\n    \n    # Unstable mode eigenvector is (1,0) for both, x-component is positive.\n    unstable_mode = np.array([1.0, 0.0])\n    \n    # Metric 1: Curvature proxy difference\n    kappa_sto3g = np.sqrt(abs(neg_lambda_sto3g))\n    kappa_6311g = np.sqrt(abs(neg_lambda_6311g))\n    curvature_diff = kappa_6311g - kappa_sto3g\n\n    for ds, tol, max_steps, epsilon in test_cases:\n        # Generate initial points for forward IRC\n        start_pos_fwd = ts_pos + epsilon * unstable_mode\n\n        # Run IRC for STO-3G\n        path_sto3g, len_sto3g, energy_sto3g = find_irc_path(\n            pes_sto3g, start_pos_fwd, ds, tol, max_steps\n        )\n        \n        # Run IRC for 6-311+G**\n        path_6311g, len_6311g, energy_6311g = find_irc_path(\n            pes_6311g, start_pos_fwd, ds, tol, max_steps\n        )\n        \n        # Metric 2: Forward path length difference\n        length_diff = len_6311g - len_sto3g\n        \n        # Metric 3: Product minimum energy difference\n        energy_diff = energy_6311g - energy_sto3g\n        \n        # Metric 4: Maximum forward-path deviation\n        max_dev = resample_and_compare(path_sto3g, path_6311g, n_points=50)\n        \n        case_results = [\n            round(curvature_diff, 6),\n            round(length_diff, 6),\n            round(energy_diff, 6),\n            round(max_dev, 6)\n        ]\n        all_results.append(case_results)\n\n    # Format final output string\n    result_str = \"[\" + \",\".join([f\"[{','.join(f'{v:.6f}' for v in res)}]\" for res in all_results]) + \"]\"\n    print(result_str)\n\nsolve()\n```"
        }
    ]
}