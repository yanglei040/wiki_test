{
    "hands_on_practices": [
        {
            "introduction": "简单模型是理解复杂量子现象的基石。此练习将指导你为一个普遍存在的双态模型，从第一性原理出发推导非绝热耦合向量（NACV），揭示其如何依赖于哈密顿量参数（如能隙和耦合项）。这项实践旨在锻炼你的解析能力，并加深对 NACV 物理起源的理解。",
            "id": "2459464",
            "problem": "一个异核双原子分子，其两个原子核的核间距为 $R$，总共有三个电子。其中两个电子在一个芯轨道中形成一个冻结的闭合壳层，该轨道对于所有 $R$ 都是相同的，并且不与活性空间耦合。剩下的单个活性电子在一个固定的、与 $R$ 无关的正交非绝热基 $\\{|A\\rangle, |B\\rangle\\}$ 中进行描述，其中 $|A\\rangle$ 定域在原子 $A$ 上，而 $|B\\rangle$ 定域在原子 $B$ 上。在这个非绝热基中，有效的单电子哈密顿量是一个实的对称 $2 \\times 2$ 矩阵\n$$\nH(R) \\;=\\; \\begin{pmatrix}\n\\varepsilon_A & V(R) \\\\\nV(R) & \\varepsilon_B\n\\end{pmatrix},\n$$\n其在位能量差为常数 $\\Delta_0 \\equiv \\varepsilon_A - \\varepsilon_B \\neq 0$，非对角电子耦合为\n$$\nV(R) \\;=\\; V_0 \\,\\exp(-\\alpha R),\n$$\n其中 $V_0 > 0$ 和 $\\alpha > 0$ 是常数。该三电子体系的绝热电子态是斯莱特行列式 (Slater determinant)，由冻结的闭合壳层与 $H(R)$ 的单电子本征态的乘积构成。在这些条件下，两个能量最低的双重态绝热态之间的非绝热耦合矢量 (NACV) 完全沿着核间轴，其标量分量由导数耦合给出\n$$\nd_{12}(R) \\;\\equiv\\; \\langle \\Psi_1(R) \\,|\\, \\partial/\\partial R \\,|\\, \\Psi_2(R) \\rangle \\;=\\; \\langle \\psi_1(R) \\,|\\, \\partial/\\partial R \\,|\\, \\psi_2(R) \\rangle,\n$$\n其中 $|\\psi_1(R)\\rangle$ 和 $|\\psi_2(R)\\rangle$ 是 $H(R)$ 的归一化的、实的、依赖于 $R$ 的单电子本征态，按能量递增排序，并且选择相位（规范）以使其在 $R$ 上是平滑的。\n\n从上述定义和第一性原理出发，推导 $d_{12}(R)$ 作为 $R$ 的函数的显式闭合形式解析表达式，用参数 $V_0$、$\\alpha$ 和 $\\Delta_0$ 表示。使用原子单位，其中 $R$ 的单位为玻尔 (bohr)，$\\alpha$ 的单位为逆玻尔 (inverse bohr)，$V_0$ 和 $\\Delta_0$ 的单位为哈特里 (hartree)，因此 $d_{12}(R)$ 的单位为逆玻尔。将最终答案表示为 $R$ 的单个解析函数。不要代入数值，也不要四舍五入；不需要数值近似。",
            "solution": "对问题陈述进行验证。\n\n**第 1 步：提取已知条件**\n-   系统：一个具有单个活性电子的异核双原子分子。\n-   基：一个固定的、与 $R$ 无关的正交非绝热基 $\\{|A\\rangle, |B\\rangle\\}$。\n-   哈密顿量：非绝热基中的有效单电子哈密顿量是一个实的对称 $2 \\times 2$ 矩阵：\n    $$ H(R) = \\begin{pmatrix} \\varepsilon_A & V(R) \\\\ V(R) & \\varepsilon_B \\end{pmatrix} $$\n-   参数：\n    -   在位能量差：$\\Delta_0 \\equiv \\varepsilon_A - \\varepsilon_B \\neq 0$。\n    -   非对角电子耦合：$V(R) = V_0 \\exp(-\\alpha R)$，其中 $V_0 > 0$ 且 $\\alpha > 0$。\n-   绝热态：$|\\psi_1(R)\\rangle$ 和 $|\\psi_2(R)\\rangle$ 是 $H(R)$ 的归一化的、实的、依赖于 $R$ 的单电子本征态，按能量递增排序 ($E_1 < E_2$)。\n-   目标量：非绝热导数耦合 $d_{12}(R)$ 定义为：\n    $$ d_{12}(R) = \\langle \\psi_1(R) \\,|\\, \\frac{\\partial}{\\partial R} \\,|\\, \\psi_2(R) \\rangle $$\n    选择相位以使本征态是 $R$ 的实值平滑函数。\n\n**第 2 步：使用提取的已知条件进行验证**\n-   **科学依据**：该问题描述了一个标准的两态模型系统，这是计算化学和理论化学中研究非绝热过程（如电荷转移）的一个基本且广泛使用的概念。哈密顿量的结构和非绝热耦合的定义是正确的。\n-   **适定性**：该问题是适定的。它提供了所有必要的信息——哈密顿量、其参数以及待推导量的定义——以找到唯一的解析解。\n-   **客观性**：问题以精确、客观和标准的科学语言陈述。\n\n**第 3 步：结论与行动**\n该问题在科学上是合理的、适定的且自洽的。因此，它被判定为**有效**。我们继续进行求解推导。\n\n目标是推导非绝热耦合 $d_{12}(R)$ 的解析表达式。一个直接而严谨的方法是使用非对角 Hellmann-Feynman 定理。对于哈密顿量 $H(R)$ 的两个不同的正交归一本征态 $|\\psi_i\\rangle$ 和 $|\\psi_j\\rangle$（其本征值分别为 $E_i$ 和 $E_j$），导数耦合由下式给出：\n$$ \\langle \\psi_i \\,|\\, \\frac{\\partial}{\\partial R} \\,|\\, \\psi_j \\rangle = \\frac{\\langle \\psi_i \\,|\\, \\frac{\\partial H}{\\partial R} \\,|\\, \\psi_j \\rangle}{E_j - E_i} \\quad (i \\neq j) $$\n我们将此公式应用于 $i=1$ 和 $j=2$ 的情况。这需要我们确定本征值 $E_1(R)$、$E_2(R)$，本征矢量 $|\\psi_1(R)\\rangle$、$|\\psi_2(R)\\rangle$，以及哈密顿矩阵的导数 $\\frac{\\partial H}{\\partial R}$。\n\n首先，我们求 $H(R)$ 的本征值和本征矢量。将哈密顿矩阵用平均能量 $\\bar{E} = \\frac{\\varepsilon_A + \\varepsilon_B}{2}$ 和能量差 $\\Delta_0 = \\varepsilon_A - \\varepsilon_B$ 来表示会很方便：\n$$ H(R) = \\begin{pmatrix} \\bar{E} + \\frac{\\Delta_0}{2} & V(R) \\\\ V(R) & \\bar{E} - \\frac{\\Delta_0}{2} \\end{pmatrix} $$\n通过求解特征方程 $\\det(H - E I) = 0$ 可以找到本征值 $E$：\n$$ (\\bar{E} + \\frac{\\Delta_0}{2} - E)(\\bar{E} - \\frac{\\Delta_0}{2} - E) - V(R)^2 = 0 $$\n$$ (E - \\bar{E})^2 - (\\frac{\\Delta_0}{2})^2 - V(R)^2 = 0 $$\n$$ E = \\bar{E} \\pm \\sqrt{(\\frac{\\Delta_0}{2})^2 + V(R)^2} $$\n问题陈述中说明了这些态是按能量递增排序的。因此，两个本征值为：\n$$ E_1(R) = \\frac{\\varepsilon_A + \\varepsilon_B}{2} - \\frac{1}{2} \\sqrt{\\Delta_0^2 + 4V(R)^2} $$\n$$ E_2(R) = \\frac{\\varepsilon_A + \\varepsilon_B}{2} + \\frac{1}{2} \\sqrt{\\Delta_0^2 + 4V(R)^2} $$\n耦合公式分母所需的能量差为：\n$$ E_2(R) - E_1(R) = \\sqrt{\\Delta_0^2 + 4V(R)^2} $$\n\n接下来，我们求解本征矢量。从非绝热基 $\\{|A\\rangle, |B\\rangle\\}$到绝热基 $\\{|\\psi_1\\rangle, |\\psi_2\\rangle\\}$的变换可以用一个混合角为 $\\theta(R)$ 的旋转矩阵来描述。设绝热本征矢量为：\n$$ |\\psi_1(R) \\rangle = -\\sin\\theta(R) |A\\rangle + \\cos\\theta(R) |B\\rangle $$\n$$ |\\psi_2(R) \\rangle = \\cos\\theta(R) |A\\rangle + \\sin\\theta(R) |B\\rangle $$\n这种参数化对应于一个使哈密顿量对角化的旋转。对角化的条件是变换后哈密顿量的非对角元素必须为零，这导出了以下关系：\n$$ \\tan(2\\theta) = \\frac{2V(R)}{\\varepsilon_A - \\varepsilon_B} = \\frac{2V(R)}{\\Delta_0} $$\n这定义了混合角 $\\theta(R)$ 是 $R$ 的一个平滑函数，满足问题中关于规范的条件。\n\n现在我们计算 Hellmann-Feynman 公式中的各项。哈密顿量的导数为：\n$$ \\frac{\\partial H}{\\partial R} = \\begin{pmatrix} 0 & \\frac{dV}{dR} \\\\ \\frac{dV}{dR} & 0 \\end{pmatrix} $$\n分子是矩阵元 $\\langle \\psi_1 | \\frac{\\partial H}{\\partial R} | \\psi_2 \\rangle$。在非绝热基表示中，其中 $|\\psi_1\\rangle \\leftrightarrow \\begin{pmatrix} -\\sin\\theta \\\\ \\cos\\theta \\end{pmatrix}$ 和 $|\\psi_2\\rangle \\leftrightarrow \\begin{pmatrix} \\cos\\theta \\\\ \\sin\\theta \\end{pmatrix}$：\n$$ \\langle \\psi_1 | \\frac{\\partial H}{\\partial R} | \\psi_2 \\rangle = \\begin{pmatrix} -\\sin\\theta & \\cos\\theta \\end{pmatrix} \\begin{pmatrix} 0 & \\frac{dV}{dR} \\\\ \\frac{dV}{dR} & 0 \\end{pmatrix} \\begin{pmatrix} \\cos\\theta \\\\ \\sin\\theta \\end{pmatrix} $$\n$$ = \\begin{pmatrix} \\cos\\theta \\frac{dV}{dR} & -\\sin\\theta \\frac{dV}{dR} \\end{pmatrix} \\begin{pmatrix} \\cos\\theta \\\\ \\sin\\theta \\end{pmatrix} = \\frac{dV}{dR}(\\cos^2\\theta - \\sin^2\\theta) = \\frac{dV}{dR} \\cos(2\\theta) $$\n从关系式 $\\tan(2\\theta) = \\frac{2V}{\\Delta_0}$，我们可以用哈密顿量参数来表示 $\\cos(2\\theta)$。假设 $2\\theta$ 位于由 $V$ 和 $\\Delta_0$ 的符号决定的象限中：\n$$ \\cos(2\\theta) = \\frac{\\Delta_0}{\\sqrt{\\Delta_0^2 + (2V)^2}} = \\frac{\\Delta_0}{\\sqrt{\\Delta_0^2 + 4V^2}} $$\n将此代入分子中得到：\n$$ \\langle \\psi_1 | \\frac{\\partial H}{\\partial R} | \\psi_2 \\rangle = \\frac{dV}{dR} \\frac{\\Delta_0}{\\sqrt{\\Delta_0^2 + 4V(R)^2}} $$\n\n现在我们组合出 $d_{12}(R)$ 的表达式：\n$$ d_{12}(R) = \\frac{\\langle \\psi_1 | \\frac{\\partial H}{\\partial R} | \\psi_2 \\rangle}{E_2 - E_1} = \\frac{\\frac{dV}{dR} \\frac{\\Delta_0}{\\sqrt{\\Delta_0^2 + 4V(R)^2}}}{\\sqrt{\\Delta_0^2 + 4V(R)^2}} = \\frac{\\Delta_0 \\frac{dV}{dR}}{\\Delta_0^2 + 4V(R)^2} $$\n\n这证实了一个已知的结果，该结果也可以通过直接计算 $d_{12}(R) = \\langle\\psi_1|\\partial_R \\psi_2\\rangle$ 得到。由于非绝热基与 $R$ 无关，我们有 $\\partial_R |\\psi_2\\rangle = (\\partial_R \\cos\\theta)|A\\rangle + (\\partial_R \\sin\\theta)|B\\rangle = (-\\sin\\theta|A\\rangle + \\cos\\theta|B\\rangle)\\frac{d\\theta}{dR} = |\\psi_1\\rangle \\frac{d\\theta}{dR}$。这给出 $d_{12}(R) = \\langle\\psi_1|\\psi_1\\rangle \\frac{d\\theta}{dR} = \\frac{d\\theta}{dR}$。对 $\\tan(2\\theta) = \\frac{2V}{\\Delta_0}$ 关于 $R$ 求导，得到 $\\sec^2(2\\theta) \\cdot 2\\frac{d\\theta}{dR} = \\frac{2}{\\Delta_0}\\frac{dV}{dR}$，简化后为 $\\frac{d\\theta}{dR} = \\frac{\\Delta_0 \\frac{dV}{dR}}{\\Delta_0^2 + 4V^2}$，这证实了我们的结果。\n\n最后，我们代入 $V(R)$ 及其导数的显式形式。\n给定 $V(R) = V_0 \\exp(-\\alpha R)$，其导数为：\n$$ \\frac{dV(R)}{dR} = -\\alpha V_0 \\exp(-\\alpha R) $$\n将此代入我们得到的 $d_{12}(R)$ 表达式中：\n$$ d_{12}(R) = \\frac{\\Delta_0 (-\\alpha V_0 \\exp(-\\alpha R))}{\\Delta_0^2 + 4(V_0 \\exp(-\\alpha R))^2} $$\n这可以简化为最终的闭合形式表达式：\n$$ d_{12}(R) = -\\frac{\\alpha \\Delta_0 V_0 \\exp(-\\alpha R)}{\\Delta_0^2 + 4V_0^2 \\exp(-2\\alpha R)} $$\n这就是所要求的、以给定参数表示的非绝热耦合作为 $R$ 的函数的解析表达式。",
            "answer": "$$\\boxed{-\\frac{\\alpha \\Delta_0 V_0 \\exp(-\\alpha R)}{\\Delta_0^2 + 4V_0^2 \\exp(-2\\alpha R)}}$$"
        },
        {
            "introduction": "理论推导之后，让我们转向真实的物理化学过程。虽然非绝热耦合向量是电子的内禀属性，但非绝热跃迁是一个涉及原子核运动的动力学过程。本练习通过分析动力学同位素效应，探讨了即便在相同的电子势能面上，原子核质量如何深刻影响跃迁概率，这是理解光化学和催化反应机理的关键。",
            "id": "2459454",
            "problem": "在分子的电子薛定谔方程的绝热表象中，非绝热耦合矢量 (NACV) 定义为 $\\mathbf{d}_{IJ}(\\mathbf{R}) = \\langle \\Phi_I(\\mathbf{R}) \\vert \\nabla_{\\mathbf{R}} \\Phi_J(\\mathbf{R}) \\rangle$，其中 $\\vert \\Phi_I(\\mathbf{R}) \\rangle$ 和 $\\vert \\Phi_J(\\mathbf{R}) \\rangle$ 是绝热电子态，$\\mathbf{R}$ 是核坐标。考虑两个同位素体 $\\mathrm{A}\\text{-}\\mathrm{H}$ 和 $\\mathrm{A}\\text{-}\\mathrm{D}$，它们唯一的区别在于用 $\\mathrm{D}$ 替换了 $\\mathrm{H}$。假设对于这两个同位素体，玻恩–奥本海默势能面 $E_I(\\mathbf{R})$ 和 $E_J(\\mathbf{R})$ 以及 NACV 场 $\\mathbf{d}_{IJ}(\\mathbf{R})$ 都是关于 $\\mathbf{R}$ 的相同函数。一个单一的有效核坐标 $q$ 驱动系统穿过一个长度为 $L$、以 $q_c$ 为中心的局域耦合区域，在该区域中 $\\mathbf{d}_{IJ}(\\mathbf{R}) \\approx d_0 \\,\\hat{\\mathbf{e}}_q$，并且能隙 $\\Delta E_{IJ} = E_J - E_I$ 近似为常数且非零。沿 $q$ 的运动被经典地处理，质量为 $M$，在进入该区域时动能为 $E_{\\mathrm{kin}}$。在这次穿过过程中，态 $I$ 和 $J$ 之间的电子布居转移是由时间导数耦合 (TDC) $\\tau_{IJ}(t) = \\dot{q}(t)\\, d_0$ 驱动的，其中 $\\dot{q}(t)$ 是沿 $q$ 方向的速度。这两个同位素体以相同的 $E_{\\mathrm{kin}}$ 进入该区域，但它们的质量不同，满足 $M_{\\mathrm{D}} = 2 M_{\\mathrm{H}}$。\n\n在这些假设下，哪个选项最能描述用 $\\mathrm{D}$ 替换 $\\mathrm{H}$ 如何影响单次穿过耦合区域期间发生 $I \\to J$ 跃迁的概率？\n\nA. 对于 $\\mathrm{A}\\text{-}\\mathrm{H}$ 和 $\\mathrm{A}\\text{-}\\mathrm{D}$ 来说是相同的，因为 $\\mathbf{d}_{IJ}$ 是一种电子性质，不依赖于核质量。\n\nB. 对于 $\\mathrm{A}\\text{-}\\mathrm{D}$ 来说更大，因为更重的质量增加了在耦合区域中停留的时间，这必然增强了绝热态之间的混合。\n\nC. 对于 $\\mathrm{A}\\text{-}\\mathrm{D}$ 来说更小，因为在相同的 $E_{\\mathrm{kin}}$下，核速度满足 $\\vert \\dot{q} \\vert \\propto 1/\\sqrt{M}$，从而减小了 $\\vert \\tau_{IJ} \\vert$；对于有限的 $\\Delta E_{IJ}$，这会抑制在穿过过程中累积的跃遷振幅。\n\nD. 如果 $\\mathbf{d}_{IJ}$ 在该区域内近似为常数，则对于两个同位素体都为零，因为 TDC 在穿过过程中的积分为零。",
            "solution": "非绝热耦合矢量 (NACV) $\\mathbf{d}_{IJ}(\\mathbf{R}) = \\langle \\Phi_I(\\mathbf{R}) \\vert \\nabla_{\\mathbf{R}} \\Phi_J(\\mathbf{R}) \\rangle$ 完全由固定核几何 $\\mathbf{R}$ 处的电子态定义。根据问题的陈述，两个同位素体共享相同的作为 $\\mathbf{R}$ 函数的电子哈密顿量，因此在相同的 $\\mathbf{R}$ 处，$\\mathbf{d}_{IJ}(\\mathbf{R})$ 对于 $\\mathrm{A}\\text{-}\\mathrm{H}$ 和 $\\mathrm{A}\\text{-}\\mathrm{D}$ 是相同的。\n\n绝热态之间的布居转移是由时间导数耦合 (TDC) $\\tau_{IJ}(t) = \\langle \\Phi_I \\vert \\partial_t \\Phi_J \\rangle = \\dot{\\mathbf{R}}(t) \\cdot \\mathbf{d}_{IJ}(\\mathbf{R}(t))$ 引起的。在当前沿 $q$ 的一维假设下，且 $\\mathbf{d}_{IJ} \\approx d_0 \\,\\hat{\\mathbf{e}}_q$，这简化为 $\\tau_{IJ}(t) = \\dot{q}(t)\\, d_0$。不同的质量 $M$ 通过核速度 $\\dot{q}$ 体现出来。在沿 $q$ 的固定动能 $E_{\\mathrm{kin}}$ 下，经典力学给出 $\\tfrac{1}{2} M \\dot{q}^2 = E_{\\mathrm{kin}}$，因此 $\\vert \\dot{q} \\vert = \\sqrt{2 E_{\\mathrm{kin}}/M} \\propto 1/\\sqrt{M}$。因此，用 $\\mathrm{D}$ 替换 $\\mathrm{H}$ 会使速度减小为原来的 $1/\\sqrt{2}$，从而使任何瞬时的 TDC 大小也减小相同的因子。\n\n为了将这种运动学变化与跃迁概率联系起来，我们考虑在二能级子空间中的绝热电子运动方程。在相对于绝热能量的相互作用绘景中，从时间 $t_i$ 到 $t_f$ 穿过过程中从 $I$ 到 $J$ 累积的一阶跃迁振幅为\n$$\nc_J(t_f) \\approx - \\int_{t_i}^{t_f} \\mathrm{d}t \\; \\tau_{JI}(t) \\, e^{\\tfrac{i}{\\hbar} \\int_{t_i}^{t} \\Delta E_{JI}(t') \\, \\mathrm{d}t'} \\, .\n$$\n在长度为 $L$ 的区域内，有 $\\tau_{JI}(t) \\approx \\dot{q}(t) d_0$ 和恒定的能隙 $\\Delta E_{JI} = \\Delta E \\neq 0$，我们可以将区域内的速度近似为常数 $\\dot{q}(t) \\approx v = \\sqrt{2 E_{\\mathrm{kin}}/M}$，穿过时间为 $T = L/v$。积分的计算结果为\n$$\nc_J(t_f) \\approx - v d_0 \\int_{0}^{T} \\mathrm{d}t \\; e^{i \\Delta E t/\\hbar}\n= - v d_0 \\, \\frac{e^{i \\Delta E T/\\hbar} - 1}{i \\Delta E/\\hbar} \\, .\n$$\n其大小为\n$$\n\\vert c_J(t_f) \\vert = \\frac{2 v \\vert d_0 \\vert}{\\Delta E/\\hbar} \\, \\Big\\vert \\sin\\!\\Big( \\frac{\\Delta E \\, T}{2 \\hbar} \\Big) \\Big\\vert\n= \\frac{2 v \\vert d_0 \\vert}{\\Delta E/\\hbar} \\, \\Big\\vert \\sin\\!\\Big( \\frac{\\Delta E \\, L}{2 \\hbar \\, v} \\Big) \\Big\\vert \\, .\n$$\n对于固定的 $L$ 和 $\\Delta E \\neq 0$，减小 $v$ (即更重的同位素)会增大正弦函数的自变量，这导致更剧烈的相位振荡，并且，在典型条件的平均情况下，由于相消干涉，跃遷振幅会更小。这一趋势与朗道–齐纳 (LZ) 图像完全一致，在朗道–齐纳模型中，对于给定的耦合强度和能隙变化率，绝热态之间的跃迁概率随着沿耦合坐标速度的减小而单調遞減。相比之下，在整个区域 $\\Delta E \\to 0$ 的特殊极限下（即在整个穿过过程中存在精确简并），积分将正比于 $\\int \\dot{q} \\, \\mathrm{d}t = \\int \\mathrm{d}q = L$，但问题通过指定一个非零、近似恒定的 $\\Delta E$ 明确排除了这种情况。\n\n因此，在所述假设下，并且对于相同的 $E_{\\mathrm{kin}}$，更重的同位素 $\\mathrm{D}$ 具有更小的 $\\vert \\dot{q} \\vert$、更小的瞬时 TDC，并且对于有限的 $\\Delta E$，每次穿过的净跃迁概率也更小。\n\n逐项分析选项：\n\n- 选项 A：错误。虽然在固定的 $\\mathbf{R}$ 处，$\\mathbf{d}_{IJ}(\\mathbf{R})$ 是电子性质，不因同位素替换而改变，但实际的跃迁概率取决于 TDC $\\tau_{IJ} = \\dot{q} \\, d_0$，它包含了核速度，因此也包含了质量。所以，即使 $\\mathbf{d}_{IJ}$ 不变，同位素替换可以并且确实会影响跃迁概率。\n\n- 选项 B：错误。更重的质量确实会增加驻留时间 $T = L/v$，但瞬时 TDC 也因相同的运动学因子而减小，并且对于有限的能隙，当 $T$ 增长时，累积的相位 $\\Delta E t/\\hbar$ 会导致更强的相消干涉。标准的二能级动力学和朗道–齐纳 (LZ) 模型都预测，在耦合特性固定的情况下，较低的速度会导致绝热态之间发生更少的跃迁。\n\n- 选项 C：正确。对于相等的 $E_{\\mathrm{kin}}$，$\\vert \\dot{q} \\vert \\propto 1/\\sqrt{M}$，所以 $\\mathrm{A}\\text{-}\\mathrm{D}$ 具有更小的瞬时 TDC。在 $\\Delta E$ 非零的情况下，更小的 $\\vert \\dot{q} \\vert$ 导致更长的相互作用时间，从而产生更多的相位累积，因此抑制了净跃遷振幅，导致每次穿过的跃遷概率更小。\n\n- 选项 D：错误。一个恒定的 $\\mathbf{d}_{IJ}$ 不会使 TDC 的积分为零。一个非零常数乘以速度对时间的积分等于路径长度（乘以该常数），另外还有一个来自能隙的相位因子。只有在零耦合的平凡情况下，或者在非常特定的、精细调节的条件下发生完全相消干涉时，净转移才会为零；通常情况下不会为零，而且问题明确指出了一个有限的耦合区域。",
            "answer": "$$\\boxed{C}$$"
        },
        {
            "introduction": "最终，我们将理论与计算实践相结合。在计算化学中，任何计算出的物理量都必须遵守基本的物理定律，非绝热耦合向量也不例外，它必须与分子的整体平动和转动无关。这个编程练习提供了一种实用的方法，通过投影和量化伪分量来检验所计算的 NACV 的质量，这是确保非绝热动力学模拟准确性的关键一步。",
            "id": "2459442",
            "problem": "您的任务是评估在分子的两个绝热电子态之间定义的非绝热耦合矢量 (NACV) 的平移和旋转不变性。考虑一个三维空间中由 $N$ 个原子核组成的系统，其质量为 $\\{m_i\\}_{i=1}^N$，位置为 $\\{\\mathbf{R}_i\\}_{i=1}^N$。NACV 是一个 $3N$ 维矢量 $\\mathbf{D}$，由 $N$ 个三维块 $\\{\\mathbf{D}_i\\}_{i=1}^N$ 组成，每个原子核对应一个块。设两个 $3N$ 维矢量 $\\mathbf{A}$ 和 $\\mathbf{B}$ 的质量加权内积定义为\n$$\n\\langle \\mathbf{A}, \\mathbf{B} \\rangle_m \\equiv \\sum_{i=1}^N m_i\\, \\mathbf{A}_i \\cdot \\mathbf{B}_i,\n$$\n相应的范数定义为\n$$\n\\|\\mathbf{A}\\|_m \\equiv \\sqrt{\\langle \\mathbf{A}, \\mathbf{A} \\rangle_m}.\n$$\n定义质心为\n$$\n\\mathbf{R}_{\\mathrm{CM}} \\equiv \\frac{\\sum_{i=1}^N m_i\\, \\mathbf{R}_i}{\\sum_{i=1}^N m_i}.\n$$\n刚体子空间 $\\mathcal{S}$ 由所有对应于刚性平移和旋转的 $3N$ 维矢量 $\\boldsymbol{\\delta}\\mathbf{R}$ 组成，即存在常矢量 $\\mathbf{a}$ 和 $\\boldsymbol{\\omega}$ 使得\n$$\n\\boldsymbol{\\delta}\\mathbf{R}_i = \\mathbf{a} + \\boldsymbol{\\omega} \\times \\left(\\mathbf{R}_i - \\mathbf{R}_{\\mathrm{CM}}\\right), \\quad i = 1,\\dots,N.\n$$\n对于非线性分子，子空间 $\\mathcal{S}$ 的维数为 $6$（三个平移和三个旋转）；对于严格线性分子，$\\mathcal{S}$ 的维数为 $5$（三个平移和两个与分子轴正交的旋转）。\n\n根据定义，一个物理上有效的 NACV 必须与 $\\mathcal{S}$ 中的每个矢量（关于 $\\langle \\cdot,\\cdot\\rangle_m$）正交。通过无量纲数来量化不变性破坏的程度\n$$\nV(\\mathbf{D}) \\equiv \n\\begin{cases}\n\\displaystyle \\frac{\\left\\| \\mathbf{P}_{\\mathcal{S}}(\\mathbf{D}) \\right\\|_m}{\\|\\mathbf{D}\\|_m}, & \\text{若 } \\|\\mathbf{D}\\|_m \\neq 0,\\\\[1em]\n0, & \\text{若 } \\|\\mathbf{D}\\|_m = 0,\n\\end{cases}\n$$\n其中 $\\mathbf{P}_{\\mathcal{S}}$ 表示到刚体子空间 $\\mathcal{S}$ 上的正交投影算子（关于 $\\langle\\cdot,\\cdot\\rangle_m$）。根据构造，$V(\\mathbf{D}) \\in [0,1]$，且 $V(\\mathbf{D})=0$ 表示完美的平移和旋转不变性。\n\n实现一个程序，对下面的每个测试用例，仅使用给定的数据计算 $V(\\mathbf{D})$。所有位置必须以埃（ångström）为单位，质量以原子质量单位为单位，NACV 分量以埃的倒数为单位。输出是无量纲的。\n\n测试套件：\n- 案例 1 (非线性分子，平凡边界情况)：\n  - $N = 3$。\n  - 质量：$\\left[15.999, 1.008, 1.008\\right]$。\n  - 位置：$\\left[(0.0, 0.0, 0.0),\\ (0.9572, 0.0, 0.0),\\ (-0.2399872, 0.927297, 0.0)\\right]$。\n  - NACV 块：$\\left[(0.0, 0.0, 0.0),\\ (0.0, 0.0, 0.0),\\ (0.0, 0.0, 0.0)\\right]$。\n- 案例 2 (非线性分子，纯平移破坏)：\n  - $N = 3$。\n  - 质量：$\\left[15.999, 1.008, 1.008\\right]$。\n  - 位置：$\\left[(0.0, 0.0, 0.0),\\ (0.9572, 0.0, 0.0),\\ (-0.2399872, 0.927297, 0.0)\\right]$。\n  - NACV 块：$\\left[(1.0\\times 10^{-3}, -2.0\\times 10^{-3}, 3.0\\times 10^{-3}),\\ (1.0\\times 10^{-3}, -2.0\\times 10^{-3}, 3.0\\times 10^{-3}),\\ (1.0\\times 10^{-3}, -2.0\\times 10^{-3}, 3.0\\times 10^{-3})\\right]$。\n- 案例 3 (线性分子，绕 $z$ 轴的纯旋转破坏)：\n  - $N = 3$。\n  - 质量：$\\left[15.999, 12.011, 15.999\\right]$。\n  - 位置：$\\left[(-1.16, 0.0, 0.0),\\ (0.0, 0.0, 0.0),\\ (1.16, 0.0, 0.0)\\right]$。\n  - NACV 块通过 $\\mathbf{D}_i = \\boldsymbol{\\omega}\\times(\\mathbf{R}_i-\\mathbf{R}_{\\mathrm{CM}})$ 构造，其中 $\\boldsymbol{\\omega}=(0.0, 0.0, 1.0\\times 10^{-3})$，具体为：\n    - $\\mathbf{D}_1 = (0.0,\\ -1.16\\times 10^{-3},\\ 0.0)$,\n    - $\\mathbf{D}_2 = (0.0,\\ 0.0,\\ 0.0)$,\n    - $\\mathbf{D}_3 = (0.0,\\ 1.16\\times 10^{-3},\\ 0.0)$。\n- 案例 4 (非线性分子，一般 NACV)：\n  - $N = 3$。\n  - 质量：$\\left[15.999, 1.008, 1.008\\right]$。\n  - 位置：$\\left[(0.0, 0.0, 0.0),\\ (0.9572, 0.0, 0.0),\\ (-0.2399872, 0.927297, 0.0)\\right]$。\n  - NACV 块：$\\left[(2.0\\times 10^{-3}, -1.0\\times 10^{-3}, 5.0\\times 10^{-4}),\\ (-1.5\\times 10^{-3}, 7.0\\times 10^{-4}, -3.0\\times 10^{-4}),\\ (8.0\\times 10^{-4}, 4.0\\times 10^{-4}, -2.0\\times 10^{-4})\\right]$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，按上述案例的顺序排列结果，例如：$\\left[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4\\right]$。每个 $\\text{result}_k$ 必须是十进制表示的浮点数。不应打印其他文本或格式。",
            "solution": "经评估，问题陈述有效。它基于分子力学和量子化学的原理，特别是非绝热耦合矢量的性质，具有科学依据。该问题是适定的（well-posed），提供了计算唯一且有意义结果所需的所有必要定义、数据和约束。它以客观、明确的数学语言表述，并且没有事实错误或矛盾。\n\n核心任务是计算无量纲量 $V(\\mathbf{D})$，它衡量非绝热耦合矢量 (NACV) $\\mathbf{D}$ 位于平移和旋转刚体子空间 $\\mathcal{S}$ 内的分量。公式由下式给出：\n$$\nV(\\mathbf{D}) = \\frac{\\left\\| \\mathbf{P}_{\\mathcal{S}}(\\mathbf{D}) \\right\\|_m}{\\|\\mathbf{D}\\|_m}\n$$\n当 $\\|\\mathbf{D}\\|_m \\neq 0$ 时，否则 $V(\\mathbf{D})=0$。此处，$\\mathbf{P}_{\\mathcal{S}}$ 是关于指定的质量加权内积 $\\langle \\mathbf{A}, \\mathbf{B} \\rangle_m = \\sum_{i=1}^N m_i \\mathbf{A}_i \\cdot \\mathbf{B}_i$ 到子空间 $\\mathcal{S}$ 上的正交投影算子。\n\n为计算投影的范数，我们首先为子空间 $\\mathcal{S}$ 构建一个标准正交基。设此基为 $\\{\\mathbf{b}_k\\}_{k=1}^d$，其中 $d$ 是 $\\mathcal{S}$ 的维数。这些基矢量满足标准正交条件 $\\langle \\mathbf{b}_j, \\mathbf{b}_k \\rangle_m = \\delta_{jk}$。$\\mathbf{D}$ 到 $\\mathcal{S}$ 上的投影则由 $\\mathbf{P}_{\\mathcal{S}}(\\mathbf{D}) = \\sum_{k=1}^d \\langle \\mathbf{D}, \\mathbf{b}_k \\rangle_m \\mathbf{b}_k$ 给出。根据基的标准正交性，此投影的范数平方为：\n$$\n\\left\\| \\mathbf{P}_{\\mathcal{S}}(\\mathbf{D}) \\right\\|_m^2 = \\left\\langle \\sum_{j=1}^d \\langle \\mathbf{D}, \\mathbf{b}_j \\rangle_m \\mathbf{b}_j, \\sum_{k=1}^d \\langle \\mathbf{D}, \\mathbf{b}_k \\rangle_m \\mathbf{b}_k \\right\\rangle_m = \\sum_{j,k} \\langle \\mathbf{D}, \\mathbf{b}_j \\rangle_m \\langle \\mathbf{D}, \\mathbf{b}_k \\rangle_m \\delta_{jk} = \\sum_{k=1}^d \\left( \\langle \\mathbf{D}, \\mathbf{b}_k \\rangle_m \\right)^2.\n$$\n因此，问题简化为构造标准正交基 $\\{\\mathbf{b}_k\\}$。\n\n刚体子空间 $\\mathcal{S}$ 由对应于刚性平移和旋转的矢量张成。$\\mathcal{S}$ 中的一个一般矢量具有原子分量 $\\boldsymbol{\\delta}\\mathbf{R}_i = \\mathbf{a} + \\boldsymbol{\\omega} \\times \\mathbf{r}_i$，其中 $\\mathbf{r}_i = \\mathbf{R}_i - \\mathbf{R}_{\\mathrm{CM}}$ 是相对于质心的位置矢量。这表明 $\\mathcal{S}$ 可以分解为平移子空间 $\\mathcal{T}$ 和旋转子空间 $\\mathcal{L}$ 的直和，即 $\\mathcal{S} = \\mathcal{T} \\oplus \\mathcal{L}$。这些子空间关于质量加权内积是相互正交的。为证明这一点，考虑一个纯平移矢量 $\\mathbf{T}$（其分量为 $\\mathbf{T}_i=\\mathbf{a}$）和一个纯旋转矢量 $\\mathbf{L}$（其分量为 $\\mathbf{L}_i = \\boldsymbol{\\omega} \\times \\mathbf{r}_i$）。它们的内积是：\n$$\n\\langle \\mathbf{T}, \\mathbf{L} \\rangle_m = \\sum_{i=1}^N m_i \\mathbf{a} \\cdot (\\boldsymbol{\\omega} \\times \\mathbf{r}_i) = \\mathbf{a} \\cdot \\left( \\boldsymbol{\\omega} \\times \\sum_{i=1}^N m_i \\mathbf{r}_i \\right).\n$$\n根据质心的定义，$\\sum_{i=1}^N m_i \\mathbf{r}_i = \\sum_{i=1}^N m_i (\\mathbf{R}_i - \\mathbf{R}_{\\mathrm{CM}}) = 0$。因此，$\\langle \\mathbf{T}, \\mathbf{L} \\rangle_m = 0$。这种正交性允许我们独立地为 $\\mathcal{T}$ 和 $\\mathcal{L}$ 构建标准正交基。\n\n**平移子空间 $\\mathcal{T}$ 的标准正交基**\n平移子空间 $\\mathcal{T}$ 是 $3$ 维的，由沿笛卡尔坐标轴平移的矢量张成。设 $\\mathbf{T}_x, \\mathbf{T}_y, \\mathbf{T}_z$ 为 $3N$ 维矢量，其原子块分别为 $(\\mathbf{T}_x)_i = (1,0,0)$、$(\\mathbf{T}_y)_i = (0,1,0)$ 和 $(\\mathbf{T}_z)_i=(0,0,1)$。在质量加权内积下它们是正交的：$\\langle \\mathbf{T}_\\alpha, \\mathbf{T}_\\beta \\rangle_m = \\sum_i m_i (\\mathbf{e}_\\alpha \\cdot \\mathbf{e}_\\beta) = \\delta_{\\alpha\\beta} \\sum_i m_i = \\delta_{\\alpha\\beta} M_{\\text{tot}}$，其中 $M_{\\text{tot}}$ 是总质量。相应的标准正交基矢量是：\n$$\n\\mathbf{t}_\\alpha = \\frac{1}{\\sqrt{M_{\\text{tot}}}} \\mathbf{T}_\\alpha, \\quad \\alpha \\in \\{x,y,z\\}.\n$$\n\n**旋转子空间 $\\mathcal{L}$ 的标准正交基**\n旋转子空间 $\\mathcal{L}$ 由对应于绕笛卡尔坐标轴旋转的矢量张成。设 $\\mathbf{L}_x, \\mathbf{L}_y, \\mathbf{L}_z$ 是原子块为 $(\\mathbf{L}_\\alpha)_i = \\mathbf{e}_\\alpha \\times \\mathbf{r}_i$ 的矢量。与平移基不同，这些矢量通常不是正交的。它们的内积构成了转动惯量张量 $\\mathbf{I}$ 的元素：\n$$\n\\langle \\mathbf{L}_\\alpha, \\mathbf{L}_\\beta \\rangle_m = \\sum_{i=1}^N m_i (\\mathbf{e}_\\alpha \\times \\mathbf{r}_i) \\cdot (\\mathbf{e}_\\beta \\times \\mathbf{r}_i) = \\sum_{i=1}^N m_i \\left( \\delta_{\\alpha\\beta} |\\mathbf{r}_i|^2 - (\\mathbf{r}_i)_\\alpha (\\mathbf{r}_i)_\\beta \\right) = I_{\\alpha\\beta}.\n$$\n为了找到 $\\mathcal{L}$ 的一个正交基，我们对角化对称矩阵 $\\mathbf{I}$。设 $\\mathbf{v}_k$ 是 $\\mathbf{I}$ 的归一化特征向量，其对应的特征值为 $I_k$（主转动惯量）。我们定义一组新的旋转矢量 $\\mathbf{L'}_k$，其原子块为 $(\\mathbf{L'}_k)_i = \\mathbf{v}_k \\times \\mathbf{r}_i$。这些新矢量是正交的：\n$$\n\\langle \\mathbf{L'}_j, \\mathbf{L'}_k \\rangle_m = (\\mathbf{v}_j)^T \\mathbf{I} \\mathbf{v}_k = (\\mathbf{v}_j)^T (I_k \\mathbf{v}_k) = I_k \\delta_{jk}.\n$$\n$\\mathcal{L}$ 的维数取决于 $\\mathbf{I}$ 的非零特征值的数量。对于非线性分子，所有 $3$ 个特征值都非零，维数为 $3$。对于线性分子，一个特征值为零（对应于绕分子轴的旋转），因此维数为 $2$。\n$\\mathcal{L}$ 的标准正交基矢量是通过对每个 $I_k > 0$ 的 $k$ 标准化 $\\mathbf{L'}_k$ 来获得的：\n$$\n\\mathbf{l}_k = \\frac{1}{\\sqrt{I_k}} \\mathbf{L'}_k.\n$$\n\n**算法总结**\n最终算法如下：\n1. 对于给定的由 $N$ 个原子核组成的系统，其质量为 $\\{m_i\\}$，位置为 $\\{\\mathbf{R}_i\\}$，计算总质量 $M_{\\text{tot}}$ 和质心 $\\mathbf{R}_{\\mathrm{CM}}$。\n2. 计算相对于质心的坐标 $\\mathbf{r}_i = \\mathbf{R}_i - \\mathbf{R}_{\\mathrm{CM}}$。\n3. 构建 $3$ 个标准正交的平移基矢量 $\\{\\mathbf{t}_x, \\mathbf{t}_y, \\mathbf{t}_z\\}$。\n4. 使用坐标 $\\mathbf{r}_i$ 构建 $3 \\times 3$ 的转动惯量张量 $\\mathbf{I}$。\n5. 计算 $\\mathbf{I}$ 的特征值 $I_k$ 和特征向量 $\\mathbf{v}_k$。\n6. 对于每个远大于零的特征值 $I_k$（以考虑数值精度并识别线性分子），构建相应的标准正交旋转基矢量 $\\mathbf{l}_k$。这将为非线性分子产生 $3$ 个矢量，为线性分子产生 $2$ 个矢量。\n7. 收集所有构建的平移和旋转矢量，形成 $\\mathcal{S}$ 的完整标准正交基 $\\{\\mathbf{b}_k\\}_{k=1}^d$，其中 $d \\in \\{5, 6\\}$。\n8. 计算 NACV 的范数平方 $\\|\\mathbf{D}\\|_m^2 = \\sum_{i=1}^N m_i |\\mathbf{D}_i|^2$。如果此范数为零，则 $V(\\mathbf{D})=0$。\n9. 否则，计算到 $\\mathcal{S}$ 上投影的范数平方：$\\|\\mathbf{P}_{\\mathcal{S}}(\\mathbf{D})\\|_m^2 = \\sum_{k=1}^d (\\langle \\mathbf{D}, \\mathbf{b}_k \\rangle_m)^2$。\n10. 最终结果是 $V(\\mathbf{D}) = \\sqrt{\\|\\mathbf{P}_{\\mathcal{S}}(\\mathbf{D})\\|_m^2 / \\|\\mathbf{D}\\|_m^2}$。\n将此过程应用于所提供的每个测试用例。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem for all test cases and prints the results.\n    \"\"\"\n\n    test_cases = [\n        {\n            \"N\": 3,\n            \"masses\": [15.999, 1.008, 1.008],\n            \"positions\": [[0.0, 0.0, 0.0], [0.9572, 0.0, 0.0], [-0.2399872, 0.927297, 0.0]],\n            \"nacv\": [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]]\n        },\n        {\n            \"N\": 3,\n            \"masses\": [15.999, 1.008, 1.008],\n            \"positions\": [[0.0, 0.0, 0.0], [0.9572, 0.0, 0.0], [-0.2399872, 0.927297, 0.0]],\n            \"nacv\": [[1.0e-3, -2.0e-3, 3.0e-3], [1.0e-3, -2.0e-3, 3.0e-3], [1.0e-3, -2.0e-3, 3.0e-3]]\n        },\n        {\n            \"N\": 3,\n            \"masses\": [15.999, 12.011, 15.999],\n            \"positions\": [[-1.16, 0.0, 0.0], [0.0, 0.0, 0.0], [1.16, 0.0, 0.0]],\n            \"nacv\": [[0.0, -1.16e-3, 0.0], [0.0, 0.0, 0.0], [0.0, 1.16e-3, 0.0]]\n        },\n        {\n            \"N\": 3,\n            \"masses\": [15.999, 1.008, 1.008],\n            \"positions\": [[0.0, 0.0, 0.0], [0.9572, 0.0, 0.0], [-0.2399872, 0.927297, 0.0]],\n            \"nacv\": [[2.0e-3, -1.0e-3, 5.0e-4], [-1.5e-3, 7.0e-4, -3.0e-4], [8.0e-4, 4.0e-4, -2.0e-4]]\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        masses = np.array(case[\"masses\"])\n        positions = np.array(case[\"positions\"])\n        nacv = np.array(case[\"nacv\"])\n        result = calculate_invariance_violation(masses, positions, nacv)\n        results.append(result)\n\n    print(f\"[{','.join(map(str, results))}]\")\n\ndef calculate_invariance_violation(masses, positions, nacv):\n    \"\"\"\n    Computes the translational and rotational invariance violation V(D).\n    \n    Args:\n        masses (np.ndarray): 1D array of atomic masses of shape (N,).\n        positions (np.ndarray): 2D array of atomic positions of shape (N, 3).\n        nacv (np.ndarray): 2D array of NACV components of shape (N, 3).\n        \n    Returns:\n        float: The dimensionless invariance violation metric V(D).\n    \"\"\"\n    N = masses.shape[0]\n    m_broadcast = masses.reshape(-1, 1)\n\n    def mw_inner_product(A, B):\n        return np.sum(A * B * m_broadcast)\n\n    def mw_norm(A):\n        return np.sqrt(mw_inner_product(A, A))\n\n    nacv_norm = mw_norm(nacv)\n    if nacv_norm < 1e-15:\n        return 0.0\n\n    total_mass = np.sum(masses)\n    center_of_mass = np.sum(m_broadcast * positions, axis=0) / total_mass\n    r = positions - center_of_mass\n\n    ortho_basis = []\n\n    if total_mass > 1e-9:\n        for i in range(3):\n            t_i = np.zeros((N, 3))\n            t_i[:, i] = 1.0\n            ortho_basis.append(t_i / np.sqrt(total_mass))\n\n    I = np.zeros((3, 3))\n    I[0, 0] = np.sum(masses * (r[:, 1]**2 + r[:, 2]**2))\n    I[1, 1] = np.sum(masses * (r[:, 0]**2 + r[:, 2]**2))\n    I[2, 2] = np.sum(masses * (r[:, 0]**2 + r[:, 1]**2))\n    I[0, 1] = I[1, 0] = -np.sum(masses * r[:, 0] * r[:, 1])\n    I[0, 2] = I[2, 0] = -np.sum(masses * r[:, 0] * r[:, 2])\n    I[1, 2] = I[2, 1] = -np.sum(masses * r[:, 1] * r[:, 2])\n\n    eigvals, eigvecs = np.linalg.eigh(I)\n    \n    for i in range(3):\n        eigval = eigvals[i]\n        if eigval > 1e-6:\n            eigvec = eigvecs[:, i]\n            L_prime_k = np.cross(eigvec, r)\n            l_k = L_prime_k / np.sqrt(eigval)\n            ortho_basis.append(l_k)\n    \n    proj_norm_sq = 0.0\n    for b_k in ortho_basis:\n        inner_prod = mw_inner_product(nacv, b_k)\n        proj_norm_sq += inner_prod**2\n    \n    violation = np.sqrt(proj_norm_sq) / nacv_norm\n    return violation\n```"
        }
    ]
}