{
    "hands_on_practices": [
        {
            "introduction": "第一个练习将探索量子限制效应，这是一个基本概念，指的是材料的电子特性在纳米尺度上会发生改变。通过将半导体量子阱模拟为一个简单的“箱中粒子”模型，你将计算出有效带隙是如何随着量子阱变窄而增大的。这项实践将入门量子力学与能带结构工程的原理直接联系起来。",
            "id": "2453999",
            "problem": "一个厚度为 $L$ 的半导体量子阱在 $z$ 方向上将电荷载流子限制在两个无限深势垒之间。在单带有效质量近似下，导带中的电子和价带中的重空穴在相同厚度 $L$ 但有效质量不同的一维无限深方势阱中运动。定态满足不含时薛定谔方程，其势能为 $V(z)=0$（$0 \\le z \\le L$）和 $V(z)=\\infty$（其他情况），且波函数在 $z=0$ 和 $z=L$ 处为零。电子的有效质量为 $m_{e}^{\\star}$，重空穴的有效质量为 $m_{hh}^{\\star}$。体材料带隙为 $E_{g,\\text{bulk}}$。在厚度为 $L$ 时，跨越带隙的最低允许光学跃迁定义为 $E_{g}(L) = E_{g,\\text{bulk}} + \\Delta E_{e,1}(L) + \\Delta E_{hh,1}(L)$，其中 $\\Delta E_{e,1}(L)$ 和 $\\Delta E_{hh,1}(L)$ 分别是电子和重空穴的基态限制能（从各自的带边向上计算）。\n\n请使用以下常数和参数，在本任务中应将其视为精确值：\n- 约化普朗克常数 $\\,\\hbar = 1.054571817\\times 10^{-34}\\,\\text{J}\\cdot\\text{s}\\,$.\n- 电子静止质量 $\\,m_{0} = 9.1093837015\\times 10^{-31}\\,\\text{kg}\\,$.\n- 元电荷（用于转换为电子伏特） $\\,q_{e} = 1.602176634\\times 10^{-19}\\,\\text{C}\\,$, 其中 $\\,1\\,\\text{eV} = q_{e}\\,\\text{J}\\,$.\n- 砷化镓在温度 $\\,300\\,\\text{K}\\,$ 时的体材料带隙 $\\,E_{g,\\text{bulk}} = 1.424\\,\\text{eV}\\,$.\n- 砷化镓的电子有效质量 $\\,m_{e}^{\\star} = 0.067\\,m_{0}\\,$.\n- 砷化镓的重空穴有效质量 $\\,m_{hh}^{\\star} = 0.45\\,m_{0}\\,$.\n\n实现一个程序，针对一组指定的量子阱厚度，通过求解电子和重空穴基态的一维无限深方势阱问题，并将其限制能与 $E_{g,\\text{bulk}}$ 相加（如上文定义），来计算以电子伏特为单位的 $E_{g}(L)$。测试组中所有输入的厚度值 $L$ 均以纳米为单位；在任何需要国际单位制（SI）单位的计算中，请将其转换为米。所有最终能量均以电子伏特表示，并将每个报告值四舍五入到小数点后 $6$ 位。\n\n测试组（每个案例对应相同的材料和上述参数，仅厚度 $L$ 不同）：\n- 案例 1：$L = 2.0\\,\\text{nm}$。\n- 案例 2：$L = 5.0\\,\\text{nm}$。\n- 案例 3：$L = 10.0\\,\\text{nm}$。\n- 案例 4：$L = 100.0\\,\\text{nm}$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，案例按上述顺序排列。例如，所需格式为 $[x_{1},x_{2},x_{3},x_{4}]$，其中每个 $x_{i}$ 是一个四舍五入到小数点后 $6$ 位的浮点数，并以电子伏特表示。",
            "solution": "该问题被确定为有效。它展示了量子力学在固态化学和物理学中的一个标准应用练习，具体而言是使用有效质量近似法对量子阱进行建模。该问题提法明确，有科学依据，且无歧义。我们将继续进行推导和求解。\n\n所描述的系统包含限制在厚度为 $L$ 的一维无限深势阱中的电荷载流子。势能 $V(z)$ 定义为：当 $0 \\le z \\le L$ 时，$V(z)=0$；其他情况下 $V(z)=\\infty$。在这种势能中，有效质量为 $m^\\star$ 的粒子的行为由不含时薛定谔方程决定：\n$$\n-\\frac{\\hbar^2}{2m^\\star} \\frac{d^2\\psi(z)}{dz^2} + V(z)\\psi(z) = E\\psi(z)\n$$\n在势阱内部，$V(z)=0$，方程简化为：\n$$\n\\frac{d^2\\psi(z)}{dz^2} = -k^2\\psi(z), \\quad \\text{其中 } k = \\sqrt{\\frac{2m^\\star E}{\\hbar^2}}\n$$\n这个二阶常微分方程的通解是 $\\psi(z) = A\\sin(kz) + B\\cos(kz)$。我们应用边界条件，即波函数在势阱壁处必须为零，$\\psi(0)=0$ 和 $\\psi(L)=0$。\n由 $\\psi(0)=0$，我们得到 $A\\sin(0) + B\\cos(0) = B = 0$。因此，解的形式为 $\\psi(z) = A\\sin(kz)$。\n由 $\\psi(L)=0$，我们要求 $A\\sin(kL)=0$。对于非平凡解（$A \\ne 0$），必须有 $kL = n\\pi$，其中 $n$ 是正整数，$n=1, 2, 3, \\dots$。这个条件使波矢 $k_n$ 量子化：\n$$\nk_n = \\frac{n\\pi}{L}\n$$\n将其代回 $k$ 的定义，我们得到量子化的能量本征值 $E_n$：\n$$\nE_n = \\frac{\\hbar^2 k_n^2}{2m^\\star} = \\frac{\\hbar^2}{2m^\\star} \\left(\\frac{n\\pi}{L}\\right)^2 = \\frac{n^2 \\pi^2 \\hbar^2}{2m^\\star L^2}\n$$\n问题要求的是基态限制能，它对应于最低的可能量子态，$n=1$。因此，质量为 $m^\\star$ 的粒子的限制能 $\\Delta E_1$ 为：\n$$\n\\Delta E_1(L) = \\frac{\\pi^2 \\hbar^2}{2m^\\star L^2}\n$$\n这个原理独立地应用于导带中有效质量为 $m_{e}^{\\star}$ 的电子，以及价带中有效质量为 $m_{hh}^{\\star}$ 的重空穴。\n电子的基态限制能为：\n$$\n\\Delta E_{e,1}(L) = \\frac{\\pi^2 \\hbar^2}{2m_{e}^{\\star} L^2}\n$$\n重空穴的基态限制能为：\n$$\n\\Delta E_{hh,1}(L) = \\frac{\\pi^2 \\hbar^2}{2m_{hh}^{\\star} L^2}\n$$\n问题将最低光学跃迁能，即量子阱的有效带隙，定义为体材料带隙与这两个限制能之和：\n$$\nE_{g}(L) = E_{g,\\text{bulk}} + \\Delta E_{e,1}(L) + \\Delta E_{hh,1}(L)\n$$\n代入限制能的表达式，得到用于计算的完整表达式：\n$$\nE_{g}(L) = E_{g,\\text{bulk}} + \\frac{\\pi^2 \\hbar^2}{2L^2} \\left( \\frac{1}{m_{e}^{\\star}} + \\frac{1}{m_{hh}^{\\star}} \\right)\n$$\n为了进行数值计算，我们必须使用一套一致的单位。给出的常数和参数如下：\n- $\\hbar = 1.054571817\\times 10^{-34}\\,\\text{J}\\cdot\\text{s}$\n- $m_{0} = 9.1093837015\\times 10^{-31}\\,\\text{kg}$\n- $m_{e}^{\\star} = 0.067\\,m_{0}$\n- $m_{hh}^{\\star} = 0.45\\,m_{0}$\n- $E_{g,\\text{bulk}} = 1.424\\,\\text{eV}$\n- $q_{e} = 1.602176634\\times 10^{-19}\\,\\text{C}$\n\n势阱厚度 $L$ 以纳米（nm）为单位提供，必须转换为米（m）：$L\\,[\\text{m}] = L\\,[\\text{nm}] \\times 10^{-9}$。限制能项以焦耳（Joules）计算，随后必须通过除以元电荷 $q_e$ 转换为电子伏特（electronvolts）。因此，对于每个给定的厚度 $L$，算法如下：\n$1$. 将厚度 $L$ 从纳米转换为米。\n$2$. 以千克为单位，计算电子有效质量 $m_{e}^{\\star}$ 和重空穴有效质量 $m_{hh}^{\\star}$。\n$3$. 使用公式计算电子限制能 $\\Delta E_{e,1}(L)$（以焦耳为单位）。\n$4$. 使用公式计算重空穴限制能 $\\Delta E_{hh,1}(L)$（以焦耳为单位）。\n$5$. 通过除以 $q_e$ 将两个限制能从焦耳转换为电子伏特。\n$6$. 将体材料带隙（以eV为单位）和两个限制能（以eV为单位）相加，得到最终结果 $E_g(L)$。\n$7$. 按要求将最终结果四舍五入到小数点后6位。\n此过程在附带的程序中实现，用以解决给定的测试案例。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the effective band gap of a GaAs quantum well for various thicknesses.\n    \"\"\"\n    # Define physical constants as specified in the problem statement.\n    HBAR = 1.054571817e-34    # Reduced Planck constant in J*s\n    M0 = 9.1093837015e-31      # Electron rest mass in kg\n    QE = 1.602176634e-19      # Elementary charge in C, for J to eV conversion\n    \n    # Define material parameters for Gallium Arsenide (GaAs).\n    EG_BULK_EV = 1.424        # Bulk band gap in eV\n    ME_STAR_RATIO = 0.067     # Electron effective mass ratio\n    MHH_STAR_RATIO = 0.45     # Heavy-hole effective mass ratio\n    \n    # Calculate effective masses in SI units (kg).\n    me_star_kg = ME_STAR_RATIO * M0\n    mhh_star_kg = MHH_STAR_RATIO * M0\n    \n    # Test suite: quantum well thicknesses in nanometers.\n    test_cases = [2.0, 5.0, 10.0, 100.0]\n    \n    results = []\n\n    for L_nm in test_cases:\n        # Convert thickness from nanometers to meters for SI unit consistency.\n        L_m = L_nm * 1e-9\n\n        # The ground-state (n=1) confinement energy for a particle in an infinite\n        # square well is E = (pi^2 * hbar^2) / (2 * m * L^2).\n        \n        # Calculate electron confinement energy in Joules.\n        delta_Ee_J = (np.pi**2 * HBAR**2) / (2 * me_star_kg * L_m**2)\n        \n        # Calculate heavy-hole confinement energy in Joules.\n        delta_Ehh_J = (np.pi**2 * HBAR**2) / (2 * mhh_star_kg * L_m**2)\n        \n        # Convert confinement energies from Joules to electronvolts.\n        delta_Ee_eV = delta_Ee_J / QE\n        delta_Ehh_eV = delta_Ehh_J / QE\n        \n        # The total transition energy Eg(L) is the sum of the bulk band gap\n        # and the confinement energies of the electron and the heavy hole.\n        Eg_L = EG_BULK_EV + delta_Ee_eV + delta_Ehh_eV\n        \n        # Format the result to 6 decimal places and add to the list.\n        results.append(f\"{Eg_L:.6f}\")\n\n    # Print the final output in the specified format: [x1,x2,x3,x4]\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "从单个受限层过渡到周期性晶体，这项实践将挑战你使用紧束缚模型从零开始构建一维材料。你将数值计算并比较均匀原子链（如碳链）和交替原子链（如氮化硼链）的能带结构与态密度。这个练习是理解原子的周期性排列和化学性质如何导致金属性或绝缘性的关键。",
            "id": "2454017",
            "problem": "要求您实现一个程序，该程序能够数值预测和比较一维紧束缚模型（分别代表均匀原子链和交替双原子链）的态密度 (DOS) 和带隙。所有结果都必须从以下定义出发，根据第一性原理进行计算，不得依赖任何预先推导的能带能量或态密度表达式。能量必须以电子伏特 (eV) 表示，波矢量以倒易长度表示，态密度以每个原胞每电子伏特的态数表示。将所有要求的浮点输出四舍五入到 $6$ 位小数。\n\n使用以下基础理论：\n- 具有最近邻耦合和周期性边界条件的一维链的实空间紧束缚 (TB) 哈密顿量由一个在位项和一个最近邻之间的跃迁项定义。对于单原子原胞（均匀链），每个原胞有一个原子轨道，其在位能为 $\\varepsilon$，与晶格常数为 $a$ 的相邻原胞之间的跃迁积分为 $t$。对于双原子原胞（交替链），每个原胞有两个轨道 A 和 B，其在位能分别为 $\\varepsilon_A$ 和 $\\varepsilon_B$，相邻及同一原胞中 A 和 B 轨道之间的最近邻跃迁为 $t$。\n- 根据布洛赫定理，本征态可以用第一布里渊区 (BZ) 中的波矢量 $k$ 来标记，紧束缚哈密顿量对于每个 $k$ 变为一个有限维的布洛赫哈密顿量 $H(k)$，对其进行对角化可以得到能带能量 $E_n(k)$。\n- 在离散采样极限下，每个原胞的态密度 (DOS) 由 $g(E) = \\frac{1}{N_k} \\sum_{k \\in \\mathrm{BZ}} \\sum_{n} \\delta\\!\\left(E - E_n(k)\\right)$ 给出，其中 $N_k$ 是用于近似布里渊区积分的 $k$ 点数量。为了获得数值上稳定的估计，用宽度为 $\\sigma$ 的归一化高斯函数替换狄拉克 $\\delta$ 函数：$\\delta(E) \\to \\frac{1}{\\sqrt{2\\pi}\\,\\sigma}\\exp\\!\\left(-\\frac{E^2}{2\\sigma^2}\\right)$。\n\n您的程序必须：\n- 对于均匀单原子链和交替双原子链，根据实空间紧束缚描述构建布洛赫哈密顿量 $H(k)$，其中 $k$ 取自第一布里渊区 $k \\in [-\\pi/a,\\pi/a]$（包含端点）的均匀网格采样。\n- 对每个 $k$ 的 $H(k)$ 进行对角化，以获得所有能带 $n$ 和所有 $k$ 点的能带能量集合 $\\{E_n(k)\\}$。\n- 计算费米能 $E_F = 0$ eV 处的带隙 $\\Delta = E_{\\min}^{(+)} - E_{\\max}^{(-)}$，其中 $E_{\\min}^{(+)}$ 是严格大于 $E_F$ 的最小本征值，$E_{\\max}^{(-)}$ 是严格小于 $E_F$ 的最大本征值。如果任一集合为空，或者由于离散化导致 $E_F$ 位于能带交叉点或能带内，使得计算出的差值为负，则返回 $\\Delta = 0$ eV。\n- 使用宽度为 $\\sigma$ 的高斯展宽定义和 $k$ 点平均，计算费米能级的态密度 $g(E_F)$。以每个原胞每电子伏特的态数报告 DOS。\n- 在第一布里渊区上使用大小为 $N_k$ 的均匀 $k$ 点网格，包括两个端点。使用晶格常数 $a$ 来设定布里渊区的边界。\n\n测试套件：\n- 使用以下四组参数。每个测试用例指定了模型类型、在位能、跃迁积分、晶格常数、k点数量和高斯宽度。能量单位为电子伏特 (eV)，晶格常数单位为埃 (Å)，$\\sigma$ 单位为电子伏特 (eV)。所有情况下费米能级固定为 $E_F = 0$ eV。\n    1. 均匀链（单原子原胞）：$(\\text{model}=\\text{mono},\\, \\varepsilon = 0.0\\,\\text{eV},\\, t = 1.0\\,\\text{eV},\\, a = 1.0\\,\\text{\\AA},\\, N_k = 4001,\\, \\sigma = 0.05\\,\\text{eV})$。\n    2. 交替链（双原子原胞）：$(\\text{model}=\\text{diatomic},\\, \\varepsilon_A = 1.0\\,\\text{eV},\\, \\varepsilon_B = -1.0\\,\\text{eV},\\, t = 1.0\\,\\text{eV},\\, a = 1.0\\,\\text{\\AA},\\, N_k = 4001,\\, \\sigma = 0.05\\,\\text{eV})$。\n    3. 交替链（小对比度）：$(\\text{model}=\\text{diatomic},\\, \\varepsilon_A = 0.1\\,\\text{eV},\\, \\varepsilon_B = -0.1\\,\\text{eV},\\, t = 1.0\\,\\text{eV},\\, a = 1.0\\,\\text{\\AA},\\, N_k = 4001,\\, \\sigma = 0.02\\,\\text{eV})$。\n    4. 均匀链（更宽能带）：$(\\text{model}=\\text{mono},\\, \\varepsilon = 0.0\\,\\text{eV},\\, t = 2.0\\,\\text{eV},\\, a = 1.0\\,\\text{\\AA},\\, N_k = 4001,\\, \\sigma = 0.05\\,\\text{eV})$。\n\n最终输出：\n- 对于每个测试用例，计算两个量：以 eV 为单位的带隙 $\\Delta$，以及以每个原胞每 eV 的态数为单位的费米能级态密度 $g(E_F)$，两者都四舍五入到 $6$ 位小数。\n- 您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，顺序为 $[\\Delta_1, g_1, \\Delta_2, g_2, \\Delta_3, g_3, \\Delta_4, g_4]$。\n- 程序必须完全自包含，不得读取任何输入。它必须嵌入并执行指定的测试套件。",
            "solution": "所呈现的问题陈述是有效的。它在科学上基于固态物理学原理，特别是紧束缚近似，并且在数学上是适定的。所有必需的参数、常数和定义都已提供，构成了一个自包含且明确的问题。任务是数值计算一维晶体两种变体的带隙和态密度。我们将首先推导必要的理论结构，然后概述计算算法。\n\n问题的核心是为每个模型构建布洛赫哈密顿量 $H(k)$。其本征值提供了电子能带结构 $E_n(k)$。\n\n**1. 均匀（单原子）链**\n\n该模型由一维的相同原子链组成。原胞包含一个带有一个轨道的单原子，其基矢可以表示为原胞 $j$ 中轨道的 $|j\\rangle$。晶格常数为 $a$。哈密顿量包括在位能 $\\varepsilon$ 和最近邻跃迁 $t$。在实空间原子轨道基下的矩阵元为：\n$$\n\\langle j|H|m\\rangle = \\begin{cases} \\varepsilon  \\text{if } j = m \\\\ t  \\text{if } |j - m| = 1 \\\\ 0  \\text{otherwise} \\end{cases}\n$$\n根据布洛赫定理，周期系统的本征态可以写成布洛赫波，由原胞周期函数的基构建。对于每个原胞单个轨道的情况，布洛赫哈密顿量 $H(k)$ 是一个 $1 \\times 1$ 矩阵（一个标量），其元由实空间哈密顿量矩阵元的傅里叶变换给出：\n$$\nH(k) = \\sum_{m} e^{ik(m-j)a} \\langle j|H|m \\rangle\n$$\n设置参考原胞 $j=0$：\n$$\nH(k) = \\sum_{m} e^{ikma} \\langle 0|H|m \\rangle\n$$\n该求和有三个非零项：\n- 对于 $m=0$：$\\langle 0|H|0 \\rangle = \\varepsilon$。该项为 $\\varepsilon e^{ik(0)a} = \\varepsilon$。\n- 对于 $m=1$：$\\langle 0|H|1 \\rangle = t$。该项为 $t e^{ika}$。\n- 对于 $m=-1$：$\\langle 0|H|-1 \\rangle = t$。该项为 $t e^{-ika}$。\n\n将这些项相加，得到布洛赫哈密顿量：\n$$\nH(k) = \\varepsilon + t(e^{ika} + e^{-ika}) = \\varepsilon + 2t\\cos(ka)\n$$\n由于这是一个标量，单个能带直接由 $E(k) = \\varepsilon + 2t\\cos(ka)$ 给出。然而，为了遵守问题中不使用预先推导的能量表达式的要求，我们将构建这个 $1 \\times 1$ 矩阵，并对每个 $k$ 数值求解其本征值。\n\n**2. 交替（双原子）链**\n\n该模型描述了一个每个原胞中具有双原子基（原子 A 和 B）的链。在位能为 $\\varepsilon_A$ 和 $\\varepsilon_B$。跃迁参数 $t$ 连接最近邻的 A 和 B 原子。原胞可以形象地表示为 ...-[A-B]-[A-B]-...，其中晶格常数 $a$ 是连续 A 原子之间的距离。在原胞 $j$ 内，有两个基轨道 $|A_j\\rangle$ 和 $|B_j\\rangle$。在此实空间基下的哈密顿量矩阵元为：\n- 在位项：$\\langle A_j|H|A_j\\rangle = \\varepsilon_A$, $\\langle B_j|H|B_j\\rangle = \\varepsilon_B$。\n- 原胞内跃迁：$\\langle A_j|H|B_j\\rangle = t$。\n- 原胞间跃迁：$\\langle A_j|H|B_{j-1}\\rangle = t$。\n\n布洛赫哈密顿量 $H(k)$ 是在布洛赫和 $|\\phi_{A,k}\\rangle, |\\phi_{B,k}\\rangle$ 基下的一个 $2 \\times 2$ 矩阵。矩阵元为 $H_{\\mu\\nu}(k) = \\sum_m e^{ikma} \\langle \\mu_0|H|\\nu_m\\rangle$，其中 $\\mu, \\nu \\in \\{A, B\\}$。\n\n- **对角元：**\n  - $H_{AA}(k) = \\langle A_0|H|A_0 \\rangle = \\varepsilon_A$。\n  - $H_{BB}(k) = \\langle B_0|H|B_0 \\rangle = \\varepsilon_B$。\n\n- **非对角元：**\n  - $H_{AB}(k) = \\sum_m e^{ikma} \\langle A_0|H|B_m\\rangle$。非零项对应于 $A_0$ 的邻居：原子 $B_0$（同一原胞, $m=0$）和原子 $B_{-1}$（前一个原胞, $m=-1$）。\n  $$\n  H_{AB}(k) = e^{ik(0)a} \\langle A_0|H|B_0\\rangle + e^{ik(-1)a} \\langle A_0|H|B_{-1}\\rangle = t + te^{-ika} = t(1 + e^{-ika})\n  $$\n  - $H_{BA}(k)$ 是 $H_{AB}(k)$ 的厄米共轭。假设 $t$ 是实数：\n  $$\n  H_{BA}(k) = (H_{AB}(k))^* = t(1 + e^{ika})\n  $$\n\n得到的 $2 \\times 2$ 布洛赫哈密顿量为：\n$$\nH(k) = \\begin{pmatrix} \\varepsilon_A  t(1 + e^{-ika}) \\\\ t(1 + e^{ika})  \\varepsilon_B \\end{pmatrix}\n$$\n两条能带 $E_n(k)$（$n=1,2$）是该矩阵对于每个波矢量 $k$ 的两个本征值。\n\n**3. 数值计算算法**\n\n对于每个指定的测试用例，执行以下步骤：\n\n**a. 布里渊区的离散化：** 第一布里渊区 $k \\in [-\\pi/a, \\pi/a]$ 使用包含端点的 $N_k$ 个点的均匀网格进行采样。\n\n**b. 能带结构计算：** 一个循环遍历网格中的每个 $k$ 值。在每次迭代中，构建相应的布洛赫哈密顿矩阵 $H(k)$（均匀链为 $1 \\times 1$，交替链为 $2 \\times 2$）。使用针对厄米矩阵的数值本征求解器计算该矩阵的本征值。所有计算出的本征值 $\\{E_n(k)\\}$ 被收集到一个单一的扁平列表中。\n\n**c. 带隙计算：** 带隙 $\\Delta$ 是相对于费米能 $E_F = 0 \\, \\text{eV}$ 计算的。所有计算出的本征值集合被划分为两个子集：严格大于 $E_F$ 的和严格小于 $E_F$ 的。确定第一个集合的最小值 $E_{\\min}^{(+)}$ 和第二个集合的最大值 $E_{\\max}^{(-)}$。带隙为 $\\Delta = E_{\\min}^{(+)} - E_{\\max}^{(-)}$。如果任一子集为空，或者由于离散化效应导致计算出的差值为负，则将带隙设置为 $\\Delta = 0$。\n\n**d. 态密度计算：** 通过用标准差为 $\\sigma$ 的归一化高斯函数近似狄拉克 $\\delta$ 函数来计算费米能级处每个原胞的态密度 $g(E_F)$。直接实现给定的公式：\n$$\ng(E_F) = \\frac{1}{N_k} \\sum_{k,n} \\frac{1}{\\sqrt{2\\pi}\\sigma} \\exp \\left( -\\frac{(E_F - E_n(k))^2}{2\\sigma^2} \\right)\n$$\n求和遍及所有计算出的本征值 $\\{E_n(k)\\}$，结果由 $k$ 点的数量 $N_k$ 进行归一化。\n\n这个从基本紧束缚哈密顿量定义出发的严谨、分步的过程确保了解答是按要求从第一性原理推导出来的。最终的程序实现了这一逻辑来处理测试套件并产生所需的输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport scipy  # Imported to adhere to problem spec, but not explicitly used.\n\ndef solve():\n    \"\"\"\n    Solves the tight-binding problem for the given test cases.\n    \"\"\"\n    \n    # Test suite as defined in the problem statement.\n    test_cases = [\n        {\"model\": \"mono\", \"params\": {\"eps\": 0.0, \"t\": 1.0, \"a\": 1.0, \"Nk\": 4001, \"sigma\": 0.05}},\n        {\"model\": \"diatomic\", \"params\": {\"epsA\": 1.0, \"epsB\": -1.0, \"t\": 1.0, \"a\": 1.0, \"Nk\": 4001, \"sigma\": 0.05}},\n        {\"model\": \"diatomic\", \"params\": {\"epsA\": 0.1, \"epsB\": -0.1, \"t\": 1.0, \"a\": 1.0, \"Nk\": 4001, \"sigma\": 0.02}},\n        {\"model\": \"mono\", \"params\": {\"eps\": 0.0, \"t\": 2.0, \"a\": 1.0, \"Nk\": 4001, \"sigma\": 0.05}},\n    ]\n    \n    E_F = 0.0  # Fermi energy in eV is fixed at 0.\n    all_results = []\n\n    for case in test_cases:\n        model = case[\"model\"]\n        params = case[\"params\"]\n        \n        a = params[\"a\"]\n        Nk = params[\"Nk\"]\n        sigma = params[\"sigma\"]\n        t = params.get(\"t\")\n\n        k_grid = np.linspace(-np.pi / a, np.pi / a, Nk)\n        all_energies = []\n\n        if model == \"mono\":\n            eps = params[\"eps\"]\n            for k in k_grid:\n                # Construct 1x1 Bloch Hamiltonian\n                # H(k) = eps + 2*t*cos(k*a)\n                # Using complex numbers for consistency, though it's real\n                H_k = np.array([[(eps + 2 * t * np.cos(k * a))]], dtype=np.complex128)\n                # Diagonalize to get eigenvalues\n                eigenvalues = np.linalg.eigh(H_k)[0]\n                all_energies.extend(eigenvalues)\n\n        elif model == \"diatomic\":\n            epsA = params[\"epsA\"]\n            epsB = params[\"epsB\"]\n            for k in k_grid:\n                # Construct 2x2 Bloch Hamiltonian\n                # H(k) = [[epsA, t*(1+exp(-i*k*a))], [t*(1+exp(i*k*a)), epsB]]\n                off_diagonal = t * (1 + np.exp(-1j * k * a))\n                H_k = np.array([\n                    [epsA, off_diagonal],\n                    [np.conj(off_diagonal), epsB]\n                ], dtype=np.complex128)\n                # Diagonalize to get eigenvalues\n                eigenvalues = np.linalg.eigh(H_k)[0]\n                all_energies.extend(eigenvalues)\n\n        energies = np.array(all_energies)\n\n        # Calculate band gap\n        energies_gt_ef = energies[energies > E_F]\n        energies_lt_ef = energies[energies  E_F]\n\n        if energies_gt_ef.size == 0 or energies_lt_ef.size == 0:\n            band_gap = 0.0\n        else:\n            E_min_plus = np.min(energies_gt_ef)\n            E_max_minus = np.max(energies_lt_ef)\n            band_gap = E_min_plus - E_max_minus\n            if band_gap  0:\n                band_gap = 0.0\n        \n        # Calculate Density of States at Fermi energy\n        # g(E) = (1/Nk) * sum_{k,n} (1/sqrt(2*pi*sigma^2)) * exp(-(E-E_n(k))^2 / (2*sigma^2))\n        gaussian_term = (1 / (np.sqrt(2 * np.pi) * sigma)) * np.exp(-((E_F - energies)**2) / (2 * sigma**2))\n        dos_at_ef = np.sum(gaussian_term) / Nk\n        \n        # Append formatted results\n        all_results.append(f\"{band_gap:.6f}\")\n        all_results.append(f\"{dos_at_ef:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(all_results)}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "我们最后的实践将进入二维材料的领域，重点关注石墨烯，这是一种以其独特的“狄拉克锥”电子结构而闻名的材料。你将使用一个低能有效哈密顿量来研究将石墨烯放置在衬底上如何破坏其对称性并打开一个带隙，这是其在数字电子学中应用的关键一步。这个问题展示了有效模型在描述复杂材料低能物理学方面的强大能力。",
            "id": "2454056",
            "problem": "考虑放置在六方氮化硼 (h-BN) 衬底上的一层石墨烯，该衬底会破坏反演对称性并在狄拉克点处打开一个小能隙。使用包含子晶格交错质量项的二维狄拉克哈密顿量，对单个谷点附近的低能电子结构进行建模：\n$$\nH = \\hbar v_F \\left( \\sigma_x k_x + \\sigma_y k_y \\right) + \\Delta \\, \\sigma_z,\n$$\n其中 $\\hbar$ 是约化普朗克常数，$v_F$ 是费米速度，$\\boldsymbol{\\sigma}$ 是泡利矩阵，$(k_x,k_y)$ 是从谷点中心测量的晶体动量 $\\mathbf{k}$ 的分量，并且 $\\Delta  0$ 是谱隙的一半（因此总能隙为 $2\\Delta$）。假设存在自旋简并，且两个谷点保持有效简并，因此总简并因子为 $g_{\\mathrm{deg}}=4$。$\\hbar$ 的单位取电子伏特-秒 (eV·s)，能量单位为电子伏特 (eV)，波矢单位为米分之一 (m$^{-1}$)，速度单位为米/秒 (m/s)。\n\n你的任务是根据此模型从第一性原理计算两个物理可测量：\n1. 在指定的 $k_x$ 值下，沿 $k_x$ 轴（即 $k_y=0$）的正支导带能量 $E_+(\\mathbf{k})$。\n2. 在指定的能量 $E \\ge 0$ 处，单位面积的单粒子电子态密度 (DOS) $D(E)$，计算需包括能隙打开的影响。态密度必须以 $\\mathrm{(eV \\cdot m^2)^{-1}}$ 为单位表示，并且必须包含简并因子 $g_{\\mathrm{deg}}$。\n\n在所有测试用例中，请使用以下常量和约定：\n- 约化普朗克常数：$\\hbar = 6.582119569 \\times 10^{-16}$ eV·s。\n- 费米速度：$v_F = 1.0 \\times 10^6$ m/s。\n- 简并因子：$g_{\\mathrm{deg}} = 4$。\n- 对于色散关系，设置 $k_y = 0$ 并使用 $k \\equiv |k_x|$ 作为标量波矢大小。\n- 对于态密度 $D(E)$，使用适用于具有各向同性色散的二维系统的定义，表示为单位面积的量，并包括由 $\\Delta$ 引起的能隙打开效应。对于严格在能隙内的能量，态密度必须恒为零。\n\n角度单位不适用。所有要求的能量必须以 eV 为单位报告，波矢以 m$^{-1}$ 为单位报告，态密度值以 $\\mathrm{(eV \\cdot m^2)^{-1}}$ 为单位报告。所有数值输出必须采用科学记数法，小数点后精确到六位。\n\n测试组。对于下面的每个参数集，计算所要求的量并返回一个单一数字：\n- 用例 1 (DOS)：$\\Delta = 0.000$ eV, $E = 0.000$ eV。\n- 用例 2 (DOS)：$\\Delta = 0.000$ eV, $E = 0.050$ eV。\n- 用例 3 (DOS)：$\\Delta = 0.025$ eV, $E = 0.020$ eV。\n- 用例 4 (DOS)：$\\Delta = 0.025$ eV, $E = 0.025$ eV。\n- 用例 5 (DOS)：$\\Delta = 0.025$ eV, $E = 0.100$ eV。\n- 用例 6 (DOS)：$\\Delta = 0.100$ eV, $E = 0.050$ eV。\n- 用例 7 (沿 $k_x$ 轴的导带能量 $E_+(k)$)：$\\Delta = 0.025$ eV, $k = 0.0$ m$^{-1}$。\n- 用例 8 (沿 $k_x$ 轴的导带能量 $E_+(k)$)：$\\Delta = 0.000$ eV, $k = 1.0 \\times 10^8$ m$^{-1}$。\n- 用例 9 (沿 $k_x$ 轴的导带能量 $E_+(k)$)：$\\Delta = 0.050$ eV, $k = 1.0 \\times 10^8$ m$^{-1}$。\n\n最终输出格式。你的程序应生成单行输出，其中包含与上述用例顺序相同的结果，形式为方括号内由逗号分隔的列表，每个数字都格式化为科学记数法，小数点后精确到六位。例如，输出格式必须是\n\"[x1,x2,x3,x4,x5,x6,x7,x8,x9]\"\n其中每个 $x_i$ 的显示方式为例，$1.234567\\mathrm{e}{-03}$。",
            "solution": "问题陈述已经过评估，被确定为有效。这是一个来自凝聚态物理领域的、提法恰当且有科学依据的问题，没有矛盾或含糊不清之处。我们将继续进行推导和求解。\n\n任务是为一个由以下哈密顿量描述的二维有质量狄拉克系统计算导带能量 $E_+(k)$ 和态密度 $D(E)$：\n$$\nH = \\hbar v_F \\left( \\sigma_x k_x + \\sigma_y k_y \\right) + \\Delta \\, \\sigma_z\n$$\n此处，$\\boldsymbol{\\sigma} = (\\sigma_x, \\sigma_y, \\sigma_z)$ 是泡利矩阵。在 $\\sigma_z$ 是对角矩阵的标准基中，哈密顿量表示为一个 $2 \\times 2$ 矩阵：\n$$\n\\sigma_x = \\begin{pmatrix} 0  1 \\\\ 1  0 \\end{pmatrix}, \\quad \\sigma_y = \\begin{pmatrix} 0  -i \\\\ i  0 \\end{pmatrix}, \\quad \\sigma_z = \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix}\n$$\n将这些矩阵代入 $H$ 的表达式中可得：\n$$\nH = \\hbar v_F \\begin{pmatrix} 0  k_x - i k_y \\\\ k_x + i k_y  0 \\end{pmatrix} + \\Delta \\begin{pmatrix} 1  0 \\\\ 0  -1 \\end{pmatrix} = \\begin{pmatrix} \\Delta  \\hbar v_F (k_x - i k_y) \\\\ \\hbar v_F (k_x + i k_y)  -\\Delta \\end{pmatrix}\n$$\n能量本征值 $E$ 是久期方程 $\\det(H - E I) = 0$ 的解，其中 $I$ 是 $2 \\times 2$ 单位矩阵。\n$$\n\\det \\begin{pmatrix} \\Delta - E  \\hbar v_F (k_x - i k_y) \\\\ \\hbar v_F (k_x + i k_y)  -\\Delta - E \\end{pmatrix}} = 0\n$$\n$$\n(\\Delta - E)(-\\Delta - E) - \\left( \\hbar v_F \\right)^2 (k_x - i k_y)(k_x + i k_y) = 0\n$$\n$$\nE^2 - \\Delta^2 - \\left( \\hbar v_F \\right)^2 (k_x^2 + k_y^2) = 0\n$$\n令 $k = \\sqrt{k_x^2 + k_y^2}$ 为波矢 $\\mathbf{k}$ 的大小。色散关系变为：\n$$\nE^2 = \\Delta^2 + (\\hbar v_F k)^2\n$$\n这给出两个能带：一个导带（$+$）和一个价带（$-$）：\n$$\nE_{\\pm}(k) = \\pm \\sqrt{\\Delta^2 + (\\hbar v_F k)^2}\n$$\n问题要求计算沿 $k_x$ 轴的正支导带能量 $E_+(\\mathbf{k})$，其中 $k_y=0$ 因而 $k = |k_x|$。公式为：\n$$\nE_+(k) = \\sqrt{\\Delta^2 + (\\hbar v_F k)^2}\n$$\n此表达式将用于计算用例 7 到 9 的结果。\n\n接下来，我们推导单位面积的单粒子电子态密度 (DOS) $D(E)$。对于具有自旋和谷简并度 $g_{\\mathrm{deg}}$ 的二维系统，态密度定义为：\n$$\nD(E) = g_{\\mathrm{deg}} \\int \\frac{d^2k}{(2\\pi)^2} \\delta(E - E_+(k))\n$$\n对于 $E \\ge 0$，我们只考虑正能量支 $E_+(k)$。由于色散关系 $E_+(k)$ 是各向同性的，我们可以通过变换到极坐标 ($d^2k = k \\, dk \\, d\\theta$) 来对 k 空间中的角度分量进行积分。对 $\\theta$ 从 $0$ 到 $2\\pi$ 积分得到一个因子 $2\\pi$。\n$$\nD(E) = g_{\\mathrm{deg}} \\frac{2\\pi}{(2\\pi)^2} \\int_0^\\infty k \\, \\delta(E - \\sqrt{\\Delta^2 + (\\hbar v_F k)^2}) \\, dk\n$$\n为了计算包含狄拉克 delta 函数的积分，我们找到其宗量 $E = \\sqrt{\\Delta^2 + (\\hbar v_F k_0)^2}$ 的根 $k_0$。这要求 $E^2 = \\Delta^2 + (\\hbar v_F k_0)^2$，该方程仅在 $E \\ge \\Delta$ 时才有 $k_0 \\ge 0$ 的解。如果 $0 \\le E  \\Delta$，则没有态存在，因此 $D(E)=0$。\n对于 $E \\ge \\Delta$，根是 $k_0 = \\frac{\\sqrt{E^2 - \\Delta^2}}{\\hbar v_F}$。\n使用恒等式 $\\int f(x) \\delta(g(x)) dx = \\sum_i \\frac{f(x_i)}{|g'(x_i)|}$，其中 $x_i$ 是 $g(x)=0$ 的根，我们有 $f(k)=k$ 和 $g(k) = E - E_+(k)$。导数是：\n$$\n\\frac{dE_+(k)}{dk} = \\frac{d}{dk} \\sqrt{\\Delta^2 + (\\hbar v_F k)^2} = \\frac{(\\hbar v_F)^2 k}{\\sqrt{\\Delta^2 + (\\hbar v_F k)^2}} = \\frac{(\\hbar v_F)^2 k}{E_+(k)}\n$$\n在根 $k_0$ 处，delta 函数宗量导数的绝对值为 $|- \\frac{dE_+}{dk}|_{k=k_0} = \\frac{(\\hbar v_F)^2 k_0}{E}$。\n将此代入态密度表达式中：\n$$\nD(E) = g_{\\mathrm{deg}} \\frac{1}{2\\pi} \\frac{k_0}{\\frac{(\\hbar v_F)^2 k_0}{E}} = g_{\\mathrm{deg}} \\frac{E}{2\\pi (\\hbar v_F)^2}\n$$\n给定简并因子 $g_{\\mathrm{deg}} = 4$，态密度的最终表达式为：\n$$\nD(E) = \\begin{cases} \\frac{2E}{\\pi(\\hbar v_F)^2}  \\text{如果 } E \\ge \\Delta \\\\ 0  \\text{如果 } 0 \\le E  \\Delta \\end{cases}\n$$\n注意，对于无能隙情况 $\\Delta=0$，表达式简化为 $D(E) = \\frac{2E}{\\pi(\\hbar v_F)^2}$（适用于所有 $E \\ge 0$），这是本征石墨烯正确的线性态密度。对于 $E=0$ 和 $\\Delta=0$，$D(0)=0$。这些公式将用于计算用例 1 到 6 的结果。\n\n将使用提供的常量进行计算：\n- $\\hbar = 6.582119569 \\times 10^{-16}$ eV·s\n- $v_F = 1.0 \\times 10^6$ m/s\n- $g_{\\mathrm{deg}} = 4$",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for band energy and density of states for gapped graphene model.\n    \"\"\"\n    # Define physical constants from the problem statement.\n    HBAR_EVS = 6.582119569e-16  # eV·s\n    V_F = 1.0e6  # m/s\n    G_DEG = 4.0  # Degeneracy factor\n\n    # Pre-compute useful quantities.\n    HBAR_VF = HBAR_EVS * V_F  # eV·m\n    HBAR_VF_SQ = HBAR_VF**2  # (eV·m)^2\n    \n    # Pre-factor for DOS calculation: g_deg / (2 * pi * (hbar*v_f)^2)\n    # With g_deg=4, this is 2 / (pi * (hbar*v_f)^2)\n    DOS_PREFACTOR = 2.0 / (np.pi * HBAR_VF_SQ)\n\n    # Test suite from the problem statement.\n    # Format: (type, parameter1, parameter2)\n    # For 'DOS': (Delta in eV, E in eV)\n    # For 'ENERGY': (Delta in eV, k in m^-1)\n    test_cases = [\n        ('DOS',    0.000, 0.000),      # Case 1\n        ('DOS',    0.000, 0.050),      # Case 2\n        ('DOS',    0.025, 0.020),      # Case 3\n        ('DOS',    0.025, 0.025),      # Case 4\n        ('DOS',    0.025, 0.100),      # Case 5\n        ('DOS',    0.100, 0.050),      # Case 6\n        ('ENERGY', 0.025, 0.0),        # Case 7\n        ('ENERGY', 0.000, 1.0e8),      # Case 8\n        ('ENERGY', 0.050, 1.0e8),      # Case 9\n    ]\n\n    results = []\n    \n    for case in test_cases:\n        case_type, param1, param2 = case\n        \n        if case_type == 'DOS':\n            # Parameters for DOS calculation\n            delta, energy = param1, param2\n            \n            # DOS is zero for energies inside the gap.\n            if energy  delta:\n                dos = 0.0\n            else:\n                # D(E) = (g_deg * E) / (2 * pi * (hbar*v_f)^2) for E >= Delta\n                # which simplifies with the pre-calculated factor.\n                dos = DOS_PREFACTOR * energy\n            \n            results.append(dos)\n\n        elif case_type == 'ENERGY':\n            # Parameters for energy calculation\n            delta, k_magnitude = param1, param2\n            \n            # E_+(k) = sqrt(Delta^2 + (hbar*v_f*k)^2)\n            energy_k = HBAR_VF * k_magnitude\n            conduction_band_energy = np.sqrt(delta**2 + energy_k**2)\n            \n            results.append(conduction_band_energy)\n\n    # Format the results according to the specification.\n    # Each number in scientific notation with 6 digits after the decimal point.\n    formatted_results = [f\"{res:.6e}\" for res in results]\n    \n    # Print the final output in the required single-line format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}