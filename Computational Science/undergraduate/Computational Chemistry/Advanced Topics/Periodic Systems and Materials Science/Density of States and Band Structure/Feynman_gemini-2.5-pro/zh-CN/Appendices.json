{
    "hands_on_practices": [
        {
            "introduction": "量子限制是纳米科学中的一个基本概念，它描述了当载流子（电子和空穴）在至少一个维度上被限制在纳米尺度时，其能量如何被量子化。这个练习将带你探究半导体量子阱的有效带隙如何随其厚度 $L$ 变化。通过应用简单的“无限深势阱”模型和有效质量近似，你将亲手计算并验证量子限制效应如何显著地“蓝移”光学跃迁能量，这是“能带工程”的一个经典实例。",
            "id": "2453999",
            "problem": "一个厚度为 $L$ 的半导体量子阱将载流子在 $z$ 方向上限制在两个无限势垒之间。在单带有效质量近似下，导带中的电子和价带中的重空穴分别经受相同厚度 $L$ 但有效质量不同的一维无限深方势阱。其定态满足不含时薛定谔方程，其中势能 $V(z)=0$（对于 $0 \\le z \\le L$）否则 $V(z)=\\infty$，且波函数在 $z=0$ 和 $z=L$ 处为零。电子的有效质量为 $m_{e}^{\\star}$，重空穴的有效质量为 $m_{hh}^{\\star}$。体材料带隙为 $E_{g,\\text{bulk}}$。在厚度为 $L$ 时，跨越带隙的最低允许光学跃迁定义为 $E_{g}(L) = E_{g,\\text{bulk}} + \\Delta E_{e,1}(L) + \\Delta E_{hh,1}(L)$，其中 $\\Delta E_{e,1}(L)$ 和 $\\Delta E_{hh,1}(L)$ 分别是电子和重空穴的基态限制能（从各自的带边算起）。\n\n请使用以下常数和参数，在本任务中应将其视为精确值：\n- 约化普朗克常数 $\\,\\hbar = 1.054571817\\times 10^{-34}\\,\\text{J}\\cdot\\text{s}\\,$。\n- 电子静止质量 $\\,m_{0} = 9.1093837015\\times 10^{-31}\\,\\text{kg}\\,$。\n- 元电荷（用于转换为电子伏特）$\\,q_{e} = 1.602176634\\times 10^{-19}\\,\\text{C}\\,$，其中 $\\,1\\,\\text{eV} = q_{e}\\,\\text{J}\\,$。\n- 砷化镓的体材料带隙 $\\,E_{g,\\text{bulk}} = 1.424\\,\\text{eV}\\,$（在温度 $\\,300\\,\\text{K}\\,$ 时）。\n- 砷化镓的电子有效质量 $\\,m_{e}^{\\star} = 0.067\\,m_{0}\\,$。\n- 砷化镓的重空穴有效质量 $\\,m_{hh}^{\\star} = 0.45\\,m_{0}\\,$。\n\n实现一个程序，针对给定的量子阱厚度集合，通过求解电子和重空穴基态的一维无限深方势阱问题，并将其限制能与 $E_{g,\\text{bulk}}$ 相加（如上文定义），计算出以电子伏特为单位的 $E_{g}(L)$。测试套件中所有输入的厚度值 $L$ 均以纳米为单位；在任何需要国际单位制（SI）的计算中，请将其转换为米。所有最终能量均以电子伏特表示，并将每个报告值四舍五入至 $6$ 位小数。\n\n测试套件（每个案例代表一个厚度 $L$，材料和参数与上述相同）：\n- 案例 $1$：$L = 2.0\\,\\text{nm}$。\n- 案例 $2$：$L = 5.0\\,\\text{nm}$。\n- 案例 $3$：$L = 10.0\\,\\text{nm}$。\n- 案例 $4$：$L = 100.0\\,\\text{nm}$。\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，列表中的结果按上述案例顺序排列。例如，要求的格式为 $[x_{1},x_{2},x_{3},x_{4}]$，其中每个 $x_{i}$ 是一个四舍五入到 $6$ 位小数并以电子伏特表示的浮点数。",
            "solution": "该问题被确定为有效。它展示了量子力学在固态化学与物理学中的一个标准应用练习，特别是使用有效质量近似法对量子阱进行建模。该问题提法恰当，有科学依据，且没有歧义。我们将继续进行推导和求解。\n\n所描述的系统包含限制在厚度为 $L$ 的一维无限深势阱中的载流子。势能 $V(z)$ 定义为：当 $0 \\le z \\le L$ 时，$V(z)=0$；否则 $V(z)=\\infty$。一个有效质量为 $m^\\star$ 的粒子在这种势场中的行为由不含时 Schrödinger 方程决定：\n$$\n-\\frac{\\hbar^2}{2m^\\star} \\frac{d^2\\psi(z)}{dz^2} + V(z)\\psi(z) = E\\psi(z)\n$$\n在势阱内部，$V(z)=0$，方程简化为：\n$$\n\\frac{d^2\\psi(z)}{dz^2} = -k^2\\psi(z), \\quad \\text{其中 } k = \\sqrt{\\frac{2m^\\star E}{\\hbar^2}}\n$$\n这个二阶常微分方程的通解是 $\\psi(z) = A\\sin(kz) + B\\cos(kz)$。我们应用边界条件，即波函数在势阱壁处必须为零，$\\psi(0)=0$ 和 $\\psi(L)=0$。\n由 $\\psi(0)=0$，我们得到 $A\\sin(0) + B\\cos(0) = B = 0$。因此解的形式为 $\\psi(z) = A\\sin(kz)$。\n由 $\\psi(L)=0$，我们需要 $A\\sin(kL)=0$。对于非平凡解（$A \\ne 0$），必须有 $kL = n\\pi$，其中 $n$ 为正整数，$n=1, 2, 3, \\dots$。这个条件将波矢 $k_n$ 量子化：\n$$\nk_n = \\frac{n\\pi}{L}\n$$\n将此代入 $k$ 的定义，我们得到量子化的能量本征值 $E_n$：\n$$\nE_n = \\frac{\\hbar^2 k_n^2}{2m^\\star} = \\frac{\\hbar^2}{2m^\\star} \\left(\\frac{n\\pi}{L}\\right)^2 = \\frac{n^2 \\pi^2 \\hbar^2}{2m^\\star L^2}\n$$\n问题要求的是基态限制能，它对应于最低的量子态 $n=1$。因此，质量为 $m^\\star$ 的粒子的限制能 $\\Delta E_1$ 为：\n$$\n\\Delta E_1(L) = \\frac{\\pi^2 \\hbar^2}{2m^\\star L^2}\n$$\n这个原理分别独立地应用于导带中有效质量为 $m_{e}^{\\star}$ 的电子和价带中有效质量为 $m_{hh}^{\\star}$ 的重空穴。\n电子的基态限制能为：\n$$\n\\Delta E_{e,1}(L) = \\frac{\\pi^2 \\hbar^2}{2m_{e}^{\\star} L^2}\n$$\n重空穴的基态限制能为：\n$$\n\\Delta E_{hh,1}(L) = \\frac{\\pi^2 \\hbar^2}{2m_{hh}^{\\star} L^2}\n$$\n问题将最低光学跃迁能，即量子阱的有效带隙，定义为体材料带隙与这两个限制能之和：\n$$\nE_{g}(L) = E_{g,\\text{bulk}} + \\Delta E_{e,1}(L) + \\Delta E_{hh,1}(L)\n$$\n代入限制能的表达式，得到用于计算的完整表达式：\n$$\nE_{g}(L) = E_{g,\\text{bulk}} + \\frac{\\pi^2 \\hbar^2}{2L^2} \\left( \\frac{1}{m_{e}^{\\star}} + \\frac{1}{m_{hh}^{\\star}} \\right)\n$$\n为了进行数值计算，我们必须使用一套一致的单位。给出的常数和参数如下：\n- $\\hbar = 1.054571817\\times 10^{-34}\\,\\text{J}\\cdot\\text{s}$\n- $m_{0} = 9.1093837015\\times 10^{-31}\\,\\text{kg}$\n- $m_{e}^{\\star} = 0.067\\,m_{0}$\n- $m_{hh}^{\\star} = 0.45\\,m_{0}$\n- $E_{g,\\text{bulk}} = 1.424\\,\\text{eV}$\n- $q_{e} = 1.602176634\\times 10^{-19}\\,\\text{C}$\n\n阱的厚度 $L$ 以纳米（nm）为单位提供，必须转换为米（m）：$L\\,[\\text{m}] = L\\,[\\text{nm}] \\times 10^{-9}$。限制能项以焦耳为单位计算，随后必须通过除以元电荷 $q_e$ 转换为电子伏特。因此，对于每个给定的厚度 $L$，算法如下：\n$1$。 将厚度 $L$ 从纳米转换为米。\n$2$。 以千克为单位计算电子有效质量 $m_{e}^{\\star}$ 和重空穴有效质量 $m_{hh}^{\\star}$。\n$3$。 使用其公式计算电子限制能 $\\Delta E_{e,1}(L)$（单位：焦耳）。\n$4$。 使用其公式计算重空穴限制能 $\\Delta E_{hh,1}(L)$（单位：焦耳）。\n$5$。 通过除以 $q_e$ 将两个限制能从焦耳转换为电子伏特。\n$6$。 将体材料带隙（单位：eV）和两个限制能（单位：eV）相加，得到最终结果 $E_g(L)$。\n$7$。 按要求将最终结果四舍五入到 $6$ 位小数。\n此程序在附带的程序中实现，用以解决给定的测试案例。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the effective band gap of a GaAs quantum well for various thicknesses.\n    \"\"\"\n    # Define physical constants as specified in the problem statement.\n    HBAR = 1.054571817e-34    # Reduced Planck constant in J*s\n    M0 = 9.1093837015e-31      # Electron rest mass in kg\n    QE = 1.602176634e-19      # Elementary charge in C, for J to eV conversion\n    \n    # Define material parameters for Gallium Arsenide (GaAs).\n    EG_BULK_EV = 1.424        # Bulk band gap in eV\n    ME_STAR_RATIO = 0.067     # Electron effective mass ratio\n    MHH_STAR_RATIO = 0.45     # Heavy-hole effective mass ratio\n    \n    # Calculate effective masses in SI units (kg).\n    me_star_kg = ME_STAR_RATIO * M0\n    mhh_star_kg = MHH_STAR_RATIO * M0\n    \n    # Test suite: quantum well thicknesses in nanometers.\n    test_cases = [2.0, 5.0, 10.0, 100.0]\n    \n    results = []\n\n    for L_nm in test_cases:\n        # Convert thickness from nanometers to meters for SI unit consistency.\n        L_m = L_nm * 1e-9\n\n        # The ground-state (n=1) confinement energy for a particle in an infinite\n        # square well is E = (pi^2 * hbar^2) / (2 * m * L^2).\n        \n        # Calculate electron confinement energy in Joules.\n        delta_Ee_J = (np.pi**2 * HBAR**2) / (2 * me_star_kg * L_m**2)\n        \n        # Calculate heavy-hole confinement energy in Joules.\n        delta_Ehh_J = (np.pi**2 * HBAR**2) / (2 * mhh_star_kg * L_m**2)\n        \n        # Convert confinement energies from Joules to electronvolts.\n        delta_Ee_eV = delta_Ee_J / QE\n        delta_Ehh_eV = delta_Ehh_J / QE\n        \n        # The total transition energy Eg(L) is the sum of the bulk band gap\n        # and the confinement energies of the electron and the heavy hole.\n        Eg_L = EG_BULK_EV + delta_Ee_eV + delta_Ehh_eV\n        \n        # Format the result to 6 decimal places and add to the list.\n        results.append(f\"{Eg_L:.6f}\")\n\n    # Print the final output in the specified format: [x1,x2,x3,x4]\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "紧束缚模型为我们提供了一种从原子轨道出发构建能带结构的化学直观方法。在本练习中，你将通过数值计算，对比两种一维原子链的电子结构：一种是均匀的单原子链（类似于碳链），另一种是交替的双原子链（类似于氮化硼链）。通过构建并对角化它们的布洛赫哈密顿量 $H(k)$，你将直观地看到，破坏晶格的对称性（从单原子基元到双原子基元）是如何在费米能级处打开一个能隙，从而导致从金属性到绝缘性转变的。",
            "id": "2454017",
            "problem": "要求您实现一个程序，该程序能数值预测并比较一维紧束缚模型下均匀原子链和交替双原子链的态密度（DOS）和带隙。所有结果都必须从下文给出的定义出发，通过第一性原理进行计算，不得依赖任何预先推导出的能带能量或态密度的表达式。能量必须以电子伏特（eV）表示，波矢量以倒易长度单位表示，态密度以“态数/电子伏特/晶胞”表示。所有要求的浮点数输出必须四舍五入到 $6$ 位小数。\n\n使用以下基本原理：\n- 实空间中的一维链紧束缚（TB）哈密顿量由在位项和最近邻之间的跃迁项定义，并采用周期性边界条件。对于单原子晶胞（均匀链），每个晶胞有一个原子轨道，其在位能为 $\\varepsilon$，相距晶格常数 $a$ 的相邻晶胞之间的跃迁积分为 $t$。对于双原子晶胞（交替链），每个晶胞有两个轨道A和B，其在位能分别为 $\\varepsilon_A$ 和 $\\varepsilon_B$，相邻及同一晶胞中的A和B轨道之间的最近邻跃迁为 $t$。\n- 根据 Bloch 定理，本征态可以用第一布里渊区（BZ）中的波矢量 $k$ 来标记，紧束缚哈密顿量对于每个 $k$ 都变成一个有限维的 Bloch 哈密顿量 $H(k)$，通过对角化可得到能带能量 $E_n(k)$。\n- 每个晶胞的态密度（DOS）在离散采样极限下由 $g(E) = \\frac{1}{N_k} \\sum_{k \\in \\mathrm{BZ}} \\sum_{n} \\delta\\!\\left(E - E_n(k)\\right)$ 给出，其中 $N_k$ 是用于近似布里渊区积分的 $k$ 点数量。为获得数值稳定的估计，用宽度为 $\\sigma$ 的归一化高斯函数替代 Dirac delta 函数：$\\delta(E) \\to \\frac{1}{\\sqrt{2\\pi}\\,\\sigma}\\exp\\!\\left(-\\frac{E^2}{2\\sigma^2}\\right)$。\n\n您的程序必须：\n- 对于在第一布里渊区 $k \\in [-\\pi/a,\\pi/a]$（含端点）上均匀网格采样的每个 $k$，为均匀单原子链和交替双原子链从实空间紧束缚描述构建 Bloch 哈密顿量 $H(k)$。\n- 对每个 $k$ 对角化 $H(k)$，以获得所有能带 $n$ 和所有 $k$ 点的能带能量集合 $\\{E_n(k)\\}$。\n- 计算费米能级 $E_F = 0$ eV 处的带隙 $\\Delta = E_{\\min}^{(+)} - E_{\\max}^{(-)}$，其中 $E_{\\min}^{(+)}$ 是严格大于 $E_F$ 的最小本征值，而 $E_{\\max}^{(-)}$ 是严格小于 $E_F$ 的最大本征值。如果任一集合为空，或者由于离散化导致计算出的差值为负（即 $E_F$ 位于能带交叉点或能带内），则返回 $\\Delta = 0$ eV。\n- 使用高斯展宽定义和 $k$ 点平均，计算费米能级处的态密度 $g(E_F)$，其宽度为 $\\sigma$。以“态数/电子伏特/晶胞”为单位报告 DOS。\n- 在第一布里渊区上使用大小为 $N_k$ 的均匀 $k$ 点网格，包括两个端点。使用晶格常数 $a$ 来设定布里渊区边界。\n\n测试套件：\n- 使用以下四组参数集。每个测试用例指定了模型类型、在位能、跃迁、晶格常数、$k$ 点数量和高斯宽度。能量单位为电子伏特（eV），晶格常数单位为埃（Å），$\\sigma$ 单位为电子伏特（eV）。所有情况下，费米能级 $E_F$ 固定为 $0$ eV。\n    1. 均匀链（单原子晶胞）：$(\\text{model}=\\text{mono},\\, \\varepsilon = 0.0\\,\\text{eV},\\, t = 1.0\\,\\text{eV},\\, a = 1.0\\,\\text{\\AA},\\, N_k = 4001,\\, \\sigma = 0.05\\,\\text{eV})$。\n    2. 交替链（双原子晶胞）：$(\\text{model}=\\text{diatomic},\\, \\varepsilon_A = 1.0\\,\\text{eV},\\, \\varepsilon_B = -1.0\\,\\text{eV},\\, t = 1.0\\,\\text{eV},\\, a = 1.0\\,\\text{\\AA},\\, N_k = 4001,\\, \\sigma = 0.05\\,\\text{eV})$。\n    3. 交替链（小对比度）：$(\\text{model}=\\text{diatomic},\\, \\varepsilon_A = 0.1\\,\\text{eV},\\, \\varepsilon_B = -0.1\\,\\text{eV},\\, t = 1.0\\,\\text{eV},\\, a = 1.0\\,\\text{\\AA},\\, N_k = 4001,\\, \\sigma = 0.02\\,\\text{eV})$。\n    4. 均匀链（更宽能带）：$(\\text{model}=\\text{mono},\\, \\varepsilon = 0.0\\,\\text{eV},\\, t = 2.0\\,\\text{eV},\\, a = 1.0\\,\\text{\\AA},\\, N_k = 4001,\\, \\sigma = 0.05\\,\\text{eV})$。\n\n最终输出：\n- 对于每个测试用例，计算两个量：带隙 $\\Delta$（单位 eV）和费米能级处的态密度 $g(E_F)$（单位 态数/eV/晶胞），两者均四舍五入到 $6$ 位小数。\n- 您的程序应生成单行输出，其中包含一个逗号分隔的列表，用方括号括起来，顺序为 $[\\Delta_1, g_1, \\Delta_2, g_2, \\Delta_3, g_3, \\Delta_4, g_4]$。\n- 程序必须完全自包含，不得读取任何输入。它必须内嵌并执行指定的测试套件。",
            "solution": "所呈现的问题陈述是有效的。它在科学上基于固态物理学的原理，特别是紧束缚近似，并且在数学上是适定的。所有必要的参数、常数和定义均已提供，构成了一个自包含且无歧义的问题。任务是数值计算一维晶体两种变体的带隙和态密度。我们将首先推导必要的理论结构，然后概述计算算法。\n\n问题的核心是为每个模型构建 Bloch 哈密顿量 $H(k)$。其本征值提供了电子能带结构 $E_n(k)$。\n\n**1. 均匀（单原子）链**\n\n该模型由一维相同原子链构成。晶胞包含单个原子，带有一个轨道，其在晶胞 $j$ 中的基矢可表示为 $|j\\rangle$。晶格常数为 $a$。哈密顿量包括在位能 $\\varepsilon$ 和最近邻跃迁 $t$。在实空间原子轨道基中，矩阵元为：\n$$\n\\langle j|H|m\\rangle = \\begin{cases} \\varepsilon & \\text{if } j = m \\\\ t & \\text{if } |j - m| = 1 \\\\ 0 & \\text{otherwise} \\end{cases}\n$$\n根据 Bloch 定理，周期性系统的本征态可以写成由晶胞周期函数基底构造的 Bloch 波。对于每个晶胞单个轨道的情况，Bloch 哈密顿量 $H(k)$ 是一个 $1 \\times 1$ 矩阵（一个标量），其矩阵元由实空间哈密顿量矩阵元的傅里叶变换给出：\n$$\nH(k) = \\sum_{m} e^{ik(m-j)a} \\langle j|H|m \\rangle\n$$\n设定参考晶胞 $j=0$：\n$$\nH(k) = \\sum_{m} e^{ikma} \\langle 0|H|m \\rangle\n$$\n该求和有三项非零项：\n- 对于 $m=0$：$\\langle 0|H|0 \\rangle = \\varepsilon$。该项为 $\\varepsilon e^{ik(0)a} = \\varepsilon$。\n- 对于 $m=1$：$\\langle 0|H|1 \\rangle = t$。该项为 $t e^{ika}$。\n- 对于 $m=-1$：$\\langle 0|H|-1 \\rangle = t$。该项为 $t e^{-ika}$。\n\n将这些项相加，得到 Bloch 哈密顿量：\n$$\nH(k) = \\varepsilon + t(e^{ika} + e^{-ika}) = \\varepsilon + 2t\\cos(ka)\n$$\n由于这是一个标量，单条能带直接由 $E(k) = \\varepsilon + 2t\\cos(ka)$ 给出。然而，为了遵守问题中不使用预先推导的能量表达式的要求，我们将构建这个 $1 \\times 1$ 矩阵，并对每个 $k$ 数值求解其本征值。\n\n**2. 交替（双原子）链**\n\n该模型描述了一个在每个晶胞中具有双原子基（原子A和B）的链。在位能分别为 $\\varepsilon_A$ 和 $\\varepsilon_B$。跃迁参数 $t$ 连接最近邻的A和B原子。晶胞可以想象为 ...-[A-B]-[A-B]-... 的形式，其中晶格常数 $a$ 是连续A原子之间的距离。在晶胞 $j$ 中，有两个基轨道，即 $|A_j\\rangle$ 和 $|B_j\\rangle$。在此实空间基底中，哈密顿量矩阵元为：\n- 在位：$\\langle A_j|H|A_j\\rangle = \\varepsilon_A$, $\\langle B_j|H|B_j\\rangle = \\varepsilon_B$。\n- 胞内跃迁：$\\langle A_j|H|B_j\\rangle = t$。\n- 胞间跃迁：$\\langle A_j|H|B_{j-1}\\rangle = t$。\n\nBloch 哈密顿量 $H(k)$ 是在 Bloch 和 $| \\phi_{A,k}\\rangle, |\\phi_{B,k}\\rangle$ 基底中的一个 $2 \\times 2$ 矩阵。矩阵元为 $H_{\\mu\\nu}(k) = \\sum_m e^{ikma} \\langle \\mu_0|H|\\nu_m\\rangle$，其中 $\\mu, \\nu \\in \\{A, B\\}$。\n\n- **对角元：**\n  - $H_{AA}(k) = \\langle A_0|H|A_0 \\rangle = \\varepsilon_A$。\n  - $H_{BB}(k) = \\langle B_0|H|B_0 \\rangle = \\varepsilon_B$。\n\n- **非对角元：**\n  - $H_{AB}(k) = \\sum_m e^{ikma} \\langle A_0|H|B_m\\rangle$。非零项对应于 $A_0$ 的邻居：原子 $B_0$（同一晶胞，$m=0$）和原子 $B_{-1}$（前一晶胞，$m=-1$）。\n  $$\n  H_{AB}(k) = e^{ik(0)a} \\langle A_0|H|B_0\\rangle + e^{ik(-1)a} \\langle A_0|H|B_{-1}\\rangle = t + te^{-ika} = t(1 + e^{-ika})\n  $$\n  - $H_{BA}(k)$ 是 $H_{AB}(k)$ 的厄米共轭。假设 $t$ 是实数：\n  $$\n  H_{BA}(k) = (H_{AB}(k))^* = t(1 + e^{ika})\n  $$\n\n最终得到的 $2 \\times 2$ Bloch 哈密顿量为：\n$$\nH(k) = \\begin{pmatrix} \\varepsilon_A & t(1 + e^{-ika}) \\\\ t(1 + e^{ika}) & \\varepsilon_B \\end{pmatrix}\n$$\n两条能带 $E_n(k)$（对于 $n=1,2$）是该矩阵对于每个波矢量 $k$ 的两个本征值。\n\n**3. 数值计算算法**\n\n对于每个指定的测试用例，将执行以下步骤：\n\n**a. 布里渊区的离散化：** 使用一个包含 $N_k$ 个点的均匀网格对第一布里渊区 $k \\in [-\\pi/a, \\pi/a]$ 进行采样，包括端点。\n\n**b. 能带结构计算：** 一个循环遍历网格中的每个 $k$ 值。在每次迭代中，构建相应的 Bloch 哈密顿矩阵 $H(k)$（均匀链为 $1 \\times 1$，交替链为 $2 \\times 2$）。使用厄米矩阵的数值本征求解器计算该矩阵的本征值。所有计算出的本征值 $\\{E_n(k)\\}$ 被收集到一个平坦列表中。\n\n**c. 带隙计算：** 相对于费米能级 $E_F = 0 \\, \\text{eV}$ 计算带隙 $\\Delta$。将所有计算出的本征值集合划分为两个子集：严格大于 $E_F$ 的和严格小于 $E_F$ 的。确定第一个子集的最小值 $E_{\\min}^{(+)}$ 和第二个子集的最大值 $E_{\\max}^{(-)}$。带隙为 $\\Delta = E_{\\min}^{(+)} - E_{\\max}^{(-)}$。如果任一子集为空，或由于离散化效应导致计算出的差值为负，则带隙设为 $\\Delta = 0$。\n\n**d. 态密度计算：** 通过用标准差为 $\\sigma$ 的归一化高斯函数近似 Dirac delta 函数，来计算费米能级处的态密度 $g(E_F)$。直接实现给定的公式：\n$$\ng(E_F) = \\frac{1}{N_k} \\sum_{k,n} \\frac{1}{\\sqrt{2\\pi}\\sigma} \\exp \\left( -\\frac{(E_F - E_n(k))^2}{2\\sigma^2} \\right)\n$$\n对所有计算出的本征值 $\\{E_n(k)\\}$ 进行求和，并将结果除以 $k$ 点数 $N_k$ 进行归一化。\n\n这个从基本紧束缚哈密顿量定义出发的严谨、分步的流程，确保了所有解都按要求从第一性原理导出。最终的程序实现了这一逻辑，以处理测试套件并生成所需的输出。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nimport scipy  # Imported to adhere to problem spec, but not explicitly used.\n\ndef solve():\n    \"\"\"\n    Solves the tight-binding problem for the given test cases.\n    \"\"\"\n    \n    # Test suite as defined in the problem statement.\n    test_cases = [\n        {\"model\": \"mono\", \"params\": {\"eps\": 0.0, \"t\": 1.0, \"a\": 1.0, \"Nk\": 4001, \"sigma\": 0.05}},\n        {\"model\": \"diatomic\", \"params\": {\"epsA\": 1.0, \"epsB\": -1.0, \"t\": 1.0, \"a\": 1.0, \"Nk\": 4001, \"sigma\": 0.05}},\n        {\"model\": \"diatomic\", \"params\": {\"epsA\": 0.1, \"epsB\": -0.1, \"t\": 1.0, \"a\": 1.0, \"Nk\": 4001, \"sigma\": 0.02}},\n        {\"model\": \"mono\", \"params\": {\"eps\": 0.0, \"t\": 2.0, \"a\": 1.0, \"Nk\": 4001, \"sigma\": 0.05}},\n    ]\n    \n    E_F = 0.0  # Fermi energy in eV is fixed at 0.\n    all_results = []\n\n    for case in test_cases:\n        model = case[\"model\"]\n        params = case[\"params\"]\n        \n        a = params[\"a\"]\n        Nk = params[\"Nk\"]\n        sigma = params[\"sigma\"]\n        t = params.get(\"t\")\n\n        k_grid = np.linspace(-np.pi / a, np.pi / a, Nk)\n        all_energies = []\n\n        if model == \"mono\":\n            eps = params[\"eps\"]\n            for k in k_grid:\n                # Construct 1x1 Bloch Hamiltonian\n                # H(k) = eps + 2*t*cos(k*a)\n                # Using complex numbers for consistency, though it's real\n                H_k = np.array([[(eps + 2 * t * np.cos(k * a))]], dtype=np.complex128)\n                # Diagonalize to get eigenvalues\n                eigenvalues = np.linalg.eigh(H_k)[0]\n                all_energies.extend(eigenvalues)\n\n        elif model == \"diatomic\":\n            epsA = params[\"epsA\"]\n            epsB = params[\"epsB\"]\n            for k in k_grid:\n                # Construct 2x2 Bloch Hamiltonian\n                # H(k) = [[epsA, t*(1+exp(-i*k*a))], [t*(1+exp(i*k*a)), epsB]]\n                off_diagonal = t * (1 + np.exp(-1j * k * a))\n                H_k = np.array([\n                    [epsA, off_diagonal],\n                    [np.conj(off_diagonal), epsB]\n                ], dtype=np.complex128)\n                # Diagonalize to get eigenvalues\n                eigenvalues = np.linalg.eigh(H_k)[0]\n                all_energies.extend(eigenvalues)\n\n        energies = np.array(all_energies)\n\n        # Calculate band gap\n        energies_gt_ef = energies[energies > E_F]\n        energies_lt_ef = energies[energies  E_F]\n\n        if energies_gt_ef.size == 0 or energies_lt_ef.size == 0:\n            band_gap = 0.0\n        else:\n            E_min_plus = np.min(energies_gt_ef)\n            E_max_minus = np.max(energies_lt_ef)\n            band_gap = E_min_plus - E_max_minus\n            if band_gap  0:\n                band_gap = 0.0\n        \n        # Calculate Density of States at Fermi energy\n        # g(E) = (1/Nk) * sum_{k,n} (1/sqrt(2*pi*sigma^2)) * exp(-(E-E_n(k))^2 / (2*sigma^2))\n        gaussian_term = (1 / (np.sqrt(2 * np.pi) * sigma)) * np.exp(-((E_F - energies)**2) / (2 * sigma**2))\n        dos_at_ef = np.sum(gaussian_term) / Nk\n        \n        # Append formatted results\n        all_results.append(f\"{band_gap:.6f}\")\n        all_results.append(f\"{dos_at_ef:.6f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(all_results)}]\")\n\nsolve()\n\n```"
        },
        {
            "introduction": "一维金属链在理论上常常是不稳定的。Peierls 定理指出，这样的系统可以通过周期性的晶格畸变（键长交替）来降低其总能量，而这种畸变同时会在费米能级处打开一个能隙，使系统从金属转变为绝缘体。这个练习将模拟一维碳链中的 Peierls 畸变，通过引入一个可调的键交替参数 $\\eta$，你将定量地研究能隙是如何从零开始逐渐打开的，以及态密度在费米能级处是如何变化的。",
            "id": "2454038",
            "problem": "考虑一个具有键交替（Peierls 畸变）的一维碳链，该碳链通过每个晶胞含两个原子的基矢的最近邻紧束缚哈密顿量建模。设晶格常数为 $a$ （单位为埃），两个交替的跃迁振幅为 $t_{1}$ 和 $t_{2}$ （单位为电子伏特）。定义一个基准跃迁幅度 $t$ （单位为电子伏特）和一个无量纲的键交替参数 $\\eta \\in [0,1]$，使得 $t_{1} = t (1+\\eta)$ 和 $t_{2} = t (1-\\eta)$。假设两个子晶格上的在位能均为零，并忽略自旋。在半填充时，费米能级为 $E_{F} = 0$（单位为电子伏特）。在 Born–von Kármán 周期性边界条件下，布洛赫波矢 $k$ 覆盖第一布里渊区 (BZ) $k \\in [-\\pi/a,\\pi/a)$。\n\n在子晶格基矢下，布洛赫哈密顿量是一个 $2 \\times 2$ 的厄米矩阵\n$$\nH(k) =\n\\begin{pmatrix}\n0  -\\big(t_{1} + t_{2} e^{-i k a}\\big) \\\\\n-\\big(t_{1} + t_{2} e^{i k a}\\big)  0\n\\end{pmatrix}.\n$$\n给定 $k$ 时的能带能量是 $H(k)$ 的本征值。费米能级处的带隙 $E_{\\mathrm{gap}}$（单位为电子伏特）是整个布里渊区上导带和价带之间的最小直接带隙：\n$$\nE_{\\mathrm{gap}} = \\min_{k \\in [-\\pi/a,\\pi/a)} \\Big(E_{\\text{conduction}}(k) - E_{\\text{valence}}(k)\\Big).\n$$\n\n态密度 (DOS) 定义如下。在连续谱下，每个晶胞的态密度 (DOS) $D(E)$（单位为 electronvolt$^{-1}$）由下式给出\n$$\nD(E) = \\frac{a}{2\\pi} \\sum_{n} \\int_{-\\pi/a}^{\\pi/a} \\delta\\!\\big(E - E_{n}(k)\\big)\\, \\mathrm{d}k,\n$$\n其中 $E_{n}(k)$ 是能带能量。为了使用采样布里渊区的 $N_{k}$ 个 $k$ 点的均匀网格进行数值计算，可用标准差为 $\\sigma$ （单位为电子伏特）的归一化高斯函数来近似狄拉克 $\\delta$ 函数，\n$$\n\\delta(E - \\varepsilon) \\approx \\frac{1}{\\sqrt{2\\pi}\\,\\sigma}\\exp\\!\\left(-\\frac{(E-\\varepsilon)^{2}}{2\\sigma^{2}}\\right),\n$$\n并用黎曼和近似该积分。由此，能量为 $E$ 时每个晶胞的离散化态密度为\n$$\nD(E) \\approx \\frac{1}{N_{k}} \\sum_{k}\\sum_{n} \\frac{1}{\\sqrt{2\\pi}\\,\\sigma}\\exp\\!\\left(-\\frac{(E-E_{n}(k))^{2}}{2\\sigma^{2}}\\right).\n$$\n\n任务：对于下面测试套件中的每一组参数，计算两个量：\n- 费米能级处的带隙 $E_{\\mathrm{gap}}$（单位为电子伏特），定义如上。\n- 费米能级处的态密度 $D(E_{F})$（单位为 electronvolt$^{-1}$），使用上面给出的高斯展宽的离散化定义以及给定的 $\\sigma$ 和 $N_{k}$。\n\n将 $E_{\\mathrm{gap}}$ 表示为电子伏特，将 $D(E_{F})$ 表示为每晶胞 electronvolt$^{-1}$。将两个量都四舍五入到恰好 $6$ 位小数。\n\n测试套件（每个元组列出 $(t,\\eta,a,N_{k},\\sigma)$）：\n- 情况 1：$(2.50,\\,0.00,\\,1.40,\\,4001,\\,0.02)$\n- 情况 2：$(2.50,\\,0.10,\\,1.40,\\,1001,\\,0.02)$\n- 情况 3：$(2.50,\\,0.30,\\,1.40,\\,1001,\\,0.02)$\n- 情况 4：$(2.50,\\,1.00,\\,1.40,\\,1001,\\,0.02)$\n\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果，每个情况报告为一个双元素列表 $[E_{\\mathrm{gap}}, D(E_{F})]$，顺序与测试套件相同，且不含空格。例如，输出格式必须为\n[[E_gap_1,D(E_F)_1],[E_gap_2,D(E_F)_2],[E_gap_3,D(E_F)_3],[E_gap_4,D(E_F)_4]]\n打印为单行，数值四舍五入到 $6$ 位小数，且不含空格。",
            "solution": "用户提供了一个计算固态物理学问题，在尝试解决之前必须对其进行验证。\n\n### 步骤 1：提取已知信息\n- **模型**：一个具有键交替（Peierls 畸变）的一维碳链，使用最近邻紧束缚哈密顿量建模。\n- **基矢**：每个晶胞含两个原子。\n- **晶格常数**：$a$。\n- **跃迁振幅**：$t_{1} = t (1+\\eta)$ 和 $t_{2} = t (1-\\eta)$，其中 $t$ 是基准跃迁幅度，$\\eta \\in [0,1]$ 是无量纲的键交替参数。\n- **在位能**：假设在两个子晶格上均为零。\n- **费米能级**：$E_{F} = 0$ eV，对应于半填充。\n- **布里渊区 (BZ)**：布洛赫波矢 $k$ 覆盖 $[-\\pi/a, \\pi/a)$。\n- **布洛赫哈密顿量**：$H(k) = \\begin{pmatrix} 0  -\\big(t_{1} + t_{2} e^{-i k a}\\big) \\\\ -\\big(t_{1} + t_{2} e^{i k a}\\big)  0 \\end{pmatrix}$。\n- **能带能量**：$E_{n}(k)$，$H(k)$ 的本征值。\n- **带隙**：$E_{\\mathrm{gap}} = \\min_{k \\in [-\\pi/a,\\pi/a)} \\Big(E_{\\text{conduction}}(k) - E_{\\text{valence}}(k)\\Big)$。\n- **数值态密度 (DOS)**：$D(E) \\approx \\frac{1}{N_{k}} \\sum_{k}\\sum_{n} \\frac{1}{\\sqrt{2\\pi}\\,\\sigma}\\exp\\!\\left(-\\frac{(E-E_{n}(k))^{2}}{2\\sigma^{2}}\\right)$，对于 $N_{k}$ 个 k 点的均匀网格和高斯展宽 $\\sigma$。\n- **任务**：计算带隙 $E_{\\mathrm{gap}}$ 和费米能级处的态密度 $D(E_{F})$。\n- **测试套件**：\n    - 情况 1：$(t,\\eta,a,N_{k},\\sigma) = (2.50, 0.00, 1.40, 4001, 0.02)$\n    - 情况 2：$(t,\\eta,a,N_{k},\\sigma) = (2.50, 0.10, 1.40, 1001, 0.02)$\n    - 情况 3：$(t,\\eta,a,N_{k},\\sigma) = (2.50, 0.30, 1.40, 1001, 0.02)$\n    - 情况 4：$(t,\\eta,a,N_{k},\\sigma) = (2.50, 1.00, 1.40, 1001, 0.02)$\n\n### 步骤 2：使用提取的已知信息进行验证\n对问题进行严格验证。\n1.  **科学依据**：该问题描述了 Su-Schrieffer-Heeger (SSH) 模型，这是凝聚态物理学中研究具有拓扑性质的一维系统的基石。所有概念——紧束缚哈密顿量、布洛赫定理、能带结构、态密度和高斯展宽——都是标准且基本合理的。所提供的哈密顿量对于具有交替跃迁的双位点基矢是正确的。对于碳 $\\pi$ 共轭体系，这些参数在物理上是现实的。该问题具有科学依据。\n2.  **良构性**：问题陈述是完整的，提供了计算所需的所有必要的数学定义和数值参数（$t, \\eta, a, N_{k}, \\sigma$）。任务定义明确，每个情况都能得到唯一的数值解。该问题是良构的。\n3.  **客观性**：语言是形式化和数学化的，没有任何主观性或歧义。该问题是客观的。\n\n### 步骤 3：结论与行动\n该问题被判定为 **有效**，因为它科学合理、良构、客观，并且没有明显缺陷。现在将提供解决方案。\n\n### 基于原理的解决方案\n解决方案分两部分推导：a) 计算带隙 $E_{\\mathrm{gap}}$ 和 b) 计算费米能级处的态密度 $D(E_{F}=0)$。\n\n**a) 带隙计算**\n能带能量 $E(k)$ 是哈密顿量 $H(k)$ 的本征值。特征方程为 $\\det(H(k) - E I) = 0$。\n$$\n\\det \\begin{pmatrix} -E  -(t_{1} + t_{2} e^{-i k a}) \\\\ -(t_{1} + t_{2} e^{i k a})  -E \\end{pmatrix} = E^2 - |t_{1} + t_{2} e^{-i k a}|^2 = 0\n$$\n项 $|t_{1} + t_{2} e^{-i k a}|^2$ 计算如下：\n$$\n|t_{1} + t_{2}(\\cos(ka) - i\\sin(ka))|^2 = (t_{1} + t_{2}\\cos(ka))^2 + (-t_{2}\\sin(ka))^2 = t_{1}^2 + t_2^2 + 2t_{1}t_{2}\\cos(ka)\n$$\n能带能量关于 $E=0$ 对称：\n$$\nE_{\\pm}(k) = \\pm \\sqrt{t_1^2 + t_2^2 + 2t_{1}t_{2}\\cos(ka)}\n$$\n$E_{+}(k)$ 是导带，$E_{-}(k)$ 是价带。给定 $k$ 处的直接能隙为 $E_{+}(k) - E_{-}(k) = 2|E_{+}(k)|$。总带隙 $E_{\\mathrm{gap}}$ 是该量在布里渊区上的最小值。当平方根下的项最小时，出现最小值。由于 $t_{1} = t(1+\\eta)  0$ 和 $t_{2} = t(1-\\eta) \\ge 0$，当 $\\cos(ka) = -1$ 时，即在布里渊区边界 $k = \\pm\\pi/a$ 处，出现最小值。\n$$\nE_{\\mathrm{gap}} = 2 \\sqrt{t_1^2 + t_2^2 - 2t_{1}t_{2}} = 2 \\sqrt{(t_1 - t_2)^2} = 2|t_1 - t_2|\n$$\n代入 $t_{1} = t(1+\\eta)$ 和 $t_{2} = t(1-\\eta)$：\n$$\nt_1 - t_2 = t(1+\\eta) - t(1-\\eta) = 2t\\eta\n$$\n由于 $t  0$ 和 $\\eta \\ge 0$，绝对值是多余的。带隙由简单的解析公式给出：\n$$\nE_{\\mathrm{gap}} = 4t\\eta\n$$\n\n**b) 态密度计算**\n费米能级 $E_{F}=0$ 处的态密度将使用所提供的数值公式计算：\n$$\nD(E_F=0) \\approx \\frac{1}{N_{k}} \\sum_{k}\\sum_{n} \\frac{1}{\\sqrt{2\\pi}\\,\\sigma}\\exp\\!\\left(-\\frac{(0-E_{n}(k))^{2}}{2\\sigma^{2}}\\right)\n$$\n对能带 $n$ 的求和包括导带 ($n=+$) 和价带 ($n=-$)。由于 $E_{-}(k) = -E_{+}(k)$，它们的平方是相同的：$E_{-}^2(k) = E_{+}^2(k) = E(k)^2$，其中 $E(k)^2 = t_1^2 + t_2^2 + 2t_{1}t_{2}\\cos(ka)$。对 $n$ 的求和可以简化为：\n$$\n\\sum_{n=\\pm} \\exp\\!\\left(-\\frac{E_{n}(k)^{2}}{2\\sigma^{2}}\\right) = 2\\exp\\!\\left(-\\frac{E(k)^{2}}{2\\sigma^{2}}\\right)\n$$\n这导出了 $E_F=0$ 处数值 DOS 的最终表达式：\n$$\nD(0) \\approx \\frac{1}{N_{k}} \\sum_{k} \\frac{2}{\\sqrt{2\\pi}\\,\\sigma}\\exp\\!\\left(-\\frac{t_1^2 + t_2^2 + 2t_{1}t_{2}\\cos(ka)}{2\\sigma^{2}}\\right)\n$$\n求和是在第一布里渊区 $k \\in [-\\pi/a, \\pi/a)$ 中 $N_{k}$ 个 $k$ 点的均匀网格上进行的。\n\n### 算法实现\n对于每个给定的参数集 $(t,\\eta,a,N_{k},\\sigma)$：\n1.  计算 $E_{\\mathrm{gap}} = 4t\\eta$。\n2.  将用于 DOS 计算的总和初始化为零。\n3.  从 $-\\pi/a$ 到 $\\pi/a$（不包括上界）生成一个包含 $N_{k}$ 个 $k$ 点的均匀向量。\n4.  对于此 $k$ 点向量，使用推导的表达式计算相应的 $E(k)^2$ 值的向量。\n5.  将高斯展宽函数逐元素应用于能量平方向量，并对结果项求和。\n6.  将总和乘以预因子 $\\frac{1}{N_k}$ 和 $\\frac{2}{\\sqrt{2\\pi}\\sigma}$ 以获得 $D(0)$。\n7.  将 $E_{\\mathrm{gap}}$ 和 $D(0)$ 都四舍五入到 $6$ 位小数并存储它们。\n8.  按照指定格式化最终输出。\n将使用 `numpy` 实现计算，以进行高效的向量运算。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem for the given test suite, computing the band gap\n    and density of states at the Fermi level for a 1D tight-binding model.\n    \"\"\"\n    \n    # Test suite: each tuple contains (t, eta, a, Nk, sigma)\n    test_cases = [\n        (2.50, 0.00, 1.40, 4001, 0.02),\n        (2.50, 0.10, 1.40, 1001, 0.02),\n        (2.50, 0.30, 1.40, 1001, 0.02),\n        (2.50, 1.00, 1.40, 1001, 0.02),\n    ]\n\n    all_results = []\n    \n    for case in test_cases:\n        t, eta, a, Nk, sigma = case\n        \n        # 1. Calculate the band gap (E_gap)\n        # The analytical formula for the band gap is E_gap = 4*t*eta.\n        E_gap = 4.0 * t * eta\n        \n        # 2. Calculate the Density of States (DOS) at the Fermi level (E_F = 0)\n        # Define hopping parameters t1 and t2\n        t1 = t * (1.0 + eta)\n        t2 = t * (1.0 - eta)\n        \n        # Create a uniform mesh of k-points in the first Brillouin Zone [-pi/a, pi/a)\n        # using Nk points.\n        k_vec = np.linspace(-np.pi / a, np.pi / a, Nk, endpoint=False)\n        \n        # Calculate cos(k*a) for all k-points\n        cos_ka = np.cos(k_vec * a)\n        \n        # Calculate the square of the energy eigenvalues, E(k)^2. This is identical\n        # for both the valence and conduction bands.\n        # E(k)^2 = t1^2 + t2^2 + 2*t1*t2*cos(k*a)\n        energy_sq_vec = t1**2 + t2**2 + 2.0 * t1 * t2 * cos_ka\n        \n        # The DOS formula involves a sum over bands and k-points.\n        # For E_F = 0, the contribution from the valence and conduction bands\n        # for each k-point is identical, hence the factor of 2.\n        # D(0) approx (1/Nk) * sum_k [ 2 * (1/sqrt(2pi)/sigma) * exp(-E(k)^2 / (2*sigma^2)) ]\n        \n        # Argument of the exponential function for all k-points\n        gauss_arg = -energy_sq_vec / (2.0 * sigma**2)\n        \n        # The sum of Gaussian terms over all k-points\n        sum_of_gaussians = np.sum(np.exp(gauss_arg))\n        \n        # Prefactor for the DOS calculation\n        prefactor = 2.0 / (np.sqrt(2.0 * np.pi) * sigma)\n        \n        # Final DOS at E_F = 0\n        dos_at_ef = (1.0 / Nk) * prefactor * sum_of_gaussians\n        \n        # Format the result pair as a string \"[E_gap, D0]\" with 6 decimal places\n        result_str = f\"[{E_gap:.6f},{dos_at_ef:.6f}]\"\n        all_results.append(result_str)\n\n    # Final print statement in the exact required format.\n    # e.g., [[val1,val2],[val3,val4]]\n    print(f\"[{','.join(all_results)}]\")\n\nsolve()\n```"
        }
    ]
}