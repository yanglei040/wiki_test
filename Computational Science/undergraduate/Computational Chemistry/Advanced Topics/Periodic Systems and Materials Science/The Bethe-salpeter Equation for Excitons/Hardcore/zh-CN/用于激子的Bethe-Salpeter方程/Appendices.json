{
    "hands_on_practices": [
        {
            "introduction": "要想真正掌握 Bethe-Salpeter 方程，我们从最简单的系统入手：两个耦合的电子-空穴跃迁。这个解析练习将引导你手动推导激子能量和波函数，揭示电子-空穴交换相互作用如何解除跃遷的简并。通过这个实践 ，你将对光学活性的“亮”激子和非活性的“暗”激子的物理起源有一个具体的理解，这是光谱学中的一个基本概念。",
            "id": "2463571",
            "problem": "考虑一个用于描述单线态激子的最小Bethe-Salpeter方程（BSE）模型，该模型构建在由两个独立的带间跃迁（表示为 $\\{|1\\rangle, |2\\rangle\\}$）构成的基上。每个跃迁具有相同的单粒子激发能 $\\Delta>0$。在这个最小模型中，电子-空穴屏蔽直接相互作用为两个跃迁增加了相同的对角位移 $U$，而电子-空穴交换相互作用通过一个对称的非对角矩阵元 $X$ 将这两个跃迁耦合起来。因此，在共振粒子-空穴基矢 $\\{|1\\rangle, |2\\rangle\\}$ 中，激子哈密顿量是一个 $2\\times 2$ 的实对称矩阵\n$$\nH \\equiv \\begin{pmatrix}\n\\Delta + U  & X \\\\\nX  & \\Delta + U\n\\end{pmatrix}.\n$$\n激子本征问题为 $H\\,\\boldsymbol{A}=\\Omega\\,\\boldsymbol{A}$，其中 $\\boldsymbol{A}=(A_{1},A_{2})^{\\mathsf{T}}$ 是激子在所选基矢下的展开系数。沿某一固定偏振方向的光学振子强度与激子跃迁偶极矩的模平方成正比，在此基矢下表示为 $|\\boldsymbol{t}\\cdot \\boldsymbol{A}|^{2}$，其中 $\\boldsymbol{t}=(t_{1},t_{2})$ 集合了单粒子跃迁偶极矩。假设这两个跃迁具有相同且共线的偶极矩，即 $t_{1}=t_{2}=t$ 且 $t\\neq 0$。一个“暗”激子态定义为振子强度为零的态，即 $|\\boldsymbol{t}\\cdot \\boldsymbol{A}|^{2}=0$。\n\n在这些条件下，请确定暗激子态的能量 $\\Omega_{\\mathrm{d}}$，并用 $\\Delta$、$U$ 和 $X$ 表示为一个闭合形式的表达式。请将您的最终答案表示为单个解析表达式。不需要数值四舍五入，也不需要单位。",
            "solution": "首先将对问题陈述进行严格的验证过程。\n\n步骤1：提取已知条件。\n已知条件如下：\n- 用于单线态激子的最小Bethe-Salpeter方程（BSE）模型。\n- 基矢由两个独立的带间跃迁构成：$\\{|1\\rangle, |2\\rangle\\}$。\n- 两个跃迁的单粒子激发能均为：$\\Delta > 0$。\n- 屏蔽直接相互作用（对角位移）：$U$。\n- 电子-空穴交换相互作用（非对角耦合）：$X$。\n- 激子哈密顿量是一个 $2\\times 2$ 的实对称矩阵：\n$$\nH = \\begin{pmatrix}\n\\Delta + U  & X \\\\\nX  & \\Delta + U\n\\end{pmatrix}\n$$\n- 激子本征问题为 $H\\,\\boldsymbol{A}=\\Omega\\,\\boldsymbol{A}$。\n- 激子本征矢为 $\\boldsymbol{A}=(A_{1},A_{2})^{\\mathsf{T}}$。\n- 跃迁偶极矩矢量为 $\\boldsymbol{t}=(t_{1},t_{2})$。\n- 偶极矩的条件是 $t_{1}=t_{2}=t$ 且 $t\\neq 0$。\n- “暗”激子态定义为振子强度为零的态，对应于条件 $|\\boldsymbol{t}\\cdot \\boldsymbol{A}|^{2}=0$。\n\n步骤2：使用提取的已知条件进行验证。\n根据既定标准对问题进行验证。\n- **科学依据**：该问题使用BSE形式主义描述了一个双能级系统中激子的简化但标准的模型。哈密顿量代表了两个简并态通过相互作用耦合的常见情景。这是量子力学和固态物理学中的一个基本概念。该问题在科学上是合理的。\n- **适定性**：该问题被表述为一个 $2\\times 2$ 对称矩阵的标准本征值问题，该问题总是可解的。“暗”态的条件在数学上是精确的。该问题是适定的，并且暗态的能量具有唯一解。\n- **客观性**：语言精确且定量。所有术语都在理论物理的背景下定义。没有主观或模棱两可的陈述。\n- 该问题是自洽、一致的，并提供了得出解决方案所需的所有必要信息。\n\n步骤3：结论与行动。\n该问题被认定为有效。这是量子力学中的一个标准练习。将提供完整的解答。\n\n激子的能量本征值 $\\Omega$ 和相应的本征矢 $\\boldsymbol{A}$ 是通过求解不含时薛定谔方程来确定的，其矩阵形式即为本征问题 $H\\boldsymbol{A} = \\Omega\\boldsymbol{A}$。本征值通过求解特征方程 $\\det(H - \\Omega I) = 0$ 来求得，其中 $I$ 是 $2 \\times 2$ 的单位矩阵。\n$$\n\\det\\begin{pmatrix} \\Delta + U - \\Omega  & X \\\\ X  & \\Delta + U - \\Omega \\end{pmatrix} = 0\n$$\n展开行列式得到久期方程：\n$$\n(\\Delta + U - \\Omega)^{2} - X^{2} = 0\n$$\n求解此方程以得到 $\\Omega$：\n$$\n\\Delta + U - \\Omega = \\pm X\n$$\n$$\n\\Omega = \\Delta + U \\mp X\n$$\n当 $X\\neq 0$ 时，这会产生两个不同的激子态能量本征值：\n$$\n\\Omega_{1} = \\Delta + U - X\n$$\n$$\n\\Omega_{2} = \\Delta + U + X\n$$\n接下来，我们确定每个本征值对应的本征矢。\n\n对于本征值 $\\Omega_{1} = \\Delta + U - X$，其本征矢 $\\boldsymbol{A}_{1} = (A_{1,1}, A_{1,2})^{\\mathsf{T}}$ 通过求解以下方程得到：\n$$\n\\begin{pmatrix} \\Delta + U  & X \\\\ X  & \\Delta + U \\end{pmatrix} \\begin{pmatrix} A_{1,1} \\\\ A_{1,2} \\end{pmatrix} = (\\Delta + U - X) \\begin{pmatrix} A_{1,1} \\\\ A_{1,2} \\end{pmatrix}\n$$\n这给出了线性方程组：\n$$\n(\\Delta + U)A_{1,1} + X A_{1,2} = (\\Delta + U - X)A_{1,1}\n$$\n简化方程，我们得到：\n$$\nX A_{1,1} + X A_{1,2} = 0\n$$\n$$\nX(A_{1,1} + A_{1,2}) = 0\n$$\n假设耦合 $X$ 不为零（否则这些态是平凡简并且非耦合的，我们稍后可以讨论这种情况），这意味着 $A_{1,1} = -A_{1,2}$。未归一化的本征矢与 $(1, -1)^{\\mathsf{T}}$ 成正比。\n\n对于本征值 $\\Omega_{2} = \\Delta + U + X$，其本征矢 $\\boldsymbol{A}_{2} = (A_{2,1}, A_{2,2})^{\\mathsf{T}}$ 通过求解以下方程得到：\n$$\n\\begin{pmatrix} \\Delta + U  & X \\\\ X  & \\Delta + U \\end{pmatrix} \\begin{pmatrix} A_{2,1} \\\\ A_{2,2} \\end{pmatrix} = (\\Delta + U + X) \\begin{pmatrix} A_{2,1} \\\\ A_{2,2} \\end{pmatrix}\n$$\n这给出了方程：\n$$\n(\\Delta + U)A_{2,1} + X A_{2,2} = (\\Delta + U + X)A_{2,1}\n$$\n简化后，我们得到：\n$$\n-X A_{2,1} + X A_{2,2} = 0\n$$\n$$\nX(-A_{2,1} + A_{2,2}) = 0\n$$\n同样，假设 $X \\neq 0$，这意味着 $A_{2,1} = A_{2,2}$。未归一化的本征矢与 $(1, 1)^{\\mathsf{T}}$ 成正比。\n\n现在，我们必须识别出“暗”态。如果一个态的振子强度为零，那么它就是暗态。振子强度与 $|\\boldsymbol{t}\\cdot \\boldsymbol{A}|^{2}$ 成正比，其中 $\\boldsymbol{t} = (t_{1}, t_{2})$。已知 $t_{1} = t_{2} = t$ 且 $t \\neq 0$。因此，$\\boldsymbol{t} = (t, t)$。\n暗态的条件是 $|\\boldsymbol{t}\\cdot \\boldsymbol{A}|^{2}=0$，这等价于 $\\boldsymbol{t}\\cdot \\boldsymbol{A}=0$。\n$$\n\\boldsymbol{t}\\cdot \\boldsymbol{A} = (t, t) \\cdot \\begin{pmatrix} A_{1} \\\\ A_{2} \\end{pmatrix} = tA_{1} + tA_{2} = t(A_{1} + A_{2}) = 0\n$$\n由于 $t \\neq 0$，暗态的条件简化为：\n$$\nA_{1} + A_{2} = 0\n$$\n我们对找到的两个本征矢检查此条件。\n- 对于能量为 $\\Omega_{1} = \\Delta + U - X$ 的态，其本征矢分量满足 $A_{1,1} = -A_{1,2}$。因此，$A_{1,1} + A_{1,2} = -A_{1,2} + A_{1,2} = 0$。此条件满足。这个态就是暗激子。\n- 对于能量为 $\\Omega_{2} = \\Delta + U + X$ 的态，其本征矢分量满足 $A_{2,1} = A_{2,2}$。因此，$A_{2,1} + A_{2,2} = A_{2,2} + A_{2,2} = 2A_{2,2}$。仅当 $A_{2,2}=0$ 时该式才为零，但这将意味着本征矢是零矢量，而不是一个有效的物理态。因此，这个态不是暗态；它是“亮”态。\n\n暗态的能量 $\\Omega_{\\mathrm{d}}$ 是对应于满足暗态条件的本征矢的本征值。即为 $\\Omega_{1}$。\n因此，暗态的激子能量是：\n$$\n\\Omega_{\\mathrm{d}} = \\Delta + U - X\n$$\n如果我们考虑 $X=0$ 的情况，哈密顿量是对角的，$H = (\\Delta+U)I$。任何矢量都是本征矢，具有简并能量 $\\Omega = \\Delta+U$。我们仍然可以构建基矢态的“对称”和“反对称”组合。本征矢与 $(1, -1)^{\\mathsf{T}}$ 成比例的态是暗态，能量为 $\\Delta+U$。我们的公式给出 $\\Omega_{\\mathrm{d}} = \\Delta+U-0 = \\Delta+U$，因此它仍然是正确的。\n最终答案即为推导出的暗激子能量的解析表达式。",
            "answer": "$$\n\\boxed{\\Delta + U - X}\n$$"
        },
        {
            "introduction": "解析模型能提供深刻的洞见，但现实系统则需要数值求解。这项动手编程实践  将指导你为一个多能级系统构建 BSE 哈密顿量并求解其本征值问题。更重要的是，你将学会通过计算每个电子-空穴对的贡献来诠释所得的激子波函数，从而超越仅仅求解能量，深入理解激子的“成分”与特性。",
            "id": "2463513",
            "problem": "考虑一个简单双原子分子在 Bethe-Salpeter 方程（BSE）框架下的最低能量中性激发（激子）。在 Tamm-Dancoff 近似（TDA）中，激子在一个单粒子电子-空穴跃迁（从价带到导带）的基组中展开，该基组由一个整数标签索引。设存在 $N$ 个此类跃迁，其独立粒子跃迁能量为 $\\Delta_i$（单位为电子伏特，eV），其中 $i \\in \\{0,1,\\dots,N-1\\}$。设 $K_{ij}$（单位为电子伏特，eV）是静态屏蔽的电子-空穴相互作用核（假定为实数且对称）。定义激子哈密顿矩阵 $H$，其元素为\n$$\nH_{ij} = \\Delta_i \\delta_{ij} + K_{ij},\n$$\n其中 $\\delta_{ij}$ 是克罗内克（Kronecker）δ函数。激子能量 $\\Omega$ 和振幅 $A_i$ 可通过求解以下特征值问题得到\n$$\n\\sum_{j=0}^{N-1} H_{ij} A_j = \\Omega A_i.\n$$\n对于最低能量的激子（对应于最小特征值的特征向量），定义跃迁 $i$ 对激子波函数的贡献（权重）为\n$$\nw_i = \\frac{|A_i|^2}{\\sum_{j=0}^{N-1} |A_j|^2},\n$$\n该权重是无量纲的，并满足 $\\sum_{i=0}^{N-1} w_i = 1$。\n\n您的任务是为下面的每个测试用例计算与最低能量激子相对应的权重列表 $[w_0, w_1, \\dots, w_{N-1}]$。所有能量都必须以电子伏特为单位处理，但所要求的输出（权重）是无量纲数。每个权重必须作为一个十进制数报告，并四舍五入到六位小数。\n\n测试套件（每个用例指定了 $N$、向量 $\\Delta$（单位为电子伏特）和矩阵 $K$（单位为电子伏特））：\n- 用例 1：$N = 1$，$\\Delta = [\\,2.0\\,]$ eV，$K = \\begin{bmatrix} -0.4 \\end{bmatrix}$ eV。\n- 用例 2：$N = 2$，$\\Delta = [\\,2.0,\\,2.3\\,]$ eV，$K = \\begin{bmatrix} -0.5 & 0.0 \\\\ 0.0 & -0.2 \\end{bmatrix}$ eV。\n- 用例 3：$N = 2$，$\\Delta = [\\,2.1,\\,2.2\\,]$ eV，$K = \\begin{bmatrix} -0.4 & -0.05 \\\\ -0.05 & -0.3 \\end{bmatrix}$ eV。\n- 用例 4：$N = 3$，$\\Delta = [\\,2.5,\\,2.5,\\,2.5\\,]$ eV，$K$ 的所有对角线元素为 $-0.3$，所有非对角线元素为 $-0.05$ eV，即 $K = \\begin{bmatrix} -0.3 & -0.05 & -0.05 \\\\ -0.05 & -0.3 & -0.05 \\\\ -0.05 & -0.05 & -0.3 \\end{bmatrix}$ eV。\n- 用例 5：$N = 2$，$\\Delta = [\\,2.0,\\,2.0\\,]$ eV，$K = \\begin{bmatrix} -0.3 & 0.2 \\\\ 0.2 & -0.3 \\end{bmatrix}$ eV。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个由逗号分隔并用方括号括起来的结果列表。每个结果本身必须是该用例的权重列表，按输入跃迁的顺序排列，每个权重四舍五入到六位小数。例如，一个有效的整体输出可能看起来像 $[[\\,\\dots\\,],[\\,\\dots\\,],\\dots]$，不含额外文本。",
            "solution": "对问题陈述进行了严格审查，并确认其有效。该问题在科学上基于量子力学原理，并应用于计算化学和凝聚态物理，特别是激子理论。其表述遵循 Tamm-Dancoff 近似（BSE/TDA）框架下的标准 Bethe-Salpeter 方程。这是一个适定问题，提供了所有必要的参数和定义，可以通过标准的线性代数方法确定唯一解。\n\n任务是找到最低能量激子中每个电子-空穴对跃迁的权重 $w_i$。这需要求解激子哈密顿矩阵 $H$ 的特征值问题。每个测试用例的步骤如下。\n\n1.  **构建激子哈密顿量 $H$**：根据给定的独立粒子跃迁能量 $\\Delta_i$ 和电子-空穴相互作用核 $K_{ij}$ 构建大小为 $N \\times N$ 的哈密顿矩阵 $H$。$H$ 的元素由以下公式给出：\n    $$\n    H_{ij} = \\Delta_i \\delta_{ij} + K_{ij}\n    $$\n    此处，$\\delta_{ij}$ 是克罗内克 δ 函数，当 $i=j$ 时为 $1$，否则为 $0$。这意味着 $H$ 的对角元素为 $H_{ii} = \\Delta_i + K_{ii}$，非对角元素为 $H_{ij} = K_{ij}$（当 $i \\neq j$ 时）。$\\Delta$ 和 $K$ 的单位均为电子伏特（eV），因此得到的哈密顿矩阵 $H$ 的单位也是 eV。由于规定 $K$ 是实对称的，并且由向量 $\\Delta$ 构成的对角矩阵也是实对称的，因此 $H$ 是一个实对称矩阵。\n\n2.  **求解特征值问题**：我们必须求解特征值方程，以得到激子能量 $\\Omega$（特征值）和激子振幅 $A$（特征向量）：\n    $$\n    H A = \\Omega A\n    $$\n    对于一个大小为 $N \\times N$ 的实对称矩阵 $H$，存在 $N$ 个实特征值 $\\Omega_k$ 和一组相应的 $N$ 个相互正交的特征向量 $A^{(k)}$，其中 $k \\in \\{0, 1, \\dots, N-1\\}$。我们关心的是最低能量的激子，它对应于最小的特征值 $\\Omega_{\\text{min}} = \\min_k\\{\\Omega_k\\}$。设与 $\\Omega_{\\text{min}}$ 对应的特征向量为 $A = (A_0, A_1, \\dots, A_{N-1})^T$。使用标准的数值算法，例如 `numpy.linalg.eigh` 中实现的算法，来寻找特征值和特征向量。这些算法按升序返回特征值，并将相应的特征向量作为矩阵的列返回。特征向量也保证是归一化的。\n\n3.  **计算跃迁权重 $w_i$**：第 $i$ 个电子-空穴跃迁对此最低能量激子的贡献（或权重）$w_i$ 定义为归一化特征向量相应分量的模平方：\n    $$\n    w_i = \\frac{|A_i|^2}{\\sum_{j=0}^{N-1} |A_j|^2}\n    $$\n    如果特征向量 $A$ 已经归一化，使得 $\\sum_{j=0}^{N-1} |A_j|^2 = 1$（标准数值库的输出就是这种情况），则上式简化为：\n    $$\n    w_i = |A_i|^2\n    $$\n    由于 $H$ 是一个实矩阵，其特征向量 $A_i$ 可以选择为实数，因此 $w_i = A_i^2$。权重集合 $\\{w_i\\}$（其中 $i \\in \\{0, 1, \\dots, N-1\\}$）形成一个概率分布，满足 $\\sum_i w_i = 1$。最后一步是为每个测试用例计算这些权重，并按要求将结果四舍五入到六位小数。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the BSE/TDA eigenvalue problem for several test cases to find\n    the weights of the constituent transitions for the lowest-energy exciton.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        {\n            \"N\": 1,\n            \"delta\": np.array([2.0]),\n            \"K\": np.array([[-0.4]])\n        },\n        {\n            \"N\": 2,\n            \"delta\": np.array([2.0, 2.3]),\n            \"K\": np.array([[-0.5, 0.0], [0.0, -0.2]])\n        },\n        {\n            \"N\": 2,\n            \"delta\": np.array([2.1, 2.2]),\n            \"K\": np.array([[-0.4, -0.05], [-0.05, -0.3]])\n        },\n        {\n            \"N\": 3,\n            \"delta\": np.array([2.5, 2.5, 2.5]),\n            \"K\": np.array([[-0.3, -0.05, -0.05], [-0.05, -0.3, -0.05], [-0.05, -0.05, -0.3]])\n        },\n        {\n            \"N\": 2,\n            \"delta\": np.array([2.0, 2.0]),\n            \"K\": np.array([[-0.3, 0.2], [0.2, -0.3]])\n        }\n    ]\n\n    results_str = []\n    for case in test_cases:\n        delta = case[\"delta\"]\n        K = case[\"K\"]\n\n        # 1. Construct the Hamiltonian matrix H.\n        # H_ij = Delta_i * delta_ij + K_ij\n        H = np.diag(delta) + K\n\n        # 2. Solve the eigenvalue problem.\n        # H is real and symmetric, so use eigh for efficiency and stability.\n        # eigh returns eigenvalues in ascending order and corresponding normalized eigenvectors as columns.\n        eigenvalues, eigenvectors = np.linalg.eigh(H)\n\n        # 3. Identify the eigenvector for the lowest-energy exciton.\n        # This is the first column of the eigenvectors matrix, corresponding to the smallest eigenvalue.\n        lowest_energy_eigenvector = eigenvectors[:, 0]\n\n        # 4. Calculate the weights.\n        # w_i = |A_i|^2. Since the eigenvector is normalized, sum(|A_i|^2) = 1.\n        weights = np.square(lowest_energy_eigenvector)\n\n        # 5. Format the output for this case.\n        # The output format is a string like '[w0,w1,...]' without spaces.\n        case_result_str = f\"[{','.join([f'{w:.6f}' for w in weights])}]\"\n        results_str.append(case_result_str)\n\n    # Final print statement in the exact required format.\n    # The output is a string representation of a list of lists of weights,\n    # for example: [[w0,w1],[w0,w1,w2],...]\n    print(f\"[{','.join(results_str)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "包括 BSE 在内的任何基于基组的计算，其关键都在于确保结果的收敛性。这项练习  旨在培养这项至关重要的实践技能，要求你研究激子束缚能如何随着基组中跃迁（导带）数量的增加而变化。通过实施这一收敛性测试，你将学会如何判断计算结果的可靠性，这是严谨科学计算的基石。",
            "id": "2463564",
            "problem": "要求您设计并实现一个程序，用于在一个简化的 Bethe-Salpeter 方程 (BSE) 模型中，量化激子结合能随所包含的空（导）带数量变化的收敛性。请在 Tamm-Dancoff 近似（仅共振块）的框架内工作，并使用一个从第一性原理构建的、物理上自洽的最小化模型。\n\n从以下基本基础出发：在多体微扰理论中，绝缘体或半导体中的电子-空穴激发可以被建模为一个有效双粒子哈密顿量的本征态，其共振块是单粒子部分和一个有吸引力的屏蔽相互作用核的总和。在从占据（价）带到未占据（导）带的跃迁所构成的有限基组中，增加更多的导带会扩大变分空间，根据 Rayleigh-Ritz 变分原理，这只会降低基态本征值。激子结合能定义为单粒子带隙与最低激子能量之差。\n\n在由索引 $i \\in \\{0,1,\\dots,N-1\\}$ 标记的跃迁基中对共振 BSE 哈密顿量进行建模，其中 $N$ 是所包含的导带数量。设单粒子跃迁能量为\n$$\n\\Omega_i = E_{\\mathrm{g}} + i\\,\\Delta_{\\mathrm{c}},\n$$\n其中 $E_{\\mathrm{g}}$ 为单粒子带隙，$\\Delta_{\\mathrm{c}}$ 为连续导带态之间的能量间距。使用一个秩为 1 的、有吸引力的、可分离的屏蔽相互作用核，\n$$\nK_{ij} = -\\alpha\\,u_i\\,u_j,\\quad\\text{with}\\quad u_i = (i+1)^{-p/2},\n$$\n其中 $\\alpha$ 是一个正的耦合强度，$p$ 是一个控制耦合随跃迁指数衰减的无量纲指数。哈密顿矩阵则为\n$$\nH^{(N)}_{ij} = \\delta_{ij}\\,\\Omega_i + K_{ij}.\n$$\n对于给定的 $N$，将最低激子能量定义为 $H^{(N)}$ 的最小本征值 $E_0^{(N)}$，激子结合能定义为\n$$\nE_{\\mathrm{bind}}^{(N)} = E_{\\mathrm{g}} - E_0^{(N)}.\n$$\n根据构造，$E_{\\mathrm{bind}}^{(N)} \\ge 0$。随着 $N$ 的增加，$E_{\\mathrm{bind}}^{(N)}$ 应该是单调不减的，并且在该模型中会趋近于一个有限的极限值。\n\n您的任务是实现一个程序，该程序能够：\n1. 对于下面测试套件中的每一组参数，为一个单调递增的 $N$ 值序列计算 $E_{\\mathrm{bind}}^{(N)}$。\n2. 确定最小的 $N$ (记为 $N_{\\star}$)，使得结合能相对于序列中前一个 $N$ 值的绝对变化小于预设的容差 $\\tau$，即：\n$$\n\\left|E_{\\mathrm{bind}}^{(N)} - E_{\\mathrm{bind}}^{(N_{\\mathrm{prev}})}\\right| < \\tau,\n$$\n其中 $N_{\\mathrm{prev}}$ 是序列中紧邻 $N$ 的前一个值。\n3. 如果在提供的序列中不存在这样的 $N$，则报告 $N_{\\star} = -1$。\n4. 除了 $N_{\\star}$ 之外，还报告在序列中最大的 $N$ 值下计算出的结合能 $E_{\\mathrm{bind}}^{(N_{\\max})}$。\n\n所有能量都必须以电子伏特 (eV) 表示。您的程序必须以 eV 为单位输出浮点数能量。对于每个测试用例，将报告的 $E_{\\mathrm{bind}}^{(N_{\\max})}$ 四舍五入到小数点后 $6$ 位。\n\n测试套件。对于每个用例，使用提供的 $N$ 值序列和容差 $\\tau$：\n- 用例 A: $E_{\\mathrm{g}} = 1.50$ eV, $\\Delta_{\\mathrm{c}} = 0.50$ eV, $\\alpha = 0.20$ eV, $p = 1.0$, $N \\in \\{1,2,4,8,16,32,64,128\\}$, $\\tau = 1.0\\times 10^{-3}$ eV。\n- 用例 B: $E_{\\mathrm{g}} = 2.00$ eV, $\\Delta_{\\mathrm{c}} = 0.30$ eV, $\\alpha = 0.05$ eV, $p = 1.0$, $N \\in \\{1,2,4,8,16,32,64\\}$, $\\tau = 5.0\\times 10^{-4}$ eV。\n- 用例 C: $E_{\\mathrm{g}} = 1.00$ eV, $\\Delta_{\\mathrm{c}} = 0.10$ eV, $\\alpha = 0.35$ eV, $p = 0.8$, $N \\in \\{1,2,4,8,16,32,64,128,256\\}$, $\\tau = 1.0\\times 10^{-3}$ eV。\n- 用例 D: $E_{\\mathrm{g}} = 1.80$ eV, $\\Delta_{\\mathrm{c}} = 0.05$ eV, $\\alpha = 0.30$ eV, $p = 1.2$, $N \\in \\{1,2,4,8,16,32\\}$, $\\tau = 1.0\\times 10^{-4}$ eV。\n\n最终输出格式。您的程序应生成单行输出，其中包含用方括号括起来的、以逗号分隔的结果列表。每个元素本身必须是一个不含空格的、包含两个元素的方括号列表，其中包含 $N_{\\star}$ (一个整数) 和 $E_{\\mathrm{bind}}^{(N_{\\max})}$ 的值 (一个以 eV 为单位、小数点后有六位的浮点数)。例如：\n\"[[-1,0.123456],[8,0.045678],...]\".",
            "solution": "所提出的问题是在一个简化的 Bethe-Salpeter 方程 (BSE) 模型中确定激子结合能的收敛行为。这需要为不断增加的基函数数量计算结合能，并确定能量在给定容差内收敛的点。该模型和参数在物理上是合理的，在数学上是明确定义的，从而使问题有效。\n\n问题的核心在于找到激子哈密顿量的最低本征值，在 Tamm-Dancoff 近似下，对于一个 $N$ 维基，该哈密顿量表示为：\n$$\nH^{(N)}_{ij} = \\delta_{ij} \\Omega_i + K_{ij}\n$$\n此处，$\\delta_{ij}$ 是克罗内克 delta 符号，$\\Omega_i = E_{\\mathrm{g}} + i\\,\\Delta_{\\mathrm{c}}$ 是激发到第 $i$ 个导带（$i \\in \\{0, 1, \\dots, N-1\\}$）的单粒子跃迁能量，而 $K_{ij} = -\\alpha\\,u_i\\,u_j$ 是屏蔽电子-空穴相互作用核。$E_{\\mathrm{g}}$、$\\Delta_{\\mathrm{c}}$ 和 $\\alpha$ 分别是带隙、导带间距和耦合强度。耦合形状因子为 $u_i = (i+1)^{-p/2}$。哈密顿量可以写成跃迁能量 $\\Omega_i$ 的对角矩阵 $D^{(N)}$ 和一个秩为 1 的相互作用矩阵 $K^{(N)} = -\\alpha \\mathbf{u}\\mathbf{u}^T$ 的和，其中 $\\mathbf{u}$ 是一个元素为 $u_i$ 的列向量。\n\n激子能量 $E$ 是 $H^{(N)}$ 的本征值。对于对角矩阵的秩一微扰，可以通过求解久期方程而不是完整的特征多项式来找到本征值。本征值方程 $H^{(N)}\\mathbf{v} = E\\mathbf{v}$ 可以写为：\n$$\n(D^{(N)} - E I) \\mathbf{v} = \\alpha (\\mathbf{u}^T \\mathbf{v}) \\mathbf{u}\n$$\n假设 $E$ 不是单粒子能量 $\\Omega_i$ 中的任何一个，我们可以对 $(D^{(N)} - E I)$ 求逆得到：\n$$\n\\mathbf{v} = \\alpha (\\mathbf{u}^T \\mathbf{v}) (D^{(N)} - E I)^{-1} \\mathbf{u}\n$$\n对于非平凡本征向量 $\\mathbf{v}$，我们必须有 $\\mathbf{u}^T \\mathbf{v} \\neq 0$。从左侧乘以 $\\mathbf{u}^T$ 并除以标量 $\\mathbf{u}^T \\mathbf{v}$，得到关于本征值 $E$ 的久期方程：\n$$\n1 = \\alpha \\sum_{i=0}^{N-1} \\frac{u_i^2}{\\Omega_i - E}\n$$\n最低本征值 $E_0^{(N)}$ 对应于束缚激子态。该本征值保证小于最小的单粒子能量 $\\Omega_0 = E_{\\mathrm{g}}$。激子结合能定义为从带隙边缘起的能量降低量，$E_{\\mathrm{bind}}^{(N)} = E_{\\mathrm{g}} - E_0^{(N)}$。设 $X = E_{\\mathrm{bind}}^{(N)}$。将 $E_0^{(N)} = E_{\\mathrm{g}} - X$ 代入久期方程，得到一个关于结合能本身的方程：\n$$\n\\frac{1}{\\alpha} = \\sum_{i=0}^{N-1} \\frac{(i+1)^{-p}}{i\\Delta_{\\mathrm{c}} + X}\n$$\n这个方程可以使用数值求根算法求解 $X$。然而，考虑到 $N$ 的最大值为 256，一种更直接且稳健的数值方法是构建 $N \\times N$ 矩阵 $H^{(N)}$，并使用标准的线性代数库来求解其本征值。这种方法不易受到求根过程中与区间选择或收敛缓慢相关的问题的影响。\n\n每个测试用例的计算过程如下：\n1. 初始化变量：$E_{\\text{bind}}^{\\text{prev}} = 0.0$，$N_{\\star} = -1$，以及一个用于保存最终结果的列表。\n2. 遍历预设的基组大小序列 $\\{N_1, N_2, \\dots, N_{\\max}\\}$。\n3. 对于序列中的每个 $N$：\n   a. 构建 $N \\times N$ 的实对称哈密顿矩阵 $H^{(N)}$。对角元素为 $H^{(N)}_{ii} = E_{\\mathrm{g}} + i\\Delta_{\\mathrm{c}}$，非对角元素为 $H^{(N)}_{ij} = -\\alpha (i+1)^{-p/2} (j+1)^{-p/2}$。\n   b. 使用数值稳定的算法（例如 NumPy 为对称矩阵提供的算法）计算 $H^{(N)}$ 的本征值。本征值为实数，我们关心的是最小的那个，即 $E_0^{(N)}$。\n   c. 计算结合能 $E_{\\mathrm{bind}}^{(N)} = E_{\\mathrm{g}} - E_0^{(N)}$。\n   d. 对于 $N > N_1$，检查收敛判据：如果 $|E_{\\mathrm{bind}}^{(N)} - E_{\\text{bind}}^{\\text{prev}}| < \\tau$ 且 $N_{\\star}$ 尚未被赋值，则设置 $N_{\\star} = N$。\n   e. 更新 $E_{\\text{bind}}^{\\text{prev}} = E_{\\mathrm{bind}}^{(N)}$。\n4. 循环结束后，最终的结合能 $E_{\\mathrm{bind}}^{(N_{\\max})}$ 是为序列中最大的 $N$ 计算出的值。\n5. 该测试用例的结果是一对值 $[N_{\\star}, E_{\\mathrm{bind}}^{(N_{\\max})}]$, 其中能量值四舍五入到小数点后六位。\n\n将此过程系统地应用于所有提供的测试用例，以生成最终输出。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the BSE convergence problem for a suite of test cases.\n    \"\"\"\n\n    test_cases = [\n        # Case A\n        {'Eg': 1.50, 'delta_c': 0.50, 'alpha': 0.20, 'p': 1.0, \n         'N_values': [1, 2, 4, 8, 16, 32, 64, 128], 'tau': 1.0e-3},\n        # Case B\n        {'Eg': 2.00, 'delta_c': 0.30, 'alpha': 0.05, 'p': 1.0, \n         'N_values': [1, 2, 4, 8, 16, 32, 64], 'tau': 5.0e-4},\n        # Case C\n        {'Eg': 1.00, 'delta_c': 0.10, 'alpha': 0.35, 'p': 0.8, \n         'N_values': [1, 2, 4, 8, 16, 32, 64, 128, 256], 'tau': 1.0e-3},\n        # Case D\n        {'Eg': 1.80, 'delta_c': 0.05, 'alpha': 0.30, 'p': 1.2, \n         'N_values': [1, 2, 4, 8, 16, 32], 'tau': 1.0e-4},\n    ]\n\n    all_results = []\n    for params in test_cases:\n        result = compute_convergence_for_case(**params)\n        all_results.append(result)\n\n    # Format the final output string as specified in the problem.\n    # e.g., \"[[N_star1,E_bind1],[N_star2,E_bind2],...]\"\n    result_strings = [f\"[{res[0]},{res[1]:.6f}]\" for res in all_results]\n    print(f\"[{','.join(result_strings)}]\")\n\ndef compute_convergence_for_case(Eg, delta_c, alpha, p, N_values, tau):\n    \"\"\"\n    Computes N_star and E_bind_Nmax for a single parameter set.\n\n    Args:\n        Eg (float): Independent-particle band gap in eV.\n        delta_c (float): Energy spacing of conduction states in eV.\n        alpha (float): Coupling strength in eV.\n        p (float): Dimensionless exponent for coupling decay.\n        N_values (list[int]): Sequence of numbers of conduction bands to include.\n        tau (float): Convergence tolerance in eV.\n\n    Returns:\n        tuple[int, float]: A tuple containing N_star and the binding energy at N_max.\n    \"\"\"\n    N_star = -1\n    E_bind_prev = 0.0\n    E_bind_Nmax = 0.0\n\n    for i, N in enumerate(N_values):\n        # Construct the BSE Hamiltonian matrix H(N).\n        \n        # indices for transitions, i -> 0, 1, ..., N-1\n        indices = np.arange(N, dtype=np.float64)\n\n        # Diagonal part: independent-particle transition energies Omega_i\n        # D_ii = E_g + i * delta_c\n        D = np.diag(Eg + indices * delta_c)\n\n        # Interaction kernel part: K_ij = -alpha * u_i * u_j\n        # u_i = (i+1)^(-p/2)\n        u_vec = (indices + 1.0)**(-p / 2.0)\n        K = -alpha * np.outer(u_vec, u_vec)\n\n        # Full Hamiltonian H = D + K\n        H = D + K\n\n        # Find the eigenvalues. eigh returns sorted eigenvalues for a symmetric matrix.\n        eigenvalues = np.linalg.eigh(H)[0]\n        E0_N = eigenvalues[0]  # The lowest eigenvalue\n\n        # Calculate the exciton binding energy\n        E_bind_N = Eg - E0_N\n\n        # Check for convergence after the first step\n        if i > 0:\n            abs_change = np.abs(E_bind_N - E_bind_prev)\n            if abs_change < tau and N_star == -1:\n                N_star = N\n        \n        E_bind_prev = E_bind_N\n\n    # The final binding energy is the one for the largest N in the sequence\n    E_bind_Nmax = E_bind_N\n\n    return N_star, E_bind_Nmax\n\nsolve()\n```"
        }
    ]
}