{
    "hands_on_practices": [
        {
            "introduction": "The electronic partition function, $q_{\\text{elec}}$, is often treated as a simple constant equal to the ground state degeneracy, a valid approximation when excited electronic states are energetically inaccessible. This practice challenges that assumption by exploring a hypothetical molecule with a low-lying excited state, allowing you to calculate the temperature at which this state becomes thermally populated. Through this exercise , you will develop a quantitative feel for how thermal energy, $k_{B}T$, relates to electronic energy spacings and gain insight into when $q_{\\text{elec}}$ deviates significantly from its low-temperature limit.",
            "id": "2458667",
            "problem": "A diatomic molecule has two relevant electronic energy levels: a ground state with energy defined as $E_{0}=0$ and a first excited state at an energy separation corresponding to a wavenumber $\\tilde{\\nu}=200\\ \\mathrm{cm}^{-1}$. Both states are non-degenerate. Neglect all higher electronic states and all rotational, vibrational, and translational contributions. The electronic partition function is defined as $q_{\\mathrm{elec}}=\\sum_{i}g_{i}\\exp\\!\\left(-E_{i}/(k_{B}T)\\right)$, where $g_{i}$ is the degeneracy of level $i$, $E_{i}$ is its energy, $k_{B}$ is the Boltzmann constant, and $T$ is the absolute temperature. The energy separation corresponding to a wavenumber $\\tilde{\\nu}$ is $\\Delta E=h\\,c\\,\\tilde{\\nu}$, where $h$ is Planckâ€™s constant and $c$ is the speed of light.\n\nUsing $h=6.62607015\\times 10^{-34}\\ \\mathrm{J\\,s}$, $c=2.99792458\\times 10^{10}\\ \\mathrm{cm\\,s^{-1}}$, and $k_{B}=1.380649\\times 10^{-23}\\ \\mathrm{J\\,K^{-1}}$, determine the temperature $T$ at which $q_{\\mathrm{elec}}$ first exceeds $1.5$; that is, find $T$ such that $q_{\\mathrm{elec}}(T)=1.5$. Express your answer in kelvin and round your result to $4$ significant figures.",
            "solution": "The problem statement presented is subjected to validation.\n\nStep 1: Extracted Givens\n- A diatomic molecule with two relevant electronic energy levels.\n- Ground state energy: $E_{0}=0$.\n- Ground state degeneracy: $g_{0}=1$ (stated as non-degenerate).\n- First excited state energy is at an energy separation corresponding to a wavenumber $\\tilde{\\nu}=200\\ \\mathrm{cm}^{-1}$.\n- First excited state degeneracy: $g_{1}=1$ (stated as non-degenerate).\n- All higher electronic states are neglected.\n- All other degrees of freedom (translational, rotational, vibrational) are neglected.\n- The electronic partition function is defined as $q_{\\mathrm{elec}}=\\sum_{i}g_{i}\\exp(-E_{i}/(k_{B}T))$.\n- The energy separation is given by $\\Delta E=h\\,c\\,\\tilde{\\nu}$.\n- Constants provided: $h=6.62607015\\times 10^{-34}\\ \\mathrm{J\\,s}$, $c=2.99792458\\times 10^{10}\\ \\mathrm{cm\\,s^{-1}}$, and $k_{B}=1.380649\\times 10^{-23}\\ \\mathrm{J\\,K^{-1}}$.\n- The objective is to find the temperature $T$ where $q_{\\mathrm{elec}}(T)=1.5$.\n- The result must be rounded to $4$ significant figures.\n\nStep 2: Validation\nThe problem is scientifically grounded, as it deals with a fundamental concept in statistical mechanics, the molecular partition function. The problem is well-posed; it provides all necessary constants and conditions to determine a unique temperature $T$. The function $q_{\\mathrm{elec}}(T)$ is monotonically increasing with $T$, ensuring a single solution exists for $q_{\\mathrm{elec}}(T)=1.5$. The language is objective and the values are physically realistic and dimensionally consistent. The problem does not violate any of the invalidity criteria.\n\nStep 3: Verdict\nThe problem is valid and a solution will be derived.\n\nThe electronic partition function, $q_{\\mathrm{elec}}$, for a system is given by the sum over all electronic states $i$:\n$$q_{\\mathrm{elec}} = \\sum_{i} g_{i} \\exp\\left(-\\frac{E_{i}}{k_{B}T}\\right)$$\nwhere $g_{i}$ is the degeneracy of state $i$, $E_{i}$ is its energy, $k_{B}$ is the Boltzmann constant, and $T$ is the absolute temperature.\n\nFor the given two-level system, the sum includes only the ground state ($i=0$) and the first excited state ($i=1$). The ground state energy is defined as $E_{0}=0$ and its degeneracy is $g_{0}=1$. The first excited state has an energy $E_{1}$ relative to the ground state, given by the energy corresponding to the wavenumber $\\tilde{\\nu}$. Thus, $E_{1} = \\Delta E = h c \\tilde{\\nu}$. Its degeneracy is given as $g_{1}=1$.\n\nSubstituting these values into the partition function expression:\n$$q_{\\mathrm{elec}} = g_{0}\\exp\\left(-\\frac{E_{0}}{k_{B}T}\\right) + g_{1}\\exp\\left(-\\frac{E_{1}}{k_{B}T}\\right)$$\n$$q_{\\mathrm{elec}} = (1)\\exp\\left(-\\frac{0}{k_{B}T}\\right) + (1)\\exp\\left(-\\frac{h c \\tilde{\\nu}}{k_{B}T}\\right)$$\nThis simplifies to:\n$$q_{\\mathrm{elec}} = 1 + \\exp\\left(-\\frac{h c \\tilde{\\nu}}{k_{B}T}\\right)$$\nWe are required to find the temperature $T$ at which $q_{\\mathrm{elec}} = 1.5$. We set up the equation:\n$$1.5 = 1 + \\exp\\left(-\\frac{h c \\tilde{\\nu}}{k_{B}T}\\right)$$\nTo solve for $T$, we first isolate the exponential term:\n$$1.5 - 1 = 0.5 = \\exp\\left(-\\frac{h c \\tilde{\\nu}}{k_{B}T}\\right)$$\nTaking the natural logarithm of both sides:\n$$\\ln(0.5) = -\\frac{h c \\tilde{\\nu}}{k_{B}T}$$\nSince $\\ln(0.5) = \\ln(1/2) = -\\ln(2)$, the equation becomes:\n$$-\\ln(2) = -\\frac{h c \\tilde{\\nu}}{k_{B}T}$$\n$$\\ln(2) = \\frac{h c \\tilde{\\nu}}{k_{B}T}$$\nNow, we solve for $T$:\n$$T = \\frac{h c \\tilde{\\nu}}{k_{B} \\ln(2)}$$\nThis is the symbolic expression for the temperature. We now substitute the provided numerical values:\n$h = 6.62607015 \\times 10^{-34}\\ \\mathrm{J\\,s}$\n$c = 2.99792458 \\times 10^{10}\\ \\mathrm{cm\\,s^{-1}}$\n$\\tilde{\\nu} = 200\\ \\mathrm{cm}^{-1}$\n$k_{B} = 1.380649 \\times 10^{-23}\\ \\mathrm{J\\,K^{-1}}$\n\nFirst, calculate the numerator, which represents the energy separation $\\Delta E$:\n$$\\Delta E = h c \\tilde{\\nu} = (6.62607015 \\times 10^{-34}\\ \\mathrm{J\\,s}) \\times (2.99792458 \\times 10^{10}\\ \\mathrm{cm\\,s^{-1}}) \\times (200\\ \\mathrm{cm}^{-1})$$\n$$\\Delta E \\approx 3.9728463 \\times 10^{-21}\\ \\mathrm{J}$$\nNext, calculate the denominator:\n$$k_{B} \\ln(2) = (1.380649 \\times 10^{-23}\\ \\mathrm{J\\,K^{-1}}) \\times \\ln(2)$$\n$$k_{B} \\ln(2) \\approx (1.380649 \\times 10^{-23}\\ \\mathrm{J\\,K^{-1}}) \\times 0.69314718$$\n$$k_{B} \\ln(2) \\approx 9.569956 \\times 10^{-24}\\ \\mathrm{J\\,K^{-1}}$$\nFinally, we compute the temperature $T$:\n$$T = \\frac{3.9728463 \\times 10^{-21}\\ \\mathrm{J}}{9.569956 \\times 10^{-24}\\ \\mathrm{J\\,K^{-1}}} \\approx 415.140\\ \\mathrm{K}$$\nThe problem requires the result to be rounded to $4$ significant figures.\n$$T \\approx 415.1\\ \\mathrm{K}$$\nThis is the temperature at which the population of the excited state becomes significant enough for the partition function to reach a value of $1.5$.",
            "answer": "$$\\boxed{415.1}$$"
        },
        {
            "introduction": "The rotational partition function governs the distribution of a collection of molecules among their available rotational energy levels. This exercise  provides a tangible application of the Boltzmann distribution to the quantized levels of a rigid rotor, a cornerstone model in molecular physics. By calculating the population ratio of two rotational states for $\\mathrm{N}_2$ at the extreme temperature of the sun's surface, you will see firsthand how thermal energy drives the population of higher energy levels and illuminates the crucial interplay between a state's energy, its degeneracy, and the ambient temperature.",
            "id": "2458693",
            "problem": "A nitrogen molecule, $^{14}\\mathrm{N}_2$, in the gas phase is in thermal equilibrium at the effective temperature of the solar photosphere, $T = 5778\\ \\mathrm{K}$. Treat $^{14}\\mathrm{N}_2$ as a rigid, linear rotor in its ground electronic and vibrational state, and assume the canonical ensemble. Neglect nuclear spin statistical effects and any centrifugal distortion. The rotational constant (in wavenumbers) for $^{14}\\mathrm{N}_2$ in $v=0$ is $B_0 = 1.9896\\ \\mathrm{cm}^{-1}$. Use the following constants: Planck constant $h = 6.62607015\\times 10^{-34}\\ \\mathrm{J\\,s}$, speed of light $c = 2.99792458\\times 10^{8}\\ \\mathrm{m\\,s}^{-1}$, and Boltzmann constant $k_B = 1.380649\\times 10^{-23}\\ \\mathrm{J\\,K}^{-1}$.\n\nStarting from the canonical definition of level populations and the rigid-rotor energy level structure, determine the ratio of populations of the rotational levels $J=10$ and $J=0$ for $^{14}\\mathrm{N}_2$ under these conditions. Express your final answer as a pure number (no units) and round your result to four significant figures.",
            "solution": "The problem requires the determination of the ratio of populations of two specific rotational levels, $J=10$ and $J=0$, for the nitrogen molecule $^{14}\\mathrm{N}_2$ at a given temperature $T = 5778\\ \\mathrm{K}$. The problem statement must first be validated for scientific soundness and completeness.\n\n**Step 1: Problem Validation**\n\nThe givens are:\n- Molecule: $^{14}\\mathrm{N}_2$\n- Temperature: $T = 5778\\ \\mathrm{K}$\n- Model: Rigid, linear rotor in ground electronic and vibrational state.\n- Assumptions: Canonical ensemble, neglect nuclear spin statistics, neglect centrifugal distortion.\n- Rotational constant: $B_0 = 1.9896\\ \\mathrm{cm}^{-1}$\n- Constants: $h = 6.62607015 \\times 10^{-34}\\ \\mathrm{J\\,s}$, $c = 2.99792458 \\times 10^{8}\\ \\mathrm{m\\,s}^{-1}$, $k_B = 1.380649 \\times 10^{-23}\\ \\mathrm{J\\,K}^{-1}$.\n- Objective: Calculate the ratio of populations $N_{10}/N_0$.\n\nThe problem is scientifically grounded, using the standard rigid rotor model from quantum mechanics and the Boltzmann distribution from statistical mechanics. It is well-posed, providing all necessary physical constants and parameters. The assumptions to neglect certain physical effects (nuclear spin, centrifugal distortion) are explicitly stated, making the problem unambiguous. The temperature, while high, is physically relevant (stellar photosphere). The problem is a standard exercise in physical chemistry. Therefore, the problem is deemed valid and a solution may be constructed.\n\n**Step 2: Derivation of the Solution**\n\nIn the canonical ensemble, the population $N_i$ of a quantum state $i$ with energy $E_i$ at thermal equilibrium is proportional to the Boltzmann factor:\n$$\nN_i \\propto \\exp\\left(-\\frac{E_i}{k_B T}\\right)\n$$\nwhere $k_B$ is the Boltzmann constant and $T$ is the absolute temperature.\n\nA rotational energy *level*, designated by the quantum number $J$, consists of multiple degenerate quantum *states*. For a linear rotor, the degeneracy of the level $J$ is given by $g_J = 2J+1$. The population of the entire level $J$, denoted $N_J$, is the sum of the populations of its constituent states. Since all states within a given level $J$ have the same energy $E_J$, the level population is proportional to the degeneracy multiplied by the Boltzmann factor:\n$$\nN_J \\propto g_J \\exp\\left(-\\frac{E_J}{k_B T}\\right) = (2J+1) \\exp\\left(-\\frac{E_J}{k_B T}\\right)\n$$\n\nFor a rigid, linear rotor, the energy of a rotational level $J$ is given by:\n$$\nE_J = h c B_0 J(J+1)\n$$\nwhere $h$ is the Planck constant, $c$ is the speed of light, and $B_0$ is the rotational constant in wavenumbers.\n\nThe ratio of the populations of two levels, $J_1$ and $J_2$, is therefore:\n$$\n\\frac{N_{J_1}}{N_{J_2}} = \\frac{(2J_1+1) \\exp\\left(-\\frac{h c B_0 J_1(J_1+1)}{k_B T}\\right)}{(2J_2+1) \\exp\\left(-\\frac{h c B_0 J_2(J_2+1)}{k_B T}\\right)}\n$$\n\nWe are asked to find the ratio for $J_1=10$ and $J_2=0$. Substituting these values:\n- For $J=10$: $g_{10} = 2(10)+1 = 21$. The energy term is $J(J+1) = 10(11) = 110$.\n- For $J=0$: $g_0 = 2(0)+1 = 1$. The energy term is $J(J+1) = 0(1) = 0$.\n\nThe energy of the ground rotational state is $E_0 = h c B_0 (0) = 0$. The exponential term for $J=0$ is $\\exp(0) = 1$.\nThe expression for the ratio simplifies to:\n$$\n\\frac{N_{10}}{N_0} = \\frac{21}{1} \\exp\\left(-\\frac{h c B_0 (110)}{k_B T}\\right) = 21 \\exp\\left(-\\frac{110 h c B_0}{k_B T}\\right)\n$$\n\n**Step 3: Numerical Calculation**\n\nWe must now substitute the given physical constants and parameters. It is imperative to use a consistent system of units, for which we choose the International System of Units (SI).\nThe given rotational constant $B_0 = 1.9896\\ \\mathrm{cm}^{-1}$ must be converted to $\\mathrm{m}^{-1}$:\n$$\nB_0 = 1.9896\\ \\mathrm{cm}^{-1} \\times \\frac{100\\ \\mathrm{cm}}{1\\ \\mathrm{m}} = 198.96\\ \\mathrm{m}^{-1}\n$$\nThe constants are:\n- $h = 6.62607015 \\times 10^{-34}\\ \\mathrm{J\\,s}$\n- $c = 2.99792458 \\times 10^{8}\\ \\mathrm{m\\,s}^{-1}$\n- $k_B = 1.380649 \\times 10^{-23}\\ \\mathrm{J\\,K}^{-1}$\n- $T = 5778\\ \\mathrm{K}$\n\nWe calculate the dimensionless argument of the exponential function, $\\frac{110 h c B_0}{k_B T}$:\n$$\n\\frac{110 h c B_0}{k_B T} = \\frac{110 \\times (6.62607015 \\times 10^{-34}\\ \\mathrm{J\\,s}) \\times (2.99792458 \\times 10^{8}\\ \\mathrm{m\\,s}^{-1}) \\times (198.96\\ \\mathrm{m}^{-1})}{(1.380649 \\times 10^{-23}\\ \\mathrm{J\\,K}^{-1}) \\times (5778\\ \\mathrm{K})}\n$$\nThe numerator is:\n$$\n110 \\times (6.62607015 \\times 10^{-34}) \\times (2.99792458 \\times 10^{8}) \\times 198.96 \\approx 4.347541 \\times 10^{-21}\\ \\mathrm{J}\n$$\nThe denominator is:\n$$\n(1.380649 \\times 10^{-23}) \\times 5778 \\approx 7.978502 \\times 10^{-20}\\ \\mathrm{J}\n$$\nThe argument of the exponent is then:\n$$\n\\frac{4.347541 \\times 10^{-21}}{7.978502 \\times 10^{-20}} \\approx 0.05449033\n$$\nNow, we substitute this value back into the population ratio expression:\n$$\n\\frac{N_{10}}{N_0} = 21 \\times \\exp(-0.05449033) \\approx 21 \\times 0.9469553 \\approx 19.886061\n$$\nThe problem requires the answer to be rounded to four significant figures.\n$$\n\\frac{N_{10}}{N_0} \\approx 19.89\n$$\nThis is the final numerical result.",
            "answer": "$$\n\\boxed{19.89}\n$$"
        },
        {
            "introduction": "While the quantum harmonic oscillator provides an elegant and tractable model for molecular vibrations, its parabolic potential fails to capture the reality of bond breaking. This advanced computational exercise  contrasts this idealization with the more realistic Morse potential, which includes anharmonicity and a finite number of bound states before dissociation. Your task is to implement both models computationally and quantify the deviation in the vibrational partition function, $q_{\\text{vib}}$, which offers invaluable experience in translating physical theory into code and reveals the importance of anharmonicity at higher temperatures.",
            "id": "2458704",
            "problem": "You are to write a complete program that, starting from first principles of statistical mechanics, compares the vibrational partition function of a diatomic molecule when the potential energy surface is modeled as a Morse potential versus a harmonic potential. The canonical vibrational partition function is defined by summing Boltzmann factors over the vibrational energy levels, with energies measured relative to the minimum of the potential energy curve. Use only physically well-tested definitions and principles as your starting point, including the canonical definition of the partition function, the existence of discrete vibrational levels for bound states, the relation between wavenumber and angular frequency, and the fact that the Morse oscillator supports a finite number of bound levels that terminate below the dissociation limit. You must not assume or start from any pre-written final formulas for either model; instead, derive what is needed from the above base.\n\nYour task is to:\n- Derive, from the canonical definition of the partition function and the known quantum spectra for the harmonic oscillator and the Morse oscillator, expressions suitable for numerical evaluation of the vibrational partition function in each model. All energies must be referenced to the minimum of the potential energy surface.\n- Implement a program that, for each provided test case, computes the ratio\n$$\nR = \\frac{q_{\\mathrm{vib}}^{\\mathrm{Morse}}}{q_{\\mathrm{vib}}^{\\mathrm{Harmonic}}},\n$$\nwhere $q_{\\mathrm{vib}}^{\\mathrm{Morse}}$ is obtained by summing Boltzmann factors over all bound Morse vibrational levels only, and $q_{\\mathrm{vib}}^{\\mathrm{Harmonic}}$ is obtained from the harmonic oscillator spectrum.\n- Use the following physical constants with their exact or standard values in the International System of Units (SI):\n  - Planck constant $h = 6.62607015\\times 10^{-34}\\,\\mathrm{J\\cdot s}$,\n  - Reduced Planck constant $\\hbar = h/(2\\pi)$,\n  - Speed of light $c = 299792458\\,\\mathrm{m/s}$,\n  - Boltzmann constant (defined here in full) $k_{\\mathrm{B}} = 1.380649\\times 10^{-23}\\,\\mathrm{J/K}$,\n  - Avogadro constant $N_{\\mathrm{A}} = 6.02214076\\times 10^{23}\\,\\mathrm{mol^{-1}}$.\n- Carefully handle units as follows:\n  - Vibrational wavenumber input $\\tilde{\\nu}_{e}$ is provided in $\\mathrm{cm^{-1}}$ and must be converted to angular frequency $\\omega_{e}$ via $\\omega_{e} = 2\\pi c \\tilde{\\nu}_{e}$, with $\\tilde{\\nu}_{e}$ first converted to $\\mathrm{m^{-1}}$ by multiplying by $100$.\n  - Dissociation energy input $D_{e}$ is provided in $\\mathrm{kJ/mol}$ and must be converted to energy per molecule in $\\mathrm{J}$ using $D_{e}(\\mathrm{J\\ per\\ molecule}) = 1000\\,D_{e}(\\mathrm{kJ/mol})/N_{\\mathrm{A}}$.\n  - Temperature $T$ is provided in $\\mathrm{K}$.\n- Angles are not involved. All energies must be in $\\mathrm{J}$, temperatures in $\\mathrm{K}$, and frequencies in $\\mathrm{s^{-1}}$.\n\nFor each test case, compute $R$ to quantify the effect of anharmonicity on the vibrational partition function. You must use the canonical definition $q=\\sum_{i}\\exp(-\\beta E_{i})$ with $\\beta = 1/(k_{\\mathrm{B}} T)$. For the Morse model, include only bound vibrational levels and terminate the sum at the last bound level strictly below the dissociation limit. For the harmonic model, use its full infinite spectrum in a mathematically sound way.\n\nTest suite:\n- Case A (general, stiff bond, moderate temperature): $\\tilde{\\nu}_{e} = 2169.813\\,\\mathrm{cm^{-1}}$, $D_{e} = 1076\\,\\mathrm{kJ/mol}$, $T = 1000\\,\\mathrm{K}$.\n- Case B (low temperature limit): $\\tilde{\\nu}_{e} = 2169.813\\,\\mathrm{cm^{-1}}$, $D_{e} = 1076\\,\\mathrm{kJ/mol}$, $T = 50\\,\\mathrm{K}$.\n- Case C (high temperature, but still with bound-level truncation relevant): $\\tilde{\\nu}_{e} = 2169.813\\,\\mathrm{cm^{-1}}$, $D_{e} = 1076\\,\\mathrm{kJ/mol}$, $T = 8000\\,\\mathrm{K}$.\n- Case D (shallower well, lower frequency, room temperature): $\\tilde{\\nu}_{e} = 500\\,\\mathrm{cm^{-1}}$, $D_{e} = 50\\,\\mathrm{kJ/mol}$, $T = 300\\,\\mathrm{K}$.\n- Case E (very shallow well, strong anharmonicity, few bound levels): $\\tilde{\\nu}_{e} = 1000\\,\\mathrm{cm^{-1}}$, $D_{e} = 10\\,\\mathrm{kJ/mol}$, $T = 1000\\,\\mathrm{K}$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, in the order [Case A, Case B, Case C, Case D, Case E], where each entry is the floating-point value of $R$ rounded to exactly $8$ decimal places. For example, an output of the form\n$[\\text{R}_{A},\\text{R}_{B},\\text{R}_{C},\\text{R}_{D},\\text{R}_{E}]$\nwith each $\\text{R}_{\\cdot}$ formatted to $8$ decimal places is required.",
            "solution": "The problem requires the derivation and computation of the ratio of the vibrational partition function of a diatomic molecule modeled by a Morse potential to that of a harmonic oscillator. The analysis must start from the fundamental definition of the canonical partition function and the quantum mechanical energy spectra of these two models. All energies are to be measured with respect to the minimum of the potential energy curve, which is set as the zero of energy.\n\nThe canonical partition function, $q$, for a system with discrete energy levels $E_i$ at a temperature $T$ is given by the sum over all states $i$:\n$$\nq = \\sum_{i} e^{-\\beta E_i}\n$$\nwhere $\\beta = 1/(k_{\\mathrm{B}} T)$ and $k_{\\mathrm{B}}$ is the Boltzmann constant. For molecular vibrations, the states are indexed by the vibrational quantum number $v = 0, 1, 2, \\dots$.\n\nFirst, we address the necessary unit conversions and definitions of physical parameters. The given inputs are the harmonic vibrational wavenumber $\\tilde{\\nu}_{e}$ in $\\mathrm{cm^{-1}}$, the dissociation energy $D_{e}$ in $\\mathrm{kJ/mol}$, and the temperature $T$ in $\\mathrm{K}$. The constants $h$, $c$, $k_{\\mathrm{B}}$, and $N_{\\mathrm{A}}$ are provided in SI units.\n\nThe harmonic vibrational angular frequency, $\\omega_{e}$, is related to the wavenumber $\\tilde{\\nu}_{e}$ by $\\omega_{e} = 2\\pi c \\tilde{\\nu}_{e}$. To use this formula with SI units, the wavenumber must be in $\\mathrm{m^{-1}}$. The conversion is:\n$$\n\\tilde{\\nu}_{e} \\, (\\mathrm{m^{-1}}) = \\tilde{\\nu}_{e} \\, (\\mathrm{cm^{-1}}) \\times 100\n$$\nThe energy quantum associated with this frequency is $\\hbar\\omega_{e}$, calculated as:\n$$\n\\hbar\\omega_{e} = \\hbar (2\\pi c \\tilde{\\nu}_{e}) = (h/2\\pi) (2\\pi c \\tilde{\\nu}_{e}) = h c \\tilde{\\nu}_{e} \\, (\\mathrm{J})\n$$\nwhere $\\tilde{\\nu}_{e}$ is in $\\mathrm{m^{-1}}$.\n\nThe dissociation energy $D_{e}$ is given in $\\mathrm{kJ/mol}$. To obtain the energy per molecule in Joules, we must convert:\n$$\nD_{e} \\, (\\mathrm{J}) = \\frac{D_{e} \\, (\\mathrm{kJ/mol}) \\times 1000}{N_{\\mathrm{A}}}\n$$\n\nWith these conversions established, we can derive the expressions for the partition functions.\n\n**1. Harmonic Oscillator Vibrational Partition Function ($q_{\\mathrm{vib}}^{\\mathrm{Harmonic}}$)**\n\nThe energy levels of a quantum harmonic oscillator, measured relative to the potential minimum, are given by:\n$$\nE_{v}^{\\mathrm{Harmonic}} = \\left(v + \\frac{1}{2}\\right) \\hbar\\omega_{e}, \\quad v = 0, 1, 2, \\dots\n$$\nThe partition function is the sum over all possible vibrational levels, which for the harmonic oscillator is an infinite set:\n$$\nq_{\\mathrm{vib}}^{\\mathrm{Harmonic}} = \\sum_{v=0}^{\\infty} e^{-\\beta E_{v}^{\\mathrm{Harmonic}}} = \\sum_{v=0}^{\\infty} \\exp\\left[-\\beta \\left(v + \\frac{1}{2}\\right) \\hbar\\omega_{e}\\right]\n$$\nWe can factor out the term corresponding to the zero-point energy ($v=0$):\n$$\nq_{\\mathrm{vib}}^{\\mathrm{Harmonic}} = e^{-\\beta \\hbar\\omega_{e}/2} \\sum_{v=0}^{\\infty} e^{-\\beta v \\hbar\\omega_{e}} = e^{-\\beta \\hbar\\omega_{e}/2} \\sum_{v=0}^{\\infty} \\left(e^{-\\beta \\hbar\\omega_{e}}\\right)^v\n$$\nThe summation is a geometric series of the form $\\sum_{n=0}^{\\infty} r^n = 1/(1-r)$ with $r = e^{-\\beta \\hbar\\omega_{e}}$. Since $\\beta > 0$ and $\\hbar\\omega_{e} > 0$, the ratio $r$ is always less than $1$, so the series converges. Substituting the sum of the series, we obtain the closed-form expression:\n$$\nq_{\\mathrm{vib}}^{\\mathrm{Harmonic}} = \\frac{e^{-\\beta \\hbar\\omega_{e}/2}}{1 - e^{-\\beta \\hbar\\omega_{e}}}\n$$\nThis expression can be rewritten for better numerical stability by multiplying the numerator and denominator by $e^{\\beta \\hbar\\omega_{e}/2}$:\n$$\nq_{\\mathrm{vib}}^{\\mathrm{Harmonic}} = \\frac{1}{e^{\\beta \\hbar\\omega_{e}/2} - e^{-\\beta \\hbar\\omega_{e}/2}} = \\frac{1}{2 \\sinh(\\beta \\hbar\\omega_{e}/2)}\n$$\nThis is the final expression to be implemented for the harmonic oscillator partition function.\n\n**2. Morse Oscillator Vibrational Partition Function ($q_{\\mathrm{vib}}^{\\mathrm{Morse}}$)**\n\nThe energy levels of the Morse oscillator, which accounts for anharmonicity, are given relative to the potential minimum by:\n$$\nE_{v}^{\\mathrm{Morse}} = \\left(v + \\frac{1}{2}\\right) \\hbar\\omega_{e} - \\left(v + \\frac{1}{2}\\right)^2 \\hbar\\omega_{e}x_{e}\n$$\nwhere $\\omega_{e}x_{e}$ is the anharmonicity constant. This constant is not provided directly but can be derived from the dissociation energy $D_{e}$. For the Morse potential, the dissociation energy $D_{e}$ (measured from the potential minimum) is related to the spectroscopic constants by:\n$$\nD_{e} = \\frac{\\omega_{e}}{4x_{e}} \\quad (\\text{in wavenumber units}) \\quad \\implies \\quad D_e = \\frac{(\\hbar\\omega_e)^2}{4 \\hbar\\omega_e x_e} \\quad (\\text{in energy units})\n$$\nFrom this, we can express the energy term containing the anharmonicity constant as:\n$$\n\\hbar\\omega_{e}x_{e} = \\frac{(\\hbar\\omega_{e})^2}{4 D_{e}}\n$$\nSubstituting this back into the energy level expression gives an equation in terms of the provided parameters:\n$$\nE_{v}^{\\mathrm{Morse}} = \\left(v + \\frac{1}{2}\\right) \\hbar\\omega_{e} - \\left(v + \\frac{1}{2}\\right)^2 \\frac{(\\hbar\\omega_{e})^2}{4 D_{e}}\n$$\nUnlike the harmonic oscillator, the Morse potential supports only a finite number of bound vibrational levels. The vibrational quantum number $v$ runs from $0$ up to a maximum value, $v_{\\mathrm{max}}$. This maximum occurs just before the energy spacing between adjacent levels becomes zero or negative. The energy spacing is $\\Delta E_v = E_{v+1} - E_v$. The derivative of $E_v$ with respect to $v$ becoming zero marks the turnover point of the energy levels.\n$$\n\\frac{dE_{v}^{\\mathrm{Morse}}}{dv} = \\hbar\\omega_{e} - 2\\left(v + \\frac{1}{2}\\right) \\hbar\\omega_{e}x_{e} = 0\n$$\nSolving for $v$ yields $v_{\\mathrm{crit}} = \\frac{1}{2x_{e}} - \\frac{1}{2}$. The largest integer quantum number for a bound state is $v_{\\mathrm{max}} = \\lfloor v_{\\mathrm{crit}} \\rfloor$. Using the relation for $x_e$:\n$$\n\\frac{1}{2x_{e}} = \\frac{2 D_{e}}{\\hbar\\omega_{e}} \\implies v_{\\mathrm{max}} = \\left\\lfloor \\frac{2 D_{e}}{\\hbar\\omega_{e}} - \\frac{1}{2} \\right\\rfloor\n$$\nThe partition function is then a finite sum over all bound states from $v=0$ to $v_{\\mathrm{max}}$:\n$$\nq_{\\mathrm{vib}}^{\\mathrm{Morse}} = \\sum_{v=0}^{v_{\\mathrm{max}}} e^{-\\beta E_{v}^{\\mathrm{Morse}}} = \\sum_{v=0}^{v_{\\mathrm{max}}} \\exp\\left[-\\beta \\left( \\left(v + \\frac{1}{2}\\right) \\hbar\\omega_{e} - \\left(v + \\frac{1}{2}\\right)^2 \\frac{(\\hbar\\omega_{e})^2}{4 D_{e}} \\right)\\right]\n$$\nThis sum must be evaluated numerically.\n\n**3. Computational Procedure**\n\nFor each test case $(\\tilde{\\nu}_{e}, D_{e}, T)$:\n1. Define the physical constants: $h, c, k_{\\mathrm{B}}, N_{\\mathrm{A}}$.\n2. Convert inputs to SI units:\n   - $\\tilde{\\nu}_{e, \\mathrm{m}} = \\tilde{\\nu}_{e} \\times 100$\n   - $D_{e, \\mathrm{J}} = (D_{e, \\mathrm{kJ/mol}} \\times 1000) / N_{\\mathrm{A}}$\n3. Calculate fundamental parameters:\n   - $\\beta = 1 / (k_{\\mathrm{B}} T)$\n   - $\\hbar\\omega_{e} = h \\times c \\times \\tilde{\\nu}_{e, \\mathrm{m}}$\n4. Calculate $q_{\\mathrm{vib}}^{\\mathrm{Harmonic}}$:\n   - $x = \\beta \\times \\hbar\\omega_{e}$\n   - $q_{\\mathrm{vib}}^{\\mathrm{Harmonic}} = 1 / (2 \\times \\sinh(x/2))$\n5. Calculate $q_{\\mathrm{vib}}^{\\mathrm{Morse}}$:\n   - Determine $v_{\\mathrm{max}} = \\lfloor (2 \\times D_{e, \\mathrm{J}} / \\hbar\\omega_{e}) - 0.5 \\rfloor$.\n   - Initialize $q_{\\mathrm{vib}}^{\\mathrm{Morse}} = 0$.\n   - Loop for $v$ from $0$ to $v_{\\mathrm{max}}$:\n     -  Calculate $E_{v}^{\\mathrm{Morse}} = (v+0.5)\\hbar\\omega_{e} - (v+0.5)^2 (\\hbar\\omega_{e})^2 / (4 D_{e, \\mathrm{J}})$.\n     -  Add $e^{-\\beta E_{v}^{\\mathrm{Morse}}}$ to the sum.\n6. Compute the ratio $R = q_{\\mathrm{vib}}^{\\mathrm{Morse}} / q_{\\mathrm{vib}}^{\\mathrm{Harmonic}}$.\n7. Store and format the result to 8 decimal places.\nThe final output will be a list of these ratios for all test cases.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the ratio of Morse to Harmonic vibrational partition functions.\n    The derivation and implementation follow first principles of statistical mechanics.\n    \"\"\"\n\n    # Physical Constants in SI units\n    H_PLANCK = 6.62607015e-34  # J*s\n    C_LIGHT = 299792458.0      # m/s\n    K_BOLTZMANN = 1.380649e-23   # J/K\n    N_AVOGADRO = 6.02214076e23  # mol^-1\n    HBAR = H_PLANCK / (2 * np.pi)\n\n    # Test cases: (nu_e_cm^-1, De_kJ/mol, T_K)\n    test_cases = [\n        # Case A: general, stiff bond, moderate temperature\n        (2169.813, 1076.0, 1000.0),\n        # Case B: low temperature limit\n        (2169.813, 1076.0, 50.0),\n        # Case C: high temperature\n        (2169.813, 1076.0, 8000.0),\n        # Case D: shallower well, lower frequency, room temperature\n        (500.0, 50.0, 300.0),\n        # Case E: very shallow well, strong anharmonicity\n        (1000.0, 10.0, 1000.0),\n    ]\n\n    results = []\n    \n    for nu_e_cm, de_kj_mol, temp_k in test_cases:\n        # Step 1: Unit Conversions to SI\n        # Convert wavenumber from cm^-1 to m^-1\n        nu_e_m = nu_e_cm * 100.0\n        # Convert dissociation energy from kJ/mol to J/molecule\n        de_j = (de_kj_mol * 1000.0) / N_AVOGADRO\n\n        # Step 2: Calculate fundamental parameters\n        # Beta factor\n        beta = 1.0 / (K_BOLTZMANN * temp_k)\n        # Vibrational energy quantum\n        hbar_omega_e = H_PLANCK * C_LIGHT * nu_e_m\n\n        # Step 3: Calculate Harmonic Oscillator Partition Function\n        # Using the formula q = 1 / (2*sinh(beta*hbar*omega/2))\n        x_ho = beta * hbar_omega_e\n        q_harmonic = 1.0 / (2.0 * np.sinh(x_ho / 2.0))\n\n        # Step 4: Calculate Morse Oscillator Partition Function\n        # Determine the maximum bound vibrational quantum number, v_max\n        # v_max = floor(2*De / (hbar*omega_e) - 0.5)\n        v_max_float = (2.0 * de_j / hbar_omega_e) - 0.5\n        # Ensure v_max is not negative if the well is extremely shallow\n        if v_max_float < 0:\n            v_max = -1 # this will result in an empty sum, q_morse = 0\n        else:\n            v_max = int(np.floor(v_max_float))\n\n        # Numerically sum over all bound states for the Morse oscillator\n        q_morse = 0.0\n        \n        # Pre-calculate a term for efficiency\n        anharmonic_term_factor = (hbar_omega_e**2) / (4.0 * de_j)\n\n        for v in range(v_max + 1):\n            v_plus_half = v + 0.5\n            energy_morse = v_plus_half * hbar_omega_e - (v_plus_half**2) * anharmonic_term_factor\n            q_morse += np.exp(-beta * energy_morse)\n\n        # Step 5: Calculate the ratio R\n        if q_harmonic == 0:\n             # This case is physically unlikely unless T=0, but handle for safety.\n            ratio = np.inf if q_morse > 0 else 0.0\n        else:\n            ratio = q_morse / q_harmonic\n        \n        results.append(f\"{ratio:.8f}\")\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n\n```"
        }
    ]
}