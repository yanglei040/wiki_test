{
    "hands_on_practices": [
        {
            "introduction": "Before diving into complex simulations, it is essential to grasp the fundamental concept of a microstate. This exercise provides a concrete opportunity to enumerate all possible configurations for a small, isolated quantum system at a fixed total energy. By explicitly listing the microstates for a simple Einstein solid , you will build a tangible intuition for the quantity $\\Omega(E)$, the number of accessible microstates, which is the cornerstone of the microcanonical ensemble.",
            "id": "1962160",
            "problem": "The Einstein model of a solid treats a crystalline solid as a collection of $N$ identical, distinguishable, one-dimensional quantum harmonic oscillators. The distinguishability arises from the oscillators being localized at different lattice sites. The energy of each individual oscillator is quantized and can only take values $E_n = n \\hbar \\omega$, where $n$ is a non-negative integer representing the number of energy quanta, $\\hbar$ is the reduced Planck constant, and $\\omega$ is the oscillator's natural frequency.\n\nConsider a small, isolated Einstein solid consisting of $N=3$ such oscillators. The total energy of this solid is fixed at $E = 2\\hbar\\omega$. A \"microstate\" of the system is defined by a specific distribution of the energy quanta among the three oscillators. Determine the total number of distinct microstates available to this system.",
            "solution": "In the Einstein model, each oscillator has quantized energy $E_{n_{i}}=n_{i}\\hbar\\omega$ with $n_{i}\\in\\{0,1,2,\\ldots\\}$. For $N=3$ oscillators and fixed total energy $E=2\\hbar\\omega$, the total energy constraint is\n$$\n\\sum_{i=1}^{3}E_{n_{i}}=\\hbar\\omega\\sum_{i=1}^{3}n_{i}=2\\hbar\\omega,\n$$\nwhich implies\n$$\n\\sum_{i=1}^{3}n_{i}=2.\n$$\nDefining $q\\equiv E/(\\hbar\\omega)=2$, the microstates correspond to all ordered triples $(n_{1},n_{2},n_{3})$ of nonnegative integers summing to $q$. Because the oscillators are distinguishable, the number of such microstates is the number of weak compositions of $q$ into $N$ parts, given by the stars-and-bars formula\n$$\n\\Omega=\\binom{q+N-1}{q}.\n$$\nSubstituting $q=2$ and $N=3$ gives\n$$\n\\Omega=\\binom{2+3-1}{2}=\\binom{4}{2}=6.\n$$\nThis can be verified by explicit enumeration: $(2,0,0),(0,2,0),(0,0,2),(1,1,0),(1,0,1),(0,1,1)$.",
            "answer": "$$\\boxed{6}$$"
        },
        {
            "introduction": "Moving from discrete quantum states to continuous classical systems requires a conceptual shift from counting states to measuring a volume in phase space. This practice challenges you to calculate this volume, $\\Phi(E)$, for a gas of classical particles with both translational and rotational degrees of freedom. This exercise  bridges the gap between the simple combinatorics of quantum models and the continuous integrals that are fundamental to classical statistical mechanics.",
            "id": "2006170",
            "problem": "Consider a simplified model for a swarm of two-dimensional nanorobots designed for surface-level operations. The swarm consists of $N$ identical, non-interacting nanorobots confined to a flat surface of area $A$. Each nanorobot can be modeled as a classical rigid dumbbell with a total mass $M$ and a moment of inertia $I$ for rotation within the plane. The total energy of the entire system, which is composed of the translational kinetic energy of the centers of mass and the rotational kinetic energy of the dumbbells, is known to be no greater than a fixed value $E$.\n\nWithin the framework of the microcanonical ensemble, determine the total volume of the accessible phase space, $\\Phi(E)$, for this system. Treat the nanorobots as indistinguishable particles. Your calculation should account for the quantization of phase space, where each pair of conjugate position and momentum coordinates occupies a volume of Planck's constant, $h$. Provide your answer as a single, closed-form analytic expression in terms of $N, A, M, I, E,$ and $h$.",
            "solution": "In the microcanonical ensemble, the phase space volume up to total energy $E$ is\n$$\n\\Phi(E)=\\frac{1}{N!\\,h^{3N}}\\int \\prod_{i=1}^{N}\\left(d^{2}r_{i}\\,d\\theta_{i}\\,d^{2}p_{i}\\,dL_{i}\\right)\\,\\Theta\\!\\left(E-\\sum_{i=1}^{N}\\left[\\frac{p_{xi}^{2}+p_{yi}^{2}}{2M}+\\frac{L_{i}^{2}}{2I}\\right]\\right),\n$$\nwhere $\\Theta$ is the Heaviside step function. Each particle has 3 conjugate pairs: $(x_{i},p_{xi})$, $(y_{i},p_{yi})$, and $(\\theta_{i},L_{i})$. For the $N$-particle system, the quantization factor is therefore $h^{3N}$. Indistinguishability yields the factor $1/N!$.\n\nSince there is no potential energy, the configuration integrals factor:\n$$\n\\int \\prod_{i=1}^{N} d^{2}r_{i} = A^{N},\\qquad \\int \\prod_{i=1}^{N} d\\theta_{i} = (2\\pi)^{N}.\n$$\n\nFor the momentum-space integral, define scaled variables\n$$\nu_{xi}=\\frac{p_{xi}}{\\sqrt{2M}},\\quad u_{yi}=\\frac{p_{yi}}{\\sqrt{2M}},\\quad v_{i}=\\frac{L_{i}}{\\sqrt{2I}},\n$$\nso that\n$$\n\\sum_{i=1}^{N}\\left(\\frac{p_{xi}^{2}+p_{yi}^{2}}{2M}+\\frac{L_{i}^{2}}{2I}\\right)=\\sum_{i=1}^{N}\\left(u_{xi}^{2}+u_{yi}^{2}+v_{i}^{2}\\right)\\leq E.\n$$\nThe Jacobian of this transformation is\n$$\n\\prod_{i=1}^{N}\\left(dp_{xi}\\,dp_{yi}\\,dL_{i}\\right)=(2M)^{N}(2I)^{N/2}\\prod_{i=1}^{N}\\left(du_{xi}\\,du_{yi}\\,dv_{i}\\right).\n$$\nThus the momentum-space integral equals the Jacobian times the volume of a $3N$-dimensional ball of radius $\\sqrt{E}$:\n$$\n\\int \\prod_{i=1}^{N}\\left(d^{2}p_{i}\\,dL_{i}\\right)\\,\\Theta(\\cdots)=(2M)^{N}(2I)^{N/2}\\,\\frac{\\pi^{\\frac{3N}{2}}\\,E^{\\frac{3N}{2}}}{\\Gamma\\!\\left(\\frac{3N}{2}+1\\right)}.\n$$\n\nCombining all factors,\n$$\n\\Phi(E)=\\frac{A^{N}(2\\pi)^{N}(2M)^{N}(2I)^{\\frac{N}{2}}\\pi^{\\frac{3N}{2}}E^{\\frac{3N}{2}}}{N!\\,h^{3N}\\,\\Gamma\\!\\left(\\frac{3N}{2}+1\\right)}.\n$$\nSimplifying the powers of $2$ and $\\pi$,\n$$\n(2\\pi)^{N}\\,(2M)^{N}\\,(2I)^{\\frac{N}{2}}\\,\\pi^{\\frac{3N}{2}}=(2\\pi)^{\\frac{5N}{2}}\\,M^{N}\\,I^{\\frac{N}{2}}.\n$$\nTherefore, the total accessible phase space volume is\n$$\n\\Phi(E)=\\frac{A^{N}\\,M^{N}\\,I^{\\frac{N}{2}}\\,(2\\pi)^{\\frac{5N}{2}}\\,E^{\\frac{3N}{2}}}{N!\\,h^{3N}\\,\\Gamma\\!\\left(\\frac{3N}{2}+1\\right)}.\n$$",
            "answer": "$$\\boxed{\\frac{A^{N}\\,M^{N}\\,I^{\\frac{N}{2}}\\,(2\\pi)^{\\frac{5N}{2}}\\,E^{\\frac{3N}{2}}}{N!\\,h^{3N}\\,\\Gamma\\!\\left(\\frac{3N}{2}+1\\right)}}$$"
        },
        {
            "introduction": "The ultimate hands-on application of the microcanonical ensemble is the NVE molecular dynamics (MD) simulation, which models an isolated system. In this computational practice, you will implement an MD simulation and investigate how well the defining feature of the ensemble—the conservation of total energy—is maintained by a numerical algorithm. By analyzing the energy drift for different integration time steps , you will gain practical insight into the fidelity and limitations of simulating a system at constant energy.",
            "id": "2465352",
            "problem": "Consider a microcanonical (Number-Volume-Energy) ensemble (NVE) model system in classical mechanics: a diatomic molecule in one spatial dimension composed of two ($2$) point particles of equal mass interacting via a Morse potential. Let the positions be $x_1(t)$ and $x_2(t)$, the velocities be $v_1(t)$ and $v_2(t)$, and the masses be $m_1=m_2=m$. The interparticle separation is $r(t)=\\lvert x_1(t)-x_2(t)\\rvert$. The potential energy is given by\n$$\nU(r)=D_e\\left(1-\\exp\\!\\left(-a\\left[r-r_e\\right]\\right)\\right)^2,\n$$\nwith parameters $D_e>0$, $a>0$, and $r_e>0$. The total energy is\n$$\nE(t)=\\frac{1}{2}m v_1(t)^2+\\frac{1}{2}m v_2(t)^2+U(r(t)).\n$$\nThe equations of motion are Newton’s equations with forces derived from $U(r)$ so that the net force is central and equal and opposite on the two particles. Use the following dimensionless reduced units: $m=1$, $D_e=1$, $a=1$, and $r_e=1$. Use the initial conditions $x_1(0)=0$, $x_2(0)=1.2$, $v_1(0)=0$, and $v_2(0)=0$. Evolve the system for a total physical time $T_{\\mathrm{end}}=500$ using a fixed time increment $\\Delta t$.\n\nFor each simulation, define the relative final energy drift as the dimensionless quantity\n$$\n\\delta(\\Delta t)=\\frac{E(T_{\\mathrm{end}})-E(0)}{E(0)}.\n$$\nReport $\\delta(\\Delta t)$ as a decimal (no percentage sign and no physical unit, since the quantity is dimensionless).\n\nTest suite:\n- Use the following four ($4$) fixed time increments in this exact order: $\\Delta t\\in\\{0.90,0.50,0.20,0.05\\}$.\n- For each $\\Delta t$, integrate from $t=0$ to $t=T_{\\mathrm{end}}$ using the specified fixed time increment.\n\nYour program should produce a single line of output containing the four ($4$) results $\\delta(0.90)$, $\\delta(0.50)$, $\\delta(0.20)$, and $\\delta(0.05)$ as a comma-separated list enclosed in square brackets, in the same order as the test suite (for example, $[\\delta(0.90),\\delta(0.50),\\delta(0.20),\\delta(0.05)]$). Each reported value must be a single floating-point number.",
            "solution": "The microcanonical (Number-Volume-Energy) ensemble (NVE) prescribes dynamics at fixed number of particles, fixed volume, and fixed total energy, which for classical point particles is realized by solving Newton’s equations for an isolated system. For two ($2$) particles in one dimension interacting via a central potential $U(r)$ with $r=\\lvert x_1-x_2\\rvert$, the forces are equal in magnitude and opposite in direction along the line joining the particles. The total energy,\n$$\nE(t)=\\frac{1}{2}m v_1^2+\\frac{1}{2}m v_2^2+U(r),\n$$\nshould be conserved by the exact continuous dynamics. Numerical time discretization introduces errors that generally depend on the time step $\\Delta t$, and the goal is to quantify the relative final energy drift\n$$\n\\delta(\\Delta t)=\\frac{E(T_{\\mathrm{end}})-E(0)}{E(0)}\n$$\nafter integrating over a fixed physical time $T_{\\mathrm{end}}$.\n\nSystem specification in reduced units sets $m=1$, $D_e=1$, $a=1$, and $r_e=1$. The Morse potential is\n$$\nU(r)=D_e\\left(1-\\exp\\!\\left(-a\\left[r-r_e\\right]\\right)\\right)^2,\n$$\nand its radial derivative with respect to $r$ is obtained by the chain rule. Let $y=\\exp\\!\\left(-a\\left[r-r_e\\right]\\right)$. Then\n$$\nU(r)=D_e(1-y)^2,\\quad \\frac{dy}{dr}=-a\\,y,\n$$\nso\n$$\n\\frac{dU}{dr}=2D_e(1-y)\\left(-\\frac{dy}{dr}\\right)=2D_e(1-y)\\,a\\,y.\n$$\nThe scalar radial force is $F_r=-\\frac{dU}{dr}$, and in one dimension the force on particle $1$ is\n$$\nF_1=F_r\\,\\frac{x_1-x_2}{r}=-\\frac{dU}{dr}\\,\\frac{x_1-x_2}{\\lvert x_1-x_2\\rvert},\n$$\nwith $F_2=-F_1$ by Newton’s third law. With $m=1$, the accelerations are $a_1=F_1$ and $a_2=F_2$.\n\nTo integrate the equations of motion over a fixed physical time $T_{\\mathrm{end}}$ at fixed time step $\\Delta t$, a time-reversible, symplectic discretization that is consistent with the NVE setting is the velocity-Verlet scheme. Given positions $x_i^n$, velocities $v_i^n$, and accelerations $a_i^n$ at time $t_n$, one time step of size $\\Delta t$ updates as\n$$\nx_i^{n+1}=x_i^{n}+v_i^{n}\\,\\Delta t+\\frac{1}{2}a_i^{n}\\,\\Delta t^2,\n$$\nthen compute new accelerations $a_i^{n+1}$ from the updated positions, and update velocities by\n$$\nv_i^{n+1}=v_i^{n}+\\frac{1}{2}\\left(a_i^{n}+a_i^{n+1}\\right)\\Delta t.\n$$\nThe initial conditions are $x_1(0)=0$, $x_2(0)=1.2$, $v_1(0)=0$, and $v_2(0)=0$. The initial energy is\n$$\nE(0)=\\frac{1}{2}m v_1(0)^2+\\frac{1}{2}m v_2(0)^2+U\\!\\left(\\lvert x_1(0)-x_2(0)\\rvert\\right)=U(1.2),\n$$\nwhich is strictly positive since $U(r)\\ge 0$ with a minimum at $r=r_e=1$. The simulation proceeds for $N$ steps where $N$ is the nearest integer to $T_{\\mathrm{end}}/\\Delta t$, namely\n$$\nN=\\operatorname{round}\\!\\left(\\frac{T_{\\mathrm{end}}}{\\Delta t}\\right),\n$$\nso that the elapsed time is approximately $T_{\\mathrm{end}}$. At the end of the trajectory, compute $E(T_{\\mathrm{end}})$ from the final positions and velocities, and then the relative drift $\\delta(\\Delta t)$.\n\nThe test suite specifies four ($4$) different $\\Delta t$ values: $\\Delta t\\in\\{0.90,0.50,0.20,0.05\\}$. For the Morse potential near its minimum, the small-amplitude angular frequency of the relative coordinate is $\\omega=\\sqrt{\\frac{1}{\\mu}\\,\\left.\\frac{d^2U}{dr^2}\\right|_{r=r_e}}$, where the reduced mass is $\\mu=\\frac{m}{2}$ for two equal masses. With $m=1$, $D_e=1$, $a=1$, and $r_e=1$, one finds $\\left.\\frac{d^2U}{dr^2}\\right|_{r=r_e}=2D_e a^2=2$, hence $\\omega=\\sqrt{\\frac{2}{1/2}}=2$. The Verlet stability bound for a harmonic oscillator is $\\Delta t<\\frac{2}{\\omega}=1$, so all specified $\\Delta t$ values are within the stable regime but will exhibit differing energy errors. As $\\Delta t$ decreases, the integrator better approximates the continuous dynamics, so $\\lvert\\delta(\\Delta t)\\rvert$ is expected to decrease.\n\nAlgorithmic steps implemented in the program:\n- Define $U(r)$ and its derivative $\\frac{dU}{dr}$ using the expressions above with the specified parameters.\n- Compute forces $F_1$ and $F_2$ from $\\frac{dU}{dr}$ using $F_1=-\\frac{dU}{dr}\\,\\frac{x_1-x_2}{\\lvert x_1-x_2\\rvert}$ and $F_2=-F_1$.\n- Initialize $x_1(0)$, $x_2(0)$, $v_1(0)$, $v_2(0)$, compute $E(0)$, and integrate for $N=\\operatorname{round}(T_{\\mathrm{end}}/\\Delta t)$ steps using velocity-Verlet.\n- Compute $E(T_{\\mathrm{end}})$ and the relative drift $\\delta(\\Delta t)$.\n- Repeat for each $\\Delta t$ in the test suite and output $[\\delta(0.90),\\delta(0.50),\\delta(0.20),\\delta(0.05)]$ on a single line.\n\nThis procedure directly follows from Newton’s second law, the definition of the Morse potential and its force, and the definition of the total energy in classical mechanics, thereby quantifying the dependence of the energy drift on the time step in an NVE simulation.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef morse_potential(r, De=1.0, a=1.0, re=1.0):\n    # U(r) = De * (1 - exp(-a*(r - re)))^2\n    y = np.exp(-a * (r - re))\n    return De * (1.0 - y) ** 2\n\ndef dU_dr_morse(r, De=1.0, a=1.0, re=1.0):\n    # dU/dr = 2 * De * a * y * (1 - y), where y = exp(-a*(r - re))\n    y = np.exp(-a * (r - re))\n    return 2.0 * De * a * y * (1.0 - y)\n\ndef forces_1d_morse(x1, x2, De=1.0, a=1.0, re=1.0):\n    # Compute central forces in 1D for two particles interacting via Morse potential.\n    dx = x1 - x2\n    r = abs(dx)\n    if r == 0.0:\n        # Degenerate case; return zero to avoid division by zero (will not occur with given ICs).\n        return 0.0, 0.0\n    dUdr = dU_dr_morse(r, De=De, a=a, re=re)\n    # Radial force magnitude: F_r = - dU/dr\n    Fr = -dUdr\n    # Direction for particle 1 along the line connecting particles\n    s = dx / r  # sign(+/-1)\n    F1 = Fr * s\n    F2 = -F1\n    return F1, F2\n\ndef total_energy(x1, x2, v1, v2, m=1.0, De=1.0, a=1.0, re=1.0):\n    r = abs(x1 - x2)\n    U = morse_potential(r, De=De, a=a, re=re)\n    K = 0.5 * m * v1 * v1 + 0.5 * m * v2 * v2\n    return K + U\n\ndef energy_drift_for_dt(dt, Tend=500.0):\n    # Parameters in reduced units\n    m = 1.0\n    De = 1.0\n    a = 1.0\n    re = 1.0\n\n    # Initial conditions\n    x1 = 0.0\n    x2 = 1.2\n    v1 = 0.0\n    v2 = 0.0\n\n    # Initial accelerations from forces\n    F1, F2 = forces_1d_morse(x1, x2, De=De, a=a, re=re)\n    a1 = F1 / m\n    a2 = F2 / m\n\n    E0 = total_energy(x1, x2, v1, v2, m=m, De=De, a=a, re=re)\n\n    steps = int(round(Tend / dt))\n    dt2_half = 0.5 * dt * dt\n\n    for _ in range(steps):\n        # Position update\n        x1 += v1 * dt + a1 * dt2_half\n        x2 += v2 * dt + a2 * dt2_half\n\n        # New accelerations from updated positions\n        F1_new, F2_new = forces_1d_morse(x1, x2, De=De, a=a, re=re)\n        a1_new = F1_new / m\n        a2_new = F2_new / m\n\n        # Velocity update\n        v1 += 0.5 * (a1 + a1_new) * dt\n        v2 += 0.5 * (a2 + a2_new) * dt\n\n        # Prepare for next step\n        a1, a2 = a1_new, a2_new\n\n    E_end = total_energy(x1, x2, v1, v2, m=m, De=De, a=a, re=re)\n    # Relative drift (dimensionless)\n    drift = (E_end - E0) / abs(E0) if E0 != 0.0 else 0.0\n    return drift\n\ndef solve():\n    # Define the test cases from the problem statement (fixed order).\n    test_cases = [0.90, 0.50, 0.20, 0.05]\n\n    results = []\n    for dt in test_cases:\n        drift = energy_drift_for_dt(dt, Tend=500.0)\n        results.append(drift)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}