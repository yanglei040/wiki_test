{
    "hands_on_practices": [
        {
            "introduction": "The cornerstone of the microcanonical ensemble is the simple but profound act of counting all possible microscopic arrangements, or 'microstates', consistent with a fixed total energy. This exercise provides a concrete opportunity to perform this fundamental task for a simplified quantum model of a solid. By explicitly enumerating the ways energy can be distributed among oscillators , you will build a tangible intuition for the statistical basis of entropy.",
            "id": "1962160",
            "problem": "The Einstein model of a solid treats a crystalline solid as a collection of $N$ identical, distinguishable, one-dimensional quantum harmonic oscillators. The distinguishability arises from the oscillators being localized at different lattice sites. The energy of each individual oscillator is quantized and can only take values $E_n = n \\hbar \\omega$, where $n$ is a non-negative integer representing the number of energy quanta, $\\hbar$ is the reduced Planck constant, and $\\omega$ is the oscillator's natural frequency.\n\nConsider a small, isolated Einstein solid consisting of $N=3$ such oscillators. The total energy of this solid is fixed at $E = 2\\hbar\\omega$. A \"microstate\" of the system is defined by a specific distribution of the energy quanta among the three oscillators. Determine the total number of distinct microstates available to this system.",
            "solution": "In the Einstein model, each oscillator has quantized energy $E_{n_{i}}=n_{i}\\hbar\\omega$ with $n_{i}\\in\\{0,1,2,\\ldots\\}$. For $N=3$ oscillators and fixed total energy $E=2\\hbar\\omega$, the total energy constraint is\n$$\n\\sum_{i=1}^{3}E_{n_{i}}=\\hbar\\omega\\sum_{i=1}^{3}n_{i}=2\\hbar\\omega,\n$$\nwhich implies\n$$\n\\sum_{i=1}^{3}n_{i}=2.\n$$\nDefining $q\\equiv E/(\\hbar\\omega)=2$, the microstates correspond to all ordered triples $(n_{1},n_{2},n_{3})$ of nonnegative integers summing to $q$. Because the oscillators are distinguishable, the number of such microstates is the number of weak compositions of $q$ into $N$ parts, given by the stars-and-bars formula\n$$\n\\Omega=\\binom{q+N-1}{q}.\n$$\nSubstituting $q=2$ and $N=3$ gives\n$$\n\\Omega=\\binom{2+3-1}{2}=\\binom{4}{2}=6.\n$$\nThis can be verified by explicit enumeration: $(2,0,0),(0,2,0),(0,0,2),(1,1,0),(1,0,1),(0,1,1)$.",
            "answer": "$$\\boxed{6}$$"
        },
        {
            "introduction": "Statistical mechanics often relies on the ergodic hypothesis, which assumes an isolated system will explore all accessible microstates on its constant-energy surface over time. This exercise challenges you to explore the limits of this assumption using a thought experiment based on a molecular dynamics simulation . By analyzing why the equipartition of energy fails in a purely harmonic system, you will gain a deeper understanding of the dynamical conditions, such as anharmonicity, that are necessary for a system to reach thermal equilibrium.",
            "id": "2465299",
            "problem": "A crystal is modeled as a harmonic solid with a potential energy that is purely quadratic in the displacements about equilibrium. Consider running a classical molecular dynamics (MD) simulation in the microcanonical (number of particles, volume, energy) (NVE) ensemble, i.e., with fixed $N$, $V$, and $E$, starting from a set of initial conditions that assign different amounts of energy to different vibrational normal modes. The total energy $E$ is chosen to be very small above the minimum so that the motion remains in the strictly harmonic regime. Over very long simulation times, you observe that the time-averaged kinetic energies associated with different normal modes remain unequal and reflect the initial distribution rather than becoming equal across modes.\n\nWhich statement best explains, from first principles, why the equipartition theorem does not manifest in this NVE simulation at very low energy?\n\nA. In a purely harmonic solid, the Hamiltonian separates into a sum of independent quadratic normal modes whose individual energies are constants of motion; at very low $E$ the absence of anharmonic coupling renders the dynamics integrable and non-ergodic, so energy cannot redistribute among modes and equipartition fails to emerge.\n\nB. At very low energy, quantum zero-point effects freeze out high-frequency vibrations, so classical equipartition cannot hold in NVE.\n\nC. In the NVE ensemble the kinetic energy $K$ is exactly constant in time, which prevents exchanges of energy among modes and thus precludes equipartition.\n\nD. The microcanonical probability measure on the constant-energy hypersurface assigns zero probability to states with unequal modal energies, so the system cannot reach equipartition starting from unequal initial conditions.\n\nE. Because no thermostat is present in NVE, equipartition cannot occur; a thermostat is strictly necessary for energy to flow among degrees of freedom.",
            "solution": "The problem statement is critically reviewed for validity before a solution is attempted.\n\n**Step 1: Extract Givens**\n- **System Model**: A crystal is modeled as a harmonic solid.\n- **Potential Energy**: The potential energy is purely quadratic in the displacements about equilibrium.\n- **Simulation**: A classical molecular dynamics (MD) simulation is performed.\n- **Ensemble**: The simulation is in the microcanonical ($NVE$) ensemble, meaning the number of particles ($N$), volume ($V$), and total energy ($E$) are fixed.\n- **Initial Conditions**: The simulation starts with different amounts of energy assigned to different vibrational normal modes.\n- **Energy Regime**: The total energy $E$ is very small, ensuring the system's motion remains within the strictly harmonic approximation.\n- **Observation**: Over very long simulation times, the time-averaged kinetic energies of the different normal modes do not equalize. Instead, they remain unequal and reflect their initial values.\n- **Question**: To provide a first-principles explanation for why the equipartition theorem is not observed in this simulation.\n\n**Step 2: Validate Using Extracted Givens**\n- **Scientific Grounding**: The problem describes a classical harmonic solid, a fundamental model in physics. The concepts of normal modes, the microcanonical ensemble, and the equipartition theorem are cornerstones of classical and statistical mechanics. The observed failure of equipartition in a purely harmonic (integrable) system is a well-established result in the study of ergodicity. The problem is scientifically sound.\n- **Well-Posedness**: The problem provides a completely defined theoretical system (classical harmonic solid), a specific simulation context ($NVE$ MD), clear initial conditions, a precise observation, and a direct question for a physical explanation. It is a well-posed problem.\n- **Objectivity**: The language is technical, precise, and free of subjective or ambiguous terminology.\n- **Completeness and Consistency**: The provided information is sufficient and self-consistent. The observation (lack of energy redistribution) is the phenomenon to be explained, not a contradiction. The premise of a \"purely quadratic\" potential is the key constraint that dictates the dynamics.\n\n**Step 3: Verdict and Action**\nThe problem statement is valid. It presents a standard, albeit subtle, question regarding the foundations of statistical mechanics. The derivation of the solution can now proceed.\n\n**Principle-Based Derivation**\nThe Hamiltonian for a solid, in terms of atomic displacements from equilibrium positions $\\mathbf{q}$ and conjugate momenta $\\mathbf{p}$, is $H = K(\\mathbf{p}) + U(\\mathbf{q})$. The problem states the potential energy $U(\\mathbf{q})$ is a purely quadratic function of the displacements. This is the definition of a harmonic system.\n\nFor any system with a quadratic potential energy, it is possible to perform a linear canonical transformation from the atomic coordinates $(\\mathbf{q}, \\mathbf{p})$ to a new set of coordinates and momenta known as normal modes, $(Q_k, P_k)$. In terms of these normal modes, the Hamiltonian for the harmonic solid separates into a sum of independent terms, one for each mode:\n$$H = \\sum_{k=1}^{3N-6} H_k(Q_k, P_k) = \\sum_{k=1}^{3N-6} \\left( \\frac{P_k^2}{2\\mu_k} + \\frac{1}{2}\\mu_k \\omega_k^2 Q_k^2 \\right)$$\nHere, $k$ indexes the normal modes (excluding translations and rotations), $\\omega_k$ is the frequency of the $k$-th mode, and $\\mu_k$ is its reduced mass. Each term $H_k$ is the Hamiltonian of an independent harmonic oscillator.\n\nThe crucial consequence of this separability is that the energy of each individual normal mode, $E_k = H_k$, is a constant of motion. This can be shown using Hamilton's equations. The time derivative of $H_k$ is:\n$$\\frac{dH_k}{dt} = \\frac{\\partial H_k}{\\partial Q_k}\\dot{Q}_k + \\frac{\\partial H_k}{\\partial P_k}\\dot{P}_k$$\nFrom Hamilton's equations for the total Hamiltonian $H$: $\\dot{Q}_k = \\partial H / \\partial P_k$ and $\\dot{P}_k = -\\partial H / \\partial Q_k$. Since $H$ is a sum of $H_j$ and each $H_j$ only depends on $(Q_j, P_j)$, we have $\\partial H / \\partial P_k = \\partial H_k / \\partial P_k$ and $\\partial H / \\partial Q_k = \\partial H_k / \\partial Q_k$. Substituting these into the time derivative gives:\n$$\\frac{dH_k}{dt} = \\frac{\\partial H_k}{\\partial Q_k}\\left(\\frac{\\partial H_k}{\\partial P_k}\\right) + \\frac{\\partial H_k}{\\partial P_k}\\left(-\\frac{\\partial H_k}{\\partial Q_k}\\right) = 0$$\nThus, the energy $E_k$ of each normal mode is individually conserved.\n\nThe equipartition theorem is a result of statistical mechanics, which applies to systems in thermal equilibrium. A fundamental precondition for a system to reach thermal equilibrium from an arbitrary initial state is that it must be ergodic. Ergodicity implies that a system's trajectory in phase space, over a long time, explores the entire constant-energy-hypersurface defined by $E = \\text{const}$.\n\nIn our purely harmonic system, the dynamics are constrained not only by the conservation of total energy, $E = \\sum_k E_k$, but also by the conservation of each individual modal energy, $E_k = \\text{const}$ for all $k$. This means a trajectory is confined to a much smaller subspace (a torus in phase space) defined by the initial set of modal energies $\\{E_k\\}$. The system cannot explore other parts of the constant-$E$ hypersurface that have a different partitioning of energy among the modes. Such a system is called **integrable** and is fundamentally **non-ergodic**.\n\nSince energy cannot be exchanged between the normal modes, an initial non-equilibrium distribution of energy will persist indefinitely. The time-averaged kinetic energy of each mode, $\\langle K_k \\rangle_t$, will simply be half of its fixed total energy, $\\langle K_k \\rangle_t = \\frac{1}{2} E_k$. If the initial $E_k$ values are unequal, the time-averaged kinetic energies will also remain unequal. The system never reaches the microcanonical equilibrium state, and consequently, the equipartition of energy does not occur. The physical mechanism for energy exchange in real solids—anharmonic terms in the potential—is explicitly absent in this idealized model.\n\n**Option-by-Option Analysis**\n\n**A. In a purely harmonic solid, the Hamiltonian separates into a sum of independent quadratic normal modes whose individual energies are constants of motion; at very low $E$ the absence of anharmonic coupling renders the dynamics integrable and non-ergodic, so energy cannot redistribute among modes and equipartition fails to emerge.**\nThis statement is a complete and accurate summary of the derivation above. It correctly identifies the separability of the Hamiltonian, the conservation of individual modal energies, the resulting integrability and non-ergodicity of the dynamics, and the consequent failure of energy redistribution, which is the reason for the breakdown of equipartition. The mention of \"very low $E$\" is consistent with the problem statement, as it ensures that any latent anharmonicity present in a real system is not accessed, thus keeping the dynamics purely harmonic.\n**Verdict: Correct.**\n\n**B. At very low energy, quantum zero-point effects freeze out high-frequency vibrations, so classical equipartition cannot hold in NVE.**\nThis explanation invokes quantum mechanics. The problem explicitly specifies a **classical molecular dynamics (MD)** simulation, which obeys classical mechanics. Quantum effects such as zero-point energy and energy quantization are not part of this model. The observed failure of equipartition has a purely classical explanation related to the dynamics of the model itself. While quantum freeze-out is a real phenomenon that causes deviations from classical equipartition in real materials at low temperatures, it is not the explanation for the behavior seen in this specified classical simulation.\n**Verdict: Incorrect.**\n\n**C. In the NVE ensemble the kinetic energy $K$ is exactly constant in time, which prevents exchanges of energy among modes and thus precludes equipartition.**\nThis statement is factually incorrect. In the microcanonical ($NVE$) ensemble, the *total* energy $E = K + U$ is conserved, not the kinetic energy $K$ or the potential energy $U$ individually. Energy is continuously exchanged between kinetic and potential forms as the particles oscillate. The total kinetic energy $K(t)$ is\na fluctuating quantity.\n**Verdict: Incorrect.**\n\n**D. The microcanonical probability measure on the constant-energy hypersurface assigns zero probability to states with unequal modal energies, so the system cannot reach equipartition starting from unequal initial conditions.**\nThis misrepresents the microcanonical ensemble. The fundamental postulate of this ensemble is that *all accessible microstates* on the constant-energy hypersurface are equally probable. A state with unequal energies in modes is a valid point on this surface. The issue is not that such states have zero probability in the ensemble measure, but that the system's **dynamics** are non-ergodic and cannot access the vast majority of the states on the surface. The trajectory is trapped. The explanation lies in the dynamics, not in an incorrectly stated property of the statistical measure.\n**Verdict: Incorrect.**\n\n**E. Because no thermostat is present in NVE, equipartition cannot occur; a thermostat is strictly necessary for energy to flow among degrees of freedom.**\nThis is a misconception. A thermostat is an algorithm in a simulation to mimic a heat bath (e.g., for an $NVT$ simulation). An isolated ($NVE$) system can and will achieve internal thermal equilibrium and equipartition on its own, provided it is ergodic. The mechanism for internal energy flow is the coupling between degrees of freedom (i.e., anharmonicity in the potential), which leads to chaotic dynamics. A thermostat is not a physically necessary condition for equipartition to arise from internal dynamics.\n**Verdict: Incorrect.**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "Moving from theory to practice, implementing the microcanonical ensemble computationally is done via $NVE$ (constant Number, Volume, and Energy) molecular dynamics simulations. A crucial challenge in such simulations is that while exact physical laws conserve total energy perfectly, the numerical algorithms used to integrate the equations of motion introduce small errors. This hands-on coding problem  allows you to investigate this numerical energy 'drift' and see firsthand how the choice of the integration timestep, $\\Delta t$, is a critical parameter for ensuring a physically meaningful and stable simulation.",
            "id": "2465352",
            "problem": "Consider a microcanonical (Number-Volume-Energy) ensemble (NVE) model system in classical mechanics: a diatomic molecule in one spatial dimension composed of two ($2$) point particles of equal mass interacting via a Morse potential. Let the positions be $x_1(t)$ and $x_2(t)$, the velocities be $v_1(t)$ and $v_2(t)$, and the masses be $m_1=m_2=m$. The interparticle separation is $r(t)=\\lvert x_1(t)-x_2(t)\\rvert$. The potential energy is given by\n$$\nU(r)=D_e\\left(1-\\exp\\!\\left(-a\\left[r-r_e\\right]\\right)\\right)^2,\n$$\nwith parameters $D_e>0$, $a>0$, and $r_e>0$. The total energy is\n$$\nE(t)=\\frac{1}{2}m v_1(t)^2+\\frac{1}{2}m v_2(t)^2+U(r(t)).\n$$\nThe equations of motion are Newton’s equations with forces derived from $U(r)$ so that the net force is central and equal and opposite on the two particles. Use the following dimensionless reduced units: $m=1$, $D_e=1$, $a=1$, and $r_e=1$. Use the initial conditions $x_1(0)=0$, $x_2(0)=1.2$, $v_1(0)=0$, and $v_2(0)=0$. Evolve the system for a total physical time $T_{\\mathrm{end}}=500$ using a fixed time increment $\\Delta t$.\n\nFor each simulation, define the relative final energy drift as the dimensionless quantity\n$$\n\\delta(\\Delta t)=\\frac{E(T_{\\mathrm{end}})-E(0)}{E(0)}.\n$$\nReport $\\delta(\\Delta t)$ as a decimal (no percentage sign and no physical unit, since the quantity is dimensionless).\n\nTest suite:\n- Use the following four ($4$) fixed time increments in this exact order: $\\Delta t\\in\\{0.90,0.50,0.20,0.05\\}$.\n- For each $\\Delta t$, integrate from $t=0$ to $t=T_{\\mathrm{end}}$ using the specified fixed time increment.\n\nYour program should produce a single line of output containing the four ($4$) results $\\delta(0.90)$, $\\delta(0.50)$, $\\delta(0.20)$, and $\\delta(0.05)$ as a comma-separated list enclosed in square brackets, in the same order as the test suite (for example, $[\\delta(0.90),\\delta(0.50),\\delta(0.20),\\delta(0.05)]$). Each reported value must be a single floating-point number.",
            "solution": "The microcanonical (Number-Volume-Energy) ensemble (NVE) prescribes dynamics at fixed number of particles, fixed volume, and fixed total energy, which for classical point particles is realized by solving Newton’s equations for an isolated system. For two ($2$) particles in one dimension interacting via a central potential $U(r)$ with $r=\\lvert x_1-x_2\\rvert$, the forces are equal in magnitude and opposite in direction along the line joining the particles. The total energy,\n$$\nE(t)=\\frac{1}{2}m v_1^2+\\frac{1}{2}m v_2^2+U(r),\n$$\nshould be conserved by the exact continuous dynamics. Numerical time discretization introduces errors that generally depend on the time step $\\Delta t$, and the goal is to quantify the relative final energy drift\n$$\n\\delta(\\Delta t)=\\frac{E(T_{\\mathrm{end}})-E(0)}{E(0)}\n$$\nafter integrating over a fixed physical time $T_{\\mathrm{end}}$.\n\nSystem specification in reduced units sets $m=1$, $D_e=1$, $a=1$, and $r_e=1$. The Morse potential is\n$$\nU(r)=D_e\\left(1-\\exp\\!\\left(-a\\left[r-r_e\\right]\\right)\\right)^2,\n$$\nand its radial derivative with respect to $r$ is obtained by the chain rule. Let $y=\\exp\\!\\left(-a\\left[r-r_e\\right]\\right)$. Then\n$$\nU(r)=D_e(1-y)^2,\\quad \\frac{dy}{dr}=-a\\,y,\n$$\nso\n$$\n\\frac{dU}{dr}=2D_e(1-y)\\left(-\\frac{dy}{dr}\\right)=2D_e(1-y)\\,a\\,y.\n$$\nThe scalar radial force is $F_r=-\\frac{dU}{dr}$, and in one dimension the force on particle $1$ is\n$$\nF_1=F_r\\,\\frac{x_1-x_2}{r}=-\\frac{dU}{dr}\\,\\frac{x_1-x_2}{\\lvert x_1-x_2\\rvert},\n$$\nwith $F_2=-F_1$ by Newton’s third law. With $m=1$, the accelerations are $a_1=F_1$ and $a_2=F_2$.\n\nTo integrate the equations of motion over a fixed physical time $T_{\\mathrm{end}}$ at fixed time step $\\Delta t$, a time-reversible, symplectic discretization that is consistent with the NVE setting is the velocity-Verlet scheme. Given positions $x_i^n$, velocities $v_i^n$, and accelerations $a_i^n$ at time $t_n$, one time step of size $\\Delta t$ updates as\n$$\nx_i^{n+1}=x_i^{n}+v_i^{n}\\,\\Delta t+\\frac{1}{2}a_i^{n}\\,\\Delta t^2,\n$$\nthen compute new accelerations $a_i^{n+1}$ from the updated positions, and update velocities by\n$$\nv_i^{n+1}=v_i^{n}+\\frac{1}{2}\\left(a_i^{n}+a_i^{n+1}\\right)\\Delta t.\n$$\nThe initial conditions are $x_1(0)=0$, $x_2(0)=1.2$, $v_1(0)=0$, and $v_2(0)=0$. The initial energy is\n$$\nE(0)=\\frac{1}{2}m v_1(0)^2+\\frac{1}{2}m v_2(0)^2+U\\!\\left(\\lvert x_1(0)-x_2(0)\\rvert\\right)=U(1.2),\n$$\nwhich is strictly positive since $U(r)\\ge 0$ with a minimum at $r=r_e=1$. The simulation proceeds for $N$ steps where $N$ is the nearest integer to $T_{\\mathrm{end}}/\\Delta t$, namely\n$$\nN=\\operatorname{round}\\!\\left(\\frac{T_{\\mathrm{end}}}{\\Delta t}\\right),\n$$\nso that the elapsed time is approximately $T_{\\mathrm{end}}$. At the end of the trajectory, compute $E(T_{\\mathrm{end}})$ from the final positions and velocities, and then the relative drift $\\delta(\\Delta t)$.\n\nThe test suite specifies four ($4$) different $\\Delta t$ values: $\\Delta t\\in\\{0.90,0.50,0.20,0.05\\}$. For the Morse potential near its minimum, the small-amplitude angular frequency of the relative coordinate is $\\omega=\\sqrt{\\frac{1}{\\mu}\\,\\left.\\frac{d^2U}{dr^2}\\right|_{r=r_e}}$, where the reduced mass is $\\mu=\\frac{m}{2}$ for two equal masses. With $m=1$, $D_e=1$, $a=1$, and $r_e=1$, one finds $\\left.\\frac{d^2U}{dr^2}\\right|_{r=r_e}=2D_e a^2=2$, hence $\\omega=\\sqrt{\\frac{2}{1/2}}=2$. The Verlet stability bound for a harmonic oscillator is $\\Delta t<\\frac{2}{\\omega}=1$, so all specified $\\Delta t$ values are within the stable regime but will exhibit differing energy errors. As $\\Delta t$ decreases, the integrator better approximates the continuous dynamics, so $\\lvert\\delta(\\Delta t)\\rvert$ is expected to decrease.\n\nAlgorithmic steps implemented in the program:\n- Define $U(r)$ and its derivative $\\frac{dU}{dr}$ using the expressions above with the specified parameters.\n- Compute forces $F_1$ and $F_2$ from $\\frac{dU}{dr}$ using $F_1=-\\frac{dU}{dr}\\,\\frac{x_1-x_2}{\\lvert x_1-x_2\\rvert}$ and $F_2=-F_1$.\n- Initialize $x_1(0)$, $x_2(0)$, $v_1(0)$, $v_2(0)$, compute $E(0)$, and integrate for $N=\\operatorname{round}(T_{\\mathrm{end}}/\\Delta t)$ steps using velocity-Verlet.\n- Compute $E(T_{\\mathrm{end}})$ and the relative drift $\\delta(\\Delta t)$.\n- Repeat for each $\\Delta t$ in the test suite and output $[\\delta(0.90),\\delta(0.50),\\delta(0.20),\\delta(0.05)]$ on a single line.\n\nThis procedure directly follows from Newton’s second law, the definition of the Morse potential and its force, and the definition of the total energy in classical mechanics, thereby quantifying the dependence of the energy drift on the time step in an NVE simulation.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef morse_potential(r, De=1.0, a=1.0, re=1.0):\n    # U(r) = De * (1 - exp(-a*(r - re)))^2\n    y = np.exp(-a * (r - re))\n    return De * (1.0 - y) ** 2\n\ndef dU_dr_morse(r, De=1.0, a=1.0, re=1.0):\n    # dU/dr = 2 * De * a * y * (1 - y), where y = exp(-a*(r - re))\n    y = np.exp(-a * (r - re))\n    return 2.0 * De * a * y * (1.0 - y)\n\ndef forces_1d_morse(x1, x2, De=1.0, a=1.0, re=1.0):\n    # Compute central forces in 1D for two particles interacting via Morse potential.\n    dx = x1 - x2\n    r = abs(dx)\n    if r == 0.0:\n        # Degenerate case; return zero to avoid division by zero (will not occur with given ICs).\n        return 0.0, 0.0\n    dUdr = dU_dr_morse(r, De=De, a=a, re=re)\n    # Radial force magnitude: F_r = - dU/dr\n    Fr = -dUdr\n    # Direction for particle 1 along the line connecting particles\n    s = dx / r  # sign(+/-1)\n    F1 = Fr * s\n    F2 = -F1\n    return F1, F2\n\ndef total_energy(x1, x2, v1, v2, m=1.0, De=1.0, a=1.0, re=1.0):\n    r = abs(x1 - x2)\n    U = morse_potential(r, De=De, a=a, re=re)\n    K = 0.5 * m * v1 * v1 + 0.5 * m * v2 * v2\n    return K + U\n\ndef energy_drift_for_dt(dt, Tend=500.0):\n    # Parameters in reduced units\n    m = 1.0\n    De = 1.0\n    a = 1.0\n    re = 1.0\n\n    # Initial conditions\n    x1 = 0.0\n    x2 = 1.2\n    v1 = 0.0\n    v2 = 0.0\n\n    # Initial accelerations from forces\n    F1, F2 = forces_1d_morse(x1, x2, De=De, a=a, re=re)\n    a1 = F1 / m\n    a2 = F2 / m\n\n    E0 = total_energy(x1, x2, v1, v2, m=m, De=De, a=a, re=re)\n\n    steps = int(round(Tend / dt))\n    dt2_half = 0.5 * dt * dt\n\n    for _ in range(steps):\n        # Position update\n        x1 += v1 * dt + a1 * dt2_half\n        x2 += v2 * dt + a2 * dt2_half\n\n        # New accelerations from updated positions\n        F1_new, F2_new = forces_1d_morse(x1, x2, De=De, a=a, re=re)\n        a1_new = F1_new / m\n        a2_new = F2_new / m\n\n        # Velocity update\n        v1 += 0.5 * (a1 + a1_new) * dt\n        v2 += 0.5 * (a2 + a2_new) * dt\n\n        # Prepare for next step\n        a1, a2 = a1_new, a2_new\n\n    E_end = total_energy(x1, x2, v1, v2, m=m, De=De, a=a, re=re)\n    # Relative drift (dimensionless)\n    drift = (E_end - E0) / abs(E0) if E0 != 0.0 else 0.0\n    return drift\n\ndef solve():\n    # Define the test cases from the problem statement (fixed order).\n    test_cases = [0.90, 0.50, 0.20, 0.05]\n\n    results = []\n    for dt in test_cases:\n        drift = energy_drift_for_dt(dt, Tend=500.0)\n        results.append(drift)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}