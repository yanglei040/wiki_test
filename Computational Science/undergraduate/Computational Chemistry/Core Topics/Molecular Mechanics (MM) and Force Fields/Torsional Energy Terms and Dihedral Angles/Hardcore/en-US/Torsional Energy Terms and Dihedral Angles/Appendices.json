{
    "hands_on_practices": [
        {
            "introduction": "Before delving into complex calculations, it is crucial to build an intuition for why torsional energy terms have their specific mathematical form. The periodicity $n$ and phase $\\delta$ of a torsional potential are not arbitrary; they are directly linked to the underlying chemical symmetry of the rotating molecular fragments. This first practice challenges you to apply these first principles to propose a reasonable set of torsional parameters for a molecule, using analogies to well-understood systems to guide your reasoning. ",
            "id": "2466246",
            "problem": "In molecular mechanics force fields, the torsional (dihedral) energy about a rotatable bond is commonly represented as a truncated Fourier series of the form\n$$\nV(\\phi) \\;=\\; \\sum_{n} k_n \\,\\bigl[1 + \\cos(n\\phi - \\delta_n)\\bigr],\n$$\nwhere $\\phi$ is the dihedral angle, $n$ is the periodicity, $k_n$ is a nonnegative amplitude, and $\\delta_n$ is a phase. Consider the fictional molecule “azabutane,” $\\mathrm{CH_3-CH_2-NH-CH_3}$, which has three distinct rotatable bonds centered on $\\mathrm{C}(sp^3)-\\mathrm{C}(sp^3)$ and two symmetry-equivalent $\\mathrm{C}(sp^3)-\\mathrm{N}(sp^3)$ bonds. Using only symmetry and chemical bonding arguments from first principles, and by analogy to $n$-butane (for $\\mathrm{C}(sp^3)-\\mathrm{C}(sp^3)$) and to the amide torsion of $N$-methylacetamide (for the qualitative contrast with a partially double $\\mathrm{C-N}$ bond), choose the minimal yet complete set of torsional parameters that correctly captures the positions of the torsional minima for azabutane. Assume that each central bond can be described by one dominant Fourier term if symmetry permits, and that staggered conformations about $sp^3-sp^3$ single bonds are energy minima.\n\nWhich option is the most appropriate parameterization for azabutane?\n\nA. For $\\mathrm{C-C}$: only an $n=3$ term with $\\delta=0$ and $k_3^{\\mathrm{CC}}>0$; for each $\\mathrm{C-N}$: only an $n=3$ term with $\\delta=0$ and $k_3^{\\mathrm{CN}}>0$; all other $k_n=0$.\n\nB. For $\\mathrm{C-C}$: only an $n=3$ term with $\\delta=0$ and $k_3^{\\mathrm{CC}}>0$; for each $\\mathrm{C-N}$: only an $n=2$ term with $\\delta=\\pi$ and $k_2^{\\mathrm{CN}}>0$; all other $k_n=0$.\n\nC. For $\\mathrm{C-C}$: only an $n=2$ term with $\\delta=0$ and $k_2^{\\mathrm{CC}}>0$; for each $\\mathrm{C-N}$: only an $n=3$ term with $\\delta=0$ and $k_3^{\\mathrm{CN}}>0$; all other $k_n=0$.\n\nD. For $\\mathrm{C-C}$: only an $n=3$ term with $\\delta=\\pi$ and $k_3^{\\mathrm{CC}}>0$; for each $\\mathrm{C-N}$: only an $n=3$ term with $\\delta=\\pi$ and $k_3^{\\mathrm{CN}}>0$; all other $k_n=0$.\n\nE. For both $\\mathrm{C-C}$ and each $\\mathrm{C-N}$: only an $n=1$ term with $\\delta=0$ and $k_1>0$; all other $k_n=0$.",
            "solution": "The validity of the problem statement must first be established.\n\n**Step 1: Extract Givens**\n- The torsional energy is described by the functional form: $$V(\\phi) \\;=\\; \\sum_{n} k_n \\,\\bigl[1 + \\cos(n\\phi - \\delta_n)\\bigr]$$\n- Variables are defined as: $\\phi$ (dihedral angle), $n$ (periodicity), $k_n$ (nonnegative amplitude), and $\\delta_n$ (phase).\n- The molecule is \"azabutane,\" with the structure $\\mathrm{CH_3-CH_2-NH-CH_3}$.\n- The rotatable bonds to be parameterized are one $\\mathrm{C}(sp^3)-\\mathrm{C}(sp^3)$ bond and two \"symmetry-equivalent\" $\\mathrm{C}(sp^3)-\\mathrm{N}(sp^3)$ bonds.\n- The task is to choose the minimal yet complete set of torsional parameters.\n- Guiding principles and assumptions are:\n    1. Use symmetry and chemical bonding arguments.\n    2. Use $n$-butane as an analogy for the $\\mathrm{C}(sp^3)-\\mathrm{C}(sp^3)$ bond.\n    3. Use $N$-methylacetamide as a *contrast* for the $\\mathrm{C-N}$ bond.\n    4. Assume each central bond can be described by one dominant Fourier term.\n    5. Assume staggered conformations about $sp^3-sp^3$ single bonds are energy minima.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded in the principles of computational chemistry and molecular mechanics. The provided functional form for torsional potential is standard. The molecule is chemically reasonable. The use of analogies is a valid pedagogical approach. The assumptions provide clear constraints for solving the problem.\n\nOne statement requires careful interpretation: \"two symmetry-equivalent $\\mathrm{C}(sp^3)-\\mathrm{N}(sp^3)$ bonds\". In the molecule $\\mathrm{CH_3-CH_2-NH-CH_3}$ (point group $C_1$ in a general conformation), the two $\\mathrm{C-N}$ bonds (`C2-N` and `N-C4` if numbered `C1-C2-N-C4`) are not strictly equivalent by symmetry operations. However, in the context of creating a generalizable force field, it is standard practice to assign the same parameter type to chemically similar bonds, such as all aliphatic $\\mathrm{C}(sp^3)-\\mathrm{N}(sp^3)$ single bonds. This instruction is therefore interpreted as a directive for parameterization, not a statement of rigorous molecular symmetry. With this interpretation, the problem is well-posed and self-consistent. It does not violate any critical validation criteria.\n\n**Step 3: Verdict and Action**\nThe problem is **valid**. A solution will be derived.\n\n**Derivation**\n\nThe potential energy function is $V(\\phi) = k_n [1 + \\cos(n\\phi - \\delta_n)]$, with $k_n \\ge 0$. Energy minima correspond to the minimum value of this function, which occurs when $\\cos(n\\phi - \\delta_n) = -1$. This condition is $n\\phi_{min} - \\delta_n = (2m+1)\\pi$ for any integer $m$. Energy maxima (rotational barriers) occur when $\\cos(n\\phi - \\delta_n) = +1$, which implies $n\\phi_{max} - \\delta_n = 2m\\pi$. The problem states that staggered conformations are minima. Eclipsed conformations correspond to maxima.\n\n**Analysis of the $\\mathrm{C}(sp^3)-\\mathrm{C}(sp^3)$ bond:**\nThis corresponds to the rotation about the $\\mathrm{CH_3-CH_2}$ bond. The methyl group ($\\mathrm{CH_3}$) possesses local $C_{3v}$ symmetry. When rotating against the rest of the molecule, it encounters three identical energy barriers and three identical energy minima over a $360^\\circ$ (or $2\\pi$ radians) rotation. This requires the periodic term to have a periodicity of $n=3$, as the potential energy landscape must repeat every $2\\pi/3$ radians ($120^\\circ$).\nWe must now determine the phase, $\\delta_3$. Let us define the dihedral angle $\\phi=0$ to be an eclipsed conformation, which must be an energy maximum. The staggered conformations, which are the minima, will then be at $\\phi = \\pi/3, \\pi, 5\\pi/3$ ($60^\\circ, 180^\\circ, 300^\\circ$).\nLet's test the two possible phases given in the options, $\\delta=0$ and $\\delta=\\pi$.\n- If $\\delta_3=0$: Maxima occur at $3\\phi_{max} = 2m\\pi \\implies \\phi_{max} = 0, 2\\pi/3, 4\\pi/3$. These are the eclipsed positions. Minima occur at $3\\phi_{min} = (2m+1)\\pi \\implies \\phi_{min} = \\pi/3, \\pi, 5\\pi/3$. These are the staggered positions. This is consistent with first principles.\n- If $\\delta_3=\\pi$: Maxima occur at $3\\phi_{max} - \\pi = 2m\\pi \\implies \\phi_{max} = (2m+1)\\pi/3$. These are the staggered positions. Minima occur at $3\\phi_{min} - \\pi = (2m+1)\\pi \\implies \\phi_{min} = (2m+2)\\pi/3$. These are the eclipsed positions. This contradicts the fundamental principle that staggered conformations are lower in energy.\nTherefore, for the $\\mathrm{C-C}$ bond, the correct parameters for the dominant term are $n=3$ and $\\delta_3=0$. The amplitude $k_3^{\\mathrm{CC}}$ must be positive to create a barrier.\n\n**Analysis of the $\\mathrm{C}(sp^3)-\\mathrm{N}(sp^3)$ bonds:**\nThe problem instructs us to treat the two $\\mathrm{C-N}$ bonds (`CH2-NH` and `NH-CH3`) with a single set of parameters and to use $N$-methylacetamide (NMA) for contrast. In NMA, the amide $\\mathrm{C-N}$ bond has partial double-bond character, leading to a planar structure and a high rotational barrier with a dominant $n=2$ periodicity. The problem's use of \"contrast\" implies that the $\\mathrm{C}(sp^3)-\\mathrm{N}(sp^3)$ single bonds in azabutane should *not* behave this way. Thus, a dominant $n=2$ term is inappropriate.\nThese are single bonds between $sp^3$-hybridized atoms. The primary energetic consideration is the steric repulsion that favors staggered conformations over eclipsed ones.\n- For the `NH-CH3` moiety, the rotation of the methyl group is analogous to the one in the `CH3-CH2` group. It has local $3$-fold symmetry, so the dominant torsional term must have a periodicity of $n=3$.\n- For the `CH2-NH` bond, the local symmetry is lower. However, the fundamental preference for staggered conformations around an $sp^3-sp^3$ bond is a generic feature best captured by a $3$-fold potential. This term ensures three minima and three maxima in a full rotation. Given the constraint to use a single dominant term for both `C-N` bonds, and the clear requirement for $n=3$ in the `NH-CH3` case, selecting $n=3$ for the generic $\\mathrm{C}(sp^3)-\\mathrm{N}(sp^3)$ interaction is the most logical choice.\nSimilar to the $\\mathrm{C-C}$ bond analysis, the phase must be $\\delta_3=0$ to ensure that staggered positions are minima and eclipsed positions are maxima. The amplitude $k_3^{\\mathrm{CN}}$ must be positive.\n\n**Conclusion of Derivation:**\n- For the $\\mathrm{C-C}$ bond: $n=3$, $\\delta_3=0$, $k_3^{\\mathrm{CC}}>0$.\n- For the $\\mathrm{C-N}$ bonds: $n=3$, $\\delta_3=0$, $k_3^{\\mathrm{CN}}>0$.\n\n**Option-by-Option Analysis**\n\nA. **For $\\mathrm{C-C}$: only an $n=3$ term with $\\delta=0$ and $k_3^{\\mathrm{CC}}>0$; for each $\\mathrm{C-N}$: only an $n=3$ term with $\\delta=0$ and $k_3^{\\mathrm{CN}}>0$; all other $k_n=0$.**\nThis option perfectly matches our derived parameters. The periodicity $n=3$ is correct for rotations involving an $sp^3$ methyl group and is the standard for general $sp^3-sp^3$ bonds. The phase $\\delta=0$ correctly sets staggered conformations as minima and eclipsed as maxima. This is the correct description based on the problem's premises.\n**Verdict: Correct.**\n\nB. **For $\\mathrm{C-C}$: only an $n=3$ term with $\\delta=0$ and $k_3^{\\mathrm{CC}}>0$; for each $\\mathrm{C-N}$: only an $n=2$ term with $\\delta=\\pi$ and $k_2^{\\mathrm{CN}}>0$; all other $k_n=0$.**\nThe parameterization for the $\\mathrm{C-C}$ bond is correct. However, for the $\\mathrm{C-N}$ bond, it proposes $n=2$. As discussed, an $n=2$ term is characteristic of bonds with partial double bond character leading to planarity, which is explicitly contrasted with the $\\mathrm{C}(sp^3)-\\mathrm{N}(sp^3)$ single bond. This is chemically incorrect for a saturated amine.\n**Verdict: Incorrect.**\n\nC. **For $\\mathrm{C-C}$: only an $n=2$ term with $\\delta=0$ and $k_2^{\\mathrm{CC}}>0$; for each $\\mathrm{C-N}$: only an $n=3$ term with $\\delta=0$ and $k_3^{\\mathrm{CN}}>0$; all other $k_n=0$.**\nThe parameterization for the $\\mathrm{C-N}$ bond is correct. However, for the $\\mathrm{C-C}$ bond (`CH3-CH2-`), it proposes $n=2$. The rotation of a methyl group demands a $3$-fold potential ($n=3$), not a $2$-fold one.\n**Verdict: Incorrect.**\n\nD. **For $\\mathrm{C-C}$: only an $n=3$ term with $\\delta=\\pi$ and $k_3^{\\mathrm{CC}}>0$; for each $\\mathrm{C-N}$: only an $n=3$ term with $\\delta=\\pi$ and $k_3^{\\mathrm{CN}}>0$; all other $k_n=0$.**\nThis option correctly identifies the periodicity as $n=3$ for both bond types. However, it proposes a phase of $\\delta=\\pi$. As demonstrated in the derivation, a phase of $\\delta=\\pi$ for an $n=3$ term makes the eclipsed conformations energy minima and the staggered conformations energy maxima. This is a direct violation of fundamental steric principles and contradicts the problem's explicit assumption.\n**Verdict: Incorrect.**\n\nE. **For both $\\mathrm{C-C}$ and each $\\mathrm{C-N}$: only an $n=1$ term with $\\delta=0$ and $k_1>0$; all other $k_n=0$.**\nAn $n=1$ potential has only one minimum and one maximum over a $360^\\circ$ rotation. This fails to capture the $3$-fold symmetry inherent in rotating a methyl group or the general $3$-fold nature of staggered/eclipsed interactions around $sp^3-sp^3$ single bonds. While an $n=1$ term can be part of a more complex potential (e.g., to distinguish anti from gauche), it cannot be the single dominant term describing these bonds.\n**Verdict: Incorrect.**",
            "answer": "$$\\boxed{A}$$"
        },
        {
            "introduction": "Once the appropriate functional form for a torsional potential is established, the next step is to determine the numerical values of its parameters, such as the barrier height $V$. This is a key task in force field development, often accomplished by fitting the classical model to a potential energy surface calculated using more accurate quantum mechanics. This exercise provides hands-on practice in performing such a fit, using a linear least-squares method to derive torsional parameters from a set of hypothetical quantum mechanics energy data. ",
            "id": "2466268",
            "problem": "You are given three discrete dihedral potential energy scans from Quantum Mechanics (QM) for a hypothetical $H_3C\\text{-}X\\text{-}X\\text{-}CH_3$ molecule. For the $C\\text{-}X\\text{-}X\\text{-}C$ dihedral, assume the torsional contribution to the potential energy is modeled by\n$$\nE(\\phi) \\;=\\; E_0 \\;+\\; \\frac{V}{2}\\,\\Big(1 + \\cos\\big(n\\,\\phi - \\gamma\\big)\\Big),\n$$\nwhere $E(\\phi)$ is the energy in kJ mol$^{-1}$, $\\phi$ is the dihedral angle in degrees, $E_0$ is an unknown offset in kJ mol$^{-1}$, $V$ is the torsional barrier amplitude in kJ mol$^{-1}$, $n$ is an integer periodicity, and $\\gamma$ is a phase angle in degrees. Your task is to determine, for each scan, the triple $(V,n,\\gamma)$ that minimizes the sum of squared residuals between the model and the given data. The allowed periodicities are $n \\in \\{1,2,3,4,6\\}$. You must report $\\gamma$ in degrees within the interval $[0,360)$, and $V \\ge 0$. The scans provide energies that already include any constant baseline; you should not report $E_0$.\n\nAll three scans use the same set of dihedral angles\n$$\n\\phi \\in \\{\\,0^\\circ,\\,30^\\circ,\\,60^\\circ,\\,90^\\circ,\\,120^\\circ,\\,150^\\circ,\\,180^\\circ,\\,210^\\circ,\\,240^\\circ,\\,270^\\circ,\\,300^\\circ,\\,330^\\circ\\,\\}.\n$$\n\nFor each scan, the corresponding energies $E(\\phi)$ in kJ mol$^{-1}$ are:\n\n- Test case $1$:\n  $$\n  [\\,12.5,\\,6.5,\\,0.5,\\,6.5,\\,12.5,\\,6.5,\\,0.5,\\,6.5,\\,12.5,\\,6.5,\\,0.5,\\,6.5\\,].\n  $$\n- Test case $2$:\n  $$\n  [\\,3.55,\\,4.8,\\,3.55,\\,1.05,\\,-0.2,\\,1.05,\\,3.55,\\,4.8,\\,3.55,\\,1.05,\\,-0.2,\\,1.05\\,].\n  $$\n- Test case $3$:\n  $$\n  [\\,1.2,\\,1.367468,\\,1.825,\\,2.45,\\,3.075,\\,3.532532,\\,3.7,\\,3.532532,\\,3.075,\\,2.45,\\,1.825,\\,1.367468\\,].\n  $$\n\nAngle unit requirement: treat all dihedral angles $\\phi$ in degrees, and report $\\gamma$ in degrees. Energy unit requirement: treat all energies $E(\\phi)$ and the fitted amplitude $V$ in kJ mol$^{-1}$.\n\nTest Suite and Answer Specification:\n- Using the above three scans, determine the best-fit triple $(V,n,\\gamma)$ for each scan by minimizing the sum of squared residuals over the given angles.\n- Restrict $n$ to the set $\\{1,2,3,4,6\\}$, and enforce $\\gamma \\in [0,360)$ in degrees.\n- The required output for your program is a single line containing the list of the three results, where each result is a list of the form $[V,n,\\gamma]$ with $V$ and $\\gamma$ rounded to $6$ decimal places, $n$ as an integer. The final output must be formatted as one comma-separated list enclosed in square brackets, for example:\n$$\n[[V_1,n_1,\\gamma_1],[V_2,n_2,\\gamma_2],[V_3,n_3,\\gamma_3]].\n$$",
            "solution": "The problem requires finding the parameters $(V, n, \\gamma)$ for a torsional energy model that best fit three sets of quantum mechanical data. The model is given by the function:\n$$\nE(\\phi) \\;=\\; E_0 \\;+\\; \\frac{V}{2}\\,\\Big(1 + \\cos\\big(n\\,\\phi - \\gamma\\big)\\Big),\n$$\nwhere $E(\\phi)$ is the potential energy, $\\phi$ is the dihedral angle, $E_0$ is a constant energy offset, $V$ is the barrier amplitude, $n$ is the periodicity, and $\\gamma$ is the phase angle. The goal is to minimize the sum of squared residuals (SSR) between the model and the provided energy data $E_i$ at corresponding angles $\\phi_i$:\n$$\n\\text{SSR} \\;=\\; \\sum_{i=1}^{N} \\left[ E_i - E(\\phi_i) \\right]^2.\n$$\nThe parameter $n$ is restricted to the set $\\{1, 2, 3, 4, 6\\}$. This is a non-linear least squares problem. However, for a fixed value of $n$, the model can be linearized. Using the trigonometric identity for the cosine of a difference, $\\cos(A - B) = \\cos A \\cos B + \\sin A \\sin B$, we can rewrite the model equation as:\n$$\nE(\\phi) \\;=\\; E_0 \\;+\\; \\frac{V}{2} \\;+\\; \\frac{V}{2}\\cos(\\gamma)\\cos(n\\phi) \\;+\\; \\frac{V}{2}\\sin(\\gamma)\\sin(n\\phi).\n$$\nWe can define a set of linear coefficients:\n$$\nC_1 \\;=\\; E_0 + \\frac{V}{2}\n$$\n$$\nC_2 \\;=\\; \\frac{V}{2}\\cos(\\gamma)\n$$\n$$\nC_3 \\;=\\; \\frac{V}{2}\\sin(\\gamma)\n$$\nThis transforms the model into a linear form with respect to the new coefficients $(C_1, C_2, C_3)$:\n$$\nE(\\phi_i) \\;=\\; C_1 \\cdot 1 \\;+\\; C_2 \\cos(n\\phi_i) \\;+\\; C_3 \\sin(n\\phi_i).\n$$\nFor each data scan and for each allowed value of $n$, we solve a linear least squares problem to find the optimal coefficients $(C_1, C_2, C_3)$ that minimize the SSR. This can be expressed in matrix form as finding the vector $\\mathbf{c}$ that minimizes $\\|\\mathbf{A}\\mathbf{c} - \\mathbf{y}\\|^2_2$, where $\\mathbf{y}$ is the vector of observed energies $E_i$, $\\mathbf{c} = [C_1, C_2, C_3]^T$, and $\\mathbf{A}$ is the design matrix with rows $[1, \\cos(n\\phi_i), \\sin(n\\phi_i)]$. For all calculations, the angles $\\phi_i$ given in degrees must be converted to radians, as standard computational libraries' trigonometric functions operate on radians.\n\nOnce the optimal coefficients $(C_1, C_2, C_3)$ are found for a given $n$, the original physical parameters $V$ and $\\gamma$ are recovered. The amplitude $V$ is found by observing that:\n$$\nC_2^2 + C_3^2 \\;=\\; \\left(\\frac{V}{2}\\right)^2 (\\cos^2\\gamma + \\sin^2\\gamma) \\;=\\; \\left(\\frac{V}{2}\\right)^2.\n$$\nGiven the constraint $V \\ge 0$, we have:\n$$\nV \\;=\\; 2\\sqrt{C_2^2 + C_3^2}.\n$$\nThe phase angle $\\gamma$ is determined from the ratio of $C_3$ to $C_2$:\n$$\n\\frac{C_3}{C_2} \\;=\\; \\frac{(V/2)\\sin(\\gamma)}{(V/2)\\cos(\\gamma)} \\;=\\; \\tan(\\gamma).\n$$\nThe two-argument arctangent function, $\\operatorname{atan2}(C_3, C_2)$, is used to find $\\gamma$ in radians, which correctly resolves the quadrant based on the signs of $C_2$ and $C_3$. The result is then converted to degrees and normalized to the specified interval $[0, 360)$. An important note is that the energy offset $E_0$, which is not requested, can be calculated via $E_0 = C_1 - V/2 = C_1 - \\sqrt{C_2^2 + C_3^2}$.\n\nThe overall algorithm for each data scan is as follows:\n1. Initialize a minimum SSR value to a large number and a structure to hold the best-fit parameters.\n2. For each integer periodicity $n$ in the set $\\{1, 2, 3, 4, 6\\}$:\n    a. Construct the design matrix $\\mathbf{A}$ using the given angles $\\phi_i$.\n    b. Solve the linear least squares problem $\\mathbf{A}\\mathbf{c} \\approx \\mathbf{y}$ to obtain the coefficients $\\mathbf{c} = [C_1, C_2, C_3]^T$ and the corresponding sum of squared residuals.\n    c. Compare the current SSR with the stored minimum SSR. If the current SSR is lower, update the minimum SSR and store the current $n$ and the parameters $V$ and $\\gamma$ (calculated from $C_2$ and $C_3$) as the best-fit parameters so far.\n3. After iterating through all possible values of $n$, the stored parameters $(V, n, \\gamma)$ represent the best fit for the given data scan.\n\nThis procedure is repeated for all three test cases provided in the problem. This approach guarantees finding the global minimum of the SSR over the allowed parameter space because we exhaustively test each discrete value of $n$, and for each $n$, the linear least squares problem has a unique analytical solution.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the torsional parameters V, n, and gamma for three energy scans\n    by minimizing the sum of squared residuals.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    test_cases = [\n        # Scan 1\n        np.array([12.5, 6.5, 0.5, 6.5, 12.5, 6.5, 0.5, 6.5, 12.5, 6.5, 0.5, 6.5]),\n        # Scan 2\n        np.array([3.55, 4.8, 3.55, 1.05, -0.2, 1.05, 3.55, 4.8, 3.55, 1.05, -0.2, 1.05]),\n        # Scan 3\n        np.array([1.2, 1.367468, 1.825, 2.45, 3.075, 3.532532, 3.7, 3.532532, 3.075, 2.45, 1.825, 1.367468]),\n    ]\n\n    # Dihedral angles in degrees\n    phi_deg = np.arange(0, 360, 30)\n    \n    # Convert angles to radians for numpy trigonometric functions\n    phi_rad = np.deg2rad(phi_deg)\n\n    # Allowed periodicities\n    n_values = [1, 2, 3, 4, 6]\n\n    final_results = []\n\n    for energy_scan in test_cases:\n        best_fit = {\n            'V': None, \n            'n': None, \n            'gamma': None, \n            'ssr': np.inf\n        }\n\n        for n in n_values:\n            # Construct the design matrix A for the linear least squares problem\n            # E = C1 * 1 + C2 * cos(n*phi) + C3 * sin(n*phi)\n            A = np.zeros((len(phi_rad), 3))\n            A[:, 0] = 1.0\n            A[:, 1] = np.cos(n * phi_rad)\n            A[:, 2] = np.sin(n * phi_rad)\n\n            # Solve the linear least squares problem Ac = E\n            # lstsq returns coefficients, sum of squared residuals, rank, and singular values\n            try:\n                coeffs, residuals, _, _ = np.linalg.lstsq(A, energy_scan, rcond=None)\n                \n                # The 'residuals' is an array. If it's empty, the system was not overdetermined\n                # or was rank deficient. In our case (12 points, 3 params), it should have one element.\n                # If there is a perfect fit, residuals array might be empty depending on numpy version.\n                # It's safer to calculate it if it is empty.\n                if residuals.size == 0:\n                     ssr = np.sum((energy_scan - A @ coeffs)**2)\n                else:\n                     ssr = residuals[0]\n\n            except np.linalg.LinAlgError:\n                # In case of a singular matrix, skip this n\n                continue\n\n            # Check if this fit is the best one so far\n            if ssr  best_fit['ssr']:\n                C1, C2, C3 = coeffs[0], coeffs[1], coeffs[2]\n\n                # Recover V and gamma from C2 and C3\n                # V = 2 * sqrt(C2^2 + C3^2)\n                V = 2.0 * np.sqrt(C2**2 + C3**2)\n                \n                # gamma = atan2(C3, C2)\n                gamma_rad = np.arctan2(C3, C2)\n                gamma_deg = np.degrees(gamma_rad)\n                \n                # Normalize gamma to be in [0, 360)\n                if gamma_deg  0:\n                    gamma_deg += 360.0\n\n                best_fit['V'] = V\n                best_fit['n'] = n\n                best_fit['gamma'] = gamma_deg\n                best_fit['ssr'] = ssr\n\n        final_results.append([best_fit['V'], best_fit['n'], best_fit['gamma']])\n\n    # Format the output string as per the specification\n    result_strings = []\n    for v, n, g in final_results:\n        result_strings.append(f\"[{v:.6f},{n},{g:.6f}]\")\n    \n    # Final print statement in the exact required format.\n    print(f\"[{','.join(result_strings)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "With an understanding of how torsional parameters are chosen and quantified, we now turn to their impact in large-scale molecular dynamics (MD) simulations. The accuracy of these parameters is critical, as errors can lead to non-physical behavior, such as a molecule becoming kinetically trapped in an incorrect conformation. This final practice presents a realistic diagnostic challenge, asking you to analyze MD simulation data for a protein and deduce the most likely source of error in its force field parameters. ",
            "id": "2466279",
            "problem": "A tyrosine sidechain in a solvated protein is simulated by Molecular Dynamics (MD) at temperature $300\\,\\mathrm{K}$ using a standard additive biomolecular force field. Torsional (dihedral) terms are modeled with a periodic potential $U_{\\mathrm{tors}}(\\phi)=\\sum_i k_i\\left[1+\\cos\\left(n_i\\phi-\\delta_i\\right)\\right]$, where $k_i$ is the barrier amplitude, $n_i$ is the periodicity, and $\\delta_i$ is the phase shift. For tyrosine, the two lowest-order sidechain dihedrals are defined as $\\chi_1=\\angle(\\mathrm{N}-\\mathrm{C}_\\alpha-\\mathrm{C}_\\beta-\\mathrm{C}_\\gamma)$ and $\\chi_2=\\angle(\\mathrm{C}_\\alpha-\\mathrm{C}_\\beta-\\mathrm{C}_\\gamma-\\mathrm{C}_{\\delta1})$. In the experimentally determined native structure, the sidechain adopts a rotamer characterized by $\\chi_1\\approx 180^\\circ$ and $\\chi_2\\approx 90^\\circ$.\n\nIn the simulation, the following behavior is observed over a total of $1.0\\,\\mu\\mathrm{s}$:\n- The time series and histogram of $\\chi_1$ show a single, narrow peak at $\\chi_1\\approx+60^\\circ$ with $0$ spontaneous transitions to other wells.\n- The time series and histogram of $\\chi_2$ are bimodal with peaks near $\\chi_2\\approx +90^\\circ$ and $\\chi_2\\approx -90^\\circ$, with frequent interconversions (approximately $20$ barrier crossings between the two wells).\n- A control simulation in which the three nearest sidechain neighbors are mutated to glycine (to reduce steric crowding and specific nonbonded contacts) shows the same qualitative behavior: $\\chi_1$ remains near $+60^\\circ$ with $0$ transitions, whereas $\\chi_2$ continues to interconvert between $\\pm 90^\\circ$ with similar frequency.\n\nBased on these observations and on first-principles reasoning about torsional barriers and thermal sampling at temperature $300\\,\\mathrm{K}$, which torsional parameter is most likely misparameterized in a way that traps the tyrosine in a non-native rotamer?\n\nA. $\\chi_1$ torsional parameters are incorrect (barrier height and/or phase overly stabilizes $\\chi_1\\approx+60^\\circ$ and makes other wells inaccessible).\n\nB. $\\chi_2$ torsional parameters are incorrect (they destabilize the native $\\chi_2$ orientation and indirectly trap $\\chi_1$).\n\nC. Both $\\chi_1$ and $\\chi_2$ torsional parameters are incorrect in compensating ways.\n\nD. Torsional parameters are fine; the problem lies in nonbonded parameters of the aromatic ring carbons, and not in the torsional terms.",
            "solution": "The problem statement must first be validated for scientific soundness and logical consistency.\n\n**Step 1: Extract Givens**\n- System: A tyrosine sidechain in a solvated protein.\n- Simulation Method: Molecular Dynamics (MD).\n- Temperature: $T = 300\\,\\mathrm{K}$.\n- Force Field Model: Standard additive biomolecular force field.\n- Torsional Potential: $U_{\\mathrm{tors}}(\\phi)=\\sum_i k_i\\left[1+\\cos\\left(n_i\\phi-\\delta_i\\right)\\right]$, where $k_i$ is barrier amplitude, $n_i$ is periodicity, and $\\delta_i$ is phase shift.\n- Relevant Dihedrals:\n    - $\\chi_1 = \\angle(\\mathrm{N}-\\mathrm{C}_\\alpha-\\mathrm{C}_\\beta-\\mathrm{C}_\\gamma)$\n    - $\\chi_2 = \\angle(\\mathrm{C}_\\alpha-\\mathrm{C}_\\beta-\\mathrm{C}_\\gamma-\\mathrm{C}_{\\delta1})$\n- Experimental (Native) Structure: $\\chi_1 \\approx 180^\\circ$ and $\\chi_2 \\approx 90^\\circ$.\n- Simulation Observations ($1.0\\,\\mu\\mathrm{s}$ total time):\n    1.  $\\chi_1$ dihedral: Exhibits a single, narrow population peak at $\\chi_1 \\approx +60^\\circ$. There are $0$ observed transitions to other conformational states.\n    2.  $\\chi_2$ dihedral: Exhibits a bimodal population distribution with peaks near $\\chi_2 \\approx +90^\\circ$ and $\\chi_2 \\approx -90^\\circ$. Frequent barrier crossings ($\\approx 20$) are observed.\n- Control Simulation: Three nearest neighbor sidechains are mutated to glycine. The qualitative behavior of $\\chi_1$ and $\\chi_2$ remains unchanged; $\\chi_1$ is trapped at $\\approx +60^\\circ$ and $\\chi_2$ continues to interconvert.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded. It presents a standard scenario in computational biophysics involving MD simulations, force fields, and conformational analysis of an amino acid sidechain. The potential energy function for torsions is a standard form used in many common force fields (e.g., AMBER, CHARMM). The definitions of the dihedrals are correct. The observed phenomenon—discrepancy between simulation and experiment, specifically kinetic trapping—is a well-known and critical issue in force field development and validation. The use of a control simulation with mutations is a valid and powerful method to distinguish between intrinsic parameter errors and environment-dependent artifacts. The problem is well-posed, providing sufficient data to permit a logical deduction about the most probable source of error. The language is objective and precise.\n\n**Step 3: Verdict and Action**\nThe problem statement is valid. I will proceed with the analysis.\n\n**Derivation of Solution**\nThe goal is to identify the most probable cause for the discrepancy between the simulated and experimentally determined native conformation of the tyrosine sidechain. The key observations are the dynamics of the two dihedrals, $\\chi_1$ and $\\chi_2$.\n\n1.  **Analysis of Conformational Sampling:** At a finite temperature $T$, a system in thermal equilibrium samples conformational states according to the Boltzmann distribution, $P(\\mathbf{x}) \\propto \\exp(-U(\\mathbf{x}) / k_B T)$, where $U(\\mathbf{x})$ is the potential energy. Transitions between energy minima require surmounting the intervening energy barriers. The rate of such transitions depends exponentially on the barrier height, $\\Delta E^{\\ddagger}$. At $T=300\\,\\mathrm{K}$, the thermal energy is $k_B T \\approx 0.6\\,\\mathrm{kcal/mol} \\approx 2.5\\,\\mathrm{kJ/mol}$. Barriers of a few multiples of $k_B T$ are typically crossed on timescales accessible to MD simulations.\n\n2.  **Analysis of $\\chi_1$ Behavior:** The simulation shows that $\\chi_1$ is trapped in a single, non-native state ($\\approx +60^\\circ$) for the entire $1.0\\,\\mu\\mathrm{s}$ simulation. The native state is $\\chi_1 \\approx 180^\\circ$. The complete lack of transitions indicates that the energy barrier for rotation out of the $\\chi_1 \\approx +60^\\circ$ well is prohibitively high for the given thermal energy. This implies that the potential energy surface along the $\\chi_1$ coordinate, as described by the force field, has an artificially deep minimum at $\\approx +60^\\circ$ and/or an excessively high barrier separating it from other minima, including the native $180^\\circ$ state. The intrinsic shape of this potential energy surface is primarily dictated by the torsional parameters ($k_i, n_i, \\delta_i$) for the $\\chi_1$ dihedral.\n\n3.  **Analysis of $\\chi_2$ Behavior:** In contrast, the $\\chi_2$ dihedral exhibits frequent transitions between two states, $\\approx +90^\\circ$ and $\\approx -90^\\circ$. One of these ($\\approx +90^\\circ$) corresponds to the native structure. This dynamic behavior indicates that the energy barrier for $\\chi_2$ rotation is low enough to be readily surmounted by thermal energy at $300\\,\\mathrm{K}$. This behavior is physically expected for rotation about the $\\mathrm{C}_\\beta-\\mathrm{C}_\\gamma$ bond, which has a significant double-bond character due to the aromatic ring, often modeled with a primary twofold periodicity ($n=2$). While the relative populations of the two states might not be perfectly accurate, the crucial point is that the system is not kinetically trapped with respect to $\\chi_2$. The parameters for $\\chi_2$ permit conformational sampling, which is fundamentally different from the situation for $\\chi_1$.\n\n4.  **Interpretation of the Control Simulation:** The control simulation, where neighboring residues are mutated to glycine, serves to isolate the cause of the trapping. This mutation reduces steric hindrance and eliminates specific nonbonded interactions (like hydrogen bonds or electrostatic contacts) between the tyrosine sidechain and its environment. The fact that the trapping of $\\chi_1$ persists in this simplified environment demonstrates that the cause is not an artifact of specific protein-protein interactions. Instead, the cause must be intrinsic to the force field's parameterization of the tyrosine residue itself.\n\n5.  **Conclusion:** The evidence points unequivocally to the torsional parameters for $\\chi_1$. The simulated potential energy profile for this dihedral must be incorrect, creating a deep, non-native energy minimum that kinetically traps the sidechain. The problem is not with the nonbonded parameters describing interactions with the environment (ruled out by the control) and is not with the $\\chi_2$ parameters (which allow for proper sampling dynamics).\n\n**Evaluation of Options**\n\n**A. $\\chi_1$ torsional parameters are incorrect (barrier height and/or phase overly stabilizes $\\chi_1\\approx+60^\\circ$ and makes other wells inaccessible).**\nThis option is a direct consequence of the reasoning above. The persistent trapping of $\\chi_1$ in a non-native state over a long simulation, independent of the local protein environment, is a classic symptom of incorrect intrinsic torsional parameters. An erroneously large barrier height ($k_i$) and/or an incorrect phase shift ($\\delta_i$) would create a deep, non-native minimum at $\\approx +60^\\circ$ and prevent sampling of the correct native state at $\\approx 180^\\circ$.\n**Verdict: Correct.**\n\n**B. $\\chi_2$ torsional parameters are incorrect (they destabilize the native $\\chi_2$ orientation and indirectly trap $\\chi_1$).**\nThis is not supported by the data. The simulation shows that the system samples the native $\\chi_2 \\approx +90^\\circ$ state frequently. There is no destabilization so severe as to prevent access to it. Furthermore, the claim of an \"indirect\" trapping of $\\chi_1$ by $\\chi_2$ is mechanistically unclear and less parsimonious than a direct cause. The behavior of $\\chi_2$ is that of a flexible bond, not a incorrectly parameterized one causing trapping.\n**Verdict: Incorrect.**\n\n**C. Both $\\chi_1$ and $\\chi_2$ torsional parameters are incorrect in compensating ways.**\nWhile force field errors can be complex, the evidence presents a clear and simple picture: $\\chi_1$ is trapped, and $\\chi_2$ is not. To postulate a complex scheme of compensating errors is not the most likely explanation. The primary fault lies with the parameter directly responsible for the observed trapping, which is the $\\chi_1$ torsion. This option unnecessarily complicates the diagnosis without supporting evidence.\n**Verdict: Incorrect.**\n\n**D. Torsional parameters are fine; the problem lies in nonbonded parameters of the aromatic ring carbons, and not in the torsional terms.**\nThis hypothesis is directly contradicted by the control simulation. Altering the nonbonded environment by mutating neighbors to glycine had no effect on the trapping of $\\chi_1$. This strongly indicates that the problem is not with intermolecular nonbonded interactions. While intramolecular nonbonded terms (e.g., 1-4 interactions) contribute to the rotational barrier, their effects are typically absorbed into the fitting of the explicit torsional parameters. Therefore, an incorrect rotational profile is, by definition, an error in the effective torsional term, making the parameters for that term the primary suspect.\n**Verdict: Incorrect.**",
            "answer": "$$\\boxed{A}$$"
        }
    ]
}