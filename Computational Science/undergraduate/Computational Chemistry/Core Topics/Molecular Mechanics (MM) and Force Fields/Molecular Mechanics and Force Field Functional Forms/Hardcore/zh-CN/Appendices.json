{
    "hands_on_practices": [
        {
            "introduction": "在分子力学中，最基本的能量项之一是将化学键模拟为简谐振子，即像一个弹簧。这个练习将让你应用这个简单的谐振子模型来探索一个真实世界的物理效应：同位素取代。通过计算O-H键与O-D键振动频率的比率，你将亲身体会到原子质量如何直接影响分子的振动特性，这不仅加深了对力场基本构成（键伸缩项）的理解，也将其与光谱学中的重要概念联系起来。",
            "id": "2458468",
            "problem": "一个氧-氢键和一个氧-氘键均被建模为一个孤立的双体系统，在平衡间距 $r_{e}$ 附近通过简谐势 $V(r)=\\frac{1}{2}k(r-r_{e})^{2}$ 相互作用。假设力常数 $k$ 和平衡键长 $r_{e}$ 对于这两种同位素体是相同的，并忽略所有耦合和非谐性。取同位素质量为 $m_{\\mathrm{O}}=15.994914\\,\\mathrm{u}$，$m_{\\mathrm{H}}=1.007825\\,\\mathrm{u}$ 和 $m_{\\mathrm{D}}=2.014102\\,\\mathrm{u}$，其中 $\\mathrm{u}$ 表示原子质量单位。仅使用应用于给定势的经典力学，确定基频振动频率之比 $\\nu_{\\mathrm{OH}}/\\nu_{\\mathrm{OD}}$。将最终答案表示为一个纯数（无单位），并将结果四舍五入到四位有效数字。",
            "solution": "问题陈述已经过分析，被认为是有效的。它具有科学依据，是适定且客观的。它提出了一个经典力学应用于分子振动的标准问题，这是计算化学和光谱学中的一个基本概念。所有必要的数据都已提供，且所作的假设，例如 Born-Oppenheimer 近似（同位素体具有相同的势），对于此级别的分析在物理上是标准的。我们可以继续进行求解。\n\n问题要求计算氧-氢键和氧-氘键的基频振动频率之比 $\\nu_{\\mathrm{OH}}/\\nu_{\\mathrm{OD}}$。这些键被建模为由简谐势描述的孤立双体系统。\n\n质量为 $m_1$ 和 $m_2$ 的双体系统的振动可以简化为具有约化质量 $\\mu$ 的单个物体在相同势中运动的问题。约化质量 $\\mu$ 定义为：\n$$\n\\mu = \\frac{m_1 m_2}{m_1 + m_2}\n$$\n对于 O-H 系统，约化质量 $\\mu_{\\mathrm{OH}}$ 为：\n$$\n\\mu_{\\mathrm{OH}} = \\frac{m_{\\mathrm{O}} m_{\\mathrm{H}}}{m_{\\mathrm{O}} + m_{\\mathrm{H}}}\n$$\n对于 O-D 系统，约化质量 $\\mu_{\\mathrm{OD}}$ 为：\n$$\n\\mu_{\\mathrm{OD}} = \\frac{m_{\\mathrm{O}} m_{\\mathrm{D}}}{m_{\\mathrm{O}} + m_{\\mathrm{D}}}\n$$\n系统的势能由简谐势给出：\n$$\nV(r) = \\frac{1}{2}k(r - r_e)^2\n$$\n其中 $k$ 是力常数，$r_e$ 是平衡键长。作用在等效单体上的力 $F$ 由势能相对于偏离平衡位置的位移 $x = r - r_e$ 的负梯度给出：\n$$\nF = -\\frac{dV}{dx} = -\\frac{d}{dx} \\left( \\frac{1}{2}kx^2 \\right) = -kx\n$$\n根据牛顿第二定律，$F = ma$，对于我们的等效单体系统，这变为 $F = \\mu \\ddot{x}$，其中 $\\ddot{x}$ 是加速度。\n$$\n\\mu \\ddot{x} = -kx\n$$\n整理后得到简谐运动的标准方程：\n$$\n\\ddot{x} + \\left(\\frac{k}{\\mu}\\right)x = 0\n$$\n该微分方程的通解描述了角频率为 $\\omega$ 的正弦振荡，其角频率由下式给出：\n$$\n\\omega^2 = \\frac{k}{\\mu} \\implies \\omega = \\sqrt{\\frac{k}{\\mu}}\n$$\n基频振动频率 $\\nu$ 与角频率 $\\omega$ 通过 $\\omega = 2\\pi\\nu$ 相关。因此：\n$$\n\\nu = \\frac{\\omega}{2\\pi} = \\frac{1}{2\\pi}\\sqrt{\\frac{k}{\\mu}}\n$$\n我们被要求求出比值 $\\nu_{\\mathrm{OH}} / \\nu_{\\mathrm{OD}}$。使用 $\\nu$ 的表达式：\n$$\n\\frac{\\nu_{\\mathrm{OH}}}{\\nu_{\\mathrm{OD}}} = \\frac{\\frac{1}{2\\pi}\\sqrt{\\frac{k}{\\mu_{\\mathrm{OH}}}}}{\\frac{1}{2\\pi}\\sqrt{\\frac{k}{\\mu_{\\mathrm{OD}}}}}\n$$\n问题陈述中指出，力常数 $k$ 对两种同位素体是相同的。常数 $1/(2\\pi)$ 和 $k$ 会消去，剩下：\n$$\n\\frac{\\nu_{\\mathrm{OH}}}{\\nu_{\\mathrm{OD}}} = \\sqrt{\\frac{1/\\mu_{\\mathrm{OH}}}{1/\\mu_{\\mathrm{OD}}}} = \\sqrt{\\frac{\\mu_{\\mathrm{OD}}}{\\mu_{\\mathrm{OH}}}}\n$$\n现在，我们代入约化质量的表达式：\n$$\n\\frac{\\nu_{\\mathrm{OH}}}{\\nu_{\\mathrm{OD}}} = \\sqrt{\\frac{\\frac{m_{\\mathrm{O}} m_{\\mathrm{D}}}{m_{\\mathrm{O}} + m_{\\mathrm{D}}}}{\\frac{m_{\\mathrm{O}} m_{\\mathrm{H}}}{m_{\\mathrm{O}} + m_{\\mathrm{H}}}}} = \\sqrt{\\frac{m_{\\mathrm{D}}(m_{\\mathrm{O}} + m_{\\mathrm{H}})}{m_{\\mathrm{H}}(m_{\\mathrm{O}} + m_{\\mathrm{D}})}}\n$$\n使用提供的同位素质量：\n$m_{\\mathrm{O}} = 15.994914\\,\\mathrm{u}$\n$m_{\\mathrm{H}} = 1.007825\\,\\mathrm{u}$\n$m_{\\mathrm{D}} = 2.014102\\,\\mathrm{u}$\n\n首先，我们计算约化质量。原子质量单位 ($\\mathrm{u}$) 在最终的比率中会消去，所以我们可以直接使用数值。\n$$\n\\mu_{\\mathrm{OH}} = \\frac{(15.994914)(1.007825)}{15.994914 + 1.007825} = \\frac{16.1199320}{17.002739} \\approx 0.9480838\\,\\mathrm{u}\n$$\n$$\n\\mu_{\\mathrm{OD}} = \\frac{(15.994914)(2.014102)}{15.994914 + 2.014102} = \\frac{32.2155855}{18.009016} \\approx 1.788856\\,\\mathrm{u}\n$$\n现在我们计算比率：\n$$\n\\frac{\\nu_{\\mathrm{OH}}}{\\nu_{\\mathrm{OD}}} = \\sqrt{\\frac{\\mu_{\\mathrm{OD}}}{\\mu_{\\mathrm{OH}}}} \\approx \\sqrt{\\frac{1.788856}{0.9480838}} \\approx \\sqrt{1.886801} \\approx 1.373609\n$$\n问题要求将结果四舍五入到四位有效数字。\n$$\n1.373609 \\approx 1.374\n$$\n这个结果展示了振动频率上的同位素效应：较重的同位素体 (O-D) 比较轻的同位素体 (O-H) 具有更低的振动频率。",
            "answer": "$$\n\\boxed{1.374}\n$$"
        },
        {
            "introduction": "一个好的力场不仅要包含正确的能量项，还要确保这些项的组合能够准确地再现分子结构。这个练习是一个巧妙的思想实验，旨在揭示为何特定的能量项（如角弯曲项）是不可或缺的。通过构建一个缺少角弯曲项的简化水分子力场，你将探索非键相互作用（如此处的氢-氢静电和范德华排斥）如何单独决定分子的几何形状，从而深刻理解为何需要专门的能量项来维持正确的键角。",
            "id": "2458473",
            "problem": "一个孤立的水分子由一个经典的分子力学力场建模，该力场只包含两种类型的能量项：针对每个O–H键的谐振O–H键伸缩项，以及由Lennard-Jones (LJ)和库仑静电相互作用组成的成对非键相互作用。假设如下：\n- 非键相互作用的计算涵盖所有非直接成键的原子对，即它们包括分子内的 H–H (1–3) 相互作用，但排除 O–H (1–2) 非键相互作用。\n- 两个O–H键是等价的，并且共享相同的谐振参数，平衡键长为 $r_0$。\n- 氧原子带有 $-2q$ 的部分电荷，每个氢原子带有 $+q$ 的部分电荷，其中 $q>0$，因此分子是电中性的。不需要具体数值。\n- 没有显式的键角弯曲项，也没有非正常扭转或平面外项。\n\n在这些假设下，于 $0\\,\\mathrm{K}$ 能量最小化结构中，预测的H–O–H键角是多少？\n\nA) $104.5^\\circ$\n\nB) $0^\\circ$\n\nC) $180^\\circ$\n\nD) 不确定；任何角度都具有相同的能量",
            "solution": "必须首先验证问题陈述的科学性和逻辑完整性。\n\n### 第1步：提取已知条件\n-   **系统**：一个孤立的水分子。\n-   **力场模型**：经典分子力学。\n-   **包含的能量项**：\n    1.  针对两个O–H键中每一个的谐振O–H键伸缩项。\n    2.  成对非键相互作用：Lennard-Jones (LJ) 和库仑静电相互作用。\n-   **非键相互作用规则**：\n    -   对所有非直接成键的原子对进行计算。\n    -   包括分子内的 H–H ($1$–$3$) 相互作用。\n    -   排除 O–H ($1$–$2$) 非键相互作用。\n-   **键项参数**：\n    -   两个O–H键是等价的。\n    -   共享谐振参数。\n    -   平衡键长为 $r_0$。\n-   **静电参数**：\n    -   氧原子部分电荷：$-2q$。\n    -   氢原子部分电荷：$+q$。\n    -   条件：$q>0$。\n-   **排除的能量项**：\n    -   没有显式的键角弯曲项。\n    -   没有非正常扭转项。\n    -   没有平面外项。\n-   **目标**：在 $0\\,\\mathrm{K}$ 能量最小化结构中，求出预测的 H–O–H 键角。\n\n### 第2步：使用提取的已知条件进行验证\n该问题使用分子力学力场的标准组件，描述了一个简化但定义明确的水分子理论模型。各个组件（谐振键、Lennard-Jones、库仑）是基础的，且描述正确。应用这些能量项的规则（例如，排除 $1$–$2$ 非键相互作用）是该领域的标准做法。该设定是一个清晰且可解的势能最小化问题。\n\n-   **科学依据**：该问题很好地基于计算化学和力场建模的原理。它代表了一个有效但简化的物理模型。\n-   **适定性**：该问题是适定的。它要求找出使一个明确定义的势能函数最小化的几何结构。预计存在一个唯一的最小值。\n-   **客观性**：语言精确、技术性强，没有歧义或主观性。\n\n### 第3步：结论与行动\n问题陈述是**有效的**。它自成体系、科学合理且明确无误。可以推导出严谨的解。\n\n### 解的推导\n水分子的几何结构由使总势能 $U_{total}$ 最小化的坐标集决定。在此模型中，总势能是键伸缩能和非键相互作用能的总和。\n$$ U_{total} = U_{bond} + U_{non-bonded} $$\n设两个 O–H 键的键长分别为 $r_1$ 和 $r_2$，H–O–H 键角为 $\\theta$。\n\n键伸缩能由下式给出：\n$$ U_{bond} = \\frac{1}{2} k_b (r_1 - r_0)^2 + \\frac{1}{2} k_b (r_2 - r_0)^2 $$\n其中 $k_b$ 是键力常数，$r_0$ 是平衡键长。当 $r_1 = r_2 = r_0$ 时，该能量达到最小值。虽然非键作用力可能会使键长从 $r_0$ 发生轻微扰动，但键伸缩势通常非常“刚性”（即 $k_b$ 很大），因此，在确定键角时，我们可以假设键长保持在其能量最小化的值 $r_0$ 不变。因此，$U_{bond}$ 可以被视为值为 $0$ 的常数。\n\n根据问题陈述，非键能量 $U_{non-bonded}$ 仅包含两个氢原子之间的相互作用（一种 $1$–$3$ 相互作用）。O–H 非键相互作用（$1$–$2$）被明确排除。\n$$ U_{non-bonded} = U_{H-H} $$\n该相互作用由 Lennard-Jones 项和库仑项组成：\n$$ U_{H-H}(r_{HH}) = U_{LJ}(r_{HH}) + U_{Coulomb}(r_{HH}) $$\n其中 $r_{HH}$ 是两个氢原子之间的距离。\n\n库仑项源于两个氢原子之间的静电相互作用，每个氢原子都带有 $+q$ 的电荷：\n$$ U_{Coulomb}(r_{HH}) = \\frac{1}{4\\pi\\epsilon_0} \\frac{q \\cdot q}{r_{HH}} = \\frac{q^2}{4\\pi\\epsilon_0 r_{HH}} $$\n由于 $q>0$，所以 $q^2$ 是正数。此项是纯粹排斥性的，并且随着 $r_{HH}$ 的增加而单调递减。\n\nLennard-Jones 项是：\n$$ U_{LJ}(r_{HH}) = 4\\epsilon_{HH} \\left[ \\left(\\frac{\\sigma_{HH}}{r_{HH}}\\right)^{12} - \\left(\\frac{\\sigma_{HH}}{r_{HH}}\\right)^{6} \\right] $$\n该项由一个非常强的短程排斥作用（$r_{HH}^{-12}$ 部分）和一个较弱的中程吸引作用（$r_{HH}^{-6}$ 部分）组成。对于分子内的 $1$–$3$ H–H 距离，其间距通常小到足以使相互作用由排斥性的 $r_{HH}^{-12}$ 项主导。\n\n因此，总的 H–H 相互作用势 $U_{H-H}$ 由排斥作用主导。静电和 Lennard-Jones 空间位阻分量都对两个氢原子之间的强排斥力有贡献。一个基本上是排斥性的势是原子间距 $r_{HH}$ 的单调递减函数。因此，要使 $U_{H-H}$ 最小化，必须使距离 $r_{HH}$ 最大化。\n\n距离 $r_{HH}$ 是 H–O–H 键角 $\\theta$ 的函数。对边长为 $r_{OH} = r_0$ 的 H–O–H 等腰三角形使用余弦定理：\n$$ r_{HH}^2 = r_0^2 + r_0^2 - 2 r_0 r_0 \\cos\\theta = 2r_0^2(1 - \\cos\\theta) $$\n使用三角恒等式 $1 - \\cos\\theta = 2\\sin^2(\\theta/2)$，我们得到：\n$$ r_{HH} = \\sqrt{4r_0^2\\sin^2(\\frac{\\theta}{2})} = 2r_0 \\left| \\sin(\\frac{\\theta}{2}) \\right| $$\n对于物理上相关的角度范围 $\\theta \\in [0^\\circ, 180^\\circ]$ （或 $[0, \\pi]$ 弧度），$\\sin(\\theta/2)$ 是非负的，所以：\n$$ r_{HH}(\\theta) = 2r_0 \\sin(\\frac{\\theta}{2}) $$\n要使 $r_{HH}$ 最大化，我们必须使 $\\sin(\\theta/2)$ 最大化。$\\sin(\\theta/2)$ 的最大值是 $1$，这发生在 $\\theta/2 = 90^\\circ$ 时。这对应于 $\\theta = 180^\\circ$ 的角度。\n\n由于总能量对角度的依赖性 $U_{total}(\\theta)$ 完全通过排斥性的 $U_{H-H}(r_{HH}(\\theta))$ 项体现，因此最小化总能量需要最大化 $r_{HH}$，这又需要设置 $\\theta = 180^\\circ$。问题的关键因素是明确排除了谐振键角弯曲项，在更真实的力场中，该项会提供一个恢复力，使键角保持在其实验值附近。没有它，排斥性的非键作用力就没有与之抗衡的力。\n\n### 选项评估\n-   **A) $104.5^\\circ$**：这是水分子的实验键角。这个结果是从包含特定键角弯曲势（形式为 $U_{angle} = \\frac{1}{2} k_\\theta (\\theta - \\theta_0)^2$，其中 $\\theta_0$ 被参数化为接近 $104.5^\\circ$）的模型中获得的。本问题明确排除了此项。因此，此选项**不正确**。\n-   **B) $0^\\circ$**：角度 $\\theta = 0^\\circ$ 意味着 $r_{HH}=0$。这将导致排斥性的 Lennard-Jones 和库仑能量项变为无穷大。这代表了能量最大的构型，而非最小。这个选项显然是荒谬的。因此，此选项**不正确**。\n-   **C) $180^\\circ$**：角度 $\\theta = 180^\\circ$ 使两个氢原子之间的距离 $r_{HH}$ 最大化。如前所述，相互作用势 $U_{H-H}$ 在所有相关距离上都是排斥性的。最大化分离距离可以最小化这种排斥能。由于这是势能中唯一与角度相关的项，因此该构型对应于给定模型的全局能量最小值。因此，此选项**正确**。\n-   **D) 不确定；任何角度都具有相同的能量**：这是错误的。总能量取决于 H–H 非键相互作用，而该作用是 H–H 距离 $r_{HH}$ 的函数。由于 $r_{HH}$ 是角度 $\\theta$ 的函数，所以总能量也是 $\\theta$ 的函数。能量对于所有角度并非恒定。因此，此选项**不正确**。",
            "answer": "$$\\boxed{C}$$"
        },
        {
            "introduction": "对于柔性分子，决定其三维构象的关键是围绕化学键旋转的能量变化，这由二面角（扭转）势能项描述。这个练习将带你从理论走向实践，模拟计算化学家开发力场参数的核心过程。你将使用一个傅里叶级数模型来拟合丁烷中心C-C键旋转的量子力学能量数据，这不仅是一次真实的数据拟合实践，更将让你深入理解扭转势能中每个数学项（例如$V_1$, $V_2$, $V_3$）所对应的物理意义，如空间位阻和超共轭效应。",
            "id": "2458507",
            "problem": "给定丁烷中绕中心碳-碳键旋转的势能扫描，该势能由 $\\text{C-C-C-C}$ 扭转的二面角 $\\phi$ 参数化。在分子力学中，用于扭转贡献的标准截断傅里叶级数为\n$$\nV(\\phi) \\;=\\; \\sum_{n=1}^{3} \\frac{V_n}{2}\\,\\bigl[\\,1 + \\cos\\!\\bigl(n\\phi - \\gamma\\bigr)\\,\\bigr],\n$$\n其中 $\\phi$ 是二面角，$V_n$ 是具有能量单位的实系数，而 $\\gamma$ 是一个相位。对于丁烷中对称的 $\\text{sp}^3\\text{-sp}^3$ 扭转，基于对称性原因，假设 $\\gamma = 0$。角度 $\\phi$ 以度为单位提供；任何三角函数求值都必须使用以弧度为单位的 $\\phi$。能量单位为 $\\mathrm{kcal\\,mol^{-1}}$，且报告时也必须使用 $\\mathrm{kcal\\,mol^{-1}}$。\n\n通过最小化模型与所提供能量值之间的残差平方和，将系数 $V_1$、$V_2$ 和 $V_3$ 拟合到以下三个测试扫描中的每一个。仅使用上述 $\\gamma=0$ 且 $n \\in \\{1,2,3\\}$ 的模型。报告每种情况下拟合的 $V_1$、$V_2$ 和 $V_3$。然后，单独地（不在程序输出中），解释在丁烷扭转能的背景下，$V_1$、$V_2$ 和 $V_3$ 项的物理意义。\n\n角度单位：所提供数据以度为单位；余弦函数内部以弧度为单位。能量单位：所有报告的 $V_n$ 均使用 $\\mathrm{kcal\\,mol^{-1}}$。将每个报告的 $V_n$ 四舍五入到三位小数。\n\n测试组（每种情况都包含相同的角度网格和相应的能量列表）：\n- 角度网格 $\\{\\phi_k\\}$（单位：度，适用于所有情况）：$\\bigl[\\,0^\\circ,\\,30^\\circ,\\,60^\\circ,\\,90^\\circ,\\,120^\\circ,\\,150^\\circ,\\,180^\\circ,\\,210^\\circ,\\,240^\\circ,\\,270^\\circ,\\,300^\\circ,\\,330^\\circ\\,\\bigr]$。\n\n- 情况 A（类丁烷的真实轮廓）：能量（单位 $\\mathrm{kcal\\,mol^{-1}}$），\n$\\bigl[\\,3.500,\\,1.500,\\,-0.250,\\,2.250,\\,4.250,\\,1.500,\\,-1.000,\\,1.500,\\,4.250,\\,2.250,\\,-0.250,\\,1.500\\,\\bigr]$。\n\n- 情况 B（边界情况：零值平坦轮廓）：能量（单位 $\\mathrm{kcal\\,mol^{-1}}$），\n$\\bigl[\\,0.000,\\,0.000,\\,0.000,\\,0.000,\\,0.000,\\,0.000,\\,0.000,\\,0.000,\\,0.000,\\,0.000,\\,0.000,\\,0.000\\,\\bigr]$。\n\n- 情况 C（边缘情况：纯三重周期性）：能量（单位 $\\mathrm{kcal\\,mol^{-1}}$），\n$\\bigl[\\,2.000,\\,1.000,\\,0.000,\\,1.000,\\,2.000,\\,1.000,\\,0.000,\\,1.000,\\,2.000,\\,1.000,\\,0.000,\\,1.000\\,\\bigr]$。\n\n最终输出格式：您的程序应生成单行输出，其中包含三个拟合的三元组列表，顺序为情况 A 的 $\\bigl[V_1,V_2,V_3\\bigr]$，然后是情况 B，然后是情况 C。要求的确切格式是一个单独的 Python 风格的列表的列表，其中每个 $V_n$ 都四舍五入到三位小数，例如：\n$[[v_{1,A},v_{2,A},v_{3,A}],[v_{1,B},v_{2,B},v_{3,B}],[v_{1,C},v_{2,C},v_{3,C}]]$\n其中每个 $v_{i,j}$ 是一个以 $\\mathrm{kcal\\,mol^{-1}}$ 为单位、小数点后有三位数字的十进制数。",
            "solution": "问题陈述已经过严格验证，并被认为是有效的。它具有科学依据，问题设定良好，客观，并包含推导唯一解所需的所有必要信息。该任务是计算化学和分子力学背景下的一个标准线性最小二乘拟合问题。\n\n该问题要求拟合扭转势模型的系数 $V_1$、$V_2$ 和 $V_3$\n$$V(\\phi) = \\sum_{n=1}^{3} \\frac{V_n}{2}\\,\\bigl[\\,1 + \\cos(n\\phi)\\,\\bigr]$$\n到三组给定的能量数据。该任务可以被表述为一个线性最小二乘问题。该模型相对于参数 $V_1$、$V_2$ 和 $V_3$ 是线性的。我们可以将模型重写为：\n$$V(\\phi) = V_1 f_1(\\phi) + V_2 f_2(\\phi) + V_3 f_3(\\phi)$$\n其中基函数为 $f_n(\\phi) = \\frac{1}{2}\\bigl(1 + \\cos(n\\phi)\\bigr)$。\n\n对于一组给定的 $M$ 个数据点 $(\\phi_k, E_k)$，其中 $k=1, \\dots, M$，我们要找到系数向量 $\\mathbf{V} = [V_1, V_2, V_3]^T$ 以最小化残差平方和 $S$：\n$$S = \\sum_{k=1}^{M} \\left( E_k - V(\\phi_k) \\right)^2 = \\sum_{k=1}^{M} \\left( E_k - \\sum_{n=1}^{3} V_n f_n(\\phi_k) \\right)^2$$\n这个最小化问题等价于在最小二乘意义上求解矩阵方程 $A\\mathbf{V} = \\mathbf{E}$。在这里，$\\mathbf{E}$ 是观测能量的 $M \\times 1$ 列向量，$\\mathbf{V}$ 是未知系数的 $3 \\times 1$ 列向量，而 $A$ 是 $M \\times 3$ 的设计矩阵。设计矩阵的元素由 $A_{kn} = f_n(\\phi_k)$ 给出。在这个问题中，我们有 $M=12$ 个数据点。角度 $\\phi_k$ 以度为单位提供，在计算三角函数之前必须转换为弧度。\n\n$\\mathbf{V}$ 的最小二乘解通过求解正规方程 $(A^T A)\\mathbf{V} = A^T \\mathbf{E}$ 得到。获得此解的一个数值稳定方法是使用标准的线性最小二乘求解器，例如 `numpy.linalg.lstsq`。\n\n步骤如下：\n1.  构建 $12 \\times 3$ 的设计矩阵 $A$。角度由 $\\{\\phi_k\\} = [0^\\circ, 30^\\circ, \\dots, 330^\\circ]$ 给出。将这些角度转换为弧度。$A$ 的三列是向量，其中第 $n$ 列的第 $k$ 个元素是 $\\frac{1}{2}(1 + \\cos(n\\phi_k))$。\n2.  对于三个测试用例（A、B、C）中的每一个，定义相应的 $12 \\times 1$ 能量向量 $\\mathbf{E}$。\n3.  使用线性最小二乘算法求解系统 $A\\mathbf{V} = \\mathbf{E}$，以获得 $\\mathbf{V} = [V_1, V_2, V_3]^T$。\n4.  收集所有三种情况得到的系数向量。\n5.  按照指定格式化结果，将每个系数四舍五入到三位小数。\n\n傅里叶系数 $V_n$ 的物理解释：\n傅里叶级数是表示周期函数的一种通用数学方法。在丁烷中心 $\\mathrm{C-C}$ 键的二面角势的背景下，每一项都与控制分子构象能量学的相互作用有物理对应关系。\n\n-   **$V_1$ 项 ($n=1$)：** 该项的周期性为 $360^\\circ$。它决定了全重叠的顺式共平面构象（$\\phi=0^\\circ$）和交错的反式共平面构象（$\\phi=180^\\circ$）之间的能量差。该项的主要贡献来自两个庞大的末端甲基之间的强空间排斥（范德华排斥）。这种相互作用在 $\\phi=0^\\circ$ 时最大，在 $\\phi=180^\\circ$ 时最小。一个正的 $V_1$ 系数可以正确地使顺式构象处于高能态，反式构象处于低能态。\n\n-   **$V_2$ 项 ($n=2$)：** 该项的周期性为 $180^\\circ$，有助于更普遍地描述重叠构象和交错构象之间的能量差。然而，其主要作用是区分两种类型的交错构象异构体（$180^\\circ$ 的反式构象 vs. $\\pm 60^\\circ$ 的邻位构象）和两种主要类型的重叠构象异构体（$0^\\circ$ vs. $\\pm 120^\\circ$）。该项可以与电子效应（如超共轭）相关联，超共轭可以稳定键的垂直排列，但其解释不如 $V_1$ 和 $V_3$ 那样直接。\n\n-   **$V_3$ 项 ($n=3$)：** 该项的周期性为 $120^\\circ$，反映了 $\\mathrm{sp^3-sp^3}$ 单键的三重对称性。这是旋转势垒的基本“类乙烷”分量。它代表了对交错构象（例如 $\\phi = 60^\\circ, 180^\\circ, 300^\\circ$）相对于重叠构象（例如 $\\phi = 0^\\circ, 120^\\circ, 240^\\circ$）的内在偏好。这种偏好主要源于两个中心碳原子上键的电子云之间的泡利排斥（空间位阻）。一个正的 $V_3$ 系数确保了所有交错形式的能量都低于所有重叠形式，从而创建了典型的三重势垒轮廓。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Fits torsional potential parameters V_n to given energy scans for butane.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = {\n        \"angles_deg\": [\n            0.0, 30.0, 60.0, 90.0, 120.0, 150.0, 180.0, \n            210.0, 240.0, 270.0, 300.0, 330.0\n        ],\n        \"A\": {\n            \"energies\": [\n                3.500, 1.500, -0.250, 2.250, 4.250, 1.500, -1.000, \n                1.500, 4.250, 2.250, -0.250, 1.500\n            ]\n        },\n        \"B\": {\n            \"energies\": [\n                0.000, 0.000, 0.000, 0.000, 0.000, 0.000, 0.000,\n                0.000, 0.000, 0.000, 0.000, 0.000\n            ]\n        },\n        \"C\": {\n            \"energies\": [\n                2.000, 1.000, 0.000, 1.000, 2.000, 1.000, 0.000,\n                1.000, 2.000, 1.000, 0.000, 1.000\n            ]\n        }\n    }\n\n    # Extract angle grid and convert to radians\n    phi_deg = np.array(test_cases[\"angles_deg\"])\n    phi_rad = np.deg2rad(phi_deg)\n\n    # --- Construct the design matrix A ---\n    # The model is V(phi) = sum_{n=1 to 3} V_n * f_n(phi)\n    # where f_n(phi) = 0.5 * (1 + cos(n*phi))\n    # The columns of A are the basis functions f_n evaluated at each angle phi_k.\n    f1 = 0.5 * (1 + np.cos(1 * phi_rad))\n    f2 = 0.5 * (1 + np.cos(2 * phi_rad))\n    f3 = 0.5 * (1 + np.cos(3 * phi_rad))\n    \n    # Design matrix A (size 12x3)\n    A = np.vstack([f1, f2, f3]).T\n\n    results = []\n    # Loop through the cases to fit\n    for case_id in [\"A\", \"B\", \"C\"]:\n        # Energy vector E (size 12x1)\n        E = np.array(test_cases[case_id][\"energies\"])\n        \n        # Solve the linear least squares problem A*V = E for V=[V1, V2, V3]\n        # np.linalg.lstsq returns a tuple; the first element is the solution vector.\n        V, _, _, _ = np.linalg.lstsq(A, E, rcond=None)\n        \n        results.append(V)\n\n    # --- Format the output as specified ---\n    # Example format: [[v1A,v2A,v3A],[v1B,v2B,v3B],[v1C,v2C,v3C]]\n    # with each value rounded to three decimal places.\n    \n    outer_list = []\n    for res in results:\n        # Format each coefficient to 3 decimal places\n        inner_list_str = \",\".join([f\"{x:.3f}\" for x in res])\n        outer_list.append(f\"[{inner_list_str}]\")\n        \n    final_output_string = f\"[{','.join(outer_list)}]\"\n    \n    print(final_output_string)\n\nsolve()\n```"
        }
    ]
}