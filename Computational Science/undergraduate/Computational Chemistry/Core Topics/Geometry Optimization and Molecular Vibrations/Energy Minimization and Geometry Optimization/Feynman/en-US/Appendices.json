{
    "hands_on_practices": [
        {
            "introduction": "The most fundamental task in geometry optimization is finding the lowest point on a potential energy surface (PES). This practice explores the classic Lennard-Jones potential for a simple diatomic system. By analyzing how the system behaves from various starting points, you will discover that the equilibrium bond length is an intrinsic property of the potential itself, demonstrating the core goal of any optimization algorithm .",
            "id": "2455319",
            "problem": "Consider a diatomic system in three-dimensional space whose interaction is modeled by the Lennard–Jones $12\\text{–}6$ potential in reduced units. The potential energy depends only on the scalar interatomic separation $r$, defined by $r=\\lVert \\mathbf{r}_2-\\mathbf{r}_1\\rVert$, and is given by\n\n$$\nE(r)=4\\varepsilon\\left[\\left(\\frac{\\sigma}{r}\\right)^{12}-\\left(\\frac{\\sigma}{r}\\right)^{6}\\right],\n$$\n\nwith $\\varepsilon=1$ and $\\sigma=1$. Distances must be expressed in units of $\\sigma$, and energies in units of $\\varepsilon$. Angles are not used in this problem.\n\nFor each initial geometry below, consisting of atomic positions $\\mathbf{r}_1$ and $\\mathbf{r}_2$ in units of $\\sigma$, determine the geometry that minimizes $E(r)$ and report the optimized interatomic distance $r^\\star$ in units of $\\sigma$. Round each reported value of $r^\\star$ to six decimal places.\n\nTest suite (each line lists $\\mathbf{r}_1$ and $\\mathbf{r}_2$):\n\n- Case A (exact overlap): $\\mathbf{r}_1=(0,0,0)$, $\\mathbf{r}_2=(0,0,0)$.\n- Case B (near overlap): $\\mathbf{r}_1=(0,0,0)$, $\\mathbf{r}_2=(10^{-12},0,0)$.\n- Case C (farther than equilibrium): $\\mathbf{r}_1=(0,0,0)$, $\\mathbf{r}_2=(3,0,0)$.\n- Case D (at the Lennard–Jones minimum): $\\mathbf{r}_1=(0,0,0)$, $\\mathbf{r}_2=(2^{1/6},0,0)$.\n\nYour program must compute $r^\\star$ for each case. The final output format must be a single line containing a comma-separated list of the four rounded values enclosed in square brackets, for example $[r_A^\\star,r_B^\\star,r_C^\\star,r_D^\\star]$, where each $r^\\star$ is a decimal numeral rounded to six places, in units of $\\sigma$.",
            "solution": "The problem requires the determination of the interatomic distance, $r^\\star$, that minimizes the potential energy of a diatomic system. The interaction is described by the Lennard-Jones $12\\text{–}6$ potential, given in reduced units where the well depth $\\varepsilon=1$ and the finite distance at which the inter-particle potential is zero, $\\sigma$, is also $1$.\n\nThe potential energy, $E$, is a function of the scalar interatomic separation $r = \\lVert \\mathbf{r}_2 - \\mathbf{r}_1 \\rVert$. The functional form is:\n$$\nE(r) = 4\\varepsilon\\left[\\left(\\frac{\\sigma}{r}\\right)^{12}-\\left(\\frac{\\sigma}{r}\\right)^{6}\\right]\n$$\nWith the specified reduced units $\\varepsilon=1$ and $\\sigma=1$, the expression simplifies to:\n$$\nE(r) = 4\\left[\\left(\\frac{1}{r}\\right)^{12} - \\left(\\frac{1}{r}\\right)^{6}\\right] = 4\\left(r^{-12} - r^{-6}\\right)\n$$\nTo find the configuration of minimum energy, we must find the value of $r$ for which the potential energy $E(r)$ is at a minimum. This is a standard procedure in calculus, which involves finding the critical points of the function by setting its first derivative with respect to $r$ equal to zero.\nThe first derivative of $E(r)$ is:\n$$\n\\frac{dE}{dr} = \\frac{d}{dr} \\left[ 4\\left(r^{-12} - r^{-6}\\right) \\right]\n$$\nApplying the power rule for differentiation:\n$$\n\\frac{dE}{dr} = 4 \\left( -12r^{-13} - (-6)r^{-7} \\right) = 4 \\left( -12r^{-13} + 6r^{-7} \\right)\n$$\nTo find the minimum, we set this derivative to zero, for $r>0$:\n$$\n4 \\left( -12r^{-13} + 6r^{-7} \\right) = 0\n$$\nSince $4 \\neq 0$, we must have:\n$$\n-12r^{-13} + 6r^{-7} = 0\n$$\n$$\n6r^{-7} = 12r^{-13}\n$$\nDividing both sides by $6$ and multiplying by $r^{13}$ (which is permissible as the minimum cannot be at $r=0$ where energy is infinite) gives:\n$$\nr^6 = 2\n$$\nSolving for $r$ yields the equilibrium distance, $r^\\star$:\n$$\nr^\\star = 2^{1/6}\n$$\nTo confirm this is a minimum, one must check the second derivative, $\\frac{d^2E}{dr^2}$.\n$$\n\\frac{d^2E}{dr^2} = 4 \\frac{d}{dr} \\left( -12r^{-13} + 6r^{-7} \\right) = 4 \\left( (-12)(-13)r^{-14} + (6)(-7)r^{-8} \\right) = 4 \\left( 156r^{-14} - 42r^{-8} \\right)\n$$\nSubstituting $r = r^\\star = 2^{1/6}$, we have $r^6 = 2$, so $r^8 = r^6 r^2 = 2 \\cdot (2^{1/6})^2 = 2 \\cdot 2^{1/3}$ and $r^{14} = r^{12} r^2 = (r^6)^2 r^2 = 4 \\cdot 2^{1/3}$.\n$$\n\\frac{d^2E}{dr^2}\\bigg|_{r=r^\\star} = 4 \\left( \\frac{156}{4 \\cdot 2^{1/3}} - \\frac{42}{2 \\cdot 2^{1/3}} \\right) = 4 \\left( \\frac{39}{2^{1/3}} - \\frac{21}{2^{1/3}} \\right) = \\frac{4 \\cdot 18}{2^{1/3}} = \\frac{72}{2^{1/3}}\n$$\nSince $72 > 0$ and $2^{1/3} > 0$, the second derivative is positive. This confirms that $r^\\star = 2^{1/6}$ corresponds to a local minimum. As this is the only critical point for $r>0$, it is the global minimum.\n\nThe value $r^\\star = 2^{1/6}\\sigma$ is an intrinsic property of the Lennard-Jones potential. It represents the single, unique distance at which the repulsive and attractive forces are perfectly balanced. This equilibrium distance does not depend on the initial positions of the atoms. Any geometry optimization algorithm, when applied to a system governed by this potential, will seek to converge to a state where the interatomic distance is $r^\\star = 2^{1/6}$.\n\nThe problem provides four initial geometries:\n- Case A: $\\mathbf{r}_1=(0,0,0)$, $\\mathbf{r}_2=(0,0,0)$. The initial distance is $r=0$. At this point, the potential energy $E(r)$ is undefined, representing a singularity. Physically, this corresponds to a state of infinite repulsive energy. This is not a stable configuration. The question asks for the geometry that *minimizes* energy, which is located at $r^\\star$, not at the singular point. Any infinitesimal displacement would cause the system to evolve towards the potential well minimum. Thus, the optimized distance is $r^\\star = 2^{1/6}$.\n- Case B: $\\mathbf{r}_1=(0,0,0)$, $\\mathbf{r}_2=(10^{-12},0,0)$. The initial distance is $r=10^{-12}$, which is on the steep repulsive wall of the potential ($r \\ll r^\\star$). The system will evolve to increase its separation to $r^\\star = 2^{1/6}$.\n- Case C: $\\mathbf{r}_1=(0,0,0)$, $\\mathbf{r}_2=(3,0,0)$. The initial distance is $r=3$, which is in the attractive region of the potential ($r > r^\\star$). The system will evolve to decrease its separation to $r^\\star = 2^{1/6}$.\n- Case D: $\\mathbf{r}_1=(0,0,0)$, $\\mathbf{r}_2=(2^{1/6},0,0)$. The initial distance is $r=2^{1/6}$, which is precisely the equilibrium distance $r^\\star$. The system is already at its minimum energy configuration, so the optimized distance is $r^\\star = 2^{1/6}$.\n\nIn all four cases, the geometry that minimizes the potential energy is characterized by the same interatomic distance. The final optimized distance $r^\\star$ is therefore identical for all test cases. The numerical value is:\n$$\nr^\\star = 2^{1/6} \\approx 1.122462048309373\n$$\nRounding to six decimal places, we have:\n$$\nr^\\star \\approx 1.122462\n$$\nThis value must be reported for each of the four cases.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the optimized interatomic distance for a diatomic system\n    modeled by the Lennard-Jones potential in reduced units.\n    \"\"\"\n\n    # The problem asks to find the geometry that minimizes the Lennard-Jones potential\n    # E(r) = 4 * epsilon * [(sigma/r)^12 - (sigma/r)^6].\n    # In reduced units, epsilon = 1 and sigma = 1.\n    # The minimum of this potential occurs at a specific distance r_star\n    # which can be found by setting the derivative dE/dr to zero.\n    # dE/dr = 4 * [-12/r^13 + 6/r^7] = 0\n    # => 6/r^7 = 12/r^13\n    # => r^6 = 12/6 = 2\n    # => r_star = 2^(1/6)\n    #\n    # This equilibrium distance r_star is an intrinsic property of the potential\n    # and is independent of the initial atomic positions. Therefore, the result\n    # will be the same for all test cases presented in the problem.\n\n    # Test cases are provided but not needed for the analytical solution.\n    # They are included here for completeness, as per the template.\n    test_cases = [\n        # Case A: r1=(0,0,0), r2=(0,0,0) -> initial r=0\n        {'r1': np.array([0.0, 0.0, 0.0]), 'r2': np.array([0.0, 0.0, 0.0])},\n        # Case B: r1=(0,0,0), r2=(1e-12,0,0) -> initial r=1e-12\n        {'r1': np.array([0.0, 0.0, 0.0]), 'r2': np.array([1e-12, 0.0, 0.0])},\n        # Case C: r1=(0,0,0), r2=(3,0,0) -> initial r=3\n        {'r1': np.array([0.0, 0.0, 0.0]), 'r2': np.array([3.0, 0.0, 0.0])},\n        # Case D: r1=(0,0,0), r2=(2**(1/6),0,0) -> initial r=2**(1/6)\n        {'r1': np.array([0.0, 0.0, 0.0]), 'r2': np.array([2**(1/6), 0.0, 0.0])},\n    ]\n\n    # Calculate the optimized distance analytically.\n    # This is r_star = (2)^(1/6) in units of sigma.\n    r_star = 2**(1/6)\n\n    results = []\n    # The result is the same for all cases.\n    for _ in test_cases:\n        # The optimized distance is independent of the starting geometry.\n        # The value is rounded to six decimal places as required.\n        rounded_r_star = round(r_star, 6)\n        results.append(str(rounded_r_star))\n\n    # The final output format must be a single line containing a\n    # comma-separated list of the four rounded values enclosed in square brackets.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "Real molecules have multiple geometric parameters, making their potential energy surfaces multi-dimensional. This exercise models the Jahn-Teller distortion in the $[\\mathrm{Cu}(\\mathrm{H}_2\\mathrm{O})_6]^{2+}$ complex, a real chemical phenomenon where an idealized high-symmetry geometry is unstable. You will minimize a two-dimensional energy function to predict the stable, distorted structure, practicing the use of partial derivatives to find an energy minimum in a multi-variable system .",
            "id": "2455327",
            "problem": "Consider the hexaaqua copper(II) complex $[\\mathrm{Cu}(\\mathrm{H}_2\\mathrm{O})_6]^{2+}$, which in an idealized octahedral environment has $6$ equivalent metal–ligand distances. Due to the Jahn–Teller (JT) effect, the complex undergoes a tetragonal distortion that differentiates the two axial bonds from the four equatorial bonds. Model the total potential energy as the sum of harmonic bond-stretching terms and a linear vibronic coupling that stabilizes a tetragonal distortion. Let the two axial $\\mathrm{Cu}-\\mathrm{O}$ bonds each have common length $r_a$ and the four equatorial $\\mathrm{Cu}-\\mathrm{O}$ bonds each have common length $r_e$. Let $r_0$ denote the reference undistorted bond length. Let $k_a$ and $k_e$ denote the axial and equatorial harmonic force constants, respectively. Let $g \\ge 0$ denote the strength of the linear Jahn–Teller coupling to the tetragonal mode. The total energy as a function of $r_a$ and $r_e$ is\n$$\nE(r_a,r_e) \\;=\\; 2 \\cdot \\frac{1}{2} k_a \\left(r_a - r_0\\right)^2 \\;+\\; 4 \\cdot \\frac{1}{2} k_e \\left(r_e - r_0\\right)^2 \\;-\\; g \\,\\big(r_a - r_e\\big).\n$$\nAll distances $r_a$, $r_e$, and $r_0$ must be expressed in ångström, written as $\\text{\\AA}$, and all energies must be expressed in $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$. The parameters $k_a$ and $k_e$ are given in $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\text{\\AA}^{-2}$, and $g$ is given in $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\text{\\AA}^{-1}$. Angles do not appear in this model. Define the tetragonal distortion amplitude as $Q = r_a - r_e$.\n\nTask: For each parameter set in the test suite below, determine the unique pair $\\big(r_a^\\star, r_e^\\star\\big)$ that minimizes $E(r_a,r_e)$, then compute $Q^\\star = r_a^\\star - r_e^\\star$ and $E^\\star = E(r_a^\\star, r_e^\\star)$. Express $r_a^\\star$, $r_e^\\star$, and $Q^\\star$ in ångström and $E^\\star$ in $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$. Round every reported real number to $6$ decimal places.\n\nTest suite (each tuple is $\\big(r_0, k_a, k_e, g\\big)$ with units $\\big(\\text{\\AA}, \\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\text{\\AA}^{-2}, \\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\text{\\AA}^{-2}, \\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\text{\\AA}^{-1}\\big)$):\n- Case $1$: $\\big(2.00, 200, 250, 50\\big)$\n- Case $2$: $\\big(2.05, 300, 300, 0\\big)$\n- Case $3$: $\\big(1.98, 150, 1000, 60\\big)$\n- Case $4$: $\\big(2.00, 200, 200, 400\\big)$\n\nFinal output format: Your program should produce a single line of output containing a list of results, one per test case, where each result is the list $\\big[r_a^\\star, r_e^\\star, Q^\\star, E^\\star\\big]$. The overall output must be a single comma-separated list of these lists enclosed in square brackets, for example\n$[\\,[r_{a,1}^\\star,r_{e,1}^\\star,Q_1^\\star,E_1^\\star],\\,[r_{a,2}^\\star,r_{e,2}^\\star,Q_2^\\star,E_2^\\star],\\,\\dots\\,]$,\nwith every real number rounded to $6$ decimal places and no additional text.",
            "solution": "The problem statement has been rigorously validated and is determined to be valid. It is scientifically grounded in the principles of coordination chemistry, specifically the Jahn-Teller effect, and is modeled using standard harmonic and linear coupling approximations. The problem is mathematically well-posed, providing a convex quadratic energy function of two variables, which guarantees the existence of a unique global minimum. All parameters and constants are clearly defined with consistent physical units, and the objective is unambiguous. Therefore, we may proceed with the derivation of a solution.\n\nThe task is to find the equilibrium geometry $(r_a^\\star, r_e^\\star)$ that minimizes the total potential energy function $E(r_a, r_e)$ for the hexaaqua copper(II) complex. The energy is given as:\n$$\nE(r_a,r_e) \\;=\\; k_a \\left(r_a - r_0\\right)^2 \\;+\\; 2 k_e \\left(r_e - r_0\\right)^2 \\;-\\; g \\,\\big(r_a - r_e\\big)\n$$\nwhere $r_a$ is the axial bond length, $r_e$ is the equatorial bond length, $r_0$ is a reference bond length, $k_a$ and $k_e$ are harmonic force constants, and $g$ is the vibronic coupling constant.\n\nTo find the minimum of this differentiable function, we must find the critical point where the gradient of $E$ with respect to the coordinates $(r_a, r_e)$ is the zero vector. This requires setting the partial derivatives of $E(r_a, r_e)$ with respect to $r_a$ and $r_e$ to zero.\n\nFirst, we compute the partial derivative with respect to $r_a$:\n$$\n\\frac{\\partial E}{\\partial r_a} \\;=\\; \\frac{\\partial}{\\partial r_a} \\left[ k_a \\left(r_a - r_0\\right)^2 \\;+\\; 2 k_e \\left(r_e - r_0\\right)^2 \\;-\\; g \\,\\big(r_a - r_e\\big) \\right]\n$$\n$$\n\\frac{\\partial E}{\\partial r_a} \\;=\\; 2 k_a (r_a - r_0) \\;-\\; g\n$$\nNext, we compute the partial derivative with respect to $r_e$:\n$$\n\\frac{\\partial E}{\\partial r_e} \\;=\\; \\frac{\\partial}{\\partial r_e} \\left[ k_a \\left(r_a - r_0\\right)^2 \\;+\\; 2 k_e \\left(r_e - r_0\\right)^2 \\;-\\; g \\,\\big(r_a - r_e\\big) \\right]\n$$\n$$\n\\frac{\\partial E}{\\partial r_e} \\;=\\; 4 k_e (r_e - r_0) \\;+\\; g\n$$\nAt the minimum $(r_a^\\star, r_e^\\star)$, these partial derivatives must be equal to zero, which gives us a system of two linear equations for the two unknowns $r_a^\\star$ and $r_e^\\star$:\n$$\n\\begin{cases}\n2 k_a (r_a^\\star - r_0) - g = 0 \\\\\n4 k_e (r_e^\\star - r_0) + g = 0\n\\end{cases}\n$$\nSolving the first equation for $r_a^\\star$:\n$$\n2 k_a (r_a^\\star - r_0) = g \\;\\implies\\; r_a^\\star - r_0 = \\frac{g}{2 k_a} \\;\\implies\\; r_a^\\star = r_0 + \\frac{g}{2 k_a}\n$$\nSolving the second equation for $r_e^\\star$:\n$$\n4 k_e (r_e^\\star - r_0) = -g \\;\\implies\\; r_e^\\star - r_0 = -\\frac{g}{4 k_e} \\;\\implies\\; r_e^\\star = r_0 - \\frac{g}{4 k_e}\n$$\nThese expressions provide the optimized bond lengths $r_a^\\star$ and $r_e^\\star$ as a function of the input parameters. The existence of a minimum is confirmed by the Hessian matrix of second derivatives, which is positive-definite for positive force constants $k_a > 0$ and $k_e > 0$.\n\nWith the optimal bond lengths determined, we can compute the required quantities:\n1.  The optimal tetragonal distortion amplitude, $Q^\\star$:\n    $$\n    Q^\\star = r_a^\\star - r_e^\\star = \\left( r_0 + \\frac{g}{2 k_a} \\right) - \\left( r_0 - \\frac{g}{4 k_e} \\right) = g \\left( \\frac{1}{2 k_a} + \\frac{1}{4 k_e} \\right)\n    $$\n2.  The minimum energy, $E^\\star = E(r_a^\\star, r_e^\\star)$. We substitute the expressions for $(r_a^\\star - r_0)$ and $(r_e^\\star - r_0)$ back into the original energy function:\n    $$\n    E^\\star = k_a \\left(\\frac{g}{2 k_a}\\right)^2 + 2 k_e \\left(-\\frac{g}{4 k_e}\\right)^2 - g (r_a^\\star - r_e^\\star)\n    $$\n    Substituting the expression for $Q^\\star = r_a^\\star - r_e^\\star$:\n    $$\n    E^\\star = k_a \\frac{g^2}{4 k_a^2} + 2 k_e \\frac{g^2}{16 k_e^2} - g \\left[ g \\left( \\frac{1}{2 k_a} + \\frac{1}{4 k_e} \\right) \\right]\n    $$\n    $$\n    E^\\star = \\frac{g^2}{4 k_a} + \\frac{g^2}{8 k_e} - \\frac{g^2}{2 k_a} - \\frac{g^2}{4 k_e}\n    $$\n    $$\n    E^\\star = g^2 \\left( \\frac{1}{4 k_a} - \\frac{2}{4 k_a} \\right) + g^2 \\left( \\frac{1}{8 k_e} - \\frac{2}{8 k_e} \\right)\n    $$\n    $$\n    E^\\star = -g^2 \\left( \\frac{1}{4 k_a} + \\frac{1}{8 k_e} \\right)\n    $$\nThis final expression for $E^\\star$ represents the Jahn-Teller stabilization energy. A computational implementation will use these derived formulae to calculate the required values for each test case.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the optimized geometry and energy for the Jahn-Teller distorted\n    [Cu(H2O)6]2+ complex based on a simplified potential energy model.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each tuple is (r0, ka, ke, g)\n    test_cases = [\n        (2.00, 200, 250, 50),\n        (2.05, 300, 300, 0),\n        (1.98, 150, 1000, 60),\n        (2.00, 200, 200, 400),\n    ]\n\n    all_results_as_strings = []\n    \n    for case in test_cases:\n        r0, ka, ke, g = case\n        \n        # Ensure force constants are not zero to avoid division by zero error,\n        # which is physically required anyway.\n        if ka == 0 or ke == 0:\n            # This case would be physically invalid.\n            # For this problem's scope, we assume ka > 0 and ke > 0.\n            continue\n\n        # Calculate optimal axial bond length r_a*\n        # r_a_star = r0 + g / (2 * k_a)\n        ra_star = r0 + g / (2.0 * ka)\n        \n        # Calculate optimal equatorial bond length r_e*\n        # r_e_star = r0 - g / (4 * k_e)\n        re_star = r0 - g / (4.0 * ke)\n        \n        # Calculate optimal tetragonal distortion amplitude Q*\n        # Q* = r_a* - r_e*\n        q_star = ra_star - re_star\n        \n        # Calculate the minimum energy E*\n        # E* = -g^2 * (1/(4*k_a) + 1/(8*k_e))\n        e_star = -(g**2) * (1.0 / (4.0 * ka) + 1.0 / (8.0 * ke))\n        \n        # Format the results for the current case as a string\n        # Each number is rounded to 6 decimal places.\n        # e.g., '[2.125000,1.950000,0.175000,-4.375000]'\n        case_string = (\n            f\"[{ra_star:.6f},{re_star:.6f},{q_star:.6f},{e_star:.6f}]\"\n        )\n        all_results_as_strings.append(case_string)\n\n    # Final print statement in the exact required format.\n    # e.g., '[[...],[...],...]'\n    final_output = f\"[{','.join(all_results_as_strings)}]\"\n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "Geometry optimizations are often performed with constraints, such as fixing a bond length or angle. This thought experiment uses a simplified, linear model of a water molecule to explore constrained optimization. Your task is not only to find the minimum energy geometry under a constraint but also to analyze the resulting forces on the atoms, illustrating the fundamental principle that at any optimized equilibrium structure, the net forces on all atoms must be zero .",
            "id": "2455389",
            "problem": "You are given a planar three-atom model of a water molecule with one oxygen atom (O) and two hydrogen atoms (H). The molecule is modeled in three-dimensional Cartesian space with coordinates constrained so that the H–O–H angle is exactly $180^\\circ$ (collinear configuration). Under this holonomic constraint, fix the oxygen at the origin and place the hydrogen atoms on the $x$-axis at positions $\\mathbf{r}_{\\mathrm{H}_1} = (r_1, 0, 0)$ and $\\mathbf{r}_{\\mathrm{H}_2} = (-r_2, 0, 0)$ with $r_1 > 0$ and $r_2 > 0$. The H–O–H angle is therefore exactly $180^\\circ$ by construction.\n\nThe intramolecular potential energy is defined as the sum of two harmonic O–H bond-stretching terms and an optional purely repulsive hydrogen–hydrogen interaction of inverse twelfth power. The total energy as a function of $(r_1, r_2)$ is\n$$\nE(r_1, r_2) \\;=\\; \\tfrac{1}{2} k_r \\left[(r_1 - r_{\\mathrm{eq}})^2 + (r_2 - r_{\\mathrm{eq}})^2\\right] \\;+\\; \\frac{A}{(d_{\\mathrm{HH}})^{12}},\n$$\nwhere $k_r$ is the O–H bond force constant in kilojoules per mole per square angstrom, $r_{\\mathrm{eq}}$ is the O–H equilibrium bond length in angstrom, $A$ is the repulsion parameter in kilojoules times angstrom to the twelfth per mole, and $d_{\\mathrm{HH}} = r_1 + r_2$ is the H–H separation in angstrom.\n\nTask:\n- For each parameter set in the test suite below, determine the constrained geometry that minimizes $E(r_1, r_2)$ with $r_1 > 0$ and $r_2 > 0$ while maintaining the H–O–H angle at exactly $180^\\circ$ (i.e., positions as defined above).\n- At the optimized geometry, compute the residual Cartesian forces on each atom as the negative gradients of the total energy with respect to the corresponding Cartesian coordinates. Because of the collinear constraint, the force components orthogonal to the $x$-axis must be zero by construction; report the magnitudes of the residual forces on O, H$_1$, and H$_2$ (each a nonnegative scalar). Express force magnitudes in kilojoules per mole per angstrom.\n- Report the optimized bond lengths $r_1^\\star$ and $r_2^\\star$ in angstrom.\n\nPhysical units:\n- Use angstrom for all distances.\n- Use kilojoules per mole for energies.\n- Use kilojoules per mole per angstrom for force magnitudes.\n- The angle constraint is specified in degrees as $180^\\circ$.\n\nTest suite (three cases):\n- Case $1$: $k_r = 1882.8$, $r_{\\mathrm{eq}} = 0.9572$, $A = 0$.\n- Case $2$: $k_r = 1882.8$, $r_{\\mathrm{eq}} = 0.9572$, $A = 100000$.\n- Case $3$: $k_r = 18828.0$, $r_{\\mathrm{eq}} = 0.9572$, $A = 100000$.\n\nAnswer specification:\n- For each case, output a list containing five floats in the following order: $[r_1^\\star, r_2^\\star, \\|\\mathbf{F}_{\\mathrm{O}}\\|, \\|\\mathbf{F}_{\\mathrm{H}_1}\\|, \\|\\mathbf{F}_{\\mathrm{H}_2}\\|]$, where $\\|\\cdot\\|$ denotes the Euclidean magnitude of the force on that atom.\n- Aggregate the results from all cases into a single line containing a list of these per-case lists, in the same order as the test suite. Your program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, \"[[a,b,c,d,e],[...],[...]]\"). Each float should be rounded to six decimal places.",
            "solution": "The problem presented is a standard exercise in computational chemistry, concerning the minimization of a potential energy function for a constrained molecular system. The problem is scientifically sound, well-posed, and contains all necessary information for its resolution. I will proceed with the solution.\n\nThe objective is to find the geometry, defined by the O-H bond lengths $r_1 > 0$ and $r_2 > 0$, that minimizes the potential energy function $E(r_1, r_2)$. The energy function is given as:\n$$\nE(r_1, r_2) = \\frac{1}{2} k_r \\left[(r_1 - r_{\\mathrm{eq}})^2 + (r_2 - r_{\\mathrm{eq}})^2\\right] + \\frac{A}{(r_1 + r_2)^{12}}\n$$\nA minimum of a differentiable function occurs at a critical point where the gradient is zero. We must therefore solve the system of equations where the partial derivatives of $E$ with respect to $r_1$ and $r_2$ are zero.\n\nFirst, we compute the partial derivatives:\n$$\n\\frac{\\partial E}{\\partial r_1} = k_r (r_1 - r_{\\mathrm{eq}}) - \\frac{12A}{(r_1 + r_2)^{13}}\n$$\n$$\n\\frac{\\partial E}{\\partial r_2} = k_r (r_2 - r_{\\mathrm{eq}}) - \\frac{12A}{(r_1 + r_2)^{13}}\n$$\n\nSetting these derivatives to zero gives the conditions for the energy minimum:\n$$\nk_r (r_1 - r_{\\mathrm{eq}}) = \\frac{12A}{(r_1 + r_2)^{13}} \\quad (1)\n$$\n$$\nk_r (r_2 - r_{\\mathrm{eq}}) = \\frac{12A}{(r_1 + r_2)^{13}} \\quad (2)\n$$\n\nBy equating expressions $(1)$ and $(2)$, we find:\n$$\nk_r (r_1 - r_{\\mathrm{eq}}) = k_r (r_2 - r_{\\mathrm{eq}})\n$$\nSince the force constant $k_r$ is non-zero, this implies $r_1 - r_{\\mathrm{eq}} = r_2 - r_{\\mathrm{eq}}$, which simplifies to $r_1 = r_2$. The symmetric nature of the potential energy function dictates that the minimum energy geometry must be symmetric, with equal O-H bond lengths.\n\nLet $r_1^\\star = r_2^\\star = r^\\star$. The system of two equations reduces to a single nonlinear equation for the optimal bond length $r^\\star$:\n$$\nk_r (r^\\star - r_{\\mathrm{eq}}) = \\frac{12A}{(2r^\\star)^{13}}\n$$\n\nWe now solve this equation for each given case.\n\n**Case 1:** $k_r = 1882.8$, $r_{\\mathrm{eq}} = 0.9572$, $A = 0$.\nWith $A=0$, the equation simplifies to:\n$$\nk_r (r^\\star - r_{\\mathrm{eq}}) = 0\n$$\nAs $k_r \\neq 0$, the solution is $r^\\star = r_{\\mathrm{eq}}$.\nTherefore, $r_1^\\star = r_2^\\star = 0.9572$ Å.\n\n**Case 2 & 3:** $A > 0$.\nThe equation is nonlinear and requires a numerical solution. We define a function $f(r)$ such that its root is the desired solution $r^\\star$:\n$$\nf(r) = k_r (r - r_{\\mathrm{eq}}) - \\frac{12A}{(2r)^{13}} = 0\n$$\nAn efficient method to find the root is the Newton-Raphson algorithm, which uses the iterative update rule:\n$$\nr_{n+1} = r_n - \\frac{f(r_n)}{f'(r_n)}\n$$\nThe derivative $f'(r)$ is needed for the Newton-Raphson method. Let's compute it:\n$$\nf'(r) = \\frac{d}{dr} \\left[ k_r (r - r_{\\mathrm{eq}}) - 12A(2r)^{-13} \\right]\n$$\nApplying the power rule and chain rule:\n$$\nf'(r) = k_r - 12A(-13)(2r)^{-14}(2) = k_r + \\frac{312A}{(2r)^{14}}\n$$\nStarting with an initial guess $r_0 = r_{\\mathrm{eq}}$, we iterate until convergence is achieved to a sufficient precision. This procedure is implemented in the provided code to find $r^\\star$ for Case 2 and Case 3.\n\nNext, we must compute the residual Cartesian forces on each atom. The force $\\mathbf{F}_i$ on atom $i$ is the negative gradient of the potential energy $E$ with respect to its Cartesian coordinates $\\mathbf{r}_i$:\n$$\n\\mathbf{F}_i = -\\nabla_{\\mathbf{r}_i} E\n$$\nThe coordinates are defined as $\\mathbf{r}_{\\mathrm{O}} = (0,0,0)$, $\\mathbf{r}_{\\mathrm{H}_1} = (r_1, 0, 0)$, and $\\mathbf{r}_{\\mathrm{H}_2} = (-r_2, 0, 0)$. The energy $E$ is given as a function of $r_1$ and $r_2$. The parameters $r_1$ and $r_2$ are the system's only degrees of freedom. So, we relate the cartesian coordinate derivatives to the internal coordinate derivatives via the chain rule.\nFor hydrogen atom H$_1$, the force is:\n$$\n\\mathbf{F}_{\\mathrm{H}_1} = -\\nabla_{\\mathbf{r}_{\\mathrm{H}_1}} E = -\\left( \\frac{\\partial E}{\\partial r_1} \\frac{\\partial r_1}{\\partial \\mathbf{r}_{\\mathrm{H}_1}} + \\frac{\\partial E}{\\partial r_2} \\frac{\\partial r_2}{\\partial \\mathbf{r}_{\\mathrm{H}_1}} \\right)\n$$\nWith the given coordinate system, $r_1 = x_1 = \\|\\mathbf{r}_{\\mathrm{H}_1}\\|$, and $r_2 = -x_2 = \\|\\mathbf{r}_{\\mathrm{H}_2}\\|$. Thus, $r_1$ only depends on $\\mathbf{r}_{\\mathrm{H}_1}$ and $r_2$ only depends on $\\mathbf{r}_{\\mathrm{H}_2}$. This simplifies the expressions:\n$\\frac{\\partial r_1}{\\partial \\mathbf{r}_{\\mathrm{H}_1}} = \\mathbf{\\hat{x}}$ and $\\frac{\\partial r_2}{\\partial \\mathbf{r}_{\\mathrm{H}_1}} = \\mathbf{0}$.\nSo, $\\mathbf{F}_{\\mathrm{H}_1} = - \\frac{\\partial E}{\\partial r_1} \\mathbf{\\hat{x}}$.\n\nSimilarly for hydrogen atom H$_2$:\n$\\frac{\\partial r_1}{\\partial \\mathbf{r}_{\\mathrm{H}_2}} = \\mathbf{0}$ and $\\frac{\\partial r_2}{\\partial \\mathbf{r}_{\\mathrm{H}_2}} = -\\mathbf{\\hat{x}}$.\nSo, $\\mathbf{F}_{\\mathrm{H}_2} = - \\frac{\\partial E}{\\partial r_2} (-\\mathbf{\\hat{x}}) = \\frac{\\partial E}{\\partial r_2} \\mathbf{\\hat{x}}$.\n\nFor the oxygen atom, its position is treated as the origin for the definitions of $r_1$ and $r_2$. The force on it arises from its interaction with both hydrogens:\n$\\mathbf{F}_{\\mathrm{O}} = - \\frac{\\partial E}{\\partial r_1} \\frac{\\partial r_1}{\\partial \\mathbf{r}_{\\mathrm{O}}} - \\frac{\\partial E}{\\partial r_2} \\frac{\\partial r_2}{\\partial \\mathbf{r}_{\\mathrm{O}}}$.\n$\\frac{\\partial r_1}{\\partial \\mathbf{r}_{\\mathrm{O}}} = -\\mathbf{\\hat{x}}$ and $\\frac{\\partial r_2}{\\partial \\mathbf{r}_{\\mathrm{O}}} = \\mathbf{\\hat{x}}$.\nSo, $\\mathbf{F}_{\\mathrm{O}} = - \\frac{\\partial E}{\\partial r_1} (-\\mathbf{\\hat{x}}) - \\frac{\\partial E}{\\partial r_2} (\\mathbf{\\hat{x}}) = \\left(\\frac{\\partial E}{\\partial r_1} - \\frac{\\partial E}{\\partial r_2}\\right) \\mathbf{\\hat{x}}$.\n\nAt the optimized geometry $(r_1^\\star, r_2^\\star)$, we have by definition $\\frac{\\partial E}{\\partial r_1} = 0$ and $\\frac{\\partial E}{\\partial r_2} = 0$.\nSubstituting these conditions into the force expressions:\n$$\n\\mathbf{F}_{\\mathrm{H}_1} = - (0) \\mathbf{\\hat{x}} = \\mathbf{0}\n$$\n$$\n\\mathbf{F}_{\\mathrm{H}_2} = (0) \\mathbf{\\hat{x}} = \\mathbf{0}\n$$\n$$\n\\mathbf{F}_{\\mathrm{O}} = (0 - 0) \\mathbf{\\hat{x}} = \\mathbf{0}\n$$\nTherefore, the residual Cartesian force on every atom is identically zero. This is a fundamental consequence of the system being at a minimum of the potential energy surface defined by the given degrees of freedom. The magnitudes are thus $\\|\\mathbf{F}_{\\mathrm{O}}\\| = 0$, $\\|\\mathbf{F}_{\\mathrm{H}_1}\\| = 0$, and $\\|\\mathbf{F}_{\\mathrm{H}_2}\\| = 0$.\n\nThe final results are obtained by computing $r^\\star$ for each case and reporting the corresponding list of five values.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the optimized geometry and residual forces for a collinear triatomic\n    molecule based on a given potential energy function.\n    \"\"\"\n\n    def solve_case(k_r, r_eq, A):\n        \"\"\"\n        Calculates the optimized bond length r* for a given set of parameters.\n        The forces at the optimum are always zero by definition of the energy minimum.\n\n        Args:\n            k_r (float): Bond force constant.\n            r_eq (float): Equilibrium bond length.\n            A (float): Repulsive parameter.\n\n        Returns:\n            list: A list of floats [r1*, r2*, ||F_O||, ||F_H1||, ||F_H2||].\n        \"\"\"\n        if A == 0:\n            r_star = r_eq\n        else:\n            # Solve the nonlinear equation for r using Newton-Raphson method\n            # f(r) = k_r * (r - r_eq) - 12 * A / (2*r)**13 = 0\n            # f'(r) = k_r + 312 * A / (2*r)**14\n            \n            r = r_eq  # Initial guess\n            \n            # Using a very small tolerance for high precision convergence.\n            tolerance = 1e-15\n            max_iterations = 100\n            \n            for _ in range(max_iterations):\n                # Calculate function value f(r) and its derivative f'(r)\n                try:\n                    r_pow13 = (2 * r)**13\n                    r_pow14 = r_pow13 * (2 * r)\n                    \n                    f_r = k_r * (r - r_eq) - 12 * A / r_pow13\n                    fp_r = k_r + 312 * A / r_pow14\n                    \n                    # Newton-Raphson update\n                    delta_r = f_r / fp_r\n                    r -= delta_r\n                    \n                    if abs(delta_r) < tolerance:\n                        break\n                except (OverflowError, ZeroDivisionError):\n                    # Handle potential numerical instability, although not expected here\n                    # with good initial guess.\n                    # Fallback to a bisection method or report error if necessary.\n                    # For this problem, Newton's method is stable.\n                    return [np.nan] * 5\n\n            r_star = r\n\n        # At the energy minimum, r1* = r2* = r_star.\n        # The forces are the negative gradient of the potential energy. Since the\n        # geometry is optimized, the gradient components along the degrees of\n        # freedom (r1, r2) are zero, which leads to zero Cartesian forces.\n        r1_star = r_star\n        r2_star = r_star\n        force_o_mag = 0.0\n        force_h1_mag = 0.0\n        force_h2_mag = 0.0\n        \n        return [r1_star, r2_star, force_o_mag, force_h1_mag, force_h2_mag]\n\n    # Test suite from the problem statement\n    test_cases = [\n        {'k_r': 1882.8, 'r_eq': 0.9572, 'A': 0},           # Case 1\n        {'k_r': 1882.8, 'r_eq': 0.9572, 'A': 100000},      # Case 2\n        {'k_r': 18828.0, 'r_eq': 0.9572, 'A': 100000},     # Case 3\n    ]\n\n    all_results = []\n    for case in test_cases:\n        result = solve_case(case['k_r'], case['r_eq'], case['A'])\n        all_results.append(result)\n\n    # Format the output string as a list of lists of floats,\n    # with each float formatted to six decimal places.\n    output_str = \"[\" + \",\".join([\n        f\"[{','.join(f'{val:.6f}' for val in res)}]\" for res in all_results\n    ]) + \"]\"\n    \n    print(output_str)\n\nsolve()\n```"
        }
    ]
}