{
    "hands_on_practices": [
        {
            "introduction": "为了开始我们的实践探索，我们将从最简单的化学体系——双原子分子——入手。这个练习使用著名的Lennard-Jones势来寻找能使系统构型最稳定的理想原子间距。通过完成这个练习 ，你将掌握几何优化的一个核心原理：平衡结构是势能面上的一个独特点，它仅由原子间的相互作用性质决定。",
            "id": "2455319",
            "problem": "考虑一个三维空间中的双原子系统，其相互作用由约化单位下的 Lennard–Jones $12\\text{–}6$ 势来模拟。势能仅取决于标量原子间距 $r$，定义为 $r=\\lVert \\mathbf{r}_2-\\mathbf{r}_1\\rVert$，并由下式给出：\n\n$$\nE(r)=4\\varepsilon\\left[\\left(\\frac{\\sigma}{r}\\right)^{12}-\\left(\\frac{\\sigma}{r}\\right)^{6}\\right],\n$$\n\n其中 $\\varepsilon=1$ 且 $\\sigma=1$。距离必须以 $\\sigma$ 为单位表示，能量以 $\\varepsilon$ 为单位表示。本问题不使用角度。\n\n对于下面的每种初始构型（由以 $\\sigma$ 为单位的原子位置 $\\mathbf{r}_1$ 和 $\\mathbf{r}_2$ 组成），确定使 $E(r)$ 最小化的构型，并报告以 $\\sigma$ 为单位的优化后的原子间距 $r^\\star$。将报告的每个 $r^\\star$ 值四舍五入到小数点后六位。\n\n测试集（每行列出 $\\mathbf{r}_1$ 和 $\\mathbf{r}_2$）：\n\n- 情况 A（完全重叠）：$\\mathbf{r}_1=(0,0,0)$, $\\mathbf{r}_2=(0,0,0)$。\n- 情况 B（接近重叠）：$\\mathbf{r}_1=(0,0,0)$, $\\mathbf{r}_2=(10^{-12},0,0)$。\n- 情况 C（比平衡位置远）：$\\mathbf{r}_1=(0,0,0)$, $\\mathbf{r}_2=(3,0,0)$。\n- 情况 D（位于 Lennard–Jones 势阱最小值处）：$\\mathbf{r}_1=(0,0,0)$, $\\mathbf{r}_2=(2^{1/6},0,0)$。\n\n你的程序必须为每种情况计算 $r^\\star$。最终输出格式必须是单行，包含一个由方括号括起来的四个四舍五入值的逗号分隔列表，例如 $[r_A^\\star,r_B^\\star,r_C^\\star,r_D^\\star]$，其中每个 $r^\\star$ 是一个四舍五入到六位小数的十进制数，以 $\\sigma$ 为单位。",
            "solution": "问题要求确定使双原子系统势能最小化的原子间距 $r^\\star$。该相互作用由 Lennard-Jones $12\\text{–}6$ 势描述，在约化单位下，势阱深度 $\\varepsilon=1$，且粒子间势能为零时的有限距离 $\\sigma$ 也为 $1$。\n\n势能 $E$ 是标量原子间距 $r = \\lVert \\mathbf{r}_2 - \\mathbf{r}_1 \\rVert$ 的函数。其函数形式为：\n$$\nE(r) = 4\\varepsilon\\left[\\left(\\frac{\\sigma}{r}\\right)^{12}-\\left(\\frac{\\sigma}{r}\\right)^{6}\\right]\n$$\n在指定的约化单位 $\\varepsilon=1$ 和 $\\sigma=1$ 下，表达式简化为：\n$$\nE(r) = 4\\left[\\left(\\frac{1}{r}\\right)^{12} - \\left(\\frac{1}{r}\\right)^{6}\\right] = 4\\left(r^{-12} - r^{-6}\\right)\n$$\n为了找到最小能量的构型，我们必须找到使势能 $E(r)$ 达到最小值的 $r$ 值。这是微积分中的一个标准过程，即通过将函数对 $r$ 的一阶导数设为零来找到函数的临界点。\n$E(r)$ 的一阶导数是：\n$$\n\\frac{dE}{dr} = \\frac{d}{dr} \\left[ 4\\left(r^{-12} - r^{-6}\\right) \\right]\n$$\n应用幂函数求导法则：\n$$\n\\frac{dE}{dr} = 4 \\left( -12r^{-13} - (-6)r^{-7} \\right) = 4 \\left( -12r^{-13} + 6r^{-7} \\right)\n$$\n为了找到最小值，我们将此导数设为零（对于 $r0$）：\n$$\n4 \\left( -12r^{-13} + 6r^{-7} \\right) = 0\n$$\n由于 $4 \\neq 0$，我们必有：\n$$\n-12r^{-13} + 6r^{-7} = 0\n$$\n$$\n6r^{-7} = 12r^{-13}\n$$\n两边同除以 6 并乘以 $r^{13}$（这是允许的，因为最小值不可能在能量为无穷大的 $r=0$ 处）得到：\n$$\nr^6 = 2\n$$\n解出 $r$ 得到平衡距离 $r^\\star$：\n$$\nr^\\star = 2^{1/6}\n$$\n为确认这是一个最小值，必须检查二阶导数 $\\frac{d^2E}{dr^2}$。\n$$\n\\frac{d^2E}{dr^2} = 4 \\frac{d}{dr} \\left( -12r^{-13} + 6r^{-7} \\right) = 4 \\left( (-12)(-13)r^{-14} + (6)(-7)r^{-8} \\right) = 4 \\left( 156r^{-14} - 42r^{-8} \\right)\n$$\n代入 $r = r^\\star = 2^{1/6}$，我们有 $r^6 = 2$，因此 $r^8 = r^6 r^2 = 2 \\cdot (2^{1/6})^2 = 2 \\cdot 2^{1/3}$ 且 $r^{14} = r^{12} r^2 = (r^6)^2 r^2 = 4 \\cdot 2^{1/3}$。\n$$\n\\frac{d^2E}{dr^2}\\bigg|_{r=r^\\star} = 4 \\left( \\frac{156}{4 \\cdot 2^{1/3}} - \\frac{42}{2 \\cdot 2^{1/3}} \\right) = 4 \\left( \\frac{39}{2^{1/3}} - \\frac{21}{2^{1/3}} \\right) = \\frac{4 \\cdot 18}{2^{1/3}} = \\frac{72}{2^{1/3}}\n$$\n由于 $72  0$ 且 $2^{1/3}  0$，二阶导数为正。这证实了 $r^\\star = 2^{1/6}$ 对应一个局部最小值。由于这是 $r0$ 的唯一临界点，因此它也是全局最小值。\n\n$r^\\star = 2^{1/6}\\sigma$ 这个值是 Lennard-Jones 势的一个内禀属性。它代表了排斥力与吸引力完全平衡的唯一距离。这个平衡距离不依赖于原子的初始位置。任何几何优化算法，当应用于由该势控制的系统时，都会试图收敛到原子间距为 $r^\\star = 2^{1/6}$ 的状态。\n\n问题提供了四种初始构型：\n- 情况 A：$\\mathbf{r}_1=(0,0,0)$, $\\mathbf{r}_2=(0,0,0)$。初始距离为 $r=0$。在这一点，势能 $E(r)$ 未定义，表示一个奇点。物理上，这对应于一个无限排斥能的状态。这不是一个稳定的构型。问题要求的是使能量*最小化*的构型，它位于 $r^\\star$ 处，而不是奇点处。任何无穷小的位移都会导致系统向势阱最小值演化。因此，优化后的距离是 $r^\\star = 2^{1/6}$。\n- 情况 B：$\\mathbf{r}_1=(0,0,0)$, $\\mathbf{r}_2=(10^{-12},0,0)$。初始距离为 $r=10^{-12}$，这位于势能的陡峭排斥壁上 ($r \\ll r^\\star$)。系统将演化以增加其间距至 $r^\\star = 2^{1/6}$。\n- 情况 C：$\\mathbf{r}_1=(0,0,0)$, $\\mathbf{r}_2=(3,0,0)$。初始距离为 $r=3$，这位于势能的吸引区域 ($r  r^\\star$)。系统将演化以减小其间距至 $r^\\star = 2^{1/6}$。\n- 情况 D：$\\mathbf{r}_1=(0,0,0)$, $\\mathbf{r}_2=(2^{1/6},0,0)$。初始距离为 $r=2^{1/6}$，这恰好是平衡距离 $r^\\star$。系统已经处于其最小能量构型，所以优化后的距离是 $r^\\star = 2^{1/6}$。\n\n在所有四种情况下，使势能最小化的构型都具有相同的原子间距。因此，对于所有测试用例，最终的优化距离 $r^\\star$ 都是相同的。其数值为：\n$$\nr^\\star = 2^{1/6} \\approx 1.122462048309373\n$$\n四舍五入到小数点后六位，我们得到：\n$$\nr^\\star \\approx 1.122462\n$$\n对于这四种情况中的每一种，都必须报告此值。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the optimized interatomic distance for a diatomic system\n    modeled by the Lennard-Jones potential in reduced units.\n    \"\"\"\n\n    # The problem asks to find the geometry that minimizes the Lennard-Jones potential\n    # E(r) = 4 * epsilon * [(sigma/r)^12 - (sigma/r)^6].\n    # In reduced units, epsilon = 1 and sigma = 1.\n    # The minimum of this potential occurs at a specific distance r_star\n    # which can be found by setting the derivative dE/dr to zero.\n    # dE/dr = 4 * [-12/r^13 + 6/r^7] = 0\n    # = 6/r^7 = 12/r^13\n    # = r^6 = 12/6 = 2\n    # = r_star = 2^(1/6)\n    #\n    # This equilibrium distance r_star is an intrinsic property of the potential\n    # and is independent of the initial atomic positions. Therefore, the result\n    # will be the same for all test cases presented in the problem.\n\n    # Test cases are provided but not needed for the analytical solution.\n    # They are included here for completeness, as per the template.\n    test_cases = [\n        # Case A: r1=(0,0,0), r2=(0,0,0) - initial r=0\n        {'r1': np.array([0.0, 0.0, 0.0]), 'r2': np.array([0.0, 0.0, 0.0])},\n        # Case B: r1=(0,0,0), r2=(1e-12,0,0) - initial r=1e-12\n        {'r1': np.array([0.0, 0.0, 0.0]), 'r2': np.array([1e-12, 0.0, 0.0])},\n        # Case C: r1=(0,0,0), r2=(3,0,0) - initial r=3\n        {'r1': np.array([0.0, 0.0, 0.0]), 'r2': np.array([3.0, 0.0, 0.0])},\n        # Case D: r1=(0,0,0), r2=(2**(1/6),0,0) - initial r=2**(1/6)\n        {'r1': np.array([0.0, 0.0, 0.0]), 'r2': np.array([2**(1/6), 0.0, 0.0])},\n    ]\n\n    # Calculate the optimized distance analytically.\n    # This is r_star = (2)^(1/6) in units of sigma.\n    r_star = 2**(1/6)\n\n    results = []\n    # The result is the same for all cases.\n    for _ in test_cases:\n        # The optimized distance is independent of the starting geometry.\n        # The value is rounded to six decimal places as required.\n        rounded_r_star = round(r_star, 6)\n        results.append(str(rounded_r_star))\n\n    # The final output format must be a single line containing a\n    # comma-separated list of the four rounded values enclosed in square brackets.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在用一个简单体系掌握了基础知识之后，我们现在进入一个更真实、更复杂的场景，这涉及到一种配合物。这个问题  模拟了铜配合物中的Jahn-Teller效应，你将需要最小化一个依赖于多个键长的能量函数。这个实践展示了几何优化如何成为一个强大的工具，用以预测和解释在真实分子中观察到的细微结构畸变。",
            "id": "2455327",
            "problem": "考虑六水合铜(II)配合物 $[ \\mathrm{Cu}(\\mathrm{H}_2\\mathrm{O})_6 ]^{2+}$，在理想的八面体环境中，它有 $6$ 个等价的金属-配体键长。由于 Jahn–Teller (JT) 效应，该配合物会发生四方畸变，使得两个轴向键与四个平面键产生差异。将总势能建模为谐振子键伸缩项与一个稳定四方畸变的线性振动耦合项之和。设两个轴向 $\\mathrm{Cu}-\\mathrm{O}$ 键的共同长度为 $r_a$，四个平面 $\\mathrm{Cu}-\\mathrm{O}$ 键的共同长度为 $r_e$。设 $r_0$ 表示参考的未畸变键长。设 $k_a$ 和 $k_e$ 分别表示轴向和平面谐振力常数。设 $g \\ge 0$ 表示与四方模式相关的线性 Jahn–Teller 耦合强度。总能量作为 $r_a$ 和 $r_e$ 的函数为\n$$\nE(r_a,r_e) \\;=\\; 2 \\cdot \\frac{1}{2} k_a \\left(r_a - r_0\\right)^2 \\;+\\; 4 \\cdot \\frac{1}{2} k_e \\left(r_e - r_0\\right)^2 \\;-\\; g \\,\\big(r_a - r_e\\big).\n$$\n所有距离 $r_a$、$r_e$ 和 $r_0$ 必须以埃（写作 $\\text{\\AA}$）为单位表示，所有能量必须以 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$ 为单位表示。参数 $k_a$ 和 $k_e$ 的单位为 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\text{\\AA}^{-2}$，$g$ 的单位为 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\text{\\AA}^{-1}$。该模型中不出现角度。将四方畸变振幅定义为 $Q = r_a - r_e$。\n\n任务：对于下面测试套件中的每一组参数，确定使 $E(r_a,r_e)$ 最小化的唯一对 $\\big(r_a^\\star, r_e^\\star\\big)$，然后计算 $Q^\\star = r_a^\\star - r_e^\\star$ 和 $E^\\star = E(r_a^\\star, r_e^\\star)$。将 $r_a^\\star$、$r_e^\\star$ 和 $Q^\\star$ 以埃为单位表示，$E^\\star$ 以 $\\mathrm{kJ}\\,\\mathrm{mol}^{-1}$ 为单位表示。将报告的每个实数四舍五入到 $6$ 位小数。\n\n测试套件（每个元组为 $\\big(r_0, k_a, k_e, g\\big)$，单位为 $\\big(\\text{\\AA}, \\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\text{\\AA}^{-2}, \\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\text{\\AA}^{-2}, \\mathrm{kJ}\\,\\mathrm{mol}^{-1}\\,\\text{\\AA}^{-1}\\big)$）：\n- 情况 1：$\\big(2.00, 200, 250, 50\\big)$\n- 情况 2：$\\big(2.05, 300, 300, 0\\big)$\n- 情况 3：$\\big(1.98, 150, 1000, 60\\big)$\n- 情况 4：$\\big(2.00, 200, 200, 400\\big)$\n\n最终输出格式：您的程序应生成单行输出，其中包含一个结果列表，每个测试用例一个结果，每个结果是列表 $\\big[r_a^\\star, r_e^\\star, Q^\\star, E^\\star\\big]$。总输出必须是这些列表的单个逗号分隔列表，并用方括号括起来，例如 $[\\,[r_{a,1}^\\star,r_{e,1}^\\star,Q_1^\\star,E_1^\\star],\\,[r_{a,2}^\\star,r_{e,2}^\\star,Q_2^\\star,E_2^\\star],\\,\\dots\\,]$，每个实数四舍五入到 $6$ 位小数，不含任何额外文本。",
            "solution": "问题陈述已经过严格验证，并被确定为有效。它在科学上基于配位化学的原理，特别是 Jahn-Teller 效应，并使用标准的谐振子和线性耦合近似进行建模。该问题在数学上是适定的，提供了一个双变量的凸二次能量函数，保证了唯一全局最小值的存在。所有参数和常数都用一致的物理单位清晰定义，目标明确。因此，我们可以着手推导解。\n\n任务是找到使六水合铜(II)配合物的总势能函数 $E(r_a, r_e)$ 最小化的平衡几何构型 $(r_a^\\star, r_e^\\star)$。能量由以下公式给出：\n$$\nE(r_a,r_e) \\;=\\; k_a \\left(r_a - r_0\\right)^2 \\;+\\; 2 k_e \\left(r_e - r_0\\right)^2 \\;-\\; g \\,\\big(r_a - r_e\\big)\n$$\n其中 $r_a$ 是轴向键长，$r_e$ 是平面键长，$r_0$ 是参考键长，$k_a$ 和 $k_e$ 是谐振力常数，$g$ 是振动耦合常数。\n\n为了找到这个可微函数的最小值，我们必须找到 $E$ 相对于坐标 $(r_a, r_e)$ 的梯度为零向量的临界点。这需要将 $E(r_a, r_e)$ 对 $r_a$ 和 $r_e$ 的偏导数设为零。\n\n首先，我们计算关于 $r_a$ 的偏导数：\n$$\n\\frac{\\partial E}{\\partial r_a} \\;=\\; \\frac{\\partial}{\\partial r_a} \\left[ k_a \\left(r_a - r_0\\right)^2 \\;+\\; 2 k_e \\left(r_e - r_0\\right)^2 \\;-\\; g \\,\\big(r_a - r_e\\big) \\right]\n$$\n$$\n\\frac{\\partial E}{\\partial r_a} \\;=\\; 2 k_a (r_a - r_0) \\;-\\; g\n$$\n接下来，我们计算关于 $r_e$ 的偏导数：\n$$\n\\frac{\\partial E}{\\partial r_e} \\;=\\; \\frac{\\partial}{\\partial r_e} \\left[ k_a \\left(r_a - r_0\\right)^2 \\;+\\; 2 k_e \\left(r_e - r_0\\right)^2 \\;-\\; g \\,\\big(r_a - r_e\\big) \\right]\n$$\n$$\n\\frac{\\partial E}{\\partial r_e} \\;=\\; 4 k_e (r_e - r_0) \\;+\\; g\n$$\n在最小值点 $(r_a^\\star, r_e^\\star)$，这些偏导数必须等于零，这给了我们一个关于两个未知数 $r_a^\\star$ 和 $r_e^\\star$ 的二元线性方程组：\n$$\n\\begin{cases}\n2 k_a (r_a^\\star - r_0) - g = 0 \\\\\n4 k_e (r_e^\\star - r_0) + g = 0\n\\end{cases}\n$$\n解第一个方程得到 $r_a^\\star$：\n$$\n2 k_a (r_a^\\star - r_0) = g \\;\\implies\\; r_a^\\star - r_0 = \\frac{g}{2 k_a} \\;\\implies\\; r_a^\\star = r_0 + \\frac{g}{2 k_a}\n$$\n解第二个方程得到 $r_e^\\star$：\n$$\n4 k_e (r_e^\\star - r_0) = -g \\;\\implies\\; r_e^\\star - r_0 = -\\frac{g}{4 k_e} \\;\\implies\\; r_e^\\star = r_0 - \\frac{g}{4 k_e}\n$$\n这些表达式提供了作为输入参数函数的优化键长 $r_a^\\star$ 和 $r_e^\\star$。最小值的存在由二阶导数的黑塞矩阵证实，对于正的力常数 $k_a  0$ 和 $k_e  0$，该矩阵是正定的。\n\n确定了最优键长后，我们可以计算所需的量：\n1.  最优四方畸变振幅，$Q^\\star$：\n    $$\n    Q^\\star = r_a^\\star - r_e^\\star = \\left( r_0 + \\frac{g}{2 k_a} \\right) - \\left( r_0 - \\frac{g}{4 k_e} \\right) = g \\left( \\frac{1}{2 k_a} + \\frac{1}{4 k_e} \\right)\n    $$\n2.  最小能量，$E^\\star = E(r_a^\\star, r_e^\\star)$。我们将 $(r_a^\\star - r_0)$ 和 $(r_e^\\star - r_0)$ 的表达式代回原始能量函数：\n    $$\n    E^\\star = k_a \\left(\\frac{g}{2 k_a}\\right)^2 + 2 k_e \\left(-\\frac{g}{4 k_e}\\right)^2 - g (r_a^\\star - r_e^\\star)\n    $$\n    代入 $Q^\\star = r_a^\\star - r_e^\\star$ 的表达式：\n    $$\n    E^\\star = k_a \\frac{g^2}{4 k_a^2} + 2 k_e \\frac{g^2}{16 k_e^2} - g \\left[ g \\left( \\frac{1}{2 k_a} + \\frac{1}{4 k_e} \\right) \\right]\n    $$\n    $$\n    E^\\star = \\frac{g^2}{4 k_a} + \\frac{g^2}{8 k_e} - \\frac{g^2}{2 k_a} - \\frac{g^2}{4 k_e}\n    $$\n    $$\n    E^\\star = g^2 \\left( \\frac{1}{4 k_a} - \\frac{2}{4 k_a} \\right) + g^2 \\left( \\frac{1}{8 k_e} - \\frac{2}{8 k_e} \\right)\n    $$\n    $$\n    E^\\star = -g^2 \\left( \\frac{1}{4 k_a} + \\frac{1}{8 k_e} \\right)\n    $$\n这个 $E^\\star$ 的最终表达式代表了 Jahn-Teller 稳定化能。计算实现将使用这些推导出的公式来计算每个测试用例所需的值。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the optimized geometry and energy for the Jahn-Teller distorted\n    [Cu(H2O)6]2+ complex based on a simplified potential energy model.\n    \"\"\"\n    \n    # Define the test cases from the problem statement.\n    # Each tuple is (r0, ka, ke, g)\n    test_cases = [\n        (2.00, 200, 250, 50),\n        (2.05, 300, 300, 0),\n        (1.98, 150, 1000, 60),\n        (2.00, 200, 200, 400),\n    ]\n\n    all_results_as_strings = []\n    \n    for case in test_cases:\n        r0, ka, ke, g = case\n        \n        # Ensure force constants are not zero to avoid division by zero error,\n        # which is physically required anyway.\n        if ka == 0 or ke == 0:\n            # This case would be physically invalid.\n            # For this problem's scope, we assume ka  0 and ke  0.\n            continue\n\n        # Calculate optimal axial bond length r_a*\n        # r_a_star = r0 + g / (2 * k_a)\n        ra_star = r0 + g / (2.0 * ka)\n        \n        # Calculate optimal equatorial bond length r_e*\n        # r_e_star = r0 - g / (4 * k_e)\n        re_star = r0 - g / (4.0 * ke)\n        \n        # Calculate optimal tetragonal distortion amplitude Q*\n        # Q* = r_a* - r_e*\n        q_star = ra_star - re_star\n        \n        # Calculate the minimum energy E*\n        # E* = -g^2 * (1/(4*k_a) + 1/(8*k_e))\n        e_star = -(g**2) * (1.0 / (4.0 * ka) + 1.0 / (8.0 * ke))\n        \n        # Format the results for the current case as a string\n        # Each number is rounded to 6 decimal places.\n        # e.g., '[2.125000,1.950000,0.175000,-4.375000]'\n        case_string = (\n            f\"[{ra_star:.6f},{re_star:.6f},{q_star:.6f},{e_star:.6f}]\"\n        )\n        all_results_as_strings.append(case_string)\n\n    # Final print statement in the exact required format.\n    # e.g., '[[...],[...],...]'\n    final_output = f\"[{','.join(all_results_as_strings)}]\"\n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "现在我们已经练习了如何寻找能量最低点，接下来让我们探讨这个数学点背后深刻的物理意义。这个练习  要求你优化一个受约束的分子模型，并分析其上的原子受力。通过这个过程，你将揭示计算化学中的一个基本事实：一个优化的几何构型，正是每个原子上净作用力为零的构型，代表了一种完美的力学平衡状态。",
            "id": "2455389",
            "problem": "给定一个水分子的平面三原子模型，其中包含一个氧原子（O）和两个氢原子（H）。该分子在三维笛卡尔空间中建模，其坐标受到约束，使得 H–O–H 键角恰好为 $180^\\circ$（共线构型）。在此完整约束下，将氧原子固定在原点，并将氢原子放置在 $x$ 轴上的位置 $\\mathbf{r}_{\\mathrm{H}_1} = (r_1, 0, 0)$ 和 $\\mathbf{r}_{\\mathrm{H}_2} = (-r_2, 0, 0)$，其中 $r_1  0$ 且 $r_2  0$。因此，通过构造，H–O–H 键角恰好为 $180^\\circ$。\n\n分子内势能定义为两个谐振 O–H 键伸缩项与一个可选的十二次方反比纯排斥氢-氢相互作用之和。总能量作为 $(r_1, r_2)$ 的函数为\n$$\nE(r_1, r_2) \\;=\\; \\tfrac{1}{2} k_r \\left[(r_1 - r_{\\mathrm{eq}})^2 + (r_2 - r_{\\mathrm{eq}})^2\\right] \\;+\\; \\frac{A}{(d_{\\mathrm{HH}})^{12}},\n$$\n其中 $k_r$ 是 O–H 键的力常数，单位为千焦/摩尔/平方埃，$r_{\\mathrm{eq}}$ 是 O–H 的平衡键长，单位为埃，$A$ 是排斥参数，单位为千焦·埃的十二次方/摩尔，$d_{\\mathrm{HH}} = r_1 + r_2$ 是 H–H 间距，单位为埃。\n\n任务：\n- 对于下面测试套件中的每一组参数，确定在保持 H–O–H 键角恰好为 $180^\\circ$（即如上所定义的位置）的条件下，使 $E(r_1, r_2)$ 最小化且满足 $r_1  0$ 和 $r_2  0$ 的约束几何构型。\n- 在优化后的几何构型上，计算每个原子上的残余笛卡尔力，该力是总能量相对于相应笛卡尔坐标的负梯度。由于共线约束，垂直于 $x$ 轴的力分量根据构造必须为零；报告 O、H$_1$ 和 H$_2$ 上残余力的模（每个都是非负标量）。力的模以千焦/摩尔/埃为单位表示。\n- 报告优化后的键长 $r_1^\\star$ 和 $r_2^\\star$，单位为埃。\n\n物理单位：\n- 所有距离使用埃。\n- 能量使用千焦/摩尔。\n- 力的模使用千焦/摩尔/埃。\n- 角度约束以度为单位指定为 $180^\\circ$。\n\n测试套件（三种情况）：\n- 情况 1：$k_r = 1882.8$, $r_{\\mathrm{eq}} = 0.9572$, $A = 0$。\n- 情况 2：$k_r = 1882.8$, $r_{\\mathrm{eq}} = 0.9572$, $A = 100000$。\n- 情况 3：$k_r = 18828.0$, $r_{\\mathrm{eq}} = 0.9572$, $A = 100000$。\n\n答案规格：\n- 对于每种情况，按以下顺序输出一个包含五个浮点数的列表：$[r_1^\\star, r_2^\\star, \\|\\mathbf{F}_{\\mathrm{O}}\\|, \\|\\mathbf{F}_{\\mathrm{H}_1}\\|, \\|\\mathbf{F}_{\\mathrm{H}_2}\\|]$，其中 $\\|\\cdot\\|$ 表示作用在该原子上的力的欧几里得模。\n- 将所有情况的结果汇总到单行中，该行包含一个由这些按情况分类的列表组成的列表，顺序与测试套件中的顺序相同。您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表形式的结果（例如，“[[a,b,c,d,e],[...],[...]]”）。每个浮点数应四舍五入到六位小数。",
            "solution": "所给问题是计算化学中的一个标准练习，涉及约束分子系统的势能函数最小化。该问题在科学上是合理的，定义明确，并包含解决问题所需的所有信息。我将开始解题。\n\n目标是找到由 O-H 键长 $r_1  0$ 和 $r_2  0$ 定义的几何构型，该构型能使势能函数 $E(r_1, r_2)$ 最小化。能量函数为：\n$$\nE(r_1, r_2) = \\frac{1}{2} k_r \\left[(r_1 - r_{\\mathrm{eq}})^2 + (r_2 - r_{\\mathrm{eq}})^2\\right] + \\frac{A}{(r_1 + r_2)^{12}}\n$$\n可微函数的最小值出现在梯度为零的临界点。因此，我们必须求解一个方程组，其中 $E$ 对 $r_1$ 和 $r_2$ 的偏导数均为零。\n\n首先，我们计算偏导数：\n$$\n\\frac{\\partial E}{\\partial r_1} = k_r (r_1 - r_{\\mathrm{eq}}) - \\frac{12A}{(r_1 + r_2)^{13}}\n$$\n$$\n\\frac{\\partial E}{\\partial r_2} = k_r (r_2 - r_{\\mathrm{eq}}) - \\frac{12A}{(r_1 + r_2)^{13}}\n$$\n\n将这些导数设为零，得到能量最小值的条件：\n$$\nk_r (r_1 - r_{\\mathrm{eq}}) = \\frac{12A}{(r_1 + r_2)^{13}} \\quad (1)\n$$\n$$\nk_r (r_2 - r_{\\mathrm{eq}}) = \\frac{12A}{(r_1 + r_2)^{13}} \\quad (2)\n$$\n\n通过令表达式 $(1)$ 和 $(2)$ 相等，我们发现：\n$$\nk_r (r_1 - r_{\\mathrm{eq}}) = k_r (r_2 - r_{\\mathrm{eq}})\n$$\n由于力常数 $k_r$ 非零，这意味着 $r_1 - r_{\\mathrm{eq}} = r_2 - r_{\\mathrm{eq}}$，可简化为 $r_1 = r_2$。势能函数的对称性决定了最小能量几何构型必须是对称的，具有相等的 O-H 键长。\n\n令 $r_1^\\star = r_2^\\star = r^\\star$。这个由两个方程组成的方程组简化为关于最优键长 $r^\\star$ 的单个非线性方程：\n$$\nk_r (r^\\star - r_{\\mathrm{eq}}) = \\frac{12A}{(2r^\\star)^{13}}\n$$\n\n我们现在对每种给定情况求解这个方程。\n\n**情况 1：** $k_r = 1882.8$, $r_{\\mathrm{eq}} = 0.9572$, $A = 0$。\n当 $A=0$ 时，方程简化为：\n$$\nk_r (r^\\star - r_{\\mathrm{eq}}) = 0\n$$\n由于 $k_r \\neq 0$，解为 $r^\\star = r_{\\mathrm{eq}}$。\n因此，$r_1^\\star = r_2^\\star = 0.9572\\,\\text{\\AA}$。\n\n**情况 2 和 3：** $A  0$。\n该方程是非线性的，需要数值解。我们定义一个函数 $f(r)$，使其根为所求的解 $r^\\star$：\n$$\nf(r) = k_r (r - r_{\\mathrm{eq}}) - \\frac{12A}{(2r)^{13}} = 0\n$$\n找到根的一个有效方法是牛顿-拉夫逊算法，它使用以下迭代更新规则：\n$$\nr_{n+1} = r_n - \\frac{f(r_n)}{f'(r_n)}\n$$\n导数 $f'(r)$ 为：\n$$\nf'(r) = \\frac{d}{dr} \\left( k_r (r - r_{\\mathrm{eq}}) - 12A(2r)^{-13} \\right) = k_r - 12A(-13)(2r)^{-14}(2) = k_r + \\frac{312A}{(2r)^{14}}\n$$\n从初始猜测 $r_0 = r_{\\mathrm{eq}}$ 开始，我们进行迭代，直到收敛到足够的精度。在提供的代码中实现了此过程，以找到情况 2 和情况 3 的 $r^\\star$。\n\n接下来，我们必须计算每个原子上的残余笛卡尔力。作用在原子 $i$ 上的力 $\\mathbf{F}_i$ 是势能 $E$ 相对于其笛卡尔坐标 $\\mathbf{r}_i$ 的负梯度：\n$$\n\\mathbf{F}_i = -\\nabla_{\\mathbf{r}_i} E\n$$\n坐标定义为 $\\mathbf{r}_{\\mathrm{O}} = (0,0,0)$、$\\mathbf{r}_{\\mathrm{H}_1} = (r_1, 0, 0)$ 和 $\\mathbf{r}_{\\mathrm{H}_2} = (-r_2, 0, 0)$。能量 $E$ 是作为 $r_1$ 和 $r_2$ 的函数给出的。参数 $r_1$ 和 $r_2$ 是系统仅有的自由度。所以，我们通过链式法则将笛卡尔坐标导数与内坐标导数联系起来。\n对于氢原子 H$_1$，力为：\n$$\n\\mathbf{F}_{\\mathrm{H}_1} = -\\nabla_{\\mathbf{r}_{\\mathrm{H}_1}} E = -\\left( \\frac{\\partial E}{\\partial r_1} \\frac{\\partial r_1}{\\partial \\mathbf{r}_{\\mathrm{H}_1}} + \\frac{\\partial E}{\\partial r_2} \\frac{\\partial r_2}{\\partial \\mathbf{r}_{\\mathrm{H}_1}} \\right)\n$$\n在给定的坐标系中，$r_1 = x_1 = \\|\\mathbf{r}_{\\mathrm{H}_1}\\|$，以及 $r_2 = -x_2 = \\|\\mathbf{r}_{\\mathrm{H}_2}\\|$。因此，$r_1$ 仅依赖于 $\\mathbf{r}_{\\mathrm{H}_1}$，$r_2$ 仅依赖于 $\\mathbf{r}_{\\mathrm{H}_2}$。这简化了表达式：\n$\\frac{\\partial r_1}{\\partial \\mathbf{r}_{\\mathrm{H}_1}} = \\mathbf{\\hat{x}}$ 且 $\\frac{\\partial r_2}{\\partial \\mathbf{r}_{\\mathrm{H}_1}} = \\mathbf{0}$。\n所以，$\\mathbf{F}_{\\mathrm{H}_1} = - \\frac{\\partial E}{\\partial r_1} \\mathbf{\\hat{x}}$。\n\n同样，对于氢原子 H$_2$：\n$\\frac{\\partial r_1}{\\partial \\mathbf{r}_{\\mathrm{H}_2}} = \\mathbf{0}$ 且 $\\frac{\\partial r_2}{\\partial \\mathbf{r}_{\\mathrm{H}_2}} = -\\mathbf{\\hat{x}}$。\n所以，$\\mathbf{F}_{\\mathrm{H}_2} = - \\frac{\\partial E}{\\partial r_2} (-\\mathbf{\\hat{x}}) = \\frac{\\partial E}{\\partial r_2} \\mathbf{\\hat{x}}$。\n\n对于氧原子，其位置在定义 $r_1$ 和 $r_2$ 时被视作原点。它上面的力来自于它与两个氢原子的相互作用：\n$\\mathbf{F}_{\\mathrm{O}} = - \\frac{\\partial E}{\\partial r_1} \\frac{\\partial r_1}{\\partial \\mathbf{r}_{\\mathrm{O}}} - \\frac{\\partial E}{\\partial r_2} \\frac{\\partial r_2}{\\partial \\mathbf{r}_{\\mathrm{O}}}$。\n$\\frac{\\partial r_1}{\\partial \\mathbf{r}_{\\mathrm{O}}} = -\\mathbf{\\hat{x}}$ 且 $\\frac{\\partial r_2}{\\partial \\mathbf{r}_{\\mathrm{O}}} = \\mathbf{\\hat{x}}$。\n所以，$\\mathbf{F}_{\\mathrm{O}} = - \\frac{\\partial E}{\\partial r_1} (-\\mathbf{\\hat{x}}) - \\frac{\\partial E}{\\partial r_2} (\\mathbf{\\hat{x}}) = \\left(\\frac{\\partial E}{\\partial r_1} - \\frac{\\partial E}{\\partial r_2}\\right) \\mathbf{\\hat{x}}$。\n\n在优化后的几何构型 $(r_1^\\star, r_2^\\star)$ 处，根据定义我们有 $\\frac{\\partial E}{\\partial r_1} = 0$ 和 $\\frac{\\partial E}{\\partial r_2} = 0$。\n将这些条件代入力表达式中：\n$$\n\\mathbf{F}_{\\mathrm{H}_1} = - (0) \\mathbf{\\hat{x}} = \\mathbf{0}\n$$\n$$\n\\mathbf{F}_{\\mathrm{H}_2} = (0) \\mathbf{\\hat{x}} = \\mathbf{0}\n$$\n$$\n\\mathbf{F}_{\\mathrm{O}} = (0 - 0) \\mathbf{\\hat{x}} = \\mathbf{0}\n$$\n因此，每个原子上的残余笛卡尔力恒为零。这是系统处于由给定自由度定义的势能面最小值的基本结果。因此，力的模为 $\\|\\mathbf{F}_{\\mathrm{O}}\\| = 0$、$\\|\\mathbf{F}_{\\mathrm{H}_1}\\| = 0$ 和 $\\|\\mathbf{F}_{\\mathrm{H}_2}\\| = 0$。\n\n最终结果通过计算每种情况下的 $r^\\star$ 并报告相应的五个值的列表来获得。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves for the optimized geometry and residual forces for a colinear triatomic\n    molecule based on a given potential energy function.\n    \"\"\"\n\n    def solve_case(k_r, r_eq, A):\n        \"\"\"\n        Calculates the optimized bond length r* for a given set of parameters.\n        The forces at the optimum are always zero by definition of the energy minimum.\n\n        Args:\n            k_r (float): Bond force constant.\n            r_eq (float): Equilibrium bond length.\n            A (float): Repulsive parameter.\n\n        Returns:\n            list: A list of floats [r1*, r2*, ||F_O||, ||F_H1||, ||F_H2||].\n        \"\"\"\n        if A == 0:\n            r_star = r_eq\n        else:\n            # Solve the nonlinear equation for r using Newton-Raphson method\n            # f(r) = k_r * (r - r_eq) - 12 * A / (2*r)**13 = 0\n            # f'(r) = k_r + 312 * A / (2*r)**14\n            \n            r = r_eq  # Initial guess\n            \n            # Using a very small tolerance for high precision convergence.\n            tolerance = 1e-15\n            max_iterations = 100\n            \n            for _ in range(max_iterations):\n                # Calculate function value f(r) and its derivative f'(r)\n                try:\n                    r_pow13 = (2 * r)**13\n                    r_pow14 = r_pow13 * (2 * r)\n                    \n                    f_r = k_r * (r - r_eq) - 12 * A / r_pow13\n                    fp_r = k_r + 312 * A / r_pow14\n                    \n                    # Newton-Raphson update\n                    delta_r = f_r / fp_r\n                    r -= delta_r\n                    \n                    if abs(delta_r)  tolerance:\n                        break\n                except (OverflowError, ZeroDivisionError):\n                    # Handle potential numerical instability, although not expected here\n                    # with good initial guess.\n                    # Fallback to a bisection method or report error if necessary.\n                    # For this problem, Newton's method is stable.\n                    return [np.nan] * 5\n\n            r_star = r\n\n        # At the energy minimum, r1* = r2* = r_star.\n        # The forces are the negative gradient of the potential energy. Since the\n        # geometry is optimized, the gradient components along the degrees of\n        # freedom (r1, r2) are zero, which leads to zero Cartesian forces.\n        r1_star = r_star\n        r2_star = r_star\n        force_o_mag = 0.0\n        force_h1_mag = 0.0\n        force_h2_mag = 0.0\n        \n        return [r1_star, r2_star, force_o_mag, force_h1_mag, force_h2_mag]\n\n    # Test suite from the problem statement\n    test_cases = [\n        {'k_r': 1882.8, 'r_eq': 0.9572, 'A': 0},           # Case 1\n        {'k_r': 1882.8, 'r_eq': 0.9572, 'A': 100000},      # Case 2\n        {'k_r': 18828.0, 'r_eq': 0.9572, 'A': 100000},     # Case 3\n    ]\n\n    all_results = []\n    for case in test_cases:\n        result = solve_case(case['k_r'], case['r_eq'], case['A'])\n        all_results.append(result)\n\n    # Format the output string as a list of lists of floats,\n    # with each float formatted to six decimal places.\n    output_str = \"[\" + \",\".join([\n        f\"[{','.join(f'{val:.6f}' for val in res)}]\" for res in all_results\n    ]) + \"]\"\n    \n    print(output_str)\n\nsolve()\n```"
        }
    ]
}