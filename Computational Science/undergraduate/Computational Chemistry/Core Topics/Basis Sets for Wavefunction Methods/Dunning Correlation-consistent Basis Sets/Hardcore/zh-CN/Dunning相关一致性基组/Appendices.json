{
    "hands_on_practices": [
        {
            "introduction": "为了真正掌握相关一致性基组，了解其构建的内在逻辑至关重要。这个练习将引导你根据 Dunning 的设计原则，通过算法来确定 cc-pVDZ 基组的壳层结构 。这不仅是一个编程挑战，更是一次深入理解相关一致性基组系统性设计思想的机会，它将揭示诸如价层、极化函数和核心函数等概念是如何共同定义一个基组的。",
            "id": "2454399",
            "problem": "您需要实现一个程序，该程序模拟 Dunning 的相关一致极化价层双泽塔 (cc-pVDZ) 基组中，原子序数 $Z$ 从 $1$ 到 $18$ 的主族元素的壳层数量构建过程。目标是为每个 $Z$ 返回按角动量类型划分的收缩高斯型轨道壳层数，编码为有序三元组 $[n_s,n_p,n_d]$，其中 $n_s$ 是 $s$ 型壳层的数量，$n_p$ 是 $p$ 型壳层的数量，$n_d$ 是 $d$ 型壳层的数量。\n\n请从以下基本原理和定义开始：\n\n- 在主族原子的相关一致价层 $n$-泽塔 (cc-pV$n$Z) 设计中，价空间由每个价角动量通道的 $n$ 个收缩径向函数以及在下一个更高角动量 ($\\ell_{\\max}+1$) 上的一个附加极化壳层来表示。对于 cc-pVDZ，有 $n=2$。\n- 对于 $Z \\le 18$ 的主族元素，价壳层中的最高占据角动量 $\\ell_{\\max}$ 通过电子排布以简化的方式确定：\n  - 周期 $1$ ($Z \\in \\{1,2\\}$)：价通道 $\\{s\\}$ (即 $\\ell_{\\max}=0$)。\n  - 周期 $2$ ($Z \\in \\{3,4\\}$)：价通道 $\\{s\\}$；($Z \\in \\{5,6,7,8,9,10\\}$)：价通道 $\\{s,p\\}$ (即 $\\ell_{\\max}=1$)。\n  - 周期 $3$ ($Z \\in \\{11,12\\}$)：价通道 $\\{s\\}$；($Z \\in \\{13,14,15,16,17,18\\}$)：价通道 $\\{s,p\\}$ (即 $\\ell_{\\max}=1$)。\n- 对于 cc-pVDZ ($n=2$)，为每个存在的价角动量通道分配 $2$ 个收缩壳层。\n- 在角动量 $\\ell_{\\max}+1$ 处精确添加一个极化壳层：如果 $\\ell_{\\max}=0$，则添加一个 $p$ 壳层；如果 $\\ell_{\\max}=1$，则添加一个 $d$ 壳层。\n- 为给内层闭合 $1s$ 核提供最小的径向灵活性，为所有 $Z \\ge 3$ 的元素额外包含一个紧凑 $s$ 壳层。\n\n您的任务是利用这些原理，算法化地构建一个函数 $build\\_cc\\_pvdz(Z)$，该函数为每个 $Z \\in \\{1,2,\\dots,18\\}$ 返回有序三元组 $[n_s,n_p,n_d]$。您不能硬编码一个查找表；相反，您必须实现上述原理所蕴含的逻辑。\n\n测试套件：\n使用以下测试值 $Z$：$[1,2,3,6,10,11,14,18]$。\n\n输出规范：\n- 对于测试套件中的每个输入 $Z$，使用上述规则计算 $[n_s,n_p,n_d]$。\n- 您的程序应生成单行输出，其中包含一个方括号括起来的逗号分隔列表形式的结果，列表中的每一项本身都是一个包含三个整数的列表。具体来说，如果八个测试值的结果是三元组 $r_1,r_2,\\dots,r_8$，那么确切的输出必须是与 Python 列表 $[r_1,r_2,\\dots,r_8]$ 的字符串表示形式相等的单行，例如，`[[a_1,a_2,a_3],[b_1,b_2,b_3],\\dots]`，其中每个 $a_i, b_i$ 都是整数。",
            "solution": "问题陈述已经过分析，并被确定为有效。它在科学上基于量子化学的原理，特别是相关一致基组的构建方法。该问题是适定的、客观的，并包含充分、一致的信息来推导出一个唯一的算法解。\n\n目标是制定一个算法，用于计算原子序数 $Z$ 从 $1$ 到 $18$ 的主族元素的 cc-pVDZ 基组的收缩高斯型轨道壳层数，表示为三元组 $[n_s, n_p, n_d]$。推导必须基于所提供的第一性原理，而不是经验数据或预先计算的查找表。\n\n对于给定的原子序数 $Z$，逻辑按一系列确定性步骤进行。\n\n1.  **初始化**：我们从每种角动量类型的零个壳层开始：$n_s = 0$，$n_p = 0$，$n_d = 0$。\n\n2.  **价空间和 $\\ell_{\\max}$ 的确定**：相关一致基组的构建始于识别价轨道。问题根据 $Z$ 定义了价空间。价壳层中的最高角动量量子数记为 $\\ell_{\\max}$。\n    - 对于周期 $1$ ($Z \\in \\{1, 2\\}$)、周期 $2$ 的 s 区 ($Z \\in \\{3, 4\\}$) 和周期 $3$ 的 s 区 ($Z \\in \\{11, 12\\}$) 的元素，价空间仅由 $s$ 轨道组成。因此，对于这些元素，$\\ell_{\\max} = 0$。\n    - 对于周期 $2$ 的 p 区 ($Z \\in \\{5, \\dots, 10\\}$) 和周期 $3$ 的 p 区 ($Z \\in \\{13, \\dots, 18\\}$) 的元素，价空间包括 $s$ 和 $p$ 轨道。对于这些元素，$\\ell_{\\max} = 1$。\n\n3.  **价壳层的分配**：cc-pVDZ 基组具有“双泽塔”品质，对应于 cc-pV$n$Z 命名法中的 $n=2$。这意味着为每个价角动量通道分配两个收缩函数（壳层）。\n    - 所有指定元素 ($Z \\in \\{1, \\dots, 18\\}$) 都有一个价 $s$ 通道。因此，我们将 $s$ 壳层数增加 $2$：$n_s \\leftarrow n_s + 2$。\n    - 对于 $\\ell_{\\max} = 1$ 的元素，还存在一个价 $p$ 通道。对于这些元素，我们将 $p$ 壳层数增加 $2$：$n_p \\leftarrow n_p + 2$。\n\n4.  **极化壳层的分配**：为了准确描述电子相关和分子成键，添加了一组极化函数。这些函数的角动量为 $\\ell_{\\max} + 1$。\n    - 如果 $\\ell_{\\max} = 0$，极化函数为 $p$ 型 ($\\ell = 1$)。我们将 $p$ 壳层数增加 $1$：$n_p \\leftarrow n_p + 1$。\n    - 如果 $\\ell_{\\max} = 1$，极化函数为 $d$ 型 ($\\ell = 2$)。我们将 $d$ 壳层数增加 $1$：$n_d \\leftarrow n_d + 1$。\n\n5.  **核壳层的分配**：对于 $Z \\ge 3$ 的元素，存在一个填满的 $1s$ 核电子壳层。为了提供足够的灵活性来描述这个核，基组中包含了一个额外的“紧凑”$s$ 函数。这是针对周期 $1$ 以外元素的特殊规则。\n    - 如果 $Z \\ge 3$，我们将 $s$ 壳层数增加 $1$：$n_s \\leftarrow n_s + 1$。\n\n结合这些步骤，我们为任何给定的 $Z \\in \\{1, \\dots, 18\\}$ 构建算法。\n\n让我们将此算法应用于测试套件中的两个示例。\n\n**示例 1：氢 ($Z=1$)**\n- **步骤 1 (初始化)**：$[n_s, n_p, n_d] = [0, 0, 0]$。\n- **步骤 2 ($\\ell_{\\max}$)**：对于 $Z=1$，我们处于周期 $1$。价通道为 $\\{s\\}$，因此 $\\ell_{\\max}=0$。\n- **步骤 3 (价层)**：存在一个价 $s$ 通道。将 $n_s$ 增加 $2$。现在我们有 $[2, 0, 0]$。\n- **步骤 4 (极化)**：由于 $\\ell_{\\max}=0$，我们添加一个极化 $p$ 壳层。将 $n_p$ 增加 $1$。现在我们有 $[2, 1, 0]$。\n- **步骤 5 (核)**：条件 $Z \\ge 3$ 为假。不添加核 $s$ 壳层。\n- **$Z=1$ 的最终结果**：壳层数为 $[2, 1, 0]$。\n\n**示例 2：硅 ($Z=14$)**\n- **步骤 1 (初始化)**：$[n_s, n_p, n_d] = [0, 0, 0]$。\n- **步骤 2 ($\\ell_{\\max}$)**：对于 $Z=14$，我们处于周期 $3$ 的 p 区。价通道为 $\\{s, p\\}$，因此 $\\ell_{\\max}=1$。\n- **步骤 3 (价层)**：存在价 $s$ 和 $p$ 通道。将 $n_s$ 增加 $2$，将 $n_p$ 增加 $2$。现在我们有 $[2, 2, 0]$。\n- **步骤 4 (极化)**：由于 $\\ell_{\\max}=1$，我们添加一个极化 $d$ 壳层。将 $n_d$ 增加 $1$。现在我们有 $[2, 2, 1]$。\n- **步骤 5 (核)**：条件 $Z \\ge 3$ 为真。我们为核添加一个紧凑 $s$ 壳层。将 $n_s$ 增加 $1$。现在我们有 $[3, 2, 1]$。\n- **$Z=14$ 的最终结果**：壳层数为 $[3, 2, 1]$。\n\n所提供的 Python 代码实现了这一精确逻辑，以系统地计算给定测试套件中原子序数的壳层数。它正确地确定了 $\\ell_{\\max}$ 并应用了价层、极化和核壳层的规则，以产生最终结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef build_cc_pvdz(z: int) -> list[int]:\n    \"\"\"\n    Algorithmically constructs the cc-pVDZ shell counts [n_s, n_p, n_d]\n    for a main-group element with atomic number Z.\n\n    Args:\n        z: The atomic number, an integer from 1 to 18.\n\n    Returns:\n        A list of three integers [n_s, n_p, n_d].\n    \"\"\"\n    # Step 1: Initialize shell counts\n    n_s, n_p, n_d = 0, 0, 0\n\n    # Step 2: Determine valence space and l_max\n    # The problem defines specific sets of Z for which l_max is 0 or 1.\n    # Group 1, 2, 11, 12 atoms have s-valence only.\n    if z in {1, 2, 3, 4, 11, 12}:\n        l_max = 0\n    # Group 13-18 atoms have s,p-valence.\n    else:  # z in {5..10, 13..18}\n        l_max = 1\n    \n    # Step 3: Assign valence shells (n=2 for double-zeta)\n    # All elements have a valence s-channel.\n    n_s += 2\n    # Elements with l_max=1 also have a valence p-channel.\n    if l_max == 1:\n        n_p += 2\n        \n    # Step 4: Assign polarization shells (at l_max + 1)\n    if l_max == 0:\n        # l_max + 1 = 1, so add a p-shell\n        n_p += 1\n    elif l_max == 1:\n        # l_max + 1 = 2, so add a d-shell\n        n_d += 1\n        \n    # Step 5: Assign core shell for Z >= 3\n    # A single tight s-function is added for the 1s core.\n    if z >= 3:\n        n_s += 1\n        \n    return [n_s, n_p, n_d]\n\ndef solve():\n    \"\"\"\n    Runs the calculation for the test suite and prints the formatted output.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [1, 2, 3, 6, 10, 11, 14, 18]\n\n    results = []\n    for z in test_cases:\n        # Calculate the shell counts for the current atomic number.\n        result = build_cc_pvdz(z)\n        results.append(result)\n\n    # Final print statement in the exact required format.\n    # The format is a string representation of a list of lists,\n    # with no spaces inside the inner lists. e.g., [[1,2,3],[4,5,6]]\n    inner_strs = [f\"[{r[0]},{r[1]},{r[2]}]\" for r in results]\n    final_output = f\"[{','.join(inner_strs)}]\"\n\n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "在了解了基组的构造之后，下一步是将其应用于实际的化学问题。本练习将演示如何使用相关一致性基组计算一个重要的化学性质——电子亲和能 。通过比较标准 cc-pVDZ 基组和增广了弥散函数的 aug-cc-pVDZ 基组的计算结果，你将亲身体会到弥散函数在描述阴离子这类具有松散束缚电子的体系时所起的关键作用。",
            "id": "2454349",
            "problem": "给定氰基自由基及其阴离子的总非相对论玻恩-奥本海默电子能量，单位为哈特里（原子单位），这些能量是使用 Dunning 的两种相关一致基组计算得出的：相关一致极化价层双泽塔 (cc-pVDZ) 和增广相关一致极化价层双泽塔 (aug-cc-pVDZ)。垂直电子亲和能定义为在固定的核几何构型下，向中性物质添加一个电子所释放的能量。数学上，垂直电子亲和能为\n$$\n\\mathrm{EA} = E_{\\mathrm{neutral}} - E_{\\mathrm{anion}},\n$$\n其中 $E_{\\mathrm{neutral}}$ 和 $E_{\\mathrm{anion}}$ 是总电子能量，单位为哈特里。使用以下公式将电子亲和能从哈特里转换为电子伏特 (eV)：\n$$\n1\\ \\text{Hartree} = 27.211386245988\\ \\text{eV}.\n$$\n所有电子亲和能均以电子伏特为单位报告，并四舍五入到三位小数。\n\n计算以下各项，并按如下规定将结果汇总到单行输出中。\n\n输入 (测试套件)：\n- 测试用例 1 (使用 cc-pVDZ 的氰基自由基)：$E_{\\mathrm{neutral}} = -92.423500$ 哈特里，$E_{\\mathrm{anion}} = -92.503625$ 哈特里。\n- 测试用例 2 (使用 aug-cc-pVDZ 的氰基自由基)：$E_{\\mathrm{neutral}} = -92.450000$ 哈特里，$E_{\\mathrm{anion}} = -92.591950$ 哈特里。\n- 测试用例 3 (比较)：使用在测试用例 1 和 2 中获得的电子亲和能，输出一个布尔值，表示 aug-cc-pVDZ 的电子亲和能是否严格大于 cc-pVDZ 的电子亲和能。\n- 测试用例 4 (边界条件)：$E_{\\mathrm{neutral}} = -92.500000$ 哈特里，$E_{\\mathrm{anion}} = -92.500000$ 哈特里。\n\n要求输出：\n- 对于测试用例 1：电子亲和能，单位为电子伏特，作为浮点数，四舍五入到三位小数。\n- 对于测试用例 2：电子亲和能，单位为电子伏特，作为浮点数，四舍五入到三位小数。\n- 对于测试用例 3：如上定义的布尔值。\n- 对于测试用例 4：电子亲和能，单位为电子伏特，作为浮点数，四舍五入到三位小数。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果按以下顺序排列：$[\\mathrm{EA}_{\\mathrm{cc\\mbox{-}pVDZ}}\\ \\text{(eV)},\\ \\mathrm{EA}_{\\mathrm{aug\\mbox{-}cc\\mbox{-}pVDZ}}\\ \\text{(eV)},\\ \\text{comparison boolean},\\ \\mathrm{EA}_{\\mathrm{boundary}}\\ \\text{(eV)}]$。例如，输出行的格式为 $[x,y,\\text{True},z]$，其中 $x$、$y$ 和 $z$ 是四舍五入到三位小数的浮点数。不涉及角度。输出中不应出现单位，只包含数值和布尔值。",
            "solution": "问题陈述已经过评估，被认为是有效的。它在科学上基于量子化学原理，问题提出得当，提供了所有必要数据，并且表述客观。我们将开始解答。\n\n问题的核心是计算垂直电子亲和能，记为 $\\mathrm{EA}$。根据定义，这是在中性物质的固定几何构型下，中性物种与其对应阴离子之间的能量差。给定的公式为：\n$$\n\\mathrm{EA} = E_{\\mathrm{neutral}} - E_{\\mathrm{anion}}\n$$\n其中 $E_{\\mathrm{neutral}}$ 和 $E_{\\mathrm{anion}}$ 是总电子能量。按照标准惯例，正的 $\\mathrm{EA}$ 对应于一个稳定的阴离子，在电子附着时会释放能量。这意味着阴离子的能量 $E_{\\mathrm{anion}}$ 比中性物质的能量 $E_{\\mathrm{neutral}}$ 更负（更低）。\n\n给定的能量单位是原子单位（哈特里），最终结果必须以电子伏特（eV）为单位呈现。转换因子指定为：\n$$\n1\\ \\text{Hartree} = 27.211386245988\\ \\text{eV}\n$$\n所有最终的 $\\mathrm{EA}$ 值（以 eV 为单位）必须四舍五入到三位小数。\n\n我们现在将系统地处理每个测试用例。\n\n**测试用例 1：使用 cc-pVDZ 基组的氰基自由基**\n\n给定的能量为：\n- $E_{\\mathrm{neutral}} = -92.423500\\ \\text{哈特里}$\n- $E_{\\mathrm{anion}} = -92.503625\\ \\text{哈特里}$\n\n首先，我们计算以哈特里为单位的电子亲和能：\n$$\n\\mathrm{EA}_{\\mathrm{cc\\mbox{-}pVDZ}} = (-92.423500) - (-92.503625) = 0.080125\\ \\text{Hartree}\n$$\n接下来，我们将该值转换为电子伏特：\n$$\n\\mathrm{EA}_{\\mathrm{cc\\mbox{-}pVDZ}} (\\mathrm{eV}) = 0.080125 \\times 27.211386245988\\ \\text{eV} \\approx 2.1803565\\ \\text{eV}\n$$\n四舍五入到三位小数，我们得到第一个结果：\n$$\n\\mathrm{EA}_{\\mathrm{cc\\mbox{-}pVDZ, rounded}} = 2.180\\ \\text{eV}\n$$\n\n**测试用例 2：使用 aug-cc-pVDZ 基组的氰基自由基**\n\n给定的能量为：\n- $E_{\\mathrm{neutral}} = -92.450000\\ \\text{哈特里}$\n- $E_{\\mathrm{anion}} = -92.591950\\ \\text{哈特里}$\n\n以哈特里为单位的电子亲和能是：\n$$\n\\mathrm{EA}_{\\mathrm{aug\\mbox{-}cc\\mbox{-}pVDZ}} = (-92.450000) - (-92.591950) = 0.141950\\ \\text{Hartree}\n$$\n转换为电子伏特：\n$$\n\\mathrm{EA}_{\\mathrm{aug\\mbox{-}cc\\mbox{-}pVDZ}} (\\mathrm{eV}) = 0.141950 \\times 27.211386245988\\ \\text{eV} \\approx 3.8628040\\ \\text{eV}\n$$\n四舍五入到三位小数，得到第二个结果：\n$$\n\\mathrm{EA}_{\\mathrm{aug\\mbox{-}cc\\mbox{-}pVDZ, rounded}} = 3.863\\ \\text{eV}\n$$\n\n**测试用例 3：比较**\n\n这个任务要求进行布尔比较：aug-cc-pVDZ 的电子亲和能是否严格大于 cc-pVDZ 的电子亲和能？我们必须比较未四舍五入的值以避免精度误差。最直接的方法是比较以哈特里为单位的值：\n$$\n\\mathrm{Is}\\ \\mathrm{EA}_{\\mathrm{aug\\mbox{-}cc\\mbox{-}pVDZ}} > \\mathrm{EA}_{\\mathrm{cc\\mbox{-}pVDZ}}?\n$$\n$$\n\\mathrm{Is}\\ 0.141950 > 0.080125?\n$$\n该不等式成立。因此，第三个结果是布尔值 `True`。从化学物理学的角度来看，这个结果是符合预期的。“aug-”前缀表示在标准 cc-pVDZ 基组上增加了弥散基函数。这些函数在空间上延展很广，对于正确描述阴离子中束缚较松的额外电子至关重要。包含它们可以为阴离子提供更准确、通常也更低的能量，这反过来又会得到更大、更符合实际的电子亲和能。\n\n**测试用例 4：边界条件**\n\n给定的能量为：\n- $E_{\\mathrm{neutral}} = -92.500000\\ \\text{哈特里}$\n- $E_{\\mathrm{anion}} = -92.500000\\ \\text{哈特里}$\n\n以哈特里为单位的电子亲和能是：\n$$\n\\mathrm{EA}_{\\mathrm{boundary}} = (-92.500000) - (-92.500000) = 0.0\\ \\text{Hartree}\n$$\n这对应于 $0.0\\ \\text{eV}$。四舍五入到三位小数，第四个结果是：\n$$\n\\mathrm{EA}_{\\mathrm{boundary, rounded}} = 0.000\\ \\text{eV}\n$$\n\n**结果摘要**\n\n需要汇总的计算值如下：\n1. $\\mathrm{EA}_{\\mathrm{cc\\mbox{-}pVDZ}} = 2.180$\n2. $\\mathrm{EA}_{\\mathrm{aug\\mbox{-}cc\\mbox{-}pVDZ}} = 3.863$\n3. 比较 = `True`\n4. $\\mathrm{EA}_{\\mathrm{boundary}} = 0.000$\n\n这些结果将在最终答案中格式化为所需的列表结构。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates vertical electron affinities for the cyano radical\n    based on provided total electronic energies and performs a comparison.\n    \"\"\"\n    \n    # Conversion factor from Hartree to electronvolts (CODATA 2018)\n    HARTREE_TO_EV = 27.211386245988\n\n    # Test Case 1: cc-pVDZ\n    e_neutral_1 = -92.423500  # Hartree\n    e_anion_1 = -92.503625    # Hartree\n    \n    # Test Case 2: aug-cc-pVDZ\n    e_neutral_2 = -92.450000  # Hartree\n    e_anion_2 = -92.591950    # Hartree\n\n    # Test Case 4: Boundary condition\n    e_neutral_4 = -92.500000  # Hartree\n    e_anion_4 = -92.500000    # Hartree\n\n    # --- Calculations ---\n\n    # Calculation for Test Case 1\n    ea_hartree_1 = e_neutral_1 - e_anion_1\n    ea_ev_1 = ea_hartree_1 * HARTREE_TO_EV\n    result_1 = ea_ev_1 # Retain unrounded for comparison\n\n    # Calculation for Test Case 2\n    ea_hartree_2 = e_neutral_2 - e_anion_2\n    ea_ev_2 = ea_hartree_2 * HARTREE_TO_EV\n    result_2 = ea_ev_2 # Retain unrounded for comparison\n\n    # Calculation for Test Case 3: Comparison\n    # Compare unrounded values to ensure correctness.\n    # The result is the same whether comparing Hartree or eV values.\n    result_3 = ea_hartree_2 > ea_hartree_1\n\n    # Calculation for Test Case 4\n    ea_hartree_4 = e_neutral_4 - e_anion_4\n    ea_ev_4 = ea_hartree_4 * HARTREE_TO_EV\n    result_4 = ea_ev_4\n\n    # Assemble and format the final results\n    # Floats must be rounded to three decimal places for the output.\n    # The boolean should be represented as True/False.\n    formatted_results = [\n        f\"{result_1:.3f}\",\n        f\"{result_2:.3f}\",\n        str(result_3),\n        f\"{result_4:.3f}\"\n    ]\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "尽管功能强大，但有限基组在计算中也存在局限性，可能导致被称为“伪影”的计算误差。本练习旨在解决计算化学中最常见的问题之一：基组重叠误差（Basis Set Superposition Error, BSSE） 。通过计算水二聚体的 BSSE，你将学习到一项至关重要的实践技能——如何使用平衡校正（counterpoise correction）方法来识别和修正这种误差，从而确保对分子间相互作用能的计算更加准确可靠。",
            "id": "2454361",
            "problem": "您的任务是使用 Dunning 的相关一致性极化价层双 zeta (cc-pVDZ) 基组，计算氢键二聚体的基组重叠误差 (BSSE)。基组重叠误差 (BSSE) 对于由单体 A 和单体 B 组成的二聚体定义为一个正值，用于衡量当一个单体的基函数被另一个单体使用时，因基组不完备而产生的人为稳定性。考虑二聚体 AB 的以下定义：\n- 在完整二聚体基组中计算的二聚体总能量记为 $E_{AB}^{AB}$，单位为哈特里 (Hartree)。\n- 在其自身基组中计算的单体 A 的总能量记为 $E_{A}^{A}$，单位为哈特里 (Hartree)。\n- 在其自身基组中计算的单体 B 的总能量记为 $E_{B}^{B}$，单位为哈特里 (Hartree)。\n- 在 B 的基函数（仅鬼基函数，无 B 的原子核或电子）存在下计算的单体 A 的总能量记为 $E_{A}^{AB}$，单位为哈特里 (Hartree)。\n- 在 A 的基函数（仅鬼基函数，无 A 的原子核或电子）存在下计算的单体 B 的总能量记为 $E_{B}^{AB}$，单位为哈特里 (Hartree)。\n\n将未校正的相互作用能定义为 $E_{\\text{int}}^{\\text{raw}} = E_{AB}^{AB} - \\left(E_{A}^{A} + E_{B}^{B}\\right)$，将平衡校正的相互作用能定义为 $E_{\\text{int}}^{\\text{CP}} = E_{AB}^{AB} - \\left(E_{A}^{AB} + E_{B}^{AB}\\right)$。基组重叠误差 (BSSE) 的大小是这两种相互作用能之差，表示为一个正值，\n$$\n\\text{BSSE} = \\left(E_{A}^{A} - E_{A}^{AB}\\right) + \\left(E_{B}^{B} - E_{B}^{AB}\\right),\n$$\n单位为哈特里 (Hartree)。使用哈特里能量和阿伏伽德罗常数将 BSSE 转换为千焦耳每摩尔：\n- 哈特里能量 $E_{\\mathrm{h}} = 4.3597447222071\\times 10^{-18}\\ \\text{J}$，\n- 阿伏伽德罗常数 $N_{\\mathrm{A}} = 6.02214076\\times 10^{23}\\ \\text{mol}^{-1}$，\n以及最终答案的转换关系 $1\\ \\text{J} = 10^{-3}\\ \\text{kJ}$。所有输入均为以哈特里 (Hartree) 为单位的能量。所有输出必须是以 $\\text{kJ}\\ \\text{mol}^{-1}$ 为单位的 BSSE 值，并四舍五入到三位小数。\n\n测试套件：\n提供一个程序，为下面的每个测试用例（每个用例包含一个四元组 $(E_{A}^{A}, E_{B}^{B}, E_{A}^{AB}, E_{B}^{AB})$，单位为哈特里 (Hartree)），计算以 $\\text{kJ}\\ \\text{mol}^{-1}$ 为单位的 BSSE：\n1. 使用二阶 Møller–Plesset 微扰理论 (MP2) 和 cc-pVDZ 基组计算的平衡几何构型下的水二聚体：\n   - $E_{A}^{A} = -76.230000$, $E_{B}^{B} = -76.230000$, $E_{A}^{AB} = -76.230950$, $E_{B}^{AB} = -76.230950$。\n2. 无 BSSE 的边界情况（通过构造实现完美平衡的基组）：\n   - $E_{A}^{A} = -1.000000$, $E_{B}^{B} = -2.000000$, $E_{A}^{AB} = -1.000000$, $E_{B}^{AB} = -2.000000$。\n3. 两个单体贡献不相等的非对称二聚体：\n   - $E_{A}^{A} = -10.000000$, $E_{B}^{B} = -20.000000$, $E_{A}^{AB} = -10.000400$, $E_{B}^{AB} = -20.000050$。\n\n最终输出格式：\n您的程序应生成单行输出，其中包含与上述测试用例相对应的三个 BSSE 值，格式为用方括号括起来的逗号分隔列表，每个数字四舍五入到三位小数（例如 $[x_{1},x_{2},x_{3}]$）。",
            "solution": "问题陈述已经过评估并被确定为有效。它在科学上是合理的、定义明确且客观的。它提出了一个量子化学领域的标准计算任务，并为其解决提供了所有必要的定义、公式和数据。因此，我们将着手提供一个完整的解决方案。\n\n该问题要求计算分子二聚体的基组重叠误差 (BSSE)。在量子化学计算中，分子的性质是使用一组称为基组的数学函数来描述的。当这个基组是有限的或不完整的时，在计算二聚体 $AB$ 的相互作用能时，可能会出现人为的稳定性。这种误差的产生是因为以单体 $A$ 为中心的基函数可以用来改善对单体 $B$ 的描述，反之亦然。这种效应是非物理的，因为它取决于基组的选择，而不是系统的真实物理情况。\n\nBoys 和 Bernardi 的平衡校正方法是校正此误差的标准程序。BSSE 定义为这种人为稳定性的量值。该问题为 BSSE 提供了正确的公式，该公式源自未校正的相互作用能 $E_{\\text{int}}^{\\text{raw}}$ 和平衡校正的相互作用能 $E_{\\text{int}}^{\\text{CP}}$ 之间的差值。以哈特里 (Hartree) 为单位测量的 BSSE 由下式给出：\n$$\n\\text{BSSE} = \\left(E_{A}^{A} - E_{A}^{AB}\\right) + \\left(E_{B}^{B} - E_{B}^{AB}\\right)\n$$\n此处，$E_{X}^{X}$ 是用其自身基组计算的单体 $X$ 的能量，$E_{X}^{XY}$ 是在单体 $Y$ 的基函数（所谓的“鬼”轨道）存在下计算的单体 $X$ 的能量。根据量子力学的变分原理，扩展给定单体的基组（通过包含其伴侣的鬼轨道）必须导致计算出的能量更低或相等。因此，$E_{A}^{AB} \\le E_{A}^{A}$ 且 $E_{B}^{AB} \\le E_{B}^{B}$。因此，项 $(E_{A}^{A} - E_{A}^{AB})$ 和 $(E_{B}^{B} - E_{B}^{AB})$ 本质上是非负的，BSSE 被正确定义为代表稳定性的正值。\n\n该问题要求最终结果以千焦耳每摩尔 ($\\text{kJ}\\ \\text{mol}^{-1}$) 为单位。我们必须首先确定从原子能量单位哈特里 ($E_{\\text{h}}$) 到摩尔单位 $\\text{kJ}\\ \\text{mol}^{-1}$ 的转换因子。给定：\n- 哈特里能量 $E_{\\mathrm{h}} = 4.3597447222071 \\times 10^{-18}\\ \\text{J}$\n- 阿伏伽德罗常数 $N_{\\mathrm{A}} = 6.02214076 \\times 10^{23}\\ \\text{mol}^{-1}$\n\n转换因子 $C$ 的计算如下：\n$$\nC = E_{\\mathrm{h}} \\left(\\frac{\\text{J}}{\\text{Hartree}}\\right) \\times N_{\\mathrm{A}} \\left(\\frac{1}{\\text{mol}}\\right) \\times 10^{-3} \\left(\\frac{\\text{kJ}}{\\text{J}}\\right)\n$$\n代入给定值：\n$$\nC = (4.3597447222071 \\times 10^{-18}) \\times (6.02214076 \\times 10^{23}) \\times 10^{-3}\\ \\text{kJ}\\ \\text{mol}^{-1}\\ \\text{Hartree}^{-1}\n$$\n$$\nC \\approx 2625.5\\ \\text{kJ}\\ \\text{mol}^{-1}\\ \\text{Hartree}^{-1}\n$$\n我们将使用此转换因子为每个测试用例计算 BSSE。最终值必须四舍五入到 3 位小数。\n\n情况1：水二聚体\n- $E_{A}^{A} = -76.230000\\ E_{\\text{h}}$\n- $E_{B}^{B} = -76.230000\\ E_{\\text{h}}$\n- $E_{A}^{AB} = -76.230950\\ E_{\\text{h}}$\n- $E_{B}^{AB} = -76.230950\\ E_{\\text{h}}$\n\n以哈特里为单位的 BSSE 为：\n$$\n\\text{BSSE}_{E_{\\text{h}}} = (-76.230000 - (-76.230950)) + (-76.230000 - (-76.230950))\n$$\n$$\n\\text{BSSE}_{E_{\\text{h}}} = 0.000950 + 0.000950 = 0.001900\\ E_{\\text{h}}\n$$\n转换为 $\\text{kJ}\\ \\text{mol}^{-1}$：\n$$\n\\text{BSSE}_{\\text{kJ/mol}} = 0.001900 \\times C \\approx 4.988449\\ \\text{kJ}\\ \\text{mol}^{-1}\n$$\n四舍五入到 3 位小数，结果是 $4.988$。\n\n情况2：无 BSSE 的边界情况\n- $E_{A}^{A} = -1.000000\\ E_{\\text{h}}$\n- $E_{B}^{B} = -2.000000\\ E_{\\text{h}}$\n- $E_{A}^{AB} = -1.000000\\ E_{\\text{h}}$\n- $E_{B}^{AB} = -2.000000\\ E_{\\text{h}}$\n\n以哈特里为单位的 BSSE 为：\n$$\n\\text{BSSE}_{E_{\\text{h}}} = (-1.000000 - (-1.000000)) + (-2.000000 - (-2.000000))\n$$\n$$\n\\text{BSSE}_{E_{\\text{h}}} = 0.0 + 0.0 = 0.0\\ E_{\\text{h}}\n$$\n转换为 $\\text{kJ}\\ \\text{mol}^{-1}$：\n$$\n\\text{BSSE}_{\\text{kJ/mol}} = 0.0 \\times C = 0.0\\ \\text{kJ}\\ \\text{mol}^{-1}\n$$\n四舍五入到 3 位小数，结果是 $0.000$。\n\n情况3：非对称二聚体\n- $E_{A}^{A} = -10.000000\\ E_{\\text{h}}$\n- $E_{B}^{B} = -20.000000\\ E_{\\text{h}}$\n- $E_{A}^{AB} = -10.000400\\ E_{\\text{h}}$\n- $E_{B}^{AB} = -20.000050\\ E_{\\text{h}}$\n\n以哈特里为单位的 BSSE 为：\n$$\n\\text{BSSE}_{E_{\\text{h}}} = (-10.000000 - (-10.000400)) + (-20.000000 - (-20.000050))\n$$\n$$\n\\text{BSSE}_{E_{\\text{h}}} = 0.000400 + 0.000050 = 0.000450\\ E_{\\text{h}}\n$$\n转换为 $\\text{kJ}\\ \\text{mol}^{-1}$：\n$$\n\\text{BSSE}_{\\text{kJ/mol}} = 0.000450 \\times C \\approx 1.181475\\ \\text{kJ}\\ \\text{mol}^{-1}\n$$\n四舍五入到 3 位小数，结果是 $1.181$。\n\n最终答案中的程序将为指定的测试用例实现此过程。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the Basis Set Superposition Error (BSSE) for given test cases\n    and formats the output as specified.\n    \"\"\"\n    # Define physical constants according to the problem statement.\n    # Hartree energy in Joules (CODATA 2018)\n    E_HARTREE_IN_J = 4.3597447222071e-18\n    # Avogadro constant in mol^-1 (CODATA 2018)\n    N_AVOGADRO = 6.02214076e23\n    # Conversion factor from Joules to kiloJoules\n    J_PER_KJ = 1000.0\n\n    # Calculate the conversion factor from Hartree to kJ/mol.\n    # The unit of the factor is (kJ/mol) per Hartree.\n    HARTREE_TO_KJ_PER_MOL = (E_HARTREE_IN_J * N_AVOGADRO) / J_PER_KJ\n\n    # Define the test cases from the problem statement.\n    # Each case is a tuple: (E_A^A, E_B^B, E_A^{AB}, E_B^{AB}) in Hartree.\n    test_cases = [\n        # Case 1: Water dimer at MP2/cc-pVDZ level\n        (-76.230000, -76.230000, -76.230950, -76.230950),\n        # Case 2: Boundary case with zero BSSE\n        (-1.000000, -2.000000, -1.000000, -2.000000),\n        # Case 3: Asymmetric dimer with unequal BSSE contributions\n        (-10.000000, -20.000000, -10.000400, -20.000050),\n    ]\n\n    results = []\n    for case in test_cases:\n        e_a_a, e_b_b, e_a_ab, e_b_ab = case\n\n        # Calculate the BSSE in Hartree using the provided formula:\n        # BSSE = (E_A^A - E_A^{AB}) + (E_B^B - E_B^{AB})\n        # The terms (E_X^X - E_X^{XY}) are non-negative due to the variational principle.\n        bsse_hartree = (e_a_a - e_a_ab) + (e_b_b - e_b_ab)\n\n        # Convert the BSSE from Hartree to kJ/mol.\n        bsse_kj_mol = bsse_hartree * HARTREE_TO_KJ_PER_MOL\n\n        # Append the result formatted to three decimal places.\n        # Using an f-string with a format specifier handles rounding correctly.\n        results.append(f\"{bsse_kj_mol:.3f}\")\n\n    # Final print statement in the exact required format: [x1,x2,x3]\n    print(f\"[{','.join(results)}]\")\n\n# Execute the solution.\nsolve()\n```"
        }
    ]
}