{
    "hands_on_practices": [
        {
            "introduction": "To understand the mechanics of the Boys-Bernardi counterpoise correction, we begin with a foundational exercise. This problem involves one of the simplest possible interacting systems: a helium atom and a proton ($\\mathrm{H^+}$). By calculating the Basis Set Superposition Error (BSSE) for this dimer, you will see the counterpoise formula in action and appreciate how the lack of electrons on one monomer simplifies the calculation, providing a clear illustration of the underlying principle. ",
            "id": "2450803",
            "problem": "You are to compute the Basis Set Superposition Error (BSSE) for the interaction between a proton and a helium atom, denoted $\\mathrm{H^+}$—$\\mathrm{He}$, using the generalized Boys–Bernardi counterpoise definition. Let monomer $\\mathrm{A}$ be $\\mathrm{He}$ and monomer $\\mathrm{B}$ be $\\mathrm{H^+}$. Define the BSSE as the scalar quantity\n$$\n\\mathrm{BSSE} = \\left(E_{\\mathrm{A}}^{\\mathrm{A}} - E_{\\mathrm{A}}^{\\mathrm{AB}}\\right) + \\left(E_{\\mathrm{B}}^{\\mathrm{B}} - E_{\\mathrm{B}}^{\\mathrm{AB}}\\right),\n$$\nwhere $E_{\\mathrm{X}}^{\\mathrm{Y}}$ denotes the electronic energy of monomer $\\mathrm{X}$ computed in the one-electron basis set of system $\\mathrm{Y}$ with clamped nuclei. All energies are given in Hartree, and your answers must be expressed in Hartree, rounded to $6$ decimal places.\n\nUse the following test suite of parameter sets. Each test case is a tuple $\\left(E_{\\mathrm{He}}^{\\mathrm{He}}, E_{\\mathrm{He}}^{\\mathrm{HeH^+}}, E_{\\mathrm{H^+}}^{\\mathrm{H^+}}, E_{\\mathrm{H^+}}^{\\mathrm{HeH^+}}\\right)$, with all four entries in Hartree:\n\n- Test case $1$: $\\left(-2.850000, -2.853200, 0.000000, 0.000000\\right)$.\n- Test case $2$: $\\left(-2.861000, -2.861000, 0.000000, 0.000000\\right)$.\n- Test case $3$: $\\left(-2.700000, -2.705500, 0.000000, 0.000000\\right)$.\n- Test case $4$: $\\left(-2.900000, -2.899800, 0.000000, 0.000000\\right)$.\n\nYour program must compute the BSSE for each test case according to the definition above. The final output format must be a single line containing a Python-style list of the results in Hartree, each rounded to $6$ decimal places, with no spaces, for example, $[result_1,result_2,result_3,result_4]$. The angle unit is not applicable, and no percentages are involved.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, for example, $[r_1,r_2,r_3,r_4]$.",
            "solution": "The problem statement has been subjected to rigorous validation and is found to be scientifically grounded, well-posed, and objective. It provides a clear definition, all necessary numerical data, and a non-ambiguous objective. Therefore, the problem is valid, and a solution will be furnished.\n\nThe task is to compute the Basis Set Superposition Error (BSSE) for the interaction complex $\\mathrm{H^+}$—$\\mathrm{He}$. The problem defines the involved species as monomer $\\mathrm{A} = \\mathrm{He}$ and monomer $\\mathrm{B} = \\mathrm{H^+}$. The formula for BSSE, according to the generalized Boys–Bernardi counterpoise correction scheme, is given as:\n$$\n\\mathrm{BSSE} = \\left(E_{\\mathrm{A}}^{\\mathrm{A}} - E_{\\mathrm{A}}^{\\mathrm{AB}}\\right) + \\left(E_{\\mathrm{B}}^{\\mathrm{B}} - E_{\\mathrm{B}}^{\\mathrm{AB}}\\right)\n$$\nHere, $E_{\\mathrm{X}}^{\\mathrm{Y}}$ denotes the electronic energy of monomer $\\mathrm{X}$ calculated using the basis set associated with the geometry of system $\\mathrm{Y}$.\n\nLet us analyze the terms for the specified system:\nThe first term, $\\left(E_{\\mathrm{A}}^{\\mathrm{A}} - E_{\\mathrm{A}}^{\\mathrm{AB}}\\right)$, corresponds to monomer $\\mathrm{A}$, the helium atom ($\\mathrm{He}$).\n- $E_{\\mathrm{A}}^{\\mathrm{A}} = E_{\\mathrm{He}}^{\\mathrm{He}}$ is the energy of an isolated $\\mathrm{He}$ atom computed with its own basis functions.\n- $E_{\\mathrm{A}}^{\\mathrm{AB}} = E_{\\mathrm{He}}^{\\mathrm{HeH^+}}$ is the energy of the $\\mathrm{He}$ atom computed in the presence of \"ghost\" orbitals from monomer $\\mathrm{B}$ ($\\mathrm{H^+}$). This calculation uses the full basis set of the dimer ($\\mathrm{HeH^+}$) but only includes the nucleus and electrons of the $\\mathrm{He}$ atom. By the variational principle, expanding the basis set artificially lowers the calculated energy, so typically $E_{\\mathrm{He}}^{\\mathrm{HeH^+}} \\le E_{\\mathrm{He}}^{\\mathrm{He}}$. The difference, $(E_{\\mathrm{He}}^{\\mathrm{He}} - E_{\\mathrm{He}}^{\\mathrm{HeH^+}})$, is therefore non-negative in most well-behaved cases.\n\nThe second term, $\\left(E_{\\mathrm{B}}^{\\mathrm{B}} - E_{\\mathrm{B}}^{\\mathrm{AB}}\\right)$, corresponds to monomer $\\mathrm{B}$, the proton ($\\mathrm{H^+}$).\n- A proton is a bare nucleus with zero electrons. Its electronic energy is, by definition, identically zero, irrespective of the basis set used for a hypothetical electronic structure calculation.\n- Consequently, $E_{\\mathrm{B}}^{\\mathrm{B}} = E_{\\mathrm{H^+}}^{\\mathrm{H^+}} = 0$ Hartree.\n- Similarly, $E_{\\mathrm{B}}^{\\mathrm{AB}} = E_{\\mathrm{H^+}}^{\\mathrm{HeH^+}} = 0$ Hartree.\n- The second term in the BSSE expression is therefore always zero for this system: $(0 - 0) = 0$.\n\nThus, the BSSE calculation simplifies to only the contribution from the helium atom:\n$$\n\\mathrm{BSSE} = E_{\\mathrm{He}}^{\\mathrm{He}} - E_{\\mathrm{He}}^{\\mathrm{HeH^+}}\n$$\nWe will now apply this simplified formula to each of the provided test cases. All energies are in Hartree.\n\nTest case $1$:\nThe given energies are $E_{\\mathrm{He}}^{\\mathrm{He}} = -2.850000$, $E_{\\mathrm{He}}^{\\mathrm{HeH^+}} = -2.853200$, $E_{\\mathrm{H^+}}^{\\mathrm{H^+}} = 0.000000$, and $E_{\\mathrm{H^+}}^{\\mathrm{HeH^+}} = 0.000000$.\n$$\n\\mathrm{BSSE}_{1} = (-2.850000) - (-2.853200) = 0.003200\n$$\n\nTest case $2$:\nThe given energies are $E_{\\mathrm{He}}^{\\mathrm{He}} = -2.861000$, $E_{\\mathrm{He}}^{\\mathrm{HeH^+}} = -2.861000$, $E_{\\mathrm{H^+}}^{\\mathrm{H^+}} = 0.000000$, and $E_{\\mathrm{H^+}}^{\\mathrm{HeH^+}} = 0.000000$.\n$$\n\\mathrm{BSSE}_{2} = (-2.861000) - (-2.861000) = 0.000000\n$$\nA BSSE of zero implies that the monomer basis set for He is sufficiently complete or that the ghost orbitals of $\\mathrm{H^+}$ provide no additional variational flexibility.\n\nTest case $3$:\nThe given energies are $E_{\\mathrm{He}}^{\\mathrm{He}} = -2.700000$, $E_{\\mathrm{He}}^{\\mathrm{HeH^+}} = -2.705500$, $E_{\\mathrm{H^+}}^{\\mathrm{H^+}} = 0.000000$, and $E_{\\mathrm{H^+}}^{\\mathrm{HeH^+}} = 0.000000$.\n$$\n\\mathrm{BSSE}_{3} = (-2.700000) - (-2.705500) = 0.005500\n$$\n\nTest case $4$:\nThe given energies are $E_{\\mathrm{He}}^{\\mathrm{He}} = -2.900000$, $E_{\\mathrm{He}}^{\\mathrm{HeH^+}} = -2.899800$, $E_{\\mathrm{H^+}}^{\\mathrm{H^+}} = 0.000000$, and $E_{\\mathrm{H^+}}^{\\mathrm{HeH^+}} = 0.000000$.\n$$\n\\mathrm{BSSE}_{4} = (-2.900000) - (-2.899800) = -0.000200\n$$\nA negative BSSE is atypical but possible. It indicates that the energy calculated with ghost orbitals, $E_{\\mathrm{He}}^{\\mathrm{HeH^+}}$, is higher (less negative) than the energy in the monomer basis, $E_{\\mathrm{He}}^{\\mathrm{He}}$. This can occur with certain basis sets, for example, if the addition of ghost functions introduces near-linear dependencies that are not handled perfectly by the numerical procedures of the quantum chemistry software. The calculation, however, remains a direct application of the definition.\n\nThe final results, rounded to $6$ decimal places as required, are $0.003200$, $0.000000$, $0.005500$, and $-0.000200$ Hartree.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes the Basis Set Superposition Error (BSSE) for the H+ -- He system\n    for a given suite of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple is (E_He^He, E_He^HeH+, E_H+^H+, E_H+^HeH+), all in Hartree.\n    test_cases = [\n        (-2.850000, -2.853200, 0.000000, 0.000000),\n        (-2.861000, -2.861000, 0.000000, 0.000000),\n        (-2.700000, -2.705500, 0.000000, 0.000000),\n        (-2.900000, -2.899800, 0.000000, 0.000000),\n    ]\n\n    results = []\n    for case in test_cases:\n        # Unpack the energy values for the current test case.\n        # Monomer A is He, Monomer B is H+.\n        E_A_A, E_A_AB, E_B_B, E_B_AB = case\n\n        # The BSSE is defined as:\n        # BSSE = (E_A^A - E_A^AB) + (E_B^B - E_B^AB)\n        \n        # Contribution from monomer A (He)\n        bsse_contrib_A = E_A_A - E_A_AB\n        \n        # Contribution from monomer B (H+). Since H+ has no electrons, its\n        # electronic energy is always zero, so this term is zero.\n        bsse_contrib_B = E_B_B - E_B_AB\n        \n        # Total BSSE is the sum of contributions.\n        total_bsse = bsse_contrib_A + bsse_contrib_B\n        \n        # Format the result to 6 decimal places as required.\n        # Using f-string formatting ensures correct rounding and trailing zeros.\n        results.append(f\"{total_bsse:.6f}\")\n\n    # Final print statement in the exact required format: a single line with\n    # a comma-separated list of results enclosed in square brackets.\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "After mastering the basic calculation, we now explore *why* BSSE correction is so crucial. This exercise presents a hypothetical but illuminating scenario: a water dimer where one molecule is described by a large, flexible basis set and the other by a minimal one. By calculating the raw interaction energy, the BSSE, and the final counterpoise-corrected interaction energy, you will directly observe how BSSE can create a significant, artificial attraction, sometimes even masking an underlying repulsive interaction. ",
            "id": "2450800",
            "problem": "You will analyze Basis Set Superposition Error (BSSE) in an intentionally imbalanced hydrogen-bonded water dimer: one monomer uses a large, diffuse basis (augmented correlation-consistent polarized valence quadruple zeta), and the other uses a minimal basis (Slater-Type Orbital with three Gaussians). Basis Set Superposition Error (BSSE) arises when monomers in a complex artificially stabilize by \"borrowing\" each other's basis functions. Counterpoise (CP) correction compensates for this effect by evaluating each monomer in the full dimer basis with the partner's nuclei replaced by non-interacting \"ghost\" centers that supply basis functions without electrons or nuclei.\n\nDefine the following total electronic energies, all expressed in Hartree, the atomic unit of energy, and denote monomer A as the water molecule with the large basis and monomer B as the water molecule with the minimal basis:\n- Dimer energy in the full dimer basis: $E_{AB}^{(AB)}$.\n- Monomer energies in their own bases: $E_{A}^{(A)}$ and $E_{B}^{(B)}$.\n- Monomer energies in the full dimer basis with the partner present only as ghost basis functions: $E_{A}^{(AB)}$ and $E_{B}^{(AB)}$.\n\nFor each test case, compute the following quantities, each in Hartree:\n1. The raw interaction energy $\\,\\Delta E_{\\text{raw}} = E_{AB}^{(AB)} - E_{A}^{(A)} - E_{B}^{(B)}\\,$.\n2. The BSSE magnitude as a positive quantity\n$$\n\\text{BSSE} = -\\Big[\\big(E_{A}^{(AB)} - E_{A}^{(A)}\\big) + \\big(E_{B}^{(AB)} - E_{B}^{(B)}\\big)\\Big].\n$$\n3. The Counterpoise-corrected interaction energy\n$$\n\\Delta E_{\\text{CP}} = E_{AB}^{(AB)} - E_{A}^{(AB)} - E_{B}^{(AB)}.\n$$\n4. A boolean flag that is true if and only if $\\,\\Delta E_{\\text{CP}} > \\Delta E_{\\text{raw}}\\,$.\n\nExpress all energies in Hartree, with no unit conversion. The boolean must be a language-native boolean constant. No angles or percentages are involved.\n\nUse the following test suite, each line listing $\\big(E_{AB}^{(AB)}, E_{A}^{(A)}, E_{B}^{(B)}, E_{A}^{(AB)}, E_{B}^{(AB)}\\big)$ in Hartree:\n- Test 1 (extreme imbalance, strong borrowing by the minimal-basis monomer):\n  $\\big(-152.0520,\\,-76.0570,\\,-75.9830,\\,-76.0600,\\,-76.0100\\big)$.\n- Test 2 (balanced reference, no BSSE by construction):\n  $\\big(-152.0700,\\,-76.0500,\\,-76.0100,\\,-76.0500,\\,-76.0100\\big)$.\n- Test 3 (small net BSSE with a slight numerical anomaly):\n  $\\big(-152.0340,\\,-76.0400,\\,-75.9900,\\,-76.0398,\\,-75.9906\\big)$.\n- Test 4 (extreme imbalance, BSSE overwhelms the raw attraction):\n  $\\big(-152.0180,\\,-76.0570,\\,-75.9500,\\,-76.0605,\\,-75.9800\\big)$.\n\nYour program should read no input and should compute, for each test in the above order, the list\n$[\\Delta E_{\\text{raw}},\\, \\text{BSSE},\\, \\Delta E_{\\text{CP}},\\, \\text{flag}]$.\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets, where each element is the list for one test case, in order. For example: `[[x11,x12,x13,x14],[x21,x22,x23,x24]]` where $x_{ij}$ are the quantities defined above in Hartree and the booleans are unquoted language-native boolean literals.",
            "solution": "The problem statement is submitted for validation. The problem is deemed valid. It is scientifically grounded, well-posed, and objective. It presents a standard exercise in computational quantum chemistry concerning the Basis Set Superposition Error (BSSE). All provided definitions and data are self-contained, consistent, and sufficient for a unique solution.\n\nThe central concept is the Basis Set Superposition Error, an artifact that arises in the calculation of intermolecular interaction energies when using incomplete, atom-centered basis sets. According to the variational principle, the ground-state energy calculated for a system is an upper bound to the true ground-state energy. A more flexible basis set (i.e., one with more basis functions) allows for a better approximation of the true wavefunction, resulting in a lower, more accurate energy. In a molecular complex, a monomer can improve its own description by \"borrowing\" basis functions from a nearby monomer, a non-physical effect which leads to an artificial stabilization. The counterpoise (CP) correction, proposed by Boys and Bernardi, is the standard method to correct for this error.\n\nThe problem defines five energy components for a two-monomer system, A and B:\n- $E_{AB}^{(AB)}$: The total energy of the dimer $AB$, where all atoms have their basis functions.\n- $E_{A}^{(A)}$ and $E_{B}^{(B)}$: The energies of isolated monomers $A$ and $B$, each calculated with only its own basis set.\n- $E_{A}^{(AB)}$ and $E_{B}^{(AB)}$: The energies of monomer $A$ and $B$, respectively, calculated in the presence of the partner's basis functions centered on \"ghost\" atoms (nuclei and electrons removed).\n\nThe variational principle dictates that $E_{A}^{(AB)} \\le E_{A}^{(A)}$ and $E_{B}^{(AB)} \\le E_{B}^{(B)}$, because the basis set $(AB)$ is a superset of basis sets $(A)$ and $(B)$ individually. The energy can only decrease or stay the same with the addition of more basis functions. Test case $3$ presents a minor anomaly where $E_{A}^{(AB)} = -76.0398 > E_{A}^{(A)} = -76.0400$. This is a small violation of the variational principle, likely due to insignificant numerical noise from different convergence thresholds or integration grids used in the underlying quantum chemistry calculations, a common occurrence in practice. It does not invalidate the logic of the problem itself.\n\nThe quantities to be computed are:\n$1$. The raw interaction energy, $\\Delta E_{\\text{raw}} = E_{AB}^{(AB)} - E_{A}^{(A)} - E_{B}^{(B)}$. This quantity incorrectly compares the fully stabilized dimer with the less-stabilized isolated monomers, thus overestimating the interaction strength.\n\n$2$. The Basis Set Superposition Error, $\\text{BSSE}$. The problem defines it as a positive magnitude:\n$$\n\\text{BSSE} = -\\Big[\\big(E_{A}^{(AB)} - E_{A}^{(A)}\\big) + \\big(E_{B}^{(AB)} - E_{B}^{(B)}\\big)\\Big]\n$$\nThis can be rewritten as $\\text{BSSE} = (E_{A}^{(A)} - E_{A}^{(AB)}) + (E_{B}^{(B)} - E_{B}^{(AB)})$. Each term $(E_{M}^{(M)} - E_{M}^{(MN)})$ represents the stabilization energy gained by monomer $M$ from borrowing the basis functions of monomer $N$. By the variational principle, these terms are non-negative, and so is the BSSE.\n\n$3$. The counterpoise-corrected interaction energy, $\\Delta E_{\\text{CP}} = E_{AB}^{(AB)} - E_{A}^{(AB)} - E_{B}^{(AB)}$. This represents a more physically meaningful interaction energy, as the energies of the fragments are computed in the same basis (the full dimer basis) as the dimer itself, canceling the artificial stabilization.\n\nAn important relationship exists between these quantities. By substituting the definitions, it is elementary to show that:\n$$\n\\Delta E_{\\text{CP}} = \\Delta E_{\\text{raw}} + \\text{BSSE}\n$$\n$$\nE_{AB}^{(AB)} - E_{A}^{(AB)} - E_{B}^{(AB)} = \\big(E_{AB}^{(AB)} - E_{A}^{(A)} - E_{B}^{(B)}\\big) + \\big( (E_{A}^{(A)} - E_{A}^{(AB)}) + (E_{B}^{(B)} - E_{B}^{(AB)}) \\big)\n$$\nThe terms on the right side cancel to yield the expression on the left, confirming the identity.\n\n$4$. The boolean flag. The condition for the flag is $\\Delta E_{\\text{CP}} > \\Delta E_{\\text{raw}}$. Using the identity derived above, this is equivalent to $\\Delta E_{\\text{raw}} + \\text{BSSE} > \\Delta E_{\\text{raw}}$, which simplifies to $\\text{BSSE} > 0$. The flag is therefore true if and only if there is a non-zero basis set superposition error. This will be the case for any incomplete basis set. In the idealized Test Case $2$, BSSE is zero by construction, so the flag will be False. For all other cases, we expect a positive BSSE and a True flag.\n\nThe algorithmic procedure is to iterate through each test case, substitute the given five energy values into the four formulas, and assemble the results.\n\nFor Test Case $1$ $\\big(E_{AB}^{(AB)}, E_{A}^{(A)}, E_{B}^{(B)}, E_{A}^{(AB)}, E_{B}^{(AB)}\\big) = \\big(-152.0520, -76.0570, -75.9830, -76.0600, -76.0100\\big)$:\n- $\\Delta E_{\\text{raw}} = -152.0520 - (-76.0570 - 75.9830) = -0.0120$ Hartree.\n- $\\text{BSSE} = -[(-76.0600 - (-76.0570)) + (-76.0100 - (-75.9830))] = 0.0300$ Hartree.\n- $\\Delta E_{\\text{CP}} = -152.0520 - (-76.0600 - 76.0100) = 0.0180$ Hartree.\n- Flag: $0.0180 > -0.0120$ is True.\n\nThe calculation is repeated for all test cases as implemented in the following program. The results demonstrate the importance of the CP correction; for instance, in Test Case $4$, a seemingly attractive interaction ($\\Delta E_{\\text{raw}} = -0.0110$ Hartree) is revealed to be repulsive ($\\Delta E_{\\text{CP}} = 0.0225$ Hartree) once the large BSSE is removed.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n# No other libraries are needed for this problem.\n\ndef solve():\n    \"\"\"\n    Solves the Basis Set Superposition Error (BSSE) problem for a given suite of test cases.\n    \"\"\"\n\n    # Define the test cases from the problem statement.\n    # Each tuple contains (E_AB^(AB), E_A^(A), E_B^(B), E_A^(AB), E_B^(AB)) in Hartree.\n    test_cases = [\n        # Test 1 (extreme imbalance, strong borrowing by the minimal-basis monomer)\n        (-152.0520, -76.0570, -75.9830, -76.0600, -76.0100),\n        # Test 2 (balanced reference, no BSSE by construction)\n        (-152.0700, -76.0500, -76.0100, -76.0500, -76.0100),\n        # Test 3 (small net BSSE with a slight numerical anomaly)\n        (-152.0340, -76.0400, -75.9900, -76.0398, -75.9906),\n        # Test 4 (extreme imbalance, BSSE overwhelms the raw attraction)\n        (-152.0180, -76.0570, -75.9500, -76.0605, -75.9800),\n    ]\n\n    all_results = []\n    for case in test_cases:\n        E_AB_AB, E_A_A, E_B_B, E_A_AB, E_B_AB = case\n\n        # 1. Compute the raw interaction energy, delta_E_raw\n        # delta_E_raw = E_AB^(AB) - E_A^(A) - E_B^(B)\n        delta_E_raw = E_AB_AB - (E_A_A + E_B_B)\n\n        # 2. Compute the BSSE magnitude\n        # BSSE = -[(E_A^(AB) - E_A^(A)) + (E_B^(AB) - E_B^(B))]\n        bsse = -((E_A_AB - E_A_A) + (E_B_AB - E_B_B))\n\n        # 3. Compute the Counterpoise-corrected interaction energy, delta_E_CP\n        # delta_E_CP = E_AB^(AB) - E_A^(AB) - E_B^(AB)\n        delta_E_cp = E_AB_AB - (E_A_AB + E_B_AB)\n\n        # As a verification, delta_E_CP should equal delta_E_raw + BSSE\n        # For floating point numbers, it's better to check for near equality,\n        # but the identity is exact and inputs are well-behaved here.\n        # assert np.isclose(delta_E_cp, delta_E_raw + bsse)\n\n        # 4. Compute the boolean flag\n        # flag = True if delta_E_CP > delta_E_raw\n        flag = delta_E_cp > delta_E_raw\n\n        # Append the list of results for this test case\n        # np.round is used to handle potential floating point inaccuracies from subtraction,\n        # ensuring clean output matching manual calculations.\n        # A precision of 6 decimal places is sufficient for these values.\n        result_list = [\n            np.round(delta_E_raw, 6),\n            np.round(bsse, 6),\n            np.round(delta_E_cp, 6),\n            flag\n        ]\n        all_results.append(result_list)\n\n    # Format the final output string exactly as specified.\n    # Each sublist is converted to a string, removing spaces.\n    # The list of these strings is joined by commas.\n    # The final result is enclosed in brackets.\n    sublist_strings = [f\"[{','.join(map(str, res))}]\" for res in all_results]\n    final_output = f\"[{','.join(sublist_strings)}]\"\n    \n    # Final print statement in the exact required format.\n    print(final_output)\n\nsolve()\n```"
        },
        {
            "introduction": "Beyond absolute interaction energies, BSSE can also significantly impact *relative* energies between different molecular conformations, a quantity of great chemical interest. In this final practice, we examine the rotational barrier of ethane by treating it as a dimer of two methyl ($\\mathrm{CH_3}$) fragments. This problem demonstrates that BSSE can be geometry-dependent and that applying a counterpoise correction is essential for obtaining accurate energy differences between conformers like the eclipsed and staggered forms. ",
            "id": "2450842",
            "problem": "Consider the molecule ethane, $\\mathrm{C_2H_6}$, fragmented into two methyl radicals, $\\mathrm{CH_3}$ and $\\mathrm{CH_3}$. Let the total electronic energy of a given conformation $X \\in \\{\\text{eclipsed}, \\text{staggered}\\}$ computed with the full basis on all atoms be denoted by $E_{X}^{AB}$ (in Hartree, $\\mathrm{E_h}$). For each conformation $X$, let $E_{A,X}^{A}$ and $E_{B,X}^{B}$ be the monomer energies (fragments $\\mathrm{CH_3}$ labeled $A$ and $B$) computed with their own fragment bases only, and let $E_{A,X}^{AB}$ and $E_{B,X}^{AB}$ be the corresponding monomer energies computed in the presence of the other fragment’s basis functions treated as basis-only “ghosts,” all at the geometry of the conformation $X$ and all in units of Hartree, $\\mathrm{E_h}$. The Basis Set Superposition Error (BSSE) for conformation $X$ is defined as the positive quantity\n$$\n\\mathrm{BSSE}_X = \\left(E_{A,X}^{A} - E_{A,X}^{AB}\\right) + \\left(E_{B,X}^{B} - E_{B,X}^{AB}\\right),\n$$\nand the BSSE-corrected total energy is\n$$\nE_{X}^{\\mathrm{corr}} = E_{X}^{AB} + \\mathrm{BSSE}_X.\n$$\nDefine the uncorrected conformational energy difference (eclipsed minus staggered) as\n$$\n\\Delta E_{\\mathrm{uncorr}} = E_{\\mathrm{eclipsed}}^{AB} - E_{\\mathrm{staggered}}^{AB},\n$$\nand the BSSE-corrected conformational energy difference as\n$$\n\\Delta E_{\\mathrm{corr}} = E_{\\mathrm{eclipsed}}^{\\mathrm{corr}} - E_{\\mathrm{staggered}}^{\\mathrm{corr}}.\n$$\n\nUsing the following test suite of three cases ($3$ distinct sets of energies), compute $\\Delta E_{\\mathrm{uncorr}}$ and $\\Delta E_{\\mathrm{corr}}$ for each case. All energies are given in Hartree, $\\mathrm{E_h}$.\n\nTest suite:\n- Case $1$:\n  - $E_{\\mathrm{eclipsed}}^{AB} = -79.255000$, $E_{\\mathrm{staggered}}^{AB} = -79.256200$.\n  - $E_{A,\\mathrm{eclipsed}}^{A} = -39.700000$, $E_{B,\\mathrm{eclipsed}}^{B} = -39.700000$.\n  - $E_{A,\\mathrm{eclipsed}}^{AB} = -39.701000$, $E_{B,\\mathrm{eclipsed}}^{AB} = -39.701100$.\n  - $E_{A,\\mathrm{staggered}}^{A} = -39.700100$, $E_{B,\\mathrm{staggered}}^{B} = -39.700100$.\n  - $E_{A,\\mathrm{staggered}}^{AB} = -39.701000$, $E_{B,\\mathrm{staggered}}^{AB} = -39.701000$.\n- Case $2$:\n  - $E_{\\mathrm{eclipsed}}^{AB} = -79.250000$, $E_{\\mathrm{staggered}}^{AB} = -79.251000$.\n  - $E_{A,\\mathrm{eclipsed}}^{A} = -39.690000$, $E_{B,\\mathrm{eclipsed}}^{B} = -39.690000$.\n  - $E_{A,\\mathrm{eclipsed}}^{AB} = -39.690750$, $E_{B,\\mathrm{eclipsed}}^{AB} = -39.690750$.\n  - $E_{A,\\mathrm{staggered}}^{A} = -39.690500$, $E_{B,\\mathrm{staggered}}^{B} = -39.690500$.\n  - $E_{A,\\mathrm{staggered}}^{AB} = -39.691250$, $E_{B,\\mathrm{staggered}}^{AB} = -39.691250$.\n- Case $3$:\n  - $E_{\\mathrm{eclipsed}}^{AB} = -79.260000$, $E_{\\mathrm{staggered}}^{AB} = -79.260300$.\n  - $E_{A,\\mathrm{eclipsed}}^{A} = -39.695000$, $E_{B,\\mathrm{eclipsed}}^{B} = -39.695000$.\n  - $E_{A,\\mathrm{eclipsed}}^{AB} = -39.695500$, $E_{B,\\mathrm{eclipsed}}^{AB} = -39.695500$.\n  - $E_{A,\\mathrm{staggered}}^{A} = -39.695100$, $E_{B,\\mathrm{staggered}}^{B} = -39.695100$.\n  - $E_{A,\\mathrm{staggered}}^{AB} = -39.695850$, $E_{B,\\mathrm{staggered}}^{AB} = -39.695850$.\n\nRequirements:\n- For each case, compute $\\Delta E_{\\mathrm{uncorr}}$ and $\\Delta E_{\\mathrm{corr}}$ in Hartree, $\\mathrm{E_h}$.\n- Express each numerical result in Hartree, $\\mathrm{E_h}$, rounded to $6$ decimal places.\n- Your program should produce a single line of output containing the results as a list of lists in the exact format\n  $$\n  [[\\Delta E_{\\mathrm{uncorr}}^{(1)},\\Delta E_{\\mathrm{corr}}^{(1)}],[\\Delta E_{\\mathrm{uncorr}}^{(2)},\\Delta E_{\\mathrm{corr}}^{(2)}],[\\Delta E_{\\mathrm{uncorr}}^{(3)},\\Delta E_{\\mathrm{corr}}^{(3)}]]\n  $$\n  for the $3$ cases, printed as a single Python-style list literal on one line, for example $[[0.000000,0.000000],[0.000000,0.000000],[0.000000,0.000000]]$.",
            "solution": "The problem presented is valid. It is scientifically grounded in the principles of computational chemistry, specifically the counterpoise correction method for Basis Set Superposition Error (BSSE). All definitions are standard, all required data are provided, and the problem is well-posed, objective, and logically consistent. No contradictions or ambiguities are present. We shall proceed with the derivation of the solution.\n\nThe problem requires the calculation of the uncorrected and BSSE-corrected conformational energy differences between the eclipsed and staggered forms of ethane for three distinct sets of energy data. The core of the problem lies in the meticulous application of the provided formulas.\n\nLet us define the quantities for a given conformation $X \\in \\{\\text{eclipsed}, \\text{staggered}\\}$.\nThe total energy of the dimer (ethane) is $E_X^{AB}$.\nThe energy of monomer $A$ (a $\\mathrm{CH_3}$ fragment) in its own basis is $E_{A,X}^A$.\nThe energy of monomer $B$ (the other $\\mathrm{CH_3}$ fragment) in its own basis is $E_{B,X}^B$.\nThe energy of monomer $A$ in the combined basis of fragments $A$ and $B$ (where $B$'s basis functions are \"ghost orbitals\") is $E_{A,X}^{AB}$.\nThe energy of monomer $B$ in the combined basis is $E_{B,X}^{AB}$.\n\nThe Basis Set Superposition Error for conformation $X$, as defined, is the positive quantity:\n$$\n\\mathrm{BSSE}_X = \\left(E_{A,X}^{A} - E_{A,X}^{AB}\\right) + \\left(E_{B,X}^{B} - E_{B,X}^{AB}\\right)\n$$\nAccording to the variational principle, the energy of a fragment calculated with a larger basis set (i.e., including ghost orbitals from the other fragment) must be lower than or equal to the energy calculated with its own basis set alone. Thus, $E_{A,X}^{AB} \\leq E_{A,X}^A$ and $E_{B,X}^{AB} \\leq E_{B,X}^B$, which implies that $\\mathrm{BSSE}_X$ is a non-negative quantity.\n\nThe BSSE-corrected total energy for conformation $X$ is then:\n$$\nE_{X}^{\\mathrm{corr}} = E_{X}^{AB} + \\mathrm{BSSE}_X\n$$\nSince $\\mathrm{BSSE}_X \\geq 0$, the corrected energy $E_{X}^{\\mathrm{corr}}$ is greater than or equal to the uncorrected energy $E_{X}^{AB}$. This correctly accounts for the artificial stabilization introduced by the basis set superposition.\n\nThe uncorrected and corrected conformational energy differences (eclipsed minus staggered) are:\n$$\n\\Delta E_{\\mathrm{uncorr}} = E_{\\mathrm{eclipsed}}^{AB} - E_{\\mathrm{staggered}}^{AB}\n$$\n$$\n\\Delta E_{\\mathrm{corr}} = E_{\\mathrm{eclipsed}}^{\\mathrm{corr}} - E_{\\mathrm{staggered}}^{\\mathrm{corr}} = (E_{\\mathrm{eclipsed}}^{AB} + \\mathrm{BSSE}_{\\mathrm{eclipsed}}) - (E_{\\mathrm{staggered}}^{AB} + \\mathrm{BSSE}_{\\mathrm{staggered}})\n$$\nWe will now compute these quantities for each test case. All energies are in units of Hartree, $\\mathrm{E_h}$.\n\nCase $1$:\nFirst, we compute the uncorrected energy difference:\n$$\n\\Delta E_{\\mathrm{uncorr}}^{(1)} = E_{\\mathrm{eclipsed}}^{AB} - E_{\\mathrm{staggered}}^{AB} = -79.255000 - (-79.256200) = 0.001200\\ \\mathrm{E_h}\n$$\nNext, we determine the BSSE for each conformation.\nFor the eclipsed conformation:\n$$\n\\mathrm{BSSE}_{\\mathrm{eclipsed}}^{(1)} = (E_{A,\\mathrm{eclipsed}}^{A} - E_{A,\\mathrm{eclipsed}}^{AB}) + (E_{B,\\mathrm{eclipsed}}^{B} - E_{B,\\mathrm{eclipsed}}^{AB})\n$$\n$$\n\\mathrm{BSSE}_{\\mathrm{eclipsed}}^{(1)} = (-39.700000 - (-39.701000)) + (-39.700000 - (-39.701100)) = 0.001000 + 0.001100 = 0.002100\\ \\mathrm{E_h}\n$$\nFor the staggered conformation:\n$$\n\\mathrm{BSSE}_{\\mathrm{staggered}}^{(1)} = (E_{A,\\mathrm{staggered}}^{A} - E_{A,\\mathrm{staggered}}^{AB}) + (E_{B,\\mathrm{staggered}}^{B} - E_{B,\\mathrm{staggered}}^{AB})\n$$\n$$\n\\mathrm{BSSE}_{\\mathrm{staggered}}^{(1)} = (-39.700100 - (-39.701000)) + (-39.700100 - (-39.701000)) = 0.000900 + 0.000900 = 0.001800\\ \\mathrm{E_h}\n$$\nNow we compute the corrected energies:\n$$\nE_{\\mathrm{eclipsed}}^{\\mathrm{corr},(1)} = E_{\\mathrm{eclipsed}}^{AB} + \\mathrm{BSSE}_{\\mathrm{eclipsed}}^{(1)} = -79.255000 + 0.002100 = -79.252900\\ \\mathrm{E_h}\n$$\n$$\nE_{\\mathrm{staggered}}^{\\mathrm{corr},(1)} = E_{\\mathrm{staggered}}^{AB} + \\mathrm{BSSE}_{\\mathrm{staggered}}^{(1)} = -79.256200 + 0.001800 = -79.254400\\ \\mathrm{E_h}\n$$\nFinally, the corrected energy difference is:\n$$\n\\Delta E_{\\mathrm{corr}}^{(1)} = E_{\\mathrm{eclipsed}}^{\\mathrm{corr},(1)} - E_{\\mathrm{staggered}}^{\\mathrm{corr},(1)} = -79.252900 - (-79.254400) = 0.001500\\ \\mathrm{E_h}\n$$\nFor Case $1$, the results are $\\Delta E_{\\mathrm{uncorr}}^{(1)} = 0.001200\\ \\mathrm{E_h}$ and $\\Delta E_{\\mathrm{corr}}^{(1)} = 0.001500\\ \\mathrm{E_h}$.\n\nCase $2$:\nProceeding in the same manner:\n$$\n\\Delta E_{\\mathrm{uncorr}}^{(2)} = E_{\\mathrm{eclipsed}}^{AB} - E_{\\mathrm{staggered}}^{AB} = -79.250000 - (-79.251000) = 0.001000\\ \\mathrm{E_h}\n$$\nThe BSSE values are:\n$$\n\\mathrm{BSSE}_{\\mathrm{eclipsed}}^{(2)} = 2 \\times (-39.690000 - (-39.690750)) = 2 \\times (0.000750) = 0.001500\\ \\mathrm{E_h}\n$$\n$$\n\\mathrm{BSSE}_{\\mathrm{staggered}}^{(2)} = 2 \\times (-39.690500 - (-39.691250)) = 2 \\times (0.000750) = 0.001500\\ \\mathrm{E_h}\n$$\nIn this instance, the BSSE is identical for both conformations.\nThe corrected energies are:\n$$\nE_{\\mathrm{eclipsed}}^{\\mathrm{corr},(2)} = -79.250000 + 0.001500 = -79.248500\\ \\mathrm{E_h}\n$$\n$$\nE_{\\mathrm{staggered}}^{\\mathrm{corr},(2)} = -79.251000 + 0.001500 = -79.249500\\ \\mathrm{E_h}\n$$\nThe corrected energy difference is:\n$$\n\\Delta E_{\\mathrm{corr}}^{(2)} = -79.248500 - (-79.249500) = 0.001000\\ \\mathrm{E_h}\n$$\nFor Case $2$, the results are $\\Delta E_{\\mathrm{uncorr}}^{(2)} = 0.001000\\ \\mathrm{E_h}$ and $\\Delta E_{\\mathrm{corr}}^{(2)} = 0.001000\\ \\mathrm{E_h}$. The correction does not alter the energy difference.\n\nCase $3$:\nFinally, for the third case:\n$$\n\\Delta E_{\\mathrm{uncorr}}^{(3)} = E_{\\mathrm{eclipsed}}^{AB} - E_{\\mathrm{staggered}}^{AB} = -79.260000 - (-79.260300) = 0.000300\\ \\mathrm{E_h}\n$$\nThe BSSE values are:\n$$\n\\mathrm{BSSE}_{\\mathrm{eclipsed}}^{(3)} = 2 \\times (-39.695000 - (-39.695500)) = 2 \\times (0.000500) = 0.001000\\ \\mathrm{E_h}\n$$\n$$\n\\mathrm{BSSE}_{\\mathrm{staggered}}^{(3)} = 2 \\times (-39.695100 - (-39.695850)) = 2 \\times (0.000750) = 0.001500\\ \\mathrm{E_h}\n$$\nThe corrected energies are:\n$$\nE_{\\mathrm{eclipsed}}^{\\mathrm{corr},(3)} = -79.260000 + 0.001000 = -79.259000\\ \\mathrm{E_h}\n$$\n$$\nE_{\\mathrm{staggered}}^{\\mathrm{corr},(3)} = -79.260300 + 0.001500 = -79.258800\\ \\mathrm{E_h}\n$$\nThe corrected energy difference is:\n$$\n\\Delta E_{\\mathrm{corr}}^{(3)} = -79.259000 - (-79.258800) = -0.000200\\ \\mathrm{E_h}\n$$\nFor Case $3$, the results are $\\Delta E_{\\mathrm{uncorr}}^{(3)} = 0.000300\\ \\mathrm{E_h}$ and $\\Delta E_{\\mathrm{corr}}^{(3)} = -0.000200\\ \\mathrm{E_h}$. This demonstrates a case where the BSSE correction is critical, as it inverts the sign of the energy difference, qualitatively changing the energetic ordering of the conformations.\n\nThe following program implements these calculations systematically.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the Basis Set Superposition Error problem for three test cases\n    of ethane conformations.\n    \"\"\"\n    \n    # Test cases defined as a list of dictionaries. Each dictionary contains\n    # all necessary energy values for a single case.\n    # All energies are in Hartree (Eh).\n    test_cases = [\n        # Case 1\n        {\n            \"E_ecl_AB\": -79.255000, \"E_stg_AB\": -79.256200,\n            \"E_A_ecl_A\": -39.700000, \"E_B_ecl_B\": -39.700000,\n            \"E_A_ecl_AB\": -39.701000, \"E_B_ecl_AB\": -39.701100,\n            \"E_A_stg_A\": -39.700100, \"E_B_stg_B\": -39.700100,\n            \"E_A_stg_AB\": -39.701000, \"E_B_stg_AB\": -39.701000,\n        },\n        # Case 2\n        {\n            \"E_ecl_AB\": -79.250000, \"E_stg_AB\": -79.251000,\n            \"E_A_ecl_A\": -39.690000, \"E_B_ecl_B\": -39.690000,\n            \"E_A_ecl_AB\": -39.690750, \"E_B_ecl_AB\": -39.690750,\n            \"E_A_stg_A\": -39.690500, \"E_B_stg_B\": -39.690500,\n            \"E_A_stg_AB\": -39.691250, \"E_B_stg_AB\": -39.691250,\n        },\n        # Case 3\n        {\n            \"E_ecl_AB\": -79.260000, \"E_stg_AB\": -79.260300,\n            \"E_A_ecl_A\": -39.695000, \"E_B_ecl_B\": -39.695000,\n            \"E_A_ecl_AB\": -39.695500, \"E_B_ecl_AB\": -39.695500,\n            \"E_A_stg_A\": -39.695100, \"E_B_stg_B\": -39.695100,\n            \"E_A_stg_AB\": -39.695850, \"E_B_stg_AB\": -39.695850,\n        },\n    ]\n\n    results = []\n    \n    for case_data in test_cases:\n        # Calculate uncorrected conformational energy difference\n        delta_e_uncorr = case_data[\"E_ecl_AB\"] - case_data[\"E_stg_AB\"]\n\n        # Calculate BSSE for the eclipsed conformation (as a positive quantity)\n        bsse_ecl = (case_data[\"E_A_ecl_A\"] - case_data[\"E_A_ecl_AB\"]) + \\\n                   (case_data[\"E_B_ecl_B\"] - case_data[\"E_B_ecl_AB\"])\n\n        # Calculate BSSE for the staggered conformation (as a positive quantity)\n        bsse_stg = (case_data[\"E_A_stg_A\"] - case_data[\"E_A_stg_AB\"]) + \\\n                   (case_data[\"E_B_stg_B\"] - case_data[\"E_B_stg_AB\"])\n\n        # Calculate BSSE-corrected energies for each conformation\n        e_ecl_corr = case_data[\"E_ecl_AB\"] + bsse_ecl\n        e_stg_corr = case_data[\"E_stg_AB\"] + bsse_stg\n\n        # Calculate BSSE-corrected conformational energy difference\n        delta_e_corr = e_ecl_corr - e_stg_corr\n        \n        results.append([delta_e_uncorr, delta_e_corr])\n\n    # Format the results into the required string format.\n    # Each number must be rounded to 6 decimal places with trailing zeros.\n    formatted_pairs = []\n    for uncorr, corr in results:\n        # Use f-string formatting to ensure 6 decimal places.\n        formatted_pairs.append(f\"[{uncorr:.6f},{corr:.6f}]\")\n    \n    # Join the formatted pairs into a single string representing a list of lists.\n    final_output_string = f\"[{','.join(formatted_pairs)}]\"\n    \n    print(final_output_string)\n\nsolve()\n```"
        }
    ]
}