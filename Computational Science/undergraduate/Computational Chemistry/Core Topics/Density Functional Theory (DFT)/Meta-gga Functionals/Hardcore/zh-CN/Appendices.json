{
    "hands_on_practices": [
        {
            "introduction": "要真正理解meta-GGA泛函的内部工作原理，最好的方法是从其基本构成单元入手。本练习将引导您在一个空间点上，逐步计算meta-GGA交换泛函的所有关键组成部分。通过这个过程，您将通过计算具体数值来揭开那些看似复杂的公式的神秘面纱，并直观地感受各项的量级 。",
            "id": "2457672",
            "problem": "考虑一个闭壳层氖原子，在 Kohn–Sham 密度泛函理论 (DFT) 和 meta-广义梯度近似 (meta-GGA) 交换泛函的处理下，其数值求积网格上的一个实空间积分点 $\\mathbf{r}$。假设该点的密度是自旋非极化的，因此自旋向上和自旋向下的密度相等。完全在原子单位（能量为 Hartree，长度为 Bohr）下进行计算，并将以下在 $\\mathbf{r}$ 点的量视为已知：\n- 电子密度 $n(\\mathbf{r}) = 0.200$，\n- 密度梯度大小 $\\lvert \\nabla n(\\mathbf{r}) \\rvert = 0.350$，\n- Kohn–Sham 轨道动能密度 $\\tau(\\mathbf{r}) = 0.150$。\n\n从均匀电子气的第一性原理和标准的 meta-GGA 成分出发，通过以下定义来获得 meta-GGA 交换能量密度 $e_{x}^{\\text{meta}}(\\mathbf{r})$：\n1. 密度为 $n(\\mathbf{r})$ 的均匀电子气的费米波矢 $k_{F}(\\mathbf{r})$ 为 $k_{F}(\\mathbf{r}) = \\big(3\\pi^{2} n(\\mathbf{r})\\big)^{1/3}$。\n2. 约化密度梯度 $s(\\mathbf{r})$ 为 $s(\\mathbf{r}) = \\dfrac{\\lvert \\nabla n(\\mathbf{r}) \\rvert}{2 k_{F}(\\mathbf{r})\\, n(\\mathbf{r})}$。\n3. von Weizsäcker 动能密度为 $\\tau_{W}(\\mathbf{r}) = \\dfrac{\\lvert \\nabla n(\\mathbf{r}) \\rvert^{2}}{8\\, n(\\mathbf{r})}$。\n4. 均匀电子气动能密度为 $\\tau_{\\text{unif}}(\\mathbf{r}) = \\dfrac{3}{10}\\big(3\\pi^{2}\\big)^{2/3} n(\\mathbf{r})^{5/3}$。\n5. 等轨道指示因子为 $\\alpha(\\mathbf{r}) = \\dfrac{\\tau(\\mathbf{r}) - \\tau_{W}(\\mathbf{r})}{\\tau_{\\text{unif}}(\\mathbf{r})}$。\n6. 局域密度近似 (LDA) 交换能量密度为 $e_{x}^{\\text{LDA}}(\\mathbf{r}) = - C_{x}\\, n(\\mathbf{r})^{4/3}$，其中 $C_{x} = \\dfrac{3}{4}\\big(\\dfrac{3}{\\pi}\\big)^{1/3}$。\n7. meta-GGA 交换增强因子（在本问题中）定义为\n$$\nF_{x}\\big(s(\\mathbf{r}), \\alpha(\\mathbf{r})\\big) \\;=\\; 1 + \\kappa \\;-\\; \\dfrac{\\kappa}{1 + \\mu\\, s(\\mathbf{r})^{2} + \\beta\\, \\alpha(\\mathbf{r})},\n$$\n其中常数 $\\kappa = 0.804$，$\\mu = 0.21951$，以及 $\\beta = 0.100$。\n8. meta-GGA 交换能量密度为 $e_{x}^{\\text{meta}}(\\mathbf{r}) = e_{x}^{\\text{LDA}}(\\mathbf{r}) \\, F_{x}\\big(s(\\mathbf{r}), \\alpha(\\mathbf{r})\\big)$。\n\n使用所提供的值，数值计算 $e_{x}^{\\text{meta}}(\\mathbf{r})$。将你的最终答案表示为一个以 Hartree/Bohr$^{3}$ 为单位的数字，并四舍五入到四位有效数字。",
            "solution": "问题陈述经验证是自洽的，科学上基于 Kohn-Sham 密度泛函理论的原理，并且在数值上是适定的。所有必需的常数、变量和泛函形式都已明确给出，可以进行直接、无歧义的计算。存在唯一解，将通过有条不紊地应用给定定义来推导得出。\n\n我们在原子单位下获得了在点 $\\mathbf{r}$ 的以下局域量：\n- 电子密度: $n(\\mathbf{r}) = 0.200$\n- 密度梯度的大小: $\\lvert \\nabla n(\\mathbf{r}) \\rvert = 0.350$\n- Kohn-Sham 轨道动能密度: $\\tau(\\mathbf{r}) = 0.150$\n\n计算按定义的步骤顺序进行。\n\n1.  计算费米波矢, $k_{F}(\\mathbf{r})$。\n    均匀电子气的费米波矢公式为 $k_{F}(\\mathbf{r}) = \\big(3\\pi^{2} n(\\mathbf{r})\\big)^{1/3}$。\n    代入给定的电子密度 $n(\\mathbf{r}) = 0.200$：\n    $$k_{F}(\\mathbf{r}) = \\big(3\\pi^{2} \\times 0.200\\big)^{1/3} = (0.6\\pi^{2})^{1/3} \\approx 1.80918$$\n\n2.  计算约化密度梯度, $s(\\mathbf{r})$。\n    提供的定义是 $s(\\mathbf{r}) = \\dfrac{\\lvert \\nabla n(\\mathbf{r}) \\rvert}{2 k_{F}(\\mathbf{r})\\, n(\\mathbf{r})}$。\n    使用给定值和计算出的 $k_{F}(\\mathbf{r})$:\n    $$s(\\mathbf{r}) = \\dfrac{0.350}{2 \\times 1.80918 \\times 0.200} \\approx \\dfrac{0.350}{0.723672} \\approx 0.48364$$\n\n3.  计算 von Weizsäcker 动能密度, $\\tau_{W}(\\mathbf{r})$。\n    其定义为 $\\tau_{W}(\\mathbf{r}) = \\dfrac{\\lvert \\nabla n(\\mathbf{r}) \\rvert^{2}}{8\\, n(\\mathbf{r})}$。\n    代入给定值：\n    $$\\tau_{W}(\\mathbf{r}) = \\dfrac{(0.350)^{2}}{8 \\times 0.200} = \\dfrac{0.1225}{1.6} = 0.0765625$$\n\n4.  计算均匀电子气动能密度, $\\tau_{\\text{unif}}(\\mathbf{r})$。\n    公式为 $\\tau_{\\text{unif}}(\\mathbf{r}) = \\dfrac{3}{10}\\big(3\\pi^{2}\\big)^{2/3} n(\\mathbf{r})^{5/3}$。\n    代入 $n(\\mathbf{r}) = 0.200$：\n    $$\\tau_{\\text{unif}}(\\mathbf{r}) = \\dfrac{3}{10}\\big(3\\pi^{2}\\big)^{2/3} (0.200)^{5/3} \\approx 0.3 \\times 9.58231 \\times 0.068399 \\approx 0.196388$$\n\n5.  计算等轨道指示因子, $\\alpha(\\mathbf{r})$。\n    定义是 $\\alpha(\\mathbf{r}) = \\dfrac{\\tau(\\mathbf{r}) - \\tau_{W}(\\mathbf{r})}{\\tau_{\\text{unif}}(\\mathbf{r})}$。\n    使用给定的 $\\tau(\\mathbf{r})$ 以及计算出的 $\\tau_{W}(\\mathbf{r})$ 和 $\\tau_{\\text{unif}}(\\mathbf{r})$:\n    $$\\alpha(\\mathbf{r}) = \\dfrac{0.150 - 0.0765625}{0.196388} = \\dfrac{0.0734375}{0.196388} \\approx 0.37394$$\n\n6.  计算局域密度近似 (LDA) 交换能量密度, $e_{x}^{\\text{LDA}}(\\mathbf{r})$。\n    它由 $e_{x}^{\\text{LDA}}(\\mathbf{r}) = - C_{x}\\, n(\\mathbf{r})^{4/3}$ 给出，其中常数 $C_{x} = \\dfrac{3}{4}\\big(\\dfrac{3}{\\pi}\\big)^{1/3}$。\n    首先，我们计算 $C_x$：\n    $$C_{x} = \\dfrac{3}{4}\\big(\\dfrac{3}{\\pi}\\big)^{1/3} \\approx 0.75 \\times (0.95493)^{1/3} \\approx 0.75 \\times 0.984745 \\approx 0.73856$$\n    现在，我们计算 $e_{x}^{\\text{LDA}}(\\mathbf{r})$：\n    $$e_{x}^{\\text{LDA}}(\\mathbf{r}) = - (0.73856) \\times (0.200)^{4/3} \\approx -0.73856 \\times 0.11696 \\approx -0.086383$$\n\n7.  计算 meta-GGA 交换增强因子, $F_{x}\\big(s(\\mathbf{r}), \\alpha(\\mathbf{r})\\big)$。\n    问题指定了形式 $F_{x} = 1 + \\kappa - \\dfrac{\\kappa}{1 + \\mu\\, s(\\mathbf{r})^{2} + \\beta\\, \\alpha(\\mathbf{r})}$，其中常数 $\\kappa = 0.804$，$\\mu = 0.21951$，以及 $\\beta = 0.100$。\n    我们代入计算出的 $s(\\mathbf{r})$ 和 $\\alpha(\\mathbf{r})$ 的值：\n    $$F_{x} = 1 + 0.804 - \\dfrac{0.804}{1 + (0.21951)(0.48364)^{2} + (0.100)(0.37394)}$$\n    $$F_{x} = 1.804 - \\dfrac{0.804}{1 + (0.21951)(0.233908) + 0.037394}$$\n    $$F_{x} = 1.804 - \\dfrac{0.804}{1 + 0.051346 + 0.037394} = 1.804 - \\dfrac{0.804}{1.08874} \\approx 1.804 - 0.73847 \\approx 1.06553$$\n\n8.  计算最终的 meta-GGA 交换能量密度, $e_{x}^{\\text{meta}}(\\mathbf{r})$。\n    这是 LDA 能量密度和增强因子的乘积： $e_{x}^{\\text{meta}}(\\mathbf{r}) = e_{x}^{\\text{LDA}}(\\mathbf{r}) \\, F_{x}\\big(s(\\mathbf{r}), \\alpha(\\mathbf{r})\\big)$。\n    $$e_{x}^{\\text{meta}}(\\mathbf{r}) \\approx -0.086383 \\times 1.06553 \\approx -0.092036$$\n\n问题要求最终答案四舍五入到四位有效数字。\n计算值为 $-0.092036$。将其四舍五入到四位有效数字，得到 $-0.09204$。",
            "answer": "$$\\boxed{-0.09204}$$"
        },
        {
            "introduction": "在理解了单个点的构成后，下一步是观察这些量在真实的化学体系中是如何变化的。本练习要求您编写一个程序，使用模型轨道为氩原子计算电子动能密度——这是meta-GGA的关键成分之一。这个实践将揭示动能密度在紧凑的原子核区域和弥散的价层区域之间的显著差异，从而加深对动能密度物理意义的理解 。",
            "id": "2457651",
            "problem": "要求您从第一性原理出发，实现一个程序，用于计算一个模型原子的密度泛函理论（DFT）中meta-广义梯度近似（meta-GGA）泛函所使用的约化动能密度。考虑一个用带有Slater有效核电荷的类氢轨道建模的氩原子。约化动能密度定义为 $p(\\mathbf{r}) = \\tau(\\mathbf{r}) / \\tau_{\\mathrm{unif}}(n(\\mathbf{r}))$，其中 $\\tau(\\mathbf{r})$ 是Kohn–Sham轨道动能密度，$\\tau_{\\mathrm{unif}}(n)$ 是密度为 $n$ 的均匀电子气的动能密度。整个计算过程使用原子单位。\n\nKohn–Sham动能密度定义为\n$$\\tau(\\mathbf{r}) = \\frac{1}{2} \\sum_{i,\\sigma} \\left\\lVert \\nabla \\psi_{i\\sigma}(\\mathbf{r}) \\right\\rVert^2,$$\n其中求和遍及所有占据的自旋轨道 $\\psi_{i\\sigma}(\\mathbf{r})$。对于一个球对称的闭壳层原子，其每个 $(n,\\ell)$ 亚层中的所有磁量子数 $m$ 都被填满，对自旋和 $m$ 的求和会得到一个球对称的 $\\tau(r)$，它可以表示为类氢径向函数 $R_{n\\ell}(r)$ 的形式\n$$\\tau(r) = \\sum_{n,\\ell} \\frac{2\\ell+1}{4\\pi} \\left( \\left|\\frac{dR_{n\\ell}(r)}{dr}\\right|^2 + \\frac{\\ell(\\ell+1)}{r^2} \\left|R_{n\\ell}(r)\\right|^2 \\right),$$\n电子密度为\n$$n(r) = \\sum_{n,\\ell} \\frac{2(2\\ell+1)}{4\\pi} \\left| R_{n\\ell}(r) \\right|^2.$$\n\n对每个亚层使用带有有效核电荷 $Z_{\\mathrm{eff}}$ 的类氢径向函数。在原子单位中，对于主量子数 $n$、角动量 $\\ell$、有效电荷 $Z$ 以及 $r \\ge 0$，径向函数可写为\n$$R_{n\\ell}(r; Z) = \\mathcal{N}_{n\\ell}(Z) \\, e^{-\\rho/2} \\, \\rho^{\\ell} \\, L_{n-\\ell-1}^{(2\\ell+1)}(\\rho), \\quad \\rho = \\frac{2 Z r}{n},$$\n其归一化常数为\n$$\\mathcal{N}_{n\\ell}(Z) = \\left( \\frac{2 Z}{n} \\right)^{3/2} \\sqrt{ \\frac{(n-\\ell-1)!}{2 n \\, (n+\\ell)!} },$$\n其中 $L_{k}^{(\\alpha)}$ 是 $k$ 阶、$\\alpha$ 次的广义Laguerre多项式。导数 $dR_{n\\ell}/dr$ 通过对此表达式关于 $r$ 求导得到。\n\n对于密度为 $n$ 的自旋非极化均匀电子气，定义\n$$\\tau_{\\mathrm{unif}}(n) = \\frac{3}{10} \\left( 3 \\pi^2 \\right)^{2/3} n^{5/3}.$$\n\n通过如下分配Slater有效核电荷来模拟电子构型为 $1s^2\\,2s^2\\,2p^6\\,3s^2\\,3p^6$ 的氩原子。对 $n s$ 和 $n p$ 电子使用Slater规则：\n- 对于一个 $1s$ 电子：另一个 $1s$ 电子对屏蔽常数 $S$ 的贡献为 $0.30$。\n- 对于一个 $n=2$ 的 $n s$ 或 $n p$ 电子：其他每个 $n=2$ 的电子贡献 $0.35$，每个 $1s$ 电子贡献 $0.85$。\n- 对于一个 $n \\ge 3$ 的 $n s$ 或 $n p$ 电子：主量子数同为 $n$ 的其他每个电子贡献 $0.35$，主量子数为 $n-1$ 的每个电子贡献 $0.85$，主量子数为 $n-2$ 或更低的每个电子贡献 $1.00$。\n\n设核电荷为 $Z=18$。对每个亚层，使用这些规则为该亚层中的一个代表性电子计算 $S$，然后设 $Z_{\\mathrm{eff}} = Z - S$。在以下每个亚层组内应用一个共同的 $Z_{\\mathrm{eff}}$：$1s$，$2s$ 和 $2p$（相同的 $Z_{\\mathrm{eff}}$），以及 $3s$ 和 $3p$（相同的 $Z_{\\mathrm{eff}}$）。将得到的 $Z_{\\mathrm{eff}}$ 值用于相应亚层的类氢径向函数。\n\n将约化动能密度定义为\n$$p(r) = \\frac{\\tau(r)}{\\tau_{\\mathrm{unif}}(n(r))}.$$\n\n测试套件规范：\n- 使用有序集合 $\\{0.05,\\;0.30,\\;1.00,\\;1.50,\\;2.50\\}$ 给出的半径 $r$（单位为玻尔）。\n- 对于此集合中的每个 $r$，计算如上定义的 $p(r)$。\n- 要求的最终输出是一行，包含这五个 $p(r)$ 的值，四舍五入到六位小数，以逗号分隔并用方括号括起来，顺序与输入半径相同。例如，格式必须与 $[x_1,x_2,x_3,x_4,x_5]$ 完全一样，其中每个 $x_i$ 是一个四舍五入到六位小数的十进制字符串。\n\n角度单位不适用。约化动能密度 $p(r)$ 是无量纲的。请确保半径被解释为玻尔，并且所有公式都使用原子单位。您的程序应生成单行输出，其中包含用方括号括起来的逗号分隔列表形式的结果（例如，$[result_1,result_2,result_3,result_4,result_5]$）。",
            "solution": "该问题已经过严格验证，被确定为是适定的、科学上合理的和计算上可行的。它代表了将密度泛函理论原理应用于模型原子系统的标准练习。我们将采用系统的、基于第一性原理的解决方案。整个分析在原子单位下进行，其中 $\\hbar=m_e=e=4\\pi\\epsilon_0=1$。\n\n目标是计算模型氩原子在指定径向距离 $r$ 处的约化动能密度 $p(r)$。量 $p(r)$ 定义为Kohn-Sham动能密度 $\\tau(r)$ 与在相同局域电子密度 $n(r)$ 下的均匀电子气动能密度 $\\tau_{\\mathrm{unif}}(n(r))$ 的比值：\n$$p(r) = \\frac{\\tau(r)}{\\tau_{\\mathrm{unif}}(n(r))}$$\n\n计算分四个阶段进行：\n1.  使用Slater规则确定每个相关原子轨道组的有效核电荷 $Z_{\\mathrm{eff}}$。\n2.  对所有已占据亚层，评估类氢径向波函数 $R_{n\\ell}(r)$ 及其导数 $dR_{n\\ell}/dr$。\n3.  通过对所有已占据亚层的贡献求和，计算总电子密度 $n(r)$ 和总Kohn-Sham动能密度 $\\tau(r)$。\n4.  计算 $\\tau_{\\mathrm{unif}}(n(r))$ 和最终的约化动能密度 $p(r)$。\n\n**1. 有效核电荷 ($Z_{\\mathrm{eff}}$)**\n\n核电荷为 $Z=18$ 的氩原子，其电子构型为 $1s^2 2s^2 2p^6 3s^2 3p^6$。我们应用Slater规则为每个指定的亚层组中的一个代表性电子计算屏蔽常数 $S$。然后有效核电荷为 $Z_{\\mathrm{eff}} = Z - S$。\n\n- **第1组（$1s$ 亚层）：** 对于一个 $1s$ 电子，屏蔽来自另一个 $1s$ 电子。\n$$S_{1s} = 1 \\times 0.30 = 0.30$$\n$$Z_{\\mathrm{eff}, 1s} = 18 - 0.30 = 17.70$$\n\n- **第2组（$2s, 2p$ 亚层）：** 对于 $n=2$ 壳层中的一个代表性电子，同一壳层（$n=2$）中有7个其他电子，内层（$n=1$）中有2个电子。\n$$S_{2sp} = (7 \\times 0.35) + (2 \\times 0.85) = 2.45 + 1.70 = 4.15$$\n$$Z_{\\mathrm{eff}, 2sp} = 18 - 4.15 = 13.85$$\n\n- **第3组（$3s, 3p$ 亚层）：** 对于 $n=3$ 壳层中的一个代表性电子，同一壳层（$n=3$）中有7个其他电子，$n-1$ 壳层（$n=2$）中有8个电子，以及 $n-2$ 壳层（$n=1$）中有2个电子。\n$$S_{3sp} = (7 \\times 0.35) + (8 \\times 0.85) + (2 \\times 1.00) = 2.45 + 6.80 + 2.00 = 11.25$$\n$$Z_{\\mathrm{eff}, 3sp} = 18 - 11.25 = 6.75$$\n\n这些 $Z_{\\mathrm{eff}}$ 值将用于相应亚层 $(1,0)$、$(2,0)$、$(2,1)$、$(3,0)$ 和 $(3,1)$ 的类氢径向函数。\n\n**2. 径向波函数及其导数**\n\n对于主量子数 $n$、角动量量子数 $\\ell$ 和有效核电荷 $Z$ 的类氢轨道的径向部分由下式给出：\n$$R_{n\\ell}(r; Z) = \\mathcal{N}_{n\\ell}(Z) \\, e^{-\\rho/2} \\, \\rho^{\\ell} \\, L_{n-\\ell-1}^{(2\\ell+1)}(\\rho)$$\n其中 $\\rho = \\frac{2 Z r}{n}$，$L_{k}^{(\\alpha)}$ 是广义Laguerre多项式，$\\mathcal{N}_{n\\ell}(Z)$ 是归一化常数：\n$$\\mathcal{N}_{n\\ell}(Z) = \\left( \\frac{2 Z}{n} \\right)^{3/2} \\sqrt{ \\frac{(n-\\ell-1)!}{2 n \\, (n+\\ell)!} }$$\n导数 $dR_{n\\ell}/dr$ 使用链式法则计算，$\\frac{dR}{dr} = \\frac{dR}{d\\rho} \\frac{d\\rho}{dr}$，其中 $\\frac{d\\rho}{dr} = \\frac{2Z}{n}$。\n关于 $\\rho$ 的导数是基于乘法法则计算的，区分 $\\ell=0$ 和 $\\ell > 0$ 的情况。\n对于 $\\ell=0$：\n$$\\frac{d R_{n0}}{d\\rho} = \\mathcal{N}_{n0} e^{-\\rho/2} \\left[ -\\frac{1}{2} L_{n-1}^{(1)}(\\rho) + \\frac{d}{d\\rho}L_{n-1}^{(1)}(\\rho) \\right]$$\n对于 $\\ell > 0$：\n$$\\frac{d R_{n\\ell}}{d\\rho} = \\mathcal{N}_{n\\ell} e^{-\\rho/2} \\rho^{\\ell-1} \\left[ \\left(-\\frac{\\rho}{2}+\\ell\\right) L_{n-\\ell-1}^{(2\\ell+1)}(\\rho) + \\rho \\frac{d}{d\\rho}L_{n-\\ell-1}^{(2\\ell+1)}(\\rho) \\right]$$\nLaguerre多项式的导数通过算法计算。\n\n**3. 电子密度和动能密度**\n\n对于闭壳层、球对称原子，总电子密度 $n(r)$ 和Kohn-Sham动能密度 $\\tau(r)$ 通过对所有占据亚层 $(n,\\ell)$ 的贡献求和得到。\n\n电子密度为：\n$$n(r) = \\sum_{n,\\ell}^{\\text{occ}} \\frac{2(2\\ell+1)}{4\\pi} \\left| R_{n\\ell}(r) \\right|^2$$\n因子 $2$ 考虑了两种自旋态（上和下），而 $(2\\ell+1)$ 考虑了磁量子数 $m$ 的简并度。\n\n动能密度为：\n$$\\tau(r) = \\sum_{n,\\ell}^{\\text{occ}} \\frac{2\\ell+1}{4\\pi} \\left( \\left|\\frac{dR_{n\\ell}(r)}{dr}\\right|^2 + \\frac{\\ell(\\ell+1)}{r^2} \\left|R_{n\\ell}(r)\\right|^2 \\right)$$\n对于每个指定的 $r$ 值，这些和都进行数值计算。\n\n**4. 约化动能密度**\n\n自旋非极化均匀电子气（在Thomas-Fermi近似中）的动能密度由下式给出：\n$$\\tau_{\\mathrm{unif}}(n) = C_K n^{5/3}, \\quad \\text{其中} \\quad C_K = \\frac{3}{10} \\left( 3 \\pi^2 \\right)^{2/3}$$\n使用计算出的局域值 $n(r)$ 和 $\\tau(r)$，约化动能密度 $p(r)$ 计算为它们的比值：\n$$p(r) = \\frac{\\tau(r)}{\\tau_{\\mathrm{unif}}(n(r))} = \\frac{\\tau(r)}{C_K \\, n(r)^{5/3}}$$\n对测试集 $\\{0.05, 0.30, 1.00, 1.50, 2.50\\}$ 中的每个半径重复此过程，以得出最终结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.special import genlaguerre\nimport math\n\ndef solve():\n    \"\"\"\n    Computes the reduced kinetic energy density p(r) for a model Argon atom\n    at specified radii.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    radii = [0.05, 0.30, 1.00, 1.50, 2.50]\n    \n    # 1. Calculate effective nuclear charges (Z_eff) using Slater's rules\n    Z_atom = 18.0\n\n    # For 1s subshell\n    S_1s = 0.30\n    Z_eff_1s = Z_atom - S_1s\n\n    # For 2s, 2p subshells\n    S_2sp = 7 * 0.35 + 2 * 0.85\n    Z_eff_2sp = Z_atom - S_2sp\n\n    # For 3s, 3p subshells\n    S_3sp = 7 * 0.35 + 8 * 0.85 + 2 * 1.00\n    Z_eff_3sp = Z_atom - S_3sp\n\n    # Define occupied subshells for Argon with their respective Z_eff\n    occupied_subshells = [\n        # (n, l, Z_eff)\n        (1, 0, Z_eff_1s),\n        (2, 0, Z_eff_2sp),\n        (2, 1, Z_eff_2sp),\n        (3, 0, Z_eff_3sp),\n        (3, 1, Z_eff_3sp),\n    ]\n\n    results = []\n    \n    # Constant for the uniform electron gas kinetic energy density\n    C_K = (3.0 / 10.0) * (3.0 * np.pi**2)**(2.0/3.0)\n\n    for r in radii:\n        total_n_r = 0.0\n        total_tau_r = 0.0\n\n        # Sum contributions from all occupied subshells\n        for n, l, Z_eff in occupied_subshells:\n            \n            # 2. Evaluate radial wavefunctions and their derivatives\n            \n            # Calculate rho and its derivative w.r.t r\n            rho = (2.0 * Z_eff * r) / n\n            d_rho_dr = (2.0 * Z_eff) / n\n\n            # Normalization constant N_nl\n            # Use math.factorial for integer arguments\n            fact_num = math.factorial(n - l - 1)\n            fact_den = math.factorial(n + l)\n            norm_const = ((2.0 * Z_eff / n)**1.5) * np.sqrt(fact_num / (2.0 * n * fact_den))\n\n            # Generalized Laguerre polynomial L_{n-l-1}^{2l+1} and its derivative\n            k, alpha = n - l - 1, 2 * l + 1\n            L_poly = genlaguerre(k, alpha)\n            L_poly_deriv = L_poly.deriv(1)\n            \n            L_val = L_poly(rho)\n            L_deriv_val = L_poly_deriv(rho)\n\n            # Radial function R_nl(r) and its derivative dR_nl/dr\n            if l == 0:\n                # Case l=0: R_n0 = N * exp(-rho/2) * L\n                R_nl = norm_const * np.exp(-rho / 2.0) * L_val\n                # dR/d(rho) = N * exp(-rho/2) * [-0.5*L + L']\n                dR_drho = norm_const * np.exp(-rho/2.0) * (-0.5 * L_val + L_deriv_val)\n            else: # l > 0\n                # Case l>0: R_nl = N * exp(-rho/2) * rho^l * L\n                R_nl = norm_const * np.exp(-rho / 2.0) * (rho**l) * L_val\n                # dR/d(rho) = N * exp(-rho/2) * rho^(l-1) * [(-0.5*rho+l)*L + rho*L']\n                # This form is numerically stable for r > 0.\n                term_in_brackets = (-0.5 * rho + l) * L_val + rho * L_deriv_val\n                dR_drho = norm_const * np.exp(-rho/2.0) * (rho**(l-1)) * term_in_brackets\n            \n            dR_dr = dR_drho * d_rho_dr\n\n            # 3. Compute electron density n(r) and kinetic energy density tau(r)\n            \n            # Contribution to electron density n(r)\n            n_contrib = (2.0 * (2.0 * l + 1.0) / (4.0 * np.pi)) * R_nl**2\n            total_n_r += n_contrib\n            \n            # Contribution to kinetic energy density tau(r)\n            radial_ke_term = dR_dr**2\n            # The angular KE term incorporates the 1/r^2 factor. It is safe for r > 0.\n            angular_ke_term = (l * (l + 1.0) / r**2) * R_nl**2\n            tau_contrib = ((2.0 * l + 1.0) / (4.0 * np.pi)) * (radial_ke_term + angular_ke_term)\n            total_tau_r += tau_contrib\n            \n        # 4. Calculate p(r)\n        \n        # tau_unif for the total local density n(r)\n        # Add a small epsilon to total_n_r to prevent division by zero, though unlikely for these radii.\n        tau_unif_r = C_K * (total_n_r + 1e-15)**(5.0/3.0)\n        \n        # Reduced kinetic energy density p(r)\n        p_r = total_tau_r / tau_unif_r\n        results.append(p_r)\n\n    # Final print statement in the exact required format.\n    print(f\"[{','.join(f'{x:.6f}' for x in results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "meta-GGA泛函的强大之处在于其能够利用动能密度来识别不同的化学环境。本练习将探讨其核心机制——“切换函数”，它允许泛函在不同的物理极限（如单轨道区域和缓变电子气）之间进行插值。通过研究这个函数在不同模型体系中的行为，您将深入了解像TPSS这样精密泛函背后的设计哲学 。",
            "id": "2457711",
            "problem": "要求您在一个受控且完全指定的设定中，研究 Tao–Perdew–Staroverov–Scuseria (TPSS) meta-广义梯度近似中切换函数的作用，方法是对于由归一化高斯轨道构建的模型系统，量化该函数在何处最为活跃。所有计算均需使用哈特里原子单位制。\n\n一个自旋非极化、闭壳层的 Kohn–Sham 系统，其空间轨道为 $\\{\\phi_n(\\mathbf{r})\\}$，电子密度为 $\\rho(\\mathbf{r}) = 2 \\sum_n |\\phi_n(\\mathbf{r})|^2$，正动能密度为 $\\tau(\\mathbf{r}) = \\sum_n |\\nabla \\phi_n(\\mathbf{r})|^2$。对于 $\\rho(\\mathbf{r})>0$，von Weizsäcker 动能密度为 $\\tau_{\\mathrm{W}}(\\mathbf{r}) = \\dfrac{|\\nabla \\rho(\\mathbf{r})|^2}{8\\,\\rho(\\mathbf{r})}$，均匀电子气动能密度为 $\\tau_{\\mathrm{unif}}(\\mathbf{r}) = \\dfrac{3}{10}\\left(3\\pi^2\\right)^{2/3}\\rho(\\mathbf{r})^{5/3}$。等轨道指示因子为\n$$\n\\alpha(\\mathbf{r}) = \\frac{\\tau(\\mathbf{r}) - \\tau_{\\mathrm{W}}(\\mathbf{r})}{\\tau_{\\mathrm{unif}}(\\mathbf{r})},\n$$\n约定当 $\\rho(\\mathbf{r})=0$ 时，$\\alpha(\\mathbf{r})=0$。\n\n考虑理想化的类 TPSS 切换函数（一个在单轨道和缓变极限之间平滑插值的函数）\n$$\nw(\\alpha) = \\frac{\\alpha^2}{1+\\alpha^2},\n$$\n其导数为\n$$\nw'(\\alpha) = \\frac{2\\alpha}{\\left(1+\\alpha^2\\right)^2}。\n$$\n令 $w'_{\\max}$ 表示当 $\\alpha\\ge 0$ 时 $w'(\\alpha)$ 的全局最大值。定义局域活性指示因子\n$$\nA(\\mathbf{r}) =\n\\begin{cases}\n1,  \\text{若 } \\rho(\\mathbf{r}) \\ge \\rho_{\\mathrm{cut}} \\text{ 且 } w'(\\alpha(\\mathbf{r})) \\ge \\frac{1}{2}w'_{\\max},\\\\\n0,  \\text{否则,}\n\\end{cases}\n$$\n其中 $\\rho_{\\mathrm{cut}} = 10^{-8}$，单位为 bohr$^{-3}$。一个系统的活性分数 $F$ 是 $A(\\mathbf{r})=1$ 的网格点数与 $\\rho(\\mathbf{r}) \\ge \\rho_{\\mathrm{cut}}$ 的网格点数的比值。\n\n所有空间场必须在一个覆盖立方体 $[-L,L]^3$ 的均匀笛卡尔网格上求值，其中 $L=6$ bohr，每个轴使用 $N=33$ 个等间距点。\n\n您将为以下三个测试案例（测试套件）计算 $F$ 值，每个案例都完全由第一性原理构建指定：\n\n1. 盒子中的均匀电子气。密度是恒定的，$\\rho(\\mathbf{r})=\\rho_0$，其中 $\\rho_0=0.05$，单位为 bohr$^{-3}$，因此在所有点上 $\\nabla \\rho(\\mathbf{r})=\\mathbf{0}$，$\\tau(\\mathbf{r})=\\tau_{\\mathrm{unif}}(\\mathbf{r})$，且 $\\tau_{\\mathrm{W}}(\\mathbf{r})=0$。\n\n2. 单轨道类原子系统。一个位于原点、归一化的 s 型高斯空间轨道，被双占据，\n$$\n\\phi(\\mathbf{r}) = \\mathcal{N}\\, e^{-a|\\mathbf{r}|^2}, \\quad \\mathcal{N} = \\left(\\frac{2a}{\\pi}\\right)^{3/4}, \\quad a=0.5 \\text{ in bohr}^{-2}.\n$$\n\n3. 双中心类双原子系统。两个归一化的 s 型高斯函数，具有相同的指数 $a=0.5$（单位为 bohr$^{-2}$），中心分别位于 $\\mathbf{R}_A=(0,0,-R/2)$ 和 $\\mathbf{R}_B=(0,0,R/2)$，\n$$\ng_A(\\mathbf{r})=\\mathcal{N}\\,e^{-a|\\mathbf{r}-\\mathbf{R}_A|^2}, \\quad g_B(\\mathbf{r})=\\mathcal{N}\\,e^{-a|\\mathbf{r}-\\mathbf{R}_B|^2},\n$$\n重叠积分为 $S=\\exp\\!\\left(-\\frac{aR^2}{2}\\right)$。构建正交归一的成键轨道和反键轨道\n$$\n\\phi_b(\\mathbf{r}) = \\frac{g_A(\\mathbf{r})+g_B(\\mathbf{r})}{\\sqrt{2(1+S)}}, \\quad\n\\phi_a(\\mathbf{r}) = \\frac{g_A(\\mathbf{r})-g_B(\\mathbf{r})}{\\sqrt{2(1-S)}},\n$$\n每个轨道都被双占据。对于候选的间距 $R \\in \\{0.5,\\,1.5,\\,3.0,\\,5.0\\}$（单位为 bohr），计算每个间距的活性分数 $F(R)$，并报告使 $F(R)$ 最大化的 $R^\\star$ 值；如果多个 $R$ 达到相同的最大 $F$ 值，则报告其中最小的 $R$。\n\n角度单位不适用。所有长度必须以 bohr 为单位，所有密度以 bohr$^{-3}$ 为单位。\n\n您的程序必须产生单行输出，包含用方括号括起来的、以逗号分隔的结果列表，顺序为 $[F_{\\mathrm{UEG}}, F_{\\mathrm{1G}}, R^\\star]$，其中 $F_{\\mathrm{UEG}}$ 是案例 1 的活性分数，$F_{\\mathrm{1G}}$ 是案例 2 的活性分数，$R^\\star$ 是案例 3 的值（单位为 bohr）。将所有三个输出表示为四舍五入到三位小数的浮点数，不打印单位。例如，一个有效的输出格式如 $[0.123,0.000,1.500]$。",
            "solution": "所呈现的问题是计算量子化学中一个提法恰当且有科学依据的练习，具体涉及 meta-广义梯度近似 (meta-GGA) 密度泛函的行为。任务是为几个模型电子系统分析一个理想化的切换函数，该函数是 Tao-Perdew-Staroverov-Scuseria (TPSS) 泛函的特征。所有指定的量在密度泛函理论 (DFT) 中都是标准的，而模型——均匀电子气、单个高斯轨道和由高斯轨道构建的双原子系统——是用于理解此类泛函行为的经典例子。问题陈述是完整、一致的，并且需要对已建立的物理和数学公式进行直接的数值实现。因此，该问题是有效的，并将提供解答。\n\n问题的核心在于等轨道指示因子 $\\alpha(\\mathbf{r})$，它用于区分不同的成键环境。其定义为：\n$$\n\\alpha(\\mathbf{r}) = \\frac{\\tau(\\mathbf{r}) - \\tau_{\\mathrm{W}}(\\mathbf{r})}{\\tau_{\\mathrm{unif}}(\\mathbf{r})}\n$$\n其中 $\\tau$ 是正动能密度，$\\tau_{\\mathrm{W}} = \\frac{|\\nabla \\rho|^2}{8\\rho}$ 是 von Weizsäcker 动能密度，而 $\\tau_{\\mathrm{unif}} = \\frac{3}{10}(3\\pi^2)^{2/3}\\rho^{5/3}$ 是密度为 $\\rho$ 的均匀电子气 (UEG) 的动能密度。根据设计，对于任何单轨道区域，$\\alpha=0$，对于 UEG，$\\alpha=1$。\n\n该问题研究了类 TPSS 切换函数 $w(\\alpha) = \\frac{\\alpha^2}{1+\\alpha^2}$ 的局域活性。其活性与其导数 $w'(\\alpha) = \\frac{2\\alpha}{(1+\\alpha^2)^2}$ 的大小有关。我们必须首先找到当 $\\alpha \\ge 0$ 时 $w'(\\alpha)$ 的最大值。我们将 $w'(\\alpha)$ 对 $\\alpha$ 的导数设为零：\n$$\n\\frac{d w'(\\alpha)}{d\\alpha} = \\frac{d}{d\\alpha} \\left( \\frac{2\\alpha}{(1+\\alpha^2)^2} \\right) = \\frac{2(1+\\alpha^2)^2 - 2\\alpha \\cdot 2(1+\\alpha^2)(2\\alpha)}{(1+\\alpha^2)^4} = 0\n$$\n$$\n2(1+\\alpha^2) - 8\\alpha^2 = 0 \\implies 2 - 6\\alpha^2 = 0 \\implies \\alpha^2 = \\frac{1}{3}\n$$\n由于 $\\alpha \\ge 0$，最大值出现在 $\\alpha = 1/\\sqrt{3}$ 处。最大值为：\n$$\nw'_{\\max} = w'(1/\\sqrt{3}) = \\frac{2(1/\\sqrt{3})}{(1 + 1/3)^2} = \\frac{2/\\sqrt{3}}{(16/9)} = \\frac{2}{\\sqrt{3}}\\frac{9}{16} = \\frac{9}{8\\sqrt{3}} = \\frac{3\\sqrt{3}}{8}\n$$\n局域活性指示因子 $A(\\mathbf{r})$ 在 $\\rho(\\mathbf{r}) \\ge \\rho_{\\mathrm{cut}} = 10^{-8}$ 且 $w'(\\alpha(\\mathbf{r})) \\ge \\frac{1}{2}w'_{\\max}$ 时为 $1$。活性分数 $F$ 是 $A(\\mathbf{r})=1$ 的网格点数与总的 $\\rho(\\mathbf{r}) \\ge \\rho_{\\mathrm{cut}}$ 的点数之比。\n\n我们现在分析三个指定的案例。\n\n**案例 1：均匀电子气 (UEG)**\n对于 UEG，密度是恒定的，$\\rho(\\mathbf{r}) = \\rho_0 = 0.05$。因此，其梯度为零，$\\nabla \\rho(\\mathbf{r}) = \\mathbf{0}$。这直接意味着 $\\tau_{\\mathrm{W}}(\\mathbf{r})=0$。问题陈述中指出，对于此系统，$\\tau(\\mathbf{r}) = \\tau_{\\mathrm{unif}}(\\mathbf{r})$。将这些代入 $\\alpha$ 的定义中：\n$$\n\\alpha(\\mathbf{r}) = \\frac{\\tau_{\\mathrm{unif}}(\\mathbf{r}) - 0}{\\tau_{\\mathrm{unif}}(\\mathbf{r})} = 1\n$$\n在 $\\alpha=1$ 处导数的值是 $w'(1) = \\frac{2(1)}{(1+1^2)^2} = \\frac{2}{4} = \\frac{1}{2}$。活性条件为 $w'(1) \\ge \\frac{1}{2}w'_{\\max}$，即 $\\frac{1}{2} \\ge \\frac{1}{2}\\frac{3\\sqrt{3}}{8}$，或 $1 \\ge \\frac{3\\sqrt{3}}{8}$。由于 $8^2 = 64$ 且 $(3\\sqrt{3})^2 = 27$，这个不等式成立。密度恒为 $0.05$，远大于 $\\rho_{\\mathrm{cut}}$。因此，在每个网格点上 $A(\\mathbf{r})=1$。活性点的数量等于满足密度截断条件的点的总数，得出活性分数为 $F_{\\mathrm{UEG}}=1$。\n\n**案例 2：单轨道类原子系统**\n该系统由单个、双占据的实空间轨道 $\\phi(\\mathbf{r})$ 组成。密度为 $\\rho(\\mathbf{r}) = 2\\phi(\\mathbf{r})^2$。密度梯度为 $\\nabla\\rho = 4\\phi(\\nabla\\phi)$。动能密度为 $\\tau(\\mathbf{r}) = (\\nabla\\phi)^2$（对一个轨道求和，该轨道是双占据的，但 $\\tau$ 是对自旋轨道求和，这导致了这种没有因子 2 的形式）。此处因子 2 的不匹配根据约定是很常见的，但问题陈述 $\\tau=\\sum_n|\\nabla\\phi_n|^2$ 其中 $\\{\\phi_n\\}$ 是空间轨道。对于一个轨道，$\\tau=|\\nabla\\phi|^2$。von Weizsäcker 动能密度为：\n$$\n\\tau_{\\mathrm{W}}(\\mathbf{r}) = \\frac{|\\nabla\\rho|^2}{8\\rho} = \\frac{|4\\phi(\\nabla\\phi)|^2}{8(2\\phi^2)} = \\frac{16\\phi^2(\\nabla\\phi)^2}{16\\phi^2} = (\\nabla\\phi)^2 = \\tau(\\mathbf{r})\n$$\n由于在所有 $\\rho(\\mathbf{r})>0$ 的地方 $\\tau(\\mathbf{r}) = \\tau_{\\mathrm{W}}(\\mathbf{r})$，$\\alpha$ 的分子恒等于零。因此，对所有 $\\mathbf{r}$，$\\alpha(\\mathbf{r}) = 0$。\n在 $\\alpha=0$ 处，切换函数的导数为 $w'(0)=0$。活性条件是 $0 \\ge \\frac{1}{2}w'_{\\max}$，因为 $w'_{\\max}>0$，所以该条件不成立。因此，处处 $A(\\mathbf{r})=0$。活性点数为零，活性分数为 $F_{\\mathrm{1G}}=0$。\n\n**案例 3：双中心类双原子系统**\n该系统由两个双占据的正交归一轨道组成，一个成键轨道 $\\phi_b$ 和一个反键轨道 $\\phi_a$，由高斯基函数 $g_A$ 和 $g_B$ 构建。\n$$\n\\phi_b(\\mathbf{r}) = \\frac{g_A(\\mathbf{r})+g_B(\\mathbf{r})}{\\sqrt{2(1+S)}}, \\quad \\phi_a(\\mathbf{r}) = \\frac{g_A(\\mathbf{r})-g_B(\\mathbf{r})}{\\sqrt{2(1-S)}}\n$$\n这个四电子系统的总密度和动能密度为：\n$$\n\\rho(\\mathbf{r}) = 2|\\phi_b(\\mathbf{r})|^2 + 2|\\phi_a(\\mathbf{r})|^2\n$$\n$$\n\\tau(\\mathbf{r}) = |\\nabla\\phi_b(\\mathbf{r})|^2 + |\\nabla\\phi_a(\\mathbf{r})|^2\n$$\n活性分数 $F(R)$ 的计算必须对每个指定的核间距 $R$ 进行数值计算。步骤如下：\n1.  在 $[-6,6]^3$ bohr 的立方体上定义一个均匀笛卡尔网格，每个轴有 33 个点。\n2.  对每个 $R \\in \\{0.5, 1.5, 3.0, 5.0\\}$ 值，执行以下步骤。\n3.  对网格上的每个点 $\\mathbf{r}$，计算基函数 $g_{A,B}(\\mathbf{r})$ 及其梯度 $\\nabla g_{A,B}(\\mathbf{r})$ 的值。\n4.  由此构建轨道 $\\phi_{b,a}(\\mathbf{r})$ 及其梯度 $\\nabla \\phi_{b,a}(\\mathbf{r})$。\n5.  计算总密度 $\\rho(\\mathbf{r})$、其梯度 $\\nabla\\rho(\\mathbf{r})$ 和动能密度 $\\tau(\\mathbf{r})$。\n6.  计算 $\\tau_{\\mathrm{W}}(\\mathbf{r})$、$\\tau_{\\mathrm{unif}}(\\mathbf{r})$，并最终计算等轨道指示因子 $\\alpha(\\mathbf{r})$。对于 $\\rho(\\mathbf{r}) \\to 0$ 的区域需要特别小心处理，将诸如 $0/0$ 的不定式结果设为 $0$。\n7.  对所有满足 $\\rho(\\mathbf{r}) \\ge \\rho_{\\mathrm{cut}}$ 的点，评估活性条件 $w'(\\alpha(\\mathbf{r})) \\ge \\frac{1}{2}w'_{\\max}$。\n8.  将满足条件的点的数量与密度高于截断值的点的总数之比，计算为活性分数 $F(R)$。\n9.  在计算完所有候选 $R$ 的 $F(R)$ 后，确定 $R^\\star$ 为使 $F(R)$ 最大化的 $R$ 值。如果出现平局，则选择最小的 $R$。\n\n这个数值计算将得出最终所需的值 $R^\\star$。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the computational chemistry problem as specified.\n    1. Calculates F_UEG analytically.\n    2. Calculates F_1G analytically.\n    3. Numerically calculates F(R) for the diatomic system for several R\n       and finds R* that maximizes F(R).\n    \"\"\"\n\n    # --- Case 1: Uniform Electron Gas ---\n    # As derived in the solution, alpha = 1 for the UEG.\n    # w'(1) = 2/(1+1)^2 = 0.5.\n    # w'_max = 3*sqrt(3)/8.\n    # The condition is 0.5 >= 0.5 * (3*sqrt(3)/8), which is true.\n    # Since rho > rho_cut everywhere, all points are active.\n    f_ueg = 1.0\n\n    # --- Case 2: One-Orbital Atom-like System ---\n    # As derived in the solution, alpha = 0 for any one-orbital system.\n    # w'(0) = 0. The activity condition is 0 >= 0.5 * w'_max, which is false.\n    # No points are active.\n    f_1g = 0.0\n\n    # --- Case 3: Two-center Diatomic-like System ---\n    # Numerical calculation is required.\n\n    # Grid and constant setup\n    L = 6.0\n    N = 33\n    a = 0.5\n    rho_cut = 1.0e-8\n    candidate_R = [0.5, 1.5, 3.0, 5.0]\n\n    # Pre-calculate grid coordinates\n    points = np.linspace(-L, L, N, dtype=np.float64)\n    xx, yy, zz = np.meshgrid(points, points, points, indexing='ij')\n    grid = np.stack((xx, yy, zz), axis=-1)\n\n    # Pre-calculate constants for w'\n    w_prime_max = 3 * np.sqrt(3) / 8\n    activity_threshold = 0.5 * w_prime_max\n    \n    # Constant for tau_unif\n    tau_unif_const = (3.0 / 10.0) * (3.0 * np.pi**2)**(2.0 / 3.0)\n\n    # Gaussian normalization constant\n    norm_gauss = (2 * a / np.pi)**(3.0 / 4.0)\n\n    f_values = []\n    \n    for R in candidate_R:\n        # Define atom centers\n        R_A = np.array([0.0, 0.0, -R / 2.0])\n        R_B = np.array([0.0, 0.0, R / 2.0])\n\n        # Overlap and normalization for orbitals\n        if R == 0.0:\n            S = 1.0\n        else:\n            S = np.exp(-a * R**2 / 2.0)\n        \n        # Avoid division by zero if R is very large and 1-S is close to 0, though not an issue for given R\n        C_b = np.sqrt(2.0 * (1.0 + S))\n        C_a = np.sqrt(2.0 * (1.0 - S)) if (1.0-S) > 1e-12 else 1e-6 # Avoid instability at small R\n\n        # Calculate Gaussian basis functions and their gradients\n        r_minus_RA = grid - R_A\n        r_minus_RB = grid - R_B\n        r_A_sq = np.sum(r_minus_RA**2, axis=-1)\n        r_B_sq = np.sum(r_minus_RB**2, axis=-1)\n\n        g_A = norm_gauss * np.exp(-a * r_A_sq)\n        g_B = norm_gauss * np.exp(-a * r_B_sq)\n        \n        # Using [..., np.newaxis] to facilitate broadcasting\n        grad_g_A = -2.0 * a * r_minus_RA * g_A[..., np.newaxis]\n        grad_g_B = -2.0 * a * r_minus_RB * g_B[..., np.newaxis]\n\n        # Construct orthonormal orbitals and their gradients\n        phi_b = (g_A + g_B) / C_b\n        phi_a = (g_A - g_B) / C_a\n        grad_phi_b = (grad_g_A + grad_g_B) / C_b\n        grad_phi_a = (grad_g_A - grad_g_B) / C_a\n\n        # Calculate total density and kinetic energy density\n        rho = 2.0 * (phi_b**2 + phi_a**2)\n        tau = np.sum(grad_phi_b**2, axis=-1) + np.sum(grad_phi_a**2, axis=-1)\n\n        # Calculate quantities for alpha\n        grad_rho = 4.0 * (phi_b[..., np.newaxis] * grad_phi_b + phi_a[..., np.newaxis] * grad_phi_a)\n        \n        # Use np.divide to handle rho=0 case safely\n        tau_W = np.divide(np.sum(grad_rho**2, axis=-1), 8.0 * rho, \n                          out=np.zeros_like(rho), where=rho > 1e-15)\n                          \n        tau_unif = tau_unif_const * rho**(5.0 / 3.0)\n\n        # Calculate alpha, handling tau_unif=0 case safely\n        numerator_alpha = tau - tau_W\n        alpha = np.divide(numerator_alpha, tau_unif, \n                          out=np.zeros_like(rho), where=tau_unif > 1e-15)\n\n        # Calculate w'(alpha)\n        w_prime_alpha = 2.0 * alpha / (1.0 + alpha**2)**2\n\n        # Determine active fraction F\n        rho_mask = rho >= rho_cut\n        num_rho_points = np.sum(rho_mask)\n\n        if num_rho_points == 0:\n            F = 0.0\n        else:\n            active_mask = (w_prime_alpha >= activity_threshold)  rho_mask\n            num_active_points = np.sum(active_mask)\n            F = num_active_points / num_rho_points\n        \n        f_values.append(F)\n\n    # Find R* that maximizes F(R)\n    max_f = -1.0\n    r_star = -1.0\n    for R, F in zip(candidate_R, f_values):\n        if F  max_f:\n            max_f = F\n            r_star = R\n\n    # Assemble final results and format output\n    results = [f_ueg, f_1g, r_star]\n    formatted_results = [f\"{val:.3f}\" for val in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}