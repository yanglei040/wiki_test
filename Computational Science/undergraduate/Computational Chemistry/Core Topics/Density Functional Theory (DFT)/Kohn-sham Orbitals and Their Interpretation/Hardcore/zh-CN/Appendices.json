{
    "hands_on_practices": [
        {
            "introduction": "本练习将演示自旋非限制性 Kohn-Sham (UKS) 密度泛函理论如何处理像三重态氧气这样的开壳层体系。通过在一个简化模型中调控轨道分裂和自旋分裂参数，我们可以直观地看到该理论如何正确地预测出两个未成对电子的存在，这是 UKS 理论的一个关键成功之处 。这个练习提供了一个具体的、可计算的模型，来理解轨道能级分裂和自旋交换相互作用之间的竞争如何导致自旋极化的基态。",
            "id": "2456922",
            "problem": "您将实现一个简化的、基于第一性原理的自旋非限制性Kohn-Sham轨道模型，以分析氧分子的基态。实验已知氧分子的基态为三重态。目标是在一个最小且数学上明确的模型中，展示自旋非限制性Kohn-Sham (UKS) 密度泛函理论 (DFT) 如何容纳两个未成对电子，以及这在Kohn-Sham (KS) 轨道中是如何体现的。\n\n定义与设置：\n- Kohn-Sham (KS) 密度泛函理论 (DFT) 将相互作用的电子问题替换为一个在有效势作用下的无相互作用体系。在自旋非限制性表述 (UKS) 中，对标记为 $\\alpha$ 和 $\\beta$ 的两个自旋通道使用不同的有效势，这可能导致两种自旋的轨道能量不同。\n- 考虑一个针对 $\\mathrm{O}_2$ 的最小唯价电子模型，该模型使用以下 $7$ 个空间轨道（按基础能量从低到高排列），在同时考虑两种自旋的情况下，每个轨道最多可容纳 $2$ 个电子：\n  1. $\\sigma_g(2s)$\n  2. $\\sigma_u^\\ast(2s)$\n  3. $\\sigma_g(2p_z)$\n  4. $\\pi_u(2p_x)$\n  5. $\\pi_u(2p_y)$\n  6. $\\pi_g^\\ast(2p_x)$\n  7. $\\pi_g^\\ast(2p_y)$\n- 设基础（无自旋）能量（单位为电子伏特）为\n  $$\\varepsilon_0=-18,\\ \\varepsilon_1=-10,\\ \\varepsilon_2=-8,\\ \\varepsilon_3=-6,\\ \\varepsilon_4=-6,\\ \\varepsilon_5=-4,\\ \\varepsilon_6=-4.$$\n- 在反键 $\\pi_g^\\ast$ 轨道对中引入一个小的类晶体场分裂 $\\delta \\ge 0$，使得\n  $$\\varepsilon_5 = -4 - \\frac{\\delta}{2},\\quad \\varepsilon_6 = -4 + \\frac{\\delta}{2}.$$\n- 引入一个仅作用于 $\\pi_g^\\ast$ 轨道的、类交换作用的自旋相关分裂 $\\Delta \\ge 0$，使得对于自旋 $\\sigma \\in \\{\\alpha,\\beta\\}$，自旋轨道能量为\n  $$\\varepsilon_i^\\alpha = \\varepsilon_i,\\ \\varepsilon_i^\\beta = \\varepsilon_i\\quad \\text{for } i \\in \\{0,1,2,3,4\\},$$\n  $$\\varepsilon_j^\\alpha = \\varepsilon_j - \\frac{\\Delta}{2},\\ \\varepsilon_j^\\beta = \\varepsilon_j + \\frac{\\Delta}{2}\\quad \\text{for } j \\in \\{5,6\\}.$$\n- 价电子总数为 $N=12$。在零温下，无相互作用KS填充的方式是，在两种自旋中占据能量最低的 $N$ 个自旋轨道，每个自旋轨道最多一个电子。\n\n处理精确简并的决胜规则（以确保确定性）：\n- 当两个自旋轨道能量完全相等时，按以下规则处理简并：优先选择 $\\alpha$ 自旋而非 $\\beta$ 自旋；对于相同自旋，优先选择空间轨道指数 $i$ 较小的轨道。\n\n任务：\n- 对于下面测试套件中的每一对参数 $(\\delta,\\Delta)$，构建自旋轨道能量 $\\varepsilon_i^\\sigma$，根据上述规则填充 $N=12$ 个电子，并计算：\n  1. 总自旋磁化强度 $m = N_\\alpha - N_\\beta$，其中 $N_\\alpha$ 和 $N_\\beta$ 分别是 $\\alpha$ 和 $\\beta$ 电子的总数。\n  2. 两个反键 $\\pi_g^\\ast$ 空间轨道上的自旋极化，定义为列表 $[s_5,s_6]$，其中 $s_i = n_i^\\alpha - n_i^\\beta$，而 $n_i^\\sigma \\in \\{0,1\\}$ 是自旋 $\\sigma$ 在空间轨道 $i$ 上的占据数。\n\n测试套件：\n- 使用以下三对参数 $(\\delta,\\Delta)$，单位为电子伏特。最终输出中的数值不需要单位。\n  - 情况A（轨道分裂有利于电子成对）：$(\\delta,\\Delta) = (0.20, 0.10)$。\n  - 情况B（自旋分裂有利于未成对的三重态）：$(\\delta,\\Delta) = (0.05, 0.30)$。\n  - 情况C（精确简并边界）：$(\\delta,\\Delta) = (0.00, 0.00)$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个以逗号分隔的列表的列表，每个子列表对应一个测试用例，顺序为 A、B、C。每个列表的形式必须为 $[m,s_5,s_6]$，其中 $m$、$s_5$ 和 $s_6$ 均为整数。例如，一个语法上有效的输出可能如下所示：\n  $$[[m_A,s_{5,A},s_{6,A}],[m_B,s_{5,B},s_{6,B}],[m_C,s_{5,C},s_{6,C}]].$$",
            "solution": "该问题是有效的，因为它提出了一个基于计算化学原理的、有科学依据、定义明确且客观的模型。它是自旋非限制性Kohn-Sham理论应用于氧分子问题的一个简化但连贯的表述，其中所有参数、规则和目标都有清晰的数学定义。\n\n任务是针对不同的参数集，确定 $\\mathrm{O}_2$ 分子简化模型的基态电子构型，并计算由此产生的自旋性质。该模型基于密度泛函理论的自旋非限制性Kohn-Sham (UKS) 框架。在此框架中，复杂的多电子问题被映射为一个更简单的问题：在有效势中运动的无相互作用准粒子（Kohn-Sham电子）。自旋非限制性表述允许对自旋-$\\alpha$ 和自旋-$\\beta$ 电子采用不同的势，这对于描述具有净磁矩的体系（例如 $\\mathrm{O}_2$ 的三重态基态）至关重要。\n\n该模型考虑了一组由 $7$ 个价空间分子轨道构成的基矢，结合两种自旋态（$\\alpha$ 和 $\\beta$），总共提供了 $14$ 个可用的自旋轨道。问题是用 $\\mathrm{O}_2$ 分子的 $N=12$ 个价电子填充这些自旋轨道。根据零温下无相互作用体系的构造原理（Aufbau principle），电子首先占据能量最低的自旋轨道。\n\n一个自旋轨道（对应于自旋 $\\sigma \\in \\{\\alpha, \\beta\\}$ 和空间轨道 $i \\in \\{0, 1, \\dots, 6\\}$）的能量 $\\varepsilon_i^\\sigma$ 由三个部分决定：\n1. 空间轨道的基础能量 $\\varepsilon_i$。初始基础能量给定为 $\\varepsilon_0=-18$, $\\varepsilon_1=-10$, $\\varepsilon_2=-8$, $\\varepsilon_3=-6$, $\\varepsilon_4=-6$, $\\varepsilon_5=-4$, 和 $\\varepsilon_6=-4$，单位为电子伏特。\n2. 一个轨道简并破缺项 $\\delta \\ge 0$，其作用类似于晶体场分裂。它仅影响原本简并的 $\\pi_g^\\ast$ 轨道（索引为 $i=5$ 和 $i=6$），将其基础能量修正为 $\\varepsilon_5 = -4 - \\frac{\\delta}{2}$ 和 $\\varepsilon_6 = -4 + \\frac{\\delta}{2}$。\n3. 一个类交换作用的自旋分裂项 $\\Delta \\ge 0$，它也仅作用于 $\\pi_g^\\ast$ 轨道。该项使轨道能量具有自旋相关性。\n\n因此，最终的自旋轨道能量定义如下：\n- 对于较低的 $5$ 个空间轨道（$i \\in \\{0, 1, 2, 3, 4\\}$）：\n$$ \\varepsilon_i^\\alpha = \\varepsilon_i, \\quad \\varepsilon_i^\\beta = \\varepsilon_i $$\n- 对于两个反键 $\\pi_g^\\ast$ 轨道（$j \\in \\{5, 6\\}$），使用它们经 $\\delta$ 修正的基础能量 $\\varepsilon_j$：\n$$ \\varepsilon_j^\\alpha = \\varepsilon_j - \\frac{\\Delta}{2} \\quad (\\text{spin-up, stabilized}) $$\n$$ \\varepsilon_j^\\beta = \\varepsilon_j + \\frac{\\Delta}{2} \\quad (\\text{spin-down, destabilized}) $$\n\n为了找到给定参数对 $(\\delta, \\Delta)$ 的基态构型，我们必须确定所有 $14$ 个自旋轨道的能量顺序。问题为任何简并情况指定了严格的决胜规则：\n1. 优先考虑较低的能量。\n2. 对于能量相等的情况，$\\alpha$ 自旋优先于 $\\beta$ 自旋。\n3. 对于能量和自旋均相同的情况（当空间轨道简并时发生），优先考虑较低的空间轨道指数 $i$。\n\n这个完整的排序定义了 $N=12$ 个电子占据自旋轨道的顺序。此序列中的前 $12$ 个自旋轨道即为被占据的轨道。\n\n一旦确定了被占据的自旋轨道，我们就可以计算所需的物理量。自旋轨道 $(\\sigma, i)$ 的占据数表示为 $n_i^\\sigma$，如果被占据则为 $1$，如果为空则为 $0$。\n- $\\alpha$ 和 $\\beta$ 电子的总数分别为 $N_\\alpha = \\sum_{i=0}^{6} n_i^\\alpha$ 和 $N_\\beta = \\sum_{i=0}^{6} n_i^\\beta$。\n- 总自旋磁化强度为 $m = N_\\alpha - N_\\beta$。$m=0$ 对应单重态，而 $m=2$ 对应三重态（因为 $S_z = m/2$）。\n- $\\pi_g^\\ast$ 空间轨道上的自旋极化由列表 $[s_5, s_6]$ 给出，其中对于 $i \\in \\{5, 6\\}$，$s_i = n_i^\\alpha - n_i^\\beta$。这衡量了这两个轨道上各自的净自旋密度。\n\n解决每个测试用例的算法步骤如下：\n1. 对于给定的 $(\\delta, \\Delta)$，构建一个包含 $14$ 个自旋轨道的列表。每个自旋轨道表示为一个元组，其中包含其计算出的能量、其自旋的数字标识符（例如，$\\alpha$ 为 $0$，$\\beta$ 为 $1$）及其空间轨道指数 $i \\in \\{0, \\dots, 6\\}$。\n2. 对这个元组列表进行排序。标准的元组字典序排序自然地实现了规定的排序规则：它将主要按第一个元素（能量）排序，其次按第二个元素（自旋标识符）排序，再次按第三个元素（空间指数）排序。\n3. 基态构型由排序后列表中的前 $N=12$ 个自旋轨道组成。\n4. 初始化大小为 $7$ 的占据数数组 $n^\\alpha$ 和 $n^\\beta$，所有元素均为零。遍历这 $12$ 个被占据的自旋轨道。对每个轨道，将其对应的占据数条目 $n_i^\\sigma$ 更新为 $1$。\n5. 根据最终的占据数数组，计算 $m = \\sum_i n_i^\\alpha - \\sum_i n_i^\\beta$，$s_5 = n_5^\\alpha - n_5^\\beta$ 和 $s_6 = n_6^\\alpha - n_6^\\beta$。\n6. 将所有测试用例的结果整理成指定的最终格式。这种对量子力学原理和确定性规则的系统应用，确保了每个参数集都有一个唯一且正确的解。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Calculates the spin-magnetization and orbital spin-polarization for a \n    simplified UKS-DFT model of O2 for three parameter sets.\n    \"\"\"\n    \n    # Test cases: (delta, Delta) in eV\n    test_cases = [\n        (0.20, 0.10),  # Case A\n        (0.05, 0.30),  # Case B\n        (0.00, 0.00)   # Case C\n    ]\n\n    # Constants\n    N_electrons = 12\n    num_spatial_orbitals = 7\n    base_energies_initial = np.array([-18.0, -10.0, -8.0, -6.0, -6.0, -4.0, -4.0])\n\n    results = []\n\n    for delta, Delta in test_cases:\n        # Step 1: Calculate spin-orbital energies for the current case\n        \n        base_energies = np.copy(base_energies_initial)\n        \n        # Apply crystal-field splitting delta to pi_g* orbitals (indices 5, 6)\n        base_energies[5] = -4.0 - delta / 2.0\n        base_energies[6] = -4.0 + delta / 2.0\n        \n        spin_orbitals = []\n        \n        # Create a list of all 14 spin-orbitals.\n        # Each is a tuple: (energy, spin_id, spatial_index)\n        # spin_id: 0 for alpha, 1 for beta (for sorting, alpha is prioritized)\n        for i in range(num_spatial_orbitals):\n            energy_i = base_energies[i]\n            \n            # alpha spin\n            energy_alpha = energy_i\n            if i >= 5:  # pi_g* orbitals\n                energy_alpha -= Delta / 2.0\n            spin_orbitals.append((energy_alpha, 0, i))\n            \n            # beta spin\n            energy_beta = energy_i\n            if i >= 5:  # pi_g* orbitals\n                energy_beta += Delta / 2.0\n            spin_orbitals.append((energy_beta, 1, i))\n            \n        # Step 2: Sort spin-orbitals to find the ground state ordering\n        # Python's tuple sorting is lexicographical and perfectly matches the\n        # tie-breaking rules: sort by energy, then spin, then index.\n        spin_orbitals.sort()\n        \n        # Step 3: Fill the lowest N_electrons orbitals\n        occupied_orbitals = spin_orbitals[:N_electrons]\n        \n        # Step 4: Calculate occupancies and derived quantities\n        n_alpha = np.zeros(num_spatial_orbitals, dtype=int)\n        n_beta = np.zeros(num_spatial_orbitals, dtype=int)\n        \n        for _, spin_id, spatial_index in occupied_orbitals:\n            if spin_id == 0:  # alpha electron\n                n_alpha[spatial_index] = 1\n            else:  # beta electron\n                n_beta[spatial_index] = 1\n        \n        # Total number of alpha and beta electrons\n        N_alpha = np.sum(n_alpha)\n        N_beta = np.sum(n_beta)\n        \n        # Total spin magnetization m\n        m = N_alpha - N_beta\n        \n        # Spin polarization on pi_g* orbitals\n        s5 = n_alpha[5] - n_beta[5]\n        s6 = n_alpha[6] - n_beta[6]\n        \n        results.append([m, s5, s6])\n\n    # Final print statement in the exact required format: [[m,s5,s6],[...],...]\n    # without any spaces.\n    formatted_results = \",\".join(f\"[{r[0]},{r[1]},{r[2]}]\" for r in results)\n    print(f\"[{formatted_results}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "沿用开壳层体系的主题，本实践将对比 Kohn-Sham 和非限制性 Hartree-Fock (UHF) 理论对一个简单自由基的描述。通过这个练习，你将揭示这两种重要的量子化学方法在处理单占据轨道和自旋密度方面的根本差异 。理解这一点对于正确解释自由基、催化剂和磁性材料的计算结果至关重要。",
            "id": "2456934",
            "problem": "考虑一个最小双轨道模型，旨在分离出类甲基自由基体系的单占据分子轨道。在由两个实基函数组成的正交归一基 $\\{\\phi_{\\mathrm{C}},\\phi_{\\mathrm{H}}\\}$ 中进行计算，其中 $\\phi_{\\mathrm{C}}$ 代表以碳为中心的价层类 $p$ 函数，$\\phi_{\\mathrm{H}}$ 代表三个氢函数的对称匹配线性组合。对于两种自旋，无相互作用的 Kohn–Sham (KS) 单电子哈密顿量是相同的 $2\\times 2$ 实对称矩阵\n$$\nH^{\\mathrm{KS}} \\;=\\;\n\\begin{pmatrix}\n\\varepsilon_{\\mathrm{C}}  t \\\\\nt  \\varepsilon_{\\mathrm{H}}\n\\end{pmatrix},\n$$\n而非限制性 Hartree–Fock (UHF) 的自旋相关 Fock 算符则由以下模型表示\n$$\nH^{\\alpha} \\;=\\;\n\\begin{pmatrix}\n\\varepsilon_{\\mathrm{C}} - \\Delta  t \\\\\nt  \\varepsilon_{\\mathrm{H}}\n\\end{pmatrix},\n\\qquad\nH^{\\beta} \\;=\\;\n\\begin{pmatrix}\n\\varepsilon_{\\mathrm{C}} + \\Delta  t \\\\\nt  \\varepsilon_{\\mathrm{H}}\n\\end{pmatrix},\n$$\n其中 $\\varepsilon_{\\mathrm{C}}$、$\\varepsilon_{\\mathrm{H}}$、$t$ 和 $\\Delta$ 为实数参数。假设此双轨道子空间中共有 3 个电子，能量较低的空间轨道被双占据（一个 $\\alpha$ 电子和一个 $\\beta$ 电子），而能量较高的空间轨道被一个 $\\alpha$ 电子单占据。\n\n令 $v^{\\mathrm{KS}}_{\\mathrm{lo}}$ 和 $v^{\\mathrm{KS}}_{\\mathrm{hi}}$ 分别为 $H^{\\mathrm{KS}}$ 对应其较低和较高本征值的归一化本征矢量。令 $v^{\\alpha}_{\\mathrm{lo}}$、$v^{\\alpha}_{\\mathrm{hi}}$ 为 $H^{\\alpha}$ 对应的归一化本征矢量，令 $v^{\\beta}_{\\mathrm{lo}}$ 为 $H^{\\beta}$ 对应的归一化较低本征矢量。所有本征矢量均取为 $\\mathbb{R}^{2}$ 中的实数且正交归一。\n\n将自旋分辨的单粒子密度矩阵定义如下。对于 KS 描述，\n$$\nP^{\\alpha}_{\\mathrm{KS}} \\;=\\; v^{\\mathrm{KS}}_{\\mathrm{lo}} \\left(v^{\\mathrm{KS}}_{\\mathrm{lo}}\\right)^{\\mathsf{T}} \\;+\\; v^{\\mathrm{KS}}_{\\mathrm{hi}} \\left(v^{\\mathrm{KS}}_{\\mathrm{hi}}\\right)^{\\mathsf{T}},\n\\qquad\nP^{\\beta}_{\\mathrm{KS}} \\;=\\; v^{\\mathrm{KS}}_{\\mathrm{lo}} \\left(v^{\\mathrm{KS}}_{\\mathrm{lo}}\\right)^{\\mathsf{T}}.\n$$\n对于 UHF 描述，\n$$\nP^{\\alpha}_{\\mathrm{UHF}} \\;=\\; v^{\\alpha}_{\\mathrm{lo}} \\left(v^{\\alpha}_{\\mathrm{lo}}\\right)^{\\mathsf{T}} \\;+\\; v^{\\alpha}_{\\mathrm{hi}} \\left(v^{\\alpha}_{\\mathrm{hi}}\\right)^{\\mathsf{T}},\n\\qquad\nP^{\\beta}_{\\mathrm{UHF}} \\;=\\; v^{\\beta}_{\\mathrm{lo}} \\left(v^{\\beta}_{\\mathrm{lo}}\\right)^{\\mathsf{T}}.\n$$\n令基函数 $\\phi_{k}$（$k\\in\\{\\mathrm{C},\\mathrm{H}\\}$）上的自旋密度由自旋密度矩阵的对角元定义，\n$$\n\\rho^{\\mathrm{KS}}_{k} \\;=\\; \\left(P^{\\alpha}_{\\mathrm{KS}} - P^{\\beta}_{\\mathrm{KS}}\\right)_{kk}, \n\\qquad\n\\rho^{\\mathrm{UHF}}_{k} \\;=\\; \\left(P^{\\alpha}_{\\mathrm{UHF}} - P^{\\beta}_{\\mathrm{UHF}}\\right)_{kk}.\n$$\n最后，通过 UHF $\\alpha$ 单占据本征矢量和 KS 单占据本征矢量之间重叠的绝对值来衡量单占据轨道的相似程度：\n$$\ns_{\\mathrm{overlap}} \\;=\\; \\left| \\left(v^{\\alpha}_{\\mathrm{hi}}\\right)^{\\mathsf{T}}\\, v^{\\mathrm{KS}}_{\\mathrm{hi}} \\right|.\n$$\n\n您的任务是编写一个完整的程序，对每个测试用例输出三元组\n$$\n\\left[s_{\\mathrm{overlap}},\\; \\rho^{\\mathrm{KS}}_{\\mathrm{C}},\\; \\rho^{\\mathrm{UHF}}_{\\mathrm{C}}\\right],\n$$\n其中所有三个量都表示为实数。\n\n使用以下参数元组 $(\\varepsilon_{\\mathrm{C}}, \\varepsilon_{\\mathrm{H}}, t, \\Delta)$ 的测试套件：\n- 测试 1：$(0.0, 0.0, 0.5, 0.0)$，\n- 测试 2：$(0.2, -0.2, 0.4, 0.1)$，\n- 测试 3：$(0.5, -0.5, 0.2, 0.4)$。\n\n您的程序应生成单行输出，其中包含一个由方括号括起来的逗号分隔列表，列表中的每个条目是针对一个测试的逗号分隔三元组，并用其自己的方括号括起来，顺序与上面列出的相同。例如，输出格式必须是\n$[ [x_{1},y_{1},z_{1}], [x_{2},y_{2},z_{2}], [x_{3},y_{3},z_{3}] ]$ 但不含任何空格。不涉及物理单位，所有角度（如有）均为无量纲。预期输出是实数列表；除了标准的浮点表示外，没有规定舍入模式。",
            "solution": "### 第 1 步：提取已知条件\n题目提供了以下已知条件：\n- 一个由两个正交归一实函数组成的基，$\\{\\phi_{\\mathrm{C}},\\phi_{\\mathrm{H}}\\}$。\n- Kohn-Sham (KS) 哈密顿量：\n$$\nH^{\\mathrm{KS}} =\n\\begin{pmatrix}\n\\varepsilon_{\\mathrm{C}}  t \\\\\nt  \\varepsilon_{\\mathrm{H}}\n\\end{pmatrix}\n$$\n- 非限制性 Hartree-Fock (UHF) 自旋相关 Fock 算符：\n$$\nH^{\\alpha} =\n\\begin{pmatrix}\n\\varepsilon_{\\mathrm{C}} - \\Delta  t \\\\\nt  \\varepsilon_{\\mathrm{H}}\n\\end{pmatrix},\n\\qquad\nH^{\\beta} =\n\\begin{pmatrix}\n\\varepsilon_{\\mathrm{C}} + \\Delta  t \\\\\nt  \\varepsilon_{\\mathrm{H}}\n\\end{pmatrix}\n$$\n- 体系包含总共 3 个电子。占据方案指定为：能量较低的空间轨道被双占据（一个 $\\alpha$ 电子，一个 $\\beta$ 电子），能量较高的空间轨道被单占据（一个 $\\alpha$ 电子）。\n- 本征矢量：$v^{\\mathrm{KS}}_{\\mathrm{lo}}$, $v^{\\mathrm{KS}}_{\\mathrm{hi}}$ 对应 $H^{\\mathrm{KS}}$；$v^{\\alpha}_{\\mathrm{lo}}$, $v^{\\alpha}_{\\mathrm{hi}}$ 对应 $H^{\\alpha}$；以及 $v^{\\beta}_{\\mathrm{lo}}$ 对应 $H^{\\beta}$。所有本征矢量都是归一化和实数的。\n- KS 自旋分辨单粒子密度矩阵：\n$$\nP^{\\alpha}_{\\mathrm{KS}} = v^{\\mathrm{KS}}_{\\mathrm{lo}} (v^{\\mathrm{KS}}_{\\mathrm{lo}})^{\\mathsf{T}} + v^{\\mathrm{KS}}_{\\mathrm{hi}} (v^{\\mathrm{KS}}_{\\mathrm{hi}})^{\\mathsf{T}}\n$$\n$$\nP^{\\beta}_{\\mathrm{KS}} = v^{\\mathrm{KS}}_{\\mathrm{lo}} (v^{\\mathrm{KS}}_{\\mathrm{lo}})^{\\mathsf{T}}\n$$\n- UHF 自旋分辨单粒子密度矩阵：\n$$\nP^{\\alpha}_{\\mathrm{UHF}} = v^{\\alpha}_{\\mathrm{lo}} (v^{\\alpha}_{\\mathrm{lo}})^{\\mathsf{T}} + v^{\\alpha}_{\\mathrm{hi}} (v^{\\alpha}_{\\mathrm{hi}})^{\\mathsf{T}}\n$$\n$$\nP^{\\beta}_{\\mathrm{UHF}} = v^{\\beta}_{\\mathrm{lo}} (v^{\\beta}_{\\mathrm{lo}})^{\\mathsf{T}}\n$$\n- 基函数 $\\phi_{k}$ 的自旋密度定义：\n$$\n\\rho^{\\mathrm{KS}}_{k} = (P^{\\alpha}_{\\mathrm{KS}} - P^{\\beta}_{\\mathrm{KS}})_{kk},\n\\qquad\n\\rho^{\\mathrm{UHF}}_{k} = (P^{\\alpha}_{\\mathrm{UHF}} - P^{\\beta}_{\\mathrm{UHF}})_{kk}\n$$\n- 重叠度量：\n$$\ns_{\\mathrm{overlap}} = \\left| (v^{\\alpha}_{\\mathrm{hi}})^{\\mathsf{T}}\\, v^{\\mathrm{KS}}_{\\mathrm{hi}} \\right|\n$$\n- 任务：计算三元组 $[\\hspace{0.5mm}s_{\\mathrm{overlap}}, \\rho^{\\mathrm{KS}}_{\\mathrm{C}}, \\rho^{\\mathrm{UHF}}_{\\mathrm{C}}]$。\n- $(\\varepsilon_{\\mathrm{C}}, \\varepsilon_{\\mathrm{H}}, t, \\Delta)$ 的测试用例：\n  1. $(0.0, 0.0, 0.5, 0.0)$\n  2. $(0.2, -0.2, 0.4, 0.1)$\n  3. $(0.5, -0.5, 0.2, 0.4)$\n\n### 第 2 步：使用提取的已知条件进行验证\n对问题陈述进行严格审查。\n- **科学依据**：该问题使用了计算量子化学中的既定概念，即 Kohn-Sham 密度泛函理论 (KS-DFT) 和非限制性 Hartree-Fock (UHF) 理论。使用最小双轨道模型是说明电子结构方法之间基本差异的常用且有效的教学工具。\n- **良态问题**：该问题在数学上是良定义的。它需要对 $2 \\times 2$ 实对称矩阵进行对角化，这是一个标准过程，具有唯一的本征值和良定义的正交归一本征矢量（最多相差一个符号，最终量的定义已正确处理此问题）。所有必需的公式和参数均已提供。\n- **客观性**：语言精确、正式，没有歧义或主观论断。\n\n该问题不违反任何无效性标准。它是一个自洽、一致且可解的数学问题，其基础是物理化学理论。\n\n### 第 3 步：结论与行动\n该问题是**有效的**。应推导出一个严谨的解。\n\n### 解的推导\n任务是计算三个量：$s_{\\mathrm{overlap}}$、$\\rho^{\\mathrm{KS}}_{\\mathrm{C}}$ 和 $\\rho^{\\mathrm{UHF}}_{\\mathrm{C}}$。这需要找到矩阵 $H^{\\mathrm{KS}}$、$H^{\\alpha}$ 和 $H^{\\beta}$ 的本征矢量。\n\n一个通用的 $2 \\times 2$ 实对称矩阵 $H = \\begin{pmatrix} a  b \\\\ b  c \\end{pmatrix}$ 可通过一个旋转矩阵对角化。其本征矢量可以用单个角度 $\\theta$ 参数化。本征值为 $\\lambda_{\\pm} = \\frac{a+c}{2} \\pm \\sqrt{(\\frac{a-c}{2})^2 + b^2}$。令 $\\delta = (a-c)/2$。混合角 $\\theta$ 由 $\\tan(2\\theta) = b/\\delta$ 给出。确定此角度的一个稳健方法是 $\\theta = \\frac{1}{2}\\mathrm{atan2}(b, \\delta)$，其中 $\\mathrm{atan2}(y, x)$ 是双参数反正切函数。根据此约定，对应于较高本征值 $\\lambda_{\\mathrm{hi}} = \\frac{a+c}{2} + \\sqrt{\\delta^2 + b^2}$ 的本征矢量是 $v_{\\mathrm{hi}} = (\\cos\\theta, \\sin\\theta)^{\\mathsf{T}}$，而对应于较低本征值 $\\lambda_{\\mathrm{lo}} = \\frac{a+c}{2} - \\sqrt{\\delta^2 + b^2}$ 的本征矢量是正交矢量 $v_{\\mathrm{lo}} = (-\\sin\\theta, \\cos\\theta)^{\\mathsf{T}}$。这些矢量的第一个分量对应于基函数 $\\phi_{\\mathrm{C}}$，第二个分量对应于 $\\phi_{\\mathrm{H}}$。\n\n我们将此通用过程应用于每个哈密顿量。\n\n1.  **Kohn-Sham 体系：**\n    对于 $H^{\\mathrm{KS}}$，我们有 $a = \\varepsilon_{\\mathrm{C}}$，$b = t$，$c = \\varepsilon_{\\mathrm{H}}$。\n    令 $\\delta_{\\mathrm{KS}} = (\\varepsilon_{\\mathrm{C}} - \\varepsilon_{\\mathrm{H}})/2$。\n    混合角为 $\\theta_{\\mathrm{KS}} = \\frac{1}{2}\\mathrm{atan2}(t, \\delta_{\\mathrm{KS}})$。\n    本征矢量为：\n    $v^{\\mathrm{KS}}_{\\mathrm{hi}} = \\begin{pmatrix} \\cos\\theta_{\\mathrm{KS}} \\\\ \\sin\\theta_{\\mathrm{KS}} \\end{pmatrix}$, $v^{\\mathrm{KS}}_{\\mathrm{lo}} = \\begin{pmatrix} -\\sin\\theta_{\\mathrm{KS}} \\\\ \\cos\\theta_{\\mathrm{KS}} \\end{pmatrix}$。\n\n2.  **UHF $\\alpha$-自旋体系：**\n    对于 $H^{\\alpha}$，我们有 $a = \\varepsilon_{\\mathrm{C}} - \\Delta$，$b = t$，$c = \\varepsilon_{\\mathrm{H}}$。\n    令 $\\delta_{\\alpha} = (\\varepsilon_{\\mathrm{C}} - \\Delta - \\varepsilon_{\\mathrm{H}})/2$。\n    混合角为 $\\theta_{\\alpha} = \\frac{1}{2}\\mathrm{atan2}(t, \\delta_{\\alpha})$。\n    本征矢量为：\n    $v^{\\alpha}_{\\mathrm{hi}} = \\begin{pmatrix} \\cos\\theta_{\\alpha} \\\\ \\sin\\theta_{\\alpha} \\end{pmatrix}$, $v^{\\alpha}_{\\mathrm{lo}} = \\begin{pmatrix} -\\sin\\theta_{\\alpha} \\\\ \\cos\\theta_{\\alpha} \\end{pmatrix}$。\n\n3.  **UHF $\\beta$-自旋体系：**\n    对于 $H^{\\beta}$，我们有 $a = \\varepsilon_{\\mathrm{C}} + \\Delta$，$b = t$，$c = \\varepsilon_{\\mathrm{H}}$。\n    令 $\\delta_{\\beta} = (\\varepsilon_{\\mathrm{C}} + \\Delta - \\varepsilon_{\\mathrm{H}})/2$。\n    混合角为 $\\theta_{\\beta} = \\frac{1}{2}\\mathrm{atan2}(t, \\delta_{\\beta})$。\n    $\\beta$-自旋本征矢量为：\n    $v^{\\beta}_{\\mathrm{hi}} = \\begin{pmatrix} \\cos\\theta_{\\beta} \\\\ \\sin\\theta_{\\beta} \\end{pmatrix}$, $v^{\\beta}_{\\mathrm{lo}} = \\begin{pmatrix} -\\sin\\theta_{\\beta} \\\\ \\cos\\theta_{\\beta} \\end{pmatrix}$。\n\n接下来，我们推导目标量的表达式。\n\n**重叠 $s_{\\mathrm{overlap}}$：**\n这被定义为单占据 $\\alpha$-UHF 轨道与单占据 KS 轨道之间标量积的绝对值。问题指明能量较高的轨道被一个 $\\alpha$ 电子单占据。\n$s_{\\mathrm{overlap}} = | (v^{\\alpha}_{\\mathrm{hi}})^{\\mathsf{T}} v^{\\mathrm{KS}}_{\\mathrm{hi}} | = | (\\cos\\theta_{\\alpha}, \\sin\\theta_{\\alpha}) \\begin{pmatrix} \\cos\\theta_{\\mathrm{KS}} \\\\ \\sin\\theta_{\\mathrm{KS}} \\end{pmatrix} |$\n$s_{\\mathrm{overlap}} = | \\cos\\theta_{\\alpha}\\cos\\theta_{\\mathrm{KS}} + \\sin\\theta_{\\alpha}\\sin\\theta_{\\mathrm{KS}} | = |\\cos(\\theta_{\\alpha} - \\theta_{\\mathrm{KS}})|$。\n\n**KS 自旋密度 $\\rho^{\\mathrm{KS}}_{\\mathrm{C}}$：**\n以碳为中心的基函数 $\\phi_{\\mathrm{C}}$ 上的自旋密度是自旋密度矩阵 $P^{\\alpha}_{\\mathrm{KS}} - P^{\\beta}_{\\mathrm{KS}}$ 的 $(1,1)$ 元。\n$P^{\\alpha}_{\\mathrm{KS}} = v^{\\mathrm{KS}}_{\\mathrm{lo}}(v^{\\mathrm{KS}}_{\\mathrm{lo}})^{\\mathsf{T}} + v^{\\mathrm{KS}}_{\\mathrm{hi}}(v^{\\mathrm{KS}}_{\\mathrm{hi}})^{\\mathsf{T}}$。由于 $\\{v^{\\mathrm{KS}}_{\\mathrm{lo}}, v^{\\mathrm{KS}}_{\\mathrm{hi}}\\}$ 是 $\\mathbb{R}^2$ 的一个完备正交归一基，该和为单位矩阵，$P^{\\alpha}_{\\mathrm{KS}} = I$。这是最小基组中两个 $\\alpha$ 轨道都被占据的结果。\n$P^{\\beta}_{\\mathrm{KS}} = v^{\\mathrm{KS}}_{\\mathrm{lo}}(v^{\\mathrm{KS}}_{\\mathrm{lo}})^{\\mathsf{T}}$。\n自旋密度矩阵为 $P^{\\alpha}_{\\mathrm{KS}} - P^{\\beta}_{\\mathrm{KS}} = I - v^{\\mathrm{KS}}_{\\mathrm{lo}}(v^{\\mathrm{KS}}_{\\mathrm{lo}})^{\\mathsf{T}} = v^{\\mathrm{KS}}_{\\mathrm{hi}}(v^{\\mathrm{KS}}_{\\mathrm{hi}})^{\\mathsf{T}}$。\n因此，$\\rho^{\\mathrm{KS}}_{\\mathrm{C}} = (v^{\\mathrm{KS}}_{\\mathrm{hi}}(v^{\\mathrm{KS}}_{\\mathrm{hi}})^{\\mathsf{T}})_{11} = (v^{\\mathrm{KS}}_{\\mathrm{hi}})_1^2$。\n使用 $v^{\\mathrm{KS}}_{\\mathrm{hi}}$ 的表达式，我们得到：\n$\\rho^{\\mathrm{KS}}_{\\mathrm{C}} = (\\cos\\theta_{\\mathrm{KS}})^2 = \\cos^2\\theta_{\\mathrm{KS}}$。\n\n**UHF 自旋密度 $\\rho^{\\mathrm{UHF}}_{\\mathrm{C}}$：**\n类似地，$\\rho^{\\mathrm{UHF}}_{\\mathrm{C}} = (P^{\\alpha}_{\\mathrm{UHF}} - P^{\\beta}_{\\mathrm{UHF}})_{11}$。\n和之前一样，$P^{\\alpha}_{\\mathrm{UHF}} = v^{\\alpha}_{\\mathrm{lo}}(v^{\\alpha}_{\\mathrm{lo}})^{\\mathsf{T}} + v^{\\alpha}_{\\mathrm{hi}}(v^{\\alpha}_{\\mathrm{hi}})^{\\mathsf{T}} = I$。\n$\\beta$-自旋密度矩阵由能量最低的 $\\beta$ 轨道构成：$P^{\\beta}_{\\mathrm{UHF}} = v^{\\beta}_{\\mathrm{lo}}(v^{\\beta}_{\\mathrm{lo}})^{\\mathsf{T}}$。\nUHF 自旋密度矩阵是 $P^{\\alpha}_{\\mathrm{UHF}} - P^{\\beta}_{\\mathrm{UHF}} = I - v^{\\beta}_{\\mathrm{lo}}(v^{\\beta}_{\\mathrm{lo}})^{\\mathsf{T}}$。这个式子不像 KS 的情况那样可以很好地简化，因为轨道来自不同的哈密顿量。\n$\\rho^{\\mathrm{UHF}}_{\\mathrm{C}} = (I)_{11} - (v^{\\beta}_{\\mathrm{lo}}(v^{\\beta}_{\\mathrm{lo}})^{\\mathsf{T}})_{11} = 1 - (v^{\\beta}_{\\mathrm{lo}})_1^2$。\n使用 $v^{\\beta}_{\\mathrm{lo}} = (-\\sin\\theta_{\\beta}, \\cos\\theta_{\\beta})^{\\mathsf{T}}$，其第一个分量是 $(v^{\\beta}_{\\mathrm{lo}})_1 = -\\sin\\theta_{\\beta}$。\n$\\rho^{\\mathrm{UHF}}_{\\mathrm{C}} = 1 - (-\\sin\\theta_{\\beta})^2 = 1 - \\sin^2\\theta_{\\beta} = \\cos^2\\theta_{\\beta}$。\n\n**用于实现的公式总结：**\n对于每组参数 $(\\varepsilon_{\\mathrm{C}}, \\varepsilon_{\\mathrm{H}}, t, \\Delta)$：\n1.  $\\delta_{\\mathrm{KS}} = (\\varepsilon_{\\mathrm{C}} - \\varepsilon_{\\mathrm{H}}) / 2$\n2.  $\\theta_{\\mathrm{KS}} = \\frac{1}{2} \\mathrm{atan2}(t, \\delta_{\\mathrm{KS}})$\n3.  $\\delta_{\\alpha} = (\\varepsilon_{\\mathrm{C}} - \\Delta - \\varepsilon_{\\mathrm{H}}) / 2$\n4.  $\\theta_{\\alpha} = \\frac{1}{2} \\mathrm{atan2}(t, \\delta_{\\alpha})$\n5.  $\\delta_{\\beta} = (\\varepsilon_{\\mathrm{C}} + \\Delta - \\varepsilon_{\\mathrm{H}}) / 2$\n6.  $\\theta_{\\beta} = \\frac{1}{2} \\mathrm{atan2}(t, \\delta_{\\beta})$\n7.  $s_{\\mathrm{overlap}} = |\\cos(\\theta_{\\alpha} - \\theta_{\\mathrm{KS}})|$\n8.  $\\rho^{\\mathrm{KS}}_{\\mathrm{C}} = \\cos^2\\theta_{\\mathrm{KS}}$\n9.  $\\rho^{\\mathrm{UHF}}_{\\mathrm{C}} = \\cos^2\\theta_{\\beta}$\n\n现在为提供的测试用例实现这些公式。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the anayltical model for KS and UHF orbitals for given parameters.\n    \"\"\"\n    # Test cases: tuples of (eps_C, eps_H, t, Delta)\n    test_cases = [\n        (0.0, 0.0, 0.5, 0.0),\n        (0.2, -0.2, 0.4, 0.1),\n        (0.5, -0.5, 0.2, 0.4),\n    ]\n\n    results = []\n    for case in test_cases:\n        eps_C, eps_H, t, delta_param = case\n\n        # KS system calculation\n        # delta = (a-c)/2\n        delta_KS = (eps_C - eps_H) / 2.0\n        # theta = 0.5 * atan2(b, delta)\n        theta_KS = 0.5 * np.arctan2(t, delta_KS)\n\n        # UHF alpha-spin system calculation\n        delta_alpha = (eps_C - delta_param - eps_H) / 2.0\n        theta_alpha = 0.5 * np.arctan2(t, delta_alpha)\n\n        # UHF beta-spin system calculation\n        delta_beta = (eps_C + delta_param - eps_H) / 2.0\n        theta_beta = 0.5 * np.arctan2(t, delta_beta)\n\n        # 1. Overlap s_overlap = |cos(theta_alpha - theta_KS)|\n        s_overlap = np.abs(np.cos(theta_alpha - theta_KS))\n\n        # 2. KS spin density on C: rho_KS_C = cos^2(theta_KS)\n        rho_KS_C = np.cos(theta_KS)**2\n\n        # 3. UHF spin density on C: rho_UHF_C = cos^2(theta_beta)\n        rho_UHF_C = np.cos(theta_beta)**2\n\n        results.append([s_overlap, rho_KS_C, rho_UHF_C])\n\n    # Format the output as specified: [[x1,y1,z1],[x2,y2,z2],...] with no spaces.\n    results_str = [f\"[{res[0]},{res[1]},{res[2]}]\" for res in results]\n    print(f\"[{','.join(results_str)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "大的最高占据分子轨道（HOMO）与最低未占据分子轨道（LUMO）之间的能隙，通常被错误地等同于低的化学反应活性。本练习使用一个亲电体模型来证明，反应活性，特别是在电荷转移反应中，取决于前线轨道的绝对能量，而不仅仅是它们之间的能隙 。这个模型有助于我们培养对化学反应性更深刻、更细致的理解，避免对前线轨道理论的过度简化。",
            "id": "2456921",
            "problem": "给定一个最小单电子模型，作为共轭亲电体 Kohn-Sham (KS) 描述的替代模型。考虑一个线性三原子 $\\pi$ 体系，其三个原子位点排列成一条链。其在原子轨道基下的单电子哈密顿量由一个 Hückel 型矩阵定义，对角元素为 $H_{ii}=\\alpha_i$（在位能，单位 eV），最近邻非对角元素为 $H_{i,i+1}=H_{i+1,i}=\\beta$（跃迁能，单位 eV），所有其他元素均为 $0$。KS 轨道能由该矩阵的本征值 $\\{\\varepsilon_k\\}$ 建模。对于一个具有 $N$ 个电子的体系，在自旋限制的闭壳层填充规则下，最高已占分子轨道 (HOMO) 能量 $\\varepsilon_{\\mathrm{H}}$ 是最高全占据或单占据轨道的能量，而最低未占分子轨道 (LUMO) 能量 $\\varepsilon_{\\mathrm{L}}$ 是下一个更高的本征值。KS HOMO–LUMO 间隙为 $\\Delta_{\\mathrm{KS}}=\\varepsilon_{\\mathrm{L}}-\\varepsilon_{\\mathrm{H}}$，单位为 eV。\n\n为一个 HOMO 能量为 $\\varepsilon_{\\mathrm{H}}^{\\mathrm{don}}$（单位 eV）的电子给体与所建模型中的受体（该三原子体系）相互作用时，定义一个简单的电荷转移驱动力为\n$$\n\\Delta E_{\\mathrm{CT}}=\\varepsilon_{\\mathrm{L}}-\\varepsilon_{\\mathrm{H}}^{\\mathrm{don}}-J,\n$$\n其中 $J$（单位 eV）是电荷分离后的有效库仑稳定化能。将 $\\Delta E_{\\mathrm{CT}}\\le 0$ 解释为具有放能的电子转移倾向（即，在此模型下对给体“有反应性”）。“大” KS 间隙由阈值 $\\Delta_{\\mathrm{KS}}\\ge G_{\\mathrm{thr}}$ 定义，其中 $G_{\\mathrm{thr}}=4.0$ eV。\n\n您的任务是，对下面的每个测试用例，计算：\n- KS HOMO–LUMO 间隙 $\\Delta_{\\mathrm{KS}}$（单位 eV），\n- 电荷转移驱动力 $\\Delta E_{\\mathrm{CT}}$（单位 eV），\n- 一个布尔值，报告 $\\Delta_{\\mathrm{KS}}\\ge G_{\\mathrm{thr}}$ 和 $\\Delta E_{\\mathrm{CT}}\\le 0$ 这两个条件是否同时成立。\n\n将这种同时满足的情况解释为“表观矛盾”：即 KS HOMO–LUMO 间隙很大，但体系却被预测为对给体有反应性。\n\n使用以下测试套件。每个用例指定了 $\\boldsymbol{\\alpha}=[\\alpha_1,\\alpha_2,\\alpha_3]$（单位 eV）、$\\beta$（单位 eV）、$N$（电子数）、$\\varepsilon_{\\mathrm{H}}^{\\mathrm{don}}$（单位 eV）和 $J$（单位 eV）：\n- 用例 1：$\\boldsymbol{\\alpha}=[0.0,-4.0,0.0]$，$\\beta=-2.5$， $N=2$，$\\varepsilon_{\\mathrm{H}}^{\\mathrm{don}}=-4.0$， $J=4.2$。\n- 用例 2：$\\boldsymbol{\\alpha}=[0.0,-3.0,0.0]$，$\\beta=-2.5$， $N=2$，$\\varepsilon_{\\mathrm{H}}^{\\mathrm{don}}=-5.0$， $J=2.0$。\n- 用例 3：$\\boldsymbol{\\alpha}=[0.0,0.0,0.0]$，$\\beta=-2.82842712474619$， $N=2$，$\\varepsilon_{\\mathrm{H}}^{\\mathrm{don}}=-6.0$， $J=1.0$。\n- 用例 4：$\\boldsymbol{\\alpha}=[0.0,-4.0,0.0]$，$\\beta=-2.5$， $N=3$，$\\varepsilon_{\\mathrm{H}}^{\\mathrm{don}}=-4.0$， $J=4.2$。\n\n角度单位不会出现。能量必须以 eV 为单位进行处理和计算。您的程序的最终输出应为单行，包含一个方括号括起来的、以逗号分隔的布尔值列表，分别指出用例 1 到 4 的“表观矛盾”是否成立。例如，输出格式必须与 $[\\text{result}_1,\\text{result}_2,\\text{result}_3,\\text{result}_4]$ 完全一样，其中每个 $\\text{result}_i$ 为 $\\text{True}$ 或 $\\text{False}$。",
            "solution": "所给问题具有科学依据，提法明确，且客观。它提出了一个来自计算化学的简化但有效的模型，用以探究 Kohn-Sham (KS) 轨道间隙与化学反应性之间的关系。该问题没有矛盾或含糊之处，可以通过标准的数学步骤解决。因此，我们将进行严谨的解析求解。\n\n问题的核心是分析一个线性三原子 $\\pi$ 体系的单电子模型。其电子结构由一个 $3 \\times 3$ 的 Hückel 型哈密顿矩阵 $H$ 描述，矩阵元素在原子轨道基下给出。对角元素是在位能 $H_{ii} = \\alpha_i$，最近邻非对角元素是跃迁能 $H_{i,i+1} = H_{i+1,i} = \\beta$。所有其他元素均为零。该矩阵的一般形式为：\n$$\nH = \\begin{pmatrix} \\alpha_1  \\beta  0 \\\\ \\beta  \\alpha_2  \\beta \\\\ 0  \\beta  \\alpha_3 \\end{pmatrix}\n$$\n该矩阵的本征值 $\\{\\varepsilon_k\\}$ 代表 KS 轨道能。由于 $H$ 是一个实对称矩阵，其本征值保证为实数。这些本征值是特征方程 $\\det(H - \\varepsilon I) = 0$ 的根，其中 $I$ 是 $3 \\times 3$ 单位矩阵。该方程为：\n$$\n(\\alpha_1 - \\varepsilon)[(\\alpha_2 - \\varepsilon)(\\alpha_3 - \\varepsilon) - \\beta^2] - \\beta[\\beta(\\alpha_3 - \\varepsilon)] = 0\n$$\n求解这个三次方程可以得到三个轨道能，我们将其按 $\\varepsilon_1 \\le \\varepsilon_2 \\le \\varepsilon_3$ 排序。\n\n根据电子数 $N$ 和自旋限制的填充规则，已占轨道数为 $N_{\\mathrm{occ}} = \\lceil N/2 \\rceil$。于是，最高已占分子轨道 (HOMO) 能量 $\\varepsilon_{\\mathrm{H}}$ 和最低未占分子轨道 (LUMO) 能量 $\\varepsilon_{\\mathrm{L}}$ 被确定为：\n$$\n\\varepsilon_{\\mathrm{H}} = \\varepsilon_{N_{\\mathrm{occ}}} \\quad \\text{and} \\quad \\varepsilon_{\\mathrm{L}} = \\varepsilon_{N_{\\mathrm{occ}}+1}\n$$\n由此，我们计算两个关键量：\n1.  KS HOMO-LUMO 间隙：$\\Delta_{\\mathrm{KS}} = \\varepsilon_{\\mathrm{L}} - \\varepsilon_{\\mathrm{H}}$\n2.  电荷转移驱动力：$\\Delta E_{\\mathrm{CT}} = \\varepsilon_{\\mathrm{L}} - \\varepsilon_{\\mathrm{H}}^{\\mathrm{don}} - J$\n\n问题将“表观矛盾”定义为同时满足两个条件：\n1.  大的 KS 间隙：$\\Delta_{\\mathrm{KS}} \\ge G_{\\mathrm{thr}}$，其中阈值为 $G_{\\mathrm{thr}} = 4.0$ eV。\n2.  放能的电荷转移倾向：$\\Delta E_{\\mathrm{CT}} \\le 0$ eV。\n\n现在我们将此过程系统地应用于每个指定的测试用例。\n\n**用例 1：**\n- 参数：$\\boldsymbol{\\alpha}=[0.0, -4.0, 0.0]$ eV，$\\beta=-2.5$ eV，$N=2$，$\\varepsilon_{\\mathrm{H}}^{\\mathrm{don}}=-4.0$ eV，$J=4.2$ eV。\n- 哈密顿量为 $H_1 = \\begin{pmatrix} 0.0  -2.5  0.0 \\\\ -2.5  -4.0  -2.5 \\\\ 0.0  -2.5  0.0 \\end{pmatrix}$。\n- 特征方程为 $-\\varepsilon[(\\varepsilon+4.0)\\varepsilon - (-2.5)^2] - (-2.5)[(-2.5)(-\\varepsilon)] = -\\varepsilon(\\varepsilon^2 + 4.0\\varepsilon - 12.5) = 0$。\n- 本征值为 $\\varepsilon = 0$ 以及 $\\varepsilon^2 + 4.0\\varepsilon - 12.5 = 0$ 的根，即 $\\varepsilon = -2.0 \\pm \\sqrt{16.5}$。\n- 排序后的本征值为 $\\varepsilon_1 = (-2.0 - \\sqrt{16.5}) \\approx -6.062$ eV，$\\varepsilon_2 = 0.0$ eV，以及 $\\varepsilon_3 = (-2.0 + \\sqrt{16.5}) \\approx 2.062$ eV。\n- 对于 $N=2$ 个电子， $N_{\\mathrm{occ}} = \\lceil 2/2 \\rceil = 1$。\n- $\\varepsilon_{\\mathrm{H}} = \\varepsilon_1 = (-2.0 - \\sqrt{16.5})$ eV。\n- $\\varepsilon_{\\mathrm{L}} = \\varepsilon_2 = 0.0$ eV。\n- $\\Delta_{\\mathrm{KS}} = \\varepsilon_{\\mathrm{L}} - \\varepsilon_{\\mathrm{H}} = (2.0 + \\sqrt{16.5}) \\approx 6.062$ eV。\n- $\\Delta E_{\\mathrm{CT}} = \\varepsilon_{\\mathrm{L}} - \\varepsilon_{\\mathrm{H}}^{\\mathrm{don}} - J = 0.0 - (-4.0) - 4.2 = -0.2$ eV。\n- 条件检查：$\\Delta_{\\mathrm{KS}} \\approx 6.062 \\ge 4.0$ (True) 且 $\\Delta E_{\\mathrm{CT}} = -0.2 \\le 0$ (True)。\n- 两个条件都成立。此用例的结果是 **True**。\n\n**用例 2：**\n- 参数：$\\boldsymbol{\\alpha}=[0.0, -3.0, 0.0]$ eV，$\\beta=-2.5$ eV，$N=2$，$\\varepsilon_{\\mathrm{H}}^{\\mathrm{don}}=-5.0$ eV，$J=2.0$ eV。\n- 哈密顿量为 $H_2 = \\begin{pmatrix} 0.0  -2.5  0.0 \\\\ -2.5  -3.0  -2.5 \\\\ 0.0  -2.5  0.0 \\end{pmatrix}$。\n- 特征方程为 $-\\varepsilon(\\varepsilon^2 + 3.0\\varepsilon - 12.5) = 0$。\n- 本征值为 $\\varepsilon = 0$ 和 $\\varepsilon = -1.5 \\pm \\sqrt{14.75}$。\n- 排序后的本征值为 $\\varepsilon_1 \\approx -5.341$ eV，$\\varepsilon_2 = 0.0$ eV，$\\varepsilon_3 \\approx 2.341$ eV。\n- 对于 $N=2$ 个电子， $N_{\\mathrm{occ}} = 1$。$\\varepsilon_{\\mathrm{H}} = \\varepsilon_1$ 且 $\\varepsilon_{\\mathrm{L}} = \\varepsilon_2$。\n- $\\Delta_{\\mathrm{KS}} = \\varepsilon_2 - \\varepsilon_1 \\approx 5.341$ eV。\n- $\\Delta E_{\\mathrm{CT}} = \\varepsilon_{\\mathrm{L}} - \\varepsilon_{\\mathrm{H}}^{\\mathrm{don}} - J = 0.0 - (-5.0) - 2.0 = 3.0$ eV。\n- 条件检查：$\\Delta_{\\mathrm{KS}} \\approx 5.341 \\ge 4.0$ (True) 但 $\\Delta E_{\\mathrm{CT}} = 3.0 \\le 0$ (False)。\n- 此用例的结果是 **False**。\n\n**用例 3：**\n- 参数：$\\boldsymbol{\\alpha}=[0.0, 0.0, 0.0]$ eV，$\\beta=-2\\sqrt{2} \\approx -2.828$ eV，$N=2$，$\\varepsilon_{\\mathrm{H}}^{\\mathrm{don}}=-6.0$ eV，$J=1.0$ eV。\n- 哈密顿量是标准烯丙基体系的哈密顿量，$H_3 = \\begin{pmatrix} 0  \\beta  0 \\\\ \\beta  0  \\beta \\\\ 0  \\beta  0 \\end{pmatrix}$。\n- 其本征值已知为 $\\varepsilon=0, \\pm\\sqrt{2}\\beta$。当 $\\beta = -2\\sqrt{2}$ 时，本征值为 $\\varepsilon=0, \\pm\\sqrt{2}(-2\\sqrt{2}) = \\mp 4.0$。\n- 排序后的本征值为 $\\varepsilon_1 = -4.0$ eV，$\\varepsilon_2 = 0.0$ eV，$\\varepsilon_3 = 4.0$ eV。\n- 对于 $N=2$ 个电子， $N_{\\mathrm{occ}} = 1$。$\\varepsilon_{\\mathrm{H}} = \\varepsilon_1 = -4.0$ eV 且 $\\varepsilon_{\\mathrm{L}} = \\varepsilon_2 = 0.0$ eV。\n- $\\Delta_{\\mathrm{KS}} = \\varepsilon_2 - \\varepsilon_1 = 0.0 - (-4.0) = 4.0$ eV。\n- $\\Delta E_{\\mathrm{CT}} = \\varepsilon_{\\mathrm{L}} - \\varepsilon_{\\mathrm{H}}^{\\mathrm{don}} - J = 0.0 - (-6.0) - 1.0 = 5.0$ eV。\n- 条件检查：$\\Delta_{\\mathrm{KS}} = 4.0 \\ge 4.0$ (True) 但 $\\Delta E_{\\mathrm{CT}} = 5.0 \\le 0$ (False)。\n- 此用例的结果是 **False**。\n\n**用例 4：**\n- 参数：$\\boldsymbol{\\alpha}=[0.0, -4.0, 0.0]$ eV，$\\beta=-2.5$ eV，$N=3$，$\\varepsilon_{\\mathrm{H}}^{\\mathrm{don}}=-4.0$ eV，$J=4.2$ eV。\n- 哈密顿量及其本征值与用例 1 相同。\n- 本征值为 $\\varepsilon_1 \\approx -6.062$ eV，$\\varepsilon_2 = 0.0$ eV，以及 $\\varepsilon_3 \\approx 2.062$ eV。\n- 对于 $N=3$ 个电子， $N_{\\mathrm{occ}} = \\lceil 3/2 \\rceil = 2$。\n- $\\varepsilon_{\\mathrm{H}} = \\varepsilon_2 = 0.0$ eV。\n- $\\varepsilon_{\\mathrm{L}} = \\varepsilon_3 = (-2.0 + \\sqrt{16.5}) \\approx 2.062$ eV。\n- $\\Delta_{\\mathrm{KS}} = \\varepsilon_{\\mathrm{L}} - \\varepsilon_{\\mathrm{H}} \\approx 2.062$ eV。\n- $\\Delta E_{\\mathrm{CT}} = \\varepsilon_{\\mathrm{L}} - \\varepsilon_{\\mathrm{H}}^{\\mathrm{don}} - J = (-2.0 + \\sqrt{16.5}) - (-4.0) - 4.2 = (-2.2 + \\sqrt{16.5}) \\approx 1.862$ eV。\n- 条件检查：$\\Delta_{\\mathrm{KS}} \\approx 2.062 \\ge 4.0$ (False)。第一个条件不满足。\n- 此用例的结果是 **False**。\n\n这一严谨的分析表明，只有第一个用例呈现出“表观矛盾”，这凸显了一个事实：仅凭大的 KS 间隙本身并不足以预测化学惰性。在此电荷转移模型中，反应性是由 LUMO 的绝对位置决定的，而不仅仅是其与 HOMO 的能量差。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem for the given test cases, determining if an \"apparent contradiction\"\n    between a large KS gap and predicted reactivity exists.\n    \"\"\"\n\n    # Each test case is a tuple: (alpha_vector, beta, N, e_h_don, J)\n    # alpha_vector: on-site energies [a1, a2, a3] in eV\n    # beta: hopping energy in eV\n    # N: number of electrons\n    # e_h_don: donor HOMO energy in eV\n    # J: Coulomb stabilization in eV\n    test_cases = [\n        ([0.0, -4.0, 0.0], -2.5, 2, -4.0, 4.2),  # Case 1\n        ([0.0, -3.0, 0.0], -2.5, 2, -5.0, 2.0),  # Case 2\n        ([0.0, 0.0, 0.0], -2.82842712474619, 2, -6.0, 1.0),  # Case 3\n        ([0.0, -4.0, 0.0], -2.5, 3, -4.0, 4.2),  # Case 4\n    ]\n\n    G_thr = 4.0  # Threshold for \"large\" KS gap in eV\n    results = []\n\n    for case in test_cases:\n        alpha, beta, N, e_h_don, J = case\n        \n        # Construct the 3x3 Hückel-type Hamiltonian matrix\n        H = np.array([\n            [alpha[0], beta, 0],\n            [beta, alpha[1], beta],\n            [0, beta, alpha[2]]\n        ])\n        \n        # Calculate the eigenvalues (orbital energies).\n        # np.linalg.eigh returns eigenvalues in ascending order.\n        eigenvalues = np.linalg.eigh(H)[0]\n        \n        # Determine the number of occupied orbitals based on N\n        # n_occ is 1-indexed for orbital numbering (e.g., orbital 1, 2, 3)\n        n_occ = int(np.ceil(N / 2.0))\n        \n        # Identify HOMO and LUMO energies. Arrays are 0-indexed.\n        # e.g., for n_occ=1, HOMO is eigenvalues[0], LUMO is eigenvalues[1]\n        e_homo = eigenvalues[n_occ - 1]\n        e_lumo = eigenvalues[n_occ]\n        \n        # Compute the KS HOMO-LUMO gap\n        delta_ks = e_lumo - e_homo\n        \n        # Compute the charge-transfer driving force\n        delta_ect = e_lumo - e_h_don - J\n        \n        # Check for the \"apparent contradiction\"\n        # Condition 1: Large KS gap\n        # Condition 2: Exergonic charge transfer\n        is_contradiction = (delta_ks >= G_thr) and (delta_ect = 0)\n        \n        results.append(is_contradiction)\n\n    # Format the final output as a single line: a comma-separated list of booleans\n    # Example: [True,False,False,False]\n    print(f\"[{','.join(map(str, results))}]\")\n\nsolve()\n```"
        }
    ]
}