{
    "hands_on_practices": [
        {
            "introduction": "均匀电子气是密度泛函理论中的一个关键模型系统，类似于原子物理学中的氢原子。通过推导这个理想化系统的精确动能和交换能，我们可以为最广泛使用的泛函（如局域密度近似，LDA）奠定基础。这项练习将向你展示著名的 $\\rho^{5/3}$ 和 $\\rho^{4/3}$ 依赖关系是如何从第一性原理中产生的。",
            "id": "2453886",
            "problem": "考虑一个三维均匀电子气（通常称为胶质模型）：在热力学极限下，大量自旋非极化的电子以恒定的数密度 $\\rho_{0}$ 占据一个体积为 $V$、具有周期性边界条件的立方盒子。使用哈特里原子单位，即 $\\hbar=m_{e}=e=4\\pi\\varepsilon_{0}=1$。在科恩-沈密度泛函理论（DFT）中，无相互作用动能泛函 $T_{s}[\\rho]$ 定义为可再现密度 $\\rho(\\mathbf{r})$ 的无相互作用参考体系的基态动能，而交换能泛函 $E_{x}[\\rho]$ 定义为该参考体系的福克交换能。\n\n对于均匀密度 $\\rho(\\mathbf{r})=\\rho_{0}$，假设自旋简并度为 $g_{s}=2$，确定 $T_{s}[\\rho_{0}]$ 和 $E_{x}[\\rho_{0}]$ 对 $\\rho_{0}$ 和 $V$ 的精确依赖关系。将您的最终答案表示为一个双元素行矩阵，按顺序包含 $T_{s}[\\rho_{0}]$ 和 $E_{x}[\\rho_{0}]$，单位为哈特里原子单位。无需四舍五入。",
            "solution": "所述问题是有效的。这是一个关于均匀电子气（也称为胶质模型）的固态物理和密度泛函理论中的经典问题。前提条件在科学上是合理的、良定的，并且所有必要信息都已提供。我们将开始求解。\n\n问题要求计算在体积 $V$ 中，恒定密度为 $\\rho_0$ 的均匀电子气的无相互作用动能泛函 $T_s[\\rho_0]$ 和交换能泛函 $E_x[\\rho_0]$。我们使用哈特里原子单位，其中 $\\hbar = m_e = e = 4\\pi\\varepsilon_0 = 1$。给定的自旋简并度为 $g_s=2$。\n\n首先，我们确定无相互作用动能 $T_s[\\rho_0]$。根据定义，这是一个具有基态密度 $\\rho_0$ 的无相互作用电子体系的动能。对于均匀气体，无相互作用参考体系就是一个无相互作用的费米子气体。通过填充单粒子能级直至费米能来构建基态。\n\n在体积为 $V=L^3$、具有周期性边界条件的立方盒子中，电子的单粒子波函数是平面波：\n$$\n\\psi_{\\mathbf{k}}(\\mathbf{r}) = \\frac{1}{\\sqrt{V}} \\exp(i\\mathbf{k} \\cdot \\mathbf{r})\n$$\n相应的动能为：\n$$\n\\epsilon_{\\mathbf{k}} = \\frac{\\hbar^2 |\\mathbf{k}|^2}{2m_e} = \\frac{|\\mathbf{k}|^2}{2}\n$$\n在基态下，所有波矢大小 $|\\mathbf{k}|$ 直到费米波矢 $k_F$ 的态都被占据。电子总数 $N$ 通过 $N = \\rho_0 V$ 与密度 $\\rho_0$ 相关联。在热力学极限下，对离散 $\\mathbf{k}$ 态的求和可以替换为在 $\\mathbf{k}$ 空间中的积分：\n$$\n\\sum_{\\mathbf{k}} \\to V \\int \\frac{d^3\\mathbf{k}}{(2\\pi)^3}\n$$\n电子总数可以通过对 $\\mathbf{k}$ 空间中费米球的体积进行积分，再乘以自旋简并度 $g_s=2$ 来求得：\n$$\nN = g_s V \\int_{|\\mathbf{k}| \\le k_F} \\frac{d^3\\mathbf{k}}{(2\\pi)^3} = 2V \\left( \\frac{4\\pi k_F^3}{3(2\\pi)^3} \\right) = V \\frac{k_F^3}{3\\pi^2}\n$$\n由此，我们建立了密度 $\\rho_0 = N/V$ 和费米波矢 $k_F$ 之间的关系：\n$$\n\\rho_0 = \\frac{k_F^3}{3\\pi^2} \\implies k_F = (3\\pi^2 \\rho_0)^{1/3}\n$$\n总的无相互作用动能 $T_s[\\rho_0]$ 是所有已占据态的能量之和：\n$$\nT_s[\\rho_0] = g_s \\sum_{|\\mathbf{k}| \\le k_F} \\epsilon_{\\mathbf{k}} = g_s V \\int_{|\\mathbf{k}| \\le k_F} \\frac{|\\mathbf{k}|^2}{2} \\frac{d^3\\mathbf{k}}{(2\\pi)^3}\n$$\n代入 $g_s=2$ 并切换到 $\\mathbf{k}$ 空间中的球坐标（$d^3\\mathbf{k} = 4\\pi |\\mathbf{k}|^2 d|\\mathbf{k}|$)，积分为：\n$$\nT_s[\\rho_0] = 2 V \\frac{4\\pi}{(2\\pi)^3} \\int_0^{k_F} \\frac{k^2}{2} k^2 dk = \\frac{V}{\\pi^2} \\int_0^{k_F} \\frac{k^4}{2} dk = \\frac{V}{2\\pi^2} \\left[ \\frac{k^5}{5} \\right]_0^{k_F} = \\frac{V k_F^5}{10\\pi^2}\n$$\n最后，我们将 $k_F$ 的表达式用 $\\rho_0$ 表示并代入：\n$$\nT_s[\\rho_0] = \\frac{V}{10\\pi^2} \\left[ (3\\pi^2 \\rho_0)^{1/3} \\right]^5 = \\frac{V}{10\\pi^2} (3\\pi^2)^{5/3} \\rho_0^{5/3} = \\frac{3^{5/3}\\pi^{10/3}}{10\\pi^2} V \\rho_0^{5/3} = \\frac{3}{10}(3\\pi^2)^{2/3} V \\rho_0^{5/3}\n$$\n这就是对均匀密度求值的著名的托马斯-费米动能泛函。\n\n接下来，我们确定交换能 $E_x[\\rho_0]$。对于均匀电子气，由局域密度近似（LDA）给出的交换能是精确的。LDA交换能泛函由下式给出：\n$$\nE_x^{\\text{LDA}}[\\rho] = \\int e_x^{\\text{unif}}(\\rho(\\mathbf{r})) d^3\\mathbf{r}\n$$\n其中 $e_x^{\\text{unif}}(\\rho)$ 是密度为 $\\rho$ 的均匀、自旋非极化电子气的单位体积交换能。该量的标准表达式为：\n$$\ne_x^{\\text{unif}}(\\rho) = - C_x \\rho^{4/3}\n$$\n其中常数 $C_x$ 由下式给出：\n$$\nC_x = \\frac{3}{4} \\left(\\frac{3}{\\pi}\\right)^{1/3}\n$$\n对于所讨论的体系，密度是恒定的，$\\rho(\\mathbf{r}) = \\rho_0$。因此，交换能为：\n$$\nE_x[\\rho_0] = \\int -C_x \\rho_0^{4/3} d^3\\mathbf{r} = -C_x \\rho_0^{4/3} \\int d^3\\mathbf{r} = -C_x V \\rho_0^{4/3}\n$$\n代入 $C_x$ 的表达式：\n$$\nE_x[\\rho_0] = -\\frac{3}{4} \\left(\\frac{3}{\\pi}\\right)^{1/3} V \\rho_0^{4/3}\n$$\n这就是均匀电子气的精确交换能。\n\n我们按照要求将两个结果组合成一个单行矩阵。\n第一个元素是 $T_s[\\rho_0] = \\frac{3}{10}(3\\pi^2)^{2/3} V \\rho_0^{5/3}$。\n第二个元素是 $E_x[\\rho_0] = -\\frac{3}{4}(\\frac{3}{\\pi})^{1/3} V \\rho_0^{4/3}$。",
            "answer": "$$\n\\boxed{\\begin{pmatrix} \\frac{3}{10}(3\\pi^{2})^{2/3} V \\rho_{0}^{5/3}  - \\frac{3}{4} \\left(\\frac{3}{\\pi}\\right)^{1/3} V \\rho_{0}^{4/3} \\end{pmatrix}}\n$$"
        },
        {
            "introduction": "几乎所有近似的交换相关泛函都存在一个被称为“自相互作用误差”的根本性缺陷，即一个电子会与自身发生非物理性的相互作用。这项动手编程练习将通过最简单的单电子体系——氢原子，来量化这一误差。通过这个过程，你将对泛函的局限性有更具体的理解，并掌握评估其性能的基本方法。",
            "id": "2453879",
            "problem": "您需要编写一个完整的程序，在使用局域自旋密度近似 (LSDA) 交换泛函时，量化单个氢原子的自相互作用误差。所有计算均在 Hartree 原子单位下进行。对于单电子体系，自相互作用误差定义为经典 Hartree (静电) 能量与交换能之和。对于单电子密度，精确的 Kohn–Sham 交换会完全抵消 Hartree 能量，因此该和的任何残余值即为近似交换泛函的自相互作用误差。\n\n考虑氢原子的归一化基态电子密度，\n$$\nn(\\mathbf{r}) = \\frac{1}{\\pi} e^{-2 r},\n$$\n其中 $r = \\lvert \\mathbf{r} \\rvert$ 且 $n(\\mathbf{r})$ 对全空间积分为 1 个电子。\n\n使用以下第一性原理定义：\n\n- Hartree 能量，\n$$\nE_{\\mathrm{H}}[n] = \\frac{1}{2} \\int \\int \\frac{n(\\mathbf{r})\\,n(\\mathbf{r}^{\\prime})}{\\lvert \\mathbf{r} - \\mathbf{r}^{\\prime} \\rvert} \\, d^3 r \\, d^3 r^{\\prime}.\n$$\n\n- 局域自旋密度近似 (LSDA) 交换能，适用于自旋密度 $n_{\\uparrow}(\\mathbf{r})$ 和 $n_{\\downarrow}(\\mathbf{r})$，\n$$\nE_{x}^{\\mathrm{LSDA}}[n_{\\uparrow}, n_{\\downarrow}] = - C_{x} \\int \\left[n_{\\uparrow}(\\mathbf{r})^{4/3} + n_{\\downarrow}(\\mathbf{r})^{4/3}\\right] \\, d^3 r,\n$$\n其中\n$$\nC_{x} = \\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}.\n$$\n\n将自相互作用误差定义为\n$$\n\\mathrm{SIE} = E_{\\mathrm{H}}[n] + E_{x}^{\\mathrm{LSDA}}[n_{\\uparrow}, n_{\\downarrow}].\n$$\n\n对于单个电子，考虑以下两种自旋构型：\n- 完全自旋极化 (对于单个电子是物理上真实的构型)：$n_{\\uparrow}(\\mathbf{r}) = n(\\mathbf{r})$, $n_{\\downarrow}(\\mathbf{r}) = 0$。\n- 人为的自旋非极化 (用于灵敏度分析)：$n_{\\uparrow}(\\mathbf{r}) = n_{\\downarrow}(\\mathbf{r}) = \\tfrac{1}{2} n(\\mathbf{r})$。\n\n使用一个从 $r=0$ 延伸到有限截断半径 $R_{\\max}$、包含 $N_r$ 个点的径向格点，在三个测试案例中数值计算所需的积分。$N_r$ 和 $R_{\\max}$ 的值将为每个测试案例指定。所有能量必须以 Hartree 为单位表示，并报告为四舍五入到六位小数的浮点数。\n\n测试套件 (每个案例为一个三元组 $(N_r, R_{\\max}, \\text{spin})$，其中 spin 是字符串 \"polarized\" 或 \"unpolarized\")：\n1. $(8000, 20.0, \\text{\"polarized\"})$\n2. $(1000, 12.0, \\text{\"polarized\"})$\n3. $(2000, 8.0, \\text{\"unpolarized\"})$\n\n您的程序应为每个测试案例计算自相互作用误差 $\\mathrm{SIE}$，并生成单行输出，其中包含一个用方括号括起来的逗号分隔列表，结果的顺序与测试套件的顺序相同，例如，\n$$\n[\\mathrm{SIE}_1,\\mathrm{SIE}_2,\\mathrm{SIE}_3].\n$$\n所有三个数字都必须以 Hartree 为单位，并四舍五入到六位小数 (输出中不包含任何单位符号)。",
            "solution": "该问题要求使用局域自旋密度近似 (LSDA) 交换泛函计算单个氢原子的自相互作用误差 (SIE)。该体系在 Hartree 原子单位下定义。分析将针对两种自旋构型进行：完全自旋极化和人为的自旋非极化。\n\n首先，我们验证问题陈述的有效性。\n**已知条件：**\n- 氢原子基态的电子密度：$n(\\mathbf{r}) = \\frac{1}{\\pi} e^{-2 r}$，其中 $r = |\\mathbf{r}|$。\n- 自相互作用误差定义：$\\mathrm{SIE} = E_{\\mathrm{H}}[n] + E_{x}^{\\mathrm{LSDA}}[n_{\\uparrow}, n_{\\downarrow}]$。\n- Hartree 能量：$E_{\\mathrm{H}}[n] = \\frac{1}{2} \\int \\int \\frac{n(\\mathbf{r})\\,n(\\mathbf{r}^{\\prime})}{\\lvert \\mathbf{r} - \\mathbf{r}^{\\prime} \\rvert} \\, d^3 r \\, d^3 r^{\\prime}$。\n- LSDA 交换能：$E_{x}^{\\mathrm{LSDA}}[n_{\\uparrow}, n_{\\downarrow}] = - C_{x} \\int \\left[n_{\\uparrow}(\\mathbf{r})^{4/3} + n_{\\downarrow}(\\mathbf{r})^{4/3}\\right] \\, d^3 r$，其中常数 $C_{x} = \\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}$。\n- 自旋构型：\n    1. 自旋极化：$n_{\\uparrow}(\\mathbf{r}) = n(\\mathbf{r})$, $n_{\\downarrow}(\\mathbf{r}) = 0$。\n    2. 自旋非极化：$n_{\\uparrow}(\\mathbf{r}) = n_{\\downarrow}(\\mathbf{r}) = \\tfrac{1}{2} n(\\mathbf{r})$。\n- 三个测试案例的数值参数：$(N_r, R_{\\max}, \\text{spin})$。\n\n**有效性验证：**\n该问题具有科学依据，涉及密度泛函理论中的一个标准计算。所提供的电子密度、Hartree 能量和 LSDA 交换能的公式都是标准的。对于单电子体系，将自相互作用误差视为 Hartree 能量和近似交换能之和的概念是 DFT 泛函分析的基石。该问题提法恰当，为数值求解提供了所有必要信息。用于数值积分的参数是合理的。因此，该问题被认为是**有效的**。\n\n我们现在开始求解。计算需要评估两个能量分量：Hartree 能量 $E_{\\mathrm{H}}[n]$ 和 LSDA 交换能 $E_{x}^{\\mathrm{LSDA}}$。所有的积分将按照规定在径向格点上进行数值计算。\n\n**1. Hartree 能量, $E_{\\mathrm{H}}[n]$**\n\nHartree 能量代表电子密度云的经典静电自排斥。对于球对称密度 $n(r)$，该表达式可以简化。直接应用经典静电学中计算电荷分布能量的方法，通过逐层构建，可以得到总静电能为：\n$$\nE_{\\mathrm{H}} = \\int_0^\\infty \\frac{Q(r)}{r} \\, dq(r)\n$$\n其中 $dq(r) = n(r) 4\\pi r^2 dr$ 是半径为 $r$、厚度为 $dr$ 的球壳中的电子电荷，而 $Q(r) = \\int_0^r dq(r')$ 是半径为 $r$ 的球体内部包含的总电荷。这个公式正确地将每对相互作用计数一次，并避免了其他导致重复计算的公式中存在的 $\\frac{1}{2}$ 因子。\n\n对于给定的密度 $n(r) = \\frac{1}{\\pi}e^{-2r}$，内部包含的电荷 $Q(r)$ 为：\n$$\nQ(r) = \\int_0^r 4\\pi (r')^2 \\left(\\frac{1}{\\pi} e^{-2r'}\\right) dr' = 4 \\int_0^r (r')^2 e^{-2r'} dr' = 1 - (2r^2 + 2r + 1)e^{-2r}\n$$\n那么 Hartree 能量就是以下积分：\n$$\nE_{\\mathrm{H}}[n] = \\int_0^\\infty \\left[ \\frac{1 - (2r^2 + 2r + 1)e^{-2r}}{r} \\right] (4r^2 e^{-2r}) dr\n$$\n$$\nE_{\\mathrm{H}}[n] = \\int_0^\\infty \\left[ 4r e^{-2r} - 4r(2r^2 + 2r + 1) e^{-4r} \\right] dr\n$$\n对这个标准积分求值，得到精确的解析结果：\n$$\nE_{\\mathrm{H}}[n] = 1 - \\left(\\frac{3}{16} + \\frac{4}{16} + \\frac{4}{16}\\right) = 1 - \\frac{11}{16} = \\frac{5}{16} \\text{ Hartree}.\n$$\n这个精确值 $E_{\\mathrm{H}}[n] = 0.3125$ Hartree 可作为我们数值实现的参考。某些文献中的差异通常是由于定义不一致造成的。我们的推导是从第一性原理出发的。\n\n对于数值计算，我们首先使用累积梯形法则在径向格点上计算 $Q(r)$。然后，通过对被积函数 $4\\pi r n(r) Q(r)$ 应用梯形法则来计算 $E_{\\mathrm{H}}$。\n\n**2. LSDA 交换能, $E_{x}^{\\mathrm{LSDA}}$**\n\nLSDA 交换能积分必须针对两种指定的自旋构型进行评估。由于密度是球对称的，体积分可以简化为径向积分：\n$$\nE_{x}^{\\mathrm{LSDA}} = -C_x \\int_0^\\infty \\left[ n_{\\uparrow}(r)^{4/3} + n_{\\downarrow}(r)^{4/3} \\right] 4\\pi r^2 dr\n$$\n常数为 $C_x = \\frac{3}{4}\\left(\\frac{3}{\\pi}\\right)^{1/3}$。\n\n情况 1：完全自旋极化\n此时，$n_{\\uparrow}(r) = n(r)$ 且 $n_{\\downarrow}(r) = 0$。表达式简化为：\n$$\nE_{x}^{\\mathrm{LSDA, pol}} = -C_x \\int_0^\\infty n(r)^{4/3} 4\\pi r^2 dr\n$$\n需要进行数值积分的项是 $-C_x \\left(\\frac{1}{\\pi} e^{-2r}\\right)^{4/3} 4\\pi r^2$。\n\n情况 2：人为的自旋非极化\n此时，$n_{\\uparrow}(r) = n_{\\downarrow}(r) = \\frac{1}{2}n(r)$。密度项的和为：\n$$\nn_{\\uparrow}^{4/3} + n_{\\downarrow}^{4/3} = 2 \\left( \\frac{n(r)}{2} \\right)^{4/3} = 2^{1 - 4/3} n(r)^{4/3} = 2^{-1/3} n(r)^{4/3}\n$$\n那么交换能为：\n$$\nE_{x}^{\\mathrm{LSDA, unpol}} = -C_x \\cdot 2^{-1/3} \\int_0^\\infty n(r)^{4/3} 4\\pi r^2 dr\n$$\n这就是极化情况下的交换能乘以一个因子 $2^{-1/3}$。对 $n(r)^{4/3}$ 的相同数值积分可以被重用。\n\n**3. 总自相互作用误差, SIE**\n\n对于每个测试案例，SIE 是数值计算出的能量之和：\n$$\n\\mathrm{SIE} = E_{\\mathrm{H}}[n] + E_{x}^{\\mathrm{LSDA}}[n]\n$$\n程序将为测试套件中的每个元组 $(N_r, R_{\\max}, \\text{spin})$ 实现这些步骤，并报告结果。数值积分使用梯形法则进行，`numpy` 和 `scipy` 库提供了该功能。对于足够大的格点数 $N_r$，该方法可以提供精确的结果。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\nfrom scipy.integrate import cumulative_trapezoid\n\ndef solve():\n    \"\"\"\n    Computes the self-interaction error (SIE) for a Hydrogen atom\n    using the Local Spin-Density Approximation (LSDA) exchange functional.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    test_cases = [\n        # (N_r, R_max, spin_case)\n        (8000, 20.0, \"polarized\"),\n        (1000, 12.0, \"polarized\"),\n        (2000, 8.0, \"unpolarized\"),\n    ]\n\n    results = []\n    \n    # Constant C_x for LSDA exchange in Hartree atomic units\n    C_x = (3.0 / 4.0) * (3.0 / np.pi)**(1.0 / 3.0)\n\n    for Nr, R_max, spin_case in test_cases:\n        # 1. Set up the radial grid\n        # We use a linear grid. r=0 is handled carefully.\n        r = np.linspace(0, R_max, Nr)\n        \n        # 2. Define the electron density n(r) for Hydrogen atom\n        # n(r) = (1/pi) * exp(-2r)\n        n_r = (1.0 / np.pi) * np.exp(-2.0 * r)\n        \n        # 3. Calculate the Hartree Energy E_H[n]\n        # E_H = integral [Q(r)/r] dq(r) over all space\n        # where Q(r) is enclosed charge and dq(r) is charge in a shell.\n        # This is equivalent to E_H = integral_0^inf [4*pi*r*n(r)*Q(r)] dr\n        \n        # First, compute Q(r) = integral_0^r 4*pi*r'^2*n(r') dr'\n        # Integrand for Q(r)\n        q_integrand = 4.0 * np.pi * r**2 * n_r\n        \n        # Use cumulative trapezoid rule for accurate Q(r)\n        # cumulative_trapezoid returns a result for r[1:], so we prepend 0\n        Q_r = cumulative_trapezoid(q_integrand, r, initial=0.0)\n\n        # Now, compute the integrand for Hartree energy\n        eh_integrand = 4.0 * np.pi * r * n_r * Q_r\n        \n        # Integrate using the trapezoidal rule\n        E_H = np.trapz(eh_integrand, r)\n        \n        # 4. Calculate the LSDA Exchange Energy E_x^LSDA[n]\n        # E_x = -C_x * integral [n_up^(4/3) + n_down^(4/3)] d^3r\n        \n        # Common part of the integral: integral_0^inf n(r)^(4/3) * 4*pi*r^2 dr\n        n_43 = n_r**(4.0 / 3.0)\n        ex_integrand_base = n_43 * 4.0 * np.pi * r**2\n        integral_val = np.trapz(ex_integrand_base, r)\n        \n        if spin_case == \"polarized\":\n            # n_up = n, n_down = 0\n            # Sum of densities term is n^(4/3)\n            spin_factor = 1.0\n        elif spin_case == \"unpolarized\":\n            # n_up = n/2, n_down = n/2\n            # Sum becomes 2 * (n/2)^(4/3) = 2^(-1/3) * n^(4/3)\n            spin_factor = 2.0**(-1.0 / 3.0)\n        \n        E_x = -C_x * spin_factor * integral_val\n        \n        # 5. Calculate the Self-Interaction Error\n        SIE = E_H + E_x\n        \n        results.append(SIE)\n\n    # Format the final output as specified\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        },
        {
            "introduction": "在实际的 DFT 计算中，误差的来源是复杂的，区分不同类型的误差对于可靠的科学研究至关重要。本练习探讨了如何区分源于泛函形式本身的“泛函驱动误差”和源于泛函产生不正确电子密度的“密度驱动误差”。通过分析一个对 DFT 构成经典挑战的拉伸氢分子体系的假设数据，我们将学习如何诊断这些截然不同的误差来源。",
            "id": "2453913",
            "problem": "您将通过区分密度驱动误差和泛函驱动误差来分析密度泛函理论 (DFT) 计算中的误差来源。请使用以下基本原理：(i) Hohenberg–Kohn 定理指出，基态能量是基态电子密度的泛函，精确能量通过最小化此能量泛函相对于密度来获得；(ii) 在 Kohn–Sham (KS) 框架中，一个近似的交换相关泛函会产生一个近似的能量泛函，其自洽最小化器是一个近似密度；(iii) 有限的单电子基组会导致允许的密度和轨道的离散化，从而产生基组不完备性误差。考虑在拉伸键长 $R=3.0\\,\\mathrm{\\AA}$ 时 H$_2$ 的 Born–Oppenheimer 基态。\n\n您有以下一组计算。所有能量均以 Hartree 单位 ($E_{\\mathrm{h}}$) 给出，并且在适用时所有计算都是自旋非限制的。符号 $E_{\\mathrm{meth}}[n_{\\bullet}]$ 表示在密度 $n_{\\bullet}$ 上计算的“meth”方法的总能量。\n\n- 在一个非常大的基组中的近乎精确的参考值（例如，完备基组极限下的完全组态相互作用）：$E_{\\mathrm{ref}}=-1.000\\,E_{\\mathrm{h}}$。\n- 在一个非常大的基组中自洽计算的半局域广义梯度近似 (GGA)，特别是 Perdew–Burke–Ernzerhof (PBE)：$E_{\\mathrm{PBE}}[n_{\\mathrm{PBE}}]=-1.030\\,E_{\\mathrm{h}}$。\n- 在同一个非常大的基组中获得的非限制 Hartree–Fock (UHF) 密度上非自洽计算的 PBE 能量：$E_{\\mathrm{PBE}}[n_{\\mathrm{UHF}}]=-1.008\\,E_{\\mathrm{h}}$。\n- 在一个最小基组中自洽计算的全局杂化泛函（例如，PBE0）：$E_{\\mathrm{hyb}}[n_{\\mathrm{hyb}}]_{\\mathrm{min}}=-0.990\\,E_{\\mathrm{h}}$。\n- 在 UHF 密度上计算的相同杂化泛函能量，但 UHF 计算和杂化能量评估都限制在同一个最小基组中：$E_{\\mathrm{hyb}}[n_{\\mathrm{UHF}}]_{\\mathrm{min}}=-0.991\\,E_{\\mathrm{h}}$。\n\n用于解释的概念性提示：\n- 泛函驱动误差指的是即使在精确密度上评估近似泛函时仍会存在的误差（即，它源于泛函形式本身）。\n- 密度驱动误差指的是由于近似势导致近似自洽密度偏离精确密度而产生的额外误差；在实践中，可以通过在更高保真度的密度上评估时近似能量的变化程度来诊断它。\n- 基组不完备性会限制密度和能量的质量，可能掩盖或模仿其他误差来源。\n\n问题：根据上述数据和原理，哪些陈述是正确的？\n\nA. 在大基组中，从 $E_{\\mathrm{PBE}}[n_{\\mathrm{PBE}}]$ 到 $E_{\\mathrm{PBE}}[n_{\\mathrm{UHF}}]$ 的巨大变化表明，对于使用半局域泛函的拉伸 H$_2$ 分子，密度驱动误差是总误差的一个主要组成部分。\n\nB. $E_{\\mathrm{hyb}}[n_{\\mathrm{hyb}}]_{\\mathrm{min}}$ 和 $E_{\\mathrm{hyb}}[n_{\\mathrm{UHF}}]_{\\mathrm{min}}$ 的近似相等表明，在最小基组中，对于杂化泛函而言，基组不完备性误差主导了密度驱动误差。\n\nC. 在大基组中，$E_{\\mathrm{PBE}}[n_{\\mathrm{UHF}}]$ 和 $E_{\\mathrm{ref}}$ 之间的残余差距可归因于泛函驱动误差（例如，半局域形式中缺失的静态相关）。\n\nD. 因为近似能量泛函在其自身的自洽密度处达到最小值，Hohenberg–Kohn 变分原理确保用一个更好的密度（如 $n_{\\mathrm{UHF}}$）替换 $n_{\\mathrm{approx}}$ 不能减少相对于 $E_{\\mathrm{ref}}$ 的总误差。\n\nE. 在最小基组中，密度误差必须主导能量误差，因为基组限制了 $n(\\mathbf{r})$ 的变分空间，所以用 $n_{\\mathrm{UHF}}$ 替换 $n_{\\mathrm{hyb}}$ 必然会产生大的能量改善。",
            "solution": "首先将对问题陈述进行科学和逻辑上的有效性验证。\n\n**步骤 1：提取已知信息**\n\n该问题提供了关于在键长 $R=3.0\\,\\mathrm{\\AA}$ 处的 H$_2$ 基态的以下数据和概念定义：\n\n- **原理：**\n    1.  Hohenberg-Kohn (HK) 定理：基态能量 $E$ 是基态电子密度 $n(\\mathbf{r})$ 的泛函，$E=E[n]$，并且由精确的基态密度使其最小化。\n    2.  Kohn-Sham (KS) DFT：一个近似的交换相关泛函 $E_{xc}^{\\mathrm{approx}}[n]$ 导致一个近似的总能量泛函 $E^{\\mathrm{approx}}[n]$，其自洽最小化器是一个近似密度 $n_{\\mathrm{approx}}$。\n    3.  基组不完备性误差：一个有限的单电子基组离散化了允许的密度和轨道的空间。\n\n- **能量值 (以 Hartree, $E_{\\mathrm{h}}$ 为单位)：**\n    -   在一个非常大的基组中的近乎精确的参考能量：$E_{\\mathrm{ref}} = -1.000\\,E_{\\mathrm{h}}$。\n    -   在一个非常大的基组中的 PBE 自洽能量：$E_{\\mathrm{PBE}}[n_{\\mathrm{PBE}}] = -1.030\\,E_{\\mathrm{h}}$。\n    -   在同一个非常大的基组中，在 UHF 密度上计算的 PBE 能量：$E_{\\mathrm{PBE}}[n_{\\mathrm{UHF}}] = -1.008\\,E_{\\mathrm{h}}$。\n    -   在一个最小基组中的全局杂化自洽能量：$E_{\\mathrm{hyb}}[n_{\\mathrm{hyb}}]_{\\mathrm{min}} = -0.990\\,E_{\\mathrm{h}}$。\n    -   在同一个最小基组中，在 UHF 密度上计算的全局杂化能量：$E_{\\mathrm{hyb}}[n_{\\mathrm{UHF}}]_{\\mathrm{min}} = -0.991\\,E_{\\mathrm{h}}$。\n\n- **误差定义：**\n    -   **泛函驱动误差：** 当在精确密度上评估近似泛函时剩余的误差。\n    -   **密度驱动误差：** 由于近似自洽密度偏离精确密度而产生的额外误差。\n    -   **基组不完备性误差：** 使用有限基组所产生的误差。\n\n**步骤 2：使用提取的已知信息进行验证**\n\n根据验证标准对问题进行评估。\n\n-   **科学依据：** 该问题牢固地植根于密度泛函理论和量子化学的原理。拉伸 H$_2$ 的情景是一个典型的例子，用于说明半局域泛函因静态相关而失效，这是一个公认的概念。泛函驱动误差和密度驱动误差的定义是现代 DFT 文献中的标准。\n-   **问题明确：** 该问题提供了一组清晰的数值数据和定义，并要求基于这些信息评估几个陈述。问题的结构使其可以从所提供的数据中推导出一组明确的正确和错误答案。\n-   **客观性：** 语言是技术性的、精确的，并且没有主观性。\n-   **自洽与一致性：** 提供了所有必要的数据和定义。没有内部矛盾。例如，非自洽能量（$E_{\\mathrm{PBE}}[n_{\\mathrm{UHF}}]$ 和 $E_{\\mathrm{hyb}}[n_{\\mathrm{UHF}}]_{\\mathrm{min}}$）在变分上高于（负值更小）其自洽对应值（$E_{\\mathrm{PBE}}[n_{\\mathrm{PBE}}]$ 和 $E_{\\mathrm{hyb}}[n_{\\mathrm{hyb}}]_{\\mathrm{min}}$），这与应用于近似泛函的变分原理一致。这在所有情况下并非严格要求，但它的存在增加了问题的一致性。注意到我检查了 $E_{\\mathrm{hyb}}[n_{\\mathrm{UHF}}]_{\\mathrm{min}} = -0.991 E_{\\mathrm{h}}$，它低于 $E_{\\mathrm{hyb}}[n_{\\mathrm{hyb}}]_{\\mathrm{min}} = -0.990 E_{\\mathrm{h}}$。这表明存在一个问题。让我们重读一下。$E_{\\mathrm{hyb}}[n_{\\mathrm{hyb}}]_{\\mathrm{min}}=-0.990$，而 $E_{\\mathrm{hyb}}[n_{\\mathrm{UHF}}]_{\\mathrm{min}}=-0.991$。这意味着 $E_{\\mathrm{hyb}}[n_{\\mathrm{UHF}}]_{\\mathrm{min}}  E_{\\mathrm{hyb}}[n_{\\mathrm{hyb}}]_{\\mathrm{min}}$。这违反了近似泛函 $E_{\\mathrm{hyb}}$ 的变分原理。这是一个潜在的矛盾。然而，在实践中，数值噪音或收敛到非最小鞍点可能导致这种微小的表面上的违规。但更可能的是，这是问题陈述中的一个笔误，或者所用的 UHF 密度不是从与杂化计算相同的基组中获得的。让我检查一下措辞：“UHF 计算和杂化能量评估都限制在同一个最小基组中”。这证实了它们来自同一个基组。这个非常小的违规（$0.001\\,E_{\\mathrm{h}}$）处于可能被认为是数值伪影的边缘。然而，严格的解释会将其标记为不一致。这对问题的逻辑是致命的吗？选项中与此点相关的核心论点依赖于差异的*小量级*，而不是其符号。差异是 $|-0.990 - (-0.991)| = 0.001\\,E_{\\mathrm{h}}$，无论符号如何，这个值都很小。选项的逻辑仍然可以评估。鉴于这是一个概念性问题且量级很小，我将继续进行，但会注意这个轻微的不一致性。它不会使整个问题结构无效。\n\n**步骤 3：结论与行动**\n\n该问题被认为是**有效**的，可以进行分析。注意到所提供数据中关于杂化泛函的变分原理存在微小的不一致性，但这并不足以妨碍对选项进行逻辑评估，因为评估主要取决于能量差异的量级。\n\n**求解推导**\n\n一个近似 DFT 计算的总误差 $\\Delta E_{\\mathrm{tot}}$，可以分解为泛函驱动误差 $\\Delta E_F$ 和密度驱动误差 $\\Delta E_D$。\n$\\Delta E_{\\mathrm{tot}} = E_{\\mathrm{approx}}[n_{\\mathrm{approx}}] - E_{\\mathrm{exact}}[n_{\\mathrm{exact}}]$。\n分解如下：\n$$ \\Delta E_{\\mathrm{tot}} = \\underbrace{\\left( E_{\\mathrm{approx}}[n_{\\mathrm{approx}}] - E_{\\mathrm{approx}}[n_{\\mathrm{exact}}] \\right)}_{\\Delta E_D} + \\underbrace{\\left( E_{\\mathrm{approx}}[n_{\\mathrm{exact}}] - E_{\\mathrm{exact}}[n_{\\mathrm{exact}}] \\right)}_{\\Delta E_F} $$\n在实践中，$n_{\\mathrm{exact}}$ 是未知的。我们使用一个高质量的参考密度，这里用来自大基组的 $n_{\\mathrm{UHF}}$ 来近似，以估计这些分量。因此：\n$$ \\Delta E_D \\approx E_{\\mathrm{approx}}[n_{\\mathrm{approx}}] - E_{\\mathrm{approx}}[n_{\\mathrm{UHF}}] $$\n$$ \\Delta E_F \\approx E_{\\mathrm{approx}}[n_{\\mathrm{UHF}}] - E_{\\mathrm{ref}} $$\n\n**大基组中 PBE 的分析：**\n- 总误差：$\\Delta E_{\\mathrm{tot, PBE}} = E_{\\mathrm{PBE}}[n_{\\mathrm{PBE}}] - E_{\\mathrm{ref}} = -1.030 - (-1.000) = -0.030\\,E_{\\mathrm{h}}$。\n- 近似密度驱动误差：$\\Delta E_{D, \\mathrm{PBE}} \\approx E_{\\mathrm{PBE}}[n_{\\mathrm{PBE}}] - E_{\\mathrm{PBE}}[n_{\\mathrm{UHF}}] = -1.030 - (-1.008) = -0.022\\,E_{\\mathrm{h}}$。\n- 近似泛函驱动误差：$\\Delta E_{F, \\mathrm{PBE}} \\approx E_{\\mathrm{PBE}}[n_{\\mathrm{UHF}}] - E_{\\mathrm{ref}} = -1.008 - (-1.000) = -0.008\\,E_{\\mathrm{h}}$。\n\n这些近似分量的总和是 $(-0.022) + (-0.008) = -0.030\\,E_{\\mathrm{h}}$，与总误差相符。密度驱动误差的量级 $|-0.022| = 0.022\\,E_{\\mathrm{h}}$，与总误差的量级 $|-0.030| = 0.030\\,E_{\\mathrm{h}}$ 相比是相当大的。\n\n**最小基组中杂化泛函的分析：**\n- 最小基组内的近似密度驱动误差：$\\Delta E_{D, \\mathrm{hyb}} \\approx E_{\\mathrm{hyb}}[n_{\\mathrm{hyb}}]_{\\mathrm{min}} - E_{\\mathrm{hyb}}[n_{\\mathrm{UHF}}]_{\\mathrm{min}} = -0.990 - (-0.991) = +0.001\\,E_{\\mathrm{h}}$。\n这个误差分量的量级非常小，为 $0.001\\,E_{\\mathrm{h}}$。\n\n**逐项分析**\n\n**A. 在大基组中，从 $E_{\\mathrm{PBE}}[n_{\\mathrm{PBE}}]$ 到 $E_{\\mathrm{PBE}}[n_{\\mathrm{UHF}}]$ 的巨大变化表明，对于使用半局域泛函的拉伸 H$_2$ 分子，密度驱动误差是总误差的一个主要组成部分。**\n将自洽 PBE 密度替换为 UHF 密度后，能量变化为 $E_{\\mathrm{PBE}}[n_{\\mathrm{UHF}}] - E_{\\mathrm{PBE}}[n_{\\mathrm{PBE}}] = -1.008 - (-1.030) = +0.022\\,E_{\\mathrm{h}}$。这个变化估计了密度驱动误差的负值。其量级 $0.022\\,E_{\\mathrm{h}}$ 约占总误差量级（$0.030\\,E_{\\mathrm{h}}$）的 $73\\%$。这无疑是一个“主要组成部分”。这种物理情况是静态相关误差的特征，其中半局域泛函产生了一个定性上不正确、过度离域的密度，导致了大的密度驱动误差。\n**结论：正确。**\n\n**B. $E_{\\mathrm{hyb}}[n_{\\mathrm{hyb}}]_{\\mathrm{min}}$ 和 $E_{\\mathrm{hyb}}[n_{\\mathrm{UHF}}]_{\\mathrm{min}}$ 的近似相等表明，在最小基组中，对于杂化泛函而言，基组不完备性误差主导了密度驱动误差。**\n能量差异为 $|-0.990 - (-0.991)| = 0.001\\,E_{\\mathrm{h}}$。这个接近于零的变化意味着，*在此基组内*，从自洽密度切换到 UHF 密度的能量后果可以忽略不计。最小基组严重限制了电子密度的灵活性。它太小，无法表示 $n_{\\mathrm{hyb}}$ 和 $n_{\\mathrm{UHF}}$ 之间的显著差异。因此，计算中观察到的误差，即与精确能量的巨大偏差（$E_{\\mathrm{hyb}}[n_{\\mathrm{hyb}}]_{\\mathrm{min}} - E_{\\mathrm{ref}} = -0.990 - (-1.000) = +0.010\\,E_{\\mathrm{h}}$），不是由于*在允许空间内*选择了不良的密度，而是由于空间本身的不充分性。这种不充分性就是基组不完备性误差。该陈述准确地得出结论，即可观察到的微小密度驱动误差表明基组误差是主导因素。\n**结论：正确。**\n\n**C. 在大基组中，$E_{\\mathrm{PBE}}[n_{\\mathrm{UHF}}]$ 和 $E_{\\mathrm{ref}}$ 之间的残余差距可归因于泛函驱动误差（例如，半局域形式中缺失的静态相关）。**\n差距为 $E_{\\mathrm{PBE}}[n_{\\mathrm{UHF}}] - E_{\\mathrm{ref}} = -1.008 - (-1.000) = -0.008\\,E_{\\mathrm{h}}$。这个量代表了在更高保真度的密度 ($n_{\\mathrm{UHF}}$) 上评估 PBE 泛函时的误差，这是我们对泛函驱动误差的最佳代理。这个误差源于 PBE 泛函本身的内在数学形式，特别是即使提供了定性正确的密度，它也无法正确描述拉伸 H$_2$ 键的多参考性质（静态相关）。\n**结论：正确。**\n\n**D. 因为近似能量泛函在其自身的自洽密度处达到最小值，Hohenberg–Kohn 变分原理确保用一个更好的密度（如 $n_{\\mathrm{UHF}}$）替换 $n_{\\mathrm{approx}}$ 不能减少相对于 $E_{\\mathrm{ref}}$ 的总误差。**\n该陈述混淆了两个不同的变分原理。对于*近似*泛函 $E_{\\mathrm{approx}}[n]$ 的变分原理指出，对于任何其他密度 $n$，都有 $E_{\\mathrm{approx}}[n_{\\mathrm{approx}}] \\le E_{\\mathrm{approx}}[n]$。这对 PBE 是成立的：$E_{\\mathrm{PBE}}[n_{\\mathrm{PBE}}] = -1.030\\,E_{\\mathrm{h}}$ 确实低于 $E_{\\mathrm{PBE}}[n_{\\mathrm{UHF}}] = -1.008\\,E_{\\mathrm{h}}$。然而，Hohenberg-Kohn 变分原理适用于*精确*泛函，保证了 $E_{\\mathrm{exact}}[n] \\ge E_{\\mathrm{ref}}$。没有任何原理能保证 $E_{\\mathrm{approx}}[n_{\\mathrm{approx}}]$ 比 $E_{\\mathrm{approx}}[n_{\\text{other}}]$ 更接近 $E_{\\mathrm{ref}}$。数据明确地反驳了该陈述的结论。使用自洽密度的总误差为 $|-1.030 - (-1.000)| = 0.030\\,E_{\\mathrm{h}}$。使用 UHF 密度的总误差为 $|-1.008 - (-1.000)| = 0.008\\,E_{\\mathrm{h}}$。通过替换密度，误差*确实*减少了。\n**结论：不正确。**\n\n**E. 在最小基组中，密度误差必须主导能量误差，因为基组限制了 $n(\\mathbf{r})$ 的变分空间，所以用 $n_{\\mathrm{UHF}}$ 替换 $n_{\\mathrm{hyb}}$ 必然会产生大的能量改善。**\n该陈述包含谬误的推理和与数据相矛盾的结论。其前提，即限制变分空间会导致密度误差占主导地位，是错误的；实际上，它*抑制*了系统表达不同密度的能力，从而使得可观察到的密度驱动误差变小，如选项 B 的分析所示。其结论，即替换密度“必然会产生大的能量改善”，被数据事实性地证伪：能量变化为 $E_{\\mathrm{hyb}}[n_{\\mathrm{hyb}}]_{\\mathrm{min}} - E_{\\mathrm{hyb}}[n_{\\mathrm{UHF}}]_{\\mathrm{min}} = +0.001\\,E_{\\mathrm{h}}$，这是一个可以忽略不计的变化，而不是一个大的改善。\n**结论：不正确。**",
            "answer": "$$\\boxed{ABC}$$"
        }
    ]
}