{
    "hands_on_practices": [
        {
            "introduction": "To begin, we will ground our understanding by applying the Metropolis acceptance criterion to a clear-cut analytical problem. This exercise  involves a particle in a simple one-dimensional potential, allowing you to focus on the core calculation: determining the energy change between two states and plugging it into the acceptance probability formula. Mastering this fundamental skill is the first step toward building more complex simulations.",
            "id": "857524",
            "problem": "A one-dimensional classical particle is confined by a potential energy landscape described by the function:\n$$\nU(x) = \\frac{1}{2} \\alpha x^2 - \\gamma x\n$$\nwhere $\\alpha  0$ and $\\gamma  0$ are real constants. The system is in thermal equilibrium with a heat bath at a constant inverse temperature $\\beta = 1/(k_B T)$, where $k_B$ is the Boltzmann constant and $T$ is the temperature.\n\nThe equilibrium probability distribution of the particle's position $x$ is given by the canonical distribution, $\\pi(x) \\propto \\exp(-\\beta U(x))$. To simulate the particle's motion and sample from this distribution, the Metropolis algorithm is used. For a symmetric proposal distribution, the probability of accepting a proposed move from state $x$ to state $x'$ is given by:\n$$\nA(x'|x) = \\min\\left(1, \\exp\\left(-\\beta [U(x') - U(x)]\\right)\\right)\n$$\n\nSuppose the particle is initially located at the position corresponding to the minimum of the potential energy, $x_{min}$. A move is then proposed to the non-zero position, $x_0$, where the potential energy $U(x_0)$ is exactly zero.\n\nDerive the analytical expression for the Metropolis acceptance probability, $A(x_0|x_{min})$, for this specific move.",
            "solution": "1. The potential is \n$$\nU(x)=\\tfrac12\\alpha x^2-\\gamma x\\,. \n$$\n2. Find the minimum: \n$$\n\\frac{dU}{dx}=\\alpha x-\\gamma=0\\quad\\Rightarrow\\quad x_{\\min}=\\frac{\\gamma}{\\alpha}\\,. \n$$\n3. Evaluate $U$ at $x_{\\min}$:\n$$\nU(x_{\\min})\n=\\tfrac12\\alpha\\Bigl(\\frac{\\gamma}{\\alpha}\\Bigr)^2\n-\\gamma\\Bigl(\\frac{\\gamma}{\\alpha}\\Bigr)\n=\\frac{\\gamma^2}{2\\alpha}-\\frac{\\gamma^2}{\\alpha}\n=-\\frac{\\gamma^2}{2\\alpha}\\,. \n$$\n4. Solve $U(x_0)=0$ for nonzero $x_0$:\n$$\n\\tfrac12\\alpha x_0^2-\\gamma x_0=0\n\\;\\Rightarrow\\;\nx_0\\bigl(\\tfrac12\\alpha x_0-\\gamma\\bigr)=0\n\\;\\Rightarrow\\;\nx_0=\\frac{2\\gamma}{\\alpha}\\,. \n$$\n5. The Metropolis acceptance probability is\n$$\nA(x_0\\!\\mid x_{\\min})\n=\\min\\Bigl(1,\\exp\\bigl[-\\beta\\,(U(x_0)-U(x_{\\min}))\\bigr]\\Bigr)\\,. \n$$\n6. Compute the energy difference:\n$$\nU(x_0)-U(x_{\\min})\n=0-\\Bigl(-\\frac{\\gamma^2}{2\\alpha}\\Bigr)\n=\\frac{\\gamma^2}{2\\alpha}\\,. \n$$\n7. Hence \n$$\nA(x_0\\!\\mid x_{\\min})\n=\\exp\\!\\Bigl(-\\beta\\,\\frac{\\gamma^2}{2\\alpha}\\Bigr)\\,,\n$$\nsince this is less than 1 for $\\beta,\\gamma,\\alpha0$.",
            "answer": "$$\\boxed{\\exp\\!\\bigl(-\\beta\\tfrac{\\gamma^2}{2\\alpha}\\bigr)}$$"
        },
        {
            "introduction": "Moving from direct calculation to a critical conceptual insight, this next problem  explores a fundamental property of the Metropolis algorithm. By considering the effect of a constant offset in the potential energy, you will see why the simulation dynamics depend only on energy *differences*. This principle is not just a theoretical curiosity; it has profound practical implications for how we define energy models and interpret simulation results.",
            "id": "2465263",
            "problem": "In a canonical-ensemble Metropolis Monte Carlo simulation at temperature $T$, a potential energy function $E_{\\mathrm{calc}}(\\mathbf{x})$ is used to evaluate trial moves, where $\\mathbf{x}$ denotes the configuration. Suppose that due to a systematic modeling choice, the computed energy is shifted by a constant offset $C$ relative to the true potential energy $E_{\\mathrm{true}}(\\mathbf{x})$, so that $E_{\\mathrm{calc}}(\\mathbf{x}) = E_{\\mathrm{true}}(\\mathbf{x}) + C$ for all $\\mathbf{x}$. The proposal mechanism is symmetric, and the standard Metropolis acceptance criterion based on Boltzmann weights is employed. Which of the following statements are correct? Select all that apply.\n\nA. The acceptance decision probabilities and the equilibrium distribution over configurations are unchanged compared to using $E_{\\mathrm{true}}(\\mathbf{x})$; only the absolute values of reported potential energies are shifted by $C$.\n\nB. The acceptance probability for any proposed move is multiplied by $\\exp(-\\beta C)$, altering acceptance rates whenever $C \\neq 0$.\n\nC. The simulation samples the correct canonical ensemble but at an effective temperature $T' = T + C/k_{\\mathrm{B}}$.\n\nD. Detailed balance with respect to the Boltzmann distribution is violated unless the offset $C$ is subtracted before each acceptance test.\n\nE. The Helmholtz free energy on an absolute scale is shifted by $+C$ relative to the true absolute free energy, but free energy differences between states that share the same constant offset remain unchanged.",
            "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extract Givens**\n- Ensemble: Canonical-ensemble Metropolis Monte Carlo simulation.\n- Temperature: $T$.\n- Computed potential energy function: $E_{\\mathrm{calc}}(\\mathbf{x})$.\n- True potential energy function: $E_{\\mathrm{true}}(\\mathbf{x})$.\n- Relationship between energies: $E_{\\mathrm{calc}}(\\mathbf{x}) = E_{\\mathrm{true}}(\\mathbf{x}) + C$ for all configurations $\\mathbf{x}$, where $C$ is a constant offset.\n- Proposal mechanism: Symmetric.\n- Acceptance criterion: Standard Metropolis acceptance criterion based on Boltzmann weights.\n\n**Step 2: Validate Using Extracted Givens**\nThe problem is scientifically grounded, rooted in the fundamental principles of statistical mechanics and computational simulation (Metropolis algorithm, canonical ensemble, Boltzmann statistics). It is well-posed, providing all necessary information, such as the symmetric nature of the proposal mechanism and the use of the standard Metropolis criterion, to allow for a unique and unambiguous mathematical analysis. The language is objective and precise. The scenario described—a constant offset in a computed potential energy—is a realistic and common consideration in computational chemistry and physics, arising from choices in reference states or approximations in the theoretical model. The problem does not violate any principles of scientific or mathematical validity.\n\n**Step 3: Verdict and Action**\nThe problem is valid. A full solution will be derived.\n\nThe core of a Metropolis Monte Carlo simulation is the acceptance criterion, which ensures that the simulation samples configurations from a target probability distribution. For the canonical ensemble at temperature $T$, the probability of a configuration $\\mathbf{x}$ is given by the Boltzmann distribution:\n$$ \\pi(\\mathbf{x}) \\propto e^{-\\beta E(\\mathbf{x})} $$\nwhere $\\beta = 1/(k_{\\mathrm{B}}T)$, $k_{\\mathrm{B}}$ is the Boltzmann constant, and $E(\\mathbf{x})$ is the energy of the configuration.\n\nThe standard Metropolis acceptance probability for a trial move from an old configuration $\\mathbf{x}_{\\text{old}}$ to a new configuration $\\mathbf{x}_{\\text{new}}$ is given by:\n$$ p_{\\text{acc}}(\\mathbf{x}_{\\text{old}} \\to \\mathbf{x}_{\\text{new}}) = \\min\\left(1, \\frac{\\pi(\\mathbf{x}_{\\text{new}})}{\\pi(\\mathbf{x}_{\\text{old}})}\\right) $$\nThe ratio of probabilities is:\n$$ \\frac{\\pi(\\mathbf{x}_{\\text{new}})}{\\pi(\\mathbf{x}_{\\text{old}})} = \\frac{e^{-\\beta E(\\mathbf{x}_{\\text{new}})}}{e^{-\\beta E(\\mathbf{x}_{\\text{old}})}} = e^{-\\beta (E(\\mathbf{x}_{\\text{new}}) - E(\\mathbf{x}_{\\text{old}}))} = e^{-\\beta \\Delta E} $$\nIn this problem, the simulation uses the calculated energy $E_{\\mathrm{calc}}(\\mathbf{x}) = E_{\\mathrm{true}}(\\mathbf{x}) + C$. Let us compute the energy difference $\\Delta E_{\\mathrm{calc}}$ for a move:\n$$ \\Delta E_{\\mathrm{calc}} = E_{\\mathrm{calc}}(\\mathbf{x}_{\\text{new}}) - E_{\\mathrm{calc}}(\\mathbf{x}_{\\text{old}}) $$\n$$ \\Delta E_{\\mathrm{calc}} = (E_{\\mathrm{true}}(\\mathbf{x}_{\\text{new}}) + C) - (E_{\\mathrm{true}}(\\mathbf{x}_{\\text{old}}) + C) $$\n$$ \\Delta E_{\\mathrm{calc}} = E_{\\mathrm{true}}(\\mathbf{x}_{\\text{new}}) - E_{\\mathrm{true}}(\\mathbf{x}_{\\text{old}}) = \\Delta E_{\\mathrm{true}} $$\nThe energy difference is independent of the constant offset $C$. Consequently, the ratio of Boltzmann weights used in the acceptance test is also unchanged:\n$$ \\frac{\\pi_{\\text{calc}}(\\mathbf{x}_{\\text{new}})}{\\pi_{\\text{calc}}(\\mathbf{x}_{\\text{old}})} = e^{-\\beta \\Delta E_{\\mathrm{calc}}} = e^{-\\beta \\Delta E_{\\mathrm{true}}} = \\frac{\\pi_{\\text{true}}(\\mathbf{x}_{\\text{new}})}{\\pi_{\\text{true}}(\\mathbf{x}_{\\text{old}})} $$\nThis fundamental result dictates the answers to most of the options.\n\n**Option-by-Option Analysis**\n\n**A. The acceptance decision probabilities and the equilibrium distribution over configurations are unchanged compared to using $E_{\\mathrm{true}}(\\mathbf{x})$; only the absolute values of reported potential energies are shifted by $C$.**\nAs derived above, the ratio of Boltzmann weights is identical whether one uses $E_{\\mathrm{calc}}$ or $E_{\\mathrm{true}}$. Therefore, the acceptance probability, $p_{\\text{acc}} = \\min(1, e^{-\\beta \\Delta E_{\\text{calc}}})$, is absolutely unchanged for any proposed move. Since the transition probabilities of the Markov chain are unchanged, the stationary (equilibrium) distribution it converges to is also unchanged. This equilibrium distribution is the relative population of configurations, which depends only on energy differences. The absolute values of reported energies are based on $E_{\\mathrm{calc}}(\\mathbf{x})$, which by definition are shifted by $C$ relative to $E_{\\mathrm{true}}(\\mathbf{x})$. This statement is a precise and complete description of the situation.\n**Verdict: Correct**\n\n**B. The acceptance probability for any proposed move is multiplied by $\\exp(-\\beta C)$, altering acceptance rates whenever $C \\neq 0$.**\nThis is incorrect. As shown in the general derivation, the change in energy $\\Delta E_{\\mathrm{calc}}$ equals $\\Delta E_{\\mathrm{true}}$. The constant $C$ cancels out of the difference. The acceptance probability depends on $\\Delta E$, not the absolute energies. Therefore, the acceptance probability is not multiplied by any factor and remains unchanged.\n**Verdict: Incorrect**\n\n**C. The simulation samples the correct canonical ensemble but at an effective temperature $T' = T + C/k_{\\mathrm{B}}$.**\nThe simulation samples a distribution proportional to $e^{-\\beta E_{\\mathrm{calc}}(\\mathbf{x})}$.\n$$ e^{-\\beta E_{\\mathrm{calc}}(\\mathbf{x})} = e^{- (E_{\\mathrm{true}}(\\mathbf{x}) + C) / (k_{\\mathrm{B}}T)} = e^{-C/(k_{\\mathrm{B}}T)} e^{-E_{\\mathrm{true}}(\\mathbf{x}) / (k_{\\mathrm{B}}T)} $$\nSince $e^{-C/(k_{\\mathrm{B}}T)}$ is a constant factor, the sampled distribution is proportional to $e^{-E_{\\mathrm{true}}(\\mathbf{x}) / (k_{\\mathrm{B}}T)}$. This is the Boltzmann distribution for the true energy $E_{\\mathrm{true}}$ at the original temperature $T$. The simulation is not sampling at an effective temperature $T'$; it is sampling the correct ensemble at the correct temperature $T$.\n**Verdict: Incorrect**\n\n**D. Detailed balance with respect to the Boltzmann distribution is violated unless the offset $C$ is subtracted before each acceptance test.**\nThe Metropolis-Hastings algorithm is constructed to satisfy the detailed balance condition with respect to the target distribution $\\pi(\\mathbf{x})$. For a symmetric proposal mechanism, the condition is $\\pi(\\mathbf{x}_{\\text{old}}) p_{\\text{acc}}(\\mathbf{x}_{\\text{old}} \\to \\mathbf{x}_{\\text{new}}) = \\pi(\\mathbf{x}_{\\text{new}}) p_{\\text{acc}}(\\mathbf{x}_{\\text{new}} \\to \\mathbf{x}_{\\text{old}})$.\nThe simulation uses the target distribution $\\pi_{\\text{calc}}(\\mathbf{x}) \\propto e^{-\\beta E_{\\mathrm{calc}}(\\mathbf{x})}$. Detailed balance is satisfied for this distribution by construction. As shown in the analysis for option C, $\\pi_{\\text{calc}}(\\mathbf{x})$ is proportional to $\\pi_{\\text{true}}(\\mathbf{x}) \\propto e^{-\\beta E_{\\mathrm{true}}(\\mathbf{x})}$. So, $\\pi_{\\text{calc}}(\\mathbf{x}) = (\\text{constant}) \\times \\pi_{\\text{true}}(\\mathbf{x})$. Since the distributions are the same up to a normalization constant, satisfying detailed balance for one implies satisfying it for the other. Detailed balance with respect to the correct physical Boltzmann distribution (based on $E_{\\mathrm{true}}$) is maintained. No modification is necessary.\n**Verdict: Incorrect**\n\n**E. The Helmholtz free energy on an absolute scale is shifted by $+C$ relative to the true absolute free energy, but free energy differences between states that share the same constant offset remain unchanged.**\nThe Helmholtz free energy $F$ is defined through the canonical partition function $Z$ as $F = -k_{\\mathrm{B}}T \\ln Z$. The partition function is the sum of Boltzmann factors over all configurations: $Z = \\int e^{-\\beta E(\\mathbf{x})} d\\mathbf{x}$.\n\nThe \"true\" partition function is $Z_{\\text{true}} = \\int e^{-\\beta E_{\\text{true}}(\\mathbf{x})} d\\mathbf{x}$, leading to a free energy $F_{\\text{true}} = -k_{\\mathrm{B}}T \\ln Z_{\\text{true}}$.\n\nThe partition function corresponding to the calculated energy $E_{\\mathrm{calc}}$ is:\n$$ Z_{\\text{calc}} = \\int e^{-\\beta E_{\\mathrm{calc}}(\\mathbf{x})} d\\mathbf{x} = \\int e^{-\\beta (E_{\\text{true}}(\\mathbf{x}) + C)} d\\mathbf{x} $$\n$$ Z_{\\text{calc}} = \\int e^{-\\beta E_{\\text{true}}(\\mathbf{x})} e^{-\\beta C} d\\mathbf{x} = e^{-\\beta C} \\int e^{-\\beta E_{\\text{true}}(\\mathbf{x})} d\\mathbf{x} = e^{-\\beta C} Z_{\\text{true}} $$\nThe calculated free energy is therefore:\n$$ F_{\\text{calc}} = -k_{\\mathrm{B}}T \\ln Z_{\\text{calc}} = -k_{\\mathrm{B}}T \\ln(e^{-\\beta C} Z_{\\text{true}}) $$\n$$ F_{\\text{calc}} = -k_{\\mathrm{B}}T (\\ln(e^{-\\beta C}) + \\ln Z_{\\text{true}}) = -k_{\\mathrm{B}}T (-\\beta C + \\ln Z_{\\text{true}}) $$\n$$ F_{\\text{calc}} = (-k_{\\mathrm{B}}T)(-\\frac{C}{k_{\\mathrm{B}}T}) + (-k_{\\mathrm{B}}T \\ln Z_{\\text{true}}) = C + F_{\\text{true}} $$\nThis demonstrates that the absolute free energy is shifted by $+C$.\n\nNow, consider the free energy difference $\\Delta F$ between two systems (or thermodynamic states), say system $1$ and system $2$, where for both the same energy offset $C$ applies.\n$$ \\Delta F_{\\text{calc}} = F_{\\text{calc},2} - F_{\\text{calc},1} = (F_{\\text{true},2} + C) - (F_{\\text{true},1} + C) = F_{\\text{true},2} - F_{\\text{true},1} = \\Delta F_{\\text{true}} $$\nThe free energy difference remains unchanged. Both parts of the statement are mathematically correct.\n**Verdict: Correct**",
            "answer": "$$\\boxed{AE}$$"
        },
        {
            "introduction": "In this final practice, we transition from theory and concepts to hands-on implementation. You are tasked with writing a small program  to simulate a particle in a Coulomb-like potential using the Metropolis algorithm. This exercise will solidify your understanding by showing you how theoretical parameters like temperature and proposal step size directly translate into observable outcomes, such as the acceptance rate, in a dynamic simulation.",
            "id": "2465276",
            "problem": "Consider a single-particle radial model in reduced, dimensionless units where the potential energy is given by $U(r)=-\\dfrac{1}{r}$ for $r>0$. Let the absolute temperature be $T>0$, with Boltzmann constant set to $k_{\\mathrm{B}}=1$, so that $\\beta=\\dfrac{1}{T}$. A proposed move from a current radius $r$ to a new radius $r^{\\prime}$ is accepted according to the Metropolis acceptance criterion with probability\n$$\nA\\left(r\\to r^{\\prime}\\right)=\\min\\left(1,\\exp\\left[-\\beta\\left(U(r^{\\prime})-U(r)\\right)\\right]\\right).\n$$\nYou will generate a sequence of radii by attempting outward-only proposals. At each attempt, draw an independent displacement $s$ from the uniform distribution on $[0,\\Delta]$ and set the proposal to $r^{\\prime}=r+s$. If the proposal is accepted, update $r\\leftarrow r^{\\prime}$; otherwise keep $r$ unchanged. Starting from an initial radius $r_{0}>0$, perform exactly $N$ proposal attempts and report the acceptance rate defined as the total number of accepted proposals divided by $N$. All quantities are dimensionless, and no physical units are required.\n\nImplement this protocol for the following test suite of parameter tuples $(T,\\Delta,r_{0},N,\\text{seed})$, where “seed” specifies the integer seed for the pseudorandom number generator to ensure reproducibility. For each tuple, return the acceptance rate as a floating-point number.\n\n- Test $1$: $(T,\\Delta,r_{0},N,\\text{seed})=\\left(0.5,\\,0.2,\\,0.5,\\,100000,\\,12345\\right)$.\n- Test $2$: $(T,\\Delta,r_{0},N,\\text{seed})=\\left(2.0,\\,0.5,\\,1.0,\\,100000,\\,54321\\right)$.\n- Test $3$: $(T,\\Delta,r_{0},N,\\text{seed})=\\left(0.05,\\,0.2,\\,1.0,\\,100000,\\,202311\\right)$.\n- Test $4$: $(T,\\Delta,r_{0},N,\\text{seed})=\\left(0.5,\\,0.05,\\,10.0,\\,100000,\\,8080\\right)$.\n\nYour program should produce a single line of output containing the results as a comma-separated list enclosed in square brackets (for example, $[x_{1},x_{2},x_{3},x_{4}]$), where each $x_{i}$ is the acceptance rate for test $i$ rounded to exactly six decimal places.",
            "solution": "The problem statement is subjected to validation.\n\n**Step 1: Extracted Givens**\n- **System Model:** A single particle in a one-dimensional radial coordinate system with dimensionless units.\n- **Potential Energy Function:** $U(r) = -\\dfrac{1}{r}$ for a radius $r > 0$.\n- **Thermodynamic Parameters:** Absolute temperature $T > 0$ and Boltzmann constant $k_{\\mathrm{B}} = 1$. The inverse temperature is $\\beta = \\dfrac{1}{T}$.\n- **Metropolis Acceptance Criterion:** The probability of accepting a move from a state with radius $r$ to a state with radius $r^{\\prime}$ is given by $A\\left(r \\to r^{\\prime}\\right) = \\min\\left(1, \\exp\\left[-\\beta\\left(U(r^{\\prime}) - U(r)\\right)\\right]\\right)$.\n- **Proposal Generation:** A new radius $r^{\\prime}$ is proposed from a current radius $r$ by the rule $r^{\\prime} = r + s$, where the displacement $s$ is an independent random variable drawn from the uniform distribution on the interval $[0, \\Delta]$. This specifies an \"outward-only\" move.\n- **State Update Rule:** If a proposed move is accepted, the system's state is updated, $r \\leftarrow r^{\\prime}$. If rejected, the state remains unchanged.\n- **Simulation Protocol:** Starting from an initial radius $r_0 > 0$, exactly $N$ proposal attempts are performed.\n- **Output Metric:** The acceptance rate, defined as the total number of accepted proposals divided by the total number of proposal attempts, $N$.\n- **Specific Test Cases:** A set of four parameter tuples $(T, \\Delta, r_0, N, \\text{seed})$ are provided for testing:\n    - Test $1$: $(0.5, 0.2, 0.5, 100000, 12345)$\n    - Test $2$: $(2.0, 0.5, 1.0, 100000, 54321)$\n    - Test $3$: $(0.05, 0.2, 1.0, 100000, 202311)$\n    - Test $4$: $(0.5, 0.05, 10.0, 100000, 8080)$\n\n**Step 2: Validation Using Extracted Givens**\n- **Scientific Grounding:** The problem is firmly grounded in the principles of statistical mechanics and computational physics. The potential $U(r) = -1/r$ is a standard form (e.g., Coulomb or gravitational potential in suitable units). The Metropolis algorithm is a canonical method for Markov Chain Monte Carlo (MCMC) simulation and is a fundamental technique in the field. The setup is scientifically rigorous and conventional.\n- **Well-Posedness:** The problem is unambiguously defined. All parameters, initial conditions, and the algorithm for state propagation are explicitly specified. The use of a fixed seed for the pseudorandom number generator ensures that the simulation is deterministic and yields a single, unique result for each test case. The desired output metric is also clearly defined.\n- **Objectivity:** The problem is stated using precise mathematical and algorithmic language, free of any subjective or opinion-based content.\n\n**Step 3: Verdict and Action**\nThe problem is found to be scientifically grounded, well-posed, objective, and internally consistent. It is therefore **valid**. A solution will be constructed based on direct simulation as described.\n\nThe task is to compute the acceptance rate of a specific Metropolis Monte Carlo simulation protocol. This is a direct application of the algorithm described. The simulation generates a sequence of states (radii) for a particle in a given potential field, forming a Markov chain.\n\nThe core of the algorithm is the Metropolis acceptance criterion. A move from a configuration with radius $r$ to a proposed configuration with radius $r^{\\prime}$ incurs a change in potential energy, $\\Delta U = U(r^{\\prime}) - U(r)$. The move is accepted with probability $A(r \\to r^{\\prime})$.\n\nThe algorithmic procedure for each test case is as follows:\n$1$. Initialize the system. Set the current radius $r_{current} \\leftarrow r_0$, the number of accepted moves $N_{accept} \\leftarrow 0$, and the inverse temperature $\\beta \\leftarrow 1/T$. Seed a pseudorandom number generator with the given integer seed.\n\n$2$. Perform a loop for $N$ iterations, representing the total number of proposal attempts. In each iteration $i$ from $1$ to $N$:\n    a. **Propose a new state:** Generate a random displacement $s$ from the uniform distribution $U(0, \\Delta)$. Calculate the proposed new radius $r_{proposal} = r_{current} + s$. Since $s \\ge 0$, this is always an outward move, so $r_{proposal} \\ge r_{current}$.\n    \n    b. **Calculate the energy change:** The change in potential energy is $\\Delta U = U(r_{proposal}) - U(r_{current})$. Substituting the given potential function $U(r) = -1/r$, we obtain:\n    $$\n    \\Delta U = \\left(-\\frac{1}{r_{proposal}}\\right) - \\left(-\\frac{1}{r_{current}}\\right) = \\frac{1}{r_{current}} - \\frac{1}{r_{proposal}}\n    $$\n    Since $r_{proposal} \\ge r_{current} > 0$, it follows that $1/r_{current} \\ge 1/r_{proposal}$, which ensures that $\\Delta U \\ge 0$.\n\n    c. **Calculate the acceptance probability:** The probability is given by the Metropolis function:\n    $$\n    A = \\min\\left(1, \\exp(-\\beta \\Delta U)\\right)\n    $$\n    Because $\\beta = 1/T > 0$ and we have established that $\\Delta U \\ge 0$ for this specific proposal scheme, the argument of the exponential, $-\\beta \\Delta U$, is always non-positive. Consequently, $\\exp(-\\beta \\Delta U)$ is always in the range $(0, 1]$, and the acceptance probability simplifies to $A = \\exp(-\\beta \\Delta U)$. However, for full generality and strict adherence to the problem's formula, the `min` function will be retained in the implementation.\n\n    d. **Accept or reject the move:** Generate a random number $u$ from the uniform distribution $U(0, 1)$. If $u  A$, the move is accepted. In this case, update the system's state by setting $r_{current} \\leftarrow r_{proposal}$ and increment the acceptance counter, $N_{accept} \\leftarrow N_{accept} + 1$. If $u \\ge A$, the move is rejected, and the system state $r_{current}$ remains unchanged.\n\n$3$. After $N$ iterations are complete, the final acceptance rate is computed as the ratio of the total number of accepted moves to the total number of attempts:\n$$\n\\text{Acceptance Rate} = \\frac{N_{accept}}{N}\n$$\n\nThis procedure is deterministic for a given set of parameters $(T, \\Delta, r_0, N, \\text{seed})$. It will be implemented for each of the four specified test cases to produce the required results.",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the problem of calculating the Metropolis acceptance rate for a set of test cases.\n    \"\"\"\n    # Define the test cases from the problem statement.\n    # Each tuple is (T, Delta, r_0, N, seed).\n    test_cases = [\n        (0.5, 0.2, 0.5, 100000, 12345),\n        (2.0, 0.5, 1.0, 100000, 54321),\n        (0.05, 0.2, 1.0, 100000, 202311),\n        (0.5, 0.05, 10.0, 100000, 8080),\n    ]\n\n    results = []\n    \n    # The potential energy function U(r) = -1/r\n    def U(r):\n        return -1.0 / r\n\n    for case in test_cases:\n        # Unpack parameters for the current test case\n        T, Delta, r0, N, seed = case\n        \n        # Initialize simulation variables\n        beta = 1.0 / T\n        r_current = float(r0)\n        accepted_count = 0\n        \n        # Initialize the random number generator with the specified seed for reproducibility\n        rng = np.random.default_rng(seed)\n        \n        # Perform N proposal attempts\n        for _ in range(N):\n            # 1. Propose a new state (outward-only move)\n            s = rng.uniform(0.0, Delta)\n            r_proposal = r_current + s\n            \n            # 2. Calculate the change in potential energy\n            delta_U = U(r_proposal) - U(r_current)\n            \n            # 3. Calculate the acceptance probability according to the Metropolis criterion.\n            # Since delta_U is always >= 0 for this proposal scheme, exp(-beta * delta_U) = 1.\n            # The min(1, ...) is technically redundant but included for strict adherence to the formula.\n            acceptance_prob = min(1.0, np.exp(-beta * delta_U))\n            \n            # 4. Accept or reject the move\n            if rng.random()  acceptance_prob:\n                # Accept the move\n                r_current = r_proposal\n                accepted_count += 1\n            # Else, reject the move (r_current remains unchanged)\n            \n        # Calculate the final acceptance rate for this test case\n        acceptance_rate = accepted_count / N\n        results.append(acceptance_rate)\n\n    # Format the results as a comma-separated list of numbers rounded to 6 decimal places,\n    # enclosed in square brackets.\n    formatted_results = [f\"{res:.6f}\" for res in results]\n    print(f\"[{','.join(formatted_results)}]\")\n\nsolve()\n```"
        }
    ]
}