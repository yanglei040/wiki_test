{
    "hands_on_practices": [
        {
            "introduction": "泊松-玻尔兹曼 (Poisson-Boltzmann, PB) 方程是描述溶剂化体系中静电相互作用的基石。然而，除了最简单的情形，我们无法直接得到其解析解，因此必须依赖数值方法。这个练习将指导你使用有限差分法，在一个简化的二维网格上求解线性化的PB方程，从而让你直观地理解连续介质静电求解器是如何从电荷源和边界条件出发，计算出整个体系的电势分布的。通过亲手实现这一过程，你将揭开PB求解器这个“黑箱”的神秘面纱 。",
            "id": "2456114",
            "problem": "您需要构建一个完全指定、自洽的计算模型，该模型使用有限差分方法离散化，在二维方形晶格上演示线性化 Poisson–Boltzmann (PB) 方程的求解过程。该模型必须计算约化静电势，即由热能和基本电荷归一化的静电势。因此，该势是无量纲的。数学问题描述如下。\n\n设 $\\phi(x,y)$ 为满足二维线性化 Poisson–Boltzmann 方程的约化静电势\n$$\n\\frac{\\partial^2 \\phi}{\\partial x^2} + \\frac{\\partial^2 \\phi}{\\partial y^2} - \\kappa^2 \\phi = -\\sigma(x,y),\n$$\n在一个方形域上，该域被离散化为一个具有晶格间距 $h$ 和 $N \\times N$ 个节点的均匀网格，并在边界节点上施加齐次 Dirichlet 边界条件 $\\phi=0$。此处，$\\kappa \\ge 0$ 是逆屏蔽长度（单位为长度的倒数），而 $\\sigma(x,y)$ 是给定的无量纲源密度。网格节点由整数索引 $(i,j)$ 标记，其中 $0 \\le i,j \\le N-1$，其物理坐标为 $(x_i,y_j) = (i h, j h)$。离散源 $\\sigma_{i,j}$ 的定义为：一个积分强度为 $A$ 的点源集中在节点 $(i_0,j_0)$ 时，表示为 $\\sigma_{i_0,j_0} = A / h^2$，而在其他地方 $\\sigma_{i,j} = 0$，这确保了离散积分源等于 $A$。\n\n对于下文指定的每个测试用例，计算满足上述方程对应的离散有限差分方程及所述边界条件的稳态解 $\\phi_{i,j}$。然后，对于每个测试用例，将指定探针节点处的电势值以单个浮点数的形式报告。所有报告值都是无量纲的，没有物理单位。本问题不涉及角度。\n\n测试套件（每一项都是一个完整的参数集）：\n\n- 测试用例 1（无屏蔽，单源）：\n  - 网格尺寸：$N=21$。\n  - 晶格间距：$h=1$。\n  - 逆屏蔽长度：$\\kappa=0$。\n  - 源：一个源，积分强度 $A=1$，位于节点 $(i_0,j_0)=(10,10)$。\n  - 边界条件：在所有边界节点上 $\\phi=0$。\n  - 本用例所需输出：节点 $(10,10)$ 处的 $\\phi$ 值。\n\n- 测试用例 2（有屏蔽，单源）：\n  - 网格尺寸：$N=21$。\n  - 晶格间距：$h=1$。\n  - 逆屏蔽长度：$\\kappa=0.5$。\n  - 源：一个源，积分强度 $A=1$，位于节点 $(i_0,j_0)=(10,10)$。\n  - 边界条件：在所有边界节点上 $\\phi=0$。\n  - 本用例所需输出：节点 $(10,10)$ 处的 $\\phi$ 值。\n\n- 测试用例 3（有屏蔽，类偶极子对）：\n  - 网格尺寸：$N=21$。\n  - 晶格间距：$h=1$。\n  - 逆屏蔽长度：$\\kappa=0.5$。\n  - 源：两个源，积分强度分别为 $A=+1$ (位于 $(i_1,j_1)=(8,10)$) 和 $A=-1$ (位于 $(i_2,j_2)=(12,10)$)。\n  - 边界条件：在所有边界节点上 $\\phi=0$。\n  - 本用例所需输出：节点 $(10,10)$ 处的 $\\phi$ 值。\n\n最终输出格式要求：您的程序必须生成一行包含三个结果的文本，按测试用例 1、2、3 的顺序，以方括号括起来的逗号分隔列表形式呈现。每个数字必须四舍五入到 6 位小数。例如，输出格式必须与 $[r_1,r_2,r_3]$ 完全一样，其中 $r_1$、$r_2$ 和 $r_3$ 是三个四舍五入到 6 位小数的浮点数结果。所有输出都是无量纲的，没有单位。",
            "solution": "所给问题要求在均匀方形网格上数值求解二维线性化 Poisson-Boltzmann 方程。无量纲静电势 $\\phi(x,y)$ 的控制偏微分方程 (PDE) 如下所示\n$$\n\\frac{\\partial^2 \\phi}{\\partial x^2} + \\frac{\\partial^2 \\phi}{\\partial y^2} - \\kappa^2 \\phi = -\\sigma(x,y)\n$$\n其中 $\\kappa$ 是逆 Debye 屏蔽长度，$\\sigma(x,y)$ 是表示电荷分布的源密度函数。求解域为一个具有 $N \\times N$ 个节点、间距为 $h$ 的方形晶格，并在网格的边界上施加齐次 Dirichlet 边界条件 ($\\phi=0$)。\n\n我们将使用有限差分法求得该解，该方法将连续的偏微分方程转换为一个线性代数方程组。我们使用二阶中心差分近似在每个内部网格节点 $(i,j)$ 处对拉普拉斯算子 $\\nabla^2 = \\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2}$ 进行离散化。节点 $(i,j)$ 的坐标为 $(x_i, y_j) = (ih, jh)$，其中 $i,j \\in \\{0, 1, \\dots, N-1\\}$。该节点的离散势记为 $\\phi_{i,j}$。二阶偏导数的近似式为：\n$$\n\\frac{\\partial^2 \\phi}{\\partial x^2}\\bigg|_{(i,j)} \\approx \\frac{\\phi_{i+1,j} - 2\\phi_{i,j} + \\phi_{i-1,j}}{h^2}\n$$\n$$\n\\frac{\\partial^2 \\phi}{\\partial y^2}\\bigg|_{(i,j)} \\approx \\frac{\\phi_{i,j+1} - 2\\phi_{i,j} + \\phi_{i,j-1}}{h^2}\n$$\n将这些表达式代入原始的偏微分方程，得到每个内部节点（其中 $i,j \\in \\{1, \\dots, N-2\\}$）的离散方程：\n$$\n\\frac{\\phi_{i+1,j} - 2\\phi_{i,j} + \\phi_{i-1,j}}{h^2} + \\frac{\\phi_{i,j+1} - 2\\phi_{i,j} + \\phi_{i,j-1}}{h^2} - \\kappa^2 \\phi_{i,j} = -\\sigma_{i,j}\n$$\n其中 $\\sigma_{i,j}$ 是节点 $(i,j)$ 处的离散源密度。两边同乘 $h^2$ 并重新整理各项，将未知数 $\\phi_{i,j}$ 归到等式左侧，我们得到五点差分格式：\n$$\n(4 + h^2 \\kappa^2) \\phi_{i,j} - \\phi_{i-1,j} - \\phi_{i+1,j} - \\phi_{i,j-1} - \\phi_{i,j+1} = h^2 \\sigma_{i,j}\n$$\n边界条件规定，如果 $i=0$、$i=N-1$、$j=0$ 或 $j=N-1$，则 $\\phi_{i,j}=0$。这些值是已知的，不构成方程组中的未知数。所有 $(N-2) \\times (N-2)$ 个内部节点的方程集合构成一个形如 $M \\mathbf{\\Phi} = \\mathbf{b}$ 的线性方程组。\n\n为了构建该方程组，需要将未知势 $\\phi_{i,j}$（其中 $i,j \\in \\{1, \\dots, N-2\\}$）的二维网格映射到一个一维向量 $\\mathbf{\\Phi}$。我们采用行主序索引方案，其中二维索引对 $(i,j)$ 映射到一维索引 $k = (i-1)(N-2) + (j-1)$。该系统的维度为 $D = (N-2)^2$。\n\n矩阵 $M$ 是一个 $D \\times D$ 的方阵。对于对应于节点 $(i,j)$ 的方程（矩阵中的第 $k$ 行），其系数为：\n-   对角元素，对应于 $\\phi_{i,j}$ 本身，为 $M_{k,k} = 4 + h^2 \\kappa^2$。\n-   非对角元素，对应于四个相邻节点，均为 $-1$。对于位于 $(i',j')$ 的相邻节点，其对应的列索引为 $k' = (i'-1)(N-2) + (j'-1)$。具体来说：\n    -   对于 $\\phi_{i-1,j}$，列索引为 $k - (N-2)$。\n    -   对于 $\\phi_{i+1,j}$，列索引为 $k + (N-2)$。\n    -   对于 $\\phi_{i,j-1}$，列索引为 $k - 1$。\n    -   对于 $\\phi_{i,j+1}$，列索引为 $k + 1$。\n$M$ 的所有其他元素均为零。所得矩阵是稀疏、对称和正定的，这保证了解的唯一性。\n\n右端向量 $\\mathbf{b}$ 的元素为 $b_k = h^2 \\sigma_{i,j}$。根据问题描述，位于节点 $(i_0, j_0)$、积分强度为 $A$ 的点源由离散源密度 $\\sigma_{i_0,j_0} = A/h^2$ 表示。因此，向量 $\\mathbf{b}$ 中对应的项为 $b_k = h^2 (A/h^2) = A$。对于没有源的节点，$\\mathbf{b}$ 中对应的项为 $0$。\n\n计算步骤如下：\n1.  对于每个测试用例，定义参数 $N$、$h$、$\\kappa$ 以及源的集合（包括其强度 $A$ 和位置 $(i,j)$）。\n2.  构建 $D \\times D$ 矩阵 $M$，其中 $D=(N-2)^2$。对角元素为 $4 + h^2 \\kappa^2$，对应相邻节点的非对角元素为 $-1$。\n3.  构建大小为 $D$ 的向量 $\\mathbf{b}$。对于位于内部节点 $(i_s, j_s)$、强度为 $A_s$ 的每个源，将元素 $b_k = A_s$ 设为对应值，其中 $k$ 是 $(i_s, j_s)$ 的一维索引。\n4.  使用标准线性求解器求解线性系统 $M \\mathbf{\\Phi} = \\mathbf{b}$，以获得电势向量 $\\mathbf{\\Phi}$。\n5.  通过找到指定探针节点 $(i_p, j_p)$ 对应的一维索引 $k_p$ 并获取值 $\\mathbf{\\Phi}[k_p]$，来提取该节点的电势。\n将此过程应用于所提供的三个测试用例中的每一个。",
            "answer": "```python\n# The complete and runnable Python 3 code goes here.\n# Imports must adhere to the specified execution environment.\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Main function to solve the problem for all given test cases.\n    \"\"\"\n    test_cases = [\n        # Test case 1\n        {\n            \"N\": 21, \"h\": 1.0, \"kappa\": 0.0,\n            \"sources\": [(1.0, 10, 10)],\n            \"probe_node\": (10, 10)\n        },\n        # Test case 2\n        {\n            \"N\": 21, \"h\": 1.0, \"kappa\": 0.5,\n            \"sources\": [(1.0, 10, 10)],\n            \"probe_node\": (10, 10)\n        },\n        # Test case 3\n        {\n            \"N\": 21, \"h\": 1.0, \"kappa\": 0.5,\n            \"sources\": [(1.0, 8, 10), (-1.0, 12, 10)],\n            \"probe_node\": (10, 10)\n        }\n    ]\n\n    results = []\n    for case in test_cases:\n        result = _solve_pb_case(\n            case[\"N\"],\n            case[\"h\"],\n            case[\"kappa\"],\n            case[\"sources\"],\n            case[\"probe_node\"]\n        )\n        results.append(f\"{result:.6f}\")\n\n    print(f\"[{','.join(results)}]\")\n\ndef _solve_pb_case(N, h, kappa, sources, probe_node):\n    \"\"\"\n    Solves the linearized Poisson-Boltzmann equation for a single test case.\n\n    Args:\n        N (int): Grid size (N x N nodes).\n        h (float): Lattice spacing.\n        kappa (float): Inverse screening length.\n        sources (list): A list of tuples, where each tuple is (strength A, i, j).\n        probe_node (tuple): The (i, j) coordinates of the node to report potential.\n\n    Returns:\n        float: The calculated potential at the probe node.\n    \"\"\"\n    # Number of interior nodes along one dimension\n    num_interior = N - 2\n    # Total number of unknowns (dimension of the linear system)\n    dim = num_interior * num_interior\n\n    # The matrix M of the linear system M * Phi = b\n    M = np.zeros((dim, dim))\n    # The right-hand side vector b\n    b = np.zeros(dim)\n\n    # The value for the diagonal elements of M\n    diag_val = 4.0 + (h * kappa)**2\n\n    # Construct the matrix M\n    for i in range(1, N - 1):\n        for j in range(1, N - 1):\n            # Map 2D grid indices (i, j) to 1D vector index k (row-major)\n            k = (i - 1) * num_interior + (j - 1)\n\n            # Diagonal element\n            M[k, k] = diag_val\n\n            # Off-diagonal elements for neighbors\n            # West neighbor (i, j-1)\n            if j > 1:\n                M[k, k - 1] = -1.0\n            # East neighbor (i, j+1)\n            if j  N - 2:\n                M[k, k + 1] = -1.0\n            # North neighbor (i-1, j)\n            if i > 1:\n                M[k, k - num_interior] = -1.0\n            # South neighbor (i+1, j)\n            if i  N - 2:\n                M[k, k + num_interior] = -1.0\n\n    # Construct the source vector b\n    for strength_A, i_src, j_src in sources:\n        # Check if the source is an interior node\n        if 1 = i_src  N - 1 and 1 = j_src  N - 1:\n            k_src = (i_src - 1) * num_interior + (j_src - 1)\n            # As derived, b_k = h^2 * sigma = h^2 * (A / h^2) = A\n            b[k_src] += strength_A\n\n    # Solve the linear system M * Phi = b for the potentials Phi\n    try:\n        phi_vector = np.linalg.solve(M, b)\n    except np.linalg.LinAlgError:\n        # This should not happen for this problem as M is non-singular\n        return float('nan')\n\n    # Extract the potential at the probe node\n    i_probe, j_probe = probe_node\n    if 1 = i_probe  N - 1 and 1 = j_probe  N - 1:\n        k_probe = (i_probe - 1) * num_interior + (j_probe - 1)\n        potential = phi_vector[k_probe]\n    else:\n        # Probe is on the boundary, where potential is 0 by definition\n        potential = 0.0\n\n    return potential\n\nsolve()\n```"
        },
        {
            "introduction": "直接求解PB方程的计算成本非常高昂，因此科学家们发展了多种近似方法，其中广义玻恩 (Generalized Born, GB) 模型因其高效性而广受欢迎。本练习旨在探索GB模型与作为其理论基础的玻恩 (Born) 模型之间的关系，后者为单个球形离子提供了精确的解析解。你将通过计算一个高度对称的球形溶质（例如富勒烯）的溶剂化能，来检验GB模型在多大程度上能够重现精确的解析结果 。这项实践将帮助你理解GB模型是如何近似处理溶质内部复杂的成对静电相互作用的，并学会如何对照已知的解析基准来评估模型的准确性。",
            "id": "2456130",
            "problem": "要求您使用广义玻恩（GB）模型和解析玻恩方程，计算并比较一个球形类富勒烯溶质的连续介质静电溶剂化自由能。将溶质视为一个半径为 $R$ 的完美球体，沉浸在均匀介电介质中，并假设总电荷 $q_{\\mathrm{tot}}$ 分布在 $N$ 个位点上。计算过程中所有量必须使用国际单位制（SI），所有最终能量必须以千焦每摩尔（kJ/mol）为单位报告。需要时，角度必须使用弧度。\n\n使用的定义和物理常数：\n- 真空介电常数 $\\varepsilon_0 = 8.8541878128\\times 10^{-12}\\ \\mathrm{F/m}$。\n- 库仑常数 $k_e = \\dfrac{1}{4\\pi \\varepsilon_0}$。\n- 基本电荷 $e = 1.602176634\\times 10^{-19}\\ \\mathrm{C}$。\n- 阿伏伽德罗常数 $N_A = 6.02214076\\times 10^{23}\\ \\mathrm{mol^{-1}}$。\n- 单位换算 $1\\ \\mathrm{\\AA} = 1.0\\times 10^{-10}\\ \\mathrm{m}$。\n\n广义玻恩模型：设溶质内部介电常数为 $\\varepsilon_{\\mathrm{in}}$，溶剂介电常数为 $\\varepsilon_{\\mathrm{out}}$。考虑 $N$ 个点电荷位于半径为 $R$ 的球面上，每个点电荷带有相等的电荷 $q_i = q_{\\mathrm{tot}}/N$。为每个位点分配一个有效玻恩半径 $\\alpha_i = R$。GB 极化自由能定义为\n$$\n\\Delta G_{\\mathrm{GB}} = -\\dfrac{1}{2}\\,k_e\\left(\\dfrac{1}{\\varepsilon_{\\mathrm{in}}}-\\dfrac{1}{\\varepsilon_{\\mathrm{out}}}\\right)\\sum_{i=1}^{N}\\sum_{j=1}^{N}\\dfrac{q_i\\,q_j}{f_{\\mathrm{GB}}(r_{ij},\\alpha_i,\\alpha_j)}\\ ,\n$$\n其中 Still 广义玻恩有效距离为\n$$\nf_{\\mathrm{GB}}(r_{ij},\\alpha_i,\\alpha_j)=\\sqrt{r_{ij}^2+\\alpha_i\\alpha_j\\exp\\!\\left(-\\dfrac{r_{ij}^2}{4\\alpha_i\\alpha_j}\\right)}\\ ,\n$$\n其中 $r_{ij}$ 是位点 $i$ 和 $j$ 之间的欧几里得距离。\n\n解析玻恩模型：对于一个半径为 $R$、总电荷为 $q_{\\mathrm{tot}}$ 的单个有效球形溶质，处于内部和外部介电常数分别为 $\\varepsilon_{\\mathrm{in}}$ 和 $\\varepsilon_{\\mathrm{out}}$ 的介质中，玻恩极化自由能为\n$$\n\\Delta G_{\\mathrm{Born}} = -\\dfrac{1}{2}\\,k_e\\left(\\dfrac{1}{\\varepsilon_{\\mathrm{in}}}-\\dfrac{1}{\\varepsilon_{\\mathrm{out}}}\\right)\\dfrac{q_{\\mathrm{tot}}^2}{R}\\ .\n$$\n\n球形溶质上 $N$ 个电荷位点的几何构型说明：使用球面斐波那契格点将点准均匀地放置在半径为 $R$ 的球面上。对于 $k\\in\\{0,1,2,\\dots,N-1\\}$，定义黄金角 $\\varphi_g=\\pi(3-\\sqrt{5})$（以弧度为单位），z 坐标 $z_k=1-2\\,(k+0.5)/N$，平面内半径 $r_k=\\sqrt{1-z_k^2}$，方位角 $\\theta_k=k\\,\\varphi_g$，以及笛卡尔坐标\n$$\n\\mathbf{r}_k = R\\left(r_k\\cos\\theta_k,\\ r_k\\sin\\theta_k,\\ z_k\\right)\\ .\n$$\n对于 $N=1$ 的情况，将单位点放置在原点 $\\mathbf{r}_0=(0,0,0)$ 并设置 $\\alpha_0=R$。能量公式中使用的所有距离必须以米为单位。\n\n任务：\n1. 对下面的每个测试用例，以 $\\mathrm{kJ/mol}$ 为单位计算 $\\Delta G_{\\mathrm{GB}}$ 和 $\\Delta G_{\\mathrm{Born}}$，然后以 $\\mathrm{kJ/mol}$ 为单位计算绝对差 $\\lvert \\Delta G_{\\mathrm{GB}}-\\Delta G_{\\mathrm{Born}}\\rvert$，并计算定义为 $\\lvert \\Delta G_{\\mathrm{GB}}-\\Delta G_{\\mathrm{Born}}\\rvert / \\lvert \\Delta G_{\\mathrm{Born}}\\rvert$ 的相对差（一个无量纲小数）。\n2. 使用上述常数和定义，不做任何修改。\n3. 在计算前，将所有以埃（angstrom）为单位给出的输入半径转换为米。\n4. 角度必须以弧度为单位。\n\n测试套件（每个用例是一个元组 $(N,\\ q_{\\mathrm{tot}}/e,\\ R/\\mathrm{\\AA},\\ \\varepsilon_{\\mathrm{in}},\\ \\varepsilon_{\\mathrm{out}})$）：\n- 用例 1：$(60,\\ -1,\\ 3.55,\\ 1.0,\\ 78.37)$。\n- 用例 2：$(60,\\ -1,\\ 1.0,\\ 1.0,\\ 78.37)$。\n- 用例 3：$(60,\\ -1,\\ 3.55,\\ 1.0,\\ 2.0)$。\n- 用例 4 (对照组，点电荷极限)：$(1,\\ -1,\\ 3.55,\\ 1.0,\\ 78.37)$。\n\n最终输出格式：\n- 您的程序应生成单行输出，其中包含一个含四个项目的列表（每个测试用例一项），每个项目本身是一个包含四个浮点数的列表 $[\\Delta G_{\\mathrm{GB}},\\ \\Delta G_{\\mathrm{Born}},\\ \\text{abs\\_diff},\\ \\text{rel\\_diff}]$，顺序如上定义。\n- 所有能量必须以 $\\mathrm{kJ/mol}$ 为单位，所有相对差必须是小数（无量纲）。\n- 每个浮点数必须四舍五入到小数点后六位。\n- 整体输出必须是一个由方括号列表组成的单一方括号列表，不含任何空白字符，例如 $[[v_{11},v_{12},v_{13},v_{14}],[v_{21},v_{22},v_{23},v_{24}],[v_{31},v_{32},v_{33},v_{34}],[v_{41},v_{42},v_{43},v_{44}]]$，其中 $v_{ij}$ 是用例 $i$ 和量 $j$ 所需的四舍五入后的值。\n\n按规定以 $\\mathrm{kJ/mol}$ 和弧度回答所有计算，并严格遵守输出格式。",
            "solution": "所提出的问题是连续介质静电学领域中一个定义明确的计算练习，该领域是理论与计算化学的一个基础领域。它要求使用两个标准模型来计算和比较溶剂化自由能：用于简单球体的解析玻恩模型，以及用于带电荷分布球体的更复杂的广义玻恩（GB）模型。该问题在科学上是合理的，所有参数和方程均已提供，目标明确。因此，我们着手求解。\n\n问题的核心是评估静电极化自由能 $\\Delta G$ 的两个不同表达式，该能量表示将带电溶质从低介电常数介质（此处为 $\\varepsilon_{\\mathrm{in}}$）转移到高介电常数介质（溶剂，$\\varepsilon_{\\mathrm{out}}$）时相关的能量变化。\n\n首先，我们根据所有中间计算的要求，在国际单位制（SI）中定义基本常数和换算因子。\n- 真空介电常数：$\\varepsilon_0 = 8.8541878128\\times 10^{-12}\\ \\mathrm{F/m}$\n- 库仑常数：$k_e = \\dfrac{1}{4\\pi \\varepsilon_0}$\n- 基本电荷：$e = 1.602176634\\times 10^{-19}\\ \\mathrm{C}$\n- 阿伏伽德罗常数：$N_A = 6.02214076\\times 10^{23}\\ \\mathrm{mol^{-1}}$\n- 埃到米的换算：$1\\ \\mathrm{\\AA} = 1.0\\times 10^{-10}\\ \\mathrm{m}$\n\n所有输入参数，如球体半径 $R$ 和总电荷 $q_{\\mathrm{tot}}$，在使用于能量方程之前，必须转换为这些 SI 基本单位。\n\n对于提供的每个测试用例，计算都沿着两条平行的路径进行。\n\n**1. 玻恩模型计算**\n\n玻恩模型为完美、不可分割的球形离子提供了精确的解析解。极化自由能 $\\Delta G_{\\mathrm{Born}}$ 由下式给出：\n$$\n\\Delta G_{\\mathrm{Born}} = -\\dfrac{1}{2}\\,k_e\\left(\\dfrac{1}{\\varepsilon_{\\mathrm{in}}}-\\dfrac{1}{\\varepsilon_{\\mathrm{out}}}\\right)\\dfrac{q_{\\mathrm{tot}}^2}{R}\n$$\n实现是直接的：\n- 首先根据给定的基本电荷 $e$ 的倍数，以库仑为单位计算总电荷 $q_{\\mathrm{tot}}$。\n- 半径 $R$ 从埃（$\\mathrm{\\AA}$）转换为米（$\\mathrm{m}$）。\n- 对该方程求值，得出每个溶质粒子的能量，单位为焦耳（$J$）。\n- 为获得以千焦每摩尔（$\\mathrm{kJ/mol}$）为单位的最终摩尔能量，结果需乘以阿伏伽德罗常数 $N_A$ 并除以 1000。\n$$\n\\Delta G_{\\mathrm{Born}} \\ [\\mathrm{kJ/mol}] = \\Delta G_{\\mathrm{Born}} \\ [\\mathrm{J}] \\times \\dfrac{N_A}{1000}\n$$\n\n**2. 广义玻恩（GB）模型计算**\n\nGB 模型近似了具有更复杂电荷分布的分子的静电行为，此处建模为 $N$ 个离散的点电荷。能量表达式是所有电荷位点的对偶求和：\n$$\n\\Delta G_{\\mathrm{GB}} = -\\dfrac{1}{2}\\,k_e\\left(\\dfrac{1}{\\varepsilon_{\\mathrm{in}}}-\\dfrac{1}{\\varepsilon_{\\mathrm{out}}}\\right)\\sum_{i=1}^{N}\\sum_{j=1}^{N}\\dfrac{q_i\\,q_j}{f_{\\mathrm{GB}}(r_{ij},\\alpha_i,\\alpha_j)}\n$$\n其中每个位点带有相等的电荷 $q_i = q_{\\mathrm{tot}}/N$，且每个位点的有效玻恩半径设置为球体半径 $\\alpha_i = R$。有效距离函数 $f_{\\mathrm{GB}}$ 来自 Still 公式：\n$$\nf_{\\mathrm{GB}}(r_{ij},\\alpha_i,\\alpha_j)=\\sqrt{r_{ij}^2+\\alpha_i\\alpha_j\\exp\\!\\left(-\\dfrac{r_{ij}^2}{4\\alpha_i\\alpha_j}\\right)}\n$$\n计算过程包括以下几个步骤：\n\n- **生成电荷位点坐标：**必须确定 $N$ 个位点的位置 $\\mathbf{r}_k$。对于 $N1$，采用球面斐波那契格点算法。对于每个索引 $k \\in \\{0, 1, \\dots, N-1\\}$，在单位球坐标系中计算坐标，然后按半径 $R$ 进行缩放：\n  - 黄金角：$\\varphi_g=\\pi(3-\\sqrt{5})$\n  - z 轴位置（归一化）：$z'_k=1-2\\,(k+0.5)/N$\n  - 平面内半径（归一化）：$r'_k=\\sqrt{1-(z'_k)^2}$\n  - 方位角：$\\theta_k=k\\,\\varphi_g$\n  - 笛卡尔坐标：$\\mathbf{r}_k = (R \\cdot r'_k\\cos\\theta_k, R \\cdot r'_k\\sin\\theta_k, R \\cdot z'_k)$\n对于 $N=1$ 的特殊情况，题目明确指示我们将单个电荷放置在原点 $\\mathbf{r}_0=(0,0,0)$。\n\n- **计算 GB 和：**坐标确定后，构建一个对偶相互作用矩阵。\n  - 计算所有位点对 $(i, j)$ 的欧几里得距离 $r_{ij} = \\lVert \\mathbf{r}_i - \\mathbf{r}_j \\rVert$。\n  - 对每一对，计算有效距离 $f_{\\mathrm{GB}}(r_{ij}, R, R)$。注意，对于对角项（即 $i=j$），我们有 $r_{ii}=0$，这正确地得到 $f_{\\mathrm{GB}}(0, R, R) = \\sqrt{0^2+R^2\\exp(0)} = R$。\n  - 计算总和 $\\sum_{i,j} \\frac{q_i q_j}{f_{\\mathrm{GB}}}$。由于所有电荷 $q_i$ 都相同，这等价于 $(q_{\\mathrm{tot}}/N)^2 \\sum_{i,j} \\frac{1}{f_{\\mathrm{GB}}}$。\n- **最终能量计算：**将计算出的总和乘以与玻恩模型中相同的前置因子 $-\\frac{1}{2} k_e (\\frac{1}{\\varepsilon_{\\mathrm{in}}} - \\frac{1}{\\varepsilon_{\\mathrm{out}}})$。结果从焦耳转换为 $\\mathrm{kJ/mol}$。\n\n观察对照用例 $N=1$ 的行为至关重要。此时，位点位于原点，因此 $r_{00}=0$ 是唯一的距离。GB 和简化为单项：\n$$\n\\sum_{i=1}^{1}\\sum_{j=1}^{1}\\dfrac{q_i\\,q_j}{f_{\\mathrm{GB}}} = \\dfrac{q_{0}^2}{f_{\\mathrm{GB}}(0,R,R)} = \\dfrac{q_{\\mathrm{tot}}^2}{R}\n$$\n这使得 GB 能量表达式与玻恩能量表达式完全相同。因此，对于 $N=1$，我们期望 $\\Delta G_{\\mathrm{GB}} = \\Delta G_{\\mathrm{Born}}$，任何差异都将归因于浮点数精度限制。这可作为实现的一个重要的内部一致性检查。\n\n**3. 比较与输出格式化**\n对于每个测试用例，在以 $\\mathrm{kJ/mol}$ 为单位计算出 $\\Delta G_{\\mathrm{GB}}$ 和 $\\Delta G_{\\mathrm{Born}}$ 后，计算绝对差 $\\lvert \\Delta G_{\\mathrm{GB}}-\\Delta G_{\\mathrm{Born}}\\rvert$ 和无量纲的相对差 $\\lvert \\Delta G_{\\mathrm{GB}}-\\Delta G_{\\mathrm{Born}}\\rvert / \\lvert \\Delta G_{\\mathrm{Born}}\\rvert$。由于所有指定的测试用例中 $\\Delta G_{\\mathrm{Born}}$ 均不为零，因此相对差是良定义的。\n\n最后，将每个测试用例的四个计算值集合起来，格式化为六位小数，并按要求组装成一个精确的列表的列表格式的字符串 `[[...],[...],...]`，不含空格。",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Computes and compares continuum electrostatic solvation free energies using\n    the Generalized Born (GB) and analytical Born models for a spherical solute.\n    \"\"\"\n    \n    # Define physical constants in SI units\n    EPS_0 = 8.8541878128e-12  # F/m\n    K_E = 1 / (4 * np.pi * EPS_0)  # m/F or N*m^2/C^2\n    E_CHARGE = 1.602176634e-19  # C\n    N_A = 6.02214076e23  # mol^-1\n    ANGSTROM_TO_M = 1.0e-10  # m/Angstrom\n    \n    # Test suite: (N, q_tot/e, R/Angstrom, eps_in, eps_out)\n    test_cases = [\n        (60, -1, 3.55, 1.0, 78.37),\n        (60, -1, 1.0, 1.0, 78.37),\n        (60, -1, 3.55, 1.0, 2.0),\n        (1, -1, 3.55, 1.0, 78.37),\n    ]\n\n    all_results = []\n\n    for case in test_cases:\n        N, q_tot_e, R_angstrom, eps_in, eps_out = case\n\n        # --- Unit Conversions and Preliminary Calculations ---\n        R_m = R_angstrom * ANGSTROM_TO_M\n        q_tot = q_tot_e * E_CHARGE\n        q_i = q_tot / N\n        \n        # Energy prefactor common to both models, in SI units (J*m/C^2)\n        energy_prefactor = -0.5 * K_E * (1.0 / eps_in - 1.0 / eps_out)\n\n        # --- Born Model Calculation ---\n        # Energy in Joules for a single solute\n        delta_g_born_joules = energy_prefactor * (q_tot**2 / R_m)\n        # Convert to kJ/mol\n        delta_g_born_kj_mol = delta_g_born_joules * N_A / 1000.0\n\n        # --- Generalized Born Model Calculation ---\n        # Generate charge site coordinates\n        if N == 1:\n            # Special case as per problem description\n            coords = np.array([[0.0, 0.0, 0.0]])\n        else:\n            coords = np.zeros((N, 3))\n            phi_g = np.pi * (3.0 - np.sqrt(5.0))  # Golden angle in radians\n            for k in range(N):\n                z_k_norm = 1.0 - 2.0 * (k + 0.5) / N\n                r_k_norm = np.sqrt(1.0 - z_k_norm**2)\n                theta_k = k * phi_g\n                \n                coords[k, 0] = R_m * r_k_norm * np.cos(theta_k)\n                coords[k, 1] = R_m * r_k_norm * np.sin(theta_k)\n                coords[k, 2] = R_m * z_k_norm\n\n        # Calculate GB sum using vectorized operations for efficiency\n        # Pairwise distance matrix r_ij\n        diffs = coords[:, np.newaxis, :] - coords\n        r_ij_matrix = np.linalg.norm(diffs, axis=2)\n        \n        # Still effective distance f_GB\n        alpha_prod = R_m**2 # alpha_i * alpha_j = R * R always\n        \n        # The argument to exp is -r_ij^2 / (4*R^2).\n        # This is safe from division by zero, as R > 0.\n        exp_term = np.exp(-(r_ij_matrix**2) / (4.0 * alpha_prod))\n        f_gb_matrix = np.sqrt(r_ij_matrix**2 + alpha_prod * exp_term)\n        \n        # Sum term: sum_{i,j} (q_i * q_j / f_GB). Since all q_i are equal,\n        # this is (q_tot/N)^2 * sum_{i,j} (1/f_GB).\n        q_ij_prod = q_i**2\n        \n        # f_gb_matrix is guaranteed to be non-zero\n        gb_sum = q_ij_prod * np.sum(1.0 / f_gb_matrix)\n\n        # GB energy in Joules for a single solute\n        delta_g_gb_joules = energy_prefactor * gb_sum\n        # Convert to kJ/mol\n        delta_g_gb_kj_mol = delta_g_gb_joules * N_A / 1000.0\n\n        # --- Calculate Differences ---\n        abs_diff = np.abs(delta_g_gb_kj_mol - delta_g_born_kj_mol)\n        \n        # Relative difference. delta_g_born_kj_mol is non-zero for test cases.\n        rel_diff = abs_diff / np.abs(delta_g_born_kj_mol)\n\n        case_results = [\n            delta_g_gb_kj_mol,\n            delta_g_born_kj_mol,\n            abs_diff,\n            rel_diff,\n        ]\n        all_results.append(case_results)\n\n    # --- Format Final Output ---\n    output_parts = []\n    for res_list in all_results:\n        formatted_list = [f\"{val:.6f}\" for val in res_list]\n        output_parts.append(f\"[{','.join(formatted_list)}]\")\n    \n    final_output_str = f\"[{','.join(output_parts)}]\"\n    print(final_output_str)\n\nsolve()\n```"
        },
        {
            "introduction": "在掌握了PB和GB模型的实现方法后，更关键的一步是理解它们的适用范围和局限性。这些模型并非放之四海而皆准的“万灵丹”。本练习将你置于一个批判性思考的情境中：一个虚构的研究使用标准GB模型来模拟高浓度二价盐离子 ($\\mathrm{Mg^{2+}}$) 溶液中的DNA凝聚现象 。你需要运用所学知识，识别该研究在方法论上的根本性缺陷，并判断其结论是否可靠。这项练习将超越简单的计算，锻炼你作为一名科学家的批判性思维能力，让你深刻认识到平均场理论的内在假设，并学会在何种情况下这些假设会失效，从而导致不符合物理实际的结论。",
            "id": "2456138",
            "problem": "一项虚构的研究报告称，在使用标准广义玻恩（GB）模型进行的隐式溶剂模拟中，当体盐浓度为 $2\\,\\mathrm{M}$ $\\mathrm{MgCl_2}$ 时，观察到了双链脱氧核糖核酸（DNA）束的自发凝聚。在该设定中，溶剂被视为介电常数 $\\varepsilon_{\\mathrm{solvent}} \\approx 80$ 的均匀介电连续体，离子不被显式表示，盐屏蔽效应通过使用对应于 $2\\,\\mathrm{M}$ $\\mathrm{MgCl_2}$ 的屏蔽参数 $\\kappa$ 的德拜-休克尔类型衰减来引入。作者们认为，因为GB模型能够再现稀释条件下的溶剂化能，所以它在 $2\\,\\mathrm{M}$ 浓度下仍然可靠，并且观察到的凝聚现象源于GB静电模型隐式捕获的DNA磷酸基团之间特定的 $\\mathrm{Mg^{2+}}$ 桥。\n\n下列哪项批判正确地指出了这种在高离子强度和多价离子条件下模拟DNA凝聚的方法的关键局限性？（可多选）\n\nA. 带有德拜-休克尔类型屏蔽的标准GB模型不包含显式离子，因此无法表示短程的、位点特异性的结合、水合结构或由 $\\mathrm{Mg^{2+}}$ 形成的桥接；将凝聚归因于特定的 $\\mathrm{Mg^{2+}}$ 桥在这种模型下是没有依据的。\n\nB. 在 $2\\,\\mathrm{M}$ $\\mathrm{MgCl_2}$ 条件下，由于介电减量和介电饱和效应，假设溶剂具有均一的、不依赖于浓度的介电响应和线性溶剂极化是值得怀疑的；在稀释的、单价离子条件下校准的参数通常不能转移到这种体系中。\n\nC. 在GB模型中更新德拜屏蔽参数 $\\kappa$ 足以在任何盐浓度下实现定量准确性，因为德拜-休克尔理论对于任何离子价态和浓度的电解质溶液都是精确的。\n\nD. 平均场连续介质描述方法，如泊松-玻尔兹曼（PB）和GB模型，忽略了对同种电荷吸引至关重要的多价离子间的相关性；标准GB模型无法捕获由相关性驱动的DNA凝聚机制。\n\nE. 该设定的唯一严重缺陷是忽略了色散相互作用；在添加伦纳德-琼斯项后，即使在 $2\\,\\mathrmM}$ 浓度下，特定的 $\\mathrm{Mg^{2+}}$ 结合和DNA凝聚也将被准确再现。\n\nF. 在非常高的浓度下，德拜-休克尔屏蔽所基于的点离子假设会失效，因为有限的离子尺寸和排除体积效应限制了高电荷DNA附近的局部离子积累；带有简单屏蔽的标准GB模型缺乏此类空间位阻饱和效应。",
            "solution": "对问题陈述进行验证。\n\n**第1步：提取已知条件**\n- 系统：双链脱氧核糖核酸（DNA）束。\n- 模拟方法：使用标准广义玻恩（GB）模型的隐式溶剂模拟。\n- 溶剂表示：介电常数 $\\varepsilon_{\\mathrm{solvent}} \\approx 80$ 的均匀介电连续体。\n- 盐条件：体盐浓度为 $2\\,\\mathrm{M}$ $\\mathrm{MgCl_2}$。\n- 离子表示：离子不被显式表示。\n- 盐效应模型：使用对应于 $2\\,\\mathrm{M}$ $\\mathrm{MgCl_2}$ 的屏蔽参数 $\\kappa$ 的德拜-休克尔类型衰减。\n- 报告的观察现象：DNA束的自发凝聚。\n- 作者的论据 1：声称GB模型在 $2\\,\\mathrm{M}$ 浓度下是可靠的，因为它能再现稀释条件下的溶剂化能。\n- 作者的论据 2：观察到的凝聚被归因于GB模型隐式捕获的特定的 $\\mathrm{Mg^{2+}}$ 桥。\n\n**第2步：使用提取的已知条件进行验证**\n问题描述了一项假设性研究，其方法和结论需要被批判性地评估。该情景在计算生物物理学这一成熟领域具有科学依据，特别是在DNA等聚电解质的建模方面。所使用的概念——广义玻恩模型、德拜-休克尔屏蔽、介电常数、DNA凝聚——都是该学科的标准术语。问题提得很好，要求识别对所述方法的有效科学批判。它本身并不违反任何基本科学定律，而是提出了一个不当应用这些定律的情景，而这正是探究的主题。该设定是自洽的，没有矛盾、歧义或主观性陈述。该问题有效检验了对连续介质静电模型适用范围的理解。\n\n**第3步：结论与行动**\n问题陈述是有效的。将提供完整的解题过程和选项评估。\n\n核心问题在于将一个平均场连续介质溶剂模型，特别是带有简单德拜-休克尔屏蔽项的广义玻恩（GB）模型，应用于一个以高离子强度（$2\\,\\mathrm{M}$）和多价反离子（$\\mathrm{Mg^{2+}}$）存在为特征的系统。这类模型的参数化和推导所基于的假设仅在稀释的、单价盐溶液的极限下有效。作者的结论是基于对其所选理论模型的物理基础和局限性的深刻误解。\n\n**逐项分析**\n\nA. 带有德拜-休克尔类型屏蔽的标准GB模型不包含显式离子，因此无法表示短程的、位点特异性的结合、水合结构或由 $\\mathrm{Mg^{2+}}$ 形成的桥接；将凝聚归因于特定的 $\\mathrm{Mg^{2+}}$ 桥在这种模型下是没有依据的。\n这一论断是正确且根本性的批判。GB模型是一种连续介质静电学方法。它将溶剂和电解质溶液表示为一个具有宏观介电常数和由屏蔽参数 $\\kappa$ 表征的弥散离子氛的连续介质。该模型中没有离散的离子。因此，它在物理上不可能捕获依赖于离子的离散、颗粒性质的现象，例如与磷酸基团的位点特异性结合、单个 $\\mathrm{Mg^{2+}}$ 离子对多个此类基团的配位（形成“桥”），或离子水合壳中水分子的详细重构。作者将凝聚归因于“特定的 $\\mathrm{Mg^{2+}}$ 桥”是一种谬误的解释，它将分子水平的细节归因于一个已将其显式平均化的模型。\n结论：**正确**。\n\nB. 在 $2\\,\\mathrm{M}$ $\\mathrm{MgCl_2}$ 条件下，由于介电减量和介电饱和效应，假设溶剂具有均一的、不依赖于浓度的介电响应和线性溶剂极化是值得怀疑的；在稀释的、单价离子条件下校准的参数通常不能转移到这种体系中。\n这一论断正确地指出了溶剂模型的一个严重失效点。水的介电常数 $\\varepsilon \\approx 80$ 是纯水的宏观性质。在 $2\\,\\mathrm{M}$ 的盐浓度下，溶液远非纯水。高浓度的离子会破坏水的氢键网络，导致宏观介电常数显著下降（介电减量）。此外，在像 $\\mathrm{Mg^{2+}}$ 离子和DNA这样的高电荷物质附近，强烈的电场可以局部地使水偶极子排列至饱和点，导致局部介电响应变得非线性，并且远低于80。标准GB模型使用单一、恒定的介电值并假定线性响应，这在该体系中是明显错误的假设。模型参数不能从稀释体系转移到这种高浓度、多价离子的体系。\n结论：**正确**。\n\nC. 在GB模型中更新德拜屏蔽参数 $\\kappa$ 足以在任何盐浓度下实现定量准确性，因为德拜-休克尔理论对于任何离子价态和浓度的电解质溶液都是精确的。\n这一论断是完全错误的。德拜-休克尔理论是一个极限法，基于泊松-玻尔兹曼方程的线性化。这种线性化仅在离子的静电势能远小于其热能（$|z_i e \\psi| \\ll k_B T$）的条件下有效。这个条件在这里被严重违反，原因有二：（1）对于多价离子（$\\mathrm{Mg^{2+}}$ 的 $z_i = 2$）；（2）在像DNA这样的高电荷聚电解质附近，电势 $\\psi$ 很大。该理论还将离子视为点电荷，这个假设在高浓度下会灾难性地失效，因为此时离子的体积变得显著。声称德拜-休克尔理论在所有条件下都“精确”，是对基础物理化学的严重歪曲。\n结论：**不正确**。\n\nD. 平均场连续介质描述方法，如泊松-玻尔兹曼（PB）和GB模型，忽略了对同种电荷吸引至关重要的多价离子间的相关性；标准GB模型无法捕获由相关性驱动的DNA凝聚机制。\n这是一个精辟且正确的批判。由多价反离子引起的同种电荷聚电解质（DNA）的凝聚，是强静电相关性驱动现象的一个典型例子。平均场理论，就其本质而言，是对单个离子的位置进行平均，从而忽略了离子的相关涨落和空间排布，而正是后者导致了DNA分子间的有效吸引力。需要超越平均场水平的理论来描述这种现象，这些理论表明，一层高度相关的反离子可以过度中和聚离子的电荷并引发吸引力。标准GB模型作为一个平均场理论，只能描述静电屏蔽和同种电荷间的排斥；它无法产生凝聚所需的净吸引力。在此类模拟中观察到的任何“凝聚”都是不符合物理规律的人为结果。\n结论：**正确**。\n\nE. 该设定的唯一严重缺陷是忽略了色散相互作用；在添加伦纳德-琼斯项后，即使在 $2\\,\\mathrmM}$ 浓度下，特定的 $\\mathrm{Mg^{2+}}$ 结合和DNA凝聚也将被准确再现。\n这一论断是不正确的。虽然色散力（范德华相互作用的一部分，通常用伦纳德-琼斯势模拟）确实是总相互作用能的一个组成部分，但忽略它们远非“唯一的严重缺陷”。如批判A、B、D和F中所详述，该体系的静电模型本身就存在根本性缺陷。在一个有问题的静电模型上添加伦纳德-琼斯项并不能修复它。最重要的是，它没有向模拟中添加显式离子，因此不可能再现“特定的 $\\mathrm{Mg^{2+}}$ 结合”。声称该模型随后将被“准确再现”是完全没有根据的。\n结论：**不正确**。\n\nF. 在非常高的浓度下，德拜-休克尔屏蔽所基于的点离子假设会失效，因为有限的离子尺寸和排除体积效应限制了高电荷DNA附近的局部离子积累；带有简单屏蔽的标准GB模型缺乏此类空间位阻饱和效应。\n这一论断是正确的，指出了该理论基础的另一个关键失效点。德拜-休克尔模型，以及此GB实现中的简单屏蔽项，将离子视为没有体积的点电荷。在 $2\\,\\mathrm{M}$ 的浓度下，离子的物理体积占总体积的比例不可忽略。在DNA骨架附近的高静电势区域，点电荷模型会预测一个局部离子浓度，该浓度很容易超过物理堆积极限（例如，浓度高于纯离子晶体的浓度）。这是平均场理论一个众所周知的问题。需要考虑有限离子尺寸的模型（例如，尺寸修正的泊松-玻尔兹曼理论）来正确描述DNA附近反离子浓度的饱和现象。标准GB模型缺乏这种关键的物理效应。\n结论：**正确**。",
            "answer": "$$\\boxed{ABDF}$$"
        }
    ]
}