{
    "hands_on_practices": [
        {
            "introduction": "This problem is about the fundamental structure of the coupled cluster wavefunction. Before applying any complex theory, it is crucial to understand its building blocks. This exercise  guides you through constructing the coupled cluster hierarchy for a simple, yet illustrative, four-electron system, the beryllium atom. By systematically counting the number of parameters (amplitudes) at each level of theory (CCSD, CCSDT, etc.), you will gain a concrete understanding of how these methods are defined and why their computational cost increases so dramatically.",
            "id": "2464079",
            "problem": "Consider the Beryllium atom treated in a spin-orbital basis with a closed-shell restricted Hartree–Fock reference determinant denoted by $|\\Phi_{0}\\rangle$. Let the total number of electrons be $N=4$, the number of occupied spin-orbitals in the reference be $n_{o}=4$, and the number of virtual spin-orbitals be $n_{v}=L-4$, where $L$ is the total number of spin-orbitals in the one-electron basis. Work at the spin-orbital level (not spin-adapted), and assume that all spin-orbitals are orthonormal.\n\n1) Using the definition of Configuration Interaction (CI), write schematically the Full Configuration Interaction (FCI) wavefunction for this $N=4$ system as a linear combination of Slater determinants built from $|\\Phi_{0}\\rangle$ by exciting electrons from occupied to virtual spin-orbitals. Your schematic expression should make explicit the excitation ranks and the associated index structure up to the maximum excitation rank allowed by $N=4$.\n\n2) Using the definition of the Coupled Cluster (CC) ansatz $|\\Psi\\rangle=\\exp(T)|\\Phi_{0}\\rangle$ with the cluster operator $T=T_{1}+T_{2}+T_{3}+T_{4}$, identify which excitation manifolds are retained in Coupled Cluster with Singles and Doubles (CCSD), in Coupled Cluster with Singles, Doubles, and Triples (CCSDT), and in Coupled Cluster with Singles, Doubles, Triples, and Quadruples (CCSDTQ), for this $N=4$ system.\n\n3) By first-principles counting of independent antisymmetrized amplitudes in the spin-orbital representation, derive closed-form expressions, in terms of $n_{v}$, for the total number of independent cluster amplitudes included in each of CCSD, CCSDT, and CCSDTQ for this Be system. Report your final result as a single row vector $\\big(N_{\\mathrm{CCSD}},\\,N_{\\mathrm{CCSDT}},\\,N_{\\mathrm{CCSDTQ}}\\big)$, where each entry is a closed-form analytic expression in $n_{v}$. Express your final answer without units. If you assume any constraint on $n_{v}$, state it clearly; your expressions must remain algebraically valid for any integer $n_{v}\\ge 0$.",
            "solution": "The problem statement has been subjected to rigorous validation and is found to be scientifically grounded, well-posed, and objective. It presents a standard, solvable problem in theoretical and computational chemistry, free of contradictions or ambiguities. We shall proceed with a complete solution.\n\nThe problem considers a Beryllium atom with $N=4$ electrons. The reference state $|\\Phi_{0}\\rangle$ is the ground-state Hartree-Fock determinant, which has $n_{o}=4$ occupied spin-orbitals. We denote the set of occupied spin-orbital indices as $\\{i, j, k, l, \\dots\\}$ and the set of virtual spin-orbital indices as $\\{a, b, c, d, \\dots\\}$. The number of virtual spin-orbitals is $n_{v}$.\n\n**1) Full Configuration Interaction (FCI) Wavefunction**\n\nThe Full Configuration Interaction (FCI) wavefunction, $|\\Psi_{\\text{FCI}}\\rangle$, is the exact solution to the non-relativistic Schrödinger equation within the given one-electron basis set. It is constructed as a linear combination of all possible Slater determinants that can be formed by distributing the $N$ electrons among the available spin-orbitals. For an $N$-electron system, this expansion can be organized by excitation rank relative to the reference determinant $|\\Phi_{0}\\rangle$. The maximum possible excitation rank is $N$.\n\nFor the present system with $N=4$, the FCI wavefunction includes the reference determinant (zero excitations), and all singly, doubly, triply, and quadruply excited determinants. Let $|\\Phi_{i_{1}\\dots i_{k}}^{a_{1}\\dots a_{k}}\\rangle$ denote a Slater determinant where electrons from occupied spin-orbitals $\\{i_{1}, \\dots, i_{k}\\}$ have been promoted to virtual spin-orbitals $\\{a_{1}, \\dots, a_{k}\\}$. The FCI wavefunction is written schematically as:\n$$\n|\\Psi_{\\text{FCI}}\\rangle = c_{0}|\\Phi_{0}\\rangle + \\sum_{k=1}^{N} |\\Psi_{k}\\rangle\n$$\nwhere $|\\Psi_{k}\\rangle$ represents the contribution from all $k$-tuply excited configurations. For $N=4$, this becomes:\n$$\n|\\Psi_{\\text{FCI}}\\rangle = c_{0}|\\Phi_{0}\\rangle + \\sum_{i,a} c_{i}^{a} |\\Phi_{i}^{a}\\rangle + \\sum_{\\substack{i<j \\\\ a<b}} c_{ij}^{ab} |\\Phi_{ij}^{ab}\\rangle + \\sum_{\\substack{i<j<k \\\\ a<b<c}} c_{ijk}^{abc} |\\Phi_{ijk}^{abc}\\rangle + \\sum_{\\substack{i<j<k<l \\\\ a<b<c<d}} c_{ijkl}^{abcd} |\\Phi_{ijkl}^{abcd}\\rangle\n$$\nThe summation indices $i,j,k,l$ run over the $n_{o}=4$ occupied spin-orbitals, and the indices $a,b,c,d$ run over the $n_{v}$ virtual spin-orbitals. The ordered summation indices ensure that each distinct determinant is included only once. Since $n_{o}=4$, the final summation over $i<j<k<l$ has only one term for the occupied indices, which corresponds to exciting all four electrons from the occupied space.\n\n**2) Excitation Manifolds in Coupled Cluster (CC) Theory**\n\nThe Coupled Cluster (CC) wavefunction is defined by the ansatz $|\\Psi_{\\text{CC}}\\rangle = \\exp(T)|\\Phi_{0}\\rangle$, where the cluster operator $T$ is a sum of excitation operators:\n$$\nT = T_{1} + T_{2} + T_{3} + \\dots + T_{N}\n$$\nThe operator $T_{k}$ creates all $k$-tuple excitations from the reference determinant:\n$$\nT_{k} = \\sum_{\\substack{i_{1}<\\dots<i_{k} \\\\ a_{1}<\\dots<a_{k}}} t_{i_{1}\\dots i_{k}}^{a_{1}\\dots a_{k}} \\hat{\\tau}_{i_{1}\\dots i_{k}}^{a_{1}\\dots a_{k}}\n$$\nwhere $t_{i_{1}\\dots i_{k}}^{a_{1}\\dots a_{k}}$ are the cluster amplitudes and $\\hat{\\tau}_{i_{1}\\dots i_{k}}^{a_{1}\\dots a_{k}}$ is the corresponding excitation operator. Approximations to the exact CC theory (which is equivalent to FCI) are made by truncating the cluster operator $T$.\n\n-   **Coupled Cluster with Singles and Doubles (CCSD):** In this method, the cluster operator is truncated to include only single and double excitations: $T \\approx T_{\\text{CCSD}} = T_{1} + T_{2}$. Therefore, the excitation manifolds *retained in the cluster operator* are those of singles and doubles. It is crucial to note that the resulting CCSD wavefunction, $|\\Psi_{\\text{CCSD}}\\rangle = \\exp(T_{1}+T_{2})|\\Phi_{0}\\rangle$, contains contributions from higher-than-double excitations due to the exponential form (e.g., $\\frac{1}{2}T_{2}^{2}|\\Phi_{0}\\rangle$ generates quadruply excited determinants).\n\n-   **Coupled Cluster with Singles, Doubles, and Triples (CCSDT):** Here, the cluster operator is truncated at triple excitations: $T \\approx T_{\\text{CCSDT}} = T_{1} + T_{2} + T_{3}$. The retained manifolds in the operator are singles, doubles, and triples.\n\n-   **Coupled Cluster with Singles, Doubles, Triples, and Quadruples (CCSDTQ):** This model includes up to quadruple excitations in the cluster operator: $T \\approx T_{\\text{CCSDTQ}} = T_{1} + T_{2} + T_{3} + T_{4}$. For an $N=4$ electron system, this is the highest possible excitation level, so CCSDTQ is equivalent to FCI. The retained manifolds in the operator are singles, doubles, triples, and quadruples.\n\n**3) Number of Independent Cluster Amplitudes**\n\nThe number of independent, non-redundant cluster amplitudes for the $T_k$ operator, in a spin-orbital formulation, is determined by the number of ways to choose $k$ distinct occupied spin-orbitals from a set of $n_{o}$ and $k$ distinct virtual spin-orbitals from a set of $n_{v}$. This is a standard combinatorial calculation given by the product of two binomial coefficients:\n$$\nN_{k} = \\binom{n_{o}}{k} \\binom{n_{v}}{k}\n$$\nThe problem specifies $n_{o}=4$. The derived expressions must be valid for any non-negative integer $n_{v}$. The binomial coefficient $\\binom{n}{k}$ is zero if $k>n$, a property that our final polynomial expressions will inherently respect.\n\nThe number of amplitudes for each excitation level is:\n-   Singles ($T_{1}$): $N_{1} = \\binom{4}{1} \\binom{n_{v}}{1} = 4 \\cdot n_{v} = 4n_{v}$\n-   Doubles ($T_{2}$): $N_{2} = \\binom{4}{2} \\binom{n_{v}}{2} = \\frac{4 \\cdot 3}{2} \\cdot \\frac{n_{v}(n_{v}-1)}{2} = 6 \\cdot \\frac{n_{v}^{2}-n_{v}}{2} = 3(n_{v}^{2}-n_{v})$\n-   Triples ($T_{3}$): $N_{3} = \\binom{4}{3} \\binom{n_{v}}{3} = 4 \\cdot \\frac{n_{v}(n_{v}-1)(n_{v}-2)}{6} = \\frac{2}{3} n_{v}(n_{v}-1)(n_{v}-2)$\n-   Quadruples ($T_{4}$): $N_{4} = \\binom{4}{4} \\binom{n_{v}}{4} = 1 \\cdot \\frac{n_{v}(n_{v}-1)(n_{v}-2)(n_{v}-3)}{24} = \\frac{1}{24} n_{v}(n_{v}-1)(n_{v}-2)(n_{v}-3)$\n\nThe total number of amplitudes for each CC method is the sum of the counts for the included excitation levels.\n\n-   **Total Amplitudes in CCSD ($N_{\\mathrm{CCSD}}$):**\n$$\nN_{\\mathrm{CCSD}} = N_{1} + N_{2} = 4n_{v} + 3(n_{v}^{2}-n_{v}) = 4n_{v} + 3n_{v}^{2} - 3n_{v} = 3n_{v}^{2} + n_{v} = n_{v}(3n_{v}+1)\n$$\n\n-   **Total Amplitudes in CCSDT ($N_{\\mathrm{CCSDT}}$):**\n$$\nN_{\\mathrm{CCSDT}} = N_{\\mathrm{CCSD}} + N_{3} = (3n_{v}^{2} + n_{v}) + \\frac{2}{3} (n_{v}^{3} - 3n_{v}^{2} + 2n_{v})\n$$\n$$\nN_{\\mathrm{CCSDT}} = \\frac{2}{3}n_{v}^{3} + (3-2)n_{v}^{2} + (1+\\frac{4}{3})n_{v} = \\frac{2}{3}n_{v}^{3} + n_{v}^{2} + \\frac{7}{3}n_{v} = \\frac{n_{v}}{3}(2n_{v}^{2} + 3n_{v} + 7)\n$$\n\n-   **Total Amplitudes in CCSDTQ ($N_{\\mathrm{CCSDTQ}}$):**\n$$\nN_{\\mathrm{CCSDTQ}} = N_{\\mathrm{CCSDT}} + N_{4} = \\left(\\frac{2}{3}n_{v}^{3} + n_{v}^{2} + \\frac{7}{3}n_{v}\\right) + \\frac{1}{24}(n_{v}^{4} - 6n_{v}^{3} + 11n_{v}^{2} - 6n_{v})\n$$\n$$\nN_{\\mathrm{CCSDTQ}} = \\frac{1}{24}n_{v}^{4} + \\left(\\frac{16}{24}-\\frac{6}{24}\\right)n_{v}^{3} + \\left(\\frac{24}{24}+\\frac{11}{24}\\right)n_{v}^{2} + \\left(\\frac{56}{24}-\\frac{6}{24}\\right)n_{v}\n$$\n$$\nN_{\\mathrm{CCSDTQ}} = \\frac{1}{24}n_{v}^{4} + \\frac{10}{24}n_{v}^{3} + \\frac{35}{24}n_{v}^{2} + \\frac{50}{24}n_{v} = \\frac{n_{v}}{24}(n_{v}^{3} + 10n_{v}^{2} + 35n_{v} + 50)\n$$\n\nThe final results are presented as a row vector as requested.",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nn_{v}(3n_{v} + 1) & \\frac{n_{v}}{3}(2n_{v}^{2} + 3n_{v} + 7) & \\frac{n_{v}}{24}(n_{v}^{3} + 10n_{v}^{2} + 35n_{v} + 50)\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "The power of the coupled cluster ansatz lies in its unique exponential structure, which endows it with important formal properties. This thought experiment  explores one of the most remarkable features of CCSD: its ability to provide the exact energy for any two-electron system, a result that holds regardless of the strength of electron correlation. By considering two limiting cases—one dominated by dynamic correlation and one by strong static correlation—you will uncover why the CCSD method is exact in this special circumstance, providing deep insight into its relationship with Full Configuration Interaction.",
            "id": "2464092",
            "problem": "Consider two model systems with $2$ electrons in $2$ orthonormal spatial orbitals $\\{\\phi_a,\\phi_b\\}$, treated as a spin-singlet and using the same one-particle basis for all methods. Let $|\\Phi_0\\rangle$ denote the restricted Hartree–Fock (HF) reference determinant with both electrons occupying $\\phi_a$, and let $|\\Phi_{ab}^{2}\\rangle$ denote the determinant in which both electrons occupy $\\phi_b$. Assume the standard nonrelativistic Born–Oppenheimer electronic Hamiltonian in second quantization with one-electron energies $\\epsilon_a,\\epsilon_b$ and electron–electron interactions defined by the usual two-electron integrals in this basis.\n\nSystem D (dynamic correlation regime): The orbital energy gap $\\Delta \\equiv \\epsilon_b - \\epsilon_a$ is large compared to the off-diagonal Hamiltonian coupling between $|\\Phi_0\\rangle$ and $|\\Phi_{ab}^{2}\\rangle$, and $|\\Phi_0\\rangle$ is a qualitatively correct zeroth-order description of the state. Correlation arises as a small admixture of $|\\Phi_{ab}^{2}\\rangle$ driven by electron–electron interactions.\n\nSystem S (static correlation regime): The orbitals are nearly degenerate, $\\Delta \\approx 0$, so $|\\Phi_0\\rangle$ and $|\\Phi_{ab}^{2}\\rangle$ are nearly degenerate and both are essential to describe the state even at the qualitative level.\n\nFor each system, compare the expected performance of Coupled Cluster with Singles and Doubles (CCSD) and Full Configuration Interaction (FCI) when applied in this $2$-orbital basis with the HF reference $|\\Phi_0\\rangle$. Choose the statement that best reflects their relationship under these conditions.\n\nA. In System D, CCSD reproduces the FCI energy exactly, but in System S, CCSD is not size-extensive and deviates strongly from FCI.\n\nB. In both System D and System S, CCSD reproduces the FCI energy exactly (given the same one-particle basis and a single-determinant reference), despite the different correlation regimes.\n\nC. In System D, CCSD underestimates the correlation relative to FCI, whereas in System S, CCSD matches FCI because double excitations dominate.\n\nD. CCSD is exact only if single excitations are nonzero; since singles amplitudes vanish for a closed-shell spin-singlet in canonical HF orbitals, CCSD cannot reach FCI in either system.\n\nE. In System S, triples beyond CCSD are required to reach FCI because near-degeneracy introduces higher-than-double excitations into the exact wavefunction.",
            "solution": "The analysis of the problem proceeds in two stages: first, a rigorous validation of the problem statement, and second, a derivation of the solution based on fundamental principles of quantum chemistry.\n\n### Problem Validation\n\n**Step 1: Extract Givens**\n\n*   **System**: A quantum system of $N=2$ electrons.\n*   **Basis**: A set of $K=2$ orthonormal spatial orbitals, $\\{\\phi_a, \\phi_b\\}$.\n*   **Spin**: The system is in a spin-singlet state.\n*   **Reference State**: The reference determinant is the restricted Hartree-Fock (HF) state, $|\\Phi_0\\rangle$, where both electrons occupy the orbital $\\phi_a$.\n*   **Excited State**: A doubly excited determinant, $|\\Phi_{ab}^{2}\\rangle$, where both electrons occupy the orbital $\\phi_b$.\n*   **Hamiltonian**: The standard nonrelativistic Born-Oppenheimer electronic Hamiltonian. One-electron energies are $\\epsilon_a$ and $\\epsilon_b$.\n*   **System D (Dynamic Correlation)**: The energy gap $\\Delta \\equiv \\epsilon_b - \\epsilon_a$ is large. $|\\Phi_0\\rangle$ is a good zeroth-order description.\n*   **System S (Static Correlation)**: The energy gap $\\Delta \\approx 0$. $|\\Phi_0\\rangle$ and $|\\Phi_{ab}^{2}\\rangle$ are nearly degenerate.\n*   **Task**: Compare the performance of Coupled Cluster with Singles and Doubles (CCSD) and Full Configuration Interaction (FCI) for both systems using $|\\Phi_0\\rangle$ as the reference.\n\n**Step 2: Validate Using Extracted Givens**\n\n1.  **Scientific Grounding**: The problem is scientifically sound. It employs a minimal model ($2$ electrons in $2$ orbitals) that is a standard pedagogical tool in many-body quantum theory to illustrate the concepts of electron correlation, configuration interaction, and coupled cluster theory. All terms used (HF, FCI, CCSD, spin-singlet, nonrelativistic Hamiltonian) are central to computational chemistry.\n\n2.  **Well-Posedness**: The problem is well-posed. The Hilbert space for a $2$-electron system in a finite basis is finite. The Full CI (FCI) provides the exact solution within this basis, serving as a well-defined benchmark. The CCSD method is also a well-defined computational procedure. The question asks for a comparison of known properties of these methods under the specified conditions.\n\n3.  **Objectivity**: The problem is stated objectively using standard technical terminology. The descriptions of System D and System S, while qualitative, correspond to well-understood physical regimes in quantum chemistry.\n\nThe problem is a valid, well-posed, and standard theoretical question in the field of electronic structure theory. No flaws are identified.\n\n### Solution Derivation\n\nThe core of this problem rests on a fundamental property of the Coupled Cluster with Singles and Doubles (CCSD) method when applied to a two-electron system.\n\n1.  **Full Configuration Interaction (FCI) for a Two-Electron System:**\n    For any system, FCI is, by definition, the exact solution of the Schrödinger equation within the given one-particle basis set. The FCI wavefunction $|\\Psi_{\\text{FCI}}\\rangle$ is a complete superposition of all possible Slater determinants that can be constructed. For a system with $N=2$ electrons, any excitation from a reference determinant $|\\Phi_0\\rangle$ can move at most two electrons. Therefore, the highest possible excitation level is a double excitation.\n    The FCI wavefunction, using intermediate normalization (coefficient of $|\\Phi_0\\rangle$ is $1$), can be written as:\n    $$ |\\Psi_{\\text{FCI}}\\rangle = (1 + \\hat{C}_1 + \\hat{C}_2) |\\Phi_0\\rangle $$\n    where $\\hat{C}_1$ is the operator that generates all singly excited determinants from $|\\Phi_0\\rangle$ with their respective CI coefficients, and $\\hat{C}_2$ is the operator that generates all doubly excited determinants. Operators for triple ($\\hat{C}_3$), quadruple ($\\hat{C}_4$), and higher excitations are null for a two-electron system, i.e., $\\hat{C}_n |\\Phi_0\\rangle = 0$ for $n > 2$.\n\n2.  **Coupled Cluster (CCSD) for a Two-Electron System:**\n    The CCSD wavefunction is constructed using an exponential ansatz:\n    $$ |\\Psi_{\\text{CCSD}}\\rangle = e^{\\hat{T}} |\\Phi_0\\rangle $$\n    where the cluster operator $\\hat{T}$ is truncated to include single and double excitations:\n    $$ \\hat{T} = \\hat{T}_1 + \\hat{T}_2 $$\n    The exponential is expanded as a Taylor series:\n    $$ e^{\\hat{T}_1 + \\hat{T}_2} = 1 + (\\hat{T}_1 + \\hat{T}_2) + \\frac{1}{2!}(\\hat{T}_1 + \\hat{T}_2)^2 + \\frac{1}{3!}(\\hat{T}_1 + \\hat{T}_2)^3 + \\dots $$\n    Let us examine the action of these terms on the reference state $|\\Phi_0\\rangle$ for our $N=2$ electron system:\n    *   $\\hat{T}_1|\\Phi_0\\rangle$ produces a linear combination of all singly excited determinants.\n    *   $\\hat{T}_2|\\Phi_0\\rangle$ produces a linear combination of all doubly excited determinants.\n    *   The quadratic term is $\\frac{1}{2}(\\hat{T}_1^2 + \\hat{T}_1\\hat{T}_2 + \\hat{T}_2\\hat{T}_1 + \\hat{T}_2^2)$.\n    *   $\\hat{T}_1^2 |\\Phi_0\\rangle$ corresponds to applying single excitation operators twice. This creates double excitations.\n    *   $\\hat{T}_1\\hat{T}_2 |\\Phi_0\\rangle$ first creates a doubly excited state. Since both electrons are now in virtual orbitals, a subsequent application of $\\hat{T}_1$, which excites an electron from an occupied orbital, results in zero. Thus, $\\hat{T}_1\\hat{T}_2 |\\Phi_0\\rangle = 0$.\n    *   Similarly, $\\hat{T}_2\\hat{T}_1 |\\Phi_0\\rangle = 0$ because $\\hat{T}_2$ requires two electrons in occupied orbitals to act upon, but $\\hat{T}_1|\\Phi_0\\rangle$ leaves only one.\n    *   $\\hat{T}_2^2 |\\Phi_0\\rangle$ would create a quadruple excitation, which is impossible with only two electrons. Thus, $\\hat{T}_2^2 |\\Phi_0\\rangle = 0$.\n    *   All higher-order terms in the exponential expansion (e.g., $(\\hat{T}_1+\\hat{T}_2)^3$) also vanish for the same reason: they would attempt to create excitations of order higher than two.\n\n    Therefore, for any $N=2$ electron system, the exponential expansion of the CCSD operator truncates exactly:\n    $$ |\\Psi_{\\text{CCSD}}\\rangle = \\left(1 + \\hat{T}_1 + \\hat{T}_2 + \\frac{1}{2}\\hat{T}_1^2\\right) |\\Phi_0\\rangle $$\n    This wavefunction is a linear combination of the reference, singly excited, and doubly excited determinants. It spans the *exact same* vector space as the FCI wavefunction. Because the parameterization of the CCSD wavefunction is flexible enough to represent any state in the $2$-electron FCI space, solving the CCSD equations is equivalent to diagonalizing the Hamiltonian in that space. Consequently, CCSD yields the exact FCI energy and wavefunction for any two-electron system, regardless of the basis set or the details of the Hamiltonian.\n\n3.  **Application to System D and System S:**\n    The distinction between System D (dynamic correlation, large gap $\\Delta$) and System S (static correlation, small gap $\\Delta$) is critical for the performance of single-reference CCSD on systems with more than two electrons. In general many-electron systems, CCSD struggles with static correlation. However, this problem concerns an $N=2$ system, which is a special case. The mathematical exactness of CCSD for $N=2$ holds for any physical parameters.\n    *   In System D, CCSD will be exact, correctly describing the small correlation effect.\n    *   In System S, despite the strong multireference character that would challenge CCSD in a typical $N$-electron problem, CCSD will remain exact and reproduce the FCI result.\n\n### Option-by-Option Analysis\n\n*   **A. In System D, CCSD reproduces the FCI energy exactly, but in System S, CCSD is not size-extensive and deviates strongly from FCI.**\n    This statement is incorrect. While the first part is true (CCSD is exact for $N=2$), the second part is false. CCSD is fundamentally size-extensive by its formulation. Furthermore, it does not deviate from FCI in System S for a $2$-electron system; it remains exact.\n    **Verdict: Incorrect.**\n\n*   **B. In both System D and System S, CCSD reproduces the FCI energy exactly (given the same one-particle basis and a single-determinant reference), despite the different correlation regimes.**\n    This statement is correct. As demonstrated above, CCSD is equivalent to FCI for any two-electron system. This mathematical property is independent of the correlation regime, whether it is dynamic (System D) or static (System S).\n    **Verdict: Correct.**\n\n*   **C. In System D, CCSD underestimates the correlation relative to FCI, whereas in System S, CCSD matches FCI because double excitations dominate.**\n    This statement is incorrect. CCSD does not underestimate the correlation énergie relative to FCI for a $2$-electron system in any regime; it is exact. The reasoning for System S is also misleading; while double excitations are important, the exactness of CCSD stems from the complete truncation of the cluster expansion for $N=2$, not simply the dominance of doubles.\n    **Verdict: Incorrect.**\n\n*   **D. CCSD is exact only if single excitations are nonzero; since singles amplitudes vanish for a closed-shell spin-singlet in canonical HF orbitals, CCSD cannot reach FCI in either system.**\n    This statement contains multiple errors. First, the T1 amplitudes ($t_1$) are not necessarily zero even when using canonical HF orbitals (for which Brillouin's theorem applies). The $t_1$ amplitudes are determined by the full CC amplitude equations, which couple them to the T2 amplitudes ($t_2$). Second, and more importantly, the conclusion that CCSD cannot reach FCI is fundamentally wrong for a $2$-electron system.\n    **Verdict: Incorrect.**\n\n*   **E. In System S, triples beyond CCSD are required to reach FCI because near-degeneracy introduces higher-than-double excitations into the exact wavefunction.**\n    This statement describes a situation common in many-electron systems ($N>2$) with static correlation, but it is physically impossible for a two-electron system. The FCI wavefunction for $N=2$ contains no excitations higher than doubles. Therefore, triple excitations do not exist and cannot be required.\n    **Verdict: Incorrect.**",
            "answer": "$$\\boxed{B}$$"
        },
        {
            "introduction": "Ultimately, the value of a quantum chemical method lies in the physical insights it provides. After understanding the theoretical structure of the coupled cluster ansatz, this practice problem  challenges you to apply it in a practical context. You will compute the coupled cluster doubles amplitudes for a water molecule and learn how to interpret the most significant amplitudes to describe specific electron correlation effects, such as excitations from lone pairs into antibonding orbitals. This exercise bridges the gap between abstract mathematical formalism and tangible chemical phenomena.",
            "id": "2464083",
            "problem": "You are provided with a closed-shell reference for a water molecule represented in a small active space derived from a correlation-consistent polarized valence double-zeta basis. The coupled cluster ansatz for a closed-shell reference uses the exponential operator acting on a reference determinant, with the cluster operator truncated to the doubles sector, so that the wavefunction is written as $|\\Psi\\rangle = e^{T_2} |\\Phi_0\\rangle$, where $T_2$ is the doubles cluster operator with amplitudes $t_{ij}^{ab}$. Consider canonical Hartree–Fock molecular orbitals, and assume linearization of the similarity-transformed Hamiltonian by neglecting terms of quadratic and higher order in the cluster amplitudes. Under these conditions, the projective equations for the doubles amplitudes reduce to a set of decoupled linear relations in the canonical basis that involve the occupied orbital indices $i,j$, virtual orbital indices $a,b$, orbital energies $\\varepsilon_p$, and antisymmetrized two-electron integrals $\\langle ij \\Vert ab \\rangle$ in Hartree. The denominator for a doubles amplitude is defined as $D_{ij}^{ab} = \\varepsilon_i + \\varepsilon_j - \\varepsilon_a - \\varepsilon_b$. The amplitudes $t_{ij}^{ab}$ are dimensionless.\n\nFor each test case below, you are given:\n- A list of orbital energies $\\varepsilon_p$ in Hartree for a set of orbitals indexed by integers, where the first two indices correspond to occupied orbitals $i,j$ and the remaining indices correspond to virtual orbitals $a,b$.\n- A set of nonzero antisymmetrized two-electron integrals $\\langle ij \\Vert ab \\rangle$ in Hartree for unique index combinations with $i &lt; j$ and $a &lt; b$. Any integral not explicitly listed is zero.\n- For each orbital, auxiliary metadata consisting of a triplet of gross population weights on atoms $(\\mathrm{O}, \\mathrm{H}_1, \\mathrm{H}_2)$ that sum to one for occupied orbitals and approximately sum to one for virtual orbitals, and a scalar bonding indicator $b_p$ (dimensionless), positive for bonding character, negative for antibonding character, and near zero for nonbonding or Rydberg-like character.\n\nYour tasks for each test case are:\n1. Compute all doubles amplitudes $t_{ij}^{ab}$ using the linearized coupled cluster doubles equations in the canonical basis. For each unique combination with $i &lt; j$ and $a &lt; b$, compute the amplitude using the given data.\n2. Identify the single amplitude with the largest absolute value. In case of a tie, select the quadruple $(i,j,a,b)$ that is lexicographically smallest when compared as a 4-tuple of integers.\n3. Provide a physically motivated categorical interpretation of the selected excitation using the following rule-based classifier derived from the supplied orbital metadata:\n   - For an occupied orbital $p$, define its category $c_p^{\\mathrm{occ}}$ as:\n     - $1$ (lone pair) if $q_{\\mathrm{O}} \\geq 0.8$ and $\\lvert b_p \\rvert < 0.1$,\n     - $2$ (sigma bonding) if $b_p \\geq 0.2$,\n     - $0$ otherwise.\n   - For a virtual orbital $p$, define its category $c_p^{\\mathrm{virt}}$ as:\n     - $2$ (sigma antibonding) if $b_p \\leq -0.2$ and $q_{\\mathrm{O}} \\geq 0.45$ and $(q_{\\mathrm{H}_1} + q_{\\mathrm{H}_2}) \\geq 0.4$,\n     - $3$ (Rydberg-like) if $q_{\\mathrm{O}} \\geq 0.85$ and $\\lvert b_p \\rvert < 0.1$,\n     - $0$ otherwise.\n   - For an occupied pair $(i,j)$, define $c_{\\mathrm{occ}}$ by:\n     - If $c_i^{\\mathrm{occ}} = c_j^{\\mathrm{occ}} \\neq 0$, then $c_{\\mathrm{occ}} = c_i^{\\mathrm{occ}}$,\n     - Else if $\\{c_i^{\\mathrm{occ}}, c_j^{\\mathrm{occ}}\\} = \\{1,2\\}$, then $c_{\\mathrm{occ}} = 1$,\n     - Else $c_{\\mathrm{occ}} = 0$.\n   - For a virtual pair $(a,b)$, define $c_{\\mathrm{virt}}$ by:\n     - If $c_a^{\\mathrm{virt}} = c_b^{\\mathrm{virt}} \\neq 0$, then $c_{\\mathrm{virt}} = c_a^{\\mathrm{virt}}$,\n     - Else if $2 \\in \\{c_a^{\\mathrm{virt}}, c_b^{\\mathrm{virt}}\\}$, then $c_{\\mathrm{virt}} = 2$,\n     - Else $c_{\\mathrm{virt}} = 0$.\n   - Finally, map $(c_{\\mathrm{occ}}, c_{\\mathrm{virt}})$ to an interpretation code $\\kappa$ as:\n     - $(1,2) \\mapsto 12$ (lone-pair to sigma-antibonding),\n     - $(2,2) \\mapsto 22$ (sigma-bonding to sigma-antibonding),\n     - $(1,3) \\mapsto 13$ (lone-pair to Rydberg-like),\n     - Otherwise $\\mapsto 0$.\n\nUse the following test suite. In each case, orbital energies are in Hartree, two-electron integrals in Hartree, and the resulting doubles amplitudes are dimensionless.\n\nTest case A:\n- Orbital energies $\\varepsilon_p$: $[-0.571,\\,-0.450,\\,0.120,\\,0.250,\\,0.380]$ for $p = 0,1,2,3,4$, with occupied $i,j \\in \\{0,1\\}$ and virtual $a,b \\in \\{2,3,4\\}$.\n- Nonzero antisymmetrized two-electron integrals $\\langle ij \\Vert ab \\rangle$ for unique index quadruples $(i,j,a,b)$ with $i &lt; j$ and $a &lt; b$:\n  - $(0,1,2,3): 0.085$,\n  - $(0,1,2,4): 0.092$,\n  - $(0,1,3,4): 0.078$.\n  All other such integrals are zero.\n- Orbital metadata $(q_{\\mathrm{O}}, q_{\\mathrm{H}_1}, q_{\\mathrm{H}_2}; b_p)$ for $p = 0,1,2,3,4$:\n  - $p=0$: $(0.88,\\,0.06,\\,0.06;\\,0.02)$,\n  - $p=1$: $(0.65,\\,0.20,\\,0.15;\\,0.45)$,\n  - $p=2$: $(0.55,\\,0.24,\\,0.21;\\,-0.50)$,\n  - $p=3$: $(0.90,\\,0.05,\\,0.05;\\,-0.05)$,\n  - $p=4$: $(0.52,\\,0.23,\\,0.25;\\,-0.40)$.\n\nTest case B:\n- Orbital energies $\\varepsilon_p$: $[-0.500,\\,-0.500,\\,0.100,\\,0.100,\\,0.600]$ for $p = 0,1,2,3,4$, with occupied $i,j \\in \\{0,1\\}$ and virtual $a,b \\in \\{2,3,4\\}$.\n- Nonzero antisymmetrized two-electron integrals $\\langle ij \\Vert ab \\rangle$:\n  - $(0,1,2,3): 0.060$,\n  - $(0,1,2,4): 0.085$,\n  - $(0,1,3,4): 0.085$.\n  All others are zero.\n- Orbital metadata $(q_{\\mathrm{O}}, q_{\\mathrm{H}_1}, q_{\\mathrm{H}_2}; b_p)$ for $p = 0,1,2,3,4$:\n  - $p=0$: $(0.60,\\,0.20,\\,0.20;\\,0.40)$,\n  - $p=1$: $(0.62,\\,0.19,\\,0.19;\\,0.42)$,\n  - $p=2$: $(0.50,\\,0.25,\\,0.25;\\,-0.45)$,\n  - $p=3$: $(0.48,\\,0.26,\\,0.26;\\,-0.43)$,\n  - $p=4$: $(0.85,\\,0.10,\\,0.05;\\,0.00)$.\n\nTest case C:\n- Orbital energies $\\varepsilon_p$: $[-0.600,\\,-0.480,\\,0.150,\\,0.260,\\,0.500]$ for $p = 0,1,2,3,4$, with occupied $i,j \\in \\{0,1\\}$ and virtual $a,b \\in \\{2,3,4\\}$.\n- No nonzero antisymmetrized two-electron integrals are provided; treat all $\\langle ij \\Vert ab \\rangle$ as zero.\n- Orbital metadata $(q_{\\mathrm{O}}, q_{\\mathrm{H}_1}, q_{\\mathrm{H}_2}; b_p)$ for $p = 0,1,2,3,4$:\n  - $p=0$: $(0.89,\\,0.06,\\,0.05;\\,0.01)$,\n  - $p=1$: $(0.86,\\,0.07,\\,0.07;\\,0.03)$,\n  - $p=2$: $(0.80,\\,0.10,\\,0.10;\\,-0.05)$,\n  - $p=3$: $(0.78,\\,0.11,\\,0.11;\\,-0.08)$,\n  - $p=4$: $(0.60,\\,0.20,\\,0.20;\\,-0.25)$.\n\nFor each test case, produce a result consisting of:\n- The largest absolute doubles amplitude value (dimensionless), rounded to six decimal places,\n- The corresponding quadruple of orbital indices $[i,j,a,b]$ with $i &lt; j$ and $a &lt; b$,\n- The interpretation code $\\kappa$ as defined above.\n\nYour program should produce a single line of output containing the results for all test cases as a comma-separated list enclosed in square brackets, where each test case result is formatted as a list of the three items specified above without any spaces. For example: [[valueA,[iA,jA,aA,bA],kappaA],[valueB,[iB,jB,aB,bB],kappaB],[valueC,[iC,jC,aC,bC],kappaC]].",
            "solution": "The problem requires the calculation and interpretation of coupled cluster doubles amplitudes under a linearized approximation for a closed-shell reference system. This approach is equivalent to second-order Møller-Plesset perturbation theory (MP2). The solution proceeds by first validating the problem statement, which is found to be scientifically sound and well-posed, and then executing the required computational steps for each test case.\n\nThe core of the problem lies in computing the doubles cluster amplitudes, $t_{ij}^{ab}$. In the linearized approximation using a canonical Hartree-Fock basis, the coupled cluster amplitude equations decouple and simplify significantly. For a given excitation from a pair of occupied orbitals with indices $i, j$ to a pair of virtual orbitals with indices $a, b$, the amplitude $t_{ij}^{ab}$ is given by the expression:\n$$\nt_{ij}^{ab} = \\frac{\\langle ij \\Vert ab \\rangle}{D_{ij}^{ab}}\n$$\nwhere $\\langle ij \\Vert ab \\rangle$ is the antisymmetrized two-electron integral in physics notation, and $D_{ij}^{ab}$ is the orbital energy denominator defined as:\n$$\nD_{ij}^{ab} = \\varepsilon_i + \\varepsilon_j - \\varepsilon_a - \\varepsilon_b\n$$\nHere, $\\varepsilon_p$ represents the energy of the canonical molecular orbital with index $p$. The indices $i, j$ are restricted to occupied orbitals, and $a, b$ to virtual orbitals. The amplitudes are computed for all unique index combinations satisfying the constraints $i < j$ and $a < b$. If an integral $\\langle ij \\Vert ab \\rangle$ is not provided, it is assumed to be zero, resulting in a zero amplitude.\n\nFor each test case, the following procedure is implemented:\n1.  All non-zero doubles amplitudes $t_{ij}^{ab}$ are calculated using the provided orbital energies $\\varepsilon_p$ and two-electron integrals $\\langle ij \\Vert ab \\rangle$.\n2.  The absolute values of these amplitudes, $|t_{ij}^{ab}|$, are compared to identify the single amplitude with the largest magnitude. In the event of a tie in magnitude, the tie is resolved by selecting the amplitude corresponding to the index quadruple $(i,j,a,b)$ that is lexicographically smallest.\n3.  Once the dominant amplitude and its associated quadruple $(i,j,a,b)$ are identified, a physical interpretation is derived using the provided orbital metadata, which includes gross atomic population weights $(q_{\\mathrm{O}}, q_{\\mathrm{H}_1}, q_{\\mathrm{H}_2})$ and a bonding indicator $b_p$. This interpretation is determined by a rule-based classifier.\n\nThe classification proceeds in three stages:\nFirst, individual orbitals are categorized based on their metadata. An occupied orbital $p$ is classified by its category $c_p^{\\mathrm{occ}}$:\n- $c_p^{\\mathrm{occ}} = 1$ (lone pair) if $q_{\\mathrm{O}} \\geq 0.8$ and $|b_p| < 0.1$.\n- $c_p^{\\mathrm{occ}} = 2$ (sigma bonding) if $b_p \\geq 0.2$.\n- $c_p^{\\mathrm{occ}} = 0$ otherwise.\nA virtual orbital $p$ is classified by its category $c_p^{\\mathrm{virt}}$:\n- $c_p^{\\mathrm{virt}} = 2$ (sigma antibonding) if $b_p \\leq -0.2$, $q_{\\mathrm{O}} \\geq 0.45$, and $(q_{\\mathrm{H}_1} + q_{\\mathrm{H}_2}) \\geq 0.4$.\n- $c_p^{\\mathrm{virt}} = 3$ (Rydberg-like) if $q_{\\mathrm{O}} \\geq 0.85$ and $|b_p| < 0.1$.\n- $c_p^{\\mathrm{virt}} = 0$ otherwise.\n\nSecond, the orbital pairs $(i,j)$ and $(a,b)$ are classified. The occupied pair category $c_{\\mathrm{occ}}$ is determined from the individual categories $c_i^{\\mathrm{occ}}$ and $c_j^{\\mathrm{occ}}$:\n- If $c_i^{\\mathrm{occ}} = c_j^{\\mathrm{occ}} \\neq 0$, then $c_{\\mathrm{occ}} = c_i^{\\mathrm{occ}}$.\n- Else if $\\{c_i^{\\mathrm{occ}}, c_j^{\\mathrm{occ}}\\} = \\{1,2\\}$, then $c_{\\mathrm{occ}} = 1$.\n- Else $c_{\\mathrm{occ}} = 0$.\nThe virtual pair category $c_{\\mathrm{virt}}$ is determined from $c_a^{\\mathrm{virt}}$ and $c_b^{\\mathrm{virt}}$:\n- If $c_a^{\\mathrm{virt}} = c_b^{\\mathrm{virt}} \\neq 0$, then $c_{\\mathrm{virt}} = c_a^{\\mathrm{virt}}$.\n- Else if $2 \\in \\{c_a^{\\mathrm{virt}}, c_b^{\\mathrm{virt}}\\}$, then $c_{\\mathrm{virt}} = 2$.\n- Else $c_{\\mathrm{virt}} = 0$. This simplified rule is sufficient for the provided test cases as the ambiguous combinations not covered by the problem description do not occur.\n\nFinally, the pair of categories $(c_{\\mathrm{occ}}, c_{\\mathrm{virt}})$ is mapped to a final interpretation code $\\kappa$:\n- $(1,2) \\mapsto 12$\n- $(2,2) \\mapsto 22$\n- $(1,3) \\mapsto 13$\n- Otherwise $\\mapsto 0$.\n\nThis systematic process yields the required three-part result for each test case: the value of the largest absolute amplitude, its corresponding index quadruple, and its interpretation code.",
            "answer": "```python\nimport numpy as np\n\ndef solve():\n    \"\"\"\n    Solves the coupled cluster doubles problem for the given test cases.\n    \"\"\"\n\n    test_cases = [\n        # Test case A\n        {\n            \"energies\": [-0.571, -0.450, 0.120, 0.250, 0.380],\n            \"integrals\": {(0, 1, 2, 3): 0.085, (0, 1, 2, 4): 0.092, (0, 1, 3, 4): 0.078},\n            \"metadata\": [\n                (0.88, 0.06, 0.06, 0.02),  # p=0\n                (0.65, 0.20, 0.15, 0.45),  # p=1\n                (0.55, 0.24, 0.21, -0.50), # p=2\n                (0.90, 0.05, 0.05, -0.05), # p=3\n                (0.52, 0.23, 0.25, -0.40), # p=4\n            ],\n            \"occ_indices\": [0, 1],\n            \"virt_indices\": [2, 3, 4],\n        },\n        # Test case B\n        {\n            \"energies\": [-0.500, -0.500, 0.100, 0.100, 0.600],\n            \"integrals\": {(0, 1, 2, 3): 0.060, (0, 1, 2, 4): 0.085, (0, 1, 3, 4): 0.085},\n            \"metadata\": [\n                (0.60, 0.20, 0.20, 0.40),  # p=0\n                (0.62, 0.19, 0.19, 0.42),  # p=1\n                (0.50, 0.25, 0.25, -0.45), # p=2\n                (0.48, 0.26, 0.26, -0.43), # p=3\n                (0.85, 0.10, 0.05, 0.00),  # p=4\n            ],\n            \"occ_indices\": [0, 1],\n            \"virt_indices\": [2, 3, 4],\n        },\n        # Test case C\n        {\n            \"energies\": [-0.600, -0.480, 0.150, 0.260, 0.500],\n            \"integrals\": {},\n            \"metadata\": [\n                (0.89, 0.06, 0.05, 0.01),  # p=0\n                (0.86, 0.07, 0.07, 0.03),  # p=1\n                (0.80, 0.10, 0.10, -0.05), # p=2\n                (0.78, 0.11, 0.11, -0.08), # p=3\n                (0.60, 0.20, 0.20, -0.25), # p=4\n            ],\n            \"occ_indices\": [0, 1],\n            \"virt_indices\": [2, 3, 4],\n        },\n    ]\n\n    # Helper functions for classification\n    def get_c_p_occ(meta):\n        q_o, _, _, b_p = meta\n        if q_o >= 0.8 and abs(b_p) < 0.1: return 1\n        if b_p >= 0.2: return 2\n        return 0\n\n    def get_c_p_virt(meta):\n        q_o, q_h1, q_h2, b_p = meta\n        if b_p <= -0.2 and q_o >= 0.45 and (q_h1 + q_h2) >= 0.4: return 2\n        if q_o >= 0.85 and abs(b_p) < 0.1: return 3\n        return 0\n\n    def get_c_occ_pair(c_i, c_j):\n        if c_i == c_j and c_i != 0: return c_i\n        if {c_i, c_j} == {1, 2}: return 1\n        return 0\n\n    def get_c_virt_pair(c_a, c_b):\n        if c_a == c_b and c_a != 0: return c_a\n        if 2 in {c_a, c_b}: return 2\n        # The 'Else' clause in the problem is ambiguous but the following is\n        # sufficient for the given test data.\n        if c_a == 0 and c_b == 0: return 0\n        return 0 # Fallback for unhandled ambiguous cases\n\n    def get_kappa(c_occ, c_virt):\n        if (c_occ, c_virt) == (1, 2): return 12\n        if (c_occ, c_virt) == (2, 2): return 22\n        if (c_occ, c_virt) == (1, 3): return 13\n        return 0\n\n    results = []\n    for case in test_cases:\n        energies = case[\"energies\"]\n        integrals = case[\"integrals\"]\n        metadata = case[\"metadata\"]\n        occ = case[\"occ_indices\"]\n        virt = case[\"virt_indices\"]\n\n        amplitudes = []\n        \n        # In this problem, we only have one occupied pair (0,1)\n        i, j = occ[0], occ[1]\n\n        # Iterate over unique virtual pairs a < b\n        from itertools import combinations\n        for a, b in combinations(virt, 2):\n            quad = (i, j, a, b)\n            integral_val = integrals.get(quad, 0.0)\n\n            if integral_val == 0.0:\n                amplitude = 0.0\n            else:\n                denominator = energies[i] + energies[j] - energies[a] - energies[b]\n                if denominator == 0:\n                    # In a real scenario, handle this singularity. Here, we assume it does not happen.\n                    amplitude = float('inf')\n                else:\n                    amplitude = integral_val / denominator\n            \n            amplitudes.append({'val': amplitude, 'quad': list(quad)})\n\n        # If no amplitudes were generated (e.g., if integrals dict was empty), handle it\n        if not amplitudes:\n            # All integrals are zero, so all amplitudes are zero.\n            # Pick the lexicographically smallest quad.\n            i, j = occ[0], occ[1]\n            a, b = virt[0], virt[1]\n            best_amplitude = {'val': 0.0, 'quad': [i, j, a, b]}\n        else:\n            # Find the amplitude with the largest absolute value\n            best_amplitude = max(amplitudes, key=lambda x: (abs(x['val']), tuple(-y for y in x['quad'])))\n\n        # Classification\n        best_quad = best_amplitude['quad']\n        i, j, a, b = best_quad\n        \n        c_i_occ = get_c_p_occ(metadata[i])\n        c_j_occ = get_c_p_occ(metadata[j])\n        c_occ = get_c_occ_pair(c_i_occ, c_j_occ)\n\n        c_a_virt = get_c_p_virt(metadata[a])\n        c_b_virt = get_c_p_virt(metadata[b])\n        c_virt = get_c_virt_pair(c_a_virt, c_b_virt)\n        \n        kappa = get_kappa(c_occ, c_virt)\n\n        # Format individual result\n        amp_val = abs(best_amplitude['val'])\n        res_list = [f\"{amp_val:.6f}\", str(best_quad).replace(\" \", \"\"), str(kappa)]\n        results.append(f\"[{','.join(res_list)}]\")\n\n    # Final print statement\n    print(f\"[{','.join(results)}]\")\n\nsolve()\n```"
        }
    ]
}