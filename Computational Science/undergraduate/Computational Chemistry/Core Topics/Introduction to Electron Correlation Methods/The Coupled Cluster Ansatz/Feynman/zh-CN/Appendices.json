{
    "hands_on_practices": [
        {
            "introduction": "要真正掌握耦合簇（Coupled Cluster）方法，我们必须首先理解其基本构成单元——簇幅（cluster amplitudes）。本实践将引导你通过一个基本的推导，来计算不同截断级别CC方法（如CCSD、CCSDT）中独立簇幅的数量，揭示其计算成本如何随理论水平的提升而急剧增加。这个练习将让你对量子化学“黄金标准”背后的复杂性有一个切实的感受。",
            "id": "2464079",
            "problem": "考虑一个铍原子，在自旋轨道基下处理，其闭壳层限制性Hartree–Fock参考行列式记为 $|\\Phi_{0}\\rangle$。设总电子数为 $N=4$，参考态中的占据自旋轨道数为 $n_{o}=4$，虚拟自旋轨道数为 $n_{v}=L-4$，其中 $L$ 是单电子基中自旋轨道的总数。在自旋轨道层面（非自旋匹配）进行计算，并假设所有自旋轨道都是标准正交的。\n\n1) 使用组态相互作用 (CI) 的定义，将这个 $N=4$ 体系的全组态相互作用 (FCI) 波函数，示意性地写成一个由Slater行列式构成的线性组合。这些Slater行列式是通过将电子从占据自旋轨道激发到虚拟自旋轨道，基于 $|\\Phi_{0}\\rangle$ 构建的。你的示意性表达式应明确展示出激发阶数以及相关的指标结构，直至 $N=4$ 所允许的最大激发阶数。\n\n2) 使用耦合簇 (CC) 拟设 $|\\Psi\\rangle=\\exp(\\hat{T})|\\Phi_{0}\\rangle$ 的定义，其中簇算符为 $\\hat{T}=\\hat{T}_{1}+\\hat{T}_{2}+\\hat{T}_{3}+\\hat{T}_{4}$，对于这个 $N=4$ 体系，请指出在单双激发耦合簇 (CCSD)、单双三激发耦合簇 (CCSDT) 和单双三四激发耦合簇 (CCSDTQ) 中，分别保留了哪些激发流形。\n\n3) 在自旋轨道表象中，通过第一性原理对独立的反对称化振幅进行计数，推导这个铍体系在CCSD、CCSDT和CCSDTQ方法中各自包含的独立簇振幅总数的闭合形式表达式（用 $n_{v}$ 表示）。将你的最终结果表示为一个单行向量 $\\big(N_{\\mathrm{CCSD}},\\,N_{\\mathrm{CCSDT}},\\,N_{\\mathrm{CCSDTQ}}\\big)$，其中每个条目都是一个关于 $n_{v}$ 的闭合形式解析表达式。你的最终答案应不带单位。如果你对 $n_{v}$ 做了任何约束假设，请明确说明；你的表达式必须对于任何整数 $n_{v}\\ge 0$ 在代数上均有效。",
            "solution": "问题陈述已经过严格验证，被认为是科学上可靠、定义明确且客观的。它提出了一个理论和计算化学中的标准、可解问题，没有矛盾或含糊之处。我们将提供一个完整的解答。\n\n该问题考虑一个有 $N=4$ 个电子的铍原子。参考态 $|\\Phi_{0}\\rangle$ 是基态Hartree-Fock行列式，它有 $n_{o}=4$ 个占据自旋轨道。我们用 {$i, j, k, l, \\dots$} 表示占据自旋轨道的指标集，用 {$a, b, c, d, \\dots$} 表示虚拟自旋轨道的指标集。虚拟自旋轨道的数量为 $n_{v}$。\n\n**1) 全组态相互作用 (FCI) 波函数**\n\n全组态相互作用 (FCI) 波函数 $|\\Psi_{\\text{FCI}}\\rangle$ 是在给定单电子基组内，非相对论性薛定谔方程的精确解。它是通过将 $N$ 个电子分配到所有可用的自旋轨道中，所能形成的所有可能的Slater行列式的线性组合。对于一个 $N$-电子体系，这个展开式可以相对于参考行列式 $|\\Phi_{0}\\rangle$ 按激发阶数来组织。可能的最大激发阶数为 $N$。\n\n对于当前 $N=4$ 的体系，FCI波函数包括参考行列式（零激发），以及所有单、双、三和四重激发的行列式。设 $|\\Phi_{i_{1}\\dots i_{k}}^{a_{1}\\dots a_{k}}\\rangle$ 表示一个Slater行列式，其中来自占据自旋轨道 {$i_{1}, \\dots, i_{k}$} 的电子被提升到了虚拟自旋轨道 {$a_{1}, \\dots, a_{k}$}。FCI波函数可以示意性地写为：\n$$\n|\\Psi_{\\text{FCI}}\\rangle = c_{0}|\\Phi_{0}\\rangle + \\sum_{k=1}^{N} |\\Psi_{k}\\rangle\n$$\n其中 $|\\Psi_{k}\\rangle$ 代表所有 $k$ 重激发组态的贡献。对于 $N=4$ 的情况，这变为：\n$$\n|\\Psi_{\\text{FCI}}\\rangle = c_{0}|\\Phi_{0}\\rangle + \\sum_{i,a} c_{i}^{a} |\\Phi_{i}^{a}\\rangle + \\sum_{\\substack{i<j \\\\ a<b}} c_{ij}^{ab} |\\Phi_{ij}^{ab}\\rangle + \\sum_{\\substack{i<j<k \\\\ a<b<c}} c_{ijk}^{abc} |\\Phi_{ijk}^{abc}\\rangle + \\sum_{\\substack{i<j<k<l \\\\ a<b<c<d}} c_{ijkl}^{abcd} |\\Phi_{ijkl}^{abcd}\\rangle\n$$\n求和指标 $i,j,k,l$ 遍历 $n_{o}=4$ 个占据自旋轨道，而指标 $a,b,c,d$ 遍历 $n_{v}$ 个虚拟自旋轨道。有序的求和指标确保每个不同的行列式只被包含一次。由于 $n_{o}=4$，对 $i<j<k<l$ 的最终求和对于占据指标只有一个项，这对应于将所有四个电子从占据空间中激发出来。\n\n**2) 耦合簇 (CC) 理论中的激发流形**\n\n耦合簇 (CC) 波函数由拟设 $|\\Psi_{\\text{CC}}\\rangle = \\exp(\\hat{T})|\\Phi_{0}\\rangle$ 定义，其中簇算符 $\\hat{T}$ 是一系列激发算符的和：\n$$\n\\hat{T} = \\hat{T}_{1} + \\hat{T}_{2} + \\hat{T}_{3} + \\dots + \\hat{T}_{N}\n$$\n算符 $\\hat{T}_{k}$ 从参考行列式中创建所有 $k$ 重激发：\n$$\n\\hat{T}_{k} = \\sum_{\\substack{i_{1}<\\dots<i_{k} \\\\ a_{1}<\\dots<a_{k}}} t_{i_{1}\\dots i_{k}}^{a_{1}\\dots a_{k}} \\hat{\\tau}_{i_{1}\\dots i_{k}}^{a_{1}\\dots a_{k}}\n$$\n其中 $t_{i_{1}\\dots i_{k}}^{a_{1}\\dots a_{k}}$ 是簇振幅，而 $\\hat{\\tau}_{i_{1}\\dots i_{k}}^{a_{1}\\dots a_{k}}$是相应的激发算符。对精确CC理论（等价于FCI）的近似是通过截断簇算符 $\\hat{T}$ 来实现的。\n\n- **单双激发耦合簇 (CCSD):** 在此方法中，簇算符被截断为只包含单激发和双激发：$\\hat{T} \\approx \\hat{T}_{\\text{CCSD}} = \\hat{T}_{1} + \\hat{T}_{2}$。因此，*在簇算符中保留的*激发流形是单激发和双激发的流形。值得注意的是，由于指数形式的存在，得到的CCSD波函数 $|\\Psi_{\\text{CCSD}}\\rangle = \\exp(\\hat{T}_{1}+\\hat{T}_{2})|\\Phi_{0}\\rangle$ 包含了高于双激发的贡献（例如，$\\frac{1}{2}\\hat{T}_{2}^{2}|\\Phi_{0}\\rangle$ 会产生四重激发行列式）。\n\n- **单双三激发耦合簇 (CCSDT):** 在这里，簇算符被截断到三重激发：$\\hat{T} \\approx \\hat{T}_{\\text{CCSDT}} = \\hat{T}_{1} + \\hat{T}_{2} + \\hat{T}_{3}$。在算符中保留的流形是单激发、双激发和三激发。\n\n- **单双三四激发耦合簇 (CCSDTQ):** 该模型在簇算符中包含直至四重激发：$\\hat{T} \\approx \\hat{T}_{\\text{CCSDTQ}} = \\hat{T}_{1} + \\hat{T}_{2} + \\hat{T}_{3} + \\hat{T}_{4}$。对于一个 $N=4$ 电子体系，这是可能的最高激发级别，因此CCSDTQ等价于FCI。在算符中保留的流形是单激发、双激发、三激发和四激发。\n\n**3) 独立簇振幅的数量**\n\n在自旋轨道表述中，$\\hat{T}_k$ 算符的独立、非冗余簇振幅的数量，由从 $n_{o}$ 个占据自旋轨道中选择 $k$ 个不同轨道和从 $n_{v}$ 个虚拟自旋轨道中选择 $k$ 个不同轨道的方式数决定。这是一个标准的组合计算，由两个二项式系数的乘积给出：\n$$\nN_{k} = \\binom{n_{o}}{k} \\binom{n_{v}}{k}\n$$\n问题指定 $n_{o}=4$。推导出的表达式必须对任何非负整数 $n_{v}$ 都有效。二项式系数 $\\binom{n}{k}$ 在 $k>n$ 时为零，我们的最终多项式表达式将固有地遵守这一属性。\n\n每个激发级别的振幅数量为：\n- 单激发 ($\\hat{T}_{1}$): $N_{1} = \\binom{4}{1} \\binom{n_{v}}{1} = 4 \\cdot n_{v} = 4n_{v}$\n- 双激发 ($\\hat{T}_{2}$): $N_{2} = \\binom{4}{2} \\binom{n_{v}}{2} = \\frac{4 \\cdot 3}{2} \\cdot \\frac{n_{v}(n_{v}-1)}{2} = 6 \\cdot \\frac{n_{v}^{2}-n_{v}}{2} = 3(n_{v}^{2}-n_{v})$\n- 三激发 ($\\hat{T}_{3}$): $N_{3} = \\binom{4}{3} \\binom{n_{v}}{3} = 4 \\cdot \\frac{n_{v}(n_{v}-1)(n_{v}-2)}{6} = \\frac{2}{3} n_{v}(n_{v}-1)(n_{v}-2)$\n- 四激发 ($\\hat{T}_{4}$): $N_{4} = \\binom{4}{4} \\binom{n_{v}}{4} = 1 \\cdot \\frac{n_{v}(n_{v}-1)(n_{v}-2)(n_{v}-3)}{24} = \\frac{1}{24} n_{v}(n_{v}-1)(n_{v}-2)(n_{v}-3)$\n\n每种CC方法的总振幅数是所包含的激发级别的计数总和。\n\n- **CCSD中的总振幅数 ($N_{\\mathrm{CCSD}}$):**\n$$\nN_{\\mathrm{CCSD}} = N_{1} + N_{2} = 4n_{v} + 3(n_{v}^{2}-n_{v}) = 4n_{v} + 3n_{v}^{2} - 3n_{v} = 3n_{v}^{2} + n_{v} = n_{v}(3n_{v}+1)\n$$\n\n- **CCSDT中的总振幅数 ($N_{\\mathrm{CCSDT}}$):**\n$$\nN_{\\mathrm{CCSDT}} = N_{\\mathrm{CCSD}} + N_{3} = (3n_{v}^{2} + n_{v}) + \\frac{2}{3} (n_{v}^{3} - 3n_{v}^{2} + 2n_{v})\n$$\n$$\nN_{\\mathrm{CCSDT}} = \\frac{2}{3}n_{v}^{3} + (3-2)n_{v}^{2} + (1+\\frac{4}{3})n_{v} = \\frac{2}{3}n_{v}^{3} + n_{v}^{2} + \\frac{7}{3}n_{v} = \\frac{n_{v}}{3}(2n_{v}^{2} + 3n_{v} + 7)\n$$\n\n- **CCSDTQ中的总振幅数 ($N_{\\mathrm{CCSDTQ}}$):**\n$$\nN_{\\mathrm{CCSDTQ}} = N_{\\mathrm{CCSDT}} + N_{4} = \\left(\\frac{2}{3}n_{v}^{3} + n_{v}^{2} + \\frac{7}{3}n_{v}\\right) + \\frac{1}{24}(n_{v}^{4} - 6n_{v}^{3} + 11n_{v}^{2} - 6n_{v})\n$$\n$$\nN_{\\mathrm{CCSDTQ}} = \\frac{1}{24}n_{v}^{4} + \\left(\\frac{16}{24}-\\frac{6}{24}\\right)n_{v}^{3} + \\left(\\frac{24}{24}+\\frac{11}{24}\\right)n_{v}^{2} + \\left(\\frac{56}{24}-\\frac{6}{24}\\right)n_{v}\n$$\n$$\nN_{\\mathrm{CCSDTQ}} = \\frac{1}{24}n_{v}^{4} + \\frac{10}{24}n_{v}^{3} + \\frac{35}{24}n_{v}^{2} + \\frac{50}{24}n_{v} = \\frac{n_{v}}{24}(n_{v}^{3} + 10n_{v}^{2} + 35n_{v} + 50)\n$$\n\n最终结果按要求以行向量形式呈现。",
            "answer": "$$\n\\boxed{\n\\begin{pmatrix}\nn_{v}(3n_{v} + 1) & \\frac{n_{v}}{3}(2n_{v}^{2} + 3n_{v} + 7) & \\frac{n_{v}}{24}(n_{v}^{3} + 10n_{v}^{2} + 35n_{v} + 50)\n\\end{pmatrix}\n}\n$$"
        },
        {
            "introduction": "簇幅并不仅仅是抽象的数学参数，它们编码了电子相关的物理信息。这个动手实践要求你在一个简化模型中，为水分子计算最重要的双激发簇幅。通过找出主导的激发并将其与轨道特性联系起来，你将学会如何将CC计算的数学结果转化为一个关于电子如何相互“躲避”的、具有物理意义的化学故事。",
            "id": "2464083",
            "problem": "为您提供一个水分子的闭壳层参考态，该参考态在从相关一致极化价层双ζ基组派生的小活性空间中表示。闭壳层参考态的耦合簇拟设使用指数算符作用于参考行列式，其中簇算符被截断至双激发部分，因此波函数写作 $\\lvert \\Psi \\rangle = e^{\\hat{T}_2} \\lvert \\Phi_0 \\rangle$，其中 $\\hat{T}_2$ 是双激发簇算符，其振幅为 $t_{ij}^{ab}$。考虑正则Hartree-Fock分子轨道，并假设通过忽略簇振幅的二次及更高阶项来对相似变换哈密顿量进行线性化。在这些条件下，双激发振幅的投影方程在正则基中简化为一组解耦的线性关系，这些关系涉及占据轨道指数 $i,j$、虚拟轨道指数 $a,b$、轨道能 $\\varepsilon_p$ 以及以哈特里（Hartree）为单位的反对称化双电子积分 $\\langle ij \\Vert ab \\rangle$。双激发振幅的分母定义为 $D_{ij}^{ab} = \\varepsilon_i + \\varepsilon_j - \\varepsilon_a - \\varepsilon_b$。振幅 $t_{ij}^{ab}$ 是无量纲的。\n\n对于下方的每个测试用例，您将获得：\n- 一组以整数索引的轨道的轨道能 $\\varepsilon_p$ 列表（单位：哈特里），其中前两个指数对应占据轨道 $i,j$，其余指数对应虚拟轨道 $a,b$。\n- 一组非零反对称化双电子积分 $\\langle ij \\Vert ab \\rangle$（单位：哈特里），适用于 $i < j$ 和 $a < b$ 的唯一指数组合。任何未明确列出的积分均为零。\n- 每个轨道的辅助元数据，由原子 $(\\mathrm{O}, \\mathrm{H}_1, \\mathrm{H}_2)$ 上的总布居权重三元组（对于占据轨道，其和为1；对于虚拟轨道，其和约等于1）和一个标量成键指示符 $b_p$（无量纲）组成，该指示符为正表示成键特性，为负表示反键特性，接近零表示非键或里德堡类似特性。\n\n您在每个测试用例中的任务是：\n1. 使用正则基中的线性化耦合簇双激发方程计算所有双激发振幅 $t_{ij}^{ab}$。对于每个满足 $i < j$ 和 $a < b$ 的唯一组合，使用给定数据计算振幅。\n2. 找出绝对值最大的单个振幅。如果出现平局，选择作为整数四元组进行比较时字典序最小的四元组 $(i,j,a,b)$。\n3. 使用以下从提供的轨道元数据派生的基于规则的分类器，对所选激发提供一个具有物理动机的分类解释：\n   - 对于一个占据轨道 $p$，将其类别 $c_p^{\\mathrm{occ}}$ 定义为：\n     - $1$ (孤对电子) 如果 $q_{\\mathrm{O}} \\geq 0.8$ 且 $\\lvert b_p \\rvert < 0.1$,\n     - $2$ (sigma成键) 如果 $b_p \\geq 0.2$,\n     - $0$ 其他情况。\n   - 对于一个虚拟轨道 $p$，将其类别 $c_p^{\\mathrm{virt}}$ 定义为：\n     - $2$ (sigma反键) 如果 $b_p \\leq -0.2$ 且 $q_{\\mathrm{O}} \\geq 0.45$ 且 $(q_{\\mathrm{H}_1} + q_{\\mathrm{H}_2}) \\geq 0.4$,\n     - $3$ (里德堡类似) 如果 $q_{\\mathrm{O}} \\geq 0.85$ 且 $\\lvert b_p \\rvert < 0.1$,\n     - $0$ 其他情况。\n   - 对于一个占据轨道对 $(i,j)$，将 $c_{\\mathrm{occ}}$ 定义为：\n     - 如果 $c_i^{\\mathrm{occ}} = c_j^{\\mathrm{occ}} \\neq 0$，则 $c_{\\mathrm{occ}} = c_i^{\\mathrm{occ}}$,\n     - 否则如果 $\\{c_i^{\\mathrm{occ}}, c_j^{\\mathrm{occ}}\\} = \\{1,2\\}$，则 $c_{\\mathrm{occ}} = 1$,\n     - 否则 $c_{\\mathrm{occ}} = 0$。\n   - 对于一个虚拟轨道对 $(a,b)$，将 $c_{\\mathrm{virt}}$ 定义为：\n     - 如果 $c_a^{\\mathrm{virt}} = c_b^{\\mathrm{virt}} \\neq 0$，则 $c_{\\mathrm{virt}} = c_a^{\\mathrm{virt}}$,\n     - 否则如果 $2 \\in \\{c_a^{\\mathrm{virt}}, c_b^{\\mathrm{virt}}\\}$，则 $c_{\\mathrm{virt}} = 2$,\n     - 否则，如果两者都不是 $3$ 则 $c_{\\mathrm{virt}} = 0$, 或者如果两者都是 $3$ 则 $c_{\\mathrm{virt}} = 3$。\n   - 最后，将 $(c_{\\mathrm{occ}}, c_{\\mathrm{virt}})$ 映射到一个解释代码 $\\kappa$，规则如下：\n     - $(1,2) \\mapsto 12$ (孤对电子到sigma反键),\n     - $(2,2) \\mapsto 22$ (sigma成键到sigma反键),\n     - $(1,3) \\mapsto 13$ (孤对电子到里德堡类似),\n     - 其他情况 $\\mapsto 0$。\n\n使用以下测试套件。在每个用例中，轨道能的单位为哈特里，双电子积分的单位为哈特里，得到的双激发振幅是无量纲的。\n\n测试用例 A:\n- 轨道能 $\\varepsilon_p$: $[-0.571,\\,-0.450,\\,0.120,\\,0.250,\\,0.380]$ for $p = 0,1,2,3,4$, 其中占据轨道 $i,j \\in \\{0,1\\}$，虚拟轨道 $a,b \\in \\{2,3,4\\}$。\n- 非零反对称化双电子积分 $\\langle ij \\Vert ab \\rangle$ 适用于 $i < j$ 和 $a < b$ 的唯一指数四元组 $(i,j,a,b)$:\n  - $(0,1,2,3): 0.085$,\n  - $(0,1,2,4): 0.092$,\n  - $(0,1,3,4): 0.078$.\n  所有其他此类积分均为零。\n- 轨道元数据 $(q_{\\mathrm{O}}, q_{\\mathrm{H}_1}, q_{\\mathrm{H}_2}; b_p)$ for $p = 0,1,2,3,4$:\n  - $p=0$: $(0.88,\\,0.06,\\,0.06;\\,0.02)$,\n  - $p=1$: $(0.65,\\,0.20,\\,0.15;\\,0.45)$,\n  - $p=2$: $(0.55,\\,0.24,\\,0.21;\\,-0.50)$,\n  - $p=3$: $(0.90,\\,0.05,\\,0.05;\\,-0.05)$,\n  - $p=4$: $(0.52,\\,0.23,\\,0.25;\\,-0.40)$.\n\n测试用例 B:\n- 轨道能 $\\varepsilon_p$: $[-0.500,\\,-0.500,\\,0.100,\\,0.100,\\,0.600]$ for $p = 0,1,2,3,4$, 其中占据轨道 $i,j \\in \\{0,1\\}$，虚拟轨道 $a,b \\in \\{2,3,4\\}$。\n- 非零反对称化双电子积分 $\\langle ij \\Vert ab \\rangle$:\n  - $(0,1,2,3): 0.060$,\n  - $(0,1,2,4): 0.085$,\n  - $(0,1,3,4): 0.085$.\n  所有其他均为零。\n- 轨道元数据 $(q_{\\mathrm{O}}, q_{\\mathrm{H}_1}, q_{\\mathrm{H}_2}; b_p)$ for $p = 0,1,2,3,4$:\n  - $p=0$: $(0.60,\\,0.20,\\,0.20;\\,0.40)$,\n  - $p=1$: $(0.62,\\,0.19,\\,0.19;\\,0.42)$,\n  - $p=2$: $(0.50,\\,0.25,\\,0.25;\\,-0.45)$,\n  - $p=3$: $(0.48,\\,0.26,\\,0.26;\\,-0.43)$,\n  - $p=4$: $(0.85,\\,0.10,\\,0.05;\\,0.00)$.\n\n测试用例 C:\n- 轨道能 $\\varepsilon_p$: $[-0.600,\\,-0.480,\\,0.150,\\,0.260,\\,0.500]$ for $p = 0,1,2,3,4$, 其中占据轨道 $i,j \\in \\{0,1\\}$，虚拟轨道 $a,b \\in \\{2,3,4\\}$。\n- 未提供非零反对称化双电子积分；将所有 $\\langle ij \\Vert ab \\rangle$ 视为零。\n- 轨道元数据 $(q_{\\mathrm{O}}, q_{\\mathrm{H}_1}, q_{\\mathrm{H}_2}; b_p)$ for $p = 0,1,2,3,4$:\n  - $p=0$: $(0.89,\\,0.06,\\,0.05;\\,0.01)$,\n  - $p=1$: $(0.86,\\,0.07,\\,0.07;\\,0.03)$,\n  - $p=2$: $(0.80,\\,0.10,\\,0.10;\\,-0.05)$,\n  - $p=3$: $(0.78,\\,0.11,\\,0.11;\\,-0.08)$,\n  - $p=4$: $(0.60,\\,0.20,\\,0.20;\\,-0.25)$.\n\n为每个测试用例生成一个结果，包含：\n- 最大的双激发振幅绝对值（无量纲），四舍五入到六位小数，\n- 对应的轨道指数四元组 $[i,j,a,b]$, 满足 $i < j$ 和 $a < b$,\n- 如上定义的解释代码 $\\kappa$。\n\n您的程序应生成单行输出，其中包含所有测试用例的结果，格式为一个逗号分隔的列表，并用方括号括起来。每个测试用例的结果格式化为包含上述三项的列表，不含任何空格。例如：`[[valueA,[iA,jA,aA,bA],kappaA],[valueB,[iB,jB,aB,bB],kappaB],[valueC,[iC,jC,aC,bC],kappaC]]`。",
            "solution": "该问题要求在一个闭壳层参考体系的线性化近似下，计算和解释耦合簇双激发振幅。此方法等同于二阶Møller-Plesset微扰理论 (MP2)。解决方案首先验证了问题陈述，确认其在科学上是合理且定义明确的，然后为每个测试用例执行所需的计算步骤。\n\n问题的核心在于计算双激发簇振幅 $t_{ij}^{ab}$。在使用正则Hartree-Fock基的线性化近似中，耦合簇振幅方程会显著地解耦和简化。对于从一对指数为 $i, j$ 的占据轨道到一对指数为 $a, b$ 的虚拟轨道的给定激发，振幅 $t_{ij}^{ab}$ 由以下表达式给出：\n$$\nt_{ij}^{ab} = \\frac{\\langle ij \\Vert ab \\rangle}{D_{ij}^{ab}}\n$$\n其中 $\\langle ij \\Vert ab \\rangle$ 是物理学表示法中的反对称化双电子积分，而 $D_{ij}^{ab}$ 是轨道能分母，定义为：\n$$\nD_{ij}^{ab} = \\varepsilon_i + \\varepsilon_j - \\varepsilon_a - \\varepsilon_b\n$$\n在这里，$\\varepsilon_p$ 代表指数为 $p$ 的正则分子轨道的能量。指数 $i, j$ 仅限于占据轨道，而 $a, b$ 仅限于虚拟轨道。振幅是为所有满足约束条件 $i < j$ 和 $a < b$ 的唯一指数组合计算的。如果未提供某个积分 $\\langle ij \\Vert ab \\rangle$，则假定其为零，从而导致振幅为零。\n\n对于每个测试用例，执行以下步骤：\n1.  使用提供的轨道能 $\\varepsilon_p$ 和双电子积分 $\\langle ij \\Vert ab \\rangle$ 计算所有非零双激发振幅 $t_{ij}^{ab}$。\n2.  比较这些振幅的绝对值 $|t_{ij}^{ab}|$，以找出量级最大的单个振幅。如果量级出现平局，则通过选择字典序最小的指数四元组 $(i,j,a,b)$ 对应的振幅来解决。\n3.  一旦确定了主导振幅及其关联的四元组 $(i,j,a,b)$，便使用提供的轨道元数据（包括总原子布居权重 $(q_{\\mathrm{O}}, q_{\\mathrm{H}_1}, q_{\\mathrm{H}_2})$ 和成键指示符 $b_p$）来推导物理解释。此解释由一个基于规则的分类器确定。\n\n分类过程分三个阶段进行：\n首先，根据元数据对单个轨道进行分类。一个占据轨道 $p$ 由其类别 $c_p^{\\mathrm{occ}}$ 分类：\n- $c_p^{\\mathrm{occ}} = 1$ (孤对电子) 如果 $q_{\\mathrm{O}} \\geq 0.8$ 且 $|b_p| < 0.1$。\n- $c_p^{\\mathrm{occ}} = 2$ (sigma成键) 如果 $b_p \\geq 0.2$。\n- $c_p^{\\mathrm{occ}} = 0$ 其他情况。\n一个虚拟轨道 $p$ 由其类别 $c_p^{\\mathrm{virt}}$ 分类：\n- $c_p^{\\mathrm{virt}} = 2$ (sigma反键) 如果 $b_p \\leq -0.2$，$q_{\\mathrm{O}} \\geq 0.45$，且 $(q_{\\mathrm{H}_1} + q_{\\mathrm{H}_2}) \\geq 0.4$。\n- $c_p^{\\mathrm{virt}} = 3$ (里德堡类似) 如果 $q_{\\mathrm{O}} \\geq 0.85$ 且 $|b_p| < 0.1$。\n- $c_p^{\\mathrm{virt}} = 0$ 其他情况。\n\n其次，对轨道对 $(i,j)$ 和 $(a,b)$ 进行分类。占据轨道对类别 $c_{\\mathrm{occ}}$ 由单个类别 $c_i^{\\mathrm{occ}}$ 和 $c_j^{\\mathrm{occ}}$ 决定：\n- 如果 $c_i^{\\mathrm{occ}} = c_j^{\\mathrm{occ}} \\neq 0$, 则 $c_{\\mathrm{occ}} = c_i^{\\mathrm{occ}}$。\n- 否则如果 $\\{c_i^{\\mathrm{occ}}, c_j^{\\mathrm{occ}}\\} = \\{1,2\\}$, 则 $c_{\\mathrm{occ}} = 1$。\n- 否则 $c_{\\mathrm{occ}} = 0$。\n虚拟轨道对类别 $c_{\\mathrm{virt}}$ 由 $c_a^{\\mathrm{virt}}$ 和 $c_b^{\\mathrm{virt}}$ 决定：\n- 如果 $c_a^{\\mathrm{virt}} = c_b^{\\mathrm{virt}} \\neq 0$, 则 $c_{\\mathrm{virt}} = c_a^{\\mathrm{virt}}$。\n- 否则如果 $2 \\in \\{c_a^{\\mathrm{virt}}, c_b^{\\mathrm{virt}}\\}$, 则 $c_{\\mathrm{virt}} = 2$。\n- 否则 $c_{\\mathrm{virt}} = 0$。这个简化的规则对于所提供的测试用例是足够的，因为问题描述中未涵盖的模糊组合不会出现。\n\n最后，将类别对 $(c_{\\mathrm{occ}}, c_{\\mathrm{virt}})$ 映射到最终的解释代码 $\\kappa$：\n- $(1,2) \\mapsto 12$\n- $(2,2) \\mapsto 22$\n- $(1,3) \\mapsto 13$\n- 其他情况 $\\mapsto 0$。\n\n这一系统性过程为每个测试用例生成了所需的三部分结果：最大绝对振幅的值、其对应的指数四元组及其解释代码。",
            "answer": "`[[0.061107,[0,1,2,3],12],[0.050000,[0,1,2,3],22],[0.000000,[0,1,2,3],0]]`"
        },
        {
            "introduction": "更低的总能量并不总是意味着一个量子化学方法更准确。这个思想实验通过比较耦合簇方法（CCSD）和构型相互作用方法（CISD），直面一个常见的误解。通过分析这一情景，你将深入探讨变分原理和尺寸一致性等关键理论概念，从而巩固你对为何CCSD因其可靠性和预测能力而通常更受青睐的理解。",
            "id": "2452131",
            "problem": "一名新研究生报告说，他们实现的单双激发组态相互作用 (CISD) 程序对几个弱关联的闭壳层分子进行计算时，总是得到比实验室的单双激发耦合簇 (CCSD) 程序更低（更负）的基态总能量。两个程序都使用了相同的 Hartree–Fock (HF) 参考行列式、相同的有限轨道基组和可比的数值阈值，并且两个计算都已收敛。该学生因此得出结论，认为 CISD 是更准确的方法，因为它给出了更低的能量。\n\n下列哪个/哪些陈述最好地解释了为什么该学生的结论不一定合理？选择所有适用的选项。\n\nA. 变分原理不保证单双激发耦合簇 (CCSD) 的能量是精确基态能量的一个上界，因此它的能量可以高于或低于其他近似方法的能量，这并不意味着其精度更高或更低。\n\nB. 单双激发组态相互作用 (CISD) 不具有尺寸广延性和尺寸一致性；其总能量不能随体系尺寸正确地标度，且对于无相互作用的碎片不满足可加性。因此，对于一个给定体系，较低的 CISD 总能量并不意味着更高的精度或更广泛的预测可靠性。\n\nC. 如果两个程序使用相同的参考态和基组，变分原理保证 CISD 能量必须低于或等于 CCSD 能量，因此这一观察结果必然证明 CISD 更优越。\n\nD. 单双激发耦合簇 (CCSD) 中的指数拟设 (exponential ansatz) 会产生非关联的高阶激发，这有效地包含了一些三重和四重激发效应，而这些效应在单双激发组态相互作用 (CISD) 中是不存在的；因此，即使在某些情况下 CCSD 的总能量恰好高于 CISD 的总能量，它也能得出更准确的相关能和能量差。\n\nE. 方法质量的唯一有意义的衡量标准是绝对总能量；较低的总能量总是表明该方法比使用相同参考态和基组的任何竞争方法都更准确。",
            "solution": "问题陈述描述了计算化学中的一个情景，并要求对从数值结果中得出的结论进行批判性评估。该设定在科学上是合理的且问题是良定的，为严格分析量子化学方法提供了基础。\n\n学生的基本错误在于，从 $E_{\\text{CISD}} < E_{\\text{CCSD}}$ 的观察结果得出结论，认为单双激发组态相互作用 (CISD) 方法比单双激发耦合簇 (CCSD) 方法更准确。这个结论是基于对变分原理的错误应用以及对量子化学中“准确性”构成要素的误解。\n\n让我们分析这两种方法的理论基础，以揭示该学生推理中的缺陷。两种方法都从一个 Hartree-Fock 参考行列式 $\\Phi_0$ 出发，旨在在给定的单粒子基组内近似电子薛定谔方程的精确基态解，这个问题被称为完全组态相互作用 (FCI)。\n\nCISD 波函数是参考行列式以及所有单激发和双激发 Slater 行列式的线性组合：\n$$ |\\Psi_{\\text{CISD}}\\rangle = c_0 |\\Phi_0\\rangle + \\sum_{i,a} c_i^a |\\Phi_i^a\\rangle + \\sum_{i<j, a<b} c_{ij}^{ab} |\\Phi_{ij}^{ab}\\rangle $$\n系数 $c_0$、$c_i^a$ 和 $c_{ij}^{ab}$ 是通过求解一个矩阵本征值问题来确定的，这等价于最小化能量期望值 $\\langle\\Psi_{\\text{CISD}} | \\hat{H} | \\Psi_{\\text{CISD}}\\rangle / \\langle\\Psi_{\\text{CISD}} | \\Psi_{\\text{CISD}}\\rangle$。根据变分原理，得到的能量 $E_{\\text{CISD}}$ 是给定基组下精确 FCI 能量 $E_{\\text{FCI}}$ 的一个上界：$E_{\\text{CISD}} \\ge E_{\\text{FCI}}$。因此，CISD 是一种变分方法。\n\nCCSD 波函数具有指数拟设 (exponential ansatz)：\n$$ |\\Psi_{\\text{CCSD}}\\rangle = e^{\\hat{T}} |\\Phi_0\\rangle $$\n其中簇算符 $\\hat{T}$ 被限制为单激发和双激发：$\\hat{T} = \\hat{T}_1 + \\hat{T}_2$。簇算符由以下公式给出：\n$$ \\hat{T}_1 = \\sum_{i,a} t_i^a \\hat{a}_a^\\dagger \\hat{a}_i $$\n$$ \\hat{T}_2 = \\sum_{i<j, a<b} t_{ij}^{ab} \\hat{a}_a^\\dagger \\hat{a}_b^\\dagger \\hat{a}_j \\hat{a}_i $$\n能量 $E_{\\text{CCSD}}$ 和振幅 $t_i^a$、$t_{ij}^{ab}$ 是通过求解一组非线性方程组得到的，该方程组由薛定谔方程投影到参考行列式、单激发和双激发行列式上导出：\n$$ E_{\\text{CCSD}} = \\langle\\Phi_0| e^{-\\hat{T}} \\hat{H} e^{\\hat{T}} |\\Phi_0\\rangle $$\n$$ \\langle\\Phi_i^a| e^{-\\hat{T}} \\hat{H} e^{\\hat{T}} |\\Phi_0\\rangle = 0 $$\n$$ \\langle\\Phi_{ij}^{ab}| e^{-\\hat{T}} \\hat{H} e^{\\hat{T}} |\\Phi_0\\rangle = 0 $$\n这个投影过程不对应于能量期望值的最小化。因此，CCSD 方法**不是**变分方法。CCSD 能量 $E_{\\text{CCSD}}$ 不保证是 FCI 能量 $E_{\\text{FCI}}$ 的上界。因此，$E_{\\text{CCSD}}$ 有可能大于，甚至在某些情况下小于 $E_{\\text{FCI}}$。与当前问题更相关的是，我们不能直接使用“能量越低越好”这个简单规则来比较 $E_{\\text{CISD}}$ 和 $E_{\\text{CCSD}}$，因为这个规则只有在比较两种变分方法时才有意义。\n\n以此为基础，我们来评估每个陈述。\n\n**A. 变分原理不保证单双激发耦合簇 (CCSD) 的能量是精确基态能量的一个上界，因此它的能量可以高于或低于其他近似方法的能量，这并不意味着其精度更高或更低。**\n这个陈述在事实上是正确的。如上所推导，CCSD 是一种投影方法，而不是变分方法。其能量不是精确能量 $E_{\\text{FCI}}$ 的上界。因此，实验室程序得到的 $E_{\\text{CCSD}}$ 高于学生得到的 $E_{\\text{CISD}}$ 这一事实，本身并不表示其精度更低。该陈述正确地指出了学生对结果的简单化解释中的一个主要缺陷。\n**结论：正确**\n\n**B. 单双激发组态相互作用 (CISD) 不具有尺寸广延性和尺寸一致性；其总能量不能随体系尺寸正确地标度，且对于无相互作用的碎片不满足可加性。因此，对于一个给定体系，较低的 CISD 总能量并不意味着更高的精度或更广泛的预测可靠性。**\n这个陈述在事实上也是正确的，并指出了 CISD 方法的一个关键缺陷。尺寸广延性要求一个由 $N$ 个无相互作用的相同子系统组成的体系的能量是单个子系统能量的 $N$ 倍。像 CISD 这样的截断 CI 方法未能通过此测试。例如，对于两个无相互作用的分子 A 和 B，$E_{\\text{CISD}}(A+B) \\neq E_{\\text{CISD}}(A) + E_{\\text{CISD}}(B)$。这种不符合物理的标度行为使得 CISD 在描述键解离、分子间相互作用以及较大体系的性质时是不可靠的。相比之下，CCSD 具有尺寸广延性。因此，即使 CISD 对某个特定的小分子产生了更低的总能量，这个结果也不意味着 CISD 是一个更可靠或更普适的方法。预测的可靠性是比单个态的绝对能量更重要的质量衡量标准。\n**结论：正确**\n\n**C. 如果两个程序使用相同的参考态和基组，变分原理保证 CISD 能量必须低于或等于 CCSD 能量，因此这一观察结果必然证明 CISD 更优越。**\n这个陈述是根本错误的。变分原理没有对变分能量 ($E_{\\text{CISD}}$) 与非变分能量 ($E_{\\text{CCSD}}$) 的比较做出任何陈述。没有任何定理能保证 $E_{\\text{CISD}} \\le E_{\\text{CCSD}}$ 或 $E_{\\text{CCSD}} \\le E_{\\text{CISD}}$。前提是错误的。此外，该观察“证明了 CISD 更优越”的结论正是学生错误逻辑的体现。\n**结论：不正确**\n\n**D. 单双激发耦合簇 (CCSD) 中的指数拟设 (exponential ansatz) 会产生非关联的高阶激发，这有效地包含了一些三重和四重激发效应，而这些效应在单双激发组态相互作用 (CISD) 中是不存在的；因此，即使在某些情况下 CCSD 的总能量恰好高于 CISD 的总能量，它也能得出更准确的相关能和能量差。**\n这是对 CCSD 优越性能的一个准确而深入的解释。指数算符 $e^{\\hat{T}} = 1 + \\hat{T} + \\frac{1}{2!}\\hat{T}^2 + \\ldots$ 的泰勒展开显示，簇算符的乘积会从参考态生成更高阶的激发。具体来说，像 $\\frac{1}{2}\\hat{T}_2^2$ 这样的项会产生四重激发，而 $\\hat{T}_1 \\hat{T}_2$ 则会产生三重激发。这些就是所谓的“非关联”激发，它们对于确保尺寸广延性和捕获更大部分的电子相关能至关重要。根据其构造，线性的 CISD 波函数不包含激发级别高于二的行列式的贡献。包含这些重要的高阶相关效应，是为什么 CCSD 在计算与化学相关的能量差（例如，反应能、活化能）时通常比 CISD 精确得多的原因，无论在单点计算中它们总能量的相对顺序如何。\n**结论：正确**\n\n**E. 方法质量的唯一有意义的衡量标准是绝对总能量；较低的总能量总是表明该方法比使用相同参考态和基组的任何竞争方法都更准确。**\n这个陈述是一个危险的过度简化，并且是明显错误的。首先，如前所述，“能量越低越好”的启发式规则仅适用于比较变分方法。其次，绝对总能量很少是化学研究中感兴趣的量。精度更常通过正确预测能量差、分子性质和势能面的能力来评判。一个方法的质量还取决于像尺寸广延性这样的形式属性，这些属性保证了正确的物理行为。这个陈述反映了学生天真的、不正确的前提。\n**结论：不正确**\n\n总之，该学生的结论是不合理的，因为 CCSD 是非变分的，CISD 不具有尺寸广延性，并且 CCSD 包含了 CISD 中所没有的重要高阶激发效应。CISD 得到的更低的总能量并不是其精度更高的可靠指标。",
            "answer": "$$\\boxed{ABD}$$"
        }
    ]
}