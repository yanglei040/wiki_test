{
    "hands_on_practices": [
        {
            "introduction": "The power of Configuration Interaction (CI) comes from its systematic approach to improving upon the Hartree-Fock approximation. Before diving into the mechanics, it's crucial to understand the scale of the problem. This foundational exercise guides you through the combinatorics of constructing a Full CI wavefunction, revealing why this 'gold standard' method is only computationally feasible for the smallest of molecular systems . Calculating the size of the CI space is the first step in appreciating the trade-off between accuracy and computational cost.",
            "id": "1360584",
            "problem": "In a quantum chemical calculation, the electronic structure of a molecule is investigated using an orbital-based method. The system contains a total of $N$ electrons. The specific electronic state being studied is characterized by a well-defined value of the total spin projection, resulting in $N_{\\alpha}$ electrons with spin-up ('alpha') and $N_{\\beta}$ electrons with spin-down ('beta'), where $N = N_{\\alpha} + N_{\\beta}$. The calculation employs a set of basis functions that yields $M$ distinct spatial orbitals.\n\nTo achieve the highest accuracy within this orbital framework, a Full Configuration Interaction (CI) calculation is performed. In this method, the total electronic wavefunction is expressed as a linear combination of all possible Slater determinants that can be constructed by distributing the $N$ electrons among the available orbitals, consistent with the specified spin state.\n\nDerive a general expression for the total number of unique Slater determinants that constitute the basis for this Full CI calculation. Express your answer in terms of $M$, $N_{\\alpha}$, and $N_{\\beta}$.",
            "solution": "A Slater determinant is specified by the set of occupied spin orbitals. Given $M$ spatial orbitals, there are $2M$ spin orbitals obtained by combining each spatial orbital with the two spin functions $\\alpha$ and $\\beta$. The specified spin state fixes the spin projection, so there must be exactly $N_{\\alpha}$ electrons with spin $\\alpha$ and $N_{\\beta}$ electrons with spin $\\beta$, with $N=N_{\\alpha}+N_{\\beta}$.\n\nDue to the Pauli principle, each spin orbital can be occupied by at most one electron. Occupation of the same spatial orbital by one $\\alpha$ and one $\\beta$ electron is allowed because they are distinct spin orbitals. Therefore, the counting proceeds independently for $\\alpha$ and $\\beta$ spins:\n- Choose which $N_{\\alpha}$ $\\alpha$-spin orbitals are occupied from the $M$ available $\\alpha$ spin orbitals: this gives $\\binom{M}{N_{\\alpha}}$ possibilities.\n- Choose which $N_{\\beta}$ $\\beta$-spin orbitals are occupied from the $M$ available $\\beta$ spin orbitals: this gives $\\binom{M}{N_{\\beta}}$ possibilities.\n\nSince these choices are independent, the total number of distinct Slater determinants in the Full CI space at fixed $N_{\\alpha}$ and $N_{\\beta}$ is the product\n$$\n\\binom{M}{N_{\\alpha}} \\binom{M}{N_{\\beta}}.\n$$\nThis counts each unique occupation pattern exactly once, consistent with the fixed spin projection.",
            "answer": "$$\\boxed{\\binom{M}{N_{\\alpha}} \\binom{M}{N_{\\beta}}}$$"
        },
        {
            "introduction": "At the heart of the CI method is the concept that the true wavefunction is a mixture of different electronic configurations. This mixing is governed by the matrix elements of the Hamiltonian between different configuration state functions (CSFs). This practice provides a concrete example of this principle by asking you to derive a key off-diagonal matrix element for a simple two-electron system, showing exactly how the electron-electron interaction term couples the ground state with an excited state .",
            "id": "1175157",
            "problem": "Consider a two-electron atom with nuclear charge $Z$ (e.g., Helium). In the Configuration Interaction (CI) method, the exact wave function is approximated as a linear combination of Configuration State Functions (CSFs). We will consider a minimal CI expansion involving only two CSFs.\n\nThe first CSF, $\\Phi_0$, is the ground-state configuration built from a real, normalized spatial orbital $\\phi_{1s}$. The second CSF, $\\Phi_1$, is a doubly-excited configuration built from a different real, normalized spatial orbital $\\phi_{2s}$. The spatial orbitals $\\phi_{1s}$ and $\\phi_{2s}$ are taken to be orthonormal, i.e., $\\langle \\phi_{1s} | \\phi_{2s} \\rangle = 0$.\n\nThe two CSFs are singlets, represented by the following Slater determinants:\n$$\n\\Phi_0 = \\frac{1}{\\sqrt{2}}\n\\begin{vmatrix}\n\\phi_{1s}(\\mathbf{r}_1)\\alpha(\\sigma_1) & \\phi_{1s}(\\mathbf{r}_1)\\beta(\\sigma_1) \\\\\n\\phi_{1s}(\\mathbf{r}_2)\\alpha(\\sigma_2) & \\phi_{1s}(\\mathbf{r}_2)\\beta(\\sigma_2)\n\\end{vmatrix}\n= | \\phi_{1s} \\overline{\\phi_{1s}} |\n$$\n$$\n\\Phi_1 = \\frac{1}{\\sqrt{2}}\n\\begin{vmatrix}\n\\phi_{2s}(\\mathbf{r}_1)\\alpha(\\sigma_1) & \\phi_{2s}(\\mathbf{r}_1)\\beta(\\sigma_1) \\\\\n\\phi_{2s}(\\mathbf{r}_2)\\alpha(\\sigma_2) & \\phi_{2s}(\\mathbf{r}_2)\\beta(\\sigma_2)\n\\end{vmatrix}\n= | \\phi_{2s} \\overline{\\phi_{2s}} |\n$$\nHere, $\\alpha$ and $\\beta$ are the orthonormal spin functions.\n\nThe non-relativistic Hamiltonian for this system in atomic units is:\n$$\nH = h(1) + h(2) + \\frac{1}{r_{12}}\n$$\nwhere $h(i) = -\\frac{1}{2}\\nabla_i^2 - \\frac{Z}{r_i}$ is the one-electron Hamiltonian for electron $i$, and $\\frac{1}{r_{12}}$ is the electron-electron repulsion operator.\n\nThe two-electron repulsion integrals are defined using the Mulliken notation:\n$$\n(pq|rs) = \\iint \\phi_p(\\mathbf{r}_1) \\phi_q(\\mathbf{r}_1) \\frac{1}{r_{12}} \\phi_r(\\mathbf{r}_2) \\phi_s(\\mathbf{r}_2) \\,d\\mathbf{r}_1 d\\mathbf{r}_2\n$$\nAssume that the specific exchange-type integral involving all four orbital indices is given by the symbol $K_{12} = (1s \\, 2s | 1s \\, 2s)$.\n\nDerive an expression for the off-diagonal element of the CI matrix, $H_{01} = \\langle \\Phi_0 | H | \\Phi_1 \\rangle$, in terms of the provided integral symbol $K_{12}$.",
            "solution": "We wish to compute the CI off-diagonal matrix element $H_{01}=\\langle\\Phi_0|\\hat{H}|\\Phi_1\\rangle$. Since the configurations differ by two orbitals, the one-electron part of the Hamiltonian gives no contribution due to the orthogonality of the orbitals. We only need to consider the electron-electron repulsion term:\n$$H_{01} = \\langle\\Phi_0|\\frac{1}{r_{12}}|\\Phi_1\\rangle$$\nThe problem states that the CSFs are represented by single Slater determinants. Using the Slater-Condon rules for two determinants that differ by a double excitation from spin-orbitals $(\\phi_{1s}\\alpha, \\phi_{1s}\\beta)$ to $(\\phi_{2s}\\alpha, \\phi_{2s}\\beta)$, the matrix element is given directly by the corresponding two-electron integral over the spatial orbitals:\n$$H_{01} = \\iint \\phi_{1s}(\\mathbf{r}_1)\\phi_{2s}(\\mathbf{r}_1) \\frac{1}{r_{12}} \\phi_{1s}(\\mathbf{r}_2)\\phi_{2s}(\\mathbf{r}_2) \\,d\\mathbf{r}_1 d\\mathbf{r}_2$$\nIn Mulliken notation, this is the integral $(1s\\,2s|1s\\,2s)$. The problem defines this specific integral with the symbol $K_{12}$.\nTherefore,\n$$H_{01}=K_{12}$$",
            "answer": "$$\\boxed{K_{12}}$$"
        },
        {
            "introduction": "Once the CI matrix is conceptually constructed, we face a major practical hurdle: its sheer size. For most chemical systems, this matrix is too enormous to solve by direct diagonalization. This exercise introduces you to the Davidson algorithm, a powerful iterative method designed specifically to find the lowest eigenvalues of the large, diagonally dominant matrices typical of CI calculations . Working through one iteration will give you a hands-on feel for the numerical ingenuity that makes large-scale CI computations possible.",
            "id": "159291",
            "problem": "In Configuration Interaction (CI) calculations, one often needs to find the lowest eigenvalue (ground state energy) and corresponding eigenvector (ground state wavefunction) of a very large, sparse, and diagonally dominant Hamiltonian matrix, $\\mathbf{H}$. The Davidson diagonalization algorithm is an iterative method particularly well-suited for this task. It works by building a small subspace, diagonalizing the Hamiltonian in that subspace, and using the result to generate a correction vector that is used to expand the subspace for the next iteration.\n\nConsider a simple three-state CI problem described by the following symmetric Hamiltonian matrix $\\mathbf{H}$, where $\\Delta$ and $V$ are positive real-valued energy parameters:\n$$\n\\mathbf{H} = \\begin{pmatrix} 0 & V & V \\\\ V & \\Delta & 0 \\\\ V & 0 & \\Delta \\end{pmatrix}\n$$\nYour task is to perform one full iteration of the Davidson algorithm to find an improved estimate for the lowest energy eigenvalue.\n\nStart with a normalized initial guess vector $\\mathbf{b}_1$, corresponding to the configuration with the lowest diagonal energy:\n$$\n\\mathbf{b}_1 = \\begin{pmatrix} 1 \\\\ 0 \\\\ 0 \\end{pmatrix}\n$$\nThis vector forms the initial subspace.\n\nThe algorithm proceeds as follows:\n1.  **Subspace diagonalisation (0-th iteration):** The initial approximation for the eigenvalue, $\\theta^{(0)}$, is the Rayleigh quotient for $\\mathbf{b}_1$: $\\theta^{(0)} = \\mathbf{b}_1^\\dagger \\mathbf{H} \\mathbf{b}_1$. The corresponding eigenvector approximation is $\\mathbf{c}^{(0)} = \\mathbf{b}_1$.\n2.  **Residual calculation:** Compute the residual vector $\\mathbf{r} = (\\mathbf{H} - \\theta^{(0)} \\mathbf{I}) \\mathbf{c}^{(0)}$.\n3.  **Correction vector:** Compute the correction vector $\\delta\\mathbf{c}$. Each component is given by $\\delta c_i = - r_i / (H_{ii} - \\theta^{(0)})$. If a diagonal element $H_{ii}$ happens to be equal to $\\theta^{(0)}$, the corresponding component $\\delta c_i$ is set to zero.\n4.  **Subspace expansion:** Orthogonalize the correction vector $\\delta\\mathbf{c}$ against the current basis vectors (in this case, just $\\mathbf{b}_1$) using the Gram-Schmidt procedure. Normalize the resulting vector to obtain the new basis vector, $\\mathbf{b}_2$.\n5.  **New subspace problem:** Construct the new $2 \\times 2$ subspace Hamiltonian matrix $\\mathbf{A}$ with elements $A_{ij} = \\mathbf{b}_i^\\dagger \\mathbf{H} \\mathbf{b}_j$ for $i,j \\in \\{1, 2\\}$.\n6.  **Final result:** Solve the eigenvalue problem for the matrix $\\mathbf{A}$. The lowest eigenvalue of $\\mathbf{A}$ is the updated estimate for the ground state energy.\n\nFind the lowest eigenvalue of the subspace matrix $\\mathbf{A}$ after this first full iteration. Express your answer as a symbolic expression in terms of $\\Delta$ and $V$.",
            "solution": "1. Subspace diagonalisation:\n$$\\theta^{(0)} = \\mathbf{b}_1^\\dagger \\mathbf{H} \\mathbf{b}_1 = (1,0,0)\\begin{pmatrix}0\\\\V\\\\V\\end{pmatrix}=0,\\qquad \\mathbf{c}^{(0)}=\\mathbf{b}_1.$$\n\n2. Residual:\n$$\\mathbf{r}=(\\mathbf{H} - \\theta^{(0)}\\mathbf{I})\\mathbf{c}^{(0)}\n=\\mathbf{H}(1,0,0)^\\mathsf{T}=(0,V,V)^\\mathsf{T}.$$\n\n3. Correction vector:\nFor $i=1$: $H_{11}-\\theta^{(0)}=0\\implies\\delta c_1=0.$  \nFor $i=2,3$: $H_{ii}-\\theta^{(0)}=\\Delta\\implies\\delta c_{2,3}=-\\frac{V}{\\Delta}.$  \nThus\n$$\\delta\\mathbf{c}=\\begin{pmatrix}0\\\\-V/\\Delta\\\\-V/\\Delta\\end{pmatrix}.$$\n\n4. Orthogonalisation and normalisation:\n$\\mathbf{b}_1^\\dagger\\delta\\mathbf{c}=0$, so the vector is already orthogonal to $\\mathbf{b}_1$.  \nThe norm squared is $\\|\\delta\\mathbf{c}\\|^2 = 2(V/\\Delta)^2$, so $\\|\\delta\\mathbf{c}\\|=\\sqrt{2}V/\\Delta.$  \nWe normalize and choose a positive phase for the first non-zero component to get:\n$$\\mathbf{b}_2=\\frac{\\delta\\mathbf{c}}{\\|\\delta\\mathbf{c}\\|} \\times (-1)\n=\\begin{pmatrix}0\\\\1/\\sqrt{2}\\\\1/\\sqrt{2}\\end{pmatrix}.$$\n\n5. Subspace Hamiltonian:\n$$A_{11}=\\mathbf{b}_1^\\dagger \\mathbf{H} \\mathbf{b}_1=0$$\n$$A_{12}=\\mathbf{b}_1^\\dagger \\mathbf{H} \\mathbf{b}_2\n=V(1/\\sqrt{2}+1/\\sqrt{2})=\\sqrt{2}V$$\n$$A_{22}=\\mathbf{b}_2^\\dagger \\mathbf{H} \\mathbf{b}_2\n=\\frac{1}{2}\\Delta+\\frac{1}{2}\\Delta=\\Delta$$\nHence\n$$\\mathbf{A}=\\begin{pmatrix}0&\\sqrt{2}V\\\\\\sqrt{2}V&\\Delta\\end{pmatrix}.$$\n\n6. Eigenvalues of $\\mathbf A$:\nThe eigenvalues are given by the characteristic equation $\\det(\\mathbf{A}-\\lambda\\mathbf{I}) = \\lambda^2 - (\\text{Tr}\\mathbf{A})\\lambda + \\det\\mathbf{A}=0$.\n$$\\lambda=\\frac{\\text{Tr}\\mathbf{A}\\pm\\sqrt{(\\text{Tr}\\mathbf{A})^2-4\\det\\mathbf{A}}}{2}\n=\\frac{\\Delta\\pm\\sqrt{\\Delta^2+8V^2}}{2}.$$\nThe lowest eigenvalue is the one with the minus sign.",
            "answer": "$$\\boxed{\\frac{\\Delta - \\sqrt{\\Delta^2 + 8 V^2}}{2}}$$"
        }
    ]
}